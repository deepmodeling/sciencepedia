{"hands_on_practices": [{"introduction": "固体力学中的许多问题，特别是涉及圆柱或球形几何形状的问题，都需要使用曲线坐标系。本练习将指导你在柱坐标系中计算矢量场的散度，但不是通过使用一个现成的公式，而是从涉及克里斯托费尔符号（Christoffel symbols）的一般协变定义出发进行推导 [@problem_id:2644624]。这种基础性实践能加深你对微分算子如何在任何坐标系中被形式化定义的理解，并为张量演算打下坚实的基础。", "problem": "考虑一个轴对称固体在圆柱坐标系 $(r,\\theta,z)$ 中的微变形运动学，其线元为 $ds^{2}=dr^{2}+r^{2}d\\theta^{2}+dz^{2}$。设物质速度场是轴对称的，且没有环向分量，因此 $\\mathbf{v}(r,z)=v_{r}(r,z)\\,\\mathbf{e}_{r}+v_{z}(r,z)\\,\\mathbf{e}_{z}$，其中 $\\partial_{\\theta}(\\cdot)=0$ 且 $v_{\\theta}=0$。体积应变率等于 $\\mathbf{v}$ 的散度。\n\n从广义曲线坐标系中散度的协变定义出发，\n$$\n\\nabla\\cdot\\mathbf{v}=\\nabla_{i}v^{i},\n$$\n其中 $\\nabla_{i}v^{j}=\\partial_{i}v^{j}+\\Gamma^{j}_{\\,ik}v^{k}$，并且仅使用圆柱坐标度规 $g_{ij}=\\mathrm{diag}(1,r^{2},1)$，推导 $\\nabla\\cdot\\mathbf{v}$ 在上述轴对称情况下的特化表达式。然后，对于特定的轴对称场\n$$\nv_{r}(r,z)=\\alpha\\,r\\,z^{2}+\\beta\\,r^{3},\\qquad v_{z}(r,z)=\\gamma\\,z^{3}+\\delta\\,r^{2}z,\n$$\n其中 $\\alpha,\\beta,\\gamma,\\delta$ 为常数，计算其散度 $\\nabla\\cdot\\mathbf{v}$，并将其表示为关于 $r$ 和 $z$ 的简化解析函数。将最终答案表示为关于 $\\alpha,\\beta,\\gamma,\\delta,r,z$ 的单个封闭形式表达式。无需进行数值计算，也无需报告单位。", "solution": "对问题陈述进行验证。\n\n**第一步：提取已知条件**\n- 坐标系：圆柱坐标 $(r, \\theta, z)$。\n- 线元：$ds^{2}=dr^{2}+r^{2}d\\theta^{2}+dz^{2}$。\n- 度规张量：$g_{ij}=\\mathrm{diag}(1,r^{2},1)$。\n- 速度场：$\\mathbf{v}(r,z)=v_{r}(r,z)\\,\\mathbf{e}_{r}+v_{z}(r,z)\\,\\mathbf{e}_{z}$。\n- 轴对称条件：$\\partial_{\\theta}(\\cdot)=0$ 且 $v_{\\theta}=0$。\n- 关系：体积应变率是 $\\nabla\\cdot\\mathbf{v}$。\n- 协变散度：$\\nabla\\cdot\\mathbf{v}=\\nabla_{i}v^{i}$。\n- 协变导数：$\\nabla_{i}v^{j}=\\partial_{i}v^{j}+\\Gamma^{j}_{\\,ik}v^{k}$。\n- 具体速度分量：$v_{r}(r,z)=\\alpha\\,r\\,z^{2}+\\beta\\,r^{3}$ 和 $v_{z}(r,z)=\\gamma\\,z^{3}+\\delta\\,r^{2}z$。\n- 常数：$\\alpha, \\beta, \\gamma, \\delta$。\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据，植根于连续介质力学和微分几何的原理。此问题是适定的，提供了推导唯一解所需的所有信息——度规张量、协变导数的定义以及矢量场的分量。语言客观而精确。该任务是一个将张量微积分应用于物理问题的标准练习，特别是计算曲线坐标系中矢量场的散度。此问题不违反任何科学或数学逻辑原理，不是不完整或矛盾的，并且是直接可形式化的。\n\n**第三步：结论与行动**\n此问题有效。将提供解答。\n\n任务是计算给定速度场的散度 $\\nabla \\cdot \\mathbf{v}$。问题指定使用协变散度的一般定义 $\\nabla\\cdot\\mathbf{v}=\\nabla_{i}v^{i}$，其中重复指标表示求和。设坐标为 $x^{1}=r$, $x^{2}=\\theta$, $x^{3}=z$。根据协变导数的定义 $\\nabla_{i}v^{j}=\\partial_{i}v^{j}+\\Gamma^{j}_{\\,ik}v^{k}$，散度（即协变导数的迹）的展开式为：\n$$\n\\nabla\\cdot\\mathbf{v} = \\nabla_{i}v^{i} = \\frac{\\partial v^{i}}{\\partial x^{i}} + \\Gamma^{i}_{\\,ik}v^{k}\n$$\n其中，对重复指标 $i$ 和 $k$ 进行求和。我们展开这个表达式：\n$$\n\\nabla\\cdot\\mathbf{v} = \\left(\\frac{\\partial v^{r}}{\\partial r}+\\frac{\\partial v^{\\theta}}{\\partial \\theta}+\\frac{\\partial v^{z}}{\\partial z}\\right) + \\left(\\Gamma^{r}_{rk}v^{k} + \\Gamma^{\\theta}_{\\theta k}v^{k} + \\Gamma^{z}_{zk}v^{k}\\right)\n$$\n速度场以其物理分量给出，$\\mathbf{v} = v_{r}\\mathbf{e}_{r} + v_{z}\\mathbf{e}_{z}$。物理分量 $(v_{\\hat{r}}, v_{\\hat{\\theta}}, v_{\\hat{z}})$ 与逆变分量 $(v^r, v^\\theta, v^z)$ 之间的关系是 $v_{\\hat{i}} = \\sqrt{g_{ii}} v^i$（无求和）。度规张量为 $g_{ij} = \\mathrm{diag}(1, r^{2}, 1)$。\n因此，我们有：\n$v_{r} = v_{\\hat{r}} = \\sqrt{g_{rr}}v^{r} = \\sqrt{1}v^{r} = v^{r}$。\n$v_{\\theta} = v_{\\hat{\\theta}} = \\sqrt{g_{\\theta\\theta}}v^{\\theta} = r v^{\\theta}$。因为 $v_{\\theta}=0$，所以 $v^{\\theta}=0$。\n$v_{z} = v_{\\hat{z}} = \\sqrt{g_{zz}}v^{z} = \\sqrt{1}v^{z} = v^{z}$。\n逆变速度分量为 $(v^r, v^\\theta, v^z) = (v_r(r,z), 0, v_z(r,z))$。\n问题还说明了轴对称性，因此 $\\partial_{\\theta}(\\cdot) = 0$。\n将这些代入展开的散度公式中，并对 $k$ 求和，考虑到 $v^{\\theta}=0$:\n$$\n\\nabla\\cdot\\mathbf{v} = \\left(\\frac{\\partial v_{r}}{\\partial r} + 0 + \\frac{\\partial v_{z}}{\\partial z}\\right) + \\left(\\Gamma^{r}_{rr}v_{r} + \\Gamma^{r}_{rz}v_{z}\\right) + \\left(\\Gamma^{\\theta}_{\\theta r}v_{r} + \\Gamma^{\\theta}_{\\theta z}v_{z}\\right) + \\left(\\Gamma^{z}_{zr}v_{r} + \\Gamma^{z}_{zz}v_{z}\\right)\n$$\n我们现在必须计算第二类克里斯托费尔符号，$\\Gamma^{i}_{\\,jk} = \\frac{1}{2}g^{im}\\left(\\partial_{j}g_{mk} + \\partial_{k}g_{mj} - \\partial_{m}g_{jk}\\right)$。\n度规张量为 $g_{ij} = \\mathrm{diag}(1, r^{2}, 1)$，其逆矩阵为 $g^{ij} = \\mathrm{diag}(1, r^{-2}, 1)$。\n度规分量中唯一不为零的偏导数是 $\\partial_{r}g_{\\theta\\theta} = \\partial_{1}g_{22} = 2r$。\n让我们计算所需的克里斯托费尔符号：\n$\\Gamma^{r}_{rr} = \\frac{1}{2}g^{rr}(\\partial_{r}g_{rr} + \\partial_{r}g_{rr} - \\partial_{r}g_{rr}) = 0$。\n$\\Gamma^{r}_{rz} = \\frac{1}{2}g^{rr}(\\partial_{r}g_{zr} + \\partial_{z}g_{rr} - \\partial_{r}g_{rz}) = 0$。\n$\\Gamma^{\\theta}_{\\theta r} = \\frac{1}{2}g^{\\theta\\theta}(\\partial_{\\theta}g_{r\\theta} + \\partial_{r}g_{\\theta\\theta} - \\partial_{\\theta}g_{\\theta r}) = \\frac{1}{2}r^{-2}(0+2r-0) = \\frac{1}{r}$。\n$\\Gamma^{\\theta}_{\\theta z} = \\frac{1}{2}g^{\\theta\\theta}(\\partial_{\\theta}g_{z\\theta} + \\partial_{z}g_{\\theta\\theta} - \\partial_{\\theta}g_{\\theta z}) = \\frac{1}{2}r^{-2}(0+0-0) = 0$。\n$\\Gamma^{z}_{zr} = \\frac{1}{2}g^{zz}(\\partial_{z}g_{rz} + \\partial_{r}g_{zz} - \\partial_{z}g_{zr}) = 0$。\n$\\Gamma^{z}_{zz} = \\frac{1}{2}g^{zz}(\\partial_{z}g_{zz} + \\partial_{z}g_{zz} - \\partial_{z}g_{zz}) = 0$。\n将这些值代回散度表达式中：\n$$\n\\nabla\\cdot\\mathbf{v} = \\frac{\\partial v_{r}}{\\partial r} + \\frac{\\partial v_{z}}{\\partial z} + (0)v_{r} + (0)v_{z} + \\left(\\frac{1}{r}\\right)v_{r} + (0)v_{z} + (0)v_{r} + (0)v_{z}\n$$\n$$\n\\nabla\\cdot\\mathbf{v} = \\frac{\\partial v_{r}}{\\partial r} + \\frac{v_{r}}{r} + \\frac{\\partial v_{z}}{\\partial z}\n$$\n这就是在圆柱坐标系中，一个没有环向分量的轴对称矢量场的散度表达式。该表达式可以更紧凑地写成 $\\frac{1}{r}\\frac{\\partial}{\\partial r}(r v_{r}) + \\frac{\\partial v_{z}}{\\partial z}$。\n\n现在我们将此公式应用于给定的特定速度场：\n$v_{r}(r,z) = \\alpha r z^{2} + \\beta r^{3}$\n$v_{z}(r,z) = \\gamma z^{3} + \\delta r^{2} z$\n\n我们计算必要的偏导数：\n$$\n\\frac{\\partial v_{r}}{\\partial r} = \\frac{\\partial}{\\partial r}(\\alpha r z^{2} + \\beta r^{3}) = \\alpha z^{2} + 3\\beta r^{2}\n$$\n$$\n\\frac{\\partial v_{z}}{\\partial z} = \\frac{\\partial}{\\partial z}(\\gamma z^{3} + \\delta r^{2} z) = 3\\gamma z^{2} + \\delta r^{2}\n$$\n现在，将这些导数和 $v_r$ 代入散度公式中：\n$$\n\\nabla\\cdot\\mathbf{v} = \\left(\\alpha z^{2} + 3\\beta r^{2}\\right) + \\frac{1}{r}\\left(\\alpha r z^{2} + \\beta r^{3}\\right) + \\left(3\\gamma z^{2} + \\delta r^{2}\\right)\n$$\n简化项 $\\frac{v_r}{r}$：\n$$\n\\frac{1}{r}\\left(\\alpha r z^{2} + \\beta r^{3}\\right) = \\alpha z^{2} + \\beta r^{2}\n$$\n合并所有项：\n$$\n\\nabla\\cdot\\mathbf{v} = (\\alpha z^{2} + 3\\beta r^{2}) + (\\alpha z^{2} + \\beta r^{2}) + (3\\gamma z^{2} + \\delta r^{2})\n$$\n按 $r$ 和 $z$ 的幂次对各项进行分组：\n$$\n\\nabla\\cdot\\mathbf{v} = (3\\beta + \\beta + \\delta)r^{2} + (\\alpha + \\alpha + 3\\gamma)z^{2}\n$$\n最后，我们得到散度的简化表达式：\n$$\n\\nabla\\cdot\\mathbf{v} = (4\\beta + \\delta)r^{2} + (2\\alpha + 3\\gamma)z^{2}\n$$\n这就是给定速度场散度的最终解析函数。", "answer": "$$\n\\boxed{(4\\beta + \\delta)r^{2} + (2\\alpha + 3\\gamma)z^{2}}\n$$", "id": "2644624"}, {"introduction": "在分析经历大变形的材料时，我们必须区分初始的、未变形的“物质”构型和最终的、变形后的“空间”构型。本练习将介绍 Piola 变换，这是一个在两种构型之间映射矢量场的关键数学工具 [@problem_id:2644646]。通过一个具体的例子，你将验证一个重要的恒等式，它将物质坐标系中的散度算子与空间坐标系中的对应算子联系起来，这是在连续介质力学中建立守恒律的核心概念。", "problem": "一个均匀变形通过 $x=\\chi(X)=\\mathbf{F}X$ 将具有位置矢量 $X \\in \\mathbb{R}^{3}$ 的参考构型映射到具有位置矢量 $x \\in \\mathbb{R}^{3}$ 的当前构型，其中 $\\mathbf{F}=\\mathrm{diag}(\\lambda,1,1)$，$\\lambda0$ 且 $J=\\det \\mathbf{F}=\\lambda$。考虑在当前构型中定义的空间矢量场 $v(x)=\\begin{pmatrix}x_{1}\\\\ x_{2}^{2}\\\\ x_{3}^{3}\\end{pmatrix}$。假设所有量均为无量纲。\n\n仅从参考构型和当前构型中相应曲面上的通量守恒以及散度定理出发，确定参考矢量场 $V(X)$，使得其通过参考构型中任意物质面的通量，等于在给定变形下 $v(x)$ 通过当前构型中像曲面的通量。然后，计算该参考场相对于 $X$ 的散度，并将其与在 $x=\\chi(X)$ 处计算的空间散度 $v(x)$ 乘以 $J$ 的结果进行比较。请提供 $\\mathrm{Div}_{X}\\,V(X)$ 的一个闭式表达式。\n\n你的最终答案必须是仅含 $\\lambda$、$X_{2}$ 和 $X_{3}$ 的单个解析表达式，不带单位或近似。", "solution": "该问题在科学上是成立的、适定的，并包含足够的信息以获得唯一解。我们开始推导。\n\n问题指出，参考矢量场 $V(X)$ 和空间矢量场 $v(x)$ 通过相应物质面 $S_0$ 和空间面 $S = \\chi(S_0)$ 上的通量守恒相关联。该关系由以下积分等式给出：\n$$\n\\int_{S_0} V(X) \\cdot N \\, dS_0 = \\int_S v(x) \\cdot n \\, dS\n$$\n其中 $N$ 是参考构型中曲面 $S_0$ 的单位法向量，$n$ 是当前构型中曲面 $S$ 的单位法向量。\n\n为了找到 $V(X)$ 和 $v(x)$ 之间的局部关系，我们必须关联微分面元。这可以通过 Nanson 公式来完成，该公式将空间面元 $n \\, dS$ 与物质面元 $N \\, dS_0$ 联系起来：\n$$\nn \\, dS = J (\\mathbf{F}^{-T}) N \\, dS_0\n$$\n其中 $\\mathbf{F}$ 是变形梯度，$J = \\det \\mathbf{F}$ 是变形的雅可比行列式，且 $\\mathbf{F}^{-T} = (\\mathbf{F}^{-1})^T$。\n\n将 Nanson 公式代入通量守恒方程，得到：\n$$\n\\int_{S_0} V(X) \\cdot N \\, dS_0 = \\int_{S_0} v(\\chi(X)) \\cdot (J (\\mathbf{F}^{-T}) N) \\, dS_0\n$$\n利用点积的性质 $(A\\mathbf{a}) \\cdot \\mathbf{b} = \\mathbf{a} \\cdot (A^T \\mathbf{b})$，我们可以重写右侧的被积函数：\n$$\nv \\cdot (J \\mathbf{F}^{-T} N) = (J (\\mathbf{F}^{-T})^T v) \\cdot N = (J \\mathbf{F}^{-1} v) \\cdot N\n$$\n因此，积分等式变为：\n$$\n\\int_{S_0} V(X) \\cdot N \\, dS_0 = \\int_{S_0} (J \\mathbf{F}^{-1} v(\\chi(X))) \\cdot N \\, dS_0\n$$\n由于此等式必须对任意物质面 $S_0$ 成立，因此对于任意选择的法向量 $N$，被积函数必须相等。这意味着存在如下局部关系：\n$$\nV(X) = J \\mathbf{F}^{-1} v(\\chi(X))\n$$\n这就是矢量场 $v$ 的 Piola 变换。\n\n现在我们根据给定数据计算此表达式。变形梯度为 $\\mathbf{F} = \\mathrm{diag}(\\lambda, 1, 1)$，其逆矩阵为 $\\mathbf{F}^{-1} = \\mathrm{diag}(\\lambda^{-1}, 1, 1)$。雅可比行列式为 $J = \\det \\mathbf{F} = \\lambda$。\n空间矢量场为 $v(x) = \\begin{pmatrix} x_1 \\\\ x_2^2 \\\\ x_3^3 \\end{pmatrix}$。变形映射为 $x = \\mathbf{F}X$，其分量形式为 $x_1 = \\lambda X_1$，$x_2 = X_2$ 和 $x_3 = X_3$。我们将 $v$ 用物质坐标 $X$ 表示：\n$$\nv(\\chi(X)) = \\begin{pmatrix} \\lambda X_1 \\\\ X_2^2 \\\\ X_3^3 \\end{pmatrix}\n$$\n现在我们可以确定参考场 $V(X)$：\n$$\nV(X) = J \\mathbf{F}^{-1} v(\\chi(X)) = \\lambda \\begin{pmatrix} \\lambda^{-1}  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} \\lambda X_1 \\\\ X_2^2 \\\\ X_3^3 \\end{pmatrix}\n$$\n$$\nV(X) = \\lambda \\begin{pmatrix} \\lambda^{-1} (\\lambda X_1) \\\\ (1)(X_2^2) \\\\ (1)(X_3^3) \\end{pmatrix} = \\lambda \\begin{pmatrix} X_1 \\\\ X_2^2 \\\\ X_3^3 \\end{pmatrix} = \\begin{pmatrix} \\lambda X_1 \\\\ \\lambda X_2^2 \\\\ \\lambda X_3^3 \\end{pmatrix}\n$$\n这就是我们假设其存在的参考矢量场 $V(X)$。\n\n下一步是计算 $V(X)$ 相对于物质坐标 $X = (X_1, X_2, X_3)$ 的散度，记为 $\\mathrm{Div}_{X}\\,V(X)$。\n$$\n\\mathrm{Div}_{X}\\,V(X) = \\frac{\\partial V_1}{\\partial X_1} + \\frac{\\partial V_2}{\\partial X_2} + \\frac{\\partial V_3}{\\partial X_3}\n$$\n$V(X)$ 的分量是 $V_1 = \\lambda X_1$，$V_2 = \\lambda X_2^2$ 和 $V_3 = \\lambda X_3^3$。它们的偏导数是：\n$$\n\\frac{\\partial V_1}{\\partial X_1} = \\frac{\\partial}{\\partial X_1}(\\lambda X_1) = \\lambda\n$$\n$$\n\\frac{\\partial V_2}{\\partial X_2} = \\frac{\\partial}{\\partial X_2}(\\lambda X_2^2) = 2 \\lambda X_2\n$$\n$$\n\\frac{\\partial V_3}{\\partial X_3} = \\frac{\\partial}{\\partial X_3}(\\lambda X_3^3) = 3 \\lambda X_3^2\n$$\n将这些分量相加，得到参考场的散度：\n$$\n\\mathrm{Div}_{X}\\,V(X) = \\lambda + 2 \\lambda X_2 + 3 \\lambda X_3^2 = \\lambda (1 + 2 X_2 + 3 X_3^2)\n$$\n\n最后，为了进行比较，我们计算 $v(x)$ 的空间散度，并将其与物质散度关联起来。空间散度 $\\mathrm{div}_{x}\\,v(x)$ 是相对于空间坐标 $x=(x_1, x_2, x_3)$ 计算的：\n$$\n\\mathrm{div}_{x}\\,v(x) = \\frac{\\partial v_1}{\\partial x_1} + \\frac{\\partial v_2}{\\partial x_2} + \\frac{\\partial v_3}{\\partial x_3}\n$$\n$v(x)$ 的分量是 $v_1 = x_1$，$v_2 = x_2^2$ 和 $v_3 = x_3^3$。它们的偏导数是：\n$$\n\\frac{\\partial v_1}{\\partial x_1} = 1\n$$\n$$\n\\frac{\\partial v_2}{\\partial x_2} = 2 x_2\n$$\n$$\n\\frac{\\partial v_3}{\\partial x_3} = 3 x_3^2\n$$\n所以，空间散度为：\n$$\n\\mathrm{div}_{x}\\,v(x) = 1 + 2 x_2 + 3 x_3^2\n$$\n问题要求将 $\\mathrm{Div}_{X}\\,V(X)$ 与在参考构型中计算的 $J \\cdot (\\mathrm{div}_{x}\\,v)$ 进行比较。我们乘以 $J=\\lambda$ 并代入映射关系 $x_2=X_2, x_3=X_3$：\n$$\nJ \\cdot (\\mathrm{div}_{x}\\,v(\\chi(X))) = \\lambda (1 + 2 X_2 + 3 X_3^2) = \\lambda + 2 \\lambda X_2 + 3 \\lambda X_3^2\n$$\n将此结果与之前计算的 $\\mathrm{Div}_{X}\\,V(X)$ 比较，我们发现它们是相同的。这证实了 Piola 变换矢量场的一般恒等式 $\\mathrm{Div}(J\\mathbf{F}^{-1}v) = J(\\mathrm{div}\\,v)\\circ\\chi$。\n\n问题要求提供 $\\mathrm{Div}_{X}\\,V(X)$ 的一个闭式表达式。我们已经求得其为 $\\lambda(1 + 2 X_2 + 3 X_3^2)$。", "answer": "$$\\boxed{\\lambda(1 + 2 X_2 + 3 X_3^2)}$$", "id": "2644646"}, {"introduction": "对于现代工程师和科学家来说，将连续介质力学原理转化为可靠的数值模拟是一项至关重要的技能。一种朴素的离散化方法可能会在离散层面破坏基本的物理定律。这个高级练习要求你在交错网格上设计离散的旋度和散度算子，使其在数学上能精确地保持矢量恒等式 $\\nabla \\cdot (\\nabla \\times \\mathbf{A}) = 0$ [@problem_id:2644608]。这种被称为“模拟”或“相容”离散化的方法，对于开发没有常见数值伪影的稳健模拟至关重要。", "problem": "在三维线性弹性力学和位错力学中，通常引入矢量势场 $\\mathbf{A}$，以便通过 $\\mathbf{A}$ 的旋度来表示与位错密度相关的不相容性。考虑一个均匀的笛卡尔网格，其在 $x$、$y$ 和 $z$ 方向上的间距分别为 $h_x$、$h_y$ 和 $h_z$，并采用周期性边界条件。采用如下的自由度交错配置：矢量势 $\\mathbf{A} = (A_x, A_y, A_z)$ 的分量存储在与其各自坐标轴对齐的边上，即 $A_x$ 位于 $(i, j+\\tfrac{1}{2}, k+\\tfrac{1}{2})$，$A_y$ 位于 $(i+\\tfrac{1}{2}, j, k+\\tfrac{1}{2})$，$A_z$ 位于 $(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}, k)$，其中 $(i,j,k)\\in\\mathbb{Z}^3$ 索引了位于 $(i h_x, j h_y, k h_z)$ 的单元中心。通过在每个面上应用 Stokes 定理的旋度积分定义，并用有向边差分除以面面积来近似环量，定义一个离散旋度算子 $\\nabla_h \\times$。该算子产生一个面心场 $\\mathbf{B} = \\nabla_h \\times \\mathbf{A}$，其中 $B_x$ 位于 $(i+\\tfrac{1}{2}, j, k)$，$B_y$ 位于 $(i, j+\\tfrac{1}{2}, k)$，$B_z$ 位于 $(i, j, k+\\tfrac{1}{2})$。然后，通过应用 Gauss 定理并将通量近似为带符号的面贡献除以单元体积，定义一个将面心场映射到单元中心的离散散度算子 $\\nabla_h \\cdot$。\n\n仅以矢量微积分的基本积分定理（Stokes 定理和 Gauss 散度定理）为出发点，推导由这些构造产生的所有 $\\nabla_h \\times \\mathbf{A}$ 分量和 $\\nabla_h \\cdot \\mathbf{B}$ 的中心差分模板。证明对于此交错网格上的任何离散边心场 $\\mathbf{A}$，其复合算子 $\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{A})$ 在每个单元中心都恒为零。\n\n最后，考虑与周期性网格和上述交错配置相对应的离散傅里叶变换，并计算复合算子 $\\nabla_h \\cdot (\\nabla_h \\times \\cdot)$ 的离散傅里叶符号。将此符号作为最终答案，以单个标量表达式的形式报告。答案无需进行数值舍入，也不需要物理单位。", "solution": "目标是从第一性原理出发构造离散算子，从而在离散层面上保留矢量微积分的几何恒等式。我们从作为旋度和散度基础的积分定义开始。\n\n根据 Stokes 定理，对于一个光滑矢量场 $\\mathbf{A}$ 和一个边界为 $\\partial S$、单位法向为 $\\mathbf{n}$ 的面 $S$，有\n$$\n\\int_{S} (\\nabla \\times \\mathbf{A}) \\cdot \\mathbf{n} \\, dS \\;=\\; \\oint_{\\partial S} \\mathbf{A} \\cdot d\\boldsymbol{\\ell}.\n$$\n在与坐标轴对齐的矩形面上，右侧的线积分是沿四条边的 $\\mathbf{A}\\cdot d\\boldsymbol{\\ell}$ 的有向和。在均匀网格上，除以面面积可得到在面中心处 $\\nabla \\times \\mathbf{A}$ 的法向分量的一个一致的离散近似。这启发我们定义一个离散旋度 $\\nabla_h \\times$，它将 $\\mathbf{A}$ 的边心分量映射到 $\\mathbf{B}=\\nabla_h\\times\\mathbf{A}$ 的面心分量。\n\n类似地，根据 Gauss 散度定理，对于一个光滑矢量场 $\\mathbf{B}$ 和一个边界为 $\\partial V$、外法向为 $\\mathbf{n}$ 的单元 $V$，有\n$$\n\\int_{V} \\nabla \\cdot \\mathbf{B}\\, dV \\;=\\; \\oint_{\\partial V} \\mathbf{B} \\cdot \\mathbf{n}\\, dS.\n$$\n在矩形单元上，面积分是穿过六个面的法向通量的带符号和。在均匀网格上，除以单元体积可得到一个离散散度 $\\nabla_h \\cdot$，它将面心场 $\\mathbf{B}$ 映射到一个单元中心的标量。\n\n我们现在写出这些构造所隐含的显式模板。\n\n将 $\\mathbf{B}=\\nabla_h\\times\\mathbf{A}$ 的面心分量定义为\n$$\nB_x\\big|_{i+\\frac{1}{2},j,k} \\;=\\; \\frac{ A_z\\big|_{i+\\frac{1}{2},\\,j+\\frac{1}{2},\\,k} - A_z\\big|_{i+\\frac{1}{2},\\,j-\\frac{1}{2},\\,k} }{ h_y } \\;-\\; \\frac{ A_y\\big|_{i+\\frac{1}{2},\\,j,\\,k+\\frac{1}{2}} - A_y\\big|_{i+\\frac{1}{2},\\,j,\\,k-\\frac{1}{2}} }{ h_z },\n$$\n$$\nB_y\\big|_{i,\\,j+\\frac{1}{2},\\,k} \\;=\\; \\frac{ A_x\\big|_{i,\\,j+\\frac{1}{2},\\,k+\\frac{1}{2}} - A_x\\big|_{i,\\,j+\\frac{1}{2},\\,k-\\frac{1}{2}} }{ h_z } \\;-\\; \\frac{ A_z\\big|_{i+\\frac{1}{2},\\,j+\\frac{1}{2},\\,k} - A_z\\big|_{i-\\frac{1}{2},\\,j+\\frac{1}{2},\\,k} }{ h_x },\n$$\n$$\nB_z\\big|_{i,\\,j,\\,k+\\frac{1}{2}} \\;=\\; \\frac{ A_y\\big|_{i+\\frac{1}{2},\\,j,\\,k+\\frac{1}{2}} - A_y\\big|_{i-\\frac{1}{2},\\,j,\\,k+\\frac{1}{2}} }{ h_x } \\;-\\; \\frac{ A_x\\big|_{i,\\,j+\\frac{1}{2},\\,k+\\frac{1}{2}} - A_x\\big|_{i,\\,j-\\frac{1}{2},\\,k+\\frac{1}{2}} }{ h_y }.\n$$\n这些是通过计算围绕控制体每个面的环量并除以面面积所得到的中心差分，它们分别将 $B_x$、$B_y$ 和 $B_z$ 放置在 $x$ 面、$y$ 面和 $z$ 面上。\n\n将面心场 $\\mathbf{B}$ 的单元中心离散散度定义为\n$$\n(\\nabla_h \\cdot \\mathbf{B})\\big|_{i,j,k} \\;=\\; \\frac{ B_x\\big|_{i+\\frac{1}{2},\\,j,\\,k} - B_x\\big|_{i-\\frac{1}{2},\\,j,\\,k} }{ h_x } \\;+\\; \\frac{ B_y\\big|_{i,\\,j+\\frac{1}{2},\\,k} - B_y\\big|_{i,\\,j-\\frac{1}{2},\\,k} }{ h_y } \\;+\\; \\frac{ B_z\\big|_{i,\\,j,\\,k+\\frac{1}{2}} - B_z\\big|_{i,\\,j,\\,k-\\frac{1}{2}} }{ h_z }.\n$$\n这是 Gauss 定理的中心差分形式，即用净向外通量除以单元体积。\n\n我们现在证明 $\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{A}) \\equiv 0$ 在每个单元 $(i,j,k)$ 处逐点成立。将 $\\mathbf{B}=\\nabla_h\\times\\mathbf{A}$ 代入散度可得\n$$\n(\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{A}))\\big|_{i,j,k}\n= D_x B_x + D_y B_y + D_z B_z,\n$$\n为简洁起见，我们在此定义作用于相应交错场的各个方向上的中心差分算子，\n$$\nD_x B_x \\;=\\; \\frac{ B_x\\big|_{i+\\frac{1}{2},\\,j,\\,k} - B_x\\big|_{i-\\frac{1}{2},\\,j,\\,k} }{ h_x }, \\quad\nD_y B_y \\;=\\; \\frac{ B_y\\big|_{i,\\,j+\\frac{1}{2},\\,k} - B_y\\big|_{i,\\,j-\\frac{1}{2},\\,k} }{ h_y }, \\quad\nD_z B_z \\;=\\; \\frac{ B_z\\big|_{i,\\,j,\\,k+\\frac{1}{2}} - B_z\\big|_{i,\\,j,\\,k-\\frac{1}{2}} }{ h_z }.\n$$\n使用旋度模板，展开每一项。对于 $D_x B_x$，\n$$\nD_x B_x \\;=\\; \\frac{1}{h_x}\\left[\n\\left(\\frac{ A_z\\big|_{i+\\frac{1}{2},\\,j+\\frac{1}{2},\\,k} - A_z\\big|_{i+\\frac{1}{2},\\,j-\\frac{1}{2},\\,k} }{ h_y } \\;-\\; \\frac{ A_y\\big|_{i+\\frac{1}{2},\\,j,\\,k+\\frac{1}{2}} - A_y\\big|_{i+\\frac{1}{2},\\,j,\\,k-\\frac{1}{2}} }{ h_z }\\right)\n-\n\\left(\\frac{ A_z\\big|_{i-\\frac{1}{2},\\,j+\\frac{1}{2},\\,k} - A_z\\big|_{i-\\frac{1}{2},\\,j-\\frac{1}{2},\\,k} }{ h_y } \\;-\\; \\frac{ A_y\\big|_{i-\\frac{1}{2},\\,j,\\,k+\\frac{1}{2}} - A_y\\big|_{i-\\frac{1}{2},\\,j,\\,k-\\frac{1}{2}} }{ h_z }\\right)\n\\right].\n$$\n对各项进行分组，以观察混合中心差分对边心场的作用：\n$$\nD_x B_x \\;=\\; \\frac{1}{h_x h_y}\\left[\n\\big(A_z\\big|_{i+\\frac{1}{2},\\,j+\\frac{1}{2},\\,k} - A_z\\big|_{i+\\frac{1}{2},\\,j-\\frac{1}{2},\\,k}\\big)\n-\n\\big(A_z\\big|_{i-\\frac{1}{2},\\,j+\\frac{1}{2},\\,k} - A_z\\big|_{i-\\frac{1}{2},\\,j-\\frac{1}{2},\\,k}\\big)\n\\right]\n\\;-\\; \\frac{1}{h_x h_z}\\left[\n\\big(A_y\\big|_{i+\\frac{1}{2},\\,j,\\,k+\\frac{1}{2}} - A_y\\big|_{i+\\frac{1}{2},\\,j,\\,k-\\frac{1}{2}}\\big)\n-\n\\big(A_y\\big|_{i-\\frac{1}{2},\\,j,\\,k+\\frac{1}{2}} - A_y\\big|_{i-\\frac{1}{2},\\,j,\\,k-\\frac{1}{2}}\\big)\n\\right].\n$$\n认识到这是 $x$ 和 $y$ (以及 $x$ 和 $z$) 方向的中心差分作用于 $A_z$ (以及 $A_y$) 的复合，我们可以紧凑地写成\n$$\nD_x B_x \\;=\\; D_x D_y A_z \\;-\\; D_x D_z A_y,\n$$\n需要理解的是，$D_x$、$D_y$ 和 $D_z$ 是在适当的交错位置上定义的中心差分算子，以使这些复合运算是良定义的。\n\n类似地，展开其他项：\n$$\nD_y B_y \\;=\\; D_y D_z A_x \\;-\\; D_y D_x A_z,\\qquad\nD_z B_z \\;=\\; D_z D_x A_y \\;-\\; D_z D_y A_x.\n$$\n将这三个表达式相加，我们得到\n$$\nD_x B_x + D_y B_y + D_z B_z\n\\;=\\;\n\\big(D_x D_y A_z - D_y D_x A_z\\big)\n\\;+\\;\n\\big(D_y D_z A_x - D_z D_y A_x\\big)\n\\;+\\;\n\\big(D_z D_x A_y - D_x D_z A_y\\big).\n$$\n在具有所述交错配置的均匀网格上，中心差分算子在作用于一致交错的场时是可交换的，即，\n$$\nD_\\alpha D_\\beta \\phi \\;=\\; D_\\beta D_\\alpha \\phi\n$$\n对于任意一对方向 $\\alpha,\\beta\\in\\{x,y,z\\}$ 和任何位于适当交错位置的离散标量场 $\\phi$。这种交换性源于均匀中心差分的平移不变性和对称性，并且从索引表达式中可以直接看出，混合二阶差分在应用顺序上是对称的。因此，和式中的每个括号项都为零：\n$$\nD_x D_y A_z - D_y D_x A_z \\;=\\; 0,\\quad\nD_y D_z A_x - D_z D_y A_x \\;=\\; 0,\\quad\nD_z D_x A_y - D_x D_z A_y \\;=\\; 0.\n$$\n因此，\n$$\n(\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{A}))\\big|_{i,j,k} \\;=\\; 0\n$$\n在每个单元中心 $(i,j,k)$ 处，对于所有离散边心场 $\\mathbf{A}$ 均成立，正如所要求。\n\n我们现在计算该复合算子的离散傅里叶符号。设网格是周期性的，并考虑一个与交错配置一致的离散傅里叶模。尽管由于半整数索引的平移，$D_x$、$D_y$、$D_z$ 的各个符号以及交错插值会带有相位因子，但上述的逐点恒等式表明，复合算子 $\\nabla_h \\cdot (\\nabla_h \\times \\cdot)$ 作为一个离散算子是恒等于零的。因此，它的离散傅里叶符号——即该算子在傅里叶基中的表示——对于所有离散波数都是标量 $0$。在已建立的恒等式之外，无需进一步计算，因为一个在物理空间中恒为零的线性算子，其在傅里叶空间中的符号也恒为零。\n\n因此，$\\nabla_h \\cdot (\\nabla_h \\times \\cdot)$ 的离散傅里叶符号是 $0$。", "answer": "$$\\boxed{0}$$", "id": "2644608"}]}