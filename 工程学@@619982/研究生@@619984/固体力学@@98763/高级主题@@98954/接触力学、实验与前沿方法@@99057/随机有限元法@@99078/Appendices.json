{"hands_on_practices": [{"introduction": "在深入研究随机有限元法的应用之前，我们必须首先掌握其核心的数学构造：多项式混沌展开 (PCE) 基函数。本练习旨在通过一个基础但至关重要的计算，帮助您熟悉多元正交多项式基的构建方式，并运用组合数学原理来确定展开式中的项数。理解基函数的结构和规模是后续进行任何 PCE 分析的第一步 [@problem_id:2686929]。", "problem": "在随机有限元法中，随机响应通常用一个多项式混沌展开（PCE）来表示，该展开建立在适应于输入分布的正交基上。考虑一个由$m$个独立标准正态随机变量组成的$m$维向量 $\\boldsymbol{\\Xi} = (\\Xi_{1},\\ldots,\\Xi_{m})$，以及与之相关的、由概率论者的Hermite多项式构建的Hermite混沌基，这些多项式关于标准正态密度在$L^{2}$上是正交的。单变量概率论者的Hermite多项式由罗德里格斯 (Rodrigues) 公式定义：\n$$\n\\mathrm{He}_{n}(\\xi) = (-1)^{n} \\exp\\!\\left(\\frac{\\xi^{2}}{2}\\right) \\frac{d^{n}}{d\\xi^{n}} \\exp\\!\\left(-\\frac{\\xi^{2}}{2}\\right),\n$$\n其前三项为 $\\mathrm{He}_{0}(\\xi)=1$，$\\mathrm{He}_{1}(\\xi)=\\xi$ 和 $\\mathrm{He}_{2}(\\xi)=\\xi^{2}-1$。\n\n通过使用多重指标 $\\boldsymbol{\\alpha}=(\\alpha_{1},\\ldots,\\alpha_{m}) \\in \\mathbb{N}_{0}^{m}$ 和总阶数 $|\\boldsymbol{\\alpha}|=\\sum_{i=1}^{m}\\alpha_{i}$ 索引的张量积来定义多变量Hermite混沌基函数：\n$$\n\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\Xi}) \\equiv \\prod_{i=1}^{m} \\mathrm{He}_{\\alpha_{i}}(\\Xi_{i}).\n$$\n\n任务：\n- 针对总阶数 $p=2$ 和通用维度 $m$，用 $\\mathrm{He}_{0}$、$\\mathrm{He}_{1}$ 和 $\\mathrm{He}_{2}$ 明确写出多变量基函数集合 $\\{\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\Xi}) : |\\boldsymbol{\\alpha}| \\leq p\\}$，并按总阶数 $|\\boldsymbol{\\alpha}|=0$、$|\\boldsymbol{\\alpha}|=1$ 和 $|\\boldsymbol{\\alpha}|=2$ 进行组织。你的描述应清楚地指出所有不同类型的项，不遗漏任何类别。\n- 仅使用基于计数非负整数解的基本组合推理，推导出总阶数至多为 $p=2$ 的不同多变量基函数总数，并将其表示为关于 $m$ 的封闭形式函数。\n\n请以关于$m$的单个解析表达式的形式提供最终答案。无需四舍五入，也无需单位。", "solution": "问题陈述已经过验证，被认为是科学可靠、定义良好且客观的。它不包含任何科学或事实上的不健全之处，结构严谨，并为得出唯一解提供了所有必要的定义和约束。因此，我们将着手进行推导。\n\n该问题分为两个任务：首先，明确描述总阶数 $p \\leq 2$ 的多变量Hermite基函数集合；其次，推导这些函数总数的关于维度$m$的封闭形式表达式。\n\n**第1部分：$|\\boldsymbol{\\alpha}| \\leq 2$ 的基函数的枚举**\n\n我们旨在找出所有不同的多重指标 $\\boldsymbol{\\alpha} = (\\alpha_{1}, \\ldots, \\alpha_{m}) \\in \\mathbb{N}_{0}^{m}$，使得其总阶数 $|\\boldsymbol{\\alpha}| = \\sum_{i=1}^{m} \\alpha_{i}$ 小于或等于 $2$。基函数 $\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\Xi})$ 是通过单变量Hermite多项式 $\\mathrm{He}_{\\alpha_{i}}(\\Xi_{i})$ 的张量积构建的。我们按总阶数来组织基函数。\n\n**情况1：总阶数 $|\\boldsymbol{\\alpha}| = 0$**\n在所有 $\\alpha_{i} \\in \\mathbb{N}_{0}$ 的约束下，条件 $\\sum_{i=1}^{m} \\alpha_{i} = 0$ 只有一个可能的解：对于所有 $i \\in \\{1, \\ldots, m\\}$，$\\alpha_{i} = 0$。\n这对应于单个多重指标 $\\boldsymbol{\\alpha} = (0, 0, \\ldots, 0)$。\n所得的基函数为：\n$$ \\Psi_{(0, \\ldots, 0)}(\\boldsymbol{\\Xi}) = \\prod_{i=1}^{m} \\mathrm{He}_{0}(\\Xi_{i}) = \\prod_{i=1}^{m} 1 = 1 $$\n总阶数为0的基函数有1个。\n\n**情况2：总阶数 $|\\boldsymbol{\\alpha}| = 1$**\n条件是 $\\sum_{i=1}^{m} \\alpha_{i} = 1$。对于非负整数 $\\alpha_{i}$，这意味着恰好有一个分量（比如$\\alpha_{j}$）必须等于1，而所有其他分量$\\alpha_{k}$（对于$k \\neq j$）必须为0。\n指标$j$可以是1到$m$之间的任意整数。因此，存在$m$个这种形式的不同多重指标。对于每个 $j \\in \\{1, \\ldots, m\\}$，多重指标为 $\\boldsymbol{\\alpha} = (0, \\ldots, 1, \\ldots, 0)$，其中1在第$j$个位置。\n相应的基函数为：\n$$ \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\Xi}) = \\mathrm{He}_{1}(\\Xi_{j}) \\prod_{k \\neq j} \\mathrm{He}_{0}(\\Xi_{k}) = \\mathrm{He}_{1}(\\Xi_{j}) $$\n总阶数为1的基函数集合是 $\\{\\mathrm{He}_{1}(\\Xi_{j}) : j=1, \\ldots, m\\}$。共有$m$个这样的函数。\n\n**情况3：总阶数 $|\\boldsymbol{\\alpha}| = 2$**\n条件是 $\\sum_{i=1}^{m} \\alpha_{i} = 2$。对于非负整数 $\\alpha_{i}$，存在两种不同类型的解：\n- **类型3a：** 一个分量为2，所有其他分量为0。令某个 $j \\in \\{1, \\ldots, m\\}$ 对应的 $\\alpha_{j} = 2$，而所有 $k \\neq j$ 对应的 $\\alpha_{k} = 0$。存在$m$个这样的多重指标。相应的基函数形式为：\n$$ \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\Xi}) = \\mathrm{He}_{2}(\\Xi_{j}) \\prod_{k \\neq j} \\mathrm{He}_{0}(\\Xi_{k}) = \\mathrm{He}_{2}(\\Xi_{j}) $$\n这给出了一个包含$m$个“纯”二阶基函数的集合：$\\{\\mathrm{He}_{2}(\\Xi_{j}) : j=1, \\ldots, m\\}$。\n\n- **类型3b：** 两个分量为1，所有其他分量为0。令两个不同的指标 $j, k \\in \\{1, \\ldots, m\\}$（$j \\neq k$）对应的 $\\alpha_{j} = 1$ 和 $\\alpha_{k} = 1$。所有其他分量为0。从$m$个元素中选择两个不同指标的方法数由二项式系数 $\\binom{m}{2}$ 给出。相应的基函数形式为：\n$$ \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\Xi}) = \\mathrm{He}_{1}(\\Xi_{j}) \\mathrm{He}_{1}(\\Xi_{k}) \\prod_{l \\neq j,k} \\mathrm{He}_{0}(\\Xi_{l}) = \\mathrm{He}_{1}(\\Xi_{j})\\mathrm{He}_{1}(\\Xi_{k}) $$\n这给出了一个包含 $\\binom{m}{2} = \\frac{m(m-1)}{2}$ 个“混合”二阶基函数的集合：$\\{\\mathrm{He}_{1}(\\Xi_{j})\\mathrm{He}_{1}(\\Xi_{k}) : 1 \\leq j < k \\leq m\\}$。\n\n阶数为2的基函数总数是这两种不相交类型数量的总和：$m + \\binom{m}{2}$。\n\n**第2部分：$|\\boldsymbol{\\alpha}| \\leq 2$ 的基函数总数**\n\n我们必须推导出总阶数至多为 $p=2$ 的不同基函数的总数。这等价于求多重指标集合 $S = \\{\\boldsymbol{\\alpha} \\in \\mathbb{N}_{0}^{m} : |\\boldsymbol{\\alpha}| \\leq 2\\}$ 的基数。这是一个标准的组合问题。\n\n计数不等式 $\\sum_{i=1}^{m} \\alpha_{i} \\leq p$ 的非负整数解数量的问题，可以转化为计数一个等式的解。我们引入一个辅助“松弛”变量 $\\alpha_{m+1} \\in \\mathbb{N}_{0}$，使不等式变为一个包含 $m+1$ 个变量的等式：\n$$ \\sum_{i=1}^{m} \\alpha_{i} + \\alpha_{m+1} = p $$\n该方程的非负整数解的数量由“隔板法”公式给出。该问题等价于将$p$个不可区分的物品（星）分配到$m+1$个可区分的箱子（变量 $\\alpha_{1}, \\ldots, \\alpha_{m+1}$）中。实现此目的的方法数由下式给出：\n$$ N_{m,p} = \\binom{p + (m+1) - 1}{(m+1) - 1} = \\binom{p+m}{m} = \\binom{p+m}{p} $$\n对于本问题的特定情况，我们有$p=2$。基函数的总数$N$为：\n$$ N = \\binom{2+m}{m} = \\binom{m+2}{2} $$\n我们展开这个二项式系数以获得最终的封闭形式表达式：\n$$ N = \\frac{(m+2)!}{2!(m+2-2)!} = \\frac{(m+2)!}{2 \\cdot m!} = \\frac{(m+2)(m+1)m!}{2m!} = \\frac{(m+1)(m+2)}{2} $$\n通过将第1部分中推导出的各阶数计数相加，可以验证此结果：\n- 阶数0：1个函数。\n- 阶数1：$m$个函数。\n- 阶数2：$m + \\binom{m}{2}$个函数。\n总数$N$为：\n$$ N = 1 + m + \\left(m + \\binom{m}{2}\\right) = 1 + 2m + \\frac{m(m-1)}{2} $$\n$$ N = \\frac{2 + 4m + m^2 - m}{2} = \\frac{m^2 + 3m + 2}{2} = \\frac{(m+1)(m+2)}{2} $$\n该验证证实了通过隔板法得到的结果。最终的表达式即为所求的关于$m$的封闭形式函数。", "answer": "$$\\boxed{\\frac{(m+1)(m+2)}{2}}$$", "id": "2686929"}, {"introduction": "掌握了PCE基的构造后，下一个关键步骤是将其应用于一个具体的工程问题，并验证其结果的准确性。本练习将指导您分析一个一维弹性杆，其杨氏模量具有不确定性，您需要推导其位移响应的PCE系数，并计算其均值和方差。通过将PCE结果与蒙特卡洛模拟的“黄金标准”进行比较，您将获得评估和验证不确定性量化模型有效性的实践经验 [@problem_id:2686984]。", "problem": "考虑一根长度为 $L$ (单位 m) 的一维直弹性杆，其横截面积 $A$ (单位 $\\mathrm{m}^2$) 恒定，在 $x=0$ 处固定（位移为零），并在 $x=L$ 处承受拉伸端部载荷 $P$ (单位 N)。杨氏模量是一个严格为正的随机场，通过具有单个标准高斯随机变量 $\\xi \\sim \\mathcal{N}(0,1)$ 的对数正态参数形式进行建模：\n$$\nE(\\xi) = E_0 \\exp\\left(\\sigma \\,\\xi\\right),\n$$\n其中 $E_0$ (单位 Pa) 是模量中值，$\\sigma \\ge 0$ 是对数正态标准差参数。假设为小应变、线性弹性和准静态条件。使用应变定义 $\\varepsilon(x) = \\dfrac{du}{dx}$、胡克定律 (Hooke's law) $\\sigma_{xx}(x,\\xi) = E(\\xi)\\varepsilon(x)$ 以及轴向平衡方程 $\\dfrac{d}{dx}\\left(A\\,\\sigma_{xx}\\right) = 0$，可以推断出轴向应力是均匀的，等于 $\\sigma_{xx} = \\dfrac{P}{A}$，从而得到线性位移场\n$$\nu(x,\\xi) = \\frac{P\\,x}{A\\,E(\\xi)}.\n$$\n定义端部位移 $u_L(\\xi) \\equiv u(L,\\xi) = \\dfrac{P\\,L}{A\\,E(\\xi)}$。\n\n设随机解通过使用标准正交的概率论者Hermite多项式 $\\{\\psi_n(\\xi)\\}_{n=0}^p$（关于标准正态权重是标准正交的）的随机Galerkin (SG) 多项式混沌展开进行近似，并在总阶数 $p \\in \\mathbb{N}$ 处截断。即，\n$$\nu_L(\\xi) \\approx \\sum_{n=0}^{p} a_n \\,\\psi_n(\\xi).\n$$\nSG系数 $\\{a_n\\}$ 是 $u_L(\\xi)$ 在此标准正交基中的展开系数。对于这样的标准正交基，截断的SG解的均值和方差由下式给出\n$$\n\\mathbb{E}\\left[u_L\\right] \\approx a_0, \n\\qquad\n\\mathrm{Var}\\left[u_L\\right] \\approx \\sum_{n=1}^{p} a_n^2.\n$$\n您的任务是根据基本原理完成以下所有内容：\n- 使用杆力学和给定的随机模型，将 $u_L(\\xi)$ 表示为一个确定性标量和一个纯粹的关于 $\\xi$ 的随机标量函数。\n- 根据使用标准正交概率论者Hermite基的随机Galerkin多项式混沌展开的定义，确定 $u_L(\\xi)$ 的SG系数 $\\{a_n\\}_{n=0}^{p}$。\n- 根据这些系数，计算SG近似的均值和方差。\n- 通过对 $\\xi$ 进行 $N_{\\text{MC}}$ 次独立抽样的直接蒙特卡洛 (Monte Carlo) 采样，独立地估计均值和方差，并为每次抽样评估相应的 $u_L(\\xi)$。\n- 通过使用相对误差将SG均值和方差与蒙特卡洛估计值进行比较来验证正确性；仅当均值和方差的相对误差都在其指定的容差范围内时，才将测试声明为“通过”。\n\n实现要求：\n- 单位：$L$ 使用 m，$A$ 使用 $\\mathrm{m}^2$，$P$ 使用 N，$E_0$ 使用 Pa；$u_L$ 的均值单位必须是 m，$u_L$ 的方差单位必须是 $\\mathrm{m}^2$。程序的最终输出是无量纲的布尔值。\n- 此问题不使用角度单位。\n- 不得使用百分比；所有容差都应解释为小数。\n\n测试套件：\n对于每个测试用例 $k$，给定 $(L, A, P, E_0, \\sigma, p, N_{\\text{MC}}, \\mathrm{tol}_{\\mu}, \\mathrm{tol}_{\\nu})$。从SG系数计算SG均值和方差，使用 $N_{\\text{MC}}$ 个样本计算均值和方差的蒙特卡洛估计值，并检查两个相对误差是否都在容差范围内。数量 $q$ 的相对误差为 $\\left|\\dfrac{q_{\\mathrm{SG}} - q_{\\mathrm{MC}}}{q_{\\mathrm{MC}}}\\right|$。\n\n使用以下三个测试用例：\n1. 用例1（中等变异性，中等阶数）：\n   - $L = 2.0$, $A = 0.01$, $P = 1000.0$, $E_0 = 210\\times 10^{9}$, $\\sigma = 0.10$, $p = 4$, $N_{\\text{MC}} = 120000$, $\\mathrm{tol}_{\\mu} = 0.01$, $\\mathrm{tol}_{\\nu} = 0.03$.\n2. 用例2（接近确定性，极低阶数）：\n   - $L = 1.0$, $A = 0.005$, $P = 500.0$, $E_0 = 70\\times 10^{9}$, $\\sigma = 0.01$, $p = 1$, $N_{\\text{MC}} = 60000$, $\\mathrm{tol}_{\\mu} = 0.01$, $\\mathrm{tol}_{\\nu} = 0.03$.\n3. 用例3（较高变异性，较高阶数）：\n   - $L = 1.5$, $A = 0.02$, $P = 1500.0$, $E_0 = 100\\times 10^{9}$, $\\sigma = 0.40$, $p = 8$, $N_{\\text{MC}} = 200000$, $\\mathrm{tol}_{\\mu} = 0.01$, $\\mathrm{tol}_{\\nu} = 0.03$.\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如，\n  $[r_1,r_2,r_3]$, \n  其中 $r_k$ 是一个布尔值，当且仅当测试用例 $k$ 的均值和方差相对误差都小于或等于各自的容差时为 $\\mathrm{True}$，否则为 $\\mathrm{False}$。\n- 不应打印任何额外文本。\n- 为每个测试用例使用独立的随机种子，以确保可复现性。\n- 最终程序必须是自包含的，并且可按原样运行，无需用户输入或外部文件。它必须实现上述完整的工作流程：推导适用于所选基的SG系数表达式，根据这些系数计算均值和方差，执行蒙特卡洛估计，并在指定容差内进行比较。", "solution": "对所述问题进行验证。\n\n**步骤1：提取给定条件**\n\n- **物理系统**：一根长度为 $L$、横截面积恒为 $A$ 的一维弹性杆。\n- **边界条件**：在 $x=0$ 处固定，在 $x=L$ 处施加轴向载荷 $P$。\n- **材料模型**：杨氏模量 $E$ 是一个随机变量，$E(\\xi) = E_0 \\exp(\\sigma \\xi)$，其中 $\\xi \\sim \\mathcal{N}(0,1)$，$E_0 > 0$ 是模量中值，$\\sigma \\ge 0$ 是一个参数。\n- **控制方程**：\n    - 应变：$\\varepsilon(x) = \\frac{du}{dx}$。\n    - 胡克定律：$\\sigma_{xx}(x,\\xi) = E(\\xi)\\varepsilon(x)$。\n    - 平衡方程：$\\frac{d}{dx}(A\\sigma_{xx}) = 0$。\n- **推导位移**：问题陈述端部位移为 $u_L(\\xi) \\equiv u(L,\\xi) = \\frac{PL}{A E(\\xi)}$。\n- **随机近似**：使用多项式混沌 (Polynomial Chaos, PC) 展开的随机Galerkin (SG) 方法，采用在阶数 $p$ 截断的标准正交概率论者Hermite多项式 $\\{\\psi_n(\\xi)\\}_{n=0}^p$。\n    - 近似式：$u_L(\\xi) \\approx \\sum_{n=0}^{p} a_n \\psi_n(\\xi)$。\n- **统计矩 (SG)**：\n    - 均值：$\\mathbb{E}[u_L] \\approx a_0$。\n    - 方差：$\\mathrm{Var}[u_L] \\approx \\sum_{n=1}^{p} a_n^2$。\n- **验证**：使用 $N_{\\text{MC}}$ 个样本进行直接蒙特卡洛 (MC) 模拟。\n- **比较指标**：均值 ($\\mu$) 和方差 ($\\nu$) 的相对误差 $\\left|\\frac{q_{\\mathrm{SG}} - q_{\\mathrm{MC}}}{q_{\\mathrm{MC}}}\\right|$ 与容差 $\\mathrm{tol}_{\\mu}$ 和 $\\mathrm{tol}_{\\nu}$ 进行比较。\n- **测试用例**：\n    1.  $(L, A, P, E_0, \\sigma, p, N_{\\text{MC}}, \\mathrm{tol}_{\\mu}, \\mathrm{tol}_{\\nu}) = (2.0, 0.01, 1000.0, 210\\times 10^{9}, 0.10, 4, 120000, 0.01, 0.03)$。\n    2.  $(L, A, P, E_0, \\sigma, p, N_{\\text{MC}}, \\mathrm{tol}_{\\mu}, \\mathrm{tol}_{\\nu}) = (1.0, 0.005, 500.0, 70\\times 10^{9}, 0.01, 1, 60000, 0.01, 0.03)$。\n    3.  $(L, A, P, E_0, \\sigma, p, N_{\\text{MC}}, \\mathrm{tol}_{\\mu}, \\mathrm{tol}_{\\nu}) = (1.5, 0.02, 1500.0, 100\\times 10^{9}, 0.40, 8, 200000, 0.01, 0.03)$。\n- **输出**：一个布尔值列表，指示每个测试是否通过。\n\n**步骤2：使用提取的给定条件进行验证**\n\n对问题的有效性进行审查。\n- **科学依据**：物理模型是线性弹性静力学中的一个基本问题。杨氏模量的随机模型（对数正态分布）是标准的，并且适用于严格为正的物理量。多项式混沌展开方法是计算科学与工程中用于不确定性传播的一种成熟且数学上严谨的技术。该问题在科学上是合理的。\n- **适定性**：所有必需的参数都已提供。公式是明确的。待近似的函数 $u_L(\\xi)$ 是良态的。对于平方可积函数，多项式混沌系数的存在性和唯一性得到保证，而 $u_L(\\xi)$ 相对于高斯测度是平方可积的。该问题是适定的。\n- **客观性**：问题以客观、数学的术语陈述，不含主观或无法形式化的内容。\n\n**步骤3：结论与行动**\n\n问题是有效的。将提供一个完整的解答。\n\n**解答推导**\n\n按要求从基本原理进行推导。\n\n**1. 端部位移的表达式**\n\n端部位移 $u_L(\\xi)$ 是作为标准高斯随机变量 $\\xi$ 的函数给出的。通过将随机杨氏模量 $E(\\xi)$ 的表达式代入位移公式，我们得到：\n$$\nu_L(\\xi) = \\frac{PL}{A E(\\xi)} = \\frac{PL}{A \\left(E_0 \\exp(\\sigma \\xi)\\right)} = \\frac{PL}{A E_0} \\exp(-\\sigma \\xi)\n$$\n该表达式可以分离为一个确定性标量部分和一个纯粹的关于 $\\xi$ 的随机标量函数。设确定性常数为 $C$：\n$$\nC = \\frac{PL}{AE_0}\n$$\n并设随机部分为 $g(\\xi)$：\n$$\ng(\\xi) = \\exp(-\\sigma \\xi)\n$$\n因此，我们关注的量是 $u_L(\\xi) = C \\cdot g(\\xi)$。\n\n**2. 随机Galerkin系数**\n\n目标是找到近似式中的系数 $\\{a_n\\}$：\n$$\nu_L(\\xi) \\approx \\sum_{n=0}^{p} a_n \\psi_n(\\xi)\n$$\n其中 $\\{\\psi_n(\\xi)\\}$ 是概率论者Hermite多项式的标准正交基。由于 $u_L(\\xi) = C \\cdot g(\\xi)$，我们只需要找到 $g(\\xi) = \\exp(-\\sigma \\xi)$ 的PC展开。$u_L(\\xi)$ 的系数将是 $g(\\xi)$ 系数的 $C$ 倍。\n\n我们利用概率论者Hermite多项式 $H_n(\\xi)$ 的生成函数：\n$$\n\\exp\\left(\\alpha \\xi - \\frac{\\alpha^2}{2}\\right) = \\sum_{n=0}^{\\infty} \\frac{H_n(\\xi)}{n!} \\alpha^n\n$$\n整理后得到指数函数 $\\exp(\\alpha \\xi)$ 的展开式：\n$$\n\\exp(\\alpha \\xi) = \\exp\\left(\\frac{\\alpha^2}{2}\\right) \\sum_{n=0}^{\\infty} \\frac{H_n(\\xi)}{n!} \\alpha^n\n$$\n标准正交多项式 $\\psi_n(\\xi)$ 与 $H_n(\\xi)$ 的关系为 $\\psi_n(\\xi) = \\frac{H_n(\\xi)}{\\sqrt{n!}}$。将 $H_n(\\xi) = \\sqrt{n!} \\psi_n(\\xi)$ 代入展开式得到：\n$$\n\\exp(\\alpha \\xi) = \\exp\\left(\\frac{\\alpha^2}{2}\\right) \\sum_{n=0}^{\\infty} \\frac{\\sqrt{n!} \\psi_n(\\xi)}{n!} \\alpha^n = \\exp\\left(\\frac{\\alpha^2}{2}\\right) \\sum_{n=0}^{\\infty} \\frac{\\alpha^n}{\\sqrt{n!}} \\psi_n(\\xi)\n$$\n我们寻求 $g(\\xi) = \\exp(-\\sigma \\xi)$ 的展开式，这对应于设置 $\\alpha = -\\sigma$：\n$$\n\\exp(-\\sigma \\xi) = \\exp\\left(\\frac{(-\\sigma)^2}{2}\\right) \\sum_{n=0}^{\\infty} \\frac{(-\\sigma)^n}{\\sqrt{n!}} \\psi_n(\\xi) = \\exp\\left(\\frac{\\sigma^2}{2}\\right) \\sum_{n=0}^{\\infty} \\frac{(-\\sigma)^n}{\\sqrt{n!}} \\psi_n(\\xi)\n$$\n$u_L(\\xi)$ 的PC展开式则为：\n$$\nu_L(\\xi) = C \\cdot \\exp(-\\sigma \\xi) = \\left(\\frac{PL}{AE_0}\\right) \\exp\\left(\\frac{\\sigma^2}{2}\\right) \\sum_{n=0}^{\\infty} \\frac{(-\\sigma)^n}{\\sqrt{n!}} \\psi_n(\\xi)\n$$\n通过将其与 $u_L(\\xi) \\approx \\sum_{n=0}^{p} a_n \\psi_n(\\xi)$ 进行比较，我们确定SG系数 $a_n$ 的解析表达式：\n$$\na_n = \\frac{PL}{AE_0} \\exp\\left(\\frac{\\sigma^2}{2}\\right) \\frac{(-\\sigma)^n}{\\sqrt{n!}}\n$$\n\n**3. SG近似的均值和方差**\n\n使用提供的公式，我们从系数 $\\{a_n\\}_{n=0}^p$ 计算近似的均值和方差。\n\n均值由 $a_0$ 近似：\n$$\n\\mu_{\\text{SG}} = a_0 = \\frac{PL}{AE_0} \\exp\\left(\\frac{\\sigma^2}{2}\\right) \\frac{(-\\sigma)^0}{\\sqrt{0!}} = \\frac{PL}{AE_0} \\exp\\left(\\frac{\\sigma^2}{2}\\right)\n$$\n方差由高阶系数的平方和近似：\n$$\n\\nu_{\\text{SG}} = \\sum_{n=1}^{p} a_n^2 = \\sum_{n=1}^{p} \\left( \\frac{PL}{AE_0} \\exp\\left(\\frac{\\sigma^2}{2}\\right) \\frac{(-\\sigma)^n}{\\sqrt{n!}} \\right)^2\n$$\n$$\n\\nu_{\\text{SG}} = \\left(\\frac{PL}{AE_0}\\right)^2 \\exp(\\sigma^2) \\sum_{n=1}^{p} \\frac{(\\sigma^2)^n}{n!}\n$$\n这些公式提供了一种从问题参数直接计算统计矩的方法，无需进行数值积分。\n\n**4. 蒙特卡洛估计**\n\n为了验证，我们执行标准的蒙特卡洛模拟。步骤如下：\n1.  从标准正态分布 $\\mathcal{N}(0,1)$ 中生成大量（$N_{\\text{MC}}$）随机变量 $\\xi$ 的独立样本，记为 $\\{\\xi_i\\}_{i=1}^{N_{\\text{MC}}}$。\n2.  对每个样本 $\\xi_i$，评估相应的端部位移结果：\n    $$\n    u_{L,i} = u_L(\\xi_i) = \\frac{PL}{AE_0} \\exp(-\\sigma \\xi_i)\n    $$\n3.  从结果集 $\\{u_{L,i}\\}$ 中估计均值 ($\\hat{\\mu}_{\\text{MC}}$) 和方差 ($\\hat{\\nu}_{\\text{MC}}$)：\n    $$\n    \\hat{\\mu}_{\\text{MC}} = \\frac{1}{N_{\\text{MC}}} \\sum_{i=1}^{N_{\\text{MC}}} u_{L,i}\n    $$\n    $$\n    \\hat{\\nu}_{\\text{MC}} = \\frac{1}{N_{\\text{MC}}-1} \\sum_{i=1}^{N_{\\text{MC}}} (u_{L,i} - \\hat{\\mu}_{\\text{MC}})^2\n    $$\n在方差的分母中使用 $N_{\\text{MC}}-1$ 提供了无偏样本方差估计。\n\n**5. 验证与实现逻辑**\n\n对每个测试用例，执行以下步骤：\n1.  计算确定性常数 $C = PL/(AE_0)$。\n2.  使用推导出的解析公式和给定的截断阶数 $p$，计算SG近似的均值 $\\mu_{\\text{SG}}$ 和方差 $\\nu_{\\text{SG}}$。\n3.  执行具有 $N_{\\text{MC}}$ 个样本的蒙特卡洛模拟，以获得估计值 $\\hat{\\mu}_{\\text{MC}}$ 和 $\\hat{\\nu}_{\\text{MC}}$。\n4.  计算均值和方差的相对误差：\n    $$\n    \\text{err}_{\\mu} = \\left| \\frac{\\mu_{\\text{SG}} - \\hat{\\mu}_{\\text{MC}}}{\\hat{\\mu}_{\\text{MC}}} \\right|, \\qquad \\text{err}_{\\nu} = \\left| \\frac{\\nu_{\\text{SG}} - \\hat{\\nu}_{\\text{MC}}}{\\hat{\\nu}_{\\text{MC}}} \\right|\n    $$\n5.  当且仅当两个误差条件都满足时，即 $\\text{err}_{\\mu} \\le \\mathrm{tol}_{\\mu}$ 和 $\\text{err}_{\\nu} \\le \\mathrm{tol}_{\\nu}$，测试用例才通过。结果被记录为布尔值。\n整个过程在提供的Python代码中实现。", "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    使用随机Galerkin和蒙特卡洛方法解决随机杆问题，并根据指定的容差验证结果。\n    \"\"\"\n    \n    # Test cases: (L, A, P, E0, sigma, p, N_MC, tol_mu, tol_nu)\n    test_cases = [\n        # Case 1 (moderate variability, moderate order)\n        (2.0, 0.01, 1000.0, 210e9, 0.10, 4, 120000, 0.01, 0.03),\n        # Case 2 (near-deterministic, very low order)\n        (1.0, 0.005, 500.0, 70e9, 0.01, 1, 60000, 0.01, 0.03),\n        # Case 3 (higher variability, higher order)\n        (1.5, 0.02, 1500.0, 100e9, 0.40, 8, 200000, 0.01, 0.03),\n    ]\n\n    results = []\n    \n    for i, case in enumerate(test_cases):\n        L, A, P, E0, sigma, p, N_MC, tol_mu, tol_nu = case\n\n        # --- Stochastic Galerkin (SG) Part ---\n\n        # Deterministic constant C = PL / (A * E0)\n        C = (P * L) / (A * E0)\n\n        # Calculate SG coefficients a_n for n=0 to p\n        # a_n = C * exp(sigma^2 / 2) * (-sigma)^n / sqrt(n!)\n        coeffs_a = np.zeros(p + 1)\n        common_factor = C * math.exp(sigma**2 / 2.0)\n        \n        for n in range(p + 1):\n            # Calculate factorial(n) iteratively if it were needed for large numbers,\n            # but math.factorial is fine for small p.\n            try:\n                # Use math.sqrt and math.factorial for scalar math\n                a_n = common_factor * ((-sigma)**n) / math.sqrt(math.factorial(n))\n                coeffs_a[n] = a_n\n            except OverflowError:\n                # Handle potential overflow for large n, though not expected here\n                coeffs_a[n] = 0.0\n\n        # SG Mean: mu_SG = a_0\n        mu_sg = coeffs_a[0]\n\n        # SG Variance: nu_SG = sum_{n=1 to p} a_n^2\n        # Use vectorized operation on the slice of coefficients from index 1.\n        nu_sg = np.sum(coeffs_a[1:]**2)\n\n        # --- Monte Carlo (MC) Part ---\n\n        # Set a unique random seed for each test case for reproducibility\n        np.random.seed(i)\n\n        # Generate N_MC standard normal random samples for xi\n        xi_samples = np.random.randn(N_MC)\n\n        # Calculate the end displacement u_L for each sample\n        # u_L(xi) = C * exp(-sigma * xi)\n        u_L_samples = C * np.exp(-sigma * xi_samples)\n\n        # MC Mean estimate\n        mu_mc = np.mean(u_L_samples)\n        \n        # MC Variance estimate (unbiased, ddof=1)\n        nu_mc = np.var(u_L_samples, ddof=1)\n\n        # --- Comparison and Verification Part ---\n\n        # Calculate relative errors\n        # Handle the case where the MC estimate is near zero to avoid division by zero\n        if abs(mu_mc) > 1e-15:\n            rel_err_mu = abs((mu_sg - mu_mc) / mu_mc)\n        else: # If MC mean is virtually zero, only an exact match is acceptable\n            rel_err_mu = abs(mu_sg - mu_mc)\n\n        if abs(nu_mc) > 1e-15:\n            rel_err_nu = abs((nu_sg - nu_mc) / nu_mc)\n        else: # If MC variance is virtually zero\n            rel_err_nu = abs(nu_sg - nu_mc)\n            \n        # Check if both errors are within tolerance\n        test_passed = (rel_err_mu = tol_mu) and (rel_err_nu = tol_nu)\n        results.append(test_passed)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2686984"}]}