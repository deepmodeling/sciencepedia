{"hands_on_practices": [{"introduction": "在拓扑优化中，数值不稳定性（如棋盘格和网格依赖性）是一个核心挑战。本练习通过一个简化的思想实验，揭示了棋盘格现象的根本原因 [@problem_id:2606624]。你将通过直接计算来证明，在某些情况下，非物理的棋盘格设计为何会表现出比均匀设计更优的“表观”刚度，从而理解为何需要正则化方法来获得有意义的解。", "problem": "考虑采用固体各向同性材料惩罚法（SIMP）对弹性模量进行插值的线性弹性拓扑优化问题。设一个单位厚度、单位正方形的域 $\\Omega = [0,1]\\times [0,1]$ 被一个由双线性四边形有限元组成的均匀 $2 \\times 2$ 网格离散化。假设为平面应力状态，泊松比 $\\nu = 0$，因此单轴能量密度简化为一维形式。弹性模量通过SIMP插值为 $E(\\rho) = E_{\\min} + \\rho^{p}\\left(E_{0} - E_{\\min}\\right)$，其中惩罚指数 $p > 1$。对于此问题，为专注于不稳定机制，设置 $E_{\\min} = 0$，并取 $E_{0} > 0$ 为一个常数。\n\n通过在所有边界节点上规定位移场 $\\mathbf{u}(x,y) = (U x, 0)$ 来施加运动一致性边界条件（KUBC），其中 $U = 1$。使用双线性形函数，该边界条件在每个单元内被精确再现，因此应变为均匀的，即 $\\epsilon_{xx} = 1$，所有其他分量均为零。\n\n将有效刚度 $K_{\\mathrm{eff}}$ 定义为边界 $\\{x=1\\}$ 上 $x$ 方向的总反力除以施加的标量 $U$。\n\n构建两种具有相同体积分数 $\\bar{\\rho} = \\frac{1}{2}$ 的设计：\n(1) 均匀设计，其中所有四个单元的密度 $\\rho_{e} \\equiv \\bar{\\rho}$，以及\n(2) 棋盘格设计，其中密度 $\\rho_{e} \\in \\{0,1\\}$，其排列方式为两个对角线相对的单元密度为 $\\rho_{e} = 1$，另外两个单元密度为 $\\rho_{e} = 0$，得出相同的平均体积分数 $\\bar{\\rho} = \\frac{1}{2}$。\n\n从最小势能原理和 $K_{\\mathrm{eff}}$ 的定义出发，推导表观刚度优势因子 $R_{\\mathrm{pre}}$ 的表达式，该因子定义为棋盘格设计的有效刚度与均匀设计的有效刚度之比，即 $R_{\\mathrm{pre}} = \\dfrac{K_{\\mathrm{eff}}^{\\mathrm{checker}}}{K_{\\mathrm{eff}}^{\\mathrm{uniform}}}$，且仅用 $p$ 表示。\n\n然后，对所有四个单元应用权重均匀的线性密度滤波器，即对每个单元 $e$，定义过滤后的密度 $\\tilde{\\rho}_{e} = \\dfrac{1}{4}\\sum_{j=1}^{4} \\rho_{j}$，并重新计算过滤后的棋盘格设计的有效刚度。使用相同的推理基础，解释为什么过滤后的比率 $R_{\\mathrm{post}} = \\dfrac{K_{\\mathrm{eff}}^{\\mathrm{filtered\\ checker}}}{K_{\\mathrm{eff}}^{\\mathrm{uniform}}}$ 变为1。\n\n请提供仅用 $p$ 表示的 $R_{\\mathrm{pre}}$ 的闭式解析表达式作为最终答案。无需进行数值代入。将最终答案表示为无单位的单个解析表达式。", "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，问题设定良好、客观，并包含足够的信息以获得唯一解。我们可以继续。\n\n此问题的核心在于系统的总应变能 $\\mathcal{U}$ 与其有效刚度 $K_{\\mathrm{eff}}$ 之间的关系。对于承受指定边界位移的线性弹性系统，平衡状态下的总应变能由 $\\mathcal{U} = \\frac{1}{2} K_{\\mathrm{eff}} U^2$ 给出，其中 $U$ 是所施加位移的特征大小。在此问题中，给定 $U=1$。因此，该关系简化为 $K_{\\mathrm{eff}} = 2\\mathcal{U}$。\n\n总应变能 $\\mathcal{U}$ 是应变能密度 $w$ 在整个域体积 $V$ 上的积分。由于该域被离散为4个有限元，这等于每个单元中能量的总和：\n$$ \\mathcal{U} = \\sum_{e=1}^{4} \\mathcal{U}_e = \\sum_{e=1}^{4} \\int_{\\Omega_e} w_e \\, dV $$\n应变能密度为 $w = \\frac{1}{2} \\boldsymbol{\\epsilon}^T \\mathbf{C} \\boldsymbol{\\epsilon}$。对于泊松比 $\\nu=0$ 的平面应力条件，本构矩阵 $\\mathbf{C}$ 是对角矩阵：\n$$ \\mathbf{C} = E(\\rho) \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix} $$\n问题陈述指出，运动一致性边界条件（KUBC）导致均匀的应变场 $\\epsilon_{xx}=1$，所有其他分量均为零。因此，应变向量为 $\\boldsymbol{\\epsilon} = (1, 0, 0)^T$。在密度为 $\\rho_e$ 的单元 $e$ 内的应变能密度为：\n$$ w_e = \\frac{1}{2} E(\\rho_e) (1)^2 = \\frac{1}{2} E(\\rho_e) $$\n该域是一个单位厚度的单位正方形，因此其总体积为1。$2 \\times 2$ 的均匀网格意味着4个单元中的每一个都具有体积 $V_e = \\frac{1}{4}$。由于应变场是均匀的，且每个单元内的材料属性是恒定的，因此单个单元的应变能为：\n$$ \\mathcal{U}_e = w_e V_e = \\left(\\frac{1}{2} E(\\rho_e)\\right) \\left(\\frac{1}{4}\\right) = \\frac{1}{8} E(\\rho_e) $$\n4单元组合体的总应变能是其总和：\n$$ \\mathcal{U} = \\sum_{e=1}^{4} \\mathcal{U}_e = \\frac{1}{8} \\sum_{e=1}^{4} E(\\rho_e) $$\n使用给定的SIMP定律 $E(\\rho) = E_0 \\rho^p$（因为 $E_{\\min}=0$），总应变能为：\n$$ \\mathcal{U} = \\frac{E_0}{8} \\sum_{e=1}^{4} \\rho_e^p $$\n因此，有效刚度为：\n$$ K_{\\mathrm{eff}} = 2\\mathcal{U} = \\frac{E_0}{4} \\sum_{e=1}^{4} \\rho_e^p $$\n这个通用表达式允许我们计算任何给定密度分布 $\\{\\rho_e\\}$ 的刚度。\n\n首先，我们分析均匀设计。在此设计中，所有4个单元的密度均为 $\\rho_e = \\bar{\\rho} = \\frac{1}{2}$。\n$$ K_{\\mathrm{eff}}^{\\mathrm{uniform}} = \\frac{E_0}{4} \\sum_{e=1}^{4} \\left(\\frac{1}{2}\\right)^p = \\frac{E_0}{4} \\left(4 \\cdot \\left(\\frac{1}{2}\\right)^p\\right) = E_0 \\left(\\frac{1}{2}\\right)^p = E_0 2^{-p} $$\n\n接着，我们分析棋盘格设计。在此设计中，两个对角单元的密度为 $\\rho_e = 1$，另外两个单元的密度为 $\\rho_e = 0$。\n$$ K_{\\mathrm{eff}}^{\\mathrm{checker}} = \\frac{E_0}{4} \\left(1^p + 0^p + 1^p + 0^p\\right) = \\frac{E_0}{4} (1 + 0 + 1 + 0) = \\frac{E_0}{4}(2) = \\frac{E_0}{2} $$\n注意，对于 $p>1$，$0^p=0$。密度为零的单元的刚度正确地为零。\n\n表观刚度优势因子 $R_{\\mathrm{pre}}$ 是这两种刚度的比值：\n$$ R_{\\mathrm{pre}} = \\frac{K_{\\mathrm{eff}}^{\\mathrm{checker}}}{K_{\\mathrm{eff}}^{\\mathrm{uniform}}} = \\frac{E_0/2}{E_0 2^{-p}} = \\frac{1}{2} \\cdot 2^p = 2^{p-1} $$\n该结果展示了在SIMP模型下棋盘格图案的人为刚化效应。因为当 $p>1$ 时惩罚函数 $f(\\rho) = \\rho^p$ 是凸函数，根据延森不等式（Jensen's inequality），插值模量的算术平均值大于平均密度的模量：$\\frac{1}{N}\\sum E(\\rho_i) \\geq E(\\frac{1}{N}\\sum \\rho_i)$。KUBC设置在物理上实现了算术平均（Voigt界），从而赋予棋盘格设计更高的表观刚度。\n\n现在我们考虑在所有4个单元上应用权重均匀的线性密度滤波器。任意单元 $e$ 的经过滤波的密度（或称物理密度）$\\tilde{\\rho}_e$ 由设计密度 $\\rho_j$ 的平均值给出：\n$$ \\tilde{\\rho}_{e} = \\frac{1}{4} \\sum_{j=1}^{4} \\rho_{j} $$\n对于棋盘格设计，设计密度为 $\\{\\rho_1, \\rho_2, \\rho_3, \\rho_4\\} = \\{1, 0, 1, 0\\}$（或其任意排列）。其总和为 $\\sum \\rho_j = 1+0+1+0 = 2$。\n应用滤波器后，我们发现每个单元的物理密度为：\n$$ \\tilde{\\rho}_{e} = \\frac{1}{4}(2) = \\frac{1}{2} $$\n经过滤波后，棋盘格设计转变为一个每个单元的物理密度都为 $\\frac{1}{2}$ 的设计。这与原始的均匀设计完全相同。刚度是使用这些物理密度 $\\tilde{\\rho}_e$ 计算的：\n$$ K_{\\mathrm{eff}}^{\\mathrm{filtered\\ checker}} = \\frac{E_0}{4} \\sum_{e=1}^{4} (\\tilde{\\rho}_e)^p = \\frac{E_0}{4} \\sum_{e=1}^{4} \\left(\\frac{1}{2}\\right)^p = E_0 2^{-p} $$\n根据构造，这与 $K_{\\mathrm{eff}}^{\\mathrm{uniform}}$ 完全相同。\n因此，过滤后的比率 $R_{\\mathrm{post}}$ 为：\n$$ R_{\\mathrm{post}} = \\frac{K_{\\mathrm{eff}}^{\\mathrm{filtered\\ checker}}}{K_{\\mathrm{eff}}^{\\mathrm{uniform}}} = \\frac{E_0 2^{-p}}{E_0 2^{-p}} = 1 $$\n滤波器通过强制施加一个长度尺度来消除人为的刚度优势，在应用物理（刚度计算）之前，有效地将高频棋盘格图案平滑处理为其体积平均值。在这个使用全局平均滤波器的特定情况下，棋盘格设计在物理上变得与均匀设计无法区分，因此它们的刚度必然相等。\n\n问题要求给出 $R_{\\mathrm{pre}}$ 的解析表达式。", "answer": "$$\\boxed{2^{p-1}}$$", "id": "2606624"}, {"introduction": "作为前一个练习中提出的数值不稳定性的直接对策，密度过滤是一种强大的技术。本练习将引导你手动实现一个标准的密度滤波器，让你亲手计算它如何平滑设计变量场 [@problem_id:2704300]。通过在小尺寸网格上进行这种“纸笔”计算，你将直观地理解过滤操作如何引入长度尺度、抑制高频振荡，并最终生成更清晰、更具可制造性的结构。", "problem": "考虑一个用于各向同性材料实体惩罚（SIMP）拓扑优化的方形有限元网格。该网格由一个均匀的 $5 \\times 5$ 方形单元阵列组成，单元边长为 $h$，单元形心位于 $(i h, j h)$，其中 $i,j \\in \\{1,2,3,4,5\\}$。在此网格上给定了一个无量纲的设计变量（密度）场 $\\rho_{i j}$，如下所示\n$$\n\\begin{pmatrix}\n0.2 & 0.9 & 0.1 & 0.7 & 0.3 \\\\\n0.8 & 0.4 & 0.6 & 0.2 & 1.0 \\\\\n0.5 & 0.3 & 0.9 & 0.0 & 0.4 \\\\\n0.7 & 0.2 & 0.8 & 0.5 & 0.1 \\\\\n0.6 & 0.0 & 0.3 & 0.4 & 0.2\n\\end{pmatrix}.\n$$\n为抑制网格依赖性伪影并增强数值稳定性，应用 SIMP 中的标准密度过滤器，其过滤半径为 $r_{\\min} = 1.5 h$，使用单元形心之间的欧几里得距离和线性衰减权重。具体而言，对于每个单元 $(i,j)$，定义\n$$\nw_{i j p q} = \\max\\!\\bigl(0,\\, r_{\\min} - d_{i j p q} \\bigr), \\quad d_{i j p q} = \\sqrt{\\bigl((i-p) h\\bigr)^{2} + \\bigl((j-q) h\\bigr)^{2}},\n$$\n以及过滤后的密度\n$$\n\\widetilde{\\rho}_{i j} = \\frac{\\displaystyle \\sum_{p=1}^{5} \\sum_{q=1}^{5} w_{i j p q}\\,\\rho_{p q}}{\\displaystyle \\sum_{p=1}^{5} \\sum_{q=1}^{5} w_{i j p q}}.\n$$\n从第一性原理出发，推导由 $r_{\\min} = 1.5 h$ 在此均匀网格上导出的显式模板，并精确计算所有 25 个单元的过滤场 $\\widetilde{\\rho}_{i j}$，将表达式保持为包含 $\\sqrt{2}$ 的封闭形式，不进行四舍五入。清晰说明您使用的任何对称类别（例如，内部、边缘、角点），并确保所有中间步骤均遵循上述定义。\n\n答案规格：\n- 在您的解答中，以精确的封闭形式（无数值四舍五入）提供完整的过滤场 $\\widetilde{\\rho}_{i j}$。\n- 作为您最终报告的答案，给出中心单元 $(i,j)=(3,3)$ 处的过滤密度，形式为单个封闭形式的解析表达式。不要四舍五入。无需单位。", "solution": "首先将对问题的科学合理性、适定性和客观性进行验证。\n\n**步骤 1：提取已知条件**\n- **网格**：一个均匀的 $5 \\times 5$ 方形有限元阵列。\n- **单元边长**：$h$。\n- **单元形心**：位于 $(i h, j h)$，其中 $i,j \\in \\{1,2,3,4,5\\}$。\n- **设计变量场 $\\rho_{i j}$**：提供了一个 $5 \\times 5$ 的无量纲密度值矩阵：\n$$\n\\rho = \\begin{pmatrix}\n0.2 & 0.9 & 0.1 & 0.7 & 0.3 \\\\\n0.8 & 0.4 & 0.6 & 0.2 & 1.0 \\\\\n0.5 & 0.3 & 0.9 & 0.0 & 0.4 \\\\\n0.7 & 0.2 & 0.8 & 0.5 & 0.1 \\\\\n0.6 & 0.0 & 0.3 & 0.4 & 0.2\n\\end{pmatrix}\n$$\n- **过滤半径**：$r_{\\min} = 1.5 h$。\n- **距离函数**：单元形心之间的欧几里得距离，$d_{i j p q} = \\sqrt{\\bigl((i-p) h\\bigr)^{2} + \\bigl((j-q) h\\bigr)^{2}}$。\n- **权重函数**：线性衰减权重，$w_{i j p q} = \\max\\!\\bigl(0,\\, r_{\\min} - d_{i j p q} \\bigr)$。\n- **过滤密度公式**：\n$$\n\\widetilde{\\rho}_{i j} = \\frac{\\displaystyle \\sum_{p=1}^{5} \\sum_{q=1}^{5} w_{i j p q}\\,\\rho_{p q}}{\\displaystyle \\sum_{p=1}^{5} \\sum_{q=1}^{5} w_{i j p q}}\n$$\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了在拓扑优化的各向同性材料实体惩罚（SIMP）方法中使用的标准密度过滤技术。所有公式和概念在计算力学中都是标准且成熟的。该问题具有科学依据。\n- **适定性**：该问题提供了所有必要信息：密度场、网格几何形状、过滤半径，以及权重函数和过滤操作的显式形式。过滤表达式的分母 $\\sum w_{ijpq}$ 恒为正，因为单元自身的权重 $w_{ijij} = r_{\\min} - d_{ijij} = 1.5 h > 0$，确保了不会出现除以零的情况。因此，对于过滤后的密度场 $\\widetilde{\\rho}_{i j}$ 存在唯一且稳定的解。\n- **客观性**：该问题以精确的数学语言陈述，没有歧义或主观论断。\n\n**步骤 3：结论与行动**\n该问题有效。将提供完整的解答。\n\n**解题推导**\n\n任务是计算所有 25 个单元的过滤密度场 $\\widetilde{\\rho}_{i j}$。计算从第一性原理出发。\n\n**1. 过滤模板推导**\n对于目标单元 $(i,j)$，过滤器的影响域包括所有权重 $w_{i j p q}$ 为正的邻近单元 $(p,q)$。此条件等效于 $d_{i j p q} < r_{\\min}$。\n通过除以单元尺寸 $h$，我们分析归一化的距离：\n$$ \\frac{d_{i j p q}}{h} = \\sqrt{(i-p)^{2} + (j-q)^{2}} < \\frac{r_{\\min}}{h} = 1.5 $$\n令 $\\Delta i = p-i$ 且 $\\Delta j = q-j$。条件为 $\\sqrt{(\\Delta i)^{2} + (\\Delta j)^{2}} < 1.5$。我们测试整数对 $(\\Delta i, \\Delta j)$：\n- $(\\Delta i, \\Delta j) = (0, 0)$：距离为 $0 < 1.5$。包含。\n- $(\\Delta i, \\Delta j) \\in \\{(\\pm 1, 0), (0, \\pm 1)\\}$：距离为 $\\sqrt{1^{2}+0^{2}} = 1 < 1.5$。包含。\n- $(\\Delta i, \\Delta j) \\in \\{(\\pm 1, \\pm 1)\\}$：距离为 $\\sqrt{1^{2}+1^{2}} = \\sqrt{2} \\approx 1.414 < 1.5$。包含。\n- $(\\Delta i, \\Delta j) \\in \\{(\\pm 2, 0), (0, \\pm 2)\\}$：距离为 $\\sqrt{2^{2}+0^{2}} = 2 > 1.5$。排除。\n任何其他整数对导致的距离都大于或等于 $2$。\n因此，过滤模板是一个以单元 $(i,j)$ 为中心的 $3 \\times 3$ 邻域。\n\n**2. 过滤权重**\n权重 $w_{ijpq}$ 与 $h$ 成正比。由于 $h$ 同时出现在过滤密度表达式的分子和分母中，它可以被消去。我们可以使用归一化权重 $w'_{ijpq} = w_{ijpq} / h$ 进行计算：\n- **中心权重** ($d=0$)：$w'_{c} = 1.5 - 0 = 1.5 = \\frac{3}{2}$。\n- **边邻居权重** ($d=h$)：$w'_{e} = 1.5 - 1 = 0.5 = \\frac{1}{2}$。\n- **角邻居权重** ($d=\\sqrt{2}h$)：$w'_{d} = 1.5 - \\sqrt{2} = \\frac{3}{2} - \\sqrt{2}$。\n\n**3. 单元分类与分母计算**\n单元 $(i,j)$ 处的过滤器的分母是其模板内所有单元的权重之和，即 $S_{ij} = \\sum_{p,q} w_{ijpq}$。我们定义归一化总和 $S'_{ij} = S_{ij}/h$。由于网格是有限的 $5 \\times 5$ 尺寸，模板在边界附近会被截断。我们根据对称性将单元分为三类。\n\n- **内部单元**：对于 $i,j \\in \\{2,3,4\\}$，完整的 $3 \\times 3$ 模板位于网格内部。其分母由一个中心权重、四个边邻居权重和四个角邻居权重组成。\n$$ S'_{int} = 1 \\cdot w'_{c} + 4 \\cdot w'_{e} + 4 \\cdot w'_{d} = 1(\\frac{3}{2}) + 4(\\frac{1}{2}) + 4(\\frac{3}{2} - \\sqrt{2}) = \\frac{3}{2} + 2 + 6 - 4\\sqrt{2} = \\frac{19}{2} - 4\\sqrt{2} $$\n\n- **边缘单元**：对于边界上但不在角点的单元，模板被裁剪。例如，位于垂直边缘上的单元有一个中心权重、三个边邻居权重和两个角邻居权重。\n$$ S'_{edge} = 1 \\cdot w'_{c} + 3 \\cdot w'_{e} + 2 \\cdot w'_{d} = 1(\\frac{3}{2}) + 3(\\frac{1}{2}) + 2(\\frac{3}{2} - \\sqrt{2}) = \\frac{3}{2} + \\frac{3}{2} + 3 - 2\\sqrt{2} = 6 - 2\\sqrt{2} $$\n\n- **角点单元**：对于四个角点单元，模板被最大程度地裁剪。它包括一个中心权重、两个边邻居权重和一个角邻居权重。\n$$ S'_{corner} = 1 \\cdot w'_{c} + 2 \\cdot w'_{e} + 1 \\cdot w'_{d} = 1(\\frac{3}{2}) + 2(\\frac{1}{2}) + 1(\\frac{3}{2} - \\sqrt{2}) = \\frac{3}{2} + 1 + \\frac{3}{2} - \\sqrt{2} = 4 - \\sqrt{2} $$\n\n**4. 过滤密度场计算**\n过滤后的密度计算公式为 $\\widetilde{\\rho}_{i j} = N'_{ij} / S'_{ij}$，其中 $N'_{ij} = \\sum_{p,q} w'_{ijpq} \\rho_{pq}$。我们对所有 25 个单元进行此计算。结果以精确的有理化形式给出。\n\n作为示例，我们演示中心单元 $\\widetilde{\\rho}_{33}$ 的计算过程，它属于内部类型。以 $(3,3)$ 为中心的 $\\rho$ 的相关 $3 \\times 3$ 子矩阵为：\n$$ \\begin{pmatrix} \\rho_{22} & \\rho_{23} & \\rho_{24} \\\\ \\rho_{32} & \\rho_{33} & \\rho_{34} \\\\ \\rho_{42} & \\rho_{43} & \\rho_{44} \\end{pmatrix} = \\begin{pmatrix} 0.4 & 0.6 & 0.2 \\\\ 0.3 & 0.9 & 0.0 \\\\ 0.2 & 0.8 & 0.5 \\end{pmatrix} $$\n归一化分子 $N'_{33}$ 是权重与这些密度逐元素相乘后的总和：\n$$ N'_{33} = w'_{c}\\rho_{33} + w'_{e}(\\rho_{23}+\\rho_{32}+\\rho_{34}+\\rho_{43}) + w'_{d}(\\rho_{22}+\\rho_{24}+\\rho_{42}+\\rho_{44}) $$\n$$ N'_{33} = \\frac{3}{2}(0.9) + \\frac{1}{2}(0.6+0.3+0.0+0.8) + (\\frac{3}{2}-\\sqrt{2})(0.4+0.2+0.2+0.5) $$\n$$ N'_{33} = 1.35 + \\frac{1}{2}(1.7) + (\\frac{3}{2}-\\sqrt{2})(1.3) = 1.35 + 0.85 + 1.95 - 1.3\\sqrt{2} = 4.15 - 1.3\\sqrt{2} $$\n以精确分数形式表示：$N'_{33} = \\frac{83}{20} - \\frac{13}{10}\\sqrt{2}$。\n$$ \\widetilde{\\rho}_{33} = \\frac{N'_{33}}{S'_{int}} = \\frac{\\frac{83}{20} - \\frac{13}{10}\\sqrt{2}}{\\frac{19}{2} - 4\\sqrt{2}} = \\frac{83 - 26\\sqrt{2}}{10(19 - 8\\sqrt{2})} $$\n为使分母有理化，我们将分子和分母同乘以共轭式 $19 + 8\\sqrt{2}$：\n$$ \\widetilde{\\rho}_{33} = \\frac{(83 - 26\\sqrt{2})(19 + 8\\sqrt{2})}{10(19^2 - (8\\sqrt{2})^2)} = \\frac{1577 + 664\\sqrt{2} - 494\\sqrt{2} - 416}{10(361 - 128)} = \\frac{1161 + 170\\sqrt{2}}{2330} $$\n对所有 25 个单元应用相同的步骤。完整的过滤密度场 $\\widetilde{\\rho}_{ij}$ 如下：\n$$\n\\widetilde{\\rho} = \n\\begin{pmatrix}\n\\frac{31}{70} + \\frac{3\\sqrt{2}}{280} & \\frac{43}{70} - \\frac{\\sqrt{2}}{35} & \\frac{3}{4} + \\frac{\\sqrt{2}}{20} & \\frac{23}{40} - \\frac{3\\sqrt{2}}{40} & \\frac{3}{7} + \\frac{2\\sqrt{2}}{35} \\\\\n\\frac{141}{280} - \\frac{11\\sqrt{2}}{280} & \\frac{1147+66\\sqrt{2}}{2330} & \\frac{837+128\\sqrt{2}}{2330} & \\frac{1079-114\\sqrt{2}}{2330} & \\frac{27}{35} - \\frac{4\\sqrt{2}}{35} \\\\\n\\frac{107}{280} + \\frac{13\\sqrt{2}}{280} & \\frac{1009+154\\sqrt{2}}{2330} & \\frac{1161+170\\sqrt{2}}{2330} & \\frac{983-86\\sqrt{2}}{2330} & \\frac{11}{35} + \\frac{\\sqrt{2}}{35} \\\\\n\\frac{29}{70} - \\frac{9\\sqrt{2}}{280} & \\frac{1133-12\\sqrt{2}}{2330} & \\frac{1159-158\\sqrt{2}}{2330} & \\frac{1109-122\\sqrt{2}}{2330} & \\frac{61}{280} - \\frac{13\\sqrt{2}}{280} \\\\\n\\frac{29}{70} + \\frac{3\\sqrt{2}}{56} & \\frac{3}{10} - \\frac{\\sqrt{2}}{35} & \\frac{11}{20} - \\frac{\\sqrt{2}}{20} & \\frac{29}{70} - \\frac{3\\sqrt{2}}{70} & \\frac{3}{10} - \\frac{\\sqrt{2}}{20}\n\\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\\frac{1161 + 170\\sqrt{2}}{2330}}\n$$", "id": "2704300"}, {"introduction": "梯度信息是驱动拓扑优化算法迭代的引擎，而灵敏度分析正是计算这些梯度的过程。本练习将聚焦于计算结构柔度相对于单元密度的灵敏度，这是优化准则法(OC)和移动渐近线法(MMA)等算法的关键输入 [@problem_id:2704316]。通过在一个给定的位移场下进行计算，你将把抽象的灵敏度公式与具体的物理量——单元应变能——联系起来，从而深化对SIMP方法工作机理的理解。", "problem": "考虑一个二维悬臂梁域，其面内尺寸为 $L \\times H = 4\\,\\text{m} \\times 2\\,\\text{m}$，单位厚度为 $t=1\\,\\text{m}$，该域被离散化为一个由双线性四边形单元组成的均匀 $4 \\times 2$ 网格（每个单元的面内尺寸为 $1\\,\\text{m} \\times 1\\,\\text{m}$）。材料是线性弹性、均匀且各向同性的，杨氏模量 $E=210\\times 10^{9}\\,\\text{Pa}$，泊松比 $\\nu=0.3$，处于平面应力条件下。在带有罚函数的固体各向同性材料 (Solid Isotropic Material with Penalization, SIMP) 方法中，单元材料密度规定为\n$$\n\\boldsymbol{\\rho}=\\begin{pmatrix}\n\\rho_{1,2} & \\rho_{2,2} & \\rho_{3,2} & \\rho_{4,2}\\\\\n\\rho_{1,1} & \\rho_{2,1} & \\rho_{3,1} & \\rho_{4,1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1.00 & 0.85 & 0.40 & 0.10\\\\\n0.95 & 0.75 & 0.50 & 0.20\n\\end{pmatrix},\n$$\n其中索引 $(i,j)$ 中，$i\\in\\{1,2,3,4\\}$ 从左到右，$j\\in\\{1,2\\}$ 从下到上。SIMP 罚函数指数为 $p=3$。\n\n给定一个运动学上容许的位移场（解释为网格上的后处理场）\n$$\nu_x(x,y)=a\\,x+c\\,y,\\qquad u_y(x,y)=d\\,x+b\\,y,\n$$\n其中常数 $a=0.01$，$b=-0.005$，$c=0.002$，$d=0.003$（所有应变均为小应变）。假设为平面应力线性弹性，并采用标准本构关系。\n\n任务：\n1) 使用小应变和线性弹性的基本定义，计算由给定位移场引起的恒定应变张量分量，并由此计算平面应力下的全材料应变能密度 $w_0=\\tfrac{1}{2}\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\sigma}$（即 $\\rho=1$ 时的情况）。然后，使用单元刚度的 SIMP 缩放因子 $\\rho_e^p$，计算每个单元 $e$ 中储存的应变能为 $U_e=\\rho_e^p\\,w_0\\,A\\,t$（单元面积 $A=1\\,\\text{m}^2$，厚度 $t=1\\,\\text{m}$）。\n\n2) 考虑由 $J=\\mathbf{f}^T \\mathbf{u}$ 定义的结构柔度，并使用线性系统的标准伴随方法，将其相对于每个单元密度 $\\rho_e$ 的 SIMP 灵敏度表示为 $\\dfrac{\\partial J}{\\partial \\rho_e}$ 的形式。使用给定数据对这些灵敏度进行数值评估。\n\n令 $S_{\\text{total}}=\\sum_{e}\\dfrac{\\partial J}{\\partial \\rho_e}$ 表示所有单元上柔度灵敏度的总和。数值计算 $S_{\\text{total}}$。\n\n将 $S_{\\text{total}}$ 的最终答案四舍五入到四位有效数字，并以焦耳为单位表示。最终答案必须是单个实数。", "solution": "所述问题需要进行验证。\n\n**第 1 步：提取已知条件**\n- 域尺寸：$L=4\\,\\text{m}$，$H=2\\,\\text{m}$，$t=1\\,\\text{m}$。\n- 网格：由双线性四边形单元组成的均匀 $4 \\times 2$ 网格。\n- 单元尺寸：面积 $A=1\\,\\text{m}^2$，厚度 $t=1\\,\\text{m}$。\n- 材料属性：杨氏模量 $E=210\\times 10^{9}\\,\\text{Pa}$，泊松比 $\\nu=0.3$。\n- 力学模型：线性弹性，平面应力。\n- SIMP 密度：\n$$\n\\boldsymbol{\\rho}=\\begin{pmatrix}\n1.00 & 0.85 & 0.40 & 0.10\\\\\n0.95 & 0.75 & 0.50 & 0.20\n\\end{pmatrix}\n$$\n- SIMP 罚函数指数：$p=3$。\n- 位移场：$u_x(x,y)=a\\,x+c\\,y$，$u_y(x,y)=d\\,x+b\\,y$。\n- 位移常数：$a=0.01$，$b=-0.005$，$c=0.002$，$d=0.003$。\n- 任务 1：计算应变张量、全材料应变能密度 $w_0$ 和单元应变能 $U_e=\\rho_e^p\\,w_0\\,A\\,t$。\n- 任务 2：使用伴随方法表达并评估柔度灵敏度 $\\dfrac{\\partial J}{\\partial \\rho_e}$，并计算总灵敏度 $S_{\\text{total}}=\\sum_{e}\\dfrac{\\partial J}{\\partial \\rho_e}$。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题在科学上基于线性弹性理论和带有罚函数的固体各向同性材料 (SIMP) 方法。所有给定的常数和材料属性在物理上都是现实的。该问题是适定的；它为所需的计算提供了所有必要的信息。任务以客观、精确的语言进行了规定。\n\n存在一个微小的歧义：“悬臂梁域”的描述意味着在 $x=0$ 处有固定边界条件，但给定的位移场 $u_x(0,y)=c\\,y$ 和 $u_y(0,y)=b\\,y$ 并不满足此条件（除非 $b=c=0$，但事实并非如此）。然而，问题明确指出该位移场是“给定的”，并应“解释为后处理场”。这阐明了我们不是要解决一个边值问题，而是要基于一个给定的状态进行计算。因此，该问题是一个定义明确的、应用连续介质力学和灵敏度分析公式的练习。它在科学上并非不合理或自相矛盾，而是一项指定的计算任务。\n\n**第 3 步：结论与行动**\n问题是**有效的**。开始求解。\n\n根据要求，解答分为两部分。\n\n**第 1 部分：应变和能量计算**\n\n首先，我们根据给定的位移场 $\\mathbf{u}=(u_x, u_y)$ 计算无穷小应变张量 $\\boldsymbol{\\varepsilon}$ 的分量。\n$$\nu_x(x,y) = a\\,x+c\\,y, \\qquad u_y(x,y) = d\\,x+b\\,y\n$$\n应变分量由以下公式给出：\n$$\n\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = a\n$$\n$$\n\\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = b\n$$\n$$\n\\varepsilon_{xy} = \\frac{1}{2} \\left( \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} \\right) = \\frac{1}{2} (c+d)\n$$\n代入给定的常数 $a=0.01$，$b=-0.005$，$c=0.002$ 和 $d=0.003$：\n$$\n\\varepsilon_{xx} = 0.01\n$$\n$$\n\\varepsilon_{yy} = -0.005\n$$\n$$\n\\varepsilon_{xy} = \\frac{1}{2} (0.002 + 0.003) = 0.0025\n$$\n由于位移场是 $x$ 和 $y$ 的线性函数，因此应变张量 $\\boldsymbol{\\varepsilon}$ 在整个域内是恒定的。\n\n接下来，我们计算全材料应变能密度 $w_0$，它对应于 $\\rho=1$ 的材料。在平面应力条件下，线性各向同性材料的应力-应变关系为：\n$$\n\\begin{pmatrix} \\sigma_{xx} \\\\ \\sigma_{yy} \\\\ \\sigma_{xy} \\end{pmatrix}_0 = \\frac{E}{1-\\nu^2} \\begin{pmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & \\frac{1-\\nu}{2} \\end{pmatrix} \\begin{pmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ 2\\varepsilon_{xy} \\end{pmatrix}\n$$\n应变能密度 $w_0$ 由 $w_0 = \\frac{1}{2} \\boldsymbol{\\sigma}_0 : \\boldsymbol{\\varepsilon} = \\frac{1}{2}(\\sigma_{xx,0}\\varepsilon_{xx} + \\sigma_{yy,0}\\varepsilon_{yy} + 2\\sigma_{xy,0}\\varepsilon_{xy})$ 给出。代入应力表达式，我们得到：\n$$\nw_0 = \\frac{1}{2} \\boldsymbol{\\varepsilon}^T \\mathbf{C}_0 \\boldsymbol{\\varepsilon} = \\frac{1}{2} \\frac{E}{1-\\nu^2} \\left[ \\varepsilon_{xx}^2 + \\varepsilon_{yy}^2 + 2\\nu\\varepsilon_{xx}\\varepsilon_{yy} + 2(1-\\nu)\\varepsilon_{xy}^2 \\right]\n$$\n使用给定的值 $E=210\\times 10^9\\,\\text{Pa}$ 和 $\\nu=0.3$：\n$$\n\\frac{E}{1-\\nu^2} = \\frac{210 \\times 10^9}{1 - 0.3^2} = \\frac{210 \\times 10^9}{0.91}\\,\\text{Pa}\n$$\n方括号中的项为：\n$$\n[\\ldots] = (0.01)^2 + (-0.005)^2 + 2(0.3)(0.01)(-0.005) + 2(1-0.3)(0.0025)^2\n$$\n$$\n[\\ldots] = 1 \\times 10^{-4} + 0.25 \\times 10^{-4} - 0.3 \\times 10^{-4} + 2(0.7)(6.25 \\times 10^{-6})\n$$\n$$\n[\\ldots] = (1 + 0.25 - 0.3) \\times 10^{-4} + 1.4(0.0625 \\times 10^{-4}) = (0.95 + 0.0875) \\times 10^{-4} = 1.0375 \\times 10^{-4}\n$$\n现在，我们计算 $w_0$：\n$$\nw_0 = \\frac{1}{2} \\left( \\frac{210 \\times 10^9}{0.91} \\right) (1.0375 \\times 10^{-4}) = \\frac{105 \\times 1.0375}{0.91} \\times 10^5 = \\frac{108.9375}{0.91} \\times 10^5 \\approx 1.19711538 \\times 10^7\\,\\text{J/m}^3\n$$\n每个单元 $e$ 中储存的应变能由 $U_e = \\rho_e^p w_0 A t$ 正确给出，因为单元内的应变能密度为 $w_e = \\rho_e^p w_0$，且体积为 $V_e=A\\,t=1\\,\\text{m}^3$。\n\n**第 2 部分：柔度灵敏度分析**\n结构柔度定义为 $J = \\mathbf{f}^T \\mathbf{u}$，其中 $\\mathbf{f}$ 是外力向量，$\\mathbf{u}$ 是线性方程组 $\\mathbf{K}(\\boldsymbol{\\rho})\\mathbf{u}=\\mathbf{f}$ 的位移向量解。刚度矩阵 $\\mathbf{K}$ 依赖于单元密度向量 $\\boldsymbol{\\rho}$。\n\n对于设计无关的载荷（$\\frac{\\partial \\mathbf{f}}{\\partial \\rho_e} = \\mathbf{0}$），使用标准的伴随方法，柔度相对于单元 $e$ 密度 $\\rho_e$ 的灵敏度为：\n$$\n\\frac{\\partial J}{\\partial \\rho_e} = \\frac{\\partial}{\\partial \\rho_e} (\\mathbf{f}^T \\mathbf{u}) = \\mathbf{f}^T \\frac{\\partial \\mathbf{u}}{\\partial \\rho_e}\n$$\n对状态方程 $\\mathbf{K}\\mathbf{u}=\\mathbf{f}$ 求导，我们得到 $\\frac{\\partial \\mathbf{K}}{\\partial \\rho_e}\\mathbf{u} + \\mathbf{K}\\frac{\\partial \\mathbf{u}}{\\partial \\rho_e} = \\mathbf{0}$，这给出 $\\frac{\\partial \\mathbf{u}}{\\partial \\rho_e} = -\\mathbf{K}^{-1}\\frac{\\partial \\mathbf{K}}{\\partial \\rho_e}\\mathbf{u}$。\n将此代入灵敏度表达式：\n$$\n\\frac{\\partial J}{\\partial \\rho_e} = -\\mathbf{f}^T \\mathbf{K}^{-1} \\frac{\\partial \\mathbf{K}}{\\partial \\rho_e} \\mathbf{u}\n$$\n由于 $\\mathbf{K}$ 是对称的，$\\mathbf{K}^{-1}$ 也是对称的。利用 $\\mathbf{f}^T \\mathbf{K}^{-1} = (\\mathbf{K}^{-1}\\mathbf{f})^T = \\mathbf{u}^T$，我们得到经典结果：\n$$\n\\frac{\\partial J}{\\partial \\rho_e} = -\\mathbf{u}^T \\frac{\\partial \\mathbf{K}}{\\partial \\rho_e} \\mathbf{u}\n$$\n在 SIMP 模型中，$\\mathbf{K}(\\boldsymbol{\\rho}) = \\sum_e K_e = \\sum_e \\rho_e^p K_{0,e}$，其中 $K_{0,e}$ 是实体材料的单元刚度矩阵。其导数为 $\\frac{\\partial \\mathbf{K}}{\\partial \\rho_e} = p\\rho_e^{p-1}K_{0,e}$。\n因此，灵敏度仅取决于局部单元的量：\n$$\n\\frac{\\partial J}{\\partial \\rho_e} = -\\mathbf{u}_e^T (p\\rho_e^{p-1}K_{0,e}) \\mathbf{u}_e = -p\\rho_e^{p-1} (\\mathbf{u}_e^T K_{0,e} \\mathbf{u}_e)\n$$\n项 $\\frac{1}{2}\\mathbf{u}_e^T K_{0,e} \\mathbf{u}_e$ 是单元 $e$ 在由实体材料构成时的应变能，$U_{0,e}$。由于应变是均匀的，$U_{0,e} = w_0 V_e = w_0 A t$。因此，$\\mathbf{u}_e^T K_{0,e} \\mathbf{u}_e = 2U_{0,e} = 2w_0 A t$。\n灵敏度表达式简化为：\n$$\n\\frac{\\partial J}{\\partial \\rho_e} = -p\\rho_e^{p-1} (2w_0 A t) = -2 p w_0 A t \\rho_e^{p-1}\n$$\n总柔度灵敏度 $S_{\\text{total}}$ 是所有 8 个单元的总和：\n$$\nS_{\\text{total}} = \\sum_{e=1}^{8} \\frac{\\partial J}{\\partial \\rho_e} = -2 p w_0 A t \\sum_{e=1}^{8} \\rho_e^{p-1}\n$$\n当 $p=3$，$A=1\\,\\text{m}^2$，$t=1\\,\\text{m}$ 时，这变为：\n$$\nS_{\\text{total}} = -6 w_0 \\sum_{e=1}^{8} \\rho_e^2\n$$\n密度为 $\\rho = \\{1.00, 0.85, 0.40, 0.10, 0.95, 0.75, 0.50, 0.20\\}$。我们计算它们的平方和：\n$$\n\\sum \\rho_e^2 = 1.00^2 + 0.85^2 + 0.40^2 + 0.10^2 + 0.95^2 + 0.75^2 + 0.50^2 + 0.20^2\n$$\n$$\n\\sum \\rho_e^2 = 1.0000 + 0.7225 + 0.1600 + 0.0100 + 0.9025 + 0.5625 + 0.2500 + 0.0400 = 3.6475\n$$\n现在，我们计算 $S_{\\text{total}}$：\n$$\nS_{\\text{total}} = -6 \\times \\left(\\frac{108.9375}{0.91} \\times 10^5\\right) \\times 3.6475\n$$\n$$\nS_{\\text{total}} = -6 \\times (1.19711538 \\times 10^7) \\times 3.6475 \\approx -2.620194 \\times 10^8\\,\\text{J}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\nS_{\\text{total}} \\approx -2.620 \\times 10^8\\,\\text{J}\n$$\n负号正确地表明，增加密度（刚度）会减少柔度。", "answer": "$$\\boxed{-2.620 \\times 10^8}$$", "id": "2704316"}]}