{"hands_on_practices": [{"introduction": "多项式混沌展开 (PCE) 依赖于一组正交多项式基。对于像高斯分布这样的常见不确定性分布，Hermite 多项式是自然的选择。本练习将深入探讨这些多项式的一个核心性质：三项递推关系 [@problem_id:2671707]。从第一性原理出发推导该关系，不仅能巩固您对正交性的理解，而且对于在侵入式 PCE 方法中高效构建系统矩阵至关重要，正如您将在下一个练习中看到的那样 [@problem_id:2671679]。", "problem": "一根长度为 $L$ 的一维线弹性杆，在 $x=L$ 处承受指定的轴向位移，其杨氏模量 $E$ 被建模为一个对数正态随机场，该随机场具有单一主导的标准正态模态 $Z \\sim \\mathcal{N}(0,1)$。在对该杆的轴向位移 $u(L;Z)$ 进行非侵入式多项式混沌展开 (PCE) 分析时，采用了一组关于标准正态概率测度的标准正交多项式基 $\\{\\psi_{n}(x)\\}_{n \\geq 0}$，其内积定义为\n$$\n\\langle f,g \\rangle = \\int_{-\\infty}^{\\infty} f(x)\\,g(x)\\,\\frac{1}{\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{x^{2}}{2}\\right)\\,dx = \\mathbb{E}[f(Z)\\,g(Z)]。\n$$\n这些标准正交多项式是与标准正态测度相关的标准正交埃尔米特多项式。数值上构建PCE的一个基本工具是该标准正交基所满足的三项递推关系。仅从标准正态测度下的标准正交性定义、(概率论学家的)埃尔米特多项式的Rodrigues表示\n$$\n\\mathrm{He}_{n}(x) = (-1)^{n}\\exp\\!\\left(\\frac{x^{2}}{2}\\right)\\frac{d^{n}}{dx^{n}}\\exp\\!\\left(-\\frac{x^{2}}{2}\\right),\n$$\n以及分部积分的标准性质出发，推导三项递推关系\n$$\nx\\,\\psi_{n}(x) = a_{n+1}\\,\\psi_{n+1}(x) + b_{n}\\,\\psi_{n}(x) + a_{n}\\,\\psi_{n-1}(x), \\quad n \\geq 0,\n$$\n对于标准正态权重下的标准正交埃尔米特基 $\\{\\psi_{n}\\}$，并确定递推系数 $a_{n}$ 和 $b_{n}$ 作为 $n$ 的显式函数。按照惯例，您可以假设 $\\psi_{-1} \\equiv 0$。请将最终答案表示为行矩阵 $[\\,a_{n}\\;\\;b_{n}\\,]$。无需进行数值舍入，且不涉及物理单位。", "solution": "所述问题是有效的。这是一个关于正交多项式理论的适定数学练习，该理论是不确定性量化中多项式混沌展开的基石。所有必要的定义和性质都已提供，足以推导出一个唯一且可验证的结果。我们将开始推导。\n\n目标是推导标准正交埃尔米特多项式 $\\{\\psi_n(x)\\}_{n \\ge 0}$ 所满足的三项递推关系的系数 $a_n$ 和 $b_n$：\n$$\nx\\,\\psi_{n}(x) = a_{n+1}\\,\\psi_{n+1}(x) + b_{n}\\,\\psi_{n}(x) + a_{n}\\,\\psi_{n-1}(x)\n$$\n这些多项式关于标准正态权重函数 $w(x) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-x^2/2)$ 是标准正交的。内积为 $\\langle f,g \\rangle = \\int_{-\\infty}^{\\infty} f(x)g(x)w(x)dx$。\n\n多项式 $\\{\\psi_n(x)\\}$ 通过一个归一化常数与正交（但非标准正交）的概率论学家埃尔米特多项式 $\\{\\mathrm{He}_n(x)\\}$ 相关。令 $\\psi_n(x) = C_n \\mathrm{He}_n(x)$，其中 $C_n = 1/\\|\\mathrm{He}_n\\|$。范数定义为 $\\|\\mathrm{He}_n\\| = \\sqrt{\\langle \\mathrm{He}_n, \\mathrm{He}_n \\rangle}$。\n\n首先，我们必须计算范数的平方 $\\|\\mathrm{He}_n\\|^2$。我们使用所提供的 $\\mathrm{He}_n(x)$ 的Rodrigues公式：\n$$\n\\mathrm{He}_{n}(x) = (-1)^{n}\\exp\\left(\\frac{x^{2}}{2}\\right)\\frac{d^{n}}{dx^{n}}\\exp\\left(-\\frac{x^{2}}{2}\\right)\n$$\n范数的平方为：\n$$\n\\|\\mathrm{He}_n\\|^2 = \\langle \\mathrm{He}_n, \\mathrm{He}_n \\rangle = \\int_{-\\infty}^{\\infty} \\mathrm{He}_n(x) \\left[ (-1)^{n} \\exp\\left(\\frac{x^2}{2}\\right) \\frac{d^n}{dx^n}\\exp\\left(-\\frac{x^2}{2}\\right) \\right] \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{x^2}{2}\\right) dx\n$$\n化简为：\n$$\n\\|\\mathrm{He}_n\\|^2 = \\frac{(-1)^n}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\mathrm{He}_n(x) \\left( \\frac{d^n}{dx^n}\\exp\\left(-\\frac{x^2}{2}\\right) \\right) dx\n$$\n我们进行 $n$ 次分部积分。在每一步中，形式为 $[\\dots \\exp(-x^2/2)]_{-\\infty}^\\infty$ 的边界项都为零，因为指数项比任何多项式的增长都更快地衰减到零。$n$ 次应用后，导数从指数项转移到 $\\mathrm{He}_n(x)$ 上：\n$$\n\\|\\mathrm{He}_n\\|^2 = \\frac{(-1)^n(-1)^n}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\left( \\frac{d^n}{dx^n} \\mathrm{He}_n(x) \\right) \\exp\\left(-\\frac{x^2}{2}\\right) dx\n$$\n多项式 $\\mathrm{He}_n(x)$ 的次数为 $n$，其首项系数为 $1$。这可以通过Rodrigues公式进行归纳证明，或使用已知性质 $\\mathrm{He}_n'(x) = n \\mathrm{He}_{n-1}(x)$ 来证明。由此可知，其 $n$ 阶导数是一个常数：$\\frac{d^n}{dx^n} \\mathrm{He}_n(x) = n!$。\n将此代入积分：\n$$\n\\|\\mathrm{He}_n\\|^2 = \\frac{n!}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{x^2}{2}\\right) dx = n! \\times 1 = n!\n$$\n因此，归一化常数为 $C_n = 1/\\|\\mathrm{He}_n\\| = 1/\\sqrt{n!}$。标准正交多项式为 $\\psi_n(x) = \\frac{1}{\\sqrt{n!}} \\mathrm{He}_n(x)$。\n\n接下来，我们建立正交多项式 $\\mathrm{He}_n(x)$ 的三项递推关系。多项式 $x \\mathrm{He}_n(x)$ 的次数为 $n+1$，可以在埃尔米特多项式基中表示为：\n$$\nx \\mathrm{He}_n(x) = \\sum_{k=0}^{n+1} c_k \\mathrm{He}_k(x)\n$$\n系数 $c_k$ 可利用正交性求得：$c_k = \\frac{\\langle x \\mathrm{He}_n, \\mathrm{He}_k \\rangle}{\\|\\mathrm{He}_k\\|^2} = \\frac{\\langle \\mathrm{He}_n, x \\mathrm{He}_k \\rangle}{\\|\\mathrm{He}_k\\|^2}$。由于 $x\\mathrm{He}_k(x)$ 是一个 $k+1$ 次多项式，如果 $n > k+1$ (即 $k < n-1$)，内积 $\\langle \\mathrm{He}_n, x \\mathrm{He}_k \\rangle$ 为零。因此，只有 $k=n+1, n, n-1$ 的系数可能非零。递推关系具有以下形式：\n$$\nx \\mathrm{He}_n(x) = c_{n+1} \\mathrm{He}_{n+1}(x) + c_n \\mathrm{He}_n(x) + c_{n-1} \\mathrm{He}_{n-1}(x)\n$$\n系数为：\n1. $c_{n+1}$：$\\mathrm{He}_n(x)$ 的首项是 $x^n$。因此，$x \\mathrm{He}_n(x)$ 的首项是 $x^{n+1}$。等式右边的首项是 $c_{n+1}x^{n+1}$。令首项系数相等，得到 $c_{n+1}=1$。\n2. $c_n$：$c_n = \\frac{\\langle x \\mathrm{He}_n, \\mathrm{He}_n \\rangle}{\\|\\mathrm{He}_n\\|^2}$。内积的被积函数是 $x (\\mathrm{He}_n(x))^2 w(x)$。多项式 $\\mathrm{He}_n(x)$ 的奇偶性为 $(-1)^n$。因此 $(\\mathrm{He}_n(x))^2$ 是一个偶函数。权重函数 $w(x)$ 也是偶函数。项 $x$ 是奇函数。整个被积函数是在对称区间 $(-\\infty, \\infty)$ 上积分的奇函数，所以积分为零。因此，$c_n=0$。\n3. $c_{n-1}$：$c_{n-1} = \\frac{\\langle x \\mathrm{He}_n, \\mathrm{He}_{n-1} \\rangle}{\\|\\mathrm{He}_{n-1}\\|^2} = \\frac{\\langle \\mathrm{He}_n, x \\mathrm{He}_{n-1} \\rangle}{\\|\\mathrm{He}_{n-1}\\|^2}$。我们知道 $x \\mathrm{He}_{n-1}(x) = \\mathrm{He}_n(x) + c_{n-2} \\mathrm{He}_{n-2}(x) + \\dots$。利用正交性：$\\langle \\mathrm{He}_n, x \\mathrm{He}_{n-1} \\rangle = \\langle \\mathrm{He}_n, \\mathrm{He}_n(x) \\rangle = \\|\\mathrm{He}_n\\|^2 = n!$。所以，$c_{n-1} = \\frac{n!}{\\|\\mathrm{He}_{n-1}\\|^2} = \\frac{n!}{(n-1)!} = n$。\n\n因此，正交多项式 $\\mathrm{He}_n(x)$ 的递推关系为：\n$$\nx \\mathrm{He}_n(x) = \\mathrm{He}_{n+1}(x) + n \\mathrm{He}_{n-1}(x)\n$$\n现在，将 $\\mathrm{He}_k(x) = \\sqrt{k!} \\psi_k(x)$ 代入此关系式：\n$$\nx \\sqrt{n!} \\psi_n(x) = \\sqrt{(n+1)!} \\psi_{n+1}(x) + n \\sqrt{(n-1)!} \\psi_{n-1}(x)\n$$\n将整个方程除以 $\\sqrt{n!}$：\n$$\nx \\psi_n(x) = \\frac{\\sqrt{(n+1)!}}{\\sqrt{n!}} \\psi_{n+1}(x) + \\frac{n\\sqrt{(n-1)!}}{\\sqrt{n!}} \\psi_{n-1}(x)\n$$\n$$\nx \\psi_n(x) = \\sqrt{n+1} \\psi_{n+1}(x) + \\frac{n}{\\sqrt{n}} \\psi_{n-1}(x)\n$$\n$$\nx \\psi_n(x) = \\sqrt{n+1} \\psi_{n+1}(x) + \\sqrt{n} \\psi_{n-1}(x)\n$$\n我们将此结果与目标形式 $x\\,\\psi_{n}(x) = a_{n+1}\\,\\psi_{n+1}(x) + b_{n}\\,\\psi_{n}(x) + a_{n}\\,\\psi_{n-1}(x)$ 进行比较。\n- $\\psi_{n+1}(x)$ 的系数得出 $a_{n+1} = \\sqrt{n+1}$。这意味着对于 $k \\ge 1$，有 $a_k = \\sqrt{k}$。\n- $\\psi_n(x)$ 的系数为零，所以对于所有 $n \\ge 0$，有 $b_n = 0$。\n- $\\psi_{n-1}(x)$ 的系数得出对于 $n \\ge 1$，有 $a_n = \\sqrt{n}$。\n对于 $n=0$，在 $\\psi_{-1}=0$ 的条件下，关系式为 $x\\psi_0(x) = a_1 \\psi_1(x) + b_0 \\psi_0(x)$。我们推导出的 $n=0$ 时的关系式为 $x\\psi_0(x) = \\sqrt{1}\\psi_1(x) + \\sqrt{0}\\psi_{-1}(x) = \\psi_1(x)$，这意味着 $a_1=1$ 和 $b_0=0$。这与我们的通用公式一致。公式 $a_n=\\sqrt{n}$ 可以推广到 $n=0$，此时 $a_0=0$。根据约定 $\\psi_{-1}=0$，项 $a_0 \\psi_{-1}(x)$ 消失，使得 $a_0$ 的值是任意的，但 $a_0=0$ 是一致的选择。\n\n因此，对于 $n \\ge 0$，递推系数为 $a_n = \\sqrt{n}$ 和 $b_n = 0$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sqrt{n} & 0\n\\end{pmatrix}\n}\n$$", "id": "2671707"}, {"introduction": "侵入式随机 Galerkin 方法将一个随机偏微分方程转化为一个用于求解 PCE 系数的大型确定性线性方程组，而该系统的结构是高效求解的关键。本练习将引导您推导全局 Galerkin 系统，揭示其在仿射参数问题中所具有的优美的 Kronecker 积结构 [@problem_id:2671679]。理解这一结构对于开发能够克服随机有限元方法高昂计算成本的高效求解器至关重要。", "problem": "一个承受小应变、静态载荷的线弹性体占据有界域 $\\mathcal{D} \\subset \\mathbb{R}^{d}$，其边界为 $\\partial \\mathcal{D} = \\Gamma_{D} \\cup \\Gamma_{N}$，其中 $\\Gamma_{D}$ 和 $\\Gamma_{N}$ 分别是不相交的 Dirichlet 边界和 Neumann 边界。位移场为 $u: \\mathcal{D} \\times \\Omega \\to \\mathbb{R}^{d}$，其中 $(\\Omega,\\mathcal{F},\\mathbb{P})$ 是一个完备概率空间，支撑一个由独立输入组成的随机向量 $\\boldsymbol{\\xi} = (\\xi_{1},\\dots,\\xi_{r})$。平衡方程和边界条件为\n$$\n-\\nabla \\cdot \\sigma(x,\\boldsymbol{\\xi}) = f(x) \\quad \\text{在 } \\mathcal{D} \\text{ 中}, \n\\qquad \nu(x,\\boldsymbol{\\xi}) = 0 \\quad \\text{在 } \\Gamma_{D} \\text{ 上},\n\\qquad \n\\sigma(x,\\boldsymbol{\\xi}) \\cdot n = t(x) \\quad \\text{在 } \\Gamma_{N} \\text{ 上},\n$$\n其中小应变张量为 $\\varepsilon(u) = \\tfrac{1}{2}(\\nabla u + \\nabla u^{\\top})$，应力为 $\\sigma = \\mathbb{C}(x,\\boldsymbol{\\xi}):\\varepsilon(u)$。假设本构律为仿射参数形式\n$$\n\\mathbb{C}(x,\\boldsymbol{\\xi}) = \\sum_{q=0}^{Q} \\theta_{q}(\\boldsymbol{\\xi})\\,\\mathbb{C}_{q}(x),\n$$\n其中 $\\theta_{0}(\\boldsymbol{\\xi}) \\equiv 1$，且 $\\{\\theta_{q}\\}_{q=1}^{Q}$ 是 $\\boldsymbol{\\xi}$ 的实值函数。具有 $n_{u}$ 个位移自由度的协调有限元离散化产生了一个参数化刚度算子，其形式为\n$$\nK(\\boldsymbol{\\xi}) = \\sum_{q=0}^{Q} \\theta_{q}(\\boldsymbol{\\xi})\\,K_{q}, \\qquad K_{q} \\in \\mathbb{R}^{n_{u}\\times n_{u}},\n$$\n以及一个确定性载荷向量 $f \\in \\mathbb{R}^{n_{u}}$，它集总了体力及 Neumann 边界上的牵引力。\n\n令 $\\{\\Psi_{\\alpha}(\\boldsymbol{\\xi})\\}_{\\alpha \\in \\mathcal{A}}$ 为 $L^{2}(\\Omega)$ 上的一个正交归一多元多项式基，其多重指标集 $\\mathcal{A}$ 的基数为 $n_{\\psi}$。考虑离散位移的多项式混沌展开 (PCE)：\n$$\nu_{h}(\\boldsymbol{\\xi}) = \\sum_{\\alpha \\in \\mathcal{A}} \\hat{u}_{\\alpha}\\,\\Psi_{\\alpha}(\\boldsymbol{\\xi}), \n\\qquad \\hat{u}_{\\alpha} \\in \\mathbb{R}^{n_{u}}.\n$$\n对所有 $\\beta \\in \\mathcal{A}$，应用以 $\\Psi_{\\beta}$ 为测试函数的随机伽辽金投影，可得到一个关于系数向量 $\\hat{u} \\in \\mathbb{R}^{n_{u} n_{\\psi}}$ (由堆叠 $\\{\\hat{u}_{\\alpha}\\}$ 得到) 的耦合线性系统。\n\n从平衡的弱形式、本构律以及 $\\{\\Psi_{\\alpha}\\}$ 的正交归一性出发，推导出代数全局伽辽金系统，并证明该系统可以表示为包含确定性刚度矩阵 $\\{K_{q}\\}$ 和由三重积期望定义的随机耦合矩阵的克罗内克积形式。然后，将问题特化到以下情况：$\\boldsymbol{\\xi}$ 具有独立的标准高斯分量，$\\theta_{0}(\\boldsymbol{\\xi}) \\equiv 1$，且对于 $k=1,\\dots,r$，有 $\\theta_{k}(\\boldsymbol{\\xi})=\\xi_{k}$，并且基 $\\{\\Psi_{\\alpha}\\}$ 是截至某个固定总次数的正交归一多元 Hermite 基。推导过程只使用固体力学的基本定律、有限元伽辽金原理以及关于正交归一 Hermite 多项式的公认性质。\n\n最后，以克罗内克积形式给出这种高斯仿射特化下全局伽辽金矩阵的闭式解析表达式，并为克罗内克表示中出现的每个随机耦合矩阵提供明确的逐项公式。你的最终答案必须是单一的闭式解析表达式。不包含单位。无需四舍五入。", "solution": "所提出的问题陈述是计算固体力学领域中一个适定且有科学依据的问题，具体涉及多项式混沌展开 (PCE) 在随机有限元法 (SFEM) 框架内的应用。该问题是自洽的，其前提符合事实，目标明确。它要求从基本原理出发，推导一个标准但并非平凡的结果。因此，该问题是有效的，将提供解答。\n\n出发点是离散化的线弹性系统，考虑到材料属性的随机性，该系统表现为参数化线性方程组的形式：\n$$\nK(\\boldsymbol{\\xi}) u_{h}(\\boldsymbol{\\xi}) = f\n$$\n在这里，$u_{h}(\\boldsymbol{\\xi}) \\in \\mathbb{R}^{n_{u}}$ 是节点位移自由度向量，由于其对 $\\boldsymbol{\\xi}$ 的依赖性而成为一个随机向量。向量 $f \\in \\mathbb{R}^{n_{u}}$ 代表确定性的外力和体力。刚度矩阵 $K(\\boldsymbol{\\xi}) \\in \\mathbb{R}^{n_{u} \\times n_{u}}$ 是随机的，由以下仿射展开式给出：\n$$\nK(\\boldsymbol{\\xi}) = \\sum_{q=0}^{Q} \\theta_{q}(\\boldsymbol{\\xi})\\,K_{q}\n$$\n位移向量 $u_{h}(\\boldsymbol{\\xi})$ 使用多项式混沌展开进行近似：\n$$\nu_{h}(\\boldsymbol{\\xi}) = \\sum_{\\alpha \\in \\mathcal{A}} \\hat{u}_{\\alpha}\\,\\Psi_{\\alpha}(\\boldsymbol{\\xi})\n$$\n其中 $\\{\\Psi_{\\alpha}\\}_{\\alpha \\in \\mathcal{A}}$ 是 $L^{2}(\\Omega)$ 上的一个正交归一多项式基，而 $\\{\\hat{u}_{\\alpha}\\}_{\\alpha \\in \\mathcal{A}}$ 是待定的确定性系数向量。\n\n将这些展开式代入静态平衡方程，得到：\n$$\n\\left( \\sum_{q=0}^{Q} \\theta_{q}(\\boldsymbol{\\xi})\\,K_{q} \\right) \\left( \\sum_{\\alpha \\in \\mathcal{A}} \\hat{u}_{\\alpha}\\,\\Psi_{\\alpha}(\\boldsymbol{\\xi}) \\right) = f\n$$\n为求解未知系数 $\\hat{u}_{\\alpha}$，我们应用随机伽辽金投影。这包括将方程的残差投影到由多项式基 $\\{\\Psi_{\\beta}\\}_{\\beta \\in \\mathcal{A}}$ 生成的空间上。在操作上，这是通过将方程与每个基函数 $\\Psi_{\\beta}$（对于所有 $\\beta \\in \\mathcal{A}$）求内积来实现的。在概率空间 $(\\Omega,\\mathcal{F},\\mathbb{P})$ 上，实值随机变量的内积是期望算子 $\\mathbb{E}[\\cdot]$。\n对于每个 $\\beta \\in \\mathcal{A}$，投影为：\n$$\n\\mathbb{E}\\left[ \\left( \\sum_{q=0}^{Q} \\theta_{q}(\\boldsymbol{\\xi})\\,K_{q} \\right) \\left( \\sum_{\\alpha \\in \\mathcal{A}} \\hat{u}_{\\alpha}\\,\\Psi_{\\alpha}(\\boldsymbol{\\xi}) \\right) \\Psi_{\\beta}(\\boldsymbol{\\xi}) \\right] = \\mathbb{E}\\left[ f \\Psi_{\\beta}(\\boldsymbol{\\xi}) \\right]\n$$\n由于期望算子的线性性质，确定性量 $K_{q}$、$\\hat{u}_{\\alpha}$ 和 $f$ 可以移到期望算子之外：\n$$\n\\sum_{q=0}^{Q} \\sum_{\\alpha \\in \\mathcal{A}} K_{q} \\hat{u}_{\\alpha} \\mathbb{E}\\left[ \\theta_{q}(\\boldsymbol{\\xi}) \\Psi_{\\alpha}(\\boldsymbol{\\xi}) \\Psi_{\\beta}(\\boldsymbol{\\xi}) \\right] = f \\mathbb{E}\\left[ \\Psi_{\\beta}(\\boldsymbol{\\xi}) \\right]\n$$\n我们来分析这些项。等式右边涉及 $\\mathbb{E}[\\Psi_{\\beta}(\\boldsymbol{\\xi})]$。该多项式基包含对应于零多重指标 $\\mathbf{0}$ 的常数函数 $\\Psi_{\\mathbf{0}}(\\boldsymbol{\\xi})=1$。根据正交归一性，$\\mathbb{E}[\\Psi_{\\beta}\\Psi_{\\mathbf{0}}] = \\delta_{\\beta\\mathbf{0}}$。因此，$\\mathbb{E}[\\Psi_{\\beta}] = \\delta_{\\beta\\mathbf{0}}$。等式右边简化为 $f \\delta_{\\beta\\mathbf{0}}$。\n等式左边包含三重积期望系数，它们构成了随机耦合矩阵的元素。我们定义：\n$$\nC_{q, \\beta\\alpha} = \\mathbb{E}\\left[ \\theta_{q}(\\boldsymbol{\\xi}) \\Psi_{\\alpha}(\\boldsymbol{\\xi}) \\Psi_{\\beta}(\\boldsymbol{\\xi}) \\right]\n$$\n关于系数 $\\{\\hat{u}_{\\alpha}\\}$ 的方程组变为：\n$$\n\\sum_{q=0}^{Q} \\sum_{\\alpha \\in \\mathcal{A}} C_{q, \\beta\\alpha} K_{q} \\hat{u}_{\\alpha} = f \\delta_{\\beta\\mathbf{0}} \\quad \\text{对于每个 } \\beta \\in \\mathcal{A}\n$$\n这是一个关于系数的堆叠向量 $\\hat{\\mathbf{u}} = (\\dots, \\hat{u}_{\\alpha}^{\\top}, \\dots)^{\\top}$ 的大型耦合线性方程组。全局伽辽金系统可以写成 $\\mathbf{K} \\hat{\\mathbf{u}} = \\hat{\\mathbf{f}}$。矩阵 $\\mathbf{K}$ 中对应于索引 $(\\beta, \\alpha)$ 的块是 $\\mathbf{K}_{\\beta\\alpha} = \\sum_{q=0}^{Q} C_{q, \\beta\\alpha} K_{q}$。全局右端向量 $\\hat{\\mathbf{f}}$ 只有一个非零块，对应于 $\\beta=\\mathbf{0}$，即 $f$。\n这种块结构可以使用克罗内克积 ($\\otimes$) 紧凑地表示。令 $\\mathbf{C}_q$ 为一个 $n_{\\psi} \\times n_{\\psi}$ 矩阵，其元素为 $(\\mathbf{C}_q)_{\\beta\\alpha} = C_{q, \\beta\\alpha}$。全局伽辽金矩阵 $\\mathbf{K}$ 则为：\n$$\n\\mathbf{K} = \\sum_{q=0}^{Q} \\mathbf{C}_{q} \\otimes K_{q}\n$$\n这就是全局伽辽金系统的一般克罗内克积表示。\n\n接下来，我们将情况特化为 $\\boldsymbol{\\xi} = (\\xi_{1}, \\dots, \\xi_{r})$ 由独立的标准高斯随机变量 $\\xi_{k} \\sim \\mathcal{N}(0,1)$ 组成。本构律由 $\\theta_{0}(\\boldsymbol{\\xi}) = 1$ 和 $\\theta_{k}(\\boldsymbol{\\xi})=\\xi_{k}$（对于 $k=1,\\dots,r$）指定。这意味着 $Q=r$。多项式基 $\\{\\Psi_{\\alpha}\\}$ 是正交归一多元 Hermite 基，其中 $\\Psi_{\\alpha}(\\boldsymbol{\\xi}) = \\prod_{i=1}^{r} \\psi_{\\alpha_i}(\\xi_i)$，而 $\\{\\psi_j\\}_{j \\ge 0}$ 是一元正交归一 Hermite 多项式。\n\n我们必须计算这种特定情况下的矩阵 $\\mathbf{C}_q$。\n对于 $q=0$，我们有 $\\theta_{0}(\\boldsymbol{\\xi}) = 1$。其元素为：\n$$\n(\\mathbf{C}_0)_{\\beta\\alpha} = \\mathbb{E}[1 \\cdot \\Psi_{\\alpha}(\\boldsymbol{\\xi})\\Psi_{\\beta}(\\boldsymbol{\\xi})] = \\delta_{\\alpha\\beta}\n$$\n这是根据基的正交归一性得出的。因此，$\\mathbf{C}_0 = \\mathbf{I}$，即大小为 $n_{\\psi} \\times n_{\\psi}$ 的单位矩阵。\n\n对于 $q=k \\in \\{1,\\dots,r\\}$，我们有 $\\theta_k(\\boldsymbol{\\xi}) = \\xi_k$。其元素为：\n$$\n(\\mathbf{C}_k)_{\\beta\\alpha} = \\mathbb{E}[\\xi_k \\Psi_{\\alpha}(\\boldsymbol{\\xi})\\Psi_{\\beta}(\\boldsymbol{\\xi})] = \\mathbb{E}\\left[\\xi_k \\prod_{i=1}^{r} \\psi_{\\alpha_i}(\\xi_i) \\psi_{\\beta_i}(\\xi_i)\\right]\n$$\n因为变量 $\\xi_i$ 是独立的，所以乘积的期望可以分离为期望的乘积：\n$$\n(\\mathbf{C}_k)_{\\beta\\alpha} = \\mathbb{E}[\\xi_k \\psi_{\\alpha_k}(\\xi_k)\\psi_{\\beta_k}(\\xi_k)] \\prod_{\\substack{i=1 \\\\ i \\neq k}}^{r} \\mathbb{E}[\\psi_{\\alpha_i}(\\xi_i)\\psi_{\\beta_i}(\\xi_i)]\n$$\n由于正交归一性，乘积项得以简化：$\\prod_{i \\neq k} \\delta_{\\alpha_i \\beta_i}$。这意味着仅当对所有 $i \\neq k$ 都有 $\\alpha_i = \\beta_i$ 时，该元素才非零。\n剩余的期望使用正交归一 Hermite 多项式的三项递推关系进行计算：\n$$\nz \\psi_p(z) = \\sqrt{p+1} \\psi_{p+1}(z) + \\sqrt{p} \\psi_{p-1}(z)\n$$\n将此关系应用于包含 $\\xi_k$ 和 $\\alpha_k$ 的项：\n$$\n\\mathbb{E}[\\xi_k \\psi_{\\alpha_k}(\\xi_k)\\psi_{\\beta_k}(\\xi_k)] = \\mathbb{E}\\left[ \\left(\\sqrt{\\alpha_k+1}\\psi_{\\alpha_k+1}(\\xi_k) + \\sqrt{\\alpha_k}\\psi_{\\alpha_k-1}(\\xi_k)\\right)\\psi_{\\beta_k}(\\xi_k) \\right]\n$$\n利用期望的线性和 $\\psi_j$ 多项式的正交归一性：\n$$\n= \\sqrt{\\alpha_k+1}\\mathbb{E}[\\psi_{\\alpha_k+1}(\\xi_k)\\psi_{\\beta_k}(\\xi_k)] + \\sqrt{\\alpha_k}\\mathbb{E}[\\psi_{\\alpha_k-1}(\\xi_k)\\psi_{\\beta_k}(\\xi_k)] = \\sqrt{\\alpha_k+1}\\delta_{\\beta_k, \\alpha_k+1} + \\sqrt{\\alpha_k}\\delta_{\\beta_k, \\alpha_k-1}\n$$\n综合这些结果，矩阵 $\\mathbf{C}_k$ 的逐项公式为：\n$$\n(\\mathbf{C}_k)_{\\beta\\alpha} = \\left(\\sqrt{\\alpha_k+1}\\delta_{\\beta_k, \\alpha_k+1} + \\sqrt{\\alpha_k}\\delta_{\\beta_k, \\alpha_k-1}\\right) \\prod_{\\substack{i=1 \\\\ i \\neq k}}^{r} \\delta_{\\beta_i, \\alpha_i}\n$$\n这个公式表明 $\\mathbf{C}_k$ 是一个稀疏矩阵。对于给定的行 $\\beta$，它最多有两个非零元素，对应于列 $\\alpha$，其中多重指标仅在第 $k$ 个分量上与 $\\beta$ 相差 $\\pm 1$。\n\n最后，针对指定的高斯仿射情况，组装全局伽辽金矩阵：\n$$\n\\mathbf{K} = \\mathbf{C}_0 \\otimes K_0 + \\sum_{k=1}^{r} \\mathbf{C}_k \\otimes K_k = \\mathbf{I} \\otimes K_0 + \\sum_{k=1}^{r} \\mathbf{C}_k \\otimes K_k\n$$\n这个表达式，连同 $\\mathbf{C}_k$ 元素的明确公式，构成了完整的解答。", "answer": "$$\n\\boxed{\\mathbf{K} = \\mathbf{I} \\otimes K_0 + \\sum_{k=1}^{r} \\mathbf{C}_k \\otimes K_k, \\text{ 其中 } (\\mathbf{C}_k)_{\\beta\\alpha} = \\left(\\sqrt{\\alpha_k+1}\\delta_{\\beta_k, \\alpha_k+1} + \\sqrt{\\alpha_k}\\delta_{\\beta_k, \\alpha_k-1}\\right) \\prod_{\\substack{i=1 \\\\ i \\neq k}}^{r} \\delta_{\\beta_i, \\alpha_i}}\n$$", "id": "2671679"}, {"introduction": "创建 PCE 代理模型的一个主要动机是执行全局敏感性分析等后处理任务，而 Sobol 指数是量化各输入不确定性对输出方差影响的强大工具。本练习旨在建立 PCE 系数与 Sobol 指数之间直接且计算成本低廉的联系 [@problem_id:2671662]。通过这个推导和计算，您将学会如何利用 PCE 来分解输出方差，从而深入洞察模型的行为。", "problem": "一根处于线性弹性状态的直棱柱轴向杆承受确定性轴向载荷，产生一个记为 $Y$ 的尖端位移。杆的材料和几何参数的不确定性由两个独立的标准化输入 $\\boldsymbol{\\xi}=(\\xi_{1},\\xi_{2})$ 建模，响应 $Y$ 由一个构建在正交张量积多项式基 $\\{\\Psi_{\\alpha}(\\boldsymbol{\\xi})\\}$ 上的多项式混沌展开（PCE）来近似。该基由多重指标 $\\alpha=(\\alpha_{1},\\alpha_{2})\\in\\mathbb{N}_{0}^{2}$ 索引，满足 $\\mathbb{E}[\\Psi_{\\alpha}\\Psi_{\\beta}]=\\delta_{\\alpha\\beta}$ 且对于所有 $\\alpha\\neq (0,0)$ 都有 $\\mathbb{E}[\\Psi_{\\alpha}]=0$。得到的截断 PCE 具有以下形式：\n$$\nY \\approx \\sum_{\\alpha} c_{\\alpha}\\,\\Psi_{\\alpha}(\\boldsymbol{\\xi}) \\quad\\text{其中}\\quad c_{\\alpha}\\in\\mathbb{R}。\n$$\n你可以假设输入是独立的，且正交基与其概率定律一致。\n\n任务 1. 从方差的定义和方差分析（ANOVA）分解（Sobol 灵敏度指数的基础）出发，并仅使用多项式混沌基的正交性和输入的独立性，推导输入 $\\xi_{i}$ 的一阶 Sobol 指数 $S_{i}$ 的表达式，该表达式仅用 PCE 系数 $\\{c_{\\alpha}\\}$ 表示。\n\n任务 2. 对于特定的二维展开\n$$\nY \\approx c_{(0,0)}\\Psi_{(0,0)} + c_{(1,0)}\\Psi_{(1,0)} + c_{(0,1)}\\Psi_{(0,1)} + c_{(2,0)}\\Psi_{(2,0)} + c_{(0,2)}\\Psi_{(0,2)} + c_{(1,1)}\\Psi_{(1,1)},\n$$\n其系数为\n- $c_{(0,0)} = 1.0$,\n- $c_{(1,0)} = 0.8$,\n- $c_{(0,1)} = 0.6$,\n- $c_{(2,0)} = 0.3$,\n- $c_{(0,2)} = 0.1$,\n- $c_{(1,1)} = 0.4$,\n使用你推导出的表达式，计算 $\\xi_{1}$ 的一阶 Sobol 指数 $S_{1}$。\n\n将最终数值答案四舍五入至四位有效数字。将结果表示为纯小数（无单位）。", "solution": "所述问题具有科学依据，提法恰当且客观。它提出了不确定性量化领域的一个标准任务，具体地将多项式混沌展开（PCE）与基于方差的灵敏度分析（Sobol 指数）联系起来。所有必要的定义，如基的正交性和输入的独立性，都已提供。数值是一致的。因此，该问题被视为有效，并将提供解答。\n\n任务分为一个推导和一个后续计算。\n\n任务 1：一阶 Sobol 指数 $S_i$ 的推导\n\n分析从方差和 Sobol 指数的基本定义开始。模型输出 $Y$ 的总方差记为 $D = \\text{Var}(Y)$。输入参数 $\\xi_i$ 的一阶 Sobol 指数定义为仅由 $\\xi_i$ 贡献的方差占总方差的比例：\n$$\nS_i = \\frac{D_i}{D}\n$$\n其中 $D_i = \\text{Var}(\\mathbb{E}[Y | \\xi_i])$ 是与 $\\xi_i$ 相关的一阶部分方差。\n\n我们必须用 PCE 系数 $\\{c_{\\alpha}\\}$ 来表示 $D$ 和 $D_i$。响应 $Y$ 的 PCE 表达式为：\n$$\nY(\\boldsymbol{\\xi}) \\approx \\sum_{\\alpha} c_{\\alpha}\\,\\Psi_{\\alpha}(\\boldsymbol{\\xi})\n$$\n基函数 $\\{\\Psi_{\\alpha}\\}$ 相对于输入 $\\boldsymbol{\\xi}$ 的概率测度是正交的，意味着 $\\mathbb{E}[\\Psi_{\\alpha}\\Psi_{\\beta}] = \\delta_{\\alpha\\beta}$。此外，对于 $\\alpha \\neq \\mathbf{0}$，有 $\\mathbb{E}[\\Psi_{\\alpha}] = 0$，而 $\\Psi_{\\mathbf{0}}$ 是一个常数，我们将其归一化为 $\\Psi_{\\mathbf{0}} = 1$。\n\n首先，我们计算 $Y$ 的均值和总方差。$Y$ 的均值为：\n$$\n\\mathbb{E}[Y] = \\mathbb{E}\\left[\\sum_{\\alpha} c_{\\alpha}\\,\\Psi_{\\alpha}(\\boldsymbol{\\xi})\\right] = \\sum_{\\alpha} c_{\\alpha}\\,\\mathbb{E}[\\Psi_{\\alpha}(\\boldsymbol{\\xi})]\n$$\n由于性质 $\\mathbb{E}[\\Psi_{\\alpha}]=0$（对于 $\\alpha\\neq\\mathbf{0}$）和 $\\mathbb{E}[\\Psi_{\\mathbf{0}}]=1$，该和简化为单项：\n$$\n\\mathbb{E}[Y] = c_{\\mathbf{0}}\\,\\mathbb{E}[\\Psi_{\\mathbf{0}}] = c_{\\mathbf{0}}\n$$\n总方差 $D$ 则为：\n$$\nD = \\text{Var}(Y) = \\mathbb{E}[(Y - \\mathbb{E}[Y])^2] = \\mathbb{E}\\left[\\left(\\sum_{\\alpha} c_{\\alpha}\\Psi_{\\alpha} - c_{\\mathbf{0}}\\right)^2\\right]\n$$\n代入 $c_{\\mathbf{0}} = c_{\\mathbf{0}}\\Psi_{\\mathbf{0}}$：\n$$\nD = \\mathbb{E}\\left[\\left(\\sum_{\\alpha \\neq \\mathbf{0}} c_{\\alpha}\\Psi_{\\alpha}\\right)^2\\right] = \\mathbb{E}\\left[\\left(\\sum_{\\alpha \\neq \\mathbf{0}} c_{\\alpha}\\Psi_{\\alpha}\\right) \\left(\\sum_{\\beta \\neq \\mathbf{0}} c_{\\beta}\\Psi_{\\beta}\\right)\\right]\n$$\n展开乘积并应用期望算子：\n$$\nD = \\sum_{\\alpha \\neq \\mathbf{0}} \\sum_{\\beta \\neq \\mathbf{0}} c_{\\alpha} c_{\\beta} \\mathbb{E}[\\Psi_{\\alpha}\\Psi_{\\beta}]\n$$\n根据正交性，$\\mathbb{E}[\\Psi_{\\alpha}\\Psi_{\\beta}] = \\delta_{\\alpha\\beta}$，所以表达式简化为：\n$$\nD = \\sum_{\\alpha \\neq \\mathbf{0}} c_{\\alpha}^2\n$$\n这是一个基本结果：PCE 模型的总方差是所有非常数项系数的平方和。\n\n接下来，我们计算部分方差 $D_i$。我们首先评估条件期望 $\\mathbb{E}[Y | \\xi_i]$。基函数具有张量积形式，$\\Psi_{\\alpha}(\\boldsymbol{\\xi}) = \\prod_{k=1}^{d} \\psi_{\\alpha_k}(\\xi_k)$，其中 $d$ 是 $\\boldsymbol{\\xi}$ 的维度。\n$$\n\\mathbb{E}[Y | \\xi_i] = \\mathbb{E}\\left[\\sum_{\\alpha} c_{\\alpha} \\prod_{k=1}^{d} \\psi_{\\alpha_k}(\\xi_k) \\Bigg| \\xi_i \\right]\n$$\n因为输入 $\\{\\xi_k\\}$ 是独立的，所以关于 $\\boldsymbol{\\xi}_{\\sim i}$（除 $\\xi_i$ 外的所有变量）的期望可以移到求和和乘积内部：\n$$\n\\mathbb{E}[Y | \\xi_i] = \\sum_{\\alpha} c_{\\alpha} \\psi_{\\alpha_i}(\\xi_i) \\prod_{k \\neq i} \\mathbb{E}[\\psi_{\\alpha_k}(\\xi_k)]\n$$\n单变量多项式也是正交的，意味着 $\\mathbb{E}[\\psi_{j}(\\xi_k)] = \\delta_{j0}$。因此，当且仅当对于所有 $k \\neq i$ 都有 $\\alpha_k = 0$ 时，乘积项 $\\prod_{k \\neq i} \\mathbb{E}[\\psi_{\\alpha_k}(\\xi_k)]$ 等于 $1$，否则等于 $0$。这将求和限制在那些仅在第 $i$ 个位置有非零分量的多重指标 $\\alpha$ 上（加上零向量 $\\mathbf{0}$）。\n我们定义这类指标的集合为 $\\mathcal{I}_i^* = \\{\\alpha \\in \\mathbb{N}_0^d \\mid \\alpha_j = 0 \\text{ for all } j \\neq i\\}$。条件期望变为：\n$$\n\\mathbb{E}[Y | \\xi_i] = \\sum_{\\alpha \\in \\mathcal{I}_i^*} c_{\\alpha} \\Psi_{\\alpha}(\\boldsymbol{\\xi}) = c_{\\mathbf{0}}\\Psi_{\\mathbf{0}} + \\sum_{\\alpha \\in \\mathcal{I}_i} c_{\\alpha} \\Psi_{\\alpha}(\\boldsymbol{\\xi})\n$$\n其中 $\\mathcal{I}_i = \\{\\alpha \\in \\mathbb{N}_0^d \\mid \\alpha_i > 0 \\text{ and } \\alpha_j = 0 \\text{ for all } j \\neq i\\}$。对于 $\\alpha \\in \\mathcal{I}_i$ 的函数 $\\Psi_{\\alpha}$ 仅依赖于 $\\xi_i$。\n\n现在我们计算这个量的方差，$D_i = \\text{Var}(\\mathbb{E}[Y | \\xi_i])$。常数项 $c_{\\mathbf{0}}\\Psi_{\\mathbf{0}}$ 对此方差没有贡献。\n$$\nD_i = \\text{Var}\\left(\\sum_{\\alpha \\in \\mathcal{I}_i} c_{\\alpha} \\Psi_{\\alpha}\\right) = \\mathbb{E}\\left[\\left(\\sum_{\\alpha \\in \\mathcal{I}_i} c_{\\alpha} \\Psi_{\\alpha}\\right)^2\\right] - \\left(\\mathbb{E}\\left[\\sum_{\\alpha \\in \\mathcal{I}_i} c_{\\alpha} \\Psi_{\\alpha}\\right]\\right)^2\n$$\n第二项为零，因为对于所有 $\\alpha \\in \\mathcal{I}_i$，都有 $\\mathbb{E}[\\Psi_{\\alpha}]=0$。使用与推导总方差 $D$ 时相同的逻辑，基函数的正交性导致：\n$$\nD_i = \\sum_{\\alpha \\in \\mathcal{I}_i} c_{\\alpha}^2\n$$\n这表明由 $\\xi_i$ 引起的部分方差是与仅依赖于 $\\xi_i$ 的基函数相对应的系数的平方和。\n\n最后，一阶 Sobol 指数 $S_i$ 是部分方差 $D_i$ 与总方差 $D$ 的比值：\n$$\nS_i = \\frac{D_i}{D} = \\frac{\\sum_{\\alpha \\in \\mathcal{I}_i} c_{\\alpha}^2}{\\sum_{\\beta \\neq \\mathbf{0}} c_{\\beta}^2}\n$$\n这就是所要求的表达式。\n\n任务 2：$S_1$ 的计算\n\n对于特定的二维情况，$\\boldsymbol{\\xi}=(\\xi_1, \\xi_2)$，PCE 表达式为：\n$$\nY \\approx c_{(0,0)}\\Psi_{(0,0)} + c_{(1,0)}\\Psi_{(1,0)} + c_{(0,1)}\\Psi_{(0,1)} + c_{(2,0)}\\Psi_{(2,0)} + c_{(0,2)}\\Psi_{(0,2)} + c_{(1,1)}\\Psi_{(1,1)}\n$$\n提供的系数是：\n$c_{(0,0)} = 1.0$, $c_{(1,0)} = 0.8$, $c_{(0,1)} = 0.6$, $c_{(2,0)} = 0.3$, $c_{(0,2)} = 0.1$, $c_{(1,1)} = 0.4$。\n\n我们必须计算 $S_1$。分母是总方差 $D$，即除 $c_{(0,0)}$ 之外所有系数的平方和：\n$$\nD = c_{(1,0)}^2 + c_{(0,1)}^2 + c_{(2,0)}^2 + c_{(0,2)}^2 + c_{(1,1)}^2\n$$\n代入数值：\n$$\nD = (0.8)^2 + (0.6)^2 + (0.3)^2 + (0.1)^2 + (0.4)^2\n$$\n$$\nD = 0.64 + 0.36 + 0.09 + 0.01 + 0.16 = 1.26\n$$\n分子是部分方差 $D_1$。根据我们推导的公式，这是多重指标在 $\\mathcal{I}_1$ 中的系数的平方和。对于此问题，$\\mathcal{I}_1$ 由形如 $(\\alpha_1, 0)$ 且 $\\alpha_1 > 0$ 的指标组成。从给定的展开式中，相关指标是 $(1,0)$ 和 $(2,0)$。\n$$\nD_1 = c_{(1,0)}^2 + c_{(2,0)}^2\n$$\n代入数值：\n$$\nD_1 = (0.8)^2 + (0.3)^2 = 0.64 + 0.09 = 0.73\n$$\n因此，$\\xi_1$ 的一阶 Sobol 指数是：\n$$\nS_1 = \\frac{D_1}{D} = \\frac{0.73}{1.26} \\approx 0.579365079...\n$$\n四舍五入到四位有效数字，我们得到 $S_1 = 0.5794$。", "answer": "$$\n\\boxed{0.5794}\n$$", "id": "2671662"}]}