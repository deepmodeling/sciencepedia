{"hands_on_practices": [{"introduction": "数字图像相关技术（DIC）中许多先进的优化算法，其核心是计算图像的灰度梯度。本练习将带你亲手实践如何从离散的像素数据中，通过有限差分法来计算这些梯度。通过这个过程，你将深入理解在处理子集边界时不同策略（如镜像填充与零填充）对梯度估计结果的显著影响，这是在DIC算法实现中一个至关重要的实际问题 [@problem_id:2630467]。", "problem": "二维数字图像相关 (DIC) 分析通过将灰度强度的变化与强度的空间梯度相关联来估计位移。考虑一个尺寸为 $5 \\times 5$ 的离散图像子集，其像素间距为 $h_x=h_y=1$，由行索引 $i \\in \\{1,2,3,4,5\\}$ (垂直) 和列索引 $j \\in \\{1,2,3,4,5\\}$ (水平) 确定，其测量的强度为\n$$\nI(i,j)=\\begin{pmatrix}\n12 & 18 & 25 & 30 & 28\\\\\n14 & 20 & 27 & 33 & 31\\\\\n16 & 22 & 29 & 36 & 34\\\\\n15 & 21 & 28 & 35 & 33\\\\\n13 & 19 & 26 & 32 & 30\n\\end{pmatrix}.\n$$\n你需要使用二阶中心差分格式来近似边缘像素 $p=(i_0,j_0)=(3,1)$ 处的离散图像梯度，用于计算偏导数 $\\partial I/\\partial x$ 和 $\\partial I/\\partial y$。在一维中，这种中心差分源于泰勒定理；在二维中，它们被分量式地沿 $x$ 和 $y$ 像素方向应用。由于点 $p$ 位于 $x$ 方向的左边界上，你必须使用以下两种边界规则之一来处理越界引用：\n- 镜像（对称）填充：跨边界反射索引，因此对于该子集，外部值遵循 $I(i,0)=I(i,2)$ 和 $I(i,6)=I(i,4)$ 等规则。\n- 零填充：将所有越界索引处的 $I$ 值设为 $0$。\n\n任务：\n1) 从图像强度 $I$ 在点 $p$ 处沿 $x$ 和 $y$ 方向的泰勒展开出发，推导出在点 $p$ 处计算 $\\partial I/\\partial x$ 和 $\\partial I/\\partial y$ 的中心差分公式，并保留至 $h_x$ 和 $h_y$ 的主阶。\n2) 使用推导出的公式，在 $h_x=h_y=1$ 的条件下，分别计算在镜像填充和零填充规则下点 $p$ 处的梯度向量 $\\nabla I$。\n3) 设 $m_{\\mathrm{mirror}}$ 和 $m_{\\mathrm{zero}}$ 分别表示步骤 2 中得到的梯度的模。计算比率 $r=m_{\\mathrm{zero}}/m_{\\mathrm{mirror}}$。\n\n将你的最终答案 $r$ 表示为一个四舍五入到四位有效数字的无量纲数。最终答案中不要包含任何单位。", "solution": "所给的问题陈述是自洽的、有科学依据且适定的。唯一解所需的所有数据和条件均已提供。因此，我们可以进行分析。\n\n首先，我们解决任务 1，即推导图像强度 $I$ 偏导数的二阶中心差分公式。我们假设函数 $I(x,y)$ 足够光滑。函数 $I$ 在 $x$ 方向上关于点 $(x,y)$ 的泰勒展开（步长为 $h_x$）由下式给出：\n$$I(x+h_x, y) = I(x,y) + \\frac{\\partial I}{\\partial x}h_x + \\frac{1}{2!}\\frac{\\partial^2 I}{\\partial x^2}h_x^2 + \\frac{1}{3!}\\frac{\\partial^3 I}{\\partial x^3}h_x^3 + \\mathcal{O}(h_x^4)$$\n$$I(x-h_x, y) = I(x,y) - \\frac{\\partial I}{\\partial x}h_x + \\frac{1}{2!}\\frac{\\partial^2 I}{\\partial x^2}h_x^2 - \\frac{1}{3!}\\frac{\\partial^3 I}{\\partial x^3}h_x^3 + \\mathcal{O}(h_x^4)$$\n从第一个方程中减去第二个方程，可以消去偶数阶导数项：\n$$I(x+h_x, y) - I(x-h_x, y) = 2\\frac{\\partial I}{\\partial x}h_x + \\frac{1}{3}\\frac{\\partial^3 I}{\\partial x^3}h_x^3 + \\mathcal{O}(h_x^5)$$\n求解 $\\frac{\\partial I}{\\partial x}$ 可得到中心差分公式及其主误差项：\n$$\\frac{\\partial I}{\\partial x} = \\frac{I(x+h_x, y) - I(x-h_x, y)}{2h_x} - \\frac{h_x^2}{6}\\frac{\\partial^3 I}{\\partial x^3} + \\mathcal{O}(h_x^4)$$\n该近似是二阶的，即 $\\mathcal{O}(h_x^2)$。在 $y$ 方向上进行类似的推导可得：\n$$\\frac{\\partial I}{\\partial y} = \\frac{I(x, y+h_y) - I(x, y-h_y)}{2h_y} - \\frac{h_y^2}{6}\\frac{\\partial^3 I}{\\partial y^3} + \\mathcal{O}(h_y^4)$$\n在离散形式下，其中 $x$ 对应于列索引 $j$，$y$ 对应于行索引 $i$，这些公式为：\n$$\\frac{\\partial I}{\\partial x}(i,j) \\approx \\frac{I(i, j+1) - I(i, j-1)}{2h_x}$$\n$$\\frac{\\partial I}{\\partial y}(i,j) \\approx \\frac{I(i+1, j) - I(i-1, j)}{2h_y}$$\n\n对于任务 2，我们计算指定像素点 $p=(i_0, j_0) = (3,1)$ 处的梯度 $\\nabla I = \\left(\\frac{\\partial I}{\\partial x}, \\frac{\\partial I}{\\partial y}\\right)$。给定的像素间距为 $h_x=h_y=1$。公式变为：\n$$\\frac{\\partial I}{\\partial x}(3,1) \\approx \\frac{I(3, 2) - I(3, 0)}{2}$$\n$$\\frac{\\partial I}{\\partial y}(3,1) \\approx \\frac{I(4, 1) - I(2, 1)}{2}$$\n从给定的强度矩阵 $I(i,j)$ 中，我们提取出在 $5 \\times 5$ 子集范围内的必要值：\n$I(3,2) = 22$\n$I(4,1) = 15$\n$I(2,1) = 14$\n\n$\\frac{\\partial I}{\\partial y}$ 的计算不需要越界数据：\n$$\\frac{\\partial I}{\\partial y}(3,1) = \\frac{15 - 14}{2} = \\frac{1}{2} = 0.5$$\n$\\frac{\\partial I}{\\partial x}$ 的计算需要值 $I(3,0)$，该值超出了列索引范围 $j \\in \\{1,2,3,4,5\\}$。我们必须应用指定的边界规则。\n\n情况1：镜像填充。\n规则是 $I(i,0) = I(i,2)$。对于我们位于行 $i=3$ 的点，这给出 $I(3,0) = I(3,2)$。由于 $I(3,2) = 22$，我们得到 $I(3,0) = 22$。\n$x$ 方向的偏导数为：\n$$\\frac{\\partial I}{\\partial x}\\bigg|_{\\mathrm{mirror}} = \\frac{I(3,2) - I(3,0)}{2} = \\frac{22 - 22}{2} = 0$$\n镜像填充的梯度向量为 $\\nabla I_{\\mathrm{mirror}} = (0, 0.5)$。\n\n情况2：零填充。\n规则规定所有越界索引处的 $I$ 值为 $0$。因此，$I(3,0) = 0$。\n$x$ 方向的偏导数为：\n$$\\frac{\\partial I}{\\partial x}\\bigg|_{\\mathrm{zero}} = \\frac{I(3,2) - I(3,0)}{2} = \\frac{22 - 0}{2} = 11$$\n零填充的梯度向量为 $\\nabla I_{\\mathrm{zero}} = (11, 0.5)$。\n\n对于任务 3，我们计算比率 $r=m_{\\mathrm{zero}}/m_{\\mathrm{mirror}}$。首先，我们计算两个梯度向量的模，即 $m_{\\mathrm{mirror}} = |\\nabla I_{\\mathrm{mirror}}|$ 和 $m_{\\mathrm{zero}} = |\\nabla I_{\\mathrm{zero}}|$。\n$\\nabla I_{\\mathrm{mirror}}$ 的模为：\n$$m_{\\mathrm{mirror}} = \\sqrt{0^2 + (0.5)^2} = \\sqrt{0.25} = 0.5$$\n$\\nabla I_{\\mathrm{zero}}$ 的模为：\n$$m_{\\mathrm{zero}} = \\sqrt{11^2 + (0.5)^2} = \\sqrt{121 + 0.25} = \\sqrt{121.25}$$\n比率 $r$ 则为：\n$$r = \\frac{m_{\\mathrm{zero}}}{m_{\\mathrm{mirror}}} = \\frac{\\sqrt{121.25}}{0.5} = 2\\sqrt{121.25}$$\n为了以要求的格式提供答案，我们对该表达式进行数值计算。\n$$r = 2\\sqrt{121.25} = \\sqrt{4 \\times 121.25} = \\sqrt{485}$$\n计算数值：\n$$r = \\sqrt{485} \\approx 22.0227156...$$\n四舍五入到四位有效数字，我们得到 $r_f = 22.02$。", "answer": "$$\\boxed{22.02}$$", "id": "2630467"}, {"introduction": "二维数字图像相关技术（2D DIC）一个常见的应用陷阱是忽略了离面位移的影响，这会导致计算出不存在的“伪应变”。本练习将引导你使用针孔相机模型，通过一个简单的刚体倾斜案例，亲手推导出这种伪应变的产生过程并量化其大小 [@problem_id:2630444]。这个实践将让你深刻体会到为何在存在复杂三维运动时，选择立体DIC（Stereo-DIC）是保证测量准确性的关键。", "problem": "一个平坦的、带有散斑的试件由一个焦距为 $f$ 的单针孔相机在标准的数字图像相关（DIC）装置中成像。初始时，试件平面垂直于光轴，其中心位于光轴上，距离针孔为 $Z_0$。选择一个用于相关的子区，作为试件中心点像（即图像中心）周围的一个小邻域。然后，试件经历一次刚体倾斜：绕穿过试件中心的相机 $x$ 轴纯旋转一个角度 $\\theta$，无平移。角度以弧度为单位。二维（2D）DIC 使用单视图的图像到图像映射，从变形后图像相对于参考图像来推断面内位移和应变；立体 DIC（双相机系统）则重建三维（3D）形状和全场位移。\n\n仅从针孔相机模型和刚体旋转的定义出发，推导图像中心附近从参考图像坐标 $(x_0,y_0)$ 到变形后图像坐标 $(x,y)$ 的局部映射，计算 2D DIC 算法将在图像中心报告的面内无穷小应变张量分量，并简要论证对于相同的运动，立体 DIC 是否会报告非零应变。\n\n假设：\n- 适用针孔投影模型：对于相机坐标为 $(X,Y,Z)$ 的场景点，其图像坐标满足 $x=fX/Z$ 和 $y=fY/Z$。\n- 刚性旋转是绕穿过试件中心的相机 $x$ 轴进行的，旋转角度为 $\\theta$，无平移。\n- 2D DIC 应变对应于根据相对于参考图像坐标 $(x_0,y_0)$ 的面内位移梯度计算的无穷小应变张量。\n- 子区中心位于 $(x_0,y_0)=(0,0)$，并且视场足够小，以至于中心的雅可比矩阵能代表该子区测得的应变。\n\n以行矩阵形式给出在图像中心计算的三个分量 $(\\varepsilon_{xx},\\ \\varepsilon_{yy},\\ \\varepsilon_{xy})$ 的最终答案，表示为关于 $\\theta$ 的封闭形式函数。无需进行数值代入或四舍五入。应变为无量纲。角度按给定单位弧度表示。", "solution": "首先必须验证问题陈述的科学合理性、完整性和客观性。\n\n**第1步：提取已知条件**\n- **系统：** 一个平坦的、带有散斑的试件由单针孔相机成像。\n- **相机模型：** 焦距为 $f$ 的针孔投影。一个场景点 $(X,Y,Z)$ 对应的图像坐标 $(x,y)$ 为 $x=fX/Z$ 和 $y=fY/Z$。\n- **参考构型：** 试件平面位于 $Z=Z_0$，垂直于光轴。试件中心位于光轴上，因此其像点在图像中心。一个相关子区以图像原点 $(x_0,y_0)=(0,0)$ 为中心。\n- **变形：** 绕平行于相机 $x$ 轴且穿过试件中心 $(0,0,Z_0)$ 的轴线进行刚体旋转，角度为 $\\theta$。无平移。\n- **任务1：** 推导图像中心附近从参考图像坐标 $(x_0, y_0)$ 到变形后图像坐标 $(x, y)$ 的局部映射。\n- **任务2：** 计算在图像中心 $(x_0, y_0)=(0,0)$ 处的无穷小应变张量分量 $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy})$。\n- **应变定义：** 2D DIC 应变是无穷小应变张量的分量，$\\varepsilon_{ij} = \\frac{1}{2}(\\frac{\\partial u_i}{\\partial x_{0,j}} + \\frac{\\partial u_j}{\\partial x_{0,i}})$，其中 $\\mathbf{u}$ 是像平面位移矢量，$\\mathbf{x}_0$ 是参考图像坐标。\n- **任务3：** 论证立体 DIC 是否会报告非零应变。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于光学（针孔相机模型）、刚体运动学和连续介质力学（无穷小应变）的既定原理。它描述了二维数字图像相关（2D DIC）中一个已知且重要的假象。该装置在物理上是现实的。\n- **适定性：** 问题提供了所有必要的参数（$f, Z_0, \\theta$）和清晰的几何描述。这些假设规范了应变的计算，确保可以推导出唯一的解。\n- **客观性：** 问题以精确、技术性的语言陈述，没有主观性或含糊之处。“绕穿过试件中心的相机 $x$ 轴”这一短语，在这种设置下，以唯一物理上可行的方式解释为：一条平行于相机 $X$ 轴且与点 $(0,0,Z_0)$ 相交的旋转轴。\n\n**第3步：结论与行动**\n问题被判定为**有效**。这是一个定义明确的测量力学理论练习，与实验固体力学领域直接相关。我们着手进行推导。\n\n**解题推导**\n\n设相机坐标系为 $(X,Y,Z)$，针孔位于原点 $(0,0,0)$，光轴沿 $Z$ 轴。\n\n1.  **参考状态：**\n    未变形试件表面上的一个点具有坐标 $\\mathbf{P}_0 = (X_0, Y_0, Z_0)$。其在参考图像中对应的点 $\\mathbf{p}_0 = (x_0, y_0)$ 由针孔投影方程给出：\n    $$ x_0 = f \\frac{X_0}{Z_0} \\quad , \\quad y_0 = f \\frac{Y_0}{Z_0} $$\n    由此，我们可以用像空间坐标表示物空间坐标：\n    $$ X_0 = \\frac{x_0 Z_0}{f} \\quad , \\quad Y_0 = \\frac{y_0 Z_0}{f} $$\n\n2.  **刚体旋转：**\n    试件绕一条平行于相机 $X$ 轴且穿过试件中心 $(0,0,Z_0)$ 的轴线纯旋转角度 $\\theta$。为求点 $\\mathbf{P}_0$ 的新坐标 $\\mathbf{P}=(X,Y,Z)$，我们考虑从旋转轴上的一个点（例如 $(X_0, 0, Z_0)$）指向点 $\\mathbf{P}_0$ 的向量。该向量为 $(0, Y_0, 0)$。我们将此向量绕 $X$ 轴旋转 $\\theta$，然后加回到旋转轴上的点。\n    向量 $(0, Y_0, 0)$ 的旋转为：\n    $$ \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\cos\\theta & -\\sin\\theta \\\\ 0 & \\sin\\theta & \\cos\\theta \\end{pmatrix} \\begin{pmatrix} 0 \\\\ Y_0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ Y_0 \\cos\\theta \\\\ Y_0 \\sin\\theta \\end{pmatrix} $$\n    将此旋转后的向量加到旋转轴上的点 $(X_0, 0, Z_0)$，得到新位置 $\\mathbf{P}=(X,Y,Z)$：\n    $$ X = X_0 + 0 = X_0 $$\n    $$ Y = 0 + Y_0 \\cos\\theta = Y_0 \\cos\\theta $$\n    $$ Z = Z_0 + Y_0 \\sin\\theta $$\n\n3.  **变形后的图像坐标与映射：**\n    现在我们通过将新的三维点 $\\mathbf{P}$ 投影到像平面来找到新的图像坐标 $\\mathbf{p}=(x,y)$。我们首先用参考图像坐标 $(x_0, y_0)$ 来表示 $X,Y,Z$：\n    $$ X = \\frac{x_0 Z_0}{f} $$\n    $$ Y = \\frac{y_0 Z_0}{f} \\cos\\theta $$\n    $$ Z = Z_0 + \\frac{y_0 Z_0}{f} \\sin\\theta = Z_0 \\left( 1 + \\frac{y_0}{f} \\sin\\theta \\right) $$\n    新的图像坐标 $(x,y)$ 为：\n    $$ x = f \\frac{X}{Z} = f \\frac{\\frac{x_0 Z_0}{f}}{Z_0 \\left( 1 + \\frac{y_0}{f} \\sin\\theta \\right)} = \\frac{x_0}{1 + \\frac{y_0}{f} \\sin\\theta} $$\n    $$ y = f \\frac{Y}{Z} = f \\frac{\\frac{y_0 Z_0}{f} \\cos\\theta}{Z_0 \\left( 1 + \\frac{y_0}{f} \\sin\\theta \\right)} = \\frac{y_0 \\cos\\theta}{1 + \\frac{y_0}{f} \\sin\\theta} $$\n    这就提供了从 $(x_0, y_0)$ 到 $(x, y)$ 的映射。\n\n4.  **应变张量计算：**\n    为了求无穷小应变张量，我们首先计算在图像中心 $(x_0, y_0) = (0, 0)$ 处的变形梯度张量 $\\mathbf{F}$。\n    $$ \\mathbf{F} = \\begin{pmatrix} \\frac{\\partial x}{\\partial x_0} & \\frac{\\partial x}{\\partial y_0} \\\\ \\frac{\\partial y}{\\partial x_0} & \\frac{\\partial y}{\\partial y_0} \\end{pmatrix} $$\n    所需的偏导数为：\n    $$ \\frac{\\partial x}{\\partial x_0} = \\frac{1}{1 + \\frac{y_0}{f} \\sin\\theta} $$\n    $$ \\frac{\\partial x}{\\partial y_0} = -\\frac{x_0 \\left( \\frac{1}{f} \\sin\\theta \\right)}{\\left( 1 + \\frac{y_0}{f} \\sin\\theta \\right)^2} $$\n    $$ \\frac{\\partial y}{\\partial x_0} = 0 $$\n    $$ \\frac{\\partial y}{\\partial y_0} = \\frac{\\cos\\theta \\left( 1 + \\frac{y_0}{f} \\sin\\theta \\right) - y_0 \\cos\\theta \\left( \\frac{1}{f} \\sin\\theta \\right)}{\\left( 1 + \\frac{y_0}{f} \\sin\\theta \\right)^2} = \\frac{\\cos\\theta}{\\left( 1 + \\frac{y_0}{f} \\sin\\theta \\right)^2} $$\n    在 $(x_0, y_0) = (0, 0)$ 处计算这些偏导数的值：\n    $$ \\frac{\\partial x}{\\partial x_0}\\bigg|_{(0,0)} = 1 \\quad , \\quad \\frac{\\partial x}{\\partial y_0}\\bigg|_{(0,0)} = 0 $$\n    $$ \\frac{\\partial y}{\\partial x_0}\\bigg|_{(0,0)} = 0 \\quad , \\quad \\frac{\\partial y}{\\partial y_0}\\bigg|_{(0,0)} = \\cos\\theta $$\n    图像中心处的变形梯度张量为：\n    $$ \\mathbf{F}\\big|_{(0,0)} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\cos\\theta \\end{pmatrix} $$\n    位移梯度张量 $\\mathbf{J}$ 是 $\\mathbf{F} - \\mathbf{I}$，其中 $\\mathbf{I}$ 是单位矩阵。\n    $$ \\mathbf{J}\\big|_{(0,0)} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\cos\\theta \\end{pmatrix} - \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & \\cos\\theta - 1 \\end{pmatrix} $$\n    无穷小应变张量 $\\boldsymbol{\\varepsilon}$ 是 $\\mathbf{J}$ 的对称部分：\n    $$ \\boldsymbol{\\varepsilon} = \\frac{1}{2} (\\mathbf{J} + \\mathbf{J}^T) = \\frac{1}{2} \\left( \\begin{pmatrix} 0 & 0 \\\\ 0 & \\cos\\theta - 1 \\end{pmatrix} + \\begin{pmatrix} 0 & 0 \\\\ 0 & \\cos\\theta - 1 \\end{pmatrix}^T \\right) = \\begin{pmatrix} 0 & 0 \\\\ 0 & \\cos\\theta - 1 \\end{pmatrix} $$\n    从该张量中，我们确定 2D DIC 算法将在中心报告的分量：\n    $$ \\varepsilon_{xx} = 0 $$\n    $$ \\varepsilon_{yy} = \\cos\\theta - 1 $$\n    $$ \\varepsilon_{xy} = 0 $$\n    这个非零应变 $\\varepsilon_{yy}$ 是一种伪应变，是将三维运动投影到二维平面上所产生的假象。\n\n5.  **立体 DIC 的论证：**\n    立体 DIC 使用两个或多个相机来重建试件表面在参考状态和变形状态下的三维坐标 $(X,Y,Z)$。通过追踪物质点的三维位置，它直接测量三维位移场 $\\mathbf{U}(\\mathbf{P}_0) = \\mathbf{P} - \\mathbf{P}_0$。\n    问题中描述的运动是纯刚体旋转。根据定义，刚体运动保持物体内任意两点间的距离不变。因此，它不会引起任何物理应变。\n    一个理想的立体 DIC 系统，通过正确地重建三维几何形状，会将该变换识别为刚体运动。从重建的三维场计算应变将正确地得出在试件上各处均为零的应变张量。2D DIC 中出现伪应变，正是因为它无法区分真实的面内变形和由离面运动引起的表观变形。立体 DIC 正是为了克服这一局限性而设计的。因此，立体 DIC 将报告零应变。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & \\cos\\theta - 1 & 0 \\end{pmatrix}}\n$$", "id": "2630444"}, {"introduction": "数字图像相关技术（DIC）直接测量的是位移场，但我们最终关心的往往是应变场，而应变需要通过对位移场进行微分来计算。本练习将探讨一个核心问题：位移测量中的噪声如何在应变计算过程中被传递和放大 [@problem_id:2630488]。通过推导应变分量的方差，你将量化地理解原始数据质量、后处理参数（如计算模板大小）与最终应变结果可靠性之间的重要联系。", "problem": "二维数字图像相关（DIC）测量在 $x$ 和 $y$ 方向上间距为 $h$ 的方形网格上，提供了平面内位移场的离散样本。假设每个网格节点上测得的位移分量 $u_{x}$ 和 $u_{y}$ 是无偏的，但受到加性、零均值、白噪声的污染，该噪声在所有网格位置上以及不同分量之间都是独立的。具体来说，设每个分量中的噪声方差为 $\\sigma_{u}^{2}$，且任意两个不同分量和/或位置之间的协方差为零。\n\n使用固体力学中的无穷小（小）应变定义，\n$$\n\\varepsilon_{xx}=\\frac{\\partial u_{x}}{\\partial x},\\quad \\varepsilon_{yy}=\\frac{\\partial u_{y}}{\\partial y},\\quad \\varepsilon_{xy}=\\frac{1}{2}\\left(\\frac{\\partial u_{x}}{\\partial y}+\\frac{\\partial u_{y}}{\\partial x}\\right),\n$$\n通过将空间导数替换为每个方向上的一阶导数的标准五点对称中心差分模板（模板尺寸为 5），来定义网格节点处的应变分量。对于标量场 $f$，网格上节点 $(i,j)$ 处 $\\partial f/\\partial x$ 的模板为\n$$\n\\left.\\frac{\\partial f}{\\partial x}\\right|_{(i,j)}\\approx \\frac{1}{12h}\\Big(f_{i-2,j}-8f_{i-1,j}+8f_{i+1,j}-f_{i+2,j}\\Big),\n$$\n且沿 $y$ 方向的 $\\partial f/\\partial y$ 也类似，将相同的系数应用于索引 $j$。\n\n仅根据上述小应变定义、有限差分的线性性以及独立随机变量线性组合的方差基本法则，推导单个内部网格节点上估算的应变分量 $\\varepsilon_{xx}$、$\\varepsilon_{yy}$ 和 $\\varepsilon_{xy}$ 的方差，并用 $\\sigma_{u}^{2}$ 和 $h$ 表示。假设真实的位移场是确定性的（非随机的），因此所有不确定性都源于测量噪声。清晰地陈述将噪声通过有限差分算子进行传播所使用的任何中间步骤。\n\n以单行矩阵 $\\big(\\operatorname{Var}(\\varepsilon_{xx})\\;\\operatorname{Var}(\\varepsilon_{yy})\\;\\operatorname{Var}(\\varepsilon_{xy})\\big)$ 的形式给出您的最终答案，表达式应为关于 $\\sigma_{u}^{2}$ 和 $h$ 的闭式解析形式。方差是无量纲的。不要包含单位。不需要四舍五入。", "solution": "问题陈述具有科学依据，是适定且客观的。它提出了一个分析数字图像相关（DIC）实验数据的标准问题，特别是测量不确定性如何通过数值微分方案传播以估算应变。所有必要信息，包括噪声模型、应变定义和有限差分模板，都已提供且前后一致。该问题是有效的。\n\n此推导的核心原理是不相关随机变量线性组合的方差传播。如果随机变量 $Y$ 定义为 $n$ 个方差为 $\\operatorname{Var}(X_{i})$ 的不相关随机变量 $X_{i}$ 的线性组合，即 $Y = \\sum_{i=1}^{n} c_{i}X_{i}$，则其方差由下式给出：\n$$\n\\operatorname{Var}(Y) = \\sum_{i=1}^{n} c_{i}^{2}\\operatorname{Var}(X_{i})\n$$\n问题陈述指出，每个网格节点 $(i,j)$ 上测得的位移 $u_{x}$ 和 $u_{y}$ 受到加性、零均值、白噪声的污染。设真实的、确定性的位移分量为 $\\bar{u}_{x}(i,j)$ 和 $\\bar{u}_{y}(i,j)$。因此，测得的位移为：\n$$\nu_{x}(i,j) = \\bar{u}_{x}(i,j) + \\delta_{x}(i,j)\n$$\n$$\nu_{y}(i,j) = \\bar{u}_{y}(i,j) + \\delta_{y}(i,j)\n$$\n其中 $\\delta_{x}(i,j)$ 和 $\\delta_{y}(i,j)$ 是噪声项。由于真实的位移场是确定性的，因此 $\\operatorname{Var}(u_{x}(i,j)) = \\operatorname{Var}(\\delta_{x}(i,j))$ 且 $\\operatorname{Var}(u_{y}(i,j)) = \\operatorname{Var}(\\delta_{y}(i,j))$。根据问题，噪声在不同位置和分量之间是独立的，每个位置上每个分量的方差均为 $\\sigma_{u}^{2}$。这意味着：\n$$\n\\operatorname{Var}(u_{x}(i,j)) = \\sigma_{u}^{2}, \\quad \\operatorname{Var}(u_{y}(i,j)) = \\sigma_{u}^{2} \\quad \\text{for all } (i,j)\n$$\n并且对于 $(i,j) \\neq (k,l)$：\n$$\n\\operatorname{Cov}(u_{x}(i,j), u_{x}(k,l)) = 0, \\quad \\operatorname{Cov}(u_{y}(i,j), u_{y}(k,l)) = 0\n$$\n并且对于任意的 $(i,j)$ 和 $(k,l)$：\n$$\n\\operatorname{Cov}(u_{x}(i,j), u_{y}(k,l)) = 0\n$$\n\n我们现在将计算内部网格节点 $(i,j)$ 处每个估算应变分量的方差。\n\n首先，考虑正应变 $\\varepsilon_{xx}$。它通过将偏导数 $\\frac{\\partial u_{x}}{\\partial x}$ 替换为给定的五点中心差分模板来估算：\n$$\n\\varepsilon_{xx}(i,j) \\approx \\frac{1}{12h} \\Big( u_{x}(i-2,j) - 8u_{x}(i-1,j) + 8u_{x}(i+1,j) - u_{x}(i+2,j) \\Big)\n$$\n这是四个不同网格节点上测得的位移 $u_{x}$ 的线性组合。由于真实的位移场 $\\bar{u}_{x}$ 是确定性的，它对方差没有贡献。$\\varepsilon_{xx}(i,j)$ 的方差完全来自位移测量中的噪声。由于噪声是白噪声，节点 $(i-2, j)$、$(i-1, j)$、$(i+1, j)$ 和 $(i+2, j)$ 处的位移测量是不相关的。应用方差传播法则：\n$$\n\\operatorname{Var}(\\varepsilon_{xx}) = \\operatorname{Var}\\left[ \\frac{1}{12h} \\Big( u_{x,i-2,j} - 8u_{x,i-1,j} + 8u_{x,i+1,j} - u_{x,i+2,j} \\Big) \\right]\n$$\n$$\n\\operatorname{Var}(\\varepsilon_{xx}) = \\left(\\frac{1}{12h}\\right)^{2} \\operatorname{Var}\\Big( u_{x,i-2,j} - 8u_{x,i-1,j} + 8u_{x,i+1,j} - u_{x,i+2,j} \\Big)\n$$\n$$\n\\operatorname{Var}(\\varepsilon_{xx}) = \\frac{1}{144h^{2}} \\Big( (1)^{2}\\operatorname{Var}(u_{x,i-2,j}) + (-8)^{2}\\operatorname{Var}(u_{x,i-1,j}) + (8)^{2}\\operatorname{Var}(u_{x,i+1,j}) + (-1)^{2}\\operatorname{Var}(u_{x,i+2,j}) \\Big)\n$$\n将每一项的 $\\operatorname{Var}(u_{x}) = \\sigma_{u}^{2}$ 代入：\n$$\n\\operatorname{Var}(\\varepsilon_{xx}) = \\frac{1}{144h^{2}} \\Big( (1+64+64+1)\\sigma_{u}^{2} \\Big) = \\frac{130\\sigma_{u}^{2}}{144h^{2}} = \\frac{65\\sigma_{u}^{2}}{72h^{2}}\n$$\n正应变 $\\varepsilon_{yy}$ 的推导是类似的。 $\\varepsilon_{yy}$ 的估算值为：\n$$\n\\varepsilon_{yy}(i,j) \\approx \\frac{1}{12h} \\Big( u_{y}(i,j-2) - 8u_{y}(i,j-1) + 8u_{y}(i,j+1) - u_{y}(i,j+2) \\Big)\n$$\n这是四个不同网格节点上测得的位移 $u_{y}$ 的线性组合，这些位移是不相关的。其系数与 $\\varepsilon_{xx}$ 的情况相同。因此，方差也相同：\n$$\n\\operatorname{Var}(\\varepsilon_{yy}) = \\frac{1}{144h^{2}} \\Big( (1)^{2}\\operatorname{Var}(u_{y,i,j-2}) + (-8)^{2}\\operatorname{Var}(u_{y,i,j-1}) + (8)^{2}\\operatorname{Var}(u_{y,i,j+1}) + (-1)^{2}\\operatorname{Var}(u_{y,i,j+2}) \\Big)\n$$\n$$\n\\operatorname{Var}(\\varepsilon_{yy}) = \\frac{1}{144h^{2}} \\Big( (1+64+64+1)\\sigma_{u}^{2} \\Big) = \\frac{130\\sigma_{u}^{2}}{144h^{2}} = \\frac{65\\sigma_{u}^{2}}{72h^{2}}\n$$\n最后，考虑剪应变 $\\varepsilon_{xy}$：\n$$\n\\varepsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u_{x}}{\\partial y}+\\frac{\\partial u_{y}}{\\partial x}\\right)\n$$\n其在节点 $(i,j)$ 处的估算值为：\n$$\n\\varepsilon_{xy}(i,j) \\approx \\frac{1}{2} \\left( \\frac{u_{x,i,j-2} - 8u_{x,i,j-1} + 8u_{x,i,j+1} - u_{x,i,j+2}}{12h} + \\frac{u_{y,i-2,j} - 8u_{y,i-1,j} + 8u_{y,i+1,j} - u_{y,i+2,j}}{12h} \\right)\n$$\n让我们将两个导数项定义为 $D_{u_x, y} = \\frac{\\partial u_{x}}{\\partial y}$ 和 $D_{u_y, x} = \\frac{\\partial u_{y}}{\\partial x}$。那么 $\\varepsilon_{xy} = \\frac{1}{2}(D_{u_x, y} + D_{u_y, x})$。方差由下式给出：\n$$\n\\operatorname{Var}(\\varepsilon_{xy}) = \\operatorname{Var}\\left(\\frac{1}{2}(D_{u_x, y} + D_{u_y, x})\\right) = \\frac{1}{4} \\operatorname{Var}(D_{u_x, y} + D_{u_y, x})\n$$\n使用法则 $\\operatorname{Var}(A+B) = \\operatorname{Var}(A) + \\operatorname{Var}(B) + 2\\operatorname{Cov}(A,B)$：\n$$\n\\operatorname{Var}(\\varepsilon_{xy}) = \\frac{1}{4} \\Big( \\operatorname{Var}(D_{u_x, y}) + \\operatorname{Var}(D_{u_y, x}) + 2\\operatorname{Cov}(D_{u_x, y}, D_{u_y, x}) \\Big)\n$$\n每个导数项的方差计算如前。对于 $D_{u_x, y}$：\n$$\n\\operatorname{Var}(D_{u_x, y}) = \\operatorname{Var}\\left(\\frac{1}{12h} \\sum_{k} c_{k} u_{x,k} \\right) = \\frac{1}{144h^{2}} (1^{2}+(-8)^{2}+8^{2}+(-1)^{2})\\sigma_{u}^{2} = \\frac{130\\sigma_{u}^{2}}{144h^{2}} = \\frac{65\\sigma_{u}^{2}}{72h^{2}}\n$$\n同样地，对于 $D_{u_y, x}$：\n$$\n\\operatorname{Var}(D_{u_y, x}) = \\operatorname{Var}\\left(\\frac{1}{12h} \\sum_{l} d_{l} u_{y,l} \\right) = \\frac{1}{144h^{2}} (1^{2}+(-8)^{2}+8^{2}+(-1)^{2})\\sigma_{u}^{2} = \\frac{130\\sigma_{u}^{2}}{144h^{2}} = \\frac{65\\sigma_{u}^{2}}{72h^{2}}\n$$\n现在，我们必须评估协方差项 $\\operatorname{Cov}(D_{u_x, y}, D_{u_y, x})$。项 $D_{u_x, y}$ 是随机变量 $\\{u_{x,i,j-2}, u_{x,i,j-1}, u_{x,i,j+1}, u_{x,i,j+2}\\}$ 的线性组合。项 $D_{u_y, x}$ 是随机变量 $\\{u_{y,i-2,j}, u_{y,i-1,j}, u_{y,i+1,j}, u_{y,i+2,j}\\}$ 的线性组合。这两组涉及的节点是不同的。更重要的是，问题陈述指出噪声在分量之间是独立的，意味着对于任意位置对，$\\operatorname{Cov}(u_x, u_y) = 0$。由于 $D_{u_x, y}$ 仅取决于 $u_x$ 场中的噪声，而 $D_{u_y, x}$ 仅取决于 $u_y$ 场中的噪声，因此这两个量是不相关的。\n$$\n\\operatorname{Cov}(D_{u_x, y}, D_{u_y, x}) = 0\n$$\n将这些结果代回 $\\operatorname{Var}(\\varepsilon_{xy})$ 的表达式中：\n$$\n\\operatorname{Var}(\\varepsilon_{xy}) = \\frac{1}{4} \\left( \\frac{65\\sigma_{u}^{2}}{72h^{2}} + \\frac{65\\sigma_{u}^{2}}{72h^{2}} + 0 \\right) = \\frac{1}{4} \\left( 2 \\cdot \\frac{65\\sigma_{u}^{2}}{72h^{2}} \\right) = \\frac{1}{2} \\frac{65\\sigma_{u}^{2}}{72h^{2}} = \\frac{65\\sigma_{u}^{2}}{144h^{2}}\n$$\n因此，三个应变分量的方差为：\n$\\operatorname{Var}(\\varepsilon_{xx}) = \\frac{65\\sigma_{u}^{2}}{72h^{2}}$\n$\\operatorname{Var}(\\varepsilon_{yy}) = \\frac{65\\sigma_{u}^{2}}{72h^{2}}$\n$\\operatorname{Var}(\\varepsilon_{xy}) = \\frac{65\\sigma_{u}^{2}}{144h^{2}}$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{65\\sigma_{u}^{2}}{72h^{2}} & \\frac{65\\sigma_{u}^{2}}{72h^{2}} & \\frac{65\\sigma_{u}^{2}}{144h^{2}} \\end{pmatrix}}\n$$", "id": "2630488"}]}