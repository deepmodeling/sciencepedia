{"hands_on_practices": [{"introduction": "本练习是掌握非线性固体力学的一项基本技能。它将引导你从一个给定的超弹性应变能势出发，推导出材料切线模量 $\\mathbb{A}$，并学习如何通过推前操作 (push-forward) 将其转换为空间切线模量 $\\mathfrak{a}$。这个过程是有限元分析中实现复杂本构模型的核心，对于准确模拟大变形问题至关重要。[@problem_id:2655396]", "problem": "考虑一个可压缩超弹性固体，其单位参考体积的储能密度由势函数 $\\Psi(\\mathbf{C}) = \\dfrac{\\mu}{2}\\left(\\operatorname{tr}\\mathbf{C} - 3\\right) - \\mu \\ln J + \\dfrac{\\kappa}{2}\\left(\\ln J\\right)^{2}$ 给出，其中 $\\mathbf{F}$ 是变形梯度，$\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$ 是右柯西-格林 (RCC) 张量，$J = \\det \\mathbf{F}$，$\\mu > 0$ 是剪切模量，$\\kappa > 0$ 是体积模量。令 $\\mathbf{E} = \\dfrac{1}{2}(\\mathbf{C} - \\mathbf{I})$ 为格林-拉格朗日应变 (GLS)，$\\mathbf{S}$ 为第二皮奥拉-基尔霍夫 (SPK) 应力，$\\boldsymbol{\\tau}$ 为基尔霍夫应力，$\\mathbf{d}$ 为变形率 (ROD)。\n利用虚功原理和有限变形的标准运动学，按以下步骤进行：\n- 从参考构型的虚功 $\\delta W_{\\text{int}} = \\int_{\\Omega_{0}} \\mathbf{S} : \\delta \\mathbf{E}\\,\\mathrm{d}\\Omega_{0}$ 和空间构型的虚功 $\\delta W_{\\text{int}} = \\int_{\\Omega} \\boldsymbol{\\tau} : \\delta \\mathbf{d}\\,\\mathrm{d}v$ 出发，推导与 $\\Psi(\\mathbf{C})$ 相关的材料弹性（切线）张量 $\\mathbb{A} = \\dfrac{\\partial \\mathbf{S}}{\\partial \\mathbf{E}}$。\n- 通过线性化虚功并使用客观运动学，推导空间弹性（切线）张量 $\\mathfrak{a} = \\dfrac{\\partial \\boldsymbol{\\tau}}{\\partial \\mathbf{d}}$，并将其通过 $\\mathbf{F}$ and $J$ 的前推运算与 $\\mathbb{A}$ 联系起来。\n- 将您的结果特化到均匀各向同性膨胀 $\\mathbf{F} = \\lambda \\mathbf{I}$（其中 $\\lambda > 0$）的情况。在此状态下，计算空间切线张量 $\\mathfrak{a}$ 的单个分量 $a_{1111}$，并以 $\\mu$、$\\kappa$ 和 $\\lambda$ 的闭式解析表达式表示。\n您的最终答案必须是仅含 $\\mu$、$\\kappa$ 和 $\\lambda$ 的 $a_{1111}$ 的单个解析表达式。不要代入数值，最终答案中也不要包含单位。", "solution": "对所述问题进行严格验证。\n\n### 第一步：提取已知条件\n- 储能密度函数：$\\Psi(\\mathbf{C}) = \\dfrac{\\mu}{2}\\left(\\operatorname{tr}\\mathbf{C} - 3\\right) - \\mu \\ln J + \\dfrac{\\kappa}{2}\\left(\\ln J\\right)^{2}$。\n- 运动学变量：变形梯度 $\\mathbf{F}$、右柯西-格林张量 $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$、雅可比行列式 $J = \\det \\mathbf{F}$、格林-拉格朗日应变 $\\mathbf{E} = \\dfrac{1}{2}(\\mathbf{C} - \\mathbf{I})$。\n- 材料参数：剪切模量 $\\mu > 0$、体积模量 $\\kappa > 0$。\n- 应力和刚度度量：第二皮奥拉-基尔霍夫 (SPK) 应力 $\\mathbf{S}$、基尔霍夫应力 $\\boldsymbol{\\tau}$、材料弹性张量 $\\mathbb{A} = \\dfrac{\\partial \\mathbf{S}}{\\partial \\mathbf{E}}$、空间弹性张量 $\\mathfrak{a}$。\n- 虚功原理：参考构型形式 $\\delta W_{\\text{int}} = \\int_{\\Omega_{0}} \\mathbf{S} : \\delta \\mathbf{E}\\,\\mathrm{d}\\Omega_{0}$、空间构型形式 $\\delta W_{\\text{int}} = \\int_{\\Omega} \\boldsymbol{\\tau} : \\delta \\mathbf{d}\\,\\mathrm{d}v$。\n- 特定变形状态：均匀各向同性膨胀 $\\mathbf{F} = \\lambda \\mathbf{I}$，其中 $\\lambda > 0$。\n- 目标：针对指定的膨胀状态，求空间切线张量 $\\mathfrak{a}$ 的分量 $a_{1111}$。\n\n### 第二步：使用提取的已知条件进行验证\n该问题在科学上基于非线性连续介质力学和超弹性理论的既定理论。所提供的储能函数是一个已知且有效的可压缩模型。所有定义、变量和原理（$\\mathbf{F}$、$\\mathbf{C}$、$\\mathbf{S}$、$\\Psi$、虚功）均为此领域的标准内容。该问题是适定的，提供了通过一系列逻辑步骤推导出唯一解所需的所有信息。语言客观且无歧义。这些任务与固体力学中虚功线性化的主题直接相关。因此，该问题被认为是有效的。\n\n### 第三步：推导\n求解过程首先从给定的势函数 $\\Psi$ 推导 SPK 应力张量 $\\mathbf{S}$ 和材料切线模量 $\\mathbb{A}$。然后，通过前推运算得到空间切线模量 $\\mathfrak{a}$。最后，针对均匀膨胀的特定情况对这些张量进行求值，以找到分量 $\\mathfrak{a}_{1111}$。\n\n首先，我们将储能函数 $\\Psi$ 完全用右柯西-格林张量 $\\mathbf{C}$ 表示。使用恒等式 $J = (\\det \\mathbf{C})^{1/2}$，我们有：\n$$\n\\Psi(\\mathbf{C}) = \\dfrac{\\mu}{2}(\\operatorname{tr}\\mathbf{C} - 3) - \\mu \\ln((\\det \\mathbf{C})^{1/2}) + \\dfrac{\\kappa}{2}(\\ln((\\det \\mathbf{C})^{1/2}))^{2}\n$$\n$$\n\\Psi(\\mathbf{C}) = \\dfrac{\\mu}{2}(\\operatorname{tr}\\mathbf{C} - 3) - \\dfrac{\\mu}{2}\\ln(\\det \\mathbf{C}) + \\dfrac{\\kappa}{8}(\\ln(\\det \\mathbf{C}))^{2}\n$$\n第二皮奥拉-基尔霍夫应力 $\\mathbf{S}$ 是通过 $\\Psi$ 对格林-拉格朗日应变 $\\mathbf{E}$ 求导得出的。使用链式法则以及 $\\mathbf{E} = \\frac{1}{2}(\\mathbf{C} - \\mathbf{I})$（这意味着 $\\mathrm{d}\\mathbf{E} = \\frac{1}{2}\\mathrm{d}\\mathbf{C}$），我们得到：\n$$\n\\mathbf{S} = \\dfrac{\\partial \\Psi}{\\partial \\mathbf{E}} = 2\\dfrac{\\partial \\Psi}{\\partial \\mathbf{C}}\n$$\n我们使用标准张量恒等式 $\\frac{\\partial(\\operatorname{tr}\\mathbf{C})}{\\partial \\mathbf{C}} = \\mathbf{I}$ 和 $\\frac{\\partial(\\ln(\\det\\mathbf{C}))}{\\partial \\mathbf{C}} = \\mathbf{C}^{-1}$。\n$$\n\\mathbf{S} = 2\\left[ \\dfrac{\\mu}{2}\\mathbf{I} - \\dfrac{\\mu}{2}\\mathbf{C}^{-1} + \\dfrac{\\kappa}{8}(2\\ln(\\det\\mathbf{C}))\\mathbf{C}^{-1} \\right]\n$$\n$$\n\\mathbf{S} = \\mu\\mathbf{I} - \\mu\\mathbf{C}^{-1} + \\dfrac{\\kappa}{2}\\ln(\\det\\mathbf{C})\\mathbf{C}^{-1}\n$$\n重新整理并使用 $\\ln(\\det\\mathbf{C}) = 2\\ln J$：\n$$\n\\mathbf{S} = \\mu\\mathbf{I} + (\\kappa\\ln J - \\mu)\\mathbf{C}^{-1}\n$$\n接下来，我们推导四阶材料切线模量 $\\mathbb{A} = \\frac{\\partial \\mathbf{S}}{\\partial \\mathbf{E}} = 2\\frac{\\partial \\mathbf{S}}{\\partial \\mathbf{C}}$。我们需要 $\\mathbf{C}^{-1}$ 对 $\\mathbf{C}$ 的导数。其分量形式为 $\\frac{\\partial C_{IJ}^{-1}}{\\partial C_{KL}} = -\\frac{1}{2}(C_{IK}^{-1}C_{LJ}^{-1} + C_{IL}^{-1}C_{KJ}^{-1})$。\n$$\n\\mathbb{A} = 2\\dfrac{\\partial}{\\partial \\mathbf{C}} \\left[ \\mu\\mathbf{I} + \\left(\\dfrac{\\kappa}{2}\\ln(\\det\\mathbf{C}) - \\mu\\right)\\mathbf{C}^{-1} \\right]\n$$\n应用乘积法则求导：\n$$\n\\mathbb{A}_{IJKL} = 2 \\left[ \\left( \\dfrac{\\kappa}{2}\\dfrac{\\partial(\\ln(\\det\\mathbf{C}))}{\\partial C_{KL}} \\right) C_{IJ}^{-1} + \\left(\\dfrac{\\kappa}{2}\\ln(\\det\\mathbf{C}) - \\mu\\right) \\dfrac{\\partial C_{IJ}^{-1}}{\\partial C_{KL}} \\right]\n$$\n$$\n\\mathbb{A}_{IJKL} = 2 \\left[ \\dfrac{\\kappa}{2} C_{KL}^{-1} C_{IJ}^{-1} + \\left(\\dfrac{\\kappa}{2}\\ln(\\det\\mathbf{C}) - \\mu\\right) \\left(-\\dfrac{1}{2}(C_{IK}^{-1}C_{LJ}^{-1} + C_{IL}^{-1}C_{KJ}^{-1})\\right) \\right]\n$$\n$$\n\\mathbb{A}_{IJKL} = \\kappa C_{IJ}^{-1}C_{KL}^{-1} - (\\kappa\\ln(\\det\\mathbf{C}) - 2\\mu) \\dfrac{1}{2}(C_{IK}^{-1}C_{JL}^{-1} + C_{IL}^{-1}C_{JK}^{-1})\n$$\n代入 $\\ln(\\det\\mathbf{C}) = 2\\ln J$：\n$$\n\\mathbb{A}_{IJKL} = \\kappa C_{IJ}^{-1}C_{KL}^{-1} + (\\mu - \\kappa\\ln J)(C_{IK}^{-1}C_{JL}^{-1} + C_{IL}^{-1}C_{JK}^{-1})\n$$\n空间弹性张量 $\\mathfrak{a}$ 通过前推运算与材料张量 $\\mathbb{A}$ 相关联。根据问题的措辞，我们对切线张量的材料部分使用标准变换，该变换将基尔霍夫应力的李导数与变形率关联起来：\n$$\n\\mathfrak{a}_{ijkl} = J^{-1} F_{iI}F_{jJ}F_{kK}F_{lL} A_{IJKL}\n$$\n现在我们特化到均匀各向同性膨胀的情况，$\\mathbf{F} = \\lambda\\mathbf{I}$。这得到：\n$$\nJ = \\det(\\lambda\\mathbf{I}) = \\lambda^{3}\n$$\n$$\n\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F} = (\\lambda\\mathbf{I})^{\\mathsf{T}}(\\lambda\\mathbf{I}) = \\lambda^{2}\\mathbf{I}\n$$\n$$\n\\mathbf{C}^{-1} = \\lambda^{-2}\\mathbf{I} \\quad \\text{或} \\quad C_{IJ}^{-1} = \\lambda^{-2}\\delta_{IJ}\n$$\n将这些代入 $\\mathbb{A}$ 的表达式中：\n$$\nA_{IJKL} = \\kappa (\\lambda^{-2}\\delta_{IJ})(\\lambda^{-2}\\delta_{KL}) + (\\mu - \\kappa\\ln(\\lambda^{3}))(\\lambda^{-2}\\delta_{IK}\\lambda^{-2}\\delta_{JL} + \\lambda^{-2}\\delta_{IL}\\lambda^{-2}\\delta_{JK})\n$$\n$$\nA_{IJKL} = \\kappa\\lambda^{-4}\\delta_{IJ}\\delta_{KL} + \\lambda^{-4}(\\mu - 3\\kappa\\ln\\lambda)(\\delta_{IK}\\delta_{JL} + \\delta_{IL}\\delta_{JK})\n$$\n现在，我们执行前推运算得到 $\\mathfrak{a}$。对于 $\\mathbf{F} = \\lambda\\mathbf{I}$，我们有 $F_{iI} = \\lambda\\delta_{iI}$。\n$$\n\\mathfrak{a}_{ijkl} = (\\lambda^{3})^{-1} (\\lambda\\delta_{iI})(\\lambda\\delta_{jJ})(\\lambda\\delta_{kK})(\\lambda\\delta_{lL}) A_{IJKL}\n$$\n$$\n\\mathfrak{a}_{ijkl} = \\lambda^{-3}\\lambda^{4} A_{ijkl} = \\lambda A_{ijkl}\n$$\n由于 $\\delta_{iI}$ 将 $I$ 与 $i$、$J$ 与 $j$ 等进行缩并，因此可以直接替换索引。\n$$\n\\mathfrak{a}_{ijkl} = \\lambda \\left[ \\kappa\\lambda^{-4}\\delta_{ij}\\delta_{kl} + \\lambda^{-4}(\\mu - 3\\kappa\\ln\\lambda)(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}) \\right]\n$$\n$$\n\\mathfrak{a}_{ijkl} = \\kappa\\lambda^{-3}\\delta_{ij}\\delta_{kl} + \\lambda^{-3}(\\mu - 3\\kappa\\ln\\lambda)(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})\n$$\n这是空间切线模量的表达式。题目要求我们找到分量 $\\mathfrak{a}_{1111}$。我们令 $i=1, j=1, k=1, l=1$：\n$$\n\\mathfrak{a}_{1111} = \\kappa\\lambda^{-3}\\delta_{11}\\delta_{11} + \\lambda^{-3}(\\mu - 3\\kappa\\ln\\lambda)(\\delta_{11}\\delta_{11} + \\delta_{11}\\delta_{11})\n$$\n由于 $\\delta_{11} = 1$：\n$$\n\\mathfrak{a}_{1111} = \\kappa\\lambda^{-3}(1) + \\lambda^{-3}(\\mu - 3\\kappa\\ln\\lambda)(1 + 1)\n$$\n$$\n\\mathfrak{a}_{1111} = \\kappa\\lambda^{-3} + 2\\lambda^{-3}(\\mu - 3\\kappa\\ln\\lambda)\n$$\n$$\n\\mathfrak{a}_{1111} = \\lambda^{-3}[\\kappa + 2\\mu - 6\\kappa\\ln\\lambda]\n$$\n$$\n\\mathfrak{a}_{1111} = \\lambda^{-3}[2\\mu + \\kappa(1 - 6\\ln\\lambda)]\n$$\n这是最终的解析表达式。", "answer": "$$\n\\boxed{\\frac{2\\mu + \\kappa(1 - 6\\ln\\lambda)}{\\lambda^{3}}}\n$$", "id": "2655396"}, {"introduction": "在处理了源于势能的保守力之后，我们来探讨当外力不保守时会发生什么，这是一个更为复杂但常见的情况。本练习通过一个加载方向随结构变形而变的“跟随力” (follower force) 的例子，展示了其对应的切线刚度矩阵为何通常是非对称的。理解这种非对称性对于稳定性分析（如屈曲和颤振）以及正确处理路径依赖载荷问题至关重要。[@problem_id:2655351]", "problem": "一个位于位置向量 $\\boldsymbol{q} \\in \\mathbb{R}^{2}$ 的二维点状末端执行器，受到一个大小恒为 $P>0$ 的跟随推力，其方向始终与经过当前位置 $\\boldsymbol{q}$、以原点为中心的圆的逆时针切线方向一致。切线单位向量由下式给出\n$$\n\\boldsymbol{t}(\\boldsymbol{q}) \\;=\\; \\frac{\\boldsymbol{R}\\,\\boldsymbol{q}}{\\|\\boldsymbol{q}\\|},\n$$\n其中 $\\|\\cdot\\|$ 表示欧几里得范数，$\\boldsymbol{R}$ 是平面内恒定的旋转九十度算子，\n$$\n\\boldsymbol{R} \\;=\\; \\begin{bmatrix} 0 & -1 \\\\ 1 & 0 \\end{bmatrix}.\n$$\n因此，外部跟随力为 $\\boldsymbol{f}(\\boldsymbol{q}) = P\\,\\boldsymbol{t}(\\boldsymbol{q})$。外部虚功为\n$$\n\\delta W_{\\mathrm{ext}}(\\boldsymbol{q};\\delta \\boldsymbol{q}) \\;=\\; \\boldsymbol{f}(\\boldsymbol{q}) \\cdot \\delta \\boldsymbol{q}.\n$$\n考虑非线性虚功在基准构型 $\\boldsymbol{q}_{0} = \\begin{bmatrix} L \\\\ 0 \\end{bmatrix}$（其中 $L>0$）附近的线性化，即对于一个增量 $\\Delta \\boldsymbol{q}$ 和一个虚位移 $\\delta \\boldsymbol{q}$，\n$$\n\\Delta\\big(\\delta W_{\\mathrm{ext}}\\big) \\;=\\; \\delta \\boldsymbol{q}^{\\mathsf{T}} \\,\\boldsymbol{K}\\, \\Delta \\boldsymbol{q} \\;+\\; \\text{高阶项},\n$$\n其中 $\\boldsymbol{K} = \\left.\\dfrac{\\partial \\boldsymbol{f}}{\\partial \\boldsymbol{q}}\\right|_{\\boldsymbol{q}_{0}}$ 是切线算子。仅从外部虚功的定义和给定的随动力方向出发，不使用任何预先给出的线性化公式，完成以下任务：\n\n- 显式推导在 $\\boldsymbol{q}_{0}$ 处的 $\\boldsymbol{K}$。\n- 证明 $\\boldsymbol{K}$ 不是对称的，从而构建一个在非保守随动载荷下非线性虚功的线性化不对称的反例。\n- 根据载荷方向对构型的依赖性以及相关势能的不存在性，解释反对称性的物理根源。\n\n最后，为了量化线性化虚功中对称性的缺失，评估不匹配量\n$$\nM \\;=\\; \\Delta\\big(\\delta W_{\\mathrm{ext}}\\big)\\big|_{\\delta \\boldsymbol{q}=\\boldsymbol{e}_{1},\\,\\Delta \\boldsymbol{q}=\\boldsymbol{e}_{2}} \\;-\\; \\Delta\\big(\\delta W_{\\mathrm{ext}}\\big)\\big|_{\\delta \\boldsymbol{q}=\\boldsymbol{e}_{2},\\,\\Delta \\boldsymbol{q}=\\boldsymbol{e}_{1}},\n$$\n其中 $\\boldsymbol{e}_{1}=\\begin{bmatrix}1\\\\0\\end{bmatrix}$ 和 $\\boldsymbol{e}_{2}=\\begin{bmatrix}0\\\\1\\end{bmatrix}$ 是标准基向量。用 $P$ 和 $L$ 将你的最终答案表示为一个封闭形式的解析表达式。最终答案中不要包含单位。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 位置向量：$\\boldsymbol{q} \\in \\mathbb{R}^{2}$。\n- 推力大小：$P > 0$，恒定。\n- 力的方向：切线单位向量 $\\boldsymbol{t}(\\boldsymbol{q}) = \\frac{\\boldsymbol{R}\\,\\boldsymbol{q}}{\\|\\boldsymbol{q}\\|}$。\n- 旋转算子：$\\boldsymbol{R} = \\begin{bmatrix} 0 & -1 \\\\ 1 & 0 \\end{bmatrix}$。\n- 外部跟随力：$\\boldsymbol{f}(\\boldsymbol{q}) = P\\,\\boldsymbol{t}(\\boldsymbol{q})$。\n- 外部虚功：$\\delta W_{\\mathrm{ext}}(\\boldsymbol{q};\\delta \\boldsymbol{q}) = \\boldsymbol{f}(\\boldsymbol{q}) \\cdot \\delta \\boldsymbol{q}$。\n- 用于线性化的基准构型：$\\boldsymbol{q}_{0} = \\begin{bmatrix} L \\\\ 0 \\end{bmatrix}$，其中 $L>0$。\n- 虚功的线性化：$\\Delta\\big(\\delta W_{\\mathrm{ext}}\\big) = \\delta \\boldsymbol{q}^{\\mathsf{T}} \\,\\boldsymbol{K}\\, \\Delta \\boldsymbol{q} + \\text{h.o.t.}$ (高阶项)。\n- 切线算子：$\\boldsymbol{K} = \\left.\\dfrac{\\partial \\boldsymbol{f}}{\\partial \\boldsymbol{q}}\\right|_{\\boldsymbol{q}_{0}}$。\n- 待评估的不匹配量：$M = \\Delta\\big(\\delta W_{\\mathrm{ext}}\\big)\\big|_{\\delta \\boldsymbol{q}=\\boldsymbol{e}_{1},\\,\\Delta \\boldsymbol{q}=\\boldsymbol{e}_{2}} - \\Delta\\big(\\delta W_{\\mathrm{ext}}\\big)\\big|_{\\delta \\boldsymbol{q}=\\boldsymbol{e}_{2},\\,\\Delta \\boldsymbol{q}=\\boldsymbol{e}_{1}}$。\n- 基向量：$\\boldsymbol{e}_{1}=\\begin{bmatrix}1\\\\0\\end{bmatrix}$ 和 $\\boldsymbol{e}_{2}=\\begin{bmatrix}0\\\\1\\end{bmatrix}$。\n\n**步骤 2：验证**\n该问题具有科学依据，提法恰当且客观。它描述了连续介质力学中一个标准的非保守随动力问题。所有术语都有数学定义，提供的数据是自洽且一致的。该问题不违反任何物理学或数学的基本原理。这是一个严谨且可形式化的问题，是非线性力学主题的核心。\n\n**步骤 3：结论**\n问题有效。将推导解答。\n\n第一个任务是推导切线刚度算子 $\\boldsymbol{K}$。我们首先用 $\\boldsymbol{q} = \\begin{bmatrix} q_1 \\\\ q_2 \\end{bmatrix}$ 的分量来表示力向量 $\\boldsymbol{f}(\\boldsymbol{q})$。\n范数为 $\\|\\boldsymbol{q}\\| = \\sqrt{q_1^2 + q_2^2}$。旋转后的向量为 $\\boldsymbol{R}\\,\\boldsymbol{q} = \\begin{bmatrix} -q_2 \\\\ q_1 \\end{bmatrix}$。\n因此，力向量为：\n$$\n\\boldsymbol{f}(\\boldsymbol{q}) = \\begin{bmatrix} f_1(q_1, q_2) \\\\ f_2(q_1, q_2) \\end{bmatrix} = \\frac{P}{\\sqrt{q_1^2 + q_2^2}} \\begin{bmatrix} -q_2 \\\\ q_1 \\end{bmatrix}\n$$\n切线算子 $\\boldsymbol{K}$ 是 $\\boldsymbol{f}$ 关于 $\\boldsymbol{q}$ 的雅可比矩阵：\n$$\n\\boldsymbol{K} = \\frac{\\partial \\boldsymbol{f}}{\\partial \\boldsymbol{q}} = \\begin{bmatrix} \\frac{\\partial f_1}{\\partial q_1} & \\frac{\\partial f_1}{\\partial q_2} \\\\ \\frac{\\partial f_2}{\\partial q_1} & \\frac{\\partial f_2}{\\partial q_2} \\end{bmatrix}\n$$\n我们计算 $\\boldsymbol{f}$ 各分量的偏导数。\n对于 $f_1 = -P q_2 (q_1^2 + q_2^2)^{-1/2}$：\n$$\n\\frac{\\partial f_1}{\\partial q_1} = -P q_2 \\left(-\\frac{1}{2}(q_1^2 + q_2^2)^{-3/2}(2q_1)\\right) = \\frac{P q_1 q_2}{(q_1^2 + q_2^2)^{3/2}}\n$$\n$$\n\\frac{\\partial f_1}{\\partial q_2} = P \\frac{\\partial}{\\partial q_2} \\left(\\frac{-q_2}{(q_1^2 + q_2^2)^{1/2}}\\right) = P \\left[ \\frac{-1 \\cdot (q_1^2+q_2^2)^{1/2} - (-q_2) \\cdot \\frac{1}{2}(q_1^2+q_2^2)^{-1/2}(2q_2)}{q_1^2+q_2^2} \\right] = P \\frac{-(q_1^2+q_2^2)+q_2^2}{(q_1^2+q_2^2)^{3/2}} = \\frac{-P q_1^2}{(q_1^2 + q_2^2)^{3/2}}\n$$\n对于 $f_2 = P q_1 (q_1^2 + q_2^2)^{-1/2}$：\n$$\n\\frac{\\partial f_2}{\\partial q_1} = P \\frac{\\partial}{\\partial q_1} \\left(\\frac{q_1}{(q_1^2 + q_2^2)^{1/2}}\\right) = P \\left[ \\frac{1 \\cdot (q_1^2+q_2^2)^{1/2} - q_1 \\cdot \\frac{1}{2}(q_1^2+q_2^2)^{-1/2}(2q_1)}{q_1^2+q_2^2} \\right] = P \\frac{(q_1^2+q_2^2)-q_1^2}{(q_1^2+q_2^2)^{3/2}} = \\frac{P q_2^2}{(q_1^2 + q_2^2)^{3/2}}\n$$\n$$\n\\frac{\\partial f_2}{\\partial q_2} = P q_1 \\left(-\\frac{1}{2}(q_1^2 + q_2^2)^{-3/2}(2q_2)\\right) = \\frac{-P q_1 q_2}{(q_1^2 + q_2^2)^{3/2}}\n$$\n组合成雅可比矩阵 $\\boldsymbol{K}(\\boldsymbol{q})$：\n$$\n\\boldsymbol{K}(\\boldsymbol{q}) = \\frac{P}{(q_1^2 + q_2^2)^{3/2}} \\begin{bmatrix} q_1 q_2 & -q_1^2 \\\\ q_2^2 & -q_1 q_2 \\end{bmatrix}\n$$\n现在，我们在指定的基准构型 $\\boldsymbol{q}_{0} = \\begin{bmatrix} L \\\\ 0 \\end{bmatrix}$ 处计算该矩阵。在该点，$q_1 = L$ 且 $q_2 = 0$。分母变为 $(L^2 + 0^2)^{3/2} = L^3$。\n将这些值代入 $\\boldsymbol{K}$ 的分量中：\n$$\nK_{11} = \\frac{P(L)(0)}{L^3} = 0\n$$\n$$\nK_{12} = \\frac{-P(L^2)}{L^3} = -\\frac{P}{L}\n$$\n$$\nK_{21} = \\frac{P(0^2)}{L^3} = 0\n$$\n$$\nK_{22} = \\frac{-P(L)(0)}{L^3} = 0\n$$\n所以，在 $\\boldsymbol{q}_{0}$ 处的切线算子为：\n$$\n\\boldsymbol{K} = \\begin{bmatrix} 0 & -\\frac{P}{L} \\\\ 0 & 0 \\end{bmatrix}\n$$\n为了证明 $\\boldsymbol{K}$ 不是对称的，我们计算它的转置：\n$$\n\\boldsymbol{K}^{\\mathsf{T}} = \\begin{bmatrix} 0 & 0 \\\\ -\\frac{P}{L} & 0 \\end{bmatrix}\n$$\n因为 $P>0$ 且 $L>0$，所以项 $-P/L$ 非零。很明显 $K_{12} = -P/L$ 而 $K_{21} = 0$，因此 $K_{12} \\neq K_{21}$。所以，$\\boldsymbol{K} \\neq \\boldsymbol{K}^{\\mathsf{T}}$，切线刚度矩阵是不对称的。这就构成了所需反例。\n\n这种不对称性的物理根源在于随动力的非保守性质。一个力场 $\\boldsymbol{f}$ 是保守的，当且仅当它是一个标量势的梯度，即 $\\boldsymbol{f} = -\\nabla V$。一个力场是保守的必要条件是其雅可比矩阵是对称的。这是混合偏导数相等（Clairaut 定理）的结果，因为 $K_{ij} = \\frac{\\partial f_i}{\\partial q_j} = \\frac{\\partial}{\\partial q_j}(-\\frac{\\partial V}{\\partial q_i}) = -\\frac{\\partial^2 V}{\\partial q_j \\partial q_i}$，必须等于 $K_{ji} = -\\frac{\\partial^2 V}{\\partial q_i \\partial q_j}$。由于我们已经证明 $\\boldsymbol{K}$ 是不对称的，因此对于力 $\\boldsymbol{f}(\\boldsymbol{q})$ 不存在这样的势 $V(\\boldsymbol{q})$。这也可以通过计算二维力场的旋度来验证：\n$$\n(\\text{curl}\\,\\boldsymbol{f})_z = \\frac{\\partial f_2}{\\partial q_1} - \\frac{\\partial f_1}{\\partial q_2} = \\frac{P q_2^2}{(q_1^2 + q_2^2)^{3/2}} - \\left(\\frac{-P q_1^2}{(q_1^2 + q_2^2)^{3/2}}\\right) = \\frac{P(q_1^2 + q_2^2)}{(q_1^2 + q_2^2)^{3/2}} = \\frac{P}{\\sqrt{q_1^2 + q_2^2}} = \\frac{P}{\\|\\boldsymbol{q}\\|}\n$$\n旋度非零（对于 $\\|\\boldsymbol{q}\\|  \\infty$），这证明了该力场是旋转场，因此是非保守的。该力所做的功与所取路径有关。切线刚度矩阵 $\\boldsymbol{K}$ 中的不对称性，是随动载荷方向依赖于构型的直接数学体现，这种依赖性使得功无法表示为势能的变化。\n\n最后，我们评估不匹配量 $M$。线性化的虚功为 $\\Delta(\\delta W_{\\mathrm{ext}}) = \\delta \\boldsymbol{q}^{\\mathsf{T}} \\boldsymbol{K} \\Delta \\boldsymbol{q}$。\n不匹配量的定义为：\n$$\nM = \\left(\\boldsymbol{e}_{1}^{\\mathsf{T}} \\boldsymbol{K} \\boldsymbol{e}_{2}\\right) - \\left(\\boldsymbol{e}_{2}^{\\mathsf{T}} \\boldsymbol{K} \\boldsymbol{e}_{1}\\right)\n$$\n该表达式就是 $\\boldsymbol{K}$ 的非对角线分量之差：\n$$\nM = K_{12} - K_{21}\n$$\n使用在 $\\boldsymbol{q}_{0}$ 处计算的 $\\boldsymbol{K}$ 的分量：\n$$\nK_{12} = -\\frac{P}{L}\n$$\n$$\nK_{21} = 0\n$$\n代入这些值得到不匹配量：\n$$\nM = -\\frac{P}{L} - 0 = -\\frac{P}{L}\n$$\n这量化了对于给定的无穷小虚位移和实位移，线性化虚功中对称性的缺失程度。", "answer": "$$\n\\boxed{-\\frac{P}{L}}\n$$", "id": "2655351"}, {"introduction": "为了连接理论推导与计算实践，本练习将指导你将解析推导的“一致切线刚度”矩阵与数值近似进行比较。通过为一个简单的非线性杆单元编写程序，你将使用有限差分法来验证从虚功原理得到的解析切线矩阵。这种“切线检验” (tangent check) 是开发和调试非线性有限元程序时一个标准且不可或缺的步骤。[@problem_id:2655378]", "problem": "考虑一个在全拉格朗日列式下经历有限轴向变形的单一双节点杆单元。问题要求将内部残差向量的数值微分雅可比矩阵与通过非线性虚功线性化得到的解析一致切线矩阵进行比较，并针对一个基准单元在多种变形和扰动情景下量化其误差。所有工作均在一维空间内，采用轴向运动学进行。\n\n使用以下基本原理：\n- 虚功原理：内部虚功由 $\\delta W_{\\text{int}} = \\int_{\\mathcal{B}_0} \\mathbf{P} : \\delta \\mathbf{F}\\, dV_0$ 给出，其中 $\\mathbf{P}$ 是第一 Piola–Kirchhoff 应力，$\\mathbf{F}$ 是变形梯度，两者均在参考构型 $\\mathcal{B}_0$ 上定义。\n- 参考长度为 $L_0$ 的双节点一维等参杆单元的运动学：轴向位移场由节点值 $u_1$ 和 $u_2$ 线性插值得到，这意味着整个单元的轴向变形梯度 $F$ 是一个常数。\n- Green–Lagrange 应变：一维情况下为 $E_G = \\dfrac{1}{2}(C - 1)$，其中右 Cauchy–Green 变形张量为 $C = F^2$。\n- 本构模型：一维 Saint Venant–Kirchhoff 超弹性定律，$S = \\mathbb{E} \\, E_G$，其中 $\\mathbb{E}$ 是杨氏模量， $S$ 是第二 Piola–Kirchhoff 应力。\n- 应力转换：$\\mathbf{P} = \\mathbf{F}\\,\\mathbf{S}$，在一维情况下简化为 $P = F\\,S$。\n\n程序需要执行的任务：\n1. 从上述基本原理出发，推导由内部虚功 $\\delta W_{\\text{int}}$ 产生的单个杆单元的内部残差向量 $r(u_1,u_2)$。该向量需用节点位移 $u_1$ 和 $u_2$、参考长度 $L_0$、横截面积 $A_0$ 以及杨氏模量 $\\mathbb{E}$ 表示。假定横截面积 $A_0$ 在整个单元上为常数。不考虑外部载荷。\n2. 通过计算残差在节点位移增量方向上的方向导数，对残差相对于节点位移进行线性化，以获得 $2 \\times 2$ 的解析一致切线矩阵 $K_{\\text{ana}}(u_1,u_2)$。您的推导必须从上述虚功表达式和本构方程开始。\n3. 通过中心有限差分法计算残差的数值雅可比矩阵 $K_{\\text{num}}$，每次扰动一个自由度，步长为 $h$，并计算\n   $$\n   \\left[K_{\\text{num}}\\right]_{ij} \\approx \\dfrac{r_i(u_1,\\ldots,u_j + h,\\ldots) - r_i(u_1,\\ldots,u_j - h,\\ldots)}{2h}.\n   $$\n4. 将矩阵误差量化为相对 Frobenius 范数\n   $$\n   \\varepsilon = \\dfrac{\\lVert K_{\\text{num}} - K_{\\text{ana}} \\rVert_F}{\\max\\left(\\lVert K_{\\text{ana}} \\rVert_F,\\; \\epsilon_{\\text{ref}}\\right)},\n   $$\n   其中 $\\epsilon_{\\text{ref}}$ 是一个小的正参考值，以避免除以零。使用 $\\epsilon_{\\text{ref}} = 10^{-30}$。\n5. 使用国际单位制（SI）：长度单位为米（$\\text{m}$），面积单位为平方米（$\\text{m}^2$），模量单位为帕斯卡（$\\text{Pa}$），位移单位为米（$\\text{m}$）。误差 $\\varepsilon$ 是无量纲的。报告的每个误差值需四舍五入到 $8$ 位小数。\n\n用于评估您实现的测试套件：\n- 情况 1（中等拉伸，接近最优扰动）：$A_0 = 3\\times 10^{-4}\\ \\text{m}^2$， $L_0 = 2.0\\ \\text{m}$， $\\mathbb{E} = 2.10\\times 10^{11}\\ \\text{Pa}$， $u_1 = 0.0\\ \\text{m}$， $u_2 = 0.24\\ \\text{m}$， $h = 1.0\\times 10^{-8}\\ \\text{m}$。\n- 情况 2（相同状态，较大扰动）：$A_0 = 3\\times 10^{-4}\\ \\text{m}^2$， $L_0 = 2.0\\ \\text{m}$， $\\mathbb{E} = 2.10\\times 10^{11}\\ \\text{Pa}$， $u_1 = 0.0\\ \\text{m}$， $u_2 = 0.24\\ \\text{m}$， $h = 1.0\\times 10^{-6}\\ \\text{m}$。\n- 情况 3（小应变，软材料）：$A_0 = 1.2\\times 10^{-3}\\ \\text{m}^2$， $L_0 = 1.0\\ \\text{m}$， $\\mathbb{E} = 2.0\\times 10^{6}\\ \\text{Pa}$， $u_1 = 0.0\\ \\text{m}$， $u_2 = 1.0\\times 10^{-6}\\ \\text{m}$， $h = 1.0\\times 10^{-9}\\ \\text{m}$。\n- 情况 4（中等压缩）：$A_0 = 1.0\\times 10^{-4}\\ \\text{m}^2$， $L_0 = 1.0\\ \\text{m}$， $\\mathbb{E} = 7.0\\times 10^{10}\\ \\text{Pa}$， $u_1 = 0.0\\ \\text{m}$， $u_2 = -0.4\\ \\text{m}$， $h = 1.0\\times 10^{-8}\\ \\text{m}$。\n- 情况 5（大拉伸）：$A_0 = 8.0\\times 10^{-5}\\ \\text{m}^2$， $L_0 = 0.5\\ \\text{m}$， $\\mathbb{E} = 1.0\\times 10^{9}\\ \\text{Pa}$， $u_1 = 0.0\\ \\text{m}$， $u_2 = 1.0\\ \\text{m}$， $h = 1.0\\times 10^{-8}\\ \\text{m}$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含上述五种情况下误差值 $\\varepsilon$ 的列表，格式为用方括号括起来的逗号分隔列表，例如：“[0.00000012,0.00003456,0.00000001,0.00000078,0.00000003]”。每个值必须四舍五入到 8 位小数。", "solution": "该问题要求针对一个经历有限轴向变形的双节点杆单元，验证其解析一致切线刚度矩阵与数值计算的雅可比矩阵的一致性。其理论框架是使用 Saint Venant–Kirchhoff 本构模型的全拉格朗日列式。验证通过量化一组指定测试用例中解析矩阵和数值矩阵之间的误差来进行。整个推导和计算必须在一维空间中进行。\n\n首先，我们将从给定的基本原理中推导出必要的表达式。\n\n**1. 运动学和变形梯度**\n考虑一个处于参考构型中的双节点杆单元，其节点位于位置 $X_1$ 和 $X_2$。参考长度为 $L_0 = X_2 - X_1$。不失一般性，我们可以设定 $X_1 = 0$ 和 $X_2 = L_0$。节点的轴向位移为 $u_1$ 和 $u_2$。节点的当前位置为 $x_1 = X_1 + u_1 = u_1$ 和 $x_2 = X_2 + u_2 = L_0 + u_2$。\n\n对于一维等参单元，位移场 $u(X)$ 由节点位移线性插值得到：\n$$\nu(X) = u_1 \\left(1 - \\frac{X}{L_0}\\right) + u_2 \\left(\\frac{X}{L_0}\\right)\n$$\n材料点 $X$ 的当前位置是 $x(X) = X + u(X)$。变形梯度 $F$ 定义为当前位置对参考位置的导数：\n$$\nF = \\frac{dx}{dX} = \\frac{d}{dX} \\left(X + u(X)\\right) = 1 + \\frac{du}{dX}\n$$\n对位移场求导可得：\n$$\n\\frac{du}{dX} = -\\frac{u_1}{L_0} + \\frac{u_2}{L_0} = \\frac{u_2 - u_1}{L_0}\n$$\n因此，变形梯度在整个单元中是恒定的：\n$$\nF = 1 + \\frac{u_2 - u_1}{L_0}\n$$\n变形梯度的变分 $\\delta F$ 是通过对 $F$ 的表达式关于节点位移取变分得到的：\n$$\n\\delta F = \\frac{\\delta u_2 - \\delta u_1}{L_0}\n$$\n这可以表示为矩阵形式 $\\delta F = \\mathbf{B} \\delta\\mathbf{u}$，其中 $\\mathbf{u} = \\begin{Bmatrix} u_1 \\\\ u_2 \\end{Bmatrix}$ 是节点位移向量，$\\mathbf{B}$ 是应变-位移矩阵（此处为一个行向量）：\n$$\n\\mathbf{B} = \\frac{1}{L_0} \\begin{bmatrix} -1  1 \\end{bmatrix}\n$$\n\n**2. 应变、应力和内部虚功**\n一维 Green–Lagrange 应变 $E_G$ 由下式给出：\n$$\nE_G = \\frac{1}{2}(F^2 - 1)\n$$\n本构模型是 Saint Venant–Kirchhoff 定律，它将第二 Piola–Kirchhoff 应力 $S$ 与 Green–Lagrange 应变关联起来：\n$$\nS = \\mathbb{E} E_G = \\frac{1}{2} \\mathbb{E} (F^2 - 1)\n$$\n其中 $\\mathbb{E}$ 是杨氏模量。第一 Piola–Kirchhoff 应力 $P$ 通过变换 $P = FS$ 获得：\n$$\nP = F \\left( \\frac{1}{2} \\mathbb{E} (F^2 - 1) \\right) = \\frac{1}{2} \\mathbb{E} (F^3 - F)\n$$\n内部虚功 $\\delta W_{\\text{int}}$ 定义为：\n$$\n\\delta W_{\\text{int}} = \\int_{\\mathcal{B}_0} P : \\delta F \\, dV_0\n$$\n在这个一维情况下，积分得以简化。由于 $P$ 和 $\\delta F$ 在单元上是常数，且参考体积为 $V_0 = A_0 L_0$（其中 $A_0$ 是恒定的横截面积），我们有：\n$$\n\\delta W_{\\text{int}} = P \\delta F (A_0 L_0)\n$$\n\n**3. 内部残差向量**\n虚功原理指出，对于任何容许的虚位移，$\\delta W_{\\text{int}}$ 必须等于外部虚功。内部残差向量 $\\mathbf{r}(\\mathbf{u})$ 代表与外部施加载荷相平衡的内力。它通过关系式 $\\delta W_{\\text{int}} = \\delta \\mathbf{u}^T \\mathbf{r}$ 定义。代入 $P$ 和 $\\delta F$ 的表达式：\n$$\n\\delta W_{\\text{int}} = \\left[ \\frac{1}{2} \\mathbb{E} (F^3 - F) \\right] \\left( \\frac{\\delta u_2 - \\delta u_1}{L_0} \\right) (A_0 L_0) = \\frac{1}{2} A_0 \\mathbb{E} (F^3 - F) (\\delta u_2 - \\delta u_1)\n$$\n将其表示为 $\\delta \\mathbf{u}^T \\mathbf{r}$ 的形式：\n$$\n\\delta W_{\\text{int}} = \\begin{bmatrix} \\delta u_1  \\delta u_2 \\end{bmatrix} \\begin{Bmatrix} -\\frac{1}{2} A_0 \\mathbb{E} (F^3 - F) \\\\ \\frac{1}{2} A_0 \\mathbb{E} (F^3 - F) \\end{Bmatrix}\n$$\n因此，内部残差向量 $\\mathbf{r}$ 为：\n$$\n\\mathbf{r}(\\mathbf{u}) = \\frac{1}{2} A_0 \\mathbb{E} (F^3 - F) \\begin{Bmatrix} -1 \\\\ 1 \\end{Bmatrix}\n$$\n\n**4. 解析一致切线矩阵**\n一致切线刚度矩阵 $K_{\\text{ana}}$ 是通过对内部虚功取方向导数得到的，这等价于将残差向量 $\\mathbf{r}$ 对节点位移 $\\mathbf{u}$ 进行线性化。我们计算由位移增量 $\\Delta \\mathbf{u}$ 引起的 $\\delta W_{\\text{int}}$ 的变分：\n$$\n\\Delta(\\delta W_{\\text{int}}) = \\delta \\mathbf{u}^T K_{\\text{ana}} \\Delta \\mathbf{u}\n$$\n从 $\\delta W_{\\text{int}} = (A_0 L_0) P \\delta F$ 出发，并注意到 $\\delta F$ 是 $\\delta \\mathbf{u}$ 的线性函数，因此其关于 $\\mathbf{u}$ 的变分为零，我们得到：\n$$\n\\Delta(\\delta W_{\\text{int}}) = (A_0 L_0) (\\Delta P) \\delta F\n$$\n第一 Piola–Kirchhoff 应力的变分 $\\Delta P$ 为：\n$$\n\\Delta P = \\frac{dP}{dF} \\Delta F = \\frac{d}{dF}\\left(\\frac{1}{2}\\mathbb{E}(F^3 - F)\\right) \\Delta F = \\frac{1}{2} \\mathbb{E} (3F^2 - 1) \\Delta F\n$$\n项 $C^{\\text{tan}} = \\frac{1}{2} \\mathbb{E} (3F^2 - 1)$ 是切线本构模量。将其代入 $\\Delta(\\delta W_{\\text{int}})$ 的表达式中：\n$$\n\\Delta(\\delta W_{\\text{int}}) = (A_0 L_0) \\left[ \\frac{1}{2} \\mathbb{E} (3F^2 - 1) \\Delta F \\right] \\delta F\n$$\n使用矩阵形式 $\\delta F = \\mathbf{B} \\delta\\mathbf{u}$ 和 $\\Delta F = \\mathbf{B} \\Delta\\mathbf{u}$，我们有：\n$$\n\\Delta(\\delta W_{\\text{int}}) = (A_0 L_0) \\frac{1}{2} \\mathbb{E} (3F^2 - 1) (\\mathbf{B} \\Delta\\mathbf{u}) (\\mathbf{B} \\delta\\mathbf{u})\n$$\n由于这些项是标量，我们可以将它们重新排列成标准的矩阵二次型：\n$$\n\\Delta(\\delta W_{\\text{int}}) = (\\mathbf{B} \\delta\\mathbf{u})^T (A_0 L_0) \\frac{1}{2} \\mathbb{E} (3F^2 - 1) (\\mathbf{B} \\Delta\\mathbf{u}) = \\delta\\mathbf{u}^T \\left[ (A_0 L_0) \\frac{1}{2} \\mathbb{E} (3F^2 - 1) \\mathbf{B}^T \\mathbf{B} \\right] \\Delta\\mathbf{u}\n$$\n通过观察，方括号中的表达式即为解析切线矩阵 $K_{\\text{ana}}$：\n$$\nK_{\\text{ana}} = (A_0 L_0) \\frac{1}{2} \\mathbb{E} (3F^2 - 1) \\mathbf{B}^T \\mathbf{B}\n$$\n代入 $\\mathbf{B}^T \\mathbf{B} = \\frac{1}{L_0^2} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}$，我们得到最终形式：\n$$\nK_{\\text{ana}} = \\frac{A_0 \\mathbb{E}}{2 L_0} (3F^2 - 1) \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\n\n**5. 通过有限差分计算数值雅可比矩阵**\n数值雅可比矩阵 $K_{\\text{num}}$ 是通过使用中心有限差分法近似计算残差向量分量的偏导数来得到的。对于扰动步长 $h$，$K_{\\text{num}}$ 的第 $(i, j)$ 个分量是：\n$$\n\\left[K_{\\text{num}}\\right]_{ij} = \\frac{\\partial r_i}{\\partial u_j} \\approx \\frac{r_i(\\mathbf{u} + h\\mathbf{e}_j) - r_i(\\mathbf{u} - h\\mathbf{e}_j)}{2h}\n$$\n其中 $\\mathbf{e}_j$ 是标准基向量（例如, $\\mathbf{e}_1 = \\begin{Bmatrix} 1 \\\\ 0 \\end{Bmatrix}$）。此过程应用于矩阵的每个分量。\n\n**6. 误差量化**\n数值和解析切线矩阵之间的差异使用它们差的相对 Frobenius 范数来量化：\n$$\n\\varepsilon = \\dfrac{\\lVert K_{\\text{num}} - K_{\\text{ana}} \\rVert_F}{\\max\\left(\\lVert K_{\\text{ana}} \\rVert_F,\\; \\epsilon_{\\text{ref}}\\right)}\n$$\n矩阵 $\\mathbf{A}$ 的 Frobenius 范数由 $\\lVert \\mathbf{A} \\rVert_F = \\sqrt{\\sum_{i}\\sum_{j} |A_{ij}|^2}$ 给出。参考值 $\\epsilon_{\\text{ref}} = 10^{-30}$ 是一个正则化参数，用于在解析切线是零矩阵的情况下（例如，在未变形状态下，如果 $3F^2 - 1 = 0$，但对于 $F=1$ 时的 StVK 材料并非如此）避免除以零。\n\n基于这些推导，可以构建一个程序来计算给定测试场景下的误差 $\\varepsilon$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of comparing analytical and numerical tangent matrices\n    for a nonlinear bar element.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (moderate tension, near-optimal perturbation)\n        {'A0': 3e-4, 'L0': 2.0, 'E': 2.10e11, 'u1': 0.0, 'u2': 0.24, 'h': 1.0e-8},\n        # Case 2 (same state, larger perturbation)\n        {'A0': 3e-4, 'L0': 2.0, 'E': 2.10e11, 'u1': 0.0, 'u2': 0.24, 'h': 1.0e-6},\n        # Case 3 (small strain, soft material)\n        {'A0': 1.2e-3, 'L0': 1.0, 'E': 2.0e6, 'u1': 0.0, 'u2': 1.0e-6, 'h': 1.0e-9},\n        # Case 4 (moderate compression)\n        {'A0': 1.0e-4, 'L0': 1.0, 'E': 7.0e10, 'u1': 0.0, 'u2': -0.4, 'h': 1.0e-8},\n        # Case 5 (large tension)\n        {'A0': 8.0e-5, 'L0': 0.5, 'E': 1.0e9, 'u1': 0.0, 'u2': 1.0, 'h': 1.0e-8},\n    ]\n\n    # Reference value for error normalization\n    epsilon_ref = 1e-30\n\n    def calculate_residual(u, A0, L0, E):\n        \"\"\"Calculates the internal residual vector.\"\"\"\n        u1, u2 = u\n        F = 1.0 + (u2 - u1) / L0\n        scalar_part = 0.5 * A0 * E * (F**3 - F)\n        return np.array([-scalar_part, scalar_part])\n\n    def calculate_analytical_tangent(u, A0, L0, E):\n        \"\"\"Calculates the analytical consistent tangent matrix.\"\"\"\n        u1, u2 = u\n        F = 1.0 + (u2 - u1) / L0\n        scalar_part = (A0 * E) / (2.0 * L0) * (3.0 * F**2 - 1.0)\n        base_matrix = np.array([[1.0, -1.0], [-1.0, 1.0]])\n        return scalar_part * base_matrix\n\n    def calculate_numerical_tangent(u, A0, L0, E, h):\n        \"\"\"Calculates the numerical Jacobian by central finite difference.\"\"\"\n        K_num = np.zeros((2, 2))\n        u_vec = np.array(u)\n        \n        for j in range(2):\n            perturbation = np.zeros(2)\n            perturbation[j] = h\n            \n            u_plus = u_vec + perturbation\n            u_minus = u_vec - perturbation\n            \n            r_plus = calculate_residual(u_plus, A0, L0, E)\n            r_minus = calculate_residual(u_minus, A0, L0, E)\n            \n            K_num[:, j] = (r_plus - r_minus) / (2.0 * h)\n            \n        return K_num\n\n    def calculate_error(K_num, K_ana):\n        \"\"\"Calculates the relative Frobenius norm error.\"\"\"\n        diff_norm = np.linalg.norm(K_num - K_ana, 'fro')\n        ana_norm = np.linalg.norm(K_ana, 'fro')\n        denominator = max(ana_norm, epsilon_ref)\n        return diff_norm / denominator\n\n    results = []\n    for case in test_cases:\n        A0, L0, E, u1, u2, h = case['A0'], case['L0'], case['E'], case['u1'], case['u2'], case['h']\n        u_current = (u1, u2)\n\n        # 1. Compute analytical tangent\n        K_ana = calculate_analytical_tangent(u_current, A0, L0, E)\n\n        # 2. Compute numerical tangent\n        K_num = calculate_numerical_tangent(u_current, A0, L0, E, h)\n\n        # 3. Compute error\n        error = calculate_error(K_num, K_ana)\n        results.append(f\"{round(error, 8):.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2655378"}]}