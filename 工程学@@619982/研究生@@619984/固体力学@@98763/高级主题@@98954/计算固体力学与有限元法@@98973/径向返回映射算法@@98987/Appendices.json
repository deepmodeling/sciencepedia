{"hands_on_practices": [{"introduction": "本练习全面地审视了用于标准 von Mises ($J_2$) 塑性模型的径向返回映射算法的全过程。[@problem_id:2678297] 通过要求您识别正确的操作顺序、数据依赖关系和常见的实现陷阱，此实践巩固了您对算法从输入到输出的整体结构的理解。这是编写任何代码之前至关重要的第一步，可以确保您拥有一个清晰而正确的蓝图。", "problem": "考虑一个小应变、关联 von Mises ($J_2$) 各向同性硬化弹塑性有限元 (FE) 计算中的单个材料积分点，该积分点通过后向欧拉径向返回映射进行隐式积分。该材料具有线性弹性，体积模量为 $\\kappa$，剪切模量为 $\\mu$，以及各向同性硬化屈服应力 $\\sigma_{y}(\\alpha)$，其切线为 $H' = d\\sigma_{y}/d\\alpha$。在第 $n$ 步的状态包括 Cauchy 应力 $\\boldsymbol{\\sigma}_{n}$、塑性应变 $\\boldsymbol{\\varepsilon}^{p}_{n}$ 和等效塑性应变 $\\alpha_{n}$。在第 $n+1$ 步，输入是总应变增量 $\\Delta \\boldsymbol{\\varepsilon}$ 和当前温度下的材料参数。更新过程必须输出 Cauchy 应力 $\\boldsymbol{\\sigma}_{n+1}$ 和对称的算法一致性切线 $\\mathbb{C}_{n+1}$，以及更新后的内变量。假设为小应变运动学、标准的关联流动法则以及率无关塑性的 Kuhn–Tucker 条件。不存在额外的随动硬化。\n\n对于单个积分点上鲁棒的径向返回实现，哪个选项最准确、最完整地规定了正确顺序的算法序列、连接输入、状态和输出的数据依赖关系，以及需要防范的、现实且常见的实现错误来源？\n\nA. 序列和依赖关系：\n- 输入：$\\Delta \\boldsymbol{\\varepsilon}$, $\\boldsymbol{\\sigma}_{n}$, $\\boldsymbol{\\varepsilon}^{p}_{n}$, $\\alpha_{n}$, $\\kappa$, $\\mu$, $\\sigma_{y}(\\cdot)$。\n- 计算弹性试探应力 $\\boldsymbol{\\sigma}_{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbb{C}^{e} : \\Delta \\boldsymbol{\\varepsilon}$，其中 $\\mathbb{C}^{e} = \\kappa \\mathbf{I} \\otimes \\mathbf{I} + 2\\mu \\mathbb{I}_{\\mathrm{dev}}$。\n- 使用 $f_{\\mathrm{tr}} = \\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert - \\sigma_{y}(\\alpha_{n})$ 检查屈服。\n- 如果 $f_{\\mathrm{tr}} \\le 0$，则设置 $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}}$，$\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n}$，$\\alpha_{n+1} = \\alpha_{n}$，以及 $\\mathbb{C}_{n+1} = \\mathbb{C}^{e}$。\n- 如果 $f_{\\mathrm{tr}} > 0$，则计算方向 $\\mathbf{n} = \\boldsymbol{\\sigma}_{\\mathrm{tr}}/\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert$ 和塑性乘子 $\\Delta \\gamma = f_{\\mathrm{tr}}/(2\\mu)$，修正应力 $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}} - 2\\mu \\Delta \\gamma \\mathbf{n}$，更新 $\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n} + \\Delta \\gamma \\mathbf{n}$ 和 $\\alpha_{n+1} = \\alpha_{n} + \\sqrt{2/3}\\,\\Delta \\gamma$，并设置 $\\mathbb{C}_{n+1} = \\mathbb{C}^{e}$。\n- 常见错误：由大的 $\\Delta \\boldsymbol{\\varepsilon}$ 引起的 Newton–Raphson 发散；范数计算中的浮点数下溢。\n\nB. 序列和依赖关系：\n- 输入：$\\Delta \\boldsymbol{\\varepsilon}$, $\\boldsymbol{\\sigma}_{n}$, $\\boldsymbol{\\varepsilon}^{p}_{n}$, $\\alpha_{n}$，材料参数 $\\kappa$、$\\mu$，以及与所选积分点状态一致地求值的硬化定律 $\\sigma_{y}(\\cdot)$ 及其切线 $H'(\\cdot)$。\n- 弹性预测步：通过对总增量的弹性响应并保持塑性应变不变来计算试探应力，$\\boldsymbol{\\sigma}_{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbb{C}^{e} : \\Delta \\boldsymbol{\\varepsilon}$，其中 $\\mathbb{C}^{e} = \\kappa \\mathbf{I} \\otimes \\mathbf{I} + 2\\mu \\mathbb{I}_{\\mathrm{dev}}$，$\\mathbb{I}_{\\mathrm{dev}} = \\mathbb{I}_{\\mathrm{s}} - \\tfrac{1}{3} \\mathbf{I} \\otimes \\mathbf{I}$ 且 $\\mathbb{I}_{\\mathrm{s}}$ 是四阶对称单位张量。提取偏量试探应力 $\\mathbf{s}_{\\mathrm{tr}} = \\mathrm{dev}(\\boldsymbol{\\sigma}_{\\mathrm{tr}})$。\n- 对偏量范数进行屈服检查：$f_{\\mathrm{tr}} = \\sqrt{3/2}\\,\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sigma_{y}(\\alpha_{n})$。\n- 如果 $f_{\\mathrm{tr}} \\le 0$，则为弹性步：接受试探状态，即 $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}}$，$\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n}$，$\\alpha_{n+1} = \\alpha_{n}$，并设置 $\\mathbb{C}_{n+1} = \\mathbb{C}^{e}$。\n- 如果 $f_{\\mathrm{tr}} > 0$，则为塑性修正步：计算单位流动方向 $\\mathbf{n} = \\mathbf{s}_{\\mathrm{tr}}/\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert$（共轴性），并使用一致性线性化计算塑性乘子 $\\Delta \\gamma = f_{\\mathrm{tr}}/(3\\mu + H')$，其中 $H' = d\\sigma_{y}/d\\alpha$ 的求值应保持一致（对于闭式更新，通常在 $\\alpha_{n}$ 处，或在局部 Newton 迭代中，在 $\\alpha_{n+1}$ 处）。通过对偏量部分进行径向返回来更新应力，并保持静水压力部分为弹性：$\\mathbf{s}_{n+1} = \\mathbf{s}_{\\mathrm{tr}} - 2\\mu\\,\\Delta \\gamma\\,\\sqrt{3/2}\\,\\mathbf{n}$ 且 $p_{n+1} = p_{\\mathrm{tr}}$，因此 $\\boldsymbol{\\sigma}_{n+1} = p_{\\mathrm{tr}}\\mathbf{I} + \\mathbf{s}_{n+1}$。通过关联流动法则更新内变量：$\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\partial f/\\partial \\boldsymbol{\\sigma} = \\Delta \\gamma\\,\\sqrt{3/2}\\,\\mathbf{n}$，$\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n} + \\Delta \\boldsymbol{\\varepsilon}^{p}$，以及 $\\alpha_{n+1} = \\alpha_{n} + \\Delta \\gamma$。\n- 算法一致性切线：返回 $\\mathbb{C}_{n+1} = \\kappa \\mathbf{I} \\otimes \\mathbf{I} + 2\\mu\\left(\\mathbb{I}_{\\mathrm{dev}} - \\frac{3\\mu}{3\\mu + H'}\\,\\mathbf{n} \\otimes \\mathbf{n}\\right)$，它是对称的，并且仅在偏量空间中沿 $\\mathbf{n}$ 方向降低刚度；如果 $\\sigma_{y}$ 是非线性的，则使用与应力更新点一致的 $H' = d\\sigma_{y}/d\\alpha$。\n- 数据依赖关系：更新依赖于 $(\\Delta \\boldsymbol{\\varepsilon}, \\boldsymbol{\\sigma}_{n}, \\boldsymbol{\\varepsilon}^{p}_{n}, \\alpha_{n}, \\kappa, \\mu, \\sigma_{y}(\\cdot), H'(\\cdot))$; 塑性分支进一步依赖于试探方向 $\\mathbf{n}$ 和 $H'$，而切线则依赖于在所选求值状态下的 $\\mathbf{n}$ 和 $H'$。\n- 常见实现错误：在 $f_{\\mathrm{tr}}$ 中使用 $\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert$ 而非 $\\lVert \\mathrm{dev}(\\boldsymbol{\\sigma}_{\\mathrm{tr}}) \\rVert$；在构造 $\\mathbf{n}$ 时忘记对 $\\mathbf{s}_{\\mathrm{tr}}$进行归一化；在塑性修正过程中错误地修改了静水应力（违反了塑性不可压缩性）；由于忽略了投影算子 $\\mathbf{n} \\otimes \\mathbf{n}$ 导致 $\\mathbb{C}_{n+1}$ 不一致或不对称；对于非线性硬化，在错误的状态下对 $H'$ 求值；未能鲁棒地处理 $\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert \\approx 0$ 或非常小的 $f_{\\mathrm{tr}}$ 的情况；混用 $\\boldsymbol{\\varepsilon}^{p}$ 或 $\\alpha$ 的总量和增量；返回割线切线而非一致性切线；在适用时忽略了 $\\kappa$、$\\mu$ 或 $\\sigma_{y}$ 的温度或率相关性；如果使用 Newton 迭代求解 $\\Delta \\gamma$ 时，局部求解的容差不充分，或者对于非常大的 $\\Delta \\boldsymbol{\\varepsilon}$ 缺乏子步。\n\nC. 序列和依赖关系：\n- 输入：$\\Delta \\boldsymbol{\\varepsilon}$, $\\boldsymbol{\\sigma}_{n}$, $\\boldsymbol{\\varepsilon}^{p}_{n}$, $\\alpha_{n}$, $\\kappa$, $\\mu$, $\\sigma_{y}(\\cdot)$。\n- 计算 $\\boldsymbol{\\sigma}_{\\mathrm{tr}}$ 和 $f_{\\mathrm{tr}}$ 如同在弹性预测步中一样，但用 $f_{\\mathrm{tr}} = \\sqrt{3}\\,\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert - \\sigma_{y}(\\alpha_{n})$ 替换屈服函数。\n- 如果 $f_{\\mathrm{tr}} > 0$，则通过对 $g(\\Delta \\gamma) = \\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} - 2\\mu \\Delta \\gamma \\mathbf{n} \\rVert - \\sigma_{y}(\\alpha_{n})$ 进行 Newton 迭代来求解 $\\Delta \\gamma$，初始猜测值为 $\\Delta \\gamma = f_{\\mathrm{tr}}/\\mu$；先通过 $\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n} + \\Delta \\gamma \\mathbf{n}$ 更新塑性应变，然后根据总应变弹性地重新计算应力；设置 $\\alpha_{n+1} = \\alpha_{n} + \\Delta \\gamma$ 并将静水应力减少与偏量修正相同的量；返回一个根据 $\\Delta \\boldsymbol{\\sigma}/\\Delta \\boldsymbol{\\varepsilon}$ 计算的对称割线切线。\n- 常见错误：Newton 求解的收敛性差；$\\Delta \\gamma$ 的超调；对时间步长选择的敏感性。\n\nD. 序列和依赖关系：\n- 输入：$\\Delta \\boldsymbol{\\varepsilon}$, $\\boldsymbol{\\sigma}_{n}$, $\\boldsymbol{\\varepsilon}^{p}_{n}$, $\\alpha_{n}$, $\\kappa$, $\\mu$, $\\sigma_{y}(\\cdot)$。\n- 使用客观应力率 (Jaumann 率) 来旋转 $\\boldsymbol{\\sigma}_{n}$，然后计算试探应力；对于塑性，由 $\\boldsymbol{\\sigma}_{n+1}$ 计算 $\\mathbf{n}$ 并设置 $\\Delta \\gamma = \\left(\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert - \\sigma_{y}(\\alpha_{n+1})\\right)/(3\\mu)$；通过相同的塑性修正来更新静水应力和偏量应力；由 $\\Delta \\boldsymbol{\\varepsilon}^{p}$ 的迹来更新 $\\alpha_{n+1}$；返回 $\\mathbb{C}_{n+1} = \\mathbb{C}^{e}$ 以保持对称性。\n- 常见错误：忽略了同旋效应；主方向的错位；在屈服面角点附近 $\\mathbf{n}$ 的非唯一性。\n\n选择一个选项。", "solution": "我们从具有各向同性硬化的小应变关联 von Mises ($J_2$) 塑性的第一性原理以及后向欧拉时间离散化出发，推导算法序列、数据依赖关系和一致性切线。目标是以一种热力学上一致且数值上鲁棒的方式，将单个积分点的输入映射到更新后的应力和算法切线。\n\n基本本构结构。在线性弹性的小应变弹塑性中，Cauchy 应力为\n$$\n\\boldsymbol{\\sigma} = \\kappa\\,\\mathrm{tr}\\!\\left(\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{p}\\right)\\mathbf{I} + 2\\mu\\,\\mathrm{dev}\\!\\left(\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{p}\\right),\n$$\n其中 $\\boldsymbol{\\varepsilon}$ 是总应变，$\\boldsymbol{\\varepsilon}^{p}$ 是塑性应变，$\\kappa$ 是体积模量，$\\mu$ 是剪切模量，$\\mathbf{I}$ 是二阶单位张量，$\\mathrm{dev}(\\cdot)$ 表示偏量部分。定义偏应力 $\\mathbf{s} = \\mathrm{dev}(\\boldsymbol{\\sigma})$ 和静水压力 $p = \\tfrac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})$。von Mises 等效应力为 $\\sigma_{\\mathrm{eq}} = \\sqrt{3/2}\\,\\lVert \\mathbf{s} \\rVert$，带有各向同性硬化的屈服函数为\n$$\nf(\\boldsymbol{\\sigma}, \\alpha) = \\sigma_{\\mathrm{eq}} - \\sigma_{y}(\\alpha) \\le 0.\n$$\n关联流动和硬化法则可写为\n$$\n\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\Delta \\gamma\\,\\sqrt{\\tfrac{3}{2}}\\,\\mathbf{n}, \\quad \\mathbf{n} := \\frac{\\mathbf{s}}{\\lVert \\mathbf{s} \\rVert}, \\quad \\Delta \\alpha = \\sqrt{\\tfrac{2}{3}}\\lVert \\Delta \\boldsymbol{\\varepsilon}^{p} \\rVert = \\Delta \\gamma,\n$$\n其中 Kuhn–Tucker 条件为 $\\Delta \\gamma \\ge 0$, $f \\le 0$, and $\\Delta \\gamma\\,f = 0$。弹性刚度为 $\\mathbb{C}^{e} = \\kappa \\mathbf{I} \\otimes \\mathbf{I} + 2\\mu \\mathbb{I}_{\\mathrm{dev}}$，其中 $\\mathbb{I}_{\\mathrm{dev}} = \\mathbb{I}_{\\mathrm{s}} - \\tfrac{1}{3} \\mathbf{I} \\otimes \\mathbf{I}$ 且 $\\mathbb{I}_{\\mathrm{s}}$ 是四阶对称单位张量。\n\n径向返回映射。给定状态 $(\\boldsymbol{\\sigma}_{n}, \\boldsymbol{\\varepsilon}^{p}_{n}, \\alpha_{n})$ 和增量 $\\Delta \\boldsymbol{\\varepsilon}$，弹性预测步（试探状态）假设 $\\Delta \\boldsymbol{\\varepsilon}^{p} = \\mathbf{0}$：\n$$\n\\boldsymbol{\\sigma}_{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbb{C}^{e} : \\Delta \\boldsymbol{\\varepsilon}, \\qquad \\mathbf{s}_{\\mathrm{tr}} = \\mathrm{dev}(\\boldsymbol{\\sigma}_{\\mathrm{tr}}).\n$$\n计算试探屈服函数\n$$\nf_{\\mathrm{tr}} = \\sqrt{\\tfrac{3}{2}}\\,\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sigma_{y}(\\alpha_{n}).\n$$\n如果 $f_{\\mathrm{tr}} \\le 0$，则该步为弹性步：接受试探状态\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}}, \\quad \\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n}, \\quad \\alpha_{n+1} = \\alpha_{n}, \\quad \\mathbb{C}_{n+1} = \\mathbb{C}^{e}.\n$$\n如果 $f_{\\mathrm{tr}} > 0$，则发生塑性加载。在各向同性和关联性条件下，修正方向与偏量试探应力共轴（共轴性）。定义单位方向\n$$\n\\mathbf{n} = \\frac{\\mathbf{s}_{\\mathrm{tr}}}{\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert}.\n$$\n对流动和硬化法则使用后向欧拉法，并施加 $f_{n+1} = 0$（一致性条件），偏应力更新为\n$$\n\\mathbf{s}_{n+1} = \\mathbf{s}_{\\mathrm{tr}} - 2\\mu\\,\\Delta \\gamma\\,\\sqrt{\\tfrac{3}{2}}\\,\\mathbf{n}, \\quad p_{n+1} = p_{\\mathrm{tr}},\n$$\n因此 $\\boldsymbol{\\sigma}_{n+1} = p_{\\mathrm{tr}} \\mathbf{I} + \\mathbf{s}_{n+1}$。更新后的内变量为\n$$\n\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n} + \\Delta \\gamma\\,\\sqrt{\\tfrac{3}{2}}\\,\\mathbf{n}, \\qquad \\alpha_{n+1} = \\alpha_{n} + \\Delta \\gamma.\n$$\n为了求得 $\\Delta \\gamma$，我们施加 $f_{n+1} = 0$，并对 $\\sigma_{y}(\\alpha_{n+1}) \\approx \\sigma_{y}(\\alpha_{n}) + H' \\Delta \\gamma$ 进行一阶线性化，其中 $H' = d\\sigma_{y}/d\\alpha$ 的求值应保持一致。在 $n+1$ 步的等效应力等于\n$$\n\\sigma_{\\mathrm{eq},n+1} = \\sqrt{\\tfrac{3}{2}}\\,\\lVert \\mathbf{s}_{n+1} \\rVert = \\sqrt{\\tfrac{3}{2}}\\left(\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - 2\\mu\\,\\Delta \\gamma\\,\\sqrt{\\tfrac{3}{2}}\\right) = \\sqrt{\\tfrac{3}{2}}\\,\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - 3\\mu\\,\\Delta \\gamma.\n$$\n一致性条件 $f_{n+1} = \\sigma_{\\mathrm{eq},n+1} - \\sigma_{y}(\\alpha_{n+1}) = 0$ 给出\n$$\n0 = \\underbrace{\\left(\\sqrt{\\tfrac{3}{2}}\\,\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sigma_{y}(\\alpha_{n})\\right)}_{f_{\\mathrm{tr}}} - (3\\mu + H')\\,\\Delta \\gamma \\quad \\Rightarrow \\quad \\Delta \\gamma = \\frac{f_{\\mathrm{tr}}}{3\\mu + H'}.\n$$\n这是各向同性硬化的径向返回算法的标志性闭式解；对于非线性的 $\\sigma_{y}(\\cdot)$，也可以通过针对 $\\Delta \\gamma$ 的标量 Newton 方法求解 $f_{n+1} = 0$，同时保持相同的结构。\n\n算法一致性切线。将应力更新对总应变求导。静水压力部分保持弹性，贡献项为 $\\kappa \\mathbf{I} \\otimes \\mathbf{I}$。在偏量子空间中，使用由共轴性固定的 $\\mathbf{n}$，并通过一致性线性化考虑 $\\mathrm{d}\\Delta \\gamma$，可以得到众所周知的对称算法切线\n$$\n\\mathbb{C}_{n+1} = \\kappa \\mathbf{I} \\otimes \\mathbf{I} + 2\\mu\\left(\\mathbb{I}_{\\mathrm{dev}} - \\frac{3\\mu}{3\\mu + H'}\\,\\mathbf{n} \\otimes \\mathbf{n}\\right).\n$$\n这种形式仅沿激活的流动方向 $\\mathbf{n}$ 将剪切刚度降低了，保持了体积弹性，并且是对称的。如果硬化模量依赖于 $\\alpha$，则 $H' = d\\sigma_{y}/d\\alpha$ 的求值应与应力更新点一致，以保证全局 Newton 方法的二次收敛性。\n\n数据依赖关系。更新需要应变增量 $\\Delta \\boldsymbol{\\varepsilon}$、先前的状态 $(\\boldsymbol{\\sigma}_{n}, \\boldsymbol{\\varepsilon}^{p}_{n}, \\alpha_{n})$、弹性模量 $(\\kappa, \\mu)$ 以及硬化定律 $\\sigma_{y}(\\cdot)$ 及其切线 $H'(\\cdot)$。在塑性分支上，方向 $\\mathbf{n}$ 和标量 $\\Delta \\gamma$ 从试探状态计算得出；一致性切线显式地依赖于 $\\mathbf{n}$ 和 $H'$。\n\n常见错误来源。典型的错误有：在屈服检查中使用 $\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert$ 的范数而不是 $\\lVert \\mathrm{dev}(\\boldsymbol{\\sigma}_{\\mathrm{tr}}) \\rVert$ 的范数；在构造 $\\mathbf{n}$ 时未能对 $\\mathbf{s}_{\\mathrm{tr}}$ 进行归一化；在塑性修正过程中修改静水应力（违反塑性不可压缩性）；通过省略投影算子 $\\mathbf{n} \\otimes \\mathbf{n}$ 返回非对称或不一致的切线；对于非线性硬化，在不一致的状态下对 $H'$ 求值；没有鲁棒地处理 $\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert \\approx 0$ 或非常小的 $f_{\\mathrm{tr}}$ 的情况；混用 $\\boldsymbol{\\varepsilon}^{p}$ 或 $\\alpha$ 的总量更新和增量更新；返回割线切线而非一致性切线；在存在温度或率相关性时忽略了它们；对于极大的 $\\Delta \\boldsymbol{\\varepsilon}$，缺乏子步。\n\n逐项分析。\n\n- 选项 A：不正确。它在屈服检查中使用了全应力范数 $\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert$，而不是偏量范数 $\\sqrt{3/2}\\,\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert$。塑性流动方向 $\\mathbf{n}$ 取自总应力，流动大小忽略了因子 $\\sqrt{3/2}$，破坏了与 von Mises 度量的一致性。硬化增量 $\\alpha_{n+1} = \\alpha_{n} + \\sqrt{2/3}\\,\\Delta \\gamma$ 与 $\\Delta \\alpha = \\Delta \\gamma$ 的标准归一化不一致。它还在塑性情况下返回 $\\mathbb{C}^{e}$，这不是算法一致性切线，会损害全局 Newton 方法的收敛性。所列出的错误不完整，没有突出上述根本性问题。\n\n- 选项 B：正确。它一致地指定了输入和状态，执行弹性预测步，使用正确的 $\\sqrt{3/2}$ 因子对偏量范数进行屈服检查，区分弹性和塑性分支，沿归一化的偏量试探方向应用塑性修正，保持静水应力弹性（塑性不可压缩性），通过关联流动和确保 $\\Delta \\alpha = \\Delta \\gamma$ 的归一化来更新 $\\boldsymbol{\\varepsilon}^{p}$ 和 $\\alpha$，并提供了对称的算法一致性切线 $\\mathbb{C}_{n+1} = \\kappa \\mathbf{I} \\otimes \\mathbf{I} + 2\\mu\\left(\\mathbb{I}_{\\mathrm{dev}} - \\frac{3\\mu}{3\\mu + H'}\\,\\mathbf{n} \\otimes \\mathbf{n}\\right)$。它还正确地指出了对 $H'$ 和 $\\mathbf{n}$ 的依赖性，并列举了现实中的实现错误。\n\n- 选项 C：不正确。它用 $\\sqrt{3}\\,\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert$ 定义了屈服检查，错误地缩放了等效应力并使用了总应力范数。初始猜测值 $\\Delta \\gamma = f_{\\mathrm{tr}}/\\mu$ 忽略了硬化和正确的因子 $3\\mu$，并且塑性更新在更新塑性应变后，完全根据总应变弹性地重新计算应力，这不是径向返回的形式。它在塑性修正过程中错误地减小了静水应力，违反了塑性不可压缩性，并且返回了割线切线，而不是保证全局二次收敛性所需的一致性切线。\n\n- 选项 D：不正确。在没有有限旋转的小应变设置中，引入客观应力率 (Jaumann) 和应力旋转是不必要且不正确的。它用一个不一致的分母计算 $\\Delta \\gamma$，并在 $\\alpha_{n+1}$ 被一致地确定之前就在屈服应力中使用了它。它还将塑性修正应用于静水和偏量部分，违反了塑性不可压缩性，并在塑性情况下返回 $\\mathbb{C}^{e}$，这是不一致的。所列出的错误来源并非此算法背景下的主要问题。\n\n因此，只有选项 B 满足了正确的序列、依赖关系和错误识别。", "answer": "$$\\boxed{B}$$", "id": "2678297"}, {"introduction": "尽管 von Mises 屈服面是光滑的，但许多重要的材料模型（例如用于土壤的 Mohr-Coulomb 模型）具有带尖角和棱边的非光滑屈服面。[@problem_id:2678260] 该练习探讨了在这些不可微点上出现的理论和算法挑战。此实践将促使您超越简单的“径向”返回概念，引入处理这些高级模型所需的更通用的次微分和最近点投影框架，这对于将计算塑性力学应用于更广泛的工程材料至关重要。", "problem": "一个小应变、率无关、各向同性弹性、理想塑性固体通过相关联流动法则和凸但非光滑的屈服面进行建模。设弹性自由能为 $\\psi(\\boldsymbol{\\varepsilon},\\boldsymbol{\\varepsilon}^{p})=\\tfrac{1}{2}\\,(\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^{p}):\\mathbb{C}:(\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^{p})$，其中 $\\mathbb{C}$ 是四阶弹性张量，$\\boldsymbol{\\varepsilon}$ 是总小应变，$\\boldsymbol{\\varepsilon}^{p}$ 是塑性应变。柯西应力为 $\\boldsymbol{\\sigma}=\\mathbb{C}:(\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^{p})$。屈服条件为 $f(\\boldsymbol{\\sigma})\\le 0$，相关联流动法则为 $\\dot{\\boldsymbol{\\varepsilon}}^{p}=\\dot{\\lambda}\\,\\partial f(\\boldsymbol{\\sigma})$，其中当 $f$ 可微时，$\\partial f(\\boldsymbol{\\sigma})$ 表示 $f$ 的梯度。\n\n考虑一类非光滑屈服函数，其在局部可以写成有限个光滑函数的逐点最大值，\n$$\nf(\\boldsymbol{\\sigma})=\\max_{i\\in\\{1,\\dots,m\\}}\\left\\{f_{i}(\\boldsymbol{\\sigma})\\right\\},\\quad \\text{with } f_{i}(\\boldsymbol{\\sigma})=\\boldsymbol{n}_{i}:\\boldsymbol{\\sigma}-k_{i},\n$$\n其中每个 $\\boldsymbol{n}_{i}$ 是应力空间中的一个恒定单位张量，而 $k_{i}$ 是常数。这种构造代表了沿棱和角点相交的相邻平面屈服面，如同 Mohr–Coulomb 型准则。令 $\\mathcal{E}=\\{\\boldsymbol{\\sigma}\\,:\\,f(\\boldsymbol{\\sigma})\\le 0\\}$ 表示弹性域。\n\n一个标准的增量返回映射步始于一个应变增量，该增量产生一个弹性预测（试探）应力 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}=\\mathbb{C}:(\\boldsymbol{\\varepsilon}_{n+1}-\\boldsymbol{\\varepsilon}^{p}_{n})$。如果 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}\\notin \\mathcal{E}$，则应用塑性修正以获得满足 Karush–Kuhn–Tucker 条件和相关联流动法则的 $\\boldsymbol{\\sigma}_{n+1}\\in \\partial \\mathcal{E}$。对于光滑的 $f$，通常使用沿外法线 $\\nabla f(\\boldsymbol{\\sigma}_{n+1})$ 的“径向返回”更新。\n\n在当前的非光滑情况下，假设 $\\boldsymbol{\\sigma}_{n+1}$ 位于 $\\partial \\mathcal{E}$ 的棱或角点上，那里至少有两个面同时被激活，即存在一个非空激活集 $\\mathcal{A}\\subset\\{1,\\dots,m\\}$，其 $|\\mathcal{A}|\\ge 2$，使得对于所有的 $i\\in \\mathcal{A}$ 都有 $f_{i}(\\boldsymbol{\\sigma}_{n+1})=0$。从上述基本原理（能量、屈服容许性、相关联法向性以及在弹性度量下的约束最近点投影）出发，推断这种非光滑性对返回映射算法的影响。\n\n下列陈述中哪些是正确的？选择所有适用的选项。\n\nA. 在 $|\\mathcal{A}|\\ge 2$ 的棱和角点处，$f(\\boldsymbol{\\sigma})=0$ 的法线是集值的，由激活面法线的凸包给出，因此纯粹的单方向径向返回不是适定的。正确的塑性修正可以表述为在 $\\mathbb{C}^{-1}$ 度量下的最近点投影，并采用激活集或次微分处理，从而得到外法线的组合和多个塑性乘子。\n\nB. 在偏应力空间中构造的径向返回总能找到能量上最近的容许应力，即使在角点和棱上也是如此，因此单面算法无需修改仍然有效。\n\nC. 角点处法线的不唯一性仅仅是一个数值假象；通过充分减小时间步长并强制执行对称一致性切线，可以恢复唯一的法线方向，无需进行特殊的算法更改。\n\nD. 由于相邻面在角点处共享相同的外法线，因此可以任意选择任何一个相邻面的法线作为返回方向；最终修正后的应力和一致性切线与此任意选择无关。\n\nE. 对显式非光滑处理的一种替代方法是通过平滑角点来正则化 $f$（例如，用光滑近似替换逐点最大值）。这使得单方向返回成为可能，但代价是改变了本构响应；在正则化参数趋于零的极限情况下，平滑算法接近非光滑解，并且必须根据所选的平滑方法进行一致的重新线性化。", "solution": "对问题陈述进行验证。\n\n步骤 1：提取已知条件\n- 弹性自由能: $\\psi(\\boldsymbol{\\varepsilon},\\boldsymbol{\\varepsilon}^{p})=\\tfrac{1}{2}\\,(\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^{p}):\\mathbb{C}:(\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^{p})$。\n- 柯西应力: $\\boldsymbol{\\sigma}=\\mathbb{C}:(\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^{p})$。\n- 屈服条件: $f(\\boldsymbol{\\sigma})\\le 0$。\n- 流动法则: $\\dot{\\boldsymbol{\\varepsilon}}^{p}=\\dot{\\lambda}\\,\\partial f(\\boldsymbol{\\sigma})$ (相关联)。\n- 非光滑屈服函数: $f(\\boldsymbol{\\sigma})=\\max_{i\\in\\{1,\\dots,m\\}}\\left\\{f_{i}(\\boldsymbol{\\sigma})\\right\\}$, with $f_{i}(\\boldsymbol{\\sigma})=\\boldsymbol{n}_{i}:\\boldsymbol{\\sigma}-k_{i}$。\n- 弹性域: $\\mathcal{E}=\\{\\boldsymbol{\\sigma}\\,:\\,f(\\boldsymbol{\\sigma})\\le 0\\}$。\n- 弹性预测应力: $\\boldsymbol{\\sigma}^{\\mathrm{tr}}=\\mathbb{C}:(\\boldsymbol{\\varepsilon}_{n+1}-\\boldsymbol{\\varepsilon}^{p}_{n})$。\n- 非光滑条件: 最终应力 $\\boldsymbol{\\sigma}_{n+1}$ 位于棱或角点上，意味着对于激活集 $\\mathcal{A}$（基数 $|\\mathcal{A}|\\ge 2$）中所有的 $i$，有 $f_{i}(\\boldsymbol{\\sigma}_{n+1})=0$。\n\n步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了率无关、小应变弹塑性力学的标准框架。使用最大值类型的凸非光滑屈服面是土壤、岩石或混凝土等材料的经典表示方法（例如 Mohr-Coulomb、Drucker-Prager）。相关联流动、返回映射和次微分等概念是现代计算塑性力学的核心。所有前提都是合理的。\n- **适定性**：该问题是适定的。它要求在特定的、明确定义的数学条件下对返回映射算法进行正确描述。其底层的变分结构保证了应力更新的唯一解。\n- **客观性**：语言清晰、精确，没有主观性。所有术语都是固体力学领域的标准术语。\n\n步骤 3：结论和行动\n问题陈述是有效的。这是一个关于计算固体力学中一个基本主题的适定的、有科学依据的问题。将推导解答。\n\n相关联塑性中返回映射算法的核心是最大塑性耗散原理。对于率无关固体，这等价于陈述：更新后的应力状态 $\\boldsymbol{\\sigma}_{n+1}$ 是试探应力状态 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 在容许弹性域 $\\mathcal{E}$ 上的最近点，其中“接近度”由逆弹性张量 $\\mathbb{C}^{-1}$ 定义的能量度量来衡量。这是一个约束优化问题：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\arg \\min_{\\boldsymbol{\\tau} \\in \\mathcal{E}} \\left\\{ \\frac{1}{2} (\\boldsymbol{\\sigma}^{\\text{tr}} - \\boldsymbol{\\tau}) : \\mathbb{C}^{-1} : (\\boldsymbol{\\sigma}^{\\text{tr}} - \\boldsymbol{\\tau}) \\right\\}\n$$\n该问题的解由 Karush-Kuhn-Tucker (KKT) 条件刻画。对于一个一般凸屈服函数 $f$，这些条件要求塑性应变增量 $\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{\\varepsilon}^p_{n+1} - \\boldsymbolvarepsilon^p_n$ 在 $\\boldsymbol{\\sigma}_{n+1}$ 处与屈服面正交。由于 $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\text{tr}} - \\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon}^p$，这等价于陈述：返回路径 $(\\boldsymbol{\\sigma}^{\\text{tr}} - \\boldsymbol{\\sigma}_{n+1})$ 与 $\\mathbb{C}:\\boldsymbol{N}$ 共线，其中 $\\boldsymbol{N}$ 是外法线。\n\n在光滑屈服面的情况下，法线 $\\boldsymbol{N} = \\nabla f(\\boldsymbol{\\sigma}_{n+1})$ 是唯一的，离散化的流动法则是 $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\lambda \\, \\nabla f(\\boldsymbol{\\sigma}_{n+1})$，其中 $\\Delta\\lambda \\ge 0$ 是单个标量塑性乘子。\n\n然而，问题指定了一个非光滑屈服函数 $f(\\boldsymbol{\\sigma}) = \\max_{i \\in \\{1,\\dots,m\\}} \\{f_i(\\boldsymbol{\\sigma})\\}$。该函数是凸的，但在多个函数 $f_i$ 同时激活的点（即在棱和角点处）不可微。在这些点上，梯度的概念被凸分析中的次微分所取代，记为 $\\partial f(\\boldsymbol{\\sigma})$。对于给定形式的 $f$，在应力状态 $\\boldsymbol{\\sigma}$ 下的次微分是激活函数梯度的凸包：\n$$\n\\partial f(\\boldsymbol{\\sigma}) = \\text{Co} \\left\\{ \\nabla f_i(\\boldsymbol{\\sigma}) \\mid i \\in \\mathcal{A}(\\boldsymbol{\\sigma}) \\right\\} = \\text{Co} \\left\\{ \\boldsymbol{n}_i \\mid i \\in \\mathcal A(\\boldsymbol{\\sigma}) \\right\\}\n$$\n其中 $\\mathcal{A}(\\boldsymbol{\\sigma}) = \\{i \\mid f_i(\\boldsymbol{\\sigma}) = f(\\boldsymbol{\\sigma})\\}$。如果 $|\\mathcal{A}| \\ge 2$，这是一个向量集合，而不是单个向量。相关联流动法则推广为流动包含关系：\n$$\n\\dot{\\boldsymbol{\\varepsilon}}^p \\in \\dot{\\lambda} \\, \\partial f(\\boldsymbol{\\sigma})\n$$\n通过时间积分，这意味着塑性应变增量必须是激活面法线的非负线性组合：\n$$\n\\Delta\\boldsymbol{\\varepsilon}^p = \\sum_{i \\in \\mathcal{A}} \\Delta\\lambda_i \\, \\boldsymbol{n}_i\n$$\n其中 $\\Delta\\lambda_i \\ge 0$ 是每个激活面 $i \\in \\mathcal{A}$ 的独立塑性乘子。返回映射算法必须通过对所有 $i \\in \\mathcal{A}$ 强制执行条件 $f_i(\\boldsymbol{\\sigma}_{n+1}) = 0$ 来求解这些乘子。这通常需要一种激活集策略。\n\n基于此框架，我们评估所提供的选项。\n\nA. 在 $|\\mathcal{A}|\\ge 2$ 的棱和角点处，$f(\\boldsymbol{\\sigma})=0$ 的法线是集值的，由激活面法线的凸包给出，因此纯粹的单方向径向返回不是适定的。正确的塑性修正可以表述为在 $\\mathbb{C}^{-1}$ 度量下的最近点投影，并采用激活集或次微分处理，从而得到外法线的组合和多个塑性乘子。\n\n该陈述是对非光滑塑性力学最新研究成果的精确和正确的总结。法线确实是集值的，并由次微分给出，即激活面法线 $\\boldsymbol{n}_i$ 的凸包。单方向返回是不适定的，因为方向不唯一。将其表述为最近点投影是基本的变分基础。算法解涉及找到法线的正确组合 $\\sum_i \\Delta\\lambda_i \\boldsymbol{n}_i$，这通常通过激活集方法来确定乘子 $\\Delta\\lambda_i$ 来完成。\n**结论：正确。**\n\nB. 在偏应力空间中构造的径向返回总能找到能量上最近的容许应力，即使在角点和棱上也是如此，因此单面算法无需修改仍然有效。\n\n这是不正确的。偏应力空间中的径向返回是 J2 (von Mises) 塑性理论的一个特有特征，其屈服面在偏应力平面上是一个圆。这里的问题考虑了一般的非光滑曲面，如 Tresca 六边形或 Mohr-Coulomb 曲面，对于这些曲面，从试探应力到曲面上某一点的简单径向返回通常不是最近点投影，特别是当返回到角点时。返回的方向由最小化原理决定，而不是由预先确定的几何构造决定。声称单面算法无需修改仍然有效是根本错误的；角点的存在需要更复杂的多面或基于次梯度的算法。\n**结论：不正确。**\n\nC. 角点处法线的不唯一性仅仅是一个数值假象；通过充分减小时间步长并强制执行对称一致性切线，可以恢复唯一的法线方向，无需进行特殊的算法更改。\n\n这是完全不正确的。屈服面在角点处的不可微性是所选本构模型固有的数学属性，而不是数值假象。减小时间步长 $\\Delta t$ 并不能平滑一个不可微点；它只会使试探应力更接近屈服面。如果物理应力路径穿过一个角点，那么对于任何足够小的步长，返回映射仍将涉及对角点的处理。法线的不唯一性是根本性的，需要特殊的算法更改，如选项A中所述。强制执行切线对称性是正确的、基于势的算法的结果，而不是规避非光滑性的一种手段。\n**结论：不正确。**\n\nD. 由于相邻面在角点处共享相同的外法线，因此可以任意选择任何一个相邻面的法线作为返回方向；最终修正后的应力和一致性切线与此任意选择无关。\n\n该陈述基于一个错误的前提。根据定义，相邻面具有*不同*的外法线 $\\{\\boldsymbol{n}_i\\}$。正是这种差异产生了棱或角点。角点处可能的法线方向集是由这些不同法线的凸组合形成的锥。任意选择其中一个法线作为返回方向，通常会导致一个不正确的最终应力，该应力不是最近点投影，并且可能违反其他激活面的屈服条件。最终的应力和切线将高度依赖于这个任意且不正确的选择。\n**结论：不正确。**\n\nE. 对显式非光滑处理的一种替代方法是通过平滑角点来正则化 $f$（例如，用光滑近似替换逐点最大值）。这使得单方向返回成为可能，但代价是改变了本构响应；在正则化参数趋于零的极限情况下，平滑算法接近非光滑解，并且必须根据所选的平滑方法进行一致的重新线性化。\n\n该陈述描述了一种有效且广泛使用的替代方法。正则化（或平滑化）将非光滑的 $f$ 替换为一个近似它的光滑函数 $f_{\\epsilon}$。例如，$\\max$ 函数可以被对数-和-指数（log-sum-exp）函数或 p-范数函数近似。这个正则化曲面 $f_{\\epsilon}=0$ 处处具有唯一的法线，因此可以应用标准的单面返回映射算法。这样做的代价是稍微修改了材料的本构定律。当正则化参数 $\\epsilon \\to 0$ 时，平滑模型的响应接近非光滑模型的响应，尽管这种极限情况可能会引入数值刚度。为了使全局 Newton-Raphson 格式二次收敛，一致性切线算子必须从算法中实际使用的平滑函数 $f_{\\epsilon}$ 推导出来，这一点至关重要。\n**结论：正确。**", "answer": "$$\\boxed{AE}$$", "id": "2678260"}, {"introduction": "在建立了理论理解并实现算法之后，验证其正确性至关重要。[@problem_id:2678252] 本练习将指导您完成为径向返回算法设计和执行单元测试的过程，其中使用经典的加载路径。通过将代码输出与单轴拉伸和纯剪切等简单情况的闭式解析解或半解析解进行比较，您可以建立对实现准确性的信心，并培养验证和确认这一关键的工程技能。", "problem": "一个采用 von Mises ($J_2$) 屈服准则和线性各向同性硬化的小应变各向同性弹塑性本构模型，在应力空间中使用偏应力径向返回映射算法来实现。材料参数为：杨氏模量 $E = 210\\,\\mathrm{GPa}$，泊松比 $\\nu = 0.3$，初始屈服应力 $\\sigma_{y0} = 250\\,\\mathrm{MPa}$，以及线性各向同性硬化模量 $H = 1\\,\\mathrm{GPa}$。初始状态为无应力、零塑性应变和零硬化变量。要求您基于第一性原理，设计一个最小且充分的单元测试套件，以验证径向返回映射在以下典型载荷下的应力更新和内变量更新：单轴拉伸、纯剪切以及平面应力下的等双轴面内加载。测试必须指明加载条件、试探弹性响应、屈服检查、精确的塑性修正和预期的闭式解更新应力，以及至少一个用于区分正确与错误实现的算法切线或不变性检查。\n\n哪个选项提出了这样一套正确且完全自洽的单元测试及其预期的闭式解响应？\n\nA. 单轴拉伸：给定总轴向应变 $\\varepsilon_{11} = 0.003$，所有其他应变分量为零。弹性预测器给出的试探轴向应力为 $\\sigma^{\\mathrm{tr}} = E\\,\\varepsilon_{11} = 0.630\\,\\mathrm{GPa}$，试探等效应力为 $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = 0.630\\,\\mathrm{GPa}$。剪切模量 $G = \\dfrac{E}{2(1+\\nu)} = 80.769\\,\\mathrm{GPa}$ 且 $3G + H = 243.307\\,\\mathrm{GPa}$，试探屈服函数为 $f^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_{y0} = 0.380\\,\\mathrm{GPa} > 0$，因此发生塑性修正。带有线性硬化的径向返回算法给出的塑性乘子增量为 $\\Delta \\gamma = \\dfrac{f^{\\mathrm{tr}}}{3G + H} = 0.0015619$，更新后的等效应力为 $\\sigma_{\\mathrm{eq}}^{n+1} = \\sigma_{y0} + H\\,\\Delta \\gamma = 0.2515619\\,\\mathrm{GPa}$。由于是单轴状态，更新后的轴向应力为 $\\sigma_{11}^{n+1} = 0.251562\\,\\mathrm{GPa}$。单调塑性流动下的斜率检查给出的单轴弹塑性切线模量为 $E_{\\mathrm{ep}} = \\dfrac{E\\,H}{E + H} = 0.99526\\,\\mathrm{GPa}$。纯剪切：给定工程剪应变 $\\gamma_{12} = 0.01$ (因此小应变张量分量为 $\\varepsilon_{12} = \\gamma_{12}/2$)。弹性预测器得出试探剪应力 $\\tau^{\\mathrm{tr}} = G\\,\\gamma_{12} = 0.80769\\,\\mathrm{GPa}$ 和试探等效应力 $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{3}\\,\\tau^{\\mathrm{tr}} = 1.3987\\,\\mathrm{GPa}$。于是 $f^{\\mathrm{tr}} = 1.1487\\,\\mathrm{GPa}$，$\\Delta \\gamma = \\dfrac{1.1487}{243.307} = 0.0047219$，$\\sigma_{\\mathrm{eq}}^{n+1} = 0.250 + 0.0047219 = 0.2547219\\,\\mathrm{GPa}$，以及 $\\tau^{n+1} = \\sigma_{\\mathrm{eq}}^{n+1}/\\sqrt{3} = 0.147054\\,\\mathrm{GPa}$。偏应力方向与试探剪切方向保持一致，静水应力保持为零。平面应力下的等双轴面内加载：给定相等的面内应变 $\\varepsilon_{11} = \\varepsilon_{22} = 0.0015$，并强制平面应力条件 $\\sigma_{33} = 0$。弹性平面应力预测器给出两个面内方向的试探应力为 $\\sigma^{\\mathrm{tr}} = \\dfrac{E}{1-\\nu}\\,\\varepsilon_{11} = 0.450\\,\\mathrm{GPa}$，试探等效应力为 $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sigma^{\\mathrm{tr}} = 0.450\\,\\mathrm{GPa}$。于是 $f^{\\mathrm{tr}} = 0.200\\,\\mathrm{GPa}$，$\\Delta \\gamma = \\dfrac{0.200}{243.307} = 0.00082234$，以及 $\\sigma_{\\mathrm{eq}}^{n+1} = 0.25082234\\,\\mathrm{GPa}$。对于平面应力等双轴状态，$\\sigma_{\\mathrm{eq}} = \\sigma$，因此 $\\sigma_{11}^{n+1} = \\sigma_{22}^{n+1} = 0.250822\\,\\mathrm{GPa}$ 且 $\\sigma_{33}^{n+1} = 0$。在所有三个测试中，等效塑性应变增量等于 $\\Delta \\gamma$，这必须通过内变量更新来验证。\n\nB. 单轴拉伸：给定 $\\varepsilon_{11} = 0.003$；使用塑性乘子增量 $\\Delta \\gamma = \\dfrac{f^{\\mathrm{tr}}}{2G + H}$，因此 $\\Delta \\gamma = \\dfrac{0.380}{163.538} = 0.002324$ 且 $\\sigma_{11}^{n+1} = 0.252324\\,\\mathrm{GPa}$。屈服后斜率取为 $E_{\\mathrm{ep}} = H$。纯剪切：取 von Mises 剪切屈服应力为 $\\tau_{y} = \\sigma_{y0}/2 = 125\\,\\mathrm{MPa}$，并使用 $\\sigma_{\\mathrm{eq}} = 2\\,\\tau$ 进行返回映射，对于 $\\gamma_{12} = 0.01$ 给出修正后的 $\\tau^{n+1} = 0.125\\,\\mathrm{GPa}$。等双轴面内加载：对于平面应力下 $\\varepsilon_{11} = \\varepsilon_{22} = 0.0015$ 的情况，假设 $\\sigma_{\\mathrm{eq}} = \\sqrt{2}\\,\\sigma$，因此返回后的修正面内应力为 $\\sigma_{11}^{n+1} = \\sigma_{22}^{n+1} = \\sigma_{\\mathrm{eq}}^{n+1}/\\sqrt{2} = 0.1773\\,\\mathrm{GPa}$。\n\nC. 单轴拉伸：给定 $\\varepsilon_{11} = 0.003$，并在屈服后通过分段双线性关系 $\\sigma_{11}^{n+1} = \\sigma_{y0} + H(\\varepsilon_{11} - \\sigma_{y0}/E)$ 更新应力，得出 $\\sigma_{11}^{n+1} = 0.2518095\\,\\mathrm{GPa}$，并取 $E_{\\mathrm{ep}} = H$。纯剪切：取 $\\sigma_{\\mathrm{eq}} = 2\\,\\tau$ 且剪切屈服应力为 $\\tau_{y} = \\sigma_{y0}/\\sqrt{2}$；对于 $\\gamma_{12} = 0.01$，修正后的 $\\tau^{n+1} = 0.125\\,\\mathrm{GPa}$。平面应力下的等双轴面内加载：使用预测器 $\\sigma^{\\mathrm{tr}} = \\dfrac{E}{1+\\nu}\\,\\varepsilon$，因此对于 $\\varepsilon_{11} = \\varepsilon_{22} = 0.0015$，有 $\\sigma^{\\mathrm{tr}} = 0.2423\\,\\mathrm{GPa} < \\sigma_{y0}$，响应为弹性，且 $\\sigma_{11}^{n+1} = \\sigma_{22}^{n+1} = 0.2423\\,\\mathrm{GPa}$。\n\nD. 单轴拉伸：给定 $\\varepsilon_{11} = 0.003$，并使用基于体积模量 $K$ 的静水返回映射，塑性乘子增量为 $\\Delta \\gamma = \\dfrac{f^{\\mathrm{tr}}}{3K + H}$，更新后的应力为 $\\sigma_{11}^{n+1} = 0.2516\\,\\mathrm{GPa}$。纯剪切：通过施加静水应变 $\\varepsilon_{11} = \\varepsilon_{22} = \\varepsilon_{33} = 0.002$ 来检查静水不变性；预期当静水压力超过 $\\sigma_{y0}$ 时会发生屈服，并通过塑性修正来减小压力。等双轴面内加载：对于 $\\varepsilon_{11} = \\varepsilon_{22} = 0.0015$，假设 $\\sigma_{\\mathrm{eq}} = \\sqrt{2}\\,\\sigma$ 并用 $\\Delta \\gamma = \\dfrac{f^{\\mathrm{tr}}}{2G + H}$ 进行更新，得到 $\\sigma_{11}^{n+1} = 0.180\\,\\mathrm{GPa}$。\n\n选择正确的选项。", "solution": "该问题要求为使用偏应力径向返回映射算法实现的、具有线性硬化的小应变各向同性 J2 弹塑性模型，找出一组正确且自洽的单元测试。这些测试涵盖单轴拉伸、纯剪切和等双轴平面应力加载。\n\n首先，我将验证问题陈述本身。\n\n### 步骤1：提取给定条件\n-   **本构模型**：小应变各向同性弹塑性，von Mises ($J_2$) 屈服，线性各向同性硬化。\n-   **算法**：应力空间中的偏应力径向返回映射。\n-   **材料参数**：\n    -   杨氏模量：$E = 210\\,\\mathrm{GPa}$\n    -   泊松比：$\\nu = 0.3$\n    -   初始屈服应力：$\\sigma_{y0} = 250\\,\\mathrm{MPa} = 0.250\\,\\mathrm{GPa}$\n    -   线性各向同性硬化模量：$H = 1\\,\\mathrm{GPa}$\n-   **初始状态**：无应力 ($\\boldsymbol{\\sigma}^n = \\mathbf{0}$)，零塑性应变 ($\\boldsymbol{\\varepsilon}_p^n = \\mathbf{0}$)，零硬化 ($\\alpha^n = 0$)。\n-   **任务**：为三种特定加载验证一个单元测试套件，包括加载定义、试探响应、屈服检查、带闭式解结果的塑性修正，以及一个额外的检查（切线或不变性）。\n\n### 步骤2：使用提取的给定条件进行验证\n该问题在计算塑性力学的标准框架内定义明确。材料模型、参数和数值算法在固体力学领域都是标准的。材料属性对于钢是符合实际的。所要求的测试案例是典型的，可以作为极好的验证问题。该问题具有科学依据，是适定的，并且是客观的。它为推导每个测试案例的唯一解提供了所有必要信息。\n\n### 步骤3：结论和行动\n问题陈述是有效的。我现在将开始推导解答并评估每个选项。\n\n### 理论框架\n\n该算法的核心在于一个弹性预测步骤，如果试探应力位于屈服面之外，则随后进行塑性修正。\n\n1.  **弹性常数**：\n    -   剪切模量：$G = \\dfrac{E}{2(1+\\nu)} = \\dfrac{210\\,\\mathrm{GPa}}{2(1+0.3)} = \\dfrac{210}{2.6} \\approx 80.76923\\,\\mathrm{GPa}$。\n    -   体积模量：$K = \\dfrac{E}{3(1-2\\nu)} = \\dfrac{210\\,\\mathrm{GPa}}{3(1-0.6)} = \\dfrac{210}{1.2} = 175\\,\\mathrm{GPa}$。\n\n2.  **径向返回算法**：\n    -   **试探应力**：$\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbf{C} : (\\boldsymbol{\\varepsilon}^{n+1} - \\boldsymbol{\\varepsilon}_p^n)$。从无应力状态开始，$\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbf{C} : \\Delta\\boldsymbol{\\varepsilon}$。\n    -   **屈服检查**：计算试探等效应力 $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2}\\mathbf{s}^{\\mathrm{tr}}:\\mathbf{s}^{\\mathrm{tr}}}$，其中 $\\mathbf{s}^{\\mathrm{tr}}$ 是 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ 的偏量部分。屈服函数为 $f^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_y(\\alpha^n)$。如果 $f^{\\mathrm{tr}} > 0$，则发生塑性流动。\n    -   **塑性修正**：如果发生屈服，则计算塑性乘子增量 $\\Delta \\gamma$。对于线性各向同性硬化，它由下式给出：\n        $$ \\Delta\\gamma = \\dfrac{f^{\\mathrm{tr}}}{3G+H} $$\n    -   更新后的等效应力为：\n        $$ \\sigma_{\\mathrm{eq}}^{n+1} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - 3G\\Delta\\gamma = \\sigma_y(\\alpha^n) + H\\Delta\\gamma $$\n    -   更新后的偏应力被径向返回到新的屈服面上：\n        $$ \\mathbf{s}^{n+1} = \\dfrac{\\sigma_{\\mathrm{eq}}^{n+1}}{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}} \\mathbf{s}^{\\mathrm{tr}} $$\n    -   对于 J2 塑性，静水应力保持不变：$\\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}^{n+1}) = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}^{\\mathrm{tr}})$。\n    -   更新后的各向同性硬化变量（等效塑性应变）为 $\\alpha^{n+1} = \\alpha^n + \\Delta\\gamma$。\n\n现在，我们来分析每个选项中提出的测试。\n\n### 选项 A 的分析\n\n该选项提出了三个测试。我们来逐一验证。\n\n**1. 单轴拉伸：**\n-   **加载**：“给定总轴向应变 $\\varepsilon_{11} = 0.003$ 且所有其他应变分量为零”。这定义了一个单轴应变状态。\n-   **弹性预测器**：该选项计算的试探应力为 $\\sigma^{\\mathrm{tr}} = E\\,\\varepsilon_{11} = 210\\,\\mathrm{GPa} \\times 0.003 = 0.630\\,\\mathrm{GPa}$。这是单轴应力状态的正确应力，而非所给定的单轴应变状态。这是一个轻微的不一致之处，但我们可将其理解为一种简化的测试设置，即假设试探应力为单轴状态 $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathrm{diag}(0.630, 0, 0)\\,\\mathrm{GPa}$。对于单轴应力，$\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = |\\sigma_{11}^{\\mathrm{tr}}| = 0.630\\,\\mathrm{GPa}$。这与该选项相符。\n-   **屈服检查**：当 $\\sigma_{y0} = 0.250\\,\\mathrm{GPa}$ 时，试探屈服函数为 $f^{\\mathrm{tr}} = 0.630 - 0.250 = 0.380\\,\\mathrm{GPa}$。由于 $f^{\\mathrm{tr}} > 0$，需要进行塑性修正。这是正确的。\n-   **塑性修正**：\n    -   模量项为 $3G + H = 3 \\times 80.76923... + 1 = 242.30769 + 1 = 243.30769\\,\\mathrm{GPa}$。该值是正确的。\n    -   塑性乘子为 $\\Delta\\gamma = \\dfrac{f^{\\mathrm{tr}}}{3G+H} = \\dfrac{0.380\\,\\mathrm{GPa}}{243.307\\,\\mathrm{GPa}} \\approx 0.0015619$。此计算是正确的。\n    -   更新后的等效应力为 $\\sigma_{\\mathrm{eq}}^{n+1} = \\sigma_{y0} + H\\Delta\\gamma = 0.250\\,\\mathrm{GPa} + 1\\,\\mathrm{GPa} \\times 0.0015619 = 0.2515619\\,\\mathrm{GPa}$。这是正确的。\n    -   该选项随后声称：“由于是单轴状态，更新后的轴向应力为 $\\sigma_{11}^{n+1} = 0.251562\\,\\mathrm{GPa}$”。这在单轴应力假设下是正确的，因为此时 $\\sigma_{11} = \\sigma_{eq}$。\n    -   $E_{\\mathrm{ep}} = \\dfrac{E\\,H}{E + H} = \\dfrac{210 \\times 1}{210+1} \\approx 0.99526\\,\\mathrm{GPa}$。这是一维单轴模型的正确弹塑性切线模量，作为参照是合理的。\n\n**2. 纯剪切：**\n-   **加载**：$\\gamma_{12} = 0.01$，因此张量应变为 $\\varepsilon_{12} = 0.005$。\n-   **弹性预测器**：试探剪应力 $\\tau^{\\mathrm{tr}} = \\sigma_{12}^{\\mathrm{tr}} = G\\gamma_{12} = 80.769\\,\\mathrm{GPa} \\times 0.01 = 0.80769\\,\\mathrm{GPa}$。对于纯剪切，$\\sigma_{\\mathrm{eq}} = \\sqrt{3}\\tau$。因此 $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{3} \\times 0.80769 \\approx 1.3987\\,\\mathrm{GPa}$。这是正确的。\n-   **屈服检查**：$f^{\\mathrm{tr}} = 1.3987 - 0.250 = 1.1487\\,\\mathrm{GPa} > 0$。这是正确的。\n-   **塑性修正**：\n    -   $\\Delta\\gamma = \\dfrac{1.1487\\,\\mathrm{GPa}}{243.307\\,\\mathrm{GPa}} \\approx 0.0047219$。正确。\n    -   $\\sigma_{\\mathrm{eq}}^{n+1} = 0.250\\,\\mathrm{GPa} + 1\\,\\mathrm{GPa} \\times 0.0047219 = 0.2547219\\,\\mathrm{GPa}$。正确。\n    -   更新后的剪应力必须满足 $\\sigma_{\\mathrm{eq}}^{n+1} = \\sqrt{3} \\tau^{n+1}$。因此，$\\tau^{n+1} = \\dfrac{\\sigma_{\\mathrm{eq}}^{n+1}}{\\sqrt{3}} = \\dfrac{0.2547219}{\\sqrt{3}} \\approx 0.147054\\,\\mathrm{GPa}$。正确。\n-   这个测试案例是正确且自洽的。\n\n**3. 平面应力下的等双轴面内加载：**\n-   **加载**：$\\varepsilon_{11} = \\varepsilon_{22} = 0.0015$，且 $\\sigma_{33} = 0$。\n-   **弹性预测器**：对于弹性平面应力，当 $\\varepsilon_{11}=\\varepsilon_{22}=\\varepsilon$ 时，面内应力为 $\\sigma_{11}=\\sigma_{22}=\\dfrac{E}{1-\\nu}\\varepsilon = \\dfrac{210}{0.7} \\times 0.0015 = 0.450\\,\\mathrm{GPa}$。这是正确的。\n-   对于这种应力状态（$\\sigma_{11}=\\sigma_{22}=\\sigma$, $\\sigma_{33}=0$），等效应力为 $\\sigma_{\\mathrm{eq}} = \\sigma$。因此 $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = 0.450\\,\\mathrm{GPa}$。正确。\n-   **屈服检查**：$f^{\\mathrm{tr}} = 0.450 - 0.250 = 0.200\\,\\mathrm{GPa} > 0$。正确。\n-   **塑性修正**：\n    -   使用通用公式：$\\Delta\\gamma = \\dfrac{0.200\\,\\mathrm{GPa}}{243.307\\,\\mathrm{GPa}} \\approx 0.0008220$。该选项的值 $0.00082234$ 略有差异，可能是由于舍入。\n    -   使用该选项的 $\\Delta\\gamma$，$\\sigma_{\\mathrm{eq}}^{n+1} = 0.250 + 1 \\times 0.00082234 = 0.25082234\\,\\mathrm{GPa}$。根据给定的 $\\Delta\\gamma$ 计算是正确的。\n    -   该选项随后声称 $\\sigma_{11}^{n+1} = \\sigma_{22}^{n+1} = \\sigma_{\\mathrm{eq}}^{n+1}$。如前所述，这对于等双轴平面应力状态是成立的。\n-   这个测试案例在很大程度上是正确的。\n\n**对A的判决**：选项A中的所有计算都遵循了正确的J2塑性理论和径向返回算法。它是自洽的，并且是唯一一个在物理和数学上都正确的选项。\n\n### 选项 B, C, D 的分析\n-   **选项 B**：使用错误的分母 $2G+H$。对剪切屈服使用 Tresca 准则的定义 ($\\tau_y = \\sigma_{y0}/2$) 而非 von Mises 准则 ($\\tau_y = \\sigma_{y0}/\\sqrt{3}$)。对等双轴应力使用错误的等效应力公式。根本性错误。\n-   **选项 C**：使用量纲不一致的单轴关系式。对剪切屈服使用错误的定义。对等双轴加载使用错误的弹性预测器。根本性错误。\n-   **选项 D**：将 J2 塑性与静水压力错误地联系起来，这与 J2 理论的基础相悖。根本性错误。\n\n### 结论\n\n选项 B、C 和 D 在塑性理论上包含严重、根本性的错误。选项 A 尽管在其单轴拉伸测试的描述中存在轻微的不一致，但其所有计算和物理原理都是正确的，并准确反映了J2径向返回算法在这些经典载荷下的响应。因此，选项 A 是唯一正确的选择。", "answer": "$$\\boxed{A}$$", "id": "2678252"}]}