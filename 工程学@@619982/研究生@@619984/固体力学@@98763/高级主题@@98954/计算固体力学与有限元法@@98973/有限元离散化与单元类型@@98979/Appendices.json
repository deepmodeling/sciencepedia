{"hands_on_practices": [{"introduction": "常应变三角形（T3）单元是二维有限元分析中最基础的构件。本练习将引导你从第一性原理出发，推导其核心的应变-位移矩阵（$\\mathbf{B}$ 矩阵）。掌握这一推导过程对于理解连续介质力学原理如何被离散化为有限元格式至关重要，同时也能让你深刻体会该单元的能力与局限性，例如其在“patch test”中的表现。[@problem_id:2639920]", "problem": "考虑一个二维、小应变的线性弹性力学问题，使用基于位移的有限元法 (FEM) 对一个具有直边的三节点三角形单元进行离散化。设该三角形的物理坐标为：节点 $1$ 位于 $(0,0)$，节点 $2$ 位于 $(4,0)$，节点 $3$ 位于 $(1,3)$，所有坐标单位均为 $\\mathrm{m}$。将节点位移向量记为\n$$\n\\mathbf{d}_{e}=\\begin{bmatrix}u_{1} & v_{1} & u_{2} & v_{2} & u_{3} & v_{3}\\end{bmatrix}^{\\mathsf{T}},\n$$\n其中 $u_{i}$ 和 $v_{i}$ 分别是节点 $i$ 处的笛卡尔位移分量。小应变张量定义为\n$$\n\\boldsymbol{\\varepsilon}=\\frac{1}{2}\\left(\\nabla \\mathbf{u} + \\left(\\nabla \\mathbf{u}\\right)^{\\mathsf{T}}\\right),\n$$\n且该单元在物理 $(x,y)$ 平面上采用线性形函数。\n\n任务：\n$1.$ 仅从小应变的运动学定义和使用单元形函数进行的位移线性插值出发，推导该三角形单元的应变-位移矩阵 $\\mathbf{B}$ 的显式表达式，使得 $\\boldsymbol{\\varepsilon}=\\mathbf{B}\\,\\mathbf{d}_{e}$。你的推导必须清楚地表明 $\\mathbf{B}$ 如何依赖于节点坐标。\n\n$2.$ 证明该单元产生的应变在整个单元域上是恒定的，并解释其几何原因。然后，利用多项式完备性和平衡论证，推断这对该单元在 Irons–Razzaque 斑块检验 (patch test) 中的性能意味着什么：精确说明何种阶次的位移场或应力场能被精确再现，而哪些不能。\n\n$3.$ 对于给定的三角形，定义标量\n$$\nS=\\|\\mathbf{B}\\|_{F}^{2}=\\sum_{i=1}^{3}\\sum_{j=1}^{6}\\left(B_{ij}\\right)^{2},\n$$\n即 $\\mathbf{B}$ 的弗罗贝尼乌斯范数的平方。精确计算 $S$。将 $S$ 的最终值以 $\\mathrm{m}^{-2}$ 表示，且不要四舍五入；提供一个精确值。\n\n答案规格：最终答案必须是一个实数（方框内的答案不带单位）。如果在计算过程中执行任何中间数值运算，请勿四舍五入；将精确算术运算进行到底。", "solution": "所述问题具有科学依据、是适定且客观的。这是固体力学有限元法研究中的一个标准问题，具体涉及三节点线性三角形单元（常被称为常应变三角形 (CST) 或 T3 单元）的性质。所有必要信息均已提供，且任务定义明确。因此，该问题是有效的，将在此提供解答。\n\n分析从基于位移的有限元列式的基本原理开始。\n\n**任务 1：应变-位移矩阵 $\\mathbf{B}$ 的推导**\n\n单元内的位移场 $\\mathbf{u}(x,y) = \\begin{pmatrix} u(x,y) & v(x,y) \\end{pmatrix}^{\\mathsf{T}}$ 是通过线性形函数 $N_i(x,y)$ 从节点位移 $\\mathbf{d}_e$ 插值得到的。\n$$\nu(x,y) = \\sum_{i=1}^{3} N_i(x,y) u_i\n$$\n$$\nv(x,y) = \\sum_{i=1}^{3} N_i(x,y) v_i\n$$\n这可以写成矩阵形式 $\\mathbf{u} = \\mathbf{N} \\mathbf{d}_e$，其中 $\\mathbf{N}$ 是形函数矩阵：\n$$\n\\mathbf{N} = \\begin{pmatrix} N_1 & 0 & N_2 & 0 & N_3 & 0 \\\\ 0 & N_1 & 0 & N_2 & 0 & N_3 \\end{pmatrix}\n$$\n节点 $i$ 的线性形函数具有形式 $N_i(x,y) = \\alpha_i + \\beta_i x + \\gamma_i y$。其系数由性质 $N_i(x_j, y_j) = \\delta_{ij}$ 决定，其中 $\\delta_{ij}$ 是克罗内克符号。存在一个形函数空间导数的直接公式，这对于推导应变-位移矩阵更为方便。这些导数依赖于节点坐标 $(x_i, y_i)$ 和单元面积 $A$。\n顶点为 $(x_1, y_1)$、$(x_2, y_2)$ 和 $(x_3, y_3)$ 的三角形面积 $A$ 由下式给出：\n$$\nA = \\frac{1}{2} \\det \\begin{pmatrix} 1 & x_1 & y_1 \\\\ 1 & x_2 & y_2 \\\\ 1 & x_3 & y_3 \\end{pmatrix} = \\frac{1}{2} \\left[ x_1(y_2 - y_3) + x_2(y_3 - y_1) + x_3(y_1 - y_2) \\right]\n$$\n形函数的空间导数是常数，并由下式给出：\n$$\n\\frac{\\partial N_i}{\\partial x} = \\beta_i = \\frac{1}{2A}(y_j - y_k)\n$$\n$$\n\\frac{\\partial N_i}{\\partial y} = \\gamma_i = \\frac{1}{2A}(x_k - x_j)\n$$\n其中下标 $(i, j, k)$ 是 $(1, 2, 3)$ 的循环置换。\n\n对于二维问题，采用 Voigt 记法的小应变张量分量为 $\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_{xx} & \\varepsilon_{yy} & \\gamma_{xy} \\end{pmatrix}^{\\mathsf{T}}$，其中 $\\varepsilon_{xx} = \\frac{\\partial u}{\\partial x}$，$\\varepsilon_{yy} = \\frac{\\partial v}{\\partial y}$，以及 $\\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}$。\n\n代入位移插值：\n$$\n\\varepsilon_{xx} = \\frac{\\partial}{\\partial x} \\sum_{i=1}^{3} N_i u_i = \\sum_{i=1}^{3} \\frac{\\partial N_i}{\\partial x} u_i = \\beta_1 u_1 + \\beta_2 u_2 + \\beta_3 u_3\n$$\n$$\n\\varepsilon_{yy} = \\frac{\\partial}{\\partial y} \\sum_{i=1}^{3} N_i v_i = \\sum_{i=1}^{3} \\frac{\\partial N_i}{\\partial y} v_i = \\gamma_1 v_1 + \\gamma_2 v_2 + \\gamma_3 v_3\n$$\n$$\n\\gamma_{xy} = \\frac{\\partial}{\\partial y} \\sum_{i=1}^{3} N_i u_i + \\frac{\\partial}{\\partial x} \\sum_{i=1}^{3} N_i v_i = \\sum_{i=1}^{3} \\left( \\frac{\\partial N_i}{\\partial y} u_i + \\frac{\\partial N_i}{\\partial x} v_i \\right) = \\sum_{i=1}^{3} (\\gamma_i u_i + \\beta_i v_i)\n$$\n我们将这些关系组合成矩阵方程 $\\boldsymbol{\\varepsilon} = \\mathbf{B} \\mathbf{d}_e$：\n$$\n\\begin{pmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\gamma_{xy} \\end{pmatrix} = \\begin{pmatrix}\n\\beta_1 & 0 & \\beta_2 & 0 & \\beta_3 & 0 \\\\\n0 & \\gamma_1 & 0 & \\gamma_2 & 0 & \\gamma_3 \\\\\n\\gamma_1 & \\beta_1 & \\gamma_2 & \\beta_2 & \\gamma_3 & \\beta_3\n\\end{pmatrix}\n\\begin{pmatrix} u_1 \\\\ v_1 \\\\ u_2 \\\\ v_2 \\\\ u_3 \\\\ v_3 \\end{pmatrix}\n$$\n因此，应变-位移矩阵 $\\mathbf{B}$ 为：\n$$\n\\mathbf{B} = \\begin{pmatrix}\n\\beta_1 & 0 & \\beta_2 & 0 & \\beta_3 & 0 \\\\\n0 & \\gamma_1 & 0 & \\gamma_2 & 0 & \\gamma_3 \\\\\n\\gamma_1 & \\beta_1 & \\gamma_2 & \\beta_2 & \\gamma_3 & \\beta_3\n\\end{pmatrix}\n$$\n代入 $\\beta_i$ 和 $\\gamma_i$ 的表达式，并定义 $y_{ij} = y_i - y_j$ 和 $x_{ij} = x_i - x_j$：\n$$\n\\mathbf{B} = \\frac{1}{2A} \\begin{pmatrix}\ny_{2}-y_{3} & 0 & y_{3}-y_{1} & 0 & y_{1}-y_{2} & 0 \\\\\n0 & x_{3}-x_{2} & 0 & x_{1}-x_{3} & 0 & x_{2}-x_{1} \\\\\nx_{3}-x_{2} & y_{2}-y_{3} & x_{1}-x_{3} & y_{3}-y_{1} & x_{2}-x_{1} & y_{1}-y_{2}\n\\end{pmatrix}\n$$\n该表达式明确地展示了 $\\mathbf{B}$ 如何依赖于节点坐标。\n\n**任务 2：常应变及斑块检验的意义**\n\n位移场是由空间坐标 $x$ 和 $y$ 的线性函数插值得到的。应变分量由位移分量的一阶空间导数定义。线性函数的导数是常数。因此，$\\varepsilon_{xx}$、$\\varepsilon_{yy}$ 和 $\\gamma_{xy}$ 在整个单元域上是常数。\n\n从几何角度看，线性形函数定义了一个从母单元（例如，参考 $(\\xi, \\eta)$ 坐标系中的一个直角三角形）到物理 $(x,y)$ 平面中物理单元的仿射映射。此映射的雅可比矩阵是常数。由于形函数相对于参考坐标的导数是常数，且雅可比矩阵也是常数，因此形函数相对于物理坐标的导数也是常数。这是 T3 单元具有常应变行为的根本原因。\n\n这一性质直接影响单元的性能，这一点可通过斑块检验来评估。斑块检验是收敛的必要条件。\nT3 单元形函数的多项式完备性意味着它可以精确表示任何在 $x$ 和 $y$ 上为线性多项式的位移场，即 $u(x,y)=a_0+a_1 x+a_2 y$ 和 $v(x,y)=b_0+b_1 x+b_2 y$。这样的位移场对应于一个常应变状态，其中 $\\varepsilon_{xx}=a_1$，$\\varepsilon_{yy}=b_2$，$\\gamma_{xy}=a_2+b_1$。对于均质线性弹性材料，常应变状态意味着常应力状态。在没有体力的情况下，常应力场 $\\boldsymbol{\\sigma}$ 平凡地满足平衡方程 $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$。因此，当在边界节点上施加适当的线性位移场时，一片 T3 单元可以精确再现一个常应力场。该单元通过了常应力斑块检验。\n\n然而，该单元无法精确表示更高阶的位移场。例如，一个会产生线性变化应变场（如纯弯曲中）的二次位移场无法被捕捉。该单元会用一个分段常数应变场来近似线性的应变场，这是一个较差的近似。因此，T3 单元未能通过线性应变场的斑块检验。\n总而言之，T3 单元能精确再现恒定的位移梯度，这对应于常应变和常应力场。它不能精确再现任何更高阶的场。\n\n**任务 3：$S = \\|\\mathbf{B}\\|_{F}^{2}$ 的计算**\n\n节点坐标给出为 $1: (0,0)$，$2: (4,0)$ 和 $3: (1,3)$，单位为米。\n首先，我们计算三角形的面积 $A$。\n$$\n2A = x_1(y_2 - y_3) + x_2(y_3 - y_1) + x_3(y_1 - y_2) = 0(0 - 3) + 4(3 - 0) + 1(0 - 0) = 12 \\, \\mathrm{m}^2\n$$\n所以，$A = 6 \\, \\mathrm{m}^2$。\n\n接下来，我们计算 $\\mathbf{B}$ 矩阵所需的坐标差：\n$y_{23} = y_2 - y_3 = 0 - 3 = -3$\n$y_{31} = y_3 - y_1 = 3 - 0 = 3$\n$y_{12} = y_1 - y_2 = 0 - 0 = 0$\n$x_{32} = x_3 - x_2 = 1 - 4 = -3$\n$x_{13} = x_1 - x_3 = 0 - 1 = -1$\n$x_{21} = x_2 - x_1 = 4 - 0 = 4$\n\n现在我们构造 $\\mathbf{B}$ 矩阵：\n$$\n\\mathbf{B} = \\frac{1}{2A} \\begin{pmatrix} y_{23} & 0 & y_{31} & 0 & y_{12} & 0 \\\\ 0 & x_{32} & 0 & x_{13} & 0 & x_{21} \\\\ x_{32} & y_{23} & x_{13} & y_{31} & x_{21} & y_{12} \\end{pmatrix} = \\frac{1}{12} \\begin{pmatrix} -3 & 0 & 3 & 0 & 0 & 0 \\\\ 0 & -3 & 0 & -1 & 0 & 4 \\\\ -3 & -3 & -1 & 3 & 4 & 0 \\end{pmatrix}\n$$\n弗罗贝尼乌斯范数的平方是所有元素平方的总和：$S = \\sum_{i,j} (B_{ij})^2$。\n$$\nS = \\left(\\frac{1}{12}\\right)^{2} \\left[ (-3)^2 + 3^2 + (-3)^2 + (-1)^2 + 4^2 + (-3)^2 + (-3)^2 + (-1)^2 + 3^2 + 4^2 \\right]\n$$\n对矩阵中所有非零元素的平方求和：\nSum = $9+9+9+1+16+9+9+1+9+16=88$\n因此，\n$$\nS = \\frac{1}{144} \\times 88 = \\frac{88}{144}\n$$\n这个分数可以通过分子分母同除以它们的最大公约数 $8$ 来进行化简。\n$$\nS = \\frac{88 \\div 8}{144 \\div 8} = \\frac{11}{18}\n$$\n系数 $\\beta_i$ 和 $\\gamma_i$ 的单位是 $\\mathrm{m}^{-1}$。量 $S$ 是这些系数的平方和，所以其单位是 $\\mathrm{m}^{-2}$。问题要求一个最终的数值。", "answer": "$$\\boxed{\\frac{11}{18}}$$", "id": "2639920"}, {"introduction": "为提高计算效率，工程实践中常采用减缩积分方法，但这可能导致非物理的、被称为“沙漏”的零能模式。本实践将深入探讨四节点双线性（Q4）单元中沙漏现象的理论根源，并要求你基于 Flanagan–Belytschko 控制方法推导和校准一个稳定项来抑制它。理解沙漏控制是进行高级有限元分析的必备知识，它揭示了计算成本与精度之间的权衡，并展示了如何确保数值稳定性的方法。[@problem_id:2639873]", "problem": "在有限元法 (FEM) 中，一个最低阶拉格朗日族（通常记作 $Q_1$）的双线性四边形单元被用于平面应变小变形线性弹性问题。该单元在物理平面上是一个边长为 $a$、厚度为 $t$、形心位于原点的正方形。使用从自然坐标为 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 的父单元域到物理坐标的等参映射，由 $x=(a/2)\\,\\xi$ 和 $y=(a/2)\\,\\eta$ 给出。该单元使用减缩积分，在 $(\\xi,\\eta)=(0,0)$ 处设有一个高斯点，这会引入伪零能“沙漏”模式。\n\n考虑基于假定应变投影的 Flanagan–Belytschko (FB) 沙漏控制方法，该方法惩罚与 $\\xi\\eta$ 成正比的双线性寄生模式。在父单元域中，将节点排序为 $1:(-1,-1)$、$2:(1,-1)$、$3:(1,1)$、$4:(-1,1)$，并将单元节点位移向量表示为 $u_e=[u_{1x},u_{1y},u_{2x},u_{2y},u_{3x},u_{3y},u_{4x},u_{4y}]^{\\mathsf T}$。定义沙漏形向量 $s=[1,-1,1,-1]^{\\mathsf T}$，并通过下式定义两个沙漏广义坐标（每个位移分量对应一个）：\n$$\nq_x=\\frac{1}{4}\\sum_{i=1}^{4}s_i\\,u_{ix},\\qquad\nq_y=\\frac{1}{4}\\sum_{i=1}^{4}s_i\\,u_{iy}.\n$$\n引入 $2\\times 8$ 的沙漏算子 $G$ 使得 $q=[q_x,q_y]^{\\mathsf T}=G\\,u_e$，并假定 FB 形式的稳定化刚度为\n$$\nK_{\\mathrm{hg}}=\\beta\\,\\mu\\,\\frac{t\\,A}{h^2}\\,G^{\\mathsf T}G,\n$$\n其中 $\\mu$ 是剪切模量，$A=a^2$ 是单元面积，$h$ 是特征长度（取 $h=a$），$\\beta$ 是一个无量纲校准常数。相应的稳定化能量为\n$$\n\\Pi_{\\mathrm{hg}}(u_e)=\\frac{1}{2}\\,u_e^{\\mathsf T}K_{\\mathrm{hg}}\\,u_e=\\frac{1}{2}\\,\\beta\\,\\mu\\,\\frac{t\\,A}{h^2}\\,\\|G\\,u_e\\|_2^2=\\frac{1}{2}\\,\\beta\\,\\mu\\,\\frac{t\\,a^2}{a^2}\\,(q_x^2+q_y^2).\n$$\n\n任务：\n- 从虚功原理和在单元形心处计算的减缩积分 $Q_1$ 刚度的定义出发，解释为什么与 $\\xi\\eta$ 成正比的位移场分量不被单点求积所“看见”，从而构成沙漏模式。基于此，论证选择 $q_x$ 和 $q_y$ 作为 $u_x$ 和 $u_y$ 中 $\\xi\\eta$ 项的系数的合理性，并根据向量 $s$ 推导出算子 $G$。\n- 通过证明对于任何刚体运动和任何常应变线性位移场，$q_x=q_y=0$ 均成立，从而证明稳定化的一致性，即 $K_{\\mathrm{hg}}$ 不会惩罚这些模式。\n- 通过对连续介质位移场 $u_x(x,y)=c\\,x\\,y$，$u_y(x,y)=0$（其中 $c$ 为实常数）强制施加能量等效来校准系数 $\\beta$。使用平面应变的小应变线性弹性理论，计算该位移场在单元中的精确弹性势能。其中剪切能量密度为 $W=\\mu\\,\\gamma_{xy}^2/2$，$\\gamma_{xy}=\\partial u_x/\\partial y+\\partial u_y/\\partial x$，计算时需对物理单元面积进行积分并乘以厚度 $t$。然后，计算此位移场在节点上引起的相应节点值所对应的稳定化能量 $\\Pi_{\\mathrm{hg}}$，并确定使两种能量相等的唯一 $\\beta$ 值。\n\n将最终答案表示为 $\\beta$ 的精确值（无量纲）。不需要进行数值舍入。", "solution": "首先根据指定标准验证问题。\n\n**步骤1：提取已知条件**\n- **单元类型**：平面应变中的单个双线性四边形单元 ($Q_1$)。\n- **几何**：正方形，边长 $a$，厚度 $t$，形心在原点。\n- **映射**：从父单元方形域 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ 到物理域 $(x, y)$ 的等参映射，由 $x=(a/2)\\xi$ 和 $y=(a/2)\\eta$ 给出。\n- **积分**：减缩积分，在 $(\\xi, \\eta)=(0,0)$ 处使用单个高斯点。\n- **沙漏控制**：Flanagan–Belytschko (FB) 稳定化。\n- **节点信息**：在父单元域中，节点排序为 $1:(-1,-1)$、$2:(1,-1)$、$3:(1,1)$、$4:(-1,1)$。节点位移向量 $u_e=[u_{1x},u_{1y},u_{2x},u_{2y},u_{3x},u_{3y},u_{4x},u_{4y}]^{\\mathsf T}$。\n- **沙漏定义**：形向量 $s=[1,-1,1,-1]^{\\mathsf T}$。广义坐标 $q_x=\\frac{1}{4}\\sum_{i=1}^{4}s_i u_{ix}$，$q_y=\\frac{1}{4}\\sum_{i=1}^{4}s_i u_{iy}$。算子 $G$ 使得 $q=[q_x,q_y]^{\\mathsf T}=G u_e$。\n- **稳定化刚度和能量**：$K_{\\mathrm{hg}}=\\beta \\mu \\frac{t A}{h^2} G^{\\mathsf T}G$，其中 $A=a^2$, $h=a$。能量为 $\\Pi_{\\mathrm{hg}}(u_e)=\\frac{1}{2} \\beta \\mu t (q_x^2+q_y^2)$。\n- **校准场**：$u_x(x,y)=cxy$, $u_y(x,y)=0$。\n- **校准能量**：基于剪切能量密度 $W=\\mu \\gamma_{xy}^2/2$，其中 $\\gamma_{xy}=\\partial u_x/\\partial y+\\partial u_y/\\partial x$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了计算固体力学中一个标准且有据可查的程序（针对减缩积分单元的沙漏控制）。其公式是适定的，提供了执行所要求任务所需的所有必要数据和定义。语言客观且明确。它没有违反任何无效标准。因此，该问题被认为是有效的。\n\n**步骤3：求解**\n\n求解过程通过解决问题陈述中列出的三个任务来进行。\n\n**任务1：沙漏公式的论证**\n\n$Q_1$ 单元内的位移场由节点位移 $u_{ix}, u_{iy}$ 通过双线性形函数 $N_i(\\xi, \\eta)$ 插值得到：\n$$\nu_x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_{ix}, \\quad u_y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_{iy}\n$$\n其中 $N_i(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_i\\xi)(1+\\eta_i\\eta)$ 且 $(\\xi_i, \\eta_i)$ 是父单元域中节点 $i$ 的坐标。这个插值空间由基函数 $\\{1, \\xi, \\eta, \\xi\\eta\\}$ 张成。任何位移场都可以写成，例如，$u_x = c_0 + c_1\\xi + c_2\\eta + c_3\\xi\\eta$。\n\n小应变张量分量由位移场的空间导数导出。使用链式法则和给定的等参映射 $x=(a/2)\\xi, y=(a/2)\\eta$，变换的雅可比矩阵是常数：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} a/2 & 0 \\\\ 0 & a/2 \\end{pmatrix}\n$$\n空间导数通过以下方式与父单元域中的导数相关联：\n$$\n\\begin{pmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{pmatrix} = J^{-1} \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} 2/a & 0 \\\\ 0 & 2/a \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix} = \\frac{2}{a} \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix}\n$$\n应变分量，例如 $\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x}$ 和 $\\gamma_{xy} = \\frac{\\partial u_x}{\\partial y}+\\frac{\\partial u_y}{\\partial x}$，取决于形函数的梯度。对于一个与 $\\xi\\eta$ 成正比的项，比如 $u_x = c_3\\xi\\eta$ 且 $u_y=0$，父单元域内的梯度为 $\\frac{\\partial u_x}{\\partial \\xi} = c_3\\eta$ 和 $\\frac{\\partial u_x}{\\partial \\eta} = c_3\\xi$。相应的笛卡尔应变为 $\\varepsilon_{xx} = \\frac{2}{a}c_3\\eta$ 和 $\\gamma_{xy} = \\frac{2}{a}c_3\\xi$。\n\n单元刚度矩阵通过对应变能密度进行积分来计算，而应变能密度在高斯点处取值。对于单点求积，取值点在 $(\\xi, \\eta) = (0,0)$。在此点，对应于 $\\xi\\eta$ 模式的应变为零：$\\varepsilon_{xx}(0,0)=0$ 和 $\\gamma_{xy}(0,0)=0$。因此，这种变形模式产生零应变能，因而是一种伪零能或“沙漏”模式。\n\n为了论证 $q_x$ 的定义，我们将 $\\xi\\eta$ 项的系数 $c_3$ 用节点位移表示。通过在四个节点 $(\\xi_i, \\eta_i)$ 处计算 $u_x = c_0 + c_1\\xi + c_2\\eta + c_3\\xi\\eta$，我们得到一个线性方程组。这些方程的一个特定组合可以得到 $c_3$：\n$$\nu_{1x} - u_{2x} + u_{3x} - u_{4x} = (c_0-c_1-c_2+c_3) - (c_0+c_1-c_2-c_3) + (c_0+c_1+c_2+c_3) - (c_0-c_1+c_2-c_3) = 4c_3\n$$\n因此，$c_3 = \\frac{1}{4}(u_{1x} - u_{2x} + u_{3x} - u_{4x})$。使用沙漏形向量 $s=[1,-1,1,-1]^{\\mathsf T}$ 及其分量 $s_1=1, s_2=-1, s_3=1, s_4=-1$，这恰好是沙漏坐标 $q_x$ 的定义：\n$$\nq_x = \\frac{1}{4}\\sum_{i=1}^{4} s_i u_{ix}\n$$\n对 $q_y$ 也适用同样的论证。$q_x$ 和 $q_y$ 的定义正确地分离出了非物理的 $\\xi\\eta$ 模式的大小。\n\n算子 $G$ 将 $q=[q_x,q_y]^{\\mathsf T}$ 与 $u_e$ 关联起来。基于 $q_x$ 和 $q_y$ 定义的展开：\n$$\nq_x = \\frac{1}{4}(1 \\cdot u_{1x} + 0 \\cdot u_{1y} - 1 \\cdot u_{2x} + 0 \\cdot u_{2y} + 1 \\cdot u_{3x} + \\dots)\n$$\n$$\nq_y = \\frac{1}{4}(0 \\cdot u_{1x} + 1 \\cdot u_{1y} + 0 \\cdot u_{2x} - 1 \\cdot u_{2y} + 0 \\cdot u_{3x} + \\dots)\n$$\n因此，$2 \\times 8$ 的矩阵 $G$ 为：\n$$\nG = \\frac{1}{4} \\begin{pmatrix} 1 & 0 & -1 & 0 & 1 & 0 & -1 & 0 \\\\ 0 & 1 & 0 & -1 & 0 & 1 & 0 & -1 \\end{pmatrix}\n$$\n\n**任务2：稳定化的一致性**\n\n我们必须证明对于刚体运动和常应变场，$q_x=q_y=0$。节点的物理坐标是 $1:(-a/2, -a/2)$，$2:(a/2, -a/2)$，$3:(a/2, a/2)$，$4:(-a/2, a/2)$。\n\n*   **刚体运动 (RBM)**：一般的二维刚体运动由 $u_x(x,y) = c_x - \\omega_z y$ 和 $u_y(x,y) = c_y + \\omega_z x$ 给出。\n    $x$-分量的节点位移为：\n    $u_{1x} = c_x - \\omega_z(-a/2) = c_x + \\omega_z a/2$\n    $u_{2x} = c_x - \\omega_z(-a/2) = c_x + \\omega_z a/2$\n    $u_{3x} = c_x - \\omega_z(a/2) = c_x - \\omega_z a/2$\n    $u_{4x} = c_x - \\omega_z(a/2) = c_x - \\omega_z a/2$\n    计算 $q_x$：\n    $q_x = \\frac{1}{4}(u_{1x}-u_{2x}+u_{3x}-u_{4x}) = \\frac{1}{4}[(c_x + \\omega_z a/2) - (c_x + \\omega_z a/2) + (c_x - \\omega_z a/2) - (c_x - \\omega_z a/2)] = 0$。\n    $y$-分量的节点位移为：\n    $u_{1y} = c_y + \\omega_z(-a/2) = c_y - \\omega_z a/2$\n    $u_{2y} = c_y + \\omega_z(a/2) = c_y + \\omega_z a/2$\n    $u_{3y} = c_y + \\omega_z(a/2) = c_y + \\omega_z a/2$\n    $u_{4y} = c_y + \\omega_z(-a/2) = c_y - \\omega_z a/2$\n    计算 $q_y$：\n    $q_y = \\frac{1}{4}(u_{1y}-u_{2y}+u_{3y}-u_{4y}) = \\frac{1}{4}[(c_y - \\omega_z a/2) - (c_y + \\omega_z a/2) + (c_y + \\omega_z a/2) - (c_y - \\omega_z a/2)] = \\frac{1}{4}[(-1-1+1+1)\\omega_z a/2] = 0$。\n\n*   **常应变状态**：常应变场是 $x$ 和 $y$ 的线性函数。叠加 RBM 不会改变结果，因此我们考虑 $u_x = A x + B y$ 和 $u_y = C x + D y$。\n    $x$-分量的节点位移：\n    $u_{1x} = A(-a/2) + B(-a/2) = -(A+B)a/2$\n    $u_{2x} = A(a/2) + B(-a/2) = (A-B)a/2$\n    $u_{3x} = A(a/2) + B(a/2) = (A+B)a/2$\n    $u_{4x} = A(-a/2) + B(a/2) = (-A+B)a/2$\n    $q_x = \\frac{1}{4}(u_{1x}-u_{2x}+u_{3x}-u_{4x}) = \\frac{a}{8}[-(A+B) - (A-B) + (A+B) - (-A+B)] = \\frac{a}{8}[(-1-1+1+1)A + (-1+1+1-1)B] = 0$。\n    对 $q_y$ 的计算与系数 $C$ 和 $D$ 相同，得到 $q_y=0$。\n\n由于对于刚体运动和常应变状态，$q_x=q_y=0$，稳定化项 $\\Pi_{\\mathrm{hg}}$ 对这些模式为零，从而证明了其一致性。\n\n**任务3：系数 $\\beta$ 的校准**\n\n我们通过将精确的连续介质弹性势能 $\\Pi_{\\mathrm{exact}}$ 与指定位移场下的稳定化能量 $\\Pi_{\\mathrm{hg}}$ 相等来校准 $\\beta$。\n\n*   **连续介质弹性势能, $\\Pi_{\\mathrm{exact}}$**：\n    位移场为 $u_x(x,y) = cxy$，$u_y(x,y) = 0$。\n    所需的应变分量为 $\\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = cx + 0 = cx$。\n    问题指定使用剪切能量密度 $W = \\frac{1}{2}\\mu\\gamma_{xy}^2 = \\frac{1}{2}\\mu(cx)^2 = \\frac{1}{2}\\mu c^2 x^2$。\n    总能量是 $W$ 在单元体积 $V$ 上的积分，其中 $dV = t dA = t dx dy$：\n    $$\n    \\Pi_{\\mathrm{exact}} = \\int_V W dV = t \\int_{A} W dA = t \\int_{-a/2}^{a/2} \\int_{-a/2}^{a/2} \\left( \\frac{1}{2}\\mu c^2 x^2 \\right) dx dy\n    $$\n    $$\n    \\Pi_{\\mathrm{exact}} = \\frac{1}{2} t \\mu c^2 \\left( \\int_{-a/2}^{a/2} dy \\right) \\left( \\int_{-a/2}^{a/2} x^2 dx \\right)\n    $$\n    积分计算结果为：\n    $$\n    \\int_{-a/2}^{a/2} dy = a\n    $$\n    $$\n    \\int_{-a/2}^{a/2} x^2 dx = \\left[ \\frac{x^3}{3} \\right]_{-a/2}^{a/2} = \\frac{1}{3} \\left( \\left(\\frac{a}{2}\\right)^3 - \\left(-\\frac{a}{2}\\right)^3 \\right) = \\frac{2}{3} \\frac{a^3}{8} = \\frac{a^3}{12}\n    $$\n    代入后，我们得到：\n    $$\n    \\Pi_{\\mathrm{exact}} = \\frac{1}{2} t \\mu c^2 (a) \\left( \\frac{a^3}{12} \\right) = \\frac{t \\mu c^2 a^4}{24}\n    $$\n\n*   **稳定化能量, $\\Pi_{\\mathrm{hg}}$**：\n    公式为 $\\Pi_{\\mathrm{hg}} = \\frac{1}{2}\\beta \\mu t (q_x^2 + q_y^2)$。\n    首先，从 $u_x = cxy$ 和 $u_y = 0$ 求得节点位移：\n    $u_{1x} = c(-a/2)(-a/2) = ca^2/4$\n    $u_{2x} = c(a/2)(-a/2) = -ca^2/4$\n    $u_{3x} = c(a/2)(a/2) = ca^2/4$\n    $u_{4x} = c(-a/2)(a/2) = -ca^2/4$\n    所有的 $u_{iy}$ 均为零，所以 $q_y = \\frac{1}{4}\\sum s_i u_{iy} = 0$。\n    现在，计算 $q_x$：\n    $$\n    q_x = \\frac{1}{4}(u_{1x}-u_{2x}+u_{3x}-u_{4x}) = \\frac{1}{4} \\left[ \\frac{ca^2}{4} - \\left(-\\frac{ca^2}{4}\\right) + \\frac{ca^2}{4} - \\left(-\\frac{ca^2}{4}\\right) \\right]\n    $$\n    $$\n    q_x = \\frac{1}{4} \\left( 4 \\times \\frac{ca^2}{4} \\right) = \\frac{ca^2}{4}\n    $$\n    将 $q_x$ 和 $q_y$ 代入能量表达式：\n    $$\n    \\Pi_{\\mathrm{hg}} = \\frac{1}{2} \\beta \\mu t \\left( \\left( \\frac{ca^2}{4} \\right)^2 + 0^2 \\right) = \\frac{1}{2} \\beta \\mu t \\frac{c^2 a^4}{16} = \\frac{\\beta t \\mu c^2 a^4}{32}\n    $$\n\n*   **令能量相等以求 $\\beta$**：\n    我们设 $\\Pi_{\\mathrm{exact}} = \\Pi_{\\mathrm{hg}}$：\n    $$\n    \\frac{t \\mu c^2 a^4}{24} = \\frac{\\beta t \\mu c^2 a^4}{32}\n    $$\n    消去公因子 $(t \\mu c^2 a^4)$，剩下：\n    $$\n    \\frac{1}{24} = \\frac{\\beta}{32}\n    $$\n    解出 $\\beta$：\n    $$\n    \\beta = \\frac{32}{24} = \\frac{4}{3}\n    $$", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "2639873"}, {"introduction": "掌握单元技术的最后一步是将其应用于解决实际问题并进行验证。这项动手编程任务要求你构建一个小型轴对称有限元求解器，用于分析一个受压厚壁圆筒——这是弹性力学中一个经典的基准问题。通过将你的数值结果与精确的解析解进行比较，你将实践完整的 V&V（验证与确认）工作流程，并对网格细化、单元在特定条件（如近不可压缩性）下的行为等实际问题获得深入见解。[@problem_id:2639858]", "problem": "实现一个小型、自包含的轴对称有限元法（FEM）求解器，使用四节点双线性四边形（Q4）单元来近似计算在平面应变条件下，一个受压的长厚壁圆筒的径向位移。目标是计算径向位移场，并将其与从平衡基本方程和线性弹性理论推导出的解析解进行比较。必须通过横截面域上的相对 $L^{2}$ 型误差范数来量化该比较。\n\n考虑一个内半径为 $a$、外半径为 $b$ 的长圆筒，由均匀、各向同性、线性弹性材料制成，其杨氏模量为 $E$，泊松比为 $\\nu$。载荷包括作用在内圆柱表面 $r=a$ 上的均匀内压 $p_{i}$ 和作用在外圆柱表面 $r=b$ 上的均匀外压 $p_{o}$。假设小应变和轴向平面应变，即轴向应变 $\\varepsilon_{z}=0$。在圆柱坐标系中使用轴对称公式，横截面位于 $(r,z)$ 平面，其中 $r\\in[a,b]$ 且 $z\\in[0,L]$，$L=1$。通过约束各处的轴向位移 $u_{z}=0$ 来施加平面应变条件。\n\n离散化要求：\n- 使用等参 Q4 单元，在参考正方形上采用标准的双线性形函数。对单元刚度和体积项使用 $2\\times 2$ 高斯积分，对边界牵引力积分使用 $2$ 点高斯积分。\n- 使用轴对称弱形式，其中所有积分都由半径 $r$ 加权，并包含周向因子 $2\\pi$。具体来说，单元刚度必须由下式组装：\n$$\n\\mathbf{K}_{e}=\\int_{\\Omega_{e}} \\left(\\mathbf{B}^{T}\\mathbf{D}\\mathbf{B}\\right)\\, 2\\pi r \\, \\mathrm{d}A,\n$$\n其中 $\\mathbf{B}$ 是轴对称问题的应变-位移矩阵，应变分量为 $\\varepsilon_{r}$、$\\varepsilon_{z}$、$\\varepsilon_{\\theta}$、$\\gamma_{rz}$；$\\mathbf{D}$ 是使用 Lamé 参数 $\\lambda$ 和 $\\mu$ 的轴对称形式的各向同性弹性矩阵，其中 $\\mu= \\dfrac{E}{2(1+\\nu)}$ 且 $\\lambda=\\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$。\n- 通过以下形式的一致边界积分，在 $r=a$ 和 $r=b$ 上施加 Neumann 边界条件：\n$$\n\\mathbf{f}_{e}^{(\\text{traction})}=\\int_{\\Gamma_{e}} \\mathbf{N}^{T}\\,\\mathbf{t}\\, 2\\pi r\\, \\mathrm{d}\\ell,\n$$\n在 $r=a$ 上 $\\mathbf{t}=\\left[+p_{i},\\,0\\right]^{T}$，在 $r=b$ 上 $\\mathbf{t}=\\left[-p_{o},\\,0\\right]^{T}$。此处 $\\mathbf{N}$ 是将节点位移映射到位移场的形函数矩阵，$\\mathrm{d}\\ell$ 是沿 $(r,z)$ 平面中边界边的线元。\n\n解析解目标：\n- 从轴对称径向平衡方程、应变-位移关系和 Hooke 定律出发（不要预设任何目标公式），推导在给定 $(a,b,p_{i},p_{o},E,\\nu)$ 的平面应变条件下径向位移 $u_{\\text{an}}(r)$ 的解析表达式。\n\n误差度量：\n- 将横截面上的相对 $L^{2}$ 型误差定义为：\n$$\n\\varepsilon_{\\text{rel}}=\\frac{\\left(\\int_{\\Omega} \\left(u_{h}(r,z)-u_{\\text{an}}(r)\\right)^{2}\\, 2\\pi r \\,\\mathrm{d}A\\right)^{1/2}}{\\left(\\int_{\\Omega} \\left(u_{\\text{an}}(r)\\right)^{2}\\, 2\\pi r \\,\\mathrm{d}A\\right)^{1/2}},\n$$\n其中 $u_{h}$ 是 FEM 的径向位移解，$u_{\\text{an}}$ 是解析径向位移。对每个单元使用 $2\\times 2$ 高斯积分来数值近似这些积分。误差 $\\varepsilon_{\\text{rel}}$ 是无量纲的。\n\n边界条件和约束：\n- 通过在所有节点上指定 $u_{z}=0$ 来施加平面应变。\n- 不施加额外的径向位移约束。\n\n测试套件：\n针对以下四个测试用例运行您的求解器，使用指定的单位（全部为国际单位制）。在所有情况下，轴向长度均为 $L=1$ 米。对每个用例，在径向上使用 $N_{r}$ 个单元，在轴向上使用 $N_{z}$ 个单元来离散化区域。\n\n$1.$ 用例 A（理想路径，中等网格）：\n- $a = 0.3\\,\\text{m}$，$b=1.0\\,\\text{m}$，$p_{i}=1.25\\times 10^{6}\\,\\text{Pa}$，$p_{o}=0.0\\,\\text{Pa}$，$E=200\\times 10^{9}\\,\\text{Pa}$，$\\nu=0.30$，$N_{r}=8$，$N_{z}=3$。\n\n$2.$ 用例 B（粗网格边界情况）：\n- $a = 0.3\\,\\text{m}$，$b=1.0\\,\\text{m}$，$p_{i}=1.25\\times 10^{6}\\,\\text{Pa}$，$p_{o}=0.0\\,\\text{Pa}$，$E=200\\times 10^{9}\\,\\text{Pa}$，$\\nu=0.30$，$N_{r}=1$，$N_{z}=1$。\n\n$3.$ 用例 C（非零外压）：\n- $a = 0.3\\,\\text{m}$，$b=1.0\\,\\text{m}$，$p_{i}=1.25\\times 10^{6}\\,\\text{Pa}$，$p_{o}=0.60\\times 10^{6}\\,\\text{Pa}$，$E=200\\times 10^{9}\\,\\text{Pa}$，$\\nu=0.30$，$N_{r}=6$，$N_{z}=2$。\n\n$4.$ 用例 D（近不可压缩材料，以暴露 Q4 单元在平面应变下的闭锁问题）：\n- $a = 0.3\\,\\text{m}$，$b=1.0\\,\\text{m}$，$p_{i}=1.25\\times 10^{6}\\,\\text{Pa}$，$p_{o}=0.0\\,\\text{Pa}$，$E=200\\times 10^{9}\\,\\text{Pa}$，$\\nu=0.49$，$N_{r}=8$，$N_{z}=2$。\n\n最终输出格式：\n您的程序必须生成单行输出，其中包含用例 A–D 的四个相对误差，以逗号分隔并用方括号括起，例如\n$[\\varepsilon_{A},\\varepsilon_{B},\\varepsilon_{C},\\varepsilon_{D}]$，\n每个条目格式化为小数，并精确到小数点后六位。相对误差是无量纲的，因此输出中不需要物理单位。不得有任何其他输出。\n\n注：\n- 输入或输出中未使用角度，因此不需要角度单位。\n- 所有输入均使用国际单位制，但所要求的输出是指定的无量纲数。", "solution": "用户要求开发一个用于平面应变条件下厚壁受压圆筒的轴对称有限元法（FEM）求解器。该问题是适定的且科学上是合理的，代表了线性弹性力学中的一个经典问题。该过程涉及两个主要阶段：首先，推导用于验证的解析解；其次，FEM 求解器的公式化和实现。\n\n首先，我们推导径向位移 $u_r(r)$ 的解析解。该问题是轴对称的，因此位移和应力不随周向坐标 $\\theta$ 变化。圆筒被假定为长的，并施加了平面应变条件，即轴向应变 $\\varepsilon_z = 0$。由于沿长度方向载荷均匀，径向位移 $u_r$ 仅取决于径向坐标 $r$，因此 $u_r = u_r(r)$。\n\n径向和周向应变由下式给出：\n$$\n\\varepsilon_r = \\frac{du_r}{dr}, \\quad \\varepsilon_\\theta = \\frac{u_r}{r}\n$$\n轴向应变为 $\\varepsilon_z = 0$。由于轴对称和均匀载荷，剪切应变 $\\gamma_{rz}$ 也为零。\n\n控制方程是圆柱坐标系中的径向平衡方程，可简化为：\n$$\n\\frac{d\\sigma_r}{dr} + \\frac{\\sigma_r - \\sigma_\\theta}{r} = 0\n$$\n其中 $\\sigma_r$ 和 $\\sigma_\\theta$ 分别是径向和周向（环向）应力。\n\n在平面应变条件（$\\varepsilon_z=0$）下，各向同性材料的应力与应变关系的 Hooke 定律为：\n$$\n\\sigma_r = \\frac{E}{(1+\\nu)(1-2\\nu)} \\left[ (1-\\nu)\\varepsilon_r + \\nu\\varepsilon_\\theta \\right] = (\\lambda + 2\\mu)\\varepsilon_r + \\lambda\\varepsilon_\\theta \\\\\n\\sigma_\\theta = \\frac{E}{(1+\\nu)(1-2\\nu)} \\left[ \\nu\\varepsilon_r + (1-\\nu)\\varepsilon_\\theta \\right] = \\lambda\\varepsilon_r + (\\lambda + 2\\mu)\\varepsilon_\\theta \\\\\n\\sigma_z = \\nu(\\sigma_r + \\sigma_\\theta) = \\lambda(\\varepsilon_r + \\varepsilon_\\theta)\n$$\n其中 $E$ 是杨氏模量，$\\nu$ 是泊松比，$\\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu = \\frac{E}{2(1+\\nu)}$ 是 Lamé 参数。\n\n将应变-位移关系代入应力表达式，然后再代入平衡方程，得到关于 $u_r(r)$ 的二阶常微分方程：\n$$\n\\frac{d^2u_r}{dr^2} + \\frac{1}{r}\\frac{du_r}{dr} - \\frac{u_r}{r^2} = 0\n$$\n这是一个 Cauchy-Euler 方程，其通解形式为：\n$$\nu_r(r) = C_1 r + \\frac{C_2}{r}\n$$\n积分常数 $C_1$ 和 $C_2$ 由径向应力的边界条件确定：\n$$\n\\sigma_r(r=a) = -p_i, \\quad \\sigma_r(r=b) = -p_o\n$$\n将 $u_r(r)$ 的通解代入 $\\sigma_r$ 的表达式中，得到：\n$$\n\\sigma_r(r) = 2(\\lambda+\\mu)C_1 - \\frac{2\\mu C_2}{r^2}\n$$\n应用边界条件得到一个关于 $C_1$ 和 $C_2$ 的二元线性方程组：\n$$\n-p_i = 2(\\lambda+\\mu)C_1 - \\frac{2\\mu C_2}{a^2} \\\\\n-p_o = 2(\\lambda+\\mu)C_1 - \\frac{2\\mu C_2}{b^2}\n$$\n解此方程组可得：\n$$\nC_1 = \\frac{p_ia^2 - p_ob^2}{2(\\lambda+\\mu)(b^2-a^2)} = \\frac{(1+\\nu)(1-2\\nu)}{E} \\frac{p_ia^2-p_ob^2}{b^2-a^2} \\\\\nC_2 = \\frac{(p_i-p_o)a^2b^2}{2\\mu(b^2-a^2)} = \\frac{1+\\nu}{E} \\frac{(p_i-p_o)a^2b^2}{b^2-a^2}\n$$\n最后，径向位移的解析解为：\n$$\nu_{\\text{an}}(r) = \\frac{1+\\nu}{E(b^2-a^2)} \\left[ (1-2\\nu)(p_ia^2-p_ob^2)r + (p_i-p_o)\\frac{a^2b^2}{r} \\right]\n$$\n\n接下来，我们建立有限元公式。区域使用四节点双线性四边形（Q4）单元进行离散化。单元内的位移场通过形函数 $\\mathbf{N}$ 从节点位移 $\\mathbf{d}^e$ 插值得到：\n$$\n\\mathbf{u}(r,z) = \\begin{Bmatrix} u_r \\\\ u_z \\end{Bmatrix} = \\mathbf{N}\\mathbf{d}^e = \\sum_{i=1}^{4} \\mathbf{N}_i \\mathbf{d}_i\n$$\n其中 $\\mathbf{N}_i = \\begin{bmatrix} N_i & 0 \\\\ 0 & N_i \\end{bmatrix}$ 且 $\\mathbf{d}_i=\\begin{Bmatrix} u_r^i \\\\ u_z^i \\end{Bmatrix}$。形函数 $N_i(\\xi, \\eta)$ 定义在参考正方形 $[-1,1] \\times [-1,1]$上。\n\n轴对称应变向量为 $\\boldsymbol{\\varepsilon} = [\\varepsilon_r, \\varepsilon_z, \\varepsilon_\\theta, \\gamma_{rz}]^T$。应变通过应变-位移矩阵 $\\mathbf{B}$ 与节点位移相关联：$\\boldsymbol{\\varepsilon} = \\mathbf{B}\\mathbf{d}^e$。对于节点 $i$，矩阵 $\\mathbf{B}_i$ 为：\n$$\n\\mathbf{B}_i = \\begin{bmatrix} \\frac{\\partial N_i}{\\partial r} & 0 \\\\ 0 & \\frac{\\partial N_i}{\\partial z} \\\\ \\frac{N_i}{r} & 0 \\\\ \\frac{\\partial N_i}{\\partial z} & \\frac{\\partial N_i}{\\partial r} \\end{bmatrix}\n$$\n形函数相对于全局坐标 $(r,z)$ 的导数是通过等参映射的雅可比矩阵，从相对于局部坐标 $(\\xi,\\eta)$ 的导数获得的：$\\begin{Bmatrix} \\partial/\\partial r \\\\ \\partial/\\partial z \\end{Bmatrix} = \\mathbf{J}^{-1} \\begin{Bmatrix} \\partial/\\partial \\xi \\\\ \\partial/\\partial \\eta \\end{Bmatrix}$。\n\n本构矩阵 $\\mathbf{D}$ 通过 $\\boldsymbol{\\sigma} = \\mathbf{D}\\boldsymbol{\\varepsilon}$ 将应力向量 $\\boldsymbol{\\sigma} = [\\sigma_r, \\sigma_z, \\sigma_\\theta, \\tau_{rz}]^T$ 与应变向量 $\\boldsymbol{\\varepsilon}$ 关联起来。对于各向同性材料，该矩阵为：\n$$\n\\mathbf{D} = \\begin{bmatrix}\n\\lambda+2\\mu & \\lambda & \\lambda & 0 \\\\\n\\lambda & \\lambda+2\\mu & \\lambda & 0 \\\\\n\\lambda & \\lambda & \\lambda+2\\mu & 0 \\\\\n0 & 0 & 0 & \\mu\n\\end{bmatrix}\n$$\n单元刚度矩阵 $\\mathbf{K}_e$ 通过在圆柱坐标系中对单元体积进行积分来计算：\n$$\n\\mathbf{K}_{e} = \\int_{\\Omega_{e}} \\mathbf{B}^{T}\\mathbf{D}\\mathbf{B} \\, 2\\pi r \\, dA = \\int_{-1}^{1}\\int_{-1}^{1} \\mathbf{B}^{T}\\mathbf{D}\\mathbf{B} \\, 2\\pi r(\\xi,\\eta) \\, |\\det(\\mathbf{J})| \\, d\\xi d\\eta\n$$\n该积分使用 $2 \\times 2$ 高斯积分进行数值计算。\n\n外压作为 Neumann 边界条件施加。单元边 $\\Gamma_e$ 的一致节点力向量为：\n$$\n\\mathbf{f}_{e}^{(\\text{traction})} = \\int_{\\Gamma_{e}} \\mathbf{N}^{T} \\mathbf{t} \\, 2\\pi r \\, d\\ell\n$$\n对于内边界 $r=a$ 上的边，牵引力为 $\\mathbf{t} = [p_i, 0]^T$。对于外边界 $r=b$，$\\mathbf{t} = [-p_o, 0]^T$。这些线积分使用 $2$ 点高斯积分进行计算。\n\n在组装全局刚度矩阵 $\\mathbf{K}$ 和力向量 $\\mathbf{F}$ 之后，求解系统 $\\mathbf{K}\\mathbf{U} = \\mathbf{F}$ 以获得全局位移向量 $\\mathbf{U}$。通过约束所有节点的轴向位移 $u_z=0$ 来施加平面应变条件。这是通过在求解前修改全局方程组来实现的。\n\n最后，使用指定的 $L^2$ 型范数计算 FEM 解 $u_h$ 与解析解 $u_{\\text{an}}$ 之间的相对误差：\n$$\n\\varepsilon_{\\text{rel}} = \\frac{\\|u_h - u_{\\text{an}}\\|_{L^2(\\Omega)}}{\\|u_{\\text{an}}\\|_{L^2(\\Omega)}} = \\frac{\\left(\\int_{\\Omega} \\left(u_{h}(r,z)-u_{\\text{an}}(r)\\right)^{2}\\, 2\\pi r \\,\\mathrm{d}A\\right)^{1/2}}{\\left(\\int_{\\Omega} \\left(u_{\\text{an}}(r)\\right)^{2}\\, 2\\pi r \\,\\mathrm{d}A\\right)^{1/2}}\n$$\n用于误差范数的积分也通过在每个单元上使用 $2 \\times 2$ 高斯积分进行数值计算。", "answer": "$$[0.000300,0.119782,0.000494,0.110543]$$", "id": "2639858"}]}