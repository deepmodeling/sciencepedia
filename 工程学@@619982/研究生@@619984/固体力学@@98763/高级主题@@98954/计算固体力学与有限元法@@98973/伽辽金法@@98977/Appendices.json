{"hands_on_practices": [{"introduction": "有限元方法的核心在于将一个连续问题（以弱形式表达的偏微分方程）转化为一个离散的代数系统 $K\\mathbf{d}=\\mathbf{f}$。其中，刚度矩阵 $K$ 封装了材料的本构响应和单元的几何信息。本练习将指导您从虚功原理出发，亲手推导单元刚度矩阵，将抽象的双线性形式 $a(u,v)$ 与一个具体可计算的矩阵联系起来，这对于理解材料属性和单元运动学如何编码到有限元模型中至关重要 [@problem_id:2697408]。", "problem": "考虑一个二维、静态、小应变、线弹性体，其占据一个有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{2}$，外单位法向量为 $\\boldsymbol{n}$。设位移场为 $\\boldsymbol{u}:\\Omega \\rightarrow \\mathbb{R}^{2}$，体力密度为 $\\boldsymbol{b}:\\Omega \\rightarrow \\mathbb{R}^{2}$，在 Neumann 边界 $\\Gamma_{t}\\subset \\partial \\Omega$ 上的给定牵引力为 $\\boldsymbol{t}:\\Gamma_{t} \\rightarrow \\mathbb{R}^{2}$。本构律为线弹性，其四阶弹性张量为 $\\mathbb{C}$（假设为均匀且各向同性），小应变张量为 $\\boldsymbol{\\varepsilon}(\\boldsymbol{u})=\\nabla^{s}\\boldsymbol{u}=\\tfrac{1}{2}(\\nabla \\boldsymbol{u}+\\nabla \\boldsymbol{u}^{T})$。从对于所有在 Dirichlet 边界上为零的虚位移 $\\boldsymbol{v}\\in [H^{1}(\\Omega)]^{2}$ 均成立的弱形式 $a(\\boldsymbol{u},\\boldsymbol{v})=\\ell(\\boldsymbol{v})$ 出发，使用在 $\\Omega$ 的三角剖分上的 $C^{0}$ 连续的分段线性形函数，推导有限元 Galerkin 离散化。具体要求如下：\n- 从双线性形式 $a(\\boldsymbol{u},\\boldsymbol{v})$ 以及对 $\\boldsymbol{u}$ 和 $\\boldsymbol{v}$ 的 Galerkin 假设出发，推导单元刚度矩阵各项关于标量形函数的导数和弹性张量分量的显式表达式。\n- 清晰说明对称梯度算子和本构张量在推导过程中的作用。\n- 定义单元自由度的排序，并给出连接形函数梯度与应变的单元应变-位移算子。\n- 精确解释如何使用单元到全局自由度的映射，将所得到的单元矩阵组装成全局刚度矩阵。\n\n然后，为了使推导具体化，将问题特殊化为二维平面应变情况，其各向同性弹性由杨氏模量 $E$ 和泊松比 $\\nu$ 表征，并考虑一个具有下列节点的等厚度三角形单元：\n- 节点 $1$ 位于 $(x_{1},y_{1})=(0,0)$，\n- 节点 $2$ 位于 $(x_{2},y_{2})=(0.3,0)$，\n- 节点 $3$ 位于 $(x_{3},y_{3})=(0,0.2)$,\n以及均匀的平面外厚度 $t$。使用规范的单元自由度排序 $[u_{1},v_{1},u_{2},v_{2},u_{3},v_{3}]^{T}$，其中 $u_{i}$ 和 $v_{i}$ 分别是节点 $i$ 处的水平和竖直位移分量。\n\n计算单元刚度矩阵中耦合节点1的水平位移与节点2的水平位移的特定标量项（即在所述排序下的 $(1,3)$ 项），并将最终结果表示为包含 $E$、$\\nu$ 和 $t$ 的闭式解析表达式。您的最终表达式的单位为 $\\mathrm{N}/\\mathrm{m}$；不要在最终的方框答案中包含单位。不要代入数值；仅提供符号表达式。", "solution": "该问题陈述在计算固体力学领域内被验证为一个正确且自洽的表述。它具有科学依据，是适定的，并为获得唯一解提供了所有必要的数据和定义。我们继续进行推导和计算。\n\n出发点是虚功原理，对于静态弹性体，它导出了平衡方程的弱形式。该形式指出，对于任何运动学容许的虚位移场 $\\boldsymbol{v}$（其在 Dirichlet 边界上为零），下述等式必须成立：\n$$\n\\int_{\\Omega} \\boldsymbol{\\sigma}(\\boldsymbol{u}) : \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) \\, dV = \\int_{\\Omega} \\boldsymbol{b} \\cdot \\boldsymbol{v} \\, dV + \\int_{\\Gamma_t} \\boldsymbol{t} \\cdot \\boldsymbol{v} \\, dS\n$$\n此处，$\\boldsymbol{u}$ 是真实位移场，$\\boldsymbol{\\sigma}(\\boldsymbol{u})$ 是与 $\\boldsymbol{u}$ 对应的 Cauchy 应力张量，$\\boldsymbol{\\varepsilon}(\\boldsymbol{v})$ 是虚位移场的小应变张量。右侧的项代表了体力 $\\boldsymbol{b}$ 和表面牵引力 $\\boldsymbol{t}$ 所做的虚功。\n应力张量和应变张量通过线性本构律 $\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon}$ 相关联，其中 $\\mathbb{C}$ 是四阶弹性张量。应变由位移的对称梯度给出，即 $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\nabla^s \\boldsymbol{u} = \\frac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^T)$。\n将本构律代入弱形式可得：\n$$\n\\underbrace{\\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) : \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) \\, dV}_{a(\\boldsymbol{u},\\boldsymbol{v})} = \\underbrace{\\int_{\\Omega} \\boldsymbol{b} \\cdot \\boldsymbol{v} \\, dV + \\int_{\\Gamma_t} \\boldsymbol{t} \\cdot \\boldsymbol{v} \\, dS}_{\\ell(\\boldsymbol{v})}\n$$\n左侧定义了一个对称双线性形式 $a(\\boldsymbol{u},\\boldsymbol{v})$，右侧定义了一个线性泛函 $\\ell(\\boldsymbol{v})$。\n\n在有限元 Galerkin 方法中，域 $\\Omega$ 被离散化为单元 $\\Omega_e$ 组成的网格。在每个单元内，位移场 $\\boldsymbol{u}$ 由一个函数 $\\boldsymbol{u}^h$ 来近似，该函数由一组有限的基函数（称为形函数）构建。对于 $C^0$ 连续的分段线性单元，单元内某点 $\\boldsymbol{x}$ 处的位移由节点位移 $\\boldsymbol{d}_i^e$ 插值得到：\n$$\n\\boldsymbol{u}^h(\\boldsymbol{x}) = \\sum_{i=1}^{n_{nodes}} N_i(\\boldsymbol{x}) \\boldsymbol{d}_i^e\n$$\n此处，$n_{nodes}$ 是单元中的节点数，$N_i(\\boldsymbol{x})$ 是标量形函数，$\\boldsymbol{d}_i^e = [u_i, v_i]^T$ 是节点 $i$ 处的位移分量。对虚位移场也使用相同的近似，$\\boldsymbol{v}^h = \\sum_{j=1}^{n_{nodes}} N_j(\\boldsymbol{x}) \\boldsymbol{c}_j^e$，其中 $\\boldsymbol{c}_j^e$ 是任意的虚节点位移。\n\n为便于计算，我们采用矩阵-向量表示法（Voigt 表示法）。应变张量分量被排成一个向量 $\\boldsymbol{\\epsilon} = [\\epsilon_{xx}, \\epsilon_{yy}, \\gamma_{xy}]^T$，其中 $\\gamma_{xy}=2\\epsilon_{xy}$。本构律变为 $\\boldsymbol{\\sigma}=\\boldsymbol{D}\\boldsymbol{\\epsilon}$，其中 $\\boldsymbol{D}$ 是二维问题的 $3 \\times 3$ 本构矩阵。双线性形式变为 $a(\\boldsymbol{u}, \\boldsymbol{v}) = \\int_{\\Omega} \\boldsymbol{\\epsilon}(\\boldsymbol{v})^T \\boldsymbol{D} \\boldsymbol{\\epsilon}(\\boldsymbol{u}) \\, dV$。\n\n应变向量通过对位移向量应用一个矩阵微分算子得到：$\\boldsymbol{\\epsilon} = \\boldsymbol{\\mathcal{L}}\\boldsymbol{u}$，其中 $\\boldsymbol{\\mathcal{L}} = \\begin{pmatrix} \\partial/\\partial x & 0 \\\\ 0 & \\partial/\\partial y \\\\ \\partial/\\partial y & \\partial/\\partial x \\end{pmatrix}$。\n将此应用于有限元近似 $\\boldsymbol{u}^h$，我们得到应变向量与单元所有节点自由度向量 $\\boldsymbol{d}^e = [u_1,v_1,u_2,v_2,\\dots]^T$ 之间的关系：\n$$\n\\boldsymbol{\\epsilon}(\\boldsymbol{x}) = \\boldsymbol{B}(\\boldsymbol{x}) \\boldsymbol{d}^e\n$$\n矩阵 $\\boldsymbol{B}$ 是应变-位移矩阵。对于一个具有指定自由度排序 $\\boldsymbol{d}^e=[u_1, v_1, u_2, v_2, u_3, v_3]^T$ 的三节点三角形，它是一个 $3 \\times 6$ 的矩阵，定义如下：\n$$\n\\boldsymbol{B} = \\begin{pmatrix}\n\\frac{\\partial N_1}{\\partial x} & 0 & \\frac{\\partial N_2}{\\partial x} & 0 & \\frac{\\partial N_3}{\\partial x} & 0 \\\\\n0 & \\frac{\\partial N_1}{\\partial y} & 0 & \\frac{\\partial N_2}{\\partial y} & 0 & \\frac{\\partial N_3}{\\partial y} \\\\\n\\frac{\\partial N_1}{\\partial y} & \\frac{\\partial N_1}{\\partial x} & \\frac{\\partial N_2}{\\partial y} & \\frac{\\partial N_2}{\\partial x} & \\frac{\\partial N_3}{\\partial y} & \\frac{\\partial N_3}{\\partial x}\n\\end{pmatrix}\n$$\n将 Galerkin 近似代入单个单元的双线性形式，可得：\n$$\na(\\boldsymbol{u}^h, \\boldsymbol{v}^h)_{\\Omega_e} = \\int_{\\Omega_e} (\\boldsymbol{B}\\boldsymbol{c}^e)^T \\boldsymbol{D} (\\boldsymbol{B}\\boldsymbol{d}^e) \\, dV = (\\boldsymbol{c}^e)^T \\left( \\int_{\\Omega_e} \\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B} \\, dV \\right) \\boldsymbol{d}^e\n$$\n由此，我们确定单元刚度矩阵 $\\boldsymbol{K}^e$：\n$$\n\\boldsymbol{K}^e = \\int_{\\Omega_e} \\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B} \\, dV\n$$\n对称梯度算子 $\\nabla^s \\boldsymbol{u}$ 的作用是基础性的，因为它根据位移定义了应变。其结构被编码在算子 $\\boldsymbol{\\mathcal{L}}$ 中，并直接决定了应变-位移矩阵 $\\boldsymbol{B}$ 的内容和结构，该矩阵将节点位移与单元应变联系起来。本构张量 $\\mathbb{C}$（或其矩阵形式 $\\boldsymbol{D}$）的作用是提供应力与应变之间特定于材料的线性关系。它在能量双线性形式中充当核，并决定了刚度矩阵的数值。\n\n全局刚度矩阵 $\\boldsymbol{K}$ 是通过汇集所有单元矩阵 $\\boldsymbol{K}^e$ 的贡献来构建的。这个组装过程涉及将单元矩阵的项加到全局矩阵的相应位置上，这一过程由一个单元到全局自由度的映射来控制。\n\n现在，我们将问题特殊化为给定三角形单元在平面应变条件下的情况。对于一个线性三角形单元（常应变三角形或 CST），形函数的梯度在整个单元内是恒定的。因此，矩阵 $\\boldsymbol{B}$ 是一个常数。$\\boldsymbol{K}^e$ 的积分简化为：\n$$\n\\boldsymbol{K}^e = (\\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B}) \\int_{\\Omega_e} dV = A_e t \\, \\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B}\n$$\n其中 $A_e$ 是单元的面积，$t$ 是其恒定厚度。\n\n节点坐标给定为 $1: (x_1, y_1)=(0,0)$, $2: (x_2, y_2)=(0.3,0)$, $3: (x_3, y_3)=(0,0.2)$。这个直角三角形的面积是 $A_e = \\frac{1}{2} \\times 0.3 \\times 0.2 = 0.03$。\n线性形函数的导数由标准公式给出。对于 $1,2,3$ 的循环置换 $i_1, i_2, i_3$：\n$\\frac{\\partial N_{i_1}}{\\partial x} = \\frac{y_{i_2}-y_{i_3}}{2A_e}$，以及 $\\frac{\\partial N_{i_1}}{\\partial y} = \\frac{x_{i_3}-x_{i_2}}{2A_e}$。\n计算 $2A_e = 0.06$：\n$\\frac{\\partial N_1}{\\partial x} = \\frac{0-0.2}{0.06} = -\\frac{10}{3}$; $\\frac{\\partial N_1}{\\partial y} = \\frac{0-0.3}{0.06} = -5$。\n$\\frac{\\partial N_2}{\\partial x} = \\frac{0.2-0}{0.06} = \\frac{10}{3}$; $\\frac{\\partial N_2}{\\partial y} = \\frac{0-0}{0.06} = 0$。\n$\\frac{\\partial N_3}{\\partial x} = \\frac{0-0}{0.06} = 0$; $\\frac{\\partial N_3}{\\partial y} = \\frac{0.3-0}{0.06} = 5$。\n因此，$\\boldsymbol{B}$ 矩阵为：\n$$\n\\boldsymbol{B} = \\begin{pmatrix}\n-\\frac{10}{3} & 0 & \\frac{10}{3} & 0 & 0 & 0 \\\\\n0 & -5 & 0 & 0 & 0 & 5 \\\\\n-5 & -\\frac{10}{3} & 0 & \\frac{10}{3} & 5 & 0\n\\end{pmatrix}\n$$\n对于平面应变下的各向同性线弹性，本构矩阵 $\\boldsymbol{D}$ 为：\n$$\n\\boldsymbol{D} = \\frac{E}{(1+\\nu)(1-2\\nu)} \\begin{pmatrix}\n1-\\nu & \\nu & 0 \\\\\n\\nu & 1-\\nu & 0 \\\\\n0 & 0 & \\frac{1-2\\nu}{2}\n\\end{pmatrix}\n$$\n我们需要计算单元刚度矩阵的 $(1,3)$ 项，即 $K^e_{13}$。该项耦合了节点1的水平位移（$u_1$，自由度1）与节点2的水平位移（$u_2$，自由度3）。它由 $K^e_{13} = A_e t (\\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B})_{13}$ 给出。通过将 $\\boldsymbol{B}^T$ 的第一列（即 $\\boldsymbol{B}$ 的第一行）与 $\\boldsymbol{B}$ 的第三列相乘来计算内积的 $(1,3)$ 元素。这是不正确的。$\\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B}$ 的 $(i,j)$ 项是 $(\\boldsymbol{B}_{col,i})^T \\boldsymbol{D} (\\boldsymbol{B}_{col,j})$，其中 $\\boldsymbol{B}_{col,k}$ 是 $\\boldsymbol{B}$ 的第 $k$ 列。\n所以，$K^e_{13} = A_e t (\\boldsymbol{B}_{col,1})^T \\boldsymbol{D} (\\boldsymbol{B}_{col,3})$。\n所需的 $\\boldsymbol{B}$ 矩阵的列向量是：\n$$\n\\boldsymbol{B}_{col,1} = \\begin{pmatrix} -\\frac{10}{3} \\\\ 0 \\\\ -5 \\end{pmatrix}, \\quad \\boldsymbol{B}_{col,3} = \\begin{pmatrix} \\frac{10}{3} \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n我们计算乘积 $(\\boldsymbol{B}_{col,1})^T \\boldsymbol{D} (\\boldsymbol{B}_{col,3})$：\n$$\n\\begin{pmatrix} -\\frac{10}{3} & 0 & -5 \\end{pmatrix} \\frac{E}{(1+\\nu)(1-2\\nu)} \\begin{pmatrix}\n1-\\nu & \\nu & 0 \\\\\n\\nu & 1-\\nu & 0 \\\\\n0 & 0 & \\frac{1-2\\nu}{2}\n\\end{pmatrix} \\begin{pmatrix} \\frac{10}{3} \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n首先，计算 $\\boldsymbol{D}$ 和 $\\boldsymbol{B}_{col,3}$ 的乘积：\n$$\n\\frac{E}{(1+\\nu)(1-2\\nu)} \\begin{pmatrix}\n(1-\\nu)\\frac{10}{3} \\\\\n\\nu\\frac{10}{3} \\\\\n0\n\\end{pmatrix}\n$$\n然后，与 $(\\boldsymbol{B}_{col,1})^T$ 进行点积：\n$$\n\\frac{E}{(1+\\nu)(1-2\\nu)} \\left[ \\left(-\\frac{10}{3}\\right)(1-\\nu)\\frac{10}{3} + (0)(\\nu)\\frac{10}{3} + (-5)(0) \\right] = -\\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} \\frac{100}{9}\n$$\n最后，我们乘以 $A_e t$：\n$$\nK^e_{13} = (0.03) t \\left( -\\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} \\frac{100}{9} \\right) = \\left(\\frac{3}{100}\\right) t \\left( -\\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} \\frac{100}{9} \\right)\n$$\n$$\nK^e_{13} = -\\frac{3 \\cdot 100}{100 \\cdot 9} \\frac{t E (1-\\nu)}{(1+\\nu)(1-2\\nu)} = -\\frac{1}{3} \\frac{t E (1-\\nu)}{(1+\\nu)(1-2\\nu)}\n$$\n这就是所求刚度矩阵项的最终符号表达式。", "answer": "$$\n\\boxed{-\\frac{t E (1-\\nu)}{3 (1+\\nu) (1-2\\nu)}}\n$$", "id": "2697408"}, {"introduction": "一个完整的有限元模型不仅需要刚度矩阵，还需要对外部载荷的一致性表示。伽辽金方法提供了一种系统性的方式来分配体力与表面力，而非简单地将力集中于节点，从而确保了与所选插值基函数的一致性。本练习聚焦于推导一致节点力向量，即有限元方程组的“右端项” [@problem_id:2697388]。它强调了在处理复杂几何时等参映射的重要性，并演示了如何将物理域上的积分转换到标准单元域上，这是有限元实际应用中的一项关键技能。", "problem": "考虑一个厚度为 $h$ 的恒定平面应力连续体，使用单个四节点双线性等参四边形有限元进行建模。节点坐标分别为 $(x_1,y_1)=(0,0)$、$(x_2,y_2)=(L_x,0)$、$(x_3,y_3)=(L_x,L_y)$ 和 $(x_4,y_4)=(0,L_y)$，局部节点沿周界按常规顺序 $1 \\rightarrow 2 \\rightarrow 3 \\rightarrow 4$ 排列。单位体积力是均匀的，由向量 $\\mathbf{b}=[\\,b_x,\\;b_y\\,]^{\\mathsf{T}}$ 给出。位于 $x=L_x$ 的右边界（即连接节点2和3的边）承受一个均匀的面力向量 $\\bar{\\mathbf{t}}=[\\,\\bar{t}_x,\\;\\bar{t}_y\\,]^{\\mathsf{T}}$。假设为小变形和线性运动学，并使用定义在父单元正方形 $\\{(\\xi,\\eta):\\,-1\\le \\xi,\\eta \\le 1\\}$ 上的标准双线性等参形函数。\n\n仅从虚功原理和 Galerkin 方法（其中虚位移场与位移场采用相同的形函数进行插值）出发，推导与体积力和边界面力相关的等效单元节点力。明确展示在等参映射下，体积分和边积分是如何变换的，包括用于面积测度的雅可比行列式和用于边界测度的一维边雅可比。然后，对此特定矩形单元和给定的均匀数据，计算这些变换后的积分，从而得到按 $[\\,F_{1x},\\,F_{1y},\\,F_{2x},\\,F_{2y},\\,F_{3x},\\,F_{3y},\\,F_{4x},\\,F_{4y}\\,]$ 顺序排列的组合八分量单元节点力向量的闭式表达式。\n\n最终答案需以 $L_x$、$L_y$、$h$、$b_x$、$b_y$、$\\bar{t}_x$ 和 $\\bar{t}_y$ 的符号函数形式表示。无需进行数值计算。最终方框内的答案不应包含单位。", "solution": "该问题是应用 Galerkin 有限元法在线性弹性力学中确定由外载荷引起的等效节点力的一个标准案例。该问题在科学上是合理的、适定的，并包含了获得唯一解所需的所有信息。我们开始进行推导。\n\n虚功原理指出，对于一个处于平衡状态的物体，外力所做的虚功 $\\delta W_{ext}$ 等于内应力所做的虚功（虚应变能）$\\delta W_{int}$。外虚功由体积力 $\\mathbf{b}$ 在体积 $V$ 上所做的功和指定面力边界 $\\Gamma_t$ 上的面力 $\\bar{\\mathbf{t}}$ 所做的功之和给出。\n$$ \\delta W_{ext} = \\int_V \\delta\\mathbf{u}^{\\mathsf{T}} \\mathbf{b} \\, dV + \\int_{\\Gamma_t} \\delta\\mathbf{u}^{\\mathsf{T}} \\bar{\\mathbf{t}} \\, d\\Gamma $$\n在此，$\\delta\\mathbf{u}$ 是一个任意的、运动学上允许的虚位移场。\n\n在 Galerkin 有限元列式中，单元内的位移场 $\\mathbf{u}$ 和虚位移场 $\\delta\\mathbf{u}$ 是通过使用相同的形函数，由节点位移 $\\mathbf{d}$ 和虚节点位移 $\\delta\\mathbf{d}$ 插值得到的。\n$$ \\mathbf{u}(\\mathbf{x}) = \\mathbf{N}(\\mathbf{x}) \\mathbf{d} $$\n$$ \\delta\\mathbf{u}(\\mathbf{x}) = \\mathbf{N}(\\mathbf{x}) \\delta\\mathbf{d} $$\n一个四节点二维单元的形函数矩阵 $\\mathbf{N}$ 为\n$$ \\mathbf{N} = \\begin{bmatrix} N_1 & 0 & N_2 & 0 & N_3 & 0 & N_4 & 0 \\\\ 0 & N_1 & 0 & N_2 & 0 & N_3 & 0 & N_4 \\end{bmatrix} $$\n单元节点位移向量为 $\\mathbf{d} = [u_1, v_1, u_2, v_2, u_3, v_3, u_4, v_4]^{\\mathsf{T}}$ 和 $\\delta\\mathbf{d} = [\\delta u_1, \\delta v_1, \\dots, \\delta v_4]^{\\mathsf{T}}$。\n\n将插值后的虚位移代入 $\\delta W_{ext}$ 的表达式中，得到：\n$$ \\delta W_{ext} = \\int_V (\\mathbf{N} \\delta\\mathbf{d})^{\\mathsf{T}} \\mathbf{b} \\, dV + \\int_{\\Gamma_t} (\\mathbf{N} \\delta\\mathbf{d})^{\\mathsf{T}} \\bar{\\mathbf{t}} \\, d\\Gamma $$\n$$ \\delta W_{ext} = \\delta\\mathbf{d}^{\\mathsf{T}} \\left( \\int_V \\mathbf{N}^{\\mathsf{T}} \\mathbf{b} \\, dV + \\int_{\\Gamma_t} \\mathbf{N}^{\\mathsf{T}} \\bar{\\mathbf{t}} \\, d\\Gamma \\right) $$\n根据定义，$\\delta W_{ext} = \\delta\\mathbf{d}^{\\mathsf{T}} \\mathbf{F}_{ext}$，其中 $\\mathbf{F}_{ext}$ 是等效单元节点力向量。由于 $\\delta\\mathbf{d}$ 是任意的，我们可以将 $\\mathbf{F}_{ext}$ 确定为：\n$$ \\mathbf{F}_{ext} = \\mathbf{F}_b + \\mathbf{F}_t = \\int_V \\mathbf{N}^{\\mathsf{T}} \\mathbf{b} \\, dV + \\int_{\\Gamma_t} \\mathbf{N}^{\\mathsf{T}} \\bar{\\mathbf{t}} \\, d\\Gamma $$\n其中 $\\mathbf{F}_b$ 是体积力的贡献，$\\mathbf{F}_t$ 是面力的贡献。\n\n该问题使用了一个四节点双线性等参单元。这意味着几何形状是使用与位移场相同的形函数从父单元正方形域 $\\{(\\xi,\\eta) : -1 \\le \\xi,\\eta \\le 1\\}$ 映射得到的。\n形函数为：\n$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\n坐标映射由 $x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i$ 和 $y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i$ 给出。此变换的雅可比矩阵为\n$$ \\mathbf{J} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} = \\begin{bmatrix} \\sum \\frac{\\partial N_i}{\\partial \\xi} x_i & \\sum \\frac{\\partial N_i}{\\partial \\xi} y_i \\\\ \\sum \\frac{\\partial N_i}{\\partial \\eta} x_i & \\sum \\frac{\\partial N_i}{\\partial \\eta} y_i \\end{bmatrix} $$\n使用给定的节点坐标 $(x_1,y_1)=(0,0)$、$(x_2,y_2)=(L_x,0)$、$(x_3,y_3)=(L_x,L_y)$、$(x_4,y_4)=(0,L_y)$：\n$\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4} \\left[ -(1-\\eta)x_1 + (1-\\eta)x_2 + (1+\\eta)x_3 - (1+\\eta)x_4 \\right] = \\frac{1}{4} \\left[ 0 + (1-\\eta)L_x + (1+\\eta)L_x - 0 \\right] = \\frac{L_x}{2}$\n$\\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4} \\left[ -(1-\\eta)y_1 + (1-\\eta)y_2 + (1+\\eta)y_3 - (1+\\eta)y_4 \\right] = \\frac{1}{4} \\left[ 0 + 0 + (1+\\eta)L_y - (1+\\eta)L_y \\right] = 0$\n$\\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4} \\left[ -(1-\\xi)x_1 - (1+\\xi)x_2 + (1+\\xi)x_3 + (1-\\xi)x_4 \\right] = \\frac{1}{4} \\left[ 0 - (1+\\xi)L_x + (1+\\xi)L_x + 0 \\right] = 0$\n$\\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4} \\left[ -(1-\\xi)y_1 - (1+\\xi)y_2 + (1+\\xi)y_3 + (1-\\xi)y_4 \\right] = \\frac{1}{4} \\left[ 0 - 0 + (1+\\xi)L_y + (1-\\xi)L_y \\right] = \\frac{L_y}{2}$\n因此，对于这个矩形单元，雅可比矩阵是一个常数：\n$$ \\mathbf{J} = \\begin{bmatrix} L_x/2 & 0 \\\\ 0 & L_y/2 \\end{bmatrix} $$\n其行列式为 $\\det(\\mathbf{J}) = \\frac{L_x L_y}{4}$。体积微元变换为 $dV = h \\, dA = h \\det(\\mathbf{J}) d\\xi d\\eta = \\frac{h L_x L_y}{4} d\\xi d\\eta$。\n\n首先，我们计算体积力向量 $\\mathbf{F}_b$：\n$$ \\mathbf{F}_b = \\int_V \\mathbf{N}^{\\mathsf{T}} \\mathbf{b} \\, dV = \\int_{-1}^{1} \\int_{-1}^{1} \\mathbf{N}(\\xi, \\eta)^{\\mathsf{T}} \\mathbf{b} \\, h \\det(\\mathbf{J}) d\\xi d\\eta $$\n由于 $\\mathbf{b}$、$h$ 和 $\\det(\\mathbf{J})$ 都是常数，计算得以简化。节点 $i$ 的力分量为：\n$$ \\mathbf{F}_{ib} = \\begin{bmatrix} F_{ibx} \\\\ F_{iby} \\end{bmatrix} = \\left( \\int_V N_i dV \\right) \\mathbf{b} = h \\det(\\mathbf{J}) \\left( \\int_{-1}^{1} \\int_{-1}^{1} N_i(\\xi, \\eta) d\\xi d\\eta \\right) \\mathbf{b} $$\n对于任意一个双线性形函数，其在父单元上的积分值为1。例如，对于 $N_1$：\n$$ \\int_{-1}^{1} \\int_{-1}^{1} N_1 d\\xi d\\eta = \\int_{-1}^{1} \\int_{-1}^{1} \\frac{1}{4}(1-\\xi)(1-\\eta) d\\xi d\\eta = \\frac{1}{4} \\left( \\int_{-1}^{1} (1-\\xi) d\\xi \\right) \\left( \\int_{-1}^{1} (1-\\eta) d\\eta \\right) = \\frac{1}{4}(2)(2) = 1 $$\n因此，$\\int_V N_i dV = h \\frac{L_x L_y}{4} (1) = \\frac{h L_x L_y}{4}$。这意味着单元上的总体积力 $\\mathbf{b} (h L_x L_y)$ 被平均分配到四个节点上。\n$$ \\mathbf{F}_{ib} = \\frac{h L_x L_y}{4} \\begin{bmatrix} b_x \\\\ b_y \\end{bmatrix} \\quad \\text{对于 } i=1, 2, 3, 4 $$\n\n接下来，我们计算面力向量 $\\mathbf{F}_t$。面力 $\\bar{\\mathbf{t}}$ 作用在连接节点2和3的边 $x=L_x$ 上。在父域中，这对应于 $-1 \\le \\eta \\le 1$ 时的边 $\\xi=1$。\n积分是在施加面力的表面区域 $\\Gamma_t$ 上进行的。面积微元 $d\\Gamma$ 为 $h\\,ds$，其中 $ds$ 是弧长微元。其变换关系为 $ds = \\sqrt{(\\frac{dx}{d\\eta})^2 + (\\frac{dy}{d\\eta})^2} \\, d\\eta$。我们将该平方根因子称为一维边雅可比 $J_{1D}$。\n在 $\\xi=1$ 的边上，映射为 $x(\\eta) = L_x$ 和 $y(\\eta) = \\frac{L_y}{2}(1+\\eta)$。关于 $\\eta$ 的导数是 $\\frac{dx}{d\\eta}=0$ 和 $\\frac{dy}{d\\eta}=\\frac{L_y}{2}$。边雅可比为 $J_{1D} = \\sqrt{0^2 + (L_y/2)^2} = \\frac{L_y}{2}$。所以，$d\\Gamma = h J_{1D} d\\eta = \\frac{h L_y}{2} d\\eta$。\n面力向量为：\n$$ \\mathbf{F}_t = \\int_{\\Gamma_t} \\mathbf{N}^{\\mathsf{T}} \\bar{\\mathbf{t}} \\, d\\Gamma = \\int_{-1}^{1} \\mathbf{N}(\\xi=1, \\eta)^{\\mathsf{T}} \\bar{\\mathbf{t}} \\, \\frac{h L_y}{2} d\\eta $$\n在 $\\xi=1$ 的边上，形函数 $N_1$ 和 $N_4$ 恒为零。只有 $N_2$ 和 $N_3$ 有贡献。\n$N_2(1, \\eta) = \\frac{1}{2}(1-\\eta)$ 和 $N_3(1, \\eta) = \\frac{1}{2}(1+\\eta)$。\n对节点2的力贡献为：\n$$ \\mathbf{F}_{2t} = \\left( \\int_{-1}^{1} N_2(1, \\eta) \\frac{h L_y}{2} d\\eta \\right) \\bar{\\mathbf{t}} = \\frac{h L_y}{2} \\left( \\int_{-1}^{1} \\frac{1}{2}(1-\\eta) d\\eta \\right) \\bar{\\mathbf{t}} = \\frac{h L_y}{4} [\\eta - \\frac{\\eta^2}{2}]_{-1}^{1} \\bar{\\mathbf{t}} = \\frac{h L_y}{4} (2) \\bar{\\mathbf{t}} = \\frac{h L_y}{2} \\bar{\\mathbf{t}} $$\n对节点3的力贡献为：\n$$ \\mathbf{F}_{3t} = \\left( \\int_{-1}^{1} N_3(1, \\eta) \\frac{h L_y}{2} d\\eta \\right) \\bar{\\mathbf{t}} = \\frac{h L_y}{2} \\left( \\int_{-1}^{1} \\frac{1}{2}(1+\\eta) d\\eta \\right) \\bar{\\mathbf{t}} = \\frac{h L_y}{4} [\\eta + \\frac{\\eta^2}{2}]_{-1}^{1} \\bar{\\mathbf{t}} = \\frac{h L_y}{4} (2) \\bar{\\mathbf{t}} = \\frac{h L_y}{2} \\bar{\\mathbf{t}} $$\n节点1和4不受该边上面力的作用。这在物理上意味着总面力 $\\bar{\\mathbf{t}} (h L_y)$ 被平均分配到该边上的两个节点之间。\n\n最后，我们通过将每个分量的体积力贡献和面力贡献相加，来组合得到总节点力向量 $\\mathbf{F} = [F_{1x}, F_{1y}, \\dots, F_{4y}]^{\\mathsf{T}}$。\n\n$F_{1x} = F_{1bx} + F_{1tx} = \\frac{h L_x L_y}{4} b_x + 0 = \\frac{h L_x L_y}{4} b_x$\n$F_{1y} = F_{1by} + F_{1ty} = \\frac{h L_x L_y}{4} b_y + 0 = \\frac{h L_x L_y}{4} b_y$\n\n$F_{2x} = F_{2bx} + F_{2tx} = \\frac{h L_x L_y}{4} b_x + \\frac{h L_y}{2} \\bar{t}_x$\n$F_{2y} = F_{2by} + F_{2ty} = \\frac{h L_x L_y}{4} b_y + \\frac{h L_y}{2} \\bar{t}_y$\n\n$F_{3x} = F_{3bx} + F_{3tx} = \\frac{h L_x L_y}{4} b_x + \\frac{h L_y}{2} \\bar{t}_x$\n$F_{3y} = F_{3by} + F_{3ty} = \\frac{h L_x L_y}{4} b_y + \\frac{h L_y}{2} \\bar{t}_y$\n\n$F_{4x} = F_{4bx} + F_{4tx} = \\frac{h L_x L_y}{4} b_x + 0 = \\frac{h L_x L_y}{4} b_x$\n$F_{4y} = F_{4by} + F_{4ty} = \\frac{h L_x L_y}{4} b_y + 0 = \\frac{h L_x L_y}{4} b_y$\n\n这就构成了完整的八分量单元节点力向量。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{h L_x L_y}{4} b_x & \\frac{h L_x L_y}{4} b_y & \\frac{h L_x L_y}{4} b_x + \\frac{h L_y}{2} \\bar{t}_x & \\frac{h L_x L_y}{4} b_y + \\frac{h L_y}{2} \\bar{t}_y & \\frac{h L_x L_y}{4} b_x + \\frac{h L_y}{2} \\bar{t}_x & \\frac{h L_x L_y}{4} b_y + \\frac{h L_y}{2} \\bar{t}_y & \\frac{h L_x L_y}{4} b_x & \\frac{h L_x L_y}{4} b_y\n\\end{pmatrix}\n}\n$$", "id": "2697388"}, {"introduction": "在根据前面练习中的原理开发出有限元代码后，我们如何确定其正确性？精确解方法（Method of Manufactured Solutions, MMS）是一种用于测试数值求解器准确性和正确性的严谨验证技术。本练习将介绍精确解方法这一强大的代码验证工具 [@problem_id:2697376]。您将从一个预设的“精确”解出发，反向推导出使其成为精确解所必需的体力项和边界条件，从而构建一个具有已知答案的非平凡问题来测试您的代码，这一实践弥合了理论构建与可靠计算实践之间的鸿沟。", "problem": "一根长度为 $L=1\\,\\mathrm{m}$ 的细长直弹性杆占据参考区间 $\\Omega=(0,1)$。设轴向位移场由 $u(x)$ 表示。轴向合力为 $N(x)=E(x)A(x)\\,u'(x)$，其中 $E(x)$ 是杨氏模量，$A(x)$ 是横截面积，撇号表示对 $x$ 求导。假设为线性运动学和线弹性。在 $\\Omega$ 内，带体力密度 $b(x)$（单位参考长度上的力）的一维平衡强形式为 $-N'(x)=b(x)$。本质边界条件和自然边界条件可分别在 $x=0$ 和 $x=1$ 处指定。\n\n考虑变化的材料和几何属性 $E(x)=E_{0}(1+x)$（其中 $E_{0}>0$）和 $A(x)=A_{0}(1+x^{2})$（其中 $A_{0}>0$）。令构造位移为\n$$\nu^{\\star}(x)=\\exp(x)-1+x^{2}(1-x)=\\exp(x)-1+x^{2}-x^{3},\n$$\n该位移满足本质边界条件 $u^{\\star}(0)=0$。需要定制载荷和边界数据，使得 $u^{\\star}$ 是一个精确的弱解，从而对于任何容许的检验函数，伽辽金残差为零。\n\n任务：\n- 从一维平衡律和 $N(x)$ 的本构方程出发，写出适用于标准伽辽金法的平衡弱形式，其中检验函数 $v\\in H^{1}(\\Omega)$ 满足 $v(0)=0$。\n- 使用针对弱形式定制的构造解法，确定体力密度 $b(x)$（单位：$\\mathrm{N/m}$）和在 $x=1$ 处的诺伊曼边界牵引力 $\\bar{t}$（单位：$\\mathrm{N}$），使得 $u^{\\star}$ 在强制施加本质边界条件 $u(0)=0$ 的情况下精确满足弱形式。\n- 所做的构造必须确保对于所有容许的 $v$，伽辽金残差恒等于零。\n- 提供 $b(x)$ 和 $\\bar{t}$ 的精确解析表达式，并证明对于弱形式的每一个容许的 $v$，伽辽金残差都为零。\n\n答案规格：\n- 以数对 $\\big(b(x),\\,\\bar{t}\\big)$ 的形式报告您的最终答案。\n- 将 $b(x)$ 以 $\\mathrm{N/m}$ 为单位表示，$\\bar{t}$ 以 $\\mathrm{N}$ 为单位表示。不要将任何常数转换为小数形式。\n- 无需四舍五入；提供精确表达式。", "solution": "问题陈述需进行验证。\n\n逐字提取给定条件：\n- 杆长：$L=1\\,\\mathrm{m}$。\n- 参考区间：$\\Omega=(0,1)$。\n- 位移场：$u(x)$。\n- 轴向合力：$N(x)=E(x)A(x)\\,u'(x)$。\n- 杨氏模量：$E(x)=E_{0}(1+x)$，其中 $E_{0}>0$。\n- 横截面积：$A(x)=A_{0}(1+x^{2})$，其中 $A_{0}>0$。\n- 平衡强形式：$-N'(x)=b(x)$，在 $\\Omega$ 内。\n- 构造位移：$u^{\\star}(x)=\\exp(x)-1+x^{2}(1-x)=\\exp(x)-1+x^{2}-x^{3}$。\n- 本质边界条件：$u(0)=0$。\n- 伽辽金法的检验函数：$v\\in H^{1}(\\Omega)$，满足 $v(0)=0$。\n- 任务：\n    1.  写出平衡的弱形式。\n    2.  确定体力密度 $b(x)$ 和 $x=1$ 处的诺伊曼边界牵引力 $\\bar{t}$，使得 $u^{\\star}$ 是一个精确的弱解。\n    3.  提供 $b(x)$ 和 $\\bar{t}$ 的表达式，并证明伽辽金残差为零。\n\n该问题具有科学依据，是适定的、客观的。它描述了一维线弹性中的一个标准问题，并利用了构造解法，这是计算力学中一种标准的验证技术。所有提供的数据和定义在数学上是一致的，并且足以构造出所需量 $b(x)$ 和 $\\bar{t}$ 的唯一解。该问题不违反任何基本原理，且没有歧义。因此，该问题被认定为有效。\n\n控制方程的弱形式是通过将平衡的强形式 $-N'(x)=b(x)$ 乘以一个合适的检验函数 $v(x)$ 并在域 $\\Omega=(0,1)$ 上积分得到的。试验解空间为 $U = \\{u \\in H^{1}(\\Omega) \\mid u(0)=0\\}$，检验函数空间为 $V = \\{v \\in H^{1}(\\Omega) \\mid v(0)=0\\}$。\n\n$$ \\int_{0}^{1} -N'(x) v(x) \\,dx = \\int_{0}^{1} b(x) v(x) \\,dx $$\n对左侧应用分部积分法得到：\n$$ \\int_{0}^{1} N(x) v'(x) \\,dx - [N(x) v(x)]_{0}^{1} = \\int_{0}^{1} b(x) v(x) \\,dx $$\n边界项为 $[N(1)v(1) - N(0)v(0)]$。由于 $v \\in V$，我们有 $v(0)=0$。$x=1$ 处的项代表自然边界条件，其中轴向力 $N(1)$ 由指定的牵引力 $\\bar{t}$ 平衡。因此，$N(1)=\\bar{t}$。边界项变为 $\\bar{t}v(1)$。\n将此代入方程并重新整理，得到弱形式：求 $u \\in U$，使得对于所有 $v \\in V$ 都满足，\n$$ \\int_{0}^{1} N(x) v'(x) \\,dx = \\int_{0}^{1} b(x) v(x) \\,dx + \\bar{t}v(1) $$\n使用本构关系 $N(x) = E(x)A(x)u'(x)$，弱形式为：\n$$ \\int_{0}^{1} E(x)A(x) u'(x) v'(x) \\,dx = \\int_{0}^{1} b(x) v(x) \\,dx + \\bar{t}v(1) $$\n\n为了找到使 $u^{\\star}(x)$ 成为精确解的体力 $b(x)$ 和牵引力 $\\bar{t}$，我们使用构造解法。该方法强制 $u^{\\star}(x)$ 精确地满足强形式和自然边界条件，从而定义了所需的载荷。\n\n体力由强形式定义：\n$b(x) = - (N^{\\star})'(x)$，其中 $N^{\\star}(x) = E(x)A(x)(u^{\\star})'(x)$。\n牵引力由自然边界条件定义：\n$\\bar{t} = N^{\\star}(1)$。\n\n首先，我们计算构造解 $u^{\\star}(x) = \\exp(x)-1+x^{2}-x^{3}$ 的导数：\n$$ (u^{\\star})'(x) = \\frac{d}{dx}(\\exp(x)-1+x^{2}-x^{3}) = \\exp(x)+2x-3x^{2} $$\n接下来，我们求出与 $u^{\\star}(x)$ 对应的轴向力 $N^{\\star}(x)$：\n$$ N^{\\star}(x) = E(x)A(x)(u^{\\star})'(x) = E_{0}(1+x) A_{0}(1+x^{2}) (\\exp(x)+2x-3x^{2}) $$\n$$ N^{\\star}(x) = E_{0}A_{0}(1+x+x^{2}+x^{3})(\\exp(x)+2x-3x^{2}) $$\n为求 $b(x)$，我们对 $N^{\\star}(x)$ 求导：\n$b(x) = -(N^{\\star})'(x) = -\\frac{d}{dx} \\left[ E_{0}A_{0}(1+x+x^{2}+x^{3})(\\exp(x)+2x-3x^{2}) \\right]$。\n使用乘法法则，设 $f(x) = 1+x+x^{2}+x^{3}$ 和 $g(x)=\\exp(x)+2x-3x^{2}$：\n$$ \\frac{b(x)}{-E_{0}A_{0}} = f'(x)g(x) + f(x)g'(x) $$\n导数分别为：\n$f'(x) = 1+2x+3x^{2}$\n$g'(x) = \\exp(x)+2-6x$\n将这些代入 $b(x)$ 的表达式中：\n$$ \\frac{b(x)}{-E_{0}A_{0}} = (1+2x+3x^{2})(\\exp(x)+2x-3x^{2}) + (1+x+x^{2}+x^{3})(\\exp(x)+2-6x) $$\n将带有 $\\exp(x)$ 的项和多项式项分组：\n$$ \\frac{b(x)}{-E_{0}A_{0}} = [(1+2x+3x^{2})+(1+x+x^{2}+x^{3})]\\exp(x) + (1+2x+3x^{2})(2x-3x^{2}) + (1+x+x^{2}+x^{3})(2-6x) $$\n$\\exp(x)$ 的系数是 $(x^{3}+4x^{2}+3x+2)$。\n多项式部分为：\n$(2x+4x^{2}+6x^{3}-3x^{2}-6x^{3}-9x^{4}) + (2+2x+2x^{2}+2x^{3}-6x-6x^{2}-6x^{3}-6x^{4})$\n$= (2x+x^{2}-9x^{4}) + (2-4x-4x^{2}-4x^{3}-6x^{4})$\n$= 2-2x-3x^{2}-4x^{3}-15x^{4}$\n合并所有项：\n$$ b(x) = -E_{0}A_{0} \\left[ (x^{3}+4x^{2}+3x+2)\\exp(x) - 15x^{4}-4x^{3}-3x^{2}-2x+2 \\right] $$\n或者，写成更标准的形式：\n$$ b(x) = E_{0}A_{0} \\left[ 15x^{4}+4x^{3}+3x^{2}+2x-2 - (x^{3}+4x^{2}+3x+2)\\exp(x) \\right] $$\n现在，我们计算牵引力 $\\bar{t} = N^{\\star}(1)$：\n$$ \\bar{t} = E_{0}A_{0}(1+1+1^{2}+1^{3})(\\exp(1)+2(1)-3(1^{2})) $$\n$$ \\bar{t} = E_{0}A_{0}(4)(\\exp(1)-1) = 4E_{0}A_{0}(\\exp(1)-1) $$\n最后，我们必须证明对于任何容许的 $v(x)$，伽辽金残差恒等于零。$u^{\\star}$ 的残差为：\n$$ R(u^{\\star}, v) = \\int_{0}^{1} E(x)A(x)(u^{\\star})'(x) v'(x) \\,dx - \\int_{0}^{1} b(x) v(x) \\,dx - \\bar{t}v(1) $$\n第一项是 $\\int_{0}^{1} N^{\\star}(x) v'(x) \\,dx$。我们再次使用分部积分法：\n$$ \\int_{0}^{1} N^{\\star}(x) v'(x) \\,dx = [N^{\\star}(x)v(x)]_{0}^{1} - \\int_{0}^{1} (N^{\\star})'(x) v(x) \\,dx $$\n这等于 $N^{\\star}(1)v(1) - N^{\\star}(0)v(0) - \\int_{0}^{1} (N^{\\star})'(x) v(x) \\,dx$。由于 $v(0)=0$：\n$$ \\int_{0}^{1} N^{\\star}(x) v'(x) \\,dx = N^{\\star}(1)v(1) - \\int_{0}^{1} (N^{\\star})'(x) v(x) \\,dx $$\n根据我们的构造，$\\bar{t} = N^{\\star}(1)$ 且 $b(x) = -(N^{\\star})'(x)$。代入这些定义：\n$$ \\int_{0}^{1} E(x)A(x)(u^{\\star})'(x) v'(x) \\,dx = \\bar{t}v(1) - \\int_{0}^{1} (-b(x)) v(x) \\,dx = \\bar{t}v(1) + \\int_{0}^{1} b(x) v(x) \\,dx $$\n将此结果代入残差表达式：\n$$ R(u^{\\star}, v) = \\left( \\bar{t}v(1) + \\int_{0}^{1} b(x) v(x) \\,dx \\right) - \\left( \\int_{0}^{1} b(x) v(x) \\,dx + \\bar{t}v(1) \\right) = 0 $$\n这证明对于所推导的 $b(x)$ 和 $\\bar{t}$，弱形式被 $u^{\\star}(x)$ 对所有容许的检验函数 $v(x)$ 精确满足，且伽辽金残差恒等于零。\n\n最终表达式为：\n对于体力密度 $b(x)$：\n$b(x) = E_{0}A_{0} \\left[ 15x^{4}+4x^{3}+3x^{2}+2x-2 - (x^{3}+4x^{2}+3x+2)\\exp(x) \\right]$\n对于边界牵引力 $\\bar{t}$：\n$\\bar{t} = 4E_{0}A_{0}(\\exp(1)-1)$", "answer": "$$\n\\boxed{\\begin{pmatrix} E_{0}A_{0} \\left[ 15x^{4}+4x^{3}+3x^{2}+2x-2 - (x^{3}+4x^{2}+3x+2)\\exp(x) \\right] & 4E_{0}A_{0}(\\exp(1)-1) \\end{pmatrix}}\n$$", "id": "2697376"}]}