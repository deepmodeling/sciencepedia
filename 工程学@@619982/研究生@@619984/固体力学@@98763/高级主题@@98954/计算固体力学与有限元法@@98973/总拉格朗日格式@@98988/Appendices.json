{"hands_on_practices": [{"introduction": "在总拉格朗日（Total Lagrangian, TL）列式中，将连续体的虚功原理转化为离散的有限元方程是核心步骤之一。本练习旨在提供一个具体的计算实践：为一个简单的二维四节点单元计算其内部节点力向量。这个过程将理论（参考构型中的虚功原理）与数值实现（利用形函数、高斯积分和第一皮奥拉-基尔霍夫应力）直接联系起来，是理解和开发非线性有限元程序的基础。[@problem_id:2705835]", "problem": "考虑一个在总拉格朗日列式下的平面应变问题中的单个四节点双线性四边形有限元。该单元在参考构型中的节点坐标（单位：米）按逆时针顺序定义如下：节点 $1$ 位于 $(X_{1},Y_{1})=(0,0)$，节点 $2$ 位于 $(X_{2},Y_{2})=(2,0)$，节点 $3$ 位于 $(X_{3},Y_{3})=(2,1)$，节点 $4$ 位于 $(X_{4},Y_{4})=(0,1)$。在母域 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 上使用标准的双线性形函数，\n$$\nN_{1}(\\xi,\\eta)=\\frac{(1-\\xi)(1-\\eta)}{4},\\quad\nN_{2}(\\xi,\\eta)=\\frac{(1+\\xi)(1-\\eta)}{4},\\quad\nN_{3}(\\xi,\\eta)=\\frac{(1+\\xi)(1+\\eta)}{4},\\quad\nN_{4}(\\xi,\\eta)=\\frac{(1-\\xi)(1+\\eta)}{4}.\n$$\n假设单位平面外厚度为 $t=1$（单位：米）。该单元在母正方形上使用位于 $(\\xi,\\eta)=(0,0)$ 的单个高斯积分点进行积分，权重为 $w=4$。在该高斯点处，第一皮奥拉-基尔霍夫应力张量（单位：帕斯卡）为\n$$\n\\mathbf{P}=\\begin{pmatrix}3 & 1\\\\ 2 & 4\\end{pmatrix}.\n$$\n从参考构型中的虚功原理和第一皮奥拉-基尔霍夫应力的定义出发，推导与该高斯点相关的节点内力贡献，并进行显式计算。作为中间步骤，计算在 $(\\xi,\\eta)=(0,0)$ 处，形函数相对于参考坐标（材料梯度）的梯度 $\\,\\nabla_{0}N_{a}\\,$ 的显式表达式，其中 $a\\in\\{1,2,3,4\\}$。然后，组装成按 $\\big(f_{1x},f_{1y},f_{2x},f_{2y},f_{3x},f_{3y},f_{4x},f_{4y}\\big)$ 顺序排列的 8 分量节点内力向量。\n\n提供精确值（不要四舍五入）。以牛顿为单位表示最终的内力向量。仅报告最终的内力向量作为你的答案。", "solution": "总拉格朗日列式在参考构型中表达内虚功。参考构型中的虚功原理可写作\n$$\n\\delta W_{\\text{int}}=\\int_{\\Omega_{0}}\\mathbf{P}:\\nabla_{0}\\delta\\mathbf{u}\\, \\mathrm{d}V_{0},\n$$\n其中 $\\mathbf{P}$ 是第一皮奥拉-基尔霍夫应力张量，$\\nabla_{0}$ 表示相对于参考（材料）坐标的梯度，$\\delta\\mathbf{u}$ 是虚位移场。使用有限元法（FEM），虚位移插值为\n$$\n\\delta\\mathbf{u}(\\mathbf{X})=\\sum_{a=1}^{4}N_{a}(\\mathbf{X})\\,\\delta\\mathbf{d}_{a},\n$$\n其中 $\\delta\\mathbf{d}_{a}$ 是节点虚位移向量。因此，\n$$\n\\nabla_{0}\\delta\\mathbf{u}=\\sum_{a=1}^{4}\\delta\\mathbf{d}_{a}\\otimes\\nabla_{0}N_{a}.\n$$\n代入 $\\delta W_{\\text{int}}$ 并使用双点积恒等式 $\\mathbf{A}:(\\mathbf{b}\\otimes\\mathbf{c})=(\\mathbf{A}\\mathbf{c})\\cdot\\mathbf{b}$，得到\n$$\n\\delta W_{\\text{int}}=\\sum_{a=1}^{4}\\delta\\mathbf{d}_{a}\\cdot\\left(\\int_{\\Omega_{0}}\\mathbf{P}\\,\\nabla_{0}N_{a}\\,\\mathrm{d}V_{0}\\right).\n$$\n根据节点内力 $\\mathbf{f}_{a}^{\\text{int}}$ 的定义，可得\n$$\n\\mathbf{f}_{a}^{\\text{int}}=\\int_{\\Omega_{0}}\\mathbf{P}\\,\\nabla_{0}N_{a}\\,\\mathrm{d}V_{0}.\n$$\n使用高斯积分，一个高斯点的贡献为\n$$\n\\mathbf{f}_{a,\\text{gp}}^{\\text{int}}=\\mathbf{P}\\,\\nabla_{0}N_{a}\\,J_{0}\\,w\\,t,\n$$\n其中 $J_{0}=\\det\\left(\\frac{\\partial\\mathbf{X}}{\\partial(\\xi,\\eta)}\\right)$ 是在高斯点处计算的从 $(\\xi,\\eta)$到 $(X,Y)$ 的雅可比映射的行列式，$w$ 是积分权重，$t$ 是厚度。\n\n我们现在计算在 $(\\xi,\\eta)=(0,0)$ 处的 $\\nabla_{0}N_{a}$。首先，计算在 $(0,0)$ 处的母空间导数。对于标准的双线性形函数，\n$$\n\\frac{\\partial N_{1}}{\\partial \\xi}=-\\frac{1-\\eta}{4},\\quad \\frac{\\partial N_{1}}{\\partial \\eta}=-\\frac{1-\\xi}{4},\\quad\n\\frac{\\partial N_{2}}{\\partial \\xi}= \\frac{1-\\eta}{4},\\quad \\frac{\\partial N_{2}}{\\partial \\eta}=-\\frac{1+\\xi}{4},\n$$\n$$\n\\frac{\\partial N_{3}}{\\partial \\xi}= \\frac{1+\\eta}{4},\\quad \\frac{\\partial N_{3}}{\\partial \\eta}= \\frac{1+\\xi}{4},\\quad\n\\frac{\\partial N_{4}}{\\partial \\xi}=-\\frac{1+\\eta}{4},\\quad \\frac{\\partial N_{4}}{\\partial \\eta}= \\frac{1-\\xi}{4}.\n$$\n在 $(\\xi,\\eta)=(0,0)$ 处计算，得到\n$$\n\\left.\\frac{\\partial N_{1}}{\\partial \\xi}\\right|_{0}=-\\frac{1}{4},\\quad \\left.\\frac{\\partial N_{1}}{\\partial \\eta}\\right|_{0}=-\\frac{1}{4},\\quad\n\\left.\\frac{\\partial N_{2}}{\\partial \\xi}\\right|_{0}= \\frac{1}{4},\\quad \\left.\\frac{\\partial N_{2}}{\\partial \\eta}\\right|_{0}=-\\frac{1}{4},\n$$\n$$\n\\left.\\frac{\\partial N_{3}}{\\partial \\xi}\\right|_{0}= \\frac{1}{4},\\quad \\left.\\frac{\\partial N_{3}}{\\partial \\eta}\\right|_{0}= \\frac{1}{4},\\quad\n\\left.\\frac{\\partial N_{4}}{\\partial \\xi}\\right|_{0}=-\\frac{1}{4},\\quad \\left.\\frac{\\partial N_{4}}{\\partial \\eta}\\right|_{0}= \\frac{1}{4}.\n$$\n接下来，计算在高斯点处的雅可比矩阵 $\\mathbf{J}=\\frac{\\partial\\mathbf{X}}{\\partial(\\xi,\\eta)}$。使用 $\\mathbf{X}(\\xi,\\eta)=\\sum_{a=1}^{4}N_{a}(\\xi,\\eta)\\mathbf{X}_{a}$，\n$$\n\\mathbf{J}=\n\\begin{pmatrix}\n\\displaystyle \\sum_{a=1}^{4}\\frac{\\partial N_{a}}{\\partial \\xi}X_{a} & \\displaystyle \\sum_{a=1}^{4}\\frac{\\partial N_{a}}{\\partial \\eta}X_{a}\\\\\n\\displaystyle \\sum_{a=1}^{4}\\frac{\\partial N_{a}}{\\partial \\xi}Y_{a} & \\displaystyle \\sum_{a=1}^{4}\\frac{\\partial N_{a}}{\\partial \\eta}Y_{a}\n\\end{pmatrix}.\n$$\n利用 $(X_{1},Y_{1})=(0,0)$、$(X_{2},Y_{2})=(2,0)$、$(X_{3},Y_{3})=(2,1)$、$(X_{4},Y_{4})=(0,1)$ 以及在 $(0,0)$ 处的导数，\n$$\n\\mathbf{J}=\n\\begin{pmatrix}\n-\\frac{1}{4}\\cdot 0+\\frac{1}{4}\\cdot 2+\\frac{1}{4}\\cdot 2-\\frac{1}{4}\\cdot 0 & -\\frac{1}{4}\\cdot 0-\\frac{1}{4}\\cdot 2+\\frac{1}{4}\\cdot 2+\\frac{1}{4}\\cdot 0\\\\\n-\\frac{1}{4}\\cdot 0+\\frac{1}{4}\\cdot 0+\\frac{1}{4}\\cdot 1-\\frac{1}{4}\\cdot 1 & -\\frac{1}{4}\\cdot 0-\\frac{1}{4}\\cdot 0+\\frac{1}{4}\\cdot 1+\\frac{1}{4}\\cdot 1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & 0\\\\\n0 & \\frac{1}{2}\n\\end{pmatrix}.\n$$\n因此，\n$$\nJ_{0}=\\det(\\mathbf{J})=\\frac{1}{2},\\qquad \\mathbf{J}^{-1}=\\begin{pmatrix}1 & 0\\\\ 0 & 2\\end{pmatrix},\\qquad \\mathbf{J}^{-T}=\\begin{pmatrix}1 & 0\\\\ 0 & 2\\end{pmatrix}.\n$$\n根据链式法则得到材料梯度，\n$$\n\\nabla_{0}N_{a}=\\mathbf{J}^{-T}\\begin{pmatrix}\\dfrac{\\partial N_{a}}{\\partial \\xi}\\\\ \\dfrac{\\partial N_{a}}{\\partial \\eta}\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & 0\\\\\n0 & 2\n\\end{pmatrix}\n\\begin{pmatrix}\\dfrac{\\partial N_{a}}{\\partial \\xi}\\\\ \\dfrac{\\partial N_{a}}{\\partial \\eta}\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\dfrac{\\partial N_{a}}{\\partial \\xi}\\\\\n2\\,\\dfrac{\\partial N_{a}}{\\partial \\eta}\n\\end{pmatrix}.\n$$\n因此，在 $(\\xi,\\eta)=(0,0)$ 处，\n$$\n\\nabla_{0}N_{1}=\\begin{pmatrix}-\\frac{1}{4}\\\\ -\\frac{1}{2}\\end{pmatrix},\\quad\n\\nabla_{0}N_{2}=\\begin{pmatrix}\\frac{1}{4}\\\\ -\\frac{1}{2}\\end{pmatrix},\\quad\n\\nabla_{0}N_{3}=\\begin{pmatrix}\\frac{1}{4}\\\\ \\frac{1}{2}\\end{pmatrix},\\quad\n\\nabla_{0}N_{4}=\\begin{pmatrix}-\\frac{1}{4}\\\\ \\frac{1}{2}\\end{pmatrix}.\n$$\n现在计算每个节点内力的高斯点贡献：\n$$\n\\mathbf{f}_{a,\\text{gp}}^{\\text{int}}=\\mathbf{P}\\,\\nabla_{0}N_{a}\\,J_{0}\\,w\\,t.\n$$\n首先计算 $\\mathbf{P}\\,\\nabla_{0}N_{a}$：\n$$\n\\mathbf{P}\\,\\nabla_{0}N_{1}=\n\\begin{pmatrix}3 & 1\\\\ 2 & 4\\end{pmatrix}\n\\begin{pmatrix}-\\frac{1}{4}\\\\ -\\frac{1}{2}\\end{pmatrix}\n=\n\\begin{pmatrix}-\\frac{5}{4}\\\\ -\\frac{5}{2}\\end{pmatrix},\n\\quad\n\\mathbf{P}\\,\\nabla_{0}N_{2}=\n\\begin{pmatrix}3 & 1\\\\ 2 & 4\\end{pmatrix}\n\\begin{pmatrix}\\frac{1}{4}\\\\ -\\frac{1}{2}\\end{pmatrix}\n=\n\\begin{pmatrix}\\frac{1}{4}\\\\ -\\frac{3}{2}\\end{pmatrix},\n$$\n$$\n\\mathbf{P}\\,\\nabla_{0}N_{3}=\n\\begin{pmatrix}3 & 1\\\\ 2 & 4\\end{pmatrix}\n\\begin{pmatrix}\\frac{1}{4}\\\\ \\frac{1}{2}\\end{pmatrix}\n=\n\\begin{pmatrix}\\frac{5}{4}\\\\ \\frac{5}{2}\\end{pmatrix},\n\\quad\n\\mathbf{P}\\,\\nabla_{0}N_{4}=\n\\begin{pmatrix}3 & 1\\\\ 2 & 4\\end{pmatrix}\n\\begin{pmatrix}-\\frac{1}{4}\\\\ \\frac{1}{2}\\end{pmatrix}\n=\n\\begin{pmatrix}-\\frac{1}{4}\\\\ \\frac{3}{2}\\end{pmatrix}.\n$$\n当 $J_{0}=\\frac{1}{2}$，$w=4$ 且 $t=1$ 时，标量因子为\n$$\nJ_{0}\\,w\\,t=\\frac{1}{2}\\cdot 4 \\cdot 1=2.\n$$\n因此，\n$$\n\\mathbf{f}_{1,\\text{gp}}^{\\text{int}}=2\\begin{pmatrix}-\\frac{5}{4}\\\\ -\\frac{5}{2}\\end{pmatrix}=\\begin{pmatrix}-\\frac{5}{2}\\\\ -5\\end{pmatrix},\\quad\n\\mathbf{f}_{2,\\text{gp}}^{\\text{int}}=2\\begin{pmatrix}\\frac{1}{4}\\\\ -\\frac{3}{2}\\end{pmatrix}=\\begin{pmatrix}\\frac{1}{2}\\\\ -3\\end{pmatrix},\n$$\n$$\n\\mathbf{f}_{3,\\text{gp}}^{\\text{int}}=2\\begin{pmatrix}\\frac{5}{4}\\\\ \\frac{5}{2}\\end{pmatrix}=\\begin{pmatrix}\\frac{5}{2}\\\\ 5\\end{pmatrix},\\quad\n\\mathbf{f}_{4,\\text{gp}}^{\\text{int}}=2\\begin{pmatrix}-\\frac{1}{4}\\\\ \\frac{3}{2}\\end{pmatrix}=\\begin{pmatrix}-\\frac{1}{2}\\\\ 3\\end{pmatrix}.\n$$\n最后，组装成按 $\\big(f_{1x},f_{1y},f_{2x},f_{2y},f_{3x},f_{3y},f_{4x},f_{4y}\\big)$ 顺序排列的 8 分量节点内力向量：\n$$\n\\begin{pmatrix}\n-\\frac{5}{2} & -5 & \\frac{1}{2} & -3 & \\frac{5}{2} & 5 & -\\frac{1}{2} & 3\n\\end{pmatrix}.\n$$\n这些是精确值；单位是牛顿，因为 $\\mathbf{P}$ 的单位是帕斯卡，$\\nabla_{0}N_{a}$ 的单位是米$^{-1}$，而 $J_{0}\\,w\\,t$ 的贡献是立方米，最终得到力的单位。", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{5}{2} & -5 & \\frac{1}{2} & -3 & \\frac{5}{2} & 5 & -\\frac{1}{2} & 3\\end{pmatrix}}$$", "id": "2705835"}, {"introduction": "求解非线性有限元方程通常采用牛顿-拉弗森（Newton-Raphson）法，该方法依赖于对系统进行一致线性化，从而得到切线刚度矩阵。本练习深入探讨了该切线算子的两个基本组成部分：材料刚度（material stiffness）和几何刚度（geometric stiffness）。通过辨析它们的来源和物理意义，您将能够理解在大变形和预应力存在的情况下，结构响应如何被这两种效应共同主导，这对于分析屈曲等稳定性问题至关重要。[@problem_id:2705853]", "problem": "考虑一个超弹性连续体，其占据一个参考构型，物质坐标为 $\\mathbf{X}$，体积为 $V_0$。其运动由位形 $\\boldsymbol{\\varphi}(\\mathbf{X})$ 描述，其位移为 $\\mathbf{u}(\\mathbf{X}) = \\boldsymbol{\\varphi}(\\mathbf{X}) - \\mathbf{X}$，变形梯度为 $\\mathbf{F} = \\partial \\boldsymbol{\\varphi}/\\partial \\mathbf{X}$，右Cauchy–Green张量为 $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{F}$，Green–Lagrange应变为 $\\mathbf{E} = \\tfrac{1}{2}(\\mathbf{C} - \\mathbf{I})$。令 $\\mathbf{S}$ 表示第二Piola–Kirchhoff应力，单位参考体积的储存能为 $\\Psi(\\mathbf{E})$，因此 $\\mathbf{S} = \\partial \\Psi / \\partial \\mathbf{E}$，材料弹性张量为 $\\mathbb{C} = \\partial \\mathbf{S}/\\partial \\mathbf{E} = \\partial^2 \\Psi / \\partial \\mathbf{E} \\partial \\mathbf{E}$。在全拉格朗日（TL）列式中，参考构型下的虚功原理表述为\n$$\n\\delta W_{\\mathrm{int}}(\\boldsymbol{\\varphi}; \\delta \\mathbf{u}) \\;=\\; \\int_{V_0} \\mathbf{S} : \\delta \\mathbf{E} \\,\\mathrm{d}V_0,\n$$\n它与所有容许的虚位移 $\\delta \\mathbf{u}$ 所对应的外力虚功相平衡。关于位移增量 $\\Delta \\mathbf{u}$ 的一致线性化定义了一个切线算子，该算子通常被分解为“材料刚度”贡献项和“几何刚度”（或“初始应力”）贡献项。\n\n下列哪个陈述正确地描述了TL切线算子中这两个刚度分量的来源，并指出了在何种工况下其中一个会主导响应？\n\nA. 在TL列式中，材料刚度源于本构线性化 $\\delta \\mathbf{S} = \\mathbb{C} : \\delta \\mathbf{E}$，几何刚度源于当前应力 $\\mathbf{S}$ 与虚位移和增量位移梯度的缩并；因此，如果在线性化状态下 $\\mathbf{S} = \\mathbf{0}$，则几何刚度为 $\\mathbf{0}$。\n\nB. 即使围绕 $\\mathbf{S} = \\mathbf{0}$ 的无应力参考态进行线性化，几何刚度通常也非零，因为 $\\nabla_0 \\mathbf{u}$ 的二次项出现在 $\\delta \\mathbf{E}$ 中并且在线性化后仍然存在。\n\nC. 在显著的压缩预应力下，几何刚度可以主导沿某些模态的切线响应，并导致正定性的丧失（例如，在屈曲开始时），即使材料是线性弹性的。\n\nD. 当围绕无应力参考构型（因此 $\\mathbf{S} = \\mathbf{0}$）进行线性化且应变很小（$\\|\\nabla_0 \\mathbf{u}\\| \\ll 1$）时，响应完全由材料刚度决定；在这种工况下，切线算子中的几何刚度可以被忽略。\n\nE. 对于在有限拉伸下承受等双轴拉伸预应力的膜，其几何刚度是负半定的，并减小了面内切线刚度。\n\nF. 在不可压缩超弹性中，压力拉格朗日乘子的存在消除了材料刚度，因此切线算子仅由与应力相关的几何刚度构成。", "solution": "我们从参考构型中的第一性原理出发。内力虚功为\n$$\n\\delta W_{\\mathrm{int}}(\\boldsymbol{\\varphi}; \\delta \\mathbf{u}) \\;=\\; \\int_{V_0} \\mathbf{S} : \\delta \\mathbf{E} \\,\\mathrm{d}V_0,\n$$\n其中 $\\mathbf{E} = \\tfrac{1}{2}(\\mathbf{F}^{\\mathsf{T}}\\mathbf{F} - \\mathbf{I})$ 且 $\\delta \\mathbf{E} = \\tfrac{1}{2}(\\mathbf{F}^{\\mathsf{T}} \\delta \\mathbf{F} + \\delta \\mathbf{F}^{\\mathsf{T}} \\mathbf{F}) = \\operatorname{sym}(\\mathbf{F}^{\\mathsf{T}} \\delta \\mathbf{F})$，$\\delta \\mathbf{F} = \\nabla_0 \\delta \\mathbf{u}$ 且 $\\nabla_0$ 表示关于 $\\mathbf{X}$ 的梯度。考虑一个位移增量 $\\Delta \\mathbf{u}$，其对应的增量为 $\\Delta \\mathbf{F} = \\nabla_0 \\Delta \\mathbf{u}$ 和 $\\Delta \\mathbf{E} = \\operatorname{sym}(\\mathbf{F}^{\\mathsf{T}} \\Delta \\mathbf{F})$。\n\n内力虚功在 $\\Delta \\mathbf{u}$ 方向上的一致线性化（方向导数）是一个双线性形式\n$$\n\\mathrm{D}\\big[\\delta W_{\\mathrm{int}}\\big](\\boldsymbol{\\varphi}; \\delta \\mathbf{u})[\\Delta \\mathbf{u}]\n\\;=\\;\n\\int_{V_0} \\big(\\mathrm{D}\\mathbf{S}[\\Delta \\mathbf{u}]\\big) : \\delta \\mathbf{E} \\,\\mathrm{d}V_0 \\;+\\; \\int_{V_0} \\mathbf{S} : \\mathrm{D}(\\delta \\mathbf{E})[\\Delta \\mathbf{u}] \\,\\mathrm{d}V_0.\n$$\n对于超弹性材料，$\\mathrm{D}\\mathbf{S}[\\Delta \\mathbf{u}] = \\mathbb{C} : \\Delta \\mathbf{E}$，其中 $\\mathbb{C} = \\partial^2 \\Psi / \\partial \\mathbf{E}\\partial \\mathbf{E}$ 是四阶材料弹性张量。虚应变在当前构型下的方向导数为\n$$\n\\mathrm{D}(\\delta \\mathbf{E})[\\Delta \\mathbf{u}] \\;=\\; \\tfrac{1}{2}(\\Delta \\mathbf{F}^{\\mathsf{T}} \\delta \\mathbf{F} + \\delta \\mathbf{F}^{\\mathsf{T}} \\Delta \\mathbf{F}) \\;=\\; \\operatorname{sym}(\\Delta \\mathbf{F}^{\\mathsf{T}} \\delta \\mathbf{F}).\n$$\n代入可得\n$$\n\\mathrm{D}\\big[\\delta W_{\\mathrm{int}}\\big](\\boldsymbol{\\varphi}; \\delta \\mathbf{u})[\\Delta \\mathbf{u}]\n\\;=\\;\n\\underbrace{\\int_{V_0} \\big(\\mathbb{C} : \\Delta \\mathbf{E}\\big) : \\delta \\mathbf{E} \\,\\mathrm{d}V_0}_{\\text{材料刚度}}\n\\;+\\;\n\\underbrace{\\int_{V_0} \\mathbf{S} : \\operatorname{sym}(\\Delta \\mathbf{F}^{\\mathsf{T}} \\delta \\mathbf{F}) \\,\\mathrm{d}V_0}_{\\text{几何刚度}}.\n$$\n这个分解定义了两个典型的贡献项：\n\n- 材料刚度源于通过 $\\mathbb{C}$ 进行的本构线性化，即使 $\\mathbf{S}=\\mathbf{0}$ 它也存在。\n- 几何刚度（也称为初始应力刚度）关于 $\\mathbf{S}$ 是线性的，当 $\\mathbf{S}=\\mathbf{0}$ 时消失。其符号和大小取决于当前应力状态。\n\n一个量级分析可以阐明主导作用。如果我们用范数对双线性形式进行定界，可以写出\n$$\n\\big|\\text{material}\\big| \\;\\lesssim\\; \\int_{V_0} \\|\\mathbb{C}\\|\\, \\|\\nabla_0 \\Delta \\mathbf{u}\\|\\,\\|\\nabla_0 \\delta \\mathbf{u}\\|\\,\\mathrm{d}V_0,\\qquad\n\\big|\\text{geometric}\\big| \\;\\lesssim\\; \\int_{V_0} \\|\\mathbf{S}\\|\\, \\|\\nabla_0 \\Delta \\mathbf{u}\\|\\,\\|\\nabla_0 \\delta \\mathbf{u}\\|\\,\\mathrm{d}V_0.\n$$\n因此，相对重要性由比率 $\\|\\mathbf{S}\\|/\\|\\mathbb{C}\\|$以及主应力的符号决定。在拉伸情况下，几何双线性形式在相关子空间中是正半定的，会增加刚度；在压缩情况下，它会降低刚度，并能在失稳点附近（例如，细长体在压缩载荷下的屈曲）使切线算子变为不定。\n\n我们现在评估每个选项。\n\n选项A：上述推导表明，材料项通过 $\\big(\\mathbb{C} : \\Delta \\mathbf{E}\\big) : \\delta \\mathbf{E}$ 包含 $\\mathbb{C}$，而几何项是 $\\int_{V_0} \\mathbf{S} : \\operatorname{sym}(\\Delta \\mathbf{F}^{\\mathsf{T}} \\delta \\mathbf{F})\\,\\mathrm{d}V_0$，它关于 $\\mathbf{S}$ 是线性的，因此如果 $\\mathbf{S}=\\mathbf{0}$ 则该项为零。这与陈述完全相符。结论——正确。\n\n选项B：该论断声称，由于存在二次项，即使 $\\mathbf{S}=\\mathbf{0}$，几何刚度也非零。然而，在TL切线算子中，几何贡献项恰好是与 $\\mathbf{S}$ 成正比的项，即 $\\int_{V_0} \\mathbf{S} : \\operatorname{sym}(\\Delta \\mathbf{F}^{\\mathsf{T}} \\delta \\mathbf{F})\\,\\mathrm{d}V_0$。如果 $\\mathbf{S}=\\mathbf{0}$，该项恒等于零。$\\nabla_0 \\mathbf{u}$ 的二次项确实出现在 $\\delta \\mathbf{E}$ 中，但在一致线性化过程中，它们不会产生一个独立于 $\\mathbf{S}$ 的几何刚度。结论——不正确。\n\n选项C：在压缩情况下，$\\mathbf{S}$ 的主分量为负，几何双线性形式会降低相应方向上的有效刚度。随着压缩预应力的增长，几何项可以在临界模态上抵消材料项，导致切线算子失去正定性，这预示着失稳（例如，Euler屈曲），即使对于线性弹性的 $\\mathbb{C}$ 也是如此。这是应力驱动分岔的一种标准机制。结论——正确。\n\n选项D：围绕 $\\mathbf{S}=\\mathbf{0}$ 的无应力参考态进行线性化，会完全消除几何项。对于小应变（$\\|\\nabla_0 \\mathbf{u}\\|\\ll 1$），运动学简化为线性化弹性力学，切线算子即为仅由 $\\mathbb{C}$ 定义的经典线性弹性刚度。因此，响应完全由材料刚度决定，忽略几何刚度在此时不仅是近似，而是精确的。结论——正确。\n\n选项E：对于等双轴拉伸预应力，$\\mathbf{S}$ 具有正的面内主值。此时，几何双线性形式 $\\int_{V_0} \\mathbf{S} : \\operatorname{sym}(\\Delta \\mathbf{F}^{\\mathsf{T}} \\delta \\mathbf{F})\\,\\mathrm{d}V_0$ 在相关的面内模态上是正半定的，提供额外的刚化效果（如同张紧的膜）。该陈述说它是负半定的并降低刚度，这与事实相矛盾。结论——不正确。\n\n选项F：在不可压缩超弹性中，应力在空间描述下分解为 $\\boldsymbol{\\sigma} = -p \\mathbf{I} + \\boldsymbol{\\sigma}^{\\mathrm{dev}}$，其中 $p$ 是一个拉格朗日乘子。在TL变量中，$\\mathbf{S}$ 存在类似的分解，并且材料弹性张量 $\\mathbb{C}$ 包含非零的偏模量；不可压缩约束仅消除了体积柔度。因此，材料刚度不会消失；而是被修正以投影到不可压缩的变分上，而几何刚度仍然是依赖于应力的。声称只有几何刚度存在的说法是错误的。结论——不正确。", "answer": "$$\\boxed{ACD}$$", "id": "2705853"}, {"introduction": "当建立起非线性方程组（即残差向量 $\\mathbf{R}(\\mathbf{u}) = \\mathbf{0}$）及其线性化形式（即切线刚度矩阵 $\\mathbf{K}$）后，下一步便是选择一种有效的迭代策略来求解。本练习对比了两种经典的求解方案：使用一致切线刚度的标准牛顿法和使用固定刚度的修正牛顿法。通过分析它们在具有挑战性的大应变问题中的收敛速度和鲁棒性，您将能更好地权衡计算效率与求解稳定性，这是在实际工程分析中做出明智决策的关键。[@problem_id:2705821]", "problem": "一个可压缩超弹性块在大的指定压缩位移下进行分析，分析采用了有限元方法的全拉格朗日列式。在全拉格朗日列式中，通过求解离散非线性系统 $\\,\\mathbf{R}(\\mathbf{u};\\lambda)=\\mathbf{0}\\,$ 来在参考构型中强制实现给定载荷因子 $\\,\\lambda\\,$ 下的平衡。其中，$\\,\\mathbf{R}\\,$ 是残差向量，定义为在参考域上组装的外部节点力与内部节点力之差。内部力通过第二Piola–Kirchhoff应力（SPK）和Green–Lagrange应变与节点位移能量共轭，并且假设物体具有平滑的储存能函数，因此 $\\,\\mathbf{R}\\,$ 对 $\\,\\mathbf{u}\\,$ 至少是二阶连续可微的。考虑一个采用位移控制的单下载荷步，该载荷步将块体驱动至大约 $\\,50\\%\\,$ 的压缩应变而未丧失稳定性，并假设该步的精确解 $\\,\\mathbf{u}^\\star\\,$ 满足雅可比矩阵（切线刚度）$\\,\\mathbf{K}(\\mathbf{u})=\\partial \\mathbf{R}/\\partial \\mathbf{u}\\,$ 在 $\\,\\mathbf{u}^\\star\\,$ 处是非奇异的。\n\n为求解载荷步内的 $\\,\\mathbf{R}(\\mathbf{u};\\lambda)=\\mathbf{0}\\,$，考虑两种迭代策略：\n\n- 策略 $\\,\\mathrm{I}\\,$ （使用一致切线的牛顿-拉夫逊法）：在每次迭代 $\\,i\\,$ 中，通过对全拉格朗日残差进行精确线性化来构造一致算法切线 $\\,\\mathbf{K}^{(i)}=\\partial \\mathbf{R}/\\partial \\mathbf{u}\\,\\big|_{\\mathbf{u}^{(i)}}\\,$，并用其计算牛顿更新量。\n\n- 策略 $\\,\\mathrm{II}\\,$ （使用割线/冻结刚度的修正牛顿法）：在迭代 $\\,i\\,$ 中，使用一个固定的矩阵 $\\,\\mathbf{K}^{(0)}\\,$ 来近似刚度（例如，从前一个收敛构型或当前步的第一次迭代获得的割线），并且在该步内不更新该矩阵。\n\n假设没有全局化方法（无线搜索，无信赖域），且从一个足够接近 $\\,\\mathbf{u}^\\star\\,$ 的初始猜测开始，在全拉格朗日设定下，对于大但平滑的有限变形，以下哪个陈述最准确地刻画了每种策略的局部收敛速率和迭代的实际鲁棒性？\n\nA. 策略 $\\,\\mathrm{I}\\,$ 在 $\\,\\mathbf{u}^\\star\\,$ 附近实现二次收敛，但通常在远离解时鲁棒性较差；策略 $\\,\\mathrm{II}\\,$ 最多实现线性收敛，但通常具有更大的吸引盆，并且能容忍更大的载荷步而不发散。\n\nB. 策略 $\\,\\mathrm{I}\\,$ 在 $\\,\\mathbf{u}^\\star\\,$ 附近实现二次收敛，并且在全拉格朗日运动学下的平滑超弹性响应问题中，通常比策略 $\\,\\mathrm{II}\\,$ 对大应变增量表现出更强的鲁棒性；策略 $\\,\\mathrm{II}\\,$ 仅实现线性收敛，并且通常需要更小的载荷步来避免发散。\n\nC. 如果每次迭代都更新割线，策略 $\\,\\mathrm{II}\\,$ 可实现二次收敛，而策略 $\\,\\mathrm{I}\\,$ 仅实现线性收敛，因为一致线性化会高估大应变下的几何刚度。\n\nD. 只要残差范数足够小，策略 $\\,\\mathrm{I}\\,$ 和 $\\,\\mathrm{II}\\,$ 就具有相同的局部收敛速率和鲁棒性，因为两者都源于相同的全拉格朗日平衡方程。", "solution": "本任务旨在分析求解固体力学中非线性有限元问题的两种迭代策略，特别是关于它们的局部收敛速率和实际鲁棒性。该问题设置在全拉格朗日列式的背景下，研究一个承受大压缩应变的超弹性体。\n\n首先，我将验证问题陈述。\n\n### 第一步：提取已知条件\n- **列式**：可压缩超弹性块的全拉格朗日列式。\n- **载荷**：大的指定压缩位移，导致约 $50\\%$ 的压缩应变。\n- **平衡方程**：离散非线性系统 $\\mathbf{R}(\\mathbf{u};\\lambda)=\\mathbf{0}$，其中 $\\mathbf{R}$ 是参考构型中的残差向量（外力减去内力）。\n- **本构关系**：内力由第二Piola–Kirchhoff（SPK）应力和Green–Lagrange应变导出。材料具有平滑的储存能函数。\n- **数学性质**：残差 $\\mathbf{R}$ 对位移向量 $\\mathbf{u}$ 至少二阶连续可微。存在载荷步的精确解 $\\mathbf{u}^\\star$。雅可比矩阵（切线刚度）$\\mathbf{K}(\\mathbf{u})=\\partial \\mathbf{R}/\\partial \\mathbf{u}$ 在解处是非奇异的，即 $\\det(\\mathbf{K}(\\mathbf{u}^\\star)) \\neq 0$。\n- **问题条件**：分析针对单个载荷步，假设没有稳定性损失，并且迭代解从一个足够接近 $\\mathbf{u}^\\star$ 的初始猜测开始。不使用全局化策略（例如，线搜索）。\n- **策略 $\\mathrm{I}$**：完全牛顿-拉夫逊法。在每次迭代 $i$ 中，计算并使用一致切线刚度矩阵：$\\mathbf{K}^{(i)}=\\partial \\mathbf{R}/\\partial \\mathbf{u}\\,\\big|_{\\mathbf{u}^{(i)}}$。\n- **策略 $\\mathrm{II}$**：修正牛顿法。在载荷步内的所有迭代中都使用一个固定的刚度矩阵 $\\mathbf{K}^{(0)}$。\n\n### 第二步：使用提取的已知条件进行验证\n检查问题陈述的有效性。\n- **科学依据**：该问题在计算固体力学领域是公认的。它描述了一个标准场景：使用有限元方法求解非线性静力学问题。所提及的概念——全拉格朗日列式、SPK应力、一致切线刚度、牛顿-拉夫逊法和修正牛顿法——都是该学科的基础。该问题在科学上是合理的。\n- **适定性**：该问题关注两种标准数值算法的局部收敛速率和实际鲁棒性。所提供的假设（$\\mathbf{R}$ 的平滑性、解处雅可比矩阵的非奇异性、起始猜测“足够接近”解）正是这些方法的标准收敛定理所要求的条件。因此，该问题是适定的，并允许基于已建立的数值分析理论得出唯一且有意义的答案。\n- **客观性**：问题陈述使用了精确、客观和技术性的语言，没有歧义或主观内容。\n- **完整性和一致性**：提供了分析局部收敛所需的所有必要信息。没有矛盾之处。大应变（$50\\%$）问题的设定突显了关于鲁棒性问题的实际方面。\n\n### 第三步：结论与行动\n问题陈述有效。我将继续推导解答并评估所提供的选项。\n\n### 求解与选项分析\n\n该问题要求对每种策略的两个方面进行分析：局部收敛速率和对于大应变增量的实际鲁棒性。\n\n**1. 局部收敛速率分析**\n\n设非线性方程组为 $\\mathbf{R}(\\mathbf{u}) = \\mathbf{0}$。解为 $\\mathbf{u}^\\star$。第 $i$ 次迭代的误差定义为 $\\mathbf{e}^{(i)} = \\mathbf{u}^{(i)} - \\mathbf{u}^\\star$。\n\n- **策略 $\\mathrm{I}$ （牛顿-拉夫逊法）**\n迭代更新由 $\\mathbf{K}^{(i)} \\Delta \\mathbf{u}^{(i)} = -\\mathbf{R}(\\mathbf{u}^{(i)})$ 给出，其中 $\\mathbf{K}^{(i)} = \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{u}}\\big|_{\\mathbf{u}^{(i)}}$ 且 $\\mathbf{u}^{(i+1)} = \\mathbf{u}^{(i)} + \\Delta \\mathbf{u}^{(i)}$。\n通过对 $\\mathbf{R}(\\mathbf{u}^\\star) = \\mathbf{0}$ 在 $\\mathbf{u}^{(i)}$ 附近进行泰勒级数展开，我们得到：\n$$ \\mathbf{0} = \\mathbf{R}(\\mathbf{u}^\\star) = \\mathbf{R}(\\mathbf{u}^{(i)}) + \\mathbf{K}(\\mathbf{u}^{(i)})(\\mathbf{u}^\\star - \\mathbf{u}^{(i)}) + \\mathcal{O}(\\|\\mathbf{u}^\\star - \\mathbf{u}^{(i)}\\|^2) $$\n$$ \\mathbf{R}(\\mathbf{u}^{(i)}) = \\mathbf{K}^{(i)}(\\mathbf{u}^{(i)} - \\mathbf{u}^\\star) + \\mathcal{O}(\\|\\mathbf{e}^{(i)}\\|^2) = \\mathbf{K}^{(i)}\\mathbf{e}^{(i)} + \\mathcal{O}(\\|\\mathbf{e}^{(i)}\\|^2) $$\n位移更新量为 $\\Delta \\mathbf{u}^{(i)} = -[\\mathbf{K}^{(i)}]^{-1}\\mathbf{R}(\\mathbf{u}^{(i)})$。误差更新为：\n$$ \\mathbf{e}^{(i+1)} = \\mathbf{u}^{(i+1)} - \\mathbf{u}^\\star = (\\mathbf{u}^{(i)} + \\Delta \\mathbf{u}^{(i)}) - \\mathbf{u}^\\star = \\mathbf{e}^{(i)} + \\Delta \\mathbf{u}^{(i)} $$\n$$ \\mathbf{e}^{(i+1)} = \\mathbf{e}^{(i)} - [\\mathbf{K}^{(i)}]^{-1}\\left(\\mathbf{K}^{(i)}\\mathbf{e}^{(i)} + \\mathcal{O}(\\|\\mathbf{e}^{(i)}\\|^2)\\right) = \\mathbf{e}^{(i)} - \\mathbf{e}^{(i)} - [\\mathbf{K}^{(i)}]^{-1}\\mathcal{O}(\\|\\mathbf{e}^{(i)}\\|^2) = \\mathcal{O}(\\|\\mathbf{e}^{(i)}\\|^2) $$\n这意味着当 $\\mathbf{u}^{(i)}$ 足够接近 $\\mathbf{u}^\\star$ 时，对于某个常数 $C>0$，有 $\\|\\mathbf{e}^{(i+1)}\\| \\leq C \\|\\mathbf{e}^{(i)}\\|^2$。这就是**二次收敛**的定义。\n\n- **策略 $\\mathrm{II}$ （修正牛顿法）**\n迭代更新由 $\\mathbf{K}^{(0)} \\Delta \\mathbf{u}^{(i)} = -\\mathbf{R}(\\mathbf{u}^{(i)})$ 给出，其中 $\\mathbf{K}^{(0)}$ 是一个固定的矩阵。这定义了一个不动点迭代 $\\mathbf{u}^{(i+1)} = \\mathbf{g}(\\mathbf{u}^{(i)})$，其中迭代函数为 $\\mathbf{g}(\\mathbf{u}) = \\mathbf{u} - [\\mathbf{K}^{(0)}]^{-1}\\mathbf{R}(\\mathbf{u})$。\n收敛速率由 $\\mathbf{g}(\\mathbf{u})$ 在解 $\\mathbf{u}^\\star$ 处的雅可比矩阵决定：\n$$ \\mathbf{J}_{\\mathbf{g}}(\\mathbf{u}^\\star) = \\frac{\\partial \\mathbf{g}}{\\partial \\mathbf{u}}\\bigg|_{\\mathbf{u}^\\star} = \\mathbf{I} - [\\mathbf{K}^{(0)}]^{-1}\\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{u}}\\bigg|_{\\mathbf{u}^\\star} = \\mathbf{I} - [\\mathbf{K}^{(0)}]^{-1}\\mathbf{K}(\\mathbf{u}^\\star) $$\n误差传播为 $\\mathbf{e}^{(i+1)} \\approx \\mathbf{J}_{\\mathbf{g}}(\\mathbf{u}^\\star) \\mathbf{e}^{(i)}$。\n为了收敛，迭代矩阵的谱半径 $\\rho(\\mathbf{J}_{\\mathbf{g}}(\\mathbf{u}^\\star))$ 必须小于1。除非 $\\mathbf{K}^{(0)}$ 精确等于 $\\mathbf{K}(\\mathbf{u}^\\star)$（这在实践中是不可能的），否则雅可比矩阵 $\\mathbf{J}_{\\mathbf{g}}(\\mathbf{u}^\\star)$ 不是零矩阵。因此，收敛最多是**线性的**。\n\n**2. 实际鲁棒性分析**\n\n这里的“鲁棒性”指的是从距离解非无穷小的位置收敛的能力，特别是在大载荷增量（高达 $50\\%$ 应变）的背景下。\n问题指定了“平滑的超弹性响应”和“没有稳定性损失”。这是一个关键的限定条件。它意味着切线刚度矩阵 $\\mathbf{K}(\\mathbf{u})$ 在整个求解路径上保持正定和良态。\n对于大应变增量，物体的力学状态及其刚度会发生剧烈变化。全拉格朗日切线刚度 $\\mathbf{K}$ 由材料部分和几何刚度部分组成，两者都随着变形而显著演化。\n- **策略 $\\mathrm{I}$** 在每次迭代中使用一致切线 $\\mathbf{K}^{(i)}$。该矩阵代表了系统在当前状态 $\\mathbf{u}^{(i)}$ 下的精确线性化。它为确定下一步提供了最准确的信息。在一个大的、平滑的变形问题中，这种准确性至关重要。使用正确的切线确保了牛顿步是最佳的局部修正，这通常会导向更可靠的收敛路径，即使对于大的增量也是如此。因此，对于这类问题，策略 $\\mathrm{I}$ 不仅快速而且鲁棒。\n- **策略 $\\mathrm{II}$** 使用一个固定的矩阵 $\\mathbf{K}^{(0)}$，即增量开始时的切线。对于一个 $50\\%$ 的应变增量，起始时的刚度可能与收敛解附近的刚度大相径庭。迭代修正是基于一个越来越过时的系统响应模型。这可能导致非常缓慢的收敛，或者更有可能导致发散，因为搜索方向 $-[\\mathbf{K}^{(0)}]^{-1}\\mathbf{R}^{(i)}$ 可能是对真实牛顿方向的一个非常糟糕的近似。为了使策略 $\\mathrm{II}$ 在大变形下有效，通常必须显著减小载荷步长，以使 $\\mathbf{K}^{(0)}$ 在整个迭代过程中保持一个合理的近似。\n\n基于此分析，我现在将评估每个选项。\n\n**逐项分析选项**\n- **A. 策略 $\\,\\mathrm{I}\\,$ 在 $\\,\\mathbf{u}^\\star\\,$ 附近实现二次收敛，但通常在远离解时鲁棒性较差；策略 $\\,\\mathrm{II}\\,$ 最多实现线性收敛，但通常具有更大的吸引盆，并且能容忍更大的载荷步而不发散。**\n收敛速率的陈述是正确的。然而，关于鲁棒性的说法在特定问题背景下具有误导性。断言策略 $\\mathrm{II}$ “能容忍更大的载荷步”对于刚度变化显著的大应变问题通常是不正确的。策略 I 通过追踪刚度变化，更适合于大增量，前提是未遇到不稳定性。\n**结论：不正确。**\n\n- **B. 策略 $\\,\\mathrm{I}\\,$ 在 $\\,\\mathbf{u}^\\star\\,$ 附近实现二次收敛，并且在全拉格朗日运动学下的平滑超弹性响应问题中，通常比策略 $\\,\\mathrm{II}\\,$ 对大应变增量表现出更强的鲁棒性；策略 $\\,\\mathrm{II}\\,$ 仅实现线性收敛，并且通常需要更小的载荷步来避免发散。**\n这个陈述正确地指出了策略 $\\mathrm{I}$ 的二次收敛和策略 $\\mathrm{II}$ 的线性收敛。关键是，它正确地描述了在指定问题类别下的鲁棒性：策略 $\\mathrm{I}$ 的一致切线由于能准确地模拟变化的物理特性，为大的、平滑的应变增量提供了卓越的鲁棒性。它正确地得出结论，策略 $\\mathrm{II}$ 将需要更小的载荷步。这与分析完全一致。\n**结论：正确。**\n\n- **C. 如果每次迭代都更新割线，策略 $\\,\\mathrm{II}\\,$ 可实现二次收敛，而策略 $\\,\\mathrm{I}\\,$ 仅实现线性收敛，因为一致线性化会高估大应变下的几何刚度。**\n这个陈述包含多个基本错误。首先，如果策略 $\\mathrm{II}$ 被修改为每次迭代都更新一个割线矩阵，它将成为一个拟牛顿法，通常产生超线性收敛，而非二次收敛。其次，声称策略 $\\mathrm{I}$（标准牛顿-拉夫逊法）仅实现线性收敛是错误的；其局部收敛是二次的。给出的理由（“高估几何刚度”）是无稽之谈，因为根据定义，一致线性化是残差的精确导数。\n**结论：不正确。**\n\n- **D. 只要残差范数足够小，策略 $\\,\\mathrm{I}\\,$ 和 $\\,\\mathrm{II}\\,$ 就具有相同的局部收敛速率和鲁棒性，因为两者都源于相同的全拉格朗日平衡方程。**\n这个陈述是错误的。收敛速率可被证明是不同的（二次对线性）。它们旨在求解同一个方程 $\\mathbf{R}(\\mathbf{u})=\\mathbf{0}$ 这一事实，与用于寻找解的不同迭代算法的性能无关。\n**结论：不正确。**\n\n总而言之，理论收敛速率是标准结果。问题的关键是在特定的大应变背景下的实际鲁棒性。在此类问题中，通过一致切线（策略 I）准确追踪刚度变化对于收敛至关重要，这使其比使用固定、过时的切线（策略 II）更为鲁棒。", "answer": "$$\\boxed{B}$$", "id": "2705821"}]}