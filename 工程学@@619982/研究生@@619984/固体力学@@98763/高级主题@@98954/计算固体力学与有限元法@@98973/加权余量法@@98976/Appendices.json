{"hands_on_practices": [{"introduction": "理论的价值在于实践。本练习将引导你完整地走过应用加权余量法（具体为伽辽金法）于一个典型边值问题的全过程。通过求解一个一维稳态扩散方程，你将从构建弱形式开始，一步步计算单元刚度矩阵，组装全局系统，并施加边界条件，最终深入理解离散系统矩阵所具有的对称性和正定性等重要性质。这个练习是掌握有限元方法核心流程的基石 [@problem_id:2698892]。", "problem": "一个在无量纲域 $\\Omega = [0,1]$ 上的一维稳态扩散问题，由其强形式 $- \\frac{d}{dx}\\!\\left( k(x)\\,\\frac{du}{dx} \\right) = f(x)$ 和齐次Dirichlet边界条件 $u(0)=0$ 和 $u(1)=0$ 控制。考虑材料传导率 $k(x) = 2(1+x)$ 和一个为零的源项 $f(x) = 0$。用一个非均匀网格对 $\\Omega$ 进行离散化，节点位于 $x_0 = 0$、$x_1 = \\frac{1}{4}$、$x_2 = \\frac{3}{4}$ 和 $x_3 = 1$，并使用每个单元上的连续Lagrange形函数，通过分段线性有限元展开来近似 $u(x)$。使用加权余量法和Galerkin权重（即检验函数等于试验形函数），完成以下任务：\n\n1. 从强形式和通量守恒出发，通过乘以一个容许权函数 $w(x)$ 并在 $\\Omega$ 上积分，然后应用分部积分将导数从 $u(x)$ 上移开，来推导弱形式。清晰地指出双线性形式和线性泛函。\n\n2. 对于一个端节点位于 $x_i$ 和 $x_{i+1}$、单元尺寸为 $h_e = x_{i+1}-x_i$ 的通用单元 $e$，写出刚度矩阵项 $k^{(e)}_{ab} = \\int_{x_i}^{x_{i+1}} k(x)\\,\\frac{dN_a}{dx}\\,\\frac{dN_b}{dx}\\,dx$（其中 $a,b \\in \\{1,2\\}$）的单元级Galerkin表达式，其中 $N_1$ 和 $N_2$ 是单元 $e$ 上的局部线性形函数。在求值之前，明确地展示这些积分。\n\n3. 对给定网格的每个单元精确计算这些积分，并计算在 $[x_0,x_1]$、$[x_1,x_2]$ 和 $[x_2,x_3]$ 上的单元的显式 $2\\times 2$ 单元刚度矩阵。\n\n4. 组装与四节点网格对应的全局刚度矩阵。然后通过消除边界自由度来施加本质边界条件 $u(0)=0$ 和 $u(1)=0$，从而生成与内部节点 $x_1$ 和 $x_2$ 关联的简化后的 $2\\times 2$ 全局矩阵。\n\n5. 使用与Galerkin方法相关的离散能量恒等式，论证为何在给定的边界条件和 $k(x)>0$ 的情况下，简化后的全局矩阵是对称正定的。\n\n6. 最后，对于内部向量 $\\widehat{\\boldsymbol{u}} = \\begin{pmatrix}1 & 1\\end{pmatrix}^{\\mathsf T}$，计算离散能量 $E_h = \\widehat{\\boldsymbol{u}}^{\\mathsf T}\\,\\mathbf{K}\\,\\widehat{\\boldsymbol{u}}$，其中 $\\mathbf{K}$ 是步骤4中得到的简化后全局矩阵。最终答案只报告 $E_h$ 的标量值。无需四舍五入；以纯数字（无量纲）形式提供精确值。", "solution": "所述问题具有科学依据、是适定的、客观且自洽的。它描述了Galerkin有限元法在连续介质力学中一维边值问题上的一个标准应用。所有必要的数据，包括控制方程、域、边界条件、材料属性和网格离散化，都已无歧义、无矛盾地给出。因此，该问题是有效的，可以构建一个严谨的解。\n\n解答过程按顺序处理六个任务中的每一个。\n\n1. 弱形式的推导。\n控制方程的强形式为\n$$- \\frac{d}{dx}\\!\\left( k(x)\\,\\frac{du}{dx} \\right) = f(x) \\quad \\text{for } x \\in (0,1)$$\n并带有齐次Dirichlet边界条件 $u(0)=0$ 和 $u(1)=0$。\n为推导弱形式，我们将强形式乘以一个容许权函数 $w(x)$ 并在域 $\\Omega = [0,1]$ 上积分。一个容许权函数必须足够光滑，并且必须满足任何本质（Dirichlet）边界条件的齐次形式。因此，我们要求 $w(0)=0$ 和 $w(1)=0$。\n\n加权积分表达式为：\n$$ - \\int_{0}^{1} w(x) \\frac{d}{dx}\\!\\left( k(x)\\,\\frac{du}{dx} \\right) \\,dx = \\int_{0}^{1} w(x) f(x) \\,dx $$\n我们对左侧项应用分部积分。使用公式 $\\int_{a}^{b} v \\, du' \\, dx = [vu]_{a}^{b} - \\int_{a}^{b} v' u \\, dx$，我们识别出 $v=w(x)$ 和 $u' = \\frac{d}{dx}\\!\\left( k(x)\\,\\frac{du}{dx} \\right)$。这意味着 $u=k(x)\\frac{du}{dx}$ 和 $v'=\\frac{dw}{dx}$。左侧项变为：\n$$ \\int_{0}^{1} \\frac{dw}{dx} k(x) \\frac{du}{dx} \\,dx - \\left[ w(x) k(x) \\frac{du}{dx} \\right]_{0}^{1} = \\int_{0}^{1} w(x) f(x) \\,dx $$\n边界项 $\\left[ w(x) k(x) \\frac{du}{dx} \\right]_{0}^{1} = w(1) k(1) \\frac{du}{dx}(1) - w(0) k(0) \\frac{du}{dx}(0)$ 消失，因为权函数是从一个满足 $w(0)=0$ 和 $w(1)=0$ 的空间中选取的。\n\n这就得到了最终的弱形式：寻找一个满足本质边界条件的函数 $u(x)$，使得对于所有容许权函数 $w(x)$，以下方程成立：\n$$ \\int_{0}^{1} k(x) \\frac{du}{dx} \\frac{dw}{dx} \\,dx = \\int_{0}^{1} f(x) w(x) \\,dx $$\n双线性形式 $B(u,w)$ 是弱形式中对 $u$ 和 $w$ 都是线性的部分：\n$$ B(u,w) = \\int_{0}^{1} k(x) \\frac{du}{dx} \\frac{dw}{dx} \\,dx $$\n线性泛函 $L(w)$ 是对 $w$ 线性的部分：\n$$ L(w) = \\int_{0}^{1} f(x) w(x) \\,dx $$\n\n2. 单元级Galerkin表达式。\n对于一个跨越区间 $[x_i, x_{i+1}]$ 且长度为 $h_e = x_{i+1}-x_i$ 的通用单元 $e$，近似解 $u_h(x)$ 使用局部线性形函数 $N_1(x)$ 和 $N_2(x)$ 进行插值：\n$$ u_h(x)|_{e} = u_i^{(e)} N_1(x) + u_{i+1}^{(e)} N_2(x) $$\n形函数定义为 $N_1(x) = \\frac{x_{i+1}-x}{h_e}$ 和 $N_2(x) = \\frac{x-x_i}{h_e}$。它们关于 $x$ 的导数在单元上是常数：\n$$ \\frac{dN_1}{dx} = -\\frac{1}{h_e}, \\quad \\frac{dN_2}{dx} = \\frac{1}{h_e} $$\n在Galerkin方法中，权函数 $w(x)$ 与试验函数取自同一函数集，即 $w(x) = N_a(x)$，其中 $a \\in \\{1,2\\}$。单元刚度矩阵项 $k^{(e)}_{ab}$ 随后通过在单元域上对形函数对计算双线性形式得到：\n$$ k^{(e)}_{ab} = \\int_{x_i}^{x_{i+1}} k(x)\\,\\frac{dN_a}{dx}\\,\\frac{dN_b}{dx}\\,dx $$\n为 $a,b \\in \\{1,2\\}$ 显式写出这些积分：\n$$ k^{(e)}_{11} = \\int_{x_i}^{x_{i+1}} k(x) \\left( -\\frac{1}{h_e} \\right) \\left( -\\frac{1}{h_e} \\right) dx = \\frac{1}{h_e^2} \\int_{x_i}^{x_{i+1}} k(x) \\,dx $$\n$$ k^{(e)}_{12} = \\int_{x_i}^{x_{i+1}} k(x) \\left( -\\frac{1}{h_e} \\right) \\left( \\frac{1}{h_e} \\right) dx = -\\frac{1}{h_e^2} \\int_{x_i}^{x_{i+1}} k(x) \\,dx $$\n$$ k^{(e)}_{21} = \\int_{x_i}^{x_{i+1}} k(x) \\left( \\frac{1}{h_e} \\right) \\left( -\\frac{1}{h_e} \\right) dx = -\\frac{1}{h_e^2} \\int_{x_i}^{x_{i+1}} k(x) \\,dx $$\n$$ k^{(e)}_{22} = \\int_{x_i}^{x_{i+1}} k(x) \\left( \\frac{1}{h_e} \\right) \\left( \\frac{1}{h_e} \\right) dx = \\frac{1}{h_e^2} \\int_{x_i}^{x_{i+1}} k(x) \\,dx $$\n\n3. 单元刚度矩阵的求值与计算。\n材料传导率为 $k(x) = 2(1+x)$。$k(x)$ 在一个通用单元上的积分为：\n$$ \\int_{x_i}^{x_{i+1}} 2(1+x) \\,dx = \\left[ 2x + x^2 \\right]_{x_i}^{x_{i+1}} = (2x_{i+1} + x_{i+1}^2) - (2x_i + x_i^2) = 2(x_{i+1}-x_i) + (x_{i+1}^2-x_i^2) = h_e(2 + x_i + x_{i+1}) $$\n单元矩阵的标量系数为 $C_e = \\frac{1}{h_e^2} \\int_{x_i}^{x_{i+1}} k(x) \\,dx = \\frac{h_e(2+x_i+x_{i+1})}{h_e^2} = \\frac{2+x_i+x_{i+1}}{h_e}$。\n\n网格节点为 $x_0 = 0$、$x_1 = \\frac{1}{4}$、$x_2 = \\frac{3}{4}$ 和 $x_3 = 1$。\n\n单元 1 ($e=1$): $[x_0, x_1] = [0, \\frac{1}{4}]$。\n$h_1 = x_1 - x_0 = \\frac{1}{4}$。\n$C_1 = \\frac{2+0+\\frac{1}{4}}{\\frac{1}{4}} = \\frac{9/4}{1/4} = 9$。\n$\\mathbf{K}^{(1)} = 9 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 9 & -9 \\\\ -9 & 9 \\end{pmatrix}$。\n\n单元 2 ($e=2$): $[x_1, x_2] = [\\frac{1}{4}, \\frac{3}{4}]$。\n$h_2 = x_2 - x_1 = \\frac{3}{4} - \\frac{1}{4} = \\frac{1}{2}$。\n$C_2 = \\frac{2+\\frac{1}{4}+\\frac{3}{4}}{\\frac{1}{2}} = \\frac{2+1}{\\frac{1}{2}} = \\frac{3}{\\frac{1}{2}} = 6$。\n$\\mathbf{K}^{(2)} = 6 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 6 & -6 \\\\ -6 & 6 \\end{pmatrix}$。\n\n单元 3 ($e=3$): $[x_2, x_3] = [\\frac{3}{4}, 1]$。\n$h_3 = x_3 - x_2 = 1 - \\frac{3}{4} = \\frac{1}{4}$。\n$C_3 = \\frac{2+\\frac{3}{4}+1}{\\frac{1}{4}} = \\frac{3+\\frac{3}{4}}{\\frac{1}{4}} = \\frac{15/4}{1/4} = 15$。\n$\\mathbf{K}^{(3)} = 15 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 15 & -15 \\\\ -15 & 15 \\end{pmatrix}$。\n\n4. 全局刚度矩阵的组装和简化。\n通过在相应的全局自由度（节点0, 1, 2, 3）上对每个单元矩阵的贡献求和，来组装 $4 \\times 4$ 的全局刚度矩阵 $\\mathbf{K}_{global}$。\n$K_{11} = K^{(1)}_{11} = 9$\n$K_{22} = K^{(1)}_{22} + K^{(2)}_{11} = 9 + 6 = 15$\n$K_{33} = K^{(2)}_{22} + K^{(3)}_{11} = 6 + 15 = 21$\n$K_{44} = K^{(3)}_{22} = 15$\n$K_{12} = K_{21} = K^{(1)}_{12} = -9$\n$K_{23} = K_{32} = K^{(2)}_{12} = -6$\n$K_{34} = K_{43} = K^{(3)}_{12} = -15$\n$$ \\mathbf{K}_{global} = \\begin{pmatrix}\n9 & -9 & 0 & 0 \\\\\n-9 & 15 & -6 & 0 \\\\\n0 & -6 & 21 & -15 \\\\\n0 & 0 & -15 & 15\n\\end{pmatrix} $$\n本质边界条件是 $u(0)=u_0=0$ 和 $u(1)=u_3=0$。为了获得内部未知量 $u_1$ 和 $u_2$ 的简化系统，我们消除了与自由度0和3相对应的行和列。这就得到了与内部节点1和2相关联的 $2 \\times 2$ 简化全局矩阵 $\\mathbf{K}$：\n$$ \\mathbf{K} = \\begin{pmatrix}\n15 & -6 \\\\\n-6 & 21\n\\end{pmatrix} $$\n\n5. 对称正定（SPD）属性的论证。\n对于近似解 $u_h(x)$，系统的离散能量由 $\\frac{1}{2}B(u_h, u_h)$ 给出。对于自由自由度的位移向量 $\\widehat{\\boldsymbol{u}}$，这对应于二次型 $\\frac{1}{2}\\widehat{\\boldsymbol{u}}^{\\mathsf T}\\,\\mathbf{K}\\,\\widehat{\\boldsymbol{u}}$。\n\n对称性：双线性形式 $B(u,w) = \\int_{0}^{1} k \\frac{du}{dx}\\frac{dw}{dx} dx$ 是对称的，因为标量乘法是可交换的，即 $B(u,w)=B(w,u)$。刚度矩阵 $\\mathbf{K}$ 是此双线性形式的离散表示，其项为 $K_{ij} = B(N_j, N_i)$。因此，$K_{ij} = B(N_j, N_i) = B(N_i, N_j) = K_{ji}$，证明了 $\\mathbf{K}$ 是对称的。这一点由计算出的矩阵得到证实。\n\n正定性：我们必须证明对于任何非零向量 $\\widehat{\\boldsymbol{u}} \\neq \\mathbf{0}$，都有 $\\widehat{\\boldsymbol{u}}^{\\mathsf T}\\,\\mathbf{K}\\,\\widehat{\\boldsymbol{u}} > 0$。二次型对应于积分：\n$$ \\widehat{\\boldsymbol{u}}^{\\mathsf T}\\,\\mathbf{K}\\,\\widehat{\\boldsymbol{u}} = B(u_h, u_h) = \\int_{0}^{1} k(x) \\left( \\frac{du_h}{dx} \\right)^2 dx $$\n其中 $u_h(x)$ 是由向量 $\\widehat{\\boldsymbol{u}}$ 构建并满足 $u_h(0)=0$ 和 $u_h(1)=0$ 的分段线性函数。\n问题陈述 $k(x) = 2(1+x)$，对于所有 $x \\in [0,1]$ 都是严格正的。项 $(\\frac{du_h}{dx})^2$ 总是非负的。因此，被积函数 $k(x)(\\frac{du_h}{dx})^2$ 在域上处处非负。积分可以为零，当且仅当被积函数几乎处处为零。由于 $k(x)>0$，这要求 $\\frac{du_h}{dx} = 0$ 对所有 $x \\in (0,1)$ 成立。这意味着 $u_h(x)$ 必须是一个常数函数。然而，任何对应于简化系统的函数 $u_h(x)$ 都必须满足边界条件 $u_h(0)=0$。一个在 $x=0$ 处为零的常数函数必须恒等于零，$u_h(x)=0$。这对应于一个所有项都为零的节点位移向量，即 $\\widehat{\\boldsymbol{u}}=\\mathbf{0}$。\n因此，对于任何非零向量 $\\widehat{\\boldsymbol{u}}$，相应的函数 $u_h(x)$ 不恒等于零，其导数 $\\frac{du_h}{dx}$ 不恒等于零，并且积分是严格正的。这证明了简化矩阵 $\\mathbf{K}$ 是正定的。\n\n6. 离散能量的计算。\n我们被要求计算对于内部位移向量 $\\widehat{\\boldsymbol{u}} = \\begin{pmatrix}1 & 1\\end{pmatrix}^{\\mathsf T}$ 和简化矩阵 $\\mathbf{K} = \\begin{pmatrix} 15 & -6 \\\\ -6 & 21 \\end{pmatrix}$ 的离散能量 $E_h = \\widehat{\\boldsymbol{u}}^{\\mathsf T}\\,\\mathbf{K}\\,\\widehat{\\boldsymbol{u}}$。\n$$ E_h = \\begin{pmatrix} 1 & 1 \\end{pmatrix} \\begin{pmatrix} 15 & -6 \\\\ -6 & 21 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n首先，我们计算乘积 $\\mathbf{K}\\widehat{\\boldsymbol{u}}$：\n$$ \\begin{pmatrix} 15 & -6 \\\\ -6 & 21 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 15 \\cdot 1 - 6 \\cdot 1 \\\\ -6 \\cdot 1 + 21 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 9 \\\\ 15 \\end{pmatrix} $$\n然后，我们计算与 $\\widehat{\\boldsymbol{u}}^{\\mathsf T}$ 的点积：\n$$ E_h = \\begin{pmatrix} 1 & 1 \\end{pmatrix} \\begin{pmatrix} 9 \\\\ 15 \\end{pmatrix} = 1 \\cdot 9 + 1 \\cdot 15 = 24 $$\n离散能量是 $24$。", "answer": "$$\n\\boxed{24}\n$$", "id": "2698892"}, {"introduction": "在有限元分析中，如何精确施加位移约束（本质边界条件）是一个关键的实际问题。除了直接代入法，罚函数法提供了一种灵活且强大的替代方案，在许多大型商业软件中得到了广泛应用。本练习旨在通过一个简化的单参数近似问题，揭示罚函数法的内在机理，并让你亲手推导其如何通过一个罚参数 $\\alpha$ 将边界约束引入系统的残差方程中，从而在极限情况下强制满足位移条件 [@problem_id:2698903]。", "problem": "一根长度为 $L$、杨氏模量 $E$ 和横截面积 $A$ 恒定的直棱柱状一维弹性杆，在 $0 \\le x \\le L$ 区间内承受均布轴向体力密度 $q_{0}$（单位长度上的力）的作用。$x=L$ 处一端为无牵引力端。$x=0$ 处一端的位移被指定为 $u(0)=\\bar{u}$。\n\n从一维线动量的静态平衡和线弹性本构关系出发：\n- 平衡方程：$\\dfrac{dN}{dx} + q(x) = 0$,\n- 轴力-位移关系：$N(x) = E A \\dfrac{du}{dx}$,\n使用加权余量法（MWR），特别是Galerkin方法，推导一个单方程近似解，采用单参数试探场\n$$\nu_{h}(x) = a\\,\\phi(x), \\quad \\phi(x) = 1 + \\frac{x}{L},\n$$\n以及相应的Galerkin权函数 $w(x) = \\phi(x)$。采用罚函数法，罚参数为 $\\alpha>0$，来施加 $x=0$ 处的基本边界条件，使得增广加权余量达到以下形式\n$$\nR(a;\\alpha) = \\int_{0}^{L} w(x)\\,\\Big(\\frac{d}{dx}\\big(EA\\,u_{h}'(x)\\big) + q_{0}\\Big)\\,dx \\;+\\; \\alpha\\,w(0)\\,\\big(u_{h}(0)-\\bar{u}\\big),\n$$\n并通过施加 $R(a;\\alpha)=0$ 来确定 $a(\\alpha)$ 的闭合形式解。\n\n讨论 $\\alpha \\to \\infty$ 时的极限，并确定由罚函数法强制施加的极限值 $\\lim_{\\alpha \\to \\infty} a(\\alpha)$。最终答案仅用给定符号的符号表达式给出。不要在最终的答案框中包含单位。", "solution": "所述问题是有效的。这是加权余量法（MWR）在一维线弹性问题中的一个适定应用。所有必要的函数、方程和参数均已提供，任务是执行一个明确定义的数学过程。所选试探函数的物理适用性虽然在满足自然边界条件方面存在疑问，但这并不影响根据规定规则求解参数 $a$ 的数学问题的有效性。\n\n将本构关系 $N(x) = EA \\frac{du}{dx}$ 代入平衡方程 $\\frac{dN}{dx} + q(x) = 0$，可以推导出轴向位移 $u(x)$ 的控制微分方程。对于恒定的体力 $q(x) = q_0$ 和恒定的材料属性 $E$和$A$，可得到控制方程的强形式：\n$$\n\\frac{d}{dx}\\left(EA \\frac{du}{dx}\\right) + q_0 = 0\n$$\n问题指定使用单参数试探解 $u_h(x)$ 和Galerkin权函数 $w(x)$：\n$$\nu_h(x) = a\\,\\phi(x), \\quad \\phi(x) = 1 + \\frac{x}{L}\n$$\n$$\nw(x) = \\phi(x) = 1 + \\frac{x}{L}\n$$\n参数 $a$ 将通过求解增广加权余量方程 $R(a;\\alpha) = 0$ 来确定，其中 $R(a;\\alpha)$ 的表达式为：\n$$\nR(a;\\alpha) = \\int_{0}^{L} w(x)\\,\\Big(\\frac{d}{dx}\\big(EA\\,u_{h}'(x)\\big) + q_{0}\\Big)\\,dx \\;+\\; \\alpha\\,w(0)\\,\\big(u_{h}(0)-\\bar{u}\\big)\n$$\n我们通过计算该方程的每个分量来求解。首先，我们计算试探解 $u_h(x)$ 的导数：\n$$\nu_h'(x) = \\frac{d}{dx} \\left( a \\left(1 + \\frac{x}{L}\\right) \\right) = \\frac{a}{L}\n$$\n积分内的项 $\\frac{d}{dx}(EA u_h'(x))$ 为：\n$$\n\\frac{d}{dx}\\big(EA\\,u_{h}'(x)\\big) = \\frac{d}{dx}\\left(EA \\frac{a}{L}\\right) = 0\n$$\n这是因为 $E$、$A$、$L$ 以及参数 $a$ 相对于空间坐标 $x$ 都是常数。\n\n余量方程的被积函数简化为：\n$$\nw(x)\\,\\Big(\\frac{d}{dx}\\big(EA\\,u_{h}'(x)\\big) + q_{0}\\Big) = \\left(1 + \\frac{x}{L}\\right) (0 + q_0) = q_0\\left(1 + \\frac{x}{L}\\right)\n$$\n现在，我们计算余量的积分项：\n$$\n\\int_{0}^{L} q_0\\left(1 + \\frac{x}{L}\\right) dx = q_0 \\left[ x + \\frac{x^2}{2L} \\right]_{0}^{L} = q_0 \\left( (L + \\frac{L^2}{2L}) - (0 + 0) \\right) = q_0 \\left( L + \\frac{L}{2} \\right) = \\frac{3}{2}q_0 L\n$$\n接下来，我们计算罚函数项 $\\alpha\\,w(0)\\,\\big(u_{h}(0)-\\bar{u}\\big)$ 的各个分量。\n在 $x=0$ 处的权函数为：\n$$\nw(0) = 1 + \\frac{0}{L} = 1\n$$\n在 $x=0$ 处的试探解为：\n$$\nu_h(0) = a\\left(1 + \\frac{0}{L}\\right) = a\n$$\n将这些代入罚函数项，得到：\n$$\n\\alpha \\cdot 1 \\cdot (a - \\bar{u}) = \\alpha(a - \\bar{u})\n$$\n现在，我们可以通过设置 $R(a;\\alpha)=0$ 来组合成完整的增广加权余量方程：\n$$\n\\frac{3}{2}q_0 L + \\alpha(a - \\bar{u}) = 0\n$$\n这是一个关于未知参数 $a$ 的线性代数方程。我们求解 $a$ 作为罚参数 $\\alpha$ 的函数：\n$$\n\\alpha(a - \\bar{u}) = -\\frac{3}{2}q_0 L\n$$\n$$\na - \\bar{u} = -\\frac{3q_0 L}{2\\alpha}\n$$\n$$\na(\\alpha) = \\bar{u} - \\frac{3q_0 L}{2\\alpha}\n$$\n这个表达式给出了对于任何给定罚参数 $\\alpha > 0$ 时参数 $a$ 的值。\n\n问题的最后一部分要求分析当罚参数趋于无穷大（$\\alpha \\to \\infty$）时的极限。这个极限展示了罚函数法施加基本边界条件的机制。\n$$\n\\lim_{\\alpha \\to \\infty} a(\\alpha) = \\lim_{\\alpha \\to \\infty} \\left( \\bar{u} - \\frac{3q_0 L}{2\\alpha} \\right)\n$$\n当 $\\alpha \\to \\infty$ 时，项 $\\frac{3q_0 L}{2\\alpha}$ 趋近于 $0$，因为分子是一个有限常数。因此，极限为：\n$$\n\\lim_{\\alpha \\to \\infty} a(\\alpha) = \\bar{u} - 0 = \\bar{u}\n$$\n这个结果与罚函数法的目的一致。在无限大罚参数的极限下，该方法强制近似解精确满足基本边界条件 $u_h(0) = \\bar{u}$。由于 $u_h(0) = a$，这要求参数 $a$ 本身必须收敛到给定的位移值 $\\bar{u}$。", "answer": "$$\\boxed{\\bar{u}}$$", "id": "2698903"}, {"introduction": "真实世界的许多问题本质上是非线性的，线性模型只是其在特定条件下的简化。本练习将带领你从线性领域迈向非线性固体力学的广阔天地，处理一个超弹性杆的几何非线性问题。你将学习到求解非线性问题时的两个核心概念：非线性残差向量 $r(a)$ 和切向刚度矩阵（或雅可比矩阵）$K(a)$。通过亲手推导这些量，你将理解牛顿法等迭代求解器为何需要“一致线性化”来获得快速收敛，为解决更复杂的非线性问题打下坚实基础 [@problem_id:2698927]。", "problem": "考虑一根未变形长度为 $L$、恒定横截面积为 $A$ 的细长超弹性杆，其占据的参考区间为 $X \\in [0,L]$。该杆在 $X = 0$ 处固定，并在 $X = L$ 处承受集中轴向载荷 $P_{\\mathrm{ext}}$。假设该材料为 Saint Venant–Kirchhoff 材料，其 Lamé 参数为 $\\lambda$ 和 $\\mu$，并采用全拉格朗日描述。设运动为 $\\varphi(X) = X + u(X)$，其中 $u(X)$ 是参考构型中的轴向位移场。Green–Lagrange 应变定义为 $E = \\frac{1}{2}\\left(F^{2} - 1\\right)$，其中变形梯度为 $F = \\frac{d\\varphi}{dX} = 1 + \\frac{du}{dX}$。第二 Piola–Kirchhoff 应力由 $S = \\mathbb{C} : E$ 给出，其中 $\\mathbb{C}$ 是四阶弹性张量。对于一维 Saint Venant–Kirchhoff 材料，$S = (\\lambda + 2\\mu)\\,E$。第一 Piola–Kirchhoff 应力为 $P = F\\,S$。\n\n使用加权余量法，并选择 Galerkin 权函数等于试探形函数，通过在 $X=L$ 处具有单个自由度 $a$ 的单个双节点线性有限元来近似位移：$u_{h}(X) = a\\,N_{2}(X)$，其中 $N_{2}(X) = X/L$，且 $u_{h}(0) = 0$。设权函数为 $w(X) = N_{2}(X)$。\n\n从参考构型中线性动量守恒的弱形式以及上述定义出发，执行以下操作：\n\n1. 应用全拉格朗日形式的加权余量法，推导与单个自由度 $a$ 相关的标量残差 $r(a)$，并清楚地标明内虚功和外虚功的贡献。\n2. 通过一致线性化，推导精确的雅可比矩阵（切线）$K(a) = \\frac{dr}{da}$。\n3. 使用 Newton–Kantorovich 理论，简要解释对于此问题，与使用近似切线（例如，取在 $a=0$ 处计算的恒定小应变切线）相比，使用第2项中的精确切线如何影响牛顿迭代的局部收敛速度。\n\n以 $A$、$L$、$\\lambda$、$\\mu$ 和 $a$ 表示 $K(a)$ 的精确闭式解析表达式作为最终答案。不要代入数值。最终答案中不要包含单位。", "solution": "所述问题具有科学依据、提法恰当且客观。提供了获得唯一解所需的所有必要信息。这是非线性有限元方法在超弹性问题中的一个标准应用。因此，我将开始解答。\n\n该问题要求使用加权余量法（特别是 Galerkin 方法）分析具有单个自由度的超弹性杆。\n\n1. 标量残差 $r(a)$ 的推导\n\n控制方程是参考构型中的线性动量守恒。其弱形式，也称为虚功原理，指出对于任何运动学容许的虚位移，内虚功必须等于外虚功。对于一维物体，这表示为：\n$$ \\delta \\mathcal{W} = \\delta \\mathcal{W}_{\\text{int}} - \\delta \\mathcal{W}_{\\text{ext}} = 0 $$\n其中 $\\delta \\mathcal{W}_{\\text{int}}$ 是内虚功，$\\delta \\mathcal{W}_{\\text{ext}}$ 是外虚功。\n\n内虚功由第二 Piola–Kirchhoff 应力 $S$ 与 Green–Lagrange 应变的变分 $\\delta E$ 在参考体积 $V_0$ 上的积分给出：\n$$ \\delta \\mathcal{W}_{\\text{int}} = \\int_{V_0} S : \\delta E \\, dV_0 = \\int_0^L S \\, \\delta E \\, A \\, dX $$\n外虚功由施加的载荷 $P_{\\text{ext}}$ 在其作用点上所做，对应于该点的虚位移：\n$$ \\delta \\mathcal{W}_{\\text{ext}} = P_{\\text{ext}} \\delta u(L) $$\n位移场近似为 $u_h(X) = a\\,N_2(X) = a \\frac{X}{L}$。单个自由度是 $a$，它代表杆末端的位移，即 $u_h(L) = a$。\n虚位移是 $u_h$ 关于 $a$ 的变分：\n$$ \\delta u(X) = \\frac{\\partial u_h}{\\partial a} \\delta a = \\frac{X}{L} \\delta a $$\nGalerkin 方法的权函数选择为 $w(X) = \\frac{\\partial u_h}{\\partial a} = \\frac{X}{L}$。\n变形梯度 $F$ 为：\n$$ F = 1 + \\frac{du_h}{dX} = 1 + \\frac{a}{L} $$\n由于 $F$ 在整个杆上是恒定的，所以 Green–Lagrange 应变 $E$ 也是恒定的：\n$$ E = \\frac{1}{2}(F^2 - 1) = \\frac{1}{2}\\left(\\left(1 + \\frac{a}{L}\\right)^2 - 1\\right) = \\frac{a}{L} + \\frac{a^2}{2L^2} $$\n应变的变分 $\\delta E$ 为：\n$$ \\delta E = \\frac{\\partial E}{\\partial a} \\delta a = \\left(\\frac{1}{L} + \\frac{a}{L^2}\\right)\\delta a = \\frac{1}{L}\\left(1 + \\frac{a}{L}\\right)\\delta a = \\frac{F}{L}\\delta a $$\nSaint Venant–Kirchhoff 材料的第二 Piola–Kirchhoff 应力 $S$ 为：\n$$ S = (\\lambda + 2\\mu)E = (\\lambda + 2\\mu)\\left(\\frac{a}{L} + \\frac{a^2}{2L^2}\\right) $$\n现在，我们构建内虚功的贡献：\n$$ \\delta \\mathcal{W}_{\\text{int}} = \\int_0^L S \\, \\delta E \\, A \\, dX = \\int_0^L (\\lambda + 2\\mu)\\left(\\frac{a}{L} + \\frac{a^2}{2L^2}\\right) \\left(\\frac{F}{L}\\delta a\\right) A \\, dX $$\n由于所有涉及 $a$ 的项都相对于 $X$ 是常数，我们可以将它们移到积分符号外：\n$$ \\delta \\mathcal{W}_{\\text{int}} = A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{a^2}{2L^2}\\right) \\frac{F}{L} \\delta a \\int_0^L dX $$\n$$ \\delta \\mathcal{W}_{\\text{int}} = A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{a^2}{2L^2}\\right) \\left(1 + \\frac{a}{L}\\right) \\frac{1}{L} L \\delta a $$\n$$ \\delta \\mathcal{W}_{\\text{int}} = A (\\lambda + 2\\mu) \\left(\\frac{a}{L}+\\frac{a^2}{2L^2}\\right)\\left(1+\\frac{a}{L}\\right) \\delta a $$\n展开表达式：\n$$ \\delta \\mathcal{W}_{\\text{int}} = A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{a^2}{L^2} + \\frac{a^2}{2L^2} + \\frac{a^3}{2L^3}\\right) \\delta a = A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{3a^2}{2L^2} + \\frac{a^3}{2L^3}\\right) \\delta a $$\n外虚功为：\n$$ \\delta \\mathcal{W}_{\\text{ext}} = P_{\\text{ext}} \\delta u(L) = P_{\\text{ext}} \\delta a $$\n通过设置 $\\delta \\mathcal{W} = 0$ 得到残差方程：\n$$ (\\delta \\mathcal{W}_{\\text{int}} - \\delta \\mathcal{W}_{\\text{ext}}) = \\left[ A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{3a^2}{2L^2} + \\frac{a^3}{2L^3}\\right) - P_{\\text{ext}} \\right] \\delta a = 0 $$\n由于此式必须对任意非零的 $\\delta a$ 成立，因此标量残差 $r(a)$ 是方括号中的项。\n内力矢量（在此例中为标量）为 $F_{\\text{int}}(a) = A (\\lambda + 2\\mu) (\\frac{a}{L} + \\frac{3a^2}{2L^2} + \\frac{a^3}{2L^3})$，外力矢量为 $F_{\\text{ext}} = P_{\\text{ext}}$。\n因此，残差为 $r(a) = F_{\\text{int}}(a) - F_{\\text{ext}}$：\n$$ r(a) = A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{3a^2}{2L^2} + \\frac{a^3}{2L^3}\\right) - P_{\\text{ext}} $$\n\n2. 精确雅可比矩阵（切线）$K(a)$ 的推导\n\n精确的雅可比矩阵，或称切线刚度，是通过对残差 $r(a)$ 求关于自由度 $a$ 的导数得到的。这个过程称为一致线性化。\n$$ K(a) = \\frac{dr(a)}{da} $$\n对 $r(a)$ 的表达式关于 $a$ 求导，并注意到 $P_{\\text{ext}}$ 是一个恒定载荷：\n$$ K(a) = \\frac{d}{da} \\left[ A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{3a^2}{2L^2} + \\frac{a^3}{2L^3}\\right) \\right] $$\n$$ K(a) = A (\\lambda + 2\\mu) \\left(\\frac{1}{L} + \\frac{3(2a)}{2L^2} + \\frac{3a^2}{2L^3}\\right) $$\n$$ K(a) = A (\\lambda + 2\\mu) \\left(\\frac{1}{L} + \\frac{3a}{L^2} + \\frac{3a^2}{2L^3}\\right) $$\n该表达式代表了杆的单单元近似的精确切线刚度。它由初始线性刚度 $A(\\lambda+2\\mu)/L$ 和依赖于位移 $a$ 的非线性项组成，这些非线性项考虑了几何非线性。\n\n3. 收敛速度的解释\n\n非线性方程 $r(a) = 0$ 的解是使用迭代格式找到的。该问题的标准 Newton-Raphson 方法是：\n$$ a_{k+1} = a_k - [K(a_k)]^{-1} r(a_k) $$\n其中 $k$ 是迭代指数，$K(a_k)$ 是在当前估计值 $a_k$ 处计算的精确切线刚度。\n\n根据 Newton–Kantorovich 理论，如果初始猜测值 $a_0$ 足够接近真解 $a^*$，并且解处的雅可比矩阵 $K(a^*)$ 是非奇异的，那么 Newton-Raphson 方法将呈二次方收敛。二次方收敛意味着误差 $\\epsilon_k = |a_k - a^*|$ 根据关系 $\\epsilon_{k+1} \\leq C \\epsilon_k^2$（对于某个常数 $C>0$）减小。这意味着解的正确数字位数在每次迭代中大约翻倍，这是一个非常快的收敛速度。\n\n如果使用近似切线代替精确切线 $K(a_k)$，收敛行为会发生变化。问题建议使用在 $a=0$ 处计算的恒定切线，即线性弹性（小应变）刚度：\n$$ K_0 = K(a=0) = A (\\lambda + 2\\mu) \\frac{1}{L} $$\n迭代格式变为修正牛顿法（或常刚度法）：\n$$ a_{k+1} = a_k - [K_0]^{-1} r(a_k) $$\n此方法的收敛速度由其迭代映射 $g(a) = a - [K_0]^{-1}r(a)$ 在解 $a^*$ 处的导数决定。该导数为 $g'(a) = 1 - [K_0]^{-1}K(a)$。在解处，$g'(a^*) = 1 - [K_0]^{-1}K(a^*)$。除非问题是线性的或解恰好为 $a^*=0$，否则 $K(a^*) \\neq K_0$，因此 $g'(a^*) \\neq 0$。如果 $|g'(a^*)| < 1$，该方法收敛，但收敛速度仅为线性。线性收敛意味着误差在每一步都减少一个大致恒定的因子：$\\epsilon_{k+1} \\leq c \\epsilon_k$，其中收敛因子为 $c = |g'(a^*)|$。\n\n总而言之，使用精确切线 $K(a)$ 会产生二次方收敛，这比使用像 $K_0$ 这样的近似恒定切线所获得的线性收敛要快得多。修正牛顿法的计算优势在于切线刚度只需计算和分解一次，这对于大型系统可能是有利的，但这是以收敛速度慢得多为代价的。", "answer": "$$\\boxed{A(\\lambda+2\\mu) \\left(\\frac{1}{L} + \\frac{3a}{L^2} + \\frac{3a^2}{2L^3}\\right)}$$", "id": "2698927"}]}