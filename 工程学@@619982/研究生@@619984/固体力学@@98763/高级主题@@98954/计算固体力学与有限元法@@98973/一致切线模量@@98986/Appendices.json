{"hands_on_practices": [{"introduction": "要理解一致性切向模量，我们必须首先领会材料的刚度为何在屈服时会发生变化。这个练习将探讨弹性和塑性响应之间的根本区别，要求你使用离散更新方案，分别推导材料在屈服前后两种情况下的切向模量。通过比较这两个结果，你将揭示材料刚度在屈服面处出现不连续性的物理原因，而这正是在非线性分析中需要一致性切向模量的根本所在 [@problem_id:2694728]。", "problem": "考虑小应变单轴弹塑性，在单调拉伸加载下具有线性各向同性硬化，通过后向欧拉弹性预测/塑性修正格式在从状态 $n$ 到状态 $n+1$ 的单个时间步上进行积分。其运动学和本构要素如下：\n- 加法分解 $ \\epsilon = \\epsilon^{e} + \\epsilon^{p} $。\n- 线性弹性 $ \\sigma = E\\,\\epsilon^{e} $，其中弹性模量 $ E > 0 $。\n- 屈服函数 $ f(\\sigma,\\alpha) = |\\sigma| - \\big(\\sigma_{y0} + H\\,\\alpha\\big) \\le 0 $，其中 $ \\sigma_{y0} > 0 $ 是初始屈服应力，$ H \\ge 0 $ 是线性各向同性硬化模量，$ \\alpha $ 是累积塑性应变。\n- 相关联流动 $ \\dot{\\epsilon}^{p} = \\dot{\\gamma}\\,\\partial f/\\partial \\sigma $，$ \\dot{\\alpha} = \\dot{\\gamma} $，以及Kuhn–Tucker条件 $ \\dot{\\gamma} \\ge 0 $，$ f \\le 0 $，$ \\dot{\\gamma}\\,f = 0 $。\n\n假设 $ \\sigma_{n+1} > 0 $ （单调拉伸），因此在该步中 $ |\\sigma| = \\sigma $。后向欧拉更新可表示为：\n- 弹性预测：$ \\sigma_{\\mathrm{tr}} = E\\big(\\epsilon_{n+1} - \\epsilon^{p}_{n}\\big) $ 和 $ f_{\\mathrm{tr}} = \\sigma_{\\mathrm{tr}} - \\big(\\sigma_{y0} + H\\,\\alpha_{n}\\big) $。\n- 如果 $ f_{\\mathrm{tr}} \\le 0 $，则该步为弹性步：$ \\epsilon^{p}_{n+1} = \\epsilon^{p}_{n} $，$ \\alpha_{n+1} = \\alpha_{n} $，$ \\sigma_{n+1} = \\sigma_{\\mathrm{tr}} $。\n- 如果 $ f_{\\mathrm{tr}} > 0 $，则执行塑性修正，其中塑性乘子增量 $ \\Delta\\gamma \\ge 0 $ 未知：\n  $ \\epsilon^{p}_{n+1} = \\epsilon^{p}_{n} + \\Delta\\gamma $，\n  $ \\alpha_{n+1} = \\alpha_{n} + \\Delta\\gamma $，\n  $ \\sigma_{n+1} = E\\big(\\epsilon_{n+1} - \\epsilon^{p}_{n+1}\\big) $，\n  并强制执行一致性条件 $ f_{n+1} = \\sigma_{n+1} - \\big(\\sigma_{y0} + H\\,\\alpha_{n+1}\\big) = 0 $。\n\n仅使用这些要素，从第一性原理推导一致（算法）切线模量，其定义为完全离散本构更新的精确雅可比矩阵 $ \\mathbb{C}_{\\mathrm{alg}} = \\mathrm{d}\\sigma_{n+1}/\\mathrm{d}\\epsilon_{n+1} $。需针对以下两种情况进行推导：\n- 弹性情况 $ f_{\\mathrm{tr}} \\le 0 $（无塑性修正），以及\n- 塑性情况 $ f_{\\mathrm{tr}} > 0 $（回映算法，其中 $ \\Delta\\gamma > 0 $）。\n\n然后，通过比较两种情况的结果并从物理上解释其跳跃，说明为什么切线模量在屈服面上是不连续的。\n\n将最终答案以单行矩阵的形式报告，其第一个条目是弹性一致切线模量，第二个条目是塑性一致切线模量，用 $ E $ 和 $ H $ 以符号闭式形式表示。不要代入任何数值。最终报告的结果中不要包含单位。", "solution": "该问题陈述构成了一个计算非弹性力学中标准的、适定的练习。所有给定的定义、方程和条件在科学上都是合理的，内部一致，并且足以推导所需量。该问题是可形式化的，并直接与指定主题相关。因此，该问题被认为是有效的。现在将从第一性原理开始推导。\n\n目标是推导一致（或算法）切线模量，其定义为离散应力更新算法的精确线性化，即 $\\mathbb{C}_{\\mathrm{alg}} = \\mathrm{d}\\sigma_{n+1}/\\mathrm{d}\\epsilon_{n+1}$。时间 $t_n$ 时的状态变量，即 $\\epsilon^{p}_{n}$ 和 $\\alpha_{n}$，在第 $n+1$ 步的微分中被视为常量。推导是针对由试探屈服函数 $f_{\\mathrm{tr}}$ 的值决定的两种相互排斥的情况进行的。\n\n**情况1：弹性步 ($f_{\\mathrm{tr}} \\le 0$)**\n\n在弹性步的情况下，更新规则指定为：\n$ \\epsilon^{p}_{n+1} = \\epsilon^{p}_{n} $\n$ \\alpha_{n+1} = \\alpha_{n} $\n$ \\sigma_{n+1} = \\sigma_{\\mathrm{tr}} $\n试探应力 $\\sigma_{\\mathrm{tr}}$ 由弹性预测器定义：\n$$ \\sigma_{\\mathrm{tr}} = E \\left(\\epsilon_{n+1} - \\epsilon^{p}_{n}\\right) $$\n综合这些，该步结束时的应力由下式给出：\n$$ \\sigma_{n+1} = E \\left(\\epsilon_{n+1} - \\epsilon^{p}_{n}\\right) $$\n为了找到此情况下的算法切线模量 $\\mathbb{C}_{\\mathrm{alg}}^{\\mathrm{el}}$，我们将 $\\sigma_{n+1}$ 的表达式对该步结束时的总应变 $\\epsilon_{n+1}$ 求导。上一步的塑性应变 $\\epsilon^{p}_{n}$ 是一个恒定的历史变量。\n$$ \\mathbb{C}_{\\mathrm{alg}}^{\\mathrm{el}} = \\frac{\\mathrm{d}\\sigma_{n+1}}{\\mathrm{d}\\epsilon_{n+1}} = \\frac{\\mathrm{d}}{\\mathrm{d}\\epsilon_{n+1}} \\left[ E \\left(\\epsilon_{n+1} - \\epsilon^{p}_{n}\\right) \\right] $$\n进行微分可得：\n$$ \\mathbb{C}_{\\mathrm{alg}}^{\\mathrm{el}} = E $$\n因此，在弹性区域，一致切线模量与杨氏模量 $E$ 相同。这是预期的结果，因为材料响应是纯弹性的。\n\n**情况2：塑性步 ($f_{\\mathrm{tr}} > 0$)**\n\n在塑性步的情况下，执行回映算法。$n+1$ 时的状态由以下代数方程组确定，其中塑性乘子增量 $\\Delta\\gamma > 0$ 是一个未知数：\n1. 应力-应变关系：$ \\sigma_{n+1} = E \\left(\\epsilon_{n+1} - \\epsilon^{p}_{n+1}\\right) $\n2. 塑性应变更新：$ \\epsilon^{p}_{n+1} = \\epsilon^{p}_{n} + \\Delta\\gamma $\n3. 硬化变量更新：$ \\alpha_{n+1} = \\alpha_{n} + \\Delta\\gamma $\n4. 离散一致性条件：$ f_{n+1} = \\sigma_{n+1} - \\left(\\sigma_{y0} + H\\alpha_{n+1}\\right) = 0 $\n\n我们可以组合这些方程。将(2)代入(1)：\n$$ \\sigma_{n+1} = E \\left(\\epsilon_{n+1} - \\epsilon^{p}_{n} - \\Delta\\gamma\\right) $$\n将此式和(3)代入一致性条件(4)：\n$$ E \\left(\\epsilon_{n+1} - \\epsilon^{p}_{n} - \\Delta\\gamma\\right) - \\left(\\sigma_{y0} + H\\left(\\alpha_{n} + \\Delta\\gamma\\right)\\right) = 0 $$\n该系统将最终状态 $(\\sigma_{n+1}, \\Delta\\gamma, \\dots)$ 隐式地定义为驱动变量 $\\epsilon_{n+1}$ 的函数。为了找到一致切线模量 $\\mathbb{C}_{\\mathrm{alg}}^{\\mathrm{pl}} = \\mathrm{d}\\sigma_{n+1}/\\mathrm{d}\\epsilon_{n+1}$，我们对这个隐式系统进行微分。让我们对回映映射的基本关系进行微分。一致性条件 $f_{n+1}=0$ 必须对塑性域中任何有效的 $\\epsilon_{n+1}$ 成立，因此其全微分必须为零。\n$$ \\mathrm{d}f_{n+1} = 0 $$\n使用链式法则展开此式：\n$$ \\frac{\\partial f_{n+1}}{\\partial \\sigma_{n+1}} \\mathrm{d}\\sigma_{n+1} + \\frac{\\partial f_{n+1}}{\\partial \\alpha_{n+1}} \\mathrm{d}\\alpha_{n+1} = 0 $$\n对于给定的单轴屈服函数 $f_{n+1} = \\sigma_{n+1} - (\\sigma_{y0} + H\\alpha_{n+1})$，其偏导数为 $\\partial f_{n+1} / \\partial \\sigma_{n+1} = 1$ 和 $\\partial f_{n+1} / \\partial \\alpha_{n+1} = -H$。硬化变量的微分为 $\\mathrm{d}\\alpha_{n+1} = \\mathrm{d}(\\alpha_n + \\Delta\\gamma) = \\mathrm{d}\\Delta\\gamma$。将这些代入微分后的一致性条件中，得到：\n$$ 1 \\cdot \\mathrm{d}\\sigma_{n+1} - H \\cdot \\mathrm{d}\\Delta\\gamma = 0 \\implies \\mathrm{d}\\sigma_{n+1} = H\\,\\mathrm{d}\\Delta\\gamma $$\n接下来，我们对应力更新方程 $\\sigma_{n+1} = E(\\epsilon_{n+1} - \\epsilon^p_{n+1}) = E(\\epsilon_{n+1} - \\epsilon^p_n - \\Delta\\gamma)$ 进行微分：\n$$ \\mathrm{d}\\sigma_{n+1} = E(\\mathrm{d}\\epsilon_{n+1} - \\mathrm{d}\\Delta\\gamma) $$\n我们现在有一个关于微分量 $\\mathrm{d}\\sigma_{n+1}$ 和 $\\mathrm{d}\\Delta\\gamma$ 的线性方程组：\n$$ \\begin{cases} \\mathrm{d}\\sigma_{n+1} = H\\,\\mathrm{d}\\Delta\\gamma \\\\ \\mathrm{d}\\sigma_{n+1} = E(\\mathrm{d}\\epsilon_{n+1} - \\mathrm{d}\\Delta\\gamma) \\end{cases} $$\n从第一个方程，我们用 $\\mathrm{d}\\sigma_{n+1}$ 表示 $\\mathrm{d}\\Delta\\gamma$（对于 $H0$）：$\\mathrm{d}\\Delta\\gamma = \\frac{1}{H}\\mathrm{d}\\sigma_{n+1}$。对于理想塑性情况 $H=0$，这导致 $\\mathrm{d}\\sigma_{n+1}=0$，正确地意味着塑性切线模量为零。最终的公式将是通用的。将此式代入第二个方程：\n$$ \\mathrm{d}\\sigma_{n+1} = E\\left(\\mathrm{d}\\epsilon_{n+1} - \\frac{1}{H}\\mathrm{d}\\sigma_{n+1}\\right) = E\\,\\mathrm{d}\\epsilon_{n+1} - \\frac{E}{H}\\mathrm{d}\\sigma_{n+1} $$\n现在，我们求解 $\\mathrm{d}\\sigma_{n+1}$：\n$$ \\mathrm{d}\\sigma_{n+1} \\left(1 + \\frac{E}{H}\\right) = E\\,\\mathrm{d}\\epsilon_{n+1} $$\n$$ \\mathrm{d}\\sigma_{n+1} \\left(\\frac{H+E}{H}\\right) = E\\,\\mathrm{d}\\epsilon_{n+1} $$\n$$ \\mathrm{d}\\sigma_{n+1} = \\frac{EH}{E+H} \\mathrm{d}\\epsilon_{n+1} $$\n因此，塑性情况的一致切线模量是 $\\mathrm{d}\\epsilon_{n+1}$ 的系数：\n$$ \\mathbb{C}_{\\mathrm{alg}}^{\\mathrm{pl}} = \\frac{EH}{E+H} $$\n这可以被视为弹性模量 $E$ 和硬化模量 $H$ 的串联组合，通常写作 $(E^{-1} + H^{-1})^{-1}$。\n\n**切线模量的不连续性**\n\n推导出的切线模量为：\n- 弹性加载/卸载 ($f_{\\mathrm{tr}} \\le 0$): $ \\mathbb{C}_{\\mathrm{alg}}^{\\mathrm{el}} = E $\n- 塑性加载 ($f_{\\mathrm{tr}} > 0$): $ \\mathbb{C}_{\\mathrm{alg}}^{\\mathrm{pl}} = \\frac{EH}{E+H} $\n\n这两种状态之间的过渡发生在屈服条件 $f_{\\mathrm{tr}}=0$ 处。为了分析其连续性，我们在此过渡边界比较这两个表达式。\n给定 $E>0$ 和物理约束 $H \\ge 0$，我们有 $E+H \\ge E$。这意味着分数 $\\frac{H}{E+H} \\le 1$。\n对于任何有限的硬化模量 $H \\ge 0$ 和 $E0$，严格不等式 $\\frac{H}{E+H}  1$ 成立。\n因此，对于任何有限的 $H$：\n$$ \\mathbb{C}_{\\mathrm{alg}}^{\\mathrm{pl}} = E \\left( \\frac{H}{E+H} \\right)  E = \\mathbb{C}_{\\mathrm{alg}}^{\\mathrm{el}} $$\n等式 $\\mathbb{C}_{\\mathrm{alg}}^{\\mathrm{pl}} = E$ 只有在非物理的极限情况 $H \\to \\infty$ 时才能达到，这对应于无限强的硬化，阻止任何塑性应变的发生。\n由于对于任何物理上相关的硬化模量，都有 $\\mathbb{C}_{\\mathrm{alg}}^{\\mathrm{pl}} \\neq \\mathbb{C}_{\\mathrm{alg}}^{\\mathrm{el}}$，因此当材料状态穿过屈服面时（即当$f_{\\mathrm{tr}}$ 通过零时），算法切线模量 $\\mathbb{C}_{\\mathrm{alg}}$ 表现出跳跃不连续性。\n\n这种不连续性的物理解释如下。切线模量代表材料的刚度。\n- 在弹性区域，总应变增量 $\\mathrm{d}\\epsilon$ 完全由弹性变形承担，即 $\\mathrm{d}\\epsilon^e = \\mathrm{d}\\epsilon$，导致应力增加 $\\mathrm{d}\\sigma = E \\mathrm{d}\\epsilon$。\n- 屈服后，一种新的、耗散的变形机制——塑性流动——被突然激活。总应变增量 $\\mathrm{d}\\epsilon$ 现在被分解为弹性部分 $\\mathrm{d}\\epsilon^e$ 和塑性部分 $\\mathrm{d}\\epsilon^p$。应力增加仅由弹性部分控制：$\\mathrm{d}\\sigma = E \\mathrm{d}\\epsilon^e = E(\\mathrm{d}\\epsilon - \\mathrm{d}\\epsilon^p)$。因为施加的部分应变增量被永久塑性流动所消耗 ($\\mathrm{d}\\epsilon^p > 0$)，所以可用于产生应变的部分就变少了，从而导致有效刚度降低。\n切线模量从 $E$ 到 $\\frac{EH}{E+H}$ 的不连续性是材料内部响应机制这种突然转变的数学表现，这是具有光滑屈服面的率无关塑性模型的一个典型特征。", "answer": "$$\n\\boxed{\\begin{pmatrix} E  \\frac{EH}{E+H} \\end{pmatrix}}\n$$", "id": "2694728"}, {"introduction": "现在我们已经理解了在塑性区需要一个与弹性区不同的切向模量，让我们来为一个随塑性变形而强化的材料（即硬化材料）推导这个模量。这个练习将指导你为一个具有线性各向同性硬化的单轴加载材料，推导其标量形式的一致性切向模量 $C_{\\text{alg}}$。整个推导过程从塑性理论的第一性原理出发，并采用隐式返回映射算法 [@problem_id:2893856]。", "problem": "考虑一个由各向同性硬化、率无关、关联弹塑性材料制成的小应变单轴杆。设弹性模量为 $E$，（线性）各向同性硬化模量为 $H$。应变加法分解成立，且弹性响应是线性的。屈服函数的形式为 $f(\\sigma,\\varepsilon^{p}) = |\\sigma| - \\sigma_{y}(\\varepsilon^{p})$，其中 $\\sigma_{y}(\\varepsilon^{p}) = \\sigma_{y0} + H\\,\\varepsilon^{p}$，$\\sigma_{y0}  0$ 为初始屈服应力。假设为单调拉伸加载，因此 $|\\sigma| = \\sigma$，且塑性加载处于激活状态，并在屈服面上强制满足一致性条件。\n\n从基本运动学分解、线性弹性关系、屈服函数的定义、关联流动法则以及一致性条件出发，推导在主动塑性加载条件下，通过隐式返回映射更新得到的标量算法（一致）切线模量 $C_{\\text{alg}} = \\dfrac{d\\sigma}{d\\varepsilon}$。将最终结果表示为仅含 $E$ 和 $H$ 的闭式符号表达式。以符号形式报告答案，无需数值代入或单位。", "solution": "对问题进行有效性验证。\n\n**第一步：提取已知条件**\n- 本构模型：各向同性硬化、率无关、关联弹塑性材料。\n- 运动学：小应变单轴杆，应变加法分解 $\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$。\n- 弹性：线性，弹性模量为 $E$。\n- 硬化：线性各向同性硬化，模量为 $H$。\n- 屈服函数：$f(\\sigma,\\varepsilon^{p}) = |\\sigma| - \\sigma_{y}(\\varepsilon^{p})$。\n- 屈服应力演化：$\\sigma_{y}(\\varepsilon^{p}) = \\sigma_{y0} + H\\,\\varepsilon^{p}$，初始屈服应力 $\\sigma_{y0}  0$。\n- 加载：单调拉伸加载，意味着 $\\sigma  0$ 且 $|\\sigma| = \\sigma$。\n- 塑性状态：主动塑性加载，满足一致性条件。\n- 目标：推导标量算法（一致）切线模量 $C_{\\text{alg}} = \\dfrac{d\\sigma}{d\\varepsilon}$，并用 $E$ 和 $H$ 表示。\n\n**第二步：使用提取的已知条件进行验证**\n对问题陈述进行有效性分析。\n- **科学依据**：该问题是率无关塑性经典理论的应用，这是连续介质力学和计算力学中的一个基本课题。所描述的模型是带线性各向同性硬化的 $J_2$ 塑性理论的一个标准一维特例。所有引用的原理都是标准的、科学合理的。此项有效。\n- **适定性**：问题陈述清晰，提供了所有必要的物理和数学定义。目标是推导一个明确定义的特定量 ($C_{\\text{alg}}$)。单调加载和主动塑性的假设确保了推导路径的唯一性。此项有效。\n- **客观性**：语言精确、专业，不含任何主观或非科学内容。此项有效。\n\n**第三步：结论与行动**\n该问题被判定为**有效**，因为它具有科学依据、适定性且客观。它代表了计算固体力学中的一个标准练习。现在开始求解过程。\n\n算法切线模量 $C_{\\text{alg}}$ 的推导需要对演化方程进行时间离散化。我们考虑一个典型的时间增量，从时间 $t_{n}$ 的状态到时间 $t_{n+1}$ 的状态。令 $t_{n+1}$ 时刻的总应变为 $\\varepsilon_{n+1}$。我们使用隐式后向欧拉积分格式，这是返回映射算法的标准方法。\n\n在增量步结束时，即在状态 $n+1$ 时，必须满足以下基本关系：\n1.  应变分解：$\\varepsilon_{n+1} = \\varepsilon^{e}_{n+1} + \\varepsilon^{p}_{n+1}$。\n2.  线性弹性定律：$\\sigma_{n+1} = E \\varepsilon^{e}_{n+1}$。\n3.  关联流动法则：对于单轴拉伸，屈服函数为 $f = \\sigma - \\sigma_y$。流动方向为 $\\dfrac{\\partial f}{\\partial \\sigma} = 1$。离散流动法则为 $\\varepsilon^{p}_{n+1} - \\varepsilon^{p}_{n} = \\Delta \\varepsilon^{p} = \\Delta\\gamma \\dfrac{\\partial f}{\\partial \\sigma} = \\Delta\\gamma$，其中 $\\Delta\\gamma \\ge 0$ 是塑性乘子增量。\n4.  硬化定律：屈服应力演化为 $\\sigma_{y, n+1} = \\sigma_{y0} + H \\varepsilon^{p}_{n+1}$。\n5.  一致性条件：由于塑性加载处于激活状态，最终状态必须位于更新后的屈服面上，因此 $f_{n+1} = 0$。这给出 $\\sigma_{n+1} - \\sigma_{y,n+1} = 0$。\n\n根据弹性定律和应变分解，我们将应力表示为：\n$$ \\sigma_{n+1} = E (\\varepsilon_{n+1} - \\varepsilon^{p}_{n+1}) $$\n代入流动法则 $\\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n} + \\Delta\\gamma$：\n$$ \\sigma_{n+1} = E (\\varepsilon_{n+1} - \\varepsilon^{p}_{n} - \\Delta\\gamma) $$\n我们可以识别出弹性试探应力 $\\sigma^{\\text{trial}} = E(\\varepsilon_{n+1} - \\varepsilon^{p}_{n})$，这是假设整个应变增量都为弹性时将获得的应力。方程变为：\n$$ \\sigma_{n+1} = \\sigma^{\\text{trial}} - E \\Delta\\gamma $$\n这就是“返回映射”方程，它在几何上将试探应力拉回到屈服面上。\n\n现在，我们使用一致性条件来求解 $\\Delta\\gamma$。\n$$ \\sigma_{n+1} - (\\sigma_{y0} + H \\varepsilon^{p}_{n+1}) = 0 $$\n代入 $\\sigma_{n+1}$ 和 $\\varepsilon^{p}_{n+1}$ 的表达式：\n$$ (\\sigma^{\\text{trial}} - E \\Delta\\gamma) - (\\sigma_{y0} + H (\\varepsilon^{p}_{n} + \\Delta\\gamma)) = 0 $$\n我们整理各项以求解 $\\Delta\\gamma$：\n$$ \\sigma^{\\text{trial}} - \\sigma_{y0} - H \\varepsilon^{p}_{n} - E \\Delta\\gamma - H \\Delta\\gamma = 0 $$\n令 $\\sigma_{y,n} = \\sigma_{y0} + H \\varepsilon^{p}_{n}$ 为增量步开始时的屈服应力。方程简化为：\n$$ (\\sigma^{\\text{trial}} - \\sigma_{y,n}) - (E+H)\\Delta\\gamma = 0 $$\n项 $(\\sigma^{\\text{trial}} - \\sigma_{y,n})$ 是在试探状态下计算的屈服函数值，即 $f^{\\text{trial}}$。由于塑性加载处于激活状态，所以 $f^{\\text{trial}}  0$。求解 $\\Delta\\gamma$：\n$$ \\Delta\\gamma = \\frac{\\sigma^{\\text{trial}} - \\sigma_{y,n}}{E+H} $$\n现在我们得到了塑性乘子的表达式。我们可以根据总应变 $\\varepsilon_{n+1}$ 和状态 $n$ 时的值来求解最终应力 $\\sigma_{n+1}$。将 $\\Delta\\gamma$ 代回到应力方程 $\\sigma_{n+1} = \\sigma^{\\text{trial}} - E \\Delta\\gamma$ 中：\n$$ \\sigma_{n+1} = \\sigma^{\\text{trial}} - E \\left( \\frac{\\sigma^{\\text{trial}} - \\sigma_{y,n}}{E+H} \\right) $$\n为了简化，我们将所有项通分：\n$$ \\sigma_{n+1} = \\frac{(E+H)\\sigma^{\\text{trial}} - E\\sigma^{\\text{trial}} + E\\sigma_{y,n}}{E+H} $$\n$$ \\sigma_{n+1} = \\frac{H\\sigma^{\\text{trial}} + E\\sigma_{y,n}}{E+H} $$\n该表达式给出了更新后的应力 $\\sigma_{n+1}$，它是试探应力 $\\sigma^{\\text{trial}}$ 和上一步屈服应力 $\\sigma_{y,n}$ 的函数。\n\n算法切线模量定义为更新后的应力 $\\sigma_{n+1}$ 对总应变 $\\varepsilon_{n+1}$ 的导数：\n$$ C_{\\text{alg}} = \\frac{d\\sigma_{n+1}}{d\\varepsilon_{n+1}} $$\n为了计算这个导数，我们必须回顾 $\\sigma^{\\text{trial}}$ 和 $\\sigma_{y,n}$ 是如何依赖于 $\\varepsilon_{n+1}$ 的。\n- 试探应力为 $\\sigma^{\\text{trial}} = E(\\varepsilon_{n+1} - \\varepsilon^{p}_{n})$。它对 $\\varepsilon_{n+1}$ 的导数为 $\\dfrac{d\\sigma^{\\text{trial}}}{d\\varepsilon_{n+1}} = E$。\n- 增量步开始时的屈服应力 $\\sigma_{y,n}$ 仅依赖于 $t_n$ 时刻的状态，因此相对于 $\\varepsilon_{n+1}$ 是一个常数。所以，$\\dfrac{d\\sigma_{y,n}}{d\\varepsilon_{n+1}} = 0$。\n\n现在我们对 $\\sigma_{n+1}$ 的表达式求导：\n$$ C_{\\text{alg}} = \\frac{d}{d\\varepsilon_{n+1}} \\left( \\frac{H\\sigma^{\\text{trial}} + E\\sigma_{y,n}}{E+H} \\right) = \\frac{1}{E+H} \\left( H\\frac{d\\sigma^{\\text{trial}}}{d\\varepsilon_{n+1}} + E\\frac{d\\sigma_{y,n}}{d\\varepsilon_{n+1}} \\right) $$\n代入导数：\n$$ C_{\\text{alg}} = \\frac{1}{E+H} (H \\cdot E + E \\cdot 0) $$\n$$ C_{\\text{alg}} = \\frac{EH}{E+H} $$\n这就是一维线性各向同性硬化塑性模型的标量算法切线模量的推导表达式。值得注意的是，对于这个特定的简单情况，算法切线模量与连续弹塑性切线模量是相同的。", "answer": "$$\n\\boxed{\\frac{EH}{E+H}}\n$$", "id": "2893856"}, {"introduction": "一致性切向模量不仅仅是一个理论概念，它更是非线性有限元分析中切向刚度矩阵的基石。这最后一个练习将连接材料点层面和结构单元层面，你将使用前面推导的一致性切向模量，为一个简单的杆单元组装其单元切向刚度矩阵 $\\mathbf{K}_{\\mathrm{T}}^{e}$。通过这个实践，你将巩固对材料本构响应如何通过一致性切向模量进行线性化，并直接影响隐式有限元模拟中求解的全局方程组的理解 [@problem_id:2541422]。", "problem": "一个长度为 $L$、横截面积恒为 $A$ 的双节点一维杆有限元，在小应变且无几何非线性的条件下，被用于弧长 (Riks/Crisfield) 路径跟踪分析。材料为具有线性各向同性硬化的率无关弹塑性材料。其一维本构方程为\n- 弹性定律：$\\sigma = E\\left(\\varepsilon - \\varepsilon^{p}\\right)$，其中 $E$ 为杨氏模量，\n- 屈服函数：$f(\\sigma,\\alpha) \\coloneqq \\sigma - \\sigma_{y0} - H\\,\\alpha \\le 0$，其中 $\\sigma_{y0}$ 为初始屈服应力，$H \\ge 0$ 为硬化模量，\n- 相关联的流动与硬化：$\\dot{\\varepsilon}^{p} = \\dot{\\gamma}$，$\\dot{\\alpha} = \\dot{\\gamma}$，以及 Karush–Kuhn–Tucker 条件 $\\dot{\\gamma} \\ge 0$， $f \\le 0$， $\\dot{\\gamma}\\,f = 0$。\n\n考虑从 $n$ 到 $n+1$ 的一个加载步，在此步中单元内的总（工程）应变 $\\varepsilon_{n+1}$ 是均匀的，并且可由位移场确定。第 $n$ 步的内变量已知，即 $\\varepsilon^{p}_{n}$ 和 $\\alpha_{n}$。假设为单调拉伸加载，因此 $\\sigma \\ge 0$，并假设在该步结束时塑性加载处于激活状态，即塑性乘子增量 $\\Delta\\gamma > 0$ 且一致性条件 $f_{n+1} = 0$ 成立。在这些假设下，弧长法需要一致算法切线模量 $E_{\\mathrm{alg}} \\coloneqq \\dfrac{\\partial \\sigma_{n+1}}{\\partial \\varepsilon_{n+1}}$ 来构建包含材料切线的雅可比矩阵。\n\n从上述本构定义和条件出发，不引用任何预先给出的返回映射公式，推导该步结束时一致算法切线模量 $E_{\\mathrm{alg}}$ 的闭式表达式。然后，对于线性双节点杆，组集单元一致切线刚度矩阵\n$$\n\\mathbf{K}_{\\mathrm{T}}^{e} \\;=\\; \\int_{0}^{L} \\mathbf{B}^{\\mathsf{T}}\\, A\\, E_{\\mathrm{alg}}\\, \\mathbf{B}\\, \\mathrm{d}x\n$$\n其中 $\\mathbf{B}$ 是该单元的常应变-位移矩阵。将 $\\mathbf{K}_{\\mathrm{T}}^{e}$ 写成规范形式 $k_{e}\\begin{bmatrix}1  -1\\\\ -1  1\\end{bmatrix}$，并用 $E$、$H$、$A$ 和 $L$ 来确定标量系数 $k_{e}$。\n\n你的最终答案必须是 $k_{e}$ 的一个单一闭式解析表达式（无单位）。不要提供不等式或方程式；只提供 $k_{e}$ 的表达式。", "solution": "该问题陈述是计算非弹性力学中一个有效且适定的练习。我们将着手求解。\n\n目标是推导一维率无关弹塑性材料模型（带线性各向同性硬化）的一致算法切线模量 $E_{\\mathrm{alg}}$，并随后计算单元一致切线刚度矩阵的标量系数 $k_{e}$。\n\n分析考虑从状态 $n$ 到状态 $n+1$ 的单个时间步。状态 $n+1$ 由基于后向欧拉积分格式的以下方程组表征：\n应力由弹性定律给出：\n$$\n\\sigma_{n+1} = E(\\varepsilon_{n+1} - \\varepsilon^{p}_{n+1}) \\quad (1)\n$$\n其中 $E$ 是杨氏模量，$\\varepsilon_{n+1}$ 是总应变，$\\varepsilon^{p}_{n+1}$ 是塑性应变。\n塑性应变和硬化内变量 $\\alpha$ 通过塑性乘子增量 $\\Delta\\gamma$ 从它们在第 $n$ 步的已知值更新：\n$$\n\\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n} + \\Delta\\gamma \\quad (2)\n$$\n$$\n\\alpha_{n+1} = \\alpha_{n} + \\Delta\\gamma \\quad (3)\n$$\n问题陈述指出在该步结束时塑性加载处于激活状态，这意味着该状态必须满足一致性条件：\n$$\nf_{n+1} = \\sigma_{n+1} - \\sigma_{y0} - H\\alpha_{n+1} = 0 \\quad (4)\n$$\n其中 $\\sigma_{y0}$ 是初始屈服应力，$H$ 是硬化模量。假设条件 $\\Delta\\gamma > 0$ 成立。\n\n为了找到 $\\Delta\\gamma$ 的表达式，我们将方程 $(1)$、$(2)$ 和 $(3)$ 代入方程 $(4)$：\n$$\nE(\\varepsilon_{n+1} - \\varepsilon^{p}_{n+1}) - \\sigma_{y0} - H\\alpha_{n+1} = 0\n$$\n$$\nE(\\varepsilon_{n+1} - (\\varepsilon^{p}_{n} + \\Delta\\gamma)) - \\sigma_{y0} - H(\\alpha_{n} + \\Delta\\gamma) = 0\n$$\n我们重新整理这个方程以求解 $\\Delta\\gamma$。将包含 $\\Delta\\gamma$ 的项移到一边：\n$$\nE(\\varepsilon_{n+1} - \\varepsilon^{p}_{n}) - \\sigma_{y0} - H\\alpha_{n} = E\\Delta\\gamma + H\\Delta\\gamma\n$$\n$$\nE\\varepsilon_{n+1} - E\\varepsilon^{p}_{n} - \\sigma_{y0} - H\\alpha_{n} = (E + H)\\Delta\\gamma\n$$\n定义一个弹性试探应力 $\\sigma^{\\text{trial}}_{n+1}$ 会很方便，它是指如果增量是纯弹性时将会存在的应力：\n$$\n\\sigma^{\\text{trial}}_{n+1} \\coloneqq E(\\varepsilon_{n+1} - \\varepsilon^{p}_{n})\n$$\n那么 $\\Delta\\gamma$ 的方程变为：\n$$\n\\sigma^{\\text{trial}}_{n+1} - \\sigma_{y0} - H\\alpha_{n} = (E + H)\\Delta\\gamma\n$$\n左边是在试探状态下计算的屈服函数值 $f^{\\text{trial}}_{n+1}$。由于 $\\Delta\\gamma > 0$ 且 $E+H > 0$ (因为 $E>0, H \\ge 0$)，必然有 $f^{\\text{trial}}_{n+1} > 0$。求解 $\\Delta\\gamma$ 得出：\n$$\n\\Delta\\gamma = \\frac{\\sigma^{\\text{trial}}_{n+1} - \\sigma_{y0} - H\\alpha_{n}}{E + H} = \\frac{E(\\varepsilon_{n+1} - \\varepsilon^{p}_{n}) - \\sigma_{y0} - H\\alpha_{n}}{E + H} \\quad (5)\n$$\n现在我们可以将最终应力 $\\sigma_{n+1}$ 写成总应变 $\\varepsilon_{n+1}$ 的函数。根据试探应力的定义，$\\sigma^{\\text{trial}}_{n+1} = E(\\varepsilon_{n+1} - \\varepsilon^{p}_{n})$，我们有 $\\sigma_{n+1} = E(\\varepsilon_{n+1} - \\varepsilon^{p}_{n} - \\Delta\\gamma) = \\sigma^{\\text{trial}}_{n+1} - E\\Delta\\gamma$。代入方程 $(5)$：\n$$\n\\sigma_{n+1} = \\sigma^{\\text{trial}}_{n+1} - E \\left( \\frac{\\sigma^{\\text{trial}}_{n+1} - \\sigma_{y0} - H\\alpha_{n}}{E + H} \\right)\n$$\n一致算法切线模量 $E_{\\mathrm{alg}}$ 定义为更新后的应力 $\\sigma_{n+1}$ 关于总应变 $\\varepsilon_{n+1}$ 的导数：\n$$\nE_{\\mathrm{alg}} \\coloneqq \\frac{\\partial \\sigma_{n+1}}{\\partial \\varepsilon_{n+1}}\n$$\n为计算此导数，我们将 $\\sigma_{n+1}$ 的表达式对 $\\varepsilon_{n+1}$ 求导。我们注意到第 $n$ 步的状态变量（$\\varepsilon^{p}_{n}$、$\\alpha_{n}$）相对于 $\\varepsilon_{n+1}$ 是常数。\n试探应力的导数是：\n$$\n\\frac{\\partial \\sigma^{\\text{trial}}_{n+1}}{\\partial \\varepsilon_{n+1}} = \\frac{\\partial}{\\partial \\varepsilon_{n+1}} \\left( E(\\varepsilon_{n+1} - \\varepsilon^{p}_{n}) \\right) = E\n$$\n应用链式法则：\n$$\nE_{\\mathrm{alg}} = \\frac{\\partial \\sigma^{\\text{trial}}_{n+1}}{\\partial \\varepsilon_{n+1}} - \\frac{E}{E+H} \\frac{\\partial}{\\partial \\varepsilon_{n+1}} \\left( \\sigma^{\\text{trial}}_{n+1} - \\sigma_{y0} - H\\alpha_{n} \\right)\n$$\n$$\nE_{\\mathrm{alg}} = E - \\frac{E}{E+H} \\left( \\frac{\\partial \\sigma^{\\text{trial}}_{n+1}}{\\partial \\varepsilon_{n+1}} - 0 - 0 \\right) = E - \\frac{E}{E+H} (E)\n$$\n$$\nE_{\\mathrm{alg}} = E \\left( 1 - \\frac{E}{E+H} \\right) = E \\left( \\frac{E+H-E}{E+H} \\right) = \\frac{EH}{E+H}\n$$\n这就是塑性加载情况下一致算法切线模量的表达式。\n\n接下来，我们组集单元一致切线刚度矩阵 $\\mathbf{K}_{\\mathrm{T}}^{e}$。对于长度为 $L$ 的双节点一维杆单元，位移场 $u(x)$ 由节点位移 $u_1$ 和 $u_2$ 通过线性形函数 $N_1(x) = 1 - x/L$ 和 $N_2(x) = x/L$ 插值得到。应变 $\\varepsilon$ 是位移的空间导数：\n$$\n\\varepsilon = \\frac{\\mathrm{d}u}{\\mathrm{d}x} = \\begin{pmatrix} \\frac{\\mathrm{d}N_1}{\\mathrm{d}x}  \\frac{\\mathrm{d}N_2}{\\mathrm{d}x} \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{L}  \\frac{1}{L} \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}\n$$\n因此，应变-位移矩阵 $\\mathbf{B}$ 是常数：\n$$\n\\mathbf{B} = \\frac{1}{L} \\begin{pmatrix} -1  1 \\end{pmatrix}\n$$\n刚度矩阵由以下积分给出：\n$$\n\\mathbf{K}_{\\mathrm{T}}^{e} = \\int_{0}^{L} \\mathbf{B}^{\\mathsf{T}}\\, A\\, E_{\\mathrm{alg}}\\, \\mathbf{B}\\, \\mathrm{d}x\n$$\n由于横截面积 $A$、切线模量 $E_{\\mathrm{alg}}$ 以及矩阵 $\\mathbf{B}$ 沿单元长度均为常数，该积分简化为：\n$$\n\\mathbf{K}_{\\mathrm{T}}^{e} = A E_{\\mathrm{alg}} L\\, \\mathbf{B}^{\\mathsf{T}}\\mathbf{B}\n$$\n我们计算乘积 $\\mathbf{B}^{\\mathsf{T}}\\mathbf{B}$：\n$$\n\\mathbf{B}^{\\mathsf{T}}\\mathbf{B} = \\left( \\frac{1}{L} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} \\right) \\left( \\frac{1}{L} \\begin{pmatrix} -1  1 \\end{pmatrix} \\right) = \\frac{1}{L^2} \\begin{pmatrix} (-1)(-1)  (-1)(1) \\\\ (1)(-1)  (1)(1) \\end{pmatrix} = \\frac{1}{L^2} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n将此代入 $\\mathbf{K}_{\\mathrm{T}}^{e}$ 的表达式中：\n$$\n\\mathbf{K}_{\\mathrm{T}}^{e} = A E_{\\mathrm{alg}} L \\left( \\frac{1}{L^2} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} \\right) = \\frac{A E_{\\mathrm{alg}}}{L} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n问题要求将此矩阵写成 $k_{e}\\begin{pmatrix}1  -1\\\\ -1  1\\end{pmatrix}$ 的形式。通过直接比较，标量系数 $k_e$ 为：\n$$\nk_{e} = \\frac{A E_{\\mathrm{alg}}}{L}\n$$\n最后，我们代入推导出的 $E_{\\mathrm{alg}}$ 的表达式：\n$$\nk_{e} = \\frac{A}{L} \\left( \\frac{EH}{E+H} \\right) = \\frac{AEH}{L(E+H)}\n$$\n这就是所要求的系数 $k_e$ 的闭式表达式。", "answer": "$$\n\\boxed{\\frac{AEH}{L(E+H)}}\n$$", "id": "2541422"}]}