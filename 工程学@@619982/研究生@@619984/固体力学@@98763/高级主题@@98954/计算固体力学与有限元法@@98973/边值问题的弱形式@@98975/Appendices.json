{"hands_on_practices": [{"introduction": "这第一个实践是一项基础练习，将引导您完成将边值问题的连续弱形式转化为离散代数系统的基本过程，而这正是有限元法 (FEM) 的核心。通过手动构建一个小的刚度矩阵和力向量，您将对抽象的变分原理如何具体化为一组可解的线性方程组有一个具体的理解。[@problem_id:2440325]", "problem": "考虑区间 $\\left(0,1\\right)$ 上的稳定一维扩散边界值问题 (BVP)：\n$$\n- \\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) \\;=\\; f_0 \\quad \\text{在 } \\left(0,1\\right) \\text{ 内},\n$$\n其中本质边界条件为 $u(0)=0$，自然边界条件为 $k\\,u'(1)=t_0$，这里 $k>0$，$f_0$ 和 $t_0$ 是给定的常数。使用标准的伽辽金有限元法 (FEM) 对该问题的弱形式进行离散化，在 $\\left[0,1\\right]$ 上使用两个均匀的线性单元（节点位于 $x_0=0$，$x_1=\\tfrac{1}{2}$，$x_2=1$）。施加本质边界条件 $u(0)=0$ 后，手动构建与未知节点值 $u_1$ 和 $u_2$ 相关联的组装后的简化 $2\\times 2$ 全局刚度矩阵和相应的右端力向量。\n\n请将最终答案表示为该组装后的简化 $2\\times 2$ 刚度矩阵的行列式，形式为仅含 $k$ 的简化解析表达式。不包含单位。无需四舍五入。", "solution": "首先将对问题陈述进行严格验证。\n\n**步骤 1：提取已知条件**\n- 微分方程：$$- \\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) \\;=\\; f_0$$\n- 域：$x \\in (0,1)$\n- 边界条件：$u(0)=0$ (本质) 和 $k\\,u'(1)=t_0$ (自然)\n- 常数：$k>0$，$f_0$，$t_0$ 是给定常数。\n- 离散化：标准的伽辽金有限元法 (FEM)，使用两个均匀线性单元。\n- 节点：$x_0=0$，$x_1=\\tfrac{1}{2}$，$x_2=1$。\n- 目标：为未知节点值 $u_1$ 和 $u_2$ 构建简化的 $2\\times 2$ 全局刚度矩阵和力向量，然后求该刚度矩阵的行列式。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题是一个标准的二阶一维扩散边界值问题。\n- **科学依据：** 该问题是稳态热传导或扩散的典型表示，是物理学和工程学中的一个基本概念。它在科学上是合理的。\n- **适定性：** 对于二阶椭圆方程，一端为本质边界条件，另一端为自然（诺伊曼）边界条件的组合，确保了唯一且稳定解的存在。该问题是适定的。\n- **客观性：** 问题陈述使用精确的数学语言，没有主观或模棱两可的术语。\n- **完整性：** 所有必要信息，包括微分方程、域、边界条件、离散化方案和要求的输出，都已明确提供。该问题是自包含的。\n\n**步骤 3：结论和行动**\n问题有效。将推导完整解。\n\n起点是边界值问题的强形式：\n$$\n- \\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) = f_0 \\quad \\text{for } x \\in (0,1)\n$$\n边界条件为 $u(0)=0$ 和 $k \\frac{du}{dx}(1) = t_0$。\n\n为了推导弱形式，我们将微分方程乘以一个合适的测试函数 $v(x)$，并在域 $\\Omega = (0,1)$上进行积分：\n$$\n-\\int_{0}^{1} v \\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) dx = \\int_{0}^{1} v f_0 dx\n$$\n对左侧项应用分部积分法可得：\n$$\n\\int_{0}^{1} \\frac{dv}{dx} k \\frac{du}{dx} dx - \\left[ v k \\frac{du}{dx} \\right]_{0}^{1} = \\int_{0}^{1} v f_0 dx\n$$\n重新整理并代入边界条件：\n$$\n\\int_{0}^{1} k \\frac{du}{dx} \\frac{dv}{dx} dx = \\int_{0}^{1} f_0 v dx + v(1) \\left(k \\frac{du}{dx}(1)\\right) - v(0) \\left(k \\frac{du}{dx}(0)\\right)\n$$\n本质边界条件是 $u(0)=0$。测试函数 $v$ 必须属于一个函数空间，其中函数满足该条件的齐次形式，即 $v(0)=0$。这使得包含 $v(0)$ 的项消失。自然边界条件是 $k \\frac{du}{dx}(1) = t_0$。此值被直接代入。\n\n弱形式为：求 $u(x) \\in V = \\{ w \\in H^1(0,1) | w(0)=0 \\}$，使得对于所有 $v(x) \\in V$：\n$$\n\\int_{0}^{1} k u'(x) v'(x) dx = \\int_{0}^{1} f_0 v(x) dx + t_0 v(1)\n$$\n将域 $[0,1]$ 离散化为两个均匀单元，记为 $\\Omega_1 = [0, \\tfrac{1}{2}]$ 和 $\\Omega_2 = [\\tfrac{1}{2}, 1]$。节点位于 $x_0=0$，$x_1=\\tfrac{1}{2}$ 和 $x_2=1$。单元长度为 $h = \\tfrac{1}{2}$。\n\n我们使用线性基（形）函数 $N_i(x)$ 来近似解 $u(x)$：\n$$\nu(x) \\approx u^h(x) = \\sum_{j=0}^{2} u_j N_j(x) = u_0 N_0(x) + u_1 N_1(x) + u_2 N_2(x)\n$$\n其中 $u_j = u(x_j)$ 是节点值。伽辽金法使用基函数作为测试函数，即 $v(x) = N_i(x)$。\n\n长度为 $h$ 的线性单元的单元刚度矩阵由 $K^{(e)}_{ij} = \\int_{\\Omega_e} k \\frac{dN_j}{dx} \\frac{dN_i}{dx} dx$ 给出。对于常数 $k$ 和单元长度 $h$，此矩阵为：\n$$\nK^{(e)} = \\frac{k}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n由于 $h=\\tfrac{1}{2}$，两个单元的刚度矩阵均为：\n$$\nK^{(1)} = K^{(2)} = \\frac{k}{1/2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 2k & -2k \\\\ -2k & 2k \\end{pmatrix}\n$$\n由源项 $f_0$ 产生的单元力向量为 $F^{(e)}_{f,i} = \\int_{\\Omega_e} f_0 N_i dx$。对于常数 $f_0$ 和线性单元，此向量为：\n$$\nF^{(e)}_f = \\frac{f_0 h}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n由于 $h=\\tfrac{1}{2}$，两个单元的力向量均为：\n$$\nF^{(1)}_f = F^{(2)}_f = \\frac{f_0 (1/2)}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} f_0/4 \\\\ f_0/4 \\end{pmatrix}\n$$\n现在，我们组装 $3 \\times 3$ 的全局系统 $K \\mathbf{u} = F$。\n全局刚度矩阵 $K$ 是通过将每个单元的贡献相加来组装的：\n$K_{00} = K^{(1)}_{11} = 2k$\n$K_{11} = K^{(1)}_{22} + K^{(2)}_{11} = 2k + 2k = 4k$\n$K_{22} = K^{(2)}_{22} = 2k$\n$K_{01} = K_{10} = K^{(1)}_{12} = -2k$\n$K_{12} = K_{21} = K^{(2)}_{12} = -2k$\n因此，全局刚度矩阵是：\n$$\nK = \\begin{pmatrix} 2k & -2k & 0 \\\\ -2k & 4k & -2k \\\\ 0 & -2k & 2k \\end{pmatrix}\n$$\n全局力向量 $F$ 包含源项 $f_0$ 和自然边界条件 $t_0$ 的贡献。总力向量为 $F_i = \\int_0^1 f_0 N_i dx + t_0 N_i(1)$。\n$F_0 = \\int_{\\Omega_1} f_0 N_0 dx + t_0 N_0(1) = f_0/4 + t_0(0) = f_0/4$\n$F_1 = \\int_{\\Omega_1} f_0 N_1 dx + \\int_{\\Omega_2} f_0 N_1 dx + t_0 N_1(1) = f_0/4 + f_0/4 + t_0(0) = f_0/2$\n$F_2 = \\int_{\\Omega_2} f_0 N_2 dx + t_0 N_2(1) = f_0/4 + t_0(1) = f_0/4 + t_0$\n组装后的系统为：\n$$\n\\begin{pmatrix} 2k & -2k & 0 \\\\ -2k & 4k & -2k \\\\ 0 & -2k & 2k \\end{pmatrix} \\begin{pmatrix} u_0 \\\\ u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} f_0/4 \\\\ f_0/2 \\\\ f_0/4 + t_0 \\end{pmatrix}\n$$\n接下来，我们施加本质边界条件 $u(0)=u_0=0$。这将系统简化为关于未知节点值 $u_1$ 和 $u_2$ 的 $2 \\times 2$ 系统。我们考虑完整系统的第二行和第三行，并代入 $u_0=0$：\n$$-2k(0) + 4k u_1 - 2k u_2 = f_0/2 \\implies 4k u_1 - 2k u_2 = f_0/2$$\n$$0(0) - 2k u_1 + 2k u_2 = f_0/4 + t_0 \\implies -2k u_1 + 2k u_2 = f_0/4 + t_0$$\n得到的简化 $2 \\times 2$ 系统是：\n$$\n\\begin{pmatrix} 4k & -2k \\\\ -2k & 2k \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} f_0/2 \\\\ f_0/4 + t_0 \\end{pmatrix}\n$$\n问题要求的是组装后的简化 $2 \\times 2$ 全局刚度矩阵的行列式，该矩阵为：\n$$\nK_{reduced} = \\begin{pmatrix} 4k & -2k \\\\ -2k & 2k \\end{pmatrix}\n$$\n行列式计算如下：\n$$\n\\det(K_{reduced}) = (4k)(2k) - (-2k)(-2k) = 8k^2 - 4k^2 = 4k^2\n$$\n这就是所求的表达式。", "answer": "$$\\boxed{4k^{2}}$$", "id": "2440325"}, {"introduction": "在掌握了基础知识之后，本练习将展示弱形式的一大优点：它能够优雅地处理奇异载荷，例如集中的点力。虽然这类奇异点在强形式（微分形式）中处理起来在数学上较为棘手，但您将看到弱形式的积分性质如何通过狄拉克 $ \\delta $ 函数的特性自然地容纳它们。这个实践突显了变分方法在模拟更复杂情景时的优雅和物理直观性。[@problem_id:2440379]", "problem": "一根长度为 $L$、横截面积恒为 $A$ 的细杆，在稳态下导热，其热导率 $k$ 为常数。杆内没有分布式的体积热源，但在位置 $x_p$ 处施加了一个总速率为 $Q$（单位：瓦特）的集中点热源，其中 $0 < x_p < a < L$。边界温度给定为 $u(0) = 0$ 和 $u(L) = 0$。您将推导该边值问题的强形式和弱形式，然后使用有限元法（FEM）对解进行近似。网格包含两个线性单元和三个节点，分别位于 $x_0 = 0$、$x_1 = a$ 和 $x_2 = L$。特意选择 $x_p \\neq x_i$（对于任意节点），以使点热源严格位于左侧单元内部。\n\n仅从能量守恒和傅里叶定律出发，不使用任何简便公式：\n\n- 推导描述此情况的温度场 $u(x)$ 在 $(0,L)$ 上的强形式，包括所有边界条件。\n- 将强形式乘以一个满足本质边界条件的任意光滑测试函数 $v(x)$，并进行一次分部积分，从而推导弱形式，并指明所涉及的函数空间。\n- 构建每个单元上的双节点线性形函数，并利用弱形式得到关于三个节点温度 $u_0$、$u_1$ 和 $u_2$ 的单元级和组装后的全局有限元平衡方程。\n- 施加本质边界条件 $u_0 = 0$ 和 $u_2 = 0$，并求解得到的简化系统，以获得内部节点温度 $u_1$ 关于 $Q$、$k$、$A$、$L$、$a$ 和 $x_p$ 的闭合形式解。\n\n请提供 $u_1$ 的单一闭合形式解析表达式作为最终结果。温度以开尔文表示。", "solution": "在尝试求解之前，将对问题进行验证。这不是可选项，而是严谨科学工作的必要条件。\n\n第一步：提取已知条件。\n- 一根长度为 $L$、横截面积恒为 $A$ 的细杆。\n- 热传导处于稳态。\n- 热导率 $k$ 为常数。\n- 没有分布式的体积热源。\n- 在位置 $x_p$ 处施加了一个总速率为 $Q$ 的集中点热源。\n- 热源位置满足 $0  x_p  a  L$。\n- 给定的边界温度：$u(0) = 0$ 和 $u(L) = 0$。\n- 解将使用有限元法（FEM）在包含两个线性单元的网格上进行近似。\n- 三个节点位于 $x_0 = 0$、$x_1 = a$ 和 $x_2 = L$。\n- 点热源严格位于第一个单元内部，因为对于任意节点 $i$，都有 $x_p \\neq x_i$。\n- 节点温度 $u_1$ 的最终结果必须是单一的闭合形式解析表达式。\n- 温度以开尔文表示。\n\n第二步：使用提取的已知条件进行验证。\n根据有效性标准对问题进行评估。\n- **科学基础**：该问题基于热传递的基本原理，即能量守恒和傅里叶热传导定律。使用点热源（数学上用狄拉克δ函数表示）是物理学和工程分析中一种标准且有效的理想化方法。该问题在科学上是合理的。\n- **适定性**：该问题描述了一个二阶常微分方程，其两端具有给定的狄利克雷边界条件。这构成了一个适定的边值问题，预计存在唯一解。\n- **客观性**：问题陈述使用了精确、无歧义的技术语言，不含主观或基于观点的内容。\n- **完整性与一致性**：所有必要的参数（$L, A, k, Q, x_p, a$）、边界条件和几何约束均已提供。这些条件在内部是一致的（例如，$0  x_p  a  L$ 正确地将热源定位在所定义网格的第一个单元内）。\n- **物理真实性**：虽然 $u(0) = 0$ 开尔文的边界条件在物理上是不可能的，但它在理论问题中是一种常见的数学简化，通常表示相对于某个参考温度的温差。我们将基于这是一种数学理想化的理解继续进行。\n\n第三步：结论与行动。\n问题有效。将推导求解过程。\n\n推导将按要求的四个阶段进行。\n\n首先，我们推导边值问题的强形式。\n控制原理是稳态下的能量守恒。对于杆上不包含热源 $x_p$ 的任意一段 $[x_a, x_b]$，从 $x_a$ 处流入的热量速率必须等于从 $x_b$ 处流出的热量速率。热流速率由热通量 $q(x)$ 和面积 $A$ 的乘积给出。因此，$q(x_a)A - q(x_b)A = 0$。\n傅里叶定律指出 $q(x) = -k \\frac{du}{dx}$。将此代入能量平衡方程，得到 $-kA\\frac{du}{dx}|_{x_a} - (-kA\\frac{du}{dx}|_{x_b}) = 0$。由于这对任意区间 $[x_a, x_b]$ 都成立，这意味着量 $-kA \\frac{du}{dx}$ 是一个常数。对 $x$ 求导，得到无热源区域的控制微分方程：\n$$\n\\frac{d}{dx}\\left(-kA\\frac{du}{dx}\\right) = 0\n$$\n由于 $k$ 和 $A$ 是常数，方程简化为 $\\frac{d^2u}{dx^2} = 0$，其中 $x \\in (0, L)$ 且 $x \\neq x_p$。\n\n在点热源位置 $x_p$ 处，我们对一个无穷小控制体积 $[x_p - \\epsilon, x_p + \\epsilon]$（当 $\\epsilon \\to 0$ 时）进行能量平衡。平衡关系为：（在 $x_p-\\epsilon$ 处流入的热量）-（在 $x_p+\\epsilon$ 处流出的热量）+（热源项）= $0$。\n$$\n\\left(-kA\\frac{du}{dx}\\right)\\bigg|_{x_p-\\epsilon} - \\left(-kA\\frac{du}{dx}\\right)\\bigg|_{x_p+\\epsilon} + Q = 0\n$$\n这表示热通量存在一个不连续性。我们可以使用狄拉克δ函数 $\\delta(x-x_p)$ 来表示分布在整个域上的热源项 $Q$。于是，整个域 $(0,L)$ 上的控制方程变为：\n$$\n-kA\\frac{d^2u}{dx^2} = Q \\delta(x-x_p)\n$$\n强形式是：求解温度场 $u(x)$，使其满足此微分方程以及给定的狄利克雷边界条件：$u(0)=0$ 和 $u(L)=0$。\n\n第二，我们推导弱形式。\n我们将强形式的微分方程乘以一个光滑的测试函数 $v(x)$，并在域 $\\Omega = (0, L)$ 上积分。测试函数 $v(x)$ 必须属于函数空间 $V$，该空间中的函数满足本质边界条件的齐次形式，即 $v(0)=0$ 和 $v(L)=0$。\n$$\n\\int_0^L \\left(-kA\\frac{d^2u}{dx^2} - Q \\delta(x-x_p)\\right) v(x) \\,dx = 0\n$$\n此式必须对所有 $v \\in V$ 成立。我们将各项分开：\n$$\n-\\int_0^L kA\\frac{d^2u}{dx^2} v(x) \\,dx - \\int_0^L Q \\delta(x-x_p) v(x) \\,dx = 0\n$$\n第二个积分利用狄拉克δ函数的筛选性质进行计算：$\\int_0^L Q \\delta(x-x_p) v(x) \\,dx = Q v(x_p)$。\n我们对第一项应用分部积分法，$\\int u''v = [u'v] - \\int u'v'$：\n$$\n-\\int_0^L kA\\frac{d^2u}{dx^2} v(x) \\,dx = -kA \\left[ \\frac{du}{dx} v(x) \\right]_0^L + \\int_0^L kA \\frac{du}{dx} \\frac{dv}{dx} \\,dx\n$$\n边界项 $-kA \\left( \\frac{du}{dx}|_L v(L) - \\frac{du}{dx}|_0 v(0) \\right)$ 为零，因为对于任何测试函数 $v \\in V$，都有 $v(L)=0$ 和 $v(0)=0$。\n代回后，方程变为：\n$$\n\\int_0^L kA \\frac{du}{dx} \\frac{dv}{dx} \\,dx - Q v(x_p) = 0\n$$\n弱形式是：寻找 $u \\in U = \\{u \\in H^1(0,L) \\mid u(0)=0, u(L)=0\\}$，使得对于所有 $v \\in V = \\{v \\in H^1(0,L) \\mid v(0)=0, v(L)=0\\}$，以下关系成立：\n$$\n\\int_0^L kA \\frac{du}{dx} \\frac{dv}{dx} \\,dx = Q v(x_p)\n$$\n这里，$H^1(0,L)$ 是定义在 $(0,L)$ 上且其一阶导数平方可积的函数所构成的索博列夫空间。\n\n第三，我们构建有限元近似。\n将域 $[0, L]$ 离散化为节点 $x_0=0, x_1=a, x_2=L$，形成两个单元：单元 1 覆盖 $[0,a]$，单元 2 覆盖 $[a,L]$。\n温度场 $u(x)$ 和测试函数 $v(x)$ 使用线性形函数 $N_i(x)$ 进行近似：$u(x) \\approx u_h(x) = \\sum_{i=0}^{2} u_i N_i(x)$ 和 $v(x) \\approx v_h(x) = \\sum_{j=0}^{2} c_j N_j(x)$，其中 $u_i$ 是未知的节点温度，$c_j$ 是任意系数。\n\n全局形函数 $N_i(x)$ 是分段线性的。\n对于单元 1（$x \\in [0, a]$，长度 $L_e^{(1)}=a$）：\n$N_0^{(1)}(x) = 1 - \\frac{x}{a}$, $N_1^{(1)}(x) = \\frac{x}{a}$。\n它们的导数为 $\\frac{dN_0^{(1)}}{dx} = -\\frac{1}{a}$, $\\frac{dN_1^{(1)}}{dx} = \\frac{1}{a}$。\n\n对于单元 2（$x \\in [a, L]$，长度 $L_e^{(2)}=L-a$）：\n$N_1^{(2)}(x) = 1 - \\frac{x-a}{L-a} = \\frac{L-x}{L-a}$, $N_2^{(2)}(x) = \\frac{x-a}{L-a}$。\n它们的导数为 $\\frac{dN_1^{(2)}}{dx} = -\\frac{1}{L-a}$, $\\frac{dN_2^{(2)}}{dx} = \\frac{1}{L-a}$。\n\n将这些近似代入弱形式，得到代数系统 $[K]\\{u\\}=\\{F\\}$。\n刚度矩阵的分量为 $K_{ji} = \\int_0^L kA \\frac{dN_j}{dx} \\frac{dN_i}{dx} dx$。\n力向量的分量为 $F_j = Q N_j(x_p)$。\n\n长度为 $L_e$ 的一维线性单元的单元刚度矩阵为 $k^{(e)} = \\frac{kA}{L_e} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$。\n对于单元 1（节点 0, 1），$L_e=a$：$k^{(1)} = \\frac{kA}{a} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$。\n对于单元 2（节点 1, 2），$L_e=L-a$：$k^{(2)} = \\frac{kA}{L-a} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$。\n\n由于 $0  x_p  a$，位于 $x_p$ 处的热源 $Q$ 处于单元 1 内部。\n单元力向量为 $F^{(e)}_j = \\int_{L_e} Q \\delta(x-x_p) N_j^{(e)}(x) dx = Q N_j^{(e)}(x_p)$。\n对于单元 1（节点 0, 1）：$F^{(1)} = \\begin{pmatrix} Q N_0^{(1)}(x_p) \\\\ Q N_1^{(1)}(x_p) \\end{pmatrix} = Q \\begin{pmatrix} 1-x_p/a \\\\ x_p/a \\end{pmatrix}$。\n对于单元 2，没有热源：$F^{(2)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n为节点 $(0, 1, 2)$ 组装全局系统：\n$K_{00} = k^{(1)}_{00} = \\frac{kA}{a}$\n$K_{11} = k^{(1)}_{11} + k^{(2)}_{11} = \\frac{kA}{a} + \\frac{kA}{L-a}$\n$K_{22} = k^{(2)}_{22} = \\frac{kA}{L-a}$\n$K_{01}=K_{10} = k^{(1)}_{01} = -\\frac{kA}{a}$\n$K_{12}=K_{21} = k^{(2)}_{12} = -\\frac{kA}{L-a}$\n$K_{02}=K_{20} = 0$\n全局刚度矩阵为 $K = kA \\begin{pmatrix} \\frac{1}{a}  -\\frac{1}{a}  0 \\\\ -\\frac{1}{a}  \\frac{1}{a} + \\frac{1}{L-a}  -\\frac{1}{L-a} \\\\ 0  -\\frac{1}{L-a}  \\frac{1}{L-a} \\end{pmatrix}$。\n\n全局力向量为 $F = \\begin{pmatrix} F^{(1)}_0 \\\\ F^{(1)}_1 + F^{(2)}_1 \\\\ F^{(2)}_2 \\end{pmatrix} = \\begin{pmatrix} Q(1-x_p/a) \\\\ Q(x_p/a) \\\\ 0 \\end{pmatrix}$。\n\n完整的方程组为：\n$$\nkA \\begin{pmatrix} \\frac{1}{a}  -\\frac{1}{a}  0 \\\\ -\\frac{1}{a}  \\frac{1}{a} + \\frac{1}{L-a}  -\\frac{1}{L-a} \\\\ 0  -\\frac{1}{L-a}  \\frac{1}{L-a} \\end{pmatrix} \\begin{pmatrix} u_0 \\\\ u_1 \\\\ u_2 \\end{pmatrix} = Q \\begin{pmatrix} 1 - \\frac{x_p}{a} \\\\ \\frac{x_p}{a} \\\\ 0 \\end{pmatrix}\n$$\n\n第四，我们施加边界条件并求解 $u_1$。\n本质边界条件为 $u_0 = 0$ 和 $u_2 = 0$。这些节点是受约束的。唯一的未知数是自由节点 $x_1=a$ 处的温度 $u_1$。我们只需要对应于该自由度的方程，即矩阵系统的第二行：\n$$\nkA \\left[ -\\frac{1}{a} u_0 + \\left(\\frac{1}{a} + \\frac{1}{L-a}\\right)u_1 - \\frac{1}{L-a} u_2 \\right] = Q \\frac{x_p}{a}\n$$\n代入 $u_0 = 0$ 和 $u_2 = 0$：\n$$\nkA \\left(\\frac{1}{a} + \\frac{1}{L-a}\\right)u_1 = Q \\frac{x_p}{a}\n$$\n我们简化括号中的项：\n$$\n\\frac{1}{a} + \\frac{1}{L-a} = \\frac{L-a+a}{a(L-a)} = \\frac{L}{a(L-a)}\n$$\n关于 $u_1$ 的方程变为：\n$$\nkA \\frac{L}{a(L-a)} u_1 = Q \\frac{x_p}{a}\n$$\n最后，我们求解 $u_1$：\n$$\nu_1 = \\frac{Q x_p/a}{kA L / (a(L-a))} = \\frac{Q x_p}{a} \\cdot \\frac{a(L-a)}{kA L}\n$$\n$$\nu_1 = \\frac{Q x_p (L-a)}{kA L}\n$$\n这就是节点 $x_1=a$ 处温度的闭合形式解。单位分析 $\\frac{[W][m][m]}{[W/(m \\cdot K)][m^2][m]} = [K]$ 确认了结果是一个温度，与题目要求一致。", "answer": "$$\n\\boxed{\\frac{Q x_p (L-a)}{k A L}}\n$$", "id": "2440379"}, {"introduction": "这项高级实践超越了标准框架，探索了狄利克雷边界条件的弱施加，这是现代计算力学中一种强大的技术。您将研究 Nitsche 方法，这是一种对约束进行强施加的优雅替代方案，为复杂网格和界面问题提供了更大的灵活性。该练习最终将进行一次关键的稳定性分析，以确定稳定参数的最小值，从而将变分公式与数值格式的适定性和准确性直接联系起来。[@problem_id:2711092]", "problem": "一根长度为 $L$、横截面积恒为 $A$、杨氏模量为 $E$ 的棱柱形线性弹性杆，占据区间 $\\Omega = (0,L)$。设 $u(x)$ 表示轴向位移。在准静态、小应变假设下，且无体力时，其控制强形式为\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)=0\\quad\\text{in}\\ \\Omega,\n$$\n左端有齐次 Dirichlet 边界条件 $u(0)=0$，右端有齐次 Neumann 边界条件 $\\sigma(L)n(L)=0$，其中 $\\sigma=E\\varepsilon$，$\\varepsilon=u'$，$n$ 为外法向单位向量（$n(0)=-1$，$n(L)=+1$）。你将采用三种弱施加策略来处理 Dirichlet 边界条件 $u(0)=0$，然后特化为单个线性有限元来导出稳定性阈值。\n\n任务：\n1) 从强形式以及定义 $\\varepsilon=u'$ 和 $\\sigma=E\\varepsilon$ 出发，通过将平衡方程乘以一个容许的检验函数 $v$ 并进行分部积分，推导出标准弱形式。请清楚地说明所产生的边界项，以及当 $u(0)=0$ 不被强施加时如何处理这些边界项。\n\n2) 对于边界 $\\Gamma_D=\\{0\\}$，使用以下每种方法写出弱施加 $u(0)=0$ 的修正弱形式：\n- 罚函数法，使用罚参数 $\\alpha0$，缩放为 $(\\alpha EA/h)\\int_{\\Gamma_D}uv$，其中 $h$ 是与 $\\Gamma_D$ 相关的特征网格尺寸。\n- 对称 Nitsche 法，使用稳定参数 $\\gamma0$，缩放为 $(\\gamma EA/h)\\int_{\\Gamma_D}uv$。\n- Lagrange 乘子法，在 $\\Gamma_D$ 上引入一个辅助未知量 $\\lambda$。\n\n取规定的位移为齐次的，$u_D=0$，这样所有来自边界条件的类载荷贡献项都为零。\n\n3) 考虑对整个杆使用单个双节点线性有限元法（FEM）进行离散化，节点未知数为 $u_1=u(0)$ 和 $u_2=u(L)$，形函数为 $N_1(x)=1-x/L$ 和 $N_2(x)=x/L$。使用第 2 部分的对称 Nitsche 公式，组装来自域积分和 $x=0$ 处边界项的单元刚度贡献。将得到的 $2\\times 2$ 单元刚度矩阵表示为 $E$、$A$、$L$、$h$ 和 $\\gamma$ 的函数。\n\n4) 确定能保证所得 $2\\times 2$ 单元刚度矩阵为正定的 Nitsche 稳定参数 $\\gamma$ 的最小值。将你的最终答案表示为仅含 $h$ 和 $L$ 的单个闭式解析表达式。不需包含单位。无需数值取整。", "solution": "在尝试求解之前，将根据所需标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 控制方程：$-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)=0$，在域 $\\Omega = (0,L)$ 内。\n- 材料和几何属性：线性弹性杆，具有恒定的横截面积 $A$、杨氏模量 $E$ 和长度 $L$。\n- 运动学：$u(x)$ 是轴向位移，$\\varepsilon=u'$ 是应变。\n- 本构律：$\\sigma=E\\varepsilon$。\n- 边界条件（强形式）：$x=0$ 处为齐次 Dirichlet 条件 $u(0)=0$。$x=L$ 处为齐次 Neumann 条件 $\\sigma(L)n(L)=0$。\n- 外法向单位向量：$n(0)=-1$，$n(L)=+1$。\n- $u(0)=u_D=0$ 的弱施加方法：\n  - 罚函数法：修正弱形式包含项 $(\\alpha EA/h)\\int_{\\Gamma_D}uv \\,d\\Gamma$，其中罚参数为 $\\alpha0$，特征长度为 $h$。\n  - 对称 Nitsche 法：修正弱形式使用稳定参数 $\\gamma0$，以及一个缩放为 $(\\gamma EA/h)\\int_{\\Gamma_D}uv$ 的项。\n  - Lagrange 乘子法：在 $\\Gamma_D=\\{0\\}$ 上引入一个辅助未知量 $\\lambda$。\n- 有限元离散化：使用单个双节点线性单元。\n  - 节点位移：$u_1 = u(0)$，$u_2 = u(L)$。\n  - 形函数：$N_1(x) = 1-x/L$ 和 $N_2(x) = x/L$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，植根于线性弹性和计算固体力学（有限元法）的标准理论。强形式和弱形式、分部积分以及边界条件施加技术（罚函数法、Nitsche 法、Lagrange 乘子法）等概念是该领域的基础且已广为接受。该问题是适定的，为一系列逻辑推导提供了所有必要信息。语言客观而精确。该问题不违反任何无效性标准。这是应用力学和数值分析中的一个标准（尽管不简单）的练习。\n\n### 步骤 3：结论与行动\n此问题是**有效的**。将提供完整的解答。\n\n***\n\n解答过程将依次处理四个指定的任务。\n\n### 任务 1：标准弱形式的推导\n平衡方程的强形式为：\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right) = 0, \\quad x \\in \\Omega=(0,L)\n$$\n为推导弱形式，我们将此方程乘以一个任意的、容许的检验函数 $v(x)$，并在域 $\\Omega$ 上积分：\n$$\n-\\int_{0}^{L} v(x) \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right) \\mathrm{d}x = 0\n$$\n应用分部积分 $\\int_a^b f'g \\, dx = [fg]_a^b - \\int_a^b fg' \\, dx$，令 $g=v$ 且 $f' = \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(EA\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)$，得到：\n$$\n\\int_{0}^{L} \\frac{\\mathrm{d}v}{\\mathrm{d}x}\\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right) \\mathrm{d}x - \\left[v(x) \\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)\\right]_{0}^{L} = 0\n$$\n展开边界项，我们得到：\n$$\n\\int_{0}^{L} EA \\frac{\\mathrm{d}u}{\\mathrm{d}x} \\frac{\\mathrm{d}v}{\\mathrm{d}x} \\mathrm{d}x = v(L) \\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)\\bigg|_{x=L} - v(0) \\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)\\bigg|_{x=0}\n$$\n右侧的项是边界项。它们代表边界牵引力所做的功。牵引力定义为 $t = \\sigma n = (E\\varepsilon)n$。\n在右端 $x=L$ 处，外法向为 $n(L)=+1$。牵引力为 $t(L)=\\sigma(L)n(L) = E u'(L)$。项 $A t(L)$ 代表力。问题陈述了一个齐次 Neumann 条件 $\\sigma(L)n(L)=0$，这意味着 $E u'(L)=0$。因此，$x=L$ 处的边界项为零：$v(L) \\left(EA\\,u'(L)\\right) = 0$。\n在左端 $x=0$ 处，外法向为 $n(0)=-1$。牵引力为 $t(0)=\\sigma(0)n(0) = -E u'(0)$。项 $A t(0)$ 是力。$x=0$ 处的边界项是 $-v(0) (EA u'(0))$。\n\n当 Dirichlet 条件 $u(0)=0$ 不强加在 $u$ 和 $v$ 的函数空间上时，$x=0$ 处的这个边界项仍然存在。得到的弱形式为：\n找到 $u(x)$，使其对所有容许的 $v(x)$ 满足：\n$$\n\\int_{0}^{L} EA u' v' \\, \\mathrm{d}x = -v(0) \\left(EA\\,u'(0)\\right)\n$$\n$x=0$ 处的项，即 $-v(0) (EA u'(0))$，是必须由弱施加方法处理的边界项，因为它在 Dirichlet 边界上包含了未知的通量（反作用力）$EA u'(0)$。\n\n### 任务 2：修正弱形式\n目标是弱施加条件 $u(0)=u_D=0$。\n\n**罚函数法：** 该方法向弱形式添加一个罚项，以惩罚对 Dirichlet 条件的偏离。未知的通量项被舍弃。指定的罚项是 $\\frac{\\alpha EA}{h} \\int_{\\Gamma_D} uv \\,d\\Gamma$。对于 $\\Gamma_D=\\{0\\}$，该积分变为一个由罚参数 $\\alpha0$ 缩放的点求值。修正的弱形式为：\n找到 $u(x)$，使其对所有 $v(x)$ 满足：\n$$\n\\int_{0}^{L} EA u' v' \\, \\mathrm{d}x + \\frac{\\alpha EA}{h} u(0) v(0) = 0\n$$\n\n**对称 Nitsche 法：** 此方法将原弱形式中的边界项替换为三个新项：一个一致性项、一个对称性项和一个稳定项。此方法旨在对称地强制施加 Dirichlet 条件 $u=u_D$。对于本问题，$\\Omega=(0,L)$，$\\Gamma_D=\\{0\\}$，$n(0)=-1$，且 $u_D=0$。积分 $\\int_{\\Gamma_D}$ 简化为在 $x=0$ 处的点求值。\n一致性项：$-v(0) E A u'(0)$。\n对称性项：$-u(0) E A v'(0)$。\n稳定项：$+\\frac{\\gamma EA}{h} u(0)v(0)$。\n由于 $u_D=0$，等式右边的载荷项为零。\n将这些项与原弱形式的域积分项结合，得到修正的弱形式：\n找到 $u(x)$，使其对所有 $v(x)$ 满足：\n$$\n\\int_{0}^{L} EA u' v' \\, \\mathrm{d}x - v(0) E A u'(0) - u(0) E A v'(0) + \\frac{\\gamma EA}{h} u(0)v(0) = 0\n$$\n\n**Lagrange 乘子法：** 此方法引入一个 Lagrange 乘子 $\\lambda$ 来施加约束 $u(0)=u_D=0$。$\\lambda$ 充当反作用力。我们构成一个混合系统。修正的弱公式是一个包含两个方程的系统：\n找到 $(u, \\lambda) \\in H^1(\\Omega) \\times \\mathbb{R}$，使其对所有检验函数 $(v, \\mu) \\in H^1(\\Omega) \\times \\mathbb{R}$ 满足：\n$$\n\\begin{cases}\n\\int_{0}^{L} EA u' v' \\, \\mathrm{d}x + \\lambda v(0) = 0 \\\\\n\\mu u(0) = 0\n\\end{cases}\n$$\n\n### 任务 3：使用对称 Nitsche 法的有限元离散化\n我们使用给定的线性形函数对场 $u(x)$ 和 $v(x)$ 进行离散化：\n$u(x) = N_1(x)u_1 + N_2(x)u_2$ 和 $v(x) = N_1(x)v_1 + N_2(x)v_2$。\n其导数为常数：$u'(x) = N_1'u_1 + N_2'u_2 = -\\frac{1}{L}u_1 + \\frac{1}{L}u_2 = \\frac{u_2-u_1}{L}$。类似地，$v'(x) = \\frac{v_2-v_1}{L}$。\n在边界 $x=0$ 处的值为 $u(0)=u_1$ 和 $v(0)=v_1$。\n我们从对称 Nitsche 弱形式 $B_N(u,v)=0$（表示为 $\\mathbf{v}^T \\mathbf{K} \\mathbf{u} = 0$）中组装单元刚度矩阵 $\\mathbf{K}$。我们计算每一项。\n\n1.  **域项**：\n    $$\n    \\int_0^L EA u' v' \\, \\mathrm{d}x = \\int_0^L EA \\left(\\frac{u_2-u_1}{L}\\right) \\left(\\frac{v_2-v_1}{L}\\right) \\mathrm{d}x = \\frac{EA}{L^2}(u_2-u_1)(v_2-v_1) \\int_0^L \\mathrm{d}x = \\frac{EA}{L}(u_2-u_1)(v_2-v_1)\n    $$\n    这对应于标准杆单元刚度矩阵：$\\mathbf{K}_{domain} = \\frac{EA}{L} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$。\n\n2.  **$x=0$ 处的 Nitsche 边界项**：\n    使用弱形式：$\\int_{0}^{L} EAu'v' - v(0)EAu'(0) - u(0)EAv'(0) + \\frac{\\gamma EA}{h}u(0)v(0)=0$。\n    一致性项贡献：$-v(0)EAu'(0) = -v_1 EA \\frac{u_2-u_1}{L} = \\frac{EA}{L}(v_1u_1 - v_1u_2)$。矩阵：$\\mathbf{K}_{N1} = \\frac{EA}{L}\\begin{pmatrix} 1  -1 \\\\ 0  0 \\end{pmatrix}$。\n    对称性项贡献：$-u(0)EAv'(0) = -u_1 EA \\frac{v_2-v_1}{L} = \\frac{EA}{L}(u_1v_1 - u_1v_2)$。矩阵：$\\mathbf{K}_{N2} = \\frac{EA}{L}\\begin{pmatrix} 1  0 \\\\ -1  0 \\end{pmatrix}$。\n    稳定项贡献：$+\\frac{\\gamma EA}{h} u(0)v(0) = \\frac{\\gamma EA}{h} u_1v_1$。矩阵：$\\mathbf{K}_{N3} = \\frac{\\gamma EA}{h}\\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$。\n\n3.  **总单元刚度矩阵**：\n    总刚度矩阵 $\\mathbf{K}$ 是 $\\mathbf{K}_{domain} + \\mathbf{K}_{N1} + \\mathbf{K}_{N2} + \\mathbf{K}_{N3}$ 的和。\n    $$\n    \\mathbf{K} = \\frac{EA}{L}\\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} + \\frac{EA}{L}\\begin{pmatrix} 1  -1 \\\\ 0  0 \\end{pmatrix} + \\frac{EA}{L}\\begin{pmatrix} 1  0 \\\\ -1  0 \\end{pmatrix} + \\frac{\\gamma EA}{h}\\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}\n    $$\n    求和各分量：\n    $K_{11} = \\frac{EA}{L} + \\frac{EA}{L} + \\frac{EA}{L} + \\frac{\\gamma EA}{h} = \\frac{3EA}{L} + \\frac{\\gamma EA}{h}$\n    $K_{12} = -\\frac{EA}{L} - \\frac{EA}{L} + 0 + 0 = -\\frac{2EA}{L}$\n    $K_{21} = -\\frac{EA}{L} + 0 - \\frac{EA}{L} + 0 = -\\frac{2EA}{L}$\n    $K_{22} = \\frac{EA}{L} + 0 + 0 + 0 = \\frac{EA}{L}$\n    得到的 $2\\times 2$ 单元刚度矩阵为：\n    $$\n    \\mathbf{K} = \\begin{pmatrix} \\frac{3EA}{L} + \\frac{\\gamma EA}{h}  -\\frac{2EA}{L} \\\\ -\\frac{2EA}{L}  \\frac{EA}{L} \\end{pmatrix}\n    $$\n\n### 任务 4：$\\gamma$ 的稳定性阈值\n为使矩阵 $\\mathbf{K}$ 为正定，其所有主子式必须严格为正。对于一个对称的 $2 \\times 2$ 矩阵，这要求 $K_{11}  0$ 且 $\\det(\\mathbf{K})  0$。\n\n1.  **第一个条件 ($K_{11}  0$)**：\n    $K_{11} = \\frac{3EA}{L} + \\frac{\\gamma EA}{h}  0$\n    鉴于 $E, A, L, h$ 是正的物理量，且问题说明 $\\gamma  0$，此条件总是满足的。\n\n2.  **第二个条件 ($\\det(\\mathbf{K})  0$)**：\n    $\\det(\\mathbf{K}) = K_{11}K_{22} - K_{12}K_{21}  0$\n    $$\n    \\left(\\frac{3EA}{L} + \\frac{\\gamma EA}{h}\\right)\\left(\\frac{EA}{L}\\right) - \\left(-\\frac{2EA}{L}\\right)^2  0\n    $$\n    我们可以提出因子 $(EA)^2$，它是正的：\n    $$\n    \\left(\\frac{3}{L} + \\frac{\\gamma}{h}\\right)\\frac{1}{L} - \\frac{4}{L^2}  0\n    $$\n    $$\n    \\frac{3}{L^2} + \\frac{\\gamma}{hL} - \\frac{4}{L^2}  0\n    $$\n    $$\n    \\frac{\\gamma}{hL} - \\frac{1}{L^2}  0\n    $$\n    $$\n    \\frac{\\gamma}{hL}  \\frac{1}{L^2}\n    $$\n    乘以 $hL^2$（为正）得到：\n    $$\n    \\gamma L  h \\implies \\gamma  \\frac{h}{L}\n    $$\n    对于任何大于 $\\frac{h}{L}$ 的 $\\gamma$ 值，该矩阵都是严格正定的。保证这一点的最小值是该集合的下确界。将稳定（正定）区域与不稳定（非正定）区域分开的阈值即为此下界。\n\n因此，$\\gamma$ 的最小值为 $\\frac{h}{L}$。", "answer": "$$\n\\boxed{\\frac{h}{L}}\n$$", "id": "2711092"}]}