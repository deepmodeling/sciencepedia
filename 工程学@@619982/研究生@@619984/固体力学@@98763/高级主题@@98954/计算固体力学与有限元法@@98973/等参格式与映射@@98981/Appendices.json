{"hands_on_practices": [{"introduction": "在有限元分析中，等参映射通常将父单元的坐标 $(\\xi, \\eta)$ 变换到物理空间中的坐标 $(x, y)$。然而，在许多高级应用中（例如，在接触算法中确定一个点是否穿透了某个单元，或在后处理中进行插值），我们需要执行逆操作：给定一个物理点 $\\boldsymbol{x}^{\\ast}$，找到其对应的父坐标。本练习将指导您使用牛顿法来解决这个基础但至关重要的逆映射问题 [@problem_id:2651723]，从而加深您对映射方程及其雅可比矩阵的理解。", "problem": "在固体力学的二维四边形有限元等参格式中，物理坐标 $\\boldsymbol{x} = (x,y)$ 是通过使用节点坐标 $\\{\\boldsymbol{x}_{a}\\}_{a=1}^{4}$ 进行形函数插值，从母体（自然）坐标 $(\\xi,\\eta)$ 获得的。考虑在母体正方形 $[-1,1]\\times[-1,1]$ 上的标准双线性插值，其形函数 $N_{a}(\\xi,\\eta)$ 与节点 $a=1,2,3,4$ 相关联。逆映射问题是：给定一个目标物理点 $\\boldsymbol{x}^{\\ast} = (x^{\\ast},y^{\\ast})$ 和节点坐标 $\\boldsymbol{x}_{a} = (x_{a},y_{a})$，求出 $(\\xi,\\eta)$ 使得 $\\boldsymbol{x}(\\xi,\\eta)=\\boldsymbol{x}^{\\ast}$。\n\n从等参插值的基本定义和求解非线性系统的 Newton 法出发，完成以下任务：\n\n1) 将逆映射问题表述为一个求根问题 $\\boldsymbol{r}(\\xi,\\eta)=\\boldsymbol{0}$，其中 $\\boldsymbol{r}(\\xi,\\eta)$ 是物理空间中的残差。推导 $(\\xi,\\eta)$ 的 Newton 迭代法，并明确指出映射 $\\boldsymbol{x}(\\xi,\\eta)$ 关于 $(\\xi,\\eta)$ 的 Jacobian 矩阵 $\\boldsymbol{J}(\\xi,\\eta)$。\n\n2) 针对一个具有以下节点坐标的单个双线性四边形单元\n$\\boldsymbol{x}_{1}=(0,0)$、$\\boldsymbol{x}_{2}=(2,0)$、$\\boldsymbol{x}_{3}=(2.5,1.5)$、$\\boldsymbol{x}_{4}=(-0.5,1.0)$，\n和目标点 $\\boldsymbol{x}^{\\ast}=(1.0,0.7)$。使用双线性形函数\n$N_{1}(\\xi,\\eta)=\\frac{(1-\\xi)(1-\\eta)}{4}$、$N_{2}(\\xi,\\eta)=\\frac{(1+\\xi)(1-\\eta)}{4}$、$N_{3}(\\xi,\\eta)=\\frac{(1+\\xi)(1+\\eta)}{4}$、$N_{4}(\\xi,\\eta)=\\frac{(1-\\xi)(1+\\eta)}{4}$，\n从初始猜测 $(\\xi_{0},\\eta_{0})=(0,0)$ 出发，计算第一次 Newton 更新。不要四舍五入；提供精确值。\n\n将您的最终答案——第一次 Newton 迭代结果 $(\\xi_{1},\\eta_{1})$——以行矩阵的形式表示。由于 $(\\xi,\\eta)$ 是无量纲的，因此不需要单位。", "solution": "问题陈述已经过验证。它具有科学依据、是适定的、客观的，并包含了得到唯一且有意义解所需的所有必要信息和定义。这是计算固体力学中的一个标准练习。因此，我们可以继续进行推导和计算。\n\n该问题要求表述并应用 Newton-Raphson 法，以求解一个双线性等参单元中与给定物理点 $\\boldsymbol{x}^{\\ast} = (x^{\\ast}, y^{\\ast})$ 对应的自然坐标 $(\\xi, \\eta)$。\n\n首先，我们来解决一般公式的表述问题。从母体正方形域 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ 到物理域的等参映射由下式给出：\n$$ \\boldsymbol{x}(\\xi, \\eta) = \\sum_{a=1}^{4} N_{a}(\\xi, \\eta) \\boldsymbol{x}_{a} $$\n其中 $\\boldsymbol{x} = (x, y)^T$ 是物理坐标，$\\boldsymbol{x}_{a} = (x_{a}, y_{a})^T$ 是四边形单元四个节点的坐标，而 $N_{a}(\\xi, \\eta)$ 是双线性形函数。\n\n逆映射问题是在给定目标点 $\\boldsymbol{x}^{\\ast}$ 的情况下，找到满足 $\\boldsymbol{x}(\\xi, \\eta) = \\boldsymbol{x}^{\\ast}$ 的 $(\\xi, \\eta)$。这可以表述为求解残差向量函数 $\\boldsymbol{r}(\\xi, \\eta)$ 的根的问题：\n$$ \\boldsymbol{r}(\\xi, \\eta) = \\boldsymbol{x}(\\xi, \\eta) - \\boldsymbol{x}^{\\ast} = \\boldsymbol{0} $$\n这是一个关于两个变量 $(\\xi, \\eta)$ 的两个非线性方程组：\n$$ r_x(\\xi, \\eta) = \\sum_{a=1}^{4} N_{a}(\\xi, \\eta) x_{a} - x^{\\ast} = 0 $$\n$$ r_y(\\xi, \\eta) = \\sum_{a=1}^{4} N_{a}(\\xi, \\eta) y_{a} - y^{\\ast} = 0 $$\n\n用于求解 $\\boldsymbol{r}(\\boldsymbol{z}) = \\boldsymbol{0}$（其中 $\\boldsymbol{z} = (\\xi, \\eta)^T$）的 Newton-Raphson 法是一个迭代过程。给定一个迭代值 $\\boldsymbol{z}_{k}$，下一个迭代值 $\\boldsymbol{z}_{k+1}$ 可通过求解以下线性系统得到：\n$$ \\boldsymbol{J}_{\\boldsymbol{r}}(\\boldsymbol{z}_{k}) (\\boldsymbol{z}_{k+1} - \\boldsymbol{z}_{k}) = -\\boldsymbol{r}(\\boldsymbol{z}_{k}) $$\n其中 $\\boldsymbol{J}_{\\boldsymbol{r}}(\\boldsymbol{z}_{k})$ 是残差向量 $\\boldsymbol{r}$ 在 $\\boldsymbol{z}_{k}$ 处求值的 Jacobian 矩阵。更新向量为 $\\boldsymbol{\\delta}_{k} = \\boldsymbol{z}_{k+1} - \\boldsymbol{z}_{k}$。\n\n由于 $\\boldsymbol{x}^{\\ast}$ 是一个常数向量，残差的 Jacobian 矩阵 $\\boldsymbol{J}_{\\boldsymbol{r}}$ 与映射的 Jacobian 矩阵 $\\boldsymbol{J}$ 相同：\n$$ \\boldsymbol{J}(\\xi, \\eta) = \\frac{\\partial \\boldsymbol{r}}{\\partial \\boldsymbol{z}} = \\frac{\\partial \\boldsymbol{x}}{\\partial \\boldsymbol{z}} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} $$\nJacobian 矩阵的分量通过对映射方程求导得到：\n$$ \\frac{\\partial x}{\\partial \\xi} = \\sum_{a=1}^{4} \\frac{\\partial N_{a}}{\\partial \\xi} x_{a} \\quad , \\quad \\frac{\\partial x}{\\partial \\eta} = \\sum_{a=1}^{4} \\frac{\\partial N_{a}}{\\partial \\eta} x_{a} $$\n$$ \\frac{\\partial y}{\\partial \\xi} = \\sum_{a=1}^{4} \\frac{\\partial N_{a}}{\\partial \\xi} y_{a} \\quad , \\quad \\frac{\\partial y}{\\partial \\eta} = \\sum_{a=1}^{4} \\frac{\\partial N_{a}}{\\partial \\eta} y_{a} $$\n因此，自然坐标的 Newton 迭代法为：\n$$ \\begin{pmatrix} \\xi_{k+1} \\\\ \\eta_{k+1} \\end{pmatrix} = \\begin{pmatrix} \\xi_{k} \\\\ \\eta_{k} \\end{pmatrix} - \\boldsymbol{J}^{-1}(\\xi_{k}, \\eta_{k}) \\boldsymbol{r}(\\xi_{k}, \\eta_{k}) $$\n\n接下来，我们将此公式应用于具体问题。\n节点坐标为 $\\boldsymbol{x}_{1}=(0,0)$、$\\boldsymbol{x}_{2}=(2,0)$、$\\boldsymbol{x}_{3}=(2.5,1.5) = (\\frac{5}{2}, \\frac{3}{2})$ 和 $\\boldsymbol{x}_{4}=(-0.5,1.0) = (-\\frac{1}{2}, 1)$。\n目标点为 $\\boldsymbol{x}^{\\ast}=(1.0,0.7) = (1, \\frac{7}{10})$。\n初始猜测为 $(\\xi_{0},\\eta_{0})=(0,0)$。\n\n双线性形函数及其导数为：\n$N_{1}=\\frac{1}{4}(1-\\xi)(1-\\eta) \\implies \\frac{\\partial N_{1}}{\\partial\\xi}=-\\frac{1}{4}(1-\\eta), \\frac{\\partial N_{1}}{\\partial\\eta}=-\\frac{1}{4}(1-\\xi)$\n$N_{2}=\\frac{1}{4}(1+\\xi)(1-\\eta) \\implies \\frac{\\partial N_{2}}{\\partial\\xi}=\\frac{1}{4}(1-\\eta), \\frac{\\partial N_{2}}{\\partial\\eta}=-\\frac{1}{4}(1+\\xi)$\n$N_{3}=\\frac{1}{4}(1+\\xi)(1+\\eta) \\implies \\frac{\\partial N_{3}}{\\partial\\xi}=\\frac{1}{4}(1+\\eta), \\frac{\\partial N_{3}}{\\partial\\eta}=\\frac{1}{4}(1+\\xi)$\n$N_{4}=\\frac{1}{4}(1-\\xi)(1+\\eta) \\implies \\frac{\\partial N_{4}}{\\partial\\xi}=-\\frac{1}{4}(1+\\eta), \\frac{\\partial N_{4}}{\\partial\\eta}=\\frac{1}{4}(1-\\xi)$\n\n我们执行第一次迭代，即 $k=0$。\n步骤 1：在 $(\\xi_0, \\eta_0)=(0,0)$ 处计算各量的值。\n在 $(\\xi, \\eta)=(0,0)$ 处，形函数为 $N_{1}=N_{2}=N_{3}=N_{4}=\\frac{1}{4}$。\n初始猜测处的物理坐标为：\n$x_{0} = \\sum N_{a}(0,0) x_{a} = \\frac{1}{4} (0 + 2 + \\frac{5}{2} - \\frac{1}{2}) = \\frac{1}{4} (2 + 2) = 1$\n$y_{0} = \\sum N_{a}(0,0) y_{a} = \\frac{1}{4} (0 + 0 + \\frac{3}{2} + 1) = \\frac{1}{4}(\\frac{5}{2}) = \\frac{5}{8}$\n所以，$\\boldsymbol{x}(0,0) = (1, \\frac{5}{8})$。\n\n步骤 2：计算残差向量 $\\boldsymbol{r}(\\xi_0, \\eta_0)$。\n$\\boldsymbol{r}(0,0) = \\boldsymbol{x}(0,0) - \\boldsymbol{x}^{\\ast} = (1 - 1, \\frac{5}{8} - \\frac{7}{10}) = (0, \\frac{25-28}{40}) = (0, -\\frac{3}{40})$。\n\n步骤 3：计算 Jacobian 矩阵 $\\boldsymbol{J}(\\xi_0, \\eta_0)$。\n在 $(\\xi, \\eta) = (0,0)$ 处的形函数导数为：\n$\\frac{\\partial N_{1}}{\\partial\\xi}=-\\frac{1}{4}, \\frac{\\partial N_{2}}{\\partial\\xi}=\\frac{1}{4}, \\frac{\\partial N_{3}}{\\partial\\xi}=\\frac{1}{4}, \\frac{\\partial N_{4}}{\\partial\\xi}=-\\frac{1}{4}$\n$\\frac{\\partial N_{1}}{\\partial\\eta}=-\\frac{1}{4}, \\frac{\\partial N_{2}}{\\partial\\eta}=-\\frac{1}{4}, \\frac{\\partial N_{3}}{\\partial\\eta}=\\frac{1}{4}, \\frac{\\partial N_{4}}{\\partial\\eta}=\\frac{1}{4}$\nJacobian 矩阵的分量为：\n$J_{11} = \\frac{\\partial x}{\\partial\\xi}|_{(0,0)} = \\sum \\frac{\\partial N_{a}}{\\partial\\xi} x_{a} = (-\\frac{1}{4})(0) + (\\frac{1}{4})(2) + (\\frac{1}{4})(\\frac{5}{2}) + (-\\frac{1}{4})(-\\frac{1}{2}) = \\frac{1}{4}(2 + \\frac{5}{2} + \\frac{1}{2}) = \\frac{1}{4}(2+3) = \\frac{5}{4}$。\n$J_{12} = \\frac{\\partial x}{\\partial\\eta}|_{(0,0)} = \\sum \\frac{\\partial N_{a}}{\\partial\\eta} x_{a} = (-\\frac{1}{4})(0) + (-\\frac{1}{4})(2) + (\\frac{1}{4})(\\frac{5}{2}) + (\\frac{1}{4})(-\\frac{1}{2}) = \\frac{1}{4}(-2 + \\frac{5}{2} - \\frac{1}{2}) = \\frac{1}{4}(-2+2) = 0$。\n$J_{21} = \\frac{\\partial y}{\\partial\\xi}|_{(0,0)} = \\sum \\frac{\\partial N_{a}}{\\partial\\xi} y_{a} = (-\\frac{1}{4})(0) + (\\frac{1}{4})(0) + (\\frac{1}{4})(\\frac{3}{2}) + (-\\frac{1}{4})(1) = \\frac{1}{4}(\\frac{3}{2}-1) = \\frac{1}{4}(\\frac{1}{2}) = \\frac{1}{8}$。\n$J_{22} = \\frac{\\partial y}{\\partial\\eta}|_{(0,0)} = \\sum \\frac{\\partial N_{a}}{\\partial\\eta} y_{a} = (-\\frac{1}{4})(0) + (-\\frac{1}{4})(0) + (\\frac{1}{4})(\\frac{3}{2}) + (\\frac{1}{4})(1) = \\frac{1}{4}(\\frac{3}{2}+1) = \\frac{1}{4}(\\frac{5}{2}) = \\frac{5}{8}$。\n因此，在初始猜测处的 Jacobian 矩阵为：\n$$ \\boldsymbol{J}(0,0) = \\begin{pmatrix} \\frac{5}{4} & 0 \\\\ \\frac{1}{8} & \\frac{5}{8} \\end{pmatrix} $$\n\n步骤 4：求解更新向量 $\\boldsymbol{\\delta}_{0} = (\\delta_{\\xi}, \\delta_{\\eta})^T$。\n线性系统为 $\\boldsymbol{J}(0,0)\\boldsymbol{\\delta}_{0} = -\\boldsymbol{r}(0,0)$：\n$$ \\begin{pmatrix} \\frac{5}{4} & 0 \\\\ \\frac{1}{8} & \\frac{5}{8} \\end{pmatrix} \\begin{pmatrix} \\delta_{\\xi} \\\\ \\delta_{\\eta} \\end{pmatrix} = -\\begin{pmatrix} 0 \\\\ -\\frac{3}{40} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{3}{40} \\end{pmatrix} $$\n根据第一个方程：$\\frac{5}{4}\\delta_{\\xi} = 0 \\implies \\delta_{\\xi}=0$。\n根据第二个方程：$\\frac{1}{8}\\delta_{\\xi} + \\frac{5}{8}\\delta_{\\eta} = \\frac{3}{40}$。\n代入 $\\delta_{\\xi}=0$：$\\frac{5}{8}\\delta_{\\eta} = \\frac{3}{40}$。\n$\\delta_{\\eta} = \\frac{3}{40} \\cdot \\frac{8}{5} = \\frac{24}{200} = \\frac{3}{25}$。\n更新向量为 $\\boldsymbol{\\delta}_{0} = (0, \\frac{3}{25})^T$。\n\n步骤 5：计算下一个迭代值 $(\\xi_1, \\eta_1)$。\n$(\\xi_{1}, \\eta_{1}) = (\\xi_{0}, \\eta_{0}) + (\\delta_{\\xi}, \\delta_{\\eta}) = (0,0) + (0, \\frac{3}{25}) = (0, \\frac{3}{25})$。\n这就完成了第一次 Newton 更新。", "answer": "$$ \\boxed{ \\begin{pmatrix} 0 & \\frac{3}{25} \\end{pmatrix} } $$", "id": "2651723"}, {"introduction": "等参映射的雅可比行列式 $J$ 衡量了从父单元到物理单元的局部面积变化，并且其符号的恒定性是保证单元有效的基本要求。然而，如何可靠地检查一个单元在整个域内是否都有效呢？本练习通过构建一个精心设计的反例 [@problem_id:2651722] 来揭示一个重要的警示：即使在标准数值积分点（高斯点）上雅可比行列式为正，单元内部也可能发生“翻转”或“退化”。这个实践将使您对单元质量检查的可靠性有更深刻的认识。", "problem": "给定一个二维的四节点双线性等参四边形单元。节点的母（参考）坐标为 $(-1,-1)$、$(+1,-1)$、$(+1,+1)$ 和 $(-1,+1)$，并使用标准的双线性等参形函数将母坐标 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 映射到物理坐标 $(x,y)$。等参映射定义为 $x(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)X_i$ 和 $y(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)Y_i$，其中 $(X_i,Y_i)$ 是节点的物理坐标。此映射的雅可比行列式 $J(\\xi,\\eta)$ 定义为 $J=\\det\\left(\\partial(x,y)/\\partial(\\xi,\\eta)\\right)$，它控制着母单元和物理单元之间的局部面积缩放比例。\n\n考虑以下物理节点坐标（节点顺序同上）：\n- $Y_1=-1$, $Y_2=-1$, $Y_3=+1$, $Y_4=+1$,\n- $X_1=\\tfrac{1}{2}$, $X_2=-\\tfrac{1}{2}$, $X_3=\\tfrac{5}{2}$, $X_4=-\\tfrac{5}{2}$.\n\n从等参映射和雅可比行列式的定义出发，完成以下任务：\n1. 推导 $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$ 的显式表达式。\n2. 推导雅可比行列式 $J(\\xi,\\eta)$。\n3. 在四个两点高斯求积 (GQ) 点 $(\\xi,\\eta)=(\\pm 1/\\sqrt{3},\\pm 1/\\sqrt{3})$ 处计算 $J(\\xi,\\eta)$ 的值，并验证其在这些点上的符号。\n4. 在内点 $(\\xi,\\eta)=(0,-\\tfrac{4}{5})$ 处计算 $J(\\xi,\\eta)$ 的值，证明映射在该点发生局部反转，并报告此值。\n\n简要解释您的发现对于仅在 GQ 点检验 $J>0$ 的单元质量检查的可靠性有何影响。为评分需要，最终答案仅需提供 $J$ 在 $(\\xi,\\eta)=(0,-\\tfrac{4}{5})$ 处的计算值。无需四舍五入，$J$ 没有物理单位。", "solution": "该问题陈述已经过验证，被认为是科学合理的、适定的、客观的且内部一致的。它代表了有限元方法中一个标准的、尽管是精心设计的练习，旨在检验对等参映射和单元质量度量的理解。该问题有效，将提供解答。\n\n四节点双线性等参单元利用形函数 $N_i(\\xi, \\eta)$ 将母域 $(\\xi, \\eta) \\in [-1,1] \\times [-1,1]$ 映射到物理域 $(x,y)$。按标准顺序，节点 1, 2, 3, 4 的形函数为：\n$$N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$$\n$$N_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$$\n$$N_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$$\n$$N_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$$\n\n给定的物理节点坐标 $(X_i, Y_i)$ 为：\n节点 1: $(X_1, Y_1) = (\\frac{1}{2}, -1)$\n节点 2: $(X_2, Y_2) = (-\\frac{1}{2}, -1)$\n节点 3: $(X_3, Y_3) = (\\frac{5}{2}, 1)$\n节点 4: $(X_4, Y_4) = (-\\frac{5}{2}, 1)$\n\n**1. 推导 $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$**\n\n等参映射定义为 $x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) X_i$ 和 $y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) Y_i$。\n\n首先，我们推导 $y$ 坐标的表达式：\n$$y(\\xi,\\eta) = N_1(-1) + N_2(-1) + N_3(1) + N_4(1)$$\n$$y(\\xi,\\eta) = \\frac{1}{4} [ -1(1-\\xi)(1-\\eta) - 1(1+\\xi)(1-\\eta) + 1(1+\\xi)(1+\\eta) + 1(1-\\xi)(1+\\eta) ]$$\n$$y(\\xi,\\eta) = \\frac{1}{4} [ -(1-\\eta)( (1-\\xi) + (1+\\xi) ) + (1+\\eta)( (1+\\xi) + (1-\\xi) ) ]$$\n$$y(\\xi,\\eta) = \\frac{1}{4} [ -2(1-\\eta) + 2(1+\\eta) ] = \\frac{1}{2} [ -1+\\eta + 1+\\eta ] = \\frac{1}{2}(2\\eta) = \\eta$$\n所以，$y$ 坐标的映射就是简单的 $y(\\xi,\\eta) = \\eta$。\n\n接下来，我们推导 $x$ 坐标的表达式：\n$$x(\\xi,\\eta) = N_1 X_1 + N_2 X_2 + N_3 X_3 + N_4 X_4$$\n$$x(\\xi,\\eta) = \\frac{1}{4} [ (\\frac{1}{2})(1-\\xi)(1-\\eta) + (-\\frac{1}{2})(1+\\xi)(1-\\eta) + (\\frac{5}{2})(1+\\xi)(1+\\eta) + (-\\frac{5}{2})(1-\\xi)(1+\\eta) ]$$\n提出因子 $\\frac{1}{8}$：\n$$x(\\xi,\\eta) = \\frac{1}{8} [ (1-\\xi)(1-\\eta) - (1+\\xi)(1-\\eta) + 5(1+\\xi)(1+\\eta) - 5(1-\\xi)(1+\\eta) ]$$\n$$x(\\xi,\\eta) = \\frac{1}{8} [ (1-\\eta)((1-\\xi)-(1+\\xi)) + 5(1+\\eta)((1+\\xi)-(1-\\xi)) ]$$\n$$x(\\xi,\\eta) = \\frac{1}{8} [ (1-\\eta)(-2\\xi) + 5(1+\\eta)(2\\xi) ]$$\n$$x(\\xi,\\eta) = \\frac{2\\xi}{8} [ -(1-\\eta) + 5(1+\\eta) ] = \\frac{\\xi}{4} [ -1+\\eta+5+5\\eta ] = \\frac{\\xi}{4}(4+6\\eta)$$\n$$x(\\xi,\\eta) = \\xi(1+\\frac{3}{2}\\eta)$$\n\n映射的显式表达式为 $x(\\xi,\\eta) = \\xi(1+\\frac{3}{2}\\eta)$ 和 $y(\\xi,\\eta)=\\eta$。\n\n**2. 推导雅可比行列式 $J(\\xi,\\eta)$**\n\n映射的雅可比矩阵为 $\\mathbf{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}$。\n偏导数是：\n$$\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( \\xi + \\frac{3}{2}\\xi\\eta \\right) = 1 + \\frac{3}{2}\\eta$$\n$$\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( \\xi + \\frac{3}{2}\\xi\\eta \\right) = \\frac{3}{2}\\xi$$\n$$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} (\\eta) = 0$$\n$$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} (\\eta) = 1$$\n\n雅可比矩阵为：\n$$\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} 1 + \\frac{3}{2}\\eta & \\frac{3}{2}\\xi \\\\ 0 & 1 \\end{pmatrix}$$\n雅可比行列式 $J(\\xi,\\eta) = \\det(\\mathbf{J})$ 为：\n$$J(\\xi,\\eta) = (1 + \\frac{3}{2}\\eta)(1) - (\\frac{3}{2}\\xi)(0) = 1 + \\frac{3}{2}\\eta$$\n\n**3. 在高斯求积点处计算 $J$**\n\n四个两点高斯求积 (GQ) 点的位置是 $(\\xi,\\eta) = (\\pm \\frac{1}{\\sqrt{3}}, \\pm \\frac{1}{\\sqrt{3}})$。由于 $J$ 仅依赖于 $\\eta$，我们只需对 $\\eta = \\pm \\frac{1}{\\sqrt{3}}$ 进行求值。\n\n对于 $\\eta = +\\frac{1}{\\sqrt{3}}$：\n$$J = 1 + \\frac{3}{2}\\left(\\frac{1}{\\sqrt{3}}\\right) = 1 + \\frac{\\sqrt{3}}{2}$$\n因为 $\\sqrt{3} \\approx 1.732$，所以 $J \\approx 1 + 0.866 = 1.866 > 0$。\n\n对于 $\\eta = -\\frac{1}{\\sqrt{3}}$：\n$$J = 1 + \\frac{3}{2}\\left(-\\frac{1}{\\sqrt{3}}\\right) = 1 - \\frac{\\sqrt{3}}{2}$$\n因为 $\\frac{\\sqrt{3}}{2} \\approx 0.866 < 1$，所以 $J \\approx 1 - 0.866 = 0.134 > 0$。\n\n在所有四个 GQ 点，雅可比行列式均为正。该单元会通过基于在这些点上求值的标准质量检查。\n\n**4. 在 $(\\xi,\\eta)=(0,-\\frac{4}{5})$ 处计算 $J$**\n\n我们现在在指定的内点 $(\\xi,\\eta)=(0, -\\frac{4}{5})$ 处计算雅可比行列式。\n$$J\\left(0, -\\frac{4}{5}\\right) = 1 + \\frac{3}{2}\\eta = 1 + \\frac{3}{2}\\left(-\\frac{4}{5}\\right) = 1 - \\frac{12}{10} = 1 - \\frac{6}{5} = \\frac{5}{5} - \\frac{6}{5} = -\\frac{1}{5}$$\n雅可比行列式在该点为负值，$J = -\\frac{1}{5}$。这表明等参映射在单元内部的一个区域发生了局部反转（即，它自身发生了折叠）。\n\n**对单元质量检查的影响**\n\n主要影响是，仅仅依赖在标准高斯求积点检查 $J > 0$ 是一种不充分且不可靠的方法，无法确保在整个母域上单元几何的有效性和非退化性。单元矩阵的数值积分方案通常通过对 GQ 点处的加权函数值求和来实现。如果在这些点上 $J > 0$，数值积分程序将无误执行，有限元代码很可能会接受该单元。然而，如此处所示，存在 $J \\le 0$ 的区域，意味着违反了从母单元到物理单元一一映射的基本要求。这在物理上意味着单元几何形状是“纠缠”或“反转”的。使用此类单元进行的分析将产生物理上无意义的结果，尽管在组装阶段没有出现计算错误。\n\n此问题说明，对于扭曲的单元，尤其对于非凸或“领结”形状的单元，需要更鲁棒的质量检查。对于双线性四边形，雅可比行列式 $J(\\xi, \\eta)$ 是 $\\xi$ 和 $\\eta$ 的线性函数。因此，其极值必然出现在母域的角点 $(\\xi, \\eta) \\in \\{(-1,-1), (1,-1), (1,1), (-1,1)\\}$ 处。对于这类单元，一个充分的检查是验证雅可比行列式在所有四个角点均为正值。在本例中，$J = 1 + \\frac{3}{2}\\eta$，最小值出现在 $\\eta=-1$ 处，此时 $J = 1 - \\frac{3}{2} = -\\frac{1}{2}$。这证实了单元的一部分是无效的，而仅在 GQ 点进行检查会忽略这一事实。", "answer": "$$\\boxed{-\\frac{1}{5}}$$", "id": "2651722"}, {"introduction": "等参单元的刚度矩阵是通过对父单元域上的复杂函数进行数值积分来计算的。所选的积分方案对计算成本和精度有着深远的影响，有时甚至会影响解的稳定性。本练习 [@problem_id:2651763] 探讨了一种广泛使用的技术——减缩积分，并指导您分析其对双线性四边形单元刚度矩阵秩的影响。通过这个过程，您将亲手揭示减缩积分为何会导致被称为“沙漏模式”的非物理、零能量变形模式，这是计算力学中的一个经典且关键的概念。", "problem": "考虑一个用于小应变、线弹性问题的$4$节点双线性四边形等参有限元。该单元占据的物理域是通过标准双线性等参映射，由母单元正方形 $\\{(\\xi,\\eta)\\,|\\, -1 \\le \\xi \\le 1, -1 \\le \\eta \\le 1\\}$ 映射得到，其节点坐标为 $\\{(x_i,y_i)\\}_{i=1}^4$。设厚度为常数 $t>0$，平面应变问题的对称本构矩阵为正定，记为 $D \\in \\mathbb{R}^{3 \\times 3}$。单元位移场由作用于节点自由度 $\\{u_i, v_i\\}_{i=1}^4$ 的相同双线性形函数 $\\{N_i(\\xi,\\eta)\\}_{i=1}^4$ 插值得到。\n\n从等参格式的基本原理出发，即：等参映射的定义、雅可比矩阵 $J(\\xi,\\eta)$、通过位移场空间梯度表示的小应变张量，以及单元刚度矩阵作为 $B^{\\mathsf{T}} D B$ 在单元上乘以物理微分面积的积分的能量共轭定义，完成以下任务：\n\na) 将单元刚度矩阵 $K_e$ 表示为在母单元域上的积分，用应变-位移矩阵 $B(\\xi,\\eta)$ 和雅可比行列式 $\\det J(\\xi,\\eta)$ 来表达。\n\nb) 将该公式特化为使用单个高斯点的减缩积分方案，该高斯点位于 $(\\xi,\\eta)=(0,0)$，并采用适当的张量积高斯权重。用在 $(\\xi,\\eta)=(0,0)$ 处求得的量来表示最终的减缩积分刚度矩阵 $K_e^{\\mathrm{RI}}$。\n\nc) 假设高斯点处的雅可比矩阵是非奇异的，即 $\\det J(0,0) \\neq 0$，且 $D$ 是正定的，通过分析映射和双线性四边形 $B(\\xi,\\eta)$ 的结构，确定 $K_e^{\\mathrm{RI}}$ 的秩。然后计算 $K_e^{\\mathrm{RI}}$ 的非刚体零空间的维数（即独立沙漏模式的数量）。\n\nd) 利用等参映射和在单个积分点求值的作用，解释在何种关于映射的几何条件下，秩会进一步下降，并说明原因。\n\n将 c) 部分得到的数字作为最终答案，形式为单个整数（无单位）。无需四舍五入。", "solution": "这是一个有限元方法理论中的标准问题。我们将依据基本原理系统地解决每个部分。该问题在计算固体力学中有科学依据，是适定的、客观的且内部一致的。\n\na) 单元刚度矩阵 $K_e$ 的公式。\n\n等参格式的基础是使用相同的形函数来插值几何和位移场。对于一个$4$节点双线性四边形单元，形函数由 $N_i(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_i \\xi)(1+\\eta_i \\eta)$ 给出，其中 $i=1, 2, 3, 4$，$(\\xi_i, \\eta_i)$ 是母单元正方形中节点的坐标，通常取为 $(-1, -1)$、$(1, -1)$、$(1, 1)$ 和 $(-1, 1)$。\n\n物理坐标 $(x, y)$ 是从母单元坐标 $(\\xi, \\eta)$ 映射而来：\n$$ x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i $$\n$$ y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i $$\n同样地，位移场 $(u, v)$ 是由节点位移 $(u_i, v_i)$ 插值得到：\n$$ u(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_i $$\n$$ v(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) v_i $$\n在二维平面应变问题中，小应变张量的分量由向量 $\\varepsilon = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\mathsf{T}}$ 给出，其中：\n$$ \\varepsilon_{xx} = \\frac{\\partial u}{\\partial x}, \\quad \\varepsilon_{yy} = \\frac{\\partial v}{\\partial y}, \\quad \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} $$\n为计算这些空间导数，我们使用链式法则，它通过雅可比矩阵 $J$ 将物理空间中的导数与母单元空间中的导数联系起来：\n$$ \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{pmatrix} = J^{\\mathsf{T}} \\begin{pmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{pmatrix} $$\n因此，空间导数为 $\\begin{pmatrix} \\partial/\\partial x \\\\ \\partial/\\partial y \\end{pmatrix} = (J^{\\mathsf{T}})^{-1} \\begin{pmatrix} \\partial/\\partial \\xi \\\\ \\partial/\\partial \\eta \\end{pmatrix}$。\n应变可以用节点位移通过应变-位移矩阵 $B$ 来表示。设节点位移向量为 $\\mathbf{d} = [u_1, v_1, u_2, v_2, u_3, v_3, u_4, v_4]^{\\mathsf{T}}$。则 $\\varepsilon = B \\mathbf{d}$。矩阵 $B$ 可以写成 $B = [B_1, B_2, B_3, B_4]$，其中每个子矩阵 $B_i$ 是一个 $3 \\times 2$ 的矩阵：\n$$ B_i(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x} \\end{pmatrix} $$\n形函数的空间导数计算如下：\n$$ \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} = (J^{\\mathsf{T}})^{-1}(\\xi, \\eta) \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{pmatrix} $$\n单元刚度矩阵 $K_e$ 由单元体积 $V_e$ 上的应变能积分定义：\n$$ K_e = \\int_{V_e} B^{\\mathsf{T}} D B \\, dV $$\n对于一个常厚度 $t$ 的单元，$dV = t \\, dA$，其中 $dA$ 是物理域中的微分面积。为计算该积分，我们进行变量代换到母单元域，此时 $dA = \\det J(\\xi, \\eta) \\, d\\xi \\, d\\eta$。$\\xi$ 和 $\\eta$ 的积分限均为从 $-1$ 到 $1$。\n因此，单元刚度矩阵的表达式为：\n$$ K_e = t \\int_{-1}^{1} \\int_{-1}^{1} B(\\xi, \\eta)^{\\mathsf{T}} D B(\\xi, \\eta) \\det J(\\xi, \\eta) \\, d\\xi \\, d\\eta $$\n这完成了 a) 部分的公式推导。\n\nb) 减缩积分刚度矩阵 $K_e^{\\mathrm{RI}}$。\n\n对该单元进行减缩积分涉及使用单个高斯积分点来近似计算积分。对于区域 $[-1, 1] \\times [-1, 1]$，标准的单点法使用点 $(\\xi_1, \\eta_1) = (0, 0)$，其权重为 $w_1 = 2 \\times 2 = 4$。\n积分近似为：\n$$ \\int_{-1}^{1} \\int_{-1}^{1} f(\\xi, \\eta) \\, d\\xi \\, d\\eta \\approx w_1 f(\\xi_1, \\eta_1) = 4 f(0, 0) $$\n将此应用于 $K_e$ 的表达式，我们得到减缩积分刚度矩阵 $K_e^{\\mathrm{RI}}$：\n$$ K_e^{\\mathrm{RI}} = 4 t B(0, 0)^{\\mathsf{T}} D B(0, 0) \\det J(0, 0) $$\n其中所有项，$B$、$J$ 和 $\\det J$，都是在母单元的中心 $(\\xi, \\eta) = (0, 0)$ 处计算的。\n\nc) 秩分析与沙漏模式数量。\n\n刚度矩阵 $K_e^{\\mathrm{RI}}$ 是一个 $8 \\times 8$ 矩阵，因为有 $8$ 个节点自由度。它的秩由其定义中的矩阵的秩决定。我们已知厚度 $t > 0$，本构矩阵 $D$ 是正定的（因此秩为 $3$），并且中心点的雅可比矩阵是非奇异的，所以 $\\det J(0, 0) \\neq 0$。矩阵乘积的秩受限于乘积中任何矩阵的最小秩。$K_e^{\\mathrm{RI}}$ 的公式形式为 $C^{\\mathsf{T}} M C$。若 $M$ 是正定的，则该矩阵的秩等于 $C$ 的秩。在我们的例子中，$C = B(0,0)$ 且 $M=D$（乘以常数）。因此，$\\mathrm{rank}(K_e^{\\mathrm{RI}}) = \\mathrm{rank}(B(0, 0))$。\n\n我们必须求出 $3 \\times 8$ 矩阵 $B(0, 0)$ 的秩。形函数在 $(\\xi, \\eta) = (0, 0)$ 处的导数为：\n$$ \\frac{\\partial N_i}{\\partial \\xi}\\bigg|_{(0,0)} = \\frac{1}{4} \\xi_i, \\quad \\frac{\\partial N_i}{\\partial \\eta}\\bigg|_{(0,0)} = \\frac{1}{4} \\eta_i $$\n令 $\\mathbf{b}_i(0,0) = [\\frac{\\partial N_i}{\\partial x}, \\frac{\\partial N_i}{\\partial y}]^{\\mathsf{T}}$ 于 $(0,0)$ 处。我们有 $\\mathbf{b}_i(0,0) = (J^{\\mathsf{T}})^{-1}(0,0) [\\frac{1}{4}\\xi_i, \\frac{1}{4}\\eta_i]^{\\mathsf{T}}$。\n矩阵 $B(0,0)$ 有三行。我们来检验它们的线性无关性。假设行的线性组合为零，$c_1 \\mathbf{r}_1 + c_2 \\mathbf{r}_2 + c_3 \\mathbf{r}_3 = \\mathbf{0}$，这在 $\\mathbb{R}^4$ 中产生两个向量方程：\n对于 $u_i$ 分量：$c_1 [\\dots, \\frac{\\partial N_i}{\\partial x}, \\dots] + c_3 [\\dots, \\frac{\\partial N_i}{\\partial y}, \\dots] = \\mathbf{0}$\n对于 $v_i$ 分量：$c_2 [\\dots, \\frac{\\partial N_i}{\\partial y}, \\dots] + c_3 [\\dots, \\frac{\\partial N_i}{\\partial x}, \\dots] = \\mathbf{0}$\n令节点导数向量为 $\\mathbf{g}_x = [\\frac{\\partial N_1}{\\partial x}, \\dots, \\frac{\\partial N_4}{\\partial x}]^{\\mathsf{T}}$ 和 $\\mathbf{g}_y = [\\frac{\\partial N_1}{\\partial y}, \\dots, \\frac{\\partial N_4}{\\partial y}]^{\\mathsf{T}}$，两者均在 $(0,0)$ 处求值。这些方程是 $c_1 \\mathbf{g}_x + c_3 \\mathbf{g}_y = \\mathbf{0}$ 和 $c_2 \\mathbf{g}_y + c_3 \\mathbf{g}_x = \\mathbf{0}$。\n向量 $\\mathbf{g}_x$ 和 $\\mathbf{g}_y$ 是向量 $\\boldsymbol{\\xi} = [-1, 1, 1, -1]^{\\mathsf{T}}$ 和 $\\boldsymbol{\\eta} = [-1, -1, 1, 1]^{\\mathsf{T}}$ 的线性组合。由于 $J(0,0)$ 是非奇异的，$(J^{\\mathsf{T}})^{-1}$ 也是非奇异的，因此 $\\mathbf{g}_x$ 和 $\\mathbf{g}_y$ 是 $\\mathbb{R}^4$ 中的线性无关向量。从第一个方程看，$\\mathbf{g}_x$ 和 $\\mathbf{g}_y$ 的线性无关性迫使 $c_1=0$ 和 $c_3=0$。将 $c_3=0$ 代入第二个方程得到 $c_2 \\mathbf{g}_y = \\mathbf{0}$，由于 $\\mathbf{g}_y$ 不是零向量，这意味着 $c_2=0$。\n因此，唯一的解是 $c_1=c_2=c_3=0$，这证明了 $B(0,0)$ 的三行是线性无关的。\n所以，$B(0,0)$ 的秩为 $3$。因此，$\\mathrm{rank}(K_e^{\\mathrm{RI}}) = 3$。\n\n根据秩-零度定理，$K_e^{\\mathrm{RI}}$ 的零空间维数（零度）为：\n$$ \\mathrm{dim}(\\mathrm{ker}(K_e^{\\mathrm{RI}})) = (\\text{自由度数量}) - \\mathrm{rank}(K_e^{\\mathrm{RI}}) = 8 - 3 = 5 $$\n刚度矩阵的零空间包含了对应于零能变形模式的向量。对于一个二维物体，有 3 种刚体模式（两个平移，一个旋转），它们不产生应变，因此没有应变能。这 3 种模式是 $K_e^{\\mathrm{RI}}$ 的 5 维零空间的一部分。\n零空间中余下的模式是非物理的、称为沙漏模式的零能模式。其数量为：\n$$ \\text{沙漏模式数量} = \\mathrm{dim}(\\mathrm{ker}(K_e^{\\mathrm{RI}})) - (\\text{刚体模式数量}) = 5 - 3 = 2 $$\n这两种模式是伪模式，是减缩积分方案的人为产物。\n\nd) 秩进一步下降的条件。\n\n$\\mathrm{rank}(K_e^{\\mathrm{RI}}) = 3$ 的结论关键取决于积分点处的雅可比矩阵 $J(0, 0)$ 是非奇异的这一假设。如果该假设不成立，秩分析就会改变。\n如果 $B(0,0)$ 的秩降到 $3$ 以下，$K_e^{\\mathrm{RI}}$ 的秩就会进一步下降。我们关于 $B(0,0)$ 的行线性无关的证明，在向量 $\\mathbf{g}_x$ 和 $\\mathbf{g}_y$ 变为线性相关时将失效。这种情况恰好在 $J(0, 0)$ 是奇异的时候发生，即 $\\det J(0, 0) = 0$。\n$\\det J(0, 0) = 0$ 的几何条件是，从母单元到物理单元的映射在中心点变得奇异。中心点的雅可比矩阵可以表示为：\n$$ J(0,0) = \\frac{1}{4} \\begin{pmatrix} \\sum_{i=1}^4 \\xi_i x_i & \\sum_{i=1}^4 \\eta_i x_i \\\\ \\sum_{i=1}^4 \\xi_i y_i & \\sum_{i=1}^4 \\eta_i y_i \\end{pmatrix} $$\n当其两个行向量（或列向量）线性相关时，其行列式为零。对于严重扭曲的单元几何形状，例如自相交（“蝶形”或“交叉”）的四边形，其中映射实际上发生了自我“折叠”，就可能发生这种情况。例如，如果节点的排序方式导致单元边界自相交。\n当 $\\det J(0, 0) = 0$ 时，逆矩阵 $J(0,0)^{-1}$ 不存在，标准计算空间导数和 $B$ 矩阵的过程就会中断。从物理上讲，某一点的雅可比矩阵奇异意味着母单元域中一个非零面积可以映射到物理域中的一条线或一个点。在该点，单元对某些变形模式没有刚度，导致额外的零能模式，并使刚度矩阵的秩下降得比标准沙漏模式所引起的更多。", "answer": "$$\\boxed{2}$$", "id": "2651763"}]}