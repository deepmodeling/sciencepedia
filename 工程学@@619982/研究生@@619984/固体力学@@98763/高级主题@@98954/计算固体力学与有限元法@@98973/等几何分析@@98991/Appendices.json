{"hands_on_practices": [{"introduction": "等几何分析的基础在于精确描述几何。本练习将引导你完成从其定义要素——控制点、权重和节点矢量——构建非均匀有理B样条（NURBS）曲面的基本过程。掌握这一步对于理解CAD系统中的几何模型如何被表示并在分析中加以利用至关重要。[@problem_id:2651405]", "problem": "考虑构建一个非均匀有理B样条（NURBS）曲面，其中NURBS代表非均匀有理B样条。在右手笛卡尔坐标系中进行计算。设双次数为 $p=q=1$，开节点矢量为 $U=[0,0,1,1]$ 和 $V=[0,0,1,1]$。$2 \\times 2$ 的控制网格由控制点 $P_{00}=(0,0,0)$ 米, $P_{10}=(2,0,1)$ 米, $P_{01}=(0,3,1)$ 米, 和 $P_{11}=(2,3,2)$ 米 给出，对应的NURBS权重为 $w_{00}=1$, $w_{10}=2$, $w_{01}=1$, 和 $w_{11}=\\tfrac{3}{2}$。使用标准的张量积NURBS构造方法，在 $[0,1]\\times[0,1]$ 上定义曲面 $S(u,v)$，其中标量权重函数 $W(u,v)$ 和有理基函数 $R_{ij}(u,v)$ 由每个方向上的1次B样条基函数构成。\n\n从第一性原理出发，使用开节点矢量上的1次B样条基函数的定义以及有理曲面构造方法，在参数对 $(u_{0},v_{0})=\\left(\\tfrac{1}{3},\\tfrac{1}{2}\\right)$ 处执行以下操作：\n1. 构建NURBS曲面点 $S(u_{0},v_{0})$。\n2. 通过对有理曲面求关于 $u$ 和 $v$ 的偏导数，计算切向量 $S_{u}(u_{0},v_{0})$ 和 $S_{v}(u_{0},v_{0})$。\n3. 计算曲面法向量 $n(u_{0},v_{0})=S_{u}(u_{0},v_{0})\\times S_{v}(u_{0},v_{0})$ 和相关的单位法向量 $\\hat{n}(u_{0},v_{0})=n/\\|n\\|$。\n\n答案要求：仅报告模长 $\\|n(u_{0},v_{0})\\|$，单位为平方米。将答案四舍五入到四位有效数字。最终的模长以 $\\mathrm{m}^{2}$ 表示（在方框内的最终答案中不包括单位）。", "solution": "首先将对问题陈述进行严格验证。\n\n步骤 1：提取已知条件\n从问题陈述中逐字提取已知条件：\n- 双次数：$p=1, q=1$。\n- 开节点矢量：$U=[0,0,1,1]$, $V=[0,0,1,1]$。\n- 控制网格 ($2 \\times 2$)：$P_{00}=(0,0,0)$ 米, $P_{10}=(2,0,1)$ 米, $P_{01}=(0,3,1)$ 米, $P_{11}=(2,3,2)$ 米。\n- NURBS权重：$w_{00}=1$, $w_{10}=2$, $w_{01}=1$, $w_{11}=\\tfrac{3}{2}$。\n- 曲面定义：通过标准的张量积NURBS构造在 $[0,1]\\times[0,1]$ 上定义的曲面 $S(u,v)$。\n- 求值点：$(u_{0},v_{0})=\\left(\\tfrac{1}{3},\\tfrac{1}{2}\\right)$。\n- 任务：计算 $S(u_0,v_0)$, $S_{u}(u_0,v_0)$, $S_{v}(u_0,v_0)$, $n(u_0,v_0)=S_{u}\\times S_{v}$，以及最终的 $\\|n(u_0,v_0)\\|$。\n- 最终答案要求：报告 $\\|n(u_0,v_0)\\|$ 并四舍五入到四位有效数字。\n\n步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题是计算机辅助几何设计（CAGD）中的一个标准练习，并且是等几何分析的基础。NURBS曲面的构建基于已建立的数学原理。该问题在科学上是合理的。\n- **适定性**：问题给出了完整的定义。控制点数量（$2 \\times 2$）与次数（$p=1, q=1$）以及开节点矢量的长度（对于1次和2个控制点，需要4个节点）相一致。求值点在参数域内。存在唯一、稳定的解。\n- **客观性**：问题使用精确、无歧义的数学语言陈述，不包含主观或基于观点的论断。\n\n所有其他有效性标准也均已满足。没有矛盾、缺失数据或不切实际的条件。\n\n步骤 3：结论与行动\n问题有效。下面给出完整的、有理有据的解答。\n\nNURBS曲面 $S(u,v)$ 由以下有理公式定义：\n$$ S(u,v) = \\frac{\\sum_{i=0}^{1} \\sum_{j=0}^{1} N_{i,p}(u) N_{j,q}(v) w_{ij} P_{ij}}{\\sum_{i=0}^{1} \\sum_{j=0}^{1} N_{i,p}(u) N_{j,q}(v) w_{ij}} = \\frac{A(u,v)}{W(u,v)} $$\n其中 $p=1$ 且 $q=1$。对于开节点矢量 $U=[0,0,1,1]$，在定义域 $u \\in [0,1]$ 上的 $p=1$ 次B样条基函数是线性Bernstein多项式：\n$$ N_{0,1}(u) = 1-u $$\n$$ N_{1,1}(u) = u $$\n类似地，对于节点矢量 $V=[0,0,1,1]$，$q=1$ 次的基函数是：\n$$ N_{0,1}(v) = 1-v $$\n$$ N_{1,1}(v) = v $$\n\n首先，我们在指定的参数点 $(u_0, v_0) = (\\frac{1}{3}, \\frac{1}{2})$ 处计算标量权重函数 $W(u,v)$ 和矢量值函数 $A(u,v)$。\n基函数的计算结果为：\n$N_{0,1}(u_0) = 1 - \\frac{1}{3} = \\frac{2}{3}$, $N_{1,1}(u_0) = \\frac{1}{3}$。\n$N_{0,1}(v_0) = 1 - \\frac{1}{2} = \\frac{1}{2}$, $N_{1,1}(v_0) = \\frac{1}{2}$。\n\n权重函数 $W(u,v)$ 是：\n$$ W(u,v) = (1-u)(1-v)w_{00} + u(1-v)w_{10} + (1-u)v w_{01} + uv w_{11} $$\n在 $(u_0, v_0)$ 处：\n$$ W(\\tfrac{1}{3},\\tfrac{1}{2}) = (\\tfrac{2}{3})(\\tfrac{1}{2})(1) + (\\tfrac{1}{3})(\\tfrac{1}{2})(2) + (\\tfrac{2}{3})(\\tfrac{1}{2})(1) + (\\tfrac{1}{3})(\\tfrac{1}{2})(\\tfrac{3}{2}) = \\tfrac{1}{3} + \\tfrac{1}{3} + \\tfrac{1}{3} + \\tfrac{1}{4} = 1 + \\tfrac{1}{4} = \\tfrac{5}{4} $$\n矢量值函数 $A(u,v)$ 是：\n$$ A(u,v) = (1-u)(1-v)w_{00}P_{00} + u(1-v)w_{10}P_{10} + (1-u)v w_{01}P_{01} + uv w_{11}P_{11} $$\n在 $(u_0, v_0)$ 处：\n$$ A(\\tfrac{1}{3},\\tfrac{1}{2}) = (\\tfrac{2}{3})(\\tfrac{1}{2})(1)P_{00} + (\\tfrac{1}{3})(\\tfrac{1}{2})(2)P_{10} + (\\tfrac{2}{3})(\\tfrac{1}{2})(1)P_{01} + (\\tfrac{1}{3})(\\tfrac{1}{2})(\\tfrac{3}{2})P_{11} $$\n$$ A(\\tfrac{1}{3},\\tfrac{1}{2}) = \\tfrac{1}{3}P_{00} + \\tfrac{1}{3}P_{10} + \\tfrac{1}{3}P_{01} + \\tfrac{1}{4}P_{11} $$\n代入控制点 $P_{ij}$：\n$$ A(\\tfrac{1}{3},\\tfrac{1}{2}) = \\tfrac{1}{3}(0,0,0) + \\tfrac{1}{3}(2,0,1) + \\tfrac{1}{3}(0,3,1) + \\tfrac{1}{4}(2,3,2) $$\n$$ A(\\tfrac{1}{3},\\tfrac{1}{2}) = (0,0,0) + (\\tfrac{2}{3},0,\\tfrac{1}{3}) + (0,1,\\tfrac{1}{3}) + (\\tfrac{1}{2},\\tfrac{3}{4},\\tfrac{1}{2}) = (\\tfrac{2}{3}+\\tfrac{1}{2}, 1+\\tfrac{3}{4}, \\tfrac{2}{3}+\\tfrac{1}{2}) = (\\tfrac{7}{6}, \\tfrac{7}{4}, \\tfrac{7}{6}) $$\n曲面点为 $S(u_0, v_0) = \\frac{A(u_0, v_0)}{W(u_0, v_0)} = \\frac{(\\tfrac{7}{6}, \\tfrac{7}{4}, \\tfrac{7}{6})}{\\tfrac{5}{4}} = \\tfrac{4}{5}(\\tfrac{7}{6}, \\tfrac{7}{4}, \\tfrac{7}{6}) = (\\tfrac{14}{15}, \\tfrac{7}{5}, \\tfrac{14}{15})$。\n\n接下来，我们计算切向量。有理曲面的导数使用商法则求得：\n$$ S_{u} = \\frac{A_u W - A W_u}{W^2} \\quad \\text{和} \\quad S_{v} = \\frac{A_v W - A W_v}{W^2} $$\n我们需要 $A(u,v)$ 和 $W(u,v)$ 的偏导数。\n基函数的导数是 $\\frac{d}{du}N_{0,1}(u) = -1$，$\\frac{d}{du}N_{1,1}(u) = 1$，对于 $v$ 也类似。\n$$ W_u = \\frac{\\partial W}{\\partial u} = (1-v)(w_{10}-w_{00}) + v(w_{11}-w_{01}) $$\n$$ W_v = \\frac{\\partial W}{\\partial v} = (1-u)(w_{01}-w_{00}) + u(w_{11}-w_{10}) $$\n$$ A_u = \\frac{\\partial A}{\\partial u} = (1-v)(w_{10}P_{10}-w_{00}P_{00}) + v(w_{11}P_{11}-w_{01}P_{01}) $$\n$$ A_v = \\frac{\\partial A}{\\partial v} = (1-u)(w_{01}P_{01}-w_{00}P_{00}) + u(w_{11}P_{11}-w_{10}P_{10}) $$\n在 $(u_0, v_0) = (\\frac{1}{3}, \\frac{1}{2})$ 处计算这些值：\n$$ W_u = \\tfrac{1}{2}(2-1) + \\tfrac{1}{2}(\\tfrac{3}{2}-1) = \\tfrac{1}{2} + \\tfrac{1}{4} = \\tfrac{3}{4} $$\n$$ W_v = \\tfrac{2}{3}(1-1) + \\tfrac{1}{3}(\\tfrac{3}{2}-2) = 0 + \\tfrac{1}{3}(-\\tfrac{1}{2}) = -\\tfrac{1}{6} $$\n$$ A_u = \\tfrac{1}{2}(2P_{10}-1P_{00}) + \\tfrac{1}{2}(\\tfrac{3}{2}P_{11}-1P_{01}) = \\tfrac{1}{2}(2(2,0,1)) + \\tfrac{1}{2}((\\tfrac{3}{2}(2,3,2))-(0,3,1)) = (2,0,1) + \\tfrac{1}{2}((3,\\tfrac{9}{2},3)-(0,3,1)) = (2,0,1) + \\tfrac{1}{2}(3,\\tfrac{3}{2},2) = (2+\\tfrac{3}{2}, \\tfrac{3}{4}, 1+1) = (\\tfrac{7}{2}, \\tfrac{3}{4}, 2) $$\n$$ A_v = \\tfrac{2}{3}(1P_{01}-1P_{00}) + \\tfrac{1}{3}(\\tfrac{3}{2}P_{11}-2P_{10}) = \\tfrac{2}{3}(0,3,1) + \\tfrac{1}{3}((\\tfrac{3}{2}(2,3,2))-(2(2,0,1))) = (0,2,\\tfrac{2}{3}) + \\tfrac{1}{3}((3,\\tfrac{9}{2},3)-(4,0,2)) = (0,2,\\tfrac{2}{3}) + \\tfrac{1}{3}(-1,\\tfrac{9}{2},1) = (-\\tfrac{1}{3}, 2+\\tfrac{3}{2}, \\tfrac{2}{3}+\\tfrac{1}{3}) = (-\\tfrac{1}{3}, \\tfrac{7}{2}, 1) $$\n现在，组合切向量。我们有 $W=\\tfrac{5}{4}$，所以 $W^2=\\tfrac{25}{16}$。\n对于 $S_u$：\n$$ A_u W - A W_u = (\\tfrac{7}{2}, \\tfrac{3}{4}, 2)(\\tfrac{5}{4}) - (\\tfrac{7}{6}, \\tfrac{7}{4}, \\tfrac{7}{6})(\\tfrac{3}{4}) = (\\tfrac{35}{8}, \\tfrac{15}{16}, \\tfrac{5}{2}) - (\\tfrac{7}{8}, \\tfrac{21}{16}, \\tfrac{7}{8}) = (\\tfrac{28}{8}, -\\tfrac{6}{16}, \\tfrac{13}{8}) = (\\tfrac{7}{2}, -\\tfrac{3}{8}, \\tfrac{13}{8}) $$\n$$ S_u(\\tfrac{1}{3},\\tfrac{1}{2}) = \\frac{(\\tfrac{7}{2}, -\\tfrac{3}{8}, \\tfrac{13}{8})}{\\tfrac{25}{16}} = \\tfrac{16}{25}(\\tfrac{7}{2}, -\\tfrac{3}{8}, \\tfrac{13}{8}) = (\\tfrac{56}{25}, -\\tfrac{6}{25}, \\tfrac{26}{25}) $$\n对于 $S_v$：\n$$ A_v W - A W_v = (-\\tfrac{1}{3}, \\tfrac{7}{2}, 1)(\\tfrac{5}{4}) - (\\tfrac{7}{6}, \\tfrac{7}{4}, \\tfrac{7}{6})(-\\tfrac{1}{6}) = (-\\tfrac{5}{12}, \\tfrac{35}{8}, \\tfrac{5}{4}) - (-\\tfrac{7}{36}, -\\tfrac{7}{24}, -\\tfrac{7}{36}) = (-\\tfrac{8}{36}, \\tfrac{112}{24}, \\tfrac{52}{36}) = (-\\tfrac{2}{9}, \\tfrac{14}{3}, \\tfrac{13}{9}) $$\n$$ S_v(\\tfrac{1}{3},\\tfrac{1}{2}) = \\frac{(-\\tfrac{2}{9}, \\tfrac{14}{3}, \\tfrac{13}{9})}{\\tfrac{25}{16}} = \\tfrac{16}{25}(-\\tfrac{2}{9}, \\tfrac{14}{3}, \\tfrac{13}{9}) = (-\\tfrac{32}{225}, \\tfrac{224}{75}, \\tfrac{208}{225}) $$\n计算法向量 $n = S_u \\times S_v$：\n$$ n = (\\tfrac{56}{25}, -\\tfrac{6}{25}, \\tfrac{26}{25}) \\times (-\\tfrac{32}{225}, \\tfrac{224}{75}, \\tfrac{208}{225}) $$\n$$ n = \\frac{1}{25 \\cdot 225} (56, -6, 26) \\times (-32, 672, 208) $$\n叉积为：\n$$ \\begin{vmatrix} \\mathbf{i} & \\mathbf{j} & \\mathbf{k} \\\\ 56 & -6 & 26 \\\\ -32 & 672 & 208 \\end{vmatrix} = ((-6)(208) - (26)(672))\\mathbf{i} - ((56)(208) - (26)(-32))\\mathbf{j} + ((56)(672) - (-6)(-32))\\mathbf{k} $$\n$$ = (-1248 - 17472)\\mathbf{i} - (11648 + 832)\\mathbf{j} + (37632 - 192)\\mathbf{k} = -18720\\mathbf{i} - 12480\\mathbf{j} + 37440\\mathbf{k} $$\n所以 $n = \\frac{1}{5625}(-18720, -12480, 37440)$。\n我们从矢量分量中提取公因子 $6240$：$6240(-3, -2, 6)$。\n$$ n = \\frac{6240}{5625}(-3, -2, 6) = \\frac{416}{375}(-3, -2, 6) $$\n法向量的模长为：\n$$ \\|n\\| = |\\tfrac{416}{375}| \\cdot \\|(-3, -2, 6)\\| = \\tfrac{416}{375} \\sqrt{(-3)^2 + (-2)^2 + 6^2} = \\tfrac{416}{375} \\sqrt{9+4+36} = \\tfrac{416}{375} \\sqrt{49} $$\n$$ \\|n(\\tfrac{1}{3},\\tfrac{1}{2})\\| = \\tfrac{416 \\times 7}{375} = \\tfrac{2912}{375} $$\n换算成小数，即为 $\\tfrac{2912}{375} \\approx 7.765333...$\n四舍五入到四位有效数字得到 $7.765$。\n控制点的单位是米 (m)，因此切向量的单位是米 (m)，法向量模长的单位是 $\\mathrm{m}^2$。", "answer": "$$\n\\boxed{7.765}\n$$", "id": "2651405"}, {"introduction": "定义几何之后，等几何分析的下一步是对其进行分析。这需要在物理域上进行积分，而这通常通过从一个简单的父单元进行积分映射来实现。本练习通过计算雅可比矩阵的行列式和完整的求积权重，将几何与分析联系起来，这是在任何基于有限元的方法中组装刚度或质量等系统矩阵的关键组成部分。[@problem_id:2651381]", "problem": "考虑一个用于等几何分析的双参数非均匀有理B样条 (NURBS) 曲面，该曲面将一个参数域映射到二维实体力学中的一个平面实体域。该曲面的双次数为 $(p,q)=(1,1)$，每个参数方向上的开放节点矢量为\n$$\\Xi = [\\,0,\\,0,\\,0.5,\\,1,\\,1\\,], \\qquad \\mathcal{H} = [\\,0,\\,0,\\,0.3,\\,1,\\,1\\,].$$\n在 $\\xi$ 方向上有 $n_{\\xi}=3$ 个基函数，在 $\\eta$ 方向上有 $n_{\\eta}=3$ 个基函数。$3\\times 3$ 的控制网格 $\\{\\mathbf{P}_{ij}\\}_{i=1..3,\\,j=1..3}$（坐标单位为米）和对应的 NURBS 权重 $\\{w_{ij}\\}$ 为\n$$\\mathbf{P}_{11}=(0,0),\\;\\mathbf{P}_{21}=(2,0.2),\\;\\mathbf{P}_{31}=(4,0),$$\n$$\\mathbf{P}_{12}=(0.1,1),\\;\\mathbf{P}_{22}=(2.1,1.1),\\;\\mathbf{P}_{32}=(4.1,1),$$\n$$\\mathbf{P}_{13}=(0,2),\\;\\mathbf{P}_{23}=(2,2.1),\\;\\mathbf{P}_{33}=(4,2),$$\n且\n$$w_{ij}=1 \\quad \\text{对于所有 } i,j.$$\n\n关注由 $[\\xi_{2},\\xi_{3}]\\times[\\eta_{2},\\eta_{3}] = [0.5,\\,1]\\times[0.3,\\,1]$ 给出的张量积节点区间（单元）。考虑在父方形域 $[-1,1]\\times[-1,1]$ 上的标准两点 Gauss–Legendre 求积，其求积点和权重为\n$$r,s \\in \\left\\{-\\frac{1}{\\sqrt{3}},\\,+\\frac{1}{\\sqrt{3}}\\right\\}, \\qquad w_{r}=1,\\; w_{s}=1.$$\n在父空间中的特定 Gauss 点 $(r,s)=\\left(\\frac{1}{\\sqrt{3}},\\,-\\frac{1}{\\sqrt{3}}\\right)$ 处：\n\n- 通过从 $[-1,1]$ 到各节点子区间的标准仿射映射，将 $(r,s)$ 映射到所选单元的参数坐标 $(\\xi,\\eta)$。\n- 利用次数为 $1$ 的 B 样条基函数在单个节点区间上的基本定义，构造非零的张量积基函数及其关于 $\\xi$ 和 $\\eta$ 的一阶导数。然后，使用 NURBS 基函数的定义，获得几何映射所需的相应有理基函数及其导数。\n- 使用几何映射 $\\mathbf{x}(\\xi,\\eta)=\\sum_{i=1}^{3}\\sum_{j=1}^{3} R_{ij}(\\xi,\\eta)\\,\\mathbf{P}_{ij}$，计算所选积分点的映射物理坐标以及该点的雅可比矩阵 $\\mathbf{J}=\\partial\\mathbf{x}/\\partial(\\xi,\\eta)$。计算 $\\det\\mathbf{J}$。\n- 利用从父空间到物理空间的积分变量变换（面积元的推前），组合该 Gauss 点处的求积权重 $W$，该权重必须包括从父域到参数域的缩放因子和 $\\det\\mathbf{J}$。\n\n仅报告此 Gauss 点的最终求积权重 $W$。以平方米为单位表示您的答案。不要四舍五入；提供精确值。", "solution": "在继续之前，对所述问题进行验证。\n\n**步骤1：提取给定条件**\n- **几何类型**：双参数非均匀有理B样条 (NURBS) 曲面。\n- **双次数**：$(p,q)=(1,1)$。\n- **节点矢量**：$\\xi$ 方向为 $\\Xi = [\\,0,\\,0,\\,0.5,\\,1,\\,1\\,]$，$\\eta$ 方向为 $\\mathcal{H} = [\\,0,\\,0,\\,0.3,\\,1,\\,1\\,]$。\n- **基函数**：$\\xi$ 方向有 $n_{\\xi}=3$ 个函数，$\\eta$ 方向有 $n_{\\eta}=3$ 个函数。\n- **控制网格**：一个 $3\\times 3$ 的点阵 $\\{\\mathbf{P}_{ij}\\}$，坐标单位为米：\n  $\\mathbf{P}_{11}=(0,0)$, $\\mathbf{P}_{21}=(2,0.2)$, $\\mathbf{P}_{31}=(4,0)$,\n  $\\mathbf{P}_{12}=(0.1,1)$, $\\mathbf{P}_{22}=(2.1,1.1)$, $\\mathbf{P}_{32}=(4.1,1)$,\n  $\\mathbf{P}_{13}=(0,2)$, $\\mathbf{P}_{23}=(2,2.1)$, $\\mathbf{P}_{33}=(4,2)$。\n- **权重**：对于所有 $i,j$，$w_{ij}=1$。\n- **目标单元**：张量积节点区间 $[\\xi_{i},\\xi_{i+1}]\\times[\\eta_{j},\\eta_{j+1}] = [0.5,\\,1]\\times[0.3,\\,1]$。使用标准的从0开始的节点索引（$m+1=n+p+1=5$ 个节点，索引为0到4），这对应于单元 $[\\xi_2, \\xi_3] \\times [\\eta_2, \\eta_3]$。\n- **求积法则**：在父方形域 $[-1,1]\\times[-1,1]$ 上的两点 Gauss-Legendre 求积。\n- **求积点/权重**：$r,s \\in \\{-\\frac{1}{\\sqrt{3}},\\,+\\frac{1}{\\sqrt{3}}\\}$，权重为 $w_{r}=1, w_{s}=1$。\n- **特定积分点**：父域中的 $(r,s)=\\left(\\frac{1}{\\sqrt{3}},\\,-\\frac{1}{\\sqrt{3}}\\right)$。\n\n**步骤2：使用提取的给定条件进行验证**\n该问题具有科学依据，是适定的、客观的。它是等几何分析中的一个标准练习，而等几何分析是计算固体力学中一个成熟的学科。所有数据都已提供，是自洽的，并且足以计算出唯一解。语言精确，设置中不包含逻辑矛盾或物理上不合理的情况。因此，该问题被认定为 **有效** 的。\n\n**步骤3：求解**\n我们进行计算。\n\n**1. 从父域到参数域的映射**\n从父坐标 $\\hat{\\zeta} \\in [-1,1]$ 到参数坐标 $\\zeta \\in [\\zeta_a, \\zeta_b]$ 的仿射映射由下式给出\n$$ \\zeta(\\hat{\\zeta}) = \\frac{\\zeta_b - \\zeta_a}{2} \\hat{\\zeta} + \\frac{\\zeta_a + \\zeta_b}{2} $$\n对于 $\\xi$ 方向，单元是 $[0.5, 1]$。其映射为：\n$$ \\xi(r) = \\frac{1 - 0.5}{2} r + \\frac{0.5 + 1}{2} = 0.25 r + 0.75 = \\frac{1}{4} r + \\frac{3}{4} $$\n对于 $\\eta$ 方向，单元是 $[0.3, 1]$。其映射为：\n$$ \\eta(s) = \\frac{1 - 0.3}{2} s + \\frac{0.3 + 1}{2} = 0.35 s + 0.65 = \\frac{7}{20} s + \\frac{13}{20} $$\n在指定的 Gauss 点 $(r,s)=\\left(\\frac{1}{\\sqrt{3}},\\,-\\frac{1}{\\sqrt{3}}\\right)$，参数坐标为：\n$$ \\xi = \\frac{1}{4}\\left(\\frac{1}{\\sqrt{3}}\\right) + \\frac{3}{4} = \\frac{1+3\\sqrt{3}}{4\\sqrt{3}} $$\n$$ \\eta = \\frac{7}{20}\\left(-\\frac{1}{\\sqrt{3}}\\right) + \\frac{13}{20} = \\frac{13\\sqrt{3}-7}{20\\sqrt{3}} $$\n\n**2. B样条基函数及其导数**\n对于节点区间 $[\\xi_i, \\xi_{i+1}]$ 上的一个次数为 $p=1$ 的B样条，两个非零基函数是线性的：\n$$ N_{i-1,1}(\\xi) = \\frac{\\xi_{i+1}-\\xi}{\\xi_{i+1}-\\xi_i}, \\qquad N_{i,1}(\\xi) = \\frac{\\xi-\\xi_i}{\\xi_{i+1}-\\xi_i} $$\n目标单元是 $[\\xi_2, \\xi_3] \\times [\\eta_2, \\eta_3] = [0.5, 1] \\times [0.3, 1]$。根据问题中基函数的1-基索引，此单元上的非零函数为 $N_{2,1}(\\xi), N_{3,1}(\\xi)$ 和 $N_{2,1}(\\eta), N_{3,1}(\\eta)$。\n\n在 $\\xi$ 方向，在区间 $[\\xi_2, \\xi_3] = [0.5, 1]$ 上：\n$$ N_{2,1}(\\xi) = \\frac{1-\\xi}{1-0.5} = 2(1-\\xi) \\implies \\frac{dN_{2,1}}{d\\xi} = -2 $$\n$$ N_{3,1}(\\xi) = \\frac{\\xi-0.5}{1-0.5} = 2(\\xi-0.5) \\implies \\frac{dN_{3,1}}{d\\xi} = 2 $$\n\n在 $\\eta$ 方向，在区间 $[\\eta_2, \\eta_3] = [0.3, 1]$ 上：\n$$ N_{2,1}(\\eta) = \\frac{1-\\eta}{1-0.3} = \\frac{10}{7}(1-\\eta) \\implies \\frac{dN_{2,1}}{d\\eta} = -\\frac{10}{7} $$\n$$ N_{3,1}(\\eta) = \\frac{\\eta-0.3}{1-0.3} = \\frac{10}{7}(\\eta-0.3) \\implies \\frac{dN_{3,1}}{d\\eta} = \\frac{10}{7} $$\n\n**3. NURBS 基函数**\nNURBS 基函数 $R_{ij}$ 定义为 $R_{ij}(\\xi,\\eta) = \\frac{N_{i,p}(\\xi)N_{j,q}(\\eta)w_{ij}}{\\sum_{k,l} N_{k,p}(\\xi)N_{l,q}(\\eta)w_{kl}}$。由于所有权重 $w_{ij}=1$，分母是所有加权基函数的和，其值变为 $\\sum_{k,l} N_{k,p}(\\xi)N_{l,q}(\\eta) = (\\sum_k N_{k,p}(\\xi))(\\sum_l N_{l,q}(\\eta)) = 1 \\cdot 1 = 1$，这是因为B样条具有单位分解特性。\n因此，NURBS 公式简化为B样条公式：$R_{ij}(\\xi,\\eta) = N_{i,1}(\\xi)N_{j,1}(\\eta)$。导数也同样被简化，例如 $\\frac{\\partial R_{ij}}{\\partial\\xi} = \\frac{dN_{i,1}}{d\\xi} N_{j,1}(\\eta)$。\n\n**4. 几何映射的雅可比矩阵**\n几何映射为 $\\mathbf{x}(\\xi,\\eta)=\\sum_{i=1}^{3}\\sum_{j=1}^{3} R_{ij}(\\xi,\\eta)\\,\\mathbf{P}_{ij}$。在指定单元上，只有控制点 $\\mathbf{P}_{22}, \\mathbf{P}_{23}, \\mathbf{P}_{32}, \\mathbf{P}_{33}$ 是活动的。雅可比矩阵是 $\\mathbf{J} = \\frac{\\partial\\mathbf{x}}{\\partial(\\xi,\\eta)}$。它的列是 $\\frac{\\partial\\mathbf{x}}{\\partial\\xi}$ 和 $\\frac{\\partial\\mathbf{x}}{\\partial\\eta}$。\n$$ \\frac{\\partial\\mathbf{x}}{\\partial\\xi} = \\sum_{i=2,3}\\sum_{j=2,3} \\frac{dN_{i,1}}{d\\xi} N_{j,1}(\\eta) \\mathbf{P}_{ij} = \\frac{dN_{2,1}}{d\\xi} \\sum_{j=2,3} N_{j,1}(\\eta) \\mathbf{P}_{2j} + \\frac{dN_{3,1}}{d\\xi} \\sum_{j=2,3} N_{j,1}(\\eta) \\mathbf{P}_{3j} $$\n由于 $\\sum_j N_{j,1}(\\eta) = 1$（单位分解），表达式得以简化。更直接地，对于由单位父单元上的四个控制点定义的双线性片，其切向量是边向量的线性组合。\n在这里，我们可以重新评估具体的导数。因为在线性基函数的片定义内节点区间是均匀的，所以导数是常数。\n$$ \\frac{\\partial\\mathbf{x}}{\\partial\\xi} = \\frac{\\partial N_{2,1}}{\\partial\\xi} (N_{2,1}(\\eta) \\mathbf{P}_{22} + N_{3,1}(\\eta)\\mathbf{P}_{23}) + \\frac{\\partial N_{3,1}}{\\partial\\xi} (N_{2,1}(\\eta) \\mathbf{P}_{32} + N_{3,1}(\\eta)\\mathbf{P}_{33}) $$\n$$ = -2 (N_{2,1}(\\eta)\\mathbf{P}_{22} + N_{3,1}(\\eta)\\mathbf{P}_{23}) + 2 (N_{2,1}(\\eta)\\mathbf{P}_{32} + N_{3,1}(\\eta)\\mathbf{P}_{33}) = 2 (N_{2,1}(\\eta)(\\mathbf{P}_{32}-\\mathbf{P}_{22}) + N_{3,1}(\\eta)(\\mathbf{P}_{33}-\\mathbf{P}_{23})) $$\n$\\mathbf{P}_{32}-\\mathbf{P}_{22} = (4.1-2.1, 1-1.1) = (2, -0.1)$。\n$\\mathbf{P}_{33}-\\mathbf{P}_{23} = (4-2, 2-2.1) = (2, -0.1)$。\n$$ \\frac{\\partial\\mathbf{x}}{\\partial\\xi} = 2 (N_{2,1}(\\eta)(2, -0.1) + N_{3,1}(\\eta)(2, -0.1)) = 2 (N_{2,1}(\\eta)+N_{3,1}(\\eta))(2, -0.1) = 2(1)(2, -0.1) = (4,-0.2) $$\n$\\eta$ 方向同理：\n$$ \\frac{\\partial\\mathbf{x}}{\\partial\\eta} = N_{2,1}(\\xi)(\\frac{dN_{2,1}}{d\\eta}\\mathbf{P}_{22} + \\frac{dN_{3,1}}{d\\eta}\\mathbf{P}_{23}) + N_{3,1}(\\xi)(\\frac{dN_{2,1}}{d\\eta}\\mathbf{P}_{32} + \\frac{dN_{3,1}}{d\\eta}\\mathbf{P}_{33}) $$\n$\\mathbf{P}_{23}-\\mathbf{P}_{22} = (2-2.1, 2.1-1.1) = (-0.1, 1)$。\n$\\mathbf{P}_{33}-\\mathbf{P}_{32} = (4-4.1, 2-1) = (-0.1, 1)$。\n导数为 $\\frac{dN_{2,1}}{d\\eta}=-\\frac{10}{7}, \\frac{dN_{3,1}}{d\\eta}=\\frac{10}{7}$。\n$$ \\frac{\\partial\\mathbf{x}}{\\partial\\eta} = \\frac{10}{7}[N_{2,1}(\\xi)(\\mathbf{P}_{23}-\\mathbf{P}_{22}) + N_{3,1}(\\xi)(\\mathbf{P}_{33}-\\mathbf{P}_{32})] = \\frac{10}{7}[N_{2,1}(\\xi)(-0.1, 1) + N_{3,1}(\\xi)(-0.1, 1)] $$\n$$ = \\frac{10}{7}(N_{2,1}(\\xi)+N_{3,1}(\\xi))(-0.1, 1) = \\frac{10}{7}(1)(-0.1, 1) = (-\\frac{1}{7}, \\frac{10}{7}) $$\n雅可比矩阵 $\\mathbf{J}$ 在此单元上是常数，因为该几何体是一个双线性片：\n$$ \\mathbf{J} = \\begin{pmatrix} 4 & -\\frac{1}{7} \\\\ -0.2 & \\frac{10}{7} \\end{pmatrix} = \\begin{pmatrix} 4 & -\\frac{1}{7} \\\\ -\\frac{1}{5} & \\frac{10}{7} \\end{pmatrix} $$\n雅可比矩阵的行列式为：\n$$ \\det\\mathbf{J} = (4)\\left(\\frac{10}{7}\\right) - \\left(-\\frac{1}{7}\\right)\\left(-\\frac{1}{5}\\right) = \\frac{40}{7} - \\frac{1}{35} = \\frac{200-1}{35} = \\frac{199}{35} $$\n\n**5. 求积权重的计算**\n微分面积元从父空间变换到物理空间为 $d\\mathbf{x} = \\det\\mathbf{J} \\,d\\xi d\\eta$。我们还必须考虑从父单元 $(r,s)$ 到参数单元 $(\\xi,\\eta)$ 的映射：$d\\xi d\\eta = \\det\\mathbf{J}_{\\text{param}} \\,dr ds$。\n从父域到参数域映射的雅可比矩阵为：\n$$ \\mathbf{J}_{\\text{param}} = \\begin{pmatrix} \\frac{\\partial\\xi}{\\partial r} & 0 \\\\ 0 & \\frac{\\partial\\eta}{\\partial s} \\end{pmatrix} = \\begin{pmatrix} \\frac{1-0.5}{2} & 0 \\\\ 0 & \\frac{1-0.3}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4} & 0 \\\\ 0 & \\frac{7}{20} \\end{pmatrix} $$\n$$ \\det\\mathbf{J}_{\\text{param}} = \\left(\\frac{1}{4}\\right)\\left(\\frac{7}{20}\\right) = \\frac{7}{80} $$\n一个 Gauss 点的总求积权重 $W$ 是父空间权重与总雅可比行列式的乘积：\n$$ W = w_{r} w_{s} \\cdot \\det\\mathbf{J}_{\\text{param}} \\cdot \\det\\mathbf{J} $$\n给定 $w_{r}=1$ 和 $w_{s}=1$：\n$$ W = (1)(1) \\cdot \\left(\\frac{7}{80}\\right) \\cdot \\left(\\frac{199}{35}\\right) = \\frac{7 \\cdot 199}{80 \\cdot 35} = \\frac{199}{80 \\cdot 5} = \\frac{199}{400} $$\n控制点的单位是米，因此得到的代表面积元的求积权重单位是平方米。", "answer": "$$\n\\boxed{\\frac{199}{400}}\n$$", "id": "2651381"}, {"introduction": "由于样条基函数通常不具备插值性，等几何分析（IGA）与传统有限元分析（FEA）在处理约束方面存在一个关键区别。本练习旨在挑战你批判性地思考施加狄利克雷（Dirichlet）边界条件的不同方法，这是分析中一项常见而关键的任务。它对比了在插值边界上的直接施加法与在内部约束上使用如Nitsche法等弱施加法的不同之处。[@problem_id:2651372]", "problem": "考虑一根线性弹性杆，其中心线由一个非均匀有理B样条（NURBS）曲线精确描述，参数坐标为 $\\xi \\in [0,1]$。物理坐标映射为 $x(\\xi)=\\sum_{i=1}^{N} R_i(\\xi) X_i$，其中 $R_i(\\xi)$ 是由开放节点矢量和严格正权重构建的p次NURBS基函数，而 $X_i$ 是控制点坐标。轴向位移场由 $u_h(\\xi)=\\sum_{i=1}^{N} R_i(\\xi) d_i$ 近似，其中 $d_i$ 是未知的控制变量。假设一个标准的小应变、线性、一维弹性静力学模型，其杨氏模量为 $E$，横截面积为 $A$，体力为 $f(x)$，边界数据 $u=g$ 施加在两端 $\\xi=0$ 和 $\\xi=1$ 或内部狄利克雷边界 $\\xi=\\xi_0 \\in (0,1)$ 上。从强形式 $(EA\\,u'(x))' + f(x)=0$ 及其通过虚功原理和分部积分得到的弱形式出发，分析以下两种施加策略的后果：(i) 在开放端点处（端点基函数是插值的）进行控制点消除，以及 (ii) 在基函数非插值的内部狄利克雷边界上使用Nitsche方法进行弱施加。特别地，论述所施加数据的精确性、所得线性系统的对称性和定性、条件数、是否需要额外未知量，以及权重在端点插值性质中的作用。\n\n选择所有正确的陈述。\n\nA. 对于在NURBS曲线上采用开放节点矢量的等几何离散，通过控制点消除在两端施加狄利克雷数据，可以在这些端点精确地施加边界值，减少未知量的数量，并保持刚度矩阵的对称性和典型条件数。\n\nB. Nitsche方法用于在曲线的内部参数位置施加狄利克雷数据，它通过对称一致性项以及一个稳定项来增广双线性形式，其中稳定项的系数 $\\gamma$ 必须与 $c\\,EA/h$（对于某个正常数 $c$ 和代表性的局部尺寸 $h$）成比例，以确保矫顽性；该方法不引入额外的未知量。\n\nC. 在端点处进行控制点消除等效于使用一个非常大的罚参数的罚函数法，因此随着罚参数的增加，会显著恶化条件数。\n\nD. Nitsche方法需要在内部边界上引入拉格朗日乘子，这会增加未知量的数量并使代数系统成为不定的。\n\nE. NURBS基函数的端点插值性质仅在与端点控制点相关的权重为1时才成立；否则，控制点消除不会产生精确的端点值。\n\nF. 由于NURBS基函数在远离开放端点处通常是非插值的，因此通常无法通过消除单个控制点来在内部参数位置精确施加点态狄利克雷数据；需要采用合适的投影或弱施加方法（如Nitsche方法）来实现最优收敛，而又不过度约束系统。", "solution": "问题陈述经分析有效。它描述了一维线性弹性静力学等几何分析中的一个标准问题，并要求对两种施加狄利克雷边界条件的常用方法进行概念性评估。该设定在科学上是合理的、适定的，并使用了精确、客观的术语。我们开始进行解答。\n\n一维弹性静力学的基本方程为 $(EA u'(x))' + f(x) = 0$，其中 $u(x)$ 是轴向位移， $E$ 是杨氏模量， $A$ 是横截面积， $f(x)$ 是分布体力。物理坐标 $x$ 通过NURBS映射 $x(\\xi) = \\sum_{i=1}^{N} R_i(\\xi) X_i$ 由 $\\xi \\in [0,1]$ 参数化。位移场在与几何相同的NURBS空间中近似为 $u_h(\\xi) = \\sum_{i=1}^{N} R_i(\\xi) d_i$，其中 $d_i$ 是未知的控制变量。NURBS基函数定义为 $R_i(\\xi) = \\frac{N_i(\\xi) w_i}{W(\\xi)}$，其中 $N_i(\\xi)$ 是p次B样条基函数， $w_i > 0$ 是权重， $W(\\xi) = \\sum_{j=1}^{N} N_j(\\xi) w_j$ 是权函数。\n\n问题指定了一个开放节点矢量。对于形如 $\\Xi = \\{\\underbrace{0, \\dots, 0}_{p+1}, \\xi_{p+2}, \\dots, \\xi_{m-p-1}, \\underbrace{1, \\dots, 1}_{p+1}\\}$ 的节点矢量，B样条基函数在参数域的端点是插值的。具体来说，当 $i>1$ 时，$N_1(0) = 1$ 且 $N_i(0) = 0$。类似地，当 $i<N$ 时，$N_N(1) = 1$ 且 $N_i(1)=0$。此性质可推广到NURBS基函数，无论权重如何。在 $\\xi=0$ 处，权函数为 $W(0) = \\sum_{j=1}^{N} N_j(0) w_j = N_1(0) w_1 = w_1$。因此，第一个NURBS基函数为 $R_1(0) = \\frac{N_1(0) w_1}{W(0)} = \\frac{1 \\cdot w_1}{w_1} = 1$。对于任何 $i>1$，$R_i(0) = \\frac{N_i(0) w_i}{W(0)} = \\frac{0 \\cdot w_i}{w_1} = 0$。因此，在域的起点处的近似位移为 $u_h(0) = \\sum_{i=1}^{N} R_i(0) d_i = R_1(0) d_1 = d_1$。类似的论证表明 $u_h(1) = d_N$。这就是端点插值性质。在远离端点的位置，对于 $\\xi \\in (0,1)$，基函数通常不是插值的。\n\n现在我们评估每个陈述。\n\n**A. 对于在NURBS曲线上采用开放节点矢量的等几何离散，通过控制点消除在两端施加狄利克雷数据，可以在这些端点精确地施加边界值，减少未知量的数量，并保持刚度矩阵的对称性和典型条件数。**\n\n如上所述，对于开放节点矢量，$u_h(0) = d_1$ 和 $u_h(1) = d_N$。为了施加狄利克雷条件 $u(0)=g_0$ 和 $u(1)=g_1$，可将控制变量设为 $d_1 = g_0$ 和 $d_N = g_1$。这直接在离散解上施加了条件，因此近似解 $u_h$ 精确满足边界值。未知量的数量从 $N$ 减少到 $N-2$，因为 $d_1$ 和 $d_N$ 现在已知。这种强施加的标准过程涉及对矩阵系统进行分区并修改载荷向量，这会保留剩余刚度矩阵的对称性和正定性。缩减后系统的条件数不会受到病态影响，并与原始无约束系统相当。该陈述准确描述了在插值节点上强施加狄利克雷边界条件的标准方法。\n\n结论：**正确**。\n\n**B. Nitsche方法用于在曲线的内部参数位置施加狄利克雷数据，它通过对称一致性项以及一个稳定项来增广双线性形式，其中稳定项的系数 $\\gamma$ 必须与 $c\\,EA/h$（对于某个正常数 $c$ 和代表性的局部尺寸 $h$）成比例，以确保矫顽性；该方法不引入额外的未知量。**\n\nNitsche方法是一种弱施加技术。它修改了标准弱形式 $a(u,v) = \\int EA u' v' dx$。对于内部点 $x_0$ 处的约束 $u=g$，Nitsche公式向弱形式中添加了项。一种常见的对称公式是：求 $u_h$ 使得对于所有 $v_h$ 都满足：\n$$a(u_h, v_h) - [EA u'_h v_h]_{x_0} - [EA v'_h u_h]_{x_0} + \\gamma [u_h v_h]_{x_0} = l(v_h) - [EA v'_h g]_{x_0} + \\gamma [g v_h]_{x_0}$$\n左侧添加的项是：$-[EA u'_h v_h]_{x_0}$（一致性项），$-[EA v'_h u_h]_{x_0}$（对称化项），以及 $+\\gamma [u_h v_h]_{x_0}$（稳定项）。“对称一致性项”这一措辞可以理解为指一致性项和对称性项的组合。稳定参数 $\\gamma$ 必须足够大，以确保所得双线性形式的矫顽性。对于像 $(EA(\\cdot)')'$ 这样的二阶椭圆算子，基于逆不等式的分析表明，$\\gamma$ 必须与问题参数和局部网格尺寸 $h$ 成比例，即 $\\gamma \\sim EA/h$。该方法的一个关键优点是它作用于原始变量集 $\\{d_i\\}$，而不引入新的未知量。\n\n结论：**正确**。\n\n**C. 在端点处进行控制点消除等效于使用一个非常大的罚参数的罚函数法，因此随着罚参数的增加，会显著恶化条件数。**\n\n该陈述根本上是错误的。控制点消除是一种强（或本质）施加方法。它在代数上从系统中移除自由度，从而得到一个更小的系统矩阵。罚函数法是一种弱施加技术，它在刚度矩阵中与约束自由度相对应的对角线项上添加大的数值。所得矩阵的条件数随罚参数的增大而增长，导致病态。虽然当罚参数趋于无穷大时，罚函数法的解会收敛到强施加问题的解，但这两种方法在代数上是不同的，并且对矩阵条件数有相反的影响。控制点消除在数值上是稳定的，并且不会以这种方式恶化条件数。\n\n结论：**错误**。\n\n**D. Nitsche方法需要在内部边界上引入拉格朗日乘子，这会增加未知量的数量并使代数系统成为不定的。**\n\n该陈述错误地描述了拉格朗日乘子法，并将其性质归于Nitsche方法。是拉格朗日乘子法引入了额外的未知量（乘子）来施加约束，从而导致一个更大的方程组。该系统具有鞍点结构，因此是不定的。如在选项B的分析中所解释，Nitsche方法是一种类罚函数法，仅使用主变量进行运算，不增加未知量的数量，并且其构造可以产生一个对称正定的系统矩阵（前提是稳定参数足够大）。\n\n结论：**错误**。\n\n**E. NURBS基函数的端点插值性质仅在与端点控制点相关的权重为1时才成立；否则，控制点消除不会产生精确的端点值。**\n\n该陈述是错误的。如在初步分析中所示，具有开放节点矢量的NURBS的端点插值性质与权重的具体值无关，只要它们是严格正的。对域起点处的第一个基函数的计算，$R_1(0) = \\frac{N_1(0) w_1}{\\sum_j N_j(0) w_j} = \\frac{1 \\cdot w_1}{w_1} = 1$，表明权重 $w_1$ 被消掉了。因此，对于任何正权重 $w_1$，$u_h(0)=d_1$。只有当希望NURBS曲线变为B样条曲线时，才要求权重为1，但对于端点插值性质本身而言，这不是必需的。\n\n结论：**错误**。\n\n**F. 由于NURBS基函数在远离开放端点处通常是非插值的，因此通常无法通过消除单个控制点来在内部参数位置精确施加点态狄利克雷数据；需要采用合适的投影或弱施加方法（如Nitsche方法）来实现最优收敛，而又不过度约束系统。**\n\n该陈述准确地描述了IGA中的一个核心挑战及其解决方案。在内部位置 $\\xi_0 \\in (0,1)$，多个基函数 $R_i(\\xi_0)$ 是非零的。约束 $u_h(\\xi_0)=g$ 呈 $\\sum_{i} R_i(\\xi_0)d_i = g$ 的形式，这是一个涉及多个控制变量的线性方程。试图通过将单个控制变量 $d_k$ 设置为某个值来施加此约束是不正确的，并且不能满足该约束。这是因为 $R_k(\\xi_0)$ 通常不等于1。修改系统以强施加这种多点约束是可能的，但很繁琐，并且可能破坏矩阵的理想结构。为避免此类问题并保持该方法的最优收敛性质，必须采用更精细的方法。弱施加方法（如Nitsche方法或罚函数法）以及基于投影的技术是在非插值基上施加此类约束的标准且正确的程序。这些方法旨在以变分一致的方式施加约束，不会锁定解或降低收敛性。\n\n结论：**正确**。", "answer": "$$\\boxed{ABF}$$", "id": "2651372"}]}