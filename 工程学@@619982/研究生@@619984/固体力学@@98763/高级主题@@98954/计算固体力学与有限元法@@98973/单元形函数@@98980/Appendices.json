{"hands_on_practices": [{"introduction": "这个首个练习旨在从基本原理出发构建形函数。我们将从一个简单的一维二次单元开始，利用节点插值的基本定义（克罗内克-德尔塔性质 $N_i(\\xi_j) = \\delta_{ij}$）来推导其显式多项式表达式。这项实践将巩固多项式完备性和单位分解这两个核心原则，它们是任何有效有限元的基石。[@problem_id:2635745]", "problem": "在有限元方法（FEM）中，使用一维杆单元来近似轴向位移场。考虑一个母（等参）坐标 $\\xi \\in [-1,1]$，其上分布有三个节点，位置分别为 $\\xi_1=-1$、$\\xi_2=0$ 和 $\\xi_3=1$。设近似位移使用三个二次拉格朗日形函数 $N_1(\\xi)$、$N_2(\\xi)$ 和 $N_3(\\xi)$ 进行插值，每个形函数都是次数最多为2的多项式，且满足克罗内克-德尔塔（Kronecker-delta）插值条件 $N_i(\\xi_j)=\\delta_{ij}$，其中 $i,j\\in\\{1,2,3\\}$。\n\n从节点插值和多项式完备性的核心定义出发，通过施加节点条件和二次多项式要求，推导 $N_1(\\xi)$、$N_2(\\xi)$ 和 $N_3(\\xi)$ 的显式表达式。然后，验证这种插值应具备的两个基本性质：\n- 高达2次的多项式再生性：对于任意二次多项式位移场 $u(\\xi)=a_0+a_1\\,\\xi+a_2\\,\\xi^2$，证明插值函数 $u^h(\\xi)=\\sum_{i=1}^3 N_i(\\xi)\\,u(\\xi_i)$ 对于所有 $\\xi\\in[-1,1]$ 恒等于 $u(\\xi)$。\n- 单位分解性：证明对于所有 $\\xi\\in[-1,1]$，$\\sum_{i=1}^3 N_i(\\xi)=1$。\n\n将你的最终答案以单行向量 $\\left[N_1(\\xi)\\;N_2(\\xi)\\;N_3(\\xi)\\right]$ 的形式给出，其中包含关于 $\\xi$ 的封闭形式解析表达式。无需数值取整。最终答案中不要包含单位。", "solution": "任务是为一个一维三节点母单元推导二次拉格朗日形函数，并验证它们的两个基本性质。该单元定义在等参坐标域 $\\xi \\in [-1, 1]$ 上，节点位于 $\\xi_1 = -1$、$\\xi_2 = 0$ 和 $\\xi_3 = 1$。\n\n形函数用 $N_i(\\xi)$ 表示（其中 $i \\in \\{1, 2, 3\\}$），是次数最多为2的多项式。它们由在节点位置处的克罗内克-德尔塔性质定义：\n$$ N_i(\\xi_j) = \\delta_{ij} = \\begin{cases} 1 & \\text{if } i=j \\\\ 0 & \\text{if } i \\neq j \\end{cases} $$\n我们将通过假设一个通用的二次形式 $N(\\xi) = a\\xi^2 + b\\xi + c$，并通过施加这些节点条件来求解系数 $a$、$b$ 和 $c$，从而推导每个函数。\n\n$N_1(\\xi)$ 的推导：\n$N_1(\\xi)$ 的条件是 $N_1(\\xi_1) = 1$，$N_1(\\xi_2) = 0$ 和 $N_1(\\xi_3) = 0$。\n设 $N_1(\\xi) = a_1\\xi^2 + b_1\\xi + c_1$。\n1.  在节点 $\\xi_2=0$ 处：$N_1(0) = a_1(0)^2 + b_1(0) + c_1 = c_1 = 0$。\n2.  在节点 $\\xi_3=1$ 处：$N_1(1) = a_1(1)^2 + b_1(1) + c_1 = a_1 + b_1 + 0 = 0$。这意味着 $b_1 = -a_1$。\n3.  在节点 $\\xi_1=-1$ 处：$N_1(-1) = a_1(-1)^2 + b_1(-1) + c_1 = a_1 - b_1 + 0 = 1$。\n将 $b_1 = -a_1$ 代入第三个方程得到 $a_1 - (-a_1) = 2a_1 = 1$，得出 $a_1 = \\frac{1}{2}$。因此，$b_1 = -\\frac{1}{2}$。\n因此，$N_1(\\xi)$ 的表达式为：\n$$ N_1(\\xi) = \\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi = \\frac{1}{2}\\xi(\\xi-1) $$\n\n$N_2(\\xi)$ 的推导：\n$N_2(\\xi)$ 的条件是 $N_2(\\xi_1) = 0$，$N_2(\\xi_2) = 1$ 和 $N_2(\\xi_3) = 0$。\n设 $N_2(\\xi) = a_2\\xi^2 + b_2\\xi + c_2$。\n1.  在节点 $\\xi_2=0$ 处：$N_2(0) = a_2(0)^2 + b_2(0) + c_2 = c_2 = 1$。\n2.  在节点 $\\xi_3=1$ 处：$N_2(1) = a_2(1)^2 + b_2(1) + c_2 = a_2 + b_2 + 1 = 0$。\n3.  在节点 $\\xi_1=-1$ 处：$N_2(-1) = a_2(-1)^2 + b_2(-1) + c_2 = a_2 - b_2 + 1 = 0$。\n我们得到一个关于 $a_2$ 和 $b_2$ 的二元一次方程组：\n$$ a_2 + b_2 = -1 $$\n$$ a_2 - b_2 = -1 $$\n将这两个方程相加得到 $2a_2 = -2$，所以 $a_2 = -1$。将此结果代入第一个方程得到 $-1 + b_2 = -1$，所以 $b_2 = 0$。\n因此，$N_2(\\xi)$ 的表达式为：\n$$ N_2(\\xi) = (-1)\\xi^2 + (0)\\xi + 1 = 1 - \\xi^2 $$\n\n$N_3(\\xi)$ 的推导：\n$N_3(\\xi)$ 的条件是 $N_3(\\xi_1) = 0$，$N_3(\\xi_2) = 0$ 和 $N_3(\\xi_3) = 1$。\n设 $N_3(\\xi) = a_3\\xi^2 + b_3\\xi + c_3$。\n1.  在节点 $\\xi_2=0$ 处：$N_3(0) = a_3(0)^2 + b_3(0) + c_3 = c_3 = 0$。\n2.  在节点 $\\xi_1=-1$ 处：$N_3(-1) = a_3(-1)^2 + b_3(-1) + c_3 = a_3 - b_3 + 0 = 0$。这意味着 $b_3 = a_3$。\n3.  在节点 $\\xi_3=1$ 处：$N_3(1) = a_3(1)^2 + b_3(1) + c_3 = a_3 + b_3 + 0 = 1$。\n将 $b_3 = a_3$ 代入第三个方程得到 $a_3 + a_3 = 2a_3 = 1$，得出 $a_3 = \\frac{1}{2}$。因此，$b_3 = \\frac{1}{2}$。\n因此，$N_3(\\xi)$ 的表达式为：\n$$ N_3(\\xi) = \\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi = \\frac{1}{2}\\xi(\\xi+1) $$\n\n现在，我们验证所要求的两个性质。\n\n单位分解性的验证：\n我们必须证明对于所有 $\\xi \\in [-1, 1]$，$\\sum_{i=1}^3 N_i(\\xi) = 1$。\n$$ \\sum_{i=1}^3 N_i(\\xi) = N_1(\\xi) + N_2(\\xi) + N_3(\\xi) $$\n$$ = \\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) + (1 - \\xi^2) + \\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right) $$\n合并 $\\xi$ 的同次幂项：\n$$ = \\left(\\frac{1}{2} - 1 + \\frac{1}{2}\\right)\\xi^2 + \\left(-\\frac{1}{2} + \\frac{1}{2}\\right)\\xi + 1 $$\n$$ = (0)\\xi^2 + (0)\\xi + 1 = 1 $$\n单位分解性对于所有 $\\xi$ 恒成立。\n\n多项式再生性的验证：\n我们必须证明对于任意二次多项式 $u(\\xi) = a_0 + a_1\\xi + a_2\\xi^2$，其插值函数 $u^h(\\xi) = \\sum_{i=1}^3 N_i(\\xi)u(\\xi_i)$ 与 $u(\\xi)$ 恒等。\n首先，计算 $u(\\xi)$ 在节点处的值：\n$u(\\xi_1) = u(-1) = a_0 - a_1 + a_2$\n$u(\\xi_2) = u(0) = a_0$\n$u(\\xi_3) = u(1) = a_0 + a_1 + a_2$\n现在，构建插值函数 $u^h(\\xi)$：\n$$ u^h(\\xi) = N_1(\\xi)(a_0 - a_1 + a_2) + N_2(\\xi)(a_0) + N_3(\\xi)(a_0 + a_1 + a_2) $$\n通过提取系数 $a_0$、$a_1$ 和 $a_2$ 来重新整理表达式：\n$$ u^h(\\xi) = a_0 [N_1(\\xi)+N_2(\\xi)+N_3(\\xi)] + a_1 [-N_1(\\xi)+N_3(\\xi)] + a_2 [N_1(\\xi)+N_3(\\xi)] $$\n让我们分析每个 $a_k$ 的系数：\n$a_0$ 的系数是 $\\sum_{i=1}^3 N_i(\\xi)$，我们已经证明了它等于 $1$。\n$a_1$ 的系数是 $-N_1(\\xi)+N_3(\\xi)$：\n$$ -N_1(\\xi)+N_3(\\xi) = -\\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) + \\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right) = -\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi + \\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi = \\xi $$\n$a_2$ 的系数是 $N_1(\\xi)+N_3(\\xi)$：\n$$ N_1(\\xi)+N_3(\\xi) = \\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) + \\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right) = \\xi^2 $$\n将这些结果代回 $u^h(\\xi)$ 的表达式中：\n$$ u^h(\\xi) = a_0(1) + a_1(\\xi) + a_2(\\xi^2) = a_0 + a_1\\xi + a_2\\xi^2 $$\n这与 $u(\\xi)$ 恒等。再生任意二次多项式场的能力得到证实。这是基函数 $\\{N_i(\\xi)\\}$ 能够表示单项式 $\\{1, \\xi, \\xi^2\\}$ 的直接结果，而我们刚刚已经证明了这一点。\n\n推导和验证均已完成。最终答案是形函数的显式表达式集合。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{1}{2}\\xi(\\xi-1) & 1-\\xi^2 & \\frac{1}{2}\\xi(\\xi+1) \\end{pmatrix} } $$", "id": "2635745"}, {"introduction": "构建完形函数后，下一步自然是将其用于工程分析。本练习将演示如何推导应变-位移矩阵（通常称为 $\\mathbf{B}$ 矩阵），这是从节点位移计算应变的关键。你将看到形函数的空间导数如何将离散的节点自由度直接转化为单元内的连续应变场。[@problem_id:2635683]", "problem": "考虑一个二维、小变形、平面应变设定下的等参四节点双线性四边形(Q4)有限元。设单元内的位移场通过其节点值，使用标量形函数 $N_{i}(x,y)$，$i=1,2,3,4$，进行插值，表示为\n$u(x,y) = \\sum_{i=1}^{4} N_{i}(x,y)\\,u_{i}$ 和 $v(x,y) = \\sum_{i=1}^{4} N_{i}(x,y)\\,v_{i}$，\n其中，$u$ 和 $v$ 分别是 $x$ 和 $y$ 方向上的笛卡尔位移分量，而 $u_{i}$ 和 $v_{i}$ 是节点 $i$ 处的节点位移自由度。采用小应变运动学中的无穷小应变张量定义，并使用平面应变下的工程应变向量，\n$\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\gamma_{xy} \\end{pmatrix}$，\n其中 $\\varepsilon_{xx} = \\partial u/\\partial x$，$\\varepsilon_{yy} = \\partial v/\\partial y$，且 $\\gamma_{xy} = \\partial u/\\partial y + \\partial v/\\partial x$。设单元节点位移向量排列为\n$\\mathbf{d} = \\begin{pmatrix} u_{1} & v_{1} & u_{2} & v_{2} & u_{3} & v_{3} & u_{4} & v_{4} \\end{pmatrix}^{\\mathsf{T}}$。\n仅从这些定义出发，推导应变-位移矩阵 $\\mathbf{B}$，使得 $\\boldsymbol{\\varepsilon} = \\mathbf{B}\\,\\mathbf{d}$，并将 $\\mathbf{B}$ 完全用空间导数 $\\partial N_{i}/\\partial x$ 和 $\\partial N_{i}/\\partial y$（对于 $i=1,2,3,4$）表示。你的最终答案必须是 $\\mathbf{B}$ 的一个单一的封闭形式解析表达式。不要计算任何数值。不要引入任何本构关系。只需提供最终的 $\\mathbf{B}$ 矩阵表达式；最终答案中不应出现任何中间步骤。最终答案不需要单位。", "solution": "推导从二维无穷小应变的基本运动学开始。在小变形理论中，无穷小应变张量 $\\boldsymbol{\\epsilon}$ 是位移矢量场 $\\mathbf{u} = (u,v)^{\\mathsf{T}}$ 的对称梯度，具体为\n$$\n\\epsilon_{xx} = \\frac{\\partial u}{\\partial x}, \\quad \\epsilon_{yy} = \\frac{\\partial v}{\\partial y}, \\quad \\epsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}\\right).\n$$\n工程剪应变定义为 $ \\gamma_{xy} = 2\\,\\epsilon_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}$。因此，平面问题的工程应变向量为\n$$\n\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\gamma_{xy} \\end{pmatrix}\n= \\begin{pmatrix} \\dfrac{\\partial u}{\\partial x} \\\\ \\dfrac{\\partial v}{\\partial y} \\\\ \\dfrac{\\partial u}{\\partial y} + \\dfrac{\\partial v}{\\partial x} \\end{pmatrix}.\n$$\n\n接下来，我们使用 Q4 单元上位移场的有限元插值。使用标量形函数 $N_{i}(x,y)$ 和节点位移分量 $u_{i}$ 和 $v_{i}$（对于 $i=1,2,3,4$），位移分量被插值为\n$$\nu(x,y) = \\sum_{i=1}^{4} N_{i}(x,y)\\,u_{i}, \\qquad\nv(x,y) = \\sum_{i=1}^{4} N_{i}(x,y)\\,v_{i}.\n$$\n求空间导数得出\n$$\n\\frac{\\partial u}{\\partial x} = \\sum_{i=1}^{4} \\frac{\\partial N_{i}}{\\partial x}\\,u_{i}, \\qquad\n\\frac{\\partial v}{\\partial y} = \\sum_{i=1}^{4} \\frac{\\partial N_{i}}{\\partial y}\\,v_{i},\n$$\n以及\n$$\n\\frac{\\partial u}{\\partial y} = \\sum_{i=1}^{4} \\frac{\\partial N_{i}}{\\partial y}\\,u_{i}, \\qquad\n\\frac{\\partial v}{\\partial x} = \\sum_{i=1}^{4} \\frac{\\partial N_{i}}{\\partial x}\\,v_{i}.\n$$\n将这些代入工程应变分量，我们得到\n$$\n\\varepsilon_{xx} = \\sum_{i=1}^{4} \\frac{\\partial N_{i}}{\\partial x}\\,u_{i}, \\qquad\n\\varepsilon_{yy} = \\sum_{i=1}^{4} \\frac{\\partial N_{i}}{\\partial y}\\,v_{i}, \\qquad\n\\gamma_{xy} = \\sum_{i=1}^{4} \\left( \\frac{\\partial N_{i}}{\\partial y}\\,u_{i} + \\frac{\\partial N_{i}}{\\partial x}\\,v_{i} \\right).\n$$\n\n现在我们根据排列如下的节点位移向量来汇总各项\n$$\n\\mathbf{d} = \\begin{pmatrix} u_{1} & v_{1} & u_{2} & v_{2} & u_{3} & v_{3} & u_{4} & v_{4} \\end{pmatrix}^{\\mathsf{T}}.\n$$\n映射关系 $\\boldsymbol{\\varepsilon} = \\mathbf{B}\\,\\mathbf{d}$ 确定了应变-位移矩阵 $\\mathbf{B}$。从上述表达式中，$(u_{i}, v_{i})$ 对各应变分量的贡献如下：\n- 对 $\\varepsilon_{xx}$：$u_{i}$ 的系数是 $\\dfrac{\\partial N_{i}}{\\partial x}$，$v_{i}$ 的系数是 $0$。\n- 对 $\\varepsilon_{yy}$：$u_{i}$ 的系数是 $0$，$v_{i}$ 的系数是 $\\dfrac{\\partial N_{i}}{\\partial y}$。\n- 对 $\\gamma_{xy}$：$u_{i}$ 的系数是 $\\dfrac{\\partial N_{i}}{\\partial y}$，$v_{i}$ 的系数是 $\\dfrac{\\partial N_{i}}{\\partial x}$。\n\n按照指定的自由度顺序，将这四个节点的系数组合起来，就得到了 $3 \\times 8$ 矩阵\n$$\n\\mathbf{B} =\n\\begin{pmatrix}\n\\dfrac{\\partial N_{1}}{\\partial x} & 0 & \\dfrac{\\partial N_{2}}{\\partial x} & 0 & \\dfrac{\\partial N_{3}}{\\partial x} & 0 & \\dfrac{\\partial N_{4}}{\\partial x} & 0 \\\\\n0 & \\dfrac{\\partial N_{1}}{\\partial y} & 0 & \\dfrac{\\partial N_{2}}{\\partial y} & 0 & \\dfrac{\\partial N_{3}}{\\partial y} & 0 & \\dfrac{\\partial N_{4}}{\\partial y} \\\\\n\\dfrac{\\partial N_{1}}{\\partial y} & \\dfrac{\\partial N_{1}}{\\partial x} & \\dfrac{\\partial N_{2}}{\\partial y} & \\dfrac{\\partial N_{2}}{\\partial x} & \\dfrac{\\partial N_{3}}{\\partial y} & \\dfrac{\\partial N_{3}}{\\partial x} & \\dfrac{\\partial N_{4}}{\\partial y} & \\dfrac{\\partial N_{4}}{\\partial x}\n\\end{pmatrix}.\n$$\n这个 $\\mathbf{B}$ 矩阵完全由物理导数 $\\partial N_{i}/\\partial x$ 和 $\\partial N_{i}/\\partial y$ 表示。在等参格式中，这些物理导数是通过映射的雅可比矩阵从母坐标导数中获得的；然而，这里不需要这些细节，因为所要求的结果已明确要求用 $\\partial N_{i}/\\partial x$ 和 $\\partial N_{i}/\\partial y$ 来表示。同样的运动学矩阵 $\\mathbf{B}$ 同时适用于平面应力和平面应变；这两种情况的区别在于本构矩阵，而不在于 $\\mathbf{B}$。", "answer": "$$\\boxed{\\begin{pmatrix}\n\\dfrac{\\partial N_{1}}{\\partial x} & 0 & \\dfrac{\\partial N_{2}}{\\partial x} & 0 & \\dfrac{\\partial N_{3}}{\\partial x} & 0 & \\dfrac{\\partial N_{4}}{\\partial x} & 0 \\\\\n0 & \\dfrac{\\partial N_{1}}{\\partial y} & 0 & \\dfrac{\\partial N_{2}}{\\partial y} & 0 & \\dfrac{\\partial N_{3}}{\\partial y} & 0 & \\dfrac{\\partial N_{4}}{\\partial y} \\\\\n\\dfrac{\\partial N_{1}}{\\partial y} & \\dfrac{\\partial N_{1}}{\\partial x} & \\dfrac{\\partial N_{2}}{\\partial y} & \\dfrac{\\partial N_{2}}{\\partial x} & \\dfrac{\\partial N_{3}}{\\partial y} & \\dfrac{\\partial N_{3}}{\\partial x} & \\dfrac{\\partial N_{4}}{\\partial y} & \\dfrac{\\partial N_{4}}{\\partial x}\n\\end{pmatrix}}$$", "id": "2635683"}]}