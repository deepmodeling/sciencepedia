{"hands_on_practices": [{"introduction": "第一个练习将抽象的牛顿-拉弗森格式置于物理背景中。从一个简单超弹性杆的势能出发，你将分析推导出迭代的核心组成部分——残差和切向刚度。[@problem_id:2664990] 这项实践对于建立数学算法如何表示物理平衡和材料响应的直观理解至关重要。", "problem": "一根长度为 $L$、横截面积恒为 $A$ 的均质棱柱杆发生小应变一维轴向变形。其一端 $x=0$ 处被固定，另一自由端 $x=L$ 处施加了拉力 $F$。该材料是超弹性的，其应变能密度为 $W(\\varepsilon)=\\tfrac{1}{2}E\\,\\varepsilon^{2}+\\tfrac{\\alpha}{4}\\,\\varepsilon^{4}$，其中 $E>0$ 是杨氏模量，$\\alpha>0$ 是一个材料非线性参数。采用单参数运动学近似 $u(x)=\\dfrac{u}{L}\\,x$，其中 $u$ 是 $x=L$ 处的轴向位移，因此轴向应变为均匀的，即 $\\varepsilon=\\dfrac{u}{L}$。总势能为\n$$\n\\Pi(u)=\\int_{0}^{L}A\\,W\\!\\left(\\varepsilon\\right)\\,\\mathrm{d}x - F\\,u.\n$$\n使用驻定总势能原理和用于非线性问题的牛顿-拉夫逊迭代格式，推导与未知数 $u$ 相关的标量残差和切线刚度，并由此获得在通用迭代步 $k$ 处的牛顿步长 $\\Delta u_{k}$ 的闭式表达式，该表达式仅用 $A$、$L$、$E$、$\\alpha$、$F$ 和 $u_{k}$ 表示。请将最终结果表示为 $\\Delta u_{k}$ 的单个解析表达式。不要代入任何数值，最终表达式中也不要包含单位。", "solution": "所述问题有效、自洽且科学上成立。这是变分原理和数值方法在非线性固体力学中的一个标准应用。我们开始进行推导。\n\n系统的总势能 $\\Pi$ 如下所示\n$$ \\Pi(u)=\\int_{0}^{L}A\\,W\\!\\left(\\varepsilon\\right)\\,\\mathrm{d}x - F\\,u $$\n应变能密度 $W$ 取决于轴向应变 $\\varepsilon$。问题提供了一个运动学近似，将整个杆的应变简化为均匀应变：\n$$ \\varepsilon = \\frac{u}{L} $$\n其中 $u$ 是自由端 $x=L$ 处的位移。\n将这个均匀应变代入给定的应变能密度表达式 $W(\\varepsilon)=\\tfrac{1}{2}E\\,\\varepsilon^{2}+\\tfrac{\\alpha}{4}\\,\\varepsilon^{4}$，我们得到：\n$$ W\\left(\\frac{u}{L}\\right) = \\frac{1}{2}E\\left(\\frac{u}{L}\\right)^{2} + \\frac{\\alpha}{4}\\left(\\frac{u}{L}\\right)^{4} = \\frac{E u^{2}}{2L^{2}} + \\frac{\\alpha u^{4}}{4L^{4}} $$\n由于总势能表达式中的被积函数现在相对于空间坐标 $x$ 是常数，积分变得很简单：\n$$ \\int_{0}^{L}A\\,W(\\varepsilon)\\,\\mathrm{d}x = A L W(\\varepsilon) $$\n将以 $u$ 表示的 $W$ 的表达式代入，总势能成为单一未知位移 $u$ 的函数：\n$$ \\Pi(u) = A L \\left( \\frac{E u^{2}}{2L^{2}} + \\frac{\\alpha u^{4}}{4L^{4}} \\right) - F u $$\n简化此表达式可得：\n$$ \\Pi(u) = \\frac{A E}{2L} u^{2} + \\frac{A \\alpha}{4L^{3}} u^{4} - F u $$\n驻定总势能原理指出，为使系统处于平衡状态，势能相对于广义坐标 $u$ 的一阶导数必须为零。该导数定义了标量残差函数 $R(u)$：\n$$ R(u) = \\frac{\\mathrm{d}\\Pi}{\\mathrm{d}u} = \\frac{\\mathrm{d}}{\\mathrm{d}u}\\left(\\frac{A E}{2L} u^{2} + \\frac{A \\alpha}{4L^{3}} u^{4} - F u\\right) $$\n进行微分运算可得：\n$$ R(u) = \\frac{A E}{L} u + \\frac{A \\alpha}{L^{3}} u^{3} - F $$\n采用牛顿-拉夫逊迭代格式来求解非线性平衡方程 $R(u)=0$。该格式需要切线刚度 $K_T(u)$，即残差对 $u$ 的导数。这等价于势能的二阶导数。\n$$ K_{T}(u) = \\frac{\\mathrm{d}R}{\\mathrm{d}u} = \\frac{\\mathrm{d}^{2}\\Pi}{\\mathrm{d}u^{2}} = \\frac{\\mathrm{d}}{\\mathrm{d}u}\\left(\\frac{A E}{L} u + \\frac{A \\alpha}{L^{3}} u^{3} - F\\right) $$\n微分运算得到切线刚度：\n$$ K_{T}(u) = \\frac{A E}{L} + \\frac{3 A \\alpha}{L^{3}} u^{2} $$\n牛顿-拉夫逊方法提供了位移的迭代更新。在通用迭代步 $k$ 处，位移的当前估计值为 $u_k$。在 $u_k$ 处的线性化系统由下式给出：\n$$ R(u_{k}) + K_{T}(u_{k}) \\Delta u_{k} = 0 $$\n其中 $\\Delta u_{k} = u_{k+1} - u_{k}$ 是位移增量，或称为牛顿步长。求解该增量可得：\n$$ \\Delta u_{k} = - \\frac{R(u_{k})}{K_{T}(u_{k})} $$\n现在我们代入在位移 $u_k$ 处求值的残差 $R(u_{k})$ 和切线刚度 $K_{T}(u_{k})$ 的表达式：\n$$ R(u_{k}) = \\frac{A E}{L} u_{k} + \\frac{A \\alpha}{L^{3}} u_{k}^{3} - F $$\n$$ K_{T}(u_{k}) = \\frac{A E}{L} + \\frac{3 A \\alpha}{L^{3}} u_{k}^{2} $$\n将这些代入 $\\Delta u_{k}$ 的表达式中：\n$$ \\Delta u_{k} = - \\frac{\\frac{A E}{L} u_{k} + \\frac{A \\alpha}{L^{3}} u_{k}^{3} - F}{\\frac{A E}{L} + \\frac{3 A \\alpha}{L^{3}} u_{k}^{2}} $$\n该表达式可以通过将负号并入分子来进行整理：\n$$ \\Delta u_{k} = \\frac{F - \\frac{A E}{L} u_{k} - \\frac{A \\alpha}{L^{3}} u_{k}^{3}}{\\frac{A E}{L} + \\frac{3 A \\alpha}{L^{3}} u_{k}^{2}} $$\n为得到不含繁分式的最终形式，我们将分子和分母同乘以 $L^{3}$：\n$$ \\Delta u_{k} = \\frac{L^{3} \\left( F - \\frac{A E}{L} u_{k} - \\frac{A \\alpha}{L^{3}} u_{k}^{3} \\right)}{L^{3} \\left( \\frac{A E}{L} + \\frac{3 A \\alpha}{L^{3}} u_{k}^{2} \\right)} $$\n这可以简化为牛顿步长 $\\Delta u_k$ 的闭式表达式：\n$$ \\Delta u_{k} = \\frac{F L^{3} - A E L^{2} u_{k} - A \\alpha u_{k}^{3}}{A E L^{2} + 3 A \\alpha u_{k}^{2}} $$\n这就是所要求的结果，它仅用给定的参数 $A$、$L$、$E$、$\\alpha$、$F$ 和当前的位移估计值 $u_k$ 表示。", "answer": "$$\n\\boxed{\\frac{F L^{3} - A E L^{2} u_{k} - A \\alpha u_{k}^{3}}{A E L^{2} + 3 A \\alpha u_{k}^{2}}}\n$$", "id": "2664990"}, {"introduction": "这项实践将我们从单自由度的标量问题带入到有限元分析中常见的多自由度系统。你将为一个二自由度系统构建残差向量和切向刚度矩阵，并计算单个牛顿迭代步的位移修正量。[@problem_id:2665001] 这个练习让你直接体验作为任何非线性结构模拟软件核心的向量和矩阵运算。", "problem": "考虑一个保守、非线性的两自由度 (DOF) 固体力学系统，其广义位移为 $u_{1}$ 和 $u_{2}$。设总势能为 $\\Pi(u_{1},u_{2}) = W(u_{1},u_{2}) - F_{1} u_{1} - F_{2} u_{2}$，其中应变能 $W$ 为\n$$\nW(u_{1},u_{2}) = \\tfrac{1}{2} k \\left(u_{1}^{2} + u_{2}^{2}\\right) + \\tfrac{1}{4} \\alpha\\, u_{1}^{4} + \\tfrac{1}{4} \\gamma\\, u_{2}^{4} + \\tfrac{1}{2} \\beta\\, u_{1}^{2} u_{2}^{2}.\n$$\n平衡方程由总势能的驻值条件 $\\nabla \\Pi(u_{1},u_{2}) = \\mathbf{0}$ 导出，该条件可以写成残差形式 $\\mathbf{R}(\\mathbf{u}) = \\mathbf{0}$，其中 $\\mathbf{u} = \\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix}$。\n\n给定材料/相互作用参数 $k = 1000$，$\\alpha = 100$，$\\gamma = 50$ 和 $\\beta = 20$，以及外部节点力 $F_{1} = 500$ 和 $F_{2} = 800$，请完成以下任务：\n\n- 从残差向量的定义（应变能的梯度减去外力）出发，推导其分量 $R_{1}(u_{1},u_{2})$ 和 $R_{2}(u_{1},u_{2})$。\n- 通过一阶泰勒展开将 $\\mathbf{R}(\\mathbf{u})$ 线性化，推导一致切线矩阵（雅可比矩阵）$K_{T}(\\mathbf{u})$。\n- 使用牛顿迭代概念，建立在当前迭代值 $\\mathbf{u}^{(k)}$ 处求解牛顿增量 $\\Delta \\mathbf{u}^{(k)}$ 所必须的线性系统。\n- 对于当前迭代值 $\\mathbf{u}^{(k)} = \\begin{pmatrix} 0.5 \\\\ 0.3 \\end{pmatrix}$，计算牛顿增量向量 $\\Delta \\mathbf{u}^{(k)}$。\n\n增量向量的各分量以毫米表示。将数值答案圆整至四位有效数字。", "solution": "经分析，该问题陈述有效。该问题以固体力学和数值分析原理为科学基础，是适定的、客观的，并包含求解所需的所有信息。\n\n该问题要求推导残差向量、切线矩阵，并为一个两自由度非线性系统计算单步的牛顿-拉弗森增量。\n\n总势能 $\\Pi$ 由下式给出\n$$\n\\Pi(\\mathbf{u}) = W(\\mathbf{u}) - \\mathbf{F}^{T} \\mathbf{u}\n$$\n其中 $\\mathbf{u} = \\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix}$ 是广义位移向量，$\\mathbf{F} = \\begin{pmatrix} F_{1} \\\\ F_{2} \\end{pmatrix}$ 是外力向量，而 $W(\\mathbf{u})$ 是弹性应变能。该应变能由下式给出\n$$\nW(u_{1}, u_{2}) = \\tfrac{1}{2} k (u_{1}^{2} + u_{2}^{2}) + \\tfrac{1}{4} \\alpha u_{1}^{4} + \\tfrac{1}{4} \\gamma u_{2}^{4} + \\tfrac{1}{2} \\beta u_{1}^{2} u_{2}^{2}\n$$\n平衡状态由势能驻值原理 $\\nabla \\Pi(\\mathbf{u}) = \\mathbf{0}$ 求得。残差向量 $\\mathbf{R}(\\mathbf{u})$ 定义为势能的梯度。\n$$\n\\mathbf{R}(\\mathbf{u}) = \\nabla \\Pi(\\mathbf{u}) = \\nabla W(\\mathbf{u}) - \\mathbf{F} = \\begin{pmatrix} \\frac{\\partial W}{\\partial u_{1}} - F_{1} \\\\ \\frac{\\partial W}{\\partial u_{2}} - F_{2} \\end{pmatrix}\n$$\n第一项任务是推导残差向量的分量 $R_{1}$ 和 $R_{2}$。我们计算应变能 $W$ 对 $u_{1}$ 和 $u_{2}$ 的偏导数。\n$$\n\\frac{\\partial W}{\\partial u_{1}} = \\frac{\\partial}{\\partial u_{1}} \\left( \\tfrac{1}{2} k(u_{1}^{2} + u_{2}^{2}) + \\tfrac{1}{4} \\alpha u_{1}^{4} + \\tfrac{1}{4} \\gamma u_{2}^{4} + \\tfrac{1}{2} \\beta u_{1}^{2} u_{2}^{2} \\right) = k u_{1} + \\alpha u_{1}^{3} + \\beta u_{1} u_{2}^{2}\n$$\n$$\n\\frac{\\partial W}{\\partial u_{2}} = \\frac{\\partial}{\\partial u_{2}} \\left( \\tfrac{1}{2} k(u_{1}^{2} + u_{2}^{2}) + \\tfrac{1}{4} \\alpha u_{1}^{4} + \\tfrac{1}{4} \\gamma u_{2}^{4} + \\tfrac{1}{2} \\beta u_{1}^{2} u_{2}^{2} \\right) = k u_{2} + \\gamma u_{2}^{3} + \\beta u_{1}^{2} u_{2}\n$$\n因此，残差向量的分量为：\n$$\nR_{1}(u_{1}, u_{2}) = k u_{1} + \\alpha u_{1}^{3} + \\beta u_{1} u_{2}^{2} - F_{1}\n$$\n$$\nR_{2}(u_{1}, u_{2}) = k u_{2} + \\gamma u_{2}^{3} + \\beta u_{1}^{2} u_{2} - F_{2}\n$$\n第二项任务是推导一致切线矩阵 $K_{T}(\\mathbf{u})$，它是残差向量 $\\mathbf{R}(\\mathbf{u})$ 关于 $\\mathbf{u}$ 的雅可比矩阵。\n$$\nK_{T}(\\mathbf{u}) = \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{u}} = \\begin{pmatrix} \\frac{\\partial R_{1}}{\\partial u_{1}} & \\frac{\\partial R_{1}}{\\partial u_{2}} \\\\ \\frac{\\partial R_{2}}{\\partial u_{1}} & \\frac{\\partial R_{2}}{\\partial u_{2}} \\end{pmatrix} = \\nabla^2 W(\\mathbf{u})\n$$\n我们计算所需的 $W$ 的二阶偏导数：\n$$\n\\frac{\\partial R_{1}}{\\partial u_{1}} = \\frac{\\partial^{2} W}{\\partial u_{1}^{2}} = k + 3 \\alpha u_{1}^{2} + \\beta u_{2}^{2}\n$$\n$$\n\\frac{\\partial R_{1}}{\\partial u_{2}} = \\frac{\\partial^{2} W}{\\partial u_{1} \\partial u_{2}} = 2 \\beta u_{1} u_{2}\n$$\n$$\n\\frac{\\partial R_{2}}{\\partial u_{1}} = \\frac{\\partial^{2} W}{\\partial u_{2} \\partial u_{1}} = 2 \\beta u_{1} u_{2}\n$$\n$$\n\\frac{\\partial R_{2}}{\\partial u_{2}} = \\frac{\\partial^{2} W}{\\partial u_{2}^{2}} = k + 3 \\gamma u_{2}^{2} + \\beta u_{1}^{2}\n$$\n切线矩阵是对称的，这与保守系统的特性相符。\n$$\nK_{T}(u_{1}, u_{2}) = \\begin{pmatrix} k + 3 \\alpha u_{1}^{2} + \\beta u_{2}^{2} & 2 \\beta u_{1} u_{2} \\\\ 2 \\beta u_{1} u_{2} & k + 3 \\gamma u_{2}^{2} + \\beta u_{1}^{2} \\end{pmatrix}\n$$\n第三项任务是为牛顿-拉弗森迭代建立线性系统。核心思想是找到 $\\mathbf{R}(\\mathbf{u}) = \\mathbf{0}$ 的一个根。给定当前迭代值 $\\mathbf{u}^{(k)}$，我们使用在 $\\mathbf{u}^{(k)}$ 处的一阶泰勒展开来近似下一个迭代值 $\\mathbf{u}^{(k+1)}$ 处的残差：\n$$\n\\mathbf{R}(\\mathbf{u}^{(k+1)}) \\approx \\mathbf{R}(\\mathbf{u}^{(k)}) + \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{u}}\\Big|_{\\mathbf{u}^{(k)}} (\\mathbf{u}^{(k+1)} - \\mathbf{u}^{(k)})\n$$\n令 $\\mathbf{R}(\\mathbf{u}^{(k+1)}) = \\mathbf{0}$ 以找到更优的根，并定义增量 $\\Delta \\mathbf{u}^{(k)} = \\mathbf{u}^{(k+1)} - \\mathbf{u}^{(k)}$，我们得到：\n$$\n\\mathbf{0} \\approx \\mathbf{R}(\\mathbf{u}^{(k)}) + K_{T}(\\mathbf{u}^{(k)}) \\Delta \\mathbf{u}^{(k)}\n$$\n这就导出了求解位移增量 $\\Delta \\mathbf{u}^{(k)}$ 所必须的线性方程组：\n$$\nK_{T}(\\mathbf{u}^{(k)}) \\Delta \\mathbf{u}^{(k)} = -\\mathbf{R}(\\mathbf{u}^{(k)})\n$$\n最后一项任务是为迭代值 $\\mathbf{u}^{(k)} = \\begin{pmatrix} 0.5 \\\\ 0.3 \\end{pmatrix}$ 计算增量 $\\Delta \\mathbf{u}^{(k)}$。给定的参数为 $k = 1000$，$\\alpha = 100$，$\\gamma = 50$，$\\beta = 20$，$F_{1}=500$ 和 $F_{2}=800$。假定位移值的单位是毫米 ($mm$)。\n\n首先，我们在 $\\mathbf{u}^{(k)} = \\begin{pmatrix} 0.5 \\\\ 0.3 \\end{pmatrix}$ 处计算残差向量 $\\mathbf{R}(\\mathbf{u}^{(k)})$：\n$$\nR_{1}^{(k)} = (1000)(0.5) + (100)(0.5)^{3} + (20)(0.5)(0.3)^{2} - 500 = 500 + 12.5 + 0.9 - 500 = 13.4\n$$\n$$\nR_{2}^{(k)} = (1000)(0.3) + (50)(0.3)^{3} + (20)(0.5)^{2}(0.3) - 800 = 300 + 1.35 + 1.5 - 800 = -497.15\n$$\n所以，$\\mathbf{R}(\\mathbf{u}^{(k)}) = \\begin{pmatrix} 13.4 \\\\ -497.15 \\end{pmatrix}$。\n\n接着，我们在同一点计算切线矩阵 $K_{T}(\\mathbf{u}^{(k)})$：\n$$\nK_{T,11} = 1000 + 3(100)(0.5)^{2} + (20)(0.3)^{2} = 1000 + 75 + 1.8 = 1076.8\n$$\n$$\nK_{T,12} = K_{T,21} = 2(20)(0.5)(0.3) = 6\n$$\n$$\nK_{T,22} = 1000 + 3(50)(0.3)^{2} + (20)(0.5)^{2} = 1000 + 13.5 + 5 = 1018.5\n$$\n所以，$K_{T}(\\mathbf{u}^{(k)}) = \\begin{pmatrix} 1076.8 & 6 \\\\ 6 & 1018.5 \\end{pmatrix}$。\n\n现在我们求解线性系统 $K_{T}(\\mathbf{u}^{(k)}) \\Delta \\mathbf{u}^{(k)} = -\\mathbf{R}(\\mathbf{u}^{(k)})$：\n$$\n\\begin{pmatrix} 1076.8 & 6 \\\\ 6 & 1018.5 \\end{pmatrix} \\begin{pmatrix} \\Delta u_{1}^{(k)} \\\\ \\Delta u_{2}^{(k)} \\end{pmatrix} = -\\begin{pmatrix} 13.4 \\\\ -497.15 \\end{pmatrix} = \\begin{pmatrix} -13.4 \\\\ 497.15 \\end{pmatrix}\n$$\n为求解这个 $2 \\times 2$ 系统，我们可以使用矩阵求逆。矩阵 $\\mathbf{A} = \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$ 的逆是 $\\mathbf{A}^{-1} = \\frac{1}{\\det(\\mathbf{A})} \\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$。\n$K_{T}$ 的行列式是：\n$$\n\\det(K_{T}) = (1076.8)(1018.5) - (6)(6) = 1096756.8 - 36 = 1096720.8\n$$\n于是增量向量为：\n$$\n\\Delta \\mathbf{u}^{(k)} = \\frac{1}{1096720.8} \\begin{pmatrix} 1018.5 & -6 \\\\ -6 & 1076.8 \\end{pmatrix} \\begin{pmatrix} -13.4 \\\\ 497.15 \\end{pmatrix}\n$$\n我们计算其分量：\n$$\n\\Delta u_{1}^{(k)} = \\frac{ (1018.5)(-13.4) + (-6)(497.15) }{ 1096720.8 } = \\frac{ -13647.9 - 2982.9 }{ 1096720.8 } = \\frac{ -16630.8 }{ 1096720.8 } \\approx -0.0151642 \\, \\text{mm}\n$$\n$$\n\\Delta u_{2}^{(k)} = \\frac{ (-6)(-13.4) + (1076.8)(497.15) }{ 1096720.8 } = \\frac{ 80.4 + 535348.52 }{ 1096720.8 } = \\frac{ 535428.92 }{ 1096720.8 } \\approx 0.488214 \\, \\text{mm}\n$$\n按要求将结果圆整至四位有效数字：\n$$\n\\Delta u_{1}^{(k)} \\approx -0.01516 \\, \\text{mm}\n$$\n$$\n\\Delta u_{2}^{(k)} \\approx 0.4882 \\, \\text{mm}\n$$\n牛顿增量向量为 $\\Delta \\mathbf{u}^{(k)} \\approx \\begin{pmatrix} -0.01516 \\\\ 0.4882 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} -0.01516 \\\\ 0.4882 \\end{pmatrix}\n}\n$$", "id": "2665001"}, {"introduction": "最后的这项实践深入到计算塑性力学这一关键课题，展示了切向刚度对迭代性能的实际影响。你将通过编程实现一个算法，比较使用理论上正确的“算法切线”与近似的“弹性切线”时牛顿格式的收敛性。[@problem_id:2665009] 这项计算练习有力地说明了，为何在真实的非线性分析中，使用一致切线对于实现使牛顿-拉弗森法如此高效的二次快速收敛至关重要。", "problem": "考虑一个一维、小应变、率无关、单调拉伸问题，研究对象为位移控制下的弹塑性杆。集中于代表该杆的单个材料点，因此运动学简化为在从状态 $n$ 到 $n+1$ 的一个载荷步上施加的总应变增量 $\\Delta \\varepsilon$。该材料遵循线性弹性及各向同性硬化塑性理论，其基本构成要素如下：\n\n- 运动学：总应变 $\\varepsilon$ 可加法分解为弹性和塑性两部分，$\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$。\n- 线性弹性：Cauchy 应力 $\\sigma$ 满足 $\\sigma = E \\left( \\varepsilon - \\varepsilon^{p} \\right)$，其中 $E$ 是杨氏模量。\n- 屈服条件（单轴单调拉伸）：$f(\\sigma,\\alpha) = \\sigma - \\left( \\sigma_{y} + H \\alpha \\right) \\le 0$，其中 $\\sigma_{y}$ 是初始屈服应力，$H \\ge 0$ 是各向同性硬化模量，$\\alpha$ 是累积塑性应变（在一维情况下即等效塑性应变）。\n- 塑性加载的关联流动与一致性条件：对于单调拉伸，塑性应变增量 $\\Delta \\varepsilon^{p} = \\Delta \\gamma$，累积塑性应变增量 $\\Delta \\alpha = \\Delta \\gamma$，Kuhn–Tucker 条件为 $\\Delta \\gamma \\ge 0$，$f \\le 0$，$\\Delta \\gamma f = 0$。\n\n假设在时刻 $n$ 的状态已知：$\\sigma_{n}$、$\\alpha_{n}$，并且施加的总应变增量 $\\Delta \\varepsilon$ 是给定的。弹性试探应力定义为 $\\sigma_{\\mathrm{tr}} = \\sigma_{n} + E \\Delta \\varepsilon$。如果试探屈服函数 $f_{\\mathrm{tr}} = \\sigma_{\\mathrm{tr}} - \\left( \\sigma_{y} + H \\alpha_{n} \\right) \\le 0$，则该增量步为弹性步，无需进行迭代求解。若 $f_{\\mathrm{tr}} > 0$，则发生塑性加载，必须施加塑性一致性条件来确定塑性乘子增量 $\\Delta \\gamma$。\n\n任务 A（从基本原理推导）：严格依据上述基本定律和定义，推导用于在该步结束时施加塑性一致性条件的塑性乘子增量 $\\Delta \\gamma$ 的标量非线性方程。然后，为该标量方程的 Newton–Raphson 迭代推导两种不同的雅可比矩阵选择：\n- “弹性切线”雅可比矩阵，对应于在 Newton 线性化中使用纯弹性模量。\n- “算法（一致）切线”雅可比矩阵，对应于由本构更新所隐含的、返回映射应力对应变的精确导数。\n\n任务 B（算法详述）：当 $f_{\\mathrm{tr}} > 0$ 时，实现一个 Newton–Raphson 格式来求解 $\\Delta \\gamma$ 的标量残差方程，所有测试用例均使用以下统一的数值设置：\n- 初始猜测值 $\\Delta \\gamma_{0} = 0$。\n- 收敛判据：绝对残差范数 $|r(\\Delta \\gamma_{k})| \\le \\tau_{R}$，容差 $\\tau_{R} = 10^{-10}$，单位为帕斯卡（Pa）。\n- 每种方法在每个载荷步的最大迭代次数：$N_{\\max} = 100$。\n- 如果 $f_{\\mathrm{tr}} \\le 0$，则两种雅可比矩阵选择的迭代次数均报告为零。\n- 如果在 $N_{\\max}$ 次迭代内残差不满足 $|r(\\Delta \\gamma_{k})| \\le \\tau_{R}$，则该方法的迭代次数报告为表示不收敛的整数 $-1$。\n\n任务 C（测试套件与要求输出）：对于下方的每组参数，执行上述算法并报告两个整数：首先是使用算法（一致）切线雅可比矩阵的牛顿法的迭代次数，其次是使用弹性切线雅可比矩阵的牛顿法的迭代次数。材料参数以国际单位制（SI）给出。所有应力单位为帕斯卡，所有应变均为无量纲。\n\n为以下六个测试用例提供结果：\n\n- 用例 $1$（弹性步）：\n  - $E = 2.10 \\times 10^{11}\\ \\mathrm{Pa}$，$H = 1.00 \\times 10^{9}\\ \\mathrm{Pa}$，$\\sigma_{y} = 2.50 \\times 10^{8}\\ \\mathrm{Pa}$，\n  - $\\sigma_{n} = 0$，$\\alpha_{n} = 0$，$\\Delta \\varepsilon = 5.00 \\times 10^{-4}$。\n\n- 用例 $2$（中等塑性，小幅硬化）：\n  - $E = 2.10 \\times 10^{11}\\ \\mathrm{Pa}$，$H = 1.00 \\times 10^{9}\\ \\mathrm{Pa}$，$\\sigma_{y} = 2.50 \\times 10^{8}\\ \\mathrm{Pa}$，\n  - $\\sigma_{n} = 0$，$\\alpha_{n} = 0$，$\\Delta \\varepsilon = 2.00 \\times 10^{-3}$。\n\n- 用例 $3$（理想塑性）：\n  - $E = 7.00 \\times 10^{10}\\ \\mathrm{Pa}$，$H = 0$，$\\sigma_{y} = 2.00 \\times 10^{8}\\ \\mathrm{Pa}$，\n  - $\\sigma_{n} = 0$，$\\alpha_{n} = 0$，$\\Delta \\varepsilon = 5.00 \\times 10^{-3}$。\n\n- 用例 $4$（大硬化，使用弹性雅可比矩阵时收敛缓慢）：\n  - $E = 1.00 \\times 10^{11}\\ \\mathrm{Pa}$，$H = 9.00 \\times 10^{10}\\ \\mathrm{Pa}$，$\\sigma_{y} = 1.00 \\times 10^{8}\\ \\mathrm{Pa}$，\n  - $\\sigma_{n} = 0$，$\\alpha_{n} = 0$，$\\Delta \\varepsilon = 3.00 \\times 10^{-3}$。\n\n- 用例 $5$（使用弹性雅可比矩阵的收敛边界）：\n  - $E = 1.00 \\times 10^{11}\\ \\mathrm{Pa}$，$H = 1.00 \\times 10^{11}\\ \\mathrm{Pa}$，$\\sigma_{y} = 1.00 \\times 10^{8}\\ \\mathrm{Pa}$，\n  - $\\sigma_{n} = 0$，$\\alpha_{n} = 0$，$\\Delta \\varepsilon = 3.00 \\times 10^{-3}$。\n\n- 用例 $6$（具有非零初始塑性应变和应力的塑性步）：\n  - $E = 2.00 \\times 10^{11}\\ \\mathrm{Pa}$，$H = 5.00 \\times 10^{9}\\ \\mathrm{Pa}$，$\\sigma_{y} = 3.00 \\times 10^{8}\\ \\mathrm{Pa}$，\n  - $\\sigma_{n} = 1.00 \\times 10^{8}\\ \\mathrm{Pa}$，$\\alpha_{n} = 1.00 \\times 10^{-3}$，$\\Delta \\varepsilon = 1.20 \\times 10^{-3}$。\n\n最终输出格式要求：您的程序应生成单行输出，其中包含一个扁平的整数列表，按顺序汇总所有六个用例的结果。对于每个用例，按上述方式将两个整数并列放置。例如，输出形式必须为 $[n_{1}^{\\mathrm{alg}}, n_{1}^{\\mathrm{elas}}, n_{2}^{\\mathrm{alg}}, n_{2}^{\\mathrm{elas}}, \\dots, n_{6}^{\\mathrm{alg}}, n_{6}^{\\mathrm{elas}}]$，逗号后不加空格。", "solution": "用户提供了一个计算固体力学领域的问题，具体涉及弹塑性本构模型的数值积分。任务是推导一维、率无关、各向同性硬化材料模型的控制方程，然后实现一个 Newton-Raphson 迭代格式来求解塑性应变增量。需要比较牛顿法中两种不同雅可比矩阵选择的性能。\n\n首先必须验证问题陈述的科学合理性、完整性和客观性。\n\n**步骤 1：提取已知条件**\n\n*   **运动学**：总应变 $\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$。\n*   **弹性**：Cauchy 应力 $\\sigma = E ( \\varepsilon - \\varepsilon^{p} )$，其中 $E$ 是杨氏模量。\n*   **屈服条件**：$f(\\sigma,\\alpha) = \\sigma - ( \\sigma_{y} + H \\alpha ) \\le 0$，其中 $\\sigma_{y}$ 是初始屈服应力，$H \\ge 0$ 是各向同性硬化模量，$\\alpha$ 是累积塑性应变。\n*   **流动法则**：对于单调拉伸，塑性应变增量 $\\Delta \\varepsilon^{p} = \\Delta \\gamma$。\n*   **硬化定律**：累积塑性应变增量 $\\Delta \\alpha = \\Delta \\gamma$。\n*   **Kuhn-Tucker 条件**：$\\Delta \\gamma \\ge 0$, $f \\le 0$, $\\Delta \\gamma f = 0$。\n*   **步骤 $n$ 的状态变量**：$\\sigma_{n}$、$\\alpha_{n}$ 已知。\n*   **加载**：施加总应变增量 $\\Delta \\varepsilon$。\n*   **弹性试探状态**：试探应力 $\\sigma_{\\mathrm{tr}} = \\sigma_{n} + E \\Delta \\varepsilon$。试探屈服函数 $f_{\\mathrm{tr}} = \\sigma_{\\mathrm{tr}} - ( \\sigma_{y} + H \\alpha_{n} )$。\n*   **数值参数**：\n    *   塑性乘子增量的初始猜测值：$\\Delta \\gamma_{0} = 0$。\n    *   残差收敛容差：$|r(\\Delta \\gamma_{k})| \\le \\tau_{R}$，其中 $\\tau_{R} = 10^{-10}\\ \\mathrm{Pa}$。\n    *   最大迭代次数：$N_{\\max} = 100$。\n*   **测试用例**：提供了六组不同的材料参数（$E, H, \\sigma_y$）、初始条件（$\\sigma_n, \\alpha_n$）和应变增量（$\\Delta \\varepsilon$）。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n该问题具有科学依据。它描述了针对一维单调拉伸、线性各向同性硬化情况下的 J2 塑性模型的标准“返回映射”算法。这是计算非弹性力学中的一个基本且典型的问题。所涉及的方程和概念均为标准的教科书内容。\n\n该问题是适定的。其目标是求解满足时间步结束时一致性条件的塑性乘子增量 $\\Delta \\gamma$。对于给定的线性硬化模型，当 $f_{\\mathrm{tr}} > 0$ 时，$\\Delta \\gamma$ 存在唯一解。\n\n该问题是客观和完整的。它使用了精确、无歧义的科学术语。为每个用例提供了所有必需的材料参数、初始条件、载荷增量和数值算法设置，使得问题自成体系且可复现。数据在物理上和量纲上都是一致的。\n\n该问题并非无足轻重。它要求推导局部本构更新算法，并理解一致（算法）切线模量与非一致（弹性）切线模量在收敛性能上的差异，这是计算力学中的一个关键概念。\n\n**步骤 3：结论与操作**\n\n问题有效。我将按要求进行推导和求解。\n\n**任务 A：非线性方程及雅可比矩阵的推导**\n\n设增量开始时（步骤 $n$）的状态已知：$(\\sigma_{n}, \\alpha_{n})$。施加总应变增量 $\\Delta\\varepsilon$，使得增量步结束时（步骤 $n+1$）的总应变为 $\\varepsilon_{n+1} = \\varepsilon_n + \\Delta \\varepsilon$。根据步骤 $n$ 的弹性定律，$\\sigma_n = E(\\varepsilon_n - \\varepsilon^p_n)$，并且由于在此一维情况下 $\\varepsilon^p_n = \\alpha_n$，我们有 $\\varepsilon_n = \\sigma_n/E + \\alpha_n$。\n\n首先，我们计算一个“弹性试探”状态，假设整个增量 $\\Delta\\varepsilon$ 是纯弹性的。试探应力为：\n$$ \\sigma_{\\mathrm{tr}} = E(\\varepsilon_{n+1} - \\varepsilon^p_n) = E(\\varepsilon_n + \\Delta\\varepsilon - \\alpha_n) = E(\\sigma_n/E + \\alpha_n + \\Delta\\varepsilon - \\alpha_n) = \\sigma_n + E \\Delta\\varepsilon $$\n在此试探状态下检查屈服条件：\n$$ f_{\\mathrm{tr}} = \\sigma_{\\mathrm{tr}} - (\\sigma_y + H \\alpha_n) $$\n如果 $f_{\\mathrm{tr}} \\le 0$，则弹性行为的假设是正确的。该增量步是弹性的，$\\Delta\\gamma = 0$，最终状态为 $\\sigma_{n+1} = \\sigma_{\\mathrm{tr}}$ 和 $\\alpha_{n+1} = \\alpha_n$。无需迭代。\n\n如果 $f_{\\mathrm{tr}} > 0$，则发生塑性流动，意味着 $\\Delta\\gamma > 0$。我们必须找到能使步末塑性一致性条件 $f_{n+1} = 0$ 得以满足的 $\\Delta\\gamma$ 值。步骤 $n+1$ 的状态变量更新如下：\n塑性应变和累积塑性应变通过未知数 $\\Delta\\gamma$ 进行更新：\n$$ \\varepsilon^p_{n+1} = \\varepsilon^p_n + \\Delta\\varepsilon^p = \\alpha_n + \\Delta\\gamma $$\n$$ \\alpha_{n+1} = \\alpha_n + \\Delta\\alpha = \\alpha_n + \\Delta\\gamma $$\n步骤 $n+1$ 的应力可由弹性定律和更新后的塑性应变得到：\n$$ \\sigma_{n+1} = E(\\varepsilon_{n+1} - \\varepsilon^p_{n+1}) = E(\\varepsilon_n + \\Delta\\varepsilon - (\\alpha_n + \\Delta\\gamma)) $$\n使用试探应力的表达式，上式可简化为应力的“返回映射”方程：\n$$ \\sigma_{n+1} = (\\sigma_n + E\\Delta\\varepsilon) - E\\Delta\\gamma = \\sigma_{\\mathrm{tr}} - E\\Delta\\gamma $$\n一致性条件要求在最终状态下屈服函数为零：\n$$ f_{n+1} = \\sigma_{n+1} - (\\sigma_y + H\\alpha_{n+1}) = 0 $$\n代入 $\\sigma_{n+1}$ 和 $\\alpha_{n+1}$ 的表达式，得到关于 $\\Delta\\gamma$ 的方程：\n$$ (\\sigma_{\\mathrm{tr}} - E\\Delta\\gamma) - (\\sigma_y + H(\\alpha_n + \\Delta\\gamma)) = 0 $$\n我们将残差函数 $r(\\Delta\\gamma)$ 定义为给定 $\\Delta\\gamma$ 时的屈服函数值。我们的目标是找到使 $r(\\Delta\\gamma) = 0$ 的 $\\Delta\\gamma$。\n$$ r(\\Delta\\gamma) = \\sigma_{\\mathrm{tr}} - E\\Delta\\gamma - \\sigma_y - H\\alpha_n - H\\Delta\\gamma $$\n重新整理并使用 $f_{\\mathrm{tr}}$ 的定义：\n$$ r(\\Delta\\gamma) = (\\sigma_{\\mathrm{tr}} - (\\sigma_y + H\\alpha_n)) - (E+H)\\Delta\\gamma = f_{\\mathrm{tr}} - (E+H)\\Delta\\gamma $$\n这就是要求解 $\\Delta\\gamma$ 的标量方程。尽管对于此特定材料模型，该方程对 $\\Delta\\gamma$ 是线性的，但我们仍按要求使用 Newton-Raphson 格式来求解。迭代更新公式为：\n$$ \\Delta\\gamma_{k+1} = \\Delta\\gamma_k - \\frac{r(\\Delta\\gamma_k)}{J_k} $$\n其中，$J_k$ 是残差在 $\\Delta\\gamma_k$ 处的雅可比矩阵（导数）。\n\n**雅可比矩阵的推导：**\n\n1.  **算法（一致）切线雅可比矩阵，$J_{\\mathrm{alg}}$**：\n    这是残差函数相对于未知数 $\\Delta\\gamma$ 的精确导数。\n    $$ J_{\\mathrm{alg}} = \\frac{dr(\\Delta\\gamma)}{d(\\Delta\\gamma)} = \\frac{d}{d(\\Delta\\gamma)} [f_{\\mathrm{tr}} - (E+H)\\Delta\\gamma] $$\n    由于 $f_{\\mathrm{tr}}$、$E$ 和 $H$ 相对于迭代未知数 $\\Delta\\gamma$ 均为常数，因此导数为：\n    $$ J_{\\mathrm{alg}} = -(E+H) $$\n    由于该雅可比矩阵是线性函数的精确导数，因此无论初始猜测值如何，Newton-Raphson 方法都将在单次迭代中收敛到精确解。\n\n2.  **“弹性切线”雅可比矩阵，$J_{\\mathrm{elas}}$**：\n    问题要求一个“对应于在 Newton 线性化中使用纯弹性模量”的雅可比矩阵。残差 $r(\\Delta\\gamma)$ 可视为更新后的应力与更新后的屈服强度之差。其导数为 $J = \\frac{d\\sigma_{n+1}}{d(\\Delta\\gamma)} - \\frac{d(\\sigma_y+H\\alpha_{n+1})}{d(\\Delta\\gamma)}$。第一项 $\\frac{d\\sigma_{n+1}}{d(\\Delta\\gamma)} = -E$ 表示由塑性应变引起的应力变化，并由弹性模量 $E$ 控制。第二项 $-\\frac{d(H\\alpha_{n+1})}{d(\\Delta\\gamma)} = -H$ 表示由硬化引起的屈服面尺寸变化。“弹性切线”方法仅保留弹性模量 $E$ 的贡献，而忽略硬化的贡献。因此，弹性切线雅可比矩阵定义为：\n    $$ J_{\\mathrm{elas}} = -E $$\n    这是一个非一致切线矩阵，因为它不是残差的精确导数。使用此雅可比矩阵的牛顿格式的收敛速度是线性的，而非二次的。残差的不动点迭代为 $r_{k+1} = r_k(1 - J_{\\mathrm{alg}}/J_{\\mathrm{elas}}) = r_k(1 - (E+H)/E) = r_k(-H/E)$。只有当迭代的谱半径 $|-H/E|$ 小于 1 时，才能保证收敛。\n\n**任务 B：算法实现**\n\n对于每个测试用例和每个雅可比矩阵选择（$J_{\\mathrm{alg}}$ 和 $J_{\\mathrm{elas}}$），执行以下算法：\n1.  计算 $\\sigma_{\\mathrm{tr}} = \\sigma_{n} + E \\Delta\\varepsilon$。\n2.  计算 $f_{\\mathrm{tr}} = \\sigma_{\\mathrm{tr}} - (\\sigma_y + H \\alpha_n)$。\n3.  如果 $f_{\\mathrm{tr}} \\le 0$，迭代次数为 $0$。\n4.  如果 $f_{\\mathrm{tr}} > 0$：\n    a. 初始化迭代计数 $k = 0$ 和塑性乘子增量 $\\Delta\\gamma_0 = 0$。\n    b. 开始一个循环， $k = 0, 1, 2, \\dots, N_{\\max}$。\n    c. 计算残差 $r_k = f_{\\mathrm{tr}} - (E+H)\\Delta\\gamma_k$。\n    d. 检查收敛性：如果 $|r_k| \\le \\tau_{R}$，则程序已收敛。迭代次数为 $k$。退出循环。\n    e. 如果 $k=N_{\\max}$ 且仍未达到收敛，则该方法失败。迭代次数设为 $-1$。退出循环。\n    f. 选择适当的雅可比矩阵 $J_k$（$J_{\\mathrm{alg}}$ 或 $J_{\\mathrm{elas}}$）。\n    g. 更新塑性乘子：$\\Delta\\gamma_{k+1} = \\Delta\\gamma_k - r_k / J_k$。\n    h. 增加 $k \\to k+1$ 并继续循环。\n\n对所有六个测试用例执行此过程。", "answer": "[0,0,1,10,1,1,1,20,1,-1,1,5]", "id": "2665009"}]}