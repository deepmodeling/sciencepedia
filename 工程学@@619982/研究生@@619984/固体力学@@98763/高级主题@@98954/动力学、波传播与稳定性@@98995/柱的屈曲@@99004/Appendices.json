{"hands_on_practices": [{"introduction": "要真正掌握弹性稳定性，从第一性原理推导屈曲准则是至关重要的。本练习将引导你使用总势能平稳性原理，为悬臂柱（一端固定，一端自由）推导其控制特征值问题和边界条件。通过这个过程，你不仅可以确定临界载荷，还能理解其屈曲模态与正弦函数段的关系，从而加深对不同边界条件如何影响稳定性的理解。[@problem_id:2620907]", "problem": "一根长度为 $L$、抗弯刚度 $E I$ 恒定的直棱柱、笔直、不可伸长柱，在 $x=0$ 处完全固定（固支），在 $x=L$ 处自由。在 $x=L$ 处施加一个轴向压缩端部荷载 $P$，并使其与未变形的形心轴保持共线。采用小挠度、线弹性理论，并将屈曲视为通过总势能驻定性获得的中性平衡的开始。从第一性原理——即弯曲应变能和与压缩荷载相关的功——出发，推导控制特征值问题以及适用于所述端部荷载下固支-自由杆件的所有边界条件。确定：\n- 以 $E$、$I$ 和 $L$ 的封闭式表达式表示的最小（第一）临界荷载。\n- 相关的屈曲模态振型，写为 $x$ 和 $L$ 的简单三角函数，归一化使得 $y(L)=1$，并以能清楚表明其与正弦族函数片段关系的形式表示。\n\n将您的最终结果以单行矩阵的形式提供，矩阵包含按上述顺序排列的两个所求量。无需进行数值计算或四舍五入。最终答案框中不要包含单位。", "solution": "该问题要求使用总势能驻定原理，推导固支-自由柱的临界屈曲荷载和相应的模态振型。\n\n系统的总势能 $\\Pi$ 是内部应变能 $U$ 和外部施加荷载的势能 $\\Omega$ 之和。\n$$ \\Pi = U + \\Omega $$\n对于发生小挠度的不可伸长线弹性柱，根据 Euler-Bernoulli 梁理论，弯曲应变能由下式给出：\n$$ U = \\frac{1}{2} \\int_{0}^{L} EI \\left( \\frac{d^2y}{dx^2} \\right)^2 dx = \\frac{1}{2} \\int_{0}^{L} EI (y'')^2 dx $$\n其中 $y(x)$ 是横向位移，$E$ 是杨氏模量，$I$ 是截面的面积二次矩，$L$ 是柱的长度。\n\n轴向压缩荷载 $P$ 的势能是荷载所做功的负值。当柱因弯曲而缩短量为 $\\Delta$ 时，荷载做功。对于小挠度，该缩短量为：\n$$ \\Delta = \\frac{1}{2} \\int_{0}^{L} \\left( \\frac{dy}{dx} \\right)^2 dx = \\frac{1}{2} \\int_{0}^{L} (y')^2 dx $$\n因此，荷载的势能为：\n$$ \\Omega = -P \\Delta = -\\frac{P}{2} \\int_{0}^{L} (y')^2 dx $$\n总势能泛函为：\n$$ \\Pi[y] = \\frac{1}{2} \\int_{0}^{L} \\left[ EI (y'')^2 - P (y')^2 \\right] dx $$\n为达到平衡，总势能必须是驻定的，这意味着其一次变分 $\\delta \\Pi$ 对于任何运动学容许的变分 $\\delta y$ 都必须为零。\n$$ \\delta \\Pi = \\int_{0}^{L} \\left[ EI y'' \\delta(y'') - P y' \\delta(y') \\right] dx = 0 $$\n使用分部积分法：\n$$ \\int_{0}^{L} EI y'' \\delta(y'') dx = \\int_{0}^{L} EI y'' \\frac{d}{dx}(\\delta y') dx = \\left[ EI y'' \\delta y' \\right]_{0}^{L} - \\int_{0}^{L} EI y''' \\delta y' dx $$\n$$ = \\left[ EI y'' \\delta y' \\right]_{0}^{L} - \\left[ EI y''' \\delta y \\right]_{0}^{L} + \\int_{0}^{L} EI y'''' \\delta y dx $$\n对于第二项：\n$$ \\int_{0}^{L} -P y' \\delta(y') dx = \\int_{0}^{L} -P y' \\frac{d}{dx}(\\delta y) dx = \\left[ -P y' \\delta y \\right]_{0}^{L} + \\int_{0}^{L} P y'' \\delta y dx $$\n结合这些结果，一次变分变为：\n$$ \\delta \\Pi = \\int_{0}^{L} (EI y'''' + P y'') \\delta y dx + \\left[ EI y'' \\delta y' \\right]_{0}^{L} - \\left[ (EI y''' + P y') \\delta y \\right]_{0}^{L} = 0 $$\n由于变分 $\\delta y$ 在域 $(0, L)$ 内是任意的，积分项必须为零，从而得出控制常微分方程：\n$$ EI y'''' + P y'' = 0 $$\n边界项也必须为零。柱在 $x=0$ 处是固支的，因此几何（本质）边界条件是 $y(0)=0$ 和 $y'(0)=0$。这意味变分 $\\delta y(0)=0$ 和 $\\delta y'(0)=0$，这使得在 $x=0$ 处的边界项自然为零。\n在自由端 $x=L$ 处，变分 $\\delta y(L)$ 和 $\\delta y'(L)$ 是任意的。为使 $x=L$ 处的边界项为零，它们的系数必须为零。这提供了自然（力）边界条件：\n$$ EI y''(L) = 0 \\quad (\\text{弯矩为零}) $$\n$$ EI y'''(L) + P y'(L) = 0 \\quad (\\text{有效剪力为零}) $$\n因此，完整的特征值问题由微分方程和四个边界条件定义。设 $k^2 = \\frac{P}{EI}$，假设 $P>0$。微分方程为 $y'''' + k^2 y'' = 0$。\n特征方程为 $r^4 + k^2 r^2 = 0$，其根为 $r=0$（2重根）和 $r=\\pm ik$。通解为：\n$$ y(x) = C_1 \\cos(kx) + C_2 \\sin(kx) + C_3 x + C_4 $$\n我们应用边界条件：\n$1$. $y(0)=0 \\implies C_1 \\cos(0) + C_2 \\sin(0) + C_3(0) + C_4 = 0 \\implies C_1 + C_4 = 0$。\n$2$. $y'(x) = -k C_1 \\sin(kx) + k C_2 \\cos(kx) + C_3$。\n$y'(0)=0 \\implies -k C_1 \\sin(0) + k C_2 \\cos(0) + C_3 = 0 \\implies k C_2 + C_3 = 0$。\n$3$. $y''(x) = -k^2 C_1 \\cos(kx) - k^2 C_2 \\sin(kx)$。\n$y''(L)=0 \\implies -k^2(C_1 \\cos(kL) + C_2 \\sin(kL)) = 0 \\implies C_1 \\cos(kL) + C_2 \\sin(kL) = 0$。\n$4$. $y'''(x) = k^3 C_1 \\sin(kx) - k^3 C_2 \\cos(kx)$。条件 $y'''(L) + k^2 y'(L) = 0$ 变为：\n$(k^3 C_1 \\sin(kL) - k^3 C_2 \\cos(kL)) + k^2(-k C_1 \\sin(kL) + k C_2 \\cos(kL) + C_3) = 0$。\n这简化为 $k^2 C_3 = 0$。对于非平凡解，$k \\neq 0$，因此 $C_3 = 0$。\n\n从 $C_3=0$ 和 $kC_2+C_3=0$，我们得出 $kC_2=0$，这意味着 $C_2=0$。\n当 $C_2=0$ 时，第三个条件简化为 $C_1 \\cos(kL) = 0$。\n对于非平凡的屈曲形状，我们必须至少有一个非零系数，因此我们要求 $C_1 \\neq 0$。所以，特征值的特征方程为：\n$$ \\cos(kL) = 0 $$\n解为 $kL = (2n-1)\\frac{\\pi}{2}$，其中 $n=1, 2, 3, \\ldots$。\n最小临界荷载对应于 $k$ 的最小正值，这在 $n=1$ 时出现：\n$$ k_1 L = \\frac{\\pi}{2} \\implies k_1 = \\frac{\\pi}{2L} $$\n于是，第一临界荷载 $P_{cr,1}$ 为：\n$$ P_{cr,1} = E I k_1^2 = EI \\left(\\frac{\\pi}{2L}\\right)^2 = \\frac{\\pi^2 EI}{4L^2} $$\n为了找到相应的屈曲模态振型，我们确定系数。我们有 $C_2=0$ 和 $C_3=0$。从 $C_1+C_4=0$，我们得到 $C_4=-C_1$。\n模态振型由下式给出：\n$$ y_1(x) = C_1 \\cos(k_1 x) + C_4 = C_1 \\cos\\left(\\frac{\\pi x}{2L}\\right) - C_1 = C_1 \\left(\\cos\\left(\\frac{\\pi x}{2L}\\right) - 1\\right) $$\n题目要求归一化，使得自由端的挠度为1，即 $y(L)=1$。\n$$ y_1(L) = C_1 \\left(\\cos\\left(\\frac{\\pi L}{2L}\\right) - 1\\right) = C_1 \\left(\\cos\\left(\\frac{\\pi}{2}\\right) - 1\\right) = C_1(0 - 1) = -C_1 $$\n设 $y_1(L)=1$ 得到 $-C_1=1$，所以 $C_1 = -1$。\n归一化后的第一屈曲模态振型是：\n$$ y_1(x) = -1 \\left(\\cos\\left(\\frac{\\pi x}{2L}\\right) - 1\\right) = 1 - \\cos\\left(\\frac{\\pi x}{2L}\\right) $$\n该表达式是一个简单的三角函数，表示一个平移和反转的余弦曲线段，它属于正弦族函数。\n\n所求的两个量是最小临界荷载和相关的归一化模态振型。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\pi^2 EI}{4L^2} & 1 - \\cos\\left(\\frac{\\pi x}{2L}\\right) \\end{pmatrix} } $$", "id": "2620907"}, {"introduction": "理想柱的突变式屈曲在真实世界中很少发生，因为结构总是存在初始缺陷。本练习将探讨一个更贴近实际的场景：一个具有初始弯曲的简支柱，其初始形状为正弦半波。你的任务是运用能量法，推导出载荷与挠度之间的关系，揭示当施加的载荷 $P$ 趋近于欧拉临界载荷 $P_{cr}$ 时，挠度是如何被放大的，这是结构设计中一个核心的放大效应概念。[@problem_id:2885504]", "problem": "一根长度为 $L$、抗弯刚度为常数 $E I$ 的直的等截面两端铰接柱，在其两端铰接点的形心轴上承受轴向压缩荷载 $P$。该柱具有一个微小的初始弯曲（非直线度），由 $y_{0}(x)=\\delta_{0}\\sin\\!\\left(\\frac{\\pi x}{L}\\right)$ 描述，其中 $\\delta_{0}\\ll L$。假设小斜率并采用一阶几何近似。设荷载引起的附加挠度由与铰接边界条件一致的单个容许函数 $y(x)=a\\sin\\!\\left(\\frac{\\pi x}{L}\\right)$ 表示，因此总横向挠度为 $w(x)=y_{0}(x)+y(x)$。\n\n仅从弯曲应变能和轴向压缩力在端部缩短下所做功的基本定义出发，将引起弯曲应力的曲率取为相对于无应力初始缺陷形状的曲率变化，并使用经典的小斜率表达式来近似端部缩短。使用关于振幅 $a$ 的能量最小化原理，推导：\n- 由轴向荷载 $P$ 作用于挠曲形状上所产生的一阶弯矩分布 $M(x)$，以及\n- 连接跨中挠度幅值与 $P$ 和初始缺陷幅值 $\\delta_{0}$ 的修正荷载-挠度关系。\n\n仅提供总跨中挠度 $w(L/2)$ 作为 $P$, $E$, $I$, $L$ 和 $\\delta_{0}$ 函数的最终闭合形式表达式。不要代入数值，也不要简化为数值近似值。", "solution": "用户提交了一个材料力学领域的问题，内容是关于一个有缺陷的柱在轴向压缩下的行为。在尝试求解之前，需要对问题陈述进行验证。\n\n步骤1：提取已知条件\n- 柱的几何形状与性质：直的、等截面、两端铰接、长度为 $L$、恒定抗弯刚度为 $EI$。\n- 荷载：作用于形心的轴向压缩荷载 $P$。\n- 初始缺陷：$y_{0}(x)=\\delta_{0}\\sin\\!\\left(\\frac{\\pi x}{L}\\right)$，其中 $\\delta_{0}\\ll L$。\n- 假设：小斜率，一阶几何近似。\n- 假定的挠度形状：总挠度 $w(x)=y_{0}(x)+y(x)$，其中荷载引起的挠度为 $y(x)=a\\sin\\!\\left(\\frac{\\pi x}{L}\\right)$。\n- 方法：对振幅 $a$ 进行能量最小化。应变能基于相对于初始缺陷形状的曲率变化。轴向力的功基于使用经典小斜率表达式计算的端部缩短。\n- 要求输出：一阶弯矩分布 $M(x)$ 和荷载-挠度关系。最终答案应为总跨中挠度 $w(L/2)$ 的闭合形式表达式。\n- 最终答案格式：表示为 $P$, $E$, $I$, $L$ 和 $\\delta_{0}$ 的函数。问题文本中包含一条声明“以米为单位表示最终挠度”，此声明已被注意到，但应服从最终答案框中禁止使用单位的全局格式化规则。\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，植根于经典的弹性稳定性和结构力学理论。它提出了一个将 Euler 屈曲问题扩展到非理想柱的标准问题，这是一个基础课题。该问题是适定的，提供了所有必要的物理参数（$L$、$EI$、$P$）、初始条件（缺陷 $y_0(x)$）、边界条件（两端铰接，这由假定的正弦挠度形状隐含地满足了），以及清晰的求解方法（能量最小化）。其语言客观而精确。此问题并非无足轻重，需要正确应用总势能原理。它是完整的、一致的、可解的。\n\n步骤3：结论与行动\n问题有效。将推导其解。\n\n总势能原理指出，对于处于平衡状态的弹性系统，总势能 $\\Pi$ 为驻值。对于稳定平衡，$\\Pi$ 必须为最小值。总势能是储存在柱中的应变能 $U$ 与外部施加载荷的势能 $\\Omega$ 之和。\n$$\n\\Pi = U + \\Omega\n$$\n当 $\\frac{d\\Pi}{da} = 0$ 时，系统处于平衡状态，其中 $a$ 是附加挠度的振幅。\n\n首先，我们计算弯曲应变能 $U$。问题指明，引起应力的曲率是相对于初始无应力状态的曲率变化。初始曲率为 $\\kappa_0(x) = y_0''(x)$，最终曲率为 $\\kappa(x) = w''(x)$。曲率变化为 $\\Delta\\kappa(x) = \\kappa(x) - \\kappa_0(x) = w''(x) - y_0''(x)$。\n给定 $w(x) = y_0(x) + y(x)$，曲率变化就是 $\\Delta\\kappa(x) = y''(x)$。\n应变能由下式给出：\n$$\nU = \\frac{1}{2} \\int_0^L EI (\\Delta\\kappa(x))^2 dx = \\frac{1}{2} \\int_0^L EI (y''(x))^2 dx\n$$\n对于假定的附加挠度 $y(x) = a\\sin\\left(\\frac{\\pi x}{L}\\right)$，其二阶导数为 $y''(x) = -a\\left(\\frac{\\pi}{L}\\right)^2\\sin\\left(\\frac{\\pi x}{L}\\right)$。\n将其代入 $U$ 的表达式中：\n$$\nU = \\frac{1}{2} \\int_0^L EI \\left[-a\\left(\\frac{\\pi}{L}\\right)^2\\sin\\left(\\frac{\\pi x}{L}\\right)\\right]^2 dx = \\frac{EI a^2 \\pi^4}{2L^4} \\int_0^L \\sin^2\\left(\\frac{\\pi x}{L}\\right) dx\n$$\n该积分的值为 $\\int_0^L \\sin^2\\left(\\frac{\\pi x}{L}\\right) dx = \\frac{L}{2}$。\n因此，应变能为：\n$$\nU = \\frac{EI a^2 \\pi^4}{2L^4} \\left(\\frac{L}{2}\\right) = \\frac{EI \\pi^4 a^2}{4L^3}\n$$\n接下来，我们计算轴向荷载 $P$ 的势能，即 $\\Omega = -W$，其中 $W$ 是荷载所做的功。功是力 $P$ 与由附加挠度 $y(x)$ 引起的柱的轴向缩短量 $\\Delta S$ 的乘积。端部缩短变化的经典小斜率近似为：\n$$\n\\Delta S = \\frac{1}{2}\\int_0^L (w'(x))^2 dx - \\frac{1}{2}\\int_0^L (y_0'(x))^2 dx\n$$\n我们有 $y_0(x) = \\delta_0 \\sin(\\frac{\\pi x}{L})$ 和 $w(x) = (\\delta_0 + a)\\sin(\\frac{\\pi x}{L})$。其导数为：\n$y_0'(x) = \\delta_0 \\frac{\\pi}{L}\\cos(\\frac{\\pi x}{L})$ 和 $w'(x) = (\\delta_0 + a)\\frac{\\pi}{L}\\cos(\\frac{\\pi x}{L})$。\n将这些代入 $\\Delta S$ 的表达式中：\n$$\n\\Delta S = \\frac{1}{2} \\left(\\frac{\\pi}{L}\\right)^2 \\left[ (\\delta_0 + a)^2 - \\delta_0^2 \\right] \\int_0^L \\cos^2\\left(\\frac{\\pi x}{L}\\right) dx\n$$\n该积分的值为 $\\int_0^L \\cos^2\\left(\\frac{\\pi x}{L}\\right) dx = \\frac{L}{2}$。方括号中的项简化为 $(\\delta_0^2 + 2a\\delta_0 + a^2) - \\delta_0^2 = 2a\\delta_0 + a^2$。\n$$\n\\Delta S = \\frac{1}{2} \\left(\\frac{\\pi}{L}\\right)^2 (2a\\delta_0 + a^2) \\left(\\frac{L}{2}\\right) = \\frac{\\pi^2}{4L}(2a\\delta_0 + a^2)\n$$\n荷载的势能为 $\\Omega = -P \\Delta S = -P\\frac{\\pi^2}{4L}(a^2 + 2a\\delta_0)$。\n\n总势能 $\\Pi$ 作为 $a$ 的函数是：\n$$\n\\Pi(a) = U + \\Omega = \\frac{EI \\pi^4 a^2}{4L^3} - P\\frac{\\pi^2}{4L}(a^2 + 2a\\delta_0)\n$$\n为了找到平衡状态，我们对 $\\Pi(a)$ 关于 $a$ 取最小值：\n$$\n\\frac{d\\Pi}{da} = \\frac{d}{da} \\left[ \\frac{EI \\pi^4 a^2}{4L^3} - P\\frac{\\pi^2}{4L}(a^2 + 2a\\delta_0) \\right] = 0\n$$\n$$\n\\frac{EI \\pi^4 (2a)}{4L^3} - P\\frac{\\pi^2}{4L}(2a + 2\\delta_0) = 0\n$$\n$$\n\\frac{EI \\pi^4 a}{2L^3} - \\frac{P \\pi^2 (a + \\delta_0)}{2L} = 0\n$$\n乘以 $\\frac{2L}{\\pi^2}$ 得：\n$$\n\\frac{EI \\pi^2 a}{L^2} - P(a + \\delta_0) = 0\n$$\n我们认出这是两端铰接柱的 Euler 临界屈曲荷载 $P_E = \\frac{\\pi^2 EI}{L^2}$。代入此定义：\n$$\nP_E a - Pa - P\\delta_0 = 0\n$$\n$$\na(P_E - P) = P\\delta_0 \\implies a = \\frac{P\\delta_0}{P_E - P}\n$$\n此表达式给出了附加挠度的振幅 $a$。\n\n总挠度为 $w(x) = y_0(x) + y(x) = (\\delta_0+a)\\sin(\\frac{\\pi x}{L})$。总跨中挠度为 $w_{mid} = w(L/2) = \\delta_0 + a$。\n代入 $a$ 的表达式：\n$$\nw(L/2) = \\delta_0 + \\frac{P\\delta_0}{P_E - P} = \\delta_0 \\left(1 + \\frac{P}{P_E - P}\\right) = \\delta_0 \\left(\\frac{P_E - P + P}{P_E - P}\\right) = \\frac{\\delta_0 P_E}{P_E - P}\n$$\n这可以写成荷载-挠度关系：\n$$\nw(L/2) = \\frac{\\delta_0}{1 - P/P_E}\n$$\n这表明，总跨中挠度是初始跨中挠度被一个放大因子所放大，当施加的荷载 $P$ 接近 Euler 临界荷载 $P_E$ 时，该因子趋于无穷大。\n\n弯矩分布由轴向荷载乘以总横向挠度给出：$M(x) = -P w(x)$。\n$$\nM(x) = -P \\left( \\frac{\\delta_0}{1 - P/P_E} \\right) \\sin\\left(\\frac{\\pi x}{L}\\right)\n$$\n问题要求以给定参数 $P, E, I, L, \\delta_0$ 表示 $w(L/2)$ 的最终闭合形式表达式。我们代入 $P_E$ 的表达式：\n$$\nw(L/2) = \\frac{\\delta_0}{1 - P \\left/ \\left(\\frac{\\pi^2 EI}{L^2}\\right) \\right.} = \\frac{\\delta_0}{1 - \\frac{PL^2}{\\pi^2 EI}} = \\frac{\\delta_0}{\\frac{\\pi^2 EI - PL^2}{\\pi^2 EI}}\n$$\n这可简化为最终表达式。结果的单位将与 $\\delta_0$ 的单位相同，这是自明的。如果输入采用国际单位制（SI），则输出将以米为单位。\n$$\nw(L/2) = \\frac{\\delta_0 \\pi^2 EI}{\\pi^2 EI - PL^2}\n$$", "answer": "$$\\boxed{\\frac{\\delta_{0} \\pi^{2} EI}{\\pi^{2} EI - PL^{2}}}$$", "id": "2885504"}, {"introduction": "虽然解析解为理解屈曲现象提供了坚实的基础，但现代工程实践广泛依赖于数值方法来解决复杂问题。本练习要求你编写一个程序，使用有限元法（FEM）来模拟一个简支柱的屈曲行为。通过将连续的结构离散化为一系列梁单元，你将构建并求解一个广义特征值问题 $K \\phi = P G \\phi$，从而计算出数值屈曲荷载并研究其随着网格加密而收敛到精确解的过程。[@problem_id:2620892]", "problem": "考虑一根长度为 $L$ 的直棱柱，由线性弹性材料制成，其杨氏模量为 $E$，截面二次矩为 $I$。该柱被理想化为一根 Euler-Bernoulli 梁，两端均为铰接（简支）。该柱沿其形心轴承受一个未知的均布轴向压缩荷载 $P$。第一（最小正值）临界屈曲荷载对应于平凡构型的失稳，其源于总势能二阶变分的驻定性。从 Euler-Bernoulli 梁的小挠度运动学和最小势能原理出发，可以写出双线性形式，当使用有限元法（FEM）将柱离散为 $n$ 个等长的两节点 Euler-Bernoulli 单元时，该双线性形式将导出一个对称的广义特征值问题。对于两端铰接的柱，其本质边界条件是两端横向挠度为零，而端点转动是自由的。\n\n你的任务是编写一个完整的程序，该程序：\n- 将柱离散为 $n$ 个等长的 Euler-Bernoulli 梁单元，每个节点有两个自由度（横向位移 $w$ 和转角 $\\theta$）。\n- 以产生 $K \\phi = P \\, G \\phi$ 形式的对称广义特征值问题的形式，组装全局弹性刚度矩阵和全局几何刚度算子，其中 $K$ 取决于 $E$、$I$ 和单元长度，而 $G$ 与 $P$ 无关，仅取决于单元长度。\n- 通过在两个端点节点处施加零横向位移，同时保持端点转动自由，来施加铰接-铰接边界条件。\n- 对于每个指定的单元数 $n$，求解组装后系统的最小正特征值 $P_n$（离散的第一临界荷载）。\n\n在国际单位制（SI）下使用以下参数值：\n- $E = 210 \\times 10^9 \\,\\text{Pa}$，\n- $I = 8.1 \\times 10^{-6} \\,\\text{m}^4$，\n- $L = 2.0 \\,\\text{m}$。\n\n对于下面测试套件中的每个 $n$，计算离散屈曲荷载 $P_n$ 相对于固定的 $E$、$I$ 和 $L$ 的精确理论所定义的解析第一屈曲荷载 $P_{\\text{cr}}$ 的相对误差：\n- 对于每个 $n$，将值 $|P_n - P_{\\text{cr}}|/P_{\\text{cr}}$ 报告为一个无量纲实数。\n\n测试套件（等长单元数 $n$）：\n- $n \\in \\{1,2,4,8,16,32\\}$。\n\n最终输出格式：\n- 你的程序应产生单行输出，其中包含一个逗号分隔的浮点值列表，用方括号括起来，并根据测试套件排序，每个值四舍五入到 $8$ 位小数（例如：`[0.12345678,0.00123456,0.00000042]`）。", "solution": "所述问题是计算力学中一个适定（well-posed）的练习，具体涉及有限元法（FEM）在线性屈曲分析中的应用。该问题在科学上是合理的、自洽的，并且没有歧义。因此，我们将着手解决它。\n\n目标是使用有限元模型确定一个两端铰接柱的第一临界屈曲荷载，并分析随着网格细化，数值解收敛到精确解析解的情况。\n\n首先，我们为分析建立基准：解析解。均匀 Euler-Bernoulli 柱在轴向压缩荷载 $P$ 作用下屈曲的控制微分方程为：\n$$ EI \\frac{d^4w(x)}{dx^4} + P \\frac{d^2w(x)}{dx^2} = 0 $$\n其中 $w(x)$ 是横向位移，$E$ 是杨氏模量，$I$ 是截面二次矩。对于长度为 $L$ 且在两端（$x=0$ 和 $x=L$）铰接的柱，其边界条件是两端位移和弯矩均为零：\n$$ w(0) = 0, \\quad w''(0) = 0 $$\n$$ w(L) = 0, \\quad w''(L) = 0 $$\n此边值问题的非平凡解产生临界屈曲荷载。能够存在非平凡屈曲形状的最小正荷载是第一临界荷载 $P_{\\text{cr}}$，由经典的 Euler 公式给出：\n$$ P_{\\text{cr}} = \\frac{\\pi^2 EI}{L^2} $$\n使用给定的参数，$E = 210 \\times 10^9 \\,\\text{Pa}$，$I = 8.1 \\times 10^{-6} \\,\\text{m}^4$ 和 $L = 2.0 \\,\\text{m}$，精确的临界荷载为：\n$$ P_{\\text{cr}} = \\frac{\\pi^2 (210 \\times 10^9 \\,\\text{Pa}) (8.1 \\times 10^{-6} \\,\\text{m}^4)}{(2.0 \\,\\text{m})^2} \\approx 4.1954 \\times 10^6 \\,\\text{N} $$\n该值将作为我们比较数值结果的参考。\n\n接下来，我们构建有限元法解。柱被离散为 $n$ 个相同的 Euler-Bernoulli 梁单元，每个单元长度为 $h = L/n$。每个单元有两个节点，每个节点拥有两个自由度（DOF）：一个横向位移 $w$ 和一个转角 $\\theta = dw/dx$。连接节点 $i$ 和 $j$ 的单元节点位移向量为 $\\mathbf{d}^e = [w_i, \\theta_i, w_j, \\theta_j]^T$。\n\n使用有限元法进行稳定性分析会得到一个广义对称特征值问题：\n$$ \\mathbf{K} \\mathbf{D} = P \\mathbf{G} \\mathbf{D} $$\n此处，$\\mathbf{K}$ 是全局弹性刚度矩阵，代表由弯曲引起的应变能；$\\mathbf{G}$ 是全局几何刚度矩阵（或稳定性矩阵），代表轴向力 $P$ 在屈曲过程中所做的功。该系统的特征值是临界荷载 $P$，特征向量 $\\mathbf{D}$ 是相应的屈曲模态。\n\n对于单个长度为 $h$ 的单元，其单元弹性刚度矩阵 $\\mathbf{k}^e$ 由下式给出：\n$$ \\mathbf{k}^e = \\frac{EI}{h^3} \\begin{bmatrix} 12 & 6h & -12 & 6h \\\\ 6h & 4h^2 & -6h & 2h^2 \\\\ -12 & -6h & 12 & -6h \\\\ 6h & 2h^2 & -6h & 4h^2 \\end{bmatrix} $$\n单元几何刚度矩阵 $\\mathbf{g}^e$ 为：\n$$ \\mathbf{g}^e = \\frac{1}{30h} \\begin{bmatrix} 36 & 3h & -36 & 3h \\\\ 3h & 4h^2 & -3h & -h^2 \\\\ -36 & -3h & 36 & -3h \\\\ 3h & -h^2 & -3h & 4h^2 \\end{bmatrix} $$\n对于一个由 $n$ 个单元和 $n+1$ 个节点（总自由度为 $2(n+1)$）组成的系统，全局矩阵 $\\mathbf{K}$ 和 $\\mathbf{G}$ 是通过根据单元连接性将每个单元矩阵的贡献累加到相应的全局位置来组装的。\n\n铰接-铰接柱的边界条件是 $w(0) = 0$ 和 $w(L) = 0$。在我们的离散模型中，这转化为在第一个节点（节点1）和最后一个节点（节点 $n+1$）处施加零位移。这些节点的转动自由度保持自由。我们通过从 $\\mathbf{K}$ 和 $\\mathbf{G}$ 中移除与这些指定的零位移自由度相对应的行和列来施加这些本质边界条件。这会减小矩阵系统的规模。对于一个总自由度为 $2(n+1)$ 的系统，我们移除了两个自由度，从而得到一个规模为 $2n \\times 2n$ 的简化系统。\n\n计算过程如下：\n1. 对于测试套件 $\\{1, 2, 4, 8, 16, 32\\}$ 中的每个 $n$ 值，计算单元长度 $h = L/n$。\n2. 使用计算出的 $h$ 和给定的 $E$ 和 $I$ 构建单元矩阵 $\\mathbf{k}^e$ 和 $\\mathbf{g}^e$。\n3. 初始化大小为 $2(n+1) \\times 2(n+1)$ 的全局矩阵 $\\mathbf{K}$ 和 $\\mathbf{G}$，并用零填充。\n4. 通过遍历所有 $n$ 个单元，并将其各自的 $\\mathbf{k}^e$ 和 $\\mathbf{g}^e$ 矩阵加到 $\\mathbf{K}$ 和 $\\mathbf{G}$ 的正确位置，来组装全局矩阵。\n5. 通过创建简化矩阵 $\\mathbf{K}_{\\text{red}}$ 和 $\\mathbf{G}_{\\text{red}}$ 来应用铰接-铰接边界条件。这是通过删除与第一个和最后一个节点的横向位移自由度相对应的行和列来完成的。\n6. 求解简化的广义特征值问题 $\\mathbf{K}_{\\text{red}} \\mathbf{D}_{\\text{red}} = P \\mathbf{G}_{\\text{red}} \\mathbf{D}_{\\text{red}}$ 以获得其特征值。我们使用适合对称矩阵的数值库函数。\n7. 获得的最小正特征值是第一个数值屈曲荷载 $P_n$。\n8. 计算解析临界荷载 $P_{\\text{cr}} = \\pi^2 EI/L^2$。\n9. 计算每个 $n$ 的相对误差：$\\epsilon_n = |P_n - P_{\\text{cr}}|/P_{\\text{cr}}$。\n10. 按指定格式报告相对误差的结果列表。\n\n此过程将展示随着单元数 $n$ 的增加，有限元解如何收敛于精确的解析解。正如对此类问题的近似理论所预期的，数值模型过于刚硬，因此 $P_n$ 将从上方逼近 $P_{\\text{cr}}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Computes the relative error of the FEM buckling load for a pinned-pinned column\n    with respect to the analytical Euler buckling load for various mesh densities.\n    \"\"\"\n    # Define physical and material constants in SI units\n    E = 210e9  # Young's modulus in Pa\n    I = 8.1e-6  # Second moment of area in m^4\n    L = 2.0  # Length of the column in m\n\n    # Define the test suite for the number of elements\n    test_cases_n = [1, 2, 4, 8, 16, 32]\n\n    # Calculate the analytical first critical buckling load (P_cr)\n    P_cr = (np.pi**2 * E * I) / (L**2)\n\n    results = []\n\n    for n in test_cases_n:\n        # Step 1: Define element properties\n        h = L / n  # Length of one element\n\n        # Step 2: Define the element elastic stiffness matrix (ke)\n        # ke = (E*I/h**3) * ...\n        ke_factor = (E * I) / (h**3)\n        ke = ke_factor * np.array([\n            [12, 6 * h, -12, 6 * h],\n            [6 * h, 4 * h**2, -6 * h, 2 * h**2],\n            [-12, -6 * h, 12, -6 * h],\n            [6 * h, 2 * h**2, -6 * h, 4 * h**2]\n        ])\n\n        # Step 3: Define the element geometric stiffness matrix (ge)\n        # ge = (1/(30*h)) * ...\n        ge_factor = 1 / (30 * h)\n        ge = ge_factor * np.array([\n            [36, 3 * h, -36, 3 * h],\n            [3 * h, 4 * h**2, -3 * h, -h**2],\n            [-36, -3 * h, 36, -3 * h],\n            [3 * h, -h**2, -3 * h, 4 * h**2]\n        ])\n        \n        # Step 4: Assemble the global matrices K and G\n        num_nodes = n + 1\n        num_dofs = 2 * num_nodes\n        K = np.zeros((num_dofs, num_dofs))\n        G = np.zeros((num_dofs, num_dofs))\n\n        for i in range(n):\n            # Determine the global DOFs for the current element\n            dof_indices = np.array([2*i, 2*i + 1, 2*(i+1), 2*(i+1) + 1])\n            # Use np.ix_ to facilitate adding the element matrix to the global matrix\n            ix = np.ix_(dof_indices, dof_indices)\n            K[ix] += ke\n            G[ix] += ge\n\n        # Step 5: Apply boundary conditions (pinned-pinned)\n        # We enforce zero transverse displacement at the first and last nodes.\n        # This corresponds to DOF 0 (at node 0) and DOF 2*n (at node n).\n        # We remove the corresponding rows and columns from K and G.\n        \n        # DOFs to remove are the displacement DOFs at the ends.\n        # Using 0-based indexing: node 0's displacement is DOF 0.\n        # Node n's displacement is DOF 2*n.\n        dofs_to_remove = [0, 2*n]\n        \n        K_red = np.delete(K, dofs_to_remove, axis=0)\n        K_red = np.delete(K_red, dofs_to_remove, axis=1)\n\n        G_red = np.delete(G, dofs_to_remove, axis=0)\n        G_red = np.delete(G_red, dofs_to_remove, axis=1)\n\n        # Step 6: Solve the generalized eigenvalue problem K_red * v = P * G_red * v\n        # linalg.eigh returns eigenvalues in ascending order.\n        eigenvalues, eigenvectors = linalg.eigh(K_red, G_red)\n        \n        # The smallest positive eigenvalue is the first numerical buckling load, P_n.\n        P_n = eigenvalues[0]\n\n        # Step 7: Calculate the relative error\n        relative_error = abs(P_n - P_cr) / P_cr\n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{res:.8f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2620892"}]}