{"hands_on_practices": [{"introduction": "这个基础练习将引导您逐步了解准连续介质 (QC) 方法的核心机制。通过为一个简单的一维原子链计算总能量和节点力 [@problem_id:2923438]，您将直接体验基于柯西-玻恩 ($Cauchy–Born$) 规则的运动学插值和能量求和等基本步骤。掌握这一基础计算是理解和应用更复杂多尺度模型的第一步。", "problem": "考虑一个由 $9$ 个原子组成的一维链，原子索引为 $i=0,1,\\ldots,8$，其参考位置为 $X_i=i\\,a_0$，其中 $a_0>0$ 是参考最近邻间距。原子间的相互作用仅限于最近邻原子，通过一个仅依赖于当前键长 $r$ 的对势 $\\phi(r)$ 来描述。该链通过准连续 (QC) 方法进行粗粒化，使用一个双单元网格，其代表性原子（也称为 repatom）位于 $i=0,4,8$ 处，从而定义了两个单元：单元 $1$ 跨越 $[X_0,X_4]$，单元 $2$ 跨越 $[X_4,X_8]$。假设在每个单元中采用局部 Cauchy–Born 近似，并在代表性原子之间进行位移的线性插值，同时使用均匀权重求和规则，计算每个单元中所有的最近邻键。\n\n对势是关于 $a_0$ 的谐和势，即 $\\phi(r)=\\tfrac{1}{2}k\\,(r-a_0)^2$，其中刚度 $k>0$。设代表性原子的位移被指定为 $u_0=0$、$u_4=\\bar{u}$ 和 $u_8=2\\bar{u}$，其中 $\\bar{u}>0$ 是一个给定的常数。根据这些数据，QC 总势能定义为各单元贡献之和，每个单元的贡献通过计算其包含的 $4$ 个键的能量得到，每个键的变形都与该单元的线性位移场保持一致。\n\n从线性位移场引起的键长变化和 Cauchy–Born 关系的定义出发，推导出作为代表性原子位移函数的 QC 总能量 $E_{\\mathrm{QC}}(u)$。然后，使用具体数值 $k=100~\\mathrm{N/m}$、$a_0=2.5\\times 10^{-10}~\\mathrm{m}$ 和 $\\bar{u}=4.0\\times 10^{-11}~\\mathrm{m}$ 计算 $E_{\\mathrm{QC}}(u)$。最后，通过在给定位移下求微分 $\\mathbf{F}=-\\nabla E_{\\mathrm{QC}}(u)$，得到代表性原子上的内部节点力，并报告其三个分量 $F_0$、$F_4$ 和 $F_8$。\n\n答案规格：\n- 能量以 $\\mathrm{J}$ 为单位，力以 $\\mathrm{N}$ 为单位表示。\n- 所有报告的量均四舍五入至三位有效数字。\n- 以单行矩阵的形式提供最终答案，矩阵中依次包含 $E_{\\mathrm{QC}}(u)$、$F_0$、$F_4$ 和 $F_8$。", "solution": "首先对问题陈述进行验证。\n\n步骤 1：提取已知条件。\n- 一个由 $9$ 个原子组成的一维链，索引为 $i=0,1,\\ldots,8$。\n- 参考位置：$X_i=i\\,a_0$，晶格常数 $a_0>0$。\n- 相互作用势：最近邻谐和对势 $\\phi(r)=\\tfrac{1}{2}k\\,(r-a_0)^2$，刚度 $k>0$。\n- 粗粒化：准连续 (QC) 方法，代表性原子（repatom）位于索引 $0$、$4$ 和 $8$ 处。\n- 网格：两个单元，单元 $1$ 覆盖 $[X_0, X_4]$，单元 $2$ 覆盖 $[X_4, X_8]$。\n- 近似：局部 Cauchy–Born 准则及位移的线性插值。\n- 求和规则：均匀权重求和，每个单元计算 $4$ 个键。\n- 给定位移：$u_0=0$、$u_4=\\bar{u}$、$u_8=2\\bar{u}$。\n- 常数：$k=100~\\mathrm{N/m}$、$a_0=2.5\\times 10^{-10}~\\mathrm{m}$、$\\bar{u}=4.0\\times 10^{-11}~\\mathrm{m}$。\n- 要求输出：总 QC 能量 $E_{\\mathrm{QC}}(u)$ 和节点力 $F_0$、$F_4$、$F_8$，数值结果四舍五入至三位有效数字。\n\n步骤 2：使用提取的已知条件进行验证。\n该问题具有科学依据，因为它描述了准连续方法的标准应用，这是一种计算材料科学中成熟的多尺度技术。使用谐和势对应于线性弹性极限，而 Cauchy-Born 近似是该方法的一个基本原则。该问题是适定的；它提供了所有必要的数据、参数和边界条件，以得出一个唯一且有意义的解。定义清晰、自洽且一致。例如，单元 1 的域 $[X_0, X_4]$ 包含原子 $0, 1, 2, 3, 4$，因此包含四个最近邻键 $(0,1), (1,2), (2,3), (3,4)$，这与指定的 $4$ 个键的数量一致。单元 2 也是如此。这些数值对于一个原子系统来说是物理上合理的。该问题不违反任何无效标准。\n\n步骤 3：结论与行动。\n问题有效。将推导解答。\n\nQC 总能量 $E_{\\mathrm{QC}}(u)$ 的推导。\n总能量是两个单元能量之和，$E_{\\mathrm{QC}} = E^{(1)} + E^{(2)}$。\n\n对于跨越代表性原子 $0$ 和 $4$ 的单元 $1$，参考长度为 $L_1 = X_4 - X_0 = 4a_0$。对于 $X \\in [X_0, X_4]$，位移场 $u(X)$ 假设为线性：\n$$u(X) = u_0 \\left(1 - \\frac{X-X_0}{L_1}\\right) + u_4 \\left(\\frac{X-X_0}{L_1}\\right)$$\n宏观形变梯度 $F$ 在单元内是恒定的，由 $F = 1 + du/dX$ 给出。\n$$F^{(1)} = 1 + \\frac{u_4 - u_0}{X_4 - X_0} = 1 + \\frac{u_4 - u_0}{4a_0}$$\n根据局部 Cauchy–Born 近似，单元中的每个键都根据这个宏观梯度变形。变形后的键长 $r^{(1)}$ 为：\n$$r^{(1)} = F^{(1)} a_0 = \\left(1 + \\frac{u_4 - u_0}{4a_0}\\right) a_0 = a_0 + \\frac{u_4 - u_0}{4}$$\n储存在单个此类键中的能量是：\n$$\\phi(r^{(1)}) = \\frac{1}{2}k(r^{(1)} - a_0)^2 = \\frac{1}{2}k\\left(\\frac{u_4 - u_0}{4}\\right)^2$$\n单元 $1$ 包含 $4$ 个键。使用均匀权重求和规则，单元 $1$ 的能量为：\n$$E^{(1)} = 4 \\times \\phi(r^{(1)}) = 4 \\times \\frac{1}{2}k\\frac{(u_4 - u_0)^2}{16} = \\frac{k}{8}(u_4 - u_0)^2$$\n同样，对于跨越代表性原子 $4$ 和 $8$、参考长度为 $L_2 = X_8 - X_4 = 4a_0$ 的单元 $2$：\n$$F^{(2)} = 1 + \\frac{u_8 - u_4}{X_8 - X_4} = 1 + \\frac{u_8 - u_4}{4a_0}$$\n$$r^{(2)} = F^{(2)} a_0 = a_0 + \\frac{u_8 - u_4}{4}$$\n同样包含 $4$ 个键的单元 $2$ 的能量为：\n$$E^{(2)} = 4 \\times \\frac{1}{2}k(r^{(2)} - a_0)^2 = \\frac{k}{8}(u_8 - u_4)^2$$\n总 QC 能量是各单元能量之和：\n$$E_{\\mathrm{QC}}(u_0, u_4, u_8) = E^{(1)} + E^{(2)} = \\frac{k}{8}(u_4 - u_0)^2 + \\frac{k}{8}(u_8 - u_4)^2$$\n\n能量的数值计算。\n代入给定的位移 $u_0=0$、$u_4=\\bar{u}$ 和 $u_8=2\\bar{u}$：\n$$E_{\\mathrm{QC}} = \\frac{k}{8}(\\bar{u} - 0)^2 + \\frac{k}{8}(2\\bar{u} - \\bar{u})^2 = \\frac{k}{8}\\bar{u}^2 + \\frac{k}{8}\\bar{u}^2 = \\frac{k}{4}\\bar{u}^2$$\n使用给定值 $k=100~\\mathrm{N/m}$ 和 $\\bar{u}=4.0\\times 10^{-11}~\\mathrm{m}$：\n$$E_{\\mathrm{QC}} = \\frac{100~\\mathrm{N/m}}{4} (4.0\\times 10^{-11}~\\mathrm{m})^2 = (25~\\mathrm{N/m}) \\times (16.0 \\times 10^{-22}~\\mathrm{m}^2) = 400 \\times 10^{-22}~\\mathrm{J} = 4.0 \\times 10^{-20}~\\mathrm{J}$$\n四舍五入至三位有效数字，能量为 $E_{\\mathrm{QC}} = 4.00 \\times 10^{-20}~\\mathrm{J}$。\n\n节点力的推导与计算。\n代表性原子上的内力由总势能的负梯度给出，$\\mathbf{F} = -\\nabla E_{\\mathrm{QC}}(u)$。其分量为 $F_i = -\\partial E_{\\mathrm{QC}} / \\partial u_i$。\n$$F_0 = -\\frac{\\partial E_{\\mathrm{QC}}}{\\partial u_0} = -\\frac{k}{8} \\cdot 2(u_4-u_0)(-1) = \\frac{k}{4}(u_4 - u_0)$$\n$$F_8 = -\\frac{\\partial E_{\\mathrm{QC}}}{\\partial u_8} = -\\frac{k}{8} \\cdot 2(u_8-u_4)(1) = -\\frac{k}{4}(u_8 - u_4)$$\n$$F_4 = -\\frac{\\partial E_{\\mathrm{QC}}}{\\partial u_4} = -\\left[ \\frac{k}{8} \\cdot 2(u_4-u_0)(1) + \\frac{k}{8} \\cdot 2(u_8-u_4)(-1) \\right] = -\\frac{k}{4}\\left[ (u_4-u_0) - (u_8-u_4) \\right] = -\\frac{k}{4}(2u_4 - u_0 - u_8)$$\n代入给定的位移 ($u_0=0, u_4=\\bar{u}, u_8=2\\bar{u}$) 和数值：\n$$F_0 = \\frac{k}{4}(\\bar{u} - 0) = \\frac{k}{4}\\bar{u} = \\frac{100}{4}(4.0\\times 10^{-11}) = 25 \\times 4.0\\times 10^{-11} = 100 \\times 10^{-11}~\\mathrm{N} = 1.0 \\times 10^{-9}~\\mathrm{N}$$\n保留三位有效数字，$F_0 = 1.00 \\times 10^{-9}~\\mathrm{N}$。\n\n$$F_8 = -\\frac{k}{4}(2\\bar{u} - \\bar{u}) = -\\frac{k}{4}\\bar{u} = -1.0 \\times 10^{-9}~\\mathrm{N}$$\n保留三位有效数字，$F_8 = -1.00 \\times 10^{-9}~\\mathrm{N}$。\n\n$$F_4 = -\\frac{k}{4}(2\\bar{u} - 0 - 2\\bar{u}) = -\\frac{k}{4}(0) = 0~\\mathrm{N}$$\n力 $F_4$ 恰好为零，因为两个单元的应变是均匀的。均匀应变意味着单元 1 对代表性原子 4 施加的力与单元 2 对代表性原子 4 施加的力大小相等、方向相反。其值恰好为 $0$。\n\n最终结果为 $E_{\\mathrm{QC}} = 4.00 \\times 10^{-20}~\\mathrm{J}$，$F_0 = 1.00 \\times 10^{-9}~\\mathrm{N}$，$F_4 = 0~\\mathrm{N}$ 及 $F_8 = -1.00 \\times 10^{-9}~\\mathrm{N}$。", "answer": "$$\\boxed{\\begin{pmatrix} 4.00 \\times 10^{-20} & 1.00 \\times 10^{-9} & 0 & -1.00 \\times 10^{-9} \\end{pmatrix}}$$", "id": "2923438"}, {"introduction": "QC 方法的准确性取决于其运动学假设，特别是对简单插值函数的使用。本练习 [@problem_id:2923417] 要求您量化当使用线性插值方案来近似一个更复杂的非线性变形场时所产生的误差。通过为一个二维有限元内的原子显式计算这种*运动学误差*，您将对该方法的内在局限性和不准确性的来源形成批判性的理解。", "problem": "考虑一个二维六方（三角）Bravais晶格，其原胞基矢为 $\\mathbf{a}_{1} = (a, 0)$ 和 $\\mathbf{a}_{2} = \\left(\\frac{a}{2}, \\frac{\\sqrt{3}\\,a}{2}\\right)$，其中 $a>0$ 是晶格参数。在一个标准的准连续介质离散化中，考虑一个线性三节点三角形有限元，其顶点与三个晶格点位（代表性原子，也称为repatom）重合：\n$$\n\\mathbf{R}_{1} = (0,0), \\quad \\mathbf{R}_{2} = 2\\mathbf{a}_{1} = (2a, 0), \\quad \\mathbf{R}_{3} = 2\\mathbf{a}_{2} = \\left(a, \\sqrt{3}\\,a\\right).\n$$\n设原子位移场是二次的，\n$$\n\\mathbf{u}(\\mathbf{x}) = \\begin{pmatrix} u_{x}(\\mathbf{x}) \\\\ u_{y}(\\mathbf{x}) \\end{pmatrix} = \\begin{pmatrix} \\kappa\\,x^{2} \\\\ \\kappa\\,y^{2} \\end{pmatrix},\n$$\n其中 $\\kappa \\in \\mathbb{R}$ 是一个常数，且 $\\mathbf{x}=(x,y)$。代表性原子的节点位移取为 $\\mathbf{u}(\\mathbf{x})$ 在三个顶点 $\\mathbf{R}_{i}$ 处的精确值。对于单元中的任意原子 $\\mathbf{X}$，准连续介质运动学近似使用位移的线性有限元插值，\n$$\n\\mathbf{u}_{h}(\\mathbf{X}) = N_{1}(\\mathbf{X})\\,\\mathbf{u}(\\mathbf{R}_{1}) + N_{2}(\\mathbf{X})\\,\\mathbf{u}(\\mathbf{R}_{2}) + N_{3}(\\mathbf{X})\\,\\mathbf{u}(\\mathbf{R}_{3}),\n$$\n其中 $N_{i}$ 是三角形 $\\triangle \\mathbf{R}_{1}\\mathbf{R}_{2}\\mathbf{R}_{3}$ 上的标准重心形函数。\n\n(a) 列举出所有位于闭合三角形单元 $\\triangle \\mathbf{R}_{1}\\mathbf{R}_{2}\\mathbf{R}_{3}$ 内的晶格点位 $\\mathbf{X}$。\n\n(b) 根据三角形上重心坐标（形函数）的基本定义，显式计算所有这些原子的插值变形后位置 $\\mathbf{X} + \\mathbf{u}_{h}(\\mathbf{X})$。\n\n(c) 将原子处的逐点插值误差定义为 $\\mathbf{e}(\\mathbf{X}) = \\mathbf{u}(\\mathbf{X}) - \\mathbf{u}_{h}(\\mathbf{X})$。仅使用节点值和上述线性插值公式，计算该单元内所有原子上插值误差的最大欧几里得范数，\n$$\nE_{\\max} = \\max_{\\mathbf{X} \\in \\triangle \\mathbf{R}_{1}\\mathbf{R}_{2}\\mathbf{R}_{3} \\cap \\{\\text{晶格点位}\\}} \\|\\mathbf{e}(\\mathbf{X})\\|_{2}.\n$$\n\n用 $a$ 和 $\\kappa$ 的符号形式表达你的最终答案。最终表达式中不包含单位。", "solution": "在尝试解答之前，对问题陈述进行验证。\n\n步骤1：提取已知条件。\n- 一个二维六方Bravais晶格，其原胞基矢为 $\\mathbf{a}_{1} = (a, 0)$ 和 $\\mathbf{a}_{2} = \\left(\\frac{a}{2}, \\frac{\\sqrt{3}\\,a}{2}\\right)$，其中 $a>0$。\n- 一个线性三节点三角形有限元，其顶点（repatom）位于 $\\mathbf{R}_{1} = (0,0)$、$\\mathbf{R}_{2} = 2\\mathbf{a}_{1} = (2a, 0)$ 和 $\\mathbf{R}_{3} = 2\\mathbf{a}_{2} = \\left(a, \\sqrt{3}\\,a\\right)$。\n- 一个原子位移场由 $\\mathbf{u}(\\mathbf{x}) = \\begin{pmatrix} \\kappa\\,x^{2} \\\\ \\kappa\\,y^{2} \\end{pmatrix}$ 给出，对于 $\\mathbf{x}=(x,y)$ 和 $\\kappa \\in \\mathbb{R}$。\n- 节点位移是精确的：$\\mathbf{u}(\\mathbf{R}_{i})$。\n- 对于位于 $\\mathbf{X}$ 处的原子，准连续介质（QC）运动学近似（插值位移）为 $\\mathbf{u}_{h}(\\mathbf{X}) = \\sum_{i=1}^{3} N_{i}(\\mathbf{X})\\,\\mathbf{u}(\\mathbf{R}_{i})$，其中 $N_{i}$ 是标准重心形函数。\n- 目标是 (a) 列举闭合单元 $\\triangle \\mathbf{R}_{1}\\mathbf{R}_{2}\\mathbf{R}_{3}$ 内的所有晶格点位 $\\mathbf{X}$，(b) 计算插值变形后位置 $\\mathbf{X} + \\mathbf{u}_{h}(\\mathbf{X})$，以及 (c) 找到单元内所有原子的逐点插值误差的最大欧几里得范数，$E_{\\max} = \\max_{\\mathbf{X}} \\|\\mathbf{u}(\\mathbf{X}) - \\mathbf{u}_{h}(\\mathbf{X})\\|_{2}$。\n\n步骤2：验证。\n该问题具有科学依据，提法得当，且是客观的。它描述了计算材料科学领域内的一个标准计算，特别是在准连续介质方法的框架下。Bravais晶格、有限元插值和误差分析等概念都是基础性的，并且应用正确。所有必要的数据，包括晶格几何形状、单元顶点和位移场，都已提供，使得该问题自成体系且可解。不存在科学上的不准确、矛盾或模糊之处。\n\n步骤3：结论。\n该问题有效。将提供解答。\n\n解决方案通过系统地处理问题的每个部分来进行。\n\n(a) 列举晶格点位\n六方晶格中一个原子的一般位置由 $\\mathbf{X} = n_{1}\\mathbf{a}_{1} + n_{2}\\mathbf{a}_{2}$ 给出，其中 $n_{1}, n_{2} \\in \\mathbb{Z}$。在笛卡尔坐标系中，此位置为 $\\mathbf{X}(n_{1}, n_{2}) = (x,y) = \\left(n_{1}a + n_{2}\\frac{a}{2}, n_{2}\\frac{\\sqrt{3}a}{2}\\right)$。\n三角形单元的顶点为 $\\mathbf{R}_{1}=(0,0)$、$\\mathbf{R}_{2}=(2a,0)$ 和 $\\mathbf{R}_{3}=(a, \\sqrt{3}a)$。\n一个位于 $\\mathbf{X}(x,y)$ 的原子在闭合三角形 $\\triangle \\mathbf{R}_{1}\\mathbf{R}_{2}\\mathbf{R}_{3}$ 内部，如果它满足定义该三角形边界的以下三个线性不等式：\n1.  边 $\\mathbf{R}_{1}\\mathbf{R}_{2}$：$y \\geq 0$\n2.  边 $\\mathbf{R}_{1}\\mathbf{R}_{3}$：$y \\leq \\sqrt{3}x$\n3.  边 $\\mathbf{R}_{2}\\mathbf{R}_{3}$：$y \\leq -\\sqrt{3}(x-2a)$，或 $\\sqrt{3}x+y \\leq 2\\sqrt{3}a$\n\n将晶格点位坐标用 $n_{1}$ 和 $n_{2}$ 代入：\n1.  $n_{2}\\frac{\\sqrt{3}a}{2} \\geq 0 \\implies n_{2} \\geq 0$。\n2.  $n_{2}\\frac{\\sqrt{3}a}{2} \\leq \\sqrt{3}\\left(n_{1}a + n_{2}\\frac{a}{2}\\right) \\implies \\frac{n_{2}}{2} \\leq n_{1} + \\frac{n_{2}}{2} \\implies n_{1} \\geq 0$。\n3.  $\\sqrt{3}\\left(n_{1}a + n_{2}\\frac{a}{2}\\right) + n_{2}\\frac{\\sqrt{3}a}{2} \\leq 2\\sqrt{3}a \\implies n_{1} + \\frac{n_{2}}{2} + \\frac{n_{2}}{2} \\leq 2 \\implies n_{1} + n_{2} \\leq 2$。\n\n我们寻求满足 $n_{1} \\geq 0$、$n_{2} \\geq 0$ 和 $n_{1}+n_{2} \\leq 2$ 的所有整数对 $(n_{1}, n_{2})$。有效的数对是：\n- $n_{2}=0$: $n_{1} \\in \\{0, 1, 2\\} \\implies (0,0), (1,0), (2,0)$。\n- $n_{2}=1$: $n_{1} \\in \\{0, 1\\} \\implies (0,1), (1,1)$。\n- $n_{2}=2$: $n_{1}=0 \\implies (0,2)$。\n\n这6对整数对应以下晶格点位：\n1.  $(n_1,n_2)=(0,0): \\mathbf{X}_{1} = 0\\mathbf{a}_{1} + 0\\mathbf{a}_{2} = (0,0) = \\mathbf{R}_{1}$\n2.  $(n_1,n_2)=(1,0): \\mathbf{X}_{2} = 1\\mathbf{a}_{1} + 0\\mathbf{a}_{2} = (a,0)$\n3.  $(n_1,n_2)=(2,0): \\mathbf{X}_{3} = 2\\mathbf{a}_{1} + 0\\mathbf{a}_{2} = (2a,0) = \\mathbf{R}_{2}$\n4.  $(n_1,n_2)=(0,1): \\mathbf{X}_{4} = 0\\mathbf{a}_{1} + 1\\mathbf{a}_{2} = \\left(\\frac{a}{2}, \\frac{\\sqrt{3}a}{2}\\right)$\n5.  $(n_1,n_2)=(1,1): \\mathbf{X}_{5} = 1\\mathbf{a}_{1} + 1\\mathbf{a}_{2} = \\left(\\frac{3a}{2}, \\frac{\\sqrt{3}a}{2}\\right)$\n6.  $(n_1,n_2)=(0,2): \\mathbf{X}_{6} = 0\\mathbf{a}_{1} + 2\\mathbf{a}_{2} = (a, \\sqrt{3}a) = \\mathbf{R}_{3}$\n该闭合单元中有6个原子。三个是代表性原子（$\\mathbf{R}_1, \\mathbf{R}_2, \\mathbf{R}_3$），另外三个位于单元的边上。\n\n(b) 插值变形后位置\n插值位移 $\\mathbf{u}_h(\\mathbf{X})$ 由 $\\mathbf{u}_{h}(\\mathbf{X}) = N_{1}(\\mathbf{X})\\mathbf{u}(\\mathbf{R}_{1}) + N_{2}(\\mathbf{X})\\mathbf{u}(\\mathbf{R}_{2}) + N_{3}(\\mathbf{X})\\mathbf{u}(\\mathbf{R}_{3})$ 给出。\n首先，我们使用 $\\mathbf{u}(x,y) = (\\kappa x^2, \\kappa y^2)$ 计算节点位移 $\\mathbf{u}(\\mathbf{R}_{i})$：\n- $\\mathbf{u}(\\mathbf{R}_{1}) = \\mathbf{u}(0,0) = (0,0)$。\n- $\\mathbf{u}(\\mathbf{R}_{2}) = \\mathbf{u}(2a,0) = (\\kappa(2a)^2, \\kappa 0^2) = (4\\kappa a^2, 0)$。\n- $\\mathbf{u}(\\mathbf{R}_{3}) = \\mathbf{u}(a,\\sqrt{3}a) = (\\kappa a^2, \\kappa(\\sqrt{3}a)^2) = (\\kappa a^2, 3\\kappa a^2)$。\n\n接下来，我们求形函数 $N_i$。对于一个点 $\\mathbf{X}=(x,y)$，其重心坐标 $N_i$ 满足以下方程组：\n$$ \\begin{pmatrix} 1 & 1 & 1 \\\\ x_1 & x_2 & x_3 \\\\ y_1 & y_2 & y_3 \\end{pmatrix} \\begin{pmatrix} N_1 \\\\ N_2 \\\\ N_3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ x \\\\ y \\end{pmatrix} \\implies \\begin{pmatrix} 1 & 1 & 1 \\\\ 0 & 2a & a \\\\ 0 & 0 & \\sqrt{3}a \\end{pmatrix} \\begin{pmatrix} N_1 \\\\ N_2 \\\\ N_3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ x \\\\ y \\end{pmatrix} $$\n通过回代求解该方程组，得到：\n$N_{3}(x,y) = \\frac{y}{\\sqrt{3}a}$\n$N_{2}(x,y) = \\frac{x - aN_3}{2a} = \\frac{x}{2a} - \\frac{y}{2\\sqrt{3}a}$\n$N_{1}(x,y) = 1 - N_2 - N_3 = 1 - \\frac{x}{2a} - \\frac{y}{2\\sqrt{3}a}$\n\n插值位移场为 $\\mathbf{u}_h(x,y) = N_{2}(x,y)\\mathbf{u}(\\mathbf{R}_{2}) + N_{3}(x,y)\\mathbf{u}(\\mathbf{R}_{3})$：\n$$ \\mathbf{u}_h(x,y) = \\left(\\frac{x}{2a} - \\frac{y}{2\\sqrt{3}a}\\right) \\begin{pmatrix} 4\\kappa a^2 \\\\ 0 \\end{pmatrix} + \\left(\\frac{y}{\\sqrt{3}a}\\right) \\begin{pmatrix} \\kappa a^2 \\\\ 3\\kappa a^2 \\end{pmatrix} = \\begin{pmatrix} 2\\kappa ax - \\frac{2\\kappa ay}{\\sqrt{3}} + \\frac{\\kappa ay}{\\sqrt{3}} \\\\ \\sqrt{3}\\kappa ay \\end{pmatrix} = \\begin{pmatrix} 2\\kappa ax - \\frac{\\kappa ay}{\\sqrt{3}} \\\\ \\sqrt{3}\\kappa ay \\end{pmatrix} $$\n一个原子的变形后位置是 $\\mathbf{x}_{\\text{def}} = \\mathbf{X} + \\mathbf{u}_h(\\mathbf{X})$。\n对于代表性原子，$\\mathbf{u}_h(\\mathbf{R}_i) = \\mathbf{u}(\\mathbf{R}_i)$。\n1. $\\mathbf{X}_{1}=(0,0)$: $\\mathbf{x}_{\\text{def}} = (0,0) + (0,0) = (0,0)$。\n2. $\\mathbf{X}_{3}=(2a,0)$: $\\mathbf{x}_{\\text{def}} = (2a,0) + (4\\kappa a^2, 0) = (2a+4\\kappa a^2, 0)$。\n3. $\\mathbf{X}_{6}=(a,\\sqrt{3}a)$: $\\mathbf{x}_{\\text{def}} = (a,\\sqrt{3}a) + (\\kappa a^2, 3\\kappa a^2) = (a+\\kappa a^2, \\sqrt{3}a+3\\kappa a^2)$。\n\n对于其他原子：\n4. $\\mathbf{X}_{2}=(a,0)$: $\\mathbf{u}_h(a,0) = (2\\kappa a^2, 0)$。变形后位置: $(a + 2\\kappa a^2, 0)$。\n5. $\\mathbf{X}_{4}=(\\frac{a}{2}, \\frac{\\sqrt{3}a}{2})$: $\\mathbf{u}_h = \\left(2\\kappa a(\\frac{a}{2}) - \\frac{\\kappa a}{\\sqrt{3}}(\\frac{\\sqrt{3}a}{2}), \\sqrt{3}\\kappa a(\\frac{\\sqrt{3}a}{2})\\right) = \\left(\\frac{\\kappa a^2}{2}, \\frac{3\\kappa a^2}{2}\\right)$。变形后位置: $(\\frac{a}{2} + \\frac{\\kappa a^2}{2}, \\frac{\\sqrt{3}a}{2} + \\frac{3\\kappa a^2}{2})$。\n6. $\\mathbf{X}_{5}=(\\frac{3a}{2}, \\frac{\\sqrt{3}a}{2})$: $\\mathbf{u}_h = \\left(2\\kappa a(\\frac{3a}{2}) - \\frac{\\kappa a}{\\sqrt{3}}(\\frac{\\sqrt{3}a}{2}), \\sqrt{3}\\kappa a(\\frac{\\sqrt{3}a}{2})\\right) = \\left(\\frac{5\\kappa a^2}{2}, \\frac{3\\kappa a^2}{2}\\right)$。变形后位置: $(\\frac{3a}{2} + \\frac{5\\kappa a^2}{2}, \\frac{\\sqrt{3}a}{2} + \\frac{3\\kappa a^2}{2})$。\n\n(c) 最大插值误差\n插值误差为 $\\mathbf{e}(\\mathbf{X}) = \\mathbf{u}(\\mathbf{X}) - \\mathbf{u}_h(\\mathbf{X})$。\n$\\mathbf{e}(x,y) = \\begin{pmatrix} \\kappa x^2 \\\\ \\kappa y^2 \\end{pmatrix} - \\begin{pmatrix} 2\\kappa ax - \\frac{\\kappa ay}{\\sqrt{3}} \\\\ \\sqrt{3}\\kappa ay \\end{pmatrix} = \\begin{pmatrix} \\kappa x^2 - 2\\kappa ax + \\frac{\\kappa ay}{\\sqrt{3}} \\\\ \\kappa y^2 - \\sqrt{3}\\kappa ay \\end{pmatrix}$。\n根据构造，代表性原子处的误差为零：$\\mathbf{e}(\\mathbf{R}_1) = \\mathbf{e}(\\mathbf{R}_2) = \\mathbf{e}(\\mathbf{R}_3) = \\mathbf{0}$。我们计算另外三个原子的误差。\n- 对于 $\\mathbf{X}_{2}=(a,0)$:\n$\\mathbf{e}(a,0) = (\\kappa a^2 - 2\\kappa a^2, 0) = (-\\kappa a^2, 0)$。\n$\\|\\mathbf{e}(a,0)\\|_{2} = \\sqrt{(-\\kappa a^2)^2} = |\\kappa|a^2$。\n\n- 对于 $\\mathbf{X}_{4}=(\\frac{a}{2}, \\frac{\\sqrt{3}a}{2})$:\n精确位移是 $\\mathbf{u}(\\frac{a}{2}, \\frac{\\sqrt{3}a}{2}) = (\\kappa(\\frac{a}{2})^2, \\kappa(\\frac{\\sqrt{3}a}{2})^2) = (\\frac{\\kappa a^2}{4}, \\frac{3\\kappa a^2}{4})$。\n插值位移已计算得出为 $\\mathbf{u}_h(\\frac{a}{2}, \\frac{\\sqrt{3}a}{2}) = (\\frac{\\kappa a^2}{2}, \\frac{3\\kappa a^2}{2})$。\n$\\mathbf{e}(\\mathbf{X}_{4}) = (\\frac{\\kappa a^2}{4} - \\frac{\\kappa a^2}{2}, \\frac{3\\kappa a^2}{4} - \\frac{3\\kappa a^2}{2}) = (-\\frac{\\kappa a^2}{4}, -\\frac{3\\kappa a^2}{4})$。\n$\\|\\mathbf{e}(\\mathbf{X}_{4})\\|_{2} = \\sqrt{(-\\frac{\\kappa a^2}{4})^2 + (-\\frac{3\\kappa a^2}{4})^2} = \\sqrt{\\frac{\\kappa^2 a^4}{16} + \\frac{9\\kappa^2 a^4}{16}} = \\sqrt{\\frac{10\\kappa^2 a^4}{16}} = \\frac{\\sqrt{10}}{4}|\\kappa|a^2$。\n\n- 对于 $\\mathbf{X}_{5}=(\\frac{3a}{2}, \\frac{\\sqrt{3}a}{2})$:\n精确位移是 $\\mathbf{u}(\\frac{3a}{2}, \\frac{\\sqrt{3}a}{2}) = (\\kappa(\\frac{3a}{2})^2, \\kappa(\\frac{\\sqrt{3}a}{2})^2) = (\\frac{9\\kappa a^2}{4}, \\frac{3\\kappa a^2}{4})$。\n插值位移已计算得出为 $\\mathbf{u}_h(\\frac{3a}{2}, \\frac{\\sqrt{3}a}{2}) = (\\frac{5\\kappa a^2}{2}, \\frac{3\\kappa a^2}{2})$。\n$\\mathbf{e}(\\mathbf{X}_{5}) = (\\frac{9\\kappa a^2}{4} - \\frac{10\\kappa a^2}{4}, \\frac{3\\kappa a^2}{4} - \\frac{6\\kappa a^2}{4}) = (-\\frac{\\kappa a^2}{4}, -\\frac{3\\kappa a^2}{4})$。\n该误差向量与 $\\mathbf{X}_{4}$ 的误差向量相同，因此 $\\|\\mathbf{e}(\\mathbf{X}_{5})\\|_{2} = \\frac{\\sqrt{10}}{4}|\\kappa|a^2$。\n\n为了找到最大误差 $E_{\\max}$，我们比较这些范数：$|\\kappa|a^2$、$\\frac{\\sqrt{10}}{4}|\\kappa|a^2$ 和 $0$。\n我们比较 $1$ 和 $\\frac{\\sqrt{10}}{4}$。由于 $16 > 10$，我们有 $\\sqrt{16} > \\sqrt{10}$，所以 $4 > \\sqrt{10}$，这意味着 $1 > \\frac{\\sqrt{10}}{4}$。\n因此，最大误差范数出现在原子 $\\mathbf{X}_{2}=(a,0)$ 处。\n最大值为 $E_{\\max} = |\\kappa|a^2$。", "answer": "$$\n\\boxed{|\\kappa|a^{2}}\n$$", "id": "2923417"}, {"introduction": "作为 QC 方法基石的柯西-玻恩 ($Cauchy–Born$) 规则假定晶体发生均匀变形。这个高级计算练习 [@problem_id:2923419] 邀请您探索该假设会发生戏剧性失效的场景：晶格不稳定性。您将把 QC 预测与直接的原子模拟计算进行比较，揭示原子间势的非凸性如何导致分叉和柯西-玻恩规则的失效，这是模拟材料失效的关键概念。", "problem": "您将通过比较均匀形变预测的应力与在相同宏观应变下从最小原子微观结构获得的应力，在准连续介质方法的背景下，为 Cauchy–Born 法则构建并量化一个严格的反例。考虑一个由相同原子组成的一维无限长链，其最近邻相互作用由 Lennard–Jones 势控制\n$$\n\\phi(r) = 4 \\varepsilon \\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right],\n$$\n其中 $r$ 是键长，$\\varepsilon$ 是能量尺度，$\\sigma$ 是长度尺度。参考晶格间距 $a_0$ 是 $\\phi$ 的极小值点，即 $a_0 = \\operatorname{argmin}_r \\phi(r)$，该极小值点出现在 $a_0 = 2^{1/6}\\sigma$。您将施加一个宏观拉伸 $F$，使得平均键长等于 $F a_0$。Cauchy–Born 法则 (CB) 假设形变是均匀的，而原子计算可能会实现一种具有两个交替键长 $l_1$ 和 $l_2$ 的非均匀、周期倍增的微观结构，该结构满足平均约束 $l_1 + l_2 = 2 F a_0$。\n\n仅从 Newton 定律、能量最小化原理以及第一 Piola–Kirchhoff (PK1) 应力是能量对形变的导数这一定义出发，您必须推导出：\n- 在均匀形变假设下，Cauchy–Born 法则预测的 PK1 应力。\n- 在平均约束 $l_1 + l_2 = 2 F a_0$ 下，使总势能最小化的原子双原子周期晶胞所产生的 PK1 应力（这可能导致在 $\\phi$ 的非凸区域出现 $l_1 \\neq l_2$）。\n- 这两种应力预测之间的绝对误差，由 $|P_{\\mathrm{atom}} - P_{\\mathrm{CB}}|$ 给出。\n\n假设使用简约单位，其中 $\\varepsilon = 1$ 和 $\\sigma = 1$，因此应力以 $\\varepsilon/\\sigma$ 为单位表示。您的程序必须：\n- 使用 $\\sigma = 1$ 计算 $a_0 = 2^{1/6}\\sigma$。\n- 对于每个给定的宏观拉伸 $F$，如上所述计算 Cauchy–Born PK1 应力和原子 PK1 应力。\n- 对每个测试用例，输出 PK1 应力的绝对误差 $|P_{\\mathrm{atom}} - P_{\\mathrm{CB}}|$。\n\n测试套件：\n- 使用以下宏观拉伸 $F$：$[1.00, 1.10, 1.12, 1.20, 1.30]$。\n- 选择这些值是为了探究：一个稳定的均匀区域（$F$ 接近 1.00）、一个刚好在非凸性起始点以下的区域（$F=1.10$）、一个刚好在非凸性起始点以上的区域（$F=1.12$），以及更深入的非凸区域（$F=1.20$ 和 $F=1.30$），在这些区域中 Cauchy–Born 法则可能会失效。\n\n所需输出：\n- 以 $\\varepsilon/\\sigma$ 为单位表示绝对误差。\n- 将每个结果四舍五入到 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[0.000000,0.123456,0.000001,0.500000,0.750000]$）。不应有额外的空格或文本。\n\n注：\n- 本问题不涉及角度。\n- 所有计算均在简约单位（$\\varepsilon = 1$ 和 $\\sigma = 1$）下进行。\n- 不应读取任何输入；指定的测试套件必须硬编码并在程序运行时自动执行。", "solution": "该问题要求为一维原子链构建并分析 Cauchy–Born 法则的一个反例。问题陈述的验证已经完成。该问题具有科学依据、提法恰当、客观，并包含了严谨求解所需的所有信息。我们可以继续进行。\n\n分析在简约单位下进行，其中 $\\varepsilon = 1$ 且 $\\sigma = 1$。\n\n**1. 原子间势与参考态**\n\n最近邻原子间的相互作用由 Lennard-Jones 势描述：\n$$\n\\phi(r) = 4\\varepsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6 \\right] = 4 \\left( r^{-12} - r^{-6} \\right)\n$$\n其中 $r$ 是原子间距。\n\n参考晶格间距 $a_0$ 是使势能 $\\phi(r)$ 最小化的键长。通过将势的一阶导数设为零来找到它：\n$$\n\\frac{d\\phi}{dr} = \\phi'(r) = 4 \\left( -12r^{-13} + 6r^{-7} \\right) = 0\n$$\n这得到 $6r^{-7} = 12r^{-13}$，简化为 $r^6 = 2$。因此，参考晶格间距为：\n$$\na_0 = 2^{1/6}\\sigma = 2^{1/6}\n$$\n在此间距下，原子间的力为零，因为 $\\phi'(a_0)=0$。\n\n**2. 第一 Piola-Kirchhoff (PK1) 应力的定义**\n\n在一维情况下，PK1 应力 $P$ 定义为能量密度对宏观形变梯度 $F$ 的导数。能量密度 $\\mathcal{E}$ 是单位参考长度的能量。对于一个键合系统，这是单位键的能量除以单位键的参考长度 $a_0$。\n$$\nP = \\frac{\\partial \\mathcal{E}}{\\partial F} = \\frac{1}{a_0} \\frac{\\partial E_{\\text{bond}}}{\\partial F}\n$$\n\n**3. Cauchy–Born (CB) 应力预测**\n\nCauchy–Born 法则假设宏观形变 $F$ 均匀地作用于原子尺度。这意味着一个均匀形变，其中每个键都具有相同的长度 $r_{\\mathrm{CB}}$：\n$$\nr_{\\mathrm{CB}} = F a_0\n$$\n单位键的能量就是在此长度下计算的势能，$E_{\\mathrm{CB}}(F) = \\phi(r_{\\mathrm{CB}}) = \\phi(F a_0)$。\n\n那么，在 CB 假设下的 PK1 应力 $P_{\\mathrm{CB}}$ 为：\n$$\nP_{\\mathrm{CB}}(F) = \\frac{1}{a_0} \\frac{d}{dF} \\left[ \\phi(F a_0) \\right]\n$$\n应用链式法则 $\\frac{d}{dF} = \\frac{dr_{\\mathrm{CB}}}{dF} \\frac{d}{dr_{\\mathrm{CB}}} = a_0 \\frac{d}{dr_{\\mathrm{CB}}}$，我们得到：\n$$\nP_{\\mathrm{CB}}(F) = \\frac{1}{a_0} \\left( a_0 \\cdot \\phi'(F a_0) \\right) = \\phi'(F a_0)\n$$\n代入 $\\phi'(r)$ 的表达式：\n$$\nP_{\\mathrm{CB}}(F) = 24(F a_0)^{-7} - 48(F a_0)^{-13}\n$$\n\n**4. 原子应力预测**\n\n原子模型考虑了一个最小微观结构：一个具有两个交替键长 $l_1$ 和 $l_2$ 的周期倍增的晶胞。宏观拉伸 $F$ 作为对平均键长的约束被施加：\n$$\n\\frac{l_1 + l_2}{2} = F a_0 \\implies l_1 + l_2 = 2F a_0\n$$\n这个双键晶胞的能量是 $E_{\\mathrm{cell}} = \\phi(l_1) + \\phi(l_2)$。实际的键长是在约束条件下使 $E_{\\mathrm{cell}}$ 最小化的值。我们可以将能量表示为仅 $l_1$ 的函数：\n$$\nE_{\\mathrm{cell}}(l_1) = \\phi(l_1) + \\phi(2F a_0 - l_1)\n$$\n平稳点的条件是 $\\frac{dE_{\\mathrm{cell}}}{dl_1} = 0$：\n$$\n\\frac{dE_{\\mathrm{cell}}}{dl_1} = \\phi'(l_1) - \\phi'(2F a_0 - l_1) = 0 \\implies \\phi'(l_1) = \\phi'(l_2)\n$$\n这个平衡条件意味着两个键中的内力必须相等。\n\n均匀解（其中 $l_1 = l_2 = F a_0$）的稳定性取决于晶胞能量的二阶导数，这对应于势 $\\phi(r)$ 的凸性。\n$$\n\\frac{d^2 E_{\\mathrm{cell}}}{dl_1^2} \\bigg|_{l_1 = F a_0} = \\phi''(F a_0) + \\phi''(F a_0) = 2\\phi''(F a_0)\n$$\n只有当 $2\\phi''(F a_0) > 0$ 时，均匀解才是稳定的。在 $\\phi''(r) < 0$ 的地方，势变为非凸。我们来求拐点 $r_c$，在该点处 $\\phi''(r_c) = 0$。\n$$\n\\phi''(r) = 4 \\left( 156 r^{-14} - 42 r^{-8} \\right) = 0\n$$\n这给出 $r_c^6 = \\frac{156}{42} = \\frac{26}{7}$。所以，$r_c = (26/7)^{1/6}$。如果键长 $F a_0$ 超过 $r_c$，则均匀形变是不稳定的。这定义了一个临界拉伸 $F_c$：\n$$\nF_c = \\frac{r_c}{a_0} = \\frac{(26/7)^{1/6}}{(2)^{1/6}} = \\left(\\frac{13}{7}\\right)^{1/6} \\approx 1.1086\n$$\n当 $F \\le F_c$ 时，稳定解是均匀的，$l_1 = l_2 = F a_0$。当 $F > F_c$ 时，均匀解不稳定，系统分岔到一个 $l_1 \\neq l_2$ 的非均匀状态。\n\n原子应力 $P_{\\mathrm{atom}}$ 是从双键晶胞的能量推导出来的。能量密度为 $\\mathcal{E}_{\\mathrm{atom}} = \\frac{E_{\\mathrm{cell}}}{2a_0} = \\frac{\\phi(l_1(F)) + \\phi(l_2(F))}{2a_0}$。\n$$\nP_{\\mathrm{atom}}(F) = \\frac{\\partial \\mathcal{E}_{\\mathrm{atom}}}{\\partial F} = \\frac{1}{2a_0} \\left( \\phi'(l_1) \\frac{dl_1}{dF} + \\phi'(l_2) \\frac{dl_2}{dF} \\right)\n$$\n使用平衡条件 $\\phi'(l_1) = \\phi'(l_2) \\equiv \\phi'_{\\min}$ 和约束的导数 $\\frac{dl_1}{dF} + \\frac{dl_2}{dF} = 2a_0$，我们得到：\n$$\nP_{\\mathrm{atom}}(F) = \\frac{\\phi'_{\\min}}{2a_0} \\left( \\frac{dl_1}{dF} + \\frac{dl_2}{dF} \\right) = \\frac{\\phi'_{\\min}}{2a_0} (2a_0) = \\phi'_{\\min}\n$$\n因此，$P_{\\mathrm{atom}}(F) = \\phi'(l_1)$，其中 $l_1$ 是使能量最小化的键长。\n\n**5. 计算算法**\n\n对于每个给定的宏观拉伸 $F$：\n1.  计算 $a_0 = 2^{1/6}$ 和 $F_c = (13/7)^{1/6}$。\n2.  计算 Cauchy-Born 应力：$P_{\\mathrm{CB}} = \\phi'(F a_0)$。\n3.  比较 $F$ 与 $F_c$：\n    *   如果 $F \\le F_c$，系统保持均匀。原子模型给出 $l_1 = l_2 = F a_0$，因此 $P_{\\mathrm{atom}} = \\phi'(F a_0) = P_{\\mathrm{CB}}$。误差为 $0$。\n    *   如果 $F > F_c$，系统发生分岔。我们必须通过数值求解关于 $l_1, l_2$ 的方程组来找到非均匀解：\n        $$\n        \\begin{cases}\n        \\phi'(l_1) = \\phi'(l_2) \\\\\n        l_1 + l_2 = 2F a_0\n        \\end{cases}\n        $$\n        这等价于求解函数 $f(x) = \\phi'(x) - \\phi'(2F a_0 - x)$ 在 $x \\neq F a_0$ 处的根 $l_1^*$。基于对 $\\phi'(r)$ 的分析，较短键长 $l_1^*$ 的物理上有意义的解位于区间 $(a_0, r_c)$ 内。在此区间上使用数值求根算法。\n4.  一旦找到 $l_1^*$，原子应力为 $P_{\\mathrm{atom}} = \\phi'(l_1^*)$。\n5.  绝对误差为 $|P_{\\mathrm{atom}} - P_{\\mathrm{CB}}|$。这个差值量化了 Cauchy-Born 法则的失效程度。\n\n此过程提供了一种计算所需应力误差的严谨方法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes the absolute error between the Cauchy-Born and atomistic PK1 stress\n    for a 1D atomic chain with Lennard-Jones interactions.\n    \"\"\"\n\n    # Reduced units are used, with epsilon = 1 and sigma = 1.\n    SIGMA = 1.0\n    EPSILON = 1.0\n\n    # Test cases for macroscopic stretch F\n    test_cases = [1.00, 1.10, 1.12, 1.20, 1.30]\n\n    # Pre-calculated constants based on the problem statement\n    # Reference lattice spacing a0 minimizes the potential, a0 = 2^(1/6) * sigma\n    a0 = np.power(2.0, 1.0/6.0) * SIGMA\n    \n    # Critical bond length rc is the inflection point of the potential, rc^6 = 26/7\n    rc = np.power(26.0/7.0, 1.0/6.0) * SIGMA\n    \n    # Critical stretch Fc corresponds to the onset of instability, Fc = rc / a0\n    Fc = rc / a0\n\n    def phi_prime(r):\n        \"\"\"\n        First derivative of the Lennard-Jones potential (proportional to force).\n        phi'(r) = 4 * epsilon * (-12 * sigma^12 / r^13 + 6 * sigma^6 / r^7)\n        In reduced units, this simplifies to:\n        phi'(r) = 24 / r^7 - 48 / r^13\n        \"\"\"\n        r_inv = SIGMA / r\n        r_inv6 = np.power(r_inv, 6)\n        r_inv12 = r_inv6 * r_inv6\n        \n        # The true phi'(r) is below. The simplified form 24r^-7 - 48r^-13 works fine.\n        return 4.0 * EPSILON * (-12.0 * r_inv12 / r + 6.0 * r_inv6 / r)\n\n    results = []\n    \n    for F in test_cases:\n        # Calculate the bond length under homogeneous (Cauchy-Born) deformation\n        r_cb = F * a0\n        \n        # Calculate the Cauchy-Born PK1 stress\n        # P_CB = phi'(r_cb)\n        P_cb = phi_prime(r_cb)\n        \n        P_atom = 0.0\n        \n        # Check for stability. The CB rule holds if F = Fc.\n        if F = Fc:\n            # In the stable regime, the atomistic solution is homogeneous.\n            P_atom = P_cb\n        else:\n            # In the unstable regime (F > Fc), the system bifurcates.\n            # We need to find the non-homogeneous solution {l1, l2} that minimizes energy.\n            # This requires solving phi'(l1) = phi'(l2) with l1 + l2 = 2 * F * a0.\n            \n            # Define the function whose root we need to find.\n            def root_func(l1):\n                l2 = 2 * r_cb - l1\n                return phi_prime(l1) - phi_prime(l2)\n            \n            # The smaller bond length l1 must be in the interval (a0, rc).\n            # This bracket is guaranteed to contain the root for F > Fc.\n            bracket = [a0, rc]\n\n            # Use SciPy's root finder to find the energy-minimizing l1.\n            # Trivial solution is l1 = r_cb, we search for the other one.\n            sol = root_scalar(root_func, bracket=bracket, method='brentq')\n            \n            if sol.converged:\n                l1_sol = sol.root\n                # The atomistic stress is phi'(l1_sol)\n                P_atom = phi_prime(l1_sol)\n            else:\n                # Should not happen with the correct bracket and problem setup.\n                # In case of failure, treat as error.\n                P_atom = np.nan\n\n        # Calculate the absolute error between atomistic and CB stress predictions.\n        error = np.abs(P_atom - P_cb)\n        results.append(error)\n\n    # Format the output as a comma-separated list of strings, rounded to 6 decimal places.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2923419"}]}