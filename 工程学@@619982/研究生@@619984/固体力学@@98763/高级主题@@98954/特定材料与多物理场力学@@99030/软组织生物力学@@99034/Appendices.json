{"hands_on_practices": [{"introduction": "许多先进的非线性材料模型，尽管形式复杂，但在小应变极限下必须能够回归到经典的线性弹性理论。这个练习将指导你通过对一个Fung型超弹性本构模型进行线性化，来推导其在初始构型下的切线弹性张量，并将其与经典的拉梅参数 $\\lambda$ 和 $\\mu$ 建立联系 [@problem_id:2619336]。这个过程不仅能加深你对非线性本构关系和线性近似之间联系的理解，也锻炼了从第一性原理出发进行张量分析和推导的能力。", "problem": "一个可压缩软组织被建模为Fung型超弹性固体，其应变能密度为\n$$\nW(\\mathbf{E})=\\frac{c}{2}\\big(\\exp(Q(\\mathbf{E}))-1\\big),\n$$\n其中 $c>0$ 是一个材料常数，$\\mathbf{E}$ 是Green-Lagrange应变。假设二次型 $Q(\\mathbf{E})$ 是各向同性的，并通过以下不变量来依赖于 $\\mathbf{E}$：\n$$\nQ(\\mathbf{E})=\\alpha\\big(\\operatorname{tr}\\mathbf{E}\\big)^{2}+2\\,\\beta\\,\\mathbf{E}:\\mathbf{E},\n$$\n其中 $\\alpha$ 和 $\\beta$ 为实常数，$\\operatorname{tr}(\\cdot)$ 表示迹，而 $:$ 表示双点积。从超弹性应力和切向弹性的定义出发，\n$$\n\\mathbf{S}=\\frac{\\partial W}{\\partial \\mathbf{E}}, \\qquad \\mathbb{C}=\\frac{\\partial \\mathbf{S}}{\\partial \\mathbf{E}},\n$$\n仅根据这些定义和给定的 $W(\\mathbf{E})$，推导在参考构型 $\\mathbf{E}=\\mathbf{0}$ 处的四阶切向弹性张量。然后确定经典线性各向同性弹性常数（Lamé参数）$\\lambda$ 和 $\\mu$，使得在 $\\mathbf{E}=\\mathbf{0}$ 处，线性化结果满足\n$$\n\\mathbf{S}\\approx \\lambda\\,\\operatorname{tr}(\\mathbf{E})\\,\\mathbf{I}+2\\,\\mu\\,\\mathbf{E},\n$$\n其中 $\\mathbf{I}$ 是二阶单位张量。将最终答案表示为 $\\lambda$ 和 $\\mu$ 关于 $c$、$\\alpha$ 和 $\\beta$ 的闭式解析表达式。无需进行数值计算，也无需在最终答案中报告单位。", "solution": "该问题要求确定Fung型超弹性材料在参考构型下的Lamé参数 $\\lambda$ 和 $\\mu$。这可以通过在未变形状态 $\\mathbf{E}=\\mathbf{0}$ 附近对第二Piola-Kirchhoff应力张量 $\\mathbf{S}$ 进行线性化，并将结果与各向同性线弹性固体的Hooke定律标准形式进行比较来实现。\n\n应变能密度函数由下式给出：\n$$\nW(\\mathbf{E}) = \\frac{c}{2} \\left( \\exp(Q(\\mathbf{E})) - 1 \\right)\n$$\n其中 $c > 0$ 且 $Q(\\mathbf{E}) = \\alpha (\\operatorname{tr}\\mathbf{E})^2 + 2\\beta \\mathbf{E}:\\mathbf{E}$。\n\n第二Piola-Kirchhoff应力张量 $\\mathbf{S}$ 定义为应变能密度 $W$ 对Green-Lagrange应变张量 $\\mathbf{E}$ 的偏导数：\n$$\n\\mathbf{S} = \\frac{\\partial W}{\\partial \\mathbf{E}}\n$$\n应用链式法则，我们有：\n$$\n\\mathbf{S} = \\frac{dW}{dQ} \\frac{\\partial Q}{\\partial \\mathbf{E}}\n$$\n首先，我们计算 $W$ 对标量 $Q$ 的导数：\n$$\n\\frac{dW}{dQ} = \\frac{d}{dQ} \\left[ \\frac{c}{2} (\\exp(Q) - 1) \\right] = \\frac{c}{2} \\exp(Q)\n$$\n接下来，我们计算二次型 $Q(\\mathbf{E})$ 对张量 $\\mathbf{E}$ 的导数。我们使用标准张量求导恒等式 $\\frac{\\partial(\\operatorname{tr}\\mathbf{E})}{\\partial\\mathbf{E}} = \\mathbf{I}$ 和 $\\frac{\\partial(\\mathbf{E}:\\mathbf{E})}{\\partial\\mathbf{E}} = 2\\mathbf{E}$，其中 $\\mathbf{I}$ 是二阶单位张量。\n$$\n\\frac{\\partial Q}{\\partial \\mathbf{E}} = \\frac{\\partial}{\\partial \\mathbf{E}} \\left[ \\alpha (\\operatorname{tr}\\mathbf{E})^2 + 2\\beta \\mathbf{E}:\\mathbf{E} \\right] = \\alpha \\frac{\\partial (\\operatorname{tr}\\mathbf{E})^2}{\\partial \\mathbf{E}} + 2\\beta \\frac{\\partial (\\mathbf{E}:\\mathbf{E})}{\\partial \\mathbf{E}}\n$$\n再次对第一项使用链式法则：\n$$\n\\frac{\\partial (\\operatorname{tr}\\mathbf{E})^2}{\\partial \\mathbf{E}} = 2(\\operatorname{tr}\\mathbf{E}) \\frac{\\partial(\\operatorname{tr}\\mathbf{E})}{\\partial\\mathbf{E}} = 2(\\operatorname{tr}\\mathbf{E})\\mathbf{I}\n$$\n因此，$Q$ 的导数为：\n$$\n\\frac{\\partial Q}{\\partial \\mathbf{E}} = \\alpha (2(\\operatorname{tr}\\mathbf{E})\\mathbf{I}) + 2\\beta(2\\mathbf{E}) = 2\\alpha(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 4\\beta\\mathbf{E}\n$$\n将这些导数代回到 $\\mathbf{S}$ 的表达式中：\n$$\n\\mathbf{S}(\\mathbf{E}) = \\frac{c}{2} \\exp(Q(\\mathbf{E})) \\left( 2\\alpha(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 4\\beta\\mathbf{E} \\right) = c \\exp(Q(\\mathbf{E})) \\left( \\alpha(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 2\\beta\\mathbf{E} \\right)\n$$\n在参考构型 $\\mathbf{E}=\\mathbf{0}$ 处，我们有 $\\operatorname{tr}\\mathbf{0}=0$，因此 $Q(\\mathbf{0})=0$。应力为 $\\mathbf{S}(\\mathbf{0}) = c \\exp(0) (\\alpha(0)\\mathbf{I} + 2\\beta\\mathbf{0}) = \\mathbf{0}$，这证实了参考状态是无应力状态。\n\n线性化的应力-应变关系可以通过 $\\mathbf{S}(\\mathbf{E})$ 在 $\\mathbf{E}=\\mathbf{0}$ 附近的一阶Taylor展开得到：\n$$\n\\mathbf{S}(\\mathbf{E}) \\approx \\mathbf{S}(\\mathbf{0}) + \\left. \\frac{\\partial \\mathbf{S}}{\\partial \\mathbf{E}} \\right|_{\\mathbf{E}=\\mathbf{0}} : \\mathbf{E}\n$$\n由于 $\\mathbf{S}(\\mathbf{0})=\\mathbf{0}$，近似式变为 $\\mathbf{S}(\\mathbf{E}) \\approx \\mathbb{C}(\\mathbf{0}) : \\mathbf{E}$，其中 $\\mathbb{C}(\\mathbf{0}) = \\left. \\frac{\\partial \\mathbf{S}}{\\partial \\mathbf{E}} \\right|_{\\mathbf{E}=\\mathbf{0}}$ 是参考构型下的切向弹性张量。我们必须计算这个张量。\n\n对张量求导使用乘法法则：\n$$\n\\mathbb{C}(\\mathbf{E}) = \\frac{\\partial \\mathbf{S}}{\\partial \\mathbf{E}} = c \\frac{\\partial}{\\partial \\mathbf{E}} \\left[ \\exp(Q(\\mathbf{E})) \\left( \\alpha(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 2\\beta\\mathbf{E} \\right) \\right]\n$$\n$$\n\\mathbb{C}(\\mathbf{E}) = c \\left[ \\left( \\frac{\\partial}{\\partial \\mathbf{E}} \\exp(Q) \\right) \\otimes \\left( \\alpha(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 2\\beta\\mathbf{E} \\right) + \\exp(Q) \\frac{\\partial}{\\partial \\mathbf{E}} \\left( \\alpha(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 2\\beta\\mathbf{E} \\right) \\right]\n$$\n我们在 $\\mathbf{E}=\\mathbf{0}$ 处计算此表达式。在这一点，$\\operatorname{tr}\\mathbf{E}=0$, $Q(\\mathbf{0})=0$, 且 $\\exp(Q(\\mathbf{0}))=1$。项 $\\alpha(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 2\\beta\\mathbf{E}$ 变为 $\\mathbf{0}$。导数 $\\frac{\\partial}{\\partial \\mathbf{E}} \\exp(Q) = \\exp(Q) \\frac{\\partial Q}{\\partial \\mathbf{E}}$ 在 $\\mathbf{E}=\\mathbf{0}$ 处的值也为 $\\mathbf{0}$，因为 $\\frac{\\partial Q}{\\partial \\mathbf{E}}|_{\\mathbf{E}=\\mathbf{0}} = \\mathbf{0}$。因此，乘法法则的整个第一项为零。我们剩下：\n$$\n\\mathbb{C}(\\mathbf{0}) = c \\cdot \\exp(0) \\cdot \\left. \\frac{\\partial}{\\partial \\mathbf{E}} \\left( \\alpha(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 2\\beta\\mathbf{E} \\right) \\right|_{\\mathbf{E}=\\mathbf{0}}\n$$\n$$\n\\mathbb{C}(\\mathbf{0}) = c \\left[ \\alpha \\frac{\\partial((\\operatorname{tr}\\mathbf{E})\\mathbf{I})}{\\partial \\mathbf{E}} + 2\\beta \\frac{\\partial \\mathbf{E}}{\\partial \\mathbf{E}} \\right]\n$$\n所需的四阶张量导数是 $\\frac{\\partial((\\operatorname{tr}\\mathbf{E})\\mathbf{I})}{\\partial \\mathbf{E}} = \\mathbf{I} \\otimes \\mathbf{I}$ 和 $\\frac{\\partial \\mathbf{E}}{\\partial \\mathbf{E}} = \\mathbb{I}_{sym}$，其中 $\\mathbb{I}_{sym}$ 是四阶对称单位张量。用分量形式表示，$(\\mathbf{I} \\otimes \\mathbf{I})_{ijkl} = \\delta_{ij}\\delta_{kl}$ 且 $(\\mathbb{I}_{sym})_{ijkl} = \\frac{1}{2}(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})$。\n因此，在原点处的弹性张量为：\n$$\n\\mathbb{C}(\\mathbf{0}) = c \\left( \\alpha \\mathbf{I} \\otimes \\mathbf{I} + 2\\beta \\mathbb{I}_{sym} \\right)\n$$\n然后通过缩并 $\\mathbf{S} \\approx \\mathbb{C}(\\mathbf{0}):\\mathbf{E}$ 找到线性化应力：\n$$\n\\mathbf{S} \\approx \\left[ c \\left( \\alpha \\mathbf{I} \\otimes \\mathbf{I} + 2\\beta \\mathbb{I}_{sym} \\right) \\right] : \\mathbf{E} = c\\alpha (\\mathbf{I} \\otimes \\mathbf{I}):\\mathbf{E} + 2c\\beta \\mathbb{I}_{sym}:\\mathbf{E}\n$$\n使用恒等式 $(\\mathbf{I} \\otimes \\mathbf{I}):\\mathbf{E} = (\\operatorname{tr}\\mathbf{E})\\mathbf{I}$ 和 $\\mathbb{I}_{sym}:\\mathbf{E} = \\mathbf{E}$ （对于对称的 $\\mathbf{E}$）：\n$$\n\\mathbf{S} \\approx c\\alpha(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 2c\\beta\\mathbf{E}\n$$\n必须将这个推导出的表达式与给定的各向同性材料的线性化形式进行比较：\n$$\n\\mathbf{S} \\approx \\lambda(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 2\\mu\\mathbf{E}\n$$\n通过直接比较张量项的系数，我们确定了Lamé参数：\n$(\\operatorname{tr}\\mathbf{E})\\mathbf{I}$ 的系数给出了 $\\lambda$：\n$$\n\\lambda = c\\alpha\n$$\n$2\\mathbf{E}$ 的乘法系数给出了 $\\mu$：\n$$\n\\mu = c\\beta\n$$\n这些就是用Fung型模型的材料常数表示的Lamé参数的解析表达式。", "answer": "$$\n\\boxed{\\begin{pmatrix} c\\alpha & c\\beta \\end{pmatrix}}\n$$", "id": "2619336"}, {"introduction": "生物软组织一个显著的力学特性是应变硬化，即材料在拉伸过程中会变得越来越“硬”。Fung型指数本构模型被广泛应用，正是因为它能有效地描述这一现象。通过分析不可压缩材料在简单剪切变形下的柯西应力，你将推导出其应力响应的级数展开，并识别出超越线性剪切模量的第一个非线性修正项 [@problem_id:2619287]，从而直观地理解模型是如何通过其非线性项捕捉应变硬化行为的。", "problem": "一个均匀、不可压缩、各向同性的软组织被建模为超弹性体，其Fung型（指数型）应变能密度仅取决于右柯西-格林张量的第一不变量。具体而言，该应变能密度为\n$$\nW(I_{1}) \\;=\\; \\frac{c}{2 b} \\left[ \\exp\\!\\big(b \\,(I_{1} - 3)\\big) - 1 \\right],\n$$\n其中 $c>0$ 和 $b>0$ 是材料参数，且 $I_{1} = \\operatorname{tr}(\\mathbf{C})$，$\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{F}$。考虑在 $x_{1}$–$x_{2}$ 平面内的简单剪切变形，其特征变形梯度为\n$$\n\\mathbf{F} \\;=\\; \\begin{pmatrix}\n1 & \\gamma & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix},\n$$\n其中 $\\gamma$ 是剪切量。从超弹性、不变量以及不可压缩各向同性材料标准本构结构的定义出发，推导柯西剪切应力分量 $\\sigma_{12}(\\gamma)$，并求出其小$\\gamma$展开式，直到并包含 $O(\\gamma^{3})$ 阶的项。在此展开式中，识别出除线性剪切模量外的第一个非线性修正项。将最终结果表示为 $\\sigma_{12}(\\gamma)$ 截断至 $O(\\gamma^{3})$ 阶的单一闭式解析表达式。最终答案中不要包含单位，也不要四舍五入，因为没有指定具体数值。", "solution": "题目陈述已经过验证，被认定为具有科学依据、适定且自洽。所指定的变形满足不可压缩性约束，且目标明确。因此，我们可以进行推导。\n\n对于一个不可压缩、各向同性的超弹性材料，其柯西应力张量 $\\boldsymbol{\\sigma}$ 由以下本构关系给出：\n$$\n\\boldsymbol{\\sigma} = -p\\mathbf{I} + 2\\frac{\\partial W}{\\partial I_{1}}\\mathbf{B} - 2\\frac{\\partial W}{\\partial I_{2}}\\mathbf{B}^{-1}\n$$\n其中 $p$ 是代表静水压力的拉格朗日乘子，$\\mathbf{I}$ 是单位张量，$\\mathbf{B} = \\mathbf{F}\\mathbf{F}^{\\mathsf{T}}$ 是左柯西-格林变形张量，而 $I_{1} = \\operatorname{tr}(\\mathbf{B})$ 和 $I_{2} = \\frac{1}{2}[(\\operatorname{tr}(\\mathbf{B}))^2 - \\operatorname{tr}(\\mathbf{B}^2)]$ 分别是 $\\mathbf{B}$ 的第一和第二不变量。\n\n题目指出应变能密度 $W$ 仅取决于第一不变量 $I_{1}$。因此，项 $\\frac{\\partial W}{\\partial I_{2}}$ 为零，本构方程简化为：\n$$\n\\boldsymbol{\\sigma} = -p\\mathbf{I} + 2\\frac{\\partial W}{\\partial I_{1}}\\mathbf{B}\n$$\n给定的应变能密度是Fung型指数形式：\n$$\nW(I_{1}) = \\frac{c}{2b} \\left[ \\exp\\big(b \\,(I_{1} - 3)\\big) - 1 \\right]\n$$\n其中 $c > 0$ 和 $b > 0$。$W$ 对 $I_{1}$ 的导数为：\n$$\n\\frac{\\partial W}{\\partial I_{1}} = \\frac{d}{dI_{1}} \\left( \\frac{c}{2b} \\left[ \\exp\\big(b \\,(I_{1} - 3)\\big) - 1 \\right] \\right) = \\frac{c}{2b} \\left[ b \\exp\\big(b \\,(I_{1} - 3)\\big) \\right] = \\frac{c}{2} \\exp\\big(b \\,(I_{1} - 3)\\big)\n$$\n接下来，我们分析指定的简单剪切变形。变形梯度 $\\mathbf{F}$ 给出如下：\n$$\n\\mathbf{F} = \\begin{pmatrix} 1 & \\gamma & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n不可压缩性约束要求 $\\det(\\mathbf{F}) = 1$，此条件在此得到满足。我们计算左柯西-格林张量 $\\mathbf{B} = \\mathbf{F}\\mathbf{F}^{\\mathsf{T}}$：\n$$\n\\mathbf{B} = \\begin{pmatrix} 1 & \\gamma & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ \\gamma & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1+\\gamma^{2} & \\gamma & 0 \\\\ \\gamma & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n第一不变量 $I_{1}$ 是 $\\mathbf{B}$ 的迹：\n$$\nI_{1} = \\operatorname{tr}(\\mathbf{B}) = (1+\\gamma^{2}) + 1 + 1 = 3 + \\gamma^{2}\n$$\n现在我们将 $I_{1}$ 的这个表达式代入应变能密度的导数中：\n$$\n\\frac{\\partial W}{\\partial I_{1}} = \\frac{c}{2} \\exp\\big(b \\,((3+\\gamma^{2}) - 3)\\big) = \\frac{c}{2} \\exp(b \\gamma^{2})\n$$\n将此结果和张量 $\\mathbf{B}$ 代入简化的 $\\boldsymbol{\\sigma}$ 本构方程中：\n$$\n\\boldsymbol{\\sigma} = -p\\mathbf{I} + 2\\left(\\frac{c}{2} \\exp(b \\gamma^{2})\\right)\\mathbf{B} = -p\\mathbf{I} + c \\exp(b \\gamma^{2}) \\mathbf{B}\n$$\n将其写为分量形式：\n$$\n\\boldsymbol{\\sigma} = -p \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} + c \\exp(b \\gamma^{2}) \\begin{pmatrix} 1+\\gamma^{2} & \\gamma & 0 \\\\ \\gamma & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n我们感兴趣的分量是剪切应力 $\\sigma_{12}$。从该矩阵方程中，我们提取出：\n$$\n\\sigma_{12}(\\gamma) = c \\gamma \\exp(b \\gamma^{2})\n$$\n注意，该表达式与静水压力 $p$ 无关，因此其值可以在不知道正应力边界条件的情况下确定。这是柯西剪切应力的精确表达式。\n\n问题要求进行小$\\gamma$展开，直到并包含 $O(\\gamma^{3})$ 阶的项。我们对 $\\exp(b\\gamma^{2})$ 在 $\\gamma=0$ 附近进行泰勒级数展开：\n$$\n\\exp(x) = 1 + x + \\frac{x^{2}}{2!} + O(x^{3})\n$$\n令 $x = b\\gamma^{2}$，展开式变为：\n$$\n\\exp(b\\gamma^{2}) = 1 + b\\gamma^{2} + \\frac{(b\\gamma^{2})^{2}}{2} + \\dots = 1 + b\\gamma^{2} + O(\\gamma^{4})\n$$\n将此级数代入 $\\sigma_{12}(\\gamma)$ 的表达式中：\n$$\n\\sigma_{12}(\\gamma) = c\\gamma \\left( 1 + b\\gamma^{2} + O(\\gamma^{4}) \\right) = c\\gamma + cb\\gamma^{3} + O(\\gamma^{5})\n$$\n因此，直到并包含 $O(\\gamma^{3})$ 阶项的展开式为 $c\\gamma + cb\\gamma^{3}$。\n\n在此展开式中，$c\\gamma$ 项代表线性弹性响应，其中 $c$ 是小应变剪切模量。$cb\\gamma^{3}$ 项是剪切应力的第一个非线性修正。由于 $c$ 和 $b$ 均为正常数，这个三次项表明了应变硬化响应，这是许多生物软组织的典型特征。\n\n最终结果是 $\\sigma_{12}(\\gamma)$ 的截断表达式。", "answer": "$$\n\\boxed{c\\gamma + cb\\gamma^{3}}\n$$", "id": "2619287"}, {"introduction": "本构模型的最终目的是为了准确描述和预测真实材料的行为，而这离不开从实验数据中确定模型参数的过程。这个实践练习将理论付诸实践，要求你为一个Fung型模型推导单轴拉伸下的应力-应变关系，并最终通过编写程序，使用高斯-牛顿法对合成的实验数据进行非线性最小二乘拟合 [@problem_id:2619321]。这项任务涵盖了从理论推导到数值实现的全过程，是生物力学研究中一项至关重要的核心技能。", "problem": "考虑一个不可压缩的各向同性软组织，其被模拟为一种超弹性材料，具有依赖于等容第一不变量的 Fung 型应变能密度。设应变能密度由下式给出\n$$\nW(\\mathbf{F};c,k) = \\frac{c}{2k}\\left[\\exp\\!\\left(k\\left(\\bar{I}_1 - 3\\right)\\right) - 1\\right],\n$$\n其中 $c$ 的单位是千帕 (kPa)，$k$ 是无量纲的，$\\mathbf{F}$ 是变形梯度，$\\bar{I}_1$ 是等容第一不变量，不可压缩性由 $\\det\\mathbf{F} = 1$ 强制约束。在 $x_1$ 方向进行单轴拉伸，拉伸率为 $\\lambda$，且侧向无面力的情况下，Cauchy 应力 $\\sigma_{11}(\\lambda;c,k)$ 由标准超弹性理论和不可压缩性约束确定。\n\n给定测量的单轴应力-拉伸率数据 $\\{(\\lambda_i,\\sigma_{11}^{\\text{exp}}(\\lambda_i))\\}_{i=1}^N$。您必须建立非线性最小二乘问题，通过最小化残差平方和来估计参数 $(c,k)$。定义残差 $r_i(c,k) = \\sigma_{11}(\\lambda_i;c,k) - \\sigma_{11}^{\\text{exp}}(\\lambda_i)$ 和目标函数\n$$\n\\Phi(c,k) = \\frac{1}{2}\\sum_{i=1}^N r_i(c,k)^2.\n$$\n从不可压缩各向同性超弹性理论的第一性原理出发，推导由 $W(\\mathbf{F};c,k)$ 和侧向无面力边界条件所蕴含的单轴 Cauchy 应力-拉伸率关系 $\\sigma_{11}(\\lambda;c,k)$。然后，写出残差向量关于参数向量 $(c,k)$ 的解析雅可比矩阵，即对每个数据点计算 $\\partial r_i/\\partial c$ 和 $\\partial r_i/\\partial k$。\n\n您的程序必须：\n- 实现推导出的单轴 Cauchy 应力-拉伸率关系 $\\sigma_{11}(\\lambda;c,k)$。\n- 构建残差向量 $\\mathbf{r}(c,k)$ 和雅可比矩阵 $\\mathbf{J}(c,k)$，其第 $i$ 行包含 $\\left[\\partial r_i/\\partial c,\\ \\partial r_i/\\partial k\\right]$。\n- 对于下述每个测试用例，在给定的初始猜测值 $(c_0,k_0)$ 处计算 $\\mathbf{r}$ 和 $\\mathbf{J}$，执行一次 Gauss–Newton 更新\n$$\n\\Delta\\boldsymbol{\\theta} = \\arg\\min_{\\Delta\\boldsymbol{\\theta}} \\left\\|\\mathbf{J}(c_0,k_0)\\,\\Delta\\boldsymbol{\\theta} + \\mathbf{r}(c_0,k_0)\\right\\|_2,\\quad \\boldsymbol{\\theta}=\\begin{bmatrix}c\\\\k\\end{bmatrix},\n$$\n并报告更新后的参数 $\\boldsymbol{\\theta}_{\\text{new}} = \\boldsymbol{\\theta}_0 + \\Delta\\boldsymbol{\\theta}$。\n\n物理和数值单位：\n- 报告 $c$ 的单位为千帕 (kPa)，$k$ 为无量纲。\n- 拉伸率 $\\lambda$ 是无量纲的。\n- 将所有最终数值输出四舍五入到 6 位小数。\n\n不涉及角度单位。不涉及百分比。\n\n测试套件。使用以下三个测试用例。对于每个用例，合成的测量应力 $\\sigma_{11}^{\\text{exp}}(\\lambda_i)$ 是使用给定的真实参数 $(c^{\\ast},k^{\\ast})$ 从相同的推导关系 $\\sigma_{11}(\\lambda;c,k)$ 生成的：\n- 用例 1 (理想情况):\n  - 拉伸率: $\\lambda = [1.05,\\,1.10,\\,1.20,\\,1.30]$。\n  - 真实参数: $(c^{\\ast},k^{\\ast}) = (10.0,\\,2.0)$。\n  - 初始猜测值: $(c_0,k_0) = (9.0,\\,1.0)$。\n- 用例 2 (近不可压缩小拉伸范围):\n  - 拉伸率: $\\lambda = [1.00,\\,1.02,\\,1.04,\\,1.06]$。\n  - 真实参数: $(c^{\\ast},k^{\\ast}) = (8.0,\\,1.0)$。\n  - 初始猜测值: $(c_0,k_0) = (5.0,\\,0.5)$。\n- 用例 3 (更具非线性的高拉伸范围):\n  - 拉伸率: $\\lambda = [1.15,\\,1.30,\\,1.45,\\,1.60]$。\n  - 真实参数: $(c^{\\ast},k^{\\ast}) = (15.0,\\,2.5)$。\n  - 初始猜测值: $(c_0,k_0) = (12.0,\\,2.0)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[c_{\\text{new}}^{(1)},k_{\\text{new}}^{(1)},c_{\\text{new}}^{(2)},k_{\\text{new}}^{(2)},c_{\\text{new}}^{(3)},k_{\\text{new}}^{(3)}]$，其中上标 $(1)$、$(2)$ 和 $(3)$ 分别对应于用例 1、2 和 3。\n- 每个数字必须四舍五入到 6 位小数，并以指定单位的十进制浮点数形式报告。例如，一个可接受的输出格式是 $[9.123456,1.234567,\\,\\ldots]$。", "solution": "该问题是有效的。这是一个在连续介质力学和数值优化领域的适定问题，其基础是已建立的软组织超弹性理论。所有必要信息都已提供，任务是推导并实现一个标准的数值方法。\n\n解决方案分两个阶段进行。首先，我们从第一性原理推导必要的解析表达式。其次，我们实现这些表达式以执行所需的数值计算。\n\n**1. 单轴 Cauchy 应力的推导**\n\n假设材料是不可压缩和各向同性的，其应变能密度函数 $W$ 由下式给出：\n$$ W(\\mathbf{F};c,k) = \\frac{c}{2k}\\left[\\exp\\!\\left(k\\left(\\bar{I}_1 - 3\\right)\\right) - 1\\right] $$\n其中 $c$ 和 $k$ 是材料参数，$\\bar{I}_1$ 是左 Cauchy-Green 变形张量的等容部分的第一不变量。对于不可压缩材料，变形梯度 $\\mathbf{F}$ 满足 $\\det\\mathbf{F} = 1$。这意味着变形的体积部分为单位 1，变形是纯等容的。因此，$\\mathbf{F} = \\bar{\\mathbf{F}}$，左 Cauchy-Green 张量 $\\mathbf{B} = \\mathbf{F}\\mathbf{F}^T$ 与其等容部分 $\\bar{\\mathbf{B}}$ 相同，第一不变量 $I_1 = \\text{tr}(\\mathbf{B})$ 与第一等容不变量 $\\bar{I}_1 = \\text{tr}(\\bar{\\mathbf{B}})$ 相同。\n\n因此，应变能函数可以写成 $I_1$ 的函数：\n$$ W(I_1;c,k) = \\frac{c}{2k}\\left[\\exp\\!\\left(k\\left(I_1 - 3\\right)\\right) - 1\\right] $$\n对于不可压缩的各向同性超弹性材料，Cauchy 应力张量 $\\boldsymbol{\\sigma}$ 由下式给出：\n$$ \\boldsymbol{\\sigma} = -p\\mathbf{I} + 2 \\frac{\\partial W}{\\partial I_1}\\mathbf{B} $$\n其中 $p$ 是确保不可压缩性的拉格朗日乘子，即静水压力，$\\mathbf{I}$ 是单位张量。$W$ 对 $I_1$ 的导数是：\n$$ \\frac{\\partial W}{\\partial I_1} = \\frac{c}{2k} \\frac{\\partial}{\\partial I_1} \\left( \\exp(k(I_1-3)) - 1 \\right) = \\frac{c}{2k} \\left( k \\exp(k(I_1-3)) \\right) = \\frac{c}{2} \\exp(k(I_1-3)) $$\n将此代入应力方程，得到：\n$$ \\boldsymbol{\\sigma} = -p\\mathbf{I} + c \\exp(k(I_1-3))\\mathbf{B} $$\n对于在 $x_1$ 方向上拉伸率为 $\\lambda$ 的单轴拉伸状态，变形梯度张量 $\\mathbf{F}$ 和左 Cauchy-Green 张量 $\\mathbf{B}$ 为：\n$$ \\mathbf{F} = \\begin{pmatrix} \\lambda & 0 & 0 \\\\ 0 & \\lambda^{-1/2} & 0 \\\\ 0 & 0 & \\lambda^{-1/2} \\end{pmatrix}, \\quad \\mathbf{B} = \\mathbf{F}\\mathbf{F}^T = \\begin{pmatrix} \\lambda^2 & 0 & 0 \\\\ 0 & \\lambda^{-1} & 0 \\\\ 0 & 0 & \\lambda^{-1} \\end{pmatrix} $$\n$\\mathbf{B}$ 的第一不变量是 $I_1 = \\text{tr}(\\mathbf{B}) = \\lambda^2 + 2\\lambda^{-1}$。\nCauchy 应力张量的分量为：\n$$ \\sigma_{11} = -p + c \\exp(k(\\lambda^2 + 2\\lambda^{-1} - 3)) \\lambda^2 $$\n$$ \\sigma_{22} = \\sigma_{33} = -p + c \\exp(k(\\lambda^2 + 2\\lambda^{-1} - 3)) \\lambda^{-1} $$\n问题指定了侧向无面力，这施加了边界条件 $\\sigma_{22} = \\sigma_{33} = 0$。利用此条件，我们求解压力 $p$：\n$$ 0 = -p + c \\exp(k(\\lambda^2 + 2\\lambda^{-1} - 3)) \\lambda^{-1} \\implies p = c \\lambda^{-1} \\exp(k(\\lambda^2 + 2\\lambda^{-1} - 3)) $$\n将此 $p$ 的表达式代入 $\\sigma_{11}$ 的方程：\n$$ \\sigma_{11} = -c \\lambda^{-1} \\exp(k(\\lambda^2 + 2\\lambda^{-1} - 3)) + c \\lambda^2 \\exp(k(\\lambda^2 + 2\\lambda^{-1} - 3)) $$\n提出公因子，得到单轴 Cauchy 应力的最终表达式：\n$$ \\sigma_{11}(\\lambda;c,k) = c (\\lambda^2 - \\lambda^{-1}) \\exp\\left(k(\\lambda^2 + 2\\lambda^{-1} - 3)\\right) $$\n\n**2. 残差的雅可比矩阵的推导**\n\n非线性最小二乘问题旨在找到参数 $(c,k)$ 以最小化残差平方和。对于第 $i$ 个数据点 $(\\lambda_i, \\sigma_{11,i}^{\\text{exp}})$ 的残差是：\n$$ r_i(c,k) = \\sigma_{11}(\\lambda_i;c,k) - \\sigma_{11,i}^{\\text{exp}} $$\n残差向量 $\\mathbf{r}$ 关于参数向量 $\\boldsymbol{\\theta} = [c, k]^T$ 的雅可比矩阵 $\\mathbf{J}$ 的元素为 $J_{ij} = \\partial r_i / \\partial \\theta_j$。$\\mathbf{J}$ 的第 $i$ 行为 $[\\partial r_i/\\partial c, \\partial r_i/\\partial k]$。\n\n对 $c$ 的偏导数为：\n$$ \\frac{\\partial r_i}{\\partial c} = \\frac{\\partial}{\\partial c} \\left[ c (\\lambda_i^2 - \\lambda_i^{-1}) \\exp\\left(k(\\lambda_i^2 + 2\\lambda_i^{-1} - 3)\\right) - \\sigma_{11,i}^{\\text{exp}} \\right] $$\n$$ \\frac{\\partial r_i}{\\partial c} = (\\lambda_i^2 - \\lambda_i^{-1}) \\exp\\left(k(\\lambda_i^2 + 2\\lambda_i^{-1} - 3)\\right) $$\n这也可以写成 $\\partial r_i/\\partial c = \\sigma_{11}(\\lambda_i;c,k)/c$。\n\n对 $k$ 的偏导数为：\n$$ \\frac{\\partial r_i}{\\partial k} = \\frac{\\partial}{\\partial k} \\left[ c (\\lambda_i^2 - \\lambda_i^{-1}) \\exp\\left(k(\\lambda_i^2 + 2\\lambda_i^{-1} - 3)\\right) - \\sigma_{11,i}^{\\text{exp}} \\right] $$\n对指数函数使用链式法则：\n$$ \\frac{\\partial r_i}{\\partial k} = c (\\lambda_i^2 - \\lambda_i^{-1}) \\left[ \\exp\\left(k(\\lambda_i^2 + 2\\lambda_i^{-1} - 3)\\right) \\cdot (\\lambda_i^2 + 2\\lambda_i^{-1} - 3) \\right] $$\n这可以简化为 $\\partial r_i/\\partial k = \\sigma_{11}(\\lambda_i;c,k) \\cdot (\\lambda_i^2 + 2\\lambda_i^{-1} - 3)$。\n\n**3. Gauss-Newton 更新步骤**\n\nGauss-Newton 算法用线性模型局部逼近目标函数。在每次迭代中，我们求解参数更新量 $\\Delta\\boldsymbol{\\theta}$，它最小化线性化的平方和：\n$$ \\Delta\\boldsymbol{\\theta} = \\arg\\min_{\\Delta\\boldsymbol{\\theta}} \\left\\| \\mathbf{J}(\\boldsymbol{\\theta}_0) \\Delta\\boldsymbol{\\theta} + \\mathbf{r}(\\boldsymbol{\\theta}_0) \\right\\|_2^2 $$\n这是一个标准的线性最小二乘问题，可以求解 $\\Delta\\boldsymbol{\\theta}$。然后参数向量更新为 $\\boldsymbol{\\theta}_{\\text{new}} = \\boldsymbol{\\theta}_0 + \\Delta\\boldsymbol{\\theta}$。所提供的程序为每个测试用例实现了此过程的一个步骤。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the parameter estimation problem for a Fung-type hyperelastic model\n    by performing one Gauss-Newton update for three test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"stretches\": np.array([1.05, 1.10, 1.20, 1.30]),\n            \"gt_params\": (10.0, 2.0),\n            \"initial_guess\": (9.0, 1.0)\n        },\n        {\n            \"stretches\": np.array([1.00, 1.02, 1.04, 1.06]),\n            \"gt_params\": (8.0, 1.0),\n            \"initial_guess\": (5.0, 0.5)\n        },\n        {\n            \"stretches\": np.array([1.15, 1.30, 1.45, 1.60]),\n            \"gt_params\": (15.0, 2.5),\n            \"initial_guess\": (12.0, 2.0)\n        }\n    ]\n\n    all_results = []\n\n    def sigma_11_uniaxial(lmbda, c, k):\n        \"\"\"\n        Calculates the uniaxial Cauchy stress sigma_11 for a Fung-type material.\n        \n        Args:\n            lmbda (np.ndarray): Array of stretches.\n            c (float): Material parameter c [kPa].\n            k (float): Material parameter k [dimensionless].\n        \n        Returns:\n            np.ndarray: Array of corresponding stresses [kPa].\n        \"\"\"\n        # To avoid division by zero or warnings for lmbda=0, although not in test cases.\n        lmbda = np.asarray(lmbda)\n        # For lambda=1, the term (lmbda**2 - 1/lmbda) is zero, so stress is correctly zero.\n        # This prevents potential numerical issues with the exponential term.\n        # Use np.where to handle the lmbda=1 case robustly to avoid 0*inf if k is large.\n        \n        # This check is not strictly necessary with test data but is good practice.\n        # The expression is numerically stable for lmbda > 0.\n        is_one = np.isclose(lmbda, 1.0)\n        \n        # Calculate I1, the first invariant\n        I1 = lmbda**2 + 2.0 / lmbda\n        \n        # Calculate stress\n        stress = c * (lmbda**2 - 1.0 / lmbda) * np.exp(k * (I1 - 3.0))\n\n        # Ensure stress is exactly zero at lambda=1\n        stress[is_one] = 0.0\n        \n        return stress\n\n    for case in test_cases:\n        lmbda_data = case[\"stretches\"]\n        c_star, k_star = case[\"gt_params\"]\n        c0, k0 = case[\"initial_guess\"]\n\n        # 1. Generate synthetic experimental data using ground-truth parameters\n        sigma_exp = sigma_11_uniaxial(lmbda_data, c_star, k_star)\n\n        # 2. Evaluate model and residuals at the initial guess (c0, k0)\n        sigma_model_at_theta0 = sigma_11_uniaxial(lmbda_data, c0, k0)\n        residuals = sigma_model_at_theta0 - sigma_exp\n\n        # 3. Construct the Jacobian matrix J at the initial guess (c0, k0)\n        # J has shape (N, 2), where N is the number of data points.\n        # Column 1: d(r_i)/d(c)\n        # Column 2: d(r_i)/d(k)\n        \n        I1_data = lmbda_data**2 + 2.0 / lmbda_data\n        \n        # Partial derivative with respect to c: d(r_i)/d(c) = sigma_i / c\n        # A more direct and robust way is to use the derived formula\n        J_col1 = (lmbda_data**2 - 1.0 / lmbda_data) * np.exp(k0 * (I1_data - 3.0))\n        # Ensure the jacobian entry is zero for lambda = 1\n        is_one_mask = np.isclose(lmbda_data, 1.0)\n        J_col1[is_one_mask] = 0.0\n\n        # Partial derivative with respect to k: d(r_i)/d(k) = sigma_i * (I1_i - 3)\n        J_col2 = sigma_model_at_theta0 * (I1_data - 3.0)\n\n        J = np.stack([J_col1, J_col2], axis=1)\n\n        # 4. Solve the linear least-squares problem for the Gauss-Newton step\n        # J * delta_theta = -residuals\n        delta_theta, _, _, _ = np.linalg.lstsq(J, -residuals, rcond=None)\n        \n        # 5. Update the parameters\n        theta0 = np.array([c0, k0])\n        theta_new = theta0 + delta_theta\n        \n        all_results.extend(theta_new)\n\n    # Format the final output string\n    output_str = \",\".join([f\"{val:.6f}\" for val in all_results])\n    print(f\"[{output_str}]\")\n\nsolve()\n```", "id": "2619321"}]}