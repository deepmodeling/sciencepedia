{"hands_on_practices": [{"introduction": "本章节的第一个练习在一个简化的一维情境下，为小应变和有限应变塑性理论之间架起了桥梁。通过推导和比较两种框架下的算法切线模量，你将能分离并量化几何非线性的影响 [@problem_id:2640736]。这个实践对于培养直觉至关重要，让你理解大变形如何在纯粹源于运动学的本构响应中引入新的“几何”项。", "problem": "一根直棱杆承受单调单轴拉伸，直至达到某一有限轴向拉伸量。为分离几何效应，采用基于乘法分解和 Hencky 弹性的一维有限应变弹塑性模型。\n\n运动学和弹性：设总轴向拉伸为 $\\lambda$，其乘法分解为 $\\lambda = \\lambda_{e}\\,\\lambda_{p}$。定义对数 (Hencky) 应变为 $\\varepsilon = \\ln \\lambda$、$\\varepsilon_{e} = \\ln \\lambda_{e}$ 和 $\\varepsilon_{p} = \\ln \\lambda_{p}$，从而得到 $\\varepsilon = \\varepsilon_{e} + \\varepsilon_{p}$。弹性存储能密度为 $W(\\varepsilon_{e}) = \\tfrac{1}{2} E \\varepsilon_{e}^{2}$，其中 $E$ 为杨氏模量。Kirchhoff 应力为 $\\tau = \\partial W/\\partial \\varepsilon_{e} = E \\varepsilon_{e}$，轴向第一 Piola–Kirchhoff 应力为 $P = \\tau/\\lambda$。\n\n塑性：考虑单调拉伸下的关联、率无关塑性以及线性各向同性硬化。屈服函数为 $\\phi(\\tau,\\kappa) = \\tau - (\\tau_{y0} + H \\kappa) \\le 0$，其中 $\\tau_{y0}$ 是以 Kirchhoff 应力单位表示的初始屈服应力，$H$ 是塑性模量，$\\kappa$ 是累积塑性应变。在单调拉伸下，取 $\\kappa = \\varepsilon_{p}$，流动法则为 $d \\varepsilon_{p} = d \\gamma$，并满足 Kuhn–Tucker 条件 $d\\gamma \\ge 0$、$\\phi \\le 0$、$d\\gamma\\,\\phi = 0$。\n\n加载步和参数：杆件从初始无应力和无塑性应变状态加载至有限拉伸量 $\\lambda = 1.20$。材料参数为 $E = 210\\,\\mathrm{GPa}$、$H = 2\\,\\mathrm{GPa}$ 和 $\\tau_{y0} = 0.300\\,\\mathrm{GPa}$。\n\n目标量定义：将有限应变问题的标量算法模量定义为一致切线\n$$K_{\\mathrm{alg}}^{\\mathrm{F}} := \\frac{d P}{d \\lambda}$$\n该值在加载步结束时沿弹塑性响应路径计算。将其小应变对应量定义为在单调塑性流动下，具有相同 $E$ 和 $H$ 的单轴小应变弹塑性模型的一致弹塑性切线\n$$E_{t}^{\\mathrm{S}} := \\frac{d \\sigma}{d \\varepsilon}$$\n\n任务：从给定的运动学、能量和塑性定义出发，推导在 $\\lambda = 1.20$ 时的 $K_{\\mathrm{alg}}^{\\mathrm{F}}$ 和 $E_{t}^{\\mathrm{S}}$，并计算其比率\n$$r := \\frac{K_{\\mathrm{alg}}^{\\mathrm{F}}}{E_{t}^{\\mathrm{S}}}.$$\n最终答案 $r$ 以纯数形式给出，四舍五入至四位有效数字。最终数值不带单位。", "solution": "首先对问题陈述进行严格验证。\n\n**步骤 1：提取已知条件**\n- **运动学**：总轴向拉伸 $\\lambda$，其乘法分解为 $\\lambda = \\lambda_{e}\\,\\lambda_{p}$。对数 (Hencky) 应变：$\\varepsilon = \\ln \\lambda$、$\\varepsilon_{e} = \\ln \\lambda_{e}$ 和 $\\varepsilon_{p} = \\ln \\lambda_{p}$，从而得到加法分解 $\\varepsilon = \\varepsilon_{e} + \\varepsilon_{p}$。\n- **弹性**：弹性存储能密度 $W(\\varepsilon_{e}) = \\tfrac{1}{2} E \\varepsilon_{e}^{2}$。Kirchhoff 应力 $\\tau = \\partial W/\\partial \\varepsilon_{e} = E \\varepsilon_{e}$。第一 Piola–Kirchhoff 应力 $P = \\tau/\\lambda$。\n- **塑性**：关联、率无关塑性与线性各向同性硬化。屈服函数 $\\phi(\\tau,\\kappa) = \\tau - (\\tau_{y0} + H \\kappa) \\le 0$。在单调拉伸下，累积塑性应变为 $\\kappa = \\varepsilon_{p}$。流动法则为 $d \\varepsilon_{p} = d \\gamma$，并满足 Kuhn–Tucker 条件 $d\\gamma \\ge 0$、$\\phi \\le 0$、$d\\gamma\\,\\phi = 0$。\n- **加载和参数**：杆件从无应力和无塑性应变状态加载至最终拉伸量 $\\lambda = 1.20$。材料参数为杨氏模量 $E = 210\\,\\mathrm{GPa}$，塑性模量 $H = 2\\,\\mathrm{GPa}$，初始屈服应力 $\\tau_{y0} = 0.300\\,\\mathrm{GPa}$。\n- **目标量**：\n  - 有限应变算法模量：$K_{\\mathrm{alg}}^{\\mathrm{F}} := \\frac{d P}{d \\lambda}$，在 $\\lambda=1.20$ 处计算。\n  - 小应变一致弹塑性切线：$E_{t}^{\\mathrm{S}} := \\frac{d \\sigma}{d \\varepsilon}$，对于具有相同 $E$ 和 $H$ 的小应变模型。\n  - 比率：$r := \\frac{K_{\\mathrm{alg}}^{\\mathrm{F}}}{E_{t}^{\\mathrm{S}}}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题在连续介质塑性力学的标准框架内构建，利用了乘法运动学、基于 Hencky 应变的超弹性定律以及关联流动理论。这些都是固体力学中公认的基本概念。\n- **良态问题**：问题陈述是完全指定的。本构模型完整，初始条件已给出，加载方式已定义，所有材料参数均已提供。目标是计算一个定义明确的数学量。\n- **客观性**：问题陈述使用了精确、无歧义的数学和物理术语。\n\n**结论**：该问题在科学上是合理的、自洽的且是良态的。它不违反任何无效标准。因此，将推导其解。\n\n推导过程分三部分：首先，推导小应变切线模量 $E_{t}^{\\mathrm{S}}$；其次，推导有限应变切线模量 $K_{\\mathrm{alg}}^{\\mathrm{F}}$；最后，计算比率 $r$。\n\n**第 1 部分：小应变切线模量 $E_{t}^{\\mathrm{S}}$ 的推导**\n在小应变情况下，应力和应变的关系为 $\\sigma = E(\\varepsilon - \\varepsilon_p)$。在塑性流动期间，单调拉伸的屈服条件为 $\\phi = \\sigma - (\\sigma_{y0} + H\\varepsilon_p) = 0$。一致性条件 $d\\phi = 0$ 必须成立。\n$$ d\\phi = d\\sigma - H d\\varepsilon_p = 0 \\implies d\\sigma = H d\\varepsilon_p $$\n根据弹性关系，我们求导得到 $d\\sigma = E(d\\varepsilon - d\\varepsilon_p)$。\n将 $d\\varepsilon_p = d\\sigma/H$ 代入微分后的弹性定律得到：\n$$ d\\sigma = E\\left(d\\varepsilon - \\frac{d\\sigma}{H}\\right) $$\n$$ d\\sigma \\left(1 + \\frac{E}{H}\\right) = E d\\varepsilon $$\n$$ d\\sigma \\left(\\frac{H+E}{H}\\right) = E d\\varepsilon $$\n因此，小应变切线模量为：\n$$ E_{t}^{\\mathrm{S}} = \\frac{d\\sigma}{d\\varepsilon} = \\frac{EH}{E+H} $$\n这是线性硬化的一个标准结果。\n\n**第 2 部分：有限应变算法模量 $K_{\\mathrm{alg}}^{\\mathrm{F}}$ 的推导**\n目标是 $K_{\\mathrm{alg}}^{\\mathrm{F}} = \\frac{dP}{d\\lambda}$。第一 Piola-Kirchhoff 应力为 $P = \\tau/\\lambda$。对 $\\lambda$ 使用商法则求导：\n$$ K_{\\mathrm{alg}}^{\\mathrm{F}} = \\frac{d P}{d \\lambda} = \\frac{1}{\\lambda}\\frac{d\\tau}{d\\lambda} - \\frac{\\tau}{\\lambda^2} $$\n为求得 $\\frac{d\\tau}{d\\lambda}$，我们使用有限应变模型的本构关系和一致性条件。在塑性加载期间，屈服条件是激活的：$\\phi = \\tau - (\\tau_{y0} + H\\varepsilon_p) = 0$。其率形式为 $d\\phi = 0$：\n$$ d\\tau - H d\\varepsilon_p = 0 \\implies d\\tau = H d\\varepsilon_p $$\nKirchhoff 应力也由弹性定律 $\\tau = E\\varepsilon_e = E(\\varepsilon - \\varepsilon_p) = E(\\ln\\lambda - \\varepsilon_p)$ 给出。对 $\\lambda$ 求导得到：\n$$ \\frac{d\\tau}{d\\lambda} = E \\left(\\frac{1}{\\lambda} - \\frac{d\\varepsilon_p}{d\\lambda}\\right) $$\n我们得到了一个关于率 $\\frac{d\\tau}{d\\lambda}$ 和 $\\frac{d\\varepsilon_p}{d\\lambda}$ 的二元方程组。从一致性条件可知，$\\frac{d\\varepsilon_p}{d\\lambda} = \\frac{1}{H}\\frac{d\\tau}{d\\lambda}$。将此代入第二个方程：\n$$ \\frac{d\\tau}{d\\lambda} = E \\left(\\frac{1}{\\lambda} - \\frac{1}{H}\\frac{d\\tau}{d\\lambda}\\right) $$\n$$ \\frac{d\\tau}{d\\lambda}\\left(1 + \\frac{E}{H}\\right) = \\frac{E}{\\lambda} $$\n$$ \\frac{d\\tau}{d\\lambda}\\left(\\frac{E+H}{H}\\right) = \\frac{E}{\\lambda} $$\n解出 $\\frac{d\\tau}{d\\lambda}$：\n$$ \\frac{d\\tau}{d\\lambda} = \\frac{E}{\\lambda}\\frac{H}{E+H} = \\frac{1}{\\lambda} E_{t}^{\\mathrm{S}} $$\n现在，我们将此结果代回 $K_{\\mathrm{alg}}^{\\mathrm{F}}$ 的表达式中：\n$$ K_{\\mathrm{alg}}^{\\mathrm{F}} = \\frac{1}{\\lambda}\\left(\\frac{1}{\\lambda}E_{t}^{\\mathrm{S}}\\right) - \\frac{\\tau}{\\lambda^2} = \\frac{E_{t}^{\\mathrm{S}} - \\tau}{\\lambda^2} $$\n该表达式需要指定最终拉伸量 $\\lambda = 1.20$ 时的 Kirchhoff 应力 $\\tau$ 的值。\n\n**第 3 部分：状态变量与比率 $r$ 的计算**\n首先，我们必须确定在 $\\lambda = 1.20$ 时材料是否已屈服。当纯弹性变形产生的应力达到 $\\tau_{y0}$ 时，发生屈服。在弹性范围内，$\\varepsilon_p = 0$，因此 $\\tau = E\\varepsilon_e = E\\ln\\lambda$。屈服时的拉伸量 $\\lambda_y$ 可通过令 $\\tau = \\tau_{y0}$ 求得：\n$$ E \\ln\\lambda_y = \\tau_{y0} \\implies \\lambda_y = \\exp\\left(\\frac{\\tau_{y0}}{E}\\right) $$\n使用给定值，$\\frac{\\tau_{y0}}{E} = \\frac{0.300\\,\\mathrm{GPa}}{210\\,\\mathrm{GPa}} = \\frac{1}{700}$。\n$$ \\lambda_y = \\exp\\left(\\frac{1}{700}\\right) \\approx 1.00143 $$\n由于最终拉伸量 $\\lambda=1.20$ 大于 $\\lambda_y$，材料处于塑性状态。\n\n为求得 $\\lambda = 1.20$ 时的应力 $\\tau$，我们求解由屈服条件和本构定律定义的方程组：\n1. $\\tau = \\tau_{y0} + H\\varepsilon_p$\n2. $\\tau = E(\\ln\\lambda - \\varepsilon_p)$\n令 $\\tau$ 的表达式相等：\n$$ \\tau_{y0} + H\\varepsilon_p = E\\ln\\lambda - E\\varepsilon_p $$\n解出塑性应变 $\\varepsilon_p$：\n$$ (E+H)\\varepsilon_p = E\\ln\\lambda - \\tau_{y0} \\implies \\varepsilon_p = \\frac{E\\ln\\lambda - \\tau_{y0}}{E+H} $$\n将 $\\varepsilon_p$ 的表达式代回屈服条件以求得 $\\tau$：\n$$ \\tau = \\tau_{y0} + H\\left(\\frac{E\\ln\\lambda - \\tau_{y0}}{E+H}\\right) = \\frac{\\tau_{y0}(E+H) + H(E\\ln\\lambda - \\tau_{y0})}{E+H} $$\n$$ \\tau = \\frac{E\\tau_{y0} + HE\\ln\\lambda}{E+H} = \\frac{E}{E+H}\\tau_{y0} + \\frac{EH}{E+H}\\ln\\lambda = \\frac{E}{E+H}\\tau_{y0} + E_{t}^{\\mathrm{S}}\\ln\\lambda $$\n所求比率为 $r = \\frac{K_{\\mathrm{alg}}^{\\mathrm{F}}}{E_{t}^{\\mathrm{S}}}$。代入推导出的表达式：\n$$ r = \\frac{(E_{t}^{\\mathrm{S}}-\\tau)/\\lambda^2}{E_{t}^{\\mathrm{S}}} = \\frac{1}{\\lambda^2}\\left(1 - \\frac{\\tau}{E_{t}^{\\mathrm{S}}}\\right) $$\n我们可以用 $\\tau$ 的表达式来简化 $\\frac{\\tau}{E_{t}^{\\mathrm{S}}}$ 项：\n$$ \\frac{\\tau}{E_{t}^{\\mathrm{S}}} = \\frac{\\frac{E}{E+H}\\tau_{y0} + E_{t}^{\\mathrm{S}}\\ln\\lambda}{E_{t}^{\\mathrm{S}}} = \\left(\\frac{E}{E+H}\\tau_{y0}\\right)\\frac{1}{E_{t}^{\\mathrm{S}}} + \\ln\\lambda $$\n因为 $E_{t}^{\\mathrm{S}} = \\frac{EH}{E+H}$，其倒数为 $\\frac{1}{E_{t}^{\\mathrm{S}}} = \\frac{E+H}{EH}$。\n$$ \\frac{\\tau}{E_{t}^{\\mathrm{S}}} = \\left(\\frac{E}{E+H}\\tau_{y0}\\right)\\left(\\frac{E+H}{EH}\\right) + \\ln\\lambda = \\frac{\\tau_{y0}}{H} + \\ln\\lambda $$\n这就得到了比率 r 的一个简单表达式：\n$$ r = \\frac{1}{\\lambda^2}\\left(1 - \\left(\\frac{\\tau_{y0}}{H} + \\ln\\lambda\\right)\\right) $$\n现在，我们代入数值：$\\lambda = 1.20$、$\\tau_{y0} = 0.300\\,\\mathrm{GPa}$ 和 $H = 2\\,\\mathrm{GPa}$。\n$$ r = \\frac{1}{(1.20)^2}\\left(1 - \\left(\\frac{0.300}{2} + \\ln(1.20)\\right)\\right) $$\n$$ r = \\frac{1}{1.44}\\left(1 - (0.150 + 0.182321556...)\\right) $$\n$$ r = \\frac{1}{1.44}\\left(1 - 0.332321556...\\right) $$\n$$ r = \\frac{0.667678443...}{1.44} $$\n$$ r \\approx 0.46366558... $$\n四舍五入至四位有效数字，结果为 $0.4637$。\n与纯材料模量 $E_{t}^{\\mathrm{S}}$ 相比，比率 $r$ 量化了在有限应变设置中，几何软化（$K_{\\mathrm{alg}}^{\\mathrm{F}}$ 中的 $-\\tau/\\lambda^2$ 项）和运动学标度（因子 $1/\\lambda^2$）对切线模量的综合效应。", "answer": "$$\\boxed{0.4637}$$", "id": "2640736"}, {"introduction": "从一维分析进入三维计算塑性学的核心，这个实践将挑战你推导隐式返回映射算法的中心方程 [@problem_id:2640759]。你将为一个标准的 von Mises 模型建立标量一致性条件，这个条件是大多数有限元代码中驱动数值求解的“引擎”。掌握这一推导过程是理解在塑性流动条件下材料状态如何被正确更新的基石。", "problem": "考虑一个经历有限应变的各向同性弹塑性材料。其运动学遵循变形梯度的乘法分解，$\\,\\mathbf{F} = \\mathbf{F}_{\\mathrm{e}} \\mathbf{F}_{\\mathrm{p}}$，且塑性流动是等体积的，$\\,\\det \\mathbf{F}_{\\mathrm{p}} = 1\\,$. 假设弹性自由能为可压缩 Neo-Hookean 型，\n$$\nW(\\mathbf{b}_{\\mathrm{e}},J) = \\tfrac{1}{2}\\kappa \\big(\\ln J\\big)^{2} + \\tfrac{\\mu}{2}\\Big(\\operatorname{tr}(\\mathbf{b}_{\\mathrm{e}}) - 3 - 2 \\ln J\\Big),\n$$\n其中 $\\,\\mathbf{b}_{\\mathrm{e}} = \\mathbf{F}_{\\mathrm{e}}\\mathbf{F}_{\\mathrm{e}}^{\\mathsf{T}}\\,$ 是弹性左 Cauchy-Green 张量，$\\,J = \\det \\mathbf{F}\\,$，$\\,\\kappa\\,$ 是体积模量，$\\,\\mu\\,$ 是剪切模量。Kirchhoff 应力定义为\n$$\n\\boldsymbol{\\tau} = \\kappa \\ln J \\,\\mathbf{I} + \\mu\\,\\operatorname{dev}(\\mathbf{b}_{\\mathrm{e}}), \\quad \\text{so that} \\quad \\mathbf{s} := \\operatorname{dev}(\\boldsymbol{\\tau}) = \\mu\\,\\operatorname{dev}(\\mathbf{b}_{\\mathrm{e}}).\n$$\n塑性由一个带有线性各向同性硬化的关联 von Mises (也称为 $J_{2}$) 屈服函数控制，\n$$\n\\Phi(\\boldsymbol{\\tau}, \\bar{\\varepsilon}^{\\mathrm{p}}) = \\big\\|\\mathbf{s}\\big\\| - \\sqrt{\\tfrac{2}{3}}\\Big(\\sigma_{y0} + H\\,\\bar{\\varepsilon}^{\\mathrm{p}}\\Big) \\le 0,\n$$\n其中 $\\,\\|\\cdot\\|\\,$ 表示 Frobenius 范数，$\\,\\sigma_{y0}\\,$ 是初始屈服应力，$\\,H\\,$ 是塑性模量，$\\,\\bar{\\varepsilon}^{\\mathrm{p}}\\,$ 是累积等效塑性应变。流动法则是关联的，塑性变形率为 $\\,\\mathbf{D}_{\\mathrm{p}} = \\dot{\\gamma}\\,\\mathbf{n}\\,$，其中 $\\,\\mathbf{n} = \\partial \\Phi/\\partial \\boldsymbol{\\tau} = \\mathbf{s}/\\|\\mathbf{s}\\|\\,$ 是流动方向，硬化法则是 $\\,\\dot{\\bar{\\varepsilon}}^{\\mathrm{p}} = \\dot{\\gamma}\\,$. 在一个从 $\\,t_{n}\\,$ 到 $\\,t_{n+1}\\,$ 的时间步内，使用后向欧拉时间离散化方法对演化方程进行离散，并采用标准的弹性预测-塑性校正（隐式返回映射）算法。用上标 $\\,\\mathrm{tr}\\,$ 表示试探量（通过在该步中将塑性增量设为零得到）。\n\n从上述定义和乘法运动学出发，推导在该步结束时强制执行屈服条件的算法一致性条件，并证明未知的塑性乘子增量 $\\,\\Delta\\gamma\\,$ 可以通过求解一个单一的标量非线性方程获得。消去张量未知数，用 $\\,\\Delta\\gamma\\,$ 和先前已知的第 $\\,n\\,$ 步的量来表示。假设在校正过程中，方向 $\\,\\mathbf{n}_{n+1}\\,$ 与试探偏 Kirchhoff 应力方向对齐，即 $\\,\\mathbf{n}_{n+1} = \\mathbf{s}^{\\mathrm{tr}}/\\|\\mathbf{s}^{\\mathrm{tr}}\\|\\,$，并且在关联 $J_{2}$ 塑性与 Neo-Hookean 弹性的后向欧拉格式下，偏 Kirchhoff 应力沿着 $\\,\\mathbf{n}_{n+1}\\,$ 进行校正。\n\n您的最终任务是提供标量残差函数 $\\,R(\\Delta\\gamma)\\,$，其根在 $\\,t_{n+1}\\,$ 时刻强制执行算法一致性条件。仅用 $\\,\\|\\mathbf{s}^{\\mathrm{tr}}\\|\\,$、$\\,\\mu\\,$、$\\,\\sigma_{y0}\\,$、$\\,H\\,$ 和 $\\,\\bar{\\varepsilon}^{\\mathrm{p}}_{n}\\,$ 来表达 $\\,R(\\Delta\\gamma)\\,$。不要在最终的方框答案中包含任何需要求解的方程；仅以单一闭合形式表达式提供残差函数。不需要进行数值计算。所有的数学实体都用 LaTeX 表示。", "solution": "在尝试任何解答之前，将首先分析问题的有效性。\n\n首先，我将逐字从问题陈述中提取已知条件。\n-   运动学：乘法分解 $\\mathbf{F} = \\mathbf{F}_{\\mathrm{e}} \\mathbf{F}_{\\mathrm{p}}$。\n-   塑性流动约束：等体积，$\\det \\mathbf{F}_{\\mathrm{p}} = 1$。\n-   弹性自由能函数（可压缩 Neo-Hookean）：$W(\\mathbf{b}_{\\mathrm{e}},J) = \\tfrac{1}{2}\\kappa (\\ln J)^{2} + \\tfrac{\\mu}{2}(\\operatorname{tr}(\\mathbf{b}_{\\mathrm{e}}) - 3 - 2 \\ln J)$。\n-   弹性左 Cauchy-Green 张量：$\\mathbf{b}_{\\mathrm{e}} = \\mathbf{F}_{\\mathrm{e}}\\mathbf{F}_{\\mathrm{e}}^{\\mathsf{T}}$。\n-   总体积变化：$J = \\det \\mathbf{F}$。\n-   Kirchhoff 应力张量：$\\boldsymbol{\\tau} = \\kappa \\ln J \\,\\mathbf{I} + \\mu\\,\\operatorname{dev}(\\mathbf{b}_{\\mathrm{e}})$。\n-   偏 Kirchhoff 应力：$\\mathbf{s} := \\operatorname{dev}(\\boldsymbol{\\tau}) = \\mu\\,\\operatorname{dev}(\\mathbf{b}_{\\mathrm{e}})$。\n-   屈服函数（带线性各向同性硬化的 von Mises）：$\\Phi(\\boldsymbol{\\tau}, \\bar{\\varepsilon}^{\\mathrm{p}}) = \\|\\mathbf{s}\\| - \\sqrt{\\tfrac{2}{3}}(\\sigma_{y0} + H\\,\\bar{\\varepsilon}^{\\mathrm{p}}) \\le 0$。\n-   流动法则：关联的，塑性变形率为 $\\mathbf{D}_{\\mathrm{p}} = \\dot{\\gamma}\\,\\mathbf{n}$。\n-   流动方向：$\\mathbf{n} = \\partial \\Phi/\\partial \\boldsymbol{\\tau} = \\mathbf{s}/\\|\\mathbf{s}\\|$。\n-   硬化法则：$\\dot{\\bar{\\varepsilon}}^{\\mathrm{p}} = \\dot{\\gamma}$。\n-   数值格式：在从 $t_{n}$ 到 $t_{n+1}$ 的时间步上使用后向欧拉时间离散化，通过弹性预测-塑性校正算法实现。\n-   假设1：在校正步中，流动方向是固定的：$\\mathbf{n}_{n+1} = \\mathbf{s}^{\\mathrm{tr}}/\\|\\mathbf{s}^{\\mathrm{tr}}\\|$。\n-   假设2：偏 Kirchhoff 应力沿此固定方向进行校正。\n-   任务：推导塑性乘子增量 $\\Delta\\gamma$ 的标量残差函数 $R(\\Delta\\gamma)$。\n\n接下来，我将验证问题陈述。\n该问题具有科学依据。它提出了一个计算有限应变弹塑性的标准框架，利用了诸如乘法运动学、Neo-Hookean 超弹性模型和关联 $J_{2}$ 流动理论等公认的概念。这些是现代固体力学的基石性课题。\n该问题是适定的。它要求在返回映射算法中推导塑性乘子的标量方程，这是计算力学中一个标准的、可解的问题。所提供的假设，例如固定的流动方向，是简化算法并确保增量 $\\Delta\\gamma$ 具有唯一解的典型做法。\n该问题是客观且自洽的。所有必要的本构定义、运动学关系和演化方程都已提供。语言精确，没有主观论断。该问题直接关系到*固体力学*中指定的*有限应变塑性*领域。没有内部矛盾或缺失信息会妨碍严谨的推导。\n基于此分析，该问题被认为是**有效的**。我现在开始进行解答。\n\n目标是推导标量残差函数 $R(\\Delta\\gamma)$，当其为零时，可确定从时间步 $t_{n}$ 到 $t_{n+1}$ 的塑性乘子增量 $\\Delta\\gamma$。这是在弹性预测-塑性校正算法的框架内，使用后向欧拉积分格式完成的。我们考虑塑性加载的情况，即试探状态违反了屈服条件。\n\n校正阶段从 $t_{n}$ 时刻的状态和 $t_{n+1}$ 时刻的试探状态开始。目标是找到 $t_{n+1}$ 时刻满足屈服条件的更新后状态。待更新的状态变量是 Kirchhoff 应力 $\\boldsymbol{\\tau}_{n+1}$ 和等效塑性应变 $\\bar{\\varepsilon}^{\\mathrm{p}}_{n+1}$。驱动更新的未知量是 $\\Delta\\gamma$。\n\n根据后向欧拉格式以及问题中针对关联 $J_{2}$ 塑性与给定 Neo-Hookean 模型的假设，偏 Kirchhoff 应力 $\\mathbf{s}_{n+1}$ 是通过在偏应力空间中对试探应力 $\\mathbf{s}^{\\mathrm{tr}}$ 进行径向返回得到的。这个更新法则是：\n$$\n\\mathbf{s}_{n+1} = \\mathbf{s}^{\\mathrm{tr}} - 2\\mu\\Delta\\gamma \\mathbf{n}_{n+1}\n$$\n因子 $2\\mu\\Delta\\gamma$ 是校正的大小。问题明确指出校正方向为试探偏应力方向的假设，即 $\\mathbf{n}_{n+1} = \\mathbf{s}^{\\mathrm{tr}}/\\|\\mathbf{s}^{\\mathrm{tr}}\\|$。将此代入更新法则得到：\n$$\n\\mathbf{s}_{n+1} = \\mathbf{s}^{\\mathrm{tr}} - 2\\mu\\Delta\\gamma \\frac{\\mathbf{s}^{\\mathrm{tr}}}{\\|\\mathbf{s}^{\\mathrm{tr}}\\|} = \\left( 1 - \\frac{2\\mu\\Delta\\gamma}{\\|\\mathbf{s}^{\\mathrm{tr}}\\|} \\right) \\mathbf{s}^{\\mathrm{tr}}\n$$\n此关系表明 $\\mathbf{s}_{n+1}$ 与 $\\mathbf{s}^{\\mathrm{tr}}$ 共线。对两边取 Frobenius 范数，得到更新后的偏应力的大小：\n$$\n\\|\\mathbf{s}_{n+1}\\| = \\left| 1 - \\frac{2\\mu\\Delta\\gamma}{\\|\\mathbf{s}^{\\mathrm{tr}}\\|} \\right| \\|\\mathbf{s}^{\\mathrm{tr}}\\|\n$$\n由于塑性变形必须减小应力的大小，我们有 $\\|\\mathbf{s}_{n+1}\\| < \\|\\mathbf{s}^{\\mathrm{tr}}\\|$，这意味着 $2\\mu\\Delta\\gamma > 0$。因此，可以去掉绝对值，从而得到：\n$$\n\\|\\mathbf{s}_{n+1}\\| = \\|\\mathbf{s}^{\\mathrm{tr}}\\| - 2\\mu\\Delta\\gamma\n$$\n接下来，我们更新累积等效塑性应变 $\\bar{\\varepsilon}^{\\mathrm{p}}$。其演化由硬化法则 $\\dot{\\bar\\varepsilon}^{\\mathrm{p}} = \\dot{\\gamma}$ 给出。对该率方程应用后向欧拉格式得到：\n$$\n\\frac{\\bar{\\varepsilon}^{\\mathrm{p}}_{n+1} - \\bar{\\varepsilon}^{\\mathrm{p}}_{n}}{\\Delta t} = \\dot{\\gamma}_{n+1}\n$$\n其中 $\\Delta\\gamma = \\dot{\\gamma}_{n+1}\\Delta t$ 是该步内的塑性乘子增量。这得出了更新法则：\n$$\n\\bar{\\varepsilon}^{\\mathrm{p}}_{n+1} = \\bar{\\varepsilon}^{\\mathrm{p}}_{n} + \\Delta\\gamma\n$$\n算法一致性条件要求该步结束时的状态位于屈服面上。对于塑性加载（$\\Delta\\gamma > 0$），这意味着屈服函数必须为零：\n$$\n\\Phi(\\boldsymbol{\\tau}_{n+1}, \\bar{\\varepsilon}^{\\mathrm{p}}_{n+1}) = 0\n$$\n代入屈服函数的定义，我们有：\n$$\n\\|\\mathbf{s}_{n+1}\\| - \\sqrt{\\frac{2}{3}}\\Big(\\sigma_{y0} + H\\,\\bar{\\varepsilon}^{\\mathrm{p}}_{n+1}\\Big) = 0\n$$\n现在，我们将推导出的 $\\|\\mathbf{s}_{n+1}\\|$ 和 $\\bar{\\varepsilon}^{\\mathrm{p}}_{n+1}$ 的更新表达式代入此一致性条件。这将消去张量未知数，代之以标量未知数 $\\Delta\\gamma$：\n$$\n\\left( \\|\\mathbf{s}^{\\mathrm{tr}}\\| - 2\\mu\\Delta\\gamma \\right) - \\sqrt{\\frac{2}{3}}\\Big(\\sigma_{y0} + H\\,(\\bar{\\varepsilon}^{\\mathrm{p}}_{n} + \\Delta\\gamma)\\Big) = 0\n$$\n这就是关于 $\\Delta\\gamma$ 的单一标量方程。问题要求提供残差函数 $R(\\Delta\\gamma)$，其根是该方程的解。我们将该方程的左侧定义为残差函数：\n$$\nR(\\Delta\\gamma) = \\|\\mathbf{s}^{\\mathrm{tr}}\\| - 2\\mu\\Delta\\gamma - \\sqrt{\\frac{2}{3}}\\Big(\\sigma_{y0} + H\\,(\\bar{\\varepsilon}^{\\mathrm{p}}_{n} + \\Delta\\gamma)\\Big)\n$$\n该表达式仅依赖于试探偏应力范数 $\\|\\mathbf{s}^{\\mathrm{tr}}\\|$、材料参数 $\\mu$、$\\sigma_{y0}$、$H$、前一步已知的塑性应变 $\\bar{\\varepsilon}^{\\mathrm{p}}_{n}$，以及未知增量 $\\Delta\\gamma$，符合问题陈述的要求。", "answer": "$$\n\\boxed{\\|\\mathbf{s}^{\\mathrm{tr}}\\| - 2\\mu\\Delta\\gamma - \\sqrt{\\frac{2}{3}}\\Big(\\sigma_{y0} + H(\\bar{\\varepsilon}^{\\mathrm{p}}_{n} + \\Delta\\gamma)\\Big)}\n$$", "id": "2640759"}, {"introduction": "最后的这个练习将理论付诸实践，指导你为一个平面应变压缩场景实现一个完整的有限应变塑性算法 [@problem_id:2640752]。基于返回映射的原理，你将编写代码来更新塑性变形梯度，并从数值上验证塑性不可压缩性这一基本原则。这项动手编程任务将抽象的本构方程转化为一个可触摸的计算工具，从而巩固你的理解。", "problem": "考虑一个均匀、等温的固体，它经历有限平面应变压缩，其行为由一个具有乘法运动学的率无关、各向同性 von Mises (J2) 有限应变塑性模型来描述。令总变形梯度表示为 $F \\in \\mathbb{R}^{3 \\times 3}$，弹性变形梯度为 $F_{e} \\in \\mathbb{R}^{3 \\times 3}$，塑性变形梯度为 $F_{p} \\in \\mathbb{R}^{3 \\times 3}$，它们通过乘法分解 $F = F_{e} F_{p}$ 关联。假设塑性不可压缩，即 $\\det(F_{p}) = 1$。定义弹性右 Cauchy-Green 张量 $C_{e} = F_{e}^{\\mathsf{T}} F_{e}$，弹性对数 (Hencky) 应变 $E_{e} = \\tfrac{1}{2} \\ln(C_{e})$，以及 Mandel 应力 $M$。取弹性自由能为关于 $E_{e}$ 的二次型，即\n$$\nW(E_{e}) = \\mu \\, \\| \\operatorname{dev}(E_{e}) \\|^{2} + \\frac{\\kappa}{2} \\left( \\operatorname{tr}(E_{e}) \\right)^{2},\n$$\n其中 $\\mu > 0$ 是剪切模量，$\\kappa > 0$ 是体积模量，$\\operatorname{dev}(\\cdot)$ 是偏量算子，$\\operatorname{tr}(\\cdot)$ 是迹，$\\|\\cdot\\|$ 是 Frobenius 范数。由此能量可得 Mandel 应力为\n$$\nM = 2 \\mu \\, \\operatorname{dev}(E_{e}) + \\kappa \\, \\operatorname{tr}(E_{e}) \\, I,\n$$\n其中 $I$ 是单位张量。塑性模型为带有线性各向同性硬化的相关 von Mises (J2) 模型。引入等效塑性应变 $p \\ge 0$ 和屈服应力 $\\sigma_{y}(p) = \\sigma_{y0} + H p$，其中初始屈服应力为 $\\sigma_{y0} \\ge 0$，硬化模量为 $H \\ge 0$。屈服函数为\n$$\n\\Phi(M, p) = \\| \\operatorname{dev}(M) \\| - \\sqrt{\\frac{2}{3}} \\, \\sigma_{y}(p) \\le 0.\n$$\n塑性流动在 Mandel 应力空间中是相关的，并且是塑性体积不变的。该过程在给定的运动学路径下，通过增量步在离散伪时间中推进。\n\n任务。从这些核心定义出发，推导一个健全、完全一致的算法，用以计算沿给定对角平面应变压缩路径下 $F_{p}$ 和相应 $M$ 的演化，并数值上验证塑性不可压缩性。整个加载路径是对角的和共轴的：令\n$$\nF = \\operatorname{diag}(\\lambda, 1, 1),\n$$\n其中给定的拉伸比 $\\lambda \\in (0,1]$ 从 $\\lambda = 1$ 开始，经过给定数量的相等增量步，单调地施加到一个最终值。假设零弹塑性自旋，并且所有张量在整个加载过程中在固定基底下保持对角形式，因此主方向不发生演化。\n\n待推导和实现的算法要求：\n- 使用乘法分解 $F = F_{e} F_{p}$，初始条件为 $F_{p}^{0} = I$ 和 $p^{0} = 0$。\n- 在每个增量步，使用 $C = F^{\\mathsf{T}} F$ 计算 $C_{e}^{\\mathrm{tr}} = F_{p}^{-\\mathsf{T}} C F_{p}^{-1}$，然后计算 $E_{e}^{\\mathrm{tr}} = \\tfrac{1}{2} \\ln(C_{e}^{\\mathrm{tr}})$ 和试探 Mandel 应力，从而得到试探弹性状态。\n- 若为弹性，则接受试探状态。若为塑性，则执行一个与 Mandel 应力空间中的相关 von Mises (J2) 塑性及塑性不可压缩性一致的隐式返回映射，偏量地更新 $E_{e}$ 同时保持 $\\operatorname{tr}(E_{e})$ 不变，更新 $p$，重构 $F_{e}$，然后通过乘法分解重构 $F_{p}$。\n- 在每个增量步计算并记录 $F_{p}$ 的行列式，以验证塑性不可压缩性。\n\n交付成果和数值输出：\n- 为以下三个案例的测试套件实现上述算法。所有应力和模量单位为帕斯卡 (Pa)，拉伸比为无量纲。对每个案例，压缩过程沿 $F = \\operatorname{diag}(\\lambda,1,1)$ 路径，从 $\\lambda=1$ 到 $\\lambda=\\lambda_{\\mathrm{final}}$ 分 $N$ 个相等的增量步单调进行。\n  1. 案例 A (一般塑性响应): $\\mu = 80 \\times 10^{6}$, $\\kappa = 160 \\times 10^{6}$, $\\sigma_{y0} = 120 \\times 10^{6}$, $H = 10 \\times 10^{6}$, $N = 60$, $\\lambda_{\\mathrm{final}} = 0.70$。\n  2. 案例 B (近弹性响应): 与案例 A 相同的材料参数，但 $N = 10$, $\\lambda_{\\mathrm{final}} = 0.98$。\n  3. 案例 C (理想塑性边缘情况): $\\mu = 50 \\times 10^{6}$, $\\kappa = 100 \\times 10^{6}$, $\\sigma_{y0} = 80 \\times 10^{6}$, $H = 0$, $N = 80$, $\\lambda_{\\mathrm{final}} = 0.60$。\n- 对每个案例，您的程序必须输出一个实数：整个加载路径上与塑性不可压缩性的最大绝对偏差，定义为\n$$\n\\max_{k=1,\\dots,N} \\left| \\det(F_{p}^{(k)}) - 1 \\right|.\n$$\n- 最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[rA,rB,rC]”），其中 $rA$、$rB$ 和 $rC$ 分别是案例 A、B 和 C 的结果，表示为小数（无量纲）。\n\n此问题不使用角度度量。所有物理常数均使用国际单位制（帕斯卡）。所有要求的数值结果均为如上定义的无量纲浮点数。", "solution": "我们从乘法运动学 $F = F_{e} F_{p}$ 和塑性不可压缩性条件 $\\det(F_{p}) = 1$ 开始。弹性右 Cauchy-Green 张量为 $C_{e} = F_{e}^{\\mathsf{T}} F_{e}$，其对数 (Hencky) 应变为 $E_{e} = \\tfrac{1}{2} \\ln(C_{e})$。所采用的弹性自由能\n$$\nW(E_{e}) = \\mu \\, \\| \\operatorname{dev}(E_{e}) \\|^{2} + \\frac{\\kappa}{2} \\left( \\operatorname{tr}(E_{e}) \\right)^{2}\n$$\n是客观且各向同性的，由此导出 Mandel 应力\n$$\nM = \\frac{\\partial W}{\\partial E_{e}} = 2 \\mu \\, \\operatorname{dev}(E_{e}) + \\kappa \\, \\operatorname{tr}(E_{e}) \\, I.\n$$\n带有线性各向同性硬化的 von Mises (J2) 屈服函数为\n$$\n\\Phi(M, p) = \\| \\operatorname{dev}(M) \\| - \\sqrt{\\frac{2}{3}} \\left( \\sigma_{y0} + H p \\right) \\le 0,\n$$\n其塑性流动在 Mandel 应力空间中是相关的，同时确保塑性体积不变（零塑性体积应变率）。\n\n给定路径下的运动学和共轴性。整个加载过程是对角且共轴的，\n$$\nF = \\operatorname{diag}(\\lambda,1,1),\n$$\n其中 $\\lambda$ 从 $1$ 单调地施加到最终值 $\\lambda_{\\mathrm{final}} \\in (0,1]$。由于 $F_{p}^{0} = I$ 且加载是对角的，我们采用零弹塑性自旋，因此所有张量在固定的标准正交基下保持对角形式。因此，在一个增量步中的试探弹性张量是对角的，且主方向保持不变。这极大地简化了张量运算：对于任何对角张量 $X = \\operatorname{diag}(x_{1}, x_{2}, x_{3})$，我们有 $\\ln(X) = \\operatorname{diag}(\\ln x_{1}, \\ln x_{2}, \\ln x_{3})$，$\\exp(X) = \\operatorname{diag}(e^{x_{1}}, e^{x_{2}}, e^{x_{3}})$，并且偏量算子简化为减去对角项的平均值。\n\n增量算法。考虑增量步 $n \\to n+1$。给定 $F^{n+1}$（对角）、$F_{p}^{n}$（对角）和 $p^{n}$，我们按以下步骤进行。\n\n1) 试探弹性状态。计算\n$$\nC^{n+1} = (F^{n+1})^{\\mathsf{T}} F^{n+1} = \\operatorname{diag}(\\lambda^{2}, 1, 1), \\quad C_{e}^{\\mathrm{tr}} = (F_{p}^{n})^{-\\mathsf{T}} C^{n+1} (F_{p}^{n})^{-1}.\n$$\n由于所有张量都是对角的，这简化为逐分量除法。然后\n$$\nE_{e}^{\\mathrm{tr}} = \\frac{1}{2} \\ln(C_{e}^{\\mathrm{tr}}), \\quad \\text{因此分量形式为 } E_{e,ii}^{\\mathrm{tr}} = \\frac{1}{2} \\ln\\left( C_{e,ii}^{\\mathrm{tr}} \\right).\n$$\n计算其偏量部分\n$$\n\\operatorname{dev}\\left( E_{e}^{\\mathrm{tr}} \\right) = E_{e}^{\\mathrm{tr}} - \\frac{1}{3} \\operatorname{tr}(E_{e}^{\\mathrm{tr}}) \\, I,\n$$\n和试探偏量 Mandel 应力\n$$\n\\operatorname{dev}(M)^{\\mathrm{tr}} = 2 \\mu \\, \\operatorname{dev}(E_{e}^{\\mathrm{tr}}), \\quad \\xi^{\\mathrm{tr}} := \\left\\| \\operatorname{dev}(M)^{\\mathrm{tr}} \\right\\|.\n$$\n构造试探屈服函数\n$$\n\\Phi^{\\mathrm{tr}} = \\xi^{\\mathrm{tr}} - \\sqrt{\\frac{2}{3}} \\left( \\sigma_{y0} + H p^{n} \\right).\n$$\n\n2) 弹性步。如果 $\\Phi^{\\mathrm{tr}} \\le 0$，则该步为弹性步。设置 $E_{e}^{n+1} = E_{e}^{\\mathrm{tr}}$，$p^{n+1} = p^{n}$，计算 $F_{e}^{n+1} = \\exp(E_{e}^{n+1})$（对于对角张量是逐分量的），并将塑性变形更新为 $F_{p}^{n+1} = (F_{e}^{n+1})^{-1} F^{n+1}$。Mandel 应力为\n$$\nM^{n+1} = 2 \\mu \\, \\operatorname{dev}(E_{e}^{n+1}) + \\kappa \\, \\operatorname{tr}(E_{e}^{n+1}) \\, I.\n$$\n\n3) 塑性步（在 Hencky 弹性下，Mandel 应力空间中的相关返回映射）。如果 $\\Phi^{\\mathrm{tr}} > 0$，则需要进行塑性修正。在所采用的能量函数下，$\\operatorname{dev}(M)$ 是 $\\operatorname{dev}(E_{e})$ 的线性函数并与其共轴。令流动方向为\n$$\nN = \\frac{\\operatorname{dev}(M)^{\\mathrm{tr}}}{\\left\\| \\operatorname{dev}(M)^{\\mathrm{tr}} \\right\\|} = \\frac{\\operatorname{dev}(E_{e}^{\\mathrm{tr}})}{\\left\\| \\operatorname{dev}(E_{e}^{\\mathrm{tr}}) \\right\\|}.\n$$\n相关性和塑性不可压缩性意味着只有 $E_{e}$ 的偏量部分被塑性修正所减小，而 $\\operatorname{tr}(E_{e})$ 保持不变。将塑性乘子增量记为 $\\Delta \\Gamma \\ge 0$。修正后的弹性 Hencky 应变偏量为\n$$\n\\operatorname{dev}(E_{e}^{n+1}) = \\operatorname{dev}(E_{e}^{\\mathrm{tr}}) - \\Delta \\Gamma \\, N,\n$$\n因此其 Mandel 偏量的范数为\n$$\n\\left\\| \\operatorname{dev}(M^{n+1}) \\right\\| = 2 \\mu \\, \\left\\| \\operatorname{dev}(E_{e}^{\\mathrm{tr}}) - \\Delta \\Gamma \\, N \\right\\| = \\xi^{\\mathrm{tr}} - 2 \\mu \\, \\Delta \\Gamma,\n$$\n因为 $N$ 与 $\\operatorname{dev}(E_{e}^{\\mathrm{tr}})$ 对齐。在 $n+1$ 时的一致性条件要求\n$$\n\\left\\| \\operatorname{dev}(M^{n+1}) \\right\\| = \\sqrt{\\frac{2}{3}} \\left( \\sigma_{y0} + H \\, p^{n+1} \\right), \\quad p^{n+1} = p^{n} + \\sqrt{\\frac{2}{3}} \\, \\Delta \\Gamma.\n$$\n结合这些，我们得到一个关于 $\\Delta \\Gamma$ 的单个标量方程，\n$$\n\\xi^{\\mathrm{tr}} - 2 \\mu \\, \\Delta \\Gamma = \\sqrt{\\frac{2}{3}} \\left( \\sigma_{y0} + H \\left( p^{n} + \\sqrt{\\frac{2}{3}} \\, \\Delta \\Gamma \\right) \\right).\n$$\n求解 $\\Delta \\Gamma$ 可得\n$$\n\\Delta \\Gamma = \\frac{\\xi^{\\mathrm{tr}} - \\sqrt{\\frac{2}{3}} \\left( \\sigma_{y0} + H p^{n} \\right)}{2 \\mu + \\frac{2}{3} H},\n$$\n根据塑性加载条件 $\\Phi^{\\mathrm{tr}} > 0$，该解是非负的。然后更新\n$$\n\\operatorname{dev}(E_{e}^{n+1}) = \\operatorname{dev}(E_{e}^{\\mathrm{tr}}) - \\Delta \\Gamma \\, N, \\quad \\operatorname{tr}(E_{e}^{n+1}) = \\operatorname{tr}(E_{e}^{\\mathrm{tr}}),\n$$\n$$\np^{n+1} = p^{n} + \\sqrt{\\frac{2}{3}} \\, \\Delta \\Gamma, \\quad M^{n+1} = 2 \\mu \\, \\operatorname{dev}(E_{e}^{n+1}) + \\kappa \\, \\operatorname{tr}(E_{e}^{n+1}) \\, I.\n$$\n从其偏量和体积部分重构 $E_{e}^{n+1}$，然后得到 $F_{e}^{n+1} = \\exp(E_{e}^{n+1})$（对于对角张量是逐分量的），最后更新 $F_{p}^{n+1} = (F_{e}^{n+1})^{-1} F^{n+1}$。\n\n塑性不可压缩性验证。因为塑性修正仅作用于 $E_{e}$ 的偏量部分，其体积部分（迹）在塑性修正期间保持不变。由于 $\\operatorname{tr}(E_{e}) = \\ln J_{e}$，其中 $J_{e} = \\det(F_{e})$，因此弹性体积比 $J_{e}$ 在每个增量步中不受塑性修正的影响。此外，由 $F = F_{e} F_{p}$ 可得 $J = \\det(F) = J_{e} J_{p}$，所以 $J_{p} = J / J_{e}$。在开始时，$J_{p}^{0} = 1$。对于给定的增量步，由于根据归纳法 $J_{p}^{n} = 1$，试探弹性状态有 $J_{e}^{\\mathrm{tr}} = J / J_{p}^{n} = J$。塑性修正是偏量的，使得 $J_{e}^{n+1} = J_{e}^{\\mathrm{tr}} = J$。因此，$J_{p}^{n+1} = J / J_{e}^{n+1} = 1$。在数值上，由于有限精度，我们预计偏差在机器精度量级；程序记录整个加载路径上的最大绝对偏差 $\\max_{k} | \\det(F_{p}^{(k)}) - 1 |$ 作为塑性不可压缩性的验证指标。\n\n测试套件和输出。我们用帕斯卡单位的指定参数和给定的 $\\lambda$ 路径模拟三个案例：\n- 案例 A: $\\mu = 80 \\times 10^{6}$, $\\kappa = 160 \\times 10^{6}$, $\\sigma_{y0} = 120 \\times 10^{6}$, $H = 10 \\times 10^{6}$, $N = 60$, $\\lambda_{\\mathrm{final}} = 0.70$。\n- 案例 B: 与案例 A 相同，但 $N = 10$, $\\lambda_{\\mathrm{final}} = 0.98$。\n- 案例 C: $\\mu = 50 \\times 10^{6}$, $\\kappa = 100 \\times 10^{6}$, $\\sigma_{y0} = 80 \\times 10^{6}$, $H = 0$, $N = 80$, $\\lambda_{\\mathrm{final}} = 0.60$。\n\n对于每个案例，我们计算在所有增量步中与塑性不可压缩性的最大绝对偏差，即 $\\max_{k} \\left| \\det(F_{p}^{(k)}) - 1 \\right|$，并以 `[rA,rB,rC]` 的形式在单行中输出三个结果，这些结果是无量纲的小数。\n\n该算法通过使用对角张量运算、以逐分量运算方式计算对角矩阵的对数和指数，以及使用为 Hencky 弹性模型与 von Mises (J2) 塑性和线性各向同性硬化推导出的塑性乘子增量 $\\Delta \\Gamma$ 的闭式解来实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_case(mu, kappa, sig_y0, H, N, lam_final):\n    # Initialize\n    Fp = np.ones(3)  # diagonal of F_p\n    p = 0.0          # equivalent plastic strain\n    max_dev = 0.0\n\n    # Path: lambda from 1 to lam_final in N steps (inclusive of final)\n    lambdas = np.linspace(1.0, lam_final, N)\n\n    # Helper functions for diagonal tensors\n    def dev_diag(v):\n        m = np.mean(v)\n        return v - m\n\n    for lam in lambdas:\n        # Total deformation gradient diagonal\n        F = np.array([lam, 1.0, 1.0])\n        C = F**2  # since diagonal: C = F^T F -> component-wise square\n\n        # Trial elastic right Cauchy-Green in diagonal form: Ce_tr = inv(Fp)^T * C * inv(Fp)\n        invFp = 1.0 / Fp\n        Ce_tr = (invFp**2) * C\n\n        # Elastic Hencky strain trial: Ee_tr = 0.5 * ln(Ce_tr)\n        Ee_tr = 0.5 * np.log(Ce_tr)\n\n        # Deviatoric part and Mandel deviator norm\n        dev_Ee_tr = dev_diag(Ee_tr)\n        devM_tr = 2.0 * mu * dev_Ee_tr\n        xi_tr = np.linalg.norm(devM_tr)\n\n        # Yield function trial\n        phi_tr = xi_tr - np.sqrt(2.0/3.0) * (sig_y0 + H * p)\n\n        tol = 1e-12\n        if phi_tr <= tol or xi_tr < tol:\n            # Elastic step: accept trial\n            Ee = Ee_tr\n        else:\n            # Plastic correction: radial return in Mandel space for Hencky elasticity\n            DeltaGamma = phi_tr / (2.0 * mu + (2.0/3.0) * H)\n            # Flow direction N aligned with dev_Ee_tr (same as devM_tr)\n            n_dir = dev_Ee_tr / (np.linalg.norm(dev_Ee_tr) + 1e-30)\n            dev_Ee = dev_Ee_tr - DeltaGamma * n_dir\n            # Volumetric part unchanged\n            tr_Ee = np.sum(Ee_tr)\n            mean_Ee = tr_Ee / 3.0\n            Ee = dev_Ee + mean_Ee\n            # Update equivalent plastic strain\n            p += np.sqrt(2.0/3.0) * DeltaGamma\n\n        # Reconstruct Fe from Ee: Fe = exp(Ee) component-wise\n        Fe = np.exp(Ee)\n        # Update Fp from multiplicative split: F = Fe * Fp => Fp = Fe^{-1} * F\n        Fp = F / Fe\n\n        # Track plastic incompressibility deviation\n        detFp = np.prod(Fp)\n        dev = abs(detFp - 1.0)\n        if dev > max_dev:\n            max_dev = dev\n\n        # Mandel stress could be computed if needed:\n        # M = 2 mu dev(Ee) + kappa tr(Ee) I; not used in output but we ensure computability\n        # dev part:\n        # devM = 2.0 * mu * dev_diag(Ee)\n        # trM = kappa * np.sum(Ee)\n        # M_diag = devM + (trM / 3.0)\n\n    return max_dev\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (mu, kappa, sigma_y0, H, N, lambda_final)\n    test_cases = [\n        (80e6, 160e6, 120e6, 10e6, 60, 0.70),  # Case A\n        (80e6, 160e6, 120e6, 10e6, 10, 0.98),  # Case B\n        (50e6, 100e6, 80e6, 0.0, 80, 0.60),    # Case C\n    ]\n\n    results = []\n    for case in test_cases:\n        mu, kappa, sig_y0, H, N, lam_final = case\n        result = run_case(mu, kappa, sig_y0, H, N, lam_final)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2640752"}]}