{"hands_on_practices": [{"introduction": "理解热力学势如何与可测量的物理量（如热容 $C_{p,m}(T)$）相关联，是一项核心技能。本练习将指导你从基本热力学关系出发，通过严谨的数学推导，得出一种理想气体的标准化学势 $\\mu^\\circ$ 随温度变化的解析表达式，这对于利用实验数据构建热力学模型至关重要。[@problem_id:2795473]", "problem": "一种气相分子物种 $X$ 被用作探针，研究其在纳米结构表面上的吸附平衡。在所研究的温度范围内，于固定的标准压力 $p^{\\circ}$ 下，$X$ 表现为理想气体（无相变发生）。其恒压摩尔热容可通过以下模型表示\n$$\nC_{p,m}(T) = R\\left(a + b\\,T + c\\,T^{-2}\\right),\n$$\n其中 $R$ 是摩尔气体常数，$a$、$b$ 和 $c$ 是与温度无关的无量纲参数。设在相同压力 $p^{\\circ}$ 下的参考温度为 $T_0$。已知在 $T_0$ 时，$X$ 的标准化学势为 $\\mu^{\\circ}(T_0)$，标准摩尔熵为 $s_m^{\\circ}(T_0)$。\n\n请仅从纯物质在定压下的基本热力学关系和理想气体行为出发，推导标准化学势相对于参考值的温度依赖关系的闭合形式解析表达式，该表达式应以 $T$、$T_0$、$R$、$a$、$b$、$c$ 和 $s_m^{\\circ}(T_0)$ 表示。这个关系是：\n$$\n\\mu^{\\circ}(T) - \\mu^{\\circ}(T_0).\n$$\n请将最终结果表示为单一的解析表达式。无需进行数值计算，并且除了基本定义和给定的 $C_{p,m}(T)$ 模型外，不应引入任何其他经验公式。假设所有积分均在固定压力 $p^{\\circ}$ 下沿理想气体模型适用的可逆路径进行。最终答案必须是单一的闭合形式表达式；在最终方框内的答案中请勿包含单位。", "solution": "该问题有效。这是一个提法明确、具有科学依据的化学热力学问题，需要应用基本原理来推导一个特定关系。所有必需的数据和函数形式均已提供。\n\n推导从纯物质的摩尔吉布斯自由能（即化学势）$\\mu$ 的基本热力学关系式开始：\n$$\nd\\mu = v_m dP - s_m dT\n$$\n其中 $v_m$ 是摩尔体积，$s_m$ 是摩尔熵。问题指定了在固定标准压力 $p^{\\circ}$ 下的条件，因此 $dP = 0$。标准化学势 $\\mu^{\\circ}$ 的关系式变为：\n$$\n\\left(\\frac{\\partial \\mu^{\\circ}}{\\partial T}\\right)_{p^{\\circ}} = -s_m^{\\circ}(T)\n$$\n为求得标准化学势从参考温度 $T_0$ 到温度 $T$ 的变化，我们对该表达式进行积分：\n$$\n\\mu^{\\circ}(T) - \\mu^{\\circ}(T_0) = \\int_{T_0}^{T} \\left(\\frac{\\partial \\mu^{\\circ}}{\\partial T'}\\right)_{p^{\\circ}} dT' = -\\int_{T_0}^{T} s_m^{\\circ}(T') dT'\n$$\n标准摩尔熵 $s_m^{\\circ}(T)$ 不是常数，而是随温度变化的。其温度依赖性通过以下关系式与恒压摩尔热容 $C_{p,m}$ 相关联：\n$$\nC_{p,m}(T) = T \\left(\\frac{\\partial s_m}{\\partial T}\\right)_p\n$$\n对于标准态的量，此关系式为 $C_{p,m}^{\\circ}(T) = T (\\frac{\\partial s_m^{\\circ}}{\\partial T})_{p^{\\circ}}$。对上式进行整理并从 $T_0$ 到 $T$ 积分，得到任意温度 $T$ 下的标准摩尔熵表达式：\n$$\ns_m^{\\circ}(T) = s_m^{\\circ}(T_0) + \\int_{T_0}^{T} \\frac{C_{p,m}^{\\circ}(T')}{T'} dT'\n$$\n将此表达式代入化学势差的积分中，得到：\n$$\n\\mu^{\\circ}(T) - \\mu^{\\circ}(T_0) = -\\int_{T_0}^{T} \\left( s_m^{\\circ}(T_0) + \\int_{T_0}^{T'} \\frac{C_{p,m}^{\\circ}(T'')}{T''} dT'' \\right) dT'\n$$\n这可以分解为两部分：\n$$\n\\mu^{\\circ}(T) - \\mu^{\\circ}(T_0) = -s_m^{\\circ}(T_0) \\int_{T_0}^{T} dT' - \\int_{T_0}^{T} \\left( \\int_{T_0}^{T'} \\frac{C_{p,m}^{\\circ}(T'')}{T''} dT'' \\right) dT'\n$$\n第一项即为 $-s_m^{\\circ}(T_0)(T-T_0)$。第二项是一个二重积分。我们可以通过对外部积分使用分部积分法来更有效地计算它，设 $u = \\int_{T_0}^{T'} \\frac{C_{p,m}^{\\circ}(T'')}{T''} dT''$ 且 $dv = dT'$。由此可得 $du = \\frac{C_{p,m}^{\\circ}(T')}{T'} dT'$ 且 $v=T'$。该定积分变为：\n$$\n\\int_{T_0}^{T} u \\, dv = [uv]_{T_0}^{T} - \\int_{T_0}^{T} v \\, du = \\left[ T' \\int_{T_0}^{T'} \\frac{C_{p,m}^{\\circ}(T'')}{T''} dT'' \\right]_{T_0}^{T} - \\int_{T_0}^{T} T' \\frac{C_{p,m}^{\\circ}(T')}{T'} dT'\n$$\n$$\n= \\left( T \\int_{T_0}^{T} \\frac{C_{p,m}^{\\circ}(T')}{T'} dT' \\right) - \\left( T_0 \\int_{T_0}^{T_0} \\frac{C_{p,m}^{\\circ}(T')}{T'} dT' \\right) - \\int_{T_0}^{T} C_{p,m}^{\\circ}(T') dT'\n$$\n由于从 $T_0$ 到 $T_0$ 的积分为零，该二重积分简化为：\n$$\n\\int_{T_0}^{T} \\left( \\int_{T_0}^{T'} \\frac{C_{p,m}^{\\circ}(T'')}{T''} dT'' \\right) dT' = T \\int_{T_0}^{T} \\frac{C_{p,m}^{\\circ}(T')}{T'} dT' - \\int_{T_0}^{T} C_{p,m}^{\\circ}(T') dT'\n$$\n将此结果代回化学势差的表达式中，得到：\n$$\n\\mu^{\\circ}(T) - \\mu^{\\circ}(T_0) = -s_m^{\\circ}(T_0)(T-T_0) - T \\int_{T_0}^{T} \\frac{C_{p,m}^{\\circ}(T')}{T'} dT' + \\int_{T_0}^{T} C_{p,m}^{\\circ}(T') dT'\n$$\n现在我们必须计算涉及 $C_{p,m}^{\\circ}(T')$ 的两个积分。问题给出了 $C_{p,m}(T) = R(a + bT + cT^{-2})$。\n第一个积分是：\n$$\n\\int_{T_0}^{T} \\frac{C_{p,m}^{\\circ}(T')}{T'} dT' = R \\int_{T_0}^{T} \\left(\\frac{a}{T'} + b + cT'^{-3}\\right) dT' = R \\left[ a\\ln(T') + bT' - \\frac{c}{2}T'^{-2} \\right]_{T_0}^{T}\n$$\n$$\n= R \\left( a\\ln\\left(\\frac{T}{T_0}\\right) + b(T-T_0) - \\frac{c}{2}\\left(\\frac{1}{T^2} - \\frac{1}{T_0^2}\\right) \\right)\n$$\n第二个积分是：\n$$\n\\int_{T_0}^{T} C_{p,m}^{\\circ}(T') dT' = R \\int_{T_0}^{T} \\left(a + bT' + cT'^{-2}\\right) dT' = R \\left[ aT' + \\frac{b}{2}T'^2 - cT'^{-1} \\right]_{T_0}^{T}\n$$\n$$\n= R \\left( a(T-T_0) + \\frac{b}{2}(T^2-T_0^2) - c\\left(\\frac{1}{T} - \\frac{1}{T_0}\\right) \\right)\n$$\n将这些结果代入 $\\mu^{\\circ}(T) - \\mu^{\\circ}(T_0)$ 的方程中：\n$$\n\\mu^{\\circ}(T) - \\mu^{\\circ}(T_0) = -s_m^{\\circ}(T_0)(T-T_0) - TR\\left( a\\ln\\frac{T}{T_0} + b(T-T_0) - \\frac{c}{2}\\left(\\frac{1}{T^2}-\\frac{1}{T_0^2}\\right) \\right) + R\\left( a(T-T_0) + \\frac{b}{2}(T^2-T_0^2) - c\\left(\\frac{1}{T}-\\frac{1}{T_0}\\right) \\right)\n$$\n我们按参数 $a$、$b$ 和 $c$ 对各项进行分组：\n$a$ 的项：\n$$\nRa\\left( (T-T_0) - T\\ln\\frac{T}{T_0} \\right) = Ra\\left( T-T_0 - T\\ln\\frac{T}{T_0} \\right)\n$$\n$b$ 的项：\n$$\nRb\\left( \\frac{1}{2}(T^2-T_0^2) - T(T-T_0) \\right) = Rb(T-T_0)\\left( \\frac{1}{2}(T+T_0) - T \\right) = Rb(T-T_0)\\left( \\frac{T_0-T}{2} \\right) = -\\frac{Rb}{2}(T-T_0)^2\n$$\n$c$ 的项：\n$$\nRc\\left( - \\left(\\frac{1}{T}-\\frac{1}{T_0}\\right) + \\frac{T}{2}\\left(\\frac{1}{T^2}-\\frac{1}{T_0^2}\\right) \\right) = Rc\\left( - \\frac{T_0-T}{TT_0} + \\frac{T_0^2-T^2}{2T_0^2T} \\right)\n$$\n$$\n= Rc(T-T_0)\\left( \\frac{1}{TT_0} - \\frac{T+T_0}{2T_0^2T} \\right) = Rc(T-T_0)\\left( \\frac{2T_0 - (T+T_0)}{2T_0^2T} \\right) = Rc(T-T_0)\\left( \\frac{T_0-T}{2T_0^2T} \\right) = -\\frac{Rc}{2}\\frac{(T-T_0)^2}{TT_0^2}\n$$\n将所有项合并得到最终表达式：\n$$\n\\mu^{\\circ}(T) - \\mu^{\\circ}(T_0) = -s_m^{\\circ}(T_0)(T-T_0) + R \\left[ a\\left(T-T_0 - T\\ln\\frac{T}{T_0}\\right) - \\frac{b}{2}(T-T_0)^2 - \\frac{c}{2}\\frac{(T-T_0)^2}{TT_0^2} \\right]\n$$\n这就是所要求的闭合形式解析表达式。", "answer": "$$\n\\boxed{-s_m^{\\circ}(T_0)(T-T_0) + R \\left( a\\left(T-T_0 - T\\ln\\frac{T}{T_0}\\right) - \\frac{b}{2}(T-T_0)^2 - \\frac{c(T-T_0)^2}{2TT_0^2} \\right)}\n$$", "id": "2795473"}, {"introduction": "化学势是驱动相平衡和物质输运的根本动力，而外部应力场可以显著地改变它。本练习提供了一个具体的场景：通过应用拉尔什-卡恩（Larché–Cahn）理论框架，你将计算静水压力 $p$ 如何改变溶质在固溶体中的溶解度极限，从而将抽象的化学势概念与可观测的材料行为直接联系起来。[@problem_id:2795421]", "problem": "一种稀释的替代型溶质物种 $B$ 溶解在晶体基体 $A$ 中，形成固溶体。考虑一个宏观、均匀的 $A$ 单晶，处于均匀的静水压力 $p$（压缩时取正值）下。温度固定为 $T$，溶质足够稀释，其活度可视为等于其原子分数 $c$。\n\n假设在固定的静水压力 $p$ 下，用一个溶质原子 $B$ 替换一个基体原子 $A$，会使晶体体积改变一个溶质的错配（形成）体积 $\\Delta \\Omega$（一个与 $c$ 无关的常数），因此对吉布斯自由能变化的机械贡献为 $p\\,\\Delta \\Omega$。在恒温和恒定静水压力下，相关的热力学势是吉布斯自由能 $G(T,p,N_A,N_B)$，固体中 $B$ 的化学势定义为 $\\mu_B=\\left(\\partial G/\\partial N_B\\right)_{T,p,N_A}$。\n\n在 $p=0$ 时，已知温度 $T$ 下的无应力溶解度极限（$B$ 的平衡原子分数）为 $c_s^{(0)}$。当施加静水压力 $p$ 时，平衡溶解度调整为 $c_s(p)$，使得固体中溶质的化学势等于定义了 $c_s^{(0)}$ 的同一个理想参考态（溶质源）的化学势。\n\n仅从上述定义和稀释极限下 $B$ 的理想混合假设出发，通过援引关于应力固体内溶质化学势的 Larché–Cahn 框架，推导出用 $c_s^{(0)}$、$p$、$\\Delta \\Omega$、$k_B$ 和 $T$ 表示的 $c_s(p)$ 的闭式表达式。然后，使用以下参数对 $c_s(p)$ 进行数值计算：\n- 温度 $T = 800\\ \\mathrm{K}$，\n- 静水压力 $p = 1.50 \\times 10^{9}\\ \\mathrm{Pa}$，\n- 错配（形成）体积 $\\Delta \\Omega = 0.80 \\times 10^{-29}\\ \\mathrm{m^3}$，\n- 零压溶解度极限 $c_s^{(0)} = 1.00 \\times 10^{-3}$（原子分数），\n- 玻尔兹曼常数 $k_B = 1.380\\,649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$。\n\n将最终答案表示为原子分数 $c_s(p)$，并将结果四舍五入至三位有效数字。答案必须以纯数（原子分数，无单位）的形式报告。", "solution": "该问题要求推导晶体基体 $A$ 中稀替代溶质 $B$ 的压强依赖性溶解度极限 $c_s(p)$ 的表达式，并对其进行数值计算。\n\n首先对问题陈述进行验证。\n\n步骤1：提取已知条件。\n- 系统：晶体基体 $A$ 中的稀替代溶质 $B$。\n- 条件：恒定温度 $T$，均匀静水压力 $p  0$。\n- 近似：溶质活度等于其原子分数 $c$。错配体积 $\\Delta \\Omega$ 是恒定的。\n- 定义：每个溶质对吉布斯自由能变化的机械贡献为 $p\\,\\Delta \\Omega$。热力学势是吉布斯自由能 $G(T,p,N_A,N_B)$。溶质的化学势为 $\\mu_B=\\left(\\partial G/\\partial N_B\\right)_{T,p,N_A}$。\n- 边界/平衡条件：在 $p=0$ 时，平衡溶解度为 $c_s^{(0)}$。在压力 $p$ 下，平衡溶解度为 $c_s(p)$。两个平衡都是相对于同一个理想参考溶质源建立的，这意味着溶质源中溶质的化学势 $\\mu_{res}$ 是恒定的。\n- 所需框架：用于计算应力固体内溶质化学势的 Larché–Cahn 框架。\n- 数值参数：$T = 800\\ \\mathrm{K}$，$p = 1.50 \\times 10^{9}\\ \\mathrm{Pa}$，$\\Delta \\Omega = 0.80 \\times 10^{-29}\\ \\mathrm{m^3}$，$c_s^{(0)} = 1.00 \\times 10^{-3}$，$k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据。它涉及材料热力学中的一个标准课题——压强对溶解度的影响，这被称为应用于固溶体的勒夏特列原理（Le Châtelier principle）。Larché–Cahn 理论是进行此分析的适当且成熟的框架。该问题是良定的，提供了一套清晰的假设（理想稀溶液，恒定的错配体积），以及解析推导和数值计算所需的所有数据。其语言客观而精确。所提供的数值对于高压下的固态系统是物理上现实的。该问题是自洽的，没有矛盾或歧义。\n\n步骤3：结论与行动。\n问题被判定为有效。将进行求解。\n\n在温度 $T$、压强 $p$ 和浓度 $c$ 下，固态基体 $A$ 中溶质物种 $B$ 的化学势 $\\mu_B$ 是问题陈述中指明或暗示的三个贡献之和：\n1. 标准化学势 $\\mu_B^0(T)$，它取决于温度，但与压强和浓度无关。此项表示在参考压强（此处为 $p=0$）和参考浓度下，溶质原子在主晶格中的状态。\n2. 来自混合熵的贡献。对于一个理想稀溶液，其活度被视为原子分数 $c$，此项为 $k_B T \\ln(c)$。\n3. 由于溶质的错配体积 $\\Delta \\Omega$ 与施加的静水压力 $p$ 相互作用而产生的机械功项。问题明确指出，每个溶质原子的此项贡献为 $p \\Delta \\Omega$。在压缩压力（$p0$）下，正的 $\\Delta \\Omega$ 会增加系统的能量。\n\n综合这些项，固溶体中溶质 $B$ 的化学势由下式给出：\n$$\n\\mu_B(T, p, c) = \\mu_B^0(T) + k_B T \\ln(c) + p \\Delta \\Omega\n$$\n此表达式与 Larché–Cahn 框架在静水应力下的形式一致。\n\n问题陈述指出，溶解度极限由与外部溶质源的平衡决定。设该溶质源的化学势为 $\\mu_{res}$。平衡条件为 $\\mu_B = \\mu_{res}$。\n\n在零压强（$p=0$）下，平衡溶解度为 $c_s^{(0)}$。平衡条件是：\n$$\n\\mu_{res} = \\mu_B(T, 0, c_s^{(0)}) = \\mu_B^0(T) + k_B T \\ln(c_s^{(0)}) + (0)\\Delta \\Omega\n$$\n$$\n\\mu_{res} = \\mu_B^0(T) + k_B T \\ln(c_s^{(0)})\n$$\n\n当施加静水压力 $p$ 时，溶解度调整到一个新值 $c_s(p)$。系统与*同一个*溶质源达到平衡。因此，平衡条件是：\n$$\n\\mu_{res} = \\mu_B(T, p, c_s(p)) = \\mu_B^0(T) + k_B T \\ln(c_s(p)) + p \\Delta \\Omega\n$$\n\n由于 $\\mu_{res}$ 在两种情况下是相同的，我们可以将固体中溶质化学势的两个表达式相等：\n$$\n\\mu_B^0(T) + k_B T \\ln(c_s^{(0)}) = \\mu_B^0(T) + k_B T \\ln(c_s(p)) + p \\Delta \\Omega\n$$\n\n标准势项 $\\mu_B^0(T)$ 从两侧消去：\n$$\nk_B T \\ln(c_s^{(0)}) = k_B T \\ln(c_s(p)) + p \\Delta \\Omega\n$$\n\n现在我们求解 $c_s(p)$。整理各项可得：\n$$\nk_B T \\left( \\ln(c_s^{(0)}) - \\ln(c_s(p)) \\right) = p \\Delta \\Omega\n$$\n使用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$：\n$$\nk_B T \\ln\\left(\\frac{c_s^{(0)}}{c_s(p)}\\right) = p \\Delta \\Omega\n$$\n$$\n\\ln\\left(\\frac{c_s^{(0)}}{c_s(p)}\\right) = \\frac{p \\Delta \\Omega}{k_B T}\n$$\n对两边取指数，得出：\n$$\n\\frac{c_s^{(0)}}{c_s(p)} = \\exp\\left(\\frac{p \\Delta \\Omega}{k_B T}\\right)\n$$\n最后，求解 $c_s(p)$，我们得到所要求的闭式表达式：\n$$\nc_s(p) = c_s^{(0)} \\exp\\left(-\\frac{p \\Delta \\Omega}{k_B T}\\right)\n$$\n\n现在，我们必须使用所提供的参数值对该表达式进行数值计算。\n首先，我们计算无量纲指数 $\\frac{p \\Delta \\Omega}{k_B T}$。\n分子中的机械能项为：\n$$\np \\Delta \\Omega = (1.50 \\times 10^{9}\\ \\mathrm{Pa}) \\times (0.80 \\times 10^{-29}\\ \\mathrm{m^3}) = 1.2 \\times 10^{-20}\\ \\mathrm{J}\n$$\n分母中的热能项为：\n$$\nk_B T = (1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}) \\times (800\\ \\mathrm{K}) = 1.1045192 \\times 10^{-20}\\ \\mathrm{J}\n$$\n两者之比为：\n$$\n\\frac{p \\Delta \\Omega}{k_B T} = \\frac{1.2 \\times 10^{-20}\\ \\mathrm{J}}{1.1045192 \\times 10^{-20}\\ \\mathrm{J}} \\approx 1.08645\n$$\n现在我们将这个值代入 $c_s(p)$ 的表达式中：\n$$\nc_s(p) = c_s^{(0)} \\exp\\left(-\\frac{p \\Delta \\Omega}{k_B T}\\right)\n$$\n$$\nc_s(p) \\approx (1.00 \\times 10^{-3}) \\times \\exp(-1.08645)\n$$\n$$\nc_s(p) \\approx (1.00 \\times 10^{-3}) \\times 0.33742\n$$\n$$\nc_s(p) \\approx 3.3742 \\times 10^{-4}\n$$\n问题要求将结果四舍五入到三位有效数字。\n$$\nc_s(p) \\approx 3.37 \\times 10^{-4}\n$$\n这是最终的数值答案，代表原子分数。", "answer": "$$\n\\boxed{3.37 \\times 10^{-4}}\n$$", "id": "2795421"}, {"introduction": "现代材料研究越来越依赖于计算模拟来探索热力学性质。这个实践将你带入计算材料科学的前沿，通过分析一个假设的巨正则蒙特卡洛（GCMC）模拟数据集，学习如何提取关键的热力学量，如巨势 $\\Omega(\\mu)$、吸附等温线 $\\theta(\\mu)$ 和吸附焓，从而掌握连接统计力学理论与实际计算分析的强大方法。[@problem_id:2795432]", "problem": "通过在恒定温度下进行巨正则蒙特卡洛 (GCMC) 模拟，研究一种具有相同且无相互作用吸附位点的刚性纳米多孔材料。目标是仅使用在单个参考化学势下采样的时间序列数据，计算作为化学势函数的巨势、吸附等温线以及吸附微分焓。您的程序必须从基本定义出发，实现所需的统计力学关系，并为指定的测试套件生成数值结果。\n\n使用的基本原理：\n- 巨正则配分函数定义为 $$\\Xi(\\mu,T,V)=\\sum_{\\text{microstates }x}\\exp\\!\\left[-\\beta\\left(E(x)-\\mu N(x)\\right)\\right],$$ 其中 $E(x)$ 是微观状态 $x$ 的能量，$N(x)$ 是粒子数，$\\mu$ 是化学势，$T$ 是绝对温度，$V$ 是体积，并且 $\\beta=1/\\left(k_{\\mathrm{B}}T\\right)$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数。\n- 巨势定义为 $$\\Omega(\\mu,T,V)=-k_{\\mathrm{B}}T\\ln\\Xi(\\mu,T,V).$$\n- 在巨正则系综中，微观状态 $x$ 的概率为 $$\\mathbb{P}_{\\mu,T}(x)=\\Xi(\\mu,T,V)^{-1}\\,\\exp\\!\\left[-\\beta\\left(E(x)-\\mu N(x)\\right)\\right].$$\n- 可观测物理量 $A(x)$ 的系综平均值为 $$\\langle A\\rangle_{\\mu,T}=\\sum_x A(x)\\,\\mathbb{P}_{\\mu,T}(x).$$\n\n系统模型：\n- 该材料包含 $M$ 个相同且独立的吸附位点。每个被占据的位点为总内能贡献一个固定的分子吸附能 $\\varepsilon$。主体是刚性的。对于任何微观状态 $x$，吸附的分子数 $N(x)\\in\\{0,1,2,\\dots,M\\}$，内能满足 $U(x)=\\varepsilon\\,N(x)$。除位点排斥外，不存在吸附质-吸附质相互作用。\n\n合成 GCMC 时间序列：\n- 对于每个测试用例，您将在指定的参考化学势 $\\mu_0$ 和温度 $T$ 下，生成一个与独立位点模型一致的长度为 $S$ 的合成 GCMC 时间序列。使用固定的伪随机种子以确保可复现性。所得时间序列是一个样本数组 $\\{(N_i,U_i)\\}_{i=1}^S$，其中 $U_i=\\varepsilon N_i$。\n\n每个测试用例需要执行的任务：\n1. 仅使用在 $(\\mu_0,T)$ 处采样的时间序列，为测试用例中的每个目标化学势 $\\mu$ 计算巨势差 $$\\Delta\\Omega(\\mu;\\mu_0)=\\Omega(\\mu,T,V)-\\Omega(\\mu_0,T,V)$$。将 $\\Delta\\Omega$ 以千焦每摩尔表示。\n2. 计算每个目标 $\\mu$ 处的吸附等温线，即平均占据分数 $$\\theta(\\mu)=\\langle N\\rangle_{\\mu,T}/M,$$ 这是一个在 $\\left[0,1\\right]$ 范围内的无量纲数。\n3. 计算每个目标 $\\mu$ 处的吸附微分焓，即在恒温下的导数 $$h_{\\mathrm{diff}}(\\mu)=\\frac{\\mathrm{d}\\langle H\\rangle_{\\mu,T}}{\\mathrm{d}\\langle N\\rangle_{\\mu,T}},$$，其中 $H$ 是刚性主体中吸附相的焓。对于此刚性、体积固定的模型，取 $H\\equiv U$，并基于巨正则系综平均，通过统计上一致的方法从 $(N_i,U_i)$ 时间序列估计 $h_{\\mathrm{diff}}(\\mu)$。将 $h_{\\mathrm{diff}}$ 以千焦每摩尔表示。\n\n物理常数和单位：\n- 使用气体常数 $R$，单位为千焦每摩尔每开尔文，其值为 $R=0.008314462618$ kJ/mol/K，因此当能量和化学势的单位为千焦每摩尔，温度单位为开尔文时，$\\beta=1/(RT)$。\n- 所有温度必须以开尔文为单位，所有能量和化学势必须以千焦每摩尔为单位。\n\n合成数据生成协议：\n- 对于每个测试用例，使用测试用例中指定的整数种子 $s$ 初始化一个伪随机数生成器。\n- 在 $(\\mu_0,T)$ 下生成 $S$ 个与独立位点模型一致的独立样本 $(N_i,U_i)$。您可以使用该模型所隐含的任何正确方法来抽取 $N_i$ 值，只要生成的系综在独立位点假设下对于 $(\\mu_0,T)$ 是巨正则的，并设置 $U_i=\\varepsilon N_i$。\n\n数值稳定性：\n- 您的 $\\Delta\\Omega(\\mu;\\mu_0)$ 和重加权系综平均的计算对于测试用例必须是数值稳定的。在重加权处理指数时，使用 log-sum-exp 或等效的稳定性技术。\n\n测试套件：\n为以下三个测试用例提供结果。对于每个测试用例，按给定顺序处理所有目标化学势 $\\mu$。\n\n- 测试用例 1：\n  - $M=50$\n  - $\\varepsilon=-10.0$ kJ/mol\n  - $T=300.0$ K\n  - $\\mu_0=-12.0$ kJ/mol\n  - $S=500000$\n  - $s=12345$\n  - 目标 $\\mu$ 值：$\\left[-13.0,-12.0,-11.0\\right]$ kJ/mol\n\n- 测试用例 2：\n  - $M=50$\n  - $\\varepsilon=-5.0$ kJ/mol\n  - $T=300.0$ K\n  - $\\mu_0=-5.0$ kJ/mol\n  - $S=500000$\n  - $s=24680$\n  - 目标 $\\mu$ 值：$\\left[-6.0,-5.0,-4.0\\right]$ kJ/mol\n\n- 测试用例 3：\n  - $M=30$\n  - $\\varepsilon=-12.0$ kJ/mol\n  - $T=350.0$ K\n  - $\\mu_0=-11.0$ kJ/mol\n  - $S=400000$\n  - $s=98765$\n  - 目标 $\\mu$ 值：$\\left[-12.0,-11.0,-10.0\\right]$ kJ/mol\n\n最终输出规范：\n- 对于每个测试用例，并按给定顺序为每个目标 $\\mu$，生成一个包含三个浮点数的列表：\n  - 第一个：$\\Delta\\Omega(\\mu;\\mu_0)$，单位 kJ/mol。\n  - 第二个：$\\theta(\\mu)$，以小数形式表示。\n  - 第三个：$h_{\\mathrm{diff}}(\\mu)$，单位 kJ/mol。\n- 将每个浮点数四舍五入到恰好 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含一个列表的列表，按测试用例的顺序、并在每个测试用例中按目标 $\\mu$ 值的顺序连接结果。例如，打印的结构应如下所示：\n  - $\\left[[x_{1,1},x_{1,2},x_{1,3}],[x_{2,1},x_{2,2},x_{2,3}],\\dots\\right]$\n其中每个括号内的三元组对应一个测试用例中的一个目标 $\\mu$（按指定顺序），每个 $x_{i,j}$ 是一个四舍五入到 $6$ 位小数的浮点数。", "solution": "我们从巨正则系综的定义开始。巨正则配分函数为 $$\\Xi(\\mu,T,V)=\\sum_{x}\\exp\\!\\left[-\\beta\\left(E(x)-\\mu N(x)\\right)\\right],$$，其中 $\\beta=1/\\left(k_{\\mathrm{B}}T\\right)$。巨势为 $$\\Omega(\\mu,T,V)=-k_{\\mathrm{B}}T\\ln\\Xi(\\mu,T,V).$$ 一个微观状态 $x$ 的概率为 $$\\mathbb{P}_{\\mu,T}(x)=\\Xi(\\mu,T,V)^{-1}\\,\\exp\\!\\left[-\\beta\\left(E(x)-\\mu N(x)\\right)\\right],$$，系综平均为 $$\\langle A\\rangle_{\\mu,T}=\\sum_x A(x)\\,\\mathbb{P}_{\\mu,T}(x).$$\n\n对于一个具有 $M$ 个相同位点和单粒子吸附能 $\\varepsilon$ 的刚性主体和无相互作用的独立位点模型，一个有 $N$ 个位点被占据的微观状态的能量为 $$U(x)=\\varepsilon N(x),$$，其中 $N(x)\\in\\{0,1,\\dots,M\\}$。因为位点是相同且独立的，巨配分函数可以因子分解，从而在任何 $(\\mu,T)$ 下，粒子数分布呈二项分布形式；具体来说，每个位点被占据的概率为 $$p(\\mu,T)=\\frac{1}{1+\\exp\\!\\left[-\\beta\\left(\\mu-\\varepsilon\\right)\\right]},$$，因此 $$N\\sim\\mathrm{Binomial}\\!\\left(M,p(\\mu,T)\\right),\\quad U=\\varepsilon N.$$ 这提供了一种在 $(\\mu_0,T)$ 下生成合成 GCMC 时间序列的精确方法：从参数为 $(M,p(\\mu_0,T))$ 的二项分布律中独立抽取 $N_i$，并设置 $U_i=\\varepsilon N_i$。\n\n我们现在推导如何仅使用在 $(\\mu_0,T)$ 处的样本来计算巨势差 $\\Delta\\Omega(\\mu;\\mu_0)$、吸附等温线 $\\theta(\\mu)$ 和微分焓 $h_{\\mathrm{diff}}(\\mu)$。\n\n1. 通过自由能微扰计算巨势差。在相同的温度和体积下定义 $\\Xi(\\mu)$ 和 $\\Xi(\\mu_0)$。我们写作\n$$\n\\Xi(\\mu)=\\sum_x \\exp\\!\\left[-\\beta\\left(E(x)-\\mu N(x)\\right)\\right]\n=\\sum_x \\exp\\!\\left[-\\beta\\left(E(x)-\\mu_0 N(x)\\right)\\right]\\exp\\!\\left[\\beta\\left(\\mu-\\mu_0\\right)N(x)\\right].\n$$\n注意到归一化概率 $\\mathbb{P}_{\\mu_0,T}(x)=\\Xi(\\mu_0)^{-1}\\exp\\!\\left[-\\beta\\left(E(x)-\\mu_0 N(x)\\right)\\right]$，我们得到精确的恒等式\n$$\n\\frac{\\Xi(\\mu)}{\\Xi(\\mu_0)}=\\sum_x \\mathbb{P}_{\\mu_0,T}(x)\\,\\exp\\!\\left[\\beta\\left(\\mu-\\mu_0\\right)N(x)\\right]=\\left\\langle \\exp\\!\\left[\\beta\\left(\\mu-\\mu_0\\right)N\\right]\\right\\rangle_{\\mu_0,T}.\n$$\n因此，\n$$\n\\Delta\\Omega(\\mu;\\mu_0)=\\Omega(\\mu)-\\Omega(\\mu_0)=-k_{\\mathrm{B}}T\\,\\ln\\frac{\\Xi(\\mu)}{\\Xi(\\mu_0)}=-k_{\\mathrm{B}}T\\,\\ln\\left\\langle \\exp\\!\\left[\\beta\\left(\\mu-\\mu_0\\right)N\\right]\\right\\rangle_{\\mu_0,T}.\n$$\n使用带有气体常数的每摩尔单位，我们将 $k_{\\mathrm{B}}$ 替换为气体常数 $R$，并且 $\\beta=1/(RT)$，因此 $-k_{\\mathrm{B}}T=-RT$，当 $\\mu$ 和 $\\varepsilon$ 的单位是千焦每摩尔，温度单位是开尔文时，结果的单位是千焦每摩尔。\n\n为了从 $(\\mu_0,T)$ 处的样本 $\\{N_i\\}_{i=1}^S$ 来估计这个值，我们使用样本均值\n$$\n\\left\\langle \\exp\\!\\left[\\beta\\left(\\mu-\\mu_0\\right)N\\right]\\right\\rangle_{\\mu_0,T}\\approx \\frac{1}{S}\\sum_{i=1}^S \\exp\\!\\left[\\beta\\left(\\mu-\\mu_0\\right)N_i\\right],\n$$\n并使用 log-sum-exp 技巧来稳定地计算对数：令 $a_i=\\beta\\left(\\mu-\\mu_0\\right)N_i$ 和 $a_{\\max}=\\max_i a_i$，则\n$$\n\\ln\\left(\\frac{1}{S}\\sum_{i=1}^S e^{a_i}\\right)\n=a_{\\max}+\\ln\\left(\\frac{1}{S}\\sum_{i=1}^S e^{a_i-a_{\\max}}\\right).\n$$\n\n2. 通过重加权计算吸附等温线。对于任何可观测物理量 $A$，其在 $(\\mu,T)$ 的平均值可以表示为在 $(\\mu_0,T)$ 处样本的函数：\n$$\n\\langle A\\rangle_{\\mu,T}\n=\\frac{\\sum_x A(x)\\,\\mathbb{P}_{\\mu_0,T}(x)\\,e^{\\beta(\\mu-\\mu_0)N(x)}}{\\sum_x \\mathbb{P}_{\\mu_0,T}(x)\\,e^{\\beta(\\mu-\\mu_0)N(x)}}\n=\\frac{\\left\\langle A\\,e^{\\beta(\\mu-\\mu_0)N}\\right\\rangle_{\\mu_0,T}}{\\left\\langle e^{\\beta(\\mu-\\mu_0)N}\\right\\rangle_{\\mu_0,T}}.\n$$\n样本估计量是加权样本均值的比率。特别地，对于等温线，我们设置 $A=N$ 并计算\n$$\n\\theta(\\mu)=\\frac{\\langle N\\rangle_{\\mu,T}}{M}\\approx \\frac{\\sum_{i=1}^S N_i\\,w_i}{M\\sum_{i=1}^S w_i},\\quad w_i=\\exp\\!\\left[\\beta\\left(\\mu-\\mu_0\\right)N_i\\right],\n$$\n通过 $a_{\\max}$ 进行平移并消去公因子，以数值稳定的方式实现。\n\n3. 吸附微分焓。在刚性主体模型中，我们取 $H\\equiv U$。我们需要\n$$\nh_{\\mathrm{diff}}(\\mu)=\\frac{\\mathrm{d}\\langle U\\rangle_{\\mu,T}}{\\mathrm{d}\\langle N\\rangle_{\\mu,T}}.\n$$\n在巨正则系综中，一个统计上有效且精确的关系将关于 $\\mu$ 的导数与协方差联系起来。对重加权平均值关于 $\\mu$ 求导得到\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\mu}\\langle A\\rangle_{\\mu,T}\n=\\beta\\left(\\langle AN\\rangle_{\\mu,T}-\\langle A\\rangle_{\\mu,T}\\langle N\\rangle_{\\mu,T}\\right)=\\beta\\,\\mathrm{Cov}_{\\mu,T}(A,N).\n$$\n将此应用于 $A=U$ 和 $A=N$ 可得\n$$\n\\frac{\\mathrm{d}\\langle U\\rangle_{\\mu,T}}{\\mathrm{d}\\mu}=\\beta\\,\\mathrm{Cov}_{\\mu,T}(U,N),\\qquad\n\\frac{\\mathrm{d}\\langle N\\rangle_{\\mu,T}}{\\mathrm{d}\\mu}=\\beta\\,\\mathrm{Var}_{\\mu,T}(N).\n$$\n因此，根据链式法则，\n$$\nh_{\\mathrm{diff}}(\\mu)=\\frac{\\mathrm{d}\\langle U\\rangle_{\\mu,T}}{\\mathrm{d}\\langle N\\rangle_{\\mu,T}}\n=\\frac{\\frac{\\mathrm{d}\\langle U\\rangle_{\\mu,T}}{\\mathrm{d}\\mu}}{\\frac{\\mathrm{d}\\langle N\\rangle_{\\mu,T}}{\\mathrm{d}\\mu}}\n=\\frac{\\mathrm{Cov}_{\\mu,T}(U,N)}{\\mathrm{Var}_{\\mu,T}(N)}.\n$$\n这个协方差-方差比可以直接从目标 $\\mu$ 处的重加权系综，使用与上面相同的权重 $w_i$ 进行估计：\n$$\n\\langle Q\\rangle_{\\mu,T}\\approx \\frac{\\sum_i Q_i w_i}{\\sum_i w_i},\\quad\n\\mathrm{Var}_{\\mu,T}(N)\\approx \\langle N^2\\rangle_{\\mu,T}-\\langle N\\rangle_{\\mu,T}^2,\\quad\n\\mathrm{Cov}_{\\mu,T}(U,N)\\approx \\langle UN\\rangle_{\\mu,T}-\\langle U\\rangle_{\\mu,T}\\langle N\\rangle_{\\mu,T}.\n$$\n在我们的独立位点模型中，$U=\\varepsilon N$ 是确定性的，所以 $\\mathrm{Cov}(U,N)=\\varepsilon\\,\\mathrm{Var}(N)$，从而得到与 $\\mu$ 无关的精确结果\n$$\nh_{\\mathrm{diff}}(\\mu)=\\varepsilon,\n$$\n这为实现提供了一个严格的验证检查。\n\n算法设计：\n- 对于每个测试用例，使用 $R=0.008314462618$ kJ/mol/K 和以开尔文为单位的 $T$ 计算 $\\beta=1/(RT)$。\n- 在 $(\\mu_0,T)$ 处生成合成时间序列：\n  - 计算单位点占据概率 $p(\\mu_0,T)=\\left(1+\\exp\\left[-\\beta(\\mu_0-\\varepsilon)\\right]\\right)^{-1}$。\n  - 使用指定的种子 $s$ 从 $\\mathrm{Binomial}(M,p)$ 中抽取 $S$ 个样本 $N_i$。\n  - 设置 $U_i=\\varepsilon N_i$。\n- 对于每个目标 $\\mu$：\n  - 形成 $a_i=\\beta(\\mu-\\mu_0)N_i$ 并计算 $a_{\\max}=\\max_i a_i$。\n  - 计算稳定化的权重 $\\tilde{w}_i=\\exp(a_i-a_{\\max})$。\n  - 使用归一化权重 $w_i=\\tilde{w}_i/\\sum_j \\tilde{w}_j$ 计算以下重加权期望：\n    - $\\langle N\\rangle_{\\mu,T}=\\sum_i w_i N_i$, $\\langle U\\rangle_{\\mu,T}=\\sum_i w_i U_i$, $\\langle N^2\\rangle_{\\mu,T}=\\sum_i w_i N_i^2$, $\\langle UN\\rangle_{\\mu,T}=\\sum_i w_i U_i N_i$。\n  - 计算 $\\theta(\\mu)=\\langle N\\rangle_{\\mu,T}/M$。\n  - 计算 $\\mathrm{Var}(N)=\\langle N^2\\rangle_{\\mu,T}-\\langle N\\rangle_{\\mu,T}^2$ 和 $\\mathrm{Cov}(U,N)=\\langle UN\\rangle_{\\mu,T}-\\langle U\\rangle_{\\mu,T}\\langle N\\rangle_{\\mu,T}$。\n  - 计算 $h_{\\mathrm{diff}}(\\mu)=\\mathrm{Cov}(U,N)/\\mathrm{Var}(N)$，单位 kJ/mol。\n  - 计算 $\\Delta\\Omega(\\mu;\\mu_0)$ 的稳定化样本估计：\n    $$\n    \\Delta\\Omega(\\mu;\\mu_0)=-RT\\left(a_{\\max}+\\ln\\left(\\frac{1}{S}\\sum_{i=1}^S e^{a_i-a_{\\max}}\\right)\\right).\n    $$\n- 将 $\\Delta\\Omega(\\mu;\\mu_0)$、$\\theta(\\mu)$ 和 $h_{\\mathrm{diff}}(\\mu)$ 四舍五入到恰好 $6$ 位小数，并按规定输出。\n\n预期的定性行为和检查：\n- 对于测试用例 1，$\\varepsilon=-10.0$ kJ/mol，在采样噪声范围内，对于所有目标 $\\mu$，微分焓应约为 $-10.0$ kJ/mol。类似地，测试用例 2 应得到约 $-5.0$ kJ/mol，测试用例 3 应得到约 $-12.0$ kJ/mol。\n- 对于每个测试用例，吸附等温线 $\\theta(\\mu)$ 应随 $\\mu$ 单调增加。\n- 根据构造，在数值精度范围内，$\\Delta\\Omega(\\mu_0;\\mu_0)=0$ kJ/mol。\n\n该实现遵循这些原则，并在涉及 $N$ 的指数的任何地方使用 log-sum-exp 稳定化，以确保在指定的测试套件中具有数值稳定性。", "answer": "[[4.144414,0.117079,-10.000000],[-0.000000,0.268715,-10.000000],[-4.150645,0.500249,-10.000000],[3.585542,0.377663,-5.000000],[-0.000000,0.500305,-5.000000],[-3.582845,0.622485,-5.000000],[3.518602,0.603310,-12.000000],[0.000000,0.705886,-12.000000],[-3.515286,0.789212,-12.000000]]", "id": "2795432"}]}