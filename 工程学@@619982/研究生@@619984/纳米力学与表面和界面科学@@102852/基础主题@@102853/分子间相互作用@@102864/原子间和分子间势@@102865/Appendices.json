{"hands_on_practices": [{"introduction": "对原子间势的研究，始于理解其最基本的特征：当吸引力与排斥力平衡时所形成的稳定距离。本练习将引导您应用基本微积分，从第一性原理推导Lennard-Jones势的平衡分离距离 $r_0$。[@problem_id:2775095] 掌握这一核心计算，是理解化学键和材料结构的第一步。", "problem": "在两种中性闭壳层原子（典型的如稀有气体在表面上的吸附）之间的纳米尺度接触中，其相互作用可以通过兰纳-琼斯（Lennard–Jones, LJ）$12$–$6$ 势来建模。作为间距 $r$ 的函数，对相互作用的兰纳-琼斯（LJ）势为\n$$\n\\phi_{\\mathrm{LJ}}(r)=4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right],\n$$\n其中 $\\varepsilon>0$ 设定了相互作用的能量标度，$\\sigma>0$ 设定了势能穿过零点的特征长度。在保守中心势中，相对坐标的机械平衡要求力为零，这发生在驻点 $r=r_{0}$ 处，此时 $d\\phi_{\\mathrm{LJ}}/dr=0$。从该平衡条件和给定的势能出发，确定平衡间距 $r_{0}$，并将其表示为 $\\sigma$ 的倍数，即无量纲比 $r_{0}/\\sigma$。以闭式表达式给出最终结果。不需要数值近似或四舍五入。", "solution": "在尝试任何求解之前，需对问题陈述进行验证。\n\n步骤 1：提取已知条件\n- 相互作用由兰纳-琼斯（LJ）$12$–$6$ 势建模。\n- 势函数为 $\\phi_{\\mathrm{LJ}}(r)=4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$。\n- 参数 $\\varepsilon > 0$ 是相互作用能量标度。\n- 参数 $\\sigma > 0$ 是势能穿过零点的特征长度。\n- 系统由一个保守中心势描述。\n- 机械平衡条件由力为零给出，这对应于势的驻点：在 $r=r_{0}$ 处 $d\\phi_{\\mathrm{LJ}}/dr=0$。\n- 目标是确定平衡间距 $r_{0}$，并将其表示为无量纲比 $r_{0}/\\sigma$。\n\n步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据。Lennard-Jones 势是物理学和化学中描述中性原子间范德华相互作用的一个基本且标准的模型。保守一维系统中的机械平衡条件 $F(r) = -d\\phi/dr = 0$ 是经典力学的基石。该问题提法恰当，提供了一个明确定义的函数，并要求找出其驻点的位置，该位置对应一个物理可观测量。参数 $\\varepsilon$ 和 $\\sigma$ 被恰当地定义并带有正值约束，这与它们的物理意义一致。该问题是客观、自洽的，没有任何逻辑矛盾、歧义或不合理的假设。\n\n步骤 3：结论与行动\n问题有效。将推导解答。\n\n对应于中心势 $\\phi_{\\mathrm{LJ}}(r)$ 的力 $F(r)$ 由势的负梯度给出，在一维情况下为 $F(r) = -\\frac{d\\phi_{\\mathrm{LJ}}}{dr}$。机械平衡的条件是合力为零，即 $F(r_0) = 0$，这意味着势处于一个驻点，$\\frac{d\\phi_{\\mathrm{LJ}}}{dr}\\bigg|_{r=r_{0}} = 0$。\n\nLennard-Jones 势给出如下：\n$$\n\\phi_{\\mathrm{LJ}}(r) = 4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]\n$$\n为便于求导，我们将势重写为：\n$$\n\\phi_{\\mathrm{LJ}}(r) = 4\\varepsilon[\\sigma^{12}r^{-12} - \\sigma^{6}r^{-6}]\n$$\n现在，我们使用幂函数求导法则 $\\frac{d}{dx}(x^n) = nx^{n-1}$ 来计算 $\\phi_{\\mathrm{LJ}}(r)$ 对 $r$ 的导数：\n$$\n\\frac{d\\phi_{\\mathrm{LJ}}}{dr} = 4\\varepsilon \\frac{d}{dr}[\\sigma^{12}r^{-12} - \\sigma^{6}r^{-6}]\n$$\n$$\n\\frac{d\\phi_{\\mathrm{LJ}}}{dr} = 4\\varepsilon[\\sigma^{12}(-12r^{-13}) - \\sigma^{6}(-6r^{-7})]\n$$\n$$\n\\frac{d\\phi_{\\mathrm{LJ}}}{dr} = 4\\varepsilon[-12\\sigma^{12}r^{-13} + 6\\sigma^{6}r^{-7}]\n$$\n我们将此导数设为零，以求得平衡间距 $r=r_{0}$：\n$$\n4\\varepsilon[-12\\sigma^{12}r_{0}^{-13} + 6\\sigma^{6}r_{0}^{-7}] = 0\n$$\n由于 $\\varepsilon > 0$，方括号中的量必须为零：\n$$\n-12\\sigma^{12}r_{0}^{-13} + 6\\sigma^{6}r_{0}^{-7} = 0\n$$\n$$\n6\\sigma^{6}r_{0}^{-7} = 12\\sigma^{12}r_{0}^{-13}\n$$\n我们在寻找一个 $r_{0} > 0$ 且 $\\sigma > 0$ 的解。因此，我们可以将等式两边同除以 $6\\sigma^{6}$：\n$$\nr_{0}^{-7} = 2\\sigma^{6}r_{0}^{-13}\n$$\n为了解出 $r_{0}$，我们重排方程，将包含 $r_{0}$ 的项组合在一起：\n$$\n\\frac{r_{0}^{13}}{r_{0}^{7}} = 2\\sigma^{6}\n$$\n$$\nr_{0}^{13-7} = 2\\sigma^{6}\n$$\n$$\nr_{0}^{6} = 2\\sigma^{6}\n$$\n对等式两边取六次方根，并注意到 $r_0$ 和 $\\sigma$ 都是正的物理距离，我们得到唯一的正实数解：\n$$\nr_{0} = (2\\sigma^{6})^{1/6} = 2^{1/6}(\\sigma^{6})^{1/6} = 2^{1/6}\\sigma\n$$\n这个结果给出了平衡间距 $r_0$。问题要求的是无量纲比 $r_{0}/\\sigma$。将我们的结果除以 $\\sigma$：\n$$\n\\frac{r_{0}}{\\sigma} = 2^{1/6}\n$$\n为确认此驻点对应于一个稳定平衡（势能极小值），我们必须检查二阶导数 $\\frac{d^2\\phi_{\\mathrm{LJ}}}{dr^2}$ 在 $r = r_0$ 处的符号。正号表示极小值。\n$$\n\\frac{d^2\\phi_{\\mathrm{LJ}}}{dr^2} = \\frac{d}{dr} \\left( 4\\varepsilon[-12\\sigma^{12}r^{-13} + 6\\sigma^{6}r^{-7}] \\right)\n$$\n$$\n\\frac{d^2\\phi_{\\mathrm{LJ}}}{dr^2} = 4\\varepsilon[-12\\sigma^{12}(-13r^{-14}) + 6\\sigma^{6}(-7r^{-8})]\n$$\n$$\n\\frac{d^2\\phi_{\\mathrm{LJ}}}{dr^2} = 4\\varepsilon[156\\sigma^{12}r^{-14} - 42\\sigma^{6}r^{-8}]\n$$\n在 $r=r_0$ 处求值，其中 $r_0^6=2\\sigma^6$：\n$$\n\\frac{d^2\\phi_{\\mathrm{LJ}}}{dr^2}\\bigg|_{r=r_{0}} = 4\\varepsilon\\left[ \\frac{156\\sigma^{12}}{r_{0}^{14}} - \\frac{42\\sigma^{6}}{r_{0}^{8}} \\right] = \\frac{4\\varepsilon}{r_{0}^{8}} \\left[ \\frac{156\\sigma^{12}}{r_{0}^{6}} - 42\\sigma^{6} \\right]\n$$\n代入 $r_0^6=2\\sigma^6$：\n$$\n\\frac{d^2\\phi_{\\mathrm{LJ}}}{dr^2}\\bigg|_{r=r_{0}} = \\frac{4\\varepsilon}{r_{0}^{8}} \\left[ \\frac{156\\sigma^{12}}{2\\sigma^{6}} - 42\\sigma^{6} \\right] = \\frac{4\\varepsilon}{r_{0}^{8}} [78\\sigma^{6} - 42\\sigma^{6}] = \\frac{4\\varepsilon}{r_{0}^{8}} [36\\sigma^{6}] = \\frac{144\\varepsilon\\sigma^6}{r_0^8}\n$$\n由于 $\\varepsilon > 0$, $\\sigma > 0$ 且 $r_0 > 0$，二阶导数为正。因此，$r_0 = 2^{1/6}\\sigma$ 对应一个稳定平衡点。", "answer": "$$\n\\boxed{2^{1/6}}\n$$", "id": "2775095"}, {"introduction": "如何从单个原子的相互作用预测材料的宏观行为？本练习通过计算第二维里系数 $B_2(T)$ 来回答这一问题，该系数直接关联到Lennard-Jones势并描述了真实气体的性质。[@problem_id:2775099] 这个实践不仅连接了微观与宏观世界，还将训练您处理从理论推导到数值实现的完整流程。", "problem": "您的任务是推导并实现一个数值程序，用于计算在约化单位下，通过Lennard-Jones (LJ)对势相互作用的单原子气体的第二维里系数，然后确定第二维里系数变号的约化玻意耳温度。您的推导必须从基本的统计力学定义出发，并且不得假定任何预先简化的目标表达式。\n\n起点与基本定义：\n- 对于具有对作用加和、球对称相互作用的稀薄单原子气体，其经典正则系综指出第二维里系数$B_{2}(T)$可由Mayer $f$-函数$f(\\mathbf{r})$得到。该函数定义为$f(\\mathbf{r}) = \\exp\\!\\left(-\\beta u(r)\\right) - 1$，其中$\\beta = 1/\\left(k_{\\mathrm{B}} T\\right)$，$u(r)$为对势。其精确定义为\n$$\nB_{2}(T) = -\\frac{1}{2} \\int_{\\mathbb{R}^{3}} f(\\mathbf{r}) \\, d^{3}\\mathbf{r}.\n$$\n- Lennard-Jones (LJ)势为\n$$\nu(r) = 4 \\varepsilon \\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right],\n$$\n其中$\\varepsilon$设定了能量标度，$\\sigma$设定了长度标度。\n\n待执行的任务：\n1. 从上述起点出发，利用球对称性，为$B_{2}(T)$推导出一个显式的一维积分。然后，使用约化变量$r^{\\star} = r / \\sigma$和$T^{\\star} = k_{\\mathrm{B}} T / \\varepsilon$对结果进行无量纲化处理。定义一个约化的、无量纲的第二维里系数$B_{2}^{\\star}(T^{\\star}) = B_{2}(T)/\\sigma^{3}$，以使您的最终积分为完全无量纲。\n2. 解释为何在$r^{\\star} \\in [0,\\infty)$上的所得反常积分在两个极限处都是收敛的，并概述一个能够将其计算到指定精度的稳健数值积分策略。\n3. 实现一个程序，该程序：\n   - 使用适用于从$0$到$\\infty$积分的可靠积分方法，对由上述推导定义的被积函数进行数值计算，求得Lennard-Jones势的$B_{2}^{\\star}(T^{\\star})$。\n   - 使用一种基于介值定理的区间求根方法，在指定的数值容差内，定位使得$B_{2}^{\\star}\\!\\left(T_{\\mathrm{B}}^{\\star}\\right) = 0$的约化玻意耳温度$T_{\\mathrm{B}}^{\\star}$。\n\n数值精度要求：\n- 对于每次数值积分，在$B_{2}^{\\star}$上实现的绝对数值误差不大于$10^{-8}$。\n- 对于定位$T_{\\mathrm{B}}^{\\star}$，在$T^{\\star}$上实现的绝对误差不大于$10^{-6}$。\n\n测试套件：\n- 针对以下约化温度计算$B_{2}^{\\star}(T^{\\star})$：\n  - $T^{\\star} = 0.8$（强吸引主导区）\n  - $T^{\\star} = 2.0$（中等吸引主导区）\n  - $T^{\\star} = 6.0$（排斥主导区）\n  - $T^{\\star} = 100.0$（渐近高温区）\n- 将约化玻意耳温度$T_{\\mathrm{B}}^{\\star}$确定为$B_{2}^{\\star}(T^{\\star})$在区间$[2.5, 5.0]$内的唯一根。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个方括号内的、以逗号分隔的结果列表，顺序如下\n$$\n\\left[ B_{2}^{\\star}(0.8), \\; B_{2}^{\\star}(2.0), \\; B_{2}^{\\star}(6.0), \\; B_{2}^{\\star}(100.0), \\; T_{\\mathrm{B}}^{\\star} \\right],\n$$\n- 每个数字必须四舍五入到$8$位小数。\n- 最终输出中没有物理单位，因为所有量通过构造都已是无量纲的。", "solution": "所述问题具有科学依据，是良定且客观的。它提出了一个统计力学中的标准问题，既需要理论推导，也需要数值实现。所有必要信息均已提供，问题本身没有矛盾或含糊之处。因此，该问题被视为有效，并将提供解决方案。\n\n按照要求，解决方案分为三部分：待计算积分的推导、其性质分析以及数值实现的描述。\n\n### 1. 约化第二维里系数积分的推导\n\n起点是经典正则系综中，对于具有对作用加和相互作用的系统，第二维里系数$B_{2}(T)$的形式化定义：\n$$\nB_{2}(T) = -\\frac{1}{2} \\int_{\\mathbb{R}^{3}} f(\\mathbf{r}) \\, d^{3}\\mathbf{r}\n$$\n其中$f(\\mathbf{r})$是Mayer函数，通过对势$u(r)$和逆热能$\\beta = 1/(k_{\\mathrm{B}} T)$定义：\n$$\nf(\\mathbf{r}) = \\exp(-\\beta u(r)) - 1\n$$\nLennard-Jones (LJ)势$u(r)$是球对称的：\n$$\nu(r) = 4 \\varepsilon \\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]\n$$\n由于这种对称性，Mayer函数仅依赖于径向距离$r = |\\mathbf{r}|$。因此，将体积积分用球坐标表示是有利的，其中体积元为$d^{3}\\mathbf{r} = r^2 \\sin\\theta \\, dr \\, d\\theta \\, d\\phi$。对角坐标$(\\theta, \\phi)$的积分可以立即完成：\n$$\n\\int_{0}^{2\\pi} \\int_{0}^{\\pi} \\sin\\theta \\, d\\theta \\, d\\phi = 4\\pi\n$$\n将此结果代入$B_{2}(T)$的表达式，得到一个关于径向坐标$r$的一维积分：\n$$\nB_{2}(T) = -\\frac{1}{2} (4\\pi) \\int_{0}^{\\infty} [\\exp(-\\beta u(r)) - 1] r^2 \\, dr = -2\\pi \\int_{0}^{\\infty} [\\exp(-\\beta u(r)) - 1] r^2 \\, dr\n$$\n为使此表达式无量纲化，我们引入约化变量$r^{\\star} = r / \\sigma$和$T^{\\star} = k_{\\mathrm{B}} T / \\varepsilon$。指数的参数$\\beta u(r)$可以用这些变量重写：\n$$\n\\beta u(r) = \\frac{1}{k_{\\mathrm{B}} T} \\left( 4 \\varepsilon \\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right] \\right) = \\frac{\\varepsilon}{k_{\\mathrm{B}} T} \\left( 4 \\left[\\left(\\frac{\\sigma}{r^{\\star}\\sigma}\\right)^{12} - \\left(\\frac{\\sigma}{r^{\\star}\\sigma}\\right)^{6}\\right] \\right)\n$$\n$$\n\\beta u(r) = \\frac{1}{T^{\\star}} \\left( 4 \\left[(r^{\\star})^{-12} - (r^{\\star})^{-6}\\right] \\right) = \\frac{u^{\\star}(r^{\\star})}{T^{\\star}}\n$$\n其中$u^{\\star}(r^{\\star}) = u(r)/\\varepsilon$是约化LJ势。\n现在我们将$r = r^{\\star}\\sigma$和$dr = \\sigma \\, dr^{\\star}$代入$B_{2}(T)$的积分中：\n$$\nB_{2}(T) = -2\\pi \\int_{0}^{\\infty} \\left[ \\exp\\left(-\\frac{u^{\\star}(r^{\\star})}{T^{\\star}}\\right) - 1 \\right] (r^{\\star}\\sigma)^2 (\\sigma \\, dr^{\\star})\n$$\n$$\nB_{2}(T) = -2\\pi\\sigma^3 \\int_{0}^{\\infty} \\left[ \\exp\\left(-\\frac{4}{T^{\\star}}\\left((r^{\\star})^{-12} - (r^{\\star})^{-6}\\right)\\right) - 1 \\right] (r^{\\star})^2 \\, dr^{\\star}\n$$\n问题要求的是约化第二维里系数$B_{2}^{\\star}(T^{\\star}) = B_{2}(T)/\\sigma^{3}$。将上式除以$\\sigma^3$得到最终的无量纲表达式：\n$$\nB_{2}^{\\star}(T^{\\star}) = -2\\pi \\int_{0}^{\\infty} \\left[ \\exp\\left(-\\frac{4}{T^{\\star}}\\left((r^{\\star})^{-12} - (r^{\\star})^{-6}\\right)\\right) - 1 \\right] (r^{\\star})^2 \\, dr^{\\star}\n$$\n至此，推导完成。\n\n### 2. 收敛性分析与数值策略\n\n$B_{2}^{\\star}(T^{\\star})$的计算需要求解在区间$r^{\\star} \\in [0, \\infty)$上的一个反常积分。我们必须验证它在两个极限处的收敛性。\n\n**在$r^{\\star} \\to 0^{+}$处的收敛性：**\n当$r^{\\star} \\to 0^{+}$时，排斥项$(r^{\\star})^{-12}$在势函数中占主导地位，导致$u^{\\star}(r^{\\star}) \\to +\\infty$。因此，指数的参数$-u^{\\star}(r^{\\star})/T^{\\star}$趋于$-\\infty$。这使得$\\exp(-u^{\\star}(r^{\\star})/T^{\\star}) \\to 0$。被积函数（我们记为$I(r^{\\star}, T^{\\star})$）的行为如下：\n$$\nI(r^{\\star}, T^{\\star}) = \\left[ \\exp\\left(-\\frac{u^{\\star}(r^{\\star})}{T^{\\star}}\\right) - 1 \\right] (r^{\\star})^2 \\approx (0 - 1)(r^{\\star})^2 = -(r^{\\star})^2\n$$\n由于对于任何$\\delta > 0$，$\\int_{0}^{\\delta} -(r^{\\star})^2 \\, dr^{\\star}$都是有限的，因此该积分在下限处是收敛的。被积函数不是奇异的；其在$r^{\\star}=0$处的值恰好为$0$。\n\n**在$r^{\\star} \\to \\infty$处的收敛性：**\n当$r^{\\star} \\to \\infty$时，$(r^{\\star})^{-12}$和$(r^{\\star})^{-6}$都趋近于$0$，因此$u^{\\star}(r^{\\star}) \\to 0$。指数的参数$-u^{\\star}(r^{\\star})/T^{\\star}$也趋近于$0$。我们可以使用对于小$x$的泰勒展开$e^x - 1 \\approx x$。被积函数的行为如下：\n$$\nI(r^{\\star}, T^{\\star}) \\approx \\left(-\\frac{u^{\\star}(r^{\\star})}{T^{\\star}}\\right) (r^{\\star})^2 = -\\frac{4}{T^{\\star}}\\left((r^{\\star})^{-12} - (r^{\\star})^{-6}\\right) (r^{\\star})^2 \\approx \\frac{4}{T^{\\star}}(r^{\\star})^{-4}\n$$\n在大$r^{\\star}$处的积分行为类似于$\\int_{M}^{\\infty} (r^{\\star})^{-4} \\, dr^{\\star}$，它与$[-(r^{\\star})^{-3}]_{M}^{\\infty}$成正比并且是有限的。被积函数以$(r^{\\star})^{-4}$的速度足够快地衰减，确保了在上限处的收敛性。\n\n**数值积分策略：**\n该积分是良态的，适用于为无限区间设计的标准数值积分程序。我们将使用`scipy.integrate.quad`函数，这是来自QUADPACK库的一个稳健的、自适应的积分程序。\n为保持数值精度，特别是在大$r^{\\star}$处（此时指数的参数接近于零），使用一个能精确计算$e^x - 1$的函数至关重要。`scipy.special.expm1`函数就是为此目的设计的，它能避免两个几乎相等的数相减时发生的精度损失。积分的绝对误差容差将被设置为小于$10^{-9}$的值，以确保$B_2^{\\star}$的最终误差低于要求的$10^{-8}$阈值。\n\n### 3. 数值求解的实现\n\n实现过程涉及两个主要任务：为给定温度计算$B_{2}^{\\star}(T^{\\star})$，以及寻找约化玻意耳温度$T_{\\mathrm{B}}^{\\star}$。\n\n**$B_{2}^{\\star}(T^{\\star})$的计算：**\n将创建一个Python函数来表示$B_{2}^{\\star}(T^{\\star})$。此函数将如上文推导的那样定义被积函数$I(r^{\\star}, T^{\\star})$，并使用`scipy.special.expm1`来保证数值稳定性。然后它将调用`scipy.integrate.quad`来执行从$0$到$\\infty$的积分，将被积函数和温度$T^{\\star}$作为参数传入。`quad`返回的结果再乘以$-2\\pi$，即可得到$B_{2}^{\\star}(T^{\\star})$。\n\n**寻找约化玻意耳温度$T_{\\mathrm{B}}^{\\star}$：**\n约化玻意耳温度$T_{\\mathrm{B}}^{\\star}$是使第二维里系数为零的温度，即$B_{2}^{\\star}(T_{\\mathrm{B}}^{\\star}) = 0$。这是一个求根问题。根据要求，我们必须使用一种区间法。`scipy.optimize.root_scalar`函数与`method='brentq'`是一个绝佳的选择。Brent方法是一种混合算法，它结合了二分法保证收敛的特性和插值法的速度。\n给定的区间$[2.5, 5.0]$必须经过验证。在低温下（例如$T^{\\star}=2.5$），分子间吸引力占主导，导致$B_{2}^{\\star} < 0$。在高温下（例如$T^{\\star}=5.0$），排斥力占主导，导致$B_{2}^{\\star} > 0$。由于$B_{2}^{\\star}(T^{\\star})$是$T^{\\star}$的连续函数，根据介值定理，可以保证在此区间内存在一个根。求根程序的容差`xtol`将设置为$10^{-6}$，以满足对$T_{\\mathrm{B}}^{\\star}$指定的精度要求。\n\n最终的程序将为四个指定温度计算$B_2^{\\star}$，找到$T_B^{\\star}$，并按要求的格式打印结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import root_scalar\nfrom scipy.special import expm1\n\ndef solve():\n    \"\"\"\n    Derives and implements the computation of the second virial coefficient for a\n    Lennard-Jones fluid and finds the reduced Boyle temperature.\n    \"\"\"\n\n    def compute_B2_star(T_star):\n        \"\"\"\n        Computes the reduced second virial coefficient B2*(T*) for a given\n        reduced temperature T*.\n\n        Args:\n            T_star (float): The reduced temperature, k_B*T / epsilon.\n\n        Returns:\n            float: The reduced second virial coefficient, B2 / sigma**3.\n        \"\"\"\n\n        # The integrand is derived from the formal definition of B2:\n        # Integrand(r*) = [exp(-u*(r*)/T*) - 1] * (r*)**2\n        # where u*(r*) = 4 * ((r*)**-12 - (r*)**-6)\n        def integrand(r_star, T_star_arg):\n            \"\"\"\n            Integrand for the B2* calculation.\n            \"\"\"\n            # At r_star = 0, the integrand is zero. While quad is unlikely to\n            # sample at exactly 0, handling this case explicitly is robust.\n            if r_star == 0.0:\n                return 0.0\n            \n            # Pre-calculate expensive powers for efficiency.\n            r_star_inv6 = r_star**(-6)\n            r_star_inv12 = r_star_inv6**2\n\n            # The dimensionless potential energy term in the exponential.\n            u_star_over_T_star = (4.0 / T_star_arg) * (r_star_inv12 - r_star_inv6)\n\n            # Use expm1(x) = exp(x) - 1 for numerical stability when the\n            # argument is close to zero (at large r_star).\n            return expm1(-u_star_over_T_star) * r_star**2\n\n        # Perform the numerical integration from r*=0 to infinity.\n        # The absolute error tolerance for the integral is set to a small\n        # value (1e-12) to ensure the final absolute error in B2* is below\n        # the required 1e-8. The error in B2* is 2*pi times the error from quad.\n        integral_val, _ = quad(\n            integrand, 0, np.inf, args=(T_star,),\n            epsabs=1e-12, epsrel=1e-12, limit=200\n        )\n\n        # The full expression for B2_star includes the prefactor -2*pi.\n        B2_star = -2.0 * np.pi * integral_val\n        return B2_star\n\n    # Test suite: defined reduced temperatures for calculation.\n    test_cases_T_star = [0.8, 2.0, 6.0, 100.0]\n\n    results = []\n    # Calculate B2* for each specified temperature.\n    for T_s in test_cases_T_star:\n        b2_val = compute_B2_star(T_s)\n        results.append(b2_val)\n\n    # Find the reduced Boyle Temperature where B2*(T*) = 0.\n    # The problem provides a valid bracket [2.5, 5.0].\n    # At T*<T_B*, B2*<0. At T*>T_B*, B2*>0.\n    bracket = [2.5, 5.0]\n\n    # Use a robust bracketing root-finder (Brent's method).\n    # The absolute tolerance for the root (xtol) is set to 1e-6 as required.\n    boyle_temp_result = root_scalar(\n        compute_B2_star,\n        bracket=bracket,\n        method='brentq',\n        xtol=1e-6\n    )\n\n    T_B_star = boyle_temp_result.root\n    results.append(T_B_star)\n\n    # Format the results to 8 decimal places as required.\n    formatted_results = [f\"{res:.8f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2775099"}, {"introduction": "理论模型在计算机模拟中的应用，往往需要在物理真实性和计算效率之间做出权衡。本练习探讨了分子动力学模拟中为加速计算而广泛使用的势函数“截断”技术，以及为修正截断误差而设计的势能移动与力移动方法。[@problem_id:2775234] 通过解决这个问题，您将深入理解平滑的势函数对于能量守恒等模拟基本原则的重要性。", "problem": "在一个凝聚相的分子动力学 (MD) 模拟中，一个由相同原子组成的系统通过中心对势相互作用。假设未截断的对势是兰纳-琼斯势\n$$\n\\phi(r)=4\\varepsilon\\left[\\left(\\dfrac{\\sigma}{r}\\right)^{12}-\\left(\\dfrac{\\sigma}{r}\\right)^{6}\\right],\n$$\n其中对间距为 $r$，能量标度为 $\\varepsilon$，长度标度为 $\\sigma$。为了降低计算成本，相互作用在截断半径 $r_{c}$ 处被截断，超出该半径的对相互作用被视为零。您需要构建两种修正势：\n\n(i) 一种势能移位形式 $\\phi_{s}(r)$，它消除了势在 $r_{c}$ 处的不连续性，以及\n\n(ii) 一种力移位形式 $\\phi_{fs}(r)$，它额外消除了力在 $r_{c}$ 处的不连续性。\n\n您必须根据以下原则进行推导：(a) 间距为 $r$ 的一对原子的势能为 $\\phi(r)$，(b) 对力的大小为 $F(r)=-\\dfrac{d\\phi}{dr}$，沿中心连线作用，以及 (c) 在具有光滑力的哈密顿动力学中，总能量在连续时间极限下是守恒的，而力的不连续性会在离散时间积分中引入冲量误差。\n\n以下哪个选项给出了 $\\phi_{s}(r)$ 和 $\\phi_{fs}(r)$ 的正确表达式，指明了在 $r_{c}$ 处的正确连续性性质，并正确陈述了在具有有限时间步长的微正则MD（总能量恒定）中对长时间能量守恒的定性影响？\n\nA.\n$$\n\\phi_{s}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n\\qquad\n\\phi_{fs}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c})-(r-r_{c})\\,\\phi'(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n$$\n其中 $\\phi_{s}(r)$ 在 $r_{c}$ 处连续但 $F_{s}(r)$ 不连续，而 $\\phi_{fs}(r)$ 和 $F_{fs}(r)$ 在 $r_{c}$ 处均连续。在实践中，相对于势能移位形式，力移位形式减少了长时间的能量漂移，但除非时间步长趋于 $0$ 或使用更平滑的开关函数，否则不能保证精确的能量守恒。\n\nB.\n$$\n\\phi_{s}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n\\qquad\n\\phi_{fs}(r)=\n\\begin{cases}\n\\phi(r)-\\dfrac{r_{c}}{r}\\,\\phi(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n$$\n并且两种构建都使力连续，因此对于任何有限时间步长都能保证精确的总能量守恒。\n\nC.\n$$\n\\phi_{s}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n\\qquad\n\\phi_{fs}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c})-(r-r_{c})\\,\\phi'(r_{c})-\\dfrac{1}{2}(r-r_{c})^{2}\\,\\phi''(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n$$\n并且因为 $\\phi_{fs}(r)$ 在 $r_{c}$ 处是二次连续可微的，所以微正则MD在任何有限时间步长下都表现出精确的总能量守恒。\n\nD.\n$$\n\\phi_{s}(r)=\n\\begin{cases}\n\\phi(r), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n\\qquad\n\\phi_{fs}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c})+(r-r_{c})\\,\\phi'(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n$$\n并且未移位的截断 $\\phi_{s}(r)$ 使能量漂移最小化，因为它在 $r<r_{c}$ 范围内保持力不变，而 $\\phi_{fs}(r)$ 中的线性修正会增加能量漂移。", "solution": "该问题陈述在科学上是有效且表述清晰的。我们将进行严格的推导。目标是为分子动力学模拟构建兰纳-琼斯势 $\\phi(r)$ 的两种修正形式，其中相互作用在截断距离 $r_c$ 处被截断。对于 $r \\ge r_c$，势被设为零。\n\n设原始势为\n$$\n\\phi(r)=4\\varepsilon\\left[\\left(\\dfrac{\\sigma}{r}\\right)^{12}-\\left(\\dfrac{\\sigma}{r}\\right)^{6}\\right]\n$$\n相应的力的大小为\n$$\nF(r) = -\\dfrac{d\\phi}{dr} = -4\\varepsilon\\left[-12\\dfrac{\\sigma^{12}}{r^{13}} + 6\\dfrac{\\sigma^6}{r^7}\\right] = 24\\dfrac{\\varepsilon}{\\sigma}\\left[2\\left(\\dfrac{\\sigma}{r}\\right)^{13}-\\left(\\dfrac{\\sigma}{r}\\right)^{7}\\right]\n$$\n一个简单的截断将势设为 $\\phi_{trunc}(r) = \\phi(r)$ (当 $r < r_c$ 时) 和 $\\phi_{trunc}(r) = 0$ (当 $r \\ge r_c$ 时)。这在 $r_c$ 处引入了大小为 $\\phi(r_c)$ 的势能不连续性，除非 $\\phi(r_c)=0$（对于典型的 $r_c$ 值，这通常不成立）。这种势能的不连续性在物理上是不合理的，并会导致无穷大的力。在数值模拟中，粒子穿过截断球面时会经历非物理的冲量，从而灾难性地破坏能量守恒。\n\n我们的任务是构建在不同程度上弥补这些问题的势。\n\n**势能移位形式 $\\phi_s(r)$ 的构建**\n\n第一个要求是构建一个在 $r_c$ 处连续的势 $\\phi_s(r)$。对于 $r \\ge r_c$，势定义为 $0$。因此，我们必须强制执行条件 $\\lim_{r \\to r_c^-} \\phi_s(r) = 0$。\n\n势的定义只差一个加性常数，因为这不影响从中导出的物理力。因此，对于 $r < r_c$，我们可以定义 $\\phi_s(r) = \\phi(r) + C$，其中 $C$ 是一个常数。应用连续性条件：\n$$\n\\lim_{r \\to r_c^-} (\\phi(r) + C) = \\phi(r_c) + C = 0\n$$\n这要求 $C = -\\phi(r_c)$。因此，势能移位形式为：\n$$\n\\phi_s(r) =\n\\begin{cases}\n\\phi(r) - \\phi(r_c), & r < r_c \\\\\n0, & r \\ge r_c\n\\end{cases}\n$$\n根据构建，$\\phi_s(r)$ 在 $r=r_c$ 处是连续的。让我们检查相应的力，$F_s(r) = -d\\phi_s/dr$。\n对于 $r < r_c$：\n$$\nF_s(r) = -\\dfrac{d}{dr}(\\phi(r) - \\phi(r_c)) = -\\dfrac{d\\phi}{dr} = F(r)\n$$\n对于 $r > r_c$, $F_s(r) = 0$。\n在截断点，力存在不连续性：\n$$\n\\lim_{r \\to r_c^-} F_s(r) = F(r_c) = -\\phi'(r_c)\n$$\n而对于 $r > r_c$，力为 $0$。只要 $\\phi'(r_c) \\neq 0$（对于任何不处于势能极小点的典型 $r_c$ 都是如此），力 $F_s(r)$ 在 $r_c$ 处就是不连续的。这种力的不连续性会在数值积分算法（如Verlet算法）中导致冲量误差，从而引起总能量在长时间模拟中的系统性漂移。\n\n**力移位形式 $\\phi_{fs}(r)$ 的构建**\n\n第二个要求是构建一个势 $\\phi_{fs}(r)$，使得势本身和导出的力 $F_{fs}(r)$ 在 $r_c$ 处都是连续的。这意味着当 $r \\to r_c^-$ 时，我们必须满足两个条件：\n1.  $\\phi_{fs}(r_c) = 0$ (势的连续性)\n2.  $F_{fs}(r_c) = -\\phi'_{fs}(r_c) = 0$ (力的连续性)\n\n我们正在修正 $r<r_c$ 范围内的势。实现这一点的标准方法是从 $\\phi(r)$ 中减去一个函数，该函数在 $r_c$ 处与 $\\phi(r)$ 的值和导数相匹配。这等同于减去 $\\phi(r)$ 在 $r_c$ 附近的一阶泰勒展开。设修正项为 $r$ 的线性函数 $g(r) = A + B(r-r_c)$。我们定义 $\\phi_{fs}(r) = \\phi(r) - g(r)$ (当 $r < r_c$ 时)。\n\n条件是：\n1.  $\\phi_{fs}(r_c) = \\phi(r_c) - g(r_c) = \\phi(r_c) - A = 0 \\implies A = \\phi(r_c)$。\n2.  $\\phi'_{fs}(r_c) = \\phi'(r_c) - g'(r_c) = \\phi'(r_c) - B = 0 \\implies B = \\phi'(r_c)$。\n\n所以，要减去的函数是 $g(r) = \\phi(r_c) + (r-r_c)\\phi'(r_c)$。\n得到的 $r < r_c$ 范围内的力移位势为：\n$$\n\\phi_{fs}(r) = \\phi(r) - [\\phi(r_c) + (r-r_c)\\phi'(r_c)] = \\phi(r) - \\phi(r_c) - (r-r_c)\\phi'(r_c)\n$$\n而对于 $r \\ge r_c$, $\\phi_{fs}(r) = 0$。\n让我们验证其性质。\n- **势**: $\\lim_{r \\to r_c^-} \\phi_{fs}(r) = \\phi(r_c) - \\phi(r_c) - (r_c-r_c)\\phi'(r_c) = 0$。连续。\n- **力**: 对于 $r < r_c$ 的力是 $F_{fs}(r) = -d\\phi_{fs}/dr$。\n$$\nF_{fs}(r) = -\\dfrac{d}{dr} \\left[\\phi(r) - \\phi(r_c) - (r-r_c)\\phi'(r_c)\\right] = -\\left[\\phi'(r) - \\phi'(r_c)\\right] = F(r) - F(r_c)\n$$\n当 $r \\to r_c^-$ 时，$F_{fs}(r) \\to F(r_c) - F(r_c) = 0$。由于对于 $r > r_c$ 时 $F_{fs}(r)=0$，因此力是连续的。\n\n**对能量守恒的影响**\n\n在具有有限时间步长 $\\Delta t$ 的微正则 (NVE) 模拟中，只有当数值积分器是精确的时，总能量才守恒，而对于一般的势来说，情况并非如此。能量守恒的质量取决于势的光滑性。\n-  **势能移位势 ($\\phi_s$)**: 在 $r_c$ 处的力 $F_s$ 的不连续性会对穿过截断面的粒子产生一个“踢力”。这会引入能量守恒的一阶误差，导致显著的长期能量漂移。\n-  **力移位势 ($\\phi_{fs}$)**: 力 $F_{fs}$ 处处连续 ($C^0$)。这消除了在 $r_c$ 处的冲量误差。然而，势的二阶导数 $\\phi_{fs}''(r) = \\phi''(r)$ 在 $r_c$ 处通常是不连续的，因为对于 $r>r_c$ 时 $\\phi_{fs}''(r)=0$。$\\phi''$（以及更高阶导数）的这种不连续性仍然会给数值积分带来误差（例如，速度Verlet算法的局部截断误差取决于 $\\phi'''$）。因此，虽然与势能移位的情况相比，能量守恒性得到了极大的改善，但对于有限的 $\\Delta t$ 而言，它不是精确的。仍会存在缓慢的漂移。只有在极限 $\\Delta t \\to 0$ 时才能恢复精确的守恒。\n\n现在我们评估所给的选项。\n\n**A.**\n$$\n\\phi_{s}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n\\qquad\n\\phi_{fs}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c})-(r-r_{c})\\,\\phi'(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n$$\n这个选项给出了我们上面推导出的 $\\phi_s(r)$ 和 $\\phi_{fs}(r)$ 的正确表达式。它正确地指出 $\\phi_s(r)$ 是连续的而 $F_s(r)$ 不是，以及 $\\phi_{fs}(r)$ 和 $F_{fs}(r)$ 都是连续的。关于能量守恒的陈述也是正确的：相对于势能移位形式，力移位形式改善（减少）了能量漂移，但对于有限的 $\\Delta t$ 不能实现精确守恒。\n结论：**正确**。\n\n**B.**\n$$\n\\phi_{s}(r)=\\dots \\quad \\phi_{fs}(r)=\n\\begin{cases}\n\\phi(r)-\\dfrac{r_{c}}{r}\\,\\phi(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n$$\n$\\phi_{fs}(r)$ 的表达式不正确。我们计算其在 $r < r_c$ 范围内对应的力：\n$F_{fs}(r) = -d/dr [\\phi(r) - r_c\\phi(r_c)r^{-1}] = -\\phi'(r) - r_c\\phi(r_c)r^{-2}$。\n在 $r_c$ 处，这给出 $\\lim_{r \\to r_c^-} F_{fs}(r) = -\\phi'(r_c) - \\phi(r_c)/r_c$，这通常不为零。因此，这种形式不能使力连续。其结论性陈述——两种构建都使力连续并保证精确的能量守恒——在多个方面都是错误的。\n结论：**错误**。\n\n**C.**\n$$\n\\phi_{s}(r)=\\dots \\quad \\phi_{fs}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c})-(r-r_{c})\\,\\phi'(r_{c})-\\dfrac{1}{2}(r-r_{c})^{2}\\,\\phi''(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n$$\n这个 $\\phi_{fs}(r)$ 的表达式减去了 $\\phi(r)$ 在 $r_c$ 处的二阶泰勒展开。这个过程使得势、力以及势的二阶导数在 $r_c$ 处连续。虽然这是一种创建更平滑势（$C^2$ 势）的有效方法，但这并非问题所要求的、标准定义的“力移位”（$C^1$ 势）。更重要的是，“这导致在任何有限时间步长下都实现精确的总能量守恒”的说法是错误的。无论光滑度如何，辛积分器对于任意势都不是精确的。高阶导数的不连续性仍然会导致数值误差。\n结论：**错误**。\n\n**D.**\n$$\n\\phi_{s}(r)=\n\\begin{cases}\n\\phi(r), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n\\qquad\n\\phi_{fs}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c})+(r-r_{c})\\,\\phi'(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n$$\n为 $\\phi_s(r)$ 给出的表达式是简单的、未移位的截断，它在 $r_c$ 处是不连续的。这未能满足消除势不连续性的条件。$\\phi_{fs}(r)$ 的表达式在线性项上存在符号错误；加号应为减号。这种不正确的形式不会导致力的连续性。所提供的物理解释存在根本性缺陷：由于势的不连续性（无穷大的力），未移位截断的能量守恒最差，而不是最好。\n结论：**错误**。\n\n因此，只有选项A提供了正确的数学形式，正确地指出了它们的连续性性质，并准确地描述了其在数值模拟中对能量守恒的物理影响。", "answer": "$$\\boxed{A}$$", "id": "2775234"}]}