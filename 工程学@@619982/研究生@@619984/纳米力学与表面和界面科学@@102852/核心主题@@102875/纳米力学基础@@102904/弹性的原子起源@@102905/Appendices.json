{"hands_on_practices": [{"introduction": "本章的第一个练习旨在巩固核心概念：宏观弹性源于原子间作用力。通过从两个常见的对势函数中解析推导体弹性模量，您将从第一性原理的层面理解势能阱的形状如何直接决定材料的刚度。这项基础性实践对于建立关于力学性质的原子尺度起源的直觉至关重要。[@problem_id:2765203]", "problem": "一个单原子面心立方 (fcc) 晶体通过中心对势进行建模，其中只有最近邻相互作用对内聚能有贡献。考虑了两种备选的原子间势：\n\n1) Lennard-Jones 势，由 $U_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$ 给出。\n\n2) Morse 势，由 $U_{\\mathrm{M}}(r) = D \\left\\{ \\left[ 1 - \\exp\\left( -\\alpha (r - r_{0}) \\right) \\right]^{2} - 1 \\right\\}$ 给出。\n\n假设采用以下建模选择：\n- 内聚势阱深度匹配：$D = \\epsilon$。\n- 通过选择 Morse 参数 $r_{0}$ 等于 Lennard-Jones 平衡间距，来匹配平衡最近邻距离。\n- 假设处于零温和静水加载条件下。fcc 配位数为 $z=12$，最近邻距离通过 $r = a/\\sqrt{2}$ 与立方晶格参数相关联，每原子体积为 $\\Omega = a^{3}/4$。\n\n从第一性原理出发，仅使用以下标准基础：牛顿力学、应变的定义、能量的对加性，以及体积模量 $B$ 作为能量对体积在平衡状态下的二阶导数的热力学定义。按以下步骤进行：\n- 确定使 $U_{\\mathrm{LJ}}(r)$ 最小化的平衡间距 $r_{\\mathrm{LJ}}$。\n- 计算在各自最小值处的曲率 $U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}})$ 和 $U_{\\mathrm{M}}''(r_{0})$。\n- 在所述的最近邻近似下，根据平衡最近邻距离处的对势曲率和晶格几何，推导出 fcc 晶体的体积模量 $B$。\n- 使用深度匹配和距离匹配条件，确定比值 $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$，并将其表示为仅含参数 $\\alpha$ 和 $\\sigma$ 的闭式解析表达式。\n\n将最终答案作为比值 $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$ 的单个闭式解析表达式提供。最终的方框答案中不要包含单位。", "solution": "该问题要求确定分别用 Lennard-Jones (LJ) 和 Morse (M) 对势建模的面心立方 (fcc) 晶体的体积模量之比 $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$。分析将在最近邻相互作用近似下，从第一性原理出发进行。\n\n首先，给定的原子间势为：\nLennard-Jones 势：$U_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$。\nMorse 势：$U_{\\mathrm{M}}(r) = D \\left\\{ \\left[ 1 - \\exp\\left( -\\alpha (r - r_{0}) \\right) \\right]^{2} - 1 \\right\\}$。\n\n问题指明了以下匹配条件：势阱深度相等，$D = \\epsilon$，并且 Morse 势的平衡间距 $r_{0}$ 被设定为与 LJ 势的平衡间距（我们记为 $r_{\\mathrm{LJ}}$）相等。\n\n解题过程按要求分四个阶段进行：\n1.  确定 Lennard-Jones 势的平衡间距 $r_{\\mathrm{LJ}}$。\n2.  计算两种势在各自平衡间距处的二阶导数（曲率）$U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}})$ 和 $U_{\\mathrm{M}}''(r_{0})$。\n3.  在最近邻近似下，推导 fcc 晶体体积模量 $B$ 的通用表达式。\n4.  结合这些结果求出比值 $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$。\n\n**步骤 1：Lennard-Jones 势的平衡间距**\n\n平衡间距 $r_{\\mathrm{LJ}}$ 是使势能 $U_{\\mathrm{LJ}}(r)$ 最小化的原子间距。这可以通过将势对 $r$ 的一阶导数设为零来找到。\n$$ \\frac{dU_{\\mathrm{LJ}}}{dr} = 4 \\epsilon \\left[ \\sigma^{12}(-12)r^{-13} - \\sigma^{6}(-6)r^{-7} \\right] $$\n设 $\\frac{dU_{\\mathrm{LJ}}}{dr} = 0$：\n$$ 4 \\epsilon \\left[ -12 \\frac{\\sigma^{12}}{r^{13}} + 6 \\frac{\\sigma^{6}}{r^{7}} \\right] = 0 $$\n$$ 6 \\frac{\\sigma^{6}}{r^{7}} = 12 \\frac{\\sigma^{12}}{r^{13}} $$\n这可以简化为 $r^{6} = 2\\sigma^{6}$，从而得出平衡间距：\n$$ r_{\\mathrm{LJ}} = 2^{1/6} \\sigma $$\n\n**步骤 2：平衡点处势的曲率**\n\n首先，我们求 Lennard-Jones 势的二阶导数 $U_{\\mathrm{LJ}}''(r)$。\n$$ U_{\\mathrm{LJ}}''(r) = \\frac{d^2 U_{\\mathrm{LJ}}}{dr^2} = 4 \\epsilon \\left[ (-12)(-13)\\sigma^{12}r^{-14} - (6)(-7)\\sigma^{6}r^{-8} \\right] $$\n$$ U_{\\mathrm{LJ}}''(r) = 4 \\epsilon \\left[ 156 \\frac{\\sigma^{12}}{r^{14}} - 42 \\frac{\\sigma^{6}}{r^{8}} \\right] $$\n我们在 $r = r_{\\mathrm{LJ}} = 2^{1/6} \\sigma$ 处计算该值。在此距离上，我们有关系式 $r_{\\mathrm{LJ}}^{6} = 2\\sigma^{6}$ 和 $r_{\\mathrm{LJ}}^{12} = 4\\sigma^{12}$。\n$$ U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}}) = \\frac{4\\epsilon}{r_{\\mathrm{LJ}}^{2}} \\left[ 156 \\frac{\\sigma^{12}}{r_{\\mathrm{LJ}}^{12}} - 42 \\frac{\\sigma^{6}}{r_{\\mathrm{LJ}}^{6}} \\right] = \\frac{4\\epsilon}{(2^{1/6}\\sigma)^{2}} \\left[ 156 \\left(\\frac{1}{4}\\right) - 42 \\left(\\frac{1}{2}\\right) \\right] $$\n$$ U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}}) = \\frac{4\\epsilon}{2^{1/3}\\sigma^{2}} \\left[ 39 - 21 \\right] = \\frac{4\\epsilon(18)}{2^{1/3}\\sigma^{2}} = \\frac{72\\epsilon}{2^{1/3}\\sigma^{2}} $$\n\n接着，我们求 Morse 势的二阶导数 $U_{\\mathrm{M}}''(r)$。其一阶导数为：\n$$ U_{\\mathrm{M}}'(r) = D \\cdot 2\\left[1 - \\exp\\left(-\\alpha(r-r_0)\\right)\\right] \\cdot \\left( \\alpha \\exp\\left(-\\alpha(r-r_0)\\right) \\right) $$\n$$ U_{\\mathrm{M}}'(r) = 2D\\alpha \\left[ \\exp\\left(-\\alpha(r-r_0)\\right) - \\exp\\left(-2\\alpha(r-r_0)\\right) \\right] $$\n其二阶导数为：\n$$ U_{\\mathrm{M}}''(r) = 2D\\alpha \\left[ -\\alpha\\exp\\left(-\\alpha(r-r_0)\\right) - (-2\\alpha)\\exp\\left(-2\\alpha(r-r_0)\\right) \\right] $$\n$$ U_{\\mathrm{M}}''(r) = 2D\\alpha^{2} \\left[ -\\exp\\left(-\\alpha(r-r_0)\\right) + 2\\exp\\left(-2\\alpha(r-r_0)\\right) \\right] $$\nMorse 势的平衡间距在 $r=r_0$ 处。在该点计算曲率：\n$$ U_{\\mathrm{M}}''(r_0) = 2D\\alpha^{2} \\left[ -\\exp(0) + 2\\exp(0) \\right] = 2D\\alpha^{2} \\left[ -1 + 2 \\right] = 2D\\alpha^{2} $$\n\n**步骤 3：体积模量的推导**\n\n在最近邻模型中，每原子的总能量 $E$ 为 $E = \\frac{1}{2}z U(r)$，其中 $z$ 是配位数。对于 fcc 晶格，$z=12$，因此 $E(r) = 6U(r)$。零温下的体积模量定义为 $B = \\Omega_0 \\left( \\frac{d^2 E}{d\\Omega^2} \\right)_{\\Omega=\\Omega_0}$，其中 $\\Omega$ 是每原子体积，$\\Omega_0$ 是平衡时的每原子体积。\n\n对于 fcc 晶格，最近邻距离 $r$ 通过 $r=a/\\sqrt{2}$ 与立方晶格参数 $a$ 相关联。每原子体积为 $\\Omega = a^3/4$。我们用 $r$ 来表示 $\\Omega$：\n$$ a = r\\sqrt{2} \\implies \\Omega(r) = \\frac{(r\\sqrt{2})^3}{4} = \\frac{2\\sqrt{2}r^3}{4} = \\frac{r^3}{\\sqrt{2}} $$\n现在我们使用链式法则计算导数。\n$$ \\frac{dE}{d\\Omega} = \\frac{dE/dr}{d\\Omega/dr} = \\frac{6 U'(r)}{3r^2/\\sqrt{2}} = \\frac{2\\sqrt{2}U'(r)}{r^2} $$\n二阶导数为：\n$$ \\frac{d^2E}{d\\Omega^2} = \\frac{d}{d\\Omega}\\left( \\frac{dE}{d\\Omega} \\right) = \\frac{d/dr(dE/d\\Omega)}{d\\Omega/dr} = \\frac{\\frac{d}{dr}\\left(\\frac{2\\sqrt{2}U'(r)}{r^2}\\right)}{3r^2/\\sqrt{2}} $$\n$$ \\frac{d^2E}{d\\Omega^2} = \\frac{2\\sqrt{2} \\left( \\frac{U''(r)r^2 - 2rU'(r)}{r^4} \\right)}{3r^2/\\sqrt{2}} = \\frac{4}{3r^5} \\left( rU''(r) - 2U'(r) \\right) $$\n在平衡点 $r=r_e$，势的一阶导数为零，$U'(r_e)=0$。因此，该表达式简化为：\n$$ \\left( \\frac{d^2E}{d\\Omega^2} \\right)_{\\Omega_0} = \\frac{4}{3r_e^5} \\left( r_e U''(r_e) \\right) = \\frac{4U''(r_e)}{3r_e^4} $$\n平衡体积为 $\\Omega_0 = r_e^3/\\sqrt{2}$。代入 $B$ 的定义中：\n$$ B = \\Omega_0 \\left( \\frac{d^2E}{d\\Omega^2} \\right)_{\\Omega_0} = \\frac{r_e^3}{\\sqrt{2}} \\cdot \\frac{4U''(r_e)}{3r_e^4} = \\frac{4U''(r_e)}{3\\sqrt{2}r_e} = \\frac{2\\sqrt{2}U''(r_e)}{3r_e} $$\n\n**步骤 4：体积模量之比**\n\n使用推导出的 $B$ 的表达式，比值 $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$ 为：\n$$ \\frac{B_{\\mathrm{LJ}}}{B_{\\mathrm{M}}} = \\frac{ \\frac{2\\sqrt{2}U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}})}{3r_{\\mathrm{LJ}}} }{ \\frac{2\\sqrt{2}U_{\\mathrm{M}}''(r_{0})}{3r_{0}} } $$\n在 $r_{\\mathrm{LJ}} = r_{0}$ 的条件下，几何因子相互抵消，该比值简化为势曲率之比：\n$$ \\frac{B_{\\mathrm{LJ}}}{B_{\\mathrm{M}}} = \\frac{U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}})}{U_{\\mathrm{M}}''(r_{0})} $$\n代入计算出的曲率并使用条件 $D = \\epsilon$：\n$$ U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}}) = \\frac{72\\epsilon}{2^{1/3}\\sigma^{2}} $$\n$$ U_{\\mathrm{M}}''(r_0) = 2D\\alpha^2 = 2\\epsilon\\alpha^2 $$\n因此，比值为：\n$$ \\frac{B_{\\mathrm{LJ}}}{B_{\\mathrm{M}}} = \\frac{ \\frac{72\\epsilon}{2^{1/3}\\sigma^{2}} }{ 2\\epsilon\\alpha^2 } = \\frac{72}{2 \\cdot 2^{1/3} \\alpha^2 \\sigma^2} = \\frac{36}{2^{1/3} \\alpha^2 \\sigma^2} $$\n这就是用指定参数 $\\alpha$ 和 $\\sigma$ 表示该比值的最终解析表达式。", "answer": "$$\\boxed{\\frac{36}{2^{1/3} \\alpha^{2} \\sigma^{2}}}$$", "id": "2765203"}, {"introduction": "从解析理论转向计算实践，这个练习将挑战您像计算材料科学家一样思考。通过评估使用密度泛函理论（DFT）计算弹性常数的不同方法，您将学会在准确性和计算成本之间做出关键权衡。这个问题强调了稳健的数值方案的重要性，包括适当的收敛性测试和误差控制，这些都是进行可靠材料模拟的基本技能。[@problem_id:2765156]", "problem": "一个单原子面心立方金属在周期性边界条件下，采用平面波密度泛函理论进行建模。目标是从有限形变中提取零应变附近的二阶弹性常数。您将只考虑均匀形变，并专注于提取体弹性模量和一个剪切模量。该材料是金属性的，因此需要进行布里渊区采样。目标精度是使每个报告的弹性常数的绝对误差低于 $2\\,\\mathrm{GPa}$。平衡状态下的原子体积为每个原子 $V_0 = 16\\,\\mathrm{\\AA}^3$。您可以假设，对于所考虑的所有应变，内部坐标都由对称性固定；计算是在零温静态条件下进行的；并且整个过程中使用相同的赝势。\n\n提出了四种方法策略，每种策略都指定了应变大小、用于拟合的可观测量以及数值参数的收敛标准。基于第一性原理以及关于弹性和电子结构收敛性的公认事实，确定哪种策略足以确保提取的弹性常数的总误差保持在 $2\\,\\mathrm{GPa}$ 以下。\n\nA. 使用总能量对应变的拟合，在应变 $\\varepsilon = \\{-0.005, 0, +0.005\\}$ 处采用中心有限差分法。通过增加平面波截断能和使用一个带有 $0.2\\,\\mathrm{eV}$ 电子展宽的 $12\\times 12\\times 12$ Monkhorst–Pack $k$点网格，使每个应变下的总能量收敛到 $0.1\\,\\mathrm{meV}$/原子以内。在不同应变下保持 $k$点网格不变。当连续增加平面波截断能导致总能量变化小于 $0.1\\,\\mathrm{meV}$/原子时，接受该模量。\n\nB. 对静水压和适当的保持对称性的剪切形变，在应变 $\\varepsilon = \\{-0.005, 0, +0.005\\}$ 处使用应力对应变的拟合，并采用中心有限差分法。对于每个应变，收敛应力张量分量，使得在 (i) 保持倒易空间中 $k$点间距在应变下固定的同时，将 $k$点网格密度加倍，以及 (ii) 将平面波截断能增加 $20\\%$ 后，每个相关应力分量的变化小于 $10\\,\\mathrm{MPa}$。通过增加截断能，直到零应变应力的变化小于 $5\\,\\mathrm{MPa}$，来确保零应变下的绝对 Pulay 应力低于 $5\\,\\mathrm{MPa}$。通过在 $\\varepsilon \\in [0.003, 0.008]$ 上进行拟合，并要求当拟合窗口在该范围内变化时，拟合出的模量变化不超过 $1\\,\\mathrm{GPa}$，来验证简谐性。使用原胞，但在所有应变晶胞中保持近似恒定的 $k$点间距 $\\Delta k \\le 0.02\\,\\mathrm{\\AA}^{-1}$。\n\nC. 使用总能量对应变的拟合，在应变 $\\varepsilon = \\{-0.02, 0, +0.02\\}$ 处采用中心有限差分法。使每个应变下的总能量收敛到 $1\\,\\mathrm{meV}$/原子以内。用 $4\\times 4\\times 4$ 超胞的 $\\Gamma$点计算代替密集的 $k$点网格，以减少布里渊区积分误差；一旦将超胞增加到 $5\\times 5\\times 5$ 导致三个应变下的总能量变化小于 $1\\,\\mathrm{meV}$/原子，就接受该模量。当增加截断能 $20\\%$ 导致总能量变化小于 $1\\,\\mathrm{meV}$/原子时，保持平面波截断能不变。\n\nD. 使用应力对应变的拟合，在应变 $\\varepsilon = \\{-0.001, 0, +0.001\\}$ 处采用中心有限差分法。通过增加平面波截断能，直到 $0$ 和 $0.1\\%$ 应变之间的总能量差收敛到 $0.5\\,\\mathrm{meV}$/原子以内，并使用倒易空间间距为 $\\Delta k \\le 0.05\\,\\mathrm{\\AA}^{-1}$ 的 $k$点网格，将应力收敛到 $100\\,\\mathrm{MPa}$ 以内。当满足这些标准时，接受该模量。\n\n哪个选项为此金属体系提供了一个在定量上充分且在科学上稳健的方案，以满足弹性常数 $2\\,\\mathrm{GPa}$ 的误差目标？\n\nA. 策略 A\n\nB. 策略 B\n\nC. 策略 C\n\nD. 策略 D", "solution": "该问题要求评估四种不同的计算策略，这些策略用于通过平面波密度泛函理论 (DFT) 确定单原子面心立方 (FCC) 金属的弹性常数。目标是使体弹性模量和剪切模量的绝对误差低于 $2\\,\\mathrm{GPa}$。每种策略的有效性必须根据固态物理学的既定原理以及电子结构计算中的数值分析来判断。\n\n首先，让我们建立基本关系和数值要求。二阶弹性常数 $C_{ijkl}$ 可以通过总能量 $E$ 对 Lagrangian 应变张量 $\\eta$ 的二阶导数计算，也可以通过第二 Piola-Kirchhoff 应力张量 $S$ 对该应变的一阶导数计算：\n$$\nC_{ijkl} = \\frac{1}{V_0} \\frac{\\partial^2 E}{\\partial \\eta_{ij} \\partial \\eta_{kl}} \\bigg|_{\\eta=0} \\quad \\text{or} \\quad C_{ijkl} = \\frac{\\partial S_{ij}}{\\partial \\eta_{kl}} \\bigg|_{\\eta=0}\n$$\n其中 $V_0$ 是每个原子的平衡体积。对于小应变，不同应变和应力度量之间的区别可以忽略不计，因此我们可以使用工程应变 $\\varepsilon$ 和 Cauchy 应力 $\\sigma$。\n\n我们必须估算计算出的可观测量（能量或应力）所需的数值精度，以满足 $\\Delta C < 2\\,\\mathrm{GPa}$ 的目标精度。我们将分析一种中心有限差分方案。\n\n对于使用应变 $\\pm\\varepsilon$ 的基于能量的方法：\n$C \\approx \\frac{1}{V_0} \\frac{E(+\\varepsilon) - 2E(0) + E(-\\varepsilon)}{\\varepsilon^2}$。\n分子中能量组合所需的精度为 $\\Delta(E_{\\text{num}}) \\approx V_0 \\cdot \\Delta C \\cdot \\varepsilon^2$。给定 $V_0 = 16\\,\\mathrm{\\AA}^3 = 1.6 \\times 10^{-29}\\,\\mathrm{m}^3$ 和 $\\Delta C = 2\\,\\mathrm{GPa} = 2 \\times 10^9\\,\\mathrm{N}/\\mathrm{m}^2$：\n如果 $\\varepsilon = 0.005$，那么 $\\Delta(E_{\\text{num}}) \\approx (1.6 \\times 10^{-29}) \\cdot (2 \\times 10^9) \\cdot (0.005)^2 = 8 \\times 10^{-22}\\,\\mathrm{J}$。\n转换为每个原子的电子伏特：$(8 \\times 10^{-22}\\,\\mathrm{J}) / (1.602 \\times 10^{-19}\\,\\mathrm{J/eV}) \\approx 0.005\\,\\mathrm{eV}/\\text{atom} = 5 \\times 10^{-3}\\,\\mathrm{meV}/\\text{atom}$。这对于能量差来说是一个极其苛刻的精度要求。如果三次能量计算中的误差不相关，那么单次能量计算的精度必须更高。\n\n对于使用应变 $\\pm\\varepsilon$ 的基于应力的方法：\n$C \\approx \\frac{\\sigma(+\\varepsilon) - \\sigma(-\\varepsilon)}{2\\varepsilon}$。\n应力差所需的精度为 $\\Delta(\\sigma_{\\text{num}}) \\approx 2\\varepsilon \\cdot \\Delta C$。\n如果 $\\varepsilon = 0.005$，那么 $\\Delta(\\sigma_{\\text{num}}) \\approx 2 \\cdot (0.005) \\cdot (2\\,\\mathrm{GPa}) = 0.02\\,\\mathrm{GPa} = 20\\,\\mathrm{MPa}$。\n如果两次应力计算中的误差不相关，则每个应力张量分量所需的精度约为 $20\\,\\mathrm{MPa} / \\sqrt{2} \\approx 14\\,\\mathrm{MPa}$。这在标准 DFT 代码中是一个严格但可以实现的目标。\n\n现在我们评估每种提出的策略。\n\n**策略 A 的分析**\n该策略在 $\\varepsilon = \\pm 0.005$ 处使用总能量对应变的拟合。\n- **收敛性：** 指定的能量收敛容差为 $0.1\\,\\mathrm{meV}$/原子。如上所述，有限差分分子所需的精度约为 $0.005\\,\\mathrm{meV}$/原子。每次能量计算 $0.1\\,\\mathrm{meV}$/原子的容差至少相差了 20 倍，是不够的。\n- **$k$点网格：** 它提议对所有应变使用固定的 $12\\times 12\\times 12$ Monkhorst-Pack 网格。当实空间晶格发生应变时，倒易晶格矢量也会相应变形。一个固定的指数网格 $(n_1, n_2, n_3)$ 将在每个应变下对布里渊区中物理上不同的位置进行采样。对于具有尖锐费米面的金属，这种采样变化会引入系统误差，通常称为费米面误差的“呼吸效应”，这种误差在能量差中不会抵消。这对于高精度计算来说是一个重大缺陷。\n- **电子展宽：** $0.2\\,\\mathrm{eV}$ 的展宽相当大（对应于一个虚拟温度 $k_B T \\approx 0.2\\,\\mathrm{eV}$，或 $T \\approx 2300\\,\\mathrm{K}$），并可能影响最终结果。虽然它有助于收敛，但为了获得高精度，结果应外推到零展宽，或者应使用更小的展宽值。\n- **对A的结论：** 能量收敛标准过于宽松，无法达到目标精度，并且对于应变下的金属体系使用固定的 $k$点网格在高精度研究中是错误的。策略 A 是**错误的**。\n\n**策略 B 的分析**\n该策略在 $\\varepsilon = \\pm 0.005$ 处使用应力对应变的拟合。\n- **方法：** 应力-应变方法通常比能量-应变方法对数值噪声更具鲁棒性。选择的应变大小是合适的。\n- **收敛性：** 应力收敛标准为 $< 10\\,\\mathrm{MPa}$。我们的估算表明每次计算需要约 $14\\,\\mathrm{MPa}$ 的精度，因此 $10\\,\\mathrm{MPa}$ 的容差是合适的，足以满足弹性常数 $2\\,\\mathrm{GPa}$ 的目标。收敛性测试（将 $k$点密度加倍，增加截断能）是标准且稳健的。\n- **Pulay 应力：** 该策略明确处理了 Pulay 应力，这是一种直接影响计算出的应力张量的有限基组误差。通过收敛平面波截断能，要求零应变下的残余应力低于 $5\\,\\mathrm{MPa}$，这是极好的做法，对于精确的应力-应变计算至关重要。\n- **$k$点网格：** 它要求在所有应变晶胞中保持恒定的 $k$点间距（$\\Delta k \\le 0.02\\,\\mathrm{\\AA}^{-1}$）。这是避免因布里渊区采样不一致而产生误差的正确程序。网格会针对每个应变晶胞进行调整，以确保采样密度保持不变，这对于金属至关重要。指定的密度非常高，表明这是一个高质量的计算。\n- **简谐性检查：** 提议通过检查拟合模量在一系列应变范围内的稳定性来验证简谐性，这是一个至关重要的自洽性检查。它确保所选的应变 $\\varepsilon = \\pm 0.005$ 恰好处在线性弹性区域，并且未受非谐（高阶）效应的污染。\n- **对B的结论：** 该策略在科学上和数值上都是合理的。它采用了更稳定的方法，使用了适当且定量上充分的收敛标准，正确处理了所有主要的数值误差来源（Pulay 应力，布里渊区采样），并包含一个验证步骤。该方案是充分的。策略 B 是**正确的**。\n\n**策略 C 的分析**\n该策略在 $\\varepsilon = \\pm 0.02$ 处使用总能量对应变的拟合。\n- **应变大小：** $\\varepsilon = \\pm 2\\%$ 的应变非常大。对于大多数金属，该大小远超出了定义二阶弹性常数的简谐区域。将抛物线拟合到 $0$ 和 $\\pm 2\\%$ 应变处的能量点，将得到一个有效的割线模量，而不是零应变下的真实二阶切线模量。这是一个根本性的缺陷。\n- **$k$点网格：** 它提议在 $4\\times 4\\times 4$ 超胞中使用 $\\Gamma$点计算。这等同于在粗糙的 $4\\times 4\\times 4$ Monkhorst-Pack 网格上对原胞的布里渊区进行采样。对于金属而言，如此稀疏的采样对于收敛总能量是完全不够的，更不用说计算弹性常数所需的微小能量差了。使用 $1\\,\\mathrm{meV}$/原子的容差进行的收敛测试（将超胞增加到 $5\\times 5\\times 5$）也过于宽松。\n- **收敛性：** $1\\,\\mathrm{meV}$/原子的能量收敛容差甚至比策略 A 还要宽松，并且完全不够。在应变为 $\\varepsilon = 0.02$ 的情况下，所需的能量精度为 $\\Delta(E_{\\text{num}}) \\approx 0.08\\,\\mathrm{meV}$/原子，这使得 $1\\,\\mathrm{meV}$ 的容差相差了一个数量级以上。\n- **对C的结论：** 该策略在多个基本点上存在缺陷：应变过大，对金属而言 $k$点采样不充分，能量收敛性不足。策略 C 是**错误的**。\n\n**策略 D 的分析**\n该策略在 $\\varepsilon = \\pm 0.001$ 处使用应力对应变的拟合。\n- **应变大小：** $\\varepsilon = \\pm 0.1\\%$ 的应变非常小。虽然它保证了处于简谐区域，但它使计算对数值噪声极为敏感。为了在 $C$ 上达到 $2\\,\\mathrm{GPa}$ 的精度，对应力差 $\\sigma(+\\varepsilon)-\\sigma(-\\varepsilon)$ 所需的精度为 $2\\varepsilon \\cdot \\Delta C = 2(0.001)(2\\,\\mathrm{GPa}) = 4\\,\\mathrm{MPa}$。这要求每次应力计算收敛到约 $4/\\sqrt{2} \\approx 2.8\\,\\mathrm{MPa}$。\n- **收敛性：** 指定的应力收敛容差为 $100\\,\\mathrm{MPa}$。与所需的约 $3\\,\\mathrm{MPa}$ 相比，这是灾难性的不足。应力中 $100\\,\\mathrm{MPa}$ 的误差将转化为弹性常数中约 $\\Delta C \\approx \\Delta\\sigma / (2\\varepsilon) = (100\\,\\mathrm{MPa} \\cdot \\sqrt{2}) / (2 \\cdot 0.001) \\approx 70,000\\,\\mathrm{MPa} = 70\\,\\mathrm{GPa}$ 的误差。提议的收敛性是完全不够的。涉及能量差的复杂标准也定义不清，并且与声明的应力容差不一致。\n- **$k$点网格：** 倒易空间间距 $\\Delta k \\le 0.05\\,\\mathrm{\\AA}^{-1}$ 比策略 B 中的要粗糙得多，对于使用如此小的应变所需的高精度来说可能是不够的。\n- **对D的结论：** 极小的应变与极宽松的应力收敛标准的组合，使得该策略无法达到目标精度。主要误差将来自不良的应力收敛。策略 D 是**错误的**。\n\n总之，只有策略 B 概述了一个完整、科学严谨且定量上充分的方案，以实现弹性常数的期望精度。", "answer": "$$\\boxed{B}$$", "id": "2765156"}, {"introduction": "最后一个实践将您的理解应用于一个前沿的材料科学问题：纳米晶体材料的尺寸依赖性弹性。您将通过建立一个模型来连接原子尺度的概念与连续介质力学，该模型解释了作为独特原子环境的晶界如何影响整体力学响应。这个练习涉及推导模型、分析合成数据并进行定量拟合，模拟了理解复杂材料行为的常见研究流程。[@problem_id:2765142]", "problem": "纳米晶金属可被建模为由晶粒内部和晶界区域组成的两相复合材料。在小应变下，假设材料呈线性弹性，并处于单轴加载状态，因此胡克定律适用。在适用于载荷跨越多个晶粒传递的多晶体的等应力假设下，总单轴应变是局部应变的体积平均值。考虑将等轴晶粒近似为直径为 $d$ 的球体，其外层有一个厚度为 $t$ 的晶界壳层，使得晶界体积分数为 $f_{gb}(d)$。有效单轴柔度为 $S_{eff}(d) \\equiv 1/E_{eff}(d)$，晶粒内部（体）柔度为 $S_{bulk} \\equiv 1/E_{bulk}$，晶界柔度为 $S_{gb} \\equiv 1/E_{gb}$。原子尺度的“直接”双晶晶界计算给出了一个代表性晶界的 $E_{gb}$，该值将与从纳米晶体的尺寸依赖性有效模量中推断出的值进行比较。\n\n仅从胡克定律、等应力混合定义（均匀应力下的体积平均应变）以及直径为 $d$、壳层厚度为 $t$ 的球体的晶界壳层体积分数的几何表达式出发，推导在 $t/d \\ll 1$ 的极限下，$S_{eff}(d)$ 对 $1/d$ 的一阶依赖关系。使用此一阶依赖关系，从 $E_{eff}(d)$ 的模拟数据集中拟合晶界柔度 $S_{gb}$。\n\n几何基础：对于直径为 $d$、带有厚度为 $t$ 的同心壳层的球形晶粒，精确的晶界体积分数由下式给出\n$$\nf_{gb}(d) \\;=\\; 1 - \\left(1 - \\frac{2t}{d}\\right)^3.\n$$\n\n数据生成协议（用于确定性地模拟原子模拟输出）：对于每个测试用例，令 $S_{bulk} = 1/E_{bulk}$ 和 $S_{gb}^{direct} = 1/E_{gb}^{direct}$。对于每个列出的直径 $d_i$，根据上述几何公式计算精确的 $f_{gb}(d_i)$。然后计算“真实”有效柔度\n$$\nS_{eff}^{true}(d_i) \\;=\\; (1 - f_{gb}(d_i))\\, S_{bulk} + f_{gb}(d_i)\\, S_{gb}^{direct},\n$$\n并通过添加一个小的、固定的微扰 $\\varepsilon_i$（单位为 $1/\\mathrm{GPa}$，见下文）来模拟有限采样噪声，从而构成“测量”有效柔度：\n$$\nS_{eff}^{meas}(d_i) \\;=\\; S_{eff}^{true}(d_i) + \\varepsilon_i.\n$$\n最后，通过下式定义“测量”有效模量：\n$$\nE_{eff}^{meas}(d_i) \\;=\\; \\frac{1}{S_{eff}^{meas}(d_i)}.\n$$\n\n拟合要求：假设 $t/d \\ll 1$，仅使用从上述基础推导出的 $S_{eff}(d)$ 对 $1/d$ 的一阶依赖关系来建立一个关于 $1/d$ 的线性模型。将数据 $\\{(d_i, E_{eff}^{meas}(d_i))\\}$ 转换为柔度 $S_{eff}^{meas}(d_i) = 1/E_{eff}^{meas}(d_i)$ 后，使用普通最小二乘法对该线性模型进行拟合。从拟合的斜率和已知的厚度 $t$ 中，提取估计值 $\\widehat{S}_{gb}$，并计算其与直接双晶计算值之间的绝对差值 $\\Delta = |\\widehat{S}_{gb} - S_{gb}^{direct}|$。\n\n单位：所有模量 $E$ 必须以吉帕斯卡（GPa）为单位，厚度和晶粒尺寸以纳米（nm）为单位，柔度 $S$ 以 $1/\\mathrm{GPa}$ 为单位。所有最终报告的差值 $\\Delta$ 必须以 $1/\\mathrm{GPa}$ 为单位。\n\n不使用角度。不要使用百分比；任何比例都应表示为小数。\n\n测试套件：使用以下三个案例。在所有案例中，取 $t = 0.1666666667 \\,\\mathrm{nm}$。\n\n- 案例1：\n    - $E_{bulk} = 200\\,\\mathrm{GPa}$, $E_{gb}^{direct} = 120\\,\\mathrm{GPa}$\n    - 直径 (nm): $[5.0,\\;7.5,\\;10.0,\\;15.0,\\;25.0,\\;50.0,\\;100.0]$\n    - 柔度微扰 $\\varepsilon_i$ ($1/\\mathrm{GPa}$): $[-1.0\\times 10^{-5},\\;2.0\\times 10^{-5},\\;0.0,\\;-2.0\\times 10^{-5},\\;1.0\\times 10^{-5},\\;0.0,\\;1.0\\times 10^{-5}]$\n\n- 案例2：\n    - $E_{bulk} = 200\\,\\mathrm{GPa}$, $E_{gb}^{direct} = 190\\,\\mathrm{GPa}$\n    - 直径 (nm): $[5.0,\\;6.0,\\;8.0,\\;12.0,\\;20.0,\\;40.0,\\;80.0]$\n    - 柔度微扰 $\\varepsilon_i$ ($1/\\mathrm{GPa}$): $[2.0\\times 10^{-6},\\;-3.0\\times 10^{-6},\\;0.0,\\;4.0\\times 10^{-6},\\;-2.0\\times 10^{-6},\\;0.0,\\;1.0\\times 10^{-6}]$\n\n- 案例3：\n    - $E_{bulk} = 70\\,\\mathrm{GPa}$, $E_{gb}^{direct} = 35\\,\\mathrm{GPa}$\n    - 直径 (nm): $[5.0,\\;7.0,\\;9.0,\\;12.0,\\;16.0,\\;30.0,\\;60.0]$\n    - 柔度微扰 $\\varepsilon_i$ ($1/\\mathrm{GPa}$): $[0.0,\\;5.0\\times 10^{-5},\\;-5.0\\times 10^{-5},\\;0.0,\\;2.0\\times 10^{-5},\\;-2.0\\times 10^{-5},\\;0.0]$\n\n任务：实现一个程序，对每个案例执行上述流程，拟合关于 $1/d$ 的一阶线性模型，并为每个案例返回拟合值 $\\widehat{S}_{gb}$ 与直接计算值 $S_{gb}^{direct}$ 之间的绝对差值 $\\Delta$（单位为 $1/\\mathrm{GPa}$），结果四舍五入到十位小数。\n\n最终输出格式：您的程序应生成单行输出，其中包含三个结果，形式为方括号内由逗号分隔的列表（例如，“[x1,x2,x3]”），其中每个 $x_k$ 是上述四舍五入后的浮点数。", "solution": "该问题被评估为有效。它在科学上基于连续介质力学和材料科学的原理，特别是应用于纳米晶体的复合材料弹性理论。该问题是适定的，所有必要的数据、假设和步骤都已明确定义，从而导出一个唯一且有意义的解。其陈述客观，没有任何科学缺陷、歧义或矛盾。\n\n求解过程分两个阶段：首先，推导理论模型；其次，应用该模型拟合所提供的数据并提取所需参数。\n\n**1. 线性模型的理论推导**\n\n该问题基于两相复合材料的等应力（或 Reuss）模型。在均匀单轴应力 $\\sigma$ 下，总应变 $\\varepsilon_{eff}$ 是晶粒内部（体相，下标为 $b$）和晶界（下标为 $gb$）中应变的体积分数加权平均。\n\n根据一维胡克定律，应变 $\\varepsilon$ 通过柔度 $S$ 与应力 $\\sigma$ 相关，即 $\\varepsilon = S\\sigma$。因此，两相中的应变为：\n$$\n\\varepsilon_b = S_{bulk} \\sigma\n$$\n$$\n\\varepsilon_{gb} = S_{gb} \\sigma\n$$\n晶粒内部的体积分数为 $f_b = 1 - f_{gb}(d)$，有效应变为：\n$$\n\\varepsilon_{eff} = (1 - f_{gb}(d))\\varepsilon_b + f_{gb}(d)\\varepsilon_{gb}\n$$\n代入相应变的表达式：\n$$\n\\varepsilon_{eff} = [(1 - f_{gb}(d))S_{bulk} + f_{gb}(d)S_{gb}] \\sigma\n$$\n有效柔度 $S_{eff}(d)$ 由 $\\varepsilon_{eff} = S_{eff}(d)\\sigma$ 定义。因此，我们得到柔度的混合法则：\n$$\nS_{eff}(d) = (1 - f_{gb}(d))S_{bulk} + f_{gb}(d)S_{gb}\n$$\n可以重新整理该式以突出晶界的贡献：\n$$\nS_{eff}(d) = S_{bulk} + f_{gb}(d)(S_{gb} - S_{bulk})\n$$\n问题给出了围绕一个直径为 $d$ 的球体的厚度为 $t$ 的球壳的体积分数几何表达式：\n$$\nf_{gb}(d) = 1 - \\left(1 - \\frac{2t}{d}\\right)^3\n$$\n我们需要在 $t/d \\ll 1$ 的极限下找到对 $1/d$ 的一阶依赖关系。令 $x = 2t/d$。我们对小 $x$ 的 $f_{gb} = 1 - (1-x)^3$ 进行泰勒展开：\n$$\n(1-x)^3 = 1 - 3x + 3x^2 - x^3 + \\dots\n$$\n将此代入 $f_{gb}$ 的表达式中：\n$$\nf_{gb}(d) = 1 - \\left(1 - 3\\left(\\frac{2t}{d}\\right) + 3\\left(\\frac{2t}{d}\\right)^2 - \\left(\\frac{2t}{d}\\right)^3\\right) = \\frac{6t}{d} - \\frac{12t^2}{d^2} + \\frac{8t^3}{d^3}\n$$\n在关于 $1/d$ 幂次的展开式中，一阶项是分母中 $d$ 的幂次最低的项。即与 $1/d$ 成正比的项。\n$$\nf_{gb}(d) \\approx \\frac{6t}{d}\n$$\n将此一阶近似代入 $S_{eff}(d)$ 的方程中：\n$$\nS_{eff}(d) \\approx S_{bulk} + \\frac{6t}{d}(S_{gb} - S_{bulk})\n$$\n该方程表示 $S_{eff}(d)$ 与逆晶粒尺寸 $1/d$ 之间的线性关系。可以写成标准线性形式 $y = A + Bx$：\n$$\nS_{eff}(d) \\approx S_{bulk} + [6t(S_{gb} - S_{bulk})] \\cdot \\frac{1}{d}\n$$\n在此，因变量是 $y = S_{eff}(d)$，自变量是 $x = 1/d$，截距是 $A = S_{bulk}$，斜率是 $B = 6t(S_{gb} - S_{bulk})$。\n\n**2. 参数提取流程**\n\n任务是使用普通最小二乘法 (OLS) 将该线性模型拟合到“测量”数据 $(x_i, y_i) = (1/d_i, S_{eff}^{meas}(d_i))$。OLS 过程得出斜率的估计值 $\\widehat{B}$ 和截距的估计值 $\\widehat{A}$。\n\n根据推导出的模型，斜率与晶界柔度 $S_{gb}$ 相关。我们需要从拟合的斜率 $\\widehat{B}$ 中提取 $S_{gb}$ 的估计值，记为 $\\widehat{S}_{gb}$。\n$$\n\\widehat{B} = 6t(\\widehat{S}_{gb} - S_{bulk})\n$$\n晶界厚度 $t$ 和体柔度 $S_{bulk}$（由给定的 $E_{bulk}$ 得出）是已知常数。我们可以重新整理方程以求解 $\\widehat{S}_{gb}$：\n$$\n\\frac{\\widehat{B}}{6t} = \\widehat{S}_{gb} - S_{bulk}\n$$\n$$\n\\widehat{S}_{gb} = S_{bulk} + \\frac{\\widehat{B}}{6t}\n$$\n最后，我们必须计算该拟合值与每个测试用例中提供的“直接”值 $S_{gb}^{direct}$ 之间的绝对差值 $\\Delta$。\n$$\n\\Delta = |\\widehat{S}_{gb} - S_{gb}^{direct}|\n$$\n\n**3. 计算算法**\n\n对每个测试用例，执行以下步骤：\n1.  初始化案例的给定常数：$E_{bulk}$、$E_{gb}^{direct}$、直径列表 $d_i$ 以及微扰列表 $\\varepsilon_i$。在所有案例中，厚度为常数：$t = 0.1666666667 \\, \\mathrm{nm}$。\n2.  计算基础柔度：$S_{bulk} = 1/E_{bulk}$ 和 $S_{gb}^{direct} = 1/E_{gb}^{direct}$。\n3.  生成用于回归的数据集。遍历所提供的直径 $d_i$ 和微扰 $\\varepsilon_i$：\n    a. 计算精确的晶界体积分数：$f_{gb}(d_i) = 1 - (1 - 2t/d_i)^3$。\n    b. 计算“真实”有效柔度：$S_{eff}^{true}(d_i) = (1 - f_{gb}(d_i))S_{bulk} + f_{gb}(d_i)S_{gb}^{direct}$。\n    c. 计算“测量”有效柔度：$S_{eff}^{meas}(d_i) = S_{eff}^{true}(d_i) + \\varepsilon_i$。\n    d. 将数据对 $(1/d_i, S_{eff}^{meas}(d_i))$ 存储为线性拟合的一个数据点。\n4.  对生成的 $(x_i, y_i) = (1/d_i, S_{eff}^{meas}(d_i))$ 数据集执行线性回归，以找到最佳拟合斜率 $\\widehat{B}$。这可通过标准的 OLS 数值程序（例如 `numpy.polyfit`）实现。\n5.  使用拟合斜率 $\\widehat{B}$ 计算估计的晶界柔度：$\\widehat{S}_{gb} = S_{bulk} + \\widehat{B} / (6t)$。\n6.  计算测试用例的最终结果，即绝对差值：$\\Delta = |\\widehat{S}_{gb} - S_{gb}^{direct}|$。\n7.  收集所有测试用例计算出的 $\\Delta$ 值，并按指定格式进行格式化。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the nanomechanics problem for three test cases.\n    For each case, it generates simulated data, fits a linear model derived\n    from first principles, extracts the grain boundary compliance, and\n    calculates the error compared to the ground truth value.\n    \"\"\"\n    \n    # Constant grain boundary thickness for all cases (in nm).\n    t = 0.1666666667\n\n    test_cases = [\n        {\n            \"E_bulk\": 200.0,  # GPa\n            \"E_gb_direct\": 120.0,  # GPa\n            \"diameters\": np.array([5.0, 7.5, 10.0, 15.0, 25.0, 50.0, 100.0]), # nm\n            \"epsilons\": np.array([-1.0e-5, 2.0e-5, 0.0, -2.0e-5, 1.0e-5, 0.0, 1.0e-5]) # 1/GPa\n        },\n        {\n            \"E_bulk\": 200.0,\n            \"E_gb_direct\": 190.0,\n            \"diameters\": np.array([5.0, 6.0, 8.0, 12.0, 20.0, 40.0, 80.0]),\n            \"epsilons\": np.array([2.0e-6, -3.0e-6, 0.0, 4.0e-6, -2.0e-6, 0.0, 1.0e-6])\n        },\n        {\n            \"E_bulk\": 70.0,\n            \"E_gb_direct\": 35.0,\n            \"diameters\": np.array([5.0, 7.0, 9.0, 12.0, 16.0, 30.0, 60.0]),\n            \"epsilons\": np.array([0.0, 5.0e-5, -5.0e-5, 0.0, 2.0e-5, -2.0e-5, 0.0])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract case parameters\n        E_bulk = case[\"E_bulk\"]\n        E_gb_direct = case[\"E_gb_direct\"]\n        diameters = case[\"diameters\"]\n        epsilons = case[\"epsilons\"]\n\n        # Convert moduli (GPa) to compliances (1/GPa)\n        S_bulk = 1.0 / E_bulk\n        S_gb_direct = 1.0 / E_gb_direct\n\n        # --- Data Generation Step ---\n        # Generate the dataset for linear regression.\n        # x_data will be inverse diameters (1/nm)\n        # y_data will be measured effective compliances (1/GPa)\n        \n        # Calculate grain boundary volume fraction f_gb\n        # f_gb = 1 - (1 - 2t/d)^3\n        f_gb_vals = 1.0 - (1.0 - 2.0 * t / diameters)**3\n\n        # Calculate \"true\" effective compliance S_eff_true\n        # S_eff_true = (1 - f_gb) * S_bulk + f_gb * S_gb_direct\n        S_eff_true_vals = (1.0 - f_gb_vals) * S_bulk + f_gb_vals * S_gb_direct\n\n        # Calculate \"measured\" effective compliance S_eff_meas by adding noise\n        S_eff_meas_vals = S_eff_true_vals + epsilons\n        \n        y_data = S_eff_meas_vals\n        x_data = 1.0 / diameters\n        \n        # --- Fitting Step ---\n        # Perform ordinary least squares linear regression to find the slope.\n        # The model is y = slope * x + intercept.\n        # np.polyfit returns [slope, intercept] for degree 1.\n        slope, _ = np.polyfit(x_data, y_data, 1)\n\n        # --- Parameter Extraction Step ---\n        # From the derived model, slope = 6*t*(S_gb - S_bulk).\n        # We solve for the estimated grain boundary compliance, S_gb_hat.\n        S_gb_hat = S_bulk + slope / (6.0 * t)\n\n        # --- Final Calculation Step ---\n        # Calculate the absolute difference between the estimated and direct values.\n        delta = abs(S_gb_hat - S_gb_direct)\n        \n        # Round to ten decimal places as required.\n        results.append(round(delta, 10))\n\n    # Print the final result in the specified format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2765142"}]}