{"hands_on_practices": [{"introduction": "在对具体的晶界结构进行建模之前，理解界面能的基本热力学定义至关重要。本练习将创建界面所需的宏观、可测量的功与界面自由能 $\\gamma$ 这一热力学量联系起来。通过推导 $W_{\\mathrm{rev}} = \\gamma A$ 关系并加以应用，您将巩固对热力学如何为量化表面和界面现象提供基础的理解。[@problem_id:2772526]", "problem": "通过劈裂并重新连接两个晶粒，可逆地制备出一个纯金属双晶，从而形成一个平直晶界。该过程与大型热储层和力学储层接触进行，这些储层使系统保持在恒定温度 $T$ 和静水压力 $p$。唯一的非压力机械功是产生新界面面积所需的功。\n\n从适用于含界面系统的基本热力学定义和定律出发，证明在适当条件下，产生界面面积 $A$ 所需的可逆功等于单位面积的界面自由能 $\\gamma$ 与面积的乘积，即 $W_{\\mathrm{rev}}=\\gamma A$。明确陈述此等式对于晶界或相界成立所必需的热力学假设。\n\n然后，对于一个可逆双晶形成实验，其中测得产生界面面积 $A=2.0\\ \\mathrm{cm}^2$ 所需的功为 $W=0.35\\ \\mathrm{J}$，计算界面自由能 $\\gamma$。将 $\\gamma$ 的最终值以 $\\mathrm{J}\\,\\mathrm{m}^{-2}$ 为单位表示，并将答案四舍五入至两位有效数字。", "solution": "所提出的问题是有效的，因为它在科学上基于热力学和材料科学的原理，问题阐述清晰，并且陈述客观。我们将首先进行严格的推导，然后进行计算。\n\n问题的第一部分要求我们证明，在特定的热力学条件下，产生界面面积 $A$ 所需的可逆功 $W_{\\mathrm{rev}}$ 等于单位面积的界面自由能 $\\gamma$ 与面积 $A$ 的乘积。\n\n我们从包含界面的多组分系统的基本热力学描述开始。此类系统的内能 $U$ 不仅是其熵 $S$、体积 $V$ 和化学组分摩尔数 $\\{n_i\\}$ 的函数，还是界面面积 $A$ 的函数。$U$ 的基本微分形式为：\n$$dU = TdS - pdV + \\sum_i \\mu_i dn_i + \\gamma_{U} dA$$\n其中 $T$ 是温度，$p$ 是压力，$\\mu_i$ 是组分 $i$ 的化学势，而 $\\gamma_{U} = \\left(\\frac{\\partial U}{\\partial A}\\right)_{S,V,n_i}$ 定义为比界面能。\n\n实验指定的条件是恒温 $T$ 和恒压 $p$。在这种情况下，吉布斯自由能 $G$ 是最合适的热力学势。吉布斯自由能通过内能的勒让德变换定义：\n$$G = U - TS + pV$$\n因此，$G$ 的全微分为：\n$$dG = dU - TdS - SdT + pdV + Vdp$$\n将 $dU$ 的表达式代入此方程，得到：\n$$dG = (TdS - pdV + \\sum_i \\mu_i dn_i + \\gamma_{U} dA) - TdS - SdT + pdV + Vdp$$\n简化后，我们得到含界面系统的吉布斯自由能基本方程：\n$$dG = -SdT + Vdp + \\sum_i \\mu_i dn_i + \\gamma dA$$\n注意到 $dA$ 的系数现在表示为 $\\gamma$，即比界面吉布斯自由能，或简称界面自由能。根据此方程，$\\gamma$ 精确定义为在恒温、恒压和恒定组分下，吉布斯自由能对面积的偏导数：\n$$\\gamma = \\left(\\frac{\\partial G}{\\partial A}\\right)_{T,p,n_i}$$\n对于纯金属，只要物质的总量保持不变，组分项 $\\sum_i \\mu_i dn_i$ 就为零。\n\n接下来，我们建立吉布斯自由能变化与可逆功之间的联系。热力学第一定律指出 $dU = \\delta Q + \\delta W$，其中 $\\delta Q$ 是供给系统的热量，$\\delta W$ 是对系统做的功。\n对于一个热力学可逆过程，交换的热量为 $\\delta Q_{\\mathrm{rev}} = TdS$。所做的总功 $\\delta W_{\\mathrm{rev}}$ 包括抵抗外部压力发生体积变化所做的功 $-pdV$，以及任何其他形式的功，我们记为非$pV$功 $\\delta W_{\\mathrm{rev, non-pV}}$。\n$$\\delta W_{\\mathrm{rev}} = -pdV + \\delta W_{\\mathrm{rev, non-pV}}$$\n将这些代入可逆过程的热力学第一定律：\n$$dU = TdS - pdV + \\delta W_{\\mathrm{rev, non-pV}}$$\n现在，考虑一个在恒温 $T$ 和恒压 $p$ 下发生的过程，其吉布斯自由能的变化为 $dG = dU - d(TS) + d(pV)$。在这些约束下，$d(TS) = TdS$ 且 $d(pV) = pdV$。\n因此，$dG|_{T,p} = dU - TdS + pdV$。\n将热力学第一定律中的 $dU$ 表达式代入这个 $dG|_{T,p}$ 的方程：\n$$dG|_{T,p} = (TdS - pdV + \\delta W_{\\mathrm{rev, non-pV}}) - TdS + pdV$$\n这可以简化为一个关键结果：\n$$dG|_{T,p} = \\delta W_{\\mathrm{rev, non-pV}}$$\n这个方程表明，对于任何在恒温恒压下进行的可逆过程，系统吉布斯自由能的变化完全等于对系统所做的非压力-体积功。\n\n问题陈述指明，唯一的非$pV$功是产生新界面面积所需的功。因此，$\\delta W_{\\mathrm{rev, non-pV}}$ 是产生微小面积 $dA$ 所做的功，我们可以将其简写为 $\\delta W_{\\mathrm{rev}}$。\n$$dG|_{T,p,n_i} = \\delta W_{\\mathrm{rev}}$$\n现在我们有两个在恒定 $T$、$p$ 和组分下吉布斯自由能微分变化的表达式：\n1. 根据其定义：$dG|_{T,p,n_i} = \\gamma dA$\n2. 根据功定理：$dG|_{T,p,n_i} = \\delta W_{\\mathrm{rev}}$\n将两者相等，得到微小功与微小面积变化之间的关系：\n$$\\delta W_{\\mathrm{rev}} = \\gamma dA$$\n为了求出从零面积开始，产生有限界面面积 $A$ 所需的总可逆功 $W_{\\mathrm{rev}}$，我们必须对这个表达式进行积分：\n$$W_{\\mathrm{rev}} = \\int_{0}^{A} \\gamma \\, dA'$$\n为了使该积分的计算结果为 $W_{\\mathrm{rev}} = \\gamma A$，我们必须假设 $\\gamma$ 是一个常数，且不依赖于面积 $A'$。\n\n因此，等式 $W_{\\mathrm{rev}} = \\gamma A$ 在以下假设下成立：\n1. 产生界面的过程是**热力学可逆的**。\n2. 该过程在**恒温**和**恒压**下进行。\n3. 除压力-体积功外，对系统所做的唯一功是产生界面的功。\n4. 比界面自由能 $\\gamma$ 相对于所产生的面积是**恒定的**。对于一个宏观的平直界面，这是一个有效的假设，因为在这种情况下，曲率效应和边缘效应可以忽略不计，且界面的平衡结构与其范围无关。\n\n对于问题的第二部分，我们必须根据实验数据计算界面自由能 $\\gamma$。\n测得产生界面面积 $A = 2.0 \\text{ cm}^2$ 所需的功为 $W = 0.35 \\text{ J}$。问题指出该过程是可逆的，因此我们将 $W$ 等同于 $W_{\\mathrm{rev}}$。\n根据推导出的关系，我们有 $\\gamma = \\frac{W_{\\mathrm{rev}}}{A}$。\n首先，我们必须将面积 $A$ 用国际单位制（$\\text{m}^2$）表示，以与功的单位（焦耳）保持一致。\n已知 $1 \\text{ m} = 100 \\text{ cm}$，我们有 $1 \\text{ m}^2 = (100 \\text{ cm})^2 = 10000 \\text{ cm}^2 = 10^4 \\text{ cm}^2$。\n因此，$A = 2.0 \\text{ cm}^2 = 2.0 \\times 10^{-4} \\text{ m}^2$。\n\n现在，我们可以计算 $\\gamma$：\n$$\\gamma = \\frac{0.35 \\text{ J}}{2.0 \\times 10^{-4} \\text{ m}^2} = \\frac{0.35}{2.0} \\times 10^{4} \\text{ J m}^{-2}$$\n$$\\gamma = 0.175 \\times 10^{4} \\text{ J m}^{-2} = 1750 \\text{ J m}^{-2}$$\n问题要求答案四舍五入至两位有效数字，以与输入数据（$0.35$ J 和 $2.0$ cm$^2$）的精度保持一致。\n将 $1750 \\text{ J m}^{-2}$ 四舍五入至两位有效数字得到 $1800 \\text{ J m}^{-2}$，最好用科学记数法表示为 $1.8 \\times 10^3 \\text{ J m}^{-2}$。", "answer": "$$\\boxed{1.8 \\times 10^{3}}$$", "id": "2772526"}, {"introduction": "在建立了热力学定义之后，我们现在可以构建物理模型，将晶界的原子结构与其能量联系起来。用于小角度晶界的 Read-Shockley 模型就是一个经典的例子。这个练习演示了如何将一个倾斜晶界描述为一组刃型位错阵列，以及如何利用线弹性理论计算其能量。通过这个实践，您将培养应用位错理论来估算一个关键材料性能——晶界能——的能力，并了解它如何依赖于取向差角 $\\theta$。[@problem_id:2772513]", "problem": "一个面心立方（fcc）金属中的对称小角度倾斜晶界可以被建模为一个容纳了取向差的平行刃型位错的周期性阵列。考虑一个面心立方金属，其剪切模量 $\\mu=40\\ \\mathrm{GPa}$，泊松比 $\\nu=0.34$，柏氏矢量大小 $b=0.255\\ \\mathrm{nm}$，以及取向差角 $\\theta=3^\\circ$。利用适用于刃型位错的各向同性线弹性理论和适用于小角度倾斜晶界的 Frank–Bilby 框架，通过将晶界视为一个由相同刃型位错构成的单一阵列来估算单位面积的晶界能 $\\gamma$。采用位错核心截止半径 $r_{0}=b$，并将每个位错的弹性外截止半径取为阵列内的位错间距。忽略弹性各向异性和任何非对数项的贡献。\n\n从单个位错的标准弹性理论以及小角度下位错密度与取向差之间的几何关系出发，推导你所使用的表达式。对给定参数，使用以弧度为单位的 $\\theta$ 进行 $\\gamma$ 的数值计算。你的最终答案需要以 $\\mathrm{J}\\,\\mathrm{m}^{-2}$ 为单位表示，并将结果四舍五入到三位有效数字。最终答案必须是一个数字。", "solution": "该问题陈述已经过验证，被认定是有效的。这是一个结构完善的问题，其基础是位错理论和线弹性理论在晶体材料晶界应用中的既定原理。该问题提供了一套完整的物理参数和建模假设，足以推导出一个唯一的、有意义的解。所有数据在科学上都是一致的，并且是所描述材料和现象的典型值。因此，我们可以着手求解。\n\n该问题要求估算对称小角度倾斜晶界的单位面积晶界能 $\\gamma$。根据 Frank–Bilby 框架以及随后由 Read 和 Shockley 发展的模型，这样一个晶界可以表示为一个平行的刃型位错周期性阵列。晶界的能量就是这些位错的总弹性应变能，在晶界面积上进行平均。\n\n首先，我们建立取向差角 $\\theta$ 与阵列中位错间距 $D$ 之间的几何关系。考虑两个晶格绕一个位于晶界平面内的轴发生小角度 $\\theta$ 的取向差。这种倾斜由一堵垂直的刃型位错墙来容纳，所有位错都具有相同的柏氏矢量 $\\mathbf{b}$，其大小为 $b$。从晶界的几何结构可知，相邻位错之间的垂直距离 $D$ 与柏氏矢量的大小 $b$ 和取向差角 $\\theta$ 的关系由以下方程给出：\n$$b = 2D \\sin\\left(\\frac{\\theta}{2}\\right)$$\n对于小角度晶界，$\\theta$ 很小，所以我们可以使用小角度近似 $\\sin(\\theta/2) \\approx \\theta/2$。该关系简化为：\n$$b \\approx 2D \\left(\\frac{\\theta}{2}\\right) = D\\theta$$\n因此，位错之间的间距与取向差角成反比：\n$$D = \\frac{b}{\\theta}$$\n重要的是要注意，为了使此近似准确，$\\theta$ 必须以弧度表示。\n\n接下来，我们考虑单个刃型位错的弹性应变能。在各向同性线弹性理论的框架内，单位长度刃型位错在其弹性场中储存的应变能 $W_L$ 由下式给出：\n$$W_L = \\frac{\\mu b^{2}}{4\\pi(1-\\nu)} \\ln\\left(\\frac{R}{r_{0}}\\right)$$\n此处，$\\mu$ 是剪切模量，$\\nu$ 是泊松比，$b$ 是柏氏矢量的大小，$r_{0}$ 是位错核心截止半径（定义弹性场的内限），$R$ 是外截止半径（定义应变场的范围）。问题指明我们忽略任何非对数项的贡献，这通常指的是储存在高度畸变的核心区域内的能量，因此这个弹性能力表达式是足够的。\n\n单位面积的晶界能 $\\gamma$ 是晶界平面单位面积上的总位错能量。由于位错以间距 $D$ 排列成周期性阵列，沿晶界单位长度（在垂直于位错线的方向上）的位错线数量为 $1/D$。因此，单位面积的能量是单个位错单位长度的能量除以位错间的间距：\n$$\\gamma = \\frac{W_L}{D} = \\frac{1}{D} \\left( \\frac{\\mu b^{2}}{4\\pi(1-\\nu)} \\ln\\left(\\frac{R}{r_{0}}\\right) \\right)$$\n\n问题为截止半径提供了具体说明。内核心截止半径取为柏氏矢量的大小，$r_{0} = b$。给定一个位错的应变场的外截止半径 $R$ 取为到下一个位错的间距，$R = D$。这是一个有物理动机的选择，因为阵列中位错的长程应力场在大于其间距的距离处趋于相互抵消。\n\n将这些条件 $r_{0}=b$ 和 $R=D$ 代入 $\\gamma$ 的表达式中：\n$$\\gamma = \\frac{1}{D} \\frac{\\mu b^{2}}{4\\pi(1-\\nu)} \\ln\\left(\\frac{D}{b}\\right)$$\n现在，我们将几何关系 $D = b/\\theta$ 代入此方程：\n$$\\gamma = \\frac{\\theta}{b} \\frac{\\mu b^{2}}{4\\pi(1-\\nu)} \\ln\\left(\\frac{b/\\theta}{b}\\right)$$\n简化表达式：\n$$\\gamma = \\frac{\\mu b \\theta}{4\\pi(1-\\nu)} \\ln\\left(\\frac{1}{\\theta}\\right)$$\n这便是在特定假设下著名的小角度倾斜晶界能量的 Read-Shockley 方程。它也可以写成 $\\gamma = -\\frac{\\mu b \\theta}{4\\pi(1-\\nu)} \\ln(\\theta)$。\n\n我们现在进行数值计算。给定的参数是：\n剪切模量，$\\mu = 40 \\ \\mathrm{GPa} = 40 \\times 10^{9} \\ \\mathrm{J}\\,\\mathrm{m}^{-3}$。\n泊松比，$\\nu = 0.34$。\n柏氏矢量大小，$b = 0.255 \\ \\mathrm{nm} = 0.255 \\times 10^{-9} \\ \\mathrm{m}$。\n取向差角，$\\theta = 3^\\circ$。\n\n首先，我们必须按照小角度近似的要求，将角度 $\\theta$ 从度数转换为弧度：\n$$\\theta = 3^\\circ \\times \\frac{\\pi}{180^\\circ} = \\frac{\\pi}{60} \\ \\mathrm{rad}$$\n数值上，$\\theta \\approx 0.0523598776 \\ \\mathrm{rad}$。\n\n现在，我们将所有数值代入推导出的 $\\gamma$ 方程中：\n$$\\gamma = \\frac{(40 \\times 10^{9} \\ \\mathrm{J}\\,\\mathrm{m}^{-3}) \\times (0.255 \\times 10^{-9} \\ \\mathrm{m}) \\times (\\frac{\\pi}{60})}{4\\pi(1-0.34)} \\ln\\left(\\frac{1}{\\pi/60}\\right)$$\n$$\\gamma = \\frac{40 \\times 0.255 \\times (\\pi/60)}{4\\pi(0.66)} \\ln\\left(\\frac{60}{\\pi}\\right) \\ \\mathrm{J}\\,\\mathrm{m}^{-2}$$\n在计算前，我们先简化表达式：\n$$\\gamma = \\frac{10.2 \\times (\\pi/60)}{4\\pi(0.66)} \\ln\\left(\\frac{60}{\\pi}\\right) = \\frac{10.2}{60 \\times 4 \\times 0.66} \\ln\\left(\\frac{60}{\\pi}\\right)$$\n$$\\gamma = \\frac{10.2}{158.4} \\ln\\left(\\frac{60}{\\pi}\\right)$$\n现在我们计算数值：\n$$\\frac{10.2}{158.4} \\approx 0.064393939$$\n$$\\ln\\left(\\frac{60}{\\pi}\\right) \\approx \\ln(19.09859) \\approx 2.949559$$\n将这些值相乘：\n$$\\gamma \\approx 0.064393939 \\times 2.949559 \\approx 0.189930 \\ \\mathrm{J}\\,\\mathrm{m}^{-2}$$\n问题要求结果四舍五入到三位有效数字。\n$$\\gamma \\approx 0.190 \\ \\mathrm{J}\\,\\mathrm{m}^{-2}$$\n对于小角度晶界的能量来说，这个值在物理上是合理的。", "answer": "$$\\boxed{0.190}$$", "id": "2772513"}, {"introduction": "尽管像 Read-Shockley 这样的解析模型非常强大，但现代材料科学越来越依赖计算方法来分析在原子模拟中观察到的复杂的、任意的晶界结构。这项高级实践介绍了“结构单元”作为界面构筑基块的概念，并使用一种计算方法——动态规划——来寻找这些单元的最低能量排列方式。通过实施这一方案，您将获得分析界面能量学的最前沿方法的实践经验，从而在模拟数据和理论模型之间架起一座桥梁。[@problem_id:2772530]", "problem": "您的任务是在纳米力学与表面和界面科学领域，形式化、实现并测试一个原子级别的协议。该协议能够 (i) 直接从模拟快照中识别一维晶界或相界上的结构单元，并 (ii) 计算不同结构单元序列的相对稳定性。该协议必须基于在原子尺度上被广泛接受的标准定义和假设。\n\n使用以下基础来设计您的方法：\n- 单位长度的晶界或相界过剩能被定义为局域在边界上的总能量相对于一个参考态的超额部分，再除以一个明确定义的边界长度。构建此超额部分的方式使得体相的贡献相互抵消，只留下一个局域于边界的度量。\n- 对于局域原子环境与类体相有序结构的微小偏离，使用总能量相对于局域几何描述符的二阶泰勒展开是合适的。对于一个由连续原子链构成的一维边界，您可以将局域键角畸变视作主要自由度，并将过剩能近似为各个独立位点贡献之和，外加相邻结构单元标识发生变化时的短程惩罚项。角度必须以弧度为单位。\n\n对于每个提供的快照，您的程序必须执行以下操作：\n1. 将输入解释为单个边界上的一组二维原子坐标。通过按 $x$ 坐标排序（若 $x$ 坐标相同则按 $y$ 坐标排序）将原子排列成一个链。\n2. 计算边界长度 $L$，即按顺序连接链中原子的折线的弧长。\n3. 对于每个内部原子 $i$（不包括两个端点），计算其与链中最近邻原子之间的向量所形成的局域键角 $\\theta_i$。所有角度必须以弧度为单位。\n4. 通过它们的目标角度定义三种标准结构单元类型：\n   - $S$ 型，目标角度为 $\\theta_S = \\pi$，\n   - $K$ 型，目标角度为 $\\theta_K = 5\\pi/6$，\n   - $T$ 型，目标角度为 $\\theta_T = 2\\pi/3$。\n5. 采用以下建模假设和常数：\n   - 内部原子的局域过剩能贡献由观测角度偏离该类型目标角度的二阶展开给出。使用单一的角刚度 $k_\\theta$，其值为 $k_\\theta = 5.0$ 电子伏特每弧度平方 (eV/rad$^2$)。\n   - 每当两个连续的内部原子被赋予不同的结构单元类型时，会有一个以电子伏特 (eV) 为单位的失配惩罚项 $\\lambda$。使用 $\\lambda = 0.2$。\n   - 在本问题中忽略径向畸变，并将端点视为具有零局域贡献。\n6. 通过为每个内部原子分配其目标角度与测量角度 $\\theta_i$ 最接近（即最小化局域二次惩罚项）的类型，来构建观测到的结构单元序列。设 $E_{\\text{obs}}$ 为总过剩能，它等于此观测序列中局域贡献之和，加上连续内部原子之间类型变化的失配惩罚之和。\n7. 计算相同长度的全局最优结构单元序列（每个内部原子对应一个类型），在最近邻失配惩罚下最小化相同的总过剩能模型。设相应的最小能量为 $E_{\\text{opt}}$。\n8. 定义一个序列的单位长度过剩能为 $\\gamma = E/L$。对于每个快照，计算观测序列与最优序列之间单位长度过剩能的差值，\n   $$\\Delta \\gamma = \\frac{E_{\\text{obs}} - E_{\\text{opt}}}{L}。$$\n   以电子伏特每纳米 (eV/nm) 为单位报告 $\\Delta \\gamma$，结果为保留小数点后六位的小数。\n\n角度单位要求：所有角度必须以弧度为单位。能量单位为电子伏特 (eV)。长度单位为纳米 (nm)。报告的 $\\Delta \\gamma$ 必须以 eV/nm 为单位。\n\n测试套件。您的程序必须评估以下四个快照，每个快照由生成原子坐标 $\\{(x_i,y_i)\\}$（单位为纳米）的参数定义：\n- 案例1（具有微弱正弦起伏的近直线边界）：\n  - 原子数 $N = 10$，\n  - 间距 $s = 0.25$，\n  - 振幅 $A = 0.005$，\n  - 坐标：$x_i = i s$, $y_i = A \\sin\\left(\\frac{2\\pi i}{9}\\right)$，对于 $i = 0,1,\\dots,9$。\n- 案例2（周期性扭折）：\n  - 原子数 $N = 12$，\n  - 间距 $s = 0.25$，\n  - 扭折振幅 $K = 0.04$，\n  - 坐标：$x_i = i s$, $y_i = \\begin{cases} 0 & \\text{若 } i \\bmod 3 = 0, \\\\ K & \\text{若 } i \\bmod 3 = 1, \\\\ -K & \\text{若 } i \\bmod 3 = 2,\\end{cases}$，对于 $i = 0,1,\\dots,11$。\n- 案例3（单个内部角度接近 $120^\\circ$）：\n  - 三个原子：$(0.0, 0.0)$, $(0.25, 0.0)$, $\\left(0.25 + 0.25\\cos(\\pi/3), \\, 0.25\\sin(\\pi/3)\\right)$。\n- 案例4（无内部角度）：\n  - 两个原子：$(0.0, 0.0)$, $(0.25, 0.0)$。\n\n实现要求：\n- 精确实现角度计算，使用每个内部原子处归一化邻居向量点积的反余弦函数。\n- 计算观测序列能量 $E_{\\text{obs}}$，其值为每个位点围绕指定类型目标角度的二次偏差之和，加上 $\\lambda$ 乘以连续内部原子之间类型变化的次数。\n- 通过在所有可能的类型分配上精确最小化相同的的一维链能量来计算 $E_{\\text{opt}}$。一个带有最近邻耦合的动态规划解法是合适的。\n- 对于每个案例，计算 $\\Delta \\gamma$ 并四舍五入到小数点后六位。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按顺序排列的四个案例的 $\\Delta \\gamma$ 值，以逗号分隔并用方括号括起。例如，输出必须类似于 $[\\Delta\\gamma_1,\\Delta\\gamma_2,\\Delta\\gamma_3,\\Delta\\gamma_4]$，其中每个值都表示为以 eV/nm 为单位、四舍五入到小数点后六位的小数，且无任何附加文本。", "solution": "所提出的问题是计算材料科学领域一个定义明确且有科学依据的练习，特别是在一维晶界或相界的建模方面。它要求实现一个原子级别的协议，以比较由局域标准确定的边界结构能量与全局最优结构的能量。该问题是有效的，因为它建立在公认的原理之上——即界面的结构单元模型和通过谐波展开近似势能面——并提供了一套完整且一致的定义、参数和测试用例。\n\n解决方案将通过以下步骤展开：首先形式化几何和能量模型，然后详细说明计算两个目标能量 $E_{\\text{obs}}$ 和 $E_{\\text{opt}}$ 的算法，最后将这些算法应用于指定的测试用例。\n\n**1. 几何与能量模型的形式化**\n\n设 $N$ 个原子位置的序列表示为 $\\{\\vec{r}_j\\}_{j=0}^{N-1}$，其中 $\\vec{r}_j = (x_j, y_j) \\in \\mathbb{R}^2$。问题陈述，原子已排序，使得 $x_j \\le x_{j+1}$。\n\n边界的总长度 $L$ 是连接这些原子的折线的弧长：\n$$L = \\sum_{j=0}^{N-2} |\\vec{r}_{j+1} - \\vec{r}_j|$$\n\n该模型关注 $M = N-2$ 个内部原子，其索引从 $i=1$ 到 $M$。对于每个内部原子 $i$（对应位置 $\\vec{r}_i$），其局域键角 $\\theta_i$ 由其邻居 $\\vec{r}_{i-1}$ 和 $\\vec{r}_{i+1}$ 形成。该角度由源自原子 $i$ 的两个向量的点积计算得出：\n$$\\vec{v}_{i-1} = \\vec{r}_{i-1} - \\vec{r}_i$$\n$$\\vec{v}_{i+1} = \\vec{r}_{i+1} - \\vec{r}_i$$\n$$\\theta_i = \\arccos\\left(\\frac{\\vec{v}_{i-1} \\cdot \\vec{v}_{i+1}}{|\\vec{v}_{i-1}| |\\vec{v}_{i+1}|}\\right) \\in [0, \\pi]$$\n所有角度必须以弧度为单位。\n\n定义了三种标准结构单元类型：$S$ 型 ($\\theta_S = \\pi$)，$K$ 型 ($\\theta_K = 5\\pi/6$)，以及 $T$ 型 ($\\theta_T = 2\\pi/3$)。可能的类型集合为 $\\mathcal{U} = \\{S, K, T\\}$。\n\n对于给定的结构单元分配序列 $\\{U_i\\}_{i=1}^M$（其中 $U_i \\in \\mathcal{U}$），边界的总过剩能由局域能量和相互作用能量之和给出：\n$$E\\left(\\{U_i\\}_{i=1}^M\\right) = \\sum_{i=1}^{M} E_{\\text{local}}(i, U_i) + \\sum_{i=1}^{M-1} E_{\\text{int}}(U_i, U_{i+1})$$\n位点 $i$ 处分配了类型 $U_i$ 的局域能量是角度畸变的二次惩罚项：\n$$E_{\\text{local}}(i, U_i) = k_\\theta (\\theta_i - \\theta_{U_i})^2$$\n其中 $k_\\theta = 5.0 \\, \\text{eV/rad}^2$ 是角刚度，$\\theta_{U_i}$ 是类型 $U_i$ 的目标角度。\n相互作用能量是相邻原子具有不同类型时的失配惩罚项 $\\lambda = 0.2 \\, \\text{eV}$：\n$$E_{\\text{int}}(U_i, U_{i+1}) = \\lambda \\cdot \\delta_{U_i, U_{i+1}}^\\prime = \\begin{cases} \\lambda & \\text{若 } U_i \\neq U_{i+1} \\\\ 0 & \\text{若 } U_i = U_{i+1} \\end{cases}$$\n\n**2. 观测序列能量 $E_{\\text{obs}}$ 的计算**\n\n“观测”序列 $\\{U_i^{\\text{obs}}\\}_{i=1}^M$ 是通过纯粹的局域能量最小化来确定的。对于每个内部原子 $i$，我们分配使其局域能量贡献最小化的类型：\n$$U_i^{\\text{obs}} = \\arg\\min_{U \\in \\mathcal{U}} E_{\\text{local}}(i, U) = \\arg\\min_{U \\in \\mathcal{U}} k_\\theta (\\theta_i - \\theta_U)^2$$\n这等价于找到与测量角度 $\\theta_i$ 最接近的目标角度 $\\theta_U$。\n\n一旦确定了序列 $\\{U_i^{\\text{obs}}\\}$，其总能量 $E_{\\text{obs}}$ 使用通用能量公式计算：\n$$E_{\\text{obs}} = E\\left(\\{U_i^{\\text{obs}}\\}\\right) = \\sum_{i=1}^{M} k_\\theta (\\theta_i - \\theta_{U_i^{\\text{obs}}})^2 + \\sum_{i=1}^{M-1} \\lambda \\cdot \\delta_{U_i^{\\text{obs}}, U_{i+1}^{\\text{obs}}}^\\prime$$\n\n**3. 最优序列能量 $E_{\\text{opt}}$ 的计算**\n\n全局最优能量 $E_{\\text{opt}}$ 对应于在所有可能的类型分配序列中使总能量最小化的序列 $\\{U_i^*\\}_{i=1}^M$。\n$$E_{\\text{opt}} = \\min_{\\{U_i\\}_{i=1}^M} E\\left(\\{U_i\\}_{i=1}^M\\right)$$\n这是一个带有最近邻相互作用的经典一维最小化问题，可以使用动态规划高效求解。设 $D(i, U)$ 为前 $i$ 个内部原子组成的子链的最小能量，其中第 $i$ 个原子被分配为 $U$ 类型。\n\n动态规划的递推关系如下：\n\n**基本情况 (i=1)：** 对于第一个内部原子，没有先前的相互作用。最小能量就是局域能量。\n$$D(1, U) = E_{\\text{local}}(1, U) \\quad \\text{对于每个 } U \\in \\mathcal{U}$$\n\n**递推步骤 (i > 1)：** 对于后续的每个原子 $i$ 和每个可能的类型 $U \\in \\mathcal{U}$，最小能量 $D(i, U)$ 是位点 $i$ 处类型为 $U$ 的局域能量，加上与之相连的长度为 $i-1$ 的链的最小能量。这包括当 $i-1$ 处的类型与 $U$ 不同时的失配惩罚。\n$$D(i, U) = E_{\\text{local}}(i, U) + \\min_{U' \\in \\mathcal{U}} \\left[ D(i-1, U') + E_{\\text{int}}(U', U) \\right]$$\n\n**终止：** 在遍历了所有内部原子直到 $i=M$ 之后，全局最优能量是我们动态规划表的最后一列中的最小值：\n$$E_{\\text{opt}} = \\min_{U \\in \\mathcal{U}} D(M, U)$$\n\n对于 $N < 3$ 个原子的案例，内部原子数 $M = N-2 \\le 0$。在这种情况下，根据定义，$E_{\\text{obs}}$ 和 $E_{\\text{opt}}$ 均为零。\n\n**4. 最终计算**\n\n对于每个测试用例，所需的输出是观测构型和最优构型之间单位长度过剩能的差值 $\\Delta\\gamma$：\n$$\\Delta\\gamma = \\frac{E_{\\text{obs}} - E_{\\text{opt}}}{L}$$\n$\\Delta\\gamma$ 的值保证为非负，因为 $E_{\\text{opt}}$ 是全局最小值，所以 $E_{\\text{obs}} \\ge E_{\\text{opt}}$。结果以 eV/nm 为单位报告，并四舍五入到小数点后六位。实现将严格按照以上步骤进行。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to process all test cases and print the results.\n    \"\"\"\n\n    # Define physical constants and model parameters\n    k_theta = 5.0  # eV/rad^2\n    lambda_penalty = 0.2  # eV\n    \n    # Define structural unit types and their target angles in radians\n    types = {\n        'S': np.pi,\n        'K': 5 * np.pi / 6,\n        'T': 2 * np.pi / 3,\n    }\n    type_keys = list(types.keys())\n    type_angles = np.array(list(types.values()))\n    \n    # Generate coordinates for all test cases\n    test_cases = [\n        generate_case_1_coords(),\n        generate_case_2_coords(),\n        generate_case_3_coords(),\n        generate_case_4_coords(),\n    ]\n\n    results = []\n    for coords in test_cases:\n        delta_gamma = calculate_delta_gamma(coords, types, type_keys, type_angles, k_theta, lambda_penalty)\n        results.append(f\"{delta_gamma:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_delta_gamma(coords, types, type_keys, type_angles, k_theta, lambda_penalty):\n    \"\"\"\n    Calculates Δγ for a single set of atomic coordinates.\n    \"\"\"\n    N = len(coords)\n    \n    # Sort atoms by x, then y coordinate to form a chain\n    coords = sorted(coords, key=lambda p: (p[0], p[1]))\n    coords = np.array(coords)\n\n    # 1. Compute boundary length L\n    if N  2:\n        L = 0.0\n    else:\n        L = np.sum(np.linalg.norm(coords[1:] - coords[:-1], axis=1))\n\n    # Handle cases with no internal atoms (N  3)\n    if N  3:\n        return 0.0\n\n    # 2. Compute bond angles for internal atoms\n    num_internal = N - 2\n    internal_angles = np.zeros(num_internal)\n    for i in range(1, N - 1):\n        v_prev = coords[i-1] - coords[i]\n        v_next = coords[i+1] - coords[i]\n        \n        # Clamp argument to arccos to avoid floating point issues\n        cos_theta = np.dot(v_prev, v_next) / (np.linalg.norm(v_prev) * np.linalg.norm(v_next))\n        cos_theta = np.clip(cos_theta, -1.0, 1.0)\n        \n        internal_angles[i-1] = np.arccos(cos_theta)\n        \n    # 3. Calculate E_obs\n    local_energies = k_theta * (internal_angles[:, np.newaxis] - type_angles)**2\n    \n    # Assign observed types by finding the minimum local energy\n    observed_type_indices = np.argmin(local_energies, axis=1)\n    \n    # Sum of minimized local energy contributions\n    min_local_energies = np.min(local_energies, axis=1)\n    e_obs_local = np.sum(min_local_energies)\n    \n    # Sum of mismatch penalties\n    e_obs_mismatch = 0.0\n    for i in range(num_internal - 1):\n        if observed_type_indices[i] != observed_type_indices[i+1]:\n            e_obs_mismatch += lambda_penalty\n            \n    E_obs = e_obs_local + e_obs_mismatch\n    \n    # 4. Calculate E_opt using Dynamic Programming\n    num_types = len(types)\n    dp_table = np.zeros((num_internal, num_types))\n\n    # Base case: i = 0 (first internal atom)\n    dp_table[0, :] = local_energies[0, :]\n    \n    # Recurrence\n    for i in range(1, num_internal):\n        for j in range(num_types): # Current type index\n            min_prev_cost = np.inf\n            for k in range(num_types): # Previous type index\n                mismatch_cost = 0 if j == k else lambda_penalty\n                cost = dp_table[i-1, k] + mismatch_cost\n                if cost  min_prev_cost:\n                    min_prev_cost = cost\n            dp_table[i, j] = local_energies[i, j] + min_prev_cost\n            \n    E_opt = np.min(dp_table[num_internal - 1, :])\n\n    # 5. Compute Δγ\n    if L == 0:\n        return 0.0\n        \n    delta_gamma = (E_obs - E_opt) / L\n    return delta_gamma\n\ndef generate_case_1_coords():\n    N, s, A = 10, 0.25, 0.005\n    coords = []\n    for i in range(N):\n        x = i * s\n        y = A * np.sin(2 * np.pi * i / 9)\n        coords.append((x, y))\n    return coords\n\ndef generate_case_2_coords():\n    N, s, K = 12, 0.25, 0.04\n    coords = []\n    for i in range(N):\n        x = i * s\n        if i % 3 == 0:\n            y = 0.0\n        elif i % 3 == 1:\n            y = K\n        else: # i % 3 == 2\n            y = -K\n        coords.append((x, y))\n    return coords\n\ndef generate_case_3_coords():\n    s = 0.25\n    return [\n        (0.0, 0.0),\n        (s, 0.0),\n        (s + s * np.cos(np.pi/3), s * np.sin(np.pi/3))\n    ]\n\ndef generate_case_4_coords():\n    return [(0.0, 0.0), (0.25, 0.0)]\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2772530"}]}