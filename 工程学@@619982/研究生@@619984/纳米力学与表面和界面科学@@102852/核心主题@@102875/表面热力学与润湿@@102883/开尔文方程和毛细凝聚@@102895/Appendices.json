{"hands_on_practices": [{"introduction": "本练习是理解毛细凝聚现象的基石。我们将从最基本的物理原理出发，即相平衡时的化学势相等以及弯曲界面两侧的力学平衡，来为理想的球形纳米空腔推导开尔文方程 [@problem_id:2794221]。这个推导过程旨在巩固您对热力学和界面科学核心概念的理解，确保您掌握的不仅仅是最终公式，而是其背后严谨的物理逻辑。", "problem": "一个内部半径为 $r$ 的球形纳米腔嵌入一个刚性固体中，并暴露于温度为 $T$、压力为 $p$ 的自身蒸气储库中。液体完全润湿固体（杨氏接触角为零），在毛细凝聚时形成一个静态弯月面。假设蒸气表现为理想气体，液体在相关压力范围内不可压缩，其摩尔体积为 $v_{\\ell}$，液-气界面张力为 $\\gamma$。普适气体常数为 $R$。\n\n仅从相平衡时化学势相等以及静态曲面界面两端的力学平衡出发，并采用当曲率中心位于蒸气侧时主曲率半径为正的符号约定，完成以下操作：\n\n1) 根据对称性和完全润湿条件，确定球形腔内弯月面的主曲率的带符号和 $1/R_{1} + 1/R_{2}$。\n\n2) 使用此曲率推导 $\\ln\\!\\big(p/p_{\\mathrm{sat}}\\big)$ 的闭合形式表达式，其中 $p_{\\mathrm{sat}}$ 是相同温度 $T$ 下平界面的饱和压力。\n\n将最终答案表示为仅含 $r$、$\\gamma$、$v_{\\ell}$、 $R$ 和 $T$ 的单个解析表达式。不要在最终答案框中包含单位。", "solution": "该问题要求从基本原理出发，推导球形腔内毛细凝聚的开尔文方程。对问题陈述的验证表明，其具有科学依据，问题设定良好，并包含足够的信息以在标准物理近似下获得唯一解。\n\n解题过程按要求分为两部分。首先，我们确定液-气弯月面的曲率。其次，我们利用此结果结合热力学和力学平衡原理，推导 $\\ln(p/p_{\\text{sat}})$ 的表达式。\n\n第 1 部分：弯月面曲率的确定\n\n平衡状态由两个条件决定：液-气界面两端的力学平衡以及液相和气相之间的相平衡。\n\n根据半径为 $r$ 的腔体的球对称性，内部形成的任何稳定、静态的弯月面也必须是球形的，以在给定体积下最小化表面能。球形表面具有两个相等的主曲率半径 $R_{1}$ 和 $R_{2}$。设 $R_{1} = R_{2} = R_{m}$，其中 $R_{m}$ 是弯月面的半径。\n\n问题描述了毛细凝聚，即蒸气凝结成液体并润湿腔壁。因此，液体在固体表面形成一层薄膜，而蒸气占据中心核心区域。弯月面是液体和蒸气之间的界面。\n\n完全润湿条件（杨氏接触角为零）意味着液体完全铺展在固体表面上。在孔隙凝聚的情况下，这通常被解释为弯月面的特征曲率半径由孔隙本身的几何形状决定。对于半径为 $r$ 的球形腔，弯月面因此是一个半径为 $r$ 的同心球。因此，我们有 $R_{m} = r$。\n\n接下来，我们必须确定曲率半径的符号。问题给出了符号约定：如果曲率中心位于蒸气侧，则曲率半径为正。在我们的系统中，液体覆盖在腔壁上，蒸气在中心形成核心。球形弯月面的中心，也即腔体的中心，位于气相内部。因此，根据给定的约定，主曲率半径为正：$R_{1} = +r$ 和 $R_{2} = +r$。\n\n因此，主曲率的带符号和为：\n$$\n\\frac{1}{R_{1}} + \\frac{1}{R_{2}} = \\frac{1}{r} + \\frac{1}{r} = \\frac{2}{r}\n$$\n\n第 2 部分：$\\ln(p/p_{\\mathrm{sat}})$ 表达式的推导\n\n我们从温度 $T$ 下液相和气相之间的热力学平衡条件开始：化学势必须相等。\n$$\n\\mu_{\\ell}(p_{\\ell}, T) = \\mu_{v}(p, T)\n$$\n其中 $p_{\\ell}$ 是液相内的压力，$p$ 是蒸气的压力。\n\n对于平界面，平衡发生在饱和压力 $p_{\\mathrm{sat}}(T)$ 处，此时 $\\mu_{\\ell}(p_{\\mathrm{sat}}, T) = \\mu_{v}(p_{\\mathrm{sat}}, T)$。我们可以相对于这个饱和状态来表示任意压力下的化学势。\n\n对于液体，假设其不可压缩且摩尔体积为 $v_{\\ell}$，化学势随压力的变化由 $d\\mu_{\\ell} = v_{\\ell} dP$ 给出。从 $p_{\\mathrm{sat}}$ 到 $p_{\\ell}$ 积分得到：\n$$\n\\mu_{\\ell}(p_{\\ell}, T) - \\mu_{\\ell}(p_{\\mathrm{sat}}, T) = \\int_{p_{\\mathrm{sat}}}^{p_{\\ell}} v_{\\ell} dP = v_{\\ell} (p_{\\ell} - p_{\\mathrm{sat}})\n$$\n\n对于蒸气，假设其表现为理想气体，化学势为 $\\mu_{v}(p, T) = \\mu_{v}^{\\circ}(T) + RT \\ln(p)$。相对于饱和状态的变化是：\n$$\n\\mu_{v}(p, T) - \\mu_{v}(p_{\\mathrm{sat}}, T) = RT \\ln(p) - RT \\ln(p_{\\mathrm{sat}}) = RT \\ln\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right)\n$$\n将这些表达式代入平衡条件 $\\mu_{\\ell}(p_{\\ell}, T) = \\mu_{v}(p, T)$，并使用平界面平衡条件 $\\mu_{\\ell}(p_{\\mathrm{sat}}, T) = \\mu_{v}(p_{\\mathrm{sat}}, T)$ 来消去项，我们得到：\n$$\nv_{\\ell} (p_{\\ell} - p_{\\mathrm{sat}}) = RT \\ln\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right)\n$$\n这个方程联系了系统的热力学状态。现在我们引入力学平衡条件。穿过弯曲液-气界面的压力差由杨-拉普拉斯方程给出：\n$$\n\\Delta p = p - p_{\\ell} = \\gamma \\left(\\frac{1}{R_{1}} + \\frac{1}{R_{2}}\\right)\n$$\n弯月面凹侧的压力更高。由于弯月面朝向蒸气核心凹陷，蒸气压力 $p$ 高于液体压力 $p_{\\ell}$。根据第 1 部分，曲率之和为 $2/r$。因此：\n$$\np - p_{\\ell} = \\gamma \\left(\\frac{2}{r}\\right) \\implies p_{\\ell} = p - \\frac{2\\gamma}{r}\n$$\n将 $p_{\\ell}$ 的这个表达式代入热力学平衡方程，得到：\n$$\nv_{\\ell} \\left( \\left(p - \\frac{2\\gamma}{r}\\right) - p_{\\mathrm{sat}} \\right) = RT \\ln\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right)\n$$\n在所述假设下，此方程是精确的，但它是一个关于平衡压力 $p$ 的隐式方程。为了得到所要求的 $\\ln(p/p_{\\text{sat}})$ 的闭合形式表达式，需要一个标准的且有物理依据的近似。对于小孔中显著的毛细效应，界面上的压降 $p-p_{\\ell}$ 通常远大于蒸气压力与饱和压力的偏差 $p-p_{\\mathrm{sat}}$。因此，我们做出近似 $p \\approx p_{\\mathrm{sat}}$。这样，$p_{\\ell} - p_{\\mathrm{sat}}$ 项变为：\n$$\np_{\\ell} - p_{\\mathrm{sat}} \\approx p_{\\ell} - p = -\\frac{2\\gamma}{r}\n$$\n将此近似代入热力学平衡关系 $v_{\\ell} (p_{\\ell} - p_{\\mathrm{sat}}) = RT \\ln(p/p_{\\mathrm{sat}})$ 中：\n$$\nv_{\\ell} \\left(-\\frac{2\\gamma}{r}\\right) = RT \\ln\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right)\n$$\n重新整理以求解所需量，我们得到了球形腔的开尔文方程：\n$$\n\\ln\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right) = -\\frac{2\\gamma v_{\\ell}}{rRT}\n$$\n正如所要求的，该表达式仅取决于给定的参数 $r$、$\\gamma$、 $v_{\\ell}$、 $R$ 和 $T$。负号正确地表明，凝聚发生在低于体相饱和压力 $p_{\\mathrm{sat}}$ 的压力 $p$ 处。", "answer": "$$\\boxed{-\\frac{2\\gamma v_{\\ell}}{rRT}}$$", "id": "2794221"}, {"introduction": "在掌握了基本的开尔文方程后，下一个挑战是审视其假设的局限性。本练习引入了一个更高级的概念：表面张力对界面曲率的依赖性，通过托尔曼长度 $\\delta_T$ 来量化 [@problem_id:2794157]。通过推导并计算这一修正项的影响，您将学会评估在何种纳米尺度下，这种高阶效应变得不可忽略，从而更精确地描述真实纳米孔隙中的物理行为。", "problem": "一个半径为 $r$ 的球形液体弯月面在温度为 $T$ 的纳米多孔固体中保持稳定。气相表现为理想气体，液相为不可压缩流体，其摩尔体积 $V_{m}$ 与压力无关。表面张力表现出曲率依赖性，该依赖性由 Tolman 长度 $\\delta_{T}$ 表征，当 $|\\delta_{T}| \\ll r$ 时，可写出一阶 Tolman 展开式 $\\gamma(r) = \\gamma_{\\infty}\\left(1 - \\dfrac{2\\delta_{T}}{r}\\right)$，其中 $\\gamma_{\\infty}$ 是平坦界面的表面张力。假设界面两侧存在机械平衡，液相和气相之间存在化学平衡。普适气体常数为 $R$。\n\n1) 从理想气体化学势和不可压缩液体化学势的基本热力学关系出发，结合弯曲界面上的机械平衡，推导当 $\\gamma$ 取值为 $\\gamma_{\\infty}$ 时，对 Kelvin 压力预测值的主导阶分数修正（以 $|\\delta_{T}|/r$ 表示）。用 $\\delta_{T}$ 和 $r$ 表示该分数修正。\n\n2) 对于 $T = 298\\,\\mathrm{K}$ 的水，取 $\\gamma_{\\infty} = 0.072\\,\\mathrm{N\\,m^{-1}}$ 和 $V_{m} = 18.0\\times 10^{-6}\\,\\mathrm{m^{3}\\,mol^{-1}}$。考虑一个半径为 $r = 5.00\\,\\mathrm{nm}$ 的球形弯月面。将“不可忽略”定义为 Kelvin 压力预测值的大小发生 $10\\%$ 的相对变化。在此半径下，能产生 $10\\%$ 修正的 Tolman 长度 $|\\delta_{T}|$ 的最小值为多少？最终答案以纳米为单位表示，并四舍五入至三位有效数字。", "solution": "该问题陈述已经过严格验证，被认为是有效的。它在科学上基于经典热力学和表面科学，问题提法得当、客观且自洽。没有违反物理原理或逻辑不一致之处。我们可以开始解答。\n\n问题分为两部分。首先，我们必须推导由于表面张力的曲率依赖性而对 Kelvin 方程预测值进行分数修正的符号表达式。其次，我们必须根据该修正的指定大小计算 Tolman 长度的数值。\n\n**第一部分：分数修正的推导**\n\n液相与其蒸气跨越弯曲界面的平衡由两个条件决定：由 Young-Laplace 方程描述的机械平衡，以及要求两相化学势相等的化学平衡。\n\n对于半径为 $r$ 的凹形球状弯月面，标准的简化 Kelvin 方程将平衡蒸气压 $P_g$ 与平坦表面上的饱和蒸气压 $P_{sat}$ 联系起来：\n$$\n\\ln\\left(\\frac{P_g}{P_{sat}}\\right) = -\\frac{2V_m\\gamma}{rRT}\n$$\n其中 $V_m$ 是不可压缩液体的摩尔体积，$T$ 是绝对温度，$R$ 是通用气体常数，$\\gamma$ 是表面张力。\n\n问题引入了由一阶 Tolman 展开式描述的曲率依赖表面张力，适用于 $|\\delta_T| \\ll r$：\n$$\n\\gamma(r) = \\gamma_{\\infty}\\left(1 - \\frac{2\\delta_T}{r}\\right)\n$$\n其中 $\\gamma_{\\infty}$ 是平坦界面的表面张力，$\\delta_T$ 是 Tolman 长度。\n\n“Kelvin 压力预测值”必须被解释为在标准模型中与表面张力 $\\gamma$ 线性成正比的物理量。压力比的对数，我们记为 $K = \\ln(P_g/P_{sat})$，就是这样一个量。另一个同样有效的选择是毛细压力，$\\Delta P_{cap} = 2\\gamma/r$。这个选择不影响分数修正的最终表达式。\n\n标准预测值 $K_{std}$ 是在假设表面张力为常数 $\\gamma = \\gamma_{\\infty}$ 时获得的：\n$$\nK_{std} = -\\frac{2V_m\\gamma_{\\infty}}{rRT}\n$$\n修正后的预测值 $K_{corr}$ 包含了曲率依赖的表面张力 $\\gamma(r)$：\n$$\nK_{corr} = -\\frac{2V_m\\gamma(r)}{rRT} = -\\frac{2V_m}{rRT}\\left[\\gamma_{\\infty}\\left(1 - \\frac{2\\delta_T}{r}\\right)\\right]\n$$\n通过观察，我们可以用标准预测值来表示修正后的预测值：\n$$\nK_{corr} = K_{std}\\left(1 - \\frac{2\\delta_T}{r}\\right)\n$$\n对预测值的分数修正定义为修正值与标准值之间的相对差异：\n$$\n\\text{分数修正} = \\frac{K_{corr} - K_{std}}{K_{std}}\n$$\n代入 $K_{corr}$ 的表达式：\n$$\n\\text{分数修正} = \\frac{K_{std}\\left(1 - \\frac{2\\delta_T}{r}\\right) - K_{std}}{K_{std}} = \\frac{K_{std}\\left[\\left(1 - \\frac{2\\delta_T}{r}\\right) - 1\\right]}{K_{std}}\n$$\n这简化为主导阶分数修正的最终表达式：\n$$\n\\text{分数修正} = -\\frac{2\\delta_T}{r}\n$$\n该表达式仅依赖于 Tolman 长度 $\\delta_T$ 和曲率半径 $r$，正如问题陈述所要求的。第一部分的推导到此结束。\n\n**第二部分：Tolman 长度的计算**\n\n问题的第二部分要求我们找出在给定半径下，能导致 $10\\%$ 大小的分数修正的 Tolman 长度的最小值 $|\\delta_T|$。\n\n分数修正的大小为 $10\\%$，相当于数值 $0.10$。使用第一部分的结果：\n$$\n\\left| -\\frac{2\\delta_T}{r} \\right| = 0.10\n$$\n这简化为：\n$$\n\\frac{2|\\delta_T|}{r} = 0.10\n$$\n我们被要求解出 $|\\delta_T|$。整理方程得到：\n$$\n|\\delta_T| = \\frac{0.10 \\times r}{2} = 0.05 \\times r\n$$\n问题指定弯月面的半径为 $r = 5.00\\,\\mathrm{nm}$。将此值代入我们的方程：\n$$\n|\\delta_T| = 0.05 \\times 5.00\\,\\mathrm{nm} = 0.250\\,\\mathrm{nm}\n$$\n所提供的关于水的额外数据（$T$, $\\gamma_{\\infty}$, $V_m$）对于此计算不是必需的，因为当正确定义时，对 Kelvin 预测的分数修正简化为一个纯粹的几何比率。问题要求答案以纳米为单位，并四舍五入到三位有效数字，我们的结果满足此要求。", "answer": "$$\\boxed{0.250}$$", "id": "2794157"}, {"introduction": "最后的这项实践将理论与计算科学紧密结合。您的任务是将在前述练习中建立的物理原理——开尔文方程，转化为一个基于图论的算法，用以模拟复杂、互联的多孔网络中的毛细凝聚过程 [@problem_id:2794160]。这项练习提供了一个强有力的综合应用，要求您将物理规律形式化为逻辑规则并付诸代码实现，这对于预测和理解复杂纳米多孔材料在实际应用中的行为至关重要。", "problem": "您面临一个物理建模任务，该任务属于纳米力学以及表面与界面科学领域。任务是推导并实现一个基于图的吸附模拟，该模拟根据给定的蒸汽活度，基于基础热力学和毛细管原理，确定多孔网络中的哪些孔隙将被液体填充。在您的实现中，孔隙由节点表示，孔喉由边表示，冷凝由节点和边的局部曲率条件控制。您的程序必须为每个提供的测试用例计算充满液体的节点数量，并以指定的输出格式返回结果。\n\n您的推导必须仅从适用于该主题的基本原理出发：\n- 相间平衡时化学势相等。\n- 气相的理想气体行为。\n- 具有恒定摩尔体积的不可压缩液体近似。\n- 连接弯曲界面上压力跳跃与平均曲率的 Young–Laplace 关系。\n\n您不能使用或引用任何目标公式。您的推导应将上述基本原理与由界面曲率和几何形状设定的毛细管冷凝的实际条件进行逻辑连接。在此基础上，您必须设计一种图算法，该算法在边和节点上都强制执行局部填充约束，并允许从源节点进行全局传播。\n\n算法要求：\n- 将多孔介质建模为一个无向图，其节点集为 $\\mathcal{V}$，边集为 $\\mathcal{E}$。\n- 每个节点 $i \\in \\mathcal{V}$ 都有一个球形腔体半径 $r_i$ 和一个接触角 $\\theta_i$（输入中的角度必须以度为单位处理，并在任何三角函数运算中转换为弧度）。\n- 每条边 $e = (i,j) \\in \\mathcal{E}$ 都有一个圆柱形喉道半径 $r_e$ 和一个接触角 $\\theta_e$（也以度为单位给出）。\n- 热物理输入包括表面张力 $\\gamma$（单位 $\\mathrm{N/m}$），液体摩尔体积 $V_m$（单位 $\\mathrm{m^3/mol}$），绝对温度 $T$（单位 $\\mathrm{K}$），以及通用气体常数 $R$（单位 $\\mathrm{J/(mol\\cdot K)}$）。\n- 蒸汽活度 $a \\in (0,1]$（无量纲），等于蒸汽压与饱和蒸汽压之比。角度以度为单位处理，蒸汽活度无量纲，所有半径以米为单位。\n\n从基本原理出发，您必须为以下情况推导出可通过界面曲率表示的局部冷凝阈值条件：\n- 节点：只有在给定的 $a, \\gamma, V_m, T, R, r_i, \\theta_i$ 下，满足推导出的节点特定阈值条件时，节点 $i$ 才能容纳液体弯月面。\n- 边：只有在给定的 $a, \\gamma, V_m, T, R, r_e, \\theta_e$ 下，满足推导出的边特定阈值条件时，边 $e$ 才能在两个节点之间传输液体。\n\n基于图的填充规则：\n- 一组指定的源节点 $\\mathcal{V}_\\mathrm{res} \\subseteq \\mathcal{V}$ 被假定与本体液体接触，并且无论其局部节点阈值如何，都被认为是已填充液体的。\n- 液体填充只能通过在给定 $a$ 下满足边阈值的边，从已填充节点传播到相邻节点。\n- 一个节点 $j$ 只有在来自当前已填充邻居的连接边满足其边阈值，并且节点 $j$ 本身也满足其在给定 $a$ 下的节点阈值时，才能被填充。\n- 此传播过程重复进行，直到没有更多节点可以被填充为止。\n\n单位和角度约定：\n- 所有半径必须以米为单位使用。\n- $\\gamma$ 必须以 $\\mathrm{N/m}$ 为单位，$V_m$ 以 $\\mathrm{m^3/mol}$ 为单位，$T$ 以 $\\mathrm{K}$ 为单位，$R$ 以 $\\mathrm{J/(mol\\cdot K)}$ 为单位，角度以度为单位（在三角函数运算中转换为弧度），$a$ 是无量纲的。\n- 您的输出必须是每个测试用例的已填充节点数的整数计数。\n\n您的程序不得读取任何输入，并且必须在一行中打印所有测试用例的结果。最终输出格式必须是单行，包含一个 Python 列表，其中按顺序包含每个测试用例的结果，例如：“[2,3,1]”。\n\n测试套件：\n使用以下三个测试用例。对于每个用例，所有数值均以 SI 单位给出（如适用），角度以度为单位。通用气体常数为 $R = 8.314462618$。\n\n1) 顺利路径链式网络：\n- 热物理参数：$\\gamma = 0.0728$（单位 $\\mathrm{N/m}$），$V_m = 1.8 \\times 10^{-5}$（单位 $\\mathrm{m^3/mol}$），$T = 298.15$（单位 $\\mathrm{K}$），$R = 8.314462618$（单位 $\\mathrm{J/(mol\\cdot K)}$），蒸汽活度 $a = 0.95$（无量纲）。\n- 图：节点 $\\{0,1,2\\}$，源节点 $\\{0\\}$。\n- 节点属性：半径 $[1.0 \\times 10^{-8}, 1.0 \\times 10^{-8}, 1.0 \\times 10^{-8}]$（单位 $\\mathrm{m}$），接触角 $[0.0, 0.0, 0.0]$（单位度）。\n- 带属性的边列表：边 $(0,1)$ 和 $(1,2)$，每个半径为 $1.0 \\times 10^{-8}$（单位 $\\mathrm{m}$），接触角为 $0.0$（单位度）。\n\n2) 疏水性阻塞（边和节点阈值超过饱和）：\n- 热物理参数：$\\gamma = 0.0728$（单位 $\\mathrm{N/m}$），$V_m = 1.8 \\times 10^{-5}$（单位 $\\mathrm{m^3/mol}$），$T = 298.15$（单位 $\\mathrm{K}$），$R = 8.314462618$（单位 $\\mathrm{J/(mol\\cdot K)}$），蒸汽活度 $a = 0.999$（无量纲）。\n- 图：节点 $\\{0,1,2\\}$，源节点 $\\{0\\}$。\n- 节点属性：半径 $[1.0 \\times 10^{-8}, 1.0 \\times 10^{-8}, 1.0 \\times 10^{-8}]$（单位 $\\mathrm{m}$），接触角 $[120.0, 120.0, 120.0]$（单位度）。\n- 带属性的边列表：边 $(0,1)$ 和 $(1,2)$，每个半径为 $1.0 \\times 10^{-8}$（单位 $\\mathrm{m}$），接触角为 $120.0$（单位度）。\n\n3) 异构星形网络（类似墨水瓶效应的对比）：\n- 热物理参数：$\\gamma = 0.0728$（单位 $\\mathrm{N/m}$），$V_m = 1.8 \\times 10^{-5}$（单位 $\\mathrm{m^3/mol}$），$T = 298.15$（单位 $\\mathrm{K}$），$R = 8.314462618$（单位 $\\mathrm{J/(mol\\cdot K)}$），蒸汽活度 $a = 0.93$（无量纲）。\n- 图：节点 $\\{0,1,2,3\\}$，源节点 $\\{0\\}$。\n- 节点属性：半径 $[1.0 \\times 10^{-8}, 5.0 \\times 10^{-9}, 2.0 \\times 10^{-8}, 5.0 \\times 10^{-8}]$（单位 $\\mathrm{m}$），接触角 $[0.0, 0.0, 0.0, 0.0]$（单位度）。\n- 带属性的边列表：边 $(0,1)$ 半径为 $5.0 \\times 10^{-9}$（单位 $\\mathrm{m}$），接触角为 $0.0$（单位度）；边 $(0,2)$ 半径为 $2.0 \\times 10^{-8}$（单位 $\\mathrm{m}$），接触角为 $0.0$（单位度）；边 $(0,3)$ 半径为 $5.0 \\times 10^{-8}$（单位 $\\mathrm{m}$），接触角为 $0.0$（单位度）。\n\n您的程序应计算从源节点开始应用传播规则后，每个测试用例中整数个已填充节点的数量。最终输出必须是单行，包含一个方括号括起来的、以逗号分隔的三个结果列表，例如，“[x,y,z]”。所有计算必须遵守上文所述的单位和角度约定，三角函数内部必须使用弧度。", "solution": "所述问题在科学上是合理的、自洽的且定义明确的。它代表了物理化学和计算材料科学领域一个标准但并非无足轻重的练习，具体涉及多孔介质中的毛细管冷凝。在实施之前从基本原理推导控制方程的要求是一种有效的教学方法。我现在将进行正式推导和所需算法的设计。\n\n问题的核心在于确定在给定温度 $T$ 和压力 $P_v$ 下，与气相接触的纳米孔内液体冷凝物的热力学平衡条件。\n\n**1. 热力学平衡条件的推导**\n\n我们从液相（下标 $l$）和气相（下标 $v$）之间的热力学平衡陈述开始，它们的化学势必须相等：\n$$ \\mu_l(P_l, T) = \\mu_v(P_v, T) $$\n这里，$P_l$ 是处于弯曲弯月面下的液相内部压力，$P_v$ 是周围蒸汽的压力。\n\n两相的参考态是在相同温度 $T$ 下，平坦界面上的本体平衡。在此饱和条件下，压力为饱和压力 $P_{sat}(T)$，化学势相等：$\\mu_{l,sat}(P_{sat}, T) = \\mu_{v,sat}(P_{sat}, T)$。\n\n对于摩尔体积为 $V_m$ 的不可压缩液体，当压力从 $P_{sat}$ 变为 $P_l$ 时，其化学势的变化由恒温下 Gibbs-Duhem 方程的积分给出（$d\\mu = V_m dP$）：\n$$ \\mu_l(P_l, T) - \\mu_{l,sat}(P_{sat}, T) = \\int_{P_{sat}}^{P_l} V_m dP = V_m (P_l - P_{sat}) $$\n\n对于假定为理想气体的蒸汽，其化学势从 $P_{sat}$ 变为 $P_v$ 的变化为：\n$$ \\mu_v(P_v, T) - \\mu_{v,sat}(P_{sat}, T) = \\int_{P_{sat}}^{P_v} \\frac{RT}{P} dP = RT \\ln\\left(\\frac{P_v}{P_{sat}}\\right) $$\n其中 $R$ 是通用气体常数。\n\n在平衡时（$\\mu_l = \\mu_v$），并且知道参考化学势相等（$\\mu_{l,sat} = \\mu_{v,sat}$），我们可以将化学势变化的表达式相等：\n$$ V_m (P_l - P_{sat}) = RT \\ln\\left(\\frac{P_v}{P_{sat}}\\right) $$\n\n跨越弯曲液-气界面的压力差由 Young-Laplace 方程描述：\n$$ P_v - P_l = \\Delta P = \\gamma \\kappa $$\n其中 $\\gamma$ 是表面张力，$\\kappa$ 是界面的平均曲率。按照惯例，对于从气相看是凹形的弯月面（如在润湿流体中），$\\kappa$ 为正。\n\n在这种情况下，一个标准且有效的近似是假设液体中的压力差 $P_l - P_{sat}$ 主要由毛细管压力决定，即 $P_l - P_{sat} \\approx P_l - P_v$。这是合理的，因为蒸汽压力 $P_v$ 与饱和压力 $P_{sat}$ 的偏离通常远小于纳米孔中的巨大毛细管压力。因此，我们将 $P_l - P_v = -\\gamma \\kappa$ 代入我们热力学关系的左侧：\n$$ V_m (-\\gamma \\kappa) \\approx RT \\ln\\left(\\frac{P_v}{P_{sat}}\\right) $$\n\n定义蒸汽活度为 $a = P_v / P_{sat}$，我们得到 Kelvin 方程：\n$$ \\ln(a) = -\\frac{\\gamma V_m \\kappa}{RT} $$\n该方程将热力学状态（蒸汽活度 $a$）与系统几何形状（平均曲率 $\\kappa$）联系起来。当液态的自由能低于或等于气态的自由能时，冷凝在热力学上是有利的，这对应于以下条件：\n$$ \\ln(a) \\ge -\\frac{\\gamma V_m \\kappa}{RT} $$\n由于在饱和以下冷凝时 $a < 1$，$\\ln(a)$ 为负。这个不等式可以重新排列，以定义在给定活度 $a$ 下冷凝所需的临界曲率 $K_{crit}$：\n$$ \\kappa \\ge -\\frac{RT \\ln(a)}{\\gamma V_m} \\equiv K_{crit}(a) $$\n\n**2. 孔隙几何的曲率模型**\n\n问题指定了两种类型的孔隙元素：球形腔体（节点）和圆柱形喉道（边）。我们必须为每种情况定义特征平均曲率 $\\kappa$。\n\n对于通道内的弯月面，其主曲率半径由通道几何形状和接触角 $\\theta$ 决定。对于流体侵入孔隙至关重要的弯月面，一个一致且广泛使用的平均曲率模型由下式给出：\n$$ \\kappa = \\frac{2 \\cos\\theta}{r_{pore}} $$\n这适用于固定在半径为 $r_{pore}$ 的圆柱形孔隙内的球形弯月面，并且可以合理地推广到半径为 $r_{pore}$ 的球形孔隙。项 $\\cos\\theta$ 正确地解释了润湿性：对于润湿流体（$\\theta < 90^\\circ$），$\\cos\\theta > 0$ 且 $\\kappa > 0$，有利于冷凝。对于非润湿流体（$\\theta > 90^\\circ$），$\\cos\\theta < 0$ 且 $\\kappa < 0$，这意味着在 $a < 1$ 时不可能发生冷凝，因为条件 $\\kappa \\ge K_{crit} > 0$ 永远无法满足。\n\n将此模型应用于我们的系统：\n-   对于半径为 $r_i$、接触角为 $\\theta_i$ 的**节点** $i$（球形腔体），其特征曲率为 $\\kappa_i = \\frac{2\\cos\\theta_i}{r_i}$。\n-   对于半径为 $r_e$、接触角为 $\\theta_e$ 的**边** $e$（圆柱形喉道），其特征曲率为 $\\kappa_e = \\frac{2\\cos\\theta_e}{r_e}$。\n\n**3. 冷凝阈值与模拟算法**\n\n通过这些定义，我们建立了填充的具体条件：\n-   如果一个非源节点 $i$ 的几何形状支持所需的曲率，即 $\\kappa_i \\ge K_{crit}(a)$，则该节点被认为是“可填充的”。角度 $\\theta_i$ 必须从度转换为弧度。\n-   如果一条边 $e$ 的几何形状支持所需的曲率，即 $\\kappa_e \\ge K_{crit}(a)$，则该边被认为是“可通过的”以进行液体传输。角度 $\\theta_e$ 必须从度转换为弧度。\n\n模拟按照指定的基于图的填充规则进行。问题描述了一个从一组源节点 $\\mathcal{V}_\\mathrm{res}$ 开始的传播过程，这些节点根据定义是已填充的。该过程可以使用广度优先搜索（BFS）算法实现，该算法自然地模拟了液体前沿的逐层传播。\n\n算法如下：\n1.  根据给定的热物理参数计算临界曲率 $K_{crit} = -\\frac{RT \\ln(a)}{\\gamma V_m}$。\n2.  对于不在 $\\mathcal{V}_\\mathrm{res}$ 中的每个节点 $i$，通过检查 $\\frac{2\\cos\\theta_i}{r_i} \\ge K_{crit}$ 来确定其是否可填充。角度 $\\theta_i$ 必须从度转换为弧度。\n3.  对于每条边 $e$，通过检查 $\\frac{2\\cos\\theta_e}{r_e} \\ge K_{crit}$ 来确定其是否可通过。角度 $\\theta_e$ 必须从度转换为弧度。\n4.  初始化一个已填充节点的集合 `filled_nodes`，其元素为 $\\mathcal{V}_\\mathrm{res}$ 的元素。\n5.  初始化一个队列 `frontier`，其元素为 $\\mathcal{V}_\\mathrm{res}$ 的元素。\n6.  当 `frontier` 不为空时：\n    a. 从队列中取出一个节点 $u$。\n    b. 对于 $u$ 的每个邻居 $v$：\n        i. 如果 $v$ 尚未在 `filled_nodes` 中：\n        ii. 检查边 $(u,v)$ 是否可通过，以及节点 $v$ 是否可填充。\n        iii. 如果两个条件都满足，则将 $v$ 添加到 `filled_nodes` 中，并将 $v$ 入队到 `frontier`。\n7.  当 `frontier` 变空时，过程终止。已填充节点的总数是最终 `filled_nodes` 集合的大小。\n此过程正确地模拟了孔隙网络的协同填充行为，其中液体侵入受局部几何形状和连通性双重约束的可及区域。", "answer": "```python\nimport numpy as np\nfrom collections import deque\n\ndef solve():\n    \"\"\"\n    Solves the capillary condensation problem for the three specified test cases.\n    \"\"\"\n    R = 8.314462618  # Universal gas constant in J/(mol·K)\n\n    # Define the three test cases as a list of dictionaries.\n    test_cases = [\n        {\n            # Case 1: Happy-path chain network\n            \"params\": {\"gamma\": 0.0728, \"Vm\": 1.8e-5, \"T\": 298.15, \"a\": 0.95},\n            \"graph\": {\n                \"num_nodes\": 3,\n                \"reservoir_nodes\": {0},\n                \"node_props\": { # (radius in m, contact angle in degrees)\n                    0: (1.0e-8, 0.0),\n                    1: (1.0e-8, 0.0),\n                    2: (1.0e-8, 0.0),\n                },\n                \"edge_props\": { # (u, v): (radius in m, contact angle in degrees)\n                    (0, 1): (1.0e-8, 0.0),\n                    (1, 2): (1.0e-8, 0.0),\n                }\n            }\n        },\n        {\n            # Case 2: Hydrophobic blockage\n            \"params\": {\"gamma\": 0.0728, \"Vm\": 1.8e-5, \"T\": 298.15, \"a\": 0.999},\n            \"graph\": {\n                \"num_nodes\": 3,\n                \"reservoir_nodes\": {0},\n                \"node_props\": {\n                    0: (1.0e-8, 120.0),\n                    1: (1.0e-8, 120.0),\n                    2: (1.0e-8, 120.0),\n                },\n                \"edge_props\": {\n                    (0, 1): (1.0e-8, 120.0),\n                    (1, 2): (1.0e-8, 120.0),\n                }\n            }\n        },\n        {\n            # Case 3: Heterogeneous star network\n            \"params\": {\"gamma\": 0.0728, \"Vm\": 1.8e-5, \"T\": 298.15, \"a\": 0.93},\n            \"graph\": {\n                \"num_nodes\": 4,\n                \"reservoir_nodes\": {0},\n                \"node_props\": {\n                    0: (1.0e-8, 0.0),\n                    1: (5.0e-9, 0.0),\n                    2: (2.0e-8, 0.0),\n                    3: (5.0e-8, 0.0),\n                },\n                \"edge_props\": {\n                    (0, 1): (5.0e-9, 0.0),\n                    (0, 2): (2.0e-8, 0.0),\n                    (0, 3): (5.0e-8, 0.0),\n                }\n            }\n        }\n    ]\n\n    def run_simulation(case_data, R_const):\n        \"\"\"\n        Runs the graph-based filling simulation for a single test case.\n        \"\"\"\n        params = case_data[\"params\"]\n        graph_data = case_data[\"graph\"]\n\n        # 1. Calculate critical curvature K_crit\n        gamma, Vm, T, a = params[\"gamma\"], params[\"Vm\"], params[\"T\"], params[\"a\"]\n        if a >= 1.0 or a = 0.0:  # Avoid log(a) domain errors\n            K_crit = -np.inf if a >= 1.0 else np.inf\n        else:\n            K_crit = -(R_const * T * np.log(a)) / (gamma * Vm)\n\n        # 2. Build adjacency list and check thresholds for nodes and edges\n        num_nodes = graph_data[\"num_nodes\"]\n        adj = [[] for _ in range(num_nodes)]\n        is_node_fillable = {}\n        is_edge_passable = {}\n\n        # Check nodes\n        for i in range(num_nodes):\n            r_i, theta_i_deg = graph_data[\"node_props\"][i]\n            theta_i_rad = np.deg2rad(theta_i_deg)\n            # Handle potential division by zero and non-positive radii\n            if r_i = 0 or np.cos(theta_i_rad) = 0:\n                 kappa_i = -np.inf\n            else:\n                 kappa_i = (2 * np.cos(theta_i_rad)) / r_i\n            is_node_fillable[i] = (kappa_i >= K_crit)\n\n        # Check edges and build adjacency list\n        for (u, v), (r_e, theta_e_deg) in graph_data[\"edge_props\"].items():\n            adj[u].append(v)\n            adj[v].append(u)\n            theta_e_rad = np.deg2rad(theta_e_deg)\n            if r_e = 0 or np.cos(theta_e_rad) = 0:\n                kappa_e = -np.inf\n            else:\n                kappa_e = (2 * np.cos(theta_e_rad)) / r_e\n            \n            # Store passability for both directions\n            is_edge_passable[(u, v)] = (kappa_e >= K_crit)\n            is_edge_passable[(v, u)] = (kappa_e >= K_crit)\n\n        # 3. Run propagation algorithm (BFS)\n        reservoir_nodes = graph_data[\"reservoir_nodes\"]\n        filled_nodes = set(reservoir_nodes)\n        frontier = deque(reservoir_nodes)\n\n        while frontier:\n            u = frontier.popleft()\n            for v in adj[u]:\n                if v not in filled_nodes:\n                    # Check propagation conditions\n                    edge_passable = is_edge_passable.get((u, v), False)\n                    node_fillable = is_node_fillable.get(v, False)\n\n                    if edge_passable and node_fillable:\n                        filled_nodes.add(v)\n                        frontier.append(v)\n        \n        return len(filled_nodes)\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(case, R)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2794160"}]}