{"hands_on_practices": [{"introduction": "接触角滞后并非一个抽象概念，它会产生可观的宏观效应，例如液滴能够固定在倾斜的表面上。本练习要求您通过推导液滴开始滑动的临界倾斜角来量化此效应 [@problem_id:2767018]。通过应用重力与毛细管固着力之间的基本力平衡，您将建立一个第一性原理模型，这个模型将可测量的接触角（如前进角 $\\theta_A$ 和后退角 $\\theta_R$）与可预测的宏观行为直接联系起来。", "problem": "一个质量为 $m$ 的固着液滴静止在化学均匀且形貌各向同性的固体表面上。基底被缓慢倾斜，使得表面与水平面成 $\\alpha$ 角。由于接触角滞后，液滴保持钉扎状态，其特征为下坡侧的前进接触角 $\\theta_A$ 和上坡侧的后退接触角 $\\theta_R$。假设为准静态条件，因此惯性和粘性耗散可忽略不计，并忽略线张力。液-汽表面张力为 $\\gamma_{lv}$，液滴足迹垂直于下坡方向的投影宽度为 $w$。一个无量纲形状因子 $k$ 用于解释足迹的详细几何形状在沿下坡方向的力投影中的作用。\n\n从牛顿第二定律和由杨氏关系所蕴含的三相接触线处的毛细力平衡出发（杨氏关系指出，沿固体表面单位长度的液-汽表面张力在固体表面平面内的分量为 $\\gamma_{lv}\\cos\\theta$，方向指向液体内部），依据第一性原理推导液滴开始滑动时的临界倾斜角 $\\alpha_c$ 的表达式，该表达式应使用 $m$、$g$、$w$、$\\gamma_{lv}$、$\\theta_A$、$\\theta_R$ 和 $k$ 来表示。然后，使用给定值 $m=5\\ \\mathrm{mg}$、$w=3\\ \\mathrm{mm}$、$\\gamma_{lv}=72\\ \\mathrm{mN/m}$、$\\cos\\theta_R - \\cos\\theta_A=0.2$、$k=1$ 以及重力加速度 $g=9.81\\ \\mathrm{m/s^2}$ 对你的表达式进行求值。以弧度为单位表示 $\\alpha_c$ 的最终值，并将答案四舍五入到三位有效数字。", "solution": "在尝试任何解答之前，应对问题陈述进行验证。\n\n步骤1：提取已知条件\n- 液滴质量：$m$\n- 倾斜表面与水平面的夹角：$\\alpha$\n- 前进接触角（下坡侧）：$\\theta_A$\n- 后退接触角（上坡侧）：$\\theta_R$\n- 假设：准静态条件（惯性和粘性耗散可忽略不计）。\n- 假设：线张力被忽略。\n- 液-汽表面张力：$\\gamma_{lv}$\n- 液滴足迹的投影宽度：$w$\n- 无量纲形状因子：$k$\n- 重力加速度：$g$\n- 控制原理：牛顿第二定律，力平衡。\n- 毛细力描述：在固体平面内，每单位长度的力为 $\\gamma_{lv}\\cos\\theta$。\n- 任务1：用 $m$、$g$、$w$、$\\gamma_{lv}$、$\\theta_A$、$\\theta_R$ 和 $k$ 推导临界倾斜角 $\\alpha_c$。\n- 任务2：对 $m=5\\ \\mathrm{mg}$、$w=3\\ \\mathrm{mm}$、$\\gamma_{lv}=72\\ \\mathrm{mN/m}$、$\\cos\\theta_R - \\cos\\theta_A=0.2$、$k=1$ 和 $g=9.81\\ \\mathrm{m/s^2}$ 计算 $\\alpha_c$。\n- 要求输出格式：$\\alpha_c$ 以弧度为单位，并四舍五入到三位有效数字。\n\n步骤2：验证\n该问题具有科学依据，描述了接触角滞后这一公认的物理现象。该问题提法恰当，提供了充分、一致且物理上现实的参数以确定唯一解。语言客观而精确。该问题不违反任何无效性标准。该模型忽略了线张力并假设了一个准静态过程，这是对宏观液滴的标准且适当的简化。使用形状因子 $k$ 是一个概括接触线几何形状的常用方法，这使得问题自成体系且可解，无需对液滴足迹的精确形状进行复杂计算。\n\n步骤3：结论\n问题有效。将进行求解。\n\n推导从第一性原理开始，即在准静态条件下作用在液滴上的力的平衡。考虑一个坐标系，其中 $x$ 轴与固体表面对齐，指向下坡方向，而 $y$ 轴垂直于表面。当重力引起的驱动力恰好被毛细作用产生的最大可能恢复力所平衡时，液滴处于滑动的临界状态。\n\n作用在液滴上的重力是其重量，$F_g = mg$，方向垂直向下。该力平行于倾斜表面的分量，即滑动的驱动力，由下式给出：\n$$F_{g, \\parallel} = mg \\sin\\alpha$$\n\n与运动方向相反的毛细力，源于三相接触线上的张力。问题指明，在固体表面平面内，每单位长度的表面张力分量为 $\\gamma_{lv}\\cos\\theta$。该力指向液体内部，垂直于接触线。接触角滞后意味着接触角在液滴周界上并非均匀一致。在即将开始运动的临界点，整个下坡（前进）前沿的接触角为前进角 $\\theta_A$，而整个上坡（后退）前沿的接触角为后退接触角 $\\theta_R$。\n\n前进前沿的力产生一个指向上坡方向的恢复力，而后退前沿的力则贡献一个指向下坡方向的力。净保持力是这两者之差。一个用于计算最大毛细保持总力 $F_{c,max}$ 的标准模型由以下表达式给出，该模型通过投影宽度 $w$ 和形状因子 $k$ 来考虑接触线的几何形状：\n$$F_{c,max} = k \\gamma_{lv} w (\\cos\\theta_R - \\cos\\theta_A)$$\n该表达式代表了接触线钉扎为防止液滴滑动所能施加的最大力。项 $(\\cos\\theta_R - \\cos\\theta_A)$ 是滞后效应的量度。\n\n开始滑动的临界条件发生在临界角 $\\alpha_c$ 处，此时驱动力等于最大保持力。应用牛顿第二定律于准静态极限（零加速度）：\n$$\\sum F_x = 0$$\n$$F_{g, \\parallel} - F_{c,max} = 0$$\n$$mg \\sin\\alpha_c = k \\gamma_{lv} w (\\cos\\theta_R - \\cos\\theta_A)$$\n\n解出 $\\sin\\alpha_c$ 可得：\n$$\\sin\\alpha_c = \\frac{k \\gamma_{lv} w (\\cos\\theta_R - \\cos\\theta_A)}{mg}$$\n\n因此，临界角 $\\alpha_c$ 的解析表达式为：\n$$\\alpha_c = \\arcsin\\left(\\frac{k \\gamma_{lv} w (\\cos\\theta_R - \\cos\\theta_A)}{mg}\\right)$$\n\n现在，我们使用给定的数值来计算该表达式。必须将所有物理量转换为统一的单位制，即国际单位制（SI）。\n- $m = 5\\ \\mathrm{mg} = 5 \\times 10^{-6}\\ \\mathrm{kg}$\n- $w = 3\\ \\mathrm{mm} = 3 \\times 10^{-3}\\ \\mathrm{m}$\n- $\\gamma_{lv} = 72\\ \\mathrm{mN/m} = 72 \\times 10^{-3}\\ \\mathrm{N/m}$\n- $\\cos\\theta_R - \\cos\\theta_A = 0.2$ (无量纲)\n- $k = 1$ (无量纲)\n- $g = 9.81\\ \\mathrm{m/s^2}$\n\n首先，我们计算 $\\arcsin$ 函数的参数：\n$$\\frac{k \\gamma_{lv} w (\\cos\\theta_R - \\cos\\theta_A)}{mg} = \\frac{(1) \\cdot (72 \\times 10^{-3}\\ \\mathrm{N/m}) \\cdot (3 \\times 10^{-3}\\ \\mathrm{m}) \\cdot (0.2)}{(5 \\times 10^{-6}\\ \\mathrm{kg}) \\cdot (9.81\\ \\mathrm{m/s^2})}$$\n分子计算：\n$$1 \\cdot (72 \\times 10^{-3}) \\cdot (3 \\times 10^{-3}) \\cdot 0.2 = 4.32 \\times 10^{-5}\\ \\mathrm{N}$$\n分母计算：\n$$(5 \\times 10^{-6}) \\cdot 9.81 = 4.905 \\times 10^{-5}\\ \\mathrm{N}$$\n比值为：\n$$\\sin\\alpha_c = \\frac{4.32 \\times 10^{-5}}{4.905 \\times 10^{-5}} \\approx 0.8807339$$\n该值小于1，这在物理上是一致的。\n\n现在，我们以弧度计算 $\\alpha_c$：\n$$\\alpha_c = \\arcsin(0.8807339) \\approx 1.07736\\ \\mathrm{rad}$$\n\n问题要求答案四舍五入到三位有效数字。\n$$\\alpha_c \\approx 1.08\\ \\mathrm{rad}$$", "answer": "$$\\boxed{1.08}$$", "id": "2767018"}, {"introduction": "在对滞后的宏观效应进行建模之后，我们现在转向其在实验中如何精确测量的关键问题。本练习要求您像实验科学家一样思考，评估用于确定前进角和后退角的标准体积增减法 [@problem_id:2766985]。您的任务是从一系列选项中辨别正确的实验方案与有缺陷的方案，并识别那些可能影响测量准确性的、从流体动力学到光学伪影的各种微妙而重要的系统误差来源。", "problem": "将一个牛顿流体的固着液滴轻轻地放置在静止空气中一个名义上平坦、刚性且化学均匀的固体上。静态Young接触角由接触线处的界面张力平衡所定义。在存在有限的非均匀性和粗糙度时，接触线会发生钉扎，测得的表观接触角取决于接触线是被迫前进还是后退。一种确定前进接触角和后退接触角的常用实验方法是，使用连接到微量注射泵的注射器针头，准静态地增加然后减少液滴体积，同时对液滴轮廓进行成像。\n\n从毛细现象和粘性流动的基本原理出发，可以预期以下定性控制因素是相关的：(i) 跨越液-气界面的拉普拉斯压力差，其大小为表面张力乘以总曲率；(ii) 毛细数，定义为粘度乘以特征速度再除以表面张力，它衡量了粘性应力相对于毛细应力的重要性；以及 (iii) 邦德数，定义为密度差乘以重力加速度再乘以横向长度尺度的平方后除以表面张力，它衡量了重力变形相对于表面张力的重要性。\n\n下列哪些陈述共同最准确地描述了用于确定固着液滴前进和后退接触角的正确增减体积方案，并列举了若不加以缓解则可能导致结果偏差的真实系统误差来源？选择所有适用项。\n\nA. 为确定前进接触角，以准静态速率小幅增加液滴体积，使毛细数远小于1，直到接触线脱钉并扩张；记录在可观测到接触线运动前瞬间的最大稳定接触角。为确定后退接触角，以准静态速率抽取体积，直到接触线收缩；记录在收缩前瞬间的最小稳定接触角。保持针头刚好接触液滴，浸入程度最小，并在每次增量后等待界面松弛至由轮廓稳定所指示的机械平衡状态。\n\nB. 尽可能快地增减体积可以抑制蒸发效应，从而提高准确性；快速的速率变化是首选，因为动态效应会相互抵消，不会对前进角和后退角产生偏差。\n\nC. 选择与毛细长度相当或更大的液滴基底半径可以减少重力扁平化偏差；因此，为最小化邦德数对所测接触角的影响，首选较大的液滴。\n\nD. 不受控制的表面污染会引入化学非均匀性或纳米级粗糙度，从而虚假地增加钉扎力；因此，即使固有的Young角不变，对固体清洁和表征不足也可能导致对滞后现象的过高估计。\n\nE. 实验方案中的蒸发会产生一种非指令性的负体积通量，若不加以校正，可能导致后退接触角偏小，前进接触角偏大；为保证准确性，有必要在饱和蒸汽环境中进行测量或补偿蒸发。\n\nF. 为使重力辅助脱钉，需要对基底进行轻微的有意倾斜；若不倾斜，前进接触角是未定义的。因此，倾斜可以减少前进角和后退角测量的偏差。\n\nG. 在整个实验方案中将注液针头浸没在液滴中不会干扰所测角度，因为固体处的局部接触角由Young定律设定；针头附近的任何曲率扰动都与接触线解耦。\n\nH. 在侧视成像中，光学视差、透镜畸变和基线识别误差会系统性地使前进和后退接触角产生偏差；使用远心光学系统、校准放大倍率、将光轴对准并垂直于基底，以及使用稳健的边缘和基线检测方法可以减少此类偏差。\n\nI. 选择使毛细数量级为1或更大的流速，可确保接触线快速扫过多个钉扎点，从而减少表观滞后；因此，较大的毛细数能提高准静态前进角和后退角的准确性。\n\nJ. 液滴与环境之间的温度梯度会产生Marangoni应力，该应力可驱动与预期的体积变化无关的界面流和接触线运动；将温度控制在等温条件下可最大程度地减小此偏差来源。", "solution": "该问题陈述有效描述了使用固着液滴增减体积法测量接触角滞后的实验过程。它正确地介绍了物理背景，包括相关的无量纲数（毛细数、邦德数）和物理原理（拉普拉斯压力）。该问题具有科学依据，提法明确且客观。因此，可以对所提供的选项进行全面分析。\n\n任务是找出所有准确描述正确实验方案和测量前进接触角与后退接触角的真实系统误差来源的陈述。\n\n**选项A分析**\n该陈述描述了准静态测量方案。前进接触角 $\\theta_A$ 是固着液滴在三相接触线开始向外移动前所能维持的最大角度。后退接触角 $\\theta_R$ 是接触线向内移动前的最小角度。“准静态”过程是指进行得足够缓慢，以至于系统始终接近机械平衡。在流体动力学中，这对应于一个非常低的毛细数，$Ca = \\mu V / \\gamma \\ll 1$，其中 $\\mu$ 是粘度，$V$ 是特征速度，$\\gamma$ 是表面张力。这确保了粘性动态应力与毛细应力相比可以忽略不计。记录在可观测到接触线运动前瞬间的角度，正确地确定了稳定性极限 $\\theta_A$ 和 $\\theta_R$。将注液针头浸入程度最小化对于避免扭曲液滴形状和扰动内部压力场至关重要。每次增加体积后等待松弛，确保测量的轮廓对应于静态平衡形状，而非瞬态形状。该陈述准确地描述了标准的、正确的方法。\n**结论：正确。**\n\n**选项B分析**\n该陈述声称快速的体积变化更可取。这从根本上是错误的。快速的体积变化速率对应于高的接触线速度，因此毛细数（$Ca$）也大。在有限的 $Ca$下，测得的角度是*动态*接触角 $\\theta_D$，它显著偏离静态的前进/后退角。对于前进的接触线，$\\theta_D > \\theta_A$；对于后退的接触线，$\\theta_D < \\theta_R$。这些动态效应不会“相互抵消”；它们会引入一个取决于接触线速度的系统性偏差。实验的目的是测量静态极限，因此过程必须是准静态的（$Ca \\to 0$）。虽然快速的速率变化可能会减少总实验时间，从而减少总蒸发损失，但它们会使静态角度的测量无效。\n**结论：不正确。**\n\n**选项C分析**\n该陈述声称首选较大的液滴以最小化邦德数效应。邦德数 $Bo = \\Delta \\rho g R^2 / \\gamma$（其中 $R$ 是一个特征横向尺寸，如基底半径）量化了重力相对于表面张力的影响。毛细长度为 $l_c = \\sqrt{\\gamma / (\\Delta \\rho g)}$，因此 $Bo = (R/l_c)^2$。大的邦德数（$Bo \\gg 1$）发生在大液滴（$R \\gg l_c$）的情况下，表示重力占主导地位，导致显著的液滴扁平化。这种变形使得从轮廓中提取接触角变得复杂，因为轮廓不再是一个简单的球冠。为了最小化重力偏差并简化分析，应使用小液滴，使得 $Bo \\ll 1$（即 $R \\ll l_c$）。该陈述提出了相反且不正确的建议。\n**结论：不正确。**\n\n**选项D分析**\n接触角滞后，即差值 $\\Delta\\theta = \\theta_A - \\theta_R$，是固体表面物理和化学非均匀性的直接结果。这些缺陷，如微观粗糙度或污染斑块，会产生局部能量势垒，从而“钉扎”住接触线。更强或更多的钉扎点需要液体界面产生更大的变形（从而需要接触角从平衡Young角 $\\theta_Y$ 产生更大的变化）来提供克服势垒所需的力。因此，不受控制的污染或粗糙度会增加钉扎力，并导致测得的滞后现象被虚假地放大。因此，不充分的表面清洁和表征可能导致对目标清洁基底材料固有的滞后现象的严重高估。\n**结论：正确。**\n\n**选项E分析**\n液体的蒸发构成了一种不受控制的负体积通量 $\\dot{V}_{evap}$。这个过程会对测量产生偏差。在后退测量期间，蒸发会叠加在指令性的体积抽取速率上，导致接触线比预期更快地后退。这种动态效应导致测得的角度小于真实的静态后退角 $\\theta_R$。在前进测量期间，蒸发与指令性的体积增加相抗衡。为了引发接触线前进，实验者可能会增加泵送速率以克服蒸发损失。这种较高的有效流速可能导致动态过冲，即测得的角度大于真实的静态前进角 $\\theta_A$。因此，蒸发可能使 $\\theta_R$ 偏小，使 $\\theta_A$ 偏大。为了获得准确的结果，必须缓解蒸发，例如在充满液体饱和蒸汽的环境箱中进行实验，或主动补偿蒸发通量。\n**结论：正确。**\n\n**选项F分析**\n该陈述在多个方面都是不正确的。前进接触角是一个明确定义的材料属性，可以在完全水平的基底上使用增减体积法进行测量，如问题所述。倾斜基底是*另一种*测量技术（斜板法）的基础，在该方法中，是重力而非体积变化驱动接触线。在增减体积实验中引入倾斜是一个误差来源，因为它破坏了液滴的轴对称性，并对接触角施加了重力偏差，该偏差将沿接触线周长变化。它不会减少偏差，反而会引入偏差。\n**结论：不正确。**\n\n**选项G分析**\n该陈述声称浸没的针头不会干扰测量。这是错误的。针头是一个会扭曲液滴形状的物理对象。它会产生自己的弯液面，并局部地改变界面曲率。根据Young-Laplace方程 $\\Delta P = \\gamma (\\kappa_1 + \\kappa_2)$，曲率 $\\kappa$ 的变化导致内部压力 $\\Delta P$ 的变化。这种压力扰动会传播至整个液滴，并改变基底上三相接触线处的力平衡，从而系统性地影响测得的接触角。这种效应是众所周知的系统误差来源，严谨的实验者会竭尽全力减小它，例如使用非常细的针头并在测量前将其从液滴顶点撤出，或确保最小化浸没，如选项A所述。\n**结论：不正确。**\n\n**选项H分析**\n该陈述正确地指出了液滴轮廓光学测量中的几个关键系统误差来源。接触角不是直接测量的，而是从液滴的图像中提取的。\n- **光学视差和透镜畸变**会扭曲图像，导致不正确的角度计算。\n- **基线识别误差**（错误识别代表固体表面的线）会直接转化为测量角度的误差。\n所提议的缓解技术是定量成像和计量学中的标准最佳实践：使用高质量、经过校正的光学系统（如远心镜头），进行仔细的系统校准，确保相机的精确对准，以及采用稳健、经过验证的图像分析算法进行边缘和基线检测。\n**结论：正确。**\n\n**选项I分析**\n该陈述建议使用高毛细数（$Ca \\sim 1$ 或更大）。正如在对选项B的分析中所解释的，这与正确程序恰恰相反。高的 $Ca$ 值意味着系统由粘性力主导，并且远离平衡。这测量的是一个*动态*接触角，它是速度的函数，而不是所期望的*准静态*前进角或后退角。实验的目标是分离出静态钉扎的影响，这要求通过在 $Ca \\to 0$ 的极限下操作来最小化动态影响。大的 $Ca$ 不会“提高准确性”；它测量的是一个完全不同的物理量。\n**结论：不正确。**\n\n**选项J分析**\n大多数液体的表面张力是温度的函数，即 $\\gamma(T)$。沿液滴表面的温度梯度 $\\nabla T$ 会产生表面张力梯度 $\\nabla \\gamma$。该梯度在界面上起切向应力的作用，驱动称为温差毛细流或Marangoni流的流体流动。这种流动可以移动接触线或改变液滴形状，而这与受控的体积变化无关，从而为测量的接触角引入显著偏差。因此，为基底、液滴和周围环境维持等温条件对于准确无偏的测量至关重要。\n**结论：正确。**\n\n**总结**\n共同提供了正确方案的准确描述和真实系统误差的有效列举的陈述是A、D、E、H和J。", "answer": "$$\\boxed{ADEHJ}$$", "id": "2766985"}, {"introduction": "我们已经通过力平衡和实验设计的视角探索了滞后现象，现在让我们运用强大的计算方法，深入探究其根本起源。本练习通过应用热力学的核心原理——系统总是趋向于使其总自由能最小化——来模拟液滴在化学非均相表面上的行为 [@problem_id:2766991]。通过编写程序来计算和最小化能量泛函，您将直接观察到表面化学性质的微观变化如何创造出一个能量景观来“钉扎”接触线，从而产生我们定义为接触角滞后的表观接触角范围。", "problem": "您必须编写一个完整、可运行的程序，该程序模拟类似于 Surface Evolver 的能量最小化过程，用于处理化学非均相基底上的附着液滴，并计算当液滴足迹滑过一个周期性分段常数基底能量图时表观接触角的变化范围。请在以下基于物理的模型和假设内进行工作。\n\n一个固定体积为 $V$ 的小型轴对称液滴静置在水平、刚性、平面的基底上。重力可忽略不计，即邦德数 (Bond number) $Bo = \\rho g R^{2}/\\gamma_{lv}$ 假定很小，因此液-汽界面为球冠状，其表观接触角为 $\\theta$，接触半径为 $a$。单位面积的界面能分别为液-汽界面的 $\\gamma_{lv}$、固-液界面的 $\\gamma_{sl}(x)$ 和固-汽界面的 $\\gamma_{sv}(x)$。基底仅在 $x$ 方向上是化学非均相的，在 $y$ 方向上是均一的。通过杨氏方程 (Young's relation) $\\gamma_{lv} \\cos \\theta_{Y}(x) = \\gamma_{sv}(x) - \\gamma_{sl}(x)$ 定义局部杨氏接触角 (Young contact angle) $\\theta_{Y}(x)$。\n\n采用以下能量泛函\n$$\nE(\\theta, s) = \\gamma_{lv} A_{lv}(\\theta) + \\iint_{A(\\theta,s)} \\left[\\gamma_{sl}(x) - \\gamma_{sv}(x)\\right] \\, dA,\n$$\n其中 $A_{lv}(\\theta)$ 是球冠状液-汽界面的面积，$A(\\theta, s)$ 是半径为 $a(\\theta)$、中心位于 $x=s$ 的圆形湿润区域（液滴足迹）的面积。使用 $\\cos \\theta_{Y}(x) = \\left[\\gamma_{sv}(x) - \\gamma_{sl}(x)\\right]/\\gamma_{lv}$，在相差一个加性常数的情况下，该能量泛函可以写成无量纲形式\n$$\n\\tilde{E}(\\theta, s) = \\frac{E(\\theta, s)}{\\gamma_{lv}} = A_{lv}(\\theta) - \\iint_{A(\\theta,s)} \\cos \\theta_{Y}(x) \\, dA.\n$$\n\n您必须通过在固定体积 $V$ 的条件下，对每个基底平移量 $s$（在一个空间周期内）最小化 $\\tilde{E}(\\theta, s)$ 关于 $\\theta$ 的值，来计算表观接触角 $\\theta_{\\text{app}}(s)$。利用体积约束下的球冠几何形状来消除除 $\\theta$ 之外的所有自由度。球冠几何形状提供了以下关系，您必须在解决方案中从第一性原理推导这些关系，然后在程序中实现它们：\n- 在固定体积 $V$ 下，接触半径 $a(\\theta)$ 作为 $\\theta$ 的函数。\n- 在固定体积 $V$ 下，球冠的液-汽表面积 $A_{lv}(\\theta)$。\n- 液滴足迹是半径为 $a(\\theta)$ 的圆形区域。\n\n基底的非均相性表现为沿 $x$ 方向上 $\\cos \\theta_Y(x)$ 的周期性、分段常数的图谱，该图谱由 $N$ 个垂直条纹（沿 $y$ 方向恒定）组成一个基本周期，每个条纹宽度为 $w$，其值为 $\\{\\cos\\theta_{Y,0}, \\cos\\theta_{Y,1}, \\dots, \\cos\\theta_{Y,N-1}\\}$，并以周期 $L = N w$ 周期性重复。对于给定的 $(\\theta, s)$，积分 $\\iint_{A(\\theta,s)} \\cos \\theta_{Y}(x)\\, dA$ 可简化为圆形足迹与每个条纹 $x \\in [jw, (j+1)w)$ 的重叠区域面积之和，每个面积都由相应条纹的 $\\cos \\theta_{Y}$ 值（按模 $N$ 周期性索引）加权。一个半径为 $a$、中心在 $x=s$ 的圆与一个垂直带 $[x_1,x_2)$ 相交的精确重叠面积，可以通过对弦长 $2\\sqrt{a^2-(x-s)^2}$ 在 $x \\in [x_1,x_2)$ 与 $[s-a, s+a]$ 的交集上积分得到。您的程序必须使用 $\\sqrt{a^2-u^2}$ 的反导数解析地计算这个积分，而不是通过网格采样。\n\n角度单位要求：最终输出中的所有角度必须以度 (degrees) 表示。您的内部计算可以使用弧度 (radians)。\n\n对于下方的每个测试用例，使用 $M = 181$ 个在 $[0, L)$ 中的等距样本，在一个周期 $L$ 上均匀扫描 $s$。对于每个 $s$，在固定体积 $V$ 的条件下，在 $\\theta \\in [\\theta_{\\min}, \\theta_{\\max}]$ （其中 $\\theta_{\\min} = 5^\\circ$ 且 $\\theta_{\\max} = 175^\\circ$）范围内最小化 $\\tilde{E}(\\theta, s)$。对于每个测试用例，返回在 $s \\in [0,L)$ 范围内 $\\theta_{\\text{app}}(s)$ 的最小值和最大值，以度为单位，每个值都四舍五入到三位小数。\n\n物理和数值参数如下（请精确使用给定值）：\n- 表面张力：$\\gamma_{lv} = 0.072 \\ \\text{N}\\,\\text{m}^{-1}$。\n- 最小化域：$\\theta \\in [5^\\circ, 175^\\circ]$。\n- 扫描分辨率：在一个周期 $L$ 上对 $s$ 进行 $M = 181$ 次采样。\n- 单位：宽度 $w$ 和体积 $V$ 的单位分别为 $\\text{m}$ 和 $\\text{m}^3$。最终报告输出中的角度必须以度为单位。\n\n测试套件：\n1. 均匀基底（基准，预计无滞后）：\n   - $V = 1.0 \\times 10^{-10} \\ \\text{m}^{3}$，$w = 1.0 \\times 10^{-4} \\ \\text{m}$，$N=1$，$\\cos\\theta_{Y,0} = \\cos(100^\\circ)$。\n\n2. 双条纹中等非均相性及中等足迹：\n   - $V = 1.0 \\times 10^{-10} \\ \\text{m}^{3}$，$w = 1.0 \\times 10^{-4} \\ \\text{m}$，$N=2$，$(\\cos\\theta_{Y,0}, \\cos\\theta_{Y,1}) = (\\cos(80^\\circ), \\cos(100^\\circ))$。\n\n3. 双条纹强对比度及较大足迹：\n   - $V = 2.0 \\times 10^{-10} \\ \\text{m}^{3}$，$w = 2.0 \\times 10^{-4} \\ \\text{m}$，$N=2$，$(\\cos\\theta_{Y,0}, \\cos\\theta_{Y,1}) = (\\cos(60^\\circ), \\cos(120^\\circ))$。\n\n4. 双条纹细尺度非均相性（足迹跨越多个条纹；接近平均极限）：\n   - $V = 1.0 \\times 10^{-10} \\ \\text{m}^{3}$，$w = 2.0 \\times 10^{-6} \\ \\text{m}$，$N=2$，$(\\cos\\theta_{Y,0}, \\cos\\theta_{Y,1}) = (\\cos(80^\\circ), \\cos(100^\\circ))$。\n\n计算和输出要求：\n- 使用 $u=x-s$ 时 $\\sqrt{a^2 - u^2}$ 的反导数，解析地实现精确的圆-条纹重叠积分。\n- 对于每个 $s$，在固定 $V$ 的条件下，对 $\\theta$ 进行能量最小化。搜索边界必须是 $\\theta \\in [5^\\circ, 175^\\circ]$。\n- 对于每个测试用例，报告一个双元素列表 $[\\min_s \\theta_{\\text{app}}(s), \\max_s \\theta_{\\text{app}}(s)]$，以度为单位，每个值四舍五入到三位小数。\n- 最终输出格式：您的程序应生成单行输出，其中包含四个测试用例的结果，格式为一个由逗号分隔的四个双元素列表组成的列表，用方括号括起来，不含空格（例如：\"[[a,b],[c,d],[e,f],[g,h]]\"）。\n\n无需用户输入。程序必须能够直接运行，并且只打印所需的单行内容。", "solution": "该问题被评估为有效。这是一个在计算表面科学领域中提法正确、科学上合理的问题，没有矛盾或歧义。我们开始提供解决方案。\n\n问题的核心是通过最小化其总自由能，来确定化学非均相表面上附着液滴的平衡表观接触角 $\\theta_{\\text{app}}$。液滴的位置，由其中心坐标 $s$ 表示，在表面化学图案的一个周期内被系统地改变。由此产生的平衡角范围 $[\\min_s \\theta_{\\text{app}}(s), \\max_s \\theta_{\\text{app}}(s)]$ 定义了接触角滞后。\n\n**1. 恒定体积下的球冠几何学**\n\n我们假设液滴体积 $V$ 恒定，其液-汽界面形成一个球冠，这对于重力效应可以忽略不计的小液滴来说是一个有效的近似。球冠的几何形状由其接触角 $\\theta$ 和切割出该球冠的球体半径 $R_{\\text{sph}}$ 定义。\n\n球冠的体积 $V$ 由以下公式给出：\n$$ V = \\frac{\\pi}{3} h^2 (3R_{\\text{sph}} - h) $$\n其中 $h$ 是球冠的高度。高度和接触半径 $a$ 与 $R_{\\text{sph}}$ 和 $\\theta$ 的关系为 $h = R_{\\text{sph}}(1 - \\cos\\theta)$ 和 $a = R_{\\text{sph}}\\sin\\theta$。将以 $R_{\\text{sph}}$ 和 $\\theta$ 表示的 $h$ 代入体积方程，得到：\n$$ V = \\frac{\\pi}{3} R_{\\text{sph}}^3 (1 - \\cos\\theta)^2 (2 + \\cos\\theta) $$\n由于体积 $V$ 是固定的，我们可以将 $R_{\\text{sph}}$ 表示为 $\\theta$ 的函数：\n$$ R_{\\text{sph}}(\\theta, V) = \\left( \\frac{3V}{\\pi (1 - \\cos\\theta)^2 (2 + \\cos\\theta)} \\right)^{1/3} $$\n这个基本关系使得我们能够对于一个固定的 $V$，将所有其他几何量表示为 $\\theta$ 的函数。\n\n接触半径 $a$ 则为：\n$$ a(\\theta, V) = R_{\\text{sph}}(\\theta, V) \\sin\\theta $$\n液-汽界面的表面积 $A_{lv}$ 为：\n$$ A_{lv}(\\theta, V) = 2\\pi R_{\\text{sph}}(\\theta, V)^2 (1 - \\cos\\theta) $$\n这些导出的函数 $a(\\theta, V)$ 和 $A_{lv}(\\theta, V)$ 对于构建能量泛函至关重要。\n\n**2. 能量泛函**\n\n系统的总自由能，在相差一个加性常数的情况下，可以如问题陈述中所给出的那样，用无量纲形式 $\\tilde{E}$ 表示：\n$$ \\tilde{E}(\\theta, s) = A_{lv}(\\theta) - \\iint_{A(\\theta,s)} \\cos \\theta_{Y}(x) \\, dA $$\n这里，$\\theta$ 是表观接触角，$s$ 是液滴中心的横向位置。$A_{lv}(\\theta)$ 是上面推导出的液-汽表面积。第二项代表基底相互作用能，它是在半径为 $a(\\theta)$、中心位于 $x=s$ 的圆形液滴足迹 $A(\\theta,s)$ 上积分得到的。局部润湿性由局部杨氏接触角的余弦值 $\\cos \\theta_{Y}(x)$ 来表征。\n\n**3. 基底相互作用能计算**\n\n基底由 $N$ 个宽度为 $w$ 的垂直条纹构成图案，该图案以周期 $L=Nw$ 周期性重复。在每个条纹内部，$\\cos\\theta_Y(x)$ 是常数。因此，基底相互作用能的积分变成了对与液滴足迹重叠的条纹的求和：\n$$ \\iint_{A(\\theta,s)} \\cos \\theta_{Y}(x) \\, dA = \\sum_{j} (\\cos \\theta_{Y, j \\pmod N}) \\cdot \\text{Area}(j) $$\n其中 $\\text{Area}(j)$ 是圆形足迹与位于 $x \\in [jw, (j+1)w)$ 的第 $j$ 个条纹之间的重叠面积。\n\n对于由 $x \\in [x_1, x_2)$ 定义的单个条纹，其重叠面积是通过对圆的弦长 $2\\sqrt{a^2 - (x-s)^2}$ 在 $[x_1, x_2)$ 与液滴的x跨度 $[s-a, s+a]$ 的交集上对 $x$ 积分来计算的。令 $u = x-s$。面积为：\n$$ \\text{Area} = \\int_{u_1}^{u_2} 2\\sqrt{a^2 - u^2} \\, du $$\n其中积分限 $u_1$ 和 $u_2$ 由相对于圆心的条纹边界确定，并被裁剪到区间 $[-a, a]$ 内。该积分的解析计算依赖于 $2\\sqrt{a^2 - u^2}$ 的反导数，即 $G(u, a) = u\\sqrt{a^2 - u^2} + a^2\\arcsin(u/a)$。然后，定积分计算为 $G(u_2, a) - G(u_1, a)$。\n\n**4. 能量最小化过程**\n\n对于每个测试用例，通过实现以下算法来找到解决方案：\n1.  定义系统参数：液滴体积 $V$、条纹宽度 $w$、每个周期的条纹数 $N$ 以及 $\\cos\\theta_Y$ 值的集合。扫描分辨率固定为 $M=181$ 个点。\n2.  在一个周期 $L=Nw$ 上生成一个由 $M$ 个液滴中心位置 $s_k$ 组成的均匀网格，其中 $s_k \\in [0, L)$。\n3.  对于每个位置 $s_k$：\n    a. 构造目标函数 $f(\\theta) = \\tilde{E}(\\theta, s_k)$。\n    b. 在指定的范围 $\\theta \\in [5^\\circ, 175^\\circ]$ 内，数值求解使 $f(\\theta)$ 最小化的角度 $\\theta_{\\text{app}}(s_k)$。这可以通过有界标量最小化算法来执行，例如 SciPy 的 `minimize_scalar` 函数提供的算法。\n4.  扫描完所有 $s_k$ 后，收集所有表观接触角组成的集合 $\\{\\theta_{\\text{app}}(s_k)\\}$。\n5.  测试用例的最终结果是该集合中的最小值和最大值 $[\\min_k \\theta_{\\text{app}}(s_k), \\max_k \\theta_{\\text{app}}(s_k)]$，以度为单位表示并四舍五入到三位小数。这个范围代表接触角滞后。\n\n这个综合性的过程能够精确模拟液滴在非均相表面上的行为，并量化由此产生的滞后，正如在所提供的程序中实现的那样。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Main function to emulate a Surface Evolver-like energy minimization for a sessile droplet\n    on a chemically heterogeneous substrate, computing the range of apparent contact angles.\n    The function runs a suite of test cases and prints the results in the specified format.\n    \"\"\"\n    \n    # Global constants as per problem statement\n    PI = np.pi\n    THETA_MIN_DEG = 5.0\n    THETA_MAX_DEG = 175.0\n    THETA_MIN_RAD = np.deg2rad(THETA_MIN_DEG)\n    THETA_MAX_RAD = np.deg2rad(THETA_MAX_DEG)\n    M = 181\n\n    def get_geometric_params(theta, V):\n        \"\"\"\n        Calculates the contact radius 'a' and liquid-vapor surface area 'Alv'\n        for a spherical cap of a given volume V and contact angle theta (in radians).\n        \"\"\"\n        # Handle edge cases near 0 and pi to avoid numerical instability\n        if theta < 1e-9 or theta > PI - 1e-9:\n            if theta < 1e-9:  # Droplet flattens, a -> inf\n                return float('inf'), float('inf')\n            # Droplet becomes a sphere, a -> 0\n            R_sphere = (3.0 * V / (4.0 * PI))**(1.0/3.0)\n            return 0.0, 4.0 * PI * R_sphere**2\n\n        cos_t = np.cos(theta)\n        # The factor in the volume formula: (1 - cos(theta))^2 * (2 + cos(theta))\n        vol_factor = (1.0 - cos_t)**2 * (2.0 + cos_t)\n        \n        if vol_factor < 1e-30: # Avoid division by zero for theta -> 0\n            return float('inf'), float('inf')\n\n        R_sph_cubed = 3.0 * V / (PI * vol_factor)\n        R_sph = R_sph_cubed**(1.0/3.0)\n        \n        a = R_sph * np.sin(theta)\n        Alv = 2.0 * PI * R_sph**2 * (1.0 - cos_t)\n        \n        return a, Alv\n\n    def G_antiderivative(u, a):\n        \"\"\"\n        Computes the antiderivative of 2*sqrt(a^2 - u^2), which is u*sqrt(a^2-u^2) + a^2*arcsin(u/a).\n        This is used to calculate the overlap area between the circular footprint and a vertical stripe.\n        \"\"\"\n        # Clamp u to the domain [-a, a] to prevent floating point errors in sqrt and arcsin\n        u = np.clip(u, -a, a)\n        \n        term1 = u * np.sqrt(a**2 - u**2)\n        term2 = a**2 * np.arcsin(u / a)\n        return term1 + term2\n\n    def calculate_overlap_area(a, s, x_start, x_end):\n        \"\"\"\n        Calculates the area of intersection between a circle of radius 'a' centered at x='s'\n        and a vertical stripe defined by the interval [x_start, x_end).\n        \"\"\"\n        if a <= 1e-12:\n            return 0.0\n        \n        # Transform stripe boundaries into circle's coordinate system\n        u_start_raw = x_start - s\n        u_end_raw = x_end - s\n        \n        # Clip integration limits to the circle's x-span [-a, a]\n        u1 = max(-a, u_start_raw)\n        u2 = min(a, u_end_raw)\n        \n        if u1 >= u2:\n            return 0.0\n        \n        # The area is the definite integral of the chord length, 2*sqrt(a^2 - (x-s)^2)\n        area = G_antiderivative(u2, a) - G_antiderivative(u1, a)\n        return area\n\n    def total_energy(theta, s, V, w, N, cos_theta_Y_values):\n        \"\"\"\n        Calculates the total dimensionless energy E_tilde for a given contact angle theta\n        and droplet center position s.\n        \"\"\"\n        # 1. Get geometric parameters from theta and fixed volume V\n        a, Alv = get_geometric_params(theta, V)\n        if np.isinf(a):\n            return float('inf')\n\n        # 2. Calculate the substrate interaction energy term (integral over the footprint)\n        substrate_integral = 0.0\n        \n        # Determine the range of stripes covered by the droplet footprint\n        x_min_drop = s - a\n        x_max_drop = s + a\n        \n        j_min = int(np.floor(x_min_drop / w))\n        j_max = int(np.floor(x_max_drop / w))\n        \n        # Sum up the energy contribution from each covered stripe\n        for j in range(j_min, j_max + 1):\n            x_strip_start = j * w\n            x_strip_end = (j + 1) * w\n            \n            # Calculate the area of the circular footprint overlapping with the current stripe\n            overlap = calculate_overlap_area(a, s, x_strip_start, x_strip_end)\n            \n            # Get the corresponding cos(theta_Y) value, applying periodicity\n            cos_val = cos_theta_Y_values[j % N]\n            \n            substrate_integral += cos_val * overlap\n            \n        # Total dimensionless energy: E_tilde = Alv - substrate_integral\n        return Alv - substrate_integral\n\n    # Define the test suite as specified in the problem\n    test_cases = [\n        {'V': 1.0e-10, 'w': 1.0e-4, 'N': 1, 'cos_theta_Y': [np.cos(np.deg2rad(100.0))]},\n        {'V': 1.0e-10, 'w': 1.0e-4, 'N': 2, 'cos_theta_Y': [np.cos(np.deg2rad(80.0)), np.cos(np.deg2rad(100.0))]},\n        {'V': 2.0e-10, 'w': 2.0e-4, 'N': 2, 'cos_theta_Y': [np.cos(np.deg2rad(60.0)), np.cos(np.deg2rad(120.0))]},\n        {'V': 1.0e-10, 'w': 2.0e-6, 'N': 2, 'cos_theta_Y': [np.cos(np.deg2rad(80.0)), np.cos(np.deg2rad(100.0))]},\n    ]\n\n    all_results = []\n    \n    # Process each test case\n    for case in test_cases:\n        V = case['V']\n        w = case['w']\n        N = case['N']\n        cos_theta_Y_values = case['cos_theta_Y']\n        \n        L = N * w\n        s_values = np.linspace(0, L, M, endpoint=False)\n        \n        apparent_angles_rad = []\n        \n        # Scan droplet position s over one period\n        for s in s_values:\n            energy_func = lambda theta: total_energy(theta, s, V, w, N, cos_theta_Y_values)\n            \n            # Minimize energy to find the apparent contact angle for this s\n            result = minimize_scalar(\n                energy_func,\n                bounds=(THETA_MIN_RAD, THETA_MAX_RAD),\n                method='bounded'\n            )\n            \n            if result.success:\n                apparent_angles_rad.append(result.x)\n        \n        # Find min and max apparent angles (hysteresis range) and convert to degrees\n        min_theta_deg = np.rad2deg(min(apparent_angles_rad))\n        max_theta_deg = np.rad2deg(max(apparent_angles_rad))\n        \n        # Round to three decimal places and store\n        all_results.append([round(min_theta_deg, 3), round(max_theta_deg, 3)])\n    \n    # Format the final output string as specified: \"[[a,b],[c,d],...]\"\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2766991"}]}