{"hands_on_practices": [{"introduction": "理解一个物理方程的最好方式莫过于从第一性原理出发亲自推导它。本练习将引导你从吉布斯自由能的基本定义出发，推导出核心的吉布斯吸附等温线方程。这项实践不仅能巩固你的热力学基础，还能通过一个实际的计算和物理合理性分析，让你深刻体会宏观表面张力变化如何量化地反映界面处的分子富集程度。[@problem_id:2793422]", "problem": "一种非离子两亲分子低浓度溶解于水中，并吸附到宏观平坦的水-空气界面上。考虑在恒定温度和压力下的界面热力学。从包含界面对总自由能贡献的体系 Gibbs 自由能的基本定义出发，并利用 Gibbs 分离面和表面超量的概念，推导连接界面张力 $\\,\\gamma\\,$ 的增量变化与各组分的表面超量 $\\,\\Gamma_i\\,$ 及化学势 $\\,\\mu_i\\,$ 的表面 Gibbs–Duhem 关系。然后，将该关系特化至理想稀溶液中的单一溶质情况，选择分离面使得溶剂的表面超量为零，并将溶质表面超量 $\\,\\Gamma\\,$ 表示为斜率 $\\,\\partial \\gamma / \\partial \\ln a\\,$ 的函数，其中 $\\,a\\,$ 是溶质活度。\n\n在 $\\,T = 300\\ \\text{K}\\,$ 下的一项实验发现，当溶质活度 $\\,a\\,$ 增加一个数量级时，界面张力 $\\,\\gamma\\,$ 下降 $\\,30\\ \\text{mN}\\ \\text{m}^{-1}\\,$。使用您推导的关系式，估算溶质表面超量 $\\,\\Gamma\\,$ 的数量级。使用 $\\,R = 8.314\\ \\text{J mol}^{-1}\\ \\text{K}^{-1}\\,$。将报告的变化近似为该数量级范围内的增量斜率，即近似 $\\,\\partial \\gamma / \\partial \\ln a \\approx \\Delta \\gamma / \\Delta \\ln a\\,$，其中 $\\,\\Delta \\ln a = \\ln 10\\,$。\n\n最后，通过估算相应的分子面积 $\\,A = 1/(\\Gamma N_A)\\,$（使用 $\\,N_A = 6.022 \\times 10^{23}\\ \\text{mol}^{-1}\\,$）来评估您所得到数值的物理合理性，并评论 $\\,A\\,$ 是否与界面上小两亲分子紧密堆积的头基横截面积处于同一数量级。您的数值计算任务仅为确定 $\\,\\Gamma\\,$。将 $\\,\\Gamma\\,$ 的最终数值答案四舍五入至三位有效数字，并以 $\\text{mol}\\ \\text{m}^{-2}$ 为单位表示。", "solution": "对问题陈述进行严格验证。\n\n**步骤1：提取给定条件**\n- 体系：一种非离子两亲分子低浓度溶解于水中，吸附到平坦的水-空气界面。\n- 条件：恒定温度 $T$ 和压力 $P$。\n- 任务1：从 Gibbs 自由能的基本定义出发，推导连接 $d\\gamma$ 与 $\\Gamma_i$ 和 $\\mu_i$ 的表面 Gibbs–Duhem 关系。\n- 任务2：特化到理想稀溶液中的单一溶质，选择 Gibbs 分离面使得溶剂的表面超量为零。\n- 任务3：用斜率 $\\partial \\gamma / \\partial \\ln a$ 表示溶质表面超量 $\\Gamma$，其中 $a$ 为溶质活度。\n- 实验数据：\n  - 温度：$T = 300 \\text{ K}$。\n  - 界面张力变化：当溶质活度 $a$ 增加一个数量级时，$\\Delta\\gamma = -30 \\text{ mN m}^{-1}$。\n  - 近似：$\\partial \\gamma / \\partial \\ln a \\approx \\Delta \\gamma / \\Delta \\ln a$。\n  - 活度的对数变化：$\\Delta \\ln a = \\ln(10)$。\n  - 常数：$R = 8.314 \\text{ J mol}^{-1} \\text{K}^{-1}$，$N_A = 6.022 \\times 10^{23} \\text{ mol}^{-1}$。\n- 任务4：估算溶质表面超量 $\\Gamma$ 的数量级。\n- 任务5：通过估算分子面积 $A = 1/(\\Gamma N_A)$ 来评估结果的物理合理性。\n- 最终答案要求：计算 $\\Gamma$ 并四舍五入到三位有效数字，单位为 $\\text{mol m}^{-2}$。\n\n**步骤2：使用提取的给定条件进行验证**\n- **科学依据：** 该问题基于经典的 Gibbs 吸附等温线，这是表面热力学的基石。所有概念，包括 Gibbs 自由能、表面超量、化学势和活度，都是标准且定义明确的。这在科学上是合理的。\n- **提问得当：** 问题提供了一系列清晰的任务：推导、特化和数值计算。所有必要的数据和常数都已提供。其结构导向一个唯一且有意义的解。\n- **客观性：** 语言正式、精确，且无主观论断。\n- **完整性与一致性：** 问题是自洽的。提供的数据在量纲上一致且对界面上的两亲分子来说是物理上现实的（表面活性剂会降低表面张力）。不存在矛盾。\n\n**步骤3：结论与行动**\n该问题是有效的，因为它具有科学依据、提问得当、客观且自洽。将提供解决方案。\n\n对于一个包含两个体相 $\\alpha$ 和 $\\beta$ 以及一个界面 $\\sigma$ 的体系，其总 Gibbs 自由能 $G$ 是一个广延量。它可以表示为其组成部分之和。然而，为了定义表面性质，我们考虑整个体系的总能量 $G$。其微分由基本热力学关系给出：\n$$dG = -S dT + V dP + \\sum_i \\mu_i dn_i + \\gamma dA$$\n其中 $S$ 是总熵，$T$ 是温度，$V$ 是总容积，$P$ 是压力，$\\mu_i$ 是组分 $i$ 的化学势，$n_i$ 是组分 $i$ 的总摩尔数，$\\gamma$ 是界面张力，$A$ 是界面面积。\n\n根据关于齐次函数的 Euler 定理，Gibbs 自由能也由 $G = \\sum_i \\mu_i n_i$ 给出。此表达式的全微分是：\n$$dG = \\sum_i \\mu_i dn_i + \\sum_i n_i d\\mu_i$$\n将两个 $dG$ 的表达式相等，得到整个体系的 Gibbs–Duhem 方程：\n$$-S dT + V dP + \\gamma dA - \\sum_i n_i d\\mu_i = 0$$\n\n为分离出界面的性质，我们引入 Gibbs 分离面和表面超量的概念。体系的任何广延性质 $X$ 都可以写成体相贡献与一个表面超量项 $X^{\\sigma}$ 之和：\n$$X = X^{\\alpha} + X^{\\beta} + X^{\\sigma}$$\n对于组分 $i$ 的摩尔数，我们定义表面超量浓度 $\\Gamma_i$，使得 $n_i^{\\sigma} = A\\Gamma_i$。\n将基本关系应用于表面相本身，我们注意到表面是一个体积为零的概念性平面，因此 $V^{\\sigma}=0$。那么，表面的能量变化为：\n$$dG^{\\sigma} = -S^{\\sigma} dT + \\gamma dA + \\sum_i \\mu_i dn_i^{\\sigma}$$\n表面 Gibbs 能量 $G^{\\sigma}$ 也是表面相的一个广延性质，由 $G^{\\sigma} = \\gamma A + \\sum_i \\mu_i n_i^{\\sigma}$ 给出。它的全微分是：\n$$dG^{\\sigma} = \\gamma dA + A d\\gamma + \\sum_i \\mu_i dn_i^{\\sigma} + \\sum_i n_i^{\\sigma} d\\mu_i$$\n将两个 $dG^{\\sigma}$ 的表达式相等：\n$$-S^{\\sigma} dT + \\gamma dA + \\sum_i \\mu_i dn_i^{\\sigma} = \\gamma dA + A d\\gamma + \\sum_i \\mu_i dn_i^{\\sigma} + \\sum_i n_i^{\\sigma} d\\mu_i$$\n简化此方程得到：\n$$-S^{\\sigma} dT = A d\\gamma + \\sum_i n_i^{\\sigma} d\\mu_i$$\n两边同除以面积 $A$，并将单位面积的表面超量熵定义为 $S_s = S^{\\sigma}/A$，表面超量浓度定义为 $\\Gamma_i = n_i^{\\sigma}/A$，我们得到 Gibbs 吸附方程的一般形式：\n$$d\\gamma = -S_s dT - \\sum_i \\Gamma_i d\\mu_i$$\n在恒温（$dT=0$）下，这简化为所要求的表面 Gibbs–Duhem 关系：\n$$d\\gamma = -\\sum_i \\Gamma_i d\\mu_i$$\n该关系将界面张力的变化与所有组分的表面超量和化学势联系起来。\n\n接下来，我们将其特化到双组分体系：溶剂（组分1）和单一溶质（组分2）。方程变为：\n$$d\\gamma = -\\Gamma_1 d\\mu_1 - \\Gamma_2 d\\mu_2$$\n表面超量 $\\Gamma_i$ 取决于 Gibbs 分离面的位置。根据题目要求，我们为稀溶液做出常规选择，即放置分离面使得溶剂的表面超量为零，即 $\\Gamma_1 = 0$。在此选择下，方程得到显著简化。我们将溶质记为组分2，并为简便起见，省略下标：\n$$d\\gamma = -\\Gamma d\\mu$$\n理想稀溶液中溶质的化学势 $\\mu$ 通过以下表达式与其活度 $a$ 相关：\n$$\\mu = \\mu^{\\circ} + RT \\ln a$$\n其中 $\\mu^{\\circ}$ 是标准态化学势，$R$ 是理想气体常数，$T$ 是绝对温度。在恒温下，$\\mu$ 的微分是：\n$$d\\mu = RT \\, d(\\ln a)$$\n将此代入简化的 Gibbs 方程：\n$$d\\gamma = -\\Gamma (RT \\, d(\\ln a))$$\n将此式重排以求解溶质表面超量 $\\Gamma$，得到最常见形式的 Gibbs 吸附等温线：\n$$\\Gamma = -\\frac{1}{RT} \\left(\\frac{\\partial\\gamma}{\\partial \\ln a}\\right)_T$$\n这就是所要求的表达式。\n\n现在我们进行数值计算。给定数据如下：\n$T = 300 \\text{ K}$\n$R = 8.314 \\text{ J mol}^{-1} \\text{ K}^{-1}$\n$\\Delta\\gamma = -30 \\text{ mN m}^{-1} = -30 \\times 10^{-3} \\text{ N m}^{-1} = -0.030 \\text{ J m}^{-2}$ (因为 $1 \\text{ N m}^{-1} = 1 \\text{ J m}^{-2}$)\n活度增加一个数量级，所以 $a_2 = 10 a_1$。活度的自然对数变化量是 $\\Delta \\ln a = \\ln(a_2) - \\ln(a_1) = \\ln(10a_1) - \\ln(a_1) = \\ln(10)$。\n\n我们使用题目提供的斜率近似值：\n$$\\left(\\frac{\\partial\\gamma}{\\partial \\ln a}\\right)_T \\approx \\frac{\\Delta\\gamma}{\\Delta \\ln a} = \\frac{-0.030 \\text{ J m}^{-2}}{\\ln(10)}$$\n将其代入 $\\Gamma$ 的表达式中：\n$$\\Gamma = -\\frac{1}{RT} \\left(\\frac{\\Delta\\gamma}{\\Delta \\ln a}\\right) = -\\frac{1}{(8.314 \\text{ J mol}^{-1} \\text{ K}^{-1}) \\times (300 \\text{ K})} \\left(\\frac{-0.030 \\text{ J m}^{-2}}{\\ln(10)}\\right)$$\n双重负号被抵消，这对于降低表面张力（$\\Delta\\gamma < 0$）并富集在表面（$\\Gamma > 0$）的物质而言是符合预期的：\n$$\\Gamma = \\frac{0.030 \\text{ J m}^{-2}}{(8.314 \\times 300) \\text{ J mol}^{-1} \\times \\ln(10)}$$\n$$\\Gamma = \\frac{0.030}{2494.2 \\times 2.302585} \\text{ mol m}^{-2}$$\n$$\\Gamma \\approx \\frac{0.030}{5743.1} \\text{ mol m}^{-2} \\approx 5.2236 \\times 10^{-6} \\text{ mol m}^{-2}$$\n四舍五入到三位有效数字，溶质表面超量为：\n$$\\Gamma = 5.22 \\times 10^{-6} \\text{ mol m}^{-2}$$\n\n最后，我们通过计算界面上每个分子的面积 $A$ 来评估此结果的物理合理性。\n$$A = \\frac{1}{\\Gamma N_A}$$\n其中 $N_A = 6.022 \\times 10^{23} \\text{ mol}^{-1}$。\n$$A = \\frac{1}{(5.22 \\times 10^{-6} \\text{ mol m}^{-2}) \\times (6.022 \\times 10^{23} \\text{ mol}^{-1})}$$\n$$A \\approx \\frac{1}{3.143 \\times 10^{18} \\text{ m}^{-2}} \\approx 3.18 \\times 10^{-19} \\text{ m}^2$$\n为将其与典型分子尺寸进行比较，我们将此面积换算为平方埃 ($1 \\text{ Å}^2 = 10^{-20} \\text{ m}^2$):\n$$A \\approx 3.18 \\times 10^{-19} \\text{ m}^2 \\times \\left(\\frac{1 \\text{ Å}^2}{10^{-20} \\text{ m}^2}\\right) = 31.8 \\text{ Å}^2$$\n每个分子约 $32 \\text{ Å}^2$ 的面积是一个非常合理的值。它与小的两亲分子头基区域的横截面积处于同一数量级，这表明在水-空气界面处形成了一个相对致密、紧密堆积的单分子层。这证实了所计算的表面超量具有物理合理性。", "answer": "$$ \\boxed{5.22 \\times 10^{-6}} $$", "id": "2793422"}, {"introduction": "吉布斯吸附等温线不仅是计算表面浓度的工具，更是探测界面微观结构的有力探针。本练习将带你分析一个经典的界面现象——单分子层的二维相变，它在表面张力曲线上表现为一个明显的“拐点”。通过应用吉布斯等温线，你将学会如何从宏观测量数据中提取出不同相态下单分子的占据面积等微观信息，从而理解热力学测量与分子尺度结构之间的深刻联系。[@problem_id:2012400]", "problem": "一项实验研究在恒定绝对温度 $T$ 下探究了一种新型非离子表面活性剂在空气-水界面的单分子层的性质。在某一范围的体相摩尔浓度 $c$ 内，测量了该水溶液的表面张力 $\\gamma$。当数据绘制成 $\\gamma$ 对浓度自然对数 $\\ln(c)$ 的图像时，该图像呈现出两个截然不同的线性区域，并在相变浓度 $c_T$ 处的一个急剧“拐点”相交。这种行为是一级二维相变的特征，其中表面活性剂单分子层从无序的气态转变为更有序的液相凝聚态。\n\n对于略低于相变点的浓度 ($c \\lesssim c_T$)，单分子层处于气态，图像的斜率被测定为 $\\frac{d\\gamma}{d\\ln(c)} = -m_g$。对于略高于相变点的浓度 ($c \\gtrsim c_T$)，单分子层处于液相凝聚态，斜率为 $\\frac{d\\gamma}{d\\ln(c)} = -m_l$。$m_g$ 和 $m_l$ 都是值为正的实验常数。\n\n假设该系统可以被 Gibbs 吸附等温线精确描述，且体相溶液足够稀，使得表面活性剂的活度可以近似为其摩尔浓度。确定在相变点处，气态下单个表面活性剂分子所占的平均面积与液相凝聚态下单个表面活性剂分子所占的平均面积之比。将您的答案用 $m_g$ 和 $m_l$ 的符号表达式表示。", "solution": "在恒定绝对温度下，对于稀的非离子表面活性剂，其组分的 Gibbs 吸附等温线为\n$$\nd\\gamma=-\\Gamma RT\\,d\\ln a,\n$$\n其中 $\\Gamma$ 是表面超量（单位为摩尔每单位面积），$R$ 是气体常数，$T$ 是绝对温度，$a$ 是表面活性剂的活度。在所述的稀溶液假设下，活度近似为摩尔浓度，因此 $a\\approx c$，得到\n$$\n\\frac{d\\gamma}{d\\ln c}=-RT\\,\\Gamma.\n$$\n实验上，对于 $c\\lesssim c_T$（气态），$\\gamma$ 对 $\\ln(c)$ 的斜率为 $-m_g$；对于 $c\\gtrsim c_T$（液相凝聚态），斜率为 $-m_l$。因此，相应的表面超量为\n$$\n\\Gamma_g=\\frac{m_g}{RT},\\qquad \\Gamma_l=\\frac{m_l}{RT}.\n$$\n\n在均匀单分子层中，每个分子的平均面积 $a$ 与表面超量 $\\Gamma$ 的关系为\n$$\na=\\frac{1}{\\Gamma N_{A}},\n$$\n其中 $N_{A}$ 是 Avogadro 常数。因此，对于气态和液相凝聚态，\n$$\na_g=\\frac{1}{\\Gamma_g N_{A}},\\qquad a_l=\\frac{1}{\\Gamma_l N_{A}}.\n$$\n求其比值，并使用相变点两侧测得的斜率进行计算，\n$$\n\\frac{a_g}{a_l}=\\frac{1/(\\Gamma_g N_{A})}{1/(\\Gamma_l N_{A})}=\\frac{\\Gamma_l}{\\Gamma_g}=\\frac{m_l/(RT)}{m_g/(RT)}=\\frac{m_l}{m_g}.\n$$\n因此，平均分子面积之比仅由两相中斜率大小之比决定。", "answer": "$$\\boxed{\\frac{m_l}{m_g}}$$", "id": "2012400"}, {"introduction": "理论公式在应用于真实实验数据时，往往会遇到噪声带来的挑战，对于需要微分运算的吉布斯吸附等温线尤其如此。本练习旨在弥合理论与实践之间的差距，指导你应用一种稳健的计算方法——吉洪诺夫正则化，从充满噪声的表面张力测量数据中稳定地提取所需导数。掌握这项技能，你将能够更准确地从原始实验数据中计算表面过剩浓度，这是现代界面科学研究中一项至关重要的实践能力。[@problem_id:2793461]", "problem": "您正在表面与界面科学及纳米力学领域内，研究在恒定温度下，一种单一、非反应性的稀有溶质在平坦液-汽界面上的吸附行为。在等温条件下，溶质的表面超量（记为 $\\Gamma$）与表面张力 $\\gamma$ 随溶质活度 $a$ 的变化关系，由一个称为吉布斯吸附等温线的基本热力学公式给出：$\\Gamma = -\\dfrac{1}{R T}\\left(\\dfrac{\\partial \\gamma}{\\partial \\ln a}\\right)_{T}$。您的任务是根据带噪声的 $\\gamma(a)$ 测量值，稳定地估计 $\\left(\\dfrac{\\partial \\gamma}{\\partial \\ln a}\\right)_{T}$，并报告在指定活度下的相应 $\\Gamma$ 值。这项挑战本质上是不适定的，因为数值微分会放大噪声；因此，您必须使用一种基于第一性原理的正则化微分策略。\n\n从活度的定义和吉布斯吸附关系式出发，设计一个算法，该算法接收在恒定温度 $T$ 下测得的数据对 $\\{(a_i,\\gamma_i)\\}_{i=1}^n$ 作为输入，并返回在预设活度值下的 $\\Gamma(a)$ 的稳定估计。该设计在数值分析上必须是成体系且完全自洽的：将自变量转换为 $x=\\ln a$，通过求解一个带有曲率惩罚项的线性Tikhonov正则化最小二乘问题来平滑作为 $x$ 函数的测量值 $\\gamma$，然后对平滑后的 $\\gamma(x)$ 关于 $x$ 求导，以获得 $\\left(\\dfrac{\\partial \\gamma}{\\partial \\ln a}\\right)_{T}$。具体来说，实现以下要求：\n\n- 在非均匀网格 $x_i=\\ln a_i$ 上，使用标准的二阶导数三点有限差分格式，构建一个离散二阶导数算子 $L$。对于内部节点 $i\\in\\{2,\\dots,n-1\\}$，定义 $h_0=x_i-x_{i-1}$ 和 $h_1=x_{i+1}-x_i$，并使用行权重 $w_{i-1}=\\dfrac{2}{h_0(h_0+h_1)}$，$w_{i}=-\\dfrac{2}{h_0 h_1}$，$w_{i+1}=\\dfrac{2}{h_1(h_0+h_1)}$ 来组装 $L\\in\\mathbb{R}^{(n-2)\\times n}$，使得对于任意离散场 $g$，$(L g)_i$ 都是 $\\dfrac{d^2 g}{dx^2}(x_i)$ 的一致逼近。\n- 通过求解\n$$\n\\min_{\\tilde{\\gamma}\\in\\mathbb{R}^n}\\ \\|\\tilde{\\gamma}-\\gamma\\|_2^2+\\lambda\\|L\\tilde{\\gamma}\\|_2^2,\n$$\n来估计平滑后的表面张力 $\\tilde{\\gamma}\\in\\mathbb{R}^n$，其中 $\\lambda\\ge 0$ 通过广义交叉验证（GCV）自动选择。使用闭式线性形式 $\\tilde{\\gamma}(\\lambda)=(I+\\lambda L^{\\mathsf T}L)^{-1}\\gamma$ 和 GCV 分数\n$$\n\\mathrm{GCV}(\\lambda)=\\frac{n\\,\\|\\gamma-\\tilde{\\gamma}(\\lambda)\\|_2^2}{\\big(n-\\mathrm{tr}(H(\\lambda))\\big)^2},\\quad H(\\lambda)=(I+\\lambda L^{\\mathsf T}L)^{-1},\n$$\n并在对数尺度上对大范围的 $\\lambda$ 最小化 $\\mathrm{GCV}(\\lambda)$。您的实现必须是数值稳定的，并且不需要任何用户输入。\n- 对平滑曲线 $\\tilde{\\gamma}(x)$ 进行微分，以获得在节点 $x_i$ 上的 $\\dfrac{d\\gamma}{dx}$ 的离散估计。对内部节点使用适用于非均匀网格的三点有限差分近似，对两个边界点使用单边一阶差分。\n- 通过对节点导数在 $x=\\ln a$ 上进行线性插值，计算在请求的活度值处的 $\\left(\\dfrac{\\partial \\gamma}{\\partial \\ln a}\\right)_T=\\dfrac{d\\gamma}{dx}$。\n- 使用公式 $\\Gamma(a)=-\\dfrac{1}{R T}\\left(\\dfrac{\\partial \\gamma}{\\partial \\ln a}\\right)_{T}$ 将导数转换为表面超量，其中 $R=8.314462618\\ \\mathrm{J}/(\\mathrm{mol}\\cdot \\mathrm{K})$，温度 $T$ 为每个测试用例中给出的具体值。$\\Gamma$ 以 $\\mathrm{mol}/\\mathrm{m}^2$ 为单位表示。\n\n您将获得以下三个测试用例。每个测试用例包含一个活度列表 $a_i$（无量纲）、测得的表面张力 $\\gamma_i$（单位为 $\\mathrm{N}/\\mathrm{m}$）、一个温度 $T$（单位为 $\\mathrm{K}$），以及一个用于报告 $\\Gamma$ 的查询活度列表。所有测量都对应于单一溶质在单一等温界面上的情况，并且是带有少量噪声的合理实验数据。\n\n- 测试用例 $1$ (高分辨率网格):\n  - 活度 $a$:\n    [$1.0\\times 10^{-6}$, $1.778\\times 10^{-6}$, $3.162\\times 10^{-6}$, $5.623\\times 10^{-6}$, $1.0\\times 10^{-5}$, $1.778\\times 10^{-5}$, $3.162\\times 10^{-5}$, $5.623\\times 10^{-5}$, $1.0\\times 10^{-4}$, $1.778\\times 10^{-4}$, $3.162\\times 10^{-4}$, $5.623\\times 10^{-4}$, $1.0\\times 10^{-3}$, $1.778\\times 10^{-3}$, $3.162\\times 10^{-3}$, $5.623\\times 10^{-3}$, $1.0\\times 10^{-2}$]\n  - 测得的 $\\gamma$ (单位 $\\mathrm{N}/\\mathrm{m}$):\n    [$7.190\\times 10^{-2}$, $7.165\\times 10^{-2}$, $7.120\\times 10^{-2}$, $7.080\\times 10^{-2}$, $7.020\\times 10^{-2}$, $6.910\\times 10^{-2}$, $6.750\\times 10^{-2}$, $6.580\\times 10^{-2}$, $6.320\\times 10^{-2}$, $6.010\\times 10^{-2}$, $5.680\\times 10^{-2}$, $5.300\\times 10^{-2}$, $4.750\\times 10^{-2}$, $4.120\\times 10^{-2}$, $3.580\\times 10^{-2}$, $3.110\\times 10^{-2}$, $2.700\\times 10^{-2}$]\n  - 温度 $T$: $298$\n  - 查询活度 $a_{\\mathrm{query}}$: [$1.0\\times 10^{-5}$, $1.0\\times 10^{-4}$, $1.0\\times 10^{-3}$]\n\n- 测试用例 $2$ (稀疏网格，中等噪声):\n  - 活度 $a$: [$1.0\\times 10^{-6}$, $2.0\\times 10^{-6}$, $5.0\\times 10^{-6}$, $1.0\\times 10^{-5}$, $2.0\\times 10^{-5}$, $5.0\\times 10^{-5}$, $1.0\\times 10^{-4}$, $3.0\\times 10^{-4}$, $1.0\\times 10^{-3}$]\n  - 测得的 $\\gamma$ (单位 $\\mathrm{N}/\\mathrm{m}$): [$7.200\\times 10^{-2}$, $7.170\\times 10^{-2}$, $7.120\\times 10^{-2}$, $7.050\\times 10^{-2}$, $6.930\\times 10^{-2}$, $6.680\\times 10^{-2}$, $6.350\\times 10^{-2}$, $5.800\\times 10^{-2}$, $5.200\\times 10^{-2}$]\n  - 温度 $T$: $298$\n  - 查询活度 $a_{\\mathrm{query}}$: [$1.0\\times 10^{-5}$, $1.0\\times 10^{-4}$, $1.0\\times 10^{-3}$]\n\n- 测试用例 $3$ (高分辨率网格，较高噪声):\n  - 活度 $a$:\n    [$1.0\\times 10^{-6}$, $1.778\\times 10^{-6}$, $3.162\\times 10^{-6}$, $5.623\\times 10^{-6}$, $1.0\\times 10^{-5}$, $1.778\\times 10^{-5}$, $3.162\\times 10^{-5}$, $5.623\\times 10^{-5}$, $1.0\\times 10^{-4}$, $1.778\\times 10^{-4}$, $3.162\\times 10^{-4}$, $5.623\\times 10^{-4}$, $1.0\\times 10^{-3}$, $1.778\\times 10^{-3}$, $3.162\\times 10^{-3}$, $5.623\\times 10^{-3}$, $1.0\\times 10^{-2}$]\n  - 测得的 $\\gamma$ (单位 $\\mathrm{N}/\\mathrm{m}$):\n    [$7.220\\times 10^{-2}$, $7.200\\times 10^{-2}$, $7.170\\times 10^{-2}$, $7.145\\times 10^{-2}$, $7.070\\times 10^{-2}$, $6.990\\times 10^{-2}$, $6.780\\times 10^{-2}$, $6.620\\times 10^{-2}$, $6.310\\times 10^{-2}$, $6.050\\times 10^{-2}$, $5.780\\times 10^{-2}$, $5.440\\times 10^{-2}$, $4.910\\times 10^{-2}$, $4.350\\times 10^{-2}$, $3.840\\times 10^{-2}$, $3.410\\times 10^{-2}$, $3.020\\times 10^{-2}$]\n  - 温度 $T$: $298$\n  - 查询活度 $a_{\\mathrm{query}}$: [$1.0\\times 10^{-5}$, $1.0\\times 10^{-4}$, $1.0\\times 10^{-3}$]\n\n实现约束和数值要求：\n\n- 使用 $R=8.314462618\\ \\mathrm{J}/(\\mathrm{mol}\\cdot \\mathrm{K})$。\n- 所有计算必须使用国际单位制（SI）；$\\gamma$ 必须以 $\\mathrm{N}/\\mathrm{m}$ 为单位， $T$ 以 $\\mathrm{K}$ 为单位，最终的 $\\Gamma$ 必须以 $\\mathrm{mol}/\\mathrm{m}^2$ 为单位报告。\n- 您的算法必须通过广义交叉验证（GCV）自动选择正则化参数 $\\lambda$，无需用户输入。在一个足够宽的区间上，对 $\\log_{10}\\lambda$ 使用稳健的一维最小化方法。\n- 关于 $\\ln a$ 的导数必须仅从平滑后的 $\\tilde{\\gamma}$ 计算，而不是从原始数据 $\\gamma$ 计算。\n- 在查询活度处的求值必须通过在 $x=\\ln a$ 上进行插值来完成。\n- 数值稳定性以及避免过拟合或过平滑是评估的一部分；GCV 机制至关重要。\n\n最终输出格式：\n\n- 对于每个测试用例，按 $1,2,3$ 的顺序，计算三个查询活度下的 $\\Gamma$ 值，并将所有九个值按 $[\\,\\Gamma_{1}(a_{1}),\\Gamma_{1}(a_{2}),\\Gamma_{1}(a_{3}),\\Gamma_{2}(a_{1}),\\Gamma_{2}(a_{2}),\\Gamma_{2}(a_{3}),\\Gamma_{3}(a_{1}),\\Gamma_{3}(a_{2}),\\Gamma_{3}(a_{3})\\,]$ 的顺序收集到一个 Python 风格的列表中。\n- 每项结果以 $\\mathrm{mol}/\\mathrm{m}^2$ 为单位表示，并四舍五入到 $6$ 位有效数字。\n- 您的程序应生成包含该列表的单行输出，例如：\"[$x_1,x_2,\\dots,x_9$]\"。\n\n您的程序必须是一个完整的、可运行的实现，它不读取任何输入，并精确使用上面提供的测试用例。它不能硬编码任何 $\\gamma(a)$ 的解析导数或符号模型，并且必须完全依赖上述的正则化数值微分程序来估计 $\\left(\\dfrac{\\partial \\gamma}{\\partial \\ln a}\\right)_T$ 和 $\\Gamma$。", "solution": "问题陈述经过验证，被认为是有效的。这是一个在计算物理化学领域中有科学依据的适定问题，拥有一套完整且一致的要求和数据。任务是根据在恒定温度 T 下测得的表面张力 γ 与溶质活度 a 之间的带噪声实验数据，来估计表面超量浓度 Γ。这需要对一个导数进行稳定的数值评估，而这本质上是一个不适定问题。所提出的方法，基于带有曲率惩罚项的 Tikhonov 正则化以及通过广义交叉验证（GCV）进行自动化参数选择，是解决此类问题的标准且稳健的途径。\n\n解决方案通过分步实现所述算法来推进。\n\n1.  **基本关系与变换**：核心物理原理是吉布斯吸附等温线，它将表面超量 $\\Gamma$ 与表面张力 $\\gamma$ 随活度自然对数 $a$ 的变化关联起来：\n    $$\n    \\Gamma = -\\frac{1}{R T}\\left(\\frac{\\partial \\gamma}{\\partial \\ln a}\\right)_{T}\n    $$\n    这里，$R$ 是理想气体常数，$T$ 是绝对温度。为便于数值计算，我们引入变量 $x = \\ln a$。问题于是简化为从一组离散的、带噪声的数据点 $(x_i, \\gamma_i)$（其中 $x_i = \\ln a_i$）计算导数 $\\frac{d\\gamma}{dx}$。\n\n2.  **正则化平滑（Tikhonov 正则化）**：直接对原始数据 $\\{\\gamma_i\\}$ 进行数值微分会不可接受地放大实验噪声。为了获得导数的稳定估计，我们首先通过求解一个正则化最小二乘问题来计算表面张力曲线的平滑版本，记为 $\\tilde{\\gamma}$。目标是找到一个向量 $\\tilde{\\gamma} \\in \\mathbb{R}^n$，它能在数据保真度（第一项）和解的粗糙度惩罚（第二项）之间取得平衡：\n    $$\n    \\min_{\\tilde{\\gamma}\\in\\mathbb{R}^n}\\ \\|\\tilde{\\gamma}-\\gamma\\|_2^2+\\lambda\\|L\\tilde{\\gamma}\\|_2^2\n    $$\n    这里，$\\|\\cdot\\|_2$ 是欧几里得范数，$\\lambda \\ge 0$ 是正则化参数，控制着数据保真度与平滑度之间的权衡，而 $L$ 是一个近似二阶导数算子的矩阵。最小化 $\\|L\\tilde{\\gamma}\\|_2^2$ 迫使平滑曲线“尽可能地直”，从而减少由噪声引起的伪振荡。\n\n3.  **离散二阶导数算子 ($L$)**：矩阵 $L \\in \\mathbb{R}^{(n-2)\\times n}$ 被构建用于在非均匀网格 $\\{x_i\\}$ 上近似二阶导数。对于每个内部点 $x_i$（使用从0开始的索引，即 $i \\in \\{1, \\dots, n-2\\}$），使用三点有限差分公式。令 $h_0 = x_i - x_{i-1}$ 和 $h_1 = x_{i+1} - x_i$。 $L$ 中对应于点 $x_i$ 处二阶导数的行包含三个非零元素，分别对应于点 $x_{i-1}$、$x_i$ 和 $x_{i+1}$（即 $L$ 的第 $i-1$, $i$, $i+1$ 列）：\n    - 在第 $i-1$ 列：$w_{i-1} = \\dfrac{2}{h_0(h_0+h_1)}$\n    - 在第 $i$ 列：$w_{i} = -\\dfrac{2}{h_0 h_1}$\n    - 在第 $i+1$ 列：$w_{i+1} = \\dfrac{2}{h_1(h_0+h_1)}$\n    这会产生一个带状矩阵 $L$。\n\n4.  **求解平滑曲线**：Tikhonov最小化问题是一个线性最小二乘问题，具有闭式解。将目标函数相对于 $\\tilde{\\gamma}$ 的梯度设为零，得到正规方程：$(I + \\lambda L^{\\mathsf{T}}L)\\tilde{\\gamma} = \\gamma$。因此，平滑曲线由下式给出：\n    $$\n    \\tilde{\\gamma}(\\lambda) = (I + \\lambda L^{\\mathsf{T}}L)^{-1}\\gamma\n    $$\n    其中 $I$ 是 $n \\times n$ 的单位矩阵。\n\n5.  **通过 GCV 确定最优正则化参数 ($\\lambda$)**：$\\lambda$ 的选择至关重要。过小的 $\\lambda$ 会导致欠平滑（拟合噪声），而过大的 $\\lambda$ 会导致过平滑（丢失真实特征）。广义交叉验证（GCV）方法通过最小化 GCV 分数，提供了一种自动且客观地选择 $\\lambda$ 的方式：\n    $$\n    \\mathrm{GCV}(\\lambda)=\\frac{n\\,\\|\\gamma-\\tilde{\\gamma}(\\lambda)\\|_2^2}{\\left(n-\\mathrm{tr}(H(\\lambda))\\right)^2}\n    $$\n    其中 $H(\\lambda) = (I + \\lambda L^{\\mathsf{T}}L)^{-1}$ 是将观测数据 $\\gamma$ 映射到平滑数据 $\\tilde{\\gamma}$ 的“帽子”矩阵。项 $\\mathrm{tr}(H(\\lambda))$ 表示平滑模型中的有效参数数量。GCV 函数在一个广泛的 $\\lambda$ 对数范围（例如 $\\lambda \\in [10^{-12}, 10^{12}]$）内，使用标准的一维优化算法进行最小化。为了数值稳定性，使用矩阵 $K=L^{\\mathsf{T}}L$ 的特征值 $s_j$ 来计算 $H(\\lambda)$ 的迹，即 $\\mathrm{tr}(H(\\lambda)) = \\sum_{j=1}^n (1+\\lambda s_j)^{-1}$。\n\n6.  **平滑曲线的数值微分**：一旦找到最优的 $\\lambda$ 并计算出平滑曲线 $\\tilde{\\gamma}$，就在每个节点 $x_i$ 处估计其导数 $\\frac{d\\gamma}{dx}$。\n    - 对于内部节点 $i \\in \\{1, \\dots, n-2\\}$：使用适用于非均匀网格的中心差分公式：\n    $$\n    \\left(\\frac{d\\gamma}{dx}\\right)_i = \\tilde{\\gamma}_{i-1} \\frac{-h_1}{h_0(h_0+h_1)} + \\tilde{\\gamma}_i \\frac{h_1-h_0}{h_0 h_1} + \\tilde{\\gamma}_{i+1} \\frac{h_0}{h_1(h_0+h_1)}\n    $$\n    其中 $h_0=x_i-x_{i-1}$ 且 $h_1=x_{i+1}-x_i$。\n    - 对于边界节点 $i=0$ 和 $i=n-1$：应用阶数较低的单边前向和后向差分公式：\n    $$\n    \\left(\\frac{d\\gamma}{dx}\\right)_0 = \\frac{\\tilde{\\gamma}_1 - \\tilde{\\gamma}_0}{x_1 - x_0} \\quad \\text{和} \\quad \\left(\\frac{d\\gamma}{dx}\\right)_{n-1} = \\frac{\\tilde{\\gamma}_{n-1} - \\tilde{\\gamma}_{n-2}}{x_{n-1} - x_{n-2}}\n    $$\n\n7.  **插值与最终计算**：导数值 $\\frac{d\\gamma}{dx}$ 在网格点 $\\{x_i\\}$ 上是已知的。为了在指定的查询活度 $\\{a_{\\mathrm{query}}\\}$ 处找到导数，我们首先计算相应的对数坐标 $\\{x_{\\mathrm{query}} = \\ln a_{\\mathrm{query}}\\}$。然后，我们对离散数据 $(x_i, (\\frac{d\\gamma}{dx})_i)$ 使用线性插值，以找到在查询点 $x_{\\mathrm{query}}$ 处的导数值。最后，使用吉布斯等温线计算每个查询活度下的表面超量 $\\Gamma$，确保所有量都使用国际单位制：\n    $$\n    \\Gamma(a_{\\mathrm{query}}) = -\\frac{1}{R T} \\left(\\frac{d\\gamma}{dx}\\right)_{x=\\ln a_{\\mathrm{query}}}\n    $$\n    所得数值随后按要求四舍五入至六位有效数字。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\nfrom math import log10, floor, fabs\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    R_GAS_CONSTANT = 8.314462618  # J / (mol*K)\n\n    test_cases = [\n        {\n            \"a\": [1.0e-6, 1.778e-6, 3.162e-6, 5.623e-6, 1.0e-5, 1.778e-5, 3.162e-5, 5.623e-5, 1.0e-4, 1.778e-4, 3.162e-4, 5.623e-4, 1.0e-3, 1.778e-3, 3.162e-3, 5.623e-3, 1.0e-2],\n            \"gamma\": [7.190e-2, 7.165e-2, 7.120e-2, 7.080e-2, 7.020e-2, 6.910e-2, 6.750e-2, 6.580e-2, 6.320e-2, 6.010e-2, 5.680e-2, 5.300e-2, 4.750e-2, 4.120e-2, 3.580e-2, 3.110e-2, 2.700e-2],\n            \"T\": 298.0,\n            \"a_query\": [1.0e-5, 1.0e-4, 1.0e-3]\n        },\n        {\n            \"a\": [1.0e-6, 2.0e-6, 5.0e-6, 1.0e-5, 2.0e-5, 5.0e-5, 1.0e-4, 3.0e-4, 1.0e-3],\n            \"gamma\": [7.200e-2, 7.170e-2, 7.120e-2, 7.050e-2, 6.930e-2, 6.680e-2, 6.350e-2, 5.800e-2, 5.200e-2],\n            \"T\": 298.0,\n            \"a_query\": [1.0e-5, 1.0e-4, 1.0e-3]\n        },\n        {\n            \"a\": [1.0e-6, 1.778e-6, 3.162e-6, 5.623e-6, 1.0e-5, 1.778e-5, 3.162e-5, 5.623e-5, 1.0e-4, 1.778e-4, 3.162e-4, 5.623e-4, 1.0e-3, 1.778e-3, 3.162e-3, 5.623e-3, 1.0e-2],\n            \"gamma\": [7.220e-2, 7.200e-2, 7.170e-2, 7.145e-2, 7.070e-2, 6.990e-2, 6.780e-2, 6.620e-2, 6.310e-2, 6.050e-2, 5.780e-2, 5.440e-2, 4.910e-2, 4.350e-2, 3.840e-2, 3.410e-2, 3.020e-2],\n            \"T\": 298.0,\n            \"a_query\": [1.0e-5, 1.0e-4, 1.0e-3]\n        }\n    ]\n\n    def round_to_significant_figures(value, sig_figs):\n        \"\"\"Rounds a number to a specified number of significant figures.\"\"\"\n        if value == 0:\n            return 0.0\n        return round(value, sig_figs - int(floor(log10(fabs(value)))) - 1)\n\n    def process_case(case_data):\n        \"\"\"\n        Processes a single test case to calculate surface excess Gamma.\n        \"\"\"\n        a = np.array(case_data[\"a\"])\n        gamma = np.array(case_data[\"gamma\"])\n        temp = case_data[\"T\"]\n        a_query = np.array(case_data[\"a_query\"])\n        \n        n = len(a)\n        x = np.log(a)\n        I = np.identity(n)\n\n        # 1. Construct the discrete second-derivative operator L\n        L = np.zeros((n - 2, n))\n        for i in range(n - 2):\n            # i-th row of L corresponds to the second derivative at x[i+1]\n            h0 = x[i+1] - x[i]\n            h1 = x[i+2] - x[i+1]\n            if h0 <= 0 or h1 <= 0: continue # Should not happen with sorted unique activities\n            L[i, i]   = 2 / (h0 * (h0 + h1))\n            L[i, i+1] = -2 / (h0 * h1)\n            L[i, i+2] = 2 / (h1 * (h0 + h1))\n\n        # 2. Find optimal lambda using Generalized Cross-Validation (GCV)\n        K = L.T @ L\n        # Use eigenvalues of K for stable computation of trace(H)\n        s = np.linalg.eigvalsh(K)\n\n        def gcv_score(log_lambda):\n            lam = 10**log_lambda\n            \n            # H = (I + lam*K)^-1. Trace of H = sum(1 / (1 + lam*s_j))\n            tr_H = np.sum(1 / (1 + lam * s))\n            if abs(n - tr_H) < 1e-12: return np.inf\n\n            # gamma_tilde = H @ gamma -> Solve (I + lam*K)gamma_tilde = gamma\n            gamma_tilde = np.linalg.solve(I + lam * K, gamma)\n            \n            numerator = n * np.sum((gamma - gamma_tilde)**2)\n            denominator = (n - tr_H)**2\n            \n            return numerator / denominator\n\n        res = minimize_scalar(gcv_score, bounds=(-12, 12), method='bounded')\n        optimal_lambda = 10**res.x\n\n        # 3. Compute the smoothed gamma profile\n        gamma_smooth = np.linalg.solve(I + optimal_lambda * K, gamma)\n\n        # 4. Differentiate the smoothed profile gamma_smooth w.r.t x\n        d_gamma_dx = np.zeros(n)\n        \n        # One-sided differences at boundaries\n        d_gamma_dx[0] = (gamma_smooth[1] - gamma_smooth[0]) / (x[1] - x[0])\n        d_gamma_dx[n-1] = (gamma_smooth[n-1] - gamma_smooth[n-2]) / (x[n-1] - x[n-2])\n        \n        # Central differences for interior points\n        for i in range(1, n - 1):\n            h0 = x[i] - x[i-1]\n            h1 = x[i+1] - x[i]\n            \n            c_prev = -h1 / (h0 * (h0 + h1))\n            c_curr = (h1 - h0) / (h0 * h1)\n            c_next = h0 / (h1 * (h0 + h1))\n            \n            d_gamma_dx[i] = (c_prev * gamma_smooth[i-1] +\n                             c_curr * gamma_smooth[i] +\n                             c_next * gamma_smooth[i+1])\n\n        # 5. Interpolate derivative at query points\n        x_query = np.log(a_query)\n        d_gamma_dx_query = np.interp(x_query, x, d_gamma_dx)\n        \n        # 6. Calculate Gamma using Gibbs isotherm\n        Gamma_query = -d_gamma_dx_query / (R_GAS_CONSTANT * temp)\n        \n        return [round_to_significant_figures(val, 6) for val in Gamma_query]\n\n    all_results = []\n    for case in test_cases:\n        all_results.extend(process_case(case))\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2793461"}]}