{"hands_on_practices": [{"introduction": "二维材料的力学稳定性是理解其物理性质和设计其应用的基础。本练习旨在介绍 Föppl-von Kármán (FvK) 数，这是一个关键的无量纲参数，它量化了平面内拉伸能和平面外弯曲能之间的竞争关系 [@problem_id:2785703]。通过为石墨烯等典型材料计算此数值，我们可以直观地理解为何这类超薄材料极易产生褶皱，这是深入研究所有相关现象的起点。", "problem": "单层石墨烯薄膜可以被建模为一个具有平面内（二维）拉伸模量和平面外弯曲刚度的弹性薄板。考虑一个横向尺度为 $L=1\\,\\mu\\mathrm{m}$ 的方形石墨烯片，其平面内模量为 $Y=340\\,\\mathrm{N/m}$，弯曲刚度为 $\\kappa=1.1\\,\\mathrm{eV}$。利用薄板弹性的基本原理和量纲分析，构建一个唯一的无量纲群，用以量化在尺度 $L$ 上的形变中平面内拉伸与平面外弯曲之间的竞争关系，该无量纲群通常被称为 Föppl–von Kármán (FvK) 数。然后，根据给定的参数计算其数值。根据此无量纲数的物理解释，说明该薄膜预期处于绷紧（拉伸主导）状态还是易起皱（弯曲易及）状态。\n\n请统一使用国际单位制 (SI)，其中 $1\\,\\mathrm{eV}=1.602176634\\times 10^{-19}\\,\\mathrm{J}$。请将最终的无量纲数表示为纯数，并将您的答案四舍五入至三位有效数字。解释性陈述无需包含在最终的数值答案中。", "solution": "适用的理论框架是原子级薄膜的薄板弹性理论，其中平面内形变需要消耗拉伸能，而平面外曲率则需要消耗弯曲能。Föppl–von Kármán (FvK) 数是一个无量纲比率，用于比较横向范围为 $L$ 的形变的特征拉伸能标和弯曲能标。\n\n从能量的标度关系开始：\n- 拉伸能密度（单位面积的能量）的标度关系为 $u_{s} \\sim Y\\,\\varepsilon^{2}$，其中 $Y$ 是二维拉伸模量，$\\varepsilon$ 是典型的平面内应变大小。在大小为 $L^{2}$ 的面积上，拉伸能的标度关系为 $U_{s} \\sim Y\\,\\varepsilon^{2}\\,L^{2}$。\n- 弯曲能密度的标度关系为 $u_{b} \\sim \\kappa\\,(\\nabla^{2} w)^{2}$，其中 $\\kappa$ 是弯曲刚度， $w$ 是平面外挠度。对于曲率量级为 $w/L^{2}$ 的挠度场，在面积 $L^{2}$ 上的弯曲能标度关系为 $U_{b} \\sim \\kappa\\,(w/L^{2})^{2}\\,L^{2} \\sim \\kappa\\,w^{2}/L^{2}$。\n\n为了比较这些能量在尺寸为 $L$ 的形状模式下的关系，我们注意到在非线性的 Föppl–von Kármán 运动学中，由平面外挠度引起的几何平面内应变标度关系为 $\\varepsilon \\sim (\\nabla w)^{2} \\sim (w/L)^{2}$。将此关系代入拉伸能的标度关系中，得到 $U_{s} \\sim Y\\,(w/L)^{4}\\,L^{2} = Y\\,w^{4}/L^{2}$。对于这样一个模式，拉伸能与弯曲能之比为\n$$\n\\frac{U_{s}}{U_{b}} \\sim \\frac{Y\\,w^{4}/L^{2}}{\\kappa\\,w^{2}/L^{2}} = \\frac{Y\\,L^{2}}{\\kappa}\\,\\left(\\frac{w}{L}\\right)^{2}.\n$$\n对于斜率量级为1的模式，即 $w/L \\sim 1$，控制拉伸与弯曲相对成本的前置因子是无量纲群\n$$\n\\gamma \\sim \\frac{Y\\,L^{2}}{\\kappa}.\n$$\n同样的无量纲组合可以从量纲分析中得出：$Y$ 的单位是能量/面积，$\\kappa$ 的单位是能量， $L$ 的单位是长度，因此 $Y\\,L^{2}/\\kappa$ 是无量纲的，并且是在尺度 $L$ 上比较平面内与弯曲能量学的唯一组合。\n\n现在我们使用一致的国际单位制，根据给定的参数对 $\\gamma$ 进行数值计算。首先，将弯曲刚度从电子伏特转换为焦耳：\n$$\n\\kappa = 1.1\\,\\mathrm{eV} = 1.1 \\times \\left(1.602176634\\times 10^{-19}\\,\\mathrm{J}\\right) = 1.7623942974\\times 10^{-19}\\,\\mathrm{J}.\n$$\n平面内模量和长度已经是国际单位制：\n$$\nY = 340\\,\\mathrm{N/m}, \\quad L = 1\\,\\mu\\mathrm{m} = 1.0\\times 10^{-6}\\,\\mathrm{m}.\n$$\n计算分子 $Y\\,L^{2}$：\n$$\nY\\,L^{2} = \\left(340\\,\\mathrm{N/m}\\right)\\left(1.0\\times 10^{-6}\\,\\mathrm{m}\\right)^{2} = 340 \\times 10^{-12}\\,\\mathrm{N\\,m} = 3.40\\times 10^{-10}\\,\\mathrm{J}.\n$$\n构建比率\n$$\n\\gamma = \\frac{Y\\,L^{2}}{\\kappa} = \\frac{3.40\\times 10^{-10}\\,\\mathrm{J}}{1.7623942974\\times 10^{-19}\\,\\mathrm{J}} = \\left(\\frac{3.40}{1.7623942974}\\right)\\times 10^{9}.\n$$\n计算前置因子：\n$$\n\\frac{3.40}{1.7623942974} \\approx 1.9298.\n$$\n因此\n$$\n\\gamma \\approx 1.9298\\times 10^{9}.\n$$\n四舍五入到三位有效数字，得到\n$$\n\\gamma \\approx 1.93\\times 10^{9}.\n$$\n\n解释：一个非常大的 Föppl–von Kármán 数（$\\gamma \\gg 1$）表明，在给定的尺度上，弯曲在能量上远比平面内拉伸代价更小，因此薄膜很容易通过平面外挠度来释放平面内压缩，使其易于起皱而不是保持绷紧。", "answer": "$$\\boxed{1.93\\times 10^{9}}$$", "id": "2785703"}, {"introduction": "在真实的二维材料中，观测到的起伏纹理可能源于多种物理机制，主要是热涨落和静态缺陷。在实验或模拟研究中，区分这两种贡献是一项至关重要的任务。本练习要求我们扮演研究者的角色，基于热致（annealed）与缺陷致（quenched）无序的不同统计特征，设计一套有效的数据分析方案 [@problem_id:2785652]。此练习的核心在于，深刻理解高度起伏谱 $S(q,T)$ 对温度 $T$ 和波矢 $q$ 的依赖关系，并将其作为区分波纹来源的关键指纹。", "problem": "对一个独立结晶单层（例如，悬浮石墨烯）进行实空间成像，并对其面外高度场进行傅里叶变换，以获得高度谱 $\\langle |h(\\mathbf{q})|^{2}\\rangle \\equiv S(q,T)$，其中 $\\mathbf{q}$ 是面内波矢，$q \\equiv |\\mathbf{q}|$，$T$ 是绝对温度。样品中可能含有稀疏密度的点缺陷，这些缺陷作为曲率或应力的淬火源。您的任务是基于连续介质膜理论和平衡统计力学，设计一个方案，仅通过 $S(q,T)$ 随 $q$ 的标度关系及其振幅对 $T$ 的依赖关系，在一个由膜尺寸设定的红外截止和由微观厚度设定的紫外截止之间的宽但实验上可及的 $q$ 窗口内，区分热激发的涟漪与缺陷诱导的（淬火的）涟漪。以下哪个选项描述了针对此任务的一个科学上合理且内部一致的分析方案和决策标准？\n\nA. 在多个温度下测量 $S(q,T)$，并通过绘制 $S(q,T)/T$ 对 $q$ 的图像来检验单参数标度塌缩。将塌缩部分拟合为 $q$ 的单一幂律，其有效指数与温度无关；并通过添加一个所有温度共享的、与 $T$ 无关的分量来拟合与塌缩的偏差，即 $S(q,T)=a(T)\\,q^{-\\alpha}+b\\,q^{-\\beta}$，其中 $a(T)\\propto T$ 且 $b$ 与 $T$ 无关。结论是：当且仅当最佳拟合的 $b$ 在统计上非零，同时重标度的 $S(q,T)/T$ 在相同的 $q$ 范围内未能塌缩时，存在缺陷诱导的涟漪；否则，结论是涟漪是纯热的。\n\nB. 在单一温度下采集 $S(q,T)$，并将其拟合为幂律 $S(q,T)\\propto q^{-\\alpha}$。如果拟合出的 $\\alpha$ 小于 $4$，则断定存在缺陷，因为任何与谐波标度（$\\alpha=4$）的偏离都必然源于淬火无序。\n\nC. 将谱按 $T^{2}$ 归一化，即在多个温度下绘制 $S(q,T)/T^{2}$ 对 $q$ 的图像。如果这些曲线在测量的 $q$ 窗口内塌缩到一条主曲线上，则将此塌缩解释为纯热涟漪的证据；否则，断定缺陷占主导地位。\n\nD. 在固定 $q$ 值下，当 $T$ 变化时，监测 $\\log S(q,T)$ 对 $\\log q$ 的斜率。如果随着 $T$ 的增加斜率变陡（即有效指数增大），则断定涟漪是热的；如果它不随 $T$ 变化，则断定涟漪是缺陷诱导的。", "solution": "问题陈述需经过验证。\n\n**步骤1：提取已知条件**\n- **系统**：独立结晶单层。\n- **物理可观测量**：面外高度场，其傅里叶变换产生高度谱，记为 $\\langle |h(\\mathbf{q})|^{2}\\rangle \\equiv S(q,T)$。\n- **变量**：$\\mathbf{q}$ 是面内波矢，$q \\equiv |\\mathbf{q}|$，$T$ 是绝对温度。\n- **假设**：样品中可能含有稀疏密度的点缺陷，作为曲率或应力的淬火源。\n- **目标**：基于连续介质膜理论和平衡统计力学，设计一个方案来区分热激发的涟漪与缺陷诱导的（淬火的）涟漪。\n- **方法**：该方案必须利用 $S(q,T)$ 随 $q$ 的标度关系及其对 $T$ 的依赖性。\n- **范围**：分析在一个由红外截止（样品尺寸）和紫外截止（微观厚度）定义的 $q$ 窗口内进行。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题牢固地植根于柔性表面的统计力学，这是凝聚态物理和纳米力学中的一个主要课题。对高度-高度相关函数（或其傅里叶变换，即高度谱 $S(q,T)$）的分析是研究此类系统的标准理论和实验工具。区分热（退火）贡献和缺陷诱导（淬火）贡献是一个定义明确且具有物理意义的问题。\n- **适定性**：该问题是适定的。它要求基于已建立的物理理论，在几个选项中确定一个正确的分析程序。所指定的理论框架（连续介质膜理论和统计力学）是适当且充分的，足以推导出 $S(q,T)$ 的预期行为，从而评估所提出的方案。\n- **客观性**：问题陈述是客观的，使用了物理学中的精确术语，没有歧义或主观内容。\n\n**步骤3：结论与行动**\n问题在科学上是合理的、适定的、客观的，并且没有不一致或致命的缺陷。这是一个有效的物理分析问题。可以继续求解过程。\n\n**理论推导**\n\n分析必须从柔性结晶膜的控制哈密顿量开始。面外涨落 $h(\\mathbf{r})$ 的主要能量成本是弯曲。在谐波近似中，弯曲能由下式给出：\n$$\nF_{\\text{bend}} = \\frac{1}{2} \\int d^2r \\, \\kappa (\\nabla^2 h)^2\n$$\n其中 $\\kappa$ 是弯曲刚度。在傅里叶空间中，这变为：\n$$\nF_{\\text{bend}} = \\frac{1}{2} \\sum_{\\mathbf{q}} A \\, \\kappa q^4 |h(\\mathbf{q})|^2\n$$\n其中 $A$ 是膜的面积。应用统计力学中的能量均分定理，能量中的每个二次模式具有 $\\frac{1}{2} k_B T$ 的平均热能，其中 $k_B$ 是玻尔兹曼常数。这导致：\n$$\n\\frac{1}{2} A \\, \\kappa q^4 \\langle |h(\\mathbf{q})|^2 \\rangle = \\frac{1}{2} k_B T\n$$\n单位面积的高度谱 $S(q,T) = A \\langle |h(\\mathbf{q})|^2 \\rangle$ 因此是：\n$$\nS(q,T) = \\frac{k_B T}{\\kappa q^4}\n$$\n这个谐波理论预测 $S(q,T) \\propto T q^{-4}$。然而，对于二维膜，弯曲和面内拉伸模式之间的非谐耦合至关重要。这种耦合重整化了弯曲刚度，使其依赖于尺度：$\\kappa(q) \\sim q^{-\\eta}$，其中 $\\eta$ 是一个普适指数，其值约为 $\\eta \\approx 0.82$。因此，纯热涟漪的高度谱 $S_{\\text{th}}(q,T)$ 被修正为：\n$$\nS_{\\text{th}}(q,T) = \\frac{k_B T}{\\kappa(q) q^4} \\propto T q^{-(4-\\eta)} \\equiv a \\, T \\, q^{-\\alpha_{\\text{th}}}\n$$\n其中热标度指数为 $\\alpha_{\\text{th}} = 4 - \\eta \\approx 3.18$，而 $a$ 是一个与温度无关的常数。关键特征是热涨落的振幅与绝对温度 $T$ 成正比。\n\n接下来，我们考虑淬火缺陷的影响。这些缺陷在膜上产生一个静态的、与温度无关的形变 $h_{\\text{def}}(\\mathbf{r})$。总高度场是静态缺陷诱导轮廓和动态热涨落的叠加：$h(\\mathbf{r}) = h_{\\text{def}}(\\mathbf{r}) + h_{\\text{th}}(\\mathbf{r})$。假设热涨落与淬火无序在统计上是独立的，总高度谱是两个贡献之和：\n$$\nS(q,T) = \\langle |h(\\mathbf{q})|^2 \\rangle = \\langle |h_{\\text{def}}(\\mathbf{q})|^2 \\rangle + \\langle |h_{\\text{th}}(\\mathbf{q})|^2 \\rangle = S_{\\text{def}}(q) + S_{\\text{th}}(q,T)\n$$\n根据定义，缺陷贡献 $S_{\\text{def}}(q)$ 与温度无关。它随 $q$ 的标度关系 $S_{\\text{def}}(q) \\propto q^{-\\beta}$ 取决于缺陷的性质（例如，对于淬火随机曲率源，预期 $\\beta=4$）。因此，总谱为：\n$$\nS(q,T) = a \\, T \\, q^{-\\alpha_{\\text{th}}} + b \\, q^{-\\beta}\n$$\n其中系数 $b$ 与缺陷的密度和强度有关，且与 $T$ 无关。\n\n为了区分这两种贡献，必须利用它们不同的温度依赖性。让我们考虑重标度谱 $S(q,T)/T$：\n$$\n\\frac{S(q,T)}{T} = a \\, q^{-\\alpha_{\\text{th}}} + \\frac{b}{T} \\, q^{-\\beta}\n$$\n- 如果系统是纯热的（$b=0$）：$S(q,T)/T = a \\, q^{-\\alpha_{\\text{th}}}$。该表达式与温度无关。因此，为不同温度绘制 $S(q,T)/T$ 对 $q$ 的图像将使所有数据集塌缩到一条主曲线上。\n- 如果存在淬火缺陷（$b \\neq 0$）：项 $\\frac{b}{T} q^{-\\beta}$ 引入了明确的温度依赖性。数据将不会塌缩。具体来说，随着 $T$ 降低，项 $\\frac{b}{T}$ 增加，导致在 $S(q,T)/T$ 对 $q$ 的图中，较低温度的曲线系统性地位于较高温度的曲线上方。\n\n此分析提供了一个清晰而稳健的方案。\n\n**选项评估**\n\n**选项 A**：“在多个温度下测量 $S(q,T)$，并通过绘制 $S(q,T)/T$ 对 $q$ 的图像来检验单参数标度塌缩。将塌缩部分拟合为 $q$ 的单一幂律，其有效指数与温度无关；并通过添加一个所有温度共享的、与 $T$ 无关的分量来拟合与塌缩的偏差，即 $S(q,T)=a(T)\\,q^{-\\alpha}+b\\,q^{-\\beta}$，其中 $a(T)\\propto T$ 且 $b$ 与 $T$ 无关。结论是：当且仅当最佳拟合的 $b$ 在统计上非零，同时重标度的 $S(q,T)/T$ 在相同的 $q$ 范围内未能塌缩时，存在缺陷诱导的涟漪；否则，结论是涟漪是纯热的。”\n\n该方案与理论推导完全一致。它正确地指出，除以 $T$ 可以分离各个贡献：热贡献部分变为与 $T$ 无关，而缺陷贡献部分则获得 $1/T$ 的依赖性。纯热涟漪的条件是 $S(q,T)/T$ 图中的数据塌缩。缺陷的存在（$b \\neq 0$）被正确地与这种塌缩的失败联系起来。所提出的拟合函数 $S(q,T)=a(T)\\,q^{-\\alpha}+b\\,q^{-\\beta}$（其中 $a(T)\\propto T$ 且 $b$ 恒定）是正确的物理模型。此选项在科学上是合理的且内部一致的。\n**结论：正确。**\n\n**选项 B**：“在单一温度下采集 $S(q,T)$，并将其拟合为幂律 $S(q,T)\\propto q^{-\\alpha}$。如果拟合出的 $\\alpha$ 小于 $4$，则断定存在缺陷，因为任何与谐波标度（$\\alpha=4$）的偏离都必然源于淬火无序。”\n\n该方案根本上是错误的。首先，仅依赖单一温度的测量无法严格区分一个依赖温度的现象和一个不依赖温度的现象。其次，其推理不正确。与谐波指数 $\\alpha=4$ 的偏离（即发现 $\\alpha < 4$）是纯热膜中非谐效应的一个已知后果，导致 $\\alpha_{\\text{th}} \\approx 3.18$。将任何与 $\\alpha=4$ 的偏离完全归因于缺陷是一个严重错误，它忽略了膜理论的一个核心结果。\n**结论：错误。**\n\n**选项 C**：“将谱按 $T^{2}$ 归一化，即在多个温度下绘制 $S(q,T)/T^{2}$ 对 $q$ 的图像。如果这些曲线在测量的 $q$ 窗口内塌缩到一条主曲线上，则将此塌缩解释为纯热涟漪的证据；否则，断定缺陷占主导地位。”\n\n该方案基于一个错误的前提。没有物理理由将谱按 $T^2$ 进行归一化。对于纯热系统，$S_{\\text{th}}(q,T) \\propto T$，因此 $S_{\\text{th}}(q,T)/T^2 \\propto 1/T$。该量明确依赖于温度，不会塌缩到一条主曲线上。对于混合系统，$S(q,T)/T^2 = (a/T) q^{-\\alpha_{\\text{th}}} + (b/T^2) q^{-\\beta}$，同样不会塌缩。所提出的归一化程序及其解释标准在物理上是不合理的。\n**结论：错误。**\n\n**选项 D**：“在固定 $q$ 值下，当 $T$ 变化时，监测 $\\log S(q,T)$ 对 $\\log q$ 的斜率。如果随着 $T$ 的增加斜率变陡（即有效指数增大），则断定涟漪是热的；如果它不随 $T$ 变化，则断定涟漪是缺陷诱导的。”\n\n该方案误解了有效指数的行为。有效指数为 $\\alpha_{\\text{eff}}(q,T) = -d(\\log S)/d(\\log q)$。对于混合系统，$\\alpha_{\\text{eff}} = (\\alpha_{\\text{th}} S_{\\text{th}} + \\beta S_{\\text{def}})/(S_{\\text{th}} + S_{\\text{def}})$。在常见的物理情景中，缺陷作为随机曲率源，我们有 $\\beta \\approx 4$，而对于热涟漪 $\\alpha_{\\text{th}} \\approx 3.18$。因此，$\\beta > \\alpha_{\\text{th}}$。随着温度 $T$ 的增加，热贡献 $S_{\\text{th}} \\propto T$ 变得更加主导。因此，有效指数 $\\alpha_{\\text{eff}}$ 将从低温下的接近 $\\beta$ 的值演变到高温下的接近 $\\alpha_{\\text{th}}$ 的值。由于 $\\beta > \\alpha_{\\text{th}}$，指数会随着 $T$ 的增加而 *减小*。$\\log S$ 对 $\\log q$ 的斜率会变得 *不那么陡峭*。该选项声称的恰恰相反。此外，对于纯热系统（$S=S_{\\text{th}}$），指数 $\\alpha_{\\text{th}}$ 与温度无关。对于纯粹由缺陷主导的系统也是如此。因此，指数不发生变化是 *纯* 系统的标志，而不一定是由缺陷诱导的系统。此逻辑在多个方面都有缺陷。\n**结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2785652"}, {"introduction": "将理论模型应用于实际数据分析是科学研究的核心技能之一。本练习将前一个练习中对高度涨落谱的理论理解转化为具体的计算实践，旨在引导我们设计一个从分子动力学（MD）模拟数据中提取关键材料参数——弯曲刚度 $\\kappa$ 的算法 [@problem_id:2785646]。这个过程不仅连接了连续介质理论与计算材料科学，还着重解决了有限尺寸效应和统计噪声等在实际分析中不可避免的挑战，全面锻炼了现代材料研究者必备的综合能力。", "problem": "您的任务是设计并实现一个算法，通过分析傅里叶空间的高度涨落谱 $\\,\\langle |h(\\mathbf{q})|^2 \\rangle\\,$，从原子尺度的分子动力学 (MD) 模拟中估算热涨落二维膜的弯曲刚度 $\\,\\kappa\\,$。您必须从第一性原理和核心定义出发：对一个有表面张力的膜，使用小斜率近似下的二次自由能泛函，\n$$\n\\mathcal{H}[h] \\;=\\; \\int d^2\\mathbf{r}\\,\\left[\\frac{\\sigma}{2}\\,(\\nabla h)^2 \\;+\\; \\frac{\\kappa}{2}\\,(\\nabla^2 h)^2\\right],\n$$\n以及在温度 $\\,T\\,$ 下的能量均分定理。在傅里叶空间中，哈密顿量在模式 $\\,h(\\mathbf{q})\\,$ 下是对角的；请将此与一个可用于估算 $\\,\\kappa\\,$ 的估算量联系起来，该估算量可基于从 MD 测量的热谱，通过线性回归进行数值化实现。您的算法还必须解决以下偏差来源：\n\n- 有限尺寸偏差：对于长度为 $\\,L\\,$ 的盒子，最小可及波数为 $\\,q_{\\min} = 2\\pi/L\\,$，而原子离散化会污染大的 $\\,q\\,$ 值。请设计一个拟合窗口，避开最高比例的 $\\,q\\,$ 模式，以减少非连续介质模型带来的伪影。\n- 有限时间偏差：有效独立样本数 $\\,M_{\\mathrm{eff}}\\,$ 受时间相关性的限制；低 $\\,q\\,$ 模式的去相关速度很慢。请通过降低噪声大的模式的权重来缓解此问题，并在采样不佳时舍弃最低的模式。\n\n您的程序必须按顺序实现以下内容：\n1. 在离散的模长 $\\,q_n = \\tfrac{2\\pi}{L}\\,n\\,$（其中 $\\,n \\in \\{1,2,\\dots,N\\}\\,$）处，通过在连续介质模型预测值附近进行随机采样并使用一个固定的伪随机种子，生成合成的测量谱 $\\,S_n^{\\mathrm{meas}}=\\langle |h(q_n)|^2\\rangle\\,$。\n2. 从基本定律出发，建立一个线性回归来同时估算 $\\,\\sigma\\,$ 和 $\\,\\kappa\\,$，并仅报告 $\\,\\kappa\\,$ 的估算值。\n3. 应用一个有限尺寸窗口，舍弃最高的 $\\,\\lceil 0.2N\\rceil\\,$ 个模式。\n4. 应用一个有限时间规则：如果 $\\,M_{\\mathrm{eff}} < 50\\,$，则额外舍弃最低的模式 $\\,n=1\\,$。\n5. 使用加权最小二乘法，其权重与 $\\,M_{\\mathrm{eff}}\\,$ 成正比。\n6. 报告每个测试用例的最终 $\\,\\kappa\\,$ 估算值，以电子伏特 (eV) 为单位，并四舍五入到三位有效数字。\n\n基本常数和单位：\n- 使用玻尔兹曼常数 $\\,k_{\\mathrm{B}} = 8.617333262\\times 10^{-5}\\,$ 电子伏特每开尔文 (eV/K)。\n- 当 $\\,L\\,$ 以纳米 (nm) 为单位时，使用面积 $\\,A = L^2\\,$，单位为平方纳米 (nm$^2$)。\n- 使用温度 $\\,T\\,$，单位为开尔文 (K)。\n- 使用波数 $\\,q\\,$，单位为逆纳米 (nm$^{-1}$)。\n- 使用表面张力 $\\,\\sigma\\,$，单位为电子伏特每平方纳米 (eV/nm$^2$)。\n- 使用弯曲刚度 $\\,\\kappa\\,$，单位为电子伏特 (eV)。\n- 所有角度（如有）都应以弧度为单位，尽管此处没有明确出现角度。\n\n测量谱的随机采样模型：\n- 对于每个模式 $\\,n\\,$，定义理论平均值\n$$\nS_n^{\\mathrm{true}} \\;=\\; \\frac{k_{\\mathrm{B}} T}{A\\,\\big(\\sigma q_n^2 + \\kappa q_n^4\\big)}.\n$$\n- 通过一个伽马分布来建模对 $\\,M_{\\mathrm{eff}}\\,$ 个有效独立样本的有限时间平均：抽取\n$$\nS_n^{\\mathrm{meas}} \\sim \\mathrm{Gamma}\\!\\left(\\text{shape}=M_{\\mathrm{eff}},\\, \\text{scale}=\\frac{S_n^{\\mathrm{true}}}{M_{\\mathrm{eff}}}\\right),\n$$\n这样 $\\,\\mathbb{E}[S_n^{\\mathrm{meas}}]=S_n^{\\mathrm{true}}\\,$ 且 $\\,\\mathrm{Var}(S_n^{\\mathrm{meas}}) = S_n^{\\mathrm{true}\\,2}/M_{\\mathrm{eff}}\\,$。\n- 使用一个固定的基础种子 $\\,s_0=1729\\,$，并且对于测试用例索引 $\\,i\\in\\{1,2,3\\}\\,$，使用种子 $\\,s_i = s_0 + i\\,$。\n\n估算量设计要求：\n- 从基本原理出发，构造一个形式如下的线性回归\n$$\ny_n \\;=\\; \\alpha\\, q_n^2 \\;+\\; \\beta\\, q_n^4,\n$$\n其中\n$$\ny_n \\;=\\; \\frac{k_{\\mathrm{B}}T}{A\\,S_n^{\\mathrm{meas}}}.\n$$\n- 通过加权最小二乘法估算 $\\,\\alpha\\,$ 和 $\\,\\beta\\,$，权重为 $\\,w_n \\propto M_{\\mathrm{eff}}\\,$ 且无截距项。然后确定\n$$\n\\widehat{\\sigma}=\\alpha,\\qquad \\widehat{\\kappa}=\\beta.\n$$\n- 在拟合前，严格按照上述规定实现有限尺寸窗口和有限时间规则。\n\n测试套件：\n- 物理常数如上所述。使用以下三个案例，每个案例由元组 $\\,(\\kappa,\\sigma,L,T,N,M_{\\mathrm{eff}})\\,$ 定义：\n  1. 案例 $\\,1\\,$: $\\,(\\kappa,\\sigma,L,T,N,M_{\\mathrm{eff}}) = (1.05\\,\\text{eV},\\, 0\\,\\text{eV/nm}^2,\\, 100\\,\\text{nm},\\, 300\\,\\text{K},\\, 12,\\, 200)\\,$.\n  2. 案例 $\\,2\\,$: $\\,(\\kappa,\\sigma,L,T,N,M_{\\mathrm{eff}}) = (0.80\\,\\text{eV},\\, 0.015\\,\\text{eV/nm}^2,\\, 80\\,\\text{nm},\\, 300\\,\\text{K},\\, 14,\\, 120)\\,$.\n  3. 案例 $\\,3\\,$: $\\,(\\kappa,\\sigma,L,T,N,M_{\\mathrm{eff}}) = (0.50\\,\\text{eV},\\, 0.050\\,\\text{eV/nm}^2,\\, 40\\,\\text{nm},\\, 300\\,\\text{K},\\, 10,\\, 30)\\,$.\n\n要求的最终输出：\n- 您的程序应产生单行输出，其中包含三个测试用例的估算弯曲刚度，以电子伏特 (eV) 为单位，每个值四舍五入到三位有效数字，格式为方括号内以逗号分隔的列表（例如，$\\,\\texttt{[1.06,0.806,0.518]}\\,$）。不应打印任何其他文本。", "solution": "我们从一个近乎平坦的膜的二次自由能泛函开始，\n$$\n\\mathcal{H}[h] \\;=\\; \\int d^2\\mathbf{r}\\,\\left[\\frac{\\sigma}{2}\\,(\\nabla h)^2 \\;+\\; \\frac{\\kappa}{2}\\,(\\nabla^2 h)^2\\right],\n$$\n其中 $\\,h(\\mathbf{r})\\,$ 是离面高度场，$\\,\\sigma\\,$ 是表面张力，$\\,\\kappa\\,$ 是弯曲刚度。通过以下方式将 $\\,h(\\mathbf{r})\\,$ 展开为傅里叶模式 $\\,h(\\mathbf{q})\\,$\n$$\nh(\\mathbf{r}) \\;=\\; \\frac{1}{A}\\sum_{\\mathbf{q}} h(\\mathbf{q})\\,e^{i\\mathbf{q}\\cdot\\mathbf{r}},\n$$\n其中面积为 $\\,A=L^2\\,$，采用周期性边界条件，离散波矢量为 $\\,\\mathbf{q}=(2\\pi/L)\\,(n_x,n_y)\\,$，其中 $\\,n_x,n_y\\,$ 为整数。在傅里叶空间中，哈密顿量对角化为：\n$$\n\\mathcal{H} \\;=\\; \\frac{A}{2}\\sum_{\\mathbf{q}}\\left(\\sigma\\,q^2 + \\kappa\\,q^4\\right)\\,|h(\\mathbf{q})|^2.\n$$\n根据温度 $\\,T\\,$ 下的能量均分定理，每个二次简正模平均贡献 $\\,\\tfrac{1}{2}k_{\\mathrm{B}}T\\,$ 的能量，这意味着\n$$\n\\frac{A}{2}\\left(\\sigma q^2 + \\kappa q^4\\right)\\,\\langle |h(\\mathbf{q})|^2 \\rangle \\;=\\; \\frac{1}{2}k_{\\mathrm{B}}T,\n$$\n因此\n$$\n\\langle |h(\\mathbf{q})|^2 \\rangle \\;=\\; \\frac{k_{\\mathrm{B}}T}{A\\left(\\sigma q^2 + \\kappa q^4\\right)}.\n$$\n这个连续介质关系式是从 MD 进行推断的理论基础。在原子尺度的分子动力学 (MD) 中，我们从快照中计算高度场的离散傅里叶振幅，并通过时间平均来估算 $\\,\\langle |h(\\mathbf{q})|^2 \\rangle\\,$。有限的盒子尺寸 $\\,L\\,$ 施加了一个最小可及波数 $\\,q_{\\min}=2\\pi/L\\,$，而原子效应会使超出连续介质模型有效范围的高 $\\,q\\,$ 值变得不准确。有限的采样会导致估算值的涨落。\n\n为了设计一个统计上有效且计算上稳健的 $\\,\\kappa\\,$ 和 $\\,\\sigma\\,$ 估算量，我们将连续介质关系式重排为线性回归形式。定义在模长 $\\,q_n = \\tfrac{2\\pi}{L}n\\,$ 处的测量谱，\n$$\nS_n^{\\mathrm{meas}} \\;\\equiv\\; \\langle |h(q_n)|^2\\rangle_{\\mathrm{meas}},\n$$\n以及变换后的响应\n$$\ny_n \\;\\equiv\\; \\frac{k_{\\mathrm{B}}T}{A\\,S_n^{\\mathrm{meas}}}.\n$$\n于是，模型变成关于 $\\,q_n^2\\,$ 和 $\\,q_n^4\\,$ 的无截距线性模型：\n$$\ny_n \\;=\\; \\sigma\\,q_n^2 \\;+\\; \\kappa\\,q_n^4.\n$$\n因此，对 $\\,y_n\\,$ 关于回归量 $\\,q_n^2\\,$ 和 $\\,q_n^4\\,$ 进行加权最小二乘回归，可以同时得到估算值 $\\,\\widehat{\\sigma}\\,$ 和 $\\,\\widehat{\\kappa}\\,$。权重用于处理有限时间采样噪声。对于一个平稳高斯模式，瞬时的 $\\,|h(q)|^2\\,$ 服从指数分布，其均值为 $\\,S_n^{\\mathrm{true}}\\,$；对 $\\,M_{\\mathrm{eff}}\\,$ 个独立样本进行平均会得到一个伽马分布，其均值为 $\\,S_n^{\\mathrm{true}}\\,$，方差为 $\\,S_n^{\\mathrm{true}\\,2}/M_{\\mathrm{eff}}\\,$。因此，相对方差与 $\\,1/M_{\\mathrm{eff}}\\,$ 成比例，这为回归中选择权重 $\\,w_n \\propto M_{\\mathrm{eff}}\\,$ 提供了依据。\n\n有限尺寸和有限时间偏差及其缓解方法：\n- 大 $\\,q\\,$ 值的有限尺寸和非连续介质污染：由于原子结构和离散化，连续介质模型在高 $\\,q\\,$ 值时可能会失效。因此，我们通过应用一个窗口，舍弃最大的 $\\,\\lceil 0.2N\\rceil\\,$ 个 $\\,q\\,$ 值，保留最低的 $\\,\\lfloor 0.8N\\rfloor\\,$ 个模式进行拟合，从而排除最高比例的模式。这减少了短波长伪影的影响，并改善了 $\\,q^2/q^4\\,$ 回归的条件数。\n- 小 $\\,q\\,$ 值的有限时间和缓慢去相关：最低的模式具有最长的弛豫时间，对于小的 $\\,M_{\\mathrm{eff}}\\,$，它们噪声尤其大。我们通过在 $\\,M_{\\mathrm{eff}}<50\\,$ 时舍弃最低模式 $\\,n=1\\,$ 来缓解此问题，从而减少一个潜在的采样不足的离群值的影响力。此外，我们使用与 $\\,M_{\\mathrm{eff}}\\,$ 成正比的权重，以反映采样增加带来的不确定性降低。\n\n实现的算法步骤：\n1. 从连续介质模型均值\n$$\nS_n^{\\mathrm{true}} \\;=\\; \\frac{k_{\\mathrm{B}}T}{A\\left(\\sigma q_n^2 + \\kappa q_n^4\\right)},\n$$\n生成合成的测量谱，使用伽马分布\n$$\nS_n^{\\mathrm{meas}} \\sim \\mathrm{Gamma}\\!\\left(\\text{shape}=M_{\\mathrm{eff}},\\, \\text{scale}=\\frac{S_n^{\\mathrm{true}}}{M_{\\mathrm{eff}}}\\right),\n$$\n对于测试用例索引 $\\,i\\in\\{1,2,3\\}\\,$，种子为 $\\,s_i = s_0 + i\\,$，基础种子为 $\\,s_0=1729\\,$。该采样的期望为 $\\,\\mathbb{E}[S_n^{\\mathrm{meas}}]=S_n^{\\mathrm{true}}\\,$，方差为 $\\,\\mathrm{Var}(S_n^{\\mathrm{meas}})=S_n^{\\mathrm{true}\\,2}/M_{\\mathrm{eff}}\\,$。\n2. 构造 $\\,y_n = k_{\\mathrm{B}}T/(A\\,S_n^{\\mathrm{meas}})\\,$ 和以 $\\,q_n^2\\,$ 和 $\\,q_n^4\\,$ 为列的设计矩阵。\n3. 应用有限尺寸窗口：舍弃最高的 $\\,\\lceil 0.2N\\rceil\\,$ 个 $\\,q\\,$ 模式。\n4. 应用有限时间规则：如果 $\\,M_{\\mathrm{eff}}<50\\,$，同时舍弃最低的模式。\n5. 执行权重为 $\\,w_n=M_{\\mathrm{eff}}\\,$ 的加权最小二乘法。令 $\\,\\mathbf{X}\\in\\mathbb{R}^{m\\times 2}\\,$ 的列为 $\\,q^2\\,$ 和 $\\,q^4\\,$，$\\,\\mathbf{y}\\in\\mathbb{R}^m\\,$ 包含 $\\,y_n\\,$，并且 $\\,\\mathbf{W}=\\mathrm{diag}(\\sqrt{w_n})\\,$。求解\n$$\n\\min_{\\boldsymbol{\\beta}\\in\\mathbb{R}^2}\\left\\| \\mathbf{W}(\\mathbf{X}\\boldsymbol{\\beta}-\\mathbf{y})\\right\\|_2^2,\n$$\n其中 $\\,\\boldsymbol{\\beta} = (\\alpha,\\beta)^\\top\\,$，然后设定 $\\,\\widehat{\\sigma}=\\alpha\\,$ 和 $\\,\\widehat{\\kappa}=\\beta\\,$。\n6. 报告每个测试用例的 $\\,\\widehat{\\kappa}\\,$，以电子伏特为单位，四舍五入到三位有效数字。\n\n测试套件规范：\n- 使用 $\\,k_{\\mathrm{B}}=8.617333262\\times 10^{-5}\\,$ eV/K 和 $\\,A=L^2\\,$.\n- 三个案例，每个由 $\\,(\\kappa,\\sigma,L,T,N,M_{\\mathrm{eff}})\\,$ 定义：\n  - 案例 $\\,1\\,$: $\\,(\\,1.05\\,\\text{eV},\\, 0\\,\\text{eV/nm}^2,\\, 100\\,\\text{nm},\\, 300\\,\\text{K},\\, 12,\\, 200\\,)\\,$.\n  - 案例 $\\,2\\,$: $\\,(\\,0.80\\,\\text{eV},\\, 0.015\\,\\text{eV/nm}^2,\\, 80\\,\\text{nm},\\, 300\\,\\text{K},\\, 14,\\, 120\\,)\\,$.\n  - 案例 $\\,3\\,$: $\\,(\\,0.50\\,\\text{eV},\\, 0.050\\,\\text{eV/nm}^2,\\, 40\\,\\text{nm},\\, 300\\,\\text{K},\\, 10,\\, 30\\,)\\,$.\n- 对于测试用例索引 $\\,i\\in\\{1,2,3\\}\\,$，使用种子 $\\,s_i=1729+i\\,$。对每个案例，定义 $\\,q_n=(2\\pi/L)\\,n\\,$，其中 $\\,n=1,\\dots,N\\,$，如上所述生成 $\\,S_n^{\\mathrm{meas}}\\,$，应用窗口和规则，进行拟合，并以 Python 风格的、逗号分隔的浮点数列表形式在单行中输出三个 $\\,\\widehat{\\kappa}\\,$ 值，每个值四舍五入到三位有效数字。\n\n该设计将膜的连续介质统计力学与一个数值稳定且能感知偏差的估算量联系起来，该估算量可直接从 MD 高度谱实现。测试套件检验了弯曲主导的区域、张力-弯曲混合的区域，以及一个具有挑战性的小系统、低采样率区域，该区域凸显了有限尺寸和有限时间的考虑。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Constants\nK_B_EV_PER_K = 8.617333262e-5  # eV/K\n\ndef generate_measured_spectrum(kappa_eV, sigma_eV_per_nm2, L_nm, T_K, N_modes, M_eff, seed):\n    \"\"\"\n    Generate synthetic measured spectrum S_meas for q_n = 2*pi*n/L with n=1..N_modes.\n    Uses a gamma distribution with shape=M_eff and scale=S_true/M_eff to model finite-time averaging.\n    Returns (q_array, S_meas_array).\n    \"\"\"\n    A_nm2 = L_nm ** 2\n    n = np.arange(1, N_modes + 1, dtype=float)\n    q = 2.0 * np.pi * n / L_nm  # nm^-1\n    # True spectrum from continuum\n    denom = sigma_eV_per_nm2 * q**2 + kappa_eV * q**4\n    S_true = (K_B_EV_PER_K * T_K) / (A_nm2 * denom)  # nm^2\n    # Gamma noise model: mean = S_true, var = S_true^2 / M_eff\n    rng = np.random.default_rng(seed)\n    shape = float(M_eff)\n    # For numerical stability, ensure positive scale:\n    scale = S_true / M_eff\n    S_meas = rng.gamma(shape=shape, scale=scale, size=S_true.shape)\n    return q, S_meas\n\ndef estimate_kappa_from_spectrum(q, S_meas, L_nm, T_K, M_eff, drop_high_frac=0.2, drop_low_if_M_lt=50):\n    \"\"\"\n    Estimate kappa (and sigma) via weighted least squares from y = k_B T / (A*S_meas) = sigma*q^2 + kappa*q^4.\n    Applies:\n      - finite-size window: drops the highest ceil(drop_high_frac * N) modes,\n      - finite-time rule: if M_eff  drop_low_if_M_lt, drops the lowest mode.\n    Returns (kappa_est, sigma_est).\n    \"\"\"\n    A_nm2 = L_nm ** 2\n    y = (K_B_EV_PER_K * T_K) / (A_nm2 * S_meas)\n\n    # Sort by q ascending just in case\n    order = np.argsort(q)\n    q = q[order]\n    y = y[order]\n\n    N = q.size\n    # Drop the highest fraction of modes\n    n_drop_high = int(np.ceil(drop_high_frac * N))\n    keep_end = N - n_drop_high if n_drop_high  N else 0\n\n    q_sel = q[:keep_end] if keep_end > 0 else np.array([], dtype=float)\n    y_sel = y[:keep_end] if keep_end > 0 else np.array([], dtype=float)\n\n    # Drop the lowest mode if M_eff is small\n    if M_eff  drop_low_if_M_lt and q_sel.size > 0:\n        q_sel = q_sel[1:] if q_sel.size > 1 else np.array([], dtype=float)\n        y_sel = y_sel[1:] if y_sel.size > 1 else np.array([], dtype=float)\n\n    if q_sel.size  2:\n        # Fallback: not enough data to fit two parameters; return NaNs\n        return float('nan'), float('nan')\n\n    # Design matrix with columns [q^2, q^4]\n    X = np.vstack([q_sel**2, q_sel**4]).T\n    # Weights proportional to M_eff (constant here)\n    w = np.full(q_sel.shape, float(M_eff))\n    sqrt_w = np.sqrt(w)\n    Xw = X * sqrt_w[:, None]\n    yw = y_sel * sqrt_w\n\n    # Solve weighted least squares without intercept\n    beta, *_ = np.linalg.lstsq(Xw, yw, rcond=None)\n    sigma_est, kappa_est = beta[0], beta[1]\n    return float(kappa_est), float(sigma_est)\n\ndef solve():\n    # Test cases as specified in the problem statement\n    # Each case: (kappa_true_eV, sigma_true_eV_per_nm2, L_nm, T_K, N_modes, M_eff)\n    test_cases = [\n        (1.05, 0.0,   100.0, 300.0, 12, 200),     # Case 1\n        (0.80, 0.015,  80.0, 300.0, 14, 120),     # Case 2\n        (0.50, 0.050,  40.0, 300.0, 10,  30),     # Case 3\n    ]\n    base_seed = 1729\n\n    kappa_estimates = []\n    for i, (kappa_true, sigma_true, L_nm, T_K, N_modes, M_eff) in enumerate(test_cases, start=1):\n        seed = base_seed + i\n        q, S_meas = generate_measured_spectrum(\n            kappa_eV=kappa_true,\n            sigma_eV_per_nm2=sigma_true,\n            L_nm=L_nm,\n            T_K=T_K,\n            N_modes=N_modes,\n            M_eff=M_eff,\n            seed=seed\n        )\n        kappa_est, sigma_est = estimate_kappa_from_spectrum(\n            q=q, S_meas=S_meas, L_nm=L_nm, T_K=T_K, M_eff=M_eff,\n            drop_high_frac=0.2, drop_low_if_M_lt=50\n        )\n        # Round to three significant figures for output formatting\n        if np.isnan(kappa_est):\n            # In unexpected degenerate cases, output nan\n            kappa_estimates.append(\"nan\")\n        else:\n            # Format to 3 significant figures\n            kappa_estimates.append(f\"{kappa_est:.3g}\")\n    \n    # Final print statement in the exact required format.\n    # The required format in the problem is an example, this code produces the correct output.\n    print(f\"[{','.join(map(str, kappa_estimates))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2785646"}]}