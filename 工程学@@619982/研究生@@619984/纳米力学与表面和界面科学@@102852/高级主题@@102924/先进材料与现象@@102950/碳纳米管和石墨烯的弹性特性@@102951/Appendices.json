{"hands_on_practices": [{"introduction": "如何将实验测量结果与材料的内在属性联系起来？本练习将指导你如何使用经典的连续介质壳模型，将碳纳米管的原始实验数据（如刚度 $k$）转化为关键的材料参数（杨氏模量 $E$）。这项实践突显了固体力学在纳米尺度的直接应用，并引入了几何假设（如纳米管壁厚 $t$）在参数推断中的关键作用。[@problem_id:2770320]", "problem": "一根初始标距为 $L$、平均半径为 $R$、壁厚为 $t$ 的单壁碳纳米管（SWCNT）在小应变范围内进行轴向拉伸测试。力-伸长曲线在初始范围内呈线性，测得线性区的斜率为 $k = \\mathrm{d}F/\\mathrm{d}\\Delta$。假设该单壁碳纳米管可被视为一个薄壁圆柱壳，其壁内应力为均匀平面应力，且线弹性和小应变理论适用。忽略任何末端柔度或夹持效应，因此测得的斜率 $k$ 即为纳米管本身的轴向刚度。\n\n从工程应力和工程应变的基本定义以及各向同性连续介质的胡克定律出发，通过恰当确定承载横截面积，推导杨氏模量 $E$ 与可测量 $k$、$L$、$R$ 和 $t$ 之间的关系。然后，根据以下实验测得的参数计算 $E$ 的值：\n- 标距 $L = 1.00\\,\\mu\\mathrm{m}$，\n- 平均半径 $R = 1.00\\,\\mathrm{nm}$，\n- 壁厚 $t = 0.340\\,\\mathrm{nm}$，\n- 初始力-伸长斜率 $k = 2.20\\,\\mathrm{N/m}$。\n\n最后，通过计算相对灵敏度\n$$\nS_t \\equiv \\frac{\\partial \\ln E}{\\partial \\ln t}\n$$\n来量化推断出的模量对假设壁厚的灵敏度，计算时固定测量值 $k$、$L$ 和 $R$。\n\n将模量 $E$ 以太帕斯卡（TPa）为单位表示，并四舍五入至三位有效数字。将 $S_t$ 报告为一个无单位的纯数。你的最终答案必须是数对 $\\big(E\\ \\text{in TPa},\\ S_t\\big)$。", "solution": "所述问题在科学上是成立的，问题定义明确、客观且内部一致。这是一个将连续介质力学原理应用于纳米尺度对象的标准练习。我们将按要求进行推导和计算。\n\n本任务旨在建立单壁碳纳米管（SWCNT）的杨氏模量 $E$ 与其实验可测量性质之间的关系。该SWCNT被建模为初始长度为 $L$、平均半径为 $R$、壁厚为 $t$ 的薄壁圆柱壳。轴向刚度 $k$ 从拉伸测试中得出。\n\n首先，我们从线弹性和固体力学中建立基本关系。\n轴向工程应力 $\\sigma$ 定义为所施加的轴向力 $F$ 除以其作用的横截面积 $A$：\n$$\n\\sigma = \\frac{F}{A}\n$$\n轴向工程应变 $\\varepsilon$ 定义为长度变化量 $\\Delta L$ 除以初始长度 $L$：\n$$\n\\varepsilon = \\frac{\\Delta L}{L}\n$$\n对于处于单轴拉伸状态下的线弹性各向同性材料，胡克定律通过杨氏模量 $E$ 将应力与应变关联起来：\n$$\n\\sigma = E \\varepsilon\n$$\n将应力和应变的定义代入胡克定律，我们得到：\n$$\n\\frac{F}{A} = E \\frac{\\Delta L}{L}\n$$\n我们可以重新整理这个方程，以表达力 $F$ 和伸长量 $\\Delta L$ 之间的关系：\n$$\nF = \\left(\\frac{EA}{L}\\right) \\Delta L\n$$\n问题陈述力-伸长曲线在初始区域是线性的，其斜率定义为轴向刚度 $k$。对于线性关系，该斜率为常数：\n$$\nk = \\frac{F}{\\Delta L}\n$$\n通过将此定义与整理后的胡克定律进行比较，我们可以确定刚度 $k$ 为：\n$$\nk = \\frac{EA}{L}\n$$\n由此，我们可以用刚度 $k$、长度 $L$ 和面积 $A$ 来表示杨氏模量 $E$：\n$$\nE = \\frac{kL}{A}\n$$\n下一步是确定横截面积 $A$。SWCNT被建模为平均半径为 $R$、壁厚为 $t$ 的空心圆柱体。其横截面为一个圆环。设外半径为 $R_{out}$，内半径为 $R_{in}$。它们与平均半径和壁厚的关系如下：\n$$\nR = \\frac{R_{out} + R_{in}}{2}\n$$\n$$\nt = R_{out} - R_{in}\n$$\n从这两个方程中，我们可以解出 $R_{out}$ 和 $R_{in}$：$R_{out} = R + \\frac{t}{2}$ 和 $R_{in} = R - \\frac{t}{2}$。\n圆环的面积由下式给出：\n$$\nA = \\pi (R_{out}^2 - R_{in}^2) = \\pi \\left( \\left(R + \\frac{t}{2}\\right)^2 - \\left(R - \\frac{t}{2}\\right)^2 \\right)\n$$\n展开括号内的项：\n$$\nA = \\pi \\left( \\left(R^2 + Rt + \\frac{t^2}{4}\\right) - \\left(R^2 - Rt + \\frac{t^2}{4}\\right) \\right)\n$$\n$$\nA = \\pi (R^2 + Rt + \\frac{t^2}{4} - R^2 + Rt - \\frac{t^2}{4}) = \\pi (2Rt)\n$$\n因此，承载横截面积为：\n$$\nA = 2\\pi Rt\n$$\n将面积 $A$ 的这个表达式代入杨氏模量 $E$ 的方程中，我们得到所需的关系式：\n$$\nE = \\frac{kL}{2\\pi Rt}\n$$\n这个方程将杨氏模量与可测量 $k$、$L$、$R$ 以及假定的厚度 $t$ 联系起来。\n\n接下来，我们使用提供的实验参数计算 $E$。我们必须首先将所有参数转换为一致的国际单位制单位（米、牛顿）。\n- 标距：$L = 1.00\\,\\mu\\mathrm{m} = 1.00 \\times 10^{-6}\\,\\mathrm{m}$\n- 平均半径：$R = 1.00\\,\\mathrm{nm} = 1.00 \\times 10^{-9}\\,\\mathrm{m}$\n- 壁厚：$t = 0.340\\,\\mathrm{nm} = 0.340 \\times 10^{-9}\\,\\mathrm{m}$\n- 刚度：$k = 2.20\\,\\mathrm{N/m}$\n\n我们将这些值代入我们推导出的 $E$ 的表达式中：\n$$\nE = \\frac{(2.20\\,\\mathrm{N/m}) (1.00 \\times 10^{-6}\\,\\mathrm{m})}{2\\pi (1.00 \\times 10^{-9}\\,\\mathrm{m}) (0.340 \\times 10^{-9}\\,\\mathrm{m})}\n$$\n$$\nE = \\frac{2.20 \\times 10^{-6}}{2\\pi \\times 0.340 \\times 10^{-18}} \\, \\mathrm{N/m^2}\n$$\n$$\nE = \\frac{2.20}{0.680\\pi} \\times 10^{12} \\, \\mathrm{Pa}\n$$\n因为 $1\\,\\mathrm{TPa} = 10^{12}\\,\\mathrm{Pa}$，我们有：\n$$\nE = \\left(\\frac{2.20}{0.680\\pi}\\right) \\mathrm{TPa} \\approx 1.0298... \\, \\mathrm{TPa}\n$$\n四舍五入到三位有效数字，杨氏模量为 $E \\approx 1.03 \\, \\mathrm{TPa}$。\n\n最后，我们必须量化推断出的模量 $E$ 对假设壁厚 $t$ 的灵敏度。相对灵敏度定义为：\n$$\nS_t \\equiv \\frac{\\partial \\ln E}{\\partial \\ln t}\n$$\n为了计算这个值，我们首先对我们得到的 $E$ 的表达式取自然对数：\n$$\n\\ln E = \\ln\\left(\\frac{kL}{2\\pi Rt}\\right)\n$$\n利用对数的性质，我们可以展开这个表达式：\n$$\n\\ln E = \\ln(kL) - \\ln(2\\pi R) - \\ln(t)\n$$\n问题要求在固定的测量值 $k$、$L$ 和 $R$ 下计算此灵敏度。因此，当我们对 $\\ln t$ 求导时，$\\ln(kL)$ 和 $\\ln(2\\pi R)$ 项是常数。设 $u = \\ln t$。导数变为：\n$$\nS_t = \\frac{\\mathrm{d}}{\\mathrm{d}u} (\\text{constant} - u) = -1\n$$\n相对灵敏度 $S_t$ 恰好为 $-1$。这个结果与各参数的取值无关，因为它源于 $E \\propto t^{-1}$ 的反比关系。$S_t = -1$ 的值表明，假设的厚度 $t$ 增加 $1\\%$ 将导致计算出的杨氏模量 $E$ 减少 $1\\%$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1.03 & -1 \\end{pmatrix}}\n$$", "id": "2770320"}, {"introduction": "连续介质模型中使用的弹性常数究竟源于何处？本练习在离散的原子世界和我们用以描述它的连续模型之间架起了一座桥梁。通过将柯西-玻恩法则 (Cauchy-Born rule) 应用于一个简化的石墨烯原子间势，你将从微观的力常数中推导出宏观的弹性属性（二维体模量 $K_{2\\mathrm{D}}$），从而为材料刚度提供一个基于更基本原理的视角。[@problem_id:2770369]", "problem": "石墨烯可被建模为一个二维 (2D) 蜂窝状碳原子晶格，其最近邻键长为 $a_{0}$，每个原子有三个最近邻原子。考虑一个谐波价力场，其中原子间势能分别是所有最近邻键的键伸缩项和所有成键三原子组的键角项之和：\n$$\nU \\;=\\; \\sum_{\\langle i j\\rangle} \\frac{1}{2}\\,k_{r}\\,\\big(\\Delta r_{ij}\\big)^{2} \\;+\\; \\sum_{\\langle i j k\\rangle} \\frac{1}{2}\\,k_{\\theta}\\,\\big(\\Delta \\theta_{jik}\\big)^{2},\n$$\n其中 $k_{r}$ 是键伸缩刚度，$k_{\\theta}$ 是键角弯曲刚度，$\\Delta r_{ij}$ 是原子 $i$ 和 $j$ 之间的键长变化量，$\\Delta \\theta_{jik}$ 是在原子 $j$ 处，连接原子 $i$ 和 $k$ 的键之间的键角变化量。角度以弧度为单位。\n\n施加一个均匀的面内形变，使得形变梯度为 $F=(1+\\varepsilon)\\,I$，其中 $I$ 是单位张量，$\\varepsilon$ 是一个小的等双轴工程应变。使用柯西-玻恩法则将晶格形变与宏观应变关联起来，推导截至 $\\varepsilon^{2}$ 阶的单位面积应变能密度 $W(\\varepsilon)$，并由此确定由各向同性二维连续介质的标准二次弹性势能定义的二维体模量 $K_{2\\mathrm{D}}$。使用石墨烯的几何结构，即边长为 $a=\\sqrt{3}\\,a_{0}$ 的原胞面积为 $A_{\\mathrm{cell}}=(\\sqrt{3}/2)\\,a^{2}$ 且包含两个原子。\n\n取 $a_{0}=0.142\\,\\mathrm{nm}$ 且 $k_{r}=700\\,\\mathrm{N/m}$。提供 $K_{2\\mathrm{D}}$ 的最终数值（单位为 $\\mathrm{N/m}$），并将您的答案四舍五入到四位有效数字。", "solution": "对问题陈述进行验证。\n\n**第一步：提取已知条件**\n- **模型：** 石墨烯为二维 (2D) 蜂窝晶格。\n- **键长：** 最近邻键长为 $a_{0}$。\n- **配位数：** 每个原子有三个最近邻原子。\n- **势能：** $U = \\sum_{\\langle i j\\rangle} \\frac{1}{2}\\,k_{r}\\,\\big(\\Delta r_{ij}\\big)^{2} + \\sum_{\\langle i j k\\rangle} \\frac{1}{2}\\,k_{\\theta}\\,\\big(\\Delta \\theta_{jik}\\big)^{2}$。\n- **刚度常数：** $k_{r}$ 是键伸缩刚度；$k_{\\theta}$ 是键角弯曲刚度。\n- **形变变量：** $\\Delta r_{ij}$ 是键长变化量；$\\Delta \\theta_{jik}$ 是键角变化量（单位为弧度）。\n- **施加的形变：** 均匀面内形变，形变梯度为 $F=(1+\\varepsilon)\\,I$，其中 $I$ 是单位张量，$\\varepsilon$ 是一个小的等双轴工程应变。\n- **假设：** 柯西-玻恩法则将晶格形变与宏观应变关联。\n- **目标1：** 推导截至 $\\varepsilon^{2}$ 阶的单位面积应变能密度 $W(\\varepsilon)$。\n- **目标2：** 确定二维体模量 $K_{2\\mathrm{D}}$。\n- **石墨烯几何结构：** 原胞的边长为 $a=\\sqrt{3}\\,a_{0}$，面积为 $A_{\\mathrm{cell}}=(\\sqrt{3}/2)\\,a^{2}$，且包含两个原子。\n- **数值：** $a_{0}=0.142\\,\\mathrm{nm}$，$k_{r}=700\\,\\mathrm{N/m}$。\n- **最终要求：** 提供 $K_{2\\mathrm{D}}$ 的数值（单位为 $\\mathrm{N/m}$），并四舍五入到四位有效数字。\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据，采用了标准的价力场模型和柯西-玻恩法则，这些都是晶体材料纳米力学中常用且有效的近似方法。该问题是客观且适定的。一个潜在的问题是，势能项中包含了刚度为 $k_{\\theta}$ 的项，但并未给出其数值。然而，指定的形变是等双轴应变，其形变梯度为 $F=(1+\\varepsilon)I$。这种形变对应于晶格的均匀缩放。在均匀缩放中，所有角度都保持不变。因此，对于所有成键三原子组，键角变化量 $\\Delta \\theta_{jik}$ 恒等于零。对于这种特定的形变，包含 $k_{\\theta}$ 的项对总应变能没有贡献。因此，在没有 $k_{\\theta}$ 值的情况下，该问题是自洽且可解的。这是一个结构良好的问题，而非有缺陷的问题。\n\n**第三步：结论与行动**\n该问题有效。将提供完整解答。\n\n求解过程首先应用柯西-玻恩法则，确定原子尺度上的键长和键角变化。然后，计算每个原胞的应变能。将此能量除以原胞面积进行归一化，得到应变能密度 $W(\\varepsilon)$。最后，将 $W(\\varepsilon)$ 与各向同性二维材料的宏观连续介质表达式进行比较，以提取二维体模量 $K_{2\\mathrm{D}}$。\n\n根据柯西-玻恩法则，宏观形变梯度 $F$ 将未形变晶格中的一个矢量 $\\mathbf{r}$ 映射到形变后晶格中的一个矢量 $\\mathbf{r}' = F\\mathbf{r}$。对于给定的等双轴应变，$F=(1+\\varepsilon)I$。最近邻原子 $i$ 和 $j$ 之间的键矢量 $\\mathbf{r}_{ij}$ 的初始长度为 $|\\mathbf{r}_{ij}| = a_0$。形变后，新的键矢量为 $\\mathbf{r}'_{ij} = F\\mathbf{r}_{ij} = (1+\\varepsilon)\\mathbf{r}_{ij}$。\n\n新的键长为 $r'_{ij} = |\\mathbf{r}'_{ij}| = |(1+\\varepsilon)\\mathbf{r}_{ij}| = (1+\\varepsilon)|\\mathbf{r}_{ij}| = (1+\\varepsilon)a_0$，假设 $1+\\varepsilon > 0$。键长的变化量为：\n$$\n\\Delta r_{ij} = r'_{ij} - a_0 = (1+\\varepsilon)a_0 - a_0 = \\varepsilon a_0\n$$\n此结果是精确的，并对所有最近邻键均成立。\n\n接下来，考虑键 $\\mathbf{r}_{ji}$ 和 $\\mathbf{r}_{jk}$ 之间的键角 $\\theta_{jik}$。该角度由 $\\cos(\\theta_{jik}) = \\frac{\\mathbf{r}_{ji} \\cdot \\mathbf{r}_{jk}}{|\\mathbf{r}_{ji}| |\\mathbf{r}_{jk}|}$ 给出。形变后，新的矢量为 $\\mathbf{r}'_{ji}=(1+\\varepsilon)\\mathbf{r}_{ji}$ 和 $\\mathbf{r}'_{jk}=(1+\\varepsilon)\\mathbf{r}_{jk}$。新的角度 $\\theta'_{jik}$ 由下式给出：\n$$\n\\cos(\\theta'_{jik}) = \\frac{\\mathbf{r}'_{ji} \\cdot \\mathbf{r}'_{jk}}{|\\mathbf{r}'_{ji}| |\\mathbf{r}'_{jk}|} = \\frac{(1+\\varepsilon)\\mathbf{r}_{ji} \\cdot (1+\\varepsilon)\\mathbf{r}_{jk}}{|(1+\\varepsilon)\\mathbf{r}_{ji}| |(1+\\varepsilon)\\mathbf{r}_{jk}|} = \\frac{(1+\\varepsilon)^2 (\\mathbf{r}_{ji} \\cdot \\mathbf{r}_{jk})}{(1+\\varepsilon)^2 |\\mathbf{r}_{ji}| |\\mathbf{r}_{jk}|} = \\cos(\\theta_{jik})\n$$\n因此，$\\theta'_{jik} = \\theta_{jik}$，键角变化量为 $\\Delta\\theta_{jik} = 0$。\n\n由于键角弯曲项为零，总势能 $U$ 大大简化：\n$$\nU = \\sum_{\\langle i j\\rangle} \\frac{1}{2}\\,k_{r}\\,\\big(\\Delta r_{ij}\\big)^{2} = \\sum_{\\langle i j\\rangle} \\frac{1}{2}\\,k_{r}\\,\\big(\\varepsilon a_0\\big)^{2}\n$$\n为求应变能密度，我们首先计算石墨烯晶格中每个原胞的总能量。原胞包含 $N=2$ 个原子。每个碳原子形成 $Z=3$ 个共价键。由于每个键由两个原子共享，每个原胞的键数为 $N_b = \\frac{N \\times Z}{2} = \\frac{2 \\times 3}{2} = 3$。\n\n每个原胞的应变能 $U_{\\mathrm{cell}}$ 是储存在这 3 个键中的能量之和：\n$$\nU_{\\mathrm{cell}} = 3 \\times \\frac{1}{2}\\,k_{r}\\,\\big(\\varepsilon a_0\\big)^{2} = \\frac{3}{2}\\,k_{r}\\,a_0^2\\,\\varepsilon^2\n$$\n题目给出了未形变的原胞面积为 $A_{\\mathrm{cell}} = \\frac{\\sqrt{3}}{2}a^2$，其中晶格常数 $a = \\sqrt{3}a_0$。代入 $a$：\n$$\nA_{\\mathrm{cell}} = \\frac{\\sqrt{3}}{2}\\left(\\sqrt{3}a_0\\right)^2 = \\frac{\\sqrt{3}}{2}\\left(3a_0^2\\right) = \\frac{3\\sqrt{3}}{2}a_0^2\n$$\n单位面积的应变能密度 $W(\\varepsilon)$ 是每个原胞的应变能除以原胞的未形变面积：\n$$\nW(\\varepsilon) = \\frac{U_{\\mathrm{cell}}}{A_{\\mathrm{cell}}} = \\frac{\\frac{3}{2}\\,k_{r}\\,a_0^2\\,\\varepsilon^2}{\\frac{3\\sqrt{3}}{2}a_0^2} = \\frac{k_{r}}{\\sqrt{3}}\\varepsilon^2\n$$\n这就是推导出的截至 $\\varepsilon^2$ 阶的应变能密度。\n\n现在，我们将此结果与各向同性材料的二维线性弹性理论表达式进行比较。等双轴应变 $\\varepsilon$ 的应变张量为 $\\boldsymbol{\\epsilon} = \\begin{pmatrix} \\varepsilon & 0 \\\\ 0 & \\varepsilon \\end{pmatrix}$。应变能密度 $W$ 由下式给出：\n$$\nW = \\frac{1}{2} K_{2\\mathrm{D}} (\\mathrm{tr}(\\boldsymbol{\\epsilon}))^2 + G_{2\\mathrm{D}} \\mathrm{tr}((\\boldsymbol{\\epsilon} - \\frac{1}{2}\\mathrm{tr}(\\boldsymbol{\\epsilon})I)^2)\n$$\n其中 $K_{2\\mathrm{D}}$ 是二维体模量，$G_{2\\mathrm{D}}$ 是二维剪切模量。对于等双轴应变，应变的偏量（剪切）部分为零，因此第二项消失。应变张量的迹为 $\\mathrm{tr}(\\boldsymbol{\\epsilon}) = \\varepsilon + \\varepsilon = 2\\varepsilon$。应变能密度简化为：\n$$\nW(\\varepsilon) = \\frac{1}{2} K_{2\\mathrm{D}} (2\\varepsilon)^2 = \\frac{1}{2} K_{2\\mathrm{D}} (4\\varepsilon^2) = 2 K_{2\\mathrm{D}} \\varepsilon^2\n$$\n通过将从原子层面推导的 $W(\\varepsilon)$ 表达式与连续介质力学表达式相等，我们可以确定 $K_{2\\mathrm{D}}$：\n$$\n\\frac{k_{r}}{\\sqrt{3}}\\varepsilon^2 = 2 K_{2\\mathrm{D}} \\varepsilon^2\n$$\n求解 $K_{2\\mathrm{D}}$ 可得：\n$$\nK_{2\\mathrm{D}} = \\frac{k_{r}}{2\\sqrt{3}}\n$$\n已知 $k_{r} = 700\\,\\mathrm{N/m}$。代入此值：\n$$\nK_{2\\mathrm{D}} = \\frac{700}{2\\sqrt{3}} = \\frac{350}{\\sqrt{3}} \\,\\mathrm{N/m}\n$$\n计算数值：\n$$\nK_{2\\mathrm{D}} \\approx 202.07259... \\,\\mathrm{N/m}\n$$\n根据题目要求四舍五入到四位有效数字，得到：\n$$\nK_{2\\mathrm{D}} \\approx 202.1 \\,\\mathrm{N/m}\n$$", "answer": "$$\n\\boxed{202.1}\n$$", "id": "2770369"}, {"introduction": "局部连续介质弹性理论在宏观尺度上表现良好，但可能无法捕捉声子色散等纳米尺度现象，在这些现象中声速依赖于波长。本练习引入了一个非局部弹性模型来解决这一问题，并要求你完成一项常见的研究任务：将模型参数与数据进行拟合。你将开发一个计算程序，从给定的石墨烯声学波色散曲线中估计非局部特征长度 $\\ell$。[@problem_id:2770356]", "problem": "考虑一个被建模为二维（2D）弹性连续介质的单层石墨烯中的平面内纵向声波。使用线性动量平衡方程 $\\,\\rho_{2\\mathrm{D}} \\,\\partial^2 \\boldsymbol{u}/\\partial t^2 = \\nabla \\cdot \\boldsymbol{\\sigma}\\,$、线性运动学关系以及一个由卷积核定义的 Eringen 型非局域本构关系，其微分形式为 $(1 - \\ell^2 \\nabla^2)\\,\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon}$。其中，$\\rho_{2\\mathrm{D}}$ 是二维质量密度，$\\boldsymbol{u}$ 是位移场，$\\boldsymbol{\\sigma}$ 是柯西应力，$\\boldsymbol{\\varepsilon}$ 是无穷小应变，$\\mathbb{C}$ 是二维弹性张量，$\\ell$ 是一个待定的单一非局域特征长度。考虑在布里渊区（BZ）中心附近形式为 $\\boldsymbol{u}(\\boldsymbol{x},t) = \\Re\\{\\boldsymbol{U}\\,\\mathrm{e}^{\\mathrm{i}(\\boldsymbol{q}\\cdot \\boldsymbol{x} - \\omega t)}\\}$ 的平面波解，其中波矢大小 $q = \\|\\boldsymbol{q}\\| \\ge 0$，角频率 $\\omega \\ge 0$。定义相速度 $v(q) \\equiv \\omega/q$ 和长波极限 $v_0 \\equiv \\lim_{q \\to 0^+} v(q)$。\n\n任务：\n1. 从上述控制关系出发，推导出一个在布里渊区中心附近对平面内纵向分支有效的、$v(q)$、$v_0$、$q$ 和 $\\ell$ 之间的关系。该推导必须基于平面波的傅里叶域代数，并得出一个表达式，使得能够从 $q$ 和 $v(q)$ 数据中估计 $\\ell$，而无需引入额外的未知参数。\n2. 展示如何将您的结果重排成一个关于 $\\ell^2$ 的线性形式，以便可以从已知 $v_0$ 的数据对 $(q_i, v_i)$ 中获得 $\\ell$ 的非负最小二乘估计。\n3. 在一个程序中实现这个估计器，该程序接收以下测试套件数据集，并为每个数据集输出拟合的 $\\ell$ 值（单位为纳米，nm），四舍五入到三位小数。所有波矢大小 $q$ 的单位为 $\\mathrm{nm}^{-1}$，所有速度 $v$ 和 $v_0$ 的单位为 $\\mathrm{m/s}$。您的实现必须独立处理每个数据集，并为每个数据集估计一个单一的 $\\ell$ 值。\n\n测试套件（四个独立的数据集）：\n- 数据集 A（类石墨烯纵向波，中等非局域性）：\n  - $v_0 = 21300$; $q = [\\,0.05,\\,0.1,\\,0.2,\\,0.3,\\,0.4\\,]$; $v(q) = [\\,21297.604156,\\,21290.421471,\\,21261.763518,\\,21214.259060,\\,21148.296288\\,]$。\n- 数据集 B（非局域性可忽略的边界情况）：\n  - $v_0 = 21300$; $q = [\\,0.05,\\,0.1,\\,0.2,\\,0.3,\\,0.4\\,]$; $v(q) = [\\,21300.0,\\,21300.0,\\,21300.0,\\,21300.0,\\,21300.0\\,]$。\n- 数据集 C（类石墨烯横向波尺度，非局域性更强，$q$ 范围更宽）：\n  - $v_0 = 14200$; $q = [\\,0.1,\\,0.2,\\,0.3,\\,0.5,\\,0.8\\,]$; $v(q) = [\\,14182.28328125,\\,14129.52710682,\\,14042.94578125,\\,13776.02350206,\\,13184.36901058\\,]$。\n- 数据集 D（小 $q$ 边缘情况，以测试数值稳定性）：\n  - $v_0 = 20000$; $q = [\\,0.001,\\,0.002,\\,0.005\\,]$; $v(q) = [\\,19999.9991,\\,19999.9964,\\,19999.9775\\,]$。\n\n编程要求：\n- 使用从您的分析中推导出的线性最小二乘估计器，为每个数据集获得 $\\ell^2$ 的非负估计，从而得到 $\\ell$。\n- 将每个拟合的 $\\ell$ 以 $\\mathrm{nm}$ 为单位表示，四舍五入到三位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个数据集的估计 $\\ell$ 值，形式为方括号内的逗号分隔列表，例如，“[0.123,0.000,0.456,0.789]”。不允许在任何其他行上有任何其他输出。", "solution": "所给出的问题在科学上是合理的、自洽的且适定的。它涉及纳米力学中的一个标准课题——使用非局域连续介质弹性力学对二维材料中的尺寸效应进行建模。其控制方程和本构模型是公认的。完成任务所需的所有参数和数据均已提供。因此，我们可以直接进行推导和求解。\n\n该任务分为三个部分：首先，推导纵向声波的色散关系；其次，为线性参数估计重排此关系；第三，实现此估计器以从所提供的数据中找到非局域参数 $\\ell$。\n\n**第一部分：色散关系的推导**\n\n我们从一个二维弹性连续介质的控制方程开始：\n运动方程：\n$$ \\rho_{2\\mathrm{D}} \\frac{\\partial^2 \\boldsymbol{u}}{\\partial t^2} = \\nabla \\cdot \\boldsymbol{\\sigma} $$\nEringen 型非局域本构关系：\n$$ (1 - \\ell^2 \\nabla^2)\\,\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon} $$\n线性运动学关系：\n$$ \\boldsymbol{\\varepsilon} = \\frac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^T) $$\n我们寻求形式为 $\\boldsymbol{u}(\\boldsymbol{x},t) = \\boldsymbol{U}\\,\\mathrm{e}^{\\mathrm{i}(\\boldsymbol{q}\\cdot \\boldsymbol{x} - \\omega t)}$ 的平面波解，其中 $\\boldsymbol{U}$ 是常数振幅矢量，$\\boldsymbol{q}$ 是波矢，$\\omega$ 是角频率。对于此类波，微分算子在傅里叶域中转换为代数因子：\n$$ \\frac{\\partial^2}{\\partial t^2} \\rightarrow (-\\mathrm{i}\\omega)^2 = -\\omega^2 $$\n$$ \\nabla \\rightarrow \\mathrm{i}\\boldsymbol{q} $$\n$$ \\nabla^2 = \\nabla \\cdot \\nabla \\rightarrow (\\mathrm{i}\\boldsymbol{q}) \\cdot (\\mathrm{i}\\boldsymbol{q}) = -q^2, \\quad \\text{其中 } q = \\|\\boldsymbol{q}\\| $$\n将这些变换应用于控制方程，我们得到它们的代数对应形式。运动学关系变为：\n$$ \\boldsymbol{\\varepsilon} = \\frac{1}{2}(\\mathrm{i}\\boldsymbol{q} \\otimes \\boldsymbol{u} + (\\mathrm{i}\\boldsymbol{q} \\otimes \\boldsymbol{u})^T) = \\frac{\\mathrm{i}}{2}(\\boldsymbol{q} \\otimes \\boldsymbol{u} + \\boldsymbol{u} \\otimes \\boldsymbol{q}) $$\n本构关系变为：\n$$ (1 - \\ell^2(-q^2))\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon} \\implies \\boldsymbol{\\sigma} = \\frac{1}{1 + \\ell^2 q^2} \\mathbb{C} : \\boldsymbol{\\varepsilon} $$\n运动方程变为：\n$$ \\rho_{2\\mathrm{D}} (-\\omega^2 \\boldsymbol{u}) = \\mathrm{i}\\boldsymbol{q} \\cdot \\boldsymbol{\\sigma} $$\n将 $\\boldsymbol{\\sigma}$ 的表达式代入运动方程，然后再代入 $\\boldsymbol{\\varepsilon}$ 的表达式：\n$$ -\\rho_{2\\mathrm{D}} \\omega^2 \\boldsymbol{u} = \\frac{\\mathrm{i}\\boldsymbol{q}}{1 + \\ell^2 q^2} \\cdot \\left( \\mathbb{C} : \\frac{\\mathrm{i}}{2}(\\boldsymbol{q} \\otimes \\boldsymbol{u} + \\boldsymbol{u} \\otimes \\boldsymbol{q}) \\right) $$\n$$ \\rho_{2\\mathrm{D}} \\omega^2 \\boldsymbol{u} = \\frac{1}{1 + \\ell^2 q^2} \\boldsymbol{q} \\cdot \\left( \\mathbb{C} : \\frac{1}{2}(\\boldsymbol{q} \\otimes \\boldsymbol{u} + \\boldsymbol{u} \\otimes \\boldsymbol{q}) \\right) $$\n我们关心的是平面内纵向波，其位移矢量 $\\boldsymbol{U}$ 平行于波矢 $\\boldsymbol{q}$。设 $\\hat{\\boldsymbol{n}} = \\boldsymbol{q}/q$ 为传播方向上的单位矢量。那么 $\\boldsymbol{U} = U \\hat{\\boldsymbol{n}}$ 且 $\\boldsymbol{q} = q \\hat{\\boldsymbol{n}}$。项 $\\frac{1}{2}(\\boldsymbol{q} \\otimes \\boldsymbol{u} + \\boldsymbol{u} \\otimes \\boldsymbol{q})$ 简化为 $Uq(\\hat{\\boldsymbol{n}} \\otimes \\hat{\\boldsymbol{n}}) \\mathrm{e}^{\\mathrm{i}(\\boldsymbol{q}\\cdot\\boldsymbol{x}-\\omega t)}$。将此代入方程并消去公因子 $U \\mathrm{e}^{\\mathrm{i}(\\boldsymbol{q}\\cdot\\boldsymbol{x}-\\omega t)}$，得到非局域模型的 Christoffel 方程：\n$$ \\rho_{2\\mathrm{D}} \\omega^2 \\hat{\\boldsymbol{n}} = \\frac{q^2}{1 + \\ell^2 q^2} \\left[ \\hat{\\boldsymbol{n}} \\cdot (\\mathbb{C} : (\\hat{\\boldsymbol{n}} \\otimes \\hat{\\boldsymbol{n}})) \\right] $$\n对于像石墨烯这样的二维各向同性材料，方括号中的项会简化。平面应力弹性张量为 $\\mathbb{C}_{ijkl} = \\lambda_{2\\mathrm{D}}\\delta_{ij}\\delta_{kl} + \\mu_{2\\mathrm{D}}(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})$。投影 $\\hat{\\boldsymbol{n}} \\cdot (\\mathbb{C} : (\\hat{\\boldsymbol{n}} \\otimes \\hat{\\boldsymbol{n}}))$ 的计算结果为 $(\\lambda_{2\\mathrm{D}} + 2\\mu_{2\\mathrm{D}})\\hat{\\boldsymbol{n}}$。此项代表二维薄片的纵向模量。\n因此，方程变为：\n$$ \\rho_{2\\mathrm{D}} \\omega^2 \\hat{\\boldsymbol{n}} = \\frac{q^2}{1 + \\ell^2 q^2} (\\lambda_{2\\mathrm{D}} + 2\\mu_{2\\mathrm{D}}) \\hat{\\boldsymbol{n}} $$\n取两边的模量，得到色散关系：\n$$ \\rho_{2\\mathrm{D}} \\omega^2 = \\frac{q^2}{1 + \\ell^2 q^2} (\\lambda_{2\\mathrm{D}} + 2\\mu_{2\\mathrm{D}}) $$\n长波相速度 $v_0 = \\lim_{q\\to 0^+} \\omega/q$ 是由局域弹性情况（$\\ell=0$）决定的，此时 $\\rho_{2\\mathrm{D}} v_0^2 = \\lambda_{2\\mathrm{D}} + 2\\mu_{2\\mathrm{D}}$。将此恒等式代入非局域色散关系：\n$$ \\rho_{2\\mathrm{D}} \\omega^2 = \\frac{q^2}{1 + \\ell^2 q^2} (\\rho_{2\\mathrm{D}} v_0^2) \\implies \\omega^2 = \\frac{q^2 v_0^2}{1 + \\ell^2 q^2} $$\n相速度为 $v(q) = \\omega/q$。将其平方并代入 $\\omega^2$ 的关系式，得到所需的表达式：\n$$ v(q)^2 = \\frac{\\omega^2}{q^2} = \\frac{v_0^2}{1 + \\ell^2 q^2} $$\n这就是 $v(q)$、$v_0$、$q$ 和 $\\ell$ 之间的关系。\n\n**第二部分：为线性最小二乘估计进行重排**\n\n目标是利用已知的 $v_0$ 从数据对 $(q_i, v_i)$ 中估计 $\\ell$。我们必须将推导出的关系重排成一个关于未知参数 $\\ell^2$ 的线性形式。\n$$ v(q)^2(1 + \\ell^2 q^2) = v_0^2 $$\n$$ 1 + \\ell^2 q^2 = \\frac{v_0^2}{v(q)^2} $$\n$$ \\ell^2 q^2 = \\frac{v_0^2}{v(q)^2} - 1 $$\n这种形式适用于线性回归。让我们为每个数据点 $(q_i, v_i)$ 定义一个转换后的响应变量 $Y_i$ 和一个预测变量 $X_i$：\n$$ Y_i = \\left(\\frac{v_0}{v_i}\\right)^2 - 1 \\quad \\text{和} \\quad X_i = q_i^2 $$\n通过这些定义，模型变为 $Y_i = \\ell^2 X_i$。这是一个通过原点的简单线性回归模型，其中斜率为 $\\ell^2$。给定一组 $N$ 个数据点，$\\ell^2$ 的最小二乘估计值（表示为 $\\hat{\\ell}^2$）是使残差平方和 $\\sum_i (Y_i - \\ell^2 X_i)^2$ 最小化的值。其标准解为：\n$$ \\hat{\\ell}^2 = \\frac{\\sum_i X_i Y_i}{\\sum_i X_i^2} = \\frac{\\sum_i q_i^2 \\left( \\left(\\frac{v_0}{v_i}\\right)^2 - 1 \\right)}{\\sum_i q_i^4} $$\n问题要求对 $\\ell$ 进行非负估计。对于物理上一致的数据，即相速度随波数减小（$v_i \\le v_0$），项 $(v_0/v_i)^2 - 1$ 将是非负的。由于 $q_i^2$ 也是非负的，因此 $\\hat{\\ell}^2$ 估计式的分子和分母都是非负项的和，从而也将是非负的。因此，标准的最小二乘估计本质上是非负的。特征长度的最终估计为 $\\ell = \\sqrt{\\hat{\\ell}^2}$。\n\n**第三部分：实现**\n\n推导出的估计器将使用 Python 中的 `numpy` 库来实现，以进行高效的数组计算。该程序将遍历四个提供的数据集中的每一个，计算 $X_i = q_i^2$ 和 $Y_i = (v_0/v_i)^2 - 1$ 的向量，然后通过点积实现上述公式来计算 $\\hat{\\ell}^2$。最终值 $\\ell$ 通过取平方根获得，并按要求格式化结果。\n\n对于数据集 B，所有点的 $v_i = v_0$，导致所有 $i$ 的 $Y_i=0$。估计器的分子变为零，从而正确地得到 $\\ell=0$，这对应于局域弹性（非色散）极限。对于其他数据集，数据点是根据特定 $\\ell$ 值的模型方程精确生成的，因此估计器应该能够精确地恢复这些值，直至浮点精度。计算证实，对于数据集 A、C 和 D，$\\ell^2$ 的估计器也将是精确的。代码将稳健地执行这些计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the nonlocal characteristic length l for four datasets\n    using a derived linear least-squares estimator.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"id\": \"A\",\n            \"v0\": 21300.0,\n            \"q\": np.array([0.05, 0.1, 0.2, 0.3, 0.4]),\n            \"v\": np.array([21297.604156, 21290.421471, 21261.763518, 21214.259060, 21148.296288])\n        },\n        {\n            \"id\": \"B\",\n            \"v0\": 21300.0,\n            \"q\": np.array([0.05, 0.1, 0.2, 0.3, 0.4]),\n            \"v\": np.array([21300.0, 21300.0, 21300.0, 21300.0, 21300.0])\n        },\n        {\n            \"id\": \"C\",\n            \"v0\": 14200.0,\n            \"q\": np.array([0.1, 0.2, 0.3, 0.5, 0.8]),\n            \"v\": np.array([14182.28328125, 14129.52710682, 14042.94578125, 13776.02350206, 13184.36901058])\n        },\n        {\n            \"id\": \"D\",\n            \"v0\": 20000.0,\n            \"q\": np.array([0.001, 0.002, 0.005]),\n            \"v\": np.array([19999.9991, 19999.9964, 19999.9775])\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        v0 = case[\"v0\"]\n        q = case[\"q\"]\n        v = case[\"v\"]\n\n        # The model is v(q)^2 = v0^2 / (1 + l^2 * q^2).\n        # Rearranging gives: l^2 * q^2 = (v0/v)^2 - 1.\n        # This is a linear regression through the origin: Y = m*X,\n        # where Y = (v0/v)^2 - 1, X = q^2, and the slope m = l^2.\n\n        # The least-squares estimate for the slope m is sum(X*Y) / sum(X^2).\n\n        # It is crucial to use high-precision floating point numbers for these calculations.\n        q = q.astype(np.float64)\n        v = v.astype(np.float64)\n        v0 = np.float64(v0)\n\n        # Predictor variable X = q^2\n        X = q**2\n        \n        # Response variable Y = (v0/v)^2 - 1\n        # A small epsilon is added to v to prevent division by zero, though not strictly\n        # necessary for the given test data.\n        Y = (v0 / (v + 1e-15))**2 - 1\n\n        # Calculate the numerator and denominator for the l_squared estimate.\n        # Numerator = sum(X_i * Y_i)\n        numerator = np.dot(X, Y)\n        # Denominator = sum(X_i^2)\n        denominator = np.dot(X, X)\n\n        l_squared = 0.0\n        if denominator > 1e-15:  # Avoid division by zero if all q are zero.\n            l_squared = numerator / denominator\n        \n        # Ensure non-negativity as per the problem statement's requirement for a\n        # \"nonnegative least-squares estimate\". For physically consistent data,\n        # l_squared will already be non-negative.\n        l_squared = max(0.0, l_squared)\n\n        # The characteristic length l is the square root of l_squared.\n        l_est = np.sqrt(l_squared)\n        \n        # Format the result to three decimal places.\n        results.append(f\"{l_est:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2770356"}]}