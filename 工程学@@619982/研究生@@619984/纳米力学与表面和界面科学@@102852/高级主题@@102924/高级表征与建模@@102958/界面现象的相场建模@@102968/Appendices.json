{"hands_on_practices": [{"introduction": "本练习是相场建模分析的经典起点。通过这个练习，你将运用变分法这一基本工具，来推导一个简单平面界面的平衡结构和能量，体会梯度能和体自由能之间的竞争与平衡。掌握这个核心推导过程，是理解更复杂的界面现象和后续高级应用的基石 [@problem_id:2782605]。", "problem": "纳米尺度上的二元固溶体由一个标量序参量$\\phi(x)$来描述，该参量区分了两个体相平衡值分别为$\\phi=0$和$\\phi=1$的相。考虑一个垂直于$x$-轴的平直、静止界面，因此$\\phi=\\phi(x)$仅依赖于$x$。遵循用于弥散界面的 Ginzburg–Landau 范式，单位界面面积的亥姆霍兹自由能被假定为以下泛函\n$$\\mathcal{F}[\\phi] \\;=\\; \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} \\;+\\; W\\,\\phi^{2}\\left(1-\\phi\\right)^{2} \\right] \\, dx,$$\n其中$\\kappa>0$是梯度能量系数，$W>0$设定了对称双势阱体相自由能密度的势垒高度。假设系统处于热力学平衡状态，边界条件为$\\phi(-\\infty)=0$和$\\phi(+\\infty)=1$。\n\n仅从变分法和泛函$\\mathcal{F}[\\phi]$极小化子的平衡条件出发，不使用任何快捷公式，推导静止界面剖面$\\phi(x)$，并用它来确定单位面积的界面自由能（表面能）\n$$\\gamma \\;=\\; \\min_{\\phi}\\,\\mathcal{F}[\\phi],$$\n注意，对于给定的势，在$\\phi=0$和$\\phi=1$处，均匀体相自由能密度为零。请以$\\kappa$和$W$的形式，给出$\\gamma$的单个闭合形式解析表达式。不得代入任何数值，也不要在最终表达式后附加单位。", "solution": "在尝试求解之前，对所述问题进行验证。\n\n步骤 1：提取已知条件\n-   标量序参量$\\phi(x)$描述了一个二元固溶体。\n-   定义域是一维的，$-\\infty < x < \\infty$。\n-   单位面积的亥姆霍兹自由能泛函由$\\mathcal{F}[\\phi] = \\int_{-\\infty}^{\\infty} L(\\phi, \\phi') \\, dx$给出，其中拉格朗日密度为$L(\\phi, \\phi') = \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} + W\\,\\phi^{2}\\left(1-\\phi\\right)^{2}$。\n-   梯度能量系数为$\\kappa > 0$。\n-   势能垒高度参数为$W > 0$。\n-   系统处于热力学平衡状态，这对应于使泛函$\\mathcal{F}[\\phi]$最小化的构型$\\phi(x)$。\n-   界面剖面的边界条件是$\\phi(x \\to -\\infty) = 0$和$\\phi(x \\to +\\infty) = 1$。\n-   目标是推导静止界面剖面$\\phi(x)$并计算界面自由能$\\gamma = \\min_{\\phi}\\,\\mathcal{F}[\\phi]$。\n\n步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据。它提出了一个用于一维界面的经典 Ginzburg-Landau 型模型，这是材料科学和凝聚态物理学中使用的相场理论的基石。对于对称双势阱，该泛函形式是标准的。问题是适定的；它是一个标准的变分法问题，具有指定的边界条件和正定参数（$\\kappa, W > 0$），这确保了稳定的非平凡解的存在。问题陈述是客观的，使用了精确的数学语言，没有模糊性或主观论断。该问题是自洽的，并为其解决提供了所有必要的信息。它没有违反任何指定的无效标准。\n\n步骤 3：结论与行动\n该问题有效。将基于变分法原理构建解答。\n\n平衡界面剖面$\\phi(x)$是使自由能泛函$\\mathcal{F}[\\phi]$最小化的函数。这样的极小化子必须满足欧拉-拉格朗日方程：\n$$ \\frac{\\partial L}{\\partial \\phi} - \\frac{d}{dx}\\left(\\frac{\\partial L}{\\partial \\phi'}\\right) = 0 $$\n其中$\\phi' \\equiv \\frac{d\\phi}{dx}$且拉格朗日密度为$L(\\phi, \\phi') = \\frac{\\kappa}{2}(\\phi')^{2} + W\\,\\phi^{2}(1-\\phi)^{2}$。\n\n首先，我们计算$L$所需的偏导数：\n$$ \\frac{\\partial L}{\\partial \\phi'} = \\kappa \\phi' $$\n$$ \\frac{\\partial L}{\\partial \\phi} = W \\frac{d}{d\\phi}\\left[\\phi^2(1-\\phi)^2\\right] = W \\left[ 2\\phi(1-\\phi)^2 + \\phi^2 \\cdot 2(1-\\phi)(-1) \\right] = 2W\\phi(1-\\phi)\\left[ (1-\\phi) - \\phi \\right] = 2W\\phi(1-\\phi)(1-2\\phi) $$\n将这些代入欧拉-拉格朗日方程，得到静止剖面$\\phi(x)$的控制常微分方程：\n$$ 2W\\phi(1-\\phi)(1-2\\phi) - \\frac{d}{dx}(\\kappa \\phi') = 0 $$\n$$ \\kappa \\frac{d^2\\phi}{dx^2} = 2W\\phi(1-\\phi)(1-2\\phi) $$\n这是一个二阶、非线性、自治微分方程。由于拉格朗日量$L$不显式依赖于$x$，存在一个由贝尔特拉米恒等式给出的第一运动积分：\n$$ L - \\phi' \\frac{\\partial L}{\\partial \\phi'} = C $$\n其中$C$是一个积分常数。代入$L$和$\\frac{\\partial L}{\\partial \\phi'}$的表达式：\n$$ \\left( \\frac{\\kappa}{2}(\\phi')^2 + W\\phi^2(1-\\phi)^2 \\right) - \\phi' (\\kappa \\phi') = C $$\n$$ -\\frac{\\kappa}{2}(\\phi')^2 + W\\phi^2(1-\\phi)^2 = C $$\n常数$C$由边界条件确定。在$x \\to \\pm \\infty$时，界面剖面必须趋近于体相平衡态，在这些状态下剖面是平坦的。因此，$\\phi' \\to 0$。\n在$x \\to -\\infty$时，$\\phi \\to 0$且$\\phi' \\to 0$。方程变为$W(0)^2(1-0)^2 = C$，得出$C=0$。\n在$x \\to +\\infty$时，$\\phi \\to 1$且$\\phi' \\to 0$。方程变为$W(1)^2(1-1)^2 = C$，也得出$C=0$。\n当$C=0$时，我们得到了一个对平衡剖面有效的关键关系式：\n$$ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^2 = W\\phi^2(1-\\phi)^2 $$\n该方程意味着平衡状态下的能量均分：沿着剖面的每一点$x$，梯度能量密度等于势能密度。\n\n我们现在可以求解$\\frac{d\\phi}{dx}$：\n$$ \\left(\\frac{d\\phi}{dx}\\right)^2 = \\frac{2W}{\\kappa} \\phi^2(1-\\phi)^2 $$\n$$ \\frac{d\\phi}{dx} = \\pm \\sqrt{\\frac{2W}{\\kappa}} \\phi(1-\\phi) $$\n根据边界条件$\\phi(-\\infty)=0$和$\\phi(+\\infty)=1$，序参量$\\phi$必须是$x$的单调递增函数。因此，$\\frac{d\\phi}{dx} > 0$。对于$\\phi \\in (0,1)$，项$\\phi(1-\\phi)$是正的。因此我们选择正根：\n$$ \\frac{d\\phi}{dx} = \\sqrt{\\frac{2W}{\\kappa}} \\phi(1-\\phi) $$\n这是一个一阶可分离变量微分方程。我们重新整理以分离变量：\n$$ \\frac{d\\phi}{\\phi(1-\\phi)} = \\sqrt{\\frac{2W}{\\kappa}} \\, dx $$\n对两边进行积分，左侧需要使用部分分式分解：$\\frac{1}{\\phi(1-\\phi)} = \\frac{1}{\\phi} + \\frac{1}{1-\\phi}$。\n$$ \\int \\left(\\frac{1}{\\phi} + \\frac{1}{1-\\phi}\\right) d\\phi = \\int \\sqrt{\\frac{2W}{\\kappa}} \\, dx $$\n$$ \\ln(\\phi) - \\ln(1-\\phi) = x\\sqrt{\\frac{2W}{\\kappa}} + C_1 $$\n因为$\\phi \\in (0,1)$，所以省略了绝对值符号。根据对称性，我们将界面中心定义在$x=0$处，此处$\\phi(0) = 1/2$。这个条件决定了积分常数$C_1$：\n$$ \\ln\\left(\\frac{1/2}{1-1/2}\\right) = \\ln(1) = 0 = 0 \\cdot \\sqrt{\\frac{2W}{\\kappa}} + C_1 \\implies C_1 = 0 $$\n因此，我们有：\n$$ \\ln\\left(\\frac{\\phi}{1-\\phi}\\right) = x\\sqrt{\\frac{2W}{\\kappa}} $$\n求解$\\phi(x)$：\n$$ \\frac{\\phi}{1-\\phi} = \\exp\\left(x\\sqrt{\\frac{2W}{\\kappa}}\\right) \\implies \\phi = (1-\\phi)\\exp\\left(x\\sqrt{\\frac{2W}{\\kappa}}\\right) \\implies \\phi\\left(1 + \\exp\\left(x\\sqrt{\\frac{2W}{\\kappa}}\\right)\\right) = \\exp\\left(x\\sqrt{\\frac{2W}{\\kappa}}\\right) $$\n$$ \\phi(x) = \\frac{\\exp\\left(x\\sqrt{\\frac{2W}{\\kappa}}\\right)}{1 + \\exp\\left(x\\sqrt{\\frac{2W}{\\kappa}}\\right)} = \\frac{1}{1 + \\exp\\left(-x\\sqrt{\\frac{2W}{\\kappa}}\\right)} $$\n这个剖面可以用双曲正切函数表示为：\n$$ \\phi(x) = \\frac{1}{2}\\left[1 + \\tanh\\left(\\frac{x}{2}\\sqrt{\\frac{2W}{\\kappa}}\\right)\\right] = \\frac{1}{2}\\left[1 + \\tanh\\left(x\\sqrt{\\frac{W}{2\\kappa}}\\right)\\right] $$\n这就是静止界面剖面$\\phi(x)$。\n\n接下来，我们计算界面自由能$\\gamma$，它是对此平衡剖面求得的泛函$\\mathcal{F}[\\phi]$的值：\n$$ \\gamma = \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} + W\\,\\phi^{2}(1-\\phi)^{2} \\right] \\, dx $$\n使用前面推导出的能量均分关系$\\frac{\\kappa}{2}(\\phi')^2 = W\\phi^2(1-\\phi)^2$，我们可以简化被积函数：\n$$ \\gamma = \\int_{-\\infty}^{\\infty} 2 \\cdot \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^2 \\right] dx = \\int_{-\\infty}^{\\infty} \\kappa \\left(\\frac{d\\phi}{dx}\\right)^2 dx $$\n为了计算这个积分，最有效的方法是将积分变量从$x$换为$\\phi$。由于$\\frac{d\\phi}{dx} dx = d\\phi$，我们可以重写$\\frac{d\\phi}{dx}$的一个因子，并进行积分限的变更，从$x \\in (-\\infty, \\infty)$变为$\\phi \\in (0, 1)$：\n$$ \\gamma = \\int_{0}^{1} \\kappa \\left(\\frac{d\\phi}{dx}\\right) d\\phi $$\n现在代入$\\frac{d\\phi}{dx} = \\sqrt{\\frac{2W}{\\kappa}}\\phi(1-\\phi)$的表达式：\n$$ \\gamma = \\int_{0}^{1} \\kappa \\left( \\sqrt{\\frac{2W}{\\kappa}}\\phi(1-\\phi) \\right) d\\phi = \\kappa \\sqrt{\\frac{2W}{\\kappa}} \\int_{0}^{1} (\\phi-\\phi^2) d\\phi $$\n$$ \\gamma = \\sqrt{\\kappa^2 \\frac{2W}{\\kappa}} \\int_{0}^{1} (\\phi-\\phi^2) d\\phi = \\sqrt{2\\kappa W} \\int_{0}^{1} (\\phi-\\phi^2) d\\phi $$\n该定积分是初等的：\n$$ \\int_{0}^{1} (\\phi-\\phi^2) d\\phi = \\left[\\frac{\\phi^2}{2} - \\frac{\\phi^3}{3}\\right]_{0}^{1} = \\left(\\frac{1}{2} - \\frac{1}{3}\\right) - (0) = \\frac{1}{6} $$\n最后，代入此结果，我们得到界面自由能：\n$$ \\gamma = \\sqrt{2\\kappa W} \\cdot \\frac{1}{6} = \\frac{\\sqrt{2\\kappa W}}{6} $$\n这就是用给定参数$\\kappa$和$W$表示的表面能的最终闭合形式表达式。", "answer": "$$\\boxed{\\frac{\\sqrt{2\\kappa W}}{6}}$$", "id": "2782605"}, {"introduction": "在掌握了平面界面的基本性质后，下一个重要的步骤是探究曲率如何影响系统的能量。本练习将引导你从相场自由能泛函出发，通过虚功原理，为球形液滴推导著名的杨-拉普拉斯方程。这个过程将清晰地展示相场模型如何从微观参数（如梯度能量系数 $\\kappa$ 和势垒高度 $A$）自然地导出宏观物理定律（如毛细压力），从而深刻理解界面张力的物理本质 [@problem_id:2782607]。", "problem": "考虑一个等温二元混合物，其由一个标量相场序参量$\\phi(\\mathbf{x})$描述，该参量在两相中的平衡体相值为$\\pm \\phi_{0}$。在区域$\\Omega \\subset \\mathbb{R}^{3}$中的Helmholtz自由能泛函为\n$$\n\\mathcal{F}[\\phi] \\;=\\; \\int_{\\Omega} \\left[ \\frac{\\kappa}{2}\\,|\\nabla \\phi|^{2} \\;+\\; f(\\phi) \\right] \\,\\mathrm{d}V,\n$$\n其中$\\kappa>0$是梯度能量系数，均匀自由能密度为对称双势阱\n$$\nf(\\phi) \\;=\\; \\frac{A}{4}\\,\\left(\\phi^{2}-\\phi_{0}^{2}\\right)^{2},\n$$\n其中$A>0$。假设一个半径为$R$的单一球形$+\\phi_{0}$相液滴嵌入在$-\\phi_{0}$相中，界面处于力学和化学平衡状态，并且液滴半径满足$R \\gg \\ell$，其中$\\ell$是由$(\\kappa,A,\\phi_{0})$设定的内禀弥散界面厚度。\n\n从自由能泛函$\\mathcal{F}$和界面自由能（表面张力）的定义（即与静态一维界面分布相关的单位面积过剩自由能）出发，基于变分力学执行以下步骤：\n\n1. 对于序参量仅在法向坐标$z$上变化的平直界面，利用$\\mathcal{F}$的稳态性将欧拉-拉格朗日方程简化为一个联系$\\partial_{z}\\phi$和$f(\\phi)$的第一积分。然后，将表面张力$\\gamma$表示为关于$\\phi$的一维积分，并用$\\kappa$、$A$和$\\phi_{0}$以闭式形式求出其值。\n\n2. 将近球形液滴的曲面界面在$\\ell/R$的领头阶上建模为局部平直，因此界面自由能为$F_{\\text{int}} \\approx \\gamma A$，其中$A=4\\pi R^{2}$是液滴的表面积。利用固定组分下的虚拟等温形状变化，以及界面两边的压差$\\Delta p$在体积发生微小变化时所做的可逆功等于界面自由能的变化这一原理，推导球形界面上的拉普拉斯压力跳跃$\\Delta p$的领头阶表达式。\n\n请用$\\kappa$、$A$、$\\phi_{0}$和$R$给出一个关于$\\Delta p$的单一闭式解析表达式。压力单位使用帕斯卡（国际单位制）。不要引入任何额外参数。不需要进行数值计算，也不需要四舍五-入。您的最终答案必须是一个单一表达式，而非方程或不等式。", "solution": "首先对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- Helmholtz自由能泛函：$\\mathcal{F}[\\phi] = \\int_{\\Omega} \\left[ \\frac{\\kappa}{2}\\,|\\nabla \\phi|^{2} + f(\\phi) \\right] \\,\\mathrm{d}V$\n- 相场序参量：$\\phi(\\mathbf{x})$\n- 平衡体相值：$\\pm \\phi_{0}$\n- 梯度能量系数：$\\kappa > 0$\n- 均匀自由能密度：$f(\\phi) = \\frac{A}{4}\\,\\left(\\phi^{2}-\\phi_{0}^{2}\\right)^{2}$\n- 常数：$A > 0$\n- 系统几何形状：半径为$R$的球形液滴处于周围基体中。\n- 系统条件：力学和化学平衡。\n- 假设：$R \\gg \\ell$，其中$\\ell$是界面厚度。\n- 任务1：求平直界面的表面张力$\\gamma$，用$\\kappa$、$A$和$\\phi_{0}$表示。\n- 任务2：推导球形液滴的拉普拉斯压力$\\Delta p$。\n- 注意到的歧义：符号$A$用于两个不同的量：势函数$f(\\phi)$中的常数和液滴的表面积$A = 4\\pi R^{2}$。这种记法不佳。然而，题目要求最终答案用$\\kappa$、$A$、$\\phi_{0}$和$R$表示，这意味着最终表达式中的符号$A$必须指势函数常数，因为液滴面积是$R$的函数。尽管存在这种歧义，问题仍然可以解决。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于相变领域的Ginzburg-Landau（或Cahn-Hilliard/Allen-Cahn）理论，这是连续介质力学和材料科学的基石。从自由能泛函推导表面张力和拉普拉斯压力是一个标准的基本过程。\n- **适定性：** 该问题在数学上是适定的。它提供了明确的目标和足够的信息，可以使用变分原理推导出唯一的解。\n- **客观性：** 语言正式，不含主观内容。\n\n**步骤3：结论与行动**\n该问题被判定为**有效**。记法上的歧义是一个小缺陷，但并不妨碍严谨和唯一的求解。我将继续进行推导。\n\n总体目标是推导球形界面上的拉普拉斯压力$\\Delta p$。这按照要求分两步完成。\n\n**步骤1：表面张力$\\gamma$的推导**\n\n我们考虑一个平面界面，其中序参量$\\phi$仅沿垂直于界面的坐标$z$变化。单位界面面积的自由能泛函为\n$$\n\\frac{\\mathcal{F}}{A_{xy}} = \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\kappa}{2} \\left( \\frac{d\\phi}{dz} \\right)^2 + f(\\phi) \\right] dz\n$$\n被积函数$\\mathcal{L}(\\phi, \\phi') = \\frac{\\kappa}{2}(\\phi')^2 + f(\\phi)$是拉格朗日密度，其中$\\phi' = d\\phi/dz$。平衡分布$\\phi(z)$必须满足欧拉-拉格朗日方程：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\phi} - \\frac{d}{dz}\\left( \\frac{\\partial \\mathcal{L}}{\\partial \\phi'} \\right) = 0\n$$\n这得到$f'(\\phi) - \\frac{d}{dz}(\\kappa \\phi') = 0$，或$\\kappa \\phi'' = f'(\\phi)$。\n\n由于拉格朗日量$\\mathcal{L}$不显式依赖于自变量$z$，我们可以使用Beltrami恒等式找到一个运动第一积分：\n$$\n\\mathcal{L} - \\phi' \\frac{\\partial \\mathcal{L}}{\\partial \\phi'} = \\text{constant}\n$$\n$$\n\\left( \\frac{\\kappa}{2}(\\phi')^2 + f(\\phi) \\right) - \\phi'(\\kappa \\phi') = -\\frac{\\kappa}{2}(\\phi')^2 + f(\\phi) = C\n$$\n为了确定常数$C$，我们应用远离界面的边界条件，此时系统处于均匀体相中。当$z \\to \\pm \\infty$时，$\\phi \\to \\pm \\phi_0$且剖面变得平坦，所以$\\phi' \\to 0$。在体相中，自由能密度处于其最小值，$f(\\pm\\phi_0) = \\frac{A}{4}(\\phi_0^2-\\phi_0^2)^2 = 0$。将这些条件代入第一积分，得到$C=0$。\n因此，我们得到联系$\\phi'$与$f(\\phi)$的第一积分：\n$$\n\\frac{\\kappa}{2} \\left( \\frac{d\\phi}{dz} \\right)^2 = f(\\phi)\n$$\n这就是任务第一部分所要求的关系式。\n\n表面张力$\\gamma$定义为单位界面面积的过剩自由能。由于体相自由能密度$f(\\pm\\phi_0) = 0$，这可简化为拉格朗日密度的积分：\n$$\n\\gamma = \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\kappa}{2}(\\phi')^2 + f(\\phi) \\right] dz\n$$\n使用第一积分，我们可以将其写为$\\gamma = \\int_{-\\infty}^{\\infty} 2f(\\phi) dz$，或者为了计算方便，写为$\\gamma = \\int_{-\\infty}^{\\infty} \\kappa(\\phi')^2 dz$。我们将通过把积分变量从$z$变为$\\phi$来进行计算。从第一积分可知，$\\phi' = \\frac{d\\phi}{dz} = \\sqrt{\\frac{2f(\\phi)}{\\kappa}}$。积分范围是穿过界面，从$\\phi = -\\phi_0$到$\\phi = +\\phi_0$。\n$$\n\\gamma = \\int_{-\\infty}^{\\infty} \\sqrt{2\\kappa f(\\phi)} \\frac{d\\phi}{dz} dz = \\int_{-\\phi_0}^{\\phi_0} \\sqrt{2\\kappa f(\\phi)} d\\phi\n$$\n现在，我们代入给定的$f(\\phi) = \\frac{A}{4}(\\phi^2-\\phi_0^2)^2$形式：\n$$\n\\gamma = \\int_{-\\phi_0}^{\\phi_0} \\sqrt{2\\kappa \\frac{A}{4} (\\phi^2 - \\phi_0^2)^2} d\\phi = \\sqrt{\\frac{\\kappa A}{2}} \\int_{-\\phi_0}^{\\phi_0} |\\phi^2 - \\phi_0^2| d\\phi\n$$\n在积分范围$(-\\phi_0, \\phi_0)$内，项$\\phi^2 - \\phi_0^2$是非正的，所以$|\\phi^2 - \\phi_0^2| = \\phi_0^2 - \\phi^2$。\n$$\n\\gamma = \\sqrt{\\frac{\\kappa A}{2}} \\int_{-\\phi_0}^{\\phi_0} (\\phi_0^2 - \\phi^2) d\\phi\n$$\n直接计算该积分：\n$$\n\\int_{-\\phi_0}^{\\phi_0} (\\phi_0^2 - \\phi^2) d\\phi = \\left[ \\phi_0^2 \\phi - \\frac{\\phi^3}{3} \\right]_{-\\phi_0}^{\\phi_0} = \\left(\\phi_0^3 - \\frac{\\phi_0^3}{3}\\right) - \\left(-\\phi_0^3 + \\frac{\\phi_0^3}{3}\\right) = \\frac{2}{3}\\phi_0^3 - \\left(-\\frac{2}{3}\\phi_0^3\\right) = \\frac{4}{3}\\phi_0^3\n$$\n将此结果代回$\\gamma$的表达式中：\n$$\n\\gamma = \\sqrt{\\frac{\\kappa A}{2}} \\left( \\frac{4}{3}\\phi_0^3 \\right) = \\frac{4\\phi_0^3}{3\\sqrt{2}} \\sqrt{\\kappa A} = \\frac{2\\sqrt{2}}{3} \\phi_0^3 \\sqrt{\\kappa A}\n$$\n\n**步骤2：拉普拉斯压力$\\Delta p$的推导**\n\n对于半径为$R$的球形液滴，当$R$远大于界面厚度$\\ell$时，我们可以将界面自由能近似为平直界面表面张力$\\gamma$与液滴表面积$A_{surf} = 4\\pi R^2$的乘积。\n$$\nF_{\\text{int}} \\approx \\gamma A_{surf} = \\gamma (4\\pi R^2)\n$$\n虚功原理指出，在力学平衡状态下，对于无穷小的体积变化$dV$，由压差$\\Delta p$所做的功$dW$等于界面自由能$dF_{\\text{int}}$的相应变化。我们考虑一个总组分固定的等温过程。\n$$\ndW = dF_{\\text{int}}\n$$\n压差所做的功为$dW = \\Delta p \\, dV$。自由能的变化为$dF_{\\text{int}} = d(\\gamma A_{surf})$。由于$\\gamma$是一个与$R$无关的材料属性，我们有$dF_{\\text{int}} = \\gamma \\, dA_{surf}$。\n令两者相等可得：\n$$\n\\Delta p \\, dV = \\gamma \\, dA_{surf} \\implies \\Delta p = \\gamma \\frac{dA_{surf}}{dV}\n$$\n对于球体，体积为$V = \\frac{4}{3}\\pi R^3$，表面积为$A_{surf} = 4\\pi R^2$。我们使用关于半径$R$的链式法则来计算导数：\n$$\n\\frac{dA_{surf}}{dV} = \\frac{dA_{surf}/dR}{dV/dR} = \\frac{\\frac{d}{dR}(4\\pi R^2)}{\\frac{d}{dR}(\\frac{4}{3}\\pi R^3)} = \\frac{8\\pi R}{4\\pi R^2} = \\frac{2}{R}\n$$\n这便得到了著名的针对球形界面的杨-拉普拉斯方程：\n$$\n\\Delta p = \\frac{2\\gamma}{R}\n$$\n最后，我们代入步骤1中推导出的$\\gamma$表达式，以获得用基本模型参数表示的$\\Delta p$的最终结果。\n$$\n\\Delta p = \\frac{2}{R} \\left( \\frac{2\\sqrt{2}}{3} \\phi_0^3 \\sqrt{\\kappa A} \\right) = \\frac{4\\sqrt{2}}{3R} \\phi_0^3 \\sqrt{\\kappa A}\n$$\n可以验证此结果的量纲一致性。如验证时所确立，如果$\\phi$是无量纲的，那么$[\\kappa] = \\text{能量}/\\text{长度}$，$[A] = \\text{能量}/\\text{体积}$。乘积$\\kappa A$的单位是$(\\text{能量})^2/(\\text{长度})^4$，而$\\sqrt{\\kappa A}$的单位是$\\text{能量}/(\\text{长度})^2$，这正是表面张力的单位。再除以长度$R$得到单位$\\text{能量}/(\\text{长度})^3$，即压力（$\\text{力}/\\text{面积}$）。要求用帕斯卡表示结果，这与国际单位制下的量纲分析是一致的。", "answer": "$$\n\\boxed{\\frac{4\\sqrt{2}}{3R}\\phi_{0}^{3}\\sqrt{\\kappa A}}\n$$", "id": "2782607"}, {"introduction": "理论分析为我们提供了深刻的洞见，但在解决实际工程与科学问题时，我们往往需要依赖数值模拟。本练习旨在搭建理论与计算实践之间的桥梁，指导你如何将一个描述润湿现象的物理边界条件转化为稳定、精确的数值格式。通过为接触角 $\\theta$ 实现一个基于几何的边界条件，你将掌握在相场模拟中处理复杂边界相互作用的关键技术，这是将模型应用于真实材料系统的重要一步 [@problem_id:2782614]。", "problem": "考虑一个用于描述固体壁面处扩散界面的二元相场模型。令序参数表示为$\\phi \\in[-1,1]$，其中两个体相分别对应$\\phi=\\pm 1$。在一个边界为$\\partial\\Omega$的区域$\\Omega$中，总自由能泛函由下式给出\n$$\n\\mathcal{F}[\\phi] \\;=\\; \\int_{\\Omega} \\left( \\lambda\\, W(\\phi) \\;+\\; \\frac{\\kappa}{2}\\,|\\nabla \\phi|^2 \\right)\\, \\mathrm{d}V \\;+\\; \\int_{\\partial\\Omega} g_s(\\phi)\\, \\mathrm{d}S,\n$$\n其中$W(\\phi)$是一个对称双阱势，$\\kappa>0$是梯度能量系数，$\\lambda>0$设定了体能量的尺度，而$g_s(\\phi)$是壁面自由能密度。在本问题中，假设采用标准双阱\n$$\nW(\\phi) \\;=\\; \\frac{(\\phi^2 - 1)^2}{4},\n$$\n并采纳常用选择$\\lambda=1$和$\\kappa=\\varepsilon^2$，其中$\\varepsilon>0$设定了扩散界面的厚度。\n\n在平衡状态下，在体相中，Euler–Lagrange 方程成立：\n$$\n-\\,\\kappa\\, \\nabla^2 \\phi \\;+\\; \\lambda\\, W'(\\phi) \\;=\\; \\mu,\n$$\n其中$\\mu$为一常数化学势。对于一个$\\mu=0$的静态平面界面，沿着垂直于界面的坐标$s$，体能量和梯度能量之间存在一个均分关系：\n$$\n\\frac{\\kappa}{2}\\,\\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}s}\\right)^2 \\;=\\; \\lambda\\, W(\\phi).\n$$\n假设光滑固体壁面上的接触角条件通过壁面法向导数与平衡梯度模之间的几何平衡来施加，即\n$$\n\\mathbf{n}_w \\cdot \\nabla \\phi \\;=\\; -\\,\\cos(\\theta)\\,\\frac{\\sqrt{2\\,\\lambda\\, W(\\phi)}}{\\sqrt{\\kappa}},\n$$\n其中$\\mathbf{n}_w$是从壁面指向流体的单位法向量，$\\theta$是界面与壁面之间的杨氏接触角。当$\\lambda=1$且$\\kappa=\\varepsilon^2$时，此式简化为：\n$$\n\\mathbf{n}_w \\cdot \\nabla \\phi \\;=\\; -\\,\\cos(\\theta)\\,\\frac{\\sqrt{2\\, W(\\phi)}}{\\varepsilon}.\n$$\n\n你需要在一条空间维度上，沿着壁面法向坐标$x\\ge 0$（壁面位于$x=0$且$\\mathbf{n}_w = \\mathbf{e}_x$），为此壁面条件实现一个二阶精度的边界离散化。设$\\Delta x>0$为均匀网格间距，并用$\\phi_1$表示位于$x=\\Delta x$的第一个内部节点上已知的$\\phi$值。为实现二阶近似，引入一个位于$x=-\\Delta x$的几何虚拟未知量$\\phi_{-1}$：\n- 用中心差分近似壁面法向导数\n$$\n\\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{x=0} \\;\\approx\\; \\frac{\\phi_1 - \\phi_{-1}}{2\\,\\Delta x}.\n$$\n- 用中心平均近似壁面值\n$$\n\\phi_w \\;\\approx\\; \\frac{\\phi_1 + \\phi_{-1}}{2}.\n$$\n\n利用上述近似，施加几何接触角条件，从$\\phi_1$, $\\varepsilon$, $\\Delta x$和$\\theta$确定$\\phi_{-1}$。为稳健地求解所得的非线性方程，有利的做法是通过平均值$\\phi_{\\text{avg}} := \\phi_w = (\\phi_1+\\phi_{-1})/2$进行重新参数化，并通过$\\phi_{-1} = 2\\phi_{\\text{avg}} - \\phi_1$消去$\\phi_{-1}$，从而得到标量方程\n$$\n\\frac{\\phi_1 - \\phi_{\\text{avg}}}{\\Delta x} \\;+\\; \\cos(\\theta)\\,\\frac{\\sqrt{2\\,W(\\phi_{\\text{avg}})}}{\\varepsilon} \\;=\\; 0,\n$$\n需求解的是$\\phi_{\\text{avg}} \\in [-1,1]$。物理相关的分支满足$\\phi_{\\text{avg}} \\in [-1,1]$，因此$\\sqrt{2W(\\phi_{\\text{avg}})} = \\frac{|1-\\phi_{\\text{avg}}^2|}{\\sqrt{2}} = \\frac{1-\\phi_{\\text{avg}}^2}{\\sqrt{2}}$。\n\n你的任务：\n1. 从基本定义和均分关系出发，推导上述几何边界条件及其所述的二阶离散形式。\n2. 实现一个程序，对于给定的$(\\varepsilon,\\Delta x,\\phi_1,\\theta)$，通过求解区间$[-1,1]$中的$\\phi_{\\text{avg}}$，然后映射回$\\phi_{-1} = 2\\phi_{\\text{avg}} - \\phi_1$，来计算$\\phi_{-1}$。\n3. 角度必须以弧度解释。所有量均为无量纲。为了数值稳健性，只要$\\phi_1 \\in [-1,1]$，就应使用一个保证能在闭区间$[-1,1]$内找到根的求根方法来求解该标量方程。\n\n测试套件：\n为以下四个测试用例提供输出，每个用例指定为一个元组$(\\varepsilon,\\Delta x,\\phi_1,\\theta)$：\n- 用例 A (正常路径): $(\\varepsilon,\\Delta x,\\phi_1,\\theta) = (\\,0.02,\\,0.01,\\,0.0,\\,\\pi/3\\,)\\,$.\n- 用例 B (直角): $(\\varepsilon,\\Delta x,\\phi_1,\\theta) = (\\,0.02,\\,0.01,\\,-0.8,\\,\\pi/2\\,)\\,$.\n- 用例 C (完全润湿): $(\\varepsilon,\\Delta x,\\phi_1,\\theta) = (\\,0.02,\\,0.01,\\,0.5,\\,0\\,)\\,$.\n- 用例 D (不润湿): $(\\varepsilon,\\Delta x,\\phi_1,\\theta) = (\\,0.05,\\,0.02,\\,-0.3,\\,\\pi\\,)\\,$.\n\n最终输出格式：\n你的程序应生成单行输出，其中包含按 A–D 用例顺序排列的四个计算出的虚拟值$\\phi_{-1}$，形式为用方括号括起来的逗号分隔列表，例如$\\,\\left[\\phi_{-1}^{(A)},\\phi_{-1}^{(B)},\\phi_{-1}^{(C)},\\phi_{-1}^{(D)}\\right]\\,$。列表中的条目必须是普通十进制数。角度以弧度为单位；不涉及任何物理单位。", "solution": "所述问题在科学上是合理的、自洽的且适定的。它描述了一种在相场模型中实现接触角边界条件的标准方法。所提供的方程和参数与计算材料科学和纳米力学领域的既有文献一致。因此，将提供一个解答。\n\n该任务分为两部分：第一部分是推导指定的边界条件及其离散形式；第二部分是为所得方程实现一个数值求解器。\n\n**第 1 部分：边界条件及其离散化的推导**\n\n系统的总自由能由以下泛函给出\n$$\n\\mathcal{F}[\\phi] = \\int_{\\Omega} f_{bulk}(\\phi, \\nabla\\phi) \\, \\mathrm{d}V + \\int_{\\partial\\Omega} g_s(\\phi) \\, \\mathrm{d}S,\n$$\n其中体自由能密度为 $f_{bulk} = \\lambda W(\\phi) + \\frac{\\kappa}{2} |\\nabla \\phi|^2$。在平衡状态下，系统的状态会局部最小化该能量泛函。$\\mathcal{F}$ 的一阶变分必须为零，即 $\\delta \\mathcal{F} = 0$。\n\n变分计算如下：\n$$\n\\delta \\mathcal{F} = \\int_{\\Omega} \\left( \\frac{\\partial f_{bulk}}{\\partial \\phi} \\delta\\phi + \\frac{\\partial f_{bulk}}{\\partial \\nabla\\phi} \\cdot \\delta(\\nabla\\phi) \\right) \\mathrm{d}V + \\int_{\\partial\\Omega} g_s'(\\phi) \\delta\\phi \\, \\mathrm{d}S.\n$$\n根据 $f_{bulk}$ 的定义，可得：\n$$\n\\delta \\mathcal{F} = \\int_{\\Omega} \\left( \\lambda W'(\\phi) \\delta\\phi + \\kappa \\nabla\\phi \\cdot \\nabla(\\delta\\phi) \\right) \\mathrm{d}V + \\int_{\\partial\\Omega} g_s'(\\phi) \\delta\\phi \\, \\mathrm{d}S.\n$$\n对梯度项应用散度定理，$\\int_{\\Omega} \\mathbf{A} \\cdot \\nabla u \\, \\mathrm{d}V = \\int_{\\partial\\Omega} u (\\mathbf{A} \\cdot \\mathbf{n}) \\, \\mathrm{d}S - \\int_{\\Omega} u (\\nabla \\cdot \\mathbf{A}) \\, \\mathrm{d}V$，令 $u = \\delta\\phi$ 和 $\\mathbf{A} = \\kappa \\nabla\\phi$，我们得到：\n$$\n\\int_{\\Omega} \\kappa \\nabla\\phi \\cdot \\nabla(\\delta\\phi) \\, \\mathrm{d}V = \\int_{\\partial\\Omega} \\kappa \\delta\\phi (\\nabla\\phi \\cdot \\mathbf{n}) \\, \\mathrm{d}S - \\int_{\\Omega} \\kappa \\delta\\phi (\\nabla^2\\phi) \\, \\mathrm{d}V.\n$$\n此处，$\\mathbf{n}$ 是区域 $\\Omega$ 的向外单位法向量。将此代回变分 $\\delta \\mathcal{F}$ 中可得：\n$$\n\\delta \\mathcal{F} = \\int_{\\Omega} \\left( \\lambda W'(\\phi) - \\kappa \\nabla^2\\phi \\right) \\delta\\phi \\, \\mathrm{d}V + \\int_{\\partial\\Omega} \\left( g_s'(\\phi) + \\kappa (\\nabla\\phi \\cdot \\mathbf{n}) \\right) \\delta\\phi \\, \\mathrm{d}S.\n$$\n由于 $\\delta\\phi$ 在体区域 $\\Omega$ 内和边界 $\\partial\\Omega$ 上是任意的，为了使 $\\delta \\mathcal{F}=0$，两个被积函数都必须为零。这得出了体相的 Euler-Lagrange 方程（其中化学势 $\\mu=0$），\n$$\n-\\kappa \\nabla^2\\phi + \\lambda W'(\\phi) = 0,\n$$\n以及在 $\\partial\\Omega$ 上的自然边界条件，\n$$\n\\kappa (\\mathbf{n} \\cdot \\nabla\\phi) + g_s'(\\phi) = 0.\n$$\n问题将 $\\mathbf{n}_w$ 定义为从壁面*指向*流体区域的单位法向量，因此 $\\mathbf{n} = -\\mathbf{n}_w$。边界条件变为：\n$$\n\\kappa (\\mathbf{n}_w \\cdot \\nabla\\phi) = g_s'(\\phi).\n$$\n这是从变分原理推导出的广义边界条件。问题指定了该条件的一个特定的“几何”形式：\n$$\n\\mathbf{n}_w \\cdot \\nabla \\phi = -\\cos(\\theta)\\,\\frac{\\sqrt{2\\,\\lambda\\, W(\\phi)}}{\\sqrt{\\kappa}}.\n$$\n这种形式是一种直接施加杨氏接触角 $\\theta$ 的建模选择。它是通过假设表面能密度 $g_s'(\\phi)$ 的导数与一维平衡界面剖面的梯度模成正比而得到的。静态平面界面的均分关系 $\\frac{\\kappa}{2} \\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}s}\\right)^2 = \\lambda W(\\phi)$ 给出了该平衡梯度的模为 $|\\nabla \\phi|_{eq} = \\frac{\\mathrm{d}\\phi}{\\mathrm{d}s} = \\sqrt{\\frac{2\\lambda W(\\phi)}{\\kappa}}$。\n通过将此代入几何条件，我们看到它可以写成 $\\mathbf{n}_w \\cdot \\nabla \\phi = -\\cos(\\theta) |\\nabla \\phi|_{eq}$。将其与变分条件进行比较，可以得出该模型所隐含的壁面能导数的具体函数形式：\n$$\ng_s'(\\phi) = \\kappa \\left( -\\cos(\\theta)\\,\\frac{\\sqrt{2\\,\\lambda\\, W(\\phi)}}{\\sqrt{\\kappa}} \\right) = -\\cos(\\theta) \\sqrt{2\\lambda\\kappa W(\\phi)}.\n$$\n这就完成了连续边界条件的推导和合理性说明。\n\n接下来，我们推导二阶精度的离散形式。设置为一维坐标 $x \\ge 0$，壁面位于 $x=0$，且 $\\mathbf{n}_w = \\mathbf{e}_x$。该条件变为：\n$$\n\\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{x=0} = -\\cos(\\theta)\\,\\frac{\\sqrt{2\\,\\lambda\\, W(\\phi(0))}}{\\sqrt{\\kappa}}.\n$$\n我们使用给定的二阶中心近似来表示导数和壁面值 $\\phi_w = \\phi(0)$：\n$$\n\\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{x=0} \\approx \\frac{\\phi_1 - \\phi_{-1}}{2\\,\\Delta x} \\quad \\text{和} \\quad \\phi_w \\approx \\frac{\\phi_1 + \\phi_{-1}}{2}.\n$$\n将这些代入连续条件中，并设 $\\lambda=1$ 和 $\\kappa=\\varepsilon^2$，我们得到离散方程：\n$$\n\\frac{\\phi_1 - \\phi_{-1}}{2\\,\\Delta x} = -\\cos(\\theta)\\,\\frac{\\sqrt{2\\,W(\\phi_w)}}{\\varepsilon}.\n$$\n为得到要求解的标量方程，我们使用 $\\phi_{\\text{avg}} = \\phi_w = (\\phi_1 + \\phi_{-1})/2$ 进行重新参数化。这意味着 $\\phi_{-1} = 2\\,\\phi_{\\text{avg}} - \\phi_1$。将 $\\phi_{-1}$ 的这个表达式代入离散方程的左侧可得：\n$$\n\\frac{\\phi_1 - (2\\,\\phi_{\\text{avg}} - \\phi_1)}{2\\,\\Delta x} = \\frac{2\\phi_1 - 2\\phi_{\\text{avg}}}{2\\,\\Delta x} = \\frac{\\phi_1 - \\phi_{\\text{avg}}}{\\Delta x}.\n$$\n将其与右侧相等可得：\n$$\n\\frac{\\phi_1 - \\phi_{\\text{avg}}}{\\Delta x} = -\\cos(\\theta)\\,\\frac{\\sqrt{2\\,W(\\phi_{\\text{avg}})}}{\\varepsilon}.\n$$\n整理各项，得到最终要求解 $\\phi_{\\text{avg}}$ 的标量方程：\n$$\n\\frac{\\phi_1 - \\phi_{\\text{avg}}}{\\Delta x} + \\cos(\\theta)\\,\\frac{\\sqrt{2\\,W(\\phi_{\\text{avg}})}}{\\varepsilon} = 0.\n$$\n这就完成了所要求的离散形式的推导。\n\n**第 2 部分：数值求解**\n\n任务是求解推导出的标量方程，以得到 $\\phi_{\\text{avg}} \\in [-1, 1]$。在此区间内，双阱势 $W(\\phi) = (\\phi^2-1)^2/4$ 简化了 $\\sqrt{2W(\\phi)}$ 项：\n$$\n\\sqrt{2W(\\phi_{\\text{avg}})} = \\sqrt{2 \\frac{(\\phi_{\\text{avg}}^2-1)^2}{4}} = \\frac{|\\phi_{\\text{avg}}^2 - 1|}{\\sqrt{2}} = \\frac{1-\\phi_{\\text{avg}}^2}{\\sqrt{2}},\n$$\n因为 $\\phi_{\\text{avg}}^2 \\le 1$。因此，要求解的方程是：\n$$\nf(\\phi_{\\text{avg}}) = \\frac{\\phi_1 - \\phi_{\\text{avg}}}{\\Delta x} + \\cos(\\theta)\\frac{1-\\phi_{\\text{avg}}^2}{\\sqrt{2}\\varepsilon} = 0.\n$$\n这是一个关于 $\\phi_{\\text{avg}}$ 的二次方程。一种找到物理相关根的稳健方法是使用区间求根算法，例如 Brent 方法。我们需要找到一个区间 $[a, b]$，使得 $f(a)$ 和 $f(b)$ 的符号相反。问题提示解位于 $[-1, 1]$ 内。让我们对于给定的 $\\phi_1 \\in [-1, 1]$ 检查该区间端点处的函数值：\n$$\nf(-1) = \\frac{\\phi_1 - (-1)}{\\Delta x} + \\cos(\\theta)\\frac{1-(-1)^2}{\\sqrt{2}\\varepsilon} = \\frac{\\phi_1+1}{\\Delta x}.\n$$\n$$\nf(1) = \\frac{\\phi_1 - 1}{\\Delta x} + \\cos(\\theta)\\frac{1-1^2}{\\sqrt{2}\\varepsilon} = \\frac{\\phi_1-1}{\\Delta x}.\n$$\n给定 $\\Delta x > 0$，且测试用例使用 $\\phi_1 \\in [-1, 1]$，我们有 $\\phi_1+1 \\ge 0$ 和 $\\phi_1-1 \\le 0$。因此，$f(-1) \\ge 0$ 且 $f(1) \\le 0$。这保证了 $f(-1) \\cdot f(1) \\le 0$，所以在区间 $[-1, 1]$ 内总存在至少一个根。因此，我们可以安全地在区间 $[-1, 1]$ 上使用像 `scipy.optimize.brentq` 这样的区间求解器。\n\n一旦找到 $\\phi_{\\text{avg}}$，就可以根据关系式 $\\phi_{-1} = 2\\,\\phi_{\\text{avg}} - \\phi_1$ 计算出虚拟点 $\\phi_{-1}$ 的值。以下程序为给定的测试用例实现了此过程。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the ghost point value phi_{-1} for four test cases\n    of a phase-field contact angle boundary condition.\n    \"\"\"\n    \n    # Test suite: (epsilon, delta_x, phi_1, theta in radians)\n    test_cases = [\n        (0.02, 0.01, 0.0, np.pi / 3),  # Case A\n        (0.02, 0.01, -0.8, np.pi / 2), # Case B\n        (0.02, 0.01, 0.5, 0.0),       # Case C\n        (0.05, 0.02, -0.3, np.pi),     # Case D\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        eps, dx, phi1, theta = case\n\n        # Define the scalar function f(phi_avg) = 0 to be solved.\n        # The equation is:\n        # (phi1 - phi_avg)/dx + cos(theta) * (1 - phi_avg^2) / (sqrt(2)*eps) = 0\n        def f(phi_avg):\n            term1 = (phi1 - phi_avg) / dx\n            term2 = np.cos(theta) * (1 - phi_avg**2) / (np.sqrt(2) * eps)\n            return term1 + term2\n\n        # As derived in the solution, for phi1 in [-1, 1], a root is guaranteed\n        # to exist in the interval [-1, 1]. We use Brent's method for robust\n        # root-finding in this bracket.\n        try:\n            phi_avg = brentq(f, -1.0, 1.0)\n        except ValueError:\n            # This case can happen if f(-1) and f(1) have the same sign, which\n            # occurs if phi1 is exactly -1 or 1, making one boundary value zero.\n            # brentq handles a zero at a boundary, so this is mainly for robustness.\n            # If f(-1) is zero, phi1=-1, so phi_avg=-1 is a root.\n            # If f(1) is zero, phi1=1, so phi_avg=1 is a root.\n            if np.isclose(f(-1.0), 0):\n                phi_avg = -1.0\n            elif np.isclose(f(1.0), 0):\n                phi_avg = 1.0\n            else:\n                # Should not be reached given the analysis.\n                raise\n    \n        # Calculate the ghost point value phi_{-1}\n        phi_m1 = 2 * phi_avg - phi1\n        \n        results.append(phi_m1)\n\n    # Format the results as specified.\n    print(f\"[{','.join(f'{r:.16f}'.rstrip('0').rstrip('.') for r in results)}]\")\n\nsolve()\n```", "id": "2782614"}]}