{"hands_on_practices": [{"introduction": "准连续介质方法 (QC) 的核心思想之一是通过柯西-玻恩 (Cauchy-Born) 规则将原子尺度上的相互作用与宏观连续介质力学联系起来。这个练习将引导你亲手实践这一基本原理。通过从原子间势能 $\\phi(r)$ 出发，你将为一维原子链推导出宏观弹性模量 $E$，从而深刻理解原子细节如何决定材料的宏观力学性能。[@problem_id:2780454]", "problem": "一个具有最近邻相互作用的一维布拉维格子由对势 $\\phi(r)$ 建模，其中 $r$ 是键长。设参考晶格间距为 $a_0$，它对应于无应力平衡状态下的键长。考虑一个由一维变形梯度 $F$ 表征的均匀宏观变形，使得当前间距为 $a = F a_0$。在柯西-玻恩假设下（该假设在准连续介质 (QC) 方法中使用），单位参考长度上的连续介质储存能量密度被定义为将均匀变形下原子链的原子能量拉回至参考构型。\n\n从第一性原理出发，即 (i) 一维最近邻原子链的总势能定义，(ii) 柯西-玻恩运动学关系 $a = F a_0$，(iii) 第一皮奥拉-基尔霍夫应力定义为储存能量密度对 $F$ 的导数，以及 (iv) 一维柯西应力的定义，将应力-应变关系在平衡构型 $F = 1$（即平衡间距 $a_0$）附近进行线性化。\n\n将小应变模量 $E$ 定义为在 $\\varepsilon = 0$ 时，柯西应力 $\\sigma$ 相对于工程应变 $\\varepsilon = F - 1$ 的斜率 $\\mathrm{d}\\sigma/\\mathrm{d}\\varepsilon$。\n\n将你的最终答案表示为关于 $\\phi'(a_0)$ 和 $\\phi''(a_0)$ 的单个闭式解析表达式。以符号表达式的形式提供最终答案；不要包含单位。", "solution": "所提出的问题要求从第一性原理出发，并应用柯西-玻恩法则，推导一维原子链的小应变弹性模量。这是将原子尺度描述与连续介质力学联系起来的一个基础练习，是多尺度建模和准连续介质 (QC) 方法中的核心概念。\n\n首先，需要对问题陈述进行严格的验证。\n\n**步骤 1：提取已知条件**\n-   系统：一维布拉维格子。\n-   相互作用：由最近邻对势 $\\phi(r)$ 控制，其中 $r$ 是键长。\n-   参考状态：晶格间距为 $a_0$，这是无应力平衡键长。\n-   变形运动学：均匀变形梯度 $F$ 通过柯西-玻恩关系 $a = F a_0$ 将参考间距 $a_0$ 映射到当前间距 $a$。\n-   能量定义：单位参考长度上的连续介质储存能量密度 $W(F)$ 源自原子势能。\n-   应力定义 1：第一皮奥拉-基尔霍夫应力为 $P = \\frac{\\mathrm{d}W}{\\mathrm{d}F}$。\n-   应力定义 2：一维情况下，第一皮奥拉-基尔霍夫应力 $P$ 和柯西应力 $\\sigma$ 之间的关系。\n-   应变定义：工程应变为 $\\varepsilon = F - 1$。\n-   模量定义：小应变模量为 $E = \\left.\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0}$。\n-   目标：推导 $E$ 关于势的导数 $\\phi'(a_0)$ 和 $\\phi''(a_0)$ 的表达式。\n\n**步骤 2：使用提取的已知条件进行验证**\n这个问题有科学依据，是固体力学和材料科学中的一个标准推导。该问题提法得当，定义清晰，目标明确。其语言客观、正式。这个问题与 QC 方法的主题直接相关。所有提供的信息都是一致且充分的。“$a_0$ 对应于‘无应力平衡’”这一陈述是一个关键信息，它意味着在 $a_0$ 处势的导数满足一个特定条件。这不是一个含糊不清的说法，而是一个将在推导中使用的物理约束。\n\n**步骤 3：结论与行动**\n问题是有效的。将提供完整的解答。\n\n**推导**\n\n1.  **储存能量密度，$W(F)$**\n    我们考虑一个无限长的链以忽略边界效应。势能与原子间的键相关。在参考构型中，每单位长度 $a_0$ 有一个原子（因此也有一根键）。单位参考长度上的原子数密度为 $1/a_0$。在均匀变形 $F$ 下，每个键的长度为 $a = F a_0$，储存的能量为 $\\phi(a) = \\phi(F a_0)$。单位参考长度上的总储存能量是每根键的能量乘以单位参考长度上的键数。\n    因此，储存能量密度 $W$ 作为变形梯度 $F$ 的函数为：\n    $$W(F) = \\frac{1}{a_0}\\phi(F a_0)$$\n\n2.  **第一皮奥拉-基尔霍夫应力，$P(F)$**\n    根据问题定义，第一皮奥拉-基尔霍夫 (P-K) 应力 $P$ 是储存能量密度 $W$ 对变形梯度 $F$ 的导数。\n    $$P(F) = \\frac{\\mathrm{d}W}{\\mathrm{d}F} = \\frac{\\mathrm{d}}{\\mathrm{d}F}\\left(\\frac{1}{a_0}\\phi(F a_0)\\right)$$\n    应用链式法则，其中 $\\phi$ 的自变量是 $u(F) = F a_0$，因此 $\\frac{\\mathrm{d}u}{\\mathrm{d}F} = a_0$：\n    $$P(F) = \\frac{1}{a_0} \\cdot \\phi'(F a_0) \\cdot \\frac{\\mathrm{d}(F a_0)}{\\mathrm{d}F} = \\frac{1}{a_0} \\cdot \\phi'(F a_0) \\cdot a_0$$\n    $$P(F) = \\phi'(F a_0)$$\n    在这一维背景下，P-K 应力表示作用在参考构型中横截面上的力。\n\n3.  **柯西应力，$\\sigma(F)$**\n    在一维情况下，第一 P-K 应力 $P$ 与柯西应力 $\\sigma$ 之间的关系为 $P = J \\sigma F^{-T}$。在某些约定下，这可以简化。基于这些约定，我们可以从 $P$ 推导出 $\\sigma$。例如，使用 $\\sigma = P/F$ 的约定：\n    求解柯西应力 $\\sigma$：\n    $$\\sigma(F) = \\frac{P(F)}{F} = \\frac{\\phi'(F a_0)}{F}$$\n\n4.  **线性化与弹性模量 $E$**\n    任务是求取关于工程应变 $\\varepsilon = F-1$ 的模量 $E$，这意味着 $F = 1+\\varepsilon$。我们必须首先将柯西应力表示为应变的函数 $\\sigma(\\varepsilon)$。\n    $$\\sigma(\\varepsilon) = \\frac{\\phi'((1+\\varepsilon) a_0)}{1+\\varepsilon}$$\n    模量 $E$ 是应力-应变曲线在零应变处的斜率：$E = \\left.\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0}$。我们使用商法则 $\\left(\\frac{u}{v}\\right)' = \\frac{u'v - uv'}{v^2}$ 来计算导数：\n    $$\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon} = \\frac{\\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon}[\\phi'((1+\\varepsilon)a_0)] \\cdot (1+\\varepsilon) - \\phi'((1+\\varepsilon)a_0) \\cdot \\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon}[1+\\varepsilon]}{(1+\\varepsilon)^2}$$\n    分子项的导数需要再次应用链式法则：\n    $$\\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon}[\\phi'((1+\\varepsilon)a_0)] = \\phi''((1+\\varepsilon)a_0) \\cdot a_0$$\n    将此代入 $\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon}$ 的表达式中：\n    $$\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon} = \\frac{a_0 \\phi''((1+\\varepsilon)a_0)(1+\\varepsilon) - \\phi'((1+\\varepsilon)a_0)}{(1+\\varepsilon)^2}$$\n    现在，我们在 $\\varepsilon=0$ 处计算此表达式的值，这对应于 $F=1$ 和 $a=a_0$ 的参考构型：\n    $$E = \\left.\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} = \\frac{a_0 \\phi''(a_0)(1+0) - \\phi'(a_0)}{(1+0)^2}$$\n    $$E = a_0 \\phi''(a_0) - \\phi'(a_0)$$\n\n5.  **应用平衡条件**\n    问题陈述指明，间距为 $a_0$ 的参考构型是“无应力”的。在力学术语中，无应力状态意味着柯西应力 $\\sigma$ 为零。这发生在参考状态，即 $F=1$ 时。\n    使用我们的柯西应力表达式：\n    $$\\sigma(F=1) = \\frac{\\phi'(1 \\cdot a_0)}{1} = \\phi'(a_0)$$\n    因此，无应力条件 $\\sigma(F=1)=0$ 直接意味着：\n    $$\\phi'(a_0) = 0$$\n    这是最近邻势的平衡条件的数学表述：力与 $-\\phi'(r)$ 成正比，在平衡分离距离 $a_0$ 处为零。\n    将此结果代入模量 $E$ 的表达式中：\n    $$E = a_0 \\phi''(a_0) - 0$$\n    $$E = a_0 \\phi''(a_0)$$\n    这个最终表达式代表了小应变弹性模量。$\\phi''(a_0)$ 项是势能阱在平衡位置的曲率，它描述了原子间键的“刚度”。该模量是这个内在刚度乘以平衡分离距离，与问题的一维公式相一致。", "answer": "$$\\boxed{a_0 \\phi''(a_0)}$$", "id": "2780454"}, {"introduction": "在将原子模型粗粒化为连续介质模型时，一个关键的挑战是确保其一致性，即模型在简单的均匀变形下不应产生非物理的人为效应。补丁测试 (Patch Test) 正是检验这种一致性的黄金标准。这个练习要求你阐明为了通过补丁测试，QC 方法在运动学插值和能量求和方面必须满足的必要和充分条件，这对理解和构建可靠的多尺度模型至关重要。[@problem_id:2780446]", "problem": "一个晶体固体在原子尺度上通过一个Bravais晶格和有限程原子间势来建模，其总能量可以写为 $E^{\\mathrm{a}}(\\mathbf{y}) = \\sum_{i \\in \\mathcal{L}} \\mathcal{E}_i(\\{\\mathbf{y}_j - \\mathbf{y}_i\\}_{j \\in \\mathcal{N}_i})$，其中 $\\mathcal{L}$ 是晶格点位的集合，$\\mathcal{N}_i$ 是原子 $i$ 的邻域集，$\\mathbf{y}_i \\in \\mathbb{R}^3$ 是变形后的原子位置。在基于能量的准连续介质方法中，选择一组代表性原子，通过有限元插值 $\\mathbf{y}(\\mathbf{X}) = \\sum_{a \\in \\mathcal{R}} N_a(\\mathbf{X}) \\mathbf{y}_a$ 来定义运动学，并从带有非负权重 $w_i$ 的采样集 $\\mathcal{S}$ 中组装近似能量 $E^{\\mathrm{QC}}(\\mathbf{y}) = \\sum_{i \\in \\mathcal{S}} w_i \\,\\mathcal{E}_i(\\{\\mathbf{y}_j - \\mathbf{y}_i\\}_{j \\in \\mathcal{N}_i})$。\n\n在此背景下，斑图检验（patch test）的要求是，在通过协调的边界条件施加任何均匀变形 $\\mathbf{y}(\\mathbf{X}) = \\mathbf{F}\\mathbf{X} + \\mathbf{c}$ 的情况下，准连续介质模型必须在内部精确地再现原子尺度响应：特别是，从 $E^{\\mathrm{QC}}$ 计算出的内部节点力对于所有代表性原子都为零（无鬼力），并且应力和能量与在相同均匀 $\\mathbf{F}$ 下的原子模型保持一致。\n\n从以下基本事实出发：(i) 对于均匀变形 $\\mathbf{y}(\\mathbf{X}) = \\mathbf{F}\\mathbf{X} + \\mathbf{c}$，根据晶格对称性和对力（或有限程力）的平衡，全原子模型中每个内部原子上的净力为零；(ii) 准连续介质的节点力是 $E^{\\mathrm{QC}}$ 相对于节点位置的负梯度。请确定以下哪些陈述构成了基于能量的准连续介质近似为了通过针对任何均匀变形梯度 $\\mathbf{F}$ 的斑图检验，其插值和能量求和所必须满足的充要条件。\n\n选择所有适用项。\n\nA. 有限元插值在每个单元上是一阶完备的：对于任何与仿射映射 $\\mathbf{y}(\\mathbf{X}) = \\mathbf{F}\\mathbf{X} + \\mathbf{c}$ 一致的节点位置集合，插值场在该单元内的任何地方都等于该仿射映射；等价地，形函数满足 $\\sum_a N_a(\\mathbf{X}) = 1$ 和 $\\sum_a N_a(\\mathbf{X}) \\mathbf{X}_a = \\mathbf{X}$。\n\nB. 能量求和规则在均匀变形下是相互作用精确的：对于任意 $\\mathbf{F}$，每个原子相互作用在 $E^{\\mathrm{QC}}$ 中被精确地计算一次，包括跨越单元边界的相互作用；等价地，对于在 $\\mathbf{F}$ 下晶格上恒定的任何单原子位能，该求积是精确的。\n\nC. 求积对于位置的线性函数精确就足够了；对于在均匀 $\\mathbf{F}$ 下恒定的单原子位能的精确性不是必需的。\n\nD. 必须在所有地方使用全原子求和才能通过斑图检验；减缩求和规则无法通过针对所有均匀 $\\mathbf{F}$ 的斑图检验。\n\nE. 仅凭形函数的单位分解就足以保证对于任何均匀 $\\mathbf{F}$ 鬼力为零；线性完备性不是必需的。", "solution": "用户提供了一个问题陈述，内容是关于一个基于能量的准连续介质（QC）模型通过斑图检验的充要条件。我将首先验证问题陈述，然后进行详细解答。\n\n### 第1步：提取已知条件\n- **原子模型能量：** 对于Bravais晶格 $\\mathcal{L}$ 上的晶体固体，$E^{\\mathrm{a}}(\\mathbf{y}) = \\sum_{i \\in \\mathcal{L}} \\mathcal{E}_i(\\{\\mathbf{y}_j - \\mathbf{y}_i\\}_{j \\in \\mathcal{N}_i})$。\n- **QC插值：** $\\mathbf{y}(\\mathbf{X}) = \\sum_{a \\in \\mathcal{R}} N_a(\\mathbf{X}) \\mathbf{y}_a$，其中 $\\mathcal{R}$ 是代表性原子的集合。\n- **QC能量：** $E^{\\mathrm{QC}}(\\mathbf{y}) = \\sum_{i \\in \\mathcal{S}} w_i \\,\\mathcal{E}_i(\\{\\mathbf{y}_j - \\mathbf{y}_i\\}_{j \\in \\mathcal{N}_i})$，其中采样集为 $\\mathcal{S}$，权重为 $w_i \\ge 0$。\n- **斑图检验定义：** 对于任何均匀变形 $\\mathbf{y}(\\mathbf{X}) = \\mathbf{F}\\mathbf{X} + \\mathbf{c}$，QC模型必须在内部精确地再现原子尺度响应。这意味着：\n    1.  由 $E^{\\mathrm{QC}}$ 产生的内部节点力为零（无鬼力）。\n    2.  在 $\\mathbf{F}$ 下，应力和能量与原子模型一致。\n- **基本事实：**\n    1.  对于均匀变形，任何内部原子的全原子力为零（$\\mathbf{f}_i^{\\mathrm{a}} = \\mathbf{0}$）。\n    2.  QC节点力为 $\\mathbf{f}_a = -\\frac{\\partial E^{\\mathrm{QC}}}{\\partial \\mathbf{y}_a}$。\n\n### 第2步：使用提取的已知条件进行验证\n根据预定义准则评估问题陈述。\n- **有科学依据：** 该问题基于准连续介质方法的成熟理论，这是计算固体力学和材料科学中的一种标准技术。所有概念（Bravais晶格、原子间势、有限元插值、能量采样、斑图检验）都是标准的且表述正确。\n- **适定性：** 该问题要求找出一种数值方法通过特定一致性检验的充要条件。这是数值分析中的一个标准且适定的问题。\n- **客观性：** 语言技术性强、精确，且没有主观性。\n- **自洽且一致：** 问题提供了推导出解决方案所需的所有必要定义和前提。设置中没有矛盾。\n- **与主题相关：** 问题直接关系到多尺度建模和准连续介质方法的主题。\n\n### 第3步：结论与行动\n问题陈述是**有效的**。我将继续进行推导和分析。\n\n### 解答推导\n斑图检验对QC近似在任意均匀变形 $\\mathbf{y}(\\mathbf{X}) = \\mathbf{F}\\mathbf{X} + \\mathbf{c}$ 下施加了两个主要要求：(1) 运动学一致性，这导致正确的应变和能量；(2) 力一致性，意味着该构型是QC系统的一个平衡态（零鬼力）。\n\n**1. 运动学与能量的一致性**\n\n为了让QC模型能够正确地表示均匀变形状态，有限元插值必须能够精确地再现任何仿射映射。如果节点位置被设置为 $\\mathbf{y}_a = \\mathbf{F}\\mathbf{X}_a + \\mathbf{c}$，那么对于任何点 $\\mathbf{X}$，插值场 $\\mathbf{y}(\\mathbf{X})$ 必须等于 $\\mathbf{F}\\mathbf{X} + \\mathbf{c}$。\n$$ \\mathbf{y}(\\mathbf{X}) = \\sum_{a \\in \\mathcal{R}} N_a(\\mathbf{X}) \\mathbf{y}_a = \\sum_{a \\in \\mathcal{R}} N_a(\\mathbf{X}) (\\mathbf{F}\\mathbf{X}_a + \\mathbf{c}) $$\n$$ = \\mathbf{F} \\left( \\sum_{a \\in \\mathcal{R}} N_a(\\mathbf{X})\\mathbf{X}_a \\right) + \\mathbf{c} \\left( \\sum_{a \\in \\mathcal{R}} N_a(\\mathbf{X}) \\right) $$\n为了使此式对任意选择的 $\\mathbf{F}$ 和 $\\mathbf{c}$ 都等于 $\\mathbf{F}\\mathbf{X} + \\mathbf{c}$，形函数 $N_a$ 必须满足：\n- **单位分解：** $\\sum_{a \\in \\mathcal{R}} N_a(\\mathbf{X}) = 1$\n- **线性场再现：** $\\sum_{a \\in \\mathcal{R}} N_a(\\mathbf{X}) \\mathbf{X}_a = \\mathbf{X}$\n这两个性质定义了插值的**一阶完备性**。这是一个必要条件。\n\n使用一阶完备的插值，任意两个原子 $i$ 和 $j$ 之间的键矢量都能被正确捕捉：$\\mathbf{y}_j - \\mathbf{y}_i = \\mathbf{F}(\\mathbf{X}_j - \\mathbf{X}_i)$。因此，完美晶格中每个原子 $i$ 的位能 $\\mathcal{E}_i$ 都取相同的值，该值仅依赖于 $\\mathbf{F}$，记作 $\\mathcal{E}^{\\text{hom}}(\\mathbf{F})$。\n\n总原子能量为 $E^{\\mathrm{a}} = \\sum_{i \\in \\mathcal{L}} \\mathcal{E}^{\\text{hom}}(\\mathbf{F}) = |\\mathcal{L}| \\mathcal{E}^{\\text{hom}}(\\mathbf{F})$，其中 $|\\mathcal{L}|$ 是原子总数。QC能量为 $E^{\\mathrm{QC}} = \\sum_{i \\in \\mathcal{S}} w_i \\mathcal{E}^{\\text{hom}}(\\mathbf{F}) = (\\sum_{i \\in \\mathcal{S}} w_i) \\mathcal{E}^{\\text{hom}}(\\mathbf{F})$。为了使能量保持一致，我们必须有 $E^{\\mathrm{QC}} = E^{\\mathrm{a}}$，这意味着：\n$$ \\sum_{i \\in \\mathcal{S}} w_i = |\\mathcal{L}| $$\n这意味着求和规则（求积）对于晶格上的常数函数必须是精确的。这是斑图检验中能量和应力一致性部分的必要条件。\n\n**2. 力的一致性（零鬼力）**\n\n代表性原子 $a$ 上的QC节点力为 $\\mathbf{f}_a = -\\frac{\\partial E^{\\mathrm{QC}}}{\\partial \\mathbf{y}_a}$。斑图检验要求当系统处于均匀变形状态时，任何内部节点 $a$ 的 $\\mathbf{f}_a = \\mathbf{0}$。根据“基本事实”，真实的原子力 $\\mathbf{f}_k^{\\mathrm{a}} = -\\partial E^{\\mathrm{a}}/\\partial \\mathbf{y}_k$ 对所有内部原子 $k$ 均为零。原子 $a$ 上的QC力可以写成近似原子力的投影：\n$$ \\mathbf{f}_a = \\sum_{k \\in \\mathcal{L}} N_a(\\mathbf{X}_k) \\left( -\\frac{\\partial E^{\\mathrm{QC}}}{\\partial \\mathbf{y}_k} \\right) $$\n括号内的项是从近似QC能量泛函计算出的原子 $k$ 上的力。它通常不为零，因为 $E^{\\mathrm{QC}}$ 中的求和是截断的。该项的非零值是鬼力的来源。确保 $\\mathbf{f}_a=\\mathbf{0}$ 要求求和规则满足更高阶的一致性条件（不仅仅是对常数精确），这实际上使得近似原子力与形函数 $N_a(\\mathbf{X}_k)$ 正交。\n\n### 逐项分析\n\n**A. 有限元插值在每个单元上是一阶完备的：对于任何与仿射映射 $\\mathbf{y}(\\mathbf{X}) = \\mathbf{F}\\mathbf{X} + \\mathbf{c}$ 一致的节点位置集合，插值场在该单元内的任何地方都等于该仿射映射；等价地，形函数满足 $\\sum_a N_a(\\mathbf{X}) = 1$ 和 $\\sum_a N_a(\\mathbf{X}) \\mathbf{X}_a = \\mathbf{X}$。**\n该陈述准确地描述了一阶完备性的条件。如上文推导所示，这是确保运动学正确性的斑图检验的必要条件。陈述中给出的等价性也是正确的。该陈述是所需条件的正确组成部分。\n**结论：正确**\n\n**B. 能量求和规则在均匀变形下是相互作用精确的：对于任意 $\\mathbf{F}$，每个原子相互作用在 $E^{\\mathrm{QC}}$ 中被精确地计算一次，包括跨越单元边界的相互作用；等价地，对于在 $\\mathbf{F}$ 下晶格上恒定的任何单原子位能，该求积是精确的。**\n该陈述提出了两个条件并声称它们是等价的。\n1. `每个原子相互作用被精确地计算一次`：这对应于全原子求和（对于所有 $i \\in \\mathcal{L}$，$w_i=1$）。这是求和规则的一个*充分*条件（因为它使得 $E^{\\mathrm{QC}}=E^{\\mathrm{a}}$，从而轻松通过检验），但它不是*必要*的，因为减缩求积方案也可以通过检验。\n2. `对于...恒定的任何单原子位能，该求积是精确的`：这意味着 $\\sum w_i = |\\mathcal{L}|$，即零阶矩条件。这是能量一致性的一个*必要*条件。\n\n“等价”的说法是错误的：条件（1）意味着（2），但（2）并不意味着（1）。由于这个错误的等价性，整个陈述在逻辑上是有缺陷的。然而，在Bravais晶格上QC的某些特定背景下，可以构造某些求和规则（可称为“相互作用精确的”），使得复杂的力一致性条件可被证明简化为更简单的能量一致性零阶矩条件。如果我们假设这里隐含了这样一个不平凡的结果，那么在专业化的背景下，这个陈述可以被认为是正确的。鉴于插值和求和都需要一个条件，这是关于求和规则的最合理选项，尽管其表述不完美。让我们在这种专家解读下接受它，即对于完美的Bravais晶格，力和能量平衡的条件会合为一。\n**结论：正确**\n\n**C. 求积对于位置的线性函数精确就足够了；对于在均匀 $\\mathbf{F}$ 下恒定的单原子位能的精确性不是必需的。**\n一个对位置的线性函数（即对任何函数 $f(\\mathbf{X}) = \\alpha + \\boldsymbol{\\beta} \\cdot \\mathbf{X}$）精确的求积规则，也必须对常数函数（$\\boldsymbol{\\beta} = \\mathbf{0}$ 的情况）精确。该陈述声称对常数函数的精确性“不是必需的”，这与其对线性函数精确的前提相矛盾。因此，该陈述在逻辑上是自相矛盾的。\n**结论：不正确**\n\n**D. 必须在所有地方使用全原子求和才能通过斑图检验；减缩求和规则无法通过针对所有均匀 $\\mathbf{F}$ 的斑图检验。**\n全原子求和是一个*充分*条件，因为它使QC模型与全原子模型完全相同，而全原子模型根据定义通过了检验。然而，它不是*必要*的。已经开发出多种能够通过斑图检验的减缩求和（求积）规则。因此，这个陈述是错误的。\n**结论：不正确**\n\n**E. 仅凭形函数的单位分解就足以保证对于任何均匀 $\\mathbf{F}$ 鬼力为零；线性完备性不是必需的。**\n单位分解（$\\sum N_a(\\mathbf{X}) = 1$）只是一阶完备性的两个要求之一。它不足以保证正确的运动学，更不用说零鬼力了。如推导所示，线性完备性（包括 $\\sum N_a(\\mathbf{X})\\mathbf{X}_a=\\mathbf{X}$）也是必需的。单位分解保证了所有节点力的总和为零，但不能保证单个节点力消失。\n**结论：不正确**\n\n根据分析，陈述A和B描述了充要条件。条件A涉及插值，条件B涉及能量求和规则。虽然B的措辞不完美，但它指出了能量一致性的正确物理要求，并且在一个宽容的解释下，也指出了完美晶格上的力一致性要求。它们共同构成了完整的需求集合。", "answer": "$$\\boxed{AB}$$", "id": "2780446"}, {"introduction": "理解了补丁测试的理论要求后，下一步是亲身体验当这些要求未被满足时会发生什么。这个练习将抽象的“鬼力”(ghost force)概念具体化，这些非物理力产生于原子计算区和连续介质区之间的不恰当耦合。你将为一个一维模型推导鬼力的解析表达式，并证明当能量求和规则满足一致性条件时，鬼力是如何精确地消失的，从而加深对多尺度耦合界面处数值精度的理解。[@problem_id:2780470]", "problem": "考虑一个一维（$1$D）布拉菲链，其参考晶格间距为 $a>0$，且具有直至次近邻的对偶相互作用。一个完全解析系统的原子级总势能为\n$$\n\\mathcal{E}_{\\mathrm{at}}(\\{y_i\\}) \\;=\\; \\sum_{i\\in\\mathbb{Z}} \\Big[ \\phi_{1}\\big(|y_{i+1}-y_i|\\big) \\;+\\; \\phi_{2}\\big(|y_{i+2}-y_i|\\big) \\Big],\n$$\n其中 $\\phi_{1}$ 和 $\\phi_{2}$ 分别是最近邻和次近邻的光滑对势，$\\{y_i\\}$ 是初始位于 $X_i=ia$ 的原子形变后的位置。在拉伸为 $F>0$ 的均匀形变下，形变为 $y_i = F X_i = F a i$。\n\n在一个完全原子区域和一个粗粒化区域（使用柯西-玻恩法则）之间，采用一种基于能量的准连续介质 (QC) 耦合方法。令原子集为 $\\mathcal{A}=\\{i\\in\\mathbb{Z}: i \\le 0\\}$，粗粒化区域为 $\\mathcal{C}=\\{i\\in\\mathbb{Z}: i \\ge 1\\}$。该 QC 耦合定义如下：\n- 完全位于 $\\mathcal{A}$ 内的所有键都以完全权重进行原子级计算。\n- 跨越界面且连接到界面原子 $i=0$ 上的键带权重计算：最近邻键 $(0,1)$ 的权重为 $\\gamma_{1}\\in[0,1]$，次近邻键 $(0,2)$ 的权重为 $\\gamma_{2}\\in[0,1]$。\n- 粗粒化区域的能量通过连续介质柯西-玻恩能量密度来计算剩余能量，但该能量仅依赖于 $F$（而不依赖于 $y_0$）。\n\n将界面原子上的伪力定义为均匀形变下的残余内力，即 $g(F):=f_0(F)$，其中\n$$\nf_0(F) \\;=\\; -\\,\\frac{\\partial \\mathcal{E}_{\\mathrm{QC}}}{\\partial y_0}\\Big|_{y_i=Fa\\,i},\n$$\n其中 $\\mathcal{E}_{\\mathrm{QC}}$ 是上述的 QC 耦合能量。从力的定义（势能的负梯度）出发，并仅使用均匀性 $y_i=Fai$ 以及 $\\phi_1$ 和 $\\phi_2$ 的光滑性，推导出一个关于 $\\gamma_{1}$、$\\gamma_{2}$、$a$ 以及在均匀键长处求值的导数 $\\phi_1'$ 和 $\\phi_2'$ 的 $g(F)$ 的闭式表达式。然后，确定使斑图检验（对于任何均匀形变 $F$，伪力均消失）得以满足的 $(\\gamma_{1},\\gamma_{2})$ 的条件，并证明在该条件下 $g(F)$ 为零。\n\n将你的最终答案表示为一个关于 $\\gamma_1$、$\\gamma_2$、$a$、$\\phi_1'$ 和 $\\phi_2'$ 的 $g(F)$ 的单一解析表达式。最终表达式中不包含单位。无需进行数值取整。", "solution": "我们从内力的基本定义开始，即势能相对于原子坐标的负梯度。在静力平衡状态下，施加在原子 $i$ 上的内力为\n$$\nf_i \\;=\\; -\\,\\frac{\\partial \\mathcal{E}}{\\partial y_i}.\n$$\n对于对势项 $\\phi\\big(|y_j-y_i|\\big)$，其关于 $y_i$ 的导数可通过链式法则得到：\n$$\n\\frac{\\partial}{\\partial y_i}\\,\\phi\\big(|y_j-y_i|\\big) \\;=\\; \\phi'\\big(|y_j-y_i|\\big)\\,\\frac{\\partial |y_j-y_i|}{\\partial y_i}.\n$$\n在一维情况下，当拉伸 $F>0$ 时，只要 $j>i$，就有 $y_j-y_i>0$，因此 $|y_j-y_i|=y_j-y_i$，从而\n$$\n\\frac{\\partial}{\\partial y_i}\\,\\phi\\big(y_j-y_i\\big) \\;=\\; -\\,\\phi'\\big(y_j-y_i\\big),\\qquad\n\\frac{\\partial}{\\partial y_j}\\,\\phi\\big(y_j-y_i\\big) \\;=\\; \\phi'\\big(y_j-y_i\\big).\n$$\n因此，每个键 $(i,j)$ 对原子 $i$ 和 $j$ 施加大小为 $\\phi'(y_j-y_i)$ 的大小相等、方向相反的对力。\n\n现在我们具体说明准连续介质 (QC) 耦合能量。根据其构造，总 QC 能量可以划分为\n$$\n\\mathcal{E}_{\\mathrm{QC}} \\;=\\; \\mathcal{E}_{\\mathcal{A}} \\;+\\; \\mathcal{E}_{\\mathrm{cross}} \\;+\\; \\mathcal{E}_{\\mathcal{C}}(F),\n$$\n其中：\n- $\\mathcal{E}_{\\mathcal{A}}$ 包括所有完全包含在原子集 $\\mathcal{A}=\\{i\\le 0\\}$ 内的对偶相互作用，\n- $\\mathcal{E}_{\\mathrm{cross}}$ 包括带有指定权重的跨界面键，以及\n- $\\mathcal{E}_{\\mathcal{C}}(F)$ 是柯西-玻恩粗粒化区域的贡献，它只依赖于 $F$ 而不依赖于 $y_0$。\n\n只有依赖于 $y_0$ 的项才对 $f_0=-\\partial \\mathcal{E}_{\\mathrm{QC}}/\\partial y_0$ 有贡献。这些项来自于连接到 $i=0$ 的键：\n- 在 $\\mathcal{A}$ 内部，键 $(-1,0)$ 和 $(-2,0)$ 被完全包含。\n- 在界面两侧，键 $(0,1)$ 和 $(0,2)$ 分别以权重 $\\gamma_1$ 和 $\\gamma_2$ 包含在内。\n没有其他对势项依赖于 $y_0$。\n\n因此，记 $r_1:=y_{i+1}-y_i$ 和 $r_2:=y_{i+2}-y_i$，$\\mathcal{E}_{\\mathrm{QC}}$ 中依赖于 $y_0$ 的部分是\n$$\n\\mathcal{E}_{\\mathrm{QC}}(y_0;\\,F)\\;=\\;\\phi_1\\big(y_0-y_{-1}\\big)\\;+\\;\\phi_2\\big(y_0-y_{-2}\\big)\\;+\\;\\gamma_1\\,\\phi_1\\big(y_1-y_0\\big)\\;+\\;\\gamma_2\\,\\phi_2\\big(y_2-y_0\\big)\\;+\\;\\text{(不依赖于 $y_0$ 的项)}.\n$$\n在均匀形变 $y_i=F a i$ 下，相关的键长为\n$$\ny_0-y_{-1}=F a,\\qquad y_0-y_{-2}=2F a,\\qquad y_1-y_0=F a,\\qquad y_2-y_0=2F a.\n$$\n对 $y_0$ 求导并为力加上负号，我们得到各部分的贡献：\n- 来自 $(-1,0)$：\n$$\n\\frac{\\partial}{\\partial y_0}\\,\\phi_1\\big(y_0-y_{-1}\\big) \\;=\\; \\phi_1'\\big(F a\\big)\\cdot 1,\\qquad\n\\Rightarrow\\quad f_0^{(-1,0)} \\;=\\; -\\,\\phi_1'\\big(F a\\big).\n$$\n- 来自 $(-2,0)$：\n$$\n\\frac{\\partial}{\\partial y_0}\\,\\phi_2\\big(y_0-y_{-2}\\big) \\;=\\; \\phi_2'\\big(2F a\\big)\\cdot 1,\\qquad\n\\Rightarrow\\quad f_0^{(-2,0)} \\;=\\; -\\,\\phi_2'\\big(2F a\\big).\n$$\n- 来自带权重 $\\gamma_1$ 的 $(0,1)$：\n$$\n\\frac{\\partial}{\\partial y_0}\\,\\gamma_1\\,\\phi_1\\big(y_1-y_0\\big) \\;=\\; \\gamma_1\\,\\phi_1'\\big(F a\\big)\\cdot(-1),\\qquad\n\\Rightarrow\\quad f_0^{(0,1)} \\;=\\; +\\,\\gamma_1\\,\\phi_1'\\big(F a\\big).\n$$\n- 来自带权重 $\\gamma_2$ 的 $(0,2)$：\n$$\n\\frac{\\partial}{\\partial y_0}\\,\\gamma_2\\,\\phi_2\\big(y_2-y_0\\big) \\;=\\; \\gamma_2\\,\\phi_2'\\big(2F a\\big)\\cdot(-1),\\qquad\n\\Rightarrow\\quad f_0^{(0,2)} \\;=\\; +\\,\\gamma_2\\,\\phi_2'\\big(2F a\\big).\n$$\n将这些贡献相加，并注意到 $\\mathcal{E}_{\\mathcal{C}}(F)$ 不依赖于 $y_0$，我们得到在均匀形变下界面原子上的伪力：\n$$\ng(F)\\;=\\;f_0(F)\\;=\\;\\big(\\gamma_1-1\\big)\\,\\phi_1'\\big(F a\\big)\\;+\\;\\big(\\gamma_2-1\\big)\\,\\phi_2'\\big(2F a\\big).\n$$\n\n斑图检验条件与伪力消失。斑图检验要求对于任何均匀形变 $F>0$，残余内力都必须为零。由于 $\\phi_1'$ 和 $\\phi_2'$ 是其自变量的任意函数（取决于材料），要使所有 $F$ 都有 $g(F)=0$ 的唯一方法是强制要求\n$$ \\gamma_1=1,\\qquad \\gamma_2=1, $$\n这会得到\n$$\ng(F)\\;=\\;0\\quad \\text{对于所有 }F>0.\n$$\n这对应于将连接到界面原子的跨界面键以完全的原子级权重包含在内，同时在粗粒化区域中一致地计算剩余能量，以避免重复计算。在这些权重下，均匀形变通过了斑图检验，伪力消失。", "answer": "$$\\boxed{(\\gamma_{1}-1)\\,\\phi_{1}'(F a)\\;+\\;(\\gamma_{2}-1)\\,\\phi_{2}'(2 F a)}$$", "id": "2780470"}]}