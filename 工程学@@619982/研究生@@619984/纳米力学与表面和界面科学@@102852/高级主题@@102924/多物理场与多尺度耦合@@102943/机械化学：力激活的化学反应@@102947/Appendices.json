{"hands_on_practices": [{"introduction": "力化学中最基本的定量模型之一是 Bell 模型，它描述了外力如何通过沿着反应坐标做功来降低活化能垒。这个练习将让你直接应用 Bell 模型来解决一个关于典型光致/力致变色分子——螺环吡喃（spiropyran）——的实际问题 [@problem_id:2778944]。通过计算在室温下使反应速率提高十倍所需的力 $F$，你将对单分子水平上影响化学反应动力学所需力的大小建立起直观的认识。", "problem": "一个螺吡喃力致变色团共价嵌入到聚合物骨架中，在单分子拉伸过程中，沿链轴方向受到恒定的拉伸力。从头算（Ab initio）约束计算表明，从反应物势阱到过渡态沿拉伸坐标的距离标量投影为 $x^{\\ddagger} = 0.18\\,\\text{nm}$。假设在恒定外力作用下，开环反应的活化自由能因沿反应坐标所做的机械功而降低，并且过渡态理论中的指前因子不受力的影响。使用过渡态理论（TST）并假设所施加的力与反应坐标线性耦合，确定在温度 $T=298\\,\\text{K}$ 下，为使开环速率增加 $10$ 倍所需施加的拉伸力的大小。\n\n以纳牛顿（nN）为单位，将最终答案表示为单个数字。将答案四舍五入至四位有效数字。\n\n使用玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}$。你可以假设力的方向与反应坐标完全对齐。", "solution": "在尝试任何解答之前，首先对问题进行验证。\n\n**第一步：提取已知条件**\n- **体系：** 一个共价嵌入聚合物骨架的螺吡喃力致变色团。\n- **过程：** 在单分子拉伸过程中受到恒定拉伸力 $F$。\n- **参数：** 从反应物势阱到过渡态沿拉伸坐标的距离标量投影为 $x^{\\ddagger} = 0.18\\,\\text{nm}$。\n- **假设1：** 开环反应的活化自由能因沿反应坐标所做的机械功而降低。\n- **假设2：** 过渡态理论中的指前因子不受力的影响。\n- **理论框架：** 过渡态理论（TST）。\n- **假设3：** 所施加的力与反应坐标线性耦合。\n- **目标：** 使开环速率增加 $10$ 倍。\n- **条件：** 温度 $T=298\\,\\text{K}$。\n- **常数：** 玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}$。\n- **假设4：** 力的方向与反应坐标完全对齐。\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据。它描述了力化学中的一个典型问题：力致变色团（螺吡喃）的力依赖性动力学。使用过渡态理论，结合 Bell 模型（力与反应坐标的线性耦合），是分析此类系统的标准且公认的一阶近似方法。所提供的数据，如反应坐标距离 $x^{\\ddagger}$ 和温度 $T$，对于单分子力谱实验是物理上现实的。问题提法清晰，提供了足够的信息来确定力 $F$ 的唯一解。语言客观、精确。该问题没有科学上的不健全、模糊不清之处或内部矛盾。\n\n**第三步：结论与行动**\n该问题被判定为**有效**。将提供解答。\n\n根据过渡态理论（TST），化学反应的速率由 Eyring 方程描述。速率常数 $k$ 由下式给出：\n$$k = A \\exp\\left(-\\frac{\\Delta G^{\\ddagger}}{k_B T}\\right)$$\n其中 $A$ 是指前因子（包括 $\\frac{k_B T}{h}$ 和振动配分函数等项），$\\Delta G^{\\ddagger}$ 是吉布斯活化自由能，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。问题陈述，$A$ 是一个常数，不受所施加力的影响。\n\n在没有外力的情况下，速率常数表示为 $k(0)$：\n$$k(0) = A \\exp\\left(-\\frac{\\Delta G^{\\ddagger}(0)}{k_B T}\\right)$$\n其中 $\\Delta G^{\\ddagger}(0)$ 是零力下的活化自由能。\n\n当施加恒定的拉伸力 $F$ 时，问题陈述活化能垒因所做的机械功而降低。如题所述，假设力与反应坐标之间存在线性耦合，则力依赖的活化能 $\\Delta G^{\\ddagger}(F)$ 可由 Bell 模型给出：\n$$\\Delta G^{\\ddagger}(F) = \\Delta G^{\\ddagger}(0) - F x^{\\ddagger}$$\n此处，$x^{\\ddagger}$ 是沿反应坐标到过渡态的距离。功项 $F x^{\\ddagger}$ 降低了能垒的高度。\n\n因此，在有力存在的情况下，速率常数 $k(F)$ 为：\n$$k(F) = A \\exp\\left(-\\frac{\\Delta G^{\\ddagger}(F)}{k_B T}\\right) = A \\exp\\left(-\\frac{\\Delta G^{\\ddagger}(0) - F x^{\\ddagger}}{k_B T}\\right)$$\n这可以改写为：\n$$k(F) = A \\exp\\left(-\\frac{\\Delta G^{\\ddagger}(0)}{k_B T}\\right) \\exp\\left(\\frac{F x^{\\ddagger}}{k_B T}\\right)$$\n认识到表达式的第一部分是 $k(0)$，我们得到：\n$$k(F) = k(0) \\exp\\left(\\frac{F x^{\\ddagger}}{k_B T}\\right)$$\n问题要求找到导致反应速率增加 $10$ 倍的力 $F$。这对应于条件：\n$$\\frac{k(F)}{k(0)} = 10$$\n代入我们推导出的速率比表达式：\n$$10 = \\exp\\left(\\frac{F x^{\\ddagger}}{k_B T}\\right)$$\n为了求解 $F$，我们对等式两边取自然对数：\n$$\\ln(10) = \\frac{F x^{\\ddagger}}{k_B T}$$\n分离出 $F$ 得到所需力的符号表达式：\n$$F = \\frac{k_B T \\ln(10)}{x^{\\ddagger}}$$\n现在，我们将给定的数值代入此表达式。单位必须保持一致（国际单位制，SI）。\n已知：\n- $k_B = 1.380649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}$\n- $T = 298\\,\\text{K}$\n- $x^{\\ddagger} = 0.18\\,\\text{nm} = 0.18 \\times 10^{-9}\\,\\text{m}$\n\n首先，我们计算热能 $k_B T$：\n$$k_B T = (1.380649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}) \\times (298\\,\\text{K}) \\approx 4.114334 \\times 10^{-21}\\,\\text{J}$$\n现在，我们计算力 $F$：\n$$F = \\frac{(4.114334 \\times 10^{-21}\\,\\text{J}) \\times \\ln(10)}{0.18 \\times 10^{-9}\\,\\text{m}}$$\n使用 $\\ln(10) \\approx 2.302585$ 的值：\n$$F \\approx \\frac{(4.114334 \\times 10^{-21}) \\times 2.302585}{0.18 \\times 10^{-9}}\\,\\text{N}$$\n$$F \\approx \\frac{9.47346 \\times 10^{-21}}{1.8 \\times 10^{-10}}\\,\\text{N}$$\n$$F \\approx 5.26303 \\times 10^{-11}\\,\\text{N}$$\n问题要求答案以纳牛顿（nN）为单位。我们进行单位转换：\n$$1\\,\\text{nN} = 10^{-9}\\,\\text{N}, \\text{所以 } 1\\,\\text{N} = 10^9\\,\\text{nN}$$\n$$F \\approx (5.26303 \\times 10^{-11}\\,\\text{N}) \\times (10^9\\,\\text{nN}/\\text{N})$$\n$$F \\approx 5.26303 \\times 10^{-2}\\,\\text{nN}$$\n$$F \\approx 0.0526303\\,\\text{nN}$$\n将结果四舍五入至四位有效数字，得到 $0.05263\\,\\text{nN}$。", "answer": "$$\\boxed{0.05263}$$", "id": "2778944"}, {"introduction": "真实的力化学过程通常比单一的能垒穿越事件更为复杂，常常涉及多个连续的反应步骤。这个练习将挑战你分析一个两步连续反应模型，该模型模拟了高分子环的打开和随后的化学键断裂过程 [@problem_id:2778947]。你需要推导出一个“有效”的表观活化距离 $x_{\\text{eff}}^{\\ddagger}$，它是一个由各步骤的速率常数加权平均得到的量，从而理解复杂过程的整体力敏感性是如何由其各个基本步骤的特性共同决定的。", "problem": "在动态力谱（DFS）实验中，一个共价力敏键在张力下发生断裂之前，必须先有一个聚合物环打开。DFS 测量在绝对温度 $T$ 下的恒力系综中进行。动力学过程包含两个不可逆的连续步骤，伴随一个寿命很短的中间体，且逆向速率可以忽略：(1) 熵致环打开 和 (2) 键断裂。观测到的速率受总平均首达时间的限制。施加的力为 $f$。\n\n将熵致环打开过程建模为在力 $f$ 作用下，从蠕虫状链 (WLC) 中释放出一段轮廓长度 $\\Delta L$。在高力 WLC 区域 (即 $f \\ell_p \\gg k_B T$)，固定力 $f$ 下单位轮廓长度的伸长量可近似为\n$$\n\\xi(f) \\approx 1 - \\frac{1}{2} \\left(\\frac{k_B T}{f \\,\\ell_p}\\right)^{1/2},\n$$\n其中 $\\ell_p$ 是持续长度， $k_B$ 是 Boltzmann 常数。将熵致打开步骤到渡越态的距离视为在力 $f$ 下释放 $\\Delta L$ 所获得的机械伸长量，即 $x_e(f) = \\xi(f)\\,\\Delta L$。将键断裂步骤视为一个具有与力无关的渡越态距离 $x_b$ 的能垒。\n\n对每个正向步骤采用带有 Kramers-Bell 力激活的渡越态理论：对于活化自由能为 $\\Delta G_i^{\\ddagger}(f)$ 的步骤 $i$，$k_i(f) \\propto \\exp\\!\\left[-\\beta \\Delta G_i^{\\ddagger}(f)\\right]$ 且 $\\frac{d}{df}\\ln k_i(f) = \\beta\\,x_i^{\\ddagger}(f)$，其中 $\\beta = 1/(k_B T)$ 且 $x_i^{\\ddagger}(f) = -\\frac{\\partial \\Delta G_i^{\\ddagger}}{\\partial f}$ 是到渡越态的机械投影距离。设零力正向速率为 $k_1(0) = k_1^0$ 和 $k_2(0) = k_2^0$。\n\n仅基于这些基础，推导有效渡越态距离 $x_{\\text{eff}}^{\\ddagger}(f)$ 的表达式，该距离可从 DFS 中 $\\ln k_{\\text{eff}}(f)$ 相对于 $f$ 的斜率推断得出，其中 $k_{\\text{eff}}(f)$ 是此两步序列中观测到的总正向速率。然后，在指定条件下对 $x_{\\text{eff}}^{\\ddagger}(f)$ 进行数值计算：\n- $T = 298\\,\\text{K}$,\n- $\\ell_p = 0.80\\,\\text{nm}$,\n- $\\Delta L = 1.00\\,\\text{nm}$,\n- $x_b = 0.25\\,\\text{nm}$,\n- $f = 20.0\\,\\text{pN}$,\n- $k_1^0 = 1.0\\,\\text{s}^{-1}$,\n- $k_2^0 = 1.0\\,\\text{s}^{-1}$.\n\n将 $x_{\\text{eff}}^{\\ddagger}$ 的最终答案以纳米为单位表示，并四舍五入到三位有效数字。", "solution": "问题要求推导在施加力 $f$ 的情况下，一个两步连续化学反应的有效渡越态距离 $x_{\\text{eff}}^{\\ddagger}(f)$。整个过程由反应式 $A \\xrightarrow{k_1(f)} I \\xrightarrow{k_2(f)} P$ 描述，其中两个步骤都是不可逆的。总速率 $k_{\\text{eff}}(f)$ 由总平均首达时间决定。\n\n对于一个由两个不可逆一级步骤组成的序列，总平均时间 $\\tau_{\\text{eff}}$ 是每个步骤平均时间 $\\tau_1$ 和 $\\tau_2$ 的和。速率常数为 $k$ 的单个不可逆步骤的平均时间为 $\\tau = 1/k$。因此，\n$$\n\\tau_{\\text{eff}}(f) = \\tau_1(f) + \\tau_2(f) = \\frac{1}{k_1(f)} + \\frac{1}{k_2(f)}\n$$\n有效速率常数 $k_{\\text{eff}}(f)$ 是总平均时间的倒数：\n$$\nk_{\\text{eff}}(f) = \\frac{1}{\\tau_{\\text{eff}}(f)} = \\left(\\frac{1}{k_1(f)} + \\frac{1}{k_2(f)}\\right)^{-1} = \\frac{k_1(f) k_2(f)}{k_1(f) + k_2(f)}\n$$\n有效渡越态距离 $x_{\\text{eff}}^{\\ddagger}(f)$ 由有效速率常数的力敏感性定义，这与 Bell 模型类似：\n$$\nx_{\\text{eff}}^{\\ddagger}(f) = \\frac{1}{\\beta} \\frac{d}{df} \\ln k_{\\text{eff}}(f)\n$$\n其中 $\\beta = 1/(k_B T)$。我们首先求出 $\\frac{d}{df} \\ln k_{\\text{eff}}(f)$ 的表达式。对 $k_{\\text{eff}}(f)$ 取自然对数：\n$$\n\\ln k_{\\text{eff}}(f) = \\ln(k_1(f)) + \\ln(k_2(f)) - \\ln(k_1(f) + k_2(f))\n$$\n对力 $f$ 求导：\n$$\n\\frac{d}{df} \\ln k_{\\text{eff}} = \\frac{d}{df} \\ln k_1 + \\frac{d}{df} \\ln k_2 - \\frac{1}{k_1 + k_2} \\left( \\frac{dk_1}{df} + \\frac{dk_2}{df} \\right)\n$$\n使用恒等式 $\\frac{dk_i}{df} = k_i \\frac{d}{df} \\ln k_i$：\n$$\n\\frac{d}{df} \\ln k_{\\text{eff}} = \\frac{d}{df} \\ln k_1 + \\frac{d}{df} \\ln k_2 - \\frac{1}{k_1 + k_2} \\left( k_1 \\frac{d}{df} \\ln k_1 + k_2 \\frac{d}{df} \\ln k_2 \\right)\n$$\n合并同类项：\n$$\n\\frac{d}{df} \\ln k_{\\text{eff}} = \\left(1 - \\frac{k_1}{k_1 + k_2}\\right) \\frac{d}{df} \\ln k_1 + \\left(1 - \\frac{k_2}{k_1 + k_2}\\right) \\frac{d}{df} \\ln k_2\n$$\n$$\n\\frac{d}{df} \\ln k_{\\text{eff}} = \\left(\\frac{k_2}{k_1 + k_2}\\right) \\frac{d}{df} \\ln k_1 + \\left(\\frac{k_1}{k_1 + k_2}\\right) \\frac{d}{df} \\ln k_2\n$$\n问题将单个渡越态距离定义为 $x_i^{\\ddagger}(f) = \\frac{1}{\\beta} \\frac{d}{df} \\ln k_i(f)$。将其代入 $\\frac{d}{df} \\ln k_{\\text{eff}}$ 的表达式中，得到：\n$$\n\\beta x_{\\text{eff}}^{\\ddagger}(f) = \\left(\\frac{k_2(f)}{k_1(f) + k_2(f)}\\right) \\beta x_1^{\\ddagger}(f) + \\left(\\frac{k_1(f)}{k_1(f) + k_2(f)}\\right) \\beta x_2^{\\ddagger}(f)\n$$\n消去 $\\beta$，我们得到有效渡越态距离的通用表达式：\n$$\nx_{\\text{eff}}^{\\ddagger}(f) = \\frac{k_2(f)}{k_1(f) + k_2(f)} x_1^{\\ddagger}(f) + \\frac{k_1(f)}{k_1(f) + k_2(f)} x_2^{\\ddagger}(f)\n$$\n这表明 $x_{\\text{eff}}^{\\ddagger}(f)$ 是单个距离 $x_1^{\\ddagger}(f)$ 和 $x_2^{\\ddagger}(f)$ 的加权平均值，其中权重取决于力 $f$ 下速率常数的相对大小。\n\n为了对该表达式进行数值计算，我们必须首先在指定条件下求出 $k_1(f)$、$k_2(f)$ 和 $x_1^{\\ddagger}(f)$。\n步骤 1 (熵致环打开) 的渡越态距离是与力相关的：\n$$\nx_1^{\\ddagger}(f) = x_e(f) = \\xi(f)\\,\\Delta L = \\left(1 - \\frac{1}{2} \\left(\\frac{k_B T}{f \\,\\ell_p}\\right)^{1/2}\\right) \\Delta L\n$$\n步骤 2 (键断裂) 的渡越态距离是恒定的：\n$$\nx_2^{\\ddagger}(f) = x_b\n$$\n速率常数通过对其力依赖性从 $f=0$ 积分得到：$k_i(f) = k_i^0 \\exp\\left(\\beta \\int_0^f x_i^{\\ddagger}(f') df'\\right)$。\n对于步骤 2：$\\int_0^f x_b df' = x_b f$。因此，$k_2(f) = k_2^0 \\exp(\\beta f x_b)$。\n对于步骤 1：$\\int_0^f x_1^{\\ddagger}(f') df' = \\int_0^f \\Delta L \\left(1 - \\frac{1}{2} \\sqrt{\\frac{k_B T}{\\ell_p}} (f')^{-1/2} \\right) df' = \\left[ \\Delta L f' - \\Delta L \\sqrt{\\frac{k_B T}{\\ell_p}} (f')^{1/2} \\right]_0^f = \\Delta L f - \\Delta L \\sqrt{\\frac{k_B T f}{\\ell_p}}$。\n所以，$k_1(f) = k_1^0 \\exp\\left(\\beta \\left( \\Delta L f - \\Delta L \\sqrt{\\frac{k_B T f}{\\ell_p}} \\right)\\right)$。\n\n现在，我们使用给定的值进行数值计算：\n$T = 298\\,\\text{K}$，$\\ell_p = 0.80\\,\\text{nm} = 0.80 \\times 10^{-9}\\,\\text{m}$，$\\Delta L = 1.00\\,\\text{nm} = 1.00 \\times 10^{-9}\\,\\text{m}$， $x_b = 0.25\\,\\text{nm} = 0.25 \\times 10^{-9}\\,\\text{m}$，$f = 20.0\\,\\text{pN} = 20.0 \\times 10^{-12}\\,\\text{N}$，$k_1^0 = 1.0\\,\\text{s}^{-1}$，$k_2^0 = 1.0\\,\\text{s}^{-1}$。\n设 $k_B = 1.3806 \\times 10^{-23}\\,\\text{J/K}$。\n热能为 $k_B T = (1.3806 \\times 10^{-23}\\,\\text{J/K})(298\\,\\text{K}) \\approx 4.114 \\times 10^{-21}\\,\\text{J}$。\n逆热能为 $\\beta = 1/(k_B T) \\approx 2.4307 \\times 10^{20}\\,\\text{J}^{-1}$。\n\n首先，计算 $x_1^{\\ddagger}(f)$：\n项 $f \\ell_p = (20.0 \\times 10^{-12}\\,\\text{N})(0.80 \\times 10^{-9}\\,\\text{m}) = 1.6 \\times 10^{-20}\\,\\text{J}$。\n$$\nx_1^{\\ddagger}(f) = \\left(1 - \\frac{1}{2} \\sqrt{\\frac{4.114 \\times 10^{-21}\\,\\text{J}}{1.6 \\times 10^{-20}\\,\\text{J}}}\\right) (1.00\\,\\text{nm}) = \\left(1 - \\frac{1}{2} \\sqrt{0.2571}\\right) (1.00\\,\\text{nm}) \\approx (1 - 0.2535) (1.00\\,\\text{nm}) = 0.7465\\,\\text{nm}\n$$\n接下来，计算 $k_2(f)$：\n指数为 $\\beta f x_b = (2.4307 \\times 10^{20}\\,\\text{J}^{-1})(20.0 \\times 10^{-12}\\,\\text{N})(0.25 \\times 10^{-9}\\,\\text{m}) \\approx 1.215$。\n$$\nk_2(f) = (1.0\\,\\text{s}^{-1}) \\exp(1.215) \\approx 3.370\\,\\text{s}^{-1}\n$$\n接下来，计算 $k_1(f)$：\n指数为 $\\beta \\left( \\Delta L f - \\Delta L \\sqrt{\\frac{k_B T f}{\\ell_p}} \\right) = \\beta \\Delta L f \\left(1 - \\sqrt{\\frac{k_B T}{f \\ell_p}}\\right)$。\n项 $\\beta \\Delta L f = (2.4307 \\times 10^{20}\\,\\text{J}^{-1})(1.00 \\times 10^{-9}\\,\\text{m})(20.0 \\times 10^{-12}\\,\\text{N}) \\approx 4.861$。\n项 $\\sqrt{k_B T/(f \\ell_p)} \\approx \\sqrt{0.2571} \\approx 0.5071$。\n指数为 $4.861(1 - 0.5071) \\approx 4.861 \\times 0.4929 \\approx 2.396$。\n$$\nk_1(f) = (1.0\\,\\text{s}^{-1}) \\exp(2.396) \\approx 10.98\\,\\text{s}^{-1}\n$$\n最后，将这些值代入 $x_{\\text{eff}}^{\\ddagger}(f)$ 的表达式中：\n$$\nx_{\\text{eff}}^{\\ddagger}(f) = \\frac{3.370\\,\\text{s}^{-1}}{10.98\\,\\text{s}^{-1} + 3.370\\,\\text{s}^{-1}} (0.7465\\,\\text{nm}) + \\frac{10.98\\,\\text{s}^{-1}}{10.98\\,\\text{s}^{-1} + 3.370\\,\\text{s}^{-1}} (0.25\\,\\text{nm})\n$$\n$$\nx_{\\text{eff}}^{\\ddagger}(f) = \\frac{3.370}{14.35} (0.7465\\,\\text{nm}) + \\frac{10.98}{14.35} (0.25\\,\\text{nm})\n$$\n$$\nx_{\\text{eff}}^{\\ddagger}(f) \\approx (0.2348)(0.7465\\,\\text{nm}) + (0.7652)(0.25\\,\\text{nm})\n$$\n$$\nx_{\\text{eff}}^{\\ddagger}(f) \\approx 0.1753\\,\\text{nm} + 0.1913\\,\\text{nm} \\approx 0.3666\\,\\text{nm}\n$$\n四舍五入到三位有效数字，有效渡越态距离为 $0.367\\,\\text{nm}$。", "answer": "$$\\boxed{0.367}$$", "id": "2778947"}, {"introduction": "前面的练习所使用的 Bell 模型假设活化距离 $x^{\\ddagger}$ 是一个常数，但这在很多情况下是一种简化。本次动手实践将通过一个计算化学模拟，让你深入探究力如何改变整个势能面的形状 [@problem_id:2778981]。你将基于一个模拟的量子化学计算（DFT）势能面，通过编程来精确计算力依赖的能垒高度 $\\Delta G(F)$，并将其与 Bell 模型和更复杂的 DHS 模型的预测进行比较，从而深刻理解力致能垒形状改变这一核心概念。", "problem": "考虑一个环丁烷力致发光团在外部拉伸力作用下发生开环反应的单坐标机械化学模型。内部反应坐标为二面角 $\\theta$（单位为弧度），沿拉伸轴的外部耦合分子伸长为 $x(\\theta)$（单位为纳米）。无力作用下的势能剖面 $U_0(\\theta)$（单位为千焦每摩尔）模拟了约束密度泛函理论（DFT）扫描；在恒定外力 $F$（单位为纳牛顿）作用下，总势能为\n$$\nU_F(\\theta) = U_0(\\theta) - F\\,x(\\theta)\\,C,\n$$\n其中 $C$ 是将纳牛顿-纳米转换为千焦每摩尔的转换因子。使用恒等式 $1\\,\\mathrm{nN}\\cdot\\mathrm{nm} = 10^{-18}\\,\\mathrm{J}$ 和阿伏伽德罗常数 $N_\\mathrm{A} = 6.02214076\\times 10^{23}\\,\\mathrm{mol}^{-1}$，我们得到\n$$\nC = \\frac{N_\\mathrm{A}\\times 10^{-18}\\,\\mathrm{J}}{10^{3}\\,\\mathrm{J/kJ}} \\approx 6.02214076 \\times 10^{2}\\,\\mathrm{kJ/mol}.\n$$\n\n您的任务是从 $U_F(\\theta)$ 中算法化地提取出力依赖的能垒高度 $\\Delta G(F)$，并将其与两种力激活能垒降低的典范模型进行比较，以诊断能垒形状的变化：\n\n- Bell 模型：能垒随力线性降低，遵循\n$$\n\\Delta G_{\\mathrm{Bell}}(F) = \\Delta G_0 - F\\,\\Delta x_0\\,C,\n$$\n其中 $\\Delta G_0$ 是零力能垒，$\\Delta x_0$ 是零力下反应物极小值与过渡态之间沿 $x(\\theta)$ 的投影距离。\n\n- Dudko–Hummer–Szabo (DHS) 模型：对于形状参数 $\\nu \\in \\{1/2,\\,2/3\\}$（分别对应尖点状和线性-立方能垒），预测的力依赖能垒为\n$$\n\\Delta G_{\\mathrm{DHS}}(F;\\nu) = \\Delta G_0\\left[1 - \\left(1 - \\nu\\,\\frac{F\\,\\Delta x_0\\,C}{\\Delta G_0}\\right)^{1/\\nu}\\right],\n$$\n该式在 $0 \\le F < \\frac{\\Delta G_0}{\\nu\\,\\Delta x_0\\,C}$ 时有效，当括号内的表达式不为正时，取值为 $0$。\n\n请基于以下原则进行推导：\n- 恒力下的总势能为 $U_F(\\theta)=U_0(\\theta)-F\\,x(\\theta)\\,C$。\n- 能垒高度 $\\Delta G(F)$ 是 $U_F(\\theta)$ 在反应物势阱极小值之后的第一个过渡态（局域极大值）处的值与该极小值处的值之差，沿 $\\theta$ 递增方向计算。\n- 反应物势阱极小值是靠近参考角 $\\theta_m$ 的局域极小值，该参考角表征了约束 DFT 扫描的对齐方式。\n\n我们为您提供了 $U_0(\\theta)$ 和 $x(\\theta)$ 的参数形式，用于模拟三种不同情况下的约束 DFT 扫描。对于每种情况，无力作用下的能量剖面和伸长映射定义为\n$$\nU_0(\\theta) = A_1\\big(1-\\cos(\\theta-\\theta_m)\\big) + A_2\\big(1-\\cos(2(\\theta-\\theta_m))\\big) + A_3\\big(1-\\cos(3(\\theta-\\theta_m))\\big),\n$$\n$$\nx(\\theta) = r_0\\big(1-\\cos(\\theta-\\theta_m)\\big) + r_1\\sin^2(\\theta-\\theta_m),\n$$\n其中 $\\theta \\in [0,\\pi]$，单位为弧度。\n\n您必须：\n1. 对于每种情况和每个指定的力 $F$，通过以下步骤计算 $\\Delta G(F)$：\n   - 将最接近 $\\theta_m$ 的 $U_F(\\theta)$ 的局域极小值确定为反应物极小值 $\\theta_\\mathrm{min}(F)$。\n   - 将 $\\theta^\\ddagger(F) > \\theta_\\mathrm{min}(F)$ 的第一个 $U_F(\\theta)$ 的局域极大值确定为第一个过渡态 $\\theta^\\ddagger(F)$。\n   - 当能垒存在时，设置 $\\Delta G(F) = \\max\\{U_F(\\theta^\\ddagger(F)) - U_F(\\theta_\\mathrm{min}(F)),\\,0\\}$ 和 $\\Delta x^\\ddagger(F) = x(\\theta^\\ddagger(F)) - x(\\theta_\\mathrm{min}(F))$；否则取 $\\Delta x^\\ddagger(F)=0$。\n2. 对每种情况，计算 $F=0$ 时的 $\\Delta G_0$ 和 $\\Delta x_0$。\n3. 对每种情况，使用从步骤 2 中提取的 $\\Delta G_0$ 和 $\\Delta x_0$，在相同的 $F$ 值集合上计算 Bell 和 DHS 模型的预测值。\n4. 通过计算所得 $\\Delta G(F)$ 与每个模型在非零力下的预测值之间的均方根误差 (RMSE) 来量化模型的一致性：\n$$\n\\mathrm{RMSE} = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N}\\left(\\Delta G(F_i) - \\Delta G_{\\mathrm{model}}(F_i)\\right)^2},\n$$\n其中 $F_1,\\dots,F_N$ 是测试套件中的非零力。\n5. 如果以下两个条件都成立，则判定该情况发生了能垒形状变化：\n   - 在集合 $\\{\\mathrm{Bell},\\,\\mathrm{DHS}(\\nu=1/2),\\,\\mathrm{DHS}(\\nu=2/3)\\}$ 中，最佳拟合模型（RMSE 最小）不是 Bell 模型，且 Bell 模型的 RMSE 超过最佳 RMSE 至少 $1.5$ 倍。\n   - 有效投影距离随力显著变化：设 $\\mathcal{S}=\\{\\Delta x^\\ddagger(F_i) : \\Delta G(F_i)>0 \\text{ and } F_i>0\\}$，那么如果 $\\mathcal{S}$ 非空，则要求\n$$\n\\frac{\\max(\\mathcal{S}) - \\min(\\mathcal{S})}{\\max(\\Delta x_0,\\,\\varepsilon)} \\ge 0.1,\n$$\n其中 $\\varepsilon = 10^{-9}$（单位为纳米）用于确保数值稳定性；如果 $\\mathcal{S}$ 为空，则不标记为形状变化。\n\n单位要求：所有角度必须以弧度处理。力必须以纳牛顿为单位。能量差的内部报告和比较必须以千焦每摩尔为单位。距离必须以纳米为单位。\n\n测试套件（三种情况；使用共同的力集合 $F \\in \\{0.00, 0.05, 0.15, 0.30, 0.45\\}$，单位为纳牛顿）：\n- 情况 1（中度非谐，弱耦合）：$A_1=30$，$A_2=40$，$A_3=5$（单位均为千焦每摩尔）；$r_0=0.12$，$r_1=0.02$（单位均为纳米）；$\\theta_m=0.60$（弧度）。\n- 情况 2（不对称，强耦合）：$A_1=40$，$A_2=60$，$A_3=20$；$r_0=0.18$，$r_1=0.06$；$\\theta_m=0.50$。\n- 情况 3（较浅能垒，接近力致能垒消失）：$A_1=10$，$A_2=15$，$A_3=5$；$r_0=0.15$，$r_1=0.03$；$\\theta_m=0.70$。\n\n最终输出格式：\n- 对于每种情况，输出一个包含两个整数的子列表 $[m, s]$：\n  - $m$ 是根据非零力下的 RMSE 确定的最佳模型的索引：$m=0$ 代表 Bell 模型，$m=1$ 代表 $\\nu=1/2$ 的 DHS 模型，$m=2$ 代表 $\\nu=2/3$ 的 DHS 模型。\n  - 如果根据上述标准识别出能垒形状变化，则 $s$ 为 $1$，否则为 $0$。\n- 您的程序应生成单行输出，其中包含这些子列表组成的逗号分隔列表，并用方括号括起来，例如 $[[2,1],[0,0],[1,1]]$。\n\n约束和实现细节：\n- 在 $\\theta \\in [0,\\pi]$ 上使用足够精细的均匀网格，以稳健地检测局域极小值和极大值。\n- 通过数值导数 $dU_F/d\\theta$ 的符号变化来识别局域极小值和极大值。\n- 始终选择最接近 $\\theta_m$ 的局域极小值作为反应物极小值。\n- 当反应物极小值的右侧不存在局域极大值时，对于该力，能垒取为 $0$。\n- 所有数值计算必须是自包含的，没有外部输入。\n\n您的程序必须是一个完整、可运行的实现，对提供的测试套件执行这些步骤，并以指定的确切格式打印最终列表。", "solution": "问题陈述已经过严格验证，被认为是有效的。它在理论机械化学领域提出了一个适定的计算练习，其基础是已确立的物理原理。它是自包含的、客观的、科学上合理的，所有参数和程序都得到了明确的规定。其目标是分析一个力激活化学反应的参数模型，并诊断其相对于典范理论的行为。我们将开始进行求解。\n\n问题的核心是分析单一反应坐标 $\\theta$ 的势能面 $U_F(\\theta) = U_0(\\theta) - F\\,x(\\theta)\\,C$。该分析涉及定位反应物态的极小值和随后的过渡态，以确定活化能垒 $\\Delta G(F)$ 作为外施力 $F$ 的函数。\n\n计算过程实现如下：\n\n1.  **离散化与势能面映射**：将连续的反应坐标 $\\theta$ 在其定义域 $\\theta \\in [0, \\pi]$ 上离散化为一个精细的均匀网格。这使得函数 $U_0(\\theta)$、$x(\\theta)$ 以及最终的 $U_F(\\theta)$ 可以表示为数值数组。选择足够多的网格点以确保势能面的所有相关特征都能被解析。\n\n2.  **定位驻点**：通过分析势能面 $U_F(\\theta)$ 的数值导数 $\\frac{dU_F}{d\\theta}$ 来识别其局域极小值和极大值。具体来说，我们计算势能数组的一阶有限差分。导数符号从负到正的变化表示局域极小值，而从正到负的变化表示局域极大值。此方法可在离散网格上稳健地识别所有驻点。\n\n3.  **提取能垒参数**：对于给定集合中的每个力值 $F$，我们执行以下步骤：\n    - 将 $U_F(\\theta)$ 曲面上坐标 $\\theta$ 最接近每个案例给定的参考角 $\\theta_m$ 的局域极小值确定为反应物态极小值 $\\theta_{\\mathrm{min}}(F)$。\n    - 将在角度 $\\theta > \\theta_{\\mathrm{min}}(F)$ 处出现的第一个局域极大值确定为相关过渡态 $\\theta^\\ddagger(F)$。\n    - 如果存在这样的过渡态，则力依赖的活化能垒计算为 $\\Delta G(F) = U_F(\\theta^\\ddagger(F)) - U_F(\\theta_{\\mathrm{min}}(F))$。相应的投影距离为 $\\Delta x^\\ddagger(F) = x(\\theta^\\ddagger(F)) - x(\\theta_{\\mathrm{min}}(F))$。\n    - 如果在反应物极小值之后未找到过渡态（表明能垒已被力消除），则能垒高度 $\\Delta G(F)$ 取为 $0$，相应地 $\\Delta x^\\ddagger(F)$ 也设为 $0$。为确保物理一致性，能垒高度始终取非负值，即 $\\Delta G(F) = \\max\\{U_F(\\theta^\\ddagger(F)) - U_F(\\theta_{\\mathrm{min}}(F)), 0\\}$。\n\n4.  **模型拟合与比较**：首先在零力（$F=0$）下应用前一步的程序，以确定内禀能垒高度 $\\Delta G_0$ 和过渡态投影 $\\Delta x_0$。然后使用这两个参数，通过两种模型生成力依赖能垒高度的理论预测：\n    - Bell 模型：$\\Delta G_{\\mathrm{Bell}}(F) = \\max\\{0, \\Delta G_0 - F\\,\\Delta x_0\\,C\\}$。\n    - Dudko–Hummer–Szabo (DHS) 模型：对于能垒形状参数 $\\nu \\in \\{1/2, 2/3\\}$，$\\Delta G_{\\mathrm{DHS}}(F;\\nu) = \\Delta G_0\\left[1 - \\left(1 - \\nu\\,\\frac{F\\,\\Delta x_0\\,C}{\\Delta G_0}\\right)^{1/\\nu}\\right]$。如果 $F \\ge \\frac{\\Delta G_0}{\\nu\\,\\Delta x_0\\,C}$，则预测的能垒设为 $0$。\n    \n    每个模型的准确性通过计算其预测值与在所有非零力下数值计算得到的 $\\Delta G(F)$ 值之间的均方根误差 (RMSE) 来评估。产生最小 RMSE 的模型被确定为该情况下的最佳拟合模型。\n\n5.  **能垒形状变化诊断**：基于两个具体标准来诊断负载下活化能垒形状的显著变化：\n    - **模型差异**：最佳拟合模型必须是 DHS 模型之一（$\\nu=1/2$ 或 $\\nu=2/3$），并且其 RMSE 必须显著优于 Bell 模型。条件是 Bell 模型的 RMSE 至少是最佳模型 RMSE 的 $1.5$ 倍。\n    - **过渡态移动**：由 $\\Delta x^\\ddagger(F)$ 捕捉到的沿拉伸坐标的过渡态位置必须随力表现出显著变化。这通过条件 $\\frac{\\max(\\mathcal{S}) - \\min(\\mathcal{S})}{\\max(\\Delta x_0,\\,\\varepsilon)} \\ge 0.1$ 来量化，其中 $\\mathcal{S}$ 是在能垒仍然存在的非零力下 $\\Delta x^\\ddagger(F_i)$ 值的集合，$\\varepsilon=10^{-9}\\,\\mathrm{nm}$ 是一个用于数值稳定性的小常数。\n\n    只有当两个条件都满足时，才标记形状变化（输出 $s=1$）。否则，不报告显著的形状变化（输出 $s=0$）。这一整套方法系统地应用于提供的三个测试案例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the mechanochemistry problem for three test cases.\n    \"\"\"\n    # Define constants\n    N_A = 6.02214076e23  # Avogadro's number, mol^-1\n    C = N_A * 1e-18 / 1e3  # Conversion factor, nN*nm -> kJ/mol\n\n    # Common parameters\n    F_set = np.array([0.00, 0.05, 0.15, 0.30, 0.45])  # Forces in nN\n    theta_grid = np.linspace(0, np.pi, 20000)  # Reaction coordinate grid\n\n    # Test cases: (A1, A2, A3, r0, r1, theta_m)\n    test_cases = [\n        {'params': {'A1': 30, 'A2': 40, 'A3': 5, 'r0': 0.12, 'r1': 0.02, 'theta_m': 0.60}},\n        {'params': {'A1': 40, 'A2': 60, 'A3': 20, 'r0': 0.18, 'r1': 0.06, 'theta_m': 0.50}},\n        {'params': {'A1': 10, 'A2': 15, 'A3': 5, 'r0': 0.15, 'r1': 0.03, 'theta_m': 0.70}}\n    ]\n\n    # Helper functions\n    def U0(theta, p):\n        tm = p['theta_m']\n        return p['A1'] * (1 - np.cos(theta - tm)) + \\\n               p['A2'] * (1 - np.cos(2 * (theta - tm))) + \\\n               p['A3'] * (1 - np.cos(3 * (theta - tm)))\n\n    def x_ext(theta, p):\n        tm = p['theta_m']\n        return p['r0'] * (1 - np.cos(theta - tm)) + p['r1'] * np.sin(theta - tm)**2\n\n    def get_extrema(potential_curve):\n        diffs = np.diff(potential_curve)\n        signs = np.sign(diffs)\n        sign_changes = np.diff(signs)\n        min_indices = np.where(sign_changes == 2)[0] + 1\n        max_indices = np.where(sign_changes == -2)[0] + 1\n        return min_indices, max_indices\n\n    def bell_model(F, dG0, dx0):\n        pred = dG0 - F * dx0 * C\n        return max(0, pred)\n\n    def dhs_model(F, dG0, dx0, nu):\n        if dG0 <= 0 or F * dx0 <= 0:\n            return 0.0\n        \n        term = 1 - nu * F * dx0 * C / dG0\n        if term <= 0:\n            return 0.0\n        else:\n            return dG0 * (1 - term**(1 / nu))\n    \n    final_results = []\n\n    for case in test_cases:\n        p = case['params']\n        theta_m = p['theta_m']\n\n        computed_dG = []\n        computed_dx = []\n\n        U0_curve = U0(theta_grid, p)\n        x_curve = x_ext(theta_grid, p)\n\n        for F in F_set:\n            UF_curve = U0_curve - F * x_curve * C\n            min_indices, max_indices = get_extrema(UF_curve)\n\n            if min_indices.size == 0:\n                # This should not happen for the given potentials near theta_m\n                final_results.append([0, 0])\n                continue\n\n            # Find reactant minimum (closest to theta_m)\n            min_thetas = theta_grid[min_indices]\n            reactant_min_idx_in_mins = np.argmin(np.abs(min_thetas - theta_m))\n            reactant_min_idx = min_indices[reactant_min_idx_in_mins]\n\n            # Find first transition state after reactant minimum\n            ts_indices = max_indices[max_indices > reactant_min_idx]\n            \n            if ts_indices.size > 0:\n                ts_idx = ts_indices[0]\n                dG_F = UF_curve[ts_idx] - UF_curve[reactant_min_idx]\n                dG_F = max(0, dG_F)\n                \n                if dG_F > 0:\n                    dx_F = x_curve[ts_idx] - x_curve[reactant_min_idx]\n                else:\n                    dx_F = 0.0\n            else:\n                dG_F = 0.0\n                dx_F = 0.0\n\n            computed_dG.append(dG_F)\n            computed_dx.append(dx_F)\n        \n        # Extract zero-force parameters\n        dG0 = computed_dG[0]\n        dx0 = computed_dx[0]\n\n        # Analyze for non-zero forces\n        F_nonzero = F_set[1:]\n        dG_nonzero = np.array(computed_dG[1:])\n        dx_nonzero = np.array(computed_dx[1:])\n        \n        if F_nonzero.size == 0:\n            final_results.append([0, 0])\n            continue\n            \n        # Model predictions\n        pred_bell = np.array([bell_model(F, dG0, dx0) for F in F_nonzero])\n        pred_dhs12 = np.array([dhs_model(F, dG0, dx0, 1/2) for F in F_nonzero])\n        pred_dhs23 = np.array([dhs_model(F, dG0, dx0, 2/3) for F in F_nonzero])\n\n        # RMSE calculations\n        rmse_bell = np.sqrt(np.mean((dG_nonzero - pred_bell)**2))\n        rmse_dhs12 = np.sqrt(np.mean((dG_nonzero - pred_dhs12)**2))\n        rmse_dhs23 = np.sqrt(np.mean((dG_nonzero - pred_dhs23)**2))\n\n        rmses = [rmse_bell, rmse_dhs12, rmse_dhs23]\n        m = np.argmin(rmses) # 0=Bell, 1=DHS(1/2), 2=DHS(2/3)\n\n        # Shape change criteria\n        s = 0\n        cond1 = (m != 0) and (rmses[0] / rmses[m] >= 1.5)\n\n        S_set = dx_nonzero[dG_nonzero > 0]\n        cond2 = False\n        if S_set.size > 0:\n            epsilon = 1e-9\n            dx_spread = (np.max(S_set) - np.min(S_set)) / max(dx0, epsilon)\n            if dx_spread >= 0.1:\n                cond2 = True\n        \n        if cond1 and cond2:\n            s = 1\n        \n        final_results.append([m, s])\n\n    # Format the final output string\n    formatted_results = [f'[{r[0]},{r[1]}]' for r in final_results]\n    print(f'[{\",\".join(formatted_results)}]')\n\nsolve()\n```", "id": "2778981"}]}