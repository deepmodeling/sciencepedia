{"hands_on_practices": [{"introduction": "在我们能够设计控制器来抑制或利用共振之前，我们必须能够精确地量化它。本练习将引导您从第一性原理出发，推导一个典型的二阶系统的共振频率（$ \\omega_r $）和共振峰值（$ M_r $）。掌握这些基础推导，对于理解系统参数（如阻尼比 $ \\zeta $ 和自然频率 $ \\omega_n $）如何直接影响频域响应特性至关重要，并为更复杂的设计任务奠定坚实的数学直觉。[@problem_id:2740189]", "problem": "一个单输入单输出的线性时不变二阶闭环系统具有传递函数\n$$\nT(s) \\;=\\; \\frac{\\omega_n^{2}}{s^{2} + 2 \\zeta \\,\\omega_n\\, s + \\omega_n^{2}},\n$$\n其中 $\\zeta \\in (0,1)$ 是阻尼比，$\\omega_n > 0$ 是自然频率。在角频率 $\\omega$ 下的稳态正弦响应幅值由 $\\left|T(\\mathrm{j}\\omega)\\right|$ 给出。\n\n定义共振频率 $\\omega_r$ 为使 $\\left|T(\\mathrm{j}\\omega)\\right|$ 最大化的角频率，并定义共振峰值 $M_r$ 为 $M_r = \\max_{\\omega \\ge 0} \\left|T(\\mathrm{j}\\omega)\\right|$。围绕共振峰值的 $-3$ dB 带宽定义为 $\\Delta \\omega = \\omega_{+} - \\omega_{-}$，其中 $\\omega_{\\pm}$ 是满足 $\\left|T(\\mathrm{j}\\omega_{\\pm})\\right| = M_r / \\sqrt{2}$ 的两个频率。\n\n从上述定义和关于频率响应的标准微积分出发，从第一性原理推导 $\\omega_r$ 和 $M_r$ (不使用预先记下的共振公式)。然后，使用一个基于 $\\left|T(\\mathrm{j}\\omega)\\right|$ 在 $\\omega_r$ 附近的局部曲率而合理的小阻尼二阶近似，估计小 $\\zeta$ 情况下的 $-3$ dB 带宽 $\\Delta \\omega$。\n\n对特定参数值 $\\zeta = 0.1$ 和 $\\omega_n = 10$ 计算您最终表达式的值，并提供 $\\omega_r$ (单位 rad/s)，$M_r$ (无量纲) 和估计的 $\\Delta \\omega$ (单位 rad/s) 的数值。将答案四舍五入至四位有效数字。角频率以弧度每秒 (rad/s) 表示。", "solution": "所提出的问题是二阶线性时不变系统分析中的一个标准练习。它具有科学依据、问题适定、客观且内部一致。因此，将提供一个解答。\n\n闭环传递函数由下式给出\n$$\nT(s) = \\frac{\\omega_n^{2}}{s^{2} + 2\\zeta\\omega_n s + \\omega_n^{2}}\n$$\n其中阻尼比 $\\zeta$ 的范围是 $(0,1)$，自然频率 $\\omega_n > 0$。\n\n为了求得频率响应，我们代入 $s = \\mathrm{j}\\omega$：\n$$\nT(\\mathrm{j}\\omega) = \\frac{\\omega_n^{2}}{(\\mathrm{j}\\omega)^{2} + 2\\zeta\\omega_n(\\mathrm{j}\\omega) + \\omega_n^{2}} = \\frac{\\omega_n^{2}}{(\\omega_n^{2} - \\omega^{2}) + \\mathrm{j}(2\\zeta\\omega_n\\omega)}\n$$\n频率响应的幅值平方为\n$$\n|T(\\mathrm{j}\\omega)|^{2} = \\frac{(\\omega_n^{2})^{2}}{(\\omega_n^{2} - \\omega^{2})^{2} + (2\\zeta\\omega_n\\omega)^{2}}\n$$\n共振频率 $\\omega_r$ 是使 $|T(\\mathrm{j}\\omega)|$ 最大化的频率 $\\omega \\ge 0$。这等价于最小化分母，我们将其记为 $D(\\omega)$：\n$$\nD(\\omega) = (\\omega_n^{2} - \\omega^{2})^{2} + 4\\zeta^{2}\\omega_n^{2}\\omega^{2} = \\omega^{4} - 2\\omega_n^{2}\\omega^{2} + \\omega_n^{4} + 4\\zeta^{2}\\omega_n^{2}\\omega^{2} = \\omega^{4} + 2(2\\zeta^{2}-1)\\omega_n^{2}\\omega^{2} + \\omega_n^{4}\n$$\n为了找到 $D(\\omega)$ 在 $\\omega > 0$ 时的最小值，我们对 $\\omega$ 求导，并令导数为零：\n$$\n\\frac{dD}{d\\omega} = 4\\omega^{3} + 4(2\\zeta^{2}-1)\\omega_n^{2}\\omega = 0\n$$\n由于我们关心的是 $\\omega > 0$ 时的非平凡峰值，我们可以除以 $4\\omega$：\n$$\n\\omega^{2} + (2\\zeta^{2}-1)\\omega_n^{2} = 0 \\quad \\implies \\quad \\omega^{2} = (1-2\\zeta^{2})\\omega_n^{2}\n$$\n当且仅当 $1-2\\zeta^{2} > 0$ 时，即 $\\zeta < 1/\\sqrt{2}$ 时，$\\omega_r$ 存在实数正解。对于 $\\zeta \\ge 1/\\sqrt{2}$，导数对所有 $\\omega \\ge 0$ 都是非负的，因此 $|T(\\mathrm{j}\\omega)|$ 的最大值出现在 $\\omega=0$ 处。对于数值计算中给定的 $\\zeta=0.1$，该条件是满足的。\n因此，共振频率为：\n$$\n\\omega_r = \\omega_n \\sqrt{1 - 2\\zeta^{2}}\n$$\n共振峰值 $M_r$ 是 $|T(\\mathrm{j}\\omega)|$ 在 $\\omega=\\omega_r$ 处的值。我们通过将 $\\omega_r^2$ 代入 $|T(\\mathrm{j}\\omega)|^2$ 的表达式来计算幅值平方 $|T(\\mathrm{j}\\omega_r)|^{2}$：\n$$\n|T(\\mathrm{j}\\omega_r)|^{2} = \\frac{\\omega_n^{4}}{(\\omega_n^{2} - \\omega_r^{2})^{2} + 4\\zeta^{2}\\omega_n^{2}\\omega_r^{2}}\n$$\n使用 $\\omega_r^{2} = (1-2\\zeta^{2})\\omega_n^{2}$，我们有 $\\omega_n^{2} - \\omega_r^{2} = 2\\zeta^{2}\\omega_n^{2}$。将此代入分母：\n$$\n(\\omega_n^{2} - \\omega_r^{2})^{2} + 4\\zeta^{2}\\omega_n^{2}\\omega_r^{2} = (2\\zeta^{2}\\omega_n^{2})^{2} + 4\\zeta^{2}\\omega_n^{2}(\\omega_n^{2}(1-2\\zeta^{2})) \\\\\n= 4\\zeta^{4}\\omega_n^{4} + 4\\zeta^{2}\\omega_n^{4}(1-2\\zeta^{2}) \\\\\n= 4\\zeta^{4}\\omega_n^{4} + 4\\zeta^{2}\\omega_n^{4} - 8\\zeta^{4}\\omega_n^{4} \\\\\n= 4\\zeta^{2}\\omega_n^{4}(1-\\zeta^{2})\n$$\n所以，峰值幅值的平方是：\n$$\nM_r^{2} = |T(\\mathrm{j}\\omega_r)|^{2} = \\frac{\\omega_n^{4}}{4\\zeta^{2}\\omega_n^{4}(1-\\zeta^{2})} = \\frac{1}{4\\zeta^{2}(1-\\zeta^{2})}\n$$\n共振峰值为：\n$$\nM_r = \\frac{1}{2\\zeta\\sqrt{1-\\zeta^{2}}}\n$$\n接下来，我们求带宽 $\\Delta \\omega = \\omega_{+} - \\omega_{-}$。频率 $\\omega_{\\pm}$ 由条件 $|T(\\mathrm{j}\\omega_{\\pm})| = M_r/\\sqrt{2}$ 定义，这等价于 $|T(\\mathrm{j}\\omega_{\\pm})|^2 = M_r^2/2$。\n$$\n\\frac{\\omega_n^{4}}{(\\omega_n^{2} - \\omega^{2})^{2} + 4\\zeta^{2}\\omega_n^{2}\\omega^{2}} = \\frac{1}{2} \\left(\\frac{1}{4\\zeta^{2}(1-\\zeta^{2})}\\right) = \\frac{1}{8\\zeta^{2}(1-\\zeta^{2})}\n$$\n令 $x = \\omega^2$。分母的等式变为：\n$$\n(\\omega_n^{2} - x)^{2} + 4\\zeta^{2}\\omega_n^{2}x = 8\\zeta^{2}(1-\\zeta^{2})\\omega_n^{4}\n$$\n展开并整理各项，得到一个关于 $x$ 的二次方程：\n$$\n\\omega_n^{4} - 2\\omega_n^{2}x + x^{2} + 4\\zeta^{2}\\omega_n^{2}x = 8\\zeta^{2}\\omega_n^{4} - 8\\zeta^{4}\\omega_n^{4} \\\\\nx^{2} + (4\\zeta^{2}-2)\\omega_n^{2}x + (\\omega_n^{4} - 8\\zeta^{2}\\omega_n^{4} + 8\\zeta^{4}\\omega_n^{4}) = 0\n$$\n解 $x_{\\pm} = \\omega_{\\pm}^2$ 由二次方程求根公式给出：\n$$\nx_{\\pm} = \\frac{-(4\\zeta^{2}-2)\\omega_n^{2} \\pm \\sqrt{((4\\zeta^{2}-2)\\omega_n^{2})^{2} - 4(\\omega_n^{4} - 8\\zeta^{2}\\omega_n^{4} + 8\\zeta^{4}\\omega_n^{4})}}{2} \\\\\n= (1-2\\zeta^{2})\\omega_n^{2} \\pm \\frac{\\omega_n^{2}}{2}\\sqrt{(4\\zeta^{2}-2)^{2} - 4(1 - 8\\zeta^{2} + 8\\zeta^{4})} \\\\\n= (1-2\\zeta^{2})\\omega_n^{2} \\pm \\frac{\\omega_n^{2}}{2}\\sqrt{16\\zeta^{4}-16\\zeta^{2}+4 - 4 + 32\\zeta^{2} - 32\\zeta^{4}} \\\\\n= (1-2\\zeta^{2})\\omega_n^{2} \\pm \\frac{\\omega_n^{2}}{2}\\sqrt{16\\zeta^{2}-16\\zeta^{4}} = (1-2\\zeta^{2})\\omega_n^{2} \\pm 2\\zeta\\omega_n^{2}\\sqrt{1-\\zeta^{2}}\n$$\n问题要求对小 $\\zeta$ 估计 $\\Delta \\omega = \\omega_{+} - \\omega_{-}$。我们有 $\\omega_{\\pm} = \\sqrt{x_{\\pm}}$。\n$$\n\\omega_{\\pm} = \\omega_n \\sqrt{(1-2\\zeta^{2}) \\pm 2\\zeta\\sqrt{1-\\zeta^{2}}}\n$$\n对于小 $\\zeta$，我们使用泰勒展开 $\\sqrt{1-u} \\approx 1 - u/2$：\n$$\n\\sqrt{1-\\zeta^{2}} \\approx 1 - \\frac{\\zeta^{2}}{2}\n$$\n$$\nx_{\\pm} \\approx \\omega_n^{2}\\left(1-2\\zeta^{2} \\pm 2\\zeta(1-\\frac{\\zeta^{2}}{2})\\right) = \\omega_n^{2}(1-2\\zeta^{2} \\pm (2\\zeta - \\zeta^{3}))\n$$\n现在我们使用 $\\sqrt{1+\\epsilon} \\approx 1+\\epsilon/2$ 来求 $\\omega_{\\pm} = \\sqrt{x_{\\pm}}$：\n$$\n\\omega_{+} \\approx \\omega_n \\sqrt{1 + 2\\zeta - 2\\zeta^{2}} \\approx \\omega_n \\left(1 + \\frac{1}{2}(2\\zeta - 2\\zeta^{2})\\right) = \\omega_n(1+\\zeta-\\zeta^{2})\n$$\n$$\n\\omega_{-} \\approx \\omega_n \\sqrt{1 - 2\\zeta - 2\\zeta^{2}} \\approx \\omega_n \\left(1 - \\frac{1}{2}(2\\zeta + 2\\zeta^{2})\\right) = \\omega_n(1-\\zeta-\\zeta^{2})\n$$\n于是带宽 $\\Delta\\omega$ 估计为：\n$$\n\\Delta\\omega = \\omega_{+} - \\omega_{-} \\approx \\omega_n(1+\\zeta-\\zeta^{2}) - \\omega_n(1-\\zeta-\\zeta^{2}) = 2\\zeta\\omega_n\n$$\n这是轻阻尼系统围绕共振峰值的 $-3\\,\\text{dB}$ 带宽的标准一阶近似。\n\n现在我们对 $\\zeta=0.1$ 和 $\\omega_n=10\\,\\text{rad/s}$ 计算这些表达式的值。\n\n共振频率：\n$$\n\\omega_r = 10 \\sqrt{1 - 2(0.1)^{2}} = 10 \\sqrt{1 - 0.02} = 10 \\sqrt{0.98} \\approx 9.8994949\\,\\text{rad/s}\n$$\n四舍五入到四位有效数字，得到 $\\omega_r = 9.899\\,\\text{rad/s}$。\n\n共振峰值：\n$$\nM_r = \\frac{1}{2(0.1)\\sqrt{1-(0.1)^{2}}} = \\frac{1}{0.2\\sqrt{0.99}} = \\frac{5}{\\sqrt{0.99}} \\approx 5.025189...\n$$\n四舍五入到四位有效数字，得到 $M_r = 5.025$。\n\n估计带宽：\n$$\n\\Delta \\omega \\approx 2\\zeta\\omega_n = 2(0.1)(10) = 2 \\,\\text{rad/s}\n$$\n四舍五入到四位有效数字，得到 $\\Delta\\omega = 2.000\\,\\text{rad/s}$。\n\n所求的值是 $\\omega_r$、$M_r$ 和估计的 $\\Delta \\omega$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 9.899 & 5.025 & 2.000 \\end{pmatrix}}\n$$", "id": "2740189"}, {"introduction": "在掌握了共振分析的基础后，下一步是进行主动控制。本练习模拟了一个常见的工程设计情景：您需要设计一个简单的比例控制器来调整系统的闭环响应。这项任务要求您在满足特定频率下的性能指标与维持足够的系统阻尼以保证鲁棒性之间找到平衡，这是控制工程中的一个核心挑战。[@problem_id:2740155]", "problem": "考虑一个单位反馈回路，其线性时不变 (LTI) 对象为一个归一化形式的质量-弹簧-阻尼系统\n$$\nG(s) \\;=\\; \\frac{1}{s^{2} + 2\\,\\zeta_{0}\\,\\omega_{0}\\,s + \\omega_{0}^{2}},\n$$\n其中 $\\omega_{0} = 10$ (弧度/秒) 是自然频率，$\\zeta_{0} = 0.3$ 是开环阻尼比。控制器是一个标量增益 $k_{r} \\in \\mathbb{R}_{>0}$。根据定义，闭环补灵敏度为\n$$\nT(s) \\;=\\; \\frac{k_{r}\\,G(s)}{1 + k_{r}\\,G(s)}.\n$$\n\n要求设计 $k_{r}$，使得在指定频率 $\\omega_{r} = 10$ (弧度/秒) 下，闭环幅值等于目标值 $A_{r} = 0.50$，即\n$$\n\\bigl|T(j\\,\\omega_{r})\\bigr| \\;=\\; A_{r}.\n$$\n在所有满足此幅值规范的 $k_{r} > 0$ 中，您必须确保所得的闭环阻尼比 $\\zeta_{c}$ 满足约束 $\\zeta_{c} \\ge \\zeta_{\\min}$，其中 $\\zeta_{\\min} = 0.25$。$\\zeta_{c}$ 的定义是通过将闭环特征多项式转换为标准二阶形式 $s^{2} + 2\\,\\zeta_{c}\\,\\omega_{c}\\,s + \\omega_{c}^{2}$ 得出的。\n\n选定这样一个 $k_{r}$ 后，计算所得的共振峰值，即闭环补灵敏度幅值的最大值 $\\max_{\\omega \\ge 0} |T(j\\,\\omega)|$。\n\n将最终答案表示为一个无量纲的实数。将您的答案四舍五入至四位有效数字。", "solution": "我们从补灵敏度的单位反馈定义开始，\n$$\nT(s) \\;=\\; \\frac{k_{r}\\,G(s)}{1 + k_{r}\\,G(s)}.\n$$\n代入 $G(s) = 1/(s^{2} + 2\\,\\zeta_{0}\\,\\omega_{0}\\,s + \\omega_{0}^{2})$，该式可代数化简为\n$$\nT(s) \\;=\\; \\frac{k_{r}}{s^{2} + 2\\,\\zeta_{0}\\,\\omega_{0}\\,s + \\omega_{0}^{2} + k_{r}}.\n$$\n因此，闭环特征多项式为\n$$\ns^{2} + 2\\,\\zeta_{0}\\,\\omega_{0}\\,s + \\omega_{0}^{2} + k_{r}.\n$$\n与标准二阶形式 $s^{2} + 2\\,\\zeta_{c}\\,\\omega_{c}\\,s + \\omega_{c}^{2}$ 匹配，可得以下恒等式\n$$\n\\omega_{c}^{2} \\;=\\; \\omega_{0}^{2} + k_{r}, \n\\qquad\n2\\,\\zeta_{c}\\,\\omega_{c} \\;=\\; 2\\,\\zeta_{0}\\,\\omega_{0}\n\\;\\;\\Rightarrow\\;\\;\n\\zeta_{c} \\;=\\; \\frac{\\zeta_{0}\\,\\omega_{0}}{\\sqrt{\\omega_{0}^{2} + k_{r}}}.\n$$\n\n在 $\\omega_{r}$ 处的幅值规范。计算 $T(j\\,\\omega)$ 的幅值得到\n$$\n\\bigl|T(j\\,\\omega)\\bigr| \\;=\\; \\frac{k_{r}}{\\sqrt{\\bigl(\\omega_{0}^{2} + k_{r} - \\omega^{2}\\bigr)^{2} + \\bigl(2\\,\\zeta_{0}\\,\\omega_{0}\\,\\omega\\bigr)^{2}}}.\n$$\n设 $\\bigl|T(j\\,\\omega_{r})\\bigr| = A_{r}$，得到方程\n$$\n\\frac{k_{r}}{\\sqrt{\\bigl(\\omega_{0}^{2} + k_{r} - \\omega_{r}^{2}\\bigr)^{2} + \\bigl(2\\,\\zeta_{0}\\,\\omega_{0}\\,\\omega_{r}\\bigr)^{2}}} \\;=\\; A_{r}.\n$$\n两边平方并整理，得到一个关于 $k_{r}$ 的二次方程，\n$$\n\\bigl(1 - A_{r}^{2}\\bigr)\\,k_{r}^{2} \\;-\\; 2\\,A_{r}^{2}\\,(\\omega_{0}^{2} - \\omega_{r}^{2})\\,k_{r} \\;-\\; A_{r}^{2}\\!\\left[(\\omega_{0}^{2} - \\omega_{r}^{2})^{2} + \\bigl(2\\,\\zeta_{0}\\,\\omega_{0}\\,\\omega_{r}\\bigr)^{2}\\right] \\;=\\; 0,\n$$\n其正解为\n$$\nk_{r} \\;=\\; \\frac{A_{r}^{2}\\,(\\omega_{0}^{2} - \\omega_{r}^{2}) + A_{r}\\,\\sqrt{(\\omega_{0}^{2} - \\omega_{r}^{2})^{2} + \\bigl(1 - A_{r}^{2}\\bigr)\\,\\bigl(2\\,\\zeta_{0}\\,\\omega_{0}\\,\\omega_{r}\\bigr)^{2}}}{1 - A_{r}^{2}}.\n$$\n对于给定值 $\\omega_{r} = \\omega_{0} = 10$，$\\zeta_{0} = 0.3$ 和 $A_{r} = 0.50$，我们有 $\\omega_{0}^{2} - \\omega_{r}^{2} = 0$ 以及 $2\\,\\zeta_{0}\\,\\omega_{0}\\,\\omega_{r} = 2 \\cdot 0.3 \\cdot 10 \\cdot 10 = 60$，因此上式简化为\n$$\nk_{r} \\;=\\; \\frac{A_{r}\\,\\sqrt{\\bigl(1 - A_{r}^{2}\\bigr)\\,(60)^{2}}}{1 - A_{r}^{2}}\n\\;=\\; \\frac{60\\,A_{r}}{\\sqrt{1 - A_{r}^{2}}}.\n$$\n代入 $A_{r} = 0.50$，\n$$\nk_{r} \\;=\\; \\frac{60 \\cdot 0.50}{\\sqrt{1 - 0.50^{2}}}\n\\;=\\; \\frac{30}{\\sqrt{0.75}}\n\\;\\approx\\; 34.6410161513775.\n$$\n\n阻尼比约束。闭环阻尼比为 $\\zeta_{c} = \\zeta_{0}\\,\\omega_{0} / \\sqrt{\\omega_{0}^{2} + k_{r}}$。要求 $\\zeta_{c} \\ge \\zeta_{\\min}$ 等价于\n$$\n\\sqrt{\\omega_{0}^{2} + k_{r}} \\;\\le\\; \\frac{\\zeta_{0}\\,\\omega_{0}}{\\zeta_{\\min}}\n\\;\\;\\Longleftrightarrow\\;\\;\nk_{r} \\;\\le\\; \\omega_{0}^{2}\\!\\left(\\frac{\\zeta_{0}^{2}}{\\zeta_{\\min}^{2}} - 1\\right).\n$$\n当 $\\omega_{0} = 10$，$\\zeta_{0} = 0.3$ 和 $\\zeta_{\\min} = 0.25$ 时，\n$$\nk_{r}^{\\max} \\;=\\; 10^{2}\\!\\left(\\frac{0.3^{2}}{0.25^{2}} - 1\\right) \\;=\\; 100\\,(1.44 - 1) \\;=\\; 44,\n$$\n而设计得到的 $k_{r} \\approx 34.6410161513775$ 满足该约束。\n\n共振峰值计算。写出\n$$\n\\omega_{c}^{2} \\;=\\; \\omega_{0}^{2} + k_{r},\n\\qquad\n2\\,\\zeta_{c}\\,\\omega_{c} \\;=\\; 2\\,\\zeta_{0}\\,\\omega_{0},\n\\qquad\n\\zeta_{c} \\;=\\; \\frac{\\zeta_{0}\\,\\omega_{0}}{\\omega_{c}}.\n$$\n$T(j\\,\\omega)$ 的幅值为\n$$\n\\bigl|T(j\\,\\omega)\\bigr| \\;=\\; \\frac{k_{r}}{\\sqrt{\\bigl(\\omega_{c}^{2} - \\omega^{2}\\bigr)^{2} + \\bigl(2\\,\\zeta_{c}\\,\\omega_{c}\\,\\omega\\bigr)^{2}}}.\n$$\n为求共振点，对分母的平方 $h(\\omega) = (\\omega_{c}^{2} - \\omega^{2})^{2} + (2\\,\\zeta_{c}\\,\\omega_{c}\\,\\omega)^{2}$ 求导，并令 $\\mathrm{d}h/\\mathrm{d}\\omega = 0$，得到\n$$\n\\omega_{p}^{2} \\;=\\; \\omega_{c}^{2}\\,\\bigl(1 - 2\\,\\zeta_{c}^{2}\\bigr),\n\\quad \\text{前提是} \\quad \\zeta_{c} < \\frac{1}{\\sqrt{2}},\n$$\n此处该条件成立，因为 $\\zeta_{c} \\le \\zeta_{0} = 0.3$。将 $\\omega = \\omega_{p}$ 代入 $\\bigl|T(j\\,\\omega)\\bigr|$ 并化简，可得\n$$\n\\max_{\\omega \\ge 0} \\bigl|T(j\\,\\omega)\\bigr|\n\\;=\\;\n\\frac{k_{r}}{2\\,\\omega_{c}^{2}\\,\\zeta_{c}\\,\\sqrt{1 - \\zeta_{c}^{2}}}.\n$$\n使用设计出的 $k_{r}$ 值，\n$$\n\\omega_{c}^{2} \\;=\\; \\omega_{0}^{2} + k_{r} \\;\\approx\\; 100 + 34.6410161513775 \\;=\\; 134.6410161513775,\n$$\n$$\n\\zeta_{c} \\;=\\; \\frac{\\zeta_{0}\\,\\omega_{0}}{\\sqrt{\\omega_{c}^{2}}}\n\\;\\approx\\; \\frac{3}{\\sqrt{134.6410161513775}}\n\\;\\approx\\; 0.258544,\n$$\n$$\n\\sqrt{1 - \\zeta_{c}^{2}} \\;\\approx\\; \\sqrt{1 - 0.0668444} \\;\\approx\\; 0.966000.\n$$\n因此，\n$$\n\\max_{\\omega \\ge 0} \\bigl|T(j\\,\\omega)\\bigr|\n\\;\\approx\\;\n\\frac{34.6410161513775}{2 \\cdot 134.6410161513775 \\cdot 0.258544 \\cdot 0.966000}\n\\;\\approx\\; 0.5151,\n$$\n四舍五入至四位有效数字。这便是所求的无量纲共振峰值。", "answer": "$$\\boxed{0.5151}$$", "id": "2740155"}, {"introduction": "现代控制系统绝大多数在数字平台实现，但从连续时间域到离散时间域的转换并非总是直接了当。本练习探讨了数字控制器设计中的一个关键问题：由双线性变换引起的频率畸变（frequency warping）。您将通过推导“预畸变”（pre-warping）校正公式，来解决如何精确地使用数字陷波滤波器抑制一个在连续时间域中存在的物理共振，这对于确保数字控制算法在实际中有效至关重要。[@problem_id:2740191]", "problem": "一个连续时间单输入单输出系统在角频率 $\\,\\omega_{r}\\,$（单位：弧度/秒）处有一个轻阻尼共振。您需要设计一个数字陷波滤波器来抑制此共振，方法是首先指定一个中心频率为 $\\,\\omega_{n}\\,$ 的连续时间二阶陷波器，然后使用采样周期为 $\\,T\\,$ 的双线性变换（BLT）将其离散化。假设 $\\,0<\\omega_{r}T<\\pi\\,$，从而采样不会导致共振发生混叠，并且阻尼足够小，陷波中心频率决定了抑制效果。\n\n请仅使用以下基本定义来指导您的推导：\n\n- 连续时间频率响应评估：代入 $\\,s=j\\omega\\,$。\n- 离散时间频率响应评估：代入 $\\,z=\\exp(j\\Omega)\\,$，其中 $\\,\\Omega\\,$ 是离散时间弧度频率（单位：弧度/采样点）。\n- 双线性变换（BLT）映射：$\\,s=\\dfrac{2}{T}\\dfrac{z-1}{z+1}\\,$。\n\n任务：\n1. 从这些定义出发，推导由双线性变换产生的连续时间频率变量 $\\,\\omega\\,$ 与离散时间频率变量 $\\,\\Omega\\,$ 之间的映射关系。\n2. 在不引用任何额外公式的情况下，利用此映射关系解释：为什么将连续时间陷波中心频率直接设置为 $\\,\\omega_{n}=\\omega_{r}\\,$ 然后进行离散化，所产生的数字陷波中心频率与离散频率 $\\,\\Omega_{r}=\\omega_{r}T\\,$ 处的采样共振频率不重合。\n3. 推导一个预畸变规则，该规则选择一个作为 $\\,\\omega_{r}\\,$ 和 $\\,T\\,$ 函数的连续时间陷波中心频率 $\\,\\omega_{n}^{\\star}\\,$，使得经过双线性离散化后，数字陷波器的中心能够精确对准位于 $\\,\\Omega_{r}=\\omega_{r}T\\,$ 处的采样共振频率。\n\n答案要求：请提供 $\\,\\omega_{n}^{\\star}\\,$ 关于 $\\,\\omega_{r}\\,$ 和 $\\,T\\,$ 的单一封闭形式表达式。最终答案框中不要包含任何单位，也不要进行四舍五入；要求提供精确的解析表达式。", "solution": "问题陈述有效。它科学地基于数字控制理论的原理，问题提法得当且客观。其中不包含逻辑矛盾、信息缺失或伪科学主张。我将进行完整的推导。\n\n本问题要求一个关于通过双线性变换（BLT）设计数字陷波滤波器的三部分推导。问题的核心在于双线性变换引入的连续时间频率轴与离散时间频率轴之间的非线性关系，即“畸变”。我们将按顺序完成每个任务。\n\n首先，我们推导连续时间频率变量 $\\omega$ 与离散时间频率变量 $\\Omega$ 之间的映射关系。问题提供了必要的基本定义：连续时间频率响应通过代入 $s=j\\omega$ 求得，离散时间频率响应通过代入 $z=\\exp(j\\Omega)$ 求得，而双线性变换本身的映射为 $s=\\frac{2}{T}\\frac{z-1}{z+1}$。\n\n我们首先将 $s$ 和 $z$ 的频域表达式代入双线性变换方程：\n$$\nj\\omega = \\frac{2}{T} \\frac{\\exp(j\\Omega) - 1}{\\exp(j\\Omega) + 1}\n$$\n为简化右侧的表达式，我们从分子和分母中提出一个因子 $\\exp(j\\Omega/2)$：\n$$\nj\\omega = \\frac{2}{T} \\frac{\\exp(j\\Omega/2) \\left( \\exp(j\\Omega/2) - \\exp(-j\\Omega/2) \\right)}{\\exp(j\\Omega/2) \\left( \\exp(j\\Omega/2) + \\exp(-j\\Omega/2) \\right)}\n$$\n因子 $\\exp(j\\Omega/2)$ 可以消去。现在我们使用正弦和余弦函数的欧拉公式：\n$$\n\\sin(x) = \\frac{\\exp(jx) - \\exp(-jx)}{2j} \\implies 2j\\sin(x) = \\exp(jx) - \\exp(-jx)\n$$\n$$\n\\cos(x) = \\frac{\\exp(jx) + \\exp(-jx)}{2} \\implies 2\\cos(x) = \\exp(jx) + \\exp(-jx)\n$$\n将这些恒等式（其中 $x = \\Omega/2$）代入我们的方程，得到：\n$$\nj\\omega = \\frac{2}{T} \\frac{2j\\sin(\\Omega/2)}{2\\cos(\\Omega/2)}\n$$\n化简得：\n$$\nj\\omega = \\frac{2}{T} j\\tan(\\frac{\\Omega}{2})\n$$\n两边同除以虚数单位 $j$，我们便得到连续频率 $\\omega$ 和离散频率 $\\Omega$ 之间的解析映射关系：\n$$\n\\omega = \\frac{2}{T} \\tan\\left(\\frac{\\Omega}{2}\\right)\n$$\n这种关系是非线性的，也是频率畸变现象的根源。\n\n其次，我们利用此映射关系来解释为什么将连续时间陷波中心频率 $\\omega_n$ 设置为系统共振频率 $\\omega_r$ 的简单直接方法无法将数字陷波器置于正确的位置。陷波器的目标离散频率是采样后的共振频率，即 $\\Omega_r = \\omega_r T$。简单直接的方法假设，通过设置 $\\omega_n = \\omega_r$，所得到的离散陷波中心频率（我们称之为 $\\Omega_n$）将等于 $\\Omega_r$。\n\n我们来检验这个假设。我们使用推导出的频率映射关系，并代入连续时间陷波中心频率 $\\omega_n$ 和其产生的离散时间陷波中心频率 $\\Omega_n$：\n$$\n\\omega_n = \\frac{2}{T} \\tan\\left(\\frac{\\Omega_n}{2}\\right)\n$$\n应用简单直接的选择 $\\omega_n = \\omega_r$，我们有：\n$$\n\\omega_r = \\frac{2}{T} \\tan\\left(\\frac{\\Omega_n}{2}\\right)\n$$\n现在我们求解由此产生的离散频率 $\\Omega_n$：\n$$\n\\frac{\\omega_r T}{2} = \\tan\\left(\\frac{\\Omega_n}{2}\\right)\n$$\n$$\n\\Omega_n = 2 \\arctan\\left(\\frac{\\omega_r T}{2}\\right)\n$$\n预期的目标频率是 $\\Omega_r = \\omega_r T$。问题在于 $\\Omega_n$ 是否等于 $\\Omega_r$。我们必须比较 $2 \\arctan(x)$ 和 $2x$，其中 $x = \\frac{\\omega_r T}{2}$。反正切函数的一个基本性质是，对于任何正参数 $x>0$，不等式 $\\arctan(x) < x$ 恒成立。问题陈述中指定 $0 < \\omega_r T < \\pi$，这确保了 $x = \\frac{\\omega_r T}{2}$ 为正。\n因此：\n$$\n\\arctan\\left(\\frac{\\omega_r T}{2}\\right) < \\frac{\\omega_r T}{2}\n$$\n两边乘以 2：\n$$\n2 \\arctan\\left(\\frac{\\omega_r T}{2}\\right) < \\omega_r T\n$$\n这意味着 $\\Omega_n < \\Omega_r$。这种简单直接的设计将数字陷波器置于一个严格低于目标共振频率的频率上。发生这种情况是因为非线性畸变在将连续频率映射到离散频率范围时，对较高频率的压缩程度大于较低频率。简单的线性缩放是错误的。\n\n第三，我们推导预畸变规则。目标是选择一个特定的连续时间陷波中心，我们称之为 $\\omega_n^{\\star}$，使得通过双线性变换离散化后，产生的数字陷波器能精确地以目标频率 $\\Omega_r = \\omega_r T$ 为中心。\n\n我们使用我们的频率映射方程，这次在等式左边使用预畸变的连续频率 $\\omega_n^{\\star}$，在右边使用期望的目标离散频率 $\\Omega_r$。根据设计要求，该方程必须成立：\n$$\n\\omega_n^{\\star} = \\frac{2}{T} \\tan\\left(\\frac{\\Omega_r}{2}\\right)\n$$\n我们现在代入目标频率的定义，即 $\\Omega_r = \\omega_r T$：\n$$\n\\omega_n^{\\star} = \\frac{2}{T} \\tan\\left(\\frac{\\omega_r T}{2}\\right)\n$$\n此表达式给出了在模拟原型滤波器中需要使用的连续时间中心频率 $\\omega_n^{\\star}$。当一个中心频率为 $\\omega_n^{\\star}$ 的连续时间陷波滤波器使用采样周期为 $T$ 的双线性变换进行离散化时，所得到的数字陷波滤波器的中心将精确定位在期望的离散频率 $\\Omega_r = \\omega_r T$ 处，从而正确地抑制系统共振。这个过程被称为频率预畸变。", "answer": "$$\n\\boxed{\\frac{2}{T} \\tan\\left(\\frac{\\omega_{r} T}{2}\\right)}\n$$", "id": "2740191"}]}