{"hands_on_practices": [{"introduction": "本练习将巩固您从系统传递函数直接推导稳定裕度的能力。通过完成符号推导与优化过程，您将更深刻地体会到系统参数、增益与相位裕度之间的内在联系。这个从第一性原理出发的练习，是掌握频率域分析核心技能的关键一步 [@problem_id:2690850]。", "problem": "考虑开环传递函数\n$$\nL(s)=\\frac{K\\left(1+\\frac{s}{z}\\right)}{s\\left(1+\\frac{s}{p}\\right)},\n$$\n其中 $K>0$ 是一个标量增益，$z>0, p>0$ 是实数常数，且 $z\\neq p$。波特图由频率响应 $L(j\\omega)$ 定义，其中幅值为 $|L(j\\omega)|$，相角为 $\\angle L(j\\omega)$。增益交越频率 $\\omega_{c}$ 由方程 $|L(j\\omega_{c})|=1$ 的解定义。相位裕度 $\\phi_{m}$ 定义为 $\\phi_{m}=\\pi+\\angle L(j\\omega_{c})$（相角单位为弧度），而增益裕度 $\\gamma_{m}$ 是在相位交越频率 $\\omega_{p}$ 处幅值的倒数，其中 $\\angle L(j\\omega_{p})=-\\pi$（如果存在这样的 $\\omega_{p}$）。所有相角必须以弧度表示。\n\n任务：\n- 仅使用上述基本定义，推导 $|L(j\\omega)|$ 和 $\\angle L(j\\omega)$ 作为 $\\omega$, $K$, $z$, 和 $p$ 的函数。\n- 用 $K$, $z$, $p$ 以及由 $|L(j\\omega_{c})|=1$ 定义的增益交越频率 $\\omega_{c}$ 来表示相位裕度 $\\phi_{m}$ 和增益裕度 $\\gamma_{m}$。清楚说明是否存在有限的相位交越频率。\n- 通过求解 $|L(j\\omega_{c})|=1$ 得到 $K=K(\\omega_{c})$，施加增益交越频率位于设计者指定的 $\\omega_{c}>0$ 处的约束。然后，从 $\\phi_{m}$ 中消去 $K$，并对 $\\omega_{c}>0$ 最大化 $\\phi_{m}$。最后，仅报告在增益交越约束下实现最大相位裕度的最优增益 $K$ 的精确符号表达式（用 $z$ 和 $p$ 表示）。\n\n你的最终答案必须是单个解析表达式。最终答案中不要包含单位。相关角度均以弧度为单位。", "solution": "所述问题是良态的，具有科学依据，并包含了进行严谨求解所需的所有信息。我们将按要求直接进行推导。\n\n开环传递函数由下式给出\n$$\nL(s)=\\frac{K\\left(1+\\frac{s}{z}\\right)}{s\\left(1+\\frac{s}{p}\\right)}\n$$\n，其中 $K>0$, $z>0$ 且 $p>0$，并且 $z \\neq p$。\n\n为求频率响应，我们代入 $s=j\\omega$，其中 $j=\\sqrt{-1}$，$\\omega$ 是角频率。\n$$\nL(j\\omega) = \\frac{K\\left(1+j\\frac{\\omega}{z}\\right)}{j\\omega\\left(1+j\\frac{\\omega}{p}\\right)}\n$$\n\n第一个任务是推导幅值 $|L(j\\omega)|$ 和相角 $\\angle L(j\\omega)$。\n复数乘积和商的幅值等于它们各自幅值的乘积和商。\n$$\n|L(j\\omega)| = \\frac{|K| \\cdot \\left|1+j\\frac{\\omega}{z}\\right|}{|j\\omega| \\cdot \\left|1+j\\frac{\\omega}{p}\\right|}\n$$\n由于 $K>0$，所以 $|K|=K$。对于 $\\omega>0$，有 $|j\\omega|=\\omega$。复数项的幅值计算为 $\\sqrt{a^2+b^2}$。\n$$\n|L(j\\omega)| = \\frac{K \\sqrt{1^2 + \\left(\\frac{\\omega}{z}\\right)^2}}{\\omega \\sqrt{1^2 + \\left(\\frac{\\omega}{p}\\right)^2}} = \\frac{K\\sqrt{1+\\frac{\\omega^2}{z^2}}}{\\omega\\sqrt{1+\\frac{\\omega^2}{p^2}}}\n$$\n相角是各个项相角的和与差。\n$$\n\\angle L(j\\omega) = \\angle K + \\angle\\left(1+j\\frac{\\omega}{z}\\right) - \\angle(j\\omega) - \\angle\\left(1+j\\frac{\\omega}{p}\\right)\n$$\n由于 $K$ 是正实数，$\\angle K = 0$。对于 $\\omega>0$，$j\\omega$ 的相角是 $\\frac{\\pi}{2}$。复数 $a+jb$ 的相角是 $\\arctan(b/a)$。\n$$\n\\angle L(j\\omega) = 0 + \\arctan\\left(\\frac{\\omega}{z}\\right) - \\frac{\\pi}{2} - \\arctan\\left(\\frac{\\omega}{p}\\right)\n$$\n\n第二个任务是表示相位裕度 $\\phi_{m}$ 和增益裕度 $\\gamma_{m}$。\n相位裕度定义为 $\\phi_{m} = \\pi + \\angle L(j\\omega_c)$，其中 $\\omega_c$ 是增益交越频率。\n代入在 $\\omega_c$ 处的相角表达式：\n$$\n\\phi_{m} = \\pi + \\left(\\arctan\\left(\\frac{\\omega_c}{z}\\right) - \\frac{\\pi}{2} - \\arctan\\left(\\frac{\\omega_c}{p}\\right)\\right) = \\frac{\\pi}{2} + \\arctan\\left(\\frac{\\omega_c}{z}\\right) - \\arctan\\left(\\frac{\\omega_c}{p}\\right)\n$$\n增益裕度 $\\gamma_{m}$ 需要找到相位交越频率 $\\omega_{p}$，在该频率下 $\\angle L(j\\omega_{p}) = -\\pi$。\n$$\n\\arctan\\left(\\frac{\\omega_p}{z}\\right) - \\frac{\\pi}{2} - \\arctan\\left(\\frac{\\omega_p}{p}\\right) = -\\pi\n$$\n$$\n\\arctan\\left(\\frac{\\omega_p}{z}\\right) - \\arctan\\left(\\frac{\\omega_p}{p}\\right) = -\\frac{\\pi}{2}\n$$\n使用恒等式 $\\arctan(a)-\\arctan(b) = \\arctan\\left(\\frac{a-b}{1+ab}\\right)$，我们得到：\n$$\n\\arctan\\left(\\frac{\\frac{\\omega_p}{z} - \\frac{\\omega_p}{p}}{1+\\frac{\\omega_p^2}{zp}}\\right) = \\arctan\\left(\\frac{\\omega_p(p-z)}{zp+\\omega_p^2}\\right) = -\\frac{\\pi}{2}\n$$\n反正切函数仅在其参数趋于 $-\\infty$ 时才趋于 $-\\frac{\\pi}{2}$。对于任何有限的正数 $\\omega_p$, $z$ 和 $p$，分母 $zp+\\omega_p^2$ 严格为正。分子 $\\omega_p(p-z)$ 是有限的。因此，反正切函数的参数总是有限的。这意味着不存在有限的正频率 $\\omega_p$ 使得相角等于 $-\\pi$。因此，系统没有有限的相位交越频率，增益裕度 $\\gamma_m$ 是无穷大。\n\n第三个任务是找到使相位裕度 $\\phi_{m}$ 最大化的最优增益 $K$。增益 $K$ 允许我们将增益交越频率 $\\omega_c$ 设置为任何期望值。我们必须首先找到使 $\\phi_m$ 最大化的最优 $\\omega_c$，然后找到相应的 $K$。\n相位裕度是 $\\omega_c$ 的函数：\n$$\n\\phi_{m}(\\omega_c) = \\frac{\\pi}{2} + \\arctan\\left(\\frac{\\omega_c}{z}\\right) - \\arctan\\left(\\frac{\\omega_c}{p}\\right)\n$$\n为求极值，我们将 $\\phi_{m}$ 对 $\\omega_c$ 求导，并令导数等于零。\n$$\n\\frac{d\\phi_{m}}{d\\omega_c} = \\frac{d}{d\\omega_c}\\left(\\arctan\\left(\\frac{\\omega_c}{z}\\right) - \\arctan\\left(\\frac{\\omega_c}{p}\\right)\\right) = 0\n$$\n$$\n\\frac{1/z}{1+(\\omega_c/z)^2} - \\frac{1/p}{1+(\\omega_c/p)^2} = 0\n$$\n$$\n\\frac{z}{z^2+\\omega_c^2} = \\frac{p}{p^2+\\omega_c^2}\n$$\n$$\nz(p^2+\\omega_c^2) = p(z^2+\\omega_c^2)\n$$\n$$\nzp^2+z\\omega_c^2 = pz^2+p\\omega_c^2\n$$\n$$\nzp^2-pz^2 = p\\omega_c^2 - z\\omega_c^2\n$$\n$$\nzp(p-z) = \\omega_c^2(p-z)\n$$\n由于 $z \\neq p$，我们可以除以 $(p-z)$：\n$$\n\\omega_c^2 = zp \\implies \\omega_c = \\sqrt{zp}\n$$\n这给出了极值相位裕度对应的交越频率 $\\omega_c^*$。二阶导数分析表明，如果 $p>z$，这是一个最大值；如果 $z>p$，则是一个最小值。问题要求最大化，所以我们在 $p>z$ 的条件下进行，这对应于一个超前补偿器的作用。\n最后一步是找到将增益交越点置于该最优频率 $\\omega_c^*=\\sqrt{zp}$ 的 $K$ 值。我们使用条件 $|L(j\\omega_c^*)|=1$。\n$$\n\\frac{K \\sqrt{1+\\frac{(\\omega_c^*)^2}{z^2}}}{\\omega_c^* \\sqrt{1+\\frac{(\\omega_c^*)^2}{p^2}}} = 1\n$$\n求解 $K$：\n$$\nK = \\frac{\\omega_c^* \\sqrt{1+\\frac{(\\omega_c^*)^2}{p^2}}}{\\sqrt{1+\\frac{(\\omega_c^*)^2}{z^2}}}\n$$\n代入 $\\omega_c^* = \\sqrt{zp}$：\n$$\nK_{opt} = \\frac{\\sqrt{zp} \\sqrt{1+\\frac{zp}{p^2}}}{\\sqrt{1+\\frac{zp}{z^2}}} = \\frac{\\sqrt{zp} \\sqrt{1+\\frac{z}{p}}}{\\sqrt{1+\\frac{p}{z}}}\n$$\n$$\nK_{opt} = \\sqrt{zp} \\frac{\\sqrt{\\frac{p+z}{p}}}{\\sqrt{\\frac{z+p}{z}}} = \\sqrt{zp} \\sqrt{\\frac{p+z}{p} \\cdot \\frac{z}{z+p}} = \\sqrt{zp} \\sqrt{\\frac{z}{p}}\n$$\n$$\nK_{opt} = \\sqrt{z}\\sqrt{p} \\frac{\\sqrt{z}}{\\sqrt{p}} = (\\sqrt{z})^2 = z\n$$\n因此，实现最大相位裕度的最优增益是 $K=z$。", "answer": "$$\\boxed{z}$$", "id": "2690850"}, {"introduction": "并非所有系统都具有同样良好的特性。本练习将探讨非最小相位系统的行为，特别是右半平面 (Right-Half-Plane, RHP) 零点对稳定性的影响。通过将系统与其最小相位对应物进行比较，您将亲眼见证 RHP 零点为何会带来基本的性能限制，这对于设计鲁棒的控制系统至关重要 [@problem_id:2690779]。", "problem": "考虑单输入单输出开环传递函数\n$$\nL(s) \\;=\\; K\\,G(s), \\qquad G(s) \\;=\\; \\frac{1 - s/z}{1 + s/p},\n$$\n其中 $z>0$，$p>0$ 且实数增益 $K>0$。分子零点位于右半平面 (RHP)，在 $s=z$ 处；极点位于左半平面 (LHP)，在 $s=-p$ 处。仅使用频率响应的正弦稳态定义、复数的模与幅角以及基本的代数变换。\n\n任务：\n- 从频率响应 $G(\\mathrm{j}\\omega)$ 的定义出发，导出增益交越频率 $\\omega_{gc}$ 的精确解析表达式，该频率由条件 $|L(\\mathrm{j}\\omega_{gc})|=1$ 定义，表达式应以 $K$、$z$ 和 $p$ 表示。清晰地陈述存在正实数解 $\\omega_{gc}$ 的条件。\n- 将您的解析表达式应用于参数值 $K=0.5$，$z=2$ rad/s 和 $p=10$ rad/s 的情况，并数值计算 $\\omega_{gc}$。\n- 使用 $G(\\mathrm{j}\\omega)$ 的精确相位，确定给定 RHP 零点时的开环相位 $\\angle L(\\mathrm{j}\\omega_{gc})$，并将其与一个假设的最小相位对应系统的相位进行比较，该最小相位系统的分子被替换为 $1 + s/z$，同时保持相同的 $K$、$z$ 和 $p$。从基本原理出发，解释 RHP 零点相对于最小相位对应系统是如何改变 $\\omega_{gc}$ 处的相位裕度的。所有角度均以度表示。\n\n答案规格：\n- 仅报告在 $K=0.5$，$z=2$ rad/s，$p=10$ rad/s 条件下，增益交越频率 $\\omega_{gc}$ 的数值。\n- 以 rad/s 为单位表示 $\\omega_{gc}$。\n- 将您的答案四舍五入到 $4$ 位有效数字。", "solution": "所给问题定义明确，科学上合理，且内容完整。这是线性控制理论中的一个标准问题，适合进行分析。我们将进行推导和求解。\n\n开环传递函数由下式给出\n$$\nL(s) = K \\frac{1 - s/z}{1 + s/p}\n$$\n其中 $K > 0$，$z > 0$ 且 $p > 0$。位于 $s = z$ 的零点在右半平面 (RHP)，这使其成为一个非最小相位系统。\n\n首先，我们推导增益交越频率 $\\omega_{gc}$ 的表达式。根据定义，这是频率响应的幅值为 1 时的频率 $\\omega > 0$。通过代入 $s = \\mathrm{j}\\omega$ 得到频率响应：\n$$\nL(\\mathrm{j}\\omega) = K \\frac{1 - \\mathrm{j}\\omega/z}{1 + \\mathrm{j}\\omega/p}\n$$\n其幅值由该复变函数的模给出：\n$$\n|L(\\mathrm{j}\\omega)| = |K| \\frac{|1 - \\mathrm{j}\\omega/z|}{|1 + \\mathrm{j}\\omega/p|}\n$$\n由于 $K$ 是一个正实数增益，所以 $|K|=K$。分子的模为 $|1 - \\mathrm{j}\\omega/z| = \\sqrt{1^2 + (-\\omega/z)^2} = \\sqrt{1 + (\\omega/z)^2}$。分母的模为 $|1 + \\mathrm{j}\\omega/p| = \\sqrt{1^2 + (\\omega/p)^2} = \\sqrt{1 + (\\omega/p)^2}$。因此，幅值为：\n$$\n|L(\\mathrm{j}\\omega)| = K \\sqrt{\\frac{1 + \\omega^2/z^2}{1 + \\omega^2/p^2}}\n$$\n增益交越条件为 $|L(\\mathrm{j}\\omega_{gc})|=1$。\n$$\n1 = K \\sqrt{\\frac{1 + \\omega_{gc}^2/z^2}{1 + \\omega_{gc}^2/p^2}}\n$$\n为求解 $\\omega_{gc}$，我们将方程两边平方并重新整理：\n$$\n\\frac{1}{K^2} = \\frac{1 + \\omega_{gc}^2/z^2}{1 + \\omega_{gc}^2/p^2}\n$$\n$$\n1 + \\frac{\\omega_{gc}^2}{p^2} = K^2 \\left(1 + \\frac{\\omega_{gc}^2}{z^2}\\right) = K^2 + \\frac{K^2 \\omega_{gc}^2}{z^2}\n$$\n我们合并包含 $\\omega_{gc}^2$ 的项：\n$$\n\\omega_{gc}^2 \\left(\\frac{1}{p^2} - \\frac{K^2}{z^2}\\right) = K^2 - 1\n$$\n$$\n\\omega_{gc}^2 \\left(\\frac{z^2 - K^2 p^2}{p^2 z^2}\\right) = K^2 - 1\n$$\n求解 $\\omega_{gc}^2$ 得：\n$$\n\\omega_{gc}^2 = \\frac{p^2 z^2 (K^2 - 1)}{z^2 - K^2 p^2}\n$$\n为了存在正实数解 $\\omega_{gc}$，$\\omega_{gc}^2$ 的表达式必须为正。由于 $p^2 z^2$ 恒为正，该条件等价于：\n$$\n\\frac{K^2 - 1}{z^2 - K^2 p^2} > 0\n$$\n该不等式成立的充要条件是分子和分母同号。\n情况1: $K^2 - 1 > 0$ 且 $z^2 - K^2 p^2 > 0$。这意味着 $K > 1$ 且 $z > Kp$，或 $K < z/p$。\n情况2: $K^2 - 1 < 0$ 且 $z^2 - K^2 p^2 < 0$。这意味着 $0 < K < 1$ 且 $z < Kp$，或 $K > z/p$。\n这两个条件可以通过观察直流增益 $|L(0)| = K$ 和高频增益 $\\lim_{\\omega \\to \\infty} |L(\\mathrm{j}\\omega)| = K(p/z)$ 进行总结。唯一交越频率存在的充要条件是，幅值图穿过单位 1，这意味着单位增益必须位于直流增益和高频增益之间。即 $(|L(0)|-1)(|L(\\mathrm{j}\\infty)|-1) < 0$，或 $(K-1)(Kp/z - 1) < 0$。这与上面推导的两种情况完全等价。\n\n现在，我们将表达式应用于给定的参数值：$K=0.5$，$z=2 \\text{ rad/s}$，$p=10 \\text{ rad/s}$。\n我们检查解存在的条件。这里，$K=0.5 < 1$。我们必须处于情况 2，该情况要求 $K > z/p$。\n$z/p = 2/10 = 0.2$。条件是 $0.5 > 0.2$，成立。因此，$\\omega_{gc}$ 存在唯一的正实数解。\n我们将这些值代入推导出的 $\\omega_{gc}^2$ 表达式中：\n$$\n\\omega_{gc}^2 = \\frac{10^2 \\cdot 2^2 \\cdot (0.5^2 - 1)}{2^2 - 0.5^2 \\cdot 10^2} = \\frac{100 \\cdot 4 \\cdot (0.25 - 1)}{4 - 0.25 \\cdot 100} = \\frac{400(-0.75)}{4 - 25} = \\frac{-300}{-21} = \\frac{100}{7}\n$$\n增益交越频率为：\n$$\n\\omega_{gc} = \\sqrt{\\frac{100}{7}} = \\frac{10}{\\sqrt{7}} \\approx 3.7796447... \\text{ rad/s}\n$$\n四舍五入到 4 位有效数字，我们得到 $\\omega_{gc} \\approx 3.780$ rad/s。\n\n接下来，我们分析相位。开环系统的相位为：\n$$\n\\angle L(\\mathrm{j}\\omega) = \\angle(1 - \\mathrm{j}\\omega/z) - \\angle(1 + \\mathrm{j}\\omega/p) = -\\arctan(\\omega/z) - \\arctan(\\omega/p)\n$$\n在 $\\omega_{gc} = 10/\\sqrt{7}$ 处，相位为：\n$$\n\\angle L(\\mathrm{j}\\omega_{gc}) = -\\arctan\\left(\\frac{10/\\sqrt{7}}{2}\\right) - \\arctan\\left(\\frac{10/\\sqrt{7}}{10}\\right) = -\\arctan\\left(\\frac{5}{\\sqrt{7}}\\right) - \\arctan\\left(\\frac{1}{\\sqrt{7}}\\right)\n$$\n数值上，$\\arctan(5/\\sqrt{7}) \\approx 62.10^\\circ$ 且 $\\arctan(1/\\sqrt{7}) \\approx 20.70^\\circ$。\n所以，$\\angle L(\\mathrm{j}\\omega_{gc}) \\approx -62.10^\\circ - 20.70^\\circ = -82.80^\\circ$。\n\n假设的最小相位 (MP) 对应系统的传递函数为 $L_{MP}(s) = K \\frac{1 + s/z}{1 + s/p}$。其幅值为 $|L_{MP}(\\mathrm{j}\\omega)| = K \\sqrt{\\frac{1 + (\\omega/z)^2}{1 + (\\omega/p)^2}}$，与 $|L(\\mathrm{j}\\omega)|$ 完全相同。因此，其增益交越频率也是 $\\omega_{gc} = 10/\\sqrt{7}$ rad/s。\n然而，最小相位系统的相位不同：\n$$\n\\angle L_{MP}(\\mathrm{j}\\omega) = \\angle(1 + \\mathrm{j}\\omega/z) - \\angle(1 + \\mathrm{j}\\omega/p) = \\arctan(\\omega/z) - \\arctan(\\omega/p)\n$$\n在 $\\omega_{gc}$ 处，最小相位系统的相位为：\n$$\n\\angle L_{MP}(\\mathrm{j}\\omega_{gc}) = \\arctan\\left(\\frac{5}{\\sqrt{7}}\\right) - \\arctan\\left(\\frac{1}{\\sqrt{7}}\\right) \\approx 62.10^\\circ - 20.70^\\circ = 41.40^\\circ\n$$\n\n现在，RHP 零点的影响就很清楚了。对于任意频率 $\\omega$，零点项（无论是 $1-s/z$ 还是 $1+s/z$）的幅值贡献是相同的：$|\\sqrt{1+(\\omega/z)^2}|$。这就是为什么 $\\omega_{gc}$ 不变的原因。\n但相位的贡献则有根本性的不同。一个最小相位零点 $1+s/z$ 贡献一个正相位（相位超前）$\\arctan(\\omega/z)$，其值从 $0$ 增加到 $90^\\circ$。一个非最小相位零点 $1-s/z$ 贡献一个负相位（相位滞后）$-\\arctan(\\omega/z)$，其值从 $0$ 减小到 $-90^\\circ$。\n在增益交越频率 $\\omega_{gc}$ 处，RHP 零点贡献了一个 $-\\arctan(\\omega_{gc}/z)$ 的相位滞后，而其最小相位对应系统则会贡献一个 $\\arctan(\\omega_{gc}/z)$ 的相位超前。因此，RHP 系统和 MP 系统之间的相位差为 $-2\\arctan(\\omega_{gc}/z)$。对于给定的参数，这个额外的相位滞后是 $-2 \\times 62.10^\\circ = -124.2^\\circ$。\n相位裕度 $PM = 180^\\circ + \\angle L(\\mathrm{j}\\omega_{gc})$ 受到直接影响。\n对于 RHP 系统，$PM_{RHP} = 180^\\circ - 82.80^\\circ = 97.2^\\circ$。\n对于 MP 系统，$PM_{MP} = 180^\\circ + 41.40^\\circ = 221.4^\\circ$。\n与最小相位对应系统相比，RHP 零点使相位裕度减小了 $2\\arctan(\\omega_{gc}/z) = 124.2^\\circ$。这证明了 RHP 零点的性能限制特性：它们在增加增益的同时增加了相位滞后，这种组合会降低稳定裕度。\n题目只要求 $\\omega_{gc}$ 的数值。", "answer": "$$\n\\boxed{3.780}\n$$", "id": "2690779"}, {"introduction": "现在，让我们将理论付诸实践。本练习模拟了一个真实的控制设计场景，您必须使用计算工具来验证一个控制器是否能稳定一个不稳定对象，同时满足多项性能和鲁棒性指标。这项实践将理论分析与计算机辅助控制工程实践联系起来，是成为一名合格控制工程师的必经之路 [@problem_id:2690827]。", "problem": "给定一个开环对象，其包含一个右半平面（RHP）极点。该对象的传递函数为\n$$\nP(s) \\;=\\; \\frac{s + 1}{(s - 1)(s + 3)} \\, ,\n$$\n它在 $s = +1$ 处有一个不稳定极点。您将通过将 $P(s)$ 与一个形式如下的控制器 $C(s)$ 相乘来构成环路传递函数 $L(s)$\n$$\nC(s) \\;=\\; k \\cdot \\frac{s/z + 1}{s/p + 1} \\cdot \\frac{1}{s/\\omega_f + 1} \\;=\\; k \\cdot \\frac{s + z}{s + p} \\cdot \\frac{\\omega_f}{s + \\omega_f} \\, ,\n$$\n其中 $k \\in \\mathbb{R}$ 是一个标量增益，$z$、$p$、$\\omega_f$ 是正实数常量（所有频率单位均为 $\\mathrm{rad/s}$）。因此\n$$\nL(s) \\;=\\; C(s) P(s) \\, ,\\quad S(s) \\;=\\; \\frac{1}{1 + L(s)} \\, ,\\quad T(s) \\;=\\; \\frac{L(s)}{1 + L(s)} \\, .\n$$\n\n您的任务是为 $L(j\\omega)$ 构建伯德（Bode）幅频和相频数据，然后仅使用第一性原理和基于伯德图的鲁棒性度量的核心定义，计算并验证以下性能和鲁棒性指标：\n\n- 闭环内部稳定性：$1 + L(s)$ 的特征多项式的所有极点都必须具有严格为负的实部。\n- 灵敏度峰值：在对数间隔的频率网格上，$\\lvert S(j\\omega)\\rvert$ 的最大值不得超过 $2.0$。\n- 高频噪声衰减：在 $\\omega_{\\mathrm{na}} = 100$ $\\mathrm{rad/s}$ 处，$\\lvert T(j\\omega_{\\mathrm{na}})\\rvert$ 的值必须小于或等于 $0.5$。\n- 相位裕度（单位：度）：在最低的正单位增益穿越频率 $\\omega_{\\mathrm{gc}}$（其中 $\\lvert L(j\\omega_{\\mathrm{gc}})\\rvert = 1$）处，计算标准伯德相位裕度，其值为 $180 + \\angle L(j\\omega_{\\mathrm{gc}})$。相位裕度必须大于或等于 $35$ 度。角度必须以度为单位表示。\n- 增益裕度（单位：分贝）：在任何相位穿越频率（其中 $\\angle L(j\\omega) = -180^\\circ + 360^\\circ m$，m 为某个整数）处，计算增益裕度，其值为幅值的倒数，并以分贝表示为 $20 \\log_{10}(\\mathrm{GM})$。如果不存在这样的相位穿越点，则认为增益裕度为 $+\\infty$ 分贝。增益裕度必须大于或等于 $6$ 分贝，其中无穷大的增益裕度被认为是可接受的。\n\n使用的基本依据和定义：\n\n- 伯德幅频和相频由复频率响应 $L(j\\omega)$逐点定义。\n- 灵敏度和互补灵敏度逐点定义为 $S(j\\omega) = 1/(1 + L(j\\omega))$ 和 $T(j\\omega) = L(j\\omega)/(1 + L(j\\omega))$。\n- 单位增益穿越频率是任何满足 $\\lvert L(j\\omega_{\\mathrm{gc}})\\rvert = 1$ 的 $\\omega_{\\mathrm{gc}} > 0$；如果存在多个，则使用最低的那个频率。\n- 在 $\\omega_{\\mathrm{gc}}$ 处的相位裕度是 $180$ 度加上以度表示的 $L(j\\omega_{\\mathrm{gc}})$ 的相位。\n- 增益裕度是在相位为 $-180$ 度模 $360$ 度的任何频率 $\\omega$ 处计算的；它是该频率下幅值的倒数，以分贝表示。如果不存在这样的穿越点，则增益裕度为 $+\\infty$ 分贝。\n\n实现要求：\n\n- 使用一个在 $\\omega \\in [10^{-3}, 10^{3}]$ $\\mathrm{rad/s}$ 范围内，包含至少 $4096$ 个点的对数间隔频率网格来近似所有频域量。\n- 角度必须以度为单位进行计算和报告。频率单位为 $\\mathrm{rad/s}$。\n- 必须通过构建 $1 + L(s)$ 的闭环特征多项式并验证其所有根的实部都严格为负来检查稳定性。\n- 在定位穿越频率时，在合适的尺度上进行线性插值。\n\n测试套件：\n\n评估以下三组控制器参数集 $(k, z, p, \\omega_f)$：\n\n- 情况 A（理想路径）：$(k, z, p, \\omega_f) = (-20.0, 0.5, 5.0, 50.0)$。\n- 情况 B（接近边界）：$(k, z, p, \\omega_f) = (-8.0, 0.5, 5.0, 80.0)$。\n- 情况 C（边缘情况）：$(k, z, p, \\omega_f) = (50.0, 0.5, 5.0, 50.0)$。\n\n对于每种情况，您的程序必须输出一个布尔值，指示是否同时满足所有接受条件：\n- 闭环内部稳定性为真，\n- $\\max_{\\omega} \\lvert S(j\\omega)\\rvert \\le 2.0$,\n- $\\lvert T(j100)\\rvert \\le 0.5$,\n- 相位裕度 $\\ge 35$ 度且有定义，\n- 增益裕度 $\\ge 6$ 分贝（无穷大的增益裕度视为可接受）。\n\n最终输出格式：\n\n您的程序应生成单行输出，其中包含 A、B、C 三种情况的布尔结果，形式为方括号内以逗号分隔的列表（例如，“[True,False,True]”）。不得打印任何其他文本。所有角度单位必须是度，所有频率单位必须是 $\\mathrm{rad/s}$，但输出仅包含指定的布尔值。", "solution": "所呈现的问题是经典控制理论中一个明确定义的练习。它具有科学依据、客观，并包含进行严谨分析所需的所有必要信息。因此，该问题被认为是有效的。\n\n任务是根据五个性能和鲁棒性准则，针对给定的对象 $P(s)$ 评估三组控制器参数 $(k, z, p, \\omega_f)$。对象被指定为 $P(s) = \\frac{s + 1}{(s - 1)(s + 3)}$，在 $s = 1$ 处有一个不稳定极点。控制器具有 $C(s) = k \\cdot \\frac{s + z}{s + p} \\cdot \\frac{\\omega_f}{s + \\omega_f}$ 的形式。开环传递函数为 $L(s) = C(s)P(s)$。\n\n设计了一个系统化的程序来根据指定要求验证每个参数集。每个情况的最终判定为“真”当且仅当所有五个条件同时满足。\n\n步骤 1：闭环内部稳定性分析\n基本要求是闭环系统的稳定性。闭环系统的极点是特征方程 $1 + L(s) = 0$ 的根。这等同于求 $1 + L(s)$ 分子多项式的根。设该特征多项式为 $D_{CL}(s)$。\n$$\n1 + L(s) = 1 + k \\omega_f \\frac{(s+z)(s+1)}{(s+p)(s+\\omega_f)(s-1)(s+3)} = 0\n$$\n$$\nD_{CL}(s) = (s+p)(s+\\omega_f)(s-1)(s+3) + k \\omega_f (s+z)(s+1) = 0\n$$\n这是一个关于 $s$ 的四阶多项式，$D_{CL}(s) = c_4s^4 + c_3s^3 + c_2s^2 + c_1s + c_0$，其系数为：\n$$\n\\begin{align*}\nc_4 &= 1 \\\\\nc_3 &= p + \\omega_f + 2 \\\\\nc_2 &= 2p + 2\\omega_f + p\\omega_f + k\\omega_f - 3 \\\\\nc_1 &= 2p\\omega_f - 3p - 3\\omega_f + k\\omega_f(z+1) \\\\\nc_0 &= k\\omega_f z - 3p\\omega_f\n\\end{align*}\n$$\n对于每个参数集 $(k, z, p, \\omega_f)$，计算这些系数，并数值求解多项式的根。当且仅当所有根都具有严格为负的实部时，即对于 $D_{CL}(s)$ 的所有根 $\\lambda$，都有 $\\mathrm{Re}(\\lambda) < 0$，系统是内部稳定的。\n\n步骤 2：频率响应生成\n所有频域指标都源自复频率响应 $L(j\\omega)$。在区间 $[10^{-3}, 10^3]$ $\\mathrm{rad/s}$ 上生成一个包含 $4096$ 个点的对数间隔频率网格 $\\omega$。在该网格上的每个频率 $\\omega_i$ 处，计算复数值 $L(j\\omega_i)$。由此，获得幅值 $|L(j\\omega_i)|$ 和相位 $\\angle L(j\\omega_i)$。对相位进行数值解缠，以确保在 $\\pm 180^\\circ$ 边界上的连续性，这对于正确识别相位穿越点至关重要。\n\n步骤 3：性能指标验证\n检查以下性能指标：\n- 灵敏度峰值：灵敏度函数逐点计算为 $S(j\\omega) = 1/(1 + L(j\\omega))$。峰值灵敏度是其幅值在频率网格上的最大值，$M_S = \\max_{\\omega} |S(j\\omega)|$。条件是 $M_S \\le 2.0$。\n- 高频噪声衰减：互补灵敏度函数为 $T(j\\omega) = L(j\\omega)/(1 + L(j\\omega))$。在指定的噪声衰减频率 $\\omega_{\\mathrm{na}} = 100$ $\\mathrm{rad/s}$ 处评估其幅值。条件是 $|T(j100)| \\le 0.5$。\n\n步骤 4：鲁棒性裕度验证\n计算并检查标准的伯德裕度：\n- 相位裕度 (PM)：单位增益穿越频率 $\\omega_{\\mathrm{gc}}$ 是使得 $|L(j\\omega_{\\mathrm{gc}})| = 1$ 的最低频率。通过在网格上搜索幅值（以分贝计，$20\\log_{10}|L(j\\omega)|$）穿过 $0$ 的第一个区间 $[\\omega_i, \\omega_{i+1}]$ 来找到该频率。$\\omega_{\\mathrm{gc}}$ 的精确值通过对 $\\log_{10}(\\omega)$ 与分贝幅值进行线性插值得到。然后，通过对 $\\log_{10}(\\omega)$ 与解缠后的度数相位进行线性插值，找到该穿越频率处的相位 $\\angle L(j\\omega_{\\mathrm{gc}})$。相位裕度定义为 $PM = 180^\\circ + \\angle L(j\\omega_{\\mathrm{gc}})$。条件是 $PM \\ge 35^\\circ$。如果不存在单位增益穿越点，则 PM 未定义，条件不满足。\n- 增益裕度 (GM)：相位穿越频率 $\\omega_{\\mathrm{pc}}$ 是任何相位为 $\\angle L(j\\omega_{\\mathrm{pc}}) = -180^\\circ + m \\cdot 360^\\circ$（m 为任意整数）的频率。在网格上找到所有这样的穿越点。对于每个穿越点，通过对 $\\log_{10}(\\omega)$ 与相位进行线性插值来确定精确的 $\\omega_{\\mathrm{pc}}$。然后，通过在 $\\omega_{\\mathrm{pc}}$ 处对幅值（以分贝计）进行插值，找到幅值 $|L(j\\omega_{\\mathrm{pc}})|$。该穿越点的增益裕度（以分贝计）为 $GM_{dB} = -20\\log_{10}|L(j\\omega_{\\mathrm{pc}})|$。如果存在多个相位穿越点，系统的增益裕度是所有计算出的裕度中的最小值，因为这代表了最严格的稳定性界限。条件是这个最小 $GM \\ge 6$ $\\mathrm{dB}$。如果没有找到相位穿越点，则增益裕度被视为 $+\\infty$，这满足该条件。\n\n步骤 5：最终评估\n对于三个测试用例中的每一个，都如上所述评估所有五个标准——稳定性、灵敏度峰值、噪声衰减、相位裕度和增益裕度。如果所有五个条件都通过，则给定用例的最终结果为 `True`，否则为 `False`。整个过程在提供的程序中实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef analyze_case(k, z, p, omega_f):\n    \"\"\"\n    Analyzes a given controller configuration against a set of five criteria.\n\n    Args:\n        k (float): Controller gain.\n        z (float): Controller zero.\n        p (float): Controller pole.\n        omega_f (float): Controller filter pole frequency.\n\n    Returns:\n        bool: True if all criteria are met, False otherwise.\n    \"\"\"\n    # 1. Internal Stability Check\n    # Characteristic polynomial: D_CL(s) = 1 + L(s) = 0\n    # D_CL(s) = (s+p)(s+omega_f)(s-1)(s+3) + k*omega_f*(s+z)(s+1)\n    # D_CL(s) = c4*s^4 + c3*s^3 + c2*s^2 + c1*s + c0\n    c4 = 1.0\n    c3 = p + omega_f + 2.0\n    c2 = 2.0 * p + 2.0 * omega_f + p * omega_f + k * omega_f - 3.0\n    c1 = 2.0 * p * omega_f - 3.0 * p - 3.0 * omega_f + k * omega_f * (z + 1.0)\n    c0 = k * omega_f * z - 3.0 * p * omega_f\n    \n    coeffs = [c4, c3, c2, c1, c0]\n    roots = np.roots(coeffs)\n    is_stable = np.all(np.real(roots) < 0)\n\n    # If unstable, no need to check other criteria\n    if not is_stable:\n        return False\n\n    # 2. Frequency Response Generation\n    omega = np.logspace(-3, 3, 4096)\n    s = 1j * omega\n\n    # L(s) = C(s)P(s) = k * (s+z)/(s+p) * w_f/(s+w_f) * (s+1)/((s-1)(s+3))\n    P_s = (s + 1.0) / ((s - 1.0) * (s + 3.0))\n    C_s = k * (s + z) / (s + p) * omega_f / (s + omega_f)\n    L_jw = C_s * P_s\n\n    # 3. Sensitivity Peak Check\n    S_jw = 1.0 / (1.0 + L_jw)\n    max_S = np.max(np.abs(S_jw))\n    s_peak_ok = max_S <= 2.0\n\n    # 4. High-Frequency Noise Attenuation Check\n    s_na = 1j * 100.0\n    P_na = (s_na + 1.0) / ((s_na - 1.0) * (s_na + 3.0))\n    C_na = k * (s_na + z) / (s_na + p) * omega_f / (s_na + omega_f)\n    L_na = C_na * P_na\n    T_na = L_na / (1.0 + L_na)\n    noise_atten_ok = np.abs(T_na) <= 0.5\n\n    mag_db = 20.0 * np.log10(np.abs(L_jw))\n    phase_rad_unwrapped = np.unwrap(np.angle(L_jw))\n    phase_deg_unwrapped = np.rad2deg(phase_rad_unwrapped)\n    log_omega = np.log10(omega)\n\n    # 5. Phase Margin Check\n    pm_ok = False\n    # Find all crossings of 0 dB from above\n    gc_indices = np.where((mag_db[:-1] >= 0) & (mag_db[1:] < 0))[0]\n    if gc_indices.size > 0:\n        # Use the lowest frequency crossover\n        idx = gc_indices[0]\n        # Interpolate to find omega_gc on a log-freq scale\n        log_omega_gc = np.interp(0.0, [mag_db[idx + 1], mag_db[idx]], [log_omega[idx + 1], log_omega[idx]])\n        # Interpolate phase at omega_gc\n        phase_at_gc = np.interp(log_omega_gc, log_omega, phase_deg_unwrapped)\n        pm = 180.0 + phase_at_gc\n        pm_ok = pm >= 35.0\n\n    # 6. Gain Margin Check\n    gm_ok = False\n    all_gms_db = []\n    # Test for phase crossings at -180, -540, -900, ... degrees\n    min_phase = np.min(phase_deg_unwrapped)\n    max_phase = np.max(phase_deg_unwrapped)\n\n    # Generate targets within the range of the phase plot\n    start_m = int(np.ceil((max_phase - (-180.0)) / 360.0))\n    end_m = int(np.floor((min_phase - (-180.0)) / 360.0))\n    \n    target_phases = [-180.0 + m * 360.0 for m in range(end_m, start_m + 1)]\n\n    for target_phase in target_phases:\n        pc_indices = np.where(np.diff(np.sign(phase_deg_unwrapped - target_phase)) != 0)[0]\n        for idx in pc_indices:\n            # Interpolate to find omega_pc on a log-freq scale\n            log_omega_pc = np.interp(target_phase, \n                                     [phase_deg_unwrapped[idx], phase_deg_unwrapped[idx+1]], \n                                     [log_omega[idx], log_omega[idx+1]])\n            # Interpolate magnitude at omega_pc\n            mag_db_at_pc = np.interp(log_omega_pc, log_omega, mag_db)\n            gm_db = -mag_db_at_pc\n            all_gms_db.append(gm_db)\n    \n    if not all_gms_db: # No phase crossovers found\n        gm_ok = True  # Infinite GM is acceptable\n    else:\n        min_gm_db = min(all_gms_db)\n        if min_gm_db >= 6.0:\n            gm_ok = True\n\n    return is_stable and s_peak_ok and noise_atten_ok and pm_ok and gm_ok\n\ndef solve():\n    test_cases = [\n        (-20.0, 0.5, 5.0, 50.0), # Case A\n        (-8.0, 0.5, 5.0, 80.0),  # Case B\n        (50.0, 0.5, 5.0, 50.0),  # Case C\n    ]\n\n    results = []\n    for k_val, z_val, p_val, omega_f_val in test_cases:\n        result = analyze_case(k_val, z_val, p_val, omega_f_val)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2690827"}]}