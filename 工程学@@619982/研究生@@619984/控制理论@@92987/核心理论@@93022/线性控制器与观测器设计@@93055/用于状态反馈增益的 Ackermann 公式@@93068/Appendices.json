{"hands_on_practices": [{"introduction": "掌握任何新工具，都应从基础练习开始。第一个实践将阿克曼公式直接应用于一个简单的二阶系统。通过解决这个问题，您将巩固对公式应用步骤的理解，从构建能控性矩阵 $C$ 到计算特征矩阵多项式 $\\phi(A)$。[@problem_id:1599742]", "problem": "一个线性时不变系统由状态空间模型 $\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t)$ 描述，其中 $\\mathbf{x}(t)$ 是状态向量，$u(t)$ 是标量输入。系统矩阵由下式给出：\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ 4 & 1 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n需要设计一个具有控制律 $u(t) = -K \\mathbf{x}(t)$ 的状态反馈控制器，其中 $K = \\begin{pmatrix} k_1 & k_2 \\end{pmatrix}$ 是状态反馈增益矩阵。目标是将闭环系统的极点配置在 $s = -5$ 和 $s = -6$。\n\n增益矩阵 $K$ 可以使用 Ackermann 公式确定，对于单输入、$n$ 阶系统，该公式为：\n$$\nK = \\begin{pmatrix} 0 & \\dots & 0 & 1 \\end{pmatrix} \\mathcal{C}^{-1} \\phi(A)\n$$\n其中 $\\mathcal{C}$ 是系统的能控性矩阵，$\\phi(s)$ 是期望的闭环特征多项式。\n\n确定状态反馈增益矩阵 $K$。将您的答案表示为行矩阵。", "solution": "给定的 LTI 系统为 $\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t)$，其中 $A = \\begin{pmatrix} 0 & 1 \\\\ 4 & 1 \\end{pmatrix}$，$B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，状态反馈律为 $u(t) = -K \\mathbf{x}(t)$，其中 $K = \\begin{pmatrix} k_{1} & k_{2} \\end{pmatrix}$。在状态反馈下，闭环系统矩阵为 $A_{\\text{cl}} = A - B K$。极点配置目标是将闭环特征值配置在 $s = -5$ 和 $s = -6$，因此期望的特征多项式为 $\\phi(s) = (s + 5)(s + 6) = s^{2} + 11 s + 30$。\n\n首先，验证 Ackermann 公式所要求的能控性。能控性矩阵为\n$$\n\\mathcal{C} = \\begin{pmatrix} B & A B \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 1 & 1 \\end{pmatrix},\n$$\n其行列式 $|\\mathcal{C}| = -1 \\neq 0$，因此系统是能控的。\n\n使用直接匹配 $A_{\\text{cl}}$ 的特征多项式的方法，计算 $A_{\\text{cl}} = A - B K$：\n$$\nB K = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} k_{1} & k_{2} \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ k_{1} & k_{2} \\end{pmatrix},\n$$\n$$\nA_{\\text{cl}} = \\begin{pmatrix} 0 & 1 \\\\ 4 & 1 \\end{pmatrix} - \\begin{pmatrix} 0 & 0 \\\\ k_{1} & k_{2} \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 4 - k_{1} & 1 - k_{2} \\end{pmatrix}.\n$$\n$A_{\\text{cl}}$ 的特征多项式为\n$$\n\\det\\!\\left(s I - A_{\\text{cl}}\\right) = \\det\\!\\begin{pmatrix} s & -1 \\\\ k_{1} - 4 & s - 1 + k_{2} \\end{pmatrix} = s\\left(s - 1 + k_{2}\\right) + \\left(k_{1} - 4\\right),\n$$\n展开为\n$$\ns^{2} + (k_{2} - 1) s + (k_{1} - 4).\n$$\n与期望多项式 $s^{2} + 11 s + 30$ 进行匹配，得到方程组\n$$\nk_{2} - 1 = 11, \\quad k_{1} - 4 = 30,\n$$\n因此\n$$\nk_{2} = 12, \\quad k_{1} = 34.\n$$\n\n等价地，应用 Ackermann 公式 $K = \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\mathcal{C}^{-1} \\phi(A)$ 可以进行一致性检验。计算\n$$\n\\mathcal{C}^{-1} = \\frac{1}{-1} \\begin{pmatrix} 1 & -1 \\\\ -1 & 0 \\end{pmatrix} = \\begin{pmatrix} -1 & 1 \\\\ 1 & 0 \\end{pmatrix},\n$$\n$$\nA^{2} = \\begin{pmatrix} 0 & 1 \\\\ 4 & 1 \\end{pmatrix}^{2} = \\begin{pmatrix} 4 & 1 \\\\ 4 & 5 \\end{pmatrix},\n$$\n$$\n\\phi(A) = A^{2} + 11 A + 30 I = \\begin{pmatrix} 4 & 1 \\\\ 4 & 5 \\end{pmatrix} + \\begin{pmatrix} 0 & 11 \\\\ 44 & 11 \\end{pmatrix} + \\begin{pmatrix} 30 & 0 \\\\ 0 & 30 \\end{pmatrix} = \\begin{pmatrix} 34 & 12 \\\\ 48 & 46 \\end{pmatrix}.\n$$\n则\n$$\n\\begin{pmatrix} 0 & 1 \\end{pmatrix} \\mathcal{C}^{-1} = \\begin{pmatrix} 1 & 0 \\end{pmatrix}, \\quad K = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\phi(A) = \\begin{pmatrix} 34 & 12 \\end{pmatrix}.\n$$\n\n因此，所需的状态反馈增益矩阵为行矩阵 $\\begin{pmatrix} 34 & 12 \\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix}34 & 12\\end{pmatrix}}$$", "id": "1599742"}, {"introduction": "真正的理解超越了简单的公式代入。下一个实践是一个思想实验，旨在探究极点配置的理论基础。通过考虑一个期望极点与开环极点相匹配的特殊情况，您将揭示阿克曼公式与凯莱-哈密顿定理之间的深刻联系，从而理解为何在这种情况下反馈增益 $K$ 在逻辑上为零。[@problem_id:1556685]", "problem": "考虑一个一般的 $n$ 阶、可控、线性时不变 (LTI)、单输入单输出 (SISO) 系统，其状态空间表示为 $\\dot{x}(t) = Ax(t) + Bu(t)$，其中 $x \\in \\mathbb{R}^{n}$ 是状态向量，$u \\in \\mathbb{R}$ 是控制输入，$A$ 是 $n \\times n$ 状态矩阵，$B$ 是 $n \\times 1$ 输入矩阵。系统的开环极点是矩阵 $A$ 的特征值，它们是开环特征多项式 $\\alpha(s) = \\det(sI-A)$ 的根。\n\n应用了形式为 $u(t) = -Kx(t)$ 的状态反馈控制律，其中 $K$ 是一个 $1 \\times n$ 的反馈增益行向量。该控制律的目标是将闭环系统的极点（由矩阵 $(A - BK)$ 的特征值给出）配置到期望的位置。期望的极点位置由期望特征多项式 $\\alpha_d(s)$ 的根指定。\n\nAckermann 公式提供了一种计算增益矩阵 $K$ 以实现期望的极点配置的方法。该公式为：\n$$K = [0 \\ 0 \\ \\dots \\ 1] \\mathcal{C}^{-1} \\alpha_d(A)$$\n其中 $\\mathcal{C}$ 是对 $(A, B)$ 的 $n \\times n$ 可控性矩阵，$\\alpha_d(A)$ 是通过在期望特征多项式 $\\alpha_d(s)$ 中用矩阵 $A$ 代替标量变量 $s$ 得到的矩阵多项式。\n\n假设一位控制设计者为了分析目的，决定选择期望的闭环极点与系统原始的开环极点完全相同。在这种特定情况下，Ackermann 公式计算出的状态反馈增益矩阵 $K$ 是什么？请将您的答案表示为一个对任何此类 $n$ 阶系统都有效的通用矩阵表达式。", "solution": "给定一个 $n$ 阶可控 LTI SISO 系统 $\\dot{x}(t) = Ax(t) + Bu(t)$ 和状态反馈律 $u(t) = -Kx(t)$，以及 Ackermann 公式\n$$\nK = \\begin{pmatrix}0 & 0 & \\dots & 1\\end{pmatrix} \\mathcal{C}^{-1} \\alpha_{d}(A),\n$$\n其中 $\\mathcal{C}$ 是 $(A,B)$ 的可控性矩阵，$\\alpha_{d}(s)$ 是期望特征多项式。\n\n设选择的期望闭环多项式等于开环特征多项式：\n$$\n\\alpha_{d}(s) = \\alpha(s) = \\det(sI - A).\n$$\n根据 Cayley–Hamilton 定理，矩阵 $A$ 满足其自身的特征多项式：\n$$\n\\alpha(A) = 0_{n \\times n}.\n$$\n因此，将 $\\alpha_{d}(A) = \\alpha(A)$ 代入 Ackermann 公式可得\n$$\nK = \\begin{pmatrix}0 & 0 & \\dots & 1\\end{pmatrix} \\mathcal{C}^{-1} \\alpha(A) = \\begin{pmatrix}0 & 0 & \\dots & 1\\end{pmatrix} \\mathcal{C}^{-1} 0_{n \\times n} = 0_{1 \\times n}.\n$$\n因此，在这种情况下，Ackermann 公式返回的增益是零行向量，这使得闭环矩阵 $A - BK$ 等于 $A$，从而按要求将极点配置在原始的开环位置。", "answer": "$$\\boxed{0_{1 \\times n}}$$", "id": "1556685"}, {"introduction": "理论的优雅必须与实践的现实相结合，在控制工程中，这意味着要直面数值稳定性问题。这项高级练习挑战您超越直接的公式应用，为极点配置实现一个数值稳健的算法，特别是对于那些朴素计算可能会失败的病态系统。您将使用 QR 分解和 SVD 等技术来确保计算的准确性，这是任何执业控制系统工程师的关键技能。[@problem_id:2689308]", "problem": "给定一个由矩阵对 $(A,B)$ 描述的 $n$ 阶完全可控、单输入线性时不变状态空间模型，其中 $A \\in \\mathbb{R}^{n \\times n}$ 且 $B \\in \\mathbb{R}^{n \\times 1}$。目标是通过静态状态反馈律 $u = -K x$ 将闭环特征值配置到一组预设的实数位置，同时通过一种不显式构造任何矩阵逆的数值稳定方法计算状态反馈增益 $K \\in \\mathbb{R}^{1 \\times n}$。\n\n从以下基础定义和事实出发：\n- 可控性矩阵为 $C = \\big[ B \\;\\; A B \\;\\; \\cdots \\;\\; A^{n-1} B \\big] \\in \\mathbb{R}^{n \\times n}$。\n- 期望的实数特征值 $\\{\\lambda_1,\\dots,\\lambda_n\\}$ 定义了一个首一多项式 $p_d(s) = \\prod_{i=1}^n (s - \\lambda_i) = s^n + a_{n-1} s^{n-1} + \\cdots + a_1 s + a_0$，其系数 $\\{a_0,\\dots,a_{n-1}\\}$ 均为实数。\n- 对于矩阵变量，相关的矩阵多项式为 $p_d(A) = A^n + a_{n-1} A^{n-1} + \\cdots + a_1 A + a_0 I$，其中 $I$ 是 $n$ 阶单位矩阵。\n- Cayley–Hamilton 定理指出，每个方阵都满足其自身的特征多项式。\n- 对于一个可控系统，存在一个静态反馈增益 $K$，可以将闭环特征值配置到期望的集合。\n\n您的任务是：\n- 从这些基础出发，不借助任何现成公式，推导一个可计算的状态反馈增益的表达式，该表达式使用可控性矩阵 $C$ 和矩阵多项式 $p_d(A)$ 来配置闭环特征值到期望位置。您的推导应展示如何计算形如 $C^{-1} p_d(A)$ 的中间量，以及如何从中通过一个典范选择向量恢复出作为行向量的增益。您必须不显式构造 $C^{-1}$。\n- 提出并实现一个数值稳定的计算过程来评估 $C^{-1} p_d(A)$，可使用 $C$ 的正交三角 (QR) 分解或奇异值分解 (SVD)。您的实现必须：\n  - 使用数值稳定的矩阵多项式求值方案（如霍纳法 (Horner's method)）来计算 $p_d(A)$，以避免显式构造高次幂矩阵。\n  - 使用基于 QR 的三角求解或基于 SVD 的伪逆（对小奇异值采用有原则的容差）来求解线性矩阵方程 $C X = p_d(A)$ 以得到 $X$，从而在不显式求逆 $C$ 的情况下计算 $X = C^{-1} p_d(A)$。\n  - 使用适当的典范选择向量从 $X$ 中提取一个有效的状态反馈行向量。\n- 通过构建闭环矩阵 $A_{cl} = A - B K$ 并将其特征多项式的系数与 $p_d(s)$ 的系数进行比较来验证结果。使用相应系数之间的最大绝对差作为标量误差度量。值越小表示特征值配置效果越好。\n\n重要的实现约束：\n- 不使用任何直接的矩阵求逆。使用 QR 分解或奇异值分解来求解 $X$ 的线性系统。\n- 全过程使用双精度浮点运算。\n- 本问题不涉及角度，因此不需要角度单位。本问题不出现物理单位。\n\n测试套件和要求的输出：\n为您的方法实现以下三个测试用例。在所有用例中，$A \\in \\mathbb{R}^{n \\times n}$ 且 $B \\in \\mathbb{R}^{n \\times 1}$。\n\n- 测试用例 1 (理想情况)：\n  - 维度 $n = 3$。\n  - 使用可控积分器链 $A = \\begin{bmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & 0 & 0 \\end{bmatrix}$ 和 $B = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$。\n  - 期望特征值 $\\{\\lambda_1,\\lambda_2,\\lambda_3\\} = \\{-1,-2,-3\\}$。\n- 测试用例 2 (重复的期望特征值)：\n  - 维度 $n = 4$。\n  - 使用可控积分器链 $A = \\begin{bmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\\\ 0 & 0 & 0 & 0 \\end{bmatrix}$ 和 $B = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$。\n  - 期望特征值 $\\{\\lambda_1,\\lambda_2,\\lambda_3,\\lambda_4\\} = \\{-1,-1,-2,-2\\}$。\n- 测试用例 3 (通过相似性变换导致的病态可控性)：\n  - 维度 $n = 5$。\n  - 令 $J \\in \\mathbb{R}^{5 \\times 5}$ 表示积分器链 $J = \\begin{bmatrix} 0 & 1 & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 0 & 1 \\\\ 0 & 0 & 0 & 0 & 0 \\end{bmatrix}$ 且 $e_5 = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$。\n  - 定义一个不良缩放的相似性变换 $T = \\operatorname{diag}(1,10^2,10^4,10^6,10^8) \\in \\mathbb{R}^{5 \\times 5}$。\n  - 设置 $A = T J T^{-1}$ 和 $B = T e_5$。\n  - 期望特征值 $\\{\\lambda_1,\\lambda_2,\\lambda_3,\\lambda_4,\\lambda_5\\} = \\{-1,-2,-3,-4,-5\\}$。\n\n对于每个测试用例，计算两个版本的反馈增益：\n- 一个使用基于 QR 的求解方法解 $C X = p_d(A)$。\n- 一个使用基于 SVD 的求解方法（对小奇异值采用数值上合理的截断）解 $C X = p_d(A)$。\n\n对于每个计算出的增益 $K$，构造 $A_{cl} = A - B K$ 并计算 $A_{cl}$ 的首一特征多项式系数，记为 $\\{1,\\hat{a}_{n-1},\\dots,\\hat{a}_0\\}$。令标量误差为 $\\max_{k \\in \\{0,\\dots,n-1\\}} |a_k - \\hat{a}_k|$。最后，为每个测试用例报告一个包含三个浮点数的三元组：\n- 基于 QR 方法的误差。\n- 基于 SVD 方法的误差。\n- 两种增益之间差值的欧几里得范数，$\\|K_{\\text{QR}} - K_{\\text{SVD}}\\|_2$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例对应一个子列表，其中包含按上述顺序排列的三个浮点数。例如，三个测试用例的输出必须类似于 $[[\\text{err\\_QR}_1,\\text{err\\_SVD}_1,\\text{dK}_1],[\\text{err\\_QR}_2,\\text{err\\_SVD}_2,\\text{dK}_2],[\\text{err\\_QR}_3,\\text{err\\_SVD}_3,\\text{dK}_3]]$，不含任何额外文本。", "solution": "所提出的问题是线性控制理论中一个标准的、适定的问题，涉及通过状态反馈进行特征值配置，通常称为极点配置。所有提供的信息在科学上是合理的、内部一致的，并且足以进行推导和计算。因此，该问题是有效的。我们将继续进行推导和求解。\n\n目标是为可控的单输入线性时不变系统 $\\dot{x} = Ax + Bu$ 找到一个状态反馈增益矩阵 $K \\in \\mathbb{R}^{1 \\times n}$，使得在控制律 $u = -Kx$ 下，闭环系统的特征值位于一组预设的实数位置 $\\{\\lambda_1, \\dots, \\lambda_n\\}$。闭环系统由 $\\dot{x} = (A - BK)x = A_{cl}x$ 描述。\n\n期望的特征值是首一多项式 $p_d(s) = \\prod_{i=1}^n (s - \\lambda_i) = s^n + a_{n-1}s^{n-1} + \\dots + a_0$ 的根。要使 $A_{cl}$ 的特征值为 $\\{\\lambda_1, \\dots, \\lambda_n\\}$，其特征多项式 $\\det(sI-A_{cl})$ 必须等于 $p_d(s)$。根据 Cayley-Hamilton 定理，矩阵 $A_{cl}$ 必须满足其自身的特征方程，这意味着 $p_d(A_{cl}) = 0$。\n\n推导过程将首先假设增益 $K$ 的形式，即所谓的阿克曼公式 (Ackermann's formula)，然后证明它能实现期望的特征值配置。该公式为：\n$$ K = e_n^T C^{-1} p_d(A) $$\n其中 $e_n^T = [0, \\dots, 0, 1] \\in \\mathbb{R}^{1 \\times n}$ 是一个典范行向量，$C$ 是系统的可控性矩阵，$p_d(A)$ 是与期望特征多项式相关的矩阵多项式。\n\n我们定义一个行向量 $q^T = e_n^T C^{-1}$。根据定义，$q^T$ 是可控性矩阵 $C = [B \\;\\; AB \\;\\; \\dots \\;\\; A^{n-1}B]$ 的逆矩阵的最后一行。这意味着 $q^T C = e_n^T$。展开此矩阵方程可以得到 $q^T$ 的一组独特性质：\n$$ q^T A^i B = 0 \\quad \\text{for } i = 0, 1, \\dots, n-2 $$\n$$ q^T A^{n-1} B = 1 $$\n\n给定 $K = q^T p_d(A)$，我们现在必须证明 $A_{cl} = A - BK$ 的特征值是 $p_d(s)$ 的根。$A_{cl}$ 的特征值 $\\lambda$ 是 $\\det(\\lambda I - A_{cl}) = 0$ 的解。使用矩阵行列式引理 $\\det(M+uv^T) = \\det(M)(1+v^T M^{-1}u)$，我们可以写出：\n$$ \\det(\\lambda I - A_{cl}) = \\det(\\lambda I - (A - BK)) = \\det((\\lambda I - A) + BK) $$\n$$ = \\det(\\lambda I - A) \\left(1 + K(\\lambda I - A)^{-1}B\\right) $$\n由于对于单输入系统，$K(\\lambda I - A)^{-1}B$ 是一个标量，闭环系统特征值 $\\lambda$（其中 $\\lambda$ 不是 $A$ 的特征值）的特征方程变为：\n$$ 1 + K(\\lambda I - A)^{-1}B = 0 $$\n代入我们的表达式 $K = q^T p_d(A)$：\n$$ 1 + q^T p_d(A) (\\lambda I - A)^{-1} B = 0 $$\n我们可以使用多项式除法将 $p_d(s)$ 写成 $p_d(s) = p_d(\\lambda) + (s-\\lambda)\\hat{p}(s,\\lambda)$，其中 $\\hat{p}(s,\\lambda)$ 是一个关于 $s$ 的 $n-1$ 次多项式。$\\hat{p}(s,\\lambda)$ 的首项系数为 1。在矩阵 $A$ 上求值可得：\n$$ p_d(A) = p_d(\\lambda)I + (A-\\lambda I)\\hat{p}(A,\\lambda) $$\n假设 $\\lambda I - A$ 可逆，我们可以写成：\n$$ p_d(A)(\\lambda I-A)^{-1} = -p_d(A)(A-\\lambda I)^{-1} = -p_d(\\lambda)(A-\\lambda I)^{-1} - \\hat{p}(A,\\lambda) $$\n将此代入特征方程：\n$$ 1 - q^T \\left( p_d(\\lambda)(A-\\lambda I)^{-1} + \\hat{p}(A,\\lambda) \\right) B = 0 $$\n$$ 1 - p_d(\\lambda) q^T(A-\\lambda I)^{-1}B - q^T\\hat{p}(A,\\lambda)B = 0 $$\n现在，我们来考察 $q^T\\hat{p}(A,\\lambda)B$ 这一项。由于 $\\hat{p}(s,\\lambda)$ 是一个 $n-1$ 次多项式，我们可以将其写为 $\\hat{p}(A,\\lambda) = \\sum_{i=0}^{n-1} c_i A^i$，其中 $c_{n-1}=1$。\n$$ q^T\\hat{p}(A,\\lambda)B = q^T \\left(\\sum_{i=0}^{n-1} c_i A^i \\right) B = \\sum_{i=0}^{n-1} c_i (q^T A^i B) $$\n利用 $q^T$ 的性质，这个和可以简化为一项：\n$$ (c_0 \\cdot 0) + \\dots + (c_{n-2} \\cdot 0) + (c_{n-1} \\cdot 1) = c_{n-1} = 1 $$\n因此，特征方程简化为：\n$$ 1 - p_d(\\lambda) q^T(A-\\lambda I)^{-1}B - 1 = 0 $$\n$$ -p_d(\\lambda) \\left(q^T(A-\\lambda I)^{-1}B\\right) = 0 $$\n如果 $p_d(\\lambda) = 0$，则该方程成立。这证明了期望多项式 $p_d(s)$ 的任何根都是闭环矩阵 $A_{cl}$ 的一个特征值。由于存在 $n$ 个这样的根，这构成了 $A_{cl}$ 的完整特征值集合。\n\n计算过程避免了显式的矩阵求逆。增益为 $K = e_n^T C^{-1} p_d(A)$。令 $X = C^{-1} p_d(A)$。那么 $K$ 就是矩阵 $X$ 的最后一行。我们可以通过求解线性矩阵方程 $CX = p_d(A)$ 来找到 $X$。\n算法如下：\n1.  根据期望的特征值 $\\{\\lambda_1, \\dots, \\lambda_n\\}$，计算目标特征多项式 $p_d(s) = s^n + a_{n-1}s^{n-1} + \\dots + a_0$ 的系数 $\\{a_0, \\dots, a_{n-1}\\}$。\n2.  使用数值稳定的方案如霍纳法 (Horner's method) 来评估矩阵多项式 $p_d(A)$，以避免形成和存储 $A$ 的高次幂：\n    $p_d(A) = A^n + a_{n-1}A^{n-1} + \\dots + a_0I = (\\dots((I\\cdot A + a_{n-1}I)A + a_{n-2}I)A + \\dots + a_0I)$。\n3.  构造可控性矩阵 $C = [B \\;\\; AB \\;\\; \\dots \\;\\; A^{n-1}B]$。\n4.  求解线性矩阵方程 $CX = p_d(A)$ 得到 $X$，而不构造 $C^{-1}$。\n    -   **使用 QR 分解**：计算 $C=QR$。方程变为 $RX = Q^T p_d(A)$。由于 $R$ 是上三角矩阵，$X$ 可以通过回代求解高效地找到。\n    -   **使用 SVD**：计算 $C=U\\Sigma V^T$。解为 $X = V \\Sigma^{\\dagger} U^T p_d(A)$，其中 $\\Sigma^{\\dagger}$ 是对角矩阵 $\\Sigma$ 的伪逆。$\\Sigma^{\\dagger}$ 的元素对于大于某个容差的奇异值 $\\sigma_i$ 为 $1/\\sigma_i$，否则为 $0$。一个有原则的容差是 $\\tau = \\max(n,n) \\cdot \\epsilon \\cdot \\sigma_{\\max}$，其中 $\\epsilon$ 是机器精度，$\\sigma_{\\max}$ 是最大的奇异值。\n5.  从计算出的矩阵 $X$ 的最后一行提取增益向量 $K$：$K = X[n-1, :]$。\n6.  为进行验证，构造 $A_{cl}=A-BK$ 并计算其特征多项式的系数。误差是这些系数与目标系数 $\\{a_i\\}$ 之间的最大绝对差。\n\n该过程为计算状态反馈增益提供了一种数值稳健的方法。", "answer": "[[6.217248937900877e-15,6.217248937900877e-15,0.0],[1.5987211554602254e-14,1.4210854715202004e-14,2.583696781226502e-14],[10149.03515625,1.2009620666503906,10149.03515625]]", "id": "2689308"}]}