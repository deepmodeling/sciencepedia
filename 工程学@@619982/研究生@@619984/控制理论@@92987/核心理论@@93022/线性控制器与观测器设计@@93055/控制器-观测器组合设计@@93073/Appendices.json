{"hands_on_practices": [{"introduction": "在设计组合控制器-观测器时，我们通常遵循分离原则，首先假设所有状态变量均可测量，来设计一个状态反馈增益 $K$。这个练习将引导你完成这一关键步骤，通过极点配置技术来决定闭环系统的动态响应。通过这个过程，你不仅能掌握控制器增益的计算方法，还能深入理解将控制器与观测器相结合的理论基石——分离原则 [@problem_id:2693684]。", "problem": "考虑一个由状态空间给出的单输入单输出线性时不变系统：\n$$\n\\dot{x}(t) = A x(t) + b\\,u(t), \n\\qquad y(t) = c\\,x(t),\n$$\n其中\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n-1 & -2 & -3 & -4\n\\end{pmatrix}, \n\\quad\nb = \\begin{pmatrix}0 \\\\ 0 \\\\ 0 \\\\ 1\\end{pmatrix}, \n\\quad\nc = \\begin{pmatrix}1 & 0 & 0 & 0\\end{pmatrix}.\n$$\n您将基于可控性概念和 Cayley–Hamilton 定理进行推导，设计一个用于极点配置的状态反馈增益，然后讨论如何将其与观测器结合以实现输出反馈。\n\n任务：\n1) 从可控性矩阵的定义和 Cayley–Hamilton 定理出发，推导出状态反馈增益 $K \\in \\mathbb{R}^{1\\times 4}$ 的表达式，该增益能够为闭环矩阵 $A - bK$ 指定任意给定的首一特征多项式。您的推导必须明确证明为何该表达式在可控性假设下有效，并且必须用 $A$、$b$ 和可控性矩阵来表示该增益。\n\n2) 对于上述系统，计算唯一的能将闭环极点配置在指定位置 $\\{-1,-2,-3,-4\\}$ 的状态反馈增益 $K$，即指定期望的特征多项式为\n$$\n\\varphi_{d}(s) = (s+1)(s+2)(s+3)(s+4).\n$$\n将 $K$ 以 $1\\times 4$ 行向量的形式给出。请用精确整数表示答案，不要四舍五入。\n\n3) 假设仅能测量输出 $y(t)$。解释如何通过构建一个增益为 $L \\in \\mathbb{R}^{4\\times 1}$ 的 Luenberger 观测器和控制律 $u(t) = -K \\hat{x}(t)$ 来实现动态输出反馈控制器，并写出估计误差动态方程。说明控制器-观测器组合闭环系统的特征值与所选的控制器和观测器极点之间的关系。您无需对 $L$ 进行数值计算。\n\n4) 从数值分析的角度，讨论当任务1中推导出的增益计算表达式应用于高阶或病态实现时其数值敏感性。指出至少两种能够降低数值敏感性同时保持极点配置目标的有原则的缓解策略。\n\n您最终报告的答案必须是任务2中得到的增益 $K$，以单个 $1\\times 4$ 行向量的形式给出。", "solution": "所给问题是线性控制理论中的一个标准练习，涉及为单输入单输出 (SISO) 线性时不变 (LTI) 系统设计和分析状态反馈控制器及观测器。问题的所有组成部分都定义明确、科学合理且内部一致。所提供的系统数据完整，且为完成任务进行了适当的结构化。因此，该问题是有效的，可以构建严谨的解决方案。\n\n该系统由以下状态空间方程描述：\n$$\n\\dot{x}(t) = A x(t) + b\\,u(t), \n\\qquad y(t) = c\\,x(t)\n$$\n矩阵为\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n-1 & -2 & -3 & -4\n\\end{pmatrix}, \n\\quad\nb = \\begin{pmatrix}0 \\\\ 0 \\\\ 0 \\\\ 1\\end{pmatrix}, \n\\quad\nc = \\begin{pmatrix}1 & 0 & 0 & 0\\end{pmatrix}.\n$$\n系统的阶数为 $n=4$。\n\n下面将依次解决这些任务。\n\n**任务1：状态反馈增益表达式的推导**\n\n目标是为控制律 $u(t) = -Kx(t)$ 找到一个状态反馈增益矩阵 $K \\in \\mathbb{R}^{1 \\times n}$，使得闭环系统 $\\dot{x}(t) = (A-bK)x(t)$ 具有指定的特征多项式 $\\varphi_d(s)$。\n\n当且仅当系统对 $(A,b)$ 可控时，才能保证存在唯一的增益 $K$ 可以任意配置 $n$ 个自共轭的闭环极点（或等效地，任意一个 $n$ 次实系数特征多项式）。可控性意味着可控性矩阵 $\\mathcal{C} = \\begin{pmatrix} b & Ab & \\dots & A^{n-1}b \\end{pmatrix}$ 满秩，即 $\\text{rank}(\\mathcal{C}) = n$，这意味着 $\\mathcal{C}$ 是可逆的。\n\n通过将系统变换到可控规范型 (CCF)，推导过程最为清晰。如果 $(A,b)$ 是可控的，则存在一个可逆变换矩阵 $T$，使得变换后的状态 $z=Tx$ 满足 $\\dot{z} = \\bar{A}z + \\bar{b}u$，其中 $\\bar{A} = TAT^{-1}$ 和 $\\bar{b} = Tb$ 为可控规范型：\n$$\n\\bar{A} = \\begin{pmatrix}\n0 & 1 & 0 & \\dots & 0 \\\\\n0 & 0 & 1 & \\dots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & 0 & \\dots & 1 \\\\\n-a_0 & -a_1 & -a_2 & \\dots & -a_{n-1}\n\\end{pmatrix}, \\quad\n\\bar{b} = \\begin{pmatrix}\n0 \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ 1\n\\end{pmatrix}.\n$$\n$\\bar{A}$ 最后一行的系数 $a_i$ 定义了开环系统的特征多项式 $\\varphi_A(s) = \\det(sI - A) = \\det(sI - \\bar{A}) = s^n + a_{n-1}s^{n-1} + \\dots + a_1s + a_0$。\n\n在变换后的坐标系中，反馈律为 $u = -Kx = -K T^{-1} z = -\\bar{K}z$，其中 $\\bar{K} = K T^{-1}$。新坐标系下的闭环矩阵为 $\\bar{A}_{cl} = \\bar{A} - \\bar{b}\\bar{K}$。\n$$\n\\bar{A} - \\bar{b}\\bar{K} = \\begin{pmatrix}\n0 & 1 & \\dots & 0 \\\\\n\\vdots & & \\ddots & \\vdots \\\\\n0 & 0 & \\dots & 1 \\\\\n-a_0 & -a_1 & \\dots & -a_{n-1}\n\\end{pmatrix} -\n\\begin{pmatrix} 0 \\\\ \\vdots \\\\ 0 \\\\ 1 \\end{pmatrix}\n\\begin{pmatrix} \\bar{k}_1 & \\bar{k}_2 & \\dots & \\bar{k}_n \\end{pmatrix}\n= \\begin{pmatrix}\n0 & 1 & \\dots & 0 \\\\\n\\vdots & & \\ddots & \\vdots \\\\\n0 & 0 & \\dots & 1 \\\\\n-(a_0+\\bar{k}_1) & -(a_1+\\bar{k}_2) & \\dots & -(a_{n-1}+\\bar{k}_n)\n\\end{pmatrix}.\n$$\n该矩阵的特征多项式为 $\\varphi_{cl}(s) = s^n + (a_{n-1}+\\bar{k}_n)s^{n-1} + \\dots + (a_0+\\bar{k}_1)$。设期望的特征多项式为 $\\varphi_d(s) = s^n + \\alpha_{n-1}s^{n-1} + \\dots + \\alpha_0$。通过令 $\\varphi_{cl}(s)$ 和 $\\varphi_d(s)$ 的系数相等，我们可以求出在可控规范型基下的所需增益 $\\bar{K}$：\n$$\na_i + \\bar{k}_{i+1} = \\alpha_i \\implies \\bar{k}_{i+1} = \\alpha_i - a_i \\quad \\text{for } i = 0, \\dots, n-1.\n$$\n因此，$\\bar{K} = \\begin{pmatrix} \\alpha_0-a_0 & \\alpha_1-a_1 & \\dots & \\alpha_{n-1}-a_{n-1} \\end{pmatrix}$。\n\n通过逆变换可以恢复原始坐标系下的增益：$K = \\bar{K}T$。尽管这个过程证明了增益的存在性并提供了一种计算方法，但它需要找到变换矩阵 $T$。一个更直接的表达式，即 Ackermann 公式，将 $K$ 与原始系统矩阵和期望多项式直接联系起来。该公式植根于同样的可控性原理，并利用了 Cayley-Hamilton 定理，该定理指出任何矩阵都满足其自身的特征方程，即 $\\varphi_A(A) = 0$。\n\n增益 $K$ 的表达式为：\n$$\nK = \\begin{pmatrix} 0 & 0 & \\dots & 1 \\end{pmatrix} \\mathcal{C}^{-1} \\varphi_d(A)\n$$\n其中 $\\mathcal{C} = \\begin{pmatrix} b & Ab & \\dots & A^{n-1}b \\end{pmatrix}$ 是可控性矩阵，$\\varphi_d(A)$ 是矩阵多项式 $\\varphi_d(A) = A^n + \\alpha_{n-1}A^{n-1} + \\dots + \\alpha_1 A + \\alpha_0 I$。$\\mathcal{C}$ 的可逆性由系统的可控性保证。这个公式代表了从基于变换的方法推导出的极点配置问题的一个紧凑的、符号化的解。\n\n**任务2：状态反馈增益的计算**\n\n给定的系统已经是 $n=4$ 的可控规范型。矩阵 $A$ 的最后一行包含了其特征多项式系数的相反数。\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n-a_0 & -a_1 & -a_2 & -a_3\n\\end{pmatrix} = \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n-1 & -2 & -3 & -4\n\\end{pmatrix}.\n$$\n开环特征多项式 $\\varphi_A(s) = s^4 + a_3 s^3 + a_2 s^2 + a_1 s + a_0$ 的系数为 $a_0 = 1$，$a_1 = 2$，$a_2 = 3$ 和 $a_3 = 4$。\n\n期望的闭环极点位于 $\\{-1, -2, -3, -4\\}$。期望的特征多项式为：\n$$\n\\varphi_d(s) = (s+1)(s+2)(s+3)(s+4)\n$$\n展开该多项式：\n$$\n\\varphi_d(s) = (s^2 + 3s + 2)(s^2 + 7s + 12) = s^4 + 7s^3 + 12s^2 + 3s^3 + 21s^2 + 36s + 2s^2 + 14s + 24\n$$\n$$\n\\varphi_d(s) = s^4 + 10s^3 + 35s^2 + 50s + 24.\n$$\n期望多项式 $\\varphi_d(s) = s^4 + \\alpha_3 s^3 + \\alpha_2 s^2 + \\alpha_1 s + \\alpha_0$ 的系数为 $\\alpha_0 = 24$，$\\alpha_1 = 50$，$\\alpha_2 = 35$ 和 $\\alpha_3 = 10$。\n\n由于系统处于可控规范型，我们已经处于任务1中的“bar”坐标系，因此 $T=I$ 且 $K=\\bar{K}$。增益可以直接计算如下：\n$$\nK = \\begin{pmatrix} \\alpha_0 - a_0 & \\alpha_1 - a_1 & \\alpha_2 - a_2 & \\alpha_3 - a_3 \\end{pmatrix}\n$$\n$$\nK = \\begin{pmatrix} 24 - 1 & 50 - 2 & 35 - 3 & 10 - 4 \\end{pmatrix}\n$$\n$$\nK = \\begin{pmatrix} 23 & 48 & 32 & 6 \\end{pmatrix}.\n$$\n\n**任务3：输出反馈控制器-观测器结构**\n\n当完整的状态向量 $x(t)$ 无法直接测量，只有输出 $y(t) = cx(t)$ 可用时，我们必须对状态进行估计。这可以通过使用状态观测器来实现，通常是 Luenberger 观测器。观测器是一个动态系统，它生成状态 $x(t)$ 的一个估计值 $\\hat{x}(t)$。\n\n观测器的动态方程由下式给出：\n$$\n\\dot{\\hat{x}}(t) = A\\hat{x}(t) + bu(t) + L(y(t) - \\hat{y}(t))\n$$\n其中 $\\hat{x}(t)$ 是状态估计值，$\\hat{y}(t) = c\\hat{x}(t)$ 是估计输出，$L \\in \\mathbb{R}^{n \\times 1}$ 是观测器增益矩阵。项 $L(y - \\hat{y})$ 是一个校正项，它利用输出估计误差来驱动状态估计值趋近于真实状态。然后使用估计的状态来实施控制律：$u(t) = -K\\hat{x}(t)$。\n\n估计误差的动态特性，定义为 $e(t) = x(t) - \\hat{x}(t)$，可以通过将系统状态方程减去观测器方程得到：\n$$\n\\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t) = (Ax + bu) - (A\\hat{x} + bu + L(y - \\hat{y}))\n$$\n代入 $y=cx$ 和 $\\hat{y}=c\\hat{x}$：\n$$\n\\dot{e}(t) = A(x-\\hat{x}) - L(cx-c\\hat{x}) = A e(t) - Lc\\,e(t) = (A-Lc)e(t).\n$$\n估计误差动态是自治的，根据 $\\dot{e}(t) = (A-Lc)e(t)$ 演化。为了使估计值 $\\hat{x}(t)$ 收敛到 $x(t)$，误差 $e(t)$ 必须收敛到零。这要求矩阵 $A-Lc$ 是 Hurwitz 矩阵（其所有特征值都必须有负实部）。当且仅当系统对 $(A,c)$ 可观测时，才能通过选择 $L$ 来任意配置观测器的极点（即 $A-Lc$ 的特征值）。\n\n完整的闭环系统结构，包括被控对象、观测器和反馈律，展示了**分离原理**。状态动态变为 $\\dot{x} = Ax + b(-K\\hat{x}) = Ax - bK(x-e) = (A-bK)x + bKe$。状态和误差的组合动态为：\n$$\n\\begin{pmatrix} \\dot{x}(t) \\\\ \\dot{e}(t) \\end{pmatrix} = \\begin{pmatrix} A-bK & bK \\\\ 0 & A-Lc \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix}.\n$$\n由于系统矩阵是块上三角矩阵，其特征值是对角块特征值的并集。因此，组合的控制器-观测器系统的 $2n$ 个闭环极点集合是以下两者的并集：\n1. 由 $\\det(sI-(A-bK))=0$ 决定的状态反馈控制器的 $n$ 个特征值。\n2. 由 $\\det(sI-(A-Lc))=0$ 决定的观测器的 $n$ 个特征值。\n\n这种分离特性允许控制器增益 $K$ 和观测器增益 $L$ 可以独立设计。控制器极点（$A-bK$ 的特征值）的选择是为了满足性能指标，而观测器极点（$A-Lc$ 的特征值）通常被选择得比控制器极点更快（例如，快 2 到 5 倍），以确保估计误差能迅速收敛。\n\n**任务4：数值敏感性与缓解策略**\n\n表达式 $K = \\begin{pmatrix} 0 & \\dots & 1 \\end{pmatrix} \\mathcal{C}^{-1} \\varphi_d(A)$ 虽然形式优雅，但众所周知其在数值上是敏感的，特别是对于高阶系统 ($n \\gg 1$)。数值不稳定性的两个主要来源是：\n\n1.  **可控性矩阵 $\\mathcal{C}$ 的病态性**：$\\mathcal{C}$ 的列是 $A^i b$。如果矩阵 $A$ 的特征值模长远离 1，则列向量 $A^i b$ 的范数会随着 $i$ 指数级增长或衰减。这可能导致 $\\mathcal{C}$ 的列近似线性相关，从而使 $\\mathcal{C}$ 成为病态矩阵（即具有很大的条件数）。对这类矩阵进行数值求逆是高度不稳定的，会放大系统数据或浮点运算中的任何微小误差，导致计算出的增益 $K$ 极不准确。\n\n2.  **矩阵多项式 $\\varphi_d(A)$ 的计算**：计算 $\\varphi_d(A) = \\sum_{i=0}^n \\alpha_i A^i$ 需要计算高达 $A^n$ 的矩阵幂。这个过程在数值上可能不稳定，并且容易产生大的浮点误差，特别是当 $A$ 含有大数值元素或具有大范数时。病态的 $\\mathcal{C}^{-1}$ 和大范数的 $\\varphi_d(A)$ 相结合，可能导致灾难性的误差放大。\n\n为解决这些数值问题，实践中会使用更稳健的算法。两种有原则的缓解策略是：\n\n1.  **正交变换方法**：稳健的极点配置算法不直接构建和求逆 $\\mathcal{C}$，而是使用一系列数值稳定的正交变换（例如，使用 Householder 反射或 Givens 旋转，如 QR 分解中那样）。例如，阶梯算法（或 Petkov、Christov 和 Konstantinov 提出的方法）使用正交矩阵将系统对 $(A,b)$ 变换为一种“阶梯”形式，这是可控规范型的推广。然后在这个条件数更好的形式上进行极点配置。由于正交变换保持欧几里得范数和条件数，这些方法避免了与非正交变换和显式矩阵求逆相关的不稳定性。MATLAB 的 `place` 命令就是基于这类稳健算法的。\n\n2.  **变换到平衡实现**：另一种策略是首先将系统变换到一个基，在该基下状态变量在“同等”程度上可控和可观。这是通过状态变换到平衡实现来完成的，在平衡实现中，可控性和可观性 Gramian 矩阵相等且为对角阵。在平衡系统上进行的极点配置通常具有更好的条件数。尽管平衡变换本身的计算量可能很大，但它通常会产生具有更好数值特性的矩阵，从而得到更可靠的增益计算结果。得到的增益随后被变换回原始状态基。这种方法在应用极点配置算法之前，改善了问题底层表示的条件数。", "answer": "$$\n\\boxed{\\begin{pmatrix} 23 & 48 & 32 & 6 \\end{pmatrix}}\n$$", "id": "2693684"}, {"introduction": "在现实世界中，我们往往无法直接测量所有状态，因此需要设计一个状态观测器来估计它们。本练习聚焦于观测器增益 $L$ 的设计，以确保估计误差能快速收敛。你将运用对偶原理这一优美的概念，它揭示了观测器设计与控制器设计在数学上的深刻联系，从而简化设计过程 [@problem_id:2693676]。", "problem": "考虑一个线性时不变系统，其状态空间实现由下式给出\n$$\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t),$$\n其中\n$$A = \\begin{pmatrix}\n0 & 0 & -4 \\\\\n1 & 0 & -3 \\\\\n0 & 1 & -2\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\n0 \\\\ 0 \\\\ 1\n\\end{pmatrix}, \\quad\nC = \\begin{pmatrix}\n1 & 0 & 0\n\\end{pmatrix}.$$\n假设一个基于观测器的输出反馈实现\n$$\\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L\\big(y(t) - C \\hat{x}(t)\\big), \\quad u(t) = -K \\hat{x}(t),$$\n其中 $L \\in \\mathbb{R}^{3 \\times 1}$ 是观测器增益，$K \\in \\mathbb{R}^{1 \\times 3}$ 是状态反馈增益。您可以利用这样一个事实（分离原理）：如果矩阵对 $(A,B)$ 是可控的，且矩阵对 $(A,C)$ 是可观测的，则在此动态输出反馈下的闭环极点是 $A - B K$ 和 $A - L C$ 特征值的并集，并且这两组特征值可以独立配置。\n\n已知矩阵对 $(A,C)$ 是可观测的。利用可控性与可观测性之间的对偶性，并根据特征多项式配置的第一性原理（不使用任何未经证明的捷径），构建一个观测器增益 $L$，使得观测器误差动力学矩阵 $A - L C$ 的特征值为 $-1$、$-2$ 和 $-3$。请以 $L$ 的精确分量形式提供您的最终答案。\n\n您的答案必须是一个计算过程。将您的最终答案表示为一个包含 $L$ 各个精确值的单行向量。无需四舍五入，也不涉及单位。", "solution": "首先对问题陈述进行验证。\n\n步骤 1：提取已知条件\n一个线性时不变系统的状态空间表示由下式给出：\n系统动力学：$\\dot{x}(t) = A x(t) + B u(t)$，$y(t) = C x(t)$\n系统矩阵：\n$A = \\begin{pmatrix}\n0 & 0 & -4 \\\\\n1 & 0 & -3 \\\\\n0 & 1 & -2\n\\end{pmatrix}$, $B = \\begin{pmatrix}\n0 \\\\ 0 \\\\ 1\n\\end{pmatrix}$, $C = \\begin{pmatrix}\n1 & 0 & 0\n\\end{pmatrix}$。\n基于观测器的输出反馈控制器：\n$\\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L(y(t) - C \\hat{x}(t))$\n$u(t) = -K \\hat{x}(t)$\n$L \\in \\mathbb{R}^{3 \\times 1}$ 是观测器增益。$K \\in \\mathbb{R}^{1 \\times 3}$ 是状态反馈增益。\n分离原理是作为一个事实给出的，它指出闭环极点是 $A-BK$ 和 $A-LC$ 特征值的并集。\n问题陈述指出矩阵对 $(A,C)$ 是可观测的。\n目标是求取观测器增益 $L$，使得观测器误差动力学矩阵 $A-LC$ 的特征值为 $\\{-1, -2, -3\\}$。\n方法必须使用对偶性原理和基于第一性原理的特征多项式配置。\n\n步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据。这是一个针对 Luenberger 观测器的标准极点配置问题，是控制理论中的一个基本课题。所有概念、变量和数学结构都是公认的。该问题是适定的。条件 $(A,C)$ 可观测保证了观测器误差动力学的极点可以任意配置，从而确保对于给定的期望特征值，存在唯一的解 $L$。该问题是客观的，并以精确的数学语言表述。数据是完整和一致的；所有必需的矩阵和目标特征值都已提供。这些数值在数学上是合理的，不包含任何物理或数学上的矛盾。该问题需要一个标准的、可验证的计算。\n\n步骤 3：结论与行动\n问题有效。将提供完整的解答。\n\n任务是设计一个观测器增益向量 $L$，使得观测器误差动力学矩阵 $A-LC$ 的特征值位于 $\\{-1, -2, -3\\}$。问题指出了可观测性与可控性之间的对偶性。针对矩阵对 $(A,C)$ 的观测器的极点配置问题，与针对矩阵对 $(A^T, C^T)$ 的状态反馈控制器的极点配置问题是对偶的。$A-LC$ 的特征值与其转置 $(A-LC)^T = A^T - C^T L^T$ 的特征值相同。因此，为该观测器求取增益 $L$ 等价于为对偶系统 $(A^T, C^T)$ 求取控制器增益 $K_d = L^T$。\n\n然而，题目要求我们使用特征多项式配置的第一性原理来解决此问题。该方法涉及直接计算矩阵 $A-LC$ 的特征多项式，并将其与期望的特征多项式进行比较。此过程是基础性的，既适用于原观测器问题，也适用于对偶控制器问题。我们将通过直接计算 $A-LC$ 的特征多项式来求解。\n\n设观测器增益向量为 $L = \\begin{pmatrix} l_1 \\\\ l_2 \\\\ l_3 \\end{pmatrix}$。\n矩阵乘积 $LC$ 为：\n$$LC = \\begin{pmatrix} l_1 \\\\ l_2 \\\\ l_3 \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} l_1 & 0 & 0 \\\\ l_2 & 0 & 0 \\\\ l_3 & 0 & 0 \\end{pmatrix}$$\n那么，观测器误差动力学矩阵 $A-LC$ 为：\n$$A-LC = \\begin{pmatrix} 0 & 0 & -4 \\\\ 1 & 0 & -3 \\\\ 0 & 1 & -2 \\end{pmatrix} - \\begin{pmatrix} l_1 & 0 & 0 \\\\ l_2 & 0 & 0 \\\\ l_3 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} -l_1 & 0 & -4 \\\\ 1-l_2 & 0 & -3 \\\\ -l_3 & 1 & -2 \\end{pmatrix}$$\n$A-LC$ 的特征多项式，记为 $p_{actual}(\\lambda)$，由行列式 $\\det(\\lambda I - (A-LC))$ 给出：\n$$p_{actual}(\\lambda) = \\det(\\lambda I - (A-LC)) = \\det \\begin{pmatrix} \\lambda - (-l_1) & -0 & -(-4) \\\\ -(1-l_2) & \\lambda-0 & -(-3) \\\\ -(-l_3) & -1 & \\lambda-(-2) \\end{pmatrix} = \\det \\begin{pmatrix} \\lambda+l_1 & 0 & 4 \\\\ l_2-1 & \\lambda & 3 \\\\ l_3 & -1 & \\lambda+2 \\end{pmatrix}$$\n我们沿第一行进行代数余子式展开来计算行列式：\n$$p_{actual}(\\lambda) = (\\lambda+l_1) \\det \\begin{pmatrix} \\lambda & 3 \\\\ -1 & \\lambda+2 \\end{pmatrix} - 0 \\cdot \\det(\\dots) + 4 \\det \\begin{pmatrix} l_2-1 & \\lambda \\\\ l_3 & -1 \\end{pmatrix}$$\n$$p_{actual}(\\lambda) = (\\lambda+l_1)[\\lambda(\\lambda+2) - (3)(-1)] + 4[(l_2-1)(-1) - \\lambda l_3]$$\n$$p_{actual}(\\lambda) = (\\lambda+l_1)(\\lambda^2+2\\lambda+3) + 4(-l_2+1-\\lambda l_3)$$\n$$p_{actual}(\\lambda) = (\\lambda^3+2\\lambda^2+3\\lambda) + (l_1\\lambda^2+2l_1\\lambda+3l_1) + (4-4l_2-4\\lambda l_3)$$\n按 $\\lambda$ 的幂次合并项：\n$$p_{actual}(\\lambda) = \\lambda^3 + (l_1+2)\\lambda^2 + (2l_1 - 4l_3 + 3)\\lambda + (3l_1 - 4l_2 + 4)$$\n期望的特征值为 $\\{-1, -2, -3\\}$。期望的特征多项式 $p_{des}(\\lambda)$ 是相应因子的乘积：\n$$p_{des}(\\lambda) = (\\lambda - (-1))(\\lambda - (-2))(\\lambda - (-3)) = (\\lambda+1)(\\lambda+2)(\\lambda+3)$$\n$$p_{des}(\\lambda) = (\\lambda^2 + 3\\lambda + 2)(\\lambda+3) = \\lambda^3 + 3\\lambda^2 + 2\\lambda + 3\\lambda^2 + 9\\lambda + 6$$\n$$p_{des}(\\lambda) = \\lambda^3 + 6\\lambda^2 + 11\\lambda + 6$$\n为了实现期望的极点配置，实际的特征多项式必须与期望的特征多项式完全相同。我们令 $p_{actual}(\\lambda)$ 和 $p_{des}(\\lambda)$ 中 $\\lambda$ 的同次幂系数相等：\n比较 $p_{actual}(\\lambda) = \\lambda^3 + (l_1+2)\\lambda^2 + (2l_1 - 4l_3 + 3)\\lambda + (3l_1 - 4l_2 + 4)$ 和 $p_{des}(\\lambda) = \\lambda^3 + 6\\lambda^2 + 11\\lambda + 6$，我们得到一个关于 $l_1$、$l_2$ 和 $l_3$ 的线性方程组。\n\n1.  $\\lambda^2$ 的系数：\n    $$l_1+2 = 6 \\implies l_1 = 4$$\n2.  $\\lambda^1$ 的系数：\n    $$2l_1 - 4l_3 + 3 = 11$$\n    代入 $l_1=4$：\n    $$2(4) - 4l_3 + 3 = 11$$\n    $$8 - 4l_3 + 3 = 11$$\n    $$11 - 4l_3 = 11$$\n    $$-4l_3 = 0 \\implies l_3 = 0$$\n3.  $\\lambda^0$ 的系数（常数项）：\n    $$3l_1 - 4l_2 + 4 = 6$$\n    代入 $l_1=4$：\n    $$3(4) - 4l_2 + 4 = 6$$\n    $$12 - 4l_2 + 4 = 6$$\n    $$16 - 4l_2 = 6$$\n    $$-4l_2 = 6 - 16 = -10$$\n    $$l_2 = \\frac{-10}{-4} = \\frac{5}{2}$$\n因此，观测器增益向量的分量为 $l_1=4$、$l_2=\\frac{5}{2}$ 和 $l_3=0$。\n观测器增益为 $L = \\begin{pmatrix} 4 \\\\ \\frac{5}{2} \\\\ 0 \\end{pmatrix}$。最终答案要求以行向量的形式给出。", "answer": "$$\\boxed{\\begin{pmatrix} 4 & \\frac{5}{2} & 0 \\end{pmatrix}}$$", "id": "2693676"}, {"introduction": "掌握了控制器和观测器的极点配置方法后，我们必须面对一个更深层次的问题：这种设计能力是否是无限的？本练习将探讨系统不变零点的概念，它们是系统的内在属性，无法通过反馈来改变。通过计算和分析，你将理解为何某些不稳定的零点会对闭环系统的稳定性构成根本性的制约，这也是任何高级控制设计都必须考虑的核心问题 [@problem_id:2693652]。", "problem": "考虑由最小状态空间实现给出的单输入单输出线性时不变对象\n$$\n\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t),\n$$\n其中\n$$\nA = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1 & -1 \\end{bmatrix}, \\quad D = 0.\n$$\n所有矩阵均为实数且时不变。你需要使用线性系统理论中的基本定义，包括可控性、可观测性、通过 Rosenbrock 系统矩阵求不变零点，以及基于分离原理的观测器输出反馈结构。\n\n任务：\n1) 通过检验矩阵对 $\\left(A,B\\right)$ 的可控性和矩阵对 $\\left(A,C\\right)$ 的可观测性，验证该实现是最小的。\n\n2) 使用不变零点的定义，即使得 Rosenbrock 系统矩阵\n$$\n\\mathcal{R}(s) \\triangleq \\begin{bmatrix} s I - A & -B \\\\ C & 0 \\end{bmatrix}\n$$\n降秩的复数值 $s \\in \\mathbb{C}$，计算该对象的不变零点。\n\n3) 考虑一个基于观测器的输出反馈控制器，该控制器由一个全状态反馈律和一个全阶 Luenberger 观测器组合而成。控制器增益的选择使得 $A - B K$ 的特征值位于 $\\{-2,-4\\}$，$A - L C$ 的特征值位于 $\\{-5,-6\\}$。利用分离原理和闭环互联系统的内部稳定性定义，解释该对象的不变零点如何限制可实现的闭环极点位置，特别说明禁止不稳定的极零点对消。\n\n最终交付成果：\n计算在任务2中求得的不变零点与任务3中基于观测器的组合设计所产生的闭环极点集合 $\\{-2,-4,-5,-6\\}$ 之间的最小绝对谱分离。将最终值表示为一个精确的实数（不进行四舍五入）。", "solution": "问题陈述已解析和验证。所有给定条件均按原文提取：状态空间表示 $\\dot{x}(t) = A x(t) + B u(t)$, $y(t) = C x(t)$ 和矩阵 $A = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix}$, $B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$, $C = \\begin{bmatrix} 1 & -1 \\end{bmatrix}$ 及 $D = 0$。任务涉及验证最小性、通过 Rosenbrock 系统矩阵 $\\mathcal{R}(s)$ 计算不变零点，以及分析一个在 $\\{-2, -4, -5, -6\\}$ 处具有指定闭环极点的基于观测器的控制器。该问题在已建立的线性控制理论中有科学依据，是适定的、客观的且自洽的。它不包含逻辑矛盾、模糊术语或事实不准确性。因此，该问题被视为有效，并将提供解答。\n\n解答过程按顺序处理三个任务。\n\n任务1：最小性验证。\n一个线性时不变系统实现是最小的，当且仅当它既是可控的又是可观测的。\n\n首先，我们评估矩阵对 $(A, B)$ 的可控性。如果可控性矩阵 $\\mathcal{C}$ 是满秩的，则系统是可控的。对于一个二阶系统，满秩即秩为2。可控性矩阵定义为 $\\mathcal{C} = \\begin{bmatrix} B & AB \\end{bmatrix}$。\n\n给定 $A = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix}$ 和 $B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$，我们计算乘积 $AB$：\n$$\nAB = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} (0)(0) + (1)(1) \\\\ (-2)(0) + (-3)(1) \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ -3 \\end{bmatrix}.\n$$\n那么可控性矩阵 $\\mathcal{C}$ 为：\n$$\n\\mathcal{C} = \\begin{bmatrix} 0 & 1 \\\\ 1 & -3 \\end{bmatrix}.\n$$\n为了检验是否满秩，我们计算 $\\mathcal{C}$ 的行列式：\n$$\n\\det(\\mathcal{C}) = (0)(-3) - (1)(1) = -1.\n$$\n由于 $\\det(\\mathcal{C}) \\neq 0$，矩阵 $\\mathcal{C}$ 的秩为2。因此，矩阵对 $(A, B)$ 是可控的。\n\n接下来，我们评估矩阵对 $(A, C)$ 的可观测性。如果可观测性矩阵 $\\mathcal{O}$ 是满秩的，则系统是可观测的，对于本例即秩为2。可观测性矩阵定义为 $\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\end{bmatrix}$。\n\n给定 $C = \\begin{bmatrix} 1 & -1 \\end{bmatrix}$，我们计算乘积 $CA$：\n$$\nCA = \\begin{bmatrix} 1 & -1 \\end{bmatrix} \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix} = \\begin{bmatrix} (1)(0) + (-1)(-2) & (1)(1) + (-1)(-3) \\end{bmatrix} = \\begin{bmatrix} 2 & 4 \\end{bmatrix}.\n$$\n那么可观测性矩阵 $\\mathcal{O}$ 为：\n$$\n\\mathcal{O} = \\begin{bmatrix} 1 & -1 \\\\ 2 & 4 \\end{bmatrix}.\n$$\n为了检验是否满秩，我们计算 $\\mathcal{O}$ 的行列式：\n$$\n\\det(\\mathcal{O}) = (1)(4) - (-1)(2) = 4 + 2 = 6.\n$$\n由于 $\\det(\\mathcal{O}) \\neq 0$，矩阵 $\\mathcal{O}$ 的秩为2。因此，矩阵对 $(A, C)$ 是可观测的。\n因为系统既是可控的又是可观测的，所以该状态空间实现是最小的。\n\n任务2：不变零点计算。\n不变零点是使 Rosenbrock 系统矩阵 $\\mathcal{R}(s)$ 降秩的复数 $s \\in \\mathbb{C}$。对于单输入单输出 (SISO) 系统，这对应于使 $\\det(\\mathcal{R}(s)) = 0$ 的 $s$ 值。该矩阵定义为：\n$$\n\\mathcal{R}(s) = \\begin{bmatrix} sI - A & -B \\\\ C & D \\end{bmatrix}.\n$$\n代入给定矩阵，其中 $D=0$，我们有：\n$$\nsI - A = s \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} - \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix} = \\begin{bmatrix} s & -1 \\\\ 2 & s+3 \\end{bmatrix}.\n$$\n因此，Rosenbrock 矩阵为：\n$$\n\\mathcal{R}(s) = \\begin{bmatrix} s & -1 & 0 \\\\ 2 & s+3 & -1 \\\\ 1 & -1 & 0 \\end{bmatrix}.\n$$\n我们计算这个 $3 \\times 3$ 矩阵的行列式，例如，沿第三列进行代数余子式展开：\n$$\n\\det(\\mathcal{R}(s)) = (0) \\cdot \\det\\begin{pmatrix} 2 & s+3 \\\\ 1 & -1 \\end{pmatrix} - (-1) \\cdot \\det\\begin{pmatrix} s & -1 \\\\ 1 & -1 \\end{pmatrix} + (0) \\cdot \\det\\begin{pmatrix} s & -1 \\\\ 2 & s+3 \\end{pmatrix}.\n$$\n$$\n\\det(\\mathcal{R}(s)) = (1) \\cdot \\big( s(-1) - (-1)(1) \\big) = -s + 1.\n$$\n不变零点是 $\\det(\\mathcal{R}(s)) = 0$ 的根：\n$$\n-s + 1 = 0 \\implies s = 1.\n$$\n系统在 $z=1$ 处有一个不变零点。\n\n任务3：基于观测器的控制器分析与最终计算。\n对于对象 $\\dot{x} = Ax + Bu, y = Cx$，一个基于观测器的输出反馈控制器由一个全阶 Luenberger 观测器 $\\dot{\\hat{x}} = A\\hat{x} + Bu + L(y - C\\hat{x})$ 和一个使用估计状态的状态反馈控制律 $u = -K\\hat{x}$ 组成。估计误差 $e(t) = x(t) - \\hat{x}(t)$ 的动力学由 $\\dot{e} = (A - LC)e$ 给出。反馈下对象状态的动力学为 $\\dot{x} = Ax + B(-K\\hat{x}) = Ax - BK(x-e) = (A-BK)x + BKe$。对于状态向量 $[x^T, e^T]^T$ 的复合闭环系统动力学为：\n$$\n\\frac{d}{dt} \\begin{bmatrix} x \\\\ e \\end{bmatrix} = \\begin{bmatrix} A-BK & BK \\\\ 0 & A-LC \\end{bmatrix} \\begin{bmatrix} x \\\\ e \\end{bmatrix}.\n$$\n这个分块上三角矩阵的特征值是对角块特征值的并集。这就是分离原理：闭环极点是 $A-BK$ 的特征值集合（控制器极点）和 $A-LC$ 的特征值集合（观测器极点）。问题指定这些集合为 $\\sigma(A-BK) = \\{-2, -4\\}$ 和 $\\sigma(A-LC) = \\{-5, -6\\}$。因此，完整的闭环极点集合是 $\\{-2, -4, -5, -6\\}$。\n\n不变零点是对象的一个基本属性，不能通过反馈来改变。对于一个最小系统，不变零点与对象的传递函数 $G(s) = C(sI-A)^{-1}B$ 的零点相同。试图将一个闭环极点放置在对象零点的位置会导致极零点对消。如果该零点是不稳定的（即其实部为非负），即使整体的输入-输出传递函数可能看起来是稳定的，这种对消也会使闭环系统内部不稳定。内部不稳定性源于在零点位置上存在一个不可观测的模态（如果该极点来自 $A-BK$）或一个不可控的模态（如果该极点来自 $A-LC$）。\n我们计算出的不变零点是 $z=1$，它位于右半平面，$\\Re(z) > 0$。这是一个不稳定零点。因此，一个稳定的闭环系统设计绝不能在 $s=1$ 处放置任何极点。指定的极点位于 $\\{-2, -4, -5, -6\\}$ 的设计遵守了这一基本约束，因为所有极点都在左半平面且与该零点不同。\n\n最后，我们计算不变零点与闭环极点集合之间的最小绝对谱分离。不变零点为 $z = 1$。闭环极点集合为 $P = \\{-2, -4, -5, -6\\}$。我们必须找到 $\\min_{p \\in P} |z - p|$。\n各个分离值为：\n$$\n|1 - (-2)| = |1 + 2| = 3.\n$$\n$$\n|1 - (-4)| = |1 + 4| = 5.\n$$\n$$\n|1 - (-5)| = |1 + 5| = 6.\n$$\n$$\n|1 - (-6)| = |1 + 6| = 7.\n$$\n在集合 $\\{3, 5, 6, 7\\}$ 中的最小值为 $3$。", "answer": "$$\\boxed{3}$$", "id": "2693652"}]}