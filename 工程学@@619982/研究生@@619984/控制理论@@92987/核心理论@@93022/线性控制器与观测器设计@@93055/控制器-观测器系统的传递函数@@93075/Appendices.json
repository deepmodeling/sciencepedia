{"hands_on_practices": [{"introduction": "分离原理是现代控制理论的基石之一，它优雅地指出，在理想条件下，状态反馈控制器的设计和观测器的设计可以解耦。这个练习将带你深入这一核心概念。你不仅需要从第一性原理出发，推导参考-输出传递函数 $T_{yr}(s)$ 确与观测器增益 $L$ 无关，更具挑战性的是，你还需要设计一个严谨的经验验证方案，从而连接抽象理论与实际的系统辨识。[@problem_id:2755556]", "problem": "考虑一个线性时不变（LTI）系统，由以下状态空间方程描述：\n$$\\dot{x}(t)=A x(t)+B u(t), \\quad y(t)=C x(t),$$\n该系统没有直接项，即 $D=0$。系统采用一个全阶 Luenberger 观测器，并结合静态状态反馈和参考预滤波器。控制器-观测器的互联结构如下：\n$$u(t)=-K \\hat{x}(t)+N r(t),$$\n$$\\dot{\\hat{x}}(t)=A \\hat{x}(t)+B u(t)+L\\big(y(t)-C \\hat{x}(t)\\big),$$\n其中 $x(t)\\in\\mathbb{R}^n$，$u(t)\\in\\mathbb{R}^m$，$y(t)\\in\\mathbb{R}^p$，$r(t)\\in\\mathbb{R}^q$。假设 $(A,B)$ 是可镇定的，$(A,C)$ 是可检测的，$A-BK$ 是 Hurwitz 矩阵，$A-LC$ 也是 Hurwitz 矩阵。预滤波器 $N$ 的选择是为了实现期望的稳态跟踪性能，且不依赖于 $L$。\n\n从这些第一性原理出发，并根据传递函数作为零初始条件下的输入-输出映射的标准定义，证明从 $r$ 到 $y$ 的闭环传递函数（记为 $T_{yr}(s)$）与观测器增益 $L$ 无关。你的推导必须消除内部变量，并且仅基于上述互联结构和状态空间到传递函数的映射定义，不得引用任何预先记忆的分离定理。\n\n然后，要求你设计一种经验上可测试的验证方法来验证这种独立性，该方法不依赖于已知的 $(A,B,C)$。你将通过改变 $L$ 同时保持 $K$（和 $N$）固定的方式，重复进行 $T_{yr}(s)$ 的频域辨识，并且你必须考虑由测量噪声和 $\\hat{x}(t)$ 中的初始暂态引起的辨识偏差。\n\n以下哪种实验方案提供了一种可靠的方法来验证 $T_{yr}(s)$ 对 $L$ 的独立性？\n\nA. 保持 $K$ 和 $N$ 固定。选择几个具有不同谱的稳定化增益 $L$。对于每个 $L$，要么将初始条件重置为 0，要么丢弃一个足够长的初始时间窗口，以使由 $A-LC$ 主导的观测器误差暂态可以忽略不计。施加相同的持续激励信号 $r(t)$（例如，滤波后的白噪声），该信号与测量噪声不相关。使用闭环交叉谱方法 $\\widehat{T}_{yr}(\\mathrm{j}\\omega)=\\widehat{S}_{yr}(\\omega)/\\widehat{S}_{rr}(\\omega)$ 并采用韦尔奇平均法 (Welch averaging) 来估计非参数频率响应函数 (FRF) $\\widehat{T}_{yr}(\\mathrm{j}\\omega)$，并计算渐近 95% 置信区间。如果在激励频带内，不同 $L$ 对应的 FRF 在置信区间内一致，则得出独立的结论。\n\nB. 保持 $K$ 固定并改变 $L$。对每个 $L$ 使用单个阶跃输入 $r(t)$，并为每次实验将一个二阶输出误差模型拟合到 $(r,y)$。如果两个估计的固有频率在 5% 以内匹配，则得出独立的结论。\n\nC. 保持 $K$ 固定并改变 $L$。不施加 $r(t)$；而是依赖进入 $y(t)$ 的环境测量噪声来激励回路，并通过将 $r(t)\\equiv 0$ 并使用工具变量估计器来从 $(r,y)$ 辨识 $T_{yr}(s)$。如果辨识出的模型匹配，则得出独立的结论。\n\nD. 保持 $K$ 固定并改变 $L$。在每次实验中施加相同的白噪声 $r(t)$ 信号。辨识从 $r \\to u$ 的传递函数，如果从 $r\\to u$ 的传递函数在不同 $L$ 之间匹配，则得出 $T_{yr}(s)$ 对 $L$ 独立的结论。\n\n选择唯一的最佳选项。", "solution": "这个问题包含两部分。第一部分是理论推导，以证明控制器-观测器系统的一个性质。第二部分是评估用于验证此性质的实验方法。我将依次解决这两个部分，在此之前先验证问题陈述的有效性。\n\n问题陈述是有效的。它提出了线性控制理论中的一个标准配置——一个带 Luenberger 观测器的状态反馈控制下的系统——并要求推导一个已知的性质，然后评估系统辨识方案。其前提是科学上合理的、适定的和客观的。诸如可镇定性、可检测性以及闭环极点的 Hurwitz 稳定性等所有假设都是标准且恰当的。我将开始解题。\n\n**第一部分：传递函数 $T_{yr}(s)$ 的推导**\n\n目标是推导从参考输入 $r(t)$ 到系统输出 $y(t)$ 的传递函数 $T_{yr}(s)$。传递函数的定义假设所有初始条件均为零。\n\n给定的系统方程为：\n1. 系统: $\\dot{x}(t) = A x(t) + B u(t)$\n2. 输出: $y(t) = C x(t)$\n3. 控制律: $u(t) = -K \\hat{x}(t) + N r(t)$\n4. 观测器: $\\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L(y(t) - C \\hat{x}(t))$\n\n我们对这些方程进行拉普拉斯变换，假设初始条件为零，即 $x(0)=0$ 和 $\\hat{x}(0)=0$。令 $X(s)$, $Y(s)$, $U(s)$, $\\hat{X}(s)$, 和 $R(s)$ 分别是 $x(t)$, $y(t)$, $u(t)$, $\\hat{x}(t)$, 和 $r(t)$ 的拉普拉斯变换。\n\n变换后的方程为：\n1. $sX(s) = AX(s) + BU(s)$\n2. $Y(s) = CX(s)$\n3. $U(s) = -K\\hat{X}(s) + NR(s)$\n4. $s\\hat{X}(s) = A\\hat{X}(s) + BU(s) + L(Y(s) - C\\hat{X}(s))$\n\n为了分析真实状态 $x(t)$ 和估计状态 $\\hat{x}(t)$ 之间的关系，我们定义观测器误差 $e(t) = x(t) - \\hat{x}(t)$。此误差的动态特性可以通过对 $e(t)$ 求导得到：\n$$ \\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t) $$\n代入 $\\dot{x}(t)$ 和 $\\dot{\\hat{x}}(t)$ 的表达式：\n$$ \\dot{e}(t) = \\big(A x(t) + B u(t)\\big) - \\big(A \\hat{x}(t) + B u(t) + L(y(t) - C \\hat{x}(t))\\big) $$\n项 $B u(t)$ 相消。我们代入 $y(t) = C x(t)$：\n$$ \\dot{e}(t) = A x(t) - A \\hat{x}(t) - L(C x(t) - C \\hat{x}(t)) $$\n$$ \\dot{e}(t) = (A - LC)x(t) - (A - LC)\\hat{x}(t) $$\n$$ \\dot{e}(t) = (A - LC)\\big(x(t) - \\hat{x}(t)\\big) = (A - LC)e(t) $$\n这就是观测器误差动态。它是一个仅由自身状态驱动的线性系统。参考输入 $r(t)$ 并未出现在此方程中，这意味着误差动态与参考指令是解耦的。\n\n对误差动态方程进行拉普拉斯变换，初始条件为零，即 $e(0) = x(0) - \\hat{x}(0) = 0 - 0 = 0$，我们得到：\n$$ sE(s) = (A - LC)E(s) $$\n$$ \\big(sI - (A - LC)\\big)E(s) = 0 $$\n问题陈述中说明 $A - LC$ 是 Hurwitz 矩阵，意味着它的所有特征值都具有严格为负的实部。仅当 $s$ 是 $A - LC$ 的一个特征值时，矩阵 $\\big(sI - (A - LC)\\big)$ 才是奇异的。对于闭右半复平面（$\\text{Re}(s) \\ge 0$）中的任何 $s$，该矩阵是可逆的。该方程必须对所有定义了变换的 $s$ 成立。由于 $E(s)$ 是一个有理函数向量，要使其在复平面的一个区域上为零，它必须恒等于零。因此，对于所有 $s$，有 $E(s) = 0$。\n\n这意味着 $X(s) - \\hat{X}(s) = 0$，即 $X(s) = \\hat{X}(s)$。这是一个关键的中间结果。它意味着，在零初始状态和无噪声的理想条件下，状态估计的拉普拉斯变换与真实状态的变换完全相同。\n\n现在，我们将 $\\hat{X}(s) = X(s)$ 代入控制律 (3) 中：\n$$ U(s) = -KX(s) + NR(s) $$\n接下来，将这个 $U(s)$ 的表达式代入系统状态空间方程 (1) 中：\n$$ sX(s) = AX(s) + B\\big(-KX(s) + NR(s)\\big) $$\n$$ sX(s) = (A - BK)X(s) + BNR(s) $$\n我们现在可以解出 $X(s)$ 关于 $R(s)$ 的表达式：\n$$ \\big(sI - (A - BK)\\big)X(s) = BNR(s) $$\n$$ X(s) = (sI - A + BK)^{-1}BNR(s) $$\n问题陈述中说明 $A-BK$ 是 Hurwitz 矩阵，因此对于 $\\text{Re}(s) \\ge 0$，逆矩阵 $(sI - A + BK)^{-1}$ 存在。\n\n最后，我们使用方程 (2) 找到输出 $Y(s)$：\n$$ Y(s) = CX(s) = C(sI - A + BK)^{-1}BNR(s) $$\n从 $r$ 到 $y$ 的传递函数矩阵是 $T_{yr}(s)$，满足 $Y(s) = T_{yr}(s)R(s)$。因此，\n$$ T_{yr}(s) = C(sI - A + BK)^{-1}BN $$\n这个传递函数 $T_{yr}(s)$ 的最终表达式依赖于系统矩阵 $A, B, C$ 和控制器增益 $K, N$。它不依赖于观测器增益矩阵 $L$。推导到此完成。\n\n**第二部分：实验方案的评估**\n\n任务是选择最佳的实验方案，以在不知道 $A, B, C$ 的情况下验证 $T_{yr}(s)$ 对 $L$ 的独立性。\n\n**选项 A 分析**\n该方案建议保持 $K$ 和 $N$ 固定，选择几个不同的稳定化增益 $L$，并对每个 $L$ 辨识频率响应函数 (FRF) $\\widehat{T}_{yr}(\\mathrm{j}\\omega)$ 并比较结果。\n- **处理暂态**: 该方案正确地建议要么重置初始条件，要么丢弃一个初始时间窗口。这一点至关重要，因为非零初始条件 $e(0)$ 会在观测器误差中引起一个暂态 $e(t) = e^{(A-LC)t}e(0)$。这个暂态的动态特性依赖于 $L$。为了测量稳态传递函数，必须消除这种暂态效应。\n- **激励信号**: 它指定了一个持续激励的输入 $r(t)$（例如，滤波后的白噪声）。这是为了获得足够的信息以在宽频率范围内辨识 FRF 所必需的。\n- **辨识方法**: 它提出了交叉谱方法 $\\widehat{T}_{yr}(\\mathrm{j}\\omega) = \\widehat{S}_{yr}(\\omega)/\\widehat{S}_{rr}(\\omega)$。在实际情况下，测量的输出 $y_m(t)$ 会被噪声污染，$y_m(t) = y(t) + v(t)$。这种测量噪声 $v(t)$ 会通过观测器传播，影响 $\\hat{x}(t)$ 和 $u(t)$。然而，只要外部参考 $r(t)$ 与测量噪声 $v(t)$ 不相关，交叉谱 $S_{y_m r}(\\omega)$ 就不受 $v(t)$ 的影响。因此，该估计器可以得到真实 FRF $T_{yr}(\\mathrm{j}\\omega)$ 的渐近无偏估计。\n- **统计比较**: 它建议计算置信区间，并在这些界限内检查一致性。这为判断所辨识的函数是否相同提供了统计上严格的基础。\n该方案是全面的、方法上合理的，并遵循了系统辨识的最佳实践。\n**结论：正确。**\n\n**选项 B 分析**\n该方案使用阶跃输入并拟合一个二阶模型。\n- **激励信号**: 阶跃输入不是持续激励的。其能量集中在低频，不适合用于辨识完整的频率响应。\n- **模型结构**: 真实系统的阶次是未知的，并且很可能不是 2 阶。强制采用不正确的低阶模型结构（模型阶次错误指定）将导致有偏的、不准确的传递函数估计。\n- **比较指标**: 仅仅比较一个错误结构模型的单个或两个参数（如固有频率），对于检验两个传递函数是否相等来说是完全不够的。\n该方案存在严重缺陷，不大可能得出可靠的结论。\n**结论：不正确。**\n\n**选项 C 分析**\n该方案建议不施加外部参考 $r(t)$，而是依赖环境噪声进行激励。\n- **无输入**: 需要辨识的量是 $T_{yr}(s)$，即从 $r$ 到 $y$ 的传递函数。如果输入 $r(t)$ 恒为零，则无法辨识此传递函数。没有因果关系可供测量。\n- **激励源**: 系统动态将由测量噪声 $v(t)$ 驱动。人们可以尝试辨识从 $v(t)$ 到 $y_m(t)$ 的传递函数。如初步分析所示，这个传递函数 $T_{y_m v}(s)$ *确实*依赖于 $L$。实验将表明系统的噪声响应随 $L$ 变化，这是预料之中的，并且与关于 $T_{yr}(s)$ 的理论不矛盾。该方案从根本上就是误导性的。\n**结论：不正确。**\n\n**选项 D 分析**\n该方案建议辨识从 $r$ 到 $u$ 的传递函数 $T_{ur}(s)$，并检查它是否与 $L$ 无关。\n- **理论基础**: 理论上的传递函数是 $T_{ur}(s) = N - K(sI-A+BK)^{-1}BN$。这确实与 $L$ 无关。所以，基本思想是有效的。\n- **方案的完整性**: 该方案的陈述过于简单。它只说“辨识传递函数”，而没有指定方法或考虑实际问题。在 $y(t)$ 上存在测量噪声 $v(t)$ 的情况下，观测器误差 $e(t)$ 非零，并且是 $v(t)$ 和 $L$ 的函数。控制信号是 $u(t) = -K(x(t)-e(t)) + Nr(t)$。因此，$u(t)$ 被一个依赖于 $L$ 的噪声项所污染。一个简单的辨识方法（例如，基于普通最小二乘法）会产生一个对 $T_{ur}(s)$ 的有偏估计，并且这个偏差会依赖于 $L$。这将导致错误的结论，即 $T_{ur}(s)$ 依赖于 $L$。\n- **与 A 的比较**: 选项 A 明确规定了一种方法（交叉谱分析），该方法克服了噪声引起的偏差这一问题。选项 D 则没有。因此，选项 A 是一个完整而稳健的方案，而选项 D 是一个不完整且脆弱的方案。\n**结论：不正确。**\n\n**总结**\n选项 A 描述了一个严谨且切实可行的实验设计，它正确地考虑了闭环系统辨识中的主要挑战，即初始暂态和测量噪声。对于所提出的验证任务，它是唯一代表了一种可靠科学方法的选项。", "answer": "$$\\boxed{A}$$", "id": "2755556"}, {"introduction": "上一个练习揭示了，在理想情况下，观测器极点不影响系统的参考跟踪性能。这自然引出一个关键问题：如果增益 $L$ 的选择对于跟踪无关紧要，我们该如何决定它的值呢？这个练习将通过探索一个关键的实际问题——系统对测量噪声的响应——来回答这个问题。你将发现，尽管观测器设计不影响理想跟踪，但它对系统的噪声抑制能力起着决定性作用，这是工程实践中必须权衡的重要性能指标。[@problem_id:2755436]", "problem": "考虑一个严格真、单输入单输出 (SISO) 的线性时不变 (LTI) 对象，其状态空间形式由以下方程给出\n$$\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t),$$\n其中\n$$A = \\begin{pmatrix} 0 & 1 \\\\ -4 & -3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}.$$\n实现了一个基于观测器的状态反馈控制器，该控制器包含一个全阶 Luenberger 观测器和静态状态反馈。该控制器使用测量输出\n$$y_{m}(t) = y(t) + v(t),$$\n其中 $v(t)$ 是加性测量噪声。控制律和观测器为\n$$u(t) = -K \\hat{x}(t), \\quad \\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L\\big(y_{m}(t) - C \\hat{x}(t)\\big),$$\n增益为\n$$K = \\begin{pmatrix} 6 & 4 \\end{pmatrix}, \\quad L = \\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix}.$$\n假设 $x(t)$ 和 $\\hat{x}(t)$ 的初始条件为零。仅使用基本的状态空间关系和 Luenberger 观测器的定义，推导从测量噪声输入 $v(t)$ 到对象输出 $y(t)$ 的闭环传递函数。将你的最终答案表示为拉普拉斯变量 $s$ 的单个实有理函数，记为 $G_{v \\to y}(s)$，其中在零初始条件下 $Y(s) = G_{v \\to y}(s) V(s)$。然后，通过分析推导出的表达式，识别由观测器动态引入的任何有限零点，并定性解释其位置如何依赖于观测器增益 $L$。\n\n你的最终答案必须是 $G_{v \\to y}(s)$ 的单一闭式解析表达式。不需要进行数值舍入，也不需要单位。", "solution": "对问题陈述进行验证。\n\n逐字提取给定条件：\n- 对象模型: $\\dot{x}(t) = A x(t) + B u(t)$, $y(t) = C x(t)$\n- 对象矩阵: $A = \\begin{pmatrix} 0 & 1 \\\\ -4 & -3 \\end{pmatrix}$, $B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$, $C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$\n- 测量输出: $y_{m}(t) = y(t) + v(t)$\n- 控制律: $u(t) = -K \\hat{x}(t)$\n- 观测器动态: $\\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L\\big(y_{m}(t) - C \\hat{x}(t)\\big)$\n- 增益矩阵: $K = \\begin{pmatrix} 6 & 4 \\end{pmatrix}$, $L = \\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix}$\n- 初始条件: $x(0)=0$ 以及 $\\hat{x}(0)=0$.\n- 目标: 推导传递函数 $G_{v \\to y}(s) = Y(s)/V(s)$ 并分析由观测器引入的零点。\n\n验证已执行。该问题在科学上基于线性控制理论的既定原理，特别是基于观测器的状态反馈控制器的设计。它的提法是适定的，为推导唯一解提供了所有必要的数据和定义。该问题是客观的，并使用了精确的标准术语。不存在矛盾、歧义或事实上的不健全之处。因此，该问题被认为是有效的，并将提供解答。\n\n推导将从第一性原理出发，使用状态空间分析，这是最严谨的方法。整个闭环系统的动态由对象状态 $x(t)$ 和观测器状态 $\\hat{x}(t)$ 描述。使用对象状态 $x(t)$ 和估计误差 $e(t) = x(t) - \\hat{x}(t)$ 可以获得一个更具洞察力的表示。\n\n首先，我们推导估计误差 $e(t)$ 的动态。\n$$ \\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t) $$\n代入给定的 $\\dot{x}(t)$ 和 $\\dot{\\hat{x}}(t)$ 方程：\n$$ \\dot{e}(t) = \\big(A x(t) + B u(t)\\big) - \\big(A \\hat{x}(t) + B u(t) + L(y_m(t) - C\\hat{x}(t))\\big) $$\n$B u(t)$ 项相消。我们代入 $y_m(t) = y(t) + v(t) = C x(t) + v(t)$：\n$$ \\dot{e}(t) = A x(t) - A \\hat{x}(t) - L\\big(C x(t) + v(t) - C\\hat{x}(t)\\big) $$\n将含有 $x(t)$ 和 $\\hat{x}(t)$ 的项分组：\n$$ \\dot{e}(t) = A \\big(x(t) - \\hat{x}(t)\\big) - L C \\big(x(t) - \\hat{x}(t)\\big) - L v(t) $$\n认识到 $e(t) = x(t) - \\hat{x}(t)$，我们得到误差动态：\n$$ \\dot{e}(t) = (A - LC) e(t) - L v(t) $$\n这个方程表明，误差动态由测量噪声 $v(t)$ 驱动，并且独立于状态 $x(t)$，这是 Luenberger 观测器的一个关键特性。\n\n接下来，我们推导反馈下对象状态 $x(t)$ 的动态。控制律为 $u(t) = -K \\hat{x}(t)$。我们将 $\\hat{x}(t)$ 表示为 $x(t) - e(t)$。\n$$ u(t) = -K (x(t) - e(t)) $$\n将此代入对象状态方程：\n$$ \\dot{x}(t) = A x(t) + B u(t) = A x(t) - B K (x(t) - e(t)) $$\n$$ \\dot{x}(t) = (A - BK) x(t) + BK e(t) $$\n状态动态同时依赖于状态 $x(t)$ 和估计误差 $e(t)$。\n\n我们现在得到了一个以状态向量 $\\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix}$ 表示的组合状态空间系统：\n$$ \\begin{pmatrix} \\dot{x}(t) \\\\ \\dot{e}(t) \\end{pmatrix} = \\begin{pmatrix} A-BK & BK \\\\ 0 & A-LC \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ -L \\end{pmatrix} v(t) $$\n输出方程为 $y(t) = C x(t) = \\begin{pmatrix} C & 0 \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix}$。\n\n系统矩阵的块三角结构证明了分离原理：闭环系统的极点是控制器极点（$A-BK$ 的特征值）和观测器极点（$A-LC$ 的特征值）的并集。\n\n我们对这些方程应用拉普拉斯变换，初始条件为零：\n$$ sX(s) = (A-BK)X(s) + BKE(s) $$\n$$ sE(s) = (A-LC)E(s) - LV(s) $$\n$$ Y(s) = CX(s) $$\n\n从第二个方程，我们求解 $E(s)$：\n$$ (sI - (A-LC))E(s) = -LV(s) \\implies E(s) = -(sI - A + LC)^{-1} L V(s) $$\n从第一个方程，我们求解 $X(s)$：\n$$ (sI - (A-BK))X(s) = BKE(s) \\implies X(s) = (sI - A + BK)^{-1} BKE(s) $$\n将 $E(s)$ 的表达式代入 $X(s)$ 的表达式中：\n$$ X(s) = -(sI - A + BK)^{-1} BK (sI - A + LC)^{-1} L V(s) $$\n最后，我们找到输出 $Y(s)$：\n$$ Y(s) = CX(s) = -C(sI - A + BK)^{-1} BK (sI - A + LC)^{-1} L V(s) $$\n因此，传递函数 $G_{v \\to y}(s) = Y(s)/V(s)$ 为：\n$$ G_{v \\to y}(s) = -C(sI - A + BK)^{-1} BK (sI - A + LC)^{-1} L $$\n现在，我们代入给定的数值矩阵。\n\n首先，计算控制器矩阵 $A_c = A-BK$：\n$$ BK = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 6 & 4 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 6 & 4 \\end{pmatrix} $$\n$$ A_c = A - BK = \\begin{pmatrix} 0 & 1 \\\\ -4 & -3 \\end{pmatrix} - \\begin{pmatrix} 0 & 0 \\\\ 6 & 4 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -10 & -7 \\end{pmatrix} $$\n控制器的特征多项式为 $\\det(sI - A_c) = \\det\\begin{pmatrix} s & -1 \\\\ 10 & s+7 \\end{pmatrix} = s(s+7) + 10 = s^2 + 7s + 10$。\n\n接着，计算观测器矩阵 $A_o = A-LC$：\n$$ LC = \\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 10 & 0 \\\\ 8 & 0 \\end{pmatrix} $$\n$$ A_o = A - LC = \\begin{pmatrix} 0 & 1 \\\\ -4 & -3 \\end{pmatrix} - \\begin{pmatrix} 10 & 0 \\\\ 8 & 0 \\end{pmatrix} = \\begin{pmatrix} -10 & 1 \\\\ -12 & -3 \\end{pmatrix} $$\n观测器的特征多项式为 $\\det(sI - A_o) = \\det\\begin{pmatrix} s+10 & -1 \\\\ 12 & s+3 \\end{pmatrix} = (s+10)(s+3) + 12 = s^2 + 13s + 30 + 12 = s^2 + 13s + 42$。\n\n$G_{v \\to y}(s)$ 的分母是这两个特征多项式的乘积：\n$$ D(s) = (s^2 + 7s + 10)(s^2 + 13s + 42) = s^4 + 20s^3 + 143s^2 + 424s + 420 $$\n分子是 $N(s) = -C \\cdot \\text{adj}(sI - A_c) \\cdot BK \\cdot \\text{adj}(sI - A_o) \\cdot L$。矩阵乘积必须按顺序计算。\n$$ \\text{adj}(sI - A_c) = \\begin{pmatrix} s+7 & 1 \\\\ -10 & s \\end{pmatrix} $$\n$$ \\text{adj}(sI - A_o) = \\begin{pmatrix} s+3 & 1 \\\\ -12 & s+10 \\end{pmatrix} $$\n我们逐步计算分子 $N(s) = -C \\left[ \\text{adj}(sI - A_c) BK \\text{adj}(sI - A_o) \\right] L$。\n首先计算 $\\text{adj}(sI - A_c) \\cdot BK$：\n$$ \\begin{pmatrix} s+7 & 1 \\\\ -10 & s \\end{pmatrix} \\begin{pmatrix} 0 & 0 \\\\ 6 & 4 \\end{pmatrix} = \\begin{pmatrix} 6 & 4 \\\\ 6s & 4s \\end{pmatrix} $$\n接着与 $\\text{adj}(sI - A_o)$ 相乘：\n$$ \\begin{pmatrix} 6 & 4 \\\\ 6s & 4s \\end{pmatrix} \\begin{pmatrix} s+3 & 1 \\\\ -12 & s+10 \\end{pmatrix} = \\begin{pmatrix} 6(s+3)-48 & 6+4(s+10) \\\\ 6s(s+3)-48s & 6s+4s(s+10) \\end{pmatrix} = \\begin{pmatrix} 6s-30 & 4s+46 \\\\ 6s^2-30s & 4s^2+46s \\end{pmatrix} $$\n现在，将整个链式乘积组合起来：\n$$ N(s) = - C \\begin{pmatrix} 6s-30 & 4s+46 \\\\ 6s^2-30s & 4s^2+46s \\end{pmatrix} L = -\\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 6s-30 & 4s+46 \\\\ \\dots & \\dots \\end{pmatrix} \\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix} $$\n$$ N(s) = -\\begin{pmatrix} 6s-30 & 4s+46 \\end{pmatrix} \\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix} = - \\big( 10(6s-30) + 8(4s+46) \\big) $$\n$$ N(s) = - (60s - 300 + 32s + 368) = -(92s+68) $$\n因此，传递函数是：\n$$ G_{v \\to y}(s) = \\frac{-(92s+68)}{s^4 + 20s^3 + 143s^2 + 424s + 420} $$\n\n对于问题的第二部分，我们分析这个表达式。传递函数在分子的根处有一个有限零点 $s_z$，即 $92s_z + 68 = 0$，解得 $s_z = -68/92 = -17/23$。\n这个零点在原始对象中不存在，原始对象的传递函数为 $P(s) = C(sI-A)^{-1}B = \\frac{1}{s^2+3s+4}$，且没有有限零点。该零点是由控制器-观测器组合引入的。\n$G_{v \\to y}(s)$ 的零点是动态补偿器传递函数 $C_K(s) = U(s)/Y_m(s)$ 的零点，该函数将测量输出 $y_m$ 映射到控制输入 $u$。这个补偿器的分子多项式是 $-K \\cdot \\text{adj}(sI - A + BK + LC) \\cdot L$。我们对此分子的显式计算结果是 $N(s) = -(92s+68)$。我们可以看到它的系数取决于来自 $K$ 和 $L$ 的增益元素的复杂组合。因此，这个零点的位置可以通过选择观测器增益矩阵 $L$ 来直接操控，尽管它也依赖于 $K$。改变 $L$ 会重塑补偿器的分子多项式，从而移动从测量噪声到对象输出的传输零点。", "answer": "$$ \\boxed{\\frac{-92s-68}{s^4 + 20s^3 + 143s^2 + 424s + 420}} $$", "id": "2755436"}, {"introduction": "在探讨了观测器设计如何影响跟踪性能和噪声抑制后，我们进入最后一个实践，从‘观测器如何工作’的性能层面，转向‘观测器需要观测什么’的结构层面。本练习将指导你使用卡尔曼分解来剖析一个给定的线性系统。通过辨识系统的可控、可观、不可控和不可观子空间，你将确定出决定系统输入-输出行为的最小核心，并由此推断出实现等效闭环性能所需的最低阶观测器。[@problem_id:2755429]", "problem": "考虑一个线性时不变 (LTI) 对象，其状态空间实现由状态向量 $x \\in \\mathbb{R}^{5}$、输入 $u \\in \\mathbb{R}$ 和输出 $y \\in \\mathbb{R}$ 给出：\n$$\nA \\;=\\; \\begin{bmatrix}\n0 & 1 & 0 & 0 & 0\\\\\n-2 & -3 & 0 & 0 & 0\\\\\n0 & 0 & -1 & 0 & 0\\\\\n0 & 0 & 0 & -4 & 0\\\\\n0 & 0 & 0 & 0 & -5\n\\end{bmatrix},\\quad\nB \\;=\\; \\begin{bmatrix}\n0\\\\\n1\\\\\n1\\\\\n0\\\\\n0\n\\end{bmatrix},\\quad\nC \\;=\\; \\begin{bmatrix}\n1 & 0 & 0 & 1 & 0\n\\end{bmatrix},\\quad\nD \\;=\\; 0.\n$$\n要求您确定能够保持所有涉及该对象测量输出 $y$ 和施加输入 $u$ 的闭环传递映射的最小观测器阶数。按以下步骤进行：\n- 从能控性与能观性子空间的定义出发，通过辨识状态的能控能观、能控不能观、不能控能观以及不能控不能观分量，对该对象进行 Kalman 分解。\n- 仅使用基本定义，确定哪些状态分量对 $u$ 和 $y$ 之间的输入-输出传递行为有贡献。\n- 基于您的分解，确定能够保持所有外部信号为 $y$ 和 $u$ 的闭环传递映射的最小观测器阶数。\n\n您的最终答案必须是等于此最小观测器阶数的单个整数。无需四舍五入，不涉及单位。请按要求提供最终答案。", "solution": "所述问题定义明确、内容自洽，并基于线性控制理论的基本原理。这是一个有效的问题，我们将着手求解。\n\n问题的核心在于对状态空间 $\\mathbb{R}^{n}$ (其中 $n=5$) 进行 Kalman 分解。此分解根据能控性和能观性将状态空间划分为四个正交子空间：\n1. 能控且能观子空间，$X_{co}$。\n2. 能控但不能观子空间，$X_{c\\bar{o}}$。\n3. 不能控但能观子空间，$X_{\\bar{c}o}$。\n4. 不能控且不能观子空间，$X_{\\bar{c}\\bar{o}}$。\n\n将输入 $u$ 映射到输出 $y$ 的传递函数，由 $G(s) = C(sI-A)^{-1}B + D$ 给出，其完全由能控能观子空间 $X_{co}$ 的动态特性决定。$G(s)$ 的最小状态空间实现的阶数，即 McMillan 阶，等于 $X_{co}$ 的维数。\n\n问题要求的是能够保持所有涉及输入 $u$ 和输出 $y$ 的闭环传递映射的最小观测器阶数。任何旨在塑造输入-输出行为的控制器，都只能基于系统的最小实现来设计。要使用基于观测器的反馈结构来实现这样的控制器，必须估计该最小实现的状态。因此，此类观测器所需的最小阶数是能控能观子空间的维数，即 $\\dim(X_{co})$。\n\n我们的任务是求出这个维数。我们首先分析系统的能控性和能观性。状态矩阵 $A$ 以及输入和输出矩阵 $B$ 和 $C$ 如下所示：\n$$\nA \\;=\\; \\begin{bmatrix}\n0 & 1 & 0 & 0 & 0\\\\\n-2 & -3 & 0 & 0 & 0\\\\\n0 & 0 & -1 & 0 & 0\\\\\n0 & 0 & 0 & -4 & 0\\\\\n0 & 0 & 0 & 0 & -5\n\\end{bmatrix},\\quad\nB \\;=\\; \\begin{bmatrix}\n0\\\\\n1\\\\\n1\\\\\n0\\\\\n0\n\\end{bmatrix},\\quad\nC \\;=\\; \\begin{bmatrix}\n1 & 0 & 0 & 1 & 0\n\\end{bmatrix}\n$$\n矩阵 $A$ 是块对角矩阵。这种结构允许我们对能控性和能观性进行模态分析。让我们将状态向量定义为 $x = [x_1, x_2, x_3, x_4, x_5]^T$。该系统可以分解为与 $A$ 矩阵的块相对应的四个子系统：\n子系统 1：状态 $(x_1, x_2)$。\n$A_1 = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix}$， $B_1 = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$， $C_1 = \\begin{bmatrix} 1 & 0 \\end{bmatrix}$。\n子系统 2：状态 $x_3$。\n$A_2 = [-1]$，$B_2 = [1]$，$C_2 = [0]$。\n子系统 3：状态 $x_4$。\n$A_3 = [-4]$，$B_3 = [0]$，$C_3 = [1]$。\n子系统 4：状态 $x_5$。\n$A_4 = [-5]$，$B_4 = [0]$，$C_4 = [0]$。\n\n首先，我们确定能控子空间 $\\mathcal{R}(\\mathcal{C})$，它是与能控子系统相对应的状态所张成的空间。\n- 对于子系统 1，能控性矩阵为 $\\mathcal{C}_1 = [B_1 \\ A_1B_1] = \\begin{bmatrix} 0 & 1 \\\\ 1 & -3 \\end{bmatrix}$。由于 $\\det(\\mathcal{C}_1) = -1 \\neq 0$，该子系统是能控的。状态 $x_1$ 和 $x_2$ 是能控的。\n- 对于子系统 2，我们有一个标量系统，其 $B_2 = 1 \\neq 0$。该子系统是能控的。状态 $x_3$ 是能控的。\n- 对于子系统 3，$B_3 = 0$。该子系统是不能控的。状态 $x_4$ 是不能控的。\n- 对于子系统 4，$B_4 = 0$。该子系统是不能控的。状态 $x_5$ 是不能控的。\n因此，能控子空间由与能控状态相对应的基向量张成：\n$\\mathcal{R}(\\mathcal{C}) = \\text{span}\\{e_1, e_2, e_3\\}$，其中 $e_i$ 是 $\\mathbb{R}^{5}$ 中的第 $i$ 个标准基向量。能控子空间的维数是 $3$。\n\n接下来，我们确定能观子空间，它是不能观子空间 $\\mathcal{N}(\\mathcal{O})$ 的正交补。我们分析每个子系统的能观性。\n- 对于子系统 1，能观性矩阵为 $\\mathcal{O}_1 = \\begin{bmatrix} C_1 \\\\ C_1A_1 \\end{bmatrix} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}$。由于 $\\det(\\mathcal{O}_1) = 1 \\neq 0$，该子系统是能观的。状态 $x_1$ 和 $x_2$ 是能观的。\n- 对于子系统 2，$C_2 = 0$。该子系统是不能观的。状态 $x_3$ 是不能观的。\n- 对于子系统 3，我们有一个标量系统，其 $C_3 = 1 \\neq 0$。该子系统是能观的。状态 $x_4$ 是能观的。\n- 对于子系统 4，$C_4 = 0$。该子系统是不能观的。状态 $x_5$ 是不能观的。\n不能观子空间由与不能观状态相对应的基向量张成：\n$\\mathcal{N}(\\mathcal{O}) = \\text{span}\\{e_3, e_5\\}$。\n能观子空间是其正交补，$\\mathcal{R}(\\mathcal{O}^T) = \\mathcal{N}(\\mathcal{O})^\\perp = \\text{span}\\{e_1, e_2, e_4\\}$。能观子空间的维数是 $3$。\n\n现在我们通过求这些子空间的交集来进行 Kalman 分解。\n- 能控且能观子空间为 $X_{co} = \\mathcal{R}(\\mathcal{C}) \\cap \\mathcal{R}(\\mathcal{O}^T) = \\text{span}\\{e_1, e_2, e_3\\} \\cap \\text{span}\\{e_1, e_2, e_4\\} = \\text{span}\\{e_1, e_2\\}$。\n- 能控但不能观子空间为 $X_{c\\bar{o}} = \\mathcal{R}(\\mathcal{C}) \\cap \\mathcal{N}(\\mathcal{O}) = \\text{span}\\{e_1, e_2, e_3\\} \\cap \\text{span}\\{e_3, e_5\\} = \\text{span}\\{e_3\\}$。\n- 不能控但能观子空间为 $X_{\\bar{c}o} = \\mathcal{R}(\\mathcal{C})^\\perp \\cap \\mathcal{R}(\\mathcal{O}^T) = \\text{span}\\{e_4, e_5\\} \\cap \\text{span}\\{e_1, e_2, e_4\\} = \\text{span}\\{e_4\\}$。\n- 不能控且不能观子空间为 $X_{\\bar{c}\\bar{o}} = \\mathcal{R}(\\mathcal{C})^\\perp \\cap \\mathcal{N}(\\mathcal{O}) = \\text{span}\\{e_4, e_5\\} \\cap \\text{span}\\{e_3, e_5\\} = \\text{span}\\{e_5\\}$。\n\n能控且能观子空间的维数是 $\\dim(X_{co}) = 2$。\n如前所述，该维数对应于系统传递函数 $G(s)$ 的 McMillan 阶，并代表了最小实现的阶数。为实现任何基于 I/O 的控制器而设计的最小阶观测器必须估计此最小实现的状态。\n\n因此，保持所有涉及 $u$ 和 $y$ 的闭环传递映射的最小观测器阶数等于能控且能观子空间的维数。\n$\\text{最小观测器阶数} = \\dim(X_{co}) = 2$。", "answer": "$$\\boxed{2}$$", "id": "2755429"}]}