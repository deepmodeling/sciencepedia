{"hands_on_practices": [{"introduction": "理论是优雅的，但真正的理解来自于实践。这个练习将带你亲手应用状态反馈与状态估计之间的对偶原理。我们将一个熟悉的问题——通过极点配置设计状态反馈控制器——转化为其对偶问题，即设计一个状态观测器。通过完成这个练习 [@problem_id:2693646]，你将巩固对偶性如何作为一个强大的工具，将一个领域的设计方法直接映射到另一个领域，从而简化看似不同的设计任务。", "problem": "考虑一个线性时不变系统，其状态空间模型由$\\dot{x} = A x + B u$和$y = C x$给出，其中$A \\in \\mathbb{R}^{n \\times n}$，$B \\in \\mathbb{R}^{n \\times m}$且$C \\in \\mathbb{R}^{p \\times n}$。假设系统对$(A,B)$是可控的，对$(A,C)$是可观的。在$u = -K x$的状态反馈控制问题中，对于单输入情况，一种设计$K$的标准方法是选择$K$，使得$A - B K$的特征多项式通过系数匹配与一个期望的首一多项式相符，从而根据所选多项式保证闭环稳定性和暂态性能。\n\n任务：\n1. 在状态估计问题$\\dot{\\hat{x}} = A \\hat{x} + B u + L(y - C \\hat{x})$中，利用对偶原理，为观测器增益$L$构建对偶估计方法。明确地将估计器增益$L$与一个在适当的对偶系统上使用相同系数匹配原理计算出的状态反馈增益联系起来。\n\n2. 将您构建的对偶方法应用于以下特定系统，并验证其正确性：\n   - 设$A = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix}$，$B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$且$C = \\begin{bmatrix} 1 & 0 \\end{bmatrix}$。\n   - 使用基于特征多项式匹配的状态反馈控制设计，将控制器极点配置在$s = -2$和$s = -5$。\n   - 使用您的对偶估计器设计方法，将观测器误差动态极点配置在$s = -6$和$s = -7$。\n   - 验证所设计的估计器增益$L$能够使观测器误差动态$\\dot{e} = (A - L C) e$具有指定的极点，并且在输出反馈律$u = -K \\hat{x}$下，整体闭环增广系统表现出分离结构，其特征值是控制器极点和观测器极点的并集。\n\n将您的最终答案表示为估计器增益$L$的条目排列成的单个行向量，即，按顺序将$L$的分量列为一个行矩阵。不需要四舍五入，也不涉及单位。最终答案必须仅为该行向量。", "solution": "该问题表述清晰，并基于线性控制理论的基本原理，特别是关于状态空间设计方法。问题是完整的、一致的，并且需要应用对偶原理这一标准且可验证的概念。因此，该问题是有效的，我将着手解决它。\n\n根据要求，解答分为两部分。首先，给出对偶估计方法的理论构建。其次，将此方法应用于给定系统，并验证结果。\n\n**1. 观测器增益的对偶构建**\n\n对于线性时不变系统$\\dot{x} = A x + B u$的状态反馈控制问题，其目标是找到一个状态反馈增益矩阵$K$，使得控制律$u = -K x$将闭环系统矩阵$A - B K$的特征值配置在复平面上的期望位置。闭环系统的特征多项式由$\\det(sI - (A - B K))$给出。当且仅当系统对$(A, B)$可控时，这种极点配置才可能实现。\n\n状态估计问题，或称观测器设计问题，是利用系统输出$y$来构建对状态$x$的估计$\\hat{x}$。Luenberger 观测器由动态方程$\\dot{\\hat{x}} = A \\hat{x} + B u + L(y - C \\hat{x})$描述，其中$L$是观测器增益矩阵。状态估计误差定义为$e = x - \\hat{x}$。此误差的动态方程通过将观测器动态方程从系统动态方程中减去得到：\n$$ \\dot{e} = \\dot{x} - \\dot{\\hat{x}} = (A x + B u) - (A \\hat{x} + B u + L(C x - C \\hat{x})) = A(x - \\hat{x}) - L C (x - \\hat{x}) = (A - L C)e $$\n观测器设计的目标是选择$L$，使得误差$e(t)$收敛到零。这可以通过将误差动态矩阵$A - L C$的特征值配置在期望的稳定位置来实现。误差动态的特征多项式是$\\det(sI - (A - L C))$。当且仅当系统对$(A, C)$可观时，这种极点配置才可能实现。\n\n控制理论中的对偶原理将状态反馈问题与观测器设计问题联系起来。一个矩阵的特征值与其转置矩阵的特征值相同。因此，$A - L C$的特征值与$(A - L C)^T = A^T - C^T L^T$的特征值相同。\n\n现在，考虑一个由状态空间对$(A_{dual}, B_{dual}) = (A^T, C^T)$描述的“对偶”系统。对于此对偶系统，状态反馈极点配置问题是找到一个增益$K_{dual}$，使得对偶闭环矩阵$A_{dual} - B_{dual} K_{dual} = A^T - C^T K_{dual}$的特征值位于期望位置。\n\n通过比较观测器误差特征方程的矩阵$A^T - C^T L^T$和对偶控制问题的矩阵$A^T - C^T K_{dual}$，我们建立了一个直接的对应关系。如果我们设置观测器增益$L$使得$L^T = K_{dual}$，那么观测器极点（$A - L C$的特征值）将与对偶系统的闭环极点（$A^T - C^T K_{dual}$的特征值）完全相同。\n\n因此，对偶估计方法如下：\n要找到使$(A - L C)$的特征值位于期望位置集合$\\{p_1, \\dots, p_n\\}$的观测器增益$L$，可以为对偶系统$(A^T, C^T)$求解等效的状态反馈极点配置问题。也就是说，找到反馈增益$K_{dual}$，使$(A^T - C^T K_{dual})$的特征值位于相同的位置集合$\\{p_1, \\dots, p_n\\}$。所需的观测器增益则由$L = K_{dual}^T$给出。\n\n存在这样的$K_{dual}$的条件是系统对$(A^T, C^T)$必须是可控的。线性系统的一个基本定理指出，系统对$(A, C)$可观当且仅当系统对$(A^T, C^T)$可控。这证实了对偶原理的一致性。\n\n**2. 应用与验证**\n\n给定系统矩阵如下：\n$$ A = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1 & 0 \\end{bmatrix} $$\n\n首先，作为准备步骤，我们设计状态反馈控制器增益$K = \\begin{bmatrix} k_1 & k_2 \\end{bmatrix}$，将极点配置在$s = -2$和$s = -5$。期望的特征多项式为$p_c(s) = (s+2)(s+5) = s^2 + 7s + 10$。\n闭环矩阵为$A - BK$：\n$$ A - BK = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix} - \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} k_1 & k_2 \\end{bmatrix} = \\begin{bmatrix} 0 & 1 \\\\ -2 - k_1 & -3 - k_2 \\end{bmatrix} $$\n其特征多项式为$\\det(sI - (A-BK)) = s(s+3+k_2) - (-(2+k_1)) = s^2 + (3+k_2)s + (2+k_1)$。\n与$s^2 + 7s + 10$进行系数匹配：\n$3+k_2 = 7 \\implies k_2 = 4$。\n$2+k_1 = 10 \\implies k_1 = 8$。\n因此，控制器增益为$K = \\begin{bmatrix} 8 & 4 \\end{bmatrix}$。\n\n接下来，我们使用对偶方法设计观测器增益$L$。期望的观测器误差极点位于$s = -6$和$s = -7$。期望的观测器特征多项式为$p_o(s) = (s+6)(s+7) = s^2 + 13s + 42$。\n我们构建对偶系统$(A^T, C^T)$：\n$$ A^T = \\begin{bmatrix} 0 & -2 \\\\ 1 & -3 \\end{bmatrix}, \\quad C^T = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} $$\n我们寻求一个对偶反馈增益$K_{dual} = \\begin{bmatrix} k_{d1} & k_{d2} \\end{bmatrix}$，将对偶系统的极点配置在$s = -6$和$s = -7$。\n对偶闭环矩阵为$A^T - C^T K_{dual}$：\n$$ A^T - C^T K_{dual} = \\begin{bmatrix} 0 & -2 \\\\ 1 & -3 \\end{bmatrix} - \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} \\begin{bmatrix} k_{d1} & k_{d2} \\end{bmatrix} = \\begin{bmatrix} -k_{d1} & -2-k_{d2} \\\\ 1 & -3 \\end{bmatrix} $$\n其特征多项式为$\\det(sI - (A^T-C^T K_{dual})) = (s+k_{d1})(s+3) - (-(2+k_{d2})) = s^2 + (3+k_{d1})s + (3k_{d1} + 2 + k_{d2})$。\n与$p_o(s) = s^2 + 13s + 42$进行系数匹配：\n$s^1$: $3+k_{d1} = 13 \\implies k_{d1} = 10$。\n$s^0$: $3k_{d1} + 2 + k_{d2} = 42 \\implies 3(10) + 2 + k_{d2} = 42 \\implies 32 + k_{d2} = 42 \\implies k_{d2} = 10$。\n对偶增益为$K_{dual} = \\begin{bmatrix} 10 & 10 \\end{bmatrix}$。\n观测器增益为$L = K_{dual}^T = \\begin{bmatrix} 10 \\\\ 10 \\end{bmatrix}$。\n\n**验证：**\n我们验证该增益$L$是否正确地配置了观测器极点。误差动态矩阵为$A-LC$：\n$$ A - LC = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix} - \\begin{bmatrix} 10 \\\\ 10 \\end{bmatrix} \\begin{bmatrix} 1 & 0 \\end{bmatrix} = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix} - \\begin{bmatrix} 10 & 0 \\\\ 10 & 0 \\end{bmatrix} = \\begin{bmatrix} -10 & 1 \\\\ -12 & -3 \\end{bmatrix} $$\n其特征多项式为$\\det(sI - (A-LC)) = \\det \\begin{bmatrix} s+10 & -1 \\\\ 12 & s+3 \\end{bmatrix} = (s+10)(s+3) - (-12) = s^2 + 13s + 30 + 12 = s^2 + 13s + 42$。\n该多项式的根为$s = -6$和$s = -7$，这正是期望的观测器极点。验证成功。\n\n最后，我们验证组合系统的分离原理，该系统使用基于估计状态的状态反馈$u = -K\\hat{x}$。包含原系统状态$x$和估计误差$e$的增广系统的状态方程为：\n$$ \\dot{x} = A x + B u = A x - B K \\hat{x} = A x - B K(x - e) = (A - B K)x + B K e $$\n$$ \\dot{e} = (A - L C)e $$\n写成矩阵形式为：\n$$ \\frac{d}{dt} \\begin{bmatrix} x \\\\ e \\end{bmatrix} = \\begin{bmatrix} A-BK & BK \\\\ 0 & A-LC \\end{bmatrix} \\begin{bmatrix} x \\\\ e \\end{bmatrix} $$\n该系统矩阵是块上三角矩阵。因此，其特征值集合是其对角块$A - BK$和$A - LC$的特征值的并集。$A-BK$的特征值是控制器极点$\\{-2, -5\\}$，$A-LC$的特征值是观测器极点$\\{-6, -7\\}$。完整的输出反馈系统的特征值确实是$\\{-2, -5, -6, -7\\}$。这证实了分离结构。\n\n所要求的最终答案是表示为行向量的估计器增益$L$。\n我们得到$L = \\begin{bmatrix} 10 \\\\ 10 \\end{bmatrix}$。对应的行向量是$\\begin{pmatrix} 10 & 10 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n10 & 10\n\\end{pmatrix}\n}\n$$", "id": "2693646"}, {"introduction": "知道如何放置观测器极点引出了一个更深层次的工程问题：我们应该把它们放在哪里？这个练习 [@problem_id:2748160] 引导我们超越纯粹的确定性设计，进入随机最优估计的世界。你将首先通过极点配置来设计一个观测器以满足特定的动态响应要求，然后，你将为同一个系统计算稳态卡尔曼滤波器增益，它在存在过程和测量噪声的情况下最小化了估计误差的方差。通过对比这两种方法，你将深刻体会到确定性性能规范与随机最优性之间的核心区别。", "problem": "考虑一个连续时间线性时不变系统，其状态空间矩阵为$A \\in \\mathbb{R}^{n \\times n}$和$C \\in \\mathbb{R}^{m \\times n}$。在静态输出注入增益$L \\in \\mathbb{R}^{n \\times m}$下，状态观测器误差动力学由矩阵$A - L C$控制。\n\n第1部分。仅从可观测性和可控性的定义以及Popov–Belevitch–Hautus检验出发，推导为什么对于任何可观测对$(A,C)$以及任何根严格位于开左半平面的首一多项式$p(\\lambda) = \\lambda^{n} + \\alpha_{n-1} \\lambda^{n-1} + \\cdots + \\alpha_{1} \\lambda + \\alpha_{0}$，都存在一个输出注入矩阵$L$，使得$A - L C$的特征多项式等于$p(\\lambda)$。您的推导必须从第一性原理和基本定义出发，不得引用现成的公式。\n\n第2部分。具体到以下二阶系统\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}.\n$$\n选择$A - L C$的期望特征值为$\\lambda_{1} = -2$和$\\lambda_{2} = -5$。通过直接计算$A - L C$的特征多项式并进行系数匹配，明确确定实现这些特征值的$L = \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix}$的各项。\n\n第3部分。对于第2部分中的同一系统，考虑随机状态空间模型\n$$\n\\dot{x}(t) = A x(t) + w(t), \\quad y(t) = C x(t) + v(t),\n$$\n其中$w(t)$为零均值白高斯过程噪声，$v(t)$为测量噪声，两者相互独立，其协方差为$\\mathbb{E}[w(t) w(\\tau)^{\\top}] = Q \\delta(t - \\tau)$和$\\mathbb{E}[v(t) v(\\tau)] = R \\delta(t - \\tau)$，其中\n$$\nQ = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\quad R = 1.\n$$\n通过求解误差协方差$P \\in \\mathbb{R}^{2 \\times 2}$的连续时间代数Riccati方程，并计算$L_{\\mathrm{KF}} = P C^{\\top} R^{-1}$，来计算稳态卡尔曼滤波器增益$L_{\\mathrm{KF}} \\in \\mathbb{R}^{2 \\times 1}$。然后，用文字对比第2部分中特征值配置增益与此处推导的稳态卡尔曼增益在概念基础上的差异。\n\n答案规范：将您的最终答案以行矩阵的形式报告，该矩阵包含四个条目$\\ell_{1}$、$\\ell_{2}$、$k_{1}$、$k_{2}$，其中$L = \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix}$是第2部分的特征值配置增益，$L_{\\mathrm{KF}} = \\begin{pmatrix} k_{1} \\\\ k_{2} \\end{pmatrix}$是第3部分的卡尔曼增益。请提供精确值，不要四舍五入。", "solution": "该问题已经过验证，被认为是良构的、科学上合理的和内部一致的。这是线性系统理论和最优估计中的一个标准问题。我们将开始进行解答。\n\n第1部分：观测器极点配置的推导\n目标是证明对于一个可观测对$(A,C)$，其中$A \\in \\mathbb{R}^{n \\times n}$和$C \\in \\mathbb{R}^{m \\times n}$，总能找到一个输出注入增益$L \\in \\mathbb{R}^{n \\times m}$，使得观测器误差动力学矩阵$A-LC$的特征多项式与任意指定的$n$次首一多项式$p(\\lambda)$相匹配。此性质被称为观测器的极点配置或极点分配。推导将依赖于控制理论中的对偶原理。\n\n观测器的极点是矩阵$A-LC$的特征值。$A-LC$的特征多项式由$\\det(\\lambda I - (A-LC))$给出。行列式的一个基本性质是，对于任何方阵$M$，都有$\\det(M) = \\det(M^{\\top})$。因此，$A-LC$的特征值与其转置$(A-LC)^{\\top} = A^{\\top} - C^{\\top}L^{\\top}$的特征值相同。\n\n我们定义一个“对偶”系统。对于由矩阵$(A, C)$控制的原系统，我们定义一个对偶系统，其状态矩阵为$A' = A^{\\top}$，输入矩阵为$B' = C^{\\top}$。我们还为该对偶系统定义一个状态反馈增益$K' = L^{\\top}$。此对偶系统在状态反馈下的闭环矩阵为$A' - B'K' = A^{\\top} - C^{\\top}L^{\\top}$。\n\n从这个构造中可以明显看出，寻找一个观测器增益$L$以将$A-LC$的特征值放置在期望位置的问题，在数学上等价于寻找一个状态反馈增益$K' = L^{\\top}$以将$A^{\\top} - C^{\\top}L^{\\top}$的特征值放置在相同位置的问题。后者是针对系统$(A', B') = (A^{\\top}, C^{\\top})$的标准状态反馈极点配置问题。\n\n控制理论的一个基石定理指出，当且仅当系统是可控的，通过状态反馈进行任意极点配置才是可能的。因此，如果我们能证明对偶系统$(A^{\\top}, C^{\\top})$是可控的，那么我们总能找到一个增益$K'$（并因此得到$L$）来实现任何期望的特征多项式。原系统的可观测性与对偶系统的可控性之间的联系是通过Popov–Belevitch–Hautus (PBH) 检验建立的。\n\n可观测性的PBH检验指出，当且仅当对于所有复数$\\lambda \\in \\mathbb{C}$，矩阵\n$$\n\\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix}\n$$\n具有满列秩$n$时，对$(A, C)$才是可观测的。\n\n问题陈述假定对$(A,C)$是可观测的。因此，对于任何$\\lambda \\in \\mathbb{C}$，\n$$\n\\mathrm{rank} \\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix} = n.\n$$\n由于一个矩阵的秩等于其转置的秩，我们有\n$$\n\\mathrm{rank} \\left( \\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix}^{\\top} \\right) = \\mathrm{rank} \\begin{pmatrix} (A - \\lambda I)^{\\top} & C^{\\top} \\end{pmatrix} = \\mathrm{rank} \\begin{pmatrix} A^{\\top} - \\lambda I & C^{\\top} \\end{pmatrix} = n.\n$$\n这最后一个条件，$\\mathrm{rank} \\begin{pmatrix} A^{\\top} - \\lambda I & C^{\\top} \\end{pmatrix} = n$对于所有$\\lambda \\in \\mathbb{C}$成立，正是对$(A^{\\top}, C^{\\top})$可控性的PBH检验。\n\n因此，如果对$(A,C)$是可观测的，则对$(A^{\\top}, C^{\\top})$是可控的。根据状态反馈极点配置定理，对于一个可控系统，可以找到一个增益矩阵$K'$，将闭环系统$A^{\\top}-C^{\\top}K'$的特征值分配到任何期望的位置集合。这些位置是指定的首一多项式$p(\\lambda)$的根。通过设置$K'=L^{\\top}$，我们找到了将观测器动力学矩阵$A-LC$的极点放置在这些相同位置的观测器增益$L$。要求$p(\\lambda)$的根位于开左半平面确保了观测器的稳定性，这是实际目标。至此，推导完成。\n\n第2部分：特征值配置增益的计算\n我们得到系统矩阵为\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}.\n$$\n输出注入增益为$L = \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix}$。矩阵$A-LC$计算如下：\n$$\nA - LC = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix} - \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix} - \\begin{pmatrix} \\ell_{1} & 0 \\\\ \\ell_{2} & 0 \\end{pmatrix} = \\begin{pmatrix} -\\ell_{1} & 1 \\\\ -\\ell_{2} & 0 \\end{pmatrix}.\n$$\n$A-LC$的特征多项式为\n$$\n\\det(\\lambda I - (A-LC)) = \\det \\begin{pmatrix} \\lambda + \\ell_{1} & -1 \\\\ \\ell_{2} & \\lambda \\end{pmatrix} = \\lambda(\\lambda + \\ell_{1}) - (-1)(\\ell_{2}) = \\lambda^{2} + \\ell_{1}\\lambda + \\ell_{2}.\n$$\n期望的特征值为$\\lambda_{1} = -2$和$\\lambda_{2} = -5$。期望的特征多项式为\n$$\np(\\lambda) = (\\lambda - \\lambda_{1})(\\lambda - \\lambda_{2}) = (\\lambda + 2)(\\lambda + 5) = \\lambda^{2} + 7\\lambda + 10.\n$$\n通过匹配计算出的特征多项式和期望的特征多项式的系数，我们得到：\n$$\n\\ell_{1} = 7, \\quad \\ell_{2} = 10.\n$$\n因此，所需的增益矩阵为$L = \\begin{pmatrix} 7 \\\\ 10 \\end{pmatrix}$。\n\n第3部分：稳态卡尔曼增益的计算与概念对比\n我们被告知过程噪声和测量噪声的协方差强度为$Q=I$和$R=1$。稳态卡尔曼滤波器增益$L_{\\mathrm{KF}}$由$L_{\\mathrm{KF}} = PC^{\\top}R^{-1}$给出，其中$P$是连续时间代数Riccati方程（CARE）的对称正定解：\n$$\nAP + PA^{\\top} - PC^{\\top}R^{-1}CP + Q = 0.\n$$\n令$P = \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix}$。代入给定的矩阵$A, C, Q, R$:\n$$\n\\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} + \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} \\begin{pmatrix} 0 & 0 \\\\ 1 & 0 \\end{pmatrix} - \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (1) \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}.\n$$\n计算每一项：\n$$\n\\begin{pmatrix} p_{12} & p_{22} \\\\ 0 & 0 \\end{pmatrix} + \\begin{pmatrix} p_{12} & 0 \\\\ p_{22} & 0 \\end{pmatrix} - \\begin{pmatrix} p_{11} \\\\ p_{12} \\end{pmatrix} \\begin{pmatrix} p_{11} & p_{12} \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} 2p_{12} & p_{22} \\\\ p_{22} & 0 \\end{pmatrix} - \\begin{pmatrix} p_{11}^{2} & p_{11}p_{12} \\\\ p_{11}p_{12} & p_{12}^{2} \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}.\n$$\n这个矩阵方程产生了一个关于$P$的各项的代数方程组：\n1. $2p_{12} - p_{11}^{2} + 1 = 0$\n2. $p_{22} - p_{11}p_{12} = 0$\n3. $-p_{12}^{2} + 1 = 0$\n\n从方程($3$)中，我们发现$p_{12}^{2} = 1$，这得到$p_{12} = \\pm 1$。为了保证稳定性，卡尔曼滤波器误差动力学矩阵$A - L_{\\mathrm{KF}}C = \\begin{pmatrix} -p_{11} & 1 \\\\ -p_{12} & 0 \\end{pmatrix}$的特征值必须位于开左半平面。其特征多项式为$\\lambda^{2} + p_{11}\\lambda + p_{12} = 0$。对于稳定的根，Routh-Hurwitz稳定性判据要求所有系数都为正。因此，我们必须有$p_{11} > 0$和$p_{12} > 0$。所以我们必须选择$p_{12} = 1$。\n\n将$p_{12}=1$代入方程($1$)：\n$$\n2(1) - p_{11}^{2} + 1 = 0 \\implies p_{11}^{2} = 3.\n$$\n由于我们要求$p_{11} > 0$，我们得到$p_{11} = \\sqrt{3}$。\n\n将$p_{11}=\\sqrt{3}$和$p_{12}=1$代入方程($2$)：\n$$\np_{22} - (\\sqrt{3})(1) = 0 \\implies p_{22} = \\sqrt{3}.\n$$\n稳态误差协方差为$P = \\begin{pmatrix} \\sqrt{3} & 1 \\\\ 1 & \\sqrt{3} \\end{pmatrix}$。我们验证该矩阵是正定的：$p_{11}=\\sqrt{3} > 0$且$\\det(P) = (\\sqrt{3})(\\sqrt{3}) - 1^{2} = 3-1=2>0$。\n\n那么，稳态卡尔曼增益$L_{\\mathrm{KF}}$为：\n$$\nL_{\\mathrm{KF}} = PC^{\\top}R^{-1} = \\begin{pmatrix} \\sqrt{3} & 1 \\\\ 1 & \\sqrt{3} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (1) = \\begin{pmatrix} \\sqrt{3} \\\\ 1 \\end{pmatrix}.\n$$\n令$L_{\\mathrm{KF}} = \\begin{pmatrix} k_{1} \\\\ k_{2} \\end{pmatrix}$，我们得到$k_{1} = \\sqrt{3}$和$k_{2} = 1$。\n\n概念对比：\n第2部分中的特征值配置增益$L$是确定性地选择的，旨在为观测器误差实现一个任意的、用户指定的动态响应。极点的选择（这里是$-2$和$-5$）由设计规范（如期望的镇定时间或阻尼）决定，但在其他方面是任意的。该方法完全忽略了系统的任何随机方面，例如过程噪声或测量噪声。\n\n与此形成鲜明对比的是，第3部分中的稳态卡尔曼增益$L_{\\mathrm{KF}}$并非任意的。它是在系统统计特性（即过程噪声协方差$Q$和测量噪声协方差$R$）的基础上，作为最小化状态估计误差方差的最优增益被唯一确定的。由此产生的观测器极点不是由设计者直接指定的，而是这种优化的结果。卡尔曼滤波器通过系统地平衡对系统模型的置信度与对测量的置信度，在均方意义上提供了最佳估计。极点配置方法强制实现一种期望的行为，而卡尔曼滤波器则从系统底层的随机现实中推导出一种最优行为。", "answer": "$$\n\\boxed{\\begin{pmatrix} 7 & 10 & \\sqrt{3} & 1 \\end{pmatrix}}\n$$", "id": "2748160"}, {"introduction": "在掌握了观测器设计技术之后，探索其固有的局限性至关重要。这个练习 [@problem_id:2729522] 提出了一个关键的现实问题：在存在未知扰动的情况下，我们是否总能设计出一个任意快速且不受扰动影响的观测器？通过分析一个具有右半平面零点的系统（即非最小相位系统），你将发现系统内在特性如何对状态估计的性能施加根本性的约束。这个思想实验揭示了为什么稳定地“抵消”某些扰动在物理上是不可能的，从而加深了你对控制理论中基本限制的理解。", "problem": "考虑一个具有未知输入的线性时不变（LTI）系统，由下式给出：\n$$\\dot{x}(t)=A\\,x(t)+E\\,w(t),\\qquad y(t)=C\\,x(t),$$\n其中，$x(t)\\in\\mathbb{R}^2$是状态，$y(t)\\in\\mathbb{R}$是测量输出，$w(t)\\in\\mathbb{R}$是一个未知扰动。设\n$$A=\\begin{bmatrix}0&1\\\\0&-1\\end{bmatrix},\\qquad E=\\begin{bmatrix}0\\\\1\\end{bmatrix},\\qquad C=\\begin{bmatrix}1&-1\\end{bmatrix}。$$\n一位设计者希望构建一个状态观测器，该观测器仅使用测量输出$y(t)$（并且无法获取$w(t)$）来生成$x(t)$的估计值$\\hat{x}(t)$，其估计误差$e(t)\\triangleq x(t)-\\hat{x}(t)$的动态是稳定的、任意快的，并且理想情况下独立于未知输入$w(t)$。\n\n仅使用基本定义和经过检验的公式，按如下方式推断这种观测器的可行性：\n- 从$w$到$y$的传递函数由$G(s)=C\\,(sI-A)^{-1}E$给出。\n- 一个能使估计误差动态任意快且对$w$不敏感的观测器，实际上将在任意大的带宽上实现扰动到输出通道的稳定左逆。\n\n下列哪个/哪些陈述是正确的？\n\nA. 因为矩阵对$(A,C)$是可观测的，所以存在一个形如$\\dot{\\hat{x}}=A\\hat{x}+L\\big(y-C\\hat{x}\\big)$的全阶 Luenberger 观测器，其误差动态$\\dot{e}=(A-LC)e$可以变得任意快且完全独立于$w(t)$。\n\nB. 对于此系统，传递函数$G(s)$在开右半平面有一个不变零点。因此，任何仅使用$y(t)$的线性时不变（LTI）观测器都无法实现既任意快又与$w(t)$解耦的估计误差动态，因为非最小相位通道的稳定左逆是不可能的；任何消除该右半平面零点的尝试都需要一个不稳定的内部极点。\n\nC. 降阶观测器通过将其极点放置在足够靠左的位置，从而超越零点动态，实现了任意快且对扰动不敏感的误差动态，避免了右半平面不变零点所施加的限制。\n\nD. 高增益输出注入使观测器误差动态任意快，且不损害内部稳定性，因为不变零点只约束反馈控制而不约束状态估计。\n\n选择所有正确选项。", "solution": "我们应首先对问题陈述进行严格验证。一个无效的前提会导致荒谬的结论，这是我们不能容忍的做法。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n- LTI系统状态方程：$\\dot{x}(t)=A\\,x(t)+E\\,w(t)$\n- LTI系统输出方程：$y(t)=C\\,x(t)$\n- 状态向量：$x(t)\\in\\mathbb{R}^2$\n- 测量输出：$y(t)\\in\\mathbb{R}$\n- 未知输入扰动：$w(t)\\in\\mathbb{R}$\n- 系统矩阵：$A=\\begin{bmatrix}0&1\\\\0&-1\\end{bmatrix}$， $E=\\begin{bmatrix}0\\\\1\\end{bmatrix}$， $C=\\begin{bmatrix}1&-1\\end{bmatrix}$\n- 设计目标：一个状态观测器，生成$x(t)$的估计$\\hat{x}(t)$，使得估计误差$e(t)\\triangleq x(t)-\\hat{x}(t)$具有稳定、任意快且独立于$w(t)$的动态。\n- 指导原则1：从$w$到$y$的传递函数是$G(s)=C\\,(sI-A)^{-1}E$。\n- 指导原则2：实现该目标等效于实现扰动到输出通道的稳定左逆。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题是在线性系统和控制理论的标准框架内提出的。所有术语都有定义，并且给出了矩阵。所引用的概念——可观测性、不变零点、传递函数和稳定逆——都是该领域中基本且公认的。问题要求在特定约束下推断状态观测器的可行性，这是观测器设计和鲁棒控制中的一个标准且有意义的问题。该问题具有科学依据，提法得当，且客观。它不包含任何矛盾、歧义或事实上的不健全之处。\n\n**步骤3：结论和行动**\n问题陈述有效。我们继续进行完整的推导和分析。\n\n**推导与分析**\n\n该问题涉及在存在未知输入的情况下状态估计的基本局限性。设计一个具有期望特性——稳定、任意快和扰动解耦的误差动态——的观测器的可行性，由系统关于扰动输入和测量输出的不变零点决定。这些零点是从扰动$w(t)$到输出$y(t)$的传递函数$G(s)$的零点。\n\n首先，我们计算这个传递函数$G(s) = C(sI-A)^{-1}E$。\n矩阵$(sI-A)$是：\n$$sI - A = s\\begin{bmatrix}1&0\\\\0&1\\end{bmatrix} - \\begin{bmatrix}0&1\\\\0&-1\\end{bmatrix} = \\begin{bmatrix}s&-1\\\\0&s+1\\end{bmatrix}$$\n它的逆是：\n$$(sI-A)^{-1} = \\frac{1}{\\det(sI-A)} \\text{adj}(sI-A) = \\frac{1}{s(s+1)} \\begin{bmatrix}s+1&1\\\\0&s\\end{bmatrix}$$\n现在，我们可以计算$G(s)$：\n$$G(s) = \\begin{bmatrix}1&-1\\end{bmatrix} \\left( \\frac{1}{s(s+1)} \\begin{bmatrix}s+1&1\\\\0&s\\end{bmatrix} \\right) \\begin{bmatrix}0\\\\1\\end{bmatrix}$$\n$$G(s) = \\frac{1}{s(s+1)} \\begin{bmatrix}1&-1\\end{bmatrix} \\begin{bmatrix}1\\\\s\\end{bmatrix}$$\n$$G(s) = \\frac{1-s}{s(s+1)}$$\n系统的不变零点是使传递函数分子为零的$s$值。从$1-s=0$，我们发现在$s=1$处有一个不变零点。\n\n这个零点位于开右半平面（RHP）。具有一个或多个RHP零点的系统称为**非最小相位系统**。这个位于$s=1$的RHP零点的存在，对任何LTI观测器的性能施加了根本性且不可逾越的限制。\n\n为了实现完全独立于扰动$w(t)$的误差动态，观测器必须有效地消除$w(t)$对输出$y(t)$的影响，以重构状态。这等效于对由$G(s)$描述的从$w$到$y$的通道进行求逆。如果可以构建一个理想的观测器，它将需要实现逆动态$G(s)^{-1}$。\n逆传递函数为：\n$$G(s)^{-1} = \\frac{s(s+1)}{1-s} = -\\frac{s(s+1)}{s-1}$$\n这个逆系统在$s=1$处有一个极点，该极点是不稳定的。因此，对扰动到输出通道进行稳定的左逆是不可能的。任何试图将估计误差与扰动$w(t)$完全解耦的LTI观测器都必须包含一个与此RHP零点对应的不稳定内部动态模式。这意味着误差动态不仅不能被做得“任意快”且稳定，它们甚至根本无法变得稳定。\n\n基于此，我们评估每个选项。\n\n**逐项分析**\n\n**A. 因为矩阵对$(A,C)$是可观测的，所以存在一个形如$\\dot{\\hat{x}}=A\\hat{x}+L\\big(y-C\\hat{x}\\big)$的全阶 Luenberger 观测器，其误差动态$\\dot{e}=(A-LC)e$可以变得任意快且完全独立于$w(t)$。**\n$(A,C)$的可观测性通过可观测性矩阵$\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\end{bmatrix} = \\begin{bmatrix} 1 & -1 \\\\ 0 & 2 \\end{bmatrix}$来检验，该矩阵为满秩2。所以$(A,C)$确实是可观测的。然而，标准Luenberger观测器的误差动态推导为$\\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t) = (Ax+Ew) - (A\\hat{x}+L(y-C\\hat{x})) = (A-LC)(x-\\hat{x})+Ew = (A-LC)e(t)+Ew(t)$。由于$E \\neq 0$，误差动态明确地依赖于$w(t)$。对于这种观测器结构，该陈述关于独立于$w(t)$的说法是错误的。\n结论：**错误**。\n\n**B. 对于此系统，传递函数$G(s)$在开右半平面有一个不变零点。因此，任何仅使用$y(t)$的线性时不变（LTI）观测器都无法实现既任意快又与$w(t)$解耦的估计误差动态，因为非最小相位通道的稳定左逆是不可能的；任何消除该右半平面零点的尝试都需要一个不稳定的内部极点。**\n我们的推导表明，传递函数$G(s)$在$s=1$处有一个不变零点，该零点位于开RHP中。接下来的推理正是对此类零点所施加的性能限制的标准、正确解释。稳定的逆是不可能的，因为逆系统是不稳定的。任何LTI观测器，无论其具体形式（全阶、降阶等），都受到这一基本限制。因此，同时实现稳定性、任意速度和扰动解耦是不可能的。该陈述完全符合基本的控制理论。\n结论：**正确**。\n\n**C. 降阶观测器通过将其极点放置在足够靠左的位置，从而超越零点动态，实现了任意快且对扰动不敏感的误差动态，避免了右半平面不变零点所施加的限制。**\n这个陈述是荒谬的。$s=1$处的不变零点是系统$(A,E,C)$的一个基本属性，而不是观测器选择的产物。降阶观测器仍然是一个LTI系统，不能神奇地绕过这一限制。“超越”一个不稳定的零点动态的说法是一种谬论；与$s=1$处的零点相关的不稳定模式无法通过移动其他极点来稳定或使其无关紧要。\n结论：**错误**。\n\n**D. 高增益输出注入使观测器误差动态任意快，且不损害内部稳定性，因为不变零点只约束反馈控制而不约束状态估计。**\n声称不变零点仅约束反馈控制而不约束状态估计的说法是明显错误的。控制与估计之间的对偶性原理指出，一个领域的限制在另一个领域有相应的限制。具体来说，RHP不变零点是存在扰动时状态估计的一个众所周知的关键限制，正如它们对于反馈控制中设定点跟踪的限制一样。在非最小相位系统中尝试高增益估计可能导致严重问题，包括“峰值现象”和潜在的不稳定性，这直接与不损害稳定性的说法相矛盾。\n结论：**错误**。", "answer": "$$\\boxed{B}$$", "id": "2729522"}]}