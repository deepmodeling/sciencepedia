{"hands_on_practices": [{"introduction": "可观测性格拉姆矩阵不仅是一个理论构造，它还为我们提供了分析系统实际属性的有力代数工具。这个练习 [@problem_id:2728907] 将引导你通过计算一个特定系统的格拉姆矩阵，并直接从其代数性质（即它的零空间 $\\operatorname{ker}(W_{o})$）来确定系统的不可观测子空间。这有助于你直观地理解格拉姆矩阵的奇异性与系统状态不可观测性之间的深刻联系。", "problem": "考虑一个连续时间线性时不变（LTI）系统，其状态矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 和输出矩阵 $C \\in \\mathbb{R}^{1 \\times 3}$ 由下式给出：\n$$\nA = \\begin{pmatrix}\n-1 & 0 & 0 \\\\[4pt]\n0 & -2 & 0 \\\\[4pt]\n0 & 0 & -3\n\\end{pmatrix}, \n\\qquad\nC = \\begin{pmatrix}\n1 & 1 & 0\n\\end{pmatrix}.\n$$\n从赫尔维茨矩阵 $A$ 的无穷时域可观测性格拉姆矩阵的定义出发，推导矩阵对 $(C,A)$ 的可观测性格拉姆矩阵 $W_{o} \\in \\mathbb{R}^{3 \\times 3}$ 的显式表达式。然后：\n- 从基本原理出发，论证为何 $W_{o}$ 是半正定（PSD）的，并判断其是否为奇异矩阵。\n- 仅使用可观测性格拉姆矩阵的基本定义及其推导出的性质，通过刻画 $\\operatorname{ker}(W_{o})$ 并验证其在 $A$ 下的不变性，来确定 $(C,A)$ 的不可观测子空间。\n- 将最终答案表示为张成该不可观测子空间的单个非零单位范数列向量。如果存在多个有效选项，选择第一个非零元素为正的那个。\n\n无需四舍五入。以单个列向量的形式提供最终答案。不包含任何单位。", "solution": "首先对问题陈述进行验证。问题提供了一个由状态矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 和输出矩阵 $C \\in \\mathbb{R}^{1 \\times 3}$ 指定的连续时间线性时不变（LTI）系统，具体如下：\n$$A = \\begin{pmatrix} -1 & 0 & 0 \\\\ 0 & -2 & 0 \\\\ 0 & 0 & -3 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 1 & 0 \\end{pmatrix}.$$\n矩阵 $A$ 是一个对角矩阵，其特征值为其对角元素：$\\lambda_1 = -1$，$\\lambda_2 = -2$，以及 $\\lambda_3 = -3$。由于所有特征值都具有负实部，矩阵 $A$ 是赫尔维茨的。这是无穷时域可观测性格拉姆矩阵 $W_o$ 作为李雅普诺夫方程 $A^T W_o + W_o A = -C^T C$ 的唯一解存在的条件。该问题在科学上是成立的、适定的、客观且完整的。所有提供的数据和要求的步骤都是控制理论中的标准内容。因此，该问题是有效的，我们可以继续进行求解。\n\n对于一个稳定的LTI系统，无穷时域可观测性格拉姆矩阵 $W_o$ 由以下积分定义：\n$$W_o = \\int_{0}^{\\infty} e^{A^T \\tau} C^T C e^{A \\tau} \\,d\\tau.$$\n首先，我们计算被积函数的各组成部分。由于矩阵 $A$ 是对角矩阵，其状态转移矩阵 $e^{At}$ 也是对角矩阵：\n$$e^{At} = \\begin{pmatrix} e^{-t} & 0 & 0 \\\\ 0 & e^{-2t} & 0 \\\\ 0 & 0 & e^{-3t} \\end{pmatrix}.$$\n由于 $A$ 是一个对称矩阵（$A = A^T$），我们有 $e^{A^T t} = e^{At}$。矩阵 $C^T C$ 由下式给出：\n$$C^T C = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1 & 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 1 & 0 \\\\ 1 & 1 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}.$$\n积分内的项是 $e^{A^T t} C^T C e^{At}$。我们也可以将其写为 $(C e^{At})^T (C e^{At})$。让我们先计算乘积 $C e^{At}$：\n$$C e^{At} = \\begin{pmatrix} 1 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} e^{-t} & 0 & 0 \\\\ 0 & e^{-2t} & 0 \\\\ 0 & 0 & e^{-3t} \\end{pmatrix} = \\begin{pmatrix} e^{-t} & e^{-2t} & 0 \\end{pmatrix}.$$\n现在我们计算被积函数：\n$$(C e^{At})^T (C e^{At}) = \\begin{pmatrix} e^{-t} \\\\ e^{-2t} \\\\ 0 \\end{pmatrix} \\begin{pmatrix} e^{-t} & e^{-2t} & 0 \\end{pmatrix} = \\begin{pmatrix} e^{-2t} & e^{-3t} & 0 \\\\ e^{-3t} & e^{-4t} & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}.$$\n为了求得 $W_o$，我们对该矩阵从 $\\tau=0$ 到 $\\tau=\\infty$ 进行逐元素积分：\n$$W_o = \\int_{0}^{\\infty} \\begin{pmatrix} e^{-2\\tau} & e^{-3\\tau} & 0 \\\\ e^{-3\\tau} & e^{-4\\tau} & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} d\\tau.$$\n各个积分的计算如下：\n$$(W_o)_{11} = \\int_{0}^{\\infty} e^{-2\\tau} d\\tau = \\left[ -\\frac{1}{2}e^{-2\\tau} \\right]_0^\\infty = 0 - (-\\frac{1}{2}) = \\frac{1}{2}.$$\n$$(W_o)_{12} = (W_o)_{21} = \\int_{0}^{\\infty} e^{-3\\tau} d\\tau = \\left[ -\\frac{1}{3}e^{-3\\tau} \\right]_0^\\infty = 0 - (-\\frac{1}{3}) = \\frac{1}{3}.$$\n$$(W_o)_{22} = \\int_{0}^{\\infty} e^{-4\\tau} d\\tau = \\left[ -\\frac{1}{4}e^{-4\\tau} \\right]_0^\\infty = 0 - (-\\frac{1}{4}) = \\frac{1}{4}.$$\n其他元素为零。因此，可观测性格拉姆矩阵为：\n$$W_o = \\begin{pmatrix} \\frac{1}{2} & \\frac{1}{3} & 0 \\\\ \\frac{1}{3} & \\frac{1}{4} & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}.$$\n\n接下来，我们从基本原理出发论证为何 $W_o$ 是半正定的（PSD）。对于任意向量 $x \\in \\mathbb{R}^3$，其二次型为：\n$$x^T W_o x = x^T \\left( \\int_{0}^{\\infty} e^{A^T \\tau} C^T C e^{A \\tau} d\\tau \\right) x.$$\n将常数向量 $x$ 移入积分内部可得：\n$$x^T W_o x = \\int_{0}^{\\infty} x^T e^{A^T \\tau} C^T C e^{A \\tau} x \\, d\\tau = \\int_{0}^{\\infty} (C e^{A \\tau} x)^T (C e^{A \\tau} x) \\, d\\tau.$$\n令 $y(\\tau) = C e^{A \\tau} x$。由于 $C \\in \\mathbb{R}^{1 \\times 3}$，$y(\\tau)$ 是一个标量函数。因此被积函数为 $\\|y(\\tau)\\|^2 = (y(\\tau))^2$。\n$$x^T W_o x = \\int_{0}^{\\infty} (y(\\tau))^2 d\\tau.$$\n由于被积函数 $(y(\\tau))^2$ 对于所有 $\\tau \\geq 0$ 都是非负的，其在 $[0, \\infty)$ 上的积分也必然是非负的。因此，对于所有 $x \\in \\mathbb{R}^3$ 都有 $x^T W_o x \\ge 0$，这就是半正定矩阵的定义。\n\n为判断 $W_o$ 是否为奇异矩阵，我们计算其行列式：\n$$\\det(W_o) = \\det\\begin{pmatrix} \\frac{1}{2} & \\frac{1}{3} & 0 \\\\ \\frac{1}{3} & \\frac{1}{4} & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = 0.$$\n由于行列式为零，矩阵 $W_o$ 是奇异的。\n\n矩阵对 $(C,A)$ 的不可观测子空间是可观测性格拉姆矩阵的核，即 $\\operatorname{ker}(W_o)$。我们寻找所有满足 $W_o x = 0$ 的向量 $x = (x_1, x_2, x_3)^T$：\n$$\\begin{pmatrix} \\frac{1}{2} & \\frac{1}{3} & 0 \\\\ \\frac{1}{3} & \\frac{1}{4} & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}.$$\n这对应于以下线性方程组：\n\\begin{align*} \\frac{1}{2}x_1 + \\frac{1}{3}x_2 &= 0 \\\\ \\frac{1}{3}x_1 + \\frac{1}{4}x_2 &= 0 \\\\ 0 \\cdot x_3 &= 0 \\end{align*}\n左上角 $2 \\times 2$ 子矩阵的行列式为 $(\\frac{1}{2})(\\frac{1}{4}) - (\\frac{1}{3})(\\frac{1}{3}) = \\frac{1}{8} - \\frac{1}{9} = \\frac{1}{72} \\neq 0$。该子矩阵是可逆的，因此前两个方程的唯一解是 $x_1=0$ 和 $x_2=0$。第三个方程 $0 = 0$ 对 $x_3$ 没有施加任何限制。因此，核中的任何向量都必须具有 $(0, 0, x_3)^T$ 的形式。该核是由向量 $(0, 0, 1)^T$ 张成的子空间：\n$$\\operatorname{ker}(W_o) = \\operatorname{span}\\left\\{ \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} \\right\\}.$$\n这就是不可观测子空间。\n\n我们必须验证该子空间是 $A$-不变的。一个 $A$-不变子空间 $\\mathcal{S}$ 对所有 $x \\in \\mathcal{S}$ 都满足 $A x \\in \\mathcal{S}$。设 $x$ 是我们找到的子空间中的一个向量，因此对于某个标量 $\\alpha \\in \\mathbb{R}$，有 $x = (0, 0, \\alpha)^T$。然后，\n$$Ax = \\begin{pmatrix} -1 & 0 & 0 \\\\ 0 & -2 & 0 \\\\ 0 & 0 & -3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ \\alpha \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ -3\\alpha \\end{pmatrix}.$$\n结果向量的形式为 $(0, 0, \\beta)^T$，其中 $\\beta = -3\\alpha$，因此它仍然在 $\\operatorname{span}\\{(0, 0, 1)^T\\}$ 中。因此，$\\operatorname{ker}(W_o)$ 确实是一个 $A$-不变子空间。\n\n最终答案必须是张成该子空间的单个非零单位范数列向量，且其第一个非零元素为正。不可观测子空间的基向量可选择为 $v = (0, 0, 1)^T$。该向量的范数为 $\\|v\\|_2 = \\sqrt{0^2 + 0^2 + 1^2} = 1$，因此它已经是一个单位范数向量。两个可能的单位范数基向量是 $(0, 0, 1)^T$ 和 $(0, 0, -1)^T$。向量 $v=(0,0,1)^T$ 的第一个非零元素是第三个元素，即 $1$。由于 $1 > 0$，该向量满足条件。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}}\n$$", "id": "2728907"}, {"introduction": "一个系统是可观测的并不意味着我们可以轻易地从其输出中估计出所有状态。可观测性有“强弱”之分，而格拉姆矩阵的条件数 $\\kappa_{2}(W_{o})$ 正是衡量这种“质量”的关键指标。在此练习 [@problem_id:2728898] 中，你将分析一个系统的可观测性如何随着参数 $\\beta$ 变化而变“弱”，并推导其格拉姆矩阵的条件数，从而理解一个“病态”的格拉姆矩阵对数值状态估计的负面影响。", "problem": "考虑一个连续时间线性时不变 (LTI) 系统，其状态 $x \\in \\mathbb{R}^{2}$ 和输出 $y \\in \\mathbb{R}$ 由 $\\dot{x}(t) = A x(t)$ 和 $y(t) = C x(t)$ 给出，其中\n$$\nA = \\begin{pmatrix}\n-1 & 0 \\\\\n0 & -\\beta\n\\end{pmatrix}, \n\\qquad\nC = \\begin{pmatrix}\n1 & 1\n\\end{pmatrix},\n$$\n参数 $\\beta > 0$ 且 $\\beta \\neq 1$。对于所有此类 $\\beta$，系统矩阵 $A$ 都是赫尔维茨 (Hurwitz) 的，因此无限时域可观测性格拉姆矩阵存在。\n\n仅从连续时间 LTI 系统的状态转移和可观测性的基本定义出发，推导该系统的无限时域可观测性格拉姆矩阵 $W_{o}$，证明对于所有 $\\beta > 0, \\beta \\neq 1$，$W_{o}$ 都是正定的，并计算谱 (2-范数) 条件数 $\\kappa_{2}(W_{o})$，将其表示为 $\\beta$ 的显式闭式函数。然后，利用你的表达式，通过分析 $\\kappa_{2}(W_{o})$ 在 $\\beta \\to 1$ 时的行为，解释为什么 $W_{o}$ 的正定性并不意味着其条件数小，并讨论大的 $\\kappa_{2}(W_{o})$ 对于从输出 $y(t)$ 进行数值状态估计的影响。\n\n请给出 $\\kappa_{2}(W_{o})$ 作为 $\\beta$ 的函数的闭式解析表达式作为最终答案。不需要数值近似，也不需要单位。最终答案必须是单一的闭式表达式。", "solution": "所述问题是有效的。它在科学上是合理的、自洽的，并且在线性控制理论的既定框架内是适定的。所有需要的数据和约束都已提供，没有内部矛盾。我现在将给出完整的解法。\n\n该连续时间线性时不变 (LTI) 系统由下式描述\n$$ \\dot{x}(t) = A x(t), \\quad y(t) = C x(t) $$\n其中状态 $x \\in \\mathbb{R}^{2}$，输出 $y \\in \\mathbb{R}$，矩阵为\n$$ A = \\begin{pmatrix} -1 & 0 \\\\ 0 & -\\beta \\end{pmatrix}, \\qquad C = \\begin{pmatrix} 1 & 1 \\end{pmatrix} $$\n且 $\\beta > 0$ 且 $\\beta \\neq 1$。矩阵 $A$ 是赫尔维茨 (Hurwitz) 的，因为其特征值 $\\lambda_1 = -1$ 和 $\\lambda_2 = -\\beta$ 的实部在 $\\beta > 0$ 的约束下均为负。\n\n首先，我们推导无限时域可观测性格拉姆矩阵 $W_o$。其基本定义由以下积分给出：\n$$ W_o = \\int_{0}^{\\infty} e^{A^T \\tau} C^T C e^{A \\tau} d\\tau $$\n由于 $A$ 是对角矩阵，其转置等于自身，即 $A^T = A$。状态转移矩阵 $e^{A\\tau}$ 也是对角矩阵：\n$$ e^{A\\tau} = \\begin{pmatrix} e^{-\\tau} & 0 \\\\ 0 & e^{-\\beta \\tau} \\end{pmatrix} $$\n项 $C^T C$ 计算如下：\n$$ C^T C = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} $$\n那么被积函数为：\n$$ e^{A^T \\tau} C^T C e^{A \\tau} = \\begin{pmatrix} e^{-\\tau} & 0 \\\\ 0 & e^{-\\beta \\tau} \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} \\begin{pmatrix} e^{-\\tau} & 0 \\\\ 0 & e^{-\\beta \\tau} \\end{pmatrix} $$\n$$ = \\begin{pmatrix} e^{-\\tau} & 0 \\\\ 0 & e^{-\\beta \\tau} \\end{pmatrix} \\begin{pmatrix} e^{-\\tau} & e^{-\\beta \\tau} \\\\ e^{-\\tau} & e^{-\\beta \\tau} \\end{pmatrix} = \\begin{pmatrix} e^{-2\\tau} & e^{-(1+\\beta)\\tau} \\\\ e^{-(1+\\beta)\\tau} & e^{-2\\beta \\tau} \\end{pmatrix} $$\n我们将该矩阵从 $\\tau=0$ 到 $\\tau=\\infty$ 进行逐元素积分。由于 $\\beta > 0$，指数 $-2$, $-(1+\\beta)$ 和 $-2\\beta$ 都是严格为负的，这保证了积分的收敛性。\n$$ W_{o,11} = \\int_{0}^{\\infty} e^{-2\\tau} d\\tau = \\left[ -\\frac{1}{2} e^{-2\\tau} \\right]_{0}^{\\infty} = \\frac{1}{2} $$\n$$ W_{o,12} = W_{o,21} = \\int_{0}^{\\infty} e^{-(1+\\beta)\\tau} d\\tau = \\left[ -\\frac{1}{1+\\beta} e^{-(1+\\beta)\\tau} \\right]_{0}^{\\infty} = \\frac{1}{1+\\beta} $$\n$$ W_{o,22} = \\int_{0}^{\\infty} e^{-2\\beta \\tau} d\\tau = \\left[ -\\frac{1}{2\\beta} e^{-2\\beta \\tau} \\right]_{0}^{\\infty} = \\frac{1}{2\\beta} $$\n因此，可观测性格拉姆矩阵为：\n$$ W_o = \\begin{pmatrix} \\frac{1}{2} & \\frac{1}{1+\\beta} \\\\ \\frac{1}{1+\\beta} & \\frac{1}{2\\beta} \\end{pmatrix} $$\n或者，$W_o$ 是可观测性李雅普诺夫方程 (observability Lyapunov equation) $A^T W_o + W_o A + C^T C = 0$ 的唯一对称解，这也得到相同的结果。\n\n接下来，我们证明对于所有 $\\beta > 0, \\beta \\neq 1$，$W_o$ 都是正定的。对于一个 $2 \\times 2$ 的对称矩阵，这要求其两个顺序主子式 (leading principal minors) 均为正。\n第一个主子式是 $W_{o,11} = \\frac{1}{2} > 0$。\n第二个主子式是 $W_o$ 的行列式：\n$$ \\det(W_o) = \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2\\beta}\\right) - \\left(\\frac{1}{1+\\beta}\\right)^2 = \\frac{1}{4\\beta} - \\frac{1}{(1+\\beta)^2} $$\n$$ = \\frac{(1+\\beta)^2 - 4\\beta}{4\\beta(1+\\beta)^2} = \\frac{1 + 2\\beta + \\beta^2 - 4\\beta}{4\\beta(1+\\beta)^2} = \\frac{\\beta^2 - 2\\beta + 1}{4\\beta(1+\\beta)^2} = \\frac{(\\beta-1)^2}{4\\beta(1+\\beta)^2} $$\n给定 $\\beta > 0$，分母 $4\\beta(1+\\beta)^2$ 是严格为正的。给定 $\\beta \\neq 1$，分子 $(\\beta-1)^2$ 也是严格为正的。因此，$\\det(W_o) > 0$。由于两个顺序主子式都为正，所以对于所有 $\\beta > 0, \\beta \\neq 1$，$W_o$ 都是正定的。这与 $(A, C)$ 对当且仅当 $\\beta \\neq 1$ 时可观测这一事实是一致的。\n\n现在，我们计算谱 (2-范数) 条件数 $\\kappa_2(W_o)$，它是 $W_o$ 的最大特征值与最小特征值之比。特征值 $\\lambda$ 是特征方程 $\\det(W_o - \\lambda I) = 0$ 的根：\n$$ \\lambda^2 - \\text{tr}(W_o)\\lambda + \\det(W_o) = 0 $$\n我们有迹 $\\text{tr}(W_o) = \\frac{1}{2} + \\frac{1}{2\\beta} = \\frac{\\beta+1}{2\\beta}$ 和之前计算的行列式。特征值为：\n$$ \\lambda = \\frac{\\text{tr}(W_o) \\pm \\sqrt{\\text{tr}(W_o)^2 - 4\\det(W_o)}}{2} $$\n我们来分析平方根下的项：\n$$ \\text{tr}(W_o)^2 - 4\\det(W_o) = \\left(\\frac{\\beta+1}{2\\beta}\\right)^2 - 4\\frac{(\\beta-1)^2}{4\\beta(1+\\beta)^2} = \\frac{(\\beta+1)^2}{4\\beta^2} - \\frac{(\\beta-1)^2}{\\beta(1+\\beta)^2} $$\n这个表达式可以被简化。对于一个一般的 $2\\times2$ 对称矩阵 $M$，有一个更通用的恒等式 $\\text{tr}(M)^2 - 4\\det(M) = (m_{11}-m_{22})^2 + 4m_{12}^2$。将此用于 $W_o$：\n$$ (W_{o,11}-W_{o,22})^2 + 4W_{o,12}^2 = \\left(\\frac{1}{2} - \\frac{1}{2\\beta}\\right)^2 + 4\\left(\\frac{1}{1+\\beta}\\right)^2 = \\left(\\frac{\\beta-1}{2\\beta}\\right)^2 + \\frac{4}{(1+\\beta)^2} $$\n令 $S = \\sqrt{\\left(\\frac{\\beta-1}{2\\beta}\\right)^2 + \\frac{4}{(1+\\beta)^2}}$。特征值为 $\\lambda_{\\max} = \\frac{1}{2} (\\text{tr}(W_o) + S)$ 和 $\\lambda_{\\min} = \\frac{1}{2} (\\text{tr}(W_o) - S)$。\n条件数为：\n$$ \\kappa_2(W_o) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{\\text{tr}(W_o) + S}{\\text{tr}(W_o) - S} $$\n我们来求 $S$ 的一个更显式的表达式：\n$$ S^2 = \\frac{(\\beta-1)^2}{4\\beta^2} + \\frac{4}{(1+\\beta)^2} = \\frac{(\\beta-1)^2(1+\\beta)^2 + 16\\beta^2}{4\\beta^2(1+\\beta)^2} = \\frac{(\\beta^2-1)^2 + 16\\beta^2}{4\\beta^2(1+\\beta)^2} $$\n$$ S^2 = \\frac{\\beta^4-2\\beta^2+1 + 16\\beta^2}{4\\beta^2(1+\\beta)^2} = \\frac{\\beta^4+14\\beta^2+1}{4\\beta^2(1+\\beta)^2} $$\n由于 $\\beta > 0$，我们有 $S = \\frac{\\sqrt{\\beta^4+14\\beta^2+1}}{2\\beta(1+\\beta)}$。\n将 $S$ 和 $\\text{tr}(W_o) = \\frac{\\beta+1}{2\\beta}$ 代入 $\\kappa_2(W_o)$ 的表达式中：\n$$ \\kappa_2(W_o) = \\frac{\\frac{\\beta+1}{2\\beta} + \\frac{\\sqrt{\\beta^4+14\\beta^2+1}}{2\\beta(1+\\beta)}}{\\frac{\\beta+1}{2\\beta} - \\frac{\\sqrt{\\beta^4+14\\beta^2+1}}{2\\beta(1+\\beta)}} $$\n将分子和分母同乘以 $2\\beta(1+\\beta)$ 得到最终的简化表达式：\n$$ \\kappa_2(W_o) = \\frac{(\\beta+1)^2 + \\sqrt{\\beta^4+14\\beta^2+1}}{(\\beta+1)^2 - \\sqrt{\\beta^4+14\\beta^2+1}} $$\n\n最后，我们分析其行为和影响。当 $\\beta \\to 1$ 时，系统趋于不可观测，因为两个系统模式变得相同，使得它们从输出 $y(t) = x_1(t)+x_2(t)$ 中无法区分。\n我们来考察这个极限下的条件数：\n$$ \\lim_{\\beta \\to 1} \\left( (\\beta+1)^2 \\right) = (1+1)^2 = 4 $$\n$$ \\lim_{\\beta \\to 1} \\sqrt{\\beta^4+14\\beta^2+1} = \\sqrt{1+14+1} = \\sqrt{16} = 4 $$\n$\\kappa_2(W_o)$ 的表达式变为：\n$$ \\lim_{\\beta \\to 1} \\kappa_2(W_o) = \\frac{4+4}{4-4} \\to \\infty $$\n这个分析表明，尽管对于任何 $\\beta \\neq 1$，$W_o$ 都是正定的，但当 $\\beta$ 趋近于 $1$ 时，其条件数可以变得任意大。正定性只保证 $\\lambda_{\\min} > 0$；它并不限制比值 $\\lambda_{\\max}/\\lambda_{\\min}$ 的上界。\n这对数值状态估计的影响是严重的。可观测性格拉姆矩阵出现在许多估计问题中。输出能量与初始状态的关系为 $E_y = \\int_0^\\infty y(t)^2 dt = x(0)^T W_o x(0)$。$W_o$ 的大条件数意味着 $E_y$ 的等值集在状态空间中是高度拉长的椭球体。这意味着输出对某些方向（对应于 $\\lambda_{\\max}$）的初始状态分量非常敏感，但对其他方向（对应于 $\\lambda_{\\min}$）的分量非常不敏感。从 $y$ 的测量值估计状态 $x$ 的过程，实际上涉及对由 $W_o$ 定义的关系进行求逆。当 $W_o$ 是病态的 (ill-conditioned)（即 $\\kappa_2$ 很大时），这个求逆过程在数值上是不稳定的。$y(t)$ 测量中的微小噪声可能导致估计状态出现非常大的误差，尤其是在与 $W_o$ 的小特征值相关的“弱可观测”方向上。对于 $\\beta \\approx 1$，这个弱可观测方向近似为 span$\\begin{pmatrix} 1 & -1 \\end{pmatrix}^T$，这正是 $\\beta=1$ 时的不可观测子空间。", "answer": "$$ \\boxed{\\frac{(\\beta+1)^2 + \\sqrt{\\beta^4+14\\beta^2+1}}{(\\beta+1)^2 - \\sqrt{\\beta^4+14\\beta^2+1}}} $$", "id": "2728898"}, {"introduction": "将线性时不变（LTI）系统的结论直接推广到时变（LTV）系统时，我们必须格外小心。这个练习 [@problem_id:2728896] 通过一个精心设计的反例，揭示了一个重要的陷阱：即使系统在某个有限时间区间 $[0,T]$ 内是完全可观测的（即 $W_o(0,T)$ 满秩），它在整个时间域上仍可能不是可观测的，甚至可能包含不稳定的不可观测动态。这对于理解和分析时变系统的行为至关重要。", "problem": "考虑一个状态维数 $n=2$ 的线性时变 (LTV) 连续时间系统，由下式给出\n$\\dot{x}(t)=A(t)\\,x(t)$ 和 $y(t)=C(t)\\,x(t)$ (对 $t\\geq 0$)，其中\n$A(t)$ 和 $C(t)$ 是分段常数矩阵，定义如下：\n$A(t)=\\begin{cases}\n\\begin{pmatrix}\n0 & 0\\\\\n0 & 0\n\\end{pmatrix}, & 0\\leq t<1 \\\\[6pt]\n\\begin{pmatrix}\n1 & 0\\\\\n0 & -1\n\\end{pmatrix}, & t\\geq 1\n\\end{cases}\n\\quad\nC(t)=\\begin{cases}\n\\begin{pmatrix}\n1 & 0\\\\\n0 & 1\n\\end{pmatrix}, & 0\\leq t<1 \\\\[6pt]\n\\begin{pmatrix}\n0 & 0\n\\end{pmatrix}, & t\\geq 1\n\\end{cases}\n$\n仅使用状态转移矩阵和有限时域可观测性格拉姆矩阵的基本定义，完成以下任务：\n1) 计算与区间 $[0,1]$ 相关联的有限时域可观测性格拉姆矩阵 $W_{o}(0,1)$，并确定其行列式的值。\n2) 然后，仅使用时变系统的可观测性和可检测性的定义，论证该系统在 $[0,\\infty)$ 上是否是可检测的，并通过识别在 $t\\geq 1$ 时可能存在的任何不稳定不可观测模态来证明你的结论。\n你最终报告的答案应该是 $\\det\\!\\big(W_{o}(0,1)\\big)$ 的单个数值。无需四舍五入。", "solution": "所述问题是适定的且科学上合理的。它包含两部分：计算可观测性格拉姆矩阵及其行列式，以及随后对系统可检测性的分析。我们将严格遵守所给出的定义，按顺序处理每个部分。\n\n首先，我们计算区间 $[0,1]$ 上的有限时域可观测性格拉姆矩阵 $W_{o}(0,1)$。对于区间 $[t_0, t_f]$ 上的连续时间 LTV 系统，可观测性格拉姆矩阵的定义由以下积分给出：\n$$\nW_{o}(t_0, t_f) = \\int_{t_0}^{t_f} \\Phi(s, t_0)^T C(s)^T C(s) \\Phi(s, t_0) \\, ds\n$$\n其中 $\\Phi(t, \\tau)$ 是系统的状态转移矩阵。对于本问题，给定 $t_0=0$ 和 $t_f=1$。该积分为：\n$$\nW_{o}(0, 1) = \\int_{0}^{1} \\Phi(s, 0)^T C(s)^T C(s) \\Phi(s, 0) \\, ds\n$$\n在积分区间 $s \\in [0, 1)$ 上，系统矩阵为常数：\n$$\nA(s) = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix} = 0_{2\\times2}\n$$\n$$\nC(s) = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = I_2\n$$\n状态转移矩阵 $\\Phi(t, \\tau)$ 是矩阵微分方程 $\\frac{d}{dt}\\Phi(t, \\tau) = A(t)\\Phi(t, \\tau)$ 在初始条件 $\\Phi(\\tau, \\tau) = I$ 下的解。对于 $t, \\tau \\in [0, 1)$，$A(t)$ 是零矩阵。因此，$\\frac{d}{dt}\\Phi(t, \\tau) = 0_{2\\times2}$，从 $\\tau$ 到 $t$ 积分得到 $\\Phi(t, \\tau) = \\Phi(\\tau, \\tau) = I_2$。具体而言，对于所需的项 $\\Phi(s, 0)$，其中 $s \\in [0, 1)$，我们有 $\\Phi(s, 0) = I_2$。\n\n对于 $s \\in [0, 1)$，项 $C(s)^T C(s)$ 为 $I_2^T I_2 = I_2$。\n将这些代入被积函数，我们发现对于 $s \\in [0, 1)$，被积函数是常数：\n$$\n\\Phi(s, 0)^T C(s)^T C(s) \\Phi(s, 0) = I_2^T I_2^T I_2 I_2 = I_2\n$$\n现在我们可以计算 $W_{o}(0, 1)$ 的积分：\n$$\nW_{o}(0, 1) = \\int_{0}^{1} I_2 \\, ds = \\int_{0}^{1} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\, ds = \\begin{pmatrix} \\int_0^1 1 \\, ds & 0 \\\\ 0 & \\int_0^1 1 \\, ds \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = I_2\n$$\n因此，在 $[0, 1]$ 上的可观测性格拉姆矩阵的行列式是：\n$$\n\\det(W_{o}(0, 1)) = \\det(I_2) = 1\n$$\n这就完成了问题的第一部分。\n\n第二，我们分析系统在区间 $[0, \\infty)$ 上的可检测性。一个 LTV 系统被定义为可检测的，如果对于任意初始时间 $t_0$，任何在所有后续时间产生零输出（即对所有 $t \\ge t_0$ 都有 $y(t) = C(t)x(t) = 0$）的初始状态 $x(t_0)$，其导致的状态轨迹都收敛到原点（即 $\\lim_{t \\to \\infty} x(t) = 0$）。\n\n让我们考察 $t \\ge 1$ 时的系统。在这个半无限区间上，系统是时不变的，其矩阵为：\n$$\nA = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}\n$$\n$$\nC = \\begin{pmatrix} 0 & 0 \\end{pmatrix}\n$$\n对于任何状态 $x(t)$（其中 $t \\ge 1$），输出由 $y(t) = C x(t) = \\begin{pmatrix} 0 & 0 \\end{pmatrix} x(t) = 0$ 给出。这意味着对于任何初始时间 $t_0 \\ge 1$，任何初始状态 $x(t_0)$ 都将在所有 $t \\ge t_0$ 时产生零输出。\n\n根据可检测性的定义，对于任何这样的 $x(t_0)$，其产生的状态轨迹 $x(t)$ 必须在 $t \\to \\infty$ 时趋于零。对于 $t \\ge t_0 \\ge 1$，状态演化由 $x(t) = \\exp(A(t-t_0)) x(t_0)$ 给出。这个 LTI 系统的状态转移矩阵是：\n$$\n\\exp(A\\tau) = \\begin{pmatrix} \\exp(\\tau) & 0 \\\\ 0 & \\exp(-\\tau) \\end{pmatrix}\n$$\n让我们选择 $t_0 = 1$ 和一个非零初始状态，例如 $x(1) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。正如已确定的，这个初始状态在所有 $t \\ge 1$ 时都产生零输出。其产生的状态轨迹是：\n$$\nx(t) = \\exp(A(t-1)) x(1) = \\begin{pmatrix} \\exp(t-1) & 0 \\\\ 0 & \\exp(-(t-1)) \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\exp(t-1) \\\\ 0 \\end{pmatrix}\n$$\n当 $t \\to \\infty$ 时，状态的第一个分量 $x_1(t) = \\exp(t-1)$ 发散到无穷大。因此，$\\lim_{t \\to \\infty} x(t) \\neq 0$。这提供了一个直接的反例，证明了该系统不是可检测的。\n\n这个结论可以通过识别 $t \\ge 1$ 时的不稳定不可观测模态来进一步证明。对于 $t \\ge 1$ 的 LTI 系统 $(A,C)$，其特征值为 $\\lambda_1 = 1$ 和 $\\lambda_2 = -1$。特征值 $\\lambda_1 = 1$ 是不稳定的，因为其实部为正。与此特征值相关的动态特性代表一个不稳定模态。\n这些模态的可观测性由可观测性矩阵 $\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix}$ 决定。\n$$\nC = \\begin{pmatrix} 0 & 0 \\end{pmatrix}\n$$\n$$\nCA = \\begin{pmatrix} 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\end{pmatrix}\n$$\n因此，$\\mathcal{O} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}$。$\\mathcal{O}$ 的零空间是整个状态空间 $\\mathbb{R}^2$。这意味着对于 $t \\ge 1$，系统是完全不可观测的；状态的任何分量都无法从输出确定。由于对应于 $\\lambda_1 = 1$ 的不稳定模态位于这个不可观测子空间内，因此存在一个不稳定不可观测模态。这种模态的存在是一个系统不是可检测的决定性条件。", "answer": "$$\n\\boxed{1}\n$$", "id": "2728896"}]}