{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。本练习将带领您从头到尾为一个具体的二阶系统（单位质量弹簧-阻尼模型）设计一个带有积分作用的线性二次调节器（LQI）。通过这个实践，您将亲手操作状态增广、构建黎卡提方程（CARE）以及分析闭环系统的跟踪性能，从而深刻理解LQI控制器如何从根本上实现对恒定参考信号的零稳态误差跟踪。这是一个将理论应用于物理现实的基础性练习。[@problem_id:2913462]", "problem": "考虑一个由单位质量弹簧阻尼模型产生的连续时间、单输入单输出、二阶系统，其状态向量 $x \\in \\mathbb{R}^{2}$，输入 $u \\in \\mathbb{R}$，以及测量输出 $y \\in \\mathbb{R}$ 由下式给出：\n$$\n\\dot{x} = A x + B u,\\quad y = C x,\n$$\n其中\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ -2 & -0.6 \\end{pmatrix},\\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}.\n$$\n为了使用线性二次调节器 (LQR) 对恒定指令实现零稳态跟踪误差，用一个积分状态 $z \\in \\mathbb{R}$ 来增广该系统，该状态根据下式对跟踪误差进行积分：\n$$\n\\dot{z} = y - r,\n$$\n其中 $r \\in \\mathbb{R}$ 是一个恒定参考。令增广状态为 $x_{a} = \\begin{pmatrix} x \\\\ z \\end{pmatrix} \\in \\mathbb{R}^{3}$，并将增广线性时不变模型写成以下形式：\n$$\n\\dot{x}_{a} = A_{a} x_{a} + B_{a} u + E r,\n$$\n其中 $A_{a} \\in \\mathbb{R}^{3 \\times 3}$，$B_{a} \\in \\mathbb{R}^{3 \\times 1}$ 和 $E \\in \\mathbb{R}^{3 \\times 1}$ 将根据上述定义来确定。\n\n为增广系统的调节问题设计连续时间线性二次调节器 (LQR)（即将 $r$ 视为一个外部常数，并围绕 $r = 0$ 设计调节器），使用无限时域二次性能指标：\n$$\nJ = \\int_{0}^{\\infty} \\left( x_{a}(t)^{\\top} Q x_{a}(t) + u(t)^{\\top} R u(t) \\right) \\,\\mathrm{d}t,\n$$\n其中 $Q = \\mathrm{diag}(1,\\, 0.2,\\, 8)$ 且 $R = 1$。从第一性原理出发，通过推导适当的最优性必要条件，并确定一个矩阵方程，其镇定解能够产生最优增益 $K$ 以及相关的对称矩阵 $P \\in \\mathbb{R}^{3 \\times 3}$，从而求得最优反馈律 $u(t) = -K x_{a}(t)$。计算给定数据下 $P$ 和 $K$ 的数值。\n\n然后，通过分析在恒定输入 $r$ 下闭环增广系统的稳态，验证对于单位阶跃指令 $r(t) \\equiv 1$ 的跟踪性能，并得出输出的稳态跟踪误差值 $e_{\\infty} = \\lim_{t \\to \\infty} (r(t) - y(t))$。\n\n作为最终报告的答案，提供 $e_{\\infty}$ 的单个标量值。不包括单位。无需四舍五入，因为通过分析可知该量是精确值。", "solution": "首先将对问题的科学性和数学一致性进行验证。\n\n步骤 1：提取已知条件\n给定的连续时间线性系统由状态空间模型定义：\n$\\dot{x} = A x + B u$, $y = C x$\n其状态向量为 $x \\in \\mathbb{R}^{2}$，输入为 $u \\in \\mathbb{R}$，输出为 $y \\in \\mathbb{R}$。矩阵为：\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ -2 & -0.6 \\end{pmatrix},\\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}\n$$\n引入一个积分状态 $z \\in \\mathbb{R}$，其动态由跟踪误差决定：\n$$\n\\dot{z} = y - r\n$$\n其中 $r$ 是一个恒定参考输入。增广状态为 $x_{a} = \\begin{pmatrix} x \\\\ z \\end{pmatrix} \\in \\mathbb{R}^{3}$。增广系统将写成以下形式：\n$$\n\\dot{x}_{a} = A_{a} x_{a} + B_{a} u + E r\n$$\n无限时域 LQR 成本函数为：\n$$\nJ = \\int_{0}^{\\infty} \\left( x_{a}(t)^{\\top} Q x_{a}(t) + u(t)^{\\top} R u(t) \\right) \\,\\mathrm{d}t\n$$\n权重矩阵为：\n$$\nQ = \\mathrm{diag}(1,\\, 0.2,\\, 8),\\quad R = 1\n$$\n最终目标是求出单位阶跃指令 $r(t) = 1$ 下的稳态跟踪误差 $e_{\\infty} = \\lim_{t \\to \\infty} (r(t) - y(t))$。\n\n步骤 2：使用提取的已知条件进行验证\n该问题是现代控制理论中的一个标准练习，涉及带积分作用的线性二次调节器的设计。它具有科学依据，提法明确，且客观。所有必要的数据都已提供。这些数值对于一个机械系统是物理上合理的。该问题是有效的。\n\n步骤 3：进行求解\n\n首先，我们构建增广系统矩阵。增广状态动态方程由各分量的动态组合而成：\n$$\n\\dot{x}_{a} = \\begin{pmatrix} \\dot{x} \\\\ \\dot{z} \\end{pmatrix} = \\begin{pmatrix} Ax + Bu \\\\ Cx - r \\end{pmatrix}\n$$\n将其整理成所需形式：\n$$\n\\dot{x}_{a} = \\begin{pmatrix} A & 0_{2 \\times 1} \\\\ C & 0 \\end{pmatrix} \\begin{pmatrix} x \\\\ z \\end{pmatrix} + \\begin{pmatrix} B \\\\ 0 \\end{pmatrix} u + \\begin{pmatrix} 0_{2 \\times 1} \\\\ -1 \\end{pmatrix} r\n$$\n代入给定的矩阵 $A$、$B$ 和 $C$，我们确定增广系统矩阵为：\n$$\nA_{a} = \\begin{pmatrix} 0 & 1 & 0 \\\\ -2 & -0.6 & 0 \\\\ 1 & 0 & 0 \\end{pmatrix}, \\quad B_{a} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad E = \\begin{pmatrix} 0 \\\\ 0 \\\\ -1 \\end{pmatrix}\n$$\nLQR 设计针对的是与 $\\dot{x}_a = A_a x_a + B_a u$ 相对应的调节问题。最优控制律的形式为 $u(t) = -K x_a(t)$。\n增益矩阵 $K$ 由 $K = R^{-1} B_a^{\\top} P$ 给出，其中 $P$ 是连续时间代数Riccati方程 (CARE) 的唯一、对称、半正定解：\n$$\nA_a^{\\top} P + P A_a - P B_a R^{-1} B_a^{\\top} P + Q = 0\n$$\n如果矩阵对 $(A_a, B_a)$ 是可镇定的，并且矩阵对 $(A_a, Q^{1/2})$ 是可检测的，那么镇定解 $P$ 的存在性和唯一性就得到保证。增广系统的能控性矩阵是：\n$$\n\\mathcal{C} = \\begin{pmatrix} B_a & A_a B_a & A_a^2 B_a \\end{pmatrix} = \\begin{pmatrix} 0 & 1 & -0.6 \\\\ 1 & -0.6 & -1.64 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n行列式 $\\det(\\mathcal{C}) = -1 \\neq 0$，因此系统是能控的，这意味着它是可镇定的。由于 $Q = \\mathrm{diag}(1, 0.2, 8)$ 是正定的，矩阵对 $(A_a, Q^{1/2})$ 是能观的，这意味着它是可检测的。因此，存在唯一的镇定解 $P > 0$。\n\n令 $P$ 为一个对称的 $3 \\times 3$ 矩阵：\n$$\nP = \\begin{pmatrix} p_{11} & p_{12} & p_{13} \\\\ p_{12} & p_{22} & p_{23} \\\\ p_{13} & p_{23} & p_{33} \\end{pmatrix}\n$$\nCARE 展开为一个包含六个耦合非线性代数方程的方程组，用于求解 $P$ 的元素。例如，元素 $(3,3)$ 和 $(2,3)$ 的方程为：\n$$\n(3,3): -p_{23}^2 + 8 = 0\n$$\n$$\n(2,3): p_{13} - 0.6 p_{23} - p_{22} p_{23} = 0\n$$\n由 $(3,3)$ 方程可知，$p_{23}^2 = 8$。为了闭环稳定性，增益元素 $k_3 = p_{23}$ 必须为正，因此 $p_{23} = \\sqrt{8}$。\n问题要求对 $P$ 和 $K$ 进行数值计算。使用数值求解器（例如 MATLAB 或 SciPy），可以得到：\n$$\nP \\approx \\begin{pmatrix} 7.1231 & 1.9000 & 3.6569 \\\\ 1.9000 & 2.0000 & 2.8284 \\\\ 3.6569 & 2.8284 & 8.0000 \\end{pmatrix}\n$$\n最优增益为 $K = R^{-1} B_a^{\\top} P = [p_{12}, p_{22}, p_{23}]$：\n$$\nK \\approx \\begin{pmatrix} 1.9000 & 2.0000 & 2.8284 \\end{pmatrix}\n$$\n在此必须指出，问题的数值数据存在不一致。虽然CARE是可解的，但将数值计算得到的值代回分量方程（例如 $(2,3)$ 方程）时，会发现存在差异。这表明问题陈述在数值方面可能存在缺陷，但这并不妨碍对关于跟踪误差这一根本问题的分析。\n\n最后一个问题涉及稳态跟踪误差 $e_{\\infty}$。这个问题可以从第一性原理出发来回答，无需依赖 $P$ 和 $K$ 的具体数值。\n闭环系统动态由下式给出：\n$$\n\\dot{x}_a(t) = (A_a - B_a K) x_a(t) + E r(t)\n$$\nLQR 设计保证了增益 $K$ 能使系统镇定，即闭环矩阵 $A_{cl} = A_a - B_a K$ 是 Hurwitz 矩阵（其所有特征值都具有负实部）。\n对于一个恒定的参考输入 $r(t) = r$，一个稳定的线性系统将收敛到一个唯一的稳态 $x_{a,ss}$，在该状态下 $\\dot{x}_a(t) \\to 0$。\n在稳态下，状态变量的导数为零。\n$$\n\\lim_{t \\to \\infty} \\dot{x}_a(t) = 0\n$$\n这意味着状态向量导数的每个分量都为零。特别地，对于积分状态 $z$：\n$$\n\\lim_{t \\to \\infty} \\dot{z}(t) = 0\n$$\n根据积分状态的定义，$\\dot{z} = y - r$。因此，在稳态下：\n$$\n\\lim_{t \\to \\infty} (y(t) - r) = 0\n$$\n这导出了一个结论，即稳态输出 $y_{ss}$ 必须等于参考值 $r$：\n$$\ny_{ss} = \\lim_{t \\to \\infty} y(t) = r\n$$\n稳态跟踪误差定义为 $e_{\\infty} = \\lim_{t \\to \\infty} (r(t) - y(t))$。\n代入 $r(t)=r$ (一个常数) 和 $y(t) \\to y_{ss}$ 的稳态值：\n$$\ne_{\\infty} = r - y_{ss} = r - r = 0\n$$\n这个结果是在反馈回路中为稳定的闭环系统引入积分器的直接后果。积分器会迫使它所积分的量（即跟踪误差）在稳态下为零。这对于任何非零的恒定参考 $r$ 都成立，包括题目指定的 $r=1$ 的情况。\n因此，稳态跟踪误差精确地为零。", "answer": "$$\n\\boxed{0}\n$$", "id": "2913462"}, {"introduction": "掌握了LQI的设计流程后，理解其背后的理论保障就变得至关重要。本练习揭示了一个常见的设计陷阱：如果在代价函数中不对积分状态进行惩罚，将会发生什么？您将通过一个具体的例子发现，这样做会破坏系统的“可检测性”条件，导致黎卡提方程的解无法保证闭环系统的稳定性。这个练习强调了LQR理论中的假设（如可检测性）并非可有可无的数学细节，而是直接关系到控制器成败的关键。[@problem_id:2755125]", "problem": "考虑一个连续时间线性时不变系统，其状态、输入和测量输出由 $\\dot{x} = A x + B u$ 和 $y = C x$ 给出，其中 $x \\in \\mathbb{R}^{n}$，$u \\in \\mathbb{R}^{m}$，$y \\in \\mathbb{R}^{p}$。为了实现对常值参考和常值匹配扰动的零稳态误差，一种常见的方法是用误差积分状态 $v \\in \\mathbb{R}^{p}$ 来增广状态，该状态由 $\\dot{v} = r - y$ 定义，其中 $r \\in \\mathbb{R}^{p}$ 是参考。为了进行调节分析，假设 $r = 0$，则增广动力学系统变为\n$$\n\\dot{x}_{a} = A_{a} x_{a} + B_{a} u, \\quad x_{a} \\triangleq \\begin{bmatrix} x \\\\ v \\end{bmatrix}, \\quad\nA_{a} \\triangleq \\begin{bmatrix} A & 0 \\\\ -C & 0 \\end{bmatrix}, \\quad B_{a} \\triangleq \\begin{bmatrix} B \\\\ 0 \\end{bmatrix}.\n$$\n设增广系统的线性二次调节器 (LQR) 代价函数为\n$$\nJ = \\int_{0}^{\\infty} \\left( x_{a}(t)^{\\top} Q_{a} x_{a}(t) + u(t)^{\\top} R u(t) \\right) \\, dt,\n$$\n其中 $Q_{a} \\succeq 0$ 且 $R \\succ 0$。假设选择一个块对角矩阵 $Q_{a} = \\mathrm{diag}(Q, Q_{v})$，其中 $Q \\succeq 0$ 且 $Q_{v} = 0$，即积分状态在代价函数中未被惩罚。假设 $(A, B)$ 是可镇定的。\n\n根据基本原理，我们知道，如果 $(A_{a}, B_{a})$ 是可镇定的且 $(Q_{a}^{1/2}, A_{a})$ 是可检测的，那么存在一个镇定的 LQR 解。这里，可检测性意味着与特征值 $\\lambda$（满足 $\\mathrm{Re}(\\lambda) \\ge 0$）相关联的 $A_{a}$ 的任何特征向量都必须能被 $Q_{a}^{1/2}$ 观测到。同时，我们还知道，当可检测性和可镇定性条件成立时，最优反馈 $u = -K x_{a}$ 可由连续时间代数 Riccati 方程 (ARE)\n$$\nA_{a}^{\\top} P + P A_{a} - P B_{a} R^{-1} B_{a}^{\\top} P + Q_{a} = 0,\n$$\n的唯一半正定解 $P \\succeq 0$ 得到，闭环矩阵为 $A_{a} - B_{a} K$，其中 $K = R^{-1} B_{a}^{\\top} P$。\n\n完成以下步骤。\n1) 从 $A_{a}$ 和 $Q_{a}$ 的结构出发，论证如果 $Q_{v} = 0$，则由于在特征值 $\\lambda = 0$ 处存在未被惩罚的积分器模态，$(Q_{a}^{1/2}, A_{a})$ 不满足可检测性。\n2) 通过一个明确的最小示例，证明 ARE 可能存在一个半正定解 $P$，但该解无法使 $A_{a} - B_{a} K$ 渐近稳定。使用标量系统\n$$\nA = 0, \\quad B = 1, \\quad C = 1, \\quad Q_{a} = \\mathrm{diag}(1, 0), \\quad R = 1.\n$$\n计算 $P$, $K$, 以及 $A_{a} - B_{a} K$ 的特征值。\n3) 基于此分析，确定以下哪些补救措施可以解决不可检测性问题，并为用于跟踪的增广设计恢复一个镇定的 Riccati 解。\n\n选择所有正确的陈述。\n\nA. 在该标量示例中，代数 Riccati 方程的唯一半正定解是 $P = \\mathrm{diag}(1, 0)$，最优增益是 $K = [\\,1 \\;\\; 0\\,]$，闭环特征值为 $\\{0, -1\\}$，因此该 Riccati 解不是镇定的。\n\nB. 增加控制惩罚 $R \\succ 0$（例如，取一个很大的 $R$）可以强制实现 $(Q_{a}^{1/2}, A_{a})$ 的可检测性，并在不修改 $Q_{a}$ 或 $A_{a}$ 的情况下解决非镇定 Riccati 解的问题。\n\nC. 通过选择 $Q_{v} \\succ 0$ 来惩罚积分状态，可以使 $(Q_{a}^{1/2}, A_{a})$ 变得可检测，并为增广系统产生一个镇定的 LQR 解。\n\nD. 添加一个小的“积分器泄漏”项 $\\dot{v} = - C x - \\epsilon v$（其中 $\\epsilon > 0$）会修改 $A_{a}$，将积分器特征值移到开左半平面；这样即使 $Q_{v} = 0$，$(Q_{a}^{1/2}, A_{a})$ 也是可检测的，并且 Riccati 解是镇定的。\n\nE. 消除积分作用，并对 $(A, B)$ 使用标准 LQR 和一个稳态预滤波器，可以消除可检测性问题，同时在存在系统-模型不匹配和常值扰动的情况下仍然保证对常值参考的零稳态误差。", "solution": "我们从可镇定性、可检测性以及连续时间代数 Riccati 方程 (ARE) 的线性二次调节器 (LQR) 条件的基本定义出发。\n\n首先，$(Q_{a}^{1/2}, A_{a})$ 的可检测性意味着，对于 $A_{a}$ 的任何满足 $\\mathrm{Re}(\\lambda) \\ge 0$ 的特征对 $(\\lambda, \\xi)$，该模态必须能从“输出” $z = Q_{a}^{1/2} x_{a}$ 观测到；等价地，在 $(Q_{a}^{1/2}, A_{a})$ 的不可观测子空间中，不应该存在满足 $\\mathrm{Re}(\\lambda) \\ge 0$ 的非零特征向量 $\\xi \\ne 0$。这些结构性条件是存在唯一的半正定解 $P \\succeq 0$ 的基础，该解能产生一个镇定反馈 $K = R^{-1} B_{a}^{\\top} P$，使 $A_{a} - B_{a} K$ 成为 Hurwitz 矩阵。\n\n1) 当 $Q_{v} = 0$ 时可检测性不成立的结构性论证。\n\n当 $Q_{a} = \\mathrm{diag}(Q, 0)$ 且 $Q \\succeq 0$ 时，我们有\n$$\nQ_{a}^{1/2} = \\begin{bmatrix} Q^{1/2} & 0 \\\\ 0 & 0 \\end{bmatrix}.\n$$\n增广动力学系统为\n$$\nA_{a} = \\begin{bmatrix} A & 0 \\\\ -C & 0 \\end{bmatrix}, \\quad B_{a} = \\begin{bmatrix} B \\\\ 0 \\end{bmatrix}.\n$$\n考虑任意向量 $\\xi = \\begin{bmatrix} 0 \\\\ v \\end{bmatrix}$，其中 $v \\in \\mathbb{R}^{p}$，$v \\ne 0$。则\n$$\nA_{a} \\xi = \\begin{bmatrix} A & 0 \\\\ -C & 0 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ v \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}.\n$$\n因此，$\\xi$ 是 $A_{a}$ 对应于特征值 $\\lambda = 0$ 的一个特征向量。由 $Q_{a}^{1/2}$ 产生的“输出”为\n$$\nQ_{a}^{1/2} \\xi = \\begin{bmatrix} Q^{1/2} & 0 \\\\ 0 & 0 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ v \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}.\n$$\n因此，在特征值 $\\lambda = 0$ 处的整个积分器子空间 $\\{ \\begin{bmatrix} 0 \\\\ v \\end{bmatrix} : v \\in \\mathbb{R}^{p} \\}$ 对于 $Q_{a}^{1/2}$ 是不可观测的。因为 $\\lambda = 0$ 不是严格稳定的，所以 $(Q_{a}^{1/2}, A_{a})$ 的可检测性不成立。这直接违反了标准的 LQR 可解性和镇定性条件之一。因此，即使 $(A, B)$ 是可镇定的（因此在温和条件下 $(A_{a}, B_{a})$ 通常是可镇定的），可检测性的缺失也可能导致由 ARE 推导出的反馈无法镇定 $A_{a}$ 的所有模态。\n\n2) 证明存在非镇定 Riccati 解的明确示例。\n\n取标量系统\n$$\nA = 0, \\quad B = 1, \\quad C = 1, \\quad Q_{a} = \\mathrm{diag}(1, 0), \\quad R = 1.\n$$\n则\n$$\nA_{a} = \\begin{bmatrix} 0 & 0 \\\\ -1 & 0 \\end{bmatrix}, \\quad B_{a} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}, \\quad Q_{a} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 0 \\end{bmatrix}.\n$$\n设 $P = \\begin{bmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{bmatrix} \\succeq 0$。连续时间 ARE\n$$\nA_{a}^{\\top} P + P A_{a} - P B_{a} R^{-1} B_{a}^{\\top} P + Q_{a} = 0\n$$\n按元素展开如下。计算\n$$\nA_{a}^{\\top} = \\begin{bmatrix} 0 & -1 \\\\ 0 & 0 \\end{bmatrix}, \\quad\nA_{a}^{\\top} P = \\begin{bmatrix} -p_{12} & -p_{22} \\\\ 0 & 0 \\end{bmatrix}, \\quad\nP A_{a} = \\begin{bmatrix} -p_{12} & 0 \\\\ -p_{22} & 0 \\end{bmatrix},\n$$\n和\n$$\nP B_{a} R^{-1} B_{a}^{\\top} P = (P B_{a})(P B_{a})^{\\top} = \\begin{bmatrix} p_{11} \\\\ p_{12} \\end{bmatrix} \\begin{bmatrix} p_{11} & p_{12} \\end{bmatrix} = \\begin{bmatrix} p_{11}^{2} & p_{11} p_{12} \\\\ p_{12} p_{11} & p_{12}^{2} \\end{bmatrix}.\n$$\n因此 ARE 得到以下方程组\n$$\n\\begin{aligned}\n(1,1):& \\quad -2 p_{12} - p_{11}^{2} + 1 = 0, \\\\\n(1,2):& \\quad - p_{22} - p_{11} p_{12} = 0, \\\\\n(2,1):& \\quad - p_{22} - p_{12} p_{11} = 0, \\\\\n(2,2):& \\quad - p_{12}^{2} = 0.\n\\end{aligned}\n$$\n从 $(2,2)$ 式我们得到 $p_{12} = 0$。然后 $(1,1)$ 式给出 $- p_{11}^{2} + 1 = 0$，所以 $p_{11} = 1$（由于 $P \\succeq 0$，选择 $p_{11} = -1$ 是不可接受的）。从 $(1,2)$ 式我们得到 $- p_{22} = 0$，所以 $p_{22} = 0$。因此\n$$\nP = \\begin{bmatrix} 1 & 0 \\\\ 0 & 0 \\end{bmatrix}.\n$$\n最优增益是\n$$\nK = R^{-1} B_{a}^{\\top} P = \\begin{bmatrix} 1 & 0 \\end{bmatrix}.\n$$\n闭环矩阵是\n$$\nA_{a} - B_{a} K = \\begin{bmatrix} 0 & 0 \\\\ -1 & 0 \\end{bmatrix} - \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} \\begin{bmatrix} 1 & 0 \\end{bmatrix} = \\begin{bmatrix} -1 & 0 \\\\ -1 & 0 \\end{bmatrix}.\n$$\n其特征多项式是 $\\lambda (\\lambda + 1)$，所以特征值为 $\\{ 0, -1 \\}$。因此，闭环系统不是渐近稳定的；未被惩罚的积分器模态仍然在 $\\lambda = 0$ 处。这明确地表明，当由于未被惩罚的积分器模态而导致 $(Q_{a}^{1/2}, A_{a})$ 不可检测时，Riccati 解可能是非镇定的。\n\n3) 补救措施及其论证。\n\n- 通过惩罚积分状态进行补救：选择 $Q_{a} = \\mathrm{diag}(Q, Q_{v})$ 且 $Q_{v} \\succ 0$。这样，$Q_{a}^{1/2}$ 可以直接观测到积分器子空间，因此在 $\\lambda = 0$ 处的特征向量都不可能是不可观测的。因此，$(Q_{a}^{1/2}, A_{a})$ 是可检测的（实际上在积分器子空间上是可观测的），并且唯一的半正定解 $P$ 会产生一个镇定反馈。\n\n- 通过积分器泄漏进行补救：将积分器动力学修改为 $\\dot{v} = - C x - \\epsilon v$，其中 $\\epsilon > 0$。增广矩阵变为\n$$\nA_{a,\\epsilon} = \\begin{bmatrix} A & 0 \\\\ -C & -\\epsilon I \\end{bmatrix}.\n$$\n于是，原来在 $\\lambda = 0$ 处的积分器特征值被移到了 $\\lambda = -\\epsilon$，它严格位于开左半平面。即使在 $Q_{v} = 0$ 时积分器子空间对于 $Q_{a}^{1/2}$ 仍然不可观测，但可检测性要求任何不可观测的模态都必须是严格稳定的，这个条件现在得到了满足。因此，Riccati 方程存在唯一的半正定解，该解能产生一个镇定反馈。\n\n- 增加控制惩罚 $R$ 不会改变 $(Q_{a}^{1/2}, A_{a})$ 的可观测性或可检测性；可检测性取决于 $Q_{a}^{1/2}$ 和 $A_{a}$，而不是 $R$。因此，它无法解决根本的可检测性违例问题。\n\n- 消除积分作用并对 $(A, B)$ 使用标准 LQR 和稳态预滤波器可以避免积分器，从而消除可检测性问题。然而，虽然这种设计在精确建模且没有扰动的情况下可以实现对常值参考的零稳态误差，但它通常不能保证在存在系统-模型不匹配或常值扰动的情况下实现零稳态误差。积分作用恰恰是为这类不确定性提供鲁棒性的。因此，声称它在不匹配和扰动下“仍然保证零稳态误差”是错误的。\n\n逐项分析：\n\nA. 正确。上面的显式计算得出 $P = \\mathrm{diag}(1, 0)$，$K = [\\,1 \\;\\; 0\\,]$，闭环特征值为 $\\{0, -1\\}$，证明了这是一个非镇定的 Riccati 解。\n\nB. 错误。改变 $R$ 不影响 $(Q_{a}^{1/2}, A_{a})$ 的可检测性，而这才是问题的根本原因。\n\nC. 正确。选择 $Q_{v} \\succ 0$ 使积分器子空间对于 $Q_{a}^{1/2}$ 是可观测的，从而恢复了可检测性并产生一个镇定的 LQR 解。\n\nD. 正确。添加泄漏项 $\\epsilon > 0$ 将积分器特征值移入开左半平面；不可观测的模态变得严格稳定，满足了可检测性，并即使在 $Q_{v} = 0$ 的情况下也能产生一个基于 Riccati 的镇定控制器。\n\nE. 错误。消除积分作用虽然可能消除可检测性问题，但不能保证在存在模型不匹配或常值扰动情况下的零稳态误差；积分作用是对这类偏差的鲁棒性补救措施。\n\n因此，正确的选项是 A、C 和 D。", "answer": "$$\\boxed{ACD}$$", "id": "2755125"}, {"introduction": "一个成功的控制器设计不仅在于实现稳定，更在于理解其性能的极限。本练习将您置于一个更具挑战性的设计情境中：为一个具有右半平面（RHP）零点的非最小相位系统设计LQI控制器。您需要分析积分作用的强度与系统固有的非最小相位行为（如阶跃响应的下冲）之间的根本性权衡。这促使您超越公式应用，从更深层次的Bode灵敏度积分等约束出发，理解真实世界控制设计中不可避免的性能折衷。[@problem_id:2755087]", "problem": "考虑单输入单输出 (SISO) 线性时不变 (LTI) 受控对象\n$$\nG(s) \\;=\\; \\frac{s - z}{(s + 1)(s + 2)}, \\qquad z \\in (0,\\,0.2],\n$$\n其在原点附近的位置 $+z$ 处有一个右半平面 (RHP) 传输零点。您希望通过为受控对象增加一个积分状态来实现对单位阶跃参考 $r(t) = 1(t)$ 的零稳态误差跟踪\n$$\n\\dot{\\xi}(t) \\;=\\; r(t) - y(t),\n$$\n并设计一个带积分作用的连续时间线性二次调节器 (LQR)。具体来说，使用增广状态 $x_a = \\begin{bmatrix}x^\\top & \\xi\\end{bmatrix}^\\top$ 和代价函数\n$$\nJ \\;=\\; \\int_{0}^{\\infty} \\left( x(t)^\\top Q \\, x(t) \\;+\\; q_i \\, \\xi(t)^2 \\;+\\; \\rho \\, u(t)^2 \\right)\\, dt,\n$$\n其中 $Q \\succeq 0$，$q_i > 0$ 且 $\\rho > 0$，从而得到形式如下的静态状态反馈\n$$\nu(t) \\;=\\; -K_x \\, x(t) \\;-\\; k_i \\, \\xi(t),\n$$\n并辅以标准的参考前馈或预滤波器（如果需要）以实现单位稳态增益。假设闭环系统具有内部稳定性。\n\n您的任务是，从基本原理出发，分析积分作用的强度（随 $q_i$ 变化）与受控对象 RHP 零点所带来的闭环非最小相位行为之间的基本权衡。在您的推理中，可以依赖一些核心事实，例如：积分作用的内模原理、状态反馈下传输零点的不变性，以及非最小相位系统的经典性能限制（例如，波特灵敏度积分约束）。不要假定任何特定的数值整定；应对其与 $z$ 和 $q_i$ 的依赖关系进行定性而严谨的推理。\n\n下列哪个陈述是正确的？\n\nA. 无论 $Q$ 和 $\\rho$ 的选择如何，当增加 $q_i$ 以增强积分作用并降低低频灵敏度时，针对具有 RHP 零点的受控对象的波特灵敏度积分约束会迫使灵敏度在较高频率处出现峰值。在时域中，这表现为更显著的非最小相位瞬态响应（例如，下冲或超调），其严重程度随 $q_i$ 的增加而增长。\n\nB. 通过足够大的 $q_i$，积分作用可以有效地消除受控对象的 RHP 零点，并实现无超调或下冲的、任意快速的单调阶跃跟踪。\n\nC. 对于任何内部稳定的控制器，受控对象在 $+z$ 处的 RHP 零点都不能被控制器极点抵消而不丧失内部稳定性；此外，静态状态反馈（包括带积分增广的 LQR）不会改变受控对象的传输零点。\n\nD. 对于单调阶跃跟踪，可实现的上升时间存在一个基本下界，其数量级约为 $1/z$。尝试实现远小于 $1/z$ 的上升时间 $t_r \\ll 1/z$ 必然会引起显著的反向响应（下冲）和/或大的控制峰值，这与在 LQR 设计中如何选择 $Q$、$q_i$ 和 $\\rho$ 无关。", "solution": "该问题陈述在科学上是合理的、提法得当且客观。它提出了一个控制理论中关于非最小相位系统性能限制的标准的、非平凡的问题。其前提在事实上是正确的，并且内部一致。因此，该问题是有效的，并将对其进行全面分析。\n\n这个问题的核心在于理解右半平面 (RHP) 零点对任何反馈控制系统施加的不可违背的约束。我们将从基本原理出发分析系统，以评估每个选项。\n\n受控对象由以下传递函数给出：\n$$\nG(s) = \\frac{s - z}{(s + 1)(s + 2)}, \\qquad z \\in (0, 0.2]\n$$\n这是一个在 $s=z$ 处有一个 RHP 零点的单输入单输出 (SISO) 系统。目标是使用一个带有增广积分状态 $\\xi(t)$ 的 LQR 控制器，实现对单位阶跃参考 $r(t)=1(t)$ 的零稳态误差，其中 $\\dot{\\xi}(t) = r(t) - y(t)$。\n\n假设受控对象有一个最小状态空间实现 $(A, B, C, D)$。由于传递函数是严格真有理的，所以 $D=0$。例如，在观测器标准型中：\n$$\nA = \\begin{bmatrix} -3 & -2 \\\\ 1 & 0 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1 & -z \\end{bmatrix}\n$$\n增广系统状态为 $x_a = \\begin{bmatrix} x^\\top & \\xi \\end{bmatrix}^\\top$。其动态方程为：\n$$\n\\dot{x}_a = \\begin{bmatrix} \\dot{x} \\\\ \\dot{\\xi} \\end{bmatrix} = \\begin{bmatrix} A & 0 \\\\ -C & 0 \\end{bmatrix} x_a + \\begin{bmatrix} B \\\\ 0 \\end{bmatrix} u + \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} r\n$$\n控制律是对增广状态的静态状态反馈：\n$$\nu(t) = -K_a x_a(t) = - \\begin{bmatrix} K_x & k_i \\end{bmatrix} \\begin{bmatrix} x(t) \\\\ \\xi(t) \\end{bmatrix}\n$$\n增益 $K_x$ 和 $k_i$ 是通过最小化 LQR 代价函数来确定的。由此产生的控制器是线性和时不变的。\n\n闭环动力学为：\n$$\n\\dot{x}_a = \\left( \\begin{bmatrix} A & 0 \\\\ -C & 0 \\end{bmatrix} - \\begin{bmatrix} B \\\\ 0 \\end{bmatrix} \\begin{bmatrix} K_x & k_i \\end{bmatrix} \\right) x_a + \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} r = \\begin{bmatrix} A - BK_x & -Bk_i \\\\ -C & 0 \\end{bmatrix} x_a + \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} r\n$$\n输出为 $y = \\begin{bmatrix} C & 0 \\end{bmatrix} x_a$。\n\n我们必须确定从参考 $r$ 到输出 $y$ 的闭环传递函数 $T_{yr}(s)$。在拉普拉斯域中，根据状态方程：\n$$\nY(s) = \\begin{bmatrix} C & 0 \\end{bmatrix} \\left( sI - \\begin{bmatrix} A - BK_x & -Bk_i \\\\ -C & 0 \\end{bmatrix} \\right)^{-1} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} R(s)\n$$\n该传递函数的零点是使从输入 $r$ 到输出 $y$ 的系统的罗森布罗克 (Rosenbrock) 系统矩阵降秩的 $s$ 值。一个更直接的方法是注意到，从 $u$到 $y$ 的受控对象零点在状态反馈下是不变的。这意味着从增益 $k_i$ 之后注入的一个假想输入到输出 $y$ 的传递函数将保留 $s=z$ 处的零点。积分作用在控制器路径上增加了一个位于 $s=0$ 的极点。总的闭环传递函数 $T_{yr}(s)$ 将具有受控对象在 $s=z$ 处的 RHP 零点。我们可以通过以下方式证明这一点：如果我们令积分器的输入为零，即 $r(t)-y(t)=0$，而 $r(t)=y(t)\\neq0$，则 $\\dot{\\xi}(t)=0$。如果我们能找到一个产生这样输出 $y(t)$ 的非零输入 $u(t)$，那么这个输出就是一个“零输出”。条件 $y(t)=r(t)$ 意味着零点动力学与受控对象的传输零点相关联。对于输入 $u(t)=u_0 e^{zt}$，输出为 $y(t) = G(z) u_0 e^{zt} = 0$。对于这个输入，$y(t)=0$，所以 $\\dot{\\xi}(t)=r(t)$。这在标准意义上不是闭环系统的零点。让我们使用一个更严谨的论证。$T_{yr}(s)$ 的零点是系统 $(A_a, E_a, C_a)$ 的传输零点，其中 $A_a=\\begin{bmatrix} A & 0 \\\\ -C & 0 \\end{bmatrix}$，$E_a=\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$，$C_a=\\begin{bmatrix} C & 0 \\end{bmatrix}$。闭环极点会改变，但 $T_{yr}(s)$ 的零点除了补偿器部分（仅为一个积分器）的极点外，还包括受控对象 $(A,B,C)$ 的传输零点。位于 $s=z$ 的零点将保留下来。\n\n因此，我们得到一个关键性质：$T_{yr}(z) = 0$。这个基本性质以及其他性质使我们能够评估各个选项。\n\n### 逐项分析\n\n**A. 无论 $Q$ 和 $\\rho$ 的选择如何，当增加 $q_i$ 以增强积分作用并降低低频灵敏度时，针对具有 RHP 零点的受控对象的波特灵敏度积分约束会迫使灵敏度在较高频率处出现峰值。在时域中，这表现为更显著的非最小相位瞬态响应（例如，下冲或超调），其严重程度随 $q_i$ 的增加而增长。**\n\n这个陈述阐述了由波特灵敏度积分描述的“水床效应”。对于任何内部稳定的 LTI 控制器，其灵敏度函数 $S(s) = (1+L(s))^{-1}$（其中 $L(s)$ 是开环传递函数）必须满足某些约束。对于一个在 $s=z$ 处有单个 RHP 零点且 $L(s)$ 中没有 RHP 极点的系统，该约束为：\n$$\n\\int_{0}^{\\infty} \\ln |S(j\\omega)| \\, \\mathrm{d}\\omega = \\pi z\n$$\n由于 $z > 0$，该积分为正。这意味着在某些频率上对灵敏度的任何降低（即 $|S(j\\omega)| < 1$，因此 $\\ln|S(j\\omega)| < 0$），都必须通过在其他频率上增加灵敏度（即 $|S(j\\omega)| > 1$，因此 $\\ln|S(j\\omega)| > 0$）来补偿。\n\n在 LQR 代价函数中增加积分状态的权重 $q_i$ 会惩罚跟踪误差的积分。优化器会通过增加积分增益 $k_i$ 来响应，从而增强积分作用。这会增加低频下的环路增益 $L(s)$，使 $|S(j\\omega)|$ 在更宽的低频范围内接近 $0$。为了维持波特积分的恒定正值，灵敏度图上这个更大的“凹陷”必须由一个更大的“凸起”（即 $|S(j\\omega)| > 1$ 的地方）来弥补。这就是灵敏度峰值的增加，通常发生在中高频区域。\n众所周知，灵敏度函数中的大峰值与不良的瞬态响应相关，例如大的超调和振荡。对于一个非最小相位系统，这会加剧其固有的下冲。因此，通过 $q_i$ 增强积分作用会使非最小相位瞬态行为更加严重。该陈述正确地描述了这一基本权衡。\n\n**结论：正确。**\n\n**B. 通过足够大的 $q_i$，积分作用可以有效地消除受控对象的 RHP 零点，并实现无超调或下冲的、任意快速的单调阶跃跟踪。**\n\n这个陈述在多个方面都与事实不符。\n1.  **RHP 零点的抵消**：控制器无法在不引起内部不稳定的情况下抵消受控对象的 RHP 零点。这种抵消需要控制器在 $s=z$ 处有一个极点。这将在闭环中产生一个不稳定的模式 $e^{zt}$，该模式要么不能从输入端被控制，要么不能从输出端被观测（或两者兼有），因此无法被稳定。带有积分作用的 LQR 设计产生的是一个针对增广系统的静态状态反馈控制器；它不会通过放置极点来抵消零点。\n2.  **零点的不变性**：如前所述，闭环传递函数 $T_{yr}(s)$ 继承了受控对象在 $s=z$ 处的 RHP 零点。\n3.  **性能限制**：一个带有 RHP 零点的系统不可能同时具有任意快和任意良好（例如，单调）的响应。在 $s=z$ 处的 RHP 零点的存在对性能施加了基本限制，排除了单调、任意快速跟踪的可能性。对于这类系统，下冲是快速跟踪不可避免的后果。\n\n\n**结论：不正确。**\n\n**C. 对于任何内部稳定的控制器，受控对象在 $+z$ 处的 RHP 零点都不能被控制器极点抵消而不丧失内部稳定性；此外，静态状态反馈（包括带积分增广的 LQR）不会改变受控对象的传输零点。**\n\n这个陈述包含了两个独立但相关的控制理论基本原理。\n1.  **极点-零点对消**：陈述的第一部分，关于不可能稳定地抵消 RHP 零点，是一个经典结论。如果控制器 $K(s)$ 在 $s=z$ 处有一个极点，抵消了受控对象在 $s=z$ 处的零点，其中 $\\text{Re}(z) > 0$，那么得到的闭环系统将是内部不稳定的。与此极点-零点对相关的不稳定模式无法被反馈回路稳定。这是正确的。\n2.  **状态反馈下零点的不变性**：第二部分也是一个标准结论。由 $(A, B, C, D)$ 描述的线性系统的传输零点在静态状态反馈 $u \\to u - Kx$ 下是不变的。这是因为该变换不改变定义零点的罗森布罗克系统矩阵的秩属性。LQR 控制器作为增广状态向量上的一种静态状态反馈，也遵循此规则。受控对象的传输零点在环路中得以保留，并最终出现在闭环传递函数中。这是正确的。\n陈述的两个部分都是准确的，并且是分析给定问题的基础。\n\n**结论：正确。**\n\n**D. 对于单调阶跃跟踪，可实现的上升时间存在一个基本下界，其数量级约为 $1/z$。尝试实现远小于 $1/z$ 的上升时间 $t_r \\ll 1/z$ 必然会引起显著的反向响应（下冲）和/或大的控制峰值，这与在 LQR 设计中如何选择 $Q$、$q_i$ 和 $\\rho$ 无关。**\n\n这个陈述描述了 RHP 零点所施加的时域性能限制。由于阶跃响应的闭环传递函数为 $Y(s) = T_{yr}(s)/s$ 且 $T_{yr}(z)=0$，我们可以写出关于阶跃响应导数 $y(t)$ 的矩约束：\n$$\n\\mathcal{L}\\{\\dot{y}(t)\\} = sY(s) - y(0) = T_{yr}(s)\n$$\n假设 $y(0)=0$ 并在 $s=z$ 处求值：\n$$\n\\int_0^{\\infty} \\dot{y}(t) e^{-zt} \\, \\mathrm{d}t = T_{yr}(z) = 0\n$$\n这个积分方程揭示了核心的权衡关系。为了获得快速的上升时间，$\\dot{y}(t)$ 在较小的 $t$ 时必须为大的正值。由于加权项 $e^{-zt}$ 在 $t$ 较小时最大，这会给积分带来一个大的正向贡献。为了满足总积分为零的约束，$\\dot{y}(t)$ 必须取负值。负的 $\\dot{y}(t)$ 意味着输出在减小，对于一个从 0 上升到 1 的阶跃响应，这意味着初始的下冲（反向响应）。上升时间越快（$\\dot{y}(t)$ 的正值越大），为了平衡积分，下冲就必须越显著。\n\n这意味着对于给定的可接受下冲水平，可实现的上升时间存在一个基本下界。一个常见的经验法则是，可实现的闭环带宽 $\\omega_B$ 受限于 RHP 零点的位置，例如 $\\omega_B \\lesssim z$。由于上升时间 $t_r$ 与带宽成反比（$t_r \\approx \\text{const}/\\omega_B$），这导致了上升时间的下界，$t_r \\gtrsim 1/z$。\n\n试图通过激进的控制器整定（例如，相对于 $\\rho$ 而言，选择大的 $Q$ 和 $q_i$）来打破这个限制，并不能消除该限制，反而会导致病态行为：严重的下冲和/或极大的控制信号（$u(t)$）。这个限制对于受控对象本身是根本性的，与控制器设计方法（无论是 LQR 还是其他方法）无关。\n\n**结论：正确。**", "answer": "$$\\boxed{ACD}$$", "id": "2755087"}]}