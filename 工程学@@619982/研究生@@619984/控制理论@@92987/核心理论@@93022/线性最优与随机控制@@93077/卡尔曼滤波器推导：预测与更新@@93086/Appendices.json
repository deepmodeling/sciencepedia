{"hands_on_practices": [{"introduction": "卡尔曼滤波器的离线性能分析核心在于描述估计误差协方差演化的离散时间里卡提（Riccati）方程。本练习将引导您从第一性原理出发，为一个简单的标量系统实现这一关键的递推关系。通过探索不同的系统参数，您将直观地理解系统稳定性、过程噪声$q$和测量噪声$r$是如何共同影响滤波器的稳态不确定性的。[@problem_id:2753301]", "problem": "考虑一个由以下方程组定义的一维线性高斯离散时间状态空间模型\n$$x_{k+1} = a\\,x_k + w_k,\\quad y_k = c\\,x_k + v_k,$$\n其中 $x_k$ 是状态，$y_k$ 是观测，$w_k \\sim \\mathcal{N}(0,q)$ 和 $v_k \\sim \\mathcal{N}(0,r)$ 分别是方差为 $q \\ge 0$ 和 $r > 0$ 的独立零均值高斯噪声，且 $a, c \\in \\mathbb{R}$。假设在时间指标 $k$ 上的后验分布为高斯分布，其均值和方差为 $(\\mu_k, P_k)$，并考虑针对线性高斯系统的标准贝叶斯估计框架。\n\n任务1（推导）：从高斯随机变量线性变换的基本性质以及联合高斯分布的条件作用出发，推导后验方差 $P_k$ 的单步预测和更新规则的标量形式，并用 $a$、$c$、$q$、$r$ 和 $P_{k-1}$ 显式表达。你的推导不能预先引用任何卡尔曼滤波器公式，必须仅依赖于全期望定律、全方差定律以及联合高斯向量的条件分布。\n\n任务2（算法）：使用推导出的标量方差递推式，实现一个迭代过程，该过程在给定初始后验方差 $P_0 > 0$ 的情况下，通过交替进行预测和更新来计算序列 $\\{P_k\\}_{k=1}^N$。对下面的每个测试用例，执行 $N$ 次迭代并报告：\n- 近似稳态后验方差，取为 $P_N$。\n- 最后两次后验迭代值之间的绝对差，$\\Delta_N = |P_N - P_{N-1}|$。\n- 一个布尔收敛标志，定义为 $\\mathrm{converged} = \\big(\\Delta_N \\le \\mathrm{tol}\\big)$。\n\n任务3（测试套件与输出）：使用以下五个测试用例。在所有用例中，初始后验方差均为 $P_0 = 1$。\n- 用例A（不稳定但可检测）：$a = 1.2$, $c = 1$, $q = 1$, $r = 1$, $N = 100$, $\\mathrm{tol} = 10^{-10}$。\n- 用例B（稳定且测量噪声大）：$a = 0.9$, $c = 1$, $q = 0.1$, $r = 10$, $N = 100$, $\\mathrm{tol} = 10^{-10}$。\n- 用例C（无过程噪声，单位动态）：$a = 1$, $c = 1$, $q = 0$, $r = 1$, $N = 100$, $\\mathrm{tol} = 10^{-10}$。\n- 用例D（不可观测，发散预测）：$a = 1.2$, $c = 0$, $q = 1$, $r = 1$, $N = 50$, $\\mathrm{tol} = 10^{-10}$。\n- 用例E（近乎无噪声的测量）：$a = 1.2$, $c = 1$, $q = 1$, $r = 10^{-6}$, $N = 100$, $\\mathrm{tol} = 10^{-10}$。\n\n你的程序必须生成单行输出，包含一个类JSON数组，该数组有五个条目，每个用例一个，按A到E的顺序排列。每个条目是一个三元组\n$$[P_N,\\ \\Delta_N,\\ \\mathrm{converged}],$$\n其中 $P_N$ 和 $\\Delta_N$ 是四舍五入到6位小数的浮点数，$\\mathrm{converged}$ 是布尔字面量，小写形式的 $true$ 或 $false$。整个输出必须是形如\n$$\\big[[P_N^{(A)},\\Delta_N^{(A)},\\mathrm{converged}^{(A)}],\\ldots,[P_N^{(E)},\\Delta_N^{(E)},\\mathrm{converged}^{(E)}]\\big].$$\n的单行。不应打印任何额外文本。所有量都是无量纲的，因此不需要物理单位。", "solution": "该问题要求从第一性原理出发，推导标量卡尔曼滤波器方差更新方程，随后通过数值实现来分析滤波器在不同参数设定下的行为。分析将分两个主要阶段进行：首先是理论推导，其次是针对指定测试用例的实现和执行。\n\n状态空间模型由以下一维线性高斯方程定义：\n状态转移过程：\n$$x_{k+1} = a\\,x_k + w_k, \\quad w_k \\sim \\mathcal{N}(0, q)$$\n测量过程：\n$$y_k = c\\,x_k + v_k, \\quad v_k \\sim \\mathcal{N}(0, r)$$\n这里，$x_k \\in \\mathbb{R}$ 是在时间 $k$ 的隐藏状态，$y_k \\in \\mathbb{R}$ 是对应的测量值。过程噪声 $w_k$ 和测量噪声 $v_k$ 是相互独立的零均值高斯随机变量，其方差分别为 $q \\ge 0$ 和 $r > 0$。参数 $a$ 和 $c$ 是实值常数。\n\n贝叶斯滤波的核心是递归地计算状态的后验分布 $p(x_k | y_{1:k})$，其中 $y_{1:k} = \\{y_1, y_2, \\dots, y_k\\}$ 表示截至时间 $k$ 的所有测量值序列。对于线性高斯系统，如果初始状态分布是高斯分布，那么所有后续的后验分布也都是高斯分布。我们将时间 $k$ 的后验分布表示为 $\\mathcal{N}(\\mu_k, P_k)$。问题要求推导后验方差 $P_k$ 关于上一步后验方差 $P_{k-1}$ 的递推关系。这个递推由两个步骤组成：预测和更新。\n\n**1. 预测步骤**\n\n预测步骤旨在计算在给定截至时间 $k-1$ 的所有证据的条件下，时间 $k$ 的状态的先验分布。这个分布是 $p(x_k | y_{1:k-1})$。我们假设时间 $k-1$ 的后验分布已知，且为高斯分布：\n$$p(x_{k-1} | y_{1:k-1}) = \\mathcal{N}(x_{k-1} | \\mu_{k-1}, P_{k-1})$$\n状态 $x_k$ 由 $x_{k-1}$ 通过状态转移方程 $x_k = a\\,x_{k-1} + w_{k-1}$ 生成。在以 $y_{1:k-1}$ 为条件时，变量 $x_{k-1}$ 是一个均值为 $\\mu_{k-1}$、方差为 $P_{k-1}$ 的高斯随机变量。过程噪声 $w_{k-1}$ 独立于 $x_{k-1}$ 和所有过去的测量值 $y_{1:k-1}$，且服从 $\\mathcal{N}(0, q)$。\n由于 $x_k$ 是两个独立高斯随机变量的线性组合，其分布 $p(x_k | y_{1:k-1})$ 也是高斯分布。我们将其均值和方差分别表示为 $\\mu_k^-$ 和 $P_k^-$（上标“$-$”表示预测量或*先验*量）。\n\n预测分布的均值使用全期望定律求得：\n$$ \\mu_k^- = E[x_k | y_{1:k-1}] = E[a\\,x_{k-1} + w_{k-1} | y_{1:k-1}] $$\n根据期望的线性性质：\n$$ \\mu_k^- = a\\,E[x_{k-1} | y_{1:k-1}] + E[w_{k-1} | y_{1:k-1}] $$\n由于 $w_{k-1}$ 独立于过去的测量值，所以 $E[w_{k-1} | y_{1:k-1}] = E[w_{k-1}] = 0$。第一项是 $a\\,\\mu_{k-1}$。因此，\n$$ \\mu_k^- = a\\,\\mu_{k-1} $$\n预测分布的方差使用全方差定律求得。由于 $w_{k-1}$ 独立于 $x_{k-1}$（在以 $y_{1:k-1}$ 为条件下），它们的和的方差等于它们方差的和：\n$$ P_k^- = \\mathrm{Var}(x_k | y_{1:k-1}) = \\mathrm{Var}(a\\,x_{k-1} + w_{k-1} | y_{1:k-1}) = \\mathrm{Var}(a\\,x_{k-1} | y_{1:k-1}) + \\mathrm{Var}(w_{k-1} | y_{1:k-1}) $$\n使用方差性质 $\\mathrm{Var}(bZ) = b^2\\mathrm{Var}(Z)$ 以及 $w_{k-1}$ 与过去数据的独立性：\n$$ P_k^- = a^2\\,\\mathrm{Var}(x_{k-1} | y_{1:k-1}) + \\mathrm{Var}(w_{k-1}) = a^2\\,P_{k-1} + q $$\n这就是方差的预测方程。\n\n**2. 更新步骤**\n\n更新步骤结合了新的测量值 $y_k$，将预测分布 $p(x_k | y_{1:k-1}) = \\mathcal{N}(x_k | \\mu_k^-, P_k^-)$ 提炼为后验分布 $p(x_k | y_{1:k}) = \\mathcal{N}(x_k | \\mu_k, P_k)$。为此，我们考虑状态 $x_k$ 和测量值 $y_k$ 在给定过去数据 $y_{1:k-1}$ 条件下的联合分布。\n\n测量模型是 $y_k = c\\,x_k + v_k$。$y_k$ 所依赖的两个变量 $x_k$ 和 $v_k$ 都是高斯分布（在以 $y_{1:k-1}$ 为条件下）。因此，在以 $y_{1:k-1}$ 为条件下，对 $(x_k, y_k)$ 是联合高斯分布。我们需要找到这个联合分布的参数：\n$$ \\begin{pmatrix} x_k \\\\ y_k \\end{pmatrix} \\Bigg| y_{1:k-1} \\sim \\mathcal{N} \\left( \\begin{pmatrix} E[x_k] \\\\ E[y_k] \\end{pmatrix}, \\begin{pmatrix} \\mathrm{Var}(x_k) & \\mathrm{Cov}(x_k, y_k) \\\\ \\mathrm{Cov}(y_k, x_k) & \\mathrm{Var}(y_k) \\end{pmatrix} \\right) $$\n其中所有的期望和协方差都隐式地以 $y_{1:k-1}$ 为条件。\n\n均值向量为：\n$$ E[x_k] = \\mu_k^- $$\n$$ E[y_k] = E[c\\,x_k + v_k] = c\\,E[x_k] + E[v_k] = c\\,\\mu_k^- $$\n（因为 $v_k$ 是零均值且独立于所有其他变量）。\n\n协方差矩阵为：\n$$ \\mathrm{Var}(x_k) = P_k^- $$\n$$ \\mathrm{Cov}(x_k, y_k) = \\mathrm{Cov}(x_k, c\\,x_k + v_k) = c\\,\\mathrm{Cov}(x_k, x_k) + \\mathrm{Cov}(x_k, v_k) = c\\,\\mathrm{Var}(x_k) = c\\,P_k^- $$\n（因为 $v_k$ 独立于 $x_k$）。\n$$ \\mathrm{Var}(y_k) = \\mathrm{Var}(c\\,x_k + v_k) = c^2\\,\\mathrm{Var}(x_k) + \\mathrm{Var}(v_k) = c^2\\,P_k^- + r $$\n（因为 $x_k$ 和 $v_k$ 是独立的）。\n\n所以，联合分布为：\n$$ \\begin{pmatrix} x_k \\\\ y_k \\end{pmatrix} \\Bigg| y_{1:k-1} \\sim \\mathcal{N} \\left( \\begin{pmatrix} \\mu_k^- \\\\ c\\,\\mu_k^- \\end{pmatrix}, \\begin{pmatrix} P_k^- & c\\,P_k^- \\\\ c\\,P_k^- & c^2\\,P_k^- + r \\end{pmatrix} \\right) $$\n后验分布 $p(x_k | y_k, y_{1:k-1})$ 是联合高斯向量的条件分布。使用标准的条件作用公式，给定 $y_k$ 时 $x_k$ 的方差为：\n$$ P_k = \\mathrm{Var}(x_k | y_k, y_{1:k-1}) = \\mathrm{Var}(x_k) - \\mathrm{Cov}(x_k, y_k) \\mathrm{Var}(y_k)^{-1} \\mathrm{Cov}(y_k, x_k) $$\n代入我们推导出的各项：\n$$ P_k = P_k^- - (c\\,P_k^-)(c^2\\,P_k^- + r)^{-1}(c\\,P_k^-) = P_k^- - \\frac{c^2(P_k^-)^2}{c^2\\,P_k^- + r} $$\n这就是方差更新方程。可以通过通分来简化它：\n$$ P_k = \\frac{P_k^-(c^2\\,P_k^- + r) - c^2(P_k^-)^2}{c^2\\,P_k^- + r} = \\frac{c^2(P_k^-)^2 + r\\,P_k^- - c^2(P_k^-)^2}{c^2\\,P_k^- + r} = \\frac{r\\,P_k^-}{c^2\\,P_k^- + r} $$\n\n**3. 完整的方差递推**\n\n结合预测和更新步骤，我们得到了一个关于 $P_{k-1}$ 的后验方差 $P_k$ 的单一递推关系：\n1. 预测：$P_k^- = a^2\\,P_{k-1} + q$\n2. 更新：$P_k = \\frac{r\\,P_k^-}{c^2\\,P_k^- + r}$\n\n将第一个方程代入第二个方程，得到完整的递推关系，也称为标量离散时间代数Riccati方程：\n$$ P_k = \\frac{r(a^2\\,P_{k-1} + q)}{c^2(a^2\\,P_{k-1} + q) + r} $$\n该方程不依赖于测量值 $y_k$ 或状态均值 $\\mu_k$。它可以在处理任何数据之前离线计算。数值任务的算法将从 $P_0$ 开始迭代此方程。\n\n实现将包含一个循环，对于五个测试用例中的每一个，从 $P_0=1$ 开始，应用推导出的递推公式 $N$ 次。在迭代结束时，它将计算最终方差 $P_N$、与前一个迭代值的变化量 $\\Delta_N = |P_N - P_{N-1}|$，以及一个布尔标志，指示此变化是否低于容差 $\\mathrm{tol}$。\n\n当 $c = 0$ 时会出现一种特殊情况。在这种情况下，测量值不提供关于状态的任何信息。更新方程变为：\n$$ P_k = \\frac{r\\,P_k^-}{0^2\\,P_k^- + r} = \\frac{r\\,P_k^-}{r} = P_k^- $$\n这表明当系统不可观测时，后验方差就是预测方差，如果 $|a| \\ge 1$ 且 $q>0$，该方差将无界增长。这种情况预计在用例D中出现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Kalman filter variance recursion problem for five test cases.\n\n    This function implements the derived scalar Riccati recursion for the\n    posterior variance of a 1D linear-Gaussian state-space model. It iterates\n    the recursion for N steps for each test case and reports the final variance,\n    the absolute difference between the last two iterates, and a convergence flag.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Format: (a, c, q, r, N, tol, P0)\n    test_cases = [\n        # Case A: unstable but detectable\n        (1.2, 1.0, 1.0, 1.0, 100, 1e-10, 1.0),\n        # Case B: stable with large measurement noise\n        (0.9, 1.0, 0.1, 10.0, 100, 1e-10, 1.0),\n        # Case C: no process noise, identity dynamics\n        (1.0, 1.0, 0.0, 1.0, 100, 1e-10, 1.0),\n        # Case D: unobservable, diverging prediction\n        (1.2, 0.0, 1.0, 1.0, 50, 1e-10, 1.0),\n        # Case E: near noise-free measurement\n        (1.2, 1.0, 1.0, 1e-6, 100, 1e-10, 1.0),\n    ]\n\n    results = []\n    for a, c, q, r, N, tol, P0 in test_cases:\n        p_current = float(P0)\n        p_previous = 0.0  # Initialize to a different value\n\n        for _ in range(N):\n            p_previous = p_current\n\n            # Prediction step for variance\n            p_predicted = a * a * p_previous + q\n\n            # Update step for variance\n            # The formula is P_k = (r * P_k^-) / (c^2 * P_k^- + r)\n            # This is numerically stable and handles c=0 correctly.\n            denominator = c * c * p_predicted + r\n            if denominator == 0:\n                # This case should not happen given r > 0.\n                # If c=0 and r=0, this would be an issue, but problem states r > 0.\n                # If p_predicted is somehow negative infinity, this could happen\n                # but variance must be non-negative.\n                p_current = np.inf\n            else:\n                p_current = (r * p_predicted) / denominator\n\n        # After N iterations, calculate final values\n        P_N = p_current\n        # The value of p_previous is from the (N-1)-th iteration\n        Delta_N = abs(P_N - p_previous)\n        converged = (Delta_N <= tol)\n\n        results.append((P_N, Delta_N, converged))\n\n    # Format the output as a single JSON-like string\n    formatted_results = []\n    for p, d, c in results:\n        # Convert boolean to lowercase 'true' or 'false'\n        c_str = 'true' if c else 'false'\n        # Format floats to 6 decimal places\n        formatted_results.append(f'[{p:.6f},{d:.6f},{c_str}]')\n\n    final_output = f\"[{','.join(formatted_results)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2753301"}, {"introduction": "在观察了设计良好的系统中里卡提方程的收敛性之后，理解它在何种情况下以及为何会失效至关重要。本实践将探讨可检测性（detectability）这一确保滤波器稳定性的基本前提。通过分析一个具有不稳定且不可观测模式的系统，您将从数学上证明，为何该部分状态的误差协方差$P_{k|k}$无法被测量所约束，并最终会无界增长。[@problem_id:2753278]", "problem": "考虑离散时间线性时不变 (LTI) 随机状态空间模型\n$$\nx_{k+1} = A x_{k} + w_{k}, \\quad y_{k} = H x_{k} + v_{k},\n$$\n其中 $x_{k} \\in \\mathbb{R}^{2}$，$y_{k} \\in \\mathbb{R}$，且\n$$\nA = \\begin{pmatrix} \\tfrac{3}{2} & 0 \\\\ 0 & \\tfrac{1}{2} \\end{pmatrix}, \\quad H = \\begin{pmatrix} 0 & 1 \\end{pmatrix}.\n$$\n假设过程噪声 $w_{k} \\sim \\mathcal{N}(0,Q)$，其中 $Q = \\operatorname{diag}(1,1)$，测量噪声 $v_{k} \\sim \\mathcal{N}(0,R)$，其中 $R = 1$。假设 $w_{k}$ 和 $v_{k}$ 相互独立且随时间独立，并且先验为高斯分布，即 $x_{0} \\sim \\mathcal{N}(\\hat{x}_{0|0}, P_{0|0})$，其中 $P_{0|0} = I_{2}$。\n\n仅使用线性高斯模型的基本性质、贝叶斯法则、全期望定律和全协方差定律（不预先假设任何卡尔曼滤波器的特定公式），完成以下任务：\n\n1) 利用离散时间系统的可观测性和可检测性的定义，论证系统对 $(A,H)$ 是否可检测。您的论证必须明确指出任何不可观测的特征模态，并将其特征值的模与 $1$ 进行比较。\n\n2) 从模型所蕴含的联合高斯结构以及条件均值和协方差的定义出发，推导状态估计误差协方差的预测和更新递推式，并将其应用于给定的 $(A,H,Q,R)$。证明对于这些数据，协方差递推沿坐标轴解耦，并且第一个坐标的协方差不受测量更新的影响。\n\n3) 求解得到的第一个坐标的后验协方差 $P_{11,k|k}$ 的标量递推式，并将其表示为关于离散时间索引 $k \\in \\mathbb{N}$ 的闭式解，给定 $P_{11,0|0} = 1$。\n\n提供 $P_{11,k|k}$ 的精确、简化的解析表达式作为最终答案。无需进行舍入。将协方差视为无量纲。", "solution": "在尝试任何解答之前，首先评估问题陈述的有效性。给定条件为一个离散时间 LTI 随机状态空间模型：\n$x_{k+1} = A x_{k} + w_{k}$\n$y_{k} = H x_{k} + v_{k}$\n其中 $x_{k} \\in \\mathbb{R}^{2}$，$y_{k} \\in \\mathbb{R}$。矩阵和噪声统计量为：\n$A = \\begin{pmatrix} \\frac{3}{2} & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix}$，$H = \\begin{pmatrix} 0 & 1 \\end{pmatrix}$。\n过程噪声 $w_{k} \\sim \\mathcal{N}(0,Q)$，其中 $Q = \\operatorname{diag}(1,1) = I_{2}$。\n测量噪声 $v_{k} \\sim \\mathcal{N}(0,R)$，其中 $R = 1$。\n噪声 $w_k$ 和 $v_k$ 是独立的白噪声。\n先验分布为 $x_{0} \\sim \\mathcal{N}(\\hat{x}_{0|0}, P_{0|0})$，其中 $P_{0|0} = I_{2}$。\n\n该问题具有科学依据，提法得当且客观。它是在线性系统理论和状态估计领域的一个标准练习，要求从基本原理进行推导。所有必要信息均已提供，问题内部一致且无歧义。因此，我们着手进行解答。\n\n1) 可检测性分析\n一个离散时间线性时不变系统被定义为可检测的，当且仅当其所有不可观测模态都是稳定的。如果一个模态相关的特征值的模小于 $1$，则该模态是稳定的。我们首先确定系统对 $(A,H)$ 的不可观测子空间。\n对于状态维数 $n=2$ 的系统，其可观测性矩阵为 $\\mathcal{O} = \\begin{pmatrix} H \\\\ HA \\end{pmatrix}$。\n我们计算乘积 $HA$：\n$$ HA = \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{3}{2} & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} 0 & \\frac{1}{2} \\end{pmatrix} $$\n可观测性矩阵为：\n$$ \\mathcal{O} = \\begin{pmatrix} 0 & 1 \\\\ 0 & \\frac{1}{2} \\end{pmatrix} $$\n$\\mathcal{O}$ 的秩为 $1$，小于状态维数 $n=2$。因此，该系统是不可观测的。\n不可观测子空间是 $\\mathcal{O}$ 的零空间。设 $v = \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix}$ 是该子空间中的一个向量。条件 $\\mathcal{O}v = 0$ 意味着：\n$$ \\begin{pmatrix} 0 & 1 \\\\ 0 & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} = \\begin{pmatrix} v_2 \\\\ \\frac{1}{2}v_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\implies v_2 = 0 $$\n该零空间由向量 $e_1 = \\begin{pmatrix} 1 & 0 \\end{pmatrix}^T$ 张成，它对应于第一个状态变量 $x_{1,k}$。这就是不可观测子空间。\n\n接下来，我们识别与该子空间相关的模态。如果一个模态对应的特征向量位于不可观测子空间中，则该模态是不可观测的。矩阵 $A$ 是对角矩阵，所以其特征向量是标准基向量。与不可观测子空间相关的特征向量是 $e_1$。我们考察其对应的特征值：\n$$ A e_1 = \\begin{pmatrix} \\frac{3}{2} & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\frac{3}{2} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$\n该不可观测模态的特征值为 $\\lambda_1 = \\frac{3}{2}$。对于离散时间系统，如果一个模态的特征值模长大于或等于 $1$，则该模态是不稳定的。此处，$|\\lambda_1| = |\\frac{3}{2}| > 1$。\n由于该系统拥有一个不稳定的不可观测模态，因此系统对 $(A,H)$ 是不可检测的。\n\n2) 协方差递推的推导\n我们从第一性原理推导状态估计误差协方差 $P_{k|k} = E[(x_k - \\hat{x}_{k|k})(x_k - \\hat{x}_{k|k})^T]$ 的预测和更新方程。\n\n预测步骤：时刻 $k+1$ 的先验协方差为 $P_{k+1|k} = E[(x_{k+1} - \\hat{x}_{k+1|k})(x_{k+1} - \\hat{x}_{k+1|k})^T]$。预测误差为 $x_{k+1} - \\hat{x}_{k+1|k} = (A x_k + w_k) - A \\hat{x}_{k|k} = A(x_k - \\hat{x}_{k|k}) + w_k$。\n$$ P_{k+1|k} = E[ (A(x_k - \\hat{x}_{k|k}) + w_k) (A(x_k - \\hat{x}_{k|k}) + w_k)^T ] $$\n交叉项 $E[A(x_k - \\hat{x}_{k|k})w_k^T]$ 为零，因为误差 $x_k - \\hat{x}_{k|k}$ 是截至时刻 $k$ 的信息的函数，而 $w_k$ 与过去无关。因此：\n$$ P_{k+1|k} = A E[(x_k - \\hat{x}_{k|k})(x_k - \\hat{x}_{k|k})^T] A^T + E[w_k w_k^T] = A P_{k|k} A^T + Q $$\n\n更新步骤：更新依赖于联合高斯分布的性质。以过去的数据为条件，预测状态 $x_{k+1}$ 和新测量值 $y_{k+1}$ 是联合高斯的。后验协方差 $P_{k+1|k+1}$ 由条件高斯分布的标准公式给出：\n$P_{k+1|k+1} = \\Sigma_{xx} - \\Sigma_{xy} \\Sigma_{yy}^{-1} \\Sigma_{yx}$，其中 $\\Sigma_{xx} = P_{k+1|k}$，$\\Sigma_{xy} = P_{k+1|k}H^T$，以及 $\\Sigma_{yy} = HP_{k+1|k}H^T + R$。\n$$ P_{k+1|k+1} = P_{k+1|k} - P_{k+1|k} H^T (H P_{k+1|k} H^T + R)^{-1} H P_{k+1|k} $$\n\n针对给定系统的具体化：由于 $A$ 和 $Q$ 都是对角矩阵，且初始协方差 $P_{0|0}=I_2$ 也是对角矩阵，因此协方差矩阵 $P_{k|k}$ 和 $P_{k+1|k}$ 对所有 $k \\ge 0$ 都保持为对角矩阵。令 $P_{k|k} = \\text{diag}(P_{11,k|k}, P_{22,k|k})$。\n预测递推式为：\n$$ P_{k+1|k} = \\begin{pmatrix} \\frac{9}{4} & 0 \\\\ 0 & \\frac{1}{4} \\end{pmatrix} \\begin{pmatrix} P_{11,k|k} & 0 \\\\ 0 & P_{22,k|k} \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{9}{4}P_{11,k|k} + 1 & 0 \\\\ 0 & \\frac{1}{4}P_{22,k|k} + 1 \\end{pmatrix} $$\n对于更新步骤，我们计算卡尔曼增益的各分量。新息协方差 $S_{k+1} = H P_{k+1|k} H^T + R$ 为：\n$$ S_{k+1} = \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\begin{pmatrix} P_{11,k+1|k} & 0 \\\\ 0 & P_{22,k+1|k} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} + 1 = P_{22,k+1|k} + 1 $$\n卡尔曼增益为 $K_{k+1} = P_{k+1|k} H^T S_{k+1}^{-1}$：\n$$ K_{k+1} = \\begin{pmatrix} P_{11,k+1|k} & 0 \\\\ 0 & P_{22,k+1|k} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} (P_{22,k+1|k} + 1)^{-1} = \\begin{pmatrix} 0 \\\\ \\frac{P_{22,k+1|k}}{P_{22,k+1|k} + 1} \\end{pmatrix} $$\n$P_{k+1|k+1} = (I - K_{k+1}H)P_{k+1|k}$ 的更新为：\n$$ P_{k+1|k+1} = \\left( I_2 - \\begin{pmatrix} 0 \\\\ \\frac{P_{22,k+1|k}}{P_{22,k+1|k} + 1} \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\right) P_{k+1|k} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1-\\frac{P_{22,k+1|k}}{P_{22,k+1|k}+1} \\end{pmatrix} P_{k+1|k} $$\n$$ P_{k+1|k+1} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{P_{22,k+1|k}+1} \\end{pmatrix} \\begin{pmatrix} P_{11,k+1|k} & 0 \\\\ 0 & P_{22,k+1|k} \\end{pmatrix} = \\begin{pmatrix} P_{11,k+1|k} & 0 \\\\ 0 & \\frac{P_{22,k+1|k}}{P_{22,k+1|k}+1} \\end{pmatrix} $$\n这表明协方差递推是解耦的。第一个坐标的协方差不受测量更新的影响（$P_{11,k+1|k+1} = P_{11,k+1|k}$），因为 $H$ 只提供关于第二个状态的信息。这直接对应于第一个状态的不可观测性。\n\n3) $P_{11,k|k}$ 的闭式解\n我们必须求解第一个坐标的后验协方差的标量递推。结合 $(1,1)$ 分量的预测和更新步骤，可得：\n$$ P_{11,k+1|k+1} = P_{11,k+1|k} = \\frac{9}{4} P_{11,k|k} + 1 $$\n令 $p_k = P_{11,k|k}$。该递推关系为 $p_{k+1} = \\frac{9}{4} p_k + 1$，初始条件为 $p_0 = P_{11,0|0} = 1$。\n这是一个线性一阶非齐次递推关系。其解是特解与齐次方程解的和。\n齐次解为 $p_h(k) = C(\\frac{9}{4})^k$。\n对于特解，我们假设一个常数 $p^*$，即不动点：\n$$ p^* = \\frac{9}{4} p^* + 1 \\implies (1 - \\frac{9}{4})p^* = 1 \\implies -\\frac{5}{4}p^* = 1 \\implies p^* = -\\frac{4}{5} $$\n通解为 $p_k = C(\\frac{9}{4})^k - \\frac{4}{5}$。\n我们使用初始条件 $p_0 = 1$ 来求出常数 $C$：\n$$ p_0 = 1 = C \\left(\\frac{9}{4}\\right)^0 - \\frac{4}{5} = C - \\frac{4}{5} \\implies C = 1 + \\frac{4}{5} = \\frac{9}{5} $$\n将 $C$ 代回，得到 $P_{11,k|k}$ 的闭式表达式为：\n$$ P_{11,k|k} = \\frac{9}{5} \\left(\\frac{9}{4}\\right)^k - \\frac{4}{5} $$\n该方差呈指数增长，这与相关状态由噪声驱动、不稳定且不可观测的事实相符。", "answer": "$$\\boxed{\\frac{9}{5} \\left(\\frac{9}{4}\\right)^{k} - \\frac{4}{5}}$$", "id": "2753278"}, {"introduction": "在实际应用中，我们建立的模型永远不可能是完美的。本练习将从理论上的灾难性失效转向更微妙的滤波器调参与模型失配问题。您将探索低估过程噪声协方差$\\mathbf{Q}$这一常见实际挑战所带来的后果，并学习如何通过分析估计滞后和新息统计特性等关键指标，来诊断由此导致的滤波器“迟钝”现象。[@problem_id:2753317]", "problem": "考虑一个离散时间线性时不变系统，其匀速运动学状态受到未建模加速度的驱动，并通过含噪声的位置测量进行观测。其状态和测量模型为\n$$\n\\mathbf{x}_{k+1} = \\mathbf{F}\\,\\mathbf{x}_{k} + \\mathbf{w}_{k}, \\quad \\mathbf{z}_{k} = \\mathbf{H}\\,\\mathbf{x}_{k} + \\mathbf{v}_{k},\n$$\n其中 $\\mathbf{x}_{k} \\in \\mathbb{R}^{2}$ 堆叠了位置和速度，$\\mathbf{z}_{k} \\in \\mathbb{R}$ 是位置测量值，$\\mathbf{F} = \\begin{bmatrix} 1 & T \\\\ 0 & 1 \\end{bmatrix}$，采样周期 $T>0$，$\\mathbf{H} = \\begin{bmatrix} 1 & 0 \\end{bmatrix}$，$\\mathbf{w}_{k} \\sim \\mathcal{N}(\\mathbf{0},\\mathbf{Q}_{\\text{true}})$ 表示驱动该运动学的白噪声加速度的影响，$\\mathbf{v}_{k} \\sim \\mathcal{N}(0,R)$ 是测量噪声，其方差 $R>0$ 已知。假设 $\\mathbf{w}_{k}$ 和 $\\mathbf{v}_{k}$ 相互独立，在时间上独立，并且独立于初始状态。\n\n一位实践者实现了一个线性高斯卡尔曼滤波器，使用了与上述相同的 $\\mathbf{F}$ 和 $\\mathbf{H}$ 以及正确的 $R$，但低估了过程噪声协方差，使用了 $\\mathbf{Q}_{\\text{assumed}} = \\alpha\\,\\mathbf{Q}_{\\text{true}}$，其中 $0<\\alpha<1$。令 $\\widehat{\\mathbf{x}}_{k|k-1}$ 和 $\\widehat{\\mathbf{x}}_{k|k}$ 分别表示先验和后验估计，定义新息为 $\\tilde{y}_{k} = \\mathbf{z}_{k} - \\mathbf{H}\\,\\widehat{\\mathbf{x}}_{k|k-1}$，其预测新息协方差为 $S_{k} = \\mathbf{H}\\,\\mathbf{P}_{k|k-1}\\,\\mathbf{H}^{\\top} + R$，其中 $\\mathbf{P}_{k|k-1}$ 是由滤波器计算的先验误差协方差。归一化新息平方 (NIS) 为 $\\epsilon_{k} = \\tilde{y}_{k}^{2}/S_{k}$，在正确建模的情况下，其理论均值等于测量维度，即 $\\mathbb{E}[\\epsilon_{k}] = 1$。\n\n仅使用线性高斯卡尔曼滤波器的基本性质（状态空间模型、预测和更新递归、以及新息定义），推断相对于真实的未建模动态，低估 $\\mathbf{Q}$ 会如何影响滤波器的响应能力和新息统计特性。选择在此场景下所有必然成立的陈述，特别是在真实运动表现出持续加速度，从而违反匀速假设的时期。\n\nA. 由于当假设的 $\\mathbf{Q}$ 减小时卡尔曼增益减小，滤波器对状态真实变化的响应表现出更大的滞后。\n\nB. 新息的样本方差变得小于预测的 $S_{k}$，因此归一化新息平方倾向于小于其理论均值。\n\nC. 在机动期间，新息序列在时间上变为正相关，违反了白噪声假设。\n\nD. 滤波器过度加权测量值（卡尔曼增益更大），减少了滞后但增加了对测量噪声的敏感性。\n\nE. 对于对 $\\mathbf{Q}$ 的足够严重的低估，滤波器会变得统计上不一致，其平均归一化新息平方会超过其理论均值。", "solution": "用户提供了一个关于当过程噪声协方差被低估时卡尔曼滤波器行为的问题。我将首先验证问题陈述，然后进行严谨的推导和选项评估。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n-   离散时间线性时不变系统模型：\n    -   状态模型：$\\mathbf{x}_{k+1} = \\mathbf{F}\\,\\mathbf{x}_{k} + \\mathbf{w}_{k}$\n    -   测量模型：$\\mathbf{z}_{k} = \\mathbf{H}\\,\\mathbf{x}_{k} + \\mathbf{v}_{k}$\n-   状态向量 $\\mathbf{x}_{k} \\in \\mathbb{R}^{2}$ (位置, 速度)。\n-   测量 $\\mathbf{z}_{k} \\in \\mathbb{R}$ (位置)。\n-   状态转移矩阵：$\\mathbf{F} = \\begin{bmatrix} 1 & T \\\\ 0 & 1 \\end{bmatrix}$，采样周期 $T>0$。\n-   测量矩阵：$\\mathbf{H} = \\begin{bmatrix} 1 & 0 \\end{bmatrix}$。\n-   真实过程噪声：$\\mathbf{w}_{k} \\sim \\mathcal{N}(\\mathbf{0},\\mathbf{Q}_{\\text{true}})$，表示白噪声加速度。\n-   测量噪声：$\\mathbf{v}_{k} \\sim \\mathcal{N}(0,R)$，方差 $R>0$ 已知。\n-   噪声性质：$\\mathbf{w}_{k}$、$\\mathbf{v}_{k}$ 均为零均值，相互独立，在时间上独立，且独立于初始状态。\n-   卡尔曼滤波器实现细节：\n    -   使用正确的 $\\mathbf{F}$、$\\mathbf{H}$ 和 $R$。\n    -   使用假设的过程噪声协方差 $\\mathbf{Q}_{\\text{assumed}} = \\alpha\\,\\mathbf{Q}_{\\text{true}}$，其中 $0<\\alpha<1$。\n-   定义：\n    -   新息：$\\tilde{y}_{k} = \\mathbf{z}_{k} - \\mathbf{H}\\,\\widehat{\\mathbf{x}}_{k|k-1}$。\n    -   滤波器计算的（预测的）新息协方差：$S_{k} = \\mathbf{H}\\,\\mathbf{P}_{k|k-1}\\,\\mathbf{H}^{\\top} + R$。\n    -   归一化新息平方 (NIS)：$\\epsilon_{k} = \\tilde{y}_{k}^{2}/S_{k}$。\n    -   在正确建模下 NIS 的理论均值：$\\mathbb{E}[\\epsilon_{k}] = 1$。\n-   场景：分析应考虑滤波器性能，特别是在持续加速期间，这违反了滤波器的基本匀速运动模型。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，提法明确且客观。它描述了估计理论中的一个典型问题：失配卡尔曼滤波器的分析。该系统模型是一个标准的匀速模型，而对新息（特别是NIS及其白噪声特性）的分析是诊断滤波器性能和一致性的基本技术。低估过程噪声（$\\mathbf{Q}_{\\text{assumed}} < \\mathbf{Q}_{\\text{true}}$）的前提是一个常见的实际问题，会导致一些众所周知的、非平凡的后果。问题陈述没有科学或逻辑上的缺陷，对于定性分析是完整的，并且与指定主题直接相关。\n\n**步骤3：结论与行动**\n该问题是**有效的**。将推导解决方案。\n\n### 推导与选项分析\n\n问题的核心是在卡尔曼滤波器递归中使用 $\\mathbf{Q}_{\\text{assumed}} = \\alpha\\,\\mathbf{Q}_{\\text{true}}$（其中 $0 < \\alpha < 1$ ）所带来的后果。让我们用不带上标的符号表示滤波器计算的量，用上标 `true` 表示真实的潜在量。\n\n卡尔曼滤波器的协方差预测（时间更新）为：\n$$\n\\mathbf{P}_{k|k-1} = \\mathbf{F}\\,\\mathbf{P}_{k-1|k-1}\\,\\mathbf{F}^{\\top} + \\mathbf{Q}_{\\text{assumed}}\n$$\n由于 $\\mathbf{Q}_{\\text{assumed}}$ 小于真实协方差 $\\mathbf{Q}_{\\text{true}}$，滤波器计算的先验协方差 $\\mathbf{P}_{k|k-1}$ 会是对真实先验误差协方差 $\\mathbf{P}^{\\text{true}}_{k|k-1} = \\mathbb{E}[(\\mathbf{x}_{k} - \\widehat{\\mathbf{x}}_{k|k-1})(\\mathbf{x}_{k} - \\widehat{\\mathbf{x}}_{k|k-1})^{\\top}]$ 的低估。滤波器对其模型预测变得过度自信，认为状态不确定性比实际情况要小。\n\n让我们分析其对卡尔曼增益 $\\mathbf{K}_{k}$ 的影响：\n$$\n\\mathbf{K}_{k} = \\mathbf{P}_{k|k-1}\\,\\mathbf{H}^{\\top}\\,S_{k}^{-1} = \\mathbf{P}_{k|k-1}\\,\\mathbf{H}^{\\top}\\,(\\mathbf{H}\\,\\mathbf{P}_{k|k-1}\\,\\mathbf{H}^{\\top} + R)^{-1}\n$$\n卡尔曼增益在模型预测的不确定性（由 $\\mathbf{P}_{k|k-1}$ 表示）和测量的不确定性（由 $R$ 表示）之间取得平衡。因为滤波器计算的 $\\mathbf{P}_{k|k-1}$ 人为地偏小，所以滤波器会低估测量的贡献。较小的 $\\mathbf{P}_{k|k-1}$ 会导致较小的卡尔曼增益 $\\mathbf{K}_{k}$。在一个简化的标量类比中，增益为 $P/(P+R)$，减小 $P$ 显然会减小增益。这个原理在矩阵情况下同样成立。滤波器过于相信自己（有缺陷的）模型，而对传入的测量值信任不足。\n\n现在我们评估每个陈述。\n\n**A. 由于当假设的 Q 减小时卡尔曼增益减小，滤波器对状态真实变化的响应表现出更大的滞后。**\n状态更新为 $\\widehat{\\mathbf{x}}_{k|k} = \\widehat{\\mathbf{x}}_{k|k-1} + \\mathbf{K}_{k}\\,\\tilde{y}_{k}$。如上所述，低估 $\\mathbf{Q}$ 会导致卡尔曼增益 $\\mathbf{K}_{k}$ 变小。在机动（持续加速）期间，真实状态 $\\mathbf{x}_{k}$ 会偏离匀速预测 $\\widehat{\\mathbf{x}}_{k|k-1}$。这会产生一个大的、系统性的新息 $\\tilde{y}_{k}$。然而，由于 $\\mathbf{K}_{k}$ 很小，施加到状态估计上的修正也很小。滤波器对吸收来自测量的新信息反应迟缓，无法及时跟踪机动。这种行为被描述为增大的滞后。该陈述中提供的理由完全正确。\n**结论：正确。**\n\n**B. 新息的样本方差变得小于预测的 $S_{k}$，因此归一化新息平方倾向于小于其理论均值。**\n新息为 $\\tilde{y}_{k} = \\mathbf{z}_{k} - \\mathbf{H}\\,\\widehat{\\mathbf{x}}_{k|k-1} = \\mathbf{H}(\\mathbf{x}_{k} - \\widehat{\\mathbf{x}}_{k|k-1}) + \\mathbf{v}_{k}$。真实的新息会比预期大，因为模型误差 $(\\mathbf{x}_{k} - \\widehat{\\mathbf{x}}_{k|k-1})$ 大于滤波器协方差 $\\mathbf{P}_{k|k-1}$ 所隐含的误差。因此，新息的真实方差 $S^{\\text{true}}_{k} = \\mathbb{E}[\\tilde{y}_{k}^{2}]$ 将大于滤波器预测的方差 $S_{k} = \\mathbf{H}\\,\\mathbf{P}_{k|k-1}\\,\\mathbf{H}^{\\top} + R$。因此，作为 $S^{\\text{true}}_{k}$ 的估计，新息的样本方差将比 $S_{k}$ *更大*。这使得平均归一化新息平方(NIS)，$\\mathbb{E}[\\tilde{y}_{k}^{2}/S_{k}] = S^{\\text{true}}_{k}/S_{k}$，大于 1。该陈述的说法正好相反。\n**结论：错误。**\n\n**C. 在机动期间，新息序列在时间上变为正相关，违反了白噪声假设。**\n一个正确建模的卡尔曼滤波器会产生零均值、白色（不相关）的新息序列。在这个问题中，模型是不正确的，尤其是在持续机动期间。具有低增益的滤波器会持续滞后于真实轨迹。这意味着在时间 $k$ 的估计误差没有得到完全修正。因此，时间 $k+1$ 的误差将与时间 $k$ 的误差相关。由于新息 $\\tilde{y}_k$ 直接反映了先验估计误差 $\\mathbf{x}_{k} - \\widehat{\\mathbf{x}}_{k|k-1}$，状态估计中系统性的、缓慢修正的误差将导致系统性的、时间相关的新息序列。具体来说，持续的滞后将导致 $\\tilde{y}_k$ 和 $\\tilde{y}_{k+1}$ 具有相同的符号，表明存在正时间相关性。这违反了白噪声特性，而白噪声特性是模型失配的一个关键指标。\n**结论：正确。**\n\n**D. 滤波器过度加权测量值（卡尔曼增益更大），减少了滞后但增加了对测量噪声的敏感性。**\n这个陈述描述的是过程噪声 $\\mathbf{Q}$ 被*高估*的滤波器行为。高估 $\\mathbf{Q}$ 会使滤波器不信任其模型，导致大的 $\\mathbf{P}_{k|k-1}$、大的卡尔曼增益 $\\mathbf{K}_{k}$，以及对测量值的严重依赖。这与问题中描述的情景相反。低估 $\\mathbf{Q}$ 会导致*更小*的增益和*更大*的滞后。\n**结论：错误。**\n\n**E. 对于对 Q 的足够严重的低估，滤波器会变得统计上不一致，其平均归一化新息平方会超过其理论均值。**\n统计一致性意味着滤波器对其自身不确定性的评估是正确的。对此的一个关键检验是NIS检验。NIS为 $\\epsilon_{k} = \\tilde{y}_{k}^{2}/S_{k}$。其理论期望是测量的维度，本例中为 1。而实际期望是 $\\mathbb{E}[\\epsilon_{k}] = \\mathbb{E}[\\tilde{y}_{k}^{2}]/S_{k} = S^{\\text{true}}_{k}/S_k$。如在选项 B 的分析中所述，低估 $\\mathbf{Q}$ 会导致滤波器低估其预测误差，因此 $S_{k} < S^{\\text{true}}_{k}$。这直接意味着 $\\mathbb{E}[\\epsilon_{k}] > 1$。平均NIS与其理论均值的持续性偏差是统计不一致性的定义。因此，该陈述是正确的。\n**结论：正确。**", "answer": "$$\\boxed{ACE}$$", "id": "2753317"}]}