{"hands_on_practices": [{"introduction": "要真正掌握一个概念，最好的方法莫过于从最简单的情形入手。本练习将引导你处理一个标量（一维）线性系统，这是理解代数Riccati方程（Algebraic Riccati Equation, ARE）最清晰的起点。你将直接从哈密顿-雅可比-贝尔曼（Hamilton-Jacobi-Bellman, HJB）最优性原理出发，推导出标量ARE，然后通过一个具体的数值算例，亲手求解该方程并挑选出能够保证闭环系统稳定性的解[@problem_id:2699184]。这个过程不仅能巩固你对基本理论的理解，还能让你体会到最优控制解的物理意义——即稳定化系统。", "problem": "考虑由 $\\dot{x}(t) = a\\,x(t) + b\\,u(t)$ 控制的标量线性时不变系统，其无穷时域二次性能指标为 $J = \\int_{0}^{\\infty} \\big(q\\,x(t)^{2} + r\\,u(t)^{2}\\big)\\,dt$。从Bellman最优性原理出发，导出无穷时域情形下的稳态Hamilton–Jacobi–Bellman (HJB) 方程，并使用二次值函数拟设 $V(x) = P\\,x^{2}$，其中 $P$ 为常数。通过对HJB哈密顿量关于 $u$ 进行最小化，推导 $P$ 所满足的标量连续时间代数Riccati方程 (ARE)。然后，对于给定数据 $a=1$, $b=1$, $q=2$, $r=1$，显式求解所得的标量方程，并选择使闭环系统 $\\dot{x}(t) = \\big(a - b\\,r^{-1}b\\,P\\big)\\,x(t)$ 渐近稳定的稳定化解。请将您的最终答案表示为稳定化解 $P$ 的单个闭式解析表达式。无需四舍五入。", "solution": "出发点是关于最优值函数 $V(x)$ 的无穷时域稳态Hamilton–Jacobi–Bellman (HJB) 方程，\n$$\n0 \\;=\\; \\min_{u}\\,\\Big\\{\\, q\\,x^{2} + r\\,u^{2} + V_{x}(x)\\,\\big(a\\,x + b\\,u\\big) \\Big\\},\n$$\n其中 $V_{x}(x)$ 表示 $V$ 对 $x$ 的导数。我们假定一个二次值函数拟设 $V(x) = P\\,x^{2}$，其中 $P$ 为常数。于是有 $V_{x}(x) = 2\\,P\\,x$，HJB哈密顿量变为\n$$\n\\mathcal{H}(x,u) \\;=\\; q\\,x^{2} + r\\,u^{2} + 2\\,P\\,x\\,(a\\,x + b\\,u).\n$$\n为求得最优输入，将 $\\mathcal{H}(x,u)$ 对 $u$ 最小化。一阶最优性条件是\n$$\n\\frac{\\partial \\mathcal{H}}{\\partial u} \\;=\\; 2\\,r\\,u + 2\\,P\\,x\\,b \\;=\\; 0,\n$$\n由此可得最优控制律\n$$\nu^{\\star}(x) \\;=\\; -\\,\\frac{b\\,P}{r}\\,x.\n$$\n将 $u^{\\star}(x)$ 代回哈密顿量，并应用HJB方程。首先计算各项：\n- 状态惩罚项为 $q\\,x^{2}$。\n- 输入惩罚项为 $r\\,(u^{\\star})^{2} = r\\,\\Big(\\frac{b^{2}P^{2}}{r^{2}}\\,x^{2}\\Big) = \\frac{b^{2}}{r}\\,P^{2}\\,x^{2}$。\n- 耦合项为 $V_{x}\\,(a\\,x + b\\,u^{\\star}) = 2\\,P\\,x\\,\\Big(a\\,x + b\\big(-\\frac{b\\,P}{r}\\,x\\big)\\Big) = \\big(2\\,a\\,P - \\frac{2\\,b^{2}}{r}\\,P^{2}\\big)\\,x^{2}$。\n因此，\n$$\n0 \\;=\\; q\\,x^{2} + \\frac{b^{2}}{r}\\,P^{2}\\,x^{2} + \\Big(2\\,a\\,P - \\frac{2\\,b^{2}}{r}\\,P^{2}\\Big)\\,x^{2}\n\\;=\\; \\Big(q + 2\\,a\\,P - \\frac{b^{2}}{r}\\,P^{2}\\Big)\\,x^{2}.\n$$\n因为该式必须对所有 $x$ 成立，所以 $P$ 的标量连续时间代数Riccati方程 (ARE) 为\n$$\nq + 2\\,a\\,P - \\frac{b^{2}}{r}\\,P^{2} \\;=\\; 0.\n$$\n\n对于给定数据 $a=1$, $b=1$, $q=2$, $r=1$，该方程变为\n$$\n2 + 2\\,P - P^{2} \\;=\\; 0,\n$$\n或等价地\n$$\nP^{2} - 2\\,P - 2 \\;=\\; 0.\n$$\n解此二次方程可得\n$$\nP \\;=\\; \\frac{2 \\pm \\sqrt{4 + 8}}{2} \\;=\\; 1 \\pm \\sqrt{3}.\n$$\n\n为了选择稳定化解，我们考察最优控制器下的闭环标量动力学。最优反馈为 $u^{\\star}(x) = -\\frac{b\\,P}{r}\\,x$，因此闭环系统为\n$$\n\\dot{x}(t) \\;=\\; \\Big(a - \\frac{b^{2}}{r}\\,P\\Big)\\,x(t) \\;=\\; \\big(1 - P\\big)\\,x(t).\n$$\n渐近稳定性要求 $1 - P < 0$，即 $P > 1$。在两个根 $1 \\pm \\sqrt{3}$ 中，只有 $1 + \\sqrt{3}$ 满足 $P > 1$ 且为非负。因此，稳定化解为\n$$\nP^{\\star} \\;=\\; 1 + \\sqrt{3}.\n$$", "answer": "$$\\boxed{1+\\sqrt{3}}$$", "id": "2699184"}, {"introduction": "在我们投入到更复杂的矩阵Riccati方程的求解之前，一个根本性的问题值得我们深思：一个最优且能稳定系统的控制器，其存在的先决条件是什么？本练习将探讨这一核心问题，引导你运用能控性（stabilizability）和能检测性（detectability）这两个关键概念来判断一个给定的线性二次调节器（Linear Quadratic Regulator, LQR）问题是否存在稳定的解[@problem_id:2699182]。通过在尝试求解ARE之前分析系统的结构特性，你将培养出一种更为深刻的理论直觉，学会预判一个最优控制问题是否“可解”。", "problem": "考虑一个状态维数为$2$的线性时不变系统，由$\\dot{x}(t)=A x(t)+B u(t)$给出，其中$A=\\mathrm{diag}(1,-1)$且$B=\\begin{bmatrix}1\\\\1\\end{bmatrix}$。考虑无穷时域线性二次调节器(LQR)问题，其代价函数为$J(x_{0},u)=\\int_{0}^{\\infty}\\big(x(t)^{\\top} Q x(t)+u(t)^{\\top} R u(t)\\big)\\,dt$，其中$Q=I_{2}$且$R=1$。在不编写或假设任何特定的Riccati公式的情况下，从Hamilton-Jacobi-Bellman最优性原理以及能镇定性和能检测性的定义出发，判断对于给定的数据，是否存在一个连续时间代数Riccati方程(ARE)的镇定解。在你的推理中，使用一个因子$Q=C^{\\top} C$，并为$C$选择一个与$Q$一致的具体值。选择正确的陈述。\n\nA. 不存在镇定ARE解，因为对$(A,B)$是不能镇定的；在特征值$+1$处有一个不可控的不稳定模态。\n\nB. 不存在镇定ARE解，因为对$(Q^{1/2},A)$是不能检测的；在特征值$+1$处的不稳定模态在状态惩罚中是不可观测的。\n\nC. 存在唯一的镇定ARE解，因为$(A,B)$是能镇定的（实际上是能控的），并且$(Q^{1/2},A)$是能检测的（实际上，对于一个合适的$C$，是能观的）。\n\nD. 存在镇定ARE解，但不是唯一的；存在多个半正定解，产生不同的镇定反馈。\n\nE. 镇定ARE解的存在性取决于初始条件$x(0)$；对于某些$x(0)$存在，而对于另一些则不存在。", "solution": "该问题陈述具有科学依据，提法得当，且客观。它为标准的线性二次调节器(LQR)问题提供了一套完整且一致的数据。矩阵$A$、$B$、$Q$、$R$的定义恰当，维度一致。关于代数Riccati方程(ARE)镇定解存在性的问题是最优控制理论的核心课题。因此，该问题是有效的，并且可以推导出解。\n\n该问题涉及线性时不变系统$\\dot{x}(t) = Ax(t) + Bu(t)$的无穷时域LQR问题，其代价泛函为$J(u) = \\int_{0}^{\\infty} (x^\\top Q x + u^\\top R u) dt$。最优镇定反馈控制律的存在性与ARE镇定解的存在性直接相关。\n\n我们按照指示，从Hamilton-Jacobi-Bellman (HJB)方程开始，该方程指出最优值函数$V(x) = \\min_u \\int_0^\\infty (x^\\top Q x + u^\\top R u) dt$必须满足：\n$$\n\\min_{u(t)} \\left\\{ \\frac{d V(x)}{dt} + x^\\top Q x + u^\\top R u \\right\\} = 0\n$$\n对于一个LTI系统，值函数沿着系统轨迹的时间导数为：\n$$\n\\frac{d V(x)}{dt} = \\left(\\frac{\\partial V}{\\partial x}\\right)^\\top \\dot{x} = \\left(\\frac{\\partial V}{\\partial x}\\right)^\\top (Ax + Bu)\n$$\n因此，HJB方程变为：\n$$\n\\min_{u} \\left\\{ \\left(\\frac{\\partial V}{\\partial x}\\right)^\\top (Ax + Bu) + x^\\top Q x + u^\\top R u \\right\\} = 0\n$$\n对于LQR问题，值函数是二次型形式，$V(x) = x^\\top P x$，其中$P$是一个对称半正定矩阵。其梯度为$\\frac{\\partial V}{\\partial x} = 2Px$。将此代入HJB方程得到：\n$$\n\\min_{u} \\left\\{ (2Px)^\\top (Ax + Bu) + x^\\top Q x + u^\\top R u \\right\\} = 0\n$$\n$$\n\\min_{u} \\left\\{ x^\\top(A^\\top P + PA)x + 2x^\\top PBu + x^\\top Q x + u^\\top R u \\right\\} = 0\n$$\n大括号内的表达式是关于$u$的二次函数。由于$R=1 > 0$，它是关于$u$的凸函数。通过将关于$u$的梯度设为零来求得最小值：\n$$\n\\frac{\\partial}{\\partial u} \\left( \\dots \\right) = 2(PBx)^\\top + 2Ru = 2B^\\top Px + 2Ru = 0\n$$\n这给出了反馈形式的最优控制律：$u^*(x) = -R^{-1}B^\\top Px$。\n\n将$u^*$代回HJB方程：\n$$\nx^\\top(A^\\top P + PA)x + 2x^\\top PB(-R^{-1}B^\\top Px) + x^\\top Q x + (-R^{-1}B^\\top Px)^\\top R (-R^{-1}B^\\top Px) = 0\n$$\n$$\nx^\\top(A^\\top P + PA)x - 2x^\\top PBR^{-1}B^\\top Px + x^\\top Q x + x^\\top PBR^{-1}B^\\top Px = 0\n$$\n$$\nx^\\top(A^\\top P + PA - PBR^{-1}B^\\top P + Q)x = 0\n$$\n由于这必须对所有$x(t)$都成立，所以矩阵表达式必须为零。这给出了连续时间代数Riccati方程(ARE)：\n$$\nA^\\top P + PA - PBR^{-1}B^\\top P + Q = 0\n$$\n一个“镇定解”是一个对称半正定矩阵$P$，它满足ARE，并且使得闭环系统矩阵$A_{cl} = A - BR^{-1}B^\\top P$是赫尔维茨(Hurwitz)的（其所有特征值都具有负实部）。\n\n最优控制的一个基本定理指出，当且仅当满足以下两个条件时，ARE存在唯一的、半正定的、镇定的解$P$：\n1.  对$(A, B)$是能镇定的。\n2.  对$(C, A)$是能检测的，其中$C$是满足$Q = C^\\top C$的任何矩阵。题目中的符号建议$C=Q^{1/2}$。\n\n我们现在必须为给定的数据验证这两个条件：\n$A = \\begin{bmatrix} 1 & 0 \\\\ 0 & -1 \\end{bmatrix}$，$B = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$，$Q = I_2 = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}$，$R=1$。\n\n**1. 验证$(A, B)$的能镇定性**\n\n如果$A$的所有不稳定模态都是能控的，那么对$(A,B)$是能镇定的。$A$的特征值为$\\lambda_1 = 1$（不稳定）和$\\lambda_2 = -1$（稳定）。我们必须检查与$\\lambda_1 = 1$相关的模态是否能控。\n我们使用Popov-Belevitch-Hautus (PBH)判据来检验能控性。如果对于所有特征值$\\lambda$，$\\mathrm{rank}[A - \\lambda I \\quad B] = n$，则系统是能控的。能镇定性仅要求对不稳定的特征值，即$\\mathrm{Re}(\\lambda) \\ge 0$，进行此项检查。\n对于$\\lambda_1 = 1$：\n$$\n[A - 1 \\cdot I \\quad B] = \\begin{bmatrix} 1-1 & 0 & 1 \\\\ 0 & -1-1 & 1 \\end{bmatrix} = \\begin{bmatrix} 0 & 0 & 1 \\\\ 0 & -2 & 1 \\end{bmatrix}\n$$\n这个$2 \\times 3$矩阵的秩为$2$，因为两行是线性无关的。由于秩等于状态维数$n=2$，所以不稳定模态是能控的。因此，对$(A, B)$是能镇定的。\n事实上，我们可以通过检查能控性矩阵$\\mathcal{C} = [B \\quad AB]$来检验完全能控性：\n$AB = \\begin{bmatrix} 1 & 0 \\\\ 0 & -1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix}$。\n$\\mathcal{C} = \\begin{bmatrix} 1 & 1 \\\\ 1 & -1 \\end{bmatrix}$。\n$\\det(\\mathcal{C}) = (1)(-1) - (1)(1) = -2 \\ne 0$。秩为$2$，所以系统是完全能控的。能控性意味着能镇定性。\n\n**2. 验证$(C, A)$的能检测性**\n\n给定$Q = I_2$，满足$Q=C^\\top C$的一个有效选择是$C=I_2$。选项中的记号$(Q^{1/2}, A)$意味着$C = Q^{1/2}$，而对于$Q=I_2$，我们有$C=Q^{1/2}=I_2$。\n如果$A$的所有不稳定模态都是能观的，那么对$(C, A)$是能检测的。我们再次检查不稳定的特征值$\\lambda_1 = 1$。\n使用PBH判据来检验能观性，如果对于所有特征值$\\lambda$，$\\mathrm{rank}\\begin{bmatrix} A - \\lambda I \\\\ C \\end{bmatrix} = n$，则系统是能观的。能检测性仅要求对不稳定模态进行此项检查。\n对于$\\lambda_1 = 1$：\n$$\n\\begin{bmatrix} A - 1 \\cdot I \\\\ C \\end{bmatrix} = \\begin{bmatrix} 1-1 & 0 \\\\ 0 & -1-1 \\\\ 1 & 0 \\\\ 0 & 1 \\end{bmatrix} = \\begin{bmatrix} 0 & 0 \\\\ 0 & -2 \\\\ 1 & 0 \\\\ 0 & 1 \\end{bmatrix}\n$$\n这个$4 \\times 2$矩阵的秩为$2$，因为最后两行（即$C=I_2$）是线性无关的。由于秩等于状态维数$n=2$，所以不稳定模态是能观的。因此，对$(C, A)$是能检测的。\n事实上，系统是完全能观的，这可以由能观性矩阵$\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\end{bmatrix}$显示：\n$CA = I_2 A = A = \\begin{bmatrix} 1 & 0 \\\\ 0 & -1 \\end{bmatrix}$。\n$\\mathcal{O} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 0 \\\\ 0 & -1 \\end{bmatrix}$。\n这个矩阵的列秩为$2$。因此，对$(C, A)$是能观的。能观性意味着能检测性。\n\n**结论**\n由于对$(A, B)$是能镇定的（实际上是能控的），且对于$C=Q^{1/2}=I_2$的对$(C, A)$是能检测的（实际上是能观的），因此ARE存在唯一的、对称的、半正定的、镇定的解$P$的条件得到满足。\n\n现在我们来评估所提供的选项。\n\n**A. 不存在镇定ARE解，因为对$(A,B)$是不能镇定的；在特征值$+1$处有一个不可控的不稳定模态。**\n这个说法是**错误的**。如上所示，对$(A,B)$是完全能控的，因此是能镇定的。对不稳定特征值$\\lambda = 1$的PBH判据证实了该模态是能控的。\n\n**B. 不存在镇定ARE解，因为对$(Q^{1/2},A)$是不能检测的；在特征值$+1$处的不稳定模态在状态惩罚中是不可观测的。**\n这个说法是**错误的**。对于$Q=I_2$，我们选择$C=Q^{1/2}=I_2$。对$(I_2,A)$是完全能观的，因此是能检测的。对不稳定特征值$\\lambda = 1$的PBH判据证实了该模态是能观的。\n\n**C. 存在唯一的镇定ARE解，因为$(A,B)$是能镇定的（实际上是能控的），并且$(Q^{1/2},A)$是能检测的（实际上，对于一个合适的$C$，是能观的）。**\n这个说法是**正确的**。我们的分析证实了此选项中的每一个论断。$(A,B)$的能镇定性和$(Q^{1/2}, A)$的能检测性都得到了满足。这些条件不仅满足，而且是以其更强的形式（能控性和能观性）满足的。这保证了镇定ARE解的存在性和唯一性。\n\n**D. 存在镇定ARE解，但不是唯一的；存在多个半正定解，产生不同的镇定反馈。**\n这个说法是**错误的**。能镇定性和能检测性的结合保证了*唯一*的半正定镇定解$P$。\n\n**E. 镇定ARE解的存在性取决于初始条件$x(0)$；对于某些$x(0)$存在，而对于另一些则不存在。**\n这个说法是**错误的**。ARE是关于矩阵$P$的代数方程。其解，以及镇定反馈律的存在性，仅取决于系统和代价矩阵$(A, B, Q, R)$，而不取决于初始状态$x(0)$。所得到的控制律对任何初始条件都是最优的。", "answer": "$$\\boxed{C}$$", "id": "2699182"}, {"introduction": "掌握了基本推导和理论前提之后，我们便可以迎接更具挑战性的多维系统了。本练习将理论付诸实践，要求你为一个具有不稳定模式的二维系统设计一个LQR控制器[@problem_id:2699185]。你将把ARE从标量形式推广到矩阵形式，求解得到的矩阵方程，并计算出能够镇定该不稳定系统的最优反馈增益$K$。这个练习完整地展示了LQR框架的威力，让你亲身体验如何利用最优控制理论来设计高性能的反馈控制器，将一个不稳定的系统变得稳定。", "problem": "考虑连续时间线性二次调节器 (LQR) 问题，其状态动态为 $\\dot{x}(t)=A x(t)+B u(t)$，代价函数为 $J(x(0))=\\int_{0}^{\\infty}\\big(x(t)^{\\top} Q\\, x(t)+u(t)^{\\top} R\\, u(t)\\big)\\,dt$，其中 $A\\in\\mathbb{R}^{2\\times 2}$，$B\\in\\mathbb{R}^{2\\times 1}$，$Q\\in\\mathbb{R}^{2\\times 2}$ 是对称半正定矩阵，$R\\in\\mathbb{R}^{1\\times 1}$ 是对称正定矩阵。仅从连续时间最优控制的 Hamilton–Jacobi–Bellman (HJB) 最优性条件和二次价值函数拟设 $V(x)=x^{\\top} P x$（其中 $P\\in\\mathbb{R}^{2\\times 2}$ 为对称矩阵）出发，推导出 $P$ 为满足最优性必须遵循的连续时间代数 Riccati 方程 (ARE)。\n\n然后将您的推导应用于具体数据\n$$\nA=\\begin{bmatrix}1 & 0\\\\ 0 & -2\\end{bmatrix},\\quad\nB=\\begin{bmatrix}1\\\\ 0\\end{bmatrix},\\quad\nQ=I_{2},\\quad\nR=1,\n$$\n并明确写出由此产生的矩阵方程 (ARE)，以未知对称矩阵 $P=\\begin{bmatrix}p_{11} & p_{12}\\\\ p_{12} & p_{22}\\end{bmatrix}$ 的形式表示。求解此 ARE，得到稳定化解 $P$，该解能产生最优反馈 $u^{\\star}(t)=-K x(t)$，使得 $A-BK$ 是 Hurwitz 矩阵，尽管 $A$ 具有一个不稳定的特征值。\n\n最后，计算替代与第一个状态相关的不稳定开环特征值的闭环特征值，并报告其精确值。将最终答案表示为不含四舍五入和单位的精确表达式。", "solution": "该问题陈述是最优控制理论中的一个标准表述，具有科学依据，是适定且客观的。它包含了获得唯一、稳定且有意义解所需的所有信息。因此，该问题是有效的。\n\n任务是从 Hamilton-Jacobi-Bellman (HJB) 方程推导代数 Riccati 方程 (ARE)，将其应用于一个具体的线性二次调节器 (LQR) 问题，求解稳定化反馈，并确定最终的闭环特征值。\n\n第一部分：代数 Riccati 方程的推导\n\n连续时间 HJB 方程为最优性提供了充分必要条件。对于一个成本泛函为 $J(u) = \\int_{0}^{\\infty} L(x(t), u(t)) dt$ 的无限时域问题，价值函数 $V(x)$ 的 HJB 方程为：\n$$\n0 = \\min_{u} \\left\\{ L(x, u) + \\nabla V(x)^{\\top} f(x, u) \\right\\}\n$$\n在线性二次调节器 (LQR) 问题的背景下，系统动态为 $f(x, u) = \\dot{x} = Ax + Bu$，阶段成本（拉格朗日量）为 $L(x, u) = x^{\\top}Qx + u^{\\top}Ru$。假设价值函数具有二次形式 $V(x) = x^{\\top}Px$，其中 $P$ 是一个对称正定矩阵。\n\n首先，我们计算价值函数 $V(x)$ 的梯度：\n$$\n\\nabla V(x) = \\frac{\\partial}{\\partial x} (x^{\\top}Px)\n$$\n由于 $P$ 是对称的 ($P = P^{\\top}$)，梯度为：\n$$\n\\nabla V(x) = (P + P^{\\top})x = 2Px\n$$\n将这些表达式代入 HJB 方程，得到：\n$$\n0 = \\min_{u} \\left\\{ x^{\\top}Qx + u^{\\top}Ru + (2Px)^{\\top}(Ax + Bu) \\right\\}\n$$\n展开最后一项：\n$$\n(2Px)^{\\top}(Ax + Bu) = 2x^{\\top}P^{\\top}(Ax + Bu) = 2x^{\\top}P(Ax + Bu) = 2x^{\\top}PAx + 2x^{\\top}PBu\n$$\nHJB 方程变为：\n$$\n0 = \\min_{u} \\left\\{ x^{\\top}Qx + u^{\\top}Ru + 2x^{\\top}PAx + 2x^{\\top}PBu \\right\\}\n$$\n花括号中的表达式是哈密顿量，$H(x, u, p) = L(x, u) + p^{\\top}f(x, u)$，其中 $p = \\nabla V(x)$。为了找到使该表达式最小化的控制 $u^{\\star}$，我们对 $u$ 求导并令结果为零。该表达式是关于 $u$ 的二次函数，因此这能得到全局最小值。\n$$\n\\frac{\\partial H}{\\partial u} = 2Ru + 2B^{\\top}Px = 0\n$$\n求解最优控制 $u^{\\star}$：\n$$\n2Ru = -2B^{\\top}Px \\implies u^{\\star}(t) = -R^{-1}B^{\\top}Px(t)\n$$\n这是最优状态反馈控制律，$u^{\\star} = -Kx$，其中反馈增益矩阵为 $K = R^{-1}B^{\\top}P$。\n\n现在，我们将 $u^{\\star}$ 代回 HJB 方程：\n$$\n0 = x^{\\top}Qx + (u^{\\star})^{\\top}Ru^{\\star} + 2x^{\\top}PAx + 2x^{\\top}PBu^{\\star}\n$$\n$0 = x^{\\top}Qx + (-R^{-1}B^{\\top}Px)^{\\top}R(-R^{-1}B^{\\top}Px) + 2x^{\\top}PAx + 2x^{\\top}PB(-R^{-1}B^{\\top}Px)$\n$0 = x^{\\top}Qx + (x^{\\top}PB(R^{-1})^{\\top})R(R^{-1}B^{\\top}Px) + 2x^{\\top}PAx - 2x^{\\top}PBR^{-1}B^{\\top}Px$\n由于 $R$ 是对称的，$R^{-1}$ 也是对称的，所以 $(R^{-1})^{\\top} = R^{-1}$。\n$0 = x^{\\top}Qx + x^{\\top}PBR^{-1}RR^{-1}B^{\\top}Px + 2x^{\\top}PAx - 2x^{\\top}PBR^{-1}B^{\\top}Px$\n$0 = x^{\\top}Qx + x^{\\top}PBR^{-1}B^{\\top}Px + x^{\\top}(A^{\\top}P + PA)x - 2x^{\\top}PBR^{-1}B^{\\top}Px$\n注意，我们使用了恒等式 $2x^{\\top}PAx = x^{\\top}PAx + (x^{\\top}PAx)^{\\top} = x^{\\top}PAx + x^{\\top}A^{\\top}P^{\\top}x = x^{\\top}(PA + A^{\\top}P)x$。\n合并各项得到：\n$$\n0 = x^{\\top}Qx + x^{\\top}(A^{\\top}P + PA)x - x^{\\top}PBR^{-1}B^{\\top}Px\n$$\n提出因子 $x^{\\top}$ 和 $x$：\n$$\n0 = x^{\\top}(A^{\\top}P + PA - PBR^{-1}B^{\\top}P + Q)x\n$$\n这个方程必须对任何状态 $x(t) \\in \\mathbb{R}^n$ 都成立。这仅当括号内的矩阵表达式为零矩阵时才可能实现。这就导出了连续时间代数 Riccati 方程 (ARE)：\n$$\nA^{\\top}P + PA - PBR^{-1}B^{\\top}P + Q = 0\n$$\n\n第二部分：应用于具体问题\n\n给定矩阵：\n$$\nA=\\begin{bmatrix}1 & 0\\\\ 0 & -2\\end{bmatrix},\\quad B=\\begin{bmatrix}1\\\\ 0\\end{bmatrix},\\quad Q=I_{2}=\\begin{bmatrix}1 & 0\\\\ 0 & 1\\end{bmatrix},\\quad R=1\n$$\n以及未知对称矩阵 $P=\\begin{bmatrix}p_{11} & p_{12}\\\\ p_{12} & p_{22}\\end{bmatrix}$。由于 $R=1$，我们有 $R^{-1}=1$。\n\n我们计算 ARE 的各项：\n$A^{\\top}P = \\begin{bmatrix}1 & 0\\\\ 0 & -2\\end{bmatrix} \\begin{bmatrix}p_{11} & p_{12}\\\\ p_{12} & p_{22}\\end{bmatrix} = \\begin{bmatrix}p_{11} & p_{12}\\\\ -2p_{12} & -2p_{22}\\end{bmatrix}$\n$PA = \\begin{bmatrix}p_{11} & p_{12}\\\\ p_{12} & p_{22}\\end{bmatrix} \\begin{bmatrix}1 & 0\\\\ 0 & -2\\end{bmatrix} = \\begin{bmatrix}p_{11} & -2p_{12}\\\\ p_{12} & -2p_{22}\\end{bmatrix}$\n$PBR^{-1}B^{\\top}P = (PB)(PB)^{\\top} = \\left(\\begin{bmatrix}p_{11} & p_{12}\\\\ p_{12} & p_{22}\\end{bmatrix} \\begin{bmatrix}1\\\\ 0\\end{bmatrix}\\right) \\left(\\begin{bmatrix}p_{11} \\\\ p_{12}\\end{bmatrix}^{\\top}\\right) = \\begin{bmatrix}p_{11}\\\\ p_{12}\\end{bmatrix} \\begin{bmatrix}p_{11} & p_{12}\\end{bmatrix} = \\begin{bmatrix}p_{11}^{2} & p_{11}p_{12}\\\\ p_{11}p_{12} & p_{12}^{2}\\end{bmatrix}$\n\n将这些代入 ARE，$A^{\\top}P + PA - PBP + Q = 0$：\n$$\n\\begin{bmatrix}p_{11} & p_{12}\\\\ -2p_{12} & -2p_{22}\\end{bmatrix} + \\begin{bmatrix}p_{11} & -2p_{12}\\\\ p_{12} & -2p_{22}\\end{bmatrix} - \\begin{bmatrix}p_{11}^{2} & p_{11}p_{12}\\\\ p_{11}p_{12} & p_{12}^{2}\\end{bmatrix} + \\begin{bmatrix}1 & 0\\\\ 0 & 1\\end{bmatrix} = \\begin{bmatrix}0 & 0\\\\ 0 & 0\\end{bmatrix}\n$$\n将矩阵相加得到：\n$$\n\\begin{bmatrix} 2p_{11} - p_{11}^{2} + 1 & -p_{12} - p_{11}p_{12} \\\\ -p_{12} - p_{11}p_{12} & -4p_{22} - p_{12}^{2} + 1 \\end{bmatrix} = \\begin{bmatrix}0 & 0\\\\ 0 & 0\\end{bmatrix}\n$$\n这产生了一个包含三个独立标量方程的方程组：\n1. $2p_{11} - p_{11}^{2} + 1 = 0 \\implies p_{11}^{2} - 2p_{11} - 1 = 0$\n2. $-p_{12} - p_{11}p_{12} = 0 \\implies -p_{12}(1 + p_{11}) = 0$\n3. $-4p_{22} - p_{12}^{2} + 1 = 0$\n\n根据方程 (1)，对 $p_{11}$ 使用二次公式：\n$p_{11} = \\frac{-(-2) \\pm \\sqrt{(-2)^2 - 4(1)(-1)}}{2(1)} = \\frac{2 \\pm \\sqrt{4+4}}{2} = \\frac{2 \\pm 2\\sqrt{2}}{2} = 1 \\pm \\sqrt{2}$。\n\n根据方程 (2)，要么 $p_{12}=0$，要么 $1+p_{11}=0$。$p_{11}$ 的解是 $1+\\sqrt{2} \\ne -1$ 和 $1-\\sqrt{2} \\ne -1$。因此，我们必须有 $p_{12}=0$。\n\n将 $p_{12}=0$ 代入方程 (3)：\n$-4p_{22} - 0^2 + 1 = 0 \\implies 4p_{22} = 1 \\implies p_{22} = \\frac{1}{4}$。\n\n我们得到 $P$ 的两个可能的解：\n$P_1 = \\begin{bmatrix} 1+\\sqrt{2} & 0 \\\\ 0 & \\frac{1}{4} \\end{bmatrix}$ 和 $P_2 = \\begin{bmatrix} 1-\\sqrt{2} & 0 \\\\ 0 & \\frac{1}{4} \\end{bmatrix}$。\n\n问题要求的是稳定化解，为此矩阵 $P$ 必须是正定的 ($P>0$)。一个对角矩阵是正定的，当且仅当其所有对角元素都为正。\n对于 $P_1$，对角元素为 $1+\\sqrt{2} > 0$ 和 $\\frac{1}{4} > 0$。因此，$P_1$ 是正定的。\n对于 $P_2$，对角元素 $1-\\sqrt{2} \\approx 1 - 1.414 < 0$。因此，$P_2$ 不是正定的。\n唯一的稳定化解是 $P = P_1 = \\begin{bmatrix} 1+\\sqrt{2} & 0 \\\\ 0 & \\frac{1}{4} \\end{bmatrix}$。\n\n第三部分：闭环特征值的计算\n\n开环系统矩阵 $A$ 的特征值为 $\\lambda_1=1$（不稳定）和 $\\lambda_2=-2$（稳定）。与不稳定特征值相关的状态是 $x_1$。我们现在求闭环系统矩阵 $A_{cl} = A - BK$。\n最优增益 $K$ 是：\n$K = R^{-1}B^{\\top}P = (1)\\begin{bmatrix}1 & 0\\end{bmatrix}\\begin{bmatrix} 1+\\sqrt{2} & 0 \\\\ 0 & \\frac{1}{4} \\end{bmatrix} = \\begin{bmatrix} 1+\\sqrt{2} & 0 \\end{bmatrix}$。\n\n矩阵 $BK$ 是：\n$BK = \\begin{bmatrix}1\\\\ 0\\end{bmatrix}\\begin{bmatrix} 1+\\sqrt{2} & 0 \\end{bmatrix} = \\begin{bmatrix} 1+\\sqrt{2} & 0 \\\\ 0 & 0 \\end{bmatrix}$。\n\n闭环系统矩阵 $A_{cl}$ 是：\n$A_{cl} = A - BK = \\begin{bmatrix}1 & 0\\\\ 0 & -2\\end{bmatrix} - \\begin{bmatrix} 1+\\sqrt{2} & 0 \\\\ 0 & 0 \\end{bmatrix} = \\begin{bmatrix} 1-(1+\\sqrt{2}) & 0 \\\\ 0-0 & -2-0 \\end{bmatrix} = \\begin{bmatrix} -\\sqrt{2} & 0 \\\\ 0 & -2 \\end{bmatrix}$。\n\n闭环系统的特征值是 $A_{cl}$ 的对角元素，即 $-\\sqrt{2}$ 和 $-2$。$1$ 这个不稳定的开环特征值已被稳定的特征值 $-\\sqrt{2}$ 所取代。$-2$ 这个稳定的开环特征值保持不变，这是预料之中的，因为第二个状态是不可控的。\n\n替代不稳定开环特征值的闭环特征值是 $-\\sqrt{2}$。", "answer": "$$ \\boxed{-\\sqrt{2}} $$", "id": "2699185"}]}