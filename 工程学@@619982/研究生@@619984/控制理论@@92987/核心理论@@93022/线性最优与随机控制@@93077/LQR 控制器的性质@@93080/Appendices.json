{"hands_on_practices": [{"introduction": "虽然线性二次调节器（LQR）控制器通常是通过求解代数Riccati方程（ARE）来设计的，但从第一性原理出发，更能深刻理解其背后的优化思想。本练习将引导您回归基础，通过Hamilton-Jacobi-Bellman（HJB）方程为简单的标量系统推导LQR解，这有助于您深入理解代价函数中的权重（$q$ 和 $r$）与系统动态（$a$ 和 $b$）如何共同决定最终的控制器增益 $K$ ([@problem_id:2734387])。", "problem": "考虑标量线性时不变系统 $\\dot{x}(t) = a\\,x(t) + b\\,u(t)$，其中 $b \\neq 0$，$q \\ge 0$ 且 $r > 0$。性能指标为无限时域二次型代价 $J = \\int_{0}^{\\infty} \\big(q\\,x(t)^{2} + r\\,u(t)^{2}\\big)\\,dt$。使用动态规划的基本原理，通过 Hamilton–Jacobi–Bellman 方程，推导使 $J$ 最小化的最优状态反馈律 $u(t) = -K\\,x(t)$，以及二次型拟设 $V(x) = P\\,x^{2}$ 中相关的价值函数系数 $P$。用 $a$、$b$、$q$ 和 $r$ 的形式精确地表示 $P$ 和 $K$ 的闭式解，并证明所选择的稳定分支的合理性。然后，在 $|a| \\ll \\sqrt{q\\,r}/|b|$ 的情况下，确定 $K$ 的主阶渐近标度，并简要解释其原因。将你的最终答案表示为 $K$ 关于 $a$、$b$、$q$ 和 $r$ 的函数的精确闭式解表达式（无需进行数值计算）。", "solution": "我们从无限时域最优控制的 Hamilton–Jacobi–Bellman (HJB) 方程开始。对于标量系统 $\\dot{x} = a\\,x + b\\,u$ 和代价密度 $\\ell(x,u) = q\\,x^{2} + r\\,u^{2}$（其中 $q \\ge 0$ 且 $r > 0$），价值函数 $V(x)$ 满足\n$$\n0 \\;=\\; \\min_{u} \\Big\\{ q\\,x^{2} + r\\,u^{2} + V_{x}(x)\\,\\big(a\\,x + b\\,u\\big) \\Big\\}.\n$$\n根据系统和代价的结构，很自然地可以寻找一个二次型价值函数 $V(x) = P\\,x^{2}$，其中 $P$ 是一个未知的常数且 $P \\ge 0$。那么 $V_{x}(x) = 2\\,P\\,x$，HJB 方程变为\n$$\n0 \\;=\\; \\min_{u} \\Big\\{ q\\,x^{2} + r\\,u^{2} + 2\\,P\\,x\\,(a\\,x + b\\,u) \\Big\\}\n\\;=\\; \\min_{u} \\Big\\{ (q + 2\\,a\\,P)\\,x^{2} + r\\,u^{2} + 2\\,b\\,P\\,x\\,u \\Big\\}.\n$$\n对于每个固定的 $x$，内部的最小化问题是关于 $u$ 的一个凸二次型问题。使表达式最小化的输入 $u^{\\star}$ 满足一阶条件\n$$\n\\frac{\\partial}{\\partial u}\\Big( r\\,u^{2} + 2\\,b\\,P\\,x\\,u \\Big) \\;=\\; 2\\,r\\,u + 2\\,b\\,P\\,x \\;=\\; 0,\n$$\n由此可得最优反馈\n$$\nu^{\\star} \\;=\\; -\\,\\frac{b\\,P}{r}\\,x.\n$$\n这确定了最优静态状态反馈增益为\n$$\nK \\;=\\; \\frac{b\\,P}{r}.\n$$\n将 $u^{\\star}$ 代回 HJB 的被积函数中，得到括号内表达式的最小值为：\n$$\n(q + 2\\,a\\,P)\\,x^{2} + r\\,\\Big(-\\frac{b\\,P}{r}\\,x\\Big)^{2} + 2\\,b\\,P\\,x\\,\\Big(-\\frac{b\\,P}{r}\\,x\\Big)\n\\;=\\; \\Big(q + 2\\,a\\,P - \\frac{b^{2}\\,P^{2}}{r}\\Big)\\,x^{2}.\n$$\n因此，HJB 方程简化为标量代数 Riccati 方程\n$$\nq + 2\\,a\\,P - \\frac{b^{2}}{r}\\,P^{2} \\;=\\; 0,\n$$\n或者，等价地，\n$$\n\\frac{b^{2}}{r}\\,P^{2} - 2\\,a\\,P - q \\;=\\; 0.\n$$\n求解这个关于 $P$ 的二次方程得到\n$$\nP \\;=\\; \\frac{2\\,a \\pm \\sqrt{4\\,a^{2} + 4\\,\\frac{b^{2}}{r}\\,q}}{2\\,\\frac{b^{2}}{r}}\n\\;=\\; \\frac{a \\pm \\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}}{\\frac{b^{2}}{r}}\n\\;=\\; \\frac{r}{b^{2}}\\Big(a \\pm \\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}\\Big).\n$$\n为选择稳定解，我们考察当 $u=-K\\,x$ 时的闭环动力学：\n$$\n\\dot{x} \\;=\\; \\big(a - b\\,K\\big)\\,x \\;=\\; \\Big(a - \\frac{b^{2}}{r}\\,P\\Big)\\,x.\n$$\n使用 $P$ 的表达式，\n$$\na - \\frac{b^{2}}{r}\\,P \\;=\\; a - \\Big(a \\pm \\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}\\Big) \\;=\\; \\mp\\,\\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}.\n$$\n稳定分支要求 $a - \\frac{b^{2}}{r}\\,P < 0$，即对应负根。因此，我们在 $P$ 的表达式中取正号：\n$$\nP \\;=\\; \\frac{r}{b^{2}}\\Big(a + \\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}\\Big),\n$$\n这给出了精确的最优增益\n$$\nK \\;=\\; \\frac{b\\,P}{r} \\;=\\; \\frac{a + \\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}}{b}.\n$$\n这个 $K$ 产生的闭环特征值为 $a - b\\,K = -\\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q} \\le 0$。除非 $q = 0$ 且 $a \\le 0$，否则该值严格为负，这在标准的非退化情况下保证了稳定性。\n\n对于渐近标度，考虑 $|a| \\ll \\sqrt{q\\,r}/|b|$ 的情况。那么\n$$\n\\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}\n\\;=\\;\n|b|\\,\\sqrt{\\frac{q}{r}}\\,\\sqrt{1 + \\frac{a^{2}\\,r}{b^{2}\\,q}}\n\\;=\\;\n|b|\\,\\sqrt{\\frac{q}{r}}\\Big(1 + \\mathcal{O}\\Big(\\frac{a^{2}\\,r}{b^{2}\\,q}\\Big)\\Big),\n$$\n所以\n$$\nK \\;=\\; \\frac{a}{b} + \\frac{1}{b}\\,\\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}\n\\;=\\;\n\\frac{a}{b} + \\frac{|b|}{b}\\,\\sqrt{\\frac{q}{r}} + \\mathcal{O}\\Big(\\frac{|a|^{2}}{|b|}\\,\\sqrt{\\frac{r}{q}}\\Big).\n$$\n在主阶上，$a/b$ 项相对于与 $\\sqrt{q/r}$ 成比例的项可以忽略，因此\n$$\nK \\sim \\frac{|b|}{b}\\,\\sqrt{\\frac{q}{r}}.\n$$\n特别地，当 $b > 0$ 时，这简化为 $K \\sim \\sqrt{q/r}$，这就确立了所述的标度行为。\n\n因此，最优增益的精确闭式解表达式为\n$$\nK \\;=\\; \\frac{a + \\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}}{b}.\n$$", "answer": "$$\\boxed{\\frac{a+\\sqrt{a^{2}+\\frac{b^{2}}{r}\\,q}}{b}}$$", "id": "2734387"}, {"introduction": "在掌握了LQR的数学推导之后，将其应用于实际物理系统时，一个关键的工程挑战是如何明智地选择权重矩阵 $Q$ 和 $R$。本练习探讨了在LQR成本函数中进行量纲分析和无量纲化的核心概念，这对于确保成本函数的物理意义至关重要。通过学习如何正确缩放状态和输入变量，您将能够设计出在不同物理单位和量级下都表现稳健且有效的控制器 ([@problem_id:2734404])。", "problem": "考虑一个连续时间线性时不变系统，其状态为 $x \\in \\mathbb{R}^{n}$，输入为 $u \\in \\mathbb{R}^{m}$，由 $\\dot{x} = A x + B u$ 描述。线性二次调节器 (LQR) 的代价为\n$$\nJ = \\int_{0}^{\\infty} \\left( x^{\\top} Q x + u^{\\top} R u \\right) \\, dt,\n$$\n其中 $Q \\in \\mathbb{R}^{n \\times n}$ 是对称半正定矩阵，$R \\in \\mathbb{R}^{m \\times m}$ 是对称正定矩阵。假设状态分量 $x_i$ 和输入分量 $u_j$ 的物理单位分别是 $\\mathsf{U}_{x_i}$ 和 $\\mathsf{U}_{u_j}$，且 $Q$ 和 $R$ 的元素是固定的数值。您希望代价 $J$ 具有物理意义，即被积函数中的每一项都具有一致且可通约的物理单位，并且状态和输入惩罚项的相对权重不是由 $x$ 和 $u$ 的任意度量单位所导致的人为结果。\n\n下列哪个陈述正确地描述了应如何选择或解释状态和输入的单位与标度，以使代价 $J$ 具有物理意义且各项权重具有可比性？\n\nA. 引入可逆对角缩放矩阵 $D_x \\in \\mathbb{R}^{n \\times n}$ 和 $D_u \\in \\mathbb{R}^{m \\times m}$ 来定义无量纲变量 $z = D_x x$ 和 $v = D_u u$。选择无量纲权重矩阵 $W_x \\succeq 0$ 和 $W_u \\succ 0$，并设置 $Q = D_x^{\\top} W_x D_x$ 和 $R = D_u^{\\top} W_u D_u$。此时，$x^{\\top} Q x = z^{\\top} W_x z$ 和 $u^{\\top} R u = v^{\\top} W_u v$ 是无量纲的，且可直接比较。此外，将 $(Q,R)$ 乘以任何一个共同的正标量都不会改变最优LQR反馈，因此只有状态和输入惩罚项之间的相对标度才是重要的。\n\nB. 选择单位，使得 $x^{\\top} Q x$ 的单位是能量，而 $u^{\\top} R u$ 的单位是功率。由于两者都具有物理意义，它们的和也具有物理意义。\n\nC. 通过一个特征幅值或其稳态标准差来归一化每个状态和输入分量，即 $z_i = x_i / \\sigma_{x_i}$ 和 $v_j = u_j / \\sigma_{u_j}$，其中 $\\sigma_{x_i}, \\sigma_{u_j} > 0$，然后在缩放后的坐标系中设计LQR，其权重为 $W_x = I$ 和 $W_u = \\rho I$，其中 $\\rho > 0$ 是一个权衡参数。通过 $Q = D_x^{\\top} W_x D_x$ 和 $R = D_u^{\\top} W_u D_u$（其中 $D_x = \\mathrm{diag}(1/\\sigma_{x_i})$ 和 $D_u = \\mathrm{diag}(1/\\sigma_{u_j})$）映射回去，可以得到一个代价函数，其状态项和输入项都是无量纲且权重可比较的，并且相对权衡对于 $x$ 和 $u$ 的度量单位的选择是不变的。\n\nD. 在度量单位变换 $x = T_x \\tilde{x}$ 和 $u = T_u \\tilde{u}$（其中 $T_x$ 和 $T_u$ 为可逆对角矩阵）下，应该将 $A$ 和 $B$ 变换为 $T_x A T_x^{-1}$ 和 $T_x B T_u^{-1}$，但保持 $Q$ 和 $R$ 的数值不变；此时LQR控制器是物理上等效且单位一致的。\n\nE. 如果 $Q$ 和 $R$ 是对角的且严格为正，则单位一致性和可比性得到保证，因为被积函数只包含分量的平方和，没有交叉项来造成单位不匹配。\n\n选择所有适用的选项。", "solution": "这个问题要求我们找出关于线性二次调节器 (LQR) 代价函数中各项的物理意义和权重可比性的正确陈述。系统动力学由 $\\dot{x} = A x + B u$ 给出，代价泛函为 $J = \\int_{0}^{\\infty} \\left( x^{\\top} Q x + u^{\\top} R u \\right) \\, dt$。问题的核心在于状态 $x$ 和输入 $u$ 的物理单位，以及权重矩阵 $Q$ 和 $R$ 应如何选择或解释。\n\n量纲分析的基本原则规定，只有具有相同物理单位的量才能相加或比较。代价函数的被积函数是一个和式 $x^{\\top} Q x + u^{\\top} R u$。为了使这个和式具有物理意义， $x^{\\top} Q x$ 和 $u^{\\top} R u$ 这两项必须具有相同的物理单位。我们用 $\\mathcal{U}$ 表示这个共同的单位。\n$$\n[x^{\\top} Q x] = [u^{\\top} R u] = \\mathcal{U}\n$$\n其中 $[\\cdot]$ 表示一个量的物理单位。\n\n项 $x^{\\top} Q x$ 是一个由二次型 $\\sum_{i=1}^{n} \\sum_{j=1}^{n} Q_{ij} x_i x_j$ 给出的标量。为了使这个和式在量纲上是齐次的，每一项 $Q_{ij} x_i x_j$ 都必须具有相同的单位 $\\mathcal{U}$。设 $\\mathsf{U}_{x_k}$ 是状态分量 $x_k$ 的单位。那么我们必须有：\n$$\n[Q_{ij}] \\cdot [\\mathsf{U}_{x_i}] \\cdot [\\mathsf{U}_{x_j}] = \\mathcal{U} \\quad \\forall i, j \\in \\{1, \\dots, n\\}\n$$\n类似地，对于输入项 $u^{\\top} R u = \\sum_{k=1}^{m} \\sum_{l=1}^{m} R_{kl} u_k u_l$，设 $\\mathsf{U}_{u_p}$ 是输入分量 $u_p$ 的单位，我们必须有：\n$$\n[R_{kl}] \\cdot [\\mathsf{U}_{u_k}] \\cdot [\\mathsf{U}_{u_l}] = \\mathcal{U} \\quad \\forall k, l \\in \\{1, \\dots, m\\}\n$$\n问题陈述 $Q$ 和 $R$ 的元素是“固定的数值”。这通常被解释为这些元素是无量纲的。如果 $[Q_{ij}]=1$ 且 $[R_{kl}]=1$，那么为了量纲一致性，我们需要 $[\\mathsf{U}_{x_i}] \\cdot [\\mathsf{U}_{x_j}]$ 对所有 $i,j$ 都是一个常数单位，且 $[\\mathsf{U}_{u_k}] \\cdot [\\mathsf{U}_{u_l}]$ 对所有 $k,l$ 都是一个常数单位，此外，这两个常数单位必须相同。这是一个极其严格的条件，在实践中几乎永远不会满足。例如，一个机械系统的状态向量可能包含位置（米, $\\text{m}$）和速度（米/秒, $\\text{m/s}$）。那么 $[x_1^2] = \\text{m}^2$ 而 $[x_2^2] = (\\text{m/s})^2$，这是不同的单位。如果 $Q_{11}$ 和 $Q_{22}$ 是无量纲的数，那么将 $Q_{11}x_1^2$ 和 $Q_{22}x_2^2$ 相加在物理上是无意义的。\n\n标准且正确的工程方法是对问题进行无量纲化。我们现在根据这一原则来评估每个选项。\n\n**选项A的分析：**\n该选项提出了一个系统化的无量纲化过程。\n1.  使用可逆对角缩放矩阵 $D_x$ 和 $D_u$ 定义无量纲变量 $z = D_x x$ 和 $v = D_u u$。如果 $x$ 的第 $i$ 个分量 $x_i$ 的单位是 $\\mathsf{U}_{x_i}$，那么为了使对应的分量 $z_i$ 无量纲，对角元 $(D_x)_{ii}$ 的单位必须是 $1/\\mathsf{U}_{x_i}$。通常，$(D_x)_{ii} = 1/x_{i, \\text{char}}$，其中 $x_{i, \\text{char}}$ 是 $x_i$ 的一个特征值或最大期望值。\n2.  代价项根据这些新变量重写。该陈述声称，如果 $Q = D_x^{\\top} W_x D_x$，则 $x^{\\top} Q x = z^{\\top} W_x z$。让我们来验证：$x^{\\top} (D_x^{\\top} W_x D_x) x = (D_x x)^{\\top} W_x (D_x x) = z^{\\top} W_x z$。这在代数上是正确的。对于 $u^{\\top} R u = v^{\\top} W_u v$ 和 $R = D_u^{\\top} W_u D_u$ 也有类似的验证。\n3.  该陈述建议使用无量纲的权重矩阵 $W_x$ 和 $W_u$。由于 $z$ 和 $v$ 是无量纲的，二次型 $z^{\\top} W_x z$ 和 $v^{\\top} W_u v$ 也是无量纲的标量。因此，它们的和是明确定义的，并且它们是可直接比较的。这正确地解决了单位一致性问题。\n4.  该陈述的最后一部分声称，将 $Q$ 和 $R$ 都乘以一个共同的正标量不会改变最优LQR反馈增益 $K$。设新的权重为 $Q' = \\alpha Q$ 和 $R' = \\alpha R$，其中 $\\alpha > 0$。最优增益为 $K = R^{-1} B^{\\top} P$，其中 $P$ 是代数Riccati方程 (ARE) $A^{\\top} P + P A - P B R^{-1} B^{\\top} P + Q = 0$ 的稳定解。对于新的权重，设其解为 $P'$。ARE变为 $A^{\\top} P' + P' A - P' B (\\alpha R)^{-1} B^{\\top} P' + \\alpha Q = 0$。我们检验假设 $P' = \\alpha P$。将其代入新的ARE得到 $A^{\\top} (\\alpha P) + (\\alpha P) A - (\\alpha P) B (\\alpha R)^{-1} B^{\\top} (\\alpha P) + \\alpha Q = 0$。化简得 $\\alpha A^{\\top} P + \\alpha P A - (\\alpha^2/\\alpha) P B R^{-1} B^{\\top} P + \\alpha Q = 0$。提出因子 $\\alpha$，我们得到 $\\alpha (A^{\\top} P + P A - P B R^{-1} B^{\\top} P + Q) = 0$。由于 $\\alpha > 0$，括号中的表达式必须为零，这正是原始的ARE。因此，$P' = \\alpha P$ 是正确的解。新的增益为 $K' = (R')^{-1} B^{\\top} P' = (\\alpha R)^{-1} B^{\\top} (\\alpha P) = (\\alpha^{-1} R^{-1}) B^{\\top} (\\alpha P) = R^{-1} B^{\\top} P = K$。增益确实是不变的。这意味着对于控制律而言，只有惩罚项的相对大小才重要。\n该陈述的每个部分都是正确的，代表了控制工程中的最佳实践。\n结论：**正确**。\n\n**选项B的分析：**\n该陈述建议 $x^{\\top} Q x$ 的单位应为能量，$u^{\\top} R u$ 的单位应为功率。能量的单位是焦耳 ($\\text{J}$)，而功率的单位是焦耳每秒 ($\\text{J/s}$)。这是不同的物理量纲。将这两个量相加违反了量纲齐次性原则。能量加功率就像长度加时间一样没有意义。因此，得到的和不具有物理意义。\n结论：**错误**。\n\n**选项C的分析：**\n此选项提出了选项A中所述通用方法的一个具体的、实用的实现。\n1.  它为缩放因子提出了一个具体的选择：特征幅值的倒数，特别是稳态标准差 $\\sigma_{x_i}$ 和 $\\sigma_{u_j}$。这使得缩放后的变量 $z_i = x_i / \\sigma_{x_i}$ 和 $v_j = u_j / \\sigma_{u_j}$ 成为无量纲的量，表示以标准差为单位的偏差。这是一个非常普遍且有效的选择。\n2.  它为无量纲权重矩阵提出了一个简单明了的选择：$W_x = I$ 和 $W_u = \\rho I$，其中标量 $\\rho > 0$。这意味着任何状态的单位标准差误差先验地受到相同的惩罚，输入也类似。标量 $\\rho$ 成为调节状态调节和控制精力之间权衡的唯一旋钮。这通常被称为Bryson法则。\n3.  它正确地陈述了映射回物理坐标权重的关系：$Q = D_x^{\\top} W_x D_x$ 和 $R = D_u^{\\top} W_u D_u$，其中 $D_x=\\mathrm{diag}(1/\\sigma_{x_i})$ 和 $D_u=\\mathrm{diag}(1/\\sigma_{u_j})$。当 $W_x=I$ 和 $W_u=\\rho I$ 时，得到 $Q=\\mathrm{diag}(1/\\sigma_{x_i}^2)$ 和 $R=\\mathrm{diag}(\\rho/\\sigma_{u_j}^2)$。\n4.  它声称相对权衡对于度量单位的选择是不变的。我们来验证一下。假设我们通过一个因子 $c_i$ 来改变 $x_i$ 的单位，所以新的数值是 $\\tilde{x}_i = c_i x_i$。与 $x_i$ 具有相同单位的标准差，其数值也将变为 $\\tilde{\\sigma}_{x_i} = c_i \\sigma_{x_i}$。新的缩放变量是 $\\tilde{z}_i = \\tilde{x}_i / \\tilde{\\sigma}_{x_i} = (c_i x_i) / (c_i \\sigma_{x_i}) = x_i / \\sigma_{x_i} = z_i$。缩放后的变量对于度量单位的变化是不变的。由于LQR问题是在具有固定权重（$I, \\rho I$）的无量纲 $(z, v)$ 空间中求解的，因此得到的无量纲控制器也是不变的。因此，权衡参数 $\\rho$ 的物理解释独立于为 $x$ 和 $u$ 选择的任意单位。\n该陈述是对一种合理的工程方法的正确而详细的描述。\n结论：**正确**。\n\n**选项D的分析：**\n该陈述描述了在单位变换 $x = T_x \\tilde{x}$ 和 $u = T_u \\tilde{u}$ 下的变换。\n1.  首先，让我们检查系统矩阵 $A$ 和 $B$ 的变换。我们有 $\\dot{x} = A x + B u$。代入新变量得到 $d/dt(T_x \\tilde{x}) = A (T_x \\tilde{x}) + B (T_u \\tilde{u})$。由于 $T_x$ 是一个常数矩阵，这变为 $T_x \\dot{\\tilde{x}} = A T_x \\tilde{x} + B T_u \\tilde{u}$。为了找到 $\\tilde{x}$ 的动力学，我们乘以 $T_x^{-1}$：$\\dot{\\tilde{x}} = (T_x^{-1} A T_x) \\tilde{x} + (T_x^{-1} B T_u) \\tilde{u}$。该陈述声称新的矩阵是 $T_x A T_x^{-1}$ 和 $T_x B T_u^{-1}$。这是不正确的。系统矩阵的变换被错误地陈述了。\n2.  其次，让我们考察关于权重矩阵的说法。代价为 $J = \\int (x^\\top Q x + u^\\top R u) dt$。代入新变量：$J = \\int ( (T_x \\tilde{x})^\\top Q (T_x \\tilde{x}) + (T_u \\tilde{u})^\\top R (T_u \\tilde{u}) ) dt = \\int ( \\tilde{x}^\\top (T_x^\\top Q T_x) \\tilde{x} + \\tilde{u}^\\top (T_u^\\top R T_u) \\tilde{u} ) dt$。为了保持代价的物理意义，在 $\\tilde{x}, \\tilde{u}$ 坐标系中的新权重矩阵必须是 $\\tilde{Q} = T_x^\\top Q T_x$ 和 $\\tilde{R} = T_u^\\top R T_u$。该陈述声称应该保持 $Q$ 和 $R$ 的数值不变。这从根本上是错误的。在改变变量单位的同时保持 $Q$ 和 $R$ 的数值不变，会通过隐式地改变惩罚来极大地改变物理问题。例如，如果 $x_1$ 从米变为毫米，其数值增加了1000倍。保持 $Q_{11}$ 不变意味着对给定的物理偏差的惩罚现在大了 $1000^2$ 倍。这不会得到一个物理上等效的控制器。\n该陈述包含两个主要错误。\n结论：**错误**。\n\n**选项E的分析：**\n该陈述声称，如果 $Q$ 和 $R$ 是对角的且严格为正，则单位一致性得到保证。\n如果 $Q$ 和 $R$ 是对角的，代价被积函数变为 $\\sum_{i=1}^n Q_{ii} x_i^2 + \\sum_{j=1}^m R_{jj} u_j^2$。没有交叉项（例如 $i \\neq j$ 时的 $Q_{ij} x_i x_j$）简化了表达式，但这并不能解决核心的量纲问题。为了使和式 $\\sum_i Q_{ii} x_i^2$ 有意义，所有项 $Q_{ii} x_i^2$ 必须具有相同的单位。如果我们假设 $Q_{ii}$ 是无量纲数，这就要求 $[x_i^2]$ 对所有 $i$ 都相同。如前所述（例如，位置与速度），对于具有异构状态向量的物理系统，这通常是不成立的。即使所有状态分量碰巧具有相同的单位，它们的平方通常也与输入分量的平方具有不同的单位（例如，位置 $m$ 对比输入力 $N$）。因此，将状态和输入惩罚项 $\\sum Q_{ii} x_i^2 + \\sum R_{jj} u_j^2$ 相加，仍然是量纲非齐次量的和。\n将矩阵设为对角矩阵并不足以保证量纲的正确性。\n结论：**错误**。\n\n总之，只有陈述A和C正确地描述了确保LQR代价函数具有物理意义且权重被系统地选择的有效方法。陈述A给出了通用理论，而C给出了该理论的一个具体的、广泛使用的、鲁棒的应用。", "answer": "$$\\boxed{AC}$$", "id": "2734404"}, {"introduction": "在现代工程实践中，为连续时间系统设计的控制器几乎总是通过数字计算机来实现。本练习探讨了这种采样实现对闭环系统稳定性的影响，弥合了连续时间理论与离散时间实践之间的鸿沟。通过为一个已设计好的连续LQR控制器推导其在零阶保持器（ZOH）下的精确离散时间模型，并计算保持稳定性的最大采样周期 $h_{\\max}$，您将能定量地理解数字实现的约束如何影响理论设计的性能 ([@problem_id:2734403])。", "problem": "考虑由 $\\dot{x}(t) = a\\,x(t) + b\\,u(t)$ 给出的标量连续时间线性时不变系统，其中 $a = 1$ 且 $b = 1$。针对无穷时域性能指标 $J = \\int_{0}^{\\infty} \\left(q\\,x(t)^{2} + r\\,u(t)^{2}\\right)\\,dt$（其中 $q = 1$ 且 $r = 1$）设计一个连续时间线性二次调节器 (LQR)，得到一个连续时间状态反馈律 $u(t) = -K\\,x(t)$，其增益 $K > 0$ 为一个定值。该控制器随后使用零阶保持器 (ZOH) 以采样数据形式实现：在采样时刻之间，输入保持恒定为 $u(t) \\equiv -K\\,x(kh)$，其中 $t \\in [kh,(k+1)h)$，$h > 0$ 是采样周期。\n\n从基本定义（状态转移矩阵和卷积积分）出发，推导关于 $a$、$b$、$K$ 和 $h$ 的精确离散时间闭环标量更新式 $x_{k+1} = F(h)\\,x_{k}$。使用舒尔稳定性要求（所有特征值严格位于单位圆盘内），确定使得采样数据闭环系统保持舒尔稳定的最大采样周期 $h_{\\max}$。然后，对于给定的数值 $a = 1$、$b = 1$、$q = 1$ 和 $r = 1$，计算连续时间 LQR 增益 $K$ 并评估得到的 $h_{\\max}$。\n\n以秒为单位表示最终的采样周期。请给出精确表达式形式的最终答案，无需四舍五入。", "solution": "我们从标量系统 $\\dot{x}(t) = a\\,x(t) + b\\,u(t)$ 和针对无穷时域代价 $J = \\int_{0}^{\\infty} \\left(q\\,x(t)^{2} + r\\,u(t)^{2}\\right)\\,dt$ 的连续时间线性二次调节器 (LQR) 设计开始。对于标量系统，最优协态 $p > 0$ 的代数黎卡提方程 (ARE) 为\n$$\n2 a p - \\frac{b^{2}}{r}\\,p^{2} + q = 0,\n$$\n这是最优控制理论中一个经过充分检验的基本结果。则最优反馈增益为 $K = r^{-1} b\\,p$。\n\n求解标量 ARE 方程得到 $p$：\n$$\n\\frac{b^{2}}{r} p^{2} - 2 a p - q = 0\n\\quad\\Longrightarrow\\quad\np = \\frac{2 a + \\sqrt{4 a^{2} + 4 \\frac{b^{2}}{r} q}}{2 \\frac{b^{2}}{r}}\n= \\frac{r\\left(a + \\sqrt{a^{2} + \\frac{b^{2}}{r} q}\\right)}{b^{2}},\n$$\n其中我们选择正根以确保 $p > 0$。因此，\n$$\nK = \\frac{b}{r}\\,p\n= \\frac{b}{r}\\,\\frac{r\\left(a + \\sqrt{a^{2} + \\frac{b^{2}}{r} q}\\right)}{b^{2}}\n= \\frac{a + \\sqrt{a^{2} + \\frac{b^{2}}{r} q}}{b}.\n$$\n\n接下来，我们推导在零阶保持器 (ZOH) 下的精确采样数据闭环系统。在一个采样区间 $[kh,(k+1)h)$ 内，输入恒定为 $u(t) \\equiv u(kh)$，状态演化由状态转移公式给出：\n$$\nx((k+1)h) = \\exp(A h)\\,x(kh) + \\int_{0}^{h} \\exp(A \\tau)\\,B\\,u(kh)\\,d\\tau,\n$$\n在标量情况下，$A = a$，$B = b$，且 $\\exp(A h) = \\exp(a h)$。通过对连续时间 LQR 增益的采样实现，我们应用 $u(kh) = -K\\,x(kh)$。因此，\n$$\nx_{k+1} = \\exp(a h)\\,x_{k} - \\left(\\int_{0}^{h} \\exp(a \\tau)\\,b\\,d\\tau\\right) K\\,x_{k},\n$$\n所以，精确的离散时间闭环标量乘子是\n$$\nF(h) \\equiv \\exp(a h) - \\Gamma(h)\\,K,\n\\qquad\n\\Gamma(h) \\equiv \\int_{0}^{h} \\exp(a \\tau)\\,b\\,d\\tau.\n$$\n当 $a \\neq 0$ 时，计算该积分得到\n$$\n\\Gamma(h) = b \\int_{0}^{h} \\exp(a \\tau)\\,d\\tau\n= b\\,\\frac{\\exp(a h) - 1}{a}.\n$$\n因此，\n$$\nF(h) = \\exp(a h) - \\frac{b K}{a}\\,\\left(\\exp(a h) - 1\\right)\n= \\left(1 - \\frac{b K}{a}\\right)\\exp(a h) + \\frac{b K}{a}.\n$$\n\n标量离散时间系统的舒尔稳定性要求 $|F(h)| < 1$。因为连续时间 LQR 设计保证了 $a - b K < 0$（因此对于 $a > 0, b > 0$，有 $b K > a$），我们得到 $\\frac{b K}{a} > 1$，这意味着 $1 - \\frac{b K}{a} < 0$。由于当 $a > 0$ 时，$\\exp(a h)$ 是关于 $h$ 的严格递增函数，所以 $F(h)$ 是关于 $h$ 的严格递减函数，且 $F(0) = 1$，当 $h \\to \\infty$ 时 $F(h) \\to -\\infty$。因此，使得 $|F(h)| < 1$ 成立的最大采样周期 $h_{\\max}$ 在 $F(h_{\\max}) = -1$ 时达到。\n\n令 $F(h) = -1$ 并求解 $h$。对于 $h > 0$，设 $z \\equiv \\exp(a h) > 1$，并定义 $r \\equiv \\frac{b K}{a} > 1$。那么\n$$\nF(h) = (1 - r) z + r = -1\n\\quad\\Longrightarrow\\quad\n(1 - r) z = -1 - r\n\\quad\\Longrightarrow\\quad\nz = \\frac{-1 - r}{1 - r} = \\frac{1 + r}{r - 1}.\n$$\n于是，\n$$\nh_{\\max} = \\frac{1}{a}\\,\\ln\\!\\left(\\frac{1 + r}{r - 1}\\right),\n\\qquad r \\equiv \\frac{b K}{a}.\n$$\n\n现在代入给定的数值参数 $a = 1, b = 1, q = 1, r = 1$。连续时间 LQR 增益为\n$$\nK = \\frac{a + \\sqrt{a^{2} + \\frac{b^{2}}{r} q}}{b}\n= \\frac{1 + \\sqrt{1 + 1}}{1}\n= 1 + \\sqrt{2}.\n$$\n因此 $r = \\frac{b K}{a} = 1 + \\sqrt{2}$。代入到 $h_{\\max}$ 的表达式中，\n$$\nh_{\\max}\n= \\frac{1}{1} \\ln\\!\\left(\\frac{1 + (1 + \\sqrt{2})}{(1 + \\sqrt{2}) - 1}\\right)\n= \\ln\\!\\left(\\frac{2 + \\sqrt{2}}{\\sqrt{2}}\\right)\n= \\ln\\!\\left(1 + \\sqrt{2}\\right).\n$$\n这是如题所求的、以秒为单位的精确表达式。", "answer": "$$\\boxed{\\ln\\!\\left(1+\\sqrt{2}\\right)}$$", "id": "2734403"}]}