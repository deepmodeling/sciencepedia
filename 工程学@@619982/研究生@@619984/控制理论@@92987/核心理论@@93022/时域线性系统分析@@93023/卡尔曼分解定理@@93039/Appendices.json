{"hands_on_practices": [{"introduction": "理解卡尔曼分解的第一步是识别其基本构成部分。本练习将引导你计算系统的可达子空间 $\\mathcal{R}(A,B)$，这是判断系统哪些部分能被输入所控制的核心技能。通过构建可控性矩阵并确定其秩，你将掌握分析系统可控性的基本方法。[@problem_id:2715586]", "problem": "考虑一个状态维数为$4$且为单输入的实数线性时不变（LTI）状态空间对，\n$$\nA=\\begin{pmatrix}\n0 & 1 & 0 & 0\\\\\n0 & 0 & 0 & 0\\\\\n0 & 0 & 1 & 1\\\\\n0 & 0 & 0 & 1\n\\end{pmatrix},\\qquad\nB=\\begin{pmatrix}\n1\\\\\n0\\\\\n0\\\\\n1\n\\end{pmatrix}.\n$$\n仅从可达子空间$\\mathcal{R}(A,B)$的基础定义出发，即$\\mathcal{R}(A,B)$是$\\mathbb{R}^{4}$中包含$B$的像且在$A$的作用下不变的最小子空间，利用卡尔曼分解定理背后的结构性洞察，通过将$A$连续作用于$B$的列来为$\\mathcal{R}(A,B)$构造一个显式的有限生成集，由这些生成元组建相关的可控性矩阵$\\mathcal{C}$，并确定$\\mathcal{C}$的列空间的维数。将你的最终答案以等于$\\dim \\mathcal{R}(A,B)$的单个整数形式报告。无需四舍五入，也无需单位。", "solution": "该问题要求确定给定线性时不变（LTI）系统的可达子空间的维数。我将首先验证问题陈述。\n\n**问题验证**\n\n步骤1：提取已知条件\n- 状态维数$n=4$且为单输入的LTI状态空间对$(A,B)$。\n- 状态矩阵：\n$$\nA=\\begin{pmatrix}\n0 & 1 & 0 & 0\\\\\n0 & 0 & 0 & 0\\\\\n0 & 0 & 1 & 1\\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\n- 输入矩阵：\n$$\nB=\\begin{pmatrix}\n1\\\\\n0\\\\\n0\\\\\n1\n\\end{pmatrix}\n$$\n- 可达子空间$\\mathcal{R}(A,B)$的定义：$\\mathbb{R}^{4}$中包含$B$的像且在$A$的作用下不变的最小子空间。\n- 任务：为$\\mathcal{R}(A,B)$构造一个生成集，组建可控性矩阵$\\mathcal{C}$，并求其秩以确定$\\dim \\mathcal{R}(A,B)$。\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，提法恰当且客观。它提出了线性控制理论中的一个标准问题，并提供了所有必要信息。矩阵定义明确，任务是直接应用与可达性相关的基本原理。引用卡尔曼分解定理是合适的，因为计算可达子空间本身就是构造卡尔曼分解的第一步。该问题是完整的、一致的且计算上可行的。未检测到任何缺陷。\n\n步骤3：结论与行动\n问题有效。我将继续进行解答。\n\n**解答**\n\n问题陈述给出了可达子空间$\\mathcal{R}(A,B)$的基础定义，即它是状态空间$\\mathbb{R}^{4}$中既是$A$-不变又包含输入矩阵$B$的像的最小子空间。\n一个$A$-不变子空间$\\mathcal{S}$满足性质$A \\mathcal{S} \\subseteq \\mathcal{S}$，意味着对于任何向量$x \\in \\mathcal{S}$，向量$Ax$也在$\\mathcal{S}$中。$\\mathcal{R}(A,B)$包含$B$的像（记为$\\text{Im}(B)$）这一条件意味着，对于任何输入向量$u$，向量$Bu$必须在$\\mathcal{R}(A,B)$中。由于我们的系统是单输入的，$\\text{Im}(B)$就是由$B$的单列所张成的子空间。\n\n令$B$的单列由向量$b$表示。\n$$\nb = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n为使$\\mathcal{R}(A,B)$包含$\\text{Im}(B)$，向量$b$必须在$\\mathcal{R}(A,B)$中。\n为使$\\mathcal{R}(A,B)$是$A$-不变的，若$b \\in \\mathcal{R}(A,B)$，则$Ab$也必须在$\\mathcal{R}(A,B)$中。通过重复应用此性质，$A(Ab) = A^{2}b$也必须在$\\mathcal{R}(A,B)$中，以此类推。因此，对于$k \\ge 0$，任何形如$A^{k}b$的向量都必须属于$\\mathcal{R}(A,B)$。\n由所有这些向量$\\text{span}\\{b, Ab, A^{2}b, \\dots\\}$张成的子空间，根据构造，是$A$-不变的且包含$b$。实际上，它就是满足条件的最小子空间。根据Cayley-Hamilton定理，任何大于或等于状态维数$n=4$的$A$的幂次都可以表示为低次幂$\\{I, A, A^{2}, A^{3}\\}$的线性组合。因此，可达子空间的生成集可以限制为前$n$个向量。\n$$\n\\mathcal{R}(A,B) = \\text{span}\\{B, AB, A^{2}B, A^{3}B\\}\n$$\n来自卡尔曼分解定理的结构性洞察是，状态空间可以划分为一个可达子空间及其补空间。该可达子空间的维数$\\dim \\mathcal{R}(A,B)$，通过确定此生成集中的线性无关向量的数量来找到。这等价于求可控性矩阵$\\mathcal{C}$的秩，该矩阵由这些向量作为其列构成。\n$$\n\\mathcal{C} = \\begin{pmatrix} B & AB & A^{2}B & A^{3}B \\end{pmatrix}\n$$\n我们现在开始对这些向量进行显式计算。\n第一个向量是$B$本身：\n$$\nv_1 = B = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n第二个向量是$AB$：\n$$\nv_2 = AB = \\begin{pmatrix} 0 & 1 & 0 & 0\\\\ 0 & 0 & 0 & 0\\\\ 0 & 0 & 1 & 1\\\\ 0 & 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n第三个向量是$A^{2}B = A(AB)$：\n$$\nv_3 = A^{2}B = \\begin{pmatrix} 0 & 1 & 0 & 0\\\\ 0 & 0 & 0 & 0\\\\ 0 & 0 & 1 & 1\\\\ 0 & 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 2 \\\\ 1 \\end{pmatrix}\n$$\n第四个向量是$A^{3}B = A(A^{2}B)$：\n$$\nv_4 = A^{3}B = \\begin{pmatrix} 0 & 1 & 0 & 0\\\\ 0 & 0 & 0 & 0\\\\ 0 & 0 & 1 & 1\\\\ 0 & 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 3 \\\\ 1 \\end{pmatrix}\n$$\n现在，我们将这些向量作为列来组建可控性矩阵$\\mathcal{C}$：\n$$\n\\mathcal{C} = \\begin{pmatrix} v_1 & v_2 & v_3 & v_4 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 1 & 2 & 3 \\\\ 1 & 1 & 1 & 1 \\end{pmatrix}\n$$\n可达子空间的维数$\\dim \\mathcal{R}(A,B)$是矩阵$\\mathcal{C}$的秩。我们可以通过将$\\mathcal{C}$化为行阶梯形来确定其秩。\n$$\n\\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 1 & 2 & 3 \\\\ 1 & 1 & 1 & 1 \\end{pmatrix}\n$$\n交换第2行和第4行：\n$$\n\\xrightarrow{R_2 \\leftrightarrow R_4} \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 1 & 1 & 1 & 1 \\\\ 0 & 1 & 2 & 3 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}\n$$\n执行运算$R_2 \\leftarrow R_2 - R_1$：\n$$\n\\xrightarrow{R_2 \\leftarrow R_2 - R_1} \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 1 & 1 \\\\ 0 & 1 & 2 & 3 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}\n$$\n执行运算$R_3 \\leftarrow R_3 - R_2$：\n$$\n\\xrightarrow{R_3 \\leftarrow R_3 - R_2} \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 1 & 1 \\\\ 0 & 0 & 1 & 2 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}\n$$\n该矩阵现在是行阶梯形。非零行的数量，即主元的数量，就是矩阵的秩。有$3$个非零行。\n因此，可控性矩阵$\\mathcal{C}$的秩为$3$。这表示生成向量集$\\{B, AB, A^{2}B, A^{3}B\\}$中恰好包含三个线性无关的向量。\n$\\mathcal{C}$的列空间的维数，也就是可达子空间$\\mathcal{R}(A,B)$的维数，等于$\\mathcal{C}$的秩。\n$$\n\\dim \\mathcal{R}(A,B) = \\text{rank}(\\mathcal{C}) = 3\n$$\n由于可达子空间的维数（$3$）小于状态空间的维数（$4$），因此该系统不是完全可达（或可控）的。", "answer": "$$\\boxed{3}$$", "id": "2715586"}, {"introduction": "在掌握了如何识别可达与不可观测子空间后，我们便可以将整个状态空间进行完整分解。这个练习将引导你将状态空间划分为可控与可观测、可控与不可观测、不可控与可观测、以及不可控与不可观测这四个子空间。通过这个实践，你将学会如何运用分解后的结构来分析系统的能镇定性与能检性，从而更深刻地理解系统的内在特性。[@problem_id:2715602]", "problem": "考虑一个由状态方程 $\\dot{x} = A x + B u$ 和输出方程 $y = C x$ 定义的连续时间线性时不变 (LTI) 系统，其中\n$$\nA = \\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & -2 & 0 & 0 \\\\\n0 & 0 & -1 & 0 \\\\\n0 & 0 & 0 & 3\n\\end{pmatrix},\\quad\nB = \\begin{pmatrix}\n1 \\\\ 0 \\\\ 0 \\\\ 1\n\\end{pmatrix},\\quad\nC = \\begin{pmatrix}\n0 & 1 & 0 & 1\n\\end{pmatrix}.\n$$\n仅使用基本定义，完成以下任务：\n- 通过计算由 $B$、$A B$、$A^{2} B$ 和 $A^{3} B$ 构成的矩阵的列张成的空间，确定可达子空间。\n- 将不可观测子空间确定为由 $C$、$C A$、$C A^{2}$ 和 $C A^{3}$ 构成的可观测性矩阵的零空间。\n- 根据这些子空间，构造一个相似变换以得到 Kalman 分解，并对坐标进行排序，使得分块按以下顺序出现：可控且可观测、可控但不可观测、不可控但可观测、不可控且不可观测。\n- 利用每个子空间分块动态的特征值，判断系统是否能镇定以及是否能检测。使用以下定义：如果每个不可控模态的实部都严格为负，则系统是能镇定的；如果每个不可观测模态的实部都严格为负，则系统是能检测的。\n\n作为最终报告的量，计算在 Kalman 分解坐标系下，与可控且可观测子空间对应的 $A$ 矩阵分块的行列式。请给出精确的标量值作为最终答案，无需四舍五入，不涉及单位。", "solution": "所给问题提法恰当，有科学依据，并包含了得到唯一解所需的所有信息。这是线性控制理论中的一个标准练习。我们开始求解。\n\n该系统由状态空间表示 $\\dot{x} = Ax + Bu$ 和 $y = Cx$ 描述，其矩阵为：\n$$\nA = \\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & -2 & 0 & 0 \\\\\n0 & 0 & -1 & 0 \\\\\n0 & 0 & 0 & 3\n\\end{pmatrix},\\quad\nB = \\begin{pmatrix}\n1 \\\\ 0 \\\\ 0 \\\\ 1\n\\end{pmatrix},\\quad\nC = \\begin{pmatrix}\n0 & 1 & 0 & 1\n\\end{pmatrix}\n$$\n状态向量为 $x \\in \\mathbb{R}^4$。$A$ 的特征值为 $\\lambda_1 = 1$、$\\lambda_2 = -2$、$\\lambda_3 = -1$ 和 $\\lambda_4 = 3$，分别对应于标准基向量 $e_1, e_2, e_3, e_4$。\n\n首先，我们确定可达子空间 $\\mathcal{R}$，它是可控性矩阵 $\\mathcal{C} = [B \\ AB \\ A^2B \\ A^3B]$ 的列空间。我们计算各列：\n$$ B = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix} $$\n$$ AB = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & -2 & 0 & 0 \\\\ 0 & 0 & -1 & 0 \\\\ 0 & 0 & 0 & 3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 3 \\end{pmatrix} $$\n$$ A^2B = A(AB) = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 9 \\end{pmatrix}, \\quad A^3B = A(A^2B) = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 27 \\end{pmatrix} $$\n可控性矩阵为：\n$$ \\mathcal{C} = \\begin{pmatrix} 1 & 1 & 1 & 1 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 1 & 3 & 9 & 27 \\end{pmatrix} $$\n第二行和第三行为零，因此秩至多为 $2$。由第一行和第四行构成的子矩阵是 $\\begin{pmatrix} 1 & 1 \\\\ 1 & 3 \\end{pmatrix}$，其行列式为 $3-1 = 2 \\neq 0$。因此，$\\text{rank}(\\mathcal{C}) = 2$。可达子空间 $\\mathcal{R} = \\text{Im}(\\mathcal{C})$ 是二维的。$\\mathcal{C}$ 的列是 $e_1$ 和 $e_4$ 的线性组合。$\\mathcal{R}$ 的一组基是 $\\{e_1, e_4\\}$。\n$$ \\mathcal{R} = \\text{span}\\{e_1, e_4\\} $$\n\n其次，我们确定不可观测子空间 $\\mathcal{N}$，它是可观测性矩阵 $\\mathcal{O} = [C^T \\ (CA)^T \\ (CA^2)^T \\ (CA^3)^T]^T$ 的零空间。我们计算各行：\n$$ C = \\begin{pmatrix} 0 & 1 & 0 & 1 \\end{pmatrix} $$\n$$ CA = \\begin{pmatrix} 0 & 1 & 0 & 1 \\end{pmatrix} A = \\begin{pmatrix} 0 & -2 & 0 & 3 \\end{pmatrix} $$\n$$ CA^2 = (CA)A = \\begin{pmatrix} 0 & 4 & 0 & 9 \\end{pmatrix} $$\n$$ CA^3 = (CA^2)A = \\begin{pmatrix} 0 & -8 & 0 & 27 \\end{pmatrix} $$\n可观测性矩阵为：\n$$ \\mathcal{O} = \\begin{pmatrix} 0 & 1 & 0 & 1 \\\\ 0 & -2 & 0 & 3 \\\\ 0 & 4 & 0 & 9 \\\\ 0 & -8 & 0 & 27 \\end{pmatrix} $$\n一个向量 $x = (x_1, x_2, x_3, x_4)^T$ 属于零空间，当且仅当 $\\mathcal{O}x = 0$。这给出了方程组：\n$$ x_2 + x_4 = 0 $$\n$$ -2x_2 + 3x_4 = 0 $$\n将 $x_2 = -x_4$ 代入第二个方程，得到 $2x_4 + 3x_4 = 5x_4 = 0$，这意味着 $x_4 = 0$，因此 $x_2 = 0$。对 $x_1$ 和 $x_3$ 没有约束。因此，$\\mathcal{N}$ 中的任意向量形式为 $(x_1, 0, x_3, 0)^T$。$\\mathcal{N}$ 的一组基是 $\\{e_1, e_3\\}$。\n$$ \\mathcal{N} = \\text{span}\\{e_1, e_3\\} $$\n\n状态空间 $\\mathbb{R}^4$ 的 Kalman 分解是四个子空间的直和。我们通过求子空间 $\\mathcal{R}$、$\\mathcal{N}$ 及其正交补的交集来找到这些子空间：\n$\\mathcal{R}^\\perp = (\\text{span}\\{e_1, e_4\\})^\\perp = \\text{span}\\{e_2, e_3\\}$ (不可控子空间)。\n$\\mathcal{N}^\\perp = (\\text{span}\\{e_1, e_3\\})^\\perp = \\text{span}\\{e_2, e_4\\}$ (可观测子空间)。\n\n1. 可控且可观测状态子空间：\n   $\\mathcal{S}_1 = \\mathcal{R} \\cap \\mathcal{N}^\\perp = \\text{span}\\{e_1, e_4\\} \\cap \\text{span}\\{e_2, e_4\\} = \\text{span}\\{e_4\\}$。\n2. 可控但不可观测状态子空间：\n   $\\mathcal{S}_2 = \\mathcal{R} \\cap \\mathcal{N} = \\text{span}\\{e_1, e_4\\} \\cap \\text{span}\\{e_1, e_3\\} = \\text{span}\\{e_1\\}$。\n3. 不可控但可观测状态子空间：\n   $\\mathcal{S}_3 = \\mathcal{R}^\\perp \\cap \\mathcal{N}^\\perp = \\text{span}\\{e_2, e_3\\} \\cap \\text{span}\\{e_2, e_4\\} = \\text{span}\\{e_2\\}$。\n4. 不可控且不可观测状态子空间：\n   $\\mathcal{S}_4 = \\mathcal{R}^\\perp \\cap \\mathcal{N} = \\text{span}\\{e_2, e_3\\} \\cap \\text{span}\\{e_1, e_3\\} = \\text{span}\\{e_3\\}$。\n\n为了构造相似变换 $z = T^{-1}x$，我们用指定顺序 $(\\mathcal{S}_1, \\mathcal{S}_2, \\mathcal{S}_3, \\mathcal{S}_4)$ 的基向量构成矩阵 $T$。\n$$ T = [e_4 \\ e_1 \\ e_2 \\ e_3] = \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\\\ 1 & 0 & 0 & 0 \\end{pmatrix} $$\n这是一个置换矩阵，其逆矩阵是其转置 $T^{-1} = T^T$。变换后的状态矩阵是 $\\hat{A} = T^{-1}AT$。该变换有效地对标准基向量进行了重新排序。由于 $A$ 是对角矩阵，$\\hat{A}$ 也将是对角矩阵，其对角元素根据基向量的新顺序进行置换。\n新的状态向量是 $z = (z_1, z_2, z_3, z_4)^T = (x_4, x_1, x_2, x_3)^T$。与这些状态相关联的特征值是 $(\\lambda_4, \\lambda_1, \\lambda_2, \\lambda_3)$。\n$$ \\hat{A} = \\text{diag}(\\lambda_4, \\lambda_1, \\lambda_2, \\lambda_3) = \\begin{pmatrix} 3 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & -2 & 0 \\\\ 0 & 0 & 0 & -1 \\end{pmatrix} $$\n$\\hat{A}$ 的对角分块是与各子空间中动态相对应的标量：\n- $\\hat{A}_{11}$ (可控，可观测): $A_{11} = (3)$，对应于 $\\mathcal{S}_1 = \\text{span}\\{e_4\\}$。\n- $\\hat{A}_{22}$ (可控，不可观测): $A_{22} = (1)$，对应于 $\\mathcal{S}_2 = \\text{span}\\{e_1\\}$。\n- $\\hat{A}_{33}$ (不可控，可观测): $A_{33} = (-2)$，对应于 $\\mathcal{S}_3 = \\text{span}\\{e_2\\}$。\n- $\\hat{A}_{44}$ (不可控，不可观测): $A_{44} = (-1)$，对应于 $\\mathcal{S}_4 = \\text{span}\\{e_3\\}$。\n\n现在，我们评估能镇定性和能检测性。\n如果所有不可控模态的实部都严格为负，则系统是能镇定的。不可控模态是对应于不可控子空间 $\\mathcal{R}^\\perp = \\mathcal{S}_3 \\oplus \\mathcal{S}_4$ 的特征值。这些是 $\\hat{A}_{33}$ 和 $\\hat{A}_{44}$ 的特征值，即 $-2$ 和 $-1$。两者都严格为负。因此，该系统是能镇定的。\n\n如果所有不可观测模态的实部都严格为负，则系统是能检测的。不可观测模态是对应于不可观测子空间 $\\mathcal{N} = \\mathcal{S}_2 \\oplus \\mathcal{S}_4$ 的特征值。这些是 $\\hat{A}_{22}$ 和 $\\hat{A}_{44}$ 的特征值，即 $1$ 和 $-1$。特征值 $1$ 的实部不严格为负。因此，该系统不是能检测的。\n\n最后，我们计算与可控且可观测子空间相对应的 $A$ 矩阵分块的行列式。这就是 $\\hat{A}_{11}$ 的行列式。\n分块 $\\hat{A}_{11}$ 是 $1 \\times 1$ 矩阵 $(3)$。\n$$ \\det(\\hat{A}_{11}) = \\det((3)) = 3 $$\n这就是所要求的值。", "answer": "$$\n\\boxed{3}\n$$", "id": "2715602"}, {"introduction": "卡尔曼分解的一个重要应用是揭示系统中完全独立于输入和输出的“隐藏模态”。本练习将带你分析一个包含不可控且不可观测模态的系统，并通过计算其传递函数 $G(s)$ 来直观地展示这一模态为何“隐藏”。这个过程将清晰地阐明状态空间分解与传递函数中极点-零点对消之间的深刻联系。[@problem_id:2715552]", "problem": "考虑由下式给出的单输入单输出连续时间线性时不变 (LTI) 状态空间系统：\n$$\n\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t),\n$$\n其中\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 \\\\\n-2 & -3 & 0 \\\\\n0 & 0 & 4\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\n0 \\\\ 1 \\\\ 0\n\\end{pmatrix}, \\quad\nC = \\begin{pmatrix}\n1 & 0 & 0\n\\end{pmatrix}.\n$$\n从 LTI 系统的能达性和能观性的核心定义出发，判断是否存在一个既不能达也不能观的模态，并解释为何它完全对输入和输出隐藏。然后，显式地构建一个相似变换，将系统转换为卡尔曼标准分解形式，并识别包含该隐藏模态的块。最后，计算标量传递函数\n$$\nG(s) = C (s I - A)^{-1} B\n$$\n作为复变量 $s$ 的闭式解析表达式。将 $G(s)$ 作为你的最终答案。无需进行四舍五入。", "solution": "所给问题是适定的，并且基于线性控制理论的原理。我们将进行系统性分析。\n\n该系统是一个由状态空间方程描述的连续时间线性时不变 (LTI) 系统：\n$$\n\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t)\n$$\n矩阵为\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 \\\\\n-2 & -3 & 0 \\\\\n0 & 0 & 4\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\n0 \\\\ 1 \\\\ 0\n\\end{pmatrix}, \\quad\nC = \\begin{pmatrix}\n1 & 0 & 0\n\\end{pmatrix}.\n$$\n状态向量 $x(t)$ 属于 $\\mathbb{R}^{3}$。该系统是单输入单输出的。\n\n首先，我们通过求解状态矩阵 $A$ 的特征值来确定系统的模态。\n$$\n\\det(A - \\lambda I) = \\det \\begin{pmatrix} -\\lambda & 1 & 0 \\\\ -2 & -3-\\lambda & 0 \\\\ 0 & 0 & 4-\\lambda \\end{pmatrix} = (4-\\lambda) \\det \\begin{pmatrix} -\\lambda & 1 \\\\ -2 & -3-\\lambda \\end{pmatrix}\n$$\n$$\n= (4-\\lambda) [-\\lambda(-3-\\lambda) - (1)(-2)] = (4-\\lambda) (\\lambda^2 + 3\\lambda + 2) = (4-\\lambda)(\\lambda+1)(\\lambda+2)\n$$\n代表系统模态的特征值为 $\\lambda_1 = -1$，$\\lambda_2 = -2$ 和 $\\lambda_3 = 4$。\n\n接下来，我们分析系统的能达性。能达性矩阵为 $\\mathcal{R} = \\begin{pmatrix} B & AB & A^2B \\end{pmatrix}$。\n$$\nAB = \\begin{pmatrix} 0 & 1 & 0 \\\\ -2 & -3 & 0 \\\\ 0 & 0 & 4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -3 \\\\ 0 \\end{pmatrix}\n$$\n$$\nA^2B = A(AB) = \\begin{pmatrix} 0 & 1 & 0 \\\\ -2 & -3 & 0 \\\\ 0 & 0 & 4 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -3 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ 7 \\\\ 0 \\end{pmatrix}\n$$\n能达性矩阵为：\n$$\n\\mathcal{R} = \\begin{pmatrix} 0 & 1 & -3 \\\\ 1 & -3 & 7 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n由于前两行线性无关且第三行为零，$\\mathcal{R}$ 的秩为 $2$。因为 $\\text{rank}(\\mathcal{R}) = 2 < 3$，所以该系统不是完全能达的。能达子空间 $\\mathcal{X}_r = \\text{Im}(\\mathcal{R})$ 是 $\\mathbb{R}^3$ 的一个二维子空间。具体来说，$\\mathcal{X}_r = \\text{span} \\{ \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 1 \\\\ -3 \\\\ 0 \\end{pmatrix} \\} = \\text{span} \\{ \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} \\}$。必定存在一个不能达模态。对应于 $\\lambda_3 = 4$ 的特征向量 $v_3$ 可由 $(A-4I)v_3=0$ 求得，结果为 $v_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$。由于 $v_3$ 与 $\\mathcal{R}$ 的行空间正交（等价于，$v_3$ 不在 $\\mathcal{X}_r$ 中），因此模态 $\\lambda_3=4$ 是不能达的。\n\n现在，我们分析系统的能观性。能观性矩阵为 $\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\end{pmatrix}$。\n$$\nCA = \\begin{pmatrix} 1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & 1 & 0 \\\\ -2 & -3 & 0 \\\\ 0 & 0 & 4 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 & 0 \\end{pmatrix}\n$$\n$$\nCA^2 = (CA)A = \\begin{pmatrix} 0 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & 1 & 0 \\\\ -2 & -3 & 0 \\\\ 0 & 0 & 4 \\end{pmatrix} = \\begin{pmatrix} -2 & -3 & 0 \\end{pmatrix}\n$$\n能观性矩阵为：\n$$\n\\mathcal{O} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ -2 & -3 & 0 \\end{pmatrix}\n$$\n由于前两行线性无关且第三列为零，$\\mathcal{O}$ 的秩为 $2$。因为 $\\text{rank}(\\mathcal{O}) = 2 < 3$，所以该系统不是完全能观的。不能观子空间 $\\mathcal{X}_{uo} = \\text{Ker}(\\mathcal{O})$ 是满足 $\\mathcal{O}x = 0$ 的向量 $x$ 的集合。这得出 $x_1=0$ 和 $x_2=0$，所以 $\\mathcal{X}_{uo} = \\text{span} \\{ \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} \\}$。对应于模态 $\\lambda_3=4$ 的特征向量是 $v_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$，它位于不能观子空间中。因此，模态 $\\lambda_3=4$ 是不能观的。\n\n我们得出结论，与特征值 $\\lambda_3=4$ 相关联的模态既不能达也不能观。这是一个“隐藏模态”，因为它与系统的输入输出行为完全解耦。\n\n对于卡尔曼分解，我们将状态空间 $\\mathcal{X}$ 划分为四个子空间：$\\mathcal{X}_{ro}$ (能达且能观)，$\\mathcal{X}_{r\\bar{o}}$ (能达但不能观)，$\\mathcal{X}_{\\bar{r}o}$ (不能达但能观)，以及 $\\mathcal{X}_{\\bar{r}\\bar{o}}$ (不能达且不能观)。\n能达子空间是 $\\mathcal{X}_r = \\text{span}\\{e_1, e_2\\}$。不能观子空间是 $\\mathcal{X}_{uo} = \\text{span}\\{e_3\\}$，其中 $e_i$ 是标准基向量。能观子空间是 $\\mathcal{X}_o = (\\mathcal{X}_{uo})^\\perp = \\text{span}\\{e_1, e_2\\}$。不能达子空间是 $\\mathcal{X}_{\\bar{r}} = \\text{span}\\{e_3\\}$。\n这些子空间是：\n$\\mathcal{S}_{ro} = \\mathcal{X}_r \\cap \\mathcal{X}_o = \\text{span}\\{e_1, e_2\\}$ (维数 $2$)。\n$\\mathcal{S}_{r\\bar{o}} = \\mathcal{X}_r \\cap \\mathcal{X}_{uo} = \\{0\\}$ (维数 $0$)。\n$\\mathcal{S}_{\\bar{r}o} = \\mathcal{X}_{\\bar{r}} \\cap \\mathcal{X}_o = \\{0\\}$ (维数 $0$)。\n$\\mathcal{S}_{\\bar{r}\\bar{o}} = \\mathcal{X}_{\\bar{r}} \\cap \\mathcal{X}_{uo} = \\text{span}\\{e_3\\}$ (维数 $1$)。\n状态空间分解为 $\\mathcal{X} = \\mathcal{S}_{ro} \\oplus \\mathcal{S}_{\\bar{r}\\bar{o}}$。我们可以构建一个变换矩阵 $T$，其列由这些子空间的基构成。使用标准基，我们得到 $T = \\begin{pmatrix} e_1 & e_2 & e_3 \\end{pmatrix} = I$，即单位矩阵。这意味着系统已经处于卡尔曼标准型。\n变换后的矩阵为 $\\bar{A} = T^{-1}AT = A$，$\\bar{B} = T^{-1}B = B$，$\\bar{C} = CT = C$。\n从这些矩阵中可以明显看出其分解结构：\n$$\nA = \\begin{pmatrix} A_{ro} & 0 \\\\ 0 & A_{\\bar{r}\\bar{o}} \\end{pmatrix} = \\begin{pmatrix} \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix} & \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\\\ \\begin{pmatrix} 0 & 0 \\end{pmatrix} & 4 \\end{pmatrix}\n$$\n$$\nB = \\begin{pmatrix} B_{ro} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ \\hline 0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} C_{ro} & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 \\end{pmatrix}\n$$\n包含隐藏模态的块是 $A_{\\bar{r}\\bar{o}} = \\begin{pmatrix} 4 \\end{pmatrix}$。\n这个结构揭示了该模态为什么是隐藏的。令 $x = \\begin{pmatrix} x_{ro} \\\\ x_{\\bar{r}\\bar{o}} \\end{pmatrix}$。动态方程为：\n$\\dot{x}_{ro} = A_{ro} x_{ro} + B_{ro} u$\n$\\dot{x}_{\\bar{r}\\bar{o}} = A_{\\bar{r}\\bar{o}} x_{\\bar{r}\\bar{o}}$\n$y = C_{ro} x_{ro}$\n对应于隐藏模态的状态 $x_{\\bar{r}\\bar{o}}$ 不受输入 $u(t)$ 的影响（不能达），也不影响输出 $y(t)$（不能观）。\n\n最后，我们计算传递函数 $G(s) = C(sI-A)^{-1}B$。\n$$\nsI - A = \\begin{pmatrix} s & -1 & 0 \\\\ 2 & s+3 & 0 \\\\ 0 & 0 & s-4 \\end{pmatrix}\n$$\n其逆矩阵为 $(sI-A)^{-1} = \\frac{1}{\\det(sI-A)} \\text{adj}(sI-A)$。\n行列式为 $\\det(sI-A) = (s-4)(s^2+3s+2)$。\n伴随矩阵为：\n$$\n\\text{adj}(sI-A) = \\begin{pmatrix} (s+3)(s-4) & s-4 & 0 \\\\ -2(s-4) & s(s-4) & 0 \\\\ 0 & 0 & s^2+3s+2 \\end{pmatrix}\n$$\n现在我们计算 $G(s)$：\n$$\nG(s) = \\begin{pmatrix} 1 & 0 & 0 \\end{pmatrix} \\frac{1}{(s-4)(s^2+3s+2)} \\begin{pmatrix} (s+3)(s-4) & s-4 & 0 \\\\ -2(s-4) & s(s-4) & 0 \\\\ 0 & 0 & s^2+3s+2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n$$\nG(s) = \\frac{1}{(s-4)(s^2+3s+2)} \\begin{pmatrix} (s+3)(s-4) & s-4 & 0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n$$\nG(s) = \\frac{s-4}{(s-4)(s^2+3s+2)}\n$$\n对应于隐藏模态的项 $(s-4)$ 如预期一样被消掉了。\n$$\nG(s) = \\frac{1}{s^2+3s+2}\n$$\n这个传递函数只描述了系统的能达且能观部分。", "answer": "$$\\boxed{\\frac{1}{s^{2} + 3s + 2}}$$", "id": "2715552"}]}