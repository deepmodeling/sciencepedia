{"hands_on_practices": [{"introduction": "理解不可观测子空间需要从其构造性定义开始。本练习将引导你直接运用迭代算法，从第一性原理出发，在一个具体的系统中找出包含在输出矩阵 $C$ 的核空间内的最大 $A$-不变子空间 [@problem_id:2756462]。通过这个实践，你将巩固对不可观测子空间核心定义的理解，并为后续更复杂的概念打下坚实的基础。", "problem": "考虑一个连续时间线性时不变（LTI）系统，其状态方程为 $\\dot{x} = A x$，输出方程为 $y = C x$，其中 $x \\in \\mathbb{R}^{4}$，$y \\in \\mathbb{R}$，且\n$$\nA \\;=\\; \\begin{pmatrix}\n0 & 1 & 0 & 0\\\\\n0 & 0 & 0 & 0\\\\\n0 & 0 & 0 & 1\\\\\n0 & 0 & 0 & 0\n\\end{pmatrix}, \n\\qquad\nC \\;=\\; \\begin{pmatrix}\n1 & 0 & 1 & 0\n\\end{pmatrix}.\n$$\n请仅使用可观测性和 $A$-不变性的核心定义，显式地计算不可观测子空间 $\\mathcal{N}_{o}$ 的一组基。该子空间被定义为包含在 $\\ker C$ 中的最大 $A$-不变子空间。您必须从第一性原理出发，论证每一步，并展示收敛到 $\\ker C$ 内最大 $A$-不变子空间的逻辑迭代过程。\n\n最后，陈述 $\\mathcal{N}_{o}$ 的维数作为您的答案。您的最终答案必须是一个实数值。无需四舍五入，不涉及单位。", "solution": "该问题要求计算给定LTI系统的不可观测子空间 $\\mathcal{N}_{o}$。根据定义，$\\mathcal{N}_{o}$ 是状态空间 $\\mathbb{R}^{4}$ 中的最大子空间 $\\mathcal{V}$，满足 $\\mathcal{V}$ 包含在 $C$ 的核空间中（$\\mathcal{V} \\subseteq \\ker C$）且 $\\mathcal{V}$ 是 $A$-不变的（$A\\mathcal{V} \\subseteq \\mathcal{V}$）。\n\n我们将使用从第一性原理导出的迭代算法来找到这个子空间。该算法以最大可能的候选子空间进行初始化，并进行迭代优化，直到满足 $A$-不变性为止。\n\n该算法流程如下：\n1.  用子空间 $\\mathcal{V}_0 = \\ker C$ 初始化。\n2.  使用关系式 $\\mathcal{V}_{k+1} = \\mathcal{V}_k \\cap \\{x \\in \\mathbb{R}^4 \\mid Ax \\in \\mathcal{V}_k\\}$ 进行迭代。\n子空间序列 $\\mathcal{V}_0 \\supseteq \\mathcal{V}_1 \\supseteq \\mathcal{V}_2 \\supseteq \\dots$ 保证在有限步内收敛到包含在 $\\ker C$ 中的最大 $A$-不变子空间。\n\n**第一步：初始化**\n首先，我们计算初始子空间 $\\mathcal{V}_0 = \\ker C$。如果 $Cx = 0$，则向量 $x = \\begin{pmatrix} x_1 & x_2 & x_3 & x_4 \\end{pmatrix}^T$ 属于 $\\ker C$。\n$$\nCx = \\begin{pmatrix} 1 & 0 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\end{pmatrix} = x_1 + x_3 = 0\n$$\n此条件意味着 $x_1 = -x_3$。$\\ker C$ 中的一个一般向量可以写为：\n$$\nx = \\begin{pmatrix} -x_3 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\end{pmatrix} = x_2 \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} + x_3 \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix} + x_4 \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n因此，$\\mathcal{V}_0 = \\ker C$ 的一组基由以下向量集合给出：\n$$\n\\left\\{ \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix} \\right\\}\n$$\n$\\mathcal{V}_0$ 的维数是 $3$。\n\n**第二步：第一次迭代**\n我们计算 $\\mathcal{V}_1 = \\mathcal{V}_0 \\cap \\{x \\mid Ax \\in \\mathcal{V}_0\\}$。这是由 $x \\in \\mathcal{V}_0$ 且 $Ax$ 也属于 $\\mathcal{V}_0$ 的向量组成的子空间。\n设 $x \\in \\mathcal{V}_0$。我们已知其分量满足 $x_1 + x_3 = 0$。现在我们施加额外条件 $Ax \\in \\mathcal{V}_0$。\n首先，计算 $Ax$：\n$$\nAx = \\begin{pmatrix} 0 & 1 & 0 & 0\\\\ 0 & 0 & 0 & 0\\\\ 0 & 0 & 0 & 1\\\\ 0 & 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\end{pmatrix} = \\begin{pmatrix} x_2 \\\\ 0 \\\\ x_4 \\\\ 0 \\end{pmatrix}\n$$\n要使 $Ax$ 属于 $\\mathcal{V}_0 = \\ker C$，其分量必须满足 $\\ker C$ 的条件。设 $z = Ax$。条件是 $z_1 + z_3 = 0$，这等价于 $x_2 + x_4 = 0$。\n所以，$\\mathcal{V}_1$ 中的向量必须满足两个条件：\n1.  $x_1 + x_3 = 0$ (因为 $x \\in \\mathcal{V}_0$)\n2.  $x_2 + x_4 = 0$ (为了使 $Ax \\in \\mathcal{V}_0$)\n$\\mathcal{V}_1$ 中的一个一般向量具有 $x_3 = -x_1$ 和 $x_4 = -x_2$ 的形式。\n$$\nx = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ -x_1 \\\\ -x_2 \\end{pmatrix} = x_1 \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\\\ 0 \\end{pmatrix} + x_2 \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix}\n$$\n$\\mathcal{V}_1$ 的一组基是：\n$$\n\\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix} \\right\\}\n$$\n$\\mathcal{V}_1$ 的维数是 $2$。由于 $\\mathcal{V}_1$ 是 $\\mathcal{V}_0$ 的真子空间，算法尚未收敛。\n\n**第三步：第二次迭代**\n我们计算 $\\mathcal{V}_2 = \\mathcal{V}_1 \\cap \\{x \\mid Ax \\in \\mathcal{V}_1\\}$。这是由 $x \\in \\mathcal{V}_1$ 且 $Ax$ 也属于 $\\mathcal{V}_1$ 的向量组成的子空间。\n设 $x \\in \\mathcal{V}_1$。其分量满足 $x_1 + x_3 = 0$ 和 $x_2 + x_4 = 0$。\n我们检查 $Ax$ 是否在 $\\mathcal{V}_1$ 中。\n$$\nAx = \\begin{pmatrix} x_2 \\\\ 0 \\\\ x_4 \\\\ 0 \\end{pmatrix}\n$$\n要使 $Ax$ 属于 $\\mathcal{V}_1$，它的分量（我们称之为 $z_i$）必须满足 $\\mathcal{V}_1$ 的两个条件：\n1.  $z_1 + z_3 = 0 \\implies x_2 + x_4 = 0$。根据定义，此条件对任何 $x \\in \\mathcal{V}_1$ 都成立。\n2.  $z_2 + z_4 = 0 \\implies 0 + 0 = 0$。此条件显然成立。\n由于对任何 $x \\in \\mathcal{V}_1$，这两个条件都成立，因此可以得出，如果 $x \\in \\mathcal{V}_1$，那么 $Ax \\in \\mathcal{V}_1$。这意味着 $A\\mathcal{V}_1 \\subseteq \\mathcal{V}_1$，所以 $\\mathcal{V}_1$ 是一个 $A$-不变子空间。\n因此，迭代得出 $\\mathcal{V}_2 = \\{x \\in \\mathcal{V}_1 \\mid Ax \\in \\mathcal{V}_1\\} = \\mathcal{V}_1$。\n由于 $\\mathcal{V}_2 = \\mathcal{V}_1$，算法已经收敛。\n\n**结论**\n包含在 $\\ker C$ 中的最大 $A$-不变子空间是 $\\mathcal{N}_o = \\mathcal{V}_1$。$\\mathcal{N}_o$ 的一组基为：\n$$\n\\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix} \\right\\}\n$$\n子空间的维数是其基中向量的数量。$\\mathcal{N}_o$ 的基包含两个向量。因此，不可观测子空间 $\\mathcal{N}_o$ 的维数是 $2$。", "answer": "$$\n\\boxed{2}\n$$", "id": "2756462"}, {"introduction": "这个练习是一个关键的思想实验，它揭示了状态估计的一个核心限制。通过分析一个不稳定的模式恰好处于不可观测子空间中的明确案例，你将理解为何某些系统无法设计出稳定的观测器 [@problem_id:2756426]。这个实践精确地阐明了为何“可检测性”是一个至关重要的概念，并展示了当此条件不被满足时的根本后果。", "problem": "考虑一个线性时不变 (LTI) 系统，其状态空间表示为 $\\dot{x} = A x$, $y = C x$，其中 $x \\in \\mathbb{R}^{2}$，$y \\in \\mathbb{R}$，且\n$$\nA = \\begin{pmatrix} 1 & 0 \\\\ 0 & -2 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 0 & 1 \\end{pmatrix}.\n$$\n从不可观测子空间和可检测性的基本定义出发，完成以下任务：\n1) 确定给定矩阵对 $(A,C)$ 的不可观测子空间，并找出 $A$ 的特征向量位于此子空间内的所有特征值。从第一性原理出发论证所有步骤。\n2) 仅使用不变子空间和线性算子的基本性质，解释为什么 $A$ 的与不可观测子空间中的特征向量相关联的任何特征值都不能通过形式为 $A - L C$ 的输出注入来移动，其中 $L \\in \\mathbb{R}^{2 \\times 1}$ 是任意的。\n3) 判断 $(A,C)$ 是否可检测，并基于可检测性的定义（即，根据不可观测模态的稳定性）给出严格的论证。\n4) 设方阵 $M$ 的谱横坐标定义为 $\\alpha(M) \\triangleq \\max \\{\\operatorname{Re}(\\lambda) : \\lambda \\text{ is an eigenvalue of } M\\}$。计算下式的精确值\n$$\n\\inf_{L \\in \\mathbb{R}^{2 \\times 1}} \\, \\alpha(A - L C).\n$$\n给出最终答案，形式为精确数值，不带单位。无需四舍五入。", "solution": "我们从基本定义开始。对于线性时不变 (LTI) 系统 $\\dot{x} = A x$, $y = C x$，不可观测子空间 $\\mathcal{N}_{\\mathrm{obs}}$ 是包含在输出映射 $C$ 的核 (kernel) 中的最大 $A$-不变子空间，对于有限维系统，它可以计算为\n$$\n\\mathcal{N}_{\\mathrm{obs}} = \\bigcap_{k=0}^{n-1} \\ker\\!\\left(C A^{k}\\right),\n$$\n其中 $n$ 是系统阶数。$(A,C)$ 的可检测性意味着每一条不可观测的轨迹在 $t \\to \\infty$ 时都收敛到原点，等价地，$A$ 的特征向量位于不可观测子空间中的每个特征值的实部都严格为负。\n\n第1步：计算不可观测子空间并找出相关特征值。对于给定的矩阵\n$$\nA = \\begin{pmatrix} 1 & 0 \\\\ 0 & -2 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 0 & 1 \\end{pmatrix},\n$$\n我们有\n$$\nC = \\begin{pmatrix} 0 & 1 \\end{pmatrix}, \\quad C A = C \\begin{pmatrix} 1 & 0 \\\\ 0 & -2 \\end{pmatrix} = \\begin{pmatrix} 0 & -2 \\end{pmatrix}.\n$$\n于是\n$$\n\\ker(C) = \\left\\{ x \\in \\mathbb{R}^{2} : \\begin{pmatrix} 0 & 1 \\end{pmatrix} x = 0 \\right\\} = \\operatorname{span}\\!\\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\right\\},\n$$\n并且\n$$\n\\ker(CA) = \\left\\{ x \\in \\mathbb{R}^{2} : \\begin{pmatrix} 0 & -2 \\end{pmatrix} x = 0 \\right\\} = \\operatorname{span}\\!\\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\right\\}.\n$$\n因此\n$$\n\\mathcal{N}_{\\mathrm{obs}} = \\ker(C) \\cap \\ker(CA) = \\operatorname{span}\\!\\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\right\\}.\n$$\n向量 $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 是 $A$ 的一个特征向量，因为\n$$\nA \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\n$$\n所以它对应于特征值 $\\lambda = 1$。因此，$A$ 的特征值 $\\lambda = 1$ 是不可观测的。因为 $\\operatorname{Re}(1) = 1 > 0$，所以它是一个不稳定的特征值。\n\n第2步：证明不可观测特征值在输出注入下的不可移动性。考虑一个任意的输出注入增益 $L \\in \\mathbb{R}^{2 \\times 1}$，以及修正后的矩阵 $A - L C$。设 $x \\in \\mathcal{N}_{\\mathrm{obs}}$。根据不可观测子空间的定义，$C x = 0$。因此，\n$$\n(A - L C) x = A x - L (C x) = A x - L \\cdot 0 = A x.\n$$\n因此，$\\mathcal{N}_{\\mathrm{obs}}$ 对于 $A$ 和 $A - L C$ 都是不变子空间，并且 $A - L C$ 在 $\\mathcal{N}_{\\mathrm{obs}}$ 上的作用与 $A$ 在 $\\mathcal{N}_{\\mathrm{obs}}$ 上的作用一致。因此，$A$ 的与 $\\mathcal{N}_{\\mathrm{obs}}$ 中的特征向量相关联的每个特征值，也是 $A - L C$ 的一个具有相同值的特征值。特别地，对于任意 $L$，不可观测特征值 $\\lambda = 1$ 在 $A - L C$ 中都存在。\n\n第3步：可检测性结论。根据可检测性的定义，如果每个不可观测特征值的实部都严格为负，则 $(A,C)$ 是可检测的。我们已经确定了一个实部为正的不可观测特征值 $\\lambda = 1$。因此，$(A,C)$ 是不可检测的。等价地，由于对于所有 $L$，$\\lambda = 1$ 都保留在 $A - L C$ 的谱中，因此不存在任何 $L$ 的选择可以使 $A - L C$ 成为 Hurwitz 矩阵，所以通过输出注入实现镇定是不可能的。\n\n第4步：计算 $\\inf_{L} \\alpha(A - L C)$。设 $L = \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix}$。则\n$$\nL C = \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & \\ell_{1} \\\\ 0 & \\ell_{2} \\end{pmatrix},\n$$\n因此\n$$\nA - L C = \\begin{pmatrix} 1 & 0 \\\\ 0 & -2 \\end{pmatrix} - \\begin{pmatrix} 0 & \\ell_{1} \\\\ 0 & \\ell_{2} \\end{pmatrix} = \\begin{pmatrix} 1 & -\\ell_{1} \\\\ 0 & -2 - \\ell_{2} \\end{pmatrix}.\n$$\n该矩阵是上三角矩阵，所以其特征值是其对角线元素：\n$$\n\\lambda_{1} = 1, \\quad \\lambda_{2} = -2 - \\ell_{2}.\n$$\n因此，谱横坐标为\n$$\n\\alpha(A - L C) = \\max \\{ \\operatorname{Re}(1), \\operatorname{Re}(-2 - \\ell_{2}) \\} = \\max \\{ 1, -2 - \\ell_{2} \\}.\n$$\n对 $\\ell_{2} \\in \\mathbb{R}$ 进行最小化可得\n$$\n\\inf_{\\ell_{2} \\in \\mathbb{R}} \\max \\{ 1, -2 - \\ell_{2} \\} = 1,\n$$\n因为 $\\lambda_{1} = 1$ 是一个固定值，无法通过任何 $L$ 的选择来减小。因此，\n$$\n\\inf_{L \\in \\mathbb{R}^{2 \\times 1}} \\alpha(A - L C) = 1.\n$$\n这既证实了通过输出注入实现镇定的不可能性，也提供了所要求的精确值。", "answer": "$$\\boxed{1}$$", "id": "2756426"}, {"introduction": "本练习综合了本章的核心概念，将理论与实践联系起来。你将运用 Popov–Belevitch–Hautus (PBH) 测试来判断系统的可检测性，并将其与设计稳定的 Luenberger 观测器的能力直接挂钩 [@problem_id:2756420]。这个实践表明，即使系统不是完全可观测的，只要它满足可检测性条件，我们仍然能够有效地设计一个观测器，使其估计误差渐近收敛于零。", "problem": "考虑一个连续时间线性时不变（LTI）系统，其状态矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$ 和输出矩阵 $C \\in \\mathbb{R}^{1 \\times 4}$ 由下式给出：\n$$\nA \\;=\\; \\begin{bmatrix}\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & -1 & 0 \\\\\n0 & 0 & 0 & -2\n\\end{bmatrix},\n\\qquad\nC \\;=\\; \\begin{bmatrix} 1 & 0 & 0 & 0 \\end{bmatrix}.\n$$\n仅使用基本定义和广泛接受的特性，按如下步骤进行。\n1) 从可检测性的定义和限于闭右半平面（即，对于所有满足 $\\Re(\\lambda) \\ge 0$ 的复数 $\\lambda$）的 Popov–Belevitch–Hautus (PBH) 检验特性出发，判断系统对 $(A,C)$ 是否是可检测的。你的推理必须检验与 $\\Re(\\lambda) \\ge 0$ 相关的特征结构，并应用 PBH 秩条件，不得使用任何未经证明的捷径。\n2) 确定 $(A,C)$ 的不可观测子空间，并解释任何存在的不可观测模态是否稳定，同时将其与可检测性建立清晰的联系。\n3) 设计一个 Luenberger 观测器增益 $L \\in \\mathbb{R}^{4 \\times 1}$，使得观测器误差动态矩阵 $A - L C$ 在可观测子空间上的特征值位于 $\\{-3,\\,-4,\\,-5\\}$，同时保持任何固有的不可观测模态不变。通过匹配目标特征值所对应的特征多项式来构造 $L$。\n4) 最后，为你所设计的 $L$ 计算最终的观测器误差动态矩阵 $A - L C$ 的行列式。将此行列式作为最终答案报告。最终答案是一个无单位的单实数值。无需四舍五入。", "solution": "解决方案按顺序处理四个指定的任务。\n\n1) 系统对 $(A,C)$ 的可检测性。\nLTI 系统的可检测性定义指出，系统对 $(A,C)$ 是可检测的，当且仅当系统的所有不可观测模态都是稳定的。一个等效的特性是用于可检测性的 Popov–Belevitch–Hautus (PBH) 检验，该检验要求对于所有满足 $\\Re(\\lambda) \\ge 0$ 的 $\\lambda \\in \\mathbb{C}$，矩阵 $\\begin{bmatrix} A - \\lambda I \\\\ C \\end{bmatrix}$ 具有满列秩。此处，状态维度为 $n=4$，因此我们必须检查对于所有这样的 $\\lambda$，是否有 $\\text{rank}\\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix} = 4$。\n\n首先，我们求 $A$ 的特征值。矩阵 $A$ 是分块上三角矩阵：\n$$\nA = \\begin{bmatrix} A_{11} & A_{12} \\\\ 0 & A_{22} \\end{bmatrix} = \\begin{bmatrix} \\begin{matrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & 0 & -1 \\end{matrix} & \\begin{matrix} 0 \\\\ 0 \\\\ 0 \\end{matrix} \\\\ \\begin{matrix} 0 & 0 & 0 \\end{matrix} & -2 \\end{bmatrix}\n$$\n$A$ 的特征值是其对角分块 $A_{11}$ 和 $A_{22}$ 特征值的并集。左上 $3 \\times 3$ 分块的特征值是其对角线元素，即 $\\{0, 0, -1\\}$。右下 $1 \\times 1$ 分块的特征值是 $\\{-2\\}$。因此，$A$ 的谱为 $\\sigma(A) = \\{0, 0, -1, -2\\}$。\n\n$A$ 的特征值中唯一满足 $\\Re(\\lambda) \\ge 0$ 的是 $\\lambda=0$。可观测性的 PBH 检验指出，一个特征值 $\\lambda$ 是不可观测的，当且仅当 $\\text{rank}\\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix} < n$。对于可检测性，我们只需对闭右半平面内的特征值验证此条件。我们对 $\\lambda=0$ 进行检验：\n$$\n\\begin{bmatrix} A - 0 \\cdot I \\\\ C \\end{bmatrix} = \\begin{bmatrix} A \\\\ C \\end{bmatrix} = \\begin{bmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & -1 & 0 \\\\ 0 & 0 & 0 & -2 \\\\ 1 & 0 & 0 & 0 \\end{bmatrix}\n$$\n这是一个 $5 \\times 4$ 矩阵。我们检查其是否满列秩，即秩为 $4$。选取该矩阵的第 5, 1, 2, 4 行，得到一个 $4 \\times 4$ 的子矩阵：\n$$\n\\begin{bmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & -2 \\end{bmatrix}\n$$\n该子矩阵的行列式为 $1 \\cdot 1 \\cdot 1 \\cdot (-2) = -2 \\ne 0$。由于我们找到了一个秩为 $4$ 的 $4 \\times 4$ 子矩阵，因此 $5 \\times 4$ 矩阵 $\\begin{pmatrix} A \\\\ C \\end{pmatrix}$ 的秩为 $4$。因此，对于 $\\lambda=0$，PBH 秩条件成立。因为这是闭右半平面中唯一的特征值，所以系统对 $(A,C)$ 是可检测的。\n\n2) 不可观测子空间与模态。\n不可观测子空间是可观测性矩阵 $\\mathcal{O}$ 的零空间。\n$$\n\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\\\ CA^2 \\\\ CA^3 \\end{bmatrix}\n$$\n我们计算各行：\n$C = \\begin{bmatrix} 1 & 0 & 0 & 0 \\end{bmatrix}$\n$CA = \\begin{bmatrix} 1 & 0 & 0 & 0 \\end{bmatrix} A = \\begin{bmatrix} 0 & 1 & 0 & 0 \\end{bmatrix}$\n$CA^2 = (CA)A = \\begin{bmatrix} 0 & 1 & 0 & 0 \\end{bmatrix} A = \\begin{bmatrix} 0 & 0 & 1 & 0 \\end{bmatrix}$\n$CA^3 = (CA^2)A = \\begin{bmatrix} 0 & 0 & 1 & 0 \\end{bmatrix} A = \\begin{bmatrix} 0 & 0 & -1 & 0 \\end{bmatrix}$\n可观测性矩阵为：\n$$\n\\mathcal{O} = \\begin{bmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & -1 & 0 \\end{bmatrix}\n$$\n第四行是第三行的 $-1$ 倍，所以各行线性相关。前三行线性无关。因此, $\\text{rank}(\\mathcal{O}) = 3$。因为 $\\text{rank}(\\mathcal{O}) < 4$，系统是不可观测的。\n不可观测子空间是 $\\mathcal{N}(\\mathcal{O})$。我们寻找一个向量 $x = [x_1, x_2, x_3, x_4]^T$ 使得 $\\mathcal{O}x = 0$。这导出了方程组 $x_1=0$，$x_2=0$ 和 $x_3=0$。变量 $x_4$ 是自由的。因此，不可观测子空间由向量 $v = [0, 0, 0, 1]^T$ 张成。\n$$\n\\mathcal{N}(\\mathcal{O}) = \\text{span}\\left\\{ \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix} \\right\\}\n$$\n不可观测模态是与不可观测子空间中的特征向量相关联的 $A$ 的特征值。我们检查 $v$ 是否是 $A$ 的一个特征向量：\n$$\nAv = \\begin{bmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & -1 & 0 \\\\ 0 & 0 & 0 & -2 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ -2 \\end{bmatrix} = -2 \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix} = -2v\n$$\n向量 $v$ 确实是 $A$ 的一个特征向量，其对应的特征值为 $\\lambda = -2$。这个特征值就是系统的不可观测模态。\n对于可检测性，所有不可观测模态都必须是稳定的，这意味着它们对应的特征值必须有严格为负的实部。这里，唯一的不可观测模态是 $\\lambda = -2$，且 $\\Re(-2) = -2 < 0$。因此，该模态是稳定的。这证实了系统对 $(A,C)$ 是可检测的。\n\n3) Luenberger 观测器增益设计。\n我们设计一个增益 $L = [l_1, l_2, l_3, l_4]^T$，使得观测器误差动态矩阵 $A-LC$ 具有指定的特征值。矩阵 $A-LC$ 为：\n$$\nA - LC = A - \\begin{bmatrix} l_1 \\\\ l_2 \\\\ l_3 \\\\ l_4 \\end{bmatrix} \\begin{bmatrix} 1 & 0 & 0 & 0 \\end{bmatrix} = \\begin{bmatrix} -l_1 & 1 & 0 & 0 \\\\ -l_2 & 0 & 1 & 0 \\\\ -l_3 & 0 & -1 & 0 \\\\ -l_4 & 0 & 0 & -2 \\end{bmatrix}\n$$\n特征多项式为 $p(s) = \\det(sI - (A-LC))$。\n$$\nsI - (A-LC) = \\begin{bmatrix} s+l_1 & -1 & 0 & 0 \\\\ l_2 & s & -1 & 0 \\\\ l_3 & 0 & s+1 & 0 \\\\ l_4 & 0 & 0 & s+2 \\end{bmatrix}\n$$\n由于其分块三角结构，行列式是对角分块行列式的乘积：\n$$\n\\det(sI - (A-LC)) = (s+2) \\cdot \\det \\begin{bmatrix} s+l_1 & -1 & 0 \\\\ l_2 & s & -1 \\\\ l_3 & 0 & s+1 \\end{bmatrix}\n$$\n这表明位于 $s=-2$ 的不可观测特征值是固定的，与 $L$ 的选择无关。观测器增益只能影响可观测的特征值。该 $3 \\times 3$ 分块的行列式为：\n$\\det(\\cdot) = (s+l_1)[s(s+1) - 0] - (-1)[l_2(s+1) - (-l_3)] = (s+l_1)(s^2+s) + l_2(s+1) + l_3 = s^3 + s^2 + l_1s^2 + l_1s + l_2s + l_2 + l_3 = s^3 + (1+l_1)s^2 + (l_1+l_2)s + (l_2+l_3)$.\n可观测部分所需的目标特征多项式由目标特征值 $\\{-3, -4, -5\\}$ 指定：\n$p_{des}(s) = (s+3)(s+4)(s+5) = (s^2+7s+12)(s+5) = s^3+5s^2+7s^2+35s+12s+60 = s^3+12s^2+47s+60$.\n通过系数匹配，我们求出增益 $l_1, l_2, l_3$：\n$s^2$ 项: $1+l_1 = 12 \\implies l_1 = 11$.\n$s^1$ 项: $l_1+l_2 = 47 \\implies 11+l_2 = 47 \\implies l_2 = 36$.\n$s^0$ 项: $l_2+l_3 = 60 \\implies 36+l_3 = 60 \\implies l_3 = 24$.\n增益 $l_4$ 对特征值没有影响。在特征多项式计算中，$l_4$ 仅出现在项 $l_4 \\det(\\text{matrix with a zero column}) = 0$ 中。为简单起见，我们可以将其设为零，$l_4=0$。\n设计的观测器增益为 $L = \\begin{bmatrix} 11 & 36 & 24 & 0 \\end{bmatrix}^T$。\n\n4) 最终观测器误差动态矩阵的行列式。\n一个矩阵的行列式是其所有特征值的乘积。设计的观测器误差动态矩阵 $A-LC$ 的特征值是所配置的特征值和固定的不可观测特征值的并集：$\\{-3, -4, -5, -2\\}$。\n因此，行列式为：\n$$\n\\det(A-LC) = (-3) \\cdot (-4) \\cdot (-5) \\cdot (-2) = (12) \\cdot (10) = 120\n$$\n另外，我们也可以用设计好的增益直接从矩阵 $A-LC$ 计算行列式：\n$$\nA-LC = \\begin{bmatrix} -11 & 1 & 0 & 0 \\\\ -36 & 0 & 1 & 0 \\\\ -24 & 0 & -1 & 0 \\\\ 0 & 0 & 0 & -2 \\end{bmatrix}\n$$\n沿第四行进行余子式展开：\n$$\n\\det(A-LC) = (-2) \\cdot \\det \\begin{bmatrix} -11 & 1 & 0 \\\\ -36 & 0 & 1 \\\\ -24 & 0 & -1 \\end{bmatrix}\n$$\n现在，对该 $3 \\times 3$ 矩阵沿第二列进行余子式展开：\n$$\n\\det(A-LC) = (-2) \\cdot \\left( -1 \\cdot \\det \\begin{bmatrix} -36 & 1 \\\\ -24 & -1 \\end{bmatrix} \\right) = (-2) \\cdot \\left( -1 \\cdot [(-36)(-1) - (1)(-24)] \\right)\n$$\n$$\n\\det(A-LC) = (-2) \\cdot (-1 \\cdot [36 + 24]) = (-2) \\cdot (-1 \\cdot 60) = (-2) \\cdot (-60) = 120\n$$\n两种方法得到相同的结果。计算是正确的。", "answer": "$$\n\\boxed{120}\n$$", "id": "2756420"}]}