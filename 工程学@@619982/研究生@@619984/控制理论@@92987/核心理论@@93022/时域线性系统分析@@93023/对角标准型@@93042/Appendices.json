{"hands_on_practices": [{"introduction": "本练习将指导您完成将系统传递函数转换为其对角典范型状态空间表示的基本过程。这项核心技能使我们能够将一个线性系统看作一组相互独立的、并行的动态模态的集合，为进一步的分析和控制设计奠定基础。通过这个练习，您将掌握通过部分分式展开来解耦系统动态的实用方法。[@problem_id:1754750]", "problem": "一个稳定的二阶线性时不变 (LTI) 系统，是模拟信号处理中的一个基本模块，其由一个传递函数 $H(s)$ 描述。该传递函数连接了输出的拉普拉斯变换 $Y(s)$ 和输入的拉普拉斯变换 $U(s)$。该系统的具体传递函数为：\n$$H(s) = \\frac{Y(s)}{U(s)} = \\frac{5}{s^2 + 5s + 4}$$\n为了实现的目的，该系统需要使用状态空间表示法进行建模，其方程定义如下：\n$$\\dot{\\mathbf{x}}(t) = \\mathbf{A}\\mathbf{x}(t) + \\mathbf{B}u(t)$$\n$$y(t) = \\mathbf{C}\\mathbf{x}(t) + D u(t)$$\n一项关键的设计规范要求模型的内部状态变量相互之间动态解耦。这通过确保状态矩阵 $\\mathbf{A}$ 是一个对角矩阵来实现。为保证验证时表示的唯一性，矩阵 $\\mathbf{A}$ 的对角元素必须按照第一个元素的绝对值严格小于第二个元素的绝对值的方式排列，即 $|A_{11}|  |A_{22}|$。\n\n给定这个特定的解耦状态空间表示，请确定表达式 $A_{22} \\cdot B_{11} + C_{12}$ 的数值。", "solution": "问题要求计算一个表达式的值，该表达式涉及一个系统的状态空间矩阵（$\\mathbf{A}$、$\\mathbf{B}$、$\\mathbf{C}$）的元素，该系统由传递函数 $H(s) = \\frac{5}{s^2 + 5s + 4}$ 给出。关键约束是状态矩阵 $\\mathbf{A}$ 必须是对角矩阵。这对应于系统的对角标准型（或并行实现）。\n\n首先，我们需要对传递函数 $H(s)$ 进行部分分式展开。我们首先求出系统的极点，即分母多项式的根：\n$$s^2 + 5s + 4 = 0$$\n对二次多项式进行因式分解，我们得到：\n$$(s+1)(s+4) = 0$$\n极点是 $p_1 = -1$ 和 $p_2 = -4$。\n\n现在，我们可以将传递函数表示为：\n$$H(s) = \\frac{5}{(s+1)(s+4)} = \\frac{R_1}{s+1} + \\frac{R_2}{s+4}$$\n为了求出留数 $R_1$ 和 $R_2$，我们使用留数法（或称遮盖法）。\n对于 $R_1$：\n$$R_1 = \\left. (s+1)H(s) \\right|_{s=-1} = \\left. \\frac{5}{s+4} \\right|_{s=-1} = \\frac{5}{-1+4} = \\frac{5}{3}$$\n对于 $R_2$：\n$$R_2 = \\left. (s+4)H(s) \\right|_{s=-4} = \\left. \\frac{5}{s+1} \\right|_{s=-4} = \\frac{5}{-4+1} = -\\frac{5}{3}$$\n所以部分分式展开为：\n$$H(s) = \\frac{5/3}{s+1} - \\frac{5/3}{s+4}$$\n输出 $Y(s)$ 可以写成两项之和：\n$$Y(s) = \\left( \\frac{5/3}{s+1} \\right)U(s) + \\left( \\frac{-5/3}{s+4} \\right)U(s)$$\n对角标准型将系统表示为一阶系统的并联组合。我们可以根据输入 $U(s)$ 和系统极点来定义状态变量 $X_1(s)$ 和 $X_2(s)$。一种标准的选择是：\n$$X_1(s) = \\frac{1}{s+1}U(s) \\quad \\text{和} \\quad X_2(s) = \\frac{1}{s+4}U(s)$$\n根据这些定义，我们可以在拉普拉斯域中写出状态方程：\n$$sX_1(s) = -X_1(s) + U(s)$$\n$$sX_2(s) = -4X_2(s) + U(s)$$\n变换回时域，其中 $sX(s)$ 对应于 $\\dot{x}(t)$：\n$$\\dot{x}_1(t) = -x_1(t) + u(t)$$\n$$\\dot{x}_2(t) = -4x_2(t) + u(t)$$\n输出方程通过用 $X_1(s)$ 和 $X_2(s)$ 表示 $Y(s)$ 来得到：\n$$Y(s) = \\frac{5}{3}X_1(s) - \\frac{5}{3}X_2(s)$$\n在时域中，这变为：\n$$y(t) = \\frac{5}{3}x_1(t) - \\frac{5}{3}x_2(t)$$\n现在我们可以构建状态空间矩阵 $\\mathbf{A}$、$\\mathbf{B}$、$\\mathbf{C}$ 和 $D$。\n根据状态方程：\n$$\\begin{pmatrix} \\dot{x}_1 \\\\ \\dot{x}_2 \\end{pmatrix} = \\begin{pmatrix} -1  0 \\\\ 0  -4 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} u(t)$$\n所以，$\\mathbf{A} = \\begin{pmatrix} -1  0 \\\\ 0  -4 \\end{pmatrix}$ 且 $\\mathbf{B} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n根据输出方程：\n$$y(t) = \\begin{pmatrix} 5/3  -5/3 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} + 0 \\cdot u(t)$$\n所以，$\\mathbf{C} = \\begin{pmatrix} 5/3  -5/3 \\end{pmatrix}$ 且 $D=0$。\n\n我们必须验证排序约束 $|A_{11}|  |A_{22}|$。\n$|A_{11}| = |-1| = 1$。\n$|A_{22}| = |-4| = 4$。\n因为 $1  4$，该约束得到满足。如果不满足，我们就需要交换状态 $x_1$ 和 $x_2$，这会改变 $\\mathbf{A}$ 的对角元素以及 $\\mathbf{B}$ 和 $\\mathbf{C}$ 中元素的顺序。在此排序下，我们得到了正确的矩阵。\n\n最后，我们计算所要求的表达式 $A_{22} \\cdot B_{11} + C_{12}$。\n根据我们的矩阵：\n$A_{22} = -4$\n$B_{11} = 1$\n$C_{12} = -5/3$\n\n将这些值代入表达式：\n$$A_{22} \\cdot B_{11} + C_{12} = (-4) \\cdot (1) + \\left(-\\frac{5}{3}\\right) = -4 - \\frac{5}{3}$$\n为了合并这些项，我们找到一个公分母：\n$$-4 - \\frac{5}{3} = -\\frac{12}{3} - \\frac{5}{3} = -\\frac{17}{3}$$\n该表达式的值是 $-17/3$。", "answer": "$$\\boxed{-\\frac{17}{3}}$$", "id": "1754750"}, {"introduction": "在掌握了对角标准型的基础上，本练习将深入探讨可观测性这一关键的系统属性。您将亲眼见证一个系统的某个模态，尽管其本身是动态变化的，但如何因其在输出矩阵 $C$ 中的特定结构而变得对系统输出完全“隐形”。这个思想实验清晰地揭示了为什么状态空间中的某些动态可能无法从外部测量中察觉。[@problem_id:2700279]", "problem": "考虑一个处于对角标准型且零输入的线性时不变（LTI）状态空间系统，其描述为\n$$\\dot{\\mathbf{x}}(t)=\\Lambda \\mathbf{x}(t), \\quad y(t)=C \\mathbf{x}(t),$$\n其中\n$$\\Lambda=\\mathrm{diag}(-1,-2,4), \\quad C=\\begin{bmatrix}1  1  0\\end{bmatrix}, \\quad \\mathbf{x}(0)=\\begin{bmatrix}3 \\\\ -1 \\\\ 7\\end{bmatrix}.$$\n根据定义，如果满足 $C \\mathbf{v}_i=0$，则与特征值 $\\lambda_i$ 和特征向量 $\\mathbf{v}_i$ 相关联的模态是不可观测的。在该系统中，标准基向量是 $\\Lambda$ 的特征向量。\n\n仅使用线性时不变系统的状态转移和输出映射的基本定义，完成以下任务：\n- 直接根据定义验证与特征值 $\\lambda_3=4$ 和特征向量 $\\mathbf{v}_3$ 对应的模态是不可观测的。\n- 在 $u(t)\\equiv 0$ 的条件下，推导 $t \\ge 0$ 时的闭式输出 $y(t)$，并将其简化为关于 $t$ 的单一解析表达式。\n\n请以 $y(t)$ 的单一闭式解析表达式的形式提供您的最终答案。无需四舍五入，最终答案中不应包含单位。", "solution": "该问题要求完成两项任务：首先，验证特定模态的不可观测性；其次，推导系统的输出响应 $y(t)$。两项任务都必须使用基本定义来完成。\n\n系统由以下状态空间方程描述：\n$$\n\\dot{\\mathbf{x}}(t) = \\Lambda \\mathbf{x}(t)\n$$\n$$\ny(t) = C \\mathbf{x}(t)\n$$\n输入为零，$u(t) \\equiv 0$。给定的参数为对角系统矩阵 $\\Lambda$、输出矩阵 $C$ 和初始状态向量 $\\mathbf{x}(0)$：\n$$\n\\Lambda = \\mathrm{diag}(-1, -2, 4) = \\begin{bmatrix} -1  0  0 \\\\ 0  -2  0 \\\\ 0  0  4 \\end{bmatrix}\n$$\n$$\nC = \\begin{bmatrix} 1  1  0 \\end{bmatrix}\n$$\n$$\n\\mathbf{x}(0) = \\begin{bmatrix} 3 \\\\ -1 \\\\ 7 \\end{bmatrix}\n$$\n系统的特征值是 $\\Lambda$ 的对角元素：$\\lambda_1 = -1$, $\\lambda_2 = -2$, $\\lambda_3 = 4$。由于 $\\Lambda$ 是一个对角矩阵，其特征向量是 $\\mathbb{R}^3$ 中的标准基向量：\n$$\n\\mathbf{v}_1 = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad \\mathbf{v}_2 = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix}, \\quad \\mathbf{v}_3 = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}\n$$\n第一项任务是验证与特征值 $\\lambda_3 = 4$ 相关联的模态是不可观测的。对于一个特征值-特征向量对 $(\\lambda_i, \\mathbf{v}_i)$，其模态不可观测的定义是条件 $C \\mathbf{v}_i = 0$ 成立。我们必须对第三个模态 $(\\lambda_3, \\mathbf{v}_3)$ 检验此条件。\n\n我们计算乘积 $C \\mathbf{v}_3$：\n$$\nC \\mathbf{v}_3 = \\begin{bmatrix} 1  1  0 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix} = (1)(0) + (1)(0) + (0)(1) = 0\n$$\n条件 $C \\mathbf{v}_3 = 0$ 成立。因此，根据定义，与特征值 $\\lambda_3 = 4$ 相关联的模态是不可观测的。这完成了问题的第一部分。\n\n第二项任务是推导 $t \\ge 0$ 时输出 $y(t)$ 的闭式表达式。带有初始条件 $\\mathbf{x}(0)$ 的状态方程 $\\dot{\\mathbf{x}}(t) = \\Lambda \\mathbf{x}(t)$ 的解由状态转移给出：\n$$\n\\mathbf{x}(t) = e^{\\Lambda t} \\mathbf{x}(0)\n$$\n对于对角矩阵 $\\Lambda = \\mathrm{diag}(\\lambda_1, \\lambda_2, \\lambda_3)$，矩阵指数 $e^{\\Lambda t}$ 也是一个对角矩阵，其元素是 $\\Lambda t$ 相应对角元素的指数：\n$$\ne^{\\Lambda t} = \\mathrm{diag}(\\exp(\\lambda_1 t), \\exp(\\lambda_2 t), \\exp(\\lambda_3 t)) = \\begin{bmatrix} \\exp(-t)  0  0 \\\\ 0  \\exp(-2t)  0 \\\\ 0  0  \\exp(4t) \\end{bmatrix}\n$$\n现在，我们通过将状态转移矩阵乘以初始状态向量来计算状态向量 $\\mathbf{x}(t)$：\n$$\n\\mathbf{x}(t) = \\begin{bmatrix} \\exp(-t)  0  0 \\\\ 0  \\exp(-2t)  0 \\\\ 0  0  \\exp(4t) \\end{bmatrix} \\begin{bmatrix} 3 \\\\ -1 \\\\ 7 \\end{bmatrix} = \\begin{bmatrix} 3\\exp(-t) \\\\ -1\\exp(-2t) \\\\ 7\\exp(4t) \\end{bmatrix}\n$$\n状态向量的分量为：\n$$\nx_1(t) = 3\\exp(-t)\n$$\n$$\nx_2(t) = -\\exp(-2t)\n$$\n$$\nx_3(t) = 7\\exp(4t)\n$$\n最后，我们使用输出方程 $y(t) = C \\mathbf{x}(t)$ 来求得输出 $y(t)$：\n$$\ny(t) = \\begin{bmatrix} 1  1  0 \\end{bmatrix} \\begin{bmatrix} x_1(t) \\\\ x_2(t) \\\\ x_3(t) \\end{bmatrix} = (1)x_1(t) + (1)x_2(t) + (0)x_3(t)\n$$\n代入状态分量的表达式：\n$$\ny(t) = (1)(3\\exp(-t)) + (1)(-\\exp(-2t)) + (0)(7\\exp(4t))\n$$\n简化此表达式，得到输出的最终闭式形式：\n$$\ny(t) = 3\\exp(-t) - \\exp(-2t)\n$$\n至关重要的是，我们观察到代表 $\\lambda_3=4$ 不可观测模态动态的项 $x_3(t) = 7\\exp(4t)$ 并未出现在输出 $y(t)$ 中。这是输出矩阵 $C$ 第三列中零元素的直接结果，而这恰好是使该模态不可观测的条件。初始条件 $x_3(0) = 7$ 激发了此模态，但其演化完全保留在系统内部，对测量输出没有影响。", "answer": "$$\n\\boxed{3\\exp(-t) - \\exp(-2t)}\n$$", "id": "2700279"}, {"introduction": "最后的这个实践将带领您从分析转向设计，将您对可观测性的理解应用于一个实际的控制工程任务中。您将设计一个Luenberger观测器，并且利用对角标准型的简化特性，为系统的可观测模态精确配置估计误差的动态响应（即配置极点）。这个练习展示了对角标准型在简化复杂控制系统设计问题中的强大作用。[@problem_id:2700302]", "problem": "考虑一个处于对角标准型的线性时不变状态空间模型，其状态动态矩阵 $A_{d} \\in \\mathbb{R}^{4 \\times 4}$ 和输出矩阵 $C_{d} \\in \\mathbb{R}^{2 \\times 4}$ 由下式给出：\n$$\nA_{d} = \\mathrm{diag}(-1,\\,2,\\,0,\\,-3), \n\\qquad\nC_{d} = \\begin{pmatrix}\n3  0  0  0\\\\\n0  0  2  0\n\\end{pmatrix}.\n$$\n一个全阶 Luenberger 观测器实现为：\n$$\n\\dot{\\hat{\\mathbf{x}}} = A_{d}\\,\\hat{\\mathbf{x}} + L\\,(\\mathbf{y} - C_{d}\\,\\hat{\\mathbf{x}}),\n$$\n其中 $L \\in \\mathbb{R}^{4 \\times 2}$ 是待设计的观测器增益。设估计误差为 $\\mathbf{e} = \\mathbf{x} - \\hat{\\mathbf{x}}$。在通常的构造下，估计误差动态遵循：\n$$\n\\dot{\\mathbf{e}} = (A_{d} - L\\,C_{d})\\,\\mathbf{e}.\n$$\n假设我们希望每个可观测模式以指定的速率衰减，并且不在估计误差动态中引入模式间的耦合。具体要求如下：\n- 与第一个状态坐标相关的误差模式以速率 $6$ 衰减（也就是说，$A_{d} - L\\,C_{d}$ 的对应特征值为 $-6$），\n- 与第三个状态坐标相关的误差模式以速率 $4$ 衰减（也就是说，$A_{d} - L\\,C_{d}$ 的对应特征值为 $-4$），\n- 与第二和第四个坐标相关的误差模式不受观测器影响（因此它们的特征值分别保持为 $2$ 和 $-3$），\n- 并且 $A_{d} - L\\,C_{d}$ 保持为对角矩阵（误差动态中没有模式间的交叉耦合）。\n\n仅使用 Luenberger 观测器误差动态的基本定义和对角标准型的性质，确定满足这些要求的唯一矩阵 $L$。将你的最终答案表示为一个显式的 $4 \\times 2$ 矩阵。无需四舍五入。", "solution": "问题的核心是确定观测器增益矩阵 $L \\in \\mathbb{R}^{4 \\times 2}$，使得误差动态矩阵 $A_e = A_{d} - L\\,C_{d}$ 满足一系列指定标准。状态矩阵和输出矩阵由下式给出：\n$$ A_{d} = \\mathrm{diag}(-1, 2, 0, -3) = \\begin{pmatrix} -1  0  0  0 \\\\ 0  2  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  -3 \\end{pmatrix} $$\n$$ C_{d} = \\begin{pmatrix} 3  0  0  0 \\\\ 0  0  2  0 \\end{pmatrix} $$\n观测器增益矩阵 $L$ 是一个具有未知元素的 $4 \\times 2$ 矩阵：\n$$ L = \\begin{pmatrix} l_{11}  l_{12} \\\\ l_{21}  l_{22} \\\\ l_{31}  l_{32} \\\\ l_{41}  l_{42} \\end{pmatrix} $$\n误差动态由 $\\dot{\\mathbf{e}} = (A_{d} - L\\,C_{d})\\mathbf{e}$ 控制。我们首先计算乘积 $L\\,C_{d}$：\n$$ L\\,C_{d} = \\begin{pmatrix} l_{11}  l_{12} \\\\ l_{21}  l_{22} \\\\ l_{31}  l_{32} \\\\ l_{41}  l_{42} \\end{pmatrix} \\begin{pmatrix} 3  0  0  0 \\\\ 0  0  2  0 \\end{pmatrix} = \\begin{pmatrix} 3l_{11}  0  2l_{12}  0 \\\\ 3l_{21}  0  2l_{22}  0 \\\\ 3l_{31}  0  2l_{32}  0 \\\\ 3l_{41}  0  2l_{42}  0 \\end{pmatrix} $$\n现在，我们构造误差动态矩阵 $A_e = A_{d} - L\\,C_{d}$：\n$$ A_e = \\begin{pmatrix} -1  0  0  0 \\\\ 0  2  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  -3 \\end{pmatrix} - \\begin{pmatrix} 3l_{11}  0  2l_{12}  0 \\\\ 3l_{21}  0  2l_{22}  0 \\\\ 3l_{31}  0  2l_{32}  0 \\\\ 3l_{41}  0  2l_{42}  0 \\end{pmatrix} $$\n$$ A_e = \\begin{pmatrix} -1 - 3l_{11}  0  -2l_{12}  0 \\\\ -3l_{21}  2  -2l_{22}  0 \\\\ -3l_{31}  0  -2l_{32}  0 \\\\ -3l_{41}  0  -2l_{42}  -3 \\end{pmatrix} $$\n一个主要要求是 $A_e$ 必须是一个对角矩阵，这意味着其所有非对角元素都必须为零。这个条件对 $L$ 的元素施加了严格的约束。\n\\begin{itemize}\n    \\item 从元素 $(A_e)_{1,3}$ 可得：$-2l_{12} = 0 \\implies l_{12} = 0$。\n    \\item 从元素 $(A_e)_{2,1}$ 可得：$-3l_{21} = 0 \\implies l_{21} = 0$。\n    \\item 从元素 $(A_e)_{2,3}$ 可得：$-2l_{22} = 0 \\implies l_{22} = 0$。\n    \\item 从元素 $(A_e)_{3,1}$ 可得：$-3l_{31} = 0 \\implies l_{31} = 0$。\n    \\item 从元素 $(A_e)_{4,1}$ 可得：$-3l_{41} = 0 \\implies l_{41} = 0$。\n    \\item 从元素 $(A_e)_{4,3}$ 可得：$-2l_{42} = 0 \\implies l_{42} = 0$。\n\\end{itemize}\n这些约束迫使 $L$ 的结构为：\n$$ L = \\begin{pmatrix} l_{11}  0 \\\\ 0  0 \\\\ 0  l_{32} \\\\ 0  0 \\end{pmatrix} $$\n在 $L$ 的这种结构下，误差动态矩阵 $A_e$ 变为对角阵：\n$$ A_e = \\begin{pmatrix} -1 - 3l_{11}  0  0  0 \\\\ 0  2  0  0 \\\\ 0  0  -2l_{32}  0 \\\\ 0  0  0  -3 \\end{pmatrix} $$\n对角矩阵的特征值是其对角线上的元素。让我们将 $A_e$ 的特征值表示为 $\\lambda'_1, \\lambda'_2, \\lambda'_3, \\lambda'_4$。\n$$ \\lambda'_1 = -1 - 3l_{11} $$\n$$ \\lambda'_2 = 2 $$\n$$ \\lambda'_3 = -2l_{32} $$\n$$ \\lambda'_4 = -3 $$\n问题指定了可观测模式的特征值的期望位置。\n\\begin{enumerate}\n    \\item 对应于第一个状态坐标的特征值必须为 $-6$：\n    $$ \\lambda'_1 = -6 \\implies -1 - 3l_{11} = -6 $$\n    $$ -3l_{11} = -5 \\implies l_{11} = \\frac{5}{3} $$\n    \\item 对应于第三个状态坐标的特征值必须为 $-4$：\n    $$ \\lambda'_3 = -4 \\implies -2l_{32} = -4 $$\n    $$ l_{32} = 2 $$\n    \\item 对应于第二和第四个状态坐标的特征值必须保持不变。它们的原始值是 $2$ 和 $-3$。我们的对角矩阵 $A_e$ 有 $\\lambda'_2 = 2$ 和 $\\lambda'_4 = -3$，所以这个条件自动满足。这是第二和第四模式不可观测这一事实的直接结果，正如 $C_d$ 中对应这些状态的零列所示。不可观测模式的特征值不能通过观测器反馈来改变。\n\\end{enumerate}\n$L$ 中未知元素的值现在被唯一确定。我们组合出最终的矩阵 $L$：\n$$ L = \\begin{pmatrix} \\frac{5}{3}  0 \\\\ 0  0 \\\\ 0  2 \\\\ 0  0 \\end{pmatrix} $$\n该矩阵满足问题中列出的所有条件。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{5}{3}  0 \\\\\n0  0 \\\\\n0  2 \\\\\n0  0\n\\end{pmatrix}\n}\n$$", "id": "2700302"}]}