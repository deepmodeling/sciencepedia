{"hands_on_practices": [{"introduction": "在状态空间控制中，第一步通常是获得一个状态空间模型，而我们常常从一个外部描述（如传递函数）开始。这个练习将指导你完成从传递函数到状态空间实现的具体过程，特别是构建可控伴随形式。通过这个实践，你不仅能巩固传递函数系数与状态空间矩阵 $A, B, C, D$ 之间的联系，还能掌握通过可控性和可观测性来验证系统最小性的关键步骤，这是后续进行控制器设计或实现模型平衡的必要前提。[@problem_id:2724248]", "problem": "考虑一个单输入单输出传递函数 $G(s)$，其分母为首一多项式，分子为真多项式\n$$\nG(s) \\;=\\; \\frac{2 s^{3} + 3 s^{2} + 7 s + 5}{s^{3} + 4 s^{2} + 5 s + 2}.\n$$\n从传递函数的状态空间定义 $G(s) = D + C\\,(s I - A)^{-1} B$ 和可控伴随标准型的概念出发，该标准型将传递函数的分母系数置于状态矩阵的伴随矩阵表示中。仅使用这些基本思想，完成以下任务：\n- 通过显式地确定矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$，$B \\in \\mathbb{R}^{3 \\times 1}$，$C \\in \\mathbb{R}^{1 \\times 3}$ 和标量 $D \\in \\mathbb{R}$，构造 $G(s)$ 的一个可控伴随型实现。\n- 通过从基本原理出发验证可控性和可观性，来证明您所获得的实现是最小的，期间不援引任何未经证明的捷径。在最小性和稳定性确定后，简要说明为什么该系统原则上存在平衡实现。\n- 作为您最终报告的数值，计算行列式 $\\det(A)$，其结果为一个实数。\n\n仅报告 $\\det(A)$ 的值作为您的最终答案。无需四舍五入。", "solution": "问题给定一个单输入单输出 (SISO) 传递函数\n$$\nG(s) \\;=\\; \\frac{2 s^{3} + 3 s^{2} + 7 s + 5}{s^{3} + 4 s^{2} + 5 s + 2}\n$$\n以及状态空间模型定义 $G(s) = D + C(sI - A)^{-1}B$。问题要求构造一个可控伴随型实现，证明其最小性，论证平衡实现的存在性，并计算状态矩阵 $A$ 的行列式。该问题具有科学依据、提法恰当、客观，并包含足够的信息以获得唯一解。因此，我们认为该问题有效，并着手求解。\n\n分子和分母多项式的阶数相等，均为 $3$。这意味着该传递函数是真传递函数，但不是严格真传递函数。为了求得状态空间实现，我们必须首先通过多项式长除法将传递函数分解为一个常数项 $D$ 和一个严格真部分 $G_{sp}(s)$。\n$$\nG(s) = D + G_{sp}(s) = D + \\frac{N_r(s)}{P(s)}\n$$\n其中 $P(s) = s^{3} + 4 s^{2} + 5 s + 2$ 是分母多项式。常数 $D$ 是分子和分母首项系数之比。\n$$\nD = \\frac{2}{1} = 2\n$$\n余数多项式 $N_r(s)$ 通过从原分子中减去 $D \\cdot P(s)$ 得到。\n$$\nN_r(s) = (2 s^{3} + 3 s^{2} + 7 s + 5) - 2(s^{3} + 4 s^{2} + 5 s + 2)\n$$\n$$\nN_r(s) = (2 s^{3} + 3 s^{2} + 7 s + 5) - (2s^{3} + 8 s^{2} + 10 s + 4)\n$$\n$$\nN_r(s) = -5 s^{2} - 3 s + 1\n$$\n因此，该传递函数分解为：\n$$\nG(s) = 2 + \\frac{-5 s^{2} - 3 s + 1}{s^{3} + 4 s^{2} + 5 s + 2}\n$$\n现在，我们为严格真部分 $G_{sp}(s)$ 构造可控伴随型实现。令分母为 $P(s) = s^3 + a_2 s^2 + a_1 s + a_0$，严格真部分的分子为 $N_r(s) = b_2 s^2 + b_1 s + b_0$。通过比较，我们得到：\n$a_2 = 4$, $a_1 = 5$, $a_0 = 2$。\n$b_2 = -5$, $b_1 = -3$, $b_0 = 1$。\n\n对于一个三阶系统，其可控伴随型矩阵 $(A, B, C)$ 定义如下：\n$$\nA = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -a_0 & -a_1 & -a_2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} b_0 & b_1 & b_2 \\end{pmatrix}\n$$\n代入系数，我们得到该实现：\n$$\nA = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -2 & -5 & -4 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & -3 & -5 \\end{pmatrix}, \\quad D = 2\n$$\n\n接下来，我们验证该实现的最小性。一个实现是最小的，当且仅当它既是可控的又是可观的。\n\n为了验证可控性，我们构建可控性矩阵 $\\mathcal{C}$ 并检查其秩。\n$$\n\\mathcal{C} = \\begin{pmatrix} B & AB & A^2B \\end{pmatrix}\n$$\n我们计算各列：\n$B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$\n$AB = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -2 & -5 & -4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ -4 \\end{pmatrix}$\n$A^2B = A(AB) = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -2 & -5 & -4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ -4 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -4 \\\\ -5+16 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -4 \\\\ 11 \\end{pmatrix}$\n可控性矩阵为：\n$$\n\\mathcal{C} = \\begin{pmatrix} 0 & 0 & 1 \\\\ 0 & 1 & -4 \\\\ 1 & -4 & 11 \\end{pmatrix}\n$$\n其行列式为 $\\det(\\mathcal{C}) = 1 \\cdot (0 \\cdot (-4) - 1 \\cdot 1) = -1$。由于 $\\det(\\mathcal{C}) \\neq 0$，该矩阵满秩（秩为 $3$），因此系统是可控的。这是预料之中的，因为我们是在可控伴随范式中构建该实现的。\n\n为了验证可观性，我们构建可观性矩阵 $\\mathcal{O}$ 并检查其秩。\n$$\n\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\end{pmatrix}\n$$\n我们计算各行：\n$C = \\begin{pmatrix} 1 & -3 & -5 \\end{pmatrix}$\n$CA = \\begin{pmatrix} 1 & -3 & -5 \\end{pmatrix} \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -2 & -5 & -4 \\end{pmatrix} = \\begin{pmatrix} 10 & 1+25 & -3+20 \\end{pmatrix} = \\begin{pmatrix} 10 & 26 & 17 \\end{pmatrix}$\n$CA^2 = (CA)A = \\begin{pmatrix} 10 & 26 & 17 \\end{pmatrix} \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -2 & -5 & -4 \\end{pmatrix} = \\begin{pmatrix} -34 & 10-85 & 26-68 \\end{pmatrix} = \\begin{pmatrix} -34 & -75 & -42 \\end{pmatrix}$\n可观性矩阵为：\n$$\n\\mathcal{O} = \\begin{pmatrix} 1 & -3 & -5 \\\\ 10 & 26 & 17 \\\\ -34 & -75 & -42 \\end{pmatrix}\n$$\n其行列式为：\n$\\det(\\mathcal{O}) = 1(26(-42) - 17(-75)) - (-3)(10(-42) - 17(-34)) - 5(10(-75) - 26(-34))$\n$\\det(\\mathcal{O}) = 1(-1092 + 1275) + 3(-420 + 578) - 5(-750 + 884)$\n$\\det(\\mathcal{O}) = 1(183) + 3(158) - 5(134) = 183 + 474 - 670 = -13$。\n由于 $\\det(\\mathcal{O}) \\neq 0$，该矩阵满秩（秩为 $3$），因此系统是可观的。因为该实现既是可控的又是可观的，所以它是最小的。这意味着在原始传递函数 $G(s)$ 中没有极点-零点对消。\n\n对于任何既是最小的（可控且可观的）又是稳定的线性时不变系统，都存在一个平衡实现。我们已经确定了最小性。现在我们来检验稳定性。系统的极点是状态矩阵 $A$ 的特征值，也就是特征方程 $\\det(sI - A) = 0$ 的根。根据构造，这就是分母多项式 $P(s) = s^{3} + 4 s^{2} + 5 s + 2 = 0$。我们可以通过测试常数项 $2$ 的整数因子来找到其根。\n对于 $s=-1$：$(-1)^3 + 4(-1)^2 + 5(-1) + 2 = -1 + 4 - 5 + 2 = 0$。\n对于 $s=-2$：$(-2)^3 + 4(-2)^2 + 5(-2) + 2 = -8 + 16 - 10 + 2 = 0$。\n因式分解出 $(s+1)(s+2) = s^2+3s+2$，我们发现 $P(s) = (s^2+3s+2)(s+1) = (s+1)^2(s+2)$。\n特征值（极点）为 $\\lambda_1 = -1$（代数重数为 $2$）和 $\\lambda_2 = -2$。由于所有特征值的实部都严格为负，因此该系统是渐近稳定的。由于该系统是最小且稳定的，可控性和可观性格拉姆矩阵存在且为正定，并且可以找到一个平衡变换。因此，存在一个平衡实现。\n\n最后，我们计算状态矩阵 $A$ 的行列式。\n$$\nA = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -2 & -5 & -4 \\end{pmatrix}\n$$\n沿第一行进行代数余子式展开：\n$$\n\\det(A) = 0 \\cdot \\det\\begin{pmatrix} 0 & 1 \\\\ -5 & -4 \\end{pmatrix} - 1 \\cdot \\det\\begin{pmatrix} 0 & 1 \\\\ -2 & -4 \\end{pmatrix} + 0 \\cdot \\det\\begin{pmatrix} 0 & 0 \\\\ -2 & -5 \\end{pmatrix}\n$$\n$$\n\\det(A) = -1 \\cdot ((0)(-4) - (1)(-2)) = -1 \\cdot (0 - (-2)) = -1 \\cdot (2) = -2\n$$\n另外，这种形式的伴随矩阵的行列式由 $(-1)^{n-1}(-a_0)$ 给出，或者注意到 $\\det(A) = (-1)^n \\det(-A)$ 且 $\\det(-A) = (-1)^n \\cdot (\\text{在 } s=0 \\text{ 处求值的特征多项式})$。\n$\\det(sI-A) = s^3+4s^2+5s+2$。在 $s=0$ 时，$\\det(-A) = 2$。对于 $n=3$，$\\det(-A) = (-1)^3 \\det(A) = -\\det(A)$。所以，$-\\det(A) = 2$，即 $\\det(A) = -2$。结果一致。", "answer": "$$\n\\boxed{-2}\n$$", "id": "2724248"}, {"introduction": "在工程实践中，我们得到的许多状态空间模型可能并非最小实现。在进行系统分析或控制器设计之前，识别并处理模型中的冗余部分是至关重要的一步。这个练习将让你亲自动手分析一个给定的状态空间系统，以识别其非最小化的根源。通过显式计算不可达和不可观测子空间，你将具体地理解非最小性是如何体现在状态向量中的，这项技能是模型降阶和理解卡尔曼分解所描述的系统“内部几何”的基础。[@problem_id:2724291]", "problem": "考虑一个单输入单输出 (SISO) 线性时不变 (LTI) 状态空间系统\n$$\n\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t),\n$$\n其状态为 $x(t) \\in \\mathbb{R}^{4}$，输入为 $u(t) \\in \\mathbb{R}$，输出为 $y(t) \\in \\mathbb{R}$，其中\n$$\nA = \\begin{bmatrix}\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 0 & 0 \\\\\n0 & 0 & -1 & 1 \\\\\n0 & 0 & 0 & -2\n\\end{bmatrix}, \\quad\nB = \\begin{bmatrix}\n0 \\\\ 1 \\\\ 0 \\\\ 0\n\\end{bmatrix}, \\quad\nC = \\begin{bmatrix}\n1 & 0 & 0 & 0\n\\end{bmatrix}.\n$$\n利用状态空间系统的可控性与可观测性基本原理，通过显式计算可控性矩阵和可观测性矩阵的零空间，并从不可达性和不可观测性的角度对其进行解释，来检测系统的非最小性。\n\n任务：\n1. 根据 LTI 系统的可控子空间的定义，构建可控性矩阵\n$$\n\\mathcal{C} = \\begin{bmatrix} B & A B & A^{2} B & A^{3} B \\end{bmatrix},\n$$\n并计算 $\\mathcal{C}^{\\top}$ 的零空间。\n2. 根据 LTI 系统的不可观测子空间的定义，构建可观测性矩阵\n$$\n\\mathcal{O} = \\begin{bmatrix} C \\\\ C A \\\\ C A^{2} \\\\ C A^{3} \\end{bmatrix},\n$$\n并计算 $\\mathcal{O}$ 的零空间。\n3. 解释这些零空间如何揭示给定系统中的不可达性和不可观测性，并推断该系统是否为最小实现。通过移除不可达和不可观测的状态分量，确定最小实现的阶数 $n_{\\min}$。\n\n答案规格：\n- 您最终报告的答案必须是 $n_{\\min}$ 的单个整数值。\n- 无需四舍五入。\n- 最终报告的答案中不要包含任何单位。", "solution": "该问题陈述经核实具有科学依据，论述清晰，客观且完整。它是在线性系统理论中的一个标准练习。我们开始求解。\n\n该系统是一个阶数为 $n=4$ 的线性时不变 (LTI) 状态空间模型：\n$$\n\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t)\n$$\n矩阵如下\n$$\nA = \\begin{bmatrix}\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 0 & 0 \\\\\n0 & 0 & -1 & 1 \\\\\n0 & 0 & 0 & -2\n\\end{bmatrix}, \\quad\nB = \\begin{bmatrix}\n0 \\\\ 1 \\\\ 0 \\\\ 0\n\\end{bmatrix}, \\quad\nC = \\begin{bmatrix}\n1 & 0 & 0 & 0\n\\end{bmatrix}.\n$$\n一个系统实现是最小的，当且仅当它既是完全可控的又是完全可观测的。我们将依次评估这两个性质。\n\n首先，我们分析系统的可控性。可控子空间 $\\mathcal{S}_c$ 是从原点可达的状态所构成的子空间。它被定义为可控性矩阵 $\\mathcal{C}$ 的值域。问题要求我们构建该矩阵：\n$$\n\\mathcal{C} = \\begin{bmatrix} B & A B & A^{2} B & A^{3} B \\end{bmatrix}\n$$\n我们计算必要的矩阵乘积：\n$$\nB = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{bmatrix}\n$$\n$$\nAB = \\begin{bmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & -1 & 1 \\\\ 0 & 0 & 0 & -2 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}\n$$\n$$\nA^2B = A(AB) = \\begin{bmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & -1 & 1 \\\\ 0 & 0 & 0 & -2 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}\n$$\n由于 $A^2B$ 是零向量，因此所有更高次幂也为零：$A^3B = A(A^2B) = 0$。\n因此，可控性矩阵为：\n$$\n\\mathcal{C} = \\begin{bmatrix} 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{bmatrix}\n$$\n$\\mathcal{C}$ 的秩为 $\\text{rank}(\\mathcal{C}) = 2$。由于 $\\text{rank}(\\mathcal{C}) < n = 4$，该系统不是完全可控的。不可达的状态构成了不可达子空间 $\\mathcal{S}_{ur}$，它是可控子空间 $\\mathcal{S}_c = \\mathcal{R}(\\mathcal{C})$ 的正交补。不可达子空间等价于可控性矩阵转置的零空间，即 $\\mathcal{S}_{ur} = \\mathcal{N}(\\mathcal{C}^{\\top})$。我们计算这个零空间。\n$$\n\\mathcal{C}^{\\top} = \\begin{bmatrix} 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{bmatrix}\n$$\n我们寻找向量 $v = [v_1, v_2, v_3, v_4]^{\\top}$ 使得 $\\mathcal{C}^{\\top}v = 0$。这导出了方程组 $v_2 = 0$ 和 $v_1 = 0$。变量 $v_3$ 和 $v_4$ 是自由变量。因此，$\\mathcal{N}(\\mathcal{C}^{\\top})$ 中的任何向量都可以写成：\n$$\nv = v_3 \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{bmatrix} + v_4 \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix}\n$$\n$\\mathcal{C}^{\\top}$ 的零空间，即不可达子空间，由基向量 $\\{[0,0,1,0]^{\\top}, [0,0,0,1]^{\\top}\\}$ 张成。不可达子空间的维数为 2。这个子空间对应于状态向量的第三和第四个分量，它们不受输入 $u(t)$ 的影响。\n\n其次，我们分析系统的可观测性。不可观测子空间 $\\mathcal{S}_{uo}$ 是在零输入下，对于所有时间，产生零输出的初始状态的集合。它被定义为可观测性矩阵 $\\mathcal{O}$ 的零空间。\n$$\n\\mathcal{O} = \\begin{bmatrix} C \\\\ C A \\\\ C A^{2} \\\\ C A^{3} \\end{bmatrix}\n$$\n我们计算必要的矩阵乘积：\n$$\nC = \\begin{bmatrix} 1 & 0 & 0 & 0 \\end{bmatrix}\n$$\n$$\nCA = \\begin{bmatrix} 1 & 0 & 0 & 0 \\end{bmatrix} \\begin{bmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & -1 & 1 \\\\ 0 & 0 & 0 & -2 \\end{bmatrix} = \\begin{bmatrix} 0 & 1 & 0 & 0 \\end{bmatrix}\n$$\n$$\nCA^2 = (CA)A = \\begin{bmatrix} 0 & 1 & 0 & 0 \\end{bmatrix} \\begin{bmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & -1 & 1 \\\\ 0 & 0 & 0 & -2 \\end{bmatrix} = \\begin{bmatrix} 0 & 0 & 0 & 0 \\end{bmatrix}\n$$\n由于 $CA^2$ 是零向量，所以 $CA^3 = (CA^2)A = 0$。可观测性矩阵为：\n$$\n\\mathcal{O} = \\begin{bmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{bmatrix}\n$$\n$\\mathcal{O}$ 的秩为 $\\text{rank}(\\mathcal{O}) = 2$。由于 $\\text{rank}(\\mathcal{O}) < n = 4$，该系统不是完全可观测的。不可观测子空间 $\\mathcal{S}_{uo}$ 是 $\\mathcal{O}$ 的零空间。我们寻找向量 $x = [x_1, x_2, x_3, x_4]^{\\top}$ 使得 $\\mathcal{O}x = 0$。这导出了方程组 $x_1 = 0$ 和 $x_2 = 0$。变量 $x_3$ 和 $x_4$ 是自由变量。$\\mathcal{N}(\\mathcal{O})$ 中的任何向量都可以写成：\n$$\nx = x_3 \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{bmatrix} + x_4 \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix}\n$$\n$\\mathcal{O}$ 的零空间，即不可观测子空间，由基向量 $\\{[0,0,1,0]^{\\top}, [0,0,0,1]^{\\top}\\}$ 张成。不可观测子空间的维数为 2。这表明状态向量的第三和第四个分量对输出 $y(t)$ 没有影响。\n\n该系统既不可控也不可观测，因此该实现不是最小的。最小实现的阶数 $n_{\\min}$ 是既可控又可观测的状态子空间的维数。这由可控子空间 $\\mathcal{S}_c$ 和可观测子空间 $\\mathcal{S}_o$ 的交集的维数给出。\n根据我们的分析：\n可控子空间是 $\\mathcal{C}$ 的值域：$\\mathcal{S}_c = \\mathcal{R}(\\mathcal{C}) = \\text{span}\\{[0,1,0,0]^{\\top}, [1,0,0,0]^{\\top}\\} = \\text{span}\\{e_1, e_2\\}$。\n可观测子空间 $\\mathcal{S}_o$ 是不可观测子空间 $\\mathcal{S}_{uo}$ 的正交补。\n$\\mathcal{S}_{uo} = \\mathcal{N}(\\mathcal{O}) = \\text{span}\\{[0,0,1,0]^{\\top}, [0,0,0,1]^{\\top}\\} = \\text{span}\\{e_3, e_4\\}$。\n因此，$\\mathcal{S}_o = (\\mathcal{S}_{uo})^\\perp = (\\text{span}\\{e_3, e_4\\})^\\perp = \\text{span}\\{e_1, e_2\\}$。\n交集为 $\\mathcal{S}_{co} = \\mathcal{S}_c \\cap \\mathcal{S}_o = \\text{span}\\{e_1, e_2\\} \\cap \\text{span}\\{e_1, e_2\\} = \\text{span}\\{e_1, e_2\\}$。\n该子空间的维数为 $n_{\\min} = \\dim(\\mathcal{S}_{co}) = 2$。\n该系统的最小实现阶数为 2。这对应于与状态 $x_1$ 和 $x_2$ 相关的子系统 $(A_{11}, B_1, C_1)$，该子系统既可控又可观测。状态 $x_3$ 和 $x_4$ 的动态既不能被输入所达到，也不能被输出所观测。\n最小实现的阶数为 $n_{\\min} = 2$。", "answer": "$$\\boxed{2}$$", "id": "2724291"}, {"introduction": "在许多现实世界的应用中，我们无法直接得到系统的数学模型，但可以获取其输入-输出测量数据。那么，如何从这些实验数据中构建一个精确的状态空间模型呢？本练习将带你探索引领系统辨识领域的 Ho-Kalman 算法的核心思想。你将学习如何从系统的脉冲响应（即马尔可夫参数）构建一个块汉克尔矩阵，并理解该矩阵的秩如何揭示系统内部状态的最小维度（即麦克米兰阶），从而将抽象的实现理论与强大的数据驱动建模技术联系起来。[@problem_id:2724259]", "problem": "考虑一个离散时间线性时不变 (LTI) 单输入三输出的多输入多输出 (MIMO) 系统。其马尔可夫参数 (Markov parameter) 定义为 $h_{k} = C A^{k-1} B$ (对于 $k \\geq 1$)，其中 $A \\in \\mathbb{R}^{n \\times n}$，$B \\in \\mathbb{R}^{n \\times 1}$，$C \\in \\mathbb{R}^{3 \\times n}$，且直接馈通矩阵为 $D = 0$。假设马尔可夫参数 $h_{k} \\in \\mathbb{R}^{3 \\times 1}$ 由以下模态叠加隐式给出：\n$$\nh_{k} \\;=\\; \\sum_{i=1}^{3} \\lambda_{i}^{\\,k-1} \\, a_{i} \\, b_{i},\n$$\n其中，标量 $\\lambda_{1} = \\tfrac{1}{2}$、$\\lambda_{2} = -\\tfrac{1}{3}$、$\\lambda_{3} = \\tfrac{1}{4}$ 互不相同，非零输出方向向量为 $a_{1} = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}$、$a_{2} = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix}$、$a_{3} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$ (在 $\\mathbb{R}^{3}$ 中)，非零输入方向标量为 $b_{1} = 1$、$b_{2} = 2$、$b_{3} = 3$。对于固定的正整数 $f$ 和 $p$，与 Ho–Kalman (HK) 算法相关的块汉克尔矩阵 (block Hankel matrix) $H_{f,p}$ 定义为：\n$$\nH_{f,p}\n\\;=\\;\n\\begin{bmatrix}\nh_{1} & h_{2} & \\cdots & h_{p} \\\\\nh_{2} & h_{3} & \\cdots & h_{p+1} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\nh_{f} & h_{f+1} & \\cdots & h_{f+p-1}\n\\end{bmatrix}\n\\in \\mathbb{R}^{3 f \\times 1 \\cdot p}.\n$$\n\n任务：\n1. 使用上述定义和给定的 $h_{k}$，构建显式的 $9 \\times 3$ 块汉克尔矩阵 $H_{3,3}$。数值计算出 $h_{1}$ 到 $h_{5}$，并据此填充 $H_{3,3}$。\n2. 从能控性 (controllability) 和能观性 (observability) 的基本定义，以及 Ho–Kalman 分解 $H_{f,p} = O_{f} \\, C_{p}$（其中 $O_{f}$ 是块能观性矩阵，$C_{p}$ 是块能控性矩阵）出发，推导为什么对于最小实现 (minimal realization)，当 $f \\geq n$ 且 $p \\geq n$ 时，有 $\\operatorname{rank}(H_{f,p}) = n$，其中 $n$ 是麦克米兰阶数 (McMillan degree) 或称系统阶数。\n3. 对于给定的马尔可夫参数，展示 $H_{3,3}$ 为 $O_{3} C_{3}$ 的显式分解，证明 $O_{3}$ 和 $C_{3}$ 的内维秩 (inner-dimension rank) 均为 $3$，并由此计算 $\\operatorname{rank}(H_{3,3})$。\n4. 将推断出的最小系统阶数 $n$ 报告为单个整数。无需四舍五入，无需单位。你的最终答案必须是单个数字。\n\n你最终报告的答案必须仅为 $n$ 的值。", "solution": "此问题已经过验证，被认定为是适定的 (well-posed)、有科学依据的，并包含足够信息以得出唯一解。我们开始进行分析。\n\n该问题要求确定一个离散时间线性时不变系统的最小系统阶数，即麦克米兰阶数 (McMillan degree) $n$。该系统具有单个输入和三个输出。其动态特性由一系列马尔可夫参数 $h_k \\in \\mathbb{R}^{3 \\times 1}$（对于 $k \\ge 1$）来表征。直接馈通矩阵为 $D=0$。\n\n马尔可夫参数由以下模态叠加给出：\n$$\nh_{k} \\;=\\; \\sum_{i=1}^{3} \\lambda_{i}^{k-1} \\, a_{i} \\, b_{i}\n$$\n其中，标量 $\\lambda_1 = \\frac{1}{2}$、$\\lambda_2 = -\\frac{1}{3}$、$\\lambda_3 = \\frac{1}{4}$ 互不相同，输出方向向量为 $a_1 = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}$、$a_2 = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix}$、$a_3 = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$，输入方向标量为 $b_1 = 1$、$b_2 = 2$、$b_3 = 3$。\n\n这个 $h_k$ 的表达式可以写成向量形式：\n$$\nh_k = \\lambda_1^{k-1} b_1 a_1 + \\lambda_2^{k-1} b_2 a_2 + \\lambda_3^{k-1} b_3 a_3 = \\begin{pmatrix} 1 \\cdot (\\frac{1}{2})^{k-1} \\\\ 2 \\cdot (-\\frac{1}{3})^{k-1} \\\\ 3 \\cdot (\\frac{1}{4})^{k-1} \\end{pmatrix}\n$$\n\n**任务 1：构建块汉克尔矩阵 $H_{3,3}$**\n\n首先，我们计算所需的马尔可夫参数 $h_1$ 到 $h_5$：\n当 $k=1$ 时：$h_1 = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}$\n当 $k=2$ 时：$h_2 = \\begin{pmatrix} \\frac{1}{2} \\\\ 2(-\\frac{1}{3}) \\\\ 3(\\frac{1}{4}) \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{2}{3} \\\\ \\frac{3}{4} \\end{pmatrix}$\n当 $k=3$ 时：$h_3 = \\begin{pmatrix} (\\frac{1}{2})^2 \\\\ 2(-\\frac{1}{3})^2 \\\\ 3(\\frac{1}{4})^2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4} \\\\ \\frac{2}{9} \\\\ \\frac{3}{16} \\end{pmatrix}$\n当 $k=4$ 时：$h_4 = \\begin{pmatrix} (\\frac{1}{2})^3 \\\\ 2(-\\frac{1}{3})^3 \\\\ 3(\\frac{1}{4})^3 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{8} \\\\ -\\frac{2}{27} \\\\ \\frac{3}{64} \\end{pmatrix}$\n当 $k=5$ 时：$h_5 = \\begin{pmatrix} (\\frac{1}{2})^4 \\\\ 2(-\\frac{1}{3})^4 \\\\ 3(\\frac{1}{4})^4 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{16} \\\\ \\frac{2}{81} \\\\ \\frac{3}{256} \\end{pmatrix}$\n\n块汉克尔矩阵 $H_{3,3}$ 定义为：\n$$\nH_{3,3} = \\begin{bmatrix} h_1 & h_2 & h_3 \\\\ h_2 & h_3 & h_4 \\\\ h_3 & h_4 & h_5 \\end{bmatrix}\n$$\n代入计算出的值，得到 $9 \\times 3$ 的矩阵 $H_{3,3}$ 为：\n$$\nH_{3,3} = \\begin{pmatrix}\n1 & \\frac{1}{2} & \\frac{1}{4} \\\\\n2 & -\\frac{2}{3} & \\frac{2}{9} \\\\\n3 & \\frac{3}{4} & \\frac{3}{16} \\\\\n\\frac{1}{2} & \\frac{1}{4} & \\frac{1}{8} \\\\\n-\\frac{2}{3} & \\frac{2}{9} & -\\frac{2}{27} \\\\\n\\frac{3}{4} & \\frac{3}{16} & \\frac{3}{64} \\\\\n\\frac{1}{4} & \\frac{1}{8} & \\frac{1}{16} \\\\\n\\frac{2}{9} & -\\frac{2}{27} & \\frac{2}{81} \\\\\n\\frac{3}{16} & \\frac{3}{64} & \\frac{3}{256}\n\\end{pmatrix}\n$$\n\n**任务 2：汉克尔矩阵秩性质的推导**\n\n状态空间实现 $(A, B, C)$ 的马尔可夫参数为 $h_k = C A^{k-1} B$。块汉克尔矩阵 $H_{f,p}$ 可以分解为块能观性矩阵 $O_f$ 和块能控性矩阵 $C_p$ 的乘积。\n$$\nO_f = \\begin{bmatrix} C \\\\ CA \\\\ \\vdots \\\\ CA^{f-1} \\end{bmatrix} \\in \\mathbb{R}^{(3f) \\times n} \\quad , \\quad C_p = \\begin{bmatrix} B & AB & \\cdots & A^{p-1}B \\end{bmatrix} \\in \\mathbb{R}^{n \\times p}\n$$\n该分解为 $H_{f,p} = O_f C_p$：\n$$\nH_{f,p} = \\begin{bmatrix} C \\\\ CA \\\\ \\vdots \\\\ CA^{f-1} \\end{bmatrix} \\begin{bmatrix} B & AB & \\cdots & A^{p-1}B \\end{bmatrix} = \\begin{bmatrix} CB & CAB & \\cdots & CA^{p-1}B \\\\ CAB & CA^2B & \\cdots & CA^pB \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ CA^{f-1}B & CA^fB & \\cdots & CA^{f+p-2}B \\end{bmatrix}\n$$\n一个实现是最小的，当且仅当它既是能控的又是能观的。对于一个 $n$ 阶系统，这意味着能控性矩阵 $C_n$ 和能观性矩阵 $O_n$ 都是满秩的：$\\operatorname{rank}(C_n) = n$ 且 $\\operatorname{rank}(O_n) = n$。根据 Cayley-Hamilton 定理，$A$ 的任何高于 $n-1$ 次的幂都是其低次幂的线性组合。这意味着如果 $\\operatorname{rank}(C_n)=n$，那么对于所有 $p \\ge n$，都有 $\\operatorname{rank}(C_p)=n$。类似地，如果 $\\operatorname{rank}(O_n)=n$，那么对于所有 $f \\ge n$，都有 $\\operatorname{rank}(O_f)=n$。\n\n对于一个 $n$ 阶的最小实现，当选择 $f \\ge n$ 和 $p \\ge n$ 时，我们有 $\\operatorname{rank}(O_f) = n$ 和 $\\operatorname{rank}(C_p) = n$。乘积 $H_{f,p} = O_f C_p$ 的秩有上界 $\\operatorname{rank}(H_{f,p}) \\le \\min(\\operatorname{rank}(O_f), \\operatorname{rank}(C_p)) = \\min(n, n) = n$。\n根据西尔维斯特秩不等式 (Sylvester's rank inequality)，$\\operatorname{rank}(O_f) + \\operatorname{rank}(C_p) - n \\le \\operatorname{rank}(O_f C_p)$。\n代入秩，我们得到 $n + n - n \\le \\operatorname{rank}(H_{f,p})$，化简为 $n \\le \\operatorname{rank}(H_{f,p})$。\n结合两个不等式，$n \\le \\operatorname{rank}(H_{f,p}) \\le n$，可以确定 $\\operatorname{rank}(H_{f,p}) = n$。因此，对于足够大的 $f$ 和 $p$，麦克米兰阶数 $n$ 等于汉克尔矩阵的秩。\n\n**任务 3：$H_{3,3}$ 的分解与秩的计算**\n\n给定的 $h_k$ 的模态形式表明存在一个 $n=3$ 阶的对角化实现 $(A,B,C)$。我们可以构建这样一个实现并验证其最小性。令 $n=3$ 并定义：\n$$\nA = \\begin{pmatrix} \\lambda_1 & 0 & 0 \\\\ 0 & \\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & -\\frac{1}{3} & 0 \\\\ 0 & 0 & \\frac{1}{4} \\end{pmatrix}\n$$\n$$\nB = \\begin{pmatrix} b_1 \\\\ b_2 \\\\ b_3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\n$$\nC = \\begin{bmatrix} a_1 & a_2 & a_3 \\end{bmatrix} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = I_3\n$$\n这个实现 $(A,B,C)$ 生成了给定的马尔可夫参数，因为 $C A^{k-1} B = I_3 A^{k-1} B = \\sum_{i=1}^3 \\lambda_i^{k-1} b_i e_i = \\sum_{i=1}^3 \\lambda_i^{k-1} b_i a_i = h_k$，其中 $e_i$ 是标准基向量，等同于给定的 $a_i$。\n\n这个实现是最小的。对于一个具有不同特征值 $\\lambda_i$ 的对角系统，其能控的充要条件是 $B$ 的所有分量都非零。这里 $B = [1, 2, 3]^T$，所以系统是能控的。其能观的充要条件是 $C$ 的所有列都非零。这里 $C=I_3$，所以系统是能观的。由于该实现是能控且能观的，所以它是最小的，其阶数 $n=3$ 是系统的麦克米兰阶数。\n\n利用这个最小实现，我们构建 $O_3$ 和 $C_3$：\n$$\nO_3 = \\begin{bmatrix} C \\\\ CA \\\\ CA^2 \\end{bmatrix} = \\begin{bmatrix} I_3 \\\\ A \\\\ A^2 \\end{bmatrix} = \\begin{pmatrix}\n1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\\n\\frac{1}{2} & 0 & 0 \\\\\n0 & -\\frac{1}{3} & 0 \\\\\n0 & 0 & \\frac{1}{4} \\\\\n\\frac{1}{4} & 0 & 0 \\\\\n0 & \\frac{1}{9} & 0 \\\\\n0 & 0 & \\frac{1}{16}\n\\end{pmatrix}\n$$\n这是一个 $9 \\times 3$ 的矩阵。前三行构成一个单位矩阵，这保证了其三列是线性无关的。因此，$\\operatorname{rank}(O_3) = 3$。\n\n$$\nC_3 = \\begin{bmatrix} B & AB & A^2B \\end{bmatrix} = \\begin{pmatrix} 1 & \\frac{1}{2} & \\frac{1}{4} \\\\ 2 & -\\frac{2}{3} & \\frac{2}{9} \\\\ 3 & \\frac{3}{4} & \\frac{3}{16} \\end{pmatrix}\n$$\n这是一个 $3 \\times 3$ 的矩阵。其行列式为：\n$$\n\\det(C_3) = \\det\\begin{pmatrix} b_1 & \\lambda_1 b_1 & \\lambda_1^2 b_1 \\\\ b_2 & \\lambda_2 b_2 & \\lambda_2^2 b_2 \\\\ b_3 & \\lambda_3 b_3 & \\lambda_3^2 b_3 \\end{pmatrix} = b_1 b_2 b_3 \\det\\begin{pmatrix} 1 & \\lambda_1 & \\lambda_1^2 \\\\ 1 & \\lambda_2 & \\lambda_2^2 \\\\ 1 & \\lambda_3 & \\lambda_3^2 \\end{pmatrix}\n$$\n该行列式是 $b_1 b_2 b_3$ 与一个范德蒙行列式 (Vandermonde determinant) 的乘积。由于 $b_i \\neq 0$ 且 $\\lambda_i$ 互不相同，该行列式非零。\n$\\det(C_3) = (1 \\cdot 2 \\cdot 3) \\cdot ( (-\\frac{1}{3}) - \\frac{1}{2} ) \\cdot ( \\frac{1}{4} - \\frac{1}{2} ) \\cdot ( \\frac{1}{4} - (-\\frac{1}{3}) ) = 6 \\cdot (-\\frac{5}{6}) \\cdot (-\\frac{1}{4}) \\cdot (\\frac{7}{12}) = \\frac{35}{24} \\neq 0$。\n因此，$C_3$ 是满秩的，$\\operatorname{rank}(C_3) = 3$。\n\n分解 $H_{3,3} = O_3 C_3$ 成立，并且既然我们已经证明了 $\\operatorname{rank}(O_3)=3$ 和 $\\operatorname{rank}(C_3)=3$，根据西尔维斯特不等式，我们得出结论 $\\operatorname{rank}(H_{3,3})=3$。\n\n**任务 4：推断的最小系统阶数 $n$**\n\nHo-Kalman 算法指出，最小系统阶数 $n$ 等于块汉克尔矩阵的秩，前提是 $f$ 和 $p$ 足够大（即 $f \\ge n$ 和 $p \\ge n$）。\n我们已经计算出 $\\operatorname{rank}(H_{3,3}) = 3$。这意味着最小阶数为 $n=3$。这与我们选择的 $f=3$ 和 $p=3$ 相符。\n\n最小系统阶数为 $n=3$。", "answer": "$$\n\\boxed{3}\n$$", "id": "2724259"}]}