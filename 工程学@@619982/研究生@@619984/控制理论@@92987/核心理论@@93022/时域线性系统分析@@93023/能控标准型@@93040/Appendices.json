{"hands_on_practices": [{"introduction": "从传递函数到状态空间表示的转换为控制理论中的一项基本技能。本练习将引导我们从第一性原理出发，探讨为何标准的可控规范型要求传递函数的分母为首一多项式。通过这个过程，我们将揭示传递函数的系数与状态空间矩阵元素之间的直接且深刻的联系，从而不仅仅是记忆公式，而是真正理解其构造的内在逻辑。[@problem_id:2697146]", "problem": "考虑一个单输入单输出线性时不变系统，其传递函数为 $G(s)$。一个标准的能控标准型实现使用一个友矩阵 $A$（其特征多项式是首一的），一个等于最后一个标准基向量的输入矩阵 $B$，以及一个为匹配传递函数而选择的输出矩阵 $C$。从状态空间到传递函数的关系式 $G(s)=C\\,(sI-A)^{-1}B+D$ 出发，且不依赖任何标准型公式，从第一性原理出发论证为何在构建标准能控标准型之前，必须将 $G(s)$ 的分母归一化为首一多项式。然后，推导当 $D=0$ 且分子多项式按 $s$ 的升幂排列时，这种归一化如何影响输出矩阵 $C$ 的元素。\n\n完成推导后，将其应用于具体的传递函数\n$$G(s)=\\frac{4+10\\,s+12\\,s^{2}}{6\\,s^{3}+7\\,s^{2}+11\\,s+5},$$\n将分子解释为 $4+10\\,s+12\\,s^{2}$ (升幂排列)。在将分母归一化为首一多项式后，构建 $D=0$ 时的标准能控标准型，并报告输出矩阵 $C$ 的最后一个元素的值。你的最终答案必须是一个实数。不要四舍五入。", "solution": "该问题要求从第一性原理推导在构建标准能控标准型时分母多项式必须为首一的必要性，分析这种归一化如何影响输出矩阵 $C$，以及将其应用于一个具体的传递函数。\n\n首先，我们必须验证问题陈述的有效性。\n\n**步骤1：提取已知条件**\n- 系统：单输入单输出 (SISO) 线性时不变 (LTI) 系统。\n- 传递函数：$G(s)$。\n- 标准能控标准型 (CCF)：\n  - 状态矩阵 $A$ 是一个友矩阵。\n  - $A$ 的特征多项式是首一的。\n  - 输入矩阵 $B$ 是最后一个标准基向量，即 $B = [0, 0, \\dots, 1]^T$。\n  - 输出矩阵 $C$ 为匹配传递函数而选择。\n- 状态空间到传递函数的关系式：$G(s) = C(sI-A)^{-1}B+D$。\n- 推导条件：从第一性原理出发论证，不使用公式。\n- 分析条件：假设 $D=0$ 且分子多项式按 $s$ 的升幂排列。\n- 应用的具体传递函数：$G(s)=\\frac{4+10\\,s+12\\,s^{2}}{6\\,s^{3}+7\\,s^{2}+11\\,s+5}$。\n- 具体要求：对于给定的 $G(s)$，在归一化后，$D=0$ 的情况下，求输出矩阵 $C$ 的最后一个元素。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，是线性控制理论中的一个基本课题。问题提法清晰，提供了所有必要信息和明确的目标。传递函数是一个有效的有理函数，标准型的结构有明确定义。没有矛盾、歧义或事实错误。该问题要求进行概念性推导，而不仅仅是公式的死记硬背，因此是一个有深度的问题。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。我们开始求解。\n\n一个线性时不变系统的传递函数由其状态空间表示 $(\\boldsymbol{A}, \\boldsymbol{B}, \\boldsymbol{C}, D)$ 通过以下关系导出：\n$$ G(s) = C(sI-A)^{-1}B + D $$\n使用矩阵求逆的恒等式 $(sI-A)^{-1} = \\frac{\\text{adj}(sI-A)}{\\det(sI-A)}$，传递函数变为：\n$$ G(s) = \\frac{C \\, \\text{adj}(sI-A) \\, B}{\\det(sI-A)} + D $$\n传递函数分数部分的分母是 $\\det(sI-A)$，根据定义，它就是状态矩阵 $A$ 的特征多项式。\n\n一个 $n$ 阶系统的标准能控标准型对矩阵 $A$ 和 $B$ 使用特定的结构。状态矩阵 $A$ 是与分母多项式（我们称之为 $P_{den}(s)$）相关联的所谓的友矩阵。如果该多项式写作 $P_{den}(s) = s^n + a_{n-1}s^{n-1} + \\dots + a_1 s + a_0$，那么友矩阵 $A$ 定义为：\n$$ A = \\begin{pmatrix} 0 & 1 & 0 & \\dots & 0 \\\\ 0 & 0 & 1 & \\dots & 0 \\\\ \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & 0 & 0 & \\dots & 1 \\\\ -a_0 & -a_1 & -a_2 & \\dots & -a_{n-1} \\end{pmatrix} $$\n这个特定矩阵 $A$ 的特征多项式可以计算为 $\\det(sI-A)$，结果恰好是 $s^n + a_{n-1}s^{n-1} + \\dots + a_0$。根据其结构，在代数余子式展开中，最高次项 $s^n$ 是由 $(sI-A)$ 对角线元素的乘积产生的，因此该多项式是*首一的*（其首项系数为 1）。\n因此，如果要使用这种标准的友矩阵结构 $A$ 来实现一个给定的传递函数 $G(s)$，那么 $G(s)$ 的分母必须与 $A$ 的特征多项式相匹配。由于友矩阵 $A$ 的特征多项式本身就是首一的，所以传递函数的分母也必须是首一的。如果一个给定的传递函数的分母不是首一的，那么在识别系数 $a_i$ 并将其放入矩阵 $A$ 之前，必须将分子和分母同时除以分母的首项系数来进行归一化。这便完成了第一部分的论证。\n\n接下来，我们推导在 $D=0$ 且分子按 $s$ 的升幂表示时，这种归一化对输出矩阵 $C$ 的影响。输入矩阵被指定为 $B = [0, 0, \\dots, 1]^T$。我们来分析 $(sI-A)^{-1}B$ 这一项。这对应于矩阵 $(sI-A)^{-1}$ 的最后一列。可以证明，对于上面定义的友矩阵 $A$，以下关系成立：\n$$ (sI-A)^{-1} B = (sI-A)^{-1} \\begin{pmatrix} 0 \\\\ \\vdots \\\\ 0 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\det(sI-A)} \\begin{pmatrix} 1 \\\\ s \\\\ s^2 \\\\ \\vdots \\\\ s^{n-1} \\end{pmatrix} $$\n将此代入传递函数公式，其中 $C = [c_0, c_1, \\dots, c_{n-1}]$ 且 $P_{den}(s) = \\det(sI-A)$，我们得到：\n$$ G(s) = C(sI-A)^{-1}B = [c_0, c_1, \\dots, c_{n-1}] \\frac{1}{P_{den}(s)} \\begin{pmatrix} 1 \\\\ s \\\\ s^2 \\\\ \\vdots \\\\ s^{n-1} \\end{pmatrix} = \\frac{c_0 + c_1 s + c_2 s^2 + \\dots + c_{n-1}s^{n-1}}{P_{den}(s)} $$\n这个结果至关重要：对于一个处于标准能控标准型的系统，假定其分母已经是首一的，那么输出矩阵 $C$ 的元素恰好是分子多项式按 $s$ 的*升幂*排列时的系数。\n\n如果我们从一个一般的传递函数 $G_{given}(s) = \\frac{N_{orig}(s)}{P_{orig}(s)}$ 开始，其中 $P_{orig}(s) = p_n s^n + p_{n-1}s^{n-1} + \\dots + p_0$ 且 $N_{orig}(s) = \\beta_0 + \\beta_1 s + \\dots + \\beta_{n-1}s^{n-1}$，我们必须通过除以 $p_n$ 来对其进行归一化：\n$$ G(s) = \\frac{N_{orig}(s) / p_n}{P_{orig}(s) / p_n} = \\frac{(\\beta_0/p_n) + (\\beta_1/p_n)s + \\dots}{s^n + (p_{n-1}/p_n)s^{n-1} + \\dots} $$\n通过将其与推导出的 $G(s)$ 形式进行比较，我们发现输出矩阵 $C$ 的系数由 $c_i = \\beta_i / p_n$ 给出。因此，将分母按因子 $p_n$ 进行归一化，也要求将原始的分子系数除以相同的因子 $p_n$，以找到 $C$ 矩阵的正确元素。\n\n最后，我们将此过程应用于给定的传递函数：\n$$ G(s)=\\frac{4+10\\,s+12\\,s^{2}}{6\\,s^{3}+7\\,s^{2}+11\\,s+5} $$\n分母是 $P_{orig}(s) = 6s^3+7s^2+11s+5$。首项系数是 $p_3 = 6$。分子是 $N_{orig}(s) = 4+10s+12s^2$。按 $s$ 的升幂排列的系数是 $\\beta_0 = 4$, $\\beta_1 = 10$, 和 $\\beta_2 = 12$。系统的阶数是 $n=3$。\n\n我们通过将分子和分母都除以 $p_3=6$ 来归一化传递函数：\n$$ G(s) = \\frac{\\frac{4}{6}+\\frac{10}{6}s+\\frac{12}{6}s^{2}}{\\frac{6}{6}s^{3}+\\frac{7}{6}s^{2}+\\frac{11}{6}s+\\frac{5}{6}} = \\frac{\\frac{2}{3}+\\frac{5}{3}s+2s^{2}}{s^{3}+\\frac{7}{6}s^{2}+\\frac{11}{6}s+\\frac{5}{6}} $$\n归一化后的系统有一个首一分母 $P_{den}(s)=s^{3}+\\frac{7}{6}s^{2}+\\frac{11}{6}s+\\frac{5}{6}$ 和一个分子 $N_{num}(s) = \\frac{2}{3}+\\frac{5}{3}s+2s^{2}$。\n用于 $A$ 矩阵的分母系数是 $a_0 = 5/6$, $a_1 = 11/6$, 和 $a_2 = 7/6$。\n用于 $C$ 矩阵的分子系数是 $N_{num}(s)$ 按 $s$ 的升幂排列的系数。对于这个 $n=3$ 的系统，我们有 $C=[c_0, c_1, c_2]$。\n从 $N_{num}(s)$，我们确定：\n$c_0 = 2/3$\n$c_1 = 5/3$\n$c_2 = 2$\n所以，输出矩阵是 $C = \\begin{pmatrix} \\frac{2}{3} & \\frac{5}{3} & 2 \\end{pmatrix}$。\n问题要求输出矩阵 $C$ 的最后一个元素，即 $c_2$。\n\n$C$ 的最后一个元素是 $2$。", "answer": "$$\\boxed{2}$$", "id": "2697146"}, {"introduction": "物理系统的状态空间模型通常源自其自然坐标（例如位置、速度、电流），这些坐标很少直接对应于数学上的规范型结构。本练习解决了一个核心问题：如何将一个任意（但可控）的状态空间模型系统地转换为可控规范型。我们将通过构建可控性矩阵并将其用作相似变换的基础，来推导从物理模型到抽象规范形式的精确路径。[@problem_id:2697134]", "problem": "考虑一个单输入单输出 (SISO) 线性时不变机械-机电模型，该模型由一个通过齿轮齿条机构由直流电机驱动的单位质量小车组成，且带有粘性阻尼。物理状态变量为小车位置 $x$、电机电枢电流 $i$ 和小车速度 $v$。设输入电压为 $u$，选择状态向量的朴素排序为 $s = [\\,x,\\ i,\\ v\\,]^{\\top}$（而非通常使用的相位变量排序）。当参数值为 $m = 1$、粘性系数 $b = 2$、反电动势常数 $k_{e} = 1$、转矩常数 $k_{t} = 1$、电枢电感 $L = 1$ 和电枢电阻 $R = 1$时，此朴素排序下的线性化状态空间模型为\n$$\n\\dot{s} = A s + b\\, u,\\quad \nA = \\begin{pmatrix}\n0 & 0 & 1\\\\\n0 & -1 & -1\\\\\n0 & 1 & -2\n\\end{pmatrix},\\quad\nb = \\begin{pmatrix}\n0\\\\\n1\\\\\n0\n\\end{pmatrix}.\n$$\n此矩阵 $A$ 在任何坐标的平凡置换下都不是友矩阵（可控标准型）形式，因为执行器状态 $i$ 被插入到了 $x$ 和 $v$ 之间。\n\n仅使用线性系统和可控性的基本定义，完成以下任务：\n- 证明系统对 $(A,b)$ 是可控的。\n- 构造一个精确的相似变换 $T$，将 $(A,b)$ 映射到可控标准型，其中输入向量为 $\\bar{b} = e_{1}$，系统矩阵 $\\bar{A}$ 的次对角线上元素为1（即，可控 Frobenius 友矩阵形式）。\n- 你的构造必须从第一性原理出发：可控性的定义、可控性子空间和基变换。不要假定任何预先记下的 $T$ 的公式；需通过从定义出发进行推理来推导它。\n- 最后，计算 $\\det(T)$ 的精确值。\n\n答案格式要求：提供单个实数 $\\det(T)$ 作为最终答案。无需四舍五入。", "solution": "我们从基本定义开始。对于一个 $n$ 维的 SISO 系统对 $(A,b)$，其可控性矩阵定义为\n$$\n\\mathcal{C} \\equiv \\begin{pmatrix} b & A b & \\cdots & A^{n-1} b \\end{pmatrix}.\n$$\n系统对 $(A,b)$ 是可控的，当且仅当 $\\mathop{\\mathrm{rank}}(\\mathcal{C}) = n$。此外，当 $(A,b)$ 可控时，有序集 $\\{b, A b, \\ldots, A^{n-1} b\\}$ 是 $\\mathbb{R}^{n}$ 的一个基。在此基下表示 $A$ 会得到一个矩阵，其次对角线上元素为1，最后一列由 $A^{n} b$ 在该基下的唯一坐标确定。当单输入单输出 (SISO) 系统对是可控的（可控性指数等于 $n$）时，这就是可控 Frobenius 友矩阵形式，并且相关的相似变换可以取为基变换矩阵，其列向量为该基的向量。\n\n步骤1：计算可控性矩阵并验证可控性。\n我们依次计算：\n$$\nb = \\begin{pmatrix} 0\\\\ 1\\\\ 0 \\end{pmatrix},\\quad\nA b = A \\begin{pmatrix} 0\\\\ 1\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0\\\\ -1\\\\ 1 \\end{pmatrix}.\n$$\n接下来，\n$$\nA^{2} b = A (A b) = A \\begin{pmatrix} 0\\\\ -1\\\\ 1 \\end{pmatrix}\n= -\\,\\text{col}_{2}(A) + \\text{col}_{3}(A)\n= - \\begin{pmatrix} 0\\\\ -1\\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 1\\\\ -1\\\\ -2 \\end{pmatrix}\n= \\begin{pmatrix} 1\\\\ 0\\\\ -3 \\end{pmatrix}.\n$$\n因此，可控性矩阵为\n$$\n\\mathcal{C} = \\begin{pmatrix} b & A b & A^{2} b \\end{pmatrix}\n= \\begin{pmatrix}\n0 & 0 & 1\\\\\n1 & -1 & 0\\\\\n0 & 1 & -3\n\\end{pmatrix}.\n$$\n计算其行列式：\n$$\n\\det(\\mathcal{C}) = \n\\begin{vmatrix}\n0 & 0 & 1\\\\\n1 & -1 & 0\\\\\n0 & 1 & -3\n\\end{vmatrix}\n= 0 \\cdot \\begin{vmatrix} -1 & 0\\\\ 1 & -3 \\end{vmatrix}\n- 0 \\cdot \\begin{vmatrix} 1 & 0\\\\ 0 & -3 \\end{vmatrix}\n+ 1 \\cdot \\begin{vmatrix} 1 & -1\\\\ 0 & 1 \\end{vmatrix}\n= 1.\n$$\n因此 $\\mathop{\\mathrm{rank}}(\\mathcal{C}) = 3$，系统对 $(A,b)$ 是可控的。\n\n步骤2：从第一性原理构造相似变换 $T$。\n因为 $\\{b, A b, A^{2} b\\}$ 是一个基，所以将该有序基作为新的可控性基。令 $T$ 的列为这些基向量：\n$$\nT \\equiv \\mathcal{C} = \\begin{pmatrix}\n0 & 0 & 1\\\\\n1 & -1 & 0\\\\\n0 & 1 & -3\n\\end{pmatrix}.\n$$\n通过 $s = T z$ 定义新坐标 $z$，即 $z = T^{-1} s$。在此基下，线性映射 $A$ 的矩阵为 $A_{c} = T^{-1} A T$，其列是 $A$ 作用在基向量上的坐标。使用 $v_{1} = b$、$v_{2} = A b$、$v_{3} = A^{2} b$，我们有\n- $A v_{1} = v_{2}$，所以 $A_{c}$ 的第一列是 $e_{2}$。\n- $A v_{2} = v_{3}$，所以 $A_{c}$ 的第二列是 $e_{3}$。\n- $A v_{3} = A^{3} b$ 必须用基 $\\{v_{1}, v_{2}, v_{3}\\}$ 来表示。\n\n为了从基本原理出发在该基中找到 $A^{3} b$，我们使用关于 $A$ 的凯莱-哈密顿定理。首先计算 $A$ 的特征多项式：\n$$\np(\\lambda) = \\det(\\lambda I - A) \n= \\det \\begin{pmatrix}\n\\lambda & 0 & -1\\\\\n0 & \\lambda + 1 & 1\\\\\n0 & -1 & \\lambda + 2\n\\end{pmatrix}\n= \\lambda \\big((\\lambda + 1)(\\lambda + 2) + 1\\big) \n= \\lambda \\left(\\lambda^{2} + 3 \\lambda + 3\\right)\n= \\lambda^{3} + 3 \\lambda^{2} + 3 \\lambda.\n$$\n根据凯莱-哈密顿定理，$A^{3} + 3 A^{2} + 3 A = 0$，因此\n$$\nA^{3} b = -\\,3 A^{2} b - 3 A b.\n$$\n在关于基 $\\{v_{1}, v_{2}, v_{3}\\} = \\{b, A b, A^{2} b\\}$ 的坐标下，这可以写作\n$$\nA v_{3} = -\\,3 v_{2} - 3 v_{3} + 0 \\cdot v_{1},\n$$\n所以 $A_{c}$ 的第三列是 $\\begin{pmatrix} 0\\\\ -3\\\\ -3 \\end{pmatrix}$。因此，\n$$\nA_{c} = T^{-1} A T\n= \\begin{pmatrix}\n0 & 0 & 0\\\\\n1 & 0 & -3\\\\\n0 & 1 & -3\n\\end{pmatrix},\n\\quad\nb_{c} = T^{-1} b = e_{1},\n$$\n这正是可控 Frobenius 友矩阵形式，其次对角线上元素为1，最后一列由 $p(\\lambda)$ 系数的负值给出，即 $\\big(-a_{0}, -a_{1}, -a_{2}\\big)^{\\top} = \\big(0, -3, -3\\big)^{\\top}$。\n\n因此，精确的相似变换是 $T = \\mathcal{C}$。\n\n步骤3：计算 $\\det(T)$。\n根据步骤1中的计算，$\\det(T) = \\det(\\mathcal{C}) = 1$。\n\n因此，$\\det(T)$ 的精确值为 $1$。", "answer": "$$\\boxed{1}$$", "id": "2697134"}, {"introduction": "从理论构建走向实际应用时，数值稳定性成为一个至关重要的问题。虽然将系统转换为可控规范型的相似变换在理论上是精确的，但其在计算机上的实现可能非常脆弱。本练习探讨了作为数值鲁棒性度量的“条件数”这一概念，并通过一个具体的编码任务，量化了一种强大的预处理技术——列平衡——在改善变换矩阵条件数方面的显著效果。[@problem_id:2697100]", "problem": "考虑一个单输入线性时不变（LTI）状态空间系统，其状态矩阵为 $A \\in \\mathbb{R}^{n \\times n}$，输入向量为 $b \\in \\mathbb{R}^{n}$。能控性矩阵定义为 $C(A,b) = [\\,b,\\,Ab,\\,A^{2}b,\\,\\dots,\\,A^{n-1}b\\,]$。一个将系统映射到能控性基的标准相似性变换使用 $C(A,b)$ 的列作为基，即，变换矩阵 $T \\in \\mathbb{R}^{n \\times n}$ 取为 $T_{\\mathrm{raw}} = C(A,b)$（假设 $\\operatorname{rank} C(A,b) = n$）。在此能控性基下，变换后的状态矩阵 $A_{c} = T_{\\mathrm{raw}}^{-1} A T_{\\mathrm{raw}}$ 呈现能控伴随形式。\n\n在构建变换之前，定义一个列平衡（也称为列缩放）步骤，即构建一个对角矩阵 $D \\in \\mathbb{R}^{n \\times n}$，其对角线元素等于 $T_{\\mathrm{raw}}$ 各列的欧几里得范数，也就是说，如果 $T_{\\mathrm{raw}} = [\\,c_{1},\\dots,c_{n}\\,]$ 且 $c_{k} \\in \\mathbb{R}^{n}$，则 $D = \\operatorname{diag}(\\,\\lVert c_{1} \\rVert_{2},\\dots,\\lVert c_{n} \\rVert_{2}\\,)$。令平衡后的变换为 $T_{\\mathrm{bal}} = T_{\\mathrm{raw}} D^{-1}$。$T_{\\mathrm{raw}}$ 和 $T_{\\mathrm{bal}}$ 都是生成能控性基的容许相似性变换；它们的不同之处在于基向量的对角重缩放。\n\n你的任务是：\n\n1) 仅从能控性、相似性变换和诱导算子范数的基本定义出发，解释为什么变换矩阵 $T$ 的条件数对坐标变换的数值鲁棒性至关重要，并解释为何通过右乘一个使列范数均衡的对角矩阵是降低谱范数下的条件数 $\\kappa_{2}(T)$ 的一种有原则的尝试。除此处给定的结构外，不要假设任何特殊结构。\n\n2) 考虑由正实数参数 $\\alpha \\in \\mathbb{R}_{>0}$ 和整数 $n \\in \\mathbb{N}$ 索引的参数化族，其中\n$$\nA(\\alpha) = \\operatorname{diag}\\big(1,\\alpha,\\alpha^{2},\\dots,\\alpha^{n-1}\\big),\\quad b(\\alpha) = \\mathbf{1}_{n}.\n$$\n证明对于 $\\alpha \\neq 1$，系统对 $(A(\\alpha), b(\\alpha))$ 是能控的，通过证明能控性矩阵 $C\\big(A(\\alpha), b(\\alpha)\\big)$ 是非奇异的。明确写出 $C\\big(A(\\alpha), b(\\alpha)\\big)$ 的元素表达式，并使用范德蒙行列式论证其可逆性。\n\n3) 对于第 2 部分中的族，推导 $C\\big(A(\\alpha), b(\\alpha)\\big)$ 第 $k$ 列的欧几里得范数平方的闭式表达式，该表达式是关于 $\\alpha$、$n$ 和 $k \\in \\{1,\\dots,n\\}$ 的函数。证明当 $\\alpha > 1$ 时，该范数随 $k$ 和 $n$ 呈几何级数增长；当 $0 < \\alpha < 1$ 时，它呈几何级数衰减，因此当 $\\alpha$ 远离 1 时，各列之间的范数值差异巨大。\n\n4) 基于第 1) 至 3) 部分，论证对于此参数化族，当 $\\alpha$ 显著偏离 1 时，通过乘以 $D^{-1}$ 来形成 $T_{\\mathrm{bal}}$ 预计会降低谱条件数，而当 $\\alpha$ 接近 1 时，降低幅度应该不大。\n\n5) 实现一个程序，对于固定的维度 $n$ 和几个 $\\alpha$ 的测试值，按前述方法构造 $T_{\\mathrm{raw}}$ 和 $T_{\\mathrm{bal}}$，计算它们的谱条件数 $\\kappa_{2}\\big(T_{\\mathrm{raw}}\\big)$ 和 $\\kappa_{2}\\big(T_{\\mathrm{bal}}\\big)$，并输出一个定义为如下的量化改善因子\n$$\n\\rho(\\alpha) = \\frac{\\kappa_{2}\\big(T_{\\mathrm{raw}}(\\alpha)\\big)}{\\kappa_{2}\\big(T_{\\mathrm{bal}}(\\alpha)\\big)}.\n$$\n若 $\\rho(\\alpha) > 1$，则表示平衡操作降低了条件数。\n\n使用以下测试套件，其设计旨在以数值稳定的方式探测不同的区域和边界情况：\n\n- 维度 $n = 5$。\n- 测试值 $\\alpha \\in \\{\\,1.1,\\,2.0,\\,5.0,\\,10.0,\\,0.5\\,\\}$。\n\n你的程序必须为上述每个 $\\alpha$ 值计算 $\\rho(\\alpha)$，并打印所有五个结果，四舍五入到 6 位小数。\n\n最终输出格式要求：你的程序应生成单行输出，包含 5 个结果，形式为方括号内由逗号分隔的列表，其顺序与上面列出的 $\\alpha$ 顺序相同，例如，形如 $[r_{1},r_{2},r_{3},r_{4},r_{5}]$ 的一行，其中每个 $r_{i}$ 是一个最多带 6 位小数的十进制数。\n\n此问题中的所有数值均为无量纲量，因此不需要物理单位。唯一允许的数值线性代数运算是标准数值库中提供的运算；不要假设使用符号计算。", "solution": "该问题经评估有效。这是一个在数值控制理论中适定、有科学依据的问题，没有矛盾或歧义。下面我将进行完整解答。\n\n解答分为四个部分，对应于理论任务，随后是实现部分。\n\n**第一部分：相似性变换的条件数**\n\n相似性变换 $x = Tz$ 是从状态向量 $x$到新状态向量 $z$的坐标变换。逆变换为 $z = T^{-1}x$。此操作的数值稳定性由矩阵 $T$ 的条件数决定。一个非奇异矩阵 $T$ 在谱范数（或 2-范数）下的条件数定义为 $\\kappa_2(T) = \\lVert T \\rVert_2 \\lVert T^{-1} \\rVert_2$。这个数字量化了在求解线性系统时相对误差的最大放大率。对于坐标变换 $z = T^{-1}x$，$x$ 中的一个小扰动 $\\Delta x$ 可能导致 $z$ 中的一个扰动 $\\Delta z$，其大小由以下不等式界定：\n$$ \\frac{\\lVert \\Delta z \\rVert_2}{\\lVert z \\rVert_2} \\le \\kappa_2(T) \\frac{\\lVert \\Delta x \\rVert_2}{\\lVert x \\rVert_2} $$\n一个大的条件数，$\\kappa_2(T) \\gg 1$，表示这是一个病态变换。在这种情况下，$x$ 中的微小数值误差（例如，来自测量噪声或浮点表示）可能被放大为变换后坐标 $z$ 中的巨大误差。这会损害在新的基下执行的任何计算的数值可靠性，包括计算变换后的状态矩阵 $A_c = T^{-1}AT$。计算 $A_c$ 时的误差也会被一个与 $\\kappa_2(T)$ 成正比的因子放大。\n\n条件数 $\\kappa_2(T)$ 也等于 $T$ 的最大奇异值与最小奇异值之比，即 $\\kappa_2(T) = \\sigma_{\\max}(T) / \\sigma_{\\min}(T)$。奇异值之间的巨大差异会导致病态。虽然奇异值不像列范数那样容易检查，但一个其列的量级差异巨大的矩阵是病态的一个强有力指标。直观地说，这样的矩阵将空间中的某些方向进行极端拉伸，而将其他方向进行极端压缩，这就是病态的几何根源。\n\n所提出的列平衡是一种有原则的、用以改善条件数的启发式方法。矩阵 $T_{\\mathrm{bal}} = T_{\\mathrm{raw}} D^{-1}$ 是通过将 $T_{\\mathrm{raw}}$ 右乘一个对角矩阵 $D = \\operatorname{diag}(\\lVert c_1 \\rVert_2, \\dots, \\lVert c_n \\rVert_2)$ 的逆矩阵而形成的。此操作将 $T_{\\mathrm{raw}}$ 的每一列 $c_k$ 进行缩放，使其欧几里得范数为单位1，即 $T_{\\mathrm{bal}}$ 的列为 $c'_k = c_k / \\lVert c_k \\rVert_2$。这个过程被称为列均衡，它直接抵消了基向量量级上的任何巨大差异。通过使所有基向量具有相同的“尺度”，我们减少了病态最常见的来源之一。Van der Sluis 定理为此提供了形式化的论证，它指出：对于一个矩阵 $A$，最优列缩放后矩阵的条件数与在所有可能的列缩放中可实现的最小条件数相差不超过一个因子 $\\sqrt{n}$。因此，在该类预处理方法中，使列范数相等是一种近乎最优的策略。\n\n**第二部分：参数化族的能控性**\n\n给定状态矩阵 $A(\\alpha) = \\operatorname{diag}(1, \\alpha, \\alpha^2, \\dots, \\alpha^{n-1})$ 和输入向量 $b(\\alpha) = \\mathbf{1}_n$，其中 $\\mathbf{1}_n$ 是 $n \\times 1$ 的全1向量。如果能控性矩阵 $C(A,b) = [\\,b, Ab, \\dots, A^{n-1}b\\,]$ 是满秩的，即非奇异，则系统是能控的。\n\n让我们构造 $C(A,b)$ 的列。第 $k$ 列为 $c_k = A^{k-1}b$，其中 $k \\in \\{1, \\dots, n\\}$。\n由于 $A$ 是对角矩阵，所以 $A^m = \\operatorname{diag}(1^m, \\alpha^m, (\\alpha^2)^m, \\dots, (\\alpha^{n-1})^m)$。\n我们用下标 $i$ 表示向量的第 $i$ 个分量，其中 $i \\in \\{1, \\dots, n\\}$。\n第 $k$ 列向量 $c_k$ 的第 $i$ 个分量是：\n$$ (c_k)_i = (A^{k-1}b)_i = (A_{ii})^{k-1} b_i $$\n给定 $A_{ii} = \\alpha^{i-1}$ 且 $b_i=1$，我们有：\n$$ (c_k)_i = (\\alpha^{i-1})^{k-1} \\cdot 1 = \\alpha^{(i-1)(k-1)} $$\n这是能控性矩阵第 $i$ 行、第 $k$ 列的元素 $C_{ik}$。\n完整的矩阵是：\n$$ C(A(\\alpha), b(\\alpha)) = \\begin{pmatrix}\n1 & 1 & 1 & \\dots & 1 \\\\\n1 & \\alpha & \\alpha^2 & \\dots & \\alpha^{n-1} \\\\\n1 & \\alpha^2 & (\\alpha^2)^2 & \\dots & (\\alpha^2)^{n-1} \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n1 & \\alpha^{n-1} & (\\alpha^{n-1})^2 & \\dots & (\\alpha^{n-1})^{n-1}\n\\end{pmatrix} $$\n这是一个范德蒙矩阵。令节点为 $x_i = \\alpha^{i-1}$，其中 $i \\in \\{1, \\dots, n\\}$。则矩阵元素为 $C_{ik} = (x_i)^{k-1}$。此类矩阵的行列式由其节点的差的乘积给出：\n$$ \\det(C) = \\prod_{1 \\le i < j \\le n} (x_j - x_i) = \\prod_{1 \\le i < j \\le n} (\\alpha^{j-1} - \\alpha^{i-1}) $$\n行列式非零当且仅当所有节点 $x_i$ 均不相同。节点为 $x_1 = \\alpha^0 = 1$, $x_2 = \\alpha^1$, $x_3 = \\alpha^2$, ..., $x_n = \\alpha^{n-1}$。要使这些节点互不相同，需要对于任意 $0 \\le p < q \\le n-1$ 都有 $\\alpha^p \\neq \\alpha^q$。因为题目规定 $\\alpha \\in \\mathbb{R}_{>0}$，所以只有当 $\\alpha=1$ 时此条件才不满足。题目指定了 $\\alpha \\neq 1$。\n因此，对于任意 $\\alpha > 0$ 且 $\\alpha \\neq 1$，所有节点 $x_i$ 均不相同，$\\det(C) \\neq 0$，矩阵 $C(A(\\alpha), b(\\alpha))$ 是非奇异的。这证明了系统对 $(A(\\alpha), b(\\alpha))$ 是能控的。\n\n**第三部分：列范数的闭式表达式**\n\n我们寻求 $C(A(\\alpha), b(\\alpha))$ 第 $k$ 列的欧几里得范数平方 $\\lVert c_k \\rVert_2^2$ 的闭式表达式。\n如前所述，$c_k$ 的第 $i$ 个分量是 $(c_k)_i = \\alpha^{(i-1)(k-1)}$。\n范数平方是其分量平方的和：\n$$ \\lVert c_k \\rVert_2^2 = \\sum_{i=1}^{n} \\left( \\alpha^{(i-1)(k-1)} \\right)^2 = \\sum_{i=1}^{n} \\alpha^{2(i-1)(k-1)} = \\sum_{j=0}^{n-1} \\left( \\alpha^{2(k-1)} \\right)^j $$\n这是一个公比为 $r = \\alpha^{2(k-1)}$ 的几何级数。我们分两种情况分析：\n\n情况 1: $k = 1$。指数为 $k-1 = 0$，所以 $r = \\alpha^0 = 1$。和为 $\\sum_{j=0}^{n-1} 1^j = n$。\n因此，$\\lVert c_1 \\rVert_2^2 = n$。这是正确的，因为 $c_1=b=\\mathbf{1}_n$。\n\n情况 2: $k \\in \\{2, \\dots, n\\}$。由于 $\\alpha \\neq 1$，公比 $r = \\alpha^{2(k-1)} \\neq 1$。\n有限几何级数的和为 $\\sum_{j=0}^{n-1} r^j = \\frac{r^n - 1}{r - 1}$。代入 $r$：\n$$ \\lVert c_k \\rVert_2^2 = \\frac{(\\alpha^{2(k-1)})^n - 1}{\\alpha^{2(k-1)} - 1} = \\frac{\\alpha^{2n(k-1)} - 1}{\\alpha^{2(k-1)} - 1} $$\n结合两种情况，闭式表达式为：\n$$ \\lVert c_k \\rVert_2^2 = \\begin{cases} n & \\text{若 } k=1 \\\\ \\frac{\\alpha^{2n(k-1)} - 1}{\\alpha^{2(k-1)} - 1} & \\text{若 } k > 1 \\end{cases} $$\n现在我们分析其行为。\n- 如果 $\\alpha > 1$：公比 $r = \\alpha^{2(k-1)} > 1$。随着 $k$ 的增加， $r$ 增加，级数 $\\sum_{j=0}^{n-1}r^j$ 中的每一项都增长。因此，$\\lVert c_k \\rVert_2^2$ 随 $k$ 呈几何级数增长。当 $\\alpha$、 $n$ 和 $k$ 很大时，$\\lVert c_k \\rVert_2^2 \\approx \\alpha^{2(n-1)(k-1)}$。这在第一列的范数 $\\sqrt{n}$ 和最后一列的范数之间造成了巨大的差异。\n- 如果 $0 < \\alpha < 1$：公比 $r = \\alpha^{2(k-1)}$ 在区间 $(0, 1)$ 内。随着 $k$ 的增加， $r$ 减小，趋近于 0。对于 $r \\in (0,1)$，和 $\\sum_{j=0}^{n-1}r^j$ 是 $r$ 的递减函数，所以 $\\lVert c_k \\rVert_2^2$ 随 $k$ 的增加而衰减。范数从 $\\lVert c_1 \\rVert_2 = \\sqrt{n}$ 衰减到 $\\lVert c_n \\rVert_2 \\approx 1$。同样，对于大的 $n$，这是一个显著的差异。\n\n**第四部分：平衡有效性的论证**\n\n前几部分的结果为列平衡对此系统有效的原因提供了清晰的论证。\n1. 在第一部分，我们确定了具有巨大列范数差异的变换矩阵可能存在病态，而对列进行归一化是改善条件数的一种有原则的方法。\n2. 在第三部分，我们证明了对于族 $(A(\\alpha), b(\\alpha))$，只要参数 $\\alpha$ 显著不为 1（即 $\\alpha \\gg 1$ 或 $0 < \\alpha \\ll 1$），变换矩阵 $T_{\\mathrm{raw}} = C(A,b)$ 的列范数就会表现出巨大的几何级数差异。\n3. 平衡过程构建了 $T_{\\mathrm{bal}} = T_{\\mathrm{raw}} D^{-1}$，其列保证具有单位欧几里得范数。这个过程直接解决了我们为 $T_{\\mathrm{raw}}$ 识别出的特定病态问题——巨大的列范数差异。因此，当 $\\alpha$ 远离 1 时，预计 $\\kappa_2(T_{\\mathrm{bal}})$ 会远小于 $\\kappa_2(T_{\\mathrm{raw}})$，从而导致改善因子 $\\rho(\\alpha) > 1$。\n\n反之，当 $\\alpha$ 接近 1 时，令 $\\alpha = 1 + \\epsilon$，其中 $\\epsilon$ 很小。公比 $r = \\alpha^{2(k-1)} \\approx 1 + 2(k-1)\\epsilon$。使用几何级数求和公式，并当 $r \\to 1$ 时应用洛必达法则或泰勒展开，我们发现 $\\frac{r^n-1}{r-1} \\to n$。因此，对于 $\\alpha \\approx 1$，我们有 $\\lVert c_k \\rVert_2^2 \\approx n$ 对于所有 $k \\in \\{1, \\dots, n\\}$。\n在这种情况下，$T_{\\mathrm{raw}}$ 的列已经几乎是平衡的。缩放矩阵 $D$ 接近一个标量矩阵，$D \\approx \\sqrt{n}I$。平衡后的矩阵 $T_{\\mathrm{bal}} = T_{\\mathrm{raw}}D^{-1} \\approx \\frac{1}{\\sqrt{n}} T_{\\mathrm{raw}}$。由于条件数对于标量乘法是不变的，因此 $\\kappa_2(T_{\\mathrm{bal}}) \\approx \\kappa_2(T_{\\mathrm{raw}})$。改善因子 $\\rho(\\alpha)$ 将接近 1，表明条件数的降低幅度不大或可以忽略不计，这与预期相符。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the condition number improvement factor rho for a parametrized\n    family of LTI systems after column-balancing the controllability matrix.\n    \"\"\"\n    n = 5\n    alphas = [1.1, 2.0, 5.0, 10.0, 0.5]\n    \n    results = []\n    \n    for alpha in alphas:\n        # Construct the raw transformation matrix T_raw.\n        # The entry at (i, k) is (alpha**i)**k for 0-based indices i, k.\n        # This can be vectorized as alpha**(i_vec * k_vec).\n        i_vec = np.arange(n, dtype=float).reshape(n, 1)\n        k_vec = np.arange(n, dtype=float).reshape(1, n)\n        T_raw = np.power(alpha, i_vec * k_vec)\n        \n        # Compute the spectral condition number of T_raw.\n        # The condition number is the ratio of the largest to smallest singular values.\n        cond_raw = np.linalg.cond(T_raw)\n        \n        # Construct the balanced transformation matrix T_bal.\n        # 1. Compute the Euclidean norm of each column of T_raw.\n        col_norms = np.linalg.norm(T_raw, axis=0)\n        \n        # 2. Scale each column to have unit norm.\n        # Avoid division by zero, although it won't happen here since b is non-zero\n        # and A is nonsingular.\n        # The broadcasting T_raw / col_norms is equivalent to T_raw @ diag(1/col_norms).\n        T_bal = T_raw / col_norms\n        \n        # Compute the spectral condition number of T_bal.\n        cond_bal = np.linalg.cond(T_bal)\n        \n        # Calculate the improvement factor rho.\n        if cond_bal > 0:\n            rho = cond_raw / cond_bal\n        else:\n            # Handle cases of extremely well-conditioned or singular matrices,\n            # though not expected for this problem's parameters.\n            rho = np.inf if cond_raw > 0 else 1.0\n\n        results.append(rho)\n        \n    # Format the final output string as per requirements.\n    # Each result is rounded to 6 decimal places.\n    output_str = f\"[{','.join([f'{r:.6f}' for r in results])}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2697100"}]}