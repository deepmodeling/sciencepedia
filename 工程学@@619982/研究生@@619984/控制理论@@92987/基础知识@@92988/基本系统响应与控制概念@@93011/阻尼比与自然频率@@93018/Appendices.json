{"hands_on_practices": [{"introduction": "本练习旨在建立一个基础但至关重要的联系：如何从一个可观测的时域特征——振荡的衰减率——推导出系统的内在阻尼比 $\\zeta$。对数减幅法是振动分析和系统辨识中的经典方法，用于通过简单的“振铃”测试来估计阻尼。掌握这一推导过程有助于您深刻理解阻尼比的物理意义和实际测量方法。[@problem_id:2698462]", "problem": "考虑一个单自由度质量-弹簧-阻尼器的自由响应，该系统被建模为一个二阶线性时不变（LTI）系统，由齐次微分方程 $m \\ddot{x}(t) + c \\dot{x}(t) + k x(t) = 0$ 控制，其中 $m>0$，$c>0$ 且 $k>0$。令无阻尼固有频率定义为 $\\omega_{n} \\coloneqq \\sqrt{k/m}$，阻尼比定义为 $\\zeta \\coloneqq \\dfrac{c}{2 \\sqrt{km}}$，并假设为欠阻尼情况 $0<\\zeta<1$。欠阻尼自由响应可以写成标准形式 $x(t) = A \\exp(-\\zeta \\omega_{n} t) \\cos(\\omega_{d} t - \\phi)$，其中 $A>0$ 和 $\\phi \\in \\mathbb{R}$ 为常数，$\\omega_{d} \\coloneqq \\omega_{n} \\sqrt{1-\\zeta^{2}}$ 是有阻尼固有频率。\n\n设 $\\{t_{k}\\}_{k \\in \\mathbb{Z}}$ 表示 $x(t)$ 达到同符号的连续局部最大值时的严格递增时间序列，并定义对数衰减率 $\\delta \\coloneqq \\ln\\!\\big(x(t_{k})/x(t_{k+1})\\big)$，对任意 $k$ 成立。从上述欠阻尼解和基本定义出发（不使用任何预先推导的幅值衰减关系），推导一个仅用 $\\zeta$ 表示的 $\\delta$ 的闭式表达式。你的最终答案必须是一个单一的解析表达式，并且不得包含对初始条件、$A$、$\\phi$ 或 $\\omega_{n}$ 的任何依赖。不需要数值近似，也无需报告单位。", "solution": "所述问题在科学上是合理的、适定的、客观的，并包含唯一解所需的全部信息。这是控制理论和系统动力学领域内的一个有效问题。我们开始推导。\n\n欠阻尼二阶系统的自由响应由以下方程给出：\n$$x(t) = A \\exp(-\\zeta \\omega_{n} t) \\cos(\\omega_{d} t - \\phi)$$\n其中 $A > 0$，$0 < \\zeta < 1$，$\\omega_{n} > 0$ 且 $\\phi \\in \\mathbb{R}$。对数衰减率 $\\delta$ 是根据 $x(t)$ 在由时间序列 $\\{t_{k}\\}$ 表示的同符号连续局部最大值处的数值定义的。\n\n为了找到出现局部极值的时间，我们必须求出 $x(t)$ 关于时间 $t$ 的一阶导数的根。我们使用乘法法则计算 $\\dot{x}(t)$：\n$$ \\dot{x}(t) = \\frac{d}{dt} \\left[ A \\exp(-\\zeta \\omega_{n} t) \\cos(\\omega_{d} t - \\phi) \\right] $$\n$$ \\dot{x}(t) = A \\left( (-\\zeta \\omega_{n}) \\exp(-\\zeta \\omega_{n} t) \\cos(\\omega_{d} t - \\phi) - \\omega_{d} \\exp(-\\zeta \\omega_{n} t) \\sin(\\omega_{d} t - \\phi) \\right) $$\n$$ \\dot{x}(t) = -A \\exp(-\\zeta \\omega_{n} t) \\left[ \\zeta \\omega_{n} \\cos(\\omega_{d} t - \\phi) + \\omega_{d} \\sin(\\omega_{d} t - \\phi) \\right] $$\n局部极值出现在时间 $t_{ext}$ 处，此时 $\\dot{x}(t_{ext}) = 0$。由于 $A>0$ 且指数项对于有限的 $t$ 总是正的，此条件简化为：\n$$ \\zeta \\omega_{n} \\cos(\\omega_{d} t_{ext} - \\phi) + \\omega_{d} \\sin(\\omega_{d} t_{ext} - \\phi) = 0 $$\n在 $\\cos(\\omega_{d} t_{ext} - \\phi) \\neq 0$ 的条件下，我们可以重新整理方程以求得正切值：\n$$ \\tan(\\omega_{d} t_{ext} - \\phi) = -\\frac{\\zeta \\omega_{n}}{\\omega_{d}} $$\n代入有阻尼固有频率的定义 $\\omega_{d} = \\omega_{n} \\sqrt{1 - \\zeta^{2}}$，我们得到：\n$$ \\tan(\\omega_{d} t_{ext} - \\phi) = -\\frac{\\zeta \\omega_{n}}{\\omega_{n} \\sqrt{1 - \\zeta^{2}}} = -\\frac{\\zeta}{\\sqrt{1 - \\zeta^{2}}} $$\n正切函数是周期函数，其周期为 $\\pi$。因此，任意两个连续极值（一个最大值和一个最小值）之间的时间间隔对应于正切函数自变量 $\\pi$ 的变化，这意味着所经过的时间为 $\\Delta t = \\frac{\\pi}{\\omega_d}$。\n\n问题考虑的是同符号的连续局部最大值。它们之间由一个局部最小值隔开。因此，两个同符号的连续最大值（例如在 $t_k$ 和 $t_{k+1}$ 处）之间的时间周期是连续极值之间间隔的两倍。这个周期是有阻尼固有周期 $T_d$。\n$$ t_{k+1} - t_k = 2 \\times \\frac{\\pi}{\\omega_d} = \\frac{2\\pi}{\\omega_d} \\eqqcolon T_d $$\n因此，我们可以写出 $t_{k+1} = t_k + T_d$。\n\n现在我们可以计算这些连续峰值处的幅值比，$x(t_k)$ 和 $x(t_{k+1})$：\n$$ x(t_k) = A \\exp(-\\zeta \\omega_{n} t_k) \\cos(\\omega_{d} t_k - \\phi) $$\n$$ x(t_{k+1}) = A \\exp(-\\zeta \\omega_{n} t_{k+1}) \\cos(\\omega_{d} t_{k+1} - \\phi) $$\n将 $t_{k+1} = t_k + T_d$ 代入 $x(t_{k+1})$ 的表达式中：\n$$ x(t_{k+1}) = A \\exp(-\\zeta \\omega_{n} (t_k+T_d)) \\cos(\\omega_{d} (t_k+T_d) - \\phi) $$\n我们分别分析指数项和余弦项。\n指数项变为：\n$$ \\exp(-\\zeta \\omega_{n} (t_k+T_d)) = \\exp(-\\zeta \\omega_{n} t_k) \\exp(-\\zeta \\omega_{n} T_d) $$\n余弦项的自变量变为：\n$$ \\omega_{d} (t_k+T_d) - \\phi = \\omega_{d} t_k + \\omega_{d} T_d - \\phi $$\n使用关系式 $T_d = \\frac{2\\pi}{\\omega_d}$，我们得到 $\\omega_{d} T_d = 2\\pi$。因此，余弦项为：\n$$ \\cos(\\omega_{d} t_k + 2\\pi - \\phi) = \\cos(\\omega_{d} t_k - \\phi) $$\n这证实了在时间 $t_k$ 和 $t_{k+1}$ 处的余弦因子是相同的，对于同符号的连续峰值，这必然成立。\n\n现在我们构造计算对数衰减率所需的比值：\n$$ \\frac{x(t_k)}{x(t_{k+1})} = \\frac{A \\exp(-\\zeta \\omega_{n} t_k) \\cos(\\omega_{d} t_k - \\phi)}{A \\exp(-\\zeta \\omega_{n} t_k) \\exp(-\\zeta \\omega_{n} T_d) \\cos(\\omega_{d} t_k - \\phi)} $$\n项 $A$、$\\exp(-\\zeta \\omega_{n} t_k)$ 和 $\\cos(\\omega_{d} t_k - \\phi)$ 被消去，剩下：\n$$ \\frac{x(t_k)}{x(t_{k+1})} = \\frac{1}{\\exp(-\\zeta \\omega_{n} T_d)} = \\exp(\\zeta \\omega_{n} T_d) $$\n对数衰减率 $\\delta$ 定义为该比值的自然对数：\n$$ \\delta \\coloneqq \\ln\\left(\\frac{x(t_k)}{x(t_{k+1})}\\right) = \\ln\\left(\\exp(\\zeta \\omega_{n} T_d)\\right) = \\zeta \\omega_{n} T_d $$\n代入 $T_d = \\frac{2\\pi}{\\omega_d}$：\n$$ \\delta = \\zeta \\omega_{n} \\left(\\frac{2\\pi}{\\omega_d}\\right) $$\n最后，我们代入定义 $\\omega_{d} = \\omega_{n} \\sqrt{1 - \\zeta^{2}}$，以仅用 $\\zeta$ 表示 $\\delta$：\n$$ \\delta = \\zeta \\omega_{n} \\left(\\frac{2\\pi}{\\omega_{n} \\sqrt{1 - \\zeta^{2}}}\\right) = \\frac{2\\pi\\zeta}{\\sqrt{1 - \\zeta^{2}}} $$\n这就是对数衰减率的最终闭式表达式，它仅依赖于阻尼比 $\\zeta$，符合要求。", "answer": "$$\\boxed{\\frac{2\\pi\\zeta}{\\sqrt{1-\\zeta^{2}}}}$$", "id": "2698462"}, {"introduction": "在现代数字控制中，我们通常基于采样数据来分析系统。本练习将解决一个关键问题：如何将离散时间域（$z$ 平面）中的极点映射回连续时间域（$s$ 平面），以恢复物理参数 $\\zeta$ 和 $\\omega_n$。对于在数字环境中进行系统辨识的工程师来说，这项实践技能必不可少，它构成了连接理论模型与实际数字实现的桥梁。[@problem_id:2698490]", "problem": "一个实值的、严格真分数的二阶线性时不变 (LTI) 连续时间系统具有共轭复极点。该系统以采样周期 $T$ 进行精确采样，得到一个离散时间模型，其单个采样间隔内的状态转移是连续时间生成元的矩阵指数。从一个数据集中，主导离散时间极点对已被估计为极坐标形式 $z=\\rho \\exp(\\pm j \\theta)$，其中 $0<\\rho<1$ 且 $\\theta \\in (0,\\pi)$，$\\theta$ 的单位是弧度。\n\n仅从 (i) 具有实系数的连续时间二阶特征方程和 (ii) 连续时间生成元与离散时间生成元之间的精确采样关系出发，完成以下任务：\n\n1. 推导用 $\\rho$、$\\theta$ 和 $T$ 表示的连续时间自然频率 $\\omega_{n}$ 和阻尼比 $\\zeta$ 的显式表达式。说明推导过程中所作的任何分支假设，并根据给定的 $\\theta$ 范围证明其合理性。\n\n2. 对于数值 $\\rho=0.8$，$\\theta=0.6$ (弧度)，以及 $T=0.05$ 秒，使用你推导的公式计算阻尼比。将答案四舍五入到 $4$ 位有效数字。\n\n请将你的最终答案以阻尼比 $\\zeta$ 的单一数值（无单位）形式提供。", "solution": "该问题基于控制理论的既定原则，提法恰当且科学合理。我们可以进行形式化推导。\n\n第一步是将连续时间系统参数与其在复 $s$ 平面中的极点联系起来。一个实值的二阶线性时不变 (LTI) 连续时间系统具有以下形式的特征方程：\n$$s^2 + 2\\zeta\\omega_{n}s + \\omega_{n}^2 = 0$$\n此处，$\\zeta$ 是阻尼比，$\\omega_{n}$ 是无阻尼自然频率。问题指出该系统具有共轭复极点，这对应于一个欠阻尼系统，其中 $0 < \\zeta < 1$。该特征方程的根，即系统极点，由下式给出：\n$$s_{1,2} = \\frac{-2\\zeta\\omega_{n} \\pm \\sqrt{(2\\zeta\\omega_{n})^2 - 4(1)(\\omega_{n}^2)}}{2} = -\\zeta\\omega_{n} \\pm \\omega_{n}\\sqrt{\\zeta^2 - 1}$$\n由于 $0 < \\zeta < 1$，项 $\\zeta^2 - 1$ 为负。我们可以将极点写为：\n$$s_{1,2} = -\\zeta\\omega_{n} \\pm j\\omega_{n}\\sqrt{1 - \\zeta^2}$$\n我们定义有阻尼自然频率 $\\omega_{d}$ 为 $\\omega_{d} = \\omega_{n}\\sqrt{1 - \\zeta^2}$。因此，连续时间极点可以简洁地表示为：\n$$s_{1,2} = -\\zeta\\omega_{n} \\pm j\\omega_{d}$$\n\n第二步是使用指定的连续时间系统与其离散时间对应物之间的关系。系统以周期 $T$ 进行采样。离散时间系统的极点 $z$ 与连续时间系统的极点 $s$ 通过精确映射关系相关联：\n$$z = \\exp(sT)$$\n将连续时间极点 $s_{1,2}$ 的表达式代入此映射函数，得到离散时间极点：\n$$z_{1,2} = \\exp( (-\\zeta\\omega_{n} \\pm j\\omega_{d}) T ) = \\exp(-\\zeta\\omega_{n}T) \\exp(\\pm j\\omega_{d}T)$$\n该表达式是极坐标形式，其中模为 $\\exp(-\\zeta\\omega_{n}T)$，相角为 $\\pm \\omega_{d}T$。\n\n问题指出，估计的离散时间极点以极坐标形式给出为 $z = \\rho \\exp(\\pm j\\theta)$，其中 $0 < \\rho < 1$ 且 $\\theta \\in (0, \\pi)$。通过比较离散时间极点的两种形式，我们可以使其模和辐角相等：\n模：$\\rho = \\exp(-\\zeta\\omega_{n}T)$\n辐角：$\\theta = \\omega_{d}T + 2\\pi k$，其中 $k$ 为某个整数。\n\n我们必须证明辐角分支选择的合理性，这等同于选择整数 $k$ 的值。从 $z$ 到 $s$ 的逆映射是多值的：$s = \\frac{1}{T}\\ln(z) = \\frac{1}{T}(\\ln|z| + j(\\arg(z)+2\\pi k))$。问题中提到的“主导”离散时间极点对，在从采样数据进行系统辨识的背景下，通常假设其对应于具有最低可能频率（主混叠）的连续时间极点。这对应于设置 $k=0$。指定的离散时间角度范围 $\\theta \\in (0, \\pi)$ 意味着相应的有阻尼自然频率 $\\omega_{d} = \\theta/T$ 处于 $(0, \\pi/T)$ 的范围内。这是低于奈奎斯特频率 $\\omega_{Nyq} = \\pi/T$ 的基带频率范围，并且是唯一地恢复连续时间参数的标准假设。因此，我们作出分支假设 $k=0$，并继续使用：\n$$\\theta = \\omega_{d}T$$\n\n我们现在得到一个包含两个未知数 $\\zeta$ 和 $\\omega_{n}$ 的方程组：\n(1) $\\rho = \\exp(-\\zeta\\omega_{n}T)$\n(2) $\\theta = \\omega_{d}T = (\\omega_{n}\\sqrt{1 - \\zeta^2})T$\n\n从方程 (1) 出发，我们对两边取自然对数：\n$$\\ln(\\rho) = -\\zeta\\omega_{n}T \\implies \\zeta\\omega_{n} = -\\frac{\\ln(\\rho)}{T}$$\n从方程 (2) 出发，我们分离出包含 $\\omega_{n}$ 的项：\n$$\\omega_{n}\\sqrt{1 - \\zeta^2} = \\frac{\\theta}{T}$$\n为了求解 $\\zeta$，我们将得到的第二个方程除以第一个方程：\n$$\\frac{\\omega_{n}\\sqrt{1 - \\zeta^2}}{\\zeta\\omega_{n}} = \\frac{\\theta/T}{-\\ln(\\rho)/T} \\implies \\frac{\\sqrt{1 - \\zeta^2}}{\\zeta} = -\\frac{\\theta}{\\ln(\\rho)}$$\n两边平方以消去根号：\n$$\\frac{1 - \\zeta^2}{\\zeta^2} = \\left(-\\frac{\\theta}{\\ln(\\rho)}\\right)^2 = \\frac{\\theta^2}{(\\ln(\\rho))^2}$$\n我们可以将左侧重写为 $\\frac{1}{\\zeta^2} - 1$。求解 $\\frac{1}{\\zeta^2}$：\n$$\\frac{1}{\\zeta^2} = 1 + \\frac{\\theta^2}{(\\ln(\\rho))^2} = \\frac{(\\ln(\\rho))^2 + \\theta^2}{(\\ln(\\rho))^2}$$\n对此表达式求倒数，得到 $\\zeta^2$：\n$$\\zeta^2 = \\frac{(\\ln(\\rho))^2}{(\\ln(\\rho))^2 + \\theta^2}$$\n由于对于欠阻尼振荡系统，阻尼比 $\\zeta$ 是一个正数，我们取正平方根：\n$$\\zeta = \\sqrt{\\frac{(\\ln(\\rho))^2}{(\\ln(\\rho))^2 + \\theta^2}} = \\frac{|\\ln(\\rho)|}{\\sqrt{(\\ln(\\rho))^2 + \\theta^2}}$$\n考虑到 $0 < \\rho < 1$，我们有 $\\ln(\\rho) < 0$，所以 $|\\ln(\\rho)| = -\\ln(\\rho)$。阻尼比的最终表达式为：\n$$\\zeta = \\frac{-\\ln(\\rho)}{\\sqrt{(\\ln(\\rho))^2 + \\theta^2}}$$\n这就完成了问题的第一部分。\n\n对于第二部分，我们必须根据给定的参数 $\\rho=0.8$，$\\theta=0.6$ 弧度，以及 $T=0.05$ 秒来计算 $\\zeta$ 的数值。计算 $\\zeta$ 不需要 $T$ 的值，只有计算 $\\omega_n$ 才需要。我们将所提供的值代入推导出的公式中：\n$$\\zeta = \\frac{-\\ln(0.8)}{\\sqrt{(\\ln(0.8))^2 + (0.6)^2}}$$\n我们计算各项的值：\n$$\\ln(0.8) \\approx -0.22314355$$\n$$(\\ln(0.8))^2 \\approx (-0.22314355)^2 \\approx 0.04979210$$\n$$(0.6)^2 = 0.36$$\n将这些值代入 $\\zeta$ 的表达式中：\n$$\\zeta \\approx \\frac{-(-0.22314355)}{\\sqrt{0.04979210 + 0.36}} = \\frac{0.22314355}{\\sqrt{0.40979210}}$$\n$$\\zeta \\approx \\frac{0.22314355}{0.64015006} \\approx 0.3485799$$\n按照题目要求，将结果四舍五入到 $4$ 位有效数字，我们得到：\n$$\\zeta \\approx 0.3486$$", "answer": "$$\\boxed{0.3486}$$", "id": "2698490"}, {"introduction": "超越单点估计，这项高级实践将向您展示一种强大而现代的方法：如何将二阶系统模型与一组丰富的频率响应数据进行拟合。本练习涉及构建一个非线性最小二乘问题，并使用数值优化来寻找最佳拟合的 $\\zeta$ 和 $\\omega_n$。这真实地反映了现实世界中的工程任务，即从网络分析仪等设备获得的实验测量中提取系统参数。[@problem_id:2698430]", "problem": "你的任务是从共振点附近的频率响应数据中，辨识一个二阶线性系统的阻尼比和自然频率。请从基本原理出发：一个稳定的、因果的、线性时不变 (LTI) 二阶单输入单输出系统的输入-输出行为，可以在拉普拉斯域中通过一个有理传递函数进行建模，该函数的分母为一个实系数二次多项式，对应于一个齐次常系数线性常微分方程。对于角频率为 $\\omega$（单位：弧度/秒）的正弦稳态输入，频率响应可以通过将传递函数在 $s = j \\omega$ 处求值得到，其幅值是该复数值的欧几里得范数。在你的推理和实现中，请基于这些原理来推导所有需要的表达式。\n\n你的模型是具有静态增益的典型严格真二阶形式：\n- 传递函数由未知增益 $K > 0$、未知阻尼比 $0 < \\zeta < 1$ 和未知自然频率 $\\omega_n > 0$ 参数化。\n- 任务是通过最小化测量幅值 $|H(j \\omega)|$ 与模型幅值之间的平方误差和，来将此模型与频域测量数据进行拟合，并得到 $\\zeta$ 和 $\\omega_n$ 的估计值。\n\n你必须在单个程序中实现以下任务：\n- 从模型基本原理出发，推导频率响应幅值 $|H(j \\omega)|$ 关于 $K$、$\\zeta$、$\\omega_n$ 和 $\\omega$ 的表达式。\n- 针对测量幅值构建一个最小二乘代价函数，当模型幅值与数据匹配时，该函数达到最小值。你必须恰当地处理未知增益 $K$。对于每个候选的 $(\\zeta,\\omega_n)$，你可以使用标准的线性最小二乘原理，解析地确定最优的 $K$。\n- 将搜索范围约束在 $0 < \\zeta < 1$ 和 $\\omega_n > 0$ 内。\n- 实现一个数值稳定的求解器，该求解器返回使幅值误差最小化的估计值 $\\zeta$ 和 $\\omega_n$。\n\n单位和数值约定：\n- 角频率单位必须是弧度/秒。\n- 阻尼比 $\\zeta$ 是无量纲的。\n- 最终报告的 $\\omega_n$ 单位必须是弧度/秒。\n- 所有最终数值输出必须四舍五入到 $6$ 位小数。\n- 角度以弧度为单位。\n\n测试套件和数据生成：\n- 使用以下三个测试用例。对于每个用例，你都将获得真实参数 $(K_{\\text{true}}, \\zeta_{\\text{true}}, \\omega_{n,\\text{true}})$ 和一组有限的角频率 $\\{\\omega_i\\}$（单位：弧度/秒）。使用真实参数构建无噪声的测量幅值；也就是说，对于每个 $\\omega_i$，计算真实系统的精确幅值 $|H(j \\omega_i)|$，并将这些值视为待拟合的测量数据。除了生成数据外，不要在拟合过程中使用真实参数。\n- 用例 A：\n  - $(K_{\\text{true}}, \\zeta_{\\text{true}}, \\omega_{n,\\text{true}}) = (\\,2.5\\,,\\,0.05\\,,\\,20.0\\,)$\n  - 频率 $\\{\\omega_i\\} = \\{\\,10.0,\\,14.0,\\,17.0,\\,19.0,\\,20.0,\\,21.0,\\,23.0,\\,26.0,\\,30.0\\,\\}$（单位：弧度/秒）。\n- 用例 B：\n  - $(K_{\\text{true}}, \\zeta_{\\text{true}}, \\omega_{n,\\text{true}}) = (\\,1.2\\,,\\,0.2\\,,\\,50.0\\,)$\n  - 频率 $\\{\\omega_i\\} = \\{\\,20.0,\\,35.0,\\,45.0,\\,49.0,\\,50.0,\\,51.0,\\,55.0,\\,60.0,\\,80.0\\,\\}$（单位：弧度/秒）。\n- 用例 C：\n  - $(K_{\\text{true}}, \\zeta_{\\text{true}}, \\omega_{n,\\text{true}}) = (\\,0.8\\,,\\,0.7\\,,\\,12.0\\,)$\n  - 频率 $\\{\\omega_i\\} = \\{\\,4.0,\\,6.0,\\,8.0,\\,10.0,\\,11.5,\\,12.0,\\,13.0,\\,16.0,\\,20.0\\,\\}$（单位：弧度/秒）。\n\n所需输出格式：\n- 你的程序应为每个测试用例估计 $(\\widehat{\\zeta}, \\widehat{\\omega}_n)$，方法是在给定的频率集上最小化幅值的最小二乘误差。\n- 你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。每个用例的结果是一个双元素列表 $[\\,\\widehat{\\zeta},\\,\\widehat{\\omega}_n\\,]$，四舍五入到 $6$ 位小数，其顺序与用例 A、B、C 的顺序相同。例如：\"[[0.123456,45.678901],[...],[...]]\"。", "solution": "该问题要求在给定一组离散频率下的频率响应幅值的情况下，为一个典型二阶线性时不变 (LTI) 系统辨识其阻尼比 $\\zeta$ 和自然频率 $\\omega_n$。解决方案必须从第一性原理推导得出。\n\n该系统由以下传递函数描述：\n$$\nH(s) = \\frac{K \\omega_n^2}{s^2 + 2\\zeta\\omega_n s + \\omega_n^2}\n$$\n其中 $K > 0$ 是静态增益，$0 < \\zeta < 1$ 是阻尼比（表示一个欠阻尼系统），而 $\\omega_n > 0$ 是无阻尼自然频率。\n\n**第 1 步：频率响应幅值**\n\n系统的频率响应 $H(j\\omega)$ 是通过在 $s = j\\omega$ 处计算传递函数 $H(s)$ 得到的，其中 $\\omega$ 是角频率，单位为弧度/秒。\n$$\nH(j\\omega) = \\frac{K \\omega_n^2}{(j\\omega)^2 + 2\\zeta\\omega_n (j\\omega) + \\omega_n^2} = \\frac{K \\omega_n^2}{-\\omega^2 + j(2\\zeta\\omega_n \\omega) + \\omega_n^2}\n$$\n这可以通过将分母的实部和虚部分组来重新排列：\n$$\nH(j\\omega) = \\frac{K \\omega_n^2}{(\\omega_n^2 - \\omega^2) + j(2\\zeta\\omega_n \\omega)}\n$$\n频率响应的幅值 $|H(j\\omega)|$ 是此复数的欧几里得范数。由于 $K > 0$ 且 $\\omega_n > 0$，分子 $K \\omega_n^2$ 是一个正实数。\n$$\n|H(j\\omega)| = \\frac{|K \\omega_n^2|}{|(\\omega_n^2 - \\omega^2) + j(2\\zeta\\omega_n \\omega)|} = \\frac{K \\omega_n^2}{\\sqrt{(\\omega_n^2 - \\omega^2)^2 + (2\\zeta\\omega_n \\omega)^2}}\n$$\n对于频率为 $\\omega$ 的正弦输入，该表达式给出了系统输出相对于其输入的理论幅值。\n\n**第 2 步：最小二乘误差公式**\n\n给定在相应频率 $\\{\\omega_i\\}$ 下的一组 $N$ 个测量幅值 $\\{y_i\\}$。目标是找到参数 $(\\widehat{\\zeta}, \\widehat{\\omega}_n)$，使模型与这些数据点最佳拟合。我们采用最小二乘法，该方法最小化测量幅值与模型预测幅值之间的平方误差和 (SSE)。代价函数 $J$ 是：\n$$\nJ(K, \\zeta, \\omega_n) = \\sum_{i=1}^{N} \\left( y_i - |H(j\\omega_i; K, \\zeta, \\omega_n)| \\right)^2\n$$\n幅值模型可以表示为关于未知增益 $K$ 的线性形式：\n$$\n|H(j\\omega_i; K, \\zeta, \\omega_n)| = K \\cdot M(\\omega_i; \\zeta, \\omega_n)\n$$\n其中 $M(\\omega; \\zeta, \\omega_n)$ 是幅值函数中不依赖于 $K$ 的部分：\n$$\nM(\\omega; \\zeta, \\omega_n) = \\frac{\\omega_n^2}{\\sqrt{(\\omega_n^2 - \\omega^2)^2 + (2\\zeta\\omega_n \\omega)^2}}\n$$\n令 $M_i = M(\\omega_i; \\zeta, \\omega_n)$，则代价函数变为：\n$$\nJ(K, \\zeta, \\omega_n) = \\sum_{i=1}^{N} (y_i - K \\cdot M_i)^2\n$$\n\n**第 3 步：解析消除增益 $K$**\n\n对于任何给定的 $(\\zeta, \\omega_n)$ 对，基函数 $M_i$ 是固定的。此时，代价函数 $J$ 是关于 $K$ 的一个简单二次函数。我们可以通过将其关于 $K$ 的偏导数设为零，来找到最小化该代价函数的最优增益 $K^*$。\n$$\n\\frac{\\partial J}{\\partial K} = \\sum_{i=1}^{N} 2(y_i - K M_i)(-M_i) = -2 \\left( \\sum_{i=1}^{N} y_i M_i - K \\sum_{i=1}^{N} M_i^2 \\right) = 0\n$$\n解出 $K$ 可得最优增益 $K^*$，它是 $\\zeta$ 和 $\\omega_n$ 的函数：\n$$\nK^*(\\zeta, \\omega_n) = \\frac{\\sum_{i=1}^{N} y_i M_i}{\\sum_{i=1}^{N} M_i^2}\n$$\n用向量表示法，如果 $\\mathbf{y} = [y_1, \\dots, y_N]^T$ 并且 $\\mathbf{M}(\\zeta, \\omega_n) = [M_1, \\dots, M_N]^T$，则 $K^* = \\frac{\\mathbf{y}^T \\mathbf{M}}{\\mathbf{M}^T \\mathbf{M}}$。\n\n**第 4 步：简化的优化问题**\n\n将 $K^*(\\zeta, \\omega_n)$ 代回代价函数中，我们消除了 $K$ 并获得了一个简化的代价函数 $J_{\\text{reduced}}$，它只依赖于 $\\zeta$ 和 $\\omega_n$：\n$$\nJ_{\\text{reduced}}(\\zeta, \\omega_n) = \\sum_{i=1}^{N} \\left( y_i - K^*(\\zeta, \\omega_n) \\cdot M_i(\\zeta, \\omega_n) \\right)^2\n$$\n我们的任务现在是求解以下二维非线性优化问题：\n$$\n(\\widehat{\\zeta}, \\widehat{\\omega}_n) = \\arg\\min_{\\zeta, \\omega_n} J_{\\text{reduced}}(\\zeta, \\omega_n)\n$$\n约束条件为 $0 < \\zeta < 1$ 和 $\\omega_n > 0$。\n\n**第 5 步：数值求解策略**\n\n这个优化问题通常没有闭式解，必须通过数值方法求解。我们将使用一种拟牛顿算法，特别是 L-BFGS-B，它非常适合处理有界约束的问题。\n\n每个测试用例的实现步骤如下：\n1.  **数据生成**：使用真实参数 $(K_{\\text{true}}, \\zeta_{\\text{true}}, \\omega_{n,\\text{true}})$ 和给定的频率 $\\{\\omega_i\\}$，构建“测量的”幅值数据向量 $\\mathbf{y}$。由于数据是无噪声的，代价函数的最小值预计在真实参数值处为 $0$。\n2.  **目标函数**：定义一个 Python 函数，对于给定的参数向量 $[\\zeta, \\omega_n]$、频率向量 $\\mathbf{\\omega}$ 和数据向量 $\\mathbf{y}$，该函数计算 $J_{\\text{reduced}}(\\zeta, \\omega_n)$。\n3.  **初始猜测**：一个有效的初始猜测 $(\\zeta_0, \\omega_{n,0})$ 对于优化器的收敛至关重要。欠阻尼系统的共振峰出现在 $\\omega_n$ 附近。因此，$\\omega_n$ 的一个合理猜测值是测量幅值达到最大值时的频率。对于表现出共振峰的系统，一个通用的 $\\zeta$ 初始值（如 0.1）是合适的。\n4.  **优化**：使用带有 'L-BFGS-B' 方法的 `scipy.optimize.minimize`，提供目标函数、初始猜测以及 $\\zeta$ 和 $\\omega_n$ 的边界（例如，$\\zeta \\in [10^{-9}, 1-10^{-9}]$ 和 $\\omega_n \\in [10^{-9}, \\infty)$），以严格执行问题约束。\n5.  **结果提取**：优化器将返回最小化代价函数的估计参数 $(\\widehat{\\zeta}, \\widehat{\\omega}_n)$。这些就是所需的结果。\n该过程从基本原理系统地推导出解决方案，并使用标准的数值优化技术加以实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Identifies the damping ratio (zeta) and natural frequency (omega_n)\n    of a second-order LTI system from frequency response magnitude data.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"true_params\": (2.5, 0.05, 20.0),\n            \"freqs\": np.array([10.0, 14.0, 17.0, 19.0, 20.0, 21.0, 23.0, 26.0, 30.0])\n        },\n        {\n            \"true_params\": (1.2, 0.2, 50.0),\n            \"freqs\": np.array([20.0, 35.0, 45.0, 49.0, 50.0, 51.0, 55.0, 60.0, 80.0])\n        },\n        {\n            \"true_params\": (0.8, 0.7, 12.0),\n            \"freqs\": np.array([4.0, 6.0, 8.0, 10.0, 11.5, 12.0, 13.0, 16.0, 20.0])\n        }\n    ]\n\n    results = []\n\n    def calculate_magnitude(freqs, K, zeta, omega_n):\n        \"\"\"\n        Calculates the magnitude of the second-order system's frequency response.\n        |H(jw)| = K * omega_n^2 / sqrt((omega_n^2 - w^2)^2 + (2*zeta*omega_n*w)^2)\n        \"\"\"\n        omega_sq = freqs**2\n        omega_n_sq = omega_n**2\n        \n        # Ensure denominator is not zero\n        denom_sq_term1 = (omega_n_sq - omega_sq)**2\n        denom_sq_term2 = (2 * zeta * omega_n * freqs)**2\n        \n        magnitude = (K * omega_n_sq) / np.sqrt(denom_sq_term1 + denom_sq_term2)\n        return magnitude\n\n    for case in test_cases:\n        K_true, zeta_true, wn_true = case[\"true_params\"]\n        freqs = case[\"freqs\"]\n\n        # 1. Generate noiseless measurement data\n        measured_magnitudes = calculate_magnitude(freqs, K_true, zeta_true, wn_true)\n\n        # 2. Define the objective function (reduced sum of squared errors)\n        def objective_function(params, freqs_data, magnitudes_data):\n            \"\"\"\n            Calculates the sum of squared errors for a given (zeta, omega_n).\n            The optimal gain K is calculated analytically and substituted.\n            \"\"\"\n            zeta, omega_n = params\n            \n            # The basis function M(w; zeta, omega_n)\n            # M = omega_n^2 / sqrt((omega_n^2 - w^2)^2 + (2*zeta*omega_n*w)^2)\n            omega_sq = freqs_data**2\n            omega_n_sq = omega_n**2\n            denom_sq_term1 = (omega_n_sq - omega_sq)**2\n            denom_sq_term2 = (2 * zeta * omega_n * freqs_data)**2\n            # Add a small epsilon to prevent division by zero in sqrt if both terms are zero\n            M = omega_n_sq / np.sqrt(denom_sq_term1 + denom_sq_term2 + 1e-30)\n\n            # Analytically determine the optimal gain K*\n            # K* = (y^T M) / (M^T M)\n            K_opt = np.dot(magnitudes_data, M) / np.dot(M, M)\n\n            # Calculate the model predictions with the optimal gain\n            predicted_magnitudes = K_opt * M\n\n            # Calculate sum of squared errors\n            sse = np.sum((magnitudes_data - predicted_magnitudes)**2)\n            \n            return sse\n\n        # 3. Set up initial guess and bounds for optimization\n        # Initial guess for omega_n: frequency of maximum response\n        wn_initial_guess = freqs[np.argmax(measured_magnitudes)]\n        # Initial guess for zeta: a generic value for an underdamped system\n        zeta_initial_guess = 0.1\n        \n        initial_guess = [zeta_initial_guess, wn_initial_guess]\n\n        # Bounds: 0 < zeta < 1 and omega_n > 0\n        bounds = [(1e-9, 1.0 - 1e-9), (1e-9, None)]\n\n        # 4. Perform optimization\n        res = minimize(\n            objective_function,\n            initial_guess,\n            args=(freqs, measured_magnitudes),\n            method='L-BFGS-B',\n            bounds=bounds,\n            options={'ftol': 1e-12, 'gtol': 1e-12} # Tight tolerances for precision\n        )\n\n        # 5. Store the estimated parameters\n        estimated_zeta, estimated_wn = res.x\n        results.append([estimated_zeta, estimated_wn])\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"[{zeta:.6f},{wn:.6f}]\" for zeta, wn in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2698430"}]}