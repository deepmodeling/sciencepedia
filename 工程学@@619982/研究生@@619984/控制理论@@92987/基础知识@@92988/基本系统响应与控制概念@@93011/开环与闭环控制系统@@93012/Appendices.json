{"hands_on_practices": [{"introduction": "根轨迹法是分析反馈系统动态性能的经典图形工具，它直观地展示了闭环系统极点如何随着控制器增益等参数的变化而在复平面上移动。本练习将带你回归第一性原理，不依赖于死记硬背的绘图规则，直接从复数的基本条件推导出根轨迹的几何形状。通过这种方式，你将深刻理解反馈增益、极点位置以及系统性能指标（如阻尼比 $ \\zeta $）之间的内在联系。[@problem_id:2729872]", "problem": "考虑一个单位负反馈回路，其开环对象和控制器由下式给出\n$$P(s)=\\frac{1}{s(s+2)}, \\quad C(s)=k,$$\n其中 $k \\in \\mathbb{R}$ 是一个常数增益。闭环特征方程为\n$$1+P(s)C(s)=0。$$\n从闭环特征方程的第一性原理和辐角原理出发，推导该系统的根轨迹（根轨迹（RL）是当 $k$ 在非负实数线上变化时所有闭环极点位置的集合），而不要使用预先记忆的根轨迹构建规则。具体来说，从复映射 $k=-s(s+2)$ 确定根轨迹在复平面中的精确几何描述，包括实轴段、离轴分支及其当 $|s|\\to\\infty$ 时的极限行为。然后，使用二阶复共轭极点对的阻尼比定义，计算使闭环阻尼比为 $0.5$ 的精确增益 $k$。提供 $k$ 的最终数值，要求为精确数，无单位。不要四舍五入。", "solution": "所述问题是有效的。这是一个在经典控制理论中提法得当、有科学依据的问题。所有必要的数据都已提供，没有内部矛盾或歧义。我将着手解决它。\n\n该系统是一个单位负反馈回路，其对象为 $P(s) = \\frac{1}{s(s+2)}$，控制器为 $C(s) = k$。开环传递函数为 $L(s) = C(s)P(s) = \\frac{k}{s(s+2)}$。闭环极点是特征方程的根，该方程由 $1 + L(s) = 0$ 给出。\n代入 $L(s)$ 的表达式，我们得到：\n$$1 + \\frac{k}{s(s+2)} = 0$$\n这可以重写为：\n$$s(s+2) + k = 0$$\n$$s^2 + 2s + k = 0$$\n根轨迹是对于某个实数且非负的增益 $k \\ge 0$，满足此方程的所有复数 $s$ 的集合。为了从第一性原理推导根轨迹，我们将方程重排，把 $k$ 表示为 $s$ 的函数：\n$$k(s) = -s(s+2)$$\n要使一个点 $s$ 位于根轨迹上，它产生的 $k(s)$ 值必须是一个实数且非负。设 $s = \\sigma + j\\omega$，其中 $\\sigma$ 是 $s$ 的实部，$\\omega$ 是 $s$ 的虚部。我们将其代入 $k$ 的表达式中：\n$$k(\\sigma + j\\omega) = -(\\sigma + j\\omega)(\\sigma + j\\omega + 2)$$\n$$k = -[(\\sigma(\\sigma+2) - \\omega^2) + j(\\omega(\\sigma+2) + \\sigma\\omega)]$$\n$$k = -(\\sigma^2 + 2\\sigma - \\omega^2) - j(2\\sigma\\omega + 2\\omega)$$\n$$k = -(\\sigma^2 + 2\\sigma - \\omega^2) - j(2\\omega(\\sigma+1))$$\n为了让 $k$ 是一个实数，其虚部必须为零：\n$$\\text{Im}\\{k\\} = -2\\omega(\\sigma+1) = 0$$\n当且仅当 $\\omega=0$ 或 $\\sigma=-1$ 时，此条件成立。这两个条件定义了根轨迹在复平面中所有可能的位置。\n\n此外，要使 $s$ 位于 $k \\ge 0$ 的根轨迹上，$k$ 的实数值必须为非负：\n$$\\text{Re}\\{k\\} = -(\\sigma^2 + 2\\sigma - \\omega^2) \\ge 0$$\n这等价于条件：\n$$\\sigma^2 + 2\\sigma - \\omega^2 \\le 0$$\n我们现在分析从虚部条件得出的两个分支。\n\n情况1：$\\omega=0$（轨迹在实轴上）\n如果 $\\omega=0$，$k$ 的非负性条件简化为：\n$$\\sigma^2 + 2\\sigma \\le 0$$\n$$\\sigma(\\sigma+2) \\le 0$$\n此不等式在闭区间 $[-2, 0]$ 内对 $\\sigma$ 成立。因此，实轴上 $s=-2$ 和 $s=0$ 之间的线段是根轨迹的一部分。这些点对应于系统的开环极点，也就是当 $k=0$ 时的闭环极点。\n\n情况2：$\\sigma=-1$（轨迹在一条垂直线上）\n如果 $\\sigma=-1$，$k$ 的非负性条件变为：\n$$(-1)^2 + 2(-1) - \\omega^2 \\le 0$$\n$$1 - 2 - \\omega^2 \\le 0$$\n$$-1 - \\omega^2 \\le 0$$\n此不等式对所有实数值的 $\\omega$ 都成立。因此，由 $\\text{Re}(s) = -1$ 定义的整条垂直线都是根轨迹的一部分。\n\n根轨迹几何形状总结：\n根轨迹由两部分组成：实轴段 $[-2, 0]$ 和垂直线 $\\text{Re}(s) = -1$。\n当 $k=0$ 时，极点位于 $s=-2$ 和 $s=0$。随着 $k$ 的增加，极点沿着实轴相互靠近。它们在两个分支的交点处相遇，即 $s=-1$。为了求出这个分离点的 $k$ 值，我们将 $s=-1$ 代入 $k$ 的方程中：\n$$k = -(-1)(-1+2) = -(-1)(1) = 1$$\n当 $k > 1$ 时，极点成为一对复共轭极点，并沿着直线 $\\text{Re}(s)=-1$ 离开实轴。当 $k \\to \\infty$ 时，极点 $s = -1 \\pm j\\sqrt{k-1}$ 沿着这条垂直线移向无穷大，因此 $|s| \\to \\infty$。这描述了极限行为。\n\n现在，我们确定产生阻尼比 $\\zeta = 0.5$ 的增益 $k$。\n二阶系统的标准特征方程是：\n$$s^2 + 2\\zeta\\omega_n s + \\omega_n^2 = 0$$\n其中 $\\zeta$ 是阻尼比，$\\omega_n$ 是自然频率。\n我们系统的特征方程是：\n$$s^2 + 2s + k = 0$$\n通过比较两个方程的系数，我们建立以下等式：\n$$2\\zeta\\omega_n = 2 \\implies \\zeta\\omega_n = 1$$\n$$\\omega_n^2 = k$$\n我们给定的条件是阻尼比 $\\zeta = 0.5$。将这个值代入第一个等式：\n$$0.5 \\cdot \\omega_n = 1 \\implies \\omega_n = \\frac{1}{0.5} = 2$$\n现在，利用第二个等式，我们可以找到所需的增益 $k$：\n$$k = \\omega_n^2 = 2^2 = 4$$\n对于这个增益，系统是欠阻尼的，这与在 $k > 1$ 的根轨迹上找到的复数极点是一致的。具体来说，当 $k=4$ 时，极点位于 $s = -1 \\pm j\\sqrt{4-1} = -1 \\pm j\\sqrt{3}$。", "answer": "$$\\boxed{4}$$", "id": "2729872"}, {"introduction": "一个常见但极其危险的控制设计误区是试图通过在控制器中引入一个零点来“抵消”对象的不稳定极点。虽然这种零极点对消可能使系统从参考输入到输出的传递函数看起来稳定，但它往往会破坏系统的内部稳定性。本练习旨在揭示这一陷阱，你将通过分析从外部输入（参考信号和扰动）到所有内部信号的传递函数，来严格评估系统的内部稳定性，并亲手计算一个有界的扰动如何激发被掩盖的不稳定模式，从而导致内部状态的无界增长。[@problem_id:2729938]", "problem": "考虑一个单输入单输出 (SISO) 单位反馈互联系统，其被控对象和控制器由下式给出\n$$\nP(s)=\\frac{1}{s-2},\\qquad C(s)=\\frac{s-2}{s+4}.\n$$\n假设所有初始条件均为零。外部信号包括在求和点 ($+$) 输入的参考输入 $r(t)$，以及注入到被控对象输入端的加性扰动 $d(t)$，因此被控对象接收到的输入为 $u(t)+d(t)$，其中 $u(t)$ 是控制信号。测量输出等于被控对象输出 $y(t)$，误差为 $e(t)=r(t)-y(t)$。控制律为 $u(t)$，由算子 $C(s)$ 作用于 $e(t)$ 生成。\n\n仅使用单位反馈互联和单边拉普拉斯变换的定义，完成以下任务。\n\n1. 判断该闭环互联系统是否内部稳定，即由有界外部输入产生的每个内部信号是否均保持有界。您的推理过程必须从单位反馈所蕴含的代数互联关系出发，不得预先假设任何闭环公式。\n\n2. 现在设 $r(t)\\equiv 0$，并施加有界扰动\n$$\nd(t)=\\exp(-t)\\quad\\text{for }t\\ge 0.\n$$\n令 $x_{p}(t)$ 表示 $P(s)$ 最小实现中的被控对象状态，对于该一阶被控对象，其状态与被控对象输出 $y(t)$ 相同。\n计算当 $t\\ge 0$ 时 $x_{p}(t)$ 的精确时域表达式。请将最终答案表示为关于 $t$ 的闭式解析表达式。无需四舍五入，也不包含单位。", "solution": "所给问题是线性控制理论中的一个标准练习题，其提法得当、科学基础扎实且内部逻辑一致。因此，该问题被认定为有效。我们将着手进行分析。\n\n该问题需要进行两部分分析：首先，评估单位反馈控制系统的内部稳定性；其次，计算一个特定的时域响应。\n\n首先，我们来解决内部稳定性问题。分析必须基于基本原理，从反馈回路的定义代数方程开始。假设初始条件为零，该系统在拉普拉斯域中由以下方程描述：\n$$\nY(s) = P(s)[U(s) + D(s)]\n$$\n$$\nU(s) = C(s)E(s)\n$$\n$$\nE(s) = R(s) - Y(s)\n$$\n此处，$Y(s)$ 是被控对象输出，$U(s)$ 是控制信号，$E(s)$ 是误差信号，$R(s)$ 是参考输入，$D(s)$ 是扰动输入。被控对象和控制器的传递函数分别为 $P(s) = \\frac{1}{s-2}$ 和 $C(s) = \\frac{s-2}{s+4}$。\n\n内部稳定性要求从任意外部输入（$R(s)$、$D(s)$）到任意内部信号（$Y(s)$、$E(s)$、$U(s)$）的每个传递函数都是稳定的。也就是说，这些传递函数的所有极点都必须位于复平面的开左半平面。\n\n我们推导内部信号 $Y(s)$ 和 $U(s)$ 关于外部输入 $R(s)$ 和 $D(s)$ 的传递函数。首先，我们通过代入 $U(s)$ 和 $E(s)$ 的表达式来求解输出 $Y(s)$：\n$$\nY(s) = P(s)[C(s)(R(s) - Y(s)) + D(s)]\n$$\n$$\nY(s) = P(s)C(s)R(s) - P(s)C(s)Y(s) + P(s)D(s)\n$$\n合并包含 $Y(s)$ 的项：\n$$\nY(s)(1 + P(s)C(s)) = P(s)C(s)R(s) + P(s)D(s)\n$$\n因此，输出为：\n$$\nY(s) = \\frac{P(s)C(s)}{1 + P(s)C(s)} R(s) + \\frac{P(s)}{1 + P(s)C(s)} D(s)\n$$\n接着，我们求解控制信号 $U(s)$。我们从 $U(s) = C(s)E(s) = C(s)(R(s) - Y(s))$ 开始，并代入 $Y(s)$ 的表达式：\n$$\nU(s) = C(s) \\left( R(s) - \\left[ \\frac{P(s)C(s)}{1 + P(s)C(s)} R(s) + \\frac{P(s)}{1 + P(s)C(s)} D(s) \\right] \\right)\n$$\n$$\nU(s) = C(s) \\left( \\frac{1 + P(s)C(s) - P(s)C(s)}{1 + P(s)C(s)} R(s) - \\frac{P(s)}{1 + P(s)C(s)} D(s) \\right)\n$$\n$$\nU(s) = \\frac{C(s)}{1 + P(s)C(s)} R(s) - \\frac{P(s)C(s)}{1 + P(s)C(s)} D(s)\n$$\n现在我们计算 $1 + P(s)C(s)$ 这一项。注意在环路增益 $L(s) = P(s)C(s)$ 中存在极点-零点对消：\n$$\nL(s) = P(s)C(s) = \\left(\\frac{1}{s-2}\\right) \\left(\\frac{s-2}{s+4}\\right) = \\frac{1}{s+4}\n$$\n灵敏度函数的分母为：\n$$\n1 + P(s)C(s) = 1 + \\frac{1}{s+4} = \\frac{s+4+1}{s+4} = \\frac{s+5}{s+4}\n$$\n现在我们将此结果代入四个关键传递函数的表达式中：\n1.  从参考输入 $R(s)$ 到输出 $Y(s)$：\n    $$T_{YR}(s) = \\frac{P(s)C(s)}{1 + P(s)C(s)} = \\frac{1/(s+4)}{(s+5)/(s+4)} = \\frac{1}{s+5}$$\n    该传递函数是稳定的，其极点位于 $s=-5$。\n\n2.  从扰动 $D(s)$ 到输出 $Y(s)$：\n    $$T_{YD}(s) = \\frac{P(s)}{1 + P(s)C(s)} = \\frac{1/(s-2)}{(s+5)/(s+4)} = \\frac{s+4}{(s-2)(s+5)}$$\n    该传递函数是**不稳定**的，因为在 $s=2$ 处存在一个极点，该极点源于在环路增益计算中被对消掉的不稳定被控对象极点。\n\n3.  从参考输入 $R(s)$ 到控制信号 $U(s)$：\n    $$T_{UR}(s) = \\frac{C(s)}{1 + P(s)C(s)} = \\frac{(s-2)/(s+4)}{(s+5)/(s+4)} = \\frac{s-2}{s+5}$$\n    该传递函数是稳定的，其极点位于 $s=-5$。\n\n4.  从扰动 $D(s)$ 到控制信号 $U(s)$：\n    $$T_{UD}(s) = -\\frac{P(s)C(s)}{1 + P(s)C(s)} = -\\frac{1/(s+4)}{(s+5)/(s+4)} = -\\frac{1}{s+5}$$\n    该传递函数是稳定的，其极点位于 $s=-5$。\n\n由于传递函数 $T_{YD}(s)$ 在右半平面（$s=2$ 处）有一个极点，因此该系统是**非内部稳定**的。一个有界的扰动 $d(t)$ 会导致无界的输出 $y(t)$。被控对象 $P(s)$ 的不稳定极点对于参考输入 $r(t)$ 是不可观的，但对于扰动输入 $d(t)$ 是可观的。\n\n对于问题的第二部分，我们必须计算被控对象状态 $x_p(t)$ 的时域表达式，题目已给出它等于被控对象输出 $y(t)$。条件是 $r(t) = 0$（因此 $R(s)=0$）以及当 $t \\ge 0$ 时 $d(t) = \\exp(-t)$。扰动的拉普拉斯变换为 $D(s) = \\mathcal{L}\\{\\exp(-t)\\} = \\frac{1}{s+1}$。\n\n因为 $R(s)=0$，输出 $Y(s)$ 由下式给出：\n$$\nY(s) = T_{YD}(s) D(s) = \\left( \\frac{s+4}{(s-2)(s+5)} \\right) \\left( \\frac{1}{s+1} \\right) = \\frac{s+4}{(s-2)(s+1)(s+5)}\n$$\n为了求得拉普拉斯逆变换 $y(t)$，我们对 $Y(s)$ 进行部分分式展开：\n$$\nY(s) = \\frac{A}{s-2} + \\frac{B}{s+1} + \\frac{C}{s+5}\n$$\n我们计算留数 $A$、$B$ 和 $C$：\n$$\nA = \\lim_{s \\to 2} (s-2)Y(s) = \\left. \\frac{s+4}{(s+1)(s+5)} \\right|_{s=2} = \\frac{2+4}{(2+1)(2+5)} = \\frac{6}{3 \\cdot 7} = \\frac{2}{7}\n$$\n$$\nB = \\lim_{s \\to -1} (s+1)Y(s) = \\left. \\frac{s+4}{(s-2)(s+5)} \\right|_{s=-1} = \\frac{-1+4}{(-1-2)(-1+5)} = \\frac{3}{(-3)(4)} = -\\frac{1}{4}\n$$\n$$\nC = \\lim_{s \\to -5} (s+5)Y(s) = \\left. \\frac{s+4}{(s-2)(s+1)} \\right|_{s=-5} = \\frac{-5+4}{(-5-2)(-5+1)} = \\frac{-1}{(-7)(-4)} = -\\frac{1}{28}\n$$\n所以，$Y(s)$ 的展开形式为：\n$$\nY(s) = \\frac{2/7}{s-2} - \\frac{1/4}{s+1} - \\frac{1/28}{s+5}\n$$\n对上式逐项进行拉普拉斯逆变换，得到 $t \\ge 0$ 时的 $y(t)$：\n$$\ny(t) = \\frac{2}{7}\\mathcal{L}^{-1}\\left\\{\\frac{1}{s-2}\\right\\} - \\frac{1}{4}\\mathcal{L}^{-1}\\left\\{\\frac{1}{s+1}\\right\\} - \\frac{1}{28}\\mathcal{L}^{-1}\\left\\{\\frac{1}{s+5}\\right\\}\n$$\n$$\ny(t) = \\frac{2}{7}\\exp(2t) - \\frac{1}{4}\\exp(-t) - \\frac{1}{28}\\exp(-5t)\n$$\n题目说明被控对象状态 $x_p(t)$ 等于被控对象输出 $y(t)$。因此，$x_p(t)$ 的表达式与此相同。$\\exp(2t)$ 项的存在（该项会无界增长）证实了我们先前关于内部不稳定性的结论。", "answer": "$$\n\\boxed{\\frac{2}{7}\\exp(2t) - \\frac{1}{4}\\exp(-t) - \\frac{1}{28}\\exp(-5t)}\n$$", "id": "2729938"}, {"introduction": "在理解了反馈的基本原理和潜在陷阱之后，我们如何系统地设计一个高性能的控制器？本练习将通过一个具体案例，让你对比两种截然不同的控制策略：纯粹的开环前馈控制与基于状态反馈的闭环最优控制——线性二次调节器（LQR）。通过为同一个系统分别设计这两种控制器并分析其动态特性，你将深刻体会到开环与闭环设计的本质区别，并见证反馈控制在主动重塑系统响应以实现性能最优化方面的强大能力。[@problem_id:2730005]", "problem": "考虑一个连续时间线性时不变 (LTI) 系统，其状态向量为 $x \\in \\mathbb{R}^{2}$，输入为 $u \\in \\mathbb{R}$，输出为 $y \\in \\mathbb{R}$，由下式给出\n$$\n\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t),\n$$\n其中\n$$\nA = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1 & 0 \\end{bmatrix}.\n$$\n您将使用线性二次调节器 (LQR) 方法设计一个状态反馈控制器，并将其与一个为实现无状态反馈的参考跟踪而设计的纯开环前馈输入进行比较。\n\n闭环设计任务：设性能指标为标准的无限时域二次型成本\n$$\nJ(u) = \\int_{0}^{\\infty} \\left( x(t)^{\\top} Q \\, x(t) + u(t)^{\\top} R \\, u(t) \\right) \\, dt,\n$$\n其中 $Q = I_{2}$ 且 $R = 1$。使用最优控制的基本框架（Pontryagin 最小原理和连续时间代数 Riccati 方程），确定控制律 $u(t) = -K x(t)$ 的最优状态反馈增益 $K \\in \\mathbb{R}^{1 \\times 2}$，并计算 $A - B K$ 的两个闭环极点位置。\n\n开环前馈比较：考虑在没有状态反馈的情况下，通过选择一个恒定的前馈输入 $u(t) = N r$ 来跟踪一个常数参考 $r \\in \\mathbb{R}$，该输入在理想的系统知识和零扰动条件下实现对常数参考的零稳态误差。根据第一性原理（稳态方程）确定静态前馈增益 $N \\in \\mathbb{R}$，然后确定在零初始条件 $x(0) = 0$ 下，对于单位阶跃参考 $r(t) = 1 \\cdot \\mathbf{1}_{\\{t \\ge 0\\}}$，控制跟踪误差动态 $e(t) = y(t) - r$ 的两个极点。\n\n答案规格：\n- 将您的最终答案表示为一个单行矩阵，其元素按顺序为：$k_{1}$、$k_{2}$、$s_{\\mathrm{cl},1}$、$s_{\\mathrm{cl},2}$、$N$、$s_{\\mathrm{ol},1}$、$s_{\\mathrm{ol},2}$。\n- 不要四舍五入；提供精确的解析表达式。\n- 不需要物理单位。", "solution": "我们从使用线性二次调节器 (LQR) 的闭环设计开始。对于动态方程为 $\\dot{x} = A x + B u$、成本函数为 $J(u) = \\int_{0}^{\\infty} (x^{\\top} Q x + u^{\\top} R u) \\, dt$ 的无限时域连续时间 LQR 问题，其最优状态反馈控制为 $u = -K x$，其中增益 $K$ 由下式给出\n$$\nK = R^{-1} B^{\\top} P,\n$$\n且 $P = P^{\\top} \\succeq 0$ 是连续时间代数 Riccati 方程 (ARE) 的唯一稳定化解：\n$$\nA^{\\top} P + P A - P B R^{-1} B^{\\top} P + Q = 0.\n$$\n这些关系源于 Pontryagin 最小原理和 Hamilton–Jacobi–Bellman 框架，它们确保了最优协态 $\\lambda$ 与状态 $x$ 呈线性关系，即 $\\lambda = P x$，并且平稳性条件得出 $u = -R^{-1} B^{\\top} \\lambda = -R^{-1} B^{\\top} P x$。\n\n给定 $A = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix}$，$B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$，$Q = I_{2}$，以及 $R = 1$，设\n$$\nP = \\begin{bmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{bmatrix}.\n$$\n计算代数 Riccati 方程中的各项：\n- 首先，$A^{\\top} = \\begin{bmatrix} 0 & -2 \\\\ 1 & -3 \\end{bmatrix}$。\n- 接着，\n$$\nA^{\\top} P = \\begin{bmatrix} -2 p_{12} & -2 p_{22} \\\\ p_{11} - 3 p_{12} & p_{12} - 3 p_{22} \\end{bmatrix},\n\\quad\nP A = \\begin{bmatrix} -2 p_{12} & p_{11} - 3 p_{12} \\\\ -2 p_{22} & p_{12} - 3 p_{22} \\end{bmatrix}.\n$$\n因此，\n$$\nA^{\\top} P + P A = \\begin{bmatrix} -4 p_{12} & p_{11} - 3 p_{12} - 2 p_{22} \\\\ p_{11} - 3 p_{12} - 2 p_{22} & 2 p_{12} - 6 p_{22} \\end{bmatrix}.\n$$\n- 由于 $R = 1$ 且 $B B^{\\top} = \\begin{bmatrix} 0 & 0 \\\\ 0 & 1 \\end{bmatrix}$，我们有\n$$\nP B R^{-1} B^{\\top} P = P B B^{\\top} P = (P B) (B^{\\top} P) = \\begin{bmatrix} p_{12} \\\\ p_{22} \\end{bmatrix} \\begin{bmatrix} p_{12} & p_{22} \\end{bmatrix} = \\begin{bmatrix} p_{12}^{2} & p_{12} p_{22} \\\\ p_{12} p_{22} & p_{22}^{2} \\end{bmatrix}.\n$$\n代数 Riccati 方程 $A^{\\top} P + P A - P B B^{\\top} P + Q = 0$ 得出以下按元素表示的方程组\n$$\n\\begin{aligned}\n& (1,1): && -4 p_{12} - p_{12}^{2} + 1 = 0, \\\\\n& (1,2): && p_{11} - 3 p_{12} - 2 p_{22} - p_{12} p_{22} = 0, \\\\\n& (2,2): && 2 p_{12} - 6 p_{22} - p_{22}^{2} + 1 = 0.\n\\end{aligned}\n$$\n从 $(1,1)$ 式，我们得到一个关于 $p_{12}$ 的标量二次方程：\n$$\np_{12}^{2} + 4 p_{12} - 1 = 0 \\quad \\Rightarrow \\quad p_{12} = -2 \\pm \\sqrt{5}.\n$$\n稳定化解 $P \\succeq 0$ 要求选择 $p_{12} = -2 + \\sqrt{5}$ (另一个选择 $p_{12} = -2 - \\sqrt{5}$ 会在下面计算中得到非正的 $p_{22}$)。使用 $(2,2)$ 式，\n$$\n2 p_{12} - 6 p_{22} - p_{22}^{2} + 1 = 0 \\;\\; \\Rightarrow \\;\\; p_{22}^{2} + 6 p_{22} - (2 p_{12} + 1) = 0,\n$$\n所以\n$$\np_{22} = -3 \\pm \\sqrt{9 + 2 p_{12} + 1} = -3 \\pm \\sqrt{10 + 2 p_{12}}.\n$$\n当 $p_{12} = -2 + \\sqrt{5}$ 时，\n$$\n10 + 2 p_{12} = 10 + 2(-2 + \\sqrt{5}) = 6 + 2 \\sqrt{5} = (\\sqrt{5} + 1)^{2},\n$$\n因此\n$$\np_{22} = -3 \\pm (\\sqrt{5} + 1).\n$$\n正值的选择是 $p_{22} = -3 + (\\sqrt{5} + 1) = -2 + \\sqrt{5}$，这恰好等于 $p_{12}$。最后，从 $(1,2)$ 式，\n$$\np_{11} = 3 p_{12} + 2 p_{22} + p_{12} p_{22} = 5 p_{12} + p_{12}^{2}.\n$$\n当 $p_{12} = -2 + \\sqrt{5}$ 时，我们计算\n$$\np_{12}^{2} = (-2 + \\sqrt{5})^{2} = 9 - 4 \\sqrt{5},\n$$\n所以\n$$\np_{11} = 5(-2 + \\sqrt{5}) + (9 - 4 \\sqrt{5}) = -1 + \\sqrt{5}.\n$$\n因此，\n$$\nP = \\begin{bmatrix} -1 + \\sqrt{5} & -2 + \\sqrt{5} \\\\ -2 + \\sqrt{5} & -2 + \\sqrt{5} \\end{bmatrix}, \\quad\nK = R^{-1} B^{\\top} P = \\begin{bmatrix} -2 + \\sqrt{5} & -2 + \\sqrt{5} \\end{bmatrix}.\n$$\n\n我们现在计算闭环极点。闭环矩阵为\n$$\nA_{\\mathrm{cl}} = A - B K = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix} - \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} -2 + \\sqrt{5} & -2 + \\sqrt{5} \\end{bmatrix} = \\begin{bmatrix} 0 & 1 \\\\ -2 - a & -3 - a \\end{bmatrix},\n$$\n其中 $a = -2 + \\sqrt{5}$。其特征多项式为\n$$\n\\chi_{\\mathrm{cl}}(s) = s^{2} - \\operatorname{tr}(A_{\\mathrm{cl}}) s + \\det(A_{\\mathrm{cl}}) = s^{2} + (3 + a) s + (2 + a).\n$$\n由于 $a = -2 + \\sqrt{5}$，我们有 $3 + a = 1 + \\sqrt{5}$ 和 $2 + a = \\sqrt{5}$。因此\n$$\n\\chi_{\\mathrm{cl}}(s) = s^{2} + (1 + \\sqrt{5}) s + \\sqrt{5}.\n$$\n根为\n$$\ns_{\\mathrm{cl},1,2} = \\frac{-(1 + \\sqrt{5}) \\pm \\sqrt{(1 + \\sqrt{5})^{2} - 4 \\sqrt{5}}}{2} = \\frac{-(1 + \\sqrt{5}) \\pm (\\sqrt{5} - 1)}{2},\n$$\n计算可得\n$$\ns_{\\mathrm{cl},1} = -1, \\quad s_{\\mathrm{cl},2} = -\\sqrt{5}.\n$$\n\n接下来，我们设计开环前馈 $u(t) = N r$ 以在没有状态反馈的情况下跟踪常数参考 $r \\in \\mathbb{R}$ 并实现零稳态误差。对于恒定稳态 $(\\dot{x} = 0)$，\n$$\n0 = A x_{\\mathrm{ss}} + B u_{\\mathrm{ss}}, \\quad y_{\\mathrm{ss}} = C x_{\\mathrm{ss}}.\n$$\n求解 $x_{\\mathrm{ss}} = -A^{-1} B u_{\\mathrm{ss}}$ (因为 $A$ 是非奇异的) 可得\n$$\ny_{\\mathrm{ss}} = C x_{\\mathrm{ss}} = - C A^{-1} B \\, u_{\\mathrm{ss}}.\n$$\n为使任意常数 $r$ 都有 $y_{\\mathrm{ss}} = r$，选择 $u_{\\mathrm{ss}} = N r$，其中\n$$\nN = \\left( - C A^{-1} B \\right)^{-1}.\n$$\n我们通过求解 $A v = B$ 来计算 $A^{-1} B$：\n$$\n\\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix} \\begin{bmatrix} v_{1} \\\\ v_{2} \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\n\\;\\; \\Rightarrow \\;\\; v_{2} = 0, \\; -2 v_{1} = 1 \\;\\; \\Rightarrow \\;\\; v_{1} = -\\frac{1}{2}.\n$$\n因此 $A^{-1} B = \\begin{bmatrix} -\\frac{1}{2} \\\\ 0 \\end{bmatrix}$ 且\n$$\n- C A^{-1} B = - \\begin{bmatrix} 1 & 0 \\end{bmatrix} \\begin{bmatrix} -\\frac{1}{2} \\\\ 0 \\end{bmatrix} = \\frac{1}{2},\n$$\n所以\n$$\nN = \\left( \\frac{1}{2} \\right)^{-1} = 2.\n$$\n\n为比较动态行为，考虑在开环前馈 $u(t) = N r(t)$、单位阶跃参考 $r(t) = 1 \\cdot \\mathbf{1}_{\\{t \\ge 0\\}}$ 和零初始状态 $x(0) = 0$ 的条件下，跟踪误差 $e(t) = y(t) - r(t)$。当 $t \\ge 0$ 时，$u(t) = N$。状态遵循 $\\dot{x} = A x + B N$（输入为常数），稳态满足 $x_{\\mathrm{ss}} = -A^{-1} B N$ 和 $y_{\\mathrm{ss}} = C x_{\\mathrm{ss}} = r = 1$。误差动态由下式给出\n$$\n\\dot{e}(t) = \\frac{d}{dt} \\left( C x(t) - r \\right) = C \\dot{x}(t) = C A x(t) + C B N = C A \\left( x(t) - x_{\\mathrm{ss}} \\right),\n$$\n因为 $C B N = - C A x_{\\mathrm{ss}}$。因此 $e(t)$ 在由 $A$ 决定的齐次动态下演化，其极点是 $A$ 的特征值，也就是 $s^{2} + 3 s + 2 = 0$ 的根，即\n$$\ns_{\\mathrm{ol},1} = -1, \\quad s_{\\mathrm{ol},2} = -2.\n$$\n\n按规定顺序收集所求的量：\n- $k_{1} = -2 + \\sqrt{5}$,\n- $k_{2} = -2 + \\sqrt{5}$,\n- $s_{\\mathrm{cl},1} = -1$,\n- $s_{\\mathrm{cl},2} = -\\sqrt{5}$,\n- $N = 2$,\n- $s_{\\mathrm{ol},1} = -1$,\n- $s_{\\mathrm{ol},2} = -2$.\n\n这表明，状态反馈 LQR 将一个极点从 $-2$ 移至 $-\\sqrt{5}$，同时将另一个极点保持在 $-1$ 不变，而纯开环前馈的误差动态则保留了系统原有的开环极点 $-1$ 和 $-2$。", "answer": "$$\\boxed{\\begin{pmatrix}-2+\\sqrt{5} & -2+\\sqrt{5} & -1 & -\\sqrt{5} & 2 & -1 & -2\\end{pmatrix}}$$", "id": "2730005"}]}