{"hands_on_practices": [{"introduction": "一个系统的可控性不仅是一个简单的“是”或“否”的属性，它与状态空间的结构有着深刻的联系。这个练习将引导你亲手将可控性这一系统属性与状态空间 $\\mathbb{R}^n$ 的几何基础联系起来。通过从可控性矩阵的列向量中构造一个状态空间的基，你将把一个抽象的代数测试转化为一组具体的、能够张成整个状态空间的向量，从而加深对线性系统基本原理的理解。[@problem_id:2757663]", "problem": "设 $\\dot{x}(t) = A x(t) + B u(t)$ 是一个有限维线性时不变（LTI）系统，其中 $A \\in \\mathbb{R}^{n \\times n}$ 且 $B \\in \\mathbb{R}^{n \\times m}$。在任意非平凡时间区间内，从原点出发的可达子空间等于形如 $A^{k} b_{j}$ 的向量的线性张成，其中 $k \\in \\{0,1,\\dots,n-1\\}$ 且 $b_{j}$ 是 $B$ 的第 $j$ 列。如果可达子空间等于 $\\mathbb{R}^{n}$，则称矩阵对 $(A,B)$ 是可控的。\n\n1) 从向量空间中可达性和线性张成的定义出发，并且只使用线性的基本性质，证明当 $(A,B)$ 可控时，可控性矩阵\n$$\n\\mathcal{C}(A,B) \\coloneqq \\big[\\, B \\;\\; A B \\;\\; A^{2} B \\;\\; \\dots \\;\\; A^{n-1} B \\,\\big]\n$$\n的列向量集合张成 $\\mathbb{R}^{n}$，因此从 $\\mathcal{C}(A,B)$ 中任选 $n$ 个线性无关的列向量都构成 $\\mathbb{R}^{n}$ 的一个基。\n\n2) 根据线性无关性和子空间的分级序列 $\\mathcal{R}_{k} \\coloneqq \\operatorname{span}\\{B,AB,\\dots,A^{k}B\\}$，描述从 $\\mathcal{C}(A,B)$ 的列向量中选取的基是唯一的条件。您的讨论应指出结构特征（例如，输入数量和秩增量模式 $\\operatorname{rank}(\\mathcal{R}_{k}) - \\operatorname{rank}(\\mathcal{R}_{k-1})$），这些特征是导致唯一性还是非唯一性，并明确说明排序和归一化选择如何影响结果。\n\n3) 考虑一个具体的4状态、2输入系统，其矩阵为\n$$\nA \\,=\\, \\begin{bmatrix}\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n-1 & -2 & -3 & -4\n\\end{bmatrix},\n\\qquad\nB \\,=\\, \\begin{bmatrix}\n0 & 0 \\\\\n0 & 0 \\\\\n1 & 0 \\\\\n0 & 1 \n\\end{bmatrix}.\n$$\n构建可控性矩阵 $\\mathcal{C}(A,B)$，并从左到右选择前 $n=4$ 个线性无关的列来组建一个基矩阵 $T \\in \\mathbb{R}^{4 \\times 4}$（即，$T$ 的列是这四个列向量，并保持相同顺序）。计算行列式 $\\det(T)$。将最终答案表示为一个精确整数（无需舍入）。", "solution": "问题陈述科学严谨、定义明确且内容完整。它提出了一系列线性控制理论中的标准问题。我将着手解决。\n\n### 第1部分：可控性秩条件的证明\n\n问题定义了一个线性时不变（LTI）系统 $\\dot{x}(t) = A x(t) + B u(t)$，其中 $x \\in \\mathbb{R}^n$，$A \\in \\mathbb{R}^{n \\times n}$，$B \\in \\mathbb{R}^{n \\times m}$。设输入矩阵 $B$ 的列向量记为 $b_j$，其中 $j \\in \\{1, 2, \\dots, m\\}$。\n\n问题提供了两个关键定义作为前提：\n1. 从原点出发的可达子空间，记为 $\\mathcal{R}$，定义为向量集合 $S = \\{A^k b_j \\mid k \\in \\{0, 1, \\dots, n-1\\}, j \\in \\{1, \\dots, m\\}\\}$ 的线性张成。用数学符号表示，即 $\\mathcal{R} \\coloneqq \\operatorname{span}(S)$。\n2. 矩阵对 $(A, B)$ 是可控的当且仅当可达子空间是整个状态空间，即 $\\mathcal{R} = \\mathbb{R}^n$。\n\n可控性矩阵定义为\n$$\n\\mathcal{C}(A,B) \\coloneqq \\big[\\, B \\;\\; A B \\;\\; A^{2} B \\;\\; \\dots \\;\\; A^{n-1} B \\,\\big]\n$$\n该矩阵由拼接块 $A^k B$ 构成，其中 $k = 0, \\dots, n-1$。每个块 $A^k B$ 由列向量 $A^k b_1, A^k b_2, \\dots, A^k b_m$ 组成。\n\n可控性矩阵 $\\mathcal{C}(A,B)$ 的所有列的集合恰好是前提中定义的集合 $S$。也就是说，$\\mathcal{C}(A,B)$ 的列向量是对于所有 $k \\in \\{0, \\dots, n-1\\}$ 和 $j \\in \\{1, \\dots, m\\}$ 的向量 $\\{A^k b_j\\}$。\n\n根据线性张成的定义，由 $\\mathcal{C}(A,B)$ 的列向量张成的空间是 $\\operatorname{span}(S)$。根据问题的第一个前提，这就是可达子空间 $\\mathcal{R}$。\n$$\n\\operatorname{span}(\\text{$\\mathcal{C}(A,B)$ 的列}) = \\operatorname{span}(S) = \\mathcal{R}\n$$\n\n问题要求我们假设矩阵对 $(A,B)$ 是可控的。根据第二个前提，这意味着 $\\mathcal{R} = \\mathbb{R}^n$。\n将此代入我们之前的发现，我们得到结论：\n$$\n\\operatorname{span}(\\text{$\\mathcal{C}(A,B)$ 的列}) = \\mathbb{R}^n\n$$\n这证明了当 $(A,B)$ 可控时，可控性矩阵 $\\mathcal{C}(A,B)$ 的列向量张成状态空间 $\\mathbb{R}^n$。\n\n像 $\\mathbb{R}^n$ 这样的 n 维向量空间的基被定义为任何张成该空间的 $n$ 个线性无关向量的集合。由于 $\\mathcal{C}(A,B)$ 的列向量构成了 $\\mathbb{R}^n$ 的一个张成集，根据基的定义，这些列向量中任何包含恰好 $n$ 个线性无关向量的子集都构成了 $\\mathbb{R}^n$ 的一个基。\n\n### 第2部分：从可控性矩阵中选取的基的唯一性\n\n从可控性矩阵 $\\mathcal{C}(A,B)$ 的列向量中选取的基是否唯一，关键取决于输入的数量 $m$。\n\n首先，考虑“从 $\\mathcal{C}(A,B)$ 的列中选取的基”这一陈述。这意味着我们选择 $\\mathcal{C}(A,B)$ 的列向量的一个子集，这些向量是按原样给出的，不允许任意缩放（归一化）或线性组合。我们讨论的是这个所选向量*集合*的唯一性。\n\n情况1：单输入系统 ($m=1$)\n如果系统是单输入的，那么 $B$ 是一个 $n \\times 1$ 的列向量，我们记为 $b$。可控性矩阵为\n$$\n\\mathcal{C}(A,b) = \\big[\\, b \\;\\; Ab \\;\\; A^2 b \\;\\; \\dots \\;\\; A^{n-1}b \\,\\big]\n$$\n这是一个 $n \\times n$ 的矩阵。为了使矩阵对 $(A,b)$ 可控，$\\mathcal{C}(A,b)$ 的列必须张成 $\\mathbb{R}^n$。由于恰好有 $n$ 列，要让它们张成 n 维空间 $\\mathbb{R}^n$，它们必须是线性无关的。\n在这种情况下，$\\mathcal{C}(A,b)$ 中恰好有 $n$ 个列向量，并且需要所有这 $n$ 个向量来构成一个基。因此，只有一种可能的向量集可供选择：$\\mathcal{C}(A,b)$ 的全部列向量集合。基向量的选择是唯一的。\n排序和归一化：如果基中向量的顺序很重要，那么基 $[b, Ab, \\dots, A^{n-1}b]$ 也是唯一的。如果允许排列，则有 $n!$ 个可能的有序基。由于问题的措辞没有提到归一化，我们假设按原样取用列向量。\n\n情况2：多输入系统 ($m>1$)\n如果系统是多输入的，可控性矩阵 $\\mathcal{C}(A,B)$ 是一个 $n \\times (nm)$ 的矩阵。由于 $m>1$，列数 $nm$ 严格大于状态空间的维数 $n$。\n为了使矩阵对 $(A,B)$ 可控，这个 $n \\times (nm)$ 矩阵的秩必须为 $n$。这意味着这 $nm$ 个列向量的集合张成 $\\mathbb{R}^n$。由于这个张成集中有多于 $n$ 个向量，所以该集合必须是线性相关的。\n$\\mathcal{C}(A,B)$ 列向量之间的线性相关性意味着存在多种不同的方式来选择一个包含 $n$ 个线性无关列的子集。举一个简单的例子，如果列 $c_1, c_2, \\dots, c_n$ 构成一个基，而另一列 $c_{n+1}$ 可以写成其中一些列的线性组合，比如说 $c_{n+1} = \\alpha_1 c_1 + \\dots + \\alpha_n c_n$ 且 $\\alpha_1 \\neq 0$，那么我们可以用 $c_{n+1}$ 替换 $c_1$ 以形成一个新的基 $\\{c_{n+1}, c_2, \\dots, c_n\\}$。只要 $c_{n+1}$ 不是 $c_1$ 的标量倍，并且是 $\\mathcal{C}(A,B)$ 中一个不同的列，这个新的基向量集合就与原来的不同。当 $nm > n$ 时，这种相关性必然存在。因此，对于任何可控的多输入系统，从 $\\mathcal{C}(A,B)$ 的列中选择的基**绝不**是唯一的。\n\n子空间的分级序列 $\\mathcal{R}_k = \\operatorname{span}\\{B, AB, \\dots, A^k B\\}$ 和秩增量 $\\nu_k = \\operatorname{rank}(\\mathcal{R}_k) - \\operatorname{rank}(\\mathcal{R}_{k-1})$（其中 $\\mathcal{R}_{-1}=\\{0\\}$）阐明了这种非唯一性。在每一步 $k$，我们必须从 $A^k B$ 的列中找到 $\\nu_k$ 个新的基向量，这些向量与 $\\mathcal{R}_{k-1}$ 线性无关。对于 $m>1$，通常情况下，$A^k B$ 中可用于提供这些新方向的候选列数可能大于 $\\nu_k$，从而产生了选择。例如，在步骤 $k=0$ 时，我们必须选择 $\\nu_0 = \\operatorname{rank}(B)$ 个向量。如果 $m > \\operatorname{rank}(B)$，则有多种方法从 $B$ 的列中为其像空间选择一个基。\n\n总之，决定唯一性的结构特征是输入数量 $m$：\n-   当且仅当 $m=1$ 时，基向量集合的唯一性得到保证。\n-   当 $m>1$ 时，非唯一性得到保证。\n\n### 第3部分：具体例子与行列式计算\n\n给定一个 $n=4$ 个状态和 $m=2$ 个输入的系统：\n$$\nA \\,=\\, \\begin{bmatrix}\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n-1 & -2 & -3 & -4\n\\end{bmatrix},\n\\qquad\nB \\,=\\, \\begin{bmatrix}\n0 & 0 \\\\\n0 & 0 \\\\\n1 & 0 \\\\\n0 & 1 \n\\end{bmatrix} \\,=\\, [b_1, b_2]\n$$\n可控性矩阵是 $\\mathcal{C}(A,B) = [B, AB, A^2 B, A^3 B]$。我们需要从左到右搜索，找到前 4 个线性无关的列。\n\n前两列是 $B$ 的列：\n$c_1 = b_1 = [0, 0, 1, 0]^T$\n$c_2 = b_2 = [0, 0, 0, 1]^T$\n这两个向量是线性无关的。到目前为止，我们的基是 $\\{c_1, c_2\\}$。\n\n接下来，我们计算 $AB$ 的列：\n$$\nAB = \\begin{bmatrix}\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n-1 & -2 & -3 & -4\n\\end{bmatrix}\n\\begin{bmatrix}\n0 & 0 \\\\\n0 & 0 \\\\\n1 & 0 \\\\\n0 & 1 \n\\end{bmatrix} = \\begin{bmatrix}\n0 & 0 \\\\\n1 & 0 \\\\\n0 & 1 \\\\\n-3 & -4\n\\end{bmatrix}\n$$\n$\\mathcal{C}(A,B)$ 的接下来两列是：\n$c_3 = Ab_1 = [0, 1, 0, -3]^T$\n$c_4 = Ab_2 = [0, 0, 1, -4]^T$\n\n我们检查 $c_3$ 是否在 $\\{c_1, c_2\\}$ 的张成空间中。任何在 $\\operatorname{span}\\{c_1, c_2\\}$ 中的向量形式为 $[\\alpha \\cdot 0 + \\beta \\cdot 0, \\alpha \\cdot 0 + \\beta \\cdot 0, \\alpha \\cdot 1, \\beta \\cdot 1]^T = [0, 0, \\alpha, \\beta]^T$。由于 $c_3$ 的第二个分量非零，所以它与 $c_1$ 和 $c_2$ 线性无关。我们将 $c_3$ 加入我们的基，现在基为 $\\{c_1, c_2, c_3\\}$。\n\n接下来，我们检查 $c_4$ 是否在 $\\{c_1, c_2, c_3\\}$ 的张成空间中。我们测试是否存在标量 $\\alpha, \\beta, \\gamma$ 使得 $c_4 = \\alpha c_1 + \\beta c_2 + \\gamma c_3$。\n$$\n\\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ -4 \\end{bmatrix} = \\alpha \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{bmatrix} + \\beta \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix} + \\gamma \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -3 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ \\gamma \\\\ \\alpha \\\\ \\beta - 3\\gamma \\end{bmatrix}\n$$\n比较各分量得到 $\\gamma=0$，$\\alpha=1$，以及 $\\beta-3\\gamma = -4 \\Rightarrow \\beta = -4$。这与方程组一致。我们发现 $c_4 = 1 \\cdot c_1 - 4 \\cdot c_2$。所以，$c_4$ 与前面的列线性相关。我们必须跳过它。\n\n我们需要第四个线性无关的向量。我们继续处理 $\\mathcal{C}(A,B)$ 的下一列，即 $A^2 B$ 的第一列，也就是 $A^2 b_1 = A(Ab_1) = Ac_3$。\n$c_5 = A c_3 = \\begin{bmatrix}\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n-1 & -2 & -3 & -4\n\\end{bmatrix}\n\\begin{bmatrix}\n0 \\\\\n1 \\\\\n0 \\\\\n-3\n\\end{bmatrix} = \\begin{bmatrix}\n1 \\\\\n0 \\\\\n-3 \\\\\n-2+12\n\\end{bmatrix} = \\begin{bmatrix}\n1 \\\\\n0 \\\\\n-3 \\\\\n10\n\\end{bmatrix}$\n\n我们检查 $c_5$ 是否在 $\\{c_1, c_2, c_3\\}$ 的张成空间中。\n$$\n\\begin{bmatrix} 1 \\\\ 0 \\\\ -3 \\\\ 10 \\end{bmatrix} = \\alpha \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{bmatrix} + \\beta \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix} + \\gamma \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -3 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ \\gamma \\\\ \\alpha \\\\ \\beta - 3\\gamma \\end{bmatrix}\n$$\n比较第一个分量得出 $1=0$，这是一个矛盾。因此，$c_5$ 与 $\\{c_1, c_2, c_3\\}$ 线性无关。\n\n我们已经找到了按从左到右顺序选择的四个线性无关的列：$\\{c_1, c_2, c_3, c_5\\}$。基矩阵 $T$ 由这些列构成：\n$$\nT = [c_1, c_2, c_3, c_5] = \\begin{bmatrix}\n0 & 0 & 0 & 1 \\\\\n0 & 0 & 1 & 0 \\\\\n1 & 0 & 0 & -3 \\\\\n0 & 1 & -3 & 10\n\\end{bmatrix}\n$$\n我们计算 $T$ 的行列式。我们沿第一行进行代数余子式展开：\n$$\n\\det(T) = (-1)^{1+1} \\cdot 0 \\cdot M_{11} + (-1)^{1+2} \\cdot 0 \\cdot M_{12} + (-1)^{1+3} \\cdot 0 \\cdot M_{13} + (-1)^{1+4} \\cdot 1 \\cdot \\det \\begin{pmatrix}\n0 & 0 & 1 \\\\\n1 & 0 & 0 \\\\\n0 & 1 & -3\n\\end{pmatrix}\n$$\n$$\n\\det(T) = -1 \\cdot \\det \\begin{pmatrix}\n0 & 0 & 1 \\\\\n1 & 0 & 0 \\\\\n0 & 1 & -3\n\\end{pmatrix}\n$$\n为了计算这个 $3 \\times 3$ 矩阵的行列式，我们沿其第一行展开：\n$$\n\\det \\begin{pmatrix}\n0 & 0 & 1 \\\\\n1 & 0 & 0 \\\\\n0 & 1 & -3\n\\end{pmatrix} = (-1)^{1+3} \\cdot 1 \\cdot \\det \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = 1 \\cdot (1 \\cdot 1 - 0 \\cdot 0) = 1\n$$\n将此结果代回，我们得到 $T$ 的行列式：\n$$\n\\det(T) = -1 \\cdot 1 = -1\n$$\n行列式是一个精确整数。", "answer": "$$\n\\boxed{-1}\n$$", "id": "2757663"}, {"introduction": "线性代数的强大之处在于其普适性，它的工具和思想远不止应用于 $\\mathbb{R}^n$ 中的几何向量。本练习将你的视角提升到一个更抽象的层次，将控制理论中的核心概念——传递函数——视为一个函数空间中的“向量”。通过在一个为该空间精心选择的两个不同基（单项式分母基与部分分式基）之间进行坐标变换，你将体会到，诸如部分分式展开等常用数学技巧，本质上是在为同一个系统“向量”寻找不同坐标系下的表示，这对于系统分析和求解至关重要。[@problem_id:2757652]", "problem": "考虑在拉普拉斯变量 $s$ 中的单输入单输出传递函数的实向量空间，定义为\n$$\n\\mathcal{V} \\;=\\; \\left\\{\\, \\frac{P(s)}{Q(s)} \\;:\\; Q(s) \\,=\\, (s+1)^{2}(s+2),\\; P(s)\\in\\mathbb{R}[s],\\; \\deg P \\leq 2 \\,\\right\\}.\n$$\n根据其构造，$\\mathcal{V}$ 是线性时不变 (LTI) 控制理论中常用的实有理传递函数空间的一个有限维子空间。令 $Q(s)=(s+1)^{2}(s+2)$。\n\n定义 $\\mathcal{V}$ 的两个有序基：\n- 单项式分母基 $\\mathcal{B}_{\\mathrm{mon}}=\\{\\, b_{1}(s),\\, b_{2}(s),\\, b_{3}(s)\\,\\}$，其中\n$$\nb_{1}(s)=\\frac{1}{Q(s)},\\quad b_{2}(s)=\\frac{s}{Q(s)},\\quad b_{3}(s)=\\frac{s^{2}}{Q(s)}.\n$$\n- 部分分式基 $\\mathcal{B}_{\\mathrm{pf}}=\\{\\, c_{1}(s),\\, c_{2}(s),\\, c_{3}(s)\\,\\}$，其中\n$$\nc_{1}(s)=\\frac{1}{s+1},\\quad c_{2}(s)=\\frac{1}{(s+1)^{2}},\\quad c_{3}(s)=\\frac{1}{s+2}.\n$$\n\n设传递函数 $G(s)\\in\\mathcal{V}$ 为\n$$\nG(s)\\;=\\;\\frac{5s^{2}-s+4}{(s+1)^{2}(s+2)}.\n$$\n\n仅使用线性代数中关于向量空间、线性无关、基、坐标和基变换的定义：\n1) 计算 $G(s)$ 相对于基 $\\mathcal{B}_{\\mathrm{mon}}$ 的坐标向量。\n2) 通过将基 $\\mathcal{B}_{\\mathrm{pf}}$ 的基元素用基 $\\mathcal{B}_{\\mathrm{mon}}$ 表示，并对得到的线性关系求逆，根据基本定义显式地构造将 $\\mathcal{B}_{\\mathrm{mon}}$ 坐标映射到 $\\mathcal{B}_{\\mathrm{pf}}$ 坐标的基变换映射。\n3) 应用此基变换，以得到 $G(s)$ 在基 $\\mathcal{B}_{\\mathrm{pf}}$ 中的坐标向量。\n\n仅报告 $G(s)$ 在基 $\\mathcal{B}_{\\mathrm{pf}}$ 中的最终坐标向量作为你的答案，格式化为行向量。无需四舍五入；给出精确值。", "solution": "所给问题是线性代数中的一个标准练习，应用于一个与控制理论相关的有理函数向量空间。该问题提法明确、内容自洽且科学合理。我们将着手解决它。\n\n该向量空间为 $\\mathcal{V} = \\left\\{\\, \\frac{P(s)}{Q(s)} \\;:\\; Q(s) = (s+1)^{2}(s+2),\\; P(s)\\in\\mathbb{R}[s],\\; \\deg P \\leq 2 \\,\\right\\}$。该空间的维数为 $3$，因为分子多项式由 $3$ 个系数确定。我们已知该空间的两个基：\n单项式分母基 $\\mathcal{B}_{\\mathrm{mon}}=\\{\\, b_{1}(s),\\, b_{2}(s),\\, b_{3}(s)\\,\\}$，其中 $b_{1}(s)=\\frac{1}{Q(s)}$，$b_{2}(s)=\\frac{s}{Q(s)}$，$b_{3}(s)=\\frac{s^{2}}{Q(s)}$。\n部分分式基 $\\mathcal{B}_{\\mathrm{pf}}=\\{\\, c_{1}(s),\\, c_{2}(s),\\, c_{3}(s)\\,\\}$，其中 $c_{1}(s)=\\frac{1}{s+1}$，$c_{2}(s)=\\frac{1}{(s+1)^{2}}$，$c_{3}(s)=\\frac{1}{s+2}$。\n我们感兴趣的向量是 $G(s) = \\frac{5s^{2}-s+4}{(s+1)^{2}(s+2)}$。\n\n我们的目标是求出 $G(s)$ 相对于基 $\\mathcal{B}_{\\mathrm{pf}}$ 的坐标向量。我们将遵循指定的三个步骤。\n\n首先，我们计算 $G(s)$ 相对于基 $\\mathcal{B}_{\\mathrm{mon}}$ 的坐标向量，记为 $[G]_{\\mathcal{B}_{\\mathrm{mon}}}$。根据定义，我们必须找到标量 $k_1, k_2, k_3$ 使得 $G(s) = k_{1}b_{1}(s) + k_{2}b_{2}(s) + k_{3}b_{3}(s)$。\n代入 $G(s)$ 和基向量 $b_{i}(s)$ 的定义：\n$$\n\\frac{5s^{2}-s+4}{Q(s)} = k_{1}\\frac{1}{Q(s)} + k_{2}\\frac{s}{Q(s)} + k_{3}\\frac{s^{2}}{Q(s)} = \\frac{k_{1} + k_{2}s + k_{3}s^{2}}{Q(s)}.\n$$\n要使这两个有理函数相等，它们的分子必须相等。通过比较分子中多项式的系数，我们有：\n$$\nk_{3}s^{2} + k_{2}s + k_{1} \\;=\\; 5s^{2} - 1s + 4.\n$$\n该等式必须对所有 $s$ 成立，因此我们匹配 $s$ 的同次幂的系数：\n$k_{1} = 4$，$k_{2} = -1$，$k_{3} = 5$。\n因此，$G(s)$ 在基 $\\mathcal{B}_{\\mathrm{mon}}$ 中的坐标向量是\n$$\n[G]_{\\mathcal{B}_{\\mathrm{mon}}} = \\begin{pmatrix} 4 \\\\ -1 \\\\ 5 \\end{pmatrix}.\n$$\n\n其次，我们构造从 $\\mathcal{B}_{\\mathrm{mon}}$ 到 $\\mathcal{B}_{\\mathrm{pf}}$ 的基变换矩阵，我们将其记为 $P_{\\mathcal{B}_{\\mathrm{pf}} \\leftarrow \\mathcal{B}_{\\mathrm{mon}}}$。问题指定了一种方法：将基 $\\mathcal{B}_{\\mathrm{pf}}$ 的基向量用 $\\mathcal{B}_{\\mathrm{mon}}$ 表示，这给出了矩阵 $P_{\\mathcal{B}_{\\mathrm{mon}} \\leftarrow \\mathcal{B}_{\\mathrm{pf}}}$，然后对其求逆。\n让我们将 $\\mathcal{B}_{\\mathrm{pf}}$ 中的每个向量 $c_{i}(s)$ 写成 $\\mathcal{B}_{\\mathrm{mon}}$ 中向量的线性组合：\n对于 $c_{1}(s)$：\n$$\nc_{1}(s) = \\frac{1}{s+1} = \\frac{(s+1)(s+2)}{(s+1)^{2}(s+2)} = \\frac{s^{2}+3s+2}{Q(s)} = 2\\frac{1}{Q(s)} + 3\\frac{s}{Q(s)} + 1\\frac{s^{2}}{Q(s)} = 2b_{1}(s) + 3b_{2}(s) + 1b_{3}(s).\n$$\n其坐标向量为 $[c_{1}]_{\\mathcal{B}_{\\mathrm{mon}}} = \\begin{pmatrix} 2 \\\\ 3 \\\\ 1 \\end{pmatrix}$。\n对于 $c_{2}(s)$：\n$$\nc_{2}(s) = \\frac{1}{(s+1)^{2}} = \\frac{s+2}{(s+1)^{2}(s+2)} = \\frac{s+2}{Q(s)} = 2\\frac{1}{Q(s)} + 1\\frac{s}{Q(s)} + 0\\frac{s^{2}}{Q(s)} = 2b_{1}(s) + 1b_{2}(s) + 0b_{3}(s).\n$$\n其坐标向量为 $[c_{2}]_{\\mathcal{B}_{\\mathrm{mon}}} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n对于 $c_{3}(s)$：\n$$\nc_{3}(s) = \\frac{1}{s+2} = \\frac{(s+1)^{2}}{(s+1)^{2}(s+2)} = \\frac{s^{2}+2s+1}{Q(s)} = 1\\frac{1}{Q(s)} + 2\\frac{s}{Q(s)} + 1\\frac{s^{2}}{Q(s)} = 1b_{1}(s) + 2b_{2}(s) + 1b_{3}(s).\n$$\n其坐标向量为 $[c_{3}]_{\\mathcal{B}_{\\mathrm{mon}}} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 1 \\end{pmatrix}$。\n从 $\\mathcal{B}_{\\mathrm{pf}}$到 $\\mathcal{B}_{\\mathrm{mon}}$ 的基变换矩阵由这些坐标向量作为其列构成：\n$$\nP_{\\mathcal{B}_{\\mathrm{mon}} \\leftarrow \\mathcal{B}_{\\mathrm{pf}}} = \\begin{pmatrix} [c_{1}]_{\\mathcal{B}_{\\mathrm{mon}}} & [c_{2}]_{\\mathcal{B}_{\\mathrm{mon}}} & [c_{3}]_{\\mathcal{B}_{\\mathrm{mon}}} \\end{pmatrix} = \\begin{pmatrix} 2 & 2 & 1 \\\\ 3 & 1 & 2 \\\\ 1 & 0 & 1 \\end{pmatrix}.\n$$\n坐标的映射关系由 $[v]_{\\mathcal{B}_{\\mathrm{mon}}} = P_{\\mathcal{B}_{\\mathrm{mon}} \\leftarrow \\mathcal{B}_{\\mathrm{pf}}} [v]_{\\mathcal{B}_{\\mathrm{pf}}}$ 给出。为了找到从 $\\mathcal{B}_{\\mathrm{mon}}$ 坐标到 $\\mathcal{B}_{\\mathrm{pf}}$ 坐标的映射，我们必须计算该矩阵的逆：\n$$\nP_{\\mathcal{B}_{\\mathrm{pf}} \\leftarrow \\mathcal{B}_{\\mathrm{mon}}} = (P_{\\mathcal{B}_{\\mathrm{mon}} \\leftarrow \\mathcal{B}_{\\mathrm{pf}}})^{-1}.\n$$\n令 $A = P_{\\mathcal{B}_{\\mathrm{mon}} \\leftarrow \\mathcal{B}_{\\mathrm{pf}}}$。$A$ 的行列式为：\n$$\n\\det(A) = 2(1\\cdot 1 - 2\\cdot 0) - 2(3\\cdot 1 - 2\\cdot 1) + 1(3\\cdot 0 - 1\\cdot 1) = 2(1) - 2(1) - 1 = -1.\n$$\n因为行列式非零，所以该矩阵是可逆的。逆矩阵为 $A^{-1} = \\frac{1}{\\det(A)}\\mathrm{adj}(A)$。伴随矩阵 $\\mathrm{adj}(A)$ 是代数余子式矩阵的转置。\n代数余子式矩阵为：\n$$\nC = \\begin{pmatrix} +\\begin{vmatrix} 1 & 2 \\\\ 0 & 1 \\end{vmatrix} & -\\begin{vmatrix} 3 & 2 \\\\ 1 & 1 \\end{vmatrix} & +\\begin{vmatrix} 3 & 1 \\\\ 1 & 0 \\end{vmatrix} \\\\ -\\begin{vmatrix} 2 & 1 \\\\ 0 & 1 \\end{vmatrix} & +\\begin{vmatrix} 2 & 1 \\\\ 1 & 1 \\end{vmatrix} & -\\begin{vmatrix} 2 & 2 \\\\ 1 & 0 \\end{vmatrix} \\\\ +\\begin{vmatrix} 2 & 1 \\\\ 1 & 2 \\end{vmatrix} & -\\begin{vmatrix} 2 & 1 \\\\ 3 & 2 \\end{vmatrix} & +\\begin{vmatrix} 2 & 2 \\\\ 3 & 1 \\end{vmatrix} \\end{pmatrix} = \\begin{pmatrix} 1 & -1 & -1 \\\\ -2 & 1 & 2 \\\\ 3 & -1 & -4 \\end{pmatrix}.\n$$\n伴随矩阵是 $\\mathrm{adj}(A) = C^{T} = \\begin{pmatrix} 1 & -2 & 3 \\\\ -1 & 1 & -1 \\\\ -1 & 2 & -4 \\end{pmatrix}$。\n因此，逆矩阵为：\n$$\nP_{\\mathcal{B}_{\\mathrm{pf}} \\leftarrow \\mathcal{B}_{\\mathrm{mon}}} = \\frac{1}{-1} \\begin{pmatrix} 1 & -2 & 3 \\\\ -1 & 1 & -1 \\\\ -1 & 2 & -4 \\end{pmatrix} = \\begin{pmatrix} -1 & 2 & -3 \\\\ 1 & -1 & 1 \\\\ 1 & -2 & 4 \\end{pmatrix}.\n$$\n\n第三，我们将此基变换矩阵应用于坐标向量 $[G]_{\\mathcal{B}_{\\mathrm{mon}}}$ 以得到 $[G]_{\\mathcal{B}_{\\mathrm{pf}}}$。\n变换法则为 $[G]_{\\mathcal{B}_{\\mathrm{pf}}} = P_{\\mathcal{B}_{\\mathrm{pf}} \\leftarrow \\mathcal{B}_{\\mathrm{mon}}} [G]_{\\mathcal{B}_{\\mathrm{mon}}}$。\n$$\n[G]_{\\mathcal{B}_{\\mathrm{pf}}} = \\begin{pmatrix} -1 & 2 & -3 \\\\ 1 & -1 & 1 \\\\ 1 & -2 & 4 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ -1 \\\\ 5 \\end{pmatrix} = \\begin{pmatrix} (-1)(4) + (2)(-1) + (-3)(5) \\\\ (1)(4) + (-1)(-1) + (1)(5) \\\\ (1)(4) + (-2)(-1) + (4)(5) \\end{pmatrix} = \\begin{pmatrix} -4 - 2 - 15 \\\\ 4 + 1 + 5 \\\\ 4 + 2 + 20 \\end{pmatrix} = \\begin{pmatrix} -21 \\\\ 10 \\\\ 26 \\end{pmatrix}.\n$$\n因此，$G(s)$ 相对于基 $\\mathcal{B}_{\\mathrm{pf}}$ 的坐标向量是 $\\begin{pmatrix} -21 \\\\ 10 \\\\ 26 \\end{pmatrix}$。这对应于部分分式展开式 $G(s) = \\frac{-21}{s+1} + \\frac{10}{(s+1)^{2}} + \\frac{26}{s+2}$。\n\n最终答案，按要求格式化为行向量，是此列向量的转置。", "answer": "$$\n\\boxed{\\begin{pmatrix} -21 & 10 & 26 \\end{pmatrix}}\n$$", "id": "2757652"}, {"introduction": "在控制理论中，可观测性与可控性是一对深刻的对偶概念。如果说可控性是关于如何驱动系统的状态，那么可观测性则是关于如何从输出中推断系统的状态。这个练习从几何的视角切入，要求你使用正交投影这一强大的工具，将系统的初始状态分解为“可观测”和“不可观测”的两个部分。通过计算和分析，你将直观地理解为何状态向量中位于不可观测子空间的分量对于系统输出是“隐形”的，从而掌握将状态空间分解为有意义的子空间如何能够为我们提供对系统行为的深刻洞见。[@problem_id:2757686]", "problem": "考虑一个连续时间线性时不变（LTI）系统，其状态空间实现由状态矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 和输出矩阵 $C \\in \\mathbb{R}^{1 \\times 3}$ 给出，\n$$\nA = \\begin{pmatrix}\n-1 & 0 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 2\n\\end{pmatrix}, \n\\qquad\nC = \\begin{pmatrix}\n1 & 0 & -1\n\\end{pmatrix}.\n$$\n设状态空间 $\\mathbb{R}^{3}$ 配备标准内积 $\\langle x, y \\rangle = x^{\\top} y$。输出为 $y(t) = C x(t)$，状态轨迹为 $x(t) = \\exp(A t) x(0)$，其中初始条件为 $x(0) \\in \\mathbb{R}^{3}$。仅使用不可观测子空间的基本定义\n$$\n\\mathcal{N} = \\bigcap_{k=0}^{n-1} \\ker\\!\\big(C A^{k}\\big)\n$$\n以及子空间上的正交投影由与该子空间的一组标准正交基的内积定义，完成以下任务：\n\n- 显式推导 $\\mathcal{N}$，并为其构建一组关于标准内积的标准正交基。\n- 推导一般初始状态 $x(0) = \\begin{pmatrix} \\alpha \\\\ \\beta \\\\ \\gamma \\end{pmatrix}$ 到 $\\mathcal{N}$ 上的正交投影。\n- 使用状态解，确定最终输出 $y(t)$ 的解析表达式，并解释您推导的投影如何影响所有 $t \\ge 0$ 的 $y(t)$。\n\n作为最终答案，提供 $y(t)$ 关于 $\\alpha$、$\\beta$、$\\gamma$ 和 $t$ 的封闭形式解析表达式。不需要四舍五入。不要包含单位。", "solution": "该问题陈述经核实具有科学依据、问题设定合理且客观。这是线性控制理论中的一个标准问题，其设置完整一致，没有任何科学或逻辑上的缺陷。因此，我们可以着手求解。\n\n问题要求确定系统输出 $y(t)$，并解释其如何受到不可观测子空间 $\\mathcal{N}$ 的影响。我们首先显式地确定 $\\mathcal{N}$。状态空间的维数是 $n=3$。不可观测子空间定义为\n$$\n\\mathcal{N} = \\bigcap_{k=0}^{n-1} \\ker\\!\\big(C A^{k}\\big) = \\ker(C) \\cap \\ker(CA) \\cap \\ker(CA^2)\n$$\n状态和输出矩阵给定如下：\n$$\nA = \\begin{pmatrix}\n-1 & 0 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 2\n\\end{pmatrix}, \n\\qquad\nC = \\begin{pmatrix}\n1 & 0 & -1\n\\end{pmatrix}\n$$\n由于 $A$ 是一个对角矩阵，其幂次可以通过计算其对角元素的幂次得到。\n对于 $k=0$：\n$$ A^0 = I = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\implies C A^0 = C = \\begin{pmatrix} 1 & 0 & -1 \\end{pmatrix} $$\n对于 $k=1$：\n$$ A^1 = A = \\begin{pmatrix} -1 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 2 \\end{pmatrix} \\implies C A^1 = \\begin{pmatrix} 1 & 0 & -1 \\end{pmatrix} \\begin{pmatrix} -1 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 2 \\end{pmatrix} = \\begin{pmatrix} -1 & 0 & -2 \\end{pmatrix} $$\n对于 $k=2$：\n$$ A^2 = \\begin{pmatrix} (-1)^2 & 0 & 0 \\\\ 0 & 0^2 & 0 \\\\ 0 & 0 & 2^2 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 4 \\end{pmatrix} \\implies C A^2 = \\begin{pmatrix} 1 & 0 & -1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 4 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & -4 \\end{pmatrix} $$\n现在，我们求每个矩阵 $C A^k$ 的核。一个向量 $v = \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix} \\in \\mathbb{R}^3$ 属于 $\\mathcal{N}$ 当且仅当它满足对所有 $k=0, 1, 2$ 都有 $C A^k v = 0$。这给出了以下线性方程组：\n\\begin{enumerate}\n    \\item $C A^0 v = 0 \\implies v_1 - v_3 = 0$\n    \\item $C A^1 v = 0 \\implies -v_1 - 2v_3 = 0$\n    \\item $C A^2 v = 0 \\implies v_1 - 4v_3 = 0$\n\\end{enumerate}\n由第一个方程，我们得到 $v_1 = v_3$。将其代入第二个方程得到 $-v_3 - 2v_3 = -3v_3 = 0$，这意味着 $v_3 = 0$。因此， $v_1 = 0$。第三个方程 $v_1 - 4v_3 = 0$ 也被满足，因为 $0 - 4(0) = 0$。变量 $v_2$ 不受任何方程的约束。因此，$\\mathcal{N}$ 中的任何向量都必须是 $\\begin{pmatrix} 0 \\\\ v_2 \\\\ 0 \\end{pmatrix}$ 的形式，其中 $v_2 \\in \\mathbb{R}$。因此，不可观测子空间由单个向量张成：\n$$\n\\mathcal{N} = \\text{span} \\left\\{ \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} \\right\\}\n$$\n为了构建 $\\mathcal{N}$ 关于标准内积的标准正交基，我们取其张成向量 $b = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$ 并将其单位化。其范数为 $\\|b\\| = \\sqrt{0^2 + 1^2 + 0^2} = 1$。因此，向量 $u_1 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$ 本身就构成了 $\\mathcal{N}$ 的一组标准正交基。\n\n接下来，我们推导一般初始状态 $x(0) = \\begin{pmatrix} \\alpha \\\\ \\beta \\\\ \\gamma \\end{pmatrix}$ 到 $\\mathcal{N}$ 上的正交投影。投影由 $\\text{proj}_{\\mathcal{N}}(x(0)) = \\langle x(0), u_1 \\rangle u_1$ 给出。内积为：\n$$\n\\langle x(0), u_1 \\rangle = x(0)^{\\top} u_1 = \\begin{pmatrix} \\alpha & \\beta & \\gamma \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\beta\n$$\n因此，$x(0)$ 到 $\\mathcal{N}$ 上的投影为：\n$$\n\\text{proj}_{\\mathcal{N}}(x(0)) = \\beta u_1 = \\begin{pmatrix} 0 \\\\ \\beta \\\\ 0 \\end{pmatrix}\n$$\n现在，我们确定输出 $y(t) = C x(t) = C \\exp(At) x(0)$。首先，我们计算矩阵指数 $\\exp(At)$。由于 $A$ 是对角的，$\\exp(At)$ 可以通过对 $At$ 的对角元素取指数来找到：\n$$\nAt = \\begin{pmatrix} -t & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 2t \\end{pmatrix} \\implies \\exp(At) = \\begin{pmatrix} \\exp(-t) & 0 & 0 \\\\ 0 & \\exp(0) & 0 \\\\ 0 & 0 & \\exp(2t) \\end{pmatrix} = \\begin{pmatrix} \\exp(-t) & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & \\exp(2t) \\end{pmatrix}\n$$\n状态轨迹 $x(t)$ 为：\n$$\nx(t) = \\exp(At) x(0) = \\begin{pmatrix} \\exp(-t) & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & \\exp(2t) \\end{pmatrix} \\begin{pmatrix} \\alpha \\\\ \\beta \\\\ \\gamma \\end{pmatrix} = \\begin{pmatrix} \\alpha \\exp(-t) \\\\ \\beta \\\\ \\gamma \\exp(2t) \\end{pmatrix}\n$$\n最后，输出 $y(t)$ 为：\n$$\ny(t) = C x(t) = \\begin{pmatrix} 1 & 0 & -1 \\end{pmatrix} \\begin{pmatrix} \\alpha \\exp(-t) \\\\ \\beta \\\\ \\gamma \\exp(2t) \\end{pmatrix} = \\alpha \\exp(-t) - \\gamma \\exp(2t)\n$$\n为了进行解释，我们将初始状态 $x(0)$ 分解为不可观测子空间中的分量 $x_{\\mathcal{N}} = \\text{proj}_{\\mathcal{N}}(x(0))$ 和其正交补（即可观测子空间 $\\mathcal{N}^{\\perp}$）中的分量 $x_{\\mathcal{O}} = x(0) - x_{\\mathcal{N}}$。\n$$\nx_{\\mathcal{N}} = \\begin{pmatrix} 0 \\\\ \\beta \\\\ 0 \\end{pmatrix}, \\qquad x_{\\mathcal{O}} = \\begin{pmatrix} \\alpha \\\\ \\beta \\\\ \\gamma \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ \\beta \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\alpha \\\\ 0 \\\\ \\gamma \\end{pmatrix}\n$$\n根据系统的线性性质，输出为 $y(t) = C\\exp(At)(x_{\\mathcal{O}} + x_{\\mathcal{N}}) = C\\exp(At)x_{\\mathcal{O}} + C\\exp(At)x_{\\mathcal{N}}$。项 $C\\exp(At)x_{\\mathcal{N}}$ 表示由初始状态的不可观测分量产生的输出。根据不可观测子空间的定义，对于所有 $t \\ge 0$，该项必须恒等于零。我们来验证这一点：\n$$\nC\\exp(At)x_{\\mathcal{N}} = \\begin{pmatrix} 1 & 0 & -1 \\end{pmatrix} \\begin{pmatrix} \\exp(-t) & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & \\exp(2t) \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\beta \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & -1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\beta \\\\ 0 \\end{pmatrix} = 0\n$$\n这证实了输出完全由初始状态的可观测分量 $x_{\\mathcal{O}}$ 产生：\n$$\ny(t) = C\\exp(At)x_{\\mathcal{O}} = \\begin{pmatrix} 1 & 0 & -1 \\end{pmatrix} \\begin{pmatrix} \\exp(-t) & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & \\exp(2t) \\end{pmatrix} \\begin{pmatrix} \\alpha \\\\ 0 \\\\ \\gamma \\end{pmatrix} = \\alpha \\exp(-t) - \\gamma \\exp(2t)\n$$\n结果是相同的。其解释是，初始状态中位于不可观测子空间内的分量，即沿着第二个标准基向量且大小为 $\\beta$ 的分量，对于输出 $y(t)$ 是“不可见的”。输出信号仅取决于分量 $\\alpha$ 和 $\\gamma$，这两个分量定义了初始状态在可观测子空间 $\\mathcal{N}^{\\perp}$ 上的投影。\n\n输出的最终表达式为：\n$$\ny(t) = \\alpha \\exp(-t) - \\gamma \\exp(2t)\n$$", "answer": "$$\\boxed{\\alpha \\exp(-t) - \\gamma \\exp(2t)}$$", "id": "2757686"}]}