{"hands_on_practices": [{"introduction": "在判断一个对称矩阵是否为正定矩阵时，检查其对角线元素是否全部为正是一个常见的初步步骤，但这远非充分条件。本练习旨在深化您对正定性核心定义的理解，通过一个具体的反例，我们将揭示为何仅凭对角线元素符号无法做出可靠判断。此实践将促使您回归正定性的根本——二次型 $x^{\\top} P x$ 的符号或矩阵的特征值——来分析矩阵的性质 [@problem_id:2735104]。", "problem": "在线性时不变（LTI）系统的李雅普诺夫稳定性分析中，通常会考虑一个二次候选李雅普诺夫函数 $V(x) = x^{\\top} P x$，其中 $P \\in \\mathbb{R}^{n \\times n}$ 是一个对称矩阵。要使 $V(x)$ 为正定函数，一个基本要求是矩阵 $P$ 是正定的；一个较弱的非负性要求是 $P$ 是半正定（PSD）的。然而，仅凭对角元的符号模式以及是否存在对角占优，本身并不能确定矩阵的半正定性。\n\n考虑对称矩阵\n$$\nP \\;=\\; \\begin{pmatrix}\n1 & 2 & 2 \\\\\n2 & 1 & 2 \\\\\n2 & 2 & 1\n\\end{pmatrix}.\n$$\n该矩阵的对角元均为严格正数。\n\n任务：\n- 仅使用二次型、特征值及其通过瑞利商建立的关系等基本原理，通过计算其最小特征值的精确值来判断 $P$ 是否为半正定矩阵。\n- 然后，基于相同的原理，简要解释为什么（i）严格正的对角元不能保证半正定性，以及（ii）对角占优不是半正定性的必要条件。您的解释应基于半正定性的定义和对称矩阵的谱性质。\n\n最终答案请提供 $P$ 的最小特征值的精确值（无单位，不四舍五入）。", "solution": "我们首先对所述问题进行严格分析。若对于所有向量 $x \\in \\mathbb{R}^n$，相关的二次型 $x^{\\top}Ax$ 均为非负，则对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 被定义为半正定（PSD）矩阵。形式上，$A$ 是半正定的当且仅当对于所有 $x \\in \\mathbb{R}^n$，$x^{\\top}Ax \\ge 0$。\n\n一个等价的基本条件是用矩阵的谱来表示的。一个对称矩阵是半正定的，当且仅当其所有特征值均为非负。二次型与特征值之间的联系由瑞利-里兹定理建立，该定理指出对称矩阵 $A$ 的最小特征值由其瑞利商的最小值给出：\n$$\n\\lambda_{\\min}(A) = \\min_{x \\neq 0} \\frac{x^{\\top}Ax}{x^{\\top}x}\n$$\n由此可见，$A$ 是半正定的当且仅当 $\\lambda_{\\min}(A) \\ge 0$。我们的任务是将这些原理应用于矩阵：\n$$\nP \\;=\\; \\begin{pmatrix}\n1 & 2 & 2 \\\\\n2 & 1 & 2 \\\\\n2 & 2 & 1\n\\end{pmatrix}.\n$$\n首先，我们计算 $P$ 的特征值以确定其定性。矩阵 $P$ 具有特殊结构。它可以表示为 $P = 2J - I$，其中 $I$ 是 $3 \\times 3$ 的单位矩阵，$J$ 是 $3 \\times 3$ 的全1矩阵：\n$$\nJ = \\begin{pmatrix}\n1 & 1 & 1 \\\\\n1 & 1 & 1 \\\\\n1 & 1 & 1\n\\end{pmatrix}\n$$\n矩阵 $J$ 的秩为1。其特征多项式为 $\\det(J - \\lambda I) = \\lambda^{2}(3-\\lambda)$，这可以通过观察或计算得出。因此，$J$ 的特征值（记为 $\\lambda_J$）是 $\\{3, 0, 0\\}$。对于一个可对角化矩阵 $A$，其多项式函数 $f(A)$ 的特征值为 $f(\\lambda_A)$。这里，$P = f(J) = 2J - I$。因此，$P$ 的特征值（记为 $\\lambda_P$）可以通过对 $J$ 的特征值应用相同的线性变换得到：\n$$\n\\lambda_P = 2\\lambda_J - 1\n$$\n因此，$P$ 的特征值为：\n$2(3) - 1 = 5$\n$2(0) - 1 = -1$\n$2(0) - 1 = -1$\n$P$ 的谱为 $\\{5, -1, -1\\}$。最小特征值为 $\\lambda_{\\min}(P) = -1$。\n由于 $\\lambda_{\\min}(P) = -1 < 0$，存在一个向量 $x$（任何对应于特征值 $-1$ 的特征向量），使得二次型 $x^{\\top}Px = \\lambda_{\\min}(P)x^{\\top}x < 0$。因此，矩阵 $P$ 不是半正定的。实际上，它是不定的。\n\n现在，我们来解答概念性问题。\n\n(i) 严格正的对角元不能保证半正定性。\n这个陈述是正确的。对称矩阵 $A$ 是半正定的一个必要条件是其对角元必须为非负。这是通过考虑标准基向量 $e_i$ 的二次型 $e_i^{\\top}Ae_i = A_{ii}$ 得出的。如果 $A$ 是半正定的，则对所有 $i$ 都有 $A_{ii} \\ge 0$。然而，这个条件并不充分。非对角元 $A_{ij}$ 会影响 $x^{\\top}Ax = \\sum_{i,j} A_{ij}x_i x_j$ 的值。如果非对角元相对于对角元足够大，它们可能导致二次型在选择合适的 $x$ 时变为负值。本题中的矩阵 $P$ 就是一个直接的反例。它的所有对角元都是 $1 > 0$，但它不是半正定的，因为其较大的非对角元导致了负特征值的出现。\n\n(ii) 对角占优不是半正定性的必要条件。\n这个陈述也是正确的。如果对于每一行 $i$，对角元的绝对值都大于该行所有其他元素的绝对值之和，即 $| A_{ii} | > \\sum_{j \\neq i} | A_{ij} |$，则对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 被称为严格对角占优。如果一个具有正对角元（$A_{ii}>0$）的对称矩阵是严格对角占优的，那么根据盖尔圆盘定理，它的所有特征值都严格为正，该矩阵是正定的。因此，这种形式的对角占优是正定性的一个*充分*条件。\n然而，这个条件不是*必要*的。一个矩阵可以不是对角占优的，但仍然是正定的。考虑以下矩阵：\n$$\nM = \\begin{pmatrix}\n2 & 3 \\\\\n3 & 5\n\\end{pmatrix}\n$$\n该矩阵不是对角占优的。对于第一行，条件 $|M_{11}| > |M_{12}|$ 变为 $|2| > |3|$，这是不成立的。为检查其正定性，我们考察其特征值。特征方程为 $\\det(M-\\lambda I)=0$：\n$$\n(2-\\lambda)(5-\\lambda) - 9 = \\lambda^2 - 7\\lambda + 1 = 0\n$$\n特征值为 $\\lambda = \\frac{7 \\pm \\sqrt{49-4}}{2} = \\frac{7 \\pm \\sqrt{45}}{2}$。两个特征值 $\\lambda_1 = \\frac{7 + 3\\sqrt{5}}{2}$ 和 $\\lambda_2 = \\frac{7 - 3\\sqrt{5}}{2}$ 均为严格正数（因为 $7 = \\sqrt{49}$ 且 $\\sqrt{45} < \\sqrt{49}$）。因此，矩阵 $M$ 是正定的，尽管它没有通过对角占优的检验。这表明对角占优是正定性的一个充分而非必要条件。", "answer": "$$\\boxed{-1}$$", "id": "2735104"}, {"introduction": "正定矩阵在控制理论中的核心地位，很大程度上源于其在Lyapunov稳定性分析中的关键作用。本练习将引导您探索Lyapunov方程，这是连接矩阵代数与系统动态特性的桥梁。您将通过第一性原理推导出一个深刻的结论：对于一个具有不稳定模式的系统，为何不可能找到一个正定二次型作为其Lyapunov函数，从而揭示了系统稳定性与Lyapunov方程解的存在性之间的必然联系 [@problem_id:2735050]。", "problem": "考虑一个关于实矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 和对称矩阵 $Q \\in \\mathbb{R}^{n \\times n}$ 的连续时间李雅普诺夫方程：\n$$\nA^{\\top} P + P A = -Q,\n$$\n其中要求 $P \\in \\mathbb{R}^{n \\times n}$ 是对称正定矩阵。设\n$$\nA \\triangleq \\begin{pmatrix} 1 & 1 \\\\ 0 & -2 \\end{pmatrix} \\in \\mathbb{R}^{2 \\times 2}.\n$$\n该矩阵 $A$ 有一个不稳定特征值。请仅使用二次型的正定性、特征值和特征向量的基本定义，以及对于可乘矩阵 $B$ 的双线性型恒等式 $x^{\\top} B y = y^{\\top} B^{\\top} x$，完成以下任务：\n\n1) 当 $x$ 是 $A$ 对应于实特征值 $\\lambda$ 的实特征向量时，推导方程对标量 $x^{\\top} \\left( A^{\\top} P + P A \\right) x$ 施加的必要符号条件。并由此断定，对于给定的 $A$，任何对称正定矩阵 $Q \\succ 0$ 的选择都会导致满足李雅普诺夫方程的对称正定矩阵 $P \\succ 0$ 不存在。\n\n2) 根据你在第1部分的推理，明确地构造一个对称正定矩阵 $Q \\succ 0$，使得对于给定的 $A$，李雅普诺夫方程没有对称正定解 $P$。\n\n将你为 $Q$ 选择的显式矩阵作为最终答案，以闭式形式写出。无需四舍五入。", "solution": "该问题要求在所涉及矩阵的特定约束下，分析连续时间李雅普诺夫方程 $A^{\\top} P + P A = -Q$。给定矩阵 $A \\triangleq \\begin{pmatrix} 1 & 1 \\\\ 0 & -2 \\end{pmatrix}$，我们的任务是研究当 $Q \\in \\mathbb{R}^{2 \\times 2}$ 也是对称正定矩阵时，是否存在一个对称正定解 $P \\in \\mathbb{R}^{2 \\times 2}$。此分析必须基于基本原理。\n\n首先，我们推导对于此类解 $P$ 存在，矩阵 $A$ 的实特征值必须满足的必要条件。我们假设存在一个对称正定矩阵 $P$ 和一个对称正定矩阵 $Q$ 满足方程 $A^{\\top} P + P A = -Q$。\n\n设 $\\lambda$ 是 $A$ 的一个实特征值，$x \\in \\mathbb{R}^{n}$ 是对应的非零特征向量，因此有 $Ax = \\lambda x$。我们将李雅普诺夫方程左乘 $x^{\\top}$ 并右乘 $x$ 来构造一个二次型：\n$$\nx^{\\top} \\left( A^{\\top} P + P A \\right) x = -x^{\\top} Q x\n$$\n左侧 (LHS) 可以展开为：\n$$\n\\text{LHS} = x^{\\top} A^{\\top} P x + x^{\\top} P A x\n$$\n我们分析第一项 $x^{\\top} A^{\\top} P x$。它可以被重写为 $(A x)^{\\top} P x$。这个转置性质 $(B y)^{\\top} = y^{\\top} B^{\\top}$ 是由给定的恒等式 $y^{\\top} B z = z^{\\top} B^{\\top} y$ 推导出来的。令 $z$ 为任意向量，我们有 $(By)^{\\top}z = z^{\\top}(By) = y^{\\top} B^{\\top} z$，由于 $z$ 是任意的，这意味着 $(By)^{\\top} = y^{\\top} B^{\\top}$。\n利用这个性质和特征向量关系 $Ax = \\lambda x$，第一项变为：\n$$\nx^{\\top} A^{\\top} P x = (A x)^{\\top} P x = (\\lambda x)^{\\top} P x = \\lambda x^{\\top} P x\n$$\n第二项 $x^{\\top} P A x$ 也可类似分析：\n$$\nx^{\\top} P (A x) = x^{\\top} P (\\lambda x) = \\lambda x^{\\top} P x\n$$\n结合这些结果，LHS 简化为：\n$$\n\\text{LHS} = \\lambda x^{\\top} P x + \\lambda x^{\\top} P x = 2 \\lambda (x^{\\top} P x)\n$$\n将简化的 LHS 与二次型方程的右侧 (RHS) 相等，我们得到关键关系：\n$$\n2 \\lambda (x^{\\top} P x) = -x^{\\top} Q x\n$$\n现在，我们来考察这个方程中各项的符号。\n根据定义，一个对称矩阵 $P$ 是正定的 ($P \\succ 0$)，当且仅当对于所有非零向量 $v \\in \\mathbb{R}^{n}$，都有 $v^{\\top} P v > 0$。由于特征向量 $x$ 根据定义是非零向量，因此 $x^{\\top} P x > 0$。\n类似地，由于 $Q$ 被给定为对称正定矩阵 ($Q \\succ 0$)，我们必须有 $x^{\\top} Q x > 0$。因此，项 $-x^{\\top} Q x$ 必须为负。\n\n因此，我们的方程可以根据符号写为：\n$$\n2 \\lambda (\\text{正数}) = (\\text{负数})\n$$\n为使此等式成立，特征值 $\\lambda$ 必须为负，即 $\\lambda < 0$。这构成了一个必要条件：对于给定的对称正定矩阵 $Q$，要使李雅普诺夫方程 $A^{\\top} P + P A = -Q$ 有对称正定解 $P$，矩阵 $A$ 的任何实特征值都必须严格为负。\n\n现在我们将这个发现应用于给定的矩阵 $A = \\begin{pmatrix} 1 & 1 \\\\ 0 & -2 \\end{pmatrix}$。\n矩阵 $A$ 是一个上三角矩阵。三角矩阵的特征值是其对角线上的元素。因此，$A$ 的特征值为 $\\lambda_1 = 1$ 和 $\\lambda_2 = -2$。\n其中一个特征值 $\\lambda_1 = 1$ 是正数。这违反了我们刚刚推导出的必要条件 $\\lambda < 0$。\n让我们把这一点说得更具体些。对应于 $\\lambda_1 = 1$ 的特征向量 $x_1$ 可以通过求解 $(A - 1 \\cdot I)x_1 = 0$ 得到：\n$$\n\\begin{pmatrix} 1-1 & 1 \\\\ 0 & -2-1 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 0 & -3 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这得出 $v_2 = 0$，而 $v_1$ 可以是任何非零实数。我们选择一个代表性的特征向量 $x_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n\n如果对于某个对称正定矩阵 $Q$ 存在一个对称正定解 $P$，那么将 $\\lambda = 1$ 和 $x = x_1$ 代入我们推导出的关系式 $2 \\lambda (x^{\\top} P x) = -x^{\\top} Q x$ 中，我们将得到：\n$$\n2 (1) (x_1^{\\top} P x_1) = -x_1^{\\top} Q x_1\n$$\n$$\n2 (x_1^{\\top} P x_1) = -x_1^{\\top} Q x_1\n$$\n由于 $P \\succ 0$ 且 $x_1 \\neq 0$，项 $x_1^{\\top} P x_1$ 必须为正。因此，左侧的 $2 (x_1^{\\top} P x_1)$ 是正数。\n由于 $Q \\succ 0$ 且 $x_1 \\neq 0$，项 $x_1^{\\top} Q x_1$ 必须为正。因此，右侧的 $-x_1^{\\top} Q x_1$ 是负数。\n这导致了一个矛盾：一个严格正数必须等于一个严格负数。只要 $Q$ 是正定的，这个矛盾就与 $Q$ 的具体选择无关。因此，最初关于存在对称正定解 $P$ 的假设必定是错误的。我们断定，对于给定的矩阵 $A$，选择任何对称正定矩阵 $Q$，都将导致不存在一个对称正定解 $P$。\n\n对于问题的第二部分，我们必须明确地构造一个对称正定矩阵 $Q \\succ 0$，使得李雅普诺夫方程没有对称正定解 $P$。基于上述全面的推理，任何对称正定矩阵 $Q$ 都可以。对于正定矩阵，最简单且最典型的选择是单位矩阵 $I$。\n我们选择 $Q = I = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$。\n该矩阵是对称的。它的特征值均为1，是正数，所以 $Q$ 是正定的。\n通过这个选择，我们的论证已经表明方程 $A^{\\top} P + P A = -I$ 不可能有对称正定解 $P$。这个明确构造的 $Q$ 满足问题的条件。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}}\n$$", "id": "2735050"}, {"introduction": "将理论知识转化为可靠的计算代码是工程师面临的持续挑战，本练习将理论与实践紧密结合。我们将探讨在有限精度计算中评估二次型 $x^{\\top} Q x$ 时一个常见的陷阱：灾难性抵消（catastrophic cancellation），即两个相近的数相减导致精度的大幅损失。通过一个精心设计的例子，您将亲眼看到一个理论上正确的计算如何得出完全错误的结果，并学习如何利用Cholesky分解等矩阵因式分解方法，将计算重构为数值上更稳健的范数形式 [@problem_id:2735080]。", "problem": "在线性时不变系统的 Lyapunov 稳定性分析中，候选的 Lyapunov 函数通常是二次型 $V(x) = x^{\\top} Q x$，其中 $Q \\in \\mathbb{R}^{n \\times n}$ 是一个对称正定矩阵。在有限精度算术中，当 $Q$ 接近奇异时，计算 $x^{\\top} Q x$ 可能会遭受灾难性抵消。考虑以下具体实例\n$$\nQ = \\begin{pmatrix}\n1 & 1 - \\delta \\\\\n1 - \\delta & 1\n\\end{pmatrix}, \\quad x = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix},\n$$\n其中 $\\delta \\in (0,1)$ 是一个小的正参数。假设算术运算遵循电气和电子工程师协会 (IEEE) 754 模型，采用四舍五入到最近值，单位舍入误差为 $u$，并假设 $0 < \\delta < \\tfrac{u}{2}$。不使用积和熔加或补偿求和。\n\na) 仅使用对称正定性的核心定义和性质，证明对于 $\\delta \\in (0,1)$，$Q$ 是对称正定的，并推导 $x^{\\top} Q x$ 作为 $\\delta$ 函数的精确解析表达式。\n\nb) 考虑一种朴素的有限精度计算方法，即首先使用标准矩阵向量乘法算法以浮点数形式计算 $y = Q x$，然后计算 $x^{\\top} y$ 作为点积。在所述浮点模型和假设 $0 < \\delta < \\tfrac{u}{2}$ 下，确定此朴素计算返回的值。然后，提出一种数值稳定的重构方法，通过对称矩阵平方根 $Q^{1/2}$ 或 Cholesky 分解 $Q = R^{\\top} R$ 来表示 $x^{\\top} Q x$，并写出重构形式下 $x^{\\top} Q x$ 的精确解析表达式。\n\nc) 最后，在相同的浮点假设下，计算 b) 部分中朴素计算的相对前向误差，定义为\n$$\n\\frac{\\left| \\widehat{V} - V \\right|}{V},\n$$\n其中 $V$ 是 a) 部分中 $x^{\\top} Q x$ 的精确值，$\\widehat{V}$ 是 b) 部分中朴素计算返回的有限精度值。将您的最终答案表示为一个无单位的精确实数。", "solution": "这个问题要求对一个二次型的计算进行分析，包括解析和有限精度算术两个方面。我们首先将验证问题陈述的有效性。\n\n已知条件如下：\n- 一个二次型 $V(x) = x^{\\top} Q x$。\n- 一个对称矩阵 $Q = \\begin{pmatrix} 1 & 1 - \\delta \\\\ 1 - \\delta & 1 \\end{pmatrix}$。\n- 一个向量 $x = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n- 一个参数 $\\delta \\in (0,1)$。\n- 一个浮点算术模型，遵循 IEEE 754，采用四舍五入到最近值，单位舍入误差为 $u$。\n- 参数上的一个特定条件：$0 < \\delta < \\frac{u}{2}$。\n- 计算约束：不使用积和熔加或补偿求和。\n\n该问题在科学上植根于控制理论和数值线性代数，讨论了众所周知 的灾难性抵消问题。它提法明确、客观且自成一体，提供了所有必要的数据和条件。这些假设，特别是关于浮点模型和 $\\delta$ 大小的假设，是分析此类数值现象的标准假设。这个问题并非无足轻重，需要仔细应用线性代数和数值分析的定义。结论是该问题有效。我们继续进行解答。\n\na) 首先，我们必须证明对于 $\\delta \\in (0,1)$，$Q$ 是对称正定 (SPD) 的，并推导 $V(x) = x^{\\top} Q x$ 的精确表达式。\n\n对称性：矩阵 $Q$ 给出为 $Q = \\begin{pmatrix} 1 & 1 - \\delta \\\\ 1 - \\delta & 1 \\end{pmatrix}$。通过观察可知，$Q_{12} = Q_{21} = 1 - \\delta$，所以 $Q = Q^{\\top}$。该矩阵是对称的。\n\n正定性：我们应用 Sylvester 判据，该判据指出，一个对称矩阵是正定的，当且仅当其所有顺序主子式都为正。\n第一个顺序主子式是 $\\Delta_1 = Q_{11} = 1$。这是正的。\n第二个顺序主子式是 $\\Delta_2 = \\det(Q)$。\n$$\n\\det(Q) = (1)(1) - (1-\\delta)(1-\\delta) = 1 - (1-\\delta)^2 = 1 - (1 - 2\\delta + \\delta^2) = 2\\delta - \\delta^2 = \\delta(2-\\delta).\n$$\n对于给定的范围 $\\delta \\in (0,1)$，我们有 $\\delta > 0$ 和 $2-\\delta > 1 > 0$。因此，$\\det(Q) = \\delta(2-\\delta) > 0$。\n由于所有顺序主子式均为正，因此对于所有 $\\delta \\in (0,1)$，矩阵 $Q$ 都是正定的。\n\n$V(x)$ 的精确计算：我们计算 $V(x) = x^{\\top} Q x$，其中 $x = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n$$\nV(x) = \\begin{pmatrix} 1 & -1 \\end{pmatrix} \\begin{pmatrix} 1 & 1 - \\delta \\\\ 1 - \\delta & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}\n$$\n首先，我们计算乘积 $Qx$：\n$$\nQx = \\begin{pmatrix} 1 & 1 - \\delta \\\\ 1 - \\delta & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + (1-\\delta)(-1) \\\\ (1-\\delta)(1) + 1(-1) \\end{pmatrix} = \\begin{pmatrix} 1 - (1-\\delta) \\\\ (1-\\delta) - 1 \\end{pmatrix} = \\begin{pmatrix} \\delta \\\\ -\\delta \\end{pmatrix}\n$$\n现在，我们计算点积 $x^{\\top}(Qx)$：\n$$\nV(x) = \\begin{pmatrix} 1 & -1 \\end{pmatrix} \\begin{pmatrix} \\delta \\\\ -\\delta \\end{pmatrix} = (1)(\\delta) + (-1)(-\\delta) = \\delta + \\delta = 2\\delta.\n$$\n$x^{\\top} Q x$ 的精确解析表达式为 $V = 2\\delta$。\n\nb) 接下来，我们分析朴素的有限精度计算，然后提出一个稳定的替代方案。\n\n朴素计算：过程是首先计算 $\\widehat{y} = \\text{fl}(Qx)$，然后计算 $\\widehat{V} = \\text{fl}(x^{\\top}\\widehat{y})$。浮点运算 $\\text{fl}(z)$ 将实数 $z$ 舍入到机器可表示数集合中最近的数。单位舍入误差 $u$ 是此运算的最大相对误差。\n设 $\\epsilon_m$ 为机器 epsilon。对于 IEEE 754，有 $u = \\frac{\\epsilon_m}{2}$。在 1 前面的浮点数是 $1-\\frac{\\epsilon_m}{2}$。$1-\\frac{\\epsilon_m}{2}$ 和 $1$ 之间的中点是 $1-\\frac{\\epsilon_m}{4}$。\n条件 $0 < \\delta < \\frac{u}{2}$ 意味着 $0 < \\delta < \\frac{\\epsilon_m}{4}$。\n这意味着 $1 - \\frac{\\epsilon_m}{4} < 1-\\delta < 1$。因为 $1-\\delta$ 比下一个更小的浮点数更接近 1，所以四舍五入到最近值得到：\n$$\n\\text{fl}(1-\\delta) = 1.\n$$\n现在我们追踪 $\\widehat{y} = \\text{fl}(Qx)$ 的计算过程。与 1 或 -1 的乘法是精确的。\n$$\n\\widehat{y}_1 = \\text{fl}(1 - (1-\\delta)) = \\text{fl}(1 - \\text{fl}(1-\\delta)) = \\text{fl}(1-1) = 0.\n$$\n$$\n\\widehat{y}_2 = \\text{fl}((1-\\delta) - 1) = \\text{fl}(\\text{fl}(1-\\delta) - 1) = \\text{fl}(1-1) = 0.\n$$\n计算出的中间向量是 $\\widehat{y} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n最后一步是点积：\n$$\n\\widehat{V} = \\text{fl}(x^{\\top}\\widehat{y}) = \\text{fl}(1 \\cdot 0 + (-1) \\cdot 0) = \\text{fl}(0) = 0.\n$$\n朴素计算得出的值为 0。这是由于在减去几乎相等的数时发生了灾难性抵消。\n\n数值稳定的重构：题目建议使用 Cholesky 分解 $Q=R^{\\top}R$，其中 $R$ 是一个上三角矩阵。设 $R = \\begin{pmatrix} r_{11} & r_{12} \\\\ 0 & r_{22} \\end{pmatrix}$。\n$$\nR^{\\top}R = \\begin{pmatrix} r_{11} & 0 \\\\ r_{12} & r_{22} \\end{pmatrix} \\begin{pmatrix} r_{11} & r_{12} \\\\ 0 & r_{22} \\end{pmatrix} = \\begin{pmatrix} r_{11}^2 & r_{11}r_{12} \\\\ r_{11}r_{12} & r_{12}^2 + r_{22}^2 \\end{pmatrix}.\n$$\n将其与 $Q = \\begin{pmatrix} 1 & 1-\\delta \\\\ 1-\\delta & 1 \\end{pmatrix}$ 相等可得：\n$r_{11}^2 = 1 \\implies r_{11}=1$ (按照惯例，对角线元素为正)。\n$r_{11}r_{12} = 1-\\delta \\implies r_{12} = 1-\\delta$。\n$r_{12}^2 + r_{22}^2 = 1 \\implies r_{22}^2 = 1-r_{12}^2 = 1-(1-\\delta)^2 = 2\\delta-\\delta^2 = \\delta(2-\\delta)$。\n所以，$r_{22} = \\sqrt{\\delta(2-\\delta)}$。请注意，对于小的 $\\delta$，$r_{22}$ 的这个表达式是数值稳定的，因为它不涉及几乎相等的数相减。\nCholesky 因子是 $R = \\begin{pmatrix} 1 & 1-\\delta \\\\ 0 & \\sqrt{\\delta(2-\\delta)} \\end{pmatrix}$。\n二次型可以重构为 $V(x) = x^{\\top}Qx = x^{\\top}R^{\\top}Rx = (Rx)^{\\top}(Rx) = \\|Rx\\|_2^2$。\n设 $z=Rx$。$z$ 的分量为：\n$z_1 = r_{11}x_1 + r_{12}x_2 = 1(1) + (1-\\delta)(-1) = 1 - (1-\\delta) = \\delta$。\n$z_2 = r_{22}x_2 = \\sqrt{\\delta(2-\\delta)}(-1) = -\\sqrt{\\delta(2-\\delta)}$。\n用这些分量表示的 $x^\\top Q x$ 的重构表达式为 $V(x) = z_1^2 + z_2^2$。代入 $z_1$ 和 $z_2$ 的表达式可得：\n$$\nV(x) = \\delta^2 + \\left(-\\sqrt{\\delta(2-\\delta)}\\right)^2 = \\delta^2 + \\delta(2-\\delta).\n$$\n该表达式简化为 $\\delta^2 + 2\\delta - \\delta^2 = 2\\delta$，证实了分析结果。这种形式是数值稳定的，因为通过代数方法避免了灾难性抵消。在浮点算术中直接计算 $\\delta^2 + \\delta(2-\\delta)$ 会得到一个准确的结果。\n\nc) 最后，我们计算朴素计算的相对前向误差。\n相对前向误差定义为 $\\frac{|\\widehat{V}-V|}{V}$。\n根据 a) 部分，精确值为 $V = 2\\delta$。\n根据 b) 部分，朴素有限精度计算得到的值为 $\\widehat{V} = 0$。\n将这些值代入误差公式：\n$$\n\\text{相对误差} = \\frac{|0 - 2\\delta|}{2\\delta}\n$$\n由于 $\\delta > 0$，我们有 $|-2\\delta| = 2\\delta$。\n$$\n\\text{相对误差} = \\frac{2\\delta}{2\\delta} = 1.\n$$\n朴素计算遭受了相对精度的完全损失，导致相对误差为 1，相当于 100% 的误差。", "answer": "$$\\boxed{1}$$", "id": "2735080"}]}