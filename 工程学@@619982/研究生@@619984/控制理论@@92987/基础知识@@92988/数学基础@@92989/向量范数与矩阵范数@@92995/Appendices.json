{"hands_on_practices": [{"introduction": "在控制理论中，对系统状态进行坐标变换是一种基本操作，但并非所有矩阵范数在此变换下都表现一致。本练习将引导您通过一个具体的例子，对比在正交变换下保持不变的诱导 $2$-范数 ($\\| \\cdot \\|_{2 \\to 2}$) 与坐标系敏感的诱导 $1$-范数 ($\\| \\cdot \\|_{1 \\to 1}$)。通过该实践，您将深刻理解为什么矩阵的“大小”或“增益”在不同坐标基下的度量可能存在巨大差异，这对于分析非正规系统尤为重要。[@problem_id:2757383]", "problem": "考虑连续时间线性时不变（LTI）状态方程 $\\dot{x}(t) = A x(t)$，其中 $A \\in \\mathbb{R}^{2 \\times 2}$。对于由正交矩阵 $Q \\in \\mathbb{R}^{2 \\times 2}$ 给出的状态坐标变换，令 $\\tilde{x}(t) = Q^{\\top} x(t)$，则变换后的状态矩阵为 $\\tilde{A} = Q^{\\top} A Q$。采用对任意 $p \\in [1,\\infty]$ 定义的诱导算子范数：\n$$\n\\|A\\|_{p \\to p} \\;=\\; \\sup_{x \\neq 0} \\frac{\\|A x\\|_{p}}{\\|x\\|_{p}}.\n$$\n仅使用此定义以及正交矩阵保持欧几里得范数不变的性质，来论证 $\\|\\cdot\\|_{2 \\to 2}$ 在正交变换下的性质。\n\n现在，我们特指以下这一族矩阵：\n$$\nA(\\theta,L) \\;=\\; Q(\\theta)\\,\\mathrm{diag}(L,1)\\,Q(\\theta)^{\\top},\n$$\n其中 $Q(\\theta) = \\begin{pmatrix}\\cos\\theta & -\\sin\\theta \\\\ \\\\[-4pt] \\sin\\theta & \\cos\\theta \\end{pmatrix}$ 是一个平面旋转矩阵，参数为 $\\theta = \\pi/3$（弧度）和 $L = 10$。这一选择会产生一个在标准基下具有较大非对角线元素的矩阵。\n\n在不援引任何无法从上述定义和基础线性代数推导出的结果的情况下，完成以下任务：\n- 从第一性原理出发，论证为何 $\\|A(\\theta,L)\\|_{2 \\to 2}$ 在由 $Q(\\theta)$ 诱导的正交相似变换下是不变的，并对给定的 $A(\\theta,L)$ 确定其值。\n- 通过计算标准基下的最大绝对列和，显式地计算 $\\|A(\\theta,L)\\|_{1 \\to 1}$。\n- 通过构造比值\n$$\nr \\;=\\; \\frac{\\|A(\\theta,L)\\|_{1 \\to 1}}{\\|\\mathrm{diag}(L,1)\\|_{1 \\to 1}}\n$$\n来比较 $\\|\\cdot\\|_{1 \\to 1}$ 对基选择的敏感性。\n\n将最终比值 $r$ 表示为一个纯数，并四舍五入到四位有效数字。无需单位。", "solution": "该问题是适定的，并且在科学上是合理的，其基础是应用于控制系统中的线性代数和矩阵理论的基本原理。我们开始求解。\n\n问题包括三个部分。首先，我们必须证明诱导 $2$-范数 $\\|\\cdot\\|_{2 \\to 2}$ 在正交相似变换下的不变性，并利用此性质确定 $\\|A(\\theta,L)\\|_{2 \\to 2}$ 的值。其次，我们必须计算 $\\|A(\\theta,L)\\|_{1 \\to 1}$。第三，我们必须计算该范数与对角矩阵 $\\mathrm{diag}(L,1)$ 的 $1$-范数的比值 $r$。\n\n第一部分：$\\|\\cdot\\|_{2 \\to 2}$ 范数的不变性及其值。\n令 $M \\in \\mathbb{R}^{n \\times n}$ 为一个矩阵，令 $Q \\in \\mathbb{R}^{n \\times n}$ 为一个正交矩阵，它满足 $Q^{\\top}Q = QQ^{\\top} = I$，其中 $I$ 是单位矩阵。问题指出，正交矩阵保持欧几里得范数（$p=2$ 范数）不变，此性质对任意向量 $y \\in \\mathbb{R}^n$ 可写作 $\\|Qy\\|_2 = \\|y\\|_2$。该性质对 $Q^{\\top}$ 也成立，因为它也是一个正交矩阵。\n\n$M$ 关于 $Q$ 的相似变换由 $\\tilde{M} = Q^{\\top}MQ$ 给出。我们需要利用定义来证明 $\\|\\tilde{M}\\|_{2 \\to 2} = \\|M\\|_{2 \\to 2}$：\n$$\n\\|M\\|_{2 \\to 2} = \\sup_{x \\neq 0} \\frac{\\|Mx\\|_2}{\\|x\\|_2}\n$$\n我们从写出 $\\|\\tilde{M}\\|_{2 \\to 2}$ 的定义开始：\n$$\n\\|\\tilde{M}\\|_{2 \\to 2} = \\sup_{y \\neq 0} \\frac{\\|\\tilde{M}y\\|_2}{\\|y\\|_2} = \\sup_{y \\neq 0} \\frac{\\|Q^{\\top}MQy\\|_2}{\\|y\\|_2}\n$$\n将 $Q^{\\top}$ 的保范数性质应用于分子，我们有 $\\|Q^{\\top}(MQy)\\|_2 = \\|MQy\\|_2$。表达式变为：\n$$\n\\|\\tilde{M}\\|_{2 \\to 2} = \\sup_{y \\neq 0} \\frac{\\|MQy\\|_2}{\\|y\\|_2}\n$$\n接着，我们将 $Q$ 的保范数性质应用于分母：$\\|y\\|_2 = \\|Qy\\|_2$。这得到：\n$$\n\\|\\tilde{M}\\|_{2 \\to 2} = \\sup_{y \\neq 0} \\frac{\\|M(Qy)\\|_2}{\\|Qy\\|_2}\n$$\n我们定义一个新的向量变量 $x = Qy$。由于 $Q$ 是一个可逆矩阵，所有非零向量 $y \\in \\mathbb{R}^n$ 的集合对应于所有非零向量 $x \\in \\mathbb{R}^n$ 的集合。因此，对所有非零 $y$ 取上确界等价于对所有非零 $x$ 取上确界：\n$$\n\\|\\tilde{M}\\|_{2 \\to 2} = \\sup_{x \\neq 0} \\frac{\\|Mx\\|_2}{\\|x\\|_2} = \\|M\\|_{2 \\to 2}\n$$\n至此完成了不变性的证明。\n\n给定的矩阵是 $A(\\theta,L) = Q(\\theta)\\,\\mathrm{diag}(L,1)\\,Q(\\theta)^{\\top}$。令 $D = \\mathrm{diag}(L,1)$。则 $A(\\theta,L) = Q(\\theta) D Q(\\theta)^{\\top}$。这是 $D$ 的一个相似变换，但与我们证明中的 $Q$ 和 $Q^\\top$ 的位置相反。然而，该证明可以稍作调整即可适用。若我们令 $\\tilde{A} = Q A Q^\\top$，则 $\\|\\tilde{A}\\|_{2 \\to 2} = \\|A\\|_{2 \\to 2}$。所以，$\\|A(\\theta,L)\\|_{2 \\to 2} = \\|D\\|_{2 \\to 2}$。\n\n我们计算 $D = \\mathrm{diag}(L,1)$ 在 $L=10$ 时的 $\\|D\\|_{2 \\to 2}$：$D = \\begin{pmatrix} 10 & 0 \\\\ 0 & 1 \\end{pmatrix}$。\n$$\n\\|D\\|_{2 \\to 2}^2 = \\left( \\sup_{x \\neq 0} \\frac{\\|Dx\\|_2}{\\|x\\|_2} \\right)^2 = \\sup_{x \\neq 0} \\frac{\\|Dx\\|_2^2}{\\|x\\|_2^2}\n$$\n对于 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$，我们有 $Dx = \\begin{pmatrix} 10x_1 \\\\ x_2 \\end{pmatrix}$。\n$$\n\\frac{\\|Dx\\|_2^2}{\\|x\\|_2^2} = \\frac{(10x_1)^2 + x_2^2}{x_1^2 + x_2^2} = \\frac{100x_1^2 + x_2^2}{x_1^2 + x_2^2}\n$$\n当 $x_1$ 相对于 $x_2$ 尽可能大时，该表达式取得最大值。这种情况发生在沿 $x_1$ 轴的向量上，即 $x_2=0$。对于这样的向量，该比值为 $\\frac{100x_1^2}{x_1^2} = 100$。当 $x_1=0$ 时，比值取最小值 $1$。上确界是 $100$。\n因此，$\\|A(\\theta,L)\\|_{2 \\to 2} = \\|D\\|_{2 \\to 2} = \\sqrt{100} = 10$。\n\n第二部分：计算 $\\|A(\\theta,L)\\|_{1 \\to 1}$。\n诱导 $1$-范数 $\\|A\\|_{1 \\to 1}$ 是矩阵 $A$ 的最大绝对列和。我们首先必须计算在给定参数 $\\theta=\\pi/3$ 和 $L=10$ 下的矩阵 $A(\\theta,L)$。\n旋转矩阵为 $Q(\\theta) = \\begin{pmatrix}\\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{pmatrix}$。当 $\\theta = \\pi/3$ 时，$\\cos(\\pi/3) = 1/2$ 且 $\\sin(\\pi/3) = \\sqrt{3}/2$。\n$$\nQ(\\pi/3) = \\begin{pmatrix} \\frac{1}{2} & -\\frac{\\sqrt{3}}{2} \\\\ \\frac{\\sqrt{3}}{2} & \\frac{1}{2} \\end{pmatrix}, \\quad D = \\begin{pmatrix} 10 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\quad Q(\\pi/3)^{\\top} = \\begin{pmatrix} \\frac{1}{2} & \\frac{\\sqrt{3}}{2} \\\\ -\\frac{\\sqrt{3}}{2} & \\frac{1}{2} \\end{pmatrix}\n$$\n我们计算 $A(\\theta,L) = Q(\\theta)D Q(\\theta)^{\\top}$：\n$$\nA = \\begin{pmatrix} \\frac{1}{2} & -\\frac{\\sqrt{3}}{2} \\\\ \\frac{\\sqrt{3}}{2} & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 10 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} & \\frac{\\sqrt{3}}{2} \\\\ -\\frac{\\sqrt{3}}{2} & \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} 5 & -\\frac{\\sqrt{3}}{2} \\\\ 5\\sqrt{3} & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} & \\frac{\\sqrt{3}}{2} \\\\ -\\frac{\\sqrt{3}}{2} & \\frac{1}{2} \\end{pmatrix}\n$$\n$A$ 的元素计算如下：\n$A_{11} = (5)(\\frac{1}{2}) + (-\\frac{\\sqrt{3}}{2})(-\\frac{\\sqrt{3}}{2}) = \\frac{5}{2} + \\frac{3}{4} = \\frac{13}{4}$。\n$A_{12} = (5)(\\frac{\\sqrt{3}}{2}) + (-\\frac{\\sqrt{3}}{2})(\\frac{1}{2}) = \\frac{5\\sqrt{3}}{2} - \\frac{\\sqrt{3}}{4} = \\frac{9\\sqrt{3}}{4}$。\n$A_{21} = (5\\sqrt{3})(\\frac{1}{2}) + (\\frac{1}{2})(-\\frac{\\sqrt{3}}{2}) = \\frac{5\\sqrt{3}}{2} - \\frac{\\sqrt{3}}{4} = \\frac{9\\sqrt{3}}{4}$。\n$A_{22} = (5\\sqrt{3})(\\frac{\\sqrt{3}}{2}) + (\\frac{1}{2})(\\frac{1}{2}) = \\frac{15}{2} + \\frac{1}{4} = \\frac{31}{4}$。\n因此，矩阵为 $A(\\pi/3, 10) = \\frac{1}{4}\\begin{pmatrix} 13 & 9\\sqrt{3} \\\\ 9\\sqrt{3} & 31 \\end{pmatrix}$。\n绝对列和为：\n$C_1 = |A_{11}| + |A_{21}| = \\frac{13}{4} + \\frac{9\\sqrt{3}}{4} = \\frac{13 + 9\\sqrt{3}}{4}$。\n$C_2 = |A_{12}| + |A_{22}| = \\frac{9\\sqrt{3}}{4} + \\frac{31}{4} = \\frac{31 + 9\\sqrt{3}}{4}$。\n范数 $\\|A\\|_{1 \\to 1} = \\max(C_1, C_2)$。由于 $31 > 13$，所以 $C_2 > C_1$。\n所以，$\\|A(\\pi/3, 10)\\|_{1 \\to 1} = \\frac{31 + 9\\sqrt{3}}{4}$。\n\n第三部分：计算比值 $r$。\n首先，我们求 $\\|\\mathrm{diag}(L,1)\\|_{1 \\to 1} = \\|D\\|_{1 \\to 1}$。\n对于 $D = \\begin{pmatrix} 10 & 0 \\\\ 0 & 1 \\end{pmatrix}$，其列和为：\n$C'_1 = |10| + |0| = 10$。\n$C'_2 = |0| + |1| = 1$。\n最大值为 $10$，所以 $\\|D\\|_{1 \\to 1} = 10$。\n\n比值 $r$ 为：\n$$\nr = \\frac{\\|A(\\theta,L)\\|_{1 \\to 1}}{\\|\\mathrm{diag}(L,1)\\|_{1 \\to 1}} = \\frac{\\frac{31 + 9\\sqrt{3}}{4}}{10} = \\frac{31 + 9\\sqrt{3}}{40}\n$$\n为获得数值，我们代入 $\\sqrt{3} \\approx 1.73205$：\n$$\nr \\approx \\frac{31 + 9(1.73205)}{40} = \\frac{31 + 15.58845}{40} = \\frac{46.58845}{40} \\approx 1.16471125\n$$\n四舍五入到四位有效数字，我们得到 $r \\approx 1.165$。这个比值表明，与 $\\|\\cdot\\|_{2 \\to 2}$ 范数不同，$\\|\\cdot\\|_{1 \\to 1}$ 范数对基的选择是敏感的，在旋转坐标系下的值比在对角化坐标系下的值大了超过 $16\\%$。", "answer": "$$\\boxed{1.165}$$", "id": "2757383"}, {"introduction": "上一个练习揭示了范数的基依赖性，现在我们将利用这一特性来主动改善矩阵的性质。本练习将引导您应用一种称为“对角缩放”的相似变换技术，这在计算控制中是一种重要的预处理方法。您将亲手设计一个对角矩阵 $D$，使得变换后的矩阵 $DAD^{-1}$ 的列范数达到均衡，并检验该变换是否能有效降低矩阵的 $1$-范数条件数 $\\kappa_1(A)$。[@problem_id:2757387]", "problem": "在线性时不变状态空间控制中，使用正对角矩阵 $D \\in \\mathbb{R}^{n \\times n}$ 进行状态坐标变换 $x = D z$ 会导出相似变换 $A \\mapsto B = D A D^{-1}$。涉及状态矩阵的计算敏感性通常由诱导 $1$-范数下的条件数反映。矩阵 $M$ 的诱导 $1$-范数定义为 $\\|M\\|_{1} = \\max_{1 \\leq j \\leq n} \\sum_{i=1}^{n} |m_{ij}|$，对于可逆矩阵 $M$，其 $1$-范数条件数为 $\\kappa_{1}(M) = \\|M\\|_{1} \\|M^{-1}\\|_{1}$。\n\n考虑一个所有元素均为严格正数的矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$\n$$\nA = \\begin{pmatrix}\n1 & 3 \\\\\n\\frac{1}{5} & 2\n\\end{pmatrix}.\n$$\n您将研究对角相似缩放是否能减小 $1$-范数条件数，并设计一种缩放，使得缩放后矩阵的列 $1$-范数相等。\n\n任务：\n1. 仅使用上述定义，计算 $\\|A\\|_{1}$、$\\|A^{-1}\\|_{1}$ 和 $\\kappa_{1}(A)$。\n2. 令 $D = \\operatorname{diag}(d_{1}, d_{2})$，其中 $d_{1} > 0$ 且 $d_{2} > 0$，并定义 $B = D A D^{-1}$。使用诱导 $1$-范数的定义，推导使得 $B$ 的两个列 $1$-范数相等的关于比率 $r = d_{2}/d_{1}$ 的条件。对 $r > 0$ 进行显式求解。\n3. 对于 $D$ 的这种选择，精确计算 $\\|B\\|_{1}$ 和 $\\|B^{-1}\\|_{1}$，并由此计算 $\\kappa_{1}(B)$。判断对于此设计，$\\kappa_{1}(B) < \\kappa_{1}(A)$ 是否成立。\n\n请将您在任务3中得到的 $\\kappa_{1}(B)$ 的精确闭式表达式作为最终答案。不要四舍五入。无需单位。", "solution": "所述问题在科学上是合理的、内容自洽的，并且在数学上是适定的。所有定义在线性代数和控制理论中都是标准的。给定的矩阵 $A$ 是可逆的，这使得其条件数的计算成为可能。我们开始进行解答。\n\n该问题分为三个连续的任务。我们将按顺序解决它们。\n\n任务1：计算 $\\|A\\|_{1}$、$\\|A^{-1}\\|_{1}$ 和 $\\kappa_{1}(A)$。\n\n给定的矩阵 $A$ 为\n$$\nA = \\begin{pmatrix}\n1 & 3 \\\\\n\\frac{1}{5} & 2\n\\end{pmatrix}\n$$\n矩阵的诱导 $1$-范数是最大绝对列和。对于矩阵 $A$，所有元素均为正，因此我们无需取绝对值。\n第一列的和为 $1 + \\frac{1}{5} = \\frac{6}{5}$。\n第二列的和为 $3 + 2 = 5$。\n$A$ 的 $1$-范数是这两个值的最大值：\n$$\n\\|A\\|_{1} = \\max\\left(\\frac{6}{5}, 5\\right) = 5\n$$\n接下来，我们计算 $A$ 的逆矩阵。$A$ 的行列式为\n$$\n\\det(A) = (1)(2) - (3)\\left(\\frac{1}{5}\\right) = 2 - \\frac{3}{5} = \\frac{10-3}{5} = \\frac{7}{5}\n$$\n由于 $\\det(A) \\neq 0$，该矩阵是可逆的。其逆矩阵由下式给出\n$$\nA^{-1} = \\frac{1}{\\det(A)} \\begin{pmatrix}\n2 & -3 \\\\\n-\\frac{1}{5} & 1\n\\end{pmatrix} = \\frac{5}{7} \\begin{pmatrix}\n2 & -3 \\\\\n-\\frac{1}{5} & 1\n\\end{pmatrix} = \\begin{pmatrix}\n\\frac{10}{7} & -\\frac{15}{7} \\\\\n-\\frac{1}{7} & \\frac{5}{7}\n\\end{pmatrix}\n$$\n现在，我们计算 $A^{-1}$ 的 $1$-范数。我们必须对每列中的元素取绝对值后求和。\n第一列的和为 $\\left|\\frac{10}{7}\\right| + \\left|-\\frac{1}{7}\\right| = \\frac{10}{7} + \\frac{1}{7} = \\frac{11}{7}$。\n第二列的和为 $\\left|-\\frac{15}{7}\\right| + \\left|\\frac{5}{7}\\right| = \\frac{15}{7} + \\frac{5}{7} = \\frac{20}{7}$。\n$A^{-1}$ 的 $1$-范数是这两个值的最大值：\n$$\n\\|A^{-1}\\|_{1} = \\max\\left(\\frac{11}{7}, \\frac{20}{7}\\right) = \\frac{20}{7}\n$$\n$A$ 的 $1$-范数条件数是这些范数的乘积：\n$$\n\\kappa_{1}(A) = \\|A\\|_{1} \\|A^{-1}\\|_{1} = 5 \\cdot \\frac{20}{7} = \\frac{100}{7}\n$$\n\n任务2：找出使得 $B=DAD^{-1}$ 的两个列 $1$-范数相等的关于比率 $r = d_{2}/d_{1}$ 的条件。\n\n令 $D = \\operatorname{diag}(d_{1}, d_{2}) = \\begin{pmatrix} d_{1} & 0 \\\\ 0 & d_{2} \\end{pmatrix}$。其逆矩阵为 $D^{-1} = \\begin{pmatrix} 1/d_{1} & 0 \\\\ 0 & 1/d_{2} \\end{pmatrix}$。\n相似变换得到矩阵 $B$：\n$$\nB = DAD^{-1} = \\begin{pmatrix} d_{1} & 0 \\\\ 0 & d_{2} \\end{pmatrix} \\begin{pmatrix} 1 & 3 \\\\ \\frac{1}{5} & 2 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{d_{1}} & 0 \\\\ 0 & \\frac{1}{d_{2}} \\end{pmatrix}\n$$\n$$\nB = \\begin{pmatrix} d_{1} & 3d_{1} \\\\ \\frac{1}{5}d_{2} & 2d_{2} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{d_{1}} & 0 \\\\ 0 & \\frac{1}{d_{2}} \\end{pmatrix} = \\begin{pmatrix} (d_{1})(\\frac{1}{d_{1}}) & (3d_{1})(\\frac{1}{d_{2}}) \\\\ (\\frac{1}{5}d_{2})(\\frac{1}{d_{1}}) & (2d_{2})(\\frac{1}{d_{2}}) \\end{pmatrix} = \\begin{pmatrix} 1 & 3\\frac{d_{1}}{d_{2}} \\\\ \\frac{1}{5}\\frac{d_{2}}{d_{1}} & 2 \\end{pmatrix}\n$$\n使用定义 $r = d_{2}/d_{1}$，我们有 $1/r = d_{1}/d_{2}$。矩阵 $B$ 可以写为：\n$$\nB = \\begin{pmatrix} 1 & \\frac{3}{r} \\\\ \\frac{r}{5} & 2 \\end{pmatrix}\n$$\n由于 $d_{1} > 0$ 且 $d_{2} > 0$，我们有 $r > 0$。$B$ 的元素均为正。\n$B$ 的绝对列和（列范数）为：\n第1列：$C_{1} = 1 + \\frac{r}{5}$\n第2列：$C_{2} = \\frac{3}{r} + 2$\n为了使列范数相等，我们令 $C_{1} = C_{2}$：\n$$\n1 + \\frac{r}{5} = \\frac{3}{r} + 2\n$$\n整理各项以求解 $r$：\n$$\n\\frac{r}{5} - 1 = \\frac{3}{r}\n$$\n两边乘以 $5r$（由于 $r>0$，该项非零）：\n$$\nr^{2} - 5r = 15 \\implies r^{2} - 5r - 15 = 0\n$$\n这是一个关于 $r$ 的二次方程。我们使用二次公式 $r = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解：\n$$\nr = \\frac{-(-5) \\pm \\sqrt{(-5)^{2} - 4(1)(-15)}}{2(1)} = \\frac{5 \\pm \\sqrt{25 + 60}}{2} = \\frac{5 \\pm \\sqrt{85}}{2}\n$$\n由于我们必须有 $r > 0$，并且 $\\sqrt{85} > \\sqrt{25} = 5$，解 $r = \\frac{5 - \\sqrt{85}}{2}$ 是负数。我们必须选择正根：\n$$\nr = \\frac{5 + \\sqrt{85}}{2}\n$$\n\n任务3：计算 $\\|B\\|_{1}$、$\\|B^{-1}\\|_{1}$、$\\kappa_{1}(B)$ 并与 $\\kappa_{1}(A)$ 进行比较。\n\n使用任务2中得到的 $r$ 值，$B$ 的列范数相等。我们可以计算这个公共值来求得 $\\|B\\|_{1}$。使用第一列范数的表达式：\n$$\n\\|B\\|_{1} = 1 + \\frac{r}{5} = 1 + \\frac{1}{5}\\left(\\frac{5 + \\sqrt{85}}{2}\\right) = 1 + \\frac{5 + \\sqrt{85}}{10} = \\frac{10 + 5 + \\sqrt{85}}{10} = \\frac{15 + \\sqrt{85}}{10}\n$$\n接下来，我们计算 $B^{-1}$。$B$ 的行列式为 $\\det(B) = (1)(2) - (\\frac{3}{r})(\\frac{r}{5}) = 2 - \\frac{3}{5} = \\frac{7}{5}$。这与 $\\det(A)$ 相等，这对于相似变换是符合预期的。\n$$\nB^{-1} = \\frac{1}{\\det(B)} \\begin{pmatrix} 2 & -\\frac{3}{r} \\\\ -\\frac{r}{5} & 1 \\end{pmatrix} = \\frac{5}{7} \\begin{pmatrix} 2 & -\\frac{3}{r} \\\\ -\\frac{r}{5} & 1 \\end{pmatrix} = \\begin{pmatrix}\n\\frac{10}{7} & -\\frac{15}{7r} \\\\ -\\frac{r}{7} & \\frac{5}{7}\n\\end{pmatrix}\n$$\n$B^{-1}$ 的绝对列和为：\n第1列：$C'_{1} = \\left|\\frac{10}{7}\\right| + \\left|-\\frac{r}{7}\\right| = \\frac{10+r}{7}$\n第2列：$C'_{2} = \\left|-\\frac{15}{7r}\\right| + \\left|\\frac{5}{7}\\right| = \\frac{15}{7r} + \\frac{5}{7} = \\frac{15+5r}{7r}$\n我们代入 $r = \\frac{5 + \\sqrt{85}}{2}$：\n$C'_{1} = \\frac{1}{7} \\left(10 + \\frac{5 + \\sqrt{85}}{2}\\right) = \\frac{20 + 5 + \\sqrt{85}}{14} = \\frac{25 + \\sqrt{85}}{14}$。\n对于 $C'_{2}$，我们可以使用来自 $r$ 的二次方程的关系式：$r-5 = \\frac{15}{r}$。\n$C'_{2} = \\frac{1}{7}\\left(\\frac{15}{r} + 5 \\right) = \\frac{1}{7}\\left((r-5) + 5\\right) = \\frac{r}{7} = \\frac{1}{7}\\left(\\frac{5 + \\sqrt{85}}{2}\\right) = \\frac{5 + \\sqrt{85}}{14}$。\n我们取这两个和的最大值作为 $\\|B^{-1}\\|_{1}$：\n$$\n\\|B^{-1}\\|_{1} = \\max\\left(\\frac{25 + \\sqrt{85}}{14}, \\frac{5 + \\sqrt{85}}{14}\\right) = \\frac{25 + \\sqrt{85}}{14}\n$$\n$B$ 的条件数是 $\\kappa_{1}(B) = \\|B\\|_{1}\\|B^{-1}\\|_{1}$：\n$$\n\\kappa_{1}(B) = \\left(\\frac{15 + \\sqrt{85}}{10}\\right) \\left(\\frac{25 + \\sqrt{85}}{14}\\right) = \\frac{(15 + \\sqrt{85})(25 + \\sqrt{85})}{140}\n$$\n展开分子：\n$(15 + \\sqrt{85})(25 + \\sqrt{85}) = 15 \\cdot 25 + 15\\sqrt{85} + 25\\sqrt{85} + (\\sqrt{85})^{2} = 375 + 40\\sqrt{85} + 85 = 460 + 40\\sqrt{85}$。\n所以，\n$$\n\\kappa_{1}(B) = \\frac{460 + 40\\sqrt{85}}{140} = \\frac{46 + 4\\sqrt{85}}{14} = \\frac{23 + 2\\sqrt{85}}{7}\n$$\n最后，我们将 $\\kappa_{1}(B)$ 与 $\\kappa_{1}(A) = \\frac{100}{7}$ 进行比较。我们必须比较 $23 + 2\\sqrt{85}$ 与 $100$。这等价于比较 $2\\sqrt{85}$ 与 $77$，或者比较 $\\sqrt{85}$ 与 $38.5$。两边平方：$(\\sqrt{85})^{2} = 85$ 且 $(38.5)^{2} = 1482.25$。因为 $85 < 1482.25$，所以 $\\sqrt{85} < 38.5$。因此，$23 + 2\\sqrt{85} < 100$。\n我们得出结论，$\\kappa_{1}(B) < \\kappa_{1}(A)$ 成立，所以对角缩放确实减小了条件数。\n问题要求给出 $\\kappa_{1}(B)$ 的精确表达式。", "answer": "$$\n\\boxed{\\frac{23 + 2\\sqrt{85}}{7}}\n$$", "id": "2757387"}, {"introduction": "本章的最后一个实践将探究一个核心理论问题：对于一个给定的线性系统，其动态行为的“增益”是否存在一个最小的可能度量？您将学习如何通过构造一个特定的正定矩阵 $P$ 来定义一个加权范数 $\\| \\cdot \\|_P$，使得在该范数下，矩阵 $A$ 的诱导范数 $\\|A\\|_P$ 能够达到其理论下界——谱半径 $\\rho(A)$。这个练习不仅揭示了范数、特征值和Lyapunov函数之间的深刻联系，还阐明了在非正规系统中，获得最优范数度量与变换矩阵的数值条件数之间存在的根本性权衡。[@problem_id:2757370]", "problem": "设 $A \\in \\mathbb{C}^{n \\times n}$ 是一个可对角化的矩阵，使得 $A = V \\Lambda V^{-1}$，其中 $V$ 可逆且 $\\Lambda = \\mathrm{diag}(\\lambda_{1},\\dots,\\lambda_{n})$。对于任意对称正定矩阵 $P \\succ 0$，定义 $P$-加权向量范数为 $\\|x\\|_{P} = \\sqrt{x^{*} P x}$，以及诱导矩阵范数为 $\\|A\\|_{P} = \\sup_{x \\neq 0} \\frac{\\|A x\\|_{P}}{\\|x\\|_{P}}$。仅使用这些定义以及二次型和特征值的标准性质，完成以下任务。\n\n1. 构造一个对称正定矩阵族 $P \\succ 0$，该族矩阵与 $A$ 的特征向量基对齐，即 $V$ 的列向量关于内积 $\\langle x, y \\rangle_{P} = x^{*} P y$ 相互正交。从第一性原理出发证明，对于任意这样的 $P$，诱导范数满足 $\\|A\\|_{P} = \\max_{i} |\\lambda_{i}|$。证明该值是在所有以这种方式对齐的 $P$ 的选择中可以达到的最小值。\n\n2. 考虑具体的非正规矩阵\n$$\nA = \\begin{bmatrix}\n3 & 100 \\\\\n0 & 1\n\\end{bmatrix}.\n$$\n使用你在第1部分构造中最简单的容许选择，计算一个与 $A$ 的特征向量基对齐的显式矩阵 $P \\succ 0$，然后评估相应的 $\\|A\\|_{P}$。\n\n3. 使用 $V$ 的奇异值讨论谱条件数 $\\kappa_{2}(P) = \\|P\\|_{2} \\,\\|P^{-1}\\|_{2}$ 如何依赖于 $V$。对于上述矩阵 $A$，解释在最小化 $\\|A\\|_{P}$ 与 $P$ 的条件数之间的权衡。\n\n你的最终答案应该是第2部分中给定 $A$ 的 $\\|A\\|_{P}$ 可达到的最小值，表示为一个无单位的精确实数。请勿对最终答案进行四舍五入。", "solution": "该问题已经过验证。已知条件为：一个可对角化的矩阵 $A \\in \\mathbb{C}^{n \\times n}$ 满足 $A = V \\Lambda V^{-1}$，其中 $\\Lambda = \\mathrm{diag}(\\lambda_{1},\\dots,\\lambda_{n})$；一个对称正定矩阵 $P \\succ 0$；一个 $P$-加权向量范数 $\\|x\\|_{P} = \\sqrt{x^{*} P x}$；一个诱导矩阵范数 $\\|A\\|_{P} = \\sup_{x \\neq 0} \\frac{\\|A x\\|_{P}}{\\|x\\|_{P}}$；一个内积 $\\langle x, y \\rangle_{P} = x^{*} P y$；一个对齐条件，即 $V$ 的列向量关于此内积相互正交；一个具体矩阵 $A = \\begin{bmatrix} 3 & 100 \\\\ 0 & 1 \\end{bmatrix}$；以及谱条件数的定义 $\\kappa_{2}(P) = \\|P\\|_{2} \\,\\|P^{-1}\\|_{2}$。该问题有坚实的线性代数和矩阵理论基础，提法得当，定义和目标明确，并以客观的数学语言表述。问题本身是自洽的，不违反任何基本原则。因此，该问题被视为有效，并将提供解答。\n\n第1部分：$P$ 的构造及范数性质的证明。\n设可逆矩阵 $V$ 的列是 $A$ 的特征向量 $v_{1}, \\dots, v_{n}$。这些向量关于内积 $\\langle x, y \\rangle_{P} = x^{*} P y$ 相互正交的条件意味着对于 $i \\neq j$，我们有 $\\langle v_{i}, v_{j} \\rangle_{P} = v_{i}^{*} P v_{j} = 0$。这意味着矩阵乘积 $V^{*}PV$ 必须是一个对角矩阵。我们将此对角矩阵记为 $D = \\mathrm{diag}(d_{1}, \\dots, d_{n})$。\n为了使 $P$ 是正定的（$P \\succ 0$），对于任何非零向量 $x \\in \\mathbb{C}^{n}$，必须有 $x^{*} P x > 0$。由于 $V$ 是可逆的，任何非零向量 $x \\neq 0$ 都可以写成 $x = Vy$ 的形式，其中 $y \\in \\mathbb{C}^{n}$ 是某个非零向量。将此代入二次型得到：\n$$x^{*} P x = (Vy)^{*} P (Vy) = y^{*} V^{*} P V y = y^{*} D y = \\sum_{i=1}^{n} d_{i} |y_{i}|^{2}$$\n要使此表达式对任何非零的 $y$ 都严格为正，$D$ 的所有对角元必须严格为正，即对于所有 $i=1, \\dots, n$ 都有 $d_{i} > 0$。\n从关系式 $V^{*} P V = D$ 中，我们可以用 $V$ 和 $D$ 表示 $P$。由于 $V$ 可逆， $V^{*}$ 也可逆。我们可以左乘 $(V^{*})^{-1}$ 并右乘 $V^{-1}$ 来得到 $P = (V^{*})^{-1} D V^{-1}$。\n这就定义了与 $A$ 的特征向量基对齐的对称正定矩阵 $P$ 族：它们的形式为 $P = (V^{*})^{-1} D V^{-1}$，其中 $D$ 是任何对角线上元素严格为正的对角矩阵。\n\n现在，我们证明对于任何这样的 $P$，诱导范数 $\\|A\\|_{P}$ 等于 $A$ 的谱半径 $\\rho(A) = \\max_{i} |\\lambda_{i}|$。范数的平方由下式给出：\n$$\\|A\\|_{P}^{2} = \\left(\\sup_{x \\neq 0} \\frac{\\|A x\\|_{P}}{\\|x\\|_{P}}\\right)^2 = \\sup_{x \\neq 0} \\frac{\\|A x\\|_{P}^{2}}{\\|x\\|_{P}^{2}} = \\sup_{x \\neq 0} \\frac{x^{*} A^{*} P A x}{x^{*} P x}$$\n我们使用对角化 $A = V \\Lambda V^{-1}$，这意味着 $A^{*} = (V^{-1})^{*} \\Lambda^{*} V^{*}$。将其代入分子：\n$$x^{*} A^{*} P A x = x^{*} (V^{-1})^{*} \\Lambda^{*} V^{*} P V \\Lambda V^{-1} x$$\n使用对齐性质 $V^{*} P V = D$，表达式简化为：\n$$x^{*} (V^{-1})^{*} \\Lambda^{*} D \\Lambda V^{-1} x$$\n我们进行变量替换 $y = V^{-1}x$。由于 $V$ 是可逆的，对所有非零 $x$ 的上确界等价于对所有非零 $y$ 的上确界。分子变为 $y^{*} \\Lambda^{*} D \\Lambda y$。\n分母变为 $x^{*} P x = y^{*} V^{*} P V y = y^{*} D y$。\n因此，范数平方的表达式变为：\n$$\\|A\\|_{P}^{2} = \\sup_{y \\neq 0} \\frac{y^{*} \\Lambda^{*} D \\Lambda y}{y^{*} D y}$$\n已知 $\\Lambda = \\mathrm{diag}(\\lambda_{1}, \\dots, \\lambda_{n})$ 和 $D = \\mathrm{diag}(d_{1}, \\dots, d_{n})$，我们有 $\\Lambda^{*} = \\mathrm{diag}(\\bar{\\lambda}_{1}, \\dots, \\bar{\\lambda}_{n})$ 和 $\\Lambda^{*} D \\Lambda = \\mathrm{diag}(d_{1}|\\lambda_{1}|^{2}, \\dots, d_{n}|\\lambda_{n}|^{2})$。\n该比率可以写成 $y$ 的分量形式：\n$$\\frac{\\sum_{i=1}^{n} d_{i} |\\lambda_{i}|^{2} |y_{i}|^{2}}{\\sum_{i=1}^{n} d_{i} |y_{i}|^{2}}$$\n这是值 $|\\lambda_{i}|^{2}$ 的一个加权平均，其中非负权重为 $w_{i} = d_{i}|y_{i}|^{2}$。这样一个加权平均的上确界是所平均的值中的最大值。设 $M = \\max_{i} |\\lambda_{i}|^{2}$。那么 $\\sum_{i} d_{i} |\\lambda_{i}|^{2} |y_{i}|^{2} \\le \\sum_{i} d_{i} M |y_{i}|^{2} = M \\sum_{i} d_{i} |y_{i}|^{2}$。因此，该比率总是小于或等于 $M$。为了证明上确界是 $M$，设 $j$ 是一个使得 $|\\lambda_{j}|^{2} = M$ 的索引。通过选择 $y$ 为标准基向量 $e_{j}$，该比率变为 $\\frac{d_{j}|\\lambda_{j}|^{2}}{d_{j}} = |\\lambda_{j}|^{2} = M$。\n因此，$\\|A\\|_{P}^{2} = \\max_{i} |\\lambda_{i}|^{2} = (\\rho(A))^{2}$。两边取平方根，得到 $\\|A\\|_{P} = \\rho(A) = \\max_{i} |\\lambda_{i}|$。\n对于从此对齐族中任意选择的 $P$，诱导范数的值是恒定的，等于 $\\rho(A)$。因此，在此族上的最小值显然是 $\\rho(A)$。此外，矩阵分析中的一个基本结果是，对于任何诱导范数 $\\|\\cdot\\|$，都有 $\\rho(A) \\le \\|A\\|$。由于我们的构造提供了一个可以达到此下界的范数，$\\rho(A)$ 是所有可能诱导范数的下确界，因此它就是可能的最小值。\n\n第2部分：对给定矩阵 $A$ 的显式计算。\n给定矩阵 $A = \\begin{bmatrix} 3 & 100 \\\\ 0 & 1 \\end{bmatrix}$。由于 $A$ 是上三角矩阵，其特征值是其对角元素：$\\lambda_{1} = 3$ 和 $\\lambda_{2} = 1$。谱半径是 $\\rho(A) = \\max(|3|, |1|) = 3$。\n我们求特征向量：\n对于 $\\lambda_{1}=3$：$(A-3I)v_{1} = \\begin{bmatrix} 0 & 100 \\\\ 0 & -2 \\end{bmatrix}v_{1} = 0$，得到 $v_{1} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。\n对于 $\\lambda_{2}=1$：$(A-1I)v_{2} = \\begin{bmatrix} 2 & 100 \\\\ 0 & 0 \\end{bmatrix}v_{2} = 0$，这意味着 $2x+100y=0$。我们可以选择 $v_{2} = \\begin{bmatrix} -50 \\\\ 1 \\end{bmatrix}$。\n特征向量矩阵是 $V = \\begin{bmatrix} 1 & -50 \\\\ 0 & 1 \\end{bmatrix}$。\n对齐矩阵族是 $P=(V^*)^{-1} D V^{-1}$，由于 $V$ 是实矩阵，所以 $V^* = V^T$。问题要求最简单的容许选择，我们取 $D=I$（单位矩阵），即 $d_1=1$ 和 $d_2=1$。\n首先，我们求 $V^{-1}$：$\\det(V) = 1$，所以 $V^{-1} = \\begin{bmatrix} 1 & 50 \\\\ 0 & 1 \\end{bmatrix}$。\n接下来，我们求 $(V^*)^{-1} = (V^T)^{-1} = (V^{-1})^T = \\begin{bmatrix} 1 & 0 \\\\ 50 & 1 \\end{bmatrix}$。\n现在我们计算 $D=I$ 时的 $P$：\n$$P = (V^*)^{-1} I V^{-1} = \\begin{bmatrix} 1 & 0 \\\\ 50 & 1 \\end{bmatrix} \\begin{bmatrix} 1 & 50 \\\\ 0 & 1 \\end{bmatrix} = \\begin{bmatrix} 1 & 50 \\\\ 50 & 2501 \\end{bmatrix}$$\n为了验证，$P$ 是对称的。对于正定性，其顺序主子式为 $1 > 0$ 和 $\\det(P) = 1(2501) - 50^2 = 2501 - 2500 = 1 > 0$。所以 $P \\succ 0$。\n根据第1部分的结果，对于任何对齐的 $P$（包括这个特定的 $P$），诱导范数由 $A$ 的谱半径给出。\n因此，$\\|A\\|_{P} = \\rho(A) = 3$。\n\n第3部分：关于条件数和权衡的讨论。\n$P$ 的谱条件数是 $\\kappa_{2}(P) = \\|P\\|_{2}\\|P^{-1}\\|_{2}$。由于 $P$ 是对称正定矩阵，其 $2$-范数是其最大特征值，即 $\\|P\\|_{2} = \\lambda_{\\max}(P)$，而 $\\|P^{-1}\\|_{2} = \\lambda_{\\max}(P^{-1}) = 1/\\lambda_{\\min}(P)$。因此，$\\kappa_{2}(P) = \\frac{\\lambda_{\\max}(P)}{\\lambda_{\\min}(P)}$。\n我们研究 $\\kappa_{2}(P)$ 对 $V$ 的依赖性。让我们使用最简单的选择 $D=I$。那么 $P = (V^*)^{-1}V^{-1} = (VV^*)^{-1}$。从而，$P^{-1} = VV^*$。\n矩阵 $VV^*$ 是厄米特正定的。它的特征值是 $V$ 的奇异值的平方。设 $V$ 的奇异值为 $\\sigma_{1} \\ge \\dots \\ge \\sigma_{n} > 0$。$P^{-1}=VV^*$ 的特征值为 $\\lambda_{i}(P^{-1}) = \\sigma_{i}(V)^2$。\n那么 $\\lambda_{\\max}(P^{-1}) = \\sigma_{\\max}(V)^2$ 且 $\\lambda_{\\min}(P^{-1}) = \\sigma_{\\min}(V)^2$。\n$P$ 的条件数与 $P^{-1}$ 的条件数相同：\n$$\\kappa_{2}(P) = \\kappa_{2}(P^{-1}) = \\frac{\\lambda_{\\max}(P^{-1})}{\\lambda_{\\min}(P^{-1})} = \\frac{\\sigma_{\\max}(V)^2}{\\sigma_{\\min}(V)^2} = \\left(\\frac{\\sigma_{\\max}(V)}{\\sigma_{\\min}(V)}\\right)^2 = (\\kappa_{2}(V))^2$$\n这表明所求度量矩阵 $P$ 的条件数是特征向量矩阵 $V$ 的条件数的平方。\n\n对于具体矩阵 $A$，$V = \\begin{bmatrix} 1 & -50 \\\\ 0 & 1 \\end{bmatrix}$。特征向量 $v_1$ 和 $v_2$ 近似平行，这表明 $V$ 是病态的。$V$ 的奇异值是 $V^T V = \\begin{bmatrix} 1 & -50 \\\\ -50 & 2501 \\end{bmatrix}$ 的特征值的平方根。特征方程是 $\\lambda^2 - 2502\\lambda + 1 = 0$。特征值是 $\\lambda(V^TV) = 1251 \\pm \\sqrt{1251^2-1}$。\n所以，$\\sigma_{\\max}(V)^2 = 1251 + \\sqrt{1251^2-1}$ 且 $\\sigma_{\\min}(V)^2 = 1251 - \\sqrt{1251^2-1}$。\n$V$ 的条件数是 $\\kappa_2(V) = \\frac{\\sigma_{\\max}(V)}{\\sigma_{\\min}(V)} = \\sqrt{\\frac{1251 + \\sqrt{1251^2-1}}{1251 - \\sqrt{1251^2-1}}} = 1251 + \\sqrt{1251^2-1} \\approx 2502$。\n我们的 $P$ 的条件数是 $\\kappa_{2}(P) = (\\kappa_{2}(V))^2 \\approx (2502)^2 \\approx 6.26 \\times 10^6$，这是一个非常大的数。\n\n权衡关系如下：\n为了获得等于谱半径 $\\rho(A)$（任何诱导范数的可能最小值）的矩阵范数 $\\|A\\|_{P}$，必须使用由“对齐”族中的矩阵 $P$ 定义的度量。对于一个非正规矩阵 $A$，如果其特征向量近似线性相关，则特征向量矩阵 $V$ 是病态的（$\\kappa_{2}(V) \\gg 1$）。如前所示，这导致一个极端病态的矩阵 $P$（$\\kappa_{2}(P) = (\\kappa_{2}(V))^2 \\gg 1$）。在数值计算中使用这样的 $P$ 会有问题，因为它会放大误差。范数的水平集 $x^*Px=c$ 变成了高度偏心的椭球，反映了一种扭曲的几何结构。\n相比之下，可以使用一个条件数良好的度量，比如标准的欧几里得度量（$P=I$, $\\kappa_2(P)=1$）。然而，相应的范数 $\\|A\\|_{2} = \\sigma_{\\max}(A)$ 可能远大于 $\\rho(A)$。对于我们的 $A$，$\\|A\\|_{2} = \\sigma_{\\max}(A) = \\sqrt{5005 + \\sqrt{5005^2-9}} \\approx 100.05$，这显著大于 $\\rho(A)=3$。\n这说明了非正规矩阵的一个基本权衡：人们既可以以使用数值上不稳定、病态的度量 $P$ 为代价来实现最优范数值 $\\|A\\|_{P}=\\rho(A)$，也可以以范数值 $\\|A\\|_{2}$ 可能远大于谱半径为代价来使用像 $P=I$ 这样的良态度量。这种权衡的严重性取决于 $A$ 的非正规性程度，该程度可以通过其特征向量矩阵 $V$ 的条件数来量化。", "answer": "$$\\boxed{3}$$", "id": "2757370"}]}