{"hands_on_practices": [{"introduction": "相似变换不仅仅是抽象的代数工具，更是揭示系统内在行为的实用方法。本练习将指导你构建一个相似变换，将一个标准的 $2 \\times 2$ 状态矩阵转换为其实数若尔当标准型，从而直观地揭示出由复共轭特征值产生的旋转与缩放动态。通过从第一性原理出发，这个实践将加深你对特征结构如何决定系统动力学行为的理解 [@problem_id:2744704]。", "problem": "考虑实线性时不变 (LTI) 状态空间模型 $\\dot{x} = A x$，其中 $A \\in \\mathbb{R}^{2 \\times 2}$ 是一个实 $2 \\times 2$ 状态矩阵。回顾基本定义：若存在一个可逆矩阵 $S$ 使得 $S^{-1} A S = J$ 成立，则两个矩阵 $A$ 和 $J$ 是相似的；矩阵 $A$ 的一个特征对 $(\\lambda, v)$ 满足 $A v = \\lambda v$，其中 $\\lambda \\in \\mathbb{C}$ 且 $v \\in \\mathbb{C}^{2} \\setminus \\{0\\}$。对于实矩阵 $A$，其非实数特征值以复共轭对的形式出现。对应于这样一对特征值的实若尔当标准型是一个表示旋转缩放的实 $2 \\times 2$ 分块。\n\n仅使用这些定义以及相似变换和特征对的性质，完成以下任务：\n\n1. 从 $A v = \\lambda v$ 出发，其中 $\\lambda = \\alpha + \\mathrm{i} \\beta$（$\\alpha, \\beta \\in \\mathbb{R}$）且 $v = p + \\mathrm{i} q$（$p, q \\in \\mathbb{R}^{2}$），推导一个实可逆相似变换 $S \\in \\mathbb{R}^{2 \\times 2}$，使得 $S^{-1} A S$ 是对应于特征值 $\\alpha \\pm \\mathrm{i} \\beta$ 的实若尔当分块。用 $\\alpha$ 和 $\\beta$ 明确表示出所得的实若尔当分块，并用 $A$ 的实不变量来确定 $\\alpha$ 和 $\\beta$。\n\n2. 将你的构造方法应用于具体矩阵\n$$\nA = \\begin{pmatrix}\n3 & -5 \\\\\n2 & 1\n\\end{pmatrix},\n$$\n并给出一个满足 $S^{-1} A S$ 等于与 $A$ 的特征值相关联的实若尔当分块的、显式的实可逆矩阵 $S$。你给出的 $S$ 必须具有精确的整数元素。\n\n3. 仅使用相似变换下的不变量（如迹和行列式），论证存在一个实矩阵 $S$ 能将 $A$ 转换为一个单一的实 $2 \\times 2$ 旋转缩放分块的充分必要条件。用 $\\operatorname{tr}(A)$ 和 $\\det(A)$ 来表述这个条件。\n\n答案规格：最终答案仅提供你在第2部分中得到的具体矩阵 $S$，写成一个 $2 \\times 2$ 矩阵的形式。无需四舍五入，不涉及单位。", "solution": "该问题陈述清晰，具有科学依据，并包含了完整求解所需的所有信息。我们将按要求进行推导和计算。问题分为三个部分，我们将依次解决。\n\n第1部分：实相似变换与实若尔当型的推导。\n\n我们从实矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$ 的特征对 $(\\lambda, v)$ 的定义方程 $A v = \\lambda v$ 开始。\n题目指定了一个非实数特征值 $\\lambda = \\alpha + \\mathrm{i} \\beta$，其中 $\\alpha, \\beta \\in \\mathbb{R}$ 且 $\\beta \\neq 0$，以及对应的特征向量 $v = p + \\mathrm{i} q$，其中 $p, q \\in \\mathbb{R}^{2}$。由于 $v$ 是一个特征向量，所以 $v \\neq 0$，这意味着 $p$ 和 $q$ 不能同时为零向量。\n\n将 $\\lambda$ 和 $v$ 的复数形式代入特征值方程：\n$$A (p + \\mathrm{i} q) = (\\alpha + \\mathrm{i} \\beta) (p + \\mathrm{i} q)$$\n利用矩阵乘法的线性性质并展开右侧，我们得到：\n$$A p + \\mathrm{i} A q = (\\alpha p - \\beta q) + \\mathrm{i} (\\beta p + \\alpha q)$$\n由于 $A$、$p$ 和 $q$ 都是实的，我们可以令该等式的实部和虚部分别相等。这产生了两个独立的实向量方程：\n1. $A p = \\alpha p - \\beta q$\n2. $A q = \\beta p + \\alpha q$\n\n这两个方程描述了 $A$ 在实向量 $p$ 和 $q$ 上的作用。我们可以用矩阵形式表示这种关系。我们定义一个实矩阵 $S$，其列向量为 $p$ 和 $q$：$S = \\begin{pmatrix} p & q \\end{pmatrix}$。那么，$A$ 对 $S$ 的列向量的作用由下式给出：\n$$A S = A \\begin{pmatrix} p & q \\end{pmatrix} = \\begin{pmatrix} A p & A q \\end{pmatrix}$$\n代入我们关于 $A p$ 和 $A q$ 的表达式：\n$$A S = \\begin{pmatrix} \\alpha p - \\beta q & \\beta p + \\alpha q \\end{pmatrix}$$\n我们现在寻求将右侧写成 $S$ 与一个我们称之为 $J$ 的实 $2 \\times 2$ 矩阵的乘积。\n$$\\begin{pmatrix} p & q \\end{pmatrix} \\begin{pmatrix} \\alpha & \\beta \\\\ -\\beta & \\alpha \\end{pmatrix} = \\begin{pmatrix} p(\\alpha) + q(-\\beta) & p(\\beta) + q(\\alpha) \\end{pmatrix} = \\begin{pmatrix} \\alpha p - \\beta q & \\beta p + \\alpha q \\end{pmatrix}$$\n通过比较，我们发现：\n$$A S = S \\begin{pmatrix} \\alpha & \\beta \\\\ -\\beta & \\alpha \\end{pmatrix}$$\n为了使其成为一个相似变换，矩阵 $S$ 必须是可逆的。这要求其列向量 $p$ 和 $q$ 是线性无关的。我们来证明这一点。\n为了进行反证，假设 $p$ 和 $q$ 是线性相关的。由于 $v = p + \\mathrm{i} q \\neq 0$， $p$ 和 $q$ 不能都为零。此外，如果 $p=0$ 或 $q=0$，特征值 $\\lambda$ 必定是实数，这与 $\\beta \\neq 0$ 相矛盾。例如，如果 $q=0$，那么 $v=p$，且 $Ap = \\lambda p$。由于 $A$ 和 $p$ 是实的，$\\lambda$ 必定是实数。因此，$p$ 和 $q$ 必须都是非零向量。\n如果它们是线性相关的，那么存在一个非零标量 $k \\in \\mathbb{R}$ 使得 $q = k p$。\n特征向量变为 $v = p + \\mathrm{i}(k p) = (1 + \\mathrm{i} k) p$。\n将此代入特征值方程：\n$$A ((1 + \\mathrm{i} k) p) = \\lambda ((1 + \\mathrm{i} k) p)$$\n因为 $k$ 是实数，$(1 + \\mathrm{i} k)$ 是一个非零复标量，我们可以从等式两边消去它：\n$$A p = \\lambda p$$\n这个方程中，$A$ 和 $p \\in \\mathbb{R}^{2} \\setminus \\{0\\}$ 都是实的，这意味着特征值 $\\lambda$ 必须是实数。这与我们最初的假设 $\\lambda$ 是非实数（即 $\\beta \\neq 0$）相矛盾。因此，线性相关的假设是错误的。向量 $p$ 和 $q$ 必须是线性无关的。\n\n由于 $p, q \\in \\mathbb{R}^2$ 是线性无关的，所以 $2 \\times 2$ 矩阵 $S = \\begin{pmatrix} p & q \\end{pmatrix}$ 是可逆的。因此，我们可以在方程 $A S = S J$ 的两边左乘 $S^{-1}$：\n$$S^{-1} A S = J = \\begin{pmatrix} \\alpha & \\beta \\\\ -\\beta & \\alpha \\end{pmatrix}$$\n该矩阵 $J$ 就是对应于复共轭特征值 $\\alpha \\pm \\mathrm{i} \\beta$ 的实若尔当分块。\n\n参数 $\\alpha$ 和 $\\beta$ 由 $A$ 的不变量决定。由于特征值是 $\\lambda_1 = \\alpha + \\mathrm{i}\\beta$ 和 $\\lambda_2 = \\alpha - \\mathrm{i}\\beta$：\n矩阵的迹为 $\\operatorname{tr}(A) = \\lambda_1 + \\lambda_2 = (\\alpha + \\mathrm{i}\\beta) + (\\alpha - \\mathrm{i}\\beta) = 2\\alpha$。\n因此，$\\alpha = \\frac{1}{2} \\operatorname{tr}(A)$。\n矩阵的行列式为 $\\det(A) = \\lambda_1 \\lambda_2 = (\\alpha + \\mathrm{i}\\beta)(\\alpha - \\mathrm{i}\\beta) = \\alpha^2 + \\beta^2$。\n因此，$\\beta^2 = \\det(A) - \\alpha^2 = \\det(A) - \\frac{1}{4} (\\operatorname{tr}(A))^2$。我们可以选择 $\\beta = \\sqrt{\\det(A) - \\frac{1}{4} (\\operatorname{tr}(A))^2}$，其中正根对应于选择特征值 $\\lambda = \\alpha + \\mathrm{i}\\beta$ 且 $\\beta > 0$。\n\n第2部分：应用于具体矩阵 $A = \\begin{pmatrix} 3 & -5 \\\\ 2 & 1 \\end{pmatrix}$。\n\n首先，我们通过求解特征方程 $\\det(A - \\lambda I) = 0$ 来求 $A$ 的特征值。\n$$\\det \\begin{pmatrix} 3 - \\lambda & -5 \\\\ 2 & 1 - \\lambda \\end{pmatrix} = (3 - \\lambda)(1 - \\lambda) - (2)(-5) = 0$$\n$$\\lambda^2 - 4\\lambda + 3 + 10 = 0$$\n$$\\lambda^2 - 4\\lambda + 13 = 0$$\n利用二次求根公式，特征值为：\n$$\\lambda = \\frac{4 \\pm \\sqrt{16 - 4(13)}}{2} = \\frac{4 \\pm \\sqrt{16 - 52}}{2} = \\frac{4 \\pm \\sqrt{-36}}{2} = \\frac{4 \\pm 6\\mathrm{i}}{2} = 2 \\pm 3\\mathrm{i}$$\n我们确定 $\\alpha = 2$ 并选择 $\\beta = 3$。现在我们来求对应于特征值 $\\lambda = 2 + 3\\mathrm{i}$ 的特征向量 $v = \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix}$。\n$$(A - \\lambda I) v = \\begin{pmatrix} 3 - (2 + 3\\mathrm{i}) & -5 \\\\ 2 & 1 - (2 + 3\\mathrm{i}) \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} = \\begin{pmatrix} 1 - 3\\mathrm{i} & -5 \\\\ 2 & -1 - 3\\mathrm{i} \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\n由第一行，我们有 $(1 - 3\\mathrm{i}) v_1 - 5 v_2 = 0$，这得出 $v_1 = \\frac{5}{1 - 3\\mathrm{i}} v_2$。\n$$v_1 = \\frac{5(1 + 3\\mathrm{i})}{(1 - 3\\mathrm{i})(1 + 3\\mathrm{i})} v_2 = \\frac{5(1 + 3\\mathrm{i})}{1^2 + 3^2} v_2 = \\frac{5(1 + 3\\mathrm{i})}{10} v_2 = \\frac{1 + 3\\mathrm{i}}{2} v_2$$\n为了得到一个实部和虚部均为整数的特征向量，我们可以选择 $v_2 = 2$。\n这得到 $v_1 = 1 + 3\\mathrm{i}$。\n特征向量是 $v = \\begin{pmatrix} 1 + 3\\mathrm{i} \\\\ 2 \\end{pmatrix}$。\n现在我们将 $v$ 分解为其实部和虚部，$v = p + \\mathrm{i} q$：\n$$v = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} + \\mathrm{i} \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}$$\n所以，$p = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$ 且 $q = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}$。\n根据第1部分的构造方法，相似变换矩阵 $S$ 由这些向量构成：\n$$S = \\begin{pmatrix} p & q \\end{pmatrix} = \\begin{pmatrix} 1 & 3 \\\\ 2 & 0 \\end{pmatrix}$$\n如题所求，这是一个具有精确整数元素的实可逆矩阵。其行列式为 $\\det(S) = (1)(0) - (3)(2) = -6 \\neq 0$。\n\n第3部分：变换为旋转缩放分块的条件。\n\n一个实 $2 \\times 2$ 矩阵 $A$ 能通过一个实相似变换 $S$ 变换为一个旋转缩放分块 $J = \\begin{pmatrix} \\alpha & \\beta \\\\ -\\beta & \\alpha \\end{pmatrix}$ 的充分必要条件是 $A$ 和 $J$ 相似。相似的一个必要条件是两个矩阵具有相同的特征值。\n$J$ 的特征值是其特征多项式的根：\n$$\\det(J - \\lambda I) = (\\alpha - \\lambda)^2 - (\\beta)(-\\beta) = (\\alpha - \\lambda)^2 + \\beta^2 = 0$$\n这得到 $\\lambda - \\alpha = \\pm \\mathrm{i}\\beta$，所以 $\\lambda = \\alpha \\pm \\mathrm{i}\\beta$。\n要使 $J$ 成为一个真正的旋转缩放分块，必须存在旋转分量，这要求 $\\beta \\neq 0$。这意味着特征值必须是一对非实数的复共轭。\n由于特征值在相似变换下是不变的，矩阵 $A$ 也必须有一对非实数的复共轭特征值。\n\n$A$ 的特征值是其特征多项式 $p(\\lambda) = \\lambda^2 - \\operatorname{tr}(A)\\lambda + \\det(A) = 0$ 的根。这些根的性质由该二次方程的判别式 $\\Delta = (\\operatorname{tr}(A))^2 - 4\\det(A)$ 决定。\n要使特征值为一对非实数的复共轭，判别式必须为负：\n$$\\Delta = (\\operatorname{tr}(A))^2 - 4\\det(A) < 0$$\n这是必要条件。\n\n为了证明充分性，如果 $(\\operatorname{tr}(A))^2 - 4\\det(A) < 0$，那么 $A$ 的特征值为 $\\lambda = \\frac{\\operatorname{tr}(A) \\pm \\mathrm{i}\\sqrt{4\\det(A) - (\\operatorname{tr}(A))^2}}{2}$。它们的形式为 $\\alpha \\pm \\mathrm{i}\\beta$，其中 $\\alpha = \\frac{1}{2}\\operatorname{tr}(A)$ 且 $\\beta = \\frac{1}{2}\\sqrt{4\\det(A) - (\\operatorname{tr}(A))^2} \\neq 0$。\n由于特征值是互异的，矩阵 $A$ 在 $\\mathbb{C}$ 上是可对角化的。如第1部分所示，这样一个复特征对的存在保证了存在线性无关的实向量 $p$ 和 $q$，由此可以构造一个可逆实矩阵 $S = \\begin{pmatrix}p & q\\end{pmatrix}$，使得 $S^{-1}AS$ 是一个实若尔当分块。\n因此，一个实 $2 \\times 2$ 矩阵 $A$ 与一个单一的实 $2 \\times 2$ 旋转缩放分块相似的充分必要条件是 $(\\operatorname{tr}(A))^2 < 4\\det(A)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1 & 3 \\\\ 2 & 0 \\end{pmatrix}}\n$$", "id": "2744704"}, {"introduction": "在上一个练习的基础上，我们将探索如何定制相似变换以分析特定的控制理论属性。这个练习将演示如何构建一个变换，将系统转换到“模态坐标”下，使得系统的内部模态与输出之间的联系变得一目了然。这个过程不仅能让你熟练掌握对角化，更重要的是，它将相似变换与能观测性的核心概念直接联系起来 [@problem_id:2744725]。", "problem": "考虑由状态空间对 $(A,C)$ 定义的连续时间线性时不变 (LTI) 系统，其中\n$$\nA \\;=\\; \\begin{pmatrix}\n2 & 1 & 0 \\\\\n0 & 3 & 1 \\\\\n0 & 0 & 4\n\\end{pmatrix},\n\\qquad\nC \\;=\\; \\begin{pmatrix}\n2 & 1 & -1\n\\end{pmatrix}.\n$$\n从基本原理出发，始于相似性变换、特征结构和可观测性的定义，以及相似性不改变特征值这一基本事实。你的目标是构建一个相似性变换 $x = T z$，使得在变换后的坐标 $z$ 中，矩阵 $A$ 呈模态形式，且每个可观测模态都明确地出现在输出中。具体来说，构建 $T$ 使得变换后的矩阵\n$$\n\\bar{A} \\;=\\; T^{-1} A T, \\qquad \\bar{C} \\;=\\; C T\n$$\n满足以下条件：\n- $\\bar{A}$ 是对角矩阵，其对角线上的元素是 $A$ 的特征值，\n- $\\bar{C}$ 的所有元素均为 $1$，从而每个模态状态对输出的贡献都是直接且相等的。\n\n基于系统对 $(A,C)$ 的可观测性和矩阵 $A$ 的特征结构，论证为何这样的构造是有效的，然后计算相似性矩阵 $T$ 的精确闭式表达式（无数值取舍）。你的最终答案应该是 $T$ 的单一解析表达式。", "solution": "对所述问题进行严格验证。\n\n**第一步：提取已知条件**\n-   状态矩阵：$A = \\begin{pmatrix} 2 & 1 & 0 \\\\ 0 & 3 & 1 \\\\ 0 & 0 & 4 \\end{pmatrix}$。\n-   输出矩阵：$C = \\begin{pmatrix} 2 & 1 & -1 \\end{pmatrix}$。\n-   相似性变换：$x = T z$。\n-   变换后的状态矩阵：$\\bar{A} = T^{-1} A T$。\n-   变换后的输出矩阵：$\\bar{C} = C T$。\n-   对 $\\bar{A}$ 的约束：$\\bar{A}$ 是一个对角矩阵，其对角线元素为 $A$ 的特征值。\n-   对 $\\bar{C}$ 的约束：$\\bar{C} = \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}$。\n\n**第二步：使用提取的已知条件进行验证**\n该问题在线性控制理论领域具有科学依据。它是客观的，其术语定义明确。验证的核心在于确定问题是否适定，具体来说，就是是否存在一个满足所有条件的矩阵 $T$。\n\n要求 $\\bar{A} = T^{-1} A T$ 是一个对角矩阵（我们记为 $\\Lambda$），这等价于矩阵方程 $A T = T \\Lambda$。如果我们将 $T$ 写成其列向量的形式，$T = \\begin{pmatrix} t_1 & t_2 & t_3 \\end{pmatrix}$，且 $\\Lambda = \\text{diag}(\\lambda_1, \\lambda_2, \\lambda_3)$，则该方程变为 $A t_i = \\lambda_i t_i$，其中 $i=1, 2, 3$。这意味着 $T$ 的列向量必须是 $A$ 的特征向量，并且 $\\bar{A}$ 的对角线元素必须是相应的特征值。\n\n第二个条件是 $\\bar{C} = C T = \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}$。用 $T$ 的列向量表示，这意味着 $C \\begin{pmatrix} t_1 & t_2 & t_3 \\end{pmatrix} = \\begin{pmatrix} C t_1 & C t_2 & C t_3 \\end{pmatrix} = \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}$。因此，对于每个特征向量 $t_i$，必须满足条件 $C t_i = 1$。\n\n特征向量的定义仅精确到一个非零标量倍数。如果 $v_i$ 是对应于特征值 $\\lambda_i$ 的特征空间中的任意非零向量，则 $\\lambda_i$ 的任何其他特征向量都可以写成 $t_i = k_i v_i$ 的形式，其中 $k_i \\neq 0$ 是某个标量。问题因而要求为每个模态找到这样一个标量 $k_i$，使得 $C (k_i v_i) = k_i (C v_i) = 1$。\n\n$k_i$ 的解存在的充分必要条件是 $C v_i \\neq 0$。对于一个特征向量 $v_i$，$C v_i \\neq 0$ 这个条件恰好是与特征值 $\\lambda_i$ 相关联的模态的可观测性条件。如果所有模态都是可观测的，我们就可以为每个特征向量找到一个合适的缩放因子 $k_i = \\frac{1}{C v_i}$。如果任何一个模态是不可观测的，则 $C v_i = 0$，条件 $k_i (C v_i) = 1$ 将无法满足。\n\n我们来检查系统 $(A,C)$ 的可观测性。由于 $A$ 是一个上三角矩阵, 其特征值就是其对角线元素：$\\lambda_1 = 2$, $\\lambda_2 = 3$ 和 $\\lambda_3 = 4$。由于这些特征值是互不相同的，矩阵 $A$ 可对角化，并有三个线性无关的特征向量。\n\n我们求出每个特征空间的基：\n对于 $\\lambda_1 = 2$：\n$(A - 2I)v = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 1 & 1 \\\\ 0 & 0 & 2 \\end{pmatrix} v = 0$。一个基特征向量是 $v_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n检查可观测性：$C v_1 = \\begin{pmatrix} 2 & 1 & -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 2$。由于 $2 \\neq 0$，该模态是可观测的。\n\n对于 $\\lambda_2 = 3$：\n$(A - 3I)v = \\begin{pmatrix} -1 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & 0 & 1 \\end{pmatrix} v = 0$。一个基特征向量是 $v_2 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n检查可观测性：$C v_2 = \\begin{pmatrix} 2 & 1 & -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} = 2 + 1 = 3$。由于 $3 \\neq 0$，该模态是可观测的。\n\n对于 $\\lambda_3 = 4$：\n$(A - 4I)v = \\begin{pmatrix} -2 & 1 & 0 \\\\ 0 & -1 & 1 \\\\ 0 & 0 & 0 \\end{pmatrix} v = 0$。一个基特征向量是 $v_3 = \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix}$。\n检查可观测性：$C v_3 = \\begin{pmatrix} 2 & 1 & -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix} = 2 + 2 - 2 = 2$。由于 $2 \\neq 0$，该模态是可观测的。\n\n由于所有模态都是可观测的，因此可以为每个特征向量找到所需的缩放因子 $k_i$。所以，该问题是适定的，并且对于 $T$ 有唯一的解（假设特征值的顺序是固定的）。\n\n**第三步：结论与行动**\n问题有效。我们继续求解。\n\n任务是找到相似性变换矩阵 $T = \\begin{pmatrix} t_1 & t_2 & t_3 \\end{pmatrix}$，其中 $t_i$ 是 $A$ 的特征向量，并经过缩放以满足 $C t_i = 1$。$A$ 的特征值为 $\\lambda_1=2$, $\\lambda_2=3$, $\\lambda_3=4$。变换后的矩阵 $\\bar{A}$ 将是 $\\bar{A} = \\text{diag}(2,3,4)$。\n\n我们来求 $T$ 的列向量。每个列向量 $t_i$ 是一个特征向量 $k_i v_i$，其中 $v_i$ 是一个基特征向量，且 $k_i = \\frac{1}{C v_i}$。\n\n对于 $\\lambda_1 = 2$：\n基特征向量是 $v_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n到输出的耦合是 $C v_1 = 2$。\n缩放因子是 $k_1 = \\frac{1}{2}$。\n$T$ 的第一列是 $t_1 = k_1 v_1 = \\frac{1}{2} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n\n对于 $\\lambda_2 = 3$：\n基特征向量是 $v_2 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n到输出的耦合是 $C v_2 = 3$。\n缩放因子是 $k_2 = \\frac{1}{3}$。\n$T$ 的第二列是 $t_2 = k_2 v_2 = \\frac{1}{3} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{1}{3} \\\\ 0 \\end{pmatrix}$。\n\n对于 $\\lambda_3 = 4$：\n基特征向量是 $v_3 = \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix}$。\n到输出的耦合是 $C v_3 = 2$。\n缩放因子是 $k_3 = \\frac{1}{2}$。\n$T$ 的第三列是 $t_3 = k_3 v_3 = \\frac{1}{2} \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\\\ 1 \\end{pmatrix}$。\n\n将这些列向量组合起来，我们构建相似性变换矩阵 $T$：\n$$\nT = \\begin{pmatrix} t_1 & t_2 & t_3 \\end{pmatrix} = \\begin{pmatrix}\n\\frac{1}{2} & \\frac{1}{3} & \\frac{1}{2} \\\\\n0 & \\frac{1}{3} & 1 \\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$\n这个构造是有效的，因为系统 $(A,C)$ 是完全可观测的，这意味着系统的每个动态模态都对输出有非零影响。这种由 $C v_i \\neq 0$ 量化的非零影响，允许我们通过适当地缩放相应的特征向量，将每个模态的“输出增益”归一化为1。变换后坐标中的每个模态 $z_i$ 于是以系数 $1$ 贡献于输出，使得每个模态的可观测性在输出方程 $y = \\bar{C} z = z_1 + z_2 + z_3$ 中得以明确体现。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} & \\frac{1}{3} & \\frac{1}{2} \\\\ 0 & \\frac{1}{3} & 1 \\\\ 0 & 0 & 1 \\end{pmatrix}}\n$$", "id": "2744725"}, {"introduction": "作为本章的综合性练习，我们将处理一个更复杂的非最小实现系统，展示如何通过一次变换梳理出其完整的内部结构。本练习的核心是构建著名的卡尔曼分解，这是一种强大的技术，它利用相似变换将状态空间精确地划分为四个基于能控性和能观测性的子空间。完成这个练习将使你对状态空间分解以及相似变换在揭示系统内在结构方面的强大作用有深刻的认识 [@problem_id:2744735]。", "problem": "考虑一个线性时不变状态空间系统，其状态向量为 $x \\in \\mathbb{R}^{5}$，输入为 $u \\in \\mathbb{R}$，输出为 $y \\in \\mathbb{R}$：\n$$\n\\dot{x} = A x + B u,\\quad y = C x,\n$$\n其中\n$$\nA = \\begin{pmatrix}\n-4 & 0 & 0 & 0 & 0 \\\\\n0 & -1 & 0 & -2 & 0 \\\\\n0 & 0 & 7 & 0 & 0 \\\\\n0 & 0 & 0 & -2 & 0 \\\\\n0 & 0 & 0 & 0 & 5\n\\end{pmatrix},\n$$\n$$\nB = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 1 \\\\ 1 \\end{pmatrix},\n$$\n$$\nC = \\begin{pmatrix} 1 & -1 & 0 & 1 & 0 \\end{pmatrix}.\n$$\n从能控性和能观性的基本定义出发，构建一个相似变换 $T$，将该实现变换为Kalman分解形式，分离出四个规范子空间：能控能观、能控不能观、不能控能观、以及不能控不能观。您的构建过程必须明确确定能控子空间、不能观子空间、它们的交集，并选择一组基，使得在变换 $\\tilde{x} = T^{-1} x$ 下，系统能以Kalman形式实现为分块上三角矩阵。\n\n在得到Kalman分解后，报告 $T^{-1} A T$ 中能控且能观分块的特征多项式（以不定元 $s$ 表示）。请以单一解析表达式的形式给出最终答案。无需四舍五入。不涉及物理单位。", "solution": "该问题要求为一个给定的线性时不变（LTI）系统构建一个相似变换，将其转换为Kalman规范型，然后确定能控且能观子系统的特征多项式。\n\n该系统由以下状态空间方程定义：\n$$ \\dot{x} = Ax + Bu, \\quad y = Cx $$\n其中矩阵为：\n$$ A = \\begin{pmatrix} -4 & 0 & 0 & 0 & 0 \\\\ 0 & -1 & 0 & -2 & 0 \\\\ 0 & 0 & 7 & 0 & 0 \\\\ 0 & 0 & 0 & -2 & 0 \\\\ 0 & 0 & 0 & 0 & 5 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 1 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & -1 & 0 & 1 & 0 \\end{pmatrix} $$\n\n首先，我们验证问题的有效性。给定矩阵 $A$、$B$ 和 $C$，状态维数 $n=5$，输入维数 $m=1$，输出维数 $p=1$。问题陈述是自洽的，科学上基于成熟的控制理论，并且是客观的。它提出了一个标准的、适定的问题。此问题有效。\n\n求解过程首先识别状态空间 $\\mathbb{R}^5$ 的四个基本子空间：能控子空间 $\\mathcal{C}$，不能观子空间 $\\mathcal{O}^\\perp$，以及它们定义了Kalman分解的交集。\n\n步骤1：确定能控子空间 $\\mathcal{C}$。\n能控子空间是能控性矩阵 $\\mathcal{C}_M = \\begin{pmatrix} B & AB & A^2B & A^3B & A^4B \\end{pmatrix}$ 的值域。\n我们计算其各列：\n$B = \\begin{pmatrix} 0 & 1 & 0 & 1 & 1 \\end{pmatrix}^T$\n$AB = \\begin{pmatrix} 0 & -3 & 0 & -2 & 5 \\end{pmatrix}^T$\n$A^2B = \\begin{pmatrix} 0 & 7 & 0 & 4 & 25 \\end{pmatrix}^T$\n$A^3B = \\begin{pmatrix} 0 & -15 & 0 & -8 & 125 \\end{pmatrix}^T$\n$A^4B = \\begin{pmatrix} 0 & 31 & 0 & 16 & 625 \\end{pmatrix}^T$\n能控性矩阵为：\n$$ \\mathcal{C}_M = \\begin{pmatrix} 0 & 0 & 0 & 0 & 0 \\\\ 1 & -3 & 7 & -15 & 31 \\\\ 0 & 0 & 0 & 0 & 0 \\\\ 1 & -2 & 4 & -8 & 16 \\\\ 1 & 5 & 25 & 125 & 625 \\end{pmatrix} $$\n第一行和第三行为零。矩阵的秩由剩余行向量的线性无关性决定。我们考察前三列。由第 $2, 4, 5$ 行和第 $1, 2, 3$ 列构成的子矩阵是 $\\begin{pmatrix} 1 & -3 & 7 \\\\ 1 & -2 & 4 \\\\ 1 & 5 & 25 \\end{pmatrix}$，其行列式为 $42 \\neq 0$。因此，$\\mathcal{C}_M$ 的秩为 $3$，且 $\\dim(\\mathcal{C}) = 3$。$\\mathcal{C}_M$ 的所有列向量都位于第一和第三分量为零的子空间中，即 $\\text{span}\\{e_2, e_4, e_5\\}$，其中 $e_i$ 是标准基向量。因为 $\\dim(\\mathcal{C})=3$，我们必有 $\\mathcal{C} = \\text{span}\\{e_2, e_4, e_5\\}$。\n\n步骤2：确定不能观子空间 $\\mathcal{O}^\\perp$。\n不能观子空间是能观性矩阵 $\\mathcal{O}_M$ 的零空间：\n$$ \\mathcal{O}_M = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\\\ CA^3 \\\\ CA^4 \\end{pmatrix} $$\n我们计算其各行：\n$C = \\begin{pmatrix} 1 & -1 & 0 & 1 & 0 \\end{pmatrix}$\n$CA = \\begin{pmatrix} -4 & 1 & 0 & 0 & 0 \\end{pmatrix}$\n$CA^2 = \\begin{pmatrix} 16 & -1 & 0 & -2 & 0 \\end{pmatrix}$\n$CA^3 = \\begin{pmatrix} -64 & 1 & 0 & 4 & 0 \\end{pmatrix}$\n$CA^4 = \\begin{pmatrix} 256 & -1 & 0 & -8 & 0 \\end{pmatrix}$\n如果 $\\mathcal{O}_M x = 0$，则向量 $x = (x_1, x_2, x_3, x_4, x_5)^T$ 属于 $\\mathcal{O}^\\perp$。对应于 $x_3$ 和 $x_5$ 的列向量为零，因此任何在 $\\text{span}\\{e_3, e_5\\}$ 中的向量都是候选。由第 1、2、4 列构成的子矩阵的秩为 3，因为其顶部的 $3 \\times 3$ 行列式为 $-6 \\neq 0$。因此，对于任何 $x \\in \\mathcal{O}^\\perp$，必有 $x_1=x_2=x_4=0$。所以零空间由仅 $x_3$ 和 $x_5$ 分量可以非零的向量张成。\n因此，不能观子空间为 $\\mathcal{O}^\\perp = \\text{span}\\{e_3, e_5\\}$，且 $\\dim(\\mathcal{O}^\\perp) = 2$。\n能观子空间为 $\\mathcal{O} = (\\mathcal{O}^\\perp)^\\perp = \\text{span}\\{e_1, e_2, e_4\\}$。\n\n步骤3：为Kalman分解的子空间构建基。\n状态空间 $\\mathbb{R}^5$ 被分解为四个子空间的直和。\n1. 能控且能观：$S_1 = \\mathcal{C} \\cap \\mathcal{O} = \\text{span}\\{e_2, e_4, e_5\\} \\cap \\text{span}\\{e_1, e_2, e_4\\} = \\text{span}\\{e_2, e_4\\}$。一组基是 $\\{e_2, e_4\\}$。$\\dim(S_1) = 2$。\n2. 能控但不能观：$S_2 = \\mathcal{C} \\cap \\mathcal{O}^\\perp = \\text{span}\\{e_2, e_4, e_5\\} \\cap \\text{span}\\{e_3, e_5\\} = \\text{span}\\{e_5\\}$。一组基是 $\\{e_5\\}$。$\\dim(S_2) = 1$。\n3. 不能控但能观：$S_3 = \\mathcal{C}^\\perp \\cap \\mathcal{O}$。首先，$\\mathcal{C}^\\perp = (\\text{span}\\{e_2, e_4, e_5\\})^\\perp = \\text{span}\\{e_1, e_3\\}$。因此，$S_3 = \\text{span}\\{e_1, e_3\\} \\cap \\text{span}\\{e_1, e_2, e_4\\} = \\text{span}\\{e_1\\}$。一组基是 $\\{e_1\\}$。$\\dim(S_3) = 1$。\n4. 不能控且不能观：$S_4 = \\mathcal{C}^\\perp \\cap \\mathcal{O}^\\perp = \\text{span}\\{e_1, e_3\\} \\cap \\text{span}\\{e_3, e_5\\} = \\text{span}\\{e_3\\}$。一组基是 $\\{e_3\\}$。$\\dim(S_4) = 1$。\n\n步骤4：构建相似变换。\n变换矩阵 $T$ 是将基向量按照 $S_1, S_2, S_3, S_4$ 的顺序拼接而成。\n$$ T = \\begin{pmatrix} e_2 & e_4 & e_5 & e_1 & e_3 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 & 1 & 0 \\\\ 1 & 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 & 1 \\\\ 0 & 1 & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 0 & 0 \\end{pmatrix} $$\n这是一个置换矩阵，因此其逆矩阵是其转置：$T^{-1} = T^T$。新状态为 $\\tilde{x} = T^{-1}x = (x_2, x_4, x_5, x_1, x_3)^T$。\n\n步骤5：计算变换后的系统。\n变换后的状态矩阵是 $\\tilde{A} = T^{-1}AT$。$AT$ 的列是 $Ae_2, Ae_4, Ae_5, Ae_1, Ae_3$。\n$AT = A\\begin{pmatrix} e_2 & e_4 & e_5 & e_1 & e_3 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 & -4 & 0 \\\\ -1 & -2 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 & 7 \\\\ 0 & -2 & 0 & 0 & 0 \\\\ 0 & 0 & 5 & 0 & 0 \\end{pmatrix}$。\n然后 $\\tilde{A} = T^{-1}(AT)$ 将 $AT$ 的行重新排序为 $(2, 4, 5, 1, 3)$：\n$$ \\tilde{A} = \\begin{pmatrix} -1 & -2 & 0 & 0 & 0 \\\\ 0 & -2 & 0 & 0 & 0 \\\\ 0 & 0 & 5 & 0 & 0 \\\\ 0 & 0 & 0 & -4 & 0 \\\\ 0 & 0 & 0 & 0 & 7 \\end{pmatrix} $$\n该矩阵是分块对角矩阵，这是所要求的分块上三角形式的一个特例。这些分块对应于四个子空间：\n$$\n\\tilde{A} =\n\\left(\n\\begin{array}{cc|c|c|c}\n-1 & -2 & 0 & 0 & 0 \\\\\n0 & -2 & 0 & 0 & 0 \\\\\n\\hline\n0 & 0 & 5 & 0 & 0 \\\\\n\\hline\n0 & 0 & 0 & -4 & 0 \\\\\n\\hline\n0 & 0 & 0 & 0 & 7\n\\end{array}\n\\right)\n= \\begin{pmatrix} A_{co} & 0 & 0 & 0 \\\\ 0 & A_{c\\bar{o}} & 0 & 0 \\\\ 0 & 0 & A_{\\bar{c}o} & 0 \\\\ 0 & 0 & 0 & A_{\\bar{c}\\bar{o}} \\end{pmatrix}\n$$\n能控且能观分块是左上角的 $2 \\times 2$ 矩阵：\n$$ A_{co} = \\begin{pmatrix} -1 & -2 \\\\ 0 & -2 \\end{pmatrix} $$\n\n步骤6：确定特征多项式。\n能控且能观分块的特征多项式是 $p(s) = \\det(sI - A_{co})$。\n$$ sI - A_{co} = s\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\begin{pmatrix} -1 & -2 \\\\ 0 & -2 \\end{pmatrix} = \\begin{pmatrix} s+1 & 2 \\\\ 0 & s+2 \\end{pmatrix} $$\n其行列式为：\n$$ p(s) = (s+1)(s+2) - (2)(0) = s^2 + 3s + 2 $$\n这就是所求的特征多项式。", "answer": "$$\\boxed{s^2 + 3s + 2}$$", "id": "2744735"}]}