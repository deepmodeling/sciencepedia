## 引言
在动态系统的研究中，稳定性是至关重要的核心概念。从确保飞行器安全飞行到维持生态系统平衡，理解并保证系统能够从扰动中恢复到其稳定状态，是无数科学与工程难题的基石。然而，对于复杂的非线性系统，证明其稳定性却异常困难。19世纪末，[Aleksandr Lyapunov](@article_id:381488)的天才理论提供了一个优雅的框架，但留下了一个核心挑战：如何为给定的系统找到那个关键的、如同“能量函数”一般的李雅普诺夫函数？这一难题长期困扰着研究者们，使得[李雅普诺夫方法](@article_id:639935)在很多时候更像一门艺术而非一门科学。本文旨在系统性地介绍由Nikolai Krasovskii提出的一个巧妙的构造性解决方案。我们将首先在第一章深入其核心思想，揭示该方法如何将寻找[李雅普诺夫函数](@article_id:337681)的问题转化为一个更具结构性的代数问题。随后，在第二章，我们将探索该方法在[控制工程](@article_id:310278)、鲁棒性分析乃至[机器学习优化](@article_id:348971)等领域的广泛应用。最后，通过第三章的实践练习，您将有机会亲手应用这些强大的理论。那么，这一切是如何从一个简单而直观的物理类比开始的呢？

## 原理与机制

想象一个放在碗里的弹珠。无论你把它放在碗的哪个位置（只要不是最底部），它总会滚向碗底，最终停在那里。这个简单的物理现象蕴含着深刻的稳定性思想。碗的高度可以被看作一种“能量”，弹珠的运动总是朝着能量降低的方向进行，直到能量达到最小值——碗底。

在19世纪末，俄国数学家 [Aleksandr Lyapunov](@article_id:381488) 将这个直观的能量概念推广到了任何动态系统。他提出，如果我们能为一个系统 $\dot{x} = f(x)$ 找到一个类似于“能量”的函数 $V(x)$，它在[平衡点](@article_id:323137)（比如原点）处取最小值，并在其他任何地方都比这个最小值大，而且这个“能量”会随着系统的演化而不断减少，那么系统就必然会稳定地回到那个[平衡点](@article_id:323137)。这个函数 $V(x)$ 就是著名的 Lyapunov 函数，它就像一个无形的“碗”，引导着系统的状态走向稳定。

这想法美妙极了，但它留下了一个核心难题：对于一个给定的系统 $\dot{x} = f(x)$，我们该如何找到这个神奇的“能量碗”$V(x)$ 呢？Lyapunov 的原始理论并没有提供一个通用的菜谱。

### Krasovskii 的天才之举：衡量“速度”而非“位置”

几十年后，另一位俄国数学家 Nikolai Krasovskii 提出了一个极富创造力的方法。传统的思路，比如构造一个[二次型](@article_id:314990)函数 $W(x) = x^T P x$，是直接衡量状态 $x$ 本身离原点的“距离”[@problem_id:2715977]。这就像是在状态空间中直接雕刻一个椭球形的碗。Krasovskii 另辟蹊径，他建议：**为什么不直接衡量系统本身的“运动速度”$f(x)$ 呢？**

如果系统在远离[平衡点](@article_id:323137)的地方“运动”得很快，而在靠近[平衡点](@article_id:323137)的地方“运动”得慢，直到在[平衡点](@article_id:323137)处完全静止（$f(0)=0$），那么衡量这个“运动速度”的平方不也能构成一个很好的“能量”函数吗？

这便是 Krasovskii 方法的核心思想。他提出的 Lyapunov 函数候选者形式如下：

$$ V(x) = f(x)^T P f(x) $$

这里，$f(x)$ 是系统的“速度向量”，而 $P$ 是一个我们需要精心挑选的常数矩阵。为了让 $V(x)$ 具备“能量”的特性，我们必须对 $P$ 和 $f(x)$ 提出一些基本要求。

首先，这个“能量”必须是正的（除了在[平衡点](@article_id:323137)为零）。$V(x)$ 的表达式是一个[二次型](@article_id:314990)。为了保证只要 $f(x)$ 不为零，$V(x)$ 就严格大于零，我们需要矩阵 $P$ 是**对称正定**的（写作 $P \succ 0$）[@problem_id:2716046]。从几何上看，一个[对称正定矩阵](@article_id:297167) $P$ 定义了一个椭球，$V(x)$ 实际上是在用这个[椭球](@article_id:345137)作为“度量衡”，来测量速度向量 $f(x)$ 的“长度”的平方。如果 $f(x)$ 落在由 $P$ 定义的某个椭球面上，$V(x)$ 的值就固定了[@problem_id:2715977]。

其次，这个“能量”只应在系统完全静止时才为零。这意味着 $V(x)=0$ 的唯一可能应该是 $f(x)=0$。为了让原点成为我们关心的唯一稳定点，我们必须假设在一个邻域内，**$f(x) = 0$ 的唯一解是 $x=0$** [@problem_id:2716025]。这个假设至关重要，它确保了我们构造的“碗”在原点处有唯一的最低点，而不会在其他地方也出现“凹陷”。

### 探寻能量耗散的奥秘：$\dot{V}(x)$ 的推导

现在，我们有了一个看似合理的“能量碗”。但弹珠会自动滚向碗底吗？也就是说，$V(x)$ 的值会随着时间流逝而自动减小吗？为了回答这个问题，我们需要计算 $V(x)$ 沿着系统轨迹的时间[导数](@article_id:318324) $\dot{V}(x)$。

这需要我们运用链式法则。$V(x)$ 是 $x$ 的函数，而 $x$ 又是时间 $t$ 的函数。
$$ \dot{V}(x) = \frac{d}{dt} V(x(t)) = \frac{d}{dt} \left( f(x(t))^T P f(x(t)) \right) $$
根据[求导法则](@article_id:305867)，我们得到：
$$ \dot{V}(x) = \left(\frac{d}{dt}f(x)\right)^T P f(x) + f(x)^T P \left(\frac{d}{dt}f(x)\right) $$
而 $f(x)$ 对时间的[导数](@article_id:318324)是：
$$ \frac{d}{dt}f(x) = \frac{\partial f}{\partial x} \frac{dx}{dt} = Df(x) \cdot \dot{x} = Df(x) f(x) $$
这里的 $Df(x)$（有时也记作 $J(x)$）是 $f(x)$ 在点 $x$ 处的 Jacobian 矩阵，它描述了系统在 $x$ 附近的[局部线性](@article_id:330684)行为。

将这个结果代回 $\dot{V}(x)$ 的表达式，经过整理，我们得到一个惊人而优美的结果[@problem_id:2715982]：
$$ \dot{V}(x) = f(x)^T \left( Df(x)^T P + P Df(x) \right) f(x) $$
这是一个关于速度向量 $f(x)$ 的新的二次型！

### Krasovskii 判据：从线性化到非线性稳定的桥梁

这个公式告诉我们，$\dot{V}(x)$ 是否为负，完全取决于中间的那个对称矩阵 $S(x) = Df(x)^T P + P Df(x)$ 的性质。为了确保能量总是耗散的（$\dot{V}(x) < 0$），我们只需要保证 $S(x)$ 是一个**[负定](@article_id:314718)矩阵**（写作 $S(x) \prec 0$）。

这就是 **Krasovskii 判据**：如果我们能找到一个[对称正定矩阵](@article_id:297167) $P$，使得对于我们关心的某个区域内所有的 $x$，矩阵 $S(x) = Df(x)^T P + P Df(x)$ 都是[负定](@article_id:314718)的，那么系统在该区域内就是渐近稳定的[@problem_id:2721563]。

这个判据的深刻之处在于它建立了一座从[线性系统](@article_id:308264)到[非线性系统](@article_id:323160)的桥梁。让我们看看在原点 $x=0$ 处会发生什么。判据变成了：找到一个 $P \succ 0$，使得 $Df(0)^T P + P Df(0)$ 是[负定](@article_id:314718)的。这正是[线性系统](@article_id:308264) $\dot{x} = Df(0) x$ 稳定的 Lyapunov 判据！它告诉我们，如果一个非线性系统在原点的[线性化](@article_id:331373)近似是稳定的（即 $Df(0)$ 是一个 Hurwitz 矩阵），那么我们总能（至少在局部）找到一个 Krasovskii 函数来证明原系统的稳定性[@problem_id:2716015]。Krasovskii 方法可以看作是将这个线性判据“逐点”地应用到了整个非线性状态空间。

### 一个小插曲：当能量只是“不再增加”

事情并非总是那么完美。在某些情况下，我们可能只能找到一个 $P$，使得 $S(x)$ 是**半[负定](@article_id:314718)**的（$S(x) \preceq 0$）。这意味着 $\dot{V}(x) \le 0$，也就是说，能量可能在某些地方保持不变，而不是严格减少。

这会带来什么问题呢？想象一个碗的侧壁上有一圈平坦的“环”。弹珠滚到这个环上后，就不会再往下滚了，它会停留在环上的某个位置，而不会到达碗底。

一个经典的例子可以说明这一点：考虑系统 $\dot{x}_1 = -x_1, \dot{x}_2 = 0$。这个系统中的点会水平地移动到 $x_2$ 轴上。如果你用 Krasovskii 方法分析，你会发现 $\dot{V}(x)$ 在整个 $x_2$ 轴上都等于零。这意味着从任何点出发的轨迹最终都会停留在 $x_2$ 轴上，但不一定回到原点。因此，系统是稳定的，但不是渐近稳定的[@problem_id:2716007]。

为了解决这个问题，我们需要借助 LaSalle [不变性原理](@article_id:378160)。这个原理告诉我们，即使 $\dot{V}(x)$ 只是半[负定](@article_id:314718)的，系统的轨迹最终也会收敛到 $\dot{V}(x) = 0$ 这个集合中所包含的最大[不变集](@article_id:338919)里。所谓[不变集](@article_id:338919)，就是指一旦轨迹进入，就永远不会离开的区域。在上面的例子中，整个 $x_2$ 轴都是[不变集](@article_id:338919)。要证明渐近稳定，我们必须证明，在 $\dot{V}(x)=0$ 的集合里，唯一的[不变集](@article_id:338919)只有原点 $\{0\}$ 本身[@problem_id:2715982] [@problem_id:2716025]。

### 从局部到全局：构建一个无限深的“能量谷”

迄今为止的分析主要关注局部稳定性，即原点附近一个小的“能量碗”。但如果我们想保证系统无论从哪里出发，最终都能回到原点（即全局渐近稳定），那么这个“能量碗”就必须是无限大的。这意味着，当状态 $x$ 远离原点时，$V(x)$ 的值必须趋向于无穷大。这个性质被称为**径向无界 (radially unbounded)**。

对于克拉索夫斯基函数 $V(x) = f(x)^T P f(x)$，这个条件意味着当 $x$ 趋于无穷时，“速度” $f(x)$ 的范数也必须趋于无穷。如果函数 $f(x)$ 具有这样的性质（这被称为**[固有映射](@article_id:318991) (proper map)**），我们就有希望证明全局稳定性[@problem_id:2716034]。

### 结语：一个强大的工具，而非万能的魔杖

Krasovskii 方法是一个强大而优雅的构造性工具。它为我们提供了一份清晰的“菜谱”，指导我们如何为非线性系统寻找 Lyapunov 函数。然而，我们必须清醒地认识到，它并非万能的。

存在一些全局渐近稳定的系统，但我们却无法用 Krasovskii 方法（使用常数矩阵 $P$）为它找到一个全局的 Lyapunov 函数。例如，系统 $\dot{x} = -x / (1+x^2)$ 就是一个典型的例子。尽管这个系统是全局稳定的（可以用更简单的 $V(x) = x^2/2$ 来证明），但 Krasovskii 函数 $V(x) = p \cdot f(x)^2$ 在 $|x| > 1$ 的区域，其[导数](@article_id:318324) $\dot{V}(x)$ 反而是正的，能量不降反升，因此该方法失效了[@problem_id:2716018]。

这告诉我们，Krasovskii 方法提供的是一个**充分条件**，而非必要条件。它的成功意味着系统的稳定，但它的失败并不意味着系统不稳定——可能只是我们选择的“能量”形式不适合这个特定的系统。尽管如此，它通过连接系统的[速度场](@article_id:335158) $f(x)$ 和其[局部线性化](@article_id:348711) $Df(x)$，深刻地揭示了稳定性背后的几何与代数之美，至今仍是控制理论中一个不可或缺的分析与设计工具。