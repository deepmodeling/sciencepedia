{"hands_on_practices": [{"introduction": "在深入研究非线性动力学之前，我们必须首先掌握其线性基础。中心流形定理的第一步是将系统的状态空间分解为稳定、中心和不稳定子空间。这个练习将带你通过一个具体的例子，巩固如何根据系统线性化后的特征值来识别这些关键子空间，并构造相应的投影算子。[@problem_id:2691770] 这是理解系统动力学如何在不同子空间上“解耦”的关键一步。", "problem": "考虑线性时不变 (LTI) 系统 $\\dot{x}=A x$，其中 $A=\\mathrm{diag}(0,0,-1,2)\\in\\mathbb{R}^{4\\times 4}$。在中心流形定理的背景下，我们将状态空间分解为稳定子空间 $E^s$、中心子空间 $E^c$ 和不稳定子空间 $E^u$ 的直和。仅从以下基本定义出发：$E^s$ 由与 $A$ 的实部严格为负的特征值相关联的广义特征向量张成，$E^c$ 由与实部为零的特征值相关联的广义特征向量张成，而 $E^u$ 由与实部严格为正的特征值相关联的广义特征向量张成：\n\n1. 确定 $A$ 的特征值和相应的特征空间，并由此计算分解 $\\mathbb{R}^{4}=E^{s}\\oplus E^{c}\\oplus E^{u}$，需为 $E^{s}$、$E^{c}$ 和 $E^{u}$ 提供显式基。\n\n2. 通过根据定义和 $A$ 的结构进行直接论证，证明每个子空间都是 $A$-不变的，即对于 $\\sigma\\in\\{s,c,u\\}$，有 $A E^{\\sigma}\\subseteq E^{\\sigma}$。\n\n3. 沿着直和分解 $\\mathbb{R}^{4}=E^{s}\\oplus E^{c}\\oplus E^{u}$，构造分别到 $E^{s}$、$E^{c}$ 和 $E^{u}$ 上的投影矩阵 $P^{s}$、$P^{c}$ 和 $P^{u}$。从基本原理出发，验证 $P^{\\sigma}$ 是幂等的， $P^{s}+P^{c}+P^{u}=I$，对于 $\\sigma\\neq\\tau$ 有 $P^{\\sigma}P^{\\tau}=0$，以及对于每个 $\\sigma\\in\\{s,c,u\\}$ 有 $A P^{\\sigma}=P^{\\sigma} A$，从而证实其不变性。\n\n将你的最终答案表示为投影矩阵的有序三元组 $(P^{s},P^{c},P^{u})$，以单行矩阵的形式呈现。无需四舍五入。", "solution": "该问题陈述经评估有效。它具有科学依据，提法恰当，客观且内部一致。它是在线性系统理论中的一个标准练习，要求将特征空间、不变子空间和投影算子的基本定义应用于一个指定的系统。所有必要信息均已提供，任务明确。我们继续进行解答。\n\n所考虑的系统是线性时不变 (LTI) 系统 $\\dot{x}=A x$，其中状态 $x \\in \\mathbb{R}^{4}$，矩阵 $A \\in \\mathbb{R}^{4\\times 4}$ 由下式给出\n$$\nA = \\mathrm{diag}(0, 0, -1, 2) = \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & -1 & 0 \\\\ 0 & 0 & 0 & 2 \\end{pmatrix}.\n$$\n状态空间 $\\mathbb{R}^{4}$ 将被分解为稳定、中心和不稳定子空间的直和 $E^{s} \\oplus E^{c} \\oplus E^{u}$。\n\n**1. 特征值、特征空间和子空间分解**\n\n首先，我们确定矩阵 $A$ 的特征值和相应的特征空间。由于 $A$ 是一个对角矩阵，其特征值即为对角线上的元素：$\\lambda_{1}=0$, $\\lambda_{2}=0$, $\\lambda_{3}=-1$, 和 $\\lambda_{4}=2$。\n\n对于一个特征值 $\\lambda$，其特征空间是矩阵 $(A - \\lambda I)$ 的零空间。设 $v = (v_{1}, v_{2}, v_{3}, v_{4})^{T}$ 为一个特征向量。\n\n对于 $\\lambda=0$：\n特征空间是 $A$ 的零空间。方程 $Av=0$ 给出：\n$$\n\\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & -1 & 0 \\\\ 0 & 0 & 0 & 2 \\end{pmatrix} \\begin{pmatrix} v_{1} \\\\ v_{2} \\\\ v_{3} \\\\ v_{4} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\implies \\begin{cases} -v_{3} = 0 \\\\ 2v_{4} = 0 \\end{cases}\n$$\n这意味着 $v_{3}=0$ 且 $v_{4}=0$，而 $v_{1}$ 和 $v_{2}$ 是任意的。该特征空间由标准基向量 $e_{1} = (1, 0, 0, 0)^{T}$ 和 $e_{2} = (0, 1, 0, 0)^{T}$ 张成。几何重数为 $2$，等于特征值 $\\lambda=0$ 的代数重数。\n\n对于 $\\lambda=-1$：\n特征空间是 $(A - (-1)I) = A + I$ 的零空间。方程 $(A+I)v=0$ 给出：\n$$\n\\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 3 \\end{pmatrix} \\begin{pmatrix} v_{1} \\\\ v_{2} \\\\ v_{3} \\\\ v_{4} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0\\\\ 0 \\\\ 0 \\end{pmatrix} \\implies \\begin{cases} v_{1} = 0 \\\\ v_{2} = 0 \\\\ 3v_{4} = 0 \\end{cases}\n$$\n这意味着 $v_{1}=0$, $v_{2}=0$, 且 $v_{4}=0$，而 $v_{3}$ 是任意的。该特征空间由标准基向量 $e_{3} = (0, 0, 1, 0)^{T}$ 张成。\n\n对于 $\\lambda=2$：\n特征空间是 $(A-2I)$ 的零空间。方程 $(A-2I)v=0$ 给出：\n$$\n\\begin{pmatrix} -2 & 0 & 0 & 0 \\\\ 0 & -2 & 0 & 0 \\\\ 0 & 0 & -3 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} v_{1} \\\\ v_{2} \\\\ v_{3} \\\\ v_{4} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\implies \\begin{cases} -2v_{1} = 0 \\\\ -2v_{2} = 0 \\\\ -3v_{3} = 0 \\end{cases}\n$$\n这意味着 $v_{1}=0$, $v_{2}=0$, 且 $v_{3}=0$，而 $v_{4}$ 是任意的。该特征空间由标准基向量 $e_{4} = (0, 0, 0, 1)^{T}$ 张成。\n\n由于每个特征值的几何重数都等于其代数重数，因此不存在非平凡的广义特征向量。广义特征空间与特征空间相同。\n\n现在，我们根据特征值的实部来构造子空间 $E^{s}$、$E^{c}$ 和 $E^{u}$。\n- 稳定子空间 $E^{s}$ 由与实部严格为负的特征值相对应的特征向量张成。唯一的此类特征值是 $\\lambda = -1$。\n  $$E^{s} = \\mathrm{span}\\{e_{3}\\}$$\n  $E^{s}$ 的一个基是 $\\{e_{3} = (0, 0, 1, 0)^{T}\\}$。\n- 中心子空间 $E^{c}$ 由与实部为零的特征值相对应的特征向量张成。唯一的此类特征值是 $\\lambda = 0$。\n  $$E^{c} = \\mathrm{span}\\{e_{1}, e_{2}\\}$$\n  $E^{c}$ 的一个基是 $\\{e_{1} = (1, 0, 0, 0)^{T}, e_{2} = (0, 1, 0, 0)^{T}\\}$。\n- 不稳定子空间 $E^{u}$ 由与实部严格为正的特征值相对应的特征向量张成。唯一的此类特征值是 $\\lambda = 2$。\n  $$E^{u} = \\mathrm{span}\\{e_{4}\\}$$\n  $E^{u}$ 的一个基是 $\\{e_{4} = (0, 0, 0, 1)^{T}\\}$。\n\n基向量集合 $\\{e_{3}, e_{1}, e_{2}, e_{4}\\}$ 是 $\\mathbb{R}^{4}$ 标准基的一个排列，这证实了直和分解 $\\mathbb{R}^{4} = E^{s} \\oplus E^{c} \\oplus E^{u}$。\n\n**2. A-不变性的证明**\n\n我们证明对于 $\\sigma \\in \\{s, c, u\\}$，有 $A E^{\\sigma} \\subseteq E^{\\sigma}$。如果对于任意向量 $v \\in E$，向量 $Av$ 也在 $E$ 中，则子空间 $E$ 是 $A$-不变的。\n\n- 对于 $E^{s}$：设 $v \\in E^{s}$。那么存在标量 $c \\in \\mathbb{R}$ 使得 $v = c e_{3}$。\n  $Av = A(c e_{3}) = c(A e_{3})$。由于 $e_{3}$ 是特征值为 $-1$ 的特征向量，所以 $A e_{3} = -1 \\cdot e_{3}$。\n  因此，$Av = c(-1 \\cdot e_{3}) = (-c)e_{3}$，这是 $e_{3}$ 的一个标量倍，因此位于 $E^{s}$ 中。所以，$A E^{s} \\subseteq E^{s}$。\n\n- 对于 $E^{c}$：设 $v \\in E^{c}$。那么存在标量 $c_{1}, c_{2} \\in \\mathbb{R}$ 使得 $v = c_{1}e_{1} + c_{2}e_{2}$。\n  $Av = A(c_{1}e_{1} + c_{2}e_{2}) = c_{1}(A e_{1}) + c_{2}(A e_{2})$。由于 $e_{1}$ 和 $e_{2}$ 是特征值为 $0$ 的特征向量，所以 $A e_{1} = 0$ 且 $A e_{2} = 0$。\n  因此，$Av = c_{1}(0) + c_{2}(0) = 0$。零向量属于任何子空间，包括 $E^{c}$。所以，$A E^{c} \\subseteq E^{c}$。\n\n- 对于 $E^{u}$：设 $v \\in E^{u}$。那么存在标量 $c \\in \\mathbb{R}$ 使得 $v = c e_{4}$。\n  $Av = A(c e_{4}) = c(A e_{4})$。由于 $e_{4}$ 是特征值为 $2$ 的特征向量，所以 $A e_{4} = 2 \\cdot e_{4}$。\n  因此，$Av = c(2 \\cdot e_{4}) = (2c)e_{4}$，这是 $e_{4}$ 的一个标量倍，因此位于 $E^{u}$ 中。所以，$A E^{u} \\subseteq E^{u}$。\n\n每个子空间确实是 $A$-不变的。\n\n**3. 投影矩阵与验证**\n\n任何向量 $x = (x_{1}, x_{2}, x_{3}, x_{4})^{T} \\in \\mathbb{R}^{4}$ 都可以写成 $x = x_{1}e_{1} + x_{2}e_{2} + x_{3}e_{3} + x_{4}e_{4}$。我们可以将 $x$ 唯一地分解为 $x = x^{s} + x^{c} + x^{u}$，其中 $x^{\\sigma} \\in E^{\\sigma}$。\n$x^{s} = x_{3}e_{3} = (0, 0, x_{3}, 0)^{T}$\n$x^{c} = x_{1}e_{1} + x_{2}e_{2} = (x_{1}, x_{2}, 0, 0)^{T}$\n$x^{u} = x_{4}e_{4} = (0, 0, 0, x_{4})^{T}$\n\n投影矩阵 $P^{\\sigma}$ 由 $P^{\\sigma}x = x^{\\sigma}$ 定义。\n- $P^{s}x = x^{s}$ 意味着 $P^{s} = \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} = \\mathrm{diag}(0, 0, 1, 0)$。\n- $P^{c}x = x^{c}$ 意味着 $P^{c} = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} = \\mathrm{diag}(1, 1, 0, 0)$。\n- $P^{u}x = x^{u}$ 意味着 $P^{u} = \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} = \\mathrm{diag}(0, 0, 0, 1)$。\n\n我们验证所需的性质：\n- **幂等性 ($P^{\\sigma}P^{\\sigma} = P^{\\sigma}$)**：由于所有的 $P^{\\sigma}$ 都是对角矩阵，其元素为 $0$ 或 $1$，对它们进行平方就是对对角元素进行平方。因为 $0^{2}=0$ 和 $1^{2}=1$，所以矩阵保持不变。例如，$(P^{s})^{2} = \\mathrm{diag}(0,0,1,0)\\mathrm{diag}(0,0,1,0) = \\mathrm{diag}(0^{2},0^{2},1^{2},0^{2}) = P^{s}$。对于 $P^{c}$ 和 $P^{u}$ 也是如此。\n\n- **完备性 ($P^{s}+P^{c}+P^{u}=I$)**：\n  $$P^{s}+P^{c}+P^{u} = \\mathrm{diag}(0,0,1,0) + \\mathrm{diag}(1,1,0,0) + \\mathrm{diag(0,0,0,1)} = \\mathrm{diag}(0+1+0, 0+1+0, 1+0+0, 0+0+1) = \\mathrm{diag}(1,1,1,1) = I_{4}.$$\n\n- **正交性 ($P^{\\sigma}P^{\\tau}=0$ for $\\sigma\\neq\\tau$)**：对角矩阵的乘积是另一个对角矩阵，其对角元素是相应元素的乘积。$P^{s}$、$P^{c}$ 和 $P^{u}$ 的非零元素位于不相交的位置。\n  $$P^{s}P^{c} = \\mathrm{diag}(0,0,1,0)\\mathrm{diag}(1,1,0,0) = \\mathrm{diag}(0,0,0,0) = 0.$$\n  $$P^{s}P^{u} = \\mathrm{diag}(0,0,1,0)\\mathrm{diag}(0,0,0,1) = \\mathrm{diag}(0,0,0,0) = 0.$$\n  $$P^{c}P^{u} = \\mathrm{diag}(1,1,0,0)\\mathrm{diag}(0,0,0,1) = \\mathrm{diag}(0,0,0,0) = 0.$$\n\n- **与 A 的交换性 ($A P^{\\sigma}=P^{\\sigma} A$)**：由于 $A$ 和所有 $P^{\\sigma}$ 都是对角矩阵，它们是可交换的。我们明确地验证这一点。\n  对于 $\\sigma=s$：\n  $A P^{s} = \\mathrm{diag}(0,0,-1,2)\\mathrm{diag}(0,0,1,0) = \\mathrm{diag}(0,0,-1,0)$。\n  $P^{s} A = \\mathrm{diag}(0,0,1,0)\\mathrm{diag}(0,0,-1,2) = \\mathrm{diag}(0,0,-1,0)$。\n  对于 $\\sigma=c$：\n  $A P^{c} = \\mathrm{diag}(0,0,-1,2)\\mathrm{diag}(1,1,0,0) = \\mathrm{diag}(0,0,0,0) = 0$。\n  $P^{c} A = \\mathrm{diag(1,1,0,0)}\\mathrm{diag(0,0,-1,2)} = \\mathrm{diag}(0,0,0,0) = 0$。\n  对于 $\\sigma=u$：\n  $A P^{u} = \\mathrm{diag}(0,0,-1,2)\\mathrm{diag}(0,0,0,1) = \\mathrm{diag}(0,0,0,2)$。\n  $P^{u} A = \\mathrm{diag}(0,0,0,1)\\mathrm{diag}(0,0,-1,2) = \\mathrm{diag}(0,0,0,2)$。\n所有性质都已从基本原理得到验证。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}\n&\n\\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}\n&\n\\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}\n\\end{pmatrix}\n}\n$$", "id": "2691770"}, {"introduction": "掌握了线性子空间的分解后，我们便可以进入中心流形理论的核心：近似计算非线性的中心流形本身。这个练习将指导你应用不变性条件——即流形上的点在系统演化下仍然停留在流形上——来推导出一个描述流形形状的方程。[@problem_id:2691758] 通过求解这个方程的级数展开，你将能近似得到中心流形，并将高维系统的稳定性分析简化为低维问题。", "problem": "考虑由下式给出的、状态变量为 $x$ 和 $z$ 的自治非线性系统\n$$\n\\dot{x} = z, \\qquad \\dot{z} = -z + x^{2},\n$$\n其平衡点位于原点 $(x,z)=(0,0)$。根据非线性系统与控制中的中心流形定理，存在一个一维中心流形，它穿过原点且与线性化系统的中心子空间相切。仅从线性化、不变流形和微分链式法则的基本定义出发，完成以下任务：\n\n1. 通过分析该系统在原点的线性化及其谱，论证一维中心流形的存在性。指明相关的中心子空间。\n\n2. 将局部不变流形参数化为图 $z = w(x)$，其中 $w(0)=0$ 且 $w'(0)=0$。仅使用从链式法则和系统动力学导出的不变性条件，确定泰勒展开式\n$$\nw(x) = a x^{2} + b x^{3} + \\mathcal{O}(x^{4})\n$$\n中为获得二阶近似所需的系数。明确报告二阶近似 $w_{2}(x)$。\n\n3. 推导中心流形上截至并包含三次项的降维标量动力学。使用此降维动力学，对完整系统的原点进行局部稳定性分类（例如，渐近稳定、不稳定或单侧/半稳定），并解释其原因。\n\n作答要求：\n- 您最终报告的表达式应为二阶中心流形近似 $w_{2}(x)$ 及其上截断至三次项的降维标量动力学。将最终答案表示为行矩阵 $\\begin{pmatrix} w_{2}(x) & f_{c}(x) \\end{pmatrix}$，其中 $f_{c}(x)$ 表示中心流形上截至三次项的降维标量动力学方程的右侧部分。\n- 无需数值取整。\n- 没有物理单位。", "solution": "我们分析系统\n$$\n\\dot{x} = z, \\qquad \\dot{z} = -z + x^{2},\n$$\n在平衡点 $(x,z)=(0,0)$ 处的情况。\n\n步骤 1：线性化与中心子空间。\n原点的雅可比矩阵由向量场的一阶项得到：\n$$\nA = \\begin{bmatrix}\n\\frac{\\partial \\dot{x}}{\\partial x} & \\frac{\\partial \\dot{x}}{\\partial z} \\\\\n\\frac{\\partial \\dot{z}}{\\partial x} & \\frac{\\partial \\dot{z}}{\\partial z}\n\\end{bmatrix}_{(0,0)}\n=\n\\begin{bmatrix}\n0 & 1 \\\\\n0 & -1\n\\end{bmatrix}.\n$$\n特征多项式为 $\\lambda(\\lambda+1)=0$，因此特征值为 $\\lambda_{c}=0$ 和 $\\lambda_{s}=-1$。特征值 $\\lambda_{c}=0$ 对应于中心子空间，$\\lambda_{s}=-1$ 对应于稳定子空间。对于 $\\lambda_{c}=0$ 的一个特征向量是 $v_{c}=\\begin{bmatrix}1 \\\\ 0\\end{bmatrix}$，所以中心子空间为\n$$\nE^{c}=\\{(x,z)\\in\\mathbb{R}^{2} : z=0\\}。\n$$\n根据（非线性控制和动力学系统中的常微分方程的）中心流形定理，存在一个在原点与 $E^{c}$ 相切的一维中心流形。\n\n步骤 2：中心流形参数化与不变性方程。\n我们将局部中心流形参数化为图 $z=w(x)$，其中 $w(0)=0$ 且 $w'(0)=0$ 以确保与 $E^{c}$ 相切。不变性条件由链式法则导出：沿着流形，$z=w(x)$ 且 $z$ 的时间导数满足\n$$\n\\dot{z} = \\frac{dw}{dt} = w'(x)\\,\\dot{x}.\n$$\n从原系统可知，沿着流形我们还有\n$$\n\\dot{x} = z = w(x), \\qquad \\dot{z} = -z + x^{2} = -w(x) + x^{2}.\n$$\n令这两个关于 $\\dot{z}$ 的表达式相等，得到不变性方程\n$$\nw'(x)\\,w(x) = -w(x) + x^{2}.\n$$\n寻求一个与 $w(0)=0$ 和 $w'(0)=0$ 一致的泰勒级数 $w(x)=a x^{2} + b x^{3} + \\mathcal{O}(x^{4})$。那么\n$$\nw'(x) = 2 a x + 3 b x^{2} + \\mathcal{O}(x^{3}).\n$$\n计算左侧：\n$$\nw'(x)\\,w(x) = \\big(2 a x + 3 b x^{2} + \\mathcal{O}(x^{3})\\big)\\big(a x^{2} + b x^{3} + \\mathcal{O}(x^{4})\\big)\n= 2 a^{2} x^{3} + \\mathcal{O}(x^{4}).\n$$\n计算右侧：\n$$\n-w(x) + x^{2} = -(a x^{2} + b x^{3} + \\mathcal{O}(x^{4})) + x^{2}\n= (1-a) x^{2} - b x^{3} + \\mathcal{O}(x^{4}).\n$$\n匹配 $x$ 的同次幂系数：\n- 在 $x^{2}$ 阶：左侧系数为 $0$，所以 $0 = 1 - a$，因此 $a=1$。\n- 在 $x^{3}$ 阶：左侧系数为 $2 a^{2}=2$，所以 $2 = -b$，因此 $b = -2$。\n\n因此，\n$$\nw(x) = x^{2} - 2 x^{3} + \\mathcal{O}(x^{4})，\n$$\n且所求的二阶近似为\n$$\nw_{2}(x) = x^{2}.\n$$\n\n步骤 3：降维动力学与分类。\n在中心流形上，降维标量动力学由限制在 $z=w(x)$ 上的 $x$ 分量给出：\n$$\n\\dot{x} = z = w(x) = x^{2} - 2 x^{3} + \\mathcal{O}(x^{4}).\n$$\n截断至三次项，\n$$\nf_{c}(x) = x^{2} - 2 x^{3}.\n$$\n为了对此降维动力学下的平衡点 $x=0$ 进行分类，考虑 $x=0$ 附近的主导项 $x^{2}$。对于足够小的 $x>0$，$f_{c}(x)>0$，因此 $x(t)$ 增加并远离 $0$（右侧排斥）。对于足够小的 $x<0$，$f_{c}(x)>0$ 也成立，因此 $x(t)$ 从左侧增加并趋向于 $0$（左侧吸引）。因此原点是半稳定的（单侧稳定）：对于完整系统它不是李雅普诺夫稳定的，因为从小的 $x>0$ 开始的轨道会远离原点，而那些从小的 $x<0$ 开始的轨道当 $t\\to\\infty$ 时会沿着中心流形趋近于 $0$。中心流形定理确保了此分类在原点邻域内对完整系统也成立，因为稳定方向（$z$ 方向）是指数吸引的，并且从属于中心动力学。", "answer": "$$\\boxed{\\begin{pmatrix} x^{2} & x^{2} - 2 x^{3} \\end{pmatrix}}$$", "id": "2691758"}, {"introduction": "中心流形理论不仅是分析工具，更是设计工具。这个练习将带你探讨一个更有趣的情景：一个系统的中心流形可以被精确求出，并且我们可以利用这一知识来设计反馈控制器。[@problem_id:2691670] 你将看到如何通过施加一个简单的控制律来改变中心流形上的简化动力学，从而实现对整个非线性系统的局部渐近稳定，这体现了该理论在控制设计中的深刻价值。", "problem": "考虑具有两个状态变量 $x \\in \\mathbb{R}$ 和 $y \\in \\mathbb{R}$ 的非线性控制仿射系统，\n$$\n\\dot{x} \\;=\\; y^{2} \\;+\\; u, \n\\qquad\n\\dot{y} \\;=\\; -\\,y \\;+\\; x\\,y,\n$$\n输入为 $u \\in \\mathbb{R}$。在原点邻域内进行分析，并从第一性原理出发分析其动力学。除了中心流形的定义、局部不变性条件和线性化之外，不引用任何关于中心流形的预先给出的公式。\n\n任务：\n- 推导开环系统在原点处的雅可比矩阵并确定其特征结构。由此，辨识出中心子空间。\n- 对于中心流形 $y = h(x)$，利用其局部不变性条件以及 $h(0) = 0$ 和 $h'(0) = 0$，确定 $h(x)$ 的最低阶非平凡近似，从而辨识开环系统的一个中心流形 $W^{c}$。\n- 证明在 $W^{c}$ 上的开环降维动力学具有一个连续的平衡点集，并解释其对稳定性的影响。\n- 现在使用状态反馈 $u(x) = -\\,x$ 构成闭环。利用上面辨识出的同一个中心流形 $W^{c}$，写下降维闭环动力学，并利用线性化和比较法论证完整系统的原点是局部渐近稳定的。\n- 在中心流形上定义降维控制李雅普诺夫候选函数为 $V_{c}(x) = \\tfrac{1}{2} x^{2}$，并计算其沿着 $W^{c}$ 上的闭环降维动力学的时间导数。\n\n将你的最终答案表示为 $\\dot{V}_{c}(x)$ 沿着 $W^{c}$ 上的闭环降维动力学的解析表达式。不需要数值近似，也不涉及单位。最终答案必须是单一的闭式表达式。", "solution": "在尝试求解之前，将对问题进行验证。\n\n首先，我提取问题陈述中给出的已知条件。\n系统动力学由以下方程给出：\n$$\n\\begin{cases}\n\\dot{x} \\;=\\; y^{2} \\;+\\; u \\\\\n\\dot{y} \\;=\\; -\\,y \\;+\\; x\\,y\n\\end{cases}\n$$\n其中 $x, y \\in \\mathbb{R}$ 是状态变量， $u \\in \\mathbb{R}$ 是控制输入。分析将在原点 $(x,y) = (0,0)$ 的邻域内进行。\n明确的任务如下：\n1. 对于开环系统（$u=0$），推导在原点处的雅可比矩阵及其特征结构，并辨识中心子空间。\n2. 通过使用局部不变性条件，为描述为 $y = h(x)$ 且满足条件 $h(0) = 0$ 和 $h'(0) = 0$ 的中心流形寻找一个近似。\n3. 确定此流形上的开环降维动力学并分析其稳定性。\n4. 对于带反馈 $u(x) = -x$ 的闭环系统，使用先前辨识出的流形来寻找降维动力学，并分析完整系统的稳定性。\n5. 使用降维控制李雅普诺夫候选函数 $V_{c}(x) = \\frac{1}{2} x^{2}$，计算其沿着闭环降维动力学的时间导数 $\\dot{V}_{c}(x)$。\n\n现在，我将验证该问题。此问题使用控制理论和动力系统的标准数学语言进行表述，是自洽的。该系统是一个良定义的非线性控制仿射系统。所要求的任务是利用中心流形定理分析非线性系统的标准步骤。一个潜在的歧义在于“确定 $h(x)$ 的最低阶非平凡近似”这一指令，它假定了这样一个近似的存在。在求解过程中必须检查这一前提的有效性。一个将要被证明的关键观察是，开环中心流形同时也是闭环系统的一个不变流形，这使得分析是精确的而非近似的。这一微妙之处使得问题是适定的且科学上合理的，而非有缺陷的。因此，该问题被视为有效。我将继续进行求解。\n\n首先，我们分析开环系统，此时 $u=0$。其动力学方程为：\n$$\n\\dot{x} = y^{2}\n$$\n$$\n\\dot{y} = -y + xy\n$$\n系统可以写成向量形式 $\\dot{\\mathbf{z}} = \\mathbf{f}(\\mathbf{z})$，其中 $\\mathbf{z} = \\begin{pmatrix} x \\\\ y \\end{pmatrix}$ 且 $\\mathbf{f}(x,y) = \\begin{pmatrix} y^{2} \\\\ -y + xy \\end{pmatrix}$。\n向量场 $\\mathbf{f}$ 的雅可比矩阵是：\n$$\nA = D\\mathbf{f}(x,y) = \\begin{pmatrix} \\frac{\\partial \\dot{x}}{\\partial x} & \\frac{\\partial \\dot{x}}{\\partial y} \\\\ \\frac{\\partial \\dot{y}}{\\partial x} & \\frac{\\partial \\dot{y}}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} 0 & 2y \\\\ y & -1+x \\end{pmatrix}\n$$\n在原点 $(0,0)$ 处求值，我们得到线性化系统的矩阵：\n$$\nA = D\\mathbf{f}(0,0) = \\begin{pmatrix} 0 & 0 \\\\ 0 & -1 \\end{pmatrix}\n$$\n特征值是对角线元素，即 $\\lambda_{1} = 0$ 和 $\\lambda_{2} = -1$。存在实部为零的特征值表明存在一个中心流形。特征值 $\\lambda_{2} = -1$ 对应一个稳定流形。\n对应中心特征值 $\\lambda_{1} = 0$ 的特征向量通过求解 $(A - 0I)\\mathbf{v} = \\mathbf{0}$ 得到：\n$$\n\\begin{pmatrix} 0 & 0 \\\\ 0 & -1 \\end{pmatrix} \\begin{pmatrix} v_{1} \\\\ v_{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\implies -v_{2} = 0\n$$\n这得到 $v_{2}=0$，$v_{1}$ 是任意的。我们选择特征向量 $\\mathbf{v}_{c} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。中心子空间 $E^{c}$ 是该向量的生成空间，即 $x$ 轴。\n对应稳定特征值 $\\lambda_{2} = -1$ 的特征向量通过求解 $(A - (-1)I)\\mathbf{v} = \\mathbf{0}$ 得到：\n$$\n\\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} v_{1} \\\\ v_{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\implies v_{1} = 0\n$$\n这得到 $v_{1}=0$，$v_{2}$ 是任意的。我们选择特征向量 $\\mathbf{v}_{s} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。稳定子空间 $E^{s}$ 是该向量的生成空间，即 $y$ 轴。\n\n接下来，我们确定中心流形 $W^{c}$，它在原点与 $E^{c}$ 相切。它可以局部地表示为图 $y = h(x)$。相切条件意味着 $h(0) = 0$ 和 $h'(0) = 0$。为了使一条轨迹保持在流形上，不变性条件必须成立。将 $y(t) = h(x(t))$ 对时间求导得到 $\\dot{y} = h'(x)\\dot{x}$。我们将开环动力学方程代入此式：\n$$\n-y + xy = h'(x) (y^{2})\n$$\n因为此式必须对流形上的点成立，我们代入 $y=h(x)$：\n$$\n-h(x) + x h(x) = h'(x) [h(x)]^{2}\n$$\n这可以写成 $h(x)(x-1) = h'(x)[h(x)]^{2}$。我们寻求 $h(x)$ 在 $x=0$ 附近的幂级数解。鉴于 $h(0)=0$ 和 $h'(0)=0$，级数必须以至少二次项开始：$h(x) = a_{2}x^{2} + a_{3}x^{3} + \\dots$。\n将此代入不变性方程：\n$$\n(a_{2}x^{2} + a_{3}x^{3} + \\dots)(x-1) = (2a_{2}x + 3a_{3}x^{2} + \\dots)(a_{2}x^{2} + a_{3}x^{3} + \\dots)^{2}\n$$\n展开左侧：\n$$\n-a_{2}x^{2} + (a_{2}-a_{3})x^{3} + \\dots\n$$\n右侧是 $O(x^{5})$ 阶的，因为 $h'(x)$ 的首项是 $O(x)$ 阶，$[h(x)]^2$ 的首项是 $O(x^4)$ 阶。\n$$\n-a_{2}x^{2} + (a_{2}-a_{3})x^{3} + \\dots = O(x^{5})\n$$\n通过比较 $x$ 的同次幂系数，我们发现：\n对于 $x^{2}$：$-a_{2} = 0 \\implies a_{2} = 0$。\n对于 $x^{3}$：$a_{2}-a_{3} = 0$。因为 $a_{2}=0$，这意味着 $a_{3}=0$。\n继续这个过程，所有系数 $a_{k}$ 都必须为零。这导致唯一的解析解 $h(x) = 0$。尽管问题中提到了“非平凡近似”的说法，但唯一形式上正确的中心流形是平凡流形 $y=0$。因此，中心流形是 $W^{c} = \\{(x,y) \\in \\mathbb{R}^{2} \\mid y=0\\}$。\n\n开环系统在 $W^{c}$ 上的降维动力学是通过将 $y=0$ 代入 $\\dot{x}$ 方程得到的：\n$$\n\\dot{x} = y^{2} \\implies \\dot{x} = 0^{2} = 0\n$$\n降维动力学为 $\\dot{x}=0$。任何点 $x=c$ 都是这个降维系统的一个平衡点。这对应于完整系统沿 $x$ 轴的一个连续的平衡点集。就稳定性而言，这意味着原点是李雅普诺夫稳定的，但不是渐近稳定的，因为对 $x$ 的一个小扰动将导致状态停留在受扰动的位置，而不会返回到原点。\n\n现在，我们引入状态反馈控制律 $u(x) = -x$。闭环系统是：\n$$\n\\dot{x} = y^{2} - x\n$$\n$$\n\\dot{y} = -y + xy\n$$\n问题指示我们使用同一个流形 $W^{c}$（即 $y=0$）来分析这个新系统。我们必须首先检查这是否是一个有效的步骤。如果从流形上出发的轨迹始终保持在流形上，则该流形是不变的。如果在闭环系统中设置 $y(0)=0$，则 $\\dot{y}$ 方程变为 $\\dot{y} = -0 + x \\cdot 0 = 0$。这意味着如果 $y$ 从零开始，它将一直保持为零。因此，由 $y=0$ 定义的 $W^{c}$ 是闭环系统的一个不变流形。在此流形上的分析是精确的，而不是近似。\n闭环系统在 $W^{c}$ 上的降维动力学是通过将 $y=0$ 代入闭环 $\\dot{x}$ 方程得到的：\n$$\n\\dot{x} = y^{2} - x \\implies \\dot{x} = 0^{2} - x = -x\n$$\n降维后的一维系统是 $\\dot{x} = -x$。该系统的原点 $x=0$ 是指数稳定的。根据中心流形定理，完整系统原点的局部渐近稳定性由中心流形上的降维动力学的稳定性决定。由于降维动力学是渐近稳定的，且横截于流形的动力学是稳定的（由特征值 $\\lambda_{2} = -1$ 决定），我们得出结论，闭环系统的原点 $(0,0)$ 是局部渐近稳定的。\n\n最后，我们计算中心流形上的李雅普诺夫候选函数 $V_{c}(x) = \\frac{1}{2} x^{2}$ 的时间导数。该导数是沿着闭环降维动力学 $\\dot{x} = -x$ 的轨迹计算的。\n使用链式法则：\n$$\n\\dot{V}_{c}(x) = \\frac{dV_{c}}{dx}\\frac{dx}{dt} = \\frac{d}{dx}\\left(\\frac{1}{2}x^{2}\\right) \\dot{x}\n$$\n我们有 $\\frac{dV_{c}}{dx} = x$ 和 $\\dot{x} = -x$。代入这些可得：\n$$\n\\dot{V}_{c}(x) = (x)(-x) = -x^{2}\n$$\n这个 $\\dot{V}_{c}(x)$ 的表达式就是所要求的最终结果。", "answer": "$$\\boxed{-x^{2}}$$", "id": "2691670"}]}