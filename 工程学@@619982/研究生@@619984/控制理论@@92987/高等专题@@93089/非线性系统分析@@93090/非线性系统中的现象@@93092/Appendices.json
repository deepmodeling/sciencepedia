{"hands_on_practices": [{"introduction": "极限环是自激振荡的数学表示，是非线性系统中的一个基本现象。虽然大多数非线性系统无法求得解析解，但某些特殊情况，例如包含继电器的反馈系统，却可以通过分段分析精确求解。这个练习 [@problem_id:2731666] 将指导您通过拼接线性常微分方程的精确解，来分析一个典型的继电器反馈系统，并精确计算其极限环的周期。这种方法为您在处理更复杂的近似方法之前，建立起对极限环行为的坚实直观理解。", "problem": "考虑一个由一阶线性时不变对象和带滞回的对称继电器组成的单输入单输出反馈互联系统。该对象为\n$$\\tau \\,\\dot{y}(t) + y(t) = k\\,u(t),$$\n其中常数 $\\tau>0$ 和 $k>0$，输出为 $y(t)$，输入 $u(t)\\in\\{-M,+M\\}$ 的幅值固定为 $M>0$。该继电器是对称的，滞回半宽为 $h$，满足 $0<h<kM$，并遵循以下开关规则：如果 $y(t)\\ge h$，则 $u(t)$ 被设置为 $-M$；如果 $y(t)\\le -h$，则 $u(t)$ 被设置为 $+M$；当 $y(t)\\in(-h,h)$ 时，输入 $u(t)$ 保持其最近的值。假设外部参考为零，因此唯一的非线性环节是继电器。\n\n在这些条件下，闭环系统表现出一个对称的周期轨道（极限环），该轨道在两个恒定输入之间交替。通过在每个开关事件之间的时间间隔内对线性动态方程进行积分，计算该对称继电振荡的周期 $T$ 关于 $\\tau$、$k$、$M$ 和 $h$ 的显式解析表达式。从上述基本状态方程和继电器规则出发；不要使用任何频域近似法。假设振荡是对称的，因此在 $u(t)=+M$ 的作用下，$y(t)$ 从 $-h$ 单调演变到 $+h$；在 $u(t)=-M$ 的作用下，从 $+h$ 单调演变到 $-h$。\n\n以秒为单位表示最终周期。以单个闭式表达式的形式给出答案。无需进行数值舍入。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 对象动态：$\\tau \\,\\dot{y}(t) + y(t) = k\\,u(t)$\n- 常数：$\\tau>0$, $k>0$, $M>0$, $0<h<kM$\n- 输入：$u(t) \\in \\{-M, +M\\}$\n- 继电器规则：\n  - 如果 $y(t) \\ge h$，则 $u(t) \\to -M$。\n  - 如果 $y(t) \\le -h$，则 $u(t) \\to +M$。\n  - 如果 $y(t) \\in (-h, h)$，$u(t)$ 保持其先前的值。\n- 假设：系统表现出对称的周期轨道，其中在 $u(t)=+M$ 的作用下，$y(t)$ 从 $-h$ 单调演变到 $+h$；在 $u(t)=-M$ 的作用下，从 $+h$ 单调演变到 $-h$。\n- 目标：计算此振荡的周期 $T$ 关于 $\\tau$、$k$、$M$ 和 $h$ 的表达式。\n\n**步骤2：验证**\n该问题具有科学依据，提法恰当且客观。它描述了非线性反馈系统中极限环的一个典型例子，这是控制理论中的一个基本课题。所有必要的参数和条件都已给出，并且它们是一致的。条件 $kM > h$ 至关重要，因为它确保了在恒定输入 $u=\\pm M$ 下输出的稳态值（即 $y_{ss} = \\pm kM$）位于滞回带 $[-h, h]$ 之外，从而迫使系统发生振荡。该问题是分段求解一阶线性常微分方程的标准练习，不包含任何歧义、矛盾或事实错误。\n\n**结论**\n问题有效。继续求解。\n\n对称极限环的分析分为两半进行。根据对称性，每个半周期的持续时间相同，等于 $\\frac{T}{2}$，其中 $T$ 是总振荡周期。\n\n我们来分析第一个半周期，其中输出 $y(t)$ 从 $y = -h$ 演变到 $y = h$。根据继电器规则，为了使输出从一个低于 $-h$ 的值开始增加，输入必须已经切换到 $u(t) = +M$。该输入值将一直保持，直到 $y(t)$ 达到上阈值 $h$。\n\n我们定义 $t=0$ 为 $y(t)$ 从减小转为增加的时刻，因此有 $y(0) = -h$。在区间 $t \\in [0, \\frac{T}{2}]$ 内，主导微分方程为：\n$$ \\tau \\frac{dy}{dt} + y(t) = kM $$\n这是一个一阶线性非齐次常微分方程。通解 $y(t)$ 是齐次解 $y_h(t)$ 与一个特解 $y_p(t)$ 的和。\n\n齐次方程为 $\\tau \\dot{y}_h + y_h = 0$，其解为：\n$$ y_h(t) = C \\exp\\left(-\\frac{t}{\\tau}\\right) $$\n其中 $C$ 是一个积分常数。\n\n对于特解，由于方程右侧是常数 $kM$，我们假设一个常数特解 $y_p(t) = A_{p}$。将其代入微分方程得到：\n$$ \\tau \\frac{d}{dt}(A_{p}) + A_{p} = kM \\implies 0 + A_{p} = kM \\implies A_{p} = kM $$\n系统趋向的稳态值为 $kM$。\n\n因此，该区间的通解为：\n$$ y(t) = C \\exp\\left(-\\frac{t}{\\tau}\\right) + kM $$\n为了确定常数 $C$，我们应用该半周期的初始条件，即 $y(0) = -h$。\n$$ y(0) = C \\exp(0) + kM = C + kM = -h $$\n求解 $C$ 可得：\n$$ C = -h - kM = -(kM + h) $$\n因此，在这第一个半周期内，输出的具体轨迹为：\n$$ y(t) = kM - (kM + h) \\exp\\left(-\\frac{t}{\\tau}\\right) $$\n当输出达到上开关阈值 $y(t) = h$ 时，第一个半周期结束。设这发生在时间 $t = \\frac{T}{2}$。\n$$ y\\left(\\frac{T}{2}\\right) = h = kM - (kM + h) \\exp\\left(-\\frac{T}{2\\tau}\\right) $$\n我们现在求解这个方程以得到周期 $T$。\n$$ (kM + h) \\exp\\left(-\\frac{T}{2\\tau}\\right) = kM - h $$\n$$ \\exp\\left(-\\frac{T}{2\\tau}\\right) = \\frac{kM - h}{kM + h} $$\n为了分离出 $T$，我们对等式两边取自然对数：\n$$ -\\frac{T}{2\\tau} = \\ln\\left(\\frac{kM - h}{kM + h}\\right) $$\n利用性质 $\\ln(\\frac{a}{b}) = -\\ln(\\frac{b}{a})$，我们可以写成：\n$$ \\frac{T}{2\\tau} = \\ln\\left(\\frac{kM + h}{kM - h}\\right) $$\n最后，求解周期 $T$ 得到显式表达式：\n$$ T = 2\\tau \\ln\\left(\\frac{kM + h}{kM - h}\\right) $$\n由于系统的对称性，周期的后半部分（其中在输入 $u(t)=-M$ 的作用下，$y(t)$ 从 $h$ 变为 $-h$）将具有相同的持续时间。因此，该表达式代表了振荡的完整周期。问题中给出的条件 $kM > h$ 确保了对数的参数为正且有定义。", "answer": "$$\\boxed{2\\tau \\ln\\left(\\frac{kM + h}{kM - h}\\right)}$$", "id": "2731666"}, {"introduction": "对于具有平滑非线性的系统，精确求解通常是不可行的，因此我们需要依赖近似分析方法。平均法是一种强大的微扰技术，尤其适用于分析弱非线性振荡器。其核心思想是将系统的快速振荡与缓慢变化的幅度和相位分离开来，并通过对快速时间尺度进行平均来推导慢变动力学方程。这个练习 [@problem_id:2731668] 将让您亲手实践如何将平均法应用于一个广义的弱非线性振荡器，从而推导出决定极限环幅度的慢流方程。", "problem": "考虑一个由二阶常微分方程（ODE）控制的弱非线性振子\n$$\n\\ddot{x} + x = \\varepsilon f(x,\\dot{x}),\n$$\n其中 $0 < \\varepsilon \\ll 1$ 且\n$$\nf(x,\\dot{x}) = \\alpha \\dot{x} - \\beta x^{2}\\dot{x} - \\gamma \\dot{x}^{3},\n$$\n并且 $\\alpha, \\beta, \\gamma$ 为实参数。假设 $\\alpha > 0$ 和 $\\beta + 3\\gamma > 0$，从而可能存在一个唯一的、稳定的、有限振幅的极限环。\n\n以无外力线性振子 $\\ddot{x} + x = 0$ 为基础系统，使用一阶平均理论，推导振幅 $r(t)$ 和相位 $\\phi(t)$ 的平均慢流方程，具体方法为将状态写为极坐标形式 $x(t) = r(t)\\cos(\\theta(t))$ 和 $\\dot{x}(t) = -r(t)\\sin(\\theta(t))$，其中 $\\theta(t) = t + \\phi(t)$，并对基础振荡的一个周期进行平均。根据平均振幅方程，确定所有不动点，并找出与极限环振幅对应的非零不动点。\n\n最终答案仅需提供以 $\\alpha$、$\\beta$ 和 $\\gamma$ 表示的非零不动点振幅的精确闭式解析表达式。最终答案中无需提供任何中间步骤。无需进行数值近似或四舍五入。", "solution": "所给问题是使用微扰法分析弱非线性振子的一个标准练习。该问题是适定的、科学上合理的，并为求解提供了所有必要信息。我将开始进行推导。\n\n控制方程是一个二阶常微分方程：\n$$\n\\ddot{x} + x = \\varepsilon f(x,\\dot{x})\n$$\n其中 $0 < \\varepsilon \\ll 1$ 且 $f(x,\\dot{x}) = \\alpha \\dot{x} - \\beta x^{2}\\dot{x} - \\gamma \\dot{x}^{3}$。我们的任务是使用平均法求出极限环的振幅。\n\n如题所示，我们采用 van der Pol 变换到极坐标：\n$$\nx(t) = r(t)\\cos(\\theta(t))\n$$\n$$\n\\dot{x}(t) = -r(t)\\sin(\\theta(t))\n$$\n其中相位定义为 $\\theta(t) = t + \\phi(t)$。变量 $r(t)$ 和 $\\phi(t)$ 被假定为慢变量，这是该方法的一个关键假设。\n\n对 $x(t)$ 关于时间求导得到：\n$$\n\\dot{x} = \\dot{r}\\cos\\theta - r\\dot{\\theta}\\sin\\theta\n$$\n将此结果与施加的条件 $\\dot{x} = -r\\sin\\theta$ 进行比较，并代入 $\\dot{\\theta} = 1 + \\dot{\\phi}$，我们得到关于慢变量的第一个约束条件：\n$$\n\\dot{r}\\cos\\theta - r(1+\\dot{\\phi})\\sin\\theta = -r\\sin\\theta\n$$\n$$\n\\dot{r}\\cos\\theta - r\\dot{\\phi}\\sin\\theta = 0\n$$\n\n接下来，我们对 $\\dot{x}(t)$ 关于时间求导：\n$$\n\\ddot{x} = -\\dot{r}\\sin\\theta - r\\dot{\\theta}\\cos\\theta\n$$\n将此结果和 $x = r\\cos\\theta$ 代入原始的常微分方程得到：\n$$\n(-\\dot{r}\\sin\\theta - r\\dot{\\theta}\\cos\\theta) + r\\cos\\theta = \\varepsilon f(r\\cos\\theta, -r\\sin\\theta)\n$$\n再次使用 $\\dot{\\theta} = 1+\\dot{\\phi}$，我们得到第二个约束条件：\n$$\n-\\dot{r}\\sin\\theta - r(1+\\dot{\\phi})\\cos\\theta + r\\cos\\theta = \\varepsilon f(x, \\dot{x})\n$$\n$$\n-\\dot{r}\\sin\\theta - r\\dot{\\phi}\\cos\\theta = \\varepsilon f(x, \\dot{x})\n$$\n\n现在我们得到了一个关于 $\\dot{r}$ 和 $\\dot{\\phi}$ 的线性方程组：\n$$\n\\begin{cases}\n\\dot{r}\\cos\\theta - r\\dot{\\phi}\\sin\\theta = 0 \\\\\n-\\dot{r}\\sin\\theta - r\\dot{\\phi}\\cos\\theta = \\varepsilon f(x, \\dot{x})\n\\end{cases}\n$$\n求解该方程组得到振幅和相位的精确演化方程：\n$$\n\\dot{r} = -\\varepsilon f(x, \\dot{x})\\sin\\theta\n$$\n$$\n\\dot{\\phi} = -\\frac{\\varepsilon}{r}f(x, \\dot{x})\\cos\\theta\n$$\n现在，我们将函数 $f(x, \\dot{x})$ 用 $r$ 和 $\\theta$ 表示：\n$$\nf(r\\cos\\theta, -r\\sin\\theta) = \\alpha(-r\\sin\\theta) - \\beta(r\\cos\\theta)^{2}(-r\\sin\\theta) - \\gamma(-r\\sin\\theta)^{3}\n$$\n$$\nf(r\\cos\\theta, -r\\sin\\theta) = -r\\alpha\\sin\\theta + r^{3}\\beta\\cos^{2}\\theta\\sin\\theta + r^{3}\\gamma\\sin^{3}\\theta\n$$\n将此表达式代入 $\\dot{r}$ 的方程中：\n$$\n\\dot{r} = -\\varepsilon(-r\\alpha\\sin\\theta + r^{3}\\beta\\cos^{2}\\theta\\sin\\theta + r^{3}\\gamma\\sin^{3}\\theta)\\sin\\theta\n$$\n$$\n\\dot{r} = \\varepsilon(r\\alpha\\sin^{2}\\theta - r^{3}\\beta\\cos^{2}\\theta\\sin^{2}\\theta - r^{3}\\gamma\\sin^{4}\\theta)\n$$\n一阶平均法表明，$r$ 的慢动力学可以通过对其演化方程的右侧在快变量 $\\theta$ 的一个周期（从 $0$ 到 $2\\pi$）上进行平均来近似。在此积分过程中，慢变量 $r$ 被视为常数。平均后的方程，记为 $\\langle\\dot{r}\\rangle$，为：\n$$\n\\langle\\dot{r}\\rangle = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\varepsilon(r\\alpha\\sin^{2}\\theta - r^{3}\\beta\\cos^{2}\\theta\\sin^{2}\\theta - r^{3}\\gamma\\sin^{4}\\theta) d\\theta\n$$\n为了计算这个积分，我们使用以下标准定积分：\n$$\n\\int_{0}^{2\\pi} \\sin^{2}\\theta \\,d\\theta = \\pi\n$$\n$$\n\\int_{0}^{2\\pi} \\cos^{2}\\theta\\sin^{2}\\theta \\,d\\theta = \\int_{0}^{2\\pi} \\frac{1}{4}\\sin^{2}(2\\theta) \\,d\\theta = \\frac{\\pi}{4}\n$$\n$$\n\\int_{0}^{2\\pi} \\sin^{4}\\theta \\,d\\theta = \\int_{0}^{2\\pi} \\left(\\frac{1-\\cos(2\\theta)}{2}\\right)^{2} d\\theta = \\frac{1}{4} \\int_{0}^{2\\pi} (1 - 2\\cos(2\\theta) + \\cos^{2}(2\\theta)) d\\theta = \\frac{1}{4}(2\\pi - 0 + \\pi) = \\frac{3\\pi}{4}\n$$\n将这些结果代入平均方程中：\n$$\n\\langle\\dot{r}\\rangle = \\frac{\\varepsilon}{2\\pi} \\left( r\\alpha(\\pi) - r^{3}\\beta\\left(\\frac{\\pi}{4}\\right) - r^{3}\\gamma\\left(\\frac{3\\pi}{4}\\right) \\right)\n$$\n$$\n\\langle\\dot{r}\\rangle = \\frac{\\varepsilon r}{2} \\left(\\alpha - \\frac{r^{2}}{4}\\beta - \\frac{3r^{2}}{4}\\gamma\\right)\n$$\n$$\n\\langle\\dot{r}\\rangle = \\frac{\\varepsilon r}{8} \\left(4\\alpha - r^{2}(\\beta + 3\\gamma)\\right)\n$$\n该平均振幅方程的不动点通过令 $\\langle\\dot{r}\\rangle = 0$ 求得。这给出两个解：\n1. $r = 0$，这是对应于原点平衡点的平凡不动点。\n2. $4\\alpha - r^{2}(\\beta + 3\\gamma) = 0$，这对应于极限环的非零振幅。\n\n我们求解第二种情况下的 $r$：\n$$\nr^{2}(\\beta + 3\\gamma) = 4\\alpha\n$$\n$$\nr^{2} = \\frac{4\\alpha}{\\beta + 3\\gamma}\n$$\n由于振幅 $r$ 必须为正，我们取正平方根：\n$$\nr = \\sqrt{\\frac{4\\alpha}{\\beta + 3\\gamma}} = 2\\sqrt{\\frac{\\alpha}{\\beta + 3\\gamma}}\n$$\n题目中指出 $\\alpha > 0$ 和 $\\beta + 3\\gamma > 0$，这保证了平方根下的表达式为正且有意义，从而得到一个实的、有限的极限环振幅。对该不动点的稳定性分析证实了其稳定性，因为右侧对 $r$ 的导数在该不动点处的值为 $-\\varepsilon\\alpha$，是负数。这证实了它代表一个稳定的极限环。", "answer": "$$\\boxed{2\\sqrt{\\frac{\\alpha}{\\beta + 3\\gamma}}}$$", "id": "2731668"}, {"introduction": "非线性现象不仅存在于连续时间系统中，在离散时间动态系统或“映射”中，我们能观察到更为丰富和复杂的行为。圆映射是研究频率锁定、准周期性和通向混沌之路的范式模型。通过这个计算实践 [@problem_id:2731669]，您将通过编程来探索这些深刻的概念，通过迭代一个简单的方程来计算其旋转数 $\\rho$。您将亲手绘制出著名的“魔鬼阶梯”，直观地揭示频率锁定区域（也称阿诺德舌）的精细分形结构，从而对周期、准周期和混沌等行为之间的转变获得具体感受。", "problem": "考虑由以下提升动力学定义的离散时间圆映射\n$$\nx_{k+1} \\;=\\; x_k \\;+\\; \\Omega \\;-\\; \\frac{K}{2\\pi}\\,\\sin(2\\pi x_k),\n$$\n其中 $x_k \\in \\mathbb{R}$，$K \\ge 0$ 是非线性参数，$\\Omega \\in [0,1]$ 是归一化的驱动频率。圆上的物理相位为 $\\theta_k = x_k \\bmod 1$。旋转数由以下极限定义\n$$\n\\rho(K,\\Omega) \\;=\\; \\lim_{n\\to\\infty} \\frac{x_n - x_0}{n},\n$$\n对于该系统，此极限在广泛条件下存在，并且在遍历区域内与 $x_0$ 无关。作为 $\\Omega$ 的函数（对于固定的 $K$），已知映射 $\\Omega \\mapsto \\rho(K,\\Omega)$ 形成一个非递减的阶梯函数，其平台表示锁频（也称为锁模），在这些平台上，$\\rho$ 在 $\\Omega$ 的非零区间内取有理数值 $p/q$。这个分形单调函数通常被称为魔鬼阶梯。\n\n您的任务是：对于几个固定的 $K$ 值，在一个 $\\Omega$ 值网格上数值近似 $\\rho(K,\\Omega)$；检测 $\\rho$ 为小分母有理数的锁频平台；并测量平台宽度。仅使用通过提升动力学定义的旋转数和基本数值迭代方法。\n\n使用以下数值步骤和检测标准。\n\n- 对于指定网格上的每一对 $(K,\\Omega)$，从 $x_0=0$ 开始，通过迭代提升映射来近似旋转数：\n  1. 运行 $N_{\\mathrm{tr}}$ 步的暂态过程，以减少对初始条件的敏感性。\n  2. 然后运行 $N_{\\mathrm{avg}}$ 步并计算\n     $$\n     \\widehat{\\rho}(K,\\Omega) \\;=\\; \\frac{x_{N_{\\mathrm{tr}}+N_{\\mathrm{avg}}} - x_{N_{\\mathrm{tr}}}}{N_{\\mathrm{avg}}}.\n     $$\n- 为识别给定 $(K,\\Omega)$ 处的锁频，使用最佳有理逼近（例如，连分数法）将 $\\widehat{\\rho}$ 近似为一个满足 $1 \\le q \\le q_{\\max}$ 的有理数 $p/q$。如果满足以下条件，则声明该点被锁定：\n  $$\n  \\left| \\widehat{\\rho}(K,\\Omega) - \\frac{p}{q} \\right| \\le \\varepsilon_{\\mathrm{lock}},\n  $$\n  并记录标签 $(p,q)$。\n- 为了在给定的 $K$ 值和对 $\\Omega$ 值的扫描中识别一个平台，找到所有点都被锁定在相同 $(p,q)$ 上的 $\\Omega$ 连续序列。平台宽度是该序列中最大和最小 $\\Omega$ 值之差。如果一个平台至少包含 $m_{\\min}$ 个网格点且宽度至少为 $w_{\\min}$，则接受该平台。\n\n在此问题的所有计算中，采用以下固定的数值设置：\n- 使用 $N_{\\mathrm{tr}} = 1500$，$N_{\\mathrm{avg}} = 3000$。\n- 在 $[0,1]$ 区间内使用包含 $N_{\\Omega} = 401$ 个点（包括端点）的均匀 $\\Omega$ 网格，即步长为 $1/400$。\n- 使用 $q_{\\max} = 8$，锁定容差 $\\varepsilon_{\\mathrm{lock}} = 5\\times 10^{-4}$，最小平台宽度 $w_{\\min} = 0.01$，以及最小平台点数 $m_{\\min} = 3$。\n- 所有运行均使用 $x_0 = 0$。\n\n测试套件。\n您必须评估以下四个测试用例，每个用例由 $(K,\\Omega_{\\min},\\Omega_{\\max},N_{\\Omega},q_{\\max},w_{\\min})$ 定义：\n1. $K = 0.0$, $\\Omega_{\\min} = 0.0$, $\\Omega_{\\max} = 1.0$, $N_{\\Omega} = 401$, $q_{\\max} = 8$, $w_{\\min} = 0.01$.\n2. $K = 0.5$, $\\Omega_{\\min} = 0.0$, $\\Omega_{\\max} = 1.0$, $N_{\\Omega} = 401$, $q_{\\max} = 8$, $w_{\\min} = 0.01$.\n3. $K = 1.0$, $\\Omega_{\\min} = 0.0$, $\\Omega_{\\max} = 1.0$, $N_{\\Omega} = 401$, $q_{\\max} = 8, w_{\\min} = 0.01$.\n4. $K = 1.2$, $\\Omega_{\\min} = 0.0$, $\\Omega_{\\max} = 1.0$, $N_{\\Omega} = 401$, $q_{\\max} = 8, w_{\\min} = 0.01$.\n\n对于每个测试用例，您的程序必须：\n- 计算给定 $K$ 值在 $\\Omega$ 网格上所有被接受的平台列表。\n- 每个测试用例返回三个输出：\n  1. 被接受平台的整数总数。\n  2. 一个布尔值，指示 $1:2$ 锁定平台（即 $\\rho = 1/2$）是否存在于被接受的平台中。\n  3. 最宽的被接受平台的宽度，以实数形式表示并四舍五入到 $4$ 位小数。\n\n最终输出格式。\n您的程序应生成单行输出，其中包含四个测试用例的结果，格式为一个由方括号括起来的、逗号分隔的列表的列表。每个内部列表按上述顺序对应一个测试用例，并且必须采用 $[\\text{count},\\text{bool},\\text{width}]$ 的形式，例如：\n$[[3,True,0.1250],[\\dots],[\\dots],[\\dots]]$。\n此问题不涉及单位。根据映射的定义，正弦函数内的角度以弧度为单位。所有浮点输出在打印前必须按上述规定四舍五入到 4 位小数。", "solution": "该问题要求对标准圆映射进行数值研究，这是非线性动力系统和锁频现象研究中的一个基本模型。目标是：对于非线性参数 $K$ 的几个值，在驱动频率 $\\Omega$ 的网格上近似旋转数 $\\rho(K,\\Omega)$，并识别和表征被称为阿诺德舌 (Arnold tongues) 的锁频平台。\n\n解决方案是通过直接实现问题陈述中指定的步骤来构建的。该方法论遵循一个基于第一性原理的分层结构。\n\n分析的核心是旋转数，定义为 $\\rho = \\lim_{n\\to\\infty} (x_n - x_0)/n$。这个量度量了系统相位的平均渐近变化率。我们被要求通过迭代提升映射来计算数值近似值 $\\widehat{\\rho}$：\n$$\nx_{k+1} = x_k + \\Omega - \\frac{K}{2\\pi}\\sin(2\\pi x_k)\n$$\n对每对 $(K, \\Omega)$ 的计算都从 $x_0 = 0$ 开始。前 $N_{\\mathrm{tr}} = 1500$ 次迭代作为暂态阶段被舍弃，以确保系统已稳定到其吸引子上。随后的 $N_{\\mathrm{avg}} = 3000$ 次迭代用于计算平均频率：\n$$\n\\widehat{\\rho}(K,\\Omega) = \\frac{x_{N_{\\mathrm{tr}}+N_{\\mathrm{avg}}} - x_{N_{\\mathrm{tr}}}}{N_{\\mathrm{avg}}}\n$$\n对于每个指定的测试用例 $K$，此过程被系统地应用于区间 $[0,1]$ 上包含 $N_{\\Omega} = 401$ 个 $\\Omega$ 值的均匀网格上的每个点。\n\n一旦为给定的 $\\Omega$ 计算出 $\\widehat{\\rho}$，下一步是测试锁频。这是一个分类任务。如果一个点的数值计算旋转数与一个简单有理数足够接近，则该点被视为锁定。这是通过一个两步过程实现的：\n1.  **最佳有理逼近**：对于每个 $\\widehat{\\rho}$，我们找到其最佳有理逼近 $p/q$，其中分母 $q$ 不超过最大值 $q_{\\max} = 8$。这通过使用连分数法在算法上完成，该方法在标准库中有高效的实现。\n2.  **锁定条件**：如果计算出的旋转数与其有理逼近之间的绝对差在指定的容差范围内，则点 $(\\Omega, \\widehat{\\rho})$ 被分类为以有理数 $p/q$ 锁定：\n    $$\n    \\left| \\widehat{\\rho}(K,\\Omega) - \\frac{p}{q} \\right| \\le \\varepsilon_{\\mathrm{lock}}\n    $$\n    其中 $\\varepsilon_{\\mathrm{lock}} = 5 \\times 10^{-4}$。如果此条件满足，则该状态被标记为对 $(p,q)$；否则，它被视为未锁定。\n\n在给定 $K$ 值的 $\\Omega$ 网格上所有点都被分类后，扫描生成的标签序列以识别平台。一个平台被定义为网格点的一个连续子序列，其中所有点都被锁定到相同的有理数 $(p,q)$。\n\n然后，每个识别出的潜在平台都要经过验证标准的检验，以滤除伪结果或不显著的结果。只有当一个段同时满足以下两个条件时，才被接受为有效平台：\n- 它必须至少包含 $m_{\\min} = 3$ 个连续的网格点。\n- 该段中 $\\Omega$ 值的跨度，定义为该段的 $\\Omega_{\\max} - \\Omega_{\\min}$，必须至少为 $w_{\\min} = 0.01$。\n\n最后，对于每个 $K$ 值，分析被接受的平台集合以提取所需的汇总指标：\n1.  被接受平台的总数。\n2.  一个布尔标志，指示对应于 $1:2$ 锁频（$\\rho = 1/2$）的平台是否存在于被接受的集合中。\n3.  找到的最宽平台的宽度，四舍五入到四位小数。如果没有被接受的平台，则此宽度报告为 $0$。\n\n这整个计算过程被封装在一个程序中，该程序遍历四个指定的 $K$ 值，对每个值执行分析，并按要求将最终结果格式化为单行输出。$K=0$ 的情况作为一个基线，此时映射是线性的（$x_{k+1} = x_k + \\Omega$），因此 $\\rho=\\Omega$。在这种线性情况下，真正的平台无法形成，并且指定的验证标准能如预期那样正确地滤除有理逼近过程产生的任何人为产物。对于 $K>0$，非线性会诱导真正的锁频，并且该算法被设计用来检测和测量由此产生的平台。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom fractions import Fraction\n\ndef solve():\n    \"\"\"\n    Solves the circle map problem by numerically approximating rotation numbers,\n    detecting frequency-locked plateaus, and reporting statistics for several\n    nonlinearity parameters K.\n    \"\"\"\n    # Define the fixed numerical settings from the problem statement.\n    N_TR = 1500\n    N_AVG = 3000\n    EPS_LOCK = 5e-4\n    M_MIN = 3\n    X0 = 0.0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (K, Omega_min, Omega_max, N_Omega, q_max, w_min)\n        (0.0, 0.0, 1.0, 401, 8, 0.01),\n        (0.5, 0.0, 1.0, 401, 8, 0.01),\n        (1.0, 0.0, 1.0, 401, 8, 0.01),\n        (1.2, 0.0, 1.0, 401, 8, 0.01),\n    ]\n\n    all_case_results = []\n    for K, omega_min, omega_max, n_omega, q_max, w_min in test_cases:\n        # Create the grid of Omega values.\n        omega_grid = np.linspace(omega_min, omega_max, n_omega)\n        locked_states = []\n\n        # Pre-compute the K-dependent term for efficiency.\n        k_term = K / (2 * np.pi)\n\n        # Iterate over each Omega to compute rho_hat and determine its locked state.\n        for omega in omega_grid:\n            x = X0\n            \n            # 1. Iterate the map to compute rho_hat.\n            # Transient steps.\n            for _ in range(N_TR):\n                x = x + omega - k_term * np.sin(2 * np.pi * x)\n            \n            x_transient = x\n            \n            # Averaging steps.\n            for _ in range(N_AVG):\n                x = x + omega - k_term * np.sin(2 * np.pi * x)\n            \n            x_final = x\n            \n            rho_hat = (x_final - x_transient) / N_AVG\n            \n            # 2. Find best rational approximation p/q.\n            frac = Fraction(rho_hat).limit_denominator(q_max)\n            p, q = frac.numerator, frac.denominator\n            \n            # 3. Check for frequency locking.\n            if abs(rho_hat - p / q) <= EPS_LOCK and q >= 1:\n                locked_states.append((p, q))\n            else:\n                locked_states.append(None)\n        \n        # 4. Identify and validate plateaus from contiguous locked states.\n        accepted_plateaus = []\n        i = 0\n        while i < n_omega:\n            current_state = locked_states[i]\n            if current_state is None:\n                i += 1\n                continue\n            \n            # A potential plateau starts at index i.\n            start_index = i\n            j = i + 1\n            while j < n_omega and locked_states[j] == current_state:\n                j += 1\n            end_index = j - 1\n            \n            # Apply validation criteria for the identified segment.\n            num_points = end_index - start_index + 1\n            if num_points >= M_MIN:\n                width = omega_grid[end_index] - omega_grid[start_index]\n                if width >= w_min:\n                    p_val, q_val = current_state\n                    plateau_info = {'p': p_val, 'q': q_val, 'width': width}\n                    accepted_plateaus.append(plateau_info)\n            \n            i = j  # Continue search from the end of the current segment.\n        \n        # 5. Compute the required output metrics for the current test case.\n        count = len(accepted_plateaus)\n        has_1_2 = any(p['p'] == 1 and p['q'] == 2 for p in accepted_plateaus)\n        \n        max_width = 0.0\n        if accepted_plateaus:\n            max_width = max(p['width'] for p in accepted_plateaus)\n            \n        all_case_results.append([count, has_1_2, max_width])\n    \n    # Final print statement in the exact required format.\n    result_strings = []\n    for count, has_bool, width in all_case_results:\n        bool_str = 'True' if has_bool else 'False'\n        width_str = f\"{round(width, 4):.4f}\" # Round then format\n        result_strings.append(f\"[{count},{bool_str},{width_str}]\")\n        \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2731669"}]}