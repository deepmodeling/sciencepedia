{"hands_on_practices": [{"introduction": "本练习旨在通过一个简单的一维非线性系统，回归到基本原理。在这种低维情况下，我们无需复杂的工具，仅通过相线分析和稳定性理论，就能精确地刻画出每个平衡点的吸引域。掌握这种基本分析方法，能为我们处理更高维、更复杂系统时如何思考吸引域问题打下坚实的直觉基础。[@problem_id:2738256]", "problem": "考虑定义在$\\mathbb{R}$上的标量自治非线性系统，由常微分方程$\\dot{x}=x-x^{3}$给出。从动力系统和控制的第一性原理出发，完成以下任务：找出所有平衡点，使用线性化方法对其局部稳定性进行分类，然后仅使用不变性、Lipschitz向量场的解的唯一性以及源于第一性原理的Lyapunov论证等基本工具，严格证明每个平衡点的全局吸引域。明确描述吸引盆的边界，并解释为何不存在其他边界。最后，确定每个平衡点的吸引域（ROA），将其表示为$\\mathbb{R}$的子集。最后，报告平衡点$x^{\\star}=1$的吸引域与区间$[-2,2]$交集的勒贝格测度作为你的最终答案。最终答案应表示为单个实数。要求精确值，无需四舍五入。", "solution": "该问题要求对定义在域$\\mathbb{R}$上、由常微分方程$\\dot{x} = f(x) = x - x^{3}$给出的标量自治系统进行全面分析。此分析将从第一性原理出发，首先辨识和分类平衡点，然后严格确定它们各自的吸引域，最终计算一个指定的勒贝格测度。\n\n首先，我们通过求解方程$\\dot{x} = 0$来找出系统的平衡点。\n$$x - x^{3} = 0$$\n$$x(1 - x^{2}) = 0$$\n$$x(1 - x)(1 + x) = 0$$\n这给出了三个不同的平衡点：$x_{1}^{\\star} = -1$，$x_{2}^{\\star} = 0$ 和 $x_{3}^{\\star} = 1$。\n\n接下来，我们通过线性化方法研究每个平衡点的局部稳定性。向量场为 $f(x) = x - x^{3}$。这个一维系统的雅可比式是$f(x)$关于$x$的导数：\n$$J(x) = \\frac{df}{dx} = 1 - 3x^{2}$$\n根据 Hartman-Grobman 定理，双曲平衡点（其特征值的实部非零）的稳定性由在该点计算的雅可比矩阵的特征值的符号决定。\n- 对于平衡点 $x_{1}^{\\star} = -1$：\n$$J(-1) = 1 - 3(-1)^{2} = 1 - 3 = -2$$\n由于特征值 $\\lambda = -2 < 0$，位于 $x^{\\star} = -1$ 的平衡点是局部渐近稳定的（一个汇点）。\n- 对于平衡点 $x_{2}^{\\star} = 0$：\n$$J(0) = 1 - 3(0)^{2} = 1$$\n由于特征值 $\\lambda = 1 > 0$，位于 $x^{\\star} = 0$ 的平衡点是不稳定的（一个源点）。\n- 对于平衡点 $x_{3}^{\\star} = 1$：\n$$J(1) = 1 - 3(1)^{2} = 1 - 3 = -2$$\n由于特征值 $\\lambda = -2 < 0$，位于 $x^{\\star} = 1$ 的平衡点是局部渐近稳定的（一个汇点）。\n\n我们现在进行全局分析以确定吸引域。向量场 $f(x) = x - x^{3}$ 是一个多项式，因此在$\\mathbb{R}$上是连续可微的（$C^{\\infty}$）。这保证了 $f(x)$ 在$\\mathbb{R}$的任何紧区间上都是局部 Lipschitz 的，根据 Picard-Lindelöf 定理，这保证了对于任意给定的初始条件 $x(0) = x_{0}$，解都存在且唯一。\n\n通过检查由平衡点定义的各个区间上 $\\dot{x} = x(1-x)(1+x)$ 的符号，可以定性地理解轨迹的行为：\n- 对于 $x \\in (1, \\infty)$，我们测试 $x=2$：$\\dot{x} = 2(1-2)(1+2) = -6 < 0$。轨迹向左移动，趋向于 $x=1$。\n- 对于 $x \\in (0, 1)$，我们测试 $x=0.5$：$\\dot{x} = 0.5(1-0.5)(1+0.5) > 0$。轨迹向右移动，趋向于 $x=1$。\n- 对于 $x \\in (-1, 0)$，我们测试 $x=-0.5$：$\\dot{x} = -0.5(1-(-0.5))(1+(-0.5)) < 0$。轨迹向左移动，趋向于 $x=-1$。\n- 对于 $x \\in (-\\infty, -1)$，我们测试 $x=-2$：$\\dot{x} = -2(1-(-2))(1+(-2)) > 0$。轨迹向右移动，趋向于 $x=-1$。\n\n这个相线分析表明，$x^{\\star}=1$ 的吸引域是 $(0, \\infty)$，$x^{\\star}=-1$ 的吸引域是 $(-\\infty, 0)$，而点 $x^{\\star}=0$ 是分隔这两个吸引盆的边界。\n\n我们必须严格地证明这些结论。\n令 $A(x^{\\star})$ 表示平衡点 $x^{\\star}$ 的吸引域（或吸引盆）。\n对于平衡点 $x^{\\star}=1$：\n设初始条件 $x(0) = x_{0} \\in (0, 1)$。由于在此区间内 $\\dot{x} > 0$，解 $x(t)$ 是一个关于时间的单调递增函数。由于 $x=1$ 是一个平衡点，解的唯一性阻止 $x(t)$ 穿过 $1$。因此，$x(t)$ 是一个以 $1$ 为上界的单调递增函数。根据单调收敛定理，极限 $\\lim_{t \\to \\infty} x(t)$ 必然存在，并且必定是一个平衡点。在区间 $(0, 1]$ 内唯一的平衡点是 $x=1$。因此，$\\lim_{t \\to \\infty} x(t) = 1$。\n现在，设 $x(0) = x_{0} \\in (1, \\infty)$。由于在此区间内 $\\dot{x} < 0$，解 $x(t)$ 是单调递减的，并以 $1$ 为下界。通过类似的论证，$\\lim_{t \\to \\infty} x(t) = 1$。\n显然，如果 $x(0)=1$，那么对于所有 $t \\geq 0$ 都有 $x(t)=1$。\n综合这些情况，我们严格地确定了 $x^{\\star}=1$ 的吸引域为 $A(1) = (0, \\infty)$。\n\n对于平衡点 $x^{\\star}=-1$：\n向量场 $f(x)=x-x^3$ 是一个奇函数，即 $f(-x)=-f(x)$。这意味着如果 $x(t)$ 是 $\\dot{x}=f(x)$ 的一个解，那么 $y(t) = -x(t)$ 也是一个解，因为 $\\dot{y}(t) = -\\dot{x}(t) = -f(x(t)) = -f(-y(t)) = f(y(t))$。因此，相图关于原点对称。$x^{\\star}=-1$ 的吸引域必然是 $x^{\\star}=1$ 吸引域的相反数集。因此，$A(-1) = (-\\infty, 0)$。\n\n对于平衡点 $x^{\\star}=0$：\n这是一个不稳定的平衡点。任何不等于 $0$ 的初始条件 $x_{0}$，无论离 $0$ 多近，都将导致轨迹远离 $0$ 并收敛到 $1$ 或 $-1$。因此，$x^{\\star}=0$ 的吸引域只包含该点本身：$A(0) = \\{0\\}$。\n\n吸引盆的边界是吸引域之间的交界面。状态空间 $\\mathbb{R}$ 被划分为三个不相交的集合：$A(-1) = (-\\infty, 0)$，$A(0) = \\{0\\}$ 和 $A(1) = (0, \\infty)$。$A(1)$ 的边界是 $\\partial A(1) = \\{0\\}$，而 $A(-1)$ 的边界是 $\\partial A(-1) = \\{0\\}$。点 $x=0$ 是一个不稳定的平衡点，它的稳定流形（在这个标量情况下就是该点本身）构成了两个稳定平衡点吸引盆之间的边界。由于对于任意大的 $|x|$，都有 $\\dot{x} \\approx -x^3$，这会将轨迹推向原点，所以没有轨迹可以逃逸到无穷远。因此，$\\mathbb{R}$ 中的每个点都必须收敛到三个平衡点之一。这个划分是完备的，不存在其他边界。\n\n最后，我们被要求计算平衡点 $x^{\\star}=1$ 的吸引域与区间 $[-2, 2]$ 交集的勒贝格测度。\n$x^{\\star}=1$ 的吸引域是 $A(1) = (0, \\infty)$。\n该区间是 $I = [-2, 2]$。\n这两个集合的交集是：\n$$S = A(1) \\cap I = (0, \\infty) \\cap [-2, 2] = (0, 2]$$\n一个区间 $(a, b]$ 的勒贝格测度 $\\mu$ 由 $b-a$ 给出。\n因此，该交集的测度是：\n$$\\mu(S) = \\mu((0, 2]) = 2 - 0 = 2$$\n最终答案是 $2$。", "answer": "$$\\boxed{2}$$", "id": "2738256"}, {"introduction": "当系统维度增加时，精确求解吸引域（ROA）通常变得不可能。本练习介绍了应对这一挑战的核心技术：使用Lyapunov函数来确定一个可保证的真实吸引域的“内估计”。您的任务是，对于一个给定的Lyapunov函数，通过求解一个典型的控制理论优化问题，找到其水平子集所能构成的最大认证吸引域。[@problem_id:2738264]", "problem": "考虑一个自治非线性系统，其由常微分方程(ODE) $\\dot{x}=f(x)$ 给出，状态为 $x=\\begin{bmatrix}x_{1}\\\\x_{2}\\end{bmatrix}\\in\\mathbb{R}^{2}$，动力学方程为\n$$\n\\dot{x}=\\begin{bmatrix}-x_{1}+x_{1}x_{2}\\\\ -x_{2}\\end{bmatrix}.\n$$\n设一个连续可微的正定候选函数 $V:\\mathbb{R}^{2}\\to\\mathbb{R}_{\\ge 0}$ 为\n$$\nV(x)=x_{1}^{2}+x_{2}^{2}.\n$$\n从李雅普诺夫导数的基本定义 $\\dot{V}(x)=\\nabla V(x)^{\\top}f(x)$ 出发，首先计算 $\\dot{V}(x)$ 沿系统轨迹的变化。接下来，仅使用基本原理（范数约束下的优化和比较不等式），确定最大的 $c>0$，使得子水平集\n$$\n\\Omega_{c}\\coloneqq\\{x\\in\\mathbb{R}^{2}:V(x)\\le c\\}\n$$\n是平衡点 $x=0$ 吸引域的一个内估计，该估计由李雅普诺夫直接法所验证；也就是说，对于所有满足 $V(x)=c$ 的 $x$，有 $\\dot{V}(x)\\le 0$，并且对于所有满足 $V(x)<c$ 的非零 $x$ (即 $x \\neq 0$)，有 $\\dot{V}(x)<0$。\n\n请以有序对 $(\\dot{V}(x),\\,c)$ 的精确形式（无四舍五入）报告您的最终答案。", "solution": "第一步是计算候选李雅普诺夫函数 $V(x)$ 沿系统轨迹的时间导数。这就是李雅普诺夫导数 $\\dot{V}(x)$。$V(x) = x_{1}^{2}+x_{2}^{2}$ 的梯度为：\n$$\n\\nabla V(x) = \\begin{bmatrix} \\frac{\\partial V}{\\partial x_{1}} \\\\ \\frac{\\partial V}{\\partial x_{2}} \\end{bmatrix} = \\begin{bmatrix} 2x_{1} \\\\ 2x_{2} \\end{bmatrix}\n$$\n然后，李雅普诺夫导数通过 $\\dot{V}(x) = \\nabla V(x)^{\\top}f(x)$ 计算如下：\n$$\n\\dot{V}(x) = \\begin{bmatrix} 2x_{1} & 2x_{2} \\end{bmatrix} \\begin{bmatrix} -x_{1}+x_{1}x_{2} \\\\ -x_{2} \\end{bmatrix}\n$$\n$$\n\\dot{V}(x) = 2x_{1}(-x_{1}+x_{1}x_{2}) + 2x_{2}(-x_{2})\n$$\n$$\n\\dot{V}(x) = -2x_{1}^{2} + 2x_{1}^{2}x_{2} - 2x_{2}^{2}\n$$\n这就是 $\\dot{V}(x)$ 的表达式。\n\n第二步是找到最大的常数 $c>0$，使得子水平集 $\\Omega_c=\\{x : V(x) \\le c\\}$ 是吸引域的一个内估计。根据李雅普诺夫直接法，这要求 $\\dot{V}(x)$ 在 $\\Omega_c$ 内是半负定的，并且仅在平衡点 $x=0$ 处为零。也就是说，我们需要对所有 $x \\in \\Omega_c$ 有 $\\dot{V}(x) \\le 0$，且 $\\dot{V}(x)=0$ 当且仅当 $x=0$。\n\n在状态空间中任何 $\\dot{V}(x) > 0$ 的区域，吸引域的估计都会受到影响。我们来分析这个条件：\n$$\n-2x_{1}^{2} + 2x_{1}^{2}x_{2} - 2x_{2}^{2} > 0\n$$\n$$\n2x_{1}^{2}(x_{2}-1) > 2x_{2}^{2}\n$$\n$$\nx_{1}^{2}(x_{2}-1) > x_{2}^{2}\n$$\n为使此不等式成立，由于 $x_{1}^{2} \\ge 0$ 且 $x_{2}^{2} \\ge 0$，必须有 $x_{2}-1 > 0$，这意味着 $x_{2} > 1$。如果 $x_{2} \\le 1$，则不等式左侧非正，而右侧非负，因此不等式不能满足。所以，$\\dot{V}(x)$ 可能为正的“不安全”区域仅存在于 $x_{2} > 1$ 的地方。\n\n我们寻求最大的子水平集 $\\Omega_c$（一个以原点为中心、半径为 $\\sqrt{c}$ 的圆盘），使其不进入 $\\dot{V}(x) > 0$ 的不安全区域。这意味着对于任何满足 $V(x) \\le c$ 的 $x$，必须有 $\\dot{V}(x) \\le 0$。这样的最大 $c$ 值由 $V(x)$ 在不安全区域边界上的最小值决定。这个边界是使得 $\\dot{V}(x) = 0$ 的点集（不包括原点 $x=0$，在原点处 $\\dot{V}(0)=0$ 是平凡成立的）。\n\n我们将其表述为一个约束优化问题：最小化 $V(x) = x_{1}^{2}+x_{2}^{2}$，约束条件为 $\\dot{V}(x) = -2x_{1}^{2} + 2x_{1}^{2}x_{2} - 2x_{2}^{2} = 0$，其中 $x \\neq 0$。\n约束条件可简化为：\n$$\nx_{1}^{2}(x_{2}-1) = x_{2}^{2}\n$$\n如前所述，一个非平凡解（$x_1 \\neq 0$）要求 $x_{2} > 1$。从约束条件中，我们可以用 $x_{2}$ 来表示 $x_{1}^{2}$：\n$$\nx_{1}^{2} = \\frac{x_{2}^{2}}{x_{2}-1}\n$$\n现在，将这个表达式代入函数 $V(x)$，得到一个单变量 $x_2$ 的函数：\n$$\nV(x_{2}) = \\frac{x_{2}^{2}}{x_{2}-1} + x_{2}^{2} = x_{2}^{2} \\left( \\frac{1}{x_{2}-1} + 1 \\right) = x_{2}^{2} \\left( \\frac{1 + x_{2}-1}{x_{2}-1} \\right) = \\frac{x_{2}^{3}}{x_{2}-1}\n$$\n为了找到该函数在 $x_{2} > 1$ 时的最小值，我们计算它关于 $x_2$ 的导数并令其为零：\n$$\n\\frac{dV}{dx_{2}} = \\frac{d}{dx_{2}}\\left(\\frac{x_{2}^{3}}{x_{2}-1}\\right) = \\frac{(3x_{2}^{2})(x_{2}-1) - (x_{2}^{3})(1)}{(x_{2}-1)^{2}} = \\frac{3x_{2}^{3} - 3x_{2}^{2} - x_{2}^{3}}{(x_{2}-1)^{2}} = \\frac{2x_{2}^{3} - 3x_{2}^{2}}{(x_{2}-1)^{2}}\n$$\n将导数设为零以寻找临界点：\n$$\n\\frac{x_{2}^{2}(2x_{2}-3)}{(x_{2}-1)^{2}} = 0\n$$\n由于我们在定义域 $x_{2} > 1$ 内，唯一的解是 $2x_{2}-3 = 0$，这得出 $x_{2} = \\frac{3}{2}$。\n二阶导数检验或一阶导数的符号分析证实了这是一个最小值。对于 $1 < x_2 < \\frac{3}{2}$，导数为负；对于 $x_2 > \\frac{3}{2}$，导数为正。\n在集合 $\\dot{V}(x)=0$ 上 $V(x)$ 的最小值可以通过在 $x_{2} = \\frac{3}{2}$ 处求值得到：\n$$\nc = V\\left(x_{2}=\\frac{3}{2}\\right) = \\frac{\\left(\\frac{3}{2}\\right)^{3}}{\\frac{3}{2}-1} = \\frac{\\frac{27}{8}}{\\frac{1}{2}} = \\frac{27}{4}\n$$\n这个值 $c = \\frac{27}{4}$ 是在使用该李雅普诺夫函数时，能保证子水平集 $\\Omega_c$ 是吸引域子集的最大值。对于任何 $c \\le \\frac{27}{4}$，在集合 $\\Omega_c$ 内的所有点 $x\\neq 0$ 都满足 $\\dot{V}(x) < 0$，而在边界 $V(x)=c$ 上，我们有 $\\dot{V}(x) \\le 0$。\n\n最终答案由有序对 $(\\dot{V}(x), c)$ 组成。\n$\\dot{V}(x) = -2x_{1}^{2} + 2x_{1}^{2}x_{2} - 2x_{2}^{2}$\n$c = \\frac{27}{4}$", "answer": "$$\n\\boxed{\\begin{pmatrix} -2x_{1}^{2} + 2x_{1}^{2}x_{2} - 2x_{2}^{2} & \\frac{27}{4} \\end{pmatrix}}\n$$", "id": "2738264"}, {"introduction": "通过Lyapunov方法得到的解析估计通常是保守的，即实际的吸引域可能远大于理论保证的区域。本练习将理论与实践相结合，演示了如何设计一个数值实验来弥合理论保证与实际吸引域之间的差距。我们将首先推导一个解析界限，然后以此为基础，通过仿真系统地探索和可视化稳定边界，这体现了现代控制分析中理论与计算相辅相成的工作流程。[@problem_id:2721989]", "problem": "考虑由 $\\dot{x} = f(x)$ 给出的连续时间自治非线性常微分方程(ODE)，其中状态 $x \\in \\mathbb{R}^2$ 且\n$$\nf(x) = A x + g(x), \\quad A = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix},\n$$\n以及\n$$\ng(x) = \\begin{bmatrix}\nc_1 x_1^3 + c_2 x_1 x_2^2 \\\\\nc_3 x_1^2 x_2 + c_4 x_2^3\n\\end{bmatrix}.\n$$\n从以下控制理论的基础出发：\n- $\\dot{x} = f(x)$ 在平衡点 $x = 0$ 的雅可比线性化由 $A = \\left.\\frac{\\partial f}{\\partial x}\\right|_{x=0}$ 给出，且李雅普诺夫间接法指出：若 $A$ 是赫尔维茨矩阵（所有特征值的实部都严格为负），则该平衡点是局部渐近稳定的。\n- 对于任意对称正定矩阵 $Q \\in \\mathbb{S}_{++}^2$，当 $A$ 是赫尔维茨矩阵时，连续时间李雅普诺夫方程 $A^\\top P + P A = -Q$ 具有唯一的解 $P \\in \\mathbb{S}_{++}^2$。\n- 可取二次李雅普诺夫候选函数为 $V(x) = x^\\top P x$，并且沿轨迹有 $\\dot{V}(x) = \\nabla V(x)^\\top f(x)$。\n- 使用欧几里得范数和柯西-施瓦茨不等式，以及诸如 $\\lvert x_i \\rvert \\le \\lVert x \\rVert_2$（$i \\in \\{1,2\\}$）的基本界。\n\n你的任务是形式化并实现一个数值实验，通过模拟从二次水平集边界开始的轨迹，来估计上述系统原点周围的一个局部吸引域。你必须将数值结果与一个理论推导出的充分界联系起来，该界保证了在一个二次水平集内 $\\dot{V}$ 的负定性。\n\n执行以下步骤，不使用任何预先给出的简化公式。\n\n- 证明 $A$ 是赫尔维茨矩阵，并选取 $Q = I_2$，然后从 $A^\\top P + P A = -Q$ 计算 $P \\succ 0$。\n- 定义 $V(x) = x^\\top P x$。对于非线性项 $g(x)$，推导一个形式为 $\\lVert g(x) \\rVert_2 \\le c \\lVert x \\rVert_2^3$ 的范数界，其中可计算常数 $c$ 仅用系数 $c_1, c_2, c_3, c_4$ 表示。\n- 仅使用上述基础工具，推导一个充分条件，保证对于二次子水平集 $\\{x \\in \\mathbb{R}^2 \\mid V(x) \\le \\rho\\}$ 中的所有 $x$，都有 $\\dot{V}(x) &lt; 0$。将你的条件表示为一个显式上界 $\\rho_\\star$，使得如果选取 $\\rho \\in (0,\\rho_\\star)$，那么对于该子水平集中的所有 $x$，$\\dot{V}(x) &lt; 0$ 都成立。\n- 设计一个数值实验，对于给定的 $\\rho$，在椭圆 $\\{x \\in \\mathbb{R}^2 \\mid V(x) = \\rho\\}$ 上采样初始条件，在固定时间范围內模拟 $\\dot{x} = f(x)$ 下的轨迹，并在状态数值上趋近原点时将试验标记为成功。使用以下规范：\n  - 使用 $Q = I_2$。\n  - 使用固定的时间范围 $T = 20$。\n  - 使用 $N = 24$ 个初始条件，通过从欧几里得圆到椭圆 $V(x) = \\rho$ 的精确变换，在角度上均匀地在椭圆上选取。\n  - 在数值积分器中使用绝对容差 $\\mathrm{atol} = 10^{-12}$ 和相对容差 $\\mathrm{rtol} = 10^{-9}$。\n  - 如果欧几里得范数满足 $\\lVert x(T) \\rVert_2 \\le 10^{-3}$，或者如果有事件在任何更早的时间检测到轨迹进入原点周围半径为 $10^{-3}$ 的球内，则声明为数值收敛。\n  - 如果有事件在任何时间检测到欧几里得范数超过 $10$，则声明为数值发散。\n- 对于下述每个测试用例，首先根据你推导的充分条件计算 $\\rho_\\star$。然后使用测试用例中的比例因子 $s$ 设置 $\\rho = s \\rho_\\star$。使用此 $\\rho$ 运行上述模拟实验。为每个测试用例返回一个布尔值，当且仅当来自 $N$ 个初始条件的所有模拟轨迹都如上定义地数值收敛时，该值为 $\\mathrm{True}$；否则返回 $\\mathrm{False}$。\n\n使用以下参数值测试套件：\n- 测试用例1：$(c_1,c_2,c_3,c_4) = (0.5,0.5,0.5,0.5)$ 且 $s = 0.5$。\n- 测试用例2：$(c_1,c_2,c_3,c_4) = (1,1,1,1)$ 且 $s = 0.99$。\n- 测试用例3：$(c_1,c_2,c_3,c_4) = (2,2,2,2)$ 且 $s = 20$。\n\n所有量均为无量纲和无单位。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，按测试用例的顺序排列，例如 $[r_1,r_2,r_3]$，其中每个 $r_i$ 都是一个布尔值。不得打印任何额外文本。", "solution": "系统动力学由 $\\dot{x} = f(x)$ 给出，其中 $x \\in \\mathbb{R}^2$，$f(x) = A x + g(x)$，\n$$\nA = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix}, \\quad g(x) = \\begin{bmatrix}\nc_1 x_1^3 + c_2 x_1 x_2^2 \\\\\nc_3 x_1^2 x_2 + c_4 x_2^3\n\\end{bmatrix}.\n$$\n原点 $x=0$ 是一个平衡点，因为 $f(0) = 0$。在原点处 $f(x)$ 的雅可比矩阵是矩阵 $A$。\n\n首先，我们确定线性化系统 $\\dot{x} = Ax$ 的平衡点的局部渐近稳定性。这由 $A$ 的特征值决定。特征方程为 $\\det(A - \\lambda I) = 0$，即\n$$\n\\det \\begin{bmatrix} -\\lambda & 1 \\\\ -2 & -3-\\lambda \\end{bmatrix} = (-\\lambda)(-3-\\lambda) - (1)(-2) = \\lambda^2 + 3\\lambda + 2 = 0.\n$$\n该方程可因式分解为 $(\\lambda+1)(\\lambda+2) = 0$，得到特征值 $\\lambda_1 = -1$ 和 $\\lambda_2 = -2$。由于两个特征值的实部均严格为负，矩阵 $A$ 是赫尔维茨矩阵。根据李雅普诺夫间接法，非线性系统的平衡点 $x=0$ 是局部渐近稳定的。\n\n接下来，我们构造一个二次李雅普诺夫函数 $V(x) = x^\\top P x$ 来分析吸引域。我们必须通过求解连续时间李雅普诺夫方程 $A^\\top P + P A = -Q$ 来找到对称正定矩阵 $P$。问题指定使用 $Q=I_2$，即 $2 \\times 2$ 单位矩阵。设 $P = \\begin{bmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{bmatrix}$。方程变为：\n$$\n\\begin{bmatrix} 0 & -2 \\\\ 1 & -3 \\end{bmatrix} \\begin{bmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{bmatrix} + \\begin{bmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{bmatrix} \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix} = \\begin{bmatrix} -1 & 0 \\\\ 0 & -1 \\end{bmatrix}.\n$$\n执行矩阵乘法和求和，得到：\n$$\n\\begin{bmatrix} -4p_{12} & p_{11}-3p_{12}-2p_{22} \\\\ p_{11}-3p_{12}-2p_{22} & 2p_{12}-6p_{22} \\end{bmatrix} = \\begin{bmatrix} -1 & 0 \\\\ 0 & -1 \\end{bmatrix}.\n$$\n令各元素相等，得到一个关于 $P$ 各项的线性方程组：\n$1. \\quad -4p_{12} = -1 \\implies p_{12} = \\frac{1}{4}$。\n$2. \\quad 2p_{12}-6p_{22} = -1 \\implies 2(\\frac{1}{4}) - 6p_{22} = -1 \\implies \\frac{1}{2} - 6p_{22} = -1 \\implies p_{22} = \\frac{1}{4}$。\n$3. \\quad p_{11}-3p_{12}-2p_{22} = 0 \\implies p_{11} = 3(\\frac{1}{4}) + 2(\\frac{1}{4}) = \\frac{5}{4}$。\n因此，解为 $P = \\frac{1}{4} \\begin{bmatrix} 5 & 1 \\\\ 1 & 1 \\end{bmatrix}$。为确认 $P$ 是正定的，我们检查其主子式：$p_{11} = \\frac{5}{4} > 0$ 且 $\\det(P) = (\\frac{5}{4})(\\frac{1}{4}) - (\\frac{1}{4})^2 = \\frac{4}{16} = \\frac{1}{4} > 0$。两者均为正，故 $P \\succ 0$。\n\n现在，我们推导李雅普诺夫函数的时间导数 $\\dot{V}(x)$ 为负的充分条件。沿非线性系统轨迹的导数为：\n$$\n\\dot{V}(x) = \\nabla V(x)^\\top f(x) = (2Px)^\\top (Ax + g(x)) = x^\\top(A^\\top P + PA)x + 2x^\\top P g(x).\n$$\n使用 $A^\\top P + PA = -I_2$，可简化为：\n$$\n\\dot{V}(x) = -x^\\top I_2 x + 2x^\\top P g(x) = -\\lVert x \\rVert_2^2 + 2x^\\top P g(x).\n$$\n为使 $\\dot{V}(x)$ 为负，我们要求 $2x^\\top P g(x) < \\lVert x \\rVert_2^2$。我们对包含 $g(x)$ 的项进行放缩。首先，我们找到 $g(x)$ 范数的一个界。使用不等式 $|x_i| \\le \\lVert x \\rVert_2$：\n$$\n\\lvert g_1(x) \\rvert = \\lvert c_1 x_1^3 + c_2 x_1 x_2^2 \\rvert \\le \\lvert c_1 \\rvert \\lvert x_1 \\rvert^3 + \\lvert c_2 \\rvert \\lvert x_1 \\rvert \\lvert x_2 \\rvert^2 \\le (\\lvert c_1 \\rvert + \\lvert c_2 \\rvert) \\lVert x \\rVert_2^3.\n$$\n$$\n\\lvert g_2(x) \\rvert = \\lvert c_3 x_1^2 x_2 + c_4 x_2^3 \\rvert \\le \\lvert c_3 \\rvert \\lvert x_1 \\rvert^2 \\lvert x_2 \\rvert + \\lvert c_4 \\rvert \\lvert x_2 \\rvert^3 \\le (\\lvert c_3 \\rvert + \\lvert c_4 \\rvert) \\lVert x \\rVert_2^3.\n$$\n因此，$g(x)$ 的欧几里得范数有界，其界为：\n$$\n\\lVert g(x) \\rVert_2 = \\sqrt{\\lvert g_1(x) \\rvert^2 + \\lvert g_2(x) \\rvert^2} \\le \\sqrt{(\\lvert c_1 \\rvert + \\lvert c_2 \\rvert)^2 \\lVert x \\rVert_2^6 + (\\lvert c_3 \\rvert + \\lvert c_4 \\rvert)^2 \\lVert x \\rVert_2^6} = c \\lVert x \\rVert_2^3,\n$$\n其中 $c = \\sqrt{(\\lvert c_1 \\rvert + \\lvert c_2 \\rvert)^2 + (\\lvert c_3 \\rvert + \\lvert c_4 \\rvert)^2}$。\n\n使用此界和柯西-施瓦茨不等式，我们对 $2x^\\top P g(x)$ 进行放缩：\n$$\n2x^\\top P g(x) \\le 2 \\lvert x^\\top P g(x) \\rvert \\le 2 \\lVert Px \\rVert_2 \\lVert g(x) \\rVert_2.\n$$\n由于 $P$ 是对称正定的，其诱导2-范数是它的最大特征值，$\\lVert P \\rVert_2 = \\lambda_{\\max}(P)$。因此，$\\lVert Px \\rVert_2 \\le \\lVert P \\rVert_2 \\lVert x \\rVert_2 = \\lambda_{\\max}(P) \\lVert x \\rVert_2$。代入这些界：\n$$\n2x^\\top P g(x) \\le 2 (\\lambda_{\\max}(P) \\lVert x \\rVert_2) (c \\lVert x \\rVert_2^3) = 2c\\lambda_{\\max}(P) \\lVert x \\rVert_2^4.\n$$\n因此，如果 $-\\lVert x \\rVert_2^2 + 2c\\lambda_{\\max}(P) \\lVert x \\rVert_2^4 < 0$，则能保证条件 $\\dot{V}(x) < 0$ 成立。对于 $x \\ne 0$，这简化为 $2c\\lambda_{\\max}(P) \\lVert x \\rVert_2^2 < 1$，或 $\\lVert x \\rVert_2^2 < \\frac{1}{2c\\lambda_{\\max}(P)}$。\n\n我们需要找到 $\\rho$ 的一个上界 $\\rho_\\star$，使得对于子水平集 $\\{x \\mid V(x) \\le \\rho\\}$ 中的任意 $x$，条件 $\\dot{V}(x) < 0$ 都成立。对于此集合中的任意 $x$，我们有不等式 $V(x) \\ge \\lambda_{\\min}(P) \\lVert x \\rVert_2^2$，这意味着 $\\lVert x \\rVert_2^2 \\le \\frac{V(x)}{\\lambda_{\\min}(P)} \\le \\frac{\\rho}{\\lambda_{\\min}(P)}$。为使该子水平集中的所有 $x$ 都满足负定性条件，我们要求其边界位于保证负定性的区域内。我们施加严格不等式：\n$$\n\\frac{\\rho}{\\lambda_{\\min}(P)} < \\frac{1}{2c\\lambda_{\\max}(P)} \\implies \\rho < \\frac{\\lambda_{\\min}(P)}{2c\\lambda_{\\max}(P)}.\n$$\n这给出了所求的显式上界 $\\rho_\\star = \\frac{\\lambda_{\\min}(P)}{2c\\lambda_{\\max}(P)}$。$P$ 的特征值可从特征方程 $4\\lambda^2 - 6\\lambda + 1 = 0$ 求得，解出 $\\lambda = \\frac{3 \\pm \\sqrt{5}}{4}$。因此，$\\lambda_{\\min}(P) = \\frac{3-\\sqrt{5}}{4}$ 且 $\\lambda_{\\max}(P) = \\frac{3+\\sqrt{5}}{4}$。\n该界为 $\\rho_\\star = \\frac{(3-\\sqrt{5})/4}{2c(3+\\sqrt{5})/4} = \\frac{3-\\sqrt{5}}{2c(3+\\sqrt{5})} = \\frac{(3-\\sqrt{5})^2}{2c(9-5)} = \\frac{14 - 6\\sqrt{5}}{8c} = \\frac{7 - 3\\sqrt{5}}{4c}$。\n\n对于数值实验，我们在椭圆 $x^\\top P x = \\rho$ 上生成初始条件。该椭圆上的一个点 $x$ 可以通过线性变换从一个半径为 $\\sqrt{\\rho}$ 的圆上的点 $y$ 生成。设 $P=LL^\\top$ 为 $P$ 的乔列斯基分解。则 $x^\\top P x = x^\\top L L^\\top x = (L^\\top x)^\\top (L^\\top x) = \\lVert L^\\top x \\rVert_2^2 = \\rho$。我们定义 $y = L^\\top x$，使得 $\\lVert y \\rVert_2 = \\sqrt{\\rho}$。变换为 $x = (L^\\top)^{-1}y$。我们将对 $k=0, \\dots, N-1$，以 $\\theta_k = 2\\pi k/N$ 采样 $N=24$ 个点 $y_k = \\sqrt{\\rho} [\\cos \\theta_k, \\sin \\theta_k]^\\top$，并将它们转换为用于数值积分的初始条件 $x_k$。\n\n对每个 $x_k$ 的 $\\dot{x}=f(x)$ 模拟将在时间范围 $T=20$ 内使用具有指定容差的数值积分器进行。如果轨迹进入原点周围半径为 $10^{-3}$ 的小球内，则声明为收敛。如果轨迹范数超过 $10$，则声明为发散。如果从椭圆 $V(x) = \\rho = s \\rho_\\star$ 上的初始条件出发的所有 $N=24$ 条轨迹都收敛，则该测试用例成功。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to run the specified numerical experiment and print results.\n    \"\"\"\n    # Define test cases: ((c1, c2, c3, c4), s)\n    test_cases = [\n        ((0.5, 0.5, 0.5, 0.5), 0.5),\n        ((1.0, 1.0, 1.0, 1.0), 0.99),\n        ((2.0, 2.0, 2.0, 2.0), 20.0),\n    ]\n\n    results = []\n    for c_coeffs, s in test_cases:\n        results.append(run_experiment(c_coeffs, s))\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_experiment(c_coeffs, s_factor):\n    \"\"\"\n    Computes the theoretical bound rho_star, sets up the simulation radius rho,\n    and runs the simulation for N initial conditions.\n\n    Returns:\n        bool: True if all trajectories converge, False otherwise.\n    \"\"\"\n    # --- Theoretical Analysis ---\n    # Matrix A\n    A = np.array([[0, 1], [-2, -3]])\n    \n    # Solution P to A^T P + P A = -I\n    P = np.array([[5/4, 1/4], [1/4, 1/4]])\n    \n    # Constant c for the bound on g(x)\n    c1, c2, c3, c4 = c_coeffs\n    c = np.sqrt((abs(c1) + abs(c2))**2 + (abs(c3) + abs(c4))**2)\n    \n    # Theoretical bound rho_star\n    rho_star = (7 - 3 * np.sqrt(5)) / (4 * c)\n    \n    # Simulation level set parameter rho\n    rho = s_factor * rho_star\n\n    # --- Numerical Experiment ---\n    N_samples = 24\n    time_horizon = 20.0\n    \n    # Transformation matrix to map circle to ellipse V(x)=rho\n    # P = L L^T, x = (L^T)^-1 y\n    # L_inv_T = inv(L.T) where L is the Cholesky factor of P\n    L = np.linalg.cholesky(P)\n    L_inv_T = np.linalg.inv(L.T)\n    \n    # Generate initial conditions on the ellipse x^T P x = rho\n    thetas = np.linspace(0, 2 * np.pi, N_samples, endpoint=False)\n    radius = np.sqrt(rho)\n    y_coords = radius * np.vstack([np.cos(thetas), np.sin(thetas)])\n    initial_conditions = L_inv_T @ y_coords\n    \n    # --- Simulation Loop ---\n    all_converged = True\n    for i in range(N_samples):\n        x0 = initial_conditions[:, i]\n        converged = simulate_trajectory(A, c_coeffs, x0, time_horizon)\n        if not converged:\n            all_converged = False\n            break\n            \n    return all_converged\n\ndef simulate_trajectory(A, c_coeffs, x0, T):\n    \"\"\"\n    Integrates the ODE for one initial condition and checks for convergence.\n    \"\"\"\n    # Define the nonlinear system dynamics: dx/dt = f(x)\n    def ode_func(t, x, A_mat, coeffs):\n        c1, c2, c3, c4 = coeffs\n        gx = np.array([\n            c1 * x[0]**3 + c2 * x[0] * x[1]**2,\n            c3 * x[0]**2 * x[1] + c4 * x[1]**3\n        ])\n        return A_mat @ x + gx\n\n    # Event for numerical convergence\n    def convergence_event(t, x, A_mat, coeffs):\n        return np.linalg.norm(x) - 1e-3\n    convergence_event.terminal = True\n    convergence_event.direction = -1\n\n    # Event for numerical divergence\n    def divergence_event(t, x, A_mat, coeffs):\n        return np.linalg.norm(x) - 10.0\n    divergence_event.terminal = True\n    divergence_event.direction = 1\n\n    sol = solve_ivp(\n        fun=ode_func,\n        t_span=(0, T),\n        y0=x0,\n        method='RK45',\n        args=(A, c_coeffs),\n        rtol=1e-9,\n        atol=1e-12,\n        events=[convergence_event, divergence_event]\n    )\n    \n    # Check for convergence\n    # 1. Did the convergence event trigger?\n    if sol.t_events[0].size > 0:\n        return True\n    # 2. Did the simulation finish at T? Check final state norm.\n    if sol.status == 0 and np.linalg.norm(sol.y[:, -1]) = 1e-3:\n        return True\n    \n    # If neither of the above, it's considered not to have converged.\n    # This includes divergence event or finishing at T with norm > 1e-3.\n    return False\n\nif __name__ == '__main__':\n    # This block is for standalone execution and will not be called in the platform.\n    # It allows for local testing of the solution logic.\n    # The output format is handled by the solve() function as required.\n    solve()\n\n```", "id": "2721989"}]}