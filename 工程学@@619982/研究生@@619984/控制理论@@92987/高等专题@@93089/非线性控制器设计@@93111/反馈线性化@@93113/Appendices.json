{"hands_on_practices": [{"introduction": "在应用输入-输出线性化时，首要任务是确定系统的相对阶。相对阶不仅揭示了输入信号需要经过多少次积分才能影响输出，也决定了最终线性化系统的阶次。本练习将引导你通过计算李导数来确定一个非线性系统的相对阶，这是设计反馈线性化控制器的基础且关键的一步。[@problem_id:1575306]", "problem": "考虑一个由以下状态空间方程描述的非线性单输入单输出系统：\n$$\n\\begin{aligned}\n\\dot{x}_1 &= x_1 x_2 \\\\\n\\dot{x}_2 &= u\n\\end{aligned}\n$$\n此处，$x_1$和$x_2$表示系统的状态变量，$u$是控制输入。系统的输出定义为$y = x_1$。\n\n确定该系统关于指定输出$y$的相对阶。", "solution": "我们将系统写成控制仿射形式 $\\dot{x} = f(x) + g(x)u$，其输出为 $y = h(x)$：\n$$\nf(x) = \\begin{pmatrix} x_{1}x_{2} \\\\ 0 \\end{pmatrix}, \\quad g(x) = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad h(x) = x_{1}.\n$$\n某一点的相对阶 $r$ 是使 $L_{g}L_{f}^{r-1}h(x) \\neq 0$ 成立的最小正整数，其中 $L_{f}$ 和 $L_{g}$ 分别表示沿 $f$ 和 $g$ 的李导数。\n\n一阶李导数：\n$$\nL_{g}h(x) = \\frac{\\partial h}{\\partial x}g(x) = \\begin{pmatrix} 1 & 0 \\end{pmatrix}\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = 0,\n$$\n因此输入 $u$ 不出现在 $\\dot{y}$ 中，相对阶至少为 $2$。\n\n计算 $L_{f}h$：\n$$\nL_{f}h(x) = \\frac{\\partial h}{\\partial x}f(x) = \\begin{pmatrix} 1 & 0 \\end{pmatrix}\\begin{pmatrix} x_{1}x_{2} \\\\ 0 \\end{pmatrix} = x_{1}x_{2}.\n$$\n然后\n$$\nL_{g}L_{f}h(x) = \\frac{\\partial (x_{1}x_{2})}{\\partial x}g(x) = \\begin{pmatrix} x_{2} & x_{1} \\end{pmatrix}\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = x_{1}.\n$$\n因此，对于 $x_{1} \\neq 0$，有 $L_{g}L_{f}h(x) \\neq 0$，且输入出现在输出的二阶导数中，所以在集合 $\\{x \\mid x_{1} \\neq 0\\}$ 上相对阶为 $r=2$。\n\n等价地，通过直接微分，\n$$\n\\dot{y} = \\dot{x}_{1} = x_{1}x_{2}, \\quad \\ddot{y} = \\dot{x}_{1}x_{2} + x_{1}\\dot{x}_{2} = x_{1}x_{2}^{2} + x_{1}u,\n$$\n并且 $\\ddot{y}$ 中 $u$ 的系数是 $x_{1}$，这证实了当 $x_{1} \\neq 0$ 时相对阶为 $2$。在 $x_1=0$ 处，$L_g L_f^k h(x)$ 对所有 $k \\geq 1$ 均保持为零（可以发现 $L_g L_f^k h(x) = k x_1 x_2^{k-1}$），因此在该点相对阶没有明确定义。标准答案是 $r=2$（在 $x_1=0$ 之外）。", "answer": "$$\\boxed{2}$$", "id": "1575306"}, {"introduction": "在确定了系统的相对阶之后，我们便可以着手设计能够实现线性化的状态反馈控制器。其核心思想是构建一个形式为 $u = \\alpha(x) + \\beta(x)v$ 的控制律，用以精确抵消系统的非线性项，从而将复杂的输入-输出关系转化为一个简单的线性积分链。通过这个练习，你将亲手推导出实现输入-输出线性化的具体控制函数 $\\alpha(x)$ 与 $\\beta(x)$。[@problem_id:1575256]", "problem": "考虑一个在连续搅拌釜反应器内进行的化学过程的简化模型。系统状态由两个变量描述：产物浓度 $x_1(t)$ 和反应器温度 $x_2(t)$。这些状态的演化由以下非线性微分方程组描述：\n$$\n\\begin{aligned}\n\\dot{x}_1 &= x_2^2 \\\\\n\\dot{x}_2 &= u\n\\end{aligned}\n$$\n此处，状态向量为 $x = [x_1, x_2]^T$，$u(t)$ 是控制输入，代表施加到反应器上的加热或冷却速率。我们感兴趣并希望控制的输出是产物浓度，定义为 $y = x_1$。\n\n目标是设计一个形式为 $u = \\alpha(x) + \\beta(x)v$ 的状态反馈控制律。在此表达式中，$v$ 是一个新的外部指令输入，而 $\\alpha(x)$ 和 $\\beta(x)$ 是状态向量 $x$ 的函数。该控制器的目的是使系统的输入-输出行为线性化。具体来说，新输入 $v$ 和输出 $y$ 之间的关系必须由简单的二阶线性动力学 $\\ddot{y} = v$ 描述。\n\n确定能实现此输入-输出线性化的函数 $\\alpha(x)$ 和 $\\beta(x)$ 的表达式。最终答案应以函数对的形式呈现，其中 $\\alpha(x)$ 为第一个元素，$\\beta(x)$ 为第二个元素。", "solution": "我们的目标是实现输入-输出线性化，使得在形式为 $u=\\alpha(x)+\\beta(x)v$ 的反馈下，输出 $y=x_1$ 满足 $\\ddot{y}=v$。\n\n给定系统\n$$\n\\dot{x}_{1}=x_{2}^{2}, \\qquad \\dot{x}_{2}=u,\n$$\n及输出 $y=h(x)=x_1$，我们计算 $y$ 的逐次时间导数。\n\n一阶导数：\n$$\n\\dot{y}=\\dot{x}_{1}=x_{2}^{2}.\n$$\n\n二阶导数：\n$$\n\\ddot{y}=\\frac{d}{dt}\\left(x_{2}^{2}\\right)=2x_{2}\\dot{x}_{2}=2x_{2}u.\n$$\n\n这表明在 $x_2 \\neq 0$ 的区域，系统的相对阶为二。在标准的输入-输出线性化形式\n$$\n\\ddot{y}=L_{f}^{2}h(x)+L_{g}L_{f}h(x)\\,u,\n$$\n中，我们可得\n$$\nL_{f}h=x_{2}^{2}, \\quad \\nabla(L_{f}h)=[0,\\;2x_{2}], \\quad f(x)=\\begin{bmatrix}x_{2}^{2}\\\\ 0\\end{bmatrix}, \\quad g(x)=\\begin{bmatrix}0\\\\ 1\\end{bmatrix},\n$$\n所以\n$$\nL_{f}^{2}h=\\nabla(L_{f}h)\\cdot f=[0,\\;2x_{2}]\\begin{bmatrix}x_{2}^{2}\\\\ 0\\end{bmatrix}=0, \\qquad L_{g}L_{f}h=\\nabla(L_{f}h)\\cdot g=[0,\\;2x_{2}]\\begin{bmatrix}0\\\\ 1\\end{bmatrix}=2x_{2}.\n$$\n\n为强制使 $\\ddot{y}=v$ 成立，我们选择 $u$ 为\n$$\nu=\\frac{v-L_{f}^{2}h}{L_{g}L_{f}h}=\\frac{v-0}{2x_{2}}=\\frac{v}{2x_{2}}.\n$$\n这符合 $u=\\alpha(x)+\\beta(x)v$ 的形式，其中\n$$\n\\alpha(x)=0, \\qquad \\beta(x)=\\frac{1}{2x_{2}},\n$$\n在 $x_2 \\neq 0$ 的定义域内有效。", "answer": "$$\\boxed{\\begin{pmatrix} 0 & \\frac{1}{2 x_{2}} \\end{pmatrix}}$$", "id": "1575256"}, {"introduction": "本练习是一个综合性问题，旨在将前面学到的概念融会贯通，并引入反馈线性化理论中的一个核心工具——Byrnes-Isidori 标准型。通过执行一个恰当的坐标变换，我们可以将一个非线性系统分解为一个外部可控的线性子系统和一个内部动态子系统。这个过程不仅能让我们设计出反馈控制器，更能深刻揭示系统在状态空间中的几何结构，并判断是否存在影响系统稳定性的内部动态。[@problem_id:2707935]", "problem": "考虑一个单输入、单输出的非线性系统，其状态为 $x=\\begin{pmatrix}x_1 & x_2\\end{pmatrix}^{\\top}$，输出为 $y$，由下式给出：\n$$\\dot{x}_1 = x_2,\\quad \\dot{x}_2 = -x_1 + x_2^3 + u,\\quad y = x_1。$$\n仅从李导数、向量场、相对阶和微分同胚的基本定义出发，完成以下任务：\n1. 通过对输出沿漂移和输入向量场求取逐次李导数，构造 Byrnes–Isidori 坐标。明确写出坐标变换，并验证其在关心域上是一个局部微分同胚。\n2. 确定相对阶，并在所构造的坐标下将系统写成标准型，辨识其外部动态（积分器链）和任何内部动态。如果存在内部动态，请明确说明其维数和显式方程。\n3. 设计一个形式为 $u=\\alpha(x)+\\beta(x)\\,v$ 的静态状态反馈，以实现输入-输出线性化，并使线性化输入 $v$ 具有单位高频增益。将最终的反馈 $u(x,v)$ 表示为闭式解析表达式。\n\n不需要进行数值近似。最终答案仅报告 $u(x,v)$ 的解析表达式。不包括单位。如果您发现存在内部动态，可以在推导中讨论其性质，但最终报告的答案必须是 $u(x,v)$。", "solution": "该问题陈述已经过验证，被认定为具有科学依据、提法恰当且客观。它代表了非线性控制理论领域中的一个标准问题，特别是关于反馈线性化。所有必需信息均已提供，问题无矛盾或歧义。因此，我们可以进行严谨的求解。\n\n该系统由以下状态方程给出：\n$$ \\dot{x}_1 = x_2 $$\n$$ \\dot{x}_2 = -x_1 + x_2^3 + u $$\n其状态向量为 $x = \\begin{pmatrix} x_1 & x_2 \\end{pmatrix}^{\\top}$，输出为 $y = x_1$。该系统是单输入单输出（SISO）仿射形式 $\\dot{x} = f(x) + g(x)u$，其中漂移向量场 $f(x)$、输入向量场 $g(x)$ 和输出函数 $h(x)$ 可确定为：\n$$ f(x) = \\begin{pmatrix} x_2 \\\\ -x_1 + x_2^3 \\end{pmatrix}, \\quad g(x) = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad h(x) = x_1 $$\n状态维数为 $n=2$。\n\n为执行反馈线性化，我们必须首先确定系统的相对阶。相对阶 $r$ 是输出 $y=h(x)$ 对时间求导，直到输入 $u$ 显式出现的次数。这可以通过计算 $h(x)$ 沿向量场 $f(x)$ 和 $g(x)$ 的逐次李导数来找到。标量场 $\\phi(x)$ 沿向量场 $V(x)$ 的李导数定义为 $L_V \\phi(x) = \\frac{\\partial \\phi}{\\partial x} V(x)$，其中 $\\frac{\\partial \\phi}{\\partial x}$ 是 $\\phi$ 的梯度。\n\n输出 $y$ 的一阶时间导数为：\n$$ \\dot{y} = \\frac{d}{dt}h(x) = \\frac{\\partial h}{\\partial x} \\dot{x} = \\frac{\\partial h}{\\partial x} (f(x) + g(x)u) = L_f h(x) + L_g h(x) u $$\n我们计算必要的李导数。$h(x)$ 的梯度为 $\\frac{\\partial h}{\\partial x} = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$。\n$$ L_g h(x) = \\frac{\\partial h}{\\partial x} g(x) = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = 0 $$\n由于 $L_g h(x) = 0$，输入 $u$ 未出现在 $y$ 的一阶导数中。相对阶必须大于 $1$。$\\dot{y}$ 的表达式简化为：\n$$ \\dot{y} = L_f h(x) = \\frac{\\partial h}{\\partial x} f(x) = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} x_2 \\\\ -x_1 + x_2^3 \\end{pmatrix} = x_2 $$\n\n我们继续求输出的二阶时间导数：\n$$ \\ddot{y} = \\frac{d}{dt} (L_f h(x)) = \\frac{\\partial(L_f h(x))}{\\partial x} \\dot{x} = \\frac{\\partial(L_f h(x))}{\\partial x} (f(x) + g(x)u) = L_f^2 h(x) + L_g L_f h(x) u $$\n这里，$L_f^2 h(x)$ 表示 $L_f(L_f h(x))$，$L_g L_f h(x)$ 表示 $L_g(L_f h(x))$。我们已知 $L_f h(x) = x_2$。\n其梯度为 $\\frac{\\partial(L_f h(x))}{\\partial x} = \\frac{\\partial(x_2)}{\\partial x} = \\begin{pmatrix} 0 & 1 \\end{pmatrix}$。\n现在我们计算二阶项的李导数：\n$$ L_f^2 h(x) = \\frac{\\partial(L_f h(x))}{\\partial x} f(x) = \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\begin{pmatrix} x_2 \\\\ -x_1 + x_2^3 \\end{pmatrix} = -x_1 + x_2^3 $$\n$$ L_g L_f h(x) = \\frac{\\partial(L_f h(x))}{\\partial x} g(x) = \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = 1 $$\n由于 $L_g L_f h(x) = 1 \\neq 0$，输入 $u$ 出现在 $y$ 的二阶导数中。因此，系统的相对阶为 $r=2$。\n\n第一个任务是构造 Byrnes–Isidori 坐标。对于相对阶为 $r$ 的系统，变换 $z = \\Phi(x)$ 的前 $r$ 个坐标由 $h(x)$ 的逐次李导数给出：\n$$ z_1 = \\phi_1(x) = h(x) = x_1 $$\n$$ z_2 = \\phi_2(x) = L_f h(x) = x_2 $$\n因此，坐标变换为 $z = \\Phi(x) = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$。这是一个恒等变换。为验证其为局部微分同胚，我们计算其雅可比矩阵：\n$$ J_{\\Phi}(x) = \\frac{\\partial \\Phi}{\\partial x} = \\begin{pmatrix} \\frac{\\partial z_1}{\\partial x_1} & \\frac{\\partial z_1}{\\partial x_2} \\\\ \\frac{\\partial z_2}{\\partial x_1} & \\frac{\\partial z_2}{\\partial x_2} \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} $$\n雅可比矩阵的行列式为 $\\det(J_{\\Phi}(x)) = 1$，对所有 $x \\in \\mathbb{R}^2$ 均非零。因此，该变换是一个全局微分同胚。\n\n第二个任务是确定相对阶，将系统写成标准型，并讨论内部动态。\n如前所定，相对阶为 $r=2$。状态维数为 $n=2$。由于 $r=n$，该系统是完全状态线性化的，不存在内部动态。内部动态的维数为 $n-r=2-2=0$。\n系统在新坐标 $z = (z_1, z_2)^{\\top}$ 下的动态构成了标准型。\n$$ \\dot{z}_1 = \\frac{d}{dt}(h(x)) = L_f h(x) = z_2 $$\n$$ \\dot{z}_2 = \\frac{d}{dt}(L_f h(x)) = L_f^2 h(x) + L_g L_f h(x) u $$\n代入我们求得的表达式：\n$$ \\dot{z}_1 = z_2 $$\n$$ \\dot{z}_2 = (-x_1 + x_2^3) + (1)u $$\n由于坐标变换是恒等变换（$z_1=x_1, z_2=x_2$），我们可以完全用 $z$ 来写出标准型：\n$$ \\dot{z}_1 = z_2 $$\n$$ \\dot{z}_2 = -z_1 + z_2^3 + u $$\n该系统仅由外部动态组成，形成一个受非线性项扰动的二重积分器链。\n\n第三个任务是设计一个静态状态反馈控制器 $u = \\alpha(x) + \\beta(x)v$ 以实现输入-输出线性化。目标是获得形式为 $y^{(r)} = v$ 的线性输入-输出响应，对于本系统即为 $\\ddot{y}=v$。$\\ddot{y}$ 的表达式为：\n$$ \\ddot{y} = L_f^2 h(x) + L_g L_f h(x) u = (-x_1 + x_2^3) + u $$\n令其等于新输入 $v$：\n$$ v = (-x_1 + x_2^3) + u $$\n求解控制输入 $u$ 可得反馈律：\n$$ u(x,v) = v - (-x_1 + x_2^3) = x_1 - x_2^3 + v $$\n该控制律的形式为 $u = \\alpha(x) + \\beta(x)v$，其中 $\\alpha(x) = x_1 - x_2^3$ 且 $\\beta(x) = 1$。抵消非线性项并为新输入设置增益的反馈律一般形式为 $u = \\frac{1}{L_gL_f^{r-1}h(x)}(-L_f^r h(x)+v)$。对于我们 $r=2$ 的系统，可得：\n$$ u = \\frac{1}{L_gL_f h(x)}(-L_f^2 h(x)+v) = \\frac{1}{1}(-(-x_1+x_2^3)+v) = x_1 - x_2^3 + v $$\n反馈后乘以 $v$ 的项为 $\\beta(x)L_gL_f h(x)=(1)(1)=1$，证实了对于线性化输入 $v$ 具有单位高频增益，符合要求。所得的闭环系统为 $\\ddot{y}=v$，表示一个二重积分器。\n\n因此，控制律的最终解析表达式为 $u(x,v) = x_1 - x_2^3 + v$。", "answer": "$$\\boxed{x_1 - x_2^{3} + v}$$", "id": "2707935"}]}