{"hands_on_practices": [{"introduction": "并非所有物理系统都天然无源。本练习将引导您处理一个存在“无源性缺口”的系统，并通过一个简单的输入缩放来恢复其无源性。您将从基本定义出发，推导出一个静态增益 $k$ 所需满足的条件，从而使系统变得无源 [@problem_id:2730776]。这个练习揭示了在将一个对象放入反馈回路之前，如何通过预补偿来塑造其能量特性的基本思想。", "problem": "考虑单输入单输出线性时不变系统\n$$\\dot{x} = -a\\,x + b\\,u,\\qquad y = x,$$\n其中常数 $a>0$ 且 $b>0$。假定系统关于标准供给率 $w(u,y) = y\\,u$ 满足无源性，即存在一个连续可微的储能函数 $V(x)$，使得沿系统轨迹\n$$\\dot{V}(x) \\le y\\,u.$$\n假设已知该系统存在无源性短缺 $\\nu<0$，其精确含义如下：高频输入增益比單位保功水平大 $-\\nu>0$，因此\n$$b = 1 - \\nu,\\qquad \\nu < 0.$$\n允许应用静态输入缩放 $u = k\\,v$（其中 $k>0$ 为标量常数），并评估从新输入 $v$ 到输出 $y$ 的映射关于相同供给率 $w(v,y) = y\\,v$ 的无源性。使用二次能量\n$$V(x) = \\tfrac{1}{2}x^{2}$$\n作为候选储能函数，从基本原理出发，推导出一个关于 $k$ 的充要不等式，以保证缩放后系统从 $v$ 到 $y$ 是无源的。在所有满足该不等式的 $k$ 中，确定其最大的允许正值 $k$ 的闭式解，表示为 $\\nu$ 的函数。\n\n请以 $\\nu$ 的单个闭式解析表达式形式给出最终答案（无需单位）。", "solution": "在尝试求解之前，将首先根据指定标准对问题进行验证。\n\n步骤 1：提取已知条件\n已知信息如下：\n- 系统动力学：$\\dot{x} = -a\\,x + b\\,u$\n- 输出方程：$y = x$\n- 常数：$a>0$，$b>0$\n- 无源性定义：关于供给率 $w(u,y) = y\\,u$，存在一个连续可微的储能函数 $V(x)$，使得沿系统轨迹，$\\dot{V}(x) \\le y\\,u$。\n- 无源性短缺定义：$b = 1 - \\nu$，其中 $\\nu < 0$。这意味着 $b > 1$。\n- 控制律（输入缩放）：$u = k\\,v$，其中 $k>0$ 为标量常数。\n- 新系统映射：从输入 $v$到输出 $y$。\n- 新供给率：$w(v,y) = y\\,v$。\n- 候选储能函数：$V(x) = \\tfrac{1}{2}x^{2}$。\n- 任务 1：使用指定的储能函数，推导一个关于 $k$ 的充要不等式，以保证缩放后系统从 $v$ 到 $y$ 的无源性。\n- 任务 2：确定最大的允许正值 $k$，表示为 $\\nu$ 的函数。\n\n步骤 2：使用提取的已知条件进行验证\n该问题在科学上基于线性时不变（LTI）系统理论和无源性概念，这些都是控制理论中的基本课题。该系统描述是一个标准的一阶模型。无源性的定义、指定的储能函数以及输入缩放都是良定义的数学概念。问题是客观的，所有术语都经过了形式化定义或在该领域是标准的。已知条件是自洽且不矛盾的。关于“无源性短缺”和“高频输入增益”的措辞虽然不常规，但通过方程 $b = 1 - \\nu$ 赋予了精确的数学意义，该方程作为参数 $b$ 以 $\\nu$ 表示的定义。该问题是适定的，因为它寻求一个参数 $k$ 满足特定属性的条件。因此，该问题被认定为有效。\n\n步骤 3：结论与行动\n该问题有效。将提供一个完整的、有理有据的解答。\n\n原始系统由状态空间方程给出：\n$$ \\dot{x} = -a\\,x + b\\,u $$\n$$ y = x $$\n应用静态输入缩放 $u = k\\,v$，其中 $k>0$ 是一个恒定增益，$v$ 是新输入。将此代入状态方程，得到缩放后系统的动力学：\n$$ \\dot{x} = -a\\,x + b(k\\,v) = -a\\,x + (bk)v $$\n输出仍然是 $y=x$。我们的任务是评估从输入 $v$ 到输出 $y$ 的映射的无源性。无源性的定义要求存在一个储能函数 $V(x)$，使其时间导数沿系统轨迹满足 $\\dot{V} \\le yv$。问题明确要求使用候选储能函数 $V(x) = \\tfrac{1}{2}x^{2}$。\n\n首先，我们计算指定储能函数 $V(x)$ 沿缩放后系统轨迹的时间导数：\n$$ \\dot{V}(x) = \\frac{d}{dt}\\left(\\frac{1}{2}x^2\\right) = x\\dot{x} $$\n代入 $\\dot{x}$ 的表达式：\n$$ \\dot{V}(x) = x(-a\\,x + bkv) = -ax^2 + bkxv $$\n无源性条件为 $\\dot{V} \\le yv$。由于 $y=x$，该条件变为：\n$$ -ax^2 + bkxv \\le xv $$\n要使系统对于给定的储能函数是无源的，此不等式必须成立。整理各项，我们得到关于 $k$ 的充要条件：\n$$ ax^2 + (1 - bk)xv \\ge 0 $$\n该不等式必须对任意输入信号 $v(t)$ 及其对应的状态轨迹 $x(t)$ 成立。对于如此一个可控系统，这等价于该不等式对所有实数对 $(x, v) \\in \\mathbb{R}^2$ 成立。\n\n表达式 $f(x,v) = ax^2 + (1-bk)xv$ 是关于变量 $x$ 和 $v$ 的二次型。我们可以用一个对称矩阵 $Q$ 来表示该二次型，使得 $f(x,v) = \\begin{pmatrix} x & v \\end{pmatrix} Q \\begin{pmatrix} x \\\\ v \\end{pmatrix}$。矩阵 $Q$ 为：\n$$ Q = \\begin{pmatrix} a & \\frac{1-bk}{2} \\\\ \\frac{1-bk}{2} & 0 \\end{pmatrix} $$\n条件 $f(x,v) \\ge 0$对所有 $(x,v)$ 成立，要求矩阵 $Q$ 是半正定的。根据 $2 \\times 2$ 矩阵的 Sylvester 判据，这要求 $Q$ 的所有顺序主子式为非负。\n1. 第一个顺序主子式是左上角元素 $a$。已知 $a>0$，所以此条件满足。\n2. 第二个顺序主子式是 $Q$ 的行列式。\n$$ \\det(Q) = (a)(0) - \\left(\\frac{1-bk}{2}\\right)^2 = -\\frac{(1-bk)^2}{4} $$\n为使 $Q$ 是半正定的，必须有 $\\det(Q) \\ge 0$。\n$$ -\\frac{(1-bk)^2}{4} \\ge 0 $$\n由于 $(1-bk)^2$ 是一个实数的平方，它总是非负的。因此，表达式 $-\\frac{(1-bk)^2}{4}$ 总是非正的。它满足条件 $\\ge 0$ 的唯一方式是它恰好为零。\n$$ (1-bk)^2 = 0 $$\n这意味着：\n$$ 1 - bk = 0 $$\n这得到了 $k$ 的唯一值：\n$$ k = \\frac{1}{b} $$\n问题要求一个“关于 $k$ 的充要不等式”。推导出的条件 $k=1/b$ 既是必要的也是充分的。这可以被看作是一个不等式的极限情况，定义了一个只包含单个点的允许 $k$ 值集合。\n\n问题接着要求最大的允许正值 $k$。由于 $k$ 的允许值集合是单元素集 $\\{\\frac{1}{b}\\}$，最大值显然是 $\\frac{1}{b}$。\n\n已知 $b = 1 - \\nu$，其中 $\\nu < 0$。将此代入我们关于 $k$ 的表达式中：\n$$ k = \\frac{1}{1-\\nu} $$\n因为 $\\nu < 0$，分母 $1-\\nu$ 大于 $1$，这确保了 $k$ 为正值，符合题目要求（$k>0$）。\n\n因此，保证缩放后系统对于指定储能函数具有无源性的最大（也是唯一）允许值 $k$ 为 $\\frac{1}{1-\\nu}$。", "answer": "$$ \\boxed{\\frac{1}{1-\\nu}} $$", "id": "2730776"}, {"introduction": "在了解了单个系统的无源性之后，本练习将带您领略基于无源性控制中最强大的工具之一——无源性定理。您将分析一个由非无源子系统和输入严格无源子系统组成的负反馈回路 [@problem_id:2730773]。通过这个实践，您将亲手证明一个组件的“过剩无源性”如何能够补偿另一个组件的“无源性缺口”，从而保证整个互联系统的稳定性，这是利用无源性进行鲁棒控制设计的核心。", "problem": "考虑两个有限维、因果、时不变的输入-输出系统 $\\Sigma_1$ 和 $\\Sigma_2$，其输入-输出对分别为 $(u_1, y_1)$ 和 $(u_2, y_2)$。假设存在连续可微的非负存储函数 $S_1(x_1)$ 和 $S_2(x_2)$，使得对于所有 $t \\ge 0$ 和所有轨迹，以下耗散不等式成立：\n1) 系统 $\\Sigma_1$ 具有在其输出上测量的无源性短缺 $\\nu \\ge 0$，即\n$$\n\\dot{S}_1 \\le u_1^{\\top} y_1 + \\nu\\, y_1^{\\top} y_1.\n$$\n2) 系统 $\\Sigma_2$ 具有在其输入上测量的无源性裕度 $\\rho \\ge 0$（即，它是输入严格无源的，指数为 $\\rho$），即\n$$\n\\dot{S}_2 \\le u_2^{\\top} y_2 - \\rho\\, u_2^{\\top} u_2.\n$$\n这两个系统以负反馈形式互连，并带有一个外部输入 $r$，其连接方式如下\n$$\nu_1 = r - y_2, \\qquad u_2 = y_1.\n$$\n在基于无源性的控制（Passivity-Based Control, PBC）框架内，仅使用上述基本耗散不等式和无源性的定义，推导出一个形如\n$$\n\\dot{S} \\le r^{\\top} y_1 - \\mu\\, y_1^{\\top} y_1,\n$$\n的闭环存储不等式，其中复合存储函数为 $S \\triangleq S_1 + S_2$，而 $\\mu$ 是无源性短缺 $\\nu$ 和无源性裕度 $\\rho$ 的标量函数。将 $\\mu$ 解释为从 $r$ 到 $y_1$ 的闭环映射的输入严格性裕度，即闭环系统是无源的当且仅当 $\\mu \\ge 0$，是输入严格无源的当且仅当 $\\mu > 0$。\n\n你的任务是，用 $\\nu$ 和 $\\rho$ 计算出 $\\mu$ 的闭式解析表达式。只需提供 $\\mu$ 的表达式。不需要进行数值计算。将最终答案表示为符号表达式。", "solution": "问题在于确定系数 $\\mu$ 的表达式，该系数表征了由两个系统 $\\Sigma_1$ 和 $\\Sigma_2$ 负反馈互连构成的闭环系统的无源性特性。闭环系统动力学需要通过一个涉及复合存储函数 $S$ 的耗散不等式来描述。\n\n我们首先将互连系统的复合存储函数 $S$ 定义为各个存储函数之和：\n$$\nS \\triangleq S_1(x_1) + S_2(x_2).\n$$\n根据微分的求和法则，$S$ 的时间导数为\n$$\n\\dot{S} = \\frac{dS}{dt} = \\frac{dS_1}{dt} + \\frac{dS_2}{dt} = \\dot{S}_1 + \\dot{S}_2.\n$$\n问题给出了每个子系统的耗散不等式。对于系统 $\\Sigma_1$，它具有无源性短缺 $\\nu \\ge 0$，其不等式为：\n$$\n\\dot{S}_1 \\le u_1^{\\top} y_1 + \\nu\\, y_1^{\\top} y_1.\n$$\n对于系统 $\\Sigma_2$，它是输入严格无源的，具有无源性裕度 $\\rho \\ge 0$，其不等式为：\n$$\n\\dot{S}_2 \\le u_2^{\\top} y_2 - \\rho\\, u_2^{\\top} u_2.\n$$\n将这两个不等式代入 $\\dot{S}$ 的表达式中，得到复合存储函数变化率的一个上界：\n$$\n\\dot{S} \\le (u_1^{\\top} y_1 + \\nu\\, y_1^{\\top} y_1) + (u_2^{\\top} y_2 - \\rho\\, u_2^{\\top} u_2).\n$$\n重新整理各项，我们得到：\n$$\n\\dot{S} \\le u_1^{\\top} y_1 + u_2^{\\top} y_2 + \\nu\\, y_1^{\\top} y_1 - \\rho\\, u_2^{\\top} u_2.\n$$\n现在，我们必须引入负反馈配置的互连法则。这些法则由以下公式给出：\n$$\nu_1 = r - y_2, \\qquad u_2 = y_1.\n$$\n这里，$r$ 是闭环系统的外部输入。我们将 $u_1$ 和 $u_2$ 的这些表达式代入 $\\dot{S}$ 的不等式中：\n$$\n\\dot{S} \\le (r - y_2)^{\\top} y_1 + (y_1)^{\\top} y_2 + \\nu\\, y_1^{\\top} y_1 - \\rho\\, (y_1)^{\\top} y_1.\n$$\n我们展开项 $(r - y_2)^{\\top} y_1$：\n$$\n(r - y_2)^{\\top} y_1 = r^{\\top} y_1 - y_2^{\\top} y_1.\n$$\n$\\dot{S}$ 的不等式变为：\n$$\n\\dot{S} \\le r^{\\top} y_1 - y_2^{\\top} y_1 + y_1^{\\top} y_2 + \\nu\\, y_1^{\\top} y_1 - \\rho\\, y_1^{\\top} y_1.\n$$\n实向量的内积是标量，对于任何两个相同维度的向量 $a$ 和 $b$，$a^{\\top} b = b^{\\top} a$。因此，项 $y_1^{\\top} y_2$ 等于项 $y_2^{\\top} y_1$。中间两项相互抵消：\n$$\n-y_2^{\\top} y_1 + y_1^{\\top} y_2 = 0.\n$$\n不等式显著简化为：\n$$\n\\dot{S} \\le r^{\\top} y_1 + \\nu\\, y_1^{\\top} y_1 - \\rho\\, y_1^{\\top} y_1.\n$$\n我们可以合并关于 $y_1$ 的二次项：\n$$\n\\dot{S} \\le r^{\\top} y_1 - (\\rho - \\nu) y_1^{\\top} y_1.\n$$\n问题要求我们找到闭环系统的目标耗散不等式中的参数 $\\mu$，其形式如下：\n$$\n\\dot{S} \\le r^{\\top} y_1 - \\mu\\, y_1^{\\top} y_1.\n$$\n通过将推导出的不等式与目标形式直接比较，我们可以确定 $\\mu$ 的表达式。我们令 $y_1^{\\top} y_1$ 项的系数相等：\n$$\n-\\mu = -(\\rho - \\nu).\n$$\n由此，可以轻易得出结论：\n$$\n\\mu = \\rho - \\nu.\n$$\n这个结果与已有的无源性定理一致。从输入 $r$ 到输出 $y_1$ 的闭环系统是无源的，如果其输入严格性裕度 $\\mu$ 是非负的，即 $\\mu \\ge 0$。这要求 $\\rho - \\nu \\ge 0$，或 $\\rho \\ge \\nu$。这意味着 $\\Sigma_2$ 中的无源性裕度必须足以补偿 $\\Sigma_1$ 中的无源性短缺。正如所要求的，该推导仅依赖于所给定的不等式和定义。", "answer": "$$\\boxed{\\rho - \\nu}$$", "id": "2730773"}, {"introduction": "从分析转向设计，本练习将深入探讨基于无源性控制的构造性力量。您将不再仅仅检验无源性，而是主动设计一个控制器，通过“能量重塑”和“阻尼注入”来改变系统的动态特性，使其匹配一个理想的目标储能函数 $H_{d}(x)$ [@problem_id:2730752]。这种被称为互联和阻尼分配无源性控制（IDA-PBC）的方法，使我们能够系统地设计具有特定能量行为的控制器，仿佛在雕刻系统的能量地貌。", "problem": "考虑一个标量端口哈密顿系统，其状态为 $x \\in \\mathbb{R}$，储能（能量）函数为 $H(x) = \\tfrac{1}{2} a x^{2}$ (其中 $a \\in \\mathbb{R}_{>0}$)，动力学方程为\n$$\n\\dot{x} = - r \\, \\frac{dH}{dx}(x) + u, \\quad y = \\frac{dH}{dx}(x),\n$$\n其中 $r \\in \\mathbb{R}_{\\ge 0}$，输入为 $u \\in \\mathbb{R}$。要求你设计一个形式为 $u = \\alpha(x) + \\beta v$ 的基于无源性的控制（PBC）律，其中 $v \\in \\mathbb{R}$ 是一个外部输入，以使闭环系统相对于目标能量函数 $H_{d}(x) = \\tfrac{1}{2} k x^{2}$ (其中 $k \\in \\mathbb{R}_{>0}$) 从 $v$ 到输出 $y_{d}(x) = \\nabla H_{d}(x)$ 是无源的。仅使用无源性的基本定义（即存在一个非负储能函数 $S$ 使得 $\\dot{S} \\le y^{\\top} u$）和给定的模型；不要假设任何专门的公式。\n\n任务：\n- 推导 $\\alpha(x)$ 和 $\\beta$ 需满足的条件，以确保闭环系统以 $H_{d}(x)$ 为储能函数，从 $v$ 到 $y_{d}(x) = \\nabla H_{d}(x)$ 是无源的。\n- 然后，对于具体数值 $a = 3$, $r = 2$, $k = 5$ 和期望的闭环阻尼参数 $r_{d} = 4$，计算满足你所推导条件的 $\\alpha(x)$ 和 $\\beta$ 的显式表达式。\n\n将最终答案表示为一个按顺序包含 $\\alpha(x)$ 和 $\\beta$ 的行矩阵。无需四舍五入。无需单位。", "solution": "所述问题具有科学依据、是适定的、客观的，并包含获得唯一解的充分信息。这是基于无源性控制理论中的一个标准问题。因此，该问题是有效的，我们着手进行推导。\n\n目标是设计一个控制律 $u = \\alpha(x) + \\beta v$，使闭环系统相对于储能函数 $H_d(x) = \\frac{1}{2} k x^2$，从新输入 $v$ 到新输出 $y_d(x) = \\frac{dH_d}{dx}(x)$ 是无源的。无源性的基本定义要求存在一个非负储能函数 $S(x)$，使其时间导数 $\\dot{S}(x)$ 满足不等式 $\\dot{S}(x) \\le y_d(x) v$。问题明确给出了要使用的储能函数：$S(x) = H_d(x)$。由于 $k \\in \\mathbb{R}_{>0}$，对于所有 $x$，都有 $H_d(x) = \\frac{1}{2} k x^2 \\ge 0$，因此它是一个有效的非负储能函数。\n\n因此，核心要求是满足无源性不等式：\n$$\n\\frac{d}{dt} H_d(x) \\le y_d(x) v\n$$\n我们首先使用链式法则计算指定储能函数 $H_d(x)$ 的时间导数：\n$$\n\\dot{H}_d(x) = \\frac{dH_d}{dx}(x) \\dot{x}\n$$\n目标能量函数的导数为 $y_d(x) = \\frac{dH_d}{dx}(x) = \\frac{d}{dx}(\\frac{1}{2} k x^2) = kx$。因此，$\\dot{H}_d(x) = (kx)\\dot{x}$。\n\n接下来，我们建立闭环动力学。原始系统动力学为 $\\dot{x} = - r \\frac{dH}{dx}(x) + u$。代入控制律 $u = \\alpha(x) + \\beta v$ 可得：\n$$\n\\dot{x} = - r \\frac{dH}{dx}(x) + \\alpha(x) + \\beta v\n$$\n原始能量函数为 $H(x) = \\frac{1}{2} a x^2$，所以其导数为 $\\frac{dH}{dx}(x) = ax$。闭环动力学为：\n$$\n\\dot{x} = -rax + \\alpha(x) + \\beta v\n$$\n现在，我们将 $\\dot{x}$ 的这个表达式代入 $\\dot{H}_d(x)$ 的方程中：\n$$\n\\dot{H}_d(x) = (kx) \\left( -rax + \\alpha(x) + \\beta v \\right) = -rakx^2 + kx\\alpha(x) + kx\\beta v\n$$\n我们将此式代入无源性不等式 $\\dot{H}_d(x) \\le y_d(x) v$ 中：\n$$\n-rakx^2 + kx\\alpha(x) + kx\\beta v \\le (kx) v\n$$\n该不等式必须对所有 $x \\in \\mathbb{R}$ 和所有外部输入 $v \\in \\mathbb{R}$ 成立。我们重新整理各项，以分离出与 $v$ 相关的项：\n$$\n-rakx^2 + kx\\alpha(x) + (kx\\beta - kx) v \\le 0\n$$\n$$\n-rakx^2 + kx\\alpha(x) + kx(\\beta - 1) v \\le 0\n$$\n为使此不等式对任意选择的 $v \\in \\mathbb{R}$ 都成立，$v$ 的系数必须为零。如果系数不为零，人们总可以选择一个具有合适符号和大小的 $v$ 来违反该不等式。因此，我们必须有：\n$$\nkx(\\beta - 1) = 0\n$$\n由于这对所有 $x$ 均须成立，且 $k \\neq 0$，我们得出结论 $\\beta - 1 = 0$，从而得到条件 $\\beta = 1$。\n\n当 $\\beta = 1$ 时，无源性不等式简化为：\n$$\n-rakx^2 + kx\\alpha(x) \\le 0\n$$\n这是函数 $\\alpha(x)$ 必须满足的一般条件。问题要求基于期望的闭环阻尼参数 $r_d$ 设计一个特定的控制律。这引导我们使用互联和阻尼分配无源性控制（IDA-PBC）方法来构造性地选择 $\\alpha(x)$。我们的目标是塑造系统动力学，以匹配一个目标端口哈密顿结构。对于一个注入了阻尼 $r_d$ 的标量系统，其期望结构为：\n$$\n\\dot{x} = -r_d \\frac{dH_d}{dx} + v\n$$\n我们将我们的闭环动力学（当 $\\beta=1$ 时）与此目标动力学相等：\n$$\n-r \\frac{dH}{dx} + \\alpha(x) + v = -r_d \\frac{dH_d}{dx} + v\n$$\n通过比较各项，我们解出 $\\alpha(x)$：\n$$\n\\alpha(x) = r \\frac{dH}{dx} - r_d \\frac{dH_d}{dx}\n$$\n代入导数的表达式 $\\frac{dH}{dx} = ax$ 和 $\\frac{dH_d}{dx} = kx$：\n$$\n\\alpha(x) = r(ax) - r_d(kx) = (ra - r_d k)x\n$$\n我们必须验证这个对 $\\alpha(x)$ 的选择满足所需条件 $-rakx^2 + kx\\alpha(x) \\le 0$。代入我们得到的 $\\alpha(x)$ 的表达式：\n$$\n-rakx^2 + kx((ra - r_d k)x) = -rakx^2 + (ra)kx^2 - (r_d k)kx^2 = -rakx^2 + rakx^2 - r_d k^2 x^2 = -r_d k^2 x^2\n$$\n条件变为 $-r_d k^2 x^2 \\le 0$。鉴于 $r_d \\in \\mathbb{R}_{>0}$（因为它是一个指定了正值的阻尼参数）、$k \\in \\mathbb{R}_{>0}$ 且 $x^2 \\ge 0$，项 $-r_d k^2 x^2$ 总是非正的。因此，该条件得到满足，我们对 $\\alpha(x)$ 和 $\\beta$ 的选择是正确的。\n\n推导出的控制律为：\n$\\beta = 1$\n$\\alpha(x) = (ra - r_d k)x$\n\n最后，我们使用给定的数值 $a = 3$, $r = 2$, $k = 5$ 和 $r_d = 4$ 计算显式表达式。\n$$\n\\beta = 1\n$$\n$$\n\\alpha(x) = (2 \\cdot 3 - 4 \\cdot 5)x = (6 - 20)x = -14x\n$$\n控制律的分量为 $\\alpha(x) = -14x$ 和 $\\beta=1$。", "answer": "$$\n\\boxed{\\begin{pmatrix} -14x & 1 \\end{pmatrix}}\n$$", "id": "2730752"}]}