{"hands_on_practices": [{"introduction": "在应用互联与阻尼注入无源性控制（IDA-PBC）进行设计之前，我们必须首先理解其核心的数学约束。本练习将引导您剖析控制系统的基本匹配方程，通过将系统分解为受控和非受控部分，揭示施加在期望哈密顿函数 $H_d(x)$ 上的偏微分方程（PDE）约束。掌握这种分离是成功设计的第一步，因为它明确了哪些动态是必须通过求解PDE来匹配的，哪些动态是可以通过控制输入来塑造的 [@problem_id:2704627]。", "problem": "考虑一个控制仿射端口哈密顿系统，其状态为 $x \\in \\mathbb{R}^{n}$，输入为 $u \\in \\mathbb{R}^{m}$，具有光滑哈密顿量 $H:\\mathbb{R}^{n} \\to \\mathbb{R}$ 和互联阻尼矩阵 $F(x) = J(x) - R(x)$，其中 $J(x)^{\\top} = -J(x)$，$R(x) = R(x)^{\\top} \\succeq 0$。该系统的动力学为\n$$\n\\dot{x} = F(x)\\nabla H(x) + g(x)u.\n$$\n通过互联与阻尼分配的无源性控制（IDA-PBC）进行能量整形，旨在寻求一种期望的闭环形式\n$$\n\\dot{x} = F_{d}(x)\\nabla H_{d}(x),\n$$\n其中 $F_{d}(x) = J_{d}(x) - R_{d}(x)$，$J_{d}(x)^{\\top} = -J_{d}(x)$，$R_{d}(x) = R_{d}(x)^{\\top} \\succeq 0$，并且期望的哈密顿量 $H_{d}(x)$ 必须满足一组待定的匹配偏微分方程（PDEs）。\n\n假设状态被划分为 $x = (x_{a}, x_{u})$，其中 $x_{a} \\in \\mathbb{R}^{n_{a}}$ (驱动坐标)，$x_{u} \\in \\mathbb{R}^{n_{u}}$ (非驱动坐标)，且 $n = n_{a} + n_{u}$。假设驱动矩阵为\n$$\ng(x) = \\begin{bmatrix} I_{n_{a}} \\\\ 0_{n_{u}\\times n_{a}} \\end{bmatrix}.\n$$\n仅使用上述定义和控制输入 $u$ 只能影响驱动坐标的要求，从闭环等式\n$$\nF_{d}(x)\\nabla H_{d}(x) = F(x)\\nabla H(x) + g(x)u\n$$\n出发，并且：\n\n- 通过显式地分离驱动和非驱动分量来推导匹配条件，阐明哪些方程是对期望能量 $H_{d}(x)$ 的真正PDE约束，哪些方程可以通过控制输入 $u$ 来强制实现。\n- 指出如果将分离出的方程作为 $H_{d}(x)$ 的PDEs施加，哪一部分会是超定的，并解释原因。\n\n最后，使用 $g(x)$ 的一个具有满行秩和正交归一行的左零化子 $g^{\\perp}(x)$，将紧凑匹配条件表示为以下形式\n$$\ng^{\\perp}(x)\\big(F_{d}(x)\\nabla H_{d}(x) - F(x)\\nabla H(x)\\big) = 0,\n$$\n并作为最终答案，提供 $g^{\\perp}(x)$ 关于 $n_{a}$ 和 $n_{u}$ 的显式分块矩阵表达式。无需进行数值计算。你的最终答案必须是单一的解析表达式。不需要单位，也无需四舍五入。如果出现角度，请用弧度表示。", "solution": "首先对问题陈述进行验证。\n\n步骤1：提取已知条件。\n系统动力学由 $\\dot{x} = F(x)\\nabla H(x) + g(x)u$ 给出，其中 $x \\in \\mathbb{R}^{n}$ 是状态, $u \\in \\mathbb{R}^{m}$ 是输入, $H:\\mathbb{R}^{n} \\to \\mathbb{R}$ 是哈密顿量。矩阵 $F(x) = J(x) - R(x)$ 满足 $J(x)^{\\top} = -J(x)$ 和 $R(x) = R(x)^{\\top} \\succeq 0$。期望的闭环动力学为 $\\dot{x} = F_{d}(x)\\nabla H_{d}(x)$，具有期望的哈密顿量 $H_d(x)$ 和期望的结构矩阵 $F_d(x) = J_d(x) - R_d(x)$，其中 $J_{d}(x)^{\\top} = -J_{d}(x)$ 和 $R_{d}(x) = R_{d}(x)^{\\top} \\succeq 0$。状态被划分为 $x = (x_{a}, x_{u})$，其中 $x_{a} \\in \\mathbb{R}^{n_{a}}$ 和 $x_{u} \\in \\mathbb{R}^{n_{u}}$，且 $n = n_{a} + n_{u}$。驱动矩阵为 $g(x) = \\begin{bmatrix} I_{n_{a}} \\\\ 0_{n_{u}\\times n_{a}} \\end{bmatrix}$。闭环匹配必须满足 $F_{d}(x)\\nabla H_{d}(x) = F(x)\\nabla H(x) + g(x)u$。$g(x)$ 的一个左零化子 $g^{\\perp}(x)$ 被定义为具有满行秩和正交归一的行，从而导出紧凑条件 $g^{\\perp}(x)\\big(F_{d}(x)\\nabla H_{d}(x) - F(x)\\nabla H(x)\\big) = 0$。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据，植根于端口哈密顿系统和基于无源性的控制（IDA-PBC）的成熟理论。它是客观的，并使用该领域的标准、精确术语进行表述。问题是自洽的，为所需的推导提供了所有必要的定义和方程。$g(x)$ 的结构意味着 $m=n_a$，这是一致的。问题是适定的，因为它要求在给定约束下推导一个唯一定义的数学对象的显式表达式。不存在与清单项目对应的缺陷。\n\n步骤3：结论与行动。\n问题是有效的。将提供一个解答。\n\n推导从闭环等式开始：\n$$\nF_{d}(x)\\nabla H_{d}(x) = F(x)\\nabla H(x) + g(x)u\n$$\n为了在给定的状态划分 $x = (x_a, x_u)$ 下分析此方程，我们相应地对向量和矩阵进行分块。输入 $u$ 的维度是 $n_a$。梯度向量被划分为：\n$$\n\\nabla H(x) = \\begin{bmatrix} \\nabla_{x_a} H(x) \\\\ \\nabla_{x_u} H(x) \\end{bmatrix}, \\quad \\nabla H_d(x) = \\begin{bmatrix} \\nabla_{x_a} H_d(x) \\\\ \\nabla_{x_u} H_d(x) \\end{bmatrix}\n$$\n结构矩阵被划分为：\n$$\nF(x) = \\begin{bmatrix} F_{aa}(x) & F_{au}(x) \\\\ F_{ua}(x) & F_{uu}(x) \\end{bmatrix}, \\quad F_d(x) = \\begin{bmatrix} F_{d,aa}(x) & F_{d,au}(x) \\\\ F_{d,ua}(x) & F_{d,uu}(x) \\end{bmatrix}\n$$\n其中，例如，$F_{au}(x)$ 是一个大小为 $n_a \\times n_u$ 的矩阵。输入项为：\n$$\ng(x)u = \\begin{bmatrix} I_{n_{a}} \\\\ 0_{n_{u}\\times n_{a}} \\end{bmatrix} u = \\begin{bmatrix} u \\\\ 0_{n_u \\times 1} \\end{bmatrix}\n$$\n将这些分块形式代入主等式，得到：\n$$\n\\begin{bmatrix} F_{d,aa}(x) & F_{d,au}(x) \\\\ F_{d,ua}(x) & F_{d,uu}(x) \\end{bmatrix} \\begin{bmatrix} \\nabla_{x_a} H_d(x) \\\\ \\nabla_{x_u} H_d(x) \\end{bmatrix} = \\begin{bmatrix} F_{aa}(x) & F_{au}(x) \\\\ F_{ua}(x) & F_{uu}(x) \\end{bmatrix} \\begin{bmatrix} \\nabla_{x_a} H(x) \\\\ \\nabla_{x_u} H(x) \\end{bmatrix} + \\begin{bmatrix} u \\\\ 0 \\end{bmatrix}\n$$\n展开矩阵乘积，得到一个由两个分块方程组成的系统。\n\n第一个分块对应于驱动坐标 $x_a$：\n$$\nF_{d,aa}\\nabla_{x_a}H_d + F_{d,au}\\nabla_{x_u}H_d = F_{aa}\\nabla_{x_a}H + F_{au}\\nabla_{x_u}H + u\n$$\n第二个分块对应于非驱动坐标 $x_u$：\n$$\nF_{d,ua}\\nabla_{x_a}H_d + F_{d,uu}\\nabla_{x_u}H_d = F_{ua}\\nabla_{x_a}H + F_{uu}\\nabla_{x_u}H\n$$\n这两个方程代表了分离的匹配条件。\n\n第二个方程控制非驱动动力学，不包含控制输入 $u$。因此，它对期望的哈密顿量 $H_d(x)$ 和期望的互联矩阵 $F_d(x)$ 施加了一个结构性约束。该方程是一个包含 $n_u$ 个偏微分方程（PDEs）的系统，必须求解该系统以找到合适的 $H_d(x)$。这些是 IDA-PBC 问题中的**真正的PDE约束**。\n\n第一个方程控制驱动动力学，包含控制输入 $u$。这个方程不是对 $H_d(x)$ 的约束。相反，一旦选择了 $H_d(x)$ 和 $F_d(x)$ 来满足非驱动PDE约束和其他设计目标（例如，确保期望的平衡点是 $H_d$ 的一个极小值点），这个方程就可以被重新整理来定义状态反馈控制律：\n$$\nu = (F_{d,aa}\\nabla_{x_a}H_d + F_{d,au}\\nabla_{x_u}H_d) - (F_{aa}\\nabla_{x_a}H + F_{au}\\nabla_{x_u}H)\n$$\n根据构造，该控制律在驱动坐标上强制实现期望的动力学。\n\n如果将驱动和非驱动两个分块方程都作为单个标量函数 $H_d(x)$ 的PDEs来施加，系统将是超定的。驱动分块方程将增加 $n_a$ 个PDEs，导致 $H_d(x)$ 总共有 $n_a + n_u = n$ 个PDEs。单个标量场通常不能满足多于一个PDE的任意系统。系统是超定的，因为控制输入 $u$ 提供了 $n_a$ 个自由度，这些自由度恰好是为了满足驱动分块的 $n_a$ 个方程。将这些方程作为对 $H_d(x)$ 的约束，忽略了可用的控制权限，因此是一种不正确的表述。\n\n最后，我们推导紧凑匹配条件。我们寻找 $g(x)$ 的一个左零化子 $g^{\\perp}(x)$，它必须满足 $g^{\\perp}(x)g(x) = 0$。给定 $g(x) = \\begin{bmatrix} I_{n_a} \\\\ 0_{n_u \\times n_a} \\end{bmatrix}$，让我们将 $g^{\\perp}(x)$ 表示为兼容的分块形式 $g^{\\perp}(x) = \\begin{bmatrix} A & B \\end{bmatrix}$，其中 $A$ 是一个大小为 $k \\times n_a$ 的矩阵，B 是一个大小为 $k \\times n_u$ 的矩阵。零化条件是：\n$$\ng^{\\perp}(x)g(x) = \\begin{bmatrix} A & B \\end{bmatrix} \\begin{bmatrix} I_{n_a} \\\\ 0 \\end{bmatrix} = A I_{n_a} + B 0 = A = 0_{k \\times n_a}\n$$\n所以，$g^{\\perp}(x)$ 的形式必须为 $\\begin{bmatrix} 0_{k \\times n_a} & B \\end{bmatrix}$。问题指明 $g^{\\perp}(x)$ 具有满行秩，这意味着 $k = \\text{rank}(g^{\\perp}) = \\text{rank}(B)$。它还要求行是正交归一的，这意味着 $g^{\\perp}(x)(g^{\\perp}(x))^{\\top} = I_k$。\n$$\ng^{\\perp}(x)(g^{\\perp}(x))^{\\top} = \\begin{bmatrix} 0 & B \\end{bmatrix} \\begin{bmatrix} 0^{\\top} \\\\ B^{\\top} \\end{bmatrix} = B B^{\\top} = I_k\n$$\n这意味着 $B$ 是一个具有正交归一行的 $k \\times n_u$ 矩阵。$g(x)$ 的像是前 $n_a$ 个标准基向量生成的子空间。左零化子将向量投影到 $g(x)$ 的像的正交补上，这个正交补是由后 $n_u$ 个标准基向量生成的子空间。这个正交补的维数是 $n_u$。为了构成这个空间的基，我们必须有 $k = n_u$。一个大小为 $n_u \\times n_u$ 且满足 $BB^\\top = I_{n_u}$ 的矩阵 $B$ 是一个正交矩阵。对 $B$ 最简单的选择是单位矩阵，$B = I_{n_u}$。\n这给出了零化子的显式表达式：\n$$\ng^{\\perp}(x) = \\begin{bmatrix} 0_{n_u \\times n_a} & I_{n_u} \\end{bmatrix}\n$$\n这个矩阵是常数矩阵，并满足所有要求的性质。将其应用于重新整理后的闭环等式 $F_{d}\\nabla H_{d} - F\\nabla H = gu$，结果为：\n$$\ng^{\\perp}(F_{d}\\nabla H_{d} - F\\nabla H) = g^{\\perp}(gu) = (g^{\\perp}g)u = 0 u = 0\n$$\n这恰好得到了先前推导的非驱动PDE约束方程。这个零化子的具体表达式就是所要求的最终答案。", "answer": "$$\n\\boxed{\\begin{bmatrix}\n0_{n_{u} \\times n_{a}} & I_{n_{u}}\n\\end{bmatrix}}\n$$", "id": "2704627"}, {"introduction": "理解了基本的匹配条件后，我们便可以将注意力转向具体的设计任务。本练习展示了如何利用指定的互联矩阵 $J_d$ 和阻尼矩阵 $R_d$ 来精确塑造系统在平衡点附近的局部动态行为 [@problem_id:2704607]。您将学习如何首先设计一个无阻尼的系统以实现特定的振荡频率，然后通过注入阻尼来将其转变为一个渐近稳定的焦点，这是实现高性能控制器的关键实践步骤。", "problem": "考虑一个全驱动的二维系统，已对其应用互联与阻尼分配-基于无源性的控制（IDA-PBC）以施加闭环端口-哈密顿（pH）形式。闭环动力学为\n$$\n\\dot{x} = \\big(J_{d}(x)-R_{d}(x)\\big)\\,\\nabla H_{d}(x),\n$$\n其中 $x \\in \\mathbb{R}^{2}$，$J_{d}(x)$ 是一个斜对称互联矩阵，$R_{d}(x)$ 是一个半正定阻尼矩阵，而 $H_{d}(x)$ 是期望的哈密顿量。假设期望的平衡点位于 $x^{\\star}=\\mathbf{0}$，且期望的哈密顿量是二次型的，其海森矩阵为\n$$\n\\nabla^{2} H_{d}(0) = K = \\mathrm{diag}(k_{1},k_{2}), \\quad k_{1}>0,\\;k_{2}>0.\n$$\n假设 $J_{d}(x)$ 在 $x^{\\star}$ 的一个邻域内被选为常数，并初始设定 $R_{d}(x) \\equiv 0$。你的任务是塑造互联结构，使得在 $x^{\\star}$ 处的线性化系统是一个中心点，其具有预设的小幅振荡频率 $\\omega_{0}>0$。\n\n1. 仅使用哈密顿矢量场和线性化的基本性质，构造一个显式的常数斜对称矩阵 $J_{d}$，使得当 $R_{d}\\equiv 0$ 时，在 $x^{\\star}$ 处的线性化系统是一个中心点，具有纯虚数特征值 $\\pm \\mathrm{j}\\,\\omega_{0}$。\n\n2. 接着，加入各向同性阻尼 $R_{d}(x)\\equiv r I_{2}$（其中 $r>0$），通过计算线性化系统，确定阻尼闭环系统的特征值。解释在何种关于 $r$ 的条件下，平衡点从中心点转变为渐近稳定焦点。\n\n请以你在第1项中构造的 $J_{d}$ 的显式解析表达式作为最终答案。无需数值代入，也无需四舍五入。最终答案中不应包含单位。", "solution": "所给出的问题是控制理论中的一个标准练习，具体在端口-哈密顿系统的互联与阻尼分配-基于无源性的控制（IDA-PBC）框架下。该问题具有科学依据，提法恰当，并包含了所有必要信息。因此，我们开始求解。\n\n闭环动力学由以下方程给出：\n$$\n\\dot{x} = \\big(J_{d}(x)-R_{d}(x)\\big)\\,\\nabla H_{d}(x)\n$$\n期望的平衡点位于 $x^{\\star}=\\mathbf{0}$。为了使平衡点存在于此点，必须满足 $\\dot{x}|_{x=\\mathbf{0}} = \\mathbf{0}$。由于 $H_d(x)$ 在稳定平衡点 $x^{\\star}$ 处取最小值，我们必须有 $\\nabla H_d(\\mathbf{0}) = \\mathbf{0}$。因此，$H_d(x)$ 在 $x^{\\star}=\\mathbf{0}$ 附近的泰勒展开为 $H_d(x) = H_d(\\mathbf{0}) + \\frac{1}{2}x^T \\nabla^2 H_d(\\mathbf{0}) x + \\mathcal{O}(\\|x\\|^3)$。设定势能基准 $H_d(\\mathbf{0})=0$，并使用给定的海森矩阵 $\\nabla^2 H_d(\\mathbf{0}) = K$，对于小的 $x$，我们有 $H_d(x) = \\frac{1}{2}x^T K x$。其梯度则为 $\\nabla H_d(x) = Kx + \\mathcal{O}(\\|x\\|^2)$。\n\n该问题分为两部分。\n\n第1部分：互联矩阵 $J_d$ 的构造。\n\n我们的任务是找到一个常数斜对称矩阵 $J_d$，使得无阻尼系统（$R_d(x) \\equiv 0$）在原点的线性化系统是一个中心点，其振荡频率为 $\\omega_0$。无阻尼系统为：\n$$\n\\dot{x} = J_d(x) \\nabla H_d(x)\n$$\n为了分析平衡点 $x^{\\star} = \\mathbf{0}$ 附近的局部行为，我们对系统进行线性化。令 $f(x) = J_d(x) \\nabla H_d(x)$。线性化系统 $\\dot{\\delta x} = A \\delta x$ 的矩阵是 $f(x)$ 在 $x = \\mathbf{0}$ 处计算的雅可比矩阵：\n$$\nA = \\frac{\\partial f}{\\partial x}\\bigg|_{x=\\mathbf{0}} = \\left. \\frac{\\partial}{\\partial x} \\big(J_d(x) \\nabla H_d(x)\\big) \\right|_{x=\\mathbf{0}}\n$$\n已知 $J_d(x)$ 被选为常数矩阵 $J_d$，且 $\\nabla H_d(\\mathbf{0}) = \\mathbf{0}$，根据求导的乘积法则可得：\n$$\nA = \\left( \\frac{\\partial J_d(x)}{\\partial x} \\nabla H_d(x) \\right)\\bigg|_{x=\\mathbf{0}} + J_d(\\mathbf{0}) \\left( \\frac{\\partial \\nabla H_d(x)}{\\partial x} \\right)\\bigg|_{x=\\mathbf{0}} = \\mathbf{0} + J_d \\nabla^2 H_d(\\mathbf{0})\n$$\n我们已知 $\\nabla^2 H_d(\\mathbf{0}) = K = \\mathrm{diag}(k_1, k_2)$。因此，线性化系统的状态矩阵为：\n$$\nA = J_d K\n$$\n对于一个二维系统，常数斜对称矩阵 $J_d$ 必须具有以下形式：\n$$\nJ_d = \\begin{pmatrix} 0 & \\alpha \\\\ -\\alpha & 0 \\end{pmatrix}\n$$\n其中 $\\alpha$ 为某个实标量。矩阵 $K$ 如下所示：\n$$\nK = \\begin{pmatrix} k_1 & 0 \\\\ 0 & k_2 \\end{pmatrix}\n$$\n其中 $k_1 > 0$ 且 $k_2 > 0$。乘积 $A = J_d K$ 为：\n$$\nA = \\begin{pmatrix} 0 & \\alpha \\\\ -\\alpha & 0 \\end{pmatrix} \\begin{pmatrix} k_1 & 0 \\\\ 0 & k_2 \\end{pmatrix} = \\begin{pmatrix} 0 & \\alpha k_2 \\\\ -\\alpha k_1 & 0 \\end{pmatrix}\n$$\n$A$ 的特征值 $\\lambda$ 可通过特征方程 $\\det(A - \\lambda I) = 0$ 求得：\n$$\n\\det \\begin{pmatrix} -\\lambda & \\alpha k_2 \\\\ -\\alpha k_1 & -\\lambda \\end{pmatrix} = (-\\lambda)^2 - (\\alpha k_2)(-\\alpha k_1) = \\lambda^2 + \\alpha^2 k_1 k_2 = 0\n$$\n这得到 $\\lambda^2 = -\\alpha^2 k_1 k_2$，因此特征值为 $\\lambda = \\pm i |\\alpha| \\sqrt{k_1 k_2}$，其中 $i$ 是虚数单位。问题要求线性化系统是一个中心点，其特征值为 $\\pm i \\omega_0$，其中 $\\omega_0 > 0$。令两个关于特征值的表达式相等，我们得到：\n$$\n|\\alpha| \\sqrt{k_1 k_2} = \\omega_0\n$$\n由于 $k_1, k_2, \\omega_0$ 均为正数，我们可以解出 $|\\alpha|$：\n$$\n|\\alpha| = \\frac{\\omega_0}{\\sqrt{k_1 k_2}}\n$$\n对于 $\\alpha$ 有两个选择。我们不妨选择正根，即 $\\alpha = \\frac{\\omega_0}{\\sqrt{k_1 k_2}}$。那么期望的互联矩阵 $J_d$ 就唯一确定为：\n$$\nJ_d = \\begin{pmatrix} 0 & \\frac{\\omega_0}{\\sqrt{k_1 k_2}} \\\\ -\\frac{\\omega_0}{\\sqrt{k_1 k_2}} & 0 \\end{pmatrix}\n$$\n\n第2部分：阻尼系统的分析。\n\n现在，加入各向同性阻尼 $R_d(x) \\equiv r I_2$，其中 $r > 0$。动力学方程变为：\n$$\n\\dot{x} = (J_d - rI_2) \\nabla H_d(x)\n$$\n新的线性化系统矩阵 $A_d$ 为：\n$$\nA_d = (J_d - rI_2) K = \\left( \\begin{pmatrix} 0 & \\alpha \\\\ -\\alpha & 0 \\end{pmatrix} - \\begin{pmatrix} r & 0 \\\\ 0 & r \\end{pmatrix} \\right) \\begin{pmatrix} k_1 & 0 \\\\ 0 & k_2 \\end{pmatrix}\n$$\n$$\nA_d = \\begin{pmatrix} -r & \\alpha \\\\ -\\alpha & -r \\end{pmatrix} \\begin{pmatrix} k_1 & 0 \\\\ 0 & k_2 \\end{pmatrix} = \\begin{pmatrix} -r k_1 & \\alpha k_2 \\\\ -\\alpha k_1 & -r k_2 \\end{pmatrix}\n$$\n$A_d$ 的特征值 $\\lambda$ 的特征方程为 $\\det(A_d - \\lambda I) = 0$：\n$$\n\\det \\begin{pmatrix} -r k_1 - \\lambda & \\alpha k_2 \\\\ -\\alpha k_1 & -r k_2 - \\lambda \\end{pmatrix} = (-r k_1 - \\lambda)(-r k_2 - \\lambda) + \\alpha^2 k_1 k_2 = 0\n$$\n$$\n\\lambda^2 + (r k_1 + r k_2)\\lambda + r^2 k_1 k_2 + \\alpha^2 k_1 k_2 = 0\n$$\n从第1部分代入 $\\alpha^2 = \\frac{\\omega_0^2}{k_1 k_2}$：\n$$\n\\lambda^2 + r(k_1+k_2)\\lambda + (r^2 k_1 k_2 + \\omega_0^2) = 0\n$$\n特征值由二次求根公式给出：\n$$\n\\lambda_{1,2} = \\frac{-r(k_1+k_2) \\pm \\sqrt{ (r(k_1+k_2))^2 - 4(r^2 k_1 k_2 + \\omega_0^2) }}{2}\n$$\n如果特征值是一对具有负实部的共轭复数，则平衡点是渐近稳定焦点。特征值的实部为 $\\mathrm{Re}(\\lambda) = -\\frac{r(k_1+k_2)}{2}$。由于 $r > 0$，$k_1 > 0$ 且 $k_2 > 0$，实部总是负的，这保证了渐近稳定性。\n如果二次方程的判别式为负，则特征值为复数。令 $\\Delta$ 为判别式：\n$$\n\\Delta = (r(k_1+k_2))^2 - 4(r^2 k_1 k_2 + \\omega_0^2) = r^2(k_1^2 + 2k_1 k_2 + k_2^2) - 4r^2 k_1 k_2 - 4\\omega_0^2\n$$\n$$\n\\Delta = r^2(k_1^2 - 2k_1 k_2 + k_2^2) - 4\\omega_0^2 = r^2(k_1-k_2)^2 - 4\\omega_0^2\n$$\n对于焦点，我们要求 $\\Delta < 0$：\n$$\nr^2(k_1-k_2)^2 - 4\\omega_0^2 < 0 \\implies r^2(k_1-k_2)^2 < 4\\omega_0^2\n$$\n对两边取平方根可得：\n$$\nr |k_1 - k_2| < 2\\omega_0\n$$\n这就是平衡点成为渐近稳定焦点时对 $r$ 的条件。如果 $k_1 \\neq k_2$，这等价于 $0 < r < \\frac{2\\omega_0}{|k_1-k_2|}$。如果 $k_1=k_2$，该条件变为 $0 < 2\\omega_0$，对于 $\\omega_0 > 0$ 总是成立，这意味着对于任何 $r>0$，系统都是一个焦点。\n问题要求提供 $J_d$ 的显式表达式作为最终答案。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & \\frac{\\omega_{0}}{\\sqrt{k_{1} k_{2}}} \\\\ -\\frac{\\omega_{0}}{\\sqrt{k_{1} k_{2}}} & 0 \\end{pmatrix}}\n$$", "id": "2704607"}, {"introduction": "成功的局部设计并不意味着全局性能得到了保证，我们还必须考虑所塑造的能量函数的全局特性。本练习探讨了能量-耗散法中的一个常见陷阱：在系统中无意间引入了不期望的稳定点，即“伪平衡点” [@problem_id:2704604]。通过分析一个具体的例子，您将学习到期望势能函数 $V_d(q)$ 的选择如何导致这一问题，并推导出避免伪平衡点的设计准则，从而确保系统唯一地收敛于目标状态。", "problem": "考虑一个保守的两自由度欠驱动机械系统，其广义坐标为 $q \\in \\mathbb{R}^{2}$，共轭动量为 $p \\in \\mathbb{R}^{2}$。其哈密顿量为\n$$\nH(q,p) \\;=\\; \\tfrac{1}{2}\\,p^{\\top} M^{-1}(q)\\,p \\;+\\; V(q),\n$$\n其中 $M(q) \\in \\mathbb{R}^{2 \\times 2}$ 是一个对称正定惯性矩阵，$V(q)$ 是势能。该系统仅在第二个坐标处由控制输入 $u \\in \\mathbb{R}$ 驱动，该输入通过一个满秩输入矩阵 $G(q) \\in \\mathbb{R}^{2 \\times 1}$ 注入，该矩阵的第二行为非零，第一行为零。您的任务是设计一个互联与阻尼分配基于无源性的控制（IDA-PBC），以渐近稳定平衡点 $(q^{\\star},p^{\\star}) = (0,0)$。\n\n假设您采用标准的能量整形路径，并指定一个期望的哈密顿量，形式如下\n$$\nH_{d}(q,p) \\;=\\; \\tfrac{1}{2}\\,p^{\\top} M_{d}^{-1}(q)\\,p \\;+\\; V_{d}(q),\n$$\n其中 $M_{d}(q)$ 是对称正定的，整形后的势能选择为\n$$\nV_{d}(q) \\;=\\; k_{1}\\,\\big(1 - \\cos q_{1}\\big) \\;+\\; k_{2}\\,\\big(1 - \\cos(2 q_{1})\\big) \\;+\\; \\tfrac{1}{2}\\,k_{3}\\,q_{2}^{2},\n$$\n其中 $k_{1} > 0$，$k_{3} > 0$，以及 $k_{2} \\in \\mathbb{R}$ 待选。假设互联与阻尼分配及相关的匹配条件均满足，以至于与输出 $y := \\partial H_{d}/\\partial p_{2}$ 相关联的零动态流形由下式给出\n$$\n\\mathcal{Z} \\;=\\; \\{(q,p)\\in \\mathbb{R}^{4} \\,:\\, q_{2}=0,\\; p_{2}=0\\},\n$$\n并且 $\\mathcal{Z}$ 在闭环动力学下是不变的。在 $\\mathcal{Z}$ 上，降阶闭环动力学在 $q_{1}$ 中演化，其有效势能等于 $V_{d}(q)$ 在 $\\{q_{2}=0\\}$ 上的限制。\n\n仅从以上定义和基本微积分出发，完成以下任务：\n\n1. 通过计算降阶势能在 $q_{1}$ 中的驻点，推导出 $\\mathcal{Z}$ 上降阶零动态的临界点（平衡点）集合，并明确展示当 $k_{2} \\neq 0$ 选择不当时，除了期望的 $q_{1}=0$ 构型外，如何出现额外的临界点（伪平衡点）。\n\n2. 从您的推导中，得出一个关于 $k_{2}$ 的定量条件，该条件保证除了由 $\\sin q_{1} = 0$ 产生的平凡解之外，降阶势能不存在任何其他临界点。然后，提出一个关于 $k_2$ 的设计调整，以消除伪平衡点，同时保持 $k_{1} > 0$。\n\n计算 $k_{2}$ 的最大允许幅值 $c_{\\star}$，表示为 $k_{1}$ 的符号表达式，使得对于任何满足 $\\lvert k_{2} \\rvert < c_{\\star}$ 的 $k_{2}$，在零动态流形上不存在伪平衡点。请以 $k_{1}$ 的封闭形式符号表达式提供您的最终答案。不需要数值取整。最终表达式中不需要物理单位。", "solution": "所述问题具有科学依据，是适定的、客观的且内部一致的。它提出了非线性控制理论领域中的一个标准任务，特别涉及互联与阻尼分配基于无源性的控制（IDA-PBC）方案中零动态的分析。所有必要的定义和假设都已提供，可以进行严格的数学分析。因此，该问题被认为是有效的，并将提供解答。\n\n主要任务是分析在指定的零动态流形 $\\mathcal{Z}$ 上降阶闭环动力学的平衡点。该流形由 $\\mathcal{Z} = \\{(q,p)\\in \\mathbb{R}^{4} \\,:\\, q_{2}=0,\\; p_{2}=0\\}$ 给出。问题指出，在该流形上，坐标 $q_1$ 中的动力学由一个有效势能函数 $V_{red}(q_{1})$ 控制，该函数是期望势能 $V_{d}(q)$ 在 $\\mathcal{Z}$ 上的限制。\n\n我们将 $q_{2}=0$ 代入 $V_{d}(q)$ 的表达式中，得到 $V_{red}(q_{1})$：\n$$\nV_{red}(q_{1}) = V_{d}(q_{1}, 0) = k_{1}\\,\\big(1 - \\cos q_{1}\\big) \\;+\\; k_{2}\\,\\big(1 - \\cos(2 q_{1})\\big) \\;+\\; \\tfrac{1}{2}\\,k_{3}\\,(0)^{2}\n$$\n$$\nV_{red}(q_{1}) = k_{1}\\,(1 - \\cos q_{1}) + k_{2}\\,(1 - \\cos(2q_{1}))\n$$\n降阶系统的临界点（平衡点）对应于该势能的驻点，这些驻点位于 $V_{red}(q_{1})$ 对 $q_{1}$ 的一阶导数为零的地方。我们计算这个导数：\n$$\n\\frac{d V_{red}}{d q_{1}} = \\frac{d}{d q_{1}} \\left[ k_{1}\\,(1 - \\cos q_{1}) + k_{2}\\,(1 - \\cos(2q_{1})) \\right] = k_{1} \\sin q_{1} + 2k_{2} \\sin(2q_{1})\n$$\n使用三角二倍角恒等式 $\\sin(2q_{1}) = 2 \\sin q_{1} \\cos q_{1}$，我们简化该导数：\n$$\n\\frac{d V_{red}}{d q_{1}} = k_{1} \\sin q_{1} + 4k_{2} \\sin q_{1} \\cos q_{1} = (\\sin q_{1})(k_{1} + 4k_{2} \\cos q_{1})\n$$\n将此导数设为零，$\\frac{d V_{red}}{d q_{1}} = 0$，得到平衡点方程：\n$$\n(\\sin q_{1})(k_{1} + 4k_{2} \\cos q_{1}) = 0\n$$\n如果两个因子中至少有一个为零，则该方程成立：\n1.  $\\sin q_{1} = 0$: 该条件产生一组预期的或平凡的平衡点，位于 $q_{1} = n\\pi$ 处，其中 $n \\in \\mathbb{Z}$ 为任意整数。该集合包括期望的平衡构型 $q_{1} = 0$。\n2.  $k_{1} + 4k_{2} \\cos q_{1} = 0$: 该条件可以重新整理以求解 $\\cos q_{1}$：\n    $$\n    \\cos q_{1} = -\\frac{k_{1}}{4k_{2}}\n    $$\n    第二个方程是“伪”平衡点的来源。要使该方程存在关于 $q_1$ 的实数解，其右侧的值必须在余弦函数的有效范围内，即在区间 $[-1, 1]$ 内。因此，当且仅当以下条件成立时，会出现伪平衡点：\n    $$\n    \\left| -\\frac{k_{1}}{4k_{2}} \\right| \\leq 1\n    $$\n    鉴于问题指定 $k_{1} > 0$，我们可以简化此条件：\n    $$\n    \\frac{k_{1}}{4|k_{2}|} \\leq 1 \\quad \\implies \\quad k_{1} \\leq 4|k_{2}| \\quad \\implies \\quad |k_{2}| \\geq \\frac{k_{1}}{4}\n    $$\n    这表明，如果所选参数 $k_{2}$ 的幅值不适当地过大，特别是 $|k_{2}| \\geq \\frac{k_{1}}{4}$，则会在零动态流形上产生额外的临界点。这完成了问题的第一部分。\n\n对于问题的第二部分，我们必须推导出一个关于 $k_{2}$ 的条件，以确保这些伪平衡点不存在。这可以通过要求方程 $\\cos q_{1} = -k_{1}/(4k_{2})$ 没有实数解来实现。如果右侧的绝对值严格大于 1，则可以保证这一点：\n$$\n\\left| -\\frac{k_{1}}{4k_{2}} \\right| > 1\n$$\n遵循与之前相同的逻辑，该不等式变为：\n$$\n\\frac{k_{1}}{4|k_{2}|} > 1 \\quad \\implies \\quad k_{1} > 4|k_{2}| \\quad \\implies \\quad |k_{2}| < \\frac{k_{1}}{4}\n$$\n因此，建议的设计调整是选择参数 $k_{2}$，使其幅值相对于 $k_{1}$ 遵守这一严格不等式。通过这样做，因子 $(k_{1} + 4k_{2} \\cos q_{1})$ 永远不能为零，降阶系统的唯一平衡点将是由 $\\sin q_{1} = 0$ 决定的那些平衡点。\n\n最后，我们被要求找到 $k_{2}$ 的最大允许幅值 $c_{\\star}$，使得对于任何满足 $|k_{2}| < c_{\\star}$ 的 $k_{2}$，不存在伪平衡点。我们为消除此类平衡点而推导出的条件恰好是这种形式：$|k_{2}| < k_{1}/4$。通过直接比较，我们确定 $c_{\\star}$ 的值为：\n$$\nc_{\\star} = \\frac{k_{1}}{4}\n$$\n该值代表了参数 $k_{2}$ 的临界阈值。对于所有 $|k_{2}| < c_{\\star}$ 的情况，期望势能 $V_{d}(q)$ 在零动态流形上于 $q_1=n\\pi$ 处具有唯一的临界点族，从而防止了可能危及期望工作点稳定性的分岔。", "answer": "$$\\boxed{\\frac{k_{1}}{4}}$$", "id": "2704604"}]}