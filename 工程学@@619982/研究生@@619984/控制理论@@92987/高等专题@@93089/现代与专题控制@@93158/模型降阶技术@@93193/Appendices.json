{"hands_on_practices": [{"introduction": "本练习直击平衡截断的核心，要求你计算其关键组成部分——汉克尔奇异值 ($\\sigma_i$) 。通过处理一个由相同的、解耦的子系统构成的系统，你将亲眼看到物理对称性如何体现为重复的奇异值。这个实践旨在加强系统抽象数学属性与其底层物理结构之间的联系。", "problem": "考虑一个连续时间、线性时不变、稳定且最小的系统，其能控性格拉姆矩阵为 $P \\in \\mathbb{R}^{4 \\times 4}$，能观测性格拉姆矩阵为 $Q \\in \\mathbb{R}^{4 \\times 4}$。该系统由两个相同的、解耦的子系统组成，这两个子系统通过交换彼此的置换对称性相关联。格拉姆矩阵由下式给出\n$$\nP \\;=\\; I_{2} \\otimes P_{0}, \n\\qquad \nQ \\;=\\; I_{2} \\otimes Q_{0},\n$$\n其中\n$$\nP_{0} \\;=\\; \\begin{pmatrix} 3 & 1 \\\\ 1 & 2 \\end{pmatrix},\n\\qquad\nQ_{0} \\;=\\; \\begin{pmatrix} 4 & 2 \\\\ 2 & 5 \\end{pmatrix},\n$$\n且 $I_{2}$ 是 $2 \\times 2$ 的单位矩阵。这里 $\\otimes$ 表示克罗内克积。假设对于某个稳定实现， $P$ 和 $Q$是相关 Lyapunov 方程的唯一、对称、正定解。\n\n仅使用线性系统和矩阵分析的核心定义，确定 $PQ$ 的谱（包括代数重数），然后确定系统的 Hankel 奇异值多重集。解释该系统的对称性如何决定了 Hankel 奇异值的重数。\n\n请以单个行向量的形式报告最终答案，该向量为按非递增顺序排列的 Hankel 奇异值有序多重集，并以精确解析形式给出（无数值近似，无四舍五入）。不要包含单位。", "solution": "问题陈述已经过评估，被确定为有效。它在科学上是合理的，内容自洽，并且在线性控制理论的既定框架内是适定的。所提供的格拉姆矩阵是对称和正定的，与稳定和最小系统的描述一致。因此，我们可以开始求解。\n\n线性时不变系统的 Hankel 奇异值（HSVs），记为 $\\sigma_i$，定义为能控性格拉姆矩阵 $P$ 和能观测性格拉姆矩阵 $Q$ 乘积的特征值的平方根。即 $\\sigma_i = \\sqrt{\\lambda_i(PQ)}$。因此，Hankel 奇异值的多重集完全由矩阵乘积 $PQ$ 的谱确定。\n\n给定的格拉姆矩阵为 $P = I_{2} \\otimes P_{0}$ 和 $Q = I_{2} \\otimes Q_{0}$，其中 $I_{2}$ 是 $2 \\times 2$ 的单位矩阵，$\\otimes$ 表示克罗内克积。子系统的格拉姆矩阵如下：\n$$\nP_{0} = \\begin{pmatrix} 3 & 1 \\\\ 1 & 2 \\end{pmatrix}, \\qquad Q_{0} = \\begin{pmatrix} 4 & 2 \\\\ 2 & 5 \\end{pmatrix}\n$$\n我们利用克罗内克积的混合乘积性质来计算乘积 $PQ$，该性质表明 $(A \\otimes B)(C \\otimes D) = (AC) \\otimes (BD)$。应用此性质，我们得到：\n$$\nPQ = (I_{2} \\otimes P_{0})(I_{2} \\otimes Q_{0}) = (I_{2}I_{2}) \\otimes (P_{0}Q_{0}) = I_{2} \\otimes (P_{0}Q_{0})\n$$\n克罗内克积 $A \\otimes B$ 的特征值是 $A$ 和 $B$ 的特征值的乘积。设 $\\text{spec}(M)$ 表示矩阵 $M$ 的特征值多重集（谱）。那么，$\\text{spec}(PQ)$ 是所有乘积 $\\mu_i \\nu_j$ 的集合，其中 $\\mu_i \\in \\text{spec}(I_{2})$ 且 $\\nu_j \\in \\text{spec}(P_{0}Q_{0})$。\n\n单位矩阵 $I_2$ 的特征值显然是 $\\{1, 1\\}$。现在我们必须确定乘积 $P_{0}Q_{0}$ 的特征值。首先，我们计算这个乘积：\n$$\nP_{0}Q_{0} = \\begin{pmatrix} 3 & 1 \\\\ 1 & 2 \\end{pmatrix} \\begin{pmatrix} 4 & 2 \\\\ 2 & 5 \\end{pmatrix} = \\begin{pmatrix} (3)(4) + (1)(2) & (3)(2) + (1)(5) \\\\ (1)(4) + (2)(2) & (1)(2) + (2)(5) \\end{pmatrix} = \\begin{pmatrix} 14 & 11 \\\\ 8 & 12 \\end{pmatrix}\n$$\n$P_{0}Q_{0}$ 的特征值 $\\lambda$ 是特征方程 $\\det(P_{0}Q_{0} - \\lambda I) = 0$ 的根：\n$$\n\\det \\begin{pmatrix} 14 - \\lambda & 11 \\\\ 8 & 12 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(14 - \\lambda)(12 - \\lambda) - (11)(8) = 0\n$$\n$$\n\\lambda^2 - 26\\lambda + 168 - 88 = 0\n$$\n$$\n\\lambda^2 - 26\\lambda + 80 = 0\n$$\n我们求解这个关于 $\\lambda$ 的二次方程：\n$$\n\\lambda = \\frac{-(-26) \\pm \\sqrt{(-26)^{2} - 4(1)(80)}}{2(1)} = \\frac{26 \\pm \\sqrt{676 - 320}}{2} = \\frac{26 \\pm \\sqrt{356}}{2}\n$$\n因为 $356 = 4 \\times 89$，我们有 $\\sqrt{356} = \\sqrt{4 \\times 89} = 2\\sqrt{89}$。特征值为：\n$$\n\\lambda = \\frac{26 \\pm 2\\sqrt{89}}{2} = 13 \\pm \\sqrt{89}\n$$\n所以，$P_0Q_0$ 的谱是 $\\{13 + \\sqrt{89}, 13 - \\sqrt{89}\\}$。由于 $13^2 = 169 > 89$，两个特征值都是正数，这与 $P_0$ 和 $Q_0$ 是正定矩阵的预期相符。\n\n$PQ = I_{2} \\otimes (P_{0}Q_{0})$ 的谱是通过将 $P_0Q_0$ 的每个特征值与 $I_2$ 的每个特征值相乘得到的。这产生了以下多重集：\n$$\n\\text{spec}(PQ) = \\{ 1 \\times (13 + \\sqrt{89}), 1 \\times (13 - \\sqrt{89}), 1 \\times (13 + \\sqrt{89}), 1 \\times (13 - \\sqrt{89}) \\}\n$$\n$$\n\\text{spec}(PQ) = \\{ 13 + \\sqrt{89}, 13 - \\sqrt{89}, 13 + \\sqrt{89}, 13 - \\sqrt{89} \\}\n$$\n每个特征值的代数重数均为 $2$。\n\nHankel 奇异值是这些特征值的平方根。令 $\\sigma_{1} = \\sqrt{13 + \\sqrt{89}}$ 和 $\\sigma_{2} = \\sqrt{13 - \\sqrt{89}}$。Hankel 奇异值的多重集是 $\\{\\sigma_{1}, \\sigma_{1}, \\sigma_{2}, \\sigma_{2}\\}$。按非递增顺序排列，HSVs 为：\n$$\n\\sqrt{13 + \\sqrt{89}}, \\quad \\sqrt{13 + \\sqrt{89}}, \\quad \\sqrt{13 - \\sqrt{89}}, \\quad \\sqrt{13 - \\sqrt{89}}\n$$\n问题陈述解释了该系统由两个相同的、通过置换对称性相关联的解耦子系统组成。这种物理描述在数学上体现为格拉姆矩阵的块对角结构：\n$$\nP = \\begin{pmatrix} P_{0} & 0 \\\\ 0 & P_{0} \\end{pmatrix}, \\qquad Q = \\begin{pmatrix} Q_{0} & 0 \\\\ 0 & Q_{0} \\end{pmatrix}\n$$\n这种结构意味着状态空间是两个独立子系统状态空间的直和，每个子系统都具有格拉姆矩阵 $P_0$ 和 $Q_0$。单个此类子系统的 Hankel 奇异值是 $P_0Q_0$ 特征值的平方根，即 $\\sigma_1 = \\sqrt{13+\\sqrt{89}}$ 和 $\\sigma_2 = \\sqrt{13-\\sqrt{89}}$。复合系统的 Hankel 奇异值集合是其子系统 HSVs 的并集。由于两个子系统相同，它们的 HSVs 也相同。这种物理和结构上的对称性是观察到简并性的根本原因：单个子系统的每个 Hankel 奇异值在整个系统的谱中都以二重性出现。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{13 + \\sqrt{89}} & \\sqrt{13 + \\sqrt{89}} & \\sqrt{13 - \\sqrt{89}} & \\sqrt{13 - \\sqrt{89}} \\end{pmatrix}}\n$$", "id": "2725566"}, {"introduction": "模型降阶通常涉及在细微差异中进行权衡取舍。本问题旨在比较两种源于平衡实现的方法：标准平衡截断（BT）和平衡奇异摄动（BSP）。通过分析它们在零频率处的行为，你将揭示它们在保持系统稳态（直流）增益方面的关键差异——这在许多控制应用中是至关重要的特性。本练习强调了“最佳”降阶技术取决于需要优先保留哪些系统属性。", "problem": "考虑一个最小、渐近稳定、严格真、连续时间的线性时不变 (LTI) 系统，其状态空间实现为 $\\left(A,B,C,D\\right)$，其中 $D=0$，传递函数为 $G(s)=C\\left(sI-A\\right)^{-1}B$。假设该系统有一个平衡实现，并根据目标降阶阶数 $r$ 对其进行相应分块，如下所示：\n$$\nA=\\begin{bmatrix} A_{11} & A_{12} \\\\ A_{21} & A_{22} \\end{bmatrix},\\quad\nB=\\begin{bmatrix} B_{1} \\\\ B_{2} \\end{bmatrix},\\quad\nC=\\begin{bmatrix} C_{1} & C_{2} \\end{bmatrix},\n$$\n其中左上角块的维度为 $r$。构造两种标准的降阶模型：\n- 平衡截断 (BT)：保留 $r$ 阶状态块，舍弃其余部分。\n- 平衡奇异摄动 (BSP)：通过奇异摄动法消除 $(n-r)$ 阶状态块，该方法将截断的状态视为快模态，并通过将其时间导数置零来施加一个代数约束。\n\n仅使用基本定义（传递函数 $G(s)=C(sI-A)^{-1}B+D$、稳定严格真系统的稳态增益 $G(0)$，以及线性代数的块矩阵求逆），论证这两种降阶方法在稳态（直流 (DC)）增益匹配和低频特性（$s=0$ 附近）方面的比较。\n\n下列陈述中，哪些是正确的？\n\nA. 对于一个 $D=0$ 的稳定严格真系统，BSP 产生的降阶模型的传递函数在 $s=0$ 处与原系统精确匹配，而 BT 通常不匹配。\n\nB. 因为原系统是严格真系统 ($D=0$)，所以 BT 和 BSP 降阶模型都必然具有零稳态增益。\n\nC. BT 在构造上保留了 $G(s)$ 在低频（$s=0$ 附近）的一阶泰勒展开，而 BSP 则没有。\n\nD. 在 BSP 中，即使初始时 $D=0$，降阶模型也可能会获得一个非零的直接馈通项 $D_{r}\\neq 0$，从而强制在 $s=0$ 处精确匹配。\n\nE. 如果被截断的汉克尔奇异值完全对应于快模态，则 BT 保证能精确匹配原系统的稳态增益。", "solution": "首先应对问题陈述进行严格验证。\n\n### 步骤 1：提取已知条件\n- 系统是一个最小、渐近稳定、严格真、连续时间的线性时不变 (LTI) 系统。\n- 状态空间实现由 $(A, B, C, D)$ 给出，其中直接馈通矩阵 $D=0$。\n- 传递函数为 $G(s) = C(sI-A)^{-1}B$。\n- 为降阶阶数 $r$ 对一个平衡实现进行分块：\n$$ A = \\begin{bmatrix} A_{11} & A_{12} \\\\ A_{21} & A_{22} \\end{bmatrix}, \\quad B = \\begin{bmatrix} B_{1} \\\\ B_{2} \\end{bmatrix}, \\quad C = \\begin{bmatrix} C_{1} & C_{2} \\end{bmatrix} $$\n其中 $A_{11}$ 是一个 $r \\times r$ 矩阵。\n- **平衡截断 (BT)**：降阶模型为 $(A_r, B_r, C_r, D_r) = (A_{11}, B_1, C_1, 0)$。\n- **平衡奇异摄动 (BSP)**：通过将截断状态的导数置零（即 $\\dot{x}_2 = 0$）来获得降阶模型。\n- 分析必须仅使用基本定义：$G(s)=C(sI-A)^{-1}B+D$、稳态增益 $G(0)$ 和线性代数的块矩阵求逆。\n\n### 步骤 2：使用已知条件进行验证\n- **科学依据：** 该问题基于控制理论中已建立的基本概念，特别是 LTI 系统的模型降阶技术。平衡实现、平衡截断和奇异摄动都是标准方法。所有前提在事实上都是正确的。\n- **适定性：** 问题定义清晰。它要求基于两种标准降阶技术在零频率（$s=0$）处的行为进行比较。所提供的定义和约束足以推导出唯一且有意义的解。\n- **客观性：** 语言正式、精确，没有主观或含糊的术语。\n\n### 步骤 3：结论与行动\n问题陈述有效。这是一个控制理论中适定且有科学依据的问题。可以进行求解推导。\n\n### 推导\n\n原系统由以下状态空间方程描述：\n$$ \\dot{x}(t) = Ax(t) + Bu(t) $$\n$$ y(t) = Cx(t) $$\n传递函数为 $G(s) = C(sI-A)^{-1}B$。由于系统是渐近稳定的，矩阵 $A$ 是赫尔维茨 (Hurwitz) 矩阵，这意味着 $A$ 是可逆的。稳态（直流）增益是传递函数在 $s=0$ 处的值：\n$$ G(0) = C(0 \\cdot I - A)^{-1}B = C(-A)^{-1}B = -CA^{-1}B $$\n\n我们现在来分析这两种降阶方法。\n\n**1. 平衡截断 (BT)**\n\n根据定义，BT 降阶模型为 $(A_{r}, B_{r}, C_{r}, D_{r}) = (A_{11}, B_1, C_1, 0)$。降阶模型的传递函数为：\n$$ G_{BT}(s) = C_1(sI_r - A_{11})^{-1}B_1 $$\n对于一个稳定系统，平衡截断会产生一个稳定的降阶模型，因此 $A_{11}$ 也是赫尔维茨矩阵，因而是可逆的。BT 模型的稳态增益为：\n$$ G_{BT}(0) = -C_1A_{11}^{-1}B_1 $$\n为了将其与原增益 $G(0) = -CA^{-1}B$ 进行比较，我们必须考察 $A^{-1}$ 的结构。使用块矩阵求逆公式，$A^{-1}$ 的左上角块是 $(A_{11} - A_{12}A_{22}^{-1}A_{21})^{-1}$，而不是 $A_{11}^{-1}$。此外，$G(0)$ 依赖于 $A$、$B$ 和 $C$ 的所有分块。很明显，在一般情况下，\n$$ -C_1A_{11}^{-1}B_1 \\neq -CA^{-1}B $$\n因此，除了特殊情况外，平衡截断不保留稳态增益。\n\n**2. 平衡奇异摄动 (BSP)**\n\n该方法从分块的状态方程推导而来：\n$$ \\dot{x}_1 = A_{11}x_1 + A_{12}x_2 + B_1 u $$\n$$ \\dot{x}_2 = A_{21}x_1 + A_{22}x_2 + B_2 u $$\n$$ y = C_1x_1 + C_2x_2 $$\n奇异摄动近似假设 $x_2$ 的动态是无限快的，这对应于设置 $\\dot{x}_2 = 0$。\n$$ 0 = A_{21}x_1 + A_{22}x_2 + B_2 u $$\n稳定系统的平衡实现的一个性质是其对角块 $A_{11}$ 和 $A_{22}$ 也是赫尔维茨矩阵，这意味着 $A_{22}$ 是可逆的。我们可以解出 $x_2$：\n$$ x_2 = -A_{22}^{-1}(A_{21}x_1 + B_2 u) $$\n将这个代数关系代回到 $\\dot{x}_1$ 和 $y$ 的方程中，即可定义降阶系统：\n$$ \\dot{x}_1 = A_{11}x_1 + A_{12}(-A_{22}^{-1}(A_{21}x_1 + B_2 u)) + B_1 u $$\n$$ \\dot{x}_1 = (A_{11} - A_{12}A_{22}^{-1}A_{21})x_1 + (B_1 - A_{12}A_{22}^{-1}B_2)u $$\n$$ y = C_1x_1 + C_2(-A_{22}^{-1}(A_{21}x_1 + B_2 u)) $$\n$$ y = (C_1 - C_2A_{22}^{-1}A_{21})x_1 + (-C_2A_{22}^{-1}B_2)u $$\n由此，我们确定降阶系统 $(A_r, B_r, C_r, D_r)$ 的矩阵：\n$$ A_r = A_{11} - A_{12}A_{22}^{-1}A_{21} $$\n$$ B_r = B_1 - A_{12}A_{22}^{-1}B_2 $$\n$$ C_r = C_1 - C_2A_{22}^{-1}A_{21} $$\n$$ D_r = -C_2A_{22}^{-1}B_2 $$\nBSP 模型的稳态增益是 $G_{BSP}(0) = -C_rA_r^{-1}B_r + D_r$。我们现在将证明这与 $G(0)$ 完全相同。\n我们使用 $A^{-1}$ 的块矩阵求逆公式，其中 $A_{22}$ 的舒尔补 (Schur complement) 为 $S_c = A_{11} - A_{12}A_{22}^{-1}A_{21} = A_r$。该公式为：\n$$ A^{-1} = \\begin{bmatrix} S_c^{-1} & -S_c^{-1}A_{12}A_{22}^{-1} \\\\ -A_{22}^{-1}A_{21}S_c^{-1} & A_{22}^{-1} + A_{22}^{-1}A_{21}S_c^{-1}A_{12}A_{22}^{-1} \\end{bmatrix} = \\begin{bmatrix} A_r^{-1} & -A_r^{-1}A_{12}A_{22}^{-1} \\\\ -A_{22}^{-1}A_{21}A_r^{-1} & A_{22}^{-1} + A_{22}^{-1}A_{21}A_r^{-1}A_{12}A_{22}^{-1} \\end{bmatrix} $$\n现在我们计算 $G(0) = -CA^{-1}B$：\n$$ G(0) = -\\begin{bmatrix} C_1 & C_2 \\end{bmatrix} A^{-1} \\begin{bmatrix} B_1 \\\\ B_2 \\end{bmatrix} = -\\left( \\begin{bmatrix} C_1 & C_2 \\end{bmatrix} \\begin{bmatrix} A_r^{-1} B_1 - A_r^{-1}A_{12}A_{22}^{-1} B_2 \\\\ -A_{22}^{-1}A_{21}A_r^{-1}B_1 + (A_{22}^{-1} + A_{22}^{-1}A_{21}A_r^{-1}A_{12}A_{22}^{-1})B_2 \\end{bmatrix} \\right) $$\n$$ G(0) = - \\left( C_1(A_r^{-1} B_1 - A_r^{-1}A_{12}A_{22}^{-1} B_2) + C_2(-A_{22}^{-1}A_{21}A_r^{-1}B_1 + A_{22}^{-1}B_2 + A_{22}^{-1}A_{21}A_r^{-1}A_{12}A_{22}^{-1}B_2) \\right) $$\n按 $A_r^{-1}$ 分组各项：\n$$ G(0) = - \\left( (C_1 - C_2A_{22}^{-1}A_{21})A_r^{-1}B_1 - (C_1 - C_2A_{22}^{-1}A_{21})A_r^{-1}A_{12}A_{22}^{-1}B_2 + C_2A_{22}^{-1}B_2 \\right) $$\n识别 $C_r$ 和 $B_r$ 的定义：\n$$ G(0) = - \\left( C_r A_r^{-1} B_1 - C_r A_r^{-1} A_{12}A_{22}^{-1}B_2 + C_2A_{22}^{-1}B_2 \\right) $$\n$$ G(0) = - \\left( C_r A_r^{-1} (B_1 - A_{12}A_{22}^{-1}B_2) + C_2A_{22}^{-1}B_2 \\right) $$\n$$ G(0) = - ( C_r A_r^{-1} B_r + C_2A_{22}^{-1}B_2 ) $$\n代入 $D_r = -C_2A_{22}^{-1}B_2$：\n$$ G(0) = - (C_r A_r^{-1} B_r - D_r) = -C_rA_r^{-1}B_r + D_r $$\n这最后的表达式正是 BSP 降阶模型稳态增益 $G_{BSP}(0)$ 的定义。因此我们证明了 $G_{BSP}(0) = G(0)$。\n\n### 逐项分析\n\n**A. 对于一个 D=0 的稳定严格真系统，BSP 产生的降阶模型的传递函数在 s=0 处与原系统精确匹配，而 BT 通常不匹配。**\n我们的推导显示 $G_{BSP}(0) = G(0)$，意味着稳态增益完全匹配。我们对 BT 的分析表明 $G_{BT}(0) = -C_1A_{11}^{-1}B_1$，这在一般情况下不等于 $G(0)$。该陈述是推导的直接结论。\n**结论：正确**\n\n**B. 因为原系统是严格真系统 (D=0)，所以 BT 和 BSP 降阶模型都必然具有零稳态增益。**\n该陈述包含一个基本错误。如果一个系统的传递函数在 $s \\to \\infty$ 时趋于零，则该系统是严格真的，这在 $D=0$ 时得到保证。稳态增益是 $G(0)$。没有任何原理要求严格真系统的 $G(0)=0$。举一个简单的反例，$G(s) = \\frac{1}{s+1}$ 是严格真的 ($D=0$)，但其稳态增益为 $G(0)=1$。\n**结论：错误**\n\n**C. BT 在构造上保留了 G(s) 在低频（s=0 附近）的一阶泰勒展开，而 BSP 则没有。**\n保留到一阶的泰勒展开意味着同时匹配零阶项 ($G(0)$) 和一阶项 ($G'(0)$)。如前所述，BT 在一般情况下甚至不匹配零阶项 ($G_{BT}(0) \\neq G(0)$)。因此，该陈述的第一部分是错误的。BSP 匹配零阶项，但通常不匹配更高阶项。该陈述与事实完全相反。\n**结论：错误**\n\n**D. 在 BSP 中，即使初始时 D=0，降阶模型也可能会获得一个非零的直接馈通项 $D_{r} \\neq 0$，从而强制在 s=0 处精确匹配。**\n我们对 BSP 模型的推导得出了一个馈通矩阵 $D_r = -C_2A_{22}^{-1}B_2$。由于假设原系统是最小的且经过分块，通常情况下 $C_2 \\neq 0$ 且 $B_2 \\neq 0$。因此，$D_r$ 通常为非零。我们对直流增益匹配的最终证明，$G(0) = -C_rA_r^{-1}B_r + D_r$，表明这个 $D_r$ 项是实现精确匹配的关键组成部分。该陈述正确地描述了BSP的机制。\n**结论：正确**\n\n**E. 如果被截断的汉克尔奇异值完全对应于快模态，则 BT 保证能精确匹配原系统的稳态增益。**\n该陈述混淆了两个不同的概念。平衡截断截去的是具有最小汉克尔奇异值 ($\\sigma_i$) 的状态，该值衡量的是输入-输出能量的贡献。“快模态”指的是具有较大负实部的极点，代表快速衰减。最小的 $\\sigma_i$ 和快模态之间没有保证的一一对应关系。一个模态可以很慢（极点靠近原点）但耦合很弱，导致 $\\sigma_i$ 很小。反之，一个快模态也可能具有很大的能量贡献和很大的 $\\sigma_i$。该前提在严格意义上没有充分的依据。BT旨在最小化 $H_{\\infty}$ 误差范数，而不是匹配直流增益。虽然在无限时间尺度分离的极限情况下，BSP 模型确实收敛于 BT 模型，但该陈述的前提过于非正式，不能构成“保证”。\n**结论：错误**", "answer": "$$\\boxed{AD}$$", "id": "2725584"}, {"introduction": "尽管许多模型降阶理论是为稳定系统建立的，但现实世界的应用常常涉及不稳定动态。本练习直面这一高级情景。你将应用一种混合工作流程，该流程首先分离并完整保留系统的不稳定部分，然后仅对稳定部分应用平衡截断。这展示了一种强大而实用的策略，用以将核心降阶技术扩展到更广泛、更具挑战性的系统类别中。", "problem": "考虑一个连续时间、单输入单输出的线性时不变 (LTI) 系统，其状态空间实现为\n$$\n\\dot{x}(t)=A x(t)+B u(t), \\quad y(t)=C x(t),\n$$\n其中\n$$\nA=\\begin{pmatrix}\n1 & 0 & 0\\\\\n0 & -2 & 0\\\\\n0 & 0 & -5\n\\end{pmatrix}, \\quad\nB=\\begin{pmatrix}\n1\\\\\n2\\\\\n1\n\\end{pmatrix}, \\quad\nC=\\begin{pmatrix}\n3 & 2 & 1\n\\end{pmatrix}.\n$$\n该系统在 $s=1$ 处有一个不稳定模态，在 $s=-2$ 和 $s=-5$ 处有两个稳定模态。使用一种能精确保留不稳定动态、并仅通过平衡截断法对稳定部分进行降阶的模型降阶方法，构建一个2阶的降阶模型。\n\n从基本原理出发，步骤如下：\n- 使用基于实 Schur 分解的不稳定/稳定分解，来论证分离不稳定子空间和稳定子空间的合理性。\n- 仅针对稳定部分，通过连续时间 Lyapunov 方程定义能达（能控）格拉姆矩阵和能观格拉姆矩阵，并显式求解它们。\n- 使用汉克尔奇异值（定义为能达格拉姆矩阵和能观格拉姆矩阵乘积的特征值的平方根）的定义，来确定占主导地位的稳定模态。\n- 论证在当前坐标和数据下，为何稳定部分已经是平衡的，以及这如何简化了平衡截断步骤。\n- 组建降阶模型，该模型精确保留不稳定部分，并且只保留占主导地位的稳定模态。\n\n最后，计算降阶模型 $G_{r}(s)$ 的传递函数，表示为关于 $s$ 的单个简化有理函数，并在推导过程中验证不稳定极点及其留数是否被精确再现。将 $G_{r}(s)$ 作为最终答案。无需四舍五入，不涉及物理单位。若有角度，以弧度表示。", "solution": "所述问题具有科学依据，提法恰当且客观。这是一个控制理论中的标准练习，具体涉及含不稳定模态的线性系统的模型降阶。所有必要数据均已提供，任务定义明确，且前提与既定的系统理论原理一致。因此，该问题是有效的，我们可以着手求解。\n\n目标是为一个给定的三阶系统构建一个阶数 $r=2$ 的降阶模型，方法是保留其不稳定动态，并对其稳定部分应用平衡截断法。\n\n系统由 $\\dot{x}(t) = A x(t) + B u(t)$, $y(t) = C x(t)$ 给出，其矩阵为：\n$$\nA=\\begin{pmatrix}\n1 & 0 & 0\\\\\n0 & -2 & 0\\\\\n0 & 0 & -5\n\\end{pmatrix}, \\quad\nB=\\begin{pmatrix}\n1\\\\\n2\\\\\n1\n\\end{pmatrix}, \\quad\nC=\\begin{pmatrix}\n3 & 2 & 1\n\\end{pmatrix}\n$$\n$A$的特征值为 $\\lambda_1 = 1$, $\\lambda_2 = -2$ 和 $\\lambda_3 = -5$。与 $\\lambda_1 = 1$ 相关的模态是不稳定的，而与 $\\lambda_2 = -2$ 和 $\\lambda_3 = -5$ 相关的模态是稳定的。\n\n首先，我们将系统分解为其不稳定和稳定部分。由于状态空间实现是以模态形式给出的（其中矩阵 $A$ 是对角阵），它已经处于能够分离不稳定和稳定子空间的实 Schur 形式。我们可以将状态向量 $x$ 划分为 $x = \\begin{pmatrix} x_u \\\\ x_s \\end{pmatrix}$，其中 $x_u$ 是不稳定子系统的状态，$x_s$ 包含稳定子系统的状态。\n\n这种划分得到以下分块对角结构：\n$$\nA = \\begin{pmatrix} A_{uu} & 0 \\\\ 0 & A_{ss} \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\begin{pmatrix} -2 & 0 \\\\ 0 & -5 \\end{pmatrix} \\end{pmatrix}\n$$\n$$\nB = \\begin{pmatrix} B_u \\\\ B_s \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} \\end{pmatrix}\n$$\n$$\nC = \\begin{pmatrix} C_u & C_s \\end{pmatrix} = \\begin{pmatrix} 3 & \\begin{pmatrix} 2 & 1 \\end{pmatrix} \\end{pmatrix}\n$$\n总输出是不稳定部分和稳定部分输出之和：$y(t) = C_u x_u(t) + C_s x_s(t)$。模型降阶过程将只应用于稳定子系统 $(A_{ss}, B_s, C_s)$，其定义如下：\n$$\nA_{ss} = \\begin{pmatrix} -2 & 0 \\\\ 0 & -5 \\end{pmatrix}, \\quad B_s = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}, \\quad C_s = \\begin{pmatrix} 2 & 1 \\end{pmatrix}\n$$\n我们接着分析这个稳定子系统。能达格拉姆矩阵 $W_{c,s}$ 通过求解连续时间 Lyapunov 方程得到：\n$$\nA_{ss} W_{c,s} + W_{c,s} A_{ss}^T + B_s B_s^T = 0\n$$\n由于 $A_{ss}$ 是对角矩阵， $W_{c,s}$ 也必定是对角矩阵。设 $W_{c,s} = \\text{diag}(w_{c1}, w_{c2})$。对角元素的方程变为 $2 \\lambda_i w_{ci} + (b_{si})^2 = 0$，由此得到 $w_{ci} = -\\frac{(b_{si})^2}{2 \\lambda_i}$。\n对于第一个稳定状态：$w_{c1} = -\\frac{2^2}{2(-2)} = 1$。\n对于第二个稳定状态：$w_{c2} = -\\frac{1^2}{2(-5)} = \\frac{1}{10}$。\n因此，稳定部分的能达格拉姆矩阵为：\n$$\nW_{c,s} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{10} \\end{pmatrix}\n$$\n类似地，能观格拉姆矩阵 $W_{o,s}$ 通过求解以下方程得到：\n$$\nA_{ss}^T W_{o,s} + W_{o,s} A_{ss} + C_s^T C_s = 0\n$$\n同样，$W_{o,s}$ 必定是对角矩阵，设 $W_{o,s} = \\text{diag}(w_{o1}, w_{o2})$。其元素的方程为 $2 \\lambda_i w_{oi} + (c_{si})^2 = 0$，由此得到 $w_{oi} = -\\frac{(c_{si})^2}{2 \\lambda_i}$。\n对于第一个稳定状态：$w_{o1} = -\\frac{2^2}{2(-2)} = 1$。\n对于第二个稳定状态：$w_{o2} = -\\frac{1^2}{2(-5)} = \\frac{1}{10}$。\n能观格拉姆矩阵为：\n$$\nW_{o,s} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{10} \\end{pmatrix}\n$$\n稳定子系统的汉克尔奇异值 (HSV)，记作 $\\sigma_i$，是 $W_{c,s} W_{o,s}$ 乘积的特征值的平方根。\n$$\nW_{c,s} W_{o,s} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{10} \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{10} \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{100} \\end{pmatrix}\n$$\n特征值为 $\\lambda(W_{c,s} W_{o,s}) = \\{1, \\frac{1}{100}\\}$。汉克尔奇异值为：\n$$\n\\sigma_1 = \\sqrt{1} = 1, \\quad \\sigma_2 = \\sqrt{\\frac{1}{100}} = \\frac{1}{10}\n$$\nHSV $\\sigma_1 = 1$ 与 $s=-2$ 处的稳定模态相关，而 $\\sigma_2 = \\frac{1}{10}$ 与 $s=-5$ 处的模态相关。由于 $\\sigma_1 \\gg \\sigma_2$，第一个稳定模态在能量上占主导地位。\n\n现在，我们必须论证为什么稳定部分已经是平衡的。如果一个实现的能达和能观格拉姆矩阵相等且为对角阵，即 $W_c = W_o = \\Sigma$（其中 $\\Sigma$ 是汉克尔奇异值的对角矩阵），则该实现称为平衡实现。对于我们的稳定子系统：\n$$\nW_{c,s} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{10} \\end{pmatrix}, \\quad W_{o,s} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{10} \\end{pmatrix}, \\quad \\Sigma_s = \\text{diag}(\\sigma_1, \\sigma_2) = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{10} \\end{pmatrix}\n$$\n我们观察到 $W_{c,s} = W_{o,s} = \\Sigma_s$。因此，稳定子系统 $(A_{ss}, B_s, C_s)$ 已经是一个平衡实现。这是系统处于模态坐标（对角的 $A_{ss}$）且每个模态的输入/输出向量分量相等（即 $|[B_s]_i| = |[C_s]_i|$）的直接结果。这样简化的好处是不需要进行平衡坐标变换。截断只需通过移除与最小 HSV 对应的状态即可实现。\n\n为了得到一个总阶数为2的降阶模型，我们必须保留阶数为1的不稳定模态，并将阶数为2的稳定子系统降至阶数为1。我们保留具有最大 HSV 的稳定模态（即第一个，$\\sigma_1=1$），并舍弃第二个（$\\sigma_2=\\frac{1}{10}$）。这意味着我们保留稳定子系统的第一个状态。\n降阶后的稳定子系统 $(\\hat{A}_{ss}, \\hat{B}_s, \\hat{C}_s)$ 通过取分块矩阵的左上角 $1 \\times 1$ 块构成：\n$$\n\\hat{A}_{ss} = -2, \\quad \\hat{B}_s = 2, \\quad \\hat{C}_s = 2\n$$\n最终的降阶模型 $(A_r, B_r, C_r)$ 通过将原始的不稳定部分与降阶后的稳定部分组合而成：\n$$\nA_r = \\begin{pmatrix} A_{uu} & 0 \\\\ 0 & \\hat{A}_{ss} \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & -2 \\end{pmatrix}\n$$\n$$\nB_r = \\begin{pmatrix} B_u \\\\ \\hat{B}_s \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}\n$$\n$$\nC_r = \\begin{pmatrix} C_u & \\hat{C}_s \\end{pmatrix} = \\begin{pmatrix} 3 & 2 \\end{pmatrix}\n$$\n这个降阶模型的传递函数 $G_r(s)$ 由 $C_r(sI - A_r)^{-1}B_r$ 给出：\n$$\nG_r(s) = \\begin{pmatrix} 3 & 2 \\end{pmatrix} \\begin{pmatrix} s-1 & 0 \\\\ 0 & s+2 \\end{pmatrix}^{-1} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}\n$$\n$$\nG_r(s) = \\begin{pmatrix} 3 & 2 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{s-1} & 0 \\\\ 0 & \\frac{1}{s+2} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\frac{3}{s-1} \\cdot 1 + \\frac{2}{s+2} \\cdot 2 = \\frac{3}{s-1} + \\frac{4}{s+2}\n$$\n为了验证不稳定极点及其留数的保留情况，我们计算原始传递函数 $G(s)$：\n$$\nG(s) = C(sI-A)^{-1}B = \\frac{3}{s-1} + \\frac{4}{s+2} + \\frac{1}{s+5}\n$$\n原始系统中不稳定极点 $s=1$ 处的留数为 $\\lim_{s \\to 1} (s-1)G(s) = 3$。\n降阶系统中不稳定极点 $s=1$ 处的留数为 $\\lim_{s \\to 1} (s-1)G_r(s) = 3$。\n不稳定极点及其留数被完全保留，符合预期。\n\n最后，我们将 $G_r(s)$ 表示为单个有理函数：\n$$\nG_r(s) = \\frac{3(s+2) + 4(s-1)}{(s-1)(s+2)} = \\frac{3s+6+4s-4}{s^2+s-2} = \\frac{7s+2}{s^2+s-2}\n$$\n这就是二阶降阶模型的传递函数。", "answer": "$$\\boxed{\\frac{7s+2}{s^{2}+s-2}}$$", "id": "2725571"}]}