{"hands_on_practices": [{"introduction": "第一个练习为计算MIMO系统的$H_{\\infty}$范数提供了一个平易近人的起点。通过分析简单的对角系统，你将能够专注于核心定义——频率上的峰值奇异值，并观察系统的无穷远点特性如何直接影响其$H_{\\infty}$范数。这个实践有助于建立关于系统传递函数结构与其峰值增益特性之间联系的直观认识[@problem_id:2745089]。", "problem": "考虑两个稳定的、实有理的、$2 \\times 2$ 多输入多输出 (MIMO) 传递矩阵函数 $G_1(s)$ 和 $G_2(s)$，其定义如下\n$$\nG_1(s) \\;=\\; \\begin{pmatrix}\n\\dfrac{1}{s+1}  0 \\\\\n0  \\dfrac{2}{s+2}\n\\end{pmatrix}, \n\\qquad\nG_2(s) \\;=\\; \\begin{pmatrix}\n2  0 \\\\\n0  1\n\\end{pmatrix} \\;+\\; \\begin{pmatrix}\n-\\dfrac{1}{s+1}  0 \\\\\n0  0\n\\end{pmatrix}.\n$$\n仅从复矩阵的诱导 $2$-范数和奇异值的基本定义出发，确定每个传递矩阵的哈代空间 $H_{\\infty}$ 范数。对于一个稳定的 $G$，该范数被理解为在所有实频率 $\\omega$ 上 $G(j\\omega)$ 的最大奇异值的上确界。明确指出该上确界是在有限频率下达到，还是仅在极限 $\\omega \\to \\infty$ 时趋近，并解释在每种情况下奇异值图（最大奇异值对 $\\omega$）上会出现的相应定性特征。将你的最终答案以单行矩阵的形式报告，其中包含两个 $H_{\\infty}$ 范数，顺序为 $\\|G_1\\|_{\\infty}$、$\\|G_2\\|_{\\infty}$。无需四舍五入。", "solution": "本题需要经过验证。\n\n**步骤 1：提取已知条件**\n- MIMO 传递矩阵 $G_1(s) = \\begin{pmatrix} \\frac{1}{s+1}  0 \\\\ 0  \\frac{2}{s+2} \\end{pmatrix}$。\n- MIMO 传递矩阵 $G_2(s) = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} + \\begin{pmatrix} -\\frac{1}{s+1}  0 \\\\ 0  0 \\end{pmatrix}$。\n- 矩阵是 $2 \\times 2$ 的、稳定的和实有理的。\n- 哈代空间 $H_{\\infty}$ 范数定义为 $\\|G\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} \\bar{\\sigma}(G(j\\omega))$，其中 $\\bar{\\sigma}$ 是最大奇异值。\n- 复矩阵 $M$ 的奇异值是 $M^*M$ 的特征值的平方根。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题建立在线性控制理论的既定框架内，涉及传递矩阵、频率响应、奇异值和 $H_{\\infty}$ 范数等标准概念。它在科学上是合理的。\n- **适定性：** 传递矩阵已明确给出。通过观察所有极点（$s=-1$，$s=-2$）都位于开左半复平面，可以确认其稳定性。目标是计算一个明确定义的范数，这很清晰。存在唯一解。\n- **客观性：** 问题使用精确的数学语言陈述，没有歧义或主观论断。\n\n**步骤 3：结论与行动**\n问题有效。将提供严谨的解答。\n\n任务是计算两个稳定传递矩阵 $G_1(s)$ 和 $G_2(s)$ 的 $H_{\\infty}$ 范数。稳定传递矩阵 $G(s)$ 的 $H_{\\infty}$ 范数定义为其最大奇异值在所有频率 $\\omega$ 上的上确界。\n$$\n\\|G\\|_{\\infty} = \\sup_{\\omega \\ge 0} \\bar{\\sigma}(G(j\\omega))\n$$\n由于 $G(s)$ 是实有理的，$\\bar{\\sigma}(G(-j\\omega)) = \\bar{\\sigma}(G(j\\omega))$，因此我们只需考虑 $\\omega \\in [0, \\infty)$。复矩阵 $M$ 的奇异值 $\\sigma_i$ 是埃尔米特半正定矩阵 $M^*M$ 的特征值的非负平方根。\n\n对于一个对角复矩阵 $D = \\text{diag}(d_1, d_2, \\dots, d_n)$，矩阵 $D^*D = \\text{diag}(|d_1|^2, |d_2|^2, \\dots, |d_n|^2)$。$D^*D$ 的特征值为 $|d_i|^2$，因此 $D$ 的奇异值就是其对角元素的绝对值 $|d_i|$。因此，最大奇异值为 $\\bar{\\sigma}(D) = \\max_i |d_i|$。\n\n$G_1(s)$ 和 $G_2(s)$ 都是对角矩阵。这个性质极大地简化了分析。对于一个对角传递矩阵 $G(s) = \\text{diag}(g_1(s), \\dots, g_n(s))$，其 $H_{\\infty}$ 范数是其对角元素 $H_{\\infty}$ 范数的最大值：\n$$\n\\|G\\|_{\\infty} = \\sup_{\\omega \\ge 0} \\bar{\\sigma}(G(j\\omega)) = \\sup_{\\omega \\ge 0} \\max_i |g_i(j\\omega)| = \\max_i \\left( \\sup_{\\omega \\ge 0} |g_i(j\\omega)| \\right) = \\max_i \\|g_i\\|_{\\infty}\n$$\n\n**对 $G_1(s)$ 的分析**\n传递矩阵为 $G_1(s) = \\begin{pmatrix} g_{11}(s)  0 \\\\ 0  g_{22}(s) \\end{pmatrix}$，其中 $g_{11}(s) = \\frac{1}{s+1}$ 且 $g_{22}(s) = \\frac{2}{s+2}$。\n我们计算每个对角元素的 $H_{\\infty}$ 范数。\n对于 $g_{11}(s)$:\n$$\n\\|g_{11}\\|_{\\infty} = \\sup_{\\omega \\ge 0} |g_{11}(j\\omega)| = \\sup_{\\omega \\ge 0} \\left| \\frac{1}{j\\omega+1} \\right| = \\sup_{\\omega \\ge 0} \\frac{1}{\\sqrt{\\omega^2+1}}\n$$\n函数 $f_1(\\omega) = \\frac{1}{\\sqrt{\\omega^2+1}}$ 在 $\\omega \\ge 0$ 时是单调递减函数。其最大值在 $\\omega=0$ 时达到，为 $f_1(0) = \\frac{1}{\\sqrt{0^2+1}} = 1$。因此，$\\|g_{11}\\|_{\\infty} = 1$。\n\n对于 $g_{22}(s)$:\n$$\n\\|g_{22}\\|_{\\infty} = \\sup_{\\omega \\ge 0} |g_{22}(j\\omega)| = \\sup_{\\omega \\ge 0} \\left| \\frac{2}{j\\omega+2} \\right| = \\sup_{\\omega \\ge 0} \\frac{2}{\\sqrt{\\omega^2+4}}\n$$\n函数 $f_2(\\omega) = \\frac{2}{\\sqrt{\\omega^2+4}}$ 在 $\\omega \\ge 0$ 时也是单调递减函数。其最大值在 $\\omega=0$ 时达到，为 $f_2(0) = \\frac{2}{\\sqrt{0^2+4}} = \\frac{2}{2} = 1$。因此，$\\|g_{22}\\|_{\\infty} = 1$。\n\n$G_1(s)$ 的 $H_{\\infty}$ 范数是这些单个范数的最大值：\n$$\n\\|G_1\\|_{\\infty} = \\max(\\|g_{11}\\|_{\\infty}, \\|g_{22}\\|_{\\infty}) = \\max(1, 1) = 1\n$$\n上确界在有限频率 $\\omega=0$ 处达到。在奇异值图上，两条奇异值曲线 $\\sigma_1(\\omega) = \\frac{1}{\\sqrt{\\omega^2+1}}$ 和 $\\sigma_2(\\omega) = \\frac{2}{\\sqrt{\\omega^2+4}}$ 都在 $\\omega=0$ 时从值 1 开始，并随着 $\\omega$ 的增加而减小。最大奇异值 $\\bar{\\sigma}(G_1(j\\omega))$ 的图像是这两条曲线的上包络线。它在 $\\omega=0$ 时从其最大值 1 开始，然后减小。这种行为是严格真分系统（其中当 $s \\to \\infty$ 时 $G(s) \\to 0$）的典型特征。\n\n**对 $G_2(s)$ 的分析**\n首先，我们简化 $G_2(s)$ 的表达式：\n$$\nG_2(s) = \\begin{pmatrix} 2 - \\frac{1}{s+1}  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{2(s+1)-1}{s+1}  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{2s+1}{s+1}  0 \\\\ 0  1 \\end{pmatrix}\n$$\n这是一个对角矩阵 $G_2(s) = \\begin{pmatrix} g'_{11}(s)  0 \\\\ 0  g'_{22}(s) \\end{pmatrix}$，其中 $g'_{11}(s) = \\frac{2s+1}{s+1}$ 且 $g'_{22}(s) = 1$。\n我们计算每个元素的 $H_{\\infty}$ 范数。\n对于 $g'_{11}(s)$:\n$$\n\\|g'_{11}\\|_{\\infty} = \\sup_{\\omega \\ge 0} |g'_{11}(j\\omega)| = \\sup_{\\omega \\ge 0} \\left| \\frac{2j\\omega+1}{j\\omega+1} \\right| = \\sup_{\\omega \\ge 0} \\frac{\\sqrt{1+4\\omega^2}}{\\sqrt{1+\\omega^2}} = \\sup_{\\omega \\ge 0} \\sqrt{\\frac{1+4\\omega^2}{1+\\omega^2}}\n$$\n设函数为 $h(\\omega) = \\sqrt{\\frac{1+4\\omega^2}{1+\\omega^2}}$。平方根内的项 $k(x) = \\frac{1+4x}{1+x}$（其中 $x=\\omega^2 \\ge 0$）可以写成 $k(x) = \\frac{4(1+x)-3}{1+x} = 4 - \\frac{3}{1+x}$。当 $x$ 从 $0$ 增加到 $\\infty$ 时，$k(x)$ 从 $k(0)=1$ 单调增加到其极限 $\\lim_{x\\to\\infty}k(x)=4$。因此，$h(\\omega)$ 在 $\\omega \\ge 0$ 时是单调递增函数。它从 $h(0)=1$ 开始，并随着 $\\omega \\to \\infty$ 趋近于极限 $\\sqrt{4}=2$。递增函数的上确界是其在无穷大处的极限。\n$$\n\\|g'_{11}\\|_{\\infty} = \\lim_{\\omega \\to \\infty} \\sqrt{\\frac{1+4\\omega^2}{1+\\omega^2}} = \\lim_{\\omega \\to \\infty} \\sqrt{\\frac{1/\\omega^2+4}{1/\\omega^2+1}} = \\sqrt{4} = 2\n$$\n对于 $g'_{22}(s)=1$:\n$$\n\\|g'_{22}\\|_{\\infty} = \\sup_{\\omega \\ge 0} |1| = 1\n$$\n$G_2(s)$ 的 $H_{\\infty}$ 范数是这些单个范数的最大值：\n$$\n\\|G_2\\|_{\\infty} = \\max(\\|g'_{11}\\|_{\\infty}, \\|g'_{22}\\|_{\\infty}) = \\max(2, 1) = 2\n$$\n该上确界不在任何有限频率下达到，而是在极限 $\\omega \\to \\infty$ 时趋近。在奇异值图上，一个奇异值恒为 $\\sigma_2(\\omega)=1$。另一个奇异值 $\\sigma_1(\\omega) = \\sqrt{\\frac{1+4\\omega^2}{1+\\omega^2}}$ 在 $\\omega=0$ 时从 1 开始，并单调递增，渐近地趋近于 2。因此，最大奇异值 $\\bar{\\sigma}(G_2(j\\omega))$ 的图像是一条从 1 开始并向 2 增加的曲线。上确界是 2，但永远不会达到。这种行为是真分但非严格真分系统的典型特征，意味着它有一个非零的直通项 $D = \\lim_{s \\to \\infty} G(s)$。此处，$D = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}$，且 $\\|G_2\\|_{\\infty} = \\bar{\\sigma}(D) = 2$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  2 \\end{pmatrix}}\n$$", "id": "2745089"}, {"introduction": "虽然回路传递函数的奇异值小通常暗示着稳定性，但这并非总是如此，特别是对于开环不稳定的系统。这个关键的练习提出了一个反例，挑战了小增益定理的简单应用，证明了当$L(s)$存在右半平面极点时，满足$\\bar{\\sigma}(L(j\\omega))  1$并不足以保证稳定性。它将引导你运用更强大的广义奈奎斯特准则来正确评估闭环稳定性，这是鲁棒控制中的一项关键技能[@problem_id:2745053]。", "problem": "考虑以下用于负反馈互联的严格真、有理、方形、双输入/双输出回路传递矩阵：\n$$\nL(s) \\;=\\;\n\\begin{pmatrix}\n\\frac{1}{2}\\,\\frac{1}{s-1}  0 \\\\\n0  0\n\\end{pmatrix}.\n$$\n回差矩阵定义为 $I+L(s)$，闭环极点与 $\\det(I+L(s))$ 在复平面中的零点重合。仅使用基本定义和成熟理论（例如奇异值的定义、回差以及用于矩阵回路的广义奈奎斯特定理），完成以下任务：\n\n- 从奇异值的定义出发，确定 $\\sup_{\\omega \\in \\mathbb{R}} \\bar{\\sigma}(L(j\\omega))$ 并验证其严格小于 $1$。\n\n- 使用回差矩阵 $I+L(s)$ 及其行列式作为广义奈奎斯特测试的标量映射，确定开右半平面中闭环极点的数量 $Z$。请从基本原理出发：确定 $L(s)$ 在开右半平面中的开环极点数量 $P$ 和标准奈奎斯特围线在 $\\det(I+L(s))$ 映射下关于原点的像的奈奎斯特绕数 $N$，然后通过广义奈奎斯特定理将 $Z$、$P$ 和 $N$ 关联起来。\n\n你的最终答案必须是单个数字 $Z$（无单位）。不要提供任何中间值。无需四舍五入。", "solution": "所述问题具有科学依据、提法合理且客观。这是多输入多输出（MIMO）控制理论中的一个标准问题，它使用两种基本方法来解决系统稳定性问题：奇异值分析和广义奈奎斯特判据。所有提供的数据和定义都与既有原理一致。该问题是有效的，并且可以求解。\n\n按要求，分析分为两部分。\n\n首先，我们确定频率响应矩阵 $L(j\\omega)$ 的最大奇异值的上确界。\n回路传递矩阵为\n$$\nL(s) = \\begin{pmatrix} \\frac{1}{2(s-1)}  0 \\\\ 0  0 \\end{pmatrix}\n$$\n频率响应通过代入 $s=j\\omega$（其中 $\\omega \\in \\mathbb{R}$）得到。\n$$\nL(j\\omega) = \\begin{pmatrix} \\frac{1}{2(j\\omega-1)}  0 \\\\ 0  0 \\end{pmatrix}\n$$\n矩阵 $A$ 的奇异值，记为 $\\sigma_i(A)$，定义为矩阵乘积 $A^H A$ 的特征值的平方根，其中 $A^H$ 是 $A$ 的共轭转置。这里，$A = L(j\\omega)$。\n首先，我们求共轭转置 $L(j\\omega)^H$：\n$$\nL(j\\omega)^H = \\begin{pmatrix} \\frac{1}{2(j\\omega-1)}  0 \\\\ 0  0 \\end{pmatrix}^H = \\begin{pmatrix} \\overline{\\left(\\frac{1}{2(j\\omega-1)}\\right)}  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2(-j\\omega-1)}  0 \\\\ 0  0 \\end{pmatrix}\n$$\n接下来，我们计算乘积 $L(j\\omega)^H L(j\\omega)$：\n$$\nL(j\\omega)^H L(j\\omega) = \\begin{pmatrix} \\frac{1}{2(-j\\omega-1)}  0 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2(j\\omega-1)}  0 \\\\ 0  0 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} \\frac{1}{4(-j\\omega-1)(j\\omega-1)}  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4(-(-(j\\omega)^2) - (-1)^2)}  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4(\\omega^2+1)}  0 \\\\ 0  0 \\end{pmatrix}\n$$\n这个对角矩阵的特征值 $\\lambda$ 是其对角线元素：$\\lambda_1 = \\frac{1}{4(\\omega^2+1)}$ 和 $\\lambda_2 = 0$。\n$L(j\\omega)$ 的奇异值为 $\\sigma_1 = \\sqrt{\\lambda_1} = \\sqrt{\\frac{1}{4(\\omega^2+1)}} = \\frac{1}{2\\sqrt{\\omega^2+1}}$ 和 $\\sigma_2 = \\sqrt{\\lambda_2} = 0$。\n最大奇异值，记为 $\\bar{\\sigma}$，是这些值中最大的一个。\n$$\n\\bar{\\sigma}(L(j\\omega)) = \\max\\left(\\frac{1}{2\\sqrt{\\omega^2+1}}, 0\\right) = \\frac{1}{2\\sqrt{\\omega^2+1}}\n$$\n我们需要对所有 $\\omega \\in \\mathbb{R}$ 求此函数的上确界：\n$$\n\\sup_{\\omega \\in \\mathbb{R}} \\bar{\\sigma}(L(j\\omega)) = \\sup_{\\omega \\in \\mathbb{R}} \\frac{1}{2\\sqrt{\\omega^2+1}}\n$$\n当分母最小时，该函数达到最大值。项 $\\omega^2+1$ 在 $\\omega=0$ 时有最小值 $1$。因此，上确界在 $\\omega=0$ 时达到。\n$$\n\\sup_{\\omega \\in \\mathbb{R}} \\bar{\\sigma}(L(j\\omega)) = \\frac{1}{2\\sqrt{0^2+1}} = \\frac{1}{2}\n$$\n我们必须验证该值严格小于 $1$。确实，$\\frac{1}{2}  1$。这完成了问题的第一部分。必须注意，小增益定理要求开环系统是稳定的，才能通过此条件保证闭环稳定性。在此问题中，$L(s)$ 在 $s=1$ 处有一个极点，因此开环系统是不稳定的，小增益定理不适用。\n\n第二，我们使用广义奈奎斯特定理来确定开右半平面 (ORHP) 中的闭环极点数。不稳定闭环极点的数量 $Z$，等于 $\\det(I+L(s))$ 在 ORHP 中的零点数量。\n广义奈奎斯特定理（或辐角原理）指出 $Z = P + N$，其中 $P$ 是 $\\det(I+L(s))$ 在 ORHP 中的极点数量，而 $N$ 是 $\\det(I+L(s))$ 的奈奎斯特图绕原点的逆时针 (CCW) 圈数。\n\n首先，我们计算特征函数 $g(s) = \\det(I+L(s))$：\n$$\nI+L(s) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\begin{pmatrix} \\frac{1}{2(s-1)}  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1 + \\frac{1}{2(s-1)}  0 \\\\ 0  1 \\end{pmatrix}\n$$\n$$\ng(s) = \\det(I+L(s)) = 1 \\cdot \\left(1 + \\frac{1}{2(s-1)}\\right) = \\frac{2(s-1)+1}{2(s-1)} = \\frac{2s-1}{2s-2}\n$$\n为了求出 $P$，我们找出 $g(s)$ 在 ORHP 中的极点。极点是分母 $2s-2=0$ 的根，这给出了一个位于 $s=1$ 的单极点。因为 $1 > 0$，所以该极点在 ORHP 中。因此，$P=1$。\n\n为了求出 $N$，我们通过映射标准奈奎斯特D形围线来构建 $g(s)$ 的奈奎斯特图。此围线包围整个ORHP。它由从 $s=-j\\infty$ 到 $s=+j\\infty$ 的虚轴和 RHP 中半径 $R \\to \\infty$ 的一个大半圆组成。\n1.  映射虚轴，$s=j\\omega$ 对于 $\\omega \\in (-\\infty, \\infty)$：\n    $$\n    g(j\\omega) = \\frac{2j\\omega-1}{2j\\omega-2} = \\frac{1}{2} \\cdot \\frac{1-2j\\omega}{1-j\\omega}\n    $$\n    我们求出实部和虚部：\n    $$\n    g(j\\omega) = \\frac{1}{2} \\frac{(1-2j\\omega)(1+j\\omega)}{(1-j\\omega)(1+j\\omega)} = \\frac{1}{2} \\frac{1-j\\omega+2\\omega^2}{1+\\omega^2} = \\frac{1+2\\omega^2}{2(1+\\omega^2)} + j \\frac{-\\omega}{2(1+\\omega^2)}\n    $$\n    令 $x = \\text{Re}[g(j\\omega)]$ 且 $y = \\text{Im}[g(j\\omega)]$。可以证明，这些坐标满足一个圆的方程：$(x - \\frac{3}{4})^2 + y^2 = (\\frac{1}{4})^2$。这是一个圆心在 $(\\frac{3}{4}, 0)$、半径为 $\\frac{1}{4}$ 的圆。\n    当 $\\omega=0$ 时，$g(0) = \\frac{-1}{-2} = \\frac{1}{2}$。这对应于点 $(\\frac{1}{2}, 0)$。\n    当 $\\omega \\to \\pm\\infty$ 时，$g(j\\omega) \\to \\frac{2j\\omega}{2j\\omega} = 1$。这对应于点 $(1, 0)$。\n    当 $\\omega$ 从 $-\\infty$ 变化到 $+\\infty$，$g(j\\omega)$ 的点顺时针遍历此圆，从 $(1,0)$ 开始，经过 $(\\frac{1}{2},0)$，然后返回到 $(1,0)$。\n2.  映射大半圆，$s = R e^{j\\theta}$ 对于 $R\\to\\infty$ 和 $\\theta \\in [\\frac{\\pi}{2}, -\\frac{\\pi}{2}]$：\n    当 $|s| \\to \\infty$ 时，$g(s) = \\frac{2s-1}{2s-2} \\approx \\frac{2s}{2s} = 1$。整个大半圆映射到单一点 $(1,0)$。\n\n$g(s)$ 的完整奈奎斯特图是一个圆心在 $(\\frac{3}{4}, 0)$、半径为 $\\frac{1}{4}$ 的圆。该圆离原点的最小距离在点 $(\\frac{1}{2},0)$ 处。由于整个围线位于 RHP 中且不包含原点，因此绕原点的圈数为零。因此，$N=0$。\n\n最后，我们应用公式 $Z = P + N$：\n$$\nZ = 1 + 0 = 1\n$$\n在开右半平面中有 $1$ 个闭环极点。这可以通过直接求 $g(s) = \\frac{2s-1}{2s-2}$ 的零点来验证，其零点在 $s=\\frac{1}{2}$。由于 $\\frac{1}{2} > 0$，确实存在一个不稳定的闭环极点。计算结果是一致的。", "answer": "$$\\boxed{1}$$", "id": "2745053"}, {"introduction": "奇异值分析不仅用于稳定性判断，它也是一个量化闭环性能的强大工具。这个动手编程实践将指导你计算灵敏度函数$S(s)$的奇异值，该奇异值衡量了MIMO系统抑制干扰的能力。通过比较包含与不包含非最小相位特性（如时间延迟）的被控对象，你将具体理解这些要素如何对系统可实现的性能施加根本性的限制[@problem_id:2745127]。", "problem": "给定一个连续时间、线性时不变、双输入双输出（2x2）的反馈回路，其被控对象传递矩阵为 $G(s)$，控制器传递矩阵为 $K(s)$，其（闭环）灵敏度函数定义为 $S(s) = (I + L(s))^{-1}$，其中 $L(s) = G(s)K(s)$，$I$ 是 $2 \\times 2$ 单位矩阵。对于每个实频率 $\\omega \\ge 0$，灵敏度频率响应为 $S(j\\omega)$，其奇异值 $\\sigma_i(S(j\\omega))$（其中 $i \\in \\{1,2\\}$）定义为 $S(j\\omega)^* S(j\\omega)$ 特征值的非负平方根，其中 $^*$ 表示共轭转置。在此问题中，您将计算一个频率网格上的 $\\sigma_i(S(j\\omega))$，并识别出由于非最小相位特性（特别是纯时间延迟）而导致灵敏度降低在根本上不可能实现的频率区域。时间延迟被视为一种非最小相位特性，因为它在幅值为单位的同时，引入了一个与频率相关的相位滞后 $-\\omega \\tau$，并且它对可实现的闭环带宽施加了经过充分验证的限制。\n\n您将获得三个测试用例。每个用例都指定了一个被控对象 $G(s)$，并共用一个控制器 $K(s)$：\n- 控制器（所有用例通用）：$K(s) = \\operatorname{diag}(K_{11}(s), K_{22}(s))$，其中 $K_{11}(s) = 5\\,\\dfrac{s + 2}{s}$ 且 $K_{22}(s) = 4\\,\\dfrac{s + 1}{s}$。\n\n对于每个用例，定义 $s = j\\omega$，其中 $\\omega$ 的单位为弧度/秒，在一个网格 $\\omega \\in \\{\\omega_k\\}_{k=1}^N$ 上采样，其中 $N = 500$，$\\omega_1 = 10^{-2}$，$\\omega_N = 10^2$，且为对数间隔。\n\n用例 A（最小相位，无延迟）：\n- $G_{11}(s) = \\dfrac{1}{(s + 1)(s + 3)}$，$G_{12}(s) = \\dfrac{0.3}{s + 2}$，\n- $G_{21}(s) = \\dfrac{0.5}{s + 2}$，$G_{22}(s) = \\dfrac{2}{(s + 1)(s + 4)}$。\n\n用例 B（一个通道中存在右半平面零点，无延迟）：\n- $G_{11}(s) = \\dfrac{s - 1}{(s + 2)(s + 3)}$，$G_{12}(s) = \\dfrac{0.3}{s + 2}$，\n- $G_{21}(s) = \\dfrac{0.5}{s + 2}$，$G_{22}(s) = \\dfrac{2}{(s + 1)(s + 4)}$。\n\n用例 C（一个通道中存在时间延迟）：\n- $G_{11}(s) = \\dfrac{1}{(s + 1)(s + 3)}$，$G_{12}(s) = \\dfrac{0.3}{s + 2}$，\n- $G_{21}(s) = \\dfrac{0.5}{s + 2}$，$G_{22}(s) = e^{-0.25 s}\\,\\dfrac{2}{(s + 1)(s + 4)}$。\n\n任务：\n1) 对于每个用例，计算网格上所有 $\\omega_k$ 对应的 $S(j\\omega_k)$，并为每个 $\\omega_k$ 计算奇异值 $\\sigma_1(S(j\\omega_k))$ 和 $\\sigma_2(S(j\\omega_k))$。\n2) 识别出由于纯时间延迟这种非最小相位特性而导致灵敏度降低在根本上不可能实现的频率区域。使用以下经过充分验证的工程事实作为基本依据：对于反馈回路中 $\\tau$ 秒的纯输入输出延迟，可实现的闭环带宽被保守地限制在 $\\omega_b \\tau  \\dfrac{\\pi}{2}$ 之内，这意味着试图将 $S(j\\omega)$ 在 $\\omega \\approx \\dfrac{\\pi}{2\\tau}$ 之外保持较小值是根本不可行的，因为延迟引起的相位滞后 $-\\omega\\tau$ 排除了大环路增益下足够的相位裕度。对于每个用例，求出所有有延迟的通道对应的禁止频率半线 $[\\dfrac{\\pi}{2\\tau}, +\\infty)$（单位：弧度/秒）的并集。如果某个用例没有延迟，则由延迟引起的禁止区域为空。\n3) 对于每个用例，返回一个标量：即基于延迟的禁止区域的起始最小频率 $\\omega_{\\text{forbid}}$（单位：弧度/秒）。如果禁止区域为空，则返回 $-1.0$。\n\n频率单位说明：所有频率都必须以弧度/秒为单位处理。\n\n您的程序应生成单行输出，包含一个含有三个浮点数的列表 $[\\omega_{\\text{forbid}}^{(A)}, \\omega_{\\text{forbid}}^{(B)}, \\omega_{\\text{forbid}}^{(C)}]$，分别对应于用例 A、B 和 C。如果某个用例没有基于延迟的禁止区域，则使用 $-1.0$。输出必须格式化为单个 Python 列表字面量，元素之间用逗号分隔，并位于同一行。\n\n测试套件：\n- 用例 A：最小相位被控对象，无延迟。预期没有基于延迟的禁止区域。\n- 用例 B：被控对象带有右半平面零点，无延迟。预期没有基于延迟的灵敏度禁止区域。\n- 用例 C：被控对象在 $G_{22}(s)$ 中存在纯时间延迟 $\\tau = 0.25$ 秒，因此存在一个始于 $\\omega = \\dfrac{\\pi}{2\\tau}$ 的基于延迟的禁止区域。\n\n注意：计算核心必须实现对每个用例在频率网格上 $G(j\\omega)$、$K(j\\omega)$、$S(j\\omega)$ 以及奇异值 $\\sigma_i(S(j\\omega))$ 的求值。这些值不直接打印，但必须作为求解过程的一部分进行计算。最终输出必须是包含三个所要求的浮点数结果的单行，单位为弧度/秒。", "solution": "该问题陈述已经过验证，且被认定为有效。其科学基础在于线性多变量控制理论的原理，问题提法得当，提供了所有必要信息，并且其表述客观。该问题要求分析一个多输入多输出 (MIMO) 反馈系统，并理解由非最小相位特性（特别是时间延迟）所施加的性能限制。\n\n所考虑的系统是一个 $2 \\times 2$ 的反馈回路，其被控对象为 $G(s)$，控制器为 $K(s)$。环路传递函数为 $L(s) = G(s)K(s)$，灵敏度函数为 $S(s) = (I + L(s))^{-1}$，其中 $I$ 是 $2 \\times 2$ 单位矩阵。当在频率 $s=j\\omega$ 处求值时，灵敏度函数的大小表明了反馈系统在该频率下抑制扰动和跟踪参考信号的能力。对于 MIMO 系统，这由灵敏度矩阵的奇异值 $\\sigma_i(S(j\\omega))$ 来表征。小的奇异值（$\\sigma_i \\ll 1$）表示性能良好（灵敏度降低），而大的奇异值（$\\sigma_i \\ge 1$）表示性能不佳，甚至扰动放大（灵敏度增加）。\n\n反馈控制中的一个基本原理是，开环传递函数 $L(s)$ 中的非最小相位元素会对可达到的性能施加限制。这些元素包括右半平面 (RHP) 零点和时间延迟。时间延迟项 $e^{-s\\tau}$ 对所有实频率 $\\omega$ 其幅值为 $1$（因为 $|e^{-j\\omega\\tau}|=1$），但引入一个相位滞后 $-\\omega\\tau$，该相位滞后随频率线性增长。如果环路增益不衰减，这种相位滞后最终会在高频处使反馈回路不稳定，从而限制了可实现的闭环带宽。\n\n该问题要求一个分为两部分的过程。首先，它强制要求在指定的频率网格上计算灵敏度矩阵 $S(j\\omega)$ 及其奇异值。其次，它要求识别一个“禁止”频率区域，该区域基于一个与时间延迟相关的特定给定规则：一个 $\\tau$ 秒的纯时间延迟在频率区域 $[\\frac{\\pi}{2\\tau}, +\\infty)$ 内施加了一个根本的性能限制。每个用例的最终输出是在该频率处，基于延迟的禁止区域开始的最低频率，记为 $\\omega_{\\text{forbid}}$。如果没有时间延迟，这个区域为空，结果应报告为 $-1.0$。\n\n让我们按规定分析每个用例。控制器对所有用例是通用的：\n$$ K(s) = \\begin{pmatrix} K_{11}(s)  0 \\\\ 0  K_{22}(s) \\end{pmatrix} = \\begin{pmatrix} 5\\,\\dfrac{s + 2}{s}  0 \\\\ 0  4\\,\\dfrac{s + 1}{s} \\end{pmatrix} $$\n分析将逐个用例进行。\n\n用例 A：最小相位被控对象。\n被控对象传递矩阵 $G(s)$ 由下式给出：\n$$ G(s) = \\begin{pmatrix} \\dfrac{1}{(s + 1)(s + 3)}  \\dfrac{0.3}{s + 2} \\\\ \\dfrac{0.5}{s + 2}  \\dfrac{2}{(s + 1)(s + 4)} \\end{pmatrix} $$\n$G(s)$ 所有元素的全部极点和零点都在复平面的左半部分，并且没有形如 $e^{-s\\tau}$ 的时间延迟项。因此，该系统是最小相位的。根据问题的指令，该指令专门关注由*时间延迟*引起的限制，由延迟引起的禁止频率区域为空。\n因此，对于此用例，$\\omega_{\\text{forbid}}^{(A)} = -1.0$。\n\n用例 B：带有右半平面 (RHP) 零点的被控对象。\n被控对象传递矩阵 $G(s)$ 为：\n$$ G(s) = \\begin{pmatrix} \\dfrac{s - 1}{(s + 2)(s + 3)}  \\dfrac{0.3}{s + 2} \\\\ \\dfrac{0.5}{s + 2}  \\dfrac{2}{(s + 1)(s + 4)} \\end{pmatrix} $$\n元素 $G_{11}(s)$ 在 $s = +1$ 处有一个零点，该零点位于 RHP。这个 RHP 零点是一个非最小相位特性，并如 Bode 灵敏度积分所描述的那样，施加了一个根本的性能限制。然而，问题明确指示*仅*基于纯时间延迟的存在，使用所提供的公式来识别禁止区域。由于该被控对象没有时间延迟项 $e^{-s\\tau}$，基于延迟的禁止区域为空。RHP 零点的存在与所提的具体问题无关。\n因此，对于此用例，$\\omega_{\\text{forbid}}^{(B)} = -1.0$。\n\n用例 C：带有时间延迟的被控对象。\n被控对象传递矩阵 $G(s)$ 为：\n$$ G(s) = \\begin{pmatrix} \\dfrac{1}{(s + 1)(s + 3)}  \\dfrac{0.3}{s + 2} \\\\ \\dfrac{0.5}{s + 2}  e^{-0.25 s}\\,\\dfrac{2}{(s + 1)(s + 4)} \\end{pmatrix} $$\n元素 $G_{22}(s)$ 包含一个时间延迟项 $e^{-0.25s}$，对应于 $\\tau = 0.25$ 秒的延迟。根据问题陈述中提供的规则，此延迟产生了一个用于灵敏度降低的禁止频率区域，起始于 $\\omega = \\frac{\\pi}{2\\tau}$。系统中没有其他时间延迟。\n该区域的起始频率计算如下：\n$$ \\omega_{\\text{forbid}}^{(C)} = \\frac{\\pi}{2 \\times 0.25} = \\frac{\\pi}{0.5} = 2\\pi $$\n以弧度/秒为单位，该值约为 $6.283$。\n\n计算实现将涉及在指定的频率网格上对复数矩阵 $G(j\\omega)$ 和 $K(j\\omega)$ 求值，计算 $L(j\\omega)$ 和 $S(j\\omega)$，并按照任务 1 的要求执行 $S(j\\omega)$ 的奇异值分解。然后通过应用上述为每个用例推导出的简单规则来确定最终结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the start of the delay-based forbidden frequency region for three\n    MIMO control system test cases.\n    \"\"\"\n    # Define problem parameters: frequency grid and identity matrix.\n    N = 500\n    omega = np.logspace(-2, 2, N)\n    s = 1j * omega\n    I = np.identity(2)\n\n    # --- Common Controller K(s) ---\n    # The controller is diagonal and common to all cases.\n    # We create a stack of 500 2x2 matrices, one for each frequency point.\n    K = np.zeros((N, 2, 2), dtype=complex)\n    K[:, 0, 0] = 5 * (s + 2) / s\n    K[:, 1, 1] = 4 * (s + 1) / s\n\n    def compute_sensitivity_svd(G_matrix):\n        \"\"\"\n        Performs the core computation as required by Task 1:\n        Calculates the loop transfer matrix L(jw), the sensitivity matrix S(jw),\n        and its singular values over the frequency grid.\n        \n        Args:\n            G_matrix: A (N, 2, 2) array of plant frequency responses.\n\n        Returns:\n            A (N, 2) array of singular values of S(jw).\n        \"\"\"\n        # L(jw) = G(jw)K(jw)\n        # The @ operator handles the stacked matrix multiplication correctly.\n        L = G_matrix @ K\n        # S(jw) = (I + L(jw))^-1\n        S = np.linalg.inv(I + L)\n        # Compute singular values of S(jw)\n        singular_values = np.linalg.svd(S, compute_uv=False)\n        return singular_values\n\n    results = []\n\n    # --- Case A: Minimum-phase plant, no delays ---\n    G_A = np.zeros((N, 2, 2), dtype=complex)\n    G_A[:, 0, 0] = 1 / ((s + 1) * (s + 3))\n    G_A[:, 0, 1] = 0.3 / (s + 2)\n    G_A[:, 1, 0] = 0.5 / (s + 2)\n    G_A[:, 1, 1] = 2 / ((s + 1) * (s + 4))\n    \n    # Task 1: Compute SVD as required, though not used in final answer.\n    _ = compute_sensitivity_svd(G_A)\n    \n    # Task 2  3: Determine omega_forbid. No delays are present.\n    omega_forbid_A = -1.0\n    results.append(omega_forbid_A)\n\n    # --- Case B: Plant with RHP zero, no delays ---\n    G_B = np.zeros((N, 2, 2), dtype=complex)\n    G_B[:, 0, 0] = (s - 1) / ((s + 2) * (s + 3))\n    G_B[:, 0, 1] = G_A[:, 0, 1]  # Reuse from Case A\n    G_B[:, 1, 0] = G_A[:, 1, 0]  # Reuse from Case A\n    G_B[:, 1, 1] = G_A[:, 1, 1]  # Reuse from Case A\n\n    # Task 1: Compute SVD as required.\n    _ = compute_sensitivity_svd(G_B)\n\n    # Task 2  3: Determine omega_forbid. No time delays are present.\n    # The RHP zero is ignored per the problem's specific instruction.\n    omega_forbid_B = -1.0\n    results.append(omega_forbid_B)\n\n    # --- Case C: Plant with time delay ---\n    tau_C = 0.25\n    G_C = np.zeros((N, 2, 2), dtype=complex)\n    G_C[:, 0, 0] = G_A[:, 0, 0]  # Reuse from Case A\n    G_C[:, 0, 1] = G_A[:, 0, 1]  # Reuse from Case A\n    G_C[:, 1, 0] = G_A[:, 1, 0]  # Reuse from Case A\n    G_C[:, 1, 1] = np.exp(-tau_C * s) * (2 / ((s + 1) * (s + 4)))\n\n    # Task 1: Compute SVD as required.\n    _ = compute_sensitivity_svd(G_C)\n\n    # Task 2  3: Determine omega_forbid. A time delay tau = 0.25s is present.\n    omega_forbid_C = np.pi / (2 * tau_C)\n    results.append(omega_forbid_C)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2745127"}]}