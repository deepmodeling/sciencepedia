{"hands_on_practices": [{"introduction": "要稳定一个不稳定系统，我们需要多少信息？这个问题是量化控制理论的核心。本练习将引导你通过一个基本思想实验，从第一性原理出发，推导稳定一个简单线性系统所需的最小数据率。你将通过分析量化如何减小不确定性，而系统动态如何扩大不确定性，来揭示稳定性的信息论基础。[@problem_id:2696298]", "problem": "考虑一个通过有限速率数字信道进行全状态感知的标量离散时间系统：\n$$x_{k+1} = a\\,x_k + u_k,$$\n其中 $a = \\exp(\\alpha T)$，$\\alpha > 0$ 且采样周期 $T > 0$。在每个采样时刻 $k$，控制器接收一个 $R$ 比特的消息，该消息描述了 $x_k$ 的一个量化版本。这个量化版本由一个具有 $2^{R}$ 个量化区间的均匀中升标量量化器产生，该量化器将时刻 $k$ 时 $x_k$ 的一个已知的对称容许值区间进行划分。该量化器具有一个动态可调的范围，该范围对编码器和解码器均为已知（即所谓的变焦量化）。数字信道被假定为无噪声且无延迟的。控制器将 $u_k$ 应用为所接收到的 $R$ 比特消息及所有过去信息的任意函数；系统没有输入约束，也没有扰动。\n\n从均匀量化如何缩减不确定性集合以及开环动力学如何扩大这些集合的基本原理出发，推导最小实数 $R^{\\star}$，使得存在一个编码/解码/控制策略，能保证当 $k \\to \\infty$ 时 $x_k \\to 0$。将您的答案以比特/样本为单位，表示为仅含 $\\alpha$ 和 $T$ 的闭式表达式。不要取整；给出精确的符号表达式。", "solution": "我们从离散时间系统的定义开始\n$$x_{k+1} = a\\,x_k + u_k,$$\n其中 $a = \\exp(\\alpha T)$ 且 $\\alpha > 0$，因此 $|a| = \\exp(\\alpha T) > 1$。该系统在离散时间上是开环不稳定的。在每个采样时刻，控制器接收一个由具有动态范围调整功能的均匀标量量化器产生的关于 $x_k$ 的 $R$ 比特描述。我们将通过不确定性集合及其直径进行推理。\n\n定义 $D_k \\ge 0$ 为在时刻 $k$ 量化之前，编码器和解码器均已知的、保证包含真实状态 $x_k$ 的最小区间的直径（长度）。具有 $2^R$ 个量化区间的均匀量化器将该区间划分为 $2^R$ 个相等的子区间。在传输了区间索引后，编码器和解码器都知道 $x_k$ 位于选定的子区间内，其直径为\n$$d_k = \\frac{D_k}{2^R}.$$\n因此，量化使状态不确定性直径从 $D_k$ 减小到 $d_k$，减小了一个因子 $2^{-R}$。\n\n现在我们考虑控制作用和系统传播。设 $\\hat{x}_k$ 为在控制器处的重构值，取自量化后子区间中的任意一点（例如，其中点）。选择一个确定性等效控制律，旨在使用重构值来抵消标称系统状态：\n$$u_k = -a\\,\\hat{x}_k.$$\n代入系统中得到\n$$x_{k+1} = a\\,x_k + u_k = a\\,(x_k - \\hat{x}_k).$$\n定义重构误差 $e_k = x_k - \\hat{x}_k$。因为已知 $x_k$ 位于一个包含 $\\hat{x}_k$ 且直径为 $d_k$ 的区间内，我们有如下确定性界\n$$|e_k| \\le \\frac{d_k}{2}.$$\n因此，在给定控制器在时刻 $k$ 可用的所有信息的情况下，$x_{k+1}$ 的可能值集合是通过映射 $x_{k+1} = a\\,e_k$ 传播误差得到的。因此，在时刻 $k+1$ 的量化前不确定性直径为\n$$D_{k+1} = |a|\\,d_k = |a|\\,\\frac{D_k}{2^R}.$$\n\n这个关于一个采样周期内不确定性直径的递推关系捕捉了两个基本效应：$R$ 比特均匀量化器将直径缩小 $2^R$ 倍，而开环系统动力学将其扩大 $|a|$ 倍。渐近镇定的一个必要条件是（而且，正如我们将展示的，通过上述动态量化和控制，这也是一个充分条件），不确定性直径平均而言是收缩的，即，\n$$\\frac{D_{k+1}}{D_k} = \\frac{|a|}{2^R} < 1.$$\n等价地，\n$$2^R > |a| \\quad \\Longleftrightarrow \\quad R > \\log_{2}(|a|).$$\n\n充分性是成立的，因为当 $|a|/2^R < 1$ 时，直径满足\n$$D_{k+1} = \\left(\\frac{|a|}{2^R}\\right) D_k,$$\n因此 $D_k$ 呈几何级数衰减至零。由于控制器使用 $u_k = -a\\,\\hat{x}_k$ 且 $x_{k+1} = a\\,e_k$，其中 $|e_k| \\le d_k/2 = D_k/(2^{R+1})$，我们有 $|x_{k+1}| \\le |a|\\, D_k/(2^{R+1})$，当 $k \\to \\infty$ 时，该式也收敛于零。这就证明了只要 $R > \\log_2(|a|)$，就存在一个编码/解码/控制策略能保证 $x_k \\to 0$。\n\n因此，最小速率阈值（在可达速率的下确界的意义上）是\n$$R^{\\star} = \\log_2(|a|).$$\n代入 $a = \\exp(\\alpha T)$ 并使用换底公式 $\\log_2(\\exp(z)) = z / \\ln(2)$，我们得到\n$$R^{\\star} = \\log_2\\!\\big(\\exp(\\alpha T)\\big) = \\frac{\\alpha T}{\\ln(2)}.$$\n\n该式为最小每样本比特数的精确闭式表达式，对于给定的采用均匀变焦量化的标量系统，严格超过此比特数可保证存在一个镇定的编码与控制策略。", "answer": "$$\\boxed{\\frac{\\alpha T}{\\ln(2)}}$$", "id": "2696298"}, {"introduction": "从理论极限转向实际应用，控制器设计必须考虑物理和性能约束。本练习提供了一个联合设计问题，挑战你同时设计反馈增益 $K$ 和量化器动态范围 $M$。你的目标是确保系统状态不仅收敛，而且在整个过程中始终保持在量化器的非饱和区内，最终进入一个预定的目标区域。[@problem_id:2696241]", "problem": "考虑一个标量离散时间系统，通过一个均匀中升型量化器实现全状态反馈：\n$$x_{k+1} = a\\,x_k + b\\,u_k,$$\n其控制律为\n$$u_k = K\\,\\hat{x}_k,$$\n其中 $\\hat{x}_k$ 是 $x_k$ 的量化测量值。量化器是对称、中升型、均匀的，在区间 $[-M,M]$ 上有 $L$ 个等间距的输出电平，并在该区间外饱和。因此，量化步长为 $\\Delta = \\frac{2M}{L}$，并且在不发生饱和的情况下，量化误差 $e_k := \\hat{x}_k - x_k$ 满足 $|e_k| \\leq \\frac{\\Delta}{2} = \\frac{M}{L}$。\n\n给定以下参数：\n- $a = 2$，\n- $b = 1$，\n- $L = 30$，\n- 初始界限 $|x_0| \\leq X_0$，其中 $X_0 = 5$，\n- 以及目标球半径 $r = 0.5$（在 $\\mathbb{R}$ 中，即为区间 $[-r,r]$）。\n\n请仅使用线性时不变差分方程、诱导范数和所述量化器模型的基本性质，设计一个标量反馈增益 $K \\in \\mathbb{R}$ 和最小的动态范围 $M > 0$，使得：\n1) 量化器在任何时候都不饱和（即，对所有 $k \\geq 0$，有 $|x_k| \\leq M$），并且\n2) 轨迹进入目标球，即存在某个有限的 $k_0$，使得对所有 $k \\geq k_0$，有 $|x_k| \\leq r$。\n\n将你的最终答案表示为行向量 $\\begin{pmatrix}K & M\\end{pmatrix}$。最终答案中不允许包含任何额外文本。不需要单位。无需四舍五入；请给出精确值。", "solution": "将控制律代入系统方程，得到闭环系统动力学。\n$$x_{k+1} = a\\,x_k + b\\,(K\\,\\hat{x}_k)$$\n我们将量化状态 $\\hat{x}_k$ 用真实状态 $x_k$ 和量化误差 $e_k$ 表示为 $\\hat{x}_k = x_k + e_k$。\n$$x_{k+1} = a\\,x_k + b\\,K\\,(x_k + e_k) = (a+bK)\\,x_k + bKe_k$$\n这是一个由有界扰动项 $bKe_k$ 驱动的线性时不变差分方程。令 $\\lambda = a+bK$。\n$$x_{k+1} = \\lambda x_k + bKe_k$$\n\n为使状态 $x_k$ 收敛到原点，齐次系统 $x_{k+1} = \\lambda x_k$ 必须是渐近稳定的。对于标量离散时间系统，这要求特征值 $\\lambda$ 的幅值小于 1。\n$$|\\lambda| = |a+bK| < 1$$\n代入给定值 $a=2$ 和 $b=1$：\n$$|2+K| < 1 \\implies -1 < 2+K < 1 \\implies -3 < K < -1$$\n这是稳定性的必要条件。\n\n接下来，我们分析有界输入、有界状态的性质。使用三角不等式：\n$$|x_{k+1}| \\leq |\\lambda x_k + bKe_k| \\leq |\\lambda||x_k| + |bK||e_k|$$\n只要 $|x_k| \\leq M$，量化误差就有界 $|e_k| \\leq M/L$。暂时假设不饱和，我们有：\n$$|x_{k+1}| \\leq |\\lambda||x_k| + |bK|\\frac{M}{L}$$\n从初始条件 $x_0$ 开始，这个差分不等式的解有界为：\n$$|x_k| \\leq |\\lambda|^k |x_0| + \\sum_{i=0}^{k-1} |\\lambda|^i \\left( |bK|\\frac{M}{L} \\right) = |\\lambda|^k |x_0| + \\frac{1-|\\lambda|^k}{1-|\\lambda|} |bK|\\frac{M}{L}$$\n当 $k \\to \\infty$ 时，由于 $|\\lambda|<1$，状态 $x_k$ 进入并保持在一个由下式给出的最终界 $S$ 内：\n$$S = \\lim_{k\\to\\infty} \\left( |\\lambda|^k |x_0| + \\frac{1-|\\lambda|^k}{1-|\\lambda|} |bK|\\frac{M}{L} \\right) = \\frac{|bK|}{1-|\\lambda|}\\frac{M}{L}$$\n收敛性要求（目标 2）指出，轨迹必须进入半径为 $r$ 的目标球。这意味着最终界 $S$ 不能大于 $r$。\n$$\\frac{|bK|}{1-|a+bK|}\\frac{M}{L} \\leq r$$\n\n不饱和要求（目标 1）指出，对所有 $k \\geq 0$，有 $|x_k| \\leq M$。我们必须对整个轨迹（包括瞬态阶段）检查这一点。$|x_k|$ 的上界可以写成：\n$$|x_k| \\leq S + (|x_0| - S)|\\lambda|^k$$\n这假设了最坏情况下的初始条件 $|x_0|=X_0$。函数 $f(k) = S + (X_0-S)|\\lambda|^k$ 是单调的。\n- 如果 $X_0 \\geq S$，函数是非增的，其最大值在 $k=0$ 处取得，即 $X_0$。因此我们要求 $X_0 \\leq M$。\n- 如果 $X_0 < S$，函数是非减的，其上确界是 $S$。因此我们要求 $S \\leq M$。\n综合这些，不饱和条件为 $\\max(X_0, S) \\leq M$。\n\n我们有 $X_0=5$ 和 $r=0.5$。收敛性条件要求 $S \\leq r$，这意味着 $S \\leq 0.5$。因此，$S < X_0$。不饱和条件 $\\max(X_0, S) \\leq M$ 简化为 $X_0 \\leq M$。\n\n我们要找到最小的 $M > 0$。条件 $M \\geq X_0$ 提供了一个下界。$M$ 的最小可能值为 $M_{min} = X_0 = 5$。我们必须确定这个选择是否可行。\n设 $M = X_0 = 5$，我们检查是否存在一个增益 $K$ 同时满足稳定性和收敛性条件。\n1. 稳定性：$-3 < K < -1$。\n2. 使用 $M=X_0$ 时的收敛性：\n$$\\frac{|bK|}{1-|a+bK|}\\frac{X_0}{L} \\leq r$$\n代入已知值 $a=2, b=1, L=30, X_0=5, r=0.5$：\n$$\\frac{|1 \\cdot K|}{1-|2+1 \\cdot K|}\\frac{5}{30} \\leq 0.5$$\n$$\\frac{|K|}{1-|2+K|} \\cdot \\frac{1}{6} \\leq \\frac{1}{2}$$\n$$\\frac{|K|}{1-|2+K|} \\leq 3$$\n我们必须在稳定性范围 $-3 < K < -1$ 内求解这个关于 $K$ 的不等式。我们分两种情况进行分析。\n\n情况 1：$-2 \\leq K < -1$。\n在这个区间内，有 $|K| = -K$ 和 $|2+K| = 2+K$。\n$$\\frac{-K}{1-(2+K)} \\leq 3 \\implies \\frac{-K}{-1-K} \\leq 3 \\implies \\frac{K}{1+K} \\leq 3$$\n由于 $K \\in [-2, -1)$，分母 $(1+K)$ 是负的。两边乘以 $(1+K)$ 会使不等号反向：\n$$K \\geq 3(1+K) \\implies K \\geq 3+3K \\implies -2K \\geq 3 \\implies K \\leq -\\frac{3}{2}$$\n这种情况的解是 $[-2, -1)$ 和 $(-\\infty, -1.5]$ 的交集，即 $K \\in [-2, -1.5]$。\n\n情况 2：$-3 < K < -2$。\n在这个区间内，有 $|K| = -K$ 和 $|2+K| = -(2+K)$。\n$$\\frac{-K}{1-(-(2+K))} \\leq 3 \\implies \\frac{-K}{3+K} \\leq 3$$\n由于 $K \\in (-3, -2)$，分母 $(3+K)$ 是正的。\n$$-K \\leq 3(3+K) \\implies -K \\leq 9+3K \\implies -9 \\leq 4K \\implies K \\geq -\\frac{9}{4}$$\n这种情况的解是 $(-3, -2)$ 和 $[-2.25, \\infty)$ 的交集，即 $K \\in [-2.25, -2)$。\n\n结合两种情况的解，容许增益 $K$ 的完整范围是 $[-2.25, -2) \\cup [-2, -1.5]$，即闭区间 $[-2.25, -1.5]$。\n在此区间内的任何增益 $K$ 都允许采用最小可能动态范围 $M=X_0=5$。问题要求给出一个特定的增益 $K$。一个合理的选择是通过最大化不等式 $\\frac{|K|}{1-|2+K|} \\leq 3$ 中的裕度来提供最大的鲁棒性。这等价于在区间 $K \\in [-2.25, -1.5]$ 上最小化函数 $f(K) = \\frac{|K|}{1-|2+K|}$。\n如案例分析所示，$f(K)$ 在 $[-2.25, -2)$ 上递减，在 $[-2, -1.5]$ 上递增。$f(K)$ 的最小值在 $K=-2$ 时取得。\n在 $K=-2$ 时，我们有 $f(-2) = \\frac{|-2|}{1-|2-2|} = \\frac{2}{1} = 2$。这个值提供了最大的裕度，因为 $2 \\leq 3$。\n\n因此，我们选择增益 $K=-2$。最小动态范围是 $M=5$。\n最终的设计是这对值 $(K, M) = (-2, 5)$。\n让我们验证这个解：\n- 增益：$K=-2$。稳定性：$|a+bK| = |2+1(-2)| = 0 < 1$。条件成立。\n- 动态范围：$M=5$。不饱和：$M=5 \\geq X_0=5$。条件成立。\n- 收敛性：$\\frac{|bK|}{1-|a+bK|}\\frac{M}{L} = \\frac{|1(-2)|}{1-0}\\frac{5}{30} = 2 \\cdot \\frac{1}{6} = \\frac{1}{3}$。我们检查 $\\frac{1}{3} \\leq r=0.5$ 是否成立。这是成立的。所有条件都得到满足。\n最小的动态范围是 $M=5$，而鲁棒的增益选择是 $K=-2$。", "answer": "$$\\boxed{\\begin{pmatrix}-2 & 5\\end{pmatrix}}$$", "id": "2696241"}, {"introduction": "成功稳定系统后，下一个关键问题是评估其性能。量化作为一种误差源，会如何影响系统的稳态行为？本练习将量化误差建模为一个随机过程，要求你计算系统状态的稳态方差。这个练习为你提供了分析量化对控制系统性能影响的强大统计工具。[@problem_id:2696244]", "problem": "考虑一个标量离散时间线性时不变系统，其受量化误差（建模为一个加性噪声过程）驱动，由递归式 $x_{k+1}=a\\,x_{k}+b\\,e_{k}$ 给出。其中，$k\\in\\mathbb{Z}_{\\ge 0}$ 为时间索引，$a\\in\\mathbb{R}$ 和 $b\\in\\mathbb{R}$ 为常数且满足 $|a|<1$，$\\{e_{k}\\}$ 是一个独立同分布（i.i.d.）序列，对于固定的步长 $\\Delta>0$，有 $e_{k}\\sim \\mathcal{U}\\!\\left[-\\Delta/2,\\Delta/2\\right]$。假设 $x_{0}$ 与 $\\{e_{k}\\}$ 相互独立且具有有限二阶矩。对于所有 $k$，视量化误差为非饱和且与 $x_{k}$ 相互独立。仅使用期望和方差的核心定义、独立性假设以及关于均匀分布的公认事实，从第一性原理推导 $x_{k}$ 的稳态方差，并以 $a$、$b$ 和 $\\Delta$ 的函数形式给出闭式解。请以 $a$、$b$ 和 $\\Delta$ 的单个解析表达式形式提供您的答案。无需进行数值近似或舍入。", "solution": "推导过程分三部分进行：首先，我们刻画噪声过程的特征；其次，我们分析状态 $x_k$ 的均值；最后，我们分析状态 $x_k$ 的方差。\n\n首先，我们确定噪声项 $e_k$ 的均值和方差。对于 $e_k \\sim \\mathcal{U}\\!\\left[-\\frac{\\Delta}{2},\\frac{\\Delta}{2}\\right]$，其概率密度函数（PDF）为：当 $z \\in \\left[-\\frac{\\Delta}{2},\\frac{\\Delta}{2}\\right]$ 时，$f_e(z) = \\frac{1}{\\Delta}$，否则为 $0$。\n根据定义，$e_k$ 的期望值为：\n$$\n\\mathbb{E}[e_k] = \\int_{-\\infty}^{\\infty} z f_e(z) dz = \\int_{-\\Delta/2}^{\\Delta/2} z \\cdot \\frac{1}{\\Delta} dz = \\frac{1}{\\Delta} \\left[ \\frac{z^2}{2} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{1}{2\\Delta} \\left( \\left(\\frac{\\Delta}{2}\\right)^2 - \\left(-\\frac{\\Delta}{2}\\right)^2 \\right) = 0\n$$\n$e_k$ 的方差记为 $\\sigma_e^2$，由 $\\text{Var}(e_k) = \\mathbb{E}[e_k^2] - (\\mathbb{E}[e_k])^2$ 给出。由于均值为 $0$，方差等于其二阶矩：\n$$\n\\sigma_e^2 = \\mathbb{E}[e_k^2] = \\int_{-\\infty}^{\\infty} z^2 f_e(z) dz = \\int_{-\\Delta/2}^{\\Delta/2} z^2 \\cdot \\frac{1}{\\Delta} dz = \\frac{1}{\\Delta} \\left[ \\frac{z^3}{3} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{1}{3\\Delta} \\left( \\left(\\frac{\\Delta}{2}\\right)^3 - \\left(-\\frac{\\Delta}{2}\\right)^3 \\right) = \\frac{1}{3\\Delta} \\left( \\frac{\\Delta^3}{8} + \\frac{\\Delta^3}{8} \\right) = \\frac{2\\Delta^3}{24\\Delta} = \\frac{\\Delta^2}{12}\n$$\n\n接下来，我们分析状态 $x_k$ 的均值。令 $\\mu_k = \\mathbb{E}[x_k]$。对系统递归式取期望：\n$$\n\\mathbb{E}[x_{k+1}] = \\mathbb{E}[a\\,x_{k}+b\\,e_{k}]\n$$\n根据期望的线性性质，可得：\n$$\n\\mu_{k+1} = a\\,\\mathbb{E}[x_k] + b\\,\\mathbb{E}[e_k] = a\\,\\mu_k + b \\cdot 0 = a\\,\\mu_k\n$$\n这是一个关于均值的等比数列。当 $k \\to \\infty$ 时，稳态均值为 $\\mu_x = \\lim_{k\\to\\infty} \\mu_k$。由于 $|a|<1$，此极限为：\n$$\n\\mu_x = \\lim_{k\\to\\infty} a^k \\mu_0 = 0\n$$\n因此，过程 $x_k$ 的稳态均值为 $0$。\n\n最后，我们推导稳态方差 $\\sigma_x^2 = \\text{Var}(x_k)$。根据定义，$\\text{Var}(x_k) = \\mathbb{E}[x_k^2] - (\\mathbb{E}[x_k])^2$。由于稳态均值为 $0$，稳态方差等于稳态二阶矩，即 $\\sigma_x^2 = \\mathbb{E}[x^2]$。\n让我们建立二阶矩 $\\mathbb{E}[x_k^2]$ 的递归式：\n$$\n\\mathbb{E}[x_{k+1}^2] = \\mathbb{E}[(a\\,x_{k}+b\\,e_{k})^2] = \\mathbb{E}[a^2 x_k^2 + 2ab\\,x_k e_k + b^2 e_k^2]\n$$\n根据期望的线性性质：\n$$\n\\mathbb{E}[x_{k+1}^2] = a^2 \\mathbb{E}[x_k^2] + 2ab\\,\\mathbb{E}[x_k e_k] + b^2 \\mathbb{E}[e_k^2]\n$$\n状态 $x_k$ 是初始状态 $x_0$ 和过去噪声项 $\\{e_0, e_1, \\dots, e_{k-1}\\}$ 的函数。由于 $\\{e_k\\}$ 是独立同分布序列，$e_k$ 与所有先前的项 $e_j$（其中 $j < k$）相互独立。由于 $x_0$ 也与 $\\{e_k\\}$ 相互独立，因此 $x_k$ 与 $e_k$ 相互独立。问题陈述也直接给出了这个假设。因此，乘积项的期望可以分离：\n$$\n\\mathbb{E}[x_k e_k] = \\mathbb{E}[x_k]\\mathbb{E}[e_k] = \\mu_k \\cdot 0 = 0\n$$\n将此结果以及噪声的方差 $\\mathbb{E}[e_k^2]=\\sigma_e^2=\\frac{\\Delta^2}{12}$ 代入二阶矩的递归式中，得到：\n$$\n\\mathbb{E}[x_{k+1}^2] = a^2 \\mathbb{E}[x_k^2] + b^2 \\frac{\\Delta^2}{12}\n$$\n在稳态下，矩是恒定的，所以 $\\mathbb{E}[x_{k+1}^2] = \\mathbb{E}[x_k^2] = M_2$，其中 $M_2$ 是稳态二阶矩。该递归式变为关于 $M_2$ 的一个代数方程：\n$$\nM_2 = a^2 M_2 + \\frac{b^2 \\Delta^2}{12}\n$$\n求解 $M_2$：\n$$\nM_2(1-a^2) = \\frac{b^2 \\Delta^2}{12}\n$$\n由于 $|a|<1$，所以 $1-a^2>0$，我们可以用它来除：\n$$\nM_2 = \\frac{b^2 \\Delta^2}{12(1-a^2)}\n$$\n如前所述，因为稳态均值 $\\mu_x$ 为 $0$，所以稳态方差 $\\sigma_x^2$ 等于稳态二阶矩 $M_2$。\n因此，$x_k$ 的稳态方差为：\n$$\n\\sigma_x^2 = \\frac{b^2 \\Delta^2}{12(1-a^2)}\n$$\n此表达式即为所求的闭式解。", "answer": "$$\n\\boxed{\\frac{b^{2}\\Delta^{2}}{12(1-a^{2})}}\n$$", "id": "2696244"}]}