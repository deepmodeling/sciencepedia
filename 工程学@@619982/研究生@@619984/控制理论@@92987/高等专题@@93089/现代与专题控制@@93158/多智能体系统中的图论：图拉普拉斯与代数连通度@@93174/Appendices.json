{"hands_on_practices": [{"introduction": "我们的第一个练习将从基础入手。您将为一个简单的四节点网络亲手构建其邻接矩阵 $A$、度矩阵 $D$ 及图拉普拉斯矩阵 $L$。这个过程旨在巩固这些核心矩阵的定义，并通过直接计算其特征值，让您对拉普拉斯谱的性质有一个直观的感受。[@problem_id:2710595]", "problem": "在一个有 $N=4$ 个同质智能体的连续时间多智能体一致性网络中，交互拓扑是一个具有双向耦合的无向加权图。智能体被标记为 $1,2,3,4$，边集为 $\\{(1,2),(2,3),(3,4),(4,1)\\}$，每条边的权重均为 $1$。仅使用邻接矩阵 $A$、度矩阵 $D$ 和图拉普拉斯矩阵 $L$ 的基本定义，按以下步骤操作：\n\n- 构建邻接矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$，其中当 $i \\neq j$ 时，$A_{ij}=A_{ji}$ 等于节点 $i$ 和 $j$ 之间的边权重，对于所有 $i$，$A_{ii}=0$。\n- 构建度矩阵 $D \\in \\mathbb{R}^{4 \\times 4}$，其中 $D$ 是一个对角矩阵，其对角线元素为 $D_{ii} = \\sum_{j=1}^{4} A_{ij}$。\n- 构建拉普拉斯矩阵 $L \\in \\mathbb{R}^{4 \\times 4}$，定义为 $L = D - A$。\n- 精确计算 $L$ 的所有特征值，并按非递减顺序排列。\n\n将最终的特征值表示为精确数（不要四舍五入）。你的最终答案必须是一个单行矩阵，其中包含按非递减顺序排列的特征值，不带单位。", "solution": "在尝试求解之前，对问题陈述进行验证。\n\n**第 1 步：提取已知条件**\n- 智能体数量：$N=4$。\n- 智能体标签：$1,2,3,4$。\n- 拓扑：无向加权图。\n- 边集：$\\{(1,2),(2,3),(3,4),(4,1)\\}$。\n- 边权重：全部等于 $1$。\n- 邻接矩阵定义：$A \\in \\mathbb{R}^{4 \\times 4}$，当 $i \\neq j$ 时，$A_{ij}=A_{ji}$ 为节点 $i$ 和 $j$ 之间的边权重，且 $A_{ii}=0$。\n- 度矩阵定义：$D \\in \\mathbb{R}^{4 \\times 4}$，一个对角矩阵，其对角元素为 $D_{ii} = \\sum_{j=1}^{4} A_{ij}$。\n- 图拉普拉斯矩阵定义：$L \\in \\mathbb{R}^{4 \\times 4}$，由 $L = D - A$ 给出。\n- 目标：精确计算 $L$ 的所有特征值，并按非递减顺序排列。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据**：该问题在图论和线性代数方面有充分的理论基础，这两个学科是研究多智能体系统和控制理论的基础学科。邻接矩阵、度矩阵和拉普拉斯矩阵的定义都是标准的。\n- **适定性**：该问题是适定的。图由其节点、边和权重完全确定。计算给定矩阵的特征值是线性代数中一个标准的、可解的问题。由于图是无向的，所得到的拉普拉斯矩阵 $L$ 是实对称的，这保证了实特征值的存在。\n- **客观性**：该问题以精确、客观的数学语言陈述，没有歧义或主观内容。\n\n**第 3 步：结论与行动**\n- **结论**：问题有效。它科学上合理、适定、客观且完整。\n- **行动**：开始求解。\n\n以下步骤构建所需的矩阵并计算图拉普拉斯矩阵的特征值。\n\n**邻接矩阵 $A$ 的构建**\n该图由 $N=4$ 个标记为 $1, 2, 3, 4$ 的节点组成。边集为 $\\{(1,2),(2,3),(3,4),(4,1)\\}$。由于该图是无向的且所有边权重均为 $1$，邻接矩阵 $A$ 的非零非对角线元素确定如下：\n- 边 $(1,2) \\implies A_{12} = A_{21} = 1$。\n- 边 $(2,3) \\implies A_{23} = A_{32} = 1$。\n- 边 $(3,4) \\implies A_{34} = A_{43} = 1$。\n- 边 $(4,1) \\implies A_{41} = A_{14} = 1$。\n所有其他非对角线元素均为 $0$。对角线元素 $A_{ii}$ 均为 $0$。\n得到的邻接矩阵 $A$ 是：\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 & 1 \\\\\n1 & 0 & 1 & 0 \\\\\n0 & 1 & 0 & 1 \\\\\n1 & 0 & 1 & 0\n\\end{pmatrix}\n$$\n\n**度矩阵 $D$ 的构建**\n度矩阵 $D$ 是一个对角矩阵，其中每个对角线元素 $D_{ii}$ 是节点 $i$ 的度，计算为 $A$ 的第 $i$ 行元素之和。\n- $D_{11} = \\sum_{j=1}^{4} A_{1j} = 0+1+0+1 = 2$。\n- $D_{22} = \\sum_{j=1}^{4} A_{2j} = 1+0+1+0 = 2$。\n- $D_{33} = \\sum_{j=1}^{4} A_{3j} = 0+1+0+1 = 2$。\n- $D_{44} = \\sum_{j=1}^{4} A_{4j} = 1+0+1+0 = 2$。\n该图是 2-正则图。度矩阵 $D$ 是：\n$$\nD = \\begin{pmatrix}\n2 & 0 & 0 & 0 \\\\\n0 & 2 & 0 & 0 \\\\\n0 & 0 & 2 & 0 \\\\\n0 & 0 & 0 & 2\n\\end{pmatrix}\n$$\n\n**拉普拉斯矩阵 $L$ 的构建**\n图拉普拉斯矩阵 $L$ 定义为 $L = D - A$。\n$$\nL = \\begin{pmatrix}\n2 & 0 & 0 & 0 \\\\\n0 & 2 & 0 & 0 \\\\\n0 & 0 & 2 & 0 \\\\\n0 & 0 & 0 & 2\n\\end{pmatrix} - \\begin{pmatrix}\n0 & 1 & 0 & 1 \\\\\n1 & 0 & 1 & 0 \\\\\n0 & 1 & 0 & 1 \\\\\n1 & 0 & 1 & 0\n\\end{pmatrix} = \\begin{pmatrix}\n2 & -1 & 0 & -1 \\\\\n-1 & 2 & -1 & 0 \\\\\n0 & -1 & 2 & -1 \\\\\n-1 & 0 & -1 & 2\n\\end{pmatrix}\n$$\n\n**$L$ 的特征值计算**\n$L$ 的特征值 $\\lambda$ 是特征方程 $\\det(L - \\lambda I) = 0$ 的根。\n$$\n\\det \\begin{pmatrix}\n2-\\lambda & -1 & 0 & -1 \\\\\n-1 & 2-\\lambda & -1 & 0 \\\\\n0 & -1 & 2-\\lambda & -1 \\\\\n-1 & 0 & -1 & 2-\\lambda\n\\end{pmatrix} = 0\n$$\n令 $x = 2-\\lambda$。特征行列式为：\n$$\n\\det \\begin{pmatrix}\nx & -1 & 0 & -1 \\\\\n-1 & x & -1 & 0 \\\\\n0 & -1 & x & -1 \\\\\n-1 & 0 & -1 & x\n\\end{pmatrix}\n$$\n我们沿第一行使用代数余子式展开计算行列式：\n$$\n\\text{det} = x \\begin{vmatrix}\nx & -1 & 0 \\\\\n-1 & x & -1 \\\\\n0 & -1 & x\n\\end{vmatrix} - (-1) \\begin{vmatrix}\n-1 & -1 & 0 \\\\\n0 & x & -1 \\\\\n-1 & -1 & x\n\\end{vmatrix} + 0 - (-1) \\begin{vmatrix}\n-1 & x & -1 \\\\\n0 & -1 & x \\\\\n-1 & 0 & -1\n\\end{vmatrix}\n$$\n计算各代数余子式：\n- $\\begin{vmatrix}\nx & -1 & 0 \\\\\n-1 & x & -1 \\\\\n0 & -1 & x\n\\end{vmatrix} = x(x^2 - 1) - (-1)(-x) = x^3 - x - x = x^3 - 2x$。\n- $\\begin{vmatrix}\n-1 & -1 & 0 \\\\\n0 & x & -1 \\\\\n-1 & -1 & x\n\\end{vmatrix} = -1(x^2 - 1) - (-1)(0 - 1) = -x^2 + 1 - 1 = -x^2$。\n- $\\begin{vmatrix}\n-1 & x & -1 \\\\\n0 & -1 & x \\\\\n-1 & 0 & -1\n\\end{vmatrix} = -1(1 - 0) - x(0 - (-x)) + (-1)(0 - 1) = -1 - x^2 + 1 = -x^2$。\n\n将这些结果代回行列式表达式中：\n$$\n\\text{det} = x(x^3 - 2x) + (-x^2) + (-x^2) = x^4 - 2x^2 - 2x^2 = x^4 - 4x^2\n$$\n特征方程为 $x^4 - 4x^2 = 0$，可以因式分解为 $x^2(x^2 - 4) = 0$，或 $x^2(x-2)(x+2) = 0$。\n$x$ 的根为 $x = 0$（重数为 $2$）、$x=2$ 和 $x=-2$。\n\n现在我们通过代回 $x = 2-\\lambda$ 来求解特征值 $\\lambda$：\n- 对于 $x=0$：$2-\\lambda = 0 \\implies \\lambda = 2$。该特征值的重数为 $2$。\n- 对于 $x=2$：$2-\\lambda = 2 \\implies \\lambda = 0$。\n- 对于 $x=-2$：$2-\\lambda = -2 \\implies \\lambda = 4$。\n\n拉普拉斯矩阵 $L$ 的特征值为 $\\{0, 2, 2, 4\\}$。将它们按非递减顺序排列得到 $0, 2, 2, 4$。\n最小的特征值是 $\\lambda_1 = 0$，这对于任何连通无向图都是预期的结果，其重数等于连通分量的数量（此处为 1）。第二小的特征值 $\\lambda_2=2$ 是图的代数连通度。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 2 & 2 & 4\n\\end{pmatrix}\n}\n$$", "id": "2710595"}, {"introduction": "在掌握了基本定义之后，第二个练习将带您探索拉普拉斯矩阵更深层次的结构。通过引入有向关联矩阵 $B$，您将验证 $L = BWB^{\\top}$ 这一重要恒等式。这个练习揭示了拉普拉斯矩阵与网络拓扑和边权之间更本质的联系，这一视角对于理解多智能体系统中的能量耗散以及在图论中进行严格证明至关重要。[@problem_id:2710578]", "problem": "考虑一个由$5$个智能体组成的网络，该网络由一个无向加权图 $\\mathcal{G}=(\\mathcal{V},\\mathcal{E},w)$ 建模，其节点集为 $\\mathcal{V}=\\{1,2,3,4,5\\}$，边集为 $\\mathcal{E}=\\{(1,2),(2,3),(3,4),(4,5),(5,1)\\}$。所有边的权重均为单位权重，即对每条边 $e\\in\\mathcal{E}$ 都有 $w(e)=1$。为构建有向关联矩阵，固定以下边的方向：$(1,2)$ 的方向为 $1\\to 2$，$(2,3)$ 的方向为 $2\\to 3$，$(3,4)$ 的方向为 $3\\to 4$，$(4,5)$ 的方向为 $4\\to 5$，以及 $(5,1)$ 的方向为 $5\\to 1$。\n\n仅使用邻接矩阵 $A$、度矩阵 $D$ 和图拉普拉斯矩阵 $L$ 的基本定义，完成以下任务：\n\n1. 显式地构建 $\\mathcal{G}$ 的有向关联矩阵 $B\\in\\mathbb{R}^{5\\times 5}$ 和对角边权重矩阵 $W\\in\\mathbb{R}^{5\\times 5}$。\n2. 显式地计算 $BWB^{\\top}$ 并验证 $BWB^{\\top}=D-A$。\n3. 然后确定 $\\mathcal{G}$ 的代数连通度 $\\lambda_{2}$，其定义为 $L$ 的第二小特征值。\n\n请给出 $\\lambda_{2}$ 的精确值（不要小数近似）。你的最终答案必须是单个解析表达式。", "solution": "该问题首先经过严格的验证过程。\n\n步骤1：提取已知条件。\n- 一个由$5$个智能体组成的网络。\n- 该网络由一个无向加权图 $\\mathcal{G}=(\\mathcal{V},\\mathcal{E},w)$ 建模。\n- 节点集：$\\mathcal{V}=\\{1,2,3,4,5\\}$。\n- 边集：$\\mathcal{E}=\\{(1,2),(2,3),(3,4),(4,5),(5,1)\\}$。\n- 边权重：对每条边 $e\\in\\mathcal{E}$ 都有 $w(e)=1$。\n- 为构建关联矩阵指定了一个方向：$(1,2)$ 的方向为 $1\\to 2$，$(2,3)$ 的方向为 $2\\to 3$，$(3,4)$ 的方向为 $3\\to 4$，$(4,5)$ 的方向为 $4\\to 5$，以及 $(5,1)$ 的方向为 $5\\to 1$。\n- 给定了三个任务：\n    1. 构建有向关联矩阵 $B\\in\\mathbb{R}^{5\\times 5}$ 和边权重矩阵 $W\\in\\mathbb{R}^{5\\times 5}$。\n    2. 计算 $BWB^{\\top}$ 并验证其等于 $D-A$，其中 $D$ 是度矩阵，$A$ 是邻接矩阵。\n    3. 确定图 $\\mathcal{G}$ 的代数连通度 $\\lambda_{2}$，其定义为图拉普拉斯矩阵 $L$ 的第二小特征值。\n- $\\lambda_{2}$ 的最终答案必须是一个精确的解析表达式。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据，是应用于控制系统和多智能体网络的代数图论中的一个标准练习。所有概念——邻接矩阵、度矩阵、图拉普拉斯矩阵、关联矩阵和代数连通度——都是定义明确且标准的。该问题是适定的，为获得唯一解提供了所有必要信息。图结构是一个简单的圈图 $C_5$，任务涉及矩阵构建和特征值计算，这些都是标准的数学过程。该问题是客观的，不包含任何科学或逻辑上的缺陷、不一致或歧义。\n\n步骤3：结论与行动。\n该问题被视为有效。将提供一个完整的解答。\n\n图 $\\mathcal{G}$ 是一个有 $N=5$ 个顶点的圈图，记为 $C_5$。边的数量为 $M=5$。所有边的权重都为 $1$。\n\n第1部分：构建关联矩阵 $B$ 和权重矩阵 $W$。\n\n有向关联矩阵 $B$ 是一个 $N \\times M$ 矩阵，在本例中是一个 $5 \\times 5$ 矩阵。其元素 $B_{ij}$ 根据节点 $i$ 和边 $j$ 之间的关系定义。我们根据指定的方向标记这些边：$e_1: 1 \\to 2$，$e_2: 2 \\to 3$，$e_3: 3 \\to 4$，$e_4: 4 \\to 5$ 和 $e_5: 5 \\to 1$。对于一条从节点 $u$ 指向节点 $v$ 的边 $e_j$，$B$ 中对应的列在第 $u$ 行为 $-1$，在第 $v$ 行为 $+1$。\n\n- 对于 $e_1: 1 \\to 2$，第一列是 $[-1, 1, 0, 0, 0]^{\\top}$。\n- 对于 $e_2: 2 \\to 3$，第二列是 $[0, -1, 1, 0, 0]^{\\top}$。\n- 对于 $e_3: 3 \\to 4$，第三列是 $[0, 0, -1, 1, 0]^{\\top}$。\n- 对于 $e_4: 4 \\to 5$，第四列是 $[0, 0, 0, -1, 1]^{\\top}$。\n- 对于 $e_5: 5 \\to 1$，第五列是 $[1, 0, 0, 0, -1]^{\\top}$。\n\n组合这些列，得到关联矩阵 $B$ 为：\n$$\nB = \\begin{pmatrix}\n-1 & 0 & 0 & 0 & 1 \\\\\n1 & -1 & 0 & 0 & 0 \\\\\n0 & 1 & -1 & 0 & 0 \\\\\n0 & 0 & 1 & -1 & 0 \\\\\n0 & 0 & 0 & 1 & -1\n\\end{pmatrix}\n$$\n边权重矩阵 $W$ 是一个 $M \\times M$ 的对角矩阵，这里是 $5 \\times 5$，其中对角元素 $W_{ii}$ 是边 $e_i$ 的权重。由于所有边权重都给定为 $1$，所以 $W$ 是 $5 \\times 5$ 的单位矩阵 $I_5$。\n$$\nW = \\begin{pmatrix}\n1 & 0 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 & 0 \\\\\n0 & 0 & 1 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\n\n第2部分：计算 $BWB^{\\top}$ 并验证恒等式 $BWB^{\\top}=D-A$。\n\n由于 $W=I_5$，我们计算 $BWB^{\\top} = BI_5B^{\\top} = BB^{\\top}$。$B$ 的转置是：\n$$\nB^{\\top} = \\begin{pmatrix}\n-1 & 1 & 0 & 0 & 0 \\\\\n0 & -1 & 1 & 0 & 0 \\\\\n0 & 0 & -1 & 1 & 0 \\\\\n0 & 0 & 0 & -1 & 1 \\\\\n1 & 0 & 0 & 0 & -1\n\\end{pmatrix}\n$$\n乘积 $BB^{\\top}$ 是图拉普拉斯矩阵 $L$：\n$$\nL = BB^{\\top} = \\begin{pmatrix}\n-1 & 0 & 0 & 0 & 1 \\\\\n1 & -1 & 0 & 0 & 0 \\\\\n0 & 1 & -1 & 0 & 0 \\\\\n0 & 0 & 1 & -1 & 0 \\\\\n0 & 0 & 0 & 1 & -1\n\\end{pmatrix}\n\\begin{pmatrix}\n-1 & 1 & 0 & 0 & 0 \\\\\n0 & -1 & 1 & 0 & 0 \\\\\n0 & 0 & -1 & 1 & 0 \\\\\n0 & 0 & 0 & -1 & 1 \\\\\n1 & 0 & 0 & 0 & -1\n\\end{pmatrix}\n$$\n$$\nL = \\begin{pmatrix}\n(-1)^2+1^2 & -1 & 0 & 0 & -1 \\\\\n-1 & 1^2+(-1)^2 & -1 & 0 & 0 \\\\\n0 & -1 & 1^2+(-1)^2 & -1 & 0 \\\\\n0 & 0 & -1 & 1^2+(-1)^2 & -1 \\\\\n-1 & 0 & 0 & -1 & 1^2+(-1)^2\n\\end{pmatrix}\n= \\begin{pmatrix}\n2 & -1 & 0 & 0 & -1 \\\\\n-1 & 2 & -1 & 0 & 0 \\\\\n0 & -1 & 2 & -1 & 0 \\\\\n0 & 0 & -1 & 2 & -1 \\\\\n-1 & 0 & 0 & -1 & 2\n\\end{pmatrix}\n$$\n现在，我们根据图的定义构建邻接矩阵 $A$ 和度矩阵 $D$。对于一个无权图（或单位权重图），如果节点 $i$ 和 $j$ 之间存在一条边，则 $A_{ij}=1$，否则为 $0$。\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 & 0 & 1 \\\\\n1 & 0 & 1 & 0 & 0 \\\\\n0 & 1 & 0 & 1 & 0 \\\\\n0 & 0 & 1 & 0 & 1 \\\\\n1 & 0 & 0 & 1 & 0\n\\end{pmatrix}\n$$\n度矩阵 $D$ 是一个对角矩阵，其中 $D_{ii}$ 是节点 $i$ 的度。在 $C_5$ 图中，每个节点的度都是 $2$。\n$$\nD = \\begin{pmatrix}\n2 & 0 & 0 & 0 & 0 \\\\\n0 & 2 & 0 & 0 & 0 \\\\\n0 & 0 & 2 & 0 & 0 \\\\\n0 & 0 & 0 & 2 & 0 \\\\\n0 & 0 & 0 & 0 & 2\n\\end{pmatrix}\n$$\n我们计算 $D-A$：\n$$\nD-A = \\begin{pmatrix}\n2 & 0 & 0 & 0 & 0 \\\\\n0 & 2 & 0 & 0 & 0 \\\\\n0 & 0 & 2 & 0 & 0 \\\\\n0 & 0 & 0 & 2 & 0 \\\\\n0 & 0 & 0 & 0 & 2\n\\end{pmatrix} - \\begin{pmatrix}\n0 & 1 & 0 & 0 & 1 \\\\\n1 & 0 & 1 & 0 & 0 \\\\\n0 & 1 & 0 & 1 & 0 \\\\\n0 & 0 & 1 & 0 & 1 \\\\\n1 & 0 & 0 & 1 & 0\n\\end{pmatrix} = \\begin{pmatrix}\n2 & -1 & 0 & 0 & -1 \\\\\n-1 & 2 & -1 & 0 & 0 \\\\\n0 & -1 & 2 & -1 & 0 \\\\\n0 & 0 & -1 & 2 & -1 \\\\\n-1 & 0 & 0 & -1 & 2\n\\end{pmatrix}\n$$\n该结果与计算出的 $BB^{\\top}$ 相匹配。恒等式 $L = BWB^{\\top} = D-A$ 得以验证。\n\n第3部分：确定代数连通度 $\\lambda_2$。\n\n我们必须求出拉普拉斯矩阵 $L$ 的特征值。矩阵 $L$ 是一个循环矩阵。对于一个第一行为 $(c_0, c_1, \\dots, c_{n-1})$ 的通用 $n \\times n$ 循环矩阵，其特征值 $\\mu_k$ 由公式 $\\mu_k = \\sum_{j=0}^{n-1} c_j \\omega^{kj}$ 给出，其中 $k=0, 1, \\dots, n-1$，$\\omega = \\exp(2\\pi i/n)$。在我们的例子中，$n=5$， $L$ 的第一行可视为 $(c_0, c_1, c_2, c_3, c_4)$，即 $(2, -1, 0, 0, -1)$。使用此公式需要注意索引。一个更安全的标准公式指出，圈图 $C_n$ 的拉普拉斯矩阵的特征值为：\n$$\n\\lambda_k = 2 - 2\\cos\\left(\\frac{2\\pi k}{n}\\right) \\quad \\text{for } k=0, 1, \\dots, n-1.\n$$\n对于 $n=5$，$L$ 的特征值为：\n$$\n\\lambda_k = 2 - 2\\cos\\left(\\frac{2\\pi k}{5}\\right) \\quad \\text{for } k=0, 1, 2, 3, 4.\n$$\n- 当 $k=0$ 时：$\\lambda_0 = 2 - 2\\cos(0) = 2 - 2(1) = 0$。这是最小的特征值，正如对任何连通图所预期的那样。\n- 当 $k=1$ 时：$\\lambda_1 = 2 - 2\\cos\\left(\\frac{2\\pi}{5}\\right)$。\n- 当 $k=2$ 时：$\\lambda_2 = 2 - 2\\cos\\left(\\frac{4\\pi}{5}\\right)$。\n- 当 $k=3$ 时：$\\lambda_3 = 2 - 2\\cos\\left(\\frac{6\\pi}{5}\\right) = 2 - 2\\cos\\left(-\\frac{4\\pi}{5}\\right) = \\lambda_2$。\n- 当 $k=4$ 时：$\\lambda_4 = 2 - 2\\cos\\left(\\frac{8\\pi}{5}\\right) = 2 - 2\\cos\\left(-\\frac{2\\pi}{5}\\right) = \\lambda_1$。\n\n特征值的集合是 $\\{0, 2 - 2\\cos(\\frac{2\\pi}{5}), 2 - 2\\cos(\\frac{2\\pi}{5}), 2 - 2\\cos(\\frac{4\\pi}{5}), 2 - 2\\cos(\\frac{4\\pi}{5})\\}$。\n代数连通度是第二小特征值，通常记为 $\\lambda_2(L)$。我们必须比较 $k=1$ 和 $k=2$ 时的值。余弦函数在区间 $[0, \\pi]$ 上是严格递减的。由于 $0 < \\frac{2\\pi}{5} < \\frac{4\\pi}{5} < \\pi$，我们有 $\\cos(\\frac{2\\pi}{5}) > \\cos(\\frac{4\\pi}{5})$。这意味着 $2 - 2\\cos(\\frac{2\\pi}{5}) < 2 - 2\\cos(\\frac{4\\pi}{5})$。\n因此，第二小特征值对应于 $k=1$（以及 $k=4$）。\n$$\n\\lambda_{2} = 2 - 2\\cos\\left(\\frac{2\\pi}{5}\\right)\n$$\n为了求出精确值，我们使用 $\\cos(\\frac{2\\pi}{5})$ 的已知值，它与黄金分割率有关。该值为 $\\cos(\\frac{2\\pi}{5}) = \\frac{\\sqrt{5}-1}{4}$。\n将此值代入 $\\lambda_2$ 的表达式中：\n$$\n\\lambda_{2} = 2 - 2\\left(\\frac{\\sqrt{5}-1}{4}\\right) = 2 - \\frac{\\sqrt{5}-1}{2} = \\frac{4 - (\\sqrt{5}-1)}{2} = \\frac{4 - \\sqrt{5} + 1}{2} = \\frac{5 - \\sqrt{5}}{2}\n$$\n这就是代数连通度的精确值。", "answer": "$$\\boxed{\\frac{5 - \\sqrt{5}}{2}}$$", "id": "2710578"}, {"introduction": "最后的练习将理论付诸实践，展示拉普拉斯谱的强大应用价值。您将通过计算一个被称为“Fiedler向量”（即代数连通度 $\\lambda_2$ 对应的特征向量）的特殊向量，来识别网络中的“瓶颈”。此练习将这一概念应用于图分割问题，这是计算机科学和网络分析中的一个基本任务，也是谱图理论最经典的应用之一。[@problem_id:2710619]", "problem": "给定一组小型无向加权图。对于每个图，请按顺序执行以下操作：构建其组合图拉普拉斯矩阵，数值计算一个 Fiedler 向量，使用 Fiedler 向量的元素通过零阈值规则提出一个二分划分，并计算该划分所产生的切割权重。此任务必须根据谱图理论的基本原理来解决。\n\n请使用以下基本定义作为基础：\n- 对于一个有 $n$ 个顶点、对称非负邻接矩阵为 $A \\in \\mathbb{R}^{n \\times n}$ 的无向加权图，其度矩阵 $D \\in \\mathbb{R}^{n \\times n}$ 是一个对角矩阵，其中 $D_{ii} = \\sum_{j=1}^{n} A_{ij}$。组合图拉普拉斯矩阵为 $L = D - A$。\n- 代数连通度是 $L$ 的第二小特征值。其对应的特征向量称为 Fiedler 向量。等价地，Fiedler 向量是在所有满足 $x^\\top \\mathbf{1} = 0$ 和 $\\|x\\|_2 = 1$ 的向量 $x \\in \\mathbb{R}^n$ 中，最小化瑞利商 $x^\\top L x$ 的任意向量，其中 $\\mathbf{1}$ 是全一向量。\n- 给定一个 Fiedler 向量 $v \\in \\mathbb{R}^n$，通过零阈值规则提出节点集的划分 $\\{S, \\bar S\\}$：$S = \\{ i \\in \\{1,\\dots,n\\} \\mid v_i \\ge 0 \\}$ 且 $\\bar S = \\{ i \\in \\{1,\\dots,n\\} \\mid v_i < 0 \\}$。\n- $S$ 和 $\\bar S$ 之间的切割权重为 $\\mathrm{cut}(S,\\bar S) = \\sum_{i \\in S} \\sum_{j \\in \\bar S} A_{ij}$。\n\n您的程序必须：\n- 对于每个指定的测试图，构建 $L$，数值计算一个 Fiedler 向量，使用零阈值规则形成 $\\{S,\\bar S\\}$，并输出结果的切割权重，该权重为四舍五入到 $6$ 位小数的浮点数。\n\n重要的实现细节：\n- 所有特征计算必须在对称实数拉普拉斯矩阵 $L$ 上执行。\n- 选择与 $L$ 的第二小特征值相关联的特征向量作为 Fiedler 向量。\n- 划分必须严格遵循规则：$v_i \\ge 0$ 的节点归于 $S$，$v_i < 0$ 的节点归于 $\\bar S$。\n- 对于无向图，切割权重必须将每条无向边精确计算一次。\n\n测试套件：\n- 案例 $1$ ($n = 6$)：两个弱连接的单位权重三角形。非零对称邻接矩阵元素 $A_{12} = A_{21} = 1$，$A_{23} = A_{32} = 1$，$A_{13} = A_{31} = 1$，$A_{45} = A_{54} = 1$，$A_{56} = A_{65} = 1$，$A_{46} = A_{64} = 1$，以及一条弱的簇间边 $A_{34} = A_{43} = 0.2$。所有其他元素为 $0$。\n- 案例 $2$ ($n = 4$)：一个带弱中间链接的加权链。非零对称邻接矩阵元素 $A_{12} = A_{21} = 2$，$A_{23} = A_{32} = 0.1$，$A_{34} = A_{43} = 2$。所有其他元素为 $0$。\n- 案例 $3$ ($n = 5$)：一个类似棒棒糖的图。非零对称邻接矩阵元素 $A_{12} = A_{21} = 1$，$A_{23} = A_{32} = 1$，$A_{13} = A_{31} = 1$，$A_{34} = A_{43} = 0.4$，$A_{45} = A_{54} = 0.4$。所有其他元素为 $0$。\n\n输出规范：\n- 您的程序应生成单行输出，其中包含按上述测试案例顺序排列的结果，格式为方括号内以逗号分隔的列表，每个切割权重四舍五入到 $6$ 位小数。例如：'[x1,x2,x3]'。输出字符串中不允许有空格。\n\n问题不涉及物理量或角度，因此无需单位说明。请遵循所述的划分规则并使用标准的对称特征值求解器，以确保数值稳定性和确定性。", "solution": "问题陈述已经过严格验证，并被认定为有效。它在科学上是合理的、定义明确的且客观的。该问题完全基于控制理论和应用数学领域中谱图理论的既定、形式化定义。它为邻接矩阵的构建提供了所有必要数据，并且后续的计算任务是明确无误的。所指定的过程是确定性的，对于每个测试案例，它都会产生一个唯一的、可验证的结果，该结果取决于标准数值特征值求解器的输出。\n\n我们现在将遵循从基本原理出发的既定方法来解决问题。\n\n核心任务是分析一个给定的无向加权图 $G = (V, E, w)$，其中 $V$ 是 $n$ 个顶点的集合，$E$ 是边的集合，$w$ 是权重函数。该图由其对称邻接矩阵 $A$ 表示，如果顶点 $i$ 和 $j$ 之间存在边，则 $A_{ij} = w(i, j) > 0$，否则 $A_{ij} = 0$。\n\n每个图的处理流程如下：\n\n1.  **构建图拉普拉斯矩阵**：\n    顶点 $i$ 的度为 $d_i = \\sum_{j=1}^{n} A_{ij}$。度矩阵 $D$ 是一个对角矩阵，其对角线元素为 $D_{ii} = d_i$。组合图拉普拉斯矩阵 $L$ 定义为：\n    $$L = D - A$$\n    该矩阵是实对称半正定矩阵。对于一个有 $n$ 个顶点的连通图，其特征值 $0 = \\lambda_1 \\le \\lambda_2 \\le \\dots \\le \\lambda_n$ 具有 $\\lambda_2 > 0$ 的性质。\n\n2.  **计算 Fiedler 向量**：\n    $L$ 的第二小特征值，记作 $\\lambda_2$，是图的代数连通度。任何与 $\\lambda_2$ 对应的特征向量 $v_2$ 都是一个 Fiedler 向量。我们数值计算对称矩阵 $L$ 的完整特征谱。由于 $L$ 是实对称的，其特征值是实数，其特征向量构成一个标准正交基。我们使用一个等同于 `numpy.linalg.eigh` 的数值程序，它按升序返回特征值。Fiedler 向量是这个排序列表中与第二个特征值对应的特征向量。\n\n3.  **提出二分划分**：\n    给定 Fiedler 向量 $v_2 \\in \\mathbb{R}^n$，我们基于应用于 $v_2$ 分量的零阈值规则，将顶点集 $V$ 划分为两个不相交的子集 $S$ 和 $\\bar{S}$。\n    $$S = \\{ i \\in V \\mid (v_2)_i \\ge 0 \\}$$\n    $$\\bar{S} = \\{ i \\in V \\mid (v_2)_i < 0 \\}$$\n    顶点集被划分为 $V = S \\cup \\bar{S}$。\n\n4.  **计算切割权重**：\n    该划分的质量通过切割权重来评估，即连接 $S$ 中顶点与 $\\bar{S}$ 中顶点的所有边的权重之和。\n    $$\\mathrm{cut}(S, \\bar{S}) = \\sum_{i \\in S} \\sum_{j \\in \\bar{S}} A_{ij}$$\n    对于无向图，由于求和是在不相交的顶点集上进行的，这个和将每条划分间的边恰好计算一次。\n\n我们现在将此四步过程应用于提供的每个测试案例。在问题描述中，顶点从 $1$ 开始索引，我们将其映射为从 $0$ 开始的矩阵表示索引（即顶点 $k$ 对应索引 $k-1$）。\n\n**案例 1：两个弱连接的三角形 ($n=6$)**\n非零邻接矩阵元素为 $A_{12}=1$, $A_{23}=1$, $A_{13}=1$, $A_{45}=1$, $A_{56}=1$, $A_{46}=1$ 及 $A_{34}=0.2$。\n使用从0开始的索引，邻接矩阵 $A^{(1)}$ 为：\n$$A^{(1)} = \\begin{pmatrix}\n0 & 1 & 1 & 0 & 0 & 0 \\\\\n1 & 0 & 1 & 0 & 0 & 0 \\\\\n1 & 1 & 0 & 0.2 & 0 & 0 \\\\\n0 & 0 & 0.2 & 0 & 1 & 1 \\\\\n0 & 0 & 0 & 1 & 0 & 1 \\\\\n0 & 0 & 0 & 1 & 1 & 0\n\\end{pmatrix}$$\n度矩阵 $D^{(1)}$ 是 $A^{(1)}$ 行和的对角矩阵：\n$$D^{(1)} = \\mathrm{diag}(2, 2, 2.2, 2.2, 2, 2)$$\n拉普拉斯矩阵为 $L^{(1)} = D^{(1)} - A^{(1)}$。我们计算 $L^{(1)}$ 的一个 Fiedler 向量 $v_2^{(1)}$。$v_2^{(1)}$ 各分量的符号预计会将两个三角形簇分开。数值计算得出的 Fiedler 向量将顶点划分为集合 $S=\\{1, 2, 3\\}$ 和 $\\bar{S}=\\{4, 5, 6\\}$（反之亦然，对于切割权重来说是等价的）。切割权重是这两个集合之间边的权重之和。唯一的这样一条边是 $(3, 4)$，权重为 $A_{34}=0.2$。\n$$\\mathrm{cut}(S, \\bar{S}) = A_{34}^{(1)} = 0.2$$\n\n**案例 2：带弱链接的加权链 ($n=4$)**\n非零邻接矩阵元素为 $A_{12}=2$, $A_{23}=0.1$ 及 $A_{34}=2$。\n邻接矩阵 $A^{(2)}$ 为：\n$$A^{(2)} = \\begin{pmatrix}\n0 & 2 & 0 & 0 \\\\\n2 & 0 & 0.1 & 0 \\\\\n0 & 0.1 & 0 & 2 \\\\\n0 & 0 & 2 & 0\n\\end{pmatrix}$$\n度矩阵 $D^{(2)}$ 为：\n$$D^{(2)} = \\mathrm{diag}(2, 2.1, 2.1, 2)$$\n拉普拉斯矩阵为 $L^{(2)} = D^{(2)} - A^{(2)}$。对于这个带有弱中心链接的链状图，其 Fiedler 向量预计会沿着这个链接将图划分开。划分将是 $S=\\{1, 2\\}$ 和 $\\bar{S}=\\{3, 4\\}$。切割权重由连接这两个集合的唯一一条边 $(2, 3)$ 决定。\n$$\\mathrm{cut}(S, \\bar{S}) = A_{23}^{(2)} = 0.1$$\n\n**案例 3：类似棒棒糖的图 ($n=5$)**\n非零邻接矩阵元素为 $A_{12}=1$, $A_{23}=1$, $A_{13}=1$, $A_{34}=0.4$ 及 $A_{45}=0.4$。该结构由一个三角形 $\\{1, 2, 3\\}$ 和一个在顶点 $3$ 处连接的路径 $\\{3, 4, 5\\}$ 组成。\n邻接矩阵 $A^{(3)}$ 为：\n$$A^{(3)} = \\begin{pmatrix}\n0 & 1 & 1 & 0 & 0 \\\\\n1 & 0 & 1 & 0 & 0 \\\\\n1 & 1 & 0 & 0.4 & 0 \\\\\n0 & 0 & 0.4 & 0 & 0.4 \\\\\n0 & 0 & 0 & 0.4 & 0\n\\end{pmatrix}$$\n度矩阵 $D^{(3)}$ 为：\n$$D^{(3)} = \\mathrm{diag}(2, 2, 2.4, 0.8, 0.4)$$\n拉普拉斯矩阵为 $L^{(3)} = D^{(3)} - A^{(3)}$。此图中最弱的连接是边 $(3, 4)$，它将密集的三角形子图与较稀疏的路径子图连接起来。Fiedler 向量预计会引发一个划分，将这些子结构分离开。最有可能的划分是 $S=\\{1, 2, 3\\}$ 和 $\\bar{S}=\\{4, 5\\}$。切割权重由连接这两个集合的唯一一条边 $(3, 4)$ 决定。\n$$\\mathrm{cut}(S, \\bar{S}) = A_{34}^{(3)} = 0.4$$\n\n数值实现将精确执行上述步骤以获得最终值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the spectral graph partitioning problem for a given test suite.\n    For each graph, it computes the combinatorial Laplacian, finds a Fiedler\n    vector, partitions the graph using a zero-threshold rule, and calculates\n    the resulting cut weight.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Adjacency matrices are constructed using 0-based indexing from the\n    # 1-based problem description.\n\n    # Case 1 (n=6): Two unit-weight triangles weakly connected.\n    A1 = np.zeros((6, 6))\n    A1[0, 1] = A1[1, 0] = 1.0\n    A1[1, 2] = A1[2, 1] = 1.0\n    A1[0, 2] = A1[2, 0] = 1.0\n    A1[3, 4] = A1[4, 3] = 1.0\n    A1[4, 5] = A1[5, 4] = 1.0\n    A1[3, 5] = A1[5, 3] = 1.0\n    A1[2, 3] = A1[3, 2] = 0.2\n\n    # Case 2 (n=4): A weighted chain with a weak middle link.\n    A2 = np.zeros((4, 4))\n    A2[0, 1] = A2[1, 0] = 2.0\n    A2[1, 2] = A2[2, 1] = 0.1\n    A2[2, 3] = A2[3, 2] = 2.0\n\n    # Case 3 (n=5): A lollipop-like graph.\n    A3 = np.zeros((5, 5))\n    A3[0, 1] = A3[1, 0] = 1.0\n    A3[1, 2] = A3[2, 1] = 1.0\n    A3[0, 2] = A3[2, 0] = 1.0\n    A3[2, 3] = A3[3, 2] = 0.4\n    A3[3, 4] = A3[4, 3] = 0.4\n\n    test_cases = [A1, A2, A3]\n    results = []\n\n    for A in test_cases:\n        # Step 1: Construct the combinatorial graph Laplacian L = D - A.\n        # Degree matrix D\n        D = np.diag(np.sum(A, axis=1))\n        # Laplacian L\n        L = D - A\n\n        # Step 2: Compute a Fiedler vector numerically.\n        # np.linalg.eigh computes eigenvalues and eigenvectors for a symmetric matrix.\n        # It conveniently returns eigenvalues in ascending order.\n        eigenvalues, eigenvectors = np.linalg.eigh(L)\n        \n        # The Fiedler vector corresponds to the second-smallest eigenvalue.\n        # Eigenvalues are sorted, so the second one is at index 1.\n        fiedler_vector = eigenvectors[:, 1]\n\n        # Step 3: Propose a binary partition using the zero-threshold rule.\n        # S = {i | v_i >= 0}, S_bar = {i | v_i < 0}\n        n = A.shape[0]\n        S = {i for i in range(n) if fiedler_vector[i] >= 0}\n        S_bar = {i for i in range(n) if fiedler_vector[i] < 0}\n\n        # Step 4: Compute the resulting cut weight.\n        # cut(S, S_bar) = sum_{i in S, j in S_bar} A_ij\n        cut_weight = 0.0\n        for i in S:\n            for j in S_bar:\n                cut_weight += A[i, j]\n                \n        # Round the result to 6 decimal places.\n        results.append(f\"{cut_weight:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2710619"}]}