{"hands_on_practices": [{"introduction": "在经典的确定性控制理论中，一个基本原则是，如果系统是可控的，我们总能设计一个反馈控制器来稳定它。然而，当控制回路中引入网络通信时，这个直观的结论可能不再成立。本练习将引导你通过一个具体的例子，从第一性原理出发，揭示一个深刻的现象：即使是完全可控的系统，在执行器通道存在随机数据包丢失的情况下，当丢包率超过某个临界阈值时，系统也可能变得无法实现均方意义下的镇定。通过这个实践，你将量化地理解开环系统的不稳定增长与控制作用的成功施加之间的“竞争”关系，这是网络化控制系统分析中的一个核心挑战。[@problem_id:2727000]", "problem": "考虑一个网络化控制系统（NCS）中的标量离散时间对象，其执行器数据包丢失被建模为一个乘性伯努利过程。该对象演变遵循 $x_{k+1} = a\\,x_k + b\\,\\gamma_k\\,u_k$，其中 $x_k \\in \\mathbb{R}$ 是状态，$u_k \\in \\mathbb{R}$ 是控制输入，$a \\in \\mathbb{R}$ 和 $b \\in \\mathbb{R}\\setminus\\{0\\}$ 是固定参数，$\\{\\gamma_k\\}_{k \\ge 0}$ 是一个独立同分布（i.i.d.）序列，其中 $\\gamma_k \\in \\{0,1\\}$ 表示在时间 $k$ 发送的控制数据包是否成功应用于执行器。成功概率为 $\\mathbb{P}\\{\\gamma_k = 1\\} = p$，丢包概率为 $\\mathbb{P}\\{\\gamma_k = 0\\} = 1-p$，其中 $0 \\le p \\le 1$。控制器拥有完美、瞬时的状态信息，并应用增益恒为 $K \\in \\mathbb{R}$ 的静态状态反馈 $u_k = K x_k$。目标是均方镇定，即 $\\lim_{k \\to \\infty} \\mathbb{E}[x_k^2] = 0$。\n\n给定具体对象参数为 $a = 2$ 和 $b = 1$。在确定性意义上（无丢包），由于 $b \\ne 0$，对 $(a,b)$ 是可控的。然而，在有损的执行信道上，尽管具有确定性可控性，但对于某些 $p$ 值，均方可镇定性可能会失效。\n\n任务：\n- 从均方稳定性的定义和全期望定律出发，推导在反馈 $u_k = K x_k$ 和上述 i.i.d. 伯努利数据包模型下，$\\mathbb{E}[x_{k+1}^2]$ 的单步二阶矩递推关系。展示作用于 $\\mathbb{E}[x_k^2]$ 的乘性因子如何依赖于 $a$、 $b$、 $K$ 和 $p$，并确定使该因子最小化的 $K$ 的选择。\n- 从此推导中，获得关于 $p$ 的条件（用 $a$ 和 $b$ 表示），该条件是存在一个实现均方稳定性的静态增益 $K$ 的充要条件。\n- 将您的表达式具体化到给定对象 $a = 2$ 和 $b = 1$ 的情况，并计算临界成功概率 $p^{\\star}$（即使得均方镇定成为可能的 $p$ 的下确界）。然后使用 $p = 0.70$ 简要论证为何这提供了一个确定性可控性成立但均方可镇定性失效的反例，并从丢包期间的开环增长和成功传输期间的控制作用这两个相互竞争的效应方面解释其根本原因。\n\n给出 $a = 2$ 和 $b = 1$ 时的临界成功概率 $p^{\\star}$ 的精确值作为最终答案。无需四舍五入。最终答案中不要包含单位。", "solution": "首先验证问题陈述。\n\n**步骤1：提取给定条件**\n- 对象动态：$x_{k+1} = a\\,x_k + b\\,\\gamma_k\\,u_k$\n- 状态：$x_k \\in \\mathbb{R}$\n- 控制输入：$u_k \\in \\mathbb{R}$\n- 对象参数：$a \\in \\mathbb{R}$，$b \\in \\mathbb{R}\\setminus\\{0\\}$\n- 数据包丢包模型：$\\{\\gamma_k\\}_{k \\ge 0}$ 是一个独立同分布（i.i.d.）的伯努利序列，其中 $\\gamma_k \\in \\{0,1\\}$。\n- 概率：$\\mathbb{P}\\{\\gamma_k = 1\\} = p$ 和 $\\mathbb{P}\\{\\gamma_k = 0\\} = 1-p$，其中 $0 \\le p \\le 1$。\n- 控制器：静态状态反馈 $u_k = K x_k$，增益 $K \\in \\mathbb{R}$ 为常数。\n- 目标：均方镇定，即 $\\lim_{k \\to \\infty} \\mathbb{E}[x_k^2] = 0$。\n- 具体参数：$a = 2$ 和 $b = 1$。\n\n**步骤2：使用提取的给定条件进行验证**\n- **科学依据充分：** 该问题是网络化控制系统（NCS）理论和随机控制中的一个标准基础问题。用于数据包丢包的伯努利模型是一种被广泛使用和接受的简化模型。\n- **适定性：** 问题定义明确，目标清晰，并有足够的信息来推导临界概率的唯一解。\n- **客观性：** 问题使用精确的数学语言陈述，没有主观或含糊不清的术语。\n- **结论：** 该问题是有效的，因为它科学上合理、适定、客观，并且不包含内部矛盾或缺失信息。\n\n**步骤3：判定和行动**\n该问题有效。将提供完整解答。\n\n**二阶矩递推的推导**\n我们从闭环系统动态开始，将控制律 $u_k = K x_k$ 代入对象方程中：\n$$x_{k+1} = a\\,x_k + b\\,\\gamma_k\\,(K x_k) = (a + b K \\gamma_k) x_k$$\n目标是均方稳定性，它关系到状态二阶矩 $\\mathbb{E}[x_k^2]$ 的演化。我们推导该量的单步递推关系。\n$$x_{k+1}^2 = ((a + b K \\gamma_k) x_k)^2 = (a + b K \\gamma_k)^2 x_k^2$$\n为了计算期望 $\\mathbb{E}[x_{k+1}^2]$，我们使用全期望定律，以在时间 $k$ 可用的信息（我们用滤子 $\\mathcal{F}_k$ 表示）为条件。状态 $x_k$ 是 $\\mathcal{F}_k$-可测的，而由于 i.i.d. 假设，随机变量 $\\gamma_k$ 独立于 $\\mathcal{F}_k$。\n$$\\mathbb{E}[x_{k+1}^2] = \\mathbb{E}[\\mathbb{E}[x_{k+1}^2 | \\mathcal{F}_k]] = \\mathbb{E}[\\mathbb{E}[(a + b K \\gamma_k)^2 x_k^2 | \\mathcal{F}_k]]$$\n由于给定 $\\mathcal{F}_k$ 时 $x_k$ 是已知的，因此在内部期望中可以将其视为常数：\n$$\\mathbb{E}[x_{k+1}^2] = \\mathbb{E}[x_k^2 \\mathbb{E}[(a + b K \\gamma_k)^2 | \\mathcal{F}_k]]$$\n因为 $\\gamma_k$ 独立于 $\\mathcal{F}_k$，所以条件期望不影响其期望值：\n$$\\mathbb{E}[x_{k+1}^2] = \\mathbb{E}[x_k^2 \\mathbb{E}[(a + b K \\gamma_k)^2]] = \\mathbb{E}[(a + b K \\gamma_k)^2] \\mathbb{E}[x_k^2]$$\n项 $\\mathbb{E}[(a + b K \\gamma_k)^2]$ 是二阶矩的乘性因子。我们可以用伯努利随机变量 $\\gamma_k$ 的定义来展开这个期望：\n\\begin{align*} \\mathbb{E}[(a + b K \\gamma_k)^2] &= (a + b K \\cdot 1)^2 \\mathbb{P}\\{\\gamma_k = 1\\} + (a + b K \\cdot 0)^2 \\mathbb{P}\\{\\gamma_k = 0\\} \\\\ &= (a + b K)^2 p + a^2 (1-p) \\end{align*}\n因此，单步二阶矩递推关系为：\n$$\\mathbb{E}[x_{k+1}^2] = \\left[ p(a + bK)^2 + (1-p)a^2 \\right] \\mathbb{E}[x_k^2]$$\n为使系统均方稳定，我们需要 $\\lim_{k \\to \\infty} \\mathbb{E}[x_k^2] = 0$，这当且仅当乘性因子严格小于1时成立：\n$$p(a + bK)^2 + (1-p)a^2 < 1$$\n\n**最优增益和可镇定性条件**\n要找到一个镇定增益 $K$ *存在*的条件，我们必须找到使该因子最小化的增益 $K$，并检查该最小值是否可以小于1。设 $f(K) = p(a + bK)^2 + (1-p)a^2$。这是一个关于 $K$ 的二次函数。我们通过对 $K$ 求导并令其为零来找到最小值。\n$$\\frac{df}{dK} = \\frac{d}{dK} \\left[ p(a^2 + 2abK + b^2K^2) + (1-p)a^2 \\right] = p(2ab + 2b^2K)$$\n假设 $p > 0$ 且 $b \\ne 0$ （如给定），我们将导数设为0：\n$$2ab + 2b^2K = 0 \\implies K = -\\frac{2ab}{2b^2} = -\\frac{a}{b}$$\n这个最优增益，我们称之为 $K^{\\star} = -a/b$，使该因子最小化。二阶导数 $\\frac{d^2f}{dK^2} = 2pb^2 > 0$ 证实了这是一个最小值。\n将 $K^{\\star}$ 代回因子中，得到可能的最小值：\n$$\\min_K f(K) = p\\left(a + b\\left(-\\frac{a}{b}\\right)\\right)^2 + (1-p)a^2 = p(a-a)^2 + (1-p)a^2 = a^2(1-p)$$\n系统是均方可镇定的，当且仅当这个最小因子小于1。注意，如果开环对象本身已经是均方稳定的（即 $|a|<1$），那么对于任何 $p \\in [0,1]$ 它都是稳定的（当 $K=0$ 时，因子为 $a^2 < 1$）。有趣的情况是当 $|a| \\ge 1$ 时。可镇定性的充要条件是：\n$$a^2(1-p) < 1$$\n解出成功概率 $p$：\n$$1-p < \\frac{1}{a^2} \\implies p > 1 - \\frac{1}{a^2}$$\n\n**具体化和反例**\n我们给定了具体的对象参数 $a=2$ 和 $b=1$。由于 $|a| = 2 > 1$，开环系统是不稳定的。均方可镇定性的条件是：\n$$p > 1 - \\frac{1}{2^2} = 1 - \\frac{1}{4} = \\frac{3}{4}$$\n临界成功概率 $p^{\\star}$ 是使得镇定成为可能的概率 $p$ 集合的下确界。因此：\n$$p^{\\star} = \\frac{3}{4} = 0.75$$\n我们现在考虑 $p=0.70$ 的情况。\n由于 $0.70 < 0.75$，我们推导的条件 $p > p^{\\star}$ 未被满足。这意味着对于 $p=0.70$ 的成功概率，系统不能通过任何静态状态反馈增益 $K$ 实现均方镇定。\n这为“确定性可控性意味着在随机丢包下的可镇定性”这一观点提供了一个反例。对 $(a,b)=(2,1)$ 是可控的，因为可控性矩阵 $[b]$ 的秩为1。如果没有数据包丢失（$p=1$），我们可以选择 $K=-2$ 使闭环极点 $a+bK = 2-2=0$，从而实现无差拍镇定。\n然而，当 $p=0.70$ 时，二阶矩放大因子的最小可能值为 $a^2(1-p) = 2^2(1-0.70) = 4(0.30) = 1.2$。由于这个最小因子大于1，对于任何 $K$ 的选择，$\\mathbb{E}[x_k^2]$ 都将发散。\n其根本原因在于两种效应之间的竞争。在数据包丢失期间（以概率 $1-p$ 发生），系统根据其不稳定的开环动态 $x_{k+1} = ax_k$ 演化。状态的平方幅值被放大 $a^2$ 倍。在成功传输期间（以概率 $p$ 发生），控制器可以通过 $x_{k+1} = (a+bK)x_k$ 来减小状态的幅值。最有效的控制动作（使用 $K^{\\star}=-a/b$）能完全消除状态。均方稳定性取决于这两种结果的加权平均。条件 $a^2(1-p)<1$ 表明，即使有一个以概率 $p$ 工作的完美控制器，丢包期间的期望增长 $a^2(1-p)$ 本身也必须小于1。如果数据包丢失过于频繁（即 $p$ 太小），则在不受控制的步骤中的爆炸性增长将压倒在受控步骤中采取的任何镇定作用。", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "2727000"}, {"introduction": "认识到数据包丢失可能导致系统无法稳定后，一个自然的问题是如何缓解这一问题。在通信工程中，自动重传请求（ARQ）是一种常见的提高通信可靠性的技术。本练习将探讨将这种网络层协议与控制系统相结合的效果，你将动手推导在使用ARQ机制时，系统的有效丢包率如何降低，并进一步计算出系统能够保持可镇定性所能容忍的最大原始信道丢包率。这个实践将帮助你理解如何通过跨层设计的思想，利用通信协议的特性来扩大控制系统的稳定边界。[@problem_id:2726978]", "problem": "一个单输入标量对象在一个网络化控制系统 (NCS) 中通过有损数字驱动链路进行控制。该对象根据以下线性时不变模型在离散时间内演化：\n$$\nx_{k+1} = a\\,x_k + b\\,u_k,\n$$\n其中 $a \\in \\mathbb{R}$ 和 $b \\in \\mathbb{R} \\setminus \\{0\\}$ 是已知常数。在每个采样时刻 $k$，控制器计算一个静态状态反馈 $u_k = K\\,x_k$，并通过一个无线链路将其发送给执行器。该链路每次传输尝试的丢包是独立同分布的 (i.i.d.)，概率为 $p \\in (0,1)$。通信协议采用一种自动重传请求 (ARQ) 方案，该方案在采样周期内最多允许 $r$ 次重传；也就是说，在每个采样周期内，对于同一个控制值 $K\\,x_k$，最多有 $r+1$ 次传输尝试。如果在该周期内至少有一次尝试成功，执行器就应用该周期的预期输入 $u_k = K\\,x_k$；否则，不施加控制，即该周期内 $u_k = 0$。假设选择的采样周期足够长，以确保所有 $r$ 次重传（如果使用）都能在该周期内完成，并且控制器端的传感是完美且瞬时的（唯一的缺陷在于驱动链路）。同时假设 $|a| > 1$，因此开环对象是不稳定的。\n\n1) 从独立事件的概率乘法法则出发，推导一个采样周期内的有效丢包概率，记为 $p_{\\mathrm{eff}}$，并将其表示为 $p$ 和 $r$ 的函数。\n\n2) 使用均方稳定性的定义，并通过一个伯努利随机变量 $\\gamma_k \\in \\{0,1\\}$（其中 $\\mathbb{P}[\\gamma_k = 1] = 1 - p_{\\mathrm{eff}}$ 表示在周期 $k$ 内驱动成功）来对接收事件建模，写出在闭环随机动态\n$$\nx_{k+1} = \\bigl(a + bK\\,\\gamma_k\\bigr)\\,x_k.\n$$\n下的 $x_k$ 的单步条件二阶矩演化。通过最小化关于静态增益 $K$ 的条件二阶矩增长因子，获得一个关于 $p_{\\mathrm{eff}}$（用 $a$ 表示）的充要条件，以保证存在某个 $K \\in \\mathbb{R}$ 能够确保均方稳定性。\n\n3) 结合第 1) 部分和第 2) 部分的结果，求解最大的基础单次尝试丢包概率 $p_{\\max}(a,r)$，将其表示为 $a$ 和 $r$ 的显式闭式函数，使得在上述最多有 $r$ 次重传的 ARQ 方案下，存在一个静态增益 $K$ 能够实现均方稳定性。请以 $p_{\\max}(a,r)$ 的单个解析表达式形式提供最终答案，不带单位。", "solution": "所述问题具有科学依据，是适定且完整的。它提出了网络化控制系统理论中的一个标准场景，并要求基于概率论和稳定性理论的基本原理进行严谨的推导。所有必需的数据和定义均已提供，不存在内部矛盾或歧义。因此，我将按要求分三部分来解决这个问题。\n\n第一步是确定在给定的采样周期内的有效丢包概率 $p_{\\mathrm{eff}}$。通信协议允许一次初始传输和最多 $r$ 次重传，即在一个采样周期内总共最多有 $m = r+1$ 次传输尝试。当且仅当所有 $m$ 次尝试都失败时，才认为该周期的包丢失了。题目说明了这些尝试是独立同分布的 (i.i.d.)，每次尝试的失败概率为 $p$。因此，单次尝试的成功传输概率为 $1-p$。\n采样周期 $k$ 的有效丢包事件是 $m=r+1$ 个独立失败事件的合取。使用独立事件的乘法法则，其概率为：\n$$\np_{\\mathrm{eff}} = \\mathbb{P}[\\text{attempt 1 fails AND attempt 2 fails AND ... AND attempt } m \\text{ fails}]\n$$\n$$\np_{\\mathrm{eff}} = \\mathbb{P}[\\text{attempt 1 fails}] \\times \\mathbb{P}[\\text{attempt 2 fails}] \\times \\dots \\times \\mathbb{P}[\\text{attempt } m \\text{ fails}]\n$$\n由于每次尝试的失败概率均为 $p$，这可以简化为：\n$$\np_{\\mathrm{eff}} = p \\times p \\times \\dots \\times p \\quad (r+1 \\text{ times})\n$$\n$$\np_{\\mathrm{eff}} = p^{r+1}\n$$\n这个表达式给出了有效丢包概率，作为单次尝试丢包概率 $p$ 和最大重传次数 $r$ 的函数。\n\n问题的第二部分要求找到均方稳定性的条件。闭环动态由以下随机差分方程给出：\n$$\nx_{k+1} = (a + bK\\gamma_k)x_k\n$$\n其中 $\\gamma_k$ 是一个伯努利随机变量。这个变量对采样周期 $k$ 内的通信结果进行建模。具体来说，如果控制输入成功接收（$r+1$ 次尝试中至少有一次成功），则 $\\gamma_k=1$；如果所有尝试都失败，则 $\\gamma_k=0$。成功接收的概率是 $1 - p_{\\mathrm{eff}}$，因此 $\\mathbb{P}[\\gamma_k=1] = 1 - p_{\\mathrm{eff}}$。失败的概率是 $p_{\\mathrm{eff}}$，因此 $\\mathbb{P}[\\gamma_k=0] = p_{\\mathrm{eff}}$。\n\n这种形式的离散时间线性随机系统是均方稳定的，当且仅当 $\\lim_{k \\to \\infty} \\mathbb{E}[x_k^2] = 0$。如果给定当前状态，下一步状态的平方的条件期望平均而言是减小的，那么这一点就能得到保证。我们分析状态的二阶矩 $\\mathbb{E}[x_k^2]$ 的演化。让我们计算条件二阶矩：\n$$\n\\mathbb{E}[x_{k+1}^2 | x_k] = \\mathbb{E}[(a + bK\\gamma_k)^2 x_k^2 | x_k]\n$$\n由于 $x_k$ 在时间步 $k$ 是已知的，我们可以将其从期望中提出来：\n$$\n\\mathbb{E}[x_{k+1}^2 | x_k] = x_k^2 \\mathbb{E}[(a + bK\\gamma_k)^2]\n$$\n期望是关于随机变量 $\\gamma_k$ 求的。根据离散随机变量的全期望定律：\n$$\n\\mathbb{E}[(a + bK\\gamma_k)^2] = (a + bK(1))^2 \\mathbb{P}[\\gamma_k=1] + (a + bK(0))^2 \\mathbb{P}[\\gamma_k=0]\n$$\n$$\n\\mathbb{E}[(a + bK\\gamma_k)^2] = (a + bK)^2 (1 - p_{\\mathrm{eff}}) + a^2 p_{\\mathrm{eff}}\n$$\n为了使系统均方稳定，必须存在一个增益 $K$，使得这个二阶矩增长因子严格小于 1：\n$$\n(a + bK)^2 (1 - p_{\\mathrm{eff}}) + a^2 p_{\\mathrm{eff}} < 1\n$$\n让我们定义函数 $G(K) = (a + bK)^2 (1 - p_{\\mathrm{eff}}) + a^2 p_{\\mathrm{eff}}$。我们需要判断 $G(K)$ 相对于 $K$ 的最小值是否小于 1。$G(K)$ 是一个关于 $K$ 的二次函数。由于 $b \\neq 0$ 且 $p \\in (0,1)$ 意味着 $p_{\\mathrm{eff}} \\in (0,1)$，所以 $K^2$ 项的系数 $b^2(1-p_{\\mathrm{eff}})$ 是正的。因此，抛物线 $G(K)$ 开口向上，并有唯一的最小值。为了找到最小值，我们计算关于 $K$ 的导数并将其设为零：\n$$\n\\frac{dG}{dK} = 2b(a+bK)(1 - p_{\\mathrm{eff}}) = 0\n$$\n由于 $b \\neq 0$ 且 $1-p_{\\mathrm{eff}} \\neq 0$，最小化 $G(K)$ 的最优增益 $K^*$ 由 $a+bK^*=0$ 给出，即 $K^* = -a/b$。\n将这个最优增益代回 $G(K)$ 的表达式中，我们得到增长因子的最小值：\n$$\n\\min_K G(K) = G(K^*) = (a + b(-a/b))^2 (1 - p_{\\mathrm{eff}}) + a^2 p_{\\mathrm{eff}}\n$$\n$$\n\\min_K G(K) = (a - a)^2 (1 - p_{\\mathrm{eff}}) + a^2 p_{\\mathrm{eff}} = 0 + a^2 p_{\\mathrm{eff}} = a^2 p_{\\mathrm{eff}}\n$$\n存在稳定化增益 $K$ 的充要条件是这个最小增长因子小于 1：\n$$\na^2 p_{\\mathrm{eff}} < 1\n$$\n这可以重写为关于有效丢包概率的条件：\n$$\np_{\\mathrm{eff}} < \\frac{1}{a^2}\n$$\n这是均方可镇定性所要求的关于 $p_{\\mathrm{eff}}$ 的条件。\n\n最后，第三部分要求我们结合这两个结果来找到最大的单次尝试丢包概率 $p_{\\max}(a,r)$，使得存在一个静态稳定化增益。\n从第 1 部分，我们有 $p_{\\mathrm{eff}} = p^{r+1}$。\n从第 2 部分，可镇定性的条件是 $p_{\\mathrm{eff}} < 1/a^2$。\n将第一个表达式代入第二个表达式，得到关于单次尝试概率 $p$ 的条件：\n$$\np^{r+1} < \\frac{1}{a^2}\n$$\n由于 $p$ 必须是非负的，且 $r+1 > 0$，我们可以对不等式两边取 $(r+1)$ 次方根，而不用改变其方向：\n$$\np < \\left(\\frac{1}{a^2}\\right)^{\\frac{1}{r+1}}\n$$\n问题要求的是可以实现稳定性的最大单次尝试丢包概率 $p_{\\max}$。这对应于所有此类有效概率 $p$ 的集合的上确界。因此，我们有：\n$$\np_{\\max}(a,r) = \\left(\\frac{1}{a^2}\\right)^{\\frac{1}{r+1}}\n$$\n该表达式给出了稳定区域的边界，用单次尝试丢包概率 $p$ 表示，它是对象参数 $a$ 和重传次数 $r$ 的函数。对于任何 $p < p_{\\max}(a,r)$，都可以找到一个增益 $K$ 来在均方意义下稳定该系统。", "answer": "$$\\boxed{\\left(\\frac{1}{a^2}\\right)^{\\frac{1}{r+1}}}$$", "id": "2726978"}, {"introduction": "网络造成的影响不仅限于控制输入的执行，同样也存在于状态信息的获取过程中。对于依赖状态估计进行反馈的控制系统而言，传感器数据的丢失会直接影响估计器的性能，甚至导致其发散。本练习将带你深入分析网络丢包对卡尔曼滤波器的影响，你将推导一个不稳定系统在有损网络下，其估计误差协方差保持有界的临界丢包率。这个实践将从标量系统推广到多维系统，让你掌握分析不稳定且可观测模式下估计稳定性的关键方法。[@problem_id:2726935]", "problem": "考虑一个离散时间网络化控制系统（NCS），其中传感器通过有损网络将测量值传输给状态估计器，该估计器根据实际到达的测量值运行最优Kalman滤波器。数据包丢失过程被建模为独立同分布的伯努利过程。您可以假设所有随机变量在时间上相互独立，并且彼此之间也相互独立，并且估计器在每个时刻都知道数据包是否已到达。\n\nA部分（标量情况）。设被控对象为标量线性时不变随机系统\n$$\nx_{k+1} = a\\,x_{k} + w_{k}, \\qquad y_{k} = x_{k} + v_{k},\n$$\n其中 $|a|>1$，$w_{k} \\sim \\mathcal{N}(0,Q)$ 且 $v_{k} \\sim \\mathcal{N}(0,R)$，$Q>0$，$R>0$。在每个时刻 $k$，传感器的数据包以概率 $p \\in (0,1)$ 丢失，并以概率 $1-p$ 被成功传输。估计器在每一步都应用标准的Kalman时间更新，并且仅在数据包到达时应用标准的Kalman测量更新。从任意有限的初始误差协方差出发，使用第一性原理（Kalman协方差递归和独立丢包的几何级数基本性质）推导临界丢失概率 $p_{c}$，使得期望估计误差协方差发散的充分必要条件是 $p \\ge p_{c}$。将 $p_{c}$ 表示为 $a$ 的符号函数。\n\nB部分（多维情况）。现在考虑多维线性时不变随机系统\n$$\nx_{k+1} = A\\,x_{k} + w_{k}, \\qquad y_{k} = C\\,x_{k} + v_{k},\n$$\n其中 $w_{k} \\sim \\mathcal{N}(0,W)$，$v_{k} \\sim \\mathcal{N}(0,V)$，$W \\succeq 0$，$V \\succ 0$。假设矩阵对 $(A,C)$ 是可检测的，并且 $A$ 至少有一个特征值 $\\lambda$ 满足 $|\\lambda|>1$；令 $A_{u}$ 表示 $A$ 在由满足 $|\\lambda|>1$ 且可从 $C$ 观测的 $A$ 的特征值所对应的特征向量张成的最小 $A$-不变子空间上的限制，并令 $\\rho(A_{u})$ 为 $A_{u}$ 的谱半径。与标量情况一样，数据包以概率 $p \\in (0,1)$ 独立丢失，并以概率 $1-p$ 被成功传输，估计器根据到达事件应用最优Kalman滤波器。通过对连续丢包期间沿不稳定模式的协方差增长进行推理，并仅使用关于线性系统和Kalman滤波的公认事实，将您在A部分得到的结果推广，以获得临界丢失概率 $p_{c}$ 关于 $\\rho(A_{u})$ 的闭式符号表达式。\n\n您的最终答案必须是多维情况下 $p_c$ 的单个闭式解析表达式（当 $A=a$ 且 $C=1$ 时，该表达式应简化为标量情况的结果）。不包括单位。无需进行数值四舍五入。", "solution": "这个问题要求推导在有损网络上运行的Kalman滤波器稳定性的临界数据包丢失概率。我们首先对问题陈述进行验证。\n\n**问题验证**\n\n步骤1：提取已知条件。\n\nA部分（标量情况）：\n-   系统：$x_{k+1} = a\\,x_{k} + w_{k}$ 和 $y_{k} = x_{k} + v_{k}$。\n-   参数：$|a|>1$，$w_{k} \\sim \\mathcal{N}(0,Q)$ 且 $Q>0$，$v_{k} \\sim \\mathcal{N}(0,R)$ 且 $R>0$。\n-   网络：数据包丢失是一个独立同分布的伯努利过程，丢失概率为 $p \\in (0,1)$。\n-   估计器：最优Kalman滤波器，总是应用时间更新，仅在数据包到达时应用测量更新。\n-   目标：找到临界概率 $p_{c}$，使得期望估计误差协方差发散的充分必要条件是 $p \\ge p_{c}$。\n\nB部分（多维情况）：\n-   系统：$x_{k+1} = A\\,x_{k} + w_{k}$ 和 $y_{k} = C\\,x_{k} + v_{k}$。\n-   参数：$w_{k} \\sim \\mathcal{N}(0,W)$ 且 $W \\succeq 0$，$v_{k} \\sim \\mathcal{N}(0,V)$ 且 $V \\succ 0$。\n-   假设：$(A,C)$ 是可检测的，且 $A$ 至少有一个特征值 $\\lambda$ 满足 $|\\lambda|>1$。\n-   定义：$A_{u}$ 是 $A$ 在由不稳定的（$|\\lambda|>1$）且可观测的特征值所对应的特征向量张成的最小 $A$-不变子空间上的限制。$\\rho(A_{u})$ 是 $A_{u}$ 的谱半径。\n-   网络和估计器：与A部分相同。\n-   目标：将A部分的结果推广，以 $\\rho(A_{u})$ 的形式表示 $p_{c}$。\n\n最终答案应为多维情况下的 $p_c$ 表达式。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据，提法恰当且客观。这是网络化控制系统分析中的一个标准问题，基于线性系统和估计理论（Kalman滤波）的基本原理。所有术语都得到了精确定义，假设是标准的且足以进行分析（例如，$(A,C)$ 的可检测性至关重要），问题结构合乎逻辑。没有矛盾、缺失数据或不科学的前提。\n\n步骤3：结论和行动。\n问题有效。我们继续进行求解。\n\n**A部分：标量情况**\n\n令 $P_{k|k-1}$ 表示在时刻 $k$ 的先验误差协方差，定义为 $\\mathbb{E}[(x_k - \\hat{x}_{k|k-1})^2]$，令 $P_{k|k}$ 表示后验误差协方差。为简洁起见，我们令 $P_k = P_{k|k-1}$。令 $\\gamma_k$ 为一个伯努利随机变量，当数据包到达时 $\\gamma_k=1$（概率为 $1-p$），丢失时 $\\gamma_k=0$（概率为 $p$）。Kalman滤波器方程如下：\n\n1.  **时间更新：** 下一步的先验协方差由当前步骤的后验协方差计算得出。此更新与数据包是否丢失无关。\n    $$P_{k+1|k} = a P_{k|k} a^T + Q = a^2 P_{k|k} + Q$$\n\n2.  **测量更新：** 后验协方差由先验协方差计算得出。此更新取决于测量数据包是否到达。\n\n    如果数据包到达（$\\gamma_k=1$）：\n    Kalman增益为 $K_k = P_k (P_k + R)^{-1}$。\n    后验协方差为 $P_{k|k} = (1-K_k) P_k = P_k - P_k^2 (P_k + R)^{-1} = \\frac{P_k R}{P_k+R}$。\n\n    如果数据包丢失（$\\gamma_k=0$）：\n    没有接收到新信息，因此后验估计与先验估计相同，即 $\\hat{x}_{k|k} = \\hat{x}_{k|k-1}$。因此，误差协方差不变：$P_{k|k} = P_k$。\n\n我们可以将这些组合成一个关于先验协方差 $P_k$ 的单一随机递归关系：\n$$P_{k+1} = a^2 P_{k|k} + Q = \\begin{cases} a^2 \\frac{P_k R}{P_k + R} + Q & \\text{概率为 } 1-p \\\\ a^2 P_k + Q & \\text{概率为 } p \\end{cases}$$\n我们定义两个分别对应于数据包到达和丢失的映射：\n$g_1(P) = a^2 \\frac{PR}{P+R} + Q$\n$g_0(P) = a^2 P + Q$\n\n期望误差协方差 $\\mathbb{E}[P_k]$ 的发散条件可以通过分析系统在长时间连续丢包下的行为来确定。当一个数据包到达时，误差协方差被“重置”。对于大的 $P_k$，更新映射 $g_1(P_k)$ 趋近于一个有限值：$\\lim_{P_k \\to \\infty} g_1(P_k) = a^2 R + Q$。此更新抵消了误差的增长。当一个数据包丢失时，误差协方差根据 $g_0(P_k)$ 增长，对于大的 $P_k$，其增长尺度为 $a^2 P_k$。\n\n期望协方差的稳定性取决于丢包期间的增长因子 $a^2$ 与该事件发生概率之间的平衡。期望值 $\\mathbb{E}[P_k]$ 是对所有可能的丢包和到达序列的平均。主导期望并导致发散的序列是那些包含许多连续丢包的序列。\n\n考虑一个连续 $m$ 次丢包的序列。协方差按 $g_0^m(P)$ 增长。这个项大致以 $(a^2)^m$ 的因子增长。这样 $m$ 次丢包序列的概率是 $p^m$。此类路径对期望协方差的贡献包含形如 $p^m (a^2)^m = (p a^2)^m$ 的项。为了使期望保持有界，这些主导项对 $m$ 的求和必须收敛。这要求几何级数的底小于1。\n$$p a^2 < 1$$\n反之，如果 $p a^2 \\ge 1$，则级数发散，表明期望协方差无界增长。临界概率 $p_c$ 是发生这种转变时的 $p$ 值：\n$$p_c a^2 = 1 \\implies p_c = \\frac{1}{a^2}$$\n由于问题陈述 $|a|>1$，我们有 $a^2 = |a|^2 > 1$，所以 $p_c \\in (0,1)$ 是一个有效的概率值。\n\n通过分析 $\\mathbb{E}[P_k]$ 的递归关系，可以使这个启发式论证更加严谨。对随机递归关系取期望：\n$$\\mathbb{E}[P_{k+1}] = p \\, \\mathbb{E}[a^2 P_k + Q] + (1-p) \\, \\mathbb{E}\\left[a^2 \\frac{P_k R}{P_k + R} + Q\\right]$$\n函数 $h(P) = \\frac{PR}{P+R}$ 是凹函数。根据Jensen不等式，$\\mathbb{E}[h(P_k)] \\le h(\\mathbb{E}[P_k])$。这给出了 $\\bar{P}_k = \\mathbb{E}[P_k]$ 演化的一个上界：\n$$\\bar{P}_{k+1} \\le p a^2 \\bar{P}_k + (1-p) a^2 \\frac{\\bar{P}_k R}{\\bar{P}_k + R} + Q$$\n右侧定义了一个映射 $\\psi(\\bar{P})$。如果这个映射对于大的 $\\bar{P}$ 是一个压缩映射，那么稳定性就得到保证，这由其在无穷远处的导数（或斜率）决定：\n$$\\lim_{\\bar{P}\\to\\infty} \\frac{d\\psi}{d\\bar{P}} = \\lim_{\\bar{P}\\to\\infty} \\left( p a^2 + (1-p) a^2 \\frac{R^2}{(\\bar{P}+R)^2} \\right) = p a^2$$\n如果 $p a^2 < 1$，该映射在无穷远处是压缩的，从而保证 $\\bar{P}_k$ 是有界的。这证实了临界概率为 $p_c = 1/a^2$。\n\n**B部分：多维情况**\n\n现在我们将此推理推广到多维系统。先验协方差矩阵 $P_k = P_{k|k-1}$ 的随机Riccati方程为：\n$$P_{k+1} = \\begin{cases} A (P_k - P_k C^T (C P_k C^T + V)^{-1} C P_k) A^T + W & \\text{概率为 } 1-p \\\\ A P_k A^T + W & \\text{概率为 } p \\end{cases}$$\n$\\mathbb{E}[P_k]$ 的稳定性取决于 $A$ 的不稳定动态与测量更新的校正作用之间的相互作用。\n\n矩阵对 $(A,C)$ 可检测的假设至关重要。这意味着系统的任何不可观测模式都是稳定的。与这些稳定的、不可观测的模式相关的误差协方差将保持有界。因此，总误差协方差的发散只能由既不稳定又可观测的模式引起。\n\n问题将 $A_u$ 定义为 $A$ 在由不稳定且可观测模式的特征向量所张成的子空间上的限制。这个关键子空间上的动态决定了估计误差的整体稳定性。在丢包期间，与此子空间相关的误差协方差的增长由映射 $P \\mapsto A_u P A_u^T$ 决定。作用于矩阵的这个线性算子的“增益”决定了协方差的增长率。该算子的谱半径决定了其渐近范数增长，其值为 $\\rho(A_u)^2$。\n\n遵循标量情况的逻辑，在连续 $m$ 次丢包（一个概率为 $p^m$ 的事件）后，不稳定-可观测子空间上的误差协方差矩阵的范数以与 $(\\rho(A_u)^2)^m$ 成比例的因子增长。这些高误差路径对期望协方差矩阵的贡献包含像 $p^m (\\rho(A_u)^2)^m = (p \\rho(A_u)^2)^m$ 这样的尺度项。\n\n为了使期望协方差有界，由这些项构成的有效几何级数必须收敛，这要求公比小于1：\n$$p \\, \\rho(A_u)^2 < 1$$\n临界丢包概率 $p_c$ 在稳定性边界处找到：\n$$p_c \\, \\rho(A_u)^2 = 1$$\n这给出了多维情况下临界概率的表达式：\n$$p_c = \\frac{1}{\\rho(A_u)^2}$$\n这个通用结果与标量情况一致。对于标量系统，$A=a$ 且 $C=1$。系统是可观测的。由于 $|a|>1$，该单一模式是不稳定且可观测的。因此，$A_u = a$，并且 $\\rho(A_u) = |a|$。该公式得出 $p_c = \\frac{1}{|a|^2} = \\frac{1}{a^2}$，与A部分的结果相符。", "answer": "$$\n\\boxed{\\frac{1}{\\rho(A_u)^2}}\n$$", "id": "2726935"}]}