{"hands_on_practices": [{"introduction": "预测未来系统状态是模型预测控制的基础。本练习将指导您推导未来控制输入序列与所产生的预测状态之间的显式关系。通过构建预测矩阵，您将揭示其固有的分块托普利茨 (block Toeplitz) 结构，这是许多高级MPC算法利用的一个关键特性 [@problem_id:2736347]。", "problem": "考虑用于模型预测控制（MPC）的离散时间线性时不变系统，其状态更新方程为\n$$\nx_{k+1} = A x_{k} + B u_{k},\n$$\n其中状态为 $x_{k} \\in \\mathbb{R}^{2}$，输入为 $u_{k} \\in \\mathbb{R}$。令\n$$\nA = \\begin{pmatrix} 0.9 & 0.1 \\\\ 0 & 0.8 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1 \\\\ 0.5 \\end{pmatrix}.\n$$\n使用长度为 $N=4$ 的有限预测时域（滚动时域控制），构建堆叠的预测状态向量\n$$\nX \\triangleq \\begin{pmatrix} x_{k+1} \\\\ x_{k+2} \\\\ x_{k+3} \\\\ x_{k+4} \\end{pmatrix} \\in \\mathbb{R}^{8}\n$$\n和堆叠的未来输入向量\n$$\nU \\triangleq \\begin{pmatrix} u_{k} \\\\ u_{k+1} \\\\ u_{k+2} \\\\ u_{k+3} \\end{pmatrix} \\in \\mathbb{R}^{4}.\n$$\n仅从状态更新方程以及 $X$ 和 $U$ 的定义出发，通过重复代入和堆叠，将 $X$ 推导为关于 $x_{k}$ 和 $U$ 的仿射函数。根据此推导，显式计算 $8 \\times 4$ 的预测矩阵 $\\mathcal{B}$，使得\n$$\nX = \\mathcal{A} x_{k} + \\mathcal{B} U,\n$$\n其中 $\\mathcal{A}$ 在推导中是隐式定义的。然后，通过显式计算矩阵块 $A^{i} B$ 并将其排列在预测状态方程中，验证 $\\mathcal{B}$ 的下三角块托普利茨 (Toeplitz) 结构。最后，计算 Frobenius 范数\n$$\n\\left\\| \\mathcal{B} - \\widetilde{\\mathcal{B}} \\right\\|_{F},\n$$\n其中 $\\widetilde{\\mathcal{B}}$ 是一个矩阵，其构造方法为：对于 $i,j \\in \\{1,2,3,4\\}$，在 $i \\geq j$ 的 $(i,j)$ 块位置放置矩阵块 $A^{i-j} B$（块大小为 $2 \\times 1$），其他位置则为零块。\n\n将 Frobenius 范数的值报告为单个实数。使用精确计算；无需四舍五入。不需要单位。", "solution": "所述问题具有科学依据，提法恰当且自成体系。这是控制理论中的一个标准练习，特别是在模型预测控制（MPC）的公式化方面。因此，我们开始求解。\n\n目标是为一个离散时间线性时不变系统推导预测矩阵 $\\mathcal{B}$，并将其与一个按特定块结构构造的矩阵 $\\widetilde{\\mathcal{B}}$ 进行比较。我们已知系统动力学：\n$$\nx_{k+1} = A x_{k} + B u_{k}\n$$\n矩阵为\n$$\nA = \\begin{pmatrix} 0.9 & 0.1 \\\\ 0 & 0.8 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1 \\\\ 0.5 \\end{pmatrix}.\n$$\n状态为 $x_{k} \\in \\mathbb{R}^{2}$，输入为 $u_{k} \\in \\mathbb{R}$。预测时域为 $N=4$。\n\n首先，我们从当前状态 $x_k$ 和未来输入序列 $u_k, u_{k+1}, u_{k+2}, u_{k+3}$ 出发，通过递归代入，推导未来状态 $x_{k+1}, x_{k+2}, x_{k+3}, x_{k+4}$ 的表达式。\n\n在时间步 $k+1$ 的状态由系统方程直接给出：\n$$\nx_{k+1} = A x_{k} + B u_{k}\n$$\n\n在时间步 $k+2$ 的状态通过将动力学应用于 $x_{k+1}$ 得到：\n$$\nx_{k+2} = A x_{k+1} + B u_{k+1} = A(A x_{k} + B u_{k}) + B u_{k+1} = A^2 x_{k} + AB u_{k} + B u_{k+1}\n$$\n\n类似地，可以得到在时间步 $k+3$ 的状态：\n$$\nx_{k+3} = A x_{k+2} + B u_{k+2} = A(A^2 x_{k} + AB u_{k} + B u_{k+1}) + B u_{k+2} = A^3 x_{k} + A^2 B u_{k} + AB u_{k+1} + B u_{k+2}\n$$\n\n最后，在时间步 $k+4$ 的状态是：\n$$\nx_{k+4} = A x_{k+3} + B u_{k+3} = A(A^3 x_{k} + A^2 B u_{k} + AB u_{k+1} + B u_{k+2}) + B u_{k+3} = A^4 x_{k} + A^3 B u_{k} + A^2 B u_{k+1} + AB u_{k+2} + B u_{k+3}\n$$\n\n现在，我们将这些状态预测堆叠成向量 $X \\in \\mathbb{R}^{8}$，并将方程整理成指定的矩阵形式 $X = \\mathcal{A} x_{k} + \\mathcal{B} U$，其中 $U \\in \\mathbb{R}^{4}$ 是堆叠的输入向量。\n$$\nX = \\begin{pmatrix} x_{k+1} \\\\ x_{k+2} \\\\ x_{k+3} \\\\ x_{k+4} \\end{pmatrix} = \\begin{pmatrix} A \\\\ A^2 \\\\ A^3 \\\\ A^4 \\end{pmatrix} x_{k} + \\begin{pmatrix}\nB & 0 & 0 & 0 \\\\\nAB & B & 0 & 0 \\\\\nA^2 B & AB & B & 0 \\\\\nA^3 B & A^2 B & AB & B\n\\end{pmatrix} \\begin{pmatrix} u_{k} \\\\ u_{k+1} \\\\ u_{k+2} \\\\ u_{k+3} \\end{pmatrix}\n$$\n从这个基本推导中，我们确定预测矩阵 $\\mathcal{B}$ 为：\n$$\n\\mathcal{B} = \\begin{pmatrix}\nB & 0 & 0 & 0 \\\\\nAB & B & 0 & 0 \\\\\nA^2 B & AB & B & 0 \\\\\nA^3 B & A^2 B & AB & B\n\\end{pmatrix}\n$$\n该分块矩阵中的条目本身就是矩阵（或向量）。由于 $x_k \\in \\mathbb{R}^2$ 且 $u_k \\in \\mathbb{R}$，每个块 $A^p B$ 是一个 $2 \\times 1$ 的向量，每个 $0$ 是一个 $2 \\times 1$ 的零向量。$\\mathcal{B}$ 的总维度是 $(2 \\times 4) \\times (1 \\times 4) = 8 \\times 4$。该矩阵呈现出下三角块托普利茨（Toeplitz）结构。\n\n接下来，我们考虑矩阵 $\\widetilde{\\mathcal{B}}$，其定义为：对于 $i,j \\in \\{1,2,3,4\\}$，在 $i \\geq j$ 的 $(i,j)$ 块位置放置矩阵块 $A^{i-j} B$，其他位置则为零块。令 $\\widetilde{\\mathcal{B}}_{ij}$ 表示第 $(i,j)$ 个块。\n当 $j=1$ 时： $\\widetilde{\\mathcal{B}}_{11} = A^{1-1}B = B$, $\\widetilde{\\mathcal{B}}_{21} = A^{2-1}B = AB$, $\\widetilde{\\mathcal{B}}_{31} = A^{3-1}B = A^2 B$, $\\widetilde{\\mathcal{B}}_{41} = A^{4-1}B = A^3 B$。\n当 $j=2$ 时： $\\widetilde{\\mathcal{B}}_{12} = 0$ (因为 $1<2$), $\\widetilde{\\mathcal{B}}_{22} = A^{2-2}B = B$, $\\widetilde{\\mathcal{B}}_{32} = A^{3-2}B = AB$, $\\widetilde{\\mathcal{B}}_{42} = A^{4-2}B = A^2 B$。\n当 $j=3$ 时： $\\widetilde{\\mathcal{B}}_{13}=0, \\widetilde{\\mathcal{B}}_{23}=0$, $\\widetilde{\\mathcal{B}}_{33} = A^{3-3}B = B$, $\\widetilde{\\mathcal{B}}_{43} = A^{4-3}B = AB$。\n当 $j=4$ 时： $\\widetilde{\\mathcal{B}}_{14}=0, \\widetilde{\\mathcal{B}}_{24}=0, \\widetilde{\\mathcal{B}}_{34}=0$, $\\widetilde{\\mathcal{B}}_{44} = A^{4-4}B = B$。\n\n将这些块组合起来得到矩阵：\n$$\n\\widetilde{\\mathcal{B}} = \\begin{pmatrix}\nB & 0 & 0 & 0 \\\\\nAB & B & 0 & 0 \\\\\nA^2 B & AB & B & 0 \\\\\nA^3 B & A^2 B & AB & B\n\\end{pmatrix}\n$$\n通过直接比较块结构，可以明显看出，从第一性原理推导出的矩阵 $\\mathcal{B}$ 与根据问题规则构造的矩阵 $\\widetilde{\\mathcal{B}}$ 是相同的。\n即，\n$$\n\\mathcal{B} = \\widetilde{\\mathcal{B}}\n$$\n这个恒等式是 MPC 理论中的一个基本结果，对任何线性时不变系统都成立。问题要求显式计算块 $A^i B$ 的数值是不必要的，因为符号上的相等已经足以得出最终答案。\n\n最后一步是计算这两个矩阵之差的 Frobenius 范数。由于这两个矩阵是相同的，它们的差是 $8 \\times 4$ 的零矩阵，记为 $\\mathbf{0}_{8 \\times 4}$。\n$$\n\\mathcal{B} - \\widetilde{\\mathcal{B}} = \\mathbf{0}_{8 \\times 4}\n$$\n一个 $m \\times n$ 矩阵 $M$ 的 Frobenius 范数定义为 $\\|M\\|_F = \\sqrt{\\sum_{i=1}^{m} \\sum_{j=1}^{n} |M_{ij}|^2}$。对于零矩阵，所有条目 $M_{ij}$ 均为零。\n因此，Frobenius 范数为：\n$$\n\\| \\mathcal{B} - \\widetilde{\\mathcal{B}} \\|_{F} = \\| \\mathbf{0}_{8 \\times 4} \\|_{F} = \\sqrt{\\sum_{i=1}^{8} \\sum_{j=1}^{4} 0^2} = \\sqrt{0} = 0\n$$\n结果恰好为 $0$。得出此结论无需进行数值近似或显式块计算。", "answer": "$$\n\\boxed{0}\n$$", "id": "2736347"}, {"introduction": "在建立了预测模型之后，下一步是构建完整的MPC优化问题。本练习要求您将一个具体系统的动力学、二次性能指标以及时域内的状态与输入约束，转化为一个标准的二次规划（Quadratic Program, QP）问题。掌握这种转化对于使用现有的数值优化求解器来实际求解MPC问题至关重要 [@problem_id:2736366]。", "problem": "考虑在模型预测控制（Model Predictive Control, MPC），也称为滚动时域控制（Receding Horizon Control, RHC）中使用的离散时间线性时不变系统，其由状态更新方程 $x_{k+1}=A x_k + B u_k$ 给出，其中 $A=\\begin{bmatrix}1&1\\\\0&1\\end{bmatrix}$ 且 $B=\\begin{bmatrix}0\\\\1\\end{bmatrix}$，状态 $x_k\\in\\mathbb{R}^2$ 且输入 $u_k\\in\\mathbb{R}$。设阶段成本为 $x_k^{\\top} Q x_k + u_k^{\\top} R u_k$，其中 $Q=I_2$ 且 $R=1$，终端成本为 $x_N^{\\top} P x_N$，其中 $P=I_2$，$I_2$ 表示 $2\\times 2$ 单位矩阵。预测时域为 $N=3$。硬约束为输入幅值界 $|u_k|\\le 1$ 以及对所有 $k\\in\\{0,1,2\\}$ 的状态无穷范数界 $\\lVert x_k\\rVert_{\\infty}\\le 5$。假设初始条件 $x_0=\\begin{bmatrix}x_{01}\\\\x_{02}\\end{bmatrix}$ 已知，且满足 $k=0$ 时的状态界。使用标准的堆叠决策向量 $U=\\begin{bmatrix}u_0&u_1&u_2\\end{bmatrix}^{\\top}$。\n\n从仿射输入序列下的预测状态和二次性能指标的基本定义出发，推导出标准二次规划 (QP) 形式的显式有限时域优化问题\n$$\n\\min_{U}\\ \\frac{1}{2} U^{\\top} H U + f(x_0)^{\\top} U + c(x_0)\\quad\\text{subject to}\\quad G U \\le h(x_0),\n$$\n其中 $H\\in\\mathbb{R}^{3\\times 3}$，$f(x_0)\\in\\mathbb{R}^{3}$，$c(x_0)\\in\\mathbb{R}$，$G\\in\\mathbb{R}^{m\\times 3}$，以及 $h(x_0)\\in\\mathbb{R}^{m}$，对于某个适当的 $m$。你的推导必须清楚地说明预测状态 $x_1$、$x_2$ 和 $x_3$ 如何依赖于 $x_0$ 和 $U$，以及状态和输入约束如何映射为关于 $U$ 的线性不等式。\n\n在将优化问题写成这种具有显式数值矩阵和向量（在适当之处表达对 $x_0$ 的依赖关系）的标准 QP 形式后，计算海森矩阵 (Hessian matrix) $H$ 的行列式。给出行列式的精确值作为你的最终答案。不要四舍五入。最终答案必须是一个没有单位的实数。", "solution": "我们从离散时间线性动力学 $x_{k+1}=A x_k + B u_k$ 开始，其中 $A=\\begin{bmatrix}1&1\\\\0&1\\end{bmatrix}$ 且 $B=\\begin{bmatrix}0\\\\1\\end{bmatrix}$。预测时域为 $N=3$。成本是二次性能指标\n$$\nJ=\\sum_{k=0}^{N-1}\\big(x_k^{\\top} Q x_k + u_k^{\\top} R u_k\\big) + x_N^{\\top} P x_N,\n$$\n其中 $Q=I_2$，$R=1$，$P=I_2$。约束为 $|u_k|\\le 1$ 且 $\\lVert x_k\\rVert_{\\infty}\\le 5$，对于 $k\\in\\{0,1,2\\}$。\n\n我们首先将预测状态构建为决策向量 $U=\\begin{bmatrix}u_0&u_1&u_2\\end{bmatrix}^{\\top}$ 和初始条件 $x_0=\\begin{bmatrix}x_{01}\\\\x_{02}\\end{bmatrix}$ 的仿射函数。使用 $A$ 的幂（对此处的 $A$ 满足 $A^n=\\begin{bmatrix}1&n\\\\0&1\\end{bmatrix}$）和传播的输入效应 $A^j B$，我们得到\n$$\nx_1 = A x_0 + B u_0,\\qquad\nx_2 = A^2 x_0 + A B\\, u_0 + B u_1,\\qquad\nx_3 = A^3 x_0 + A^2 B\\, u_0 + A B\\, u_1 + B u_2.\n$$\n我们计算所需的矩阵：\n$$\nA^2=\\begin{bmatrix}1&2\\\\0&1\\end{bmatrix},\\quad A^3=\\begin{bmatrix}1&3\\\\0&1\\end{bmatrix},\\quad\nB=\\begin{bmatrix}0\\\\1\\end{bmatrix},\\quad A B=\\begin{bmatrix}1\\\\1\\end{bmatrix},\\quad A^2 B=\\begin{bmatrix}2\\\\1\\end{bmatrix}.\n$$\n因此，\n$$\nx_1 = \\begin{bmatrix}x_{01}+x_{02}\\\\ x_{02}\\end{bmatrix} + \\begin{bmatrix}0\\\\1\\end{bmatrix} u_0,\\quad\nx_2 = \\begin{bmatrix}x_{01}+2x_{02}\\\\ x_{02}\\end{bmatrix} + \\begin{bmatrix}1\\\\1\\end{bmatrix} u_0 + \\begin{bmatrix}0\\\\1\\end{bmatrix} u_1,\n$$\n$$\nx_3 = \\begin{bmatrix}x_{01}+3x_{02}\\\\ x_{02}\\end{bmatrix} + \\begin{bmatrix}2\\\\1\\end{bmatrix} u_0 + \\begin{bmatrix}1\\\\1\\end{bmatrix} u_1 + \\begin{bmatrix}0\\\\1\\end{bmatrix} u_2.\n$$\n引入仿射分解 $x_k = c_k + D_k U$，其中 $c_1=A x_0$，$c_2=A^2 x_0$，$c_3=A^3 x_0$，以及\n$$\nD_1=\\begin{bmatrix}0&0&0\\\\ 1&0&0\\end{bmatrix},\\quad\nD_2=\\begin{bmatrix}1&0&0\\\\ 1&1&0\\end{bmatrix},\\quad\nD_3=\\begin{bmatrix}2&1&0\\\\ 1&1&1\\end{bmatrix}.\n$$\n目标函数可以写为\n$$\nJ(U) = x_0^{\\top} Q x_0 + \\sum_{k=1}^{3} \\big\\|c_k + D_k U\\big\\|_2^2 + \\sum_{k=0}^{2} u_k^2.\n$$\n展开二次项可得\n$$\nJ(U) = U^{\\top}\\!\\Big(I_3 + \\sum_{k=1}^{3} D_k^{\\top} D_k\\Big) U + 2 \\sum_{k=1}^{3} c_k^{\\top} D_k\\, U + \\Big(x_0^{\\top} Q x_0 + \\sum_{k=1}^{3} \\|c_k\\|_2^2\\Big),\n$$\n其中 $I_3$ 是 $3\\times 3$ 单位矩阵。因此，在标准二次规划（QP）形式\n$$\n\\min_{U}\\ \\frac{1}{2} U^{\\top} H U + f(x_0)^{\\top} U + c(x_0),\n$$\n中，海森矩阵（Hessian matrix）为 $H=2\\Big(I_3 + \\sum_{k=1}^{3} D_k^{\\top} D_k\\Big)$，线性项为 $f(x_0)=2\\sum_{k=1}^{3} D_k^{\\top} c_k$，常数项为 $c(x_0)=x_0^{\\top} Q x_0 + \\sum_{k=1}^{3} \\|c_k\\|_2^2$。\n\n我们现在计算矩阵 $D_k^{\\top} D_k$：\n$$\nD_1^{\\top} D_1=\\begin{bmatrix}1&0&0\\\\ 0&0&0\\\\ 0&0&0\\end{bmatrix},\\quad\nD_2^{\\top} D_2=\\begin{bmatrix}2&1&0\\\\ 1&1&0\\\\ 0&0&0\\end{bmatrix},\\quad\nD_3^{\\top} D_3=\\begin{bmatrix}5&3&1\\\\ 3&2&1\\\\ 1&1&1\\end{bmatrix}.\n$$\n求和并加上 $I_3$ 得到\n$$\nI_3 + \\sum_{k=1}^{3} D_k^{\\top} D_k\n= \\begin{bmatrix}1&0&0\\\\ 0&1&0\\\\ 0&0&1\\end{bmatrix}\n+ \\begin{bmatrix}1&0&0\\\\ 0&0&0\\\\ 0&0&0\\end{bmatrix}\n+ \\begin{bmatrix}2&1&0\\\\ 1&1&0\\\\ 0&0&0\\end{bmatrix}\n+ \\begin{bmatrix}5&3&1\\\\ 3&2&1\\\\ 1&1&1\\end{bmatrix}\n= \\begin{bmatrix}9&4&1\\\\ 4&4&1\\\\ 1&1&2\\end{bmatrix}.\n$$\n因此海森矩阵为\n$$\nH=2\\begin{bmatrix}9&4&1\\\\ 4&4&1\\\\ 1&1&2\\end{bmatrix}\n= \\begin{bmatrix}18&8&2\\\\ 8&8&2\\\\ 2&2&4\\end{bmatrix}.\n$$\n接下来，计算线性项 $f(x_0)=2\\sum_{k=1}^{3} D_k^{\\top} c_k$，其中 $c_1=A x_0=\\begin{bmatrix}x_{01}+x_{02}\\\\ x_{02}\\end{bmatrix}$，$c_2=A^2 x_0=\\begin{bmatrix}x_{01}+2x_{02}\\\\ x_{02}\\end{bmatrix}$，$c_3=A^3 x_0=\\begin{bmatrix}x_{01}+3x_{02}\\\\ x_{02}\\end{bmatrix}$。使用 $D_1^{\\top}=\\begin{bmatrix}0&1\\\\ 0&0\\\\ 0&0\\end{bmatrix}$，$D_2^{\\top}=\\begin{bmatrix}1&1\\\\ 0&1\\\\ 0&0\\end{bmatrix}$，$D_3^{\\top}=\\begin{bmatrix}2&1\\\\ 1&1\\\\ 0&1\\end{bmatrix}$，我们得到\n$$\nD_1^{\\top} c_1=\\begin{bmatrix}x_{02}\\\\ 0\\\\ 0\\end{bmatrix},\\quad\nD_2^{\\top} c_2=\\begin{bmatrix}x_{01}+3x_{02}\\\\ x_{02}\\\\ 0\\end{bmatrix},\\quad\nD_3^{\\top} c_3=\\begin{bmatrix}2x_{01}+7x_{02}\\\\ x_{01}+4x_{02}\\\\ x_{02}\\end{bmatrix},\n$$\n使得\n$$\n\\sum_{k=1}^{3} D_k^{\\top} c_k=\\begin{bmatrix}3x_{01}+11x_{02}\\\\ x_{01}+5x_{02}\\\\ x_{02}\\end{bmatrix},\\qquad\nf(x_0)=2\\begin{bmatrix}3x_{01}+11x_{02}\\\\ x_{01}+5x_{02}\\\\ x_{02}\\end{bmatrix}=\\begin{bmatrix}6x_{01}+22x_{02}\\\\ 2x_{01}+10x_{02}\\\\ 2x_{02}\\end{bmatrix}.\n$$\n常数项 $c(x_0)$ 包含了所有与 $U$ 无关的部分：\n$$\nc(x_0)=x_0^{\\top} x_0 + \\|A x_0\\|_2^2 + \\|A^2 x_0\\|_2^2 + \\|A^3 x_0\\|_2^2\n= \\sum_{k=0}^{3}\\big((x_{01}+k x_{02})^2 + x_{02}^2\\big).\n$$\n\n我们现在将约束 $|u_k|\\le 1$ 和 $\\lVert x_k\\rVert_{\\infty}\\le 5$（对于 $k\\in\\{0,1,2\\}$）表示为线性不等式 $G U\\le h(x_0)$。输入约束得出\n$$\n\\begin{bmatrix}\n1&0&0\\\\ -1&0&0\\\\ 0&1&0\\\\ 0&-1&0\\\\ 0&0&1\\\\ 0&0&-1\n\\end{bmatrix}\n\\begin{bmatrix}u_0\\\\ u_1\\\\ u_2\\end{bmatrix}\n\\le\n\\begin{bmatrix}1\\\\ 1\\\\ 1\\\\ 1\\\\ 1\\\\ 1\\end{bmatrix}.\n$$\n对于 $k=0$ 时的状态约束，$\\lVert x_0\\rVert_{\\infty}\\le 5$ 是对 $x_0$ 的一个可行性条件，可以表示为 $G$ 中具有零行的常数不等式：\n$$\n\\begin{bmatrix}\n0&0&0\\\\ 0&0&0\\\\ 0&0&0\\\\ 0&0&0\n\\end{bmatrix}\nU \\le\n\\begin{bmatrix}\n5 - x_{01}\\\\ 5 + x_{01}\\\\ 5 - x_{02}\\\\ 5 + x_{02}\n\\end{bmatrix}.\n$$\n对于 $k=1$，我们有 $x_1=\\begin{bmatrix}x_{01}+x_{02}\\\\ x_{02}\\end{bmatrix}+\\begin{bmatrix}0\\\\1\\end{bmatrix} u_0$，因此\n$$\n\\begin{aligned}\n&-5 \\le x_{01}+x_{02} \\le 5 \\quad\\Rightarrow\\quad \\begin{bmatrix}0&0&0\\\\ 0&0&0\\end{bmatrix} U \\le \\begin{bmatrix}5-(x_{01}+x_{02})\\\\ 5+(x_{01}+x_{02})\\end{bmatrix},\\\\\n&-5 \\le x_{02}+u_0 \\le 5 \\quad\\Rightarrow\\quad \\begin{bmatrix}1&0&0\\\\ -1&0&0\\end{bmatrix} U \\le \\begin{bmatrix}5 - x_{02}\\\\ 5 + x_{02}\\end{bmatrix}.\n\\end{aligned}\n$$\n对于 $k=2$，我们有 $x_2=\\begin{bmatrix}x_{01}+2x_{02}\\\\ x_{02}\\end{bmatrix}+\\begin{bmatrix}1\\\\1\\end{bmatrix} u_0 + \\begin{bmatrix}0\\\\1\\end{bmatrix} u_1$，因此\n$$\n\\begin{aligned}\n&-5 \\le x_{01}+2x_{02}+u_0 \\le 5 \\ \\Rightarrow\\\n\\begin{bmatrix}1&0&0\\\\ -1&0&0\\end{bmatrix} U \\le \\begin{bmatrix}5 - x_{01} - 2x_{02}\\\\ 5 + x_{01} + 2x_{02}\\end{bmatrix},\\\\\n&-5 \\le x_{02}+u_0+u_1 \\le 5 \\ \\Rightarrow\\\n\\begin{bmatrix}1&1&0\\\\ -1&-1&0\\end{bmatrix} U \\le \\begin{bmatrix}5 - x_{02}\\\\ 5 + x_{02}\\end{bmatrix}.\n\\end{aligned}\n$$\n将所有不等式堆叠起来，得到 $G\\in\\mathbb{R}^{18\\times 3}$ 和 $h(x_0)\\in\\mathbb{R}^{18}$：\n$$\nG=\n\\begin{bmatrix}\n1&0&0\\\\ -1&0&0\\\\ 0&1&0\\\\ 0&-1&0\\\\ 0&0&1\\\\ 0&0&-1\\\\\n0&0&0\\\\ 0&0&0\\\\ 0&0&0\\\\ 0&0&0\\\\\n0&0&0\\\\ 0&0&0\\\\ 1&0&0\\\\ -1&0&0\\\\\n1&0&0\\\\ -1&0&0\\\\ 1&1&0\\\\ -1&-1&0\n\\end{bmatrix},\\quad\nh(x_0)=\n\\begin{bmatrix}\n1\\\\ 1\\\\ 1\\\\ 1\\\\ 1\\\\ 1\\\\\n5 - x_{01}\\\\ 5 + x_{01}\\\\ 5 - x_{02}\\\\ 5 + x_{02}\\\\\n5 - (x_{01}+x_{02})\\\\ 5 + (x_{01}+x_{02})\\\\ 5 - x_{02}\\\\ 5 + x_{02}\\\\\n5 - x_{01} - 2x_{02}\\\\ 5 + x_{01} + 2x_{02}\\\\ 5 - x_{02}\\\\ 5 + x_{02}\n\\end{bmatrix}.\n$$\n这得出了所要求的、以 $U$ 为决策变量的显式 QP 形式。\n\n最后，我们计算海森矩阵 $H$ 的行列式。回顾\n$$\nH=\\begin{bmatrix}18&8&2\\\\ 8&8&2\\\\ 2&2&4\\end{bmatrix}\n= 2 \\begin{bmatrix}9&4&1\\\\ 4&4&1\\\\ 1&1&2\\end{bmatrix}.\n$$\n令 $M=\\begin{bmatrix}9&4&1\\\\ 4&4&1\\\\ 1&1&2\\end{bmatrix}$。那么 $\\det(H)=2^3 \\det(M)=8\\,\\det(M)$。通过沿第一行进行余子式展开来计算 $\\det(M)$：\n$$\n\\det(M)=9\\begin{vmatrix}4&1\\\\ 1&2\\end{vmatrix} - 4\\begin{vmatrix}4&1\\\\ 1&2\\end{vmatrix} + 1\\begin{vmatrix}4&4\\\\ 1&1\\end{vmatrix}\n= 9(8-1) - 4(8-1) + 1(4-4) = 9\\cdot 7 - 4\\cdot 7 + 0 = 35.\n$$\n因此，\n$$\n\\det(H)=8\\times 35 = 280.\n$$\n这是一个精确的整数，因此不需要四舍五入。", "answer": "$$\\boxed{280}$$", "id": "2736366"}, {"introduction": "保证MPC控制器在每个时间步都具有可行解并能稳定整个系统，是其设计的核心挑战，而这通常通过引入精心设计的终端集和终端成本来解决。本练习将引导您完成一个多胞体终端集的设计过程，通过系统地施加约束条件，确保该终端集在终端反馈控制器作用下满足正不变性、状态约束和输入约束，从而获得对稳定性和递归可行性的理论保证 [@problem_id:2736411]。", "problem": "考虑由状态更新方程 $x^{+} = A x + B u$ 给出的离散时间线性时不变系统，其中\n$$\nA = \\begin{pmatrix}\n0.4 & 0.1 \\\\\n-0.2 & 0.3\n\\end{pmatrix}, \n\\quad\nB = \\begin{pmatrix}\n1 \\\\\n0.5\n\\end{pmatrix}.\n$$\n容许的状态和输入集合是多面体：\n$$\n\\mathcal{X} = \\{ x \\in \\mathbb{R}^{2} \\mid |x_{1}| \\leq 2, \\, |x_{2}| \\leq 1 \\},\n\\quad\n\\mathcal{U} = \\{ u \\in \\mathbb{R} \\mid |u| \\leq \\tfrac{1}{2} \\}.\n$$\n一个固定的线性反馈 $u = K x$，其中\n$$\nK = \\begin{pmatrix}\n-0.5 & 0.2\n\\end{pmatrix}\n$$\n在滚动时域控制器中实现，以在终端阶段强制满足约束。设终端成本为二次形式 $V(x) = x^{\\top} P x$，其中 $P \\succ 0$ 是求解离散时间李雅普诺夫方程得到的解\n$$\n(A + B K)^{\\top} P (A + B K) - P = -\\left(Q + K^{\\top} R K\\right),\n$$\n其中 $Q = I_{2}$ 且 $R = 1$。该选择确保了在终端反馈下，闭环系统 $x^{+} = (A + B K) x$ 具有严格的二次李雅普诺夫函数下降。\n\n定义一个由标量 $\\alpha > 0$ 参数化的多面体（超矩形）终端集族为\n$$\n\\mathcal{X}_{f}(\\alpha) = \\{ x \\in \\mathbb{R}^{2} \\mid |x_{1}| \\leq \\alpha, \\, |x_{2}| \\leq \\alpha \\}.\n$$\n通过求解由约束 $x \\in \\mathcal{X}$ 和 $K x \\in \\mathcal{U}$ 导出的线性不等式，并通过收紧以保证该集合对于闭环映射 $x^{+} = (A + B K) x$ 是正不变的，来构造 $\\mathcal{X}_{f}(\\alpha)$，同时利用二次李雅普诺夫函数下降条件。具体来说，确定最大的标量 $\\alpha^{\\star}$，使得：\n1. $\\mathcal{X}_{f}(\\alpha^{\\star}) \\subseteq \\mathcal{X}$,\n2. 对所有 $x \\in \\mathcal{X}_{f}(\\alpha^{\\star})$，都有 $K x \\in \\mathcal{U}$,\n3. $\\mathcal{X}_{f}(\\alpha^{\\star})$ 在 $x^{+} = (A + B K) x$ 下是正不变的（因此李雅普诺夫函数下降条件对于所有 $x \\in \\mathcal{X}_{f}(\\alpha^{\\star})$ 沿终端动态成立）。\n\n将您的最终答案表示为 $\\alpha^{\\star}$ 的精确值（无单位）。无需四舍五入。", "solution": "所述问题具有科学依据，提法恰当，并包含获得唯一解所需的所有信息。这是滚动时域控制中终端集设计的一个标准问题。分析将通过系统地评估施加于参数化终端集 $\\mathcal{X}_{f}(\\alpha)$ 的三个条件来进行。\n\n该系统由状态更新方程 $x^{+} = A x + B u$ 定义，其矩阵为\n$$\nA = \\begin{pmatrix} 0.4 & 0.1 \\\\ -0.2 & 0.3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1 \\\\ 0.5 \\end{pmatrix}.\n$$\n状态和输入约束由以下集合给出\n$$\n\\mathcal{X} = \\{ x \\in \\mathbb{R}^{2} \\mid |x_{1}| \\leq 2, \\, |x_{2}| \\leq 1 \\}, \\quad \\mathcal{U} = \\{ u \\in \\mathbb{R} \\mid |u| \\leq \\tfrac{1}{2} \\}.\n$$\n终端反馈律为 $u = K x$，增益为 $K = \\begin{pmatrix} -0.5 & 0.2 \\end{pmatrix}$。\n终端集族为 $\\mathcal{X}_{f}(\\alpha) = \\{ x \\in \\mathbb{R}^{2} \\mid |x_{1}| \\leq \\alpha, \\, |x_{2}| \\leq \\alpha \\}$，其中 $\\alpha > 0$。\n\n我们必须找到最大的标量 $\\alpha^{\\star}$，使得 $\\mathcal{X}_{f}(\\alpha^{\\star})$ 满足三个条件。每个条件都会对 $\\alpha$ 的值施加一个约束。\n\n1. 条件 1：$\\mathcal{X}_{f}(\\alpha) \\subseteq \\mathcal{X}$\n对于任何状态 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} \\in \\mathcal{X}_{f}(\\alpha)$，我们有 $|x_{1}| \\leq \\alpha$ 和 $|x_{2}| \\leq \\alpha$。为了使该状态也属于 $\\mathcal{X}$，它必须满足 $|x_{1}| \\leq 2$ 和 $|x_{2}| \\leq 1$。\n为确保 $\\mathcal{X}_{f}(\\alpha)$ 中的每个点也都在 $\\mathcal{X}$ 中，定义 $\\mathcal{X}_{f}(\\alpha)$ 的界限必须至少与定义 $\\mathcal{X}$ 的界限一样紧。这意味着两个不等式：\n$$\n\\alpha \\leq 2\n$$\n$$\n\\alpha \\leq 1\n$$\n要同时满足两者，我们必须遵守更严格的那个。因此，该条件施加的约束为：\n$$\n\\alpha \\leq 1\n$$\n\n2. 条件 2：对于所有 $x \\in \\mathcal{X}_{f}(\\alpha)$，都有 $K x \\in \\mathcal{U}$\n控制输入为 $u = Kx = -0.5 x_1 + 0.2 x_2$。对输入的约束是 $|u| \\leq \\frac{1}{2}$。\n我们必须确保对于所有 $x \\in \\mathcal{X}_{f}(\\alpha)$，不等式 $|-0.5 x_1 + 0.2 x_2| \\leq \\frac{1}{2}$ 成立。\n我们在集合 $\\mathcal{X}_{f}(\\alpha)$ 上找到 $Kx$ 的最大绝对值。根据三角不等式，对任意 $x \\in \\mathcal{X}_{f}(\\alpha)$：\n$$\n|Kx| = |-0.5 x_1 + 0.2 x_2| \\leq |-0.5||x_1| + |0.2||x_2| = 0.5|x_1| + 0.2|x_2|\n$$\n由于 $|x_1| \\leq \\alpha$ 且 $|x_2| \\leq \\alpha$，我们有：\n$$\n|Kx| \\leq 0.5\\alpha + 0.2\\alpha = 0.7\\alpha\n$$\n这个最大值在方形集合 $\\mathcal{X}_{f}(\\alpha)$ 的顶点处达到，例如在 $x = \\begin{pmatrix} -\\alpha \\\\ \\alpha \\end{pmatrix}$。\n约束是这个最大值不能超过输入限制：\n$$\n0.7\\alpha \\leq \\frac{1}{2}\n$$\n求解 $\\alpha$，我们发现：\n$$\n\\alpha \\leq \\frac{1/2}{0.7} = \\frac{0.5}{0.7} = \\frac{5}{7}\n$$\n\n3. 条件 3：$\\mathcal{X}_{f}(\\alpha)$ 在 $x^{+} = (A + B K) x$ 下是正不变的\n正不变性要求对于任何 $x(k) \\in \\mathcal{X}_{f}(\\alpha)$，下一个状态 $x(k+1) = x^{+}$ 也位于 $\\mathcal{X}_{f}(\\alpha)$ 中。\n闭环系统矩阵是 $A_{cl} = A + BK$：\n$$\nA_{cl} = \\begin{pmatrix} 0.4 & 0.1 \\\\ -0.2 & 0.3 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0.5 \\end{pmatrix} \\begin{pmatrix} -0.5 & 0.2 \\end{pmatrix} = \\begin{pmatrix} 0.4 & 0.1 \\\\ -0.2 & 0.3 \\end{pmatrix} + \\begin{pmatrix} -0.5 & 0.2 \\\\ -0.25 & 0.1 \\end{pmatrix} = \\begin{pmatrix} -0.1 & 0.3 \\\\ -0.45 & 0.4 \\end{pmatrix}\n$$\n集合 $\\mathcal{X}_{f}(\\alpha)$ 可以使用无穷范数描述为 $\\{x \\in \\mathbb{R}^2 \\mid \\|x\\|_{\\infty} \\leq \\alpha \\}$。\n不变性条件是对于任何满足 $\\|x\\|_{\\infty} \\leq \\alpha$ 的 $x$，我们必须有 $\\|A_{cl}x\\|_{\\infty} \\leq \\alpha$。\n我们知道 $\\|A_{cl}x\\|_{\\infty} \\leq \\|A_{cl}\\|_{\\infty} \\|x\\|_{\\infty}$，其中 $\\|A_{cl}\\|_{\\infty}$ 是诱导矩阵范数，计算为最大绝对行和。\n$$\n\\|A_{cl}\\|_{\\infty} = \\max \\left( |-0.1| + |0.3|, |-0.45| + |0.4| \\right) = \\max(0.1 + 0.3, 0.45 + 0.4) = \\max(0.4, 0.85) = 0.85\n$$\n因此，如果 $\\|x\\|_{\\infty} \\leq \\alpha$，则 $\\|x^{+}\\|_{\\infty} = \\|A_{cl}x\\|_{\\infty} \\leq 0.85 \\|x\\|_{\\infty} \\leq 0.85\\alpha$。\n为了满足不变性，我们需要 $\\|x^{+}\\|_{\\infty} \\leq \\alpha$。这给出了不等式 $0.85\\alpha \\leq \\alpha$。由于 $\\alpha > 0$，这可以简化为 $0.85 \\leq 1$，这是恒成立的。\n因此，集合 $\\mathcal{X}_{f}(\\alpha)$ 对任何 $\\alpha > 0$ 都是正不变的。此条件对 $\\alpha$ 没有施加任何上限。提及李雅普诺夫函数是为了确认这对于滚动时域控制是一种有效的终端集构造方法，但对于计算 $\\alpha^{\\star}$ 本身而言并非必需。\n\n综合这些约束：\n为了找到可能的最大值 $\\alpha^{\\star}$，我们必须满足所有导出的关于 $\\alpha$ 的约束：\n$$\n\\alpha \\leq 1 \\quad \\text{（来自条件 1）}\n$$\n$$\n\\alpha \\leq \\frac{5}{7} \\quad \\text{（来自条件 2）}\n$$\n$\\alpha$ 的值必须小于或等于这些上界的最小值：\n$$\n\\alpha^{\\star} = \\min\\left(1, \\frac{5}{7}\\right)\n$$\n由于 $1 > \\frac{5}{7}$，最严格的约束是 $\\alpha \\leq \\frac{5}{7}$。\n因此，确切的最大标量是：\n$$\n\\alpha^{\\star} = \\frac{5}{7}\n$$", "answer": "$$\\boxed{\\frac{5}{7}}$$", "id": "2736411"}]}