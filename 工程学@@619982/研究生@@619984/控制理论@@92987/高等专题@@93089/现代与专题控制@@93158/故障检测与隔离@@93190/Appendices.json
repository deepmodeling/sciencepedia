{"hands_on_practices": [{"introduction": "在基于模型的故障诊断中，核心的第一步是生成一个“残差”信号，该信号在系统无故障时理想地保持为零，而在有故障时则会偏离零。本练习将通过一个具体的离散时间系统，带您亲手实践如何利用“校验关系法” (parity space approach) 从头构建这样一个残差。您将学习如何将抽象的状态空间方程转化为一个具体的代数滤波器，该滤波器能够消除未知初始状态 $x_0$ 和已知控制输入 $U$ 的影响，从而使残差信号专门对故障产生响应 [@problem_id:2706941]。", "problem": "考虑一个带有加性传感器故障的离散时间单输入单输出 (SISO) 线性时不变系统，由下式给出\n$$\nx_{k+1}=A x_k + B u_k, \\quad y_k = C x_k + D u_k + f_k,\n$$\n其中\n$$\nA=\\begin{pmatrix}0.6 & 1.0\\\\[4pt] 0 & 0.3\\end{pmatrix},\\quad\nB=\\begin{pmatrix}1\\\\[4pt] 0\\end{pmatrix},\\quad\nC=\\begin{pmatrix}1 & 0\\end{pmatrix},\\quad\nD=0.2,\n$$\n且 $f_k$ 是一个未知的传感器故障。矩阵对 $\\left(A,C\\right)$ 是可观测的。定义时域长度为 $N$ 的堆叠向量\n$$\nY=\\begin{pmatrix}y_0\\\\[2pt] y_1\\\\[2pt] y_2\\\\[2pt] y_3\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_0\\\\[2pt] u_1\\\\[2pt] u_2\\\\[2pt] u_3\\end{pmatrix},\\quad\nf=\\begin{pmatrix}f_0\\\\[2pt] f_1\\\\[2pt] f_2\\\\[2pt] f_3\\end{pmatrix},\n$$\n其中 $N=4$。从基本原理（状态递推和输出方程）出发，显式地构建堆叠数据方程\n$$\nY=\\mathcal{T}_U\\,U+\\mathcal{T}_X\\,x_0+\\mathcal{T}_F\\,F\\,f,\n$$\n通过构造 $4\\times 4$ 的下块托普利茨输入矩阵 $\\mathcal{T}_U$、$4\\times 2$ 的扩展可观测性矩阵 $\\mathcal{T}_X$ 和 $4\\times 4$ 的故障分布矩阵 $\\mathcal{T}_F$ 以及故障特征 $F$。然后，仅利用这些矩阵的线性代数性质，推导出一个显式的非平凡奇偶校验矩阵，该矩阵可以同时消除未知的初始条件 $x_0$ 和已测输入 $U$。具体来说，构造矩阵 $Q_y\\in\\mathbb{R}^{2\\times 4}$ 和 $Q_u\\in\\mathbb{R}^{2\\times 4}$，使得\n$$\nQ_y\\,\\mathcal{T}_X=0,\\qquad Q_y\\,\\mathcal{T}_U+Q_u=0,\n$$\n因此残差\n$$\nr = Q_y\\,Y + Q_u\\,U\n$$\n仅取决于故障。提供一个块奇偶校验矩阵 $\\Pi=\\big[\\,Q_y\\;\\;Q_u\\,\\big]\\in\\mathbb{R}^{2\\times 8}$ 的显式数值选择。你的最终答案必须是这个 $\\Pi$ 的单个解析表达式。不需要四舍五入，也不涉及单位。", "solution": "出发点是状态递推和输出映射，\n$$\nx_{k+1}=A x_k + B u_k,\\qquad y_k = C x_k + D u_k + f_k,\n$$\n以及时域长度为 $N=4$ 的堆叠向量的定义，\n$$\nY=\\begin{pmatrix}y_0\\\\ y_1\\\\ y_2\\\\ y_3\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_0\\\\ u_1\\\\ u_2\\\\ u_3\\end{pmatrix},\\quad\nf=\\begin{pmatrix}f_0\\\\ f_1\\\\ f_2\\\\ f_3\\end{pmatrix}.\n$$\n通过递推，将状态更新方程反复代入输出方程，可以得到时域内输出的著名表达式：\n$$\n\\begin{aligned}\ny_0 &= C x_0 + D u_0 + f_0,\\\\\ny_1 &= C A x_0 + C B u_0 + D u_1 + f_1,\\\\\ny_2 &= C A^2 x_0 + C A B u_0 + C B u_1 + D u_2 + f_2,\\\\\ny_3 &= C A^3 x_0 + C A^2 B u_0 + C A B u_1 + C B u_2 + D u_3 + f_3.\n\\end{aligned}\n$$\n将这四个方程堆叠起来，得到\n$$\nY=\\underbrace{\\begin{pmatrix}\nD & 0 & 0 & 0\\\\\nC B & D & 0 & 0\\\\\nC A B & C B & D & 0\\\\\nC A^2 B & C A B & C B & D\n\\end{pmatrix}}_{\\mathcal{T}_U}\\,U+\n\\underbrace{\\begin{pmatrix}\nC\\\\\nC A\\\\\nC A^2\\\\\nC A^3\n\\end{pmatrix}}_{\\mathcal{T}_X}\\,x_0+\n\\underbrace{I_4}_{\\mathcal{T}_F}\\,\\underbrace{1}_{F}\\,f.\n$$\n因此，对于加性传感器故障，有 $\\mathcal{T}_F=I_4$ 和 $F=1$。\n\n接下来，计算所需的马尔可夫参数和 $A$ 的幂，以显式构造 $\\mathcal{T}_U$ 和 $\\mathcal{T}_X$。给定\n$$\nA=\\begin{pmatrix}0.6 & 1.0\\\\ 0 & 0.3\\end{pmatrix},\\quad\nB=\\begin{pmatrix}1\\\\ 0\\end{pmatrix},\\quad\nC=\\begin{pmatrix}1 & 0\\end{pmatrix},\\quad\nD=0.2,\n$$\n可以求得\n$$\nA^2=\\begin{pmatrix}0.36 & 0.9\\\\ 0 & 0.09\\end{pmatrix},\\qquad\nA^3=\\begin{pmatrix}0.216 & 0.63\\\\ 0 & 0.027\\end{pmatrix}.\n$$\n因此，\n$$\n\\begin{aligned}\nC &= \\begin{pmatrix}1 & 0\\end{pmatrix},\\\\\nC A &= \\begin{pmatrix}0.6 & 1\\end{pmatrix},\\\\\nC A^2 &= \\begin{pmatrix}0.36 & 0.9\\end{pmatrix},\\\\\nC A^3 &= \\begin{pmatrix}0.216 & 0.63\\end{pmatrix},\n\\end{aligned}\n$$\n所以\n$$\n\\mathcal{T}_X=\\begin{pmatrix}\n1 & 0\\\\\n0.6 & 1\\\\\n0.36 & 0.9\\\\\n0.216 & 0.63\n\\end{pmatrix}.\n$$\n对于输入托普利茨矩阵，马尔可夫参数为\n$$\ng_0 = D = 0.2,\\quad g_1 = C B = 1,\\quad g_2 = C A B = 0.6,\\quad g_3 = C A^2 B = 0.36,\n$$\n得到\n$$\n\\mathcal{T}_U=\\begin{pmatrix}\n0.2 & 0   & 0   & 0\\\\\n1   & 0.2 & 0   & 0\\\\\n0.6 & 1   & 0.2 & 0\\\\\n0.36& 0.6 & 1   & 0.2\n\\end{pmatrix}.\n$$\n\n为了消除对未知初始条件 $x_0$ 和已测输入 $U$ 的依赖，我们构造一个形式如下的奇偶校验残差\n$$\nr = Q_y\\,Y + Q_u\\,U,\n$$\n其中选择 $Q_y\\in\\mathbb{R}^{2\\times 4}$ 和 $Q_u\\in\\mathbb{R}^{2\\times 4}$ 以满足\n$$\nQ_y\\,\\mathcal{T}_X=0,\\qquad Q_y\\,\\mathcal{T}_U+Q_u=0.\n$$\n第一个条件要求 $Q_y$ 的行向量位于 $\\mathcal{T}_X$ 的左零空间中。通过寻找满足 $\\mathcal{T}_X^{\\top} q=0$ 的 $q\\in\\mathbb{R}^4$ 来求解 $Q_y\\,\\mathcal{T}_X=0$。记 $q=\\begin{pmatrix}q_0 & q_1 & q_2 & q_3\\end{pmatrix}^{\\top}$，方程组\n$$\n\\begin{aligned}\nq_0\\cdot 1 + q_1\\cdot 0.6 + q_2\\cdot 0.36 + q_3\\cdot 0.216 &= 0,\\\\\nq_0\\cdot 0 + q_1\\cdot 1 + q_2\\cdot 0.9 + q_3\\cdot 0.63 &= 0,\n\\end{aligned}\n$$\n产生一个双参数族\n$$\n\\begin{pmatrix}q_0\\\\ q_1\\\\ q_2\\\\ q_3\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.18\\,c + 0.162\\,d\\\\[2pt]\n-0.9\\,c - 0.63\\,d\\\\[2pt]\nc\\\\[2pt]\nd\n\\end{pmatrix},\n\\quad c,d\\in\\mathbb{R}.\n$$\n选择对应于 $(c,d)=(1,0)$ 和 $(c,d)=(0,1)$ 的基向量，我们得到两个独立的左零向量\n$$\nq^{(1)}=\\begin{pmatrix}0.18\\\\ -0.9\\\\ 1\\\\ 0\\end{pmatrix},\\qquad\nq^{(2)}=\\begin{pmatrix}0.162\\\\ -0.63\\\\ 0\\\\ 1\\end{pmatrix}.\n$$\n将它们作为行向量堆叠起来，得到\n$$\nQ_y=\\begin{pmatrix}\n0.18 & -0.9 & 1 & 0\\\\\n0.162 & -0.63 & 0 & 1\n\\end{pmatrix},\n$$\n根据构造，该矩阵满足 $Q_y\\,\\mathcal{T}_X=0$。\n\n第二个条件 $Q_y\\,\\mathcal{T}_U+Q_u=0$ 对于这个 $Q_y$ 唯一地确定了 $Q_u$：\n$$\nQ_u = -\\,Q_y\\,\\mathcal{T}_U.\n$$\n显式计算 $Q_y\\,\\mathcal{T}_U$。对于 $Q_y$ 的第一行，\n$$\n\\begin{aligned}\n\\begin{pmatrix}0.18 & -0.9 & 1 & 0\\end{pmatrix}\\mathcal{T}_U\n&= \\begin{pmatrix}\n0.18\\cdot 0.2 + (-0.9)\\cdot 1 + 1\\cdot 0.6 + 0\\cdot 0.36 &\n0.18\\cdot 0 + (-0.9)\\cdot 0.2 + 1\\cdot 1 + 0\\cdot 0.6\\\\\n0.18\\cdot 0 + (-0.9)\\cdot 0 + 1\\cdot 0.2 + 0\\cdot 1 &\n0.18\\cdot 0 + (-0.9)\\cdot 0 + 1\\cdot 0 + 0\\cdot 0.2\n\\end{pmatrix}\\\\\n&= \\begin{pmatrix}-0.264 & 0.82 & 0.2 & 0\\end{pmatrix}.\n\\end{aligned}\n$$\n对于 $Q_y$ 的第二行，\n$$\n\\begin{aligned}\n\\begin{pmatrix}0.162 & -0.63 & 0 & 1\\end{pmatrix}\\mathcal{T}_U\n&= \\begin{pmatrix}\n0.162\\cdot 0.2 + (-0.63)\\cdot 1 + 0\\cdot 0.6 + 1\\cdot 0.36 &\n0.162\\cdot 0 + (-0.63)\\cdot 0.2 + 0\\cdot 1 + 1\\cdot 0.6\\\\\n0.162\\cdot 0 + (-0.63)\\cdot 0 + 0\\cdot 0.2 + 1\\cdot 1 &\n0.162\\cdot 0 + (-0.63)\\cdot 0 + 0\\cdot 0 + 1\\cdot 0.2\n\\end{pmatrix}\\\\\n&= \\begin{pmatrix}-0.2376 & 0.474 & 1 & 0.2\\end{pmatrix}.\n\\end{aligned}\n$$\n因此，\n$$\nQ_u=-Q_y\\,\\mathcal{T}_U=\n\\begin{pmatrix}\n0.264 & -0.82 & -0.2 & 0\\\\\n0.2376 & -0.474 & -1 & -0.2\n\\end{pmatrix}.\n$$\n通过这些选择，残差\n$$\nr = Q_y\\,Y + Q_u\\,U\n= Q_y\\left(\\mathcal{T}_U\\,U+\\mathcal{T}_X\\,x_0+\\mathcal{T}_F\\,F\\,f\\right)+Q_u\\,U\n= \\underbrace{Q_y\\,\\mathcal{T}_X}_{0}\\,x_0+\\underbrace{\\big(Q_y\\,\\mathcal{T}_U+Q_u\\big)}_{0}\\,U+Q_y\\,\\mathcal{T}_F\\,F\\,f,\n$$\n简化为\n$$\nr = Q_y\\,f,\n$$\n因为 $\\mathcal{T}_F=I_4$ 且 $F=1$。因此，作用于扩展数据向量 $\\begin{pmatrix}Y^{\\top} & U^{\\top}\\end{pmatrix}^{\\top}$ 的块奇偶校验矩阵为\n$$\n\\Pi=\\big[\\,Q_y\\;\\;Q_u\\,\\big]\n=\n\\begin{pmatrix}\n0.18 & -0.9 & 1 & 0 & \\;\\;0.264 & -0.82 & -0.2 & 0\\\\\n0.162 & -0.63 & 0 & 1 & \\;\\;0.2376 & -0.474 & -1 & -0.2\n\\end{pmatrix},\n$$\n该矩阵从残差中消除了未知的初始状态 $x_0$ 和已测输入 $U$。", "answer": "$$\\boxed{\\begin{pmatrix}\n0.18 & -0.9 & 1 & 0 & 0.264 & -0.82 & -0.2 & 0\\\\\n0.162 & -0.63 & 0 & 1 & 0.2376 & -0.474 & -1 & -0.2\n\\end{pmatrix}}$$", "id": "2706941"}, {"introduction": "生成残差信号后，接下来的关键任务是判断其观测值究竟是预示着真实故障，还是仅仅由系统噪声引起。这需要我们借助统计决策理论来设计一个可靠的决策逻辑。本练习将指导您设计一个经典的奈曼-皮尔逊 (Neyman-Pearson) 检测器，让您深入理解故障检测中的基本权衡 [@problem_id:2706769]。您将学习如何根据给定的虚警率 $\\alpha$ 来设定决策阈值 $\\gamma$，并进一步计算出在该阈值下系统能够可靠检测出的最小故障幅值 $f_{\\min}$。", "problem": "针对一个离散时间线性时不变系统，一个用于故障检测与隔离 (FDI) 的残差生成器产生一个标量残差序列 $ r_k $。在无故障假设 $ \\mathcal{H}_0 $ 下，假设 $ r_k $ 是独立同分布的高斯随机变量，其均值为零，方差为未知的 $ \\sigma^2 $。一次标定实验得到了一个无偏方差估计值 $ \\hat{\\sigma}^2 = 0.09 $，由于标定数据集很大，在检测器设计时可以将其视为已知值。\n\n你的任务是设计一个单边瞬时检测器，用于检测残差中的正均值偏差故障。在故障假设 $ \\mathcal{H}_1 $ 下，该故障被建模为 $ r_k \\sim \\mathcal{N}(f, \\sigma^2) $，其中 $ f > 0 $，且方差与 $ \\mathcal{H}_0 $ 下的方差相同。决策规则是 Neyman–Pearson 类型的：如果在时刻 $ k $ 有 $ r_k > \\gamma $，则宣告故障，其中 $ \\gamma $ 是一个待确定的阈值。\n\n设计要求如下：\n- 在 $ \\mathcal{H}_0 $ 下，单样本误报概率必须等于 $ \\alpha = 1.0 \\times 10^{-3} $。\n- 当均值偏移处于其最小可检测幅值 $ f_{\\min} $ 时，在 $ \\mathcal{H}_1 $ 下的单样本检测概率必须等于 $ \\beta = 0.95 $。\n\n从高斯假设检验的基本原理出发，并且不使用任何预先给定的目标公式，推导：\n1. 满足误报要求的阈值 $ \\gamma $（用 $ \\hat{\\sigma} $ 和 $ \\alpha $ 表示），然后计算其数值。\n2. 对于阈值 $ \\gamma $，能够达到目标检测概率 $ \\beta $ 的最小可检测正均值偏移 $ f_{\\min} $，然后计算其数值。\n\n将 $ \\gamma $ 和 $ f_{\\min} $ 都用与 $ r_k $ 相同的无量纲归一化残差单位表示。将你的最终答案以行向量 $ [\\gamma, f_{\\min}] $ 的形式报告。将每个条目四舍五入到四位有效数字。所有概率都必须按小数处理，而不是百分比。", "solution": "所给问题是一个标准的假设检验练习，这是用于故障检测与隔离 (FDI) 的统计信号处理中的一个核心组成部分。这个问题提法得当，有科学依据，并为获得唯一解提供了所有必要信息。我们将从基本原理出发进行推导。\n\n问题为任意时刻 $k$ 观测到的残差 $r_k$ 定义了两种假设：\n零假设 $\\mathcal{H}_0$ 对应于无故障情况：\n$$r_k \\sim \\mathcal{N}(0, \\sigma^2)$$\n备择假设 $\\mathcal{H}_1$ 对应于存在正均值偏差故障的情况：\n$$r_k \\sim \\mathcal{N}(f, \\sigma^2), \\quad \\text{with } f > 0$$\n方差 $\\sigma^2$ 被作为已知值 $\\hat{\\sigma}^2 = 0.09$ 给出。因此，标准差为 $\\sigma = \\sqrt{0.09} = 0.3$。\n决策规则是，如果观测到的残差 $r_k$ 超过阈值 $\\gamma$，即 $r_k > \\gamma$，则宣告故障。\n\n首先，我们确定阈值 $\\gamma$。\n误报概率 $\\alpha$ 是指在没有故障存在时（即 $\\mathcal{H}_0$ 为真时）宣告故障的概率。设计规范要求 $\\alpha = 1.0 \\times 10^{-3}$。\n根据定义，\n$$\\alpha = P(\\text{declare fault} | \\mathcal{H}_0) = P(r_k > \\gamma | r_k \\sim \\mathcal{N}(0, \\sigma^2))$$\n为计算此概率，我们对随机变量 $r_k$ 进行标准化。令 $Z = \\frac{r_k - \\mu}{\\sigma}$ 为一个标准正态随机变量，$Z \\sim \\mathcal{N}(0, 1)$。在 $\\mathcal{H}_0$ 下，均值 $\\mu$ 为 $0$。\n不等式 $r_k > \\gamma$ 可以用标准正态变量 $Z$ 重写为：\n$$\\frac{r_k}{\\sigma} > \\frac{\\gamma}{\\sigma} \\implies Z > \\frac{\\gamma}{\\sigma}$$\n因此，误报概率为 $\\alpha = P(Z > \\frac{\\gamma}{\\sigma})$。\n设 $\\Phi(z)$ 为标准正态分布的累积分布函数 (CDF)，定义为 $\\Phi(z) = P(Z \\le z)$。那么，$P(Z > z) = 1 - \\Phi(z)$。\n所以，我们有关系式：\n$$\\alpha = 1 - \\Phi\\left(\\frac{\\gamma}{\\sigma}\\right)$$\n对 CDF 重新整理得到 $\\Phi(\\frac{\\gamma}{\\sigma}) = 1 - \\alpha$。\n为了求出 $\\Phi$ 的参数，我们使用其反累积分布函数 $\\Phi^{-1}$：\n$$\\frac{\\gamma}{\\sigma} = \\Phi^{-1}(1 - \\alpha)$$\n这就给出了阈值 $\\gamma$ 的解析表达式：\n$$\\gamma = \\sigma \\Phi^{-1}(1 - \\alpha)$$\n已知 $\\sigma = 0.3$ 和 $\\alpha = 0.001$。我们代入这些值：\n$$\\gamma = 0.3 \\times \\Phi^{-1}(1 - 0.001) = 0.3 \\times \\Phi^{-1}(0.999)$$\n$\\Phi^{-1}(0.999)$ 对应于尾部概率为 $0.001$ 的 z-score。从标准正态分布表或计算器可知，$\\Phi^{-1}(0.999) \\approx 3.09023$。\n$$\\gamma \\approx 0.3 \\times 3.09023 \\approx 0.927069$$\n四舍五入到四位有效数字，阈值为 $\\gamma \\approx 0.9271$。\n\n接下来，我们确定最小可检测正均值偏移 $f_{\\min}$。\n检测概率 $\\beta$ 是指在故障确实存在时（即 $\\mathcal{H}_1$ 为真时）正确宣告故障的概率。对于最小可检测幅值 $f_{\\min}$，问题指定 $\\beta = 0.95$。\n根据定义，\n$$\\beta = P(\\text{declare fault} | \\mathcal{H}_1 \\text{ with } f=f_{\\min}) = P(r_k > \\gamma | r_k \\sim \\mathcal{N}(f_{\\min}, \\sigma^2))$$\n再次，我们对随机变量 $r_k$ 进行标准化，这次是在 $\\mathcal{H}_1$ 假设下。均值现在是 $\\mu=f_{\\min}$。\n$$Z = \\frac{r_k - f_{\\min}}{\\sigma} \\sim \\mathcal{N}(0, 1)$$\n不等式 $r_k > \\gamma$ 变为：\n$$r_k - f_{\\min} > \\gamma - f_{\\min} \\implies \\frac{r_k - f_{\\min}}{\\sigma} > \\frac{\\gamma - f_{\\min}}{\\sigma} \\implies Z > \\frac{\\gamma - f_{\\min}}{\\sigma}$$\n因此，检测概率为：\n$$\\beta = P\\left(Z > \\frac{\\gamma - f_{\\min}}{\\sigma}\\right) = 1 - \\Phi\\left(\\frac{\\gamma - f_{\\min}}{\\sigma}\\right)$$\n对 CDF 重新整理得到 $\\Phi(\\frac{\\gamma - f_{\\min}}{\\sigma}) = 1 - \\beta$。\n应用反 CDF：\n$$\\frac{\\gamma - f_{\\min}}{\\sigma} = \\Phi^{-1}(1 - \\beta)$$\n现在，我们求解 $f_{\\min}$：\n$$\\gamma - f_{\\min} = \\sigma \\Phi^{-1}(1 - \\beta)$$\n$$f_{\\min} = \\gamma - \\sigma \\Phi^{-1}(1 - \\beta)$$\n我们可以代入之前推导出的 $\\gamma$ 的表达式，$\\gamma = \\sigma \\Phi^{-1}(1 - \\alpha)$：\n$$f_{\\min} = \\sigma \\Phi^{-1}(1 - \\alpha) - \\sigma \\Phi^{-1}(1 - \\beta) = \\sigma \\left( \\Phi^{-1}(1 - \\alpha) - \\Phi^{-1}(1 - \\beta) \\right)$$\n注意标准正态分布的一个性质，$\\Phi^{-1}(p) = -\\Phi^{-1}(1-p)$。这允许我们将 $\\Phi^{-1}(1-\\beta)$ 写成 $-\\Phi^{-1}(\\beta)$。\n$$f_{\\min} = \\sigma \\left( \\Phi^{-1}(1 - \\alpha) + \\Phi^{-1}(\\beta) \\right)$$\n已知 $\\sigma = 0.3$，$\\alpha = 0.001$ 和 $\\beta = 0.95$。\n$$f_{\\min} = 0.3 \\times \\left( \\Phi^{-1}(0.999) + \\Phi^{-1}(0.95) \\right)$$\n使用之前得到的 $\\Phi^{-1}(0.999) \\approx 3.09023$，并求得 $\\Phi^{-1}(0.95) \\approx 1.64485$：\n$$f_{\\min} \\approx 0.3 \\times (3.09023 + 1.64485) = 0.3 \\times 4.73508$$\n$$f_{\\min} \\approx 1.420524$$\n四舍五入到四位有效数字，最小可检测故障为 $f_{\\min} \\approx 1.421$。\n\n所要求的值为 $\\gamma \\approx 0.9271$ 和 $f_{\\min} \\approx 1.421$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.9271 & 1.421\n\\end{pmatrix}\n}\n$$", "id": "2706769"}, {"introduction": "单个残差或许能告诉我们系统“有”故障，但一个强大的故障诊断与隔离 (FDI) 系统还必须能够辨识出“是哪一个”故障。本练习探讨了一个经典的“故障掩盖” (fault masking) 情形，其中两个不同的故障在单个残差信号中恰好相互抵消，导致检测失效。通过分析这种模糊性的成因并设计一个基于多残差的解决方案，您将掌握故障隔离的核心思想：即必须通过设计，确保不同故障在残差向量中具有线性独立的“故障特征”，这是实现精确故障定位的关键 [@problem_id:2706778]。", "problem": "考虑一个稳定的线性时不变系统，该系统具有单个已知控制输入 $u(t)$ 和两个可测输出 $y_1(t)$ 和 $y_2(t)$。两个加性传感器侧故障通道 $f_1(t)$ 和 $f_2(t)$ 以已知的静态增益进入测量输出，且测量噪声为零均值，协方差已知。具体而言，\n$$\n\\begin{aligned}\ny_1(t) &= G_1(s)\\,u(t) \\;+\\; f_1(t) \\;+\\; f_2(t) \\;+\\; v_1(t),\\\\\ny_2(t) &= G_2(s)\\,u(t) \\;+\\; a\\,f_1(t) \\;+\\; b\\,f_2(t) \\;+\\; v_2(t),\n\\end{aligned}\n$$\n其中 $G_1(s)$ 和 $G_2(s)$ 是已知的稳定传递函数，$a \\in \\mathbb{R}$ 和 $b \\in \\mathbb{R}$ 是已知常数，$v_1(t)$ 和 $v_2(t)$ 是零均值、宽平稳、相互不相关且方差有限的测量噪声。为 $y_1$ 定义一个标准的一致性残差为\n$$\nr_1(t) \\;=\\; y_1(t) \\;-\\; G_1(s)\\,u(t),\n$$\n并使用阈值检测 $|r_1(t)| > \\tau_1$ 进行检测，其中选择 $\\tau_1 > 0$ 以满足在无故障假设下预设的误报概率。$r_1$ 中的故障特征对于 $f_1$ 和 $f_2$ 是加性和线性的。\n\n假设两个阶跃型故障同时发生，其大小相等、符号相反，$f_1(t)=A\\,\\mathbf{1}_{\\{t\\ge 0\\}}$ 和 $f_2(t)=-A\\,\\mathbf{1}_{\\{t\\ge 0\\}}$（对于某个 $A>0$），因此 $f_1$ 和 $f_2$ 在 $r_1$ 中相互抵消。你被要求从第一性原理（残差模型的线性、对零均值噪声下阈值化的假设检验解释，以及故障特征的线性无关性）出发，推理使用 $r_1$ 进行检测的后果，并提出一个能够解决由抵消引起的模糊性的二次残差。\n\n下面哪个选项正确地描述了 $r_1$ 中的抵消所导致的检测性能下降，并提出了一个能够可证明地消除针对给定双故障模式的这种模糊性的二次残差设计？\n\nA. 因为 $r_1$ 经历了抵消，其均值漂移为零，但其方差增加，所以检测概率严格超过误报概率。因此，最可靠的补救措施是降低 $\\tau_1$，直到能够检测到抵消的故障，同时又不会显著影响误报。\n\nB. 当 $f_1(t)=A\\,\\mathbf{1}_{\\{t\\ge 0\\}}$ 和 $f_2(t)=-A\\,\\mathbf{1}_{\\{t\\ge 0\\}}$ 时，标量残差 $r_1$ 相对于无故障情况的均值漂移为零，因此检测概率退化为预设的误报概率。一种补救措施是使用辅助测量 $y_2$ 构建第二个一致性残差 $r_2(t)=y_2(t)-G_2(s)\\,u(t)=a\\,f_1(t)+b\\,f_2(t)+v_2(t)$，并选择 $a\\neq b$ 以使故障特征矩阵 $S=\\begin{bmatrix}1 & 1\\\\ a & b\\end{bmatrix}$ 是满列秩。然后，对于 $f_1=-f_2\\neq 0$，有 $r_1=0$（指均值部分）但 $r_2=(a-b)f_1\\neq 0$（指均值部分），这恢复了可检测性，并能够从 $\\begin{bmatrix}r_1 & r_2\\end{bmatrix}^\\top$ 对 $\\begin{bmatrix}f_1 & f_2\\end{bmatrix}^\\top$ 进行最小二乘估计。\n\nC. $r_1$ 中的抵消总是可以通过缩放来消除：定义一个二次残差 $r_2(t)=k\\,r_1(t)$（对于任何 $k\\neq 0$），这会改变抵消方向，并确保只要 $f_1$ 和 $f_2$ 不为零，$r_2 \\neq 0$。\n\nD. 由于抵消的故障是阶跃型的，将 $r_1$ 通过一个高通滤波器来形成 $r_2$，将会放大阶跃内容，从而撤销抵消，在不改变测量集的情况下改善检测和隔离。\n\nE. 为了最大化隔离能力，选择辅助测量使得 $a=b$，这使得两个故障对 $r_2$ 产生相同的影响；然后模糊性被消除，因为 $r_1$ 和 $r_2$ 在同一方向上携带了关于故障的冗余证据。", "solution": "用户要求对所提供的问题陈述进行严格验证，然后进行解法的第一性原理推导，并对所有选项进行详细分析。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n*   **系统模型**：一个稳定的线性时不变(LTI)系统。\n*   **输入**：一个已知控制输入, $u(t)$。\n*   **输出**：两个可测输出, $y_1(t)$ 和 $y_2(t)$。\n*   **测量方程**：\n    $$\n    \\begin{aligned}\n    y_1(t) &= G_1(s)\\,u(t) \\;+\\; f_1(t) \\;+\\; f_2(t) \\;+\\; v_1(t) \\\\\n    y_2(t) &= G_2(s)\\,u(t) \\;+\\; a\\,f_1(t) \\;+\\; b\\,f_2(t) \\;+\\; v_2(t)\n    \\end{aligned}\n    $$\n*   **定义**：\n    *   $G_1(s)$ 和 $G_2(s)$ 是已知的、稳定的传递函数。\n    *   $f_1(t)$ 和 $f_2(t)$ 是加性传感器侧故障信号。\n    *   $a \\in \\mathbb{R}$ 和 $b \\in \\mathbb{R}$ 是已知常数。\n    *   $v_1(t)$ 和 $v_2(t)$ 是零均值、宽平稳、相互不相关且方差有限的测量噪声。\n*   **$y_1$ 的残差和检测**：\n    *   残差：$r_1(t) = y_1(t) - G_1(s)\\,u(t)$。\n    *   检测测试：$|r_1(t)| > \\tau_1$，其中 $\\tau_1 > 0$ 是一个阈值。\n    *   阈值 $\\tau_1$ 的设置是为了达到一个预设的误报概率。\n*   **特定故障场景**：\n    *   $f_1(t) = A\\,\\mathbf{1}_{\\{t\\ge 0\\}}$ 和 $f_2(t)=-A\\,\\mathbf{1}_{\\{t\\ge 0\\}}$，对于某个常数 $A > 0$。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n1.  **科学基础**：该问题是在LTI系统基于模型的故障检测与隔离（FDI）的标准数学框架内提出的。所有概念——传递函数、残差、一致性关系、故障特征和假设检验——都是控制理论和信号处理的基础。前提是科学合理的。\n2.  **适定性**：这个问题是适定的。它呈现了一个特定的故障掩盖场景，并要求分析其后果并提出结构化的补救措施。可以从所提供的信息中推导出唯一的答案。\n3.  **客观性**：该问题以精确的数学和工程语言陈述。它没有主观性或模糊性。\n4.  **完整性和一致性**：问题陈述是自洽的。它提供了分析系统行为和评估潜在解决方案所需的所有必要方程、定义和条件。没有矛盾之处。\n5.  **现实性和可行性**：分析“难以”检测的故障方向的场景是鲁棒FDI设计的基石。这种抵消故障的具体情况是用于说明可检测性和可隔离性概念的经典示例。该设置是一个标准的理论模型。\n\n**步骤 3：结论与行动**\n\n问题陈述是有效的。这是故障检测与隔离领域中一个表述良好的问题。我将继续推导解决方案。\n\n### 解法推导\n\n主残差 $r_1(t)$ 定义为：\n$$r_1(t) = y_1(t) - G_1(s)\\,u(t)$$\n代入 $y_1(t)$ 的表达式：\n$$r_1(t) = \\left(G_1(s)\\,u(t) + f_1(t) + f_2(t) + v_1(t)\\right) - G_1(s)\\,u(t)$$\n$$r_1(t) = f_1(t) + f_2(t) + v_1(t)$$\n这个方程显示了故障和残差之间的关系。它是一个线性模型。项 $f_1(t) + f_2(t)$ 是残差 $r_1(t)$ 中的故障特征。\n\n**检测性能下降分析**\n\n检测逻辑是关于残差均值的假设检验。\n*   **零假设 $H_0$（无故障）**：$f_1(t)=0$ 且 $f_2(t)=0$。残差为 $r_1(t) = v_1(t)$。由于 $v_1(t)$ 是一个零均值过程，残差的期望值为 $E[r_1(t) | H_0] = 0$。选择阈值 $\\tau_1$ 以使得误报概率 $P_{FA} = P(|r_1(t)| > \\tau_1 | H_0)$ 处于一个小的预设水平。\n*   **备择假设 $H_1$（有故障）**：给定的特定故障场景是 $f_1(t) = A\\,\\mathbf{1}_{\\{t\\ge 0\\}}$ 和 $f_2(t) = -A\\,\\mathbf{1}_{\\{t\\ge 0\\}}$，其中 $A>0$。\n\n对于 $t \\ge 0$，在此故障场景下的残差为：\n$$r_1(t) = A\\,\\mathbf{1}_{\\{t\\ge 0\\}} + (-A\\,\\mathbf{1}_{\\{t\\ge 0\\}}) + v_1(t) = A - A + v_1(t) = v_1(t)$$\n在此故障下 $r_1(t)$ 的统计特性是：\n*   **均值**：$E[r_1(t) | H_1] = E[v_1(t)] = 0$。\n*   **方差**：$\\text{Var}[r_1(t) | H_1] = \\text{Var}[v_1(t)]$。\n\n在此特定故障场景下，残差 $r_1(t)$ 的统计分布与其在无故障假设 $H_0$ 下的分布完全相同。因此，检测概率 $P_D = P(|r_1(t)| > \\tau_1 | H_1)$ 变得等于误报概率 $P_{FA} = P(|v_1(t)| > \\tau_1) = P(|r_1(t)| > \\tau_1 | H_0)$。由于该故障不产生均值漂移，因此它对于此残差是完全不可检测的。检测性能退化到基线误报率。\n\n**提出二次残差**\n\n模糊性的产生是因为两个故障以线性相关的方式影响 $r_1(t)$。为解决此问题，我们必须从系统中引入新的信息。可以使用第二个测量值 $y_2(t)$，通过相同的一致性空间原理构建一个二次残差 $r_2(t)$：\n$$r_2(t) = y_2(t) - G_2(s)\\,u(t)$$\n代入 $y_2(t)$ 的表达式：\n$$r_2(t) = \\left(G_2(s)\\,u(t) + a\\,f_1(t) + b\\,f_2(t) + v_2(t)\\right) - G_2(s)\\,u(t)$$\n$$r_2(t) = a\\,f_1(t) + b\\,f_2(t) + v_2(t)$$\n现在，我们有一个残差向量 $\\mathbf{r}(t) = \\begin{bmatrix} r_1(t) \\\\ r_2(t) \\end{bmatrix}$，其无噪声部分通过一个静态矩阵，即故障特征矩阵 $S$，与故障向量 $\\mathbf{f}(t) = \\begin{bmatrix} f_1(t) \\\\ f_2(t) \\end{bmatrix}$ 相关联：\n$$ \\begin{bmatrix} r_1(t) \\\\ r_2(t) \\end{bmatrix} = \\begin{bmatrix} 1 & 1 \\\\ a & b \\end{bmatrix} \\begin{bmatrix} f_1(t) \\\\ f_2(t) \\end{bmatrix} + \\begin{bmatrix} v_1(t) \\\\ v_2(t) \\end{bmatrix} $$\n为了能够从残差向量 $\\mathbf{r}(t)$ 中唯一确定故障向量 $\\mathbf{f}(t)$（在无噪声的意义上），矩阵 $S$ 必须是可逆的，这意味着它必须是满列秩。其条件是其行列式必须非零：\n$$\\det(S) = (1)(b) - (1)(a) = b-a \\neq 0 \\implies a \\neq b$$\n如果 $a \\neq b$，则 $f_1$ 和 $f_2$ 的故障特征在两个残差上是线性无关的。让我们研究特定抵消故障模式 $f_1(t) = -f_2(t) = A\\,\\mathbf{1}_{\\{t\\ge 0\\}}$ 的影响。\n*   对于 $r_1(t)$，均值漂移保持为零：$E[r_1(t)] = f_1+f_2 = A-A=0$。\n*   对于 $r_2(t)$，均值漂移是：$E[r_2(t)] = a\\,f_1 + b\\,f_2 = a(A) + b(-A) = (a-b)A$。\n\n如果 $a \\neq b$ 且 $A > 0$，则均值漂移 $(a-b)A$ 非零。该故障虽然对 $r_1(t)$ 不可见，但在 $r_2(t)$ 中产生了一个可检测的特征。这恢复了可检测性。此外，由于 $S$ 是满秩的，可以从测量向量 $\\mathbf{r}(t)$ 中找到故障向量 $\\mathbf{f}(t)$ 的唯一最小二乘估计，从而实现故障隔离。\n\n### 逐项分析\n\n**A. 因为 $r_1$ 经历了抵消，其均值漂移为零，但其方差增加，所以检测概率严格超过误报概率。因此，最可靠的补救措施是降低 $\\tau_1$，直到能够检测到抵消的故障，同时又不会显著影响误报。**\n\n*   **分析**：这个陈述是错误的。如推导所示，对于故障 $f_1(t) + f_2(t) = 0$，残差为 $r_1(t) = v_1(t)$。其方差不会增加；它保持为 $\\text{Var}[v_1(t)]$。检测概率完全等于误报概率。降低 $\\tau_1$ 不是一个补救措施；它会不可接受地增加误报率。\n*   **结论**：错误。\n\n**B. 当 $f_1(t)=A\\,\\mathbf{1}_{\\{t\\ge 0\\}}$ 和 $f_2(t)=-A\\,\\mathbf{1}_{\\{t\\ge 0\\}}$ 时，标量残差 $r_1$ 相对于无故障情况的均值漂移为零，因此检测概率退化为预设的误报概率。一种补救措施是使用辅助测量 $y_2$ 构建第二个一致性残差 $r_2(t)=y_2(t)-G_2(s)\\,u(t)=a\\,f_1(t)+b\\,f_2(t)+v_2(t)$，并选择 $a\\neq b$ 以使故障特征矩阵 $S=\\begin{bmatrix}1 & 1\\\\ a & b\\end{bmatrix}$ 是满列秩。然后，对于 $f_1=-f_2\\neq 0$，有 $r_1=0$（指均值部分）但 $r_2=(a-b)f_1\\neq 0$（指均值部分），这恢复了可检测性，并能够从 $\\begin{bmatrix}r_1 & r_2\\end{bmatrix}^\\top$ 对 $\\begin{bmatrix}f_1 & f_2\\end{bmatrix}^\\top$ 进行最小二乘估计。**\n\n*   **分析**：该选项准确地描述了问题和解决方案。它正确地指出均值漂移为零且检测概率退化。它正确地提出了 $r_2(t)$ 的构建方法。它正确地识别了故障特征矩阵 $S$ 及其满秩的条件 $a \\neq b$。它正确地推断出，在此条件下，$r_2$ 将对抵消故障敏感。最后，它正确地将 $S$ 的满秩属性与估计（从而隔离）故障的能力联系起来。整个陈述从第一性原理来看是正确的。\n*   **结论**：正确。\n\n**C. $r_1$ 中的抵消总是可以通过缩放来消除：定义一个二次残差 $r_2(t)=k\\,r_1(t)$（对于任何 $k\\neq 0$），这会改变抵消方向，并确保只要 $f_1$ 和 $f_2$ 不为零，$r_2 \\neq 0$。**\n\n*   **分析**：这从根本上是错误的。如果 $r_1(t)$ 的均值由于抵消而为零，那么对于任何非零常数 $k$，$k\\,r_1(t)$ 的均值也将为零。缩放不会引入新的信息，也无法打破导致问题的线性相关性。\n*   **结论**：错误。\n\n**D. 由于抵消的故障是阶跃型的，将 $r_1$ 通过一个高通滤波器来形成 $r_2$，将会放大阶跃内容，从而撤销抵消，在不改变测量集的情况下改善检测和隔离。**\n\n*   **分析**：抵消 $f_1(t)+f_2(t)=0$ 在任何滤波应用于残差之前就已经代数上发生。所提出的高通滤波器的输入将是 $r_1(t) = v_1(t)$。该信号中没有“阶跃内容”可供放大。故障信息在 $r_1(t)$ 中已不可挽回地丢失。\n*   **结论**：错误。\n\n**E. 为了最大化隔离能力，选择辅助测量使得 $a=b$，这使得两个故障对 $r_2$ 产生相同的影响；然后模糊性被消除，因为 $r_1$ 和 $r_2$ 在同一方向上携带了关于故障的冗余证据。**\n\n*   **分析**：这与正确的程序相反。设置 $a=b$ 会使特征矩阵 $S$ 的列线性相关，即 $\\det(S)=0$。这个条件保证了故障方向 $f_1 = -f_2$ 对*两个*残差都是不可见的。这两个残差将携带关于和 $f_1+f_2$ 的冗余信息，但没有关于差 $f_1-f_2$ 的信息。选择 $a=b$ 会最大化而非消除模糊性。\n*   **结论**：错误。", "answer": "$$\\boxed{B}$$", "id": "2706778"}]}