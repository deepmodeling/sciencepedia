{"hands_on_practices": [{"introduction": "掌握内模原理的第一步是理解其核心的代数关系。为了实现对外部信号的精确跟踪或抑制，控制系统必须在稳态下产生特定的状态和控制输入。这个练习将引导你通过一个具体的例子，推导并求解被称为“调节器方程”的线性代数方程组 [@problem_id:2752873]。通过计算实现零稳态误差所必需的稳态映射矩阵 $\\Pi$ 和 $\\Gamma$，你将建立起对输出调节问题代数基础的坚实理解。", "problem": "考虑标准输出调节设置中的线性时不变对象和外源系统：\n- 对象动态：$\\dot{x} = A x + B u + P w$，其中测量/调节误差为 $e = C x + D u + Q w$。\n- 外源系统动态：$\\dot{w} = S w$。\n这里 $x \\in \\mathbb{R}^{2}$，$u \\in \\mathbb{R}$ 且 $w \\in \\mathbb{R}$。矩阵为\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix}, \\quad\nB = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad\nC = \\begin{pmatrix} 1 & 0 \\end{pmatrix}, \\quad\nD = \\begin{pmatrix} 0 \\end{pmatrix},\n$$\n$$\nP = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad\nQ = \\begin{pmatrix} -1 \\end{pmatrix}, \\quad\nS = \\begin{pmatrix} 0 \\end{pmatrix}.\n$$\n从稳态跟踪和内模原理（IMP）的基本定义开始：假设稳态信号的形式为 $x_{\\mathrm{ss}}(t) = \\Pi w(t)$ 和 $u_{\\mathrm{ss}}(t) = \\Gamma w(t)$，对于由外源系统 $\\dot{w} = S w$ 生成的所有轨迹 $w(\\cdot)$，稳态误差 $e_{\\mathrm{ss}}(t) \\equiv 0$。使用这些定义以及对象和外源系统的方程，推导调节器方程，这些方程将未知矩阵 $\\Pi \\in \\mathbb{R}^{2 \\times 1}$ 和 $\\Gamma \\in \\mathbb{R}^{1 \\times 1}$ 与给定数据 $(A,B,C,D,P,Q,S)$ 联系起来。然后，对于上述具体的数值数据，求解 $\\Pi$ 和 $\\Gamma$，并直接验证调节器方程成立。\n\n将 $\\Gamma$ 的值作为最终答案。请以精确实数形式表示您的答案（无需四舍五入）。不需要物理单位。", "solution": "该问题要求推导用于输出调节的调节器方程，并针对一组给定的系统矩阵求解这些方程。我们首先验证问题陈述。\n\n**问题验证**\n\n步骤 1：提取已知条件\n给定系统是一个线性时不变对象及其关联的外源系统，由以下方程和矩阵描述：\n对象动态：$\\dot{x} = A x + B u + P w$\n调节误差：$e = C x + D u + Q w$\n外源系统动态：$\\dot{w} = S w$\n\n状态、输入和外源系统状态的维度分别为 $x \\in \\mathbb{R}^{2}$，$u \\in \\mathbb{R}$ 和 $w \\in \\mathbb{R}$。给定的矩阵如下：\n$$A = \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}, \\quad D = \\begin{pmatrix} 0 \\end{pmatrix}.$$\n$$P = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad Q = \\begin{pmatrix} -1 \\end{pmatrix}, \\quad S = \\begin{pmatrix} 0 \\end{pmatrix}.$$\n\n问题假设存在形式为 $x_{\\mathrm{ss}}(t) = \\Pi w(t)$ 和 $u_{\\mathrm{ss}}(t) = \\Gamma w(t)$ 的稳态解，其中 $\\Pi \\in \\mathbb{R}^{2 \\times 1}$ 和 $\\Gamma \\in \\mathbb{R}^{1 \\times 1}$ 为常数矩阵，使得对于由外源系统生成的所有轨迹 $w(t)$，稳态误差 $e_{\\mathrm{ss}}(t)$ 恒为零。\n\n步骤 2：使用提取的已知条件进行验证\n该问题是在控制理论的标准数学框架内提出的，特别是输出调节理论。\n- **科学性：** 问题使用了标准的状态空间表示和内模原理的核心概念。它不含科学谬误或伪科学。\n- **适定性：** 问题提供了一整套矩阵，并要求推导和求解代数方程。$\\Pi$ 和 $\\Gamma$ 解的存在性和唯一性取决于由给定系统矩阵构造的一个特定矩阵的可逆性。初步检查表明此条件得到满足，因此该问题是适定的。\n- **客观性：** 问题采用精确的数学语言陈述，没有任何主观或含糊的术语。\n该问题是自洽的、一致的且科学上合理的。\n\n步骤 3：结论与行动\n该问题被判定为 **有效**。我们现在开始求解。\n\n**调节器方程的推导**\n\n目标是找到矩阵 $\\Pi$和 $\\Gamma$，使得当 $x(t) = x_{\\mathrm{ss}}(t) = \\Pi w(t)$ 和 $u(t) = u_{\\mathrm{ss}}(t) = \\Gamma w(t)$ 时，对于由 $\\dot{w} = S w$ 生成的任何 $w(t)$，对象动态得以满足且误差 $e(t)$ 为零。\n\n首先，我们将稳态信号代入对象动态方程：\n$\\dot{x}_{\\mathrm{ss}} = A x_{\\mathrm{ss}} + B u_{\\mathrm{ss}} + P w$。\n$x_{\\mathrm{ss}}(t)$ 的时间导数由链式法则给出：$\\dot{x}_{\\mathrm{ss}}(t) = \\frac{d}{dt} (\\Pi w(t)) = \\Pi \\dot{w}(t)$。\n使用外源系统动态 $\\dot{w} = S w$，我们得到 $\\dot{x}_{\\mathrm{ss}} = \\Pi S w$。\n将所有稳态表达式代入对象方程可得：\n$\\Pi S w = A (\\Pi w) + B (\\Gamma w) + P w$。\n这个方程必须对由外源系统生成的所有 $w(t)$ 都成立。因此，我们可以写出：\n$(\\Pi S - A \\Pi - B \\Gamma - P)w = 0$。\n为了使此式对任何非平凡的 $w$ 都成立，乘以 $w$ 的矩阵必须为零。这给出了第一个调节器方程：\n$\\Pi S = A \\Pi + B \\Gamma + P$，或者，整理后得到：\n$A \\Pi + B \\Gamma - \\Pi S = -P$。\n\n其次，我们强制稳态误差为零的条件，即 $e_{\\mathrm{ss}}(t) \\equiv 0$。误差由 $e = C x + D u + Q w$ 给出。在稳态下：\n$e_{\\mathrm{ss}} = C x_{\\mathrm{ss}} + D u_{\\mathrm{ss}} + Q w = C(\\Pi w) + D(\\Gamma w) + Q w = (C \\Pi + D \\Gamma + Q)w$。\n为了使 $e_{\\mathrm{ss}}(t)$ 对任何 $w(t)$ 都为零，矩阵因子必须为零。这给出了第二个调节器方程：\n$C \\Pi + D \\Gamma + Q = 0$，或者，整理后得到：\n$C \\Pi + D \\Gamma = -Q$。\n\n矩阵方程组\n$$\n\\begin{cases}\nA \\Pi + B \\Gamma - \\Pi S = -P \\\\\nC \\Pi + D \\Gamma = -Q\n\\end{cases}\n$$\n是一般的调节器方程。\n\n**针对给定数据的求解**\n\n现在我们使用所提供的数值矩阵来解这些方程。\n矩阵 $S$ 为 $S = \\begin{pmatrix} 0 \\end{pmatrix}$，这将第一个调节器方程简化为：\n$A \\Pi + B \\Gamma = -P$。\n矩阵 $D$ 为 $D = \\begin{pmatrix} 0 \\end{pmatrix}$，这将第二个调节器方程简化为：\n$C \\Pi = -Q$。\n\n设未知矩阵表示为 $\\Pi = \\begin{pmatrix} \\pi_1 \\\\ \\pi_2 \\end{pmatrix}$ 和 $\\Gamma = \\begin{pmatrix} \\gamma_1 \\end{pmatrix}$。\n\n我们从第二个更简单的方程开始：$C \\Pi = -Q$。\n代入矩阵：\n$$\n\\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} \\pi_1 \\\\ \\pi_2 \\end{pmatrix} = - \\begin{pmatrix} -1 \\end{pmatrix}\n$$\n进行矩阵乘法可得：\n$$\n\\begin{pmatrix} \\pi_1 \\end{pmatrix} = \\begin{pmatrix} 1 \\end{pmatrix}\n$$\n因此，我们得到 $\\pi_1 = 1$。\n\n接下来，我们使用第一个方程：$A \\Pi + B \\Gamma = -P$。\n代入矩阵和已知的 $\\pi_1$ 值：\n$$\n\\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ \\pi_2 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} \\gamma_1 \\end{pmatrix} = - \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n展开矩阵乘积：\n$$\n\\begin{pmatrix} \\pi_2 \\\\ -2 - 3\\pi_2 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ \\gamma_1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}\n$$\n这个向量方程产生一个由两个线性方程组成的方程组：\n1. $\\pi_2 + 0 = 0 \\implies \\pi_2 = 0$。\n2. $-2 - 3\\pi_2 + \\gamma_1 = -1$。\n\n将 $\\pi_2 = 0$ 代入第二个方程：\n$-2 - 3(0) + \\gamma_1 = -1$\n$-2 + \\gamma_1 = -1$\n$\\gamma_1 = 1$。\n\n因此，解为 $\\Pi = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $\\Gamma = \\begin{pmatrix} 1 \\end{pmatrix}$。\n\n**验证**\n\n按照要求，我们通过将 $\\Pi$ 和 $\\Gamma$ 代回调节器方程来验证此解。\n方程 1：$A \\Pi + B \\Gamma = -P$。\n左侧 (LHS)：\n$$\n\\text{LHS} = \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -2 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}\n$$\n右侧 (RHS)：\n$$\n\\text{RHS} = -P = -\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}\n$$\nLHS = RHS。第一个方程成立。\n\n方程 2：$C \\Pi = -Q$。\n左侧 (LHS)：\n$$\n\\text{LHS} = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\end{pmatrix}\n$$\n右侧 (RHS)：\n$$\n\\text{RHS} = -Q = -\\begin{pmatrix} -1 \\end{pmatrix} = \\begin{pmatrix} 1 \\end{pmatrix}\n$$\nLHS = RHS。第二个方程成立。\n验证成功。$\\Gamma$ 的值为 $1$。", "answer": "$$\\boxed{1}$$", "id": "2752873"}, {"introduction": "在解决了核心的代数问题后，下一步是构建一个完整的动态调节器。在实际应用中，我们通常需要设计一个动态控制器，它不仅包含内模，还要能稳定整个闭环系统，并且常常需要利用观测器来估计不可直接测量的状态。这个综合性设计练习 [@problem_id:2752843] 将指导你完成从零开始设计一个基于内模原理的输出反馈调节器的全过程，包括增益选择和观测器设计，从而将理论知识转化为实际的控制策略。", "problem": "考虑以下带有加性输入扰动和需要跟踪的正弦参考信号的单输入单输出线性时不变 (LTI) 系统：\n$$\n\\dot{x}(t) = -2\\,x(t) + u(t) + d(t), \\quad y(t) = x(t),\n$$\n其中 $x(t) \\in \\mathbb{R}$ 是系统状态，$u(t) \\in \\mathbb{R}$ 是控制输入，$d(t) \\in \\mathbb{R}$ 是一个未知常数扰动，而 $y(t) \\in \\mathbb{R}$ 是测量输出。需要跟踪的参考信号 $r(t)$ 是一个满足以下条件的二维外部系统状态 $w_{r}(t) \\in \\mathbb{R}^{2}$ 的第一个分量\n$$\n\\dot{w}_{r}(t) = S_{r}\\,w_{r}(t), \n\\quad \nr(t) = F_{r}\\,w_{r}(t), \n\\quad \nS_{r} = \\begin{bmatrix} 0 & 1 \\\\ -1 & 0 \\end{bmatrix}, \n\\quad \nF_{r} = \\begin{bmatrix} 1 & 0 \\end{bmatrix},\n$$\n因此 $r(t)$ 是一个具有单位弧度频率、未知相位和幅值的正弦波。该（未知）常数扰动满足\n$$\n\\dot{w}_{d}(t) = 0, \\quad d(t) = w_{d}(t) \\in \\mathbb{R}.\n$$\n\n你将设计一个动态输出反馈调节器，该调节器实现内模原理以进行鲁棒跟踪和扰动抑制。使用调节误差 $e(t) \\triangleq y(t) - r(t)$，并包含一个最小内模，该内模嵌入了用于常数扰动的积分器副本和用于正弦波的振荡器副本：\n$$\n\\dot{\\eta}(t) = S\\,\\eta(t) + G\\,e(t), \n\\quad \nu(t) = -k_{x}\\,\\hat{x}(t) - k_{\\eta}^{\\top}\\,\\eta(t),\n$$\n其中 $\\eta(t) \\in \\mathbb{R}^{3}$ 汇集了内模状态，\n$$\nS = \\operatorname{diag}\\!\\big(0, S_{r}\\big) \n= \\begin{bmatrix}\n0 & 0 & 0 \\\\\n0 & 0 & 1 \\\\\n0 & -1 & 0\n\\end{bmatrix}, \n\\quad \nG = \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix},\n$$\n并且使用一个系统状态观测器：\n$$\n\\dot{\\hat{x}}(t) = -2\\,\\hat{x}(t) + u(t) + \\ell\\,\\big(y(t) - \\hat{x}(t)\\big).\n$$\n\n任务：\n- 从内模原理和输出调节框架出发，证明所选内模 $(S,G)$ 的合理性，并推导在全状态反馈情况 $u(t) = -k_{x}\\,x(t) - k_{\\eta}^{\\top}\\,\\eta(t)$ 和误差注入 $\\dot{\\eta} = S\\eta + G(y-r)$ 下的增广闭环动力学。\n- 计算状态反馈增益 $k_{x} \\in \\mathbb{R}$ 和 $k_{\\eta} \\in \\mathbb{R}^{3}$，使得状态对 $(x,\\eta)$ 的增广闭环矩阵的特征多项式等于 $(s+1)(s+2)(s+3)(s+4)$。\n- 计算观测器增益 $\\ell \\in \\mathbb{R}$，使得系统状态的观测器误差动力学在 $s=-6$ 处有一个极点。\n- 通过符号化地推导特征多项式并匹配系数来验证特征值配置。\n- 使用调节器方程或基于内模原理的等效稳态论证，证明对于给定的外部系统类别调节成立，并计算当 $r(t)$ 是单位频率的正弦波且 $d(t)$ 是任意常数时的精确稳态调节误差 $e_{\\infty}$。\n\n作为你的最终答案，仅提供稳态调节误差 $e_{\\infty}$ 的精确值，不带单位。无需四舍五入。", "solution": "问题陈述经审查有效。在线性控制理论的既定框架内，这是一个适定问题，特别涉及输出调节和内模原理。所有必要的数据和条件均已提供，不存在科学、逻辑或数学上的不一致之处。我们可以开始求解。\n\n问题的核心是设计一个控制器，强制系统输出 $y(t)$ 跟踪参考信号 $r(t)$，同时抑制扰动 $d(t)$。内模原理指出，为实现渐近跟踪和扰动抑制，控制器必须包含生成外源信号（$r(t)$ 和 $d(t)$）的动力学模型。\n\n扰动是一个常数 $d(t) = d_0$，由系统 $\\dot{w}_d = 0$（其中 $d=w_d$）生成。其动态模态与特征值 $\\lambda = 0$ 相关联。\n参考信号 $r(t)$ 是一个单位弧度频率的正弦波，由外部系统 $\\dot{w}_r = S_r w_r$ 生成，其中 $S_r = \\begin{bmatrix} 0 & 1 \\\\ -1 & 0 \\end{bmatrix}$。$S_r$ 的特征值为 $\\pm i$。\n其根包含外部系统所有模态的最小多项式是 $p(s) = s(s-i)(s+i) = s(s^2+1) = s^3+s$。内模必须复制这些动力学。所选的内模矩阵 $S = \\operatorname{diag}(0, S_r)$ 的特征值为 $\\{0, \\pm i\\}$，因此正确地嵌入了扰动和参考信号的动力学。\n\n为使内模 $\\dot{\\eta} = S\\eta + Ge$ 有效，误差信号 $e(t)$ 必须能够影响其所有状态。这要求矩阵对 $(S, G)$ 是可控的。可控性矩阵为 $\\mathcal{C} = [G, SG, S^2 G]$。\n给定 $S = \\begin{bmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & -1 & 0 \\end{bmatrix}$ 和 $G = \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix}$，我们计算：\n$$SG = \\begin{bmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & -1 & 0 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix}$$\n$$S^2G = S(SG) = \\begin{bmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & -1 & 0 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\\\ -1 \\end{bmatrix}$$\n可控性矩阵为 $$\\mathcal{C} = \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 1 & 0 & -1 \\end{bmatrix}$$\n行列式为 $\\det(\\mathcal{C}) = 1(-1-0) = -1 \\neq 0$。矩阵对 $(S,G)$ 是可控的，因此 $G$ 的选择是合理的。\n\n首先，我们假设全状态 $x$ 可用于反馈来设计状态反馈增益 $k_x$ 和 $k_\\eta$。控制律为 $u(t) = -k_x x(t) - k_\\eta^\\top \\eta(t)$。增广系统由系统状态 $x$ 和内模状态 $\\eta$ 组成。误差为 $e(t)=y(t)-r(t)=x(t)-r(t)$。\n动力学方程为：\n$\\dot{x} = -2x + u + d = -2x - k_x x - k_\\eta^\\top \\eta + d$\n$\\dot{\\eta} = S\\eta + G(x-r)$\n增广状态 $\\begin{pmatrix} x \\\\ \\eta \\end{pmatrix}$ 的闭环动力学齐次部分由下式给出：\n$$\n\\frac{d}{dt} \\begin{pmatrix} x \\\\ \\eta \\end{pmatrix} = A_{cl} \\begin{pmatrix} x \\\\ \\eta \\end{pmatrix} = \\begin{pmatrix} -2-k_x & -k_\\eta^\\top \\\\ G & S \\end{pmatrix} \\begin{pmatrix} x \\\\ \\eta \\end{pmatrix}\n$$\n令 $k_\\eta = \\begin{pmatrix} k_{\\eta,1} & k_{\\eta,2} & k_{\\eta,3} \\end{pmatrix}^\\top$。闭环矩阵为：\n$$\nA_{cl} = \\begin{pmatrix} -2 - k_x & -k_{\\eta,1} & -k_{\\eta,2} & -k_{\\eta,3} \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\\\ 1 & 0 & -1 & 0 \\end{pmatrix}\n$$\n特征多项式为 $P(s) = \\det(sI - A_{cl})$：\n$$\nP(s) = \\det \\begin{pmatrix} s+2+k_x & k_{\\eta,1} & k_{\\eta,2} & k_{\\eta,3} \\\\ -1 & s & 0 & 0 \\\\ 0 & 0 & s & -1 \\\\ -1 & 0 & 1 & s \\end{pmatrix}\n$$\n例如，沿第二行展开行列式，得到：\n$P(s) = 1 \\cdot \\det \\begin{pmatrix} k_{\\eta,1} & k_{\\eta,2} & k_{\\eta,3} \\\\ 0 & s & -1 \\\\ 0 & 1 & s \\end{pmatrix} + s \\cdot \\det \\begin{pmatrix} s+2+k_x & k_{\\eta,2} & k_{\\eta,3} \\\\ 0 & s & -1 \\\\ -1 & 1 & s \\end{pmatrix}$\n$P(s) = k_{\\eta,1}(s^2+1) + s[(s+2+k_x)(s^2+1) + k_{\\eta,2} + s k_{\\eta,3}]$\n$P(s) = s^4 + (2+k_x)s^3 + (1+k_{\\eta,1}+k_{\\eta,3})s^2 + (2+k_x+k_{\\eta,2})s + k_{\\eta,1}$\n期望的特征多项式为 $P_{des}(s) = (s+1)(s+2)(s+3)(s+4) = s^4 + 10s^3 + 35s^2 + 50s + 24$。\n通过令系数相等：\n$s^0: k_{\\eta,1} = 24$\n$s^3: 2+k_x = 10 \\implies k_x = 8$\n$s^2: 1+k_{\\eta,1}+k_{\\eta,3} = 35 \\implies 1+24+k_{\\eta,3} = 35 \\implies k_{\\eta,3} = 10$\n$s^1: 2+k_x+k_{\\eta,2} = 50 \\implies 2+8+k_{\\eta,2} = 50 \\implies k_{\\eta,2} = 40$\n增益为 $k_x = 8$ 和 $k_\\eta = \\begin{pmatrix} 24 & 40 & 10 \\end{pmatrix}^\\top$。\n\n接下来，我们设计观测器增益 $\\ell$。系统状态 $x$ 的观测器由 $\\dot{\\hat{x}} = -2\\hat{x} + u + \\ell(y-\\hat{x})$ 给出。观测器误差为 $\\tilde{x} = x - \\hat{x}$。其动力学方程为：\n$\\dot{\\tilde{x}} = \\dot{x} - \\dot{\\hat{x}} = (-2x+u+d) - (-2\\hat{x}+u+\\ell(x-\\hat{x})) = -2\\tilde{x} - \\ell\\tilde{x} + d = -(2+\\ell)\\tilde{x} + d$。\n误差动力学齐次部分的特征方程为 $s + (2+\\ell) = 0$。为了将极点置于 $s=-6$，我们设 $2+\\ell = 6$，得到 $\\ell = 4$。\n\n分离原理适用。使用控制律 $u = -k_x\\hat{x} - k_\\eta^\\top\\eta = -k_x(x-\\tilde{x}) - k_\\eta^\\top\\eta$ 的完整闭环系统动力学是稳定的。闭环系统的特征值是控制器特征值 $\\{-1, -2, -3, -4\\}$ 和观测器特征值 $\\{-6\\}$ 的并集。所有特征值都在严格的左半平面。\n\n最后，我们证明调节成立并计算稳态误差 $e_\\infty = \\lim_{t\\to\\infty} e(t)$。内模原理保证，如果闭环系统是稳定的，并且控制器包含了外部系统的内模，则调节误差将收敛到零。我们已经确定了闭环系统是稳定的，并且内模是正确的。一个进一步的条件是，对于外部系统的每个特征值 $\\lambda$，矩阵 $\\begin{pmatrix} A-\\lambda I & B \\\\ C & 0 \\end{pmatrix}$ 具有满列秩，其中 $A=-2, B=1, C=1$。\n对于 $\\lambda=0$: $$\\det\\begin{pmatrix} -2 & 1 \\\\ 1 & 0 \\end{pmatrix} = -1 \\neq 0$$。\n对于 $\\lambda=\\pm i$: $$\\det\\begin{pmatrix} -2\\mp i & 1 \\\\ 1 & 0 \\end{pmatrix} = -1 \\neq 0$$。\n内模原理的所有条件都得到满足。因此，对于任何常数扰动 $d(t)$ 和任何单位频率的正弦参考信号 $r(t)$，跟踪误差 $e(t) = y(t) - r(t)$ 必须收敛到零。\n\n为了用直接的稳态分析来证实这一点，我们分析系统对外源输入的响应。闭环系统是线性和稳定的。稳态响应是系统对扰动和参考信号的响应之和。\n1.  对于常数扰动 $d(t)=d_0$ 和 $r(t)=0$，我们寻找一个常数稳态解 $(x_{ss}, \\eta_{ss}, \\tilde{x}_{ss})$。将导数设为零：\n    $0 = (-2-k_x)x_{ss} - k_\\eta^\\top \\eta_{ss} + k_x \\tilde{x}_{ss} + d_0$\n    $0 = S\\eta_{ss} + Gx_{ss}$\n    $0 = -(2+\\ell)\\tilde{x}_{ss} + d_0$\n    从第二个方程 $S\\eta_{ss} = -Gx_{ss}$ 可知，其分量为 $0 = -x_{ss}$，$\\eta_{ss,3} = 0$，以及 $-\\eta_{ss,2} = -x_{ss}$。这意味着 $x_{ss}=0, \\eta_{ss,2}=0, \\eta_{ss,3}=0$。\n    由于 $y_{ss}=x_{ss}$，输出为零，误差 $e_{ss}=y_{ss}-r_{ss}=0-0=0$。扰动被抑制。\n2.  对于正弦参考信号 $r(t) = \\text{Re}\\{R e^{it}\\}$ 和 $d(t)=0$，我们寻找形式为 $x(t)=\\text{Re}\\{X e^{it}\\}$ 的解。动力学方程变成一个关于复相量 $(X, \\mathbf{H}, \\tilde{X})$ 的线性方程组。\n    关键方程是关于内模状态的：\n    $(iI-S)\\mathbf{H} = G(X-R)$\n    矩阵 $(iI-S)$ 是奇异的，因为 $i$ 是 $S$ 的一个特征值。为了使解 $\\mathbf{H}$ 存在，向量 $G(X-R)$ 必须位于 $(iI-S)$ 的像空间中，这要求它与 $(iI-S)$ 的左零空间正交。$S$ 对应于特征值 $i$ 的左特征向量是 $v_L = \\begin{pmatrix} 0 & 1 & i \\end{pmatrix}^\\top$。条件是 $v_L^\\top G(X-R) = 0$。\n    $v_L^\\top G = \\begin{pmatrix} 0 & 1 & i \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix} = i$。\n    条件变为 $i(X-R) = 0$，这意味着 $X=R$。\n    在稳态下，输出 $y_{ss}$（即 $x_{ss}$）的相量等于参考信号 $r(t)$ 的相量，意味着 $y_{ss}(t) = r(t)$。稳态误差 $e_{ss}(t) = y_{ss}(t) - r(t)$ 恒等于零。\n\n扰动抑制和参考跟踪误差都收敛到零。根据线性原理，对于组合输入，总的稳态误差也为零。\n\n因此，精确的稳态调节误差为 $e_\\infty = 0$。", "answer": "$$\\boxed{0}$$", "id": "2752843"}, {"introduction": "为什么内模原理在控制工程中如此重要？其关键优势在于鲁棒性。这个练习旨在揭示这一核心价值，通过一个思想实验，你将看到一种看似巧妙的干扰抑制方法——即利用被控对象的零点来精确抵消干扰信号——在面对模型参数的微小变化时是多么脆弱 [@problem_id:2752895]。通过亲手计算和对比扰动前后的系统响应，你将深刻体会到，将外部信号模型构建在控制器内部，是实现可靠、鲁棒控制的根本原因所在。", "problem": "考虑一个稳定的单输入单输出 (SISO) 线性时不变 (LTI) 对象，该对象受到一个频率已知的纯正弦输入扰动。标称对象由严格真传递函数\n$$\nP_{0}(s)=\\frac{s^{2}+\\omega_{0}^{2}}{(s+1)(s+2)},\n$$\n给出，其中 $\\omega_{0}>0$ 是一个固定值，且分母多项式是 Hurwitz 的。控制器是一个静态增益\n$$\nC(s)=k,\n$$\n其中实数 $k$ 的选择应使带单位反馈的标称闭环系统是内部稳定的。扰动以相加的方式作用于对象输入端，其形式为\n$$\nd(t)=D\\sin(\\omega_{0} t),\n$$\n其中幅值 $D>0$ 已知。输出记为 $y(t)$。\n\n您将考察当控制器不包含正弦信号的内模时（即当 $C(s)$ 在 $s=\\pm i\\omega_{0}$ 处没有极点时），对标称对象施加一个任意小的互质扰动对稳态扰动抑制的影响。\n\n仅使用以下内容作为您的出发点：通过频率响应定义的LTI系统的正弦稳态响应，单位反馈回路的输入-输出关系，以及左互质分解的概念，其中对象 $P(s)$ 被写作 $P(s)=N(s)D(s)^{-1}$，且 $N(s)$ 和 $D(s)$ 是稳定且互质的。\n\n1. 证明对于标称对象 $P_{0}(s)$ 和控制器 $C(s)$，由 $d(t)$ 引起的 $y(t)$ 在频率 $\\omega_{0}$ 处的稳态正弦分量恒为零。\n\n2. 通过设定\n$$\nP_{\\varepsilon}(s)=\\frac{N_{0}(s)+\\varepsilon\\,\\Delta N(s)}{D_{0}(s)+\\varepsilon\\,\\Delta D(s)},\n$$\n其中 $N_{0}(s)=s^{2}+\\omega_{0}^{2}$，$D_{0}(s)=(s+1)(s+2)$，$\\Delta N(s)=1$，$\\Delta D(s)=0$，以及 $\\varepsilon\\in\\mathbb{R}$ 非零但任意小，来构造一个 $P_{0}(s)$ 的任意小的左互质扰动。论证对于足够小的 $|\\varepsilon|$，带有 $C(s)=k$ 的闭环系统保持内部稳定。\n\n3. 将带有 $P_{\\varepsilon}(s)$ 和 $C(s)=k$ 的扰动回路中从扰动输入 $d$ 到输出 $y$ 的传递函数记为 $T_{dy,\\varepsilon}(s)$。利用在 $s=i\\omega_{0}$ 处的频率响应，推导出 $y(t)$ 在频率 $\\omega_{0}$ 处的稳态正弦分量幅值的精确闭式表达式，该表达式是关于 $\\varepsilon$、$\\omega_{0}$、$k$ 和 $D$ 的函数。\n\n您的最终答案必须是这个稳态幅值，以 $\\varepsilon$、$\\omega_{0}$、$k$ 和 $D$ 的单一闭式解析表达式形式给出。不要通过渐近近似进行简化，并且在最终的方框答案中不要包含任何单位。不要对结果进行四舍五入。", "solution": "所述问题具有科学依据，提法恰当且客观。它提出了一个控制理论中分析扰动抑制鲁棒性的标准场景。注意到一个小小的术语不一致：问题中提到“左互质分解”$P(s)=N(s)D(s)^{-1}$，其中 $N(s)$ 和 $D(s)$ 是稳定的，这在技术上是标量系统的右互质分解形式，然后又将 $N_0(s)$ 定义为一个不稳定的多项式。然而，计算步骤已由给定的对象扰动方程通过多项式之比明确定义。这种不精确性不会使问题无效，因为预期的数学运算是清晰的。我们将按照指定的多项式表示进行处理。整体结构要求展示一个基本概念：与基于内模原理的抑制不同，基于对象零点的扰动抑制对参数不确定性是不鲁棒的。\n\n具有对象 $P(s)$、控制器 $C(s)$ 并在对象输入端有附加扰动 $d(t)$ 的单位反馈回路，其输出 $y(t)$ 由方程描述。当参考信号为零时，控制信号为 $u = d - C y$。对象输出为 $y = P u = P(d - C y)$。对 $y$ 求解得到 $Y(s)(1+P(s)C(s)) = P(s)D(s)$。从扰动 $d$ 到输出 $y$ 的传递函数由下式给出：\n$$T_{dy}(s) = \\frac{Y(s)}{D(s)} = \\frac{P(s)}{1+P(s)C(s)}$$\n对于正弦输入 $d(t)=D\\sin(\\omega_0 t)$，一个稳定的LTI系统的稳态输出是同频率的正弦波，$y_{ss}(t) = A \\sin(\\omega_0 t + \\phi)$，其中幅值为 $A = D |T_{dy}(i\\omega_0)|$，相位为 $\\phi = \\angle T_{dy}(i\\omega_0)$。\n\n1. 标称系统的扰动抑制。\n\n对于标称对象 $P_0(s) = \\frac{s^2+\\omega_0^2}{(s+1)(s+2)}$ 和控制器 $C(s)=k$，扰动到输出的传递函数是：\n$$T_{dy,0}(s) = \\frac{P_0(s)}{1+k P_0(s)} = \\frac{\\frac{s^2+\\omega_0^2}{(s+1)(s+2)}}{1+k\\frac{s^2+\\omega_0^2}{(s+1)(s+2)}} = \\frac{s^2+\\omega_0^2}{(s+1)(s+2) + k(s^2+\\omega_0^2)}$$\n为求得对 $d(t)=D\\sin(\\omega_0 t)$ 的稳态响应，我们在 $s=i\\omega_0$ 处计算 $T_{dy,0}(s)$ 的值：\n$$T_{dy,0}(i\\omega_0) = \\frac{(i\\omega_0)^2+\\omega_0^2}{(i\\omega_0+1)(i\\omega_0+2) + k((i\\omega_0)^2+\\omega_0^2)}$$\n分子为 $(i\\omega_0)^2+\\omega_0^2 = -\\omega_0^2+\\omega_0^2 = 0$。\n在 $s=i\\omega_0$ 处的分母为 $(i\\omega_0+1)(i\\omega_0+2) + k(0) = -\\omega_0^2+3i\\omega_0+2$。由于 $\\omega_0>0$，该分母不为零。问题陈述中标称闭环系统是内部稳定的，这保证了 $T_{dy,0}(s)$ 的分母，即特征多项式 $(s+1)(s+2)+k(s^2+\\omega_0^2)$，在 $s=\\pm i\\omega_0$ 处没有根。\n因此，在 $\\omega_0$ 处的频率响应为：\n$$T_{dy,0}(i\\omega_0) = \\frac{0}{2-\\omega_0^2 + 3i\\omega_0} = 0$$\n$y(t)$ 的稳态正弦分量的幅值为 $A_0 = D |T_{dy,0}(i\\omega_0)| = D \\cdot 0 = 0$。这表明对于标称系统，实现了对扰动的完全稳态抑制。这种抑制得以实现，是因为对象在扰动频率 $\\pm i\\omega_0$ 处具有传输零点。\n\n2. 扰动系统及其稳定性。\n\n扰动对象由下式给出：\n$$P_\\varepsilon(s) = \\frac{N_0(s)+\\varepsilon\\Delta N(s)}{D_0(s)+\\varepsilon\\Delta D(s)} = \\frac{s^2+\\omega_0^2+\\varepsilon}{(s+1)(s+2)}$$\n具有扰动对象 $P_\\varepsilon(s)$ 的闭环系统的特征多项式由 $1+kP_\\varepsilon(s)$ 的分子给出：\n$$\\chi_\\varepsilon(s) = (s+1)(s+2) + k(s^2+\\omega_0^2+\\varepsilon) = (1+k)s^2 + 3s + (2+k\\omega_0^2+k\\varepsilon)$$\n标称特征多项式 (对于 $\\varepsilon=0$) 是 $\\chi_0(s) = (1+k)s^2 + 3s + (2+k\\omega_0^2)$。根据问题陈述，标称闭环系统是内部稳定的，这意味着 $\\chi_0(s)$ 的所有根都位于开左半复平面内。\n多项式的根是其系数的连续函数。$\\chi_\\varepsilon(s)$ 的系数是 $\\varepsilon$ 的连续 (实际上是线性) 函数。由于 $\\chi_0(s)$ 的根严格位于左半平面内 (不在虚轴上)，因此存在一个 $\\varepsilon=0$ 的邻域，使得对于该邻域内的任何 $\\varepsilon$，$\\chi_\\varepsilon(s)$ 的根也位于左半平面内。因此，对于足够小的 $|\\varepsilon|$，扰动闭环系统保持内部稳定。\n\n3. 扰动系统的稳态幅值。\n\n扰动系统的扰动到输出的传递函数是：\n$$T_{dy,\\varepsilon}(s) = \\frac{P_\\varepsilon(s)}{1+k P_\\varepsilon(s)} = \\frac{\\frac{s^2+\\omega_0^2+\\varepsilon}{(s+1)(s+2)}}{1+k\\frac{s^2+\\omega_0^2+\\varepsilon}{(s+1)(s+2)}} = \\frac{s^2+\\omega_0^2+\\varepsilon}{(s+1)(s+2) + k(s^2+\\omega_0^2+\\varepsilon)}$$\n我们在 $s=i\\omega_0$ 处计算此传递函数的值，以求得对扰动的稳态响应。\n分子变为：\n$$(i\\omega_0)^2+\\omega_0^2+\\varepsilon = -\\omega_0^2+\\omega_0^2+\\varepsilon = \\varepsilon$$\n分母变为：\n$$(i\\omega_0+1)(i\\omega_0+2) + k((i\\omega_0)^2+\\omega_0^2+\\varepsilon) = (i\\omega_0)^2+3i\\omega_0+2 + k\\varepsilon = -\\omega_0^2+3i\\omega_0+2+k\\varepsilon$$\n将实部和虚部分组，分母是 $(2-\\omega_0^2+k\\varepsilon) + i(3\\omega_0)$。\n在 $\\omega_0$ 处的频率响应为：\n$$T_{dy,\\varepsilon}(i\\omega_0) = \\frac{\\varepsilon}{(2-\\omega_0^2+k\\varepsilon) + i(3\\omega_0)}$$\n这个复数的模是：\n$$|T_{dy,\\varepsilon}(i\\omega_0)| = \\frac{|\\varepsilon|}{|(2-\\omega_0^2+k\\varepsilon) + i(3\\omega_0)|} = \\frac{|\\varepsilon|}{\\sqrt{(2-\\omega_0^2+k\\varepsilon)^2 + (3\\omega_0)^2}} = \\frac{|\\varepsilon|}{\\sqrt{(2-\\omega_0^2+k\\varepsilon)^2 + 9\\omega_0^2}}$$\n输出 $y(t)$ 的稳态正弦分量的幅值是该模值乘以扰动幅值 $D$。\n$$A_\\varepsilon = D |T_{dy,\\varepsilon}(i\\omega_0)| = D \\frac{|\\varepsilon|}{\\sqrt{(2-\\omega_0^2+k\\varepsilon)^2 + 9\\omega_0^2}}$$\n这就是稳态输出幅值的精确闭式表达式。这个结果表明，对于任何非零的扰动 $\\varepsilon$（无论多小），完全抑制都会失效，并且输出中会出现一个正弦分量。对于小的 $\\varepsilon$，此分量的幅值与 $|\\varepsilon|$ 成正比，这突显了基于对象零点对消的扰动抑制的非鲁棒性。", "answer": "$$\n\\boxed{D \\frac{|\\varepsilon|}{\\sqrt{(2-\\omega_0^2+k\\varepsilon)^2 + 9\\omega_0^2}}}\n$$", "id": "2752895"}]}