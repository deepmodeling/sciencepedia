{"hands_on_practices": [{"introduction": "在任何迭代方案中，一个最基本的问题是：“我们需要多少次迭代才能达到期望的性能？”。这个练习将探讨迭代学习控制（ILC）和重复控制（RC）中的线性收敛概念，其中误差在每次试验中都按一个固定的比例减小。通过推导收敛因子 $\\gamma$ 与达到特定误差缩减所需的试验次数 $k$ 之间的关系，您将能够将抽象的收敛理论与实际的性能预测直接联系起来 [@problem_id:2714829]。", "problem": "一个离散时间控制系统在同一有限时间任务上重复运行。一种迭代学习控制 (ILC) 方案逐批次更新控制输入。设每次批次结束时的逐批次跟踪误差表示为 $e_{k}$，其中 $k \\in \\mathbb{N}_{0}$ 是批次索引。假设学习更新产生一种形式为 $e_{k+1} = \\mathcal{L}\\, e_{k}$ 的线性误差传播，其中 $\\mathcal{L}$ 是一个赋范向量空间上的有界线性算子，其诱导范数满足 $\\|\\mathcal{L}\\| \\leq \\gamma$，对于某个常数 $0 < \\gamma < 1$。当将 $k$ 解释为周期索引时，同样的框架也用于重复控制 (RC)。\n\n从诱导范数的次可乘性出发，并且除了对数和范数的基本性质外，不引用任何专门的收敛结果，推导出一个不等式，该不等式将误差范数减小一个因子 $\\epsilon$ (其中 $0 < \\epsilon < 1$) 所需的批次数 $k$ 与迭代收敛因子 $\\gamma$ 联系起来。然后，使用您推导出的结果，确定当 $\\gamma = 0.83$ 且 $\\epsilon = 0.01$ 时，为使误差范数至少减小一个因子 $\\epsilon$ 所需的最小整数批次数 $k$。\n\n仅将您的最终答案表示为最小整数 $k$。无需四舍五入说明；选择满足要求的最小整数。", "solution": "首先对问题陈述进行严格的验证过程。\n\n从陈述中提取的已知条件如下：\n- 描述了一个离散时间控制系统。\n- 该系统在有限时间任务上重复运行。\n- 使用了迭代学习控制 (ILC) 或重复控制 (RC) 方案。\n- 批次/周期索引为 $k \\in \\mathbb{N}_{0}$。\n- 批次 $k$ 结束时的误差是 $e_k$，是赋范向量空间中的一个元素。\n- 误差传播由线性关系 $e_{k+1} = \\mathcal{L}\\, e_{k}$ 控制。\n- $\\mathcal{L}$ 是一个有界线性算子。\n- 该算子的诱导范数满足 $\\|\\mathcal{L}\\| \\leq \\gamma$。\n- 收敛因子 $\\gamma$ 是一个常数，满足 $0 < \\gamma < 1$。\n- 要求的误差范数减小因子为 $\\epsilon$，其中 $0 < \\epsilon < 1$。\n- 推导必须从诱导范数的次可乘性出发，并使用对数和范数的基本性质。\n- 最终计算要求找到当 $\\gamma = 0.83$ 且 $\\epsilon = 0.01$ 时的最小整数 $k$。\n\n对问题的有效性进行评估。这是线性迭代系统分析中的一个标准问题，在控制理论中很常见，特别是在 ILC 和 RC 的研究中。模型 $e_{k+1} = \\mathcal{L}\\, e_{k}$ 以及条件 $\\|\\mathcal{L}\\| < 1$ 是证明线性收敛的范式。该问题具有科学依据、提法恰当、客观，并包含足够的信息以获得唯一解。其中没有矛盾，不依赖伪科学，也没有模糊之处。因此，该问题被认为是有效的，并将提供解答。\n\n任务是推导出一个不等式，用于计算实现误差范数至少减小一个因子 $\\epsilon$ 所需的批次数 $k$，然后针对给定参数计算这个最小整数 $k$。\n\n我们从误差传播动态学开始：\n$$\ne_{k+1} = \\mathcal{L}\\, e_{k}\n$$\n其中 $k$ 是批次索引。我们对这个方程的两边取向量范数：\n$$\n\\|e_{k+1}\\| = \\|\\mathcal{L}\\, e_{k}\\|\n$$\n问题指明该范数是诱导范数。诱导范数的一个基本性质是其次可乘性，即对于线性算子 $\\mathcal{L}$ 和向量 $e_k$，不等式 $\\|\\mathcal{L}\\, e_k\\| \\leq \\|\\mathcal{L}\\| \\|e_k\\|$ 成立。应用此性质，我们得到：\n$$\n\\|e_{k+1}\\| \\leq \\|\\mathcal{L}\\| \\|e_k\\|\n$$\n给定条件是 $\\|\\mathcal{L}\\| \\leq \\gamma$。将此代入不等式，得到误差范数的基本递归关系：\n$$\n\\|e_{k+1}\\| \\leq \\gamma \\|e_k\\|\n$$\n这个不等式将批次 $k+1$ 的误差范数与批次 $k$ 的误差范数联系起来。我们可以展开这个递归，以建立批次 $k$ 的误差与初始批次 $0$ 的误差（即 $\\|e_0\\|$）之间的关系。\n\n对于 $k=1$：\n$$\n\\|e_1\\| \\leq \\gamma \\|e_0\\|\n$$\n对于 $k=2$：\n$$\n\\|e_2\\| \\leq \\gamma \\|e_1\\| \\leq \\gamma (\\gamma \\|e_0\\|) = \\gamma^2 \\|e_0\\|\n$$\n通过数学归纳法，我们可以证明对于任何整数 $k \\geq 1$，一般关系式 $\\|e_k\\| \\leq \\gamma^k \\|e_0\\|$ 成立。\n$k=1$ 的基本情况如上所示。\n假设对于某个整数 $j \\geq 1$ 该假设成立，即 $\\|e_j\\| \\leq \\gamma^j \\|e_0\\|$。\n那么对于 $j+1$，我们有：\n$$\n\\|e_{j+1}\\| \\leq \\gamma \\|e_j\\| \\leq \\gamma (\\gamma^j \\|e_0\\|) = \\gamma^{j+1} \\|e_0\\|\n$$\n该假设对 $j+1$ 成立。因此，不等式 $\\|e_k\\| \\leq \\gamma^k \\|e_0\\|$ 对所有 $k \\geq 1$ 都已证明。\n\n问题要求的是将误差范数减小一个因子 $\\epsilon$ 所需的批次数 $k$。这等同于找到 $k$，使得批次 $k$ 的误差范数与初始误差范数之比小于或等于 $\\epsilon$。假设初始误差不为零，即 $\\|e_0\\| > 0$，此条件为：\n$$\n\\frac{\\|e_k\\|}{\\|e_0\\|} \\leq \\epsilon\n$$\n从我们推导出的不等式中，我们有 $\\frac{\\|e_k\\|}{\\|e_0\\|} \\leq \\gamma^k$。因此，满足误差减小要求的一个充分条件是：\n$$\n\\gamma^k \\leq \\epsilon\n$$\n这是联系 $k$、$\\gamma$ 和 $\\epsilon$ 的一个关键不等式。为了解出 $k$，我们使用对数的性质。我们对两边取自然对数：\n$$\n\\ln(\\gamma^k) \\leq \\ln(\\epsilon)\n$$\n使用对数幂法则 $\\ln(a^b) = b \\ln(a)$，我们得到：\n$$\nk \\ln(\\gamma) \\leq \\ln(\\epsilon)\n$$\n为了分离出 $k$，我们必须除以 $\\ln(\\gamma)$。给定条件是 $0 < \\gamma < 1$，这意味着 $\\ln(\\gamma)$ 是一个负数。不等式两边同除以一个负数会反转不等号的方向。\n$$\nk \\geq \\frac{\\ln(\\epsilon)}{\\ln(\\gamma)}\n$$\n这就是联系批次数 $k$、收敛因子 $\\gamma$ 和期望误差减小因子 $\\epsilon$ 的一般不等式。\n\n现在我们进行问题的第二部分：为特定值 $\\gamma = 0.83$ 和 $\\epsilon = 0.01$ 计算最小整数批次数 $k$。\n将这些值代入推导出的不等式：\n$$\nk \\geq \\frac{\\ln(0.01)}{\\ln(0.83)}\n$$\n对数值为：\n$$\n\\ln(0.01) = \\ln(10^{-2}) = -2 \\ln(10) \\approx -4.605170185988092\n$$\n$$\n\\ln(0.83) \\approx -0.186320953188556\n$$\n比值为：\n$$\n\\frac{\\ln(0.01)}{\\ln(0.83)} \\approx \\frac{-4.605170185988092}{-0.186320953188556} \\approx 24.71618...\n$$\n所以，关于 $k$ 的条件是：\n$$\nk \\geq 24.71618...\n$$\n问题要求满足此条件的最小整数 $k$。由于 $k$ 必须是整数，我们必须选择大于或等于 $24.71618...$ 的最小整数，即 $25$。这个操作在数学上等同于上取整函数，$\\lceil 24.71618... \\rceil = 25$。\n\n因此，至少需要 $25$ 次批次才能保证误差范数至少减小一个因子 $0.01$。", "answer": "$$\n\\boxed{25}\n$$", "id": "2714829"}, {"introduction": "快速收敛固然重要，但我们同样关心误差最终会收敛到什么状态。这个练习将引导您进入频域，这是分析 ILC 和 RC 处理周期性任务时的一个强大工具。您将从第一性原理出发，推导在控制器达到稳态后，残余误差在不同频率上的分布情况，从而揭示学习滤波器 $Q(z)$ 是如何选择性地抑制或放大特定谐波误差的 [@problem_id:2714809]。", "problem": "考虑一个单输入单输出离散时间系统，该系统执行一个周期已知的重复性任务，周期为 $N \\in \\mathbb{Z}_{>0}$ 个采样点。设对象为线性时不变系统，其频率响应对于所有 $\\omega \\in [-\\pi,\\pi]$ 均满足 $G(\\exp(\\mathrm{i}\\omega)) \\equiv 1$。参考信号 $r[n]$ 是周期为 $N$ 的信号，其在谐波频率 $\\omega_k = 2\\pi k/N$（其中 $k \\in \\{0,1,\\dots,N-1\\}$）处的离散时间傅里叶级数系数为 $R(\\exp(\\mathrm{i}\\omega_k))$。在第 $j$ 次试验中，控制输入为 $u_j[n]$，输出为 $y_j[n] = u_j[n]$，因此跟踪误差为 $e_j[n] = r[n] - y_j[n]$。控制器采用迭代学习控制（ILC），使用标准的学习更新法则\n$\nu_{j+1}[n] = \\left(Q(q^{-1}) u_j\\right)[n] + e_j[n],\n$\n其中 $q^{-1}$ 是单位延迟算子，学习滤波器 $Q(z)$ 是一个实对称有限脉冲响应滤波器，其表达式为\n$\nQ(z) = \\tfrac{1}{2} + \\tfrac{1}{4} z + \\tfrac{1}{4} z^{-1}。\n$\n由于任务是周期性的，且控制器是逐次试验运行的，因此您可以在频域中独立分析每个谐波。假设随着试验次数的增加，迭代过程会收敛到一个稳态。\n\n请从第一性原理出发，仅使用上述定义以及线性时不变系统和离散时间傅里叶变换的标准性质，推导出在任务谐波频率处的稳态误差频谱幅值。具体来说，请为由下式定义的逐谐波衰减因子 $A_k$ 求解一个闭式表达式\n$\nA_k \\triangleq \\frac{\\left|E_{\\infty}\\!\\left(\\exp(\\mathrm{i}\\omega_k)\\right)\\right|}{\\left|R\\!\\left(\\exp(\\mathrm{i}\\omega_k)\\right)\\right|},\n$\n该表达式应为仅含 $k$ 和 $N$ 的显式函数，其中 $\\omega_k = 2\\pi k/N$。请将您的最终答案表示为仅含 $k$ 和 $N$ 的单一简化解析表达式（无单位）。此外，在推导过程中，请在代入给定的 $Q(z)$ 之前，将衰减表示为 $Q(\\exp(\\mathrm{i}\\omega_k))$ 的函数。\n\n无需进行数值计算。请以闭式形式给出 $A_k$ 的最终表达式。", "solution": "首先对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 系统类型：单输入单输出（SISO）离散时间、线性时不变（LTI）。\n- 任务周期：$N \\in \\mathbb{Z}_{>0}$ 个采样点。\n- 对象频率响应：对于所有 $\\omega \\in [-\\pi,\\pi]$，$G(\\exp(\\mathrm{i}\\omega)) = 1$。\n- 参考信号：$r[n]$，周期为 $N$，其在谐波频率 $\\omega_k = 2\\pi k/N$（其中 $k \\in \\{0, 1, \\dots, N-1\\}$）处的离散时间傅里叶级数（DTFS）系数为 $R(\\exp(\\mathrm{i}\\omega_k))$。\n- 第 $j$ 次试验的控制输入：$u_j[n]$。\n- 第 $j$ 次试验的系统输出：$y_j[n] = u_j[n]$。\n- 第 $j$ 次试验的跟踪误差：$e_j[n] = r[n] - y_j[n]$。\n- 迭代学习控制（ILC）更新法则：$u_{j+1}[n] = (Q(q^{-1}) u_j)[n] + e_j[n]$。\n- 学习滤波器：$Q(z) = \\frac{1}{2} + \\frac{1}{4} z + \\frac{1}{4} z^{-1}$，一个实对称有限脉冲响应（FIR）滤波器。\n- 假设：随着试验序号 $j \\to \\infty$，迭代过程收敛到稳态。\n- 目标：推导稳态逐谐波衰减因子 $A_k \\triangleq \\frac{|E_{\\infty}(\\exp(\\mathrm{i}\\omega_k))|}{|R(\\exp(\\mathrm{i}\\omega_k))|}$ 作为 $k$ 和 $N$ 的函数。一个中间步骤要求将此衰减表示为 $Q(\\exp(\\mathrm{i}\\omega_k))$ 的函数。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在控制理论领域，特别是在迭代学习控制方面，具有坚实的科学基础。所有术语均为标准术语且定义明确。对象模型 $G(\\exp(\\mathrm{i}\\omega)) = 1$ 是一种理想化处理，但对于学习过程本身的理论分析而言，这是一个有效的简化。该问题是自洽的，提供了所有必要的方程和定义。该问题是适定的，因为收敛性假设确保可以找到唯一的稳态解。语言客观、精确。该问题不违反任何导致无效的标准。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n**推导**\n在频域中对任务谐波 $\\omega_k = 2\\pi k/N$ 进行分析。设信号 $u_j[n]$、$y_j[n]$、$e_j[n]$ 和 $r[n]$ 在频率 $\\omega_k$ 处的离散时间傅里叶级数（DTFS）系数分别表示为 $U_j(\\exp(\\mathrm{i}\\omega_k))$、$Y_j(\\exp(\\mathrm{i}\\omega_k))$、$E_j(\\exp(\\mathrm{i}\\omega_k))$ 和 $R(\\exp(\\mathrm{i}\\omega_k))$。\n\n首先，我们在频域中表示系统动态和 ILC 更新法则。对象动态由 $y_j[n] = u_j[n]$ 给出，在频域中变为：\n$$Y_j(\\exp(\\mathrm{i}\\omega_k)) = U_j(\\exp(\\mathrm{i}\\omega_k))$$\n跟踪误差为 $e_j[n] = r[n] - y_j[n]$，变换到频域为：\n$$E_j(\\exp(\\mathrm{i}\\omega_k)) = R(\\exp(\\mathrm{i}\\omega_k)) - Y_j(\\exp(\\mathrm{i}\\omega_k)) = R(\\exp(\\mathrm{i}\\omega_k)) - U_j(\\exp(\\mathrm{i}\\omega_k))$$\nILC 更新法则是 $u_{j+1}[n] = (Q(q^{-1}) u_j)[n] + e_j[n]$。应用 DTFS，卷积运算 $(Q(q^{-1})u_j)[n]$ 在频域中变为乘法：\n$$U_{j+1}(\\exp(\\mathrm{i}\\omega_k)) = Q(\\exp(\\mathrm{i}\\omega_k)) U_j(\\exp(\\mathrm{i}\\omega_k)) + E_j(\\exp(\\mathrm{i}\\omega_k))$$\n为分析控制输入随试验次数的演变，我们代入误差频谱 $E_j(\\exp(\\mathrm{i}\\omega_k))$ 的表达式：\n$$U_{j+1}(\\exp(\\mathrm{i}\\omega_k)) = Q(\\exp(\\mathrm{i}\\omega_k)) U_j(\\exp(\\mathrm{i}\\omega_k)) + \\left( R(\\exp(\\mathrm{i}\\omega_k)) - U_j(\\exp(\\mathrm{i}\\omega_k)) \\right)$$\n$$U_{j+1}(\\exp(\\mathrm{i}\\omega_k)) = \\left( Q(\\exp(\\mathrm{i}\\omega_k)) - 1 \\right) U_j(\\exp(\\mathrm{i}\\omega_k)) + R(\\exp(\\mathrm{i}\\omega_k))$$\n这是一个关于试验序号 $j$ 的、针对谐波分量 $U_j(\\exp(\\mathrm{i}\\omega_k))$ 的一阶线性差分方程。\n\n问题假设迭代是收敛的，这意味着当 $j \\to \\infty$ 时，控制输入频谱趋近于一个稳态值，$U_j(\\exp(\\mathrm{i}\\omega_k)) \\to U_{\\infty}(\\exp(\\mathrm{i}\\omega_k))$。在此稳态下，$U_{j+1} = U_j = U_{\\infty}$。我们可以求解 $U_{\\infty}(\\exp(\\mathrm{i}\\omega_k))$：\n$$U_{\\infty}(\\exp(\\mathrm{i}\\omega_k)) = \\left( Q(\\exp(\\mathrm{i}\\omega_k)) - 1 \\right) U_{\\infty}(\\exp(\\mathrm{i}\\omega_k)) + R(\\exp(\\mathrm{i}\\omega_k))$$\n$$U_{\\infty}(\\exp(\\mathrm{i}\\omega_k)) - \\left( Q(\\exp(\\mathrm{i}\\omega_k)) - 1 \\right) U_{\\infty}(\\exp(\\mathrm{i}\\omega_k)) = R(\\exp(\\mathrm{i}\\omega_k))$$\n$$U_{\\infty}(\\exp(\\mathrm{i}\\omega_k)) \\left( 1 - Q(\\exp(\\mathrm{i}\\omega_k)) + 1 \\right) = R(\\exp(\\mathrm{i}\\omega_k))$$\n$$U_{\\infty}(\\exp(\\mathrm{i}\\omega_k)) = \\frac{R(\\exp(\\mathrm{i}\\omega_k))}{2 - Q(\\exp(\\mathrm{i}\\omega_k))}$$\n现在，我们求解稳态误差频谱 $E_{\\infty}(\\exp(\\mathrm{i}\\omega_k))$：\n$$E_{\\infty}(\\exp(\\mathrm{i}\\omega_k)) = R(\\exp(\\mathrm{i}\\omega_k)) - U_{\\infty}(\\exp(\\mathrm{i}\\omega_k))$$\n$$E_{\\infty}(\\exp(\\mathrm{i}\\omega_k)) = R(\\exp(\\mathrm{i}\\omega_k)) - \\frac{R(\\exp(\\mathrm{i}\\omega_k))}{2 - Q(\\exp(\\mathrm{i}\\omega_k))}$$\n$$E_{\\infty}(\\exp(\\mathrm{i}\\omega_k)) = R(\\exp(\\mathrm{i}\\omega_k)) \\left( 1 - \\frac{1}{2 - Q(\\exp(\\mathrm{i}\\omega_k))} \\right)$$\n$$E_{\\infty}(\\exp(\\mathrm{i}\\omega_k)) = R(\\exp(\\mathrm{i}\\omega_k)) \\left( \\frac{2 - Q(\\exp(\\mathrm{i}\\omega_k)) - 1}{2 - Q(\\exp(\\mathrm{i}\\omega_k))} \\right)$$\n$$E_{\\infty}(\\exp(\\mathrm{i}\\omega_k)) = R(\\exp(\\mathrm{i}\\omega_k)) \\left( \\frac{1 - Q(\\exp(\\mathrm{i}\\omega_k))}{2 - Q(\\exp(\\mathrm{i}\\omega_k))} \\right)$$\n逐谐波衰减因子 $A_k$ 定义为稳态误差频谱与参考信号频谱的幅值之比：\n$$A_k = \\frac{|E_{\\infty}(\\exp(\\mathrm{i}\\omega_k))|}{|R(\\exp(\\mathrm{i}\\omega_k))|} = \\left| \\frac{1 - Q(\\exp(\\mathrm{i}\\omega_k))}{2 - Q(\\exp(\\mathrm{i}\\omega_k))} \\right|$$\n此表达式按要求将衰减量化为滤波器频率响应 $Q(\\exp(\\mathrm{i}\\omega_k))$ 的函数。\n\n接下来，我们代入具体的学习滤波器 $Q(z) = \\frac{1}{2} + \\frac{1}{4} z + \\frac{1}{4} z^{-1}$。其在 $\\omega_k$ 处的频率响应为：\n$$Q(\\exp(\\mathrm{i}\\omega_k)) = \\frac{1}{2} + \\frac{1}{4} \\exp(\\mathrm{i}\\omega_k) + \\frac{1}{4} \\exp(-\\mathrm{i}\\omega_k)$$\n使用欧拉公式 $\\cos(\\theta) = \\frac{\\exp(\\mathrm{i}\\theta) + \\exp(-\\mathrm{i}\\theta)}{2}$，我们得到：\n$$Q(\\exp(\\mathrm{i}\\omega_k)) = \\frac{1}{2} + \\frac{1}{2} \\cos(\\omega_k)$$\n由于 $\\omega_k$ 是实数频率，$\\cos(\\omega_k)$ 是实数且范围在 $-1$ 到 $1$ 之间。因此，$Q(\\exp(\\mathrm{i}\\omega_k))$ 是一个在 $[0, 1]$ 范围内的实数值。令 $Q_k = Q(\\exp(\\mathrm{i}\\omega_k))$。\n由于 $0 \\le Q_k \\le 1$，衰减表达式的分子 $1 - Q_k$ 是非负的（$0 \\le 1-Q_k \\le 1$）。分母 $2 - Q_k$ 是严格为正的（$1 \\le 2-Q_k \\le 2$）。因此，绝对值是不必要的：\n$$A_k = \\frac{1 - Q_k}{2 - Q_k} = \\frac{1 - \\left(\\frac{1}{2} + \\frac{1}{2}\\cos(\\omega_k)\\right)}{2 - \\left(\\frac{1}{2} + \\frac{1}{2}\\cos(\\omega_k)\\right)} = \\frac{\\frac{1}{2} - \\frac{1}{2}\\cos(\\omega_k)}{\\frac{3}{2} - \\frac{1}{2}\\cos(\\omega_k)} = \\frac{1 - \\cos(\\omega_k)}{3 - \\cos(\\omega_k)}$$\n为了获得更简化的形式，我们使用半角三角恒等式 $1 - \\cos(\\theta) = 2\\sin^{2}(\\theta/2)$。\n分子变为：\n$$1 - \\cos(\\omega_k) = 2\\sin^{2}\\left(\\frac{\\omega_k}{2}\\right)$$\n分母变为：\n$$3 - \\cos(\\omega_k) = 3 - \\left(1 - 2\\sin^{2}\\left(\\frac{\\omega_k}{2}\\right)\\right) = 2 + 2\\sin^{2}\\left(\\frac{\\omega_k}{2}\\right) = 2\\left(1 + \\sin^{2}\\left(\\frac{\\omega_k}{2}\\right)\\right)$$\n将这些代入 $A_k$ 的表达式中：\n$$A_k = \\frac{2\\sin^{2}\\left(\\frac{\\omega_k}{2}\\right)}{2\\left(1 + \\sin^{2}\\left(\\frac{\\omega_k}{2}\\right)\\right)} = \\frac{\\sin^{2}\\left(\\frac{\\omega_k}{2}\\right)}{1 + \\sin^{2}\\left(\\frac{\\omega_k}{2}\\right)}$$\n最后，我们代入 $\\omega_k = \\frac{2\\pi k}{N}$，得到 $\\frac{\\omega_k}{2} = \\frac{\\pi k}{N}$。衰减因子 $A_k$ 作为 $k$ 和 $N$ 的函数的最终表达式是：\n$$A_k = \\frac{\\sin^{2}\\left(\\frac{\\pi k}{N}\\right)}{1 + \\sin^{2}\\left(\\frac{\\pi k}{N}\\right)}$$\n这就是所要求的闭式表达式。", "answer": "$$\\boxed{\\frac{\\sin^{2}\\left(\\frac{\\pi k}{N}\\right)}{1 + \\sin^{2}\\left(\\frac{\\pi k}{N}\\right)}}$$", "id": "2714809"}, {"introduction": "现在，我们将视角从频域转换到时域的“提升系统”（lifted system）表示，这种模型在 ILC 的理论分析中至关重要。本练习旨在探讨确保误差在每次迭代中都单调递减的条件，这是一个比最终收敛更强的性能保证。通过分析基于不同范数（峰值误差 $\\ell_\\infty$ 与误差能量 $\\ell_2$）的收敛性，您将体会到如何根据不同的性能要求选择合适的分析工具和设计准则 [@problem_id:2714828]。", "problem": "考虑一个单输入单输出 (SISO) 迭代学习控制 (ILC) 设置，其作用于长度为 $N=2$ 的有限时域上。其提升输入输出映射由一个下三角托普利茨矩阵 $G \\in \\mathbb{R}^{2 \\times 2}$ 表示，该矩阵由被控对象的前两个马尔可夫参数构成。令\n$$\nG \\;=\\; \\begin{pmatrix} g_0 & 0 \\\n$$4pt] g_1 & g_0 \\end{pmatrix},\n$$\n其中 $g_0 = 0.8$ 且 $g_1 = 0.3$。ILC 学习更新为 $u_{k+1} = u_k + L e_k$，其中 $L \\in \\mathbb{R}^{2 \\times 2}$ 是学习滤波器，$u_k \\in \\mathbb{R}^2$ 是第 $k$ 次试验的输入，$e_k \\in \\mathbb{R}^2$ 是第 $k$ 次试验的跟踪误差。假设参考轨迹是可重复的，因此逐次试验的误差传播由以下提升线性映射给出\n$$\ne_{k+1} \\;=\\; \\left( I - G L \\right) e_k.\n$$\n你的任务是分析在 $\\ell_\\infty$ 意义下的单调收敛性，并将其与 $\\ell_2$ 意义下的收敛性进行对比，仅从诱导范数的定义和范数的基本性质出发。具体而言：\n\n1. 仅使用诱导向量范数的定义和次乘性，推导出一个关于 $L$ 的充分条件，以保证单调界\n$$\n\\| e_{k+1} \\|_\\infty \\;\\le\\; \\gamma \\, \\| e_k \\|_\\infty \\quad \\text{其中} \\quad \\gamma < 1,\n$$\n成立，该条件应使用 $I - G L$ 的诱导 $\\ell_\\infty$ 矩阵范数来表示。\n\n2. 将学习滤波器特化为标量增益形式 $L = \\alpha I$，其中 $\\alpha \\in \\mathbb{R}$。通过从第一性原理出发显式计算 $I - \\alpha G$ 的诱导 $\\ell_\\infty$ 范数，推导出保证 $\\| I - G L \\|_\\infty < 1$ 的关于 $\\alpha$ 的条件。\n\n3. 对于给定的数值 $g_0 = 0.8$ 和 $g_1 = 0.3$，确定上确界标量增益\n$$\n\\alpha_\\star \\;=\\; \\sup \\left\\{ \\alpha > 0 \\;:\\; \\| I - \\alpha G \\|_\\infty < 1 \\right\\}.\n$$\n将 $\\alpha_\\star$ 的最终答案以精确值形式报告（不要四舍五入）。\n\n4. 简要解释（无需计算数值）如何用诱导 $\\ell_2$ 范数来表述类似的 $\\ell_2$ 单调性条件，并说明为什么根据矩阵 $G$ 的不同，它可能比基于 $\\ell_\\infty$ 的条件更宽松或更保守。\n\n你的最终答案必须是 $\\alpha_\\star$ 的单个精确值，不带单位，也无需四舍五入说明。", "solution": "我们首先验证问题的有效性。问题陈述位于离散时间线性时不变系统的迭代学习控制 (ILC) 的标准理论框架内。所有组成部分——使用马尔可夫参数的托普利茨矩阵进行的提升系统表示、P型ILC更新律、由此产生的误差动态以及使用诱导矩阵范数进行的收敛性分析——都是该领域的经典概念。所提供的数值在物理上是合理的。问题是自洽的、无歧义的，并且在数学上是适定的。因此，该问题有效，我们可以着手求解。\n\n按照要求，问题分四部分解答。\n\n1. 逐次试验的误差传播动态由以下线性映射给出\n$$\ne_{k+1} \\;=\\; (I - G L) e_k.\n$$\n为了建立在 $\\ell_\\infty$ 范数下的单调收敛条件，我们对该方程两边取 $\\ell_\\infty$ 范数：\n$$\n\\| e_{k+1} \\|_\\infty \\;=\\; \\| (I - G L) e_k \\|_\\infty.\n$$\n根据诱导矩阵范数的定义，对于任意向量 $x$ 和矩阵 $A$，我们有不等式 $\\|Ax\\| \\le \\|A\\| \\|x\\|$。将此性质应用于我们的表达式可得\n$$\n\\| (I - G L) e_k \\|_\\infty \\;\\le\\; \\| I - G L \\|_\\infty \\| e_k \\|_\\infty.\n$$\n结合前面的步骤，我们得到界\n$$\n\\| e_{k+1} \\|_\\infty \\;\\le\\; \\| I - G L \\|_\\infty \\| e_k \\|_\\infty.\n$$\n问题要求找到一个条件，以保证对于某个常数 $\\gamma < 1$，有 $\\| e_{k+1} \\|_\\infty \\le \\gamma \\| e_k \\|_\\infty$。通过观察推导出的界，如果我们选择 $\\gamma = \\| I - G L \\|_\\infty$，则该条件得到满足。因此，在 $\\ell_\\infty$ 意义下单调收敛的充分条件是\n$$\n\\| I - G L \\|_\\infty < 1.\n$$\n\n2. 现在我们特化为标量学习增益的情况，$L = \\alpha I$，其中 $\\alpha \\in \\mathbb{R}$ 是一个标量，$I$ 是 $2 \\times 2$ 的单位矩阵。收敛条件变为 $\\| I - \\alpha G \\|_\\infty < 1$。我们来计算矩阵 $I - \\alpha G$：\n$$\nI - \\alpha G \\;=\\; \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\alpha \\begin{pmatrix} g_0 & 0 \\\\ g_1 & g_0 \\end{pmatrix} \\;=\\; \\begin{pmatrix} 1 - \\alpha g_0 & 0 \\\\ -\\alpha g_1 & 1 - \\alpha g_0 \\end{pmatrix}.\n$$\n诱导 $\\ell_\\infty$ 矩阵范数，也称为最大绝对行和范数，对于矩阵 $A$ 定义为 $\\|A\\|_\\infty = \\max_{i} \\sum_{j} |A_{ij}|$。我们将此定义应用于矩阵 $I - \\alpha G$。\n第一行元素的绝对值之和为：\n$$\n|1 - \\alpha g_0| + |0| \\;=\\; |1 - \\alpha g_0|.\n$$\n第二行元素的绝对值之和为：\n$$\n|-\\alpha g_1| + |1 - \\alpha g_0| \\;=\\; |\\alpha| |g_1| + |1 - \\alpha g_0|.\n$$\n$\\ell_\\infty$ 范数是这两个行和中的最大值：\n$$\n\\|I - \\alpha G\\|_\\infty \\;=\\; \\max \\left( |1 - \\alpha g_0|, \\;\\; |\\alpha| |g_1| + |1 - \\alpha g_0| \\right).\n$$\n由于 $|\\alpha| |g_1| \\ge 0$，第二项总是大于或等于第一项。因此，最大值总是由第二行的行和给出：\n$$\n\\|I - \\alpha G\\|_\\infty \\;=\\; |1 - \\alpha g_0| + |\\alpha| |g_1|.\n$$\n因此，单调收敛的条件是 $|1 - \\alpha g_0| + |\\alpha| |g_1| < 1$。\n\n3. 我们需要对给定的值 $g_0 = 0.8$ 和 $g_1 = 0.3$ 求解 $\\alpha_\\star = \\sup \\{ \\alpha > 0 : \\| I - \\alpha G \\|_\\infty < 1 \\}$。由于我们寻找 $\\alpha > 0$，表达式 $|\\alpha|$ 可简化为 $\\alpha$。收敛条件变为：\n$$\n|1 - 0.8 \\alpha| + 0.3 \\alpha < 1.\n$$\n为求解此不等式，我们必须通过考虑其参数 $1 - 0.8 \\alpha$ 的符号来处理绝对值。当 $0.8 \\alpha = 1$ 时，该项为零，对应于 $\\alpha = 1 / 0.8 = 1.25$。我们分析 $\\alpha > 0$ 的两种情况。\n情况1：$0 < \\alpha \\le 1.25$。\n在此区间内，$1 - 0.8 \\alpha \\ge 0$，所以 $|1 - 0.8 \\alpha| = 1 - 0.8 \\alpha$。不等式为：\n$$\n(1 - 0.8 \\alpha) + 0.3 \\alpha < 1\n$$\n$$\n1 - 0.5 \\alpha < 1\n$$\n$$\n-0.5 \\alpha < 0\n$$\n这意味着 $\\alpha > 0$。此情况的解是定义域 $0 < \\alpha \\le 1.25$ 与结果 $\\alpha > 0$ 的交集，即区间 $(0, 1.25]$。\n\n情况2：$\\alpha > 1.25$。\n在此区间内，$1 - 0.8 \\alpha < 0$，所以 $|1 - 0.8 \\alpha| = -(1 - 0.8 \\alpha) = 0.8 \\alpha - 1$。不等式为：\n$$\n(0.8 \\alpha - 1) + 0.3 \\alpha < 1\n$$\n$$\n1.1 \\alpha - 1 < 1\n$$\n$$\n1.1 \\alpha < 2\n$$\n这意味着 $\\alpha < \\frac{2}{1.1} = \\frac{20}{11}$。此情况的解是定义域 $\\alpha > 1.25$ 与结果 $\\alpha < 20/11$ 的交集。注意到 $1.25 = 5/4$ 且 $20/11 \\approx 1.818$，所以 $1.25 < 20/11$。该区间是 $(1.25, 20/11)$。\n\n综合两种情况的结果，满足收敛条件的所有正 $\\alpha$ 的集合是 $(0, 1.25]$ 和 $(1.25, 20/11)$ 的并集，即开区间 $(0, 20/11)$。\n该集合的上确界是区间的上界。因此，\n$$\n\\alpha_\\star \\;=\\; \\sup \\left( 0, \\frac{20}{11} \\right) \\;=\\; \\frac{20}{11}.\n$$\n\n4. 在 $\\ell_2$ 意义下单调收敛的类似条件是 $\\| I - G L \\|_2 < 1$，其中 $\\| \\cdot \\|_2$ 表示诱导矩阵 $2$-范数（即谱范数）。对于 $L = \\alpha I$，这变为 $\\| I - \\alpha G \\|_2 < 1$。一个矩阵 $A$ 的诱导 $2$-范数是其最大奇异值 $\\sigma_{\\max}(A)$，也就是 $A^T A$ 最大特征值的平方根。因此，该条件为 $\\sigma_{\\max}(I - \\alpha G) < 1$。\n\n$\\ell_\\infty$ 和 $\\ell_2$ 条件的相对保守性取决于具体的矩阵 $G$。对于任意矩阵 $A \\in \\mathbb{R}^{n \\times n}$，诱导范数之间通过不等式关联，例如 $\\|A\\|_2 \\le \\sqrt{n} \\|A\\|_\\infty$ 和 $\\|A\\|_\\infty \\le \\sqrt{n} \\|A\\|_2$，但 $\\|A\\|_2$ 和 $\\|A\\|_\\infty$ 之间没有普适的大小排序关系。根据 $A$ 的结构，一个范数可以大于、小于或等于另一个。因此，对于给定的 $G$ 和 $\\alpha$，可能存在 $\\|I - \\alpha G\\|_\\infty < 1$ 但 $\\|I - \\alpha G\\|_2 \\ge 1$ 的情况，这意味着对于该 $\\alpha$，$\\ell_2$ 条件更为保守。反之，也可能存在 $\\|I - \\alpha G\\|_2 < 1$ 但 $\\|I - \\alpha G\\|_\\infty \\ge 1$ 的情况，这意味着 $\\ell_\\infty$ 条件更为保守。范数的选择决定了保证单调收敛的增益 $\\alpha$ 集合的形状和大小，$\\ell_2$ 和 $\\ell_\\infty$ 条件均不普遍比对方更宽松。其比较完全取决于矩阵 $I - \\alpha G$ 的数值属性。", "answer": "$$\n\\boxed{\\frac{20}{11}}\n$$", "id": "2714828"}]}