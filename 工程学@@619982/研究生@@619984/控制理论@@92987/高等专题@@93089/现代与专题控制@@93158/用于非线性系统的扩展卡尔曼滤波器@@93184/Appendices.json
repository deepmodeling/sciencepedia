{"hands_on_practices": [{"introduction": "在将扩展卡尔曼滤波器应用于许多由微分方程描述的物理系统之前，首要步骤是将连续时间动态模型转换为离散时间形式。本练习将指导您完成这一关键过程，包括对非线性动态进行线性化，并使用前向欧拉法近似离散时间状态转移矩阵 $F_d$ 和过程噪声协方差 $Q_d$。通过这个实践，您将掌握在 EKF 预测步骤中处理连续时间模型的必要技能。[@problem_id:2705962]", "problem": "考虑一个用于非线性系统扩展卡尔曼滤波器 (Extended Kalman Filter, EKF) 的连续时间非线性系统，由下式给出\n$$\n\\dot{x}(t) = f(x(t)) + L\\,w(t), \\quad f(x) \\triangleq \\begin{bmatrix} x_2 \\\\ -\\omega^{2}\\,\\sin(x_1) \\end{bmatrix},\n$$\n其中 $x(t) \\in \\mathbb{R}^{2}$，$x_1$ 是一个以弧度为单位的角度，$\\omega \\in \\mathbb{R}_{>0}$，$L \\in \\mathbb{R}^{2\\times 1}$，且 $w(t)$ 是零均值高斯白过程噪声，其连续时间谱密度为 $Q_c \\in \\mathbb{R}$ (一个标量)。假设 $L = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$ 且 $\\omega = 1$。EKF 通过雅可比矩阵 $F(\\mu) \\triangleq \\left.\\frac{\\partial f}{\\partial x}\\right|_{x=\\mu}$ 对漂移项 $f(x)$ 在均值状态 $\\mu \\in \\mathbb{R}^{2}$ 附近进行线性化。对于一个小的采样间隔 $\\Delta t$，对线性化后的动力学采用一阶前向欧拉离散化，并在扩散项上采用零阶保持，对离散过程噪声协方差进行一阶近似。\n\n设数值为 $\\mu = \\begin{bmatrix} \\pi/6 \\\\ 1/2 \\end{bmatrix}$，$Q_c = q = 1/5$ 且 $\\Delta t = 0.05$。计算 $F(\\mu)$，然后根据上述建模假设，求出状态转移矩阵和过程噪声协方差的一阶离散时间近似值，分别记为 $F_d$ 和 $Q_d$。最后，计算标量\n$$\ns \\triangleq \\operatorname{tr}(F_d) + [Q_d]_{22}.\n$$\n给出 $s$ 的最终结果，要求为精确值，不进行四舍五入，不带单位。角度以弧度为单位。不要报告任何中间矩阵；仅报告 $s$ 的最终值。", "solution": "所给问题具有科学依据，提法恰当，客观，并包含了解决该问题所需的所有信息。这是一个为应用扩展卡尔曼滤波器而对连续时间非线性系统进行离散化的标准练习。我们开始求解。\n\n问题要求计算一个标量值 $s \\triangleq \\operatorname{tr}(F_d) + [Q_d]_{22}$，其中 $F_d$ 和 $Q_d$ 分别是离散时间状态转移矩阵和过程噪声协方差。这些都是从一个连续时间非线性系统模型推导出来的。\n\n连续时间动力学由 $\\dot{x}(t) = f(x(t)) + L\\,w(t)$ 给出，其漂移函数定义为：\n$$\nf(x) = \\begin{bmatrix} x_2 \\\\ -\\omega^{2}\\,\\sin(x_1) \\end{bmatrix}\n$$\n问题指定了值 $\\omega=1$ 和 $L = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$。因此，漂移函数简化为：\n$$\nf(x) = \\begin{bmatrix} x_2 \\\\ -\\sin(x_1) \\end{bmatrix}\n$$\n\n第一步是围绕给定的均值状态 $\\mu = \\begin{bmatrix} \\pi/6 \\\\ 1/2 \\end{bmatrix}$ 对该漂移函数进行线性化。这是通过计算雅可比矩阵 $F(\\mu) \\triangleq \\left.\\frac{\\partial f}{\\partial x}\\right|_{x=\\mu}$ 来完成的。$f(x)$ 各分量的偏导数是：\n$$\n\\frac{\\partial f_1}{\\partial x_1} = \\frac{\\partial}{\\partial x_1}(x_2) = 0\n$$\n$$\n\\frac{\\partial f_1}{\\partial x_2} = \\frac{\\partial}{\\partial x_2}(x_2) = 1\n$$\n$$\n\\frac{\\partial f_2}{\\partial x_1} = \\frac{\\partial}{\\partial x_1}(-\\sin(x_1)) = -\\cos(x_1)\n$$\n$$\n\\frac{\\partial f_2}{\\partial x_2} = \\frac{\\partial}{\\partial x_2}(-\\sin(x_1)) = 0\n$$\n将这些偏导数组合成雅可比矩阵，得到：\n$$\nF(x) = \\frac{\\partial f}{\\partial x} = \\begin{bmatrix} 0 & 1 \\\\ -\\cos(x_1) & 0 \\end{bmatrix}\n$$\n我们在点 $x = \\mu = \\begin{bmatrix} \\pi/6 \\\\ 1/2 \\end{bmatrix}$ 处计算该矩阵的值：\n$$\nF(\\mu) = \\begin{bmatrix} 0 & 1 \\\\ -\\cos(\\pi/6) & 0 \\end{bmatrix} = \\begin{bmatrix} 0 & 1 \\\\ -\\frac{\\sqrt{3}}{2} & 0 \\end{bmatrix}\n$$\n\n第二步是求离散时间状态转移矩阵 $F_d$。问题指定了在采样间隔 $\\Delta t = 0.05$ 上对线性化动力学进行一阶前向欧拉离散化。其公式为 $F_d \\approx I + \\Delta t F(\\mu)$，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n代入值 $\\Delta t = 0.05 = \\frac{1}{20}$ 和计算出的 $F(\\mu)$：\n$$\nF_d = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} + \\frac{1}{20} \\begin{bmatrix} 0 & 1 \\\\ -\\frac{\\sqrt{3}}{2} & 0 \\end{bmatrix} = \\begin{bmatrix} 1 & \\frac{1}{20} \\\\ -\\frac{\\sqrt{3}}{40} & 1 \\end{bmatrix}\n$$\n\n第三步是计算离散时间过程噪声协方差矩阵 $Q_d$。问题要求一个与过程噪声扩散项上的零阶保持一致的一阶近似。对于一个具有过程噪声输入矩阵 $L$ 和谱密度 $Q_c$ 的连续时间系统，针对小 $\\Delta t$ 的最简单和最常用的一阶近似是：\n$$\nQ_d \\approx (L Q_c L^T) \\Delta t\n$$\n我们已知 $L = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$，$Q_c = q = 1/5$ 且 $\\Delta t = 0.05 = \\frac{1}{20}$。\n首先，我们计算连续时间协方差矩阵项 $L Q_c L^T$：\n$$\nL Q_c L^T = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} \\left(\\frac{1}{5}\\right) \\begin{bmatrix} 0 & 1 \\end{bmatrix} = \\frac{1}{5} \\begin{bmatrix} 0 \\cdot 0 & 0 \\cdot 1 \\\\ 1 \\cdot 0 & 1 \\cdot 1 \\end{bmatrix} = \\begin{bmatrix} 0 & 0 \\\\ 0 & \\frac{1}{5} \\end{bmatrix}\n$$\n现在，我们乘以 $\\Delta t$ 来得到 $Q_d$：\n$$\nQ_d = \\begin{bmatrix} 0 & 0 \\\\ 0 & \\frac{1}{5} \\end{bmatrix} \\cdot \\left(\\frac{1}{20}\\right) = \\begin{bmatrix} 0 & 0 \\\\ 0 & \\frac{1}{100} \\end{bmatrix}\n$$\n\n最后一步是计算标量 $s = \\operatorname{tr}(F_d) + [Q_d]_{22}$。\n$F_d$ 的迹是其对角线元素之和：\n$$\n\\operatorname{tr}(F_d) = 1 + 1 = 2\n$$\n$Q_d$ 的第二行第二列的元素，记为 $[Q_d]_{22}$，是：\n$$\n[Q_d]_{22} = \\frac{1}{100}\n$$\n将这两个值相加，得到 $s$ 的最终结果：\n$$\ns = 2 + \\frac{1}{100} = \\frac{200}{100} + \\frac{1}{100} = \\frac{201}{100}\n$$\n用小数表示为 $2.01$。该值为精确值。", "answer": "$$\\boxed{\\frac{201}{100}}$$", "id": "2705962"}, {"introduction": "扩展卡尔曼滤波器的核心在于其测量更新步骤，该步骤通过线性化将新息融入状态估计。本练习提供了一个具体实例，让您为一个非线性的纯方位角传感器模型执行完整的测量更新计算。您将从第一性原理出发，推导并计算雅可比矩阵 $H_k$、新息协方差 $S_k$、卡尔曼增益 $K_k$，并最终更新状态均值 $\\mu_k$ 和协方差 $P_k$。[@problem_id:2705967]", "problem": "考虑一个平面纯方位传感器，它测量状态为 $x_k = \\begin{bmatrix}x_{1,k} & x_{2,k}\\end{bmatrix}^{\\top}$ 的目标相对于位于原点的传感器的方位角。测量模型是由 $h(x) = \\arctan\\!\\big(x_2/x_1\\big)$ 给出的非线性函数 $h:\\mathbb{R}^2 \\to \\mathbb{R}$，其中角度单位为弧度。假设存在加性零均值高斯测量噪声，其协方差为 $R = 0.01$。在时刻 $k$，一个扩展卡尔曼滤波器 (EKF) 使用单个标量测量值 $y_k = 0.3$ 弧度、预测状态均值 $\\mu_k^{-} = \\begin{bmatrix}1.0 & 0.5\\end{bmatrix}^{\\top}$ 和预测协方差\n$$\nP_k^{-} = \\begin{bmatrix} 0.1 & 0.02 \\\\ 0.02 & 0.05 \\end{bmatrix}\n$$\n来执行测量更新。\n从EKF的核心定义出发，即EKF在预测均值附近将测量模型线性化，并将线性卡尔曼滤波器更新应用于线性化后的模型，完成以下任务：\n1) 从第一性原理推导测量雅可比矩阵 $H_k = \\left.\\dfrac{\\partial h}{\\partial x}\\right|_{x=\\mu_k^{-}}$，并在 $\\mu_k^{-}$ 处计算其值。\n2) 使用线性化贝叶斯更新的第一性原理，计算新息协方差 $S_k$、卡尔曼增益 $K_k$、更新后均值 $\\mu_k$ 和更新后协方差 $P_k$。您可以使用任何保持半正定性的协方差更新的代数等价形式。\n尽可能精确地表达所有中间量（例如，使用有理数和基本常数），并保持角度单位为弧度。作为最终答案，仅报告更新后均值的第一个分量，即 $\\mu_k$ 的第一个元素，以单个无数值舍入的闭式解析表达式的形式给出。", "solution": "所述问题在科学上是合理的、内容自洽且数学上适定。它为执行扩展卡尔曼滤波器的单步测量更新提供了所有必要组件。我们将从第一性原理出发进行推导和计算。\n\n状态向量为 $x_k = \\begin{bmatrix} x_{1,k} & x_{2,k} \\end{bmatrix}^{\\top}$。非线性测量函数为 $h(x) = \\arctan(x_2/x_1)$。为了执行EKF更新，我们必须在预测状态均值 $\\mu_k^{-} = \\begin{bmatrix}1.0 & 0.5\\end{bmatrix}^{\\top}$ 处将此函数线性化。\n\n**1) 测量雅可比矩阵 $H_k$**\n\n测量雅可比矩阵 $H$ 是测量函数 $h(x)$ 的一阶偏导数矩阵。对于向量 $x = \\begin{bmatrix} x_1 & x_2 \\end{bmatrix}^{\\top}$ 的标量函数，雅可比矩阵是一个行向量。\n\n$h(x)$ 对 $x_1$ 的偏导数为：\n$$\n\\frac{\\partial h}{\\partial x_1} = \\frac{\\partial}{\\partial x_1} \\left( \\arctan\\left(\\frac{x_2}{x_1}\\right) \\right) = \\frac{1}{1 + \\left(\\frac{x_2}{x_1}\\right)^2} \\cdot \\left(-\\frac{x_2}{x_1^2}\\right) = \\frac{-x_2}{x_1^2 + x_2^2}\n$$\n$h(x)$ 对 $x_2$ 的偏导数为：\n$$\n\\frac{\\partial h}{\\partial x_2} = \\frac{\\partial}{\\partial x_2} \\left( \\arctan\\left(\\frac{x_2}{x_1}\\right) \\right) = \\frac{1}{1 + \\left(\\frac{x_2}{x_1}\\right)^2} \\cdot \\left(\\frac{1}{x_1}\\right) = \\frac{x_1}{x_1^2 + x_2^2}\n$$\n因此，雅可比矩阵为行向量：\n$$\nH(x) = \\frac{\\partial h}{\\partial x} = \\begin{bmatrix} \\frac{-x_2}{x_1^2 + x_2^2} & \\frac{x_1}{x_1^2 + x_2^2} \\end{bmatrix}\n$$\n我们在预测均值 $\\mu_k^{-} = \\begin{bmatrix} 1 \\\\ 0.5 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ \\frac{1}{2} \\end{bmatrix}$ 处计算该雅可比矩阵。设 $\\mu_k^{-} = \\begin{bmatrix} \\mu_1^{-} & \\mu_2^{-} \\end{bmatrix}^{\\top}$。\n分母为 $(\\mu_1^{-})^2 + (\\mu_2^{-})^2 = 1^2 + (\\frac{1}{2})^2 = 1 + \\frac{1}{4} = \\frac{5}{4}$。\n雅可比矩阵 $H_k = H(\\mu_k^{-})$ 的分量为：\n$$\n\\frac{\\partial h}{\\partial x_1}\\bigg|_{x=\\mu_k^{-}} = \\frac{-\\mu_2^{-}}{(\\mu_1^{-})^2 + (\\mu_2^{-})^2} = \\frac{-1/2}{5/4} = -\\frac{1}{2} \\cdot \\frac{4}{5} = -\\frac{2}{5}\n$$\n$$\n\\frac{\\partial h}{\\partial x_2}\\bigg|_{x=\\mu_k^{-}} = \\frac{\\mu_1^{-}}{(\\mu_1^{-})^2 + (\\mu_2^{-})^2} = \\frac{1}{5/4} = \\frac{4}{5}\n$$\n所以，计算出的测量雅可比矩阵为：\n$$\nH_k = \\begin{bmatrix} -\\frac{2}{5} & \\frac{4}{5} \\end{bmatrix}\n$$\n\n**2) EKF 测量更新**\n\nEKF 测量更新的均值和协方差方程为：\n$$\n\\mu_k = \\mu_k^{-} + K_k (y_k - h(\\mu_k^{-}))\n$$\n$$\nP_k = (I - K_k H_k) P_k^{-}\n$$\n其中 $K_k$ 是卡尔曼增益，定义为：\n$$\nK_k = P_k^{-} H_k^{\\top} S_k^{-1}\n$$\n$S_k$ 是新息协方差：\n$$\nS_k = H_k P_k^{-} H_k^{\\top} + R\n$$\n给定以下量，为确保精度，我们用有理数表示：\n$$\n\\mu_k^{-} = \\begin{bmatrix} 1 \\\\ \\frac{1}{2} \\end{bmatrix}, \\quad P_k^{-} = \\begin{bmatrix} \\frac{1}{10} & \\frac{1}{50} \\\\ \\frac{1}{50} & \\frac{1}{20} \\end{bmatrix}, \\quad y_k = \\frac{3}{10}, \\quad R = \\frac{1}{100}\n$$\n\n首先，我们计算**新息协方差 $S_k$**。\n$$\nH_k P_k^{-} = \\begin{bmatrix} -\\frac{2}{5} & \\frac{4}{5} \\end{bmatrix} \\begin{bmatrix} \\frac{1}{10} & \\frac{1}{50} \\\\ \\frac{1}{50} & \\frac{1}{20} \\end{bmatrix} = \\begin{bmatrix} -\\frac{2}{50}+\\frac{4}{250} & -\\frac{2}{250}+\\frac{4}{100} \\end{bmatrix} = \\begin{bmatrix} -\\frac{10}{250}+\\frac{4}{250} & -\\frac{2}{250}+\\frac{10}{250} \\end{bmatrix} = \\begin{bmatrix} -\\frac{6}{250} & \\frac{8}{250} \\end{bmatrix} = \\begin{bmatrix} -\\frac{3}{125} & \\frac{4}{125} \\end{bmatrix}\n$$\n$$\nH_k P_k^{-} H_k^{\\top} = \\begin{bmatrix} -\\frac{3}{125} & \\frac{4}{125} \\end{bmatrix} \\begin{bmatrix} -\\frac{2}{5} \\\\ \\frac{4}{5} \\end{bmatrix} = \\frac{6}{625} + \\frac{16}{625} = \\frac{22}{625}\n$$\n$$\nS_k = \\frac{22}{625} + R = \\frac{22}{625} + \\frac{1}{100} = \\frac{88}{2500} + \\frac{25}{2500} = \\frac{113}{2500}\n$$\n\n接下来，我们计算**卡尔曼增益 $K_k$**。\n$$\nP_k^{-} H_k^{\\top} = \\begin{bmatrix} \\frac{1}{10} & \\frac{1}{50} \\\\ \\frac{1}{50} & \\frac{1}{20} \\end{bmatrix} \\begin{bmatrix} -\\frac{2}{5} \\\\ \\frac{4}{5} \\end{bmatrix} = \\begin{bmatrix} -\\frac{2}{50} + \\frac{4}{250} \\\\ -\\frac{2}{250} + \\frac{4}{100} \\end{bmatrix} = \\begin{bmatrix} -\\frac{6}{250} \\\\ \\frac{8}{250} \\end{bmatrix} = \\begin{bmatrix} -\\frac{3}{125} \\\\ \\frac{4}{125} \\end{bmatrix}\n$$\n$$\nK_k = P_k^{-} H_k^{\\top} S_k^{-1} = \\begin{bmatrix} -\\frac{3}{125} \\\\ \\frac{4}{125} \\end{bmatrix} \\left(\\frac{2500}{113}\\right) = \\begin{bmatrix} -\\frac{3 \\cdot 20}{113} \\\\ \\frac{4 \\cdot 20}{113} \\end{bmatrix} = \\begin{bmatrix} -\\frac{60}{113} \\\\ \\frac{80}{113} \\end{bmatrix}\n$$\n\n现在，我们计算**更新后均值 $\\mu_k$**。\n新息（或残差）为 $\\tilde{y}_k = y_k - h(\\mu_k^{-})$。\n预测测量值为 $h(\\mu_k^{-}) = \\arctan(\\frac{1/2}{1}) = \\arctan(\\frac{1}{2})$。\n新息为 $\\tilde{y}_k = \\frac{3}{10} - \\arctan(\\frac{1}{2})$。\n$$\n\\mu_k = \\mu_k^{-} + K_k \\tilde{y}_k = \\begin{bmatrix} 1 \\\\ \\frac{1}{2} \\end{bmatrix} + \\begin{bmatrix} -\\frac{60}{113} \\\\ \\frac{80}{113} \\end{bmatrix} \\left(\\frac{3}{10} - \\arctan\\left(\\frac{1}{2}\\right)\\right)\n$$\n更新后均值的第一个分量 $\\mu_{1,k}$ 为：\n$$\n\\mu_{1,k} = 1 - \\frac{60}{113} \\left(\\frac{3}{10} - \\arctan\\left(\\frac{1}{2}\\right)\\right) = 1 - \\frac{18}{113} + \\frac{60}{113}\\arctan\\left(\\frac{1}{2}\\right) = \\frac{113-18}{113} + \\frac{60}{113}\\arctan\\left(\\frac{1}{2}\\right)\n$$\n$$\n\\mu_{1,k} = \\frac{95}{113} + \\frac{60}{113}\\arctan\\left(\\frac{1}{2}\\right) = \\frac{95 + 60 \\arctan(\\frac{1}{2})}{113}\n$$\n第二个分量是 $\\mu_{2,k} = \\frac{1}{2} + \\frac{80}{113} (\\frac{3}{10} - \\arctan(\\frac{1}{2})) = \\frac{1}{2} + \\frac{24}{113} - \\frac{80}{113}\\arctan(\\frac{1}{2}) = \\frac{113+48}{226} - \\frac{80}{113}\\arctan(\\frac{1}{2}) = \\frac{161}{226} - \\frac{80}{113}\\arctan(\\frac{1}{2})$。\n更新后的状态均值为 $\\mu_k = \\begin{bmatrix} \\frac{95 + 60 \\arctan(\\frac{1}{2})}{113} \\\\ \\frac{161 - 160 \\arctan(\\frac{1}{2})}{226} \\end{bmatrix}$。\n\n最后，我们计算**更新后协方差 $P_k$**。\n$$\nK_k H_k = \\begin{bmatrix} -\\frac{60}{113} \\\\ \\frac{80}{113} \\end{bmatrix} \\begin{bmatrix} -\\frac{2}{5} & \\frac{4}{5} \\end{bmatrix} = \\frac{1}{113} \\begin{bmatrix} (-60)(-\\frac{2}{5}) & (-60)(\\frac{4}{5}) \\\\ (80)(-\\frac{2}{5}) & (80)(\\frac{4}{5}) \\end{bmatrix} = \\frac{1}{113} \\begin{bmatrix} 24 & -48 \\\\ -32 & 64 \\end{bmatrix}\n$$\n$$\nI - K_k H_k = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} - \\frac{1}{113}\\begin{bmatrix} 24 & -48 \\\\ -32 & 64 \\end{bmatrix} = \\frac{1}{113} \\begin{bmatrix} 113-24 & 48 \\\\ 32 & 113-64 \\end{bmatrix} = \\frac{1}{113} \\begin{bmatrix} 89 & 48 \\\\ 32 & 49 \\end{bmatrix}\n$$\n$$\nP_k = (I - K_k H_k) P_k^{-} = \\frac{1}{113} \\begin{bmatrix} 89 & 48 \\\\ 32 & 49 \\end{bmatrix} \\begin{bmatrix} \\frac{1}{10} & \\frac{1}{50} \\\\ \\frac{1}{50} & \\frac{1}{20} \\end{bmatrix} = \\frac{1}{11300} \\begin{bmatrix} 89 & 48 \\\\ 32 & 49 \\end{bmatrix} \\begin{bmatrix} 10 & 2 \\\\ 2 & 5 \\end{bmatrix}\n$$\n$$\nP_k = \\frac{1}{11300} \\begin{bmatrix} 890+96 & 178+240 \\\\ 320+98 & 64+245 \\end{bmatrix} = \\frac{1}{11300} \\begin{bmatrix} 986 & 418 \\\\ 418 & 309 \\end{bmatrix}\n$$\n至此，所有要求的计算均已完成。题目要求的最终答案是更新后均值的第一个分量 $\\mu_{1,k}$。", "answer": "$$\n\\boxed{\\frac{95 + 60 \\arctan\\left(\\frac{1}{2}\\right)}{113}}\n$$", "id": "2705967"}, {"introduction": "理论与实践的结合是成功实现卡尔曼滤波器的关键，而滤波器调优正是这一结合的体现。本练习探讨了一个核心的诊断与调优技术：通过分析新息序列的统计特性来调整噪声协方差参数。您将推导理论新息方差 $S_k$ 的表达式，并将其与给定的经验方差 $\\hat{S}$ 进行比较，以计算出调整测量噪声方差 $R$ 所需的量。[@problem_id:2706005]", "problem": "考虑一个标量扩展卡尔曼滤波器（EKF），其离散时间非线性测量模型形式为 $y_{k} = h(x_{k}) + v_{k}$，其中 $v_{k}$ 是均值为零、方差为 $R_{k}$ 的白测量噪声。EKF 对测量函数在预测状态估计 $\\hat{x}_{k}^{-}$ 处采用一阶线性化，其雅可比矩阵为 $H_{k} := \\left.\\frac{\\partial h}{\\partial x}\\right|_{\\hat{x}_{k}^{-}}$。测量更新前的预测状态误差协方差为 $P_{k}^{-} := \\mathbb{E}\\left[(x_{k} - \\hat{x}_{k}^{-})^2\\right]$，在标量情况下，它是一个非负实数。假设在工作点处的线性化误差可以忽略不计，并且状态预测误差 $x_{k} - \\hat{x}_{k}^{-}$ 与测量噪声 $v_{k}$ 不相关。\n\n将新息定义为 $\\tilde{y}_{k} := y_{k} - h(\\hat{x}_{k}^{-})$。从测量模型出发，使用基本原理将标量新息方差 $S_{k} := \\mathbb{E}\\left[\\tilde{y}_{k}^{2}\\right]$ 用 $H_{k}$、$P_{k}^{-}$ 和 $R_{k}$ 表示。\n\n假设在一个足够长的窗口内，测量得到的新息经验方差为 $\\hat{S} = 0.5$。EKF 使用其当前的调优参数 $R_{\\text{old}}$，预测的新息方差为 $S_{\\text{old}} = 0.2$。你的任务是只重新调整测量噪声方差，同时保持 $H_{k}$ 和 $P_{k}^{-}$ 不变，使得预测的新息方差与经验值 $\\hat{S}$ 相匹配。\n\n计算在 $H_{k}$ 和 $P_{k}^{-}$ 保持固定的情况下，为实现 $S_{k} = \\hat{S}$ 所需的加性调整量 $\\Delta R := R_{\\text{new}} - R_{\\text{old}}$。将你的最终答案表示为一个实数。无需四舍五入。", "solution": "该问题要求推导标量扩展卡尔曼滤波器（EKF）的新息方差，并随后计算测量噪声方差的调整量。首先对问题陈述进行验证。\n\n**问题验证**\n\n步骤1：提取已知条件\n- 测量模型：$y_{k} = h(x_{k}) + v_{k}$ (标量)\n- 测量噪声 $v_{k}$：零均值、白噪声，方差为 $R_k = \\mathbb{E}[v_k^2]$。\n- 测量函数的雅可比矩阵：$H_{k} := \\left.\\frac{\\partial h}{\\partial x}\\right|_{\\hat{x}_{k}^{-}}$。\n- 预测状态误差协方差（先验）：$P_{k}^{-} := \\mathbb{E}\\left[(x_{k} - \\hat{x}_{k}^{-})^{2}\\right]$。\n- 新息：$\\tilde{y}_{k} := y_{k} - h(\\hat{x}_{k}^{-})$。\n- 新息方差：$S_{k} := \\mathbb{E}\\left[\\tilde{y}_{k}^{2}\\right]$。\n- 假设1：线性化误差可忽略不计。\n- 假设2：状态预测误差 $(x_{k} - \\hat{x}_{k}^{-})$ 与测量噪声 $v_{k}$ 不相关。\n- 经验新息方差：$\\hat{S} = 0.5$。\n- 旧的预测新息方差：$S_{\\text{old}} = 0.2$。\n- 旧的测量噪声方差：$R_{\\text{old}}$。\n- 新的测量噪声方差：$R_{\\text{new}}$。\n- 待计算的调整量：$\\Delta R := R_{\\text{new}} - R_{\\text{old}}$。\n- 约束：在重新调优期间 $H_{k}$ 和 $P_{k}^{-}$ 保持不变。\n\n步骤2：使用提取的已知条件进行验证\n该问题在控制理论和状态估计方面有科学依据，特别是关于扩展卡尔曼滤波器的分析和调优。这是一个适定问题，提供了明确的目标和足够的数据以得出唯一解。语言精确客观。所有假设都明确陈述，并且在 EKF 分析的背景下是标准的。该问题不违反任何基本原理，不是不完整的，也不包含矛盾信息。基于经验新息统计数据来调整滤波器参数的场景是一种标准的工程实践。\n\n步骤3：结论与行动\n问题被认为是有效的。将提供解答。\n\n**新息方差的推导**\n\n第一个任务是推导新息方差 $S_k$ 的表达式。我们从新息 $\\tilde{y}_k$ 的定义开始：\n$$\n\\tilde{y}_{k} = y_{k} - h(\\hat{x}_{k}^{-})\n$$\n代入测量模型 $y_{k} = h(x_{k}) + v_{k}$：\n$$\n\\tilde{y}_{k} = (h(x_{k}) + v_{k}) - h(\\hat{x}_{k}^{-}) = h(x_{k}) - h(\\hat{x}_{k}^{-}) + v_{k}\n$$\n问题陈述指出，EKF 对 $h(x)$ 在预测状态估计 $\\hat{x}_k^-$ 附近使用一阶线性化。我们对 $h(x_k)$ 在 $\\hat{x}_k^-$ 处进行泰勒级数展开：\n$$\nh(x_{k}) = h(\\hat{x}_{k}^{-}) + \\left.\\frac{\\partial h}{\\partial x}\\right|_{\\hat{x}_{k}^{-}}(x_{k} - \\hat{x}_{k}^{-}) + \\text{高阶项}\n$$\n根据定义，雅可比矩阵为 $H_{k} = \\left.\\frac{\\partial h}{\\partial x}\\right|_{\\hat{x}_{k}^{-}}$。问题允许我们忽略线性化误差，因此高阶项被忽略。近似式为：\n$$\nh(x_{k}) \\approx h(\\hat{x}_{k}^{-}) + H_{k}(x_{k} - \\hat{x}_{k}^{-})\n$$\n将此近似式代入新息的表达式中，得到：\n$$\n\\tilde{y}_{k} \\approx [h(\\hat{x}_{k}^{-}) + H_{k}(x_{k} - \\hat{x}_{k}^{-})] - h(\\hat{x}_{k}^{-}) + v_{k}\n$$\n$$\n\\tilde{y}_{k} \\approx H_{k}(x_{k} - \\hat{x}_{k}^{-}) + v_{k}\n$$\n新息方差 $S_{k}$ 是新息平方的期望值，即 $S_{k} = \\mathbb{E}[\\tilde{y}_{k}^{2}]$。首先，我们确认在此近似下新息是零均值的：\n$$\n\\mathbb{E}[\\tilde{y}_{k}] \\approx \\mathbb{E}[H_{k}(x_{k} - \\hat{x}_{k}^{-}) + v_{k}] = H_{k}\\mathbb{E}[x_{k} - \\hat{x}_{k}^{-}] + \\mathbb{E}[v_{k}]\n$$\n根据预测状态估计的定义，$\\mathbb{E}[x_{k} - \\hat{x}_{k}^{-}] = 0$。测量噪声也是零均值的，$\\mathbb{E}[v_{k}] = 0$。因此，$\\mathbb{E}[\\tilde{y}_{k}] = 0$。\n\n现在，我们计算方差：\n$$\nS_{k} = \\mathbb{E}[\\tilde{y}_{k}^{2}] \\approx \\mathbb{E}\\left[ (H_{k}(x_{k} - \\hat{x}_{k}^{-}) + v_{k})^{2} \\right]\n$$\n展开平方项：\n$$\nS_{k} \\approx \\mathbb{E}\\left[ H_{k}^{2}(x_{k} - \\hat{x}_{k}^{-})^{2} + 2H_{k}(x_{k} - \\hat{x}_{k}^{-})v_{k} + v_{k}^{2} \\right]\n$$\n根据期望的线性性质：\n$$\nS_{k} \\approx H_{k}^{2}\\mathbb{E}\\left[(x_{k} - \\hat{x}_{k}^{-})^{2}\\right] + 2H_{k}\\mathbb{E}\\left[(x_{k} - \\hat{x}_{k}^{-})v_{k}\\right] + \\mathbb{E}\\left[v_{k}^{2}\\right]\n$$\n我们根据给定的定义和假设来识别这些项：\n1.  $\\mathbb{E}\\left[(x_{k} - \\hat{x}_{k}^{-})^{2}\\right] = P_{k}^{-}$，标量先验状态误差方差。\n2.  $\\mathbb{E}\\left[(x_{k} - \\hat{x}_{k}^{-})v_{k}\\right] = 0$，因为状态预测误差与测量噪声不相关。\n3.  $\\mathbb{E}\\left[v_{k}^{2}\\right] = R_{k}$，测量噪声方差。\n\n将这些代入 $S_{k}$ 的表达式中，得到标量 EKF 中新息方差的基本关系式：\n$$\nS_{k} = H_{k}^{2}P_{k}^{-} + R_{k}\n$$\n\n**噪声方差调整的计算**\n\n第二个任务是计算重新调整滤波器所需的加性调整量 $\\Delta R$。给定滤波器的“旧”状态，其中预测的新息方差为 $S_{\\text{old}} = 0.2$。这对应于使用旧的测量噪声方差 $R_{\\text{old}}$。使用我们推导出的公式：\n$$\nS_{\\text{old}} = H_{k}^{2}P_{k}^{-} + R_{\\text{old}}\n$$\n代入给定的 $S_{\\text{old}}$ 值：\n$$\n0.2 = H_{k}^{2}P_{k}^{-} + R_{\\text{old}}\n$$\n我们希望重新调整滤波器，使得新的预测新息方差 $S_{\\text{new}}$ 与经验测量的方差 $\\hat{S} = 0.5$ 相匹配。这需要通过将 $R_{k}$ 调整为一个新值 $R_{\\text{new}}$ 来实现，同时保持 $H_{k}$ 和 $P_{k}^{-}$ 恒定。\n$$\nS_{\\text{new}} = H_{k}^{2}P_{k}^{-} + R_{\\text{new}}\n$$\n令 $S_{\\text{new}} = \\hat{S}$：\n$$\n0.5 = H_{k}^{2}P_{k}^{-} + R_{\\text{new}}\n$$\n我们需要求得 $\\Delta R = R_{\\text{new}} - R_{\\text{old}}$。为此，我们将新状态的方程减去旧状态的方程：\n$$\nS_{\\text{new}} - S_{\\text{old}} = (H_{k}^{2}P_{k}^{-} + R_{\\text{new}}) - (H_{k}^{2}P_{k}^{-} + R_{\\text{old}})\n$$\n正如问题约束所要求的，$H_k$ 和 $P_k^-$ 不变，因此 $H_{k}^{2}P_{k}^{-}$ 项被消去。\n$$\nS_{\\text{new}} - S_{\\text{old}} = R_{\\text{new}} - R_{\\text{old}} = \\Delta R\n$$\n代入 $S_{\\text{new}} = \\hat{S}$ 和 $S_{\\text{old}}$ 的数值：\n$$\n\\Delta R = 0.5 - 0.2 = 0.3\n$$\n对测量噪声方差所需的加性调整量为 0.3。", "answer": "$$\n\\boxed{0.3}\n$$", "id": "2706005"}]}