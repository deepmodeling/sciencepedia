{"hands_on_practices": [{"introduction": "第一个练习在哈密顿-雅可比-贝尔曼方程的一般理论和最优控制的经典结果之间架起了一座基础性的桥梁。通过解决一个简单的确定性线性二次型问题，您将从第一性原理推导出著名的代数里卡提方程（ARE）。这个实践旨在巩固HJB框架与LQR控制理论基石之间的联系。[@problem_id:2699184]", "problem": "考虑一个标量线性时不变系统，其控制方程为 $\\dot{x}(t) = a\\,x(t) + b\\,u(t)$，其无限时域二次性能指标为 $J = \\int_{0}^{\\infty} \\big(q\\,x(t)^{2} + r\\,u(t)^{2}\\big)\\,dt$。从 Bellman 最优性原理出发，导出无限时域情况下的稳态 Hamilton–Jacobi–Bellman (HJB) 方程，并使用二次值函数拟设 $V(x) = P\\,x^{2}$，其中 $P$ 为常数。通过对 HJB 哈密顿量关于 $u$ 进行最小化，推导 $P$ 满足的标量连续时间代数 Riccati 方程 (ARE)。然后，对于给定的数据 $a=1$、$b=1$、$q=2$ 和 $r=1$，显式求解得到的标量方程，并选择能使闭环系统 $\\dot{x}(t) = \\big(a - b\\,r^{-1}b\\,P\\big)\\,x(t)$ 渐近稳定的稳定解。将你的最终答案表示为稳定解 $P$ 的单个闭式解析表达式。无需四舍五入。", "solution": "出发点是关于最优值函数 $V(x)$ 的无限时域稳态 Hamilton–Jacobi–Bellman (HJB) 方程，\n$$\n0 \\;=\\; \\min_{u}\\,\\Big\\{\\, q\\,x^{2} + r\\,u^{2} + V_{x}(x)\\,\\big(a\\,x + b\\,u\\big) \\Big\\},\n$$\n其中 $V_{x}(x)$ 表示 $V$ 关于 $x$ 的导数。我们假设一个二次值函数拟设 $V(x) = P\\,x^{2}$，其中 $P$ 为常数。那么 $V_{x}(x) = 2\\,P\\,x$，HJB 哈密顿量变为\n$$\n\\mathcal{H}(x,u) \\;=\\; q\\,x^{2} + r\\,u^{2} + 2\\,P\\,x\\,(a\\,x + b\\,u).\n$$\n为了获得最优输入，将 $\\mathcal{H}(x,u)$ 关于 $u$ 最小化。一阶最优性条件是\n$$\n\\frac{\\partial \\mathcal{H}}{\\partial u} \\;=\\; 2\\,r\\,u + 2\\,P\\,x\\,b \\;=\\; 0,\n$$\n这给出了最优控制律\n$$\nu^{\\star}(x) \\;=\\; -\\,\\frac{b\\,P}{r}\\,x.\n$$\n将 $u^{\\star}(x)$ 代回哈密顿量，并使 HJB 方程成立。首先计算各项：\n- 状态惩罚项为 $q\\,x^{2}$。\n- 输入惩罚项为 $r\\,(u^{\\star})^{2} = r\\,\\Big(\\frac{b^{2}P^{2}}{r^{2}}\\,x^{2}\\Big) = \\frac{b^{2}}{r}\\,P^{2}\\,x^{2}$。\n- 耦合项为 $V_{x}\\,(a\\,x + b\\,u^{\\star}) = 2\\,P\\,x\\,\\Big(a\\,x + b\\big(-\\frac{b\\,P}{r}\\,x\\big)\\Big) = \\big(2\\,a\\,P - \\frac{2\\,b^{2}}{r}\\,P^{2}\\big)\\,x^{2}$。\n因此，\n$$\n0 \\;=\\; q\\,x^{2} + \\frac{b^{2}}{r}\\,P^{2}\\,x^{2} + \\Big(2\\,a\\,P - \\frac{2\\,b^{2}}{r}\\,P^{2}\\Big)\\,x^{2}\n\\;=\\; \\Big(q + 2\\,a\\,P - \\frac{b^{2}}{r}\\,P^{2}\\Big)\\,x^{2}.\n$$\n因为该式必须对所有 $x$ 成立，所以 $P$ 的标量连续时间代数 Riccati 方程 (ARE) 是\n$$\nq + 2\\,a\\,P - \\frac{b^{2}}{r}\\,P^{2} \\;=\\; 0.\n$$\n\n对于给定的数据 $a=1$、$b=1$、$q=2$ 和 $r=1$，该方程变为\n$$\n2 + 2\\,P - P^{2} \\;=\\; 0,\n$$\n或等价地\n$$\nP^{2} - 2\\,P - 2 \\;=\\; 0.\n$$\n解这个二次方程得到\n$$\nP \\;=\\; \\frac{2 \\pm \\sqrt{4 + 8}}{2} \\;=\\; 1 \\pm \\sqrt{3}.\n$$\n\n为了选择稳定解，我们考察最优控制器下的闭环标量动态。最优反馈为 $u^{\\star}(x) = -\\frac{b\\,P}{r}\\,x$，所以闭环系统是\n$$\n\\dot{x}(t) \\;=\\; \\Big(a - \\frac{b^{2}}{r}\\,P\\Big)\\,x(t) \\;=\\; \\big(1 - P\\big)\\,x(t).\n$$\n渐近稳定性要求 $1 - P < 0$，即 $P > 1$。在两个根 $1 \\pm \\sqrt{3}$ 中，只有 $1 + \\sqrt{3}$ 满足 $P > 1$ 且为非负。因此，稳定解是\n$$\nP^{\\star} \\;=\\; 1 + \\sqrt{3}.\n$$", "answer": "$$\\boxed{1+\\sqrt{3}}$$", "id": "2699184"}, {"introduction": "在确定性问题的基础上，这个实践将带您进入随机最优控制的领域。您将把HJB方程应用于一个由Ornstein–Uhlenbeck过程（一种常见的均值回归随机动力学模型）控制的系统。这个练习展示了HJB框架如何通过二阶导数项巧妙地将随机性融入其中，从而得出一个在噪声存在时能稳定系统的最优反馈律。[@problem_id:3001633]", "problem": "考虑一维受控Ornstein–Uhlenbeck (OU) 扩散的无穷时域折扣随机控制问题。状态过程 $\\{X_{t}\\}_{t \\ge 0}$ 遵循以下受控随机微分方程演化：\n$$\n\\mathrm{d}X_{t} = \\big(-\\theta X_{t} + \\beta u_{t}\\big)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t}, \\quad X_{0}=x,\n$$\n其中 $W_{t}$ 是一个标准布朗运动，$\\theta>0$，$\\beta\\neq 0$，$\\sigma>0$ 是给定的常数。控制过程 $\\{u_{t}\\}_{t \\ge 0}$ 相对于 $W_{t}$ 的 filtration流 是循序可测的，并在 $\\mathbb{R}$ 中取值。其目标是在所有容许控制上最小化折扣成本泛函\n$$\nJ^{u}(x) \\equiv \\mathbb{E}\\!\\left[\\int_{0}^{\\infty} \\exp(-\\rho t)\\big(q X_{t}^{2} + r u_{t}^{2}\\big)\\,\\mathrm{d}t\\right],\n$$\n其中 $\\rho>0$, $q>0$, 和 $r>0$ 是给定的常数。令 $V(x)\\equiv \\inf_{u} J^{u}(x)$ 表示值函数。\n\n从动态规划原理、扩散算子以及折扣期望成本的定义出发，推导 $V(x)$ 的 Hamilton–Jacobi–Bellman (HJB) 方程，以闭式形式显式求解该方程，并求得最优平稳马尔可夫反馈 $u^{\\ast}(x)$。解释最优反馈如何改变线性漂移项，以及为何这能使闭环 OU 动力学达到稳定。最终答案必须以单个解析表达式的形式给出，该表达式包含闭式值函数 $V(x)$ 和最优反馈 $u^{\\ast}(x)$，写成一个 $1\\times 2$ 的行矩阵，其中第一个元素为 $V(x)$，第二个元素为 $u^{\\ast}(x)$。无需进行数值计算，也不得进行任何四舍五入。", "solution": "我们从受控扩散开始\n$$\n\\mathrm{d}X_{t} = b(X_{t},u_{t})\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t}, \\quad b(x,u) \\equiv -\\theta x + \\beta u,\n$$\n以及无穷时域折扣成本\n$$\nJ^{u}(x) = \\mathbb{E}\\!\\left[\\int_{0}^{\\infty}\\exp(-\\rho t)\\,\\ell(X_{t},u_{t})\\,\\mathrm{d}t\\right], \\quad \\ell(x,u) \\equiv q x^{2} + r u^{2},\n$$\n其中 $\\rho>0$, $\\theta>0$, $q>0$, $r>0$, $\\sigma>0$, 且 $\\beta\\neq 0$。动态规划原理断言，如果 $V$ 是值函数，则在充分的正则性条件下，$V$ 满足 Hamilton–Jacobi–Bellman (HJB) 方程。对于一个二次连续可微的 $V$ 和一个折扣因子 $\\rho>0$，该扩散控制问题的 HJB 方程为\n$$\n\\rho V(x) = \\inf_{u\\in\\mathbb{R}}\\Big\\{\\ell(x,u) + \\mathcal{L}^{u}V(x)\\Big\\},\n$$\n其中 $\\mathcal{L}^{u}$ 是受控算子，它作用于光滑检验函数 $f$ 的方式如下：\n$$\n\\mathcal{L}^{u} f(x) \\equiv b(x,u) f'(x) + \\tfrac{1}{2}\\sigma^{2} f''(x) = \\big(-\\theta x + \\beta u\\big) f'(x) + \\tfrac{1}{2}\\sigma^{2} f''(x).\n$$\n因此，HJB 方程的具体形式为：\n$$\n\\rho V(x) = \\inf_{u\\in\\mathbb{R}}\\left\\{q x^{2} + r u^{2} + \\big(-\\theta x + \\beta u\\big)V'(x) + \\tfrac{1}{2}\\sigma^{2} V''(x)\\right\\}.\n$$\n\n我们现在来解此方程。该结构是关于 $(x,u)$ 的线性二次形式，因此很自然地可以寻找以下形式的解：\n$$\nV(x) = P x^{2} + C,\n$$\n其中常数 $P$ 和 $C$ 待定。我们计算其导数 $V'(x) = 2 P x$ 和 $V''(x) = 2 P$。代入 HJB 方程得到：\n$$\n\\rho \\big(P x^{2} + C\\big) = \\inf_{u\\in\\mathbb{R}}\\left\\{q x^{2} + r u^{2} + \\big(-\\theta x + \\beta u\\big)\\,2 P x + \\tfrac{1}{2}\\sigma^{2}\\cdot 2 P\\right\\}.\n$$\n关于 $u$ 的最小化问题涉及以下二次函数：\n$$\n\\Phi(u;x) \\equiv r u^{2} + 2 P \\beta x\\, u + \\big(q x^{2} - 2\\theta P x^{2} + \\sigma^{2} P\\big).\n$$\n对每个固定的 $x$，最小化子 $u^{\\ast}(x)$ 满足一阶条件：\n$$\n\\frac{\\partial \\Phi}{\\partial u}(u;x) = 2 r u + 2 P \\beta x = 0,\n$$\n这给出了平稳反馈：\n$$\nu^{\\ast}(x) = -\\frac{\\beta P}{r}\\,x.\n$$\n二阶导数 $\\frac{\\partial^{2}\\Phi}{\\partial u^{2}} = 2 r>0$ 证实了这确实是全局最小化子。将 $u^{\\ast}$ 代回，我们在最小值处进行计算：\n\n$$\n\\begin{aligned}\nr \\big(u^{\\ast}(x)\\big)^{2} &= r \\left(\\frac{\\beta^{2} P^{2}}{r^{2}} x^{2}\\right) = \\frac{\\beta^{2} P^{2}}{r} x^{2},\\\\\n\\big(-\\theta x + \\beta u^{\\ast}(x)\\big) V'(x) &= \\big(-\\theta x - \\beta \\tfrac{\\beta P}{r} x\\big)\\,2 P x = \\big(-2\\theta P - \\tfrac{2\\beta^{2} P^{2}}{r}\\big) x^{2},\\\\\n\\tfrac{1}{2}\\sigma^{2} V''(x) &= \\sigma^{2} P.\n\\end{aligned}\n$$\n\n因此，在最小化之后，HJB 方程变为：\n$$\n\\rho P x^{2} + \\rho C = \\left[q - 2\\theta P - \\frac{\\beta^{2}}{r} P^{2}\\right] x^{2} + \\sigma^{2} P.\n$$\n匹配 $x^{2}$ 的系数和常数项，得到以下耦合代数方程组：\n$$\n\\begin{cases}\n\\rho P = q - 2\\theta P - \\dfrac{\\beta^{2}}{r} P^{2} \\\\\n\\rho C = \\sigma^{2} P\n\\end{cases}\n$$\n\n第一个方程是关于 $P$ 的代数Riccati方程：\n$$\n\\frac{\\beta^{2}}{r} P^{2} + (\\rho + 2\\theta) P - q = 0.\n$$\n它的两个根是\n$$\nP_{\\pm} = \\frac{ -(\\rho + 2\\theta) \\pm \\sqrt{(\\rho + 2\\theta)^{2} + \\dfrac{4\\beta^{2}}{r} q} }{ 2 \\dfrac{\\beta^{2}}{r} } = \\frac{r}{2\\beta^{2}}\\left( -(\\rho + 2\\theta) \\pm \\sqrt{(\\rho + 2\\theta)^{2} + \\frac{4\\beta^{2}}{r} q} \\right).\n$$\n因为 $q>0$, $r>0$, 且 $\\beta\\neq 0$，判别式严格大于 $(\\rho + 2\\theta)^{2}$，所以平方根项大于 $\\rho + 2\\theta$。因此 $P_{-}<0$ 且\n$$\nP_{+} = \\frac{r}{2\\beta^{2}}\\left( -(\\rho + 2\\theta) + \\sqrt{(\\rho + 2\\theta)^{2} + \\frac{4\\beta^{2}}{r} q} \\right) > 0.\n$$\n$V$ 的凸性和值函数的有限性要求我们选择正的稳定化解，因此我们取 $P=P_{+}$。于是常数 $C$ 为\n$$\nC = \\frac{\\sigma^{2}}{\\rho}\\,P_{+}.\n$$\n\n综上所述，值函数和最优反馈为：\n\n$$\n\\begin{aligned}\nV(x) &= P_{+} x^{2} + \\frac{\\sigma^{2}}{\\rho}\\,P_{+},\\\\\nu^{\\ast}(x) &= -\\frac{\\beta P_{+}}{r}\\,x = \\frac{(\\rho + 2\\theta) - \\sqrt{(\\rho + 2\\theta)^{2} + \\dfrac{4\\beta^{2}}{r} q}}{2\\beta}\\,x.\n\\end{aligned}\n$$\n\n$u^{\\ast}(x)$ 的等式是通过代入 $P_{+}$ 的表达式得到的。为了解释其稳定化作用，我们观察到在 $u^{\\ast}$ 控制下，闭环漂移项变为：\n$$\n-\\theta x + \\beta u^{\\ast}(x) = -\\left(\\theta + \\frac{\\beta^{2}}{r} P_{+}\\right) x,\n$$\n其中 $\\theta + \\dfrac{\\beta^{2}}{r} P_{+} > \\theta > 0$。因此，闭环系统中的线性漂移系数比开环系统中更为负，这产生了一个向原点有更强均值回归的Ornstein–Uhlenbeck过程。这种负线性反馈正是在存在扩散噪声的情况下，最小化长期折扣二次成本的稳定化作用。", "answer": "$$\\boxed{\\begin{pmatrix}\n\\frac{r}{2\\beta^{2}}\\!\\left(\\! -(\\rho+2\\theta)+\\sqrt{(\\rho+2\\theta)^{2}+\\frac{4\\beta^{2}}{r}q}\\,\\right) x^{2}+\\frac{\\sigma^{2}}{\\rho}\\cdot \\frac{r}{2\\beta^{2}}\\!\\left(\\! -(\\rho+2\\theta)+\\sqrt{(\\rho+2\\theta)^{2}+\\frac{4\\beta^{2}}{r}q}\\,\\right)\n&\n\\frac{(\\rho+2\\theta)-\\sqrt{(\\rho+2\\theta)^{2}+\\frac{4\\beta^{2}}{r}q}}{2\\beta}\\,x\n\\end{pmatrix}}$$", "id": "3001633"}, {"introduction": "并非所有对值函数的合理猜测都是正确的，这个练习正说明了HJB方程作为验证工具的关键作用。您将为一个最小时间问题测试一个光滑的候选函数，并发现即使它满足边界条件，也未能在区域内部完全满足HJB方程。这个实践突出了为何HJB方程是确定最优性的一个必要条件，并提供了一个经典解概念失效的具体例子。[@problem_id:2752646]", "problem": "考虑在域 $\\Omega := (-1,1)$ 上的确定性控制系统，其动力学由 $\\dot{x}(t) = u(t)$ 给出，控制约束为对所有 $t \\geq 0$ 都有 $u(t) \\in [-1,1]$。设退出时间为 $\\tau := \\inf\\{ t \\geq 0 : |x(t)| = 1 \\}$，代价泛函为 $J(x_{0};u(\\cdot)) := \\int_{0}^{\\tau} 1 \\, dt$，其中 $x(0)=x_{0} \\in \\Omega$。将值函数 $V(x_{0})$ 定义为在所有取值于 $[-1,1]$ 的可测控制 $u(\\cdot)$ 上 $J(x_{0};u(\\cdot))$ 的下确界。\n\n从动态规划原理出发，为任何满足边界条件 $W(x)=0$（对于 $|x|=1$）的足够光滑的候选函数 $W:\\Omega \\to \\mathbb{R}$ 推导其逐点一致性条件，并说明在 $\\Omega$ 内部，Hamilton-Jacobi-Bellman (HJB) 方程如何通过一个适当的残差来约束 $W$。然后，考虑具体的满足边界条件 $W(\\pm 1)=0$ 的光滑候选函数 $W(x) := 1 - x^{2}$。使用您推导出的 HJB 一致性条件，计算在 $x=0$ 处的逐点残差。\n\n您的最终答案必须是对应于此残差在 $x=0$ 处的值的单个实数。不需要进行四舍五入。", "solution": "该问题要求从动态规划原理（DPP）出发，推导 Hamilton-Jacobi-Bellman (HJB) 一致性条件，然后将其应用于一个具体的候选函数。\n\n系统动力学由 $\\dot{x}(t) = u(t)$ 给出，状态 $x(t) \\in \\Omega := (-1,1)$，控制 $u(t) \\in [-1,1]$。代价泛函表示退出域 $\\Omega$ 所需的时间：\n$$J(x_{0};u(\\cdot)) := \\int_{0}^{\\tau} 1 \\, dt$$\n其中 $\\tau := \\inf\\{t \\geq 0 : |x(t)| = 1\\}$。值函数 $V(x)$ 是在所有容许控制下该代价的下确界：$V(x) = \\inf_{u(\\cdot)} J(x; u(\\cdot))$。运行代价为 $L(x,u) = 1$。边界条件为对于 $x \\in \\partial\\Omega$（即 $|x|=1$）有 $V(x) = 0$。\n\n动态规划原理指出，对于任意小的时间间隔 $h > 0$，值函数满足：\n$$V(x) = \\inf_{u(\\cdot):[0,h]\\to[-1,1]} \\left\\{ \\int_0^h L(x(t), u(t)) \\, dt + V(x(h)) \\right\\}$$\n对于这个具体问题，这变为：\n$$V(x) = \\inf_{u(\\cdot):[0,h]\\to[-1,1]} \\left\\{ h + V(x(h)) \\right\\}$$\n假设在区间 $[0, h]$ 上，控制 $u(t)$ 是一个常数值 $u \\in [-1,1]$，则状态演化为 $x(h) = x(0) + \\int_0^h u \\, ds = x + hu$。\n如果假设值函数 $V$ 是连续可微的（$C^1$），我们可以在 $x$ 附近将 $V(x(h))$ 展开为泰勒级数：\n$$V(x(h)) = V(x+hu) = V(x) + V'(x)(hu) + O(h^2)$$\n其中 $V'(x)$ 表示 $V$ 关于 $x$ 的导数。将此代入 DPP 方程：\n$$V(x) = \\inf_{u \\in [-1,1]} \\left\\{ h + V(x) + hV'(x)u + O(h^2) \\right\\}$$\n我们从两边减去 $V(x)$ 并除以 $h > 0$：\n$$0 = \\inf_{u \\in [-1,1]} \\left\\{ 1 + V'(x)u + O(h) \\right\\}$$\n取极限 $h \\to 0$， $O(h)$ 项消失，得到值函数 $V(x)$ 在域 $\\Omega$ 内部必须满足的静态 Hamilton-Jacobi-Bellman 方程：\n$$0 = \\inf_{u \\in [-1,1]} \\left\\{ 1 + V'(x)u \\right\\}$$\n这个方程提供了逐点一致性条件。对于任何足够光滑的候选函数 $W(x)$，我们定义 HJB 残差 $R_W(x)$ 为 HJB 表达式的值：\n$$R_W(x) := \\inf_{u \\in [-1,1]} \\left\\{ 1 + W'(x)u \\right\\}$$\n对于一个候选函数，要成为真正的值函数，其残差必须对所有 $x \\in \\Omega$ 都为零，并且它必须满足边界条件。\n\n给定的候选函数是 $W(x) := 1 - x^2$。\n首先，我们验证边界条件：$W(\\pm 1) = 1 - (\\pm 1)^2 = 1 - 1 = 0$。该条件得到满足。\n接下来，我们计算 $W(x)$ 的导数：\n$$W'(x) = \\frac{d}{dx}(1 - x^2) = -2x$$\n我们现在将这个导数代入残差的表达式中：\n$$R_W(x) = \\inf_{u \\in [-1,1]} \\left\\{ 1 + (-2x)u \\right\\} = \\inf_{u \\in [-1,1]} \\left\\{ 1 - 2xu \\right\\}$$\n待最小化的表达式 $1 - 2xu$ 是控制变量 $u$ 在紧集 $[-1,1]$ 上的一个线性函数。最小值必然在其中一个端点 $u=-1$ 或 $u=1$ 处取得。具体选择取决于 $u$ 的系数（即 $-2x$）的符号。\n具体来说，使表达式最小化的控制 $u^*(x)$ 是 $u^*(x) = \\text{sgn}(-2x) = -\\text{sgn}(x)$ (对于 $x \\neq 0$)。\n该下确界可以写为 $1 - \\sup_{u \\in [-1,1]} \\{2xu\\}$。其上确界是 $2|x|$，所以残差为：\n$$R_W(x) = 1 - 2|x|$$\n问题要求的是在点 $x=0$ 处此逐点残差的值。我们在 $x=0$ 处计算残差函数的值：\n$$R_W(0) = 1 - 2|0| = 1$$\n或者，可以直接在 $x=0$ 处计算下确界表达式：\n$$R_W(0) = \\inf_{u \\in [-1,1]} \\{ 1 - 2(0)u \\} = \\inf_{u \\in [-1,1]} \\{ 1 \\} = 1$$\n在 $x=0$ 处的残差是 $1$。", "answer": "$$\\boxed{1}$$", "id": "2752646"}]}