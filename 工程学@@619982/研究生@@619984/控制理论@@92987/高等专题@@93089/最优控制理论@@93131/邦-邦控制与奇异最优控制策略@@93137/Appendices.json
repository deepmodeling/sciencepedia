{"hands_on_practices": [{"introduction": "时间最优控制的一个经典应用场景是航天器姿态机动。该系统的动力学本质上是一个双积分器模型，这是控制理论中的一个典型范例。本练习将引导你从第一性原理（即庞特里亚金极大值原理）出发，推导著名的“砰砰”控制律，并将其应用于解决实际的姿态转换问题，从而让你深入理解状态空间中的最优轨迹 [@problem_id:2690322]。", "problem": "考虑一个刚性航天器，其围绕主轴执行平面姿态机动，且控制力矩有界。其围绕主轴的转动动力学由刚体方程 $J \\dot{\\omega} = u$ 以及运动学关系 $\\dot{\\theta} = \\omega$ 给出，其中 $J  0$ 是主转动惯量，$\\theta$ 是姿态角（单位：弧度），$\\omega$ 是角速率（单位：弧度/秒），$u$ 是控制力矩（单位：牛顿·米），且服从硬约束 $\\lvert u \\rvert \\le \\tau_{\\max}$。目标是最小化将航天器从初始状态 $(\\theta(0), \\omega(0)) = (\\theta_0, \\omega_0)$ 转移到终端状态 $(\\theta(T), \\omega(T)) = (\\theta_f, 0)$ 所需的转移时间 $T$。\n\n您的任务是：\n\n1) 使用严谨的、基于原理的方法，从动力学的基础定义出发，构建时间最优控制问题。使用庞特里亚金最小值原理 (PMP; Pontryagin's Minimum Principle) 分析其结构，并逻辑推导该双积分器类系统在幅值受限控制下的最优控制策略的定性形式。基于此分析，确定奇异弧是否可能出现，并证明您的结论。\n\n2) 从第一性原理出发，且不借助未经证明的简化公式，推导确定最优控制序列和相应开关时间的条件。您的推导必须仅使用系统方程 $\\dot{\\theta} = \\omega$、$J \\dot{\\omega} = u$、边界 $\\lvert u \\rvert \\le \\tau_{\\max}$ 以及PMP最优性条件。最后，给出能够计算最小转移时间 $T^\\star$（单位：秒）、第一段等力矩弧的持续时间 $t_1$（单位：秒）、第二段等力矩弧的持续时间 $t_2$（单位：秒）以及第一个力矩水平 $u = \\sigma \\tau_{\\max}$ 的符号 $\\sigma \\in \\{-1, +1\\}$ 的显式代数表达式，假设最优策略在极限控制之间至多有一次开关。\n\n3) 实现一个程序，为下列每个测试用例计算：\n- 最小转移时间 $T^\\star$ (单位：秒)，\n- 弧段持续时间 $t_1$ 和 $t_2$ (单位：秒)，\n- 初始bang符号 $\\sigma \\in \\{-1, +1\\}$，编码为整数 $+1$ 或 $-1$，\n- 一个布尔标志，指示是否存在奇异弧，其值必须根据您的分析设置为适当的逻辑值。\n\n角度单位必须是弧度，时间单位必须是秒，力矩单位必须是牛顿·米。如果出现退化的边界情况，即 $T^\\star = 0$（无需运动），则设置 $t_1 = 0$，$t_2 = 0$，符号 $\\sigma = 0$。\n\n测试套件 (每个元组为 $(J,\\ \\tau_{\\max},\\ \\theta_0,\\ \\theta_f,\\ \\omega_0)$):\n- 情况 A (典型情况): $(8.0,\\ 4.0,\\ 0.0,\\ 0.2,\\ 0.0)$\n- 情况 B (单bang边界，纯制动): $(2.0,\\ 2.0,\\ 0.0,\\ 0.5,\\ 1.0)$\n- 情况 C (朝向目标的通用非零初始速率): $(5.0,\\ 5.0,\\ 0.0,\\ 0.5,\\ 0.8)$\n- 情况 D (背离目标的通用初始速率): $(3.0,\\ 6.0,\\ 0.0,\\ 0.3,\\ -0.9)$\n- 情况 E (相同角度的静止到静止退化情况): $(10.0,\\ 5.0,\\ 1.0,\\ 1.0,\\ 0.0)$\n\n最终输出格式：\n- 您的程序必须生成单行输出，其中包含一个Python风格的结果列表，每个测试用例一个结果，并按上述顺序排列。\n- 每个测试用例的结果必须是一个形如 $[T^\\star,\\ t_1,\\ t_2,\\ \\sigma,\\ \\text{has\\_singular}]$ 的列表。\n- 所有时间必须表示为浮点数，单位为秒。符号 $\\sigma$ 必须是整数（根据上述规定为 $-1$、$0$ 或 $+1$）。奇异性标志必须是布尔值。\n- 单行输出必须严格为一个包含这五个逐情况列表的列表，例如 $[[\\cdots],[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$，无任何多余文本。\n\n您的实现必须是自包含的，并且不需要用户输入。它必须仅使用测试套件中提供的数值。所有角度单位均为弧度，所有时间单位均为秒，所有力矩单位均为牛顿·米。如果存在任何与角度相关的计算，则必须以弧度为单位进行。输出的时间应以浮点数值进行数值计算；为保证可复现性，请在您打印的结果中将所有浮点输出四舍五入到 $9$ 位小数。", "solution": "确定刚体平面机动的时间最优控制问题，是最优控制理论中的一个经典问题。该系统是角度上的双积分器，这是一个被充分研究过的情况。我们将验证该问题，然后基于庞特里亚金最小值原理 (PMP) 进行严谨的推导。\n\n**问题表述与状态空间表示**\n\n首先，我们将问题形式化。设状态向量为 $x(t) = [x_1(t), x_2(t)]^T = [\\theta(t), \\omega(t)]^T$。系统动力学由下式给出：\n$$\n\\begin{cases}\n\\dot{x}_1 = x_2 \\\\\n\\dot{x}_2 = \\frac{u}{J}\n\\end{cases}\n$$\n其中 $x_1 = \\theta$ 是姿态角，$x_2 = \\omega$ 是角速率。控制输入 $u$ 是力矩，服从约束 $|u| \\le \\tau_{\\max}$。目标是最小化最终时间 $T$，因此成本函数为 $J = \\int_0^T 1 \\, dt$。\n\n边界条件为：\n- 初始状态：$x(0) = [\\theta_0, \\omega_0]^T$\n- 最终状态：$x(T) = [\\theta_f, 0]^T$\n\n**第1部分：使用庞特里亚金最小值原理的最优性分析与奇异弧分析**\n\n根据庞特里亚金最小值原理，对于最优控制 $u^\\star(t)$ 及其对应的状态轨迹 $x^\\star(t)$，存在一个非零、连续的协态向量 $\\lambda(t) = [\\lambda_1(t), \\lambda_2(t)]^T$，满足以下条件。\n\n此时间最优问题的哈密顿量 $H$ 定义为：\n$$\nH(x, \\lambda, u) = \\lambda_0 + \\lambda^T f(x, u) = 1 + \\lambda_1 x_2 + \\lambda_2 \\frac{u}{J}\n$$\n这里我们设定常数 $\\lambda_0=1$，对于正常问题（即与状态相关的协态向量不为零的问题）这是允许的。\n\n协态（或伴随）方程由 $\\dot{\\lambda} = -\\frac{\\partial H}{\\partial x}$ 给出：\n$$\n\\dot{\\lambda}_1 = -\\frac{\\partial H}{\\partial x_1} = 0 \\implies \\lambda_1(t) = c_1 \\quad (\\text{常数})\n$$\n$$\n\\dot{\\lambda}_2 = -\\frac{\\partial H}{\\partial x_2} = -\\lambda_1 = -c_1 \\implies \\lambda_2(t) = -c_1 t + c_2\n$$\n其中 $c_1$ 和 $c_2$ 是由边界条件决定的积分常数。\n\n最小化条件规定，最优控制 $u^\\star(t)$ 必须在每个时间瞬间最小化哈密顿量：\n$$\nu^\\star(t) = \\arg\\min_{|u| \\le \\tau_{\\max}} H(x^\\star, \\lambda^\\star, u) = \\arg\\min_{|u| \\le \\tau_{\\max}} \\left(1 + \\lambda_1^\\star x_2^\\star + \\lambda_2^\\star \\frac{u}{J}\\right)\n$$\n为了最小化 $H$，我们必须选择 $u$ 以使项 $\\lambda_2^\\star u / J$ 尽可能为负。这导出控制律：\n$$\nu^\\star(t) = -\\tau_{\\max} \\text{sgn}(\\lambda_2^\\star(t))\n$$\n项 $S(t) = \\lambda_2^\\star(t)$ 被称为开关函数。最优控制始终处于其最大或最小值，这种结构称为 bang-bang 控制。\n\n现在，我们分析奇异弧的可能性。如果开关函数 $S(t)$ 在一个有限时间区间内为零，即对于 $t \\in [t_a, t_b]$ 有 $S(t) \\equiv 0$，则出现奇异弧。\n如果 $S(t) = \\lambda_2(t) \\equiv 0$ 在一个区间上成立，那么它的所有时间导数在该区间上也必须为零。\n-   $S(t) = -c_1 t + c_2 = 0 \\implies \\dot{S}(t) = -c_1 = 0$。\n-   $\\dot{S}(t) = 0 \\implies c_1 = 0$。\n-   将 $c_1=0$ 代回 $S(t)=0$ 得到 $c_2 = 0$。\n这意味着，要存在奇异弧，必须有 $\\lambda_1(t) = c_1 = 0$ 和 $\\lambda_2(t) = c_2 = 0$。这将导致整个协态向量 $\\lambda(t)$ 恒等于零。然而，PMP 要求协态向量非零。因此，在此问题中不可能出现奇异弧。最优控制是纯粹的 bang-bang 控制。开关函数 $\\lambda_2(t) = -c_1 t + c_2$ 是时间的线性函数。除非 $c_1=0$，否则它最多只能为零一次，这意味着控制最多只能有一次开关。如果 $c_1=0$，$\\lambda_2(t)=c_2$ 是一个非零常数，导致单bang控制（无开关）。因此，最优策略最多包含在极限控制值 $+\\tau_{\\max}$ 和 $-\\tau_{\\max}$ 之间的一次开关。\n\n**第2部分：最优控制序列和开关时间的推导**\n\n最优轨迹最多由两个分段组成，每个分段的力矩恒定。设第一段力矩为 $u_1 = \\sigma\\tau_{\\max}$，持续时间为 $t_1$；第二段力矩为 $u_2 = -\\sigma\\tau_{\\max}$，持续时间为 $t_2$，其中 $\\sigma \\in \\{-1, +1\\}$。总时间为 $T^\\star = t_1 + t_2$。设 $\\alpha = \\tau_{\\max}/J$ 为最大角加速度。\n\n_阶段1：$t \\in [0, t_1]$, $u = \\sigma\\tau_{\\max}$_\n从初始状态 $(\\theta_0, \\omega_0)$ 积分运动方程：\n$$\n\\omega(t_1) = \\omega_0 + \\sigma\\alpha t_1\n$$\n$$\n\\theta(t_1) = \\theta_0 + \\omega_0 t_1 + \\frac{1}{2}\\sigma\\alpha t_1^2\n$$\n设 $(\\theta_1, \\omega_1)$ 为开关时间 $t_1$ 时的状态。\n\n_阶段2：$t \\in (t_1, t_1+t_2]$, $u = -\\sigma\\tau_{\\max}$_\n从 $(\\theta_1, \\omega_1)$ 积分到最终状态 $(\\theta_f, 0)$：\n$$\n\\omega(T) = 0 = \\omega_1 - \\sigma\\alpha t_2 \\implies \\omega_1 = \\sigma\\alpha t_2\n$$\n$$\n\\theta(T) = \\theta_f = \\theta_1 + \\omega_1 t_2 - \\frac{1}{2}\\sigma\\alpha t_2^2\n$$\n结合关于 $\\omega_1$ 的方程，我们得到：\n$$\n\\omega_0 + \\sigma\\alpha t_1 = \\sigma\\alpha t_2 \\implies t_1 = t_2 - \\frac{\\sigma\\omega_0}{\\alpha}\n$$\n现在我们使用总角度变化 $\\Delta\\theta = \\theta_f - \\theta_0$ 的方程：\n$$\n\\Delta\\theta = (\\theta_1 - \\theta_0) + (\\theta_f - \\theta_1) = \\left(\\omega_0 t_1 + \\frac{1}{2}\\sigma\\alpha t_1^2\\right) + \\left(\\omega_1 t_2 - \\frac{1}{2}\\sigma\\alpha t_2^2\\right)\n$$\n代入 $\\omega_1 = \\sigma\\alpha t_2$：\n$$\n\\Delta\\theta = \\omega_0 t_1 + \\frac{1}{2}\\sigma\\alpha t_1^2 + \\frac{1}{2}\\sigma\\alpha t_2^2\n$$\n代入 $t_1 = t_2 - \\sigma\\omega_0/\\alpha$：\n$$\n\\Delta\\theta = \\omega_0\\left(t_2 - \\frac{\\sigma\\omega_0}{\\alpha}\\right) + \\frac{1}{2}\\sigma\\alpha\\left(t_2 - \\frac{\\sigma\\omega_0}{\\alpha}\\right)^2 + \\frac{1}{2}\\sigma\\alpha t_2^2\n$$\n展开并简化此表达式，得到一个关于 $t_2$ 的非常简洁的方程：\n$$\n\\Delta\\theta = \\sigma\\alpha t_2^2 - \\frac{1}{2}\\frac{\\sigma\\omega_0^2}{\\alpha}\n$$\n解出 $t_2^2$：\n$$\nt_2^2 = \\frac{\\Delta\\theta}{\\sigma\\alpha} + \\frac{\\omega_0^2}{2\\alpha^2} = \\frac{\\sigma\\Delta\\theta}{\\alpha} + \\frac{\\omega_0^2}{2\\alpha^2}\n$$\n持续时间 $t_1$ 和 $t_2$ 必须为非负。这一事实，结合问题的物理意义，决定了符号 $\\sigma$。最优策略是施加一个初始力矩，将系统驱动到状态空间中的一条“开关曲线”上，从该曲线上施加单个制动力矩即可将系统带到最终状态 $(\\theta_f, 0)$。\n\n开关曲线是这样一组状态 $(\\theta, \\omega)$ 的集合：从这些状态出发，航天器可以通过单次施加最大制动力矩到达 $(\\theta_f, 0)$。制动力矩为 $u=-\\text{sgn}(\\omega)\\tau_{\\max}$。在此类制动过程中转过的角度是 $\\frac{\\omega|\\omega|}{2\\alpha}$。因此，最终角度将是 $\\theta + \\frac{\\omega|\\omega|}{2\\alpha}$。为了使之等于 $\\theta_f$，状态必须位于该曲线上。\n从初始状态 $(\\theta_0, \\omega_0)$ 出发，如果立即制动，航天器将停止的角度是 $\\theta_{stop} = \\theta_0 + \\frac{\\omega_0|\\omega_0|}{2\\alpha}$。\n我们将 $\\theta_{stop}$ 与目标角度 $\\theta_f$ 进行比较：\n- 如果 $\\theta_f > \\theta_{stop}$，航天器会在到达目标前停下。它必须首先施加一个正力矩以覆盖更多距离。因此，$\\sigma = +1$。\n- 如果 $\\theta_f  \\theta_{stop}$，航天器会超过目标。它必须首先施加一个负力矩。因此，$\\sigma = -1$。\n- 如果 $\\theta_f = \\theta_{stop}$，航天器已经位于开关曲线上。只需要一次制动操作 ($t_1=0$)。$\\sigma$ 的公式指示了一个bang-bang轨迹，但对于这个边界情况，我们应选择 $\\sigma$ 以正确描述第二阶段的制动力矩。制动力矩是 $-\\text{sgn}(\\omega_0)\\tau_{\\max}$，而第二阶段的力矩是 $-\\sigma\\tau_{\\max}$，这意味着 $\\sigma = \\text{sgn}(\\omega_0)$。\n\n这引出以下算法：\n1.  定义 $\\alpha = \\tau_{\\max}/J$ 和 $\\Delta\\theta = \\theta_f - \\theta_0$。\n2.  处理退化情况：如果 $\\Delta\\theta=0$ 且 $\\omega_0=0$，则 $T^\\star=t_1=t_2=0$ 且 $\\sigma=0$。\n3.  计算纯制动下的停止位置：$\\theta_{stop} = \\theta_0 + \\frac{\\omega_0|\\omega_0|}{2\\alpha}$。\n4.  如果 $\\theta_f = \\theta_{stop}$（在一个小容差范围内），则单bang轨迹是最优的。\n    $t_1 = 0$，$t_2 = |\\omega_0|/\\alpha$。初始力矩符号为 $\\sigma = \\text{sgn}(\\omega_0)$。（如果 $\\omega_0=0$，我们处于退化情况）。\n5.  否则，bang-bang轨迹是最优的。\n    -   第一个力矩的符号为 $\\sigma = \\text{sgn}(\\theta_f - \\theta_{stop})$。\n    -   第二段弧的持续时间为 $t_2 = \\sqrt{\\frac{\\sigma\\Delta\\theta}{\\alpha} + \\frac{\\omega_0^2}{2\\alpha^2}}$。这保证了根号内的项为非负。\n    -   第一段弧的持续时间为 $t_1 = t_2 - \\frac{\\sigma\\omega_0}{\\alpha}$。这也保证了为非负。\n6.  最小时间为 $T^\\star = t_1+t_2$。标志 `has_singular` 始终为 `False`。\n\n这完成了实现所需的推导。", "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to solve the spacecraft slew problem for all test cases.\n    \"\"\"\n    # Test suite: (J, tau_max, theta_0, theta_f, omega_0)\n    test_cases = [\n        (8.0, 4.0, 0.0, 0.2, 0.0),      # Case A\n        (2.0, 2.0, 0.0, 0.5, 1.0),      # Case B\n        (5.0, 5.0, 0.0, 0.5, 0.8),      # Case C\n        (3.0, 6.0, 0.0, 0.3, -0.9),     # Case D\n        (10.0, 5.0, 1.0, 1.0, 0.0),     # Case E\n    ]\n\n    results_str = []\n    for case in test_cases:\n        J, tau_max, theta_0, theta_f, omega_0 = case\n        result = compute_optimal_slew(J, tau_max, theta_0, theta_f, omega_0)\n        results_str.append(format_result(result))\n\n    # Print the final output in the exact specified format\n    print(f\"[{','.join(results_str)}]\")\n\ndef compute_optimal_slew(J, tau_max, theta_0, theta_f, omega_0):\n    \"\"\"\n    Computes the time-optimal control parameters for a single test case.\n\n    Returns a list: [T_star, t1, t2, sigma, has_singular]\n    \"\"\"\n    # From the analysis, singular arcs do not occur for this system.\n    has_singular = False\n    \n    # Degenerate case: initial state is the target state.\n    if np.isclose(theta_f, theta_0) and np.isclose(omega_0, 0.0):\n        return [0.0, 0.0, 0.0, 0, has_singular]\n\n    alpha = tau_max / J\n    delta_theta = theta_f - theta_0\n\n    # Calculate theta_stop: the angle reached if max braking is applied from the start.\n    if np.isclose(omega_0, 0.0):\n        theta_stop = theta_0\n    else:\n        theta_stop = theta_0 + (omega_0 * abs(omega_0)) / (2 * alpha)\n    \n    delta = theta_f - theta_stop\n\n    # Case 1: On the switching curve (single bang, pure braking).\n    # A small tolerance is used for floating-point comparison.\n    if np.isclose(delta, 0.0):\n        t1 = 0.0\n        t2 = abs(omega_0) / alpha\n        # The control is u = -sgn(omega_0)*tau_max. In our formulation, this\n        # corresponds to the second arc u = -sigma*tau_max.\n        # So, -sigma = -sgn(omega_0), which implies sigma = sgn(omega_0).\n        sigma = np.sign(omega_0)\n        if sigma == 0: # If omega_0 is exactly 0, handle with convention.\n            sigma = 1 if delta_theta > 0 else -1\n\n    # Case 2: Not on the switching curve (bang-bang trajectory).\n    else:\n        sigma = 1 if delta > 0 else -1\n\n        # Calculate t2 from the derived formula. Radicand is guaranteed non-negative.\n        t2_sq = (sigma * delta_theta) / alpha + (omega_0**2) / (2 * alpha**2)\n        # Handle potential small negative values due to floating point inaccuracies\n        t2 = math.sqrt(max(0, t2_sq))\n        \n        # Calculate t1. This is also guaranteed non-negative.\n        t1 = t2 - (sigma * omega_0) / alpha\n    \n    T_star = t1 + t2\n    \n    return [T_star, t1, t2, int(sigma), has_singular]\n\ndef format_result(result_list):\n    \"\"\"\n    Formats a single result list into the required string format,\n    rounding floats to 9 decimal places.\n    \"\"\"\n    T_star, t1, t2, sigma, has_singular = result_list\n    return f\"[{T_star:.9f}, {t1:.9f}, {t2:.9f}, {sigma}, {str(has_singular).lower()}]\"\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2690322"}, {"introduction": "并非所有最优控制问题都具有纯粹的“砰砰”解。当切换函数在某个时间段内恒为零时，便会出现奇异弧，此时的最优控制量将处于其边界值之间。本练习以一个简化的火箭燃料最优上升模型为背景，将训练你通过对切换函数求导来推导奇异控制律的核心技能，这对于处理非纯“砰砰”结构的最优控制问题至关重要 [@problem_id:2690328]。", "problem": "考虑以下燃料最优上升模型（一个简化的Goddard型火箭，具有线性阻力和可变质量）。状态为 $x(t) = (h(t), v(t), m(t))$，其中 $h$ 是高度，$v$ 是垂直速度，$m$ 是飞行器质量。控制是推力 $T(t)$，其约束为 $0 \\leq T(t) \\leq T_{\\max}$。动力学方程为\n$$\n\\dot{h}(t) = v(t), \\quad\n\\dot{v}(t) = \\frac{T(t)}{m(t)} - g - \\frac{k}{m(t)}\\,v(t), \\quad\n\\dot{m}(t) = -\\alpha\\,T(t),\n$$\n其中 $g0$ 是重力加速度，$k0$ 是线性阻力系数（阻力为 $k\\,v$），$\\alpha = \\frac{1}{c}  0$ 是有效排气速度 $c$ 的倒数，因此 $\\alpha v$ 是无量纲的。待最小化的性能指标是总燃料消耗，\n$$\nJ = \\int_{0}^{t_f} T(t)\\,dt,\n$$\n其边界条件为 $h(0)=0$，$v(0)=0$，$m(0)=m_00$，终端约束为 $h(t_f)=h_f$ 且 $v(t_f)=0$，而 $m(t_f)$ 是自由的。假设此问题的最优极值（在Pontryagin极大值原理 (PMP) 的意义上）表现出具有非平凡内部奇异弧的多阶段bang-奇异-bang结构。\n\n从Pontryagin极大值原理的基本必要条件出发，并且不借助任何预先推导的奇异控制公式，推导内部奇异弧上奇异推力 $T_s$ 作为瞬时速度 $v$、质量 $m$ 以及参数 $g$、$k$ 和 $\\alpha$ 的函数的显式闭式表达式。您可以假设适当阶数的广义Legendre–Clebsch条件成立，从而对开关函数进行足够多次微分可以得到一个确定奇异弧上控制的代数条件。以国际单位制 (SI) 表示推力的最终表达式，使推力的单位为牛顿。您的最终答案必须是单一的闭式解析表达式。", "solution": "我们应用Pontryagin极大值原理 (PMP) 来处理一个被积函数为 $L(x,u) = T$ 的最小化问题。用于最小化的哈密顿量为\n$$\nH(x,p,u) \\;=\\; L(x,u) + p_h\\,\\dot{h} + p_v\\,\\dot{v} + p_m\\,\\dot{m}\n\\;=\\; T + p_h\\,v + p_v\\!\\left(\\frac{T}{m} - g - \\frac{k}{m}\\,v\\right) + p_m\\,(-\\alpha T),\n$$\n其中 $p = (p_h, p_v, p_m)$ 是协态。控制 $T$ 在哈密顿量中是仿射的。对于 $H$ 在 $T \\in [0, T_{\\max}]$ 上的最小化，定义开关函数\n$$\n\\varphi \\;=\\; \\frac{\\partial H}{\\partial T} \\;=\\; 1 + \\frac{p_v}{m} - \\alpha\\,p_m.\n$$\n逐点最小化控制为\n$$\nT^\\star =\n\\begin{cases}\n0,  \\varphi  0,\\\\\nT_{\\max},  \\varphi  0,\\\\\n\\text{奇异控制,}  \\varphi = 0 \\text{ 在一个区间上。}\n\\end{cases}\n$$\n在任何奇异弧上，$\\varphi(t) \\equiv 0$ 在一个非平凡区间上成立，并且 $\\varphi$ 的更高阶时间导数直至控制出现并可求解的阶数都为零。\n\n我们从 $\\dot{p} = -\\frac{\\partial H}{\\partial x}$ 计算协态方程：\n- 对于 $h$，由于 $H$ 不依赖于 $h$，我们有\n$$\n\\dot{p}_h \\;=\\; -\\frac{\\partial H}{\\partial h} \\;=\\; 0 \\quad \\Rightarrow \\quad p_h \\text{ 在每段弧上是常数。}\n$$\n- 对于 $v$，我们有\n$$\n\\frac{\\partial H}{\\partial v} \\;=\\; p_h + p_v \\frac{\\partial}{\\partial v}\\!\\left(\\frac{T}{m} - g - \\frac{k}{m}v\\right) \\;=\\; p_h - \\frac{k}{m}\\,p_v,\n$$\n因此\n$$\n\\dot{p}_v \\;=\\; -\\frac{\\partial H}{\\partial v} \\;=\\; -p_h + \\frac{k}{m}\\,p_v.\n$$\n- 对于 $m$，注意 $\\frac{\\partial}{\\partial m}\\left(\\frac{T}{m} - g - \\frac{k}{m}v\\right) = -\\frac{T - k v}{m^2}$，因此\n$$\n\\frac{\\partial H}{\\partial m} \\;=\\; p_v \\left(-\\frac{T - k v}{m^2}\\right),\n\\quad \\Rightarrow \\quad\n\\dot{p}_m \\;=\\; -\\frac{\\partial H}{\\partial m} \\;=\\; p_v\\,\\frac{T - k v}{m^2}.\n$$\n状态动力学方程包括 $\\dot{m} = -\\alpha T$。\n\n在奇异弧上，$\\varphi \\equiv 0$ 且其逐次时间导数均为零，直到控制显式地出现。从\n$$\n\\varphi \\;=\\; 1 + \\frac{p_v}{m} - \\alpha p_m \\;=\\; 0.\n$$\n开始。\n求导一次：\n$$\n\\dot{\\varphi} \\;=\\; \\frac{d}{dt}\\!\\left(\\frac{p_v}{m}\\right) - \\alpha \\dot{p}_m\n\\;=\\; \\frac{\\dot{p}_v\\,m - p_v \\dot{m}}{m^2} - \\alpha \\dot{p}_m.\n$$\n代入 $\\dot{p}_v = -p_h + \\frac{k}{m}p_v$，$\\dot{m} = -\\alpha T$ 和 $\\dot{p}_m = p_v \\frac{T - k v}{m^2}$：\n\\begin{align*}\n\\dot{\\varphi}\n= \\frac{m\\!\\left(-p_h + \\frac{k}{m}p_v\\right) - p_v(-\\alpha T)}{m^2} - \\alpha \\left( p_v \\frac{T - k v}{m^2} \\right) \\\\\n= \\frac{-m p_h + k p_v + \\alpha T p_v}{m^2} - \\frac{\\alpha T p_v}{m^2} + \\frac{\\alpha k v p_v}{m^2} \\\\\n= -\\frac{p_h}{m} + \\frac{k}{m^2} p_v + \\frac{\\alpha k v}{m^2} p_v.\n\\end{align*}\n因此，\n$$\n\\dot{\\varphi} \\;=\\; -\\frac{p_h}{m} + \\frac{k}{m^2} p_v (1 + \\alpha v).\n$$\n在奇异弧上，$\\dot{\\varphi} \\equiv 0$，这给出了代数关系\n$$\np_h \\;=\\; \\frac{k}{m}\\,p_v\\,(1 + \\alpha v).\n$$\n再次对 $\\dot{\\varphi}$ 求导以显化控制 $T$。使用 $p_h$ 为常数，$\\dot{m} = -\\alpha T$，$\\dot{v} = \\frac{T - k v}{m} - g$ 以及 $\\dot{p}_v = -p_h + \\frac{k}{m}p_v$ 来计算\n\\begin{align*}\n\\ddot{\\varphi}\n= \\frac{d}{dt}\\!\\left(-\\frac{p_h}{m} + \\frac{k}{m^2} p_v (1 + \\alpha v)\\right) \\\\\n= -p_h \\frac{d}{dt}\\!\\left(\\frac{1}{m}\\right)\n+ \\frac{d}{dt}\\!\\left(\\frac{k}{m^2}\\right)\\! p_v (1 + \\alpha v)\n+ \\frac{k}{m^2} \\dot{p}_v (1 + \\alpha v)\n+ \\frac{k}{m^2} p_v \\alpha \\dot{v}.\n\\end{align*}\n逐项计算，使用 $\\frac{d}{dt}(1/m) = -\\dot{m}/m^2 = \\alpha T/m^2$ 和 $\\frac{d}{dt}(1/m^2) = -2 \\dot{m}/m^3 = 2\\alpha T/m^3$，我们得到\n\\begin{align*}\n\\ddot{\\varphi}\n= -p_h \\left(\\frac{\\alpha T}{m^2}\\right)\n+ \\left(\\frac{2 k \\alpha T}{m^3}\\right) p_v (1 + \\alpha v)\n+ \\frac{k}{m^2}\\left(-p_h + \\frac{k}{m}p_v\\right) (1 + \\alpha v)\n+ \\frac{k}{m^2} p_v \\alpha \\left(\\frac{T - k v}{m} - g\\right).\n\\end{align*}\n收集与 $T$ 成比例的项：\n\\begin{align*}\n\\ddot{\\varphi}\n= \\alpha T \\left[ -\\frac{p_h}{m^2}\n+ \\frac{2 k}{m^3} p_v (1 + \\alpha v)\n+ \\frac{k}{m^2} p_v \\left(\\frac{1}{m}\\right) \\right]\n+ \\frac{k}{m^2}\\left(-p_h + \\frac{k}{m}p_v\\right) (1 + \\alpha v)\n+ \\frac{k}{m^2} p_v \\alpha \\left( - \\frac{k v}{m} - g\\right),\n\\end{align*}\n此处我们将最后一个括号分离为其含 $T$ 和不含 $T$ 的部分。通过合并第二项和第四项中含 $T$ 的部分来简化 $T$ 的系数：\n\\begin{align*}\n\\text{$T$的系数} = \\alpha \\left[ -\\frac{p_h}{m^2} + \\frac{2 k}{m^3} p_v (1 + \\alpha v) + \\frac{k}{m^3} p_v \\right] \\\\\n= \\alpha \\left[ -\\frac{p_h}{m^2} + \\frac{k p_v}{m^3} (3 + 2 \\alpha v) \\right].\n\\end{align*}\n余下的不含 $T$ 的项是\n\\begin{align*}\n\\text{不含$T$的项}\n= \\frac{k}{m^2}\\left(-p_h + \\frac{k}{m}p_v\\right) (1 + \\alpha v)\n+ \\frac{k}{m^2} p_v \\alpha \\left( - \\frac{k v}{m} - g\\right).\n\\end{align*}\n在奇异弧上，我们还要求 $\\dot{\\varphi} = 0$，这给出了\n$$\np_h \\;=\\; \\frac{k}{m}\\,p_v\\,(1 + \\alpha v).\n$$\n将此式代入 $T$ 的系数和不含 $T$ 的项中：\n\n1) $T$的系数：\n\\begin{align*}\n\\alpha \\left[ -\\frac{p_h}{m^2} + \\frac{k p_v}{m^3} (3 + 2 \\alpha v) \\right]\n= \\alpha \\left[ -\\frac{1}{m^2} \\left(\\frac{k}{m} p_v (1 + \\alpha v)\\right) + \\frac{k p_v}{m^3} (3 + 2 \\alpha v) \\right] \\\\\n= \\alpha \\left[ \\frac{k p_v}{m^3} \\big( - (1 + \\alpha v) + (3 + 2 \\alpha v)\\big) \\right] \\\\\n= \\alpha \\left[ \\frac{k p_v}{m^3} (2 + \\alpha v) \\right].\n\\end{align*}\n\n2) 不含$T$的项：\n\\begin{align*}\n\\frac{k}{m^2}\\left(-p_h + \\frac{k}{m}p_v\\right) (1 + \\alpha v)\n= \\frac{k}{m^2}\\left( - \\frac{k}{m} p_v (1 + \\alpha v) + \\frac{k}{m} p_v \\right) (1 + \\alpha v) \\\\\n= \\frac{k}{m^2}\\left( \\frac{k}{m} p_v \\big(- (1 + \\alpha v) + 1\\big) \\right) (1 + \\alpha v) \\\\\n= -\\,\\frac{\\alpha k^2 v}{m^3}\\,p_v\\,(1 + \\alpha v),\n\\end{align*}\n和\n\\begin{align*}\n\\frac{k}{m^2} p_v \\alpha \\left( - \\frac{k v}{m} - g\\right)\n= - \\frac{\\alpha k}{m^2} p_v \\left( \\frac{k v}{m} + g \\right).\n\\end{align*}\n将两部分不含 $T$ 的项相加：\n\\begin{align*}\n\\text{不含$T$的项}\n= -\\,\\frac{\\alpha k^2 v}{m^3}\\,p_v\\,(1 + \\alpha v)\n- \\frac{\\alpha k}{m^2} p_v \\left( \\frac{k v}{m} + g \\right) \\\\\n= - \\frac{\\alpha k p_v}{m^3} \\left[ k v (1 + \\alpha v) + k v + g m \\right] \\\\\n= - \\frac{\\alpha k p_v}{m^3} \\left[ k v (2 + \\alpha v) + g m \\right].\n\\end{align*}\n因此，\n$$\n\\ddot{\\varphi}\n= \\underbrace{\\alpha \\left[ \\frac{k p_v}{m^3} (2 + \\alpha v) \\right]}_{\\text{$T$的系数}}\\,T\n\\;+\\; \\underbrace{\\left( - \\frac{\\alpha k p_v}{m^3} \\left[ k v (2 + \\alpha v) + g m \\right] \\right)}_{\\text{不含$T$的项}}.\n$$\n在奇异弧上，$\\ddot{\\varphi} \\equiv 0$。若广义Legendre–Clebsch条件成立，使得上述 $T$ 的系数非零，我们就可以通过代数方法求解奇异控制：\n\\begin{align*}\n0 = \\alpha \\left[ \\frac{k p_v}{m^3} (2 + \\alpha v) \\right] T_s\n- \\frac{\\alpha k p_v}{m^3} \\left[ k v (2 + \\alpha v) + g m \\right], \\\\\nT_s = \\frac{ k v (2 + \\alpha v) + g m }{ 2 + \\alpha v } \\\\\n= k v \\;+\\; \\frac{g m}{2 + \\alpha v}.\n\\end{align*}\n这就是内部奇异弧上的显式奇异推力，用瞬时 $v$、$m$ 以及参数 $g$、$k$ 和 $\\alpha$ 表示。在国际单位制中，当 $g$ 的单位是 $\\text{m}\\,\\text{s}^{-2}$，$m$ 的单位是 $\\text{kg}$，$k$ 的单位是 $\\text{N}\\,\\text{s}\\,\\text{m}^{-1}$，且 $\\alpha = 1/c$ 的单位是 $\\text{s}\\,\\text{m}^{-1}$ 时，$T_s$ 的单位是牛顿，这确保了 $\\alpha v$ 是无量纲的。", "answer": "$$\\boxed{k\\,v+\\frac{g\\,m}{2+\\alpha\\,v}}$$", "id": "2690328"}, {"introduction": "最优控制理论不仅能用于设计控制器，还能反过来作为一种诊断工具。砰砰控制中可预测的切换行为模式蕴含着系统动力学的深刻信息。本练习将颠覆传统视角，指导你如何通过分析观测到的切换时间序列来辨识系统模型中的未知参数，从而架起理论分析与实验数据处理之间的桥梁 [@problem_id:2690329]。", "problem": "考虑一个单输入线性时不变系统的最短时间控制问题，其动力学方程为\n$$\n\\dot{x}(t) = A(\\alpha)\\,x(t) + B\\,u(t),\n$$\n其中 $x(t) \\in \\mathbb{R}^2$，$u(t) \\in \\mathbb{R}$ 且满足约束 $|u(t)| \\leq 1$，以及\n$$\nA(\\alpha) = \\begin{bmatrix} 0  1 \\\\ \\alpha  0 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}.\n$$\n标量参数 $\\alpha$ 未知且为常数，其物理量纲为时间的平方分之一，即 $\\mathrm{s}^{-2}$。假设目标是在最短时间内将状态从任意初始条件驱动到原点，并且庞特里亚金极大值原理（PMP）适用。根据 PMP，定义开关函数\n$$\n\\varphi(t) := B^\\top p(t),\n$$\n其中 $p(t)$ 是与哈密顿量 $H(x,p,u) = p^\\top(A(\\alpha)x + Bu) + 1$ 相关联的协态向量。对于此系统，最优控制是邦-邦控制，由 $\\varphi(t)$ 的符号决定，其开关时间等于 $\\varphi(t)$ 的零点。\n\n您观测到一系列以秒为单位的开关时间 $\\{t_k\\}_{k=0}^{N-1}$，这些时间对应于 $\\varphi(t)$ 的过零点。初始时间偏移是未知的，并且可能存在附加的测量噪声。在某些实验中，仅记录每第 $m$ 个开关时间，其中 $m \\in \\mathbb{N}$ 是给定的；也就是说，观测到的序列为 $t_k \\approx t_0 + k\\,(m\\,\\Delta)$，其中时间偏移 $t_0$ 和基本间距 $\\Delta  0$ 均未知。\n\n仅从最优控制的基本定义（庞特里亚金极大值原理、伴随动力学和开关函数的定义）出发，推导一种根据观测到的开关时间来辨识未知参数 $\\alpha$ 的方法。您的推导必须解释为什么当 $\\alpha  0$ 时开关间隔是恒定的，它如何依赖于 $\\alpha$，以及为什么该估计方法对于未知的时间偏移和按已知整数因子 $m$ 进行的子采样均具有鲁棒性。然后，设计一个算法，该算法：\n- 以观测到的开关时间列表 $\\{t_k\\}$（单位：秒）和整数 $m$ 作为输入，\n- 估计参数 $\\alpha$（单位：$\\mathrm{s}^{-2}$），\n- 对于无噪声数据是一致的，并且当存在微小的附加时间噪声时，对于仿射拟合是最小二乘最优的，\n- 至少需要两个观测到的开关时间。\n\n实现要求：\n- 将您的算法实现为一个完整的、可运行的程序，如最终答案中所示。\n- 对于下面的每个测试用例，计算估计值 $\\hat{\\alpha}$（单位：$\\mathrm{s}^{-2}$）并四舍五入到六位小数。\n\n测试套件（每个用例提供一个以秒为单位的观测开关时间列表和相应的 $m$）：\n1. 用例 1（基准，无噪声，连续开关）：时间 $= [\\,0.35, 1.9207963267948966, 3.491592653589793, 5.06238898038469, 6.633185307179586, 8.203981633974483\\,]$, $m = 1$.\n2. 用例 2（连续开关，带微小附加噪声）：时间 $= [\\,0.12, 3.231592653589793, 6.398185307179586, 9.51977796076938, 12.666370614359172\\,]$, $m = 1$.\n3. 用例 3（每隔一个开关观测一次，即子采样）：时间 $= [\\,0.25, 2.3443951023931953, 4.438790204786391, 6.533185307179586, 8.627580409572781\\,]$, $m = 2$.\n4. 用例 4（数据点少，开关间隔大）：时间 $= [\\,1.0, 16.707963267948966\\,]$, $m = 1$.\n5. 用例 5（每隔两个开关观测一次，带微小附加噪声）：时间 $= [\\,0.69, 11.191975511965977, 21.628951023931956, 32.11592653589793\\,]$, $m = 3$.\n\n角度单位：弧度。时间单位：秒。参数 $\\alpha$ 单位：$\\mathrm{s}^{-2}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表；例如，$[\\,\\text{result}_1,\\text{result}_2,\\ldots\\,]$。\n- 每个 $\\hat{\\alpha}$ 必须四舍五入到六位小数。", "solution": "问题陈述经评估有效。它在科学上基于最优控制理论的原理，在数学上是适定的，客观的，并为推导参数估计算法提供了一个自洽、一致的框架。\n\n辨识参数 $\\alpha$ 的方法的推导始于最优控制理论的基本原理，特别是庞特里亚金极大值原理（PMP）。系统动力学由 $\\dot{x}(t) = A(\\alpha)x(t) + B u(t)$ 给出，其中状态 $x(t) = [x_1(t), x_2(t)]^\\top \\in \\mathbb{R}^2$，控制 $|u(t)| \\le 1$，矩阵为\n$$\nA(\\alpha) = \\begin{bmatrix} 0  1 \\\\ \\alpha  0 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}.\n$$\n目标是在最短时间内到达原点 $x=0$。该问题的哈密顿量为 $H(x,p,u) = 1 + p^\\top(A(\\alpha)x + Bu)$，其中 $p(t) = [p_1(t), p_2(t)]^\\top$ 是协态向量。展开后可得：\n$$\nH = 1 + p_1(t) x_2(t) + p_2(t) (\\alpha x_1(t) + u(t)).\n$$\n协态动力学由伴随方程 $\\dot{p}(t) = -\\frac{\\partial H}{\\partial x}(x, p, u)$ 控制：\n$$\n\\dot{p}_1(t) = -\\frac{\\partial H}{\\partial x_1} = -\\alpha p_2(t)\n$$\n$$\n\\dot{p}_2(t) = -\\frac{\\partial H}{\\partial x_2} = -p_1(t)\n$$\n最优控制 $u^*(t)$ 必须在所有时间 $t$ 上使哈密顿量最大化。在 $H$ 中涉及 $u(t)$ 的项是 $p_2(t)u(t)$。为使其最大化，在约束 $|u(t)| \\le 1$ 下，控制必须是 $u^*(t) = \\mathrm{sgn}(p_2(t))$。然而，对于最短时间问题，控制律通常为 $u^*(t) = -\\mathrm{sgn}(B^\\top p(t))$，这在哈密顿量表示为 $H = p^\\top f + p_0 L$ 且 $p_0  0$ 时使其最小化。问题将开关函数定义为 $\\varphi(t) := B^\\top p(t)$，对于我们给定的 $B$ 矩阵，它变为：\n$$\n\\varphi(t) = \\begin{bmatrix} 0  1 \\end{bmatrix} \\begin{bmatrix} p_1(t) \\\\ p_2(t) \\end{bmatrix} = p_2(t).\n$$\n最优控制是邦-邦控制，$u^*(t) = -\\mathrm{sgn}(\\varphi(t))$，当开关函数 $\\varphi(t)$ 过零时，其值发生切换。为了理解这些开关的时刻，我们必须分析 $\\varphi(t)$ 的动力学。\n\n通过对 $\\varphi(t)=p_2(t)$ 求导并使用伴随方程，我们可以找到 $\\varphi(t)$ 的控制微分方程：\n对 $\\varphi(t)$ 求导得到 $\\dot{\\varphi}(t) = \\dot{p}_2(t) = -p_1(t)$。\n再次求导得到 $\\ddot{\\varphi}(t) = -\\dot{p}_1(t)$。\n代入 $\\dot{p}_1(t)$ 的方程：$\\ddot{\\varphi}(t) = -(-\\alpha p_2(t)) = \\alpha p_2(t) = \\alpha \\varphi(t)$。\n这就得到了关于开关函数的齐次二阶线性常微分方程：\n$$\n\\ddot{\\varphi}(t) - \\alpha \\varphi(t) = 0.\n$$\n解的性质取决于 $\\alpha$ 的符号。问题描述了观测到一系列的多个开关时间。这意味着 $\\varphi(t)$ 必须有多个过零点。\n如果 $\\alpha \\ge 0$，通解为 $\\varphi(t) = C_1 e^{\\sqrt{\\alpha}t} + C_2 e^{-\\sqrt{\\alpha}t}$（如果 $\\alpha=0$，则为 $\\varphi(t) = C_1 t + C_2$）。这样的函数最多只有一个零点，这意味着最多只能发生一次控制切换。这与观测到一系列开关的前提相矛盾。因此，我们必须有 $\\alpha  0$。\n\n对于 $\\alpha  0$，我们定义 $\\alpha = -\\omega^2$，其中 $\\omega = \\sqrt{-\\alpha}  0$。该常微分方程变为：\n$$\n\\ddot{\\varphi}(t) + \\omega^2 \\varphi(t) = 0.\n$$\n这是一个简谐振子的方程。其通解是正弦形式的：\n$$\n\\varphi(t) = C \\sin(\\omega t + \\phi_0),\n$$\n其中振幅 $C$ 和相位 $\\phi_0$ 由协态向量的初始条件决定。开关时间 $\\{t_k\\}$ 是 $\\varphi(t)$ 的零点，出现在以下情况：\n$$\n\\omega t_k + \\phi_0 = k\\pi, \\quad k \\in \\mathbb{Z}.\n$$\n求解 $t_k$，我们得到 $t_k = \\frac{k\\pi - \\phi_0}{\\omega}$。任意两个连续开关 $t_{k+1}$ 和 $t_k$ 之间的时间间隔 $\\Delta$ 是恒定的：\n$$\n\\Delta = t_{k+1} - t_k = \\frac{(k+1)\\pi - \\phi_0}{\\omega} - \\frac{k\\pi - \\phi_0}{\\omega} = \\frac{\\pi}{\\omega}.\n$$\n代入 $\\omega = \\sqrt{-\\alpha}$，我们找到了开关间隔 $\\Delta$ 和参数 $\\alpha$ 之间的直接关系：\n$$\n\\Delta = \\frac{\\pi}{\\sqrt{-\\alpha}} \\implies \\alpha = -\\left(\\frac{\\pi}{\\Delta}\\right)^2.\n$$\n这个推导解释了为什么当 $\\alpha  0$ 时，开关间隔是恒定的，以及它如何依赖于 $\\alpha$。\n\n问题指出，观测到的开关时间，我们称之为 $T_k$，与一个具有恒定间距 $m\\Delta$ 的底层序列相关，其中 $m$ 是一个已知的整数子采样因子。该模型为 $T_k \\approx T_{\\text{offset}} + k \\cdot (m\\Delta)$，其中 $T_{\\text{offset}}$ 是一个未知的时间偏移。这是观测时间 $T_k$ 与其索引 $k = 0, 1, 2, \\ldots, N-1$ 之间的线性关系。\n我们可以将此关系建模为 $T_k = a + b k$，其中 $a$ 是截距（对应于未知的偏移量 $T_{\\text{offset}}$），$b$ 是斜率（对应于观测到的间距 $m\\Delta$）。\n\n为了估计 $\\alpha$，我们首先需要估计斜率 $b$。给定一组 $N$ 个数据点 $(k, T_k)$，简单线性回归为斜率提供了最小二乘最优估计。斜率 $\\hat{b}$ 的公式是：\n$$\n\\hat{b} = \\frac{N \\sum_{k=0}^{N-1} (k T_k) - (\\sum_{k=0}^{N-1} k)(\\sum_{k=0}^{N-1} T_k)}{N \\sum_{k=0}^{N-1} k^2 - (\\sum_{k=0}^{N-1} k)^2}.\n$$\n该方法具有鲁棒性，原因如下：\n1.  **对未知时间偏移的鲁棒性**：线性回归模型 $T_k = a + b k$ 包含一个截距项 $a$。斜率 $b$ 的估计在数学上独立于数据 $T_k$ 中的任何恒定偏移。截距 $a$ 简单地吸收了未知的时间偏移。\n2.  **对子采样的鲁棒性**：估计的斜率 $\\hat{b}$ 对应于观测到的间距，即 $m\\Delta$。由于子采样因子 $m$ 是已知的，我们可以通过 $\\hat{\\Delta} = \\hat{b}/m$ 恢复对基本间距 $\\Delta$ 的估计。$\\alpha$ 的计算将正确使用此信息。\n3.  **对微小附加噪声的鲁棒性**：在假设噪声均值为零的情况下，使用最小二乘线性回归是拟合受附加噪声破坏的数据点的标准且统计上最优的方法。它最小化了误差平方和，在常见的统计假设下为斜率提供了最佳线性无偏估计。\n\n一旦从数据中估计出斜率 $\\hat{b}$，我们就有了 $\\hat{b} \\approx m\\Delta$。这给出了对基本间距的估计 $\\hat{\\Delta} = \\hat{b}/m$。将此代入我们关于 $\\alpha$ 的公式中：\n$$\n\\hat{\\alpha} = -\\left(\\frac{\\pi}{\\hat{\\Delta}}\\right)^2 = -\\left(\\frac{\\pi}{\\hat{b}/m}\\right)^2 = -\\left(\\frac{m\\pi}{\\hat{b}}\\right)^2.\n$$\n这就是 $\\alpha$ 的估计量的最终表达式。算法如下：\n1. 给定一个包含 $N \\ge 2$ 个观测开关时间的列表 $\\{T_k\\}_{k=0}^{N-1}$ 以及一个整数 $m$。\n2. 构建数据点集合 $(k, T_k)$，其中 $k=0, 1, \\ldots, N-1$。\n3. 对这些数据进行线性回归以找到斜率 $\\hat{b}$。\n4. 使用公式 $\\hat{\\alpha} = -(m\\pi/\\hat{b})^2$ 计算估计值 $\\hat{\\alpha}$。\n\n该算法对于无噪声数据是一致的，并为带有微小附加噪声的仿射数据模型提供了最小二乘最优估计。\n该算法将应用于每个提供的测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the parameter alpha for a series of test cases based on \n    observed switching times in a minimum-time optimal control problem.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (baseline, noise-free, consecutive switches)\n        ([0.35, 1.9207963267948966, 3.491592653589793, 5.06238898038469, 6.633185307179586, 8.203981633974483], 1),\n        # Case 2 (consecutive switches with small additive noise)\n        ([0.12, 3.231592653589793, 6.398185307179586, 9.51977796076938, 12.666370614359172], 1),\n        # Case 3 (every second switch observed, i.e., sub-sampling)\n        ([0.25, 2.3443951023931953, 4.438790204786391, 6.533185307179586, 8.627580409572781], 2),\n        # Case 4 (few points, large inter-switch spacing)\n        ([1.0, 16.707963267948966], 1),\n        # Case 5 (every third switch observed with small additive noise)\n        ([0.69, 11.191975511965977, 21.628951023931956, 32.11592653589793], 3)\n    ]\n\n    results = []\n    \n    for times, m in test_cases:\n        # Convert list of times to a NumPy array for vectorized operations.\n        times_array = np.array(times)\n        num_points = len(times_array)\n\n        # The independent variable is the sequence of observation indices k = 0, 1, 2, ...\n        k_indices = np.arange(num_points)\n\n        # Perform simple linear regression of times vs. indices.\n        # The model is t_k = intercept + slope * k.\n        # np.polyfit(x, y, 1) returns [slope, intercept].\n        # The slope corresponds to the observed inter-switch spacing, m*Delta.\n        slope, _ = np.polyfit(k_indices, times_array, 1)\n        \n        b_hat = slope\n        \n        # From the derivation, alpha = - (m * pi / b_hat)^2.\n        # This formula directly uses the estimated slope b_hat and the known\n        # sub-sampling factor m.\n        # We assume b_hat > 0, as switching times are expected to be increasing.\n        if b_hat > 0:\n            alpha_hat = - (m * np.pi / b_hat)**2\n        else:\n            # This case indicates non-physical data (e.g., non-increasing times)\n            # and is not expected given the problem description.\n            alpha_hat = np.nan\n\n        # Round the result to six decimal places as required.\n        rounded_alpha = round(alpha_hat, 6)\n        results.append(str(rounded_alpha))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2690329"}]}