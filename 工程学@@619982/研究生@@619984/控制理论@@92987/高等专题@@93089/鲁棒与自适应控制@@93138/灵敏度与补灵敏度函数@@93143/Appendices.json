{"hands_on_practices": [{"introduction": "本练习是一个基础性实践，旨在描绘标准反馈系统的完整输入输出行为。通过推导所有六个关键传递函数（通常称为“六点组”传递函数），你将全面理解闭环系统如何响应参考指令、扰动和测量噪声 [@problem_id:2744189]。这种系统性的方法对于分析控制设计中固有的权衡至关重要，特别是控制器特性（如积分作用）如何转化为具体的性能指标（如低频扰动抑制）。", "problem": "考虑一个具有单位负反馈的单输入单输出线性时不变反馈回路。被控对象为 $P(s)=\\dfrac{10}{(s+1)(s+2)}$，补偿器为 $K(s)=\\dfrac{s+3}{s}$。一个确定性扰动 $d(t)$ 加性地作用于被控对象输入端，一个测量噪声 $n(t)$ 加性地作用于传感器，因此测量输出为 $y(t)+n(t)$。设 $r(t)$ 为参考输入。用 $R(s)$、$D(s)$、$N(s)$、$Y(s)$ 和 $U(s)$ 分别表示它们的拉普拉斯变换。\n\n仅从通过 $K(s)$ 和 $P(s)$ 关联 $e(t)$、$u(t)$ 和 $y(t)$ 的基本回路方程出发，推导从 $r$、$d$ 和 $n$ 到输出 $y$ 和控制输入 $u$ 的闭环传递函数。具体来说，以完全简化的有理分式形式求出 $G_{yr}(s)=\\dfrac{Y(s)}{R(s)}$、$G_{yd}(s)=\\dfrac{Y(s)}{D(s)}$、$G_{yn}(s)=\\dfrac{Y(s)}{N(s)}$、$G_{ur}(s)=\\dfrac{U(s)}{R(s)}$、$G_{ud}(s)=\\dfrac{U(s)}{D(s)}$ 和 $G_{un}(s)=\\dfrac{U(s)}{N(s)}$。\n\n然后，通过计算极限 $\\lim_{s \\to 0} G_{yd}(s)$ 来确定扰动到输出映射的低频特性，并简要解释其对低频扰动抑制的意义。\n\n将您的最终结果报告为按顺序排列的六个传递函数 $\\big(G_{yr}(s),\\,G_{yd}(s),\\,G_{yn}(s),\\,G_{ur}(s),\\,G_{ud}(s),\\,G_{un}(s)\\big)$，后随单个数值 $\\lim_{s \\to 0} G_{yd}(s)$，所有结果均以 $s$ 的解析表达式形式给出。无需进行数值四舍五入，也无需单位。", "solution": "该系统是一个单输入单输出(SISO)线性时不变(LTI)反馈回路。根据问题描述，可以建立起在拉普拉斯域中控制各信号之间关系的基本方程。\n\n测量输出是被控对象输出 $Y(s)$ 和测量噪声 $N(s)$ 的和。在单位负反馈下，作为补偿器 $K(s)$ 输入的误差信号 $E(s)$ 由下式给出：\n$$E(s) = R(s) - (Y(s) + N(s))$$\n控制信号 $U(s)$ 是补偿器的输出：\n$$U(s) = K(s) E(s)$$\n扰动 $D(s)$ 在被控对象输入端与控制信号相加。因此，输入到被控对象 $P(s)$ 的总信号是 $U(s) + D(s)$。被控对象的输出 $Y(s)$ 因而为：\n$$Y(s) = P(s) (U(s) + D(s))$$\n\n这三个方程构成了关于信号 $Y(s)$ 和 $U(s)$ 的线性方程组，其外部输入为 $R(s)$、$D(s)$ 和 $N(s)$。我们求解这个方程组。\n\n首先，我们求解输出 $Y(s)$。将 $E(s)$ 的表达式代入 $U(s)$ 的方程中：\n$$U(s) = K(s) [R(s) - Y(s) - N(s)]$$\n接下来，将这个 $U(s)$ 的表达式代入 $Y(s)$ 的方程中：\n$$Y(s) = P(s) \\left( K(s) [R(s) - Y(s) - N(s)] + D(s) \\right)$$\n$$Y(s) = P(s)K(s)R(s) - P(s)K(s)Y(s) - P(s)K(s)N(s) + P(s)D(s)$$\n为了分离出 $Y(s)$，我们将所有包含 $Y(s)$ 的项移到等式的一边：\n$$Y(s) + P(s)K(s)Y(s) = P(s)K(s)R(s) + P(s)D(s) - P(s)K(s)N(s)$$\n$$Y(s)(1 + P(s)K(s)) = P(s)K(s)R(s) + P(s)D(s) - P(s)K(s)N(s)$$\n求解 $Y(s)$ 可得：\n$$Y(s) = \\frac{P(s)K(s)}{1+P(s)K(s)}R(s) + \\frac{P(s)}{1+P(s)K(s)}D(s) - \\frac{P(s)K(s)}{1+P(s)K(s)}N(s)$$\n\n接下来，我们求解控制信号 $U(s)$。我们使用关系式 $U(s) = K(s)[R(s) - Y(s) - N(s)]$：\n$$U(s) = K(s)R(s) - K(s)N(s) - K(s)Y(s)$$\n代入已推导出的 $Y(s)$ 表达式：\n$$U(s) = K(s)R(s) - K(s)N(s) - K(s)\\left( \\frac{P(s)K(s)}{1+P(s)K(s)}R(s) + \\frac{P(s)}{1+P(s)K(s)}D(s) - \\frac{P(s)K(s)}{1+P(s)K(s)}N(s) \\right)$$\n按输入 $R(s)$、$D(s)$ 和 $N(s)$ 对各项进行分组：\n对于 $R(s)$： $K(s) - \\frac{K(s)P(s)K(s)}{1+P(s)K(s)} = K(s)\\left(1 - \\frac{P(s)K(s)}{1+P(s)K(s)}\\right) = K(s)\\left(\\frac{1}{1+P(s)K(s)}\\right) = \\frac{K(s)}{1+P(s)K(s)}$\n对于 $D(s)$： $-\\frac{K(s)P(s)}{1+P(s)K(s)}$\n对于 $N(s)$： $-K(s) - K(s)\\left(-\\frac{P(s)K(s)}{1+P(s)K(s)}\\right) = -K(s)\\left(1 - \\frac{P(s)K(s)}{1+P(s)K(s)}\\right) = -\\frac{K(s)}{1+P(s)K(s)}$\n因此，$U(s)$ 的表达式为：\n$$U(s) = \\frac{K(s)}{1+P(s)K(s)}R(s) - \\frac{P(s)K(s)}{1+P(s)K(s)}D(s) - \\frac{K(s)}{1+P(s)K(s)}N(s)$$\n\n根据这些通解，我们应用叠加原理来确定所需的六个传递函数。\n1. $G_{yr}(s) = \\dfrac{Y(s)}{R(s)}\\bigg|_{D=0, N=0} = \\dfrac{P(s)K(s)}{1+P(s)K(s)}$\n2. $G_{yd}(s) = \\dfrac{Y(s)}{D(s)}\\bigg|_{R=0, N=0} = \\dfrac{P(s)}{1+P(s)K(s)}$\n3. $G_{yn}(s) = \\dfrac{Y(s)}{N(s)}\\bigg|_{R=0, D=0} = -\\dfrac{P(s)K(s)}{1+P(s)K(s)}$\n4. $G_{ur}(s) = \\dfrac{U(s)}{R(s)}\\bigg|_{D=0, N=0} = \\dfrac{K(s)}{1+P(s)K(s)}$\n5. $G_{ud}(s) = \\dfrac{U(s)}{D(s)}\\bigg|_{R=0, N=0} = -\\dfrac{P(s)K(s)}{1+P(s)K(s)}$\n6. $G_{un}(s) = \\dfrac{U(s)}{N(s)}\\bigg|_{R=0, D=0} = -\\dfrac{K(s)}{1+P(s)K(s)}$\n\n现在我们代入给定的被控对象 $P(s)=\\dfrac{10}{(s+1)(s+2)}$ 和补偿器 $K(s)=\\dfrac{s+3}{s}$。首先，我们计算环路传递函数 $L(s) = P(s)K(s)$ 和表达式 $1+L(s)$。\n$$L(s) = P(s)K(s) = \\left(\\frac{10}{(s+1)(s+2)}\\right)\\left(\\frac{s+3}{s}\\right) = \\frac{10(s+3)}{s(s+1)(s+2)}$$\n$$1+L(s) = 1 + \\frac{10(s+3)}{s(s+1)(s+2)} = \\frac{s(s+1)(s+2) + 10(s+3)}{s(s+1)(s+2)}$$\n$1+L(s)$ 的分子是：\n$$s(s^2+3s+2) + 10s+30 = s^3+3s^2+2s+10s+30 = s^3+3s^2+12s+30$$\n所以，$1+L(s) = \\dfrac{s^3+3s^2+12s+30}{s(s+1)(s+2)}$。\n\n我们现在可以写出明确的传递函数：\n$G_{yr}(s) = \\dfrac{L(s)}{1+L(s)} = \\dfrac{\\frac{10(s+3)}{s(s+1)(s+2)}}{\\frac{s^3+3s^2+12s+30}{s(s+1)(s+2)}} = \\dfrac{10(s+3)}{s^3+3s^2+12s+30} = \\dfrac{10s+30}{s^3+3s^2+12s+30}$\n\n$G_{yd}(s) = \\dfrac{P(s)}{1+L(s)} = \\dfrac{\\frac{10}{(s+1)(s+2)}}{\\frac{s^3+3s^2+12s+30}{s(s+1)(s+2)}} = \\dfrac{10s}{s^3+3s^2+12s+30}$\n\n$G_{yn}(s) = -G_{yr}(s) = -\\dfrac{10s+30}{s^3+3s^2+12s+30} = \\dfrac{-10s-30}{s^3+3s^2+12s+30}$\n\n$G_{ur}(s) = \\dfrac{K(s)}{1+L(s)} = \\dfrac{\\frac{s+3}{s}}{\\frac{s^3+3s^2+12s+30}{s(s+1)(s+2)}} = \\frac{(s+3)(s+1)(s+2)}{s^3+3s^2+12s+30} = \\dfrac{s^3+6s^2+11s+6}{s^3+3s^2+12s+30}$\n\n$G_{ud}(s) = -G_{yr}(s) = -\\dfrac{10s+30}{s^3+3s^2+12s+30} = \\dfrac{-10s-30}{s^3+3s^2+12s+30}$\n\n$G_{un}(s) = -G_{ur}(s) = -\\dfrac{s^3+6s^2+11s+6}{s^3+3s^2+12s+30} = \\dfrac{-s^3-6s^2-11s-6}{s^3+3s^2+12s+30}$\n\n最后，我们评估扰动到输出映射 $G_{yd}(s)$ 的低频特性。我们计算当 $s \\to 0$ 时的极限：\n$$\\lim_{s \\to 0} G_{yd}(s) = \\lim_{s \\to 0} \\frac{10s}{s^3+3s^2+12s+30}$$\n通过直接代入，因为该函数是有理函数且分母在 $s=0$ 处不为零：\n$$\\lim_{s \\to 0} G_{yd}(s) = \\frac{10(0)}{0^3+3(0)^2+12(0)+30} = \\frac{0}{30} = 0$$\n\n解释：传递函数 $G_{yd}(s)$ 关联了被控对象输入端的扰动 $d(t)$ 与被控对象输出 $y(t)$。量 $|G_{yd}(j\\omega)|$ 是从频率为 $\\omega$ 的正弦扰动到输出的增益。当 $s \\to 0$ 时的极限对应于直流增益 ($\\omega \\to 0$)。值为 $0$ 表明系统完全抑制恒定（直流）或非常低频的扰动。这是控制器 $K(s)$ 中积分作用的直接结果，该控制器在 $s=0$ 处有一个极点。这个积分器在开环中提供无限的直流增益，从而迫使由恒定扰动引起的稳态误差为零。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{10s+30}{s^3+3s^2+12s+30} & \\frac{10s}{s^3+3s^2+12s+30} & \\frac{-10s-30}{s^3+3s^2+12s+30} & \\frac{s^3+6s^2+11s+6}{s^3+3s^2+12s+30} & \\frac{-10s-30}{s^3+3s^2+12s+30} & \\frac{-s^3-6s^2-11s-6}{s^3+3s^2+12s+30} & 0\n\\end{pmatrix}\n}\n$$", "id": "2744189"}, {"introduction": "虽然设计控制器以实现从参考到输出的稳定响应是首要目标，但这并不足以保证系统整体的良好性能。本练习通过一个看似不稳定的被控对象极点被控制器零点“抵消”的场景，深入探讨了*内部稳定性*这一关键概念 [@problem_id:2744192]。你将发现，尽管某个传递函数可能看起来是稳定的，但另一个内部传递函数——特别是从输入扰动到系统输出的传递函数——却可能不稳定，这在实践中会导致灾难性的后果。这凸显了分析所有相关传递函数（尤其是涉及灵敏度函数的那些）以确保系统真正鲁棒性的重要性。", "problem": "考虑一个单位负反馈连接的单输入单输出 (SISO) 线性时不变 (LTI) 系统。被控对象由真有理传递函数\n$$\nP(s)=\\frac{s+1}{(s-1)(s+2)}\\,,\n$$\n给出，其在 $s=1$ 处有一个不稳定极点。控制器被设计为消去被控对象的因子 $(s-1)$，其传递函数为\n$$\nK(s)=\\frac{k\\,(s-1)}{s+a}\\,,\n$$\n其中 $k>0$ 且 $a>0$。参考输入为 $r$，施加于被控对象的控制输入为 $u$，测量输出为 $y$。一个加性扰动 $d$ 在被控对象输入端进入，因此被控对象方程为 $y=P\\,(u+d)$。不存在测量噪声。\n\n仅从单位反馈互连所隐含的输入-输出关系出发（无需状态空间实现），完成以下任务：\n\n- 推导从参考输入 $r$ 到输出 $y$ 的闭环传递函数，以及从扰动输入 $d$ 到输出 $y$ 的闭环传递函数，均用 $P$ 和 $K$ 表示。使用标准的灵敏度函数和互补灵敏度函数来表示你的结果，但除了上述 $K(s)$ 所隐含的对消外，不要假设任何特殊的对消。\n\n- 假设选择的 $k$ 和 $a$ 使得互补灵敏度函数的所有极点都严格位于复平面的开左半平面，因此从 $r$ 到 $y$ 的映射是稳定的。判断在此选择下，从 $d$ 到 $y$ 的内部闭环映射是否稳定，如果不是，请确定其不稳定极点的精确位置。\n\n你的最终答案必须是该不稳定极点的位置，以一个实数表示。无需四舍五入，不涉及单位。", "solution": "首先，我们为给定的单位反馈配置推导通用的闭环传递函数。拉普拉斯域中的信号包括参考 $r(s)$、误差 $e(s)$、控制作用 $u(s)$、扰动 $d(s)$ 和输出 $y(s)$。它们之间的关系是：\n$e(s) = r(s) - y(s)$\n$u(s) = K(s) e(s) = K(s) (r(s) - y(s))$\n$y(s) = P(s) (u(s) + d(s))$\n\n将 $u(s)$ 的表达式代入 $y(s)$ 的方程中：\n$y(s) = P(s) [K(s) (r(s) - y(s)) + d(s)]$\n$y(s) = P(s) K(s) r(s) - P(s) K(s) y(s) + P(s) d(s)$\n\n将含有 $y(s)$ 的项移到等式左侧：\n$y(s) + P(s) K(s) y(s) = P(s) K(s) r(s) + P(s) d(s)$\n$y(s) [1 + P(s) K(s)] = P(s) K(s) r(s) + P(s) d(s)$\n\n求解 $y(s)$ 得到总的输入-输出关系：\n$$\ny(s) = \\frac{P(s) K(s)}{1 + P(s) K(s)} r(s) + \\frac{P(s)}{1 + P(s) K(s)} d(s)\n$$\n\n我们定义回路传递函数 $L(s) = P(s) K(s)$、灵敏度函数 $S(s) = \\frac{1}{1 + L(s)}$ 和互补灵敏度函数 $T(s) = \\frac{L(s)}{1 + L(s)}$。使用这些标准定义，$y(s)$ 的表达式变为：\n$y(s) = T(s) r(s) + P(s) S(s) d(s)$\n\n由此，我们确定从参考 $r$ 到输出 $y$ 的传递函数为 $G_{yr}(s) = T(s)$，从扰动 $d$ 到输出 $y$ 的传递函数为 $G_{yd}(s) = P(s)S(s)$。这完成了问题的第一部分。\n\n接下来，我们使用给定的 $P(s)$ 和 $K(s)$ 表达式来分析这些传递函数的稳定性。\n$P(s) = \\frac{s+1}{(s-1)(s+2)}$\n$K(s) = \\frac{k(s-1)}{s+a}$\n\n回路传递函数为：\n$L(s) = P(s) K(s) = \\frac{s+1}{(s-1)(s+2)} \\cdot \\frac{k(s-1)}{s+a}$\n\n从 $r$ 到 $y$ 的传递函数是 $T(s) = \\frac{L(s)}{1+L(s)}$。为了计算它，我们首先求出 $1+L(s)$：\n$1 + L(s) = 1 + \\frac{k(s+1)(s-1)}{(s-1)(s+2)(s+a)} = \\frac{(s-1)(s+2)(s+a) + k(s+1)(s-1)}{(s-1)(s+2)(s+a)}$\n我们可以从分子中提出公因式 $(s-1)$：\n$1 + L(s) = \\frac{(s-1)[(s+2)(s+a) + k(s+1)]}{(s-1)(s+2)(s+a)}$\n\n现在，我们可以写出 $T(s)$ 的表达式：\n$$\nT(s) = \\frac{L(s)}{1+L(s)} = \\frac{\\frac{k(s+1)(s-1)}{(s-1)(s+2)(s+a)}}{\\frac{(s-1)[(s+2)(s+a) + k(s+1)]}{(s-1)(s+2)(s+a)}} = \\frac{k(s+1)(s-1)}{(s-1)[(s+2)(s+a) + k(s+1)]}\n$$\n在推导传递函数的过程中，位于 $s=1$ 的极点被位于 $s=1$ 的零点抵消。这得到：\n$$\nT(s) = \\frac{k(s+1)}{(s+2)(s+a) + k(s+1)} = \\frac{k(s+1)}{s^2 + (a+2)s + 2a + ks + k} = \\frac{k(s+1)}{s^2 + (a+k+2)s + (2a+k)}\n$$\n$T(s)$ 的极点是特征多项式 $s^2 + (a+k+2)s + (2a+k) = 0$ 的根。鉴于 $a>0$ 和 $k>0$，该二次多项式的所有系数都严格为正。根据 Routh-Hurwitz 稳定判据，两个根的实部都必须为负，这意味着它们位于复平面的开左半平面。这证实了问题中关于从 $r$ 到 $y$ 的映射是稳定的假设。\n\n现在，我们必须确定从 $d$ 到 $y$ 的映射的稳定性，其传递函数为 $G_{yd}(s) = P(s)S(s) = \\frac{P(s)}{1+L(s)}$。\n$$\nG_{yd}(s) = \\frac{\\frac{s+1}{(s-1)(s+2)}}{\\frac{(s-1)[(s+2)(s+a) + k(s+1)]}{(s-1)(s+2)(s+a)}}\n$$\n我们通过将分子乘以分母的倒数来简化此表达式：\n$$\nG_{yd}(s) = \\frac{s+1}{(s-1)(s+2)} \\cdot \\frac{(s-1)(s+2)(s+a)}{(s-1)[(s+2)(s+a) + k(s+1)]}\n$$\n消去公因式 $(s+2)$ 后，我们得到：\n$$\nG_{yd}(s) = \\frac{(s+1)(s+a)}{(s-1)[(s+2)(s+a) + k(s+1)]}\n$$\n代入从 $T(s)$ 分析中得到的特征多项式，我们有：\n$$\nG_{yd}(s) = \\frac{(s+1)(s+a)}{(s-1)[s^2 + (a+k+2)s + (2a+k)]}\n$$\n该传递函数的极点是分母的根。这些根是 $s=1$ 和 $s^2 + (a+k+2)s + (2a+k)=0$ 的根。如前所述，二次部分的根位于开左半平面。然而，分母中的因子 $(s-1)$ 引入了一个位于 $s=+1$ 的极点。位于右半平面的极点表示不稳定。\n\n在回路传递函数 $L(s)$ 中，位于 $s=1$ 处的不稳定极点-零点对消掩盖了从 $r$ 到 $y$ 的输入-输出映射中的不稳定性。这种现象被称为内部稳定性的丧失。与极点 $s=1$ 相关的不稳定模式无法从参考输入观测到，但可以被被控对象输入端的扰动 $d$ 激发。\n\n因此，从 $d$ 到 $y$ 的闭环映射是不稳定的。其不稳定极点的精确位置是 $s=1$。", "answer": "$$\n\\boxed{1}\n$$", "id": "2744192"}, {"introduction": "从经典分析迈向现代鲁棒控制设计，本练习介绍了广义对象和线性分式变换（LFTs）这一强大框架。你将学习如何通过对灵敏度函数 $S$ 和余灵敏度函数 $T$ 使用频率相关的加权函数，来形式化地表达设计目标，例如良好的跟踪性能和扰动抑制能力 [@problem_id:2744167]。将系统构建成一个广义状态空间结构，是诸如 $H_{\\infty}$ 控制等先进综合方法的第一步，它为系统地处理性能与鲁棒性之间的基本权衡提供了途径。", "problem": "考虑一个单输入单输出的连续时间单位反馈互联系统，其中对象由传递函数 $P(s)$ 给出，控制器 $K(s)$ 作用于误差信号 $e(t)$（参考输入 $r(t)$ 与测量输出 $y(t)$ 之差），两个性能权重 $W_{1}(s)$ 和 $W_{2}(s)$ 分别作用于灵敏度和互补灵敏度通道。性能输出定义为 $z_{1}(t) = (W_{1} \\ast e)(t)$ 和 $z_{2}(t) = (W_{2} \\ast y)(t)$，其中 $\\ast$ 表示卷积。参考输入 $r(t)$ 是唯一的外部输入。对象、权重和互联规定如下：\n- 对象：$P(s) = \\dfrac{s + 2}{(s + 1)(s + 3)}$。\n- 灵敏度权重：$W_{1}(s) = \\dfrac{s + 0.5}{s + 0.05}$。\n- 互补灵敏度权重：$W_{2}(s) = \\dfrac{10}{s + 10}$。\n- 测量输出：$y(t) = (P \\ast u)(t)$，其中 $u(t) = (K \\ast e)(t)$，而 $e(t) = r(t) - y(t)$。\n\n任务：\n1. 为 $P(s)$、$W_{1}(s)$ 和 $W_{2}(s)$ 构建一个最小状态空间实现，使用严格真或真实现以及实数矩阵。然后，从基本原理出发，利用状态方程和代数互联约束，组装一个状态空间形式的广义对象，该对象将堆叠输入 $[w; u]$ 映射到堆叠输出 $[z; y_{K}]$，其中 $w(t) = r(t)$ 是外部输入，$y_{K}(t) = e(t)$ 是提供给控制器的测量值，$z(t) = [z_{1}(t); z_{2}(t)]$ 是性能输出，$u(t)$ 是控制器输出。\n2. 通过仅使用互联恒等式来消去内部信号，推导将控制器 $K(s)$ 映射到从 $w$ 到 $z$ 的闭环传递矩阵的下线性分式变换。用单位反馈互联 $P(s)$ 和 $K(s)$ 产生的灵敏度函数 $S(s)$ 和互补灵敏度函数 $T(s)$ 来表示最终答案。\n3. 特化为静态输出反馈控制器 $K(s) = k$，其中 $k$ 为实标量。提供灵敏度函数 $S(s)$ 作为 $s$ 和 $k$ 的有理函数的显式闭式表达式。\n\n你最终报告的答案必须是任务3中得到的 $S(s)$ 的单一闭式表达式。不需要数值近似。最终答案中不要包含任何单位。", "solution": "该问题要求完成三个不同的任务。我将依次解决它们。\n\n首先，我必须组装状态空间形式的广义对象。这需要为对象 $P(s)$、灵敏度权重 $W_{1}(s)$ 和互补灵敏度权重 $W_{2}(s)$ 推导状态空间实现。\n\n对象由 $P(s) = \\dfrac{s + 2}{(s + 1)(s + 3)} = \\dfrac{s + 2}{s^2 + 4s + 3}$ 给出。这是一个二阶严格真系统。一个可控标准型下的最小状态空间实现是：\n令状态向量为 $x_{P} \\in \\mathbb{R}^{2}$。状态方程为 $\\dot{x}_{P} = A_{P}x_{P} + B_{P}u$ 和 $y = C_{P}x_{P} + D_{P}u$。\n$$ A_{P} = \\begin{pmatrix} 0 & 1 \\\\ -3 & -4 \\end{pmatrix}, \\quad B_{P} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C_{P} = \\begin{pmatrix} 2 & 1 \\end{pmatrix}, \\quad D_{P} = 0 $$\n\n灵敏度权重为 $W_{1}(s) = \\dfrac{s + 0.5}{s + 0.05}$。这是一个一阶真系统。我们可以将其写作 $W_{1}(s) = 1 + \\dfrac{0.45}{s + 0.05}$。\n令状态为 $x_{W1} \\in \\mathbb{R}$。该模块的输入是误差信号 $e(t)$，输出是 $z_{1}(t)$。其状态空间实现为：\n$$ A_{W1} = -0.05, \\quad B_{W1} = 1, \\quad C_{W1} = 0.45, \\quad D_{W1} = 1 $$\n\n互补灵敏度权重为 $W_{2}(s) = \\dfrac{10}{s + 10}$。这是一个一阶严格真系统。\n令状态为 $x_{W2} \\in \\mathbb{R}$。输入是对象输出 $y(t)$，输出是 $z_{2}(t)$。其状态空间实现为：\n$$ A_{W2} = -10, \\quad B_{W2} = 1, \\quad C_{W2} = 10, \\quad D_{W2} = 0 $$\n\n现在，我将通过连接这些子系统来组装广义对象。整体状态向量为 $x = \\begin{pmatrix} x_{P} \\\\ x_{W1} \\\\ x_{W2} \\end{pmatrix}$。外部输入为 $w = r$，控制输入为 $u$。性能输出为 $z = \\begin{pmatrix} z_{1} \\\\ z_{2} \\end{pmatrix}$，用于控制器的测量输出为 $y_{K} = e$。\n\n互联方程为：\n$1$. $y(t) = C_{P}x_{P}(t)$，因为 $D_{P}=0$。\n$2$. $e(t) = r(t) - y(t) = w(t) - C_{P}x_{P}(t)$。\n\n状态动态为：\n$\\dot{x}_{P} = A_{P}x_{P} + B_{P}u$。\n$\\dot{x}_{W1} = A_{W1}x_{W1} + B_{W1}e = A_{W1}x_{W1} + B_{W1}(w - C_{P}x_{P}) = -B_{W1}C_{P}x_{P} + A_{W1}x_{W1} + B_{W1}w$。\n$\\dot{x}_{W2} = A_{W2}x_{W2} + B_{W2}y = A_{W2}x_{W2} + B_{W2}C_{P}x_{P} = B_{W2}C_{P}x_{P} + A_{W2}x_{W2}$。\n\n将这些组合成标准形式 $\\dot{x} = Ax + B_{1}w + B_{2}u$：\n$$ A = \\begin{pmatrix} A_{P} & 0 & 0 \\\\ -B_{W1}C_{P} & A_{W1} & 0 \\\\ B_{W2}C_{P} & 0 & A_{W2} \\end{pmatrix}, \\quad B_{1} = \\begin{pmatrix} 0 \\\\ B_{W1} \\\\ 0 \\end{pmatrix}, \\quad B_{2} = \\begin{pmatrix} B_{P} \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n代入矩阵：\n$$\nA = \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ -3 & -4 & 0 & 0 \\\\ -2 & -1 & -0.05 & 0 \\\\ 2 & 1 & 0 & -10 \\end{pmatrix}, \\quad\nB_{1} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad\nB_{2} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n\n输出方程为：\n$z_{1} = C_{W1}x_{W1} + D_{W1}e = C_{W1}x_{W1} + D_{W1}(w - C_{P}x_{P}) = -D_{W1}C_{P}x_{P} + C_{W1}x_{W1} + D_{W1}w$。\n$z_{2} = C_{W2}x_{W2} + D_{W2}y = C_{W2}x_{W2} + D_{W2}(C_{P}x_{P}) = D_{W2}C_{P}x_{P} + C_{W2}x_{W2}$。因为 $D_{W2} = 0$，所以 $z_{2} = C_{W2}x_{W2}$。\n$y_{K} = e = w - C_{P}x_{P} = -C_{P}x_{P} + w$。\n\n组合成标准形式 $z = C_{1}x + D_{11}w + D_{12}u$ 和 $y_{K} = C_{2}x + D_{21}w + D_{22}u$：\n$$\nC_{1} = \\begin{pmatrix} -D_{W1}C_{P} & C_{W1} & 0 \\\\ 0 & 0 & C_{W2} \\end{pmatrix}, \\quad\nD_{11} = \\begin{pmatrix} D_{W1} \\\\ 0 \\end{pmatrix}, \\quad\nD_{12} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n$$\nC_{2} = \\begin{pmatrix} -C_{P} & 0 & 0 \\end{pmatrix}, \\quad\nD_{21} = 1, \\quad\nD_{22} = 0\n$$\n代入矩阵：\n$$\nC_{1} = \\begin{pmatrix} -2 & -1 & 0.45 & 0 \\\\ 0 & 0 & 0 & 10 \\end{pmatrix}, \\quad\nD_{11} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad\nD_{12} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n$$\nC_{2} = \\begin{pmatrix} -2 & -1 & 0 & 0 \\end{pmatrix}, \\quad\nD_{21} = 1, \\quad\nD_{22} = 0\n$$\n至此完成了第一个任务。\n\n对于第二个任务，我必须推导将控制器 $K(s)$ 映射到从 $w$ 到 $z$ 的闭环传递矩阵的下线性分式变换（LFT）。记其为 $T_{zw}(s)$。\n广义对象通过传递矩阵 $G(s)$ 将输入 $[w; u]$ 与输出 $[z; y_K]$ 联系起来：\n$$ \\begin{pmatrix} z \\\\ y_{K} \\end{pmatrix} = \\begin{pmatrix} G_{11}(s) & G_{12}(s) \\\\ G_{21}(s) & G_{22}(s) \\end{pmatrix} \\begin{pmatrix} w \\\\ u \\end{pmatrix} $$\n控制器提供反馈 $u = K(s) y_{K}$。\n我们必须首先从互联恒等式中辨识出模块 $G_{ij}(s)$。外部输入为 $w=r$，控制器的测量值为 $y_K=e$。\n$y_{K} = e = r - y = r - P(s)u = 1 \\cdot w - P(s)u$。\n由此，我们辨识出 $G_{21}(s) = 1$ 和 $G_{22}(s) = -P(s)$。\n\n性能输出为 $z = \\begin{pmatrix} z_{1} \\\\ z_{2} \\end{pmatrix}$。\n$z_{1} = W_{1}(s)e = W_{1}(s)(r-y) = W_{1}(s)(w - P(s)u) = W_{1}(s)w - W_{1}(s)P(s)u$。\n$z_{2} = W_{2}(s)y = W_{2}(s)P(s)u = 0 \\cdot w + W_{2}(s)P(s)u$。\n\n用矩阵形式表示为：\n$$ z = \\begin{pmatrix} W_{1}(s) \\\\ 0 \\end{pmatrix} w + \\begin{pmatrix} -W_{1}(s)P(s) \\\\ W_{2}(s)P(s) \\end{pmatrix} u $$\n由此，我们辨识出 $G_{11}(s) = \\begin{pmatrix} W_{1}(s) \\\\ 0 \\end{pmatrix}$ 和 $G_{12}(s) = \\begin{pmatrix} -W_{1}(s)P(s) \\\\ W_{2}(s)P(s) \\end{pmatrix}$。\n\n下LFT公式为 $T_{zw}(s) = F_{l}(G,K) = G_{11} + G_{12}K(I - G_{22}K)^{-1}G_{21}$。\n由于系统是单输入单输出（SISO），$I$ 是标量 $1$。\n$$ T_{zw}(s) = \\begin{pmatrix} W_{1}(s) \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} -W_{1}(s)P(s) \\\\ W_{2}(s)P(s) \\end{pmatrix} K(s) (1 - (-P(s))K(s))^{-1} \\cdot 1 $$\n$$ T_{zw}(s) = \\begin{pmatrix} W_{1}(s) \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} -W_{1}(s)P(s)K(s) \\\\ W_{2}(s)P(s)K(s) \\end{pmatrix} (1 + P(s)K(s))^{-1} $$\n让我们回顾一下单位反馈回路的灵敏度函数 $S(s)$ 和互补灵敏度函数 $T(s)$ 的标准定义：\n$S(s) = (1 + P(s)K(s))^{-1}$。\n$T(s) = P(s)K(s)(1 + P(s)K(s))^{-1} = P(s)K(s)S(s)$。\n$S(s) + T(s) = 1$ 也是一个基本关系。\n\n将这些代入 $T_{zw}(s)$ 的表达式中：\n第一个分量是： $W_{1}(s) - W_{1}(s)P(s)K(s)(1 + P(s)K(s))^{-1} = W_{1}(s) - W_{1}(s)T(s) = W_{1}(s)(1 - T(s)) = W_{1}(s)S(s)$。\n第二个分量是： $W_{2}(s)P(s)K(s)(1 + P(s)K(s))^{-1} = W_{2}(s)T(s)$。\n所以，闭环传递矩阵是：\n$$ T_{zw}(s) = \\begin{pmatrix} W_{1}(s)S(s) \\\\ W_{2}(s)T(s) \\end{pmatrix} $$\n至此完成了第二个任务。\n\n对于第三个也是最后一个任务，我必须求出当控制器为静态增益 $K(s) = k$ 时的灵敏度函数 $S(s)$ 的表达式。\n使用定义 $S(s) = (1 + P(s)K(s))^{-1}$ 以及给定的对象 $P(s) = \\dfrac{s+2}{(s+1)(s+3)}$，我们代入 $K(s) = k$：\n$$ S(s) = \\left( 1 + \\left(\\dfrac{s+2}{(s+1)(s+3)}\\right) k \\right)^{-1} $$\n为简化计算，为括号内的表达式通分：\n$$ S(s) = \\left( \\dfrac{(s+1)(s+3) + k(s+2)}{(s+1)(s+3)} \\right)^{-1} $$\n将分数求逆可得：\n$$ S(s) = \\dfrac{(s+1)(s+3)}{(s+1)(s+3) + k(s+2)} $$\n展开分子和分母中的多项式：\n分子： $(s+1)(s+3) = s^2 + 3s + s + 3 = s^2 + 4s + 3$。\n分母： $(s^2 + 4s + 3) + ks + 2k = s^2 + (4+k)s + (3+2k)$。\n因此，灵敏度函数的显式闭式表达式为：\n$$ S(s) = \\dfrac{s^2 + 4s + 3}{s^2 + (4+k)s + (3+2k)} $$\n这就是问题陈述所要求的最终答案。", "answer": "$$\n\\boxed{\\frac{s^2 + 4s + 3}{s^2 + (k+4)s + 2k + 3}}\n$$", "id": "2744167"}]}