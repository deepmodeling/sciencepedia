{"hands_on_practices": [{"introduction": "在构建如 ARMAX 等综合模型时，准确地对噪声特性进行建模至关重要。本练习将引导您完成一个核心任务：从经验得到的噪声功率谱密度（PSD）出发，通过谱分解技术来确定一个可逆的移动平均（MA）噪声模型。这项实践不仅连接了频域分析与时域参数模型，而且强调了在系统辨识中保证模型可逆性的重要性 [@problem_id:2751633]。", "problem": "一个零均值、宽平稳离散时间噪声过程，其功率谱密度 (PSD) $\\Phi_{v}(\\omega)$ 已在 $\\omega \\in [-\\pi,\\pi]$ (弧度) 上通过经验估计得出，并由以下实偶三角多项式建模：\n$$\n\\Phi_{v}(\\omega) \\;=\\; 15 \\;+\\; 15.4 \\cos(\\omega) \\;+\\; 2 \\cos(2\\omega).\n$$\n假设一个带有外生输入的自回归移动平均 (ARMAX) 噪声模型，其中扰动 $v_{t}$ 是由一个方差为 $\\lambda>0$ 的白噪声序列 $e_{t}$ 通过一个2阶的因果、首一移动平均 (MA) 多项式 $C(q^{-1})$ 生成的，其中 $q^{-1}$ 表示单位延迟。请仅使用线性时不变 (LTI) 系统的基本原理和维纳-辛钦 (Wiener–Khinchin) 定理来证明 $v_{t}$ 的功率谱密度允许形如下式的谱分解：\n$$\n\\Phi_{v}(\\omega) \\;=\\; \\lambda \\,\\big|C\\!\\left(e^{-j\\omega}\\right)\\big|^{2}.\n$$\n然后，强制施加最小相位约束（$C(z^{-1})$ 的所有零点严格位于单位圆盘内部）以获得唯一的可逆因子。确定能精确再现给定 $\\Phi_{v}(\\omega)$ 的首一二阶多项式 $C(q^{-1})$ 和相应的 $\\lambda>0$。根据 $C(z^{-1})$ 零点的位置讨论可逆性约束，并为你的解验证此约束。\n\n最终答案仅报告多项式 $C(q^{-1})$。不需要四舍五入，角度单位为弧度。", "solution": "用户提供的问题陈述已经过评估，被认为是有效的。这是一个在时间序列分析和系统辨识领域中适定的问题，其基础是诸如维纳-辛钦 (Wiener–Khinchin) 定理和谱分解等已确立的科学原理。所提供的数据是一致且充分的，足以在指定约束下推导出唯一解。\n\n该问题要求为一个具有给定功率谱密度 (PSD) $\\Phi_{v}(\\omega)$ 的随机过程 $v_t$ 确定一个移动平均 (MA) 噪声模型。扰动 $v_t$ 被建模为一个线性时不变 (LTI) 滤波器的输出，该滤波器由方差为 $\\lambda$ 的白噪声过程 $e_t$ 驱动，其传递函数为 $C(q^{-1})$。该传递函数对应于一个首一二阶多项式 $C(q^{-1}) = 1 + c_1 q^{-1} + c_2 q^{-2}$。\n\n首先，我们证明谱分解形式的合理性。对于一个频率响应为 $H(e^{-j\\omega})$ 的离散时间 LTI 系统，其输入信号的功率谱密度 $\\Phi_{in}(\\omega)$ 与输出信号的功率谱密度 $\\Phi_{out}(\\omega)$ 之间的关系由下式给出：\n$$\n\\Phi_{out}(\\omega) = |H(e^{-j\\omega})|^2 \\Phi_{in}(\\omega).\n$$\n在本例中，系统是 MA 滤波器，因此 $H(e^{-j\\omega}) = C(e^{-j\\omega})$，输入是零均值、方差为 $\\lambda$ 的白噪声序列 $e_t$。白噪声过程的功率谱密度在所有频率上都是恒定的，等于其方差，因此 $\\Phi_{e}(\\omega) = \\lambda$。所以，输出过程 $v_t$ 的功率谱密度为\n$$\n\\Phi_{v}(\\omega) = |C(e^{-j\\omega})|^2 \\lambda,\n$$\n这证明了问题陈述中给出的形式是合理的。\n\n给定的功率谱密度为\n$$\n\\Phi_{v}(\\omega) = 15 + 15.4 \\cos(\\omega) + 2 \\cos(2\\omega).\n$$\n为了进行谱分解，我们通过代入 $z = e^{j\\omega}$ 并使用欧拉公式 $\\cos(k\\omega) = \\frac{e^{jk\\omega} + e^{-jk\\omega}}{2} = \\frac{z^k + z^{-k}}{2}$，将 $\\Phi_{v}(\\omega)$ 表示为复变量 $z$ 的有理函数。\n$$\n\\Phi_{v}(z) = 15 + 15.4 \\left(\\frac{z + z^{-1}}{2}\\right) + 2 \\left(\\frac{z^2 + z^{-2}}{2}\\right)\n$$\n$$\n\\Phi_{v}(z) = 15 + 7.7(z + z^{-1}) + (z^2 + z^{-2}) = z^2 + 7.7z + 15 + 7.7z^{-1} + z^{-2}.\n$$\n这是一个洛朗多项式 (Laurent polynomial)。为了找到它的根，我们可以分析相关的多项式 $P(z) = z^2 \\Phi_{v}(z)$:\n$$\nP(z) = z^4 + 7.7z^3 + 15z^2 + 7.7z + 1.\n$$\nPSD的分解形式为 $\\Phi_{v}(z) = \\lambda C(z^{-1}) C(z)$。对于一个首一二阶多项式 $C(z^{-1}) = 1+c_1z^{-1}+c_2z^{-2}$，我们有 $C(z) = 1+c_1z+c_2z^2$。其乘积为：\n$$\n\\lambda C(z^{-1}) C(z) = \\lambda(1+c_1z^{-1}+c_2z^{-2})(1+c_1z+c_2z^2) = \\frac{\\lambda}{z^2}(z^2+c_1z+c_2)(1+c_1z+c_2z^2).\n$$\n乘以 $z^2$ 得到 $z^2\\Phi_v(z) = \\lambda(z^2+c_1z+c_2)(1+c_1z+c_2z^2)$。这个多项式的根必须是 $P(z)$ 的根。\n由于 $P(z)$ 是一个互反多项式，我们可以通过等式两边同除以 $z^2$（因为 $z=0$ 不是根）并代入 $y = z + z^{-1}$ 来求解 $P(z)=0$。\n$$\n(z^2 + z^{-2}) + 7.7(z + z^{-1}) + 15 = 0\n$$\n当 $y = z+z^{-1}$ 时，可得 $y^2 = z^2+2+z^{-2}$，所以 $z^2+z^{-2} = y^2-2$。方程变为：\n$$\n(y^2-2) + 7.7y + 15 = 0 \\implies y^2 + 7.7y + 13 = 0.\n$$\n我们求解这个关于 $y$ 的二次方程：\n$$\ny = \\frac{-7.7 \\pm \\sqrt{7.7^2 - 4(1)(13)}}{2} = \\frac{-7.7 \\pm \\sqrt{59.29 - 52}}{2} = \\frac{-7.7 \\pm \\sqrt{7.29}}{2}.\n$$\n由于 $\\sqrt{7.29}=2.7$，其根为：\n$$\ny_1 = \\frac{-7.7 - 2.7}{2} = -5.2, \\quad y_2 = \\frac{-7.7 + 2.7}{2} = -2.5.\n$$\n现在，我们通过求解每个 $y$ 值对应的 $z+z^{-1}=y$ 来找到 $P(z)$ 的根，这等价于求解二次方程 $z^2-yz+1=0$。\n对于 $y_1 = -5.2$：\n$$\nz^2 + 5.2z + 1 = 0 \\implies z = \\frac{-5.2 \\pm \\sqrt{5.2^2 - 4}}{2} = \\frac{-5.2 \\pm \\sqrt{23.04}}{2} = \\frac{-5.2 \\pm 4.8}{2}.\n$$\n这给出的根是 $z_1 = -5$ 和 $z_2 = -0.2$。\n\n对于 $y_2 = -2.5$：\n$$\nz^2 + 2.5z + 1 = 0 \\implies z = \\frac{-2.5 \\pm \\sqrt{2.5^2 - 4}}{2} = \\frac{-2.5 \\pm \\sqrt{2.25}}{2} = \\frac{-2.5 \\pm 1.5}{2}.\n$$\n这给出的根是 $z_3 = -2$ 和 $z_4 = -0.5$。\n\n$P(z)$ 的四个根是 $\\{-5, -0.2, -2, -0.5\\}$。这些是总谱函数 $\\Phi_v(z)$ 的零点。这些零点以互反成对 $(\\rho, 1/\\rho)$ 的形式出现：$(-5, -0.2)$ 和 $(-2, -0.5)$。\n\n问题要求一个“可逆因子” $C(q^{-1})$，这通过最小相位约束来保证，即传递函数 $C(z^{-1})$ 的所有零点必须严格位于单位圆盘 $|z|<1$ 内部。$C(z^{-1})=1+c_1z^{-1}+c_2z^{-2}$ 的零点是多项式 $z^2+c_1z+c_2=0$ 的根。\n为了构造最小相位滤波器，我们必须从集合 $\\{-5, -0.2, -2, -0.5\\}$ 中选择位于单位圆内的根。这些根是 $z=-0.2$ 和 $z=-0.5$。\n以这些最小相位零点为根的多项式是：\n$$\n(z - (-0.2))(z - (-0.5)) = (z+0.2)(z+0.5) = z^2 + 0.7z + 0.1.\n$$\n通过将其与形式 $z^2+c_1z+c_2$ 进行比较，我们确定 MA 多项式的系数：\n$$\nc_1 = 0.7, \\quad c_2 = 0.1.\n$$\n因此，所求的首一二阶 MA 多项式是：\n$$\nC(q^{-1}) = 1 + 0.7q^{-1} + 0.1q^{-2}.\n$$\n可逆性约束得到满足，因为当 $x=z^{-1}$ 时，$C(x)=1+0.7x+0.1x^2$ 的零点为 $x=-2$ 和 $x=-5$。由于这两个零点都在单位圆外，滤波器 $1/C(q^{-1})$ 是稳定且因果的，这使得 MA 模型 $v_t=C(q^{-1})e_t$ 是可逆的。\n\n最后，我们确定白噪声过程 $e_t$ 的方差 $\\lambda$。我们将分解后的 PSD 表达式与给定的表达式相等。\n$$\n\\Phi_{v}(z) = \\lambda C(z^{-1})C(z) = \\lambda(1+c_1z^{-1}+c_2z^{-2})(1+c_1z+c_2z^2)\n$$\n$$\n= \\lambda(c_2z^{-2} + (c_1+c_1c_2)z^{-1} + (1+c_1^2+c_2^2) + (c_1+c_1c_2)z + c_2z^2).\n$$\n其三角函数形式为：\n$$\n\\Phi_{v}(\\omega) = \\lambda(1+c_1^2+c_2^2) + 2\\lambda c_1(1+c_2)\\cos(\\omega) + 2\\lambda c_2 \\cos(2\\omega).\n$$\n将此与给定的 $\\Phi_v(\\omega) = 15 + 15.4\\cos(\\omega) + 2\\cos(2\\omega)$ 进行比较，我们比较 $\\cos(2\\omega)$ 的系数：\n$$\n2\\lambda c_2 = 2 \\implies \\lambda c_2 = 1.\n$$\n代入 $c_2=0.1$：\n$$\n\\lambda (0.1) = 1 \\implies \\lambda = 10.\n$$\n由于 $\\lambda=10 > 0$，这是一个有效的方差。我们可以用其他系数来验证这一点：\n- 常数项: $\\lambda(1+c_1^2+c_2^2) = 10(1+0.7^2+0.1^2) = 10(1+0.49+0.01) = 10(1.5) = 15$。正确。\n- $\\cos(\\omega)$ 项: $2\\lambda c_1(1+c_2) = 2(10)(0.7)(1+0.1) = 14(1.1) = 15.4$。正确。\n\n解是一致的。唯一的、可逆的、首一二阶多项式是 $C(q^{-1})=1+0.7q^{-1}+0.1q^{-2}$。", "answer": "$$\n\\boxed{1 + 0.7q^{-1} + 0.1q^{-2}}\n$$", "id": "2751633"}, {"introduction": "许多系统辨识方法（如预测误差法）的核心是计算给定参数下的预测误差序列 $\\varepsilon(t, \\theta)$。直接计算可能效率低下，本练习将展示如何将ARMAX模型的预测误差计算过程巧妙地转化为一系列稳定的因果滤波器级联。通过这种方法，您可以深入理解理论模型与高效数值实现之间的联系，并学会分析算法的计算复杂度，这在处理大规模数据集时是至关重要的实践技能 [@problem_id:2751638]。", "problem": "考虑一个标量、离散时间、线性时不变系统的带有外生输入的自回归移动平均 (ARMAX) 模型，由下式给出：\n$$\nA(q^{-1})\\,y(t) \\;=\\; B(q^{-1})\\,q^{-n_k}\\,u(t) \\;+\\; C(q^{-1})\\,e(t),\n$$\n其中 $q^{-1}$ 是后向移位算子，$A(q^{-1}) = 1 + a_{1} q^{-1} + \\cdots + a_{n_a} q^{-n_a}$ 和 $C(q^{-1}) = 1 + c_{1} q^{-1} + \\cdots + c_{n_c} q^{-n_c}$ 是首一稳定多项式，其所有零点都严格位于单位圆内，$B(q^{-1}) = b_{1} q^{-1} + \\cdots + b_{n_b} q^{-n_b}$ 是一个严格真多项式，且 $n_k \\in \\mathbb{Z}_{\\ge 0}$ 是一个已知的输入延迟。给定一个有限数据集 $\\{u(t),y(t)\\}_{t=1}^{N}$ 和一个初始参数矢量 $\\theta^{(0)} = \\{a_i^{(0)}\\}_{i=1}^{n_a} \\cup \\{b_j^{(0)}\\}_{j=1}^{n_b} \\cup \\{c_\\ell^{(0)}\\}_{\\ell=1}^{n_c}$，使得 $A(\\cdot)$ 和 $C(\\cdot)$ 如上文所述是可逆的。\n\n从上述定义方程以及线性时不变滤波和移位算子的基本性质出发，完成以下任务：\n\n-构建一种计算方法，该方法在给定 $\\theta^{(0)}$ 的情况下，通过级联稳定的因果滤波器和移位来生成所有 $t \\in \\{1,\\dots,N\\}$ 的单步预测误差 $\\varepsilon(t,\\theta^{(0)})$，而无需构建任何稠密回归矩阵或通过多项式长除法执行任何显式反卷积。\n-在一个成本模型下，推导出计算 $\\{\\varepsilon(t,\\theta^{(0)})\\}_{t=1}^{N}$ 所需的标量乘法总数的精确表达式，并将其表示为 $N$、$n_a$、$n_b$ 和 $n_c$ 的函数。该成本模型仅计算标量乘法，将加/减法和内存访问视为无成本；并且每个因果滤波器都以直接形式实现，其循环边界固定且与 $t$ 无关。假设测量窗口外的初始条件为零，并且不执行与 $A(\\cdot)$ 和 $C(\\cdot)$ 中首一系数相乘的运算。\n\n以 $N$、$n_a$、$n_b$ 和 $n_c$ 的单个闭式表达式的形式提供您的最终结果。无需进行数值计算，也无需四舍五入。最终答案必须单独为该表达式。", "solution": "该问题要求为带有外生输入的自回归移动平均 (ARMAX) 模型构建一种计算单步预测误差的方法，并推导其在标量乘法方面的计算成本。分析将从基本原理出发。\n\nARMAX 模型由以下方程给出：\n$$\nA(q^{-1})\\,y(t) \\;=\\; B(q^{-1})\\,q^{-n_k}\\,u(t) \\;+\\; C(q^{-1})\\,e(t)\n$$\n其中 $y(t)$ 是系统输出，$u(t)$ 是外生输入，$e(t)$ 是一个白噪声序列。多项式 $A(q^{-1})$、$B(q^{-1})$ 和 $C(q^{-1})$ 定义如下：\n$$\nA(q^{-1}) = 1 + a_{1} q^{-1} + \\cdots + a_{n_a} q^{-n_a}\n$$\n$$\nB(q^{-1}) = b_{1} q^{-1} + \\cdots + b_{n_b} q^{-n_b}\n$$\n$$\nC(q^{-1}) = 1 + c_{1} q^{-1} + \\cdots + c_{n_c} q^{-n_c}\n$$\n单步预测误差，记为 $\\varepsilon(t, \\theta)$，是使用给定参数矢量 $\\theta$ 计算出的新息 $e(t)$ 的值。对于此问题，我们使用指定的初始参数矢量 $\\theta^{(0)}$。为简化推导过程中的标记，我们将用 $\\varepsilon(t)$ 代替 $\\varepsilon(t, \\theta^{(0)})$，并使用来自 $\\theta^{(0)}$ 的系数 $\\{a_i\\}, \\{b_j\\}, \\{c_\\ell\\}$。\n\n为了找到 $\\varepsilon(t)$ 的表达式，我们重排模型方程以求解 $e(t)$：\n$$\nC(q^{-1})\\,e(t) \\;=\\; A(q^{-1})\\,y(t) \\;-\\; B(q^{-1})\\,q^{-n_k}\\,u(t)\n$$\n问题指出多项式 $C(q^{-1})$ 是稳定的，这意味着其所有根都严格位于单位圆内。这保证了其逆 $C(q^{-1})^{-1}$ 表示一个稳定且因果的线性时不变滤波器。因此，我们可以形式上写出：\n$$\n\\varepsilon(t) = e(t) = \\frac{1}{C(q^{-1})} \\left( A(q^{-1})\\,y(t) - B(q^{-1})\\,q^{-n_k}\\,u(t) \\right)\n$$\n该表达式将 $\\varepsilon(t)$ 的计算描述为一个滤波操作。问题指定了一种基于级联稳定滤波器的方法。此表达式的一种直接且计算高效的实现是，首先计算括号内的信号，然后应用滤波器 $1/C(q^{-1})$。这利用了算子的线性性质来避免冗余计算，特别是避免将滤波器 $1/C(q^{-1})$ 分别应用于 $y(t)$ 和 $u(t)$。\n\n该计算方法结构化为两级级联：\n第1阶段：计算一个中间信号，我们称之为 $v(t)$，它是将 FIR 滤波器 $A(q^{-1})$ 和 $B(q^{-1})$ 分别应用于信号 $y(t)$ 和 $u(t-n_k)$ 的结果。\n$$\nv(t) = A(q^{-1})\\,y(t) - B(q^{-1})\\,u(t-n_k)\n$$\n第2阶段：通过将 IIR 滤波器 $1/C(q^{-1})$ 应用于中间信号 $v(t)$ 来计算预测误差 $\\varepsilon(t)$。\n$$\n\\varepsilon(t) = \\frac{1}{C(q^{-1})} v(t)\n$$\n我们现在将这两个阶段展开为其显式递归形式，以分析计算成本。\n\n对于第1阶段，我们展开多项式算子：\n$$\nv(t) = \\left(1 + \\sum_{i=1}^{n_a} a_i q^{-i}\\right) y(t) - \\left(\\sum_{j=1}^{n_b} b_j q^{-j}\\right) u(t-n_k)\n$$\n应用后向移位算子的定义 $q^{-k}x(t) = x(t-k)$，我们得到 $v(t)$ 的计算公式：\n$$\nv(t) = y(t) + \\sum_{i=1}^{n_a} a_i y(t-i) - \\sum_{j=1}^{n_b} b_j u(t-n_k-j)\n$$\n对于第2阶段，关系式 $\\varepsilon(t) = v(t)/C(q^{-1})$ 等价于 $C(q^{-1})\\varepsilon(t) = v(t)$。展开此式可得：\n$$\n\\left(1 + \\sum_{\\ell=1}^{n_c} c_\\ell q^{-\\ell}\\right) \\varepsilon(t) = v(t)\n$$\n求解 $\\varepsilon(t)$ 得到第二阶段的递归公式：\n$$\n\\varepsilon(t) = v(t) - \\sum_{\\ell=1}^{n_c} c_\\ell \\varepsilon(t-\\ell)\n$$\n现在，我们根据所提供的仅计算标量乘法的模型来确定计算成本。我们假设当 $t \\le 0$ 时初始条件为零，且滤波器实现对于 $t \\in \\{1, \\dots, N\\}$ 使用固定的循环边界。\n\n在每个时间步 $t$，成本如下：\n1.  **计算 $v(t)$ 的成本**：表达式为 $v(t) = y(t) + \\sum_{i=1}^{n_a} a_i y(t-i) - \\sum_{j=1}^{n_b} b_j u(t-n_k-j)$。\n    - 第一个求和项 $\\sum_{i=1}^{n_a} a_i y(t-i)$ 涉及 $n_a$ 个形式为 $a_i \\times y(t-i)$ 的乘积。这需要 $n_a$ 次标量乘法。项 $y(t)$ 对应于 $A(q^{-1})$ 的首一部分，根据规则，乘以 1 的操作不计入。\n    - 第二个求和项 $\\sum_{j=1}^{n_b} b_j u(t-n_k-j)$ 涉及 $n_b$ 个形式为 $b_j \\times u(t-n_k-j)$ 的乘积。这需要 $n_b$ 次标量乘法。\n    计算 $v(t)$ 的乘法总数为 $n_a + n_b$。\n\n2.  **计算 $\\varepsilon(t)$ 的成本**：表达式为 $\\varepsilon(t) = v(t) - \\sum_{\\ell=1}^{n_c} c_\\ell \\varepsilon(t-\\ell)$。\n    - 求和项 $\\sum_{\\ell=1}^{n_c} c_\\ell \\varepsilon(t-\\ell)$ 涉及 $n_c$ 个形式为 $c_\\ell \\times \\varepsilon(t-\\ell)$ 的乘积。这需要 $n_c$ 次标量乘法。项 $v(t)$ 与 $C(q^{-1})$ 的首一部分相关，在此步骤中不涉及乘法。\n    从 $v(t)$ 计算 $\\varepsilon(t)$ 的乘法总数为 $n_c$。\n\n每个时间步 $t$ 的标量乘法总数是两个阶段成本的总和：\n$$\n\\text{每个时间步的乘法次数} = (n_a + n_b) + n_c = n_a + n_b + n_c\n$$\n此成本对于从 $t=1$ 到 $t=N$ 的每个时间步都是恒定的，因为问题指定了滤波器实现的固定循环边界。输入延迟 $n_k$ 影响使用 $u(t)$ 的哪些数据点，但不改变乘法次数。\n\n要计算整个序列 $\\{\\varepsilon(t)\\}_{t=1}^{N}$ 所需的标量乘法总数，我们将每步成本乘以总步数 $N$。\n$$\n\\text{总乘法次数} = N \\times (n_a + n_b + n_c)\n$$\n这就是总计算成本的最终闭式表达式。", "answer": "$$\n\\boxed{N (n_a + n_b + n_c)}\n$$", "id": "2751638"}, {"introduction": "获得参数的点估计值 $\\hat{\\theta}$ 只是系统辨识的第一步，评估其可靠性同样重要。本练习将指导您推导ARX模型最小二乘估计量的渐近协方差矩阵，这是量化参数不确定性的关键工具。掌握这一过程后，您将能够基于数据计算出参数的置信区间，从而科学地评估辨识结果的质量 [@problem_id:2751642]。", "problem": "考虑由下式给出的 $\\left(2,1\\right)$ 阶带外源输入的自回归 (ARX) 模型\n$$\ny(k) \\;=\\; -a_{1}\\,y(k-1)\\;-\\;a_{2}\\,y(k-2)\\;+\\;b_{1}\\,u(k-1)\\;+\\;e(k),\n$$\n其中 $e(k)$ 是一个零均值、独立同分布 (i.i.d.) 的扰动，其方差为 $\\sigma_{e}^{2}$，且与回归子过程无关。定义参数矢量 $\\theta_{0}=\\begin{pmatrix}a_{1} & a_{2} & b_{1}\\end{pmatrix}^{\\top}$ 和回归子 $\\varphi(k)=\\begin{pmatrix}-y(k-1) & -y(k-2) & u(k-1)\\end{pmatrix}^{\\top}$，从而有 $y(k)=\\varphi(k)^{\\top}\\theta_{0}+e(k)$。基于 $N$ 个样本的最小二乘 (LS) 估计量为\n$$\n\\hat{\\theta}_{N} \\;=\\; \\arg\\min_{\\theta}\\sum_{k=1}^{N}\\big(y(k)-\\varphi(k)^{\\top}\\theta\\big)^{2}.\n$$\n假设在线性回归中使用随机回归子时，最小二乘法的相合性与渐近正态性所需的标准正则性条件均成立：输入 $u(k)$ 是平稳的且至少为 3 阶持续激励，联合过程 $\\{\\varphi(k),e(k)\\}$ 是平稳和遍历的，$\\mathbb{E}\\big[\\varphi(k)\\,e(k)\\big]=0$，且 $\\lim_{N\\to\\infty}\\frac{1}{N}\\sum_{k=1}^{N}\\varphi(k)\\varphi(k)^{\\top}=R_{\\varphi}$ 存在且为正定矩阵。\n\n1) 从最小二乘估计量的定义和这些假设出发，推导缩放后的估计误差 $\\sqrt{N}\\big(\\hat{\\theta}_{N}-\\theta_{0}\\big)$ 的渐近协方差，并证明其等于\n$$\n\\Sigma_{\\theta} \\;=\\; \\sigma_{e}^{2}\\,R_{\\varphi}^{-1}.\n$$\n解释如何利用考虑了所估计参数数量的无偏方差估计量，从残差 $\\hat{e}(k)=y(k)-\\varphi(k)^{\\top}\\hat{\\theta}_{N}$ 来估计 $\\sigma_{e}^{2}$。\n\n2) 在一个包含 $N=1000$ 个样本和 $n_{p}=3$ 个估计参数的实验中，假设极限 $R_{\\varphi}=\\lim_{N\\to\\infty}\\frac{1}{N}\\sum_{k=1}^{N}\\varphi(k)\\varphi(k)^{\\top}$ 已知为\n$$\nR_{\\varphi} \\;=\\;\n\\begin{pmatrix}\n2.0 & 0.5 & 0.0\\\\\n0.5 & 1.5 & 0.2\\\\\n0.0 & 0.2 & 3.0\n\\end{pmatrix},\n$$\n且残差平方和为 $\\sum_{k=1}^{N}\\hat{e}(k)^{2}=997$。使用您所描述的无偏残差方差估计量，计算缩放后误差 $\\sqrt{N}\\big(\\hat{\\theta}_{N}-\\theta_{0}\\big)$ 的渐近协方差 $\\Sigma_{\\theta}$ 的数值矩阵。将最终矩阵的每个元素四舍五入到四位有效数字。以单个矩阵的形式提供最终答案，不带单位。", "solution": "所给问题是动态系统（具体地说是 ARX 模型）最小二乘估计量渐近分析的一个标准练习。该问题具有科学依据，是适定的，并包含了所有必要信息。问题有效。我们分两部分进行求解。\n\n第 1 部分：渐近协方差和无偏方差估计量的推导。\n\n最小二乘估计量 $\\hat{\\theta}_{N}$ 最小化了误差平方和 $J(\\theta) = \\sum_{k=1}^{N}(y(k)-\\varphi(k)^{\\top}\\theta)^{2}$。取最小值的的一阶条件为 $\\nabla_{\\theta}J(\\theta)|_{\\theta=\\hat{\\theta}_{N}} = 0$。由此可得正规方程：\n$$\n\\sum_{k=1}^{N}\\varphi(k)\\big(y(k)-\\varphi(k)^{\\top}\\hat{\\theta}_{N}\\big) \\;=\\; 0\n$$\n$$\n\\left(\\sum_{k=1}^{N}\\varphi(k)\\varphi(k)^{\\top}\\right)\\hat{\\theta}_{N} \\;=\\; \\sum_{k=1}^{N}\\varphi(k)y(k)\n$$\n真实系统由 $y(k)=\\varphi(k)^{\\top}\\theta_{0}+e(k)$ 给出。将其代入正规方程：\n$$\n\\left(\\sum_{k=1}^{N}\\varphi(k)\\varphi(k)^{\\top}\\right)\\hat{\\theta}_{N} \\;=\\; \\sum_{k=1}^{N}\\varphi(k)\\big(\\varphi(k)^{\\top}\\theta_{0}+e(k)\\big)\n$$\n$$\n\\left(\\sum_{k=1}^{N}\\varphi(k)\\varphi(k)^{\\top}\\right)\\hat{\\theta}_{N} \\;=\\; \\left(\\sum_{k=1}^{N}\\varphi(k)\\varphi(k)^{\\top}\\right)\\theta_{0} \\;+\\; \\sum_{k=1}^{N}\\varphi(k)e(k)\n$$\n重新整理各项以分离出估计误差 $\\hat{\\theta}_{N}-\\theta_{0}$：\n$$\n\\left(\\sum_{k=1}^{N}\\varphi(k)\\varphi(k)^{\\top}\\right)(\\hat{\\theta}_{N}-\\theta_{0}) \\;=\\; \\sum_{k=1}^{N}\\varphi(k)e(k)\n$$\n$$\n\\hat{\\theta}_{N}-\\theta_{0} \\;=\\; \\left(\\sum_{k=1}^{N}\\varphi(k)\\varphi(k)^{\\top}\\right)^{-1}\\left(\\sum_{k=1}^{N}\\varphi(k)e(k)\\right)\n$$\n为分析其渐近分布，我们将误差乘以 $\\sqrt{N}$ 进行缩放：\n$$\n\\sqrt{N}(\\hat{\\theta}_{N}-\\theta_{0}) \\;=\\; \\left(\\frac{1}{N}\\sum_{k=1}^{N}\\varphi(k)\\varphi(k)^{\\top}\\right)^{-1}\\left(\\frac{1}{\\sqrt{N}}\\sum_{k=1}^{N}\\varphi(k)e(k)\\right)\n$$\n我们分析当 $N\\to\\infty$ 时右侧的两项。\n对于第一项，根据过程是遍历的且极限存在的假设，大数定律意味着：\n$$\n\\frac{1}{N}\\sum_{k=1}^{N}\\varphi(k)\\varphi(k)^{\\top} \\;\\xrightarrow{p}\\; \\mathbb{E}\\big[\\varphi(k)\\varphi(k)^{\\top}\\big] \\;=\\; R_{\\varphi}\n$$\n其中 $\\xrightarrow{p}$ 表示依概率收敛。由于矩阵求逆是连续函数，根据连续映射定理可得：\n$$\n\\left(\\frac{1}{N}\\sum_{k=1}^{N}\\varphi(k)\\varphi(k)^{\\top}\\right)^{-1} \\;\\xrightarrow{p}\\; R_{\\varphi}^{-1}\n$$\n对于第二项，我们考虑和 $S_{N} = \\frac{1}{\\sqrt{N}}\\sum_{k=1}^{N}\\varphi(k)e(k)$。根据假设，矢量过程 $v(k)=\\varphi(k)e(k)$ 的均值为零，因为 $\\mathbb{E}[v(k)] = \\mathbb{E}[\\varphi(k)e(k)] = 0$。此外，对于由 $\\{e(j), u(j)\\}_{j \\le k-1}$ 生成的$\\sigma$-代数流（信息流） $\\mathcal{F}_{k-1}$，$v(k)$ 是一个鞅差序列，因为 $\\mathbb{E}[v(k) | \\mathcal{F}_{k-1}] = \\varphi(k)\\mathbb{E}[e(k) | \\mathcal{F}_{k-1}] = \\varphi(k)\\cdot 0 = 0$。\n鞅差序列的中心极限定理指出，$S_{N}$ 依分布收敛于一个均值为零、协方差矩阵为 $Q$ 的正态分布随机矢量：\n$$\n\\frac{1}{\\sqrt{N}}\\sum_{k=1}^{N}\\varphi(k)e(k) \\;\\xrightarrow{d}\\; \\mathcal{N}(0, Q)\n$$\n其中 $\\xrightarrow{d}$ 表示依分布收敛，协方差矩阵 $Q$ 由下式给出：\n$$\nQ \\;=\\; \\lim_{N\\to\\infty} \\frac{1}{N}\\sum_{k=1}^{N}\\mathbb{E}\\big[(\\varphi(k)e(k))(\\varphi(k)e(k))^{\\top}\\big] \\;=\\; \\mathbb{E}\\big[\\varphi(k)\\varphi(k)^{\\top}e(k)^{2}\\big]\n$$\n由于 $e(k)$ 与回归子 $\\varphi(k)$（它依赖于过去的数据）无关，我们可以将期望分开：\n$$\nQ \\;=\\; \\mathbb{E}\\big[\\varphi(k)\\varphi(k)^{\\top}\\big]\\,\\mathbb{E}\\big[e(k)^{2}\\big] \\;=\\; R_{\\varphi}\\,\\sigma_{e}^{2}\n$$\n使用 Slutsky 定理结合这两个结果，我们得到缩放后估计误差的渐近分布：\n$$\n\\sqrt{N}(\\hat{\\theta}_{N}-\\theta_{0}) \\;\\xrightarrow{d}\\; R_{\\varphi}^{-1} \\cdot \\mathcal{N}(0, \\sigma_{e}^{2}R_{\\varphi})\n$$\n$\\sqrt{N}(\\hat{\\theta}_{N}-\\theta_{0})$ 的渐近协方差是所得正态分布的协方差。设 $X \\sim \\mathcal{N}(0, \\sigma_{e}^{2}R_{\\varphi})$。$R_{\\varphi}^{-1}X$ 的协方差为：\n$$\n\\text{Cov}(R_{\\varphi}^{-1}X) \\;=\\; R_{\\varphi}^{-1}\\,\\text{Cov}(X)\\,(R_{\\varphi}^{-1})^{\\top} \\;=\\; R_{\\varphi}^{-1}(\\sigma_{e}^{2}R_{\\varphi})(R_{\\varphi}^{-1})^{\\top}\n$$\n由于 $R_{\\varphi}$ 是对称的，$R_{\\varphi}^{-1}$ 也是对称的，因此 $(R_{\\varphi}^{-1})^{\\top} = R_{\\varphi}^{-1}$。\n$$\n\\Sigma_{\\theta} \\;=\\; \\sigma_{e}^{2}R_{\\varphi}^{-1}R_{\\varphi}R_{\\varphi}^{-1} \\;=\\; \\sigma_{e}^{2}R_{\\varphi}^{-1}\n$$\n这就完成了第一部分的推导。\n\n对于第二部分，我们必须找到噪声方差 $\\sigma_{e}^{2}$ 的无偏估计量。残差平方和 (SSR) 为 $\\sum_{k=1}^{N}\\hat{e}(k)^{2}$，其中 $\\hat{e}(k)=y(k)-\\varphi(k)^{\\top}\\hat{\\theta}_{N}$。一个朴素的估计量 $\\frac{1}{N}\\sum_{k=1}^{N}\\hat{e}(k)^{2}$是有偏的。无偏估计量需要对从数据中估计的参数数量 $n_{p}$ 进行修正。SSR的期望是 $\\mathbb{E}\\big[\\sum_{k=1}^{N}\\hat{e}(k)^{2}\\big] = (N-n_{p})\\sigma_{e}^{2}$。这是线性回归理论中的一个标准结果，其中 $n_{p}$ 表示拟合模型参数所消耗的自由度。因此，$\\sigma_{e}^{2}$ 的一个无偏估计量是：\n$$\n\\hat{\\sigma}_{e}^{2} \\;=\\; \\frac{1}{N-n_{p}}\\sum_{k=1}^{N}\\hat{e}(k)^{2}\n$$\n\n第 2 部分：数值计算。\n\n我们已知以下数值：\n样本数 $N=1000$。\n参数数量 $n_{p}=3$。\n残差平方和 $\\sum_{k=1}^{N}\\hat{e}(k)^{2} = 997$。\n回归子协方差矩阵已知为：\n$$\nR_{\\varphi} \\;=\\;\n\\begin{pmatrix}\n2.0 & 0.5 & 0.0\\\\\n0.5 & 1.5 & 0.2\\\\\n0.0 & 0.2 & 3.0\n\\end{pmatrix}\n$$\n首先，我们使用上面推导的公式计算噪声方差 $\\sigma_{e}^{2}$ 的无偏估计：\n$$\n\\hat{\\sigma}_{e}^{2} \\;=\\; \\frac{\\sum_{k=1}^{N}\\hat{e}(k)^{2}}{N-n_{p}} \\;=\\; \\frac{997}{1000-3} \\;=\\; \\frac{997}{997} \\;=\\; 1\n$$\n现在，我们计算渐近协方差矩阵 $\\Sigma_{\\theta} = \\hat{\\sigma}_{e}^{2}R_{\\varphi}^{-1} = 1 \\cdot R_{\\varphi}^{-1}$。我们需要求 $R_{\\varphi}$ 的逆矩阵。对于一个 $3 \\times 3$ 矩阵 $A$，其逆为 $A^{-1} = \\frac{1}{\\det(A)}\\text{adj}(A)$。\n$R_{\\varphi}$ 的行列式是：\n$$\n\\det(R_{\\varphi}) \\;=\\; 2.0\\big((1.5)(3.0)-(0.2)(0.2)\\big) - 0.5\\big((0.5)(3.0)-(0.2)(0.0)\\big) + 0.0\\big(\\dots\\big)\n$$\n$$\n\\det(R_{\\varphi}) \\;=\\; 2.0(4.5-0.04) - 0.5(1.5) \\;=\\; 2.0(4.46) - 0.75 \\;=\\; 8.92 - 0.75 \\;=\\; 8.17\n$$\n伴随矩阵 $\\text{adj}(R_{\\varphi})$ 是代数余子式矩阵的转置。由于 $R_{\\varphi}$ 是对称的，它的代数余子式矩阵也是对称的，因此 $\\text{adj}(R_{\\varphi})$ 就是代数余子式矩阵本身。\n代数余子式为：\n$C_{11} = +(1.5 \\cdot 3.0 - 0.2 \\cdot 0.2) = 4.46$\n$C_{12} = -(0.5 \\cdot 3.0 - 0.2 \\cdot 0.0) = -1.5$\n$C_{13} = +(0.5 \\cdot 0.2 - 1.5 \\cdot 0.0) = 0.1$\n$C_{21} = C_{12} = -1.5$\n$C_{22} = +(2.0 \\cdot 3.0 - 0.0 \\cdot 0.0) = 6.0$\n$C_{23} = -(2.0 \\cdot 0.2 - 0.5 \\cdot 0.0) = -0.4$\n$C_{31} = C_{13} = 0.1$\n$C_{32} = C_{23} = -0.4$\n$C_{33} = +(2.0 \\cdot 1.5 - 0.5 \\cdot 0.5) = 2.75$\n所以，伴随矩阵是：\n$$\n\\text{adj}(R_{\\varphi}) \\;=\\;\n\\begin{pmatrix}\n4.46 & -1.5 & 0.1\\\\\n-1.5 & 6.0 & -0.4\\\\\n0.1 & -0.4 & 2.75\n\\end{pmatrix}\n$$\n现在，我们求 $R_{\\varphi}^{-1}$：\n$$\nR_{\\varphi}^{-1} \\;=\\; \\frac{1}{8.17}\n\\begin{pmatrix}\n4.46 & -1.5 & 0.1\\\\\n-1.5 & 6.0 & -0.4\\\\\n0.1 & -0.4 & 2.75\n\\end{pmatrix}\n$$\n$$\nR_{\\varphi}^{-1} \\;=\\;\n\\begin{pmatrix}\n\\frac{4.46}{8.17} & \\frac{-1.5}{8.17} & \\frac{0.1}{8.17}\\\\\n\\frac{-1.5}{8.17} & \\frac{6.0}{8.17} & \\frac{-0.4}{8.17}\\\\\n\\frac{0.1}{8.17} & \\frac{-0.4}{8.17} & \\frac{2.75}{8.17}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n0.5458996\\dots & -0.1835985\\dots & 0.0122399\\dots\\\\\n-0.1835985\\dots & 0.7343941\\dots & -0.0489596\\dots\\\\\n0.0122399\\dots & -0.0489596\\dots & 0.3366009\\dots\n\\end{pmatrix}\n$$\n将每个元素四舍五入到四位有效数字，得到 $\\Sigma_{\\theta}$ 的最终矩阵：\n$$\n\\Sigma_{\\theta} \\;=\\;\n\\begin{pmatrix}\n0.5459 & -0.1836 & 0.01224\\\\\n-0.1836 & 0.7344 & -0.04896\\\\\n0.01224 & -0.04896 & 0.3366\n\\end{pmatrix}\n$$\n这就是渐近协方差矩阵的最终数值结果。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5459 & -0.1836 & 0.01224 \\\\\n-0.1836 & 0.7344 & -0.04896 \\\\\n0.01224 & -0.04896 & 0.3366\n\\end{pmatrix}\n}\n$$", "id": "2751642"}]}