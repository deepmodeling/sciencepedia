{"hands_on_practices": [{"introduction": "回路传递恢复 (LTR) 本质上是一种回路成形技术，其核心在于精确地设计目标回路。本练习将带您回归基本原理，通过一个简单的标量系统，推导噪声协方差之比 $r \\equiv W_0/V_0$ 与卡尔曼滤波器回路交叉频率 $\\omega_c$ 之间的直接关系。这个实践揭示了 LTR 设计中的一个关键“调谐旋钮”，让您亲手掌握如何从头构建一个具有特定性能指标的目标回路。[@problem_id:2721063]", "problem": "考虑一个单输入单输出连续时间系统，其状态空间实现为\n$$\n\\dot{x}(t) = 0 \\cdot x(t) + u(t) + w(t), \\quad y(t) = 1 \\cdot x(t) + v(t),\n$$\n其中 $x(t) \\in \\mathbb{R}$，$u(t) \\in \\mathbb{R}$，$y(t) \\in \\mathbb{R}$。扰动 $w(t)$ 和测量噪声 $v(t)$ 是相互独立的零均值高斯白噪声过程，其恒定谱密度（单位时间的协方差）分别为 $W_0 > 0$ 和 $V_0 > 0$。对于稳态 Kalman-Bucy 滤波器（KBF），将稳态误差协方差记为 $P$，稳态卡尔曼增益记为 $K_f$。关于 $P$ 的代数 Riccati 方程为\n$$\n0 \\cdot P + P \\cdot 0 - P \\cdot 1 \\cdot V_0^{-1} \\cdot 1 \\cdot P + W_0 = 0,\n$$\n稳态卡尔曼增益为\n$$\nK_f = P \\cdot 1 \\cdot V_0^{-1}.\n$$\n在系统输出端的线性二次高斯（LQG）环路传递恢复（LTR）背景下，卡尔曼滤波器环路定义为\n$$\nL_f(s) = 1 \\cdot (s I - 0)^{-1} K_f = \\frac{K_f}{s}.\n$$\n假设指定一个相对阶为 1、滚降率为 -20 dB/十倍频的有理目标环路为\n$$\nL_d(s) = \\frac{\\omega_c}{s},\n$$\n其中期望的穿越频率为 $\\omega_c > 0$，使得 $|L_d(\\mathrm{j}\\,\\omega_c)| = 1$ 且 $\\arg L_d(\\mathrm{j}\\,\\omega_c) = -\\frac{\\pi}{2}$。仅使用第一性原理（代数 Riccati 方程和 Kalman-Bucy 增益的定义），选择 $W_0$ 和 $V_0$，使得 $L_f(s)$ 在 $\\omega = \\omega_c$ 处的幅值和相位均与 $L_d(s)$ 匹配。为实现此匹配的最小设计参数\n$$\nr \\equiv \\frac{W_0}{V_0}\n$$\n推导一个闭式表达式。将最终答案表示为 $\\omega_c$ 的符号函数（无量纲）。最终表达式中不需要数值四舍五入，也不应包含任何物理单位。", "solution": "所述问题在科学上是合理的，自洽的，并且在线性控制理论的框架内是适定的。它构成了为环路传递恢复（LTR）设计观测器的一个标准练习。所有给出的定义和方程都与既定理论一致。因此，我们开始求解。\n\n该系统是一个单输入单输出（SISO）连续时间系统，由以下状态空间方程描述：\n$$\n\\dot{x}(t) = A x(t) + B u(t) + G w(t)\n$$\n$$\ny(t) = C x(t) + v(t)\n$$\n根据问题陈述，系统矩阵均为标量，分别为 $A=0$，过程噪声输入矩阵为 $G=1$，输出矩阵为 $C=1$。状态 $x(t)$、输入 $u(t)$ 和输出 $y(t)$ 均在 $\\mathbb{R}$ 中。过程噪声 $w(t)$ 和测量噪声 $v(t)$ 是高斯白噪声过程，其谱密度分别为 $W_0 > 0$ 和 $V_0 > 0$。\n\n目标是求出比率 $r \\equiv \\frac{W_0}{V_0}$，使得卡尔曼滤波器环路传递函数 $L_f(s)$ 在特定频率 $\\omega_c$ 处与期望的目标环路传递函数 $L_d(s)$ 相匹配。\n\n首先，我们求解代数 Riccati 方程（ARE）以得到稳态误差协方差 $P$。对于这个标量系统，ARE 形式如下：\n$$\nA P + P A^T - P C^T V_0^{-1} C P + G W_0 G^T = 0\n$$\n代入给定的标量值 $A=0$，$C=1$ 和 $G=1$：\n$$\n0 \\cdot P + P \\cdot 0 - P \\cdot 1 \\cdot V_0^{-1} \\cdot 1 \\cdot P + 1 \\cdot W_0 \\cdot 1 = 0\n$$\n这可以简化为关于 $P$ 的一个标量代数方程：\n$$\nW_0 - \\frac{P^2}{V_0} = 0\n$$\n$$\nP^2 = W_0 V_0\n$$\n由于误差协方差 $P$ 必须为非负，我们取正根：\n$$\nP = \\sqrt{W_0 V_0}\n$$\n接下来，我们确定稳态卡尔曼增益 $K_f$。其公式为：\n$$\nK_f = P C^T V_0^{-1}\n$$\n代入 $P = \\sqrt{W_0 V_0}$ 和 $C=1$：\n$$\nK_f = (\\sqrt{W_0 V_0}) \\cdot 1 \\cdot V_0^{-1} = \\frac{\\sqrt{W_0 V_0}}{V_0}\n$$\n这可以通过将 $V_0$ 移入平方根内来简化：\n$$\nK_f = \\sqrt{\\frac{W_0 V_0}{V_0^2}} = \\sqrt{\\frac{W_0}{V_0}}\n$$\n使用设计参数的定义 $r \\equiv \\frac{W_0}{V_0}$，卡尔曼增益表示为：\n$$\nK_f = \\sqrt{r}\n$$\n在系统输出端断开的卡尔曼滤波器环路传递函数由 $L_f(s) = C(sI - A)^{-1} K_f$ 给出。对于这个标量系统，$I=1$。\n$$\nL_f(s) = 1 \\cdot (s \\cdot 1 - 0)^{-1} K_f = \\frac{K_f}{s}\n$$\n代入 $K_f$ 的表达式：\n$$\nL_f(s) = \\frac{\\sqrt{r}}{s}\n$$\n目标环路指定为 $L_d(s) = \\frac{\\omega_c}{s}$。问题要求在频率 $\\omega = \\omega_c$ 处，使 $L_f(s)$ 和 $L_d(s)$ 的幅值和相位都匹配。\n\n让我们通过代入 $s = \\mathrm{j}\\omega$ 来检验两个环路的频率响应：\n$$\nL_f(\\mathrm{j}\\omega) = \\frac{\\sqrt{r}}{\\mathrm{j}\\omega}, \\quad L_d(\\mathrm{j}\\omega) = \\frac{\\omega_c}{\\mathrm{j}\\omega}\n$$\n两个函数的相位均为：\n$$\n\\arg(L_f(\\mathrm{j}\\omega)) = \\arg(L_d(\\mathrm{j}\\omega)) = \\arg\\left(\\frac{1}{\\mathrm{j}}\\right) = -\\frac{\\pi}{2}\n$$\n对于任意 $\\omega > 0$。因此，由于两个传递函数的结构相同，在 $\\omega = \\omega_c$ 处的相位匹配条件自动满足。\n\n剩下的条件是在 $\\omega = \\omega_c$ 处匹配幅值：\n$$\n|L_f(\\mathrm{j}\\omega_c)| = |L_d(\\mathrm{j}\\omega_c)|\n$$\n我们计算等式两边的幅值：\n$$\n|L_f(\\mathrm{j}\\omega_c)| = \\left|\\frac{\\sqrt{r}}{\\mathrm{j}\\omega_c}\\right| = \\frac{\\sqrt{r}}{\\omega_c}\n$$\n$$\n|L_d(\\mathrm{j}\\omega_c)| = \\left|\\frac{\\omega_c}{\\mathrm{j}\\omega_c}\\right| = \\left|\\frac{1}{\\mathrm{j}}\\right| = 1\n$$\n将两个幅值相等，得到关于 $r$ 的方程：\n$$\n\\frac{\\sqrt{r}}{\\omega_c} = 1\n$$\n解出 $r$：\n$$\n\\sqrt{r} = \\omega_c\n$$\n由于 $\\omega_c > 0$，我们可以对两边进行平方而不会产生歧义：\n$$\nr = \\omega_c^2\n$$\n这就是实现指定环路传递恢复目标的设计参数 $r$ 的闭式表达式。", "answer": "$$\n\\boxed{\\omega_c^{2}}\n$$", "id": "2721063"}, {"introduction": "理论上的收敛性需要通过数值实践来验证，这是控制工程师必备的技能。本练习将指导您实现一个完整的 LQR/LQG 控制器设计，并运用频率响应分析方法，直观且定量地确认回路传递恢复的效果。您将通过编写代码来观察，随着 LTR 调谐参数 $\\alpha$ 的增加，LQG 回路传递函数的大小 $|L_{\\mathrm{LQG}}(j \\omega)|$ 是如何逐步逼近具有优良鲁棒性的 LQR 目标回路 $|L_{\\mathrm{LQR}}(j \\omega)|$ 的。[@problem_id:2751321]", "problem": "给定一个具有实系数的连续时间、单输入单输出、线性时不变状态空间模型。您的任务是为线性二次高斯 (LQG) 调节器实现环路传递恢复 (LTR) 的数值研究，并验证实数系统的根轨迹对称性。您的程序必须计算线性二次调节器 (LQR)、针对多个线性二次高斯 (LQG) 噪声强度值的 Kalman 滤波器，以及频域环路传递幅值，以证明随着环路传递恢复 (LTR) 调节参数的增加，LQG 输入环路传递函数逼近状态反馈 LQR 环路传递函数。此外，您的程序必须通过计算在标量增益变化下的闭环状态矩阵的特征值，来检验根轨迹的对称性。\n\n使用以下给定的被控对象和设计数据：\n- 状态矩阵：\n$$\nA = \\begin{bmatrix}\n0 & 1 & 0 \\\\\n0 & 0 & 1 \\\\\n-3 & -3 & -1\n\\end{bmatrix}\n$$\n- 输入矩阵：\n$$\nB = \\begin{bmatrix}\n0 \\\\\n0 \\\\\n1\n\\end{bmatrix}\n$$\n- 输出矩阵：\n$$\nC = \\begin{bmatrix}\n1 & 0 & 0\n\\end{bmatrix}\n$$\n- 直接馈通：\n$$\nD = \\begin{bmatrix}\n0\n\\end{bmatrix}\n$$\n\n使用标准代数 Riccati 方程，设计一个线性二次调节器 (LQR) 状态反馈增益，其中：\n- 状态加权：\n$$\nQ = \\mathrm{diag}(10,\\,1,\\,1)\n$$\n- 控制加权：\n$$\nR = \\begin{bmatrix}\n1\n\\end{bmatrix}\n$$\n\n使用估计器代数 Riccati 方程设计一个连续时间稳态 Kalman 滤波器（线性二次高斯 (LQG) 调节器的估计器部分），其测量噪声协方差和过程噪声协方差定义如下：\n- 测量噪声协方差：\n$$\nV = \\begin{bmatrix}\n1\n\\end{bmatrix}\n$$\n- 用于环路传递恢复 (LTR) 的过程噪声协方差：\n$$\nW(\\alpha) = \\alpha \\, I_3\n$$\n调节参数值为\n$$\n\\alpha \\in \\{10^{-3},\\,10^{-1},\\,10^{1},\\,10^{3}\\}.\n$$\n\n在复频域 $s = j \\omega$（其中 $\\omega > 0$）中定义以下传递函数：\n1. 被控对象输入端的状态反馈 LQR 环路传递函数（一个标量传递函数）：\n$$\nL_{\\mathrm{LQR}}(s) \\triangleq K \\, (s I - A)^{-1} B,\n$$\n其中 $K$ 是 LQR 增益。\n2. 由被控对象、估计器和 LQR 增益构成的线性二次高斯 (LQG) 输入环路传递函数：\n$$\nL_{\\mathrm{LQG}}(s;\\alpha) \\triangleq K \\left(s I - (A - B K - L(\\alpha) C)\\right)^{-1} L(\\alpha) \\, C \\, (s I - A)^{-1} B,\n$$\n其中 $L(\\alpha)$ 是通过解带有 $W(\\alpha)$ 和 $V$ 的估计器 Riccati 方程得到的 Kalman 滤波器增益。\n\n您的程序必须：\n- 计算 LQR 增益 $K$，并为每个指定的 $\\alpha$ 计算 Kalman 增益 $L(\\alpha)$。\n- 在对数间隔的频率网格\n$$\n\\omega \\in \\left[10^{-2},\\,10^{2}\\right] \\ \\text{弧度/秒}\n$$\n上，以至少 $100$ 个点计算幅值 $\\lvert L_{\\mathrm{LQR}}(j \\omega)\\rvert$ 和 $\\lvert L_{\\mathrm{LQG}}(j \\omega;\\alpha)\\rvert$。\n- 对于每个 $\\alpha$，计算在频率网格上的平均相对幅值误差：\n$$\nE(\\alpha) \\triangleq \\frac{1}{N} \\sum_{i=1}^{N} \\frac{\\left|\\,\\lvert L_{\\mathrm{LQG}}(j \\omega_i;\\alpha)\\rvert - \\lvert L_{\\mathrm{LQR}}(j \\omega_i)\\rvert\\,\\right|}{\\lvert L_{\\mathrm{LQR}}(j \\omega_i)\\rvert + \\varepsilon},\n$$\n其中 $N$ 是频率点数，$\\varepsilon = 10^{-9}$ 是一个小的正数，以避免除以零。\n\n此外，按如下方式数值验证根轨迹的对称性。对于形如\n$$\nA_{\\gamma} \\triangleq A - \\gamma \\, B K,\n$$\n的实数闭环状态矩阵，其中标量增益 $\\gamma > 0$，其特征值应关于实轴对称；也就是说，如果 $\\lambda$ 是一个虚部不为零的特征值，那么它的复共轭 $\\overline{\\lambda}$ 也必须是一个特征值。对\n$$\n\\gamma \\in \\{10^{-1},\\, 1,\\, 10\\}\n$$\n测试此性质。在虚部和成对匹配上定义一个数值容差 $\\tau = 10^{-7}$。\n\n待实现和评估的测试套件：\n- LTR 调节参数：\n$$\n\\alpha \\in \\{10^{-3},\\,10^{-1},\\,10^{1},\\,10^{3}\\}.\n$$\n- 根轨迹增益值：\n$$\n\\gamma \\in \\{10^{-1},\\, 1,\\, 10\\}.\n$$\n- 频率网格：\n$$\n\\omega \\in \\left[10^{-2},\\,10^{2}\\right] \\ \\text{弧度/秒}\n$$\n使用 $N = 150$ 个对数间隔点。\n\n输出规范：\n- 您的程序必须输出单行，包含一个有五个条目的列表：\n    - 四个浮点数值，按顺序对应于 $E(10^{-3})$、$E(10^{-1})$、$E(10^{1})$ 和 $E(10^{3})$。\n    - 一个布尔值，表示对于所有测试的 $\\gamma$ 值，在容差 $\\tau$ 内根轨迹对称性是否成立。\n- 输出必须严格按照方括号括起来的逗号分隔列表格式打印，例如：\n$$\n[\\text{E1},\\text{E2},\\text{E3},\\text{E4},\\text{bool}]\n$$\n不应打印任何额外文本。\n\n所有数值都是无量纲的，不需要物理单位。根据 $s = j \\omega$ 的定义，角度（频率）的单位是弧度/秒，并且必须如此处理。误差指标的最终答案必须是浮点数，对称性验证必须是布尔值。您的解决方案必须是计算上自包含的，并且不需要任何用户输入。", "solution": "问题陈述已经过严格验证，并被认为是有效的。它在科学上基于现代控制理论的原理，特别涉及线性二次调节器 (LQR)、线性二次高斯 (LQG) 控制器的设计与分析，以及相关的环路传递恢复 (LTR) 方法。该问题是适定的，所有必要的参数和定义都已提供，以确保一个唯一的、可计算的解。所有术语都是客观且精确定义的。我们现在将着手进行一个系统的、基于原理的求解。\n\n该解法分为四个主要部分：\n1.  LQR 状态反馈增益 $K$ 的综合。\n2.  针对每个指定的噪声强度参数 $\\alpha$，综合 Kalman 滤波器增益 $L(\\alpha)$。\n3.  通过比较 LQR 和 LQG 环路传递函数的频率响应，对环路传递恢复进行数值评估。\n4.  对实数线性系统的根轨迹对称性进行数值验证。\n\n**1. LQR 控制器综合**\n\nLQR 设计的目标是找到最优的状态反馈增益矩阵 $K$，用于控制律 $u = -Kx$，以最小化二次型代价函数：\n$$\nJ = \\int_{0}^{\\infty} (x^T Q x + u^T R u) \\, dt\n$$\n对于一个连续时间线性时不变 (LTI) 系统 $\\dot{x} = Ax + Bu$，最优增益 $K$ 首先通过求解连续时间代数 Riccati 方程 (CARE) 得到唯一的、对称的、半正定矩阵 $P$ 来找到：\n$$\nA^T P + P A - P B R^{-1} B^T P + Q = 0\n$$\n给定系统矩阵 $A$ 和 $B$ 以及加权矩阵 $Q = \\mathrm{diag}(10, 1, 1)$ 和 $R = [1]$，我们求解此方程以得到 $P$。系统对 $(A, B)$ 是可控的，系统对 $(A, Q^{1/2})$ 是可观的，这保证了存在一个唯一的正定解 $P$，该解能稳定闭环系统 $A-BK$。\n\n然后，最优 LQR 增益计算如下：\n$$\nK = R^{-1} B^T P\n$$\n该增益矩阵 $K$ 将用于状态反馈环路传递函数和构建 LQG 控制器。\n\n**2. Kalman 滤波器综合**\n\nLQG 控制器使用一个状态估计器，在本例中是一个连续时间稳态 Kalman 滤波器。该滤波器基于测量输出 $y = Cx + v$ 来估计系统状态 $x$，其中 $v$ 是测量噪声。系统动态由过程噪声 $w$ 驱动，即 $\\dot{x} = Ax + Bu + w$。滤波器设计需要求解 CARE 的对偶形式。滤波器误差协方差矩阵 $X$ 是估计器 ARE 的对称、半正定解：\n$$\nA X + X A^T - X C^T V^{-1} C X + W = 0\n$$\n这里，$W$ 和 $V$ 分别是过程噪声和测量噪声的协方差矩阵。给定 $V = [1]$ 和一个可调的过程噪声协方差 $W(\\alpha) = \\alpha I_3$，其中 $\\alpha$ 是 LTR 调节参数，取值为 $\\{10^{-3}, 10^{-1}, 10^{1}, 10^{3}\\}$。系统对 $(A, C)$ 是可观的，并且对于 $\\alpha > 0$，系统对 $(A, W(\\alpha)^{1/2})$ 是可控的，确保对于每个 $\\alpha$ 都存在一个唯一的、正定的、稳定的解 $X$。\n\n然后，Kalman 滤波器增益 $L(\\alpha)$ 计算如下：\n$$\nL(\\alpha) = X C^T V^{-1}\n$$\n对每个 $\\alpha$ 值重复此过程。\n\n**3. 环路传递恢复 (LTR) 分析**\n\nLTR 是一种塑造 LQG 系统环路传递函数以恢复目标 LQR 环路期望特性（如鲁棒性）的过程。我们将数值验证随着参数 $\\alpha$ 的增加，LQG 环路传递函数收敛于 LQR 环路传递函数。\n\n首先，我们定义 LQR 环路传递函数（在被控对象输入端断开环路）：\n$$\nL_{\\mathrm{LQR}}(s) = K (s I - A)^{-1} B\n$$\n接下来，我们使用问题中定义的 LQG 输入环路传递函数，它结合了被控对象 $G_p(s) = C(sI-A)^{-1}B$ 和 LQG 补偿器：\n$$\nL_{\\mathrm{LQG}}(s;\\alpha) = K \\left(s I - (A - B K - L(\\alpha) C)\\right)^{-1} L(\\alpha) \\, C \\, (s I - A)^{-1} B\n$$\nLTR 定理指出，在特定条件下，当过程噪声强度相对于测量噪声增加时（即 $\\alpha \\to \\infty$），LQG 环路传递函数的幅值应逼近 LQR 环路的幅值。我们将在具有 $N=150$ 个点的对数频率网格 $\\omega \\in [10^{-2}, 10^{2}]$ 上评估幅值 $|L_{\\mathrm{LQR}}(j\\omega)|$ 和 $|L_{\\mathrm{LQG}}(j\\omega; \\alpha)|$。\n\n对于每个 $\\alpha$，我们使用平均相对幅值误差来量化恢复误差：\n$$\nE(\\alpha) = \\frac{1}{N} \\sum_{i=1}^{N} \\frac{\\left|\\,|L_{\\mathrm{LQG}}(j \\omega_i;\\alpha)| - |L_{\\mathrm{LQR}}(j \\omega_i)|\\,\\right|}{|L_{\\mathrm{LQR}}(j \\omega_i)| + \\varepsilon}\n$$\n其中 $\\varepsilon = 10^{-9}$ 是一个正则化常数。我们期望 $E(\\alpha)$ 随着 $\\alpha$ 的增加而减小。\n\n**4. 根轨迹对称性验证**\n\n由实数值矩阵描述的任何 LTI 系统的一个基本性质是其特征多项式具有实系数。因此，该多项式的根——即系统的特征值——必须以复共轭对的形式出现。如果 $\\lambda$ 是一个特征值，那么它的复共轭 $\\overline{\\lambda}$ 也必须是一个特征值。\n\n我们将针对一个变化的标量增益 $\\gamma > 0$ 来验证闭环系统矩阵 $A_{\\gamma} = A - \\gamma B K$ 的此性质。我们将计算当 $\\gamma \\in \\{10^{-1}, 1, 10\\}$ 时 $A_{\\gamma}$ 的特征值。对于每一组特征值，我们将执行一次数值检查。复特征值（虚部超过容差 $\\tau = 10^{-7}$ 的特征值）的集合将被划分。然后我们验证，对于集合中的每个复特征值 $\\lambda = a + jb$，其共轭 $\\overline{\\lambda} = a - jb$ 在指定的容差范围内也存在。如果对于所有测试的 $\\gamma$ 值，所有复特征值都能成功配对，则认为该性质成立。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_continuous_are\n\ndef solve():\n    \"\"\"\n    Performs a numerical study of Loop Transfer Recovery (LTR) for an LQG regulator\n    and verifies the symmetric root locus property for a given LTI system.\n    \"\"\"\n    # Define constants and system matrices from the problem statement.\n    A = np.array([[0., 1., 0.], [0., 0., 1.], [-3., -3., -1.]])\n    B = np.array([[0.], [0.], [1.]])\n    C = np.array([[1., 0., 0.]])\n    # D is zero and not explicitly needed for the requested calculations.\n\n    # LQR design parameters\n    Q = np.diag([10., 1., 1.])\n    R = np.array([[1.]])\n\n    # LTR and Kalman filter parameters\n    alphas = [1e-3, 1e-1, 1e1, 1e3]\n    V = np.array([[1.]])\n\n    # Symmetric root locus parameters\n    gammas = [1e-1, 1., 10.]\n\n    # Numerical parameters\n    N_omega = 150\n    omega = np.logspace(-2, 2, N_omega)\n    epsilon = 1e-9\n    tau = 1e-7\n\n    # --- Part 1: LQR Controller Synthesis ---\n    # Solve the continuous-time Algebraic Riccati Equation (CARE) for P\n    # A'P + PA - PBR^-1B'P + Q = 0\n    try:\n        P = solve_continuous_are(A, B, Q, R)\n    except np.linalg.LinAlgError:\n        print(\"[Error: LQR Riccati solver failed]\")\n        return\n        \n    # Calculate the LQR gain K = R^-1 B' P\n    K = np.linalg.inv(R) @ B.T @ P\n\n    # --- Part 2 & 3: LTR Analysis ---\n    #\n    # 2.1: Evaluate the LQR loop transfer magnitude |L_LQR(jw)|\n    s_grid = 1j * omega\n    mag_lqr = np.zeros(N_omega, dtype=float)\n    inv_sI_A_grid = np.array([np.linalg.inv(s * np.identity(3) - A) for s in s_grid])\n    for i in range(N_omega):\n        # L_LQR(s) = K * (sI - A)^-1 * B\n        L_lqr_s = K @ inv_sI_A_grid[i] @ B\n        mag_lqr[i] = np.abs(L_lqr_s[0, 0])\n\n    errors = []\n    for alpha in alphas:\n        # 2.2: Design Kalman filter for the current alpha\n        # Process noise covariance W(alpha) = alpha * I_3\n        W = alpha * np.identity(3)\n        \n        # Solve the dual CARE for the filter error covariance X\n        # AX + XA' - XC'V^-1CX + W = 0\n        # Use solver with substitutions: A.T, C.T, V, W\n        try:\n            X = solve_continuous_are(A.T, C.T, W, V)\n        except np.linalg.LinAlgError:\n            print(f\"[Error: Kalman Riccati solver failed for alpha={alpha}]\")\n            return\n\n        # Calculate the Kalman gain L = X C' V^-1\n        L_gain = X @ C.T @ np.linalg.inv(V)\n\n        # 2.3: Evaluate the LQG loop transfer magnitude |L_LQG(jw; alpha)|\n        mag_lqg = np.zeros(N_omega, dtype=float)\n        # LQG closed-loop system matrix for the controller state\n        A_lqg_controller = A - B @ K - L_gain @ C\n        \n        for i in range(N_omega):\n            s = s_grid[i]\n            # L_LQG(s) = K * (sI - (A-BK-LC))^-1 * L * C * (sI-A)^-1 * B\n            inv_sI_A_lqg_ctrl = np.linalg.inv(s * np.identity(3) - A_lqg_controller)\n            inv_sI_A = inv_sI_A_grid[i]\n            \n            L_lqg_s = K @ inv_sI_A_lqg_ctrl @ L_gain @ C @ inv_sI_A @ B\n            mag_lqg[i] = np.abs(L_lqg_s[0, 0])\n\n        # 2.4: Compute the mean relative magnitude error E(alpha)\n        relative_error = np.abs(mag_lqg - mag_lqr) / (mag_lqr + epsilon)\n        mean_error = np.mean(relative_error)\n        errors.append(mean_error)\n\n    # --- Part 4: Symmetric Root Locus Verification ---\n    symmetry_holds_all = True\n    for gamma in gammas:\n        A_gamma = A - gamma * B @ K\n        eigenvalues = np.linalg.eigvals(A_gamma)\n        \n        # Create a list of eigenvalues not yet paired.\n        unpaired_evs = list(eigenvalues)\n        has_unpaired_complex = False\n\n        while unpaired_evs:\n            ev = unpaired_evs.pop(0)\n            \n            # If eigenvalue is effectively real, it needs no conjugate pair.\n            if np.abs(ev.imag) <= tau:\n                continue\n            \n            # If it's a complex eigenvalue, find its conjugate in the remaining list.\n            found_conjugate = False\n            conjugate_idx = -1\n            for idx, other_ev in enumerate(unpaired_evs):\n                if np.abs(ev.real - other_ev.real) < tau and \\\n                   np.abs(ev.imag + other_ev.imag) < tau:\n                    conjugate_idx = idx\n                    found_conjugate = True\n                    break\n            \n            if found_conjugate:\n                # Remove the found conjugate from the list.\n                unpaired_evs.pop(conjugate_idx)\n            else:\n                # A complex eigenvalue was found without a conjugate pair.\n                has_unpaired_complex = True\n                break\n        \n        if has_unpaired_complex:\n            symmetry_holds_all = False\n            break\n\n    # Assemble and print the final results in the specified format.\n    final_output = errors + [symmetry_holds_all]\n    print(f\"[{','.join(map(str, final_output))}]\")\n\nsolve()\n```", "id": "2751321"}, {"introduction": "理想化的理论在应用于现实世界时必须保持谨慎，这是一个高级且关键的思维练习。虽然 LTR 旨在恢复良好的鲁棒性，但其高增益的特性可能使其变得脆弱。本练习模拟了一个真实场景，其中未建模的高频动态（在实际系统中普遍存在）导致了貌似合理的 LTR 设计反而恶化了系统性能，在互补灵敏度函数 $T(s)$ 中产生了危险的峰值。这个警示案例是关于在控制设计中考虑模型不确定性重要性的宝贵一课。[@problem_id:2721122]", "problem": "考虑一个在线性二次高斯 (LQG) 框架下的输出环路传递恢复 (LTR) 设计中使用的单输入单输出系统。其标称系统模型为\n$$\nP_{\\mathrm{nom}}(s) \\;=\\; \\frac{1}{s(s+1)},\n$$\n但真实系统在频率 $\\omega_{h}$ 处有一个未建模的高频极点，因此\n$$\nP_{\\mathrm{true}}(s) \\;=\\; \\frac{1}{s(s+1)\\left(1+\\frac{s}{\\omega_{h}}\\right)} \\;=\\; \\frac{1}{s(s+1)} \\cdot \\frac{1}{1+\\frac{s}{\\omega_{h}}}.\n$$\n在输出环路传递恢复 (LTR) 中，当过程噪声强度矩阵固定，且测量噪声协方差按 $R=\\rho R_{0}$ 比例缩放时，一个普遍的观察是，在系统输出端恢复的标称环路表现得像一个一阶积分器，其交越频率与测量噪声尺度的平方根成反比，即\n$$\nL_{\\mathrm{nom}}(s;\\rho) \\;\\approx\\; \\frac{\\omega_{c}(\\rho)}{s}, \n\\quad \\text{其中} \\quad \\omega_{c}(\\rho) \\;=\\; \\frac{k}{\\sqrt{\\rho}},\n$$\n其中常数 $k>0$ 由固定的过程噪声强度和标称设计决定。假设由 LQG/LTR 控制器实现的有效恢复返回比（从标称系统的角度看）是通过以下整形实现的\n$$\nL_{\\mathrm{nom}}(s;\\rho) \\;=\\; K_{\\mathrm{eff}}(s;\\rho)\\,P_{\\mathrm{nom}}(s), \n\\quad \\text{其中} \\quad K_{\\mathrm{eff}}(s;\\rho) \\;=\\; \\omega_{c}(\\rho)\\,(s+1).\n$$\n因此，当应用于真实系统（包含在 $\\omega_{h}$ 处的未建模高频极点）时，实际的环路传递函数变为\n$$\nL_{\\mathrm{true}}(s;\\rho) \\;=\\; K_{\\mathrm{eff}}(s;\\rho)\\,P_{\\mathrm{true}}(s) \\;=\\; \\frac{\\omega_{c}(\\rho)}{s}\\cdot \\frac{1}{1+\\frac{s}{\\omega_{h}}}\n\\;=\\; \\frac{\\omega_{c}(\\rho)\\,\\omega_{h}}{s\\,(s+\\omega_{h})}.\n$$\n令互补灵敏度函数定义为\n$$\nT_{\\mathrm{true}}(s;\\rho) \\;=\\; \\frac{L_{\\mathrm{true}}(s;\\rho)}{1 + L_{\\mathrm{true}}(s;\\rho)}.\n$$\n一个设计者从 $\\rho=1$ 和 $k=100$ 的良好标称工作点开始，然后天真地减小 $\\rho$ 同时保持标称整形范式不变，试图“改善”环路传递恢复。假设真实系统的未建模极点位于 $\\omega_{h}=1000$ rad/s，并且设计者将测量噪声尺度减小到 $\\rho = 0.0025$。\n\n仅使用基本定义和经过充分检验的事实，推导真实系统的 $T_{\\mathrm{true}}(s;\\rho)$，计算其频率响应幅值，并确定在给定参数下，当 $\\rho = 0.0025$ 时 $\\left|T_{\\mathrm{true}}(\\mathrm{j}\\omega;\\rho)\\right|$ 的精确峰值。您的答案必须是对应于峰值幅值的单个无量纲数，四舍五入到四位有效数字。", "solution": "首先将验证问题的科学合理性、自洽性和适定性。\n\n步骤 1：提取已知条件。\n明确给出的条件是：\n- 标称系统模型：$P_{\\mathrm{nom}}(s) = \\frac{1}{s(s+1)}$\n- 真实系统模型：$P_{\\mathrm{true}}(s) = \\frac{1}{s(s+1)\\left(1+\\frac{s}{\\omega_{h}}\\right)}$\n- 标称环路传递近似：$L_{\\mathrm{nom}}(s;\\rho) \\approx \\frac{\\omega_{c}(\\rho)}{s}$\n- 交越频率缩放：$\\omega_{c}(\\rho) = \\frac{k}{\\sqrt{\\rho}}$\n- 用于 LTR 整形的有效控制器：$K_{\\mathrm{eff}}(s;\\rho) = \\omega_{c}(\\rho)\\,(s+1)$\n- 真实环路传递函数：$L_{\\mathrm{true}}(s;\\rho) = \\frac{\\omega_{c}(\\rho)\\,\\omega_{h}}{s\\,(s+\\omega_{h})}$\n- 互补灵敏度函数定义：$T_{\\mathrm{true}}(s;\\rho) = \\frac{L_{\\mathrm{true}}(s;\\rho)}{1 + L_{\\mathrm{true}}(s;\\rho)}$\n- 常数 $k$：$k=100$\n- 未建模极点频率：$\\omega_{h}=1000$ rad/s\n- 测量噪声尺度：$\\rho = 0.0025$\n- 任务：在给定参数下，确定 $\\left|T_{\\mathrm{true}}(\\mathrm{j}\\omega;\\rho)\\right|$ 的峰值幅值，四舍五入到四位有效数字。\n\n步骤 2：使用提取的已知条件进行验证。\n问题陈述描述了鲁棒控制理论中的一个标准场景，特别是环路传递恢复 (LTR) 对于非最小相位系统或具有未建模高频动态的系统的脆弱性。传递函数、定义和关系在线性控制系统领域都是标准的。所提供的值在数值上是一致的，并且不违反任何物理或数学原理。该问题是适定的，要求为一个明确定义的系统计算一个特定的、可计算的量（频率响应的峰值幅值）。所有必要的数据都已提供。该问题具有科学依据，是客观且完整的。\n\n步骤 3：结论与行动。\n问题被判定为有效。将推导解答。\n\n目标是计算在指定参数下，真实互补灵敏度函数频率响应的峰值幅值，即 $M_p = \\max_{\\omega} |T_{\\mathrm{true}}(\\mathrm{j}\\omega;\\rho)|$。\n\n首先，我们使用给定的值 $k=100$ 和 $\\rho=0.0025$ 计算交越频率 $\\omega_{c}(\\rho)$。\n$$\n\\omega_{c}(\\rho) = \\frac{k}{\\sqrt{\\rho}} = \\frac{100}{\\sqrt{0.0025}} = \\frac{100}{0.05} = 2000 \\text{ rad/s}\n$$\n接下来，我们构建真实的互补灵敏度函数 $T_{\\mathrm{true}}(s;\\rho)$。真实的环路传递函数 $L_{\\mathrm{true}}(s;\\rho)$ 给出如下：\n$$\nL_{\\mathrm{true}}(s;\\rho) = \\frac{\\omega_{c}(\\rho)\\,\\omega_{h}}{s\\,(s+\\omega_{h})}\n$$\n代入数值 $\\omega_c = 2000$ 和 $\\omega_h = 1000$：\n$$\nL_{\\mathrm{true}}(s) = \\frac{2000 \\cdot 1000}{s(s+1000)} = \\frac{2 \\times 10^{6}}{s^{2} + 1000s}\n$$\n互补灵敏度函数定义为 $T_{\\mathrm{true}}(s) = \\frac{L_{\\mathrm{true}}(s)}{1 + L_{\\mathrm{true}}(s)}$。代入 $L_{\\mathrm{true}}(s)$ 的表达式：\n$$\nT_{\\mathrm{true}}(s) = \\frac{\\frac{\\omega_{c}\\omega_{h}}{s(s+\\omega_{h})}}{1 + \\frac{\\omega_{c}\\omega_{h}}{s(s+\\omega_{h})}} = \\frac{\\omega_{c}\\omega_{h}}{s(s+\\omega_{h}) + \\omega_{c}\\omega_{h}} = \\frac{\\omega_{c}\\omega_{h}}{s^2 + \\omega_{h}s + \\omega_{c}\\omega_{h}}\n$$\n这是一个标准二阶低通系统，其形式为：\n$$\nT(s) = \\frac{\\omega_{n}^2}{s^2 + 2\\zeta\\omega_{n}s + \\omega_{n}^2}\n$$\n通过将 $T_{\\mathrm{true}}(s)$ 的系数与标准形式进行比较，我们可以确定自然频率 $\\omega_n$ 和阻尼比 $\\zeta$。\n自然频率的平方是：\n$$\n\\omega_{n}^2 = \\omega_{c}\\omega_{h} = (2000)(1000) = 2 \\times 10^{6} \\; (\\text{rad/s})^2\n$$\n因此，自然频率是：\n$$\n\\omega_n = \\sqrt{2 \\times 10^{6}} = 1000\\sqrt{2} \\text{ rad/s}\n$$\n包含阻尼比的项是：\n$$\n2\\zeta\\omega_{n} = \\omega_{h}\n$$\n求解 $\\zeta$：\n$$\n\\zeta = \\frac{\\omega_{h}}{2\\omega_{n}} = \\frac{1000}{2(1000\\sqrt{2})} = \\frac{1}{2\\sqrt{2}}\n$$\n对于二阶系统，频率响应的峰值幅值 $M_p$ 是一个经过充分检验的事实，由以下公式给出：\n$$\nM_p = \\frac{1}{2\\zeta\\sqrt{1-\\zeta^2}}\n$$\n该公式在 $0 < \\zeta < \\frac{1}{\\sqrt{2}}$ 时有效。我们检查我们的 $\\zeta$ 值是否落在此范围内。\n$$\n\\zeta = \\frac{1}{2\\sqrt{2}} \\approx 0.3536\n$$\n上限是 $\\frac{1}{\\sqrt{2}} \\approx 0.7071$。由于 $0 < 0.3536 < 0.7071$，条件满足，存在谐振峰。\n\n我们现在使用 $\\zeta$ 的精确值来计算 $M_p$。首先，我们计算 $\\zeta^2$：\n$$\n\\zeta^2 = \\left(\\frac{1}{2\\sqrt{2}}\\right)^2 = \\frac{1}{8}\n$$\n现在将其代入 $M_p$ 的公式中：\n$$\nM_p = \\frac{1}{2\\left(\\frac{1}{2\\sqrt{2}}\\right)\\sqrt{1 - \\frac{1}{8}}} = \\frac{1}{\\frac{1}{\\sqrt{2}}\\sqrt{\\frac{7}{8}}} = \\frac{1}{\\frac{1}{\\sqrt{2}}\\frac{\\sqrt{7}}{\\sqrt{8}}} = \\frac{1}{\\frac{\\sqrt{7}}{\\sqrt{16}}} = \\frac{1}{\\frac{\\sqrt{7}}{4}} = \\frac{4}{\\sqrt{7}}\n$$\n为提供数值答案，我们计算此表达式的值并按要求四舍五入到四位有效数字。\n$$\nM_p = \\frac{4}{\\sqrt{7}} \\approx \\frac{4}{2.6457513...} \\approx 1.51185789...\n$$\n四舍五入到四位有效数字得到：\n$$\nM_p \\approx 1.512\n$$\n这个结果展示了天真使用 LTR 的危险；激进的恢复尝试（低 $\\rho$）导致闭环频率响应出现显著的峰值，这表明鲁棒性差，并且由于未建模动态而存在振荡行为或不稳定的趋势。", "answer": "$$\n\\boxed{1.512}\n$$", "id": "2721122"}]}