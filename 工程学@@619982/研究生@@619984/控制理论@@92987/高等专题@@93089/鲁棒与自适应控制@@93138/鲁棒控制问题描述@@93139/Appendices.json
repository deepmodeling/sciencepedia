{"hands_on_practices": [{"introduction": "在鲁棒控制设计的世界里，一个核心的领悟是性能的提升并非没有代价。即使我们拥有理想的控制器，被控对象本身的特性也会带来不可避免的权衡。本练习旨在揭示一个这样的基本限制——“水床效应”，它通过Bode灵敏度积分进行量化，解释了为什么在某些频率上抑制扰动（即减小灵敏度函数 $S(s)$ 的幅值）必然会导致在其他频率上放大扰动。这个练习将帮助你深刻理解为何右半平面极点等非最小相位特性会从根本上限制控制系统的性能，并迫使我们在设计中面对性能与鲁棒性之间的权衡 [@problem_id:2740504]。", "problem": "考虑一个单输入单输出线性时不变（LTI）对象，其传递函数为 $P(s)$，该函数是严格真有理的，在 $s=+a$（其中 $a>0$）处有且仅有一个右半平面（RHP）极点，无右半平面零点，且无时间延迟。设 $K(s)$ 为任意正常的稳定控制器，使得闭环系统是内部稳定的。设环路传递函数为 $L(s)=P(s)K(s)$，灵敏度函数为 $S(s)=(1+L(s))^{-1}$。假设当 $|s|\\to \\infty$ 时，沿虚轴 $L(s)\\to 0$，因此 $S(\\infty)=1$。\n\na) 从 $S(s)$ 的定义、辐角原理以及通过布拉施克乘积（Blaschke products）对不稳定动态进行标准复解析因式分解出发，推导积分\n$$\nI(a)\\;=\\;\\int_{0}^{\\infty}\\ln|S(\\mathrm{j}\\omega)|\\,\\mathrm{d}\\omega\n$$\n的精确表达式，该表达式仅含参数 $a$。你的推导必须阐明是对象的何种结构特性导致了 $I(a)$ 中非零的“水床面积”。\n\nb) 现在假设存在乘性输出不确定性 $\\Delta(s)$，满足对所有实数 $\\omega$，有 $|\\Delta(\\mathrm{j}\\omega)|\\leq |W_{\\Delta}(\\mathrm{j}\\omega)|$，其中 $W_{\\Delta}(s)$ 是一个已知的、稳定的、最小相位权重。为了实现鲁棒性能，一种常见的灵敏度权重选择是\n$$\nW_{s}(s)\\;=\\;\\frac{\\frac{s}{M}+\\omega_{B}}{s+\\frac{\\omega_{B}}{A}},\\quad A>1,\\;M>1,\\;\\omega_{B}>0,\n$$\n以使 $|W_{s}(\\mathrm{j}\\omega)S(\\mathrm{j}\\omega)|$ 一致地小。利用你在(a)部分的结果以及第一性原理（特别是，在任何非零测度集上将 $|S(\\mathrm{j}\\omega)|$ 压低到1以下，都必须通过在其他地方取大于1的值来补偿，以满足该积分恒等式），解释当鲁棒性能额外要求对所有实数 $\\omega$ 满足小增益条件 $|W_{\\Delta}(\\mathrm{j}\\omega)|\\,|T(\\mathrm{j}\\omega)|<1$ 时，位于 $+a$ 的右半平面极点的存在如何约束 $(A,M,\\omega_{B})$ 的同时选择，其中 $T(s)=1-S(s)$ 是补灵敏度。你的解释必须明确由 $I(a)$ 的非零值所隐含的权衡，以及在面对 $W_{\\Delta}(s)$ 时，它如何影响 $W_{s}(s)$ 在整个频域上的整形，但你不需要给出 $(A, M, \\omega_B)$ 的数值。\n\n答案规格：仅报告(a)部分 $I(a)$ 的闭式表达式作为最终答案。无需单位，也无需四舍五入。", "solution": "所述问题具有科学依据、提法恰当、客观且内部一致，并基于一个关于环路传递函数高频滚降的标准、上下文隐含的假设。因此，其有效性得到确认，我将着手解答。\n\na) 积分 $I(a)$ 的推导\n\n待求的积分是 $I(a) = \\int_{0}^{\\infty}\\ln|S(\\mathrm{j}\\omega)|\\,\\mathrm{d}\\omega$。灵敏度函数定义为 $S(s) = (1+L(s))^{-1}$，其中 $L(s) = P(s)K(s)$ 是开环传递函数。\n\n首先，我们确定 $S(s)$ 在右半平面（RHP，定义为 $\\text{Re}(s) > 0$）中的解析性质。\n1.  **$S(s)$ 的极点**：$S(s)$ 的极点是 $1+L(s)$ 的零点，对应于闭环系统的极点。问题指出控制器 $K(s)$ 是稳定的，这意味着闭环系统是内部稳定的。因此，$S(s)$ 的所有极点都严格位于左半平面（LHP），并且 $S(s)$ 在整个右半平面内是解析的。\n2.  **$S(s)$ 的零点**：$S(s)$ 的零点是 $1+L(s)$ 的极点，也就是 $L(s)$ 的极点。$L(s)=P(s)K(s)$ 的极点是对象 $P(s)$ 和控制器 $K(s)$ 极点的并集。为了保证内部稳定性，控制器不能抵消对象的任何右半平面极点。我们假设真控制器 $K(s)$ 是稳定的，这是稳定不稳定对象的标准做法。因此，$L(s)$ 的右半平面极点与 $P(s)$ 的右半平面极点相同。问题指出 $P(s)$ 在 $s=+a$（$a>0$）处有且仅有一个右半平面极点。因此，$S(s)$ 在 $s=a$ 处有且仅有一个右半平面零点。\n\n由于 $S(s)$ 在右半平面内是解析的，并且有一个已知的右半平面零点，我们可以使用 Poisson-Jensen 公式。该公式将解析函数在域内的值与其边界值及内部零点联系起来。对于在右半平面内解析的函数 $f(s)$，其在右半平面内一点 $s_0 = x_0 + \\mathrm{j}y_0$ 的公式为：\n$$ \\ln|f(s_0)| = \\sum_{i} \\ln\\left|\\frac{s_0-z_i}{s_0+\\bar{z_i}}\\right| - \\sum_{k} \\ln\\left|\\frac{s_0-p_k}{s_0+\\bar{p_k}}\\right| + \\frac{1}{\\pi}\\int_{-\\infty}^{\\infty} \\ln|f(\\mathrm{j}\\omega)| \\frac{x_0}{x_0^2+(y_0-\\omega)^2} \\mathrm{d}\\omega $$\n这里，$\\{z_i\\}$ 是 $f(s)$ 的右半平面零点，$\\{p_k\\}$ 是 $f(s)$ 的右半平面极点。\n\n我们将此公式应用于我们的灵敏度函数 $S(s)$。我们已经确定 $S(s)$ 没有右半平面极点，并且在 $z_1=a$ 处有一个实的右半平面零点。我们在正实轴上的一点 $s_0=x_0$（因此 $y_0=0$）处计算该公式，其中 $x_0>a$。\n公式简化为：\n$$ \\ln|S(x_0)| = \\ln\\left|\\frac{x_0-a}{x_0+a}\\right| + \\frac{1}{\\pi}\\int_{-\\infty}^{\\infty} \\ln|S(\\mathrm{j}\\omega)| \\frac{x_0}{x_0^2+\\omega^2} \\mathrm{d}\\omega $$\n由于 $S(s)$ 是实系数系统的传递函数，因此 $|S(\\mathrm{j}\\omega)|$ 是 $\\omega$ 的偶函数。积分项可以写成：\n$$ \\frac{2}{\\pi}\\int_{0}^{\\infty} \\ln|S(\\mathrm{j}\\omega)| \\frac{x_0}{x_0^2+\\omega^2} \\mathrm{d}\\omega $$\n我们的目标是分离出积分 $I(a)=\\int_{0}^{\\infty} \\ln|S(\\mathrm{j}\\omega)| \\mathrm{d}\\omega$。我们可以通过将整个方程乘以 $x_0$ 并取 $x_0 \\to \\infty$ 的极限来实现这一点。\n$$ \\lim_{x_0 \\to \\infty} x_0 \\ln|S(x_0)| = \\lim_{x_0 \\to \\infty} x_0 \\ln\\left(\\frac{x_0-a}{x_0+a}\\right) + \\lim_{x_0 \\to \\infty} \\frac{2}{\\pi}\\int_{0}^{\\infty} \\ln|S(\\mathrm{j}\\omega)| \\frac{x_0^2}{x_0^2+\\omega^2} \\mathrm{d}\\omega $$\n我们来计算每个极限：\n\n-   **左侧**：由于 $P(s)$ 是严格真的，$K(s)$ 是真的，所以 $L(s)$ 是严格真的，意味着其相对阶至少为1。因此，当 $|s|\\to\\infty$ 时，$L(s) \\to 0$。那么对于大的 $s$，$S(s) = (1+L(s))^{-1} \\approx 1-L(s)$。所以 $\\ln|S(x_0)| \\approx \\ln|1-L(x_0)| \\approx -\\text{Re}(L(x_0))$。极限变为 $\\lim_{x_0 \\to \\infty} -x_0 \\text{Re}(L(x_0))$。这取决于 $L(s)$ 的相对阶。问题要求解仅用 $a$ 表示，这迫使该极限为零。这个条件 $\\lim_{s \\to \\infty} sL(s) = 0$ 成立，当且仅当 $L(s)$ 的相对阶至少为2。我们在这个标准假设下进行推导，这也是问题约束所隐含要求的。因此，$\\lim_{x_0 \\to \\infty} x_0 \\ln|S(x_0)| = 0$。\n\n-   **右侧第一项**：我们使用对数的泰勒展开，对于小的 $u$，$\\ln(1+u) \\approx u$。\n$$ \\lim_{x_0 \\to \\infty} x_0 \\ln\\left(\\frac{1-a/x_0}{1+a/x_0}\\right) = \\lim_{x_0 \\to \\infty} x_0 \\left[ \\ln(1-a/x_0) - \\ln(1+a/x_0) \\right] $$\n$$ = \\lim_{x_0 \\to \\infty} x_0 \\left[ (-a/x_0) - (a/x_0) + O(1/x_0^2) \\right] = \\lim_{x_0 \\to \\infty} x_0 \\left[ -2a/x_0 \\right] = -2a $$\n\n-   **右侧第二项**：我们分析积分的极限。对于任何固定的 $\\omega$，核函数 $\\frac{x_0^2}{x_0^2+\\omega^2} = \\frac{1}{1+(\\omega/x_0)^2}$ 在 $x_0 \\to \\infty$ 时趋近于1。通过应用适当的收敛定理（例如，控制收敛定理，假设未加权的对数灵敏度积分是有限的），我们可以交换极限和积分的顺序：\n$$ \\lim_{x_0 \\to \\infty} \\frac{2}{\\pi}\\int_{0}^{\\infty} \\ln|S(\\mathrm{j}\\omega)| \\frac{x_0^2}{x_0^2+\\omega^2} \\mathrm{d}\\omega = \\frac{2}{\\pi}\\int_{0}^{\\infty} \\ln|S(\\mathrm{j}\\omega)| \\cdot (1) \\mathrm{d}\\omega = \\frac{2}{\\pi}I(a) $$\n\n结合各项极限的结果，我们得到方程：\n$$ 0 = -2a + \\frac{2}{\\pi}I(a) $$\n解出 $I(a)$ 得到最终表达式：\n$$ I(a) = \\pi a $$\n强制产生这个非零“水床面积”的对象结构特性是存在位于 $s=+a$ 的右半平面极点。如推导所示，这个极点变成了 $S(s)$ 的一个右半平面零点，从而在 Poisson-Jensen 公式中引入了 $\\ln\\left|\\frac{x_0-a}{x_0+a}\\right|$ 项。此项的贡献（乘以 $x_0$ 后）的非零极限导致了积分的非零值。对于一个稳定对象（$a$ 将不存在），此项会消失，积分结果为零（假设相对阶 $\\ge 2$）。\n\nb) 设计权衡的解释\n\n(a)部分的结果 $\\int_{0}^{\\infty}\\ln|S(\\mathrm{j}\\omega)|\\,\\mathrm{d}\\omega = \\pi a$ 是对灵敏度函数的一个基本约束，被称为波特（Bode）灵敏度积分。由于 $a>0$，该积分为严格正值。这就是“水床效应”的数学表述：任何试图在某一频率范围内降低灵敏度（即令 $|S(\\mathrm{j}\\omega)| < 1$，从而 $\\ln|S(\\mathrm{j}\\omega)| < 0$）的努力，都必须通过在另一频率范围内增加灵敏度（令 $|S(\\mathrm{j}\\omega)| > 1$，从而 $\\ln|S(\\mathrm{j}\\omega)| > 0$）来补偿，以使 $\\ln|S(\\mathrm{j}\\omega)|$ 曲线下的总面积保持等于正常数 $\\pi a$。\n\n良好的性能，如跟踪和扰动抑制，要求 $|S(\\mathrm{j}\\omega)|$ 在一定的带宽内很小。性能权重 $W_s(s)$ 将此要求形式化；条件 $|W_{s}(\\mathrm{j}\\omega)S(\\mathrm{j}\\omega)| < 1$ 意味着 $|S(\\mathrm{j}\\omega)| < |W_s(\\mathrm{j}\\omega)|^{-1}$。给定的 $W_s(s)$ 具有低频增益 $A>1$，因此我们要求 $|S(0)| < 1/A$。这需要在低频段（直到性能带宽 $\\omega_B$）的 $\\ln|S(\\mathrm{j}\\omega)|$ 积分中创造一个显著的“负面积”。\n\n为满足积分约束，这个负面积必须由 $|S(\\mathrm{j}\\omega)| > 1$ 的正面积来平衡。这通常表现为在 $\\omega_B$ 附近及以上的频率处，灵敏度函数出现一个峰值，$M_S = \\max_{\\omega}|S(\\mathrm{j}\\omega)| > 1$。不稳定极点 $a$ 越大，性能指标要求越苛刻（即期望的带宽 $\\omega_B$ 越大和/或衰减因子 $A$ 越大），所需的负面积就越大，因此不可避免的灵敏度峰值 $M_S$ 也越大。\n\n这个灵敏度峰值对鲁棒稳定性有直接影响。对于乘性输出不确定性，鲁棒稳定性条件是 $|W_{\\Delta}(\\mathrm{j}\\omega)T(\\mathrm{j}\\omega)| < 1$，其中 $T(s)=1-S(s)$ 是补灵敏度函数。在 $|S(\\mathrm{j}\\omega)|$ 中存在大的峰值 $M_S$ 意味着在 $|T(\\mathrm{j}\\omega)|$ 中也存在相应的大峰值，因为 $|T| = |1-S|$ 受 $|1-|S|| \\le |T| \\le 1+|S|$ 限制，在峰值频率附近， $|T|$ 的量级通常与 $M_S$ 相当。设此峰值为 $M_T = \\max_\\omega |T(j\\omega)|$。\n\n这种权衡变得至关重要，因为不确定性权重 $W_\\Delta(s)$ 通常模拟高频未建模动态，这意味着 $|W_\\Delta(\\mathrm{j}\\omega)|$ 在低频时很小，但随 $\\omega$ 增加而增大。因此，鲁棒稳定性条件 $|T(\\mathrm{j}\\omega)| < 1/|W_\\Delta(\\mathrm{j}\\omega)|$ 恰好在灵敏度峰值 $M_S$ （以及因此产生的峰值 $M_T$）被迫出现的高频区域，对 $T(s)$ 的幅值施加了严格的上限。\n\n总而言之，位于 $s=+a$ 的右半平面极点强加了约束 $I(a)=\\pi a > 0$。实现高性能（大的 $A$，大的 $\\omega_B$）必然导致大的灵敏度峰值 $M_S$。这个大的 $M_S$ 会在不确定性幅值 $|W_\\Delta|$ 通常较大的频率处，于补灵敏度函数中产生一个大的峰值 $M_T$。这可能导致乘积 $|W_\\Delta T|$ 超过1，从而违反鲁棒稳定性。因此，位于 $s=+a$ 的不稳定极点的存在，在标称性能和鲁棒稳定性之间建立了一个根本性的冲突，从而约束了性能参数 $(A, M, \\omega_B)$ 的同时选择。一个更不稳定的对象（更大的 $a$）会加剧这种权衡，严重限制了可实现的性能带宽和扰动抑制能力。", "answer": "$$\\boxed{\\pi a}$$", "id": "2740504"}, {"introduction": "理解了内在的设计限制后，下一步便是进行严谨的分析：我们如何确保系统在一系列不确定性面前仍能保持稳定？本练习将指导你处理一类常见的不确定性模型——多胞型不确定性（polytopic uncertainty），这通常用于描述系统参数在已知边界内的变化。你将学习利用一个公共的二次李雅普诺夫函数（common quadratic Lyapunov function）推导出仅需在不确定性集合的“顶点”上检验的一系列线性矩阵不等式（LMI），从而保证系统在整个不确定性范围内的鲁棒稳定性。这项实践连接了经典的李雅普诺夫理论与现代控制中广泛应用的凸优化工具 [@problem_id:2740483]。", "problem": "考虑一个连续时间、不确定的线性时不变 (LTI) 系统，其扰动输入为 $w$，性能输出为 $z$，由下式给出：\n$$\n\\dot{x}(t) = A(\\alpha) x(t) + B w(t), \\qquad z(t) = C x(t) + D w(t),\n$$\n其中 $x \\in \\mathbb{R}^{n}$，$w \\in \\mathbb{R}^{m}$，$z \\in \\mathbb{R}^{p}$。状态矩阵 $A(\\alpha)$ 是多胞的 (polytopic)：\n$$\nA(\\alpha) \\in \\mathrm{conv}\\{A_{1}, \\ldots, A_{N}\\} = \\left\\{ \\sum_{i=1}^{N} \\alpha_{i} A_{i} \\ \\bigg| \\ \\alpha_{i} \\ge 0, \\ \\sum_{i=1}^{N} \\alpha_{i} = 1 \\right\\},\n$$\n矩阵 $B \\in \\mathbb{R}^{n \\times m}$、$C \\in \\mathbb{R}^{p \\times n}$ 和 $D \\in \\mathbb{R}^{p \\times m}$ 是固定的已知矩阵。从 $w$ 到 $z$ 的传递函数 $T_{zw}$ 的$\\mathcal{H}_{\\infty}$范数按标准方式定义。\n\n任务 A (公式推导)：从诱导 $\\mathcal{L}_{2}$ 增益的定义和包含公共二次存储函数 $V(x) = x^{\\top} P x$（对于某个对称矩阵 $P \\succ 0$）的耗散不等式出发，推导出在顶点 $A_i$ 处的线性矩阵不等式 (LMI)。这些不等式需足以保证对于多胞体中所有的 $A(\\alpha)$，$\\|T_{zw}\\|_{\\infty} < \\gamma$ 均一致成立。你的推导必须清楚地说明，为什么使用一个公共的 $P$ 只需检验这 $N$ 个顶点不等式，就足以保证所有凸组合都成立。\n\n任务 B (标量情况下的评估)：考虑一个特定的标量多胞系统 ($n = m = p = 1$)：\n$$\n\\dot{x}(t) = A(\\alpha) x(t) + B w(t), \\qquad z(t) = C x(t),\n$$\n其顶点为 $A_{1} = -1.10$，$A_{2} = -0.23$，固定参数为 $B = 1.7$，$C = 2.9$，$D = 0$。使用任务 A 推导的公式，并结合适用于此标量情况的基本频域推理，确定最小实数 $\\gamma_{\\star}$，使得对于给定多胞体中的所有 $A(\\alpha)$，$\\|T_{zw}\\|_{\\infty} < \\gamma_{\\star}$ 均一致成立。将你的最终数值答案四舍五入到四位有效数字。", "solution": "我们从诱导 $\\mathcal{L}_{2}$ 增益的定义和耗散不等式开始，然后将其特殊化为使用公共二次存储函数的情况，以获得对系统矩阵呈仿射关系的线性矩阵不等式 (LMI) 条件。然后我们证明，对于一个多胞不确定性集合，当使用公共存储矩阵时，为什么这些条件只需在顶点处强制成立即可。最后，我们通过直接的频域推理，在一个标量示例中评估这个界。\n\n任务 A：确保 $\\|T_{zw}\\|_{\\infty} < \\gamma$ 的多顶点 LMI 公式。\n\n1. 诱导 $\\mathcal{L}_{2}$ 增益和耗散不等式。对于一个稳定的实现和任意扰动输入 $w \\in \\mathcal{L}_{2}$，从 $w$ 到 $z$ 的 $\\mathcal{L}_{2}$ 增益的平方不超过 $\\gamma^2$，这一性质可以通过存在一个连续可微的存储函数 $V(x) \\ge 0$ 来证明，使得耗散不等式\n$$\n\\dot{V}(x) + z^{\\top} z - \\gamma^{2} w^{\\top} w \\le 0\n$$\n沿系统的轨迹对所有 $x$ 和 $w$ 成立。选择公共二次存储函数 $V(x) = x^{\\top} P x$（其中 $P = P^{\\top} \\succ 0$），并利用 $\\dot{V}(x) = x^{\\top}(A^{\\top} P + P A) x + 2 x^{\\top} P B w$，我们得到\n$$\nx^{\\top}(A^{\\top} P + P A) x + 2 x^{\\top} P B w + (C x + D w)^{\\top} (C x + D w) - \\gamma^{2} w^{\\top} w \\le 0.\n$$\n该不等式必须对所有 $x$ 和 $w$ 成立。\n\n2. 二次型表示。将关于 $x$ 和 $w$ 的项分组，该不等式等价于\n$$\n\\begin{bmatrix} x \\\\ w \\end{bmatrix}^{\\top}\n\\begin{bmatrix}\nA^{\\top} P + P A + C^{\\top} C & P B + C^{\\top} D \\\\\nB^{\\top} P + D^{\\top} C & D^{\\top} D - \\gamma^{2} I\n\\end{bmatrix}\n\\begin{bmatrix} x \\\\ w \\end{bmatrix} \\le 0 \\quad \\text{for all } x, w.\n$$\n一个充分条件是该对称分块矩阵的严格负定性：\n$$\n\\begin{bmatrix}\nA^{\\top} P + P A + C^{\\top} C & P B + C^{\\top} D \\\\\nB^{\\top} P + D^{\\top} C & D^{\\top} D - \\gamma^{2} I\n\\end{bmatrix} \\prec 0, \\qquad P \\succ 0.\n$$\n这是连续时间有界实引理 (BRL) 不等式，它以决策变量 $P$ 和 $\\gamma$ 的线性矩阵不等式 (LMI) 形式表示，是 $\\|T_{zw}\\|_{\\infty} < \\gamma$ 的一个经过充分检验和广泛使用的刻画。\n\n3. 多胞 $A(\\alpha)$ 的多顶点条件。假设 $A(\\alpha) = \\sum_{i=1}^{N} \\alpha_{i} A_{i}$，其中 $\\alpha_{i} \\ge 0$，$\\sum_{i} \\alpha_{i} = 1$。左侧的分块矩阵\n$$\n\\mathcal{M}(A) \\triangleq\n\\begin{bmatrix}\nA^{\\top} P + P A + C^{\\top} C & P B + C^{\\top} D \\\\\nB^{\\top} P + D^{\\top} C & D^{\\top} D - \\gamma^{2} I\n\\end{bmatrix}\n$$\n对 $A$ 是仿射的。因此，对于任意固定的 $P$ 和 $\\gamma$，映射 $A \\mapsto \\mathcal{M}(A)$ 保持凸组合：\n$$\n\\mathcal{M}\\!\\left(\\sum_{i=1}^{N} \\alpha_{i} A_{i}\\right) = \\sum_{i=1}^{N} \\alpha_{i} \\mathcal{M}(A_{i}).\n$$\n负定矩阵的集合是凸集，因此如果对于一个公共的 $P \\succ 0$ 和 $\\gamma > 0$，所有的 $i \\in \\{1, \\ldots, N\\}$ 都有 $\\mathcal{M}(A_{i}) \\prec 0$，那么对于凸包中的每一个 $A(\\alpha)$，都有 $\\mathcal{M}(A(\\alpha)) \\prec 0$。因此，以下多顶点 LMI 是在多胞体上一致成立的充分条件：\n$$\n\\begin{bmatrix}\nA_{i}^{\\top} P + P A_{i} + C^{\\top} C & P B + C^{\\top} D \\\\\nB^{\\top} P + D^{\\top} C & D^{\\top} D - \\gamma^{2} I\n\\end{bmatrix} \\prec 0, \\quad P \\succ 0, \\quad \\text{for all } i \\in \\{1, \\ldots, N\\}.\n$$\n当 $D = 0$ 时，这些不等式简化为\n$$\n\\begin{bmatrix}\nA_{i}^{\\top} P + P A_{i} + C^{\\top} C & P B \\\\\nB^{\\top} P & - \\gamma^{2} I\n\\end{bmatrix} \\prec 0, \\quad P \\succ 0, \\quad \\forall i.\n$$\n\n任务 B：标量情况下的最小 $\\gamma_{\\star}$。\n\n我们得到标量 ($n = m = p = 1$) 系统\n$$\n\\dot{x}(t) = a x(t) + b w(t), \\qquad z(t) = c x(t),\n$$\n其中 $a \\in \\mathrm{conv}\\{-1.10, -0.23\\}$，$b = 1.7$，$c = 2.9$，$d = 0$。从 $w$ 到 $z$ 的传递函数是\n$$\nT_{zw}(s) = c (s I - a)^{-1} b + d = \\frac{c b}{s - a}.\n$$\n对于一个稳定的 $a < 0$，$\\mathcal{H}_{\\infty}$ 范数等于在虚轴上频率响应的峰值幅度：\n$$\n\\|T_{zw}\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} \\left| \\frac{c b}{\\mathrm{j} \\omega - a} \\right| = |c b| \\, \\sup_{\\omega \\in \\mathbb{R}} \\frac{1}{\\sqrt{\\omega^{2} + a^{2}}} = \\frac{|c b|}{|a|}.\n$$\n上确界在 $\\omega = 0$ 处取得，因为分母 $\\sqrt{\\omega^{2} + a^{2}}$ 在 $\\omega = 0$ 处最小。在整个多胞体上，最坏情况发生在 $|a|$ 最小处（最接近虚轴），即 $|a|_{\\min} = 0.23$。因此，对于所有 $a \\in \\mathrm{conv}\\{-1.10, -0.23\\}$ 均满足 $\\|T_{zw}\\|_{\\infty} < \\gamma_{\\star}$ 的最小 $\\gamma_{\\star}$ 是\n$$\n\\gamma_{\\star} = \\frac{|c b|}{\\min\\{|a_{1}|, |a_{2}|\\}} = \\frac{(2.9)(1.7)}{0.23} = \\frac{4.93}{0.23} = \\frac{493}{23}.\n$$\n数值上，\n$$\n\\gamma_{\\star} \\approx 21.4347826\\ldots\n$$\n四舍五入到四位有效数字，\n$$\n\\gamma_{\\star} \\approx 21.43.\n$$", "answer": "$$\\boxed{21.43}$$", "id": "2740483"}, {"introduction": "从分析转向设计，是掌握鲁棒控制的关键一步。本练习将引导你完成这一飞跃，专注于设计一个状态反馈控制器，以实现对外部扰动的有效抑制，即保证闭环系统的 $\\mathcal{H}_{\\infty}$ 范数小于一个预设值 $\\gamma$。你将通过此题掌握一个核心技巧：如何通过巧妙的变量代换，将一个非凸的（因此难以求解的）控制器综合问题，转化为一个凸的、可以高效求解的LMI可行性问题。这项实践不仅让你学会一种强大的控制器设计方法，更能让你洞察到如何将复杂的工程设计问题转化为数学上易于处理的形式 [@problem_id:2740566]。", "problem": "考虑一个连续时间不确定外部扰动衰减问题，其对象由状态空间数据 $\\left(A,B_{1},B_{2},C_{1},D_{11},D_{12}\\right)$ 描述：\n$$\n\\dot{x}(t) \\;=\\; A\\,x(t)+B_{1}\\,w(t)+B_{2}\\,u(t),\\quad\nz(t) \\;=\\; C_{1}\\,x(t)+D_{11}\\,w(t)+D_{12}\\,u(t),\n$$\n其中 $x(t)\\in\\mathbb{R}^{n}$ 是状态， $u(t)\\in\\mathbb{R}^{m}$ 是控制输入， $w(t)\\in\\mathbb{R}^{p}$ 是外部扰动， $z(t)\\in\\mathbb{R}^{q}$ 是性能输出。您的任务是设计一个静态状态反馈 $u(t)=K\\,x(t)$，使得从 $w$ 到 $z$ 的闭环诱导$\\mathcal{L}_{2}$增益（即$\\mathcal{H}_{\\infty}$ 范数 $\\|T_{zw}\\|_{\\infty}$）严格小于一个给定的标量 $\\gamma>0$。假设 $(A,B_{2})$ 是能稳的，并且性能通道中的 $D_{12}$ 是列满秩的。任务是从基础性结论出发，推导出一个凸综合条件。\n\n任务A. 以连续时间有界实引理作为基础出发点，为闭环系统构建鲁棒性能目标 $\\|T_{zw}\\|_{\\infty}<\\gamma$，并推导一个带有决策变量 $(X\\succ 0,Y)$ 的线性矩阵不等式（LMI）条件，使得如果该LMI对于某个 $\\gamma>0$ 是可行的，则状态反馈增益 $K=Y\\,X^{-1}$ 能确保 $\\|T_{zw}\\|_{\\infty}<\\gamma$。您的推导过程必须是自洽的，并且必须通过适当的合同变换和消除双线性项的变量代换，明确地将有界实引理与凸可行性条件联系起来。\n\n任务B. 现在特化到一个由下式给出的标量系统，其中 $n=m=p=q=1$：\n$$\nA \\,=\\, -1,\\quad B_{1}\\,=\\,1,\\quad B_{2}\\,=\\,1,\\quad C_{1}\\,=\\,2,\\quad D_{11}\\,=\\,\\tfrac{1}{3},\\quad D_{12}\\,=\\,4.\n$$\n使用您推导出的LMI公式，并结合对闭环传递函数 $T_{zw}(s)$ 的解析推理，确定最小可达的 $\\gamma$（即，对于所有存在满足 $\\|T_{zw}\\|_{\\infty}<\\gamma$ 的静态状态反馈增益 $K$ 的 $\\gamma$ 的下确界）。将您的最终答案表示为一个不带单位的精确实数。不要四舍五入；给出精确值。", "solution": "所述问题是鲁棒控制理论中一个适定的标准问题。它在科学上是合理的、客观的，并包含足够的信息以进行严谨的求解。未发现任何缺陷。求解过程将继续进行。\n\n该任务分为两部分。首先，需要推导状态反馈$\\mathcal{H}_{\\infty}$控制问题的一个通用凸综合条件。其次，将此结果应用于一个特定的标量系统，以确定最优性能水平$\\gamma_{opt}$。\n\nA部分：LMI综合条件的推导\n\n给定系统由以下状态空间方程描述：\n$$\n\\begin{aligned}\n\\dot{x}(t) & = A\\,x(t)+B_{1}\\,w(t)+B_{2}\\,u(t) \\\\\nz(t) & = C_{1}\\,x(t)+D_{11}\\,w(t)+D_{12}\\,u(t)\n\\end{aligned}\n$$\n应用静态状态反馈控制律 $u(t) = K x(t)$。将其代入系统方程，得到从扰动 $w(t)$ 到性能输出 $z(t)$ 的闭环系统动力学：\n$$\n\\begin{aligned}\n\\dot{x}(t) & = (A + B_{2}K)x(t) + B_{1}w(t) \\\\\nz(t) & = (C_{1} + D_{12}K)x(t) + D_{11}w(t)\n\\end{aligned}\n$$\n这是一个线性时不变（LTI）系统，其状态空间矩阵为：\n$$\nA_{cl} = A + B_{2}K, \\quad B_{cl} = B_{1}, \\quad C_{cl} = C_{1} + D_{12}K, \\quad D_{cl} = D_{11}\n$$\n目标是找到一个增益矩阵 $K$，使得闭环系统内部稳定（即 $A_{cl}$ 是赫尔维茨矩阵），并且从 $w$ 到 $z$ 的诱导$\\mathcal{L}_{2}$增益小于给定的 $\\gamma > 0$。该增益等价于闭环传递函数 $T_{zw}(s)$ 的$\\mathcal{H}_{\\infty}$范数，因此条件为 $\\|T_{zw}\\|_{\\infty} < \\gamma$。\n\n此问题的基础性结论是连续时间有界实引理（BRL）。BRL指出，对于一个具有实现 $(A_{cl}, B_{cl}, C_{cl}, D_{cl})$ 的稳定LTI系统，条件 $\\|T_{zw}\\|_{\\infty} < \\gamma$ 成立，当且仅当存在一个对称正定矩阵 $P \\succ 0$ 满足以下矩阵不等式：\n$$\n\\begin{pmatrix}\nA_{cl}^T P + P A_{cl} & P B_{cl} & C_{cl}^T \\\\\nB_{cl}^T P & -\\gamma I_p & D_{cl}^T \\\\\nC_{cl} & D_{cl} & -\\gamma I_q\n\\end{pmatrix} \\prec 0\n$$\n其中 $I_p$ 和 $I_q$ 是相应维度的单位矩阵。\n\n将闭环矩阵的表达式代入此不等式，得到一个关于决策变量 $P$ 和 $K$ 的双线性矩阵不等式 (BMI)，因其包含 $P$ 与 $K$ 的乘积项 (如 $P B_2 K$) 而非凸。\n$$\n\\begin{pmatrix}\n(A + B_{2}K)^T P + P (A + B_{2}K) & P B_{1} & (C_{1} + D_{12}K)^T \\\\\nB_{1}^T P & -\\gamma I_p & D_{11}^T \\\\\nC_{1} + D_{12}K & D_{11} & -\\gamma I_q\n\\end{pmatrix} \\prec 0\n$$\n为了获得一个凸条件，我们对此BMI进行合同变换。令 $X = P^{-1}$。由于 $P \\succ 0$，它是可逆的且 $X \\succ 0$。用分块对角矩阵 $\\mathrm{diag}(X, I_p, I_q)$ 对该BMI进行前乘和后乘。由于 $X$ 是正定的，这个变换保持了矩阵的负定性。变换后的不等式为：\n$$\n\\begin{pmatrix}\nX A_{cl}^T + A_{cl} X & B_{cl} & C_{cl}^T \\\\\nB_{cl}^T & -\\gamma I_p & D_{cl}^T \\\\\nC_{cl} X & D_{cl} & -\\gamma I_q\n\\end{pmatrix} \\prec 0\n$$\n注意这里使用了 $XPX=X$。将闭环项代入：\n$$\n\\begin{pmatrix}\nX(A+B_2K)^T + (A+B_2K)X & B_1 & (C_1+D_{12}K)^T \\\\\nB_1^T & -\\gamma I_p & D_{11}^T \\\\\n(C_1+D_{12}K)X & D_{11} & -\\gamma I_q\n\\end{pmatrix} \\prec 0\n$$\n展开矩阵分块：\n$$\n\\begin{pmatrix}\nX A^T + A X + X K^T B_2^T + B_2 K X & B_1 & C_1^T + K^T D_{12}^T \\\\\nB_1^T & -\\gamma I_p & D_{11}^T \\\\\nC_1 X + D_{12} K X & D_{11} & -\\gamma I_q\n\\end{pmatrix} \\prec 0\n$$\n这个不等式仍然包含双线性项 $K X$ 和 $X K^T$。最后一步是进行变量代换。定义一个新的矩阵变量 $Y = K X$。通过此定义，$X K^T = Y^T$。将 $Y$ 代入不等式，得到：\n$$\n\\begin{pmatrix}\nX A^T + A X + Y^T B_2^T + B_2 Y & B_1 & C_1^T + Y^T D_{12}^T \\\\\nB_1^T & -\\gamma I_p & D_{11}^T \\\\\nC_1 X + D_{12} Y & D_{11} & -\\gamma I_q\n\\end{pmatrix} \\prec 0\n$$\n这是一个关于变量 $X$ 和 $Y$ 的线性矩阵不等式（LMI）。如果对于某个对称矩阵 $X \\succ 0$ 和矩阵 $Y$，该LMI是可行的，那么一个合适的状态反馈增益就由 $K = Y X^{-1}$ 给出，它保证了 $\\|T_{zw}\\|_{\\infty} < \\gamma$。$(A, B_2)$ 能稳的假设确保了稳定化增益的存在，而LMI框架在可能的情况下会找到一个具有期望性能的增益。\n\nB部分：标量系统的最小可达 $\\gamma$\n\n该特定标量系统的参数为：\n$$\nA = -1, \\quad B_{1}=1, \\quad B_{2}=1, \\quad C_{1}=2, \\quad D_{11}=\\frac{1}{3}, \\quad D_{12}=4\n$$\n这里，$n=m=p=q=1$。增益 $K$ 是一个标量，我们将其记为 $k$。\n对于这个简单情况，使用传递函数进行直接解析比求解LMI更具洞察力。从 $w$ 到 $z$ 的闭环传递函数 $T_{zw}(s)$ 为：\n$$\nT_{zw}(s) = C_{cl}(sI - A_{cl})^{-1}B_{cl} + D_{cl}\n$$\n标量闭环矩阵为：\n$A_{cl} = A + B_{2}k = -1+k$\n$B_{cl} = B_1 = 1$\n$C_{cl} = C_1 + D_{12}k = 2+4k$\n$D_{cl} = D_{11} = \\frac{1}{3}$\n\n为了内部稳定，系统的极点 $s = k-1$ 必须位于开左半平面，这要求 $k-1 < 0$，即 $k < 1$。\n\n传递函数为：\n$$\nT_{zw}(s) = \\frac{2+4k}{s - (-1+k)} + \\frac{1}{3} = \\frac{2+4k}{s+1-k} + \\frac{1}{3} = \\frac{3(2+4k) + (s+1-k)}{3(s+1-k)} = \\frac{s + 7+11k}{3(s+1-k)}\n$$\n$\\mathcal{H}_{\\infty}$ 范数是 $T_{zw}(j\\omega)$ 的幅值在所有频率 $\\omega \\in \\mathbb{R}$ 上的上确界：\n$$\n\\|T_{zw}\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} |T_{zw}(j\\omega)|\n$$\n我们来计算 $|T_{zw}(j\\omega)|^2$：\n$$\n|T_{zw}(j\\omega)|^2 = \\left| \\frac{j\\omega + (7+11k)}{3(j\\omega + (1-k))} \\right|^2 = \\frac{1}{9} \\frac{\\omega^2 + (7+11k)^2}{\\omega^2 + (1-k)^2}\n$$\n为了找到在所有稳定化增益 $k<1$ 上的 $\\|T_{zw}\\|_{\\infty}$ 的下确界，我们分析该函数关于 $\\omega$ 的行为。令 $f(\\Omega) = \\frac{\\Omega + a}{\\Omega + b}$，其中 $\\Omega = \\omega^2 \\ge 0$，$a = (7+11k)^2$，$b = (1-k)^2 \\ge 0$。其关于 $\\Omega$ 的导数为 $f'(\\Omega) = \\frac{b-a}{(\\Omega+b)^2}$。\n- 如果 $b > a$，$f'(\\Omega) > 0$，所以 $f(\\Omega)$ 是递增的。最大值在 $\\Omega \\to \\infty$ 处取得，此时 $f(\\Omega) \\to 1$。\n- 如果 $b < a$，$f'(\\Omega) < 0$，所以 $f(\\Omega)$ 是递减的。最大值在 $\\Omega = 0$ 处取得，此时 $f(0) = a/b$。\n- 如果 $b=a$，$f(\\Omega)=1$ 是常数。\n\n条件 $a=b$ 对应于 $(7+11k)^2 = (1-k)^2$，这意味着 $7+11k = \\pm(1-k)$。\n1. $7+11k = 1-k \\implies 12k = -6 \\implies k = -\\frac{1}{2}$。\n2. $7+11k = -(1-k) = k-1 \\implies 10k = -8 \\implies k = -\\frac{4}{5}$。\n\n$k = -1/2$ 和 $k = -4/5$ 都在稳定域 $k < 1$ 内。\n对于 $k \\in [-4/5, -1/2]$，我们有 $(7+11k)^2 \\le (1-k)^2$，即 $a \\le b$。在此范围内，函数 $f(\\Omega)$ 是非递减的，所以其上确界是 $\\lim_{\\Omega\\to\\infty} f(\\Omega) = 1$。因此，对于 $k \\in [-4/5, -1/2]$，有 $\\|T_{zw}\\|_{\\infty}^2 = \\frac{1}{9}(1) = \\frac{1}{9}$，这意味着 $\\|T_{zw}\\|_{\\infty} = \\frac{1}{3}$。\n\n例如，选择 $k = -1/2$，闭环矩阵 $C_{cl} = 2 + 4(-1/2) = 0$。传递函数变为 $T_{zw}(s) = 0 + D_{cl} = 1/3$。其范数恰好为 $1/3$。这是一个有效的稳定控制器。\n\n在此区间之外，对于 $k < -4/5$ 或 $k \\in (-1/2, 1)$，我们有 $a > b$，最大幅值在 $\\omega=0$ 处取得：\n$$\n\\|T_{zw}\\|_{\\infty}^2 = \\frac{1}{9} \\frac{a}{b} = \\frac{1}{9} \\left( \\frac{7+11k}{1-k} \\right)^2 \\implies \\|T_{zw}\\|_{\\infty} = \\frac{1}{3} \\left| \\frac{7+11k}{1-k} \\right|\n$$\n函数 $h(k) = \\frac{7+11k}{1-k}$ 具有 $h(-4/5) = -1$ 和 $h(-1/2) = 1$。它对于 $k<1$ 是单调递增的。因此，对于 $k \\notin [-4/5, -1/2]$，有 $|h(k)| > 1$，这意味着 $\\|T_{zw}\\|_{\\infty} > 1/3$。\n\n综合这些结果，在所有稳定化增益 $k < 1$ 上，$\\|T_{zw}\\|_{\\infty}$ 的最小可能值为 $1/3$。\n$$\n\\gamma_{opt} = \\inf_{k<1} \\|T_{zw}\\|_{\\infty} = \\frac{1}{3}\n$$\n问题要求的是所有存在增益 $K$ 使得 $\\|T_{zw}\\|_{\\infty} < \\gamma$ 成立的 $\\gamma$ 的下确界。这恰好是 $\\gamma_{opt}$。\n这个结果与前馈项 $D_{11}$ 施加了一个基本限制这一事实是一致的。传递函数在无穷频率处的范数为 $|T_{zw}(j\\infty)| = |D_{11}| = 1/3$。因此，对于任何稳定控制器，都有 $\\|T_{zw}\\|_{\\infty} \\ge |D_{11}| = 1/3$。\n\n我们的分析表明，这个下界是可达的。因此，可达性能水平 $\\gamma$ 的下确界是 $1/3$。对于任何 $\\gamma > 1/3$，我们可以选择 $k=-1/2$，这得到 $\\|T_{zw}\\|_{\\infty} = 1/3 < \\gamma$。然而，对于 $\\gamma=1/3$，不可能满足严格不等式 $\\|T_{zw}\\|_{\\infty} < 1/3$。因此，最小可达的 $\\gamma$ 是 $1/3$。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "2740566"}]}