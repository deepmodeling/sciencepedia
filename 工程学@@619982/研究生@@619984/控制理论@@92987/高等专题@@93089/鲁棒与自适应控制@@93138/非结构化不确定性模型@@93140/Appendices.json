{"hands_on_practices": [{"introduction": "本练习旨在建立鲁棒控制理论中抽象传递函数（如补敏感度函数 $T(s)$）与计算所需的具体状态空间表示之间的关键联系。通过完成推导和数值算例，您将获得将理论概念转化为可供分析和仿真的形式的实践经验。这个问题 [@problem_id:2757113] 还将探讨系统表示中极小化这一重要概念，加深您对模型内在属性的理解。", "problem": "考虑一个单输入单输出线性时不变被控对象，其状态空间实现由 $ \\dot{x}(t) = A x(t) + B u(t)$ 和 $y(t) = C x(t)$ 给出，其中 $A \\in \\mathbb{R}^{n \\times n}$，$B \\in \\mathbb{R}^{n \\times 1}$，$C \\in \\mathbb{R}^{1 \\times n}$，并假设 $D = 0$。控制器是一个严格真或真的动态输出反馈律，作用于跟踪误差 $e(t) = r(t) - y(t)$，其实现为 $ \\dot{x}_K(t) = A_K x_K(t) + B_K e(t)$ 和 $u(t) = C_K x_K(t) + D_K e(t)$，其中 $A_K \\in \\mathbb{R}^{n_K \\times n_K}$，$B_K \\in \\mathbb{R}^{n_K \\times 1}$，$C_K \\in \\mathbb{R}^{1 \\times n_K}$，以及 $D_K \\in \\mathbb{R}$。将互补灵敏度函数 $T(s)$ 定义为标准单位反馈互连中从参考输入 $r$ 到被控对象输出 $y$ 的传递函数，其中 $e = r - y$。\n\n你需要分析乘性输出不确定性，其模型为 $G_{\\Delta}(s) = \\left(I + W_m(s) \\Delta(s)\\right) G(s)$，其中 $G(s)$ 是标称被控对象，$W_m(s)$ 是一个稳定的、真的整形滤波器，$\\Delta(s)$ 是任意稳定的、范数有界的扰动，在Hardy空间范数（Hardy空间 $H_{\\infty}$ 范数）下满足 $\\|\\Delta\\|_{\\infty} \\leq 1$。\n\n任务：\n1. 从闭环互连的定义出发，不使用任何现成的互连公式，推导互补灵敏度 $T(s)$ 从 $r$ 到 $y$ 的状态空间实现，用 $(A,B,C)$ 和 $(A_K,B_K,C_K,D_K)$ 表示。然后，使用线性时不变系统的标准串联互连规则，推导乘积 $M_m(s) \\triangleq W_m(s)\\,T(s)$ 的状态空间实现，其中 $W_m(s)$ 的实现为 $(A_w,B_w,C_w,D_w)$。你的推导必须从运动方程和输出方程开始，通过消除内部信号来获得闭环状态矩阵、输入矩阵、输出矩阵和直通项。\n\n2. 通过以下具体论证，验证 $\\|M_m\\|_{\\infty}$ 对实现最小性的不变性：对于你在任务1中推导的任何实现，附加一个解耦的稳定模式 $\\dot{\\xi}(t) = -\\alpha \\,\\xi(t)$（其中 $\\alpha > 0$），该模式不与输入或输出耦合，从而产生一个非最小实现。基于第一性原理，论证传递函数以及因此产生的 $H_{\\infty}$ 范数是否会改变。\n\n3. 对以下数值情况进行特例分析：\n- 被控对象 $P(s) = \\dfrac{1}{s+1}$，实现为 $A = -1$, $B = 1$, $C = 1$；\n- 控制器 $K(s) = k$，$k = 2$，实现为 $D_K = 2$ 且无控制器状态（因此 $A_K$, $B_K$, $C_K$ 为空，控制器是真控制器）；\n- 乘性不确定性权重 $W_m(s) = \\dfrac{1}{2}$，实现为 $A_w$ 为空, $B_w$ 为空, $C_w$ 为空, 且 $D_w = \\dfrac{1}{2}$。\n\n计算互补灵敏度 $T(s)$，然后计算 $M_m(s) = W_m(s) T(s)$。最后，计算此情况下的Hardy空间 $H_{\\infty}$ 范数 $\\|M_m\\|_{\\infty}$。对于单输入单输出传递函数，回想一下，$H_{\\infty}$ 范数等于频率响应幅值在所有频率上的上确界。请提供你的最终答案为精确值（不要四舍五入）。\n\n你的最终答案必须是任务3中数值情况下的 $\\|M_m\\|_{\\infty}$ 的单个值。最终答案中不要包含任何单位。", "solution": "所述问题是有效的。这是一个在线性鲁棒控制理论领域内提法得当、有科学依据的问题，没有歧义、矛盾或事实错误。我们进行严谨的、分步的求解。\n\n控制系统的主要方程如下：\n被控对象：\n$$\n\\begin{aligned}\n\\dot{x}(t) &= A x(t) + B u(t) \\\\\ny(t) &= C x(t)\n\\end{aligned}\n$$\n控制器：\n$$\n\\begin{aligned}\n\\dot{x}_K(t) &= A_K x_K(t) + B_K e(t) \\\\\nu(t) &= C_K x_K(t) + D_K e(t)\n\\end{aligned}\n$$\n反馈互连：\n$$\ne(t) = r(t) - y(t)\n$$\n\n**任务1：状态空间实现的推导**\n\n首先，我们推导互补灵敏度函数 $T(s)$ 的状态空间实现，它是从参考输入 $r$ 到被控对象输出 $y$ 的传递函数。这需要构建闭环系统动力学。\n我们将闭环状态向量定义为 $x_{cl}(t) = \\begin{pmatrix} x(t) \\\\ x_K(t) \\end{pmatrix}$。\n\n将 $y(t) = C x(t)$ 代入反馈律 $e(t) = r(t) - y(t)$，得到 $e(t) = r(t) - C x(t)$。\n现在，将 $e(t)$ 的表达式代入控制器方程：\n$$\n\\begin{aligned}\n\\dot{x}_K(t) &= A_K x_K(t) + B_K (r(t) - C x(t)) = -B_K C x(t) + A_K x_K(t) + B_K r(t) \\\\\nu(t) &= C_K x_K(t) + D_K (r(t) - C x(t)) = -D_K C x(t) + C_K x_K(t) + D_K r(t)\n\\end{aligned}\n$$\n接下来，将控制输入 $u(t)$ 的表达式代入被控对象的状态方程：\n$$\n\\dot{x}(t) = A x(t) + B(-D_K C x(t) + C_K x_K(t) + D_K r(t)) = (A - B D_K C)x(t) + B C_K x_K(t) + B D_K r(t)\n$$\n我们现在可以使用状态向量 $x_{cl}$ 将完整的闭环状态动力学组合成矩阵形式：\n$$\n\\dot{x}_{cl}(t) = \\begin{pmatrix} \\dot{x}(t) \\\\ \\dot{x}_K(t) \\end{pmatrix} = \\begin{pmatrix} A - B D_K C & B C_K \\\\ -B_K C & A_K \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ x_K(t) \\end{pmatrix} + \\begin{pmatrix} B D_K \\\\ B_K \\end{pmatrix} r(t)\n$$\n输出方程为 $y(t) = C x(t)$。用闭环状态 $x_{cl}$ 表示，即为：\n$$\ny(t) = \\begin{pmatrix} C & 0 \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ x_K(t) \\end{pmatrix} + 0 \\cdot r(t)\n$$\n因此，$T(s)$ 的状态空间实现，我们记为 $(A_T, B_T, C_T, D_T)$，是：\n$$\nA_T = \\begin{pmatrix} A - B D_K C & B C_K \\\\ -B_K C & A_K \\end{pmatrix}, \\quad B_T = \\begin{pmatrix} B D_K \\\\ B_K \\end{pmatrix}, \\quad C_T = \\begin{pmatrix} C & 0 \\end{pmatrix}, \\quad D_T = 0\n$$\n\n其次，我们推导 $M_m(s) \\triangleq W_m(s)T(s)$ 的状态空间实现。这对应于一个串联互连，其中系统 $T(s)$ 的输出是系统 $W_m(s)$ 的输入。\n设 $W_m(s)$ 的实现为 $(A_w, B_w, C_w, D_w)$，其状态为 $x_w$。\n互连系统的状态方程为：\n$$\n\\begin{aligned}\n\\dot{x}_{cl}(t) &= A_T x_{cl}(t) + B_T r(t) \\\\\ny(t) &= C_T x_{cl}(t) + D_T r(t) \\\\\n\\dot{x}_w(t) &= A_w x_w(t) + B_w y(t) \\\\\ny_m(t) &= C_w x_w(t) + D_w y(t)\n\\end{aligned}\n$$\n其中 $y_m$ 是复合系统 $M_m(s)$ 的输出。\n设复合状态为 $x_M(t) = \\begin{pmatrix} x_{cl}(t) \\\\ x_w(t) \\end{pmatrix}$。通过代入：\n$$\n\\begin{aligned}\n\\dot{x}_w(t) &= A_w x_w(t) + B_w (C_T x_{cl}(t) + D_T r(t)) = B_w C_T x_{cl}(t) + A_w x_w(t) + B_w D_T r(t) \\\\\ny_m(t) &= C_w x_w(t) + D_w (C_T x_{cl}(t) + D_T r(t)) = D_w C_T x_{cl}(t) + C_w x_w(t) + D_w D_T r(t)\n\\end{aligned}\n$$\n对于 $M_m(s)$ 的复合状态空间实现，记为 $(A_M, B_M, C_M, D_M)$，是：\n$$\nA_M = \\begin{pmatrix} A_T & 0 \\\\ B_w C_T & A_w \\end{pmatrix}, \\quad B_M = \\begin{pmatrix} B_T \\\\ B_w D_T \\end{pmatrix}, \\quad C_M = \\begin{pmatrix} D_w C_T & C_w \\end{pmatrix}, \\quad D_M = D_w D_T\n$$\n我们代入 $T(s)$ 的具体实现。由于 $D_T = 0$，表达式得以简化。完整的状态向量是 $\\begin{pmatrix} x(t) \\\\ x_K(t) \\\\ x_w(t) \\end{pmatrix}$。\n$$\nA_M = \\begin{pmatrix} A_T & 0 \\\\ B_w C_T & A_w \\end{pmatrix} = \\begin{pmatrix} A - B D_K C & B C_K & 0 \\\\ -B_K C & A_K & 0 \\\\ B_w C & 0 & A_w \\end{pmatrix}\n$$\n$$\nB_M = \\begin{pmatrix} B_T \\\\ B_w D_T \\end{pmatrix} = \\begin{pmatrix} B D_K \\\\ B_K \\\\ 0 \\end{pmatrix}\n$$\n$$\nC_M = \\begin{pmatrix} D_w C_T & C_w \\end{pmatrix} = \\begin{pmatrix} D_w C & 0 & C_w \\end{pmatrix}\n$$\n$$\nD_M = D_w D_T = 0\n$$\n这就完成了第一个任务的推导。\n\n**任务2：范数对非最小实现的不变性**\n\n我们要论证 $H_{\\infty}$ 范数对于增加一个稳定的、解耦的模式 $\\dot{\\xi}(t) = -\\alpha \\xi(t)$（其中 $\\alpha > 0$）是不变的。设 $M_m(s)$ 的最小实现为 $(A_M, B_M, C_M, D_M)$。\n用状态向量 $x_{aug} = \\begin{pmatrix} x_M \\\\ \\xi \\end{pmatrix}$ 构建一个增广的、非最小的实现 $(A_{aug}, B_{aug}, C_{aug}, D_{aug})$：\n$$\nA_{aug} = \\begin{pmatrix} A_M & 0 \\\\ 0 & -\\alpha \\end{pmatrix}, \\quad B_{aug} = \\begin{pmatrix} B_M \\\\ 0 \\end{pmatrix}, \\quad C_{aug} = \\begin{pmatrix} C_M & 0 \\end{pmatrix}, \\quad D_{aug} = D_M\n$$\n$B_{aug}$ 中的零表示模式 $\\xi$ 是不可控的。$C_{aug}$ 中的零表示模式 $\\xi$ 是不可观的。\n传递函数定义为 $G(s) = C(sI - A)^{-1}B + D$。对于增广系统，其传递函数 $M_{m,aug}(s)$ 为：\n$$\nM_{m,aug}(s) = C_{aug}(sI - A_{aug})^{-1}B_{aug} + D_{aug}\n$$\n项 $(sI - A_{aug})$ 具有块对角结构：\n$$\n(sI - A_{aug}) = \\begin{pmatrix} sI - A_M & 0 \\\\ 0 & s+\\alpha \\end{pmatrix}\n$$\n其逆矩阵也是块对角的：\n$$\n(sI - A_{aug})^{-1} = \\begin{pmatrix} (sI - A_M)^{-1} & 0 \\\\ 0 & (s+\\alpha)^{-1} \\end{pmatrix}\n$$\n将此代入传递函数表达式：\n$$\n\\begin{aligned}\nM_{m,aug}(s) &= \\begin{pmatrix} C_M & 0 \\end{pmatrix} \\begin{pmatrix} (sI - A_M)^{-1} & 0 \\\\ 0 & (s+\\alpha)^{-1} \\end{pmatrix} \\begin{pmatrix} B_M \\\\ 0 \\end{pmatrix} + D_M \\\\\n&= \\begin{pmatrix} C_M(sI - A_M)^{-1} & 0 \\end{pmatrix} \\begin{pmatrix} B_M \\\\ 0 \\end{pmatrix} + D_M \\\\\n&= C_M(sI - A_M)^{-1}B_M + D_M \\\\\n&= M_m(s)\n\\end{aligned}\n$$\n该计算从第一性原理证明了非最小系统的传递函数与原始最小系统的传递函数完全相同。由于该模式的不可控性和不可观性，增加的极点 $s = -\\alpha$ 被抵消了。\n$H_{\\infty}$ 范数定义为 $\\|G\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} \\sigma_{max}(G(j\\omega))$，对于单输入单输出系统，这简化为 $\\|G\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} |G(j\\omega)|$。由于对所有 $s$ 都有 $M_{m,aug}(s) = M_m(s)$，它们的频率响应 $M_{m,aug}(j\\omega)$ 和 $M_m(j\\omega)$ 是相同的。因此，它们的上确界必定相等：\n$$\n\\|M_{m,aug}\\|_{\\infty} = \\|M_m\\|_{\\infty}\n$$\n这验证了 $H_{\\infty}$ 范数对于增加不可控和不可观模式的不变性，从而也验证了其对实现最小性的不变性。\n\n**任务3：数值计算**\n\n我们给定以下具体的数值情况：\n被控对象 $P(s)$: $A = -1$, $B = 1$, $C = 1$, $D = 0$。其传递函数为 $P(s) = C(sI-A)^{-1}B = 1(s-(-1))^{-1}1 = \\frac{1}{s+1}$。\n控制器 $K(s)$: $D_K = 2$。$A_K$, $B_K$, $C_K$ 为空。这是一个静态比例控制器，$K(s) = 2$。\n权重 $W_m(s)$: $D_w = \\frac{1}{2}$。$A_w$, $B_w$, $C_w$ 为空。这是一个静态权重，$W_m(s) = \\frac{1}{2}$。\n\n首先，我们使用单位反馈回路的标准公式计算互补灵敏度函数 $T(s)$，$T(s) = \\frac{P(s)K(s)}{1+P(s)K(s)}$：\n$$\nT(s) = \\frac{\\left(\\frac{1}{s+1}\\right)(2)}{1+\\left(\\frac{1}{s+1}\\right)(2)} = \\frac{\\frac{2}{s+1}}{\\frac{(s+1)+2}{s+1}} = \\frac{2}{s+3}\n$$\n接下来，我们计算 $M_m(s) = W_m(s) T(s)$：\n$$\nM_m(s) = \\left(\\frac{1}{2}\\right) \\left(\\frac{2}{s+3}\\right) = \\frac{1}{s+3}\n$$\n最后，我们计算 $M_m(s)$ 的 $H_{\\infty}$ 范数。对于这个标量传递函数，其范数是其频率响应幅值的上确界：\n$$\n\\|M_m\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} |M_m(j\\omega)|\n$$\n我们在 $s = j\\omega$ 处计算 $M_m(s)$：\n$$\nM_m(j\\omega) = \\frac{1}{j\\omega + 3} = \\frac{1}{3 + j\\omega}\n$$\n其幅值为：\n$$\n|M_m(j\\omega)| = \\left| \\frac{1}{3 + j\\omega} \\right| = \\frac{1}{|3 + j\\omega|} = \\frac{1}{\\sqrt{3^2 + \\omega^2}} = \\frac{1}{\\sqrt{9 + \\omega^2}}\n$$\n为了找到这个表达式的上确界，我们必须找到它在所有实数 $\\omega$ 上的最大值。当其分母 $\\sqrt{9 + \\omega^2}$ 最小时，该表达式取最大值。项 $\\omega^2$ 是非负的，其在 $\\omega = 0$ 时取最小值 $0$。\n因此，分母的最小值为 $\\sqrt{9+0} = 3$。\n因此，幅值的最大值，即 $H_{\\infty}$ 范数，是：\n$$\n\\|M_m\\|_{\\infty} = \\frac{1}{\\sqrt{9+0^2}} = \\frac{1}{3}\n$$", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "2757113"}, {"introduction": "不确定性模型的选择不仅仅是数学上的便利，它对鲁棒性分析的保守性有着深远的影响。本练习 [@problem_id:2757047] 提出了一个引人深思的情景，涉及一个谐振系统，以展示加性不确定性和乘性不确定性模型如何仅根据完全相同的实验数据，就可能得出截然不同的结论。这项实践将增强您对模型结构如何与被控对象动态特性相互作用的直觉。", "problem": "考虑单输入单输出标称对象 $P_{0}(s) = \\dfrac{1}{s^{2} + 0.1\\,s + 1}$，其具有弱阻尼复极点，与静态控制器 $K(s) = 2$ 构成单位负反馈。假设在共振频率 $\\omega_{0} = 1$ rad/s 处的频率响应测试产生了一个单一的原始误差数据：此频率下的加性模型误差幅值为 $|E(\\mathrm{j}\\omega_{0})| = 1$。仅使用此数据，定义两个恒定的非结构化不确定性权重，它们在 $\\omega_{0}$ 处对相同的原始误差数据进行插值：\n- 加性权重 $W_{a}(s) \\equiv 1$，满足 $|W_{a}(\\mathrm{j}\\omega_{0})| = |E(\\mathrm{j}\\omega_{0})|$。\n- (输出)乘性权重 $W_{m}(s) \\equiv \\rho_{0}$，其中 $\\rho_{0}$ 是在 $\\omega_{0}$ 处的相对误差，由 $\\rho_{0} = \\dfrac{|E(\\mathrm{j}\\omega_{0})|}{|P_{0}(\\mathrm{j}\\omega_{0})|}$ 给出。\n\n使用小增益定理以及标准的灵敏度和互补灵敏度定义，\n$$\nS(s) = \\bigl(1 + P_{0}(s)K(s)\\bigr)^{-1}, \n\\qquad\nT(s) = P_{0}(s)K(s)\\,\\bigl(1 + P_{0}(s)K(s)\\bigr)^{-1},\n$$\n以形成逐频率的鲁棒稳定性证书：\n- 对于加性对象不确定性 $P(s) = P_{0}(s) + W_{a}(s)\\Delta_{a}(s)$，其中 $\\|\\Delta_{a}\\|_{\\infty} \\leq 1$，在频率 $\\omega$ 处的充分小增益条件为 $|W_{a}(\\mathrm{j}\\omega)\\,K(\\mathrm{j}\\omega)\\,S(\\mathrm{j}\\omega)| < 1$。\n- 对于(输出)乘性对象不确定性 $P(s) = \\bigl(1 + W_{m}(s)\\Delta_{m}(s)\\bigr)P_{0}(s)$，其中 $\\|\\Delta_{m}\\|_{\\infty} \\leq 1$，在频率 $\\omega$ 处的充分小增益条件为 $|W_{m}(\\mathrm{j}\\omega)\\,T(\\mathrm{j}\\omega)| < 1$。\n\n为了基于相同的原始误差数据获得一个具体的、自洽的反例，请在频率集 $\\Omega = \\{\\omega_{0}, \\infty\\}$ 上评估这些小增益不等式，此频率集捕捉了该回路在共振点 $|T|$ 的峰值和在高频处 $|K S|$ 的峰值。在此频率集上，定义原始误差数据的最大允许均匀缩放因子 $\\sigma_{a}$ 和 $\\sigma_{m}$，使得对于所有 $\\omega \\in \\Omega$，以下各自的不等式成立：\n- 加性：对于所有 $\\omega \\in \\Omega$，$\\sigma_{a}\\,|W_{a}(\\mathrm{j}\\omega)\\,K(\\mathrm{j}\\omega)\\,S(\\mathrm{j}\\omega)| < 1$。\n- 乘性：对于所有 $\\omega \\in \\Omega$，$\\sigma_{m}\\,|W_{m}(\\mathrm{j}\\omega)\\,T(\\mathrm{j}\\omega)| < 1$。\n\n计算比率\n$$\nR \\;=\\; \\frac{\\sigma_{m}}{\\sigma_{a}}\n$$\n的精确值。无需四舍五入；以精确解析形式提供您的答案，不带单位。", "solution": "所述问题是良态的、内部一致的，并且科学上基于鲁棒控制理论的既定原则。我们可以直接进行计算。\n\n标称对象由传递函数 $P_{0}(s) = \\dfrac{1}{s^{2} + 0.1s + 1}$ 给出。控制器是一个静态增益 $K(s) = 2$。分析集中于共振频率 $\\omega_{0} = 1$ rad/s。\n\n首先，我们评估标称对象在 $s = \\mathrm{j}\\omega_{0} = \\mathrm{j}1$ 处的频率响应：\n$$\nP_{0}(\\mathrm{j}1) = \\frac{1}{(\\mathrm{j}1)^{2} + 0.1(\\mathrm{j}1) + 1} = \\frac{1}{-1 + 0.1\\mathrm{j} + 1} = \\frac{1}{0.1\\mathrm{j}} = -10\\mathrm{j}\n$$\n幅值为 $|P_{0}(\\mathrm{j}1)| = |-10\\mathrm{j}| = 10$。\n\n问题陈述，在该频率下有一个单一误差数据 $|E(\\mathrm{j}\\omega_{0})| = 1$ 可用。此数据用于定义不确定性权重。\n加性权重为 $W_{a}(s) \\equiv 1$，这与条件 $|W_{a}(\\mathrm{j}\\omega_{0})| = |E(\\mathrm{j}\\omega_{0})|$ 一致，因为 $|1| = 1$。\n乘性权重是一个常数 $W_{m}(s) \\equiv \\rho_{0}$，其中 $\\rho_{0}$ 是在 $\\omega_{0}$ 处的相对误差：\n$$\n\\rho_{0} = \\frac{|E(\\mathrm{j}\\omega_{0})|}{|P_{0}(\\mathrm{j}\\omega_{0})|} = \\frac{1}{10} = 0.1\n$$\n因此，$W_{m}(s) \\equiv 0.1$。\n\n接下来，我们确定灵敏度函数 $S(s)$ 和互补灵敏度函数 $T(s)$。回路传递函数为 $L_{0}(s) = P_{0}(s)K(s) = \\dfrac{2}{s^{2} + 0.1s + 1}$。\n$$\nS(s) = \\bigl(1 + L_{0}(s)\\bigr)^{-1} = \\left(1 + \\frac{2}{s^{2} + 0.1s + 1}\\right)^{-1} = \\left(\\frac{s^{2} + 0.1s + 3}{s^{2} + 0.1s + 1}\\right)^{-1} = \\frac{s^{2} + 0.1s + 1}{s^{2} + 0.1s + 3}\n$$\n$$\nT(s) = L_{0}(s)S(s) = \\frac{2}{s^{2} + 0.1s + 1} \\cdot \\frac{s^{2} + 0.1s + 1}{s^{2} + 0.1s + 3} = \\frac{2}{s^{2} + 0.1s + 3}\n$$\n鲁棒稳定性条件必须在频率集 $\\Omega = \\{\\omega_{0}, \\infty\\} = \\{1, \\infty\\}$ 上进行评估。\n\n对于加性不确定性模型，条件是 $\\sigma_{a} |W_{a}(\\mathrm{j}\\omega)K(\\mathrm{j}\\omega)S(\\mathrm{j}\\omega)| < 1$。由于 $W_{a}(s) \\equiv 1$ 和 $K(s) = 2$，这变为 $\\sigma_{a} |2S(\\mathrm{j}\\omega)| < 1$。最大允许的 $\\sigma_{a}$ 由下式给出：\n$$\n\\sigma_{a} = \\frac{1}{\\max_{\\omega \\in \\{1, \\infty\\}} |2S(\\mathrm{j}\\omega)|}\n$$\n我们在 $\\omega=1$ 和 $\\omega \\to \\infty$ 时评估 $|2S(\\mathrm{j}\\omega)|$。\n在 $\\omega = 1$ 时：\n$$\n|2S(\\mathrm{j}1)| = \\left|2 \\frac{(\\mathrm{j}1)^{2} + 0.1(\\mathrm{j}1) + 1}{(\\mathrm{j}1)^{2} + 0.1(\\mathrm{j}1) + 3}\\right| = \\left|2 \\frac{-1 + 0.1\\mathrm{j} + 1}{-1 + 0.1\\mathrm{j} + 3}\\right| = \\left|\\frac{0.2\\mathrm{j}}{2 + 0.1\\mathrm{j}}\\right| = \\frac{0.2}{\\sqrt{2^2 + (0.1)^2}} = \\frac{0.2}{\\sqrt{4.01}} = \\frac{2}{\\sqrt{401}}\n$$\n当 $\\omega \\to \\infty$ 时：\n$$\n\\lim_{\\omega \\to \\infty} |2S(\\mathrm{j}\\omega)| = \\lim_{\\omega \\to \\infty} \\left|2 \\frac{-\\omega^2 + 0.1\\mathrm{j}\\omega + 1}{-\\omega^2 + 0.1\\mathrm{j}\\omega + 3}\\right| = \\left|2 \\cdot \\lim_{\\omega \\to \\infty} \\frac{-\\omega^2}{-\\omega^2}\\right| = |2 \\cdot 1| = 2\n$$\n最大值为 $\\max\\left\\{\\dfrac{2}{\\sqrt{401}}, 2\\right\\} = 2$。因此，$\\sigma_{a} = \\dfrac{1}{2}$。\n\n对于乘性不确定性模型，条件是 $\\sigma_{m} |W_{m}(\\mathrm{j}\\omega)T(\\mathrm{j}\\omega)| < 1$。由于 $W_{m}(s) \\equiv 0.1$，这变为 $\\sigma_{m} |0.1T(\\mathrm{j}\\omega)| < 1$。最大允许的 $\\sigma_{m}$ 由下式给出：\n$$\n\\sigma_{m} = \\frac{1}{\\max_{\\omega \\in \\{1, \\infty\\}} |0.1T(\\mathrm{j}\\omega)|}\n$$\n我们在 $\\omega=1$ 和 $\\omega \\to \\infty$ 时评估 $|0.1T(\\mathrm{j}\\omega)|$。\n在 $\\omega = 1$ 时：\n$$\n|0.1T(\\mathrm{j}1)| = \\left|0.1 \\frac{2}{(\\mathrm{j}1)^{2} + 0.1(\\mathrm{j}1) + 3}\\right| = \\left|\\frac{0.2}{-1 + 0.1\\mathrm{j} + 3}\\right| = \\left|\\frac{0.2}{2 + 0.1\\mathrm{j}}\\right| = \\frac{0.2}{\\sqrt{2^2 + (0.1)^2}} = \\frac{0.2}{\\sqrt{4.01}} = \\frac{2}{\\sqrt{401}}\n$$\n当 $\\omega \\to \\infty$ 时：\n$$\n\\lim_{\\omega \\to \\infty} |0.1T(\\mathrm{j}\\omega)| = \\lim_{\\omega \\to \\infty} \\left|0.1 \\frac{2}{-\\omega^2 + 0.1\\mathrm{j}\\omega + 3}\\right| = 0.1 \\cdot \\lim_{\\omega \\to \\infty} \\frac{2}{\\omega^2} = 0\n$$\n最大值为 $\\max\\left\\{\\dfrac{2}{\\sqrt{401}}, 0\\right\\} = \\dfrac{2}{\\sqrt{401}}$。因此，$\\sigma_{m} = \\dfrac{1}{2/\\sqrt{401}} = \\dfrac{\\sqrt{401}}{2}$。\n\n最后，我们计算比率 $R$：\n$$\nR = \\frac{\\sigma_{m}}{\\sigma_{a}} = \\frac{\\sqrt{401}/2}{1/2} = \\sqrt{401}\n$$\n这一结果表明，基于相同的单一原始误差测量，不确定性模型结构（加性与乘性）的选择会导致关于不确定性允许大小的截然不同的结论。具体来说，乘性模型表明对不确定性权重的整体缩放有大得多的容忍度。", "answer": "$$\n\\boxed{\\sqrt{401}}\n$$", "id": "2757047"}, {"introduction": "这最后一个练习将所有知识点融会贯通，从分析转向综合。您将采用经典的回路成形方法设计一个反馈控制器，其目标不仅是实现性能指标（如由敏感度函数 $S$ 体现的扰动抑制能力），还要明确保证在存在模型不确定性（由加权补敏感度函数 $W_m T$ 描述）的情况下系统的稳定性。这项练习 [@problem_id:2757056] 模拟了一个真实的工程任务，即必须在性能和鲁棒性之间进行权衡。", "problem": "给定一个单输入单输出 (SISO) 标称对象模型和一个非结构化乘性输出不确定性权重，以及表示为灵敏度函数和加权互补灵敏度函数无穷范数上界的性能和鲁棒稳定性规范。您的任务是构建一个指定形式的回路成形控制器，计算闭环频率响应，并验证是否满足规范。所有计算都是无量纲的，并且必须以弧度/秒为单位进行。没有物理单位；频率单位为弧度/秒，所有幅值均为无量纲。\n\n使用的背景和定义：\n- 设标称对象表示为 $G(s)$，控制器表示为 $K(s)$。开环传递函数为 $L(s) = G(s)K(s)$。\n- 灵敏度函数为 $S(s) = \\frac{1}{1 + L(s)}$，互补灵敏度函数为 $T(s) = \\frac{L(s)}{1 + L(s)}$。\n- 非结构化乘性输出不确定性模型假设实际对象为 $G_{\\text{act}}(s) = G(s) \\left(1 + \\Delta_m(s) W_m(s)\\right)$，其中 $\\Delta_m(s)$ 是稳定的且满足 $\\|\\Delta_m\\|_\\infty \\leq 1$，$W_m(s)$ 是一个稳定的、已知的加权函数。\n- 从小增益定理 (SGT) 推导出的乘性输出不确定性的鲁棒稳定性条件是 $\\|W_m T\\|_\\infty < 1$。\n- 标称性能条件指定为 $\\|S\\|_\\infty \\leq M_S$，其中给定 $M_S > 0$。\n\n要使用的控制器结构：\n- 您必须使用形式如下的回路成形控制器\n$$\nK(s) = k \\cdot \\frac{1 + s/z_g}{1 + s/p_g} \\cdot \\frac{1}{s} \\cdot \\frac{1}{1 + s/p_f},\n$$\n其中 $k > 0$、$z_g > 0$、$p_g > 0$ 且 $p_f > 0$。\n- 对于选定的目标穿越频率 $\\omega_c > 0$，设置 $z_g = \\omega_c/4$、$p_g = 4 \\omega_c$ 和 $p_f = 50 \\omega_c$。\n- 选择增益 $k$ 以精确满足单位增益穿越条件 $\\left|L(\\mathrm{j}\\omega_c)\\right| = 1$，其中 $L(s) = G(s)K(s)$。\n\n数值评估要求：\n- 通过在至少包含 $N = 2000$ 个点的对数间隔频率网格 $\\omega \\in [10^{-3}, 10^{3}]$ 上计算最大幅值来近似无穷范数。\n- 对于SISO系统，使用复频率响应的绝对值来计算幅值。即，对于 $S(\\mathrm{j}\\omega)$ 和 $T(\\mathrm{j}\\omega)$，取 $|S(\\mathrm{j}\\omega)|$ 和 $|T(\\mathrm{j}\\omega)|$；对于加权互补灵敏度，计算 $|W_m(\\mathrm{j}\\omega) T(\\mathrm{j}\\omega)|$。\n\n对象、不确定性权重和规范（测试套件）：\n所有系统均为SISO、真的和稳定的。每个测试用例提供一个标称对象、一个乘性不确定性权重、一个目标穿越频率和一个性能规范 $M_S$。\n\n- 测试用例 1：\n  - 对象：$G_1(s) = \\dfrac{1}{(0.2 s + 1)(s + 1)}$。\n  - 权重：$W_{m,1}(s) = 0.2 \\cdot \\dfrac{s/3 + 1}{s/30 + 1}$。\n  - 目标：$\\omega_{c,1} = 2$。\n  - 性能目标：$M_{S,1} = 2.0$。\n\n- 测试用例 2：\n  - 对象：$G_2(s) = \\dfrac{3}{(0.5 s + 1)(0.05 s + 1)}$。\n  - 权重：$W_{m,2}(s) = 0.8 \\cdot \\dfrac{s/5 + 1}{s/50 + 1}$。\n  - 目标：$\\omega_{c,2} = 5$。\n  - 性能目标：$M_{S,2} = 1.5$。\n\n- 测试用例 3：\n  - 对象：$G_3(s) = \\dfrac{1}{(0.2 s + 1)(s + 1)}$。\n  - 权重：$W_{m,3}(s) = 1.5 \\cdot \\dfrac{s/3 + 1}{s/30 + 1}$。\n  - 目标：$\\omega_{c,3} = 2$。\n  - 性能目标：$M_{S,3} = 2.0$。\n\n对于每个测试用例，您必须：\n1. 使用指定的结构和参数化方法构建 $K(s)$，其中 $z_g = \\omega_c/4$、$p_g = 4\\omega_c$、$p_f = 50\\omega_c$，并选择 $k$ 使得 $\\left|G(\\mathrm{j}\\omega_c)K(\\mathrm{j}\\omega_c)\\right| = 1$。\n2. 在指定的频率网格上计算 $S(\\mathrm{j}\\omega)$ 和 $T(\\mathrm{j}\\omega)$，并评估\n   $$\n   \\|S\\|_\\infty \\approx \\max_{\\omega} |S(\\mathrm{j}\\omega)|,\\quad \\|W_m T\\|_\\infty \\approx \\max_{\\omega} |W_m(\\mathrm{j}\\omega) T(\\mathrm{j}\\omega)|.\n   $$\n3. 检查条件：\n   - 标称性能：$\\|S\\|_\\infty \\leq M_S$。\n   - 鲁棒稳定性（乘性不确定性）：$\\|W_m T\\|_\\infty < 1$。\n\n要求的最终输出格式：\n- 对于每个测试用例，按顺序 $\\big[\\text{performance\\_ok}, \\text{robust\\_stability\\_ok}\\big]$ 输出一对布尔值。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，不含空格，格式为\n  $$\n  \\big[\\,[b_{1,1},b_{1,2}],[b_{2,1},b_{2,2}],[b_{3,1},b_{3,2}]\\,\\big],\n  $$\n  其中每个 $b_{i,j}$ 为 $\\text{True}$ 或 $\\text{False}$。", "solution": "所述问题是有效的。这是一个关于 SISO 鲁棒控制系统设计和分析的适定练习，其基础是控制理论的基本原理。所有定义、参数和规范都以清晰、一致且科学合理的方式提供，从而可以得到唯一且可验证的解。该方法将涉及为每个指定情况设计一个控制器，然后根据给定标准数值验证其性能。\n\n核心任务是为标称对象 $G(s)$ 设计一个控制器 $K(s)$，以满足两个条件：\n1. 标称性能 (NP)：灵敏度函数 $S(s) = (1+G(s)K(s))^{-1}$ 的无穷范数必须有界。具体来说，$\\|S\\|_\\infty \\le M_S$。\n2. 鲁棒稳定性 (RS)：对于存在乘性输出不确定性 $G_{\\text{act}}(s) = G(s)(1 + \\Delta_m(s)W_m(s))$ 且 $\\|\\Delta_m\\|_\\infty \\le 1$ 的对象，闭环系统对于所有此类不确定性必须保持稳定。小增益定理为此提供了充分条件：$\\|W_m T\\|_\\infty < 1$，其中 $T(s) = G(s)K(s)(1+G(s)K(s))^{-1}$是互补灵敏度函数，$W_m(s)$ 是不确定性权重。\n\n控制器具有规定的结构：\n$$\nK(s) = k \\cdot \\frac{1 + s/z_g}{1 + s/p_g} \\cdot \\frac{1}{s} \\cdot \\frac{1}{1 + s/p_f}\n$$\n参数 $z_g$、$p_g$ 和 $p_f$ 由目标穿越频率 $\\omega_c$ 确定，分别为 $z_g = \\omega_c/4$、$p_g = 4\\omega_c$ 和 $p_f = 50\\omega_c$。选择增益 $k>0$ 以强制满足单位增益穿越条件 $|G(\\mathrm{j}\\omega_c)K(\\mathrm{j}\\omega_c)| = 1$。\n\n通过在具有 $N=2000$ 个对数间隔点的离散频率网格 $\\omega \\in [10^{-3}, 10^3]$ rad/s 上取最大幅值来近似无穷范数。设 $s = \\mathrm{j}\\omega$。\n\n### 测试用例 1\n\n**给定条件：**\n- 对象：$G_1(s) = \\dfrac{1}{(0.2 s + 1)(s + 1)}$\n- 权重：$W_{m,1}(s) = 0.2 \\cdot \\dfrac{s/3 + 1}{s/30 + 1}$\n- 目标穿越频率：$\\omega_{c,1} = 2.0$ rad/s\n- 性能目标：$M_{S,1} = 2.0$\n\n**控制器设计：**\n控制器参数由 $\\omega_{c,1} = 2.0$ 确定：\n- $z_{g,1} = \\omega_{c,1}/4 = 2.0/4 = 0.5$\n- $p_{g,1} = 4\\omega_{c,1} = 4 \\cdot 2.0 = 8.0$\n- $p_{f,1} = 50\\omega_{c,1} = 50 \\cdot 2.0 = 100.0$\n\n控制器为 $K_1(s) = k_1 \\cdot \\frac{1 + s/0.5}{1 + s/8.0} \\cdot \\frac{1}{s} \\cdot \\frac{1}{1 + s/100.0}$。\n增益 $k_1$ 由条件 $|G_1(\\mathrm{j}2) K_1(\\mathrm{j}2)| = 1$ 求得。设 $K_{1,0}(s) = K_1(s)/k_1$。\n首先，在 $s = \\mathrm{j}\\omega_{c,1} = 2\\mathrm{j}$ 处评估 $G_1(s)$ 和 $K_{1,0}(s)$ 的频率响应。\n$G_1(2\\mathrm{j}) = \\frac{1}{(0.2(2\\mathrm{j}) + 1)(2\\mathrm{j} + 1)} = \\frac{1}{(1 + 0.4\\mathrm{j})(1 + 2\\mathrm{j})} = \\frac{1}{0.2 + 2.4\\mathrm{j}}$。\n幅值为 $|G_1(2\\mathrm{j})| = \\frac{1}{\\sqrt{0.2^2 + 2.4^2}} = \\frac{1}{\\sqrt{5.8}} \\approx 0.41499$。\n$K_{1,0}(2\\mathrm{j}) = \\frac{1 + 2\\mathrm{j}/0.5}{1 + 2\\mathrm{j}/8.0} \\cdot \\frac{1}{2\\mathrm{j}} \\cdot \\frac{1}{1 + 2\\mathrm{j}/100.0} = \\frac{1 + 4\\mathrm{j}}{1 + 0.25\\mathrm{j}} \\cdot \\frac{1}{2\\mathrm{j}} \\cdot \\frac{1}{1 + 0.02\\mathrm{j}}$。\n幅值为 $|K_{1,0}(2\\mathrm{j})| = \\frac{\\sqrt{1^2+4^2}}{\\sqrt{1^2+0.25^2}} \\cdot \\frac{1}{2} \\cdot \\frac{1}{\\sqrt{1^2+0.02^2}} = \\frac{\\sqrt{17}}{\\sqrt{1.0625}} \\cdot 0.5 \\cdot \\frac{1}{\\sqrt{1.0004}} \\approx 1.99950$。\n增益 $k_1$ 计算如下 $k_1 = \\frac{1}{|G_1(2\\mathrm{j})| |K_{1,0}(2\\mathrm{j})|} = \\frac{1}{0.41499 \\cdot 1.99950} \\approx \\frac{1}{0.82977} \\approx 1.20516$。\n\n**分析与验证：**\n使用设计的控制器 $K_1(s)$，其中 $k_1 \\approx 1.20516$，我们构成开环传递函数 $L_1(s) = G_1(s)K_1(s)$ 并数值评估范数。\n- $\\|S_1\\|_\\infty \\approx \\max_{\\omega}|(1+L_1(\\mathrm{j}\\omega))^{-1}| \\approx 1.488$。\n- $\\|W_{m,1}T_1\\|_\\infty \\approx \\max_{\\omega}|W_{m,1}(\\mathrm{j}\\omega)L_1(\\mathrm{j}\\omega)(1+L_1(\\mathrm{j}\\omega))^{-1}| \\approx 0.584$。\n\n**测试用例 1 的结论：**\n- 标称性能：是否 $\\|S_1\\|_\\infty \\leq M_{S,1}$？$1.488 \\leq 2.0$。此条件为真。\n- 鲁棒稳定性：是否 $\\|W_{m,1}T_1\\|_\\infty < 1$？$0.584 < 1$。此条件为真。\n布尔结果为 $[\\text{True}, \\text{True}]$。\n\n### 测试用例 2\n\n**给定条件：**\n- 对象：$G_2(s) = \\dfrac{3}{(0.5 s + 1)(0.05 s + 1)}$\n- 权重：$W_{m,2}(s) = 0.8 \\cdot \\dfrac{s/5 + 1}{s/50 + 1}$\n- 目标穿越频率：$\\omega_{c,2} = 5.0$ rad/s\n- 性能目标：$M_{S,2} = 1.5$\n\n**控制器设计：**\n控制器参数由 $\\omega_{c,2} = 5.0$ 确定：\n- $z_{g,2} = \\omega_{c,2}/4 = 5.0/4 = 1.25$\n- $p_{g,2} = 4\\omega_{c,2} = 4 \\cdot 5.0 = 20.0$\n- $p_{f,2} = 50\\omega_{c,2} = 50 \\cdot 5.0 = 250.0$\n控制器为 $K_2(s) = k_2 \\cdot \\frac{1 + s/1.25}{1 + s/20.0} \\cdot \\frac{1}{s} \\cdot \\frac{1}{1 + s/250.0}$。\n增益 $k_2$ 由条件 $|G_2(\\mathrm{j}5) K_2(\\mathrm{j}5)| = 1$ 求得。设 $K_{2,0}(s) = K_2(s)/k_2$。\n在 $s = \\mathrm{j}\\omega_{c,2} = 5\\mathrm{j}$ 处：\n$G_2(5\\mathrm{j}) = \\frac{3}{(0.5(5\\mathrm{j}) + 1)(0.05(5\\mathrm{j}) + 1)} = \\frac{3}{(1 + 2.5\\mathrm{j})(1 + 0.25\\mathrm{j})} = \\frac{3}{0.375 + 2.75\\mathrm{j}}$。\n幅值为 $|G_2(5\\mathrm{j})| = \\frac{3}{\\sqrt{0.375^2 + 2.75^2}} = \\frac{3}{\\sqrt{7.703125}} \\approx 1.08093$。\n$|K_{2,0}(5\\mathrm{j})| = \\frac{|1 + 5\\mathrm{j}/1.25|}{|1 + 5\\mathrm{j}/20.0|} \\cdot \\frac{1}{|5\\mathrm{j}|} \\cdot \\frac{1}{|1 + 5\\mathrm{j}/250.0|} = \\frac{|1+4\\mathrm{j}|}{|1+0.25\\mathrm{j}|} \\cdot \\frac{1}{5} \\cdot \\frac{1}{|1+0.02\\mathrm{j}|} \\approx 0.79980$。\n增益 $k_2$ 计算如下 $k_2 = \\frac{1}{|G_2(5\\mathrm{j})| |K_{2,0}(5\\mathrm{j})|} = \\frac{1}{1.08093 \\cdot 0.79980} \\approx \\frac{1}{0.86453} \\approx 1.15671$。\n\n**分析与验证：**\n使用设计的控制器 $K_2(s)$，其中 $k_2 \\approx 1.15671$：\n- $\\|S_2\\|_\\infty \\approx \\max_{\\omega}|(1+L_2(\\mathrm{j}\\omega))^{-1}| \\approx 1.579$。\n- $\\|W_{m,2}T_2\\|_\\infty \\approx \\max_{\\omega}|W_{m,2}(\\mathrm{j}\\omega)L_2(\\mathrm{j}\\omega)(1+L_2(\\mathrm{j}\\omega))^{-1}| \\approx 1.259$。\n\n**测试用例 2 的结论：**\n- 标称性能：是否 $\\|S_2\\|_\\infty \\leq M_{S,2}$？$1.579 \\leq 1.5$。此条件为假。\n- 鲁棒稳定性：是否 $\\|W_{m,2}T_2\\|_\\infty < 1$？$1.259 < 1$。此条件为假。\n布尔结果为 $[\\text{False}, \\text{False}]$。\n\n### 测试用例 3\n\n**给定条件：**\n- 对象：$G_3(s) = \\dfrac{1}{(0.2 s + 1)(s + 1)}$\n- 权重：$W_{m,3}(s) = 1.5 \\cdot \\dfrac{s/3 + 1}{s/30 + 1}$\n- 目标穿越频率：$\\omega_{c,3} = 2.0$ rad/s\n- 性能目标：$M_{S,3} = 2.0$\n\n**控制器设计：**\n对象 $G_3(s)$、穿越频率 $\\omega_{c,3}$ 和性能目标 $M_{S,3}$ 与测试用例 1 相同。因此，设计的控制器 $K_3(s)$ 与 $K_1(s)$ 相同，开环函数 $L_3(s)$ 与 $L_1(s)$ 相同，灵敏度函数 $S_3(s)$ 与 $S_1(s)$ 相同。\n$K_3(s) = K_1(s)$，其中 $k_3 = k_1 \\approx 1.20516$。\n\n**分析与验证：**\n- 由于 $S_3(s) = S_1(s)$，我们有 $\\|S_3\\|_\\infty = \\|S_1\\|_\\infty \\approx 1.488$。\n- 不确定性权重不同：$W_{m,3}(s) = 1.5 \\cdot \\frac{s/3+1}{s/30+1}$。注意 $W_{m,3}(s) = \\frac{1.5}{0.2} W_{m,1}(s) = 7.5 \\cdot W_{m,1}(s)$。\n- 加权互补灵敏度检查是针对 $\\|W_{m,3} T_3\\|_\\infty$。由于 $T_3(s) = T_1(s)$，范数为 $\\|W_{m,3} T_3\\|_\\infty = \\|7.5 \\cdot W_{m,1} T_1\\|_\\infty = 7.5 \\cdot \\|W_{m,1} T_1\\|_\\infty$。\n- 使用用例 1 的结果，$\\|W_{m,3}T_3\\|_\\infty \\approx 7.5 \\cdot 0.584 = 4.38$。\n\n**测试用例 3 的结论：**\n- 标称性能：是否 $\\|S_3\\|_\\infty \\leq M_{S,3}$？$1.488 \\leq 2.0$。此条件为真。\n- 鲁棒稳定性：是否 $\\|W_{m,3}T_3\\|_\\infty < 1$？$4.38 < 1$。此条件为假。\n布尔结果为 $[\\text{True}, \\text{False}]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the control design and verification problem for three test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"G_func\": lambda s: 1.0 / ((0.2 * s + 1.0) * (s + 1.0)),\n            \"Wm_func\": lambda s: 0.2 * (s / 3.0 + 1.0) / (s / 30.0 + 1.0),\n            \"omega_c\": 2.0,\n            \"M_S\": 2.0,\n        },\n        {\n            \"G_func\": lambda s: 3.0 / ((0.5 * s + 1.0) * (0.05 * s + 1.0)),\n            \"Wm_func\": lambda s: 0.8 * (s / 5.0 + 1.0) / (s / 50.0 + 1.0),\n            \"omega_c\": 5.0,\n            \"M_S\": 1.5,\n        },\n        {\n            \"G_func\": lambda s: 1.0 / ((0.2 * s + 1.0) * (s + 1.0)),\n            \"Wm_func\": lambda s: 1.5 * (s / 3.0 + 1.0) / (s / 30.0 + 1.0),\n            \"omega_c\": 2.0,\n            \"M_S\": 2.0,\n        },\n    ]\n\n    # Frequency grid for numerical evaluation of infinity norms\n    omega = np.logspace(-3, 3, 2000)\n    s = 1j * omega\n\n    results = []\n    for case in test_cases:\n        G_func = case[\"G_func\"]\n        Wm_func = case[\"Wm_func\"]\n        omega_c = case[\"omega_c\"]\n        M_S = case[\"M_S\"]\n\n        # 1. Construct the controller K(s)\n        # Controller parameters based on target crossover frequency\n        z_g = omega_c / 4.0\n        p_g = 4.0 * omega_c\n        p_f = 50.0 * omega_c\n\n        # Function for the controller without the gain k\n        K0_func = lambda s_val: ((1.0 + s_val / z_g) / (1.0 + s_val / p_g)) * \\\n                                (1.0 / s_val) * \\\n                                (1.0 / (1.0 + s_val / p_f))\n\n        # Calculate gain k to satisfy |L(j*omega_c)| = 1\n        s_c = 1j * omega_c\n        G_at_omega_c = G_func(s_c)\n        K0_at_omega_c = K0_func(s_c)\n        \n        # Ensure the magnitude is not zero to avoid division by zero\n        L0_mag_at_omega_c = np.abs(G_at_omega_c * K0_at_omega_c)\n        if L0_mag_at_omega_c  1e-9:\n             # This case should not happen for the given problems\n             k = 0.0\n        else:\n             k = 1.0 / L0_mag_at_omega_c\n\n        # Full controller function\n        K_func = lambda s_val: k * K0_func(s_val)\n\n        # 2. Compute frequency responses and evaluate norms\n        # Evaluate transfer functions over the frequency grid\n        G_s = G_func(s)\n        K_s = K_func(s)\n        L_s = G_s * K_s\n        Wm_s = Wm_func(s)\n\n        # Sensitivity and Complementary Sensitivity functions\n        S_s = 1.0 / (1.0 + L_s)\n        T_s = L_s / (1.0 + L_s)\n\n        # Approximate infinity norms\n        S_inf_norm = np.max(np.abs(S_s))\n        WmT_inf_norm = np.max(np.abs(Wm_s * T_s))\n\n        # 3. Check the conditions\n        performance_ok = S_inf_norm = M_S\n        robust_stability_ok = WmT_inf_norm  1.0\n        \n        # Format the result string for the current case as [Bool,Bool]\n        # str() on a bool produces 'True' or 'False'\n        results.append(f\"[{str(performance_ok)},{str(robust_stability_ok)}]\")\n\n    # Final print statement in the exact required format: [[b1,b2],[b3,b4],...]\n    print(f\"[[{','.join(results)}]]\")\n\nsolve()\n```", "id": "2757056"}]}