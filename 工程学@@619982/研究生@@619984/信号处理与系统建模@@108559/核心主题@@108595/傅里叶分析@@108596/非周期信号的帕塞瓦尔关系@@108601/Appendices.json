{"hands_on_practices": [{"introduction": "我们从一个经典的信号——单边指数衰减信号——开始。这个练习 [@problem_id:2889877] 将引导你直接在时域中计算信号的能量，然后独立地在频域中进行计算，从而证明两者确实相等。这个实践也突显了帕塞瓦尔关系的一个关键前提：信号必须具有有限能量，即属于 $L^2$ 空间。", "problem": "设 $x(t)=\\exp(-a t)\\,u(t)$，其中 $a>0$ 且 $u(t)$ 为单位阶跃函数，定义为当 $t\\ge 0$ 时 $u(t)=1$，当 $t<0$ 时 $u(t)=0$。使用以下傅里叶变换 (Fourier transform, FT) 约定：\n$$\nX(\\omega)=\\int_{-\\infty}^{\\infty} x(t)\\,\\exp(-j\\omega t)\\,dt,\\qquad\nx(t)=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} X(\\omega)\\,\\exp(j\\omega t)\\,d\\omega.\n$$\n任务：\n- 仅从上述定义出发，计算 $x(t)$ 的傅里叶变换 $X(\\omega)$，并将其简化为闭合形式。\n- 证明 $x(t)\\in L^{2}(\\mathbb{R})$ (在勒贝格意义上平方可积) 当且仅当 $a>0$，并计算时域能量\n$$\nE_{t}=\\int_{-\\infty}^{\\infty} |x(t)|^{2}\\,dt.\n$$\n- 使用你得到的 $X(\\omega)$，在相同的FT约定下，计算频域量\n$$\nE_{\\omega}=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} |X(\\omega)|^{2}\\,d\\omega\n$$\n利用基本原理和标准的实分析事实精确计算该积分。\n- 判断当 $a>0$ 时是否有 $E_{t}=E_{\\omega}$，并简要解释为什么条件 $x\\in L^{2}(\\mathbb{R})$ 是该等式有意义的必要条件。\n\n$E_{t}$ 和 $E_{\\omega}$ 的共同值是多少，表示为 $a$ 的函数？请以关于 $a$ 的单个闭合形式表达式提供最终答案。无需四舍五入，且不涉及物理单位。", "solution": "所给问题是傅里叶分析中的一个标准练习，该问题提法良好，科学上合理，并包含了求解所需的所有信息。我们将按要求进行系统推导。\n\n第一个任务是计算信号 $x(t) = \\exp(-a t)\\,u(t)$ 的傅里叶变换（FT），其中 $a > 0$ 且 $u(t)$ 是亥维赛单位阶跃函数。FT定义为：\n$$\nX(\\omega) = \\int_{-\\infty}^{\\infty} x(t)\\,\\exp(-j\\omega t)\\,dt\n$$\n代入 $x(t)$ 的表达式：\n$$\nX(\\omega) = \\int_{-\\infty}^{\\infty} \\exp(-a t)\\,u(t)\\,\\exp(-j\\omega t)\\,dt\n$$\n单位阶跃函数 $u(t)$ 在 $t < 0$ 时为零，在 $t \\ge 0$ 时为一。此性质将积分下限从 $-\\infty$ 改为 $0$。\n$$\nX(\\omega) = \\int_{0}^{\\infty} \\exp(-a t)\\,(1)\\,\\exp(-j\\omega t)\\,dt\n$$\n合并指数项：\n$$\nX(\\omega) = \\int_{0}^{\\infty} \\exp(-(a + j\\omega)t)\\,dt\n$$\n这是一个标准的反常积分。我们计算如下：\n$$\nX(\\omega) = \\left[ \\frac{\\exp(-(a + j\\omega)t)}{-(a + j\\omega)} \\right]_{0}^{\\infty} = \\lim_{T \\to \\infty} \\left[ \\frac{\\exp(-(a + j\\omega)t)}{-(a + j\\omega)} \\right]_{0}^{T}\n$$\n$$\nX(\\omega) = \\frac{1}{-(a + j\\omega)} \\left( \\lim_{T \\to \\infty} \\exp(-(a + j\\omega)T) - \\exp(0) \\right)\n$$\n为了计算该极限，我们考察指数项的模：\n$$\n|\\exp(-(a + j\\omega)T)| = |\\exp(-aT)\\exp(-j\\omega T)| = |\\exp(-aT)| \\cdot |\\exp(-j\\omega T)| = \\exp(-aT) \\cdot 1 = \\exp(-aT)\n$$\n由于问题规定 $a > 0$，当 $T \\to \\infty$ 时，项 $\\exp(-aT)$ 趋近于 $0$。因此，该极限为零。\n$$\n\\lim_{T \\to \\infty} \\exp(-(a + j\\omega)T) = 0\n$$\n将此结果代回 $X(\\omega)$ 的表达式中：\n$$\nX(\\omega) = \\frac{1}{-(a + j\\omega)} (0 - 1) = \\frac{1}{a + j\\omega}\n$$\n这就是 $x(t)$ 的傅里叶变换的闭合形式表达式。\n\n第二个任务是证明 $x(t)$ 是平方可积的，即 $x(t) \\in L^{2}(\\mathbb{R})$，当且仅当 $a > 0$，并计算时域能量 $E_{t}$。条件 $x(t) \\in L^{2}(\\mathbb{R})$ 意味着其模的平方的积分是有限的。这个积分恰好是能量 $E_{t}$ 的定义。\n$$\nE_{t} = \\int_{-\\infty}^{\\infty} |x(t)|^{2}\\,dt = \\int_{-\\infty}^{\\infty} |\\exp(-a t)\\,u(t)|^{2}\\,dt\n$$\n由于 $t$ 是一个实变量，$a$ 是一个正实数常数，且 $u(t)$ 是实数，其模的平方为：\n$$\n|\\exp(-a t)\\,u(t)|^{2} = (\\exp(-a t))^{2} (u(t))^{2} = \\exp(-2a t)\\,u(t)\n$$\n最后一步成立，因为 $u(t)$ 的值是 $0$ 或 $1$，所以 $u(t)^2 = u(t)$。积分变为：\n$$\nE_{t} = \\int_{-\\infty}^{\\infty} \\exp(-2a t)\\,u(t)\\,dt = \\int_{0}^{\\infty} \\exp(-2a t)\\,dt\n$$\n该积分收敛当且仅当指数中的系数 $-2a$ 严格为负。这要求 $2a > 0$，即 $a > 0$。这证实了 $x(t) \\in L^{2}(\\mathbb{R})$ 当且仅当 $a > 0$。\n现在我们计算当 $a > 0$ 时积分的值：\n$$\nE_{t} = \\left[ \\frac{\\exp(-2a t)}{-2a} \\right]_{0}^{\\infty} = \\lim_{T \\to \\infty} \\left( \\frac{\\exp(-2a T)}{-2a} \\right) - \\frac{\\exp(0)}{-2a}\n$$\n由于 $a > 0$，极限项为 $0$。因此：\n$$\nE_{t} = 0 - \\frac{1}{-2a} = \\frac{1}{2a}\n$$\n这就是信号的时域能量。\n\n第三个任务是使用推导出的 $X(\\omega)$ 计算频域量 $E_{\\omega}$。\n$$\nE_{\\omega} = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} |X(\\omega)|^{2}\\,d\\omega\n$$\n首先，我们计算 $|X(\\omega)|^{2}$。\n$$\n|X(\\omega)|^{2} = \\left| \\frac{1}{a + j\\omega} \\right|^{2} = \\frac{|1|^{2}}{|a + j\\omega|^{2}} = \\frac{1}{a^{2} + \\omega^{2}}\n$$\n现在我们将此代入 $E_{\\omega}$ 的积分中：\n$$\nE_{\\omega} = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} \\frac{1}{a^{2} + \\omega^{2}}\\,d\\omega\n$$\n这是一个来自实分析的标准积分。$\\frac{1}{k^{2} + y^{2}}$ 关于 $y$ 的不定积分是 $\\frac{1}{k}\\arctan(\\frac{y}{k})$。在我们的例子中，$y=\\omega$ 且 $k=a$。\n$$\nE_{\\omega} = \\frac{1}{2\\pi} \\left[ \\frac{1}{a} \\arctan\\left(\\frac{\\omega}{a}\\right) \\right]_{-\\infty}^{\\infty}\n$$\n我们在上下限处计算这个值：\n$$\nE_{\\omega} = \\frac{1}{2\\pi a} \\left( \\lim_{\\omega \\to \\infty} \\arctan\\left(\\frac{\\omega}{a}\\right) - \\lim_{\\omega \\to -\\infty} \\arctan\\left(\\frac{\\omega}{a}\\right) \\right)\n$$\n由于 $a > 0$，当 $\\omega \\to \\infty$ 时，$\\frac{\\omega}{a} \\to \\infty$；当 $\\omega \\to -\\infty$ 时，$\\frac{\\omega}{a} \\to -\\infty$。反正切函数的极限是众所周知的：\n$$\n\\lim_{z \\to \\infty} \\arctan(z) = \\frac{\\pi}{2} \\quad \\text{and} \\quad \\lim_{z \\to -\\infty} \\arctan(z) = -\\frac{\\pi}{2}\n$$\n代入这些值：\n$$\nE_{\\omega} = \\frac{1}{2\\pi a} \\left( \\frac{\\pi}{2} - \\left(-\\frac{\\pi}{2}\\right) \\right) = \\frac{1}{2\\pi a} \\left( \\frac{\\pi}{2} + \\frac{\\pi}{2} \\right) = \\frac{1}{2\\pi a} (\\pi)\n$$\n$$\nE_{\\omega} = \\frac{1}{2a}\n$$\n\n最后，我们需要判断是否有 $E_{t} = E_{\\omega}$，并解释条件 $x \\in L^{2}(\\mathbb{R})$ 的必要性。\n我们的计算表明，对于 $a > 0$：\n$$\nE_{t} = \\frac{1}{2a} \\quad \\text{and} \\quad E_{\\omega} = \\frac{1}{2a}\n$$\n因此，我们得出结论 $E_{t} = E_{\\omega}$。这个结果是非周期信号的帕塞瓦尔定理的一个具体体现，该定理在给定的FT约定下表述为：\n$$\n\\int_{-\\infty}^{\\infty} |x(t)|^{2}\\,dt = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} |X(\\omega)|^{2}\\,d\\omega\n$$\n条件 $x \\in L^{2}(\\mathbb{R})$ 是基础性的。$L^{2}(\\mathbb{R})$ 空间是有限能量信号的空间。定义能量 $E_{t}$ 的积分必须收敛，能量才是一个有意义的有限量。如果 $x(t)$ 不在 $L^{2}(\\mathbb{R})$ 中，其能量 $E_{t}$ 是无限的。在这种情况下，等式 $E_{t} = E_{\\omega}$ 变得没有意义，因为它将等同于两个发散的积分，这不是一个有效的数学命题。帕塞瓦尔定理是关于傅里叶变换作为希尔伯特空间 $L^{2}(\\mathbb{R})$ 上的一个酉算子（相差一个缩放因子）的性质的陈述。它本质上说明了FT保持信号的范数（或能量）。这个性质仅为该空间内的信号所定义和保证。对于一个不在 $L^2(\\mathbb{R})$ 中的信号，其傅里叶变换的存在性和性质更为复杂，并且通常不符合这种能量守恒的恒等式。\n\n$E_{t}$ 和 $E_{\\omega}$ 的共同值是 $\\frac{1}{2a}$。", "answer": "$$\n\\boxed{\\frac{1}{2a}}\n$$", "id": "2889877"}, {"introduction": "现在，让我们将理解转移到离散时间信号的世界。这个练习 [@problem_id:2889874] 使用离散时间的指数衰减信号来验证离散时间傅里叶变换 (DTFT) 的帕塞瓦尔关系。你会看到时域中的连续积分如何被求和所取代，而能量守恒的核心原则保持不变。", "problem": "考虑由 $x[n]=a^{n}u[n]$ 定义的离散时间非周期信号，其中 $a\\in\\mathbb{R}$ 满足 $|a|<1$ 且 $u[n]$ 是单位阶跃函数。令 $X(\\exp(\\mathrm{j}\\omega))$ 表示 $x[n]$ 的离散时间傅里叶变换 (DTFT)，其定义为 $X(\\exp(\\mathrm{j}\\omega))=\\sum_{n=-\\infty}^{\\infty}x[n]\\exp(-\\mathrm{j}\\omega n)$。仅使用定义和基本级数工具，完成以下操作：\n- 计算时域总能量 $E_{t}=\\sum_{n=-\\infty}^{\\infty}|x[n]|^{2}$。\n- 首先求得 $X(\\exp(\\mathrm{j}\\omega))$ 的闭式表达式，然后仅使用收敛级数恒等式和基本复变代数显式地计算积分，从而计算频域量 $E_{f}=\\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi}\\left|X(\\exp(\\mathrm{j}\\omega))\\right|^{2}\\,\\mathrm{d}\\omega$。\n- 验证 $E_{t}=E_{f}$，从而证实该信号的离散时间傅里叶变换 (DTFT) 帕塞瓦尔关系。\n\n将共同值 $E_{t}=E_{f}$ 表示为关于 $a$ 的单个简化解析表达式。以单个闭式表达式的形式提供您的最终答案。无需四舍五- 入，不涉及单位。", "solution": "所给的问题陈述是离散时间信号处理中的一个标准练习，特别是关于一个基本非周期信号的帕塞瓦尔定理的验证。已知条件如下：\n- 信号为 $x[n]=a^{n}u[n]$，其中 $u[n]$ 是单位阶跃函数。\n- 参数 $a$ 是一个实数，$a\\in\\mathbb{R}$，满足约束条件 $|a|<1$。\n- 离散时间傅里叶变换 (DTFT) 定义为 $X(\\exp(\\mathrm{j}\\omega))=\\sum_{n=-\\infty}^{\\infty}x[n]\\exp(-\\mathrm{j}\\omega n)$。\n- 时域总能量为 $E_{t}=\\sum_{n=-\\infty}^{\\infty}|x[n]|^{2}$。\n- 频域总能量为 $E_{f}=\\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi}\\left|X(\\exp(\\mathrm{j}\\omega))\\right|^{2}\\,\\mathrm{d}\\omega$。\n\n该问题具有科学依据，是良定的、客观的。它不包含任何科学缺陷、歧义或缺失信息。约束条件 $|a|<1$ 是至关重要的，且设定正确，它确保了信号具有有限能量并且是绝对可和的，从而保证了能量求和与DTFT的存在性和收敛性。此问题是一项有效且严谨的数学任务。我们将开始求解。\n\n目标是分别计算 $E_{t}$ 和 $E_{f}$，并证明它们相等。\n\n首先，我们计算时域总能量 $E_{t}$。\n根据定义，$E_{t} = \\sum_{n=-\\infty}^{\\infty}|x[n]|^{2}$。\n代入给定信号 $x[n] = a^{n}u[n]$，我们有 $E_{t} = \\sum_{n=-\\infty}^{\\infty}|a^{n}u[n]|^{2}$。\n单位阶跃函数 $u[n]$ 在 $n \\ge 0$ 时等于 $1$，在 $n < 0$ 时等于 $0$。因此，求和下限变为 $n=0$。\n$$E_{t} = \\sum_{n=0}^{\\infty}|a^{n}|^{2}$$\n由于 $a$ 是实数，所以 $|a^{n}|^{2} = (a^{n})^{2} = a^{2n} = (a^{2})^{n}$。表达式变为：\n$$E_{t} = \\sum_{n=0}^{\\infty}(a^{2})^{n}$$\n这是一个公比为 $r = a^{2}$ 的几何级数。条件 $|a|<1$ 意味着 $0 \\le a^{2} < 1$，因此该级数是收敛的。对于 $|r|<1$，无穷几何级数 $\\sum_{k=0}^{\\infty}r^{k}$ 的和为 $\\frac{1}{1-r}$。应用此公式，我们得到：\n$$E_{t} = \\frac{1}{1-a^{2}}$$\n\n接下来，我们计算频域总能量 $E_{f}$。这需要首先求出信号 $x[n]$ 的DTFT, $X(\\exp(\\mathrm{j}\\omega))$。\n使用DTFT的定义：\n$$X(\\exp(\\mathrm{j}\\omega)) = \\sum_{n=-\\infty}^{\\infty}x[n]\\exp(-\\mathrm{j}\\omega n) = \\sum_{n=-\\infty}^{\\infty}a^{n}u[n]\\exp(-\\mathrm{j}\\omega n)$$\n由于单位阶跃函数 $u[n]$，该和仅在 $n \\ge 0$ 时非零：\n$$X(\\exp(\\mathrm{j}\\omega)) = \\sum_{n=0}^{\\infty}a^{n}\\exp(-\\mathrm{j}\\omega n) = \\sum_{n=0}^{\\infty}(a\\exp(-\\mathrm{j}\\omega))^{n}$$\n这是一个公比为 $r = a\\exp(-\\mathrm{j}\\omega)$ 的几何级数。该公比的模为 $|r| = |a\\exp(-\\mathrm{j}\\omega)| = |a||\\exp(-\\mathrm{j}\\omega)| = |a| \\cdot 1 = |a|$。由于 $|a|<1$，该级数收敛。使用几何级数的求和公式，我们得到DTFT的闭式表达式：\n$$X(\\exp(\\mathrm{j}\\omega)) = \\frac{1}{1-a\\exp(-\\mathrm{j}\\omega)}$$\n现在，我们必须计算DTFT的模的平方，即 $|X(\\exp(\\mathrm{j}\\omega))|^{2}$。对任意复数 $Z$，利用性质 $|Z|^{2} = Z Z^{*}$：\n$$|X(\\exp(\\mathrm{j}\\omega))|^{2} = X(\\exp(\\mathrm{j}\\omega)) \\cdot (X(\\exp(\\mathrm{j}\\omega)))^{*} = \\left(\\frac{1}{1-a\\exp(-\\mathrm{j}\\omega)}\\right) \\left(\\frac{1}{1-a\\exp(\\mathrm{j}\\omega)}\\right)$$\n分母为 $(1-a\\exp(-\\mathrm{j}\\omega))(1-a\\exp(\\mathrm{j}\\omega)) = 1 - a\\exp(\\mathrm{j}\\omega) - a\\exp(-\\mathrm{j}\\omega) + a^{2}\\exp(-\\mathrm{j}\\omega)\\exp(\\mathrm{j}\\omega)$。\n这可化简为 $1 - a(\\exp(\\mathrm{j}\\omega) + \\exp(-\\mathrm{j}\\omega)) + a^{2}$。使用欧拉恒等式 $\\cos(\\omega) = \\frac{\\exp(\\mathrm{j}\\omega) + \\exp(-\\mathrm{j}\\omega)}{2}$，我们有：\n$$|X(\\exp(\\mathrm{j}\\omega))|^{2} = \\frac{1}{1-2a\\cos(\\omega)+a^{2}}$$\n现在我们通过对此表达式积分来计算 $E_{f}$：\n$$E_{f} = \\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi}\\left|X(\\exp(\\mathrm{j}\\omega))\\right|^{2}\\,\\mathrm{d}\\omega = \\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi}\\frac{1}{1-2a\\cos(\\omega)+a^{2}}\\,\\mathrm{d}\\omega$$\n为按要求使用级数恒等式计算此积分，我们代入被积函数的级数表示。被积函数 $|X(\\exp(\\mathrm{j}\\omega))|^{2}$ 是两个绝对且一致收敛级数的乘积：\n$$|X(\\exp(\\mathrm{j}\\omega))|^{2} = \\left(\\sum_{n=0}^{\\infty} a^{n} \\exp(-\\mathrm{j}n\\omega)\\right) \\left(\\sum_{k=0}^{\\infty} a^{k} \\exp(\\mathrm{j}k\\omega)\\right)$$\n该乘积可以表示为单个傅里叶级数 $\\sum_{m=-\\infty}^{\\infty}c_{m}\\exp(\\mathrm{j}m\\omega)$。其中系数 $c_{m}$ 是所有满足 $k-n=m$ 且索引 $n, k \\ge 0$ 的项 $a^{n}a^{k}$ 的和。\n系数 $c_{m}$ 由 $c_m = \\sum_{n: n\\ge 0, n+m \\ge 0} a^n a^{n+m}$ 给出。\n对于 $m \\ge 0$，求和索引的条件是 $n \\ge 0$。\n$$c_{m} = \\sum_{n=0}^{\\infty}a^{2n+m} = a^{m}\\sum_{n=0}^{\\infty}(a^{2})^{n} = a^{m}\\frac{1}{1-a^{2}}$$\n对于 $m < 0$，条件是 $n \\ge -m$。\n$$c_{m} = \\sum_{n=-m}^{\\infty}a^{2n+m} = a^{m}\\sum_{n=-m}^{\\infty}(a^{2})^{n}$$\n令 $p = n+m$。当 $n=-m$ 时，$p=0$。该和变为 $a^{m}\\sum_{p=0}^{\\infty}(a^{2})^{p-m} = a^{m}(a^{2})^{-m}\\sum_{p=0}^{\\infty}(a^{2})^{p} = a^{-m}\\frac{1}{1-a^{2}}$。\n综合两种情况，傅里叶系数为 $c_{m} = \\frac{a^{|m|}}{1-a^{2}}$，对所有整数 $m$ 成立。\n因此，被积函数的傅里叶级数为：\n$$|X(\\exp(\\mathrm{j}\\omega))|^{2} = \\sum_{m=-\\infty}^{\\infty} \\frac{a^{|m|}}{1-a^{2}} \\exp(\\mathrm{j}m\\omega)$$\n现在我们通过对此级数逐项积分来计算 $E_{f}$。级数的一致收敛性保证了求和与积分可以互换顺序。\n$$E_{f} = \\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi} \\left(\\sum_{m=-\\infty}^{\\infty} c_{m}\\exp(\\mathrm{j}m\\omega)\\right) \\,\\mathrm{d}\\omega = \\sum_{m=-\\infty}^{\\infty} c_{m} \\left(\\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi} \\exp(\\mathrm{j}m\\omega)\\,\\mathrm{d}\\omega\\right)$$\n积分项是克罗内克δ函数 $\\delta[m]$ 的定义：\n$$\\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi} \\exp(\\mathrm{j}m\\omega)\\,\\mathrm{d}\\omega = \\begin{cases} 1 & m=0 \\\\ 0 & m \\neq 0 \\end{cases} = \\delta[m]$$\n当 $m=0$ 时，求和式坍缩为单项：\n$$E_{f} = \\sum_{m=-\\infty}^{\\infty} c_{m}\\delta[m] = c_{0}$$\n使用我们推导出的系数表达式，我们求得 $c_{0}$：\n$$c_{0} = \\frac{a^{|0|}}{1-a^{2}} = \\frac{1}{1-a^{2}}$$\n因此，频域中的能量为：\n$$E_{f} = \\frac{1}{1-a^{2}}$$\n\n最后，我们比较这两个结果。\n时域能量：$E_{t} = \\frac{1}{1-a^{2}}$。\n频域能量：$E_{f} = \\frac{1}{1-a^{2}}$。\n我们已经显式地证明了 $E_{t} = E_{f}$。这验证了给定信号 $x[n]=a^{n}u[n]$ 的帕塞瓦尔关系。总能量的这个共同值即为所求的答案。", "answer": "$$\n\\boxed{\\frac{1}{1-a^{2}}}\n$$", "id": "2889874"}, {"introduction": "我们最后的实践 [@problem_id:2889897] 是一个高级练习，它揭示了周期信号的傅里叶级数与非周期信号的傅里叶变换之间的深刻联系。通过从一个非周期信号构建一个周期信号，你将通过解析和数值方法，展示傅里叶级数帕塞瓦尔关系中的离散求和如何收敛于傅里叶变换关系中的连续积分。这让你对作为傅里叶理论基础的数学极限过程有一个切实的感受。", "problem": "设 $x(t)$ 为实、偶、绝对可积且平方可积的信号 $x(t)=e^{-a\\lvert t\\rvert}$，其中 $a>0$。考虑以下基本定义。信号 $x(t)$ 的连续时间傅里叶变换 (CTFT) 为 $X(\\omega)=\\int_{-\\infty}^{\\infty} x(t)e^{-j\\omega t}\\,dt$，其逆变换为 $x(t)=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} X(\\omega)e^{j\\omega t}\\,d\\omega$。CTFT 的帕塞瓦尔关系 (Parseval relation) 表述为 $\\int_{-\\infty}^{\\infty} \\lvert x(t)\\rvert^{2}\\,dt=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} \\lvert X(\\omega)\\rvert^{2}\\,d\\omega$。对于一个周期为 $T$ 的信号 $s_{T}(t)$，其基本角频率为 $\\Omega_{0}=\\frac{2\\pi}{T}$，傅里叶级数系数为 $c_{k}=\\frac{1}{T}\\int_{t_{0}}^{t_{0}+T} s_{T}(t)e^{-jk\\Omega_{0} t}\\,dt$，其傅里叶级数的帕塞瓦尔关系表述为 $\\frac{1}{T}\\int_{t_{0}}^{t_{0}+T} \\lvert s_{T}(t)\\rvert^{2}\\,dt=\\sum_{k=-\\infty}^{\\infty} \\lvert c_{k}\\rvert^{2}$。为建立傅里叶级数与 CTFT 之间的联系，定义周期求和 $s_{T}(t)=\\sum_{n\\in\\mathbb{Z}} x(t-nT)$，其傅里叶级数系数满足 $c_{k}=\\frac{1}{T}X(k\\Omega_{0})$。您必须仅使用这些定义和事实，通过解析方法证明，当 $T\\to\\infty$ 时，对于信号 $x(t)=e^{-a\\lvert t\\rvert}$，由 $X(\\omega)$ 的采样点构成的傅里叶级数帕塞瓦尔求和收敛于 CTFT 帕塞瓦尔积分。然后，您必须通过构建相应的黎曼和 (Riemann sums) 并对一组给定的参数值计算其误差，来通过数值方法验证同样的结果。\n\n任务：\n- 从 $X(\\omega)$ 的 CTFT 定义和能量的积分定义出发，推导 $x(t)=e^{-a\\lvert t\\rvert}$ 的 $X(\\omega)$ 和能量 $\\int_{-\\infty}^{\\infty} \\lvert x(t)\\rvert^{2}\\,dt$ 作为 $a$ 的函数的闭式表达式。单独计算 $\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} \\lvert X(\\omega)\\rvert^{2}\\,d\\omega$ 并通过解析计算验证其等于时域能量。\n- 仅使用傅里叶级数和 CTFT 的定义，推导一个关系式，用在网格 $\\omega=k\\Omega_{0}$（其中 $\\Omega_{0}=\\frac{2\\pi}{T}$）上 $\\lvert X(\\omega)\\rvert^{2}$ 的采样点来表示傅里叶级数的帕塞瓦尔求和。由此论证，当 $T\\to\\infty$ 时，由这些采样点构建的频域黎曼和的极限如何恢复为 CTFT 帕塞瓦尔积分。您的推导应清楚地解释为什么采样步长 $\\Omega_{0}$ 在极限情况下充当积分增量。\n- 实现一个程序，对于下述每个测试用例 $(a,T,K)$，该程序使用您得到的 $X(\\omega)$ 的闭式表达式，计算截断的黎曼和\n$$\nS_{T,K}=\\frac{\\Omega_{0}}{2\\pi}\\sum_{k=-K}^{K} \\left\\lvert X\\!\\left(k\\Omega_{0}\\right)\\right\\rvert^{2},\\quad \\Omega_{0}=\\frac{2\\pi}{T},\n$$\n并返回绝对误差\n$$\nE_{T,K}=\\left\\lvert S_{T,K}-\\int_{-\\infty}^{\\infty}\\lvert x(t)\\rvert^{2}\\,dt\\right\\rvert.\n$$\n您必须为每个测试用例将 $E_{T,K}$ 计算为一个实数。\n- 您的程序不得读取任何输入。它必须生成单行输出，该行包含用方括号括起来的、以逗号分隔的结果列表，每个条目对应一个测试用例，并按下述顺序列出。\n\n测试套件：\n- 用例 1：$a=1.0$, $T=40.0$, $K=500$。\n- 用例 2：$a=1.0$, $T=4.0$, $K=500$。\n- 用例 3：$a=0.2$, $T=80.0$, $K=1000$。\n- 用例 4：$a=5.0$, $T=6.0$, $K=80$。\n- 用例 5：$a=1.0$, $T=40.0$, $K=50$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含列表 $[E_{1},E_{2},E_{3},E_{4},E_{5}]$，此处 $E_{i}$ 是用例 $i$ 的 $E_{T,K}$ 值，形式为用方括号括起来的逗号分隔列表（例如，$[r_{1},r_{2},r_{3}]$，但用五个数值结果代替 $r_{i}$）。不应打印任何其他文本。\n- 不涉及物理单位。角度（若使用）以弧度为单位。\n- 每个结果必须是一个实数（一个浮点值）。", "solution": "问题陈述是有效的。这是一个傅里叶分析 (Fourier analysis) 中的适定问题，需要进行标准的解析推导和数值验证。\n\n解答过程分三部分。首先，我们对信号 $x(t)=e^{-a\\lvert t\\rvert}$ 进行所需的解析推导。其次，我们按要求证明离散求和收敛于连续积分。第三，我们基于这些解析结果开发数值实现。\n\n**第一部分：解析推导**\n\n设信号为 $x(t) = e^{-a|t|}$，其中实常数 $a > 0$。\n\n1.  **连续时间傅里叶变换 (CTFT)**\n    CTFT, $X(\\omega)$, 定义为 $X(\\omega) = \\int_{-\\infty}^{\\infty} x(t)e^{-j\\omega t}\\,dt$。\n    由于 $x(t)$ 是偶函数，我们可以将积分拆分：\n    $$\n    X(\\omega) = \\int_{-\\infty}^{0} e^{at}e^{-j\\omega t}\\,dt + \\int_{0}^{\\infty} e^{-at}e^{-j\\omega t}\\,dt\n    $$\n    $$\n    X(\\omega) = \\int_{-\\infty}^{0} e^{(a-j\\omega)t}\\,dt + \\int_{0}^{\\infty} e^{-(a+j\\omega)t}\\,dt\n    $$\n    计算该积分：\n    $$\n    X(\\omega) = \\left[ \\frac{e^{(a-j\\omega)t}}{a-j\\omega} \\right]_{-\\infty}^{0} + \\left[ \\frac{e^{-(a+j\\omega)t}}{-(a+j\\omega)} \\right]_{0}^{\\infty}\n    $$\n    由于 $a > 0$，当 $t \\to -\\infty$ 时 $e^{at}$ 项和当 $t \\to \\infty$ 时 $e^{-at}$ 项均趋近于 $0$。\n    $$\n    X(\\omega) = \\left( \\frac{1}{a-j\\omega} - 0 \\right) + \\left( 0 - \\frac{1}{-(a+j\\omega)} \\right) = \\frac{1}{a-j\\omega} + \\frac{1}{a+j\\omega}\n    $$\n    $$\n    X(\\omega) = \\frac{(a+j\\omega) + (a-j\\omega)}{(a-j\\omega)(a+j\\omega)} = \\frac{2a}{a^2 + \\omega^2}\n    $$\n    CTFT 的闭式表达式为 $X(\\omega) = \\frac{2a}{a^2 + \\omega^2}$。\n\n2.  **时域信号能量**\n    信号的能量 $E_x$ 由积分 $E_x = \\int_{-\\infty}^{\\infty} \\lvert x(t)\\rvert^2\\,dt$ 给出。\n    对于给定信号，这变为：\n    $$\n    E_x = \\int_{-\\infty}^{\\infty} \\left\\lvert e^{-a|t|} \\right\\rvert^2\\,dt = \\int_{-\\infty}^{\\infty} e^{-2a|t|}\\,dt\n    $$\n    由于被积函数是偶函数：\n    $$\n    E_x = 2 \\int_{0}^{\\infty} e^{-2at}\\,dt = 2 \\left[ \\frac{e^{-2at}}{-2a} \\right]_{0}^{\\infty} = 2 \\left( 0 - \\frac{1}{-2a} \\right) = \\frac{1}{a}\n    $$\n    信号能量的闭式表达式为 $E_x = \\frac{1}{a}$。\n\n3.  **帕塞瓦尔关系的验证**\n    我们必须验证 $\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} \\lvert X(\\omega)\\rvert^2\\,d\\omega = E_x$。\n    首先，求 $\\lvert X(\\omega)\\rvert^2$：\n    $$\n    \\lvert X(\\omega)\\rvert^2 = \\left\\lvert \\frac{2a}{a^2 + \\omega^2} \\right\\rvert^2 = \\frac{4a^2}{(a^2 + \\omega^2)^2}\n    $$\n    现在，计算该积分：\n    $$\n    \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} \\frac{4a^2}{(a^2 + \\omega^2)^2}\\,d\\omega = \\frac{2a^2}{\\pi} \\int_{-\\infty}^{\\infty} \\frac{1}{(a^2 + \\omega^2)^2}\\,d\\omega\n    $$\n    令 $\\omega = a\\tan\\theta$，则 $d\\omega = a\\sec^2\\theta\\,d\\theta$。极限 $\\omega \\in (-\\infty, \\infty)$ 对应于 $\\theta \\in (-\\pi/2, \\pi/2)$。\n    $$\n    \\int_{-\\infty}^{\\infty} \\frac{1}{(a^2 + \\omega^2)^2}\\,d\\omega = \\int_{-\\pi/2}^{\\pi/2} \\frac{1}{(a^2 + a^2\\tan^2\\theta)^2} (a\\sec^2\\theta)\\,d\\theta = \\int_{-\\pi/2}^{\\pi/2} \\frac{a\\sec^2\\theta}{a^4(\\sec^2\\theta)^2}\\,d\\theta\n    $$\n    $$\n    = \\frac{1}{a^3} \\int_{-\\pi/2}^{\\pi/2} \\frac{1}{\\sec^2\\theta}\\,d\\theta = \\frac{1}{a^3} \\int_{-\\pi/2}^{\\pi/2} \\cos^2\\theta\\,d\\theta = \\frac{1}{a^3} \\int_{-\\pi/2}^{\\pi/2} \\frac{1+\\cos(2\\theta)}{2}\\,d\\theta\n    $$\n    $$\n    = \\frac{1}{2a^3} \\left[ \\theta + \\frac{\\sin(2\\theta)}{2} \\right]_{-\\pi/2}^{\\pi/2} = \\frac{1}{2a^3} \\left( \\left(\\frac{\\pi}{2} + 0\\right) - \\left(-\\frac{\\pi}{2} + 0\\right) \\right) = \\frac{\\pi}{2a^3}\n    $$\n    将此结果代回能量表达式：\n    $$\n    \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} \\lvert X(\\omega)\\rvert^2\\,d\\omega = \\frac{2a^2}{\\pi} \\left( \\frac{\\pi}{2a^3} \\right) = \\frac{1}{a}\n    $$\n    该结果与时域能量 $E_x$ 相符，从而验证了该信号的帕塞瓦尔关系。\n\n**第二部分：求和收敛于积分**\n\n问题要求通过关联傅里叶级数 (FS) 和 CTFT 来证明求和收敛于积分。\n我们从周期信号 $s_T(t) = \\sum_{n\\in\\mathbb{Z}} x(t-nT)$ 的傅里叶级数帕塞瓦尔关系开始：\n$$\n\\frac{1}{T}\\int_{-T/2}^{T/2} \\lvert s_T(t)\\rvert^2\\,dt = \\sum_{k=-\\infty}^{\\infty} \\lvert c_k\\rvert^2\n$$\n使用给定的、将傅里叶级数系数 $c_k$ 与 CTFT 采样点关联的恒等式 $c_k = \\frac{1}{T}X(k\\Omega_0)$，其中 $\\Omega_0 = 2\\pi/T$：\n$$\n\\sum_{k=-\\infty}^{\\infty} \\lvert c_k\\rvert^2 = \\sum_{k=-\\infty}^{\\infty} \\left\\lvert \\frac{1}{T} X(k\\Omega_0) \\right\\rvert^2 = \\frac{1}{T^2} \\sum_{k=-\\infty}^{\\infty} \\lvert X(k\\Omega_0)\\rvert^2\n$$\n将此代入傅里叶级数帕塞瓦尔关系：\n$$\n\\frac{1}{T}\\int_{-T/2}^{T/2} \\lvert s_T(t)\\rvert^2\\,dt = \\frac{1}{T^2} \\sum_{k=-\\infty}^{\\infty} \\lvert X(k\\Omega_0)\\rvert^2\n$$\n两边同乘以 $T$：\n$$\n\\int_{-T/2}^{T/2} \\lvert s_T(t)\\rvert^2\\,dt = \\frac{1}{T} \\sum_{k=-\\infty}^{\\infty} \\lvert X(k\\Omega_0)\\rvert^2\n$$\n现在，代入 $1/T = \\Omega_0/(2\\pi)$：\n$$\n\\int_{-T/2}^{T/2} \\lvert s_T(t)\\rvert^2\\,dt = \\frac{\\Omega_0}{2\\pi} \\sum_{k=-\\infty}^{\\infty} \\lvert X(k\\Omega_0)\\rvert^2\n$$\n右侧 (RHS) 是一个无穷级数，可作为定积分的近似。令 $\\Delta\\omega = \\Omega_0$。右侧为 $\\sum_{k=-\\infty}^{\\infty} \\frac{1}{2\\pi}\\lvert X(k\\Delta\\omega)\\rvert^2 \\Delta\\omega$。这是函数 $f(\\omega) = \\frac{1}{2\\pi}\\lvert X(\\omega)\\rvert^2$ 在整个实轴上的积分的黎曼和。\n\n当 $T \\to \\infty$ 时，频率采样间隔 $\\Omega_0 = 2\\pi/T \\to 0$。在此极限下，黎曼和收敛于对应的定积分：\n$$\n\\lim_{T \\to \\infty} \\left( \\frac{\\Omega_0}{2\\pi} \\sum_{k=-\\infty}^{\\infty} \\lvert X(k\\Omega_0)\\rvert^2 \\right) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} \\lvert X(\\omega)\\rvert^2\\,d\\omega\n$$\n根据 CTFT 的帕塞瓦尔关系，该积分等于总信号能量 $\\int_{-\\infty}^{\\infty} \\lvert x(t)\\rvert^2\\,dt$。这便完成了分析论证。问题陈述中的求和 $S_{T,K}$ 是此黎曼和的截断版本，预期它将近似于总信号能量。\n\n**第三部分：数值方案**\n\n数值任务是计算绝对误差 $E_{T,K} = \\left\\lvert S_{T,K}-E_x\\right\\rvert$，其中 $E_x = 1/a$ 且\n$$\nS_{T,K}=\\frac{\\Omega_{0}}{2\\pi}\\sum_{k=-K}^{K} \\left\\lvert X(k\\Omega_{0})\\right\\rvert^{2}\n$$\n代入 $\\Omega_0 = 2\\pi/T$ 和 $\\lvert X(\\omega)\\rvert^2 = \\frac{4a^2}{(a^2 + \\omega^2)^2}$：\n$$\nS_{T,K} = \\frac{1}{T}\\sum_{k=-K}^{K} \\frac{4a^2}{\\left(a^2 + (k\\frac{2\\pi}{T})^2\\right)^2}\n$$\n程序将为每组给定的参数 $(a, T, K)$ 实现此公式，计算精确能量 $E_x = 1/a$，并求出绝对差值。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the absolute error between the exact energy of a signal and its\n    approximation via a truncated Riemann sum of its power spectral density.\n    \"\"\"\n    # Test suite: (a, T, K)\n    test_cases = [\n        (1.0, 40.0, 500),\n        (1.0, 4.0, 500),\n        (0.2, 80.0, 1000),\n        (5.0, 6.0, 80),\n        (1.0, 40.0, 50)\n    ]\n\n    results = []\n\n    for a, T, K in test_cases:\n        # Analytically derived exact energy of the signal x(t) = exp(-a*|t|)\n        # E_x = integral from -inf to inf of |x(t)|^2 dt = 1/a\n        exact_energy = 1.0 / a\n\n        # Fundamental angular frequency for the frequency-domain sampling\n        Omega0 = 2.0 * np.pi / T\n\n        # The term |X(omega)|^2, where X(omega) is the CTFT of x(t)\n        # |X(omega)|^2 = (2a / (a^2 + omega^2))^2 = 4a^2 / (a^2 + omega^2)^2\n        def x_spectrum_sq(omega, a_val):\n            return (4.0 * a_val**2) / (a_val**2 + omega**2)**2\n\n        # Compute the truncated Riemann sum S_T,K\n        # S_T,K = (Omega0 / (2*pi)) * sum_{k=-K to K} |X(k*Omega0)|^2\n        # Since Omega0 / (2*pi) = 1/T, this simplifies to:\n        # S_T,K = (1/T) * sum_{k=-K to K} |X(k*Omega0)|^2\n        \n        sum_val = 0.0\n        for k in range(-K, K + 1):\n            omega_k = k * Omega0\n            sum_val += x_spectrum_sq(omega_k, a)\n\n        s_tk = (1.0 / T) * sum_val\n\n        # Calculate the absolute error\n        error = np.abs(s_tk - exact_energy)\n        results.append(error)\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2889897"}]}