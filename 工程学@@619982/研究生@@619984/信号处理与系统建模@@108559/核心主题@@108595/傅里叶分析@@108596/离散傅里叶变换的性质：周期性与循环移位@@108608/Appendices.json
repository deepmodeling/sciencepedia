{"hands_on_practices": [{"introduction": "要想真正掌握循环移位特性，我们从最基本的信号——单位冲激信号入手。通过分析一个移位冲激信号的离散傅里叶变换（DFT），我们可以直接观察到时域上的移位如何转化为频域中的线性相位变化。这个练习 [@problem_id:2896576] 以其最纯粹的形式展示了这一核心原理，并帮助我们建立关于时间与频率关系的直观理解。", "problem": "设 $N \\in \\mathbb{Z}_{\\ge 2}$，且 $x[n]$ 是一个定义在索引集 $\\{0,1,\\dots,N-1\\}$ 上的 $N$ 点离散时间序列，其表达式为 $x[n]=\\delta[n-n_{0}]$，其中整数位移 $n_{0}$ 满足 $0 \\le n_{0} < N$，$\\delta[\\cdot]$ 表示克罗内克 delta 函数。考虑 $N$ 点离散傅里叶变换 (DFT)，其对 $k \\in \\{0,1,\\dots,N-1\\}$ 的定义如下：\n$$\nX[k] \\triangleq \\sum_{n=0}^{N-1} x[n] \\exp\\!\\left(-\\mathrm{j}\\,\\frac{2\\pi}{N}\\,kn\\right).\n$$\n所有角度均以弧度为单位。\n\n任务：\n- 仅从给定的 DFT 定义和克罗内克 delta 函数的定义性质出发，推导 $X[k]$。\n- 使用你推导出的 $X[k]$，解析地证明其幅值 $|X[k]|$ 与 $k$ 无关，并解释这种在均匀间隔的频率样本 $k \\mapsto \\frac{2\\pi}{N}k$ 上的恒定性如何反映了（与离散时间傅里叶变换 (DTFT) 相比）$k$ 的周期性以及 DFT 采样的均匀性。\n- 定义标量诊断量\n$$\nQ(N,n_{0}) \\triangleq \\frac{1}{N}\\sum_{k=0}^{N-1} |X[k]|^{2}.\n$$\n计算 $Q(N,n_{0})$ 的精确闭式解。仅报告 $Q(N,n_{0})$ 的值作为最终答案。无需四舍五入，不涉及单位。", "solution": "所述问题定义明确且科学上无误，可以进行严格的推导。\n\n第一个任务是为给定序列 $x[n]$ 推导其离散傅里叶变换 (DFT) $X[k]$。该 $N$ 点序列定义为 $x[n] = \\delta[n-n_0]$，其中 $n \\in \\{0, 1, \\dots, N-1\\}$，$\\delta[\\cdot]$ 是克罗内克 delta 函数，且整数 $n_0$ 满足 $0 \\le n_0 < N$。DFT 的定义如下：\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi}{N}\\,kn\\right)\n$$\n代入 $x[n]$ 的表达式可得：\n$$\nX[k] = \\sum_{n=0}^{N-1} \\delta[n-n_0] \\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi}{N}\\,kn\\right)\n$$\n根据克罗内克 delta 函数的筛选性质，该求和的计算结果为函数 $\\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi}{N}\\,kn\\right)$ 在 delta 函数的自变量为零的索引处（即 $n=n_0$）的值。由于 $n_0$ 位于求和范围 $[0, N-1]$ 内，该求和简化为单项：\n$$\nX[k] = \\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi}{N}\\,kn_0\\right)\n$$\n此表达式对所有 $k \\in \\{0, 1, \\dots, N-1\\}$ 均有效。\n\n第二个任务是分析幅值 $|X[k]|$ 及其含义。对于任意实数自变量 $\\theta$，复指数 $\\exp(\\mathrm{j}\\theta)$ 的幅值为 $1$。此处，自变量为 $-\\frac{2\\pi}{N}kn_0$，它是一个实数。因此，$X[k]$ 的幅值为：\n$$\n|X[k]| = \\left|\\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi}{N}\\,kn_0\\right)\\right| = 1\n$$\n此结果表明，对于所有频率索引 $k$，幅值 $|X[k]|$ 均等于 $1$，这意味着它与 $k$ 无关。这种恒定性反映了其基本性质。DFT $X[k]$ 在 $k$ 上具有以 $N$ 为周期的内在周期性，而常数函数天然满足此性质。此外，DFT 提供了离散时间傅里叶变换 (DTFT) $X(\\omega) = \\sum_{n=-\\infty}^{\\infty} x[n] \\exp(-\\mathrm{j}\\omega n)$ 的均匀间隔样本。对于 $x[n]=\\delta[n-n_0]$，其 DTFT 为 $X(\\omega) = \\exp(-\\mathrm{j}\\omega n_0)$，它对于所有连续频率 $\\omega$ 都具有恒定的幅值 $|X(\\omega)| = 1$。DFT 在 $\\omega_k = \\frac{2\\pi}{N}k$ 处对这个连续谱进行采样。一个平坦的连续谱在被均匀采样时，必然会产生一个恒定值的序列。因此，$|X[k]|=1$ 是预期的结果。\n\n第三个任务是计算标量诊断量 $Q(N, n_0)$，其定义为：\n$$\nQ(N, n_0) \\triangleq \\frac{1}{N}\\sum_{k=0}^{N-1} |X[k]|^2\n$$\n使用 $|X[k]|=1$ 的结果，我们将其代入定义中：\n$$\nQ(N, n_0) = \\frac{1}{N}\\sum_{k=0}^{N-1} (1)^2 = \\frac{1}{N}\\sum_{k=0}^{N-1} 1\n$$\n求和 $\\sum_{k=0}^{N-1} 1$ 包含 $N$ 个项，每一项的值都为 $1$。因此，该和等于 $N$。\n$$\nQ(N, n_0) = \\frac{1}{N} \\cdot N = 1\n$$\n这个结果也是 DFT 的帕塞瓦尔定理的一个直接推论，该定理指出 $\\frac{1}{N}\\sum_{k=0}^{N-1} |X[k]|^2 = \\sum_{n=0}^{N-1} |x[n]|^2$。等式左边即为 $Q(N, n_0)$。等式右边是信号的能量：\n$$\n\\sum_{n=0}^{N-1} |x[n]|^2 = \\sum_{n=0}^{N-1} |\\delta[n-n_0]|^2 = \\sum_{n=0}^{N-1} \\delta[n-n_0] = 1\n$$\n两种方法都证实 $Q(N, n_0)$ 的精确值为 $1$。最终答案即为此值。", "answer": "$$\\boxed{1}$$", "id": "2896576"}, {"introduction": "在接下来的练习中，理论知识将与实际应用相碰撞。在将数学公式转化为代码时，差一错误（off-by-one error）是一个常见的陷阱，尤其是在处理不同的索引约定（例如，从 $0$ 开始与从 $1$ 开始）时。这个问题 [@problem_id:2896564] 提出了一个真实场景，其中错误的循环移位实现导致了可预测的误差，它将挑战你通过将有缺陷的时域操作与其在频域中的特征联系起来，来诊断问题所在。", "problem": "一个团队正在离散傅里叶变换 (DFT) 的背景下对循环时移进行建模。设一个 $N$ 点离散时间序列表示为 $x[n]$，其中 $n \\in \\{0,1,\\ldots,N-1\\}$，其离散傅里叶变换 (DFT) 定义为\n$$\nX[k] \\triangleq \\sum_{n=0}^{N-1} x[n] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn\\right), \\quad k \\in \\{0,1,\\ldots,N-1\\}.\n$$\n一个期望的、移动 $n_{0}$ 个样本的循环右移，在基于0的索引中由下式指定\n$$\ny[n] \\triangleq x\\big((n - n_{0}) \\bmod N\\big).\n$$\n然而，实现团队使用基于1的索引 $m \\in \\{1,2,\\ldots,N\\}$ 进行数组访问，并非正式地将上述规则“转换”为\n$$\ny_{\\mathrm{wrong}}[m] \\triangleq x\\Big(\\big((m - n_{0}) \\bmod N\\big) + 1\\Big),\n$$\n其中 $\\bmod$ 运算符返回 $\\{0,1,\\ldots,N-1\\}$ 范围内的值，而最后的 $+1$ 旨在映射到基于1的数组索引。他们声称这实现了相同的、$n_{0}$ 个样本的循环右移。\n\n1. 仅使用循环位移、DFT 以及索引集 $\\{0,1,\\ldots,N-1\\}$ 上的模运算的定义，证明当回到基于0的索引下观察时，上述规则实际上实现了一个不同的循环位移，并将该实现的位移明确写为 $y_{\\mathrm{wrong}}[n] = x\\big((n - \\tilde{n}_{0}) \\bmod N\\big)$ 的形式，其中 $\\tilde{n}_{0}$ 用 $n_{0}$ 表示。\n\n2. 令 $Y[k]$ 和 $Y_{\\mathrm{wrong}}[k]$ 分别表示 $y[n]$ 和 $y_{\\mathrm{wrong}}[n]$ 的 DFT，其计算使用与 $X[k]$ 相同的 DFT 定义。从第一性原理出发，推导精确的乘性差异因子\n$$\nR(k) \\triangleq \\frac{Y_{\\mathrm{wrong}}[k]}{Y[k]}\n$$\n并将其表示为一个仅含 $k$ 和 $N$ 的、与具体 $x[n]$ 无关的闭合形式符号表达式。\n\n为了具体说明这种差一错误的影响，考虑具体索引值 $N=7$，$n_{0}=4$ 和 $m=1$。在团队的规则下，计算 $x(\\cdot)$ 内部的源索引，并将其与正确转换的基于1的规则 $y[m] = x\\big(((m-1 - n_{0}) \\bmod N) + 1\\big)$ 进行比较；将此作为论证的一部分，以证明修正后模运算的合理性。你的最终答案必须仅为 $R(k)$ 的表达式。无需进行四舍五入。", "solution": "问题陈述已经过验证，被认为是科学严谨、数学上合理、适定且完整的。它提出了数字信号处理领域一个标准的、但很微妙的问题，该问题涉及离散傅里叶变换（DFT）循环位移性质的实现，并着重于因混合使用不同索引约定而引起的“差一错误”这一常见陷阱。我们现在将进行形式化的推导。\n\n按照要求，此分析分为两个主要部分。首先，我们将确定由错误规则所实现的实际循环位移。其次，我们将推导频域中的乘性差异因子。\n\n让我们建立基于0的信号索引 $n \\in \\{0, 1, \\ldots, N-1\\}$ 与基于1的数组索引 $m \\in \\{1, 2, \\ldots, N\\}$ 之间的关系。这是一个简单的偏移：$n = m - 1$，或者反过来说，$m = n + 1$。\n\n序列 $x[n]$ 进行 $n_0$ 个样本的正确循环位移定义为 $y[n] \\triangleq x \\big( (n - n_{0}) \\bmod N \\big)$。\n\n实现团队使用了一个基于1的索引 $m$ 的错误规则：\n$$\ny_{\\mathrm{wrong}}[m] \\triangleq x\\Big(\\big((m - n_{0}) \\bmod N\\big) + 1\\Big)\n$$\n问题陈述指出最后的“+1”旨在映射到基于1的数组索引。这意味着 $x(\\cdot)$ 的整个参数是一个基于1的索引。原始序列 $x[n]$ 是基于0索引的。因此，要从信号 $x[n]$ 中找到对应的值，我们必须通过减去1将基于1的索引转换为基于0的索引。基于0的源索引为 $\\left[ \\big((m - n_{0}) \\bmod N\\big) + 1 \\right] - 1 = (m - n_{0}) \\bmod N$。\n\n因此，错误移位序列的第 $m$ 个样本的值为 $x\\left[(m - n_{0}) \\bmod N\\right]$。为了将其表示为一个基于0索引的序列 $y_{\\mathrm{wrong}}[n]$，我们代入 $m = n + 1$，其中 $n$ 是与第 $m$ 个位置对应的基于0的索引。\n$$\ny_{\\mathrm{wrong}}[n] \\triangleq x\\Big( \\big((n+1) - n_{0}\\big) \\bmod N \\Big) = x\\Big( \\big(n - (n_{0}-1)\\big) \\bmod N \\Big)\n$$\n此表达式的形式为 $x\\big((n - \\tilde{n}_{0}) \\bmod N\\big)$，其中有效位移为 $\\tilde{n}_{0} \\triangleq n_{0} - 1$。所实现的规则创建了一个 $n_{0}-1$ 的循环位移，而不是 $n_{0}$。这是一个不同的位移，因为 $n_{0}-1 \\neq n_{0}$。\n\n为了用所给的例子（$N=7$, $n_{0}=4$, $m=1$）来说明这个根本性错误：\n正确转换的基于1的规则是 $y[m] = x\\big(((m-1 - n_{0}) \\bmod N) + 1\\big)$。对于 $m=1$，这给出的 $x(\\cdot)$ 内部的源索引为 $\\big(((1-1 - 4) \\bmod 7) + 1\\big) = \\big((-4 \\bmod 7) + 1\\big) = 3 + 1 = 4$。这对应于值 $x[3]$。这与 $n=0$ 时基于0的定义 $y[0] = x((0-4)\\bmod 7) = x[3]$ 是一致的。\n\n团队的错误规则是 $y_{\\mathrm{wrong}}[m] = x\\Big(\\big((m - n_{0}) \\bmod N\\big) + 1\\Big)$。对于 $m=1$，这给出的 $x(\\cdot)$ 内部的源索引为 $\\big((1 - 4) \\bmod 7\\big) + 1 = \\big(-3 \\bmod 7\\big) + 1 = 4 + 1 = 5$。这对应于值 $x[4]$。\n我们推导出的有效位移公式 $\\tilde{n}_{0} = n_{0}-1 = 4-1 = 3$ 预测了这一点。对于 $n=0$，$y_{\\mathrm{wrong}}[0] = x((0-3)\\bmod 7) = x[4]$。这个具体的例子证实了我们的分析。预期的位移是 4 个样本；实现的位移是 3 个样本。\n\n现在，我们来推导差异因子 $R(k) \\triangleq \\frac{Y_{\\mathrm{wrong}}[k]}{Y[k]}$。我们必须从第一性原理出发推导 DFT $Y[k]$ 和 $Y_{\\mathrm{wrong}}[k]$。\n\n正确移位序列 $y[n] = x\\big((n-n_{0}) \\bmod N\\big)$ 的 DFT 如下：\n$$\nY[k] \\triangleq \\sum_{n=0}^{N-1} y[n] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn\\right) = \\sum_{n=0}^{N-1} x\\big((n-n_{0}) \\bmod N\\big) \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn\\right)\n$$\n令 $p = (n-n_{0}) \\bmod N$。这意味着 $n = (p+n_{0}) \\bmod N$。当 $n$ 遍历集合 $\\{0, 1, \\ldots, N-1\\}$ 时，$p$ 也同样遍历该集合。我们可以改变求和变量：\n$$\nY[k] = \\sum_{p=0}^{N-1} x[p] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}k(p+n_{0})\\right)\n$$\n项 $\\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}k(p+n_{0})\\right)$ 可以被分离：\n$$\nY[k] = \\sum_{p=0}^{N-1} x[p] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kp\\right) \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn_{0}\\right)\n$$\n项 $\\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn_{0}\\right)$ 相对于求和变量 $p$ 是一个常数。\n$$\nY[k] = \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn_{0}\\right) \\sum_{p=0}^{N-1} x[p] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kp\\right) = X[k] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn_{0}\\right)\n$$\n\n错误移位序列 $y_{\\mathrm{wrong}}[n] = x\\big((n-(n_{0}-1)) \\bmod N\\big)$ 的 DFT 可通过相同的推理得出：\n$$\nY_{\\mathrm{wrong}}[k] \\triangleq \\sum_{n=0}^{N-1} y_{\\mathrm{wrong}}[n] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn\\right) = \\sum_{n=0}^{N-1} x\\big((n-(n_{0}-1)) \\bmod N\\big) \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn\\right)\n$$\n令 $q = (n-(n_{0}-1)) \\bmod N$。则 $n = (q+n_{0}-1) \\bmod N$。变量代换得出：\n$$\nY_{\\mathrm{wrong}}[k] = \\sum_{q=0}^{N-1} x[q] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}k(q+n_{0}-1)\\right)\n$$\n$$\nY_{\\mathrm{wrong}}[k] = \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}k(n_{0}-1)\\right) \\sum_{q=0}^{N-1} x[q] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kq\\right) = X[k] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}k(n_{0}-1)\\right)\n$$\n\n最后，我们计算比率 $R(k)$，假设 $X[k] \\neq 0$。问题要求一个与 $x[n]$ 无关的因子，这为（$X[k]$的）消去提供了理由。\n$$\nR(k) = \\frac{Y_{\\mathrm{wrong}}[k]}{Y[k]} = \\frac{X[k] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}k(n_{0}-1)\\right)}{X[k] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn_{0}\\right)}\n$$\n$$\nR(k) = \\frac{\\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn_{0}\\right) \\exp\\!\\left(\\mathrm{j}\\frac{2\\pi}{N}k\\right)}{\\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn_{0}\\right)} = \\exp\\!\\left(\\mathrm{j}\\frac{2\\pi}{N}k\\right)\n$$\n这就是所要求的乘性差异因子，它以闭合形式表示，且与 $x[n]$ 和 $n_0$ 无关。它表现为一个与频率相关的相位误差，在复平面上相当于旋转了 $k$ 个 $\\frac{2\\pi}{N}$ 弧度的增量。这等效于时域中 -1 个样本的循环位移，而这恰恰是位移量的误差（$n_0-1$ 而不是 $n_0$）。", "answer": "$$\n\\boxed{\\exp\\left(\\mathrm{j}\\frac{2\\pi k}{N}\\right)}\n$$", "id": "2896564"}, {"introduction": "在我们现有理解的基础上，现在来解决一个更高级的问题：如何从一个频谱可能包含零点的信号中估计未知的循环移位。这个场景 [@problem_id:2896545] 揭示了利用相位信息的实际局限性，因为零幅度的频率点不携带任何相位数据，这可能导致移位估计的模糊性。本练习探讨了这些挑战，并介绍了稳健的估计策略，从而在简单的属性演示与真实的信号分析之间架起一座桥梁。", "problem": "考虑一个长度为 $N$ 的实数序列 $x[n]$，其中 $N \\in \\mathbb{Z}_{>0}$，以及其长度为 $N$ 的离散傅里叶变换 (DFT) $X[k]$。此处的离散傅里叶变换 (DFT) 按常规方式定义，且 $n \\in \\{0,1,\\dots,N-1\\}$，$k \\in \\{0,1,\\dots,N-1\\}$。设 $y[n]$ 是 $x[n]$ 经过一个未知整数 $n_{0} \\in \\{0,1,\\dots,N-1\\}$ 的循环移位得到的序列，即 $y[n] = x[(n - n_{0}) \\bmod N]$，并设 $Y[k]$ 表示 $y[n]$ 的 DFT。在本问题中，您将从第一性原理出发，对 DFT 的周期性和循环移位特性进行推理，以理解 $X[k]$ 中的零点如何影响相位，以及如何仅使用具有非零幅值的频点来估计 $n_{0}$。\n\n我们使用一个具体的例子，$N = 12$ 且 $x[n] = 2 \\cos\\!\\big(2\\pi \\cdot 3 \\, n / 12\\big)$，其中 $n \\in \\{0,1,\\dots,11\\}$。\n定义 $y[n] = x[(n - n_{0}) \\bmod 12]$，其中 $n_{0} \\in \\{0,1,\\dots,11\\}$ 是一个未知的整数移位。为了一般性地考虑噪声存在下的谱估计问题，假设任何测量到的 DFT 系数都可能受到微小的、独立的、循环对称的复高斯扰动的影响，并且信噪比 (SNR) 足够高，以致于相位扰动很小。\n\n选择在此设置下所有正确的陈述。\n\nA. 在本例中，对于所有 $k \\notin \\{3,9\\}$，$X[k]$ 都恰好为零；因此在这些频点上，相位 $\\arg X[k]$ 是未定义的。经过任意 $n_{0}$ 的循环移位后，$Y[k]$ 中相同的频点仍然恰好为零，并且 $\\arg Y[k]$ 在那里也未定义。\n\nB. 仅使用两个非零谱线 $k = 3$ 和 $k = 9$，并且在没有任何关于未移位相位 $\\arg X[3]$ 和 $\\arg X[9]$ 的先验知识的情况下，无法仅从相位信息中唯一确定 $n_{0}$；至多，一种相位差法可以确定 $n_{0}$ 模 $N / \\gcd(\\Delta k, N)$ 的值，其中 $\\Delta k = |9 - 3|$。对于本例，这只能解析出 $n_{0}$ 的奇偶性。\n\nC. 一个仅使用非零幅值频点的一致策略是，在这些频点上对 $\\arg Y[k]$ 进行相位展开，并求解一个关于 $k$ 的直线的非加权最小二乘拟合。对于任意的 $x[n]$ 和任意的非零谱线支撑模式，此直线拟合估计量是无偏的。\n\nD. 在高信噪比情况下，频点 $k$ 处的相位噪声近似为零均值，其方差与 $\\lvert Y[k]\\rvert^{2}$ 成反比。此时，对 $\\lvert Y[k]\\rvert$ 高于某个阈值的索引集，使用与 $\\lvert Y[k]\\rvert^{2}$ 成正比的权重，对解缠后的 $\\arg Y[k]$ 与 $k$ 进行加权最小二乘拟合，可以得到 $n_{0}$ 的最大似然估计的一个近似。\n\nE. 如果一个完全已知的时域模板 $x[n]$ 可用，那么对于任何非零的 $x[n]$，无论 $X[k]$ 的谱零点如何，$y[n]$ 和 $x[n]$之间的循环互相关在 $n = n_{0}$ 处都有一个唯一的全局最大值。\n\n您的任务是判断哪些选项是正确的。您的推理应从 DFT 定义和循环移位性质开始，并且必须明确阐述谱零点、DFT 在 $k$ 上的周期性以及相位缠绕的作用。除了这些基本原理，不要假设任何未声明的公式。", "solution": "问题陈述具有科学依据、适定且客观。它基于数字信号处理的既定原则，特别是离散傅里叶变换 (DFT)。所有提供的信息都是自洽且一致的。因此，该问题是有效的，我将进行完整解答。\n\n以下是推导将使用的第一性原理：\n1.  长度为$N$的序列 $x[n]$ 的DFT定义为 $X[k] = \\sum_{n=0}^{N-1} x[n] e^{-j 2\\pi nk/N}$。\n2.  循环移位性质表明，如果 $y[n] = x[(n-n_0) \\bmod N]$，其DFT为 $Y[k] = X[k] e^{-j 2\\pi k n_0/N}$。\n3.  对于实值序列 $x[n]$，其DFT表现出共轭对称性：对于 $k \\in \\{1, \\dots, N-1\\}$ 有 $X[k] = X^*[N-k]$，且 $X[0]$ 和 $X[N/2]$（对于偶数 $N$）是实数。这意味着 $|X[k]| = |X[N-k]|$ 且 $\\arg X[k] = -\\arg X[N-k]$。\n\n首先，我们来分析给定的信号 $x[n]$，其中 $N=12$ 且 $x[n] = 2 \\cos(2\\pi \\cdot 3 n / 12)$。\n使用欧拉恒等式 $2 \\cos(\\theta) = e^{j\\theta} + e^{-j\\theta}$，我们可以将 $x[n]$ 写为：\n$$ x[n] = e^{j 2\\pi \\frac{3n}{12}} + e^{-j 2\\pi \\frac{3n}{12}} $$\n由于DFT是线性算子，我们可以计算每一项的DFT。复正弦信号 $e^{j 2\\pi k_0 n/N}$ 的DFT是一个经过缩放和平移的离散德尔塔函数，具体为 $\\sum_{n=0}^{N-1} e^{j 2\\pi k_0 n/N} e^{-j 2\\pi k n/N} = \\sum_{n=0}^{N-1} e^{j 2\\pi (k_0-k)n/N} = N\\delta[(k_0-k) \\bmod N]$。\n对于第一项，$k_0 = 3$。其DFT为 $12\\delta[(3-k) \\bmod 12]$，在 $k=3$ 时为12，其他情况下为0。\n对于第二项，我们可以将 $e^{-j 2\\pi \\frac{3n}{12}}$ 写为 $e^{j 2\\pi \\frac{(12-3)n}{12}} = e^{j 2\\pi \\frac{9n}{12}}$。这里，$k_0 = 9$。其DFT为 $12\\delta[(9-k)\\bmod 12]$，在 $k=9$ 时为12，其他情况下为0。\n因此，$x[n]$ 的DFT是：\n$$ X[k] = \\begin{cases} 12 & \\text{若 } k=3 \\\\ 12 & \\text{若 } k=9 \\\\ 0 & \\text{对于 } k \\in \\{0,1,2,4,5,6,7,8,10,11\\} \\end{cases} $$\n频谱 $X[k]$ 仅在 $k=3$ 和 $k=9$ 处有非零值。由于这些值是实数且为正，它们的相位是 $\\arg X[3] = 0$ 和 $\\arg X[9] = 0$。\n\n对于移位后的序列 $y[n] = x[(n-n_0) \\bmod 12]$，其DFT为 $Y[k] = X[k]e^{-j 2\\pi k n_0 / 12}$。\n幅值为 $|Y[k]| = |X[k]|$。所以，对于所有 $k \\notin \\{3, 9\\}$，$Y[k]$ 也为零。\n在非零频率处：\n$$ Y[3] = 12 e^{-j 2\\pi \\cdot 3 n_0 / 12} = 12 e^{-j \\pi n_0 / 2} $$\n$$ Y[9] = 12 e^{-j 2\\pi \\cdot 9 n_0 / 12} = 12 e^{-j 3\\pi n_0 / 2} $$\n相位是 $\\arg Y[3] = -\\pi n_0 / 2 \\pmod{2\\pi}$ 和 $\\arg Y[9] = -3\\pi n_0 / 2 \\pmod{2\\pi}$。\n\n现在我们来评估每个陈述。\n\n**A. 在本例中，对于所有 $k \\notin \\{3,9\\}$，$X[k]$ 都恰好为零；因此在这些频点上，相位 $\\arg X[k]$ 是未定义的。经过任意 $n_{0}$ 的循环移位后，$Y[k]$ 中相同的频点仍然恰好为零，并且 $\\arg Y[k]$ 在那里也未定义。**\n\n我们的推导表明，$X[k]$ 确实对于除 $k=3$ 和 $k=9$ 之外的所有 $k$ 都为零。复数 $z=0$ 可以写成 $0 \\cdot e^{j\\theta}$，其中 $\\theta$ 为任意角度，所以其相位是多值的，即未定义的。\n移位序列的DFT为 $Y[k] = X[k] e^{-j 2\\pi k n_0/N}$。如果对于某个 $k$，$X[k]=0$，那么 $Y[k] = 0 \\cdot e^{-j 2\\pi k n_0/N} = 0$。因此，$Y[k]$ 与 $X[k]$ 具有相同的零值频点。所以，相位 $\\arg Y[k]$ 在这些频点上也是未定义的。该陈述是DFT性质的直接且正确的推论。\n结论：**正确**。\n\n**B. 仅使用两个非零谱线 $k = 3$ 和 $k = 9$，并且在没有任何关于未移位相位 $\\arg X[3]$ 和 $\\arg X[9]$ 的先验知识的情况下，无法仅从相位信息中唯一确定 $n_{0}$；至多，一种相位差法可以确定 $n_{0}$ 模 $N / \\gcd(\\Delta k, N)$ 的值，其中 $\\Delta k = |9 - 3|$。对于本例，这只能解析出 $n_{0}$ 的奇偶性。**\n\n前提是我们不知道初始相位 $\\phi_X(k) = \\arg X[k]$，只知道 $x[n]$ 是实数，这意味着 $\\phi_X(9) = -\\phi_X(3) \\pmod{2\\pi}$。\n我们观测相位 $\\phi_Y(3)$ 和 $\\phi_Y(9)$。\n$\\phi_Y(k) = \\phi_X(k) - \\frac{2\\pi k n_0}{N} \\pmod{2\\pi}$。\n相位差测量 $\\Delta\\phi_Y = \\phi_Y(k_2) - \\phi_Y(k_1)$ 提供了 $\\Delta\\phi_Y = (\\phi_X(k_2) - \\phi_X(k_1)) - \\frac{2\\pi n_0 (k_2-k_1)}{N} \\pmod{2\\pi}$。\n如果 $\\phi_X$ 未知，我们可以尝试消除它。但是，这里的陈述是关于“相位差法”的经典模糊性。该方法依赖于测量相位差 $\\Delta\\phi_Y$ 来估计 $n_0$，通常假设 $\\Delta\\phi_X$ 已知（例如为零）。在这种情况下，我们测量 $\\Delta\\phi_Y \\equiv -\\frac{2\\pi n_0 \\Delta k}{N} \\pmod{2\\pi}$。由于相位是模 $2\\pi$ 的，任何使 $\\frac{2\\pi \\Delta n_0 \\Delta k}{N}$ 成为 $2\\pi$ 的整数倍的 $\\Delta n_0 = n_0' - n_0$ 都是无法区分的。\n这要求 $\\frac{\\Delta n_0 \\Delta k}{N}$ 是一个整数。最小的正整数 $\\Delta n_0$ 满足这个条件的是 $\\Delta n_0 = \\frac{N}{\\gcd(\\Delta k, N)}$。\n对于此问题，$N=12$ 且 $\\Delta k = |9-3|=6$。\n模糊度为 $\\Delta n_0 = 12/\\gcd(6,12) = 12/6 = 2$。\n所以，$n_0$ 只能在模 2 的意义下确定。这意味着我们只能确定 $n_0$ 是偶数还是奇数（其奇偶性）。因此，该陈述是正确的。\n结论：**正确**。\n\n**C. 一个仅使用非零幅值频点的一致策略是，在这些频点上对 $\\arg Y[k]$ 进行相位展开，并求解一个关于 $k$ 的直线的非加权最小二乘拟合。对于任意的 $x[n]$ 和任意的非零谱线支撑模式，此直线拟合估计量是无偏的。**\n\n移位信号的解缠相位是 $\\phi_Y(k) = \\phi_X(k) - \\frac{2\\pi n_0}{N}k$。策略是拟合一条直线 $\\hat{\\phi}(k) = c + s \\cdot k$ 到点 $(k, \\phi_Y(k))$（其中 $k$ 在支撑集内）。斜率 $s$ 是 $-\\frac{2\\pi n_0}{N}$ 的估计量。\n如果一个估计量的期望值等于真实参数值，则该估计量是无偏的。最小二乘斜率估计的期望值取决于被拟合的真实函数。这里，真实的“函数”是 $\\phi_Y(k)$。\n$E[\\hat{s}] = \\text{对 } \\phi_Y(k) \\text{ 进行最佳线性拟合的斜率}$。\n$E[\\hat{s}] = \\text{对 } (\\phi_X(k) - \\frac{2\\pi n_0}{N}k) \\text{ 进行最佳线性拟合的斜率} = (\\phi_X(k) \\text{ 的斜率}) - \\frac{2\\pi n_0}{N}$。\n得到的 $n_0$ 的估计是 $\\hat{n}_0 = -\\frac{N}{2\\pi}\\hat{s}$。其期望值为 $E[\\hat{n}_0] = -\\frac{N}{2\\pi}E[\\hat{s}] = n_0 - \\frac{N}{2\\pi}(\\phi_X(k) \\text{ 的斜率})$。\n当且仅当初始相位谱 $\\phi_X(k)$ 在支撑集上的最佳线性拟合的斜率为零时，该估计量才是无偏的。对于一个“任意的 $x[n]$”，其相位谱 $\\phi_X(k)$ 不保证是常数或具有零线性趋势。例如，如果 $x[n]$ 本身就是一个移位信号，例如 $x[n]=\\delta[n-1]$，其相位谱 $\\phi_X(k) = -2\\pi k/N$ 是一条直线。那么估计量就会因为这个固有的斜率而产生偏差。 因此，该估计量对任意 $x[n]$ 都是无偏的这一陈述是错误的。\n结论：**不正确**。\n\n**D. 在高信噪比情况下，频点 $k$ 处的相位噪声近似为零均值，其方差与 $\\lvert Y[k]\\rvert^{2}$ 成反比。此时，对 $\\lvert Y[k]\\rvert$ 高于某个阈值的索引集，使用与 $\\lvert Y[k]\\rvert^{2}$ 成正比的权重，对解缠后的 $\\arg Y[k]$ 与 $k$ 进行加权最小二乘拟合，可以得到 $n_{0}$ 的最大似然估计的一个近似。**\n\n在DFT上存在加性循环对称复高斯噪声 $W[k]$ 时，测量到的DFT为 $\\tilde{Y}[k] = Y[k]+W[k]$。对于高信噪比，$|Y[k]| \\gg |W[k]|$，$\\tilde{Y}[k]$ 的相位近似为 $\\phi_Y(k) + \\frac{\\text{Im}(W[k]e^{-j\\phi_Y(k)})}{|Y[k]|}$。该相位噪声近似为高斯分布、零均值，其方差为 $\\text{Var}(\\Delta\\phi_k) \\approx \\frac{\\text{Var}(\\text{噪声分量})}{|Y[k]|^2}$。因此，相位噪声方差与 $|Y[k]|^2$ 成反比的前提是正确的。\n我们想从模型 $\\phi_Y(k) = \\phi_X(k) - \\frac{2\\pi n_0}{N}k + \\text{noise}_k$ 中估计 $n_0$。这是一个线性回归问题。如果噪声是高斯的并且在各个频点 $k$ 上独立，那么最大似然估计(MLE)会最小化加权残差的平方和：$\\sum_k w_k (\\text{observation}_k - \\text{model}_k)^2$。最佳权重 $w_k$ 是每个频点处噪声方差的倒数，$w_k = 1/\\sigma_k^2$。\n给定 $\\sigma_k^2 \\propto 1/|Y[k]|^2$，最优权重为 $w_k \\propto |Y[k]|^2$。所描述的程序——使用与 $|Y[k]|^2$ 成正比的权重进行加权最小二乘拟合——在这些假设下确实是最大似然估计的近似。它被称为“近似”，因为噪声模型本身是高信噪比下的一个近似，而且因为拟合一条简单的直线将 $\\phi_X(k)$ 建模为一个常数，这可能不成立。阈值处理是确保高信噪比假设成立的一个实际步骤。该陈述是对一个稳健的统计估计过程的正确描述。\n结论：**正确**。\n\n**E. 如果一个完全已知的时域模板 $x[n]$ 可用，那么对于任何非零的 $x[n]$，无论 $X[k]$ 的谱零点如何，$y[n]$ 和 $x[n]$之间的循环互相关在 $n = n_{0}$ 处都有一个唯一的全局最大值。**\n\n循环互相关是 $r_{yx}[m] = \\sum_{n=0}^{N-1} y[n] x^*[(n-m)\\bmod N]$。根据相关定理，其DFT为 $R_{yx}[k] = Y[k]X^*[k]$。\n代入 $Y[k] = X[k]e^{-j 2\\pi k n_0/N}$，我们得到 $R_{yx}[k] = |X[k]|^2 e^{-j 2\\pi k n_0/N}$。\n逆DFT得到 $r_{yx}[m]$。设 $p[m] = \\text{IDFT}\\{|X[k]|^2\\}$。这个 $p[m]$ 是 $x[n]$ 的循环自相关。根据移位性质，$r_{yx}[m] = p[(m-n_0)\\bmod N]$。\n根据柯西-施瓦茨不等式：$|p[m]| \\le p[0]$，自相关 $p[m]$ 在 $m=0$ 处达到其最大值。因此，当 $(m-n_0)\\bmod N = 0$ 时，即在 $m=n_0$ 处，$r_{yx}[m]$ 达到其最大值。\n问题是这个最大值是否唯一。当且仅当序列 $x[(n-m)\\bmod N]$ 是 $x[n]$ 的标量倍数时，等式 $|p[m]| = p[0]$ 成立。如果 $x[n]$ 是周期性的，其周期 $P$ 能整除 $N$，那么对于所有 $n$ 都有 $x[n] = x[(n-P)\\bmod N]$。在这种情况下，$p[P] = p[0]$，自相关的最大值不是唯一的。因此，互相关 $r_{yx}[m]$ 的最大值将出现在 $m=n_0, (n_0+P)\\bmod N$ 等处，并且不是唯一的。\n本问题中的特定信号 $x[n] = 2\\cos(\\pi n/2)$ 是周期性的，周期为 $P=4$。由于 $N=12$ 是4的倍数，其自相关函数将在延迟 $m=0, 4, 8$ 处有相同的最大值。因此，互相关不会有唯一的最大值。所以，“对于任何非零的 $x[n]$”这一陈述是错误的。一个反例就是问题设置中提供的信号本身。\n结论：**不正确**。", "answer": "$$\\boxed{ABD}$$", "id": "2896545"}]}