{"hands_on_practices": [{"introduction": "Z变换的一个核心原则是，一个有理函数 $X(z)$ 并不能唯一地确定一个时域序列 $x[n]$。这种模糊性通过指定收敛域（ROC）来解决。这个练习 [@problem_id:2906629] 将引导您计算给定 $X(z)$ 的所有可能的逆变换，从而具体地展示收敛域的几何形状与所得序列的单边或双边特性之间的直接关系。", "problem": "考虑一个未知序列 $x[n]$ 的双边离散时间 $z$ 变换 $X(z)$，其中\n$$\nX(z) \\;=\\; \\frac{z}{\\left(z - 0.5\\right)\\left(z - 2\\right)}.\n$$\n从双边 $z$ 变换的定义和几何级数展开式出发，确定 $X(z)$ 的所有可能收敛域 (ROC)，并对每个 ROC，通过将 $X(z)$ 表示为一阶项之和并进行适当展开，计算其逆 $z$ 变换 $x[n]$。对于每个 ROC，识别 $x[n]$ 是右边序列、左边序列还是双边序列，并从第一性原理出发证明你的分类。在你的推理中，必须明确地仅使用核心定义和几何级数恒等式，而不能将变换对作为已知事实来假设。\n\n令 $u[n]$ 表示单位阶跃序列，定义为当 $n \\ge 0$ 时 $u[n] = 1$，当 $n < 0$ 时 $u[n] = 0$。你的最终答案必须仅包含与三种可能的 ROC 情况相对应的 $x[n]$ 的三个闭合形式表达式，并按以下顺序排列：\n- 第一个为 $\\lvert z \\rvert > 2$ 的情况，\n- 第二个为 $0.5 < \\lvert z \\rvert < 2$ 的情况，\n- 第三个为 $\\lvert z \\rvert < 0.5$ 的情况。\n\n使用 $\\mathrm{pmatrix}$ 环境将这三个结果合并为一个单行矩阵，严格按照该顺序。不需要进行数值近似或四舍五入。", "solution": "该问题具有科学依据，提法明确，并基于离散时间信号处理的既定原则。这是 $z$ 变换理论中的一个典型练习。我们将给出一个完整的、有理有据的解答。\n\n离散时间序列 $x[n]$ 的双边 $z$ 变换由洛朗级数定义：\n$$X(z) = \\sum_{n=-\\infty}^{\\infty} x[n] z^{-n}$$\n使该求和收敛的所有 $z$ 值的集合被称为收敛域 (ROC)。给定的变换为：\n$$X(z) = \\frac{z}{(z - 0.5)(z - 2)}$$\n$X(z)$ 的极点是分母的根，即 $z_1 = 0.5$ 和 $z_2 = 2$。收敛域 ROC 是复平面上的一个环形区域，其边界为半径由极点模长给出的圆。ROC 不能包含任何极点。因此，位于 $|z|=0.5$ 和 $|z|=2$ 的两个极点定义了三种可能的 ROC：\n1. 外部区域：$|z| > 2$。\n2. 环形区域：$0.5 < |z| < 2$。\n3. 内部区域：$|z| < 0.5$。注意，由于 $z$ 变换是洛朗级数，严格来说 ROC 不能包含 $z=0$，除非 $x[n]$ 仅在 $n \\ge 0$ 时非零且变换没有极点，但这里情况并非如此。我们将此 ROC 理解为 $0 < |z| < 0.5$。\n\n为求出每种情况下的逆变换，我们首先对 $X(z)$ 进行部分分式展开。标准做法是展开 $X(z)/z$：\n$$\\frac{X(z)}{z} = \\frac{1}{(z - 0.5)(z - 2)} = \\frac{A}{z - 0.5} + \\frac{B}{z - 2}$$\n系数 $A$ 和 $B$ 用留数法求得：\n$$A = \\lim_{z \\to 0.5} (z - 0.5) \\frac{1}{(z - 0.5)(z - 2)} = \\frac{1}{0.5 - 2} = \\frac{1}{-1.5} = -\\frac{2}{3}$$\n$$B = \\lim_{z \\to 2} (z - 2) \\frac{1}{(z - 0.5)(z - 2)} = \\frac{1}{2 - 0.5} = \\frac{1}{1.5} = \\frac{2}{3}$$\n两边乘以 $z$ 得到 $X(z)$ 的展开式：\n$$X(z) = -\\frac{2}{3} \\frac{z}{z - 0.5} + \\frac{2}{3} \\frac{z}{z - 2}$$\n为便于使用几何级数恒等式，我们将每一项重写为 $z^{-1}$ 的函数：\n$$X(z) = -\\frac{2}{3} \\frac{1}{1 - 0.5z^{-1}} + \\frac{2}{3} \\frac{1}{1 - 2z^{-1}}$$\n令 $X_1(z) = -\\frac{2}{3} \\frac{1}{1 - 0.5z^{-1}}$ 和 $X_2(z) = \\frac{2}{3} \\frac{1}{1 - 2z^{-1}}$。\n\n求逆过程依赖于几何级数的两种展开形式，这导致一阶项 $\\frac{1}{1-az^{-1}}$ 有两种不同的逆变换。\n1.  **右边序列**：使用恒等式 $\\sum_{n=0}^{\\infty} r^n = \\frac{1}{1-r}$ (对于 $|r|<1$）。令 $r=az^{-1}$。收敛要求 $|az^{-1}| < 1$，即 $|z| > |a|$。\n    $$ \\frac{1}{1-az^{-1}} = \\sum_{n=0}^{\\infty} (az^{-1})^n = \\sum_{n=0}^{\\infty} a^n z^{-n} $$\n    通过与 $z$ 变换定义进行比较，我们确定对应的序列为 $a^n u[n]$。\n2.  **左边序列**：对于 $|z| < |a|$ 的情况，我们重写该项：\n    $$ \\frac{1}{1-az^{-1}} = \\frac{-1}{az^{-1}-1} = \\frac{-1}{az^{-1}(1-a^{-1}z)} = -a^{-1}z \\frac{1}{1-a^{-1}z} $$\n    因为 $|a^{-1}z| < 1$，我们可以将该分式展开为几何级数。\n    $$ -a^{-1}z \\sum_{k=0}^{\\infty} (a^{-1}z)^k = -\\sum_{k=0}^{\\infty} a^{-k-1} z^{k+1} $$\n    令 $n = -(k+1)$。当 $k$ 从 $0$ 取值到 $\\infty$ 时，$n$ 从 $-1$ 取值到 $-\\infty$。\n    $$ -\\sum_{n=-1}^{-\\infty} a^{n} z^{-n} = \\sum_{n=-\\infty}^{-1} (-a^n) z^{-n} $$\n    对应的序列为 $-a^n u[-n-1]$。\n\n现在我们将这些原应用于每种 ROC。\n\n**情况 1：ROC 为 $|z| > 2$**\n该 ROC 位于两个极点的外部，即 $|z| > 2$ 且 $|z| > 0.5$。因此，$X_1(z)$ 和 $X_2(z)$ 两项都对应于右边序列。\n- 对于 $X_1(z)$，其中 $a=0.5$，ROC 为 $|z|>2$（它是 $|z|>0.5$ 的子集），其逆变换为：\n  $$x_1[n] = -\\frac{2}{3} (0.5)^n u[n]$$\n- 对于 $X_2(z)$，其中 $a=2$，ROC 为 $|z|>2$，其逆变换为：\n  $$x_2[n] = \\frac{2}{3} (2)^n u[n]$$\n总序列为 $x[n] = x_1[n] + x_2[n]$：\n$$x[n] = \\left( \\frac{2}{3} (2)^n - \\frac{2}{3} (0.5)^n \\right) u[n]$$\n**分类**：该序列对于所有 $n < 0$ 均为零。根据定义，这是一个**右边**序列。\n\n**情况 2：ROC 为 $0.5 < |z| < 2$**\n该 ROC 位于极点 $z=0.5$ 的外部，但位于极点 $z=2$ 的内部。\n- 对于 $X_1(z)$，其中 $a=0.5$，ROC 为 $|z|>0.5$，我们使用右边序列的逆变换：\n  $$x_1[n] = -\\frac{2}{3} (0.5)^n u[n]$$\n- 对于 $X_2(z)$，其中 $a=2$，ROC 为 $|z|<2$，我们使用左边序列的逆变换：\n  $$x_2[n] = \\frac{2}{3} \\left( -(2)^n u[-n-1] \\right) = -\\frac{2}{3} (2)^n u[-n-1]$$\n总序列为 $x[n] = x_1[n] + x_2[n]$：\n$$x[n] = -\\frac{2}{3} (0.5)^n u[n] - \\frac{2}{3} (2)^n u[-n-1]$$\n**分类**：第一项在 $n \\ge 0$ 时非零，第二项在 $n \\le -1$ 时非零。该序列在正、负时间索引上均非零，延伸至 $n \\to \\infty$ 和 $n \\to -\\infty$。这是一个**双边**序列。\n\n**情况 3：ROC 为 $|z| < 0.5$**\n该 ROC 位于两个极点的内部，即 $|z| < 0.5$ 且 $|z| < 2$。因此，两项都对应于左边序列。\n- 对于 $X_1(z)$，其中 $a=0.5$，ROC 为 $|z|<0.5$，其逆变换为：\n  $$x_1[n] = -\\frac{2}{3} \\left( -(0.5)^n u[-n-1] \\right) = \\frac{2}{3} (0.5)^n u[-n-1]$$\n- 对于 $X_2(z)$，其中 $a=2$，ROC 为 $|z|<0.5$（它是 $|z|<2$ 的子集），其逆变换为：\n  $$x_2[n] = \\frac{2}{3} \\left( -(2)^n u[-n-1] \\right) = -\\frac{2}{3} (2)^n u[-n-1]$$\n总序列为 $x[n] = x_1[n] + x_2[n]$：\n$$x[n] = \\left( \\frac{2}{3} (0.5)^n - \\frac{2}{3} (2)^n \\right) u[-n-1]$$\n**分类**：该序列对于所有 $n > -1$ 均为零。根据定义，这是一个**左边**序列。\n\n根据要求，这三种可能的序列已严格地从第一性原理中推导得出。", "answer": "$$\\boxed{\\begin{pmatrix} \\left( \\frac{2}{3} (2)^n - \\frac{2}{3} (0.5)^n \\right) u[n] & -\\frac{2}{3} (0.5)^n u[n] - \\frac{2}{3} (2)^n u[-n-1] & \\left( \\frac{2}{3} (0.5)^n - \\frac{2}{3} (2)^n \\right) u[-n-1] \\end{pmatrix}}$$", "id": "2906629"}, {"introduction": "虽然分析给定的 Z 变换至关重要，但我们通常从系统的定义（例如差分方程）入手。这个练习 [@problem_id:2906555] 要求您从差分方程中推导出系统函数 $H(z)$，然后判断其因果性和稳定性的可能性。您将应用基本准则：因果性要求冲激响应为右边序列（收敛域为外部区域），而稳定性要求收敛域包含单位圆。", "problem": "考虑一个由混合阶差分方程 $y[n] + 0.4\\,y[n-2] = x[n-1]$ 所描述的离散时间线性时不变 (LTI) 系统。使用双边 $z$ 变换定义和时移特性，在零状态条件下推导由 $H(z) = \\frac{Y(z)}{X(z)}$ 定义的系统函数 $H(z)$。确定 $H(z)$ 的所有极点和零点，并列举出所有与有理 $z$ 变换相符的可能收敛域 (ROC)。仅使用收敛域、因果性（脉冲响应 $h[n]$ 仅在 $n \\ge 0$ 上非零）和有界输入有界输出 (BIBO) 稳定性（$h[n]$ 绝对可和，等价于单位圆 $|z|=1$ 包含在收敛域内）的基本定义，对每个可能的收敛域判断系统是否是因果的以及是否是稳定的。\n\n最后，令 $r$ 表示 $H(z)$ 极点的共同模值，令 $N$ 为能使系统同时具有因果性和稳定性的可能收敛域的数量。定义标量 $Q$ 为 $Q = r + N$。以闭式解析表达式的形式报告 $Q$ 的值，无需进行舍入。", "solution": "我们从序列 $x[n]$ 的双边 $z$ 变换定义开始，\n$$\nX(z) = \\sum_{n=-\\infty}^{\\infty} x[n] z^{-n},\n$$\n以及时移特性，\n$$\n\\mathcal{Z}\\{x[n-k]\\} = z^{-k} X(z),\n$$\n当求和在共同的收敛域 (ROC) 内收敛时成立。在零状态条件下，对给定差分方程的两边应用 $z$ 变换，可得\n$$\nY(z) + 0.4\\,z^{-2} Y(z) = z^{-1} X(z).\n$$\n整理各项，可得系统函数 $H(z)$ 为\n$$\nH(z) = \\frac{Y(z)}{X(z)} = \\frac{z^{-1}}{1 + 0.4\\,z^{-2}}.\n$$\n将分子和分母同乘以 $z^{2}$，得到等价的真有理形式，\n$$\nH(z) = \\frac{z}{z^{2} + 0.4}.\n$$\n\n我们从这个有理表达式中确定极点和零点。极点是分母 $z^{2} + 0.4 = 0$ 的根，即\n$$\nz = \\pm j\\sqrt{0.4} = \\pm j\\sqrt{\\frac{2}{5}} = \\pm j\\,\\frac{\\sqrt{10}}{5}.\n$$\n因此，两个极点都位于虚轴上，且具有相同的模值\n$$\nr = \\left|\\pm j\\,\\frac{\\sqrt{10}}{5}\\right| = \\frac{\\sqrt{10}}{5}.\n$$\n分子是 $z$，它在 $z = 0$ 处贡献了一个零点。\n\n接下来，我们列举可能的收敛域。对于一个具有有限个极点的有理函数 $H(z)$，其收敛域是一个由以原点为中心的圆所界定的圆环区域，且不能包含任何极点。由于两个极点的模值均为 $r$，因此存在两个典型的可能收敛域：\n1. 外部收敛域，由 $|z| > r$ 给出，该区域向外延伸至无穷大，且不包含极点。\n2. 内部收敛域，由 $|z| < r$ 给出，该区域向内延伸至原点，且不包含极点。\n\n由于两个极点都位于同一个圆 $|z| = r$ 上，所以不存在非平凡的“极点间”圆环区域，因为没有不同的内外极点半径来在它们之间形成一个严格正宽度的圆环。零点不限制收敛域，因此 $z=0$ 处的零点可以被包含在收敛域内。\n\n现在我们根据定义来判断每个收敛域的因果性和稳定性：\n- LTI 系统的因果性要求脉冲响应 $h[n]$ 是一个右边序列，即当 $n<0$ 时 $h[n]=0$。对于有理函数 $H(z)$，这对应于收敛域为 $|z| > r_{\\max}$ 的形式，也就是向外延伸至无穷大且不包含所有极点的外部收敛域。\n- 有界输入有界输出 (BIBO) 稳定性要求 $h[n]$ 绝对可和，对于有理函数 $H(z)$，这等价于单位圆 $|z|=1$ 位于收敛域内。\n\n对每个收敛域进行评估：\n1. 收敛域 $|z| > r$：因为它是一个向外延伸至无穷大且不包含极点的外部收敛域，所以它对应一个右边脉冲响应，因此系统是因果的。由于 $r = \\frac{\\sqrt{10}}{5} < 1$，单位圆 $|z|=1$ 满足 $1 > r$，因此包含在该收敛域内。故在此收敛域下，系统也是稳定的。\n2. 收敛域 $|z| < r$：这是一个向原点延伸的内部收敛域，对应一个左边脉冲响应，因此系统不是因果的。此外，由于 $r < 1$，单位圆 $|z|=1$ 不包含在 $|z| < r$ 内，因此在此收敛域下，系统是不稳定的。\n\n因此，恰好只有一个可能的收敛域（即外部收敛域 $|z| > r$）能使系统同时具有因果性和稳定性。用 $N$ 表示这类收敛域的数量，我们得到 $N=1$。共同的极点模值为 $r = \\frac{\\sqrt{10}}{5}$。所求的标量为\n$$\nQ = r + N = \\frac{\\sqrt{10}}{5} + 1.\n$$\n这已经是一个闭式表达式，无需进行舍入。", "answer": "$$\\boxed{\\frac{\\sqrt{10}}{5}+1}$$", "id": "2906555"}, {"introduction": "理想的数学模型有时会掩盖实际应用中的脆弱性。这个高级练习 [@problem_id:2906587] 通过考察一个被零点完美抵消的不稳定极点，深入探讨了结构稳定性的关键概念。您将通过解析和编程的方式，证明一个微小的扰动如何打破这种抵消，暴露出潜在的不稳定性并导致频率响应发生剧烈变化，从而揭示出稳健系统设计中的一个重要教训。", "problem": "考虑 $z$ 域中的离散时间线性时不变系统，其传递函数为 $H(z) = \\dfrac{B(z)}{A(z)}$，其中 $A(z)$ 和 $B(z)$ 是关于 $z^{-1}$ 的多项式。对于因果有理系统，收敛域 (ROC) 是最外层极点之外的区域，且系统是边界输入边界输出 (BIBO) 稳定的当且仅当单位圆包含在收敛域内。当收敛域包含单位圆时，频率响应 $H\\!\\left(e^{j\\omega}\\right)$ 通过将 $H(z)$ 在单位圆上求值来定义。\n\n本问题研究一个掩盖了不稳定极点的精确极零点对消，如何被系数的任意小扰动所破坏，以及这种扰动如何在被对消因子相位角附近，引起频率响应幅值的巨大变化。\n\n设置。固定一个类极点复数 $p = r e^{j \\omega_0}$ (其中 $r > 1$) 和一个稳定的严格因果因子 $A_s(z) = 1 - a z^{-1}$ (其中 $|a| < 1$)。定义标称传递函数\n$$\nH_0(z) \\;=\\; \\frac{(1 - p z^{-1})}{(1 - p z^{-1}) \\, A_s(z)} \\;=\\; \\frac{1}{1 - a z^{-1}},\n$$\n其中不稳定因子 $(1 - p z^{-1})$ 被精确对消。现在，通过仅扰动分子因子来破坏这种精确对消，使零点沿径向移动到 $p(1+\\varepsilon)$，同时保持其角度 $\\omega_0$ 不变，其中 $\\varepsilon$ 是一个小的实数。也即，考虑如下的扰动系统族\n$$\nH_{\\varepsilon}(z) \\;=\\; \\frac{(1 - p(1+\\varepsilon) z^{-1})}{(1 - p z^{-1}) \\, (1 - a z^{-1})},\n$$\n其中 $p = r e^{j \\omega_0}$（$r > 1$）和 $|a| < 1$ 保持不变。\n\n任务。\n\n1) 仅使用 $z$ 变换、极点/零点、因果性和通过收敛域判断 BIBO 稳定性的核心定义，从第一性原理出发论证：\n- 当 $\\varepsilon = 0$ 时，精确对消会消除位于 $z=p$ 的极点，系统简化为 $H_0(z) = 1/(1 - a z^{-1})$，若 $|a| < 1$，则该系统是 BIBO 稳定的。\n- 对于任何 $\\varepsilon \\neq 0$，分母在 $z=p$ 处仍有一个极点，且 $|p| = r > 1$，因此因果实现的收敛域为 $|z| > r$，不包含单位圆，故系统不是 BIBO 稳定的。结论：任意小的扰动 $\\varepsilon$ 都可以揭示隐藏的不稳定极点并破坏稳定性。\n\n2) 令 $C_{\\varepsilon}(\\omega)$ 表示在频率 $\\omega$ 处，扰动后与未扰动前频率响应的幅值比：\n$$\nC_{\\varepsilon}(\\omega) \\;\\triangleq\\; \\frac{\\left|H_{\\varepsilon}\\!\\left(e^{j\\omega}\\right)\\right|}{\\left|H_{0}\\!\\left(e^{j\\omega}\\right)\\right|}\n\\;=\\; \\frac{\\left|1 - p(1+\\varepsilon) e^{-j\\omega}\\right|}{\\left|1 - p e^{-j\\omega}\\right|}.\n$$\n从该定义出发，不借助任何未经证明的“快捷”公式，推导 $C_{\\varepsilon}(\\omega_0)$ 的一阶小 $\\varepsilon$ 近似，即在对消角度 $\\omega_0$（其中 $p = r e^{j\\omega_0}$）处其对 $\\varepsilon$ 的主导依赖关系。将您的近似表示为 $r$ 和 $\\varepsilon$ 的函数，保留 $\\varepsilon$ 的主导项。\n\n3) 实现与测试套件。编写一个程序，针对下方的每个测试用例，计算：\n- 一个指示因果扰动系统 BIBO 稳定性的布尔值（根据任务1的理解），\n- 您在任务2中推导的 $C_{\\varepsilon}(\\omega_0)$ 的一阶近似值，使用给定参数计算，\n- 根据上述定义公式计算的 $C_{\\varepsilon}(\\omega_0)$ 的精确值。\n\n角度使用弧度制。不涉及物理单位。测试套件包含以下四个参数集，每个指定为 $(r,\\omega_0,a,\\varepsilon)$:\n- 测试 A（一般情况）：$(1.2,\\; 1.0,\\; 0.5,\\; 10^{-3})$，\n- 测试 B（靠近单位圆的极点，微小扰动）：$(1.01,\\; 0.75,\\; 0.5,\\; 10^{-6})$，\n- 测试 C（精确对消）：$(1.1,\\; 2.3,\\; 0.3,\\; 0)$，\n- 测试 D（较大扰动，稳定部分靠近边界）：$(1.05,\\; 1.8,\\; 0.9,\\; 0.05)$。\n\n您的程序应输出一行包含所有测试用例结果的内容，格式化为列表的列表：\n- 对每个测试用例，输出一个列表 $[b,\\; s,\\; m]$，其中 $b$ 是稳定性的布尔值， $s$ 是 $C_{\\varepsilon}(\\omega_0)$ 的一阶近似值， $m$ 是 $C_{\\varepsilon}(\\omega_0)$ 的精确值。\n- 最后一行必须是包含四个测试列表的单一列表，打印为用方括号括起来的逗号分隔列表，例如：$[[b_1,s_1,m_1],[b_2,s_2,m_2],[b_3,s_3,m_3],[b_4,s_4,m_4]]$。\n\n您的推导必须仅从 $z$ 变换、因果性和收敛域的定义以及上方给出的 $C_{\\varepsilon}(\\omega)$ 定义开始。不要先验地假设任何未经证明的灵敏度公式。", "solution": "所述问题具有科学依据，提法恰当且完整。它呈现了一个关于离散时间线性时不变系统稳定性分析的典型且富有启发性的练习，重点关注了不精确极零点对消的实际后果。所有提供的信息对于严谨求解都是充分且一致的。我将开始解答。\n\n解答分为三部分，与问题陈述中定义的任务相对应。\n\n### 任务1：稳定性分析\n\n此任务要求基于系统极点的位置以及因果系统对应的收敛域 (ROC) 来分析系统的边界输入边界输出 (BIBO) 稳定性。\n\n**情况1：精确对消 ($\\varepsilon = 0$)**\n\n标称传递函数由下式给出\n$$\nH_0(z) = \\frac{(1 - p z^{-1})}{(1 - p z^{-1}) \\, A_s(z)}\n$$\n其中 $A_s(z) = 1 - a z^{-1}$。分子在 $z = p$ 处有一个零点，分母在 $z=p$ 和 $z=a$ 处有极点。在有理函数代数中，分子和分母中的公因子 $(1 - p z^{-1})$ 可以被对消。这种对消在数学上是有效的，并反映了与极点 $z=p$ 对应的模式在输出端是不可观测的这一事实。\n\n对消后，系统由降阶传递函数描述：\n$$\nH_0(z) = \\frac{1}{A_s(z)} = \\frac{1}{1 - a z^{-1}}\n$$\n这个简化后的系统在 $z=a$ 处有一个单极点。对于因果系统，ROC 是复平面上位于最外层极点外部的区域。在这里，ROC 是 $|z| > |a|$。\n\n一个离散时间 LTI 系统是 BIBO 稳定的，当且仅当其 ROC 包含单位圆，即所有满足 $|z|=1$ 的 $z$ 的集合。如果 $|a| < 1$，此条件即被满足。问题陈述中已指明 $|a| < 1$，因此单位圆确实在 ROC $|z|>|a|$ 之内。所以，当 $\\varepsilon=0$ 时，系统是 BIBO 稳定的。\n\n**情况2：扰动系统 ($\\varepsilon \\neq 0$)**\n\n扰动后的传递函数由下式给出：\n$$\nH_{\\varepsilon}(z) = \\frac{1 - p(1+\\varepsilon) z^{-1}}{(1 - p z^{-1}) \\, (1 - a z^{-1})}\n$$\n$H_{\\varepsilon}(z)$ 的极点是分母的根，即 $z=p$ 和 $z=a$。零点是分子的根，即 $z=p(1+\\varepsilon)$。由于 $\\varepsilon \\neq 0$，零点 $z=p(1+\\varepsilon)$ 与极点 $z=p$ 不同，没有发生极零点对消。\n\n因此系统有两个极点：一个在 $z=a$，一个在 $z=p$。我们已知 $|p| = r > 1$ 且 $|a|<1$。这意味着极点 $z=p$ 位于单位圆外，而极点 $z=a$ 位于单位圆内。\n\n对于因果系统，ROC 必须是位于最外层极点外部的区域。极点的模为 $|p|=r$ 和 $|a|$。由于 $r>1$ 且 $|a|<1$，最外层的极点是 $p$。因此，ROC 是 $|z| > |p| = r$。\n\n因为 $r>1$，所以 ROC $|z|>r$ 不包含单位圆 $|z|=1$。因此，该系统不是 BIBO 稳定的。\n\n**任务1的结论**\n\n对于任何非零扰动 $\\varepsilon$，无论多么小，精确的极零点对消都会被破坏。位于 $z=p$ (且 $|p|>1$) 的不稳定极点被“揭示”出来，并决定了因果实现的系统 ROC。由于此 ROC 不包含单位圆，系统变得不稳定。这表明通过对消不稳定极点获得的稳定性是结构上不稳定的；它可被任意小的参数变化所破坏。\n\n### 任务2：一阶近似的推导\n\n我们需要推导幅值比 $C_{\\varepsilon}(\\omega)$ 在特定频率 $\\omega = \\omega_0$ 处关于小 $\\varepsilon$ 的一阶近似。其定义为：\n$$\nC_{\\varepsilon}(\\omega_0) = \\frac{\\left|H_{\\varepsilon}\\!\\left(e^{j\\omega_0}\\right)\\right|}{\\left|H_{0}\\!\\left(e^{j\\omega_0}\\right)\\right|} = \\frac{\\left|1 - p(1+\\varepsilon) e^{-j\\omega_0}\\right|}{\\left|1 - p e^{-j\\omega_0}\\right|}\n$$\n极点位置定义为 $p = r e^{j \\omega_0}$。我们将此式和 $e^{-j\\omega_0}$ 代入表达式中。\n\n让我们分别分析分子和分母。\n\n**分子：**\n绝对值内的项是 $1 - p(1+\\varepsilon) e^{-j\\omega_0}$。代入 $p=re^{j\\omega_0}$：\n$$\n1 - (r e^{j\\omega_0})(1+\\varepsilon) e^{-j\\omega_0} = 1 - r(1+\\varepsilon) (e^{j\\omega_0} e^{-j\\omega_0}) = 1 - r(1+\\varepsilon)\n$$\n此表达式是纯实数。因此其幅值为 $|1 - r(1+\\varepsilon)|$。\n给定 $r > 1$ 和一个小的实数 $\\varepsilon$，量 $r(1+\\varepsilon)$ 也将大于 1。因此，$1 - r(1+\\varepsilon)$ 是负数。\n$$\n|1 - r(1+\\varepsilon)| = -(1 - r(1+\\varepsilon)) = r(1+\\varepsilon) - 1\n$$\n\n**分母：**\n绝对值内的项是 $1 - p e^{-j\\omega_0}$。代入 $p=re^{j\\omega_0}$：\n$$\n1 - (r e^{j\\omega_0}) e^{-j\\omega_0} = 1 - r (e^{j\\omega_0} e^{-j\\omega_0}) = 1 - r\n$$\n此表达式也是纯实数。其幅值为 $|1 - r|$。\n由于 $r > 1$，量 $1-r$ 是负数。\n$$\n|1 - r| = -(1 - r) = r - 1\n$$\n\n**综合结果：**\n我们现在可以写出 $C_{\\varepsilon}(\\omega_0)$ 的表达式：\n$$\nC_{\\varepsilon}(\\omega_0) = \\frac{r(1+\\varepsilon) - 1}{r - 1}\n$$\n我们可以简化这个表达式：\n$$\nC_{\\varepsilon}(\\omega_0) = \\frac{r + r\\varepsilon - 1}{r - 1} = \\frac{(r - 1) + r\\varepsilon}{r - 1} = \\frac{r-1}{r-1} + \\frac{r\\varepsilon}{r-1}\n$$\n这简化为：\n$$\nC_{\\varepsilon}(\\omega_0) = 1 + \\frac{r}{r-1}\\varepsilon\n$$\n这个表达式是关于 $\\varepsilon$ 的严格线性函数。问题要求一个一阶小 $\\varepsilon$ 近似。一个线性函数在 $\\varepsilon=0$ 点的一阶泰勒级数展开就是该函数本身。因此，推导出的公式不是一个近似，而是 $C_{\\varepsilon}(\\omega_0)$ 的精确表达式。其对 $\\varepsilon$ 的主导依赖关系由项 $\\frac{r}{r-1}\\varepsilon$ 捕获。当 $r \\to 1^+$ 时，灵敏度因子 $\\frac{r}{r-1}$ 会变得非常大，这表明当不稳定极点靠近单位圆时，系统对扰动具有极高的灵敏度。\n\n### 任务3：实现逻辑\n\n该实现将为每个测试用例 $(r, \\omega_0, a, \\varepsilon)$ 计算三个值：\n1.  **BIBO 稳定性 ($b$)**：根据任务1的分析，因果系统是 BIBO 稳定的当且仅当 $\\varepsilon = 0$。因此，布尔值 $b$ 在 $\\varepsilon = 0$ 时为 `True`，否则为 `False`。\n2.  **一阶近似值 ($s$)**：根据任务2的推导，近似值为 $s = 1 + \\frac{r}{r-1}\\varepsilon$。\n3.  **精确值 ($m$)**：如任务2所示，对于特定频率 $\\omega_0$， $C_{\\varepsilon}(\\omega_0)$ 的精确值与一阶近似值相同。因此，$m = s = 1 + \\frac{r}{r-1}\\varepsilon$。这一恒等关系将反映在代码的输出中。对于 $\\varepsilon=0$ 的特殊情况，两个公式都正确地得到 1。\n\n程序将遍历所提供的测试用例，为每个用例计算这三个值，并按列表的列表格式化输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes stability and frequency response magnitude ratio for perturbed LTI systems.\n    \"\"\"\n    # Test cases are defined as tuples (r, omega_0, a, epsilon).\n    test_cases = [\n        # Test A (general case)\n        (1.2, 1.0, 0.5, 1e-3),\n        # Test B (near-unit circle pole, tiny perturbation)\n        (1.01, 0.75, 0.5, 1e-6),\n        # Test C (exact cancellation)\n        (1.1, 2.3, 0.3, 0.0),\n        # Test D (larger perturbation, stable part near boundary)\n        (1.05, 1.8, 0.9, 0.05)\n    ]\n\n    results = []\n    for case in test_cases:\n        r, omega_0, a, epsilon = case\n        \n        # 1. Determine BIBO stability of the causal system.\n        # The system is stable iff the pole-zero cancellation is exact (epsilon = 0).\n        # For any epsilon != 0, the unstable pole at z=p with |p|=r>1 is not cancelled,\n        # making the causal system unstable.\n        is_stable = (epsilon == 0)\n\n        # 2. Calculate the first-order approximation for C_epsilon(omega_0).\n        # From the derivation, s = 1 + (r / (r - 1)) * epsilon.\n        # This formula is valid for r > 1.\n        if r = 1:\n            # This case is excluded by the problem statement (r > 1) but handled for robustness.\n            # The sensitivity factor r/(r-1) would be undefined or negative.\n            # We'll set results to NaN to indicate an issue.\n            approx_C = np.nan\n            exact_C = np.nan\n        else:\n            sensitivity_factor = r / (r - 1)\n            approx_C = 1.0 + sensitivity_factor * epsilon\n            \n            # 3. Calculate the exact value of C_epsilon(omega_0).\n            # As derived in the solution, for the specific frequency omega_0, the\n            # first-order approximation is identical to the exact value.\n            # C_exact = (r*(1+epsilon) - 1) / (r - 1)\n            # This algebraically simplifies to 1 + (r / (r-1)) * epsilon.\n            exact_C = approx_C\n\n        results.append([is_stable, approx_C, exact_C])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    print(results)\n\nsolve()\n```", "id": "2906587"}]}