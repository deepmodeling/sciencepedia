{"hands_on_practices": [{"introduction": "在 FIR 滤波器设计中，过渡带的陡峭程度和阻带衰减之间存在着根本性的权衡。凯撒窗通过单个参数 $\\beta$ 对这一权衡进行连续控制，提供了一种优雅的解决方案。本实践练习聚焦于设计过程的第一个关键步骤：使用成熟的经验公式，根据给定的衰减 $A$ 和过渡带宽 $\\Delta\\omega$ 需求，估算所需的最小滤波器阶数 $N$。掌握这一计算对于高效设计出满足性能指标的滤波器至关重要 [@problem_id:2894035]。", "problem": "一个因果、线性时不变、实系数的低通有限脉冲响应滤波器将通过加窗法使用 Kaiser 窗进行设计。其设计指标由双边过渡带宽和阻带衰减给出：过渡带宽为 $\\Delta \\omega = 0.02\\pi$ 弧度/采样点，阻带衰减为 $A = 60$ 分贝。假设波纹参数定义为 $\\delta = 10^{-A/20}$，使得通带和阻带的峰值波纹不超过 $\\delta$，并且窗的参数化遵循基于第一类零阶修正贝塞尔函数的标准 Kaiser 形式。\n\n从 Kaiser 窗的定义及其离散时间傅里叶变换的经过充分检验的渐近特性出发，这些特性关联了：\n- 可达到的阻带衰减水平（通过窗参数）与 $A$ 的关系，以及\n- 主瓣（过渡）宽度与窗长度的关系，\n\n推导出基于 Kaiser 窗的设计中常用的阶数估计公式，该公式将滤波器阶数 $N$、衰减 $A$ 和过渡带宽 $\\Delta \\omega$ 联系起来。然后，应用此估计式根据给定的指标确定该方法预测的最小整数滤波器阶数 $N$。报告满足该估计式的最小整数 $N$。除了选择满足估计式的最小整数阶数外，不需要对有效数字进行舍入。所有角度均以弧度为单位。", "solution": "在尝试任何解答之前，首先对问题陈述进行验证。\n\n首先，逐字提取给定的数据和条件：\n-   **滤波器属性**：因果、线性时不变 (LTI)、实系数、低通有限脉冲响应 (FIR)。\n-   **设计方法**：使用 Kaiser 窗的加窗法。\n-   **指标（过渡带宽）**：$\\Delta \\omega = 0.02\\pi$ 弧度/采样点。\n-   **指标（阻带衰减）**：$A = 60$ 分贝。\n-   **波纹参数定义**：$\\delta = 10^{-A/20}$。\n-   **任务**：推导出基于 Kaiser 窗的设计中常用的阶数估计公式，该公式将滤波器阶数 $N$、衰减 $A$ 和过渡带宽 $\\Delta \\omega$ 联系起来。然后，应用此估计式求出最小整数滤波器阶数 $N$。\n\n根据验证标准对问题进行评估：\n-   **科学依据**：该问题基于使用 Kaiser 窗进行数字 FIR 滤波器设计的成熟理论，这是数字信号处理中的一个标准课题。所有概念，包括阻带衰减、过渡带宽和 Kaiser 窗本身，都是基础且科学合理的。\n-   **适定性与完备性**：问题提供了确定滤波器阶数 $N$ 所需的全部指标（$A$ 和 $\\Delta\\omega$）。目标陈述清晰，所描述的关系可导出一个唯一且有意义的解。问题明确无歧义且自成体系。\n-   **客观性**：语言技术性强且精确，没有主观或非科学的断言。\n\n结论是，该问题**有效**。这是一个数字滤波器设计的标准练习。我现在将继续进行解答。\n\n使用窗函数法设计有限脉冲响应 (FIR) 滤波器，涉及将理想的无限长脉冲响应 $h_d[n]$ 截断为 $N+1$ 个采样点的有限长度，从而将滤波器阶数定义为 $N$。这种截断是通过将 $h_d[n]$ 与一个有限长度的窗函数 $w[n]$ 相乘来实现的：\n$$h[n] = h_d[n] w[n], \\quad 0 \\le n \\le N$$\n在频域中，这对应于它们各自傅里叶变换的卷积：\n$$H(e^{j\\omega}) = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} H_d(e^{j\\theta}) W(e^{j(\\omega-\\theta)}) d\\theta$$\n所得滤波器 $H(e^{j\\omega})$ 的特性关键取决于窗函数 $W(e^{j\\omega})$ 的频谱特性。具体来说：\n$1$. 阻带衰减 $A$，根据峰值波纹 $\\delta$ 定义为 $A = -20 \\log_{10}(\\delta)$，由 $W(e^{j\\omega})$ 的峰值旁瓣电平决定。较低的旁瓣电平对应较高的阻带衰减。\n$2$. 通带和阻带之间的过渡带宽 $\\Delta\\omega$ 由 $W(e^{j\\omega})$ 的主瓣宽度决定。较窄的主瓣可以实现更陡峭的过渡。\n\nKaiser 窗的定义为：\n$$w[n] = \\frac{I_0\\left(\\beta \\sqrt{1 - \\left(\\frac{2n-N}{N}\\right)^2}\\right)}{I_0(\\beta)}, \\quad 0 \\le n \\le N$$\n其中 $I_0(\\cdot)$ 是第一类零阶修正贝塞尔函数。参数 $\\beta$ 提供了主瓣宽度和旁瓣电平之间的连续权衡。增加 $\\beta$ 会降低旁瓣电平（增加衰减），但代价是增加主瓣宽度（加宽过渡带）。\n\n问题要求推导滤波器指标（$A$, $\\Delta\\omega$）与所需滤波器阶数 $N$ 之间的直接关系。这些关系并非从第一性原理推导得出，而是 J. F. Kaiser 通过大量数值模拟建立的精确经验公式。\n\n所谓的“推导”在于陈述这些经过充分检验的经验公式。\n首先，根据期望的阻带衰减 $A$ 来选择窗参数 $\\beta$。对于大于 $50$ dB 的衰减 $A$，公式为：\n$$\\beta \\approx 0.1102(A - 8.7)$$\n对于给定的 $A=60$，这将产生一个特定的 $\\beta$。\n\n其次，对于给定的 $\\beta$，滤波器阶数 $N$（或长度 $M=N+1$）与过渡带宽 $\\Delta\\omega$ 之间的关系也是凭经验确定的。然而，一个更直接的设计公式也被开发出来，它绕过了对 $\\beta$ 的显式计算。该公式直接将设计指标 $A$ 和 $\\Delta\\omega$ 与所需滤波器阶数 $N$ 联系起来。这就是问题所要求的“常用阶数估计式”：\n$$N \\ge \\frac{A - 8}{2.285 \\Delta\\omega}$$\n在此公式中，衰减 $A$ 的单位必须是分贝 (dB)，过渡带宽 $\\Delta\\omega$ 的单位必须是弧度/采样点。该表达式将复杂的依赖关系整合为一个单一、实用的设计法则。常数 $8$ 和 $2.285$ 是通过经验得出的拟合参数。该公式为满足给定指标所需的最小滤波器阶数 $N$ 提供了一个估计值。\n\n现在，我们将此公式应用于给定的指标：\n-   阻带衰减：$A = 60$ dB。\n-   过渡带宽：$\\Delta\\omega = 0.02\\pi$ 弧度/采样点。\n\n将这些值代入阶数估计公式：\n$$N \\ge \\frac{60 - 8}{2.285 \\times (0.02\\pi)}$$\n$$N \\ge \\frac{52}{0.0457\\pi}$$\n我们计算等式右侧的数值：\n$$N \\ge \\frac{52}{0.14356636...}$$\n$$N \\ge 362.1936...$$\n由于滤波器阶数 $N$ 必须是整数，我们必须选择满足此不等式的最小整数。这可以通过对计算值向上取整得到：\n$$N_{\\text{min}} = \\lceil 362.1936... \\rceil = 363$$\n因此，根据 Kaiser 窗设计公式预测，为满足指定的衰减和过渡带宽，所需的最小整数滤波器阶数为 $363$。", "answer": "$$\\boxed{363}$$", "id": "2894035"}, {"introduction": "当通过加窗确定了滤波器的频率响应形状后，其整体增益通常需要进行归一化。本练习将深入探讨如何通过对脉冲响应系数求和来计算凯撒窗滤波器的直流（即零频率）增益，这是离散时间傅里叶变换（DTFT）定义的一个直接应用。你将进一步确定如何找到一个缩放因子以实现单位直流增益，同时不改变滤波器的线性相位特性，从而加深对滤波器时域表示和频域特性之间基本联系的理解 [@problem_id:2894065]。", "problem": "考虑一个理想的零相位离散时间低通滤波器，该滤波器是通过使用一个有限长度的Kaiser窗来截断理想冲激响应得到的。设滤波器长度为 $L = 2M+1$，其中 $M = 25$，因此索引以中心对称，即 $n \\in \\{-M,-M+1,\\dots,0,\\dots,M-1,M\\}$。理想低通冲激响应为\n$$\nh_{d}[n] = \n\\begin{cases}\n\\dfrac{\\sin(\\Omega_{c} n)}{\\pi n}, & n \\neq 0, \\\\\n\\dfrac{\\Omega_{c}}{\\pi}, & n=0,\n\\end{cases}\n$$\n其中截止弧度频率为 $\\Omega_{c} = 0.45\\pi$（弧度/样本）。对于 $|n| \\le M$，Kaiser窗定义为\n$$\nw[n] = \\dfrac{I_{0}\\!\\left(\\beta \\sqrt{1 - \\left(\\dfrac{n}{M}\\right)^{2}}\\right)}{I_{0}(\\beta)},\n$$\n而在其他情况下 $w[n]=0$。其中 $I_{0}(\\cdot)$ 表示零阶第一类修正贝塞尔函数。取 $\\beta = 5.2$。加窗后的冲激响应为 $h[n] = w[n]\\,h_{d}[n]$。\n\n从离散时间傅里叶变换（DTFT）的定义出发，并在适用情况下仅使用对称性和偶性的基本性质，确定加窗滤波器的直流（DC）增益 $H(\\exp(j\\cdot 0))$ 以及必须乘以 $h[n]$ 以在不改变线性相位的情况下强制直流增益为1的实数正比例因子 $\\alpha$。将你的最终结果表示为一个仅包含有限和与标准特殊函数的单一闭式解析表达式，并且不要对任何常数进行数值近似。你的最终答案必须是一个包含两个元素的单行矩阵 $\\big(H(\\exp(j\\cdot 0)),\\,\\alpha\\big)$，并按此顺序排列。不需要单位。角度以弧度为单位。", "solution": "该问题要求确定一个有限冲激响应（FIR）滤波器的直流（DC）增益，以及将该增益归一化为1所需的比例因子。问题陈述在科学上是合理的、适定的，并包含获得唯一解所需的所有信息。我们开始解答。\n\n离散时间信号 $h[n]$ 的频率响应由其离散时间傅里叶变换（DTFT）给出：\n$$\nH(\\exp(j\\Omega)) = \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(-j\\Omega n)\n$$\n直流增益是频率响应在零频率 $\\Omega=0$ 处的值。将 $\\Omega=0$ 代入DTFT定义可得：\n$$\nH(\\exp(j\\cdot 0)) = \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(-j\\cdot 0 \\cdot n) = \\sum_{n=-\\infty}^{\\infty} h[n]\n$$\n冲激响应 $h[n]$ 是理想冲激响应 $h_d[n]$ 与 Kaiser 窗 $w[n]$ 的乘积，即 $h[n] = w[n]h_d[n]$。滤波器长度是有限的 $L=2M+1$，所以 $h[n]$ 仅在索引 $n \\in \\{-M, -M+1, \\dots, M\\}$ 上非零。因此该求和是有限的：\n$$\nH(\\exp(j\\cdot 0)) = \\sum_{n=-M}^{M} h[n] = \\sum_{n=-M}^{M} w[n]h_d[n]\n$$\n为计算此和，我们首先考察所涉及函数的对称性质。对于 $n \\ne 0$，理想冲激响应 $h_d[n]$ 为 $h_d[n] = \\frac{\\sin(\\Omega_c n)}{\\pi n}$。对于 $n \\to -n$，我们有 $h_d[-n] = \\frac{\\sin(\\Omega_c (-n))}{\\pi (-n)} = \\frac{-\\sin(\\Omega_c n)}{-\\pi n} = h_d[n]$。该函数是偶函数。在 $n=0$ 处，它被定义为一个常数，这与偶对称性是一致的。\n\n对于 $|n| \\le M$，Kaiser窗定义为 $w[n] = \\frac{I_0(\\beta \\sqrt{1 - (n/M)^2})}{I_0(\\beta)}$。由于 $I_0(\\cdot)$ 的自变量依赖于 $n^2$，所以该窗函数也是一个偶函数：$w[-n]=w[n]$。\n\n两个偶函数的乘积是一个偶函数。因此，加窗冲激响应 $h[n] = w[n]h_d[n]$ 是偶函数，即对所有 $n$ 都有 $h[-n]=h[n]$。此性质可以简化求和：\n$$\n\\sum_{n=-M}^{M} h[n] = h[0] + \\sum_{n=1}^{M} h[n] + \\sum_{n=-M}^{-1} h[n]\n$$\n由于 $h[n]$ 是偶函数，负索引上的和等于正索引上的和：$\\sum_{n=-M}^{-1} h[n] = \\sum_{k=1}^{M} h[-k] = \\sum_{k=1}^{M} h[k]$。因此，\n$$\nH(\\exp(j\\cdot 0)) = h[0] + 2\\sum_{n=1}^{M} h[n]\n$$\n现在我们计算各项的值。$n=0$ 处的项是 $h[0] = w[0]h_d[0]$。\n$n=0$ 处的 Kaiser 窗为 $w[0] = \\frac{I_0(\\beta \\sqrt{1-(0/M)^2})}{I_0(\\beta)} = \\frac{I_0(\\beta)}{I_0(\\beta)} = 1$。\n给定的 $n=0$ 处的理想冲激响应为 $h_d[0] = \\frac{\\Omega_c}{\\pi}$。\n所以，$h[0] = 1 \\cdot \\frac{\\Omega_c}{\\pi} = \\frac{\\Omega_c}{\\pi}$。\n\n对于 $n \\in \\{1, 2, \\dots, M\\}$，冲激响应为：\n$$\nh[n] = w[n]h_d[n] = \\frac{I_0(\\beta \\sqrt{1 - (n/M)^2})}{I_0(\\beta)} \\cdot \\frac{\\sin(\\Omega_c n)}{\\pi n}\n$$\n将这些表达式代入直流增益的公式：\n$$\nH(\\exp(j\\cdot 0)) = \\frac{\\Omega_c}{\\pi} + 2\\sum_{n=1}^{M} \\left( \\frac{I_0(\\beta \\sqrt{1 - (n/M)^2})}{I_0(\\beta)} \\cdot \\frac{\\sin(\\Omega_c n)}{\\pi n} \\right)\n$$\n我们可以从求和中提出常数：\n$$\nH(\\exp(j\\cdot 0)) = \\frac{\\Omega_c}{\\pi} + \\frac{2}{\\pi I_0(\\beta)} \\sum_{n=1}^{M} \\frac{\\sin(\\Omega_c n)}{n} I_0\\left(\\beta \\sqrt{1 - \\left(\\frac{n}{M}\\right)^2}\\right)\n$$\n代入给定的参数值 $\\Omega_c=0.45\\pi$，$M=25$ 和 $\\beta=5.2$：\n$$\nH(\\exp(j\\cdot 0)) = \\frac{0.45\\pi}{\\pi} + \\frac{2}{\\pi I_0(5.2)} \\sum_{n=1}^{25} \\frac{\\sin(0.45\\pi n)}{n} I_0\\left(5.2 \\sqrt{1 - \\left(\\frac{n}{25}\\right)^2}\\right)\n$$\n$$\nH(\\exp(j\\cdot 0)) = 0.45 + \\frac{2}{\\pi I_0(5.2)} \\sum_{n=1}^{25} \\frac{\\sin(0.45\\pi n)}{n} I_0\\left(5.2 \\sqrt{1 - \\left(\\frac{n}{25}\\right)^2}\\right)\n$$\n这就是第一个要求的结果。\n\n接下来，我们必须找到实数正比例因子 $\\alpha$，使得缩放后的滤波器（其冲激响应为 $h_{\\text{new}}[n] = \\alpha h[n]$）具有单位直流增益。新滤波器的频率响应为 $H_{\\text{new}}(\\exp(j\\Omega)) = \\alpha H(\\exp(j\\Omega))$。单位直流增益的要求是 $H_{\\text{new}}(\\exp(j\\cdot 0)) = 1$。\n$$\n\\alpha H(\\exp(j\\cdot 0)) = 1 \\implies \\alpha = \\frac{1}{H(\\exp(j\\cdot 0))}\n$$\n问题陈述此缩放不能改变线性相位特性。如前所述，$h[n]$ 是一个实偶序列。因此，其DTFT $H(\\exp(j\\Omega))$ 是 $\\Omega$ 的一个纯实函数。实的频率响应对应于 $0$ 或 $\\pi$ 弧度的相位，这是广义线性相位中被称为零相位的一种特殊情况。由于 $H(\\exp(j\\cdot 0))$ 将是一个正实数（因为它是滤波器频率响应主瓣的积分），比例因子 $\\alpha$ 也将是一个正实数。用一个正实常数乘以一个实函数不会改变其相位。因此，该条件得到满足。\n\n$\\alpha$ 的表达式是我们推导出的直流增益的倒数：\n$$\n\\alpha = \\left( 0.45 + \\frac{2}{\\pi I_0(5.2)} \\sum_{n=1}^{25} \\frac{\\sin(0.45\\pi n)}{n} I_0\\left(5.2 \\sqrt{1 - \\left(\\frac{n}{25}\\right)^2}\\right) \\right)^{-1}\n$$\n这是第二个要求的结果。最终答案以一个包含直流增益和比例因子 $\\alpha$ 的行矩阵形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.45 + \\dfrac{2}{\\pi I_0(5.2)} \\displaystyle\\sum_{n=1}^{25} \\dfrac{\\sin(0.45\\pi n)}{n} I_0\\left(5.2 \\sqrt{1 - \\left(\\dfrac{n}{25}\\right)^2}\\right) & \\left( 0.45 + \\dfrac{2}{\\pi I_0(5.2)} \\displaystyle\\sum_{n=1}^{25} \\dfrac{\\sin(0.45\\pi n)}{n} I_0\\left(5.2 \\sqrt{1 - \\left(\\dfrac{n}{25}\\right)^2}\\right) \\right)^{-1} \\end{pmatrix}}\n$$", "id": "2894065"}, {"introduction": "将衰减 $A$ 与凯撒窗参数 $\\beta$ 联系起来的设计公式是强大的工具，但它们本质上是经验近似。这个高级计算实践将引导你验证这些公式的准确性，特别是对于阶数较小（即抽头数 $N$ 较少）的滤波器。通过在代码中实现设计流程，分析生成窗函数的光谱，并将实际测量的衰减与最初的目标值进行比较，你将对这些广泛使用的设计规则的优势和实际局限性有更深刻的理解 [@problem_id:2893995]。", "problem": "考虑用于有限长离散时间信号处理的凯撒窗。设窗长为 $N \\in \\mathbb{Z}_{\\ge 1}$，凯撒形状参数为 $\\beta \\in \\mathbb{R}_{\\ge 0}$。时域中的凯撒窗定义为\n$$\nw[n] = \\frac{I_0\\!\\left(\\beta\\, \\sqrt{1 - \\left(\\frac{n-\\alpha}{\\alpha}\\right)^2}\\right)}{I_0(\\beta)}, \\quad \\alpha = \\frac{N-1}{2}, \\quad n = 0,1,\\dots,N-1,\n$$\n其中 $I_0(\\cdot)$ 表示0阶第一类修正贝塞尔函数。$w[n]$ 的离散时间傅里叶变换 (DTFT) 为\n$$\nW(\\omega) = \\sum_{n=0}^{N-1} w[n]\\, e^{-j \\omega n}, \\quad \\omega \\in \\mathbb{R},\n$$\n其中角频率 $\\omega$ 以弧度表示。\n\n在标准的滤波器设计实践中，存在一个从期望的阻带衰减 $A$（以分贝为单位）到凯撒参数 $\\beta$ 的广泛使用的经验映射。假设您可以将此标准的衰减到参数的映射作为一个经过充分测试的设计准则来使用并实现它。您的任务是评估对于小的 $N$，这个 $A \\mapsto \\beta$ 映射在预测频谱幅值 $\\lvert W(\\omega)\\rvert$ 中观测到的旁瓣衰减的准确程度。\n\n从上述定义和通过补零和离散傅里叶变换 (DFT) 对DTFT进行标准数值近似出发，为每个测试用例执行以下操作：\n\n- 给定 $(N, A)$，使用凯撒窗设计中标准的经验映射由 $A$ 计算 $\\beta$。\n- 根据上述凯撒窗定义构建 $w[n]$。\n- 通过对 $w[n]$ 进行长度为 $L$ 的补零离散傅里叶变换 (DFT) 来近似计算 $[0,\\pi]$ 弧度上的 $W(\\omega)$，其中 $L$ 是一个大的2的幂次 (使用 $L = 2^{18}$)。提取非负频率样本（对应于 $[0,\\pi]$ 弧度范围内的 $\\omega$）。\n- 通过直流 (DC) 值对幅值进行归一化：$\\tilde{M}[k] = \\frac{\\lvert W(\\omega_k)\\rvert}{\\lvert W(0)\\rvert}$。\n- 通过定位 $\\tilde{M}[k]$ 在 $k > 0$ 时的第一个严格局部最小值来确定主瓣区域的结束位置（等价于，离散导数符号从负变为正的第一个索引 $k_{\\min}>0$）。如果由于离散化而未找到此类索引，则回退到将主瓣区域的结束位置定为索引 $\\lfloor 0.01 K \\rfloor$ 处，其中 $K$ 是非负频率 DFT 频点的数量。\n- 在旁瓣区域（所有严格大于主瓣结束索引的索引），计算最大旁瓣幅值 $\\max_{k>k_{\\min}} \\tilde{M}[k]$。\n- 通过以下公式将其转换为以分贝为单位的观测衰减：\n$$\nA_{\\text{obs}} = -20 \\log_{10}\\!\\left(\\max_{k>k_{\\min}} \\tilde{M}[k]\\right).\n$$\n- 报告有符号差值\n$$\n\\Delta = A_{\\text{obs}} - A,\n$$\n这样，$\\Delta > 0$ 表示观测到的旁瓣衰减比 $A \\mapsto \\beta$ 映射预测的更强（分贝值更大），而 $\\Delta < 0$ 表示其更弱。\n\n所有角度单位必须是弧度。所有分贝值照常是无量纲的。为保证数值稳定性，在计算对数时，可以根据需要在其参数上加上一个可忽略的正数常量 $\\varepsilon$，$\\varepsilon$ 的取值应足够小，以不影响所要求精度的结果。\n\n实现一个程序，为以下测试集计算 $\\Delta$，测试集以有序对 $(N,A)$ 的形式指定：\n\n- $(N,A) = (\\,7,\\,20\\,)$\n- $(N,A) = (\\,9,\\,21\\,)$\n- $(N,A) = (\\,11,\\,30\\,)$\n- $(N,A) = (\\,11,\\,60\\,)$\n- $(N,A) = (\\,15,\\,50\\,)$\n- $(N,A) = (\\,15,\\,51\\,)$\n- $(N,A) = (\\,21,\\,35\\,)$\n- $(N,A) = (\\,21,\\,80\\,)$\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，结果的顺序与上述测试集的顺序完全相同。每个数字必须是浮点值，并四舍五入到小数点后三位。例如，输出格式必须像这样的一行\n\"[r1,r2,r3,r4,r5,r6,r7,r8]\"\n其中每个 $r_i$ 是一个小数点后有三位数字的十进制字符串。", "solution": "所呈现的问题陈述是数值信号处理领域一个定义明确的练习。它要求评估凯撒窗设计的标准经验公式的准确性，特别是对于小窗长 $N$ 的情况。\n\n在进行求解之前，需要对问题进行严格的验证。\n\n**第1步：提取已知条件**\n\n- **凯撒窗定义**：\n  $$\n  w[n] = \\frac{I_0\\!\\left(\\beta\\, \\sqrt{1 - \\left(\\frac{n-\\alpha}{\\alpha}\\right)^2}\\right)}{I_0(\\beta)}, \\quad \\alpha = \\frac{N-1}{2}, \\quad n = 0,1,\\dots,N-1.\n  $$\n- **参数**：窗长 $N \\in \\mathbb{Z}_{\\ge 1}$，形状参数 $\\beta \\in \\mathbb{R}_{\\ge 0}$。\n- **函数**：$I_0(\\cdot)$ 是0阶第一类修正贝塞尔函数。\n- **DTFT定义**：$W(\\omega) = \\sum_{n=0}^{N-1} w[n]\\, e^{-j \\omega n}$。\n- **任务**：对于给定的配对 $(N, A)$，其中 $A$ 是期望的阻带衰减（以分贝为单位），计算差值 $\\Delta = A_{\\text{obs}} - A$。\n- **步骤**：\n    1.  使用标准经验映射从 $A$ 计算 $\\beta$。\n    2.  构造窗函数 $w[n]$。\n    3.  使用长度为 $L = 2^{18}$ 的补零DFT近似 $W(\\omega)$。\n    4.  归一化频谱幅值：$\\tilde{M}[k] = \\frac{\\lvert W(\\omega_k)\\rvert}{\\lvert W(0)\\rvert}$。\n    5.  在索引 $k_{\\min}$ 处确定主瓣的结束位置，定义为 $k > 0$ 的第一个严格局部最小值。\n    6.  如果未找到这样的最小值，则使用备用规则：主瓣在 $\\lfloor 0.01 K \\rfloor$ 处结束，其中 $K$ 是非负频率频点的数量。\n    7.  计算索引 $k > k_{\\min}$ 上的最大旁瓣幅值。\n    8.  计算观测衰减：$A_{\\text{obs}} = -20 \\log_{10}(\\max_{k>k_{\\min}} \\tilde{M}[k])$。\n    9.  计算差值 $\\Delta = A_{\\text{obs}} - A$。\n- **测试用例**：$(N,A) \\in \\{(\\,7,\\,20\\,), (\\,9,\\,21\\,), (\\,11,\\,30\\,), (\\,11,\\,60\\,), (\\,15,\\,50\\,), (\\,15,\\,51\\,), (\\,21,\\,35\\,), (\\,21,\\,80\\,)\\}$。\n- **输出格式**：一个单行的逗号分隔列表，包含四舍五入到三位小数的 $\\Delta$ 值，并用方括号括起来。\n\n**第2步：使用提取的已知条件进行验证**\n\n根据验证标准对问题进行评估。\n\n- **科学依据**：该问题在科学上是合理的。凯撒窗、其傅里叶变换以及衰减 $A$ 和参数 $\\beta$ 之间的经验关系是数字滤波器设计的基础概念。所提出的数值程序是进行频谱分析的标准方法。\n- **适定性**：该程序是算法性的且无歧义，对于每个输入对 $(N,A)$ 都能得出唯一的数值结果。包含用于识别主瓣的备用规则确保该算法在处理离散采样频谱时不会失败。\n- **客观性**：问题以客观的数学术语陈述，没有主观解释的余地。\n- **不完整性/矛盾**：存在一个微小的不一致。$w[n]$ 的公式包含除以 $\\alpha = (N-1)/2$。如果 $N=1$，则 $\\alpha=0$，导致除以零。问题声称适用于 $N \\in \\mathbb{Z}_{\\ge 1}$。然而，所有指定的测试用例都具有 $N \\ge 7$，此时 $\\alpha > 0$。这个微小的理论瑕疵不影响解决给定测试集的问题。问题还提到了一个从 $A$ 到 $\\beta$ 的“标准经验映射”，但没有明确说明它。这要求使用信号处理文献中已确立的公式，这在专业领域是一个可接受的隐含假设。\n\n**第3步：结论与行动**\n\n对于所提供的测试用例，该问题被判定为 **有效** 的。注意到了 $N=1$ 时存在的微小不一致，但这不影响所需的计算。我将继续进行求解。\n\n解决方案是分步实现指定的过程。\n\n**1. 从衰减 $A$ 到参数 $\\beta$ 的经验映射**\n\n用于根据期望的阻带衰减 $A$（以分贝为单位）计算凯撒窗参数 $\\beta$ 的标准经验公式是分段的：\n$$\n\\beta =\n\\begin{cases}\n0.1102 (A - 8.7) & \\text{若 } A > 50 \\\\\n0.5842 (A - 21)^{0.4} + 0.07886 (A - 21) & \\text{若 } 21 \\le A \\le 50 \\\\\n0 & \\text{若 } A < 21\n\\end{cases}\n$$\n这些公式是由 James Kaiser 推导出的近似值，旨在用于设计FIR滤波器，其准确性已知取决于其他滤波器参数，包括长度 $N$。本练习直接测试了这种依赖性。\n\n**2. 凯撒窗的生成**\n\n对于每对 $(N, A)$，我们首先使用上述公式计算 $\\beta$。然后，为 $n = 0, 1, \\dots, N-1$ 合成 $N$ 点窗序列 $w[n]$。参数 $\\alpha$ 计算为 $\\alpha = (N-1)/2$。窗函数由下式给出：\n$$\nw[n] = \\frac{I_0\\!\\left(\\beta\\, \\sqrt{1 - \\left(\\frac{n-\\alpha}{\\alpha}\\right)^2}\\right)}{I_0(\\beta)}\n$$\n函数 $I_0(x)$ 是0阶第一类修正贝塞尔函数。请注意，如果 $\\beta=0$，则公式简化。由于 $I_0(0)=1$，$w[n]$ 变为常数值 $1$，这对应于矩形窗。\n\n**3. 通过补零DFT进行频谱近似**\n\n连续频率DTFT, $W(\\omega)$，通过使用离散傅里叶变换 (DFT) 的密集样本集进行近似。将 $N$ 点序列 $w[n]$ 补零至一个更大的长度 $L = 2^{18} = 262144$。这增加了频域的采样密度，提供了频谱的高分辨率视图。DFT 计算如下：\n$$\nW[k] = \\sum_{n=0}^{L-1} w_{\\text{padded}}[n]\\, e^{-j \\frac{2\\pi}{L} nk}, \\quad k = 0, 1, \\dots, L-1\n$$\n由于时域窗 $w[n]$ 是实数值，其频谱幅值是对称的。我们只需分析非负频率分量，这些分量对应于前 $K = L/2 + 1$ 个DFT频点。频谱幅值为 $\\lvert W[k] \\rvert$，其中 $k = 0, \\dots, K-1$。\n\n**4. 归一化与旁瓣识别**\n\n频谱幅值通过其在零频率处的值（DC分量）进行归一化，该值由 $W[0] = \\sum w[n]$ 给出。归一化的频谱幅值为：\n$$\n\\tilde{M}[k] = \\frac{\\lvert W[k]\\rvert}{\\lvert W[0]\\rvert}\n$$\n窗谱的主瓣是围绕 $\\omega=0$ 的中心峰值。问题将主瓣的结束位置定义为对应于 $\\tilde{M}[k]$ 中第一个严格局部最小值的索引 $k_{\\min} > 0$。这通过搜索第一个满足 $\\tilde{M}[k_{\\min}-1] > \\tilde{M}[k_{\\min}]$ 且 $\\tilde{M}[k_{\\min}] < \\tilde{M}[k_{\\min}+1]$ 的索引 $k_{\\min} \\in \\{1, \\dots, K-2\\}$ 来找到。\n如果在离散数据中不存在这样的最小值，则使用备用索引：$k_{\\min} = \\lfloor 0.01 K \\rfloor$。旁瓣区域包含所有满足 $k > k_{\\min}$ 的索引 $k$。\n\n**5. 旁瓣衰减与误差计算**\n\n峰值旁瓣电平是旁瓣区域中归一化频谱的最大值：\n$$\nS_{\\max} = \\max_{k > k_{\\min}} \\tilde{M}[k]\n$$\n该量被转换为分贝，以找到观测衰减 $A_{\\text{obs}}$。为了数值稳定性，添加一个小的常数 $\\varepsilon$ 以避免对零取对数。\n$$\nA_{\\text{obs}} = -20 \\log_{10}(S_{\\max} + \\varepsilon)\n$$\n最后，计算观测衰减与目标衰减之间的有符号差值 $\\Delta$，为给定的 $(N, A)$ 对提供了衡量经验公式准确性的指标。\n$$\n\\Delta = A_{\\text{obs}} - A\n$$\n对所有测试用例重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import i0\n\ndef solve():\n    \"\"\"\n    Solves the Kaiser window analysis problem for a suite of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (7, 20),\n        (9, 21),\n        (11, 30),\n        (11, 60),\n        (15, 50),\n        (15, 51),\n        (21, 35),\n        (21, 80),\n    ]\n\n    # DFT length, a large power of two for high-resolution spectral analysis.\n    L = 2**18\n\n    # Small constant for numerical stability in log10.\n    EPSILON = 1e-20\n\n    results = []\n    \n    for case in test_cases:\n        N, A = case\n\n        # 1. Compute beta from A using the standard empirical mapping.\n        if A > 50:\n            beta = 0.1102 * (A - 8.7)\n        elif A >= 21:\n            beta = 0.5842 * (A - 21)**0.4 + 0.07886 * (A - 21)\n        else:\n            beta = 0.0\n        \n        # 2. Construct w[n] using the Kaiser definition.\n        # Although problem states N>=1, test cases have N>=7, so alpha is non-zero.\n        alpha = (N - 1) / 2.0\n        n = np.arange(N)\n        \n        # Handle the case N=1 separately to avoid division by zero\n        if N == 1:\n            # For N=1, alpha=0, w[0] is defined as 1.\n            w = np.array([1.0])\n        else:\n            # The argument inside the square root is guaranteed to be non-negative.\n            radicand = 1.0 - ((n - alpha) / alpha)**2\n            bessel_arg = beta * np.sqrt(radicand)\n            \n            # The denominator i0(beta) can be a large number but is constant.\n            # i0(0) = 1, so no division by zero for beta=0.\n            w = i0(bessel_arg) / i0(beta)\n\n        # 3. Approximate W(omega) with a zero-padded DFT.\n        W_k = np.fft.fft(w, L)\n\n        # We only need the non-negative frequency samples.\n        K = L // 2 + 1\n        M_k = np.abs(W_k[:K])\n        \n        # 4. Normalize the magnitude by the DC value.\n        # M_k[0] is sum(w), which is non-zero for a valid window.\n        dc_val = M_k[0]\n        if dc_val < EPSILON:\n            # This case should not be reached with valid windows.\n            # If it were, the spectrum is essentially zero everywhere.\n            M_norm = np.zeros_like(M_k)\n        else:\n            M_norm = M_k / dc_val\n\n        # 5. Identify the end of the mainlobe region.\n        # Find the first strict local minimum for k > 0.\n        # A local minimum at k occurs where the diff changes from negative to positive.\n        diff_M = np.diff(M_norm)\n        # Find indices k-1 where diff[k-1] < 0 and diff[k] > 0\n        minima_indices = np.where((diff_M[:-1] < 0) & (diff_M[1:] > 0))[0]\n\n        if len(minima_indices) > 0:\n            # The first local minimum is at index `indices[0] + 1` in M_norm\n            k_min = minima_indices[0] + 1\n        else:\n            # Fallback rule if no strict local minimum is found.\n            k_min = int(0.01 * K)\n\n        # 6. Compute the maximum sidelobe magnitude.\n        sidelobe_region = M_norm[k_min + 1:]\n        if len(sidelobe_region) == 0:\n            max_sidelobe = 0.0\n        else:\n            max_sidelobe = np.max(sidelobe_region)\n            \n        # 7. Convert to observed attenuation in decibels.\n        A_obs = -20 * np.log10(max_sidelobe + EPSILON)\n\n        # 8. Report the signed difference.\n        delta = A_obs - A\n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{r:.3f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "2893995"}]}