{"hands_on_practices": [{"introduction": "本练习从一个极其简单的系统——一个信号与其自身延迟的回波相加——入手。通过从基本定义出发分析这个模型，您将亲手揭示一个简单的时间域结构如何直接导致复杂的频率域特性，例如周期性的幅度波纹和相位跳变。这项实践旨在为您建立关于傅里叶变换如何将时间域特性映射到频率域的坚实直觉 [@problem_id:2882292]。", "problem": "考虑一个连续时间线性时不变 (LTI) 系统，其冲激响应为 $h(t)=\\delta(t)+\\alpha\\,\\delta(t-\\tau)$，其中 $\\delta(t)$ 是狄拉克 δ 函数，$\\alpha\\in\\mathbb{R}$ 且 $\\tau>0$。仅使用连续时间傅里叶变换 (CTFT) 的定义，$H(j\\omega)=\\int_{-\\infty}^{\\infty}h(t)\\,\\exp(-j\\omega t)\\,dt$，以及核心的三角恒等式（例如欧拉恒等式）来分析该系统。\n\n任务：\n1) 根据 CTFT 定义推导频率响应 $H(j\\omega)$。\n\n2) 从基本原理出发，推导幅度 $|H(j\\omega)|$ 和主值相位 $\\angle H(j\\omega)$ 作为 $\\omega$ 的函数的闭式表达式。所有角度必须以弧度为单位。\n\n3) 分析幅度波纹的特性：\n- 确定幅度响应在 $\\omega$ 上的周期。\n- 确定 $|H(j\\omega)|$ 在 $\\omega\\in\\mathbb{R}$ 上的全局最大值和最小值，以及它们出现的全套频率，用 $\\alpha$ 和 $\\tau$ 表示。\n- 给出 $|H(j\\omega)|$ 存在精确谱零点（零点）的一个充要条件，并指明相应的频率。\n\n4) 分析相位行为的特性：\n- 使用双参数反正切函数 $\\arctan2(\\cdot,\\cdot)$ 给出主值相位 $\\angle H(j\\omega)$ 的显式解析表达式。\n- 找出主值相位出现跳变（不连续点）的频率，并解释这些跳变如何依赖于 $\\alpha$ 和 $\\tau$。\n\n请清晰地给出您的推理步骤，并根据您所使用的定义和恒等式来证明每一个结论。将幅度 $|H(j\\omega)|$ 作为 $\\omega$、$\\alpha$ 和 $\\tau$ 的函数的单一闭式解析表达式作为您的最终答案。不需要进行数值计算或四舍五入。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- 系统类型：连续时间线性时不变 (LTI)。\n- 冲激响应：$h(t)=\\delta(t)+\\alpha\\,\\delta(t-\\tau)$。\n- 参数：$\\alpha\\in\\mathbb{R}$ 且 $\\tau>0$。\n- CTFT 定义：$H(j\\omega)=\\int_{-\\infty}^{\\infty}h(t)\\,\\exp(-j\\omega t)\\,dt$。\n- 要求使用的工具：CTFT 定义和核心三角恒等式。\n- 任务：\n    1. 推导频率响应 $H(j\\omega)$。\n    2. 推导幅度 $|H(j\\omega)|$ 和相位 $\\angle H(j\\omega)$ 的表达式。\n    3. 分析幅度响应的特性：周期、全局最大/最小值，以及谱零点的条件。\n    4. 分析相位响应的特性：提供 $\\arctan2$ 形式并找出不连续点的频率。\n- 最终答案要求：$|H(j\\omega)|$ 的单一闭式解析表达式。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，提法明确，且客观。它描述了一种标准的FIR滤波器结构（一条直接通路加上一个单一回声），这是信号处理中一个被称为梳状滤波器的基本模型。问题是自洽的，提供了所有必需的参数和定义（$\\alpha$、$\\tau$、CTFT 定义）。这些任务具体、逻辑结构清晰，并且可以使用系统分析中的标准数学技术来解决。该问题没有科学性错误、模糊之处或矛盾。\n\n**第3步：结论与行动**\n该问题被判定为**有效**。将推导解答。\n\n推导过程按顺序解决每个任务。\n\n**1) 频率响应 $H(j\\omega)$ 的推导**\n\n频率响应 $H(j\\omega)$ 是冲激响应 $h(t)$ 的连续时间傅里叶变换 (CTFT)。使用所给的定义：\n$$H(j\\omega) = \\int_{-\\infty}^{\\infty} h(t) \\exp(-j\\omega t) dt$$\n代入给定的冲激响应 $h(t) = \\delta(t) + \\alpha\\delta(t-\\tau)$:\n$$H(j\\omega) = \\int_{-\\infty}^{\\infty} (\\delta(t) + \\alpha\\delta(t-\\tau)) \\exp(-j\\omega t) dt$$\n根据积分的线性性质，这可以分解为两个积分：\n$$H(j\\omega) = \\int_{-\\infty}^{\\infty} \\delta(t) \\exp(-j\\omega t) dt + \\alpha \\int_{-\\infty}^{\\infty} \\delta(t-\\tau) \\exp(-j\\omega t) dt$$\n我们应用狄拉克 δ 函数的筛选特性，即 $\\int_{-\\infty}^{\\infty} f(t)\\delta(t-t_0)dt = f(t_0)$。\n对于第一个积分，函数是 $\\exp(-j\\omega t)$，δ 函数位于 $t_0=0$。这得到：\n$$\\int_{-\\infty}^{\\infty} \\delta(t) \\exp(-j\\omega t) dt = \\exp(-j\\omega \\cdot 0) = \\exp(0) = 1$$\n对于第二个积分，函数是 $\\exp(-j\\omega t)$，δ 函数位于 $t_0=\\tau$。这得到：\n$$\\alpha \\int_{-\\infty}^{\\infty} \\delta(t-\\tau) \\exp(-j\\omega t) dt = \\alpha \\exp(-j\\omega\\tau)$$\n结合这两个结果，得到频率响应：\n$$H(j\\omega) = 1 + \\alpha\\exp(-j\\omega\\tau)$$\n\n**2) 幅度 $|H(j\\omega)|$ 和相位 $\\angle H(j\\omega)$ 的推导**\n\n为了求出幅度和相位，我们首先将 $H(j\\omega)$ 表示为直角坐标形式 $X(\\omega) + jY(\\omega)$。使用欧拉恒等式 $\\exp(-j\\theta) = \\cos(\\theta) - j\\sin(\\theta)$，我们有：\n$$H(j\\omega) = 1 + \\alpha(\\cos(\\omega\\tau) - j\\sin(\\omega\\tau))$$\n$$H(j\\omega) = (1 + \\alpha\\cos(\\omega\\tau)) - j(\\alpha\\sin(\\omega\\tau))$$\n实部是 $X(\\omega) = 1 + \\alpha\\cos(\\omega\\tau)$，虚部是 $Y(\\omega) = -\\alpha\\sin(\\omega\\tau)$。\n\n幅度 $|H(j\\omega)|$ 由 $\\sqrt{X(\\omega)^2 + Y(\\omega)^2}$ 给出：\n$$|H(j\\omega)| = \\sqrt{(1 + \\alpha\\cos(\\omega\\tau))^2 + (-\\alpha\\sin(\\omega\\tau))^2}$$\n展开平方根内的各项：\n$$|H(j\\omega)| = \\sqrt{1 + 2\\alpha\\cos(\\omega\\tau) + \\alpha^2\\cos^2(\\omega\\tau) + \\alpha^2\\sin^2(\\omega\\tau)}$$\n使用基本三角恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$：\n$$|H(j\\omega)| = \\sqrt{1 + 2\\alpha\\cos(\\omega\\tau) + \\alpha^2(\\cos^2(\\omega\\tau) + \\sin^2(\\omega\\tau))}$$\n$$|H(j\\omega)| = \\sqrt{1 + 2\\alpha\\cos(\\omega\\tau) + \\alpha^2}$$\n这就是幅度的闭式表达式。\n\n主值相位 $\\angle H(j\\omega)$ 由双参数反正切函数 $\\arctan2(Y(\\omega), X(\\omega))$ 给出：\n$$\\angle H(j\\omega) = \\arctan2(-\\alpha\\sin(\\omega\\tau), 1 + \\alpha\\cos(\\omega\\tau))$$\n\n**3) 幅度波纹特性分析**\n\n- **幅度响应的周期：**\n幅度 $|H(j\\omega)| = \\sqrt{1 + \\alpha^2 + 2\\alpha\\cos(\\omega\\tau)}$ 是 $\\cos(\\omega\\tau)$ 的函数。函数 $\\cos(\\theta)$ 的周期是 $2\\pi$。因此，幅度响应在 $\\omega$ 上是周期性的。周期 $T_\\omega$ 必须满足 $\\omega\\tau + T_\\omega\\tau = \\omega\\tau + 2\\pi k$（对于某个整数 $k$）。基本周期（对于 $k=1$）由 $T_\\omega\\tau = 2\\pi$ 给出，这意味着：\n$$T_\\omega = \\frac{2\\pi}{\\tau}$$\n\n- **全局最大值和最小值：**\n$|H(j\\omega)|$ 的极值对应于其平方 $|H(j\\omega)|^2 = 1 + \\alpha^2 + 2\\alpha\\cos(\\omega\\tau)$ 的极值，因为平方根函数对于非负参数是单调递增的。极值由项 $2\\alpha\\cos(\\omega\\tau)$ 决定。\n$|H(j\\omega)|^2$ 的最大值是 $1 + \\alpha^2 + 2|\\alpha|$，等于 $(1+|\\alpha|)^2$。因此，幅度的全局最大值是 $1+|\\alpha|$。这发生在 $\\alpha\\cos(\\omega\\tau) = |\\alpha|$ 时。\n    - 如果 $\\alpha>0$，这发生在 $\\cos(\\omega\\tau)=1$ 时，所以 $\\omega\\tau=2n\\pi$，其中 $n\\in\\mathbb{Z}$。频率为：$\\omega = \\frac{2n\\pi}{\\tau}$。\n    - 如果 $\\alpha<0$，这发生在 $\\cos(\\omega\\tau)=-1$ 时，所以 $\\omega\\tau=(2n+1)\\pi$，其中 $n\\in\\mathbb{Z}$。频率为：$\\omega = \\frac{(2n+1)\\pi}{\\tau}$。\n$|H(j\\omega)|^2$ 的最小值是 $1 + \\alpha^2 - 2|\\alpha|$，等于 $(1-|\\alpha|)^2$。因此，幅度的全局最小值是 $|1-|\\alpha||$。这发生在 $\\alpha\\cos(\\omega\\tau) = -|\\alpha|$ 时。\n    - 如果 $\\alpha>0$，这发生在 $\\cos(\\omega\\tau)=-1$ 时，所以 $\\omega\\tau=(2n+1)\\pi$，其中 $n\\in\\mathbb{Z}$。频率为：$\\omega = \\frac{(2n+1)\\pi}{\\tau}$。\n    - 如果 $\\alpha<0$，这发生在 $\\cos(\\omega\\tau)=1$ 时，所以 $\\omega\\tau=2n\\pi$，其中 $n\\in\\mathbb{Z}$。频率为：$\\omega = \\frac{2n\\pi}{\\tau}$。\n\n- **谱零点：**\n精确的谱零点发生在 $|H(j\\omega)| = 0$ 时。这要求全局最小值为零：$|1-|\\alpha|| = 0$。这意味着 $|\\alpha|=1$。\n谱零点存在的充要条件是 $\\alpha=1$ 或 $\\alpha=-1$。\n    - 如果 $\\alpha=1$，零点发生在达到最小值的频率上：$\\omega = \\frac{(2n+1)\\pi}{\\tau}$，其中 $n\\in\\mathbb{Z}$。\n    - 如果 $\\alpha=-1$，零点发生在达到最小值的频率上：$\\omega = \\frac{2n\\pi}{\\tau}$，其中 $n\\in\\mathbb{Z}$。\n\n**4) 相位行为特性分析**\n\n- **相位的解析表达式：**\n如第2部分所推导，主值相位的显式解析表达式为：\n$$\\angle H(j\\omega) = \\arctan2(-\\alpha\\sin(\\omega\\tau), 1 + \\alpha\\cos(\\omega\\tau))$$\n\n- **相位不连续点（跳变）：**\n主值相位的非连续性发生在复数 $H(j\\omega)$ 穿过负实轴时。这发生在虚部为零且实部为负时。\n1. 虚部为零：$Y(\\omega) = -\\alpha\\sin(\\omega\\tau) = 0$。假设 $\\alpha \\neq 0$，这意味着 $\\sin(\\omega\\tau)=0$，这发生在 $\\omega\\tau = k\\pi$（对于任意整数 $k \\in \\mathbb{Z}$）。频率为 $\\omega_k = \\frac{k\\pi}{\\tau}$。\n2. 实部为负：$X(\\omega_k) = 1+\\alpha\\cos(\\omega_k\\tau) = 1+\\alpha\\cos(k\\pi) < 0$。由于 $\\cos(k\\pi) = (-1)^k$，条件是 $1+\\alpha(-1)^k < 0$。\n\n我们对偶数和奇数 $k$ 分析这个条件：\n- 如果 $k$ 是偶数（$k=2n$），条件变为 $1 + \\alpha < 0$，即 $\\alpha < -1$。相位跳变发生在频率 $\\omega = \\frac{2n\\pi}{\\tau}$ 处，其中 $n\\in\\mathbb{Z}$。\n- 如果 $k$ 是奇数（$k=2n+1$），条件变为 $1 - \\alpha < 0$，即 $\\alpha > 1$。相位跳变发生在频率 $\\omega = \\frac{(2n+1)\\pi}{\\tau}$ 处，其中 $n\\in\\mathbb{Z}$。\n\n在边界情况 $|\\alpha|=1$ 下，实部在这些频率上变为零，这对应于谱零点。在这些幅度为零的点上，相位是未定义的，这表现为大小为 $\\pi$ 弧度的不连续性。\n总结来说，当且仅当 $|\\alpha| \\ge 1$ 时，才会发生相位跳变。\n- 对于 $\\alpha \\ge 1$：跳变发生在 $\\omega = \\frac{(2n+1)\\pi}{\\tau}$，其中 $n\\in\\mathbb{Z}$。\n- 对于 $\\alpha \\le -1$：跳变发生在 $\\omega = \\frac{2n\\pi}{\\tau}$，其中 $n\\in\\mathbb{Z}$。\n- 对于 $|\\alpha| < 1$：没有相位不连续点。", "answer": "$$\\boxed{\\sqrt{1 + \\alpha^{2} + 2\\alpha \\cos(\\omega \\tau)}}$$", "id": "2882292"}, {"introduction": "在分析了基本系统的频率特性之后，本练习将带您进入一个实际的工程任务：设计一个数字低通滤波器。您将通过窗函数法来塑造理想的频率响应，并在此过程中证明线性相位滤波器的对称性是如何确保恒定的群延迟的。这项实践强调了在系统设计中，控制相位响应与控制幅度响应同等重要，因为它对于保持信号波形完整性至关重要 [@problem_id:2882328]。", "problem": "请通过对理想离散时间低通脉冲响应进行加窗，设计一个长度为 $N=21$ 的因果I型线性相位有限脉冲响应（FIR）低通滤波器。该滤波器应具有归一化数字截止频率 $\\omega_{c}=0.4\\pi$ 弧度/采样点。汉明窗的定义为：当 $0\\leq n\\leq N-1$ 时，$w[n]=0.54-0.46\\cos\\!\\left(\\frac{2\\pi n}{N-1}\\right)$，其他情况下为零。使用一个以 $n=0$ 为中心的、具有单位通带增益和截止频率 $\\omega_{c}$ 的非因果低通滤波器的理想脉冲响应，其定义为：当 $n\\neq 0$ 时，$h_{d}[n]=\\frac{\\sin(\\omega_{c}n)}{\\pi n}$，以及 $h_{d}[0]=\\frac{\\omega_{c}}{\\pi}$。通过将 $h_{d}[n]$ 以 $n=M$（其中 $M=\\frac{N-1}{2}$）为中心进行居中和截断，并与窗函数相乘，来构建长度为 $N$ 的因果加窗设计，即：当 $0\\leq n\\leq N-1$ 时，$h[n]=h_{d}[n-M]\\cdot w[n]$，其他情况下为零。\n\n仅从离散时间傅里叶变换（DTFT）的定义 $H\\!\\left(e^{j\\omega}\\right)=\\sum_{n=-\\infty}^{\\infty}h[n]\\,\\exp(-j\\omega n)$ 以及给定的 $h[n]$ 和 $w[n]$ 的定义出发，完成以下任务：\n\n1. 证明所得到的滤波器 $h[n]$ 关于 $n=M$ 偶对称，并因此具有形式为 $H\\!\\left(e^{j\\omega}\\right)=\\exp(-j\\omega M)\\,A(\\omega)$ 的线性相位DTFT，其中 $A(\\omega)$ 是一个实值的零相位幅度函数。\n\n2. 用 $h[n]$ 的对称系数将 $A(\\omega)$ 明确表示为一个余弦级数。将这个 $A(\\omega)$ 写成一个实数有限和的形式 $A(\\omega)=a_{0}+2\\sum_{k=1}^{M}a_{k}\\cos(\\omega k)$，其中系数 $a_{k}$ 以 $h[n]$ 的闭式形式给出。\n\n3. 使用第2项中的表示，陈述 $|H\\!\\left(e^{j\\omega}\\right)|$ 和精确相位 $\\angle H\\!\\left(e^{j\\omega}\\right)$（以弧度为单位）。您对精确相位的表达式必须说明线性项以及由 $A(\\omega)$ 的符号所隐含的任何恒定相位跳变。\n\n4. 使用您推导出的相位，确定通带群延迟 $\\tau_{g}$（以采样点为单位），其定义为 $\\tau_{g}(\\omega)=-\\frac{d}{d\\omega}\\angle H\\!\\left(e^{j\\omega}\\right)$，此定义适用于幅度响应为非负的主低频通带内。将此通带群延迟报告为单个实数，单位为采样点。\n\n您必须从DTFT定义和给定的加窗构造出发，提供清晰的推导过程，而不是引用已有的结果。所有角度量均以弧度表示。您报告的最终答案必须是通带群延迟（以采样点为单位）。无需四舍五入。", "solution": "问题陈述需经过验证。\n\n已知条件如下：\n- 一个因果线性相位FIR滤波器待设计。\n- 滤波器类型：I型，低通。\n- 滤波器长度：$N=21$。\n- 归一化数字截止频率：$\\omega_{c}=0.4\\pi$ 弧度/采样点。\n- 窗函数：汉明窗，$w[n]=0.54-0.46\\cos\\!\\left(\\frac{2\\pi n}{N-1}\\right)$，对于 $0\\leq n\\leq N-1$。\n- 理想低通脉冲响应：$h_{d}[n]=\\frac{\\sin(\\omega_{c}n)}{\\pi n}$ 对于 $n\\neq 0$，且 $h_{d}[0]=\\frac{\\omega_{c}}{\\pi}$。\n- 中心索引：$M=\\frac{N-1}{2}$。\n- 最终脉冲响应：$h[n]=h_{d}[n-M]\\cdot w[n]$，对于 $0\\leq n\\leq N-1$。\n- 离散时间傅里叶变换（DTFT）定义：$H\\!\\left(e^{j\\omega}\\right)=\\sum_{n=-\\infty}^{\\infty}h[n]\\,\\exp(-j\\omega n)$。\n- 群延迟定义：$\\tau_{g}(\\omega)=-\\frac{d}{d\\omega}\\angle H\\!\\left(e^{j\\omega}\\right)$。\n\n该问题具有科学依据，提法得当，客观且自洽。这是一个数字滤波器设计的标准练习，基于信号处理的既定原理。所有参数都已提供且一致。任务涉及从基本定义的直接应用和推导。未发现任何缺陷。问题有效。我们开始求解。\n\n中心索引为 $M = \\frac{N-1}{2} = \\frac{21-1}{2} = 10$。脉冲响应 $h[n]$ 的定义域为 $n \\in \\{0, 1, \\dots, 20\\}$。\n\n**1. 对称性与线性相位特性**\n\n首先，我们必须证明脉冲响应 $h[n]$ 关于其中心索引 $M=10$ 是偶对称的。这需要证明对于 $n \\in \\{0, 1, \\dots, 20\\}$，$h[n] = h[2M-n]$，即 $h[n]=h[20-n]$。\n\n滤波器脉冲响应由 $h[n] = h_{d}[n-M] \\cdot w[n]$ 给出。\n我们来检查其组成部分的对称性。\n\n汉明窗定义为 $w[n] = 0.54 - 0.46\\cos\\left(\\frac{2\\pi n}{N-1}\\right)$。在我们的例子中，$N-1=20$。\n让我们计算 $w[20-n]$：\n$$w[20-n] = 0.54 - 0.46\\cos\\left(\\frac{2\\pi (20-n)}{20}\\right) = 0.54 - 0.46\\cos\\left(2\\pi - \\frac{2\\pi n}{20}\\right)$$\n鉴于 $\\cos(2\\pi - \\theta) = \\cos(\\theta)$，我们得到：\n$$w[20-n] = 0.54 - 0.46\\cos\\left(\\frac{2\\pi n}{20}\\right) = w[n]$$\n因此，汉明窗 $w[n]$ 关于索引 $n=10$ 是偶对称的。\n\n接下来，我们检查移位的理想脉冲响应 $h_d[n-M]$。我们定义一个序列 $g[n] = h_d[n-M]$。我们需要检查 $g[n]$ 是否关于 $n=M=10$ 对称。这等价于证明未移位的序列 $h_d[k]$ 是其索引 $k$ 的偶函数。\n理想脉冲响应为 $h_{d}[k]=\\frac{\\sin(\\omega_{c}k)}{\\pi k}$ 对于 $k\\neq 0$，以及 $h_{d}[0]=\\frac{\\omega_{c}}{\\pi}$。\n对于任何非零整数 $k$：\n$$h_d[-k] = \\frac{\\sin(\\omega_c(-k))}{\\pi(-k)} = \\frac{-\\sin(\\omega_c k)}{-\\pi k} = \\frac{\\sin(\\omega_c k)}{\\pi k} = h_d[k]$$\n$k=0$ 处的值是一个单点，所以函数 $h_d[k]$ 是偶函数。因此，项 $h_d[n-M]$ 关于点 $n=M$ 对称。也就是说，$h_d[(M-k)-M] = h_d[-k] = h_d[k] = h_d[(M+k)-M]$，表明了围绕 $M$ 的对称性。\n\n现在我们考虑完整的脉冲响应 $h[n] = h_d[n-10] w[n]$。我们检查其对称性：\n$$h[20-n] = h_d[(20-n)-10] \\cdot w[20-n] = h_d[10-n] \\cdot w[20-n]$$\n利用 $h_d[\\cdot]$ 和 $w[\\cdot]$ 关于各自中心的偶对称性：\n$$h_d[10-n] = h_d[-(n-10)] = h_d[n-10]$$\n$$w[20-n] = w[n]$$\n将这些代回，我们得到：\n$$h[20-n] = h_d[n-10] \\cdot w[n] = h[n]$$\n这证实了 $h[n]$ 关于 $n=M=10$ 具有偶对称性。这样的滤波器被归类为I型线性相位FIR滤波器。\n\n现在，我们从定义出发，推导其DTFT $H(e^{j\\omega})$ 的形式：\n$$H(e^{j\\omega}) = \\sum_{n=0}^{20} h[n] \\exp(-j\\omega n)$$\n我们可以在中心点 $n=10$ 处将求和分开：\n$$H(e^{j\\omega}) = h[10]\\exp(-j\\omega 10) + \\sum_{n=0}^{9} h[n]\\exp(-j\\omega n) + \\sum_{n=11}^{20} h[n]\\exp(-j\\omega n)$$\n让我们改变第二个求和的索引。令 $k = 20-n$，这意味着 $n=20-k$。当 $n$ 从 $11$ 变到 $20$ 时，$k$ 从 $9$ 变到 $0$。\n$$\\sum_{n=11}^{20} h[n]\\exp(-j\\omega n) = \\sum_{k=0}^{9} h[20-k]\\exp(-j\\omega(20-k))$$\n利用对称性 $h[20-k]=h[k]$：\n$$\\sum_{k=0}^{9} h[k]\\exp(-j\\omega 20)\\exp(j\\omega k) = \\sum_{n=0}^{9} h[n]\\exp(-j\\omega 20)\\exp(j\\omega n)$$\n将此代回 $H(e^{j\\omega})$ 的表达式：\n$$H(e^{j\\omega}) = h[10]\\exp(-j\\omega 10) + \\sum_{n=0}^{9} h[n]\\exp(-j\\omega n) + \\sum_{n=0}^{9} h[n]\\exp(-j\\omega 20)\\exp(j\\omega n)$$\n$$H(e^{j\\omega}) = h[10]\\exp(-j\\omega 10) + \\sum_{n=0}^{9} h[n] \\left( \\exp(-j\\omega n) + \\exp(-j\\omega(20-n)) \\right)$$\n提出公因子 $\\exp(-j\\omega 10)$：\n$$\\exp(-j\\omega n) + \\exp(-j\\omega(20-n)) = \\exp(-j\\omega 10) \\left( \\exp(j\\omega(10-n)) + \\exp(-j\\omega(10-n)) \\right)$$\n使用欧拉恒等式 $2\\cos(\\theta) = e^{j\\theta} + e^{-j\\theta}$，这变成：\n$$\\exp(-j\\omega 10) \\cdot 2\\cos(\\omega(10-n))$$\n将此代入 $H(e^{j\\omega})$ 的表达式中：\n$$H(e^{j\\omega}) = h[10]\\exp(-j\\omega 10) + \\sum_{n=0}^{9} h[n] \\left( \\exp(-j\\omega 10) \\cdot 2\\cos(\\omega(10-n)) \\right)$$\n$$H(e^{j\\omega}) = \\exp(-j\\omega 10) \\left( h[10] + 2 \\sum_{n=0}^{9} h[n]\\cos(\\omega(10-n)) \\right)$$\n这是 $H(e^{j\\omega}) = \\exp(-j\\omega M) A(\\omega)$ 的形式，其中 $M=10$ 且 $A(\\omega)$ 是实值零相位幅度函数：\n$$A(\\omega) = h[10] + 2 \\sum_{n=0}^{9} h[n]\\cos(\\omega(10-n))$$\n\n**2. $A(\\omega)$ 的表达式**\n\n为了将 $A(\\omega)$ 表示为所要求的余弦级数，我们在求和中进行索引变换。令 $k = 10-n$。当 $n$ 从 $0$ 变到 $9$ 时，$k$ 从 $10$ 变到 $1$。\n$$A(\\omega) = h[10] + 2 \\sum_{k=1}^{10} h[10-k]\\cos(\\omega k)$$\n这符合 $A(\\omega)=a_{0}+2\\sum_{k=1}^{M}a_{k}\\cos(\\omega k)$ 的形式，其中 $M=10$。\n通过比较，系数 $a_k$ 是：\n$$a_0 = h[10]$$\n$$a_k = h[10-k] \\quad \\text{对于 } k=1, 2, \\dots, 10$$\n我们现在用闭式形式陈述这些系数。\n对于 $k=0$：\n$$a_0 = h[10] = h_d[10-10] w[10] = h_d[0]w[10]$$\n$$h_d[0] = \\frac{\\omega_c}{\\pi} = \\frac{0.4\\pi}{\\pi} = 0.4$$\n$$w[10] = 0.54 - 0.46\\cos\\left(\\frac{2\\pi \\cdot 10}{20}\\right) = 0.54 - 0.46\\cos(\\pi) = 0.54 + 0.46 = 1$$\n因此，$a_0 = 0.4$。\n\n对于 $k \\in \\{1, 2, \\dots, 10\\}$：\n$$a_k = h[10-k] = h_d[(10-k)-10] w[10-k] = h_d[-k] w[10-k]$$\n利用 $h_d[k]$ 的偶对称性，我们有 $h_d[-k]=h_d[k]$。\n$$a_k = h_d[k] w[10-k] = \\frac{\\sin(\\omega_c k)}{\\pi k} \\left(0.54 - 0.46\\cos\\left(\\frac{2\\pi(10-k)}{20}\\right)\\right)$$\n$$a_k = \\frac{\\sin(0.4\\pi k)}{\\pi k} \\left(0.54 - 0.46\\cos\\left(\\pi - \\frac{\\pi k}{10}\\right)\\right)$$\n因为 $\\cos(\\pi-\\theta)=-\\cos(\\theta)$：\n$$a_k = \\frac{\\sin(0.4\\pi k)}{\\pi k} \\left(0.54 + 0.46\\cos\\left(\\frac{\\pi k}{10}\\right)\\right)$$\n这是系数 $a_k$ 的闭式表达式。\n\n**3. 幅度与相位响应**\n\nDTFT 为 $H(e^{j\\omega}) = A(\\omega) \\exp(-j\\omega M)$，其中 $A(\\omega)$ 是一个实函数。\n幅度响应由下式给出：\n$$|H(e^{j\\omega})| = |A(\\omega) \\exp(-j\\omega M)| = |A(\\omega)| \\cdot |\\exp(-j\\omega M)|$$\n因为对于任何实数 $\\omega$ 和 $M$，都有 $|\\exp(-j\\omega M)|=1$：\n$$|H(e^{j\\omega})| = |A(\\omega)|$$\n相位响应由下式给出：\n$$\\angle H(e^{j\\omega}) = \\angle (A(\\omega) \\exp(-j\\omega M)) = \\angle A(\\omega) + \\angle \\exp(-j\\omega M)$$\n$\\exp(-j\\omega M)$ 的相位是 $-\\omega M$。函数 $A(\\omega)$ 是实数，所以它的相位 $\\angle A(\\omega)$ 只能是 $0$ 或 $\\pi$（或 $-\\pi$，在模 $2\\pi$ 意义下是等价的）。当 $A(\\omega) \\geq 0$ 时相位是 $0$，当 $A(\\omega) < 0$ 时相位是 $\\pi$。\n因此，精确相位是：\n$$\\angle H(e^{j\\omega}) = -\\omega M + \\angle A(\\omega) = \\begin{cases} -\\omega M & \\text{若 } A(\\omega) \\geq 0 \\\\ -\\omega M + \\pi & \\text{若 } A(\\omega) < 0 \\end{cases}$$\n当 $M=10$ 时，这变成：\n$$\\angle H(e^{j\\omega}) = \\begin{cases} -10\\omega & \\text{若 } A(\\omega) \\geq 0 \\\\ -10\\omega + \\pi & \\text{若 } A(\\omega) < 0 \\end{cases}$$\n\n**4. 通带群延迟**\n\n群延迟定义为 $\\tau_{g}(\\omega) = -\\frac{d}{d\\omega}\\angle H(e^{j\\omega})$。\n问题要求在主低频通带内进行此计算。对于一个正确设计的低通滤波器，在通带内的频率 $0 \\leq |\\omega| < \\omega_c$ 处，幅度响应 $A(\\omega)$ 是正的。问题陈述为“非负”，所以我们考虑 $A(\\omega) \\geq 0$ 的区域。\n在这个区域内，相位是纯线性的：\n$$\\angle H(e^{j\\omega}) = -10\\omega$$\n我们现在可以通过对 $\\omega$ 求负导数来计算群延迟：\n$$\\tau_g(\\omega) = -\\frac{d}{d\\omega}(-10\\omega) = -(-10) = 10$$\n通带群延迟是常数，等于 $10$ 个采样点。这是线性相位FIR滤波器的一个特性属性。", "answer": "$$\\boxed{10}$$", "id": "2882328"}, {"introduction": "本练习探讨了系统理论中一个更深层次的问题：如果两个系统具有完全相同的幅度响应，它们之间有何关联与区别？您将通过对一个零点及其在单位圆上的“反射”进行代数操作，来揭示最小相位、非最小相位以及全通滤波器的核心概念。这项实践阐明了相位响应（而不仅仅是幅度）如何决定一个系统的动态行为和瞬态响应，从而深化您对系统传递函数的理解 [@problem_id:2882304]。", "problem": "考虑一个线性时不变（LTI）离散时间系统，其传递函数为 $H_{1}(z)$，该系统的零点和极点都严格位于单位圆之外（可能在原点处除外）。设 $z_{0} \\in \\mathbb{C}$ 是 $H_{1}(z)$ 的一个单零点，且 $|z_{0}| \\neq 1$。假设 $H_{1}(z)$ 可分解为 $H_{1}(z) = C \\left(1 - z_{0} z^{-1}\\right) G(z)$，其中 $C \\in \\mathbb{C}$ 是一个非零常数，$G(z)$ 包含 $H_{1}(z)$ 的所有其余因子（零点和极点），并且在单位圆上没有零点或极点。通过将因子 $\\left(1 - z_{0} z^{-1}\\right)$ 替换为 $\\left(1 - z_{0}^{- \\ast} z^{-1}\\right)$ 来构造第二个系统 $H_{2}(z)$，其中 $z_{0}^{- \\ast} \\triangleq 1/z_{0}^{\\ast}$ 是 $z_{0}$ 关于单位圆的反射。并用一个复常数 $\\tilde{C}$ 对 $H_{2}(z)$ 进行缩放，使得对于所有实数 $\\omega$（单位为弧度），都有 $|H_{1}(\\exp(j \\omega))| = |H_{2}(\\exp(j \\omega))|$。即：\n$$\nH_{2}(z) \\triangleq \\tilde{C} \\left(1 - z_{0}^{- \\ast} z^{-1}\\right) G(z).\n$$\n仅使用离散时间频率响应、幅值、相位和群延迟的定义，即 $H(\\exp(j \\omega)) \\triangleq H(z)\\big|_{z=\\exp(j\\omega)}$、$|H(\\exp(j\\omega))| \\triangleq \\sqrt{H(\\exp(j\\omega)) H^{\\ast}(\\exp(j\\omega))}$、$\\angle H(\\exp(j\\omega)) \\triangleq \\arg H(\\exp(j\\omega))$ 以及群延迟 $\\tau_{g}(\\omega) \\triangleq - \\frac{d}{d \\omega} \\angle H(\\exp(j \\omega))$，从基本原理出发，不使用任何预先记忆的“捷径”公式：\n\n1) 证明存在一个 $\\tilde{C}$ 的选择，能够确保对于所有实数 $\\omega$，都有 $|H_{1}(\\exp(j \\omega))| = |H_{2}(\\exp(j \\omega))|$，并确定这样一个选择。\n\n2) 证明在此选择下，比率\n$$\nQ(\\exp(j \\omega)) \\triangleq \\frac{H_{2}(\\exp(j \\omega))}{H_{1}(\\exp(j \\omega))}\n$$\n对于所有实数 $\\omega$ 都具有单位幅值，因此可以被解释为单位圆上的一个全通因子，它解释了由零点反射所引入的相位变化。\n\n3) 推导群延迟差\n$$\n\\Delta \\tau_{g}(\\omega) \\triangleq \\tau_{g,2}(\\omega) - \\tau_{g,1}(\\omega) \\, ,\n$$\n的闭式表达式，该表达式完全用 $z_{0}$ 和 $\\omega$ 表示，其中 $\\tau_{g,i}(\\omega)$ 表示 $H_{i}$（对于 $i \\in \\{1,2\\}$）的群延迟。用 $|z_{0}|$ 和 $\\arg(z_{0})$ 将你的最终结果表示为 $\\omega$（单位为弧度）的显式函数。以样本数为单位表示群延迟差。\n\n你的最终答案必须是 $\\Delta \\tau_{g}(\\omega)$ 的单个闭式解析表达式，用 $|z_{0}|$、$\\arg(z_{0})$ 和 $\\omega$ 表示；无需进行数值计算。", "solution": "对问题陈述进行验证。\n\n步骤1：提取已知条件\n- 系统1的传递函数：$H_{1}(z) = C \\left(1 - z_{0} z^{-1}\\right) G(z)$。\n- $z_{0} \\in \\mathbb{C}$ 是 $H_1(z)$ 的一个单零点，且 $|z_{0}| \\neq 1$。\n- $C \\in \\mathbb{C}$ 是一个非零常数。\n- $G(z)$ 包含 $H_1(z)$ 的所有其他极点和零点，并且在单位圆上没有极点或零点。\n- 系统2的传递函数：$H_{2}(z) = \\tilde{C} \\left(1 - z_{0}^{- \\ast} z^{-1}\\right) G(z)$。\n- 反射零点的定义：$z_{0}^{- \\ast} \\triangleq 1/z_{0}^{\\ast}$。\n- 条件：选择缩放常数 $\\tilde{C}$ 以使得对于所有实数 $\\omega$，都有 $|H_{1}(\\exp(j \\omega))| = |H_{2}(\\exp(j \\omega))|$。\n- 频率响应：$H(\\exp(j \\omega)) \\triangleq H(z)\\big|_{z=\\exp(j\\omega)}$。\n- 幅值：$|H(\\exp(j\\omega))| \\triangleq \\sqrt{H(\\exp(j\\omega)) H^{\\ast}(\\exp(j\\omega))}$。\n- 相位：$\\angle H(\\exp(j\\omega)) \\triangleq \\arg H(\\exp(j\\omega))$。\n- 群延迟：$\\tau_{g}(\\omega) \\triangleq - \\frac{d}{d \\omega} \\angle H(\\exp(j \\omega))$，以样本数为单位。\n- 比率：$Q(\\exp(j \\omega)) \\triangleq \\frac{H_{2}(\\exp(j \\omega))}{H_{1}(\\exp(j \\omega))}$。\n- 群延迟差：$\\Delta \\tau_{g}(\\omega) \\triangleq \\tau_{g,2}(\\omega) - \\tau_{g,1}(\\omega)$。\n\n步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题是数字信号处理中的一个标准练习，涉及全通滤波器的性质以及最小相位系统与非最小相位系统之间的关系。所有概念和定义都是该领域的基础。\n- **适定性**：该问题由三个相关的任务序列构成。每个任务都定义清晰，并且从一个任务进行到下一个任务所需的信息都已提供或可以推导得出。预期会得到群延迟差的唯一解。\n- **客观性**：问题陈述使用精确的数学语言，没有任何主观性或歧义。\n\n步骤3：结论与行动\n该问题是有效的，因为它是科学合理的、适定的和客观的。这是一个信号处理理论中标准的、非平凡的问题。我将继续进行解答。\n\n按照问题的要求，解答分为三个部分。\n\n1) $\\tilde{C}$ 的存在性与确定\n\n需要满足的条件是 $|H_{1}(\\exp(j \\omega))| = |H_{2}(\\exp(j \\omega))|$。我们在单位圆上（其中 $z = \\exp(j \\omega)$）计算传递函数的幅值。\n$$|H_{1}(\\exp(j \\omega))| = |C| |1 - z_{0} \\exp(-j \\omega)| |G(\\exp(j \\omega))|$$\n$$|H_{2}(\\exp(j \\omega))| = |\\tilde{C}| |1 - z_{0}^{- \\ast} \\exp(-j \\omega)| |G(\\exp(j \\omega))|$$\n令这两个表达式相等，并注意到 $|G(\\exp(j \\omega))|$ 是有限且非零的，我们可以消去这一项，得到：\n$$|C| |1 - z_{0} \\exp(-j \\omega)| = |\\tilde{C}| |1 - z_{0}^{- \\ast} \\exp(-j \\omega)|$$\n现在我们必须关联 $|1 - z_{0} \\exp(-j \\omega)|$ 和 $|1 - z_{0}^{- \\ast} \\exp(-j \\omega)|$ 这两项。我们来分析第二项，使用定义 $z_{0}^{- \\ast} = 1/z_{0}^{\\ast}$。\n$$|1 - z_{0}^{- \\ast} \\exp(-j \\omega)| = \\left|1 - \\frac{1}{z_{0}^{\\ast}} \\exp(-j \\omega)\\right| = \\left|\\frac{z_{0}^{\\ast} - \\exp(-j \\omega)}{z_{0}^{\\ast}}\\right| = \\frac{|z_{0}^{\\ast} - \\exp(-j \\omega)|}{|z_{0}^{\\ast}|}$$\n利用对于任意复数 $w$ 都有 $|w^{\\ast}| = |w|$ 的性质，我们有 $|z_{0}^{\\ast}| = |z_{0}|$ 并且 $|z_{0}^{\\ast} - \\exp(-j \\omega)| = |(z_{0} - \\exp(j \\omega))^{\\ast}| = |z_{0} - \\exp(j \\omega)|$。\n$$|1 - z_{0}^{- \\ast} \\exp(-j \\omega)| = \\frac{|z_{0} - \\exp(j \\omega)|}{|z_{0}|}$$\n现在，对于第一项：\n$$|1 - z_{0} \\exp(-j \\omega)| = |\\exp(-j \\omega) (\\exp(j \\omega) - z_{0})| = |\\exp(-j \\omega)| |\\exp(j \\omega) - z_{0}|$$\n由于 $|\\exp(-j \\omega)| = 1$，我们有 $|1 - z_{0} \\exp(-j \\omega)| = |z_{0} - \\exp(j \\omega)|$。\n结合这些结果，我们发现这两个因子之间的关系：\n$$|1 - z_{0} \\exp(-j \\omega)| = |z_{0}| |1 - z_{0}^{- \\ast} \\exp(-j \\omega)|$$\n将此代回关于幅值的条件中：\n$$|C| \\left(|z_{0}| |1 - z_{0}^{- \\ast} \\exp(-j \\omega)|\\right) = |\\tilde{C}| |1 - z_{0}^{- \\ast} \\exp(-j \\omega)|$$\n由于 $z_0$ 不在单位圆上，其反射 $z_0^{-*}$ 也不在单位圆上。因此，对于任何 $\\omega$，$1 - z_{0}^{- \\ast} \\exp(-j \\omega)$ 项永远不为零，其幅值可以被消去。这得到：\n$$|C| |z_{0}| = |\\tilde{C}|$$\n这证明了满足幅值条件的常数 $\\tilde{C}$ 存在。其幅值是确定的，但其相位是任意的。一个满足此幅值关系的有效选择，例如，可以通过将 $C$ 乘以正实数 $|z_0|$ 来实现。一个简单的选择是 $\\tilde{C} = C |z_{0}|$.\n\n2) $Q(\\exp(j \\omega))$ 的全通性质验证\n\n比率 $Q(\\exp(j \\omega))$ 定义为：\n$$Q(\\exp(j \\omega)) = \\frac{H_{2}(\\exp(j \\omega))}{H_{1}(\\exp(j \\omega))} = \\frac{\\tilde{C} \\left(1 - z_{0}^{- \\ast} \\exp(-j \\omega)\\right) G(\\exp(j \\omega))}{C \\left(1 - z_{0} \\exp(-j \\omega)\\right) G(\\exp(j \\omega))}$$\n因子 $G(\\exp(j \\omega))$ 被消去：\n$$Q(\\exp(j \\omega)) = \\frac{\\tilde{C}}{C} \\frac{1 - z_{0}^{- \\ast} \\exp(-j \\omega)}{1 - z_{0} \\exp(-j \\omega)}$$\n为了证明其幅值为单位1，我们计算 $|Q(\\exp(j \\omega))|$：\n$$|Q(\\exp(j \\omega))| = \\left|\\frac{\\tilde{C}}{C}\\right| \\left|\\frac{1 - z_{0}^{- \\ast} \\exp(-j \\omega)}{1 - z_{0} \\exp(-j \\omega)}\\right|$$\n从第1部分，我们已经确定任何有效的 $\\tilde{C}$ 选择都必须满足 $|\\tilde{C}| = |C||z_{0}|$，这意味着 $|\\tilde{C}/C| = |z_{0}|$。我们还确定了 $|1 - z_{0}^{- \\ast} \\exp(-j \\omega)| = \\frac{1}{|z_{0}|} |1 - z_{0} \\exp(-j \\omega)|$，这意味着 $\\left|\\frac{1 - z_{0}^{- \\ast} \\exp(-j \\omega)}{1 - z_{0} \\exp(-j \\omega)}\\right| = \\frac{1}{|z_{0}|}$。\n将这两个结果代入 $|Q(\\exp(j \\omega))|$ 的表达式中：\n$$|Q(\\exp(j \\omega))| = |z_{0}| \\cdot \\frac{1}{|z_{0}|} = 1$$\n这对所有实数 $\\omega$ 都成立。因此，$Q(\\exp(j \\omega))$ 是一个全通因子，它改变相位响应，同时保持幅值为常数1。\n\n3) 群延迟差 $\\Delta \\tau_{g}(\\omega)$ 的推导\n\n群延迟差为 $\\Delta \\tau_{g}(\\omega) = \\tau_{g,2}(\\omega) - \\tau_{g,1}(\\omega)$。使用群延迟的定义：\n$$\\Delta \\tau_{g}(\\omega) = \\left(-\\frac{d}{d \\omega} \\angle H_{2}(\\exp(j \\omega))\\right) - \\left(-\\frac{d}{d \\omega} \\angle H_{1}(\\exp(j \\omega))\\right) = -\\frac{d}{d \\omega} \\left( \\angle H_{2}(\\exp(j \\omega)) - \\angle H_{1}(\\exp(j \\omega)) \\right)$$\n相位角的差是该比率的相位角：\n$$\\angle H_{2}(\\exp(j \\omega)) - \\angle H_{1}(\\exp(j \\omega)) = \\angle \\frac{H_{2}(\\exp(j \\omega))}{H_{1}(\\exp(j \\omega))} = \\angle Q(\\exp(j \\omega))$$\n所以，$\\Delta \\tau_{g}(\\omega) = -\\frac{d}{d \\omega} \\angle Q(\\exp(j \\omega))$。\n为了计算这个导数，我们使用恒等式 $\\frac{d}{d\\omega} \\arg(f(\\omega)) = \\Im\\left(\\frac{1}{f(\\omega)} \\frac{df(\\omega)}{d\\omega}\\right) = \\Im\\left(\\frac{d}{d\\omega} \\ln(f(\\omega))\\right)$。\n让我们求 $Q(z)$ 在 $z=\\exp(j\\omega)$ 处的对数导数。\n$$Q(z) = \\frac{\\tilde{C}}{C} \\frac{1 - z_{0}^{- \\ast} z^{-1}}{1 - z_{0} z^{-1}}$$\n$$\\ln(Q(z)) = \\ln\\left(\\frac{\\tilde{C}}{C}\\right) + \\ln(1 - z_{0}^{- \\ast} z^{-1}) - \\ln(1 - z_{0} z^{-1})$$\n对 $\\omega$ 求导（其中 $z=\\exp(j\\omega)$，所以 $dz/d\\omega = j\\exp(j\\omega) = jz$）：\n$$\\frac{d}{d\\omega} \\ln(Q(\\exp(j\\omega))) = \\frac{d}{dz}[\\ln(Q(z))] \\frac{dz}{d\\omega} = \\left( \\frac{-z_{0}^{- \\ast} (-z^{-2})}{1 - z_{0}^{- \\ast} z^{-1}} - \\frac{-z_{0} (-z^{-2})}{1 - z_{0} z^{-1}} \\right) (jz)$$\n$$= \\left( \\frac{z_{0}^{- \\ast} z^{-2}}{1 - z_{0}^{- \\ast} z^{-1}} - \\frac{z_{0} z^{-2}}{1 - z_{0} z^{-1}} \\right) (jz) = j \\left( \\frac{z_{0}^{- \\ast} z^{-1}}{1 - z_{0}^{- \\ast} z^{-1}} - \\frac{z_{0} z^{-1}}{1 - z_{0} z^{-1}} \\right)$$\n相位导数是此表达式的虚部。由于整个表达式乘以 $j$，我们需要括号内项的实部。\n$$\\frac{d}{d\\omega} \\angle Q(\\exp(j\\omega)) = \\Re\\left(\\frac{z_{0}^{- \\ast} z^{-1}}{1 - z_{0}^{- \\ast} z^{-1}} - \\frac{z_{0} z^{-1}}{1 - z_{0} z^{-1}}\\right)\\bigg|_{z=\\exp(j\\omega)}$$\n令 $a = z_0$ 且 $b = z_0^{-*}$。来自因子 $(1 - p z^{-1})$ 的群延迟贡献是 $-\\Re\\left(\\frac{p z^{-1}}{1 - p z^{-1}}\\right)$。因此，我们得到的表达式是 $-(\\tau_{g, \\text{zero } z_0^{-*}} - \\tau_{g, \\text{zero } z_0})$。\n让我们为通用复数 $p$ 和 $z=\\exp(j\\omega)$ 计算 $\\Re\\left(\\frac{p z^{-1}}{1 - p z^{-1}}\\right)$。\n$$\\frac{p z^{-1}}{1 - p z^{-1}} = \\frac{p z^{-1}(1 - p^{\\ast} z)}{|1 - p z^{-1}|^2} = \\frac{p z^{-1} - |p|^2}{|1 - p z^{-1}|^2}$$\n令 $p = r \\exp(j\\theta)$。则 $p z^{-1} = r \\exp(j\\theta) \\exp(-j\\omega) = r \\exp(j(\\theta-\\omega))$。\n$$\\Re(p z^{-1} - |p|^2) = \\Re(r(\\cos(\\theta-\\omega) + j\\sin(\\theta-\\omega)) - r^2) = r\\cos(\\theta-\\omega) - r^2$$\n分母是 $|1 - p z^{-1}|^2 = (1-pz^{-1})(1-p^*z) = 1 - pz^{-1} - p^*z + |p|^2 = 1 - 2\\Re(pz^{-1}) + |p|^2 = 1 - 2r\\cos(\\theta-\\omega) + r^2$。\n所以，$\\Re\\left(\\frac{p z^{-1}}{1 - p z^{-1}}\\right) = \\frac{r\\cos(\\theta-\\omega) - r^2}{1 - 2r\\cos(\\theta-\\omega) + r^2}$。\n令 $r_0 = |z_0|$ 和 $\\theta_0 = \\arg(z_0)$。\n对于 $p = z_0$ 的项，我们有 $r=r_0$ 和 $\\theta=\\theta_0$。\n对于 $p = z_0^{-*} = 1/z_0^*$ 的项，我们有 $p = (1/r_0)\\exp(j\\theta_0)$。所以 $r=1/r_0$ 和 $\\theta=\\theta_0$。\n我们来计算这个差值：\n$$\\frac{d}{d\\omega} \\angle Q = \\frac{\\frac{1}{r_0}\\cos(\\theta_0-\\omega) - (\\frac{1}{r_0})^2}{1 - \\frac{2}{r_0}\\cos(\\theta_0-\\omega) + (\\frac{1}{r_0})^2} - \\frac{r_0\\cos(\\theta_0-\\omega) - r_0^2}{1 - 2r_0\\cos(\\theta_0-\\omega) + r_0^2}$$\n通过将分子和分母乘以 $r_0^2$ 来简化第一项：\n$$\\frac{r_0\\cos(\\theta_0-\\omega) - 1}{r_0^2 - 2r_0\\cos(\\theta_0-\\omega) + 1}$$\n现在分母相同了。令 $D = 1 - 2r_0\\cos(\\theta_0-\\omega) + r_0^2$。\n$$\\frac{d}{d\\omega} \\angle Q = \\frac{(r_0\\cos(\\theta_0-\\omega) - 1) - (r_0\\cos(\\theta_0-\\omega) - r_0^2)}{D} = \\frac{r_0^2 - 1}{D}$$\n群延迟差是这个量的负值：\n$$\\Delta \\tau_{g}(\\omega) = -\\frac{r_0^2 - 1}{1 - 2r_0\\cos(\\theta_0-\\omega) + r_0^2} = \\frac{1 - r_0^2}{1 - 2r_0\\cos(\\theta_0-\\omega) + r_0^2}$$\n最后，代入 $r_0 = |z_0|$ 和 $\\theta_0 = \\arg(z_0)$：\n$$\\Delta \\tau_{g}(\\omega) = \\frac{1 - |z_{0}|^2}{1 - 2|z_{0}|\\cos(\\arg(z_{0}) - \\omega) + |z_{0}|^2}$$\n此表达式给出了以样本数表示的群延迟差。", "answer": "$$ \\boxed{ \\frac{1 - |z_{0}|^2}{1 - 2|z_{0}|\\cos(\\arg(z_{0}) - \\omega) + |z_{0}|^2} } $$", "id": "2882304"}]}