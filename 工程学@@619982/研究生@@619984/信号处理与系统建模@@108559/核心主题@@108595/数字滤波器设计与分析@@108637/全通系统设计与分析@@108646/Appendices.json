{"hands_on_practices": [{"introduction": "全通系统的核心价值在于其能够在不改变信号幅度的前提下调整信号的相位。本练习将从最基本的一阶全通滤波器入手，通过从头推导其群延迟表达式，你将深刻理解系统极点位置与群延迟峰值之间的直接关系。这个实践不仅是分析的基础，更是设计相位均衡器的第一步，让你能够根据期望的延迟特性来精确确定滤波器参数。 [@problem_id:2851787]", "problem": "考虑离散时间一阶全通部分\n$$\nH_1(z) \\;=\\; \\frac{z^{-1} - a}{1 - a^{*}\\, z^{-1}},\n$$\n其中 $a \\in \\mathbb{C}$，$|a|<1$，且 $(\\cdot)^{*}$ 表示复共轭。全通特性意味着对于任意角频率 $\\omega$，频率响应 $H_1(\\exp(\\mathrm{j}\\,\\omega))$ 的幅值都为1。群延迟定义为\n$$\n\\tau(\\omega) \\;=\\; -\\,\\frac{\\mathrm{d}}{\\mathrm{d}\\omega}\\,\\arg\\!\\big(H_1(\\exp(\\mathrm{j}\\,\\omega))\\big).\n$$\n从这些定义出发，且不假设任何预先给出的公式，完成以下任务：\n\n1) 推导群延迟 $\\tau(\\omega)$ 关于 $a$ 和 $\\omega$ 的显式解析表达式。\n\n2) 证明 $\\tau(\\omega)$ 在一个与极点角对齐的角频率 $\\omega_p$ 处达到唯一的最大值（群延迟峰值），并用 $|a|$ 表示该峰值 $\\tau_{\\text{peak}}$。\n\n3) 一项设计要求规定，群延迟必须在角频率 $\\omega_p$（单位为弧度）处达到峰值 $\\tau_p>1$。请确定满足此要求的参数 $a$，并将最终答案表示为关于 $\\tau_p$ 和 $\\omega_p$（单位为弧度）的单个闭式符号表达式。无需四舍五入。\n\n4) 针对实轴情况 $a\\in(-1,1)$，简要讨论当 $a$ 从单位圆盘内部趋近于 $\\pm 1$ 时，在群延迟的峰值高度、延迟被抬高的带宽以及稳定性/时域影响方面出现的权衡。\n\n你最终报告的答案必须是第 3) 项中要求的关于 $a$ 的单个闭式符号表达式，其中角度以弧度表示。", "solution": "一阶全通部分的传递函数由下式给出\n$$H_1(z) = \\frac{z^{-1} - a}{1 - a^{*} z^{-1}}$$\n其中 $a \\in \\mathbb{C}$ 且 $|a| < 1$。条件 $|a|<1$ 确保了系统的极点（位于 $z=a^*$）在单位圆内，从而保证了稳定性。\n\n首先，我们推导群延迟 $\\tau(\\omega)$。频率响应通过在单位圆 $z = \\exp(\\mathrm{j}\\,\\omega)$ 上计算 $H_1(z)$ 得到：\n$$H_1(\\exp(\\mathrm{j}\\,\\omega)) = \\frac{\\exp(-\\mathrm{j}\\,\\omega) - a}{1 - a^{*} \\exp(-\\mathrm{j}\\,\\omega)}$$\n为简化相位分析，我们可以将分子重写为 $\\exp(-\\mathrm{j}\\,\\omega) - a = \\exp(-\\mathrm{j}\\,\\omega)(1 - a \\exp(\\mathrm{j}\\,\\omega))$。我们定义复函数 $C(\\omega) = 1 - a \\exp(\\mathrm{j}\\,\\omega)$。其复共轭为 $C^*(\\omega) = (1 - a \\exp(\\mathrm{j}\\,\\omega))^* = 1 - a^* (\\exp(\\mathrm{j}\\,\\omega))^* = 1 - a^* \\exp(-\\mathrm{j}\\,\\omega)$。\n将这些代入频率响应表达式，我们得到：\n$$H_1(\\exp(\\mathrm{j}\\,\\omega)) = \\frac{\\exp(-\\mathrm{j}\\,\\omega) C(\\omega)}{C^*(\\omega)}$$\n这种形式证实了全通特性，因为 $|H_1(\\exp(\\mathrm{j}\\,\\omega))| = |\\exp(-\\mathrm{j}\\,\\omega)| \\frac{|C(\\omega)|}{|C^*(\\omega)|} = 1 \\cdot \\frac{|C(\\omega)|}{|C(\\omega)|} = 1$。\n频率响应的相角 $\\Theta(\\omega) = \\arg(H_1(\\exp(\\mathrm{j}\\,\\omega)))$ 可以通过各项的辐角相加得到：\n$$\\Theta(\\omega) = \\arg(\\exp(-\\mathrm{j}\\,\\omega)) + \\arg(C(\\omega)) - \\arg(C^*(\\omega))$$\n由于 $\\arg(C^*(\\omega)) = -\\arg(C(\\omega))$，我们有：\n$$\\Theta(\\omega) = -\\omega + 2\\arg(C(\\omega)) = -\\omega + 2\\arg(1 - a \\exp(\\mathrm{j}\\,\\omega))$$\n令 $a = r \\exp(\\mathrm{j}\\,\\phi)$，其中 $r = |a|$ 且 $\\phi = \\arg(a)$。辐角内的项是：\n$$1 - a \\exp(\\mathrm{j}\\,\\omega) = 1 - r \\exp(\\mathrm{j}\\,\\phi) \\exp(\\mathrm{j}\\,\\omega) = 1 - r \\exp(\\mathrm{j}(\\omega+\\phi))$$\n$$1 - r\\exp(\\mathrm{j}(\\omega+\\phi)) = (1 - r\\cos(\\omega+\\phi)) - \\mathrm{j}\\,r\\sin(\\omega+\\phi)$$\n所以，这一项的相位是 $\\psi(\\omega) = \\arctan\\left(\\frac{-r\\sin(\\omega+\\phi)}{1 - r\\cos(\\omega+\\phi)}\\right)$。总相位是 $\\Theta(\\omega) = -\\omega + 2\\psi(\\omega)$。\n群延迟定义为 $\\tau(\\omega) = -\\frac{\\mathrm{d}\\Theta}{\\mathrm{d}\\omega}$：\n$$\\tau(\\omega) = -\\frac{\\mathrm{d}}{\\mathrm{d}\\omega} \\left[-\\omega + 2 \\arctan\\left(\\frac{-r\\sin(\\omega+\\phi)}{1 - r\\cos(\\omega+\\phi)}\\right)\\right] = 1 - 2 \\frac{\\mathrm{d}}{\\mathrm{d}\\omega} \\left[\\arctan\\left(\\frac{-r\\sin(\\omega+\\phi)}{1 - r\\cos(\\omega+\\phi)}\\right)\\right]$$\n使用链式求导法则 $\\frac{\\mathrm{d}}{\\mathrm{d}x}\\arctan(u) = \\frac{1}{1+u^2}\\frac{\\mathrm{d}u}{\\mathrm{d}x}$，其中 $u(\\omega) = \\frac{-r\\sin(\\omega+\\phi)}{1 - r\\cos(\\omega+\\phi)}$，我们求反正切项的导数。$u(\\omega)$ 对 $\\omega$ 的导数是：\n$$\\frac{\\mathrm{d}u}{\\mathrm{d}\\omega} = \\frac{-r\\cos(\\omega+\\phi)(1 - r\\cos(\\omega+\\phi)) - (-r\\sin(\\omega+\\phi))(r\\sin(\\omega+\\phi))}{(1 - r\\cos(\\omega+\\phi))^2} = \\frac{-r\\cos(\\omega+\\phi) + r^2}{(1 - r\\cos(\\omega+\\phi))^2}$$\n而 $1+u^2$ 是：\n$$1+u^2 = 1 + \\frac{r^2\\sin^2(\\omega+\\phi)}{(1 - r\\cos(\\omega+\\phi))^2} = \\frac{1 - 2r\\cos(\\omega+\\phi) + r^2\\cos^2(\\omega+\\phi) + r^2\\sin^2(\\omega+\\phi)}{(1-r\\cos(\\omega+\\phi))^2} = \\frac{1 - 2r\\cos(\\omega+\\phi) + r^2}{(1-r\\cos(\\omega+\\phi))^2}$$\n结合这些结果，反正切项的导数是：\n$$\\frac{\\mathrm{d}\\psi}{\\mathrm{d}\\omega} = \\frac{(1-r\\cos(\\omega+\\phi))^2}{1 - 2r\\cos(\\omega+\\phi) + r^2} \\cdot \\frac{r^2 - r\\cos(\\omega+\\phi)}{(1 - r\\cos(\\omega+\\phi))^2} = \\frac{r^2 - r\\cos(\\omega+\\phi)}{1 - 2r\\cos(\\omega+\\phi) + r^2}$$\n将此代回 $\\tau(\\omega)$ 的表达式中：\n$$\\tau(\\omega) = 1 - 2\\left(\\frac{r^2 - r\\cos(\\omega+\\phi)}{1 - 2r\\cos(\\omega+\\phi) + r^2}\\right) = \\frac{(1 - 2r\\cos(\\omega+\\phi) + r^2) - 2(r^2 - r\\cos(\\omega+\\phi))}{1 - 2r\\cos(\\omega+\\phi) + r^2}$$\n$$\\tau(\\omega) = \\frac{1 - 2r\\cos(\\omega+\\phi) + r^2 - 2r^2 + 2r\\cos(\\omega+\\phi)}{1 - 2r\\cos(\\omega+\\phi) + r^2} = \\frac{1 - r^2}{1 - 2r\\cos(\\omega+\\phi) + r^2}$$\n将 $r$ 替换为 $|a|$，将 $\\phi$ 替换为 $\\arg(a)$，我们得到群延迟的最终表达式，从而完成了第 1) 项：\n$$\\tau(\\omega) = \\frac{1 - |a|^2}{1 - 2|a|\\cos(\\omega + \\arg(a)) + |a|^2}$$\n\n对于第 2) 项，我们寻求 $\\tau(\\omega)$ 的最大值。分子 $1 - |a|^2$ 是一个正常数。因此，当分母最小时，$\\tau(\\omega)$ 取最大值。分母为 $D(\\omega) = 1 + |a|^2 - 2|a|\\cos(\\omega + \\arg(a))$。要使 $D(\\omega)$ 最小，我们必须使 $\\cos(\\omega + \\arg(a))$ 项最大化。余弦函数的最大值为 1，这在其参数是 $2\\pi$ 的整数倍时发生。\n$$\\omega_p + \\arg(a) = 2k\\pi, \\quad k \\in \\mathbb{Z}$$\n这给出了峰值频率 $\\omega_p = -\\arg(a) + 2k\\pi$。系统的极点是 $p = a^* = |a|\\exp(-\\mathrm{j}\\arg(a))$，所以其角度是 $-\\arg(a)$。因此，峰值群延迟频率 $\\omega_p$ 确实与极点的角度对齐。函数 $\\cos(\\cdot)$ 在任何长度为 $2\\pi$ 的区间上都有唯一的最大值，因此峰值频率在像 $[-\\pi, \\pi]$ 这样的主值区间内是唯一的。\n群延迟的峰值 $\\tau_{\\text{peak}}$ 是通过将 $\\cos(\\omega_p + \\arg(a)) = 1$ 代入 $\\tau(\\omega)$ 的表达式中求得的：\n$$\\tau_{\\text{peak}} = \\frac{1 - |a|^2}{1 - 2|a|(1) + |a|^2} = \\frac{1 - |a|^2}{(1-|a|)^2} = \\frac{(1-|a|)(1+|a|)}{(1-|a|)^2} = \\frac{1+|a|}{1-|a|}$$\n这就完成了第 2) 项。峰值仅取决于 $a$ 的幅值。\n\n对于第 3) 项，给定的设计要求是：在角频率 $\\omega_p$ 处出现峰值群延迟 $\\tau_p > 1$。根据我们在第 2) 项中的分析，我们有两个条件：\n$$ \\tau_p = \\frac{1+|a|}{1-|a|} \\quad \\text{和} \\quad \\omega_p = -\\arg(a) $$\n我们可以对第一个方程求解 $|a|$：\n$$\\tau_p(1-|a|) = 1+|a|$$\n$$\\tau_p - \\tau_p|a| = 1+|a|$$\n$$\\tau_p - 1 = |a|(1+\\tau_p)$$\n$$|a| = \\frac{\\tau_p - 1}{\\tau_p + 1}$$\n条件 $\\tau_p > 1$ 确保了 $0 < |a| < 1$，这与稳定性要求一致。从第二个方程，我们有 $\\arg(a) = -\\omega_p$。\n参数 $a$ 可以根据其幅值 $|a|$ 和辐角 $\\arg(a)$，使用极坐标形式 $a = |a|\\exp(\\mathrm{j}\\,\\arg(a))$ 来构建：\n$$a = \\left(\\frac{\\tau_p - 1}{\\tau_p + 1}\\right) \\exp(-\\mathrm{j}\\,\\omega_p)$$\n这就是所要求的 $a$ 的闭式表达式。\n\n对于第 4) 项，我们讨论实数参数 $a \\in (-1, 1)$ 的权衡。\n如果 $a \\in \\mathbb{R}$，那么 $\\arg(a)$ 为 $0$（当 $a>0$ 时）或 $\\pi$（当 $a<0$ 时）。\n峰值延迟是 $\\tau_{\\text{peak}} = \\frac{1+|a|}{1-|a|}$。当 $|a| \\to 1$ 时，$\\tau_{\\text{peak}} \\to \\infty$。\n如果 $a \\to 1^-$，我们有 $|a| \\to 1$ 和 $\\arg(a) = 0$。群延迟峰值出现在 $\\omega_p = 0$（直流）处，其高度变得非常大。在 $\\omega=0$ 附近的延迟表达式可以近似为洛伦兹函数 $\\tau(\\omega) \\approx \\frac{2(1-a)}{(1-a)^2 + a\\omega^2}$。该峰值的带宽（以其半峰宽为特征）与 $1-a$ 成正比。因此，当 $a$ 趋近于 $1$ 时，峰值延迟变得更高，但同时也窄得多。在时域中，位于 $z=a$ 的极点趋近于单位圆上的 $z=1$。这导致系统的脉冲响应（包含项 $a^n$）衰减得非常慢，从而导致不良的瞬态响应和长的建立时间。\n如果 $a \\to -1^+$，我们有 $|a| \\to 1$ 和 $\\arg(a) = \\pi$。群延迟峰值出现在 $\\omega_p = \\pi$（奈奎斯特频率）处。类似的分析表明，当 $a$ 趋近于 $-1$ 时，峰值变得无限高且无限窄。在时域中，位于 $z=a$ 的极点趋近于 $z=-1$，导致脉冲响应（其项为 $a^n = (-|a|)^n$）成为一个缓慢衰减的交变序列。\n根本的权衡在于：在特定频率上实现非常大的群延迟需要将极点放置得非常靠近单位圆。这必然会导致群延迟曲线上出现一个尖锐的窄带峰值，并在时域中产生一个缓慢建立（近乎不稳定）的响应。群延迟的高选择性是以牺牲带宽和时域性能为代价的。", "answer": "$$\\boxed{\\left(\\frac{\\tau_p - 1}{\\tau_p + 1}\\right) \\exp(-\\mathrm{j}\\,\\omega_p)}$$", "id": "2851787"}, {"introduction": "在掌握了单个一阶全通滤波器的特性后，一个自然的问题是如何构建更强大、更具选择性的系统。本练习将引导你探索一种常见的技术——级联，即串联多个相同的滤波器单元。通过分析级联系统的复合群延迟，你将量化地理解滤波器的阶数 $K$ 如何影响其性能指标（如峰值延迟和峰的锐度），这对于设计满足特定性能要求的复杂均衡器至关重要。 [@problem_id:2851803]", "problem": "考虑由离散时间传递函数定义的一阶因果实系数全通滤波器节\n$$\nH_1(z) \\;=\\; \\frac{z^{-1} - a}{1 - a z^{-1}},\n$$\n其实参数 $a$ 满足 $0<a<1$。令 $K$ 为一个正整数，并构成级联\n$$\nH_K(z) \\;=\\; \\underbrace{H_1(z)\\,H_1(z)\\,\\cdots\\,H_1(z)}_{K\\ \\text{times}}。\n$$\n令 $H_1(\\exp(j\\omega))$ 表示 $H_1(z)$ 的离散时间傅里叶变换 (DTFT) 频率响应，并令 $\\theta_1(\\omega) = \\arg\\{H_1(\\exp(j\\omega))\\}$ 表示其展开相位。群延迟由线性时不变 (LTI) 系统的基本关系定义，\n$$\n\\tau(\\omega) \\;=\\; -\\,\\frac{d}{d\\omega}\\,\\theta(\\omega)。\n$$\n仅使用此定义、复数代数以及级联的相位是各部分相位之和这一事实，完成以下任务：\n\n1) 推导单节群延迟 $\\tau_1(\\omega)$ 作为 $\\omega$ 和 $a$ 的函数的闭式表达式。\n\n2) 使用第一性原理，用 $\\tau_1(\\omega)$ 和 $K$ 表示 $K$ 节复合群延迟 $\\tau_K(\\omega)$。\n\n3) 证明对于 $0<a<1$，$\\tau_K(\\omega)$ 在 $\\omega=0$ 处取得唯一的全局最大值，并计算其峰值 $\\tau_{K,\\max}=\\max_{\\omega}\\tau_K(\\omega)$。\n\n4) 定义半峰全宽（以弧度为单位）$\\Delta\\omega_{1/2}$ 为两个频率 $\\omega=\\pm \\omega_{1/2}$ 之间的距离，在这些频率上 $\\tau_K(\\omega)$ 等于其峰值的一半。假设 $a \\in \\left(\\frac{1}{3},1\\right)$ 以确保达到半峰值水平，精确求解 $\\omega_{1/2}$ 和 $\\Delta\\omega_{1/2}$（用 $a$ 表示）。\n\n5) 将复合群延迟峰值的锐度指数定义为\n$$\nS_K \\;=\\; \\frac{\\tau_{K,\\max}}{\\Delta\\omega_{1/2}},\n$$\n单位为 radians$^{-1}$。推导 $S_K$ 作为 $a$ 和 $K$ 的函数的闭式表达式，并明确说明它如何随 $K$ 缩放。\n\n请以 $S_K$ 关于 $a$ 和 $K$ 的单个符号表达式的形式提供最终答案。角度必须以弧度为单位；最终的方框表达式中不要包含单位。", "solution": "任务 1：推导单节群延迟 $\\tau_1(\\omega)$。\n频率响应 $H_1(\\exp(j\\omega))$ 通过将 $z = \\exp(j\\omega)$ 代入 $H_1(z)$ 获得：\n$$\nH_1(\\exp(j\\omega)) = \\frac{\\exp(-j\\omega) - a}{1 - a \\exp(-j\\omega)}\n$$\n我们将分子 $N(\\omega)$ 和分母 $D(\\omega)$ 表示为笛卡尔形式：\n$$\nN(\\omega) = \\cos(\\omega) - a - j\\sin(\\omega)\n$$\n$$\nD(\\omega) = 1 - a\\cos(\\omega) + ja\\sin(\\omega)\n$$\n系统的相位是分子的相位减去分母的相位：\n$$\n\\theta_1(\\omega) = \\arg\\{N(\\omega)\\} - \\arg\\{D(\\omega)\\} = \\arctan\\left(\\frac{-\\sin(\\omega)}{\\cos(\\omega)-a}\\right) - \\arctan\\left(\\frac{a\\sin(\\omega)}{1-a\\cos(\\omega)}\\right)\n$$\n群延迟定义为 $\\tau_1(\\omega) = -\\frac{d\\theta_1(\\omega)}{d\\omega}$。我们分别对每一项进行微分。\n对于第一项，令 $u_1(\\omega) = \\frac{-\\sin(\\omega)}{\\cos(\\omega)-a}$。其导数为：\n$$\n\\frac{du_1}{d\\omega} = \\frac{(-\\cos(\\omega))(\\cos(\\omega)-a) - (-\\sin(\\omega))(-\\sin(\\omega))}{(\\cos(\\omega)-a)^2} = \\frac{-\\cos^2(\\omega) + a\\cos(\\omega) - \\sin^2(\\omega)}{(\\cos(\\omega)-a)^2} = \\frac{-1 + a\\cos(\\omega)}{(\\cos(\\omega)-a)^2}\n$$\n$\\arctan(u_1(\\omega))$ 的导数是 $\\frac{1}{1+u_1^2}\\frac{du_1}{d\\omega}$：\n$$\n\\frac{d}{d\\omega}\\arctan(u_1(\\omega)) = \\frac{1}{1 + \\frac{\\sin^2(\\omega)}{(\\cos(\\omega)-a)^2}} \\cdot \\frac{a\\cos(\\omega)-1}{(\\cos(\\omega)-a)^2} = \\frac{(\\cos(\\omega)-a)^2}{(\\cos(\\omega)-a)^2+\\sin^2(\\omega)} \\cdot \\frac{a\\cos(\\omega)-1}{(\\cos(\\omega)-a)^2}\n$$\n$$\n= \\frac{a\\cos(\\omega)-1}{\\cos^2(\\omega)-2a\\cos(\\omega)+a^2+\\sin^2(\\omega)} = \\frac{a\\cos(\\omega)-1}{1+a^2-2a\\cos(\\omega)}\n$$\n对于第二项，令 $u_2(\\omega) = \\frac{a\\sin(\\omega)}{1-a\\cos(\\omega)}$。其导数为：\n$$\n\\frac{du_2}{d\\omega} = \\frac{(a\\cos(\\omega))(1-a\\cos(\\omega)) - (a\\sin(\\omega))(a\\sin(\\omega))}{(1-a\\cos(\\omega))^2} = \\frac{a\\cos(\\omega) - a^2\\cos^2(\\omega) - a^2\\sin^2(\\omega)}{(1-a\\cos(\\omega))^2} = \\frac{a\\cos(\\omega) - a^2}{(1-a\\cos(\\omega))^2}\n$$\n$\\arctan(u_2(\\omega))$ 的导数是 $\\frac{1}{1+u_2^2}\\frac{du_2}{d\\omega}$：\n$$\n\\frac{d}{d\\omega}\\arctan(u_2(\\omega)) = \\frac{1}{1 + \\frac{a^2\\sin^2(\\omega)}{(1-a\\cos(\\omega))^2}} \\cdot \\frac{a\\cos(\\omega)-a^2}{(1-a\\cos(\\omega))^2} = \\frac{(1-a\\cos(\\omega))^2}{(1-a\\cos(\\omega))^2+a^2\\sin^2(\\omega)} \\cdot \\frac{a\\cos(\\omega)-a^2}{(1-a\\cos(\\omega))^2}\n$$\n$$\n= \\frac{a\\cos(\\omega)-a^2}{1-2a\\cos(\\omega)+a^2\\cos^2(\\omega)+a^2\\sin^2(\\omega)} = \\frac{a\\cos(\\omega)-a^2}{1+a^2-2a\\cos(\\omega)}\n$$\n结合这些导数，我们得到 $\\frac{d\\theta_1(\\omega)}{d\\omega}$：\n$$\n\\frac{d\\theta_1(\\omega)}{d\\omega} = \\frac{a\\cos(\\omega)-1}{1+a^2-2a\\cos(\\omega)} - \\frac{a\\cos(\\omega)-a^2}{1+a^2-2a\\cos(\\omega)} = \\frac{a^2-1}{1+a^2-2a\\cos(\\omega)}\n$$\n最后，群延迟 $\\tau_1(\\omega)$ 是：\n$$\n\\tau_1(\\omega) = -\\frac{d\\theta_1(\\omega)}{d\\omega} = -\\frac{a^2-1}{1+a^2-2a\\cos(\\omega)} = \\frac{1-a^2}{1+a^2-2a\\cos(\\omega)}\n$$\n\n任务 2：复合群延迟 $\\tau_K(\\omega)$ 的表达式。\n级联系统的传递函数为 $H_K(z) = [H_1(z)]^K$。频率响应为 $H_K(\\exp(j\\omega)) = [H_1(\\exp(j\\omega))]^K$。由于 $H_1(z)$ 是一个全通滤波器，所以 $|H_1(\\exp(j\\omega))|=1$，其频率响应可以写为 $H_1(\\exp(j\\omega)) = \\exp(j\\theta_1(\\omega))$。\n复合频率响应为 $H_K(\\exp(j\\omega)) = [\\exp(j\\theta_1(\\omega))]^K = \\exp(j K \\theta_1(\\omega))$。\n因此，复合系统的相位为 $\\theta_K(\\omega) = K \\theta_1(\\omega)$。\n复合群延迟 $\\tau_K(\\omega)$ 是：\n$$\n\\tau_K(\\omega) = -\\frac{d\\theta_K(\\omega)}{d\\omega} = -\\frac{d}{d\\omega}(K \\theta_1(\\omega)) = K \\left(-\\frac{d\\theta_1(\\omega)}{d\\omega}\\right) = K \\tau_1(\\omega)\n$$\n代入 $\\tau_1(\\omega)$ 的表达式：\n$$\n\\tau_K(\\omega) = K \\frac{1-a^2}{1+a^2-2a\\cos(\\omega)}\n$$\n\n任务 3：$\\tau_K(\\omega)$ 的最大值。\n$\\tau_K(\\omega)$ 的表达式有一个恒为正的分子，因为 $K>0$ 和 $0<a<1$ 意味着 $1-a^2>0$。为了最大化 $\\tau_K(\\omega)$，我们必须最小化其分母 $D(\\omega) = 1+a^2-2a\\cos(\\omega)$。因为 $a>0$，当 $\\cos(\\omega)$ 最大化时，分母最小化。$\\cos(\\omega)$ 的最大值为 $1$，这在 $\\omega = 2\\pi n$（其中 $n$ 为任意整数）时出现。在主区间 $[-\\pi, \\pi]$ 内，这个唯一的最大值出现在 $\\omega=0$ 处。\n在 $\\omega=0$ 时，分母为 $1+a^2-2a(1) = (1-a)^2$。\n因此，群延迟的峰值为：\n$$\n\\tau_{K,\\max} = \\tau_K(0) = K \\frac{1-a^2}{(1-a)^2} = K \\frac{(1-a)(1+a)}{(1-a)^2} = K \\frac{1+a}{1-a}\n$$\n\n任务 4：半峰全宽 (FWHM)，$\\Delta\\omega_{1/2}$。\n我们必须找到频率 $\\omega = \\pm \\omega_{1/2}$，在这些频率上 $\\tau_K(\\omega)$ 等于其峰值的一半：\n$$\n\\tau_K(\\omega_{1/2}) = \\frac{1}{2}\\tau_{K,\\max}\n$$\n$$\nK \\frac{1-a^2}{1+a^2-2a\\cos(\\omega_{1/2})} = \\frac{1}{2} K \\frac{1+a}{1-a}\n$$\n除以 $K$ 和 $(1+a)$（非零），我们得到：\n$$\n\\frac{1-a}{1+a^2-2a\\cos(\\omega_{1/2})} = \\frac{1}{2(1-a)}\n$$\n交叉相乘得到：\n$$\n2(1-a)^2 = 1+a^2-2a\\cos(\\omega_{1/2})\n$$\n$$\n2(1-2a+a^2) = 1+a^2-2a\\cos(\\omega_{1/2})\n$$\n$$\n2-4a+2a^2 = 1+a^2-2a\\cos(\\omega_{1/2})\n$$\n求解 $\\cos(\\omega_{1/2})$：\n$$\n2a\\cos(\\omega_{1/2}) = (1+a^2) - (2-4a+2a^2) = -a^2+4a-1\n$$\n$$\n\\cos(\\omega_{1/2}) = \\frac{4a-a^2-1}{2a}\n$$\n问题陈述中假设 $a \\in (\\frac{1}{3},1)$，这确保了 $-1 < \\cos(\\omega_{1/2}) < 1$，从而保证了 $\\omega_{1/2}$ 存在非退化的解。\n按照惯例，我们取 $\\omega_{1/2}$ 为正解：\n$$\n\\omega_{1/2} = \\arccos\\left(\\frac{4a-a^2-1}{2a}\\right)\n$$\n半峰全宽 $\\Delta\\omega_{1/2}$ 是 $-\\omega_{1/2}$ 和 $+\\omega_{1/2}$ 之间的距离：\n$$\n\\Delta\\omega_{1/2} = \\omega_{1/2} - (-\\omega_{1/2}) = 2\\omega_{1/2} = 2\\arccos\\left(\\frac{4a-a^2-1}{2a}\\right)\n$$\n\n任务 5：锐度指数 $S_K$。\n锐度指数定义为 $S_K = \\frac{\\tau_{K,\\max}}{\\Delta\\omega_{1/2}}$。代入 $\\tau_{K,\\max}$ 和 $\\Delta\\omega_{1/2}$ 的表达式：\n$$\nS_K = \\frac{K \\frac{1+a}{1-a}}{2\\arccos\\left(\\frac{4a-a^2-1}{2a}\\right)} = \\frac{K(1+a)}{2(1-a)\\arccos\\left(\\frac{4a-a^2-1}{2a}\\right)}\n$$\n该表达式给出了锐度指数作为 $a$ 和 $K$ 的函数。对于一个固定的滤波器参数 $a$，锐度指数 $S_K$ 与级联节数 $K$ 成线性比例关系。\n$$\nS_K \\propto K\n$$", "answer": "$$\n\\boxed{\\frac{K(1+a)}{2(1-a)\\arccos\\left(\\frac{4a-a^2-1}{2a}\\right)}}\n$$", "id": "2851803"}, {"introduction": "真实的工程设计往往需要滤波器去逼近一个任意给定的、复杂的目标群延迟曲线，这超出了简单解析设计的范畴。本练习将带你进入现代滤波器设计的核心领域：将设计问题表述为一个数学优化问题。你将学习如何定义一个量化误差的目标函数，并结合系统稳定性的约束，最终构建出描述该设计问题的完整拉格朗日函数 $L(\\mathbf{a},\\boldsymbol{\\mu}^+,\\boldsymbol{\\mu}^-)$，这正是许多自动化滤波器设计工具背后的基本原理。 [@problem_id:2851788]", "problem": "考虑设计一个离散时间、实系数的全通系统，该系统由 $M$ 个一阶节级联实现\n$$\nA(z;\\mathbf{a}) \\;=\\; \\prod_{k=1}^{M} \\frac{z^{-1} - a_k}{1 - a_k z^{-1}},\n$$\n其中 $\\mathbf{a} = [a_1,\\dots,a_M]^{\\mathsf{T}}$ 且每个 $a_k \\in \\mathbb{R}$。该系统由角频率 $\\omega \\in [0,\\pi]$（单位为弧度）驱动。根据其构造，只要分子是分母的时间反转和共轭版本，每个节就都是全通的，并且稳定性要求所有极点严格位于单位圆内部。\n\n设群延迟定义为 $\\tau_A(\\omega) \\triangleq -\\frac{d}{d\\omega}\\arg\\{A(\\exp(j\\omega);\\mathbf{a})\\}$，并设 $\\tau_d(\\omega)$ 是在设计频带 $\\Omega \\subseteq [0,\\pi]$ 上给定的期望群延迟函数。设 $w(\\omega) \\ge 0$ 是 $\\Omega$ 上的一个有界加权函数。将 $\\Omega$ 上的群延迟误差的加权欧几里得（L2）范数定义为\n$$\n\\left\\| \\tau_A - \\tau_d \\right\\|_{2,w,\\Omega} \\;\\triangleq\\; \\left(\\int_{\\Omega} w(\\omega)\\,\\big(\\tau_A(\\omega)-\\tau_d(\\omega)\\big)^2\\,d\\omega\\right)^{\\frac{1}{2}}.\n$$\n为了获得一个可计算的替代形式，使用在节点 $\\{\\omega_n\\}_{n=1}^{N}\\subset \\Omega$（权重为 $\\{\\gamma_n\\}_{n=1}^{N}$）上的正权重求积法来近似该积分，其中每个 $\\gamma_n>0$ 且节点 $\\omega_n$ 的单位为弧度。为了获得鲁棒的稳定性裕度，用不等式界限 $|a_k| \\le \\rho$ 替代 $|a_k|<1$，其中 $\\rho \\in (0,1)$ 是一个给定的设计裕度。\n\n从上述定义以及全通节和群延迟的基本性质出发，完成以下任务：\n- 推导级联系统群延迟 $\\tau_A(\\omega)$ 的显式解析表达式，用系数 $\\{a_k\\}_{k=1}^{M}$ 和 $\\omega$ 表示。\n- 将指定的求积法应用于平方范数的被积函数，写出得到的离散化加权平方误差目标函数 $J(\\mathbf{a})$。\n- 建立约束优化问题，该问题在稳定性裕度约束 $|a_k|\\le \\rho$（$k=1,\\dots,M$）下最小化 $J(\\mathbf{a})$。\n- 为不等式约束 $a_k - \\rho \\le 0$ 和 $-a_k - \\rho \\le 0$ 分别引入非负拉格朗日乘子 $\\boldsymbol{\\mu}^+ = [\\mu_1^+,\\dots,\\mu_M^+]^{\\mathsf{T}}$ 和 $\\boldsymbol{\\mu}^- = [\\mu_1^-,\\dots,\\mu_M^-]^{\\mathsf{T}}$，并给出离散化问题的精确闭式拉格朗日函数 $L(\\mathbf{a},\\boldsymbol{\\mu}^+,\\boldsymbol{\\mu}^-)$。\n\n你的最终答案必须是拉格朗日函数 $L(\\mathbf{a},\\boldsymbol{\\mu}^+,\\boldsymbol{\\mu}^-)$ 的单一闭式解析表达式，用 $\\{\\gamma_n\\}$, $\\{\\omega_n\\}$, $\\tau_d(\\cdot)$, $\\rho$ 和变量 $(\\mathbf{a},\\boldsymbol{\\mu}^+,\\boldsymbol{\\mu}^-)$ 表示。不需要进行数值近似。答案不得包含单位，且必须以弧度为单位书写。", "solution": "推导过程分为四个部分：首先，级联全通系统群延迟的解析表达式；其次，离散化目标函数的构建；第三，约束优化问题的陈述；最后，拉格朗日函数的构造。\n\n首先，我们推导级联系统的群延迟 $\\tau_A(\\omega)$。其传递函数由下式给出：\n$$\nA(z;\\mathbf{a}) = \\prod_{k=1}^{M} A_k(z)\n$$\n其中每个一阶节为\n$$\nA_k(z) = \\frac{z^{-1} - a_k}{1 - a_k z^{-1}}.\n$$\n通过代入 $z = \\exp(j\\omega)$（其中 $j = \\sqrt{-1}$），在角频率 $\\omega$ 处对系统进行求值。系统的总相位是各单个节相位之和：\n$$\n\\arg\\{A(\\exp(j\\omega);\\mathbf{a})\\} = \\arg\\left\\{\\prod_{k=1}^{M} A_k(\\exp(j\\omega))\\right\\} = \\sum_{k=1}^{M} \\arg\\{A_k(\\exp(j\\omega))\\}.\n$$\n群延迟 $\\tau_A(\\omega)$ 定义为相位对 $\\omega$ 的负导数。根据微分的线性性质，总群延迟是各单个节群延迟之和：\n$$\n\\tau_A(\\omega) = -\\frac{d}{d\\omega} \\arg\\{A(\\exp(j\\omega);\\mathbf{a})\\} = \\sum_{k=1}^{M} \\left(-\\frac{d}{d\\omega} \\arg\\{A_k(\\exp(j\\omega))\\}\\right) = \\sum_{k=1}^{M} \\tau_{A_k}(\\omega).\n$$\n现在我们推导单个一阶节的群延迟 $\\tau_{A_k}(\\omega)$。令 $\\phi_k(\\omega) = \\arg\\{A_k(\\exp(j\\omega))\\}$。\n$$\nA_k(\\exp(j\\omega)) = \\frac{\\exp(-j\\omega) - a_k}{1 - a_k \\exp(-j\\omega)}.\n$$\n分子是 $N_k(\\omega) = \\exp(-j\\omega) - a_k = \\cos(\\omega) - a_k - j\\sin(\\omega)$。\n分母是 $D_k(\\omega) = 1 - a_k\\cos(\\omega) + ja_k\\sin(\\omega)$。\n相位是 $\\phi_k(\\omega) = \\arg\\{N_k(\\omega)\\} - \\arg\\{D_k(\\omega)\\}$。\n使用反正切函数，\n$$\n\\phi_k(\\omega) = \\arctan\\left(\\frac{-\\sin(\\omega)}{\\cos(\\omega) - a_k}\\right) - \\arctan\\left(\\frac{a_k\\sin(\\omega)}{1-a_k\\cos(\\omega)}\\right).\n$$\n$\\arctan(u(x))$ 的导数是 $\\frac{1}{1+u(x)^2} \\frac{du(x)}{dx}$。将此应用于两项并执行微分，得到一阶实系数全通节的著名结果：\n$$\n\\tau_{A_k}(\\omega) = -\\frac{d\\phi_k(\\omega)}{d\\omega} = \\frac{1 - a_k^2}{1 - 2a_k\\cos(\\omega) + a_k^2}.\n$$\n对所有 $M$ 个节求和，总群延迟为：\n$$\n\\tau_A(\\omega) = \\sum_{k=1}^{M} \\frac{1 - a_k^2}{1 - 2a_k\\cos(\\omega) + a_k^2}.\n$$\n\n其次，我们构建离散化的加权平方误差目标函数 $J(\\mathbf{a})$。连续平方误差范数由 $\\left\\| \\tau_A - \\tau_d \\right\\|_{2,w,\\Omega}^2 = \\int_{\\Omega} w(\\omega)\\,\\big(\\tau_A(\\omega)-\\tau_d(\\omega)\\big)^2\\,d\\omega$ 给出。该积分将通过在节点 $\\{\\omega_n\\}_{n=1}^{N}$（权重为 $\\{\\gamma_n\\}_{n=1}^{N}$）上的求积法则来近似。问题陈述意味着该求积法近似于加权积分，即 $\\int_{\\Omega} w(\\omega)f(\\omega)d\\omega \\approx \\sum_{n=1}^{N} \\gamma_n f(\\omega_n)$，其中权重 $\\gamma_n$ 包含了来自 $w(\\omega)$ 的信息。因此，我们令 $f(\\omega) = (\\tau_A(\\omega)-\\tau_d(\\omega))^2$。目标函数 $J(\\mathbf{a})$ 是离散化的平方误差：\n$$\nJ(\\mathbf{a}) = \\sum_{n=1}^{N} \\gamma_n \\left( \\tau_A(\\omega_n) - \\tau_d(\\omega_n) \\right)^2.\n$$\n代入推导出的 $\\tau_A(\\omega)$ 表达式：\n$$\nJ(\\mathbf{a}) = \\sum_{n=1}^{N} \\gamma_n \\left( \\left( \\sum_{k=1}^{M} \\frac{1 - a_k^2}{1 - 2a_k \\cos(\\omega_n) + a_k^2} \\right) - \\tau_d(\\omega_n) \\right)^2.\n$$\n\n第三，建立约束优化问题。我们寻求找到系数向量 $\\mathbf{a}$，以在给定的稳定性裕度约束下最小化目标函数 $J(\\mathbf{a})$。该问题是：\n$$\n\\min_{\\mathbf{a} \\in \\mathbb{R}^M} J(\\mathbf{a})\n$$\n约束条件为：\n$$\n|a_k| \\le \\rho \\quad \\text{for } k = 1, \\dots, M.\n$$\n这些约束等价于以下 $2M$ 个线性不等式组：\n$$\na_k - \\rho \\le 0 \\quad \\text{for } k = 1, \\dots, M,\n$$\n$$\n-a_k - \\rho \\le 0 \\quad \\text{for } k = 1, \\dots, M.\n$$\n\n第四，我们构造拉格朗日函数 $L(\\mathbf{a}, \\boldsymbol{\\mu}^+, \\boldsymbol{\\mu}^-)$。对于形式为 $\\min f(x)$ 且约束为 $g_i(x) \\le 0$ 的约束优化问题，其拉格朗日函数为 $L(x, \\lambda) = f(x) + \\sum_i \\lambda_i g_i(x)$，其中拉格朗日乘子 $\\lambda_i \\ge 0$ 为非负。在这里，目标是 $J(\\mathbf{a})$。约束是 $g_{k,1}(\\mathbf{a}) = a_k - \\rho \\le 0$ 和 $g_{k,2}(\\mathbf{a}) = -a_k - \\rho \\le 0$。相应的拉格朗日乘子给定为 $\\mu_k^+$ 和 $\\mu_k^-$。\n因此，拉格朗日函数为：\n$$\nL(\\mathbf{a}, \\boldsymbol{\\mu}^+, \\boldsymbol{\\mu}^-) = J(\\mathbf{a}) + \\sum_{k=1}^{M} \\mu_k^+ (a_k - \\rho) + \\sum_{k=1}^{M} \\mu_k^- (-a_k - \\rho).\n$$\n这可以更紧凑地写为：\n$$\nL(\\mathbf{a}, \\boldsymbol{\\mu}^+, \\boldsymbol{\\mu}^-) = J(\\mathbf{a}) + \\sum_{k=1}^{M} \\left[ \\mu_k^+ (a_k - \\rho) + \\mu_k^- (-a_k - \\rho) \\right].\n$$\n代入 $J(\\mathbf{a})$ 的完整表达式，得到拉格朗日函数的最终闭式表达式。\n$$\nL(\\mathbf{a}, \\boldsymbol{\\mu}^+, \\boldsymbol{\\mu}^-) = \\sum_{n=1}^{N} \\gamma_n \\left( \\left( \\sum_{k=1}^{M} \\frac{1 - a_k^2}{1 - 2a_k \\cos(\\omega_n) + a_k^2} \\right) - \\tau_d(\\omega_n) \\right)^2 + \\sum_{k=1}^{M} \\left[ \\mu_k^+ (a_k - \\rho) + \\mu_k^- (-a_k - \\rho) \\right].\n$$\n这就是所要求的用指定参数和变量表示的表达式。", "answer": "$$\n\\boxed{\\sum_{n=1}^{N} \\gamma_n \\left( \\left( \\sum_{k=1}^{M} \\frac{1 - a_k^2}{1 - 2a_k \\cos(\\omega_n) + a_k^2} \\right) - \\tau_d(\\omega_n) \\right)^2 + \\sum_{k=1}^{M} \\left( \\mu_k^+ (a_k - \\rho) + \\mu_k^- (-a_k - \\rho) \\right)}\n$$", "id": "2851788"}]}