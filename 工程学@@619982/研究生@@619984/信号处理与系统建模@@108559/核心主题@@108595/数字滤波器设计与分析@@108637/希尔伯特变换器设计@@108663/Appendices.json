{"hands_on_practices": [{"introduction": "窗函数法是一种从理想滤波器响应出发，设计FIR滤波器的直观且实用的技术。在此方法中，Kaiser窗因其在主瓣宽度（决定过渡带）和旁瓣电平（决定通带/阻带纹波）之间提供了灵活的权衡而备受青睐。本练习将带你亲手实践，如何根据给定的性能指标，如通带纹波$ \\delta $和过渡带宽$ \\Delta \\omega $，来估算设计一个带限希尔伯特变换器所需的Kaiser窗参数$ \\beta $和滤波器阶数$ N $ [@problem_id:2864565]。", "problem": "一个离散时间带限希尔伯特变换器是一种奇对称、线性相位的有限冲激响应滤波器，其理想频率响应在指定的通带内幅度近似为1，相位近似为 $-\\pi/2$。考虑使用凯撒窗对理想的奇对称冲激响应进行加窗，以设计此类滤波器。窗函数参数用 $\\beta$ 表示，滤波器阶数（比长度小一）用 $N$ 表示。假设可接受的最大通带幅度波纹为 $\\delta = 1.5 \\times 10^{-3}$（无量纲），每个通带边缘的过渡带宽为 $\\Delta \\omega = 0.08\\pi$ 弧度/采样点。目标滤波器必须满足III型线性相位滤波器的奇对称性要求。\n\n从窗函数法的角度出发，并利用凯撒窗广泛使用的、将其参数 $\\beta$ 与可达到的波纹水平以及其长度与可达到的过渡带宽联系起来的特性，推导出将 $\\delta$ 和 $\\Delta \\omega$ 与此带限希尔伯特变换器的 $\\beta$ 和 $N$ 联系起来的表达式。然后，对给定的 $\\delta$ 和 $\\Delta \\omega$ 计算这些表达式，以估计所需的 $\\beta$ 和最小的 $N$。施加III型线性相位的约束条件，即冲激响应的长度为奇数，也就是说，$N$ 必须是偶数。选择满足该指标的最小偶整数 $N$。\n\n将最终答案以行向量 $\\big[\\beta \\; N\\big]$ 的形式报告，其中 $\\beta$ 四舍五入到四位有效数字。所有角度量单位均为弧度/采样点，最终答案框中不应包含任何单位。", "solution": "该问题要求使用窗函数法和凯撒窗来设计一个离散时间带限希尔伯特变换器。这涉及确定必要的凯撒窗参数 $\\beta$ 和滤波器阶数 $N$，以满足指定的通带幅度波纹 $\\delta$ 和过渡带宽 $\\Delta\\omega$ 的性能标准。\n\n首先，我们推导滤波器指标 $(\\delta, \\Delta\\omega)$ 与设计参数 $(\\beta, N)$ 之间的关系。通过窗函数法设计有限冲激响应(FIR)滤波器，涉及将一个理想的无限冲激响应 $h_d[n]$ 与一个有限长度的窗函数 $w[n]$ 相乘。对于希尔伯特变换器，其理想频率响应在 $-\\pi < \\omega < \\pi$ 范围内为 $H_d(e^{j\\omega}) = -j \\cdot \\text{sgn}(\\omega)$。其对应的理想冲激响应是非因果且无限长的，由下式给出：\n$$\nh_d[n] = \n\\begin{cases}\n\\frac{2}{\\pi n} & \\text{for } n \\text{ odd} \\\\\n0 & \\text{for } n \\text{ even}\n\\end{cases}\n$$\n该响应具有奇对称性，即 $h_d[-n] = -h_d[n]$。\n\n为了创建一个阶数为 $N$（长度 $M=N+1$）的因果线性相位FIR滤波器，我们对该响应进行截断和移位。问题指定了一个III型线性相位滤波器，它要求长度为奇数且具有奇对称性。奇数长度 $M$ 意味着阶数 $N=M-1$ 必须是偶数。当 $N$ 为偶数时，通过对奇对称的 $h_d[n]$ 的居中版本进行加窗，可以自然地满足奇对称条件 $h[n] = -h[N-n]$。\n\n所得滤波器的性能由窗函数的特性决定。凯撒窗由其长度 $M=N+1$ 和一个参数 $\\beta$ 定义，该参数控制其傅里叶变换的主瓣宽度和旁瓣衰减之间的权衡。对于FIR滤波器设计，存在一些成熟的经验公式，可将滤波器指标与凯撒窗参数联系起来。\n\n最大通带波纹 $\\delta$ 主要由窗函数傅里叶变换的峰值旁瓣电平决定。这由 $\\beta$ 控制。这种关系通常通过所需的最小阻带衰减 $A$（以分贝为单位）来表示：\n$$ A = -20 \\log_{10}(\\delta) $$\n然后使用以下经验公式从 $A$ 估算参数 $\\beta$：\n$$\n\\beta = \n\\begin{cases}\n0.1102(A - 8.7), & A > 50 \\\\\n0.5842(A - 21)^{0.4} + 0.07886(A - 21), & 21 \\le A \\le 50 \\\\\n0, & A < 21\n\\end{cases}\n$$\n过渡带宽 $\\Delta\\omega$ 由窗函数傅里叶变换的主瓣宽度决定，该宽度与滤波器长度 $M$ 成反比。连接 $N$、$A$ 和 $\\Delta\\omega$ 的关系由下式给出：\n$$ N \\ge \\frac{A - 8}{2.285 \\Delta\\omega} $$\n这些经验公式虽然最初是为低通滤波器推导的，但也适用于希尔伯特变换器的设计。其基本原理是，窗函数的傅里叶变换与理想频率响应中的不连续点（对于希尔伯特变换器，在 $\\omega=0$ 和 $\\omega=\\pi$ 处）的卷积决定了滤波器的性能。波纹是由旁瓣泄漏引起的，而过渡带宽由主瓣宽度设定，与具体的理想滤波器类型无关。\n\n现在，我们根据给定的指标 $\\delta = 1.5 \\times 10^{-3}$ 和 $\\Delta\\omega = 0.08\\pi$ 来评估这些表达式。\n\n第1步：计算所需的衰减 $A$。\n$$ A = -20 \\log_{10}(1.5 \\times 10^{-3}) $$\n$$ A = -20 (\\log_{10}(1.5) - 3) \\approx -20(0.17609 - 3) = -20(-2.82391) \\approx 56.4782 \\text{ dB} $$\n\n第2步：计算凯撒窗参数 $\\beta$。\n由于 $A \\approx 56.48 \\text{ dB} > 50 \\text{ dB}$，我们使用 $\\beta$ 公式的第一种情况：\n$$ \\beta = 0.1102(A - 8.7) $$\n$$ \\beta = 0.1102(56.4782 - 8.7) = 0.1102(47.7782) \\approx 5.26515764 $$\n按要求四舍五入到四位有效数字，我们得到 $\\beta = 5.265$。\n\n第3步：估计最小滤波器阶数 $N$。\n使用 $N$ 的公式以及计算出的 $A$ 值和给定的 $\\Delta\\omega$：\n$$ N \\ge \\frac{A - 8}{2.285 \\Delta\\omega} $$\n$$ N \\ge \\frac{56.4782 - 8}{2.285 \\times 0.08\\pi} = \\frac{48.4782}{0.1828\\pi} \\approx \\frac{48.4782}{0.57428} \\approx 84.417 $$\n\n第4步：应用问题约束来确定 $N$ 的最终值。\n滤波器阶数 $N$ 必须是整数。此外，对于III型线性相位滤波器，其长度 $N+1$ 必须为奇数，这意味着阶数 $N$ 必须是偶数。因此，我们必须选择满足条件 $N \\ge 84.417$ 的最小偶数。满足此条件的整数为 $85, 86, 87, \\dots$。此序列中最小的偶数是 $86$。\n因此，所需的滤波器阶数为 $N=86$。\n\n凯撒窗和滤波器阶数的估计所需参数为 $\\beta \\approx 5.265$ 和 $N = 86$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5.265 & 86\n\\end{pmatrix}\n}\n$$", "id": "2864565"}, {"introduction": "理论设计与物理实现之间总有差距，滤波器系数在硬件实现中常会因为量化或误差而偏离理想值。这个练习将探讨这种不完美性的具体影响，特别是对于希尔伯特变换器，其脉冲响应的奇对称性至关重要。你将通过一个假设的系数失配场景，精确计算由此产生的正交泄漏，并理解它如何破坏理想的单边频谱特性 [@problem_id:2864634]。", "problem": "给定一个离散时间、非因果的有限冲激响应 (FIR) 希尔伯特变换器候选，其冲激响应长度为7，定义在索引 $n \\in \\{-3,-2,-1,0,1,2,3\\}$ 上。其冲激响应定义如下\n$$\nh[-3] = b,\\quad h[-1] = a + \\delta,\\quad h[0] = 0,\\quad h[1] = -(a - \\delta),\\quad h[3] = -b,\n$$\n对于所有其他 $n$，$h[n]=0$，其中 $a$ 和 $b$ 是实数设计参数，选择它们是为了在通带内近似理想希尔伯特变换器的幅值，而 $\\delta$ 用于模拟因实现误差导致的微小系数失配。设失配固定为 $\\delta = \\frac{1}{64}$。\n\n设 $H(e^{j\\omega})$ 表示 $h[n]$ 的离散时间傅里叶变换 (DTFT)。在理想的希尔伯特变换器中，频率响应在通带上是纯虚数，因此 $H(e^{j\\omega})$ 的任何非零实部都可以被解释为破坏解析信号形成的正交泄漏，其中解析信号形成为 $x_{\\mathrm{a}}[n] = x[n] + j\\,\\hat{x}[n]$，而 $\\hat{x}[n]$ 是 $x[n]$ 的希尔伯特变换。\n\n假设感兴趣的通带为\n$$\n\\omega \\in [\\omega_{\\mathrm{p}},\\,\\pi - \\omega_{\\mathrm{p}}],\\quad \\text{其中}\\ \\omega_{\\mathrm{p}} = \\frac{\\pi}{5}.\n$$\n从离散时间傅里叶变换 (DTFT) 和线性时不变系统频率响应的定义出发，计算在指定通带上 $|\\Re\\{H(e^{j\\omega})\\}|$ 的最大值。将您的答案表示为单个闭式解析表达式。角度以弧度为单位。无需四舍五入。将最终值报告为无量纲标量。最后，简要解释此最大值，作为衡量影响解析分离的正交泄漏的指标。", "solution": "第一步是计算频率响应 $H(e^{j\\omega})$，即冲激响应 $h[n]$ 的离散时间傅里叶变换 (DTFT)。DTFT 的定义为：\n$$\nH(e^{j\\omega}) = \\sum_{n=-\\infty}^{\\infty} h[n] e^{-j\\omega n}\n$$\n代入给定的 $h[n]$ 的非零系数：\n$$\nH(e^{j\\omega}) = h[-3]e^{j3\\omega} + h[-1]e^{j\\omega} + h[1]e^{-j\\omega} + h[3]e^{-j3\\omega}\n$$\n$$\nH(e^{j\\omega}) = b e^{j3\\omega} + (a + \\delta)e^{j\\omega} - (a - \\delta)e^{-j\\omega} - b e^{-j3\\omega}\n$$\n我们对各项进行分组，以利用欧拉恒等式 $e^{jx} - e^{-jx} = 2j\\sin(x)$ 和 $e^{jx} + e^{-jx} = 2\\cos(x)$：\n$$\nH(e^{j\\omega}) = b(e^{j3\\omega} - e^{-j3\\omega}) + a(e^{j\\omega} - e^{-j\\omega}) + \\delta(e^{j\\omega} + e^{-j\\omega})\n$$\n$$\nH(e^{j\\omega}) = b(2j\\sin(3\\omega)) + a(2j\\sin(\\omega)) + \\delta(2\\cos(\\omega))\n$$\n重新整理以分离实部和虚部：\n$$\nH(e^{j\\omega}) = 2\\delta\\cos(\\omega) + j(2a\\sin(\\omega) + 2b\\sin(3\\omega))\n$$\n理想的离散时间希尔伯特变换器具有纯虚数的频率响应。$H(e^{j\\omega})$ 的实部完全源于系数失配 $\\delta$，它破坏了冲激响应的完美反对称性（$h[n] = -h[-n]$）。具体来说，$h[-1] \\neq -h[1]$。这个实部是正交泄漏的来源。根据上述表达式，实部为：\n$$\n\\Re\\{H(e^{j\\omega})\\} = 2\\delta\\cos(\\omega)\n$$\n问题要求在指定的通带 $\\omega \\in [\\frac{\\pi}{5}, \\pi - \\frac{\\pi}{5}]$ 上找到 $|\\Re\\{H(e^{j\\omega})\\}|$ 的最大值。因此我们必须求：\n$$\n\\max_{\\omega \\in [\\frac{\\pi}{5}, \\frac{4\\pi}{5}]} |2\\delta\\cos(\\omega)|\n$$\n代入给定值 $\\delta = \\frac{1}{64}$：\n$$\n|2\\delta\\cos(\\omega)| = \\left|2 \\cdot \\frac{1}{64} \\cos(\\omega)\\right| = \\left|\\frac{1}{32}\\cos(\\omega)\\right| = \\frac{1}{32}|\\cos(\\omega)|\n$$\n任务简化为在闭区间 $[\\frac{\\pi}{5}, \\frac{4\\pi}{5}]$ 上找到 $|\\cos(\\omega)|$ 的最大值。\n我们来分析函数 $f(\\omega) = \\cos(\\omega)$ 在此区间上的行为。余弦函数在 $[0, \\pi]$ 上单调递减，该区间包含了我们感兴趣的区间。\n在区间的端点处：\n- 对于 $\\omega = \\frac{\\pi}{5}$，$\\cos(\\frac{\\pi}{5}) > 0$。\n- 对于 $\\omega = \\frac{4\\pi}{5}$，$\\cos(\\frac{4\\pi}{5}) = \\cos(\\pi - \\frac{\\pi}{5}) = -\\cos(\\frac{\\pi}{5}) < 0$。\n函数 $\\cos(\\omega)$ 在 $\\omega = \\frac{\\pi}{2}$ 处穿过零点，该点位于区间 $[\\frac{\\pi}{5}, \\frac{4\\pi}{5}]$ 内。\n我们必须最大化的函数是 $|\\cos(\\omega)|$。在子区间 $[\\frac{\\pi}{5}, \\frac{\\pi}{2}]$ 上， $|\\cos(\\omega)| = \\cos(\\omega)$，其值从 $\\cos(\\frac{\\pi}{5})$ 减小到 $0$。在子区间 $[\\frac{\\pi}{2}, \\frac{4\\pi}{5}]$ 上， $|\\cos(\\omega)| = -\\cos(\\omega)$，其值从 $0$ 增加到 $-\\cos(\\frac{4\\pi}{5}) = \\cos(\\frac{\\pi}{5})$。\n因此，在整个区间 $[\\frac{\\pi}{5}, \\frac{4\\pi}{5}]$ 上，$|\\cos(\\omega)|$ 的最大值在两个端点 $\\omega = \\frac{\\pi}{5}$ 和 $\\omega = \\frac{4\\pi}{5}$ 处取得，且该最大值为 $\\cos(\\frac{\\pi}{5})$。\n$|\\Re\\{H(e^{j\\omega})\\}|$ 的最大值为：\n$$\n\\frac{1}{32} \\max_{\\omega \\in [\\frac{\\pi}{5}, \\frac{4\\pi}{5}]} |\\cos(\\omega)| = \\frac{1}{32}\\cos\\left(\\frac{\\pi}{5}\\right)\n$$\n为了提供一个更明确的闭式表达式，我们使用已知值 $\\cos(\\frac{\\pi}{5}) = \\frac{1+\\sqrt{5}}{4}$。\n$$\n\\max |\\Re\\{H(e^{j\\omega})\\}| = \\frac{1}{32} \\left(\\frac{1+\\sqrt{5}}{4}\\right) = \\frac{1+\\sqrt{5}}{128}\n$$\n该值代表了通带内的最大正交泄漏。在形成解析信号 $x_{\\mathrm{a}}[n] = x[n] + j\\hat{x}[n]$ 时，希尔伯特变换分量的频谱由 $\\hat{X}(e^{j\\omega}) = H(e^{j\\omega})X(e^{j\\omega})$ 给出。$H(e^{j\\omega})$ 的非零实部导致信号在正频率处的分量泄漏到 $x_{\\mathrm{a}}[n]$ 频谱中的负频率处，反之亦然。这破坏了解析信号频谱的理想单边特性。数值 $\\frac{1+\\sqrt{5}}{128}$ 量化了通带内任意频率下这种泄漏相对于输入信号幅度的最坏情况下的幅值，因此可作为衡量该滤波器在实现完美正交分离方面不完美程度的直接指标。", "answer": "$$\n\\boxed{\\frac{1+\\sqrt{5}}{128}}\n$$", "id": "2864634"}, {"introduction": "超越窗函数等启发式方法，现代滤波器设计大多基于数值优化以寻求数学上的“最优”解。然而，定义何为“最优”是关键的第一步，这需要一个精确且数学上稳健的目标函数。本练习将挑战你评估不同的性能度量标准，并强调那些能够避免模糊性（如相位缠绕）且能构成凸优化问题的准则的重要性，而这正是诸如Parks-McClellan等先进算法的基石 [@problem_id:2864574]。", "problem": "您的任务是设计一个实系数有限冲激响应 (FIR) 离散时间希尔伯特变换器，其通带不包含直流和奈奎斯特频率附近的区域。设滤波器长度为奇整数 $N$，固定整数延迟为 $D = (N-1)/2$，通带为 $\\Omega_p = [\\omega_L, \\pi - \\omega_L]$，其中 $0 < \\omega_L < \\pi/2$。期望的频率响应是具有线性相位 $e^{-j \\omega D}$ 和正交相移的理想离散时间希尔伯特变换器的响应：在正通带频率 $0 < \\omega \\in \\Omega_p$ 上，期望值为 $-j e^{-j \\omega D}$，根据实系数的共轭对称性，这意味着在负频率 $-\\omega \\in -\\Omega_p$ 上的期望值为 $+j e^{-j \\omega D}$。实际滤波器的频率响应为 $H(e^{j\\omega})$，它通过恒等式 $H(e^{j\\omega}) = \\sum_{n=0}^{N-1} h[n] e^{-j \\omega n}$ 与 FIR 系数成仿射关系。\n\n将通带上的幅度误差定义为 $\\epsilon_A(\\omega) = |H(e^{j\\omega})| - 1$，将相对于期望正交相位的通带相位误差定义为 $\\epsilon_{\\phi}(\\omega) = \\angle H(e^{j\\omega}) - \\angle H_d(e^{j\\omega})$，其中 $H_d(e^{j\\omega})$ 是上述的理想响应。\n\n您正在考虑用于极小化极大 (Chebyshev) 设计的标量性能度量，该设计旨在最小化 $\\Omega_p$ 上的最坏情况误差。为此目的，一个良态的标量度量应满足以下所有性质：\n(i) 在 $\\Omega_p$ 上是良定义的，没有由 $2\\pi$ 相位卷绕引起的歧义，\n(ii) 有意义地捕捉希尔伯特变换器在通带内实现单位幅度和 $\\pm \\pi/2$ 相位正交的目标（经 $e^{j \\omega D}$ 解调后），以及\n(iii) 对于在近似 $\\Omega_p$ 的密集频率网格上的 Chebyshev 优化，容许一个关于 FIR 系数的凸公式。\n\n考虑以下候选标量准则。哪些子集满足性质 (i)–(iii)？\n\nA. 联合最坏情况幅度和相位偏差界限：\n最小化标量 $\\delta \\ge 0$，约束条件为，对于所有 $\\omega \\in \\Omega_p$，\n$|\\ |H(e^{j\\omega})| - 1\\ | \\le \\delta$ 且 $|\\ \\angle(e^{j\\omega D} H(e^{j\\omega})) - \\operatorname{sgn}(\\omega)\\ \\pi/2\\ | \\le \\delta$。\n\nB. 通带上与解调后理想响应的复 Chebyshev 误差：\n最小化 $\\sup_{\\omega \\in \\Omega_p} \\left| e^{j \\omega D} H(e^{j\\omega}) - \\big(-j\\big)\\ \\operatorname{sgn}(\\omega) \\right|$。\n\nC. 仅在正通带上对解调后实部和虚部的分量式 Chebyshev 界限：\n设 $G(\\omega) = e^{j \\omega D} H(e^{j\\omega})$。在 $\\Omega_p^+ = [\\omega_L, \\pi - \\omega_L]$ 上，最小化 $\\max\\left\\{ \\sup_{\\omega \\in \\Omega_p^+} \\left| \\Re\\{G(\\omega)\\} \\right|,\\ \\sup_{\\omega \\in \\Omega_p^+} \\left| \\Im\\{G(\\omega)\\} + 1 \\right| \\right\\}$。\n\nD. 对数幅度波纹和群延迟偏差：\n最小化 $\\sup_{\\omega \\in \\Omega_p} \\left| \\log |H(e^{j\\omega})| \\right|$，约束条件为 $\\sup_{\\omega \\in \\Omega_p} \\left| - \\frac{d}{d\\omega}\\ \\angle H(e^{j\\omega}) - D \\right| \\le \\delta$（对于某个 $\\delta \\ge 0$）。\n\nE. 幅度与相位偏差的欧几里得组合：\n最小化 $\\sup_{\\omega \\in \\Omega_p} \\sqrt{ \\left( |H(e^{j\\omega})| - 1 \\right)^2 + \\left( \\angle(e^{j\\omega D} H(e^{j\\omega})) - \\operatorname{sgn}(\\omega)\\ \\pi/2 \\right)^2 }$。\n\n选择所有适用项。", "solution": "所提出的问题是评估用于实系数有限冲激响应 (FIR) 希尔伯特变换器的极小化极大设计的几种候选准则。一个有效的准则必须满足三个性质：(i) 良定义，无相位卷绕歧义；(ii) 有意义地捕捉设计目标；(iii) 容许凸公式。\n\n该 FIR 滤波器具有实系数 $h[n]$，奇数长度 $N$，以及整数延迟 $D = (N-1)/2$。其频率响应为 $H(e^{j\\omega}) = \\sum_{n=0}^{N-1} h[n] e^{-j\\omega n}$。由于 $h[n]$ 是实数，因此有 $H(e^{-j\\omega}) = H^*(e^{j\\omega})$。\n\n在通带 $\\Omega_p = [\\omega_L, \\pi - \\omega_L]$ 内的正频率的理想响应是 $H_d(e^{j\\omega}) = -j e^{-j\\omega D}$。\n为简化分析，我们考虑解调后的频率响应 $G(\\omega) = e^{j\\omega D} H(e^{j\\omega})$。理想的解调响应为 $G_d(\\omega) = e^{j\\omega D} H_d(e^{j\\omega})$。\n对于 $\\omega \\in \\Omega_p$（即 $\\omega > 0$），$G_d(\\omega) = e^{j\\omega D} (-j e^{-j\\omega D}) = -j$。\n对于实系数滤波器，负频率处的响应由对称性决定。对于 $\\omega > 0$，$G(-\\omega) = e^{-j\\omega D} H(e^{-j\\omega}) = e^{-j\\omega D} H^*(e^{j\\omega}) = (e^{j\\omega D} H(e^{j\\omega}))^* = G^*(\\omega)$。\n因此，负频率处的理想响应必须是 $G_d(-\\omega) = G_d^*(\\omega) = (-j)^* = +j$。\n合并后的理想解调响应为 $G_d(\\omega) = -j \\operatorname{sgn}(\\omega)$，适用于整个通带 $[-\\pi+\\omega_L, -\\omega_L] \\cup [\\omega_L, \\pi-\\omega_L]$。目标是使 $G(\\omega) \\approx G_d(\\omega)$。这要求 $\\Re\\{G(\\omega)\\} \\approx 0$ 且 $\\Im\\{G(\\omega)\\} \\approx -\\operatorname{sgn}(\\omega)$。\n\n任何有效的优化准则都必须能表示为关于系数 $h[n]$ 的凸优化问题。函数 $G(\\omega)$ 是系数 $h[n]$ 的线性组合：\n$G(\\omega) = \\sum_{n=0}^{N-1} h[n] e^{-j\\omega(n-D)}$。\n因此，$\\Re\\{G(\\omega)\\}$ 和 $\\Im\\{G(\\omega)\\}$ 也是 $h[n]$ 的线性函数。形式为 $\\min \\sup |L(\\mathbf{h})|$ 的问题，其中 $L(\\mathbf{h})$ 是系数 $\\mathbf{h} = (h[0], \\dots, h[N-1])$ 的仿射函数，是凸问题。\n\n我们现在根据这三个必需的性质来评估每个选项。\n\n**A. 联合最坏情况幅度和相位偏差界限**\n该准则旨在最小化 $\\delta$，约束条件为 $|\\ |H(e^{j\\omega})| - 1\\ | \\le \\delta$ 和 $|\\ \\angle(e^{j\\omega D} H(e^{j\\omega})) - \\operatorname{sgn}(\\omega)\\ \\pi/2\\ | \\le \\delta$。\n\n(i) **良定义性**：该准则涉及角度函数 $\\angle(\\cdot)$。复数的角度定义在模 $2\\pi$ 的意义下。如果参数 $e^{j\\omega D} H(e^{j\\omega})$ 随着 $\\omega$ 的变化穿过负实轴，其相位会跳变 $2\\pi$。优化算法可能产生一个解，使得卷绕后的相位误差很小，而真实的、未卷绕的相位误差很大。这种歧义使得该准则对于优化是病态的。\n(ii) **有意义性**：目标解调相位被给出为 $\\operatorname{sgn}(\\omega)\\pi/2$。然而，我们从问题本身的理想响应 $H_d(e^{j\\omega})$ 推导出的目标相位是 $-\\operatorname{sgn}(\\omega)\\pi/2$。这代表了一个符号矛盾，意味着该准则并未以指定的理想滤波器为目标。即使这个符号被纠正，该准则将幅度和相位误差分开处理，其效果可能不如直接控制复数误差。\n(iii) **凸性**：约束 $|\\ |H(e^{j\\omega})| - 1\\ | \\le \\delta$ 不是凸的。函数 $|H(e^{j\\omega})|$ 关于 $h[n]$是凸的，但满足 $||x|-1| \\le \\delta$ 的点集 $x$ 不是一个凸集。此外，相位函数 $\\angle(\\cdot)$ 是非线性和非凸的。因此，该公式不是一个凸优化问题。\n\n该选项在所有三个性质上均不满足。**不正确**。\n\n**B. 通带上与解调后理想响应的复 Chebyshev 误差**\n该准则是最小化 $\\sup_{\\omega \\in \\Omega_p} \\left| e^{j \\omega D} H(e^{j\\omega}) - (-j)\\ \\operatorname{sgn}(\\omega) \\right|$。在指定的通带 $\\Omega_p = [\\omega_L, \\pi - \\omega_L]$（其中 $\\omega>0$）上，这简化为最小化 $\\sup_{\\omega \\in \\Omega_p} |G(\\omega) - (-j)| = \\sup_{\\omega \\in \\Omega_p} |G(\\omega) + j|$。\n\n(i) **良定义性**：该准则基于复值误差向量 $G(\\omega) - G_d(\\omega)$ 的模。它不使用角度函数，因此没有相位卷绕歧义。\n(ii) **有意义性**：该度量最小化了实际解调响应 $G(\\omega)$ 与理想响应 $G_d(\\omega) = -j$ 在复平面中的最大距离。从几何上看，它迫使 $G(\\omega)$ 对于所有 $\\omega \\in \\Omega_p$ 都位于以 $-j$ 为中心、半径最小的圆盘内。这同时且有意义地控制了幅度和相位朝向理想值的偏差。由于对称性 $G(-\\omega) = G^*(\\omega)$，负频率处的误差 $|G(-\\omega) - (+j)| = |G^*(\\omega) - j| = |(G(\\omega)+j)^*| = |G(\\omega)+j|$ 也被自动地一并最小化。\n(iii) **凸性**：该问题是 $\\min_{\\mathbf{h}, \\delta} \\delta$，约束条件为 $|G(\\omega) + j| \\le \\delta$ 对所有 $\\omega \\in \\Omega_p$ 成立。由于 $G(\\omega)$ 是系数 $\\mathbf{h}$ 的线性函数，函数 $G(\\omega)+j$ 关于 $\\mathbf{h}$ 是仿射的。约束 $| \\text{affine}(\\mathbf{h}) | \\le \\delta$ 是一个二阶锥约束，它是凸的。整个问题是一个二阶锥规划 (SOCP)，是一种凸优化问题。\n\n该选项满足所有三个性质。**正确**。\n\n**C. 仅在正通带上对解调后实部和虚部的分量式 Chebyshev 界限**\n该准则是最小化 $\\max\\left\\{ \\sup_{\\omega \\in \\Omega_p^+} \\left| \\Re\\{G(\\omega)\\} \\right|,\\ \\sup_{\\omega \\in \\Omega_p^+} \\left| \\Im\\{G(\\omega)\\} + 1 \\right| \\right\\}$，在 $\\Omega_p^+ = [\\omega_L, \\pi - \\omega_L]$ 上进行。\n\n(i) **良定义性**：该准则使用 $G(\\omega)$ 的实部和虚部，它们是单值连续函数。没有相位卷绕歧义。\n(ii) **有意义性**：对于 $\\omega > 0$，理想响应是 $G_d(\\omega) = -j$，所以 $\\Re\\{G_d(\\omega)\\} = 0$ 和 $\\Im\\{G_d(\\omega)\\} = -1$。该准则分别最小化实部和虚部上的最坏情况误差。从几何上看，它迫使 $G(\\omega)$ 位于以 $-j$ 为中心、边长最小的正方形内。这是强制实现设计目标的一种直接而有意义的方式。由于对称性，仅限于正通带 $\\Omega_p^+$ 是足够的：如引言分析所示，控制 $\\omega > 0$ 的误差会自动控制 $\\omega < 0$ 的误差。\n(iii) **凸性**：该问题是 $\\min_{\\mathbf{h}, \\delta} \\delta$，约束条件为 $|\\Re\\{G(\\omega)\\}| \\le \\delta$ 和 $|\\Im\\{G(\\omega)\\}+1| \\le \\delta$ 对于所有 $\\omega \\in \\Omega_p^+$ 成立。由于 $\\Re\\{G(\\omega)\\}$ 和 $\\Im\\{G(\\omega)\\}$ 是 $\\mathbf{h}$ 的线性函数，这些约束等价于 $-\\delta \\le \\Re\\{G(\\omega)\\} \\le \\delta$ 和 $-\\delta \\le \\Im\\{G(\\omega)\\}+1 \\le \\delta$，这些都是线性不等式。因此，该问题是一个线性规划 (LP)，是一种经典的凸优化问题。\n\n该选项满足所有三个性质。**正确**。\n\n**D. 对数幅度波纹和群延迟偏差**\n该准则是最小化 $\\sup_{\\omega \\in \\Omega_p} \\left| \\log |H(e^{j\\omega})| \\right|$，并对群延迟偏差施加约束 $\\sup_{\\omega \\in \\Omega_p} \\left| - \\frac{d}{d\\omega}\\ \\angle H(e^{j\\omega}) - D \\right| \\le \\delta$。\n\n(i) **良定义性**：群延迟 $\\tau_g(\\omega) = - \\frac{d}{d\\omega}\\ \\angle H(e^{j\\omega})$ 是根据未卷绕相位的导数定义的。与选项 A 一样，相位角函数及其导数的存在使得该公式易受卷绕问题影响，并且对于标准数值优化来说是病态的。\n(ii) **有意义性**：将群延迟约束在常数 $D$ 附近可强制实现线性相位，但它没有指定希尔伯特变换器所需的 $\\pm \\pi/2$ 相位*偏移*。此准则适用于通用线性相位滤波器，因此对于希尔伯特变换器来说是不完整的规范。\n(iii) **凸性**：对数幅度函数 $\\log|H(e^{j\\omega})|$ 和群延迟函数 $\\tau_g(\\omega)$ 都不是滤波器系数 $\\mathbf{h}$ 的凸函数或仿射函数。因此，该公式不是一个凸优化问题。\n\n该选项在所有三个性质上均不满足。**不正确**。\n\n**E. 幅度与相位偏差的欧几里得组合**\n该准则是最小化 $\\sup_{\\omega \\in \\Omega_p} \\sqrt{ \\left( |H(e^{j\\omega})| - 1 \\right)^2 + \\left( \\angle(e^{j\\omega D} H(e^{j\\omega})) - \\operatorname{sgn}(\\omega)\\ \\pi/2 \\right)^2 }$。\n\n(i) **良定义性**：与选项 A 和 D 一样，此准则使用了有歧义的角度函数 $\\angle(\\cdot)$，因此存在潜在的相位卷绕问题。\n(ii) **有意义性**：该选项与选项 A 一样，在目标相位上存在相同的符号不匹配问题。\n(iii) **凸性**：该目标函数是关于滤波器系数 $\\mathbf{h}$ 的非凸函数（角度函数、幅度之差的幅度）的复合。得到的优化问题不是凸的。\n\n该选项在所有三个性质上均不满足。**不正确**。\n\n基于严谨的分析，只有选项 B 和 C 代表了用于设计极小化极大 FIR 希尔伯特变换器的良态的、有意义的且可凸公式化的准则。", "answer": "$$\\boxed{BC}$$", "id": "2864574"}]}