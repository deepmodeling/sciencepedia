{"hands_on_practices": [{"introduction": "IIR 系统的核心在于其 Z 域传递函数 $H(z)$ 与时域脉冲响应 $h[n]$ 之间的深刻联系。虽然查阅 Z 变换表可以快速找到常见函数的对应关系，但从第一性原理出发进行推导，能让我们更深入地理解系统行为的本质。本练习将指导你基于最基本的几何级数，推导出一个具有重极点的通用 IIR 系统的脉冲响应，揭示极点如何通过指数项和多项式因子共同决定系统的动态特性 [@problem_id:2878198]。", "problem": "考虑一个因果线性时不变 (LTI) 离散时间无限冲激响应 (IIR) 系统，其传递函数以部分分式形式由下式给出：\n$$\nH(z) \\;=\\; \\sum_{k=1}^{K} \\sum_{m=1}^{M_k} \\frac{c_{k,m}}{\\left(1 - p_k z^{-1}\\right)^{m}},\n$$\n其中，不同的极点为 $\\{p_k\\}_{k=1}^{K}$，对于所有 $k$ 均有 $|p_k|1$，每个极点的重数为 $M_k \\in \\mathbb{N}$，且系数 $\\{c_{k,m}\\}$ 为复数。假设收敛域为 $|z|\\max_k |p_k|$，因此该系统是因果且稳定的。从第一性原理出发，即双边 Z 变换的定义 $X(z) = \\sum_{n=-\\infty}^{\\infty} x[n] z^{-n}$ 以及可由几何级数 $\\sum_{n=0}^{\\infty} r^{n} = \\frac{1}{1-r}$ (其中 $|r|1$) 推导出的基本级数恒等式，推导时域冲激响应 $h[n]$ 的显式闭式表达式，该表达式用 $\\{c_{k,m}\\}$、$\\{p_k\\}$ 和 $n$ 表示，并阐明由重复极点（即 $m1$）产生的 n 的多项式因子。你的推导应从第一性原理证明这些多项式因子的出现及其确切形式，而不应直接使用已知的针对重复极点的变换对。\n\n使用单位阶跃序列 $u[n]$，将你的最终答案表示为对所有整数 $n$ 均有效的 $h[n]$ 的单一解析表达式。最终答案中不要提供中间步骤。不需要进行数值计算。", "solution": "所给问题是离散时间线性时不变系统分析中的一个标准理论练习。对问题陈述进行严格验证是进行任何分析工作的必要前提。\n\n首先，我们逐字提取给定信息。\n- **系统**：因果、线性时不变 (LTI)、离散时间、无限冲激响应 (IIR)。\n- **传递函数**：$H(z) \\;=\\; \\sum_{k=1}^{K} \\sum_{m=1}^{M_k} \\frac{c_{k,m}}{\\left(1 - p_k z^{-1}\\right)^{m}}$。\n- **极点**：$\\{p_k\\}_{k=1}^{K}$ 是不同的复数，且 $|p_k|1$。\n- **重数**：$M_k \\in \\mathbb{N}$ 是极点 $p_k$ 的重数。\n- **系数**：$\\{c_{k,m}\\}$ 是复数。\n- **收敛域 (ROC)**：$|z|\\max_k |p_k|$。\n- **基本假设**：\n    1.  双边 Z 变换：$X(z) = \\sum_{n=-\\infty}^{\\infty} x[n] z^{-n}$。\n    2.  几何级数：$\\sum_{n=0}^{\\infty} r^{n} = \\frac{1}{1-r}$，其中 $|r|1$。\n- **目标**：从第一性原理推导冲激响应 $h[n]$，解释重复极点产生多项式因子的原因。结果必须是使用单位阶跃序列 $u[n]$（定义为当 $n \\ge 0$ 时为 1，当 $n  0$ 时为 0）的闭式表达式。\n\n接下来，我们验证问题陈述。\n该问题在科学上植根于成熟的数字信号处理理论。所有术语和概念，如 Z 变换、LTI 系统、因果性、稳定性以及部分分式展开，都是标准的且定义明确。问题的结构是直接的数学推导。给定条件——$|p_k|1$ 和收敛域 $|z|  \\max_k|p_k|$——正确地对应于一个因果且稳定的系统。这个问题是自洽的、一致的、适定的，要求从前提推导出唯一且有意义的解。它既不琐碎，也非故弄玄虚，因为从第一性原理推导重复极点需要一些不那么显而易见的步骤。因此，该问题是有效的。\n\n我们开始推导。\n\n目标是求冲激响应 $h[n]$，它是传递函数 $H(z)$ 的 Z 逆变换。Z 变换是线性算子。因此，和的逆变换等于逆变换的和：\n$$ h[n] = \\mathcal{Z}^{-1}\\{H(z)\\} = \\mathcal{Z}^{-1}\\left\\{ \\sum_{k=1}^{K} \\sum_{m=1}^{M_k} \\frac{c_{k,m}}{\\left(1 - p_k z^{-1}\\right)^{m}} \\right\\} = \\sum_{k=1}^{K} \\sum_{m=1}^{M_k} c_{k,m} \\mathcal{Z}^{-1}\\left\\{ \\frac{1}{\\left(1 - p_k z^{-1}\\right)^{m}} \\right\\} $$\n我们的任务简化为求通项 $G_{k,m}(z) = \\left(1 - p_k z^{-1}\\right)^{-m}$ 的 Z 逆变换。\n\n让我们从 $m=1$ 的基本情况开始。我们需要求 $G_{k,1}(z) = \\frac{1}{1-p_k z^{-1}}$ 的逆变换。给定几何级数恒等式：\n$$ \\sum_{n=0}^{\\infty} r^n = \\frac{1}{1-r}, \\quad \\text{for } |r|1 $$\n令 $r = p_k z^{-1}$。收敛条件变为 $|p_k z^{-1}|  1$，即 $|z|  |p_k|$。这与给定的因果系统的收敛域一致，因为 $|z|  \\max_j |p_j| \\ge |p_k|$。将 $r = p_k z^{-1}$ 代入级数恒等式得到：\n$$ G_{k,1}(z) = \\frac{1}{1-p_k z^{-1}} = \\sum_{n=0}^{\\infty} (p_k z^{-1})^n = \\sum_{n=0}^{\\infty} (p_k^n) z^{-n} $$\n根据定义，序列 $x[n]$ 的 Z 变换为 $X(z) = \\sum_{n=-\\infty}^{\\infty} x[n] z^{-n}$。将此定义与我们的级数展开式进行比较，可以确定相应的时域序列。该序列在 $n \\ge 0$ 时为 $p_k^n$，其他情况下为 0。这正是 $p_k^n u[n]$。因此，我们得到以下变换对：\n$$ p_k^n u[n] \\quad \\overset{\\mathcal{Z}}{\\longleftrightarrow} \\quad \\frac{1}{1-p_k z^{-1}} $$\n\n现在，我们必须处理重复极点的情况，即 $m1$。题目禁止使用预先记忆的变换对。我们必须从第一性原理推导结果。一种严谨的方法是对几何级数恒等式关于参数 $r$ 求导。在收敛半径内，幂级数的逐项求导是有效的。\n从恒等式开始：\n$$ (1-r)^{-1} = \\sum_{n=0}^{\\infty} r^n $$\n两边对 $r$ 求导得到：\n$$ \\frac{d}{dr}(1-r)^{-1} = (-1)(1-r)^{-2}(-1) = (1-r)^{-2} $$\n$$ \\frac{d}{dr}\\sum_{n=0}^{\\infty} r^n = \\sum_{n=0}^{\\infty} n r^{n-1} = \\sum_{n=1}^{\\infty} n r^{n-1} $$\n让我们通过令 $j=n-1$ (即 $n=j+1$) 来平移求和索引。和式变为 $\\sum_{j=0}^{\\infty} (j+1) r^j$。再次使用 $n$ 作为索引，我们得到：\n$$ (1-r)^{-2} = \\sum_{n=0}^{\\infty} (n+1) r^n $$\n这个结果可以通过重复求导来推广。$(1-r)^{-1}$ 关于 $r$ 的 $(m-1)$ 阶导数是：\n$$ \\frac{d^{m-1}}{dr^{m-1}}(1-r)^{-1} = (m-1)! (1-r)^{-m} $$\n对级数侧进行同样的求导：\n$$ \\frac{d^{m-1}}{dr^{m-1}}\\sum_{n=0}^{\\infty} r^n = \\sum_{n=m-1}^{\\infty} n(n-1)\\cdots(n-m+2) r^{n-(m-1)} $$\n递减整数的乘积可以用阶乘和二项式系数表示：\n$$ n(n-1)\\cdots(n-m+2) = \\frac{n!}{(n-(m-1))!} = (m-1)! \\binom{n}{m-1} $$\n所以我们有：\n$$ (m-1)! (1-r)^{-m} = \\sum_{n=m-1}^{\\infty} (m-1)! \\binom{n}{m-1} r^{n-m+1} $$\n除以 $(m-1)!$ 并将求和索引更改为 $j = n-(m-1)$ (即 $n=j+m-1$)：\n$$ (1-r)^{-m} = \\sum_{j=0}^{\\infty} \\binom{j+m-1}{m-1} r^j $$\n项 $\\binom{j+m-1}{m-1} = \\frac{(j+m-1)!}{j!(m-1)!}$ 是一个关于 $j$ 的 $m-1$ 次多项式，这正是问题陈述中要求的多项式因子的来源。\n现在，我们将 $r = p_k z^{-1}$ 代回到这个广义恒等式中。使用 $n$ 作为求和索引：\n$$ \\frac{1}{(1-p_k z^{-1})^{m}} = \\sum_{n=0}^{\\infty} \\binom{n+m-1}{m-1} (p_k z^{-1})^n = \\sum_{n=0}^{\\infty} \\left[ \\binom{n+m-1}{m-1} p_k^n \\right] z^{-n} $$\n再次地，通过与 Z 变换的定义进行比较，我们推导出其逆变换。该序列仅在 $n \\ge 0$ 时非零。\n$$ \\binom{n+m-1}{m-1} p_k^n u[n] \\quad \\overset{\\mathcal{Z}}{\\longleftrightarrow} \\quad \\frac{1}{\\left(1-p_k z^{-1}\\right)^{m}} $$\n从第一性原理的推导至此完成。\n\n最后，我们通过对部分分式展开中所有项的贡献求和，来组合得到总的冲激响应 $h[n]$：\n$$ h[n] = \\sum_{k=1}^{K} \\sum_{m=1}^{M_k} c_{k,m} \\left( \\binom{n+m-1}{m-1} p_k^n u[n] \\right) $$\n由于单位阶跃 $u[n]$ 是所有项的公因子（这是因果性的一个结果），它可以从求和中提出来：\n$$ h[n] = \\left( \\sum_{k=1}^{K} \\sum_{m=1}^{M_k} c_{k,m} \\binom{n+m-1}{m-1} p_k^n \\right) u[n] $$\n这就是冲激响应的最终闭式表达式，对所有整数 $n$ 均有效。", "answer": "$$\n\\boxed{\nh[n] = \\left( \\sum_{k=1}^{K} \\sum_{m=1}^{M_k} c_{k,m} \\binom{n+m-1}{m-1} p_k^n \\right) u[n]\n}\n$$", "id": "2878198"}, {"introduction": "理论上的 IIR 系统运行在无限精度的理想世界中，然而实际的数字硬件实现必须面对有限字长的约束。量化，即将计算结果近似到可表示的数值，是其中最主要的非线性效应来源。本练习将探讨这种非线性效应如何导致一个在理论上稳定的系统，在没有外部输入的情况下，仍能维持一种称为“零输入极限环”的持续振荡，并指导你推导出一个确保系统能够最终稳定到零的“死区”范围 [@problem_id:2878204]。", "problem": "考虑一个因果、稳定、用定点算术实现的二阶无限脉冲响应（IIR）滤波器节。该实现采用最近舍入（rounding-to-nearest）。设舍入量化器表示为 $Q_{\\Delta}(\\cdot)$，其量化步长 $\\Delta0$，定义为将任意 $x\\in\\mathbb{R}$ 映射到 $\\Delta$ 的最近整数倍，其中平局情况向远离零的方向舍入。假设在所有时间上输入均为零。该实现由以下非线性递推关系描述：\n$$\nx[n] \\;=\\; Q_{\\Delta}\\!\\left(-a_{1}\\,x[n-1] \\;-\\; a_{2}\\,x[n-2]\\right), \\qquad y[n] \\;=\\; x[n],\n$$\n其中 $a_{1},a_{2}\\in\\mathbb{R}$ 使得没有量化时的相应线性递推是渐近稳定的，且初始条件 $x[-1]$ 和 $x[-2]$ 是可表示的定点值（即 $\\Delta$ 的整数倍）。\n\n(1) 仅使用定点舍入量化器和有限集上的确定性离散时间动力系统的基本性质，从基本原理出发，论证为何此 IIR 节可以表现出非平凡的零输入极限环。\n\n(2) 定义对称死区为具有以下性质的最大半径 $R(a_{1},a_{2},\\Delta)0$：对于满足 $\\lvert x[-1]\\rvert\\leq R$ 和 $\\lvert x[-2]\\rvert\\leq R$ 的任何初始定点条件，输出序列对于所有 $n\\geq 0$ 均满足 $y[n]=0$。从基本原理出发，推导对称死区半径的上确界 $R(a_{1},a_{2},\\Delta)$ 作为 $a_{1}$、 $a_{2}$ 和 $\\Delta$ 的函数的一个精确解析表达式。你的最终答案必须是单一的闭式表达式。除了给定的递推关系外，不要假设任何特定的实现，也不要引用任何预先计算好的公式；从上面陈述的定义和性质开始。\n\n本问题不需要数值近似，也不涉及单位。请将你的最终结果表示为 $a_{1}$、 $a_{2}$ 和 $\\Delta$ 的符号函数。", "solution": "所述问题具有科学依据，提法恰当，客观，并包含足够信息以进行严谨求解。这是数字滤波器量化效应分析中的一个标准问题。因此，该问题被认为是有效的。我们开始求解。\n\n系统由以下非线性差分方程描述：\n$$x[n] = Q_{\\Delta}(-a_1 x[n-1] - a_2 x[n-2])$$\n其中 $Q_{\\Delta}(\\cdot)$ 是一个步长为 $\\Delta  0$ 的量化器，它将数值舍入到 $\\Delta$ 的最近整数倍。平局决断规则指定向远离零的方向舍入。这意味着对于任何实数值 $v$，$Q_{\\Delta}(v) = 0$ 当且仅当 $|v|  \\frac{\\Delta}{2}$。如果 $|v| \\ge \\frac{\\Delta}{2}$，那么 $|Q_{\\Delta}(v)| \\ge \\Delta$。初始条件 $x[-1]$ 和 $x[-2]$ 是 $\\Delta$ 的整数倍。\n\n(1) 关于非平凡零输入极限环存在性的论证。\n\n系统在时间 $n$ 的状态由前两个值的对定义，即 $\\mathbf{s}[n] = (x[n-1], x[n-2])$。该递推关系提供了一个从状态 $\\mathbf{s}[n]$ 转换到状态 $\\mathbf{s}[n+1] = (x[n], x[n-1])$ 的确定性规则。\n\n基础的线性系统 $x_{\\text{lin}}[n] = -a_1 x_{\\text{lin}}[n-1] - a_2 x_{\\text{lin}}[n-2]$ 被规定为渐近稳定。这意味着对于任何初始条件，线性系统的状态都收敛于零，即 $\\lim_{n \\to \\infty} x_{\\text{lin}}[n] = 0$。因此，状态轨迹是有界的。\n\n在带有量化的非线性系统中，状态值 $x[n]$ 始终是 $\\Delta$ 的整数倍。其线性对应系统的稳定性表明，对于任何给定的初始状态，非线性系统的轨迹不会发散。状态最终将进入并保持在状态空间的一个有界区域内。设该区域由 $|x[n]| \\le M$ 定义，其中 $M  0$ 为某个常数。\n\n在此有界区域内，$x[n]$ 的可能取值数量是有限的，因为它们必须是区间 $[-M, M]$ 内 $\\Delta$ 的整数倍。具体来说，这样的值的数量为 $2\\lfloor \\frac{M}{\\Delta} \\rfloor + 1$。因此，可能的状态 $\\mathbf{s}[n] = (x[n-1], x[n-2])$ 的数量也是有限的，其上界为 $(2\\lfloor \\frac{M}{\\Delta} \\rfloor + 1)^2$。\n\n系统的演化由这个有限状态空间上的一个确定性函数控制。根据鸽巢原理，任何在有限状态空间上演化的确定性系统最终必然会重新访问一个状态。一旦一个状态被重复，系统的轨迹就变得周期性，因为后续状态的序列是唯一确定的。根据定义，这种周期性轨迹就是一个极限环。\n\n这样的极限环可以是非平凡的（即，不是周期内所有 $n$ 都有 $x[n]=0$ 的零状态）。零状态 $(0,0)$ 是一个不动点，因为 $Q_{\\Delta}(-a_1 \\cdot 0 - a_2 \\cdot 0) = 0$。然而，系统可能不会达到这个状态。考虑一个小的非零状态 $(x[n-1], x[n-2])$。量化器的输入是 $v[n] = -a_1 x[n-1] - a_2 x[n-2]$。虽然线性动态会驱动 $v[n]$ 趋向于零，但量化引入了一种“地板”效应。如果在某个点 $|v[n]| \\ge \\frac{\\Delta}{2}$，输出 $x[n]$ 将是 $\\Delta$ 的一个非零倍数，其幅值至少为 $\\Delta$。这可以阻止状态达到零，从而维持一种小的、持续的振荡。稳定的线性动态的收缩性与量化对幅值大于或等于 $\\frac{\\Delta}{2}$ 的输入的扩张/维持性之间的相互作用，使得这些非平凡的自持振荡得以存在。\n\n(2) 对称死区半径上确界 $R$ 的推导。\n\n死区是使系统收敛到零状态并保持在该状态的初始状态区域。我们要求，如果初始条件 $x[-1]$ 和 $x[-2]$ 是满足 $|x[-1]| \\le R$ 和 $|x[-2]| \\le R$ 的定点值，那么对于所有 $n \\ge 0$，都有 $x[n] = 0$。\n\n为了让输出变为零并保持为零，系统必须达到状态 $(0,0)$。让我们分析最初的几步。\n对于 $n=0$，我们要求 $x[0]=0$。\n$$x[0] = Q_{\\Delta}(-a_1 x[-1] - a_2 x[-2]) = 0$$\n根据量化器的性质，这等价于条件：\n$$|a_1 x[-1] + a_2 x[-2]|  \\frac{\\Delta}{2} \\quad (*)$$\n\n对于 $n=1$，如果 $x[0]=0$，则状态变为 $(x[0], x[-1]) = (0, x[-1])$。我们要求 $x[1]=0$。\n$$x[1] = Q_{\\Delta}(-a_1 x[0] - a_2 x[-1]) = Q_{\\Delta}(-a_2 x[-1]) = 0$$\n这等价于条件：\n$$|a_2 x[-1]|  \\frac{\\Delta}{2} \\quad (**)$$\n\n如果条件 $(*)$ 和 $(**)$ 都满足，那么 $x[0]=0$ 且 $x[1]=0$。在时间 $n=2$ 时的状态变为 $(x[1], x[0]) = (0, 0)$。因此，对于所有 $n \\ge 2$：\n$$x[n] = Q_{\\Delta}(-a_1 x[n-1] - a_2 x[n-2]) = Q_{\\Delta}(0) = 0$$\n因此，问题简化为找到上确界半径 $R  0$，使得对于任何满足 $|x[-1]| \\le R$ 和 $|x[-2]| \\le R$ 的定点值 $x[-1], x[-2]$，条件 $(*)$ 和 $(**)$ 都成立。\n\n一个充分条件是要求 $(*)$ 和 $(**)$ 对由 $|u| \\le R$ 和 $|v| \\le R$ 定义的连续方形区域内的所有*实数*值 $u, v$ 都成立。如果此条件成立，那么它对该区域内定点值的子集也必然成立。\n\n让我们分析对于所有满足 $|u| \\le R$ 和 $|v| \\le R$ 的 $u,v$ 所需的不等式：\n1. 来自条件 $(*)$：$|a_1 u + a_2 v|  \\frac{\\Delta}{2}$。\n为保证此不等式对整个区域成立，左侧的最大值必须小于 $\\frac{\\Delta}{2}$。使用三角不等式，我们找到最大值：\n$$\\max_{|u|\\le R, |v|\\le R} |a_1 u + a_2 v| = \\max_{|u|\\le R, |v|\\le R} \\{|a_1||u| + |a_2||v|\\}$$\n当 $|u|=R$ 和 $|v|=R$ 时达到此最大值，得到 $(|a_1| + |a_2|)R$。因此条件变为：\n$$(|a_1| + |a_2|)R  \\frac{\\Delta}{2} \\implies R  \\frac{\\Delta}{2(|a_1| + |a_2|)}$$\n\n2. 来自条件 $(**)$：$|a_2 u|  \\frac{\\Delta}{2}$。\n类似地，左侧的最大值为：\n$$\\max_{|u|\\le R} |a_2 u| = |a_2|R$$\n条件变为：\n$$|a_2|R  \\frac{\\Delta}{2} \\implies R  \\frac{\\Delta}{2|a_2|}$$\n这第二个条件仅在 $a_2 \\ne 0$ 时有意义。如果 $a_2=0$，则该条件自然成立。\n\n为同时满足这两个条件，$R$ 必须小于两个推导出的上界中的最小值：\n$$R  \\min \\left( \\frac{\\Delta}{2(|a_1| + |a_2|)}, \\frac{\\Delta}{2|a_2|} \\right)$$\n我们比较最小值中两项的分母。因为 $|a_1| \\ge 0$，所以 $|a_1| + |a_2| \\ge |a_2|$。假设滤波器是非平凡的（$|a_1|+|a_2|  0$，这是由其二阶性质所蕴含的），取正倒数会反转不等号：\n$$\\frac{1}{2(|a_1| + |a_2|)} \\le \\frac{1}{2|a_2|}$$\n因此，第一项总是更严格的约束。关于 $R$ 的综合条件简化为：\n$$R  \\frac{\\Delta}{2(|a_1| + |a_2|)}$$\n问题要求具有指定性质的上确界半径 $R$。所有满足该性质的半径 $R$ 的集合是开区间 $\\left(0, \\frac{\\Delta}{2(|a_1| + |a_2|)}\\right)$。这个集合的上确界（最小上界）是其右端点。\n\n因此，对称死区半径的上确界由以下表达式给出：\n$$R(a_1, a_2, \\Delta) = \\frac{\\Delta}{2(|a_1| + |a_2|)}$$\n在这个上确界值本身，区域边界上可能存在一个定点值，由于平局决断规则而被映射为非零值，但对于任何严格小于此半径的值，所有内部定点值都保证被映射为零。上确界是这些有效半径的极限。", "answer": "$$\n\\boxed{\\frac{\\Delta}{2(|a_1| + |a_2|)}}\n$$", "id": "2878204"}, {"introduction": "除了量化噪声引起的极限环，算术溢出是实现 IIR 滤波器时必须解决的另一个关键问题，它可能导致系统结果产生灾难性错误。本练习将引导你采用状态空间分析方法，这是一种在现代控制理论和信号处理中非常强大的工具。通过运用矩阵和向量范数的性质，你将推导出一个安全的输入信号缩放因子，以确保在所有有界输入下，滤波器的内部状态始终保持在硬件可表示的范围之内，从而防止溢出发生 [@problem_id:2878188]。", "problem": "考虑一个离散时间线性时不变 (LTI) 无限冲激响应 (IIR) 系统，其状态空间形式为：状态向量 $x_{k} \\in \\mathbb{R}^{3}$，输入 $u_{k} \\in \\mathbb{R}$，初始状态为零 $x_{0} = 0$。该实现为\n$$\nx_{k+1} = A x_{k} + B u_{k},\n$$\n其中\n$$\nA = \\begin{pmatrix}\n0.2  0.1  0 \\\\\n0.05  0.3  0.05 \\\\\n0  0.1  0.25\n\\end{pmatrix}, \n\\quad\nB = \\begin{pmatrix}\n0.2 \\\\ 0.1 \\\\ 0.05\n\\end{pmatrix}.\n$$\n在进行标量预缩放之前的输入是一个有界序列 $v_{k}$，对于所有 $k \\in \\mathbb{Z}_{\\ge 0}$ 满足 $\\lvert v_{k} \\rvert \\leq 1$。为避免定点硬件中的溢出，引入了一个标量预缩放因子 $\\gamma  0$，使得 $u_{k} = \\gamma \\, v_{k}$。硬件约束要求内部状态向量必须对所有 $k \\in \\mathbb{Z}_{\\ge 0}$ 满足 $\\lVert x_{k} \\rVert_{\\infty} \\leq X_{\\max}$，其中 $X_{\\max} = 0.2$。\n\n仅使用基于诱导范数和次可乘性的状态空间不等式（不借助任何未经证明的简化公式），推导一个关于 $\\gamma$ 的 $\\lVert x_{k} \\rVert_{\\infty}$ 的保守一致界，并确定在 $\\lvert v_{k} \\rvert \\leq 1$ 的每一个有界输入序列下，能保证无溢出约束的最大容许 $\\gamma$。\n\n请以单个精确数字的形式给出最终答案（无需单位，无需近似）。", "solution": "所述问题具有科学依据，提法恰当且客观。所有必要信息均已提供，不存在内部矛盾或逻辑缺陷。因此，该问题是有效的，我们可以着手求解。\n\n系统动力学由离散时间线性时不变状态空间方程描述：\n$$\nx_{k+1} = A x_{k} + B u_{k}\n$$\n初始状态为 $x_{0} = 0$。通过展开递推关系，可以得到时间步 $k$ 处的状态向量：\n$$\nx_{1} = A x_{0} + B u_{0} = B u_{0}\n$$\n$$\nx_{2} = A x_{1} + B u_{1} = A(B u_{0}) + B u_{1} = A B u_{0} + B u_{1}\n$$\n$$\nx_{3} = A x_{2} + B u_{2} = A(A B u_{0} + B u_{1}) + B u_{2} = A^{2} B u_{0} + A B u_{1} + B u_{2}\n$$\n通过归纳法，对于 $k \\ge 1$ 的状态向量 $x_{k}$ 的通解由以下卷积和给出：\n$$\nx_{k} = \\sum_{j=0}^{k-1} A^{k-1-j} B u_{j}\n$$\n我们需要找到状态向量无穷范数 $\\lVert x_{k} \\rVert_{\\infty}$ 的一个界。对 $x_{k}$ 的表达式应用无穷范数，并使用向量范数的三角不等式，我们得到：\n$$\n\\lVert x_{k} \\rVert_{\\infty} = \\left\\lVert \\sum_{j=0}^{k-1} A^{k-1-j} B u_{j} \\right\\rVert_{\\infty} \\le \\sum_{j=0}^{k-1} \\lVert A^{k-1-j} B u_{j} \\rVert_{\\infty}\n$$\n由于 $u_{j}$ 是一个标量，我们可以写出 $\\lVert A^{k-1-j} B u_{j} \\rVert_{\\infty} = \\lvert u_{j} \\rvert \\lVert A^{k-1-j} B \\rVert_{\\infty}$。此处，$A^{k-1-j} B$ 是一个 $3 \\times 1$ 的列向量，其范数是向量无穷范数（最大绝对值元素）。输入 $u_{k}$ 通过 $u_{k} = \\gamma v_{k}$ 与有界序列 $v_{k}$ 相关联，其中 $\\lvert v_{k} \\rvert \\leq 1$。这意味着对于所有的 $j$，有 $\\lvert u_{j} \\rvert = \\lvert \\gamma v_{j} \\rvert = \\gamma \\lvert v_{j} \\rvert \\le \\gamma$。\n为了找到一个对每个容许输入序列都成立的界，我们使用 $\\lvert u_{j} \\rvert$ 的最坏情况值：\n$$\n\\lVert x_{k} \\rVert_{\\infty} \\le \\sum_{j=0}^{k-1} \\gamma \\lVert A^{k-1-j} B \\rVert_{\\infty} = \\gamma \\sum_{j=0}^{k-1} \\lVert A^{k-1-j} B \\rVert_{\\infty}\n$$\n问题要求一个基于诱导范数和次可乘性的保守界。我们使用相容的矩阵和向量范数的性质 $\\lVert M \\mathbf{v} \\rVert_{\\infty} \\le \\lVert M \\rVert_{\\infty} \\lVert \\mathbf{v} \\rVert_{\\infty}$，其中 $\\lVert M \\rVert_{\\infty}$ 是诱导矩阵无穷范数（最大绝对行和）。在我们的例子中，$M = A^{k-1-j}$ 且 $\\mathbf{v} = B$。\n$$\n\\lVert A^{k-1-j} B \\rVert_{\\infty} \\le \\lVert A^{k-1-j} \\rVert_{\\infty} \\lVert B \\rVert_{\\infty}\n$$\n此外，由于诱导矩阵范数的次可乘性，对于任意非负整数 $m$，我们有 $\\lVert A^{m} \\rVert_{\\infty} \\le (\\lVert A \\rVert_{\\infty})^{m}$。应用此性质，我们得到：\n$$\n\\lVert A^{k-1-j} \\rVert_{\\infty} \\le (\\lVert A \\rVert_{\\infty})^{k-1-j}\n$$\n结合这些不等式，得到所需的保守界：\n$$\n\\lVert x_{k} \\rVert_{\\infty} \\le \\gamma \\sum_{j=0}^{k-1} (\\lVert A \\rVert_{\\infty})^{k-1-j} \\lVert B \\rVert_{\\infty}\n$$\n我们通过令 $m = k-1-j$ 来重新索引求和。当 $j$ 从 $0$ 变到 $k-1$ 时，$m$ 从 $k-1$ 变到 $0$。\n$$\n\\lVert x_{k} \\rVert_{\\infty} \\le \\gamma \\lVert B \\rVert_{\\infty} \\sum_{m=0}^{k-1} (\\lVert A \\rVert_{\\infty})^{m}\n$$\n这个界依赖于 $k$。为了保证硬件约束 $\\lVert x_{k} \\rVert_{\\infty} \\leq X_{\\max}$ 对所有 $k \\ge 0$ 成立，我们需要一个一致界，这可以通过考虑 $k \\rightarrow \\infty$ 的极限来获得。首先，我们必须计算矩阵 $A$ 的无穷范数：\n$$\nA = \\begin{pmatrix}\n0.2  0.1  0 \\\\\n0.05  0.3  0.05 \\\\\n0  0.1  0.25\n\\end{pmatrix}\n$$\n绝对行和为：\n第 1 行：$\\lvert 0.2 \\rvert + \\lvert 0.1 \\rvert + \\lvert 0 \\rvert = 0.3$\n第 2 行：$\\lvert 0.05 \\rvert + \\lvert 0.3 \\rvert + \\lvert 0.05 \\rvert = 0.4$\n第 3 行：$\\lvert 0 \\rvert + \\lvert 0.1 \\rvert + \\lvert 0.25 \\rvert = 0.35$\n最大绝对行和为 $\\lVert A \\rVert_{\\infty} = \\max(0.3, 0.4, 0.35) = 0.4$。\n由于 $\\lVert A \\rVert_{\\infty} = 0.4  1$，系统是稳定的，且几何级数 $\\sum_{m=0}^{\\infty} (\\lVert A \\rVert_{\\infty})^{m}$ 收敛。对于有限 $k$ 的和被无穷和所界定：\n$$\n\\sum_{m=0}^{k-1} (\\lVert A \\rVert_{\\infty})^{m} \\le \\sum_{m=0}^{\\infty} (\\lVert A \\rVert_{\\infty})^{m} = \\frac{1}{1 - \\lVert A \\rVert_{\\infty}}\n$$\n这就给出了一个对所有 $k \\ge 0$ 均有效的状态范数的一致界：\n$$\n\\sup_{k \\ge 0} \\lVert x_{k} \\rVert_{\\infty} \\le \\frac{\\gamma \\lVert B \\rVert_{\\infty}}{1 - \\lVert A \\rVert_{\\infty}}\n$$\n这就是关于 $\\gamma$ 的 $\\lVert x_{k} \\rVert_{\\infty}$ 的保守一致界。\n接下来，我们计算向量 $B$ 的无穷范数：\n$$\nB = \\begin{pmatrix}\n0.2 \\\\ 0.1 \\\\ 0.05\n\\end{pmatrix}\n$$\n$\\lVert B \\rVert_{\\infty} = \\max(\\lvert 0.2 \\rvert, \\lvert 0.1 \\rvert, \\lvert 0.05 \\rvert) = 0.2$。\n\n无溢出约束要求对所有 $k$ 都有 $\\lVert x_{k} \\rVert_{\\infty} \\le X_{\\max}$。为保证这一点，我们的上界必须满足该约束：\n$$\n\\frac{\\gamma \\lVert B \\rVert_{\\infty}}{1 - \\lVert A \\rVert_{\\infty}} \\le X_{\\max}\n$$\n我们希望找到最大容许的 $\\gamma$。我们通过将该界设为最大允许值来实现这一目标：\n$$\n\\gamma_{\\max} = \\frac{X_{\\max} (1 - \\lVert A \\rVert_{\\infty})}{\\lVert B \\rVert_{\\infty}}\n$$\n代入给定值和计算出的值，$X_{\\max} = 0.2$，$\\lVert A \\rVert_{\\infty} = 0.4$，以及 $\\lVert B \\rVert_{\\infty} = 0.2$：\n$$\n\\gamma_{\\max} = \\frac{0.2 \\times (1 - 0.4)}{0.2} = 1 - 0.4 = 0.6\n$$\n因此，最大容许的预缩放因子是 $0.6$。", "answer": "$$\\boxed{0.6}$$", "id": "2878188"}]}