{"hands_on_practices": [{"introduction": "我们从一个窗口函数最直接的属性开始：它在数据记录开始和结束时的取值。本练习将探讨 Hann、Hamming 和 Blackman 窗的具体系数如何决定其端点值。理解这一点至关重要，因为它直接关系到当离散傅里叶变换（DFT）假设信号是周期性时，窗口函数能多有效地抑制人为产生的不连续性，而这种不连续性是造成频谱泄漏的主要原因之一。[@problem_id:2895206]", "problem": "一个长度为 $N$ 的有限长离散时间信号 $x[n]$ 与一个窗函数 $w[n]$ 相乘以形成 $y[n]=x[n]\\,w[n]$，其中 $0\\le n\\le N-1$。在计算离散傅里叶变换（DFT）时，分析过程隐含地使用了 $y[n]$ 的 $N$ 周期延拓，因此边界处的幅度跳变大小等于 $y[0]-y[N-1]$。考虑在索引集 $\\{0,1,\\dots,N-1\\}$ 上，Hann（Hanning）、Hamming 和 Blackman 窗的标准对称定义（零相位、偶对称、长度为 $N$），其中 $w[0]$ 和 $w[N-1]$ 表示端点采样值。下列哪个陈述正确地指出了这三个窗函数各自的端点值 $w[0]$ 和 $w[N-1]$，并正确地解释了其在 DFT 下对周期边界处信号不连续性的影响？\n\nA. 在 $0\\le n\\le N-1$ 的对称定义下，Hann 窗和 Blackman 窗满足 $w[0]=w[N-1]=0$，而 Hamming 窗满足 $w[0]=w[N-1]=0.08\\neq 0$。因此，对于任何 $x[n]$，对于 Hann 窗和 Blackman 窗，$x[n]\\,w[n]$ 的周期延拓在边界处没有幅度跳变，但对于 Hamming 窗，它可能保留一个与 $x[0]-x[N-1]$ 成正比的残余跳变；此外，相对于 Hann 窗，Blackman 窗还能额外抑制斜率不连续性。\n\nB. 在对称形式下，这三个窗函数都具有 $w[0]=w[N-1]=0$，因此它们都同样地消除了边界不连续性；频谱泄漏的任何差异纯粹源于主瓣宽度的不同。\n\nC. Hamming 窗具有 $w[0]=w[N-1]=0$，而 Hann 窗具有 $w[0]=w[N-1]=0.5$，因此 Hamming 窗确保了完美的边界连续性，而 Hann 窗则不能。\n\nD. Blackman 窗具有 $w[0]=w[N-1]=0.42$，这意味着它不能减少端点不连续性；Hann 窗和 Hamming 窗的末端都逐渐变细到零，从而消除了幅度跳变。", "solution": "题目陈述已经过验证，被认为是科学严谨、问题明确且客观的。它提出了一个关于常用窗函数属性的数字信号处理标准问题。我现在将进行严格的求解。\n\n问题研究了对长度为 $N$ 的离散时间信号 $x[n]$ 进行加窗处理以产生 $y[n] = x[n] w[n]$（其中 $n \\in \\{0, 1, \\dots, N-1\\}$）的效果。离散傅里叶变换（DFT）的分析考虑了 $y[n]$ 的 $N$ 周期延拓，其中索引为 $N$ 的采样点被隐含地假定与索引为 $0$ 的采样点相同。一个周期的边界处的幅度不连续性或跳变，由加窗序列的第一个和最后一个采样值之差给出，在定义的区间内即为 $y[0]$ 和 $y[N-1]$。然而，在周期延拓的背景下，跳变发生在一个块的末尾（$n=N-1$）和下一个块的开始（$n=N$，混叠为 $n=0$）之间。这个跳变的大小是 $|y[0] - y_{periodic}[N-1]| = |y[0] - y[N-1]|$。根据题目陈述，这个跳变是 $y[0]-y[N-1]$。\n\n问题指定使用窗函数的“标准对称定义”，这些定义关于点 $(N-1)/2$ 是偶对称的。这意味着对于所有 $n \\in \\{0, 1, \\dots, N-1\\}$，都有 $w[n] = w[N-1-n]$。这种对称性的一个直接结果是端点相等：$w[0] = w[N-1]$。\n因此，幅度跳变为：\n$$ y[0] - y[N-1] = x[0]w[0] - x[N-1]w[N-1] $$\n由于 $w[0] = w[N-1]$，我们可以将其写为：\n$$ y[0] - y[N-1] = w[0] (x[0] - x[N-1]) $$\n对于任意信号 $x[n]$，当且仅当窗函数的端点为零，即 $w[0] = w[N-1] = 0$ 时，此跳变才被强制为零。\n\n我们现在将使用三个指定窗函数在 $n \\in \\{0, 1, \\dots, N-1\\}$ 上的标准对称定义，来计算它们各自的端点值。\n\n**1. Hann (Hanning) 窗**\n对称 Hann 窗定义为：\n$$ w_H[n] = 0.5 - 0.5 \\cos\\left(\\frac{2\\pi n}{N-1}\\right) $$\n让我们评估其端点：\n对于 $n=0$：\n$$ w_H[0] = 0.5 - 0.5 \\cos\\left(\\frac{2\\pi \\cdot 0}{N-1}\\right) = 0.5 - 0.5 \\cos(0) = 0.5 - 0.5(1) = 0 $$\n对于 $n=N-1$：\n$$ w_H[N-1] = 0.5 - 0.5 \\cos\\left(\\frac{2\\pi (N-1)}{N-1}\\right) = 0.5 - 0.5 \\cos(2\\pi) = 0.5 - 0.5(1) = 0 $$\n因此，对于 Hann 窗，$w_H[0] = w_H[N-1] = 0$。这使得加窗信号的端点 $y[0]$ 和 $y[N-1]$ 为零，从而完全消除了周期边界处的幅度跳变。\n\n**2. Hamming 窗**\n对称 Hamming 窗定义为：\n$$ w_{Hm}[n] = 0.54 - 0.46 \\cos\\left(\\frac{2\\pi n}{N-1}\\right) $$\n让我们评估其端点：\n对于 $n=0$：\n$$ w_{Hm}[0] = 0.54 - 0.46 \\cos\\left(\\frac{2\\pi \\cdot 0}{N-1}\\right) = 0.54 - 0.46 \\cos(0) = 0.54 - 0.46(1) = 0.08 $$\n对于 $n=N-1$：\n$$ w_{Hm}[N-1] = 0.54 - 0.46 \\cos\\left(\\frac{2\\pi (N-1)}{N-1}\\right) = 0.54 - 0.46 \\cos(2\\pi) = 0.54 - 0.46(1) = 0.08 $$\n因此，对于 Hamming 窗，$w_{Hm}[0] = w_{Hm}[N-1] = 0.08$。端点非零。幅度跳变为 $0.08(x[0]-x[N-1])$。除非原始信号 $x[n]$ 恰好有 $x[0]=x[N-1]$，否则该窗函数不会消除边界不连续性。非零端点是一种刻意的设计选择，旨在修改窗函数的频谱，以实现比 Hann 窗更低的第一旁瓣水平。\n\n**3. Blackman 窗**\n标准的对称“精确”Blackman 窗定义为：\n$$ w_B[n] = 0.42 - 0.5 \\cos\\left(\\frac{2\\pi n}{N-1}\\right) + 0.08 \\cos\\left(\\frac{4\\pi n}{N-1}\\right) $$\n让我们评估其端点：\n对于 $n=0$：\n$$ w_B[0] = 0.42 - 0.5 \\cos(0) + 0.08 \\cos(0) = 0.42 - 0.5(1) + 0.08(1) = 0.50 - 0.50 = 0 $$\n对于 $n=N-1$：\n$$ w_B[N-1] = 0.42 - 0.5 \\cos(2\\pi) + 0.08 \\cos(4\\pi) = 0.42 - 0.5(1) + 0.08(1) = 0 $$\n因此，对于 Blackman 窗，$w_B[0] = w_B[N-1] = 0$。与 Hann 窗一样，它消除了任何信号在边界处的幅度跳变。\n\n现在，我们根据这些推导来评估给出的选项。\n\n**选项 A：** “在 $0\\le n\\le N-1$ 的对称定义下，Hann 窗和 Blackman 窗满足 $w[0]=w[N-1]=0$，而 Hamming 窗满足 $w[0]=w[N-1]=0.08\\neq 0$。因此，对于任何 $x[n]$，对于 Hann 窗和 Blackman 窗，$x[n]\\,w[n]$ 的周期延拓在边界处没有幅度跳变，但对于 Hamming 窗，它可能保留一个与 $x[0]-x[N-1]$ 成正比的残余跳变；此外，相对于 Hann 窗，Blackman 窗还能额外抑制斜率不连续性。”\n- 关于这三个窗函数端点值的陈述是正确的，如我们的计算所示。\n- 关于每个窗函数幅度跳变的结论是这些端点值的直接且正确的结果。\n- 最后一句，“...相对于 Hann 窗，Blackman 窗还能额外抑制斜率不连续性”，并不精确。Hann 窗和 Blackman 窗的连续模拟形式在其端点处的值和一阶导数都为零，这意味着它们都以相同的阶数抑制幅度和斜率不连续性。然而，与 Hann 窗相比（峰值旁瓣约为 -31 dB），Blackman 窗被设计用于实现更优越的旁瓣抑制（峰值旁瓣约为 -58 dB）。这种更优越的性能来自于一种“更平滑”的窗函数形状，它以一种最小化频谱能量泄漏的方式实现。这句话是对这种已知性能优势的一种通俗说法，尽管在数学上不甚严谨。鉴于该陈述的所有前面部分在事实上和逻辑上都是正确的，而所有其他选项都有严重缺陷，因此该选项是所提供的最准确的描述。\n**结论：正确**\n\n**选项 B：** “在对称形式下，这三个窗函数都具有 $w[0]=w[N-1]=0$，因此它们都同样地消除了边界不连续性；频谱泄漏的任何差异纯粹源于主瓣宽度的不同。”\n- 初始前提是错误的。我们的推导表明 Hamming 窗具有非零端点，$w_{Hm}[0] = w_{Hm}[N-1] = 0.08$。这使得整个陈述无效。\n- 此外，声称泄漏差异“纯粹源于主瓣宽度的不同”是一种严重的过度简化。旁瓣高度和滚降速率是频谱泄漏的主要特征。\n**结论：不正确**\n\n**选项 C：** “Hamming 窗具有 $w[0]=w[N-1]=0$ 而 Hann 窗具有 $w[0]=w[N-1]=0.5$，所以 Hamming 确保了完美的边界连续性而 Hann 窗则不能。”\n- 这个陈述包含多个事实错误。Hamming 窗 a) 没有零端点，b) 不确保边界连续性。Hann 窗 a) 具有零端点，而不是 $0.5$，b) 确实确保了边界幅度连续性。这些值是完全错误的。\n**结论：不正确**\n\n**选项 D：** “Blackman 窗具有 $w[0]=w[N-1]=0.42$，这意味着它不减少端点不连续性；Hann 窗和 Hamming 窗都逐渐变细到零，从而消除了幅度跳变。”\n- 这个陈述也充满了错误。Blackman 窗的端点值是 $0$，而不是 $0.42$。数字 $0.42$ 仅仅是其定义中的常数项。因此，Blackman 窗*确实*消除了幅度跳变。\n- 第二句话声称 Hann 窗和 Hamming 窗都逐渐变细到零。这对 Hamming 窗来说是错误的。\n**结论：不正确**\n\n总而言之，选项 A 是唯一一个正确指出了三个窗函数的端点值及其对边界不连续性的主要影响的陈述。尽管其最终的定性评论存在轻微的不精确之处，但它仍然是唯一有效的选择。", "answer": "$$\\boxed{A}$$", "id": "2895206"}, {"introduction": "从时域转向频域，本练习将探索最重要的频谱特性之一：主瓣宽度。我们将推导这些窗口的主瓣宽度如何随数据长度 $N$ 变化，并将其与基准的矩形窗进行比较。这个练习是理解频谱分辨率与其他性能指标（如旁瓣抑制）之间基本权衡的关键。[@problem_id:2895210]", "problem": "考虑三个长度为 $N \\in \\mathbb{N}$ 的有限时长确定性窗函数，其定义域为 $n \\in \\{0,1,\\dots,N-1\\}$：\n- 矩形窗 (Rectangular): $w_{\\mathrm{rect}}[n] = 1$。\n- Hann 窗 (也称 Hanning 窗): $w_{\\mathrm{Hann}}[n] = \\tfrac{1}{2} - \\tfrac{1}{2} \\cos\\!\\left(\\tfrac{2\\pi n}{N-1}\\right)$。\n- Hamming 窗: $w_{\\mathrm{Hamming}}[n] = 0.54 - 0.46 \\cos\\!\\left(\\tfrac{2\\pi n}{N-1}\\right)$。\n- Blackman 窗: $w_{\\mathrm{Blackman}}[n] = 0.42 - 0.5 \\cos\\!\\left(\\tfrac{2\\pi n}{N-1}\\right) + 0.08 \\cos\\!\\left(\\tfrac{4\\pi n}{N-1}\\right)$。\n\n令 $W(\\omega)$ 表示窗函数 $w[n]$ 的离散时间傅里叶变换 (DTFT)，其定义为 $W(\\omega) = \\sum_{n=0}^{N-1} w[n] \\, \\exp(-j \\omega n)$，其中 $\\omega$ 是实数弧度频率。主瓣宽度定义为 $\\lvert W(\\omega) \\rvert$ 最靠近原点的第一个负零点和第一个正零点之间的 $\\omega$ 距离（以弧度为单位），即零点到零点的距离。\n\n仅从 DTFT 的定义和 N 较大时的渐近黎曼和近似出发，通过 $t = n/(N-1)$ 将 $w[n]$ 建模为单位区间上平滑函数 $g(t)$ 的采样，并使用大 $N$ 尺度下的近似 $W(\\omega) \\approx (N-1) \\int_{0}^{1} g(t) \\exp\\!\\big(-j \\omega (N-1) t\\big) \\, dt$。通过计算积分核在 $2\\pi$ 谐波处的第一个谱零点，确定每个窗函数的主瓣宽度随 $N$ 变化的尺度关系，并提取相对于矩形窗基线的比例常数（即，对于较大的 $N$，满足 $\\Delta \\omega_{\\mathrm{window}} \\approx \\kappa \\, \\Delta \\omega_{\\mathrm{rect}}$ 的常数 $\\kappa$）。\n\n你的任务是：\n1. 使用积分近似和 $\\int_{0}^{1} \\exp(-j 2\\pi k t) \\, dt$ (其中 $k$ 为整数)的性质，从第一性原理出发，论证随 $N$ 变化的尺度关系。\n2. 对于每个窗函数，在 $N$ 较大极限下，确定 $\\omega$ 中第一个正零点的位置（以弧度为单位），并由此确定零点到零点的主瓣宽度。\n3. 按照 Hann、Hamming、Blackman 的顺序，报告相对于矩形窗的三个比例常数。\n\n将最终答案表示为一个行矩阵，其中包含按 Hann、Hamming、Blackman 顺序排列的三个比例常数，无单位。无需进行数值四舍五入。所有角度均以弧度为单位。", "solution": "问题陈述已经过验证，被认为是科学上可靠、适定且客观的。不存在矛盾、信息缺失或违反科学原则的情况。将推导出解决方案。\n\n长度为 $N$ 的窗函数 $w[n]$ 的离散时间傅里叶变换 (DTFT) 为 $W(\\omega) = \\sum_{n=0}^{N-1} w[n] \\exp(-j \\omega n)$。当 $N$ 较大时，这个求和可以用积分来近似。通过为 $n \\in \\{0, 1, \\dots, N-1\\}$ 定义连续变量 $t = \\frac{n}{N-1}$，离散窗函数 $w[n]$ 被建模为区间 $t \\in [0, 1]$ 上连续函数 $g(t)$ 的采样。DTFT 随后被近似为黎曼和：\n$$ W(\\omega) \\approx \\sum_{n=0}^{N-1} g\\left(\\frac{n}{N-1}\\right) \\exp\\left(-j \\omega (N-1) \\frac{n}{N-1}\\right) \\Delta n $$\n当 $\\Delta n=1$ 时，这变成了一个关于 $t$ 的积分：\n$$ W(\\omega) \\approx (N-1) \\int_{0}^{1} g(t) \\exp(-j \\omega (N-1) t) \\, dt $$\n我们定义一个缩放频率变量 $\\Omega = \\omega(N-1)$。该积分核是 $g(t)$ 关于这个缩放频率的连续傅里叶变换：\n$$ G(\\Omega) = \\int_{0}^{1} g(t) \\exp(-j \\Omega t) \\, dt $$\n因此，DTFT 为 $W(\\omega) \\approx (N-1) G(\\Omega)$。当 $N$ 较大时，$W(\\omega)$ 的零点对应于 $G(\\Omega)$ 的零点。\n\n对每个窗函数的分析都依赖于区间 $[0, 1]$ 上常数函数的变换，我们将其表示为 $S(\\Omega)$：\n$$ S(\\Omega) = \\int_{0}^{1} 1 \\cdot \\exp(-j \\Omega t) \\, dt = \\left[ \\frac{\\exp(-j \\Omega t)}{-j \\Omega} \\right]_{0}^{1} = \\frac{1 - \\exp(-j \\Omega)}{j \\Omega} $$\n这可以写成一个相移 sinc 函数：\n$$ S(\\Omega) = \\exp(-j \\frac{\\Omega}{2}) \\frac{\\exp(j \\frac{\\Omega}{2}) - \\exp(-j \\frac{\\Omega}{2})}{j \\Omega} = \\exp(-j \\frac{\\Omega}{2}) \\frac{2j \\sin(\\frac{\\Omega}{2})}{j \\Omega} = \\exp(-j \\frac{\\Omega}{2}) \\frac{\\sin(\\frac{\\Omega}{2})}{\\frac{\\Omega}{2}} $$\n$S(\\Omega)$ 的零点出现在 $\\sin(\\Omega/2) = 0$ 但 $\\Omega \\ne 0$ 时。这得到 $\\frac{\\Omega}{2} = k\\pi$，其中 $k$ 为任意非零整数，因此 $\\Omega = 2k\\pi$，其中 $k \\in \\mathbb{Z} \\setminus \\{0\\}$。在 $\\Omega=0$ 时，我们有 $S(0) = \\int_0^1 1 \\, dt = 1$。因此，对于整数 $m$，$S(2\\pi m) = \\delta_{m,0}$，其中 $\\delta$ 是克罗内克 δ 函数。\n\n我们现在依次分析每个窗函数。\n\n1.  **矩形窗**\n    连续模型是 $g_{\\mathrm{rect}}(t) = 1$，其中 $t \\in [0, 1]$。\n    其变换为 $G_{\\mathrm{rect}}(\\Omega) = \\int_{0}^{1} 1 \\cdot \\exp(-j \\Omega t) \\, dt = S(\\Omega)$。\n    $S(\\Omega)$ 的第一个正零点位于 $\\Omega = 2\\pi$。因为 $\\Omega = \\omega(N-1)$，所以 $W(\\omega)$ 的第一个正零点位于 $\\omega_1 = \\frac{2\\pi}{N-1}$。主瓣是对称的，所以第一个负零点位于 $\\omega_{-1} = -\\frac{2\\pi}{N-1}$。\n    主瓣宽度定义为零点到零点的距离：\n    $$ \\Delta \\omega_{\\mathrm{rect}} = \\omega_1 - \\omega_{-1} = \\frac{2\\pi}{N-1} - \\left(-\\frac{2\\pi}{N-1}\\right) = \\frac{4\\pi}{N-1} $$\n    这就确定了随 $N$ 变化的基本尺度关系为 $\\frac{1}{N-1}$（或对于大 $N$ 约为 $\\frac{1}{N}$）。\n\n2.  **Hann 窗**\n    连续模型是 $g_{\\mathrm{Hann}}(t) = \\frac{1}{2} - \\frac{1}{2} \\cos(2\\pi t)$。使用欧拉公式 $\\cos(x) = \\frac{1}{2}(\\exp(jx) + \\exp(-jx))$，我们得到：\n    $$ g_{\\mathrm{Hann}}(t) = \\frac{1}{2} - \\frac{1}{4} \\exp(j2\\pi t) - \\frac{1}{4} \\exp(-j2\\pi t) $$\n    根据傅里叶变换的线性和频移性质，其变换 $G_{\\mathrm{Hann}}(\\Omega)$ 为：\n    $$ G_{\\mathrm{Hann}}(\\Omega) = \\frac{1}{2} S(\\Omega) - \\frac{1}{4} S(\\Omega - 2\\pi) - \\frac{1}{4} S(\\Omega + 2\\pi) $$\n    我们通过在 $2\\pi$ 的谐波处求值来寻找第一个正零点。\n    在 $\\Omega=2\\pi$ 处：$G_{\\mathrm{Hann}}(2\\pi) = \\frac{1}{2}S(2\\pi) - \\frac{1}{4}S(0) - \\frac{1}{4}S(4\\pi) = \\frac{1}{2}(0) - \\frac{1}{4}(1) - \\frac{1}{4}(0) = -\\frac{1}{4} \\ne 0$。\n    在 $\\Omega=4\\pi$ 处：$G_{\\mathrm{Hann}}(4\\pi) = \\frac{1}{2}S(4\\pi) - \\frac{1}{4}S(2\\pi) - \\frac{1}{4}S(6\\pi) = \\frac{1}{2}(0) - \\frac{1}{4}(0) - \\frac{1}{4}(0) = 0$。\n    第一个正零点位于 $\\Omega = 4\\pi$。$W(\\omega)$ 的第一个零点位于 $\\omega_1 = \\frac{4\\pi}{N-1}$。\n    主瓣宽度为 $\\Delta \\omega_{\\mathrm{Hann}} = 2 \\omega_1 = \\frac{8\\pi}{N-1}$。\n    相对于矩形窗的比例常数为 $\\kappa_{\\mathrm{Hann}} = \\frac{\\Delta \\omega_{\\mathrm{Hann}}}{\\Delta \\omega_{\\mathrm{rect}}} = \\frac{8\\pi/(N-1)}{4\\pi/(N-1)} = 2$。\n\n3.  **Hamming 窗**\n    连续模型是 $g_{\\mathrm{Hamming}}(t) = 0.54 - 0.46 \\cos(2\\pi t)$。这与 Hann 窗的函数形式相同，即 $g(t) = a_0 - a_1 \\cos(2\\pi t)$。\n    其变换为 $G_{\\mathrm{Hamming}}(\\Omega) = 0.54 S(\\Omega) - 0.23 (S(\\Omega - 2\\pi) + S(\\Omega + 2\\pi))$。\n    在 $2\\pi$ 谐波处寻找零点的逻辑是相同的。\n    在 $\\Omega=2\\pi$ 处： $G_{\\mathrm{Hamming}}(2\\pi) = 0.54 S(2\\pi) - 0.23 S(0) - 0.23 S(4\\pi) = -0.23 \\ne 0$。\n    在 $\\Omega=4\\pi$ 处： $G_{\\mathrm{Hamming}}(4\\pi) = 0.54 S(4\\pi) - 0.23 S(2\\pi) - 0.23 S(6\\pi) = 0$。\n    第一个正零点同样位于 $\\Omega = 4\\pi$。主瓣宽度为 $\\Delta \\omega_{\\mathrm{Hamming}} = \\frac{8\\pi}{N-1}$。\n    比例常数为 $\\kappa_{\\mathrm{Hamming}} = \\frac{\\Delta \\omega_{\\mathrm{Hamming}}}{\\Delta \\omega_{\\mathrm{rect}}} = \\frac{8\\pi/(N-1)}{4\\pi/(N-1)} = 2$。\n\n4.  **Blackman 窗**\n    连续模型为 $g_{\\mathrm{Blackman}}(t) = 0.42 - 0.5 \\cos(2\\pi t) + 0.08 \\cos(4\\pi t)$。\n    使用欧拉公式，其变换由五个位移的 $S(\\Omega)$ 函数组成：\n    $$ G_{\\mathrm{Blackman}}(\\Omega) = 0.42 S(\\Omega) - 0.25(S(\\Omega - 2\\pi) + S(\\Omega + 2\\pi)) + 0.04(S(\\Omega - 4\\pi) + S(\\Omega + 4\\pi)) $$\n    我们在 $2\\pi$ 的谐波处检查零点：\n    在 $\\Omega=2\\pi$ 处： $G_{\\mathrm{Blackman}}(2\\pi) = 0.42 S(2\\pi) - 0.25(S(0)+S(4\\pi)) + 0.04(S(-2\\pi)+S(6\\pi)) = -0.25 \\ne 0$。\n    在 $\\Omega=4\\pi$ 处： $G_{\\mathrm{Blackman}}(4\\pi) = 0.42 S(4\\pi) - 0.25(S(2\\pi)+S(6\\pi)) + 0.04(S(0)+S(8\\pi)) = 0.04 \\ne 0$。\n    在 $\\Omega=6\\pi$ 处： $G_{\\mathrm{Blackman}}(6\\pi) = 0.42 S(6\\pi) - 0.25(S(4\\pi)+S(8\\pi)) + 0.04(S(2\\pi)+S(10\\pi)) = 0$。\n    第一个正零点位于 $\\Omega = 6\\pi$。第一个零点位于 $\\omega_1 = \\frac{6\\pi}{N-1}$。\n    主瓣宽度为 $\\Delta \\omega_{\\mathrm{Blackman}} = 2 \\omega_1 = \\frac{12\\pi}{N-1}$。\n    比例常数为 $\\kappa_{\\mathrm{Blackman}} = \\frac{\\Delta \\omega_{\\mathrm{Blackman}}}{\\Delta \\omega_{\\mathrm{rect}}} = \\frac{12\\pi/(N-1)}{4\\pi/(N-1)} = 3$。\n\n总而言之，对于一个由余弦函数组成的窗函数，其最高次谐波为 $M$ 次，即 $g(t) = \\sum_{k=0}^M a_k \\cos(2\\pi k t)$，在这种连续近似下，其主瓣的第一个零点位于 $\\Omega=2\\pi(M+1)$。\n- 矩形窗：$M=0$，第一个零点在 $2\\pi$。宽度因子为 $1$。\n- Hann/Hamming 窗：$M=1$，第一个零点在 $4\\pi$。宽度因子为 $2$。\n- Blackman 窗：$M=2$，第一个零点在 $6\\pi$。宽度因子为 $3$。\n\nHann、Hamming 和 Blackman 窗相对于矩形窗的比例常数分别为 $2$、$2$ 和 $3$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2 & 2 & 3\n\\end{pmatrix}\n}\n$$", "id": "2895210"}, {"introduction": "最后的这个练习将我们对窗口函数的理论理解带入定量测量的应用中。当信号的频率不恰好落在 DFT 频率仓上时，其测量到的幅度会减小，这一现象与窗口的频谱形状密切相关。我们将推导并应用一个修正公式，从加窗后的 DFT 频谱中恢复真实的信号幅度，从而展示如何补偿栅栏效应造成的幅度损失以及窗口的相干增益。[@problem_id:2895177]", "problem": "考虑一个通过有限长度余弦和窗观测的单复指数信号，其频谱由离散傅里叶变换 (DFT) 估计。设信号为 $x[n] = A \\exp\\!\\big(j(\\omega_0 n + \\phi)\\big)$，加窗后为 $y[n] = w[n]\\,x[n]$（其中 $n = 0,1,\\dots,N-1$），并定义 DFT 为 $X[k] = \\sum_{n=0}^{N-1} y[n] \\exp\\!\\big(-j 2\\pi k n/N\\big)$。假设真实频率 $\\omega_0$ 位于两个 DFT 谱线 $k_0$ 和 $k_0+1$ 之间，具有一个分数谱线偏移量 $0<\\delta<1$，即 $\\omega_0 = \\tfrac{2\\pi}{N}(k_0+\\delta)$。记 $M$ 为通过对 $k_0$ 附近的三个谱线进行插值得到的幅值谱的插值峰值大小，其中幅值谱为 $|X[k]|/N$，该插值过程也得到了 $\\delta$。假设插值是足够局部的，以至于观测到的峰值来源于以 $\\omega_0$ 为中心的窗函数的离散时间傅里叶变换 (DTFT) 的主瓣。\n\n1) 从 DFT 和离散时间傅里叶变换 (DTFT) 的定义出发，并将窗函数建模为余弦和形式：\n$$\nw[n] = a_0 - a_1 \\cos\\!\\Big(\\tfrac{2\\pi n}{N-1}\\Big) + a_2 \\cos\\!\\Big(\\tfrac{4\\pi n}{N-1}\\Big),\n$$\n推导真实幅值 $A$ 的校正公式。该公式应以测量峰值 $M$、窗函数的相干增益 $G_c = \\tfrac{1}{N}\\sum_{n=0}^{N-1} w[n]$ 以及主瓣形状因子 $S(\\delta)$ 来表示。主瓣形状因子 $S(\\delta)$ 定义为窗函数的 DTFT 在偏移量 $\\tfrac{2\\pi}{N}\\delta$ 处的幅值与其零频幅值之比。证明，在用基数正弦函数替代狄利克雷核 (Dirichlet kernels) 的大 $N$ 近似下，\n$$\n\\operatorname{sinc}(x) \\triangleq \\frac{\\sin(\\pi x)}{\\pi x},\n$$\n余弦和窗的形状因子可以写为\n$$\nS(\\delta) \\approx \\frac{\\big|\\, a_0\\,\\operatorname{sinc}(\\delta) - \\tfrac{a_1}{2}\\big(\\operatorname{sinc}(\\delta-1) + \\operatorname{sinc}(\\delta+1)\\big) + \\tfrac{a_2}{2}\\big(\\operatorname{sinc}(\\delta-2) + \\operatorname{sinc}(\\delta+2)\\big)\\,\\big|}{a_0}.\n$$\n此外，通过计算 $w[n]$ 的和，求出 Hann 窗（常称为 Hanning 窗）、Hamming 窗和 Blackman 窗的相干增益 $G_c$ 的精确有限 $N$ 表达式。\n\n2) 将您的结果应用于以下具体案例：$N=4096$，一个具有系数 $a_0=0.54$、$a_1=0.46$、$a_2=0$ 的 Hamming 窗，估计的分数谱线偏移 $\\delta = \\tfrac{1}{4}$，以及插值幅值谱峰值 $M = 0.5$。在计算中一致地使用大 $N$ 近似来评估 $S(\\delta)$，并用其大 $N$ 近似值进行数值计算 $G_c$。根据您推导的公式，计算校正后的幅值估计 $\\widehat{A}$。将最终数值答案表示为四位有效数字。", "solution": "该问题提法恰当，具有科学依据且内部逻辑一致。我们开始进行解答。\n\n问题分为两部分。首先，我们推导必要的解析公式。其次，我们将它们应用于一个具体的数值案例。\n\n**第一部分：解析推导**\n\n**1) 幅值 A 的校正公式**\n\n加窗后的信号为 $y[n] = w[n]x[n] = w[n] A \\exp(j(\\omega_0 n + \\phi))$，其中 $n = 0, 1, \\dots, N-1$。\n离散傅里叶变换 (DFT) 由下式给出：\n$$X[k] = \\sum_{n=0}^{N-1} y[n] \\exp\\left(-j \\frac{2\\pi k n}{N}\\right) = A e^{j\\phi} \\sum_{n=0}^{N-1} w[n] \\exp\\left(j\\left(\\omega_0 - \\frac{2\\pi k}{N}\\right)n\\right)。$$\n右侧的和是窗函数 $w[n]$ 的离散时间傅里叶变换 (DTFT)，记为 $W(e^{j\\omega}) = \\sum_{n=0}^{N-1} w[n] e^{-j\\omega n}$。\n因此，DFT 可以用窗函数的 DTFT 表示：\n$$X[k] = A e^{j\\phi} W\\left(e^{j(\\omega_0 - \\frac{2\\pi k}{N})}\\right)。$$\nDFT 系数的幅值为 $|X[k]| = A |W(e^{j(\\omega_0 - \\frac{2\\pi k}{N})})|$。\n给定真实频率 $\\omega_0 = \\frac{2\\pi}{N}(k_0 + \\delta)$，在 DFT 谱线 $k$ 处的幅值为\n$$|X[k]| = A \\left|W\\left(e^{j\\frac{2\\pi}{N}(k_0+\\delta-k)}\\right)\\right|。$$\n问题将幅值谱定义为 $|X[k]|/N$。“插值峰值大小 $M$” 是通过三点插值得到的。一个合理的解释是，$M$ 代表了归一化幅值谱中最大 DFT 谱线的幅值，这个解释可以导出一个包含所有指定项的一致公式。对于 $0 < \\delta < 1$，最大的谱线通常在 $k=k_0$ 或 $k=k_0+1$ 处。我们假设 $0 < \\delta \\le 0.5$，因此最大的谱线在 $k=k_0$ 处。\n我们将 $M$ 等同于这个峰值谱线的幅值：\n$$M \\approx \\frac{|X[k_0]|}{N} = \\frac{A}{N} \\left|W\\left(e^{j\\frac{2\\pi}{N}(k_0+\\delta-k_0)}\\right)\\right| = \\frac{A}{N} \\left|W\\left(e^{j\\frac{2\\pi\\delta}{N}}\\right)\\right|。$$\n主瓣形状因子 $S(\\delta)$ 定义为窗函数的 DTFT 在偏移频率 $\\frac{2\\pi\\delta}{N}$ 处的幅值与其直流分量（DC value）之比：\n$$S(\\delta) = \\frac{|W(e^{j\\frac{2\\pi\\delta}{N}})|}{|W(e^{j0})|}。$$\n由此可得 $|W(e^{j\\frac{2\\pi\\delta}{N}})| = S(\\delta) |W(e^{j0})|$。\nDTFT 的直流分量是 $|W(e^{j0})| = |\\sum_{n=0}^{N-1} w[n]|$。由于窗函数通常是实数且非负的，所以这可以简化为 $\\sum_{n=0}^{N-1} w[n]$。\n相干增益 $G_c$ 定义为 $G_c = \\frac{1}{N} \\sum_{n=0}^{N-1} w[n]$，因此 $\\sum_{n=0}^{N-1} w[n] = N G_c$。\n因此， $|W(e^{j0})| = N G_c$。\n将这些关系代回到 $M$ 的表达式中：\n$$M = \\frac{A}{N} |W(e^{j\\frac{2\\pi\\delta}{N}})| = \\frac{A}{N} \\left(S(\\delta) |W(e^{j0})|\\right) = \\frac{A}{N} (S(\\delta) \\cdot N G_c) = A \\cdot G_c \\cdot S(\\delta)。$$\n解出真实幅值 $A$，我们得到所需的校正公式：\n$$A = \\frac{M}{G_c S(\\delta)}。$$\n\n**2) S(δ) 的大 N 近似**\n\n窗函数由下式给出 $w[n] = a_0 - a_1 \\cos(\\frac{2\\pi n}{N-1}) + a_2 \\cos(\\frac{4\\pi n}{N-1})$。使用欧拉公式，\n$$w[n] = a_0 - \\frac{a_1}{2}\\left(e^{j\\frac{2\\pi n}{N-1}} + e^{-j\\frac{2\\pi n}{N-1}}\\right) + \\frac{a_2}{2}\\left(e^{j\\frac{4\\pi n}{N-1}} + e^{-j\\frac{4\\pi n}{N-1}}\\right)。$$\n对于大 $N$，我们可以进行近似 $\\frac{1}{N-1} \\approx \\frac{1}{N}$。这简化了频率项，并使我们能够将其 DTFT 与长度为 $N$ 的矩形窗的 DTFT 联系起来。$w[n]$ 的 DTFT 是一系列移位后的矩形窗 DTFT 的和。\n长度为 $N$ 的矩形窗的 DTFT 是狄利克雷核 (Dirichlet kernel)，$D(\\omega) = \\sum_{n=0}^{N-1} e^{-j\\omega n}$。对于大 $N$ 且频率在直流附近时，其幅值可以近似为一个缩放的基数正弦 (sinc) 函数：$|D(e^{j\\frac{2\\pi f}{N}})| \\approx N|\\operatorname{sinc}(f)|$，其中 $\\operatorname{sinc}(f) = \\frac{\\sin(\\pi f)}{\\pi f}$。\n将此近似应用于 $w[n]$ 的 DTFT：\n$$W(e^{j\\omega}) \\approx a_0 D(\\omega) - \\frac{a_1}{2}\\left(D(\\omega-\\frac{2\\pi}{N}) + D(\\omega+\\frac{2\\pi}{N})\\right) + \\frac{a_2}{2}\\left(D(\\omega-\\frac{4\\pi}{N}) + D(\\omega+\\frac{4\\pi}{N})\\right)。$$\n我们需要计算其在 $\\omega = \\frac{2\\pi\\delta}{N}$ 处的幅值。这对应于中心项的 $f=\\delta$，$a_1$ 项的 $f=\\delta \\mp 1$，以及 $a_2$ 项的 $f=\\delta \\mp 2$。取其幅值，我们得到：\n$$|W(e^{j\\frac{2\\pi\\delta}{N}})| \\approx N \\left| a_0\\operatorname{sinc}(\\delta) - \\frac{a_1}{2}(\\operatorname{sinc}(\\delta-1) + \\operatorname{sinc}(\\delta+1)) + \\frac{a_2}{2}(\\operatorname{sinc}(\\delta-2) + \\operatorname{sinc}(\\delta+2)) \\right|。$$\n$S(\\delta)$ 的分母是 $|W(e^{j0})|$。对于大 $N$，相干增益 $G_c \\approx a_0$，因此 $|W(e^{j0})| = N G_c \\approx N a_0$。\n因此，形状因子为：\n$$S(\\delta) = \\frac{|W(e^{j\\frac{2\\pi\\delta}{N}})|}{|W(e^{j0})|} \\approx \\frac{N \\left| \\dots \\right|}{N a_0} = \\frac{\\left|\\, a_0\\,\\operatorname{sinc}(\\delta) - \\tfrac{a_1}{2}\\big(\\operatorname{sinc}(\\delta-1) + \\operatorname{sinc}(\\delta+1)\\big) + \\tfrac{a_2}{2}\\big(\\operatorname{sinc}(\\delta-2) + \\operatorname{sinc}(\\delta+2)\\big)\\,\\right|}{a_0}。$$\n这证实了问题陈述中给出的表达式。\n\n**3) G_c 的精确有限 N 表达式**\n\n相干增益为 $G_c = \\frac{1}{N} \\sum_{n=0}^{N-1} w[n]$。\n$$G_c = \\frac{1}{N} \\sum_{n=0}^{N-1} \\left[ a_0 - a_1 \\cos\\left(\\frac{2\\pi n}{N-1}\\right) + a_2 \\cos\\left(\\frac{4\\pi n}{N-1}\\right) \\right]。$$\n$$G_c = \\frac{1}{N} \\left[ \\sum_{n=0}^{N-1} a_0 - a_1 \\sum_{n=0}^{N-1} \\cos\\left(\\frac{2\\pi n}{N-1}\\right) + a_2 \\sum_{n=0}^{N-1} \\cos\\left(\\frac{4\\pi n}{N-1}\\right) \\right]。$$\n第一个和是 $\\sum_{n=0}^{N-1} a_0 = N a_0$。对于余弦和，考虑几何级数 $\\sum_{n=0}^{N-1} r^n$，其中 $r = \\exp(j\\frac{2\\pi k}{N-1})$ 且整数 $k \\ge 1$。\n$$ \\sum_{n=0}^{N-1} r^n = \\frac{r^N - 1}{r-1} = \\frac{\\exp\\left(j\\frac{2\\pi k N}{N-1}\\right) - 1}{\\exp\\left(j\\frac{2\\pi k}{N-1}\\right) - 1}。 $$\n由于 $\\exp(j\\frac{2\\pi k N}{N-1}) = \\exp(j\\frac{2\\pi k (N-1+1)}{N-1}) = \\exp(j(2\\pi k + \\frac{2\\pi k}{N-1})) = \\exp(j\\frac{2\\pi k}{N-1}) = r$，所以和为 $\\frac{r-1}{r-1} = 1$。\n余弦和是这个结果的实部：$\\sum_{n=0}^{N-1} \\cos(\\frac{2\\pi k n}{N-1}) = \\operatorname{Re}(1) = 1$。这对 $k=1$ 和 $k=2$ 都成立。\n将此代入 $G_c$ 的表达式中：\n$$G_c = \\frac{1}{N} \\left[ N a_0 - a_1(1) + a_2(1) \\right] = a_0 - \\frac{a_1 - a_2}{N}。$$\n对于特定的窗函数（使用常见的系数定义）：\n- **Hann 窗**: $a_0=0.5, a_1=0.5, a_2=0$。\n  $G_c = 0.5 - \\frac{0.5-0}{N} = 0.5 - \\frac{0.5}{N}$。\n- **Hamming 窗**: $a_0=0.54, a_1=0.46, a_2=0$。\n  $G_c = 0.54 - \\frac{0.46-0}{N} = 0.54 - \\frac{0.46}{N}$。\n- **Blackman 窗**: $a_0=0.42, a_1=0.5, a_2=0.08$。\n  $G_c = 0.42 - \\frac{0.5-0.08}{N} = 0.42 - \\frac{0.42}{N}$。\n\n**第二部分：数值应用**\n\n给定：\n- $N=4096$\n- Hamming 窗: $a_0=0.54, a_1=0.46, a_2=0$\n- 分数谱线偏移: $\\delta = \\frac{1}{4} = 0.25$\n- 插值幅值谱峰值: $M = 0.5$\n\n我们要使用公式 $\\widehat{A} = \\frac{M}{G_c S(\\delta)}$ 计算校正后的幅值估计 $\\widehat{A}$，其中 $G_c$ 和 $S(\\delta)$ 使用大 $N$ 近似。\n\n首先，我们计算相干增益 $G_c$。根据指示，我们使用其大 $N$ 近似值：\n$$G_c \\approx a_0 = 0.54。$$\n接下来，我们计算主瓣形状因子 $S(\\delta)$。对于 Hamming 窗，$a_2=0$，因此公式简化为：\n$$S(\\delta) \\approx \\frac{\\left|\\, a_0\\,\\operatorname{sinc}(\\delta) - \\tfrac{a_1}{2}\\big(\\operatorname{sinc}(\\delta-1) + \\operatorname{sinc}(\\delta+1)\\big)\\,\\right|}{a_0}。$$\n我们使用恒等式 $\\operatorname{sinc}(x \\pm 1) = -\\frac{\\sin(\\pi x)}{\\pi(x \\pm 1)} = \\frac{x}{x\\pm 1} \\frac{-\\sin(\\pi x)}{\\pi x} = \\frac{-x}{x \\pm 1} \\operatorname{sinc}(x)$。\n将这两项相加：$\\operatorname{sinc}(\\delta-1) + \\operatorname{sinc}(\\delta+1) = \\left(-\\frac{\\delta}{\\delta-1} - \\frac{\\delta}{\\delta+1}\\right)\\operatorname{sinc}(\\delta) = -\\delta\\left(\\frac{\\delta+1+\\delta-1}{\\delta^2-1}\\right)\\operatorname{sinc}(\\delta) = \\frac{-2\\delta^2}{\\delta^2-1}\\operatorname{sinc}(\\delta)$。\n$S(\\delta)$ 的表达式变为：\n$$ S(\\delta) \\approx \\frac{\\left|\\, a_0\\,\\operatorname{sinc}(\\delta) - \\tfrac{a_1}{2}\\left(\\frac{-2\\delta^2}{\\delta^2-1}\\operatorname{sinc}(\\delta)\\right)\\,\\right|}{a_0} = \\frac{|\\operatorname{sinc}(\\delta)| \\left| a_0 + a_1\\frac{\\delta^2}{\\delta^2-1} \\right|}{a_0}。$$\n我们对 $\\delta = 0.25$ 进行计算：\n$$ \\operatorname{sinc}(0.25) = \\frac{\\sin(\\pi/4)}{\\pi/4} = \\frac{\\sqrt{2}/2}{\\pi/4} = \\frac{2\\sqrt{2}}{\\pi} \\approx 0.900316。$$\n$$ \\frac{\\delta^2}{\\delta^2-1} = \\frac{(0.25)^2}{(0.25)^2-1} = \\frac{1/16}{1/16-1} = \\frac{1/16}{-15/16} = -\\frac{1}{15}。$$\n$$ S(0.25) \\approx \\frac{|\\operatorname{sinc}(0.25)| \\left| 0.54 + 0.46\\left(-\\frac{1}{15}\\right) \\right|}{0.54} = \\frac{|\\frac{2\\sqrt{2}}{\\pi}| \\left| 0.54 - \\frac{0.46}{15} \\right|}{0.54}。 $$\n$$ S(0.25) \\approx \\frac{0.900316 \\times |0.54 - 0.030666...|}{0.54} = \\frac{0.900316 \\times 0.509333...}{0.54} = \\frac{0.458564}{0.54} \\approx 0.849193。$$\n最后，我们计算校正后的幅值估计 $\\widehat{A}$：\n$$ \\widehat{A} = \\frac{M}{G_c S(\\delta)} \\approx \\frac{0.5}{0.54 \\times 0.849193} = \\frac{0.5}{0.458564} \\approx 1.09035。 $$\n四舍五入到四位有效数字，结果是 $1.090$。", "answer": "$$\\boxed{1.090}$$", "id": "2895177"}]}