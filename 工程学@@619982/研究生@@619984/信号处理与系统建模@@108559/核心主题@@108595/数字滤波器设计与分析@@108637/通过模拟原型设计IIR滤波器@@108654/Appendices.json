{"hands_on_practices": [{"introduction": "脉冲不变法通过直接采样模拟滤波器的脉冲响应，提供了一种将模拟设计转换为数字设计的直观方法。本次实践将引导你从基本定义出发，为一个简单的一阶低通原型设计一个数字滤波器。通过分析其在奈奎斯特频率$\\omega = \\pi$下的响应，你将亲手揭示该方法固有的一个关键特性——混叠现象，并理解它如何影响最终的滤波器性能 [@problem_id:2877742]。", "problem": "考虑一个连续时间、严格真分、稳定的一阶低通模拟原型，其传递函数为 $H_{c}(s) = \\frac{1}{s + a}$，其中 $a > 0$。您需要使用冲激不变法设计一个离散时间无限冲激响应 (IIR) 滤波器，采样周期为 $T > 0$。请从基本定义出发：连续时间冲激响应是 $H_{c}(s)$ 的拉普拉斯逆变换；在冲激不变映射下，离散时间冲激响应与采样后的连续时间冲激响应相关；离散时间序列的 $z$ 变换是其样本的幂级数。\n\n任务：\n1. 推导与 $H_{c}(s)$ 对应的连续时间冲激响应 $h_{c}(t)$。然后，仅使用冲激不变性的定义属性（即离散时间冲激响应是通过在采样周期的整数倍处对连续时间冲激响应进行采样，同时保持冲激面积而得到的），推导离散时间冲激响应 $h[n]$（用 $a$ 和 $T$ 表示）。\n2. 根据您得到的 $h[n]$，计算离散时间传递函数 $H(z)$ 并确定其在复 $z$ 平面中的极点位置。明确说明所得 IIR 滤波器的稳定性条件（用 $a$ 和 $T$ 表示）。\n3. 使用离散时间傅里叶变换 (DTFT) 的定义，评估在奈奎斯特角频率 $\\omega = \\pi$ （弧度/样本）处的频率响应的精确幅值，即计算 $\\left|H\\!\\left(\\exp(j \\pi)\\right)\\right|$，并将其表示为关于 $a$ 和 $T$ 的闭式表达式。\n4. 根据您的表达式，简要讨论在 $\\omega = \\pi$ 附近的衰减如何随 $a$ 和 $T$ 的变化而变化，并解释冲激不变法固有的混叠在这种行为形成中所起的作用。\n\n将您的最终答案表示为 $\\left|H\\!\\left(\\exp(j \\pi)\\right)\\right|$ 关于 $a$ 和 $T$ 的精确解析表达式。最终答案中不应代入数值，也不需要单位。角度以弧度为单位。", "solution": "在尝试求解之前，将首先对问题陈述进行严格验证。\n\n给定条件如下：\n- 连续时间传递函数：$H_{c}(s) = \\frac{1}{s + a}$。\n- 系统属性：连续时间、严格真分、稳定的一阶低通模拟原型。\n- 参数约束：$a > 0$， $T > 0$。\n- 设计方法：冲激不变法。\n- 冲激不变性的定义：“离散时间冲激响应是通过在采样周期的整数倍处对连续时间冲激响应进行采样，同时保持冲激面积而得到的”。\n- 任务：\n    1. 推导 $h_c(t)$ 和 $h[n]$。\n    2. 推导 $H(z)$、其极点及稳定性条件。\n    3. 计算 $\\left|H\\!\\left(\\exp(j \\pi)\\right)\\right|$。\n    4. 在混叠的背景下讨论结果。\n\n该问题具有科学依据，是客观的，并且涉及无限冲激响应滤波器的设计，这是信号处理中的一个核心课题。然而，所提供的冲激不变性定义存在潜在的歧义。短语“保持冲激面积”并非标准术语，可以有多种解释。连续时间冲激响应下的面积由积分 $\\int_{-\\infty}^{\\infty} h_c(t) dt = H_c(0) = \\frac{1}{a}$ 给出。该积分的一个离散时间近似是缩放后的和 $\\sum_{n=-\\infty}^{\\infty} T h_c(nT)$。离散时间冲激响应样本的和为 $\\sum_{n=-\\infty}^{\\infty} h[n]$。如果将“保持冲激面积”解释为将所得离散时间响应的和等同于连续时间面积的离散近似，我们得到 $\\sum h[n] = \\sum T h_c(nT)$，这意味着关系式 $h[n] = T h_c(nT)$。这个定义虽然并不总是最先被介绍的，但在权威教科书中是最常见的，因为它确保了数字滤波器的频率响应能够正确地近似模拟滤波器频率响应的幅值。另一种定义 $h[n] = h_c(nT)$ 源于直接采样，但如果没有一个额外的缩放因子，就无法保持这种频域关系。考虑到滤波器设计的背景，最合乎逻辑且有用的解释是 $h[n] = T h_c(nT)$。因此，在此合理且标准的解释下，该问题被认为是有效的。我们继续进行求解。\n\n1. 首先，我们通过对原型传递函数 $H_c(s)$ 进行拉普拉斯逆变换来推导连续时间冲激响应 $h_c(t)$。给定的传递函数为 $H_c(s) = \\frac{1}{s+a}$。这是一个标准的变换对。对于一个稳定系统（$a > 0$），其收敛域为 $\\text{Re}(s) > -a$。\n$$h_c(t) = \\mathcal{L}^{-1}\\left\\{\\frac{1}{s+a}\\right\\}(t) = \\exp(-at)u(t)$$\n其中 $u(t)$ 是连续时间亥维赛（Heaviside）阶跃函数。接下来，我们使用冲激不变映射 $h[n] = T h_c(nT)$（如上所述）来推导离散时间冲激响应 $h[n]$。\n$$h[n] = T h_c(nT) = T \\exp(-a(nT)) u(nT)$$\n由于 $n$ 是整数，采样后的亥维赛函数 $u(nT)$ 等价于离散时间单位阶跃函数 $u[n]$，即当 $n \\ge 0$ 时为 $1$，当 $n < 0$ 时为 $0$。\n$$h[n] = T \\exp(-anT) u[n]$$\n\n2. 现在，我们通过对 $h[n]$ 进行 $z$ 变换来计算离散时间传递函数 $H(z)$。$z$ 变换定义为 $H(z) = \\sum_{n=-\\infty}^{\\infty} h[n] z^{-n}$。\n$$H(z) = \\sum_{n=0}^{\\infty} T \\exp(-anT) z^{-n} = T \\sum_{n=0}^{\\infty} \\left(\\exp(-aT) z^{-1}\\right)^n$$\n这是一个几何级数，形式为 $\\sum_{k=0}^{\\infty} r^k = \\frac{1}{1-r}$，当 $|r| < 1$ 时收敛。这里的公比是 $r = \\exp(-aT) z^{-1}$。\n$$H(z) = \\frac{T}{1 - \\exp(-aT)z^{-1}}$$\n收敛域为 $|\\exp(-aT)z^{-1}| < 1$，这意味着 $|z| > \\exp(-aT)$。传递函数的极点是使分母为零的 $z$ 值：$1 - \\exp(-aT)z^{-1} = 0$，由此得出极点位置为 $z_p = \\exp(-aT)$。\n要使所得的 IIR 滤波器稳定，其极点必须严格位于复 $z$ 平面的单位圆内，即 $|z_p| < 1$。\n条件是 $|\\exp(-aT)| < 1$。由于 $a$ 和 $T$ 都是实数，这等价于 $\\exp(-aT) < 1$。对两边取自然对数，得到 $-aT < \\ln(1)$，即 $-aT < 0$。这可以简化为 $aT > 0$。鉴于问题指定 $a > 0$ 且 $T > 0$，这个稳定性条件总是满足的。这是一个预期的结果，因为冲激不变法会将一个稳定的模拟滤波器映射为一个稳定的数字滤波器。\n\n3. 离散时间滤波器的频率响应 $H(\\exp(j\\omega))$ 是通过在单位圆 $z = \\exp(j\\omega)$ 上求值 $H(z)$ 得到的，其中 $\\omega$ 是离散时间角频率，单位为弧度/样本。我们被要求评估在奈奎斯特频率 $\\omega = \\pi$ 处的频率响应幅值。\n$$H(\\exp(j\\pi)) = \\left.H(z)\\right|_{z=\\exp(j\\pi)=-1} = \\frac{T}{1 - \\exp(-aT)(\\exp(j\\pi))^{-1}}$$\n由于 $\\exp(j\\pi) = -1$，其倒数也是 $-1$。\n$$H(\\exp(j\\pi)) = \\frac{T}{1 - \\exp(-aT)(-1)} = \\frac{T}{1 + \\exp(-aT)}$$\n为了求幅值 $\\left|H(\\exp(j\\pi))\\right|$，我们观察到由于 $a > 0$ 且 $T > 0$，项 $\\exp(-aT)$ 是一个介于 $0$ 和 $1$ 之间的正实数。分子 $T$ 也是一个正实数。因此，整个表达式是一个正实数，其幅值就是表达式本身。\n$$\\left|H(\\exp(j\\pi))\\right| = \\frac{T}{1 + \\exp(-aT)}$$\n\n4. 推导出的表达式 $\\frac{T}{1 + \\exp(-aT)}$ 量化了滤波器在最高离散频率 $\\omega = \\pi$ 处的增益。此增益非零，这是冲激不变法固有的混叠现象的直接结果。数字滤波器的频率响应是模拟滤波器频率响应的移位副本的叠加：$H(\\exp(j\\Omega T)) = \\sum_{k=-\\infty}^{\\infty} H_c(j(\\Omega - \\frac{2\\pi k}{T}))$。在奈奎斯特频率 $\\Omega = \\frac{\\pi}{T}$ 处，响应 $H(\\exp(j\\pi))$ 不仅包括衰减后的模拟响应 $H_c(j\\frac{\\pi}{T})$ (对应 $k=0$)，还包括所有混叠项 $H_c(j(\\frac{\\pi}{T} - \\frac{2\\pi k}{T}))$ (其中 $k \\in \\mathbb{Z}, k \\neq 0$) 的贡献。对于低通原型，这些混叠项（尤其是来自 $k=1$ 的项，对应于 $\\Omega = -\\pi/T$）会相长叠加，导致非零增益。\n奈奎斯特频率处的增益作为 $a$ 和 $T$ 的函数的行为证实了这一点。\n- 当 $a$ 增加时（固定 $T$），模拟滤波器的带宽变宽，意味着其响应 $|H_c(j\\Omega)|$ 衰减得更慢。这导致了更强的混叠分量。数学上，当 $a \\to \\infty$ 时，$\\exp(-aT) \\to 0$，且 $|H(\\exp(j\\pi))| \\to T$。奈奎斯特频率处的衰减减弱了。\n- 当 $T$ 增加时（采样频率 $1/T$ 减小），混叠变得更加严重，因为移位的频谱被更紧密地挤在一起。数学上，当 $T \\to \\infty$ 时， $|H(\\exp(j\\pi))| \\to \\infty$ （因为分子线性增长而分母趋近于 $1$）。相反，当 $T \\to 0$ 时（采样频率趋于无穷大），混叠消失。在此极限下， $|H(\\exp(j\\pi))| = \\frac{T}{1+\\exp(-aT)} \\to \\frac{0}{2} = 0$，这与低通滤波器在无限高频率处的预期行为一致。\n因此，$\\omega = \\pi$ 处的增益是衡量给定原型和采样周期下混叠严重程度的直接指标。", "answer": "$$\\boxed{\\frac{T}{1 + \\exp(-aT)}}$$", "id": "2877742"}, {"introduction": "在IIR滤波器设计中，选择合适的模拟到数字转换方法至关重要，因为不同的方法会导致不同的频率响应特性。本练习将让你直接比较两种经典方法：脉冲不变法和双线性变换法。你将以同一个二阶巴特沃斯低通滤波器为原型，通过计算两种设计方法下的数字截止频率，量化地理解它们在频率映射上的核心差异 [@problem_id:2877784]。", "problem": "您正在设计一个离散时间无限冲激响应 (IIR) 低通滤波器，该设计将两种经典的模拟-数字映射方法应用于同一个连续时间模拟原型。该模拟原型是一个二阶 Butterworth 低通滤波器，其传递函数为\n$$\nH_{a}(s) \\;=\\; \\frac{\\Omega_{c}^{2}}{s^{2} \\;+\\; \\sqrt{2}\\,\\Omega_{c}\\,s \\;+\\; \\Omega_{c}^{2}} \\, ,\n$$\n其中，截止角频率定义为\n$$\n\\Omega_{c} \\;=\\; 2\\pi f_{c} \\, ,\n$$\n且 $f_{c}$ 是负 $3\\,\\text{dB}$ 点处的模拟截止频率。设采样频率为 $f_{s}$，采样周期为 $T$，且\n$$\nf_{c} \\;=\\; 500\\,\\text{Hz}， \\qquad f_{s} \\;=\\; 8000\\,\\text{Hz}， \\qquad T \\;=\\; \\frac{1}{f_{s}}。\n$$\n您将基于同一个模拟原型实现两种数字设计：\n- 设计A：冲激不变法，通过对连续时间冲激响应 $h_{a}(t)$ 进行采样来定义，即 $h_{d}[n] \\,=\\, T\\,h_{a}(nT)$。\n- 设计B：双线性变换（无预畸变），通过基于梯形法则的从 $s$ 平面到 $z$ 平面的映射来定义。\n\n仅从连续时间傅里叶变换 (CTFT)、离散时间傅里叶变换 (DTFT) 的核心定义，以及定义了冲激不变法和双线性变换的映射构造出发，完成以下任务：\n1) 证明该模拟原型的负 $3\\,\\text{dB}$ 点出现在 $\\Omega \\,=\\, \\Omega_{c}$ 处。\n2) 从第一性原理出发，为每种设计推导连接数字弧度频率 $\\omega$ (单位：弧度/采样点) 与模拟弧度频率 $\\Omega$ (单位：弧度/秒) 的频率映射关系。然后，确定这两种设计的数字负 $3\\,\\text{dB}$ 频率 $\\omega_{\\mathrm{ii}}$ 和 $\\omega_{\\mathrm{bl}}$。\n3) 使用给定的 $f_{c}$ 和 $f_{s}$，计算比率\n$$\nR \\;=\\; \\frac{\\omega_{\\mathrm{ii}}}{\\omega_{\\mathrm{bl}}} \\, .\n$$\n假设对于给定的 $f_{c}/f_{s}$，由冲激不变法引入的模拟频谱混叠在基带中可以忽略不计。将您计算出的 $R$ 的最终数值结果四舍五入到四位有效数字。报告一个无单位的数字（不带单位）。在需要时，角度量的单位应酌情使用弧度或弧度/采样点。", "solution": "所述问题是有效的。它在科学上基于数字信号处理的原理，特别是 IIR 滤波器的设计。该问题提法完善，为获得唯一解提供了所有必要的数据和定义。其语言客观且明确。我们开始求解。\n\n该问题要求对一个二阶 Butterworth 低通滤波器及其数字实现进行三部分分析。\n\n第1部分：验证模拟原型的负 $3\\,\\text{dB}$ 频率。\n\n模拟原型滤波器的传递函数由下式给出：\n$$\nH_{a}(s) = \\frac{\\Omega_{c}^{2}}{s^{2} + \\sqrt{2}\\Omega_{c}s + \\Omega_{c}^{2}}\n$$\n为了求得频率响应，我们将 $s = j\\Omega$ (其中 $\\Omega$ 是模拟弧度频率) 代入 $H_{a}(s)$，即在虚轴上进行求值。\n$$\nH_{a}(j\\Omega) = \\frac{\\Omega_{c}^{2}}{(j\\Omega)^{2} + \\sqrt{2}\\Omega_{c}(j\\Omega) + \\Omega_{c}^{2}} = \\frac{\\Omega_{c}^{2}}{-\\Omega^{2} + j\\sqrt{2}\\Omega_{c}\\Omega + \\Omega_{c}^{2}} = \\frac{\\Omega_{c}^{2}}{(\\Omega_{c}^{2} - \\Omega^{2}) + j(\\sqrt{2}\\Omega_{c}\\Omega)}\n$$\n频率响应的幅值平方为 $|H_{a}(j\\Omega)|^{2}$。\n$$\n|H_{a}(j\\Omega)|^{2} = \\frac{|\\Omega_{c}^{2}|^{2}}{|(\\Omega_{c}^{2} - \\Omega^{2}) + j(\\sqrt{2}\\Omega_{c}\\Omega)|^{2}} = \\frac{\\Omega_{c}^{4}}{(\\Omega_{c}^{2} - \\Omega^{2})^{2} + (\\sqrt{2}\\Omega_{c}\\Omega)^{2}}\n$$\n展开分母：\n$$\n(\\Omega_{c}^{4} - 2\\Omega_{c}^{2}\\Omega^{2} + \\Omega^{4}) + 2\\Omega_{c}^{2}\\Omega^{2} = \\Omega_{c}^{4} + \\Omega^{4}\n$$\n因此，幅值平方响应为：\n$$\n|H_{a}(j\\Omega)|^{2} = \\frac{\\Omega_{c}^{4}}{\\Omega_{c}^{4} + \\Omega^{4}}\n$$\n负 $3\\,\\text{dB}$ 点是幅值 $|H_{a}(j\\Omega)|$ 降为其最大值的 $1/\\sqrt{2}$ 时的频率。最大值出现在直流（$\\Omega = 0$）处，此时 $|H_{a}(j0)|^{2} = \\frac{\\Omega_{c}^{4}}{\\Omega_{c}^{4} + 0} = 1$，所以 $|H_{a}(j0)| = 1$。因此，负 $3\\,\\text{dB}$ 的条件是 $|H_{a}(j\\Omega)| = 1/\\sqrt{2}$，或等效地，$|H_{a}(j\\Omega)|^{2} = 1/2$。\n将幅值平方响应设为 $1/2$：\n$$\n\\frac{\\Omega_{c}^{4}}{\\Omega_{c}^{4} + \\Omega^{4}} = \\frac{1}{2}\n$$\n$$\n2\\Omega_{c}^{4} = \\Omega_{c}^{4} + \\Omega^{4}\n$$\n$$\n\\Omega^{4} = \\Omega_{c}^{4}\n$$\n由于频率 $\\Omega$ 必须为非负值，我们取其实数正根：\n$$\n\\Omega = \\Omega_{c}\n$$\n这证明了模拟原型的负 $3\\,\\text{dB}$ 截止频率确实是 $\\Omega_{c}$。\n\n第2部分：频率映射和数字截止频率的推导。\n\n情况A：冲激不变法\n冲激不变法通过对连续时间冲激响应 $h_{a}(t)$ 进行采样来定义离散时间冲激响应 $h_{d}[n]$，使得 $h_{d}[n] = T h_{a}(nT)$，其中 $T$ 是采样周期。数字滤波器的频率响应 $H_{d}(e^{j\\omega})$ 是 $h_{d}[n]$ 的离散时间傅里叶变换 (DTFT)。采样序列的 DTFT 与原始信号的连续时间傅里叶变换 (CTFT) 之间的关系由混叠公式给出：\n$$\nH_{d}(e^{j\\omega}) = \\sum_{k=-\\infty}^{\\infty} H_{a}\\left(j\\left(\\frac{\\omega}{T} - \\frac{2\\pi k}{T}\\right)\\right)\n$$\n题目要求假设混叠可以忽略不计。这意味着在感兴趣的频率范围（基带，其中 $k=0$），由频谱搬移（$k \\neq 0$ 的项）产生的贡献是微不足道的。在此假设下，关系简化为：\n$$\nH_{d}(e^{j\\omega}) \\approx H_{a}\\left(j\\frac{\\omega}{T}\\right)\n$$\n这给出了模拟频率 $\\Omega$ 与数字频率 $\\omega$ 之间的直接线性映射：\n$$\n\\Omega = \\frac{\\omega}{T}\n$$\n数字负 $3\\,\\text{dB}$ 频率 $\\omega_{\\mathrm{ii}}$ 是使 $|H_{d}(e^{j\\omega_{\\mathrm{ii}}})|$ 处于其负 $3\\,\\text{dB}$ 点的频率。由于存在直接对应关系 $H_{d}(e^{j\\omega}) \\approx H_{a}(j\\Omega)$，这种情况发生在映射的模拟频率 $\\Omega$ 等于模拟截止频率 $\\Omega_{c}$ 时。\n$$\n\\Omega_{c} = \\frac{\\omega_{\\mathrm{ii}}}{T} \\implies \\omega_{\\mathrm{ii}} = \\Omega_{c} T\n$$\n\n情况B：双线性变换\n双线性变换由以下代换定义：\n$$\ns = \\frac{2}{T} \\frac{1 - z^{-1}}{1 + z^{-1}}\n$$\n为了找到模拟频率和数字频率之间的关系，我们令 $s = j\\Omega$ 和 $z = e^{j\\omega}$。\n$$\nj\\Omega = \\frac{2}{T} \\frac{1 - e^{-j\\omega}}{1 + e^{-j\\omega}}\n$$\n我们简化关于 $e^{-j\\omega}$ 的有理表达式：\n$$\n\\frac{1 - e^{-j\\omega}}{1 + e^{-j\\omega}} = \\frac{e^{j\\omega/2}(e^{j\\omega/2} - e^{-j\\omega/2})}{e^{j\\omega/2}(e^{j\\omega/2} + e^{-j\\omega/2})} = \\frac{2j\\sin(\\omega/2)}{2\\cos(\\omega/2)} = j\\tan\\left(\\frac{\\omega}{2}\\right)\n$$\n将此代回可得：\n$$\nj\\Omega = \\frac{2}{T} j\\tan\\left(\\frac{\\omega}{2}\\right) \\implies \\Omega = \\frac{2}{T} \\tan\\left(\\frac{\\omega}{2}\\right)\n$$\n这种非线性关系被称为频率畸变。数字滤波器的频率响应为 $H_{d}(e^{j\\omega}) = H_{a}(j\\frac{2}{T} \\tan(\\frac{\\omega}{2}))$。当等效模拟频率等于 $\\Omega_{c}$ 时，即为数字负 $3\\,\\text{dB}$ 频率 $\\omega_{\\mathrm{bl}}$。\n$$\n\\Omega_{c} = \\frac{2}{T} \\tan\\left(\\frac{\\omega_{\\mathrm{bl}}}{2}\\right)\n$$\n求解 $\\omega_{\\mathrm{bl}}$：\n$$\n\\tan\\left(\\frac{\\omega_{\\mathrm{bl}}}{2}\\right) = \\frac{\\Omega_{c} T}{2} \\implies \\omega_{\\mathrm{bl}} = 2\\arctan\\left(\\frac{\\Omega_{c} T}{2}\\right)\n$$\n\n第3部分：计算比率 $R$。\n\n我们被要求计算比率 $R = \\omega_{\\mathrm{ii}} / \\omega_{\\mathrm{bl}}$。使用第2部分中推导出的表达式：\n$$\nR = \\frac{\\omega_{\\mathrm{ii}}}{\\omega_{\\mathrm{bl}}} = \\frac{\\Omega_{c} T}{2\\arctan\\left(\\frac{\\Omega_{c} T}{2}\\right)}\n$$\n首先，我们计算项 $\\Omega_{c} T$ 的值。\n给定的模拟截止频率为 $f_{c} = 500\\,\\text{Hz}$。所以，$\\Omega_{c} = 2\\pi f_{c} = 2\\pi(500) = 1000\\pi\\,\\text{rad/s}$。\n采样频率为 $f_{s} = 8000\\,\\text{Hz}$，因此采样周期为 $T = 1/f_{s} = 1/8000\\,\\text{s}$。\n乘积 $\\Omega_{c} T$ 为：\n$$\n\\Omega_{c} T = (1000\\pi) \\left(\\frac{1}{8000}\\right) = \\frac{1000\\pi}{8000} = \\frac{\\pi}{8}\n$$\n该值给出了冲激不变法设计的数字截止频率：$\\omega_{\\mathrm{ii}} = \\pi/8\\,\\text{rad/sample}$。\n现在将这个值代入 $R$ 的表达式中：\n$$\nR = \\frac{\\pi/8}{2\\arctan\\left(\\frac{\\pi/8}{2}\\right)} = \\frac{\\pi/8}{2\\arctan\\left(\\frac{\\pi}{16}\\right)}\n$$\n我们计算其数值。\n反正切函数的参数为 $\\pi/16 \\approx 3.14159265 / 16 \\approx 0.19634954$。\n反正切值为 $\\arctan(\\pi/16) \\approx 0.19383638\\,\\text{rad}$。\n$$\nR \\approx \\frac{0.39269908}{2 \\times 0.19383638} = \\frac{0.39269908}{0.38767276} \\approx 1.0129653\n$$\n四舍五入到四位有效数字，我们得到 $R = 1.013$。", "answer": "$$\\boxed{1.013}$$", "id": "2877784"}, {"introduction": "双线性变换不仅是一种简单的代数代换，它更深植于对连续时间系统状态方程进行离散化的基本原理之中。本实践将从一个更根本的视角——状态空间表示出发，推导出双线性变换。此外，你还将学习并应用频率预畸变技术，这是一种为补偿双线性变换固有的频率“翘曲”效应而设计的关键校正步骤，以确保数字滤波器的截止频率精确地落在期望的位置 [@problem_id:2877756]。", "problem": "考虑一个单输入、单输出、连续时间、线性时不变系统，其状态空间形式由 $\\,\\dot{x}(t)=A\\,x(t)+B\\,u(t)\\,$ 和 $\\,y(t)=C\\,x(t)+D\\,u(t)\\,$ 给出，其中 $\\,x(t)\\in\\mathbb{R}^{n}$，$\\,u(t)\\in\\mathbb{R}$，且 $\\,y(t)\\in\\mathbb{R}$。设采样周期为 $\\,T>0\\,$，并记 $\\,x[k]\\triangleq x(kT)\\,$、$\\,u[k]\\triangleq u(kT)\\,$ 和 $\\,y[k]\\triangleq y(kT)\\,$。\n\n任务1：仅从线性系统的微积分基本关系式出发，即 $\\,x(t_k)=x(t_{k-1})+\\int_{t_{k-1}}^{t_k}\\dot{x}(\\tau)\\,d\\tau\\,$，其中 $\\,\\dot{x}(\\tau)=A\\,x(\\tau)+B\\,u(\\tau)\\,$，通过在区间 $[t_{k-1},t_k]$ 上使用梯形法则近似该积分，推导出一个形式为 $\\,\\text{(矩阵)}\\cdot x[k]=\\text{(矩阵)}\\cdot x[k-1]+\\text{(矩阵)}\\cdot u[k]+\\text{(矩阵)}\\cdot u[k-1]\\,$ 的离散时间状态更新方程。然后，给出与此离散化一致的相应采样输出方程 $\\,y[k]\\,$。不要假设 $A$、$B$、$C$ 或 $D$ 具有任何特定结构，也不要使用任何预先推导出的离散化公式。\n\n任务2：将此离散化方法与双线性变换（Tustin 方法）联系起来，从你的状态更新推导中，推断出将梯形法则应用于一阶积分器时所隐含的拉普拉斯变量 $\\,s\\,$ 与 $\\,z\\,$ 变换变量 $\\,z\\,$ 之间的映射关系。将此映射关系明确地表述为 $\\,s\\,$ 和 $\\,z\\,$ 之间的一个代数关系。\n\n任务3：使用频率预畸变，从一阶模拟原型 $\\,H_{a}(s)=\\dfrac{\\Omega_{c}}{s+\\Omega_{c}}\\,$ 设计一个离散时间无限脉冲响应低通滤波器，使得数字 $-3\\,\\text{dB}$ 截止频率出现在期望的离散时间角频率 $\\,\\omega_{p}\\,$ 处。设采样频率为 $\\,F_{s}=48{,}000\\,\\text{Hz}\\,$，期望的通带边缘频率为 $\\,f_{p}=3{,}000\\,\\text{Hz}\\,$。通过设置 $\\,\\Omega_{c}=\\dfrac{2}{T}\\tan\\!\\big(\\omega_{p}/2\\big)\\,$，其中 $\\,\\omega_{p}=2\\pi f_{p}/F_{s}\\,$ 且 $\\,T=1/F_{s}\\,$，来进行预畸变，然后应用你的双线性映射来定位所得数字滤波器的唯一离散时间极点 $\\,z_{p}\\,$。\n\n将你的最终答案以 $\\,z_{p}\\,$ 的数值形式给出，四舍五入到六位有效数字。最终答案应表示为无单位的纯数。", "solution": "所给出的问题是数字信号处理和系统理论领域中的一个标准、适定的练习。该问题在科学上是合理的，内部是一致的，并包含完整推导和求解所需的所有信息。我们将按顺序处理这三个任务。\n\n第一个任务要求使用梯形法则进行数值积分，从连续时间模型推导离散时间状态空间表示。我们从应用于状态向量 $\\,x(t)\\,$ 在区间 $\\,[t_{k-1}, t_k]\\,$ 上的微积分基本定理开始，其中 $\\,t_k \\triangleq kT\\,$，采样周期为 $\\,T\\,$。\n$$x(t_k) = x(t_{k-1}) + \\int_{t_{k-1}}^{t_k} \\dot{x}(\\tau) \\,d\\tau$$\n使用离散时间记法 $\\,x[k] \\triangleq x(kT)\\,$，上式变为：\n$$x[k] = x[k-1] + \\int_{(k-1)T}^{kT} \\dot{x}(\\tau) \\,d\\tau$$\n用于近似定积分的梯形法则指出 $\\,\\int_a^b f(\\tau) \\,d\\tau \\approx \\frac{b-a}{2} \\left[f(a) + f(b)\\right]\\,$。将其应用于我们的状态积分，其中 $\\,a=(k-1)T\\,$ 且 $\\,b=kT\\,$，我们得到：\n$$\\int_{(k-1)T}^{kT} \\dot{x}(\\tau) \\,d\\tau \\approx \\frac{T}{2} \\left[ \\dot{x}((k-1)T) + \\dot{x}(kT) \\right]$$\n我们已知状态动态方程为 $\\,\\dot{x}(t) = A\\,x(t) + B\\,u(t)\\,$。将其在时间 $\\,(k-1)T\\,$ 和 $\\,kT\\,$ 处代入近似式：\n$$\\dot{x}((k-1)T) = A\\,x((k-1)T) + B\\,u((k-1)T) = A\\,x[k-1] + B\\,u[k-1]$$\n$$\\dot{x}(kT) = A\\,x(kT) + B\\,u(kT) = A\\,x[k] + B\\,u[k]$$\n将这些表达式代回离散状态更新方程，得到：\n$$x[k] = x[k-1] + \\frac{T}{2} \\left( (A\\,x[k-1] + B\\,u[k-1]) + (A\\,x[k] + B\\,u[k]) \\right)$$\n为获得所需形式 $\\,\\text{(矩阵)}\\cdot x[k]=\\text{(矩阵)}\\cdot x[k-1]+\\text{(矩阵)}\\cdot u[k]+\\text{(矩阵)}\\cdot u[k-1]\\,$，我们必须将包含 $\\,x[k]\\,$ 的项收集到左侧，而将所有其他项收集到右侧。\n$$x[k] - \\frac{T}{2}A\\,x[k] = x[k-1] + \\frac{T}{2}A\\,x[k-1] + \\frac{T}{2}B\\,u[k-1] + \\frac{T}{2}B\\,u[k]$$\n将状态向量和输入向量因子化，其中 $\\,I\\,$ 是 $\\,n \\times n\\,$ 单位矩阵：\n$$\\left(I - \\frac{T}{2}A\\right)x[k] = \\left(I + \\frac{T}{2}A\\right)x[k-1] + \\left(\\frac{T}{2}B\\right)u[k-1] + \\left(\\frac{T}{2}B\\right)u[k]$$\n这就是指定隐式形式的离散时间状态更新方程。相应的采样输出方程是通过在时间 $\\,t=kT\\,$ 对连续时间输出方程 $\\,y(t)=C\\,x(t)+D\\,u(t)\\,$ 进行直接采样得到的。这得到：\n$$y[k] = C\\,x[k] + D\\,u[k]$$\n这是最简单、最直接的方法，与输出方程是一个代数约束（而非需要应用积分法则的微分约束）这一事实相符。\n\n第二个任务是推导这种离散化方法中隐含的拉普拉斯变量 $\\,s\\,$ 与 $\\,z\\,$ 变换变量 $\\,z\\,$ 之间的关系。我们分析一个一阶积分器，其输入-输出关系为 $\\,\\dot{x}(t) = u(t)\\,$。在状态空间形式中，这对应于一个标量系统，其中 $\\,A=0\\,$ 且 $\\,B=1\\,$。为进行此分析，我们假设状态 $\\,x(t)\\,$ 是输出，因此 $\\,y(t)=x(t)\\,$。这个连续时间积分器的传递函数是 $\\,H_a(s) = \\frac{X(s)}{U(s)} = \\frac{1}{s}\\,$。\n我们应用我们推导的离散时间状态更新方程，其中 $\\,A=0\\,$ 且 $\\,B=1\\,$：\n$$\\left(1 - \\frac{T}{2}\\cdot 0\\right)x[k] = \\left(1 + \\frac{T}{2}\\cdot 0\\right)x[k-1] + \\left(\\frac{T}{2}\\cdot 1\\right)u[k-1] + \\left(\\frac{T}{2}\\cdot 1\\right)u[k]$$\n$$x[k] = x[k-1] + \\frac{T}{2}(u[k-1] + u[k])$$\n对该方程进行 $\\,z\\,$ 变换，我们得到：\n$$X(z) = z^{-1}X(z) + \\frac{T}{2}(z^{-1}U(z) + U(z))$$\n$$X(z)(1 - z^{-1}) = \\frac{T}{2}U(z)(1 + z^{-1})$$\n因此，离散时间传递函数 $\\,H_d(z) = \\frac{X(z)}{U(z)}\\,$ 为：\n$$H_d(z) = \\frac{T}{2} \\frac{1+z^{-1}}{1-z^{-1}} = \\frac{T}{2} \\frac{z+1}{z-1}$$\n离散化过程已将模拟传递函数 $\\,H_a(s)=\\frac{1}{s}\\,$ 转换为数字传递函数 $\\,H_d(z)\\,$。通过设置 $\\,H_d(z) = H_a(s)\\,$ 并求解 $\\,s\\,$，可以找到该映射关系。\n$$\\frac{T}{2} \\frac{z+1}{z-1} = \\frac{1}{s}$$\n求解 $\\,s\\,$ 即可得到梯形法则中隐含的映射，即双线性变换（也称为 Tustin 方法）：\n$$s = \\frac{2}{T}\\frac{z-1}{z+1}$$\n\n第三个任务是一个实际的滤波器设计问题。我们必须使用带有频率预畸变的双线性变换，从模拟原型 $\\,H_{a}(s)=\\dfrac{\\Omega_{c}}{s+\\Omega_{c}}\\,$ 设计一个一阶低通数字滤波器。设计指标为采样频率 $\\,F_{s}=48{,}000\\,\\text{Hz}\\,$ 和期望的通带边缘频率为 $\\,f_{p}=3{,}000\\,\\text{Hz}\\,$，后者对应于 $\\,-3\\,\\text{dB}\\,$ 截止频率。模拟滤波器的极点位于 $\\,s_p = -\\Omega_c\\,$。所得数字滤波器的极点 $\\,z_p\\,$ 是通过将双线性变换映射应用于模拟极点得到的：\n$$s_p = \\frac{2}{T}\\frac{z_p-1}{z_p+1} \\implies -\\Omega_c = \\frac{2}{T}\\frac{z_p-1}{z_p+1}$$\n频率预畸变确保所选择的模拟截止频率 $\\,\\Omega_c\\,$ 使得经过变换后，数字截止频率恰好落在期望值 $\\,\\omega_p\\,$。提供的预畸变公式是 $\\,\\Omega_{c}=\\dfrac{2}{T}\\tan(\\frac{\\omega_{p}}{2})\\,$。我们将此代入我们的极点映射方程：\n$$-\\frac{2}{T}\\tan\\left(\\frac{\\omega_{p}}{2}\\right) = \\frac{2}{T}\\frac{z_p-1}{z_p+1}$$\n项 $\\,\\frac{2}{T}\\,$ 从两侧消去，得到极点 $\\,z_p\\,$ 与期望的数字截止频率 $\\,\\omega_p\\,$ 之间的直接关系：\n$$-\\tan\\left(\\frac{\\omega_{p}}{2}\\right) = \\frac{z_p-1}{z_p+1}$$\n我们求解 $\\,z_p\\,$：\n$$-(z_p+1)\\tan\\left(\\frac{\\omega_{p}}{2}\\right) = z_p-1$$\n$$-z_p\\tan\\left(\\frac{\\omega_{p}}{2}\\right) - \\tan\\left(\\frac{\\omega_{p}}{2}\\right) = z_p-1$$\n$$1 - \\tan\\left(\\frac{\\omega_{p}}{2}\\right) = z_p + z_p\\tan\\left(\\frac{\\omega_{p}}{2}\\right)$$\n$$1 - \\tan\\left(\\frac{\\omega_{p}}{2}\\right) = z_p\\left(1 + \\tan\\left(\\frac{\\omega_{p}}{2}\\right)\\right)$$\n$$z_p = \\frac{1 - \\tan(\\omega_{p}/2)}{1 + \\tan(\\omega_{p}/2)}$$\n现在，我们计算数值。采样周期为 $\\,T = 1/F_s = 1/48000\\,\\text{s}\\,$。期望的离散时间角频率是：\n$$\\omega_{p} = \\frac{2\\pi f_{p}}{F_{s}} = \\frac{2\\pi (3000)}{48000} = \\frac{6000\\pi}{48000} = \\frac{\\pi}{8}\\,\\text{rad/sample}$$\n我们需要 $\\,\\tan(\\omega_p/2) = \\tan(\\pi/16)\\,$ 的值。\n$$\\tan\\left(\\frac{\\pi}{16}\\right) \\approx 0.198912367$$\n将此值代入 $\\,z_p\\,$ 的表达式中：\n$$z_p = \\frac{1 - 0.198912367...}{1 + 0.198912367...} = \\frac{0.801087632...}{1.198912367...} \\approx 0.668178637...$$\n四舍五入到六位有效数字，离散时间极点的数值为 $\\,0.668179\\,$。", "answer": "$$\\boxed{0.668179}$$", "id": "2877756"}]}