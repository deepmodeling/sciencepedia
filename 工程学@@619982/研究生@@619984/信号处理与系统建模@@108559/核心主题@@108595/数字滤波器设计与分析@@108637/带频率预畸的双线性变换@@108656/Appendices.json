{"hands_on_practices": [{"introduction": "在我们应用频率预畸变技术之前，必须首先理解它为何既是必要的也是可能的。本练习 [@problem_id:2854927] 旨在挑战您对双线性变换核心数学特性的批判性思维。通过分析从模拟域到数字域的频率映射关系，您将阐明我们为何能够在一个整体非线性的变换中，于特定频率点上实现精确匹配。", "problem": "一个连续时间模拟原型滤波器将通过双线性变换（BLT）映射到一个离散时间数字滤波器。设双线性变换由拉普拉斯变量 $s$ 和 $z$ 变换变量 $z$ 之间的映射定义为 $s = \\dfrac{2}{T}\\,\\dfrac{1 - z^{-1}}{1 + z^{-1}}$，其中 $T > 0$ 是采样周期。频率响应的计算通过为连续时间设置 $s = j\\Omega$ 和为离散时间设置 $z = e^{j\\omega}$ 在虚轴和单位圆上进行，其中 $\\Omega$ 是连续时间弧度频率（单位：弧度/秒），$\\omega$ 是离散时间归一化弧度频率（单位：弧度/样本）。假设一个数字指标要求精确匹配 $2$ 个不同的数字边缘频率 $\\omega_{1}$ 和 $\\omega_{2}$（例如，带通滤波器的下通带边缘和上通带边缘）。一种称为频率预畸变的常用做法是为原型选择独立的模拟边缘频率 $\\Omega_{1}^{\\star}$ 和 $\\Omega_{2}^{\\star}$，以使得经过双线性变换后，数字滤波器的边缘正好在 $\\omega_{1}$ 和 $\\omega_{2}$ 处。\n\n从双线性变换的第一性原理以及频率响应求值映射 $s = j\\Omega$ 和 $z = e^{j\\omega}$ 出发，以下哪个陈述最好地解释了为什么通过选择独立的模拟预畸变边缘，可以在 $2$ 个指定的数字频率上进行精确的预畸变，而模拟频率和数字频率之间的整体映射在这些边缘之间仍然是非线性的？\n\nA. 由双线性变换在频率求值下导出的从 $j\\Omega$ 到 $e^{j\\omega}$ 的映射是虚轴到单位圆上的一一对应的、严格单调的双射，因此逆映射逐点存在；所以可以独立地选择 $\\Omega_{k}^{\\star}$ 来精确匹配每个指定的 $\\omega_{k}$。然而，$\\Omega(\\omega)$ 关系是 $\\omega$ 的非线性函数，因此固定有限个点并不能使映射在区间上线性化；结果是，在 $\\omega_{1}$ 和 $\\omega_{2}$ 之间，频率间距被非线性地畸变。\n\nB. 双线性变换在频率上是仿射的，因此关于 $\\omega$ 是线性的；匹配任意 $2$ 个点会强制它们之间的整个映射变为线性，因此 $\\omega_{1}$ 和 $\\omega_{2}$ 之间的间距被保留而没有畸变。\n\nC. 在 $2$ 个频率上进行精确预畸变需要同时使用两个不同的采样周期 $T$，每个边缘一个；这在 $\\omega_{1}$ 和 $\\omega_{2}$ 处实现了精确性，然后它们之间的映射是线性的，因为每个分段使用其自己的 $T$。\n\nD. 因为双线性变换是共形的，它保留了虚轴上的频率间距；因此，一旦边缘被预畸变以匹配 $\\omega_{1}$ 和 $\\omega_{2}$，所有中间频率都以成比例的间距进行映射，这意味着边缘之间是线性的。\n\nE. 预畸变强制两个边缘处的群延迟相等，而相等的群延迟意味着恒定的相位斜率，这使得 $\\omega_{1}$ 和 $\\omega_{2}$ 之间的频率映射是线性的。", "solution": "首先对问题陈述进行严格验证。\n\n步骤 1：提取已知条件\n- 双线性变换映射为 $s = \\dfrac{2}{T}\\,\\dfrac{1 - z^{-1}}{1 + z^{-1}}$。\n- 采样周期为 $T > 0$。\n- 通过设置连续时间系统的 $s = j\\Omega$ 和离散时间系统的 $z = e^{j\\omega}$ 进行频率响应求值。\n- $\\Omega$ 是连续时间弧度频率。\n- $\\omega$ 是离散时间归一化弧度频率。\n- 一个设计要求是在 $2$ 个不同的数字频率 $\\omega_{1}$ 和 $\\omega_{2}$ 处精确匹配。\n- 这通过频率预畸变实现，它涉及到选择相应的模拟频率 $\\Omega_{1}^{\\star}$ 和 $\\Omega_{2}^{\\star}$。\n- 问题要求从第一性原理出发，解释为什么在两点上的精确匹配是可能的，而这些点之间的频率映射仍然是非线性的。\n\n步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据。双线性变换和频率预畸变的概念是数字信号处理中的标准基础课题。所有给出的定义和方程在文献中都是正确和标准的。问题是适定的；它要求一个可以直接从所提供的数学关系中推导出的概念性解释。语言是客观和精确的。问题是自洽的，不包含任何矛盾或歧义。它要求理解双线性变换固有的频率映射的数学性质。\n\n步骤 3：结论与行动\n问题是有效的。将推导解答。\n\n这个问题的核心在于双线性变换所建立的连续时间频率 $\\Omega$ 和离散时间频率 $\\omega$ 之间的关系。我们从变换的定义开始：\n$$s = \\dfrac{2}{T}\\,\\dfrac{1 - z^{-1}}{1 + z^{-1}}$$\n为了找到频率映射关系，我们代入频率响应求值的表达式，$s = j\\Omega$ 和 $z = e^{j\\omega}$：\n$$j\\Omega = \\dfrac{2}{T}\\,\\dfrac{1 - e^{-j\\omega}}{1 + e^{-j\\omega}}$$\n为了简化右边，我们利用一个标准恒等式。我们可以将分子和分母同乘以 $e^{j\\omega/2}$：\n$$j\\Omega = \\dfrac{2}{T}\\,\\dfrac{e^{j\\omega/2}(1 - e^{-j\\omega})}{e^{j\\omega/2}(1 + e^{-j\\omega})} = \\dfrac{2}{T}\\,\\dfrac{e^{j\\omega/2} - e^{-j\\omega/2}}{e^{j\\omega/2} + e^{-j\\omega/2}}$$\n使用欧拉恒等式，我们认出正弦和余弦的表达式：\n$$e^{j\\theta} - e^{-j\\theta} = 2j\\sin(\\theta)$$\n$$e^{j\\theta} + e^{-j\\theta} = 2\\cos(\\theta)$$\n将这些应用于 $\\theta = \\omega/2$，方程变为：\n$$j\\Omega = \\dfrac{2}{T}\\,\\dfrac{2j\\sin(\\omega/2)}{2\\cos(\\omega/2)}$$\n简化此表达式得到：\n$$j\\Omega = \\dfrac{2}{T}\\,j\\tan\\left(\\dfrac{\\omega}{2}\\right)$$\n我们消去两边的虚数单位 $j$，得到频率畸变关系：\n$$\\Omega = \\dfrac{2}{T}\\tan\\left(\\dfrac{\\omega}{2}\\right)$$\n这个方程明确地将连续时间频率 $\\Omega$ 定义为离散时间频率 $\\omega$ 的函数。让我们来分析这个函数 $\\Omega(\\omega)$。\n\n离散时间频率的唯一值域的定义域通常是 $\\omega \\in (-\\pi, \\pi)$。在这个区间内，正切函数的参数 $\\omega/2$ 位于 $(-\\pi/2, \\pi/2)$。函数 $\\tan(x)$ 在 $(-\\pi/2, \\pi/2)$ 上是严格单调递增的。因此，函数 $\\Omega(\\omega)$ 在 $\\omega \\in (-\\pi, \\pi)$ 上也是严格单调递增的。根据定义，严格单调的函数是一对一的（单射）。当 $\\omega$ 遍历 $(-\\pi, \\pi)$ 时，$\\Omega$ 的值域是 $(-\\infty, \\infty)$。因此，从 $\\omega \\in (-\\pi, \\pi)$ 到 $\\Omega \\in (-\\infty, \\infty)$ 的映射是一个双射。\n\n双射的存在意味着对于每个唯一的数字频率 $\\omega_{k}$，存在一个单一、唯一的对应模拟频率 $\\Omega_{k}$。预畸变的过程涉及到反向使用此关系。给定最终数字滤波器所需的一个临界频率 $\\omega_{k}$，可以使用以下公式计算原型滤波器设计所需的模拟频率 $\\Omega_{k}^{\\star}$：\n$$\\Omega_{k}^{\\star} = \\dfrac{2}{T}\\tan\\left(\\dfrac{\\omega_{k}}{2}\\right)$$\n由于这个计算可以对任何给定的 $\\omega_{k}$ 进行，因此当然也可以对两个不同的频率 $\\omega_{1}$ 和 $\\omega_{2}$ 进行。我们只需计算：\n$$\\Omega_{1}^{\\star} = \\dfrac{2}{T}\\tan\\left(\\dfrac{\\omega_{1}}{2}\\right)$$\n$$\\Omega_{2}^{\\star} = \\dfrac{2}{T}\\tan\\left(\\dfrac{\\omega_{2}}{2}\\right)$$\n通过设计一个具有这些精确边缘频率 $\\Omega_{1}^{\\star}$ 和 $\\Omega_{2}^{\\star}$ 的模拟原型滤波器，后续应用双线性变换可以保证得到的数字滤波器的边缘正好位于 $\\omega_{1}$ 和 $\\omega_{2}$。这解释了为什么在有限个点上进行精确匹配是可能的。\n\n现在，我们必须回答问题的第二部分：为什么这些点*之间*的映射仍然是非线性的。该关系是 $\\Omega(\\omega) = \\frac{2}{T}\\tan(\\frac{\\omega}{2})$。一个线性关系的形式应为 $\\Omega(\\omega) = c_{1}\\omega + c_{0}$，其中 $c_{1}$ 和 $c_{0}$ 是常数。正切函数根本上是非线性的。它的图像是一条曲线，而不是一条直线。强制映射通过两个特定点 $(\\omega_{1}, \\Omega_{1}^{\\star})$ 和 $(\\omega_{2}, \\Omega_{2}^{\\star})$，并不会改变正切函数本身的内在非线性性质。频率“轴”被非均匀地拉伸和压缩。这正是“畸变”的精确含义。例如，数字域中的中点频率 $\\omega_{m} = (\\omega_{1}+\\omega_{2})/2$ 不会映射到模拟域中的中点频率 $\\Omega_{m} = (\\Omega_{1}^{\\star}+\\Omega_{2}^{\\star})/2$。通常情况下，$\\frac{2}{T}\\tan(\\frac{\\omega_{1}+\\omega_{2}}{4}) \\neq \\frac{1}{2}\\left(\\frac{2}{T}\\tan(\\frac{\\omega_{1}}{2}) + \\frac{2}{T}\\tan(\\frac{\\omega_{2}}{2})\\right)$。\n\n现在我们将根据这个推导来评估每个选项。\n\nA. 这个选项指出映射是“一一对应的、严格单调的双射”，这与我们的推导相符。它正确地论证了逆映射的存在允许逐点选择 $\\Omega_{k}^{\\star}$ 来匹配任何 $\\omega_{k}$。然后它指出关系 $\\Omega(\\omega)$ 是非线性的，这是由于正切函数。最后，它得出结论：固定点并不能使映射线性化，并且间距被非线性地畸变。这个陈述与我们从第一性原理的推导完全一致。\n**结论：正确。**\n\nB. 这个选项声称双线性变换是“在频率上是仿射的，因此关于 $\\omega$ 是线性的”。这根本上是错误的。频率映射是 $\\Omega = \\frac{2}{T}\\tan(\\frac{\\omega}{2})$，这是一个非线性的正切函数，而不是仿射函数 ($ax+b$)。声称匹配 $2$ 个点会强制线性化是一个严重的数学错误。\n**结论：不正确。**\n\nC. 这个选项建议“同时使用两个不同的采样周期 $T$”。双线性变换是用单一的采样周期 $T$ 为整个系统定义的。引入多个 $T$ 值将是一个完全不同的、不一致的变换，而不是双线性变换。预畸变公式对所有频率使用相同的 $T$。\n**结论：不正确。**\n\nD. 这个选项援引了双线性变换是“共形”映射的性质。虽然这是真的，但得出的结论是错误的。共形映射在局部保留角度，但通常不保留距离或间距。其“保留频率间距”并暗示“成比例的间距”和“线性”的说法，与 $\\Omega \\propto \\tan(\\omega/2)$ 所描述的畸变效应正好相反。\n**结论：不正确。**\n\nE. 这个选项错误地将预畸变与群延迟联系起来。预畸变是调整频率点的过程，不是以这种方式操纵滤波器的相位或群延迟特性。声称相等的群延迟意味着线性频率映射，是混淆了两个独立的概念：滤波器的线性相位响应（恒定的群延迟）和将一个频率轴线性映射到另一个频率轴。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2854927"}, {"introduction": "在建立了坚实的理论基础后，我们现在可以着手解决一个完整的滤波器设计问题。这个实践环节 [@problem_id:2854931] 模拟了一项真实的工程任务：根据严格的性能指标，确定所需滤波器的复杂度。您将从一组数字域的要求出发，运用频率预畸变技术将其转换到模拟域，最终推导出巴特沃斯（Butterworth）原型滤波器所需阶数 $N$ 的通用公式。", "problem": "一个固定的数字低通滤波器指标将通过设计一个连续时间 Butterworth 原型来实现，该原型使用采样周期为 $T$ 的双线性变换映射到离散时间域。数字指标以离散时间弧度频率和幅度约束的形式给出，如下所示：\n\n- 通带边沿位于 $\\omega_{p}$ (弧度/采样点)，且 $0 < \\omega_{p} < \\pi$。\n- 阻带边沿位于 $\\omega_{s}$ (弧度/采样点)，且 $\\omega_{p} < \\omega_{s} < \\pi$。\n- 最大通带损耗为 $A_{p}$ 分贝 (dB)，意味着在 $\\omega_{p}$ 处的幅度至少为 $10^{-A_{p}/20}$。\n- 最小阻带衰减为 $A_{s}$ 分贝 (dB)，意味着在 $\\omega_{s}$ 处的幅度至多为 $10^{-A_{s}/20}$。\n\n角度以弧度为单位。从连续时间原型到离散时间滤波器的映射是通过经典双线性变换完成的，该变换源于对连续时间积分器的梯形积分法，它将 s-平面中的虚轴随频率单调地映射到 z-平面中的单位圆。\n\n从 (i) Butterworth 幅度响应的定义 $|H(j\\Omega)|^{2} = \\frac{1}{1 + (\\Omega/\\Omega_{c})^{2N}}$ (其中 $\\Omega_{c}$ 为截止频率，$N$ 为阶数)，(ii) 通带和阻带约束的分贝定义，以及 (iii) 作为单位圆上的 $\\omega$ 与虚轴上的 $\\Omega$ 之间的共形映射的双线性变换出发，推导出预畸变的模拟通带和阻带弧度频率 $\\Omega_{p}(T)$ 和 $\\Omega_{s}(T)$ 作为 $T$ 的函数，然后推导出映射后满足数字指定约束所需的最小实数值模拟 Butterworth 阶数 $N(T)$ (不进行任何整数取整)。\n\n你的最终答案必须是 $N(T)$ 的一个闭式解析表达式，用 $\\omega_{p}$、$\\omega_{s}$、$A_{p}$ 和 $A_{s}$ 表示，并尽可能简化。不要取整。角度必须以弧度为单位。最终方框内的答案不应出现任何单位。", "solution": "该问题陈述已经过验证，并被认定为有效。这是一个来自数字信号处理领域的适定的、有科学依据的问题，没有矛盾、歧义或事实错误。该问题要求推导应用双线性变换后，满足一组数字滤波器指标所需的最小实数值 Butterworth 滤波器阶数。\n\n我们按照要求从第一性原理开始推导。\n\n双线性变换定义了从连续时间系统的复 s 平面到离散时间系统的复 z 平面的映射。该变换由代换 $s = \\frac{2}{T} \\frac{1-z^{-1}}{1+z^{-1}}$ 给出，其中 T 是采样周期。为了找到连续时间频率 $\\Omega$ 和离散时间频率 $\\omega$ 之间的关系，我们在各自域的稳定边界上对该表达式进行求值，即连续时间域的 $s=j\\Omega$ (虚轴) 和离散时间域的 $z=e^{j\\omega}$ (单位圆)。\n\n将这些代入变换方程：\n$$j\\Omega = \\frac{2}{T} \\frac{1-e^{-j\\omega}}{1+e^{-j\\omega}}$$\n我们使用数学恒等式 $\\frac{1-e^{-j\\theta}}{1+e^{-j\\theta}} = \\frac{e^{j\\theta/2} - e^{-j\\theta/2}}{e^{j\\theta/2} + e^{-j\\theta/2}} = \\frac{2j\\sin(\\theta/2)}{2\\cos(\\theta/2)} = j\\tan(\\frac{\\theta}{2})$。\n应用此恒等式，令 $\\theta = \\omega$，我们得到：\n$$j\\Omega = \\frac{2}{T} j\\tan\\left(\\frac{\\omega}{2}\\right)$$\n这简化为频率畸变关系：\n$$\\Omega = \\frac{2}{T} \\tan\\left(\\frac{\\omega}{2}\\right)$$\n这个方程将数字频率 $\\omega$ (单位为弧度/采样点) 映射到相应的模拟频率 $\\Omega$ (单位为弧度/秒)。为了设计一个经过变换后能在 $\\omega_p$ 和 $\\omega_s$ 处满足数字指标的模拟原型滤波器，我们必须首先将这些数字频率映射到模拟域。这些就是预畸变的模拟频率 $\\Omega_p$ 和 $\\Omega_s$。根据要求，它们是 $T$ 的函数：\n$$\\Omega_p(T) = \\frac{2}{T} \\tan\\left(\\frac{\\omega_p}{2}\\right)$$\n$$\\Omega_s(T) = \\frac{2}{T} \\tan\\left(\\frac{\\omega_s}{2}\\right)$$\n\n接下来，我们考虑模拟 Butterworth 原型的幅度指标。一个 N 阶 Butterworth 低通滤波器的幅度平方响应由下式给出：\n$$|H(j\\Omega)|^2 = \\frac{1}{1 + \\left(\\frac{\\Omega}{\\Omega_c}\\right)^{2N}}$$\n其中 $\\Omega_c$ 是模拟截止频率，N 是滤波器阶数。\n\n数字滤波器指标必须转换到模拟域。\n通带指标要求在 $\\omega_p$ 处的幅度至少为 $10^{-A_p/20}$。这转换为在相应模拟频率 $\\Omega_p$ 处对幅度平方响应的约束：\n$$|H(j\\Omega_p)|^2 \\ge \\left(10^{-A_p/20}\\right)^2 = 10^{-A_p/10}$$\n代入 Butterworth 响应公式：\n$$\\frac{1}{1 + \\left(\\frac{\\Omega_p}{\\Omega_c}\\right)^{2N}} \\ge 10^{-A_p/10}$$\n$$1 + \\left(\\frac{\\Omega_p}{\\Omega_c}\\right)^{2N} \\le 10^{A_p/10}$$\n$$\\left(\\frac{\\Omega_p}{\\Omega_c}\\right)^{2N} \\le 10^{A_p/10} - 1$$\n\n阻带指标要求在 $\\omega_s$ 处的幅度至多为 $10^{-A_s/20}$。这转换为在 $\\Omega_s$ 处的约束：\n$$|H(j\\Omega_s)|^2 \\le \\left(10^{-A_s/20}\\right)^2 = 10^{-A_s/10}$$\n代入 Butterworth 响应公式：\n$$\\frac{1}{1 + \\left(\\frac{\\Omega_s}{\\Omega_c}\\right)^{2N}} \\le 10^{-A_s/10}$$\n$$1 + \\left(\\frac{\\Omega_s}{\\Omega_c}\\right)^{2N} \\ge 10^{A_s/10}$$\n$$\\left(\\frac{\\Omega_s}{\\Omega_c}\\right)^{2N} \\ge 10^{A_s/10} - 1$$\n\n为了找到满足两个约束条件的最小阶数 $N$，我们可以将它们设为等式，这意味着滤波器响应将精确地通过指标的角点。\n$$1) \\quad \\left(\\frac{\\Omega_p}{\\Omega_c}\\right)^{2N} = 10^{A_p/10} - 1$$\n$$2) \\quad \\left(\\frac{\\Omega_s}{\\Omega_c}\\right)^{2N} = 10^{A_s/10} - 1$$\n为了求解 $N$，我们通过将方程 $(2)$ 除以方程 $(1)$ 来消去未知的截止频率 $\\Omega_c$：\n$$\\frac{\\left(\\frac{\\Omega_s}{\\Omega_c}\\right)^{2N}}{\\left(\\frac{\\Omega_p}{\\Omega_c}\\right)^{2N}} = \\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}$$\n$$\\left(\\frac{\\Omega_s}{\\Omega_p}\\right)^{2N} = \\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}$$\n为了求解 $N$，我们对两边取以 10 为底的对数：\n$$\\log_{10}\\left[\\left(\\frac{\\Omega_s}{\\Omega_p}\\right)^{2N}\\right] = \\log_{10}\\left(\\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}\\right)$$\n$$2N \\log_{10}\\left(\\frac{\\Omega_s}{\\Omega_p}\\right) = \\log_{10}\\left(\\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}\\right)$$\n分离出 $N$ 可得：\n$$N = \\frac{\\log_{10}\\left(\\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}\\right)}{2\\log_{10}\\left(\\frac{\\Omega_s}{\\Omega_p}\\right)}$$\n这给出了用预畸变模拟频率表示的阶数 $N$。最后一步是用数字频率 $\\omega_p$ 和 $\\omega_s$ 的表达式来代换 $\\Omega_p$ 和 $\\Omega_s$。比值 $\\frac{\\Omega_s}{\\Omega_p}$ 为：\n$$\\frac{\\Omega_s}{\\Omega_p} = \\frac{\\frac{2}{T} \\tan\\left(\\frac{\\omega_s}{2}\\right)}{\\frac{2}{T} \\tan\\left(\\frac{\\omega_p}{2}\\right)} = \\frac{\\tan\\left(\\frac{\\omega_s}{2}\\right)}{\\tan\\left(\\frac{\\omega_p}{2}\\right)}$$\n注意到采样周期 $T$ 被消掉了。因此，模拟原型所需的最小阶数 $N$ 与采样周期 $T$ 无关。函数 $N(T)$ 是一个关于 $T$ 的常数函数。\n\n将此比值代入 $N$ 的方程中，我们得到最小实数值阶数 $N(T)$ 的最终表达式，由于它不依赖于 $T$，为简单起见写作 $N$:\n$$N = \\frac{\\log_{10}\\left(\\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}\\right)}{2\\log_{10}\\left(\\frac{\\tan(\\omega_s/2)}{\\tan(\\omega_p/2)}\\right)}$$\n此表达式表示根据双线性变换和滤波器设计指标的基本原理推导出的模拟原型滤波器所需的先验（实数值）Butterworth 阶数。", "answer": "$$\n\\boxed{\n\\frac{\\log_{10}\\left(\\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}\\right)}{2\\log_{10}\\left(\\frac{\\tan(\\omega_s/2)}{\\tan(\\omega_p/2)}\\right)}\n}\n$$", "id": "2854931"}, {"introduction": "理论与设计公式固然强大，但亲眼见证其在实践中的效果才能带来最深刻的理解。最后的这个动手实践 [@problem_id:2854923] 是一个计算练习，您将把带预畸变的双线性变换与其他常见的离散化方法（如前向和后向欧拉法）进行定量比较。通过计算并分析不同方法的频率响应误差，您将对每种技术的优缺点获得切实的体会，并精确地看到预畸变技术在何种情况下能提供决定性的优势。", "problem": "给定一个连续时间积分器，其传递函数由关系式 $H_{c}(s) = \\dfrac{1}{s}$ 定义，对应于微分方程 $\\dfrac{dy(t)}{dt} = u(t)$。您需要使用三种从第一性原理推导出的不同数值方案对此积分器进行离散化处理：（i）前向（显式）矩形积分法，（ii）后向（隐式）矩形积分法，以及（iii）被解释为双线性变换（BLT）的梯形法则。采样频率为 $f_{s}$（单位为 $\\mathrm{Hz}$），采样周期为 $T_{s} = \\frac{1}{f_{s}}$（单位为 $\\mathrm{s}$）。对于双线性变换（BLT），请在目标物理频率 $f_{t}$（单位为 $\\mathrm{Hz}$）处实现频率预畸变，使得广义BLT映射 $s \\approx c \\frac{1 - z^{-1}}{1 + z^{-1}}$ 使用一个常数 $c$，该常数经选择以满足在目标频率处的匹配条件：$\\Omega_{t} = c \\tan\\left(\\frac{\\omega_{t}}{2}\\right)$，其中 $\\Omega_{t} = 2\\pi f_{t}$（单位为 $\\mathrm{rad/s}$），而 $\\omega_{t} = 2\\pi \\frac{f_{t}}{f_{s}}$（单位为 $\\mathrm{rad}$）。计算中使用的所有角度量都必须以弧度为单位。\n\n从定义 $\\dfrac{dy(t)}{dt} = u(t)$ 和经典的数值积分法则出发，推导每种离散时间传递函数 $H_{d}(z)$，并在单位圆 $z = e^{j\\omega}$ 上评估其频率响应，以获得在指定评估频率下的 $H_{d}\\left(e^{j\\omega}\\right)$。对于每个评估频率 $f$（单位为 $\\mathrm{Hz}$），定义连续时间角频率 $\\Omega = 2\\pi f$（单位为 $\\mathrm{rad/s}$）和离散时间角频率 $\\omega = 2\\pi \\frac{f}{f_{s}}$（单位为 $\\mathrm{rad}$）。在频率 $\\Omega$ 处的连续时间参考响应为 $H_{c}(j\\Omega) = \\dfrac{1}{j\\Omega}$。\n\n对于每种方法，按如下方式量化在低频和高频处的复频率响应误差：\n- 在频率 $f$ 处的相对复数幅值误差：$E_{\\mathrm{mag}}(f) = \\dfrac{\\left| H_{d}\\left(e^{j\\omega}\\right) - H_{c}(j\\Omega) \\right|}{\\left| H_{c}(j\\Omega) \\right|}$。\n- 在频率 $f$ 处的相位误差：$E_{\\mathrm{ph}}(f) = \\operatorname{PV}\\left(\\angle H_{d}\\left(e^{j\\omega}\\right) - \\angle H_{c}(j\\Omega)\\right)$，其中 $\\operatorname{PV}(\\cdot)$ 表示包裹在区间 $\\left[-\\pi,\\pi\\right]$ 内的主值（单位为 $\\mathrm{rad}$）。\n\n下方的测试套件指定了三组参数集，每组提供一个采样频率 $f_{s}$、一个用于BLT的目标预畸变频率 $f_{t}$，以及两个用于探究低频和高频行为的评估频率 $(f_{\\mathrm{low}}, f_{\\mathrm{high}})$。请使用以下确切值：\n- 测试用例 $1$：$f_{s} = 1000$，$f_{t} = 50$，$f_{\\mathrm{low}} = 1$，$f_{\\mathrm{high}} = 400$。\n- 测试用例 $2$：$f_{s} = 48000$，$f_{t} = 3000$，$f_{\\mathrm{low}} = 10$，$f_{\\mathrm{high}} = 18000$。\n- 测试用例 $3$：$f_{s} = 8000$，$f_{t} = 1000$，$f_{\\mathrm{low}} = 0.5$，$f_{\\mathrm{high}} = 3000$。\n\n对于每个测试用例，按以下顺序为三种方法中的每一种计算在 $f_{\\mathrm{low}}$ 和 $f_{\\mathrm{high}}$ 处的误差度量对 $(E_{\\mathrm{mag}}, E_{\\mathrm{ph}})$：前向矩形法（前向欧拉法）、后向矩形法（后向欧拉法）和带预畸变的BLT。将整个测试套件的结果汇总到单个输出行中，具体如下。对于每个测试用例，连接六个有序对\n$\\big[ (E_{\\mathrm{mag}}^{\\mathrm{F}}, E_{\\mathrm{ph}}^{\\mathrm{F}})_{f_{\\mathrm{low}}}, (E_{\\mathrm{mag}}^{\\mathrm{F}}, E_{\\mathrm{ph}}^{\\mathrm{F}})_{f_{\\mathrm{high}}}, (E_{\\mathrm{mag}}^{\\mathrm{B}}, E_{\\mathrm{ph}}^{\\mathrm{B}})_{f_{\\mathrm{low}}}, (E_{\\mathrm{mag}}^{\\mathrm{B}}, E_{\\mathrm{ph}}^{\\mathrm{B}})_{f_{\\mathrm{high}}}, (E_{\\mathrm{mag}}^{\\mathrm{T}}, E_{\\mathrm{ph}}^{\\mathrm{T}})_{f_{\\mathrm{low}}}, (E_{\\mathrm{mag}}^{\\mathrm{T}}, E_{\\mathrm{ph}}^{\\mathrm{T}})_{f_{\\mathrm{high}}} \\big]$，\n其中上标 $\\mathrm{F}$、$\\mathrm{B}$ 和 $\\mathrm{T}$ 分别表示前向法、后向法和梯形法（BLT）。您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的浮点数列表，其顺序严格按照上述描述，即测试用例1的结果，后接测试用例2的结果，再后接测试用例3的结果。所有角度必须以弧度为单位，所有数值必须使用给定的 $\\mathrm{Hz}$ 输入进行计算。除了所需的列表外，不应打印任何额外文本。", "solution": "所述问题在科学上是合理的、适定的且客观的。它提出了数字信号处理中的一个标准任务：连续时间系统的离散化以及对由此产生的近似误差的分析。所有必需的参数和定义均已提供，问题内部没有矛盾，也没有违反任何物理或数学原理。因此，我将给出一个完整的、有理有据的解答。\n\n该问题要求对由传递函数 $H_c(s) = \\dfrac{1}{s}$ 或等效微分方程 $\\dfrac{dy(t)}{dt} = u(t)$ 定义的连续时间积分器进行离散化。我们将使用三种数值积分方法推导离散时间传递函数 $H_d(z)$，并随后分析它们的频率响应误差。采样周期为 $T_s = 1/f_s$。\n\n数值积分的基本关系式由微分方程的积分形式导出：\n$$y(nT_s) - y((n-1)T_s) = \\int_{(n-1)T_s}^{nT_s} u(\\tau) d\\tau$$\n在离散时间表示法中，设 $y_n = y(nT_s)$ 和 $u_n = u(nT_s)$，上式变为：\n$$y_n - y_{n-1} = \\int_{(n-1)T_s}^{nT_s} u(\\tau) d\\tau$$\n\n我们现在为三种指定方法中的每一种推导其传递函数。\n\n1.  **前向（显式）矩形法 / 前向欧拉法**\n    该方法通过考虑区间开始处的被积函数值 $u((n-1)T_s) = u_{n-1}$ 来近似该积分。\n    $$y_n - y_{n-1} \\approx T_s u_{n-1}$$\n    假设初始条件为零，应用Z变换，得到：\n    $$Y(z) - z^{-1}Y(z) = T_s z^{-1}U(z)$$\n    $$Y(z)(1 - z^{-1}) = T_s z^{-1}U(z)$$\n    因此，离散时间传递函数为：\n    $$H_d^{\\mathrm{F}}(z) = \\frac{Y(z)}{U(z)} = \\frac{T_s z^{-1}}{1 - z^{-1}} = \\frac{T_s}{z - 1}$$\n    这对应于在 $H_c(s)$ 中进行替换 $s \\rightarrow \\dfrac{z-1}{T_s}$。\n\n2.  **后向（隐式）矩形法 / 后向欧拉法**\n    该方法通过使用区间结束处的被积函数值 $u(nT_s) = u_n$ 来近似该积分。\n    $$y_n - y_{n-1} \\approx T_s u_n$$\n    应用Z变换：\n    $$Y(z) - z^{-1}Y(z) = T_s U(z)$$\n    $$Y(z)(1 - z^{-1}) = T_s U(z)$$\n    得到的传递函数为：\n    $$H_d^{\\mathrm{B}}(z) = \\frac{Y(z)}{U(z)} = \\frac{T_s}{1 - z^{-1}} = \\frac{T_s z}{z - 1}$$\n    这对应于进行替换 $s \\rightarrow \\dfrac{1-z^{-1}}{T_s}$。\n\n3.  **梯形法则 / 带频率预畸变的双线性变换（BLT）**\n    此方法通过使用区间起点和终点处被积函数值的平均值，将积分近似为梯形的面积。\n    $$y_n - y_{n-1} \\approx \\frac{T_s}{2} (u_{n-1} + u_n)$$\n    应用Z变换：\n    $$Y(z)(1 - z^{-1}) = \\frac{T_s}{2} U(z)(z^{-1} + 1)$$\n    标准梯形法则的传递函数为：\n    $$H_d(z) = \\frac{Y(z)}{U(z)} = \\frac{T_s}{2} \\frac{1 + z^{-1}}{1 - z^{-1}}$$\n    这对应于标准的双线性变换替换 $s \\rightarrow \\dfrac{2}{T_s} \\dfrac{1 - z^{-1}}{1 + z^{-1}}$。\n    问题指定了带频率预畸变的广义BLT，使用替换 $s \\rightarrow c \\dfrac{1 - z^{-1}}{1 + z^{-1}}$。将此应用于 $H_c(s) = 1/s$，我们得到：\n    $$H_d^{\\mathrm{T}}(z) = \\frac{1}{c} \\frac{1 + z^{-1}}{1 - z^{-1}} = \\frac{1}{c} \\frac{z+1}{z-1}$$\n    常数 $c$ 由预畸变条件确定，该条件强制频率映射在指定的目标频率 $f_t$ 处是精确的。该条件为 $\\Omega_t = c \\tan(\\omega_t/2)$，其中 $\\Omega_t = 2\\pi f_t$ 是连续时间角频率，$\\omega_t = 2\\pi f_t / f_s$ 是离散时间角频率。由此，我们求得 $c$：\n    $$c = \\frac{\\Omega_t}{\\tan(\\omega_t/2)} = \\frac{2\\pi f_t}{\\tan(\\pi f_t / f_s)}$$\n\n接下来，我们通过代入 $z = e^{j\\omega}$（其中 $\\omega = 2\\pi f / f_s$）来评估每个离散时间系统的频率响应。参考的连续时间响应为 $H_c(j\\Omega) = \\dfrac{1}{j\\Omega} = -\\dfrac{j}{\\Omega}$，其中 $\\Omega = 2\\pi f$。其幅值为 $|H_c(j\\Omega)| = 1/\\Omega$，相位为 $\\angle H_c(j\\Omega) = -\\pi/2$。\n\n离散时间系统的频率响应为：\n1.  **前向欧拉法**：$H_d^{\\mathrm{F}}(e^{j\\omega}) = \\dfrac{T_s}{e^{j\\omega}-1} = \\dfrac{T_s}{(\\cos\\omega-1)+j\\sin\\omega} = -\\dfrac{T_s}{2} - j\\dfrac{T_s}{2\\tan(\\omega/2)}$。\n2.  **后向欧拉法**：$H_d^{\\mathrm{B}}(e^{j\\omega}) = \\dfrac{T_s e^{j\\omega}}{e^{j\\omega}-1} = \\dfrac{T_s}{2} - j\\dfrac{T_s}{2\\tan(\\omega/2)}$。\n3.  **BLT**：$H_d^{\\mathrm{T}}(e^{j\\omega}) = \\dfrac{1}{c} \\dfrac{1+e^{-j\\omega}}{1-e^{-j\\omega}} = \\dfrac{1}{c} \\dfrac{1}{-j\\tan(\\omega/2)} = -j\\dfrac{1}{c\\tan(\\omega/2)}$。\n\n最后，我们在评估频率 $f_{\\mathrm{low}}$ 和 $f_{\\mathrm{high}}$ 处计算指定的误差度量。\n-   **相对复数幅值误差**：$E_{\\mathrm{mag}}(f) = \\dfrac{\\left| H_{d}\\!\\left(e^{j\\omega}\\right) - H_{c}(j\\Omega) \\right|}{\\left| H_{c}(j\\Omega) \\right|} = \\Omega \\left| H_{d}\\!\\left(e^{j\\omega}\\right) - H_{c}(j\\Omega) \\right|$。\n-   **相位误差**：$E_{\\mathrm{ph}}(f) = \\operatorname{PV}\\left(\\angle H_{d}\\!\\left(e^{j\\omega}\\right) - \\angle H_{c}(j\\Omega)\\right)$。\n    解析形式的相位误差简单且具有说明性：\n    -   $\\angle H_d^{\\mathrm{F}} = -\\pi/2 - \\omega/2$，所以 $E_{\\mathrm{ph}}^{\\mathrm{F}} = -\\omega/2$。\n    -   $\\angle H_d^{\\mathrm{B}} = -\\pi/2 + \\omega/2$，所以 $E_{\\mathrm{ph}}^{\\mathrm{B}} = +\\omega/2$。\n    -   $\\angle H_d^{\\mathrm{T}} = -\\pi/2$，所以 $E_{\\mathrm{ph}}^{\\mathrm{T}} = 0$。BLT完美地保留了理想积分器的相位。\n\n以下程序为了稳健性直接使用复数算术实现这些计算，并计算每个测试用例的误差度量。结果按要求进行汇总和格式化。", "answer": "```python\nimport numpy as np\n\ndef calculate_errors(f, fs, Ts, c):\n    \"\"\"\n    Calculate the frequency response errors for all three methods at a given frequency.\n    \"\"\"\n    Omega = 2.0 * np.pi * f\n    omega = 2.0 * np.pi * f / fs\n    \n    # Reference continuous-time response\n    Hc = -1j / Omega if Omega != 0 else np.inf\n    \n    # --- Method F: Forward Euler ---\n    # To avoid division by zero if f=fs/2, omega=pi, tan(pi/2)=inf\n    if np.isclose(omega, np.pi):\n        Hdf = -Ts/2.0 # real part only, im part is 0\n    else:\n        Hdf = -Ts/2.0 - 1j * Ts / (2.0 * np.tan(omega/2.0))\n    E_mag_f = np.abs(Hdf - Hc) / np.abs(Hc)\n    E_ph_f = (np.angle(Hdf) - np.angle(Hc) + np.pi) % (2.0 * np.pi) - np.pi\n    \n    # --- Method B: Backward Euler ---\n    if np.isclose(omega, np.pi):\n        Hdb = Ts/2.0\n    else:\n        Hdb = Ts/2.0 - 1j * Ts / (2.0 * np.tan(omega/2.0))\n    E_mag_b = np.abs(Hdb - Hc) / np.abs(Hc)\n    E_ph_b = (np.angle(Hdb) - np.angle(Hc) + np.pi) % (2.0 * np.pi) - np.pi\n    \n    # --- Method T: BLT with Pre-warping ---\n    # Handle omega=0 case (f=0), which would give tan(0). The limit exists.\n    if np.isclose(omega, 0.0):\n        # lim_{f->0} Omega / tan(omega/2) = lim_{f->0} 2*pi*f / (pi*f/fs) = 2*fs\n        E_mag_t = np.abs(1.0 - (2.0 * fs) / c)\n        E_ph_t = 0.0\n    # Handle omega=pi case (f=fs/2)\n    elif np.isclose(omega, np.pi):\n        Hdt = 0.0 # BLT maps s=inf to z=-1, so Hc(inf)=0 -> Hdt=0\n        E_mag_t = np.abs(Hdt - Hc) / np.abs(Hc)\n        E_ph_t = (np.angle(Hdt) - np.angle(Hc) + np.pi) % (2.0 * np.pi) - np.pi\n    else:\n        Hdt = -1j / (c * np.tan(omega/2.0))\n        E_mag_t = np.abs(Hdt - Hc) / np.abs(Hc)\n        E_ph_t = (np.angle(Hdt) - np.angle(Hc) + np.pi) % (2.0 * np.pi) - np.pi\n\n    return (E_mag_f, E_ph_f), (E_mag_b, E_ph_b), (E_mag_t, E_ph_t)\n\ndef solve_case(fs, ft, flow, fhigh):\n    \"\"\"\n    Computes all error metrics for a single test case.\n    The order of concatenation is: F_low, F_high, B_low, B_high, T_low, T_high.\n    \"\"\"\n    Ts = 1.0 / fs\n    \n    # Calculate the pre-warping constant c for the BLT\n    omega_t = 2.0 * np.pi * ft / fs\n    # Fallback to standard BLT constant if pre-warping frequency is a multiple of fs\n    if np.isclose(np.tan(omega_t / 2.0), 0.0):\n        c = 2.0 / Ts\n    else:    \n        c = (2.0 * np.pi * ft) / np.tan(omega_t / 2.0)\n        \n    # Calculate errors at low and high frequencies\n    (E_mag_f_low, E_ph_f_low), (E_mag_b_low, E_ph_b_low), (E_mag_t_low, E_ph_t_low) = calculate_errors(flow, fs, Ts, c)\n    (E_mag_f_high, E_ph_f_high), (E_mag_b_high, E_ph_b_high), (E_mag_t_high, E_ph_t_high) = calculate_errors(fhigh, fs, Ts, c)\n    \n    # Assemble results in the specified order\n    results = [\n        E_mag_f_low, E_ph_f_low,\n        E_mag_f_high, E_ph_f_high,\n        E_mag_b_low, E_ph_b_low,\n        E_mag_b_high, E_ph_b_high,\n        E_mag_t_low, E_ph_t_low,\n        E_mag_t_high, E_ph_t_high,\n    ]\n    \n    return results\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final result.\n    \"\"\"\n    test_cases = [\n        (1000, 50, 1, 400),\n        (48000, 3000, 10, 18000),\n        (8000, 1000, 0.5, 3000),\n    ]\n\n    full_results = []\n    for case in test_cases:\n        fs, ft, flow, fhigh = case\n        case_results = solve_case(fs, ft, flow, fhigh)\n        full_results.extend(case_results)\n\n    # Format the final output as a single comma-separated list of floats\n    print(f\"[{','.join(f'{x:.10f}' for x in full_results)}]\")\n\nsolve()\n```", "id": "2854923"}]}