{"hands_on_practices": [{"introduction": "许多 FIR 滤波器的关键特性是其线性相位，这一特性直接关系到其脉冲响应 $h[n]$ 的对称性。线性相位能够确保信号在滤波后不产生相位失真，这对于音频和图像处理等领域至关重要。本练习将指导您从给定的对称脉冲响应出发，显式推导其频率响应 $H(\\omega)$ 的幅度和相位，并计算恒定的群延迟，从而深入理解这些核心概念之间的联系。[@problem_id:2881290]", "problem": "考虑一个长度为 $N=7$ 的实值有限冲激响应 (FIR) 滤波器，其对于所有整数 $n$ 都具有偶对称性 $h[n]=h[6-n]$，且具有以下指定的系数：\n- $h[0]=\\frac{1}{16}$，$h[1]=-\\frac{1}{8}$，$h[2]=\\frac{3}{16}$，$h[3]=\\frac{1}{4}$，根据对称性，$h[4]=\\frac{3}{16}$，$h[5]=-\\frac{1}{8}$，$h[6]=\\frac{1}{16}$。\n\n仅从冲激响应的离散时间傅里叶变换 (DTFT) 的定义和给定的对称性出发，推导频率响应的线性相位分解形式 $H(\\omega)=\\exp(-j \\omega M)\\,A(\\omega)$ 的显式表达式，并将实振幅函数 $A(\\omega)$ 识别为余弦项之和。然后，利用相位定义的群延迟，确定该滤波器的恒定群延迟。\n\n所有角量均使用弧度，群延迟以采样点为单位表示。将您的最终答案表示为一个单行矩阵中的两个条目，其中第一个条目是 $A(\\omega)$ 的显式表达式，第二个条目是群延迟。无需四舍五入。", "solution": "对问题陈述进行验证。\n\n提取已知条件如下：\n1.  该滤波器是一个实值有限冲激响应 (FIR) 滤波器。\n2.  滤波器的长度为 $N=7$。\n3.  冲激响应呈现偶对称性：对于所有整数 $n$，有 $h[n]=h[6-n]$。\n4.  系数指定为：$h[0]=\\frac{1}{16}$，$h[1]=-\\frac{1}{8}$，$h[2]=\\frac{3}{16}$，$h[3]=\\frac{1}{4}$。其余系数由对称性确定：$h[4]=h[6-4]=h[2]=\\frac{3}{16}$，$h[5]=h[6-5]=h[1]=-\\frac{1}{8}$，以及 $h[6]=h[6-6]=h[0]=\\frac{1}{16}$。\n\n该问题在科学上是合理的、适定且客观的。它涉及数字信号处理中的标准概念，特别是 I 型线性相位 FIR 滤波器的分析。所有提供的数据都是一致的，并且足以得到唯一解。因此，该问题被认为是有效的。下面进行求解。\n\n冲激响应为 $h[n]$ 的离散时间滤波器的频率响应 $H(\\omega)$ 由其离散时间傅里叶变换 (DTFT) 给出。对于长度为 $N$ 的滤波器，其定义为：\n$$H(\\omega) = \\sum_{n=0}^{N-1} h[n] \\exp(-j \\omega n)$$\n给定滤波器长度为 $N=7$，求和范围是从 $n=0$ 到 $n=6$：\n$$H(\\omega) = \\sum_{n=0}^{6} h[n] \\exp(-j \\omega n)$$\n展开此求和式可得：\n$$H(\\omega) = h[0] + h[1]\\exp(-j\\omega) + h[2]\\exp(-j2\\omega) + h[3]\\exp(-j3\\omega) + h[4]\\exp(-j4\\omega) + h[5]\\exp(-j5\\omega) + h[6]\\exp(-j6\\omega)$$\n问题陈述指出，冲激响应具有偶对称性，$h[n]=h[6-n]$。我们将此性质应用于系数：\n$h[6] = h[0]$，$h[5] = h[1]$，以及 $h[4] = h[2]$。\n将这些代入 $H(\\omega)$ 的表达式中：\n$$H(\\omega) = h[0] + h[1]\\exp(-j\\omega) + h[2]\\exp(-j2\\omega) + h[3]\\exp(-j3\\omega) + h[2]\\exp(-j4\\omega) + h[1]\\exp(-j5\\omega) + h[0]\\exp(-j6\\omega)$$\n为了揭示线性相位结构，我们必须围绕冲激响应的中心对称地对各项进行分组。对于长度为 $N=7$ 的滤波器，其对称中心位于索引 $n=\\frac{N-1}{2} = \\frac{7-1}{2}=3$ 处。\n$$H(\\omega) = h[3]\\exp(-j3\\omega) + \\left( h[0] + h[0]\\exp(-j6\\omega) \\right) + \\left( h[1]\\exp(-j\\omega) + h[1]\\exp(-j5\\omega) \\right) + \\left( h[2]\\exp(-j2\\omega) + h[2]\\exp(-j4\\omega) \\right)$$\n我们提出对应于对称中心的相位项 $\\exp(-j3\\omega)$：\n$$H(\\omega) = \\exp(-j3\\omega) \\left[ h[3] + h[0]\\left(\\exp(j3\\omega) + \\exp(-j3\\omega)\\right) + h[1]\\left(\\exp(j2\\omega) + \\exp(-j2\\omega)\\right) + h[2]\\left(\\exp(j\\omega) + \\exp(-j\\omega)\\right) \\right]$$\n使用欧拉恒等式 $2\\cos(\\theta) = \\exp(j\\theta) + \\exp(-j\\theta)$，我们可以将括号中的项表示为余弦：\n$$H(\\omega) = \\exp(-j3\\omega) \\left[ h[3] + 2h[0]\\cos(3\\omega) + 2h[1]\\cos(2\\omega) + 2h[2]\\cos(\\omega) \\right]$$\n该表达式符合所要求的线性相位形式 $H(\\omega)=\\exp(-j \\omega M)A(\\omega)$，其中 $M=3$，$A(\\omega)$ 是实值振幅函数：\n$$A(\\omega) = h[3] + 2h[2]\\cos(\\omega) + 2h[1]\\cos(2\\omega) + 2h[0]\\cos(3\\omega)$$\n现在，我们代入给定的系数值：$h[0]=\\frac{1}{16}$，$h[1]=-\\frac{1}{8}$，$h[2]=\\frac{3}{16}$，$h[3]=\\frac{1}{4}$。\n$$A(\\omega) = \\frac{1}{4} + 2\\left(\\frac{3}{16}\\right)\\cos(\\omega) + 2\\left(-\\frac{1}{8}\\right)\\cos(2\\omega) + 2\\left(\\frac{1}{16}\\right)\\cos(3\\omega)$$\n$$A(\\omega) = \\frac{1}{4} + \\frac{3}{8}\\cos(\\omega) - \\frac{1}{4}\\cos(2\\omega) + \\frac{1}{8}\\cos(3\\omega)$$\n这就是实振幅函数 $A(\\omega)$ 的显式表达式。\n\n接下来，我们确定群延迟 $\\tau_g(\\omega)$。群延迟定义为频率响应的相位对角频率 $\\omega$ 的导数的相反数：\n$$\\tau_g(\\omega) = -\\frac{d}{d\\omega} \\arg\\{H(\\omega)\\}$$\n频率响应为 $H(\\omega) = A(\\omega)\\exp(-j3\\omega)$。函数 $A(\\omega)$ 是实数，所以其相位 $\\arg\\{A(\\omega)\\}$ 要么是 $0$（如果 $A(\\omega) > 0$），要么是 $\\pi$（如果 $A(\\omega) < 0$）。\n$H(\\omega)$ 的总相位，记为 $\\phi(\\omega)$，是：\n$$\\phi(\\omega) = \\arg\\{H(\\omega)\\} = \\arg\\{A(\\omega)\\exp(-j3\\omega)\\} = \\arg\\{A(\\omega)\\} + \\arg\\{\\exp(-j3\\omega)\\} = \\arg\\{A(\\omega)\\} - 3\\omega$$\n对于线性相位滤波器，群延迟通常由相位的线性分量定义。在 $A(\\omega)$ 不改变符号的 $\\omega$ 区域内，$\\arg\\{A(\\omega)\\}$ 是一个常数（$0$ 或 $\\pi$），其导数为零。因此，相位的导数是：\n$$\\frac{d\\phi(\\omega)}{d\\omega} = \\frac{d}{d\\omega}(-3\\omega) = -3$$\n因此，群延迟是恒定的：\n$$\\tau_g(\\omega) = -(-3) = 3$$\n群延迟是 $3$ 个采样点。这与 I 型线性相位 FIR 滤波器的一般理论相符，其群延迟是恒定的，等于 $(N-1)/2$。\n\n最终答案由 $A(\\omega)$ 的表达式和群延迟的恒定值组成。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{4} + \\frac{3}{8}\\cos(\\omega) - \\frac{1}{4}\\cos(2\\omega) + \\frac{1}{8}\\cos(3\\omega) & 3\n\\end{pmatrix}\n}\n$$", "id": "2881290"}, {"introduction": "除了时域和频域，Z 域为滤波器设计提供了强大的视角。本练习将演示如何从最基本的构件——零点——来构建一个 FIR 滤波器。通过在 Z 平面上策略性地放置零点，我们可以精确地塑造滤波器的频率响应 $H(z)$，这是滤波器综合中的一项核心技能。[@problem_id:2872240]", "problem": "考虑一个具有实系数系统函数的因果有限冲激响应（FIR）线性时不变离散时间系统。给定复零点集合（以极坐标形式表示）$$\\{z_{1},z_{2},z_{3}\\}=\\left\\{r\\,\\exp(j\\pi/3),\\;r\\,\\exp(-j\\pi/3),\\;-\\,\\frac{1}{4}\\right\\},$$ 其中 $$r=\\frac{4}{5}$$ 且所有角度均以弧度为单位。仅使用系统函数零点的定义和双边 $z$ 变换的定义，构造一个实系数的因果FIR系统函数 $$H(z)$$，使其恰好具有这些零点。选择总的实数增益，使得零频率处的离散时间频率响应为1，即根据标准代换 $$z=\\exp(j\\omega)$$，有 $$H(1)=1$$。根据你构造的 $$H(z)$$，通过 $z$ 反变换确定相应的冲激响应 $$h[n]$$。\n\n从第一性原理和基本定义出发进行推导；不要引用任何预先给出的因式分解模板或现成公式。根据零点集证明系数为什么是实数，并阐明在你的构造中如何保证冲激响应的因果性和有限性。\n\n最后，以精确的有理数形式（不进行四舍五入）报告 $$h[2]$$ 的值作为你的最终答案。", "solution": "对所述问题进行验证。\n\n逐字提取的已知条件如下：\n1.  一个因果有限冲激响应（FIR）线性时不变（LTI）离散时间系统。\n2.  系统函数具有实系数。\n3.  复零点集合为 $\\{z_{1},z_{2},z_{3}\\}=\\left\\{r\\,\\exp(j\\pi/3),\\;r\\,\\exp(-j\\pi/3),\\;-\\,\\frac{1}{4}\\right\\}$。\n4.  参数 $r$ 给定为 $r=\\frac{4}{5}$。\n5.  所有角度均以弧度为单位。\n6.  推导方法必须仅使用零点的定义和双边 $z$ 变换。\n7.  施加了一个归一化条件：零频率处的离散时间频率响应为1，通过代换 $z=\\exp(j\\omega)$，这等价于 $H(1)=1$。\n8.  任务是求出冲激响应 $h[n]$ 并报告 $h[2]$ 的值。\n\n验证结论：\n该问题是有效的。它在科学上基于数字信号处理的既定理论。问题提法得当，提供了足够的信息（零点和增益归一化条件）来唯一确定一个FIR滤波器的系统函数。约束条件是自洽且客观的。该问题避免了歧义，并遵循了学科内的标准定义。\n\n开始求解。\n\n一个冲激响应 $h[n]$ 的双边 $z$ 变换定义为 $H(z) = \\sum_{n=-\\infty}^{\\infty} h[n] z^{-n}$。对于一个因果的有限冲激响应（FIR）系统，其冲激响应仅在 $n \\in [0, N-1]$（其中 $N$ 为某个有限整数）的区间内非零。因此，定义简化为：\n$$H(z) = \\sum_{n=0}^{N-1} h[n] z^{-n} = h[0] + h[1]z^{-1} + h[2]z^{-2} + \\dots + h[N-1]z^{-(N-1)}$$\n这个形式是关于变量 $z^{-1}$ 的多项式。求和从 $n=0$ 开始保证了因果性，有限的上限 $N-1$ 保证了有限持续时间。\n\n系统函数 $H(z)$ 的一个零点是一个复数 $z_k$，满足 $H(z_k)=0$。对于一个多项式，这意味着 $(z-z_k)$ 是该多项式的一个因子。当表示为关于 $z^{-1}$ 的多项式时，位于 $z=z_k$ 的零点意味着存在一个因子 $(1 - z_k z^{-1})$，因为代入 $z=z_k$ 会得到 $1 - z_k (z_k)^{-1} = 1-1=0$。\n\n该问题提供了三个零点。因此，系统函数必须具有以下形式：\n$$H(z) = K \\left(1 - z_1 z^{-1}\\right)\\left(1 - z_2 z^{-1}\\right)\\left(1 - z_3 z^{-1}\\right)$$\n其中 $K$ 是一个实数增益常数，三个零点因子的存在意味着 $N-1=3$，所以 $N=4$。冲激响应的长度将为4。这种关于 $z^{-1}$ 的多项式结构内在地满足了FIR和因果性的要求。\n\n给定的零点是：\n$$z_1 = r\\,\\exp(j\\pi/3) = \\frac{4}{5}\\left(\\cos(\\pi/3) + j\\sin(\\pi/3)\\right) = \\frac{4}{5}\\left(\\frac{1}{2} + j\\frac{\\sqrt{3}}{2}\\right) = \\frac{2}{5} + j\\frac{2\\sqrt{3}}{5}$$\n$$z_2 = r\\,\\exp(-j\\pi/3) = \\frac{4}{5}\\left(\\cos(-\\pi/3) + j\\sin(-\\pi/3)\\right) = \\frac{4}{5}\\left(\\frac{1}{2} - j\\frac{\\sqrt{3}}{2}\\right) = \\frac{2}{5} - j\\frac{2\\sqrt{3}}{5}$$\n$$z_3 = -\\frac{1}{4}$$\n系统函数必须具有实系数。对于一个多项式，这当且仅当其复数根以共轭对的形式出现时才成立。我们验证可得 $z_1^* = \\left(\\frac{2}{5} + j\\frac{2\\sqrt{3}}{5}\\right)^* = \\frac{2}{5} - j\\frac{2\\sqrt{3}}{5} = z_2$。第三个零点 $z_3$ 是实数。该零点集合在复共轭运算下是封闭的，所以得到的 $H(z)$ 多项式将具有实系数。\n\n我们首先将与复共轭零点对相对应的因子合并，来构造多项式：\n$$\\left(1 - z_1 z^{-1}\\right)\\left(1 - z_2 z^{-1}\\right) = \\left(1 - z_1 z^{-1}\\right)\\left(1 - z_1^* z^{-1}\\right) = 1 - (z_1 + z_1^*)z^{-1} + (z_1 z_1^*)z^{-2}$$\n这个二次多项式的系数是实数，符合要求。我们计算它们：\n$$z_1 + z_1^* = 2\\,\\text{Re}\\{z_1\\} = 2\\left(\\frac{2}{5}\\right) = \\frac{4}{5}$$\n$$z_1 z_1^* = |z_1|^2 = r^2 = \\left(\\frac{4}{5}\\right)^2 = \\frac{16}{25}$$\n因此，这个二次因子是 $\\left(1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2}\\right)$。\n\n现在，我们包含实数零点 $z_3 = -\\frac{1}{4}$ 对应的因子：\n$$H(z) = K \\left(1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2}\\right)\\left(1 - z_3 z^{-1}\\right) = K \\left(1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2}\\right)\\left(1 + \\frac{1}{4}z^{-1}\\right)$$\n展开这个乘积：\n$$H(z) = K \\left[ \\left(1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2}\\right) + \\frac{1}{4}z^{-1}\\left(1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2}\\right) \\right]$$\n$$H(z) = K \\left[ 1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2} + \\frac{1}{4}z^{-1} - \\frac{4}{20}z^{-2} + \\frac{16}{100}z^{-3} \\right]$$\n$$H(z) = K \\left[ 1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2} + \\frac{1}{4}z^{-1} - \\frac{1}{5}z^{-2} + \\frac{4}{25}z^{-3} \\right]$$\n按 $z^{-1}$ 的幂次对各项进行分组：\n$$H(z) = K \\left[ 1 + \\left(-\\frac{4}{5} + \\frac{1}{4}\\right)z^{-1} + \\left(\\frac{16}{25} - \\frac{1}{5}\\right)z^{-2} + \\frac{4}{25}z^{-3} \\right]$$\n系数为：\n$$-\\frac{4}{5} + \\frac{1}{4} = \\frac{-16+5}{20} = -\\frac{11}{20}$$\n$$\\frac{16}{25} - \\frac{1}{5} = \\frac{16-5}{25} = \\frac{11}{25}$$\n所以，系统函数是：\n$$H(z) = K \\left( 1 - \\frac{11}{20}z^{-1} + \\frac{11}{25}z^{-2} + \\frac{4}{25}z^{-3} \\right)$$\n增益 $K$ 由条件 $H(1)=1$ 决定。离散时间频率响应是 $H(e^{j\\omega})$，零频率对应于 $\\omega=0$，这意味着 $z=e^{j0}=1$。\n$$H(1) = K \\left( 1 - \\frac{11}{20}(1)^{-1} + \\frac{11}{25}(1)^{-2} + \\frac{4}{25}(1)^{-3} \\right) = K \\left( 1 - \\frac{11}{20} + \\frac{11}{25} + \\frac{4}{25} \\right)$$\n$$H(1) = K \\left( 1 - \\frac{11}{20} + \\frac{15}{25} \\right) = K \\left( 1 - \\frac{11}{20} + \\frac{3}{5} \\right)$$\n使用公分母 $20$：\n$$H(1) = K \\left( \\frac{20}{20} - \\frac{11}{20} + \\frac{12}{20} \\right) = K \\left( \\frac{20 - 11 + 12}{20} \\right) = K \\left( \\frac{21}{20} \\right)$$\n已知 $H(1)=1$，我们有 $K \\left( \\frac{21}{20} \\right) = 1$，这意味着 $K = \\frac{20}{21}$。\n\n将 $K$ 代回到 $H(z)$ 的表达式中：\n$$H(z) = \\frac{20}{21} \\left( 1 - \\frac{11}{20}z^{-1} + \\frac{11}{25}z^{-2} + \\frac{4}{25}z^{-3} \\right)$$\n$$H(z) = \\frac{20}{21} - \\frac{20}{21}\\frac{11}{20}z^{-1} + \\frac{20}{21}\\frac{11}{25}z^{-2} + \\frac{20}{21}\\frac{4}{25}z^{-3}$$\n$$H(z) = \\frac{20}{21} - \\frac{11}{21}z^{-1} + \\frac{4 \\cdot 5}{21}\\frac{11}{5 \\cdot 5}z^{-2} + \\frac{4 \\cdot 5}{21}\\frac{4}{5 \\cdot 5}z^{-3}$$\n$$H(z) = \\frac{20}{21} - \\frac{11}{21}z^{-1} + \\frac{44}{105}z^{-2} + \\frac{16}{105}z^{-3}$$\n根据定义 $H(z) = \\sum_{n=0}^{3} h[n] z^{-n}$，通过辨识 $H(z)$ 多项式形式中 $z^{-n}$ 幂次的系数，可以得到冲激响应 $h[n]$。\n通过直接观察可得：\n$$h[0] = \\frac{20}{21}$$\n$$h[1] = -\\frac{11}{21}$$\n$$h[2] = \\frac{44}{105}$$\n$$h[3] = \\frac{16}{105}$$\n对于所有其他 $n$，$h[n]=0$。\n\n问题要求 $h[2]$ 的值。这个值是 $\\frac{44}{105}$。\n这符合要求的精确有理数形式，没有进行四舍五入。", "answer": "$$\\boxed{\\frac{44}{105}}$$", "id": "2872240"}, {"introduction": "实际滤波器设计面临的核心挑战是如何以最优方式逼近一个理想的频率响应。本练习通过引导您完成一次解析性的迭代，揭示了著名的 Remez 交换算法的内在机制。这种动手实践将向您展示该算法如何迭代调整滤波器系数，以实现最佳的“等波纹”逼近，这是许多 FIR 应用的黄金标准。[@problem_id:2872185]", "problem": "考虑设计一个长度为 $N=5$（阶数为 $4$）、具有对称冲激响应 $h[n]=h[4-n]$ 的实系数、线性相位、I型有限冲激响应（FIR）滤波器。根据对称性，其频率响应可以写成余弦形式：\n$$\nH(\\omega)=h_{0}+2h_{1}\\cos(\\omega)+2h_{2}\\cos(2\\omega),\n$$\n其中 $h_{0}=h[2]$，$h_{1}=h[1]=h[3]$，且 $h_{2}=h[0]=h[4]$。期望的响应是分段常数：\n$$\nD(\\omega)=\\begin{cases}\n1, & 0\\le \\omega \\le \\frac{\\pi}{3},\\\\\n0, & \\frac{2\\pi}{3}\\le \\omega \\le \\pi,\n\\end{cases}\n$$\n两个频带上的加权均为均匀加权 $W(\\omega)=1$。频率以弧度表示。\n\n从初始极值点集 $\\{\\omega_{0},\\omega_{1},\\omega_{2},\\omega_{3}\\}=\\{0,\\frac{\\pi}{3},\\frac{2\\pi}{3},\\pi\\}$ 开始，使用交替误差符号 $(-1)^{k}$（其中 $k=0,1,2,3$），执行单次Remez交换法迭代。即，强制执行交替约束：\n$$\nE(\\omega_{k}) \\triangleq W(\\omega_{k})\\big(H(\\omega_{k})-D(\\omega_{k})\\big)=(-1)^{k}\\,\\delta,\\quad k\\in\\{0,1,2,3\\},\n$$\n并解析求解 $h_{0}$、$h_{1}$、$h_{2}$ 以及波纹幅度 $\\delta$。然后，使用得到的 $H(\\omega)$，通过在每个频带内定位最大绝对加权误差点来确定更新后的极值频率，并指出它们是停留在频带边缘还是移动到频带内部。最后，将这次单次迭代中得到的波纹幅度 $\\delta$ 的值作为一个精确的数值（无单位）报告。", "solution": "问题陈述已被解析和验证。该问题具有科学依据，提法得当，客观且自洽。它描述了使用Remez交换算法设计最优等波纹有限冲激响应（FIR）滤波器的一个标准初始步骤。该问题是有效的。\n\n任务是执行一次Remez交换算法的迭代。给定滤波器长度 $N=5$，对应阶数 $M=4$。该滤波器是一个I型线性相位滤波器，因此其冲激响应 $h[n]$ 是对称的，$h[n]=h[4-n]$，且其长度 $N$ 为奇数。频率响应 $H(\\omega)$ 是 $\\omega$ 的实函数，可以表示为：\n$$\nH(\\omega) = h_0 + 2h_1\\cos(\\omega) + 2h_2\\cos(2\\omega)\n$$\n其中系数为 $h_0=h[2]$，$h_1=h[1]$ 和 $h_2=h[0]$。有 $3$ 个独立的滤波器系数需要确定。\n\n此设计问题遵循交替定理。为了唯一确定 $3$ 个滤波器系数和波纹幅度 $\\delta$，我们需要至少 $3+1=4$ 个极值频率。问题提供了一个包含 $4$ 个极值频率的初始集合：$\\omega_0=0$, $\\omega_1=\\frac{\\pi}{3}$, $\\omega_2=\\frac{2\\pi}{3}$, 和 $\\omega_3=\\pi$。\n\n核心约束由等波纹条件给出：\n$$\nE(\\omega_k) \\triangleq W(\\omega_k)\\big(H(\\omega_k)-D(\\omega_k)\\big) = (-1)^k \\delta, \\quad k \\in \\{0, 1, 2, 3\\}\n$$\n由于处处有 $W(\\omega)=1$，这可以简化为 $H(\\omega_k) - D(\\omega_k) = (-1)^k \\delta$。我们对这四个频率分别展开此式。\n\n对于 $k=0$，$\\omega_0=0$：\n频率 $\\omega_0=0$ 在通带内，因此 $D(0)=1$。\n$H(0) - D(0) = \\delta \\implies (h_0 + 2h_1\\cos(0) + 2h_2\\cos(0)) - 1 = \\delta$\n$h_0 + 2h_1 + 2h_2 - 1 = \\delta \\implies h_0 + 2h_1 + 2h_2 - \\delta = 1 \\quad (1)$\n\n对于 $k=1$，$\\omega_1=\\frac{\\pi}{3}$：\n频率 $\\omega_1=\\frac{\\pi}{3}$ 在通带边缘，因此 $D(\\frac{\\pi}{3})=1$。\n$H(\\frac{\\pi}{3}) - D(\\frac{\\pi}{3}) = -\\delta \\implies (h_0 + 2h_1\\cos(\\frac{\\pi}{3}) + 2h_2\\cos(\\frac{2\\pi}{3})) - 1 = -\\delta$\n使用 $\\cos(\\frac{\\pi}{3})=\\frac{1}{2}$ 和 $\\cos(\\frac{2\\pi}{3})=-\\frac{1}{2}$，我们得到：\n$h_0 + 2h_1(\\frac{1}{2}) + 2h_2(-\\frac{1}{2}) - 1 = -\\delta \\implies h_0 + h_1 - h_2 + \\delta = 1 \\quad (2)$\n\n对于 $k=2$，$\\omega_2=\\frac{2\\pi}{3}$：\n频率 $\\omega_2=\\frac{2\\pi}{3}$ 在阻带边缘，因此 $D(\\frac{2\\pi}{3})=0$。\n$H(\\frac{2\\pi}{3}) - D(\\frac{2\\pi}{3}) = \\delta \\implies (h_0 + 2h_1\\cos(\\frac{2\\pi}{3}) + 2h_2\\cos(\\frac{4\\pi}{3})) - 0 = \\delta$\n使用 $\\cos(\\frac{2\\pi}{3})=-\\frac{1}{2}$ 和 $\\cos(\\frac{4\\pi}{3})=-\\frac{1}{2}$，我们得到：\n$h_0 + 2h_1(-\\frac{1}{2}) + 2h_2(-\\frac{1}{2}) = \\delta \\implies h_0 - h_1 - h_2 - \\delta = 0 \\quad (3)$\n\n对于 $k=3$，$\\omega_3=\\pi$：\n频率 $\\omega_3=\\pi$ 在阻带内，因此 $D(\\pi)=0$。\n$H(\\pi) - D(\\pi) = -\\delta \\implies (h_0 + 2h_1\\cos(\\pi) + 2h_2\\cos(2\\pi)) - 0 = -\\delta$\n使用 $\\cos(\\pi)=-1$ 和 $\\cos(2\\pi)=1$，我们得到：\n$h_0 - 2h_1 + 2h_2 = -\\delta \\implies h_0 - 2h_1 + 2h_2 + \\delta = 0 \\quad (4)$\n\n现在我们得到了一个关于四个未知数 $h_0, h_1, h_2, \\delta$ 的四元线性方程组：\n1. $h_0 + 2h_1 + 2h_2 - \\delta = 1$\n2. $h_0 + h_1 - h_2 + \\delta = 1$\n3. $h_0 - h_1 - h_2 - \\delta = 0$\n4. $h_0 - 2h_1 + 2h_2 + \\delta = 0$\n\n为求解此方程组，我们组合这些方程。\n将(2)式减去(3)式：$(h_1 - (-h_1)) + (-h_2 - (-h_2)) + (\\delta - (-\\delta)) = 1-0 \\implies 2h_1 + 2\\delta = 1$。\n将(1)式减去(4)式：$(2h_1 - (-2h_1)) + (2h_2 - 2h_2) + (-\\delta - \\delta) = 1-0 \\implies 4h_1 - 2\\delta = 1$。\n\n现在我们得到了一个关于 $h_1$ 和 $\\delta$ 的二元方程组：\nA. $2h_1 + 2\\delta = 1$\nB. $4h_1 - 2\\delta = 1$\n将(A)和(B)相加：$6h_1 = 2 \\implies h_1 = \\frac{1}{3}$。\n将 $h_1 = \\frac{1}{3}$ 代入(A)式：$2(\\frac{1}{3}) + 2\\delta = 1 \\implies \\frac{2}{3} + 2\\delta = 1 \\implies 2\\delta = \\frac{1}{3} \\implies \\delta = \\frac{1}{6}$。\n\n利用 $h_1 = \\frac{1}{3}$ 和 $\\delta = \\frac{1}{6}$，我们求解 $h_0$ 和 $h_2$。\n由(3)式：$h_0 = h_1 + h_2 + \\delta = \\frac{1}{3} + h_2 + \\frac{1}{6} = h_2 + \\frac{1}{2}$。\n由(4)式：$h_0 = 2h_1 - 2h_2 - \\delta = 2(\\frac{1}{3}) - 2h_2 - \\frac{1}{6} = \\frac{2}{3} - 2h_2 - \\frac{1}{6} = \\frac{1}{2} - 2h_2$。\n令两个 $h_0$ 的表达式相等：\n$h_2 + \\frac{1}{2} = \\frac{1}{2} - 2h_2 \\implies 3h_2 = 0 \\implies h_2 = 0$。\n最后，将 $h_2=0$ 代入 $h_0$ 的表达式：$h_0 = 0 + \\frac{1}{2} = \\frac{1}{2}$。\n\n系数和波纹幅度的解为：\n$h_0 = \\frac{1}{2}$，$h_1 = \\frac{1}{3}$，$h_2 = 0$ 且 $\\delta = \\frac{1}{6}$。\n\n得到的频率响应是：\n$$\nH(\\omega) = \\frac{1}{2} + 2\\left(\\frac{1}{3}\\right)\\cos(\\omega) + 2(0)\\cos(2\\omega) = \\frac{1}{2} + \\frac{2}{3}\\cos(\\omega)\n$$\nRemez算法的下一步是找到加权误差函数 $E(\\omega) = W(\\omega)(H(\\omega)-D(\\omega))$ 的真实极值点。由于 $W(\\omega)=1$，我们分析 $E(\\omega) = H(\\omega)-D(\\omega)$。\n\n在通带 $\\omega \\in [0, \\frac{\\pi}{3}]$ 内，$D(\\omega)=1$：\n$E(\\omega) = (\\frac{1}{2} + \\frac{2}{3}\\cos(\\omega)) - 1 = \\frac{2}{3}\\cos(\\omega) - \\frac{1}{2}$。\n为寻找局部极值，我们计算导数：$\\frac{dE}{d\\omega} = -\\frac{2}{3}\\sin(\\omega)$。\n在区间 $(0, \\frac{\\pi}{3})$ 内，$\\sin(\\omega) > 0$，所以 $\\frac{dE}{d\\omega} \\ne 0$。因此，极值点必须出现在频带边缘 $\\omega=0$ 和 $\\omega=\\frac{\\pi}{3}$处。\n$E(0) = \\frac{2}{3} - \\frac{1}{2} = \\frac{1}{6} = \\delta$。\n$E(\\frac{\\pi}{3}) = \\frac{2}{3}(\\frac{1}{2}) - \\frac{1}{2} = -\\frac{1}{6} = -\\delta$。\n\n在阻带 $\\omega \\in [\\frac{2\\pi}{3}, \\pi]$ 内，$D(\\omega)=0$：\n$E(\\omega) = \\frac{1}{2} + \\frac{2}{3}\\cos(\\omega)$。\n导数为 $\\frac{dE}{d\\omega} = -\\frac{2}{3}\\sin(\\omega)$。\n在区间 $(\\frac{2\\pi}{3}, \\pi)$ 内，$\\sin(\\omega) > 0$，所以 $\\frac{dE}{d\\omega} \\ne 0$。因此，极值点必须出现在频带边缘 $\\omega=\\frac{2\\pi}{3}$ 和 $\\omega=\\pi$处。\n$E(\\frac{2\\pi}{3}) = \\frac{1}{2} + \\frac{2}{3}(-\\frac{1}{2}) = \\frac{1}{6} = \\delta$。\n$E(\\pi) = \\frac{1}{2} + \\frac{2}{3}(-1) = -\\frac{1}{6} = -\\delta$。\n\n最大绝对误差的位置是 $\\{0, \\frac{\\pi}{3}, \\frac{2\\pi}{3}, \\pi\\}$，这与初始极值点集相同。算法在单次迭代中即收敛。极值频率保持在频带边缘。\n\n从本次迭代中得到的波纹幅度 $\\delta$ 的值为 $\\frac{1}{6}$。", "answer": "$$\n\\boxed{\\frac{1}{6}}\n$$", "id": "2872185"}]}