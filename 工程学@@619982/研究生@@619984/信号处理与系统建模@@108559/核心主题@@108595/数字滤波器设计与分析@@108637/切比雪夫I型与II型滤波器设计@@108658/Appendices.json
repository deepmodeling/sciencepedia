{"hands_on_practices": [{"introduction": "任何滤波器设计的第一步都是将用户友好的性能指标（如分贝）转化为驱动滤波器响应的数学参数。本练习侧重于切比雪夫I型滤波器的核心特性——其等波纹通带。通过从基本定义出发，您将推导出最大通带衰减 $A_p$ (dB) 与波纹因子 $\\epsilon$ 之间的直接关系，这是任何滤波器设计者都必须掌握的一项基本技能。 [@problem_id:2858204]", "problem": "在模拟低通滤波器设计框架中，考虑一个归一化的切比雪夫I型低通原型，其波纹系数 $\\epsilon>0$，通带定义在 $0 \\le \\Omega \\le 1$ 上。假设单位归一化，使得最大通带增益等于 $1$，即 $|H(j0)|=1$。通带内的幅度平方频率响应由第一类切比雪夫多项式 $T_N(\\cdot)$ 的等波纹特性决定，且分贝 (dB) 度量是为幅度比 $G$ 定义的，其表达式为 $20 \\log_{10}(G)$。最大通带衰减 $A_p$ (以分贝为单位) 定义为 $A_p = -20 \\log_{10}\\!\\left(\\min_{0 \\le \\Omega \\le 1} |H(j\\Omega)|\\right)$，其中最小值是在通带上取。仅从关于切比雪夫I型原型和分贝定义的基础定义和事实出发，推导出一个用 $A_p$ 表示 $\\epsilon$ 的闭式表达式。\n\n请将 $\\epsilon$ 的最终表达式以单一解析表达式的形式给出。不要使用任何数值近似。", "solution": "一个归一化的切比雪夫I型低通滤波器的幅度平方频率响应由以下表达式给出：\n$$ |H(j\\Omega)|^2 = \\frac{1}{1 + \\epsilon^2 T_N^2(\\Omega)} $$\n其中，$N$ 是滤波器阶数，$\\epsilon$ 是波纹系数，$T_N(\\Omega)$ 是 $N$ 阶的第一类切比雪夫多项式。通带定义在 $0 \\le \\Omega \\le 1$ 上。\n\n在此通带区间内，切比雪夫多项式 $T_N(\\Omega)$ 具有等波纹振荡的特性，其值的边界为 $|T_N(\\Omega)| \\le 1$。因此，多项式的平方 $T_N^2(\\Omega)$ 在 $0$ 和 $1$ 之间振荡。\n\n幅度响应 $|H(j\\Omega)|$ 将表现出相应的振荡。$|H(j\\Omega)|$ 的最大值出现在分母为最小值时。这发生在 $T_N^2(\\Omega) = 0$ 的情况下。在这些频率点，幅度平方为：\n$$ |H(j\\Omega)|_{\\max}^2 = \\frac{1}{1 + \\epsilon^2 \\cdot 0} = 1 $$\n这证实了通带内的最大增益确实为 $1$。\n\n在通带内，$|H(j\\Omega)|$ 的最小值出现在分母为最大值时。这对应于 $T_N^2(\\Omega) = 1$ 的点。在这些频率点，幅度平方为：\n$$ \\min_{0 \\le \\Omega \\le 1} |H(j\\Omega)|^2 = \\frac{1}{1 + \\epsilon^2 \\cdot 1^2} = \\frac{1}{1 + \\epsilon^2} $$\n取平方根得到通带内的最小幅度响应：\n$$ \\min_{0 \\le \\Omega \\le 1} |H(j\\Omega)| = \\frac{1}{\\sqrt{1 + \\epsilon^2}} $$\n问题将最大通带衰减 $A_p$ (以分贝为单位) 定义为：\n$$ A_p = -20 \\log_{10}\\!\\left(\\min_{0 \\le \\Omega \\le 1} |H(j\\Omega)|\\right) $$\n代入我们推导出的最小幅度表达式：\n$$ A_p = -20 \\log_{10}\\!\\left(\\frac{1}{\\sqrt{1 + \\epsilon^2}}\\right) $$\n我们需要解此方程以求得 $\\epsilon$。我们通过应用对数的基本性质来进行。使用恒等式 $\\log(1/x) = -\\log(x)$：\n$$ A_p = -20 \\left[ - \\log_{10}\\!\\left(\\sqrt{1 + \\epsilon^2}\\right) \\right] $$\n$$ A_p = 20 \\log_{10}\\!\\left((1 + \\epsilon^2)^{1/2}\\right) $$\n使用恒等式 $\\log(x^b) = b \\log(x)$：\n$$ A_p = 20 \\cdot \\frac{1}{2} \\log_{10}(1 + \\epsilon^2) $$\n$$ A_p = 10 \\log_{10}(1 + \\epsilon^2) $$\n为了分离出 $\\epsilon$，我们首先两边除以 $10$：\n$$ \\frac{A_p}{10} = \\log_{10}(1 + \\epsilon^2) $$\n接下来，我们应用以10为底的对数的逆运算，即以10为底的指数运算：\n$$ 10^{\\frac{A_p}{10}} = 10^{\\log_{10}(1 + \\epsilon^2)} $$\n$$ 10^{\\frac{A_p}{10}} = 1 + \\epsilon^2 $$\n最后，我们求解 $\\epsilon^2$，然后求解 $\\epsilon$。\n$$ \\epsilon^2 = 10^{\\frac{A_p}{10}} - 1 $$\n由于问题规定 $\\epsilon > 0$，我们取正平方根来获得 $\\epsilon$ 的最终表达式：\n$$ \\epsilon = \\sqrt{10^{\\frac{A_p}{10}} - 1} $$\n该表达式直接用最大通带衰减 $A_p$ (以分贝为单位) 给出了波纹系数 $\\epsilon$。", "answer": "$$\\boxed{\\sqrt{10^{\\frac{A_p}{10}} - 1}}$$", "id": "2858204"}, {"introduction": "掌握了如何将指标与参数相关联后，我们现在可以进行完整的设计综合。本练习将我们的注意力转向切比雪夫II型（或逆切比雪夫）滤波器，它以其平坦的通带和等波纹的阻带而著称。您将根据一整套实际的设计规范（通带损耗、阻带衰减和过渡带选择性），从第一性原理出发，推导满足这些要求的最低滤波器阶数 $n$，并确定其标志性的传输零点的位置。 [@problem_id:2858162]", "problem": "一个具有II型切比雪夫（反切比雪夫）特性的模拟低通原型滤波器需要被设计以满足以下指标：最大通带损耗 $A_p = 1\\,\\text{dB}$，最小阻带衰减 $A_s = 50\\,\\text{dB}$，以及选择性比 $\\Omega_s/\\Omega_p = 1.8$，其中 $\\Omega_p$ 是通带截止频率，$\\Omega_s$ 是阻带起始频率。从通带和阻带关于平方幅频响应 $|H(j\\Omega)|^2$ 的基本定义，以及由第一类切比雪夫多项式 $T_n(\\cdot)$ 在区间 $\\left[-1,1\\right]$ 上引入的等波纹特性出发，施加一个II型切比雪夫原型在 $\\Omega=\\Omega_p$ 和 $\\Omega=\\Omega_s$ 处必须满足的衰减水平。利用这些约束条件以及通过自变量 $T_n(\\Omega_s/\\Omega)$ 产生阻带波纹的映射关系，从第一性原理推导出满足给定指标的最小滤波器阶数 $n$。然后，利用II型切比雪夫低通原型在虚轴上的传输零点特性，确定不同的正归一化零点频率集合 $\\Omega_{z,k}/\\Omega_s$ (其中 $k=1,\\dots,\\lfloor n/2\\rfloor$)。所有角度均以弧度表示。报告最终的整数阶数 $n$ 和不同的正归一化零点频率 $\\Omega_{z,k}/\\Omega_s$（四舍五入到四位有效数字）。最终答案必须无单位，并且零点频率必须用 $\\Omega_s$ 归一化（即，报告 $\\Omega_{z,k}/\\Omega_s$）。", "solution": "II型切比雪夫低通滤波器的特点是通带内最大平坦，阻带内等波纹。其平方幅频响应定义为：\n$$ |H(j\\Omega)|^2 = \\frac{1}{1 + \\frac{1}{\\epsilon^2 T_n^2(\\Omega_s/\\Omega)}} $$\n其中 $T_n(x)$ 是 $n$ 阶第一类切比雪夫多项式，$\\Omega$ 是频率变量，$\\Omega_s$ 是阻带起始频率，而 $\\epsilon$ 是一个控制阻带衰减的参数。\n\n我们必须将设计指标施加到这个响应函数上。\n\n首先，考虑最小阻带衰减 $A_s$。这发生在阻带起始处 $\\Omega = \\Omega_s$，其中 $T_n(\\Omega_s/\\Omega_s) = T_n(1) = 1$。以分贝为单位的衰减由 $A(\\Omega) = -10\\log_{10}(|H(j\\Omega)|^2)$ 给出。\n$$ A_s = -10\\log_{10}(|H(j\\Omega_s)|^2) = -10\\log_{10}\\left(\\frac{1}{1 + 1/\\epsilon^2}\\right) = 10\\log_{10}(1 + 1/\\epsilon^2) $$\n由此，我们可以解出 $1/\\epsilon^2$：\n$$ \\frac{A_s}{10} = \\log_{10}\\left(1 + \\frac{1}{\\epsilon^2}\\right) \\implies 1/\\epsilon^2 = 10^{A_s/10} - 1 $$\n对于 $A_s = 50\\,\\text{dB}$，我们有 $1/\\epsilon^2 = 10^{50/10} - 1 = 10^5 - 1$。\n\n其次，考虑在通带截止频率 $\\Omega_p$ 处的最大通带损耗 $A_p$。\n$$ A_p \\ge -10\\log_{10}(|H(j\\Omega_p)|^2) \\implies |H(j\\Omega_p)|^2 \\ge 10^{-A_p/10} $$\n代入响应函数：\n$$ \\frac{1}{1 + \\frac{1}{\\epsilon^2 T_n^2(\\Omega_s/\\Omega_p)}} \\ge 10^{-A_p/10} $$\n整理不等式：\n$$ 1 + \\frac{1}{\\epsilon^2 T_n^2(\\Omega_s/\\Omega_p)} \\le 10^{A_p/10} $$\n$$ T_n^2(\\Omega_s/\\Omega_p) \\ge \\frac{1/\\epsilon^2}{10^{A_p/10} - 1} = \\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1} $$\n由于 $\\Omega_s/\\Omega_p > 1$，$T_n(\\Omega_s/\\Omega_p)$ 为正。取平方根可得：\n$$ T_n\\left(\\frac{\\Omega_s}{\\Omega_p}\\right) \\ge \\sqrt{\\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}} $$\n对于大于 $1$ 的自变量，切比雪夫多项式由 $T_n(x) = \\cosh(n \\operatorname{arccosh}(x))$ 给出。因此：\n$$ \\cosh\\left(n \\operatorname{arccosh}\\left(\\frac{\\Omega_s}{\\Omega_p}\\right)\\right) \\ge \\sqrt{\\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}} $$\n求解 $n$：\n$$ n \\ge \\frac{\\operatorname{arccosh}\\left(\\sqrt{\\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}}\\right)}{\\operatorname{arccosh}\\left(\\frac{\\Omega_s}{\\Omega_p}\\right)} $$\n使用给定值：$A_p = 1\\,\\text{dB}$，$A_s = 50\\,\\text{dB}$，以及 $\\Omega_s/\\Omega_p = 1.8$。\n$$ n \\ge \\frac{\\operatorname{arccosh}\\left(\\sqrt{\\frac{10^{5} - 1}{10^{0.1} - 1}}\\right)}{\\operatorname{arccosh}(1.8)} \\approx \\frac{\\operatorname{arccosh}\\left(\\sqrt{\\frac{99999}{0.258925}}\\right)}{1.19293} \\approx \\frac{\\operatorname{arccosh}(621.445)}{1.19293} \\approx \\frac{7.12519}{1.19293} \\approx 5.9729 $$\n所需的最小整数阶数为 $n = \\lceil 5.9729 \\rceil = 6$。\n\n接下来，我们确定传输零点。传递函数 $H(s)$ 的零点出现在频率 $\\Omega_z$ 处，其中 $|H(j\\Omega_z)|^2 = 0$。这对应于 $T_n(\\Omega_s/\\Omega) = 0$。\n切比雪夫多项式 $T_n(x)$ 的零点出现在 $x_k = \\cos\\left(\\frac{(2k-1)\\pi}{2n}\\right)$ 处，其中 $k = 1, 2, \\dots, n$。\n因此，零点频率 $\\Omega_{z,k}$ 满足：\n$$ \\frac{\\Omega_s}{\\Omega_{z,k}} = \\cos\\left(\\frac{(2k-1)\\pi}{2n}\\right) $$\n问题要求归一化的零点频率 $\\Omega_{z,k}/\\Omega_s$。重排该方程可得：\n$$ \\frac{\\Omega_{z,k}}{\\Omega_s} = \\frac{1}{\\cos\\left(\\frac{(2k-1)\\pi}{2n}\\right)} = \\sec\\left(\\frac{(2k-1)\\pi}{2n}\\right) $$\n我们需要不同的正归一化零点频率。对于 $n=6$，我们对 $k=1, \\dots, \\lfloor 6/2 \\rfloor=3$ 进行求值。\n- 对于 $k=1$：$\\frac{\\Omega_{z,1}}{\\Omega_s} = \\sec\\left(\\frac{\\pi}{12}\\right) \\approx 1.035276$。四舍五入到四位有效数字，结果是 $1.035$。\n- 对于 $k=2$：$\\frac{\\Omega_{z,2}}{\\Omega_s} = \\sec\\left(\\frac{3\\pi}{12}\\right) = \\sec\\left(\\frac{\\pi}{4}\\right) = \\sqrt{2} \\approx 1.414213$。四舍五入到四位有效数字，结果是 $1.414$。\n- 对于 $k=3$：$\\frac{\\Omega_{z,3}}{\\Omega_s} = \\sec\\left(\\frac{5\\pi}{12}\\right) \\approx 3.863703$。四舍五入到四位有效数字，结果是 $3.864$。\n\n最终结果是滤波器阶数 $n=6$ 和三个不同的正归一化零点频率。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6 & 1.035 & 1.414 & 3.864\n\\end{pmatrix}\n}\n$$", "id": "2858162"}, {"introduction": "模拟滤波器理论是现代数字滤波器设计的重要基石。本练习将通过一个实际的设计流程，展示如何利用双线性变换将模拟原型滤波器转化为数字滤波器。我们将探讨频率预畸变这一关键概念，以确保最终的数字滤波器能够精确满足其在数字域的频率规范，从而将我们在连续时间域的设计技能与离散时间域的应用联系起来。 [@problem_id:2858170]", "problem": "需要设计一个离散时间线性时不变 (LTI) 低通滤波器。该滤波器将采用双线性变换设计为数字逆切比雪夫（II型切比雪夫）滤波器，采样周期为 $T=1$。数字频率域（单位：弧度/采样点）的设计指标如下：通带边缘 $\\omega_{p}=0.4\\pi$，阻带边缘 $\\omega_{s}=0.6\\pi$，最大通带衰减 $A_{p}=0.5$ dB，以及最小阻带衰减 $A_{s}=80$ dB。设计过程必须通过一个经过频率预畸获得的模拟低通原型，然后将其映射到 $z$ 平面。\n\n任务：\n1) 使用模拟频率 $\\Omega$ 和数字频率 $\\omega$ 之间的双线性变换映射关系，对数字频率边缘进行预畸，以获得相应的模拟频率边缘 $\\Omega_{p}$ 和 $\\Omega_{s}$。\n2) 从通过第一类切比雪夫多项式表示的逆切比雪夫模拟低通响应的幅值平方形式出发，应用通带和阻带指标，推导出一个关于最小阶数 $n$ 的不等式，该不等式涉及选择性因子和波纹参数。根据给定数据计算 $n$。\n3) 确定逆切比雪夫原型的模拟传输零点，并给出它们映射到 $z$ 平面单位圆上位置的显式表达式。同时，写出在双线性变换下，每个模拟极点 $s_{k}$ 到其对应数字极点 $z_{k}$ 的映射关系。\n\n角度以弧度表示。您必须从第一性原理出发，展示所有推导步骤，从双线性变换和以切比雪夫多项式表示的逆切比雪夫幅值特性的定义形式开始，并证明所用到的任何不等式的合理性。对于最终答案，仅报告最小整数阶数 $n$（无单位，无附加文本）。", "solution": "第一步是对数字频率指标进行预畸变，以获得等效的模拟原型指标。双线性变换将 $s$ 平面和 $z$ 平面通过 $s = \\frac{2}{T}\\frac{z-1}{z+1}$ 关联起来。对于频率响应，令 $s=j\\Omega$ 和 $z=e^{j\\omega}$，我们得到频率映射关系：\n$$ \\Omega = \\frac{2}{T}\\tan\\left(\\frac{\\omega}{2}\\right) $$\n给定采样周期 $T=1$，数字通带边缘 $\\omega_p=0.4\\pi$ 和阻带边缘 $\\omega_s=0.6\\pi$，对应的模拟频率边缘为：\n$$ \\Omega_p = 2\\tan\\left(\\frac{0.4\\pi}{2}\\right) = 2\\tan(0.2\\pi) $$\n$$ \\Omega_s = 2\\tan\\left(\\frac{0.6\\pi}{2}\\right) = 2\\tan(0.3\\pi) $$\n因此，模拟原型滤波器的选择性系数为：\n$$ \\frac{\\Omega_s}{\\Omega_p} = \\frac{\\tan(0.3\\pi)}{\\tan(0.2\\pi)} \\approx 1.894 $$\n\n第二步是确定所需的最小滤波器阶数 $n$。逆切比雪夫（II型）滤波器的幅度平方响应为：\n$$ |H(j\\Omega)|^2 = \\frac{1}{1 + \\frac{1}{\\epsilon^2 T_n^2(\\Omega_s/\\Omega)}} $$\n其中 $T_n(x)$ 是 $n$ 阶第一类切比雪夫多项式。\n\n在阻带边缘 $\\Omega=\\Omega_s$ 处，衰减必须至少为 $A_s$。此处 $T_n(\\Omega_s/\\Omega_s) = T_n(1) = 1$，因此：\n$$ |H(j\\Omega_s)|^2 = \\frac{1}{1 + 1/\\epsilon^2} = 10^{-A_s/10} $$\n解出 $1/\\epsilon^2$：\n$$ \\frac{1}{\\epsilon^2} = 10^{A_s/10} - 1 $$\n\n在通带边缘 $\\Omega=\\Omega_p$ 处，衰减必须小于等于 $A_p$：\n$$ |H(j\\Omega_p)|^2 = \\frac{1}{1 + \\frac{1}{\\epsilon^2 T_n^2(\\Omega_s/\\Omega_p)}} \\ge 10^{-A_p/10} $$\n将 $1/\\epsilon^2$ 的表达式代入，并整理不等式：\n$$ 1 + \\frac{10^{A_s/10} - 1}{T_n^2(\\Omega_s/\\Omega_p)} \\le 10^{A_p/10} $$\n$$ T_n^2(\\Omega_s/\\Omega_p) \\ge \\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1} $$\n由于 $\\Omega_s/\\Omega_p > 1$ 且对于 $x>1$，$T_n(x)>0$，我们可以取平方根：\n$$ T_n\\left(\\frac{\\Omega_s}{\\Omega_p}\\right) \\ge \\sqrt{\\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}} $$\n对于 $x>1$，我们有 $T_n(x) = \\cosh(n \\operatorname{arccosh} x)$。代入上式并求解 $n$：\n$$ \\cosh\\left(n \\operatorname{arccosh}\\left(\\frac{\\Omega_s}{\\Omega_p}\\right)\\right) \\ge \\sqrt{\\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}} $$\n$$ n \\ge \\frac{\\operatorname{arccosh}\\left(\\sqrt{\\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}}\\right)}{\\operatorname{arccosh}\\left(\\frac{\\Omega_s}{\\Omega_p}\\right)} $$\n现在代入数值：$A_p = 0.5$ dB, $A_s = 80$ dB, $\\Omega_s/\\Omega_p \\approx 1.894$。\n$$ \\text{分子} = \\operatorname{arccosh}\\left(\\sqrt{\\frac{10^{80/10} - 1}{10^{0.5/10} - 1}}\\right) = \\operatorname{arccosh}\\left(\\sqrt{\\frac{10^8 - 1}{10^{0.05} - 1}}\\right) \\approx \\operatorname{arccosh}(28637) \\approx 10.955 $$\n$$ \\text{分母} = \\operatorname{arccosh}(1.894) \\approx 1.253 $$\n$$ n \\ge \\frac{10.955}{1.253} \\approx 8.74 $$\n由于阶数必须是整数，所以满足指标的最小阶数是 $n=9$。\n\n第三步是确定零点和极点的映射关系。\n模拟原型的传输零点位于 $j\\Omega$ 轴上，其频率 $\\Omega_{z,k}$ 满足 $T_n(\\Omega_s/\\Omega_{z,k}) = 0$。$T_n(x)$ 的零点为 $x_k = \\cos(\\frac{(2k-1)\\pi}{2n})$，其中 $k=1, \\dots, n$。因此：\n$$ \\Omega_{z,k} = \\frac{\\Omega_s}{\\cos\\left(\\frac{(2k-1)\\pi}{2n}\\right)} $$\n这些零点 $s_{z,k} = \\pm j \\Omega_{z,k}$ 通过双线性变换映射到数字滤波器单位圆上的零点 $z_{z,k} = e^{\\pm j\\omega_{z,k}}$，其中 $\\omega_{z,k} = 2\\arctan(\\frac{T \\Omega_{z,k}}{2})$。\n模拟原型的稳定极点 $\\{s_{p,k}\\}$ 通过双线性变换映射到数字滤波器的极点 $\\{z_{p,k}\\}$：\n$$ z_{p,k} = \\frac{1 + s_{p,k}T/2}{1 - s_{p,k}T/2} $$\n对于 $T=1$，即为 $z_{p,k} = \\frac{2 + s_{p,k}}{2 - s_{p,k}}$。由于 $s_{p,k}$ 在左半平面，对应的 $z_{p,k}$ 将在单位圆内，确保数字滤波器的稳定性。", "answer": "$$\\boxed{9}$$", "id": "2858170"}]}