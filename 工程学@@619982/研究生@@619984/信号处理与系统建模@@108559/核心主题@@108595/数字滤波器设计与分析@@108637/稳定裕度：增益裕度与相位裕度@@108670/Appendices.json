{"hands_on_practices": [{"introduction": "第一个实践是构建你技能的基础。通过分析一个典型的二阶系统，你将直接从定义出发推导增益和相位裕度的表达式。这个练习将巩固你对系统增益参数 $k$ 与其相位裕度之间关系的理解，让你具体地看到调节控制器如何影响系统的稳定性鲁棒性。[@problem_id:2906907]", "problem": "考虑一个连续时间、单回路单位反馈系统，其开环传递函数为\n$$\nL(s) \\;=\\; \\frac{k}{\\,s\\bigl(1 + s/\\omega_{p}\\bigr)} \\,,\n$$\n其中 $k>0$ 且 $\\omega_{p}>0$。该回路在原点有一个实极点，在 $s=-\\omega_{p}$ 处有一个实极点。使用以下基本定义：增益交越频率是满足 $\\lvert L(j\\omega_{gc})\\rvert = 1$ 的频率 $\\omega_{gc}>0$；相位裕度（PM）是在 $\\omega_{gc}$ 处，相位达到 $-180^\\circ$ 所需的额外相位滞后（以度为单位）；相位交越频率是开环相位等于 $-180^\\circ$ 的频率 $\\omega_{pc}>0$；增益裕度（GM）是开环系统在 $\\omega_{pc}$ 处幅值的倒数。根据这些定义，以及复数和有理传递函数的基本性质，来：\n\n- 推导幅值 $\\lvert L(j\\omega)\\rvert$ 和相位 $\\angle L(j\\omega)$ 作为 $\\omega$、$k$ 和 $\\omega_{p}$ 函数的闭式表达式。\n- 根据增益交越条件，推导以 $k$ 和 $\\omega_{p}$ 表示的 $\\omega_{gc}$，然后求出相位裕度 $\\mathrm{PM}(k,\\omega_{p})$（以度为单位）。\n- 确定该回路的相位交越行为，并推导出增益裕度 $\\mathrm{GM}(k,\\omega_{p})$。\n- 最后，确定使相位裕度满足 $\\mathrm{PM}\\geq 60^\\circ$ 的最大允许 $k$ 值（表示为 $\\omega_{p}$ 的函数）。\n\n所有角度均以度表示。你最终报告的答案必须是保证 $\\mathrm{PM}\\geq 60^\\circ$ 的最大允许 $k$ 值的单个闭式表达式。无需四舍五入。不要将中间结果或不等式作为最终答案报告。", "solution": "该问题要求对一个给定的二阶系统进行稳定性裕度的系统性推导，并随后确定一个增益参数的约束。我们按照指定的任务进行。\n\n首先，我们必须确定开环传递函数 $L(s)$ 的频率响应。给定的传递函数为\n$$\nL(s) = \\frac{k}{\\,s\\bigl(1 + s/\\omega_{p}\\bigr)}\n$$\n其中参数 $k$ 和 $\\omega_{p}$ 是正实数，$k>0$ 且 $\\omega_{p}>0$。频率响应通过代入 $s = j\\omega$ 得到，其中 $\\omega$ 是角频率。\n$$\nL(j\\omega) = \\frac{k}{j\\omega(1 + j\\omega/\\omega_{p})}\n$$\n$L(j\\omega)$ 的幅值，记为 $|L(j\\omega)|$，是分子和分母幅值的比值：\n$$\n|L(j\\omega)| = \\frac{|k|}{|j\\omega| \\cdot |1 + j\\omega/\\omega_{p}|}\n$$\n给定 $k > 0$，我们有 $|k|=k$。对于 $\\omega \\ge 0$，幅值 $|j\\omega|$ 是 $\\omega$。复数 $1 + j\\omega/\\omega_{p}$ 的幅值是 $\\sqrt{1^2 + (\\omega/\\omega_{p})^2}$。因此，幅值的表达式为：\n$$\n|L(j\\omega)| = \\frac{k}{\\omega \\sqrt{1 + \\frac{\\omega^2}{\\omega_{p}^2}}}\n$$\n$L(j\\omega)$ 的相位，记为 $\\angle L(j\\omega)$，计算为各项相位的总和，其中分母项以负号贡献：\n$$\n\\angle L(j\\omega) = \\angle k - \\angle(j\\omega) - \\angle(1 + j\\omega/\\omega_{p})\n$$\n由于 $k$ 是一个正实数，其相位为 $0^\\circ$。$j\\omega$ 的相位恰好是 $90^\\circ$。$1 + j\\omega/\\omega_{p}$ 的相位由 $\\arctan((\\omega/\\omega_{p})/1) = \\arctan(\\omega/\\omega_{p})$ 给出。因此，以度为单位的相位表达式为：\n$$\n\\angle L(j\\omega) = 0^\\circ - 90^\\circ - \\arctan\\left(\\frac{\\omega}{\\omega_{p}}\\right) = -90^\\circ - \\arctan\\left(\\frac{\\omega}{\\omega_{p}}\\right)\n$$\n接下来，我们推导增益交越频率 $\\omega_{gc}$ 和相位裕度 $\\mathrm{PM}$。根据定义，$\\omega_{gc}$ 是满足 $|L(j\\omega_{gc})| = 1$ 的频率。\n$$\n1 = \\frac{k}{\\omega_{gc} \\sqrt{1 + \\frac{\\omega_{gc}^2}{\\omega_{p}^2}}}\n$$\n将两边平方并重新排列各项，得到一个关于 $\\omega_{gc}^2$ 的多项式方程：\n$$\n1 = \\frac{k^2}{\\omega_{gc}^2 (1 + \\frac{\\omega_{gc}^2}{\\omega_{p}^2})} \\implies \\omega_{gc}^2 \\left(1 + \\frac{\\omega_{gc}^2}{\\omega_{p}^2}\\right) = k^2\n$$\n$$\n\\frac{1}{\\omega_{p}^2}\\omega_{gc}^4 + \\omega_{gc}^2 - k^2 = 0\n$$\n这是一个关于变量 $\\omega_{gc}^2$ 的二次方程。我们使用二次公式求解 $\\omega_{gc}^2$，其中系数为 $a=1/\\omega_{p}^2$、$b=1$ 和 $c=-k^2$：\n$$\n\\omega_{gc}^2 = \\frac{-1 \\pm \\sqrt{1^2 - 4(1/\\omega_{p}^2)(-k^2)}}{2(1/\\omega_{p}^2)} = \\frac{\\omega_{p}^2}{2} \\left(-1 \\pm \\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}}\\right)\n$$\n由于 $\\omega_{gc}^2$ 必须是正实数（根据定义 $\\omega_{gc} > 0$），我们必须选择带加号的解：\n$$\n\\omega_{gc}^2 = \\frac{\\omega_{p}^2}{2} \\left(\\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} - 1\\right)\n$$\n相位裕度 $\\mathrm{PM}$ 定义为 $\\mathrm{PM} = 180^\\circ + \\angle L(j\\omega_{gc})$。\n$$\n\\mathrm{PM} = 180^\\circ + \\left(-90^\\circ - \\arctan\\left(\\frac{\\omega_{gc}}{\\omega_{p}}\\right)\\right) = 90^\\circ - \\arctan\\left(\\frac{\\omega_{gc}}{\\omega_{p}}\\right)\n$$\n\n现在，我们分析相位交越行为和增益裕度 $\\mathrm{GM}$。相位交越频率 $\\omega_{pc}$ 是相位 $\\angle L(j\\omega_{pc}) = -180^\\circ$ 时的频率。\n$$\n-180^\\circ = -90^\\circ - \\arctan\\left(\\frac{\\omega_{pc}}{\\omega_{p}}\\right)\n$$\n$$\n-90^\\circ = - \\arctan\\left(\\frac{\\omega_{pc}}{\\omega_{p}}\\right) \\implies \\arctan\\left(\\frac{\\omega_{pc}}{\\omega_{p}}\\right) = 90^\\circ\n$$\n反正切函数仅在其自变量趋于无穷大时才趋近于 $90^\\circ$。这意味着 $\\omega_{pc}/\\omega_{p} \\to \\infty$，因此 $\\omega_{pc} \\to \\infty$。不存在有限的正频率 $\\omega_{pc}$ 使相位达到 $-180^\\circ$。增益裕度定义为 $\\mathrm{GM} = 1/|L(j\\omega_{pc})|$。在这种情况下，我们必须考虑 $\\omega \\to \\infty$ 时的极限：\n$$\n\\lim_{\\omega \\to \\infty} |L(j\\omega)| = \\lim_{\\omega \\to \\infty} \\frac{k}{\\omega \\sqrt{1 + \\omega^2/\\omega_{p}^2}} = \\lim_{\\omega \\to \\infty} \\frac{k}{\\omega (\\omega/\\omega_{p})} = \\lim_{\\omega \\to \\infty} \\frac{k \\omega_{p}}{\\omega^2} = 0\n$$\n在相位将达到 $-180^\\circ$ 的频率处，幅值为零。因此，增益裕度 $\\mathrm{GM} = 1/0$ 是无穷大。这表明对于所有正的 $k$ 值，闭环系统都是稳定的。\n\n最后，我们确定使相位裕度满足条件 $\\mathrm{PM} \\ge 60^\\circ$ 的最大允许 $k$ 值。\n$$\n90^\\circ - \\arctan\\left(\\frac{\\omega_{gc}}{\\omega_{p}}\\right) \\ge 60^\\circ\n$$\n$$\n30^\\circ \\ge \\arctan\\left(\\frac{\\omega_{gc}}{\\omega_{p}}\\right)\n$$\n由于 $\\arctan(x)$ 是一个单调递增函数，我们可以对不等式两边应用正切函数。$\\tan(30^\\circ)$ 的值是 $1/\\sqrt{3}$。\n$$\n\\frac{1}{\\sqrt{3}} \\ge \\frac{\\omega_{gc}}{\\omega_{p}}\n$$\n我们代入 $\\omega_{gc}/\\omega_p$ 的表达式：\n$$\n\\frac{1}{\\sqrt{3}} \\ge \\sqrt{\\frac{1}{2} \\left(\\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} - 1\\right)}\n$$\n对不等式两边平方：\n$$\n\\frac{1}{3} \\ge \\frac{1}{2} \\left(\\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} - 1\\right)\n$$\n我们现在求解 $k$：\n$$\n\\frac{2}{3} \\ge \\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} - 1\n$$\n$$\n\\frac{2}{3} + 1 \\ge \\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} \\implies \\frac{5}{3} \\ge \\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}}\n$$\n再次对两边平方：\n$$\n\\left(\\frac{5}{3}\\right)^2 \\ge 1 + \\frac{4k^2}{\\omega_{p}^2} \\implies \\frac{25}{9} \\ge 1 + \\frac{4k^2}{\\omega_{p}^2}\n$$\n$$\n\\frac{25}{9} - 1 \\ge \\frac{4k^2}{\\omega_{p}^2} \\implies \\frac{16}{9} \\ge \\frac{4k^2}{\\omega_{p}^2}\n$$\n$$\n\\frac{16}{9}\\omega_{p}^2 \\ge 4k^2 \\implies \\frac{4}{9}\\omega_{p}^2 \\ge k^2\n$$\n由于 $k > 0$ 且 $\\omega_{p} > 0$，对两边取正平方根，我们得到对 $k$ 的约束：\n$$\n\\frac{2}{3}\\omega_{p} \\ge k\n$$\n问题要求 $k$ 的最大允许值。这对应于等式成立的条件。因此，$k$ 的最大值为 $\\frac{2}{3}\\omega_{p}$。", "answer": "$$\n\\boxed{\\frac{2}{3}\\omega_{p}}\n$$", "id": "2906907"}, {"introduction": "将伯德图上的裕度直接解读为稳定性保证，其前提是开环系统本身是稳定的。本练习提供了一个关键的反例，揭示了在某些情况下，一个看起来健康的“表观”相位裕度可能是具有误导性的。通过分析一个包含不稳定开环极点的系统，你将理解为何必须回归更基本的奈奎斯特稳定性判据来准确诊断系统稳定性，并学会如何避免这一常见陷阱。[@problem_id:2906959]", "problem": "一个连续时间、单输入单输出、单位负反馈回路是围绕一个具有实系数的严格真环路传递函数 $L(s)$ 构成的。该环路传递函数为\n$$\nL(s) \\;=\\; K \\,\\frac{s+z}{(s-1)(s+1)(s+2)}\\,,\n$$\n其中 $K=\\dfrac{10\\sqrt{5}}{\\sqrt{29}}$ 且 $z=\\dfrac{2}{5}$。请注意，$L(s)$ 在右半平面 (RHP) 的 $s=1$ 处有一个极点。\n\n仅从核心定义（波特幅频和相频，以及源自 Cauchy 幅角原理的奈奎斯特稳定性判据）出发，完成以下任务：\n\n1) 将增益交越频率 $\\omega_{\\mathrm{gc}}$ 定义为 $|L(\\mathrm{j}\\omega)|=1$ 的正实数解。计算 $\\omega_{\\mathrm{gc}}$ 及相应的环路相位 $\\angle L(\\mathrm{j}\\omega_{\\mathrm{gc}})$。然后，使用波特分析中相位裕度 (PM) 的标准定义，计算在（错误地）忽略 $L(s)$ 中存在 RHP 极点的情况下，从波特图上会报告的“表观”PM。角度以度为单位表示。您可以保留精确的中间符号表达式；如果给出任何十进制角度，请四舍五入到四位有效数字。\n\n2) 使用奈奎斯特稳定性判据（基于 Cauchy 幅角原理），确定 $1+L(s)$ 在 RHP 中的零点数量 $Z$，该数量等于单位反馈系统的闭环极点在 RHP 中的数量。通过直接根据您在第 1 部分的答案和低频值 $L(0)$ 所暗示的奈奎斯特图的定性几何形状进行推理，来证明您对环绕数的确定。\n\n3) 提供一个诊断性解释，以调和第 1 步中得到的正“表观”PM 与第 2 步中得到的不稳定闭环系统。明确指出将增益裕度 (GM) 和相位裕度 (PM) 解释为稳定性保证背后的哪项标准假设被违背，以及如何先验地检测这种情况。\n\n仅报告 $Z$ 的整数值作为最终答案（无单位，无附加文本）。$Z$ 无需四舍五入。", "solution": "第 1 部分：“表观”相位裕度的计算\n\n环路传递函数的频率响应为 $L(j\\omega)$。$L(j\\omega)$ 的幅值平方由下式给出：\n$$\n|L(j\\omega)|^2 = \\left| K \\frac{j\\omega+z}{(j\\omega-1)(j\\omega+1)(j\\omega+2)} \\right|^2 = K^2 \\frac{|j\\omega+z|^2}{|(j\\omega)^2-1|^2 |j\\omega+2|^2} = K^2 \\frac{\\omega^2+z^2}{(\\omega^2+1)^2 (\\omega^2+4)}\n$$\n增益交越频率 $\\omega_{\\mathrm{gc}}$ 是使得 $|L(j\\omega_{\\mathrm{gc}})| = 1$ 的正频率，这等价于 $|L(j\\omega_{\\mathrm{gc}})|^2 = 1$。\n给定的常数为 $K=\\frac{10\\sqrt{5}}{\\sqrt{29}}$ 和 $z=\\frac{2}{5}$。\n因此，$K^2 = \\frac{100 \\times 5}{29} = \\frac{500}{29}$ 且 $z^2 = \\frac{4}{25}$。\n我们需要从以下方程求解 $\\omega_{\\mathrm{gc}}$：\n$$\n1 = \\frac{500}{29} \\frac{\\omega_{\\mathrm{gc}}^2 + \\frac{4}{25}}{(\\omega_{\\mathrm{gc}}^2+1)^2 (\\omega_{\\mathrm{gc}}^2+4)}\n$$\n让我们测试解 $\\omega_{\\mathrm{gc}}=1$ rad/s，这意味着 $\\omega_{\\mathrm{gc}}^2=1$。\n$$\n\\frac{500}{29} \\frac{1 + \\frac{4}{25}}{(1+1)^2 (1+4)} = \\frac{500}{29} \\frac{\\frac{29}{25}}{(2^2)(5)} = \\frac{500}{29} \\frac{29/25}{20} = \\frac{500}{29} \\frac{29}{500} = 1\n$$\n方程成立。因此，增益交越频率为 $\\omega_{\\mathrm{gc}} = 1$ rad/s。\n\n接下来，我们计算在 $\\omega = \\omega_{\\mathrm{gc}} = 1$ 处 $L(j\\omega)$ 的相位。该相位由下式给出：\n$$\n\\angle L(j\\omega) = \\angle(j\\omega+z) - \\angle(j\\omega-1) - \\angle(j\\omega+1) - \\angle(j\\omega+2)\n$$\n以度表示角度：\n$$\n\\angle(j\\omega+z) = \\arctan\\left(\\frac{\\omega}{z}\\right)\n$$\n$$\n\\angle(j\\omega-1) = \\angle(-1+j\\omega) = 180^\\circ - \\arctan(\\omega)\n$$\n$$\n\\angle(j\\omega+1) = \\arctan(\\omega)\n$$\n$$\n\\angle(j\\omega+2) = \\arctan\\left(\\frac{\\omega}{2}\\right)\n$$\n所以，总相位为：\n$$\n\\angle L(j\\omega) = \\arctan\\left(\\frac{\\omega}{z}\\right) - \\left(180^\\circ - \\arctan(\\omega)\\right) - \\arctan(\\omega) - \\arctan\\left(\\frac{\\omega}{2}\\right) = \\arctan\\left(\\frac{\\omega}{z}\\right) - \\arctan\\left(\\frac{\\omega}{2}\\right) - 180^\\circ\n$$\n在 $\\omega = \\omega_{\\mathrm{gc}}=1$ 且 $z=\\frac{2}{5}$ 时：\n$$\n\\angle L(j1) = \\arctan\\left(\\frac{1}{2/5}\\right) - \\arctan\\left(\\frac{1}{2}\\right) - 180^\\circ = \\arctan(2.5) - \\arctan(0.5) - 180^\\circ\n$$\n使用恒等式 $\\arctan(a) - \\arctan(b) = \\arctan\\left(\\frac{a-b}{1+ab}\\right)$，我们得到：\n$$\n\\arctan(2.5) - \\arctan(0.5) = \\arctan\\left(\\frac{2.5 - 0.5}{1 + 2.5 \\times 0.5}\\right) = \\arctan\\left(\\frac{2}{1 + 1.25}\\right) = \\arctan\\left(\\frac{2}{2.25}\\right) = \\arctan\\left(\\frac{8}{9}\\right)\n$$\n所以，在增益交越频率处的相位是：\n$$\n\\angle L(j\\omega_{\\mathrm{gc}}) = \\arctan\\left(\\frac{8}{9}\\right) - 180^\\circ \\approx 41.6339^\\circ - 180^\\circ = -138.3661^\\circ\n$$\n四舍五入到四位有效数字，$\\angle L(j\\omega_{\\mathrm{gc}}) \\approx -138.4^\\circ$。\n\n相位裕度 (PM) 的标准定义是 $PM = 180^\\circ + \\angle L(j\\omega_{\\mathrm{gc}})$。忽略右半平面极点的“表观”PM 为：\n$$\nPM_{\\mathrm{apparent}} = 180^\\circ + \\left(\\arctan\\left(\\frac{8}{9}\\right) - 180^\\circ\\right) = \\arctan\\left(\\frac{8}{9}\\right) \\approx 41.63^\\circ\n$$\n这是一个正的相位裕度。\n\n第 2 部分：奈奎斯特稳定性分析\n\n奈奎斯特稳定性判据指出 $Z = N + P$，其中：\n- $Z$ 是 $1+L(s)$ 在右半平面 (RHP) 中的零点数量，这对应于不稳定闭环极点的数量。\n- $P$ 是开环传递函数 $L(s)$ 在 RHP 中的极点数量。\n- $N$ 是 $L(s)$ 的奈奎斯特图对临界点 $-1+j0$ 的顺时针环绕数。\n\n根据 $L(s) = K \\frac{s+z}{(s-1)(s+1)(s+2)}$ 的定义，我们可以确定极点位于 $s=1$、$s=-1$ 和 $s=-2$。位于 $s=1$ 的极点在 RHP 中。因此，$P=1$。\n\n为了确定 $N$，我们分析奈奎斯特图，它是标准奈奎斯特 D 形围线的映像。我们需要确定该图是否环绕点 $-1$。\n1.  当 $\\omega \\to 0^+$ 时，$L(j\\omega) \\to L(0) = K \\frac{z}{(-1)(1)(2)} = -\\frac{Kz}{2}$。\n    $L(0) = -\\frac{1}{2} \\left(\\frac{10\\sqrt{5}}{\\sqrt{29}}\\right) \\left(\\frac{2}{5}\\right) = -\\frac{2\\sqrt{5}}{\\sqrt{29}} \\approx -0.8318$。\n    图像在负实轴上约 $-0.8318$ 处开始，该点位于 $-1$ 的右侧。\n2.  $L(j\\omega)$ 的相位为 $\\angle L(j\\omega) = \\arctan(2.5\\omega) - \\arctan(0.5\\omega) - 180^\\circ$。对于 $\\omega \\in (0, \\infty)$，$\\arctan(2.5\\omega)$ 和 $\\arctan(0.5\\omega)$ 都在 $(0, 90^\\circ)$ 范围内，并且 $\\arctan(2.5\\omega) > \\arctan(0.5\\omega)$。因此，$\\arctan(2.5\\omega) - \\arctan(0.5\\omega)$ 在 $(0, 90^\\circ)$ 范围内。这意味着 $\\angle L(j\\omega)$ 始终在 $(-180^\\circ, -90^\\circ)$ 区间内。当 $\\omega > 0$ 时，图像完全保持在第三象限。它从不穿过负实轴。\n3.  当 $\\omega \\to \\infty$ 时，由于系统是严格真的，$L(j\\omega) \\to 0$。相位趋近于 $\\lim_{\\omega\\to\\infty} (\\arctan(2.5\\omega) - \\arctan(0.5\\omega) - 180^\\circ) = 90^\\circ - 90^\\circ - 180^\\circ = -180^\\circ$。图像沿负实轴趋近于原点。\n4.  由于 $L(s)$ 是严格真的，s 平面中 D 形围线的大半圆闭合路径映射到 L(s) 平面中原点处的一条路径。\n\n对于 $\\omega \\in (-\\infty, \\infty)$，奈奎斯特图在 $\\omega \\to -\\infty$ 时从原点开始，移动到 $L(0) \\approx -0.8318$，在第二和第三象限形成一个环路，该环路穿过单位圆上的点 $L(j1)$，但从不穿过 $-1$ 左侧的实轴，并在 $\\omega \\to \\infty$ 时返回原点。临界点 $-1+j0$ 从未被图像环绕。\n因此，环绕数为 $N=0$。\n\n使用奈奎斯特判据，不稳定闭环极点的数量为：\n$$\nZ = N + P = 0 + 1 = 1\n$$\n闭环系统在右半平面有一个极点，因此是不稳定的。\n\n第 3 部分：调和与诊断性解释\n\n分析揭示了一个“表观”矛盾：一个正的相位裕度 ($PM \\approx 41.63^\\circ$) 通常与稳定性相关，但系统却是不稳定的 ($Z=1$)。通过理解波特图稳定性裕度的局限性，可以解决这一差异。\n\n认为正相位裕度和大于 1 的增益裕度能保证闭环稳定性的标准解释，仅在开环系统 $L(s)$ 稳定时（即 P = 0）才有效。\n\n在本问题中，这一基本假设被违背了。开环传递函数 $L(s)$ 在 $s=1$ 处有一个极点，因此它是不稳定的，且 $P=1$。对于开环不稳定的系统，必须直接使用奈奎斯特判据 $Z=N+P$。为了保证稳定性，我们需要 $Z=0$。在 $P=1$ 的情况下，这将要求 $N = Z-P = 0-1 = -1$，意味着奈奎斯特图必须逆时针环绕临界点 $-1$ 一次。\n\n正的相位裕度仅仅表明，在增益交越频率处，相位比 $-180^\\circ$ 的负值要小。如果没有开环极点位置的附加背景信息，它不提供关于环绕数 $N$ 的任何信息。在本案例中，正的相位裕度出现在一个奈奎斯特图根本不环绕 $-1$（即 $N=0$）的系统中，未能提供所需的起稳定作用的逆时针环绕。\n\n对这种情况的先验检测是直接的：必须始终首先确定开环传递函数 $L(s)$ 的极点。任何具有正实部的极点（本例中为 $s=1$）的存在，会立即使与波特图相关的简单稳定性经验法则失效，并强制要求使用完整的奈奎斯特稳定性判据（或等效方法，如根轨迹法）。", "answer": "$$\n\\boxed{1}\n$$", "id": "2906959"}, {"introduction": "在实际控制系统中，未建模的时间延迟是导致不稳定的一个常见原因。本实践引入了延迟裕度的概念，作为衡量系统对此类延迟鲁棒性的直接指标。你将比较通过奈奎斯特判据推导出的精确延迟裕度与一个广泛使用的近似公式，并在此过程中发现这种便捷的近似在何种条件下会失效，尤其是在面对复杂频率响应的系统时。[@problem_id:2906975]", "problem": "考虑一个无时间延迟的连续时间、线性时不变（LTI）、严格真开环传递函数族 $L(s)$。向 $L(s)$ 附加一个纯时间延迟 $e^{-s \\tau}$ 不会改变开环幅值，但在频率 $\\omega$（单位为弧度/秒）处会引入一个 $-\\omega \\tau$ 的附加相位滞后。闭环配置采用单位反馈。延迟裕度是指最大的非负延迟值 $\\tau_{\\max}$（单位为秒），当所有 $\\tau \\in [0,\\tau_{\\max})$ 时，闭环系统保持稳定。您需要比较根据奈奎斯特稳定性判据计算的精确延迟裕度与近似值 $\\tau_{\\max}^{\\text{approx}}=\\mathrm{PM}/\\omega_{gc}$，并量化其误差。其中，$\\mathrm{PM}$ 是以弧度为单位的相位裕度（PM），$\\omega_{gc}$ 是以弧度/秒为单位的幅值穿越频率。\n\n对于每个指定的测试用例，您的程序必须执行以下操作：\n- 仅使用奈奎斯特稳定性判据的基本定义和 $L(j\\omega)$ 的频率响应，通过在某个频率 $\\omega>0$ 处施加奈奎斯特判据所蕴含的临界稳定条件，计算精确的延迟裕度 $\\tau_{\\max}^{\\text{exact}}$。\n- 使用最小的正幅值穿越频率 $\\omega_{gc}$（即满足 $\\lvert L(j\\omega)\\rvert=1$ 的最小 $\\omega>0$）和以弧度为单位的相位裕度 $\\mathrm{PM}=\\pi+\\arg L(j\\omega_{gc})$，计算近似延迟裕度 $\\tau_{\\max}^{\\text{approx}}=\\mathrm{PM}/\\omega_{gc}$。其中 $\\arg L(j\\omega)$ 是幅角在 $(-\\pi,\\pi]$ 内的主值。\n- 以小数形式（无百分号）报告绝对误差 $\\lvert \\tau_{\\max}^{\\text{exact}}-\\tau_{\\max}^{\\text{approx}}\\rvert$ 和相对误差 $\\lvert \\tau_{\\max}^{\\text{exact}}-\\tau_{\\max}^{\\text{approx}}\\rvert/\\tau_{\\max}^{\\text{exact}}$。\n\n所有角度单位必须是弧度，频率单位是弧度/秒，延迟单位是秒。所有报告的浮点数输出必须四舍五入到 $6$ 位小数。\n\n测试套件。对于每个开环系统，选择标量增益 $K$ 以使指定的目标频率 $\\omega_{0}$ 成为一个幅值穿越点，即 $\\lvert L(j\\omega_{0})\\rvert=1$。具体而言，$K$ 定义为 $K=1/\\lvert L_{0}(j\\omega_{0})\\rvert$，其中 $L_{0}(s)$ 是 $K=1$ 时的开环系统。\n\n- 用例 A（具有中等相位斜率的基准）：\n  $$\n  L_{A}(s)=\\frac{K_{A}}{s\\left(1+\\frac{s}{1}\\right)\\left(1+\\frac{s}{4}\\right)}, \\quad \\text{with } \\omega_{0}=2.\n  $$\n- 用例 B（通过多个实极点产生显著的相位斜率）：\n  $$\n  L_{B}(s)=\\frac{K_{B}}{s\\left(1+\\frac{s}{0.5}\\right)\\left(1+\\frac{s}{1}\\right)\\left(1+\\frac{s}{2}\\right)\\left(1+\\frac{s}{4}\\right)}, \\quad \\text{with } \\omega_{0}=2.\n  $$\n- 用例 C（谐振对造成多个单位幅值穿越点）：\n  $$\n  L_{C}(s)=K_{C}\\cdot \\frac{\\omega_{n}^{2}}{s\\left(s^{2}+2\\zeta\\omega_{n}s+\\omega_{n}^{2}\\right)\\left(1+\\frac{s}{p}\\right)}, \\quad \\omega_{n}=3,\\ \\zeta=0.1,\\ p=8,\\ \\omega_{0}=3.\n  $$\n\n对于每个用例，您的程序必须：\n- 构建 $K=1$ 时的 $L_{0}(s)$，然后计算 $K=1/\\lvert L_{0}(j\\omega_{0})\\rvert$ 以使 $\\lvert L(j\\omega_{0})\\rvert=1$。\n- 仅使用奈奎斯特临界稳定条件以及纯延迟贡献相位 $-\\omega \\tau$ 而不改变幅值这一事实，计算 $\\tau_{\\max}^{\\text{exact}}$。\n- 在满足 $\\lvert L(j\\omega_{gc})\\rvert=1$ 的最小 $\\omega_{gc}>0$ 处，计算 $\\tau_{\\max}^{\\text{approx}}=\\mathrm{PM}/\\omega_{gc}$。\n- 按规定计算绝对误差和相对误差。\n\n最终输出格式。您的程序应生成单行输出，包含一个以逗号分隔的列表的列表形式的结果：\n- 外层列表长度为 $3$，按 A、B、C 的顺序对应三个用例。\n- 每个内层列表包含四个浮点数，四舍五入到 $6$ 位小数，并按 $[\\tau_{\\max}^{\\text{exact}},\\ \\tau_{\\max}^{\\text{approx}},\\ \\lvert \\text{abs error}\\rvert,\\ \\text{rel error}]$ 的顺序排列。\n- 打印的行必须严格遵循以下格式，不得包含任何额外文本：\n$[[\\tau_{A}^{\\text{exact}},\\tau_{A}^{\\text{approx}},e_{A}^{\\text{abs}},e_{A}^{\\text{rel}}], [\\tau_{B}^{\\text{exact}},\\tau_{B}^{\\text{approx}},e_{B}^{\\text{abs}},e_{B}^{\\text{rel}}], [\\tau_{C}^{\\text{exact}},\\tau_{C}^{\\text{approx}},e_{C}^{\\text{abs}},e_{C}^{\\text{rel}}]]$\n没有额外文本。\n\n所有计算必须在纯数学上进行；除了指定的单位外，不需要其他物理单位。角度单位必须是弧度，频率单位是弧度/秒，延迟单位是秒，相对误差必须是小数（而不是百分比）。您的程序不得读取任何输入。", "solution": "问题的核心在于确定一个开环传递函数为 $L(s)e^{-s\\tau}$ 的单位反馈系统的延迟裕度 $\\tau_{\\max}$。当 $\\tau \\in [0, \\tau_{\\max})$ 时，系统是稳定的，在 $\\tau = \\tau_{\\max}$ 时达到临界稳定。根据奈奎斯特稳定性判据，对于一个开环稳定的系统，当开环传递函数的奈奎斯特图穿过临界点 $-1+j0$ 时，系统达到临界稳定。\n\n带有延迟的开环传递函数是 $L_{d}(s) = L(s)e^{-s\\tau}$。其频率响应为 $L_{d}(j\\omega) = L(j\\omega)e^{-j\\omega\\tau}$。临界稳定的条件是：\n$$\nL(j\\omega)e^{-j\\omega\\tau} = -1\n$$\n这个复数方程可以分解为幅值和相位的两个实数方程：\n1.  幅值条件：$|L(j\\omega)| = 1$。满足此条件的频率 $\\omega > 0$ 称为幅值穿越频率。设这些频率的集合为 $\\{\\omega_{gc,i}\\}$。\n2.  相位条件：$\\arg(L(j\\omega)e^{-j\\omega\\tau}) = -\\pi$。这可展开为 $\\arg(L(j\\omega)) - \\omega\\tau = -(2k+1)\\pi$，其中 $k$ 为某个整数。对于最小的正延迟 $\\tau$，我们取 $k=0$，因此 $\\arg(L(j\\omega)) - \\omega\\tau = -\\pi$。\n\n结合这些条件，对于每个幅值穿越频率 $\\omega_{gc,i}$，我们可以找到一个在该频率下导致临界稳定的延迟 $\\tau_i$：\n$$\n\\tau_i = \\frac{\\pi + \\arg(L(j\\omega_{gc,i}))}{\\omega_{gc,i}}\n$$\n项 $\\pi + \\arg(L(j\\omega_{gc,i}))$ 是在频率 $\\omega_{gc,i}$ 处的相位裕度。由于延迟 $\\tau$ 必须为非负值，我们只考虑相位裕度为非负的解。\n一旦延迟 $\\tau$ 达到这些可能值中的最小值，整个系统就会变得不稳定。因此，精确的延迟裕度是所有这些有效计算延迟中的最小值：\n$$\n\\tau_{\\max}^{\\text{exact}} = \\min_{i} \\left\\{ \\tau_i \\mid \\tau_i \\ge 0 \\right\\}\n$$\n问题要求将此精确值与一个常用近似值进行比较：\n$$\n\\tau_{\\max}^{\\text{approx}} = \\frac{\\mathrm{PM}}{\\omega_{gc}}\n$$\n其中 $\\omega_{gc}$ 是*最小*的正幅值穿越频率，而 $\\mathrm{PM}$ 是在该特定频率下计算的相位裕度，$\\mathrm{PM} = \\pi + \\arg(L(j\\omega_{gc}))$。\n\n每个测试用例的步骤如下：\n1.  定义增益 $K=1$ 时的基本开环传递函数 $L_0(s)$。\n2.  对于给定的频率 $\\omega_0$，计算所需的增益 $K = 1/|L_0(j\\omega_0)|$ 以确保 $|K L_0(j\\omega_0)|=1$。完整的传递函数则为 $L(s) = K \\cdot L_0(s)$。\n3.  数值求解所有满足 $|L(j\\omega)|=1$ 的正频率 $\\omega_{gc,i}$。这可以通过寻找函数 $g(\\omega) = |L(j\\omega)|-1$ 的根来实现。通过扫描一个宽广的频率范围来确定根存在的区间，并采用数值求根算法。\n4.  最小的正根被指定为 $\\omega_{gc}$。使用这个值，我们计算 $\\tau_{\\max}^{\\text{approx}} = (\\pi + \\arg(L(j\\omega_{gc})))/\\omega_{gc}$。\n5.  使用找到的全套幅值穿越频率 $\\{\\omega_{gc,i}\\}$，我们计算出潜在延迟集合 $\\{\\tau_i\\}$。该集合中的最小非负值即为 $\\tau_{\\max}^{\\text{exact}}$。\n6.  对于用例 A 和 B，发现其幅值响应 $|L(j\\omega)|$ 在 $\\omega > 0$ 时是单调递减的。因此，只有一个幅值穿越频率。在这种情况下，最小（也是唯一）的穿越频率用于两种计算，导致 $\\tau_{\\max}^{\\text{exact}} = \\tau_{\\max}^{\\text{approx}}$ 且误差为零。\n7.  对于用例 C，谐振对 $(\\zeta=0.1)$ 的存在产生了一个非单调的幅值响应 $|L(j\\omega)|$，其在自然频率 $\\omega_n=3$ 附近达到峰值。这导致了多个幅值穿越频率。近似计算只使用这些频率中最低的一个，而精确计算则考虑所有这些频率。较高频率的穿越点通常产生较小的延迟值，从而揭示了精确延迟裕度与近似延迟裕度之间的差异。这个差异是本问题研究的主要课题。\n8.  最后，计算绝对误差和相对误差，并按要求将所有结果四舍五入到 $6$ 位小数。如果 $\\tau_{\\max}^{\\text{exact}} = 0$，则相对误差计为 $0$。\n\n实现将利用 `numpy` 进行复数运算，并使用 `scipy.optimize.root_scalar` 进行稳健的数值求根。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves the delay margin problem for three specified test cases.\n    \"\"\"\n\n    def get_l0_func(case_id):\n        \"\"\"Returns the L0(s) function for a given case.\"\"\"\n        if case_id == 'A':\n            return lambda s: 1 / (s * (1 + s / 1) * (1 + s / 4))\n        elif case_id == 'B':\n            return lambda s: 1 / (s * (1 + s / 0.5) * (1 + s / 1) * (1 + s / 2) * (1 + s / 4))\n        elif case_id == 'C':\n            omega_n, zeta, p = 3.0, 0.1, 8.0\n            return lambda s: (omega_n**2) / (s * (s**2 + 2 * zeta * omega_n * s + omega_n**2) * (1 + s / p))\n        else:\n            raise ValueError(f\"Unknown case: {case_id}\")\n\n    def find_crossover_frequencies(l_func, case_id):\n        \"\"\"Finds all positive gain crossover frequencies.\"\"\"\n        mag_func = lambda w: np.abs(l_func(complex(0, w))) - 1\n        \n        # Wide log-space search\n        omegas = np.logspace(-2, 2, 2000)\n        crossovers = []\n        for i in range(len(omegas) - 1):\n            w1, w2 = omegas[i], omegas[i+1]\n            if mag_func(w1) * mag_func(w2)  0:\n                try:\n                    sol = root_scalar(mag_func, bracket=[w1, w2], method='brentq')\n                    if sol.converged:\n                        crossovers.append(sol.root)\n                except ValueError:\n                    # Bracket may not be valid if function just touches zero\n                    pass\n        \n        # For Case C, add a fine linear search around resonance to catch closely spaced roots.\n        if case_id == 'C':\n            omegas_fine = np.linspace(2.0, 4.0, 500)\n            for i in range(len(omegas_fine) - 1):\n                w1, w2 = omegas_fine[i], omegas_fine[i+1]\n                if mag_func(w1) * mag_func(w2)  0:\n                    try:\n                        sol = root_scalar(mag_func, bracket=[w1, w2], method='brentq')\n                        if sol.converged:\n                            crossovers.append(sol.root)\n                    except ValueError:\n                        pass\n                        \n        # Remove duplicates and sort\n        if not crossovers:\n             raise RuntimeError(f\"No gain crossover frequencies found for case {case_id}\")\n             \n        unique_crossovers = sorted(list(set(np.round(crossovers, 9))))\n        return unique_crossovers\n\n    test_cases = [\n        {'id': 'A', 'omega0': 2.0},\n        {'id': 'B', 'omega0': 2.0},\n        {'id': 'C', 'omega0': 3.0}\n    ]\n\n    results = []\n\n    for case in test_cases:\n        case_id = case['id']\n        omega0 = case['omega0']\n\n        l0_func = get_l0_func(case_id)\n        \n        # Compute gain K\n        k = 1.0 / np.abs(l0_func(complex(0, omega0)))\n        l_func = lambda s: k * l0_func(s)\n\n        # Find all gain crossover frequencies\n        omegas_gc = find_crossover_frequencies(l_func, case_id)\n        \n        # Calculate exact delay margin\n        taus = []\n        for w_gc_i in omegas_gc:\n            phase = np.angle(l_func(complex(0, w_gc_i)))\n            # Delay must be non-negative\n            if np.pi + phase >= 0:\n                taus.append((np.pi + phase) / w_gc_i)\n        \n        tau_exact = min(taus) if taus else 0.0\n\n        # Calculate approximate delay margin\n        w_gc_smallest = omegas_gc[0]\n        phase_at_smallest_w_gc = np.angle(l_func(complex(0, w_gc_smallest)))\n        pm = np.pi + phase_at_smallest_w_gc\n        \n        tau_approx = pm / w_gc_smallest if pm >= 0 else 0.0\n\n        # Calculate errors\n        abs_error = np.abs(tau_exact - tau_approx)\n        if tau_exact == 0.0:\n            rel_error = 0.0\n        else:\n            rel_error = abs_error / tau_exact\n        \n        case_results = [tau_exact, tau_approx, abs_error, rel_error]\n        results.append([round(val, 6) for val in case_results])\n\n    # Format and print the final output\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "2906975"}]}