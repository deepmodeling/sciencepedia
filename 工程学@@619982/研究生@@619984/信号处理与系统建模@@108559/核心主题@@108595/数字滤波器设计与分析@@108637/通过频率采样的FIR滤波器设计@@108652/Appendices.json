{"hands_on_practices": [{"introduction": "通过在特定点定义期望的频率响应，我们开启了频率采样方法的设计之旅。在这些采样点中，最基础的是对应于直流增益的 $k=0$ 点。本练习将展示这个单一频率样本 $H(0)$ 与一个关键时域特性——滤波器冲激响应系数的平均值——之间的直接而有力的关系。掌握这种联系是理解频域规格如何转化为时域滤波器行为的关键第一步。[@problem_id:1719160]", "problem": "一位工程师正在为某个音频处理应用设计一个长度为 $N=50$ 的数字有限脉冲响应（FIR）滤波器。该设计基于频率采样法，即通过在归一化角频率 $\\omega_k = \\frac{2\\pi k}{N}$（其中 $k = 0, 1, \\dots, N-1$）上指定期望频率响应的 $N$ 个样本 $H(k)$ 来定义滤波器的特性。该滤波器的一个关键性能要求是，其所有脉冲响应系数 $h[n]$（其中 $n = 0, 1, \\dots, N-1$）的算术平均值必须精确地为 $0.15$。\n\n为了满足这一设计约束，在对应于 $k=0$ 的频率上的频率样本 $H(k)$ 必须被赋予什么数值？请用一个实数表示你的答案。", "solution": "问题要求一个长度为 $N$ 的FIR滤波器，当其脉冲响应系数 $h[n]$ 的算术平均值为一个特定值时，频率样本 $H(0)$ 的值是多少。\n\n设FIR滤波器的脉冲响应为 $h[n]$，其中 $n=0, 1, \\dots, N-1$。滤波器的长度给定为 $N=50$。\n问题陈述其脉冲响应系数的算术平均值必须为 $0.15$。我们可以将此条件用数学形式写作：\n$$\n\\frac{1}{N} \\sum_{n=0}^{N-1} h[n] = 0.15\n$$\n由此表达式，我们可以求得所需的脉冲响应系数之和：\n$$\n\\sum_{n=0}^{N-1} h[n] = N \\times 0.15\n$$\n\nFIR滤波器的频率响应由其脉冲响应 $h[n]$ 的离散时间傅里叶变换（DTFT）给出：\n$$\nH(e^{j\\omega}) = \\sum_{n=0}^{N-1} h[n] e^{-j\\omega n}\n$$\n滤波器的直流增益是其在零频率（即 $\\omega=0$）处的频率响应值。\n$$\nH(e^{j0}) = \\sum_{n=0}^{N-1} h[n] e^{-j(0)n} = \\sum_{n=0}^{N-1} h[n] (1) = \\sum_{n=0}^{N-1} h[n]\n$$\n因此，脉冲响应系数之和等于滤波器的直流增益。\n\n在FIR滤波器设计的频率采样法中，滤波器的频率响应由在均匀间隔的频率 $\\omega_k = \\frac{2\\pi k}{N}$（其中 $k=0, 1, \\dots, N-1$）上采样的 $N$ 个样本 $H(k)$ 指定。每个样本 $H(k)$ 是连续频率响应 $H(e^{j\\omega})$ 在相应频率 $\\omega_k$ 上的一个样本。\n$$\nH(k) = H(e^{j\\omega_k}) = H\\left(e^{j \\frac{2\\pi k}{N}}\\right)\n$$\n我们关心的是 $k=0$ 处的样本。该样本对应的频率是 $\\omega_0 = \\frac{2\\pi(0)}{N} = 0$。\n因此，频率样本 $H(0)$ 是频率响应在 $\\omega=0$ 处的值：\n$$\nH(0) = H(e^{j0})\n$$\n这意味着频率样本 $H(0)$ 精确地等于滤波器的直流增益。\n\n结合我们的发现，我们可以将 $H(0)$ 与脉冲响应系数之和联系起来：\n$$\nH(0) = H(e^{j0}) = \\sum_{n=0}^{N-1} h[n]\n$$\n并且根据问题的约束，我们知道：\n$$\n\\sum_{n=0}^{N-1} h[n] = N \\times 0.15\n$$\n因此，我们可以得出结论：\n$$\nH(0) = N \\times 0.15\n$$\n问题指定滤波器长度 $N=50$。将此值代入方程：\n$$\nH(0) = 50 \\times 0.15\n$$\n$$\nH(0) = 7.5\n$$\n所以，为了满足设计约束，在 $k=0$ 处的频率样本必须设置为 7.5。", "answer": "$$\\boxed{7.5}$$", "id": "1719160"}, {"introduction": "在理解了单个采样点的作用后，我们可以探索一组完整的样本如何塑造整个冲激响应。本练习将挑战您从简单的数值计算转向为 I 型线性相位滤波器完整地分析推导其冲激响应 $h[n]$。通过推导其闭式表达式，您将揭示矩形频率规格与最终得到的类 sinc 函数冲激响应之间的基本联系，这一经典关系深刻揭示了用此方法设计的滤波器的底层数学结构。[@problem_id:2871626]", "problem": "一个长度为 $L$ 的有限脉冲响应 (FIR) 滤波器（其中 $L=21$）将采用频率采样法设计，使其具有 I 型线性相位（奇数长度，偶对称）。设群延迟为 $\\tau = \\frac{L-1}{2} = 10$。为在频率采样设计中强制实现线性相位，我们在 $N$ 点频率网格上定义实偶幅度采样 $A[k]$（其中 $N=L=21$）。对于频率索引 $k$ 满足 $|k|\\le 3$ 模 $N$ (即，映射到 $\\{0,1,\\dots,20\\}$ 中的 $k\\in\\{0,\\pm 1,\\pm 2,\\pm 3\\}$)，$A[k]=1$，否则 $A[k]=0$。随后，通过引入线性相位因子 $H[k] = A[k]\\exp(-j 2\\pi k \\tau/N)$ 来构建复频率采样。\n\n仅从 $N$ 点网格上的离散时间傅里叶变换对的定义以及线性相位分解 $H(\\mathrm{e}^{j\\omega})=\\mathrm{e}^{-j\\omega \\tau}A(\\mathrm{e}^{j\\omega})$（其中 $A(\\mathrm{e}^{j\\omega})$ 是实偶函数）出发，通过对相关的复指数有限和进行解析求和，推导在 $0\\le n \\le 20$ 范围内的脉冲响应 $h[n]$ 的精确闭式表达式。所有角度均以弧度为单位。请将最终结果表示为对所有整数 $n$ 均有效（在可去奇点处采用自然的连续延拓）的单一简化解析公式。请勿对答案进行四舍五入。", "solution": "问题陈述经评估有效。其科学依据充分、提法恰当、内容客观，是数字信号处理领域一个标准问题，没有矛盾或信息缺失。我们开始推导解答。\n\n有限脉冲响应 (FIR) 滤波器的脉冲响应 $h[n]$ 通过计算其频率采样 $H[k]$ 的 $N$ 点离散傅里叶逆变换 (IDFT) 得到。IDFT 的定义是：\n$$\nh[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} H[k] \\exp\\left(j \\frac{2\\pi k n}{N}\\right), \\quad n \\in \\{0, 1, \\dots, N-1\\}\n$$\n问题给出了以下参数：滤波器长度 $L=21$，相应的频率采样点数 $N=L=21$，以及群延迟 $\\tau = \\frac{L-1}{2}=10$。复频率采样 $H[k]$ 定义为 $H[k] = A[k]\\exp\\left(-j \\frac{2\\pi k \\tau}{N}\\right)$，其中幅度采样 $A[k]$ 已被指定。\n\n将 $H[k]$ 的表达式代入 IDFT 公式，我们得到：\n$$\nh[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} A[k] \\exp\\left(-j \\frac{2\\pi k \\tau}{N}\\right) \\exp\\left(j \\frac{2\\pi k n}{N}\\right)\n$$\n合并指数项得到：\n$$\nh[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} A[k] \\exp\\left(j \\frac{2\\pi k (n-\\tau)}{N}\\right)\n$$\n给定 $N=21$ 和 $\\tau=10$。幅度采样 $A[k]$ 仅在一组特定的索引上非零。具体来说，当 $|k| \\le 3$ 模 $N$ 时，$A[k]=1$。对于索引范围 $k \\in \\{0, 1, \\dots, 20\\}$，这对应于 $k \\in \\{0, 1, 2, 3\\}$ 和 $k \\in \\{21-3, 21-2, 21-1\\}$，即 $k \\in \\{18, 19, 20\\}$。对于此范围内的所有其他 $k$ 值，$A[k]=0$。\n\n因此，求和简化为仅这 7 项：\n$$\nh[n] = \\frac{1}{21} \\sum_{k \\in \\{0,1,2,3,18,19,20\\}} \\exp\\left(j \\frac{2\\pi k (n-10)}{21}\\right)\n$$\n这个和可以拆分并重新排列为：\n$$\nh[n] = \\frac{1}{21} \\left[ \\sum_{k=0}^{3} \\exp\\left(j \\frac{2\\pi k (n-10)}{21}\\right) + \\sum_{k=18}^{20} \\exp\\left(j \\frac{2\\pi k (n-10)}{21}\\right) \\right]\n$$\n为简化计算，我们可以对第二个和进行重新索引。令 $k' = k - 21$。当 $k \\in \\{18, 19, 20\\}$ 时，$k'$ 的取值为 $\\{-3, -2, -1\\}$。指数项变为：\n$$\n\\exp\\left(j \\frac{2\\pi (k'+21) (n-10)}{21}\\right) = \\exp\\left(j \\frac{2\\pi k' (n-10)}{21}\\right) \\exp\\left(j 2\\pi (n-10)\\right)\n$$\n由于 $n$ 是整数，$n-10$ 也是整数，因此 $\\exp\\left(j 2\\pi (n-10)\\right) = 1$。所以，第二个和等价于一个对负索引的求和：\n$$\n\\sum_{k=18}^{20} \\exp\\left(j \\frac{2\\pi k (n-10)}{21}\\right) = \\sum_{k'=-3}^{-1} \\exp\\left(j \\frac{2\\pi k' (n-10)}{21}\\right)\n$$\n将重新索引后的和与从 $k=0$ 到 $k=3$ 的和合并，得到一个单一的对称和：\n$$\nh[n] = \\frac{1}{21} \\sum_{k=-3}^{3} \\exp\\left(j \\frac{2\\pi k (n-10)}{21}\\right)\n$$\n这是一个等比级数的有限和。令 $\\theta_n = \\frac{2\\pi (n-10)}{21}$。该和为 $\\sum_{k=-3}^{3} (\\exp(j\\theta_n))^k$。这个和有一个著名的闭式表达式，与狄利克雷核相关，$D_M(x) = \\sum_{k=-M}^{M} e^{ikx} = \\frac{\\sin((M+1/2)x)}{\\sin(x/2)}$。\n\n应用此恒等式，设 $M=3$ 且 $x = \\theta_n$，我们得到：\n$$\n\\sum_{k=-3}^{3} \\exp(j k \\theta_n) = \\frac{\\sin\\left(\\left(3+\\frac{1}{2}\\right)\\theta_n\\right)}{\\sin\\left(\\frac{1}{2}\\theta_n\\right)} = \\frac{\\sin(3.5 \\, \\theta_n)}{\\sin(0.5 \\, \\theta_n)}\n$$\n将此结果代回到 $h[n]$ 的表达式中，并用其定义替换 $\\theta_n$：\n$$\nh[n] = \\frac{1}{21} \\frac{\\sin\\left(3.5 \\cdot \\frac{2\\pi (n-10)}{21}\\right)}{\\sin\\left(0.5 \\cdot \\frac{2\\pi (n-10)}{21}\\right)}\n$$\n简化正弦函数的自变量：\n$$\nh[n] = \\frac{1}{21} \\frac{\\sin\\left(\\frac{7\\pi (n-10)}{21}\\right)}{\\sin\\left(\\frac{\\pi (n-10)}{21}\\right)} = \\frac{1}{21} \\frac{\\sin\\left(\\frac{\\pi (n-10)}{3}\\right)}{\\sin\\left(\\frac{\\pi (n-10)}{21}\\right)}\n$$\n该表达式对所有整数 $n$ 都有效。一个特殊情况是当分母为零时，这发生在 $\\frac{\\pi (n-10)}{21}$ 是 $\\pi$ 的整数倍时。对于 $n \\in \\{0, 1, \\dots, 20\\}$，这只在 $n=10$ 时发生。此时，表达式变为 $0/0$ 的不定式。$h[10]$ 的值可以通过求 $n \\to 10$ 时的极限（这对应于对此函数的连续延拓应用洛必达法则）来找到，或者通过直接计算 $n=10$ 时的和来求得：\n$$\nh[10] = \\frac{1}{21} \\sum_{k=-3}^{3} \\exp(0) = \\frac{1}{21} \\sum_{k=-3}^{3} 1 = \\frac{7}{21} = \\frac{1}{3}\n$$\n这证实了在 $n=10$ 处的奇点是可去的。推导出的闭式表达式，在这一点上通过其连续延拓来解释，提供了所要求的 $h[n]$ 的单一解析公式。", "answer": "$$\n\\boxed{\\frac{1}{21} \\frac{\\sin\\left(\\frac{\\pi(n-10)}{3}\\right)}{\\sin\\left(\\frac{\\pi(n-10)}{21}\\right)}}\n$$", "id": "2871626"}, {"introduction": "虽然解析推导能提供深刻的洞察，但实际的滤波器设计通常是计算性的，其中精确实现理论约束至关重要。本实践侧重于任何实际滤波器的一个基本要求：一个实数值的冲激响应 $h[n]$。您将通过强制执行至关重要的共轭对称属性来构建完整的 DFT 谱 $H[k]$，同时特别注意处理直流和奈奎斯特频率下的自共轭点，以确保最终的时域信号不含虚数部分。[@problem_id:2871608]", "problem": "您需要通过频率采样法设计一个长度为 $N$ 的有限脉冲响应滤波器，并强制满足实值脉冲响应所需的条件。使用以下基础作为您推导和实现的起点：离散时间傅里叶变换 (DTFT)、离散傅里叶变换 (DFT) 和逆离散傅里叶变换 (IDFT) 的定义，以及 DFT 域中实值序列的共轭对称特性。角度单位为弧度。\n\n考虑一个长度为 $N$ 的偶数长度序列 $h[n]$，其 $N$ 点 DFT 为 $H[k]$，其中 $k \\in \\{0,1,\\dots,N-1\\}$，以及标准的 DFT/IDFT 对\n$$\nH[k] = \\sum_{n=0}^{N-1} h[n] e^{-j 2\\pi kn/N}, \\quad\nh[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} H[k] e^{j 2\\pi kn/N}.\n$$\n给定在等间隔角频率 $\\omega_k = 2\\pi k/N$ 处的幅度采样 $\\lvert H_d(e^{j \\omega_k})\\rvert$。目标相位是线性的，群延迟为 $\\tau$ 个采样点，模型为 $e^{-j \\omega_k \\tau}$。您必须构建一个复数序列 $H[k]$，使其同时满足：\n- 强制施加 $h[n] \\in \\mathbb{R}$ 所需的共轭对称约束，即 $H[k] = H^*[(N-k) \\bmod N]$。\n- 当 $N$ 为偶数时，强制使自共轭 DFT 频率点为实值，即 $H[0] \\in \\mathbb{R}$ 且 $H[N/2] \\in \\mathbb{R}$。\n\n构建好这样的 $H[k]$ 后，通过 $N$ 点 IDFT 计算长度为 $N$ 的实值脉冲响应 $h[n]$。所有计算都必须以弧度为单位进行，最终的脉冲响应采样必须报告为实数。\n\n使用 $N=16$ 和 $\\tau=7.5$。对于频率采样构建，使用以下规则：对于非自共轭频率点 $k \\in \\{1,2,\\dots,(N/2-1)\\}$，将给定的幅度与线性相位结合得到\n$$\nH[k] = \\lvert H_d(e^{j \\omega_k})\\rvert \\, e^{-j \\omega_k \\tau}.\n$$\n对于自共轭频率点，通过设置以下方式直接强制其为实值\n$$\nH[0] = \\lvert H_d(e^{j \\omega_0})\\rvert, \\quad\nH[N/2] = \\lvert H_d(e^{j \\omega_{N/2}})\\rvert \\, \\cos(\\pi \\tau),\n$$\n然后施加共轭对称以填充剩余的上半部分频谱：\n$$\nH[N-k] = H^*[k], \\quad \\text{for } k \\in \\{1,2,\\dots,(N/2-1)\\}.\n$$\n最后，通过 IDFT 计算 $h[n]$。您的答案必须表示为实值采样列表，并按下面指定的方式进行舍入。\n\n测试套件。对于 $N=16$ 和 $\\tau=7.5$，评估三种情况。在每种情况下，给定九个非负实数，它们定义了 $k \\in \\{0,1,\\dots,8\\}$ 时的幅度采样 $\\lvert H_d(e^{j \\omega_k})\\rvert$，即包括直流分量点 $k=0$ 和奈奎斯特 (Nyquist) 频率点 $k=8$ 的下半频谱。使用上述构建方法来建立完整的 $H[k]$（其中 $k \\in \\{0,1,\\dots,15\\}$），然后计算 $h[n]$。\n\n- 情况 A (类低通): $\\big[1.0,\\,1.0,\\,1.0,\\,1.0,\\,1.0,\\,1.0,\\,0.0,\\,0.0,\\,0.0\\big]$。\n- 情况 B (混合剖面): $\\big[0.0,\\,0.2,\\,0.8,\\,1.0,\\,0.8,\\,0.2,\\,0.0,\\,0.4,\\,0.6\\big]$。\n- 情况 C (在 $[0,\\pi]$ 上的升余弦): 对于 $k \\in \\{0,1,\\dots,8\\}$,\n$$\n\\lvert H_d(e^{j \\omega_k})\\rvert = \\tfrac{1}{2}\\big(1 + \\cos(\\pi k/8)\\big),\n$$\n其数值等于\n$$\n\\big[1.0000000000,\\,0.9619397663,\\,0.8535533906,\\,0.6913417162,\\,0.5000000000,\\,0.3086582838,\\,0.1464466094,\\,0.0380602337,\\,0.0000000000\\big].\n$$\n\n输出规格。对于每种情况，输出时域脉冲响应列表 $[h[0],h[1],\\dots,h[15]]$，其中每个条目都四舍五入到 $6$ 位小数。您的程序应生成单行输出，其中包含三个列表，形式为用方括号括起来的逗号分隔列表，例如 $[[\\dots],[\\dots],[\\dots]]$。\n\n您的程序不得接受任何输入，并且必须严格按照上述定义和规则执行。", "solution": "该问题要求使用频率采样法设计一个长度为 $N=16$ 的实值、线性相位有限脉冲响应 (FIR) 滤波器。设计过程首先在离散频率 $\\omega_k = 2\\pi k/N$ 上指定滤波器的 $N$ 点离散傅里叶变换 (DFT) $H[k]$，然后通过逆离散傅里叶变换 (IDFT) 获得脉冲响应 $h[n]$。\n\n确保脉冲响应 $h[n]$ 为实值的基本原理是其 DFT $H[k]$ 必须表现出共轭对称性。该特性表示为：\n$$\nH[k] = H^*[(N-k) \\pmod N] \\quad \\text{for } k = 0, 1, \\dots, N-1\n$$\n其中星号 ($*$) 表示复共轭。\n\n问题指定了一个目标线性相位响应，其对应的群延迟为 $\\tau=7.5$ 个采样点。对于长度为 $N=16$ 的滤波器，此群延迟等于 $(N-1)/2 = (16-1)/2 = 7.5$。具有此群延迟的脉冲响应是对称的，$h[n] = h[N-1-n]$。一个具有偶数长度 $N$ 和对称脉冲响应的滤波器被归类为 II 型线性相位 FIR 滤波器。任何 II 型滤波器的一个关键特性是其频率响应在奈奎斯特 (Nyquist) 频率 $\\omega = \\pi$ 处必须为零。在 $N$ 点 DFT 的背景下，这对应于频率点 $k=N/2$。因此，我们必须有 $H[N/2] = 0$。\n\n我们被给予了 $k=0, 1, \\dots, N/2$ 时的幅度采样 $\\lvert H_d(e^{j \\omega_k})\\rvert$。构建完整的 $N$ 点 DFT 序列 $H[k]$（其中 $k=0, 1, \\dots, 15$）的过程是通过强制执行上述约束来进行的。\n\n1.  **自共轭频率点（$k=0$ 和 $k=N/2$）：**\n    共轭对称条件意味着 $k=0$（直流频率）和 $k=N/2$（对于偶数 $N$ 的奈奎斯特频率）处的频率点必须是实值的，因为 $H[0] = H^*[0]$ 且 $H[N/2] = H^*[N-N/2]=H^*[N/2]$。\n    -   对于直流分量点 $k=0$，问题规定了 $H[0] = \\lvert H_d(e^{j \\omega_0})\\rvert$。由于幅度是实数，这正确地将 $H[0]$ 设置为了一个实值。\n    -   对于奈奎斯特频率点 $k=N/2=8$，问题给出了规则 $H[8] = \\lvert H_d(e^{j \\omega_8})\\rvert \\, \\cos(\\pi \\tau)$。对于指定的群延迟 $\\tau = 7.5$，我们计算余弦项：$\\cos(\\pi \\times 7.5) = \\cos(7.5\\pi) = 0$。这强制使 $H[8]=0$，这精确地满足了 II 型线性相位滤波器的必要条件，而与该频率处的输入幅度无关。\n\n2.  **下半部分频率点（$k=1, 2, \\dots, N/2-1$）：**\n    对于频率点 $k \\in \\{1, 2, \\dots, 7\\}$，复数频率响应采样是通过将给定的幅度与目标线性相位相结合来合成的：\n    $$\n    H[k] = \\lvert H_d(e^{j \\omega_k})\\rvert \\, e^{-j \\omega_k \\tau}\n    $$\n    代入 $\\omega_k = 2\\pi k/N = \\pi k/8$ 和 $\\tau=7.5$，我们得到：\n    $$\n    H[k] = \\lvert H_d(e^{j \\pi k/8})\\rvert \\, e^{-j (\\pi k/8)(7.5)} = \\lvert H_d(e^{j \\pi k/8})\\rvert \\, e^{-j 7.5\\pi k/8}\n    $$\n\n3.  **上半部分频率点（$k=N/2+1, \\dots, N-1$）：**\n    为了满足共轭对称要求，剩余的频率采样（$k \\in \\{9, 10, \\dots, 15\\}$）由下半部分的频率点确定。对称关系 $H[k] = H^*[N-k]$ 应用于 $k=9, \\dots, 15$，这等价于设置：\n    $$\n    H[N-k] = H^*[k] \\quad \\text{for } k = 1, 2, \\dots, 7\n    $$\n    例如，$H[15] = H^*[1]$，$H[14]=H^*[2]$，依此类推。\n\n一旦根据这些规则构建了完整的 DFT 序列 $H[k]$（其中 $k = 0, 1, \\dots, 15$），最终的实值脉冲响应 $h[n]$ 就使用 $N$ 点逆离散傅里叶变换 (IDFT) 进行计算：\n$$\nh[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} H[k] e^{j 2\\pi kn/N} = \\frac{1}{16} \\sum_{k=0}^{15} H[k] e^{j \\pi kn/8}\n$$\n由于 $H[k]$ 是以完美的共轭对称性构建的，因此得到的序列 $h[n]$ 保证是实值的，并且由于 $\\tau$ 的选择，它也将是对称的，即 $h[n] = h[15-n]$。计算出的 $h[n]$ 中的任何残留虚部都是有限精度浮点运算的产物，应当被丢弃。该过程将应用于三个指定的测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Designs a real-valued FIR filter using the frequency-sampling method\n    for three test cases and prints the resulting impulse responses.\n    \"\"\"\n    \n    # Define problem parameters\n    N = 16\n    tau = 7.5\n\n    # Define the magnitude specifications for the three test cases.\n    # Magnitudes are for k = 0, 1, ..., N/2.\n    mag_a = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0]\n    mag_b = [0.0, 0.2, 0.8, 1.0, 0.8, 0.2, 0.0, 0.4, 0.6]\n    \n    # For Case C, calculate magnitudes from the given formula for precision.\n    k_vals_c = np.arange(N // 2 + 1)\n    mag_c = 0.5 * (1 + np.cos(np.pi * k_vals_c / 8))\n\n    test_cases = [\n        mag_a,\n        mag_b,\n        mag_c.tolist() # Convert numpy array to list for consistency\n    ]\n\n    results = []\n    for magnitudes in test_cases:\n        # Initialize the N-point DFT spectrum H[k] as a complex array.\n        H = np.zeros(N, dtype=np.complex128)\n        \n        # 1. Handle self-conjugate bins (k=0 and k=N/2)\n        # H[0] must be real.\n        H[0] = magnitudes[0]\n        \n        # H[N/2] must be real. The problem's formula correctly enforces the\n        # Type-II linear phase condition H[N/2]=0 since cos(pi*tau)=0 for tau=7.5.\n        H[N//2] = magnitudes[N//2] * np.cos(np.pi * tau)\n        \n        # 2. Handle lower-half frequency bins (1 <= k < N/2)\n        # 3. and simultaneously set upper-half bins by conjugate symmetry.\n        for k in range(1, N // 2):\n            omega_k = 2 * np.pi * k / N\n            phase = -omega_k * tau\n            \n            # Construct complex sample H[k]\n            H[k] = magnitudes[k] * np.exp(1j * phase)\n            \n            # Enforce conjugate symmetry for a real impulse response\n            H[N-k] = np.conj(H[k])\n            \n        # 4. Compute the impulse response h[n] via Inverse DFT.\n        # numpy.fft.ifft includes the 1/N scaling factor.\n        h = np.fft.ifft(H)\n        \n        # The result h should be real due to conjugate symmetry of H.\n        # We take the real part to discard negligible floating-point error.\n        h_real = np.real(h)\n        \n        # Round each sample to the specified number of decimal places.\n        h_rounded = np.round(h_real, 6)\n        \n        results.append(h_rounded.tolist())\n\n    # Format the final output as a string representing a list of lists.\n    # The str() on a list automatically creates the desired [item1, item2, ...] format.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    \n    # Python may add spaces after commas in lists, remove them for exact format consistency\n    output_str = output_str.replace(\" \", \"\")\n\n    print(output_str)\n\nsolve()\n```", "id": "2871608"}]}