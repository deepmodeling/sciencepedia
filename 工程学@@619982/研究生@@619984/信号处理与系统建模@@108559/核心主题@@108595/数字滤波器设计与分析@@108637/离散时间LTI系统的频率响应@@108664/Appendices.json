{"hands_on_practices": [{"introduction": "在分析一个系统的频率响应之前，我们必须首先知道如何推导出它。第一个动手实践将我们带回基本原理，要求我们直接从一个通用递归（IIR）系统的差分方程出发，推导其频率响应 $H(e^{j\\omega})$ [@problem_id:2873906]。这个练习加强了离散时间傅里叶变换性质的应用，并建立了系统极点与有界输入有界输出（BIBO）稳定性之间的关键联系。", "problem": "考虑一个由差分方程定义的离散时间、因果、线性时不变反馈互联系统：\n$$\ny[n] \\;=\\; x[n] \\;+\\; \\sum_{k=1}^{N} a_k\\, y[n-k],\n$$\n其中 $N$ 是一个正整数，系数 $a_k \\in \\mathbb{C}$ 是固定的，且系统初始状态为静止。设 $x[n]$ 和 $y[n]$ 是绝对可和的，因此它们的离散时间傅里叶变换 (DTFT) 在单位圆上以傅里叶级数的意义存在。令 $\\omega \\in \\mathbb{R}$ 表示以弧度为单位的离散时间频率。\n\n仅从离散时间傅里叶变换和一个线性时不变系统的频率响应的定义出发，完成以下任务：\n\n- 推导系统在单位圆上的频率响应 $H(\\exp(j\\omega))$。\n- 使用有界输入有界输出稳定性定义和从闭环分母推断出的极点位置，陈述系数 $\\{a_k\\}_{k=1}^{N}$ 必须满足的约束条件，以使频率响应对于每个 $\\omega \\in [-\\pi,\\pi]$ 都是有限的（即，闭环分母在单位圆上没有零点），并解释这与有界输入有界输出稳定性的关系。\n\n以 $H(\\exp(j\\omega))$ 的闭式解析表达式形式提供你的最终答案。不需要进行数值计算。角度 $\\omega$ 必须解释为弧度。", "solution": "对所提出的问题陈述进行验证。\n\n步骤 1：提取已知条件\n- 系统是离散时间、因果、线性时不变 (LTI) 反馈系统。\n- 定义该系统的差分方程为 $y[n] = x[n] + \\sum_{k=1}^{N} a_k y[n-k]$。\n- $N$ 是一个正整数。\n- 系数 $a_k \\in \\mathbb{C}$ 是固定常数。\n- 系统初始状态为静止。\n- 输入 $x[n]$ 和输出 $y[n]$ 是绝对可和的，这意味着它们的离散时间傅里叶变换 (DTFT) 存在。\n- $\\omega \\in \\mathbb{R}$ 是以弧度为单位的离散时间频率。\n- 第一个任务是推导频率响应 $H(\\exp(j\\omega))$。\n- 第二个任务是陈述系数 $\\{a_k\\}_{k=1}^{N}$ 需满足的约束条件，以使频率响应对所有 $\\omega \\in [-\\pi, \\pi]$ 都是有限的，并解释其与有界输入有界输出 (BIBO) 稳定性的关系。\n\n步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法恰当且客观。这是一个分析离散时间LTI系统的标准问题，是信号处理领域的核心课题。所提供的信息是自洽且一致的。要求从第一性原理（DTFT定义）出发并将结果与稳定性概念联系起来，是一项对基础理论的严谨练习。该问题不包含科学谬误、含糊之处或矛盾。这是一个有效且可解的问题。\n\n步骤 3：结论与行动\n问题有效。将提供完整的解答。\n\n分析从离散时间傅里叶变换 (DTFT) 的基本定义开始。对于一个绝对可和序列 $f[n]$，其 DTFT 由下式给出：\n$$\nF(\\exp(j\\omega)) = \\sum_{n=-\\infty}^{\\infty} f[n] \\exp(-j\\omega n)\n$$\n我们已知该 LTI 系统的差分方程为：\n$$\ny[n] = x[n] + \\sum_{k=1}^{N} a_k y[n-k]\n$$\n为了求得频率响应，我们对该方程两边应用 DTFT。设 $X(\\exp(j\\omega))$ 和 $Y(\\exp(j\\omega))$ 分别是输入 $x[n]$ 和输出 $y[n]$ 的 DTFT。根据 DTFT 的线性性质，我们可以对每一项单独进行变换。\n$$\n\\text{DTFT}\\{y[n]\\} = \\text{DTFT}\\{x[n]\\} + \\text{DTFT}\\left\\{\\sum_{k=1}^{N} a_k y[n-k]\\right\\}\n$$\n方程变为：\n$$\nY(\\exp(j\\omega)) = X(\\exp(j\\omega)) + \\sum_{k=1}^{N} a_k \\text{DTFT}\\{y[n-k]\\}\n$$\n我们必须使用 DTFT 的时移性质，该性质指出，如果 $\\text{DTFT}\\{f[n]\\} = F(\\exp(j\\omega))$，则 $\\text{DTFT}\\{f[n-n_0]\\} = \\exp(-j\\omega n_0) F(\\exp(j\\omega))$。将此性质应用于 $y[n-k]$ 项：\n$$\n\\text{DTFT}\\{y[n-k]\\} = \\exp(-j\\omega k) Y(\\exp(j\\omega))\n$$\n将此代入变换后的方程得到：\n$$\nY(\\exp(j\\omega)) = X(\\exp(j\\omega)) + \\sum_{k=1}^{N} a_k \\exp(-j\\omega k) Y(\\exp(j\\omega))\n$$\nLTI 系统的频率响应 $H(\\exp(j\\omega))$ 定义为输出的 DTFT与输入的 DTFT 之比，前提是输入不恒为零。\n$$\nH(\\exp(j\\omega)) = \\frac{Y(\\exp(j\\omega))}{X(\\exp(j\\omega))}\n$$\n为求得此比值，我们重排方程，将包含 $Y(\\exp(j\\omega))$ 的项归类到一起：\n$$\nY(\\exp(j\\omega)) - \\left(\\sum_{k=1}^{N} a_k \\exp(-j\\omega k)\\right) Y(\\exp(j\\omega)) = X(\\exp(j\\omega))\n$$\n提取公因式 $Y(\\exp(j\\omega))$:\n$$\nY(\\exp(j\\omega)) \\left(1 - \\sum_{k=1}^{N} a_k \\exp(-j\\omega k)\\right) = X(\\exp(j\\omega))\n$$\n求解比值 $H(\\exp(j\\omega))$ 即可得到频率响应：\n$$\nH(\\exp(j\\omega)) = \\frac{1}{1 - \\sum_{k=1}^{N} a_k \\exp(-j\\omega k)}\n$$\n这就完成了问题的第一部分。\n\n对于第二部分，我们分析稳定性的条件。频率响应 $H(\\exp(j\\omega))$ 对于所有 $\\omega \\in [-\\pi, \\pi]$ 的值都是有限的，当且仅当其分母在该区间内的任何 $\\omega$ 值下都不为零。即：\n$$\n1 - \\sum_{k=1}^{N} a_k \\exp(-j\\omega k) \\neq 0, \\quad \\forall \\omega \\in [-\\pi, \\pi]\n$$\n为了将此与极点位置联系起来，我们考虑系统的传递函数 $H(z)$，它是冲激响应 $h[n]$ 的 Z 变换。对差分方程进行 Z 变换（假设系统初始静止，即初始条件为零），我们得到：\n$$\nY(z) = X(z) + \\sum_{k=1}^{N} a_k z^{-k} Y(z)\n$$\n因此，传递函数 $H(z) = Y(z)/X(z)$ 为：\n$$\nH(z) = \\frac{1}{1 - \\sum_{k=1}^{N} a_k z^{-k}}\n$$\n系统的极点是 $H(z)$ 分母的根。令 $D(z) = 1 - \\sum_{k=1}^{N} a_k z^{-k}$。极点是使 $D(z)=0$ 的 $z$ 值。频率响应 $H(\\exp(j\\omega))$ 只是传递函数 $H(z)$ 在单位圆上（即 $z = \\exp(j\\omega)$）的取值。$H(\\exp(j\\omega))$ 对所有 $\\omega$ 都是有限的这一条件，等价于 $D(z)$ 在单位圆上没有根，即系统在单位圆 $|z|=1$ 上没有极点。\n\n现在，我们将其与有界输入有界输出 (BIBO) 稳定性联系起来。一个离散时间 LTI 系统被定义为 BIBO 稳定，当且仅当其冲激响应 $h[n]$ 是绝对可和的，即 $\\sum_{n=-\\infty}^{\\infty} |h[n]| < \\infty$。对于一个由有理传递函数 $H(z)$ 描述的因果 LTI 系统，此条件等价于要求 $H(z)$ 的所有极点都必须严格位于单位圆内部。这意味着对于每个极点 $p_i$，其模必须满足 $|p_i| < 1$。\n\n极点是特征多项式方程 $1 - \\sum_{k=1}^{N} a_k z^{-k} = 0$ 的根，或等价地，$z^N - \\sum_{k=1}^{N} a_k z^{N-k} = 0$ 的根。对于 BIBO 稳定性，对系数 $\\{a_k\\}$ 的约束是，该多项式的所有根的模都必须严格小于 1。\n\n关系如下：如果一个系统是 BIBO 稳定的，它的所有极点都严格位于单位圆内部。这直接意味着单位圆上没有极点。因此，频率响应的分母 $1 - \\sum_{k=1}^{N} a_k \\exp(-j\\omega k)$ 对所有 $\\omega$ 都将是非零的，从而 $H(\\exp(j\\omega))$ 对所有频率都是有限的。因此，BIBO 稳定性条件是频率响应在所有频率上都良定且有限的充分条件（对于因果系统，也是必要条件）。对 $\\{a_k\\}$ 的约束是，$z^N - \\sum_{k=1}^{N} a_k z^{N-k}=0$ 的所有根都必须位于单位圆内部。", "answer": "$$\n\\boxed{\\frac{1}{1 - \\sum_{k=1}^{N} a_k \\exp(-j\\omega k)}}\n$$", "id": "2873906"}, {"introduction": "系统频率响应的形状不仅仅是一个数学上的概念；它在实际应用中直接影响着信号的质量。这个练习探讨了多速率信号处理中的一个经典场景：使用非理想抗混叠滤波器进行抽取（downsampling） [@problem_id:2873901]。通过推导混叠误差和通带失真的界限，你将对滤波器指标（如阻带衰减 $\\delta_s$）如何直接影响整体系统性能建立起定量的理解。", "problem": "考虑一个离散时间、有限能量信号 $x[n]$，其离散时间傅里叶变换（DTFT）为 $X(e^{j\\omega})$。该信号由一个频率响应为 $H(e^{j\\omega})$ 的预滤波器进行处理，然后以整数因子 $M \\geq 2$ 进行降采样。该预滤波器用作抗混叠低通滤波器。设理想通带为 $\\mathcal{P} \\triangleq \\{\\,\\omega \\in [-\\pi,\\pi): |\\omega| \\leq \\pi/M\\,\\}$，其补集为阻带 $\\mathcal{S} \\triangleq \\{\\,\\omega \\in [-\\pi,\\pi): |\\omega| > \\pi/M\\,\\}$。对于给定的非负实数 $\\delta_p$ 和 $\\delta_s$，实际的预滤波器满足以下边界条件：\n- 通带偏差：对于所有 $\\omega \\in \\mathcal{P}$，有 $|H(e^{j\\omega}) - 1| \\leq \\delta_p$。\n- 阻带衰减：对于所有 $\\omega \\in \\mathcal{S}$，有 $|H(e^{j\\omega})| \\leq \\delta_s$。\n\n定义信号 $x[n]$ 在 $\\mathcal{P}$ 和 $\\mathcal{S}$ 中包含的能量为\n$$\nE_{\\mathcal{P}} \\triangleq \\frac{1}{2\\pi}\\int_{\\mathcal{P}} |X(e^{j\\omega})|^2 \\, d\\omega,\\qquad\nE_{\\mathcal{S}} \\triangleq \\frac{1}{2\\pi}\\int_{\\mathcal{S}} |X(e^{j\\omega})|^2 \\, d\\omega,\n$$\n因此，根据Parseval恒等式，总能量为 $\\|x\\|_{2}^{2} = E_{\\mathcal{P}} + E_{\\mathcal{S}}$。\n\n令 $y[m]$ 表示使用实际滤波器 $H(e^{j\\omega})$ 时的抽取输出，令 $y_{\\mathrm{ideal}}[m]$ 表示假如使用一个理想抗混叠滤波器 $H_{\\mathrm{ideal}}(e^{j\\omega})$ （其在 $\\mathcal{P}$ 上等于 $1$，在 $\\mathcal{S}$ 上等于 $0$）时的输出。定义总输出误差为 $e[m] \\triangleq y[m] - y_{\\mathrm{ideal}}[m]$。将 $e[m]$ 在概念上分解为两个部分：\n- 一个由 $\\mathcal{P}$ 上 $H(e^{j\\omega}) \\neq 1$ 引起的通带失真分量。\n- 一个由 $X(e^{j\\omega})$ 在 $\\mathcal{S}$ 上的分量泄漏通过 $H(e^{j\\omega})$ 并因降采样而折叠引起的混叠分量。\n\n任务：\n1) 仅从线性时不变（LTI）系统的卷积定义、DTFT、Parseval恒等式以及降采样的定义出发，推导抽取器输出端混叠误差能量 $\\|e_{\\mathrm{alias}}\\|_{2}^{2}$ 的一个严格上界，该上界仅依赖于 $\\delta_s$ 和 $E_{\\mathcal{S}}$（且与 $M$ 无关）。你的界必须表示为关于 $\\delta_s$ 和 $E_{\\mathcal{S}}$ 的单一闭式解析表达式。\n2) 使用相同的基本原理，定义一个输出端通带失真的定量均方根度量，并用 $\\delta_p$ 和 $E_{\\mathcal{P}}$ 表示其上界。你无需计算此界的数值。\n3) 对 $\\delta_s = 10^{-4}$ 和 $E_{\\mathcal{S}} = 0.05$ 的情况，数值计算任务1中得到的界。将最终数值答案四舍五入至四位有效数字。将最终结果表示为一个纯数（无单位），并且只给出任务1所要求的值。", "solution": "问题陈述已经过验证，被认为是科学上可靠、适定且客观的。这是多速率数字信号处理系统分析中的一个标准问题。可以基于基本原理推导出一个严格的解。\n\n输出端的总误差定义为 $e[m] \\triangleq y[m] - y_{\\mathrm{ideal}}[m]$。为将此误差分解为通带失真和混叠分量，我们首先将输入信号 $x[n]$ 分解为其通带部分和阻带部分。令 $x_{\\mathcal{P}}[n]$ 为信号分量，其离散时间傅里叶变换（DTFT） $X_{\\mathcal{P}}(e^{j\\omega})$ 在 $\\omega \\in \\mathcal{P}$ 时等于 $X(e^{j\\omega})$，在其他情况下为零。类似地，令 $x_{\\mathcal{S}}[n]$ 为分量，其DTFT $X_{\\mathcal{S}}(e^{j\\omega})$ 在 $\\omega \\in \\mathcal{S}$ 时等于 $X(e^{j\\omega})$，在其他情况下为零。根据构造，有 $x[n] = x_{\\mathcal{P}}[n] + x_{\\mathcal{S}}[n]$。\n\n预滤波后的信号为 $v[n] = (x * h)[n]$，其中 $h[n]$ 是实际滤波器 $H(e^{j\\omega})$ 的脉冲响应。根据卷积的线性性质，$v[n] = (x_{\\mathcal{P}} * h)[n] + (x_{\\mathcal{S}} * h)[n]$。令 $v_{\\mathcal{P}}[n] \\triangleq (x_{\\mathcal{P}} * h)[n]$ 和 $v_{\\mathcal{S}}[n] \\triangleq (x_{\\mathcal{S}} * h)[n]$。实际输出为 $y[m] = v[Mm] = v_{\\mathcal{P}}[Mm] + v_{\\mathcal{S}}[Mm]$。\n\n理想滤波器 $H_{\\mathrm{ideal}}(e^{j\\omega})$ 无失真地通过通带分量 $x_{\\mathcal{P}}[n]$，并完全抑制阻带分量 $x_{\\mathcal{S}}[n]$。因此其输出为 $v_{\\mathrm{ideal}}[n] = x_{\\mathcal{P}}[n]$。理想的抽取输出为 $y_{\\mathrm{ideal}}[m] = v_{\\mathrm{ideal}}[Mm] = x_{\\mathcal{P}}[Mm]$。\n\n总误差 $e[m]$ 现在可以写成：\n$$ e[m] = (v_{\\mathcal{P}}[Mm] + v_{\\mathcal{S}}[Mm]) - x_{\\mathcal{P}}[Mm] = (v_{\\mathcal{P}}[Mm] - x_{\\mathcal{P}}[Mm]) + v_{\\mathcal{S}}[Mm] $$\n这提供了一个自然的分解。第一项，$e_{\\mathrm{dist}}[m] \\triangleq v_{\\mathcal{P}}[Mm] - x_{\\mathcal{P}}[Mm]$，代表通带信号分量的失真。第二项，$e_{\\mathrm{alias}}[m] \\triangleq v_{\\mathcal{S}}[Mm]$，代表混叠的阻带信号分量。该分量源于 $X(e^{j\\omega})$ 的阻带泄漏通过实际滤波器，然后因降采样而折叠到基带中。\n\n**任务1：混叠误差能量的界**\n\n混叠误差分量为 $e_{\\mathrm{alias}}[m] = v_{\\mathcal{S}}[Mm]$。我们寻求其能量的上界，$\\|e_{\\mathrm{alias}}\\|_{2}^{2} = \\sum_{m=-\\infty}^{\\infty} |e_{\\mathrm{alias}}[m]|^2$。\n代入 $e_{\\mathrm{alias}}[m]$ 的定义，我们得到：\n$$ \\|e_{\\mathrm{alias}}\\|_{2}^{2} = \\sum_{m=-\\infty}^{\\infty} |v_{\\mathcal{S}}[Mm]|^2 $$\n抽取后序列的平方和是原始序列平方和的一个子集。因此，抽取后信号的能量不会超过抽取前原始信号的能量。\n$$ \\sum_{m=-\\infty}^{\\infty} |v_{\\mathcal{S}}[Mm]|^2 \\leq \\sum_{n=-\\infty}^{\\infty} |v_{\\mathcal{S}}[n]|^2 = \\|v_{\\mathcal{S}}\\|_{2}^{2} $$\n信号 $v_{\\mathcal{S}}[n]$ 的能量可以使用Parseval恒等式在频域中计算：\n$$ \\|v_{\\mathcal{S}}\\|_{2}^{2} = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} |V_{\\mathcal{S}}(e^{j\\omega})|^2 \\,d\\omega $$\n其中 $V_{\\mathcal{S}}(e^{j\\omega})$ 是 $v_{\\mathcal{S}}[n]$ 的DTFT。根据定义，$V_{\\mathcal{S}}(e^{j\\omega}) = H(e^{j\\omega})X_{\\mathcal{S}}(e^{j\\omega})$。$X_{\\mathcal{S}}(e^{j\\omega})$ 的支撑集是阻带 $\\mathcal{S}$。因此，该积分仅在 $\\mathcal{S}$ 上非零。\n$$ \\|v_{\\mathcal{S}}\\|_{2}^{2} = \\frac{1}{2\\pi} \\int_{\\mathcal{S}} |H(e^{j\\omega})X(e^{j\\omega})|^2 \\,d\\omega $$\n在阻带 $\\mathcal{S}$ 内，实际滤波器的频率响应受限于 $|H(e^{j\\omega})| \\leq \\delta_s$。我们可以用此条件来建立 $\\|v_{\\mathcal{S}}\\|_{2}^{2}$ 的一个上界：\n$$ \\|v_{\\mathcal{S}}\\|_{2}^{2} \\leq \\frac{1}{2\\pi} \\int_{\\mathcal{S}} (\\delta_s |X(e^{j\\omega})|)^2 \\,d\\omega = \\delta_s^2 \\left( \\frac{1}{2\\pi} \\int_{\\mathcal{S}} |X(e^{j\\omega})|^2 \\,d\\omega \\right) $$\n使用给定的定义 $E_{\\mathcal{S}} \\triangleq \\frac{1}{2\\pi}\\int_{\\mathcal{S}} |X(e^{j\\omega})|^2 \\, d\\omega$，我们得到：\n$$ \\|v_{\\mathcal{S}}\\|_{2}^{2} \\leq \\delta_s^2 E_{\\mathcal{S}} $$\n结合这些不等式，我们得出混叠误差能量的上界：\n$$ \\|e_{\\mathrm{alias}}\\|_{2}^{2} \\leq \\delta_s^2 E_{\\mathcal{S}} $$\n这个上界仅依赖于 $\\delta_s$ 和 $E_{\\mathcal{S}}$，且与 $M$ 无关，符合要求。\n\n**任务2：通带失真的界**\n\n通带失真分量为 $e_{\\mathrm{dist}}[m] = v_{\\mathcal{P}}[Mm] - x_{\\mathcal{P}}[Mm]$。令 $\\epsilon_{\\mathcal{P}}[n] \\triangleq v_{\\mathcal{P}}[n] - x_{\\mathcal{P}}[n]$，则 $e_{\\mathrm{dist}}[m] = \\epsilon_{\\mathcal{P}}[Mm]$。$\\epsilon_{\\mathcal{P}}[n]$ 的DTFT为 $\\Epsilon_{\\mathcal{P}}(e^{j\\omega}) = V_{\\mathcal{P}}(e^{j\\omega}) - X_{\\mathcal{P}}(e^{j\\omega}) = (H(e^{j\\omega}) - 1)X_{\\mathcal{P}}(e^{j\\omega})$，它仅在通带 $\\mathcal{P} = [-\\pi/M, \\pi/M]$ 内非零。\n总通带失真的一个定量度量是其能量 $\\|e_{\\mathrm{dist}}\\|_{2}^{2}$。一个均方根（RMS）度量则为 $\\sqrt{\\|e_{\\mathrm{dist}}\\|_{2}^{2}}$。\n由于 $\\epsilon_{\\mathcal{P}}[n]$ 是带限于 $[-\\pi/M, \\pi/M]$ 的，其抽取版本的能量与原始信号的能量通过一个因子 $1/M$ 相关联：\n$$ \\|e_{\\mathrm{dist}}\\|_{2}^{2} = \\sum_{m=-\\infty}^{\\infty} |\\epsilon_{\\mathcal{P}}[Mm]|^2 = \\frac{1}{M} \\sum_{n=-\\infty}^{\\infty} |\\epsilon_{\\mathcal{P}}[n]|^2 = \\frac{1}{M} \\|\\epsilon_{\\mathcal{P}}\\|_{2}^{2} $$\n能量 $\\|\\epsilon_{\\mathcal{P}}\\|_{2}^{2}$ 可以使用Parseval恒等式和通带内的滤波器规格来界定：\n$$ \\|\\epsilon_{\\mathcal{P}}\\|_{2}^{2} = \\frac{1}{2\\pi} \\int_{\\mathcal{P}} |(H(e^{j\\omega}) - 1)X(e^{j\\omega})|^2 \\,d\\omega $$\n给定在 $\\omega \\in \\mathcal{P}$ 时 $|H(e^{j\\omega}) - 1| \\leq \\delta_p$：\n$$ \\|\\epsilon_{\\mathcal{P}}\\|_{2}^{2} \\leq \\frac{1}{2\\pi} \\int_{\\mathcal{P}} (\\delta_p |X(e^{j\\omega})|)^2 \\,d\\omega = \\delta_p^2 \\left(\\frac{1}{2\\pi} \\int_{\\mathcal{P}} |X(e^{j\\omega})|^2 \\,d\\omega\\right) = \\delta_p^2 E_{\\mathcal{P}} $$\n因此，通带失真分量的能量受限于：\n$$ \\|e_{\\mathrm{dist}}\\|_{2}^{2} \\leq \\frac{1}{M} \\delta_p^2 E_{\\mathcal{P}} $$\n相应的RMS度量受限于 $\\sqrt{\\|e_{\\mathrm{dist}}\\|_{2}^{2}} \\leq \\sqrt{\\frac{\\delta_p^2 E_{\\mathcal{P}}}{M}} = \\frac{\\delta_p}{\\sqrt{M}}\\sqrt{E_{\\mathcal{P}}}$。\n\n**任务3：混叠误差界的数值计算**\n\n在任务1中推导出的界为 $\\|e_{\\mathrm{alias}}\\|_{2}^{2} \\leq \\delta_s^2 E_{\\mathcal{S}}$。\n我们给定的值为 $\\delta_s = 10^{-4}$ 和 $E_{\\mathcal{S}} = 0.05$。\n将这些值代入界的表达式：\n$$ \\text{Bound} = (10^{-4})^2 \\times 0.05 = 10^{-8} \\times 5 \\times 10^{-2} = 5 \\times 10^{-10} $$\n四舍五入到四位有效数字，结果是 $5.000 \\times 10^{-10}$。", "answer": "$$\\boxed{5.000 \\times 10^{-10}}$$", "id": "2873901"}, {"introduction": "设计具有急剧、选择性频率响应的滤波器，通常需要在单位圆附近进行精巧的极零点布局。这最后一个练习将深入探讨该策略的实际后果，重点关注一个具有近似极零点对消的系统 [@problem_id:2873912]。通过这项分析，你将研究这种配置如何形成尖锐的频谱特征，并且更关键的是，它如何放大系数的微小误差（如量化误差）对响应的影响，这是实现稳健数字滤波器时必须面对的核心问题。", "problem": "考虑一个因果、有理、离散时间、线性时不变系统，其传递函数为\n$$\nH_{\\varepsilon}(z) \\;=\\; G(z)\\,\\frac{1 - 2\\,\\rho \\cos(\\omega_0)\\,z^{-1} + \\rho^{2}\\,z^{-2}}{1 - 2\\,r \\cos(\\omega_0)\\,z^{-1} + r^{2}\\,z^{-2}},\n$$\n其中 $G(z)$ 包含了系统的所有其余因子，并且是稳定、最小相位的，且其极点或零点的相角均不在 $\\omega_0$ 的一个小邻域内。参数满足 $0<r<1$，$0<\\rho<1$，$\\omega_0\\in(0,\\pi)$，以及 $\\rho = r - \\varepsilon$ 且 $|\\varepsilon|\\le \\tfrac{1}{2}(1-r)$。假设其余因子 $G(z)$ 使得相应的幅度响应因子 $|G(e^{j\\omega})|$ 有界且远离0，并且在 $\\omega_0$ 附近随 $\\omega$ 缓慢变化。\n\n要求您从基本原理出发，论述频率响应 $H_{\\varepsilon}(e^{j\\omega})$ 以及小幅度的系数量化对相角 $\\omega_0$ 处的近似抵消效应的影响。系数量化被建模为对二阶分子和分母部分的每个实系数施加一个绝对值最多为 $q/2$ 的扰动（对于某个小步长 $q>0$）；这会在 $r$、$\\rho$ 和 $\\omega_0$ 中引入微小的扰动。\n\n选择以下所有正确的陈述。\n\nA. 对于 $\\varepsilon>0$（即 $\\rho<r$），在 $\\omega_0$ 附近的幅度响应呈现一个局部峰值。在除去一个由 $G(e^{j\\omega})$ 和相角为 $-\\omega_0$ 的因子贡献的慢变乘法因子后，其在 $\\omega=\\omega_0$ 处的值满足\n$$\n|H_{\\varepsilon}(e^{j\\omega_0})| \\;\\approx\\; \\frac{|1-\\rho|}{|1-r|} \\;=\\; 1 + \\frac{\\varepsilon}{1-r},\n$$\n且该峰值的特征带宽与 $(1-r)$ 同阶。\n\nB. 对于 $\\varepsilon<0$（即 $\\rho>r$ 但在给定边界下仍有 $\\rho<1$），在 $\\omega_0$ 附近的幅度响应呈现一个局部凹口。在除去一个如同选项A中的慢变乘法因子后，其在 $\\omega=\\omega_0$ 处的值满足\n$$\n|H_{\\varepsilon}(e^{j\\omega_0})| \\;\\approx\\; \\frac{|1-\\rho|}{|1-r|} \\;=\\; 1 + \\frac{\\varepsilon}{1-r} \\;<\\; 1,\n$$\n且该凹口的特征带宽与 $(1-r)$ 同阶。\n\nC. 在精确抵消的情况 $\\varepsilon=0$ 下，$\\omega_0$ 处的峰值或凹口被消除，并且在小幅度的系数量化下仍然不存在，前提是量化后的系数保持为实数且系统保持因果性。\n\nD. 固定任何满足 $|\\varepsilon|\\le \\tfrac{1}{2}(1-r)$ 的非零 $\\varepsilon$。当 $r\\to 1^{-}$ 时，$|H_{\\varepsilon}(e^{j\\omega_0})|$ 对小绝对值的系数扰动的灵敏度无界增长，其有效条件数与 $1/(1-r)$ 同阶。\n\nE. 即使对于与 $\\omega_0$ 相隔一个固定裕量的频率 $\\omega$，当 $r\\to 1^{-}$ 时，近似抵消也会导致 $|H_{\\varepsilon}(e^{j\\omega})|$ 中系数量化误差的任意大放大。\n\n选择所有适用项。", "solution": "该问题陈述经分析是有效的，因为它代表了离散时间系统分析中的一个标准的、适定(well-posed)的问题，特别是关于具有靠近单位圆的极点和零点的数字滤波器的灵敏度问题。\n\n给定的传递函数为\n$$\nH_{\\varepsilon}(z) \\;=\\; G(z)\\,\\frac{1 - 2\\,\\rho \\cos(\\omega_0)\\,z^{-1} + \\rho^{2}\\,z^{-2}}{1 - 2\\,r \\cos(\\omega_0)\\,z^{-1} + r^{2}\\,z^{-2}}.\n$$\n二阶部分的分子和分母可以根据其根进行因式分解。分子多项式 $z^2 - 2\\rho \\cos(\\omega_0) z + \\rho^2$ 的根是 $z = \\rho e^{\\pm j\\omega_0}$。分母多项式 $z^2 - 2r \\cos(\\omega_0) z + r^2$ 的根是 $z = r e^{\\pm j\\omega_0}$。\n因此，该二阶部分可以用其极点和零点表示：\n$$\nH_p(z) = \\frac{(1 - \\rho e^{j\\omega_0}z^{-1})(1 - \\rho e^{-j\\omega_0}z^{-1})}{(1 - r e^{j\\omega_0}z^{-1})(1 - r e^{-j\\omega_0}z^{-1})}.\n$$\n系统在 $z = \\rho e^{\\pm j\\omega_0}$ 处有零点，在 $z = r e^{\\pm j\\omega_0}$ 处有极点。参数满足 $0<r<1$ 和 $0<\\rho<1$，因此系统是稳定和最小相位的。问题陈述 $\\rho = r-\\varepsilon$。\n\n频率响应通过将 $H_\\varepsilon(z)$ 在 $z = e^{j\\omega}$ 处求值得到：\n$$\nH_{\\varepsilon}(e^{j\\omega}) = G(e^{j\\omega}) \\frac{(1 - \\rho e^{j(\\omega_0-\\omega)})(1 - \\rho e^{-j(\\omega_0+\\omega)})}{(1 - r e^{j(\\omega_0-\\omega)})(1 - r e^{-j(\\omega_0+\\omega)})}.\n$$\n我们关心系统在 $\\omega$ 接近 $\\omega_0$ 时的行为。令 $\\Delta\\omega = \\omega - \\omega_0$。\n对于 $\\omega \\approx \\omega_0$，$\\Delta\\omega$ 很小。涉及 $(\\omega_0+\\omega)$ 的项相对于 $\\omega$ 变化缓慢。$G(e^{j\\omega})$ 项也假定为慢变的。快速变化的行为由以下因子决定\n$$\nH_{fast}(e^{j\\omega}) = \\frac{1 - \\rho e^{-j\\Delta\\omega}}{1 - r e^{-j\\Delta\\omega}}.\n$$\n总响应为 $H_{\\varepsilon}(e^{j\\omega}) = H_{fast}(e^{j\\omega}) \\times H_{slow}(e^{j\\omega})$，其中 $H_{slow}(e^{j\\omega}) = G(e^{j\\omega})\\frac{1 - \\rho e^{-j(\\omega_0+\\omega)}}{1 - r e^{-j(\\omega_0+\\omega)}}$。\n\n在 $\\omega = \\omega_0$ 处，我们有 $\\Delta\\omega = 0$。快速变化部分的幅度为：\n$$\n|H_{fast}(e^{j\\omega_0})| = \\left| \\frac{1 - \\rho}{1 - r} \\right|.\n$$\n由于 $0 < r, \\rho < 1$，这等于 $\\frac{1-\\rho}{1-r}$。使用 $\\rho = r - \\varepsilon$：\n$$\n\\frac{1-\\rho}{1-r} = \\frac{1-(r-\\varepsilon)}{1-r} = \\frac{1-r+\\varepsilon}{1-r} = 1 + \\frac{\\varepsilon}{1-r}.\n$$\n在 $\\omega=\\omega_0$ 处的慢变部分为 $H_{slow}(e^{j\\omega_0}) = G(e^{j\\omega_0})\\frac{1 - \\rho e^{-j2\\omega_0}}{1 - r e^{-j2\\omega_0}}$。由于 $\\rho \\approx r$，该因子近似为 $G(e^{j\\omega_0})$。\n总幅度为 $|H_{\\varepsilon}(e^{j\\omega_0})| = |H_{fast}(e^{j\\omega_0})| \\cdot |H_{slow}(e^{j\\omega_0})| \\approx |G(e^{j\\omega_0})| (1 + \\frac{\\varepsilon}{1-r})$。\n\n在 $\\omega_0$ 处的特征带宽由极点 $r e^{j\\omega_0}$ 和零点 $\\rho e^{j\\omega_0}$ 到单位圆的距离决定。这些距离是 $1-r$ 和 $1-\\rho$。由于 $\\rho = r-\\varepsilon$ 且 $|\\varepsilon| \\le \\frac{1}{2}(1-r)$，我们有 $1-\\rho = 1-r+\\varepsilon$。这意味着 $1-\\rho$ 与 $1-r$ 是同一数量级。$|H_{fast}(e^{j\\omega})|$ 发生显著变化的频率尺度是当 $\\Delta\\omega$ 与 $1-r$ 和 $1-\\rho$ 相当时。例如，使用近似 $e^{-j\\Delta\\omega} \\approx 1-j\\Delta\\omega$，我们得到 $|H_{fast}(e^{j\\omega})|^2 \\approx \\frac{(1-\\rho)^2+(\\rho\\Delta\\omega)^2}{(1-r)^2+(r\\Delta\\omega)^2}$。当 $|\\Delta\\omega| \\sim (1-r)/r \\approx 1-r$ 时会发生显著变化。因此，特征带宽与 $O(1-r)$ 同阶。\n\n现在，我们逐一评估每个选项。\n\n**A. 对于 $\\varepsilon>0$（即 $\\rho<r$），在 $\\omega_0$ 附近的幅度响应呈现一个局部峰值。在除去一个由 $G(e^{j\\omega})$ 和相角为 $-\\omega_0$ 的因子贡献的慢变乘法因子后，其在 $\\omega=\\omega_0$ 处的值满足 $|H_{\\varepsilon}(e^{j\\omega_0})| \\;\\approx\\; \\frac{|1-\\rho|}{|1-r|} \\;=\\; 1 + \\frac{\\varepsilon}{1-r}$，且该峰值的特征带宽与 $(1-r)$ 同阶。**\n\n如果 $\\varepsilon > 0$，则 $\\rho < r$，这意味着 $1-\\rho > 1-r$。因此，增益因子 $1 + \\frac{\\varepsilon}{1-r} > 1$。当 $\\omega$ 远离 $\\omega_0$ 时， $|H_{fast}(e^{j\\omega})|$ 接近 $|\\frac{-\\rho e^{-j\\Delta\\omega}}{-r e^{-j\\Delta\\omega}}| = \\frac{\\rho}{r} < 1$。所以，响应在 $\\omega=\\omega_0$ 处有一个局部峰值。在峰值处快速变化部分的值确实是 $1 + \\frac{\\varepsilon}{1-r}$。“在除去一个慢变的乘法因子后”这一措辞表明我们应该关注这一部分。上面的带宽缩放分析证实了带宽与 $O(1-r)$ 同阶。因此，该陈述是对系统行为的正确描述。\n\n**结论：正确**\n\n**B. 对于 $\\varepsilon<0$（即 $\\rho>r$ 但在给定边界下仍有 $\\rho<1$），在 $\\omega_0$ 附近的幅度响应呈现一个局部凹口。在除去一个如同选项A中的慢变乘法因子后，其在 $\\omega=\\omega_0$ 处的值满足 $|H_{\\varepsilon}(e^{j\\omega_0})| \\;\\approx\\; \\frac{|1-\\rho|}{|1-r|} \\;=\\; 1 + \\frac{\\varepsilon}{1-r} \\;<\\; 1$，且该凹口的特征带宽与 $(1-r)$ 同阶。**\n\n如果 $\\varepsilon < 0$，则 $\\rho > r$，这意味着 $1-\\rho < 1-r$。因此，增益因子 $1 + \\frac{\\varepsilon}{1-r} < 1$。响应在 $\\omega=\\omega_0$ 处有一个局部最小值（一个凹口）。在凹口处快速变化部分的值是 $1 + \\frac{\\varepsilon}{1-r}$，它小于 $1$。带宽缩放的论证与选项A中的相同。该陈述是正确的描述。\n\n**结论：正确**\n\n**C. 在精确抵消的情况 $\\varepsilon=0$ 下，$\\omega_0$ 处的峰值或凹口被消除，并且在小幅度的系数量化下仍然不存在，前提是量化后的系数保持为实数且系统保持因果性。**\n\n如果 $\\varepsilon = 0$，则 $\\rho = r$。由于极零点完全抵消，传递函数变为 $H_0(z) = G(z)$。峰值或凹口被消除了。然而，量化会扰动滤波器系数。分子系数由 $\\rho$ 和 $\\omega_0$ 导出，而分母系数由 $r$ 和 $\\omega_0$ 导出。最初，它们是相同的：$c_1=d_1=2r\\cos\\omega_0$ 和 $c_2=d_2=r^2$。量化为每个系数引入了微小的、通常是不同的误差。设量化后的系数为 $c_{1,q}, c_{2,q}, d_{1,q}, d_{2,q}$。无法保证 $c_{1,q} = d_{1,q}$ 和 $c_{2,q} = d_{2,q}$。例如，如果系数被独立存储和量化，扰动很可能会不同。如果量化后的系数不相同，极零点抵消将不再完美，一个小峰值或凹口将在 $\\omega_0$ 处重新出现。“仍然不存在”这一陈述对于一个通用的量化模型来说过于绝对，并且在事实上是不正确的。\n\n**结论：不正确**\n\n**D. 固定任何满足 $|\\varepsilon|\\le \\tfrac{1}{2}(1-r)$ 的非零 $\\varepsilon$。当 $r\\to 1^{-}$ 时，$|H_{\\varepsilon}(e^{j\\omega_0})|$ 对小绝对值的系数扰动的灵敏度无界增长，其有效条件数与 $1/(1-r)$ 同阶。**\n\n我们来分析灵敏度。条件数衡量输出对参数相对变化的相对灵敏度。令 $M(r,\\rho) = |H_{fast}(e^{j\\omega_0})| = \\frac{1-\\rho}{1-r}$。我们分析完整幅度响应 $|H_\\varepsilon(e^{j\\omega_0})|$ 的灵敏度，它包含慢变因子，但灵敏度主要由这一项决定。\n让我们找出 $M$ 对参数 $r$ 变化的相对灵敏度。\n$\\ln M = \\ln(1-\\rho) - \\ln(1-r)$。代入 $\\rho = r - \\varepsilon$：$\\ln M = \\ln(1-r+\\varepsilon) - \\ln(1-r)$。\n相对变化为 $\\frac{dM}{M} = d(\\ln M) = (\\frac{-1}{1-r+\\varepsilon} - \\frac{-1}{1-r})dr = \\frac{\\varepsilon}{(1-r)(1-r+\\varepsilon)}dr$。\n滤波器系数是 $r$ 的函数，例如，$d_1 = 2r\\cos\\omega_0$ 和 $d_2 = r^2$。\n让我们计算关于 $d_2$ 的条件数。一个扰动 $\\delta d_2$ 给出 $dr = \\frac{\\delta d_2}{2r}$。\n$d_2$ 中的相对扰动是 $\\frac{\\delta d_2}{d_2} = \\frac{\\delta d_2}{r^2}$。\n条件数是 $\\kappa = \\frac{dM/M}{\\delta d_2/d_2} = \\frac{\\frac{\\varepsilon}{(1-r)(1-r+\\varepsilon)} dr}{\\delta d_2/d_2} = \\frac{\\frac{\\varepsilon}{(1-r)(1-r+\\varepsilon)} \\frac{\\delta d_2}{2r}}{\\delta d_2/r^2} = \\frac{r\\varepsilon}{2(1-r)(1-r+\\varepsilon)}$。\n当 $r\\to 1^-$时，对于一个固定的 $\\varepsilon \\neq 0$，$1-r \\to 0$ 且 $1-r+\\varepsilon \\to \\varepsilon$。\n所以，$\\kappa \\approx \\frac{1 \\cdot \\varepsilon}{2(1-r)\\varepsilon} = \\frac{1}{2(1-r)}$。\n条件数的缩放级别为 $O(1/(1-r))$。当 $r \\to 1^-$ 时，此值无界增长。对其他系数的类似计算也会得出与 $1/(1-r)$ 同阶的条件数。该陈述是正确的。\n\n**结论：正确**\n\n**E. 即使对于与 $\\omega_0$ 相隔一个固定裕量的频率 $\\omega$，当 $r\\to 1^{-}$ 时，近似抵消也会导致 $|H_{\\varepsilon}(e^{j\\omega})|$ 中系数量化误差的任意大放大。**\n\n我们考虑一个频率 $\\omega$ 使得 $|\\omega-\\omega_0| \\ge \\delta > 0$。频率响应的分母包含项 $D(e^{j\\omega}) = (1-re^{j(\\omega_0-\\omega)})(1-re^{-j(\\omega_0+\\omega)})$。当 $r\\to 1^-$ 时，该项接近 $(1-e^{j(\\omega_0-\\omega)})(1-e^{-j(\\omega_0+\\omega)})$。由于 $\\omega \\neq \\pm \\omega_0$，这个极限值是一个非零复数。因此，对于这些频率，$H_\\varepsilon(e^{j\\omega})$ 的分母有界且不为零，即使当 $r \\to 1^-$ 时也是如此。\n传递函数对系数 $c$ 的灵敏度与诸如 $\\frac{\\partial H}{\\partial c}$ 的项有关。例如，对分母系数 $d_k$ 的灵敏度涉及到 $1/D(z)^2$。由于 $D(e^{j\\omega})$ 有界且不为零，对于远离 $\\omega_0$ 的频率，对系数扰动的灵敏度不会无界增长。高灵敏度是一种共振效应，局限于分母接近零的频率区域，即 $\\omega \\approx \\omega_0$。因此，该陈述是不正确的。\n\n**结论：不正确**\n\n最终总结：陈述 A、B 和 D 是正确的。", "answer": "$$\n\\boxed{ABD}\n$$", "id": "2873912"}]}