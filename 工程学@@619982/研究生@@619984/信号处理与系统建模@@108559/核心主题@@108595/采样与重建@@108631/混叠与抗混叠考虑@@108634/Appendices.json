{"hands_on_practices": [{"introduction": "要掌握混叠，第一步是能够精确计算欠采样信号在频谱中的表现。这个练习将带你从第一性原理出发，通过一个简单的正弦波思想实验，来预测信号频率在采样后如何“折叠”到奈奎斯特区间内。通过这个基础计算，你将建立对混叠现象的核心直觉。[@problem_id:2851263]", "problem": "一个单音连续时间信号 $x(t) = \\cos\\!\\left(2\\pi f_{0}\\, t\\right)$ 由一个理想采样器以采样频率 $f_{s}$ 进行采集，生成离散时间序列 $x[n] = x(n T_{s})$，其中 $T_{s} = 1/f_{s}$。测量前端缺少一个模拟抗混叠滤波器。已知 $f_{0} = 3.2\\,\\text{kHz}$ 且 $f_{s} = 5\\,\\text{kHz}$。\n\n请仅根据采样关系以及理想采样的标准频域频谱复制模型——即采样后信号的连续时间傅里叶变换（CTFT）等于以 $f_{s}$ 为间隔对原始频谱进行的狄拉克梳状复制——推导所观测到的离散时间频率成分及其在奈奎斯特频带内的混叠。具体而言：\n\n1) 当离散时间频谱显示在区间 $[0, f_{s})$ 内以赫兹为单位的频率轴上时，确定该音调的观测离散时间频率（以赫兹为单位）。该频率是离散时间傅里叶变换（DTFT）的角频率 $\\omega$ 通过 $f = \\omega f_{s}/(2\\pi)$ 映射为赫兹后，直接对应于离散时间正弦波正频率分量的谱线位置。\n\n2) 确定在奈奎斯特区间 $[0, f_{s}/2]$ 内的混叠音调位置（以赫兹为单位），即考虑关于 $f_{s}/2$ 的频谱折叠后，一个限制在 $[0, f_{s}/2]$ 内的理想离散时间频谱会呈现该音调的频率。\n\n以赫兹为单位表示这两个所求值。请按照上述顺序，将最终答案以单行矩阵中的两个数字的形式给出。无需四舍五入。", "solution": "我们从理想采样的基本频域描述开始。令 $X(f)$ 表示 $x(t)$ 的连续时间傅里叶变换 (CTFT)。以周期 $T_{s} = 1/f_{s}$ 进行理想采样，所产生的采样信号其 CTFT 为\n$$\nX_{s}(f) \\;=\\; \\frac{1}{T_{s}} \\sum_{k\\in\\mathbb{Z}} X\\!\\left(f - k f_{s}\\right).\n$$\n对于单音输入 $x(t) = \\cos(2\\pi f_{0} t)$，其 CTFT $X(f)$ 由位于频率 $\\pm f_{0}$ 处、权重相等的两个冲激组成。经过采样后，$X_{s}(f)$ 由位于 $\\pm f_{0} + k f_{s}$ （对所有整数 $k$）处的冲激组成。\n\n为与离散时间序列 $x[n] = x(n T_{s})$ 建立联系，回顾可知，离散时间角频率 $\\omega$（单位：弧度/采样点）与连续频率 $f$（单位：赫兹）的关系如下：\n$$\n\\omega \\;=\\; 2\\pi\\, \\frac{f}{f_{s}} \\quad \\Longleftrightarrow \\quad f \\;=\\; \\frac{\\omega}{2\\pi} \\, f_{s}.\n$$\n由于离散时间傅里叶变换 (DTFT) 在 $\\omega$ 上是 $2\\pi$ 周期的，因此当通过 $f = \\omega f_{s}/(2\\pi)$ 进行映射时，离散时间频谱在以赫兹为单位的频率轴上是 $f_{s}$ 周期的。因此，任何位于 $f$ 处的谱线都可以被视为对 $f_{s}$ 取模的结果。\n\n第1部分：$[0, f_{s})$ 区间内观测到的离散时间频率（单位：赫兹）。\n与该音调相关的正频率谱线出现在模位置\n$$\nf_{\\text{mod}} \\;=\\; f_{0} \\bmod f_{s}.\n$$\n此处，$f_{0} = 3.2\\,\\text{kHz}$ 且 $f_{s} = 5\\,\\text{kHz}$，故 $f_{0}$ 已在 $[0, f_{s})$ 区间内。因此，\n$$\nf_{\\text{obs},[0,f_{s})} \\;=\\; f_{0} \\;=\\; 3.2 \\times 10^{3}.\n$$\n\n第2部分：奈奎斯特区间 $[0, f_{s}/2]$ 内的混叠音调位置。\n奈奎斯特区间为 $[0, f_{s}/2] = [0, 2.5\\,\\text{kHz}]$。高于 $f_{s}/2$ 的频谱分量会以 $f_{s}/2$ 为中心折叠到此区间内。对于位于 $f_{0}$ 处且满足 $f_{0} > f_{s}/2$ 的单音，其折叠（混叠）频率可以通过以 $f_{s}/2$ 为中心进行反射来找到，这等效于取其到 $f_{s}$ 整数倍的最小距离。其标准表达式为\n$$\nf_{\\text{alias}} \\;=\\; \\min_{k\\in\\mathbb{Z}} \\left| f_{0} - k f_{s} \\right|, \\quad \\text{subject to } f_{\\text{alias}} \\in [0, f_{s}/2].\n$$\n由于 $f_{0} = 3.2\\,\\text{kHz}$ 且 $f_{s} = 5\\,\\text{kHz}$，取 $k = 1$：\n$$\n\\left| f_{0} - 1\\cdot f_{s} \\right| \\;=\\; \\left| 3.2\\,\\text{kHz} - 5\\,\\text{kHz} \\right| \\;=\\; 1.8\\,\\text{kHz} \\;\\in\\; [0, 2.5\\,\\text{kHz}].\n$$\n因此，奈奎斯特频带内的混叠音调位置为\n$$\nf_{\\text{alias}} \\;=\\; 1.8 \\times 10^{3}.\n$$\n\n通过离散时间角频率折叠进行一致性检验：对应于 $f_{0}$ 的离散时间角频率为\n$$\n\\omega_{0} \\;=\\; 2\\pi \\frac{f_{0}}{f_{s}} \\;=\\; 2\\pi \\cdot \\frac{3.2}{5} \\;=\\; 1.28\\pi.\n$$\n折叠到 $[0,\\pi]$ 区间利用了 $\\cos(\\omega n) = \\cos\\!\\big((2\\pi - \\omega)n\\big)$ 这一性质，因此在 $[0,\\pi]$ 内观测到的角频率为 $\\omega_{\\text{obs}} = 2\\pi - \\omega_{0} = 0.72\\pi$。将其映射回赫兹单位，\n$$\nf_{\\text{alias}} \\;=\\; \\frac{\\omega_{\\text{obs}}}{2\\pi}\\, f_{s} \\;=\\; 0.36\\, f_{s} \\;=\\; 0.36 \\times 5\\,\\text{kHz} \\;=\\; 1.8\\,\\text{kHz},\n$$\n这与上述结果一致。\n\n因此，所求的两个值为 $f_{\\text{obs},[0,f_{s})} = 3200$ 赫兹和 $f_{\\text{alias}} = 1800$ 赫兹。", "answer": "$$\\boxed{\\begin{pmatrix}3200 & 1800\\end{pmatrix}}$$", "id": "2851263"}, {"introduction": "在预测混叠之后，一个更实际的挑战是如何在真实世界的测量数据中诊断它的存在。本练习介绍了一种巧妙的诊断技术，它利用了实值系统频率响应的基本对称性。你将推导出一个统计量，该统计量可以在没有混叠的情况下量化预期的测量噪声，从而为识别数据中的异常提供一个基准。[@problem_id:2851316]", "problem": "考虑一个实值的线性时不变 (LTI) 离散时间系统，其冲激响应 $h[n] \\in \\mathbb{R}$, $n \\in \\mathbb{Z}$ 是绝对可和的。其离散时间傅里叶变换 (DTFT) 定义为 $H(\\exp(j\\omega)) \\triangleq \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(-j \\omega n)$，该变换是关于 $\\omega$ 以 $2\\pi$ 为周期的。你在一个覆盖区间 $(-\\pi,\\pi]$ 的均匀网格 $\\{\\omega_{k}\\}_{k=0}^{N-1}$ 上测量其复频率响应，测量过程受到微小的加性复测量扰动影响，得到的测量值为 $H_{m}(\\exp(j\\omega_{k})) = H(\\exp(j\\omega_{k})) + n(\\omega_{k})$。假设扰动满足以下条件：对于不同的频率样本 $\\omega_{k} \\neq \\omega_{\\ell}$，随机变量 $n(\\omega_{k})$ 和 $n(\\omega_{\\ell})$ 是独立同分布、圆对称的零均值复随机变量，其二阶矩为 $\\mathbb{E}[|n(\\omega_{k})|^{2}] = \\sigma^{2}$，且与 $H(\\exp(j\\omega))$ 相互独立。\n\n为了诊断测得的频率响应中的混叠，你决定利用 $H(\\exp(j\\omega))$ 在 $\\omega=\\pi$ 处的环绕行为，即从 $\\omega \\rightarrow \\pi^{-}$ 到 $\\omega \\rightarrow -\\pi^{+}$ 过渡时的连续性和周期性。设 $\\Delta \\in (0,\\pi)$ 为网格间距，并定义一组偏移量 $\\{\\delta_{k}\\}_{k=0}^{K-1}$，其中 $\\delta_{k} \\triangleq k \\Delta$，且 $K \\Delta \\ll \\pi$，因此频带 $[\\pi - K\\Delta, \\pi)$ 是 $\\omega=\\pi$ 的一个小邻域。对于每个 $k \\in \\{0,1,\\ldots,K-1\\}$，考虑频率对 $ \\pi - \\delta_{k}$ 和 $-\\pi + \\delta_{k}$，它们通过 $2\\pi$ 周期性环绕而相互映射。\n\n定义失配序列\n$$\nD_{k} \\triangleq H_{m}\\!\\left(\\exp\\!\\big(j(\\pi - \\delta_{k})\\big)\\right) - \\overline{H_{m}\\!\\left(\\exp\\!\\big(j(-\\pi + \\delta_{k})\\big)\\right)} \\quad \\text{for } k=0,1,\\ldots,K-1,\n$$\n以及诊断统计量\n$$\nS_{K} \\triangleq \\frac{1}{K} \\sum_{k=0}^{K-1} \\left|D_{k}\\right|^{2}.\n$$\n\n任务：\n- 仅从以上给出的定义和实值冲激响应的DTFT的基本性质出发，推导在没有混叠的情况下，$H(\\exp(j(\\pi - \\delta)))$ 和 $H(\\exp(j(-\\pi + \\delta)))$ 之间必须满足的对称关系。\n- 利用此关系和扰动模型，推导期望 $\\mathbb{E}[S_{K}]$ 关于 $\\sigma^{2}$ 的闭式表达式。\n\n将最终答案报告为以 $\\sigma^{2}$ 表示的单个闭式解析表达式。不需要进行数值近似；不要包含单位。", "solution": "该问题在离散时间信号处理领域内是适定的，且具有科学依据。它要求应用实值信号的离散时间傅里叶变换（DTFT）的基本性质以及概率论的基本原理来进行期望计算。我们将开始推导。\n\n该问题包含两部分。首先，我们必须推导实值冲激响应 $h[n]$ 的DTFT $H(\\exp(j\\omega))$ 的对称关系。其次，我们利用此关系计算诊断统计量 $S_{K}$ 的期望。\n\n第一部分：DTFT对称关系的推导。\n冲激响应 $h[n]$ 的DTFT定义为 $H(\\exp(j\\omega)) = \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(-j \\omega n)$。\n给定冲激响应是实值的，即对于所有 $n \\in \\mathbb{Z}$ 都有 $h[n] \\in \\mathbb{R}$。这意味着 $h[n]$ 等于其复共轭，即 $\\overline{h[n]} = h[n]$。\n我们来计算 $H(\\exp(j\\omega))$ 的复共轭：\n$$\n\\overline{H(\\exp(j\\omega))} = \\overline{\\sum_{n=-\\infty}^{\\infty} h[n] \\exp(-j \\omega n)}\n$$\n利用复共轭的性质，和的共轭等于共轭的和，积的共轭等于共轭的积：\n$$\n\\overline{H(\\exp(j\\omega))} = \\sum_{n=-\\infty}^{\\infty} \\overline{h[n]} \\overline{\\exp(-j \\omega n)}\n$$\n由于 $h[n]$ 是实数，$\\overline{h[n]} = h[n]$。$\\exp(-j \\omega n)$ 的共轭是 $\\exp(j \\omega n)$。因此，\n$$\n\\overline{H(\\exp(j\\omega))} = \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(j \\omega n)\n$$\n现在，我们来计算在频率 $-\\omega$ 处的DTFT：\n$$\nH(\\exp(j(-\\omega))) = H(\\exp(-j\\omega)) = \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(-j(-\\omega)n) = \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(j \\omega n)\n$$\n比较这两个结果，我们建立了对于任何实值序列的DTFT的基本共轭对称性质：\n$$\nH(\\exp(-j\\omega)) = \\overline{H(\\exp(j\\omega))}\n$$\n问题要求 $H(\\exp(j(\\pi - \\delta)))$ 和 $H(\\exp(j(-\\pi + \\delta)))$ 之间的对称关系。我们将 $\\omega = \\pi - \\delta$ 代入共轭对称关系。左边变为：\n$$\nH(\\exp(-j(\\pi - \\delta))) = H(\\exp(j(-\\pi + \\delta)))\n$$\n右边变为：\n$$\n\\overline{H(\\exp(j(\\pi - \\delta)))}\n$$\n令两者相等，即可得到所要求的对称关系：\n$$\nH(\\exp(j(-\\pi + \\delta))) = \\overline{H(\\exp(j(\\pi - \\delta)))}\n$$\n在没有混叠的情况下，即当 $H(\\exp(j\\omega))$ 是一个实序列的真实DTFT时，此关系对任何 $\\delta \\in \\mathbb{R}$ 都成立。\n\n第二部分：期望 $\\mathbb{E}[S_{K}]$ 的推导。\n诊断统计量定义为 $S_{K} \\triangleq \\frac{1}{K} \\sum_{k=0}^{K-1} |D_{k}|^{2}$，其中失配序列为 $D_{k} \\triangleq H_{m}(\\exp(j(\\pi - \\delta_{k}))) - \\overline{H_{m}(\\exp(j(-\\pi + \\delta_{k})))}$。我们关心的是 $\\mathbb{E}[S_K]$。根据期望的线性性质，\n$$\n\\mathbb{E}[S_{K}] = \\frac{1}{K} \\sum_{k=0}^{K-1} \\mathbb{E}\\left[|D_{k}|^{2}\\right]\n$$\n我们首先求出 $D_k$ 的表达式。我们将测量模型 $H_{m}(\\exp(j\\omega)) = H(\\exp(j\\omega)) + n(\\omega)$ 代入 $D_k$ 的定义中：\n$$\nD_{k} = \\left[H(\\exp(j(\\pi - \\delta_{k}))) + n(\\pi - \\delta_{k})\\right] - \\overline{\\left[H(\\exp(j(-\\pi + \\delta_{k}))) + n(-\\pi + \\delta_{k})\\right]}\n$$\n$$\nD_{k} = H(\\exp(j(\\pi - \\delta_{k}))) + n(\\pi - \\delta_{k}) - \\overline{H(\\exp(j(-\\pi + \\delta_{k})))} - \\overline{n(-\\pi + \\delta_{k})}\n$$\n从第一部分，我们有对称关系 $H(\\exp(j(-\\pi + \\delta_{k}))) = \\overline{H(\\exp(j(\\pi - \\delta_{k})))}$。对此关系的两边取复共轭可得 $\\overline{H(\\exp(j(-\\pi + \\delta_{k})))} = H(\\exp(j(\\pi - \\delta_{k})))$。\n将此结果代入 $D_k$ 的表达式中：\n$$\nD_{k} = H(\\exp(j(\\pi - \\delta_{k}))) + n(\\pi - \\delta_{k}) - H(\\exp(j(\\pi - \\delta_{k}))) - \\overline{n(-\\pi + \\delta_{k})}\n$$\n含有真实DTFT $H$ 的项相互抵消，这正是此诊断检验的原理。我们剩下的表达式只与测量扰动有关：\n$$\nD_{k} = n(\\pi - \\delta_{k}) - \\overline{n(-\\pi + \\delta_{k})}\n$$\n现在我们计算其幅度的平方，即 $|D_{k}|^{2}$：\n$$\n|D_{k}|^{2} = \\left| n(\\pi - \\delta_{k}) - \\overline{n(-\\pi + \\delta_{k})} \\right|^{2}\n$$\n利用性质 $|z|^2 = z\\overline{z}$，我们有：\n$$\n|D_{k}|^{2} = \\left( n(\\pi - \\delta_{k}) - \\overline{n(-\\pi + \\delta_{k})} \\right) \\left( \\overline{n(\\pi - \\delta_{k})} - n(-\\pi + \\delta_{k}) \\right)\n$$\n展开此乘积可得：\n$$\n|D_{k}|^{2} = |n(\\pi - \\delta_{k})|^{2} - n(\\pi - \\delta_{k})n(-\\pi + \\delta_{k}) - \\overline{n(-\\pi + \\delta_{k})}\\overline{n(\\pi - \\delta_{k})} + |\\overline{n(-\\pi + \\delta_{k})}|^{2}\n$$\n由于 $|z|^2 = |\\overline{z}|^2$，上式可简化为：\n$$\n|D_{k}|^{2} = |n(\\pi - \\delta_{k})|^{2} + |n(-\\pi + \\delta_{k})|^{2} - \\left( n(\\pi - \\delta_{k})n(-\\pi + \\delta_{k}) + \\overline{n(\\pi - \\delta_{k})n(-\\pi + \\delta_{k})} \\right)\n$$\n现在我们对 $|D_{k}|^{2}$ 取期望：\n$$\n\\mathbb{E}[|D_{k}|^{2}] = \\mathbb{E}[|n(\\pi - \\delta_{k})|^{2}] + \\mathbb{E}[|n(-\\pi + \\delta_{k})|^{2}] - \\mathbb{E}[n(\\pi - \\delta_{k})n(-\\pi + \\delta_{k}) + \\overline{n(\\pi - \\delta_{k})n(-\\pi + \\delta_{k})}]\n$$\n给定对于任何频率样本 $\\omega$ 都有 $\\mathbb{E}[|n(\\omega)|^{2}] = \\sigma^{2}$。因此，\n$\\mathbb{E}[|n(\\pi - \\delta_{k})|^{2}] = \\sigma^{2}$ 且 $\\mathbb{E}[|n(-\\pi + \\delta_{k})|^{2}] = \\sigma^{2}$。\n对所有 $k \\in \\{0, 1, \\ldots, K-1\\}$，频率 $\\omega_{k,1} = \\pi - \\delta_k$ 和 $\\omega_{k,2} = -\\pi + \\delta_k$ 是不同的。对于 $k>0$，这是显而易见的，因为 $\\delta_k = k\\Delta > 0$ 且 $K\\Delta \\ll \\pi$。对于 $k=0$，$\\delta_0=0$，我们有 $\\omega_{0,1}=\\pi$ 和 $\\omega_{0,2}=-\\pi$。在指定的区间 $(-\\pi, \\pi]$ 内，这些是不同的频率值。\n根据题目陈述，对于不同的频率 $\\omega_a \\neq \\omega_b$，随机变量 $n(\\omega_a)$ 和 $n(\\omega_b)$ 是独立的。因此，$n(\\pi - \\delta_{k})$ 和 $n(-\\pi + \\delta_{k})$ 是独立随机变量。\n我们还知道扰动是零均值的，即对所有 $\\omega$ 都有 $\\mathbb{E}[n(\\omega)] = 0$。\n对于交叉项的期望，独立性使我们能够写出：\n$$\n\\mathbb{E}[n(\\pi - \\delta_{k})n(-\\pi + \\delta_{k})] = \\mathbb{E}[n(\\pi - \\delta_{k})] \\mathbb{E}[n(-\\pi + \\delta_{k})] = 0 \\cdot 0 = 0\n$$\n由于交叉项的期望为零，其复共轭的期望也为零。因此，整个被减项的期望为零。\n所以，对于每个 $k$，我们有：\n$$\n\\mathbb{E}[|D_{k}|^{2}] = \\sigma^{2} + \\sigma^{2} - 0 = 2\\sigma^{2}\n$$\n这个结果与索引 $k$ 无关。现在我们可以计算 $S_K$ 的期望：\n$$\n\\mathbb{E}[S_{K}] = \\frac{1}{K} \\sum_{k=0}^{K-1} \\mathbb{E}\\left[|D_{k}|^{2}\\right] = \\frac{1}{K} \\sum_{k=0}^{K-1} 2\\sigma^{2}\n$$\n该和包含 $K$ 个相同的项，所以总和为 $K \\cdot 2\\sigma^{2}$。\n$$\n\\mathbb{E}[S_{K}] = \\frac{1}{K} (K \\cdot 2\\sigma^{2}) = 2\\sigma^{2}\n$$\n这就是诊断统计量期望的最终闭式表达式。", "answer": "$$\n\\boxed{2\\sigma^{2}}\n$$", "id": "2851316"}, {"introduction": "控制混叠的最终目标是主动设计系统以最小化其影响。本练习将你置于系统设计者的角色，任务是在满足严格约束（如固定的滤波器能量预算和通带要求）的同时，设计一个最优的抗混叠滤波器。通过解决这个受约束的优化问题，你将学习如何在信号保真度和混叠抑制之间做出工程权衡。[@problem_id:2851299]", "problem": "一个均值为零的广义平稳 (WSS) 连续时间过程，其功率谱密度 (PSD) 为 $S_{x}(f)$，将以采样频率 $f_{s} = 10 \\times 10^{3}$ Hz 进行采样。在采样之前，该过程通过一个实数线性时不变抗混叠滤波器，其频率响应为 $H(f)$，其中 $|H(f)|$ 是偶函数，且其值被限制在 $0 \\leq |H(f)| \\leq 1$ 范围内。通带要求为单位增益，即对于 $|f| \\leq 5 \\times 10^{3}$ Hz，有 $|H(f)| = 1$。由于硬件限制，该预滤波器是严格带限的：对于 $|f| > 10 \\times 10^{3}$ Hz，有 $|H(f)| = 0$。\n\n该过程的功率谱密度为分段常数：\n- 对于 $|f| \\leq 5 \\times 10^{3}$ Hz，$S_{x}(f) = 1$，\n- 对于 $5 \\times 10^{3} < |f| \\leq 7 \\times 10^{3}$ Hz，$S_{x}(f) = \\tfrac{1}{2}$，\n- 对于 $7 \\times 10^{3} < |f| \\leq 10 \\times 10^{3}$ Hz，$S_{x}(f) = \\tfrac{3}{2}$，\n- 对于 $|f| > 10 \\times 10^{3}$ Hz，$S_{x}(f) = 0$。\n\n设 $y(t)$ 为滤波后的信号，$y[n] = y(n T_{s})$，其中 $T_{s} = 1/f_{s}$。$y[n]$ 的离散时间功率谱密度（在 $|f| \\leq f_{s}/2$ 上的连续频率表示）等于由采样引起的周期化频谱。通过采样频谱估计连续时间基带二阶统计量的均方误差 (MSE) 定义为：在 $|f| \\leq f_{s}/2$ 范围内，$y[n]$ 的基带周期化频谱与原始基带 $S_{x}(f)$ 之间的积分平方偏差。\n\n假设采样率和 $S_{x}(f)$ 满足以下条件：对于每个基带频率 $|f| \\leq 5 \\times 10^{3}$ Hz，最多只有一个来自 $|f| \\in (5 \\times 10^{3}, 10 \\times 10^{3}]$ 的混叠项折叠进基带。\n\n你的任务是设计抗混叠预滤波器的幅度 $|H(f)|$，使其在满足所述约束和固定能量预算\n$$\n\\int_{-\\infty}^{\\infty} |H(f)|^{2} \\, df \\;=\\; 12 \\times 10^{3}.\n$$\n的条件下，最小化上述均方误差。\n从第一性原理（滤波过程的功率谱密度定义、采样引起的周期化以及 $L^{2}$ 型均方误差的定义）出发。构建关于 $|H(f)|$ 的约束优化问题，并针对三个区域 $|f| \\leq 5 \\times 10^{3}$ Hz、$5 \\times 10^{3} < |f| \\leq 7 \\times 10^{3}$ Hz 和 $7 \\times 10^{3} < |f| \\leq 10 \\times 10^{3}$ Hz 显式求解最优的 $|H(f)|$。将你的最终答案表示为最优幅度响应 $|H(f)|$ 的单个分段定义解析表达式。最终答案中不要包含单位。", "solution": "首先对问题陈述进行关键性验证。\n\n**步骤1：提取的已知条件**\n-   一个均值为零的广义平稳（WSS）连续时间过程 $x(t)$，其功率谱密度（PSD）为 $S_{x}(f)$。\n-   对于 $|f| \\leq 5 \\times 10^{3}$ Hz，$S_{x}(f) = 1$。\n-   对于 $5 \\times 10^{3} < |f| \\leq 7 \\times 10^{3}$ Hz，$S_{x}(f) = \\frac{1}{2}$。\n-   对于 $7 \\times 10^{3} < |f| \\leq 10 \\times 10^{3}$ Hz，$S_{x}(f) = \\frac{3}{2}$。\n-   对于 $|f| > 10 \\times 10^{3}$ Hz，$S_{x}(f) = 0$。\n-   该过程通过一个实数线性时不变（LTI）抗混叠滤波器，其频率响应为 $H(f)$。\n-   滤波器约束：$|H(f)|$ 是偶函数；$0 \\leq |H(f)| \\leq 1$；对于 $|f| \\leq 5 \\times 10^{3}$ Hz，有 $|H(f)| = 1$；对于 $|f| > 10 \\times 10^{3}$ Hz，有 $|H(f)| = 0$。\n-   采样频率为 $f_{s} = 10 \\times 10^{3}$ Hz。采样周期为 $T_s = 1/f_s$。\n-   滤波后的信号为 $y(t)$，采样后的信号为 $y[n] = y(nT_s)$。\n-   均方误差 (MSE) 定义为：在 $|f| \\leq f_{s}/2$ 范围内，$y[n]$ 的基带周期化频谱与原始基带 $S_{x}(f)$ 之间的积分平方偏差。\n-   假设对于任何基带频率，最多只有一个混叠项折叠进基带。\n-   滤波器有固定的能量预算：$\\int_{-\\infty}^{\\infty} |H(f)|^{2} \\, df = 12 \\times 10^{3}$。\n\n**步骤2：验证**\n该问题在科学上基于数字信号处理的原理。它是一个良态问题，具有明确的目标函数 (MSE) 和一组定义明确的约束条件，需要在这些约束下进行最小化。给定的值和约束是自洽的。可以验证能量预算约束：在通带 $|f| \\leq 5 \\times 10^{3}$ Hz（其中 $|H(f)|=1$）上的积分为 $\\int_{-5 \\times 10^3}^{5 \\times 10^3} 1^2 df = 10 \\times 10^3$。这为剩余频带留下了 $(12-10) \\times 10^3 = 2 \\times 10^3$ 的能量。由于 $|H(f)|$ 是偶函数，这意味着 $\\int_{5 \\times 10^3}^{10 \\times 10^3} |H(f)|^2 df = 1 \\times 10^3$。这些约束并不矛盾。关于混叠的假设对于给定的采样率和信号带宽是可验证且正确的。该问题是最优滤波器设计中的一个标准（尽管非平凡）练习。\n\n**结论**\n该问题是有效的。我们着手求解。\n\n**求解推导**\n滤波后信号 $y(t)$ 的功率谱密度为 $S_y(f) = |H(f)|^2 S_x(f)$。\n以速率 $f_s$ 对 $y(t)$ 进行采样的过程，会得到离散时间信号 $y[n]$ 的周期化频谱。用连续频率 $f$ 表示，该频谱由下式给出\n$$S_y^p(f) = \\sum_{k=-\\infty}^{\\infty} S_y(f - kf_s) = \\sum_{k=-\\infty}^{\\infty} |H(f - kf_s)|^2 S_x(f - kf_s)$$\n我们关心的是基带 $|f| \\leq f_s/2$。采样频率为 $f_s = 10 \\times 10^3$ Hz，因此基带为 $|f| \\leq 5 \\times 10^3$ Hz。该滤波器是带限的，对于 $|f| > 10 \\times 10^3$ Hz（等于 $f_s$），有 $|H(f)|=0$。因此，对于基带中的任何 $f$，求和中只有 $k=0, \\pm 1$ 项可以非零。\n对于 $|f| \\leq f_s/2$：\n- $k=0$ 时的参数是 $f$，它在基带内。\n- $k=1$ 时的参数是 $f-f_s$，它在 $[-3f_s/2, -f_s/2]$ 范围内。$H$ 的支撑集是 $[-f_s, f_s]$，所以该项有贡献。\n- $k=-1$ 时的参数是 $f+f_s$，它在 $[f_s/2, 3f_s/2]$ 范围内。该项也有贡献。\n- 对于 $|k| \\geq 2$，参数 $|f-kf_s|$ 大于 $f_s$，所以 $|H(f-kf_s)|=0$。\n\n基带 $|f| \\leq f_s/2$ 内的周期化频谱为：\n$$S_y^p(f) = |H(f)|^2 S_x(f) + |H(f-f_s)|^2 S_x(f-f_s) + |H(f+f_s)|^2 S_x(f+f_s)$$\n我们来分析 $f \\in [0, f_s/2]$ 的情况。由于所有函数都是偶函数，负频率的结果将是对称的。\n对于 $f \\in [0, f_s/2]$：\n- $|H(f)|=1$ 且 $S_x(f)=1$。\n- $f+f_s > f_s$，所以 $|H(f+f_s)|=0$。\n- $f-f_s$ 位于 $[-f_s, -f_s/2]$ 内。由于 $|H(f)|$ 和 $S_x(f)$ 是偶函数，所以 $|H(f-f_s)|^2 S_x(f-f_s) = |H(f_s-f)|^2 S_x(f_s-f)$。\n因此，对于 $f \\in [0, f_s/2]$：\n$$S_y^p(f) = 1 + |H(f_s-f)|^2 S_x(f_s-f)$$\n基带中的期望频谱是 $S_x(f) = 1$。误差频谱是混叠分量：\n$$E(f) = S_y^p(f) - S_x(f) = |H(f_s-f)|^2 S_x(f_s-f)$$\n均方误差（MSE）定义为 $J = \\int_{-f_s/2}^{f_s/2} E(f)^2 df$。由于 $E(f)$ 是 $f$ 的偶函数：\n$$J = 2 \\int_{0}^{f_s/2} \\left( |H(f_s-f)|^2 S_x(f_s-f) \\right)^2 df$$\n我们进行变量代换，令 $g = f_s-f$。则 $df = -dg$。当 $f=0$ 时，$g=f_s$。当 $f=f_s/2$ 时，$g=f_s/2$。\n$$J = 2 \\int_{f_s}^{f_s/2} \\left( |H(g)|^2 S_x(g) \\right)^2 (-dg) = 2 \\int_{f_s/2}^{f_s} \\left( |H(f)|^2 S_x(f) \\right)^2 df$$\n我们希望在能量约束下最小化这个泛函 $J$。总能量是 $12 \\times 10^3$。通带内的能量是 $\\int_{-5 \\times 10^3}^{5 \\times 10^3} 1^2 df = 10 \\times 10^3$。\n剩余的能量分配给阻带 $|f| \\in (5 \\times 10^3, 10 \\times 10^3]$。\n$\\int_{|f| \\in (5 \\times 10^3, 10 \\times 10^3]} |H(f)|^2 df = 2 \\times 10^3$。根据对称性，$\\int_{5 \\times 10^3}^{10 \\times 10^3} |H(f)|^2 df = 1 \\times 10^3$。\n令 $h(f) = |H(f)|$。为清晰起见，令 $f_1 = 5 \\times 10^3$，$f_2 = 7 \\times 10^3$，$f_3 = 10 \\times 10^3$。\n优化问题是：最小化 $J = 2 \\int_{f_1}^{f_3} h(f)^4 S_x(f)^2 df$，约束条件为 $\\int_{f_1}^{f_3} h(f)^2 df = 10^3$ 和 $0 \\leq h(f) \\leq 1$。\n我们构建拉格朗日泛函：\n$$\\mathcal{L}[h] = \\int_{f_1}^{f_3} \\left( 2 h(f)^4 S_x(f)^2 - \\lambda h(f)^2 \\right) df + \\lambda \\cdot 10^3$$\n对 $h(f)$ 求泛函导数并令其为零，得到欧拉-拉格朗日方程：\n$$8 h(f)^3 S_x(f)^2 - 2 \\lambda h(f) = 0 \\implies 2h(f) (4 h(f)^2 S_x(f)^2 - \\lambda) = 0$$\n对于非平凡解 $h(f) \\neq 0$，我们有 $h(f)^2 = \\frac{\\lambda}{4 S_x(f)^2}$，所以 $h(f) = \\frac{\\sqrt{\\lambda}}{2 S_x(f)}$。令 $K = \\frac{\\sqrt{\\lambda}}{2}$。\n解的形式为 $h(f) = K/S_x(f)$，前提是 $K/S_x(f) \\leq 1$。\n功率谱密度 $S_x(f)$ 在优化区域 $[f_1, f_3]$ 内是分段常数：\n- 对于 $f \\in (f_1, f_2]$，$S_x(f) = S_2 = 1/2$。\n- 对于 $f \\in (f_2, f_3]$，$S_x(f) = S_3 = 3/2$。\n所以，最优的 $h(f)$ 也必须是分段常数：\n- 对于 $f \\in (f_1, f_2]$，$h(f) = K/S_2 = 2K$。\n- 对于 $f \\in (f_2, f_3]$，$h(f) = K/S_3 = 2K/3$。\n我们使用能量约束来求 $K$：\n$$\\int_{f_1}^{f_2} (2K)^2 df + \\int_{f_2}^{f_3} \\left(\\frac{2K}{3}\\right)^2 df = 10^3$$\n$$4K^2 (f_2 - f_1) + \\frac{4K^2}{9} (f_3 - f_2) = 10^3$$\n$$4K^2 (2 \\times 10^3) + \\frac{4K^2}{9} (3 \\times 10^3) = 10^3$$\n$$8 \\times 10^3 K^2 + \\frac{4}{3} \\times 10^3 K^2 = 10^3$$\n等式两边同除以 $10^3$：\n$$8K^2 + \\frac{4}{3}K^2 = 1 \\implies \\frac{28}{3}K^2 = 1 \\implies K^2 = \\frac{3}{28}$$\n所以，$K = \\sqrt{\\frac{3}{28}} = \\frac{\\sqrt{3}}{2\\sqrt{7}} = \\frac{\\sqrt{21}}{14}$。\n$h(f)$ 的最大值为 $2K = \\frac{\\sqrt{21}}{7}$。由于 $21 < 49$，$\\sqrt{21}<7$，所以 $2K<1$。约束条件 $h(f) \\leq 1$ 得到满足。\n最优滤波器幅度值为：\n- 对于 $f \\in (5 \\times 10^3, 7 \\times 10^3]$：$h(f) = 2K = \\frac{\\sqrt{21}}{7}$。\n- 对于 $f \\in (7 \\times 10^3, 10 \\times 10^3]$：$h(f) = \\frac{2K}{3} = \\frac{\\sqrt{21}}{21} = \\frac{1}{\\sqrt{21}}$。\n\n综合所有部分，最优滤波器幅度响应 $|H(f)|$（它是 $f$ 的偶函数）的完整表达式由其在 $f \\geq 0$ 上的定义给出：\n- 对于 $0 \\leq |f| \\leq 5 \\times 10^3$ Hz，$|H(f)| = 1$。\n- 对于 $5 \\times 10^3 < |f| \\leq 7 \\times 10^3$ Hz，$|H(f)| = \\frac{\\sqrt{21}}{7}$。\n- 对于 $7 \\times 10^3 < |f| \\leq 10 \\times 10^3$ Hz，$|H(f)| = \\frac{\\sqrt{21}}{21}$。\n- 对于 $|f| > 10 \\times 10^3$ Hz，$|H(f)| = 0$。\n这就是最终答案。", "answer": "$$\n\\boxed{\n|H(f)| = \n\\begin{cases} \n1 & |f| \\leq 5 \\times 10^3 \\\\\n\\frac{\\sqrt{21}}{7} & 5 \\times 10^3 < |f| \\leq 7 \\times 10^3 \\\\\n\\frac{\\sqrt{21}}{21} & 7 \\times 10^3 < |f| \\leq 10 \\times 10^3 \\\\\n0 & |f| > 10 \\times 10^3\n\\end{cases}\n}\n$$", "id": "2851299"}]}