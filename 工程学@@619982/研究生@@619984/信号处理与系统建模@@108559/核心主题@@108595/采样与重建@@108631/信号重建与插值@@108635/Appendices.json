{"hands_on_practices": [{"introduction": "香农采样定理是数字信号处理的基石，它保证了在采样率足够且使用理想低通滤波器的情况下可以实现完美重建。本练习将深入探讨其两个基本要求：确定精确的采样率极限（奈奎斯特率），并确保重建级数本身是收敛的。通过解决这个问题，你将巩固对理想重建理论保证和其限制的理解，并将时域中的信号行为与其频谱域的性质联系起来。[@problem_id:2904354]", "problem": "一个实值连续时间信号 $x(t)$ 的连续时间傅里叶变换 $X(\\omega)$ 支撑在紧区间 $\\{\\,\\omega \\in \\mathbb{R} : |\\omega| \\leq 0.4\\pi/T_{0}\\,\\}$ 上，其中 $T_{0} > 0$ 是一个给定的时间尺度（单位为秒），$\\omega$ 的单位为弧度/秒。假设 $X(\\omega)$ 在 $\\mathbb{R}$ 上二次连续可微，对于 $|\\omega| \\geq 0.4\\pi/T_{0}$ 满足 $X(\\omega) = 0$，并且具有边界正则性 $X(\\pm 0.4\\pi/T_{0}) = 0$ 和 $X'(\\pm 0.4\\pi/T_{0}) = 0$。您以采样周期 $T$ 对 $x(t)$ 进行均匀采样，并尝试使用一个理想低通插值进行完美重构，其通带覆盖 $X(\\omega)$ 的基带支撑。\n\n任务：\n- 仅使用关于采样下的频谱复制和频谱副本不重叠的基本原理，确定在均匀采样下仍能保证完美重构的最大采样周期 $T_{\\max}$（单位为秒）。将您的最终答案表示为关于 $T_{0}$ 的闭式表达式。\n- 在相同假设下，考虑香农插值级数 $x(t) = \\sum_{n\\in\\mathbb{Z}} x(nT)\\,\\operatorname{sinc}\\!\\big((t-nT)/T\\big)$，其中 $\\operatorname{sinc}(u) \\triangleq \\sin(\\pi u)/(\\pi u)$。从第一性原理和给定的 $X(\\omega)$ 的正则性出发，严格验证对于每个固定的 $t \\in \\mathbb{R}$，当 $T = T_{\\max}$（如上求得）时，该级数绝对收敛。\n\n将最终答案表示为 $T_{\\max}$ 关于 $T_{0}$ 的单一符号表达式（最终答案不含单位）。无需进行数值取整。", "solution": "问题陈述具有科学依据、适定且客观。不存在矛盾或谬误。我们直接进行求解。问题包含两个任务，我们将按顺序解决。\n\n首先，我们确定保证完美重构的最大采样周期，记为 $T_{\\max}$。\n连续时间信号 $x(t)$ 的傅里叶变换 $X(\\omega)$ 仅在区间 $|\\omega| \\leq 0.4\\pi/T_{0}$ 上非零。这意味着该信号是带限的。信号的最大频率，或称带宽，为 $\\omega_M = 0.4\\pi/T_{0}$。\n\n当以周期 $T$ 对 $x(t)$ 进行采样时，所得采样信号（可建模为 $x_s(t) = \\sum_{n \\in \\mathbb{Z}} x(nT)\\delta(t-nT)$）的傅里叶变换由 $X(\\omega)$ 的缩放和平移副本叠加而成：\n$$X_s(\\omega) = \\frac{1}{T} \\sum_{k \\in \\mathbb{Z}} X(\\omega - k\\omega_s)$$\n其中 $\\omega_s = 2\\pi/T$ 是采样频率，单位为弧度/秒。\n\n为实现完美重构，频谱副本不得重叠。此条件即为奈奎斯特准则。基带频谱支撑在 $[-\\omega_M, \\omega_M]$ 上。对于 $k=1$ 的第一个频谱副本，其中心位于 $\\omega_s$，支撑在 $[\\omega_s - \\omega_M, \\omega_s + \\omega_M]$ 上。为防止基带频谱与第一个副本重叠，基带频谱的上边界必须小于或等于第一个副本的下边界。在数学上，这表示为：\n$$\\omega_M \\leq \\omega_s - \\omega_M$$\n此不等式可简化为：\n$$\\omega_s \\geq 2\\omega_M$$\n这是避免混叠的基本条件。满足此条件的最小采样频率是奈奎斯特率，$\\omega_{s, \\text{min}} = 2\\omega_M$。更低的采样频率将导致混叠，使得完美重构不可能实现。\n\n问题要求保证完美重构的最大采样周期 $T$。由于采样周期 $T$ 和采样频率 $\\omega_s$ 通过 $T = 2\\pi/\\omega_s$ 成反比关系，最大采样周期 $T_{\\max}$ 对应于最小采样频率 $\\omega_{s, \\text{min}}$。\n$$T_{\\max} = \\frac{2\\pi}{\\omega_{s, \\text{min}}} = \\frac{2\\pi}{2\\omega_M} = \\frac{\\pi}{\\omega_M}$$\n代入给定的 $\\omega_M$ 值：\n$$T_{\\max} = \\frac{\\pi}{0.4\\pi/T_{0}} = \\frac{1}{0.4} T_{0} = \\frac{1}{4/10} T_{0} = \\frac{10}{4} T_{0} = \\frac{5}{2} T_{0}$$\n\n其次，我们必须验证当 $T = T_{\\max} = \\frac{5}{2} T_{0}$ 时，香农插值级数的绝对收敛性。插值公式为：\n$$x(t) = \\sum_{n\\in\\mathbb{Z}} x(nT)\\,\\operatorname{sinc}\\!\\left(\\frac{t-nT}{T}\\right)$$\n要验证绝对收敛性，我们必须证明对于任意固定的 $t \\in \\mathbb{R}$，各项绝对值之和是有限的：\n$$\\sum_{n\\in\\mathbb{Z}} \\left|x(nT)\\,\\operatorname{sinc}\\!\\left(\\frac{t-nT}{T}\\right)\\right| < \\infty$$\n对于大的 $|n|$，此级数的收敛性取决于样本 $|x(nT)|$ 的衰减率。当 $|t| \\to \\infty$ 时，$x(t)$ 的衰减率由其傅里叶变换 $X(\\omega)$ 的光滑性决定。信号 $x(t)$ 由 $X(\\omega)$ 的傅里叶逆变换给出：\n$$x(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} X(\\omega) e^{j\\omega t} d\\omega = \\frac{1}{2\\pi} \\int_{-\\omega_M}^{\\omega_M} X(\\omega) e^{j\\omega t} d\\omega$$\n其中 $\\omega_M = 0.4\\pi/T_{0}$。我们使用分部积分法，注意到 $e^{j\\omega t} = \\frac{1}{jt} \\frac{d}{d\\omega}e^{j\\omega t}$：\n$$x(t) = \\frac{1}{2\\pi} \\left[ X(\\omega) \\frac{e^{j\\omega t}}{jt} \\right]_{-\\omega_M}^{\\omega_M} - \\frac{1}{2\\pi jt} \\int_{-\\omega_M}^{\\omega_M} X'(\\omega) e^{j\\omega t} d\\omega$$\n问题陈述 $X(\\pm \\omega_M) = 0$，因此边界项为零。\n$$x(t) = -\\frac{1}{2\\pi jt} \\int_{-\\omega_M}^{\\omega_M} X'(\\omega) e^{j\\omega t} d\\omega$$\n我们再次应用分部积分法：\n$$x(t) = -\\frac{1}{2\\pi jt} \\left( \\left[ X'(\\omega) \\frac{e^{j\\omega t}}{jt} \\right]_{-\\omega_M}^{\\omega_M} - \\frac{1}{jt} \\int_{-\\omega_M}^{\\omega_M} X''(\\omega) e^{j\\omega t} d\\omega \\right)$$\n问题陈述 $X'(\\pm \\omega_M) = 0$，所以这个边界项也为零。\n$$x(t) = -\\frac{1}{2\\pi jt} \\left( -\\frac{1}{jt} \\int_{-\\omega_M}^{\\omega_M} X''(\\omega) e^{j\\omega t} d\\omega \\right) = \\frac{1}{2\\pi (jt)^2} \\int_{-\\omega_M}^{\\omega_M} X''(\\omega) e^{j\\omega t} d\\omega = -\\frac{1}{2\\pi t^2} \\int_{-\\omega_M}^{\\omega_M} X''(\\omega) e^{j\\omega t} d\\omega$$\n现在，我们对 $x(t)$ 的幅度进行限定：\n$$|x(t)| = \\left| -\\frac{1}{2\\pi t^2} \\int_{-\\omega_M}^{\\omega_M} X''(\\omega) e^{j\\omega t} d\\omega \\right| \\leq \\frac{1}{2\\pi t^2} \\int_{-\\omega_M}^{\\omega_M} |X''(\\omega) e^{j\\omega t}| d\\omega = \\frac{1}{2\\pi t^2} \\int_{-\\omega_M}^{\\omega_M} |X''(\\omega)| d\\omega$$\n由于 $X(\\omega)$ 是二次连续可微的，所以 $X''(\\omega)$ 在紧区间 $[-\\omega_M, \\omega_M]$ 上是连续的。因此，它是有界的。令 $M_2 = \\max_{\\omega \\in [-\\omega_M, \\omega_M]} |X''(\\omega)|$。该积分是有界的：$\\int_{-\\omega_M}^{\\omega_M} |X''(\\omega)| d\\omega \\leq M_2 (2\\omega_M)$。\n因此，对于 $t \\neq 0$：\n$$|x(t)| \\leq \\frac{2\\omega_M M_2}{2\\pi t^2} = \\frac{\\omega_M M_2}{\\pi t^2}$$\n这表明 $|x(t)|$ 以 $O(1/t^2)$ 的速率衰减。对于样本 $x(nT)$，其中 $n \\in \\mathbb{Z}$ 且 $n \\neq 0$：\n$$|x(nT)| \\leq \\frac{\\omega_M M_2}{\\pi (nT)^2} = \\frac{C_1}{n^2}$$\n其中 $C_1 = \\frac{\\omega_M M_2}{\\pi T^2}$ 是一个常数。\n\n接下来，我们考察大的 $|n|$ 时的 sinc 项，假设 $t/T$ 不是整数：\n$$\\left|\\operatorname{sinc}\\!\\left(\\frac{t-nT}{T}\\right)\\right| = \\left|\\operatorname{sinc}\\!\\left(\\frac{t}{T}-n\\right)\\right| = \\left| \\frac{\\sin(\\pi(t/T - n))}{\\pi(t/T - n)} \\right| = \\frac{|\\sin(\\pi t/T)|}{\\pi|t/T - n|}$$\n对于大的 $|n|$，该项的行为类似于：\n$$\\frac{|\\sin(\\pi t/T)|}{\\pi|n|} = \\frac{C_2}{|n|}$$\n其中 $C_2 = \\frac{|\\sin(\\pi t/T)|}{\\pi}$ 是一个常数。\n\n对于 $n \\neq 0$ 的绝对收敛级数的通项现在可以被限定：\n$$|a_n| = \\left|x(nT)\\,\\operatorname{sinc}\\!\\left(\\frac{t-nT}{T}\\right)\\right| \\leq \\left(\\frac{C_1}{n^2}\\right) \\left(\\frac{C_2}{|n|}\\right) = \\frac{C_1 C_2}{|n|^3}$$\n和式 $\\sum_{n\\in\\mathbb{Z}, n \\neq 0} |a_n|$ 的上界为 $2 \\sum_{n=1}^\\infty \\frac{C_1 C_2}{n^3}$。这是一个 p-级数，其中 $p=3$。由于 $p>1$，该级数收敛。根据比较判别法，级数 $\\sum_{n\\in\\mathbb{Z}, n\\neq 0} |a_n|$ 收敛。当 $n=0$ 时的项是 $|x(0)\\operatorname{sinc}(t/T)|$，是有限的。因此，整个级数绝对收敛。\n\n如果 $t/T$ 是一个整数，比如 $t/T = k$，那么 $t=kT$。级数变为 $\\sum_{n\\in\\mathbb{Z}} x(nT)\\operatorname{sinc}(k-n)$。由于当 $m=0$ 时 $\\operatorname{sinc}(m)=1$，而当 $m$ 为任意非零整数时 $\\operatorname{sinc}(m)=0$，所以该和式只有一个非零项 $x(kT)$，并且是平凡收敛的。证明完毕。", "answer": "$$\\boxed{\\frac{5}{2} T_{0}}$$", "id": "2904354"}, {"introduction": "虽然理论为我们提供了完美重建的公式，但通过数值实现它能带来更深刻、更具体的理解。这个实践首先要求从傅里叶基本原理推导出理想的 Sinc 插值核，然后应用所得的惠特克-香农公式编写代码。你将从离散样本中重建连续时间信号，并评估重建结果，从而在具体示例中观察理论的实际效果。[@problem_id:2904292]", "problem": "给定一个连续时间信号 $x(t)$，该信号严格带限于角频率 $|\\omega| \\le \\Omega_{\\mathrm{b}}$，其中 $\\Omega_{\\mathrm{b}} &lt; \\pi/T$，$T &gt; 0$ 是一个固定的采样周期。以速率 $1/T$ 进行理想冲激采样，生成离散时间样本 $x[n] = x(nT)$（对于所有整数 $n$）以及冲激串 $s(t) = \\sum_{n\\in\\mathbb{Z}} x[n] \\,\\delta(t - nT)$。你将 $s(t)$ 输入一个稳定的线性时不变 (LTI) 重构系统，该系统的冲激响应为 $h(t)$，以产生输出 $y(t)$。\n\n任务 1 (从基本原理推导)。从以下基本依据出发：\n- 连续时间傅里叶变换 (CTFT) 的定义：$X(\\omega) = \\int_{-\\infty}^{\\infty} x(t) e^{-j\\omega t}\\, dt$ 及其逆变换 $x(t) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} X(\\omega) e^{j\\omega t}\\, d\\omega$，\n- 冲激采样信号的频谱：$S(\\omega) = \\frac{1}{T}\\sum_{k\\in\\mathbb{Z}} X(\\omega - \\frac{2\\pi k}{T})$，\n- 频域中的 LTI 输入输出关系：$Y(\\omega) = H(\\omega) S(\\omega)$，\n\n在无混叠条件 $\\Omega_{\\mathrm{b}} &lt; \\pi/T$ 下，推导唯一的理想低通 $H(\\omega)$，使其对所有 $|\\omega| \\le \\Omega_{\\mathrm{b}}$ 都能实现完美重构 $Y(\\omega) = X(\\omega)$。此推导过程不得假定任何插值快捷公式。然后，推导相应的时域插值核 $h(t)$，并证明重构信号可以写成卷积叠加的形式\n$$\ny(t) = \\sum_{n\\in\\mathbb{Z}} x[n]\\, h(t - nT).\n$$\n你必须得到以归一化 sinc 函数 $\\operatorname{sinc}(u) = \\frac{\\sin(\\pi u)}{\\pi u}$ 表示的 $h(t)$ 的闭式形式。\n\n任务 2 (重构的数值计算)。使用任务 1 的结果，在指定时刻数值计算 $y(t)$。计算时，将无穷和替换为对称截断 $|n| \\le N$，其中 $N$ 为一个足够大的整数。使用任务 1 中的归一化 sinc 函数定义。对于以下所有计算，设置 $N = 2000$，并将报告的每个 $y(t)$ 值四舍五入到小数点后 9 位，采用标准的“舍入到最近，平局舍入到偶数”规则。\n\n角度量必须以弧度为单位进行解释。本问题不涉及物理单位。\n\n测试集。对于每个测试用例，离散时间序列 $x[n]$ 直接用 $n$、$T$ 和固定的实数参数指定。所有频率参数都严格在奈奎斯特极限 $1/(2T)$ 之内，确保 $\\Omega_{\\mathrm{b}} &lt; \\pi/T$。对于每个测试用例，使用 $N = 2000$ 的截断插值和，计算并报告在给定时间点的重构值列表 $[y(t_1),\\dots,y(t_m)]$。\n\n- 测试用例 A (多音，单位采样周期)：\n  - 参数：$T = 1$, $\\phi = \\pi/7$。\n  - 序列：$x[n] = \\cos(2\\pi \\cdot 0.2 \\cdot nT) + 0.5 \\,\\sin(2\\pi \\cdot 0.3 \\cdot nT + \\phi)$。\n  - 求值时间：$t \\in \\{0, 0.25, 0.5, 1.25, 2\\}$。\n\n- 测试用例 B (近奈奎斯特单音，单位采样周期)：\n  - 参数：$T = 1$。\n  - 序列：$x[n] = \\cos(2\\pi \\cdot 0.49 \\cdot nT)$。\n  - 求值时间：$t \\in \\{0, 0.5, 1, 1.5, 2\\}$。\n\n- 测试用例 C (非单位采样周期，包含直流(DC)分量和相位的复合信号)：\n  - 参数：$T = 0.8$, $\\theta = -\\pi/5$。\n  - 序列：$x[n] = 0.1 + 0.7 \\cos\\!\\big(2\\pi \\cdot 0.25 \\cdot (nT)\\big) + 0.4 \\sin\\!\\big(2\\pi \\cdot 0.6 \\cdot (nT) + \\theta\\big)$。\n  - 求值时间：$t \\in \\{0, 0.8, 1.6, 2.4, 4.0\\}$。\n\n计算说明。实现\n$$\ny(t) \\approx \\sum_{n=-N}^{N} x[n]\\, h(t - nT), \\quad h(t) = \\operatorname{sinc}\\!\\left(\\frac{t}{T}\\right),\n$$\n其中 $N = 2000$。尽可能使用向量化计算，以避免不必要的数值误差并确保计算效率。使用连续扩展 $\\operatorname{sinc}(0) = 1$ 来确保 $\\operatorname{sinc}(0)$ 的稳定求值。\n\n答案规格与输出格式。你的程序应生成单行输出，包含一个逗号分隔、无空格的嵌套列表形式的结果，格式如下\n$[[y\\_A(t\\_1),\\dots,y\\_A(t\\_5)],[y\\_B(t\\_1),\\dots,y\\_B(t\\_5)],[y\\_C(t\\_1),\\dots,y\\_C(t\\_5)]]$,\n其中每个内部列表分别对应测试用例 A、B 和 C，每个数值条目是一个四舍五入到小数点后 9 位的十进制字符串。例如，一个正确形状的输出行看起来像 $[[0.000000000,1.234000000],[...],[...]]$，但其中的值应为三个测试用例的实际计算值。", "solution": "本问题是有效的，因为它在信号处理原理上有科学依据，提法得当且客观。它为理论推导和数值计算提供了所有必要的信息。我们将着手求解。\n\n**任务 1：理想重构滤波器和插值公式的推导**\n\n目标是找到一个冲激响应为 $h(t)$ 的线性时不变 (LTI) 系统，该系统能从其样本 $x[n] = x(nT)$ 中完美重构连续时间信号 $x(t)$。该重构系统的输入是一个冲激串 $s(t) = \\sum_{n\\in\\mathbb{Z}} x[n] \\delta(t-nT)$。\n\n此推导的基础是给定的频域关系：\n1.  输出频谱 $Y(\\omega)$ 与输入频谱 $S(\\omega)$ 和系统的频率响应 $H(\\omega)$ 之间的关系为 $Y(\\omega) = H(\\omega) S(\\omega)$。\n2.  冲激串的频谱 $S(\\omega)$ 是原始信号频谱 $X(\\omega)$ 的周期性复制：\n    $$S(\\omega) = \\frac{1}{T}\\sum_{k\\in\\mathbb{Z}} X\\left(\\omega - \\frac{2\\pi k}{T}\\right)$$\n    其中 $T$ 是采样周期。令 $\\omega_s = 2\\pi/T$ 为采样角频率。因此关系式为 $S(\\omega) = \\frac{1}{T}\\sum_{k\\in\\mathbb{Z}} X(\\omega - k\\omega_s)$。\n\n信号 $x(t)$ 严格带限于 $|\\omega| \\le \\Omega_{\\mathrm{b}}$，意味着其连续时间傅里叶变换 (CTFT) $X(\\omega)$ 对于所有 $|\\omega| > \\Omega_{\\mathrm{b}}$ 均为零。问题陈述了无混叠条件 $\\Omega_{\\mathrm{b}} < \\pi/T$，这等价于 $\\Omega_{\\mathrm{b}} < \\omega_s/2$。此条件确保 $S(\\omega)$ 中的频谱复制不发生重叠。第 $k$ 个复制 $X(\\omega - k\\omega_s)$ 的频谱支撑区是区间 $[k\\omega_s - \\Omega_{\\mathrm{b}}, k\\omega_s + \\Omega_{\\mathrm{b}}]$。由于无混叠条件，基带频谱（$k=0$，以 $\\omega=0$ 为中心）和一次谐波复制（$k=\\pm 1$，以 $\\omega=\\pm\\omega_s$ 为中心）是不相交的。具体来说，基带频谱在 $\\Omega_{\\mathrm{b}}$ 处结束，而第一个复制从 $\\omega_s - \\Omega_{\\mathrm{b}}$ 开始。因为 $\\Omega_{\\mathrm{b}} < \\omega_s/2$，我们有 $\\omega_s - \\Omega_{\\mathrm{b}} > \\omega_s - \\omega_s/2 = \\omega_s/2 > \\Omega_{\\mathrm{b}}$。\n\n完美重构要求输出信号 $y(t)$ 与原始信号 $x(t)$ 完全相同，这意味着它们的频谱必须相等：对所有 $\\omega$，都有 $Y(\\omega) = X(\\omega)$。\n\n结合给定的关系，我们要求：\n$$X(\\omega) = H(\\omega) S(\\omega) = H(\\omega) \\left[ \\frac{1}{T}\\sum_{k\\in\\mathbb{Z}} X(\\omega - k\\omega_s) \\right]$$\n\n为满足此等式，我们设计的滤波器 $H(\\omega)$ 需要执行两个功能：\n1.  隔离 $S(\\omega)$ 的基带分量（$k=0$ 项）。\n2.  缩放该分量以恢复原始频谱 $X(\\omega)$。\n\n我们定义一个截止频率为 $\\omega_c$ 的理想低通滤波器。为了隔离仅在 $|\\omega| \\le \\Omega_{\\mathrm{b}}$ 范围内非零的基带分量，同时完全抑制所有高频复制（其中第一个从 $\\omega_s - \\Omega_{\\mathrm{b}}$ 开始），我们必须选择一个截止频率 $\\omega_c$ 满足 $\\Omega_{\\mathrm{b}} \\le \\omega_c \\le \\omega_s - \\Omega_{\\mathrm{b}}$。一个不依赖于具体 $\\Omega_{\\mathrm{b}}$ 的规范选择是奈奎斯特频率，$\\omega_c = \\omega_s/2 = \\pi/T$。\n\n对于通带内的频率 $|\\omega| \\le \\pi/T$，由于无混叠条件，所有 $k \\neq 0$ 的项在该范围内均为零，因此求和 $\\sum_{k\\in\\mathbb{Z}} X(\\omega - k\\omega_s)$ 简化为单项 $X(\\omega)$。因此，对于 $|\\omega| \\le \\pi/T$，重构方程变为：\n$$X(\\omega) = H(\\omega) \\left( \\frac{1}{T} X(\\omega) \\right)$$\n为使此式对任何非平凡的 $X(\\omega)$ 成立，滤波器在该频带内的响应必须是 $H(\\omega) = T$。\n\n对于此通带外的所有频率 $|\\omega| > \\pi/T$，滤波器必须具有零增益以消除不需要的频谱复制。因此，唯一的理想低通滤波器频率响应为：\n$$H(\\omega) = \\begin{cases} T & \\text{if } |\\omega| \\le \\pi/T \\\\ 0 & \\text{if } |\\omega| > \\pi/T \\end{cases}$$\n这是一个宽度为 $2\\pi/T$、高度为 $T$ 的矩形函数。\n\n接着，我们通过对 $H(\\omega)$ 取逆连续时间傅里叶变换 (inverse CTFT) 来推导相应的冲激响应 $h(t)$：\n$$h(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} H(\\omega) e^{j\\omega t} \\,d\\omega$$\n代入 $H(\\omega)$ 的表达式：\n$$h(t) = \\frac{1}{2\\pi} \\int_{-\\pi/T}^{\\pi/T} T e^{j\\omega t} \\,d\\omega = \\frac{T}{2\\pi} \\left[ \\frac{e^{j\\omega t}}{jt} \\right]_{-\\pi/T}^{\\pi/T}$$\n对于 $t \\neq 0$：\n$$h(t) = \\frac{T}{2\\pi j t} \\left( e^{j\\pi t/T} - e^{-j\\pi t/T} \\right)$$\n使用欧拉公式 $e^{j\\theta} - e^{-j\\theta} = 2j\\sin(\\theta)$：\n$$h(t) = \\frac{T}{2\\pi j t} \\left( 2j \\sin\\left(\\frac{\\pi t}{T}\\right) \\right) = \\frac{T}{\\pi t} \\sin\\left(\\frac{\\pi t}{T}\\right)$$\n为了用归一化 sinc 函数 $\\operatorname{sinc}(u) = \\frac{\\sin(\\pi u)}{\\pi u}$ 表示，我们重排该表达式：\n$$h(t) = \\frac{\\sin\\left(\\pi \\frac{t}{T}\\right)}{\\frac{\\pi t}{T}} = \\operatorname{sinc}\\left(\\frac{t}{T}\\right)$$\n对于 $t=0$，该值可以通过取极限或从积分中得到：$h(0) = \\frac{1}{2\\pi}\\int_{-\\pi/T}^{\\pi/T} T \\,d\\omega = \\frac{T}{2\\pi} \\left( \\frac{2\\pi}{T} \\right) = 1$。这对应于 $\\operatorname{sinc}(0)=1$。\n\n最后，我们证明重构信号 $y(t)$ 可表示为卷积叠加。输出 $y(t)$ 是输入冲激串 $s(t)$ 与滤波器冲激响应 $h(t)$ 的卷积：\n$$y(t) = s(t) * h(t) = \\int_{-\\infty}^{\\infty} s(\\tau) h(t - \\tau) \\,d\\tau$$\n代入 $s(t) = \\sum_{n\\in\\mathbb{Z}} x[n] \\delta(t - nT)$ 的定义：\n$$y(t) = \\int_{-\\infty}^{\\infty} \\left( \\sum_{n\\in\\mathbb{Z}} x[n] \\delta(\\tau - nT) \\right) h(t - \\tau) \\,d\\tau$$\n根据线性性质，我们可以交换求和与积分的顺序：\n$$y(t) = \\sum_{n\\in\\mathbb{Z}} x[n] \\int_{-\\infty}^{\\infty} \\delta(\\tau - nT) h(t - \\tau) \\,d\\tau$$\n使用狄拉克 $\\delta$ 函数的筛选性质 $\\int_{-\\infty}^{\\infty} f(\\tau) \\delta(\\tau - a) \\,d\\tau = f(a)$，其中 $f(\\tau) = h(t-\\tau)$ 且 $a=nT$：\n$$y(t) = \\sum_{n\\in\\mathbb{Z}} x[n] h(t - nT)$$\n这就完成了 Whittaker-Shannon 插值公式的推导。\n\n**任务 2：数值计算**\n\n上述推导出的公式通过将无穷和截断为对称窗口 $|n| \\le N$（其中 $N=2000$）来实现。在时刻 $t$ 的重构信号近似为：\n$$y(t) \\approx \\sum_{n=-N}^{N} x[n] \\operatorname{sinc}\\left(\\frac{t - nT}{T}\\right)$$\n使用此公式对所提供的测试用例进行求值。该实现利用向量化运算以提高效率，并使用 `numpy.sinc` 来稳定、准确地计算归一化 sinc 函数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the signal reconstruction problem for the three given test cases.\n    \"\"\"\n    N = 2000\n    n_range = np.arange(-N, N + 1)\n\n    # --- Test Case A ---\n    T_A = 1.0\n    phi_A = np.pi / 7.0\n    times_A = [0.0, 0.25, 0.5, 1.25, 2.0]\n    \n    # Generate the samples x[n] for case A\n    nT_A = n_range * T_A\n    x_n_A = np.cos(2 * np.pi * 0.2 * nT_A) + 0.5 * np.sin(2 * np.pi * 0.3 * nT_A + phi_A)\n    \n    results_A = []\n    for t in times_A:\n        # Calculate kernel values h(t - nT)\n        sinc_arg_A = (t - nT_A) / T_A\n        h_vals_A = np.sinc(sinc_arg_A)\n        # Compute y(t) as the dot product (sum of products)\n        y_t = np.dot(x_n_A, h_vals_A)\n        results_A.append(y_t)\n\n    # --- Test Case B ---\n    T_B = 1.0\n    times_B = [0.0, 0.5, 1.0, 1.5, 2.0]\n    \n    # Generate the samples x[n] for case B\n    nT_B = n_range * T_B\n    x_n_B = np.cos(2 * np.pi * 0.49 * nT_B)\n    \n    results_B = []\n    for t in times_B:\n        # Calculate kernel values h(t - nT)\n        sinc_arg_B = (t - nT_B) / T_B\n        h_vals_B = np.sinc(sinc_arg_B)\n        # Compute y(t)\n        y_t = np.dot(x_n_B, h_vals_B)\n        results_B.append(y_t)\n\n    # --- Test Case C ---\n    T_C = 0.8\n    theta_C = -np.pi / 5.0\n    times_C = [0.0, 0.8, 1.6, 2.4, 4.0]\n\n    # Generate the samples x[n] for case C\n    nT_C = n_range * T_C\n    x_n_C = 0.1 + 0.7 * np.cos(2 * np.pi * 0.25 * nT_C) + 0.4 * np.sin(2 * np.pi * 0.6 * nT_C + theta_C)\n\n    results_C = []\n    for t in times_C:\n        # Calculate kernel values h(t - nT)\n        sinc_arg_C = (t - nT_C) / T_C\n        h_vals_C = np.sinc(sinc_arg_C)\n        # Compute y(t)\n        y_t = np.dot(x_n_C, h_vals_C)\n        results_C.append(y_t)\n\n    all_results = [results_A, results_B, results_C]\n\n    # Format the output string according to the specification.\n    # The f-string format specifier .9f rounds to 9 decimal places using\n    # standard rounding (round half to even), as required.\n    output_str = f\"[{','.join([f'[{\",\".join([f\"{val:.9f}\" for val in res_list])}]' for res_list in all_results])}]\"\n    \n    print(output_str)\n\nsolve()\n```", "id": "2904292"}, {"introduction": "理想的重建滤波器是一个理论上的完美模型，而现实世界的系统则使用物理上可实现的滤波器，这必然会引入误差。在这个练习中，你将跳出理想“砖墙”滤波器的框架，分析使用一个简单而实用的一阶RC低通滤波器进行信号重建时的性能。你的任务是解析计算其均方误差，需要同时考虑带内信号失真和带外混叠噪声的影响，从而深入理解从理想到实践的性能折衷。[@problem_id:1728147]", "problem": "一个实值连续时间广义平稳 (WSS) 随机信号 $x_c(t)$，已知其带限于最大角频率 $\\omega_M$。其功率谱密度在 $|\\omega| \\leq \\omega_M$ 时为常数 $\\Phi_{xx}(\\omega) = N_0$，在其他频率下为零。该信号以奈奎斯特速率 $T_s = \\pi/\\omega_M$ 进行采样，生成离散时间序列 $x_d[n] = x_c(nT_s)$。\n\n现尝试从其采样值中重建原始信号。重建滤波器并非理想的砖墙滤波器，而是一个经过缩放的一阶电阻-电容 (RC) 低通滤波器。基本 RC 滤波器的传递函数为 $H(j\\omega) = \\frac{1}{1+j\\omega\\tau}$，其中 $\\tau$ 是时间常数。针对此特定应用，进行了两项修改：\n1. 滤波器的 3-dB 截止频率 $\\omega_c = 1/\\tau$ 被设置为信号最大频率的一部分，使得 $\\omega_c = \\frac{1}{\\sqrt{3}} \\omega_M$。\n2. 滤波器通过一个增益常数 $K$ 进行缩放，使其直流增益 $K H(0)$ 与理想重建滤波器所需的直流增益（即采样周期 $T_s$）相匹配。最终的重建滤波器为 $G(j\\omega) = K H(j\\omega)$。\n\n重建信号 $x_r(t)$ 是当此滤波器的输入为由采样值加权的冲激串，即 $x_s(t) = \\sum_{n=-\\infty}^{\\infty} x_d[n] \\delta(t - nT_s)$ 时，该滤波器的输出。\n\n确定重建的归一化均方误差 (NMSE)。NMSE 定义为误差信号 $e(t) = x_r(t) - x_c(t)$ 的平均功率与原始信号 $x_c(t)$ 的平均功率之比。您的答案应为一个单一的闭式解析表达式。", "solution": "连续时间 WSS 输入的功率谱密度在 $|\\omega|\\leq \\omega_M$ 时为 $\\Phi_{xx}(\\omega)=N_0$，在其他频率下为零。采样周期为 $T_s=\\pi/\\omega_M$，因此采样角频率为 $\\omega_s=2\\pi/T_s=2\\omega_M$。采样信号的频谱为\n$$\nX_s(j\\omega)=\\frac{1}{T_s}\\sum_{k=-\\infty}^{\\infty}X_c\\left(j(\\omega-k\\omega_s)\\right).\n$$\n重建滤波器为 $G(j\\omega)=K H(j\\omega)$，其中 $H(j\\omega)=\\frac{1}{1+j\\omega\\tau}$，$\\omega_c=\\frac{1}{\\tau}=\\frac{1}{\\sqrt{3}}\\omega_M$，因此 $\\tau=\\frac{\\sqrt{3}}{\\omega_M}$。选择 $K$ 使得 $K H(0)=T_s$，这给出 $K=T_s$。因此\n$$\nG(j\\omega)=\\frac{T_s}{1+j\\omega\\tau}。\n$$\n重建信号的频谱为\n$$\nX_r(j\\omega)=G(j\\omega)X_s(j\\omega)=\\frac{G(j\\omega)}{T_s}\\sum_{k=-\\infty}^{\\infty}X_c\\left(j(\\omega-k\\omega_s)\\right).\n$$\n对于 $|\\omega|\\leq \\omega_M$，不存在混叠（因为 $\\omega_s=2\\omega_M$），因此只有 $k=0$ 项有贡献，并且\n$$\nX_r(j\\omega)=\\frac{G(j\\omega)}{T_s}X_c(j\\omega)=\\frac{1}{1+j\\omega\\tau}X_c(j\\omega),\\quad |\\omega|\\leq \\omega_M.\n$$\n因此带内误差频谱为\n$$\nE(j\\omega)=X_r(j\\omega)-X_c(j\\omega)=\\left(\\frac{1}{1+j\\omega\\tau}-1\\right)X_c(j\\omega)=-\\frac{j\\omega\\tau}{1+j\\omega\\tau}X_c(j\\omega),\n$$\n所以带内误差功率谱密度为\n$$\n\\Phi_{ee}^{\\text{in}}(\\omega)=\\left|\\frac{j\\omega\\tau}{1+j\\omega\\tau}\\right|^2\\Phi_{xx}(\\omega)=\\frac{\\omega^2\\tau^2}{1+\\omega^2\\tau^2}\\,N_0,\\quad |\\omega|\\leq \\omega_M.\n$$\n对于 $|\\omega|>\\omega_M$，原始信号没有内容，但重建输出包含滤波后的镜像。因为 $\\omega_s=2\\omega_M$，所以 $k\\neq 0$ 的镜像频带无重叠地覆盖了区域 $|\\omega|\\geq \\omega_M$。在这些区域中，误差等于输出，其功率谱密度为\n$$\n\\Phi_{ee}^{\\text{out}}(\\omega)=\\left|\\frac{G(j\\omega)}{T_s}\\right|^2N_0=\\frac{1}{1+\\omega^2\\tau^2}\\,N_0,\\quad |\\omega|\\geq \\omega_M.\n$$\n因此，均方误差功率为\n$$\nP_e=\\frac{1}{2\\pi}\\left[\\int_{-\\omega_M}^{\\omega_M}\\frac{\\omega^2\\tau^2}{1+\\omega^2\\tau^2}\\,N_0\\,d\\omega+\\int_{|\\omega|\\geq \\omega_M}\\frac{1}{1+\\omega^2\\tau^2}\\,N_0\\,d\\omega\\right].\n$$\n使用恒等式\n$$\n\\frac{\\omega^2\\tau^2}{1+\\omega^2\\tau^2}=1-\\frac{1}{1+\\omega^2\\tau^2},\\quad \\int\\frac{d\\omega}{1+\\omega^2\\tau^2}=\\frac{1}{\\tau}\\arctan(\\omega\\tau),\\quad \\int_{-\\infty}^{\\infty}\\frac{d\\omega}{1+\\omega^2\\tau^2}=\\frac{\\pi}{\\tau},\n$$\n我们得到\n$$\n\\int_{-\\omega_M}^{\\omega_M}\\frac{\\omega^2\\tau^2}{1+\\omega^2\\tau^2}\\,d\\omega=2\\omega_M-\\frac{2}{\\tau}\\arctan(\\omega_M\\tau),\n$$\n$$\n\\int_{|\\omega|\\geq \\omega_M}\\frac{d\\omega}{1+\\omega^2\\tau^2}=\\frac{\\pi}{\\tau}-\\frac{2}{\\tau}\\arctan(\\omega_M\\tau).\n$$\n因此\n$$\nP_e=\\frac{N_0}{2\\pi}\\left[2\\omega_M+\\frac{\\pi}{\\tau}-\\frac{4}{\\tau}\\arctan(\\omega_M\\tau)\\right].\n$$\n原始信号的功率为\n$$\nP_x=\\frac{1}{2\\pi}\\int_{-\\omega_M}^{\\omega_M}N_0\\,d\\omega=\\frac{N_0\\omega_M}{\\pi}.\n$$\n因此归一化均方误差为\n$$\n\\text{NMSE}=\\frac{P_e}{P_x}=\\frac{1}{2\\omega_M}\\left[2\\omega_M+\\frac{\\pi}{\\tau}-\\frac{4}{\\tau}\\arctan(\\omega_M\\tau)\\right].\n$$\n当 $\\tau=\\sqrt{3}/\\omega_M$ 时，我们有 $\\omega_M\\tau=\\sqrt{3}$ 并且 $\\arctan(\\sqrt{3})=\\pi/3$，这得出\n$$\n\\text{NMSE}=1+\\frac{1}{2\\omega_M\\tau}\\left[\\pi-4\\arctan(\\omega_M\\tau)\\right]=1+\\frac{1}{2\\sqrt{3}}\\left[\\pi-\\frac{4\\pi}{3}\\right]=1-\\frac{\\pi}{6\\sqrt{3}}.\n$$\n这是一个闭式解析表达式，与 $N_0$ 和 $\\omega_M$ 无关。", "answer": "$$\\boxed{1-\\frac{\\pi}{6\\sqrt{3}}}$$", "id": "1728147"}]}