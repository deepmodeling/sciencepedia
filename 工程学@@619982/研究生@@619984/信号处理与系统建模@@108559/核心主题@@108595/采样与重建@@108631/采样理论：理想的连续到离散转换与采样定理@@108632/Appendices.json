{"hands_on_practices": [{"introduction": "要真正掌握采样理论，第一步是亲手计算混叠效应。本练习提供了一个具体的场景：一个带外干扰信号在采样后如何“伪装”成一个带内的频率。通过这个计算，您将清晰地理解频率折叠的机制，这是在数字信号处理系统中诊断和防止混叠问题的核心技能。[@problem_id:2902675]", "problem": "一个实值连续时间测量值 $x_{c}(t)$ 是一个期望的、严格带限分量 $s_{c}(t)$ 与一个形式为 $i_{c}(t) = A_{i} \\cos(\\omega_{i} t + \\varphi)$（其中相位 $\\varphi$ 未知）的窄带干扰 $i_{c}(t)$ 之和。该测量值以采样周期 $T$ 进行理想采样，形成离散时间序列 $x[n] = x_{c}(nT)$。然后，该离散时间序列由一个理想、零相位的离散时间低通滤波器处理，该滤波器在 $|\\Omega| \\leq \\Omega_{p}$ 范围内具有单位增益，在 $|\\Omega| > \\Omega_{p}$ 范围内具有零增益，其中 $\\Omega$ 是离散时间角频率，单位为弧度/样本。\n\n给定以下参数值：\n- 采样周期 $T = 4.0 \\times 10^{-4}\\ \\text{s}$，因此采样角频率为 $\\omega_{s} = \\frac{2\\pi}{T}$，连续时间奈奎斯特角频率为 $\\frac{\\pi}{T}$。\n- 干扰角频率 $\\omega_{i} = 1.2000 \\times 10^{4}\\ \\text{rad/s}$，满足 $\\omega_{i} > \\frac{\\pi}{T}$。\n- 干扰峰值幅度 $A_{i} = 0.7500\\ \\text{V}$。\n- 理想离散时间低通滤波器通带边缘 $\\Omega_{p} = 1.5000\\ \\text{rad/sample}$。\n\n从理想采样的第一性原理以及理想采样所蕴含的连续时间频率与离散时间（归一化）频率之间的关系出发，确定：\n1. 干扰的混叠离散时间角频率 $\\Omega_{\\text{alias}}$，作为区间 $[-\\pi,\\pi)$ 内的主值，以弧度/样本为单位表示。\n2. 理想离散时间低通滤波器输出端的干扰分量的峰值幅度，以伏特为单位表示。\n\n将你的最终结果以双元素行向量 $\\bigl[\\ \\Omega_{\\text{alias}},\\ A_{\\text{res}}\\ \\bigr]$ 的形式报告，其中 $A_{\\text{res}}$ 是所要求的残余峰值幅度。将两个元素都四舍五入到四位有效数字。将第一个元素以弧度/样本为单位表示，第二个元素以伏特为单位表示。", "solution": "该问题在信号处理和系统建模领域内提法恰当且具有科学依据。所有必要数据均已提供，且无矛盾之处。我们开始进行求解。\n\n连续时间测量值由 $x_{c}(t) = s_{c}(t) + i_{c}(t)$ 给出，其中 $s_{c}(t)$ 是一个期望的带限信号，而 $i_{c}(t)$ 是一个窄带干扰。本分析将只关注干扰分量，其表达式为：\n$$i_{c}(t) = A_{i} \\cos(\\omega_{i} t + \\varphi)$$\n给定的干扰参数为其峰值幅度 $A_{i} = 0.7500\\ \\text{V}$ 和其连续时间角频率 $\\omega_{i} = 1.2000 \\times 10^{4}\\ \\text{rad/s}$。\n\n信号 $x_{c}(t)$ 经过采样周期为 $T = 4.0 \\times 10^{-4}\\ \\text{s}$ 的理想采样。得到的离散时间序列为 $x[n] = x_{c}(nT)$。该序列中的干扰分量记作 $i[n]$，通过将 $t = nT$ 代入 $i_{c}(t)$ 的表达式得到：\n$$i[n] = i_{c}(nT) = A_{i} \\cos(\\omega_{i} nT + \\varphi)$$\n该表达式是离散时间正弦波的标准形式 $A \\cos(\\Omega n + \\phi)$，其中 $\\Omega$ 是离散时间角频率，单位为弧度/样本。通过比较，干扰的离散时间角频率为：\n$$\\Omega = \\omega_{i} T$$\n代入给定值：\n$$\\Omega = (1.2000 \\times 10^{4}\\ \\text{rad/s}) \\times (4.0 \\times 10^{-4}\\ \\text{s}) = 4.8\\ \\text{rad/sample}$$\n\n在离散时间信号处理中，频率以 $2\\pi$ 为周期。这意味着频率 $\\Omega$ 与任何频率 $\\Omega + 2\\pi k$（对于任意整数 $k$）是无法区分的。主混叠频率 $\\Omega_{\\text{alias}}$ 是与 $\\Omega$ 等效且位于区间 $[-\\pi, \\pi)$ 内的唯一频率。我们必须找到一个整数 $k$ 使得：\n$$-\\pi \\leq \\Omega - 2\\pi k < \\pi$$\n代入 $\\Omega = 4.8$：\n$$-\\pi \\leq 4.8 - 2\\pi k < \\pi$$\n我们可以求解 $k$。重新整理该不等式：\n$$4.8 - \\pi < 2\\pi k \\leq 4.8 + \\pi$$\n$$\\frac{4.8 - \\pi}{2\\pi} < k \\leq \\frac{4.8 + \\pi}{2\\pi}$$\n使用值 $\\pi \\approx 3.14159$：\n$$\\frac{4.8 - 3.14159}{6.28318} < k \\leq \\frac{4.8 + 3.14159}{6.28318}$$\n$$0.264 < k \\leq 1.264$$\n满足此条件的唯一整数值是 $k=1$。\n\n因此，主混叠角频率为：\n$$\\Omega_{\\text{alias}} = \\Omega - 2\\pi(1) = 4.8 - 2\\pi$$\n数值上，$\\Omega_{\\text{alias}} \\approx 4.8 - 6.283185 = -1.483185\\ \\text{rad/sample}$。\n第一个要求的结果，四舍五入到四位有效数字，是 $\\Omega_{\\text{alias}} = -1.483\\ \\text{rad/sample}$。\n\n接下来，我们必须确定干扰分量在通过一个理想、零相位的离散时间低通滤波器后的峰值幅度。该滤波器的频率响应幅值 $|H(\\Omega)|$ 定义为：\n$$|H(\\Omega)| = \\begin{cases} 1 & |\\Omega| \\leq \\Omega_{p} \\\\ 0 & |\\Omega| > \\Omega_{p} \\end{cases}$$\n其中通带边缘给定为 $\\Omega_{p} = 1.5000\\ \\text{rad/sample}$。\n\nLTI滤波器对正弦输入的作用是将其幅度乘以滤波器在该正弦波频率处的频率响应幅值。离散时间干扰信号 $i[n] = A_{i} \\cos(\\Omega_{\\text{alias}} n + \\varphi)$ 的能量位于频率 $\\pm\\Omega_{\\text{alias}}$ 处。为了确定干扰是被滤波器通过还是被滤除，我们必须将其频率的绝对值 $|\\Omega_{\\text{alias}}|$ 与滤波器的通带边缘 $\\Omega_{p}$ 进行比较。\n$$|\\Omega_{\\text{alias}}| = |4.8 - 2\\pi| \\approx |-1.483185| = 1.483185\\ \\text{rad/sample}$$\n我们将此值与通带边缘进行比较：\n$$|\\Omega_{\\text{alias}}| \\approx 1.483185 < 1.5000 = \\Omega_{p}$$\n由于混叠频率的绝对值在滤波器的通带内，滤波器对干扰分量施加的增益为 $|H(\\Omega_{\\text{alias}})| = 1$。由于滤波器是零相位的，它不引入相位偏移。\n\n因此，滤波器输出端的干扰分量 $i_{\\text{res}}[n]$ 为：\n$$i_{\\text{res}}[n] = |H(\\Omega_{\\text{alias}})| \\cdot A_{i} \\cos(\\Omega_{\\text{alias}} n + \\varphi) = 1 \\cdot A_{i} \\cos(\\Omega_{\\text{alias}} n + \\varphi)$$\n这个残余干扰的峰值幅度 $A_{\\text{res}}$ 就等于 $A_{i}$。\n$$A_{\\text{res}} = A_{i} = 0.7500\\ \\text{V}$$\n这个值已经是以四位有效数字给出的。\n\n最终结果是双元素行向量 $[\\Omega_{\\text{alias}}, A_{\\text{res}}]$，其值已四舍五入到四位有效数字。\n$\\Omega_{\\text{alias}} \\approx -1.483$\n$A_{\\text{res}} = 0.7500$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1.483 & 0.7500\n\\end{pmatrix}\n}\n$$", "id": "2902675"}, {"introduction": "真实世界的信号通常是随机的，抗混叠滤波器也并非理想的“砖墙”滤波器。本练习将引导您从确定性正弦波过渡到更实际的随机过程分析。您将推导均方重建误差，它量化了两种主要的误差来源：未被捕获的带外能量和由不完美滤波引起的带内混叠，这项实践对于评估实际采样系统的性能至关重要。[@problem_id:2902649]", "problem": "考虑一个实值、零均值、宽平稳 (WSS) 随机过程，其功率谱密度 (PSD) $S_{x}(f)$ 由下式给出：\n$$\nS_{x}(f)=\n\\begin{cases}\nS_{0}, & |f|\\leq B \\\\\nS_{0}\\left(\\dfrac{B}{|f|}\\right)^{2}, & |f|>B\n\\end{cases}\n$$\n其中 $S_{0}>0$ 和 $B>0$ 是常数。该过程通过一个模拟抗混叠滤波器，其频率响应 $H_{a}(f)$ 满足：\n$$\nH_{a}(f)=\n\\begin{cases}\n1, & |f|\\leq B \\\\\n\\alpha, & |f|>B\n\\end{cases}\n$$\n其中 $0<\\alpha<1$。滤波后的信号随后以速率 $f_{s}=2B$ 进行采样，并通过一个单位增益、截止频率为 $B$ 的理想连续时间砖墙式低通滤波器进行重构。\n\n仅使用采样理论和随机过程的基本定义（即，理想冲激采样引起的频域复制、线性时不变滤波对功率谱密度的影响，以及宽平稳过程的功率谱密度与其均方值之间的关系），推导均方重构误差\n$$\n\\mathbb{E}\\big[(x(t)-y(t))^{2}\\big],\n$$\n其中 $x(t)$ 是原始过程， $y(t)$ 是重构信号。将你的最终答案表示为关于 $S_{0}$、$B$ 和 $\\alpha$ 的单个闭式符号表达式。无需进行数值计算或四舍五入。以与 $S_{0}$ 一致的功率单位陈述你的答案（在最终的方框表达式中不要包含单位符号）。", "solution": "所陈述的问题具有科学依据、提法恰当、客观，并包含了获得唯一解所需的所有信息。这是采样系统中随机过程分析的一个标准问题。因此，该问题被认为是有效的。\n\n目标是计算均方重构误差 $\\mathcal{E}$，其定义为 $\\mathbb{E}[(x(t)-y(t))^{2}]$，其中 $x(t)$ 是原始的宽平稳 (WSS) 随机过程，而 $y(t)$ 是经过抗混叠滤波、采样和低通滤波后重构的信号。对于一个宽平稳过程，其均方值等于总功率，这可以通过对功率谱密度 (PSD) 在所有频率上积分得到。令 $e(t) = x(t) - y(t)$ 为误差信号。那么均方误差为 $\\mathcal{E} = R_e(0) = \\int_{-\\infty}^{\\infty} S_e(f) df$，其中 $S_e(f)$ 是误差信号的功率谱密度。\n\n我们可以将总误差分解为两个分量。令 $x_B(t)$ 为原始信号 $x(t)$ 的理想带限版本，通过将 $x(t)$ 通过一个截止频率为 $B$ 的理想低通滤波器获得。误差可以写为：\n$$\ne(t) = x(t) - y(t) = (x(t) - x_B(t)) + (x_B(t) - y(t))\n$$\n第一项，$e_{out}(t) = x(t) - x_B(t)$，表示原始信号 $x(t)$ 中位于重构频带 $[-B, B]$ 之外的分量。其频谱仅在 $|f| > B$ 时非零。\n第二项，$e_{in}(t) = x_B(t) - y(t)$，表示理想带内信号与重构信号之间的差异。根据定义，$x_B(t)$ 和 $y(t)$ 都被带限在区间 $[-B, B]$ 内。因此，$e_{in}(t)$ 的频谱仅在 $|f| \\leq B$ 时非零。\n\n由于两个误差分量 $e_{out}(t)$ 和 $e_{in}(t)$ 占据不相交的频带，它们是正交的。总均方误差是它们各自功率的和：\n$$\n\\mathcal{E} = \\mathbb{E}[e(t)^2] = \\mathbb{E}[e_{out}(t)^2] + \\mathbb{E}[e_{in}(t)^2]\n$$\n\n首先，我们计算带外误差的功率，$\\mathcal{E}_{out} = \\mathbb{E}[e_{out}(t)^2]$。这是原始信号 $x(t)$ 在频带 $[-B, B]$ 之外的功率。\n$$\n\\mathcal{E}_{out} = \\int_{|f|>B} S_x(f) df = 2 \\int_{B}^{\\infty} S_x(f) df\n$$\n使用给定的对于 $|f|>B$ 的功率谱密度 $S_x(f) = S_{0}(B/|f|)^{2}$：\n$$\n\\mathcal{E}_{out} = 2 \\int_{B}^{\\infty} S_{0} \\frac{B^2}{f^2} df = 2 S_0 B^2 \\left[ -\\frac{1}{f} \\right]_{B}^{\\infty} = 2 S_0 B^2 \\left( 0 - \\left(-\\frac{1}{B}\\right) \\right) = 2 S_0 B\n$$\n\n其次，我们计算带内误差的功率，$\\mathcal{E}_{in} = \\mathbb{E}[e_{in}(t)^2]$。此误差源于频带 $[-B, B]$ 内采样和重构过程的不完美。理想的带内信号是 $x_B(t)$，其功率谱密度对于 $|f| \\le B$ 为 $S_{x_B}(f) = S_x(f) = S_0$。重构信号 $y(t)$ 是由抗混叠信号 $x_a(t)$ 的样本生成的。$x_a(t)$ 的功率谱密度为 $S_{x_a}(f) = |H_a(f)|^2 S_x(f)$。\n给定 $H_a(f)$ 和 $S_x(f)$，我们有：\n$$\nS_{x_a}(f) =\n\\begin{cases}\n1^2 \\cdot S_0, & |f|\\leq B \\\\\n\\alpha^2 \\cdot S_{0}\\left(\\dfrac{B}{|f|}\\right)^{2}, & |f|>B\n\\end{cases}\n=\n\\begin{cases}\nS_0, & |f|\\leq B \\\\\n\\alpha^2 S_{0}\\dfrac{B^2}{f^2}, & |f|>B\n\\end{cases}\n$$\n当 $x_a(t)$ 以 $f_s = 2B$ 采样并使用截止频率为 $B$ 的理想低通滤波器重构时，所得信号 $y(t)$ 在频带 $|f| \\le B$ 内的功率谱密度是基带频谱与来自更高频率的折叠（混叠）频谱之和。\n$$\nS_y(f) = \\sum_{k=-\\infty}^{\\infty} S_{x_a}(f - kf_s) = \\sum_{k=-\\infty}^{\\infty} S_{x_a}(f - 2kB) \\quad \\text{for } |f| \\le B\n$$\n我们可以将 $k=0$ 项（基带）与 $k \\neq 0$ 项（混叠）分开。\n$$\nS_y(f) = S_{x_a}(f) + \\sum_{k \\neq 0} S_{x_a}(f - 2kB)\n$$\n对于 $|f| \\leq B$，$S_{x_a}(f) = S_0$。这对应于信号中被正确重构的部分。理想信号 $x_B(t)$ 具有相同的功率谱密度。因此，误差 $e_{in}(t) = x_B(t) - y(t)$ 是由混叠项引起的。重构信号可以看作是 $y(t) = y_{baseband}(t) + y_{alias}(t)$，其中 $y_{baseband}(t)$ 对应于带内信号的理想重构（即 $x_B(t)$，因为对于 $|f|\\le B$ 有 $H_a(f)=1$），而 $y_{alias}(t)$ 是由混叠引起的噪声。\n所以，$e_{in}(t) = x_B(t) - (x_B(t) + y_{alias}(t)) = -y_{alias}(t)$。因此，带内误差的功率就是混叠噪声的功率。\n混叠噪声的功率谱密度为 $S_{alias}(f) = \\sum_{k \\neq 0} S_{x_a}(f - 2kB)$。\n$$\n\\mathcal{E}_{in} = \\int_{-B}^{B} S_{alias}(f) df = \\int_{-B}^{B} \\sum_{k \\neq 0} S_{x_a}(f - 2kB) df\n$$\n对于 $|f| \\le B$ 和 $k \\neq 0$，参数 $f - 2kB$ 始终在 $[-B, B]$ 之外。因此，我们必须使用 $S_{x_a}(f) = \\alpha^2 S_0 B^2/f^2$。\n$$\n\\mathcal{E}_{in} = \\int_{-B}^{B} \\sum_{k=1}^{\\infty} [S_{x_a}(f - 2kB) + S_{x_a}(f + 2kB)] df\n$$\n$$\n\\mathcal{E}_{in} = \\alpha^2 S_0 B^2 \\sum_{k=1}^{\\infty} \\int_{-B}^{B} \\left( \\frac{1}{(f-2kB)^2} + \\frac{1}{(f+2kB)^2} \\right) df\n$$\n我们对固定的 $k$ 计算积分：\n$$\n\\int_{-B}^{B} \\frac{1}{(f-2kB)^2} df = \\left[ -\\frac{1}{f-2kB} \\right]_{-B}^{B} = -\\frac{1}{B-2kB} + \\frac{1}{-B-2kB} = \\frac{1}{2kB-B} - \\frac{1}{2kB+B} = \\frac{1}{B}\\left( \\frac{1}{2k-1} - \\frac{1}{2k+1} \\right) = \\frac{2}{B(4k^2-1)}\n$$\n由于对称性，第二项的积分是相同的。\n$$\n\\int_{-B}^{B} \\left( \\frac{1}{(f-2kB)^2} + \\frac{1}{(f+2kB)^2} \\right) df = \\frac{2}{B(4k^2-1)} + \\frac{2}{B(4k^2-1)} = \\frac{4}{B(4k^2-1)}\n$$\n现在，将此结果代回 $\\mathcal{E}_{in}$ 的表达式中：\n$$\n\\mathcal{E}_{in} = \\alpha^2 S_0 B^2 \\sum_{k=1}^{\\infty} \\frac{4}{B(4k^2-1)} = 4 \\alpha^2 S_0 B \\sum_{k=1}^{\\infty} \\frac{1}{4k^2-1}\n$$\n该求和是一个伸缩级数：\n$$\n\\sum_{k=1}^{\\infty} \\frac{1}{4k^2-1} = \\sum_{k=1}^{\\infty} \\frac{1}{(2k-1)(2k+1)} = \\frac{1}{2} \\sum_{k=1}^{\\infty} \\left( \\frac{1}{2k-1} - \\frac{1}{2k+1} \\right)\n$$\n$$\n= \\frac{1}{2} \\left[ \\left(1 - \\frac{1}{3}\\right) + \\left(\\frac{1}{3} - \\frac{1}{5}\\right) + \\left(\\frac{1}{5} - \\frac{1}{7}\\right) + \\dots \\right] = \\frac{1}{2} \\cdot 1 = \\frac{1}{2}\n$$\n因此，带内混叠误差功率为：\n$$\n\\mathcal{E}_{in} = 4 \\alpha^2 S_0 B \\left(\\frac{1}{2}\\right) = 2 \\alpha^2 S_0 B\n$$\n总均方误差是带外和带内误差功率之和：\n$$\n\\mathcal{E} = \\mathcal{E}_{out} + \\mathcal{E}_{in} = 2 S_0 B + 2 \\alpha^2 S_0 B = 2 S_0 B (1 + \\alpha^2)\n$$\n该表达式表示原始信号与其重构信号之差的总平均功率。", "answer": "$$\\boxed{2S_{0}B(1 + \\alpha^{2})}$$", "id": "2902649"}, {"introduction": "工程设计的核心在于做出最优的权衡。在采样系统中，一个经典的权衡是在提高采样率（过采样）以放宽对模拟抗混叠滤波器的要求，与使用更复杂的滤波器以允许较低的采样率之间做出选择。这个动手编程练习将此权衡问题模型化，要求您通过优化成本函数，找到在满足特定性能指标下，采样率和滤波器阶数的最佳经济组合。[@problem_id:2902598]", "problem": "给定一个连续时间、宽义平稳信源，其双边功率谱密度建模为 $S_{x}(f) = \\dfrac{S_{0}}{1 + \\left(\\dfrac{|f|}{f_{b}}\\right)^{p}}$，适用于所有实数 $f$，其中 $S_{0} > 0$、$f_{b} > 0$ 和 $p > 1$ 是参数。该信源首先通过一个模拟抗混叠低通滤波器 $H(f)$，然后以采样率 $f_{s}$ (单位：Hz) 进行均匀采样。重建过程通过理想sinc插值和一个只保留基带频率 $|f| \\leq B$ 的理想低通滤波器来执行，其中 $B>0$ 是所需的信息带宽。\n\n目标是通过最小化一个对采样率和模拟滤波器阶数进行惩罚的成本函数，来分析过采样与模拟抗混叠滤波器复杂度之间的权衡，同时满足一个关于混叠引起的重建误差的严格上限约束。\n\n建模基本依据：\n- 均匀采样以周期 $f_{s}$ 复制连续时间频谱。\n- 由频率 $|f| \\geq \\dfrac{f_{s}}{2}$ 的混叠引起的均方重建误差，其上界可由进入采样器的预滤波信号的阻带能量来确定。\n- 一个经典的模拟I型Chebyshev低通滤波器，其在 $|f| \\leq B$ 内的通带波纹不超过 $R_{p}$ 分贝，在 $|f| \\geq \\dfrac{f_{s}}{2}$ 处的阻带衰减由阻带增益上界 $\\delta_{s}$ 表征（其中 $\\delta_{s} = 10^{-A_{s}/20}$，$A_{s}$ 是以分贝为单位的阻带衰减），其最小整数阶数取决于比率 $\\dfrac{f_{s}/2}{B}$、通带波纹 $R_{p}$ 和所需的 $\\delta_{s}$。\n\n约束条件：\n- 令 $J(f_{s}) \\triangleq 2 \\int_{f_{s}/2}^{\\infty} S_{x}(f) \\, df$。如果抗混叠滤波器的设计使得对所有 $|f| \\geq \\dfrac{f_{s}}{2}$ 都有 $|H(f)| \\leq \\delta_{s}$，那么均方混叠误差的上界为 $\\delta_{s}^{2} \\, J(f_{s})$。施加约束 $\\delta_{s}^{2} \\, J(f_{s}) \\leq \\varepsilon^{2}$，其中 $\\varepsilon > 0$ 是一个指定的容差。这导出了要求 $\\delta_{s} \\leq \\min\\!\\left(1, \\dfrac{\\varepsilon}{\\sqrt{J(f_{s})}} \\right)$，因此所需的阻带衰减为 $A_{s}(f_{s}) = \\max\\!\\left(0, -20 \\log_{10} \\left(\\dfrac{\\varepsilon}{\\sqrt{J(f_{s})}}\\right)\\right)$ 分贝。\n\n滤波器族和复杂度模型：\n- 使用一个模拟I型Chebyshev低通滤波器，其通带边沿在 $B$，阻带边沿在 $\\dfrac{f_{s}}{2}$。满足通带波纹规格 $R_{p}$ 分贝和阻带衰减 $A_{s}(f_{s})$ 分贝所需的最小整数滤波器阶数由标准的Chebyshev响应关系确定。\n- 定义成本函数 $C(f_{s}, N) = c_{s} \\, f_{s} + c_{N} \\, N$，其中 $N$ 是在采样率 $f_{s}$ 下满足规格的最小整数滤波器阶数，$c_{s} > 0$ 是采样率的成本系数（单位为任意的成本/赫兹），$c_{N} > 0$ 是每单位滤波器阶数的成本系数（无量纲）。目标是在上述约束条件和 $f_{s} > 2B$ 的前提下，最小化 $C(f_{s}, N)$。\n\n您的任务是编写一个完整的程序，对下面的每个测试案例，在一个指定的候选采样率离散集合上进行搜索，并返回由以下各项组成的三元组：\n- 最优采样率 $f_{s}^{\\star}$（单位：Hz），\n- 对应的最小整数滤波器阶数 $N^{\\star}$，\n- 最小成本 $C^{\\star}$。\n\n细节和要求：\n- 对每个候选 $f_{s}$，数值计算 $J(f_{s}) = 2 \\int_{f_{s}/2}^{\\infty} \\dfrac{S_{0}}{1 + \\left(\\dfrac{f}{f_{b}}\\right)^{p}} \\, df$。将 $S_{0}$ 视为 $1$（归一化单位）。\n- 强制 $f_{s} > 2B$。如果一个候选值违反此条件，则将其舍弃。\n- 对每个有效的 $f_{s}$，计算所需的阻带增益 $\\delta_{s}(f_{s}) = \\min\\!\\left(1, \\dfrac{\\varepsilon}{\\sqrt{J(f_{s})}}\\right)$ 和相应的所需阻带衰减 $A_{s}(f_{s})$（单位：分贝）。\n- 确定满足在 $|f| \\leq B$ 上的通带波纹上界 $R_{p}$ 分贝和在 $|f| \\geq \\dfrac{f_{s}}{2}$ 上的阻带衰减上界 $A_{s}(f_{s})$ 分贝的最小整数I型Chebyshev阶数 $N$。\n- 计算成本 $C(f_{s}, N)$ 并选择使成本最小化的三元组 $(f_{s}^{\\star}, N^{\\star}, C^{\\star})$。如果存在多个最小值点，选择其中 $f_{s}$ 最小的那个。\n\n不使用角度单位。采样率必须以Hz为单位报告。滤波器阶数必须是整数。成本是无量纲实数。\n\n测试套件：\n- 案例 $1$ (理想路径): $B = 10000$ Hz, $f_{b} = 30000$ Hz, $p = 4$, $\\varepsilon = 1.0 \\times 10^{-3}$, $R_{p} = 0.1$ 分贝, $c_{s} = 1.0 \\times 10^{-6}$, $c_{N} = 1.0$, 候选 $f_{s}$ 在 $[22000, 120000]$ Hz 上均匀分布，共 $81$ 个点。\n- 案例 $2$ (严格的误差容限): $B = 10000$ Hz, $f_{b} = 30000$ Hz, $p = 4$, $\\varepsilon = 1.0 \\times 10^{-5}$, $R_{p} = 0.1$ 分贝, $c_{s} = 1.0 \\times 10^{-6}$, $c_{N} = 1.0$, 候选 $f_{s}$ 在 $[22000, 240000]$ Hz 上均匀分布，共 $91$ 个点。\n- 案例 $3$ (采样率成本高): $B = 10000$ Hz, $f_{b} = 25000$ Hz, $p = 3$, $\\varepsilon = 1.0 \\times 10^{-3}$, $R_{p} = 0.1$ 分贝, $c_{s} = 5.0 \\times 10^{-6}$, $c_{N} = 0.2$, 候选 $f_{s}$ 在 $[21000, 100000]$ Hz 上均匀分布，共 $80$ 个点。\n- 案例 $4$ (频谱衰减慢，容差宽松): $B = 10000$ Hz, $f_{b} = 20000$ Hz, $p = 2$, $\\varepsilon = 5.0 \\times 10^{-3}$, $R_{p} = 0.1$ 分贝, $c_{s} = 1.0 \\times 10^{-6}$, $c_{N} = 1.0$, 候选 $f_{s}$ 在 $[22000, 160000]$ Hz 上均匀分布，共 $70$ 个点。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有四个案例的结果，形式为一个包含在方括号中的逗号分隔列表。该列表必须包含序列 $[f_{s,1}^{\\star}, N_{1}^{\\star}, C_{1}^{\\star}, f_{s,2}^{\\star}, N_{2}^{\\star}, C_{2}^{\\star}, f_{s,3}^{\\star}, N_{3}^{\\star}, C_{3}^{\\star}, f_{s,4}^{\\star}, N_{4}^{\\star}, C_{4}^{\\star}]$。\n- 报告 $f_{s,i}^{\\star}$（浮点数，单位Hz），$N_{i}^{\\star}$（整数），以及 $C_{i}^{\\star}$（浮点值）。", "solution": "问题陈述已经过严格验证，被认为是有效的。这是一个在信号处理和系统工程领域有科学依据、定义明确的问题，没有矛盾或含糊不清之处。它提出了一个涉及系统参数权衡的标准优化任务。因此，我们可以进行形式化的求解。\n\n目标是最小化成本函数 $C(f_{s}, N) = c_{s} f_{s} + c_{N} N$，该函数代表与采样率 $f_{s}$ 和模拟抗混叠滤波器阶数 $N$ 相关成本的加权和。最小化是在一个指定的候选采样频率 $f_{s}$ 的离散集合上进行的，并受到最大允许混叠误差的约束。为每个测试案例寻找最优三元组 $(f_{s}^{\\star}, N^{\\star}, C^{\\star})$ 的过程如下执行。\n\n对于所提供集合中的每个候选采样率 $f_s$，满足基本要求 $f_{s} > 2B$（其中 $B$ 是信息带宽）：\n\n1.  **计算阻带功率积分**：第一步是量化存在于将被采样过程混叠的频率中的信号功率。这部分功率包含在抗混叠滤波器的阻带 $|f| \\geq f_{s}/2$ 中，由积分 $J(f_{s})$ 给出。由于功率谱密度 $S_{x}(f)$ 是频率 $f$ 的偶函数，该积分简化为：\n    $$ J(f_{s}) = 2 \\int_{f_{s}/2}^{\\infty} S_{x}(f) \\, df = 2 \\int_{f_{s}/2}^{\\infty} \\frac{S_{0}}{1 + \\left(\\frac{f}{f_{b}}\\right)^{p}} \\, df $$\n    按规定，我们设置归一化常数 $S_0 = 1$。由于对于任意指数 $p > 1$ 不存在通用的闭式解，该积分使用标准的数值积分方法计算。\n\n2.  **确定所需阻带衰减**：混叠误差的上界是滤波器阻带增益的平方 $\\delta_{s}^2$ 与阻带功率 $J(f_{s})$ 的乘积。所施加的约束 $\\delta_{s}^{2} J(f_{s}) \\leq \\varepsilon^{2}$ 决定了抗混叠滤波器所需的性能。由此，我们推导出必要的阻带衰减 $A_{s}$（以分贝为单位）。所需的阻带增益必须满足 $\\delta_{s} \\leq \\varepsilon / \\sqrt{J(f_{s})}$，并且由于增益不能超过1（$\\delta_{s} \\leq 1$），所需的阻带衰减为：\n    $$ A_{s}(f_{s}) = -20 \\log_{10}(\\delta_{s}) = -20 \\log_{10} \\left( \\min\\left(1, \\frac{\\varepsilon}{\\sqrt{J(f_{s})}}\\right) \\right) $$\n    这等价于所提供的表达式 $A_{s}(f_{s}) = \\max\\left(0, -20 \\log_{10}\\left(\\frac{\\varepsilon}{\\sqrt{J(f_{s})}}\\right)\\right)$。更高的采样率 $f_{s}$ 会将积分下限 $f_{s}/2$ 移至更高频率，从而减小 $J(f_{s})$，因此放宽了对衰减 $A_{s}(f_{s})$ 的要求。\n\n3.  **计算最小滤波器阶数**：我们采用I型Chebyshev滤波器，其特点是滚降陡峭。满足给定规格集所需的最小整数阶数 $N$ 由通带边沿频率 $f_{p} = B$、阻带边沿频率 $f_{st} = f_{s}/2$、最大通带波纹 $R_{p}$（分贝）和最小阻带衰减 $A_{s}$（分贝）确定。阶数的标准公式为：\n    $$ N = \\left\\lceil \\frac{\\text{arccosh}\\left(\\sqrt{\\frac{10^{A_{s}/10} - 1}{10^{R_{p}/10} - 1}}\\right)}{\\text{arccosh}\\left(\\frac{f_{st}}{f_{p}}\\right)} \\right\\rceil $$\n    其中 $\\lceil \\cdot \\rceil$ 表示上取整函数，因为滤波器阶数必须是整数。这个计算证实了一个直观的原理：对于更窄的过渡带（即当 $f_{s}/2$ 接近 $B$ 时）或更高的衰减要求 $A_{s}$，需要更高阶的滤波器。使用成熟的科学计算库函数可以可靠地执行此计算。\n\n4.  **计算总成本**：在确定了采样率 $f_{s}$ 和相应的所需滤波器阶数 $N$ 之后，使用线性模型 $C(f_{s}, N) = c_{s} f_{s} + c_{N} N$ 计算总成本。\n\n对搜索空间中的每个候选 $f_{s}$ 重复这整个序列。然后分析得到的成本集合以找出最小值 $C^{\\star}$。与此最小值对应的三元组 $(f_{s}^{\\star}, N^{\\star}, C^{\\star})$ 就是解。如果存在多个成本相同的解，则根据问题规范，选择采样率 $f_{s}^{\\star}$ 最小的那个。此过程被系统地应用于所有四个测试案例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\nfrom scipy import signal\n\ndef solve():\n    \"\"\"\n    Main function to solve the optimization problem for all test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: B, fb, p, eps, Rp, cs, cN, (fs_min, fs_max), fs_points\n        (10000.0, 30000.0, 4.0, 1.0e-3, 0.1, 1.0e-6, 1.0, (22000.0, 120000.0), 81),\n        # Case 2\n        (10000.0, 30000.0, 4.0, 1.0e-5, 0.1, 1.0e-6, 1.0, (22000.0, 240000.0), 91),\n        # Case 3\n        (10000.0, 25000.0, 3.0, 1.0e-3, 0.1, 5.0e-6, 0.2, (21000.0, 100000.0), 80),\n        # Case 4\n        (10000.0, 20000.0, 2.0, 5.0e-3, 0.1, 1.0e-6, 1.0, (22000.0, 160000.0), 70),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = _solve_single_case(case)\n        all_results.extend(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\ndef _solve_single_case(case_params):\n    \"\"\"\n    Solves the optimization for a single set of parameters.\n    \"\"\"\n    B, fb, p, eps, Rp, cs, cN, fs_range, fs_points = case_params\n\n    fs_candidates = np.linspace(fs_range[0], fs_range[1], fs_points)\n\n    min_cost = np.inf\n    optimal_fs = None\n    optimal_N = None\n\n    for fs in fs_candidates:\n        # Per problem statement, all candidate fs are > 2B.\n        # So we skip the explicit check 'if fs = 2 * B:'.\n\n        # Step 1: Compute J(fs) = 2 * Integral from fs/2 to inf of S_x(f) df\n        # S0 is normalized to 1. |f|=f since we integrate over positive f.\n        integrand = lambda f: 1.0 / (1.0 + (f / fb)**p)\n        J_fs, _ = integrate.quad(integrand, fs / 2.0, np.inf)\n        J_fs *= 2.0\n\n        # Step 2: Compute required stopband attenuation As(fs) in dB.\n        if J_fs = 1e-30:  # If stopband power is negligible, no attenuation is needed.\n            As = 0.0\n        else:\n            # As(fs) = max(0, -20 * log10(eps / sqrt(J(fs))))\n            # This avoids math domain error if a large J_fs makes the ratio > 1.\n            arg = eps / np.sqrt(J_fs)\n            if arg >= 1.0:\n                As = 0.0\n            else:\n                As = -20.0 * np.log10(arg)\n\n        # Step 3: Determine minimum Type I Chebyshev filter order N.\n        # Passband edge frequency (Hz)\n        wp = B\n        # Stopband edge frequency (Hz)\n        ws = fs / 2.0\n        # Passband ripple (dB)\n        gpass = Rp\n        # Stopband attenuation (dB)\n        gstop = As\n        \n        # 'cheb1ord' returns the minimum integer order required.\n        N, _ = signal.cheb1ord(wp, ws, gpass, gstop, analog=True)\n        N = int(N)\n\n        # Step 4: Compute the cost C(fs, N)\n        cost = cs * fs + cN * float(N)\n        \n        # Update minimum cost and corresponding parameters. The strict inequality\n        # and ordered search over fs handles the tie-breaking rule correctly.\n        if cost  min_cost:\n            min_cost = cost\n            optimal_fs = fs\n            optimal_N = N\n            \n    return [optimal_fs, optimal_N, min_cost]\n\nsolve()\n```", "id": "2902598"}]}