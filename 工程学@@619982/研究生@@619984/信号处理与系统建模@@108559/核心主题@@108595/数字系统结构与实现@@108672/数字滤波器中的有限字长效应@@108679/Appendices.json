{"hands_on_practices": [{"introduction": "我们分析量化效应时，加性白噪声（AWN）模型是一个基础工具。但是，理解其局限性与理解其用途同样重要。本练习将通过一个精心设计的反例，揭示该模型在特定情况下的失效，让您对模型的假设和真实世界的非线性行为有更深刻的认识。您将分析一个简单的一阶IIR滤波器，并发现其确定性的极限环（limit cycle）行为，这与AWN模型的随机噪声预测大相径庭 [@problem_id:2872516]。这个实践旨在培养您对理论模型批判性审视的能力，这是高级工程分析中的一项核心素养。", "problem": "考虑一个一阶反馈无限脉冲响应 (IIR) 递归，其环路内有一个均匀中步量化器，由以下确定性差分方程定义：\n$$\ny[n] \\;=\\; Q\\!\\big(\\alpha\\, y[n-1]\\big),\n$$\n其中 $Q(\\cdot)$ 是一个步长为 $\\Delta = 1$ 的最近邻取整量化器，其平局打破规则为将0.5向远离零的方向取整。初始条件为 $y[-1]=1$，输入恒为零，反馈增益为 $\\alpha = \\tfrac{1}{2}$。假设量化器没有饱和（即动态范围无限）。\n\n加性白噪声 (AWN) 量化模型将量化器替换为一个加法器，$y[n] = \\alpha\\,y[n-1] + e[n]$，其中 $e[n]$ 被建模为一个独立同分布的随机变量序列，与 $y[n-1]$ 相互独立，每个变量都在区间 $[-\\Delta/2,\\Delta/2]$ 上均匀分布，因此其方差为 $\\Delta^{2}/12$。仅使用基本定义和广泛接受的事实（例如均匀分布的方差和线性递归的方差定义），按以下步骤进行：\n\n1) 在 AWN 模型下，推导 $\\,y[n]\\,$ 的稳态输出方差 $\\,\\sigma^{2}_{\\text{AWN}}\\,$。\n\n2) 对于具有给定舍入规则和初始条件的实际量化反馈系统 $\\,y[n] = Q(\\alpha y[n-1])\\,$，确定 $\\,y[n]\\,$ 的真实稳态输出方差 $\\,\\sigma^{2}_{\\text{true}}\\,$。\n\n3) 使用第 1) 部分和第 2) 部分的结果，计算差异\n$$\n\\delta \\;=\\; \\sigma^{2}_{\\text{AWN}} \\;-\\; \\sigma^{2}_{\\text{true}}.\n$$\n\n请将 $\\,\\delta\\,$ 的最终答案以单个精确数的形式给出。不要进行四舍五入。", "solution": "问题陈述已经过验证，被认为是适定的、科学上合理的和完整的。我们开始进行推导。问题要求计算并比较一个量化反馈系统的两种不同模型的输出方差。\n\n首先，我们分析加性白噪声（AWN）模型以确定 $\\sigma^{2}_{\\text{AWN}}$。该模型由以下线性差分方程给出：\n$$\ny[n] = \\alpha y[n-1] + e[n]\n$$\n其中 $\\alpha = \\frac{1}{2}$ 是反馈增益，$e[n]$ 是代表量化误差的随机过程。误差 $e[n]$ 被建模为一系列独立同分布 (i.i.d.) 的随机变量，每个变量都在区间 $[-\\frac{\\Delta}{2}, \\frac{\\Delta}{2}]$ 上均匀分布。问题陈述中量化步长为 $\\Delta = 1$，因此 $e[n]$ 在 $[-\\frac{1}{2}, \\frac{1}{2}]$ 上均匀分布。这种均匀分布的方差为 $\\sigma_e^2 = \\frac{\\Delta^2}{12}$。对于 $\\Delta=1$，该方差为 $\\sigma_e^2 = \\frac{1}{12}$。\n\nAWN 模型假设误差序列 $e[n]$ 与信号序列 $y[n-1]$ 相互独立。为了求得稳态输出方差（记为 $\\sigma^{2}_{\\text{AWN}}$），我们对差分方程的两边取方差：\n$$\n\\text{Var}(y[n]) = \\text{Var}(\\alpha y[n-1] + e[n])\n$$\n由于 $y[n-1]$ 和 $e[n]$ 的独立性，和的方差等于方差的和：\n$$\n\\text{Var}(y[n]) = \\text{Var}(\\alpha y[n-1]) + \\text{Var}(e[n])\n$$\n使用性质 $\\text{Var}(cX) = c^2 \\text{Var}(X)$，我们得到：\n$$\n\\text{Var}(y[n]) = \\alpha^2 \\text{Var}(y[n-1]) + \\sigma_e^2\n$$\n在稳态下，输出方差是恒定的，即 $\\text{Var}(y[n]) = \\text{Var}(y[n-1]) = \\sigma^{2}_{\\text{AWN}}$。将此代入方程可得：\n$$\n\\sigma^{2}_{\\text{AWN}} = \\alpha^2 \\sigma^{2}_{\\text{AWN}} + \\sigma_e^2\n$$\n求解 $\\sigma^{2}_{\\text{AWN}}$：\n$$\n\\sigma^{2}_{\\text{AWN}}(1 - \\alpha^2) = \\sigma_e^2\n$$\n$$\n\\sigma^{2}_{\\text{AWN}} = \\frac{\\sigma_e^2}{1 - \\alpha^2}\n$$\n现在，我们代入给定值 $\\alpha = \\frac{1}{2}$ 和 $\\sigma_e^2 = \\frac{1}{12}$：\n$$\n\\sigma^{2}_{\\text{AWN}} = \\frac{\\frac{1}{12}}{1 - \\left(\\frac{1}{2}\\right)^2} = \\frac{\\frac{1}{12}}{1 - \\frac{1}{4}} = \\frac{\\frac{1}{12}}{\\frac{3}{4}} = \\frac{1}{12} \\times \\frac{4}{3} = \\frac{4}{36} = \\frac{1}{9}\n$$\n这就完成了问题的第一部分。\n\n其次，我们分析实际的确定性系统以求得真实稳态输出方差 $\\sigma^{2}_{\\text{true}}$。该系统由以下非线性差分方程描述：\n$$\ny[n] = Q\\big(\\alpha\\, y[n-1]\\big)\n$$\n参数为 $\\alpha = \\frac{1}{2}$ 和 $\\Delta=1$。量化器 $Q(\\cdot)$ 将其输入舍入到最近的整数，平局打破规则为将形式为 $k + 0.5$（其中 $k$ 为整数）的值向远离零的方向舍入。初始条件为 $y[-1] = 1$。我们追踪 $n \\ge 0$ 的输出序列 $y[n]$：\n当 $n=0$ 时：\n$$\ny[0] = Q\\left(\\alpha y[-1]\\right) = Q\\left(\\frac{1}{2} \\cdot 1\\right) = Q(0.5)\n$$\n根据“将0.5向远离零的方向舍入”的规则，$Q(0.5) = 1$。\n当 $n=1$ 时：\n$$\ny[1] = Q\\left(\\alpha y[0]\\right) = Q\\left(\\frac{1}{2} \\cdot 1\\right) = Q(0.5) = 1\n$$\n通过归纳法，如果对于任何 $k \\ge 0$ 都有 $y[k-1] = 1$，那么 $y[k] = Q(\\frac{1}{2} \\cdot 1) = 1$。由于 $y[-1]=1$，这一步其实是不必要的，因为 $y[0]=1$ 就证实了这种行为。对于所有 $n \\ge 0$，序列为 $y[n]=1$。\n系统立即进入稳态，产生一个恒定的输出序列 $\\{1, 1, 1, \\dots\\}$。这是一个周期为1的直流极限环。\n稳态输出是一个确定性的常数值：$y_{ss}[n] = 1$。该稳态信号的均值为 $\\mu_y = 1$。根据定义，任何常数值的方差都为零。\n$$\n\\sigma^{2}_{\\text{true}} = \\text{E}\\left[(y_{ss}[n] - \\mu_y)^2\\right] = \\text{E}\\left[(1 - 1)^2\\right] = \\text{E}[0] = 0\n$$\n因此，真实稳态方差为 $\\sigma^{2}_{\\text{true}} = 0$。\n\n第三，我们计算差异 $\\delta$：\n$$\n\\delta = \\sigma^{2}_{\\text{AWN}} - \\sigma^{2}_{\\text{true}}\n$$\n代入前面部分推导出的值：\n$$\n\\delta = \\frac{1}{9} - 0 = \\frac{1}{9}\n$$\n这个结果突显了一个案例，其中广泛使用的线性 AWN 模型未能捕捉到系统的真实非线性行为，在本例中该行为是一个方差为零的确定性极限环。", "answer": "$$\\boxed{\\frac{1}{9}}$$", "id": "2872516"}, {"introduction": "在了解了加性白噪声（AWN）模型的局限性之后，我们将转向其在实际设计中的标准应用。在许多常见的滤波器结构中，AWN模型是进行噪声预算和性能权衡的宝贵工具。本练习要求您分析一个直接型FIR滤波器的定点实现，并运用AWN模型来量化和比较两个不同噪声源的贡献：乘积量化和累加器量化 [@problem_id:2872520]。通过这项实践，您将掌握如何系统地进行噪声分析，这是一项在资源受限的硬件上优化数字滤波器性能的关键技能。", "problem": "请考虑一个长度为 $M$ 的有限冲激响应 (FIR) 滤波器，其冲激响应系数为 $\\{h_k\\}_{k=0}^{M-1}$，作用于一个实值输入序列 $\\{x[n]\\}$。理想输出为 $y[n] = \\sum_{k=0}^{M-1} h_k x[n-k]$。该实现是定点的，并按如下方式进行：计算每个乘积 $h_k x[n-k]$，然后通过一个具有 $B_p$ 位的有符号、对称、中置步长(mid-tread)的均匀量化器进行舍入；之后，所有舍入后的乘积被精确累加；最后，累加和再次通过一个具有 $B_a$ 位的有符号、对称、中置步长(mid-tread)的均匀量化器进行舍入，以产生输出。假设如下。\n\n- 对于所有 $n$，输入满足一个已知界限 $|x[n]| \\leq X_{\\max}$，且实现采用逐乘法器全幅归一化，使得第 $k$ 个乘积量化器覆盖对称范围 $\\pm X_{\\max} |h_k|$，而最终输出量化器覆盖对称范围 $\\pm X_{\\max} \\sum_{k=0}^{M-1} |h_k|$，从而在最坏情况的信号组合下避免溢出。\n- 每个均匀量化器被建模为一个加性、白色、与信号不相关的量化噪声，其均值为零，方差为 $\\Delta^2/12$，其中 $\\Delta$ 是量化步长。来自不同量化器和不同时间索引的量化噪声相互不相关。\n- 除所述的两次舍入外，所有其他算术运算都是精确的。\n\n将乘积量化引起的输出噪声定义为滤波器输出中仅源于单个乘积舍入的分量，并将加法器量化引起的输出噪声定义为仅源于累加后最终舍入的分量。从给定的假设以及均匀量化噪声和线性系统的基本性质出发，推导乘积量化引起的输出噪声功率与加法器量化引起的输出噪声功率之比 $R$ 的闭式表达式，该表达式是 $M$、系数幅值 $\\{|h_k|\\}$、$B_p$ 和 $B_a$ 的函数。您的最终答案必须是关于 $M$、$\\{|h_k|\\}$、$B_p$ 和 $B_a$ 的单一解析表达式。除了给定的建模假设外，不要引入任何额外的近似。答案是无量纲的，请勿包含单位。", "solution": "该问题要求在一个定点有限冲激响应 (FIR) 滤波器实现中，推导两种不同量化噪声功率之比。分析将依据问题陈述中指定的量化误差建模基本原理进行。\n\n首先，我们将滤波器的操作形式化。理想输出 $y[n]$ 由下式给出\n$$y[n] = \\sum_{k=0}^{M-1} h_k x[n-k]$$\n实现的输出，我们记为 $\\hat{y}[n]$，它经历两个量化阶段。第一阶段是每个乘积 $p_k[n] = h_k x[n-k]$ 的舍入，第二阶段是最终累加和的舍入。\n\n令 $Q_{p,k}(\\cdot)$ 表示第 $k$ 个乘积的量化器，令 $Q_a(\\cdot)$ 表示最终和的量化器。实现的输出 $\\hat{y}[n]$ 由下式给出\n$$\\hat{y}[n] = Q_a\\left(\\sum_{k=0}^{M-1} Q_{p,k}(h_k x[n-k])\\right)$$\n我们将每个量化器 $Q(\\cdot)$ 建模为一个加性噪声源 $e$，使得 $Q(z) = z + e$。假设噪声 $e$ 是一个均值为零的随机过程，其方差为 $\\sigma_e^2 = \\frac{\\Delta^2}{12}$，其中 $\\Delta$ 是量化步长大小。\n\n对于一个在范围 $\\pm F$ 内的有符号、对称、$B$ 位量化器，其量化步长大小 $\\Delta$ 由全幅范围 $2F$ 和量化级别数 $2^B$ 决定。因此，\n$$\\Delta = \\frac{2F}{2^B} = F \\cdot 2^{1-B}$$\n\n现在，我们分析问题中定义的两个噪声源。\n\n1.  **乘积量化引起的输出噪声功率 ($\\sigma_{p,\\text{out}}^2$)**\n\n该噪声源于 $M$ 个单独乘积的舍入。令 $e_{p,k}[n]$ 为舍入第 $k$ 个乘积所产生的量化误差：\n$$Q_{p,k}(h_k x[n-k]) = h_k x[n-k] + e_{p,k}[n]$$\n这些乘积量化误差在最终累加器输入端的总贡献是它们的和：\n$$e_p[n] = \\sum_{k=0}^{M-1} e_{p,k}[n]$$\n由于累加是精确的，这个和代表了在最终舍入前，系统输出端的总乘积量化噪声分量。该噪声的功率是其方差，$\\sigma_{p,\\text{out}}^2 = \\text{Var}(e_p[n])$。\n根据问题陈述，来自不同乘法器（不同的 $k$）的量化噪声 $e_{p,k}[n]$ 是不相关的。因此，和的方差等于方差的和：\n$$\\sigma_{p,\\text{out}}^2 = \\text{Var}\\left(\\sum_{k=0}^{M-1} e_{p,k}[n]\\right) = \\sum_{k=0}^{M-1} \\text{Var}(e_{p,k}[n])$$\n每个单独乘积噪声的方差 $\\text{Var}(e_{p,k}[n])$ 是 $\\frac{\\Delta_{p,k}^2}{12}$，其中 $\\Delta_{p,k}$ 是第 $k$ 个乘积量化器的步长。该量化器有 $B_p$ 位，其范围被指定为 $\\pm X_{\\max} |h_k|$。所以，其全幅值为 $F_k = X_{\\max} |h_k|$。步长为：\n$$\\Delta_{p,k} = F_k \\cdot 2^{1-B_p} = X_{\\max} |h_k| 2^{1-B_p}$$\n第 $k$ 个乘积噪声的方差为：\n$$\\text{Var}(e_{p,k}[n]) = \\frac{\\Delta_{p,k}^2}{12} = \\frac{(X_{\\max} |h_k| 2^{1-B_p})^2}{12} = \\frac{X_{\\max}^2 |h_k|^2 2^{2(1-B_p)}}{12}$$\n将此代入总乘积噪声功率的求和公式中，我们得到：\n$$\\sigma_{p,\\text{out}}^2 = \\sum_{k=0}^{M-1} \\frac{X_{\\max}^2 |h_k|^2 2^{2(1-B_p)}}{12} = \\frac{X_{\\max}^2 2^{2(1-B_p)}}{12} \\sum_{k=0}^{M-1} |h_k|^2$$\n\n2.  **加法器量化引起的输出噪声功率 ($\\sigma_{a,\\text{out}}^2$)**\n\n这个噪声，我们记为 $e_a[n]$，是由最终的舍入操作 $Q_a(\\cdot)$ 引入的。此量化器的输入是舍入后乘积的精确和。其输出为：\n$$\\hat{y}[n] = Q_a\\left(\\sum_{k=0}^{M-1} Q_{p,k}(h_k x[n-k])\\right) = \\left(\\sum_{k=0}^{M-1} Q_{p,k}(h_k x[n-k])\\right) + e_a[n]$$\n问题将“加法器量化引起的输出噪声”定义为仅源于这次最终舍入的分量。这恰好是 $e_a[n]$。其功率是方差 $\\sigma_{a,\\text{out}}^2 = \\text{Var}(e_a[n])$。\n该方差由 $\\frac{\\Delta_a^2}{12}$ 给出，其中 $\\Delta_a$ 是最终累加器量化器的步长。该量化器有 $B_a$ 位，其范围指定为 $\\pm X_{\\max} \\sum_{k=0}^{M-1} |h_k|$。全幅值为 $F_a = X_{\\max} \\sum_{k=0}^{M-1} |h_k|$。步长为：\n$$\\Delta_a = F_a \\cdot 2^{1-B_a} = \\left(X_{\\max} \\sum_{k=0}^{M-1} |h_k|\\right) 2^{1-B_a}$$\n因此，加法器量化噪声的方差为：\n$$\\sigma_{a,\\text{out}}^2 = \\frac{\\Delta_a^2}{12} = \\frac{\\left(\\left(X_{\\max} \\sum_{k=0}^{M-1} |h_k|\\right) 2^{1-B_a}\\right)^2}{12} = \\frac{X_{\\max}^2 \\left(\\sum_{k=0}^{M-1} |h_k|\\right)^2 2^{2(1-B_a)}}{12}$$\n\n3.  **噪声功率之比 ($R$)**\n\n问题要求乘积量化引起的输出噪声功率与加法器量化引起的输出噪声功率之比 $R$。\n$$R = \\frac{\\sigma_{p,\\text{out}}^2}{\\sigma_{a,\\text{out}}^2}$$\n代入上面推导出的表达式：\n$$R = \\frac{\\frac{X_{\\max}^2 2^{2(1-B_p)}}{12} \\sum_{k=0}^{M-1} |h_k|^2}{\\frac{X_{\\max}^2 \\left(\\sum_{k=0}^{M-1} |h_k|\\right)^2 2^{2(1-B_a)}}{12}}$$\n公共项 $\\frac{X_{\\max}^2}{12}$ 从分子和分母中约去。我们得到：\n$$R = \\frac{2^{2(1-B_p)} \\sum_{k=0}^{M-1} |h_k|^2}{2^{2(1-B_a)} \\left(\\sum_{k=0}^{M-1} |h_k|\\right)^2}$$\n化简指数项：\n$$\\frac{2^{2(1-B_p)}}{2^{2(1-B_a)}} = 2^{2(1-B_p) - 2(1-B_a)} = 2^{2-2B_p - 2+2B_a} = 2^{2B_a - 2B_p} = 2^{2(B_a - B_p)}$$\n因此，比率 $R$ 的最终表达式为：\n$$R = 2^{2(B_a - B_p)} \\frac{\\sum_{k=0}^{M-1} |h_k|^2}{\\left(\\sum_{k=0}^{M-1} |h_k|\\right)^2}$$\n该表达式是 $M$（在求和中隐含）、系数幅值 $\\{|h_k|\\}$ 以及位深 $B_p$ 和 $B_a$ 的函数，正如所要求的那样。", "answer": "$$ \\boxed{ 2^{2(B_a-B_p)} \\frac{\\sum_{k=0}^{M-1} |h_k|^2}{\\left(\\sum_{k=0}^{M-1} |h_k|\\right)^2} } $$", "id": "2872520"}, {"introduction": "为了分析更复杂系统中的量化效应，我们需要一个更通用、更强大的数学框架。本练习将引导您使用状态空间方法来应对这一挑战，这是一种将分析从特定滤波器结构推广到一般线性时不变（LTI）系统中的优雅技术。您将为一个受状态更新噪声影响的系统建立离散时间李雅普诺夫方程（Lyapunov equation），以求解其稳态输出方差，并将其与系统的 $\\mathcal{H}_2$ 范数联系起来 [@problem_id:2872507]。掌握这种方法不仅能加深您对量化噪声的理解，还能在数字信号处理与现代控制理论之间建立起一座桥梁。", "problem": "考虑一个用于建模状态更新中有限字长舍入效应的离散时间线性时不变状态空间系统：\n$x[n+1] = A x[n] + w[n]$ 且 $y[n] = C x[n]$，\n其中 $A \\in \\mathbb{R}^{2 \\times 2}$ 和 $C \\in \\mathbb{R}^{1 \\times 2}$ 由下式给出\n$A = \\begin{bmatrix} \\frac{3}{5} & \\frac{1}{5} \\\\ 0 & \\frac{1}{2} \\end{bmatrix}$ 且 $C = \\begin{bmatrix} 1 & -1 \\end{bmatrix}$。\n信号 $w[n] \\in \\mathbb{R}^{2}$ 是一个零均值白噪声扰动，用于建模状态计算中因有限字长而产生的量化噪声，其协方差为 $\\mathbb{E}\\{w[n] w[n]^{\\top}\\} = \\sigma_{w}^{2} I_{2}$ 且 $\\sigma_{w}^{2} = \\Delta^{2}/12$，其中 $\\Delta$ 是量化器步长。假设 $x[0]$ 是零均值的，与 $w[n]$ 独立，并且该系统是渐近稳定的。\n\n仅从带有白噪声输入的线性系统的二阶矩定义以及稳定线性时不变递推的平稳协方差唯一性出发，完成以下任务：\n- 通过求解由系统动态特性和 $w[n]$ 的白噪声特性所蕴含的相应离散时间李雅普诺夫方程，推导稳态状态协方差矩阵 $P = \\mathbb{E}\\{x[n] x[n]^{\\top}\\}$。\n- 使用 $P$，计算稳态输出方差 $\\sigma_{y}^{2} = \\mathbb{E}\\{y[n]^{2}\\}$。\n- 使用稳定、严格真离散时间系统的哈代空间二范数（$\\mathcal{H}_{2}$ 范数）的定义，将 $\\sigma_{y}^{2}$ 与从 $w[n]$ 到 $y[n]$ 的传递函数的 $\\mathcal{H}_{2}$ 范数的平方联系起来，并用 $\\sigma_{w}^{2}$ 确定相应的比例常数。\n\n请仅用 $\\Delta$ 将稳态输出方差 $\\sigma_{y}^{2}$ 表示为一个单一、简化的闭式表达式作为最终答案。请勿对答案进行近似或四舍五入；无需单位。", "solution": "对所提出的问题进行验证。\n\n逐字提取给定条件：\n- 状态空间模型: $x[n+1] = A x[n] + w[n]$\n- 输出模型: $y[n] = C x[n]$\n- 状态矩阵: $A = \\begin{bmatrix} \\frac{3}{5} & \\frac{1}{5} \\\\ 0 & \\frac{1}{2} \\end{bmatrix}$\n- 输出矩阵: $C = \\begin{bmatrix} 1 & -1 \\end{bmatrix}$\n- 噪声特性: $w[n]$ 是一个零均值白噪声扰动。\n- 噪声协方差: $\\mathbb{E}\\{w[n] w[n]^{\\top}\\} = \\sigma_{w}^{2} I_{2}$，其中 $I_{2}$ 是 $2 \\times 2$ 单位矩阵。\n- 噪声方差参数: $\\sigma_{w}^{2} = \\frac{\\Delta^{2}}{12}$\n- 初始条件: $x[0]$ 是零均值的，且与 $w[n]$ 独立。\n- 系统性质: 该系统是渐近稳定的。\n\n进行验证。\n该问题具有科学依据。带有加性白噪声的状态空间模型是数字信号处理中分析有限字长和量化效应的一种标准且成熟的方法。\n该问题是适定的。状态矩阵 $A$ 是一个上三角矩阵，因此其特征值即为对角线元素：$\\lambda_{1} = \\frac{3}{5}$ 和 $\\lambda_{2} = \\frac{1}{2}$。由于 $|\\lambda_{1}| < 1$ 且 $|\\lambda_{2}| < 1$，该离散时间系统确实如所述是渐近稳定的。这保证了唯一的半正定稳态协方差矩阵 $P$ 的存在。\n该问题是客观、自洽且可进行数学形式化的。所有必要信息均已提供，不存在矛盾或含糊之处。\n\n结论：该问题有效。将提供解答。\n\n第一步是推导稳态状态协方差矩阵 $P$ 的控制方程。根据定义，$P = \\mathbb{E}\\{x[n] x[n]^{\\top}\\}$。由于系统处于稳态，$P$ 是恒定的。我们考虑协方差的时间演化。\n在时刻 $n+1$ 的状态是 $x[n+1] = A x[n] + w[n]$。在时刻 $n+1$ 的协方差是 $P_{n+1} = \\mathbb{E}\\{x[n+1] x[n+1]^{\\top}\\}$。\n代入状态方程：\n$$ P_{n+1} = \\mathbb{E}\\{(A x[n] + w[n])(A x[n] + w[n])^{\\top}\\} $$\n$$ P_{n+1} = \\mathbb{E}\\{A x[n] x[n]^{\\top} A^{\\top} + A x[n] w[n]^{\\top} + w[n] x[n]^{\\top} A^{\\top} + w[n] w[n]^{\\top}\\} $$\n根据期望的线性性质：\n$$ P_{n+1} = A \\mathbb{E}\\{x[n] x[n]^{\\top}\\} A^{\\top} + A \\mathbb{E}\\{x[n] w[n]^{\\top}\\} + \\mathbb{E}\\{w[n] x[n]^{\\top}\\} A^{\\top} + \\mathbb{E}\\{w[n] w[n]^{\\top}\\} $$\n状态 $x[n]$ 是过去的噪声输入 $\\{w[k]\\}_{k<n}$ 和初始状态 $x[0]$ 的函数。由于 $w[n]$ 是一个白噪声序列且与 $x[0]$ 独立，因此它与 $x[n]$ 不相关。于是，$\\mathbb{E}\\{x[n] w[n]^{\\top}\\} = \\mathbb{E}\\{x[n]\\} \\mathbb{E}\\{w[n]^{\\top}\\} = 0$，因为两个信号都是零均值的。噪声协方差由 $Q = \\mathbb{E}\\{w[n] w[n]^{\\top}\\} = \\sigma_{w}^{2} I_{2}$ 给出。\n因此，协方差更新方程为 $P_{n+1} = A P_{n} A^{\\top} + Q$。\n在稳态下，$P_{n+1} = P_{n} = P$，这导出了离散时间代数李雅普诺夫方程：\n$$ P = A P A^{\\top} + Q $$\n我们必须求解此方程以得到对称矩阵 $P = \\begin{bmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{bmatrix}$。\n给定 $A = \\begin{bmatrix} \\frac{3}{5} & \\frac{1}{5} \\\\ 0 & \\frac{1}{2} \\end{bmatrix}$ 和 $Q = \\sigma_{w}^{2} \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}$，方程为：\n$$ \\begin{bmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{bmatrix} = \\begin{bmatrix} \\frac{3}{5} & \\frac{1}{5} \\\\ 0 & \\frac{1}{2} \\end{bmatrix} \\begin{bmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{bmatrix} \\begin{bmatrix} \\frac{3}{5} & 0 \\\\ \\frac{1}{5} & \\frac{1}{2} \\end{bmatrix} + \\sigma_{w}^{2} \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} $$\n计算矩阵乘积：\n$$ A P A^{\\top} = \\begin{bmatrix} \\frac{9}{25}p_{11} + \\frac{6}{25}p_{12} + \\frac{1}{25}p_{22} & \\frac{3}{10}p_{12} + \\frac{1}{10}p_{22} \\\\ \\frac{3}{10}p_{12} + \\frac{1}{10}p_{22} & \\frac{1}{4}p_{22} \\end{bmatrix} $$\n令 $P = A P A^{\\top} + Q$ 的各分量相等，得到关于 $P$ 的元素的线性方程组：\n1. $p_{11} = \\frac{9}{25}p_{11} + \\frac{6}{25}p_{12} + \\frac{1}{25}p_{22} + \\sigma_{w}^{2}$\n2. $p_{12} = \\frac{3}{10}p_{12} + \\frac{1}{10}p_{22}$\n3. $p_{22} = \\frac{1}{4}p_{22} + \\sigma_{w}^{2}$\n\n我们从最后一个方程开始求解这个方程组。\n由(3)可得： $(1 - \\frac{1}{4})p_{22} = \\sigma_{w}^{2} \\implies \\frac{3}{4}p_{22} = \\sigma_{w}^{2} \\implies p_{22} = \\frac{4}{3}\\sigma_{w}^{2}$。\n由(2)可得： $(1 - \\frac{3}{10})p_{12} = \\frac{1}{10}p_{22} \\implies \\frac{7}{10}p_{12} = \\frac{1}{10}p_{22} \\implies p_{12} = \\frac{1}{7}p_{22}$。代入 $p_{22}$ 得到 $p_{12} = \\frac{1}{7}(\\frac{4}{3}\\sigma_{w}^{2}) = \\frac{4}{21}\\sigma_{w}^{2}$。\n由(1)可得： $(1 - \\frac{9}{25})p_{11} = \\frac{6}{25}p_{12} + \\frac{1}{25}p_{22} + \\sigma_{w}^{2} \\implies \\frac{16}{25}p_{11} = \\frac{6}{25}p_{12} + \\frac{1}{25}p_{22} + \\sigma_{w}^{2}$。\n两边乘以 $25$： $16 p_{11} = 6 p_{12} + p_{22} + 25 \\sigma_{w}^{2}$。\n代入 $p_{12}$ 和 $p_{22}$ 的表达式：\n$$ 16 p_{11} = 6(\\frac{4}{21}\\sigma_{w}^{2}) + \\frac{4}{3}\\sigma_{w}^{2} + 25\\sigma_{w}^{2} = (\\frac{24}{21} + \\frac{28}{21} + 25 \\cdot \\frac{21}{21})\\sigma_{w}^{2} $$\n$$ 16 p_{11} = (\\frac{52}{21} + \\frac{525}{21})\\sigma_{w}^{2} = \\frac{577}{21}\\sigma_{w}^{2} $$\n$$ p_{11} = \\frac{577}{16 \\cdot 21}\\sigma_{w}^{2} = \\frac{577}{336}\\sigma_{w}^{2} $$\n稳态状态协方差矩阵为 $P = \\sigma_{w}^{2} \\begin{bmatrix} \\frac{577}{336} & \\frac{4}{21} \\\\ \\frac{4}{21} & \\frac{4}{3} \\end{bmatrix}$。\n\n接下来，我们计算稳态输出方差 $\\sigma_{y}^{2} = \\mathbb{E}\\{y[n]^{2}\\}$。由于 $w[n]$ 和 $x[0]$ 是零均值的，所以 $x[n]$ 以及 $y[n]=Cx[n]$ 也是零均值的。因此，方差即为二阶矩。\n$$ \\sigma_{y}^{2} = \\mathbb{E}\\{y[n] y[n]^{\\top}\\} = \\mathbb{E}\\{(C x[n])(C x[n])^{\\top}\\} = \\mathbb{E}\\{C x[n] x[n]^{\\top} C^{\\top}\\} $$\n$$ \\sigma_{y}^{2} = C \\, \\mathbb{E}\\{x[n] x[n]^{\\top}\\} \\, C^{\\top} = C P C^{\\top} $$\n当 $C = \\begin{bmatrix} 1 & -1 \\end{bmatrix}$ 且 $C^{\\top} = \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix}$ 时：\n$$ \\sigma_{y}^{2} = \\begin{bmatrix} 1 & -1 \\end{bmatrix} \\begin{bmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{bmatrix} \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix} = p_{11} - 2p_{12} + p_{22} $$\n代入已解出的值：\n$$ \\sigma_{y}^{2} = \\left(\\frac{577}{336} - 2 \\cdot \\frac{4}{21} + \\frac{4}{3}\\right) \\sigma_{w}^{2} $$\n为了合并这些项，我们使用公分母 $336$：\n$$ \\sigma_{y}^{2} = \\left(\\frac{577}{336} - \\frac{8 \\cdot 16}{21 \\cdot 16} + \\frac{4 \\cdot 112}{3 \\cdot 112}\\right) \\sigma_{w}^{2} = \\left(\\frac{577 - 128 + 448}{336}\\right) \\sigma_{w}^{2} $$\n$$ \\sigma_{y}^{2} = \\left(\\frac{449 + 448}{336}\\right) \\sigma_{w}^{2} = \\frac{897}{336}\\sigma_{w}^{2} $$\n通过将分子和分母除以 $3$ 来简化分数：\n$$ \\sigma_{y}^{2} = \\frac{299}{112}\\sigma_{w}^{2} $$\n\n该问题要求与 $\\mathcal{H}_{2}$ 范数建立关系。从噪声输入 $w[n]$ 到输出 $y[n]$ 的系统具有状态空间表示 $(A, B, C, D) = (A, I_{2}, C, 0)$。其传递函数为 $H(z) = C(zI - A)^{-1}I_{2}$。该系统的 $\\mathcal{H}_{2}$ 范数的平方通过其脉冲响应 $h[n] = CA^{n-1}I_2$（对于 $n \\ge 1$）定义为 $\\|H\\|_{\\mathcal{H}_2}^{2} = \\sum_{n=0}^{\\infty} \\text{tr}(h[n]h[n]^{\\top})$。线性系统理论的一个基本结果表明，该范数也可以通过可控性格拉姆矩阵 $W_{c}$ 计算，该矩阵是李雅普诺夫方程 $W_{c} = A W_{c} A^{\\top} + B B^{\\top}$ 的解。在我们的例子中，$B=I_2$，所以 $W_{c} = A W_{c} A^{\\top} + I_{2}$。那么范数就是 $\\|H\\|_{\\mathcal{H}_2}^{2} = \\text{tr}(C W_{c} C^{\\top})$。\n将 $W_c$ 的李雅普诺夫方程与我们的状态协方差 $P = A P A^{\\top} + \\sigma_{w}^{2} I_{2}$ 的方程进行比较，根据线性性质我们可以看出 $P = \\sigma_{w}^{2} W_{c}$。\n输出方差为 $\\sigma_{y}^{2} = C P C^{\\top} = C (\\sigma_{w}^{2} W_{c}) C^{\\top} = \\sigma_{w}^{2} (C W_{c} C^{\\top})$。\n由于 $C W_{c} C^{\\top}$ 是一个标量，它等于其自身的迹。因此，$\\sigma_{y}^{2} = \\sigma_{w}^{2} \\text{tr}(C W_{c} C^{\\top}) = \\sigma_{w}^{2} \\|H\\|_{\\mathcal{H}_2}^{2}$。\n这就建立了所需的关系。输出方差 $\\sigma_{y}^{2}$ 与 $\\mathcal{H}_{2}$ 范数的平方之间的比例常数是 $\\sigma_{w}^{2}$。\n\n最后，我们用 $\\Delta$ 来表示 $\\sigma_{y}^{2}$。使用给定关系 $\\sigma_{w}^{2} = \\frac{\\Delta^{2}}{12}$：\n$$ \\sigma_{y}^{2} = \\frac{299}{112} \\left(\\frac{\\Delta^{2}}{12}\\right) = \\frac{299}{112 \\cdot 12}\\Delta^{2} = \\frac{299}{1344}\\Delta^{2} $$\n此表达式无法进一步简化，因为 $299 = 13 \\cdot 23$ 和 $1344 = 112 \\cdot 12 = (16 \\cdot 7) \\cdot (3 \\cdot 4) = 2^6 \\cdot 3 \\cdot 7$ 没有公因数。", "answer": "$$\\boxed{\\frac{299}{1344}\\Delta^{2}}$$", "id": "2872507"}]}