{"hands_on_practices": [{"introduction": "线性时不变（LTI）系统的一个基本原则是，一个复杂的系统通常可以分解为更简单的子系统。本练习将演示如何通过直接观察系统的脉冲响应，将其以并联形式实现。通过将脉冲响应 $h[n]$ 分解为简单指数分量的和，你将确定相应一阶子系统的参数，这些子系统并联组合后能够重现整个系统的行为 [@problem_id:1701264]。", "problem": "一个离散时间线性时不变（LTI）系统由其脉冲响应来表征，其表达式为：\n$$h[n] = (0.5)^{n} u[n] + (-0.5)^{n} u[n]$$\n其中 $u[n]$ 是因果单位阶跃函数，定义为当 $n \\ge 0$ 时 $u[n] = 1$，当 $n < 0$ 时 $u[n] = 0$。\n\n该系统将使用一个由两个稳定的一阶子系统组成的并联结构来实现。总传递函数 $H(z)$ 是这两个子系统传递函数之和，即 $H(z) = H_1(z) + H_2(z)$。每个一阶子系统 $k \\in \\{1, 2\\}$ 的传递函数定义为：\n$$H_k(z) = \\frac{b_k}{1 - a_k z^{-1}}$$\n其中 $a_k$ 和 $b_k$ 是实值系数。\n\n为确保解的唯一性，系数按 $a_1 > a_2$ 的顺序排列。确定实现该给定系统的系数 $a_1, b_1, a_2, b_2$ 的值。请将您的四个答案按 $\\begin{pmatrix} a_1 & b_1 & a_2 & b_2 \\end{pmatrix}$ 的顺序以单行矩阵的形式呈现。", "solution": "给定的脉冲响应为\n$$\nh[n] = \\left(\\frac{1}{2}\\right)^{n} u[n] + \\left(-\\frac{1}{2}\\right)^{n} u[n].\n$$\n对于一个传递函数为\n$$\nH_{k}(z) = \\frac{b_{k}}{1 - a_{k} z^{-1}},\n$$\n的一阶子系统，其对应的脉冲响应通过Z逆变换得到。使用标准变换对 $\\mathcal{Z}\\{a^{n} u[n]\\} = \\frac{1}{1 - a z^{-1}}$（对于 $|z| > |a|$），我们有\n$$\nh_{k}[n] = b_{k} a_{k}^{n} u[n].\n$$\n由于整个系统是两个此类子系统的并联和，总脉冲响应必须满足\n$$\nh[n] = h_{1}[n] + h_{2}[n] = b_{1} a_{1}^{n} u[n] + b_{2} a_{2}^{n} u[n].\n$$\n与给定的 $h[n]$ 进行比较，两个不同的指数项直接对应于\n$$\na_{1} = \\frac{1}{2}, \\quad b_{1} = 1, \\quad a_{2} = -\\frac{1}{2}, \\quad b_{2} = 1,\n$$\n这也满足排序约束 $a_{1} > a_{2}$，因为 $\\frac{1}{2} > -\\frac{1}{2}$。在 $z$ 域中进行一致性检查，\n$$\nH(z) = \\mathcal{Z}\\{h[n]\\} = \\frac{1}{1 - \\frac{1}{2} z^{-1}} + \\frac{1}{1 + \\frac{1}{2} z^{-1}} = \\frac{1}{1 - a_{1} z^{-1}} b_{1} + \\frac{1}{1 - a_{2} z^{-1}} b_{2},\n$$\n从而确认了所识别的系数。两个子系统都是稳定的，因为 $|a_{1}| < 1$ 且 $|a_{2}| < 1$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2} & 1 & -\\frac{1}{2} & 1 \\end{pmatrix}}$$", "id": "1701264"}, {"introduction": "虽然单极点可以导出直接的一阶并联支路，但具有重根（repeated poles）的系统需要更细致的处理方法。本练习要求你对一个具有重根的传递函数进行部分分式展开，阐明高阶项如何对应于并联支路，而这些支路本身又是基本模块的级联。此练习深化了你对传递函数 $H(s)$ 的代数结构与其物理实现之间关系的理解 [@problem_id:2856865]。", "problem": "一个线性时不变 (LTI) 单输入单输出系统，其在拉普拉斯域中的传递函数由有理函数 $H(s)$ 定义。一个并联型结构将 $H(s)$ 表示为多个并联子系统的传递函数之和，当极点为重极点时，其部分分式展开会包含与这些重极点相关的高阶项。考虑传递函数\n$$\nH(s) = \\frac{2s+3}{(s+1)^{3}}.\n$$\n从拉普拉斯变换的基本定义、传递函数 $H(s)=Y(s)/X(s)$ 的定义，以及任何真有理传递函数都可以通过部分分式展开表示为更简单有理函数之和的原理出发，完成以下任务：\n- 推导 $H(s)$ 的部分分式展开，该展开需显式地处理在 $s=-1$ 处的重极点直至其最高重数。\n- 阐明此展开式中的每一项如何对应一个由一阶基本模块构建的并联型实现中的分支，并基于LTI系统分解的第一性原理，解释重极点在此映射中的作用。\n\n您的最终答案必须是 $H(s)$ 的显式部分分式展开，表示为单个封闭形式的解析表达式。不需要进行数值取整。请勿包含单位。", "solution": "核心原理是将一个复杂系统分解为一组更简单的子系统。对于一个由真有理传递函数 $H(s)$ 描述的LTI系统，这种分解是通过部分分式展开来实现的。所得到的结构，其中总输出是由相同输入驱动的各子系统输出之和，被称为并联型实现。该传递函数为\n$$\nH(s) = \\frac{2s+3}{(s+1)^{3}}\n$$\n该函数在 $s = -1$ 处有一个重数为 $m=3$ 的极点。对于一个在 $s=p$ 处重数为 $m$ 的极点，其部分分式展开必须包含从 $k=1$到 $k=m$ 的所有 $(s-p)^{-k}$ 次幂的项。因此，给定 $H(s)$ 的展开式必须具有以下形式：\n$$\nH(s) = \\frac{A_1}{s+1} + \\frac{A_2}{(s+1)^2} + \\frac{A_3}{(s+1)^3}\n$$\n对于在 $s=p$ 处重数为 $m$ 的重极点，其系数 $A_k$ 由通用公式确定：\n$$\nA_{m-k} = \\frac{1}{k!} \\frac{d^k}{ds^k} \\left[ (s-p)^m H(s) \\right] \\bigg|_{s=p}\n$$\n在本问题中，$p=-1$ 且 $m=3$。我们定义函数 $\\Phi(s)$ 为：\n$$\n\\Phi(s) = (s+1)^3 H(s) = (s+1)^3 \\left( \\frac{2s+3}{(s+1)^3} \\right) = 2s+3\n$$\n现在我们可以计算系数 $A_3$、$A_2$ 和 $A_1$。\n\n对于 $A_3$，我们设 $k=m-3=0$：\n$$\nA_3 = A_{3-0} = \\frac{1}{0!} \\frac{d^0}{ds^0} [\\Phi(s)] \\bigg|_{s=-1} = \\Phi(s) \\bigg|_{s=-1} = (2s+3) \\bigg|_{s=-1} = 2(-1) + 3 = 1\n$$\n对于 $A_2$，我们设 $k=m-2=1$：\n$$\nA_2 = A_{3-1} = \\frac{1}{1!} \\frac{d}{ds} [\\Phi(s)] \\bigg|_{s=-1} = \\frac{d}{ds} (2s+3) \\bigg|_{s=-1} = 2 \\bigg|_{s=-1} = 2\n$$\n对于 $A_1$，我们设 $k=m-1=2$：\n$$\nA_1 = A_{3-2} = \\frac{1}{2!} \\frac{d^2}{ds^2} [\\Phi(s)] \\bigg|_{s=-1} = \\frac{1}{2} \\frac{d^2}{ds^2} (2s+3) \\bigg|_{s=-1} = \\frac{1}{2} \\frac{d}{ds}(2) \\bigg|_{s=-1} = \\frac{1}{2}(0) = 0\n$$\n将这些系数代回展开式，得到 $H(s)$ 的完整部分分式形式：\n$$\nH(s) = \\frac{0}{s+1} + \\frac{2}{(s+1)^2} + \\frac{1}{(s+1)^3}\n$$\n这个表达式就是考虑了重数为3的重极点的显式展开。\n\n现在，我们基于第一性原理来论证并联型实现。传递函数 $H(s)$ 通过关系式 $Y(s) = H(s)X(s)$ 将经过拉普拉斯变换的输出 $Y(s)$ 与输入 $X(s)$ 联系起来。使用我们推导出的展开式：\n$$\nY(s) = \\left( \\frac{0}{s+1} + \\frac{2}{(s+1)^2} + \\frac{1}{(s+1)^3} \\right) X(s)\n$$\n根据线性性质，这等价于：\n$$\nY(s) = \\left(\\frac{0}{s+1}\\right)X(s) + \\left(\\frac{2}{(s+1)^2}\\right)X(s) + \\left(\\frac{1}{(s+1)^3}\\right)X(s)\n$$\n我们将展开式中的各个项定义为子系统的传递函数 $H_1(s)$、$H_2(s)$ 和 $H_3(s)$：\n$$\nH_1(s) = \\frac{0}{s+1}, \\quad H_2(s) = \\frac{2}{(s+1)^2}, \\quad H_3(s) = \\frac{1}{(s+1)^3}\n$$\n总系统传递函数是这些子系统传递函数之和 $H(s) = H_1(s) + H_2(s) + H_3(s)$。相应地，当每个子系统由共同输入 $X(s)$ 驱动时，总输出是各子系统输出之和：\n$$\nY(s) = Y_1(s) + Y_2(s) + Y_3(s), \\quad \\text{其中 } Y_k(s) = H_k(s)X(s)\n$$\n这种由单个输入驱动多个子系统，并将其输出相加的结构，正是并联型实现的定义。\n\n重极点的作用对于定义这些并联分支的性质至关重要。\n- 对于一个在 $s=p$ 处的单极点（非重极点），其对应的分支是一个传递函数为 $\\frac{A}{s-p}$ 的一阶系统。\n- 对于重极点，会出现形如 $\\frac{A}{(s-p)^k}$ 且 $k>1$ 的项。一个传递函数为 $H_k(s) = \\frac{1}{(s-p)^k}$ 的子系统不是一阶系统。相反，它等效于 $k$ 个相同的一阶系统串联，每个系统的传递函数都为 $\\frac{1}{s-p}$。这从以下关系中可以明显看出：\n$$\n\\frac{1}{(s-p)^k} = \\left(\\frac{1}{s-p}\\right) \\times \\left(\\frac{1}{s-p}\\right) \\times \\cdots \\times \\left(\\frac{1}{s-p}\\right) \\quad (k \\text{ 次})\n$$\n在我们的例子中，并联分支是：\n1. $H_1(s) = \\frac{0}{s+1}$：一个增益为零的一阶系统，对输出没有贡献。\n2. $H_2(s) = \\frac{2}{(s+1)^2}$：一个等效于两个一阶基本模块 $\\frac{1}{s+1}$ 串联，然后再乘以增益 $2$ 的子系统。\n3. $H_3(s) = \\frac{1}{(s+1)^3}$：一个等效于三个一阶基本模块 $\\frac{1}{s+1}$ 串联的子系统。\n\n因此，重数为 $m$ 的重极点的存在，要求包含 $m$ 个并联分支，其中每个分支 $k$（对于 $k=1, \\dots, m$）本身是 $k$ 个与该极点位置相关的基本一阶积分器的串联，并由系数 $A_k$ 进行缩放。这展示了重极点的部分分式展开的代数结构如何直接映射到一个由串联一阶元件的并联组合构成的物理实现或框图实现。", "answer": "$$\n\\boxed{\\frac{0}{s+1} + \\frac{2}{(s+1)^{2}} + \\frac{1}{(s+1)^{3}}}\n$$", "id": "2856865"}, {"introduction": "级联结构在数字滤波器实现中被广泛使用，但其实际应用的成功取决于对内部信号电平的精细管理。本练习让你扮演滤波器设计者的角色，任务是通过策略性地插入缩放因子来防止定点系统中的数值溢出。你将应用最坏情况增益的概念，为每个二阶节（biquad section）确定合适的缩放比例，这是设计稳健可靠的数字信号处理系统的一项关键技能 [@problem_id:2856870]。", "problem": "考虑一个离散时间线性时不变（LTI）数字滤波器，它通过级联三个直接II型转置结构的二阶节（biquad）实现。设输入信号的幅值有界，满足 $|x[n]| \\leq X_{\\max}$，其中 $X_{\\max} = 0.2$（以归一化全幅单位计），且全幅饱和发生在幅值为 $1$ 时。对于每个 biquad $k \\in \\{1,2,3\\}$，给定两个诱导$\\ell_{\\infty}$范数（也称为$H_{\\infty}$范数）：\n- $\\,\\beta_k\\,$，该节的最坏情况输入到输出增益界，\n- $\\,\\alpha_k\\,$，该节的最坏情况输入到最大内部状态增益界，\n因此，对于任意有界输入幅值 $U$，该节的输出幅值有界于 $\\beta_k U$，而该节内部的最大内部状态幅值有界于 $\\alpha_k U$。\n\n各节的参数如下：\n- 第1节：$\\alpha_1 = 2.7$，$\\beta_1 = 1.6$，\n- 第2节：$\\alpha_2 = 1.8$，$\\beta_2 = 1.2$，\n- 第3节：$\\alpha_3 = 3.0$，$\\beta_3 = 0.9$。\n\n允许在每节 $k$ 的前后插入一个对称的2的幂次缩放：在节的输入端乘以一个前置缩放因子 $c_k = 2^{m_k}$（$m_k \\in \\mathbb{Z}$），并在节的输出端乘以一个后置缩放因子 $1/c_k$。这样做可以保持总的端到端传递函数幅值不变，但会改变该节内部的内部状态幅值。字长要求任何内部节点（包括所有级间连接点和内部状态）的幅值必须严格小于全幅值 $1$，以避免溢出。\n\n请设计每节的缩放因子 $c_k$，以防止所有内部节点发生溢出。然后，在您的设计下，假设输入有界于 $|x[n]| \\leq 0.2$，确定整个级联结构中任何内部节点（包括级间连接点和内部状态）所能达到的最大最坏情况幅值。将您的最终答案四舍五入到四位有效数字，并以归一化全幅单位表示（无单位符号）。", "solution": "设该离散时间LTI系统为 $N=3$ 个二阶节的级联。令 $u_k[n]$ 为第 $k$ 个缩放节的输入（$k \\in \\{1, 2, 3\\}$），$y_k[n]$ 为其输出。整个滤波器的输入为 $x[n]$，因此 $u_1[n] = x[n]$。各节是级联的，因此 $u_{k+1}[n] = y_k[n]$。输入信号幅值有界，满足 $|x[n]| \\le X_{\\max}$，其中 $X_{\\max} = 0.2$。令 $U_k$ 为第 $k$ 个缩放节输入处的最坏情况幅值（信号的$\\ell_{\\infty}$范数），即 $U_k = \\sup_{n} |u_k[n]|$。因此，$U_1 = X_{\\max} = 0.2$。\n\n在每个缩放节 $k$ 内部，输入信号 $u_k[n]$ 首先乘以一个缩放因子 $c_k = 2^{m_k}$，其中 $m_k \\in \\mathbb{Z}$。因此，biquad本身的输入是 $c_k u_k[n]$。问题为每个biquad提供了两个增益参数：\n1. $\\alpha_k$：从biquad输入到其最大内部状态幅值的最坏情况增益。\n2. $\\beta_k$：从biquad输入到其输出的最坏情况增益。\n\nbiquad $k$ 中内部状态的最坏情况幅值，记为 $S_k$，其上界为 biquad 输入的幅值乘以 $\\alpha_k$。\n$$\nS_k = \\alpha_k \\sup_{n} |c_k u_k[n]| = \\alpha_k c_k U_k\n$$\nbiquad 输出的最坏情况幅值为 $\\beta_k c_k U_k$。该信号随后被缩放因子 $1/c_k$ 缩放，以产生缩放节的输出 $y_k[n]$。因此，$y_k[n]$ 的最坏情况幅值为：\n$$\nU_{k+1} = \\sup_{n} |y_k[n]| = \\frac{1}{c_k} (\\beta_k c_k U_k) = \\beta_k U_k\n$$\n这为级间连接点的最坏情况幅值建立了一个递推关系。使用给定的值 $\\beta_1 = 1.6$，$\\beta_2 = 1.2$ 和 $\\beta_3 = 0.9$：\n$$\nU_1 = X_{\\max} = 0.2\n$$\n$$\nU_2 = \\beta_1 U_1 = 1.6 \\times 0.2 = 0.32\n$$\n$$\nU_3 = \\beta_2 U_2 = 1.2 \\times 0.32 = 0.384\n$$\n$$\nU_4 = \\beta_3 U_3 = 0.9 \\times 0.384 = 0.3456\n$$\n$U_4$ 是最终输出信号的最坏情况幅值。滤波器的内部节点包括每个biquad内的内部状态和级间连接点。为防止溢出，每个内部节点的幅值必须严格小于 $1$。\n\n约束条件是：\n1. 对于内部状态：$S_k < 1 \\implies \\alpha_k c_k U_k < 1$，对于 $k \\in \\{1, 2, 3\\}$。\n2. 对于级间连接点：$U_k < 1$，对于 $k \\in \\{2, 3, 4\\}$。\n\n级间连接点的幅值为 $U_2=0.32$，$U_3=0.384$ 和 $U_4=0.3456$。它们都小于 $1$，因此无论如何缩放，这些节点都不会溢出。\n\n我们必须选择缩放因子 $c_k$ 来满足内部状态的约束。对于每个 $c_k$ 的最优选择是满足该不等式的最大2的幂次，因为这样可以最大化利用可用的动态范围。对每个 $c_k$ 的约束是：\n$$\nc_k < \\frac{1}{\\alpha_k U_k}\n$$\n\n对于第 $k=1$ 节：\n给定 $\\alpha_1 = 2.7$。\n$$\nc_1 < \\frac{1}{\\alpha_1 U_1} = \\frac{1}{2.7 \\times 0.2} = \\frac{1}{0.54} \\approx 1.85185\n$$\n小于 $1.85185$ 的最大2的幂次 $2^{m_1}$ 是 $2^0 = 1$。所以，我们选择 $c_1 = 1$。\n\n对于第 $k=2$ 节：\n给定 $\\alpha_2 = 1.8$。\n$$\nc_2 < \\frac{1}{\\alpha_2 U_2} = \\frac{1}{1.8 \\times 0.32} = \\frac{1}{0.576} \\approx 1.73611\n$$\n小于 $1.73611$ 的最大2的幂次 $2^{m_2}$ 是 $2^0 = 1$。所以，我们选择 $c_2 = 1$。\n\n对于第 $k=3$ 节：\n给定 $\\alpha_3 = 3.0$。\n$$\nc_3 < \\frac{1}{\\alpha_3 U_3} = \\frac{1}{3.0 \\times 0.384} = \\frac{1}{1.152} \\approx 0.86805\n$$\n小于 $0.86805$ 的最大2的幂次 $2^{m_3}$ 是 $2^{-1} = 0.5$。所以，我们选择 $c_3 = 0.5$。\n\n在确定了缩放因子 $c_1 = 1$，$c_2 = 1$ 和 $c_3 = 0.5$ 后，我们现在计算所有内部节点的最大最坏情况幅值。我们必须评估所有的 $S_k$ 和 $U_k$（对于 $k>1$）。\n最坏情况幅值如下：\n- 第1节的内部状态：$S_1 = \\alpha_1 c_1 U_1 = 2.7 \\times 1 \\times 0.2 = 0.54$。\n- 第1节后的级间连接点：$U_2 = 0.32$。\n- 第2节的内部状态：$S_2 = \\alpha_2 c_2 U_2 = 1.8 \\times 1 \\times 0.32 = 0.576$。\n- 第2节后的级间连接点：$U_3 = 0.384$。\n- 第3节的内部状态：$S_3 = \\alpha_3 c_3 U_3 = 3.0 \\times 0.5 \\times 0.384 = 1.5 \\times 0.384 = 0.576$。\n- 最终输出节点：$U_4 = 0.3456$。\n\n我们必须找到这些值中的最大值：\n$$\n\\max\\{S_1, U_2, S_2, U_3, S_3, U_4\\} = \\max\\{0.54, 0.32, 0.576, 0.384, 0.576, 0.3456\\} = 0.576\n$$\n任何内部节点所能达到的最大最坏情况幅值为 $0.576$。问题要求将最终答案四舍五入到四位有效数字，结果为 $0.5760$。", "answer": "$$\n\\boxed{0.5760}\n$$", "id": "2856870"}]}