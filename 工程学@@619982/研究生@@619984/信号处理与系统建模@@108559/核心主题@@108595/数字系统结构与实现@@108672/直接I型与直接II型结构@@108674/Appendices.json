{"hands_on_practices": [{"introduction": "第一个练习是分析滤波器结构的基础。通过解决这个问题 [@problem_id:1714613]，你将学会如何直接从定义直接II型实现的耦合差分方程中，推导出系统的总传递函数 $H(z)$。这项技能对于理解滤波器结构如何决定其频率响应和整体行为至关重要。", "problem": "一个时间离散、线性时不变 (LTI) 系统，例如用于数字音频均衡器中的系统，采用一种称为直接II型实现的计算结构来实现。这种结构通过最小化延迟单元的数量来节省内存，因此在内存方面非常高效。\n\n该系统的行为由其输入序列 $x[n]$、输出序列 $y[n]$ 和一个内部中间序列 $w[n]$ 之间的关系来描述。中间序列 $w[n]$ 由输入及其自身的过去值根据以下递归差分方程生成：\n$$w[n] = x[n] - a_1 w[n-1] - a_2 w[n-2]$$\n输出序列 $y[n]$ 则由该中间序列的当前值和过去值根据以下非递归差分方程形成：\n$$y[n] = b_0 w[n] + b_1 w[n-1] + b_2 w[n-2]$$\n对于该系统的一个特定配置，滤波器系数如下：\n$a_1 = -0.7$\n$a_2 = 0.1$\n$b_0 = 2$\n$b_1 = 0.5$\n$b_2 = -0.3$\n\n确定系统的总传递函数 $H(z) = Y(z)/X(z)$。", "solution": "问题要求计算一个由两个差分方程描述其直接II型结构的系统的传递函数 $H(z)$。传递函数是输出的Z变换 $Y(z)$ 与输入的Z变换 $X(z)$ 之比。我们可以通过先对每个差分方程进行Z变换，然后进行代数合并来求得。\n\n第一个方程关联了中间信号 $w[n]$ 和输入信号 $x[n]$：\n$$w[n] = x[n] - a_1 w[n-1] - a_2 w[n-2]$$\n我们对这个方程应用Z变换。利用Z变换的时移性质，即 $\\mathcal{Z}\\{f[n-k]\\} = z^{-k}F(z)$，我们得到：\n$$W(z) = X(z) - a_1 z^{-1} W(z) - a_2 z^{-2} W(z)$$\n现在，我们重新整理这个方程以找到 $W(z)$ 和 $X(z)$ 之间的关系。我们将所有包含 $W(z)$ 的项移到一边：\n$$W(z) + a_1 z^{-1} W(z) + a_2 z^{-2} W(z) = X(z)$$\n提出公因子 $W(z)$，我们有：\n$$W(z) (1 + a_1 z^{-1} + a_2 z^{-2}) = X(z)$$\n这使我们能够将 $W(z)$ 与 $X(z)$ 的比率表示为一个传递函数，我们称之为 $H_1(z)$：\n$$H_1(z) = \\frac{W(z)}{X(z)} = \\frac{1}{1 + a_1 z^{-1} + a_2 z^{-2}}$$\n\n接下来，我们考虑第二个方程，它关联了输出信号 $y[n]$ 和中间信号 $w[n]$：\n$$y[n] = b_0 w[n] + b_1 w[n-1] + b_2 w[n-2]$$\n再次，我们应用Z变换及其时移性质：\n$$Y(z) = b_0 W(z) + b_1 z^{-1} W(z) + b_2 z^{-2} W(z)$$\n从右边提出公因子 $W(z)$ 得到：\n$$Y(z) = W(z) (b_0 + b_1 z^{-1} + b_2 z^{-2})$$\n这定义了从中间信号到输出的传递函数，我们称之为 $H_2(z)$：\n$$H_2(z) = \\frac{Y(z)}{W(z)} = b_0 + b_1 z^{-1} + b_2 z^{-2}$$\n\n总传递函数 $H(z) = Y(z)/X(z)$ 是这两个传递函数的乘积，因为该系统是 $H_1(z)$ 和 $H_2(z)$ 的级联：\n$$H(z) = \\frac{Y(z)}{X(z)} = \\frac{Y(z)}{W(z)} \\cdot \\frac{W(z)}{X(z)} = H_2(z) H_1(z)$$\n代入 $H_1(z)$ 和 $H_2(z)$ 的表达式：\n$$H(z) = (b_0 + b_1 z^{-1} + b_2 z^{-2}) \\cdot \\left( \\frac{1}{1 + a_1 z^{-1} + a_2 z^{-2}} \\right)$$\n$$H(z) = \\frac{b_0 + b_1 z^{-1} + b_2 z^{-2}}{1 + a_1 z^{-1} + a_2 z^{-2}}$$\n这是二阶IIR滤波器在直接II型实现下传递函数的一般形式。\n\n最后，我们代入给定的系数数值：\n$a_1 = -0.7$\n$a_2 = 0.1$\n$b_0 = 2$\n$b_1 = 0.5$\n$b_2 = -0.3$\n\n将这些值代入 $H(z)$ 的通用表达式中：\n$$H(z) = \\frac{2 + (0.5) z^{-1} + (-0.3) z^{-2}}{1 + (-0.7) z^{-1} + (0.1) z^{-2}}$$\n$$H(z) = \\frac{2 + 0.5 z^{-1} - 0.3 z^{-2}}{1 - 0.7 z^{-1} + 0.1 z^{-2}}$$\n这是系统传递函数的最终闭合形式表达式。", "answer": "$$\\boxed{\\frac{2 + 0.5z^{-1} - 0.3z^{-2}}{1 - 0.7z^{-1} + 0.1z^{-2}}}$$", "id": "1714613"}, {"introduction": "这个练习 [@problem_id:1714590] 探索了直接I型和直接II型结构之间优雅的关系。我们将看到，直接I型实现可以看作是两个线性时不变 (LTI) 子系统的级联。通过应用一个基本原理——级联的LTI系统可以交换顺序而不改变总传递函数——你将发现直接II型结构是如何自然产生的，这为我们理解为何这两种形式等效提供了更深刻的概念性视角。", "problem": "一个输入为 $x[n]$、输出为 $y[n]$ 的因果线性时不变 (LTI) 系统采用直接I型结构实现。该实现在概念上分为两个级联的子系统：一个前馈部分和一个反馈部分。\n\n前馈部分首先根据以下关系处理输入 $x[n]$，生成一个中间信号 $w[n]$：\n$$w[n] = \\beta_0 x[n] + \\beta_1 x[n-1]$$\n\n这个中间信号 $w[n]$ 随后由反馈部分处理，根据以下差分方程产生最终输出 $y[n]$：\n$$y[n] - \\alpha_1 y[n-1] - \\alpha_2 y[n-2] = w[n]$$\n系数 $\\alpha_1, \\alpha_2, \\beta_0, \\beta_1$ 均为实值常数。\n\n通过交换这两个部分的顺序，构建了一个新系统。在这个新配置中，输入 $x[n]$ 首先被送到原为反馈部分的模块，产生一个新的中间信号 $v[n]$。这个信号 $v[n]$ 接着被输入到原为前馈部分的模块，得到一个新的最终输出 $y_{new}[n]$。\n\n设 $H_{new}(z)$ 为这个新系统的传递函数。下列哪个表达式正确地表示了 $H_{new}(z)$？\n\nA. $H_{new}(z) = \\frac{\\beta_0 + \\beta_1 z^{-1}}{1 - \\alpha_1 z^{-1} - \\alpha_2 z^{-2}}$\n\nB. $H_{new}(z) = \\frac{1 - \\alpha_1 z^{-1} - \\alpha_2 z^{-2}}{\\beta_0 + \\beta_1 z^{-1}}$\n\nC. $H_{new}(z) = (\\beta_0 + \\beta_1 z^{-1})(1 - \\alpha_1 z^{-1} - \\alpha_2 z^{-2})$\n\nD. $H_{new}(z) = \\frac{1 + \\beta_0 + \\beta_1 z^{-1}}{1 - \\alpha_1 z^{-1} - \\alpha_2 z^{-2}}$\n\nE. $H_{new}(z) = \\beta_0 + \\beta_1 z^{-1} + \\frac{1}{1 - \\alpha_1 z^{-1} - \\alpha_2 z^{-2}}$", "solution": "我们假设在Z变换的推导中初始条件为零。原始系统是一个前馈FIR部分后跟一个反馈IIR部分的级联。\n\n首先，求出每个部分的传递函数：\n- 前馈部分：由 $w[n] = \\beta_{0} x[n] + \\beta_{1} x[n-1]$ 给出。进行Z变换，\n$$W(z) = \\left(\\beta_{0} + \\beta_{1} z^{-1}\\right) X(z),$$\n所以从 $x$ 到 $w$ 的传递函数是\n$$H_{\\text{ff}}(z) = \\frac{W(z)}{X(z)} = \\beta_{0} + \\beta_{1} z^{-1}.$$\n- 反馈部分：由 $y[n] - \\alpha_{1} y[n-1] - \\alpha_{2} y[n-2] = w[n]$ 给出。进行Z变换，\n$$Y(z) - \\alpha_{1} z^{-1} Y(z) - \\alpha_{2} z^{-2} Y(z) = W(z),$$\n由此得到从 $w$ 到 $y$ 的传递函数：\n$$H_{\\text{fb}}(z) = \\frac{Y(z)}{W(z)} = \\frac{1}{1 - \\alpha_{1} z^{-1} - \\alpha_{2} z^{-2}}.$$\n\n在新配置中，顺序被交换。设当反馈模块的输入为 $x[n]$ 时，其输出为 $v[n]$。则\n$$\\frac{V(z)}{X(z)} = H_{\\text{fb}}(z) = \\frac{1}{1 - \\alpha_{1} z^{-1} - \\alpha_{2} z^{-2}}.$$\n接下来，$v[n]$ 通过前馈模块以产生 $y_{\\text{new}}[n]$，所以\n$$\\frac{Y_{\\text{new}}(z)}{V(z)} = H_{\\text{ff}}(z) = \\beta_{0} + \\beta_{1} z^{-1}.$$\n因此，新系统的总传递函数是两者的乘积\n$$H_{\\text{new}}(z) = \\frac{Y_{\\text{new}}(z)}{X(z)} = \\left(\\beta_{0} + \\beta_{1} z^{-1}\\right) \\cdot \\frac{1}{1 - \\alpha_{1} z^{-1} - \\alpha_{2} z^{-2}}.$$\n\n这与选项A相符。", "answer": "$$\\boxed{A}$$", "id": "1714590"}, {"introduction": "从分析转向应用，这最后一个练习 [@problem_id:1714591] 提出了一个信号处理中的常见场景：系统辨识。这个问题将指导你如何仅使用其单位冲激响应的前几个采样点，来反向工程确定一个“黑匣子”滤波器的未知反馈系数。这项技术是从实验数据中表征和建模未知系统的更高级方法的基础。", "problem": "一位工程师的任务是表征一个未知的因果二阶线性时不变（LTI）数字滤波器。这类滤波器通常使用直接型结构实现，其输入输出关系可以用一个通用的有理传递函数 $H(z)$ 来描述：\n$$H(z) = \\frac{Y(z)}{X(z)} = \\frac{b_0 + b_1 z^{-1} + b_2 z^{-2}}{1 + a_1 z^{-1} + a_2 z^{-2}}$$\n这是二阶无限脉冲响应（IIR）滤波器的通用形式。\n\n通过初步分析，该工程师确定该滤波器有一个简单的前馈路径，其系数为 $b_0 = 2$、$b_1 = 0$ 和 $b_2 = 0$。为了确定反馈系数，将一个定义为 $x[n] = \\delta[n]$ 的单位脉冲输入施加到滤波器上。测得所得到的输出脉冲响应 $h[n]$ 的前三个样本值为：\n$h[0] = 2$\n$h[1] = 1.6$\n$h[2] = 0.48$\n\n根据这些信息，确定反馈系数 $a_1$ 和 $a_2$ 的数值。答案应以有序对 $(a_1, a_2)$ 的形式给出。", "solution": "对于一个传递函数为\n$$H(z)=\\frac{Y(z)}{X(z)}=\\frac{b_{0}+b_{1}z^{-1}+b_{2}z^{-2}}{1+a_{1}z^{-1}+a_{2}z^{-2}}$$\n的因果二阶LTI IIR滤波器，其对应的时域差分方程通过将两边同乘以分母并进行z逆变换得到：\n$$y[n]+a_{1}y[n-1]+a_{2}y[n-2]=b_{0}x[n]+b_{1}x[n-1]+b_{2}x[n-2].$$\n给定 $b_{0}=2$、$b_{1}=0$ 和 $b_{2}=0$，上式简化为\n$$y[n]+a_{1}y[n-1]+a_{2}y[n-2]=2x[n].$$\n当输入为脉冲输入 $x[n]=\\delta[n]$ 且初始条件为零（因果性和初始静止）时，输出即为脉冲响应 $h[n]=y[n]$，它满足\n$$h[n]+a_{1}h[n-1]+a_{2}h[n-2]=2\\delta[n].$$\n使用 $h[-1]=0$ 和 $h[-2]=0$ 对 $n=0,1,2$ 计算此递推关系：\n- 对于 $n=0$：\n$$h[0]+a_{1}h[-1]+a_{2}h[-2]=2 \\implies h[0]=2,$$\n与测量值一致。\n- 对于 $n=1$：\n$$h[1]+a_{1}h[0]+a_{2}h[-1]=0 \\implies h[1]+a_{1}h[0]=0 \\implies a_{1}=-\\frac{h[1]}{h[0]}.$$\n使用 $h[1]=1.6=\\frac{8}{5}$ 和 $h[0]=2$，\n$$a_{1}=-\\frac{\\frac{8}{5}}{2}=-\\frac{8}{10}=-\\frac{4}{5}.$$\n- 对于 $n=2$：\n$$h[2]+a_{1}h[1]+a_{2}h[0]=0 \\implies a_{2}=-\\frac{h[2]+a_{1}h[1]}{h[0]}.$$\n使用 $h[2]=0.48=\\frac{12}{25}$，$h[1]=\\frac{8}{5}$ 和 $a_{1}=-\\frac{4}{5}$，\n$$h[2]+a_{1}h[1]=\\frac{12}{25}-\\frac{4}{5}\\cdot\\frac{8}{5}=\\frac{12}{25}-\\frac{32}{25}=-\\frac{20}{25}=-\\frac{4}{5},$$\n因此\n$$a_{2}=-\\frac{-\\frac{4}{5}}{2}=\\frac{4}{5}\\cdot\\frac{1}{2}=\\frac{2}{5}.$$\n因此，反馈系数为 $a_{1}=-\\frac{4}{5}$ 和 $a_{2}=\\frac{2}{5}$。", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{4}{5} & \\frac{2}{5}\\end{pmatrix}}$$", "id": "1714591"}]}