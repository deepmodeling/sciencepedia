{"hands_on_practices": [{"introduction": "在将理论应用于实践时，我们通常处理的是有限长度的离散数据。本练习探讨了在使用离散傅里叶变换（DFT）估计PSD时一个常见的陷阱：当信号频率未精确落在DFT频率点上时，会发生频谱泄漏。你将通过推导一个偏离频率点的正弦信号的泄漏模式，并量化由此产生的“扇形损失”（scalloping loss）或检测能力下降，来具体分析这一现象 [@problem_id:2892490]。", "problem": "考虑一个浸没在加性噪声中、相位未知的离散时间复正弦波。您观察一段有限长度的记录，并使用矩形窗计算其离散傅里叶变换 (DFT)。您的目标是描述当正弦波的频率不完全落在 DFT 谱线上时的频谱泄漏模式，并量化由此产生的可检测性损失。\n\n令观测到的时间序列为\n$$\nx[n] = A \\exp(\\mathrm{j}\\,\\omega_{0} n) + w[n], \\quad n \\in \\{0,1,\\ldots,N-1\\},\n$$\n其中 $A \\in \\mathbb{C}$ 是一个非零常数，$\\omega_{0} \\in \\mathbb{R}$ 是角频率（单位为弧度/采样点），$\\{w[n]\\}$ 是零均值加性高斯白噪声 (AWGN)，每个样本的方差为 $\\sigma^{2}$。您应用一个长度为 $N$ 的矩形窗 $w_{\\mathrm{R}}[n]$，其定义为当 $n \\in \\{0,1,\\ldots,N-1\\}$ 时 $w_{\\mathrm{R}}[n]=1$，否则 $w_{\\mathrm{R}}[n]=0$，并计算 $N$点离散傅里叶变换 (DFT)\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\!\\left(-\\mathrm{j}\\,\\frac{2\\pi k}{N} n\\right), \\quad k \\in \\{0,1,\\ldots,N-1\\}.\n$$\n\n假设正弦波频率不完全落在 DFT 谱线上。将其参数化为\n$$\n\\omega_{0} = \\frac{2\\pi}{N}\\big(k_{0}+\\delta\\big),\n$$\n其中 $k_{0} \\in \\{0,1,\\ldots,N-1\\}$ 是一个整数，$\\delta \\in (-\\tfrac{1}{2},\\tfrac{1}{2})\\setminus\\{0\\}$ 是分数仓偏移。定义谱线偏移 $m = k - k_{0} \\in \\mathbb{Z}$。\n\n任务：\n- 从 DFT、矩形窗的定义以及独立高斯随机变量在线性变换下的性质出发，推导无噪声分量的精确频谱泄漏模式，即仅由正弦波引起的、在谱线 $k$ 上的期望周期图样本的表达式，\n$$\n\\mathbb{E}\\!\\left[\\,|X[k]|^{2}\\,\\middle|\\,A \\exp(\\mathrm{j}\\,\\omega_{0} n)\\,\\right],\n$$\n该表达式是关于 $A$、$N$、$\\delta$ 和 $m$ 的函数。\n- 通过最强 DFT 谱线中的期望信号功率与该谱线中噪声贡献方差的比值，即单谱线信噪比 (SNR)，来对单谱线检测器中的可检测性进行建模。利用您的泄漏结果，找出当 $\\delta \\in (-\\tfrac{1}{2},\\tfrac{1}{2})$ 时最强的谱线，并推导可检测性损失因子\n$$\nL(N,\\delta),\n$$\n其定义为在相同的 $A$、$N$ 和 $\\sigma^{2}$ 条件下，分数偏移为 $\\delta$ 时的单谱线 SNR 与 $\\delta=0$（即正弦波落在谱线上）时的单谱线 SNR 的比值。请以简化的解析表达式给出 $L(N,\\delta)$ 的闭合形式。\n\n最终答案仅报告 $L(N,\\delta)$ 的表达式。无需进行数值计算。如果您引入任何缩写词，如离散傅里叶变换 (DFT)、加性高斯白噪声 (AWGN)、功率谱密度 (PSD) 或信噪比 (SNR)，请在首次使用时给出定义。角度 $\\omega_{0}$ 的单位是弧度/采样点。", "solution": "所提出的问题是数字信号处理领域的一个标准问题，该问题是适定的，有科学依据，并拥有唯一、可验证的解。因此，我们可以进行形式化推导。\n\n观测到的时间序列为 $x[n] = s[n] + w[n]$，其中 $s[n] = A \\exp(\\mathrm{j}\\,\\omega_{0} n)$ 是复正弦信号，而 $w[n]$ 是方差为 $\\sigma^{2}$ 的零均值加性高斯白噪声 (AWGN)。$N$点离散傅里叶变换 (DFT) 是一种线性运算，因此我们可以独立分析信号分量和噪声分量。$x[n]$ 的 DFT 是 $X[k] = S[k] + W[k]$，其中 $S[k]$ 是信号分量 $s[n]$ 的 DFT，$W[k]$ 是噪声分量 $w[n]$ 的 DFT。\n\n首先，我们推导 $S[k]$ 的表达式，即无噪声信号的 DFT，它代表了频谱泄漏模式。信号频率参数化为 $\\omega_{0} = \\frac{2\\pi}{N}(k_{0}+\\delta)$。\n$$\nS[k] = \\sum_{n=0}^{N-1} s[n] \\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi k}{N} n\\right) = \\sum_{n=0}^{N-1} A \\exp(\\mathrm{j}\\,\\omega_{0} n) \\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi k}{N} n\\right)\n$$\n代入 $\\omega_{0}$ 的表达式：\n$$\nS[k] = A \\sum_{n=0}^{N-1} \\exp\\left(\\mathrm{j}\\,\\frac{2\\pi}{N}(k_{0}+\\delta) n\\right) \\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi k}{N} n\\right) = A \\sum_{n=0}^{N-1} \\exp\\left(\\mathrm{j}\\,\\frac{2\\pi}{N}(k_{0}+\\delta-k) n\\right)\n$$\n这是一个形式为 $\\sum_{n=0}^{N-1} r^{n}$ 的几何级数，其中 $r = \\exp\\left(\\mathrm{j}\\,\\frac{2\\pi}{N}(k_{0}+\\delta-k)\\right)$。因为 $\\delta \\in (-\\tfrac{1}{2}, \\tfrac{1}{2})\\setminus\\{0\\}$，项 $k_{0}+\\delta-k$ 永远不是整数，所以 $r \\neq 1$。应用有限几何级数的求和公式 $\\sum_{n=0}^{N-1} r^{n} = \\frac{1-r^{N}}{1-r}$：\n$$\nS[k] = A \\frac{1 - \\exp\\left(\\mathrm{j}\\,2\\pi(k_{0}+\\delta-k)\\right)}{1 - \\exp\\left(\\mathrm{j}\\,\\frac{2\\pi}{N}(k_{0}+\\delta-k)\\right)}\n$$\n由于 $k$ 和 $k_{0}$ 是整数，$\\exp(-\\mathrm{j}\\,2\\pi(k-k_{0})) = 1$。分子简化为 $1 - \\exp(\\mathrm{j}\\,2\\pi\\delta)$。\n为了求出其幅值，我们使用恒等式 $|1-\\exp(\\mathrm{j}\\,\\theta)| = | \\exp(\\mathrm{j}\\,\\theta/2) (\\exp(-\\mathrm{j}\\,\\theta/2) - \\exp(\\mathrm{j}\\,\\theta/2)) | = | -2\\mathrm{j}\\,\\sin(\\theta/2) | = 2|\\sin(\\theta/2)|$。\n将此应用于分子和分母：\n$$\n|S[k]| = |A| \\frac{|\\sin(\\pi(k_0+\\delta-k))|}{|\\sin(\\frac{\\pi}{N}(k_0+\\delta-k))|}\n$$\n鉴于 $k-k_0$ 是整数，令 $m = k-k_0$。则 $\\sin(\\pi(k_0-k+\\delta)) = \\sin(-\\pi m + \\pi\\delta) = \\sin(\\pi\\delta)\\cos(\\pi m) - \\cos(\\pi\\delta)\\sin(\\pi m) = (-1)^{m}\\sin(\\pi\\delta)$。幅值不受符号影响，所以 $|\\sin(\\pi(k_0-k+\\delta))| = |\\sin(\\pi\\delta)|$。\n因此，信号 DFT 的幅值为：\n$$\n|S[k]| = |A| \\frac{|\\sin(\\pi\\delta)|}{|\\sin(\\frac{\\pi}{N}(\\delta-m))|}\n$$\n仅由信号引起的期望周期图样本就是 $S[k]$ 的幅值平方，因为信号是确定性的：\n$$\n\\mathbb{E}\\!\\left[\\,|X[k]|^{2}\\,\\middle|\\,A \\exp(\\mathrm{j}\\,\\omega_{0} n)\\,\\right] = |S[k]|^2 = |A|^2 \\left( \\frac{\\sin(\\pi\\delta)}{\\sin\\left(\\frac{\\pi}{N}(\\delta-m)\\right)} \\right)^2\n$$\n该表达式将频谱泄漏模式描述为 $A$、$N$、$\\delta$ 和谱线偏移 $m = k-k_0$ 的函数。\n\n接下来，我们分析噪声的贡献。噪声的 DFT 是 $W[k] = \\sum_{n=0}^{N-1} w[n] \\exp(-\\mathrm{j}\\,\\frac{2\\pi k n}{N})$。由于 $\\mathbb{E}[w[n]]=0$，因此 $\\mathbb{E}[W[k]]=0$。谱线 $k$ 中噪声贡献的方差为：\n$$\n\\text{Var}(W[k]) = \\mathbb{E}[|W[k]|^2] = \\mathbb{E}\\left[ \\left(\\sum_{n=0}^{N-1} w[n] e^{-\\mathrm{j}\\frac{2\\pi kn}{N}}\\right) \\left(\\sum_{l=0}^{N-1} w^*[l] e^{\\mathrm{j}\\frac{2\\pi kl}{N}}\\right) \\right]\n$$\n$$\n\\text{Var}(W[k]) = \\sum_{n=0}^{N-1}\\sum_{l=0}^{N-1} \\mathbb{E}[w[n]w^*[l]] \\exp\\left(-\\mathrm{j}\\frac{2\\pi k(n-l)}{N}\\right)\n$$\n对于 AWGN，样本是不相关的，所以 $\\mathbb{E}[w[n]w^*[l]] = \\sigma^2 \\delta_{nl}$，其中 $\\delta_{nl}$ 是克罗内克δ函数。\n$$\n\\text{Var}(W[k]) = \\sum_{n=0}^{N-1}\\sum_{l=0}^{N-1} \\sigma^2 \\delta_{nl} \\exp\\left(-\\mathrm{j}\\frac{2\\pi k(n-l)}{N}\\right) = \\sum_{n=0}^{N-1} \\sigma^2 = N\\sigma^2\n$$\n噪声功率在所有 DFT 谱线上是恒定的。\n\n可检测性由单谱线信噪比 (SNR) 建模，其定义为最强 DFT 谱线中的期望信号功率与该谱线中噪声方差的比值。为了找到最强的谱线，我们必须最大化 $|S[k]|^2$，这等价于最小化分母项 $|\\sin(\\frac{\\pi}{N}(\\delta-m))|$。由于 $\\delta \\in (-\\frac{1}{2}, \\frac{1}{2})$，对于整数 $m$，当 $m=0$ 时，$|\\delta-m|$ 的值最小。这对应于谱线 $k=k_0$。因此，最强的谱线是 $k_0$。\n\n最强谱线 $(m=0)$ 中的信号功率为：\n$$\n|S[k_0]|^2 = |A|^2 \\left( \\frac{\\sin(\\pi\\delta)}{\\sin\\left(\\frac{\\pi\\delta}{N}\\right)} \\right)^2\n$$\n分数偏移为 $\\delta$ 时的单谱线 SNR 为：\n$$\n\\text{SNR}(\\delta) = \\frac{|S[k_0]|^2}{\\text{Var}(W[k_0])} = \\frac{|A|^2}{N\\sigma^2} \\left( \\frac{\\sin(\\pi\\delta)}{\\sin\\left(\\frac{\\pi\\delta}{N}\\right)} \\right)^2\n$$\n现在，我们必须求出当正弦波落在谱线上时，即 $\\delta=0$ 时的参考 SNR。在这种情况下，$\\omega_0 = \\frac{2\\pi k_0}{N}$。信号的 DFT 变为 $S[k] = A \\sum_{n=0}^{N-1} \\exp(\\mathrm{j}\\frac{2\\pi(k_0-k)n}{N})$。由于 DFT 基函数的正交性，当 $k=k_0$ 时，此和为 $A N$；否则为 $0$。所有信号功率都集中在谱线 $k_0$ 上。\n信号功率为 $|S[k_0]|^2 = |A|^2 N^2$。噪声功率保持为 $N\\sigma^2$。\n因此，落在谱线上时的 SNR 为：\n$$\n\\text{SNR}(0) = \\frac{|A|^2 N^2}{N\\sigma^2} = \\frac{|A|^2 N}{\\sigma^2}\n$$\n这个结果也可以通过求 $\\text{SNR}(\\delta)$ 在 $\\delta \\to 0$ 时的极限得到，使用小角度近似 $\\sin(x) \\approx x$：\n$$\n\\lim_{\\delta\\to 0} \\left( \\frac{\\sin(\\pi\\delta)}{\\sin\\left(\\frac{\\pi\\delta}{N}\\right)} \\right)^2 = \\lim_{\\delta\\to 0} \\left( \\frac{\\pi\\delta}{\\frac{\\pi\\delta}{N}} \\right)^2 = N^2\n$$\n因此，$\\lim_{\\delta\\to 0} \\text{SNR}(\\delta) = \\frac{|A|^2}{N\\sigma^2} N^2 = \\text{SNR}(0)$。\n\n最后，可检测性损失因子 $L(N, \\delta)$ 是 $\\text{SNR}(\\delta)$ 与 $\\text{SNR}(0)$ 的比值：\n$$\nL(N, \\delta) = \\frac{\\text{SNR}(\\delta)}{\\text{SNR}(0)} = \\frac{\\frac{|A|^2}{N\\sigma^2} \\left( \\frac{\\sin(\\pi\\delta)}{\\sin\\left(\\frac{\\pi\\delta}{N}\\right)} \\right)^2}{\\frac{|A|^2 N}{\\sigma^2}}\n$$\n消去公因式，我们得到最终表达式：\n$$\nL(N,\\delta) = \\frac{1}{N^2} \\left( \\frac{\\sin(\\pi\\delta)}{\\sin\\left(\\frac{\\pi\\delta}{N}\\right)} \\right)^2\n$$\n这就是所需的可检测性损失因子的闭合形式解析表达式。", "answer": "$$\n\\boxed{\n\\frac{1}{N^{2}} \\left( \\frac{\\sin(\\pi\\delta)}{\\sin\\left(\\frac{\\pi\\delta}{N}\\right)} \\right)^{2}\n}\n$$", "id": "2892490"}, {"introduction": "在识别了频谱泄漏和扇形损失这一实际问题之后，下一步自然是寻求解决方法。本练习将指导你设计并推导一个补偿因子，以修正由矩形窗引起的幅度偏差。通过对DFT输出进行插值来估计真实的峰值信息，你将学习到一种提高基于DFT的参数估计精度的实用技术 [@problem_id:2892467]。", "problem": "一个实值的、零均值的、广义平稳序列在一个长度为 $N \\in \\mathbb{N}$ 的有限记录上被观测到，已知该序列包含一个位于加性、谱平坦噪声中的单一确定性窄带谱线。在观测区间 $n = 0, 1, \\dots, N-1$ 内，该谱线分量被建模为 $x[n] = A \\cos\\!\\big(2 \\pi f_{0}\\, n + \\phi\\big)$，其中相位 $\\phi \\in [0, 2\\pi)$ 未知，振幅 $A > 0$ 为常数，而 $f_{0}$ 严格位于两个相邻的离散傅里叶变换 (DFT) 谱线仓频率之间。周期图功率谱密度 (PSD) 估计器是使用矩形数据窗和 $N$ 点 DFT 构成的。就本问题而言，在分析谱线分量的偏差时，忽略噪声的影响。\n\n令 $k_{0} \\in \\{0, 1, \\dots, N-1\\}$ 表示距离 $f_{0}$ 最近的 DFT 谱线仓的索引，并通过 $f_{0} = \\tfrac{k_{0} + \\delta}{N}$（单位为周期/采样点）定义以谱线仓为单位的分数频率偏移 $\\delta \\in \\left(-\\tfrac{1}{2}, \\tfrac{1}{2}\\right]$。将扇形损失因子 $L(\\delta)$ 定义为：在相同的加窗和归一化条件下，当正弦波存在偏移 $\\delta$ 时，谱线仓 $k_{0}$ 处的周期图功率，与当正弦波恰好在谱线仓上（即 $\\delta=0$）时，谱线仓 $k_{0}$ 处的周期图功率之比。\n\n1) 仅从有限长指数和的离散时间傅里叶变换及 DFT 的定义出发，推导在矩形窗情况下 $L(\\delta)$ 作为 $\\delta$ 和 $N$ 的函数的闭式表达式。\n\n2) 对扇形损失的一种实用校正方法是，使用零填充来增加 DFT 的采样密度，然后对最大谱线仓周围的三个相邻 DFT 功率样本进行局部二次（抛物线）插值，以估计分数仓偏移 $\\widehat{\\delta}$。使用任何从第一性原理推导出的、一致的三点二次拟合，给出一个解析乘法校正因子 $C(N, \\widehat{\\delta})$ 的表达式。当将此因子应用于周期图功率峰值时，可以消除矩形窗下由扇形损失引起的偏差。您的表达式必须是关于 $N$ 和 $\\widehat{\\delta}$ 的显式表达式，并且不得依赖于 $A$ 或 $\\phi$。\n\n3) 评估精确的、有限 $N$ 的最坏情况校正因子，其定义为 $C_{N} \\triangleq C\\!\\big(N, \\tfrac{1}{2}\\big)$，对应于偏移量 $\\delta = \\tfrac{1}{2}$。请仅用 $N$ 给出最终答案的单个闭式解析表达式。最终答案中不包含单位。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 信号模型：一个实值的、零均值的、广义平稳序列，观测区间为 $n = 0, 1, \\dots, N-1$。\n- 该序列由一个单一确定性谱线分量 $x[n] = A \\cos(2 \\pi f_{0} n + \\phi)$ 和加性、谱平坦噪声组成。\n- 信号参数：振幅 $A > 0$ 为常数，相位 $\\phi \\in [0, 2\\pi)$ 未知。\n- 在偏差分析中忽略噪声。\n- 频率：$f_{0} = \\frac{k_{0} + \\delta}{N}$ 周期/采样点。\n- 谱线仓索引：$k_{0} \\in \\{0, 1, \\dots, N-1\\}$ 是距离 $f_{0}$ 最近的 DFT 谱线仓的索引。\n- 分数频率偏移：$\\delta \\in \\left(-\\tfrac{1}{2}, \\tfrac{1}{2}\\right]$。\n- PSD 估计器：使用矩形数据窗和 $N$ 点离散傅里叶变换 (DFT) 的周期图。\n- 扇形损失因子：$L(\\delta)$ 是当偏移为 $\\delta$ 时谱线仓 $k_{0}$ 处的周期图功率与偏移为 $\\delta=0$ 时谱线仓 $k_{0}$ 处的功率之比。\n- 偏移估计：对于第 2 部分，通过对峰值周围的三个相邻 DFT 功率样本进行局部二次插值，获得分数仓偏移估计值 $\\widehat{\\delta}$。\n- 校正因子：对于第 2 部分，$C(N, \\widehat{\\delta})$ 是一个应用于周期图功率峰值以消除扇形偏差的乘法因子。\n- 最坏情况因子：对于第 3 部分，$C_{N} \\triangleq C(N, 1/2)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题根植于数字信号处理的基本原理，特别是离散傅里叶变换的分析和基于周期图的谱估计。扇形损失及其校正等概念是标准课题。该模型具有科学有效性。\n- **适定性：** 该问题在数学上是适定的。所有变量都已指定，每个部分的目标都很明确。可以根据所提供的信息推导出唯一的解。\n- **客观性：** 语言技术性强、精确，没有主观或含糊的陈述。\n- **完整性与一致性：** 问题是自洽的。忽略噪声的指令为分析确定性偏差提供了一个明确的简化。$f_0$、$k_0$ 和 $\\delta$ 之间的关系是一致的。不存在矛盾。\n\n**步骤 3：结论与行动**\n问题被判定为有效。将提供完整解答。\n***\n\n该问题要求对周期图估计器的扇形损失进行三部分的推导。我们系统地进行处理。\n\n**1) 扇形损失因子 $L(\\delta)$ 的推导**\n\n信号的谱线分量由 $x[n] = A \\cos(2 \\pi f_{0} n + \\phi)$ 给出。我们通过欧拉公式用复指数表示它：\n$$x[n] = \\frac{A}{2} \\left( e^{j(2 \\pi f_{0} n + \\phi)} + e^{-j(2 \\pi f_{0} n + \\phi)} \\right) = \\frac{A}{2}e^{j\\phi}e^{j2\\pi f_{0} n} + \\frac{A}{2}e^{-j\\phi}e^{-j2\\pi f_{0} n}$$\n$x[n]$ 的 $N$ 点 DFT 定义为 $X[k] = \\sum_{n=0}^{N-1} x[n] e^{-j2\\pi kn/N}$。代入 $x[n]$ 的表达式：\n$$X[k] = \\frac{A}{2}e^{j\\phi} \\sum_{n=0}^{N-1} e^{j2\\pi(f_{0} - k/N)n} + \\frac{A}{2}e^{-j\\phi} \\sum_{n=0}^{N-1} e^{-j2\\pi(f_{0} + k/N)n}$$\n对于窄带信号，其中 $f_{0}$ 为正且不接近 0 或奈奎斯特频率，$X[k]$ 的和中的两项对应于 $k \\approx N f_0$ 和 $k \\approx N(1-f_0)$ 附近的谱峰。我们关心的是最接近 $N f_0$ 的谱线仓 $k_{0}$ 处的 DFT 输出。由于谱泄漏的滚降，第二项（与 $-f_{0}$ 相关）在谱线仓 $k_0$ 处的贡献可以忽略不计。因此，我们可以仅考虑第一项来近似 $X[k_0]$：\n$$X[k_{0}] \\approx \\frac{A}{2}e^{j\\phi} \\sum_{n=0}^{N-1} e^{j2\\pi(f_{0} - k_{0}/N)n}$$\n代入 $f_{0} = (k_{0} + \\delta)/N$：\n$$X[k_{0}] \\approx \\frac{A}{2}e^{j\\phi} \\sum_{n=0}^{N-1} e^{j2\\pi\\left(\\frac{k_{0}+\\delta}{N} - \\frac{k_{0}}{N}\\right)n} = \\frac{A}{2}e^{j\\phi} \\sum_{n=0}^{N-1} \\left(e^{j2\\pi\\delta/N}\\right)^{n}$$\n这是一个公比为 $r = e^{j2\\pi\\delta/N}$ 的有限几何级数。其和为 $\\frac{1-r^N}{1-r}$：\n$$\\sum_{n=0}^{N-1} \\left(e^{j2\\pi\\delta/N}\\right)^{n} = \\frac{1 - e^{j2\\pi\\delta}}{1 - e^{j2\\pi\\delta/N}}$$\n使用恒等式 $\\sin(\\theta) = \\frac{e^{j\\theta} - e^{-j\\theta}}{2j}$，我们可以写出 $1 - e^{j\\alpha} = e^{j\\alpha/2}(e^{-j\\alpha/2} - e^{j\\alpha/2}) = -2j e^{j\\alpha/2} \\sin(\\alpha/2)$。求和变为：\n$$\\frac{-2j e^{j\\pi\\delta} \\sin(\\pi\\delta)}{-2j e^{j\\pi\\delta/N} \\sin(\\pi\\delta/N)} = e^{j\\pi\\delta(1 - 1/N)} \\frac{\\sin(\\pi\\delta)}{\\sin(\\pi\\delta/N)}$$\n谱线仓 $k_{0}$ 处的周期图功率与 $|X[k_{0}]|^2$ 成正比。设比例常数为 $\\beta$。\n$$P_{xx}(k_{0}, \\delta) = \\beta |X[k_{0}]|^2 = \\beta \\left| \\frac{A}{2}e^{j\\phi} e^{j\\pi\\delta(1 - 1/N)} \\frac{\\sin(\\pi\\delta)}{\\sin(\\pi\\delta/N)} \\right|^2 = \\beta \\frac{A^2}{4} \\left( \\frac{\\sin(\\pi\\delta)}{\\sin(\\pi\\delta/N)} \\right)^2$$\n现在，我们求出信号在谱线仓上（即 $\\delta=0$）的情况下的功率。这对应于 $f_{0} = k_{0}/N$。\n$$X[k_{0}] \\approx \\frac{A}{2}e^{j\\phi} \\sum_{n=0}^{N-1} e^{j2\\pi(k_{0}/N - k_{0}/N)n} = \\frac{A}{2}e^{j\\phi} \\sum_{n=0}^{N-1} 1 = \\frac{NA}{2}e^{j\\phi}$$\n对应的功率为：\n$$P_{xx}(k_{0}, 0) = \\beta |X[k_0]|^2 = \\beta \\left| \\frac{NA}{2} \\right|^2 = \\beta \\frac{N^2 A^2}{4}$$\n或者，我们可以取通用表达式在 $\\delta \\to 0$ 时的极限，当 $x$ 很小时使用 $\\sin(x) \\approx x$：\n$$\\lim_{\\delta \\to 0} \\frac{\\sin(\\pi\\delta)}{\\sin(\\pi\\delta/N)} = \\lim_{\\delta \\to 0} \\frac{\\pi\\delta}{\\pi\\delta/N} = N$$\n扇形损失因子 $L(\\delta)$ 是以下比值：\n$$L(\\delta) = \\frac{P_{xx}(k_{0}, \\delta)}{P_{xx}(k_{0}, 0)} = \\frac{\\beta \\frac{A^2}{4} \\left( \\frac{\\sin(\\pi\\delta)}{\\sin(\\pi\\delta/N)} \\right)^2}{\\beta \\frac{N^2 A^2}{4}} = \\frac{1}{N^2} \\left( \\frac{\\sin(\\pi\\delta)}{\\sin(\\pi\\delta/N)} \\right)^2$$\n\n**2) 乘法校正因子 $C(N, \\widehat{\\delta})$**\n\n扇形损失 $L(\\delta)$ 量化了由于分数偏移 $\\delta$ 导致在最近的谱线仓 $k_0$ 处测量功率的降低。该谱线仓处的测量功率为 $P_{meas} = P_{xx}(k_0, \\delta)$。如果信号音恰好在谱线仓上，测得的理想功率是 $P_{true} = P_{xx}(k_0, 0)$。它们之间的关系是 $P_{meas} = L(\\delta) \\cdot P_{true}$。\n\n为了校正这种损失，必须从测量功率中估计真实功率。这需要对损失函数求逆：$P_{true} = P_{meas} / L(\\delta)$。因此，乘法校正因子 $C$ 应为 $C = 1/L(\\delta)$。\n\n在现实中，真实的偏移量 $\\delta$ 是未知的。问题陈述中提到，通过对功率谱峰值附近的点进行二次插值，可以得到一个估计值 $\\widehat{\\delta}$。最合乎逻辑的校正策略是在理论校正公式中使用此估计值 $\\widehat{\\delta}$ 来代替真实的 $\\delta$。这假设估计值 $\\widehat{\\delta}$ 是准确的，并且谱形状的理论模型是正确的。\n\n因此，校正因子 $C(N, \\widehat{\\delta})$ 是扇形损失因子 $L(\\delta)$ 在 $\\delta = \\widehat{\\delta}$ 处取值的倒数：\n$$C(N, \\widehat{\\delta}) = \\frac{1}{L(\\widehat{\\delta})} = \\frac{1}{\\frac{1}{N^2} \\left( \\frac{\\sin(\\pi\\widehat{\\delta})}{\\sin(\\pi\\widehat{\\delta}/N)} \\right)^2} = N^2 \\left( \\frac{\\sin(\\pi\\widehat{\\delta}/N)}{\\sin(\\pi\\widehat{\\delta})} \\right)^2$$\n该表达式仅是 $N$ 和所提供的估计值 $\\widehat{\\delta}$ 的函数，符合要求。\n\n**3) 最坏情况校正因子 $C_{N}$**\n\n对于矩形窗，最坏情况的扇形损失发生在信号频率恰好位于两个 DFT 谱线仓正中间时。给定范围 $\\delta \\in \\left(-\\tfrac{1}{2}, \\tfrac{1}{2}\\right]$，这对应于偏移量的最大幅值 $|\\delta| = 1/2$。我们评估 $\\delta = 1/2$ 时的校正因子。\n最坏情况校正因子 $C_{N}$ 定义为 $C(N, 1/2)$。我们将 $\\widehat{\\delta} = 1/2$ 代入第 2 部分推导出的 $C(N, \\widehat{\\delta})$ 的表达式中：\n$$C_{N} = C(N, 1/2) = N^2 \\left( \\frac{\\sin(\\pi(1/2)/N)}{\\sin(\\pi(1/2))} \\right)^2 = N^2 \\left( \\frac{\\sin(\\pi/(2N))}{\\sin(\\pi/2)} \\right)^2$$\n由于 $\\sin(\\pi/2) = 1$，该表达式简化为：\n$$C_{N} = N^2 \\sin^2\\left(\\frac{\\pi}{2N}\\right)$$\n这就是所求的最坏情况校正因子作为 $N$ 的函数的闭式解析表达式。", "answer": "$$\n\\boxed{\nN^{2} \\sin^{2}\\left(\\frac{\\pi}{2N}\\right)\n}\n$$", "id": "2892467"}]}