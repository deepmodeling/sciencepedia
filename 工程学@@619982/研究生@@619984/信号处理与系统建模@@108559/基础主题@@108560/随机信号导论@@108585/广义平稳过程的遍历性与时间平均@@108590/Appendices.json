{"hands_on_practices": [{"introduction": "理解各态历经性的第一步是量化时间平均的收敛性。本练习将这一抽象概念具体化，要求您为一个离散时间移动平均（MA）过程计算时间平均估计量 $\\overline{x}_N$ 的精确方差。通过从第一性原理出发推导此方差，您将直接观察到过程的自协方差结构如何决定收敛速度，从而巩固您对均值各态历经性条件的理解。[@problem_id:2869728]", "problem": "考虑一个由阶数 $q=3$ 的有限支撑移动平均滤波器作用于一个零均值、独立同分布 (i.i.d.) 新息序列所定义的离散时间过程。具体而言，令 $\\{w[n]\\}$ 为零均值、独立同分布序列，其方差为 $\\sigma_{w}^{2} = 2$，并定义\n$$\nx[n] \\triangleq \\sum_{k=0}^{3} b_{k}\\, w[n-k], \\quad b_{0} = 1,\\; b_{1} = -2,\\; b_{2} = \\tfrac{1}{2},\\; b_{3} = 3.\n$$\n对 $N$ 个样本的时间平均为\n$$\n\\overline{x}_{N} \\triangleq \\frac{1}{N}\\sum_{n=1}^{N} x[n].\n$$\n假设 $N \\geq 4$，以使终端效应不会截断自协方差求和中的非零延迟项。仅从宽平稳 (WSS) 和二阶矩的核心定义出发，计算精确方差 $\\operatorname{Var}(\\overline{x}_{N})$，然后推导其关于 $N$ 的渐近率，并确定 $1/N$ 项中的显式主导常数以及次阶常数。你的推导必须从第一性原理出发：利用期望的线性性质、WSS过程的自协方差定义以及新息的独立性和方差来构建必要的表达式；不要假定任何关于时间平均方差的现成公式。\n\n将最终答案表示为仅含 $N$ 的单个闭式解析表达式。不要对答案进行四舍五入。", "solution": "问题陈述已经过评估，被认为是有效的。这是一个随机过程分析中的适定问题，它基于信号处理的既定原理，没有科学或逻辑上的缺陷。我们现在将从第一性原理出发，进行完整的求解。\n\n目标是计算给定离散时间过程的时间平均的方差 $\\operatorname{Var}(\\overline{x}_{N})$。该过程定义为\n$$\nx[n] = \\sum_{k=0}^{3} b_{k} w[n-k]\n$$\n其中 $\\{w[n]\\}$ 是一个独立同分布 (i.i.d.) 序列，满足 $E[w[n]] = 0$ 和 $E[w[n]^2] = \\sigma_{w}^{2} = 2$。系数为 $b_{0} = 1$，$b_{1} = -2$，$b_{2} = \\tfrac{1}{2}$ 和 $b_{3} = 3$。\n\n首先，我们确定过程 $\\{x[n]\\}$ 是宽平稳 (WSS) 的。我们计算其均值和自协方差。\n该过程的均值为\n$$\nE[x[n]] = E\\left[\\sum_{k=0}^{3} b_{k} w[n-k]\\right] = \\sum_{k=0}^{3} b_{k} E[w[n-k]]\n$$\n由于对所有 $m$ 都有 $E[w[m]] = 0$，因此可得 $E[x[n]] = 0$。均值对所有 $n$ 都是常数。\n\n自协方差函数为 $C_x[m] = E[(x[n] - E[x[n]])(x[n-m] - E[x[n-m]])]$。由于均值为零，自协方差与自相关函数 $R_x[m] = E[x[n]x[n-m]]$ 相同。\n$$\nR_x[m] = E\\left[ \\left(\\sum_{k=0}^{3} b_{k} w[n-k]\\right) \\left(\\sum_{j=0}^{3} b_{j} w[n-m-j]\\right) \\right]\n$$\n根据期望的线性性质，\n$$\nR_x[m] = \\sum_{k=0}^{3} \\sum_{j=0}^{3} b_{k} b_{j} E[w[n-k]w[n-m-j]]\n$$\n序列 $\\{w[n]\\}$ 是零均值的独立同分布序列，因此 $E[w[i]w[l]] = \\sigma_{w}^{2} \\delta[i-l]$，其中 $\\delta[\\cdot]$ 是克罗内克δ函数。于是，\n$$\nE[w[n-k]w[n-m-j]] = \\sigma_{w}^{2} \\delta[(n-k) - (n-m-j)] = \\sigma_{w}^{2} \\delta[m - k + j]\n$$\n仅当 $j = k-m$ 时，该期望非零。将此代入双重求和中，\n$$\nR_x[m] = \\sigma_{w}^{2} \\sum_{k=0}^{3} b_{k} b_{k-m}\n$$\n此表达式仅取决于延迟 $m$，而不取决于 $n$。由于均值是常数且自协方差仅取决于时间延迟，所以过程 $\\{x[n]\\}$ 是 WSS 的。滤波器长度为 $4$ (阶数 $q=3$)，因此自协方差 $R_x[m]$ 仅在 $|m| \\le 3$ 时非零。\n\n现在，我们根据给定的 $\\sigma_{w}^{2} = 2$ 和系数 $b_k$ 计算 $m \\ge 0$ 时 $R_x[m]$ 的具体值。\n当 $m=0$ 时：\n$$\nR_x[0] = \\sigma_{w}^{2} \\sum_{k=0}^{3} b_{k}^{2} = 2 \\left( 1^2 + (-2)^2 + \\left(\\frac{1}{2}\\right)^2 + 3^2 \\right) = 2 \\left( 1 + 4 + \\frac{1}{4} + 9 \\right) = 2 \\left( \\frac{57}{4} \\right) = \\frac{57}{2}\n$$\n当 $m=1$ 时：\n$$\nR_x[1] = \\sigma_{w}^{2} (b_1 b_0 + b_2 b_1 + b_3 b_2) = 2 \\left( (-2)(1) + \\left(\\frac{1}{2}\\right)(-2) + (3)\\left(\\frac{1}{2}\\right) \\right) = 2 \\left( -2 - 1 + \\frac{3}{2} \\right) = 2 \\left( -\\frac{3}{2} \\right) = -3\n$$\n当 $m=2$ 时：\n$$\nR_x[2] = \\sigma_{w}^{2} (b_2 b_0 + b_3 b_1) = 2 \\left( \\left(\\frac{1}{2}\\right)(1) + (3)(-2) \\right) = 2 \\left( \\frac{1}{2} - 6 \\right) = 2 \\left( -\\frac{11}{2} \\right) = -11\n$$\n当 $m=3$ 时：\n$$\nR_x[3] = \\sigma_{w}^{2} (b_3 b_0) = 2 \\left( (3)(1) \\right) = 6\n$$\n对于 $|m|  3$，$R_x[m]=0$。自协方差函数是偶函数，所以 $R_x[-m] = R_x[m]$。\n\n接下来，我们计算时间平均 $\\overline{x}_{N} = \\frac{1}{N}\\sum_{n=1}^{N} x[n]$ 的方差。\n时间平均的均值为 $E[\\overline{x}_{N}] = \\frac{1}{N}\\sum_{n=1}^{N} E[x[n]] = 0$。因此，其方差为\n$$\n\\operatorname{Var}(\\overline{x}_{N}) = E[\\overline{x}_{N}^2] = E\\left[ \\left(\\frac{1}{N}\\sum_{n=1}^{N} x[n]\\right)^2 \\right] = \\frac{1}{N^2} E\\left[ \\left(\\sum_{n=1}^{N} x[n]\\right) \\left(\\sum_{l=1}^{N} x[l]\\right) \\right]\n$$\n$$\n\\operatorname{Var}(\\overline{x}_{N}) = \\frac{1}{N^2} \\sum_{n=1}^{N} \\sum_{l=1}^{N} E[x[n]x[l]] = \\frac{1}{N^2} \\sum_{n=1}^{N} \\sum_{l=1}^{N} R_x[n-l]\n$$\n为了计算该双重求和，令 $m = n-l$。对于一个固定的 $m$，在求和范围 $1 \\le n,l \\le N$ 内满足 $n-l = m$ 的数对 $(n, l)$ 的数量是 $N - |m|$。延迟 $m$ 的范围是从 $-(N-1)$ 到 $N-1$。\n$$\n\\sum_{n=1}^{N} \\sum_{l=1}^{N} R_x[n-l] = \\sum_{m=-(N-1)}^{N-1} (N - |m|) R_x[m]\n$$\n问题指明 $N \\ge 4$，因此 $N-1 \\ge 3$。由于当 $|m|3$ 时 $R_x[m]=0$，该求和简化为\n$$\n\\sum_{m=-3}^{3} (N - |m|) R_x[m]\n$$\n利用偶函数性质 $R_x[-m]=R_x[m]$，我们可以将其写为\n$$\n(N-0)R_x[0] + \\sum_{m=1}^{3} (N-m)R_x[-m] + \\sum_{m=1}^{3} (N-m)R_x[m] = N R_x[0] + 2 \\sum_{m=1}^{3} (N-m)R_x[m]\n$$\n该和变为\n$$\nN R_x[0] + 2(N-1)R_x[1] + 2(N-2)R_x[2] + 2(N-3)R_x[3]\n$$\n将此代回方差的表达式中：\n$$\n\\operatorname{Var}(\\overline{x}_{N}) = \\frac{1}{N^2} \\left[ N R_x[0] + 2(N-1)R_x[1] + 2(N-2)R_x[2] + 2(N-3)R_x[3] \\right]\n$$\n现在，我们代入已计算出的 $R_x[m]$ 的值：\n$$\n\\operatorname{Var}(\\overline{x}_{N}) = \\frac{1}{N^2} \\left[ N \\left(\\frac{57}{2}\\right) + 2(N-1)(-3) + 2(N-2)(-11) + 2(N-3)(6) \\right]\n$$\n展开括号内的各项：\n$$\n\\frac{57}{2}N - 6(N-1) - 22(N-2) + 12(N-3) = \\frac{57}{2}N - 6N + 6 - 22N + 44 + 12N - 36\n$$\n按 $N$ 的幂次合并各项：\n$$\n\\left(\\frac{57}{2} - 6 - 22 + 12\\right)N + (6 + 44 - 36) = \\left(\\frac{57}{2} - 16\\right)N + 14 = \\left(\\frac{57 - 32}{2}\\right)N + 14 = \\frac{25}{2}N + 14\n$$\n因此，精确方差为\n$$\n\\operatorname{Var}(\\overline{x}_{N}) = \\frac{1}{N^2}\\left(\\frac{25}{2}N + 14\\right) = \\frac{25}{2N} + \\frac{14}{N^2}\n$$\n此表达式给出了任意 $N \\ge 4$ 时的精确方差。它也明确地显示了渐近行为。决定收敛速度的主导项是 $\\frac{25}{2N}$。次阶项是 $\\frac{14}{N^2}$。\n\n为了将结果表示为单个闭式表达式，我们将各项通分合并：\n$$\n\\operatorname{Var}(\\overline{x}_{N}) = \\frac{25N}{2N^2} + \\frac{28}{2N^2} = \\frac{25N + 28}{2N^2}\n$$\n这就是时间平均方差的最终解析表达式。", "answer": "$$\n\\boxed{\\frac{25N + 28}{2N^2}}\n$$", "id": "2869728"}, {"introduction": "一个常见的误解是认为所有广义平稳（WSS）过程都是各态历经的。本练习将直接挑战这一观念，通过分析一个带有随机直流分量的过程来阐明，这是非各态历经性的一个经典例子。通过计算时间平均的极限，您会发现它收敛到一个随机变量，而非一个恒定的系综均值，这将为您提供一个关于各态历经性为何及如何失效的关键而具体的洞察。[@problem_id:2869742]", "problem": "考虑以下显式构造。设随机过程 $v[n]$ 是具有随机相位的正弦波的有限线性组合：\n$$\nv[n] \\triangleq 2\\cos\\!\\bigg(\\frac{\\pi}{4} n + \\Theta_1\\bigg) + 3\\cos\\!\\big(\\sqrt{2}\\, n + \\Theta_2\\big) + \\cos\\!\\bigg(\\frac{5\\pi}{7} n + \\Theta_3\\bigg),\n$$\n其中 $\\Theta_1$、$\\Theta_2$ 和 $\\Theta_3$ 是独立同分布的，均在 $[0,2\\pi)$ 上服从均匀分布，且与所有其他随机源无关。定义一个随机变量 $U$，其分布为 $U \\sim \\mathcal{N}(0,\\sigma_U^2)$，对于某个固定的 $\\sigma_U^20$，且 $U$ 独立于 $(\\Theta_1,\\Theta_2,\\Theta_3)$。定义过程\n$$\nx[n] \\triangleq U + v[n], \\quad n \\in \\mathbb{Z}.\n$$\n仅从宽平稳和均值遍历性的定义，以及从第一性原理推导出的三角函数求和的标准性质出发，完成以下任务：\n\n- 根据定义证明 $x[n]$ 是宽平稳的（即其均值为常数，且其自相关函数仅取决于时延）。\n- 计算时间平均的几乎必然极限\n$$\n\\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} x[n].\n$$\n\n你的最终答案必须是关于此极限的、用上述引入的原始随机变量表示的单个闭式解析表达式。无需进行数值四舍五入。最终答案不带任何单位。在任何可能出现的中间步骤中，角度请使用弧度制。", "solution": "首先必须验证问题陈述的科学性和逻辑完整性。\n\n步骤1：提取已知条件。\n- 随机过程 $v[n]$ 定义为 $v[n] \\triangleq 2\\cos(\\frac{\\pi}{4} n + \\Theta_1) + 3\\cos(\\sqrt{2}\\, n + \\Theta_2) + \\cos(\\frac{5\\pi}{7} n + \\Theta_3)$。\n- 随机变量 $\\Theta_1$、$\\Theta_2$、$\\Theta_3$ 是独立同分布的(i.i.d.)，在区间 $[0, 2\\pi)$ 上服从均匀分布。\n- 定义了一个随机变量 $U$，其服从正态分布 $U \\sim \\mathcal{N}(0,\\sigma_U^2)$，对于某个常数 $\\sigma_U^2  0$。\n- 随机变量 $U$ 独立于随机向量 $(\\Theta_1, \\Theta_2, \\Theta_3)$。\n- 随机过程 $x[n]$ 定义为 $x[n] \\triangleq U + v[n]$，对所有整数 $n \\in \\mathbb{Z}$。\n- 任务有两部分：首先，根据形式化定义证明 $x[n]$ 是宽平稳的(WSS)；其次，计算时间平均的几乎必然极限 $\\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} x[n]$。\n- 解答必须从第一性原理推导得出。\n\n步骤2：使用提取的已知条件进行验证。\n- 该问题具有科学依据。它提出了一个随机过程的标准构造，并要求分析其基本性质，即宽平稳性和遍历性，这些都是信号处理和概率论中的核心概念。\n- 该问题是适定的。过程和随机变量的定义是明确且自洽的。所提出的问题基于已建立的数学理论，有唯一的、可推导的答案。\n- 该问题是客观的，并使用了精确的数学语言。没有主观或模糊的陈述。\n- 该问题是完整的。提供了有关随机变量分布和独立性的所有必要信息。没有缺失任何基本数据。\n- 该问题并非无足轻重。它要求仔细应用定义，并理解随机直流偏移如何影响遍历性，以及相对于 $\\pi$ 的有理和无理频率正弦波的时间平均性质。\n\n步骤3：结论与行动。\n问题有效。将构建一个严谨的解答。\n\n一个离散时间随机过程 $x[n]$ 被定义为宽平稳(WSS)，如果它满足两个条件：\n1.  均值函数 $m_x[n] = E[x[n]]$ 是一个与时间指数 $n$ 无关的常数。\n2.  自相关函数 $R_{xx}[n_1, n_2] = E[x[n_1]x[n_2]]$ 仅取决于时延 $\\tau = n_1 - n_2$。\n\n我们现在将为过程 $x[n] = U + v[n]$ 验证这两个条件。\n\n首先，我们计算均值函数 $m_x[n]$。根据期望算子的线性性质：\n$$\nm_x[n] = E[x[n]] = E[U + v[n]] = E[U] + E[v[n]].\n$$\n已知随机变量 $U$ 服从正态分布 $\\mathcal{N}(0, \\sigma_U^2)$，所以其期望为 $E[U] = 0$。\n接下来，我们计算 $v[n]$ 的期望：\n$$\nE[v[n]] = E\\bigg[2\\cos\\bigg(\\frac{\\pi}{4} n + \\Theta_1\\bigg) + 3\\cos\\big(\\sqrt{2}\\, n + \\Theta_2\\big) + \\cos\\bigg(\\frac{5\\pi}{7} n + \\Theta_3\\bigg)\\bigg].\n$$\n再次利用期望的线性性质：\n$$\nE[v[n]] = 2E\\bigg[\\cos\\bigg(\\frac{\\pi}{4} n + \\Theta_1\\bigg)\\bigg] + 3E\\bigg[\\cos\\big(\\sqrt{2}\\, n + \\Theta_2\\big)\\bigg] + E\\bigg[\\cos\\bigg(\\frac{5\\pi}{7} n + \\Theta_3\\bigg)\\bigg].\n$$\n每一项都涉及一个带有随机相位 $\\Theta_i \\sim U[0, 2\\pi)$ 的余弦的期望。对于一个具有频率 $\\omega$ 和相位 $\\Theta \\sim U[0, 2\\pi)$ 的一般项，其期望根据定义计算如下：\n$$\nE[\\cos(\\omega n + \\Theta)] = \\int_{0}^{2\\pi} \\cos(\\omega n + \\theta) \\frac{1}{2\\pi} d\\theta = \\frac{1}{2\\pi} \\bigg[\\sin(\\omega n + \\theta)\\bigg]_{\\theta=0}^{\\theta=2\\pi}.\n$$\n$$\n= \\frac{1}{2\\pi} \\big(\\sin(\\omega n + 2\\pi) - \\sin(\\omega n)\\big) = \\frac{1}{2\\pi} \\big(\\sin(\\omega n) - \\sin(\\omega n)\\big) = 0.\n$$\n由于对于任何 $\\omega$ 和 $n$ 这个结果都为 $0$，因此 $E[v[n]]$ 表达式中的三项均为零。于是，对于所有 $n \\in \\mathbb{Z}$，有 $E[v[n]] = 0$。\n结合这些结果，$x[n]$ 的均值为：\n$$\nm_x[n] = E[U] + E[v[n]] = 0 + 0 = 0.\n$$\n均值为常数 $0$，因此满足宽平稳的第一个条件。\n\n其次，我们计算自相关函数 $R_{xx}[n_1, n_2]$。\n$$\nR_{xx}[n_1, n_2] = E[x[n_1]x[n_2]] = E\\big[(U + v[n_1])(U + v[n_2])\\big].\n$$\n展开乘积：\n$$\nR_{xx}[n_1, n_2] = E[U^2 + U v[n_2] + v[n_1] U + v[n_1]v[n_2]].\n$$\n根据期望的线性性质：\n$$\nR_{xx}[n_1, n_2] = E[U^2] + E[U v[n_2]] + E[v[n_1]U] + E[v[n_1]v[n_2]].\n$$\n随机变量 $U$ 独立于 $(\\Theta_1, \\Theta_2, \\Theta_3)$，因此也独立于 $v[n_1]$ 和 $v[n_2]$。所以，它们乘积的期望可以分离：\n$E[U v[n_2]] = E[U]E[v[n_2]] = 0 \\cdot 0 = 0$。\n$E[v[n_1]U] = E[v[n_1]]E[U] = 0 \\cdot 0 = 0$。\n项 $E[U^2]$ 是 $U$ 的二阶矩。因为 $U \\sim \\mathcal{N}(0, \\sigma_U^2)$，其方差为 $\\text{Var}(U) = E[U^2] - (E[U])^2$。因此，$E[U^2] = \\text{Var}(U) + (E[U])^2 = \\sigma_U^2 + 0^2 = \\sigma_U^2$。\n自相关函数简化为：\n$$\nR_{xx}[n_1, n_2] = \\sigma_U^2 + E[v[n_1]v[n_2]].\n$$\n我们现在计算 $v[n]$ 的自相关函数，记为 $R_{vv}[n_1, n_2]$。令 $v_k[n] = A_k \\cos(\\omega_k n + \\Theta_k)$，对于 $k \\in \\{1, 2, 3\\}$，其中 $(A_1, \\omega_1) = (2, \\frac{\\pi}{4})$，$(A_2, \\omega_2) = (3, \\sqrt{2})$，以及 $(A_3, \\omega_3) = (1, \\frac{5\\pi}{7})$。\n$$\nR_{vv}[n_1, n_2] = E\\bigg[\\bigg(\\sum_{k=1}^3 v_k[n_1]\\bigg)\\bigg(\\sum_{j=1}^3 v_j[n_2]\\bigg)\\bigg] = \\sum_{k=1}^3 \\sum_{j=1}^3 E[v_k[n_1]v_j[n_2]].\n$$\n对于不同的 $k$，随机相位 $\\Theta_k$ 是独立的。对于任何 $k \\neq j$ 的交叉项：\n$$\nE[v_k[n_1]v_j[n_2]] = E[A_k \\cos(\\omega_k n_1 + \\Theta_k) A_j \\cos(\\omega_j n_2 + \\Theta_j)].\n$$\n由于 $\\Theta_k$ 和 $\\Theta_j$ 的独立性：\n$$\nE[v_k[n_1]v_j[n_2]] = A_k A_j E[\\cos(\\omega_k n_1 + \\Theta_k)] E[\\cos(\\omega_j n_2 + \\Theta_j)] = A_k A_j \\cdot 0 \\cdot 0 = 0.\n$$\n因此，只有 $k=j$ 的项不为零：\n$$\nR_{vv}[n_1, n_2] = \\sum_{k=1}^3 E[v_k[n_1]v_k[n_2]] = \\sum_{k=1}^3 E[A_k^2 \\cos(\\omega_k n_1 + \\Theta_k) \\cos(\\omega_k n_2 + \\Theta_k)].\n$$\n我们使用三角恒等式 $\\cos(A)\\cos(B) = \\frac{1}{2}(\\cos(A-B) + \\cos(A+B))$。\n$$\nE[A_k^2 \\cos(\\omega_k n_1 + \\Theta_k) \\cos(\\omega_k n_2 + \\Theta_k)] = \\frac{A_k^2}{2} E[\\cos(\\omega_k(n_1 - n_2)) + \\cos(\\omega_k(n_1+n_2) + 2\\Theta_k)].\n$$\n项 $\\cos(\\omega_k(n_1 - n_2))$ 是确定性的，所以其期望就是其本身。第二项的期望是：\n$$\nE[\\cos(\\omega_k(n_1+n_2) + 2\\Theta_k)] = \\int_0^{2\\pi} \\cos(\\omega_k(n_1+n_2) + 2\\theta) \\frac{1}{2\\pi} d\\theta.\n$$\n该积分计算结果为 $0$，因为它是一个正弦函数在其自变量相位分量 ($2\\theta$ 范围是 $[0, 4\\pi)$) 的两个完整周期上的积分。严格地，$\\frac{1}{2\\pi}[\\frac{1}{2}\\sin(\\omega_k(n_1+n_2) + 2\\theta)]_0^{2\\pi} = 0$。\n因此，对于每个 $k$：\n$$\nE[v_k[n_1]v_k[n_2]] = \\frac{A_k^2}{2} \\cos(\\omega_k(n_1 - n_2)).\n$$\n这只取决于时延 $\\tau = n_1 - n_2$。对 $k$ 求和：\n$$\nR_{vv}[n_1, n_2] = \\frac{2^2}{2}\\cos\\bigg(\\frac{\\pi}{4}(n_1-n_2)\\bigg) + \\frac{3^2}{2}\\cos\\big(\\sqrt{2}(n_1-n_2)\\big) + \\frac{1^2}{2}\\cos\\bigg(\\frac{5\\pi}{7}(n_1-n_2)\\bigg).\n$$\n令 $\\tau=n_1-n_2$。那么 $R_{vv}(\\tau) = 2\\cos(\\frac{\\pi}{4}\\tau) + \\frac{9}{2}\\cos(\\sqrt{2}\\tau) + \\frac{1}{2}\\cos(\\frac{5\\pi}{7}\\tau)$。\n最后，$x[n]$ 的完整自相关函数是：\n$$\nR_{xx}[n_1, n_2] = \\sigma_U^2 + 2\\cos\\bigg(\\frac{\\pi}{4}(n_1-n_2)\\bigg) + \\frac{9}{2}\\cos\\big(\\sqrt{2}(n_1-n_2)\\big) + \\frac{1}{2}\\cos\\bigg(\\frac{5\\pi}{7}(n_1-n_2)\\bigg).\n$$\n该函数仅取决于时延 $\\tau = n_1 - n_2$。由于两个条件都已满足，过程 $x[n]$ 是宽平稳的。\n\n现在，我们进行问题的第二部分：计算 $x[n]$ 的时间平均的几乎必然极限。\n$$\n\\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} x[n] = \\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} (U + v[n]).\n$$\n根据求和与极限的线性性质：\n$$\n= \\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} U + \\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} v[n].\n$$\n对于第一项，$U$ 是一个不依赖于时间指数 $n$ 的随机变量。对于该过程的任何特定实现，$U$ 是一个常数。\n$$\n\\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} U = \\lim_{N \\to \\infty} \\frac{N \\cdot U}{N} = \\lim_{N \\to \\infty} U = U.\n$$\n对于第二项，我们通过分析 $v[n]$ 的每个正弦分量来分析其时间平均。我们需要计算一个一般正弦波 $\\cos(\\omega n + \\Theta)$ 的时间平均。这可以从复指数 $e^{j\\omega_0 n}$ 的时间平均推导出来：\n$$\n\\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} e^{j\\omega_0 n}.\n$$\n如果 $\\omega_0 = 2\\pi k$ (对于某个整数 $k$)，那么 $e^{j\\omega_0 n} = e^{j2\\pi k n} = (e^{j2\\pi k})^n = 1^n=1$。和为 $N$，平均值的极限为 $1$。\n如果对于任何整数 $k$，$\\omega_0 \\neq 2\\pi k$，则该和是一个有限几何级数：\n$$\n\\sum_{n=0}^{N-1} (e^{j\\omega_0})^n = \\frac{1 - (e^{j\\omega_0})^N}{1 - e^{j\\omega_0}}.\n$$\n分子的模是有界的：$|1 - e^{j\\omega_0 N}| \\leq |1| + |e^{j\\omega_0 N}| = 1+1=2$。分母 $1 - e^{j\\omega_0}$ 是一个非零常数。因此，该和的模是有界的。时间平均是这个有界量除以 $N$，当 $N \\to \\infty$ 时，它收敛到 $0$。\n总而言之，$\\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} e^{j\\omega_0 n} = \\delta(\\omega_0 \\text{ mod } 2\\pi)$，其中当参数为 $0$ 时 $\\delta$ 为 $1$，否则为 $0$。\n\n$\\cos(\\omega n + \\Theta)$ 的时间平均是：\n$$\n\\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} \\cos(\\omega n + \\Theta) = \\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} \\frac{e^{j(\\omega n + \\Theta)} + e^{-j(\\omega n + \\Theta)}}{2}\n$$\n$$\n= \\frac{e^{j\\Theta}}{2} \\bigg(\\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} e^{j\\omega n}\\bigg) + \\frac{e^{-j\\Theta}}{2} \\bigg(\\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} e^{-j\\omega n}\\bigg).\n$$\n这个极限仅当 $\\omega = 2\\pi k$ 或 $-\\omega = 2\\pi k$（对于某个整数 $k$）时才非零。换句话说，$\\omega$ 必须是 $2\\pi$ 的整数倍。\n我们来检查 $v[n]$ 中的频率：\n1.  $\\omega_1 = \\frac{\\pi}{4}$。这不是 $2\\pi$ 的整数倍。因此，$2\\cos(\\frac{\\pi}{4} n + \\Theta_1)$ 的时间平均为 $0$。\n2.  $\\omega_2 = \\sqrt{2}$。由于 $\\sqrt{2}$ 是无理数，$\\sqrt{2}/(2\\pi)$ 也是无理数，所以 $\\sqrt{2}$ 不可能是 $2\\pi$ 的整数倍。因此，$3\\cos(\\sqrt{2} n + \\Theta_2)$ 的时间平均为 $0$。\n3.  $\\omega_3 = \\frac{5\\pi}{7}$。这不是 $2\\pi$ 的整数倍。因此，$\\cos(\\frac{5\\pi}{7} n + \\Theta_3)$ 的时间平均为 $0$。\n\n由于 $v[n]$ 的每个正弦分量的时间平均都为 $0$，所以它们之和的时间平均也为 $0$：\n$$\n\\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} v[n] = 0.\n$$\n结合 $x[n]$ 两部分的结果：\n$$\n\\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} x[n] = U + 0 = U.\n$$\n时间平均的几乎必然极限是随机变量 $U$。这意味着过程 $x[n]$ 在均值上不是遍历的，因为其时间平均收敛到一个随机变量 $U$，而这个随机变量几乎必然不等于常数集总均值 $m_x=0$。", "answer": "$$\n\\boxed{U}\n$$", "id": "2869742"}, {"introduction": "均值各态历经性的失效在频域中有一个独特而重要的标志。本练习旨在将您在时域的理解与谱分析联系起来，通过探究一个功率谱密度（PSD）在 $\\omega = 0$ 处包含狄拉克 $\\delta$ 函数的过程。您将首先在时域中构建这样一个过程，然后证明该谱特征如何导致时间平均的方差极限不为零，从而揭示维纳-辛钦定理中的一个基本关系。[@problem_id:2869754]", "problem": "考虑一个实值的、零均值的宽平稳 (WSS) 过程，其功率谱密度 (PSD) 由下式给出：\n$$\nS_{x}(\\omega)=2\\pi\\sigma_{0}^{2}\\,\\delta(\\omega)+S_{c}(\\omega),\n$$\n其中 $S_{c}(\\omega)$ 是一个在 $\\mathbb{R}$ 上可积的偶、非负函数，在 $\\omega=0$ 处连续，并且满足 $\\int_{-\\infty}^{\\infty} S_{c}(\\omega)\\,d\\omega\\infty$。\n\n1. 根据 Wiener–Khinchin 定理的意义，在时域中显式地构造一个零均值 WSS 过程 $x(t)$，其 PSD 为 $S_{x}(\\omega)$。您的构造必须从第一性原理出发，通过组合具有明确定义的自相关函数和 PSD 的基本构建模块来完成。\n\n2. 对于时间平均\n$$\n\\overline{x}_{T}=\\frac{1}{T}\\int_{0}^{T} x(t)\\,dt,\n$$\n仅使用关联线性时不变滤波、自相关函数和功率谱密度的基础结果，计算当 $T\\to\\infty$ 时 $\\mathrm{var}(\\overline{x}_{T})$ 的非零极限。请以 $\\sigma_{0}^{2}$ 的单个闭式解析表达式给出您的最终答案。不需要数值近似。请以不带单位的形式表达您的最终答案。", "solution": "对问题陈述进行严格验证。\n\n**步骤 1：提取已知条件**\n- 过程 $x(t)$ 是一个实值的、零均值的宽平稳 (WSS) 随机过程。\n- 功率谱密度 (PSD) 为 $S_{x}(\\omega)=2\\pi\\sigma_{0}^{2}\\,\\delta(\\omega)+S_{c}(\\omega)$。\n- $S_{c}(\\omega)$ 是一个偶、非负函数。\n- $S_{c}(\\omega)$ 在 $\\mathbb{R}$ 上可积。\n- $S_{c}(\\omega)$ 在 $\\omega=0$ 处连续。\n- $\\int_{-\\infty}^{\\infty} S_{c}(\\omega)\\,d\\omega\\infty$。\n- 时间平均定义为 $\\overline{x}_{T}=\\frac{1}{T}\\int_{0}^{T} x(t)\\,dt$。\n- 目标是计算极限 $\\lim_{T\\to\\infty} \\mathrm{var}(\\overline{x}_{T})$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在随机过程的数学框架内是良定的。所提供的 PSD 由原点的狄拉克 δ 函数和连续分量组成，是对于一个非均值遍历的 WSS 过程的标准模型。赋予 $S_c(\\omega)$ 的性质与它作为一个有效的 PSD 分量是一致的。该过程被规定为零均值，$E[x(t)]=0$。这个要求似乎与 PSD 中在 $\\omega=0$ 处存在 δ 函数相矛盾，后者对应于时间平均的非零均方值。然而，可以构造一个过程 $x(t) = A + c(t)$，其中 $A$ 是一个随机变量，满足 $E[A]=0$ 和 $E[A^2]=\\sigma_0^2$，$c(t)$ 是一个零均值的 WSS 过程。这样的过程 $x(t)$ 确实是零均值的，$E[x(t)]=E[A]+E[c(t)]=0$，并且其自相关函数和 PSD 与给定的形式相匹配。因此，没有内部矛盾。该问题在科学上是合理的、客观的、完整的和适定的。\n\n**步骤 3：结论与行动**\n该问题被认为是**有效的**。将制定一个完整的解决方案。\n\n### 第 1 部分：过程的构造\n一个具有指定 PSD 的过程 $x(t)$ 可以构造为两个独立的、实值的、零均值的 WSS 过程之和。令 $x(t) = A(t) + c(t)$，其中：\n1.  $A(t)$ 是一个过程，其 PSD 为 $S_A(\\omega) = 2\\pi\\sigma_{0}^{2}\\delta(\\omega)$。\n2.  $c(t)$ 是一个过程，其 PSD 为 $S_c(\\omega)$。\n\n让我们来构造这些基本模块。\n对于过程 $c(t)$，其 PSD $S_c(\\omega)$ 被给定为偶、非负且可积。根据关于自相关函数特征的 Wiener 定理，这样的函数对于零均值 WSS 过程 $c(t)$ 是一个有效的 PSD。$S_c(\\omega)$ 在 $\\omega=0$ 处连续的性质至关重要，这一点稍后会说明。\n\n对于过程 $A(t)$，其自相关函数 $R_A(\\tau)$ 是其 PSD 的傅里叶逆变换：\n$$R_A(\\tau) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} S_A(\\omega)e^{i\\omega\\tau}d\\omega = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} 2\\pi\\sigma_{0}^{2}\\delta(\\omega)e^{i\\omega\\tau}d\\omega = \\sigma_{0}^{2}$$\n这意味着对于所有的 $t$ 和 $\\tau$，$R_A(\\tau) = E[A(t+\\tau)A(t)] = \\sigma_{0}^{2}$。这是一个随机常数过程的特征，即 $A(t) = A$，其中 $A$ 是一个随机变量。那么自相关函数为 $E[A^2] = \\sigma_{0}^{2}$。为满足 $x(t)$ 的零均值条件，我们必须有 $E[x(t)]=0$。如果我们假设 $A$ 和 $c(t)$ 是独立的，那么 $E[x(t)] = E[A + c(t)] = E[A] + E[c(t)]$。由于 $c(t)$ 对应于频谱中在原点没有 δ 函数的连续部分，我们可以定义它为零均值，$E[c(t)]=0$。这就迫使 $E[A]=0$。\n因此，第一个分量是一个随机变量 $A$，其均值为 $E[A]=0$，方差为 $\\mathrm{var}(A) = E[A^2] - (E[A])^2 = \\sigma_0^2 - 0 = \\sigma_0^2$。\n\n因此，$x(t)$ 的显式构造为：\n$$x(t) = A + c(t)$$\n其中 $A$ 是一个随机变量，与过程 $c(t)$ 独立，满足 $E[A]=0$ 和 $E[A^2]=\\sigma_0^2$，$c(t)$ 是一个 PSD 为 $S_c(\\omega)$ 的零均值 WSS 过程。\n\n让我们验证这个构造是否能得到 $x(t)$ 的指定性质：\n- **均值**：$E[x(t)] = E[A+c(t)] = E[A] + E[c(t)] = 0 + 0 = 0$。\n- **自相关**：由于 $A$ 和 $c(t)$ 是独立的且均为零均值：\n$$R_x(\\tau) = E[x(t+\\tau)x(t)] = E[(A+c(t+\\tau))(A+c(t))]$$\n$$R_x(\\tau) = E[A^2] + E[A]E[c(t)] + E[A]E[c(t+\\tau)] + E[c(t+\\tau)c(t)]$$\n$$R_x(\\tau) = \\sigma_0^2 + 0 + 0 + R_c(\\tau) = \\sigma_0^2 + R_c(\\tau)$$\n该过程是 WSS。\n- **PSD**：PSD 是自相关函数的傅里叶变换：\n$$S_x(\\omega) = \\mathcal{F}\\{R_x(\\tau)\\} = \\mathcal{F}\\{\\sigma_0^2\\} + \\mathcal{F}\\{R_c(\\tau)\\} = 2\\pi\\sigma_0^2\\delta(\\omega) + S_c(\\omega)$$\n构造得到验证。\n\n### 第 2 部分：方差极限的计算\n过程 $x(t)$ 的时间平均由 $\\overline{x}_{T}=\\frac{1}{T}\\int_{0}^{T} x(t)\\,dt$ 给出。\n使用 $x(t)$ 的构造形式：\n$$\\overline{x}_{T} = \\frac{1}{T}\\int_{0}^{T} (A + c(t))\\,dt = \\frac{1}{T}\\int_{0}^{T} A\\,dt + \\frac{1}{T}\\int_{0}^{T} c(t)\\,dt = A + \\overline{c}_{T}$$\n其中 $\\overline{c}_{T}$ 是过程 $c(t)$ 的时间平均。\n\n$\\overline{x}_T$ 的方差是 $\\mathrm{var}(\\overline{x}_{T}) = E[\\overline{x}_{T}^2] - (E[\\overline{x}_{T}])^2$。\n首先，我们计算 $\\overline{x}_{T}$ 的均值：\n$$E[\\overline{x}_{T}] = E[A + \\overline{c}_{T}] = E[A] + E[\\overline{c}_{T}]$$\n我们知道 $E[A]=0$。对于 $\\overline{c}_T$：\n$$E[\\overline{c}_{T}] = E\\left[\\frac{1}{T}\\int_{0}^{T} c(t)\\,dt\\right] = \\frac{1}{T}\\int_{0}^{T} E[c(t)]\\,dt = \\frac{1}{T}\\int_{0}^{T} 0\\,dt = 0$$\n因此，$E[\\overline{x}_{T}]=0$，方差为 $\\mathrm{var}(\\overline{x}_{T}) = E[\\overline{x}_{T}^2]$。\n$$E[\\overline{x}_{T}^2] = E[(A+\\overline{c}_{T})^2] = E[A^2 + 2A\\overline{c}_{T} + \\overline{c}_{T}^2] = E[A^2] + 2E[A\\overline{c}_{T}] + E[\\overline{c}_{T}^2]$$\n我们有 $E[A^2] = \\sigma_0^2$。\n交叉项为：\n$$E[A\\overline{c}_{T}] = E\\left[A \\cdot \\frac{1}{T}\\int_{0}^{T} c(t)\\,dt\\right] = \\frac{1}{T}\\int_{0}^{T} E[A c(t)]\\,dt$$\n由于 $A$ 和 $c(t)$ 是独立的且均为零均值，所以 $E[A c(t)] = E[A]E[c(t)] = 0 \\cdot 0 = 0$。因此，$E[A\\overline{c}_{T}]=0$。\n最后一项是 $E[\\overline{c}_{T}^2] = \\mathrm{var}(\\overline{c}_{T})$，因为 $E[\\overline{c}_{T}]=0$。\n将所有部分组合在一起：\n$$\\mathrm{var}(\\overline{x}_{T}) = \\sigma_0^2 + \\mathrm{var}(\\overline{c}_{T})$$\n现在，我们必须计算当 $T\\to\\infty$ 时的极限：\n$$\\lim_{T\\to\\infty} \\mathrm{var}(\\overline{x}_{T}) = \\sigma_0^2 + \\lim_{T\\to\\infty} \\mathrm{var}(\\overline{c}_{T})$$\n项 $\\lim_{T\\to\\infty} \\mathrm{var}(\\overline{c}_{T})$ 表示过程 $c(t)$ 是均值遍历的条件。一个零均值 WSS 过程是均值遍历的，当且仅当其时间平均的方差极限为零。其充分必要条件是其 PSD 在 $\\omega=0$ 处没有狄拉克 δ 分量。\n\n时间平均 $\\overline{c}_{T}$ 的方差可以用 PSD $S_c(\\omega)$ 表示为：\n$$\\mathrm{var}(\\overline{c}_T) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} S_c(\\omega) \\left| H_T(\\omega) \\right|^2 d\\omega$$\n其中 $H_T(\\omega)$ 是脉冲响应 $h_T(t)$ 的傅里叶变换，当 $t \\in [0, T]$ 时 $h_T(t) = \\frac{1}{T}$，否则为 0。\n$$H_T(\\omega) = \\int_0^T \\frac{1}{T} e^{-i\\omega t} dt = \\frac{1-e^{-i\\omega T}}{i\\omega T}$$\n其幅度的平方是：\n$$\\left| H_T(\\omega) \\right|^2 = \\frac{|1 - \\cos(\\omega T) + i\\sin(\\omega T)|^2}{(\\omega T)^2} = \\frac{(1-\\cos(\\omega T))^2 + \\sin^2(\\omega T)}{(\\omega T)^2} = \\frac{2(1-\\cos(\\omega T))}{(\\omega T)^2} = \\frac{4\\sin^2(\\omega T/2)}{(\\omega T)^2} = \\left(\\frac{\\sin(\\omega T/2)}{\\omega T/2}\\right)^2$$\n所以，\n$$\\mathrm{var}(\\overline{c}_T) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} S_c(\\omega) \\left(\\frac{\\sin(\\omega T/2)}{\\omega T/2}\\right)^2 d\\omega$$\n为了评估 $T \\to \\infty$ 时的极限，我们认识到函数 $\\frac{T}{2\\pi}\\left(\\frac{\\sin(\\omega T/2)}{\\omega T/2}\\right)^2$ 是 Fejér 核，它构成了狄拉克 δ 函数 $\\delta(\\omega)$ 的一个近似。\n$$\\lim_{T\\to\\infty} \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} S_c(\\omega) \\left(\\frac{\\sin(\\omega T/2)}{\\omega T/2}\\right)^2 d\\omega = \\lim_{T\\to\\infty} \\frac{1}{T} \\int_{-\\infty}^{\\infty} S_c(\\omega) \\frac{T}{2\\pi}\\left(\\frac{\\sin(\\omega T/2)}{\\omega T/2}\\right)^2 d\\omega$$\n由于根据假设 $S_c(\\omega)$ 在 $\\omega=0$ 处是连续的，该积分收敛到 $S_c(0)$。\n$$\\lim_{T\\to\\infty} \\mathrm{var}(\\overline{c}_T) = \\lim_{T\\to\\infty} \\frac{1}{T} \\cdot S_c(0) = 0$$\n这正式证明了过程 $c(t)$ 是均值遍历的。\n\n将此结果代回到 $\\overline{x}_T$ 方差极限的表达式中：\n$$\\lim_{T\\to\\infty} \\mathrm{var}(\\overline{x}_{T}) = \\sigma_0^2 + 0 = \\sigma_0^2$$\n时间平均方差的非零部分完全归因于随机直流分量，该分量由 PSD 中的 δ 函数表示。", "answer": "$$\\boxed{\\sigma_{0}^{2}}$$", "id": "2869754"}]}