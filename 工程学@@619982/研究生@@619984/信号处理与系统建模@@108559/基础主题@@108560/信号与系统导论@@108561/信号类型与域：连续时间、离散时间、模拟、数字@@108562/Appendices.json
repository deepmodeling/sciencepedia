{"hands_on_practices": [{"introduction": "当我们通过采样将连续时间信号转换为离散时间序列时，一个基本问题是信号的能量和功率等核心特性如何转换。本练习将引导你运用帕塞瓦尔定理，从第一性原理出发，推导出在理想采样条件下这两种域之间精确的数学关系。完成这个推导将加深你对连续时间傅里叶变换($\\text{CTFT}$)和离散时间傅里叶变换($\\text{DTFT}$)之间内在联系的理解[@problem_id:2904635]。", "problem": "考虑一个实值连续时间信号 $x_{\\mathrm{c}}(t)$，它属于希尔伯特空间 $L^{2}(\\mathbb{R})$，并且是带限的，其带宽为 $|\\omega| \\leq \\omega_{\\mathrm{B}}$，即其连续时间傅里叶变换 (CTFT) $X_{\\mathrm{c}}(\\omega)$ 在 $|\\omega| > \\omega_{\\mathrm{B}}$ 时为零。设该信号以采样周期 $T_{\\mathrm{s}} > 0$ 进行均匀采样，得到离散时间序列 $x[n] = x_{\\mathrm{c}}(n T_{\\mathrm{s}})$，并假设满足奈奎斯特条件 $\\omega_{\\mathrm{s}} = \\frac{2\\pi}{T_{\\mathrm{s}}} > 2 \\,\\omega_{\\mathrm{B}}$，从而理想采样是无混叠的。用 $X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\Omega})$ 表示 $x[n]$ 的离散时间傅里叶变换 (DTFT)。\n\n$x_{\\mathrm{c}}(t)$ 的连续时间能量定义为 $E_{\\mathrm{c}} = \\int_{-\\infty}^{\\infty} |x_{\\mathrm{c}}(t)|^{2}\\,\\mathrm{d}t$，而 $x[n]$ 的离散时间 $\\ell^{2}$-能量为 $E_{\\mathrm{d}} = \\sum_{n=-\\infty}^{\\infty} |x[n]|^{2}$。一个（不一定平方可积的）信号 $x_{\\mathrm{c}}(t)$ 的连续时间时间平均功率为 $P_{\\mathrm{c}} = \\lim_{T \\to \\infty} \\frac{1}{2T} \\int_{-T}^{T} |x_{\\mathrm{c}}(t)|^{2}\\,\\mathrm{d}t$（当此极限存在时），而 $x[n]$ 的离散时间样本平均功率为 $P_{\\mathrm{d}} = \\lim_{N \\to \\infty} \\frac{1}{2N+1} \\sum_{n=-N}^{N} |x[n]|^{2}$（当此极限存在时）。\n\n仅从连续时间傅里叶变换和离散时间傅里叶变换的标准定义、理想采样模型（时域上乘以冲激串）以及各域中的帕塞瓦尔关系出发，推导在无混叠采样条件下，连续时间的能量和功率概念如何转换为离散时间的形式。特别地，证明存在仅依赖于 $T_{\\mathrm{s}}$ 的正常数比例常数 $c_{E}(T_{\\mathrm{s}})$ 和 $c_{P}(T_{\\mathrm{s}})$，使得对于所有带限的 $x_{\\mathrm{c}} \\in L^{2}(\\mathbb{R})$，有\n$\\int_{-\\infty}^{\\infty} |x_{\\mathrm{c}}(t)|^{2}\\,\\mathrm{d}t = c_{E}(T_{\\mathrm{s}}) \\sum_{n=-\\infty}^{\\infty} |x[n]|^{2}$，\n并且对于任何经过无混叠采样的带限广义时间平均功率信号 $x_{\\mathrm{c}}(t)$，有\n$\\lim_{T \\to \\infty} \\frac{1}{2T} \\int_{-T}^{T} |x_{\\mathrm{c}}(t)|^{2}\\,\\mathrm{d}t = c_{P}(T_{\\mathrm{s}}) \\lim_{N \\to \\infty} \\frac{1}{2N+1} \\sum_{n=-N}^{N} |x[n]|^{2}$。\n\n计算 $c_{E}(T_{\\mathrm{s}})$ 和 $c_{P}(T_{\\mathrm{s}})$ 关于 $T_{\\mathrm{s}}$ 的显式解析表达式。以行矩阵 $\\begin{pmatrix} c_{E}(T_{\\mathrm{s}}) & c_{P}(T_{\\mathrm{s}}) \\end{pmatrix}$ 的形式报告你的最终答案。不需要进行数值计算，最终答案中也不应包含单位。", "solution": "本题旨在建立一个连续时间带限信号的能量和功率，与其通过均匀采样得到的无混叠离散时间对应信号之间的定量关系。我们需要求出比例常数 $c_{E}(T_{\\mathrm{s}})$ 和 $c_{P}(T_{\\mathrm{s}})$。整个推导过程必须从基本原理出发。\n\n我们首先建立信号 $x_{\\mathrm{c}}(t)$ 的连续时间傅里叶变换 (CTFT) 与序列 $x[n] = x_{\\mathrm{c}}(n T_{\\mathrm{s}})$ 的离散时间傅里叶变换 (DTFT) 之间的基本关系。\n\n我们采用以下傅里叶变换的标准定义：\n信号 $g(t)$ 的 CTFT 为 $G(\\omega) = \\int_{-\\infty}^{\\infty} g(t) \\exp(-\\mathrm{j}\\omega t)\\,\\mathrm{d}t$。\n逆 CTFT 为 $g(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} G(\\omega) \\exp(\\mathrm{j}\\omega t)\\,\\mathrm{d}\\omega$。\n序列 $h[n]$ 的 DTFT 为 $H(\\mathrm{e}^{\\mathrm{j}\\Omega}) = \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(-\\mathrm{j}\\Omega n)$。\n逆 DTFT 为 $h[n] = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} H(\\mathrm{e}^{\\mathrm{j}\\Omega}) \\exp(\\mathrm{j}\\Omega n)\\,\\mathrm{d}\\Omega$。\n\n理想采样过程可以建模为将连续时间信号 $x_{\\mathrm{c}}(t)$ 乘以一个冲激串，得到采样后信号 $x_{\\mathrm{s}}(t) = x_{\\mathrm{c}}(t) \\sum_{n=-\\infty}^{\\infty} \\delta(t - n T_{\\mathrm{s}}) = \\sum_{n=-\\infty}^{\\infty} x_{\\mathrm{c}}(n T_{\\mathrm{s}}) \\delta(t - n T_{\\mathrm{s}})$。离散序列为 $x[n] = x_{\\mathrm{c}}(n T_{\\mathrm{s}})$。\n\n$x_{\\mathrm{s}}(t)$ 的 CTFT，记作 $X_{\\mathrm{s}}(\\omega)$，可以通过两种方式求得。首先，利用时域乘法性质，它对应于频域的卷积：\n$X_{\\mathrm{s}}(\\omega) = \\frac{1}{2\\pi} \\left( X_{\\mathrm{c}}(\\omega) * \\mathcal{F}\\left\\{\\sum_{n=-\\infty}^{\\infty} \\delta(t - n T_{\\mathrm{s}})\\right\\} \\right)$。\n冲激串的傅里叶变换是另一个冲激串：$\\mathcal{F}\\left\\{\\sum_{n=-\\infty}^{\\infty} \\delta(t - n T_{\\mathrm{s}})\\right\\} = \\omega_{\\mathrm{s}} \\sum_{k=-\\infty}^{\\infty} \\delta(\\omega - k \\omega_{\\mathrm{s}})$，其中 $\\omega_{\\mathrm{s}} = \\frac{2\\pi}{T_{\\mathrm{s}}}$。\n与这个冲激串进行卷积，会得到 $X_{\\mathrm{c}}(\\omega)$ 的周期性复制：\n$X_{\\mathrm{s}}(\\omega) = \\frac{1}{2\\pi} X_{\\mathrm{c}}(\\omega) * \\left( \\frac{2\\pi}{T_{\\mathrm{s}}} \\sum_{k=-\\infty}^{\\infty} \\delta(\\omega - k \\omega_{\\mathrm{s}}) \\right) = \\frac{1}{T_{\\mathrm{s}}} \\sum_{k=-\\infty}^{\\infty} X_{\\mathrm{c}}(\\omega - k \\omega_{\\mathrm{s}})$。\n\n其次，我们可以直接从其加权冲激之和的定义来计算 $x_{\\mathrm{s}}(t)$ 的 CTFT：\n$X_{\\mathrm{s}}(\\omega) = \\mathcal{F}\\left\\{\\sum_{n=-\\infty}^{\\infty} x[n] \\delta(t - n T_{\\mathrm{s}})\\right\\} = \\sum_{n=-\\infty}^{\\infty} x[n] \\exp(-\\mathrm{j}\\omega n T_{\\mathrm{s}})$。\n\n将其与 DTFT 的定义 $X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\Omega})$ 进行比较，我们发现 $X_{\\mathrm{s}}(\\omega)$ 正是 $x[n]$ 的 DTFT 在 $\\Omega = \\omega T_{\\mathrm{s}}$ 处的值。\n因此，我们得到了基本关系式：\n$$X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\omega T_{\\mathrm{s}}}) = \\frac{1}{T_{\\mathrm{s}}} \\sum_{k=-\\infty}^{\\infty} X_{\\mathrm{c}}(\\omega - k \\omega_{\\mathrm{s}})$$\n\n现在我们来推导能量的比例常数 $c_{E}(T_{\\mathrm{s}})$。\n连续时间信号 $x_{\\mathrm{c}}(t)$ 的能量由 CTFT 的帕塞瓦尔关系给出：\n$E_{\\mathrm{c}} = \\int_{-\\infty}^{\\infty} |x_{\\mathrm{c}}(t)|^{2}\\,\\mathrm{d}t = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} |X_{\\mathrm{c}}(\\omega)|^{2}\\,\\mathrm{d}\\omega$。\n离散时间序列 $x[n]$ 的能量由 DTFT 的帕塞瓦尔关系给出：\n$E_{\\mathrm{d}} = \\sum_{n=-\\infty}^{\\infty} |x[n]|^{2} = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} |X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\Omega})|^{2}\\,\\mathrm{d}\\Omega$。\n\n题目指出 $x_{\\mathrm{c}}(t)$ 是带限的，其带宽为 $|\\omega| \\leq \\omega_{\\mathrm{B}}$，这意味着当 $|\\omega| > \\omega_{\\mathrm{B}}$ 时 $X_{\\mathrm{c}}(\\omega)=0$。采样是无混叠的，这意味着 $\\omega_{\\mathrm{s}} > 2 \\omega_{\\mathrm{B}}$。这个条件确保了频谱副本 $X_{\\mathrm{c}}(\\omega - k \\omega_{\\mathrm{s}})$ 之间不会发生重叠。\n对于主频率区间 $|\\omega| < \\omega_{\\mathrm{s}}/2$，求和式 $\\sum_{k=-\\infty}^{\\infty} X_{\\mathrm{c}}(\\omega - k \\omega_{\\mathrm{s}})$ 得以简化。$k=0$ 的项为 $X_{\\mathrm{c}}(\\omega)$。对于任何 $k \\neq 0$，副本的中心 $k\\omega_s$ 位于区间 $(-\\omega_s, \\omega_s)$ 之外。由于 $|\\omega|<\\omega_s/2$，频率参数 $\\omega-k\\omega_s$ 的绝对值将大于 $\\omega_s/2$，而 $\\omega_s/2$ 又大于 $\\omega_{\\mathrm{B}}$。因此，当 $|\\omega| < \\omega_{\\mathrm{s}}/2$ 时，对于所有 $k \\ne 0$ 都有 $X_{\\mathrm{c}}(\\omega - k \\omega_{\\mathrm{s}}) = 0$。\n该关系式简化为 $X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\omega T_{\\mathrm{s}}}) = \\frac{1}{T_{\\mathrm{s}}} X_{\\mathrm{c}}(\\omega)$，对于 $|\\omega| < \\omega_{\\mathrm{s}}/2$。\n这意味着对于 $|\\omega| < \\omega_{\\mathrm{s}}/2$，有 $|X_{\\mathrm{c}}(\\omega)|^{2} = T_{\\mathrm{s}}^{2} |X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\omega T_{\\mathrm{s}}})|^{2}$。\n我们现在可以关联能量表达式。由于当 $|\\omega| > \\omega_{\\mathrm{B}}$ 时 $X_{\\mathrm{c}}(\\omega) = 0$ 且 $\\omega_{\\mathrm{B}} < \\omega_{\\mathrm{s}}/2$：\n$E_{\\mathrm{c}} = \\frac{1}{2\\pi} \\int_{-\\omega_{\\mathrm{B}}}^{\\omega_{\\mathrm{B}}} |X_{\\mathrm{c}}(\\omega)|^{2}\\,\\mathrm{d}\\omega = \\frac{1}{2\\pi} \\int_{-\\omega_{\\mathrm{B}}}^{\\omega_{\\mathrm{B}}} T_{\\mathrm{s}}^{2} |X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\omega T_{\\mathrm{s}}})|^{2}\\,\\mathrm{d}\\omega$。\n由于 $X_{\\mathrm{c}}(\\omega)$ 在 $\\omega_{\\mathrm{B}} < |\\omega| \\leq \\omega_{\\mathrm{s}}/2$ 区间为零，因此 $X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\omega T_{\\mathrm{s}}})$ 在此区间也为零。我们可以将积分限扩展到 $[-\\omega_{\\mathrm{s}}/2, \\omega_{\\mathrm{s}}/2] = [-\\pi/T_{\\mathrm{s}}, \\pi/T_{\\mathrm{s}}]$ 而不改变积分值：\n$E_{\\mathrm{c}} = \\frac{T_{\\mathrm{s}}^{2}}{2\\pi} \\int_{-\\pi/T_{\\mathrm{s}}}^{\\pi/T_{\\mathrm{s}}} |X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\omega T_{\\mathrm{s}}})|^{2}\\,\\mathrm{d}\\omega$。\n我们对积分进行变量替换：令 $\\Omega = \\omega T_{\\mathrm{s}}$，这意味着 $\\mathrm{d}\\omega = \\frac{1}{T_{\\mathrm{s}}}\\mathrm{d}\\Omega$。积分限变为 $[-\\pi, \\pi]$。\n$E_{\\mathrm{c}} = \\frac{T_{\\mathrm{s}}^{2}}{2\\pi} \\int_{-\\pi}^{\\pi} |X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\Omega})|^{2} \\frac{1}{T_{\\mathrm{s}}}\\,\\mathrm{d}\\Omega = \\frac{T_{\\mathrm{s}}}{2\\pi} \\int_{-\\pi}^{\\pi} |X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\Omega})|^{2}\\,\\mathrm{d}\\Omega$。\n右侧的积分等于 $2\\pi E_{\\mathrm{d}}$。因此：\n$E_{\\mathrm{c}} = T_{\\mathrm{s}} E_{\\mathrm{d}} = T_{\\mathrm{s}} \\sum_{n=-\\infty}^{\\infty} |x[n]|^{2}$。\n与题目陈述 $E_{\\mathrm{c}} = c_{E}(T_{\\mathrm{s}}) E_{\\mathrm{d}}$ 相比较，我们得到 $c_{E}(T_{\\mathrm{s}}) = T_{\\mathrm{s}}$。\n\n接下来，我们推导功率的比例常数 $c_{P}(T_{\\mathrm{s}})$。\n$P_{\\mathrm{c}} = \\lim_{T \\to \\infty} \\frac{1}{2T} \\int_{-T}^{T} |x_{\\mathrm{c}}(t)|^{2}\\,\\mathrm{d}t$。\n$P_{\\mathrm{d}} = \\lim_{N \\to \\infty} \\frac{1}{2N+1} \\sum_{n=-N}^{N} |x[n]|^{2}$。\n我们定义信号 $y(t) = |x_{\\mathrm{c}}(t)|^{2}$。问题在于关联 $y(t)$ 的时间平均值与其样本 $y[n] = y(nT_{\\mathrm{s}}) = |x_{\\mathrm{c}}(nT_{\\mathrm{s}})|^{2} = |x[n]|^{2}$ 的样本平均值。\n信号 $x_{\\mathrm{c}}(t)$ 的带宽限制在 $\\omega_{\\mathrm{B}}$ 内。时域中的平方操作对应于频域中的卷积。如果 $X_{\\mathrm{c}}(\\omega)$ 是 $x_{\\mathrm{c}}(t)$ 的 CTFT，那么 $y(t)=|x_c(t)|^2$ 的 CTFT 是 $Y(\\omega) = \\frac{1}{2\\pi} (X_{\\mathrm{c}}(\\omega) * X_{\\mathrm{c}}^{*}(-\\omega))$。由于 $x_{\\mathrm{c}}(t)$ 是实信号，所以 $X_{\\mathrm{c}}^{*}(-\\omega)=X_{\\mathrm{c}}(\\omega)$，因此 $Y(\\omega) = \\frac{1}{2\\pi} (X_{\\mathrm{c}}(\\omega) * X_{\\mathrm{c}}(\\omega))$。两个支撑集在 $[-\\omega_{\\mathrm{B}}, \\omega_{\\mathrm{B}}]$ 上的函数的卷积，其结果函数的支撑集在 $[-2\\omega_{\\mathrm{B}}, 2\\omega_{\\mathrm{B}}]$ 上。因此，$y(t)$ 是带限的，其带宽为 $2\\omega_{\\mathrm{B}}$。\n有一个定理指出，对于一个时间平均值为 $\\bar{g}_{\\mathrm{c}}$ 的信号 $g(t)$，其样本 $g[n]=g(nT_s)$ 的时间平均值（记作 $\\bar{g}_{\\mathrm{d}}$）等于 $\\bar{g}_{\\mathrm{c}}$ 的充分必要条件是，该信号的 CTFT $G(\\omega)$ 在采样频率的所有非零整数倍处为零，即对于所有整数 $k \\neq 0$，有 $G(k \\omega_{\\mathrm{s}}) = 0$。\n在我们的情况下，信号是 $y(t)$，其 CTFT 为 $Y(\\omega)$。我们已经确定当 $|\\omega| > 2\\omega_{\\mathrm{B}}$ 时 $Y(\\omega)=0$。采样频率为 $\\omega_{\\mathrm{s}} = \\frac{2\\pi}{T_{\\mathrm{s}}}$。条件是对于 $k \\in \\mathbb{Z}, k \\neq 0$，有 $Y(k \\omega_{\\mathrm{s}}) = 0$。\n根据 $x_{\\mathrm{c}}(t)$ 的无混叠条件，我们有 $\\omega_{\\mathrm{s}} > 2\\omega_{\\mathrm{B}}$。\n对于任何非零整数 $k$，我们有 $|k \\omega_{\\mathrm{s}}| \\geq \\omega_{\\mathrm{s}} > 2\\omega_{\\mathrm{B}}$。\n由于 $Y(\\omega)$ 在频率绝对值大于 $2\\omega_{\\mathrm{B}}$ 时为零，因此可以肯定对于所有 $k \\neq 0$ 都有 $Y(k \\omega_{\\mathrm{s}}) = 0$。\n条件得到满足。因此，连续时间信号 $y(t)$ 的平均值等于其离散时间样本 $y[n]$ 的平均值。\n$\\lim_{T \\to \\infty} \\frac{1}{2T} \\int_{-T}^{T} y(t)\\,\\mathrm{d}t = \\lim_{N \\to \\infty} \\frac{1}{2N+1} \\sum_{n=-N}^{N} y[n]$。\n将 $y(t) = |x_{\\mathrm{c}}(t)|^{2}$ 和 $y[n] = |x[n]|^{2}$ 代回：\n$\\lim_{T \\to \\infty} \\frac{1}{2T} \\int_{-T}^{T} |x_{\\mathrm{c}}(t)|^{2}\\,\\mathrm{d}t = \\lim_{N \\to \\infty} \\frac{1}{2N+1} \\sum_{n=-N}^{N} |x[n]|^{2}$。\n这正是 $P_{\\mathrm{c}} = P_{\\mathrm{d}}$ 的陈述。\n因此，比例常数 $c_{P}(T_{\\mathrm{s}})$ 为 $1$。\n\n这两个常数是 $c_{E}(T_{\\mathrm{s}}) = T_{\\mathrm{s}}$ 和 $c_{P}(T_{\\mathrm{s}}) = 1$。", "answer": "$$\\boxed{\\begin{pmatrix} T_{\\mathrm{s}} & 1 \\end{pmatrix}}$$", "id": "2904635"}, {"introduction": "采样之后，我们必须对信号的幅度进行量化，才能用数字形式表示。一个常见的简化方法是将量化误差建模为加性白噪声($\\text{AWN}$)。本练习将探讨一个该模型完全失效的特定场景，揭示出量化误差可能与输入信号高度相关。通过构建这个反例，你将对工程模型建立起批判性的视角，学会识别常用假设失效的条件，避免得出错误的结论[@problem_id:2904665]。", "problem": "考虑一个理想的模数转换器 (ADC) 内部使用的理想中置步长均匀量化器，无抖动处理。该量化器将任意实数输入 $x$ 映射到输出 $Q(x)$，其定义为\n$$\nQ(x) = \\Delta \\,\\left\\lfloor \\frac{x}{\\Delta} + \\frac{1}{2} \\right\\rfloor,\n$$\n其中 $\\Delta$ 是量化步长，$\\lfloor \\cdot \\rfloor$ 表示向下取整函数。假设量化器具有足够大的动态范围，因此不会发生过载。\n\n一个振幅为 $A$ 的模拟正弦信号 $x_{a}(t) = A \\cos\\!\\left(2\\pi f_{0} t\\right)$ 以采样频率 $f_{s}$ 被采样，形成离散时间输入 $x[n] = x_{a}(n/f_{s}) = A \\cos\\!\\left(\\omega_{0} n\\right)$，其中 $\\omega_{0} = 2\\pi f_{0}/f_{s}$。假设 $\\omega_{0} = 2\\pi p/M$，其中整数 $p$ 和 $M$ 互质，并且 $A$ 和 $\\Delta$ 满足 $0 < A < \\Delta/2$。设量化误差为 $e[n] = Q\\!\\left(x[n]\\right) - x[n]$。\n\n从上述定义（量化器映射、采样和量化误差）出发，确定精确的时间平均均方量化误差，\n$$\n\\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} \\left(e[n]\\right)^{2},\n$$\n的一个以 $A$ 和 $\\Delta$ 表示的闭式表达式。你的构建过程应清楚地说明，在这些条件下，为何加性白噪声 (AWN) 量化模型会失效，因为它产生的误差与输入相关，并呈现出可见的谱线。\n\n将你的最终答案表示为一个无单位的单一闭式解析表达式。无需四舍五入。", "solution": "该问题要求计算对正弦信号进行量化的特定情况下的时间平均均方量化误差。该问题是适定的且在科学上是合理的，因此我们可以进行求解。\n\n已知条件如下：\n-   一个由 $Q(x) = \\Delta \\left\\lfloor \\frac{x}{\\Delta} + \\frac{1}{2} \\right\\rfloor$ 定义的中置步长均匀量化器。\n-   一个离散时间输入信号 $x[n] = A \\cos(\\omega_{0} n)$，该信号是周期的。\n-   关于信号振幅 $A$ 和量化步长 $\\Delta$ 的一个关键条件：$0 < A < \\frac{\\Delta}{2}$。\n-   量化误差为 $e[n] = Q(x[n]) - x[n]$。\n-   目标是求均方误差 (MSE)，其定义为 $\\text{MSE} = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} (e[n])^{2}$。\n\n首先，我们必须分析在给定的振幅约束下量化器的行为。输入信号为 $x[n] = A \\cos(\\omega_{0} n)$。$x[n]$ 的取值范围是 $[-A, A]$。条件 $0 < A < \\frac{\\Delta}{2}$ 意味着对于所有整数 $n$，输入样本 $x[n]$ 严格限制在区间 $(-\\frac{\\Delta}{2}, \\frac{\\Delta}{2})$ 内。让我们考察在该范围内的任意输入值 $x$ 在量化器定义中向下取整函数的参数：\n$$\n-\\frac{\\Delta}{2} < x < \\frac{\\Delta}{2}\n$$\n由于 $\\Delta > 0$，两边同除以 $\\Delta$ 可得：\n$$\n-\\frac{1}{2} < \\frac{x}{\\Delta} < \\frac{1}{2}\n$$\n不等式各部分都加上 $\\frac{1}{2}$ 可得：\n$$\n0 < \\frac{x}{\\Delta} + \\frac{1}{2} < 1\n$$\n向下取整函数 $\\lfloor z \\rfloor$ 得到小于或等于 $z$ 的最大整数。对于任何满足 $0 < z < 1$ 的值 $z$，向下取整函数 $\\lfloor z \\rfloor$ 等于 $0$。因此，对于范围 $(-\\frac{\\Delta}{2}, \\frac{\\Delta}{2})$ 内的任何输入 $x$，量化器输出为：\n$$\nQ(x) = \\Delta \\left\\lfloor \\frac{x}{\\Delta} + \\frac{1}{2} \\right\\rfloor = \\Delta \\times 0 = 0\n$$\n由于对所有 $n$，输入样本 $x[n]$ 都在此范围内，量化器输出始终为零：\n$$\nQ(x[n]) = 0 \\quad \\text{对所有 } n\n$$\n这是小信号条件 $A < \\frac{\\Delta}{2}$ 的一个关键结果。信号太小，无法跨越任何量化阈值，因此它总是被映射到中心量化电平，对于中置步长量化器，该电平为零。\n\n现在我们可以确定量化误差序列 $e[n]$：\n$$\ne[n] = Q(x[n]) - x[n] = 0 - x[n] = -x[n]\n$$\n代入 $x[n]$ 的表达式，我们得到：\n$$\ne[n] = -A \\cos(\\omega_{0} n)\n$$\n问题要求的是时间平均均方误差。我们将 $e[n]$ 的表达式代入 MSE 的定义中：\n$$\n\\text{MSE} = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} \\left(-A \\cos(\\omega_{0} n)\\right)^{2} = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} A^{2} \\cos^{2}(\\omega_{0} n)\n$$\n这恰好是信号 $x[n]$ 的平均功率的定义。为计算此极限，我们使用三角恒等式 $\\cos^{2}(\\theta) = \\frac{1 + \\cos(2\\theta)}{2}$：\n$$\n\\text{MSE} = A^{2} \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} \\left( \\frac{1 + \\cos(2\\omega_{0} n)}{2} \\right)\n$$\n$$\n\\text{MSE} = \\frac{A^{2}}{2} \\left( \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} 1 + \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} \\cos(2\\omega_{0} n) \\right)\n$$\n第一个极限是直接的：\n$$\n\\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} 1 = \\lim_{N \\to \\infty} \\frac{N}{N} = 1\n$$\n第二个极限是余弦函数的时间平均值。正弦信号 $\\cos(\\Omega n)$ 的时间平均值为零，除非其频率 $\\Omega$ 是 $2\\pi$ 的整数倍（即直流信号）。在这里，频率是 $2\\omega_{0} = 4\\pi p/M$。该频率是 $2\\pi$ 的整数倍，当且仅当 $2p/M$ 是一个整数。考虑到 $p$ 和 $M$ 互质，这只在 $M=1$ 或 $M=2$ 时发生。这两种情况分别对应于直流输入或奈奎斯特 (Nyquist) 频率下的输入。对于任何其他情况（即 $M>2$），$\\cos(2\\omega_{0} n)$ 的时间平均值为零。问题的提法暗示了普遍性，而非这些边缘情况。因此，我们采用标准结果：\n$$\n\\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} \\cos(2\\omega_{0} n) = 0\n$$\n将这些结果代回 MSE 的表达式中，我们得到：\n$$\n\\text{MSE} = \\frac{A^{2}}{2} (1 + 0) = \\frac{A^{2}}{2}\n$$\n至此，均方误差的推导完成。\n\n问题还要求解释为何加性白噪声 (AWN) 量化模型在这些条件下失效。AWN 模型是一个常见的近似，其中量化误差 $e[n]$ 被建模为一个具有特定统计特性的随机噪声源。这些特性是：\n1.  误差与输入信号 $x[n]$ 不相关。\n2.  误差在区间 $(-\\frac{\\Delta}{2}, \\frac{\\Delta}{2})$ 上服从均匀概率分布。\n3.  误差功率谱是平坦的（白噪声）。\n\n在这些假设下，预测的均方误差为 $\\frac{\\Delta^{2}}{12}$。我们推导出的结果是 $\\frac{A^{2}}{2}$，两者显然不同。我们严谨的构建过程通过违反其每一条核心假设，证明了 AWN 模型的失败：\n\n-   **违反不相关性假设**：我们发现 $e[n] = -x[n]$。误差是输入信号的一个缩放版本。误差和输入之间的互相关为 $R_{ex}[k] = E[e[n]x[n-k]] = E[(-x[n])x[n-k]] = -R_{xx}[k]$，其中 $R_{xx}[k]$ 是输入的自相关。误差与输入完全反相关，而不是不相关。\n\n-   **违反均匀分布假设**：误差信号 $e[n] = -A \\cos(\\omega_{0} n)$ 是一个正弦波。正弦信号的概率密度函数不是均匀的；对于 $|y| < A$，它由 $p(y) = \\frac{1}{\\pi\\sqrt{A^2 - y^2}}$ 给出。该分布高度集中在峰值 $\\pm A$ 附近，这与均匀分布正好相反。\n\n-   **违反白噪声谱假设**：白噪声信号具有平坦的功率谱密度，意味着其功率分布在所有频率上。我们的误差信号 $e[n] = -A \\cos(\\omega_0 n)$ 是一个纯正弦波。其功率谱由位于频率 $\\pm\\omega_{0}$ 处的两个脉冲（离散谱线）组成。这是一个有音调的、高度结构化的谱，而不是白噪声谱。这正是问题中提到的“可见的谱线”——误差的频谱是输入频谱的复制品。\n\n总而言之，对于小振幅输入 ($A < \\frac{\\Delta}{2}$)，量化器表现为一个非线性的“死区”设备，所产生的误差完全由输入信号确定并与其相关。支撑 AWN 模型及其 $\\frac{\\Delta^{2}}{12}$ 功率公式的统计假设在此情况下完全无效。", "answer": "$$\\boxed{\\frac{A^{2}}{2}}$$", "id": "2904665"}, {"introduction": "数字信号处理常常涉及改变信号的采样率，例如插值操作，但直接实现计算成本可能非常高。本练习将介绍强大的多相分解概念，这是一种重构滤波器以实现高效多速率运算的技术。通过推导多相结构并量化其计算节省，你将掌握一项在现代通信系统和音频处理中用于构建高性能、高资源效率系统的基本技能[@problem_id:2904719]。", "problem": "考虑一个离散时间插值系统，该系统将一个实值序列 $x[n]$ 以一个整数因子 $L \\ge 2$ 进行上采样，然后应用一个长度为 $N \\in \\mathbb{Z}_{\\ge 1}$ 的因果有限脉冲响应（FIR）滤波器，其脉冲响应为 $h[n]$。请仅使用离散时间中的上采样和线性时不变卷积的核心定义。\n\n- 因子为 $L$ 的上采样器定义为产生序列 $x_{\\uparrow L}[m]$，使得当 $m$ 是 $L$ 的倍数时，$x_{\\uparrow L}[m] = x[m/L]$，否则 $x_{\\uparrow L}[m] = 0$。\n- 输出 $y[m]$ 是 $x_{\\uparrow L}[m]$ 与 $h[m]$ 的线性卷积。\n\n你的任务是：\n\n1. 从上述定义出发，通过将 FIR 滤波器 $h[n]$ 分解为 $L$ 个 1 型多相分量（形式为序列 $\\{e_{r}[k]\\}$ 及其离散时间 $z$ 变换 $\\{E_{r}(z)\\}$，其中 $r \\in \\{0,1,\\dots,L-1\\}$），推导插值器的多相实现。用这些多相分量和输入 $x[n]$ 表示输出样本 $y[m]$，并清楚地指明哪个多相分支对输出索引 $m \\bmod L$ 的给定剩余类有贡献。\n\n2. 使用同样的基本原理，确定以下两种实现中每个输出样本所需的平均实数乘法次数：\n   - 一种是直接高速率实现，它将长度为 $N$ 的 FIR 滤波器应用于 $x_{\\uparrow L}[m]$，而不利用上采样产生的任何零值样本。\n   - 另一种是在输入速率下运行的派生多相实现。\n\n3. 将计算节省量 $S(L,N)$ 定义为直接高速率乘法计数与多相乘法计数之间的差值（每个输出样本）。提供 $S(L,N)$ 作为 $L$ 和 $N$ 的函数的单个闭式解析表达式。\n\n将你的最终答案表述为 $S(L,N)$ 的表达式。无需进行数值评估。", "solution": "该问题陈述在科学上是合理的、自洽的且定义明确的。它提出了一个多速率数字信号处理中的标准问题，基于上采样、卷积和多相分解的既定定义。所有术语都有正式定义，目标清晰且在数学上是可处理的。该问题是有效的。\n\n该解决方案分为三个部分，对应问题陈述中的三个任务。\n\n**1. 多相实现的推导**\n\n系统输出 $y[m]$ 由上采样信号 $x_{\\uparrow L}[m]$ 和 FIR 滤波器脉冲响应 $h[n]$ 的线性卷积给出。由于滤波器是长度为 $N$ 的因果滤波器，卷积和为：\n$$ y[m] = (x_{\\uparrow L} * h)[m] = \\sum_{k=0}^{N-1} h[k] x_{\\uparrow L}[m-k] $$\n根据定义，上采样信号 $x_{\\uparrow L}[j]$ 仅在索引 $j$ 是 $L$ 的整数倍时非零。因此，求和中的项要为非零，索引 $m-k$ 必须是 $L$ 的倍数。设 $m-k = pL$，其中 $p$ 为某个整数。这意味着 $k = m - pL$。此外，对于这样的索引，$x_{\\uparrow L}[m-k] = x_{\\uparrow L}[pL] = x[p] = x[(m-k)/L]$。\n\n为了形式化多相分解，我们首先通过将其系数按索引模 $L$ 分组来表示滤波器的传递函数 $H(z) = \\sum_{n=0}^{N-1} h[n] z^{-n}$。我们替换 $n = kL+r$，其中 $r \\in \\{0, 1, \\dots, L-1\\}$ 是多相分支索引，$k$ 是分量内的索引。\n$$ H(z) = \\sum_{r=0}^{L-1} \\sum_{k \\text{ s.t. } 0 \\le kL+r < N} h[kL+r] z^{-(kL+r)} $$\n重新整理这些项，我们得到：\n$$ H(z) = \\sum_{r=0}^{L-1} z^{-r} \\left( \\sum_{k} h[kL+r] (z^L)^{-k} \\right) $$\n这是 1 型多相分解。我们将第 $r$ 个多相分量的脉冲响应定义为 $e_r[k] = h[kL+r]$。相应的 Z 变换是 $E_r(z) = \\sum_{k} e_r[k] z^{-k}$。滤波器的传递函数则为：\n$$ H(z) = \\sum_{r=0}^{L-1} z^{-r} E_r(z^L) $$\n为了找到输出 $y[m]$ 的表达式，我们分析给定模 $L$ 剩余类的输出样本。设输出时间索引为 $m = pL+r$，其中 $p = \\lfloor m/L \\rfloor$ 是一个整数，$r \\in \\{0, 1, \\dots, L-1\\}$ 是余数。将此代入卷积和：\n$$ y[pL+r] = \\sum_{k=0}^{N-1} h[k] x_{\\uparrow L}[(pL+r)-k] $$\n项 $x_{\\uparrow L}[(pL+r)-k]$ 仅在 $(pL+r)-k$ 是 $L$ 的倍数时非零。这要求 $(r-k) \\pmod L = 0$，即 $k \\pmod L = r$。因此，求和仅对形式为 $k=qL+r$ 的索引 $k$ 进行，其中 $q$ 为某个整数。\n$$ y[pL+r] = \\sum_{q \\text{ s.t. } 0 \\le qL+r < N} h[qL+r] x_{\\uparrow L}[(pL+r) - (qL+r)] $$\n$$ y[pL+r] = \\sum_{q} h[qL+r] x_{\\uparrow L}[(p-q)L] $$\n使用上采样器的定义，$x_{\\uparrow L}[(p-q)L] = x[p-q]$。我们还使用多相分量的定义，$e_r[q] = h[qL+r]$。\n$$ y[pL+r] = \\sum_{q} e_r[q] x[p-q] $$\n这个最终的和是输入序列 $x[n]$ 与多相滤波器 $e_r[n]$ 在时间 $p$ 处求值的离散时间卷积的定义。\n$$ y[pL+r] = (x * e_r)[p] $$\n这个方程展示了多相实现。输出样本 $y[m]$ 的计算首先要确定其剩余类 $r = m \\pmod L$。然后，将相应的多相滤波器 $e_r[n]$ 与原始的低速率输入信号 $x[n]$ 进行卷积。所需的特定输出样本是该卷积在索引 $p = \\lfloor m/L \\rfloor$ 处的值。因此，具有滤波器 $e_r[n]$ 的第 $r$ 个多相分支，对所有满足 $m \\pmod L = r$ 的输出样本 $y[m]$ 都有贡献。\n\n**2. 计算复杂度的计算**\n\n我们确定两种指定实现中每个输出样本所需的平均实数乘法次数。\n\n**直接高速率实现：**\n输出计算为 $y[m] = \\sum_{k=0}^{N-1} h[k] x_{\\uparrow L}[m-k]$。问题陈述指出，此计算是在“不利用上采样产生的任何零值样本”的情况下执行的。这意味着一种朴素的实现方式，即对每个输出样本 $y[m]$，都评估完整的 FIR 滤波器和。这涉及 $h[k]$ 与 $x_{\\uparrow L}[m-k]$ 形式的 $N$ 次乘法。因此，每个输出样本的乘法次数为 $N$。\n$$ C_{\\text{direct}} = N $$\n\n**多相实现：**\n在多相结构中，对于每个低速率时间步 $p$，会生成 $L$ 个输出样本，对应从 $y[pL]$ 到 $y[pL+L-1]$ 的一个块。这需要计算 $L$ 个多相滤波器输出中的每一个样本：$v_r[p] = (x * e_r)[p]$，其中 $r \\in \\{0, 1, \\dots, L-1\\}$。\n对于一个长度为 $N$ 的因果主滤波器 $h[n]$，第 $r$ 个多相滤波器 $e_r[k] = h[kL+r]$ 的系数数量是满足 $kL+r \\le N-1$ 的整数 $k \\ge 0$ 的数量。这个数量是 $N_r = \\lfloor \\frac{N-1-r}{L} \\rfloor + 1$。\n计算一个样本 $v_r[p]$ 需要 $N_r$ 次乘法。要生成该块的 $L$ 个输出，我们必须从 $L$ 个分支中的每一个计算一个样本。产生 $L$ 个输出样本所需的总乘法次数是：\n$$ C_{\\text{block}} = \\sum_{r=0}^{L-1} N_r = \\sum_{r=0}^{L-1} \\left( \\left\\lfloor \\frac{N-1-r}{L} \\right\\rfloor + 1 \\right) $$\n多相分量的长度之和等于原始滤波器的长度，即 $\\sum_{r=0}^{L-1} N_r = N$。这是因为该分解是 $h[n]$ 的 $N$ 个系数的划分。\n因此，需要 $N$ 次乘法才能产生 $L$ 个输出样本。每个输出样本的平均乘法次数为：\n$$ C_{\\text{poly}} = \\frac{N}{L} $$\n\n**3. 计算节省量的推导**\n\n计算节省量 $S(L,N)$ 定义为直接实现和多相实现之间每个输出样本的平均乘法次数之差。\n$$ S(L,N) = C_{\\text{direct}} - C_{\\text{poly}} $$\n代入推导出的值：\n$$ S(L,N) = N - \\frac{N}{L} $$\n将 $N$ 因子提出，得到最终的闭式表达式：\n$$ S(L,N) = N \\left(1 - \\frac{1}{L}\\right) = N \\frac{L-1}{L} $$\n此表达式量化了通过使用高效的多相结构进行插值所实现的计算负载减少量，该结构避免了与上采样器引入的零值样本进行乘法运算。", "answer": "$$ \\boxed{N \\frac{L-1}{L}} $$", "id": "2904719"}]}