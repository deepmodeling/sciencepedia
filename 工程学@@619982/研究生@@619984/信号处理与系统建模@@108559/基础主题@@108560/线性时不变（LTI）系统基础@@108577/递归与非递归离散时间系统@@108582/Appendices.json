{"hands_on_practices": [{"introduction": "让我们从最简单的递归系统——一阶无限脉冲响应（IIR）滤波器——开始我们的实践之旅。这个练习将通过一个具体的、分步计算过程，直观地展示反馈是如何从一个简单的结构中产生无限长的脉冲响应。掌握这一基本计算是理解所有递归系统行为的基石。[@problem_id:1747679]", "problem": "一个简单的一阶无限脉冲响应（IIR）数字滤波器由以下线性常系数差分方程描述：\n$$y[n] = \\alpha y[n-1] + x[n]$$\n此处，$x[n]$ 是输入信号序列，$y[n]$ 是输出信号序列，而 $\\alpha$ 是一个实值反馈系数。已知该系统是因果的，并且初始状态为静止，这意味着对于所有 $n < 0$，$y[n] = 0$。\n\n为了表征该滤波器，需要计算其脉冲响应，记为 $h[n]$。脉冲响应定义为当输入是单位脉冲序列 $\\delta[n]$ 时系统的输出，其中当 $n=0$ 时 $\\delta[n] = 1$，当 $n \\neq 0$ 时 $\\delta[n]=0$。\n\n给定反馈系数 $\\alpha = 0.7$，计算脉冲响应的第四个样本的数值，这对应于时间索引 $n=3$ 处的 $h[n]$ 值。", "solution": "给定一个初始静止的因果系统的线性常系数差分方程：\n$$y[n] = \\alpha y[n-1] + x[n], \\quad y[n]=0 \\text{ for } n<0.$$\n脉冲响应 $h[n]$ 是输入为 $x[n]=\\delta[n]$ 时的输出，因此它满足\n$$h[n] = \\alpha h[n-1] + \\delta[n], \\quad h[n]=0 \\text{ for } n<0.$$\n\n逐步计算递归过程：\n- 在 $n=0$ 时，使用 $h[-1]=0$ 和 $\\delta[0]=1$：\n$$h[0] = \\alpha h[-1] + \\delta[0] = \\alpha \\cdot 0 + 1 = 1.$$\n- 对于 $n \\geq 1$，由于 $\\delta[n]=0$，递归变为\n$$h[n] = \\alpha h[n-1].$$\n因此，\n$$h[1] = \\alpha h[0] = \\alpha,\\quad h[2] = \\alpha h[1] = \\alpha^{2},\\quad h[3] = \\alpha h[2] = \\alpha^{3}.$$\n\n通过归纳法，其闭合形式为\n$$h[n] = \\alpha^{n} u[n],$$\n其中 $u[n]$ 是单位阶跃序列。\n\n对于 $\\alpha = 0.7$ 和 $n=3$，\n$$h[3] = \\alpha^{3} = (0.7)^{3} = 0.343.$$", "answer": "$$\\boxed{0.343}$$", "id": "1747679"}, {"introduction": "在掌握了基础之后，我们将处理一个更复杂的二阶系统，并探索其不同的表示方法。本练习将指导您完成系统分析中的一个关键过程：使用部分分式展开将一个高阶系统分解为一组一阶状态方程。这项实践将系统的外部输入-输出视角（传递函数 $H(z)$）与内部动态（状态空间模型）联系起来，这是现代系统理论的基石。[@problem_id:2899361]", "problem": "一位工程师正在分析一个已知的、稳定的、具有有理传递函数的因果线性时不变离散时间系统。该系统在复$z$域中通过其输出和输入的单边$z$变换之比进行建模，记为 $H(z) = Y(z)/X(z)$。对于 $n < 0$ 时为零的序列，单边$z$变换定义为 $Z\\{x[n]\\} = \\sum_{n=0}^{\\infty} x[n] z^{-n}$，对于稳定系统，其收敛域包含单位圆。该LTI（线性时不变）系统从静止状态驱动，意味着所有过去的状​​态和输出在 $n < 0$ 时都为零。\n\n给定具体的传递函数\n$$\nH(z) \\;=\\; \\frac{1 + 0.5\\,z^{-1}}{1 - 1.2\\,z^{-1} + 0.32\\,z^{-2}} \\,。\n$$\n\n任务：\n\n1) 从单边$z$变换的定义和因果LTI系统的输入输出关系出发，不假设任何预先记忆的实现公式，首先将分母多项式分解为关于变量 $z^{-1}$ 的一阶项，然后对 $H(z)$ 进行关于变量 $z^{-1}$ 的部分分式展开。利用该展开推导出一个因果线性常系数差分方程，该方程将 $y[n]$ 与 $y[n-1]$、$y[n-2]$、$x[n]$ 和 $x[n-1]$ 联系起来。\n\n2) 使用部分分式展开结构，通过将状态变量定义为由输入直接驱动的一阶子系统的输出，构建一个最小阶状态递归。明确推导状态更新方程 $\\mathbf{s}[n] = \\mathbf{A}\\,\\mathbf{s}[n-1] + \\mathbf{B}\\,x[n]$ 和输出方程 $y[n] = \\mathbf{C}\\,\\mathbf{s}[n] + D\\,x[n]$，并确定矩阵 $\\mathbf{A}$、$\\mathbf{B}$、$\\mathbf{C}$ 和标量 $D$。您的推导应自成体系，并从关于 $z^{-1}$ 的展开式中逻辑地得出。\n\n3) 现在考虑特定输入 $x[n] = u[n]$（单位阶跃序列）和初始静止条件。使用您推导的递归关系，计算输出样本 $y[4]$。\n\n将最终数值答案四舍五入到四位有效数字。仅报告第3部分要求的实数作为您的最终答案，不带单位。", "solution": "分析从给定的因果、稳定LTI系统的传递函数开始：\n$$\nH(z) = \\frac{Y(z)}{X(z)} = \\frac{1 + 0.5z^{-1}}{1 - 1.2z^{-1} + 0.32z^{-2}}\n$$\n\n**1) 差分方程的推导**\n\n第一个任务是推导线性常系数差分方程。按照指示，我们将对变量 $z^{-1}$ 使用部分分式展开 (PFE)。首先，必须对分母多项式 $D(z^{-1}) = 1 - 1.2z^{-1} + 0.32z^{-2}$ 进行因式分解。对应的关于 $z$ 的多项式 $P(z) = z^2 - 1.2z + 0.32$ 的根决定了系统的极点。使用二次公式：\n$$\nz = \\frac{-(-1.2) \\pm \\sqrt{(-1.2)^2 - 4(1)(0.32)}}{2(1)} = \\frac{1.2 \\pm \\sqrt{1.44 - 1.28}}{2} = \\frac{1.2 \\pm \\sqrt{0.16}}{2} = \\frac{1.2 \\pm 0.4}{2}\n$$\n极点是 $p_1 = 0.8$ 和 $p_2 = 0.4$。两个极点都在单位圆内部 ($|p_1| < 1$, $|p_2| < 1$)，这与所述的因果系统的稳定性是一致的。现在可以将分母分解为 $z^{-1}$ 的形式：\n$$\n1 - 1.2z^{-1} + 0.32z^{-2} = (1 - 0.8z^{-1})(1 - 0.4z^{-1})\n$$\n我们现在对 $H(z)$ 进行关于变量 $z^{-1}$ 的部分分式展开：\n$$\nH(z) = \\frac{1 + 0.5z^{-1}}{(1 - 0.8z^{-1})(1 - 0.4z^{-1})} = \\frac{A}{1 - 0.8z^{-1}} + \\frac{B}{1 - 0.4z^{-1}}\n$$\n系数 $A$ 和 $B$ 使用海维赛德覆盖法求得：\n$$\nA = \\left. \\frac{1 + 0.5z^{-1}}{1 - 0.4z^{-1}} \\right|_{z^{-1}=1/0.8} = \\frac{1 + 0.5(1.25)}{1 - 0.4(1.25)} = \\frac{1 + 0.625}{1 - 0.5} = \\frac{1.625}{0.5} = 3.25\n$$\n$$\nB = \\left. \\frac{1 + 0.5z^{-1}}{1 - 0.8z^{-1}} \\right|_{z^{-1}=1/0.4} = \\frac{1 + 0.5(2.5)}{1 - 0.8(2.5)} = \\frac{1 + 1.25}{1 - 2.0} = \\frac{2.25}{-1} = -2.25\n$$\n因此，部分分式展开为：\n$$\nH(z) = \\frac{3.25}{1 - 0.8z^{-1}} - \\frac{2.25}{1 - 0.4z^{-1}}\n$$\n为推导所需的差分方程，我们通过重新组合这些项来使用此展开式，这也验证了因式分解和系数的正确性：\n$$\nH(z) = \\frac{3.25(1 - 0.4z^{-1}) - 2.25(1 - 0.8z^{-1})}{(1 - 0.8z^{-1})(1 - 0.4z^{-1})} = \\frac{(3.25 - 2.25) + (-3.25 \\times 0.4 + 2.25 \\times 0.8)z^{-1}}{1 - 1.2z^{-1} + 0.32z^{-2}} = \\frac{1 + (-1.3 + 1.8)z^{-1}}{1 - 1.2z^{-1} + 0.32z^{-2}}\n$$\n这正确地再现了原始传递函数 $H(z) = \\frac{1 + 0.5z^{-1}}{1 - 1.2z^{-1} + 0.32z^{-2}}$。\n根据定义 $Y(z) = H(z)X(z)$，我们有：\n$$\nY(z) (1 - 1.2z^{-1} + 0.32z^{-2}) = X(z) (1 + 0.5z^{-1})\n$$\n展开此式得到：\n$$\nY(z) - 1.2z^{-1}Y(z) + 0.32z^{-2}Y(z) = X(z) + 0.5z^{-1}X(z)\n$$\n应用单边 $z$ 逆变换并利用时移性质 $Z^{-1}\\{z^{-k}W(z)\\} = w[n-k]$，我们得到静止状态下因果系统的差分方程：\n$$\ny[n] - 1.2y[n-1] + 0.32y[n-2] = x[n] + 0.5x[n-1]\n$$\n整理得到 $y[n]$:\n$$\ny[n] = 1.2y[n-1] - 0.32y[n-2] + x[n] + 0.5x[n-1]\n$$\n\n**2) 状态空间表示**\n\n我们将按照提示使用部分分式展开结构，以并联形式构建一个最小阶状态空间实现。传递函数是两个一阶项的和：\n$$\nY(z) = H(z)X(z) = \\left( \\frac{3.25}{1 - 0.8z^{-1}} - \\frac{2.25}{1 - 0.4z^{-1}} \\right) X(z)\n$$\n我们将状态变量 $s_1[n]$ 和 $s_2[n]$ 定义为由输入 $x[n]$ 驱动的一阶子系统的输出。设它们的 $z$ 变换为 $S_1(z)$ 和 $S_2(z)$：\n$$\nS_1(z) = \\frac{X(z)}{1 - 0.8z^{-1}} \\quad \\implies \\quad S_1(z)(1 - 0.8z^{-1}) = X(z)\n$$\n$$\nS_2(z) = \\frac{X(z)}{1 - 0.4z^{-1}} \\quad \\implies \\quad S_2(z)(1 - 0.4z^{-1}) = X(z)\n$$\n在时域中，这些对应于状态更新方程：\n$$\ns_1[n] - 0.8s_1[n-1] = x[n] \\quad \\implies \\quad s_1[n] = 0.8s_1[n-1] + x[n]\n$$\n$$\ns_2[n] - 0.4s_2[n-1] = x[n] \\quad \\implies \\quad s_2[n] = 0.4s_2[n-1] + x[n]\n$$\n使用状态向量 $\\mathbf{s}[n] = \\begin{pmatrix} s_1[n] \\\\ s_2[n] \\end{pmatrix}$，状态更新方程 $\\mathbf{s}[n] = \\mathbf{A}\\,\\mathbf{s}[n-1] + \\mathbf{B}\\,x[n]$ 为：\n$$\n\\begin{pmatrix} s_1[n] \\\\ s_2[n] \\end{pmatrix} = \\begin{pmatrix} 0.8 & 0 \\\\ 0 & 0.4 \\end{pmatrix} \\begin{pmatrix} s_1[n-1] \\\\ s_2[n-1] \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} x[n]\n$$\n输出 $Y(z)$ 是中间子系统输出的线性组合：\n$$\nY(z) = 3.25 S_1(z) - 2.25 S_2(z)\n$$\n在时域中，输出方程为：\n$$\ny[n] = 3.25s_1[n] - 2.25s_2[n]\n$$\n这与所需形式 $y[n] = \\mathbf{C}\\,\\mathbf{s}[n] + D\\,x[n]$ 相匹配。因此，矩阵为：\n$$\n\\mathbf{A} = \\begin{pmatrix} 0.8 & 0 \\\\ 0 & 0.4 \\end{pmatrix}, \\quad \\mathbf{B} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad \\mathbf{C} = \\begin{pmatrix} 3.25 & -2.25 \\end{pmatrix}, \\quad D = 0\n$$\n\n**3) 输出样本 $y[4]$ 的计算**\n\n我们计算当输入为 $x[n] = u[n]$（单位阶跃序列，当 $n \\ge 0$ 时 $x[n]=1$，当 $n<0$ 时 $x[n]=0$）且系统从静止状态（$\\mathbf{s}[-1] = \\mathbf{0}$）启动时的 $y[4]$。我们将迭代状态方程和输出方程。\n\n对于 $n=0$:\n$s_1[0] = 0.8s_1[-1] + x[0] = 0.8(0) + 1 = 1$\n$s_2[0] = 0.4s_2[-1] + x[0] = 0.4(0) + 1 = 1$\n$y[0] = 3.25s_1[0] - 2.25s_2[0] = 3.25(1) - 2.25(1) = 1$\n\n对于 $n=1$:\n$s_1[1] = 0.8s_1[0] + x[1] = 0.8(1) + 1 = 1.8$\n$s_2[1] = 0.4s_2[0] + x[1] = 0.4(1) + 1 = 1.4$\n$y[1] = 3.25s_1[1] - 2.25s_2[1] = 3.25(1.8) - 2.25(1.4) = 5.85 - 3.15 = 2.7$\n\n对于 $n=2$:\n$s_1[2] = 0.8s_1[1] + x[2] = 0.8(1.8) + 1 = 1.44 + 1 = 2.44$\n$s_2[2] = 0.4s_2[1] + x[2] = 0.4(1.4) + 1 = 0.56 + 1 = 1.56$\n$y[2] = 3.25s_1[2] - 2.25s_2[2] = 3.25(2.44) - 2.25(1.56) = 7.93 - 3.51 = 4.42$\n\n对于 $n=3$:\n$s_1[3] = 0.8s_1[2] + x[3] = 0.8(2.44) + 1 = 1.952 + 1 = 2.952$\n$s_2[3] = 0.4s_2[2] + x[3] = 0.4(1.56) + 1 = 0.624 + 1 = 1.624$\n$y[3] = 3.25s_1[3] - 2.25s_2[3] = 3.25(2.952) - 2.25(1.624) = 9.594 - 3.654 = 5.94$\n\n对于 $n=4$:\n$s_1[4] = 0.8s_1[3] + x[4] = 0.8(2.952) + 1 = 2.3616 + 1 = 3.3616$\n$s_2[4] = 0.4s_2[3] + x[4] = 0.4(1.624) + 1 = 0.6496 + 1 = 1.6496$\n$y[4] = 3.25s_1[4] - 2.25s_2[4] = 3.25(3.3616) - 2.25(1.6496) = 10.9252 - 3.7116 = 7.2136$\n\n问题要求将答案四舍五入到四位有效数字。\n$y[4] = 7.2136 \\approx 7.214$。", "answer": "$$\n\\boxed{7.214}\n$$", "id": "2899361"}, {"introduction": "我们最后的这个实践练习旨在连接理想理论与真实世界的实现。我们将探索极零点对消（一种旨在将IIR系统的响应变为FIR响应的技术），并研究数字硬件中不可避免的有限精度误差如何导致不完美的对消效果。通过计算残余误差信号的能量，您将学会量化这些非理想效应对系统性能的实际影响。[@problem_id:1747721]", "problem": "考虑一个为实现极零点对消而设计的离散时间线性时不变（LTI）系统。该系统由一个预处理有限冲激响应（FIR）滤波器与一个递归无限冲激响应（IIR）滤波器级联而成。\n\n理想的IIR滤波器其传递函数为 $H_{ideal}(z) = \\frac{1}{1-pz^{-1}}$，理想的FIR预滤波器其传递函数为 $G_{ideal}(z) = 1-pz^{-1}$，其中 $p$ 是一个满足 $0 < |p| < 1$ 的实常数。在理想情况下，总系统传递函数为 $T_{ideal}(z) = G_{ideal}(z)H_{ideal}(z) = 1$，其冲激响应为单位冲激 $\\delta[n]$。\n\n在采用有限精度算术的实际实现中，系数会受到扰动。实际的IIR滤波器以传递函数 $H_{actual}(z) = \\frac{1}{1-p'z^{-1}}$ 实现，其中有效极点位置为 $p' = p(1+\\epsilon_p)$。实际的FIR预滤波器以传递函数 $G_{actual}(z) = 1-p''z^{-1}$ 实现，其中有效零点位置为 $p'' = p(1+\\epsilon_z)$。量 $\\epsilon_p$ 和 $\\epsilon_z$ 是微小的、独立的、实值相对误差。\n\n这个实际级联系统的冲激响应，记为 $y[n]$，将不再是一个完美的单位冲激。由于不精确的对消，它将在 $n > 0$ 时表现出非周期性的“拖尾”。\n\n假设 $|\\epsilon_p| \\ll 1$ 且 $|\\epsilon_z| \\ll 1$，请推导该拖尾总能量的解析表达式，其定义为 $E_{tail} = \\sum_{n=1}^{\\infty} |y[n]|^2$。您的最终表达式必须是一个在误差项上精确到二阶的近似（即，包含与 $\\epsilon_p^2$、$\\epsilon_z^2$ 和 $\\epsilon_p\\epsilon_z$ 成正比的项，同时忽略所有更高阶的项）。", "solution": "实际的总传递函数为\n$$\nT_{\\text{actual}}(z)=\\frac{1-p''z^{-1}}{1-p' z^{-1}}=1+\\frac{(p'-p'')z^{-1}}{1-p' z^{-1}}.\n$$\n使用Z逆变换恒等式 $\\mathcal{Z}^{-1}\\{1\\}= \\delta[n]$ 和 $\\mathcal{Z}^{-1}\\left\\{\\frac{z^{-1}}{1-az^{-1}}\\right\\}=a^{n-1}u[n-1]$，冲激响应为\n$$\ny[n]=\\delta[n]+(p'-p'')\\,p'^{\\,n-1}u[n-1].\n$$\n因此，对于 $n\\geq 1$ 的拖尾是 $y[n]=(p'-p'')\\,p'^{\\,n-1}$。其能量为几何级数\n$$\nE_{\\text{tail}}=\\sum_{n=1}^{\\infty}|y[n]|^{2}=(p'-p'')^{2}\\sum_{n=1}^{\\infty}(p'^{2})^{n-1}=\\frac{(p'-p'')^{2}}{1-p'^{2}},\n$$\n该级数在 $|p'|<1$ 时收敛，此条件在此处得到满足。\n\n代入受扰动的系数 $p'=p(1+\\epsilon_{p})$ 和 $p''=p(1+\\epsilon_{z})$：\n$$\np'-p''=p\\bigl(\\epsilon_{p}-\\epsilon_{z}\\bigr),\\qquad p'^{2}=p^{2}(1+\\epsilon_{p})^{2}=p^{2}\\bigl(1+2\\epsilon_{p}+\\epsilon_{p}^{2}\\bigr).\n$$\n因此，\n$$\nE_{\\text{tail}}=\\frac{p^{2}\\bigl(\\epsilon_{p}-\\epsilon_{z}\\bigr)^{2}}{1-p^{2}\\bigl(1+2\\epsilon_{p}+\\epsilon_{p}^{2}\\bigr)}.\n$$\n为了获得在微小误差上精确到二阶的表达式，注意到分子已经是二阶的，而分母可以围绕其零阶部分 $1-p^{2}$ 进行展开。写作 $1-p'^{2}=(1-p^{2})-\\bigl(2p^{2}\\epsilon_{p}+p^{2}\\epsilon_{p}^{2}\\bigr)$，当与二阶的分子相乘时，其倒数展开仅引入三阶及更高阶的修正项。因此，保留至二阶项可得\n$$\nE_{\\text{tail}}=\\frac{p^{2}}{1-p^{2}}\\bigl(\\epsilon_{p}-\\epsilon_{z}\\bigr)^{2}+O\\bigl(\\epsilon^{3}\\bigr),\n$$\n即，\n$$\nE_{\\text{tail}}\\approx \\frac{p^{2}}{1-p^{2}}\\left(\\epsilon_{p}^{2}-2\\epsilon_{p}\\epsilon_{z}+\\epsilon_{z}^{2}\\right),\n$$\n该表达式包含了所有与 $\\epsilon_{p}^{2}$、$\\epsilon_{p}\\epsilon_{z}$ 和 $\\epsilon_{z}^{2}$ 成正比的项，并忽略了更高阶的项。", "answer": "$$\\boxed{\\frac{p^{2}}{1-p^{2}}\\left(\\epsilon_{p}-\\epsilon_{z}\\right)^{2}}$$", "id": "1747721"}]}