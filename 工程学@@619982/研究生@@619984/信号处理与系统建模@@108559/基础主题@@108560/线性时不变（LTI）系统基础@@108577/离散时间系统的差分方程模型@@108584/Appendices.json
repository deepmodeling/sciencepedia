{"hands_on_practices": [{"introduction": "差分方程的核心在于其迭代本质，它描述了输出如何依赖于过去的输入和输出。本练习提供了一个直接的机会，让您通过逐步递归计算来确定一个系统的响应。这个基础练习对于掌握如何从差分方程模型中预测系统行为至关重要 [@problem_id:2865576]。", "problem": "一个因果线性时不变 (LTI) 离散时间系统由一个线性常系数差分方程 (LCCDE) 建模，该方程将其输出 $y[n]$ 与其输入 $x[n]$ 以及这两个序列的过去值联系起来。考虑一个对所有整数 $n$ 都由以下方程描述的系统：\n$$\ny[n] - 0.3\\,y[n-1] + 0.2\\,y[n-2] = x[n] + 0.5\\,x[n-1].\n$$\n假设初始输出采样值为 $y[-1]=1$ 和 $y[-2]=0$，并且输入是一个缩放的离散时间单位冲激 $x[n] = 2\\,\\delta[n]$，因此 $x[0]=2$ 且对于 $k\\neq 0$ 有 $x[k]=0$（特别是，$x[-1]=0$ 且对于 $n<0$ 有 $x[n]=0$）。仅使用 LCCDE、这些初始条件和给定的输入，计算 $y[0]$、$y[1]$ 和 $y[2]$。不需要四舍五入；请报告精确的小数值。将您的最终答案表示为有序三元组 $(y[0], y[1], y[2])$。", "solution": "在尝试进行任何解答之前，将首先验证问题的正确性。\n\n### 步骤 1：提取已知条件\n- 该系统是一个因果线性时不变 (LTI) 离散时间系统。\n- 该系统的线性常系数差分方程 (LCCDE) 是：$$y[n] - 0.3\\,y[n-1] + 0.2\\,y[n-2] = x[n] + 0.5\\,x[n-1]$$\n- 初始条件为：$$y[-1]=1$$ 和 $$y[-2]=0$$。\n- 输入信号是一个缩放的离散时间单位冲激：$$x[n] = 2\\,\\delta[n]$$。这意味着 $$x[0]=2$$ 且对于所有整数 $$k \\neq 0$$ 都有 $$x[k]=0$$。具体来说，对于所需的计算，我们注意到 $$x[-1]=0$$，$x[1]=0$ 和 $$x[2]=0$$。\n- 任务是计算输出采样值 $$y[0]$$、$y[1]$$ 和 $$y[2]$$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，因为它涉及一个标准的线性常系数差分方程，这是离散时间信号处理和系统理论中的一个基本模型。该问题是适定的；它提供了一个特定的差分方程，一个明确定义的输入信号，以及为递归计算 $$n \\ge 0$$ 时的输出所需的一整套完整的初始条件。问题陈述客观，并使用了精确、无歧义的术语。完成指定任务所需的所有数据均已提供，且不存在矛盾。要求仅使用 LCCDE 和初始条件进行递归计算是解决此类问题的标准且有效的方法。在 $$n<0$$ 时输入为零而初始条件非零这一事实，仅表示系统在施加冲激之前并非处于静止状态，这是一个完全有效的物理场景。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。将提供解答。\n\n解答需要直接、递归地应用给定的差分方程。首先，我们重新整理 LCCDE，将当前输出采样值 $$y[n]$$ 表示为过去的输出采样值以及当前和过去的输入采样值的函数。\n$$\ny[n] = 0.3\\,y[n-1] - 0.2\\,y[n-2] + x[n] + 0.5\\,x[n-1]\n$$\n这个方程将用于计算 $$n=0, 1, 2$$ 时所需的输出采样值。\n\n**计算 $n=0$ 的情况**：\n我们将 $$n=0$$ 代入整理后的方程：\n$$\ny[0] = 0.3\\,y[-1] - 0.2\\,y[-2] + x[0] + 0.5\\,x[-1]\n$$\n问题提供了必要的值：$$y[-1]=1$$, $$y[-2]=0$$, $$x[0]=2$$, 以及 $$x[-1]=0$$。代入这些值可得：\n$$\ny[0] = 0.3(1) - 0.2(0) + 2 + 0.5(0)\n$$\n$$\ny[0] = 0.3 - 0 + 2 + 0 = 2.3\n$$\n\n**计算 $n=1$ 的情况**：\n我们将 $$n=1$$ 代入整理后的方程：\n$$\ny[1] = 0.3\\,y[0] - 0.2\\,y[-1] + x[1] + 0.5\\,x[0]\n$$\n我们使用刚计算出的 $$y[0]$$ 的值，以及给定的初始条件和输入定义。所需的值为：$$y[0]=2.3$$, $$y[-1]=1$$, $$x[1]=0$$, 以及 $$x[0]=2$$。代入这些值可得：\n$$\ny[1] = 0.3(2.3) - 0.2(1) + 0 + 0.5(2)\n$$\n$$\ny[1] = 0.69 - 0.2 + 1 = 1.49\n$$\n\n**计算 $n=2$ 的情况**：\n我们将 $$n=2$$ 代入整理后的方程：\n$$\ny[2] = 0.3\\,y[1] - 0.2\\,y[0] + x[2] + 0.5\\,x[1]\n$$\n我们使用之前计算出的 $$y[1]$$ 和 $$y[0]$$ 的值。所需的值为：$$y[1]=1.49$$, $$y[0]=2.3$$, $$x[2]=0$$, 以及 $$x[1]=0$$。代入这些值可得：\n$$\ny[2] = 0.3(1.49) - 0.2(2.3) + 0 + 0.5(0)\n$$\n$$\ny[2] = 0.447 - 0.46 = -0.013\n$$\n\n计算出的输出采样值为 $$y[0]=2.3$$, $$y[1]=1.49$$, 和 $$y[2]=-0.013$$。问题要求将答案表示为有序三元组 $$(y[0], y[1], y[2])$$.", "answer": "$$\\boxed{(2.3, 1.49, -0.013)}$$", "id": "2865576"}, {"introduction": "超越计算特定输出，理解系统的固有行为至关重要。本练习着重于求解齐次方程，其解（即系统的“模态”）决定了系统在没有外部输入时的自然响应。通过分析特征根，您将学会如何判断一个系统的稳定性——这是任何可靠系统设计的先决条件 [@problem_id:2865609]。", "problem": "考虑一个线性的、时不变的、常系数的齐次差分方程\n$$\ny[n]-1.2\\,y[n-1]+0.36\\,y[n-2]=0.\n$$\n从线性时不变离散时间系统的指数序列本征函数性质出发，通过求解相关的特征方程，并从第一性原理出发仔细处理任何根的重数，推导出通用的齐次解。然后，利用特征根相对于单位圆的位置来判断系统的渐近稳定性和有界输入有界输出 (BIBO) 稳定性，并通过将模态行为与脉冲响应的绝对可和性联系起来，来证明你的结论。最后，将谱半径 $\\rho$ 定义为所有特征根中的最大模，并精确计算 $\\rho$。将 $\\rho$ 作为最终答案报告，不进行四舍五入，也不带单位。", "solution": "该问题陈述具有科学依据，提法恰当，客观且自成体系。这是线性时不变（LTI）离散时间系统分析中的一个标准问题，没有任何使其无效的缺陷。我们可以开始求解。\n\n对线性、时不变、常系数的齐次差分方程的分析始于 LTI 系统的本征函数性质。对于一个离散时间 LTI 系统，形式为 $z^n$ 的指数序列是一个本征函数，这意味着系统对此输入的响应是同一序列乘以一个复数常数，即本征值，该本征值是 $z$ 的函数。齐次解代表了系统的自然模态，这些模态是在零输入情况下系统中可以存在的序列。这些模态正是被系统算子湮没的本征函数。\n\n我们假设解的形式为 $y[n] = A z^n$，其中 $A$ 和 $z$ 是常数。将此代入给定的差分方程：\n$$\n(A z^n) - 1.2 (A z^{n-1}) + 0.36 (A z^{n-2}) = 0\n$$\n对于一个非平凡解，我们要求 $A \\neq 0$。我们可以提出公因式 $A z^{n-2}$：\n$$\nA z^{n-2} (z^2 - 1.2 z + 0.36) = 0\n$$\n由于在一个非平凡解中 $A z^{n-2}$ 不能对所有 $n$ 都为零，所以括号中的项必须为零。这给出了系统的特征方程：\n$$\nz^2 - 1.2 z + 0.36 = 0\n$$\n我们求解这个二次方程以得到其根 $z$。通过识别这是一个完全平方，该方程可以改写为：\n$$\nz^2 - 2(0.6)z + (0.6)^2 = 0\n$$\n$$\n(z - 0.6)^2 = 0\n$$\n该方程在 $z_1 = z_2 = 0.6$ 处有一个重数为2的重根。\n\n当一个特征方程有重根，比如 $p$ 时，形式为 $c_1 p^n$ 的解是系统的一个模态。然而，一个二阶系统必须有两个线性无关的模态。第二个模态不仅仅是 $c_2 p^n$。为了从第一性原理推导出第二个解的形式，我们定义与该差分方程对应的 LTI 算子 $L$：\n$$\nL\\{y[n]\\} = y[n] - 1.2 y[n-1] + 0.36 y[n-2]\n$$\n特征多项式是 $P(z) = z^2 - 1.2 z + 0.36 = (z - 0.6)^2$。将算子 $L$ 应用于本征函数 $z^n$ 得到：\n$$\nL\\{z^n\\} = z^n - 1.2 z^{n-1} + 0.36 z^{n-2} = z^{n-2}P(z)\n$$\n我们知道，对于 $P(z)$ 的一个根 $p$，我们有 $L\\{p^n\\} = p^{n-2}P(p) = 0$。对于一个重根，不仅 $P(p) = 0$，而且多项式的一阶导数在该根处也为零：$P'(p) = 0$。让我们对关系式 $L\\{z^n\\} = z^{n-2}P(z)$ 关于 $z$ 求导：\n$$\n\\frac{\\partial}{\\partial z} L\\{z^n\\} = \\frac{\\partial}{\\partial z} [z^{n-2}P(z)]\n$$\n由于算子 $L$ 是常系数线性的，我们可以交换算子和求导运算：\n$$\nL\\left\\{\\frac{\\partial}{\\partial z} z^n\\right\\} = (n-2)z^{n-3}P(z) + z^{n-2}P'(z)\n$$\n$$\nL\\{n z^{n-1}\\} = (n-2)z^{n-3}P(z) + z^{n-2}P'(z)\n$$\n现在，我们在重根 $z = p = 0.6$ 处计算这个表达式的值。由于 $P(0.6) = 0$ 且 $P'(z) = 2(z-0.6)$，这意味着 $P'(0.6) = 0$，所以整个右边都变为零：\n$$\nL\\{n (0.6)^{n-1}\\} = 0\n$$\n根据线性性质，$n(0.6)^{n-1}$ 的任何常数倍也是一个解。乘以常数 $0.6$，我们发现 $L\\{n (0.6)^n\\} = 0$。因此，序列 $n(0.6)^n$ 是第二个线性无关的解。\n\n通用齐次解是这两个独立模态的线性组合：\n$$\ny_h[n] = c_1 (0.6)^n + c_2 n(0.6)^n\n$$\n其中 $c_1$ 和 $c_2$ 是由初始条件决定的任意常数。\n\n接下来，我们对系统的稳定性进行分类。\n渐近稳定性关注的是当 $n \\to \\infty$ 时零输入响应的行为。系统是渐近稳定的，当且仅当所有特征根的模都严格小于1，即对所有 $k$ 都有 $|z_k| < 1$。根是 $z_1 = z_2 = 0.6$。其模为 $|0.6| = 0.6$，小于1。因此，该系统是渐近稳定的。模态 $(0.6)^n$ 和 $n(0.6)^n$ 在 $n \\to \\infty$ 时都衰减到零。$(0.6)^n$ 的指数衰减速度快于 $n$ 的线性增长，确保了 $\\lim_{n \\to \\infty} n(0.6)^n = 0$。\n\n有界输入有界输出 (BIBO) 稳定性要求对于任何有界输入，输出也是有界的。对于 LTI 系统，这等价于脉冲响应 $h[n]$ 是绝对可和的条件：$\\sum_{n=-\\infty}^{\\infty} |h[n]| < \\infty$。假设系统是因果的，脉冲响应对于 $n \\ge 0$ 的形式与齐次解相同，因此 $h[n] = (k_1(0.6)^n + k_2 n(0.6)^n) u[n]$，其中 $u[n]$ 是单位阶跃函数，$k_1, k_2$ 是特定的常数。我们检验其绝对可和性：\n$$\n\\sum_{n=0}^{\\infty} |h[n]| = \\sum_{n=0}^{\\infty} |k_1(0.6)^n + k_2 n(0.6)^n| \\le |k_1| \\sum_{n=0}^{\\infty} (0.6)^n + |k_2| \\sum_{n=0}^{\\infty} n(0.6)^n\n$$\n第一个和是公比为 $r=0.6$ 的几何级数。由于 $|r|<1$，它收敛于 $1/(1-0.6) = 2.5$。第二个和是一个算术-几何级数。其收敛性可以通过对其项 $a_n = n(0.6)^n$ 进行比值判别法来确认：\n$$\n\\lim_{n \\to \\infty} \\left| \\frac{a_{n+1}}{a_n} \\right| = \\lim_{n \\to \\infty} \\left| \\frac{(n+1)(0.6)^{n+1}}{n(0.6)^n} \\right| = \\lim_{n \\to \\infty} \\left( \\frac{n+1}{n} \\right) 0.6 = (1) \\cdot 0.6 = 0.6\n$$\n由于极限 $0.6$ 小于 $1$，级数 $\\sum n(0.6)^n$ 收敛。由于两个和都收敛，脉冲响应 $h[n]$ 是绝对可和的。因此，系统是 BIBO 稳定的。特征根严格位于单位圆内这一事实，同时保证了此 LTI 系统的渐近稳定性和 BIBO 稳定性。\n\n最后，谱半径 $\\rho$ 定义为所有特征根中的最大模。对于该系统，根是 $z_1 = 0.6$ 和 $z_2 = 0.6$。它们的模为 $|z_1|=|0.6|=0.6$ 和 $|z_2|=|0.6|=0.6$。\n这些模的最大值是：\n$$\n\\rho = \\max(|z_1|, |z_2|) = \\max(0.6, 0.6) = 0.6\n$$\n渐近稳定性和 BIBO 稳定性的条件可以简明地表述为 $\\rho < 1$，在本例中此条件得到满足。", "answer": "$$\n\\boxed{0.6}\n$$", "id": "2865609"}, {"introduction": "理论上的稳定性与实际工程实现之间存在着一道鸿沟，本练习旨在帮助您跨越它。我们将探讨在数字滤波器中，由于使用有限精度的数字表示，系数的量化误差如何可能破坏系统的稳定性。通过这项实践，您将学会计算保证一个稳定设计在现实世界硬件中依然可靠运行所需的最小字长，这体现了理论分析在解决实际工程挑战中的力量 [@problem_id:2865561]。", "problem": "考虑一个用于级联实现的二阶无限冲激响应 (IIR) 单节。其分母通过在 $z$ 平面上半径为 $r_{0}$、幅角为 $\\theta_{0}$ 处放置一对共轭复数极点来指定，因此以正向移位变量 $z$ 表示的首一分母多项式为\n$$\nz^{2} + a_{1} z + a_{2},\n$$\n其中\n$$\na_{1} = -2 r_{0} \\cos(\\theta_{0}), \\quad a_{2} = r_{0}^{2}.\n$$\n该节的差分方程模型具有此首一分母和一个任意的稳定分子（分子不影响极点位置）。设 $r_{0} = 0.995$ 且 $\\theta_{0} = 0.05$ 弧度。\n\n系数 $a_{1}$ 和 $a_{2}$ 以二的补码定点数形式实现，总字长为 $W$ 位，包括一个符号位、$I$ 个整数位和 $F$ 个小数位。使用最近邻取整，因此量化步长为 $q = 2^{-F}$，每个实现的系数等于其精确值加上一个幅值以 $q/2$ 为界的加性误差。整数位的数量 $I$ 应选择为能使精确系数 $a_{1}$ 和 $a_{2}$ 都处于可表示范围内的最小值。\n\n从离散时间线性时不变系统的有界输入有界输出 (BIBO) 稳定性（所有极点严格位于单位圆内）的定义出发，并仅使用关于二阶 Schur 稳定性的、表示为多项式系数不等式的根位置基本结果，推导关于 $q$ 的条件，以保证对于与舍入界限一致的任何系数量化误差选择，系统都保持稳定。然后，计算能确保该节在所有由步长为 $q = 2^{-F}$ 的最近邻取整产生的系数量化下保持稳定的最小总字长 $W$。\n\n请以最小整数 $W$ 的形式提供您的最终答案。除了确定最小整数 $W$ 之外，不需要进行其他舍入。角度以弧度为单位，没有需要报告的物理单位。", "solution": "该问题陈述已经过验证，被认为是具有科学依据、适定且客观的。这是数字滤波器量化效应分析中的一个标准问题，包含了获得唯一解所需的所有信息。我们可以开始解题。\n\n离散时间线性时不变 (LTI) 系统的有界输入有界输出 (BIBO) 稳定性要求其传递函数的所有极点都严格位于 $z$ 平面的单位圆内。对于分母多项式为 $D(z) = z^2 + a_1 z + a_2$ 的二阶系统，可以使用 Jury 稳定性判据来检验此条件。对于二次首一多项式 $D(z) = z^2 + \\hat{a}_1 z + \\hat{a}_2$，其中 $\\hat{a}_1$ 和 $\\hat{a}_2$ 是实现的、量化后的系数，Jury 条件简化为以下三个不等式：\n$$\n\\begin{cases}\nD(1) > 0 \\\\\nD(-1) > 0 \\\\\n|\\hat{a}_2| < 1\n\\end{cases}\n\\implies\n\\begin{cases}\n1 + \\hat{a}_1 + \\hat{a}_2 > 0 \\\\\n1 - \\hat{a}_1 + \\hat{a}_2 > 0 \\\\\n-1 < \\hat{a}_2 < 1\n\\end{cases}\n$$\n这些不等式在 $(\\hat{a}_1, \\hat{a}_2)$ 系数平面上定义了众所周知的“稳定三角形”。\n\n首先，我们使用给定的参数 $r_0 = 0.995$ 和 $\\theta_0 = 0.05$ 弧度，计算系数 $a_1$ 和 $a_2$ 的精确值。\n$$\na_1 = -2 r_0 \\cos(\\theta_0) = -2 (0.995) \\cos(0.05) = -1.99 \\cos(0.05)\n$$\n$$\na_2 = r_0^2 = (0.995)^2 = 0.990025\n$$\n数值上，$a_1 \\approx -1.9875129$。精确系数 $(a_1, a_2)$ 对应于 $r_0 e^{\\pm j \\theta_0}$ 处的极点，并且由于 $r_0=0.995 < 1$，原始未量化的系统是稳定的。\n\n接下来，我们必须确定整数位的最小数量 $I$。系数以二的补码格式表示，有 $1$ 个符号位、$I$ 个整数位和 $F$ 个小数位。这种数的表示范围是 $[-2^I, 2^I - 2^{-F}]$。为了表示精确系数 $a_1$ 和 $a_2$，这个范围必须包含它们。具体而言，我们需要满足 $2^I > |a_k|$ 对 $k=1,2$ 成立。\n我们有 $|a_2| = 0.990025 < 1$ 和 $|a_1| = 1.99 \\cos(0.05) \\approx 1.9875$。\n条件 $2^I > \\max(|a_1|, |a_2|) \\approx 1.9875$ 必须被满足。\n如果 $I=0$，则 $2^0=1$，不大于 $1.9875$。\n如果 $I=1$，则 $2^1=2$，大于 $1.9875$。\n因此，整数位的最小数量是 $I=1$。\n\n系数通过最近邻取整进行量化，量化步长为 $q = 2^{-F}$。量化后的系数 $\\hat{a}_k$ 与精确系数 $a_k$ 的关系为 $\\hat{a}_k = a_k + \\Delta a_k$，其中量化误差 $\\Delta a_k$ 的界限为 $|\\Delta a_k| \\le q/2$。\n为了保证对每一种可能的量化误差都稳定，稳定性条件必须对由 $(a_1 \\pm q/2, a_2 \\pm q/2)$ 定义的不确定性矩形内的所有可能的 $(\\hat{a}_1, \\hat{a}_2)$ 值都成立。我们必须在最坏情况误差条件下分析这些稳定性不等式。\n\n1. 条件 $\\hat{a}_2 < 1$:\n为确保此条件，我们必须有 $a_2 + \\Delta a_2 < 1$。最坏情况是当 $\\Delta a_2$ 取最大值时，即 $\\Delta a_2 = q/2$。\n$a_2 + q/2 < 1 \\implies q < 2(1 - a_2)$\n\n2. 条件 $\\hat{a}_2 > -1$:\n为确保此条件，我们必须有 $a_2 + \\Delta a_2 > -1$。最坏情况是当 $\\Delta a_2$ 取最小值时，即 $\\Delta a_2 = -q/2$。\n$a_2 - q/2 > -1 \\implies q < 2(1 + a_2)$\n\n3. 条件 $1 + \\hat{a}_1 + \\hat{a}_2 > 0$:\n我们要求 $1 + (a_1 + \\Delta a_1) + (a_2 + \\Delta a_2) > 0$。最坏情况是使左侧最小化，这发生在 $\\Delta a_1 = -q/2$ 和 $\\Delta a_2 = -q/2$ 时。\n$1 + a_1 - q/2 + a_2 - q/2 > 0 \\implies 1 + a_1 + a_2 - q > 0 \\implies q < 1 + a_1 + a_2$\n\n4. 条件 $1 - \\hat{a}_1 + \\hat{a}_2 > 0$:\n我们要求 $1 - (a_1 + \\Delta a_1) + (a_2 + \\Delta a_2) > 0$。最坏情况是使左侧最小化，这发生在 $\\Delta a_1 = +q/2$ 和 $\\Delta a_2 = -q/2$ 时。\n$1 - (a_1 + q/2) + (a_2 - q/2) > 0 \\implies 1 - a_1 + a_2 - q > 0 \\implies q < 1 - a_1 + a_2$\n\n为保证稳定性，$q$ 必须小于这四个上界中的最小值：\n$$q < \\min \\left( 2(1-a_2), 2(1+a_2), 1+a_1+a_2, 1-a_1+a_2 \\right)$$\n我们现在计算这些界限：\n\\begin{itemize}\n    \\item $2(1-a_2) = 2(1 - 0.990025) = 2(0.009975) = 0.01995$\n    \\item $2(1+a_2) = 2(1 + 0.990025) = 2(1.990025) = 3.98005$\n    \\item $1+a_1+a_2 = 1 - 1.99 \\cos(0.05) + 0.990025 = 1.990025 - 1.99 \\cos(0.05) \\approx 0.00251208$\n    \\item $1-a_1+a_2 = 1 - (-1.99 \\cos(0.05)) + 0.990025 = 1.990025 + 1.99 \\cos(0.05) \\approx 3.9775379$\n\\end{itemize}\n这些值中的最小值是 $1.990025 - 1.99 \\cos(0.05)$。因此，对量化步长最严格的条件是：\n$$q < 1.990025 - 1.99 \\cos(0.05) \\approx 0.00251208$$\n我们有 $q = 2^{-F}$，因此我们必须找到满足以下条件的最小整数 $F$：\n$$2^{-F} < 0.00251208$$\n对两边取以 2 为底的对数：\n$$-F < \\log_2(0.00251208)$$\n$$-F < -8.63668$$\n$$F > 8.63668$$\n由于 $F$ 必须是整数，所以小数位的最小数量是 $F=9$。\n\n总字长 $W$ 是符号位、整数位和小数位的数量之和：\n$$W = 1 + I + F$$\n代入我们找到的 $I$ 和 $F$ 的最小值：\n$$W = 1 + 1 + 9 = 11$$\n因此，保证稳定性的最小总字长是 $11$ 位。", "answer": "$$\\boxed{11}$$", "id": "2865561"}]}