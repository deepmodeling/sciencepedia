{"hands_on_practices": [{"introduction": "我们从最基础的波束形成技术——巴特利特（即延时求和）波束形成器——开始我们的实践之旅。这项练习旨在将阵列信号处理的核心理论，如导向矢量和无失真响应约束，转化为一个可执行的程序。通过亲手实现并评估其在存在干扰情况下的性能，您将对空间滤波的基本原理以及如信干噪比（SINR）等关键性能指标建立牢固的直观理解。[@problem_id:2853623]", "problem": "考虑一个窄带平面波信号模型，该信号以时间频率 $f_0$ 入射到具有 $M$ 个传感器、阵元间距为 $d$、传播速度为 $c$ 的均匀线性阵列 (ULA) 上。令波数为 $k = \\frac{2\\pi}{\\lambda}$，其中 $\\lambda = \\frac{c}{f_0}$。定义方位角（从阵列法线方向算起，以度为单位）$\\theta$ 对应的阵列导向矢量为\n$$\n\\mathbf{a}(\\theta) = \\begin{bmatrix}\n1 & e^{-j k d \\sin(\\theta\\,\\pi/180)} & \\cdots & e^{-j k d (M-1) \\sin(\\theta\\,\\pi/180)}\n\\end{bmatrix}^{\\mathsf{T}} \\in \\mathbb{C}^{M}.\n$$\n假设一个窄带阵列数据模型为\n$$\n\\mathbf{x} = \\mathbf{a}(\\theta_0)\\, s + \\mathbf{a}(\\theta_i)\\, u + \\mathbf{n},\n$$\n其中 $s$ 和 $u$ 分别是功率为 $\\sigma_s^2$ 和 $\\sigma_u^2$ 的零均值、圆对称复高斯随机变量，$\\mathbf{n} \\sim \\mathcal{CN}(\\mathbf{0}, \\sigma_n^2 \\mathbf{I}_M)$ 是功率为 $\\sigma_n^2$ 的空间和时间白噪声。角度单位为度，三角函数内部使用弧度。\n\n您需要为期望的观测方向 $\\theta_0$ 实现 Bartlett（常规延迟求和）波束形成器，方法是构建一个权矢量 $\\mathbf{w}$，该权矢量对 $\\theta_0$ 方向强制实现无失真响应，即 $\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0) = 1$。从窄带平面波模型和无失真约束出发，并且仅使用这些基本原理来构建 $\\mathbf{w}$。\n\n将波束形成器的输出信干噪比 (SINR) 定义为\n$$\n\\mathrm{SINR}_{\\text{out}} = \\frac{\\text{output signal power}}{\\text{output interference power} + \\text{output noise power}},\n$$\n该值由 $s, u, \\mathbf{n}$ 的二阶矩和线性形式 $y = \\mathbf{w}^{\\mathsf{H}} \\mathbf{x}$ 直接计算得出。同时，将干扰衰减（单位为分贝 dB）定义为波束形成器在干扰方向上的功率增益的负值，\n$$\nA_i \\text{ (dB)} = -10 \\log_{10}\\!\\left(\\left|\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_i)\\right|^2\\right).\n$$\n报告以分贝 (dB) 为单位的 $\\mathrm{SINR}_{\\text{out}}$ 和以分贝 (dB) 为单位的 $A_i$。角度以度为单位。所有对数均以 10 为底。将所有报告的数字四舍五入到恰好四位小数。\n\n实现一个程序，对下面的每个测试用例，按顺序计算并输出数对 $\\left[\\mathrm{SINR}_{\\text{out}}\\ \\text{(dB)},\\ A_i\\ \\text{(dB)}\\right]$。将所有用例的所有结果聚合到一个单一的扁平列表中，并按照最终输出格式的要求打印在一行上。\n\n对每个测试用例，都使用半波长阵元间距 $d = \\lambda/2$。\n\n测试套件（角度单位为度；$c$ 单位为米/秒；$f_0$ 单位为赫兹；功率单位为线性单位）：\n- 用例 1：$M=8$, $f_0=1500$, $c=1500$, $\\theta_0=20$, $\\theta_i=-30$, $\\sigma_s^2=1.0$, $\\sigma_u^2=10.0$, $\\sigma_n^2=1.0$。\n- 用例 2：$M=8$, $f_0=1500$, $c=1500$, $\\theta_0=10$, $\\theta_i=10$, $\\sigma_s^2=1.0$, $\\sigma_u^2=1.0$, $\\sigma_n^2=1.0$。\n- 用例 3：$M=1$, $f_0=1500$, $c=1500$, $\\theta_0=0$, $\\theta_i=30$, $\\sigma_s^2=2.0$, $\\sigma_u^2=3.0$, $\\sigma_n^2=4.0$。\n- 用例 4：$M=16$, $f_0=3000$, $c=1500$, $\\theta_0=0$, $\\theta_i=60$, $\\sigma_s^2=1.0$, $\\sigma_u^2=100.0$, $\\sigma_n^2=1.0$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的数字列表，该列表是按给定顺序将各用例的数对扁平化后得到的。即，输出必须是如下形式\n$[\\mathrm{SINR}_{1},A_{i,1},\\mathrm{SINR}_{2},A_{i,2},\\mathrm{SINR}_{3},A_{i,3},\\mathrm{SINR}_{4},A_{i,4}]$，\n其中每个数字都四舍五入到恰好四位小数，并以分贝 (dB) 表示。", "solution": "该问题要求针对均匀线性阵列 (ULA) 推导并实现一个 Bartlett 波束形成器，并计算其性能，具体包括输出信干噪比（$\\mathrm{SINR}_{\\text{out}}$）和干扰衰减（$A_i$）。分析将基于所提供的窄带平面波信号模型。\n\n首先，我们推导 Bartlett 波束形成器的权矢量 $\\mathbf{w} \\in \\mathbb{C}^{M}$。Bartlett 波束形成器旨在在特定约束条件下，在期望的观测方向 $\\theta_0$ 上具有最大响应。问题指定了该方向上的无失真响应约束，其公式为 $\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0) = 1$。常规的（或 Bartlett）波束形成器可以通过在空间白噪声存在的情况下，最大化来自期望方向 $\\theta_0$ 的信号在输出端的信噪比 (SNR) 来推导得出。\n\n来自方向 $\\theta_0$ 的阵列数据的信号分量为 $\\mathbf{x}_s = \\mathbf{a}(\\theta_0)s$。该信号的波束形成器输出为 $y_s = \\mathbf{w}^{\\mathsf{H}} \\mathbf{x}_s = \\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0)s$。输出信号功率为 $P_s^{\\text{out}} = E[|y_s|^2] = |\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0)|^2 E[|s|^2] = |\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0)|^2 \\sigma_s^2$。噪声分量为 $\\mathbf{n} \\sim \\mathcal{CN}(\\mathbf{0}, \\sigma_n^2 \\mathbf{I}_M)$，相应的输出噪声为 $y_n = \\mathbf{w}^{\\mathsf{H}} \\mathbf{n}$。输出噪声功率为 $P_n^{\\text{out}} = E[|y_n|^2] = E[\\mathbf{w}^{\\mathsf{H}} \\mathbf{n} \\mathbf{n}^{\\mathsf{H}} \\mathbf{w}] = \\mathbf{w}^{\\mathsf{H}} E[\\mathbf{n} \\mathbf{n}^{\\mathsf{H}}] \\mathbf{w} = \\mathbf{w}^{\\mathsf{H}} (\\sigma_n^2 \\mathbf{I}_M) \\mathbf{w} = \\sigma_n^2 \\|\\mathbf{w}\\|_2^2$。\n\n因此，输出信噪比为 $\\mathrm{SNR} = \\frac{P_s^{\\text{out}}}{P_n^{\\text{out}}} = \\frac{|\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0)|^2 \\sigma_s^2}{\\sigma_n^2 \\|\\mathbf{w}\\|_2^2}$。为了最大化此信噪比，我们必须最大化 $\\frac{|\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0)|}{\\|\\mathbf{w}\\|_2}$ 这一项。根据 Cauchy-Schwarz 不等式，有 $|\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0)| \\leq \\|\\mathbf{w}\\|_2 \\|\\mathbf{a}(\\theta_0)\\|_2$。当 $\\mathbf{w}$ 与 $\\mathbf{a}(\\theta_0)$ 共线时，即对于某个标量 $\\alpha$，$\\mathbf{w} = \\alpha \\mathbf{a}(\\theta_0)$ 时，达到最大值。\n\n我们应用无失真响应约束 $\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0) = 1$ 来确定 $\\alpha$。\n$$ (\\alpha \\mathbf{a}(\\theta_0))^{\\mathsf{H}} \\mathbf{a}(\\theta_0) = \\bar{\\alpha} \\mathbf{a}(\\theta_0)^{\\mathsf{H}} \\mathbf{a}(\\theta_0) = \\bar{\\alpha} \\|\\mathbf{a}(\\theta_0)\\|_2^2 = 1 $$\n导向矢量的元素为 $a_m(\\theta_0) = e^{-j k d (m-1) \\sin(\\theta_0\\pi/180)}$，其模为 1。因此，$\\|\\mathbf{a}(\\theta_0)\\|_2^2 = \\sum_{m=0}^{M-1} |a_m(\\theta_0)|^2 = \\sum_{m=0}^{M-1} 1 = M$。\n这得出 $\\bar{\\alpha} M = 1$，所以 $\\alpha = 1/M$。因此，Bartlett 权矢量为：\n$$ \\mathbf{w} = \\frac{1}{M} \\mathbf{a}(\\theta_0) $$\n\n接下来，我们计算输出 SINR。波束形成器的输出是 $y = \\mathbf{w}^{\\mathsf{H}}\\mathbf{x}$。给定数据模型 $\\mathbf{x} = \\mathbf{a}(\\theta_0)s + \\mathbf{a}(\\theta_i)u + \\mathbf{n}$，输出为：\n$$ y = \\mathbf{w}^{\\mathsf{H}}(\\mathbf{a}(\\theta_0)s + \\mathbf{a}(\\theta_i)u + \\mathbf{n}) = (\\mathbf{w}^{\\mathsf{H}}\\mathbf{a}(\\theta_0))s + (\\mathbf{w}^{\\mathsf{H}}\\mathbf{a}(\\theta_i))u + \\mathbf{w}^{\\mathsf{H}}\\mathbf{n} $$\n由于 $s$、$u$ 和 $\\mathbf{n}$ 是零均值且不相关的，总输出功率是信号、干扰和噪声分量功率之和。\n使用无失真约束，输出信号功率为 $P_s^{\\text{out}} = |\\mathbf{w}^{\\mathsf{H}}\\mathbf{a}(\\theta_0)|^2 \\sigma_s^2 = 1^2 \\cdot \\sigma_s^2 = \\sigma_s^2$。\n输出干扰功率为 $P_u^{\\text{out}} = |\\mathbf{w}^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2 \\sigma_u^2$。\n输出噪声功率为 $P_n^{\\text{out}} = \\sigma_n^2 \\|\\mathbf{w}\\|_2^2$。代入 $\\mathbf{w} = \\frac{1}{M}\\mathbf{a}(\\theta_0)$，我们得到 $P_n^{\\text{out}} = \\sigma_n^2 \\|\\frac{1}{M}\\mathbf{a}(\\theta_0)\\|_2^2 = \\frac{\\sigma_n^2}{M^2}\\|\\mathbf{a}(\\theta_0)\\|_2^2 = \\frac{\\sigma_n^2}{M^2}M = \\frac{\\sigma_n^2}{M}$。\n\n输出 SINR 定义为 $\\mathrm{SINR}_{\\text{out}} = \\frac{P_s^{\\text{out}}}{P_u^{\\text{out}} + P_n^{\\text{out}}}$。代入推导出的各项：\n$$ \\mathrm{SINR}_{\\text{out}} = \\frac{\\sigma_s^2}{|\\mathbf{w}^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2 \\sigma_u^2 + \\frac{\\sigma_n^2}{M}} $$\n代入 $\\mathbf{w} = \\frac{1}{M}\\mathbf{a}(\\theta_0)$：\n$$ |\\mathbf{w}^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2 = \\left|\\left(\\frac{1}{M}\\mathbf{a}(\\theta_0)\\right)^{\\mathsf{H}}\\mathbf{a}(\\theta_i)\\right|^2 = \\frac{1}{M^2}|\\mathbf{a}(\\theta_0)^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2 $$\n所以，SINR 表达式变为：\n$$ \\mathrm{SINR}_{\\text{out}} = \\frac{\\sigma_s^2}{\\frac{\\sigma_u^2}{M^2}|\\mathbf{a}(\\theta_0)^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2 + \\frac{\\sigma_n^2}{M}} = \\frac{M^2 \\sigma_s^2}{\\sigma_u^2 |\\mathbf{a}(\\theta_0)^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2 + M \\sigma_n^2} $$\n该值通过 $\\mathrm{SINR}_{\\text{out}} \\text{ (dB)} = 10 \\log_{10}(\\mathrm{SINR}_{\\text{out}})$ 转换为分贝 (dB)。\n\n干扰衰减 $A_i$ 定义为 $A_i \\text{ (dB)} = -10 \\log_{10}(|\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_i)|^2)$。代入增益项 $|\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_i)|^2$ 的表达式：\n$$ A_i \\text{ (dB)} = -10 \\log_{10}\\left(\\frac{1}{M^2}|\\mathbf{a}(\\theta_0)^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2\\right) $$\n\n对于所有测试用例，阵元间距为 $d = \\lambda/2$。波数为 $k = 2\\pi/\\lambda$。因此，乘积 $kd = (2\\pi/\\lambda)(\\lambda/2) = \\pi$。导向矢量 $\\mathbf{a}(\\theta)$ 的第 m 个元素（从 0 开始索引）是 $e^{-j \\pi m \\sin(\\theta\\pi/180)}$。项 $|\\mathbf{a}(\\theta_0)^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2$ 的计算方法是：首先构建矢量 $\\mathbf{a}(\\theta_0)$ 和 $\\mathbf{a}(\\theta_i)$，然后计算它们矢量内积的模平方。最终结果通过将每个测试用例的参数代入这些推导出的公式中获得。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the output SINR and interference attenuation for a Bartlett beamformer\n    for a set of test cases.\n    \"\"\"\n    # Test cases defined as tuples:\n    # (M, f0, c, theta0_deg, thetai_deg, sigma_s2, sigma_u2, sigma_n2)\n    test_cases = [\n        (8, 1500, 1500, 20, -30, 1.0, 10.0, 1.0),\n        (8, 1500, 1500, 10, 10, 1.0, 1.0, 1.0),\n        (1, 1500, 1500, 0, 30, 2.0, 3.0, 4.0),\n        (16, 3000, 1500, 0, 60, 1.0, 100.0, 1.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        M, f0, c, theta0_deg, thetai_deg, sigma_s2, sigma_u2, sigma_n2 = case\n        \n        # The problem specifies half-wavelength spacing d = lambda/2.\n        # Wavelength lambda = c / f0.\n        # Wavenumber k = 2*pi/lambda.\n        # The term kd in the steering vector exponent becomes:\n        # kd = (2*pi/lambda) * (lambda/2) = pi.\n        # This holds true for all cases where M > 1.\n        kd = np.pi\n        \n        # Steering vector is a(theta) = [1, exp(-j*kd*sin(theta)), ..., exp(-j*kd*(M-1)*sin(theta))]\n        # We compute the inner product term |a(theta0)^H a(theta_i)|^2\n        m_indices = np.arange(M)\n        \n        # Angles need to be in radians for numpy's trigonometric functions.\n        theta0_rad = np.deg2rad(theta0_deg)\n        thetai_rad = np.deg2rad(thetai_deg)\n        \n        # Construct steering vectors\n        a_theta0 = np.exp(-1j * kd * m_indices * np.sin(theta0_rad))\n        a_thetai = np.exp(-1j * kd * m_indices * np.sin(thetai_rad))\n        \n        # Calculate a(theta0)^H * a(thetai) using numpy's vdot for hermitian dot product.\n        inner_product = np.vdot(a_theta0, a_thetai)\n        inner_product_sq = np.abs(inner_product)**2\n        \n        # Calculate output SINR in linear scale\n        # SINR_out = (M^2 * sigma_s^2) / (sigma_u^2 * |a_h^H a_i|^2 + M * sigma_n^2)\n        numerator_sinr = (M**2) * sigma_s2\n        denominator_sinr = sigma_u2 * inner_product_sq + M * sigma_n2\n        sinr_linear = numerator_sinr / denominator_sinr\n        \n        # Convert SINR to dB\n        sinr_db = 10 * np.log10(sinr_linear)\n        \n        # Calculate Interference Attenuation in dB\n        # A_i = -10 * log10(|w^H a_i|^2)\n        # |w^H a_i|^2 = |(1/M * a_0^H) a_i|^2 = (1/M^2) * |a_0^H a_i|^2\n        interferer_gain_sq = inner_product_sq / (M**2)\n        Ai_db = -10 * np.log10(interferer_gain_sq)\n\n        # Append rounded results to the list\n        results.append(sinr_db)\n        results.append(Ai_db)\n\n    # Format the final output string as per requirements\n    # Each number must be represented with exactly four decimal places.\n    output_str = \"[\" + \",\".join(f\"{x:.4f}\" for x in results) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2853623"}, {"introduction": "在掌握了基础的巴特利特波束形成器后，我们转向一种更先进的最优波束形成器：最小方差无失真响应（MVDR）波束形成器。这项练习并非简单的编程任务，而是一个关于实际实现中关键挑战的深度思辨。我们将直面在实际数据中常见的协方差矩阵病态问题，并探讨如何通过正则化等技术来确保算法的数值稳定性和鲁棒性，这是设计高性能波束形成系统的核心实践技能。[@problem_id:2853647]", "problem": "一个拥有 $M$ 个传感器的均匀线性阵列采集了 $N$ 个复窄带数据的时间快照。目标是设计最小方差无畸变响应 (MVDR) 波束形成器，该波束形成器在保证视线方向（look direction）响应无畸变的前提下，最小化输出功率。样本协方差矩阵为 $\\hat{R} = \\tfrac{1}{N} X X^{H}$，其中 $X \\in \\mathbb{C}^{M \\times N}$ 是由 $N$ 个阵列快照堆叠而成的数据矩阵。在一个包含 $M=16$ 个传感器和 $N=40$ 个快照的场景中，由于相干干扰的存在，估计的条件数 $\\kappa(\\hat{R}) \\approx 10^{10}$，并且在尝试直接对 $\\hat{R}$ 求逆时观察到了数值问题。要求您评估在此条件下计算 MVDR 解的数值稳定性，比较用于求解所需线性系统的 Cholesky 分解、正交三角 (QR) 分解和特征值分解 (EVD) 方法，并推荐能够在不违反无畸变约束的情况下提高稳定性的正则化策略。\n\n选择所有正确的陈述。\n\nA. 在此情况下，尝试通过对样本协方差矩阵进行 Cholesky 分解而不进行正则化来计算波束形成器，很可能会不稳定或在数值上失败；添加对角加载 $\\lambda I$（其中 $\\lambda$ 与噪声方差相当）会产生一个严格正定的系统，并且在通过归一化强制施加约束后，能够精确地保持无畸变响应。\n\nB. 使用数据矩阵 $X$ 的正交三角 (QR) 分解来求解所需的线性系统（从而避免显式构造和求逆 $\\hat{R}=\\tfrac{1}{N} X X^{H}$），能将病态程度从 $\\kappa(\\hat{R})$ 降低到约 $\\kappa(X)=\\sqrt{\\kappa(\\hat{R})}$，从而提高数值稳定性。\n\nC. 采用特征值铺底（eigenvalue flooring）的特征值分解 (EVD)，即将 $\\Lambda$ 替换为 $\\tilde{\\Lambda}$（其中 $\\tilde{\\Lambda}_{ii}=\\max(\\Lambda_{ii},\\lambda)$），实现了一种 Tikhonov 正则化；另外，收缩方法 $\\hat{R}_{\\text{shr}}=(1-\\alpha)\\hat{R}+\\alpha \\sigma^{2} I$（其中 $\\alpha \\in (0,1)$ 由数据驱动确定）即使在 $N<M$ 的情况下也能产生一个可逆的、良态的估计量。\n\nD. 因为在精确计算中样本协方差矩阵总是埃尔米特半正定的，所以带对称主元选择的 Cholesky 分解可以分解任何此类矩阵，即使它在浮点运算中是不定的；因此，带主元选择的 Cholesky 分解消除了对正则化的需求。\n\nE. 通过将最小的特征值置零（即丢弃噪声子空间）来截断 EVD，总能改进最小方差无畸变响应波束形成器，因为它在保持约束完整的同时减少了白噪声的贡献。", "solution": "当前的问题涉及最小方差无畸变响应 (MVDR) 波束形成器的数值稳定性。我将首先对问题进行形式化陈述，然后对每个选项进行严谨的评估。\n\nMVDR 波束形成器的目标是找到一个权重向量 $w \\in \\mathbb{C}^{M}$，以解决以下优化问题：\n$$ \\min_{w} w^H \\hat{R} w \\quad \\text{subject to} \\quad w^H a(\\theta_0) = 1 $$\n在此， $w^H \\hat{R} w$ 是输出功率，$\\hat{R} = \\frac{1}{N} X X^{H}$ 是由 $N$ 个数据快照 $X \\in \\mathbb{C}^{M \\times N}$ 导出的 $M \\times M$ 样本协方差矩阵 (SCM)，而 $a(\\theta_0)$ 是对应于期望视线方向 $\\theta_0$ 的导向矢量。约束 $w^H a(\\theta_0) = 1$ 确保了对于来自 $\\theta_0$ 方向的信号响应是无畸变的。\n\n该问题的解析解可通过拉格朗日乘子法得到：\n$$ w_{MVDR} = \\frac{\\hat{R}^{-1} a(\\theta_0)}{a(\\theta_0)^H \\hat{R}^{-1} a(\\theta_0)} $$\n核心的数值计算任务是计算向量 $y = \\hat{R}^{-1} a(\\theta_0)$，这等价于求解线性方程组 $\\hat{R} y = a(\\theta_0)$。\n\n问题陈述，对于 $M=16$ 个传感器和 $N=40$ 个快照，SCM 是严重病态的，其条件数 $\\kappa(\\hat{R}) \\approx 10^{10}$。由于 $N > M$，理论上 $\\hat{R}$ 是一个满秩矩阵。然而，相干干扰的存在导致 $\\hat{R}$ 的某些特征值极小，从而造成了观察到的病态问题。对于具有约 $16$ 位十进制精度的标准双精度浮点运算来说， $10^{10}$ 的条件数是有问题的。因此，直接对 $\\hat{R}$ 求逆是不稳定的，并且会放大数值误差。\n\n现在，我将分析每个陈述。\n\nA. 在此情况下，尝试通过对样本协方差矩阵进行 Cholesky 分解而不进行正则化来计算波束形成器，很可能会不稳定或在数值上失败；添加对角加载 $\\lambda I$（其中 $I$ 是单位矩阵且 $\\lambda > 0$），得到正则化矩阵 $\\hat{R}_{reg} = \\hat{R} + \\lambda I$。设 $\\hat{R}$ 的特征值为 $\\sigma_i \\ge 0$。那么 $\\hat{R}_{reg}$ 的特征值为 $\\sigma_i + \\lambda$。由于 $\\lambda > 0$，$\\hat{R}_{reg}$ 的所有特征值都是严格为正的。因此，$\\hat{R}_{reg}$ 是严格正定的，非常适合进行 Cholesky 分解。选择与噪声方差相当的 $\\lambda$ 是一种常见且有效的启发式方法，通常称为 Tikhonov 正则化或鲁棒 Capon 波束形成。\n正则化后的权重向量计算为 $w_{reg} = \\frac{\\hat{R}_{reg}^{-1} a(\\theta_0)}{a(\\theta_0)^H \\hat{R}_{reg}^{-1} a(\\theta_0)}$。分母是一个标量归一化因子。该波束形成器在视线方向的响应是 $w_{reg}^H a(\\theta_0) = \\frac{a(\\theta_0)^H (\\hat{R}_{reg}^{-1})^H a(\\theta_0)}{a(\\theta_0)^H \\hat{R}_{reg}^{-1} a(\\theta_0)}$。由于 $\\hat{R}_{reg}$ 是埃尔米特矩阵，所以 $(\\hat{R}_{reg}^{-1})^H = \\hat{R}_{reg}^{-1}$，该表达式简化为 $1$。通过归一化，无畸变约束被精确地保持。该陈述的所有论断都是正确的。\n**结论：正确**\n\nB. 使用数据矩阵 $X$ 的正交三角 (QR) 分解来求解所需的线性系统（从而避免显式构造和求逆 $\\hat{R}=\\tfrac{1}{N} X X^{H}$），能将病态程度从 $\\kappa(\\hat{R})$ 降低到约 $\\kappa(X)=\\sqrt{\\kappa(\\hat{R})}$，从而提高数值稳定性。\n\n样本协方差矩阵为 $\\hat{R} = \\frac{1}{N} X X^H$。这种形式的矩阵乘积的条件数与原始矩阵 $X$ 的条件数相关，关系为 $\\kappa(\\hat{R}) = \\kappa(X X^H) = (\\kappa(X))^2$。问题陈述 $\\kappa(\\hat{R}) \\approx 10^{10}$，这意味着 $\\kappa(X) \\approx \\sqrt{10^{10}} = 10^5$。$10^5$ 的条件数比 $10^{10}$ 容易处理得多。\n该陈述声称，在数据矩阵 $X$ 上使用基于 QR 的方法可以避免条件数的“平方”效应。这是数值线性代数的一个基本原则。求解正规方程 $A^H A x = A^H b$ 的稳定性不如使用 $A$ 的 QR 分解来求解最小二乘问题 $\\min \\|Ax-b\\|$。在我们的情境中，MVDR 问题等价于线性约束最小二乘问题 $\\min_{w} \\|X^H w\\|^2$，约束条件是 $w^H a(\\theta_0) = 1$。此类问题可以使用基于对 $X$ 和 $a(\\theta_0)$ 导出的矩阵进行 QR 分解的方法来求解，而无需显式构造乘积 $X X^H$。这些方法操作的矩阵，其条件数与 $\\kappa(X)$ 相关，而不是 $\\kappa(X)^2$。因此，这种方法确实能减轻病态问题，并提供一个更稳定的数值解。\n**结论：正确**\n\nC. 采用特征值铺底（eigenvalue flooring）的特征值分解 (EVD)，即将 $\\Lambda$ 替换为 $\\tilde{\\Lambda}$（其中 $\\tilde{\\Lambda}_{ii}=\\max(\\Lambda_{ii},\\lambda)$），实现了一种 Tikhonov 正则化；另外，收缩方法 $\\hat{R}_{\\text{shr}}=(1-\\alpha)\\hat{R}+\\alpha \\sigma^{2} I$（其中 $\\alpha \\in (0,1)$ 由数据驱动确定）即使在 $N<M$ 的情况下也能产生一个可逆的、良态的估计量。\n\n设 SCM 的 EVD 为 $\\hat{R} = U \\Lambda U^H$。标准的 Tikhonov 正则化产生 $\\hat{R} + \\lambda I = U(\\Lambda + \\lambda I)U^H$，即给所有特征值都加上 $\\lambda$。特征值铺底（Eigenvalue flooring）生成一个新矩阵 $\\tilde{R} = U \\tilde{\\Lambda} U^H$，其中 $\\tilde{\\Lambda}_{ii} = \\max(\\Lambda_{ii}, \\lambda)$，也达到了类似的目标：它将小的特征值提升到至少为 $\\lambda$，从而限制了条件数并使矩阵正定。这是一种有效的正则化技术，与 Tikhonov 正则化密切相关，有时被认为是其一种变体。\n该陈述的第二部分描述了线性收缩。收缩估计量 $\\hat{R}_{\\text{shr}} = (1-\\alpha)\\hat{R} + \\alpha \\sigma^2 I$ 是 SCM 和一个缩放的单位矩阵的凸组合。对于 $\\alpha \\in (0,1)$，该估计量保证是正定的，因为他是一个半正定矩阵 $(1-\\alpha)\\hat{R}$ 和一个正定矩阵 $\\alpha \\sigma^2 I$ 的和。此外，收缩在“小 $N$，大 $M$”的情形下特别有价值。当 $N < M$ 时，SCM $\\hat{R}$ 是秩亏的，因而是奇异的（不可逆）。收缩估计量 $\\hat{R}_{\\text{shr}}$ 即使在这种情况下也保持正定和可逆，这是一个关键优势。存在一些数据驱动的方法（例如 Ledoit-Wolf）来找到最优的 $\\alpha$。该陈述完全正确。\n**结论：正确**\n\nD. 因为在精确计算中样本协方差矩阵总是埃尔米特半正定的，所以带对称主元选择的 Cholesky 分解可以分解任何此类矩阵，即使它在浮点运算中是不定的；因此，带主元选择的 Cholesky 分解消除了对正则化的需求。\n\n在精确计算中，SCM $\\hat{R} = \\frac{1}{N} XX^H$ 确实是埃尔米特半正定的，因为对任意向量 $v$，有 $v^H \\hat{R} v = \\frac{1}{N} \\|X^H v\\|_2^2 \\ge 0$。虽然带主元选择的 Cholesky 分解 ($P^T \\hat{R} P = LL^H$) 对半正定矩阵比标准版本更鲁棒，但如果矩阵变得不定（indefinite），它就无法进行。不定矩阵至少有一个负特征值。而矩阵 $LL^H$ 根据其构造是半正定的，所以它不可能等于一个经过置换的不定矩阵。如果舍入误差导致 $\\hat{R}$ 在数值上变得不定，带主元选择的 Cholesky 分解将会失败。声称它可以分解一个不定矩阵是错误的。对于不定矩阵，必须使用像 Bunch-Kaufman $LDL^H$ 这样的分解。\n最重要的是，即使成功地对一个近奇异矩阵进行了分解，这也不能消除对正则化的需求。问题本身的病态性意味着解 $y = \\hat{R}^{-1} a(\\theta_0)$ 对扰动极其敏感。正则化不仅仅是使分解得以进行的工具；它是一种通过引入一个小的、受控的偏差来稳定不适定反问题解的基本技术。这个陈述有根本性的错误。\n**结论：错误**\n\nE. 通过将最小的特征值置零（即丢弃噪声子空间）来截断 EVD，总能改进最小方差无畸变响应波束形成器，因为它在保持约束完整的同时减少了白噪声的贡献。\n\n这种技术被称为主成分 (PC) 或基于特征空间的波束形成。它涉及创建协方差矩阵的一个低秩近似，$\\hat{R}_{trunc} = \\sum_{i=1}^K \\sigma_i u_i u_i^H$，其中 $\\sigma_i$ 和 $u_i$ 是 $K$ 个最大的特征值和对应的特征向量。其“逆”使用伪逆来计算：$\\hat{R}_{trunc}^{\\dagger} = \\sum_{i=1}^K \\frac{1}{\\sigma_i} u_i u_i^H$。然后权重 $w \\propto \\hat{R}_{trunc}^{\\dagger} a(\\theta_0)$。\n“总能”（always）这个词使得这个陈述不正确。该方法仅在真实导向矢量 $a(\\theta_0)$ 完全或几乎完全位于由前 $K$ 个特征向量张成的子空间（主子空间）内时才效果良好。如果存在任何信号模型失配，或者信号很弱，向量 $a(\\theta_0)$ 可能在被丢弃的子空间（即所谓的“噪声子空间”）中有显著分量。在这种情况下，将 $a(\\theta_0)$ 投影到主子空间上会得到一个不能很好代表信号的向量。如果 $a(\\theta_0)$ 与主子空间几乎正交，$\\hat{R}_{trunc}^{\\dagger} a(\\theta_0)$ 将接近零向量。随后为强制执行无畸变约束而进行的归一化将导致权重向量的范数 $\\|w\\|$ 变得巨大，从而导致白噪声被极度放大，性能灾难性下降。这种方法缺乏鲁棒性，而鲁棒性是实用波束形成器的关键特性。因此，它并不能“总能”改善性能。\n**结论：错误**", "answer": "$$\\boxed{ABC}$$", "id": "2853647"}, {"introduction": "前面的练习主要集中在窄带信号模型上，其中相移足以实现波束导向。然而，对于宽带信号，仅有相移会导致“波束斜视”问题，必须使用真延时（True Time-Delay）来确保在整个频带内响应的一致性。本练习将理论与实践相结合，要求您应用数字信号处理中的滤波器设计知识，为真延时波束形成器设计所需的分数延时FIR滤波器，以满足严格的性能规范。[@problem_id:2853637]", "problem": "考虑一个由 $K$ 个各向同性传感器组成的均匀线性阵列（ULA），阵元间距为 $d$，置于传播速度为 $c$ 的声学介质中。一个远场、平面波、宽带源从俯仰角 $\\theta_0$（相对于法线方向测量）入射。接收信号以采样率 $f_s$ 进行采样。要求您通过在每个传感器上实现离散时间分数延迟滤波器，来实现在信号频带 $[f_1,f_2]$内、波束指向角为 $\\theta_0$ 的真延时波束形成器，并以此实现与传感器相关的传播延迟 $\\{\\tau_m\\}_{m=0}^{K-1}$。目标是在整个频带 $[f_1,f_2]$ 内，在波束指向角方向上保持无失真（单位幅度）响应，且其误差不超过规定的通带波纹容限。\n\n从基本原理出发，使用以下基础：\n- 真延时波束形成器在波束指向角方向的波束图等于传感器输出的相干和。如果每个传感器所需的连续时间延迟由一个频率响应为 $H_m(\\omega)$ 的离散时间滤波器实现，那么当所有传感器都使用相同的分数延迟滤波器时，在波束指向角方向上的总幅度响应等于每个传感器的共同幅度 $|H_m(\\omega)|$。\n- 一个理想的 $D$ 个样本的离散时间分数延迟的频率响应为 $H_{\\text{ideal}}(\\omega)=\\exp(-j\\omega D)$，其幅度是全通的。\n- 一种标准且经过充分检验的、在指定通带内逼近 $H_{\\text{ideal}}(\\omega)$ 的方法是，使用 Kaiser 窗对理想脉冲响应进行加窗截断，从而得到一个实系数、线性相位、有限脉冲响应（FIR）的近似。其通带波纹和过渡带宽度由窗参数控制。对于一个具有相等通带和阻带波纹 $\\delta$ 以及过渡带宽度 $\\Delta\\Omega$ （单位：弧度/样本）的 Kaiser 窗 FIR 设计，保证指定波纹的常用长度估计值为\n$$\nL \\ge \\frac{A-8}{2.285\\,\\Delta\\Omega} + 1,\\quad A \\triangleq -20\\log_{10}(\\delta).\n$$\n\n请利用此框架论证，当通带波纹受 $\\delta$ 限制时，每个传感器上的分数延迟 FIR 滤波器如何确保波束形成器在波束指向角方向上具有无失真响应。然后，确定所需的最小整数滤波器阶数 $N_{\\min}$，以保证在整个频带 $[f_1,f_2]$ 内，波束指向角方向的波束图幅度与单位 1 的偏差不超过 $\\delta$。\n\n用于评估的数值规格：\n- 传感器数量 $K=16$。\n- 传播速度 $c=343\\,\\text{m/s}$。\n- 波束指向角 $\\theta_0=30^\\circ$。\n- 采样频率 $f_s=48{,}000\\,\\text{Hz}$。\n- 信号频带 $[f_1,f_2]=[3{,}000,\\,7{,}000]\\,\\text{Hz}$。\n- 在两个频带边缘，强制与相邻阻带之间有相等的过渡带宽度，$\\Delta f=1{,}000\\,\\text{Hz}$。\n- 通带波纹容限 $\\delta=0.005$（即，允许的幅度偏差最大为 $0.005$）。\n\n假设每个传感器使用相同的分数延迟滤波器，每个滤波器都通过对理想分数延迟脉冲响应进行 Kaiser 加窗来设计，以满足在频带 $[f_1,f_2]$ 上的上述波纹和过渡带宽度规格。计算保证无失真波束指向角约束所需的最小整数滤波器阶数 $N_{\\min}$。最终答案必须是单个整数 $N_{\\min}$。无需单位。如果需要对任何中间的非整数长度进行舍入，请取仍能保证规格的最小整数（即，向上取整）。", "solution": "首先，我们必须严格审查问题陈述的有效性。我们通过形式化给定的信息和约束来着手。\n\n给定条件如下：\n- 阵列配置：由 $K=16$ 个各向同性传感器组成的均匀线性阵列（ULA），阵元间距为 $d$。\n- 声学介质传播速度：$c=343\\,\\text{m/s}$。\n- 感兴趣的源方向（波束指向角）：$\\theta_0=30^\\circ$。\n- 系统采样率：$f_s=48{,}000\\,\\text{Hz}$。\n- 期望工作频带：$[f_1, f_2] = [3{,}000, 7{,}000]\\,\\text{Hz}$。\n- 波束形成器实现：通过每个传感器上的分数延迟有限脉冲响应（FIR）滤波器实现真延时。\n- 滤波器设计通带波纹容限：$\\delta=0.005$。\n- 滤波器设计过渡带宽度：$\\Delta f=1{,}000\\,\\text{Hz}$。\n- 基本前提 1：波束形成器在波束指向角方向的幅度响应等于每个相同的传感器滤波器的共同幅度响应 $|H_m(\\omega)|$。\n- 基本前提 2：理想的离散时间分数延迟滤波器的频率响应为 $H_{\\text{ideal}}(\\omega)=\\exp(-j\\omega D)$，其幅度为单位 1。\n- 基本前提 3：FIR 滤波器是通过使用 Kaiser 窗对理想脉冲响应进行加窗来设计的。所需的滤波器长度 $L$ 通过以下公式估算：\n$$\nL \\ge \\frac{A-8}{2.285\\,\\Delta\\Omega} + 1,\\quad \\text{where } A = -20\\log_{10}(\\delta).\n$$\n\n对这些前提的严格审查表明，这是一个科学上合理、内部一致且定义明确的问题。该场景是阵列信号处理中的一个标准应用。使用 Kaiser 窗的滤波器设计方法以及相关的滤波器长度经验公式是数字信号处理中的经典方法。计算所需滤波器阶数的所有必要数值都已提供。问题清晰明确且客观。因此，该问题被认为是有效的，我们将着手构建解决方案。\n\n第一个目标是论证滤波器设计约束如何确保在波束指向角方向上获得近乎无失真的响应。\n在波束指向角方向上的无失真响应意味着，对于信号频带内的所有频率，波束形成器频率响应的幅度均为单位 1。问题陈述指出，总的波束指向角方向幅度响应等于单个 FIR 滤波器的幅度响应 $|H_m(\\omega)|$。我们试图逼近的理想滤波器是一个分数延迟滤波器，它具有恒定的单位幅度响应。通带波纹容限 $\\delta$ 量化了我们实际滤波器的幅度响应与理想单位增益之间的最大允许偏差。具体来说，对于通带 $[f_1, f_2]$ 内的任何频率 $f$，滤波器的幅度响应 $|H_m(\\omega)|$（其中 $\\omega = 2\\pi f$）被限制在 $[1-\\delta, 1+\\delta]$ 范围内。由于波束形成器在波束指向角方向的响应与此相同，因此可以直接得出结论，波束指向角方向的波束图幅度与单位 1 的偏差不会超过 $\\delta$。这正是实现“在规定的通带波纹容限内无失真”响应的直接含义。\n\n第二个目标是计算满足指定约束所需的最小整数滤波器阶数 $N_{\\min}$。FIR 滤波器的阶数 $N$ 与其长度 $L$ 的关系为 $N = L-1$。我们必须首先使用给定的公式找到所需的最小长度 $L_{\\min}$。\n\n步骤 1：计算衰减参数 $A$。\n参数 $A$ 由通带波纹 $\\delta = 0.005$ 确定。\n$$A = -20\\log_{10}(\\delta) = -20\\log_{10}(0.005)$$\n$$A = -20\\log_{10}(5 \\times 10^{-3}) = -20(\\log_{10}(5) - 3)$$\n使用数值 $\\log_{10}(5) \\approx 0.698970$：\n$$A \\approx -20(0.698970 - 3) = -20(-2.301030) \\approx 46.0206$$\n\n步骤 2：计算归一化过渡带宽度 $\\Delta\\Omega$。\n过渡带宽度以赫兹为单位给出，为 $\\Delta f = 1{,}000\\,\\text{Hz}$。采样频率为 $f_s = 48{,}000\\,\\text{Hz}$。归一化角频率（单位：弧度/样本）下的过渡带宽度为：\n$$\\Delta\\Omega = 2\\pi \\frac{\\Delta f}{f_s} = 2\\pi \\frac{1{,}000}{48{,}000} = \\frac{2\\pi}{48} = \\frac{\\pi}{24}$$\n\n步骤 3：计算最小滤波器长度 $L_{\\min}$。\n我们将 $A$ 和 $\\Delta\\Omega$ 的值代入给定的滤波器长度 $L$ 的不等式中。\n$$L \\ge \\frac{A-8}{2.285\\,\\Delta\\Omega} + 1$$\n$$L \\ge \\frac{46.0206 - 8}{2.285 \\left(\\frac{\\pi}{24}\\right)} + 1 = \\frac{38.0206}{2.285 \\left(\\frac{\\pi}{24}\\right)} + 1$$\n计算分母：$2.285 \\times \\frac{\\pi}{24} \\approx 0.2990833$。\n$$L \\ge \\frac{38.0206}{0.2990833} + 1 \\approx 127.1258 + 1 = 128.1258$$\n由于滤波器长度 $L$ 必须是整数，我们必须选择满足此条件的最小整数值。这通过对计算出的下界取上整得到。\n$$L_{\\min} = \\lceil 128.1258 \\rceil = 129$$\n\n步骤 4：计算最小滤波器阶数 $N_{\\min}$。\n滤波器阶数 $N$ 比其长度 $L$ 小一。\n$$N_{\\min} = L_{\\min} - 1 = 129 - 1 = 128$$\n\n值得注意的是，参数 $K$、$c$ 和 $\\theta_0$ 是波束形成物理问题的背景参数，但在具体计算滤波器阶数时并不需要。滤波器的复杂度由其频域规格（$\\delta$ 和 $\\Delta\\Omega$）决定，而不是由其实现的具体分数延迟值决定。问题假设这些规格的选择是为了适应整个阵列所需的延迟范围。", "answer": "$$\\boxed{128}$$", "id": "2853637"}]}