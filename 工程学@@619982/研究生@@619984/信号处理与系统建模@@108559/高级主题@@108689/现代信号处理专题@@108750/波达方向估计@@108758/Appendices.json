{"hands_on_practices": [{"introduction": "阵列信号处理的一个基本挑战是空间混叠，它会导致称为栅瓣的模糊方向。如果传感器间距相对于信号波长过大，阵列将无法唯一地确定信号的来源方向，这与数字信号采样中的时间混叠现象类似。这个练习 [@problem_id:2866474] 提供了一个具体的场景，让你亲手计算和判断在给定阵列参数下是否存在方向模糊，从而帮助你建立对这一关键设计约束的直观理解。", "problem": "考虑一个远场窄带平面波入射到一个由 $N$ 个全向传感器组成的均匀线性阵列（ULA）上，其阵元间距为 $d$。阵列轴沿 $x$ 轴放置，侧射方向定义为 $\\theta=0^{\\circ}$。波达方向（DOA）角 $\\theta$ 是相对于侧射方向测量的，可见区域取为 $\\theta \\in [-90^{\\circ}, 90^{\\circ}]$。在平面波模型下并忽略互耦效应，第 $n$ 个传感器（索引为 $n \\in \\{0,1,\\dots,N-1\\}$）接收到的相位与参考传感器相比，其相位差是由波前传播到该传感器的相应传播延迟决定的。\n\n假设阵元间距为 $d=0.8\\lambda$，其中 $\\lambda$ 是波长，真实的DOA为 $\\theta=10^{\\circ}$。从平面波传播模型和ULA相邻阵元间的导向相位差定义出发，推导出一个备选角度 $\\theta'$ 产生与真实角度 $\\theta$ 相同的阵元间相位差的充分必要条件。利用此条件，确定在 $\\theta' \\in [-90^{\\circ}, 90^{\\circ}]$ 范围内，所有能产生与 $\\theta=10^{\\circ}$ 相同导向相位差的角度 $\\theta'$ 的完整集合。\n\n如果存在任何此类备选角度，请以度为单位列出它们，并将每个角度四舍五入到 $4$ 位有效数字。最后，报告在 $[-90^{\\circ}, 90^{\\circ}]$ 范围内除真实DOA之外的不同模糊方向的数量。你最终提交的答案必须是这个数字（无单位）。", "solution": "该问题要求对均匀线性阵列（ULA）的空间混叠（或称栅瓣）进行分析。在提供解决方案之前，必须对问题陈述进行验证。\n\n已知条件如下：\n- 一个具有 $N$ 个传感器和阵元间距 $d$ 的ULA。\n- 阵列轴为 $x$ 轴。\n- 侧射方向为 $\\theta=0^{\\circ}$。\n- 波达方向（DOA）$\\theta$ 相对于侧射方向测量。\n- 可见区域为 $\\theta \\in [-90^{\\circ}, 90^{\\circ}]$。\n- 信号为远场窄带平面波。\n- 阵元间距指定为 $d=0.8\\lambda$，其中 $\\lambda$ 为波长。\n- 真实的DOA为 $\\theta=10^{\\circ}$。\n\n该问题在科学上基于阵列信号处理的原理，在数学上是适定的，并使用客观和精确的术语陈述。这是一个完整且一致的问题陈述。因此，该问题是有效的，将提供一个解决方案。\n\n我们首先对每个传感器接收到的信号相位进行建模。对于一个阵列轴沿 $x$ 轴的ULA，第 $n$ 个传感器（对于 $n \\in \\{0, 1, \\dots, N-1\\}$）的位置可以用向量 $\\mathbf{p}_n = (nd, 0, 0)$ 表示，假设第一个传感器（$n=0$）位于原点。一个从相对于侧射方向（$y$ 轴）$\\theta$ 方向到达的平面波，在 $xy$ 平面内其单位方向向量为 $\\mathbf{u}(\\theta) = (\\sin(\\theta), \\cos(\\theta), 0)$。\n\n波传播到传感器 $n$ 相对于原点处参考传感器的波程差，是传感器位置向量在波的方向向量上的投影：\n$$ \\Delta L_n = \\mathbf{p}_n \\cdot \\mathbf{u}(\\theta) = nd\\sin(\\theta) $$\n这个波程差对应的时间延迟为 $\\tau_n = \\frac{\\Delta L_n}{c} = \\frac{nd\\sin(\\theta)}{c}$，其中 $c$ 是传播速度。对于载波角频率为 $\\omega = 2\\pi f = \\frac{2\\pi c}{\\lambda}$ 的窄带信号，这个时间延迟会引起一个相对于参考传感器的相位偏移：\n$$ \\phi_n(\\theta) = -\\omega \\tau_n = -2\\pi \\frac{c}{\\lambda} \\frac{nd\\sin(\\theta)}{c} = -2\\pi n \\frac{d}{\\lambda}\\sin(\\theta) $$\n阵元间的相位差是任意两个相邻传感器（例如，传感器 $n$ 和传感器 $n-1$）之间的相位差：\n$$ \\Delta\\phi(\\theta) = \\phi_n(\\theta) - \\phi_{n-1}(\\theta) = \\left(-2\\pi n \\frac{d}{\\lambda}\\sin(\\theta)\\right) - \\left(-2\\pi(n-1)\\frac{d}{\\lambda}\\sin(\\theta)\\right) = -2\\pi \\frac{d}{\\lambda}\\sin(\\theta) $$\n这个相位差是阵列用来区分方向的基本量。如果接收到的信号向量无法区分，那么一个备选角度 $\\theta'$ 就会产生与真实角度 $\\theta$ 相同的测量结果。由于相位的周期性，这种情况发生在阵元间相位差相等或相差 $2\\pi$ 的整数倍时。因此，条件是：\n$$ \\Delta\\phi(\\theta') = \\Delta\\phi(\\theta) + 2\\pi k $$\n其中 $k$ 是一个整数。当 $k=0$ 时，该条件平凡地导出 $\\sin(\\theta') = \\sin(\\theta)$，这意味着在主可见区内 $\\theta'=\\theta$，对应于真实的DOA。模糊方向，也称为栅瓣，对应于非零整数值 $k \\neq 0$。\n\n将 $\\Delta\\phi$ 的表达式代入模糊条件，得到：\n$$ -2\\pi \\frac{d}{\\lambda}\\sin(\\theta') = -2\\pi \\frac{d}{\\lambda}\\sin(\\theta) + 2\\pi k $$\n将整个方程除以 $-2\\pi$，得出模糊的充分必要条件：\n$$ \\frac{d}{\\lambda}\\sin(\\theta') = \\frac{d}{\\lambda}\\sin(\\theta) - k $$\n$$ \\sin(\\theta') = \\sin(\\theta) - k\\frac{\\lambda}{d} $$\n该方程给出了任意模糊角 $\\theta'$ 的正弦值，表示为真实角度 $\\theta$ 和阵列参数 $\\frac{\\lambda}{d}$ 的函数。\n\n给定 $d=0.8\\lambda$，这意味着 $\\frac{\\lambda}{d} = \\frac{1}{0.8} = 1.25$。\n真实角度为 $\\theta=10^{\\circ}$。\n模糊角 $\\theta'$ 的条件变为：\n$$ \\sin(\\theta') = \\sin(10^{\\circ}) - 1.25k $$\n为了使模糊角 $\\theta'$ 存在于可见区域 $[-90^{\\circ}, 90^{\\circ}]$ 内，$\\sin(\\theta')$ 的值必须在 $[-1, 1]$ 的范围内。我们必须找到是否存在任何满足此约束的非零整数 $k$。\n\n让我们测试 $k \\neq 0$ 的整数值：\n情况 $k=1$:\n$$ \\sin(\\theta') = \\sin(10^{\\circ}) - 1.25 $$\n已知 $\\sin(10^{\\circ})$ 的值约为 $0.1736$，则结果为 $\\sin(\\theta') \\approx 0.1736 - 1.25 = -1.0764$。由于 $-1.0764 < -1$，不存在满足此条件的实数角度 $\\theta'$。\n\n情况 $k=-1$:\n$$ \\sin(\\theta') = \\sin(10^{\\circ}) - 1.25(-1) = \\sin(10^{\\circ}) + 1.25 $$\n结果为 $\\sin(\\theta') \\approx 0.1736 + 1.25 = 1.4236$。由于 $1.4236 > 1$，不存在满足此条件的实数角度 $\\theta'$。\n\n对于任何其他非零整数 $k$，其中 $|k| \\ge 1$：\n$$ |\\sin(\\theta') - \\sin(10^{\\circ})| = |k \\times 1.25| \\ge 1.25 $$\n根据反三角不等式，我们有：\n$$ |\\sin(\\theta')| \\geq ||\\sin(\\theta') - \\sin(10^{\\circ})| - |\\sin(10^{\\circ})|| \\ge |1.25 - \\sin(10^{\\circ})| $$\n由于 $\\sin(10^{\\circ}) \\approx 0.1736$，这给出：\n$$ |\\sin(\\theta')| \\ge |1.25 - 0.1736| = 1.0764 $$\n因为 $|\\sin(\\theta')| \\ge 1.0764 > 1$，所以对于任何非零整数 $k$，$\\sin(\\theta')$ 的值不可能在 $[-1, 1]$ 的有效范围内。\n\n因此，对于给定的阵元间距 $d=0.8\\lambda$，真实的波达方向 $\\theta=10^{\\circ}$ 在可见区域 $\\theta' \\in [-90^{\\circ}, 90^{\\circ}]$ 内不会产生任何模糊方向。备选角度的集合是空集。\n\n最后一个问题要求的是除真实DOA之外的不同模糊方向的数量。根据我们的推导，这个数量是零。", "answer": "$$\n\\boxed{0}\n$$", "id": "2866474"}, {"introduction": "在理解了阵列的物理限制之后，我们可以探索更强大的算法来精确地定位信号方向。Root-MUSIC算法是传统波束形成方法的一种优雅的高分辨率替代方案，它将DOA估计问题转化为多项式求根问题，从而避免了频谱搜索。这个实践问题 [@problem_id:2866423] 通过一个巧妙构造的理想化场景，揭示了该算法的多项式根与真实信号方向之间的深刻联系，让你清晰地洞察其核心——信号子空间与噪声子空间的正交性原理。", "problem": "一个阵元间距为 $d=\\lambda/2$ 的八元均匀线性阵列 (ULA) 接收到 $K=2$ 个在空间白噪声下的窄带远场平面波。阵元索引为 $n=0,1,\\dots,7$。设阵列流形（导向）矢量为一个在单位圆上的复数 $z$ 的函数，定义为\n$$\n\\mathbf{a}(z) \\triangleq \\begin{bmatrix} 1 & z^{-1} & z^{-2} & \\dots & z^{-7} \\end{bmatrix}^{\\mathsf{T}},\n$$\n其空间频率-角度映射关系由 $z=\\exp\\!\\big(j \\psi\\big)$ 和 $\\psi=\\pi \\sin(\\theta)$ 给出，其中波达方向 (DOA) 角 $\\theta \\in [-\\frac{\\pi}{2},\\frac{\\pi}{2}]$ （单位为弧度）。\n\n给定噪声子空间矩阵 $\\mathbf{E}_n \\in \\mathbb{C}^{8 \\times 6}$，其列向量构成一个标准正交基，该基等于频率索引为 $\\{0,2,3,4,5,6\\}$ 的离散傅里叶变换 (DFT) 列向量；即，\n$$\n\\mathbf{E}_n \\triangleq \\begin{bmatrix} \\mathbf{e}_0 & \\mathbf{e}_2 & \\mathbf{e}_3 & \\mathbf{e}_4 & \\mathbf{e}_5 & \\mathbf{e}_6 \\end{bmatrix},\n$$\n其中第 $k$ 个 DFT 列向量为\n$$\n\\mathbf{e}_k[n] \\triangleq \\frac{1}{\\sqrt{8}} \\exp\\!\\Big(-j \\frac{2\\pi}{8} k n\\Big), \\quad n=0,1,\\dots,7.\n$$\n因此，信号子空间由索引为 $\\{1,7\\}$ 的剩余两个 DFT 列向量张成。\n\n仅从多重信号分类 (MUSIC) 算法的基本正交性原理——即真实导向矢量与噪声子空间正交——以及投影 $\\mathbf{P}_n \\triangleq \\mathbf{E}_n \\mathbf{E}_n^{\\mathsf{H}}$ 的定义出发，执行以下操作：\n\n1. 通过推导系数 $c_k$ 关于 $\\mathbf{P}_n$ 和阵列大小 8 的闭式表达式，构造一个次数为 $2(8-1)$ 的根-MUSIC多项式 $p(z)$，其形式为\n$$\np(z) \\triangleq \\mathbf{a}^{\\mathsf{H}}(z)\\, \\mathbf{P}_n \\, \\mathbf{a}(z) \\;=\\; \\sum_{k=-7}^{7} c_k\\, z^{-k},\n$$\n\n2. 确定 $p(z)$ 在单位圆上且对应于可见区域中两个 DOA 的根，并使用 $\\psi=\\arg(z)$ 和 $\\theta=\\arcsin(\\psi/\\pi)$ 将它们映射到 DOA 角度 $\\theta_1$ 和 $\\theta_2$。\n\n将最终的 DOA 估计值以度为单位表示，四舍五入到四位有效数字，并以一个双元素行向量的形式报告。最终答案必须以度为单位；不要在最终的方框答案中包含单位。", "solution": "问题陈述已经过验证，被确定为具有科学依据、适定、客观和自洽的。它代表了阵列信号处理中的一个标准问题，特别是使用根-MUSIC算法进行波达方向 (DOA) 估计。所提供的信息对于推导出唯一解是充分且一致的。\n\n任务是找到入射到 $N=8$ 元均匀线性阵列 (ULA) 上的 $K=2$ 个信号的DOA。该方法的核心在于信号导向矢量与噪声子空间之间的正交性。根-MUSIC算法通过寻找由噪声子空间投影导出的多项式的根，将这一原理付诸实践。\n\n首先，我们推导根-MUSIC多项式 $p(z)$ 的系数 $c_k$。问题将此多项式定义为 $p(z) = \\mathbf{a}^{\\mathsf{H}}(z) \\mathbf{P}_n \\mathbf{a}(z)$。为了寻找根，我们构建一个在复平面上解析的标准根-MUSIC多项式，方法是用标准转置 $\\mathbf{a}^{\\mathsf{T}}(z^{-1})$ 替换共轭转置 $\\mathbf{a}^{\\mathsf{H}}(z)$。这在单位圆上是等价的，因为在单位圆上有 $z^{-1} = z^*$。\n因此，多项式被表述为：\n$$\np(z) \\triangleq \\mathbf{a}^{\\mathsf{T}}(z^{-1}) \\mathbf{P}_n \\mathbf{a}(z)\n$$\n其中 $\\mathbf{a}(z) = \\begin{bmatrix} 1 & z^{-1} & \\dots & z^{-7} \\end{bmatrix}^{\\mathsf{T}}$。矢量 $\\mathbf{a}^{\\mathsf{T}}(z^{-1})$ 是 $\\begin{bmatrix} 1 & z & \\dots & z^7 \\end{bmatrix}$。展开多项式表达式：\n$$\np(z) = \\sum_{m=0}^{7} \\sum_{l=0}^{7} z^{m} (\\mathbf{P}_n)_{ml} z^{-l} = \\sum_{m=0}^{7} \\sum_{l=0}^{7} (\\mathbf{P}_n)_{ml} z^{m-l}\n$$\n为了匹配所要求的形式 $p(z) = \\sum_{k=-7}^{7} c_k z^{-k}$，我们按 $z$ 的幂次对各项进行分组。让我们首先定义一个多项式 $P(z) = \\sum_{j=-7}^{7} C_j z^j$。与上面的表达式比较，项 $z^j$ 的系数 $C_j$ 可通过设置 $j=m-l$ 获得：\n$$\nC_j = \\sum_{m-l=j, \\, 0 \\le m,l \\le 7} (\\mathbf{P}_n)_{ml}\n$$\n问题指明噪声子空间投影矩阵 $\\mathbf{E}_n$ 的列是 DFT 向量。投影矩阵为 $\\mathbf{P}_n = \\mathbf{E}_n \\mathbf{E}_n^{\\mathsf{H}} = \\sum_{i \\in S_n} \\mathbf{e}_i \\mathbf{e}_i^{\\mathsf{H}}$，其中 $S_n=\\{0,2,3,4,5,6\\}$。$\\mathbf{P}_n$ 的第 $(m,l)$ 个元素是：\n$$\n(\\mathbf{P}_n)_{ml} = \\sum_{i \\in S_n} (\\mathbf{e}_i)_m (\\mathbf{e}_i)_l^* = \\sum_{i \\in S_n} \\frac{1}{\\sqrt{8}} \\exp\\left(-j \\frac{2\\pi}{8} i m\\right) \\frac{1}{\\sqrt{8}} \\exp\\left(j \\frac{2\\pi}{8} i l\\right) = \\frac{1}{8} \\sum_{i \\in S_n} \\exp\\left(j \\frac{\\pi}{4} i (l-m)\\right)\n$$\n这表明 $(\\mathbf{P}_n)_{ml}$ 仅取决于差值 $l-m$。因此，$\\mathbf{P}_n$ 是一个托普利茨矩阵。设 $r_{l-m} = (\\mathbf{P}_n)_{ml}$。那么，$z^j$ 的系数 $C_j$ 是 $\\mathbf{P}_n$ 第 $(-j)$ 条对角线上元素的和。由于这条对角线上的所有元素都等于 $r_{-j}$，并且有 $8-|j|$ 个这样的元素：\n$$\nC_j = (8-|j|) r_{-j}\n$$\n所求的多项式为 $p(z) = \\sum_{k=-7}^{7} c_k z^{-k}$。通过设置 $z^{-k} = z^j$，我们得到 $j=-k$。系数 $c_k$ 于是等于 $C_{-k}$：\n$$\nc_k = C_{-k} = (8-|-k|)r_{-(-k)} = (8-|k|)r_k\n$$\n其中 $r_k = \\frac{1}{8} \\sum_{i \\in S_n} \\exp(j \\frac{\\pi}{4} i k)$。\n\nDFT 向量构成一个完备的标准正交基，因此噪声子空间上的投影 $\\mathbf{P}_n$ 和信号子空间上的投影 $\\mathbf{P}_s$ 之和为单位矩阵：$\\mathbf{P}_n + \\mathbf{P}_s = \\mathbf{I}$。信号子空间由索引在 $S_s=\\{1,7\\}$ 中的 DFT 向量张成。\n因此，$(\\mathbf{P}_n)_{ml} = \\delta_{ml} - (\\mathbf{P}_s)_{ml}$，其中 $\\delta_{ml}$ 是克罗内克 δ。$\\mathbf{P}_n$ 的对角线元素 $r_k$ 为：\n$$\nr_k = \\delta_{k,0} - \\frac{1}{8} \\sum_{i \\in S_s} \\exp\\left(j \\frac{\\pi}{4} i k\\right)\n$$\n代入 $S_s = \\{1,7\\}$：\n$$\nr_k = \\delta_{k,0} - \\frac{1}{8} \\left( \\exp\\left(j \\frac{\\pi}{4} k\\right) + \\exp\\left(j \\frac{7\\pi}{4} k\\right) \\right) = \\delta_{k,0} - \\frac{1}{8} \\left( \\exp\\left(j \\frac{\\pi}{4} k\\right) + \\exp\\left(-j \\frac{\\pi}{4} k\\right) \\right) = \\delta_{k,0} - \\frac{2}{8} \\cos\\left(\\frac{\\pi k}{4}\\right)\n$$\n所以，$r_k = \\delta_{k,0} - \\frac{1}{4}\\cos\\left(\\frac{\\pi k}{4}\\right)$。系数 $c_k$ 的闭式表达式为：\n$$\nc_k = (8-|k|) \\left( \\delta_{k,0} - \\frac{1}{4}\\cos\\left(\\frac{\\pi k}{4}\\right) \\right), \\quad k \\in \\{-7, \\dots, 7\\}\n$$\n这就完成了问题的第一部分。\n\n对于第二部分，我们必须找到 $p(z)$ 在单位圆上的两个根。MUSIC 原理指出，对于一个真实的 DOA 角度 $\\theta$，其对应的导向矢量 $\\mathbf{a}(z)$ (其中 $z=\\exp(j\\pi\\sin\\theta)$) 与噪声子空间正交。这意味着 $\\mathbf{a}(z)$ 必须位于信号子空间内。\n问题陈述了信号子空间是由 DFT 向量 $\\mathbf{e}_1$ 和 $\\mathbf{e}_7$ 张成的。一个 DFT 向量 $\\mathbf{e}_i$ 的元素为 $(\\mathbf{e}_i)_n = \\frac{1}{\\sqrt{8}}\\exp(-j\\frac{2\\pi i n}{8})$。这与一个导向矢量 $\\mathbf{a}(z_i)$ 成比例，其中 $z_i=\\exp(j\\frac{2\\pi i}{8})$，因为 $(\\mathbf{a}(z_i))_n = (z_i)^{-n} = \\exp(-j\\frac{2\\pi i n}{8})$。\n因此，对应于真实 DOA 的导向矢量必须与信号子空间的基向量 $\\mathbf{e}_1$ 和 $\\mathbf{e}_7$ 成比例。这意味着真实的信号导向矢量恰好是对应于 DFT 索引 1 和 7 的那些。因此，单位圆上的根是：\n$$\nz_1 = \\exp\\left(j\\frac{2\\pi \\cdot 1}{8}\\right) = \\exp\\left(j\\frac{\\pi}{4}\\right)\n$$\n$$\nz_2 = \\exp\\left(j\\frac{2\\pi \\cdot 7}{8}\\right) = \\exp\\left(j\\frac{7\\pi}{4}\\right) = \\exp\\left(-j\\frac{\\pi}{4}\\right)\n$$\n这些根必须使多项式 $p(z)$ 为零，这一事实可以通过将它们代入上面推导出的系数的表达式 $\\sum c_k z^{-k}$ 来验证。\n\n最后，我们使用给定的关系 $z=\\exp(j\\psi)$ 和 $\\psi=\\pi\\sin(\\theta)$ 将这些根映射到 DOA 角度 $\\theta_1$ 和 $\\theta_2$。\n对于根 $z_1 = \\exp(j\\frac{\\pi}{4})$：\n相位是 $\\psi_1 = \\arg(z_1) = \\frac{\\pi}{4}$。\n$$\n\\frac{\\pi}{4} = \\pi \\sin(\\theta_1) \\implies \\sin(\\theta_1) = \\frac{1}{4}\n$$\n$$\n\\theta_1 = \\arcsin\\left(\\frac{1}{4}\\right) = \\arcsin(0.25)\n$$\n对于根 $z_2 = \\exp(-j\\frac{\\pi}{4})$：\n相位是 $\\psi_2 = \\arg(z_2) = -\\frac{\\pi}{4}$。\n$$\n-\\frac{\\pi}{4} = \\pi \\sin(\\theta_2) \\implies \\sin(\\theta_2) = -\\frac{1}{4}\n$$\n$$\n\\theta_2 = \\arcsin\\left(-\\frac{1}{4}\\right) = -\\arcsin(0.25)\n$$\n为了以度为单位提供答案，我们从弧度进行转换：\n$$\n\\theta_1 = \\arcsin(0.25) \\times \\frac{180}{\\pi} \\approx 14.47751...^{\\circ}\n$$\n$$\n\\theta_2 = -\\arcsin(0.25) \\times \\frac{180}{\\pi} \\approx -14.47751...^{\\circ}\n$$\n四舍五入到四位有效数字，DOA 分别为 $\\theta_1 = 14.48^{\\circ}$ 和 $\\theta_2 = -14.48^{\\circ}$。以双元素行向量的形式表示，即为 $\\begin{pmatrix} -14.48 & 14.48 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} -14.48 & 14.48 \\end{pmatrix}}\n$$", "id": "2866423"}, {"introduction": "将算法理论付诸实践时，我们必须考虑计算效率。许多DOA估计算法（如频谱MUSIC）需要在所有可能的角度上进行网格搜索来寻找谱峰，这会带来巨大的计算开销。这个练习 [@problem_id:2866495] 挑战你像系统设计师一样思考，通过建立并解决一个优化问题，在估计精度和计算资源之间做出权衡，这是真实世界信号处理系统设计中一项至关重要的技能。", "problem": "一个具有 $N$ 个相同传感器、阵元间距为 $d=\\lambda/2$ 的均匀线性阵列 (ULA) 观测一个波达方向 (DOA) 角 $\\theta_{0} \\in [-\\Theta_{\\max}, \\Theta_{\\max}]$ 的窄带远场单源。多重信号分类 (MUSIC) 伪谱在 $[-\\Theta_{\\max}, \\Theta_{\\max}]$ 范围内一个间距为 $\\Delta \\theta$ 的均匀角度网格 $\\{\\theta_{m}\\}$ 上进行评估，DOA 估计值取为使采样伪谱最大化的网格点。\n\n要求您设计网格间距 $\\Delta \\theta$ 以平衡计算成本和精度，并在以下建模假设下，量化网格密度对估计误差和漏峰的影响：\n\n1. 使用标准 ULA 导向矢量 $a(\\theta) = [1,\\exp(\\mathrm{j}\\pi \\sin \\theta),\\dots,\\exp(\\mathrm{j}\\pi(N-1)\\sin \\theta)]^{\\top}$ 和常规 ULA 阵列因子在空间频率 $u=\\sin \\theta$ 中的已知包络，确定到第一个零点的主瓣宽度（以 $u$ 为单位），并通过局部映射 $u(\\theta)=\\sin \\theta$ 将其与 $\\theta$ 中的角度宽度相关联。\n2. 假设真实峰值位置相对于最近网格点的偏移在区间 $[-\\Delta \\theta/2,\\Delta \\theta/2]$ 内均匀分布。在此量化模型下，推导仅由网格离散化引起的均方估计误差 $E(\\Delta \\theta)$（忽略估计器偏差）。\n3. 定义“漏峰事件”为没有任何网格点落入伪谱峰值的主瓣捕获区间内。使用在第 1 项中获得的宽度和第 2 项中的均匀偏移模型，推导漏峰概率 $P_{\\mathrm{miss}}(\\Delta \\theta)$ 作为 $\\Delta \\theta$ 和 $N$ 的函数，并以在 $\\theta \\in [-\\Theta_{\\max},\\Theta_{\\max}]$ 上的最坏情况表示。\n4. 设每次伪谱评估的计算成本为正常数 $c_{0}$，因此在宽度为 $2\\Theta_{\\max}$ 的对称区间上以间距 $\\Delta \\theta$ 扫描网格的总成本为 $C(\\Delta \\theta)=c_{0} \\left\\lceil \\frac{2\\Theta_{\\max}}{\\Delta \\theta}\\right\\rceil$。考虑以下惩罚目标函数，该函数在权衡成本与精度的同时，强制执行严格的无漏峰要求：\n   $$J(\\Delta \\theta) \\triangleq \\frac{2 c_{0}\\,\\Theta_{\\max}}{\\Delta \\theta} + \\frac{E(\\Delta \\theta)}{1}, \\quad \\text{其中 } P_{\\mathrm{miss}}(\\Delta \\theta)=0,$$\n   其中，为了在连续优化中的易处理性，您可以用其参数替换 $\\left\\lceil \\cdot \\right\\rceil$。\n5. 给定 $N=64$，$\\Theta_{\\max}=\\frac{\\pi}{3}$ 和 $c_{0}=10^{-6}$，在满足第 3 项中无漏峰约束的条件下，最小化 $J(\\Delta \\theta)$（其中 $\\Delta \\theta>0$），并报告最优均匀网格间距 $\\Delta \\theta^{\\star}$。\n\n以弧度表示您的最终答案 $\\Delta \\theta^{\\star}$，并四舍五入到四位有效数字。", "solution": "所提出的问题是信号处理系统设计中的一个有效练习，旨在解决波达方向 (DOA) 估计中计算成本与估计精度之间的权衡问题。该问题具有科学依据，提法明确，并为其求解提供了所有必要的参数和模型。我们将逐步进行推导。\n\n该问题要求我们通过最小化一个平衡计算负载和网格引起的估计误差的成本函数，来为 DOA 搜索找到一个最优网格间距 $\\Delta \\theta$，同时满足无漏峰的约束。\n\n步骤 1：捕获区间的主瓣宽度\n\n首先，我们确定常规波束形成器主瓣的宽度，问题中将其指定为“主瓣捕获区间”。对于一个具有 $N$ 个传感器、阵元间距为 $d=\\lambda/2$ 的均匀线性阵列 (ULA)，朝向角度 $\\theta$ 的导向矢量由下式给出\n$$ a(\\theta) = [1, \\exp(\\mathrm{j} k d \\sin\\theta), \\dots, \\exp(\\mathrm{j}(N-1)kd \\sin\\theta)]^{\\top} $$\n其中 $k = 2\\pi/\\lambda$ 是波数。代入 $d=\\lambda/2$，我们得到 $kd = \\pi$。空间频率定义为 $u = \\sin\\theta$。导向矢量变为\n$$ a(u) = [1, \\exp(\\mathrm{j}\\pi u), \\dots, \\exp(\\mathrm{j}\\pi(N-1) u)]^{\\top} $$\n当导向到 $u$ 时，对位于 $u_0$ 的源的常规波束形成器输出功率（或阵列因子）与 $|a(u)^\\dagger a(u_0)|^2$ 成正比。为分析主瓣形状，我们导向到法向 ($u=0$) 并考虑位于 $u_0$ 的源。阵列因子为\n$$ P(u_0) = \\left| \\sum_{n=0}^{N-1} \\exp(\\mathrm{j} n \\pi u_0) \\right|^2 $$\n这是一个几何级数，其和为\n$$ P(u_0) = \\left| \\frac{1 - \\exp(\\mathrm{j} N \\pi u_0)}{1 - \\exp(\\mathrm{j} \\pi u_0)} \\right|^2 = \\left| \\frac{\\sin(N\\pi u_0/2)}{\\sin(\\pi u_0/2)} \\right|^2 $$\n主瓣中心位于 $u_0=0$。当分子为零且分母不为零时，出现第一零点。这发生在 $N\\pi u_0/2 = \\pm\\pi$ 时，即 $u_0 = \\pm 2/N$。\n因此，空间频率域中第一零点之间的主瓣全宽度为 $W_u = 4/N$。我们将“主瓣捕获区间”解释为这个完整的零点到零点的宽度。\n\n为了将此宽度转换到角度域 $\\theta$，我们使用局部关系 $u = \\sin\\theta$，得到 $\\mathrm{d}u = \\cos\\theta \\, \\mathrm{d}\\theta$。在角度 $\\theta$ 处，对应于宽度 $W_u$ 的角度宽度 $W_\\theta$ 近似为\n$$ W_\\theta(\\theta) \\approx \\frac{W_u}{|\\mathrm{d}u/\\mathrm{d}\\theta|} = \\frac{4/N}{|\\cos\\theta|} $$\n这个宽度取决于方向 $\\theta$，当 $\\theta$ 接近 $\\pm\\pi/2$（端射）时变宽。\n\n步骤 2：均方估计误差\n\n问题陈述，由网格离散化引起的估计误差 $\\epsilon = \\hat{\\theta} - \\theta_0$ 被建模为一个在区间 $[-\\Delta\\theta/2, \\Delta\\theta/2]$上均匀分布的随机变量。其概率密度函数为当 $\\epsilon \\in [-\\Delta\\theta/2, \\Delta\\theta/2]$ 时 $p(\\epsilon) = 1/\\Delta\\theta$，否则为 $0$。\n均方误差 (MSE)，记为 $E(\\Delta\\theta)$，是此误差分布的二阶矩。由于该分布的均值为零，MSE 等于其方差。\n$$ E(\\Delta\\theta) = E[\\epsilon^2] = \\int_{-\\Delta\\theta/2}^{\\Delta\\theta/2} \\epsilon^2 p(\\epsilon) \\, d\\epsilon = \\frac{1}{\\Delta\\theta} \\int_{-\\Delta\\theta/2}^{\\Delta\\theta/2} \\epsilon^2 \\, d\\epsilon $$\n$$ E(\\Delta\\theta) = \\frac{1}{\\Delta\\theta} \\left[ \\frac{\\epsilon^3}{3} \\right]_{-\\Delta\\theta/2}^{\\Delta\\theta/2} = \\frac{1}{3\\Delta\\theta} \\left( \\left(\\frac{\\Delta\\theta}{2}\\right)^3 - \\left(-\\frac{\\Delta\\theta}{2}\\right)^3 \\right) = \\frac{1}{3\\Delta\\theta} \\left( 2 \\frac{(\\Delta\\theta)^3}{8} \\right) = \\frac{(\\Delta\\theta)^2}{12} $$\n\n步骤 3：漏峰概率及约束\n\n“漏峰事件”被定义为没有任何网格点落入宽度为 $W_\\theta(\\theta)$ 的主瓣捕获区间内。这只在网格间距 $\\Delta\\theta$ 大于该区间宽度 $W_\\theta(\\theta)$ 时才可能发生。假定该区间的中心相对于网格是均匀分布的，则漏检的概率由下式给出\n$$ P_{\\text{miss}}(\\Delta\\theta, \\theta) = \\frac{\\max(0, \\Delta\\theta - W_\\theta(\\theta))}{\\Delta\\theta} = \\max\\left(0, 1 - \\frac{W_\\theta(\\theta)}{\\Delta\\theta}\\right) $$\n问题要求找到在“$\\theta \\in [-\\Theta_{\\max}, \\Theta_{\\max}]$ 上的最坏情况”下的概率。随着主瓣宽度 $W_\\theta(\\theta)$ 的减小，漏峰概率增加。最窄的主瓣出现在 $|\\cos\\theta|$ 最大处，即 $\\theta=0$（法向）。\n最小主瓣宽度为 $W_{\\theta, \\min} = W_\\theta(0) = 4/N$。\n因此，最坏情况（最大）漏峰概率为\n$$ P_{\\text{miss, wc}}(\\Delta\\theta) = \\sup_{\\theta \\in [-\\Theta_{\\max}, \\Theta_{\\max}]} P_{\\text{miss}}(\\Delta\\theta, \\theta) = \\max\\left(0, 1-\\frac{W_{\\theta, \\min}}{\\Delta\\theta}\\right) = \\max\\left(0, 1-\\frac{4/N}{\\Delta\\theta}\\right) $$\n“无漏峰要求”是 $P_{\\text{miss, wc}}(\\Delta\\theta) = 0$。这施加了如下约束：\n$$ 1-\\frac{4/N}{\\Delta\\theta} \\le 0 \\implies \\Delta\\theta \\le \\frac{4}{N} $$\n\n步骤 4：优化问题\n\n我们的任务是在推导出的约束条件下，最小化目标函数 $J(\\Delta\\theta)$。该问题是：\n$$ \\min_{\\Delta\\theta > 0} J(\\Delta\\theta) = \\frac{2c_0\\Theta_{\\max}}{\\Delta\\theta} + \\frac{(\\Delta\\theta)^2}{12} \\quad \\text{s.t.} \\quad \\Delta\\theta \\le \\frac{4}{N} $$\n首先，我们通过将 $J(\\Delta\\theta)$ 对 $\\Delta\\theta$ 的导数设为零，来找到无约束最小值：\n$$ \\frac{\\mathrm{d}J}{\\mathrm{d}(\\Delta\\theta)} = -\\frac{2c_0\\Theta_{\\max}}{(\\Delta\\theta)^2} + \\frac{2\\Delta\\theta}{12} = -\\frac{2c_0\\Theta_{\\max}}{(\\Delta\\theta)^2} + \\frac{\\Delta\\theta}{6} $$\n将导数设为零，得到：\n$$ \\frac{\\Delta\\theta}{6} = \\frac{2c_0\\Theta_{\\max}}{(\\Delta\\theta)^2} \\implies (\\Delta\\theta)^3 = 12c_0\\Theta_{\\max} $$\n无约束最优间距为 $\\Delta\\theta_{\\text{unc}} = (12c_0\\Theta_{\\max})^{1/3}$。\n二阶导数 $\\frac{\\mathrm{d}^2J}{\\mathrm{d}(\\Delta\\theta)^2} = \\frac{4c_0\\Theta_{\\max}}{(\\Delta\\theta)^3} + \\frac{1}{6}$ 在 $\\Delta\\theta > 0$ 时为正，这证实了它是一个最小值。\n\n函数 $J(\\Delta\\theta)$ 在 $\\Delta\\theta < \\Delta\\theta_{\\text{unc}}$ 时递减，在 $\\Delta\\theta > \\Delta\\theta_{\\text{unc}}$ 时递增。因此，通过将 $\\Delta\\theta_{\\text{unc}}$ 与约束边界 $4/N$ 进行比较，可以找到有约束问题的解。\n$$ \\Delta\\theta^\\star = \\min\\left(\\Delta\\theta_{\\text{unc}}, \\frac{4}{N}\\right) = \\min\\left( (12c_0\\Theta_{\\max})^{1/3}, \\frac{4}{N} \\right) $$\n\n步骤 5：数值计算\n\n我们代入给定值：$N=64$，$\\Theta_{\\max}=\\pi/3$ 和 $c_0=10^{-6}$。\n首先，计算约束边界：\n$$ \\frac{4}{N} = \\frac{4}{64} = \\frac{1}{16} = 0.0625 \\text{ 弧度} $$\n接下来，计算无约束最小化器：\n$$ \\Delta\\theta_{\\text{unc}} = (12 \\times 10^{-6} \\times \\frac{\\pi}{3})^{1/3} = (4\\pi \\times 10^{-6})^{1/3} $$\n使用 $\\pi \\approx 3.14159265$:\n$$ \\Delta\\theta_{\\text{unc}} = (4 \\times 3.14159265 \\times 10^{-6})^{1/3} = (12.56637 \\times 10^{-6})^{1/3} \\approx 0.023248 \\text{ 弧度} $$\n比较这两个值：\n$$ \\Delta\\theta_{\\text{unc}} \\approx 0.023248 < 0.0625 = \\frac{4}{N} $$\n由于无约束最小值位于无漏峰约束定义的可行域内，因此它就是最优解。\n$$ \\Delta\\theta^\\star = \\Delta\\theta_{\\text{unc}} \\approx 0.023248 \\text{ 弧度} $$\n问题要求将结果四舍五入到四位有效数字。\n$$ \\Delta\\theta^\\star \\approx 0.02325 \\text{ 弧度} $$\n在给定的建模假设下，这是最优的网格间距，它在保证网格搜索不会漏掉任何谱峰的同时，最小化了计算和离散化误差的总成本。", "answer": "$$\\boxed{0.02325}$$", "id": "2866495"}]}