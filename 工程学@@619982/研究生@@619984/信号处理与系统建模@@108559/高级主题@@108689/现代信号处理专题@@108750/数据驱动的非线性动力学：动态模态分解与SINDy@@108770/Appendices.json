{"hands_on_practices": [{"introduction": "动态模态分解（DMD）的一个强大应用是仅从单个时间序列的测量中重建系统的状态空间动力学。这个过程的核心问题是确定动力系统的基本维度。本练习将引导你通过一个基本但极其重要的思想实验，推导从一个简单的振荡信号中唯一确定其频率所需的最小延迟数，并将此与汉克尔（Hankel）矩阵的秩直接联系起来。", "problem": "您观察到一个由单一正弦波与加性噪声生成的实值、均匀采样的时间序列，\n$$y_k = A \\cos(\\omega k \\Delta t + \\phi) + \\eta_k,$$\n其中 $A \\neq 0$, $\\omega \\in \\mathbb{R}$, $\\Delta t > 0$, $\\phi \\in \\mathbb{R}$，且 $\\{\\eta_k\\}$ 是一个均值为零、方差有限的扰动。假设为非简并振荡情况，其中离散时间弧度频率 $\\theta := \\omega \\Delta t$ 满足 $\\theta \\not\\equiv 0 \\ (\\mathrm{mod}\\ 2\\pi)$ 且 $\\theta \\not\\equiv \\pi \\ (\\mathrm{mod}\\ 2\\pi)$。您从 $N$ 个样本构建一个具有 $m$ 个延迟的汉克尔矩阵，\n$$\\mathbf{H} = \n\\begin{bmatrix}\ny_0 & y_1 & \\cdots & y_{N-m} \\\\\ny_1 & y_2 & \\cdots & y_{N-m+1} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\ny_{m-1} & y_m & \\cdots & y_{N-1}\n\\end{bmatrix} \\in \\mathbb{R}^{m \\times (N-m+1)},$$\n并应用汉克尔动态模态分解（延迟嵌入动态模态分解），该方法旨在寻找一个将延迟嵌入状态向前推进一个时间步的线性映射。仅从正弦波的复指数基本表示和汉克尔矩阵的定义出发，推导无噪声信号满足的最小线性递推阶数，并用它来确定汉克尔动态模态分解在噪声趋于零的极限情况下唯一确定振荡频率 $\\omega$ 所需的最小延迟数 $m$。明确地将这个最小 $m$ 与无噪声汉克尔矩阵的秩联系起来。陈述您所使用的关于潜在模态的独特性和采样的任何假设。以最小整数 $m$ 的形式提供您的最终答案；无需四舍五入，也无需单位。", "solution": "对问题陈述进行验证。\n\n步骤1：提取已知条件\n- 观测到的时间序列为 $y_k = A \\cos(\\omega k \\Delta t + \\phi) + \\eta_k$。\n- 参数为 $A \\neq 0$、$\\omega \\in \\mathbb{R}$、$\\Delta t > 0$、$\\phi \\in \\mathbb{R}$。\n- 噪声 $\\{\\eta_k\\}$ 是一个均值为零、方差有限的扰动。\n- 离散时间弧度频率定义为 $\\theta := \\omega \\Delta t$。\n- 假设为非简并振荡情况，其中 $\\theta \\not\\equiv 0 \\ (\\mathrm{mod}\\ 2\\pi)$ 且 $\\theta \\not\\equiv \\pi \\ (\\mathrm{mod}\\ 2\\pi)$。\n- 一个汉克尔矩阵 $\\mathbf{H} \\in \\mathbb{R}^{m \\times (N-m+1)}$ 由 $N$ 个样本 $\\{y_k\\}_{k=0}^{N-1}$ 构建而成，具有 $m$ 个延迟。该矩阵由下式给出：\n$$ \\mathbf{H} = \n\\begin{bmatrix}\ny_0 & y_1 & \\cdots & y_{N-m} \\\\\ny_1 & y_2 & \\cdots & y_{N-m+1} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\ny_{m-1} & y_m & \\cdots & y_{N-1}\n\\end{bmatrix} $$\n- 任务是推导无噪声信号的最小线性递推阶数，并用它来找到在噪声趋于零的极限情况下，汉克尔DMD唯一确定 $\\omega$ 所需的最小延迟数 $m$，并将这个最小 $m$ 与无噪声汉克尔矩阵的秩联系起来。\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，植根于信号处理和系统辨识等成熟领域。带有加性噪声的正弦波模型是一个典型问题。使用汉克尔矩阵和延迟嵌入进行系统辨识是一项基本技术（与Takens嵌入定理以及ESPRIT和DMD等方法相关）。该问题是客观的，使用了精确的数学语言。关于 $\\theta$ 的条件对于确保系统是具有不同模态的真正振荡至关重要，这是在此背景下问题适定的必要条件。该问题并非不完整，因为它要求推导中间步骤（最小递推阶数）才能得出最终答案。该问题并非简单，因为它要求在信号结构、其递推关系、其关联的汉克尔矩阵的秩以及辨识所需的最小状态空间维度之间建立正确的逻辑联系。该问题是有效的。\n\n开始解题。\n\n问题要求在噪声趋于零的极限情况下的行为，因此我们分析无噪声信号 $x_k = A \\cos(\\omega k \\Delta t + \\phi)$。首先，按照指示，我们使用欧拉公式将这个实值正弦波表示为复指数的和。\n令 $\\theta = \\omega \\Delta t$。信号为：\n$$ x_k = A \\left( \\frac{\\exp(i(k \\theta + \\phi)) + \\exp(-i(k \\theta + \\phi))}{2} \\right) $$\n$$ x_k = \\left( \\frac{A \\exp(i\\phi)}{2} \\right) \\exp(ik\\theta) + \\left( \\frac{A \\exp(-i\\phi)}{2} \\right) \\exp(-ik\\theta) $$\n这是一个形如 $x_k = c_1 \\lambda_1^k + c_2 \\lambda_2^k$ 的信号，其中模态为 $\\lambda_1 = \\exp(i\\theta)$ 和 $\\lambda_2 = \\exp(-i\\theta)$，系数为 $c_1 = \\frac{A}{2}\\exp(i\\phi)$ 和 $c_2 = \\overline{c_1}$。由于 $A \\neq 0$，所以 $c_1$ 和 $c_2$ 均不为零。\n\n一个由 $p$ 个不同指数项线性组合而成的信号，满足一个唯一的最小阶为 $p$ 的线性常系数递推关系。我们必须确定模态 $\\lambda_1$ 和 $\\lambda_2$ 是否不同。如果 $\\exp(i\\theta) = \\exp(-i\\theta)$，即 $\\exp(i2\\theta) = 1$，则模态相等。这发生在 $2\\theta$ 是 $2\\pi$ 的整数倍时，即 $2\\theta = 2n\\pi$ (其中 $n \\in \\mathbb{Z}$)，可简化为 $\\theta = n\\pi$。问题陈述明确给出了非简并条件，即 $\\theta \\not\\equiv 0 \\ (\\mathrm{mod}\\ 2\\pi)$ 且 $\\theta \\not\\equiv \\pi \\ (\\mathrm{mod}\\ 2\\pi)$。这等价于说 $\\theta$ 不是 $\\pi$ 的整数倍。因此，$\\lambda_1 \\neq \\lambda_2$，模态是不同的。\n\n由于信号由两个不同的模态组成，所以最小线性递推阶数为 $p=2$。该递推关系的特征多项式的根是 $\\lambda_1$ 和 $\\lambda_2$。\n$$ P(z) = (z - \\lambda_1)(z - \\lambda_2) = z^2 - (\\lambda_1 + \\lambda_2)z + \\lambda_1\\lambda_2 = 0 $$\n系数为：\n$$ \\lambda_1 + \\lambda_2 = \\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta) $$\n$$ \\lambda_1 \\lambda_2 = \\exp(i\\theta)\\exp(-i\\theta) = 1 $$\n特征多项式为 $z^2 - 2\\cos(\\theta)z + 1 = 0$。这对应于线性递推关系：\n$$ x_{k+2} - 2\\cos(\\theta)x_{k+1} + x_k = 0 $$\n这个关系表明，无噪声信号的任何三个连续样本都是线性相关的。\n\n现在，我们将其与汉克尔矩阵联系起来。设 $\\mathbf{X}$ 是无噪声信号 $x_k$ 的汉克尔矩阵。其列是延迟向量 $\\mathbf{x}_j = [x_j, x_{j+1}, \\dots, x_{j+m-1}]^T$。每个列向量都可以表示为与模态相关的两个固定范德蒙向量的线性组合：\n$$ \\mathbf{x}_j = c_1 \\lambda_1^j \\begin{pmatrix} 1 \\\\ \\lambda_1 \\\\ \\vdots \\\\ \\lambda_1^{m-1} \\end{pmatrix} + c_2 \\lambda_2^j \\begin{pmatrix} 1 \\\\ \\lambda_2 \\\\ \\vdots \\\\ \\lambda_2^{m-1} \\end{pmatrix} $$\n$\\mathbf{X}$ 的整个列空间由这两个范德蒙向量张成。由于 $\\lambda_1 \\neq \\lambda_2$，只要 $m \\ge 2$，这两个向量就是线性无关的。根据Kronecker定理，无限汉克尔矩阵的秩等于生成信号中不同指数模态的数量。对于一个有限汉克尔矩阵 $\\mathbf{X} \\in \\mathbb{R}^{m \\times (N-m+1)}$，只要维度足够，即 $m \\ge 2$ 且列数 $N-m+1 \\ge 2$，其秩就为 $2$。\n\n汉克尔DMD旨在找到一个线性算子，用于建模延迟嵌入状态 $\\mathbf{x}_k \\in \\mathbb{R}^{m}$ 的演化过程。这个延迟向量的维度 $m$ 必须足够大才能嵌入动力学。为了捕捉一个潜在状态空间维度为 $r$ 的系统，嵌入维度 $m$ 必须至少为 $r$。在这里，无噪声数据矩阵的秩为 $r=2$，代表一个二维系统（一对复共轭模态）。因此，延迟数 $m$ 必须至少为 $2$。\n\n让我们检查充分性。\n如果 $m=1$，状态是一个标量 $x_k$。模型是 $x_{k+1} = a x_k$。这只能为一个实模态建模，而不能为产生振荡的复共轭对建模。所以，$m=1$ 是不够的。\n\n如果 $m=2$，状态是 $\\mathbf{x}_k = [x_k, x_{k+1}]^T$。单步演化为 $\\mathbf{x}_{k+1} = [x_{k+1}, x_{k+2}]^T$。我们寻求一个算子 $\\mathbf{A}$ 使得 $\\mathbf{x}_{k+1} = \\mathbf{A}\\mathbf{x}_k$。\n$$ \\begin{pmatrix} x_{k+1} \\\\ x_{k+2} \\end{pmatrix} = \\mathbf{A} \\begin{pmatrix} x_k \\\\ x_{k+1} \\end{pmatrix} $$\n第一行意味着 $x_{k+1} = A_{11}x_k + A_{12}x_{k+1}$，这要求 $A_{11}=0$ 且 $A_{12}=1$。\n第二行是 $x_{k+2} = A_{21}x_k + A_{22}x_{k+1}$。从我们的递推关系可知，$x_{k+2} = -x_k + 2\\cos(\\theta)x_{k+1}$。\n因此，唯一的线性算子是友矩阵：\n$$ \\mathbf{A} = \\begin{pmatrix} 0 & 1 \\\\ -1 & 2\\cos(\\theta) \\end{pmatrix} $$\n该算子 $\\mathbf{A}$ 的特征值可以通过特征方程 $\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = \\lambda^2 - 2\\cos(\\theta)\\lambda + 1 = 0$ 求得，其解为 $\\lambda = \\exp(\\pm i\\theta)$。这些恰好是潜在系统的模态。\n汉克尔DMD作用于由 $\\mathbf{x}_k$ 形成的数据矩阵，将计算出该矩阵 $\\mathbf{A}$ 的一个近似。计算出的算子的特征值将近似于 $\\exp(\\pm i\\theta)$，由此可以唯一确定 $\\theta = \\omega\\Delta t$ 并进而确定频率 $\\omega$（在没有进一步信息的情况下，其符号在物理上是不明确的）。\n\n因此，$m=2$ 足以捕捉该动力学。由于 $m=1$ 不足，所以所需的最小延迟数为 $m=2$。这个最小的 $m$ 值等于信号的最小线性递推阶数，也等于无噪声汉克尔矩阵的秩（假设数据充分）。对采样的假设是，样本数 $N$ 足够大，以使DMD中使用的矩阵具有正确的秩，这最低要求 $N-m+1 \\geq 2$。对于 $m=2$，这意味着 $N \\geq 3$，这是一个微不足道的要求。", "answer": "$$\n\\boxed{2}\n$$", "id": "2862877"}, {"introduction": "稀疏非线性动力学辨识（SINDy）的成功在很大程度上依赖于其核心的稀疏回归步骤。然而，当候选函数库中的特征具有不同的物理单位和数量级时，像序列阈值化最小二乘法（STLSQ）这样的算法的性能会受到严重影响。本练习探讨了特征归一化在确保物理一致性和数值鲁棒性方面的重要性，并要求你推导归一化如何改变稀疏化过程中阈值的有效作用。", "problem": "您正在使用非线性动力学稀疏辨识 (SINDy) 方法对一个状态为 $x(t)$ 的单态连续时间系统进行建模。您收集了快照对 $\\{x(t_k), \\dot{x}(t_k)\\}_{k=1}^{m}$，并构建了一个库矩阵 $\\Theta(X) \\in \\mathbb{R}^{m \\times p}$（其列由 $x$ 的候选函数组成）和一个包含 $\\dot{x}(t_k)$ 的目标向量 $y \\in \\mathbb{R}^{m}$。对于每个状态，SINDy 求解一个形如 $y \\approx \\Theta(X)\\,\\xi$ 的线性回归问题，并使用序列阈值最小二乘 (STLSQ) 算法。该算法在一个阈值的基础上，在最小二乘估计和对 $\\xi$ 的元素进行硬阈值化之间交替进行。\n\n为了使 STLSQ 中的阈值化在面对具有不同物理单位和量级的特征时具有物理意义和稳健性，您决定用一个对角矩阵 $S = \\mathrm{diag}(s_1,\\dots,s_p)$ 来重缩放 $\\Theta(X)$ 的列，以形成一个归一化库 $Z = \\Theta(X)\\,S^{-1}$。您的设计要求是，归一化应满足：(i) 通过除以基于每个特征的量纲和为数据集选择的特征基本单位尺度而确定的适当特征单位尺度，来消除 $Z$ 的每一列的单位；(ii) 通过将现在已无量纲的每一列除以其在 $m$ 个快照上的样本标准差，来平衡其量级。完成此归一化后，您在 STLSQ 中对与归一化库相关的系数应用单个硬阈值 $\\Lambda$。\n\n仅从最小二乘回归和硬阈值化的定义出发，完成以下任务：\n\n1) 以闭式形式推导系数向量在列缩放 $S$ 下如何变化，以及施加于归一化系数的单个硬阈值 $\\Lambda$ 如何转化为对原始未缩放系数的依赖于特征的有效硬阈值。您的推导必须从最小二乘法的正规方程、硬阈值化的定义以及预测在列重缩放下的线性代数不变性出发，不得假定任何连接重缩放和阈值的已知公式。\n\n2) 考虑一个具体案例，从一个包含两列 $[x, x^2]$ 的库来为 $\\dot{x}(t)$ 建模。状态量 $x$ 以米为单位。您选择一个特征长度尺度 $L_{\\mathrm{c}} = 2\\,\\mathrm{m}$ 来对 $x$ 进行无量纲化，并估计出无量纲列在 $m$ 个快照上的样本标准差如下：$\\mathrm{std}(x/L_{\\mathrm{c}}) = 0.80$ 和 $\\mathrm{std}((x/L_{\\mathrm{c}})^2) = 0.70$。您决定在对与归一化库 $Z$ 相关的系数进行阈值化时，使用单个硬阈值 $\\Lambda = 0.15\\,\\mathrm{m/s}$。\n\n根据您在第 1) 部分中推导的表达式，作用于乘以 $x^2$ 列的未缩放系数的有效硬阈值是多少？请以 $\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1}$ 为单位表示最终数值，并将答案四舍五入到四位有效数字。", "solution": "所述问题在科学上是成立的、适定的、客观的且内部一致的。它在数据驱动的动力系统建模这一成熟领域内，特别是在 SINDy 算法的实际应用方面，提出了一个有效的问题。所提供的信息足以得出一个完整且唯一的解。因此，我将着手进行推导和计算。\n\n该问题的核心在于理解特征空间（库矩阵的列）的线性变换如何影响线性回归模型中的系数，并进而影响对这些系数应用硬阈值化等非线性操作。\n\n设未缩放的回归问题为\n$$ y \\approx \\Theta \\xi $$\n其中 $y \\in \\mathbb{R}^{m}$ 是时间导数向量，$\\Theta \\in \\mathbb{R}^{m \\times p}$ 是候选函数的库，$\\xi \\in \\mathbb{R}^{p}$ 是我们试图辨识的系数向量。普通最小二乘估计 $\\xi_{LS}$ 最小化残差的欧几里得范数平方 $\\|y - \\Theta \\xi\\|_{2}^{2}$，可通过求解正规方程得到：\n$$ \\Theta^{T} \\Theta \\xi_{LS} = \\Theta^{T} y $$\n\n问题引入了一个缩放后的库 $Z = \\Theta S^{-1}$，其中 $S = \\mathrm{diag}(s_1, \\dots, s_p)$ 是一个对角缩放因子矩阵。现在，回归是针对缩放库的一个新系数向量 $\\zeta \\in \\mathbb{R}^{p}$ 进行的：\n$$ y \\approx Z \\zeta $$\n$\\zeta$ 的最小二乘解，我们将其记为 $\\zeta_{LS}$，由相应的正规方程给出：\n$$ Z^{T} Z \\zeta_{LS} = Z^{T} y $$\n\n所辨识的物理模型与为库选择的基无关。因此，预测必须在这种重缩放下保持不变：\n$$ \\Theta \\xi = Z \\zeta $$\n代入 $Z = \\Theta S^{-1}$ 的定义，我们有：\n$$ \\Theta \\xi = (\\Theta S^{-1}) \\zeta $$\n假设 $\\Theta$ 的列是线性无关的（这是适定最小二乘问题的一个标准要求，意味着 $\\Theta^{T} \\Theta$ 是可逆的），我们可以通过左乘 $(\\Theta^{T} \\Theta)^{-1} \\Theta^{T}$ 来找到系数向量之间的唯一关系：\n$$ \\xi = S^{-1} \\zeta $$\n或者，等价地：\n$$ \\zeta = S \\xi $$\n这直接显示了系数向量在库的列缩放下的变换方式。缩放后的系数向量的第 $j$ 个分量 $\\zeta_j$ 与未缩放向量的第 $j$ 个分量 $\\xi_j$ 通过 $\\zeta_j = s_j \\xi_j$ 相关联。\n\n现在，我们考虑在序列阈值最小二乘 (STLSQ) 算法中使用的硬阈值化步骤。将单个阈值 $\\Lambda$ 应用于与归一化库 $Z$ 相关的系数向量 $\\zeta$ 的分量。如果系数 $\\zeta_j$ 的绝对值小于阈值，则将其设为零：\n$$ \\text{Set } \\zeta_j \\to 0 \\quad \\text{if} \\quad |\\zeta_j| < \\Lambda $$\n为了找到作用于原始未缩放系数 $\\xi_j$ 的等效的、依赖于特征的阈值，我们将关系式 $\\zeta_j = s_j \\xi_j$ 代入阈值化条件：\n$$ |s_j \\xi_j| < \\Lambda $$\n由于缩放因子 $s_j$ 是正实数（代表物理尺度和标准差），我们可以写出：\n$$ |\\xi_j| < \\frac{\\Lambda}{s_j} $$\n这表明，在缩放后的域中应用统一阈值 $\\Lambda$，等同于在原始未缩放域中应用一个依赖于特征的阈值 $\\lambda_j = \\Lambda/s_j$。至此，问题的第一部分完成。\n\n对于第二部分，我们必须将此结果应用于给定的具体案例。未缩放的库为 $\\Theta = [x, x^2]$，因此特征列为 $\\theta_1(x) = x$ 和 $\\theta_2(x) = x^2$。我们关心的是作用于乘以 $x^2$ 列的系数 $\\xi_2$ 的有效阈值。根据我们的推导，该有效阈值为 $\\lambda_2 = \\Lambda/s_2$。\n\n我们必须确定缩放因子 $s_2$。问题指出，归一化包含两个步骤。首先，使用特征尺度将特征无量纲化。其次，将得到的无量纲特征除以其样本标准差。\n\n第二列中的特征是 $\\theta_2 = x^2$。状态量 $x$ 的单位是米 ($\\mathrm{m}$)。因此，$\\theta_2$ 的单位是 $\\mathrm{m}^2$。\n1.  **无量纲化**：特征长度尺度为 $L_{\\mathrm{c}} = 2\\,\\mathrm{m}$。为了使 $x^2$ 无量纲化，我们必须用一个单位为 $\\mathrm{m}^2$ 的量去除它。使用 $L_c$，这个量就是 $L_c^2$。无量纲化的特征是 $\\left(\\frac{x}{L_{\\mathrm{c}}}\\right)^2$。\n2.  **量级平衡**：然后将得到的无量纲列除以其样本标准差。问题提供了这个值：$\\mathrm{std}((x/L_{\\mathrm{c}})^2) = 0.70$。\n\n结合这两个步骤，完全归一化的第二列 $z_2$ 为：\n$$ z_2 = \\frac{\\left(\\frac{x}{L_{\\mathrm{c}}}\\right)^2}{\\mathrm{std}\\left(\\left(\\frac{x}{L_{\\mathrm{c}}}\\right)^2\\right)} = \\frac{\\theta_2}{L_{\\mathrm{c}}^2 \\cdot \\mathrm{std}\\left(\\left(\\frac{x}{L_{\\mathrm{c}}}\\right)^2\\right)} $$\n根据缩放库的定义，我们有 $z_2 = \\theta_2 / s_2$。通过比较 $z_2$ 的两个表达式，我们确定缩放因子 $s_2$：\n$s_2 = L_{\\mathrm{c}}^2 \\cdot \\mathrm{std}\\left(\\left(\\frac{x}{L_{\\mathrm{c}}}\\right)^2\\right)$\n给定值为 $L_{\\mathrm{c}} = 2\\,\\mathrm{m}$ 和 $\\mathrm{std}((x/L_{\\mathrm{c}})^2) = 0.70$。我们现在可以计算 $s_2$ 的数值：\n$$ s_2 = (2\\,\\mathrm{m})^2 \\cdot 0.70 = 4\\,\\mathrm{m}^2 \\cdot 0.70 = 2.8\\,\\mathrm{m}^2 $$\n现在我们求有效阈值 $\\lambda_2$。给定缩放域中的阈值为 $\\Lambda = 0.15\\,\\mathrm{m/s}$。\n$$ \\lambda_2 = \\frac{\\Lambda}{s_2} = \\frac{0.15\\,\\mathrm{m/s}}{2.8\\,\\mathrm{m}^2} $$\n其数值为：\n$$ \\lambda_2 = \\frac{0.15}{2.8} \\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1} \\approx 0.0535714... \\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1} $$\n单位 $\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1}$ 与模型方程 $\\dot{x} = \\dots + \\xi_2 x^2$ 中系数 $\\xi_2$ 的单位是一致的，其中 $\\dot{x}$ 的单位是 $\\mathrm{m/s}$，$x^2$ 的单位是 $\\mathrm{m}^2$。\n按要求将结果四舍五入到四位有效数字，得到 $0.05357$。", "answer": "$$\n\\boxed{0.05357}\n$$", "id": "2862870"}, {"introduction": "构建一个数据驱动模型后，关键的下一步是验证其性能并调整其超参数，例如SINDy中的稀疏性阈值。对于来自单个动力学轨迹的时间序列数据，由于其内在的时间相关性，标准的交叉验证技术可能会产生误导性结果。本练习旨在评估你对正确验证方法的理解，要求你辨别出一种科学上合理的K折交叉验证流程，以避免信息泄露并为模型选择提供可靠的依据。", "problem": "给定一个确定性连续时间系统 $\\dot{x} = f(x)$（其中 $x \\in \\mathbb{R}^n$）在均匀时间间隔 $\\Delta t$ 下采样得到的单条测量轨迹 $\\{x(t_j)\\}_{j=0}^{N}$。您希望使用非线性动力学的稀疏辨识（SINDy）方法来辨识一个简约模型。该方法假设时间导数与一个候选函数库之间存在稀疏线性关系：拟合 $\\dot{X} \\approx \\Theta(X)\\Xi$，其中 $X \\in \\mathbb{R}^{(N+1)\\times n}$ 是堆叠的状态 $x(t_j)$，$\\dot{X} \\in \\mathbb{R}^{(N+1)\\times n}$ 是估计的导数，$\\Theta(X) \\in \\mathbb{R}^{(N+1)\\times p}$ 是一个特征库，$\\Xi \\in \\mathbb{R}^{p \\times n}$ 是稀疏系数。稀疏性由一个超参数控制（例如，序贯阈值最小二乘法中的阈值 $\\lambda$ 或 $\\ell_1$ 惩罚回归中的正则化权重 $\\alpha$）。您需要通过 $K$ 折交叉验证（CV）（其中 $K \\ge 2$ 是一个整数）在留出数据上最小化预测误差来选择这个超参数。这些数据具有时间相关性，并且来自单条轨迹。\n\n哪个选项描述了一种科学上合理的 SINDy 的 $K$ 折交叉验证程序，该程序通过在轨迹的留出段上最小化预测误差来选择阈值或正则化参数，同时尊重时间依赖性并避免信息泄露？\n\nA. 随机打乱所有时间索引，将它们分成 $K$ 折。对于每个候选超参数，在 $K-1$ 折上拟合 SINDy。在留出折上，计算回归目标 $\\dot{X}$ 与拟合的 $\\Theta(X)\\Xi$ 在验证样本上的均方误差。对各折的误差求平均，并选择使其最小化的超参数。不要对辨识出的模型进行仿真。\n\nB. 将轨迹划分为 $K$ 个长度大致相等的连续、不重叠的段。对于每个候选超参数以及每一折 $k \\in \\{1,\\dots,K\\}$，仅使用 $K-1$ 个训练段的数据来构建 $\\Theta(X)$、执行任何缩放并估计 $\\Xi$ 来拟合 SINDy。在留出的连续验证段上，从该段的第一个状态开始，使用相同的时间网格 $\\{t_j\\}$ 向前仿真辨识出的连续时间模型，获得预测值 $\\hat{x}(t_j)$，并计算状态预测误差（例如，平均平方范数 $\\frac{1}{M_k}\\sum_{j \\in \\text{val}(k)}\\|x(t_j)-\\hat{x}(t_j)\\|_2^2$）。对各折的验证误差求平均，并选择使其最小化的超参数。最后，使用选定的超参数在整个轨迹上重新拟合 SINDy。\n\nC. 对于每个候选超参数，在整个数据集上拟合一个动态模态分解（DMD）模型，并选择在训练数据上使决定系数最大化的超参数。使用所选值来正则化 SINDy，并报告其前推性能，无需重新拟合。\n\nD. 选择每第 $K$ 个样本索引作为验证集，其余样本用于训练。对于每个候选超参数，在训练样本上拟合 SINDy，并将在孤立的验证点上计算的单步欧拉预测误差 $x(t_{j+1}) - \\left[x(t_j) + \\Delta t\\,\\hat{f}(x(t_j))\\right]$ 作为验证误差。选择使该误差最小化的超参数，并保留拟合的模型，无需在所有数据上重新拟合。", "solution": "该问题要求在给定来自单条连续时间轨迹的数据的情况下，为非线性动力学的稀疏辨识（SINDy）算法确定一种科学上合理的 $K$ 折交叉验证（CV）程序，以选择超参数。数据的时间相关性是一个必须正确处理的关键特征。\n\nSINDy 模型表示为一个线性系统：\n$$\n\\dot{X} \\approx \\Theta(X)\\Xi\n$$\n其中 $\\dot{X} \\in \\mathbb{R}^{(N+1) \\times n}$ 是时间导数矩阵， $X \\in \\mathbb{R}^{(N+1) \\times n}$ 是状态矩阵，$\\Theta(X) \\in \\mathbb{R}^{(N+1) \\times p}$ 是在状态上求值的候选函数库，而 $\\Xi \\in \\mathbb{R}^{p \\times n}$ 是我们希望找到的稀疏系数矩阵。 $\\Xi$ 的稀疏性由一个超参数控制，例如阈值 $\\lambda$ 或正则化参数 $\\alpha$。目标是选择这个超参数。\n\n一个健全的时间序列数据交叉验证程序必须遵循两个基本原则：\n1.  **保持时间结构**：数据 $\\{x(t_j)\\}_{j=0}^{N}$ 不是独立同分布（i.i.d.）的。一个数据点 $x(t_j)$ 与其相邻点 $x(t_{j-1})$ 和 $x(t_{j+1})$ 强相关。任何在将数据点分割为训练集和验证集之前随机打乱它们的程序都是根本性错误的。这种打乱操作使得模型可以在紧邻验证点的点上进行训练，导致严重的 **信息泄露**。这会产生一个人为压低的、因此具有误导性的验证误差。正确的方法是将数据分割成 **连续的、不重叠的块（段）**。在 $K$ 折交叉验证的背景下，轨迹被划分为 $K$ 个这样的段。\n2.  **有意义的误差度量**：对于一个动力系统模型，最终目标是预测系统的未来演化。主要有两种类型的误差度量：\n    *   **回归误差**：衡量线性回归的拟合优度，例如 $\\|\\dot{X}_{\\text{val}} - \\Theta(X_{\\text{val}})\\Xi\\|_2^2$。这是关于导数的“单步”预测误差，是一种较弱的性能度量。一个模型可能在局部很好地拟合导数，但在随时间积分时可能不稳定或累积大量误差。\n    *   **仿真（前推）误差**：衡量真实轨迹与通过从一个初始条件积分辨识出的模型 $\\dot{\\hat{x}} = \\hat{f}(\\hat{x})$ 所预测的轨迹之间的差异。一个例子是验证轨迹上的均方误差：$\\frac{1}{M_k} \\sum_{j \\in \\text{val}(k)} \\|x(t_j) - \\hat{x}(t_j)\\|_2^2$，其中 $M_k$ 是验证折 $k$ 中的点数。这是一个更严格且更具实际意义的度量，因为它评估了模型捕捉长期动态的能力。\n\n基于这些原则，一个合理的程序如下：对于每个候选超参数，遍历 $K$ 折。在每次迭代中，使用 $K-1$ 个连续段进行训练，剩下的一个用于验证。仅使用训练数据来训练模型（即，找到 $\\Xi$）。然后，将验证段的第一个状态作为初始条件，并在该段的持续时间内仿真辨识出的模型。计算与验证段中真实数据的仿真误差。将此误差在 $K$ 折上平均。选择产生最小平均仿真误差的超参数。最后，使用最优超参数在整个数据集上重新拟合模型，以产生最终模型。\n\n现在，我们逐一评估每个选项。\n\n**A. 随机打乱所有时间索引，将它们分成 $K$ 折。对于每个候选超参数，在 $K-1$ 折上拟合 SINDy。在留出折上，计算回归目标 $\\dot{X}$ 与拟合的 $\\Theta(X)\\Xi$ 在验证样本上的均方误差。对各折的误差求平均，并选择使其最小化的超参数。不要对辨识出的模型进行仿真。**\n该选项包含两个关键缺陷。首先，它明确建议“随机打乱所有时间索引”，这违反了数据的时间依赖性并导致信息泄露，使得验证结果不可靠。其次，它使用导数上的回归误差（$\\dot{X}$ vs. $\\Theta(X)\\Xi$），这对于模型随时间推移的预测能力来说是一个很差的代理指标。\n结论：**不正确**。\n\n**B. 将轨迹划分为 $K$ 个长度大致相等的连续、不重叠的段。对于每个候选超参数以及每一折 $k \\in \\{1,\\dots,K\\}$，仅使用 $K-1$ 个训练段的数据来构建 $\\Theta(X)$、执行任何缩放并估计 $\\Xi$ 来拟合 SINDy。在留出的连续验证段上，从该段的第一个状态开始，使用相同的时间网格 $\\{t_j\\}$ 向前仿真辨识出的连续时间模型，获得预测值 $\\hat{x}(t_j)$，并计算状态预测误差（例如，平均平方范数 $\\frac{1}{M_k}\\sum_{j \\in \\text{val}(k)}\\|x(t_j)-\\hat{x}(t_j)\\|_2^2$）。对各折的验证误差求平均，并选择使其最小化的超参数。最后，使用选定的超参数在整个轨迹上重新拟合 SINDy。**\n此程序在科学上是合理的。它正确地使用“连续、不重叠的段”来尊重时间数据结构，避免了信息泄露。它采用了最有意义的性能度量：验证段上的仿真（前推）误差，这直接评估了模型预测系统演化的能力。它正确地指明了所有训练步骤，包括缩放，都仅在训练数据上执行。最后，它包含了使用选定超参数在所有数据上重新拟合模型以获得最佳最终模型的关键步骤。这代表了从时间序列数据对动力系统模型进行交叉验证的最佳实践。\n结论：**正确**。\n\n**C. 对于每个候选超参数，在整个数据集上拟合一个动态模态分解（DMD）模型，并选择在训练数据上使决定系数最大化的超参数。使用所选值来正则化 SINDy，并报告其前推性能，无需重新拟合。**\n该选项不合逻辑。它将 SINDy 与 DMD 混淆，而 DMD 是一个具有不同超参数的不同算法。使用 DMD 拟合来调整 SINDy 的超参数是毫无意义的。此外，它主张根据在训练数据（“在整个数据集上”）上的性能来选择超参数，这是导致过拟合而非验证的方法。所描述的程序不是一种交叉验证形式。\n结论：**不正确**。\n\n**D. 选择每第 $K$ 个样本索引作为验证集，其余样本用于训练。对于每个候选超参数，在训练样本上拟合 SINDy，并将在孤立的验证点上计算的单步欧拉预测误差 $x(t_{j+1}) - \\left[x(t_j) + \\Delta t\\,\\hat{f}(x(t_j))\\right]$ 作为验证误差。选择使该误差最小化的超参数，并保留拟合的模型，无需在所有数据上重新拟合。**\n该选项存在缺陷。选择“每第 $K$ 个样本”（也称为跨步或交错采样）并未在时间意义上将验证集与训练集恰当隔离。验证点的邻居在训练集中，这会导致信息泄露，尤其是在使用有限差分计算导数时。其误差度量，即“单步欧拉预测误差”，是一个较弱的短期度量，不能保证良好的长期仿真性能。最后，在选择超参数后不在所有数据上重新拟合模型是对可用数据的次优使用。\n结论：**不正确**。", "answer": "$$\\boxed{B}$$", "id": "2862861"}]}