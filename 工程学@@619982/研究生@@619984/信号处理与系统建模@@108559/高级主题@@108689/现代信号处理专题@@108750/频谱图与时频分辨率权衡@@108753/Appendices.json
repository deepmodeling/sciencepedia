{"hands_on_practices": [{"introduction": "本练习旨在通过一个基本问题来巩固我们对语谱图的理解：语谱图中的一个数值究竟衡量的是什么？通过推导其物理单位并理解如何将其转换为常见的对数（$dB$）标度，您将把短时傅里叶变换（STFT）的数学定义与功率谱密度的物理概念联系起来。这项基础技能对于正确解读任何时频分析图谱至关重要。[@problem_id:2914026]", "problem": "一个实值电压信号 $x(t)$ 以伏特为单位，时间 $t$ 以秒为单位。考虑其使用分析窗 $g(t)$ 的短时傅里叶变换 (STFT)，其定义使用频率变量 $f$（单位为赫兹），如下所示：\n$$\nX_g(t,f) \\equiv \\int_{-\\infty}^{\\infty} x(\\tau)\\, g^{\\ast}(\\tau - t)\\, \\exp(-j 2\\pi f \\tau)\\, d\\tau,\n$$\n以及相应的谱图\n$$\nS_x(t,f) \\equiv \\frac{|X_g(t,f)|^2}{E_g}, \\quad \\text{其中} \\quad E_g \\equiv \\int_{-\\infty}^{\\infty} |g(\\tau)|^2\\, d\\tau.\n$$\n假设 $g(t)$ 是无量纲的，并仅使用给定的定义、量纲一致性以及标准的双边变换约定 $\\exp(-j 2\\pi f t)$。\n\n任务：\n- 从这些定义出发，用伏特和秒来表示并推导 $S_x(t,f)$ 的物理单位。通过将频率积分 $\\int S_x(t,f)\\, df$ 与瞬时信号能量的加窗平均值相关联，来解释你的结果。\n- 然后，采用一个参考谱密度 $S_{\\mathrm{ref}}$，其值等于常数 $1$ 且单位与 $S_x(t,f)$ 相同（即，当 $S_x$ 的数值以 $\\mathrm{V}^2/\\mathrm{Hz}$ 表示时，$S_{\\mathrm{ref}} = 1$）。使用针对类功率量的常规分贝 (dB) 映射，提供一个单一的封闭形式解析表达式，将 $S_x(t,f)$ 映射到一个以 $S_{\\mathrm{ref}}$ 为参考的分贝值谱图 $L_{\\mathrm{dB}}(t,f)$。\n\n你的最终答案必须仅为以 $S_x(t,f)$ 和 $S_{\\mathrm{ref}}$ 表示的 $L_{\\mathrm{dB}}(t,f)$ 的单一表达式，最终的方框表达式内不得包含任何单位。不要进行四舍五入或近似计算。", "solution": "如上所述，该问题具有科学依据，提法恰当且客观。它基于信号处理的标准定义，并要求应用量纲分析和傅里叶理论的基本原理。所有必要信息均已提供，任务明确。我们可以开始求解。\n\n根据要求，分析分为两部分：首先，推导谱图的物理单位并给出其物理解释；其次，构建分贝值谱图的公式。\n\n首先，我们确定谱图 $S_x(t,f)$ 的单位。这需要对其组成部分进行量纲分析，从短时傅里叶变换 (STFT) $X_g(t,f)$ 开始。其定义为：\n$$\nX_g(t,f) \\equiv \\int_{-\\infty}^{\\infty} x(\\tau)\\, g^{\\ast}(\\tau - t)\\, \\exp(-j 2\\pi f \\tau)\\, d\\tau\n$$\n我们分析积分内各项的单位。令 $[Q]$ 表示量 $Q$ 的单位。\n- 信号 $x(t)$ 是电压，所以 $[x(\\tau)] = \\mathrm{V}$ (伏特)。\n- 分析窗 $g(t)$ 被明确说明是无量纲的，所以 $[g^{\\ast}(\\tau - t)] = 1$。\n- 复指数项 $\\exp(-j 2\\pi f \\tau)$ 总是无量纲的，因为其参数必须是无量纲的。确实，$[f][\\tau] = \\mathrm{Hz} \\cdot \\mathrm{s} = (\\mathrm{s}^{-1}) \\cdot \\mathrm{s} = 1$。\n- 微分元是关于时间的，所以 $[d\\tau] = \\mathrm{s}$ (秒)。\n\n因此，被积函数的单位是 $[x(\\tau) g^{\\ast}(\\tau-t) \\exp(-j 2\\pi f \\tau)] = \\mathrm{V} \\cdot 1 \\cdot 1 = \\mathrm{V}$。对 $\\tau$ 的积分将这些单位乘以 $d\\tau$ 的单位。\n因此，STFT 的单位是：\n$$\n[X_g(t,f)] = \\mathrm{V} \\cdot \\mathrm{s}\n$$\n接下来，我们求窗能量 $E_g$ 的单位：\n$$\nE_g \\equiv \\int_{-\\infty}^{\\infty} |g(\\tau)|^2\\, d\\tau\n$$\n因为 $[g(\\tau)] = 1$，我们有 $[|g(\\tau)|^2] = 1^2 = 1$。对 $\\tau$ 的积分给出：\n$$\n[E_g] = 1 \\cdot \\mathrm{s} = \\mathrm{s}\n$$\n现在我们可以确定谱图 $S_x(t,f)$ 的单位：\n$$\nS_x(t,f) \\equiv \\frac{|X_g(t,f)|^2}{E_g}\n$$\n其单位为：\n$$\n[S_x(t,f)] = \\frac{[X_g(t,f)]^2}{[E_g]} = \\frac{(\\mathrm{V} \\cdot \\mathrm{s})^2}{\\mathrm{s}} = \\frac{\\mathrm{V}^2 \\cdot \\mathrm{s}^2}{\\mathrm{s}} = \\mathrm{V}^2 \\cdot \\mathrm{s}\n$$\n由于频率（单位赫兹, $\\mathrm{Hz}$）是时间（单位秒, $\\mathrm{s}$）的倒数（$\\mathrm{s} = 1/\\mathrm{Hz}$），我们可以将这些单位表示为：\n$$\n[S_x(t,f)] = \\mathrm{V}^2 / \\mathrm{Hz}\n$$\n这是功率谱密度的单位，这是对谱图的正确物理解释。\n\n其次，我们解释谱图的频率积分 $\\int_{-\\infty}^{\\infty} S_x(t,f)\\, df$ 的物理意义。我们首先代入 $S_x(t,f)$ 的定义：\n$$\n\\int_{-\\infty}^{\\infty} S_x(t,f)\\, df = \\int_{-\\infty}^{\\infty} \\frac{|X_g(t,f)|^2}{E_g}\\, df = \\frac{1}{E_g} \\int_{-\\infty}^{\\infty} |X_g(t,f)|^2\\, df\n$$\nSTFT $X_g(t,f)$ 是加窗信号段 $y_t(\\tau) = x(\\tau) g^*(\\tau-t)$ 关于 $\\tau$ 的傅里叶变换。即 $X_g(t,f) = \\mathcal{F}_{\\tau \\to f}\\{y_t(\\tau)\\}$。我们应用傅里叶变换的 Parseval 定理，该定理指出，对于给定的变换约定，有 $\\int_{-\\infty}^{\\infty} |Y(f)|^2\\, df = \\int_{-\\infty}^{\\infty} |y(\\tau)|^2\\, d\\tau$。将此应用于我们的情况：\n$$\n\\int_{-\\infty}^{\\infty} |X_g(t,f)|^2\\, df = \\int_{-\\infty}^{\\infty} |x(\\tau) g^*(\\tau-t)|^2\\, d\\tau = \\int_{-\\infty}^{\\infty} |x(\\tau)|^2 |g(\\tau-t)|^2\\, d\\tau\n$$\n由于问题陈述 $x(t)$ 是实值的，因此 $|x(\\tau)|^2 = x^2(\\tau)$。所以，谱图的频率积变为：\n$$\n\\int_{-\\infty}^{\\infty} S_x(t,f)\\, df = \\frac{1}{E_g} \\int_{-\\infty}^{\\infty} x^2(\\tau) |g(\\tau-t)|^2\\, d\\tau = \\frac{\\int_{-\\infty}^{\\infty} x^2(\\tau) |g(\\tau-t)|^2\\, d\\tau}{\\int_{-\\infty}^{\\infty} |g(\\tau')|^2\\, d\\tau'}\n$$\n量 $x^2(\\tau)$ 代表信号在时间 $\\tau$ 的瞬时功率（归一化到 1 欧姆电阻，单位为 $\\mathrm{V}^2$）。该表达式是此瞬时功率的加权平均，其中加权函数 $|g(\\tau-t)|^2$ 是一个以时间 $t$ 为中心的窗。分母 $E_g$ 是此平均值的归一化因子。因此，该积分代表了信号在时间 $t$ 附近的短时平均功率。单位与此解释相符：$[\\int S_x(t,f) df] = (\\mathrm{V}^2/\\mathrm{Hz}) \\cdot \\mathrm{Hz} = \\mathrm{V}^2$，这是平均功率（每欧姆）的单位。\n\n最后，我们推导分贝值谱图 $L_{\\mathrm{dB}}(t,f)$ 的表达式。对于一个类功率量 $P$，其相对于参考值 $P_{\\mathrm{ref}}$ 的分贝 (dB) 标度由公式 $10 \\log_{10}(P/P_{\\mathrm{ref}})$ 给出。\n谱图 $S_x(t,f)$ 代表功率谱密度，它是一个类功率量。我们给定了一个参考谱密度 $S_{\\mathrm{ref}}$。因此，到分贝的映射为：\n$$\nL_{\\mathrm{dB}}(t,f) = 10 \\log_{10} \\left( \\frac{S_x(t,f)}{S_{\\mathrm{ref}}} \\right)\n$$\n问题指明 $S_{\\mathrm{ref}}$ 的数值等于 $1$，单位与 $S_x(t,f)$ 相同。虽然我们可以将 $S_{\\mathrm{ref}}=1$ 代入表达式，但最完整和最正式的表示法保留了符号化的参考值，因为它明确了比率关系。问题要求提供一个以 $S_x(t,f)$ 和 $S_{\\mathrm{ref}}$ 表示的单一封闭形式表达式。这个表达式就是最终答案。", "answer": "$$\n\\boxed{10 \\log_{10}\\left(\\frac{S_x(t,f)}{S_{\\mathrm{ref}}}\\right)}\n$$", "id": "2914026"}, {"introduction": "时频分辨率的权衡关系通常很微妙，而像零填充这样的常见计算技巧可能会产生误导。这个实践问题将挑战您区分离散傅里叶变换（DFT）网格的表观分辨率与由分析窗决定的真实频谱分辨率。通过分析一个包含两个频率相近音调的场景，您将培养出一种实践直觉，理解为什么是窗函数长度 $L$——而非傅里叶变换点数 $N$——决定了我们分辨频率分量的能力。[@problem_id:2914032]", "problem": "一个离散时间信号以采样率 $F_{s} = 48000$ Hz 进行采样。使用长度为 $L = 1024$ 样本的 Hann 窗，每帧进行 $N = 8192$ 点的快速傅里叶变换 (FFT)（即用 $N - L$ 个零进行零填充），以及足够大的重叠（以使加窗主导时间分辨率），计算基于短时傅里叶变换 (STFT) 的谱图。考虑一个包含两个等幅纯音的帧，其频率分别为 $f_{1} = 10000$ Hz 和 $f_{2} = 10050$ Hz。\n\n仅使用关于离散傅里叶变换 (DFT) 频率采样网格和有限加窗对频谱集中的影响的基本定义，回答以下问题：\n\n1) 计算每个 STFT 帧中使用的 $N$ 点 DFT 的离散频率间隔。\n\n2) 评估以下关于频率分辨率和时频权衡的陈述。选择所有正确的陈述。\n\nA. 离散频率间隔等于 $F_{s}/N$，此处数值计算结果为 $5.859375$ Hz。\n\nB. 因为频率间隔小于音调的 $50$ Hz 间隔，所以这两个音调在经过零填充的 Hann 窗谱图中将能被清晰分辨。\n\nC. 对于长度为 $L$ 的 Hann 窗，其窗函数主瓣的第一个频谱零点出现在距离音调频率约 $\\pm 2 F_{s}/L$ 处，因此对于等幅音调，最小实际可分辨间隔约为 $2 F_{s}/L$。当 $L = 1024$ 且 $F_{s} = 48000$ 时，该值约为 $93.75$ Hz，这意味着尽管进行了零填充，相隔 $50$ Hz 的音调也无法被分辨。\n\nD. 在保持 $L$ 固定的情况下增加 $N$，会减小窗函数频谱的主瓣宽度，从而提高真实频谱分辨率。\n\nE. 增加 $L$（窗类型固定）可以改善频率分辨率，但会恶化时间分辨率，因为有效时间支撑 $T = L/F_{s}$ 增加了。\n\nF. 对于任何 $L$ 和任何窗类型，离散频率间隔都等于窗的等效噪声带宽 (ENBW)。\n\nG. 如果使用相同长度 $L$ 的矩形窗代替 Hann 窗，则瑞利间隔（第一零点准则）约为 $F_{s}/L \\approx 46.875$ Hz，因此相隔 $50$ Hz 的两个等幅音调接近瑞利极限，在无噪声条件下可能可以被勉强分辨。", "solution": "问题陈述科学合理、提法明确，并包含了进行严谨分析所需的所有必要信息。我们将首先解决频率间隔的计算问题，然后依次评估每个陈述。\n\n分析基于以下给定条件：\n- 采样率：$F_{s} = 48000$ Hz\n- Hann 窗长度：$L = 1024$ 样本\n- FFT 大小：$N = 8192$ 点\n- 音调频率：$f_{1} = 10000$ Hz 和 $f_{2} = 10050$ Hz，间隔为 $\\Delta f = f_{2} - f_{1} = 50$ Hz。\n\n**第 1 部分：计算离散频率间隔**\n\n长度为 $N$ 的离散傅里叶变换 (DFT) 提供了频率范围从 $0$ 到（但不包括）采样频率 $F_{s}$ 的频谱样本。频率轴被划分为 $N$ 个等间距的点，称为频率仓。这个 DFT 网格的间隔或分辨率，我们记为 $\\Delta f_{bin}$，由基本公式给出：\n$$ \\Delta f_{bin} = \\frac{F_{s}}{N} $$\n代入给定值：\n$$ \\Delta f_{bin} = \\frac{48000 \\text{ Hz}}{8192} = 5.859375 \\text{ Hz} $$\n该值表示由快速傅里叶变换 (FFT) 计算出的相邻频率样本之间的距离。\n\n**第 2 部分：评估陈述**\n\n现在我们将根据数字信号处理的原理来评估每个陈述。\n\n**A. 离散频率间隔等于 $F_{s}/N$，此处数值计算结果为 $5.859375$ Hz。**\n该陈述是 DFT 频率网格定义的直接应用。如上所计算，公式 $\\Delta f_{bin} = F_{s}/N$ 是正确的，数值计算 $\\frac{48000}{8192} = 5.859375 \\text{ Hz}$ 也是正确的。\n**结论：正确。**\n\n**B. 因为频率间隔小于音调的 $50$ Hz 间隔，所以这两个音调在经过零填充的 Hann 窗谱图中将能被清晰分辨。**\n该陈述揭示了一个普遍但关键的误解。分辨两个紧密间隔频率的能力是由**窗函数频谱的主瓣宽度**决定的，而主瓣宽度又由窗的类型及其长度 $L$ 决定。DFT 频率间隔 $\\Delta f_{bin}$ 仅决定了所得频谱的采样密度。使用大的 $N$（零填充）可以提供一个由窗函数决定的频谱的精细插值视图，但它本质上并不能提高“真实”分辨率。条件 $\\Delta f > \\Delta f_ {bin}$ 是分辨率的必要条件，但远非充分条件。\n**结论：不正确。**\n\n**C. 对于长度为 $L$ 的 Hann 窗，其窗函数主瓣的第一个频谱零点出现在距离音调频率约 $\\pm 2 F_{s}/L$ 处，因此对于等幅音调，最小实际可分辨间隔约为 $2 F_{s}/L$。当 $L = 1024$ 且 $F_{s} = 48000$ 时，该值约为 $93.75$ Hz，这意味着尽管进行了零填充，相隔 $50$ Hz 的音调也无法被分辨。**\n分辨率极限由窗的属性决定。对于长度为 $L$ 的 Hann 窗，其主瓣比矩形窗的主瓣更宽。其频谱响应的第一个零点位于距离中心频率 $\\pm 2/L$ 周/样本的频率偏移处。以赫兹为单位，这对应于频率 $\\Delta f_{res} = \\frac{2 F_{s}}{L}$。该值代表了 Hann 窗的瑞利分辨率准则。\n我们来计算这个值：\n$$ \\Delta f_{res} = \\frac{2 \\times 48000 \\text{ Hz}}{1024} = \\frac{96000}{1024} \\text{ Hz} = 93.75 \\text{ Hz} $$\n两个音调的频率间隔为 $\\Delta f = 50$ Hz。由于 $\\Delta f < \\Delta f_{res}$（$50 \\text{ Hz} < 93.75 \\text{ Hz}$），两个音调的主瓣将重叠到一定程度，以至于它们合并成一个更宽的单峰。它们将不会被分辨为两个独立的峰。该陈述正确地得出了这个结论，并正确地指出零填充不会改变这一事实。\n**结论：正确。**\n\n**D. 在保持 $L$ 固定的情况下增加 $N$，会减小窗函数频谱的主瓣宽度，从而提高真实频谱分辨率。**\n这在事实上是不正确的。频谱特性，包括主瓣宽度，是由窗函数 $w[n]$ 及其长度 $L$ 决定的。将 FFT 大小 $N$ 增加到超过 $L$ 的操作称为零填充。零填充等效于在加窗信号段的底层离散时间傅里叶变换 (DTFT) 的现有采样点之间进行插值。它不会改变此 DTFT 谱瓣的形状或宽度。因此，增加 $N$ 并不能提高真实频谱分辨率。\n**结论：不正确。**\n\n**E. 增加 $L$（窗类型固定）可以改善频率分辨率，但会恶化时间分辨率，因为有效时间支撑 $T = L/F_{s}$ 增加了。**\n该陈述正确地描述了应用于 STFT 的基本时频不确定性原理。\n- **频率分辨率**：窗函数主瓣的宽度与其长度 $L$ 成反比。例如，对于 Hann 窗，分辨率约为 $2F_s/L$。增加 $L$ 会使该值变小，意味着可以分辨更精细的频率细节。\n- **时间分辨率**：STFT 分析有效地将频谱估计定位在持续时间为 $T = L/F_{s}$ 的时间间隔内。更大的 $L$ 意味着更长的时间间隔，从而将时间事件在更宽的持续时间内平滑掉，并降低了精确定位频率事件发生时间的能力。\n该陈述是对这种权衡的精确阐述。\n**结论：正确。**\n\n**F. 对于任何 $L$ 和任何窗类型，离散频率间隔都等于窗的等效噪声带宽 (ENBW)。**\n这是不正确的。离散频率间隔为 $\\Delta f_{bin} = F_{s}/N$。等效噪声带宽 (ENBW)，当以 Hz 为单位表示时，是衡量窗滤波器响应有效宽度的指标，它取决于窗的形状和长度 $L$，但与 FFT 大小 $N$ 无关。以 Hz 为单位的 ENBW 由 ENBW$_{\\text{Hz}} = \\text{ENBW}_{\\text{bins}} \\times \\frac{F_s}{N}$ 给出，其中 ENBW$_{\\text{bins}}$ 本身与 $N$ 无关。对于 Hann 窗，ENBW$_{\\text{bins}} \\approx 1.5$。因此，以 Hz 为单位的 ENBW 约为 $1.5 \\times F_{s}/N$。这显然不等于频率间隔 $F_s/N$。只有对于矩形窗，ENBW$_{\\text{bins}} = 1.0$，使其以 Hz 为单位的 ENBW 等于频率间隔。声称这对“任何”窗类型都成立是错误的。\n**结论：不正确。**\n\n**G. 如果使用相同长度 $L$ 的矩形窗代替 Hann 窗，则瑞利间隔（第一零点准则）约为 $F_{s}/L \\approx 46.875$ Hz，因此相隔 $50$ Hz 的两个等幅音调接近瑞利极限，在无噪声条件下可能可以被勉强分辨。**\n对于长度为 $L$ 的矩形窗，其主瓣比 Hann 窗的要窄。其频谱（一个狄利克雷核）的第一个零点位于 $1/L$ 周/样本的频率偏移处，对应于以 Hz 为单位的频率 $\\Delta f_{res} = F_{s}/L$。这是矩形窗的瑞利准则。\n我们来计算这个值：\n$$ \\Delta f_{res} = \\frac{48000 \\text{ Hz}}{1024} = 46.875 \\text{ Hz} $$\n音调的间隔为 $\\Delta f = 50$ Hz。由于 $\\Delta f > \\Delta f_ {res}$（$50 \\text{ Hz} > 46.875 \\text{ Hz}$），一个音调频谱响应的峰值正好落在另一个音调频谱响应的第一个零点之外。这个条件使得两个音调可以被区分为两个独立的峰，并且它们之间有一个可见的凹陷，因此它们是“勉强可分辨的”。该陈述在其计算和结论上是准确的。\n**结论：正确。**", "answer": "$$\\boxed{ACEG}$$", "id": "2914032"}, {"introduction": "我们的理论分析常常假设信号是无限长的，但真实世界的信号总是有限的。本练习探讨了这种有限性带来的实际后果，重点关注在进行 STFT 分析时如何处理信号的边界。您将评估不同的边界扩展策略及其对语谱图伪影（如振幅衰减和频谱泄漏）的影响，从而强化一个观念：STFT 过程中的每一个选择都会对最终结果产生直接影响。[@problem_id:2913995]", "problem": "考虑一个实值的有限长度离散时间信号 $x[n]$，其支撑域为 $n \\in \\{0,\\dots,N_s-1\\}$。该信号通过短时傅里叶变换（STFT）进行分析，其中 $x[n]$ 在时间帧索引 $m$ 和频率箱索引 $k$ 处的 STFT 定义为\n$$\nX[m,k] \\triangleq \\sum_{n=0}^{L-1} x_{\\mathrm{ext}}[n+mH]\\, w[n]\\, e^{-j 2\\pi k n/K},\n$$\n其中分析窗 $w[n]$ 的支撑域为 $n \\in \\{0,\\dots,L-1\\}$，跳跃步长为 $H \\in \\mathbb{Z}_{>0}$，离散傅里叶变换（DFT）大小为 $K \\in \\mathbb{Z}_{>0}$。谱图为 $S_x[m,k] \\triangleq |X[m,k]|^2$。当一个帧与信号边界重叠时，即当 $mH<0$ 或 $mH+L-1 \\ge N_s$ 时，使用延拓 $x_{\\mathrm{ext}}[\\cdot]$ 来定义 $x[n]$ 在其支撑域之外的部分。\n\n现有三种边界处理策略可供考虑：\n- 零延拓：当 $0 \\le n \\le N_s-1$ 时，$x_{\\mathrm{ext}}[n] = x[n]$；否则 $x_{\\mathrm{ext}}[n] = 0$。\n- 镜像（偶）延拓：当 $n<0$ 时，$x_{\\mathrm{ext}}[n] = x[-n]$；当 $n \\ge N_s$ 时，$x_{\\mathrm{ext}}[n] = x[2N_s-2-n]$。\n- 周期延拓：$x_{\\mathrm{ext}}[n] = x[n \\bmod N_s]$，其中模运算的结果在 $\\{0,\\dots,N_s-1\\}$ 范围内。\n\n将零延拓下第 $m$ 帧的有效窗定义为 $w_m[n] \\triangleq w[n]\\,\\mathbf{1}_{\\{0 \\le n+mH \\le N_s-1\\}}$，其中 $\\mathbf{1}_{\\{\\cdot\\}}$ 是指示函数。对于与边界重叠的帧，定义能量分数\n$$\n\\alpha_m \\triangleq \\frac{\\sum_{n=0}^{L-1} w_m[n]^2}{\\sum_{n=0}^{L-1} w[n]^2} \\in (0,1]\n$$\n一个常见的工程实践是在边界附近进行可选的窗函数重归一化，即用一个缩放后的 $w_m[n]$ 来替换 $w[n]$，从而使逐帧的窗能量保持不变。设 $\\beta_m$ 为重归一化因子，它在 $\\alpha_m<1$ 时强制 $\\sum_{n=0}^{L-1} (\\beta_m w_m[n])^2 = \\sum_{n=0}^{L-1} w[n]^2$ 成立。\n\n假设 $x[n]$ 在内部帧的长度 $L$ 范围内是局部近似平稳的，并且在边界附近包含平滑内容。考虑由分析窗长度 $L$ 和形状 $w[n]$ 决定的时频分辨率权衡，并重点关注 $mH<0$ 和 $mH+L-1 \\ge N_s$ 的特定边界情况。\n\n关于这三种延拓策略对与边界重叠的帧中 $S_x[m,k]$ 的影响，以下哪些陈述是正确的？选择所有适用的选项。\n\nA. 在不进行窗函数重归一化的零延拓下，$S_x[m,k]$ 在主导窄带分量附近的期望幅度会按比例 $\\alpha_m$ 衰减，并且由于 $w_m[n]$ 的连续支撑域比 $w[n]$ 短，有效频率主瓣会变宽，从而相对于内部帧降低了局部频率分辨率并增加了频谱泄漏。\n\nB. 在周期延拓下，STFT 等效于对 $x[n]$ 进行加窗循环索引。如果 $x[n]$ 不是严格 $N_s$-周期的，那么跨越记录终点-起点连接处的帧通常会包含一个帧内跳跃不连续点，这会相对于内部帧增加 $S_x[m,k]$ 中的宽带泄漏。\n\nC. 无论窗函数和信号如何，镜像延拓总能保持与内部帧相同的频率分辨率，确保 $S_x[m,k]$ 的主瓣宽度和旁瓣水平相对于内部帧保持不变。\n\nD. 如果通过缩放因子 $\\beta_m = \\alpha_m^{-1/2}$ 在边界附近实现窗函数重归一化，那么对于一个平稳的单频率箱正弦波，在零延拓下观察到的 $S_x[m,k]$ 峰值幅度的偏差可以被基本消除，但由于有效窗的频谱形状发生了改变，频谱泄漏模式仍然与内部帧不同。\n\nE. 无论采用何种边界处理方式，由标称窗 $w[n]$ 和长度 $L$ 决定的基本时频分辨率权衡依然有效；然而，边界处理可以有效地缩短窗长（零延拓）或引入信号不连续点（周期延拓），这会分别导致局部频率分辨率下降或 $S_x[m,k]$ 中的泄漏增加。", "solution": "我们首先对问题陈述进行严格验证。\n\n### 步骤 1：提取已知条件\n\n问题提供了以下定义和条件：\n- 一个实值的有限长度离散时间信号 $x[n]$，其支撑域为 $n \\in \\{0, \\dots, N_s-1\\}$。\n- 短时傅里叶变换（STFT）定义为：\n$$\nX[m,k] \\triangleq \\sum_{n=0}^{L-1} x_{\\mathrm{ext}}[n+mH]\\, w[n]\\, e^{-j 2\\pi k n/K}\n$$\n- 参数：分析窗 $w[n]$ 定义在 $n \\in \\{0, \\dots, L-1\\}$ 上，跳跃步长 $H \\in \\mathbb{Z}_{>0}$，DFT 大小 $K \\in \\mathbb{Z}_{>0}$。\n- 谱图：$S_x[m,k] \\triangleq |X[m,k]|^2$。\n- 信号延拓 $x_{\\mathrm{ext}}[\\cdot]$ 用于处理与边界重叠的帧，其中 $mH<0$ 或 $mH+L-1 \\ge N_s$。\n- 三种边界处理策略：\n    1.  零延拓：当 $0 \\le n \\le N_s-1$ 时，$x_{\\mathrm{ext}}[n] = x[n]$；否则 $x_{\\mathrm{ext}}[n] = 0$。\n    2.  镜像（偶）延拓：当 $n<0$ 时，$x_{\\mathrm{ext}}[n] = x[-n]$；当 $n \\ge N_s$ 时，$x_{\\mathrm{ext}}[n] = x[2N_s-2-n]$。\n    3.  周期延拓：$x_{\\mathrm{ext}}[n] = x[n \\bmod N_s]$，其中模运算结果在 $\\{0, \\dots, N_s-1\\}$ 范围内。\n- 零延拓下第 $m$ 帧的有效窗：$w_m[n] \\triangleq w[n]\\,\\mathbf{1}_{\\{0 \\le n+mH \\le N_s-1\\}}$。\n- 能量分数：$\\alpha_m \\triangleq \\frac{\\sum_{n=0}^{L-1} w_m[n]^2}{\\sum_{n=0}^{L-1} w[n]^2}$，用于与边界重叠的帧。\n- 零延拓的重归一化因子 $\\beta_m$ 强制 $\\sum_{n=0}^{L-1} (\\beta_m w_m[n])^2 = \\sum_{n=0}^{L-1} w[n]^2$ 成立。\n- 假设：$x[n]$ 在内部帧中是局部近似平稳的，并且在边界附近内容平滑。\n- 问题关注这些策略对与边界重叠的帧中 $S_x[m,k]$ 的影响。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n问题陈述基于成熟的数字信号处理理论，具有科学依据。STFT、谱图和边界延拓方法的定义是标准的，或者（就特定的镜像延拓而言）在数学上是无歧义的。问题是适定的，要求基于所提供的框架评估几个陈述。它是客观的，使用了精确的数学语言。没有矛盾、信息缺失或伪科学主张。在信号分析的背景下，这些条件在物理上是现实的。\n\n### 步骤 3：结论与行动\n\n问题陈述有效。我们将继续分析每个选项。\n\n### 对所提供选项的分析\n\n设 $W(\\omega)$ 是分析窗 $w[n]$ 的离散时间傅里叶变换（DTFT）。一个加窗信号帧的频谱特性由信号频谱与 $W(\\omega)$ 的卷积决定。$W(\\omega)$ 主瓣的宽度决定了频率分辨率，其旁瓣的高度决定了频谱泄漏。时频不确定性原理指出，时域上持续时间更短的窗在频域上将具有更宽的频谱。\n\n**A. 在不进行窗函数重归一化的零延拓下，$S_x[m,k]$ 在主导窄带分量附近的期望幅度会按比例 $\\alpha_m$ 衰减，并且由于 $w_m[n]$ 的连续支撑域比 $w[n]$ 短，有效频率主瓣会变宽，从而相对于内部帧降低了局部频率分辨率并增加了频谱泄漏。**\n\n在与边界重叠的帧中，零延拓方法产生一个有效窗 $w_m[n]$，它是标称窗 $w[n]$ 的截断版本。\n1.  **幅度衰减**：第 $m$ 帧中加窗信号的能量为 $\\sum_{n} |x_{\\mathrm{ext}}[n+mH] w[n]|^2$。对于一个局部平稳信号 $x[n]$，期望能量与有效窗的能量 $\\sum_n |w_m[n]|^2$ 成正比。对于窄带信号，该能量集中在频谱的主瓣中。因此，谱图的峰值功率 $S_x[m,k]$ 预计与窗能量成正比。边界帧窗能量与内部帧窗能量之比恰好是 $\\alpha_m$。因此，与 $\\alpha_m$ 成比例衰减的描述是正确的。\n2.  **频率分辨率下降**：有效窗 $w_m[n]$ 比 $w[n]$ 有更短的支撑域（持续时间）。根据不确定性原理，持续时间更短的信号具有更宽的频谱。因此，与 $w[n]$ 的 DTFT 相比，$w_m[n]$ 的 DTFT 将具有更宽的主瓣和通常不同（通常更高）的旁瓣。这导致较差的频率分辨率和不同的、通常更差的频谱泄漏模式。\n陈述的两个部分在物理上和数学上都是合理的。\n结论：**正确**。\n\n**B. 在周期延拓下，STFT 等效于对 $x[n]$ 进行加窗循环索引。如果 $x[n]$ 不是严格 $N_s$-周期的，那么跨越记录终点-起点连接处的帧通常会包含一个帧内跳跃不连续点，这会相对于内部帧增加 $S_x[m,k]$ 中的宽带泄漏。**\n\n周期延拓将信号视为一个无限周期序列的一个周期。一个跨越边界 $n=N_s-1$ 的帧将包含来自信号末尾的样本（例如 $x[N_s-2], x[N_s-1]$），紧接着是来自信号开头的样本（例如 $x[0], x[1]$）。如果信号在其长度 $N_s$ 上不是自然周期的，那么在这个回卷点上，其值和/或导数将存在不连续性。例如，如果 $x[N_s-1]$ 与 $x[0]$ 相差很大，就会发生一个大的跳变。分析帧内的这种急剧瞬变或不连续性包含高频分量。其傅里叶变换会将能量扩散到很宽的频带上。这种效应被称为宽带频谱泄漏。该陈述正确地指出了这一机制及其后果。\n结论：**正确**。\n\n**C. 无论窗函数和信号如何，镜像延拓总能保持与内部帧相同的频率分辨率，确保 $S_x[m,k]$ 的主瓣宽度和旁瓣水平相对于内部帧保持不变。**\n\n这个陈述使用了“总是”和“相同”等词语，做出了一个绝对的断言。我们将检验这一说法。镜像延拓在边界处创建了一个合成信号。给定的定义对应于围绕 $n=0$ 和 $n=N_s-1$ 的整点对称。虽然这确保了信号值在边界处的连续性（例如，在 $n=-1$ 处的延拓信号是 $x[1]$，它与 $x[0]$ 相邻，而 $x[0]$又与 $x[1]$ 相邻），但它不保证导数的连续性。更重要的是，信号的局部特性被改变了。\n考虑一个简单的线性信号 $x[n] = n$，其中 $n \\in \\{0, \\dots, N_s-1\\}$。一个内部帧看到的是一段斜坡信号。一个靠近 $n=0$ 且使用镜像延拓的帧看到的是像 $\\{\\dots, x[2], x[1], x[0], x[1], x[2], \\dots\\} = \\{\\dots, 2, 1, 0, 1, 2, \\dots\\}$ 这样的片段。这是一个“V形”信号，而不是斜坡。加窗“V形”信号的频谱与加窗斜坡信号的频谱有本质的不同。局部平稳性假设被反射过程本身所违反。因此，频谱形状（主瓣、旁瓣）将不会与内部帧的相同。这个说法显然是错误的。\n结论：**不正确**。\n\n**D. 如果通过缩放因子 $\\beta_m = \\alpha_m^{-1/2}$ 在边界附近实现窗函数重归一化，那么对于一个平稳的单频率箱正弦波，在零延拓下观察到的 $S_x[m,k]$ 峰值幅度的偏差可以被基本消除，但由于有效窗的频谱形状发生了改变，频谱泄漏模式仍然与内部帧不同。**\n\n1.  **偏差消除**：建议的重归一化因子是 $\\beta_m = \\alpha_m^{-1/2} = \\left(\\frac{\\sum_{n=0}^{L-1} w_m[n]^2}{\\sum_{n=0}^{L-1} w[n]^2}\\right)^{-1/2}$。新的有效窗 $w'_{\\text{eff}}[n] = \\beta_m w_m[n]$ 的能量是 $\\sum_n (\\beta_m w_m[n])^2 = \\beta_m^2 \\sum_n w_m[n]^2 = \\alpha_m^{-1} \\sum_n w_m[n]^2 = \\frac{\\sum w[n]^2}{\\sum w_m[n]^2} \\sum w_m[n]^2 = \\sum w[n]^2$。重归一化后的边界窗能量与内部窗能量相同。对于平稳信号，这使得加窗帧的期望能量均等化，从而校正了所得谱图中的幅度偏差。\n2.  **频谱形状**：重归一化包括将截断窗 $w_m[n]$ 乘以一个标量 $\\beta_m$。这种缩放改变了窗的幅度，但没有改变其基本*形状*或更短的支撑域。频谱特性（主瓣宽度、旁瓣结构）是由窗的形状决定的。由于 $w_m[n]$ 的形状与 $w[n]$ 不同，它们的傅里叶变换也会不同。因此，边界帧的频率分辨率和泄漏模式仍将与内部帧不同。\n陈述的两个部分都是正确的。\n结论：**正确**。\n\n**E. 无论采用何种边界处理方式，由标称窗 $w[n]$ 和长度 $L$ 决定的基本时频分辨率权衡依然有效；然而，边界处理可以有效地缩短窗长（零延拓）或引入信号不连续点（周期延拓），这会分别导致局部频率分辨率下降或 $S_x[m,k]$ 中的泄漏增加。**\n\n这是一个总结性陈述。\n1.  **基本权衡**：作为时频分辨率权衡基础的不确定性原理是一项基本属性。$w[n]$ 和 $L$ 的选择为分析设定了最佳可能的分辨率乘积。边界效应只会降低此性能；它们无法突破基本限制。这部分是正确的。\n2.  **零延拓效应**：如在 A 中分析的，零延拓等效于使用一个被截断的、更短的有效窗 $w_m[n]$。\n3.  **缩短的后果**：如在 A 中分析的，更短的窗会导致更宽的频谱主瓣，即频率分辨率下降。\n4.  **周期延拓效应**：如在 B 中分析的，周期延拓会在信号帧中引入人为的不连续点。\n5.  **不连续性的后果**：如在 B 中分析的，不连续点会导致宽带频谱泄漏。\n该陈述正确地综合了零延拓和周期延拓的各自效应，并将它们置于整体时频权衡的背景下。\n结论：**正确**。", "answer": "$$\\boxed{ABDE}$$", "id": "2913995"}]}