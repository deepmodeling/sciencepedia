{"hands_on_practices": [{"introduction": "理解一个系统对外部输入的“放大”程度是鲁棒控制的核心。这个练习将引导你使用 Kalman–Yakubovich–Popov (KYP) 引理，从第一性原理出发，为一个简单的线性系统构造一个存储函数来证明其感应 $L_2$ 增益的上界。通过这个过程，你将把抽象的耗散不等式与具体的线性矩阵不等式 (LMI) 联系起来，这是现代鲁棒控制分析中的一个基本技能。", "problem": "考虑一个单输入单输出 (SISO) 线性时不变 (LTI) 系统，其状态空间实现为\n$$\n\\dot{x}(t) = -2\\,x(t) + w(t), \\quad z(t) = x(t),\n$$\n其中 $x(t) \\in \\mathbb{R}$ 是状态，$w(t) \\in \\mathbb{R}$ 是外源输入，$z(t) \\in \\mathbb{R}$ 是性能输出。假设初始条件为 $x(0)=0$。对于这个渐近稳定的 LTI 系统，从 $w$ 到 $z$ 的诱导 $L_{2}$ 增益等于其 $\\mathcal{H}_{\\infty}$ 范数。\n\n仅从诱导 $L_2$ 增益的定义和供给率为 $s(w,z) = z^{\\top} z - \\gamma^{2} w^{\\top} w$ 的耗散不等式出发，使用卡尔曼-雅库波维奇-波波夫 (Kalman–Yakubovich–Popov, KYP) 引理来构造一个二次存储函数 $V(x) = x^{\\top} P x$（其中 $P \\succ 0$），该函数可证明诱导 $L_2$ 增益的一个上界 $\\gamma$。明确推导相关的线性矩阵不等式 (LMI) 条件，并将其简化为适用于此系统的标量不等式。确定存在这样一个 $P \\succ 0$ 的最小界 $\\gamma_{\\star}$，在 $\\gamma = \\gamma_{\\star}$ 时给出一个可行的 $P$，并直接验证耗散不等式\n$$\n\\dot{V}(x) + z^{\\top}z - \\gamma^{2} w^{\\top} w \\le 0\n$$\n对于所有 $x \\in \\mathbb{R}$ 和 $w \\in \\mathbb{R}$ 成立。\n\n将最终答案表示为等于可实现的最小诱导 $L_2$ 增益界 $\\gamma_{\\star}$ 的精确实数。无需四舍五入。给出最终答案时，不带单位。", "solution": "该问题要求确定给定线性时不变 (LTI) 系统的最小诱导 $L_2$ 增益界 $\\gamma_{\\star}$，该界通过卡尔曼-雅库波维奇-波波夫 (KYP) 引理框架下的二次存储函数来证明。\n\n系统由以下状态空间方程给出：\n$$\n\\dot{x}(t) = -2\\,x(t) + w(t), \\quad z(t) = x(t)\n$$\n这对应于一般的 LTI 形式 $\\dot{x} = Ax + Bw$ 和 $z = Cx + Dw$，其标量系数如下（为保持形式上的一致性，我们将其视为 $1 \\times 1$ 矩阵）：\n$A = -2$，$B = 1$，$C = 1$，以及 $D = 0$。状态 $x$、输入 $w$ 和输出 $z$ 均在 $\\mathbb{R}$ 中。\n\n问题在于找到最小的 $\\gamma > 0$，使得存在一个二次存储函数 $V(x) = x^{\\top}Px = Px^2$（其中 $P > 0$）满足耗散不等式：\n$$\n\\frac{d}{dt}V(x(t)) + s(w(t), z(t)) \\le 0\n$$\n对系统的所有轨迹成立。供给率给定为 $s(w,z) = z^{\\top}z - \\gamma^2 w^{\\top}w$。在零初始条件下，这样一个 $V(x)$ 的存在保证了诱导 $L_2$ 增益以 $\\gamma$为界。该不等式为：\n$$\n\\dot{V}(x) + z^{\\top}z - \\gamma^2 w^{\\top}w \\le 0\n$$\n首先，我们计算存储函数 $V(x) = Px^2$ 的时间导数：\n$$\n\\dot{V}(x) = \\frac{d}{dt}(Px^2) = 2Px\\dot{x}\n$$\n代入状态方程 $\\dot{x} = -2x+w$：\n$$\n\\dot{V}(x) = 2Px(-2x+w) = -4Px^2 + 2Pxw\n$$\n现在，将 $\\dot{V}(x)$ 和 $z=x$ 代入耗散不等式：\n$$\n(-4Px^2 + 2Pxw) + (x^2) - \\gamma^2 w^2 \\le 0\n$$\n整理各项得到一个关于 $x$ 和 $w$ 的二次型：\n$$\n(1 - 4P)x^2 + 2Pxw - \\gamma^2 w^2 \\le 0\n$$\n此不等式必须对所有 $x \\in \\mathbb{R}$ 和 $w \\in \\mathbb{R}$ 成立。我们可以将左侧表示为矩阵形式：\n$$\n\\begin{pmatrix} x & w \\end{pmatrix}\n\\begin{pmatrix}\n1 - 4P & P \\\\\nP & -\\gamma^2\n\\end{pmatrix}\n\\begin{pmatrix} x \\\\ w \\end{pmatrix}\n\\le 0\n$$\n要使该二次型对所有 $x$ 和 $w$ 都是负半定的，该矩阵必须是负半定的。这就是与该问题相关的线性矩阵不等式 (LMI)：\n$$\n\\begin{pmatrix}\n1 - 4P & P \\\\\nP & -\\gamma^2\n\\end{pmatrix}\n\\preceq 0\n$$\n一个对称矩阵是负半定的，当且仅当其主子式符号交替，并以非正值开始。\n$1$. 第一个主子式（即 $(1,1)$ 元素）必须为非正：\n$$\n1 - 4P \\le 0 \\implies 4P \\ge 1 \\implies P \\ge \\frac{1}{4}\n$$\n$2$. 行列式（即第二个主子式）必须为非负：\n$$\n(1 - 4P)(-\\gamma^2) - P^2 \\ge 0\n$$\n$$\n- \\gamma^2 + 4P\\gamma^2 - P^2 \\ge 0\n$$\n$$\nP^2 - 4\\gamma^2 P + \\gamma^2 \\le 0\n$$\n我们需要找到最小的 $\\gamma > 0$，使得存在一个 $P$ 同时满足 $P \\ge 1/4$ 和 $P^2 - 4\\gamma^2 P + \\gamma^2 \\le 0$。问题描述中的条件 $P \\succ 0$ 变为 $P > 0$，这由 $P \\ge 1/4$ 保证。\n\n考虑关于 $P$ 的二次不等式 $f(P) = P^2 - 4\\gamma^2 P + \\gamma^2 \\le 0$。这描述了一条开口向上的抛物线。为了使这个关于 $P$ 的不等式有解，二次方程 $f(P) = 0$ 必须有实根。这要求其判别式为非负：\n$$\n\\Delta = (-4\\gamma^2)^2 - 4(1)(\\gamma^2) = 16\\gamma^4 - 4\\gamma^2 \\ge 0\n$$\n由于我们寻求 $\\gamma > 0$，我们可以除以 $4\\gamma^2$：\n$$\n4\\gamma^2 - 1 \\ge 0 \\implies \\gamma^2 \\ge \\frac{1}{4}\n$$\n由于 $\\gamma$ 代表增益，它必须是非负的，所以 $\\gamma \\ge \\frac{1}{2}$。因此，存在解 $P$ 的 $\\gamma$ 的最小值为 $\\gamma_{\\star} = \\frac{1}{2}$。\n\n现在，我们必须为这个最小界 $\\gamma_{\\star}$ 给出一个可行的 $P > 0$。令 $\\gamma = \\gamma_{\\star} = \\frac{1}{2}$。关于 $P$ 的不等式变为：\n$$\nP^2 - 4\\left(\\frac{1}{2}\\right)^2 P + \\left(\\frac{1}{2}\\right)^2 \\le 0\n$$\n$$\nP^2 - P + \\frac{1}{4} \\le 0\n$$\n这个表达式是一个完全平方：\n$$\n\\left(P - \\frac{1}{2}\\right)^2 \\le 0\n$$\n由于实数的平方不可能是负数，唯一的解是 $\\left(P - \\frac{1}{2}\\right)^2 = 0$，这意味着 $P = \\frac{1}{2}$。这个解满足条件 $P > 0$ 和 $P \\ge 1/4$。因此，对于 $\\gamma_{\\star} = 1/2$，存在一个唯一可行的存储函数参数 $P=1/2$。\n\n最后，我们直接验证当 $\\gamma = \\gamma_{\\star} = 1/2$ 和 $P=1/2$ 时的耗散不等式。\n存储函数为 $V(x) = \\frac{1}{2}x^2$。其导数为 $\\dot{V}(x) = x\\dot{x} = x(-2x+w) = -2x^2+xw$。\n不等式 $\\dot{V}(x) + z^2 - \\gamma^2 w^2 \\le 0$ 变为：\n$$\n(-2x^2 + xw) + x^2 - \\left(\\frac{1}{2}\\right)^2 w^2 \\le 0\n$$\n$$\n-x^2 + xw - \\frac{1}{4}w^2 \\le 0\n$$\n提取一个负号：\n$$\n-\\left(x^2 - xw + \\frac{1}{4}w^2\\right) \\le 0\n$$\n括号中的表达式是一个完全平方：\n$$\n-\\left(x - \\frac{1}{2}w\\right)^2 \\le 0\n$$\n这个不等式对所有 $x \\in \\mathbb{R}$ 和 $w \\in \\mathbb{R}$ 都成立，因为任何实数的平方都是非负的。这样就完成了验证。可实现的最小诱导 $L_2$ 增益界是 $\\gamma_{\\star}$。\n该问题是适定的，分析得出了一个确切的结果。最小界为 $\\gamma_{\\star} = 1/2$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2901523"}, {"introduction": "从系统分析转向控制器综合，本练习提供了一个设计最优 $\\mathcal{H}_2$ 控制器（即线性二次高斯，LQG 控制器）的完整演练。你将通过分别求解控制器和估计器的代数 Riccati 方程，应用分离原理来构建一个完整的动态输出反馈控制器。最后，通过检验闭环系统的特征值来验证其内部稳定性，这一系列步骤构成了现代控制理论中一项基础且关键的实践技能。", "problem": "考虑一个在基于二范数的最优控制（$\\mathcal{H}_{2}$ 方法）中出现的具有线性二次高斯（LQG）结构的连续时间线性时不变系统。其状态空间动态方程为\n$$\n\\dot{x}(t) = A\\,x(t) + B\\,u(t) + w(t), \\quad y(t) = C\\,x(t) + v(t),\n$$\n其中状态为 $x(t) \\in \\mathbb{R}^{2}$，控制为 $u(t) \\in \\mathbb{R}^{2}$，测量为 $y(t) \\in \\mathbb{R}^{2}$，过程扰动为 $w(t)$，测量扰动为 $v(t)$。矩阵如下：\n$$\nA = \\begin{bmatrix} 1 & 0 \\\\ 0 & -3 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}.\n$$\n假设标准无限时域二次性能指标的状态加权矩阵为\n$$\nQ = \\begin{bmatrix} 2 & 0 \\\\ 0 & 12 \\end{bmatrix}\n$$\n控制加权矩阵为\n$$\nR = \\begin{bmatrix} 1 & 0 \\\\ 0 & 2 \\end{bmatrix},\n$$\n过程扰动和测量扰动均为高斯白噪声，其协方差分别为\n$$\nW = \\begin{bmatrix} 9 & 0 \\\\ 0 & 1 \\end{bmatrix}, \\quad V = \\begin{bmatrix} 1 & 0 \\\\ 0 & 4 \\end{bmatrix},\n$$\n且互协方差为零。使用与连续时间 LQG 问题相关的 Riccati 解 $X \\succeq 0$ 和 $Y \\succeq 0$，构造基于观测器实现的最优动态输出反馈控制器\n$$\n\\dot{\\hat{x}}(t) = A_{k}\\,\\hat{x}(t) + B_{k}\\,y(t), \\quad u(t) = C_{k}\\,\\hat{x}(t) + D_{k}\\,y(t),\n$$\n并为组合的系统-控制器互联系统形成确定性闭环增广状态矩阵（其中 $w(t) \\equiv 0$ 和 $v(t) \\equiv 0$）。然后，通过检查该闭环状态矩阵的特征值，确定其所有特征值中的最大实部。请用精确的解析表达式表示最终答案，无需四舍五入。", "solution": "所给问题是一个标准的连续时间线性二次高斯（LQG）控制问题。我们首先对问题陈述进行严格的验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n系统动态方程由 $\\dot{x}(t) = A\\,x(t) + B\\,u(t) + w(t)$ 和 $y(t) = C\\,x(t) + v(t)$ 给出。\n定义系统的矩阵为：\n$A = \\begin{bmatrix} 1 & 0 \\\\ 0 & -3 \\end{bmatrix}$, $B = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}$, $C = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}$。\n\n性能指标加权矩阵为：\n$Q = \\begin{bmatrix} 2 & 0 \\\\ 0 & 12 \\end{bmatrix}$, $R = \\begin{bmatrix} 1 & 0 \\\\ 0 & 2 \\end{bmatrix}$。\n\n噪声协方差矩阵为：\n$W = \\begin{bmatrix} 9 & 0 \\\\ 0 & 1 \\end{bmatrix}$, $V = \\begin{bmatrix} 1 & 0 \\\\ 0 & 4 \\end{bmatrix}$。\n\n问题要求构造最优动态输出反馈控制器，并求出所得确定性闭环系统矩阵特征值的最大实部。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n1.  **科学依据：**该问题是 LQG 控制理论的教科书式应用，这是最优控制和信号处理中的一个基本概念。该问题是科学合理的。\n2.  **适定性：**为使 LQG 问题存在唯一的稳定解，必须满足两个条件：\n    *   矩阵对 $(A, B)$ 必须是可镇定的。系统矩阵 $A$ 的特征值为 $1$（不稳定）和 $-3$（稳定）。由于 $A, B$ 都是对角矩阵，我们分别考察各个模态。对应于特征值 $1$ 的不稳定模态是可控的，因为 $B$ 中相应的元素非零（$b_{11}=1$）。稳定模态是固有可镇定的。因此，$(A, B)$ 是可镇定的。\n    *   矩阵对 $(A, C)$ 必须是可检测的。类似地，对应于特征值 $1$ 的不稳定模态是可观测的，因为 $C$ 中相应的元素非零（$c_{11}=1$）。稳定模态是固有可检测的。因此，$(A, C)$ 是可检测的。\n    可镇定性和可检测性条件确保了相应的代数 Riccati 方程存在唯一的半正定稳定解 $X$ 和 $Y$。\n3.  **目标明确且完整：**问题以精确的数学定义进行表述，并提供了所有必需的矩阵和参数。没有信息缺失、矛盾或模糊不清。\n\n**步骤 3：结论与行动**\n\n问题有效。我们继续求解。\n\n### 求解推导\n\nLQG 控制问题使用分离原理来解决，该原理允许分别设计最优状态反馈控制器（LQR）和最优状态估计器（Kalman 滤波器）。\n\n**1. 线性二次调节器（LQR）设计**\n\n最优状态反馈增益 $K$ 通过求解控制问题的连续时间代数 Riccati 方程（CARE）得到：\n$$A^T X + X A - X B R^{-1} B^T X + Q = 0$$\n其中 $X \\succeq 0$ 是解矩阵。鉴于 $A, B, Q, R$ 均为对角矩阵，解 $X$ 也将是对角矩阵。设 $X = \\text{diag}(x_1, x_2)$。该矩阵方程解耦为两个标量代数 Riccati 方程。\n\n控制加权矩阵的逆为 $R^{-1} = \\text{diag}(1, 1/2)$。\n由于 $B = I$，项 $B R^{-1} B^T$ 即为 $R^{-1}$。CARE 简化为 $A^T X + X A - X R^{-1} X + Q = 0$。\n\n对于第一个模态（索引为 1）：\n$1 \\cdot x_1 + x_1 \\cdot 1 - x_1 \\cdot 1 \\cdot x_1 + 2 = 0 \\implies x_1^2 - 2x_1 - 2 = 0$。\n解为 $x_1 = \\frac{2 \\pm \\sqrt{4 - 4(1)(-2)}}{2} = 1 \\pm \\sqrt{3}$。对于 $X \\succeq 0$，我们要求 $x_1 \\ge 0$，因此我们选择正解 $x_1 = 1 + \\sqrt{3}$。\n\n对于第二个模态（索引为 2）：\n$(-3) \\cdot x_2 + x_2 \\cdot (-3) - x_2 \\cdot (1/2) \\cdot x_2 + 12 = 0 \\implies \\frac{1}{2}x_2^2 + 6x_2 - 12 = 0 \\implies x_2^2 + 12x_2 - 24 = 0$。\n解为 $x_2 = \\frac{-12 \\pm \\sqrt{144 - 4(1)(-24)}}{2} = \\frac{-12 \\pm \\sqrt{240}}{2} = -6 \\pm 2\\sqrt{15}$。对于 $x_2 \\ge 0$，我们必须选择 $x_2 = -6 + 2\\sqrt{15}$。\n\n因此，CARE 的解为 $X = \\begin{bmatrix} 1+\\sqrt{3} & 0 \\\\ 0 & -6+2\\sqrt{15} \\end{bmatrix}$。\n最优 LQR 增益为 $K = R^{-1} B^T X = R^{-1} X = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1/2 \\end{bmatrix} \\begin{bmatrix} 1+\\sqrt{3} & 0 \\\\ 0 & -6+2\\sqrt{15} \\end{bmatrix} = \\begin{bmatrix} 1+\\sqrt{3} & 0 \\\\ 0 & -3+\\sqrt{15} \\end{bmatrix}$。\n\n**2. Kalman 滤波器设计**\n\n最优估计器增益 $L$ 通过求解滤波问题的对偶 CARE 得到：\n$$A Y + Y A^T - Y C^T V^{-1} C Y + W = 0$$\n其中 $Y \\succeq 0$ 是状态估计误差协方差。和之前一样，我们假设一个对角解 $Y = \\text{diag}(y_1, y_2)$。\n\n测量噪声协方差的逆为 $V^{-1} = \\text{diag}(1, 1/4)$。\n由于 $C = I$，项 $C^T V^{-1} C$ 即为 $V^{-1}$。滤波器 ARE 为 $A Y + Y A^T - Y V^{-1} Y + W = 0$。\n\n对于第一个模态：\n$1 \\cdot y_1 + y_1 \\cdot 1 - y_1 \\cdot 1 \\cdot y_1 + 9 = 0 \\implies y_1^2 - 2y_1 - 9 = 0$。\n解为 $y_1 = \\frac{2 \\pm \\sqrt{4 - 4(1)(-9)}}{2} = 1 \\pm \\sqrt{10}$。对于 $Y \\succeq 0$，我们选择 $y_1 = 1 + \\sqrt{10}$。\n\n对于第二个模态：\n$(-3) \\cdot y_2 + y_2 \\cdot (-3) - y_2 \\cdot (1/4) \\cdot y_2 + 1 = 0 \\implies \\frac{1}{4}y_2^2 + 6y_2 - 1 = 0 \\implies y_2^2 + 24y_2 - 4 = 0$。\n解为 $y_2 = \\frac{-24 \\pm \\sqrt{576 - 4(1)(-4)}}{2} = \\frac{-24 \\pm \\sqrt{592}}{2} = -12 \\pm 2\\sqrt{37}$。对于 $y_2 \\ge 0$，我们必须选择 $y_2 = -12 + 2\\sqrt{37}$。\n\n因此，解为 $Y = \\begin{bmatrix} 1+\\sqrt{10} & 0 \\\\ 0 & -12+2\\sqrt{37} \\end{bmatrix}$。\n最优滤波器增益为 $L = Y C^T V^{-1} = Y V^{-1} = \\begin{bmatrix} 1+\\sqrt{10} & 0 \\\\ 0 & -12+2\\sqrt{37} \\end{bmatrix} \\begin{bmatrix} 1 & 0 \\\\ 0 & 1/4 \\end{bmatrix} = \\begin{bmatrix} 1+\\sqrt{10} & 0 \\\\ 0 & -3+\\frac{1}{2}\\sqrt{37} \\end{bmatrix}$。\n\n**3. 闭环系统特征值**\n\nLQG 控制器由 $\\dot{\\hat{x}} = (A - BK - LC)\\hat{x} + Ly$ 和 $u = -K\\hat{x}$ 给出。系统和控制器的增广状态向量为 $x_{cl} = [x^T \\ \\hat{x}^T]^T$。确定性闭环状态矩阵为：\n$$A_{cl} = \\begin{bmatrix} A & -BK \\\\ LC & A-BK-LC \\end{bmatrix}$$\n根据分离原理，$A_{cl}$ 的特征值是调节器矩阵 $(A-BK)$ 和估计器矩阵 $(A-LC)$ 特征值的并集。\n\n调节器矩阵 $(A-BK)$ 的特征值由下式求出：\n$A - BK = A - K = \\begin{bmatrix} 1 & 0 \\\\ 0 & -3 \\end{bmatrix} - \\begin{bmatrix} 1+\\sqrt{3} & 0 \\\\ 0 & -3+\\sqrt{15} \\end{bmatrix} = \\begin{bmatrix} -\\sqrt{3} & 0 \\\\ 0 & -\\sqrt{15} \\end{bmatrix}$。\n特征值为 $\\lambda_{1,reg} = -\\sqrt{3}$ 和 $\\lambda_{2,reg} = -\\sqrt{15}$。\n\n估计器矩阵 $(A-LC)$ 的特征值由下式求出：\n$A - LC = A - L = \\begin{bmatrix} 1 & 0 \\\\ 0 & -3 \\end{bmatrix} - \\begin{bmatrix} 1+\\sqrt{10} & 0 \\\\ 0 & -3+\\frac{1}{2}\\sqrt{37} \\end{bmatrix} = \\begin{bmatrix} -\\sqrt{10} & 0 \\\\ 0 & -\\frac{1}{2}\\sqrt{37} \\end{bmatrix}$。\n特征值为 $\\lambda_{1,est} = -\\sqrt{10}$ 和 $\\lambda_{2,est} = -\\frac{1}{2}\\sqrt{37}$。\n\n闭环系统的所有特征值集合为 $\\{-\\sqrt{3}, -\\sqrt{15}, -\\sqrt{10}, -\\frac{1}{2}\\sqrt{37}\\}$。所有特征值均为实数且为负，这证实了闭环系统是稳定的。\n\n**4. 最大实部**\n\n我们必须找到集合 $\\{-\\sqrt{3}, -\\sqrt{15}, -\\sqrt{10}, -\\frac{\\sqrt{37}}{2}\\}$ 中的最大值。这等价于找到 $\\{\\sqrt{3}, \\sqrt{15}, \\sqrt{10}, \\frac{\\sqrt{37}}{2}\\}$ 中的最小绝对值。\n让我们比较平方根内的数值：\n$\\sqrt{3}$\n$\\sqrt{15}$\n$\\sqrt{10}$\n$\\frac{\\sqrt{37}}{2} = \\sqrt{\\frac{37}{4}} = \\sqrt{9.25}$\n\n我们有以下顺序 $3 < 9.25 < 10 < 15$。\n因此，$\\sqrt{3} < \\sqrt{9.25} < \\sqrt{10} < \\sqrt{15}$。\n这意味着 $-\\sqrt{3} > -\\sqrt{9.25} > -\\sqrt{10} > -\\sqrt{15}$。\n\n所有特征值中的最大实部是 $-\\sqrt{3}$。", "answer": "$$\n\\boxed{-\\sqrt{3}}\n$$", "id": "2901515"}, {"introduction": "本练习将带你进入更高级的鲁棒分析领域，处理具有结构化不确定性的系统。你将探索结构化奇异值 ($\\mu$) 这一强大工具，它能够比标准的 $\\mathcal{H}_{\\infty}$ 范数更精确地评估系统的鲁棒稳定性。此练习不仅要求你推导 $\\mu$ 的一个重要上界（基于 $D$ 尺度变换），还要求你通过编写数值优化程序来计算它，从而将深刻的理论转化为实用的计算方法。", "problem": "考虑一个复矩阵在固定频率下的结构奇异值，其是为块对角不确定性集合定义的。设结构不确定性为块对角形式，且具有给定的正整数块大小。对于一个复方阵 $M \\in \\mathbb{C}^{n \\times n}$，其相对于给定块结构的结构奇异值定义为：能使 $I - M \\Delta$ 奇异的、具有该结构的最小范数不确定性 $\\Delta$ 的倒数（如果存在这样的 $\\Delta$），否则为零。您的目标是从结构奇异值的精确定义以及范数和相似变换的基本性质出发，推导出一个可实现的、使用正定对角缩放矩阵 $D$ 的上界，所述矩阵 $D$ 是块对角的，并与不确定性结构可交换。然后，实现一个数值算法，通过对此类 $D$ 进行优化来计算此上界。\n\n您必须：\n- 从结构奇异值的定义出发，仅使用核心定义和谱范数的次乘性来推导一个基于与不确定性结构可交换的块对角正定缩放矩阵的可计算上界。\n- 将允许的缩放矩阵 $D$ 建模为块对角矩阵，每个不确定性块对应一个正标量，该标量在该块的对角线上重复以匹配其大小。也就是说，如果不确定性有 $b$ 个块，大小分别为 $n_{1}, \\dots, n_{b}$，则 $D = \\mathrm{diag}(d_{1} I_{n_{1}}, \\dots, d_{b} I_{n_{b}})$，其中 $d_{i} &gt; 0$。\n- 通过使用缩放因子的对数，将优化问题简化为一个有限维无约束问题，从而自动满足正定性约束。\n- 实现一个稳健的数值程序来为下述每个测试用例计算该上界。您可以使用迭代数值优化方法，并应注意确保确定性行为。\n\n测试套件：\n每个测试用例提供一个单频复矩阵 $M$ 和一个指示不确定性结构的块大小列表。对于每个测试用例，计算通过上述块对角缩放方法获得的上界值。\n\n- 测试用例 1：\n  - $M \\in \\mathbb{C}^{2 \\times 2}$ 如下\n    $$\n    M = \\begin{bmatrix}\n    0.2 + 0.1 \\mathrm{i} & 2.0 - 0.3 \\mathrm{i} \\\\\n    0.0 + 0.5 \\mathrm{i} & 0.1 - 0.2 \\mathrm{i}\n    \\end{bmatrix}.\n    $$\n  - 块大小：$[1, 1]$。\n- 测试用例 2：\n  - $M \\in \\mathbb{C}^{3 \\times 3}$ 如下\n    $$\n    M = \\begin{bmatrix}\n    0.05 + 0.0 \\mathrm{i} & 1.0 - 0.1 \\mathrm{i} & 0.2 - 0.1 \\mathrm{i} \\\\\n    0.0 + 0.1 \\mathrm{i} & 0.3 + 0.0 \\mathrm{i} & 2.0 + 0.2 \\mathrm{i} \\\\\n    0.0 + 0.0 \\mathrm{i} & 0.5 - 0.1 \\mathrm{i} & 0.0 + 0.1 \\mathrm{i}\n    \\end{bmatrix}.\n    $$\n  - 块大小：$[1, 2]$。\n- 测试用例 3：\n  - $M \\in \\mathbb{C}^{4 \\times 4}$ 是一个块对角矩阵，有两个大小为 $2$ 的块，\n    $$\n    M = \\mathrm{diag}(A, B), \\quad\n    A = \\begin{bmatrix}\n    0.8 + 0.05 \\mathrm{i} & 0.02 - 0.01 \\mathrm{i} \\\\\n    0.01 + 0.0 \\mathrm{i} & 0.7 + 0.02 \\mathrm{i}\n    \\end{bmatrix}, \\quad\n    B = \\begin{bmatrix}\n    0.6 + 0.04 \\mathrm{i} & 0.03 + 0.0 \\mathrm{i} \\\\\n    0.0 + 0.01 \\mathrm{i} & 0.65 + 0.03 \\mathrm{i}\n    \\end{bmatrix}.\n    $$\n  - 块大小：$[2, 2]$。\n\n输出规范：\n- 对于每个测试用例，计算通过对所有允许的块对角正定缩放矩阵 $D$ 进行优化而获得的上界值，如上所述。\n- 将每个上界表示为四舍五入到六位小数的实数浮点数。\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[x1,x2,x3]”），其中 $x_{k}$ 是测试用例 $k$ 的计算上界。", "solution": "该问题陈述经评估是科学严谨、适定、客观且完整的。它描述了鲁棒控制理论中的一个标准问题：计算结构奇异值 $\\mu$ 的一个上界。所提供的定义、矩阵和目标是一致且充分的，足以进行严谨的求解。我们接下来进行推导和实现。\n\n复矩阵 $M \\in \\mathbb{C}^{n \\times n}$ 相对于块对角不确定性结构 $\\Delta$ 的结构奇异值 $\\mu_{\\Delta}(M)$ 定义为：\n$$\n\\mu_{\\Delta}(M) \\triangleq \\frac{1}{\\min \\{ \\|\\Delta\\|_2 \\mid \\Delta \\in \\mathcal{B}_{\\Delta}, \\det(I - M\\Delta) = 0 \\}}\n$$\n如果存在使矩阵 $I - M\\Delta$ 奇异的矩阵 $\\Delta$，则按此定义；否则 $\\mu_{\\Delta}(M) \\triangleq 0$。此处，$\\|\\cdot\\|_2$ 表示谱范数（最大奇异值），$\\mathcal{B}_{\\Delta}$ 是所有符合指定结构的块对角不确定性矩阵的集合。也就是说，如果块大小为 $n_1, n_2, \\dots, n_b$ 且 $\\sum_{i=1}^{b} n_i = n$，则 $\\Delta = \\mathrm{diag}(\\Delta_1, \\dots, \\Delta_b)$，其中每个 $\\Delta_i \\in \\mathbb{C}^{n_i \\times n_i}$。\n\n条件 $\\det(I - M\\Delta) = 0$ 等价于 1 是矩阵 $M\\Delta$ 的一个特征值。这意味着存在一个非零向量 $x \\in \\mathbb{C}^n$ 使得 $M\\Delta x = x$。\n\n我们需要用一组缩放矩阵 $\\mathcal{D}$ 来推导一个上界。该集合由与不确定性结构可交换的块对角正定矩阵组成。一个矩阵 $D$ 与不确定性结构可交换，如果对于所有 $\\Delta \\in \\mathcal{B}_{\\Delta}$ 都有 $D\\Delta = \\Delta D$。规定的 $D \\in \\mathcal{D}$ 的形式为：\n$$\nD = \\mathrm{diag}(d_1 I_{n_1}, d_2 I_{n_2}, \\dots, d_b I_{n_b})\n$$\n其中 $d_i \\in \\mathbb{R}$，$d_i > 0$，对于 $i = 1, \\dots, b$，$I_{n_i}$ 是大小为 $n_i \\times n_i$ 的单位矩阵。由于 $D$ 和任何来自动态集合的 $\\Delta$ 都具有相同的块对角结构，它们是可交换的。\n\n让我们分析 $M$ 的奇异性条件与 $M$ 的一个缩放版本之间的关系。对于任何可逆的 $D \\in \\mathcal{D}$，条件 $\\det(I - M\\Delta) = 0$ 等价于 $\\det(I - DMD^{-1}\\Delta) = 0$。这可以如下证明：\n$$\n\\det(I - M\\Delta) = \\det(D(I - M\\Delta)D^{-1}) = \\det(D I D^{-1} - D M \\Delta D^{-1}) = \\det(I - D M D^{-1} \\Delta)\n$$\n其中最后一步使用了可交换性质 $D\\Delta = \\Delta D$。这意味着，对于 $M$ 和相似变换后的矩阵 $DMD^{-1}$，使其奇异的不确定性 $\\Delta$ 的集合是相同的。因此，它们的结构奇异值相等：\n$$\n\\mu_{\\Delta}(M) = \\mu_{\\Delta}(DMD^{-1}) \\quad \\forall D \\in \\mathcal{D}\n$$\n\n接下来，我们为任意矩阵 $A$ 的 $\\mu_{\\Delta}(A)$ 建立一个通用的上界。如果 $\\det(I - A\\Delta) = 0$，则存在一个向量 $x \\ne 0$ 使得 $A\\Delta x = x$。对两边取谱范数，并应用范数的次乘性质，我们有：\n$$\n\\|x\\|_2 = \\|A\\Delta x\\|_2 \\le \\|A\\|_2 \\|\\Delta x\\|_2 \\le \\|A\\|_2 \\|\\Delta\\|_2 \\|x\\|_2\n$$\n因为 $\\|x\\|_2 > 0$，我们可以用它来除，得到 $1 \\le \\|A\\|_2 \\|\\Delta\\|_2$，这意味着任何奇异摄动 $\\Delta$ 都必须满足 $\\|\\Delta\\|_2 \\ge 1/\\|A\\|_2$。因此，此类 $\\Delta$ 的最小范数也必须满足此不等式：\n$$\n\\min \\{ \\|\\Delta\\|_2 \\mid \\det(I - A\\Delta)=0 \\} \\ge \\frac{1}{\\|A\\|_2}\n$$\n对两边取倒数会反转不等式：\n$$\n\\mu_{\\Delta}(A) = \\left( \\min \\{ \\|\\Delta\\|_2 \\} \\right)^{-1} \\le \\|A\\|_2 = \\sigma_{\\max}(A)\n$$\n其中 $\\sigma_{\\max}(A)$ 是 $A$ 的最大奇异值。\n\n结合这两个结果，我们有 $\\mu_{\\Delta}(M) = \\mu_{\\Delta}(DMD^{-1}) \\le \\sigma_{\\max}(DMD^{-1})$。这个不等式对于从允许集合 $\\mathcal{D}$ 中选择的任何 $D$ 都成立。为了从这类上界中找到最紧的上界，我们应该寻求在所有此类 $D$ 上的下确界：\n$$\n\\mu_{\\Delta}(M) \\le \\inf_{D \\in \\mathcal{D}} \\sigma_{\\max}(DMD^{-1})\n$$\n这就是我们寻求实现的可计算上界。现在的任务是一个优化问题：\n$$\n\\min_{d_1 > 0, \\dots, d_b > 0} f(d_1, \\dots, d_b) = \\sigma_{\\max}\\left( \\mathrm{diag}(d_1 I_{n_1}, \\dots) M \\mathrm{diag}(d_1^{-1} I_{n_1}, \\dots) \\right)\n$$\n正定性约束 $d_i > 0$ 使其成为一个有约束的优化问题。如前所述，我们可以通过变量替换将其转换为一个无约束问题。令 $d_i = e^{\\alpha_i}$，其中 $\\alpha_i \\in \\mathbb{R}$。优化变量现在是 $\\alpha_1, \\dots, \\alpha_b$，并且 $d_i$ 的正定性得到了固有满足。目标函数变为：\n$$\ng(\\alpha_1, \\dots, \\alpha_b) = \\sigma_{\\max}(D(\\alpha) M D(\\alpha)^{-1})\n$$\n其中 $D(\\alpha) = \\mathrm{diag}(e^{\\alpha_1} I_{n_1}, \\dots, e^{\\alpha_b} I_{n_b})$。问题是在 $\\alpha \\in \\mathbb{R}^b$ 上找到 $\\min g(\\alpha)$。注意，将所有 $d_i$ 乘以一个共同的正因子 $c$ 不会改变 $DMD^{-1}$ 的值，因为 $c D M (c D)^{-1} = c D M c^{-1} D^{-1} = DMD^{-1}$。这意味着目标函数在 $\\alpha$ 空间中沿着 $[1, 1, \\dots, 1]^T$ 方向是恒定的。该优化问题是凸的，这保证了任何局部最小值也是全局最小值。\n\n为了数值求解此问题，我们采用一种拟牛顿优化算法，具体是由 `scipy.optimize.minimize` 函数提供的 L-BFGS-B 算法。该方法适用于无约束或箱约束问题，并且对于光滑目标函数是高效的。虽然最大奇异值函数并非处处可微（特别是在奇异值重复时），但它几乎处处可微，并且标准的基于梯度的优化算法在实践中表现良好。我们从初始猜测 $\\alpha = [0, 0, \\dots, 0]^T$ 开始优化，这对应于所有 $i$ 的 $d_i=1$，即 $D=I$。因此，目标函数的初始值为 $\\sigma_{\\max}(M)$。\n\n数值流程如下：\n1.  对于给定的矩阵 $M$ 和块大小列表 $\\{n_1, \\dots, n_b\\}$，定义一个以向量 $\\alpha \\in \\mathbb{R}^b$ 为输入的目标函数。\n2.  在此函数内部，通过将对应于块 $i$ 的对角线元素设置为 $e^{\\alpha_i}$，由 $\\alpha$ 构造对角矩阵 $D$。构造其逆矩阵 $D^{-1}$，其对角线元素为 $e^{-\\alpha_i}$。\n3.  计算缩放后的矩阵 $M' = D M D^{-1}$。\n4.  使用标准的奇异值分解 (SVD) 算法计算 $M'$ 的谱范数，即其最大奇异值。该值是函数的输出。\n5.  使用该目标函数、$\\alpha_0 = 0 \\in \\mathbb{R}^b$ 的初始猜测和 L-BFGS-B 方法调用 `scipy.optimize.minimize`。\n6.  优化器返回的最小值是计算出的 $\\mu_{\\Delta}(M)$ 的上界。对每个测试用例重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Computes the D-scaling upper bound for the structured singular value (mu)\n    for a series of test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"M\": np.array([\n                [0.2 + 0.1j, 2.0 - 0.3j],\n                [0.0 + 0.5j, 0.1 - 0.2j]\n            ]),\n            \"block_sizes\": [1, 1]\n        },\n        {\n            \"M\": np.array([\n                [0.05 + 0.0j, 1.0 - 0.1j, 0.2 - 0.1j],\n                [0.0 + 0.1j, 0.3 + 0.0j, 2.0 + 0.2j],\n                [0.0 + 0.0j, 0.5 - 0.1j, 0.0 + 0.1j]\n            ]),\n            \"block_sizes\": [1, 2]\n        },\n        {\n            \"M\": np.block([\n                [np.array([[0.8 + 0.05j, 0.02 - 0.01j],\n                           [0.01 + 0.0j, 0.7 + 0.02j]]), np.zeros((2, 2), dtype=np.complex128)],\n                [np.zeros((2, 2), dtype=np.complex128), np.array([[0.6 + 0.04j, 0.03 + 0.0j],\n                                                                 [0.0 + 0.01j, 0.65 + 0.03j]])]\n            ]),\n            \"block_sizes\": [2, 2]\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        M = case[\"M\"]\n        block_sizes = case[\"block_sizes\"]\n        num_blocks = len(block_sizes)\n\n        # Create a mapping from row/column index to block index\n        block_indices = []\n        for i, size in enumerate(block_sizes):\n            block_indices.extend([i] * size)\n\n        def objective_function(alpha):\n            \"\"\"\n            Objective function to minimize: sigma_max(D * M * D^-1).\n            alpha is a vector of logarithms of the scaling factors.\n            \"\"\"\n            # Construct the scaling matrix D and its inverse D_inv\n            # d_i = exp(alpha_i)\n            d_vals = np.exp(alpha)\n            \n            # The problem can be parameterized by b-1 variables, but using b variables\n            # is general and the optimizer handles the redundant degree of freedom.\n            d_vec = np.array([d_vals[block_indices[i]] for i in range(M.shape[0])])\n            \n            # Efficiently compute D * M * D^-1 for diagonal D\n            # (DMD^-1)_ij = d_i/d_j * M_ij\n            D_M_D_inv = M * (d_vec[:, np.newaxis] / d_vec)\n\n            # Compute the largest singular value (spectral norm)\n            # We don't need the singular vectors, so compute_uv=False for efficiency\n            s = np.linalg.svd(D_M_D_inv, compute_uv=False)\n            \n            return s[0]\n\n        # Initial guess for alpha is all zeros, which corresponds to D = I\n        alpha0 = np.zeros(num_blocks)\n\n        # Perform the optimization\n        # L-BFGS-B is a robust and efficient quasi-Newton method\n        # for unconstrained or box-constrained problems.\n        opt_result = minimize(\n            objective_function,\n            alpha0,\n            method='L-BFGS-B',\n            options={'disp': False}\n        )\n\n        # The minimum value found is the upper bound\n        mu_upper_bound = opt_result.fun\n        results.append(round(mu_upper_bound, 6))\n\n    # Format the final output according to the problem specification\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2901532"}]}