{"hands_on_practices": [{"introduction": "在我们深入研究求解线性二次调节器 (LQR) 的方法之前，首先必须理解其解存在的根本前提。这个练习通过一个精心设计的反例，揭示了可镇定性 (stabilizability) 而非可控性 (controllability) 是保证无限时域 LQR 问题存在有界代价和稳定闭环系统的关键条件。通过从第一性原理分析，您将深刻体会到为何一个不可控但可镇定的系统依然可以被优化，而一个不可镇定的系统则无论如何都无法实现稳定的优化控制 [@problem_id:2913486]。", "problem": "考虑两个连续时间线性时不变状态空间模型，其状态向量为 $x \\in \\mathbb{R}^{2}$，输入为 $u \\in \\mathbb{R}$，以及线性二次调节器（LQR）性能指标\n$$\nJ(x_{0},u) \\triangleq \\int_{0}^{\\infty} \\big( x(t)^{\\top} Q x(t) + u(t)^{\\top} R u(t) \\big) \\, dt,\n$$\n其中 $Q \\succeq 0$ 且 $R \\succ 0$。模型如下：\n\n模型 A:\n$$\n\\dot{x}(t) = A_{A} x(t) + B_{A} u(t), \\quad A_{A} \\triangleq \\begin{pmatrix} -1 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\quad B_{A} \\triangleq \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad Q = I_{2}, \\quad R = 1.\n$$\n\n模型 B:\n$$\n\\dot{x}(t) = A_{B} x(t) + B_{B} u(t), \\quad A_{B} \\triangleq \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}, \\quad B_{B} \\triangleq \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad Q = I_{2}, \\quad R = 1.\n$$\n\n任务：\n1. 仅使用线性时不变系统的能控性和能稳性的定义，判断每个模型中的系统对 $(A,B)$ 是否能控，是否能稳。请从第一性原理出发证明你的答案。\n2. 从 Hamilton–Jacobi–Bellman (HJB) 原理和价值函数 $V(x) \\triangleq \\inf_{u} J(x,u)$ 的定义出发，推导模型 A 的最优状态反馈控制必须满足的条件。通过求解与这些条件一致的对称矩阵 $P$ 来推断出相应的二次型价值函数 $V(x) = x^{\\top} P x$。\n3. 对于模型 A，计算初始状态为 $x_{0} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 时的最优无限时域成本 $J^{\\star}(x_{0})$。\n\n此外，解释为什么对于一般的非零初始条件 $x_{0}$，模型 B 无法得到有限的最优成本 $J^{\\star}(x_{0})$，并将其与能稳性联系起来。你的解释必须基于由 $\\dot{x} = A x + B u$ 所蕴含的系统轨迹以及 $J(x_{0},u)$ 的积分定义，不得引用任何已有的最优控制公式。\n\n请将任务 3 的最终数值结果以单个闭式表达式的形式给出。无需单位。无需四舍五入。", "solution": "所提出的问题是线性系统和最优控制理论中的一个标准练习。该问题科学严谨、提法恰当、客观，并包含了进行完整分析所需的所有信息。因此，它被认为是一个有效的问题。我们开始进行解答。\n\n根据题目要求，分析分为四个部分。\n\n首先，我们分析两个系统的能控性和能稳性。\n\n由系统对 $(A, B)$ 描述的线性时不变系统是能控的，如果 Kalman 能控性矩阵 $\\mathcal{C} \\triangleq \\begin{pmatrix} B & AB & \\cdots & A^{n-1}B \\end{pmatrix}$ 具有满秩，即等于状态空间的维度 $n$。如果所有不稳定模式（$A$ 的特征值 $\\lambda$ 满足 $\\text{Re}(\\lambda) \\geq 0$）都是能控的，则该系统是能稳的。这可以通过 Popov-Belevitch-Hautus (PBH) 测试来验证，该测试指出，系统对 $(A, B)$ 是能稳的当且仅当对于所有满足 $\\text{Re}(\\lambda) \\geq 0$ 的 $A$ 的特征值 $\\lambda$，矩阵 $\\begin{pmatrix} A - \\lambda I & B \\end{pmatrix}$ 都具有满行秩。\n\n对于模型 A：\n状态和输入矩阵为 $A_{A} = \\begin{pmatrix} -1 & 0 \\\\ 0 & 1 \\end{pmatrix}$ 和 $B_{A} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。状态维度为 $n=2$。$A_A$ 的特征值为 $\\lambda_1 = -1$（稳定）和 $\\lambda_2 = 1$（不稳定）。\n为检验能控性，我们构建能控性矩阵 $\\mathcal{C}_A = \\begin{pmatrix} B_A & A_A B_A \\end{pmatrix}$。\n乘积 $A_A B_A$ 计算如下：\n$$\nA_A B_A = \\begin{pmatrix} -1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n因此，能控性矩阵为：\n$$\n\\mathcal{C}_A = \\begin{pmatrix} 0 & 0 \\\\ 1 & 1 \\end{pmatrix}\n$$\n$\\mathcal{C}_A$ 的行列式为 $0 \\cdot 1 - 0 \\cdot 1 = 0$。$\\mathcal{C}_A$ 的秩为 1，小于 $n=2$。因此，系统对 $(A_A, B_A)$ **不能控**。\n为检验能稳性，我们必须检查不稳定的特征值 $\\lambda_2 = 1$。根据 PBH 测试，我们必须检查矩阵 $\\begin{pmatrix} A_A - 1 \\cdot I & B_A \\end{pmatrix}$ 的秩：\n$$\n\\begin{pmatrix} A_A - I & B_A \\end{pmatrix} = \\begin{pmatrix} -1-1 & 0 & 0 \\\\ 0 & 1-1 & 1 \\end{pmatrix} = \\begin{pmatrix} -2 & 0 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n该矩阵显然秩为 2，即满行秩。因此，系统对 $(A_A, B_A)$ **能稳**。\n\n对于模型 B：\n状态和输入矩阵为 $A_{B} = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$ 和 $B_{B} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。$A_B$ 的特征值为 $\\lambda_1 = 1$（不稳定）和 $\\lambda_2 = -1$（稳定）。\n为检验能控性，我们构建能控性矩阵 $\\mathcal{C}_B = \\begin{pmatrix} B_B & A_B B_B \\end{pmatrix}$。\n$$\nA_B B_B = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}\n$$\n$$\n\\mathcal{C}_B = \\begin{pmatrix} 0 & 0 \\\\ 1 & -1 \\end{pmatrix}\n$$\n$\\mathcal{C}_B$ 的行列式为 0。其秩为 1，小于 $n=2$。因此，系统对 $(A_B, B_B)$ **不能控**。\n为检验能稳性，我们检查不稳定的特征值 $\\lambda_1 = 1$。我们应用 PBH 测试：\n$$\n\\begin{pmatrix} A_B - I & B_B \\end{pmatrix} = \\begin{pmatrix} 1-1 & 0 & 0 \\\\ 0 & -1-1 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & -2 & 1 \\end{pmatrix}\n$$\n该矩阵的秩为 1，小于满行秩 2。因此，系统对 $(A_B, B_B)$ **不能稳**。\n\n其次，我们推导模型 A 的最优控制和价值函数。\n无限时域 LQR 问题的 Hamilton-Jacobi-Bellman (HJB) 方程为：\n$$\n\\inf_{u} \\left\\{ \\nabla V(x)^{\\top} (A x + B u) + x^{\\top} Q x + u^{\\top} R u \\right\\} = 0\n$$\n我们假设一个二次型价值函数 $V(x) = x^{\\top} P x$，其中 $P$ 是一个对称正定矩阵。其梯度为 $\\nabla V(x) = 2 P x$。将此代入模型 A 的 HJB 方程，得到：\n$$\n\\inf_{u(t)} \\left\\{ (2 P x)^{\\top} (A_A x + B_A u) + x^{\\top} Q x + u^{\\top} R u \\right\\} = 0\n$$\n展开各项并使用 $R=1$：\n$$\n\\inf_{u(t)} \\left\\{ 2 x^{\\top} P A_A x + 2 x^{\\top} P B_A u + x^{\\top} I_2 x + u^2 \\right\\} = 0\n$$\n为了找到下确界，我们将花括号内的表达式对标量控制 $u$ 求导，并令结果为零：\n$$\n\\frac{\\partial}{\\partial u} \\left( 2 x^{\\top} P B_A u + u^2 \\right) = 2 x^{\\top} P B_A + 2u = 0\n$$\n这得出了最优状态反馈控制律：\n$$\nu^{\\star}(t) = - B_A^{\\top} P x(t)\n$$\n将 $u^\\star$ 代回 HJB 方程，得到代数 Riccati 方程 (ARE)：\n$$\nx^{\\top} (A_A^{\\top} P + P A_A - P B_A R^{-1} B_A^{\\top} P + Q) x = 0\n$$\n由于这对所有 $x$ 都必须成立，所以矩阵表达式必须为零：\n$$\nA_A^{\\top} P + P A_A - P B_A B_A^{\\top} P + Q = 0\n$$\n我们代入模型 A 的矩阵：$A_A = \\begin{pmatrix} -1 & 0 \\\\ 0 & 1 \\end{pmatrix}$，$B_A = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，$Q = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$。设 $P = \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{{pmatrix}$。\n项 $P B_A B_A^{\\top} P$ 变为：\n$$\nP \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix} P = \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} = \\begin{pmatrix} 0 & p_{12} \\\\ 0 & p_{22} \\end{pmatrix} \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} = \\begin{pmatrix} p_{12}^2 & p_{12}p_{22} \\\\ p_{12}p_{22} & p_{22}^2 \\end{pmatrix}\n$$\n项 $A_A^{\\top} P + P A_A$（其中 $A_A$ 是对称的）为：\n$$\nA_A P + P A_A = \\begin{pmatrix} -1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} + \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} \\begin{pmatrix} -1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} -2p_{11} & 0 \\\\ 0 & 2p_{22} \\end{pmatrix}\n$$\n因此，ARE 变为矩阵方程：\n$$\n\\begin{pmatrix} -2p_{11} & 0 \\\\ 0 & 2p_{22} \\end{pmatrix} - \\begin{pmatrix} p_{12}^2 & p_{12}p_{22} \\\\ p_{12}p_{22} & p_{22}^2 \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\n这给出了一个标量方程组：\n1. (1,1): $-2p_{11} - p_{12}^2 + 1 = 0$\n2. (1,2): $-p_{12}p_{22} = 0$\n3. (2,2): $2p_{22} - p_{22}^2 + 1 = 0 \\implies p_{22}^2 - 2p_{22} - 1 = 0$\n由方程 (3)，$p_{22} = \\frac{2 \\pm \\sqrt{4-4(-1)}}{2} = 1 \\pm \\sqrt{2}$。由于为了使成本有限且闭环系统稳定，$P$ 必须是正定的，其对角元素必须为正。因此，我们必须选择正根：$p_{22} = 1 + \\sqrt{2}$。\n由方程 (2)，因为 $p_{22} \\neq 0$，我们必有 $p_{12} = 0$。\n由方程 (1)，$-2p_{11} - 0^2 + 1 = 0 \\implies p_{11} = \\frac{1}{2}$。\n唯一的对称正定解是：\n$$\nP = \\begin{pmatrix} \\frac{1}{2} & 0 \\\\ 0 & 1+\\sqrt{2} \\end{pmatrix}\n$$\n二次型价值函数为 $V(x) = x^{\\top} P x = \\frac{1}{2}x_1^2 + (1+\\sqrt{2})x_2^2$。\n\n第三，我们计算在初始状态 $x_0 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 下模型 A 的最优成本。\n最优成本 $J^{\\star}(x_0)$ 由价值函数在初始状态下的取值给出，即 $J^{\\star}(x_0) = V(x_0) = x_0^{\\top} P x_0$。\n$$\nJ^{\\star}(x_0) = \\begin{pmatrix} 1 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} & 0 \\\\ 0 & 1+\\sqrt{2} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ 1+\\sqrt{2} \\end{pmatrix} = \\frac{1}{2} + 1 + \\sqrt{2} = \\frac{3}{2} + \\sqrt{2}\n$$\n\n最后，我们解释模型 B 为什么无法获得有限的最优成本。\n模型 B 的动态方程由 $\\dot{x}(t) = A_B x(t) + B_B u(t)$ 给出。以分量形式表示，其中 $x(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$：\n$$\n\\dot{x}_1(t) = x_1(t)\n$$\n$$\n\\dot{x}_2(t) = -x_2(t) + u(t)\n$$\n关键的观察是，第一个状态 $x_1(t)$ 的动态完全独立于控制输入 $u(t)$。方程 $\\dot{x}_1(t) = x_1(t)$ 是一个不稳定的一阶系统。其解为 $x_1(t) = x_1(0) e^t$。\n这对应于系统不能稳的事实，因为与特征值 $\\lambda=1$ 相关的不稳定模式是不能控的。\n需要最小化的性能指标是：\n$$\nJ(x_{0},u) = \\int_{0}^{\\infty} \\left( x_1(t)^2 + x_2(t)^2 + u(t)^2 \\right) dt\n$$\n考虑任何初始条件 $x_0$，其第一个分量非零，即 $x_1(0) \\neq 0$。$x_1(t)$ 的状态轨迹固定为 $x_1(t) = x_1(0)e^t$，无论控制作用 $u(t)$ 如何。因此，成本积分包含以下项：\n$$\n\\int_{0}^{\\infty} x_1(t)^2 dt = \\int_{0}^{\\infty} (x_1(0)e^t)^2 dt = x_1(0)^2 \\int_{0}^{\\infty} e^{2t} dt\n$$\n此积分发散：\n$$\n\\int_{0}^{\\infty} e^{2t} dt = \\lim_{T \\to \\infty} \\left[ \\frac{1}{2}e^{2t} \\right]_{0}^{T} = \\lim_{T \\to \\infty} \\frac{1}{2}(e^{2T} - 1) = \\infty\n$$\n由于 $J(x_0, u)$ 的被积函数是一系列非负项之和，其中一项的积分为无穷大，因此只要 $x_1(0) \\neq 0$，对于任何控制函数 $u(t)$ 的选择，总成本 $J(x_0, u)$ 都必然是无穷大。\n最优成本，作为所有控制输入的下确界，$J^{\\star}(x_0) = \\inf_u J(x_0, u)$，也必定是无穷大。这种无法获得有限成本的情况是系统不能稳的直接后果：存在一个不能控的不稳定模式，使得无法阻止状态发散，这反过来又导致积分成本发散。", "answer": "$$\\boxed{\\frac{3}{2} + \\sqrt{2}}$$", "id": "2913486"}, {"introduction": "经典的 LQR 问题通常假设状态 $x$ 和控制输入 $u$ 在代价函数中是解耦的（即交叉权重项 $S=0$）。然而，在许多实际应用中，对状态和控制的某种组合进行惩罚是必要的。这个练习将引导您推导并求解一个带有非零交叉权重项 $S$ 的 LQR 问题，从而得到一个广义的代数 Riccati 方程 (ARE)，并计算相应的最优反馈增益 $K$ [@problem_id:2913482]。通过这个实践，您将掌握处理更一般化二次型代价函数的能力，并验证所得闭环系统的稳定性。", "problem": "考虑一个连续时间线性时不变状态空间模型，其状态为 $x \\in \\mathbb{R}^{2}$，输入为 $u \\in \\mathbb{R}$，由下式给出\n$$\n\\dot{x}(t) = A x(t) + B u(t),\n$$\n其中\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}.\n$$\n设无限时域二次性能指标为\n$$\nJ(u) = \\int_{0}^{\\infty} \\left( x(t)^{\\top} Q x(t) + 2\\, x(t)^{\\top} S\\, u(t) + u(t)^{\\top} R\\, u(t) \\right) \\, \\mathrm{d}t,\n$$\n其中对称状态权重 $Q \\in \\mathbb{R}^{2 \\times 2}$、交叉权重 $S \\in \\mathbb{R}^{2 \\times 1}$ 和正定输入权重 $R \\in \\mathbb{R}^{1 \\times 1}$ 选择为\n$$\nQ = \\begin{pmatrix} 4 & 2 \\\\ 2 & 2 \\end{pmatrix}, \\quad S = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad R = \\begin{pmatrix} 1 \\end{pmatrix}.\n$$\n使用最优控制的基本原理（例如 Hamilton–Jacobi–Bellman 方程或 Pontryagin 最小值原理），推导具有非零交叉权重 $S$ 的线性二次调节器 (LQR) 的代数最优性条件，并确定最优二次值函数矩阵 $P \\in \\mathbb{R}^{2 \\times 2}$ 以及控制律 $u^{\\star}(t) = - K x(t)$ 中对应的最优状态反馈增益 $K \\in \\mathbb{R}^{1 \\times 2}$。然后，通过计算闭环矩阵 $A - B K$ 的特征值来验证闭环稳定性。\n\n作为最终报告量，请提供谱横坐标，即闭环矩阵 $A - B K$ 特征值实部的最大值。不需要四舍五入，也不需要单位。", "solution": "所述问题需要进行验证。\n\n步骤 1：提取已知条件。\n连续时间线性时不变 (LTI) 系统由 $\\dot{x}(t) = A x(t) + B u(t)$ 给出，其中状态为 $x \\in \\mathbb{R}^{2}$，输入为 $u \\in \\mathbb{R}$。\n系统矩阵为：\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}.\n$$\n无限时域二次性能指标为：\n$$\nJ(u) = \\int_{0}^{\\infty} \\left( x(t)^{\\top} Q x(t) + 2\\, x(t)^{\\top} S\\, u(t) + u(t)^{\\top} R\\, u(t) \\right) \\, \\mathrm{d}t.\n$$\n权重矩阵为：\n$$\nQ = \\begin{pmatrix} 4 & 2 \\\\ 2 & 2 \\end{pmatrix}, \\quad S = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad R = \\begin{pmatrix} 1 \\end{pmatrix}.\n$$\n任务是求解最优二次值函数矩阵 $P$、最优状态反馈增益 $K$ 以及闭环系统 $A - B K$ 的谱横坐标。\n\n步骤 2：使用提取的已知条件进行验证。\n该问题是带有交叉权重项 $S$ 的标准线性二次调节器 (LQR) 公式。为了使无限时域 LQR 问题存在唯一的稳定解，必须满足某些条件。\n首先，矩阵对 $(A, B)$ 必须是可镇定的。我们检查可控性，这是一个更强的条件。可控性矩阵为 $\\mathcal{C} = \\begin{pmatrix} B & AB \\end{pmatrix}$。\n$$\nAB = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}.\n$$\n$$\n\\mathcal{C} = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}.\n$$\n$\\mathcal{C}$ 的秩为 $2$，等于状态空间的维度。因此，该系统是可控的，从而也是可镇定的。\n其次，输入权重矩阵 $R$ 必须是正定的。此处，$R = (1)$ 是一个正标量，因此该条件得到满足。\n第三，矩阵 $Q' = \\begin{pmatrix} Q & S \\\\ S^{\\top} & R \\end{pmatrix}$ 必须是半正定的，这等价于 $R > 0$ 和 $Q - S R^{-1} S^{\\top} \\ge 0$。我们来计算 $\\bar{Q} = Q - S R^{-1} S^{\\top}$。\n由于 $R = 1$，我们有 $R^{-1} = 1$。\n$$\nS R^{-1} S^{\\top} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (1) \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}.\n$$\n$$\n\\bar{Q} = Q - S R^{-1} S^{\\top} = \\begin{pmatrix} 4 & 2 \\\\ 2 & 2 \\end{pmatrix} - \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 3 & 2 \\\\ 2 & 2 \\end{pmatrix}.\n$$\n为了检查 $\\bar{Q}$ 是否为半正定，我们应用 Sylvester 准则。第一个主子式为 $3 > 0$。第二个主子式（行列式）为 $(3)(2) - (2)(2) = 6 - 4 = 2 > 0$。由于所有主子式均为正，$\\bar{Q}$ 是正定的。这意味着矩阵对 $(A, C)$（其中 $C^{\\top}C = \\bar{Q}$）是可观测的，这满足了所需的可检测性条件。\n\n步骤 3：结论与行动。\n该问题具有科学依据，提法恰当，客观且完整。存在唯一稳定 LQR 控制器的所有条件均已满足。该问题有效。我们开始求解。\n\nLQR 问题的解源自 Hamilton-Jacobi-Bellman (HJB) 方程。我们寻求一个二次值函数 $V(x) = x^{\\top}Px$，其中 $P$ 是一个对称正定矩阵。无限时域问题的 HJB 方程为：\n$$\n\\min_{u} \\left[ \\nabla_x V(x) \\cdot (Ax + Bu) + x^{\\top}Qx + 2x^{\\top}Su + u^{\\top}Ru \\right] = 0.\n$$\n由于 $\\nabla_x V(x) = 2x^{\\top}P$，哈密顿量为：\n$$\nH(x, u) = 2x^{\\top}P(Ax + Bu) + x^{\\top}Qx + 2x^{\\top}Su + u^{\\top}Ru = x^{\\top}(A^{\\top}P + PA + Q)x + 2x^{\\top}(PB + S)u + u^{\\top}Ru.\n$$\n为了找到最优控制 $u^{\\star}$，我们将哈密顿量对 $u$ 的梯度设为零：\n$$\n\\frac{\\partial H}{\\partial u} = 2(PB + S)^{\\top}x + 2Ru = 0.\n$$\n假设 $R$ 可逆，求解 $u^{\\star}$：\n$$\nu^{\\star}(t) = -R^{-1}(PB + S)^{\\top}x(t) = -R^{-1}(B^{\\top}P + S^{\\top})x(t).\n$$\n这定义了最优状态反馈增益矩阵 $K = R^{-1}(B^{\\top}P + S^{\\top})$。\n将 $u^{\\star}$ 代回 HJB 方程（$H(x, u^{\\star}) = 0$）得到关于矩阵 $P$ 的代数 Riccati 方程 (ARE)：\n$$\nA^{\\top}P + PA + Q - (PB + S)R^{-1}(B^{\\top}P + S^{\\top}) = 0.\n$$\n设 $P = \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix}$ 为对称矩阵解。我们使用给定的矩阵计算 ARE 的各项。\n$$\nA^{\\top}P + PA = \\begin{pmatrix} 0 & 0 \\\\ 1 & 0 \\end{pmatrix} \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} + \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & p_{11} \\\\ p_{11} & 2p_{12} \\end{pmatrix}.\n$$\n项 $(PB + S)R^{-1}(B^{\\top}P + S^{\\top})$ 计算如下：\n$R^{-1} = 1$。\n$$\nPB = \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} p_{12} \\\\ p_{22} \\end{pmatrix}.\n$$\n$$\nPB + S = \\begin{pmatrix} p_{12} \\\\ p_{22} \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} p_{12} + 1 \\\\ p_{22} \\end{pmatrix}.\n$$\n$$\n(PB + S)R^{-1}(B^{\\top}P + S^{\\top}) = \\begin{pmatrix} p_{12} + 1 \\\\ p_{22} \\end{pmatrix} (1) \\begin{pmatrix} p_{12} + 1 & p_{22} \\end{pmatrix} = \\begin{pmatrix} (p_{12} + 1)^{2} & p_{22}(p_{12} + 1) \\\\ p_{22}(p_{12} + 1) & p_{22}^{2} \\end{pmatrix}.\n$$\n将这些表达式代入 ARE 中得到：\n$$\n\\begin{pmatrix} 0 & p_{11} \\\\ p_{11} & 2p_{12} \\end{pmatrix} + \\begin{pmatrix} 4 & 2 \\\\ 2 & 2 \\end{pmatrix} - \\begin{pmatrix} (p_{12} + 1)^{2} & p_{22}(p_{12} + 1) \\\\ p_{22}(p_{12} + 1) & p_{22}^{2} \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}.\n$$\n该矩阵方程产生了一个关于 $p_{11}$、$p_{12}$ 和 $p_{22}$ 的三个标量代数方程组：\n1. $(1,1)$: $4 - (p_{12} + 1)^{2} = 0$\n2. $(1,2)$: $p_{11} + 2 - p_{22}(p_{12} + 1) = 0$\n3. $(2,2)$: $2p_{12} + 2 - p_{22}^{2} = 0$\n\n由方程 $(1)$，$(p_{12} + 1)^{2} = 4$，这意味着 $p_{12} + 1 = 2$ 或 $p_{12} + 1 = -2$。\n闭环系统矩阵为 $A_{cl} = A - BK$。\n$$\nK = R^{-1}(B^{\\top}P + S^{\\top}) = \\begin{pmatrix} p_{12} + 1 & p_{22} \\end{pmatrix}.\n$$\n$$\nA_{cl} = A - BK = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} p_{12} + 1 & p_{22} \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -(p_{12} + 1) & -p_{22} \\end{pmatrix}.\n$$\n为了实现渐近稳定性，$A_{cl}$ 的特征值必须具有负实部。特征多项式为 $\\lambda^{2} - \\text{tr}(A_{cl})\\lambda + \\det(A_{cl}) = 0$，即 $\\lambda^{2} + p_{22}\\lambda + (p_{12} + 1) = 0$。对于二阶系统，稳定性要求特征多项式的所有系数均为正。因此，我们必须有 $p_{22} > 0$ 和 $p_{12} + 1 > 0$。\n在 $p_{12}+1 = \\pm 2$ 的选择中，我们必须选择正值 $p_{12} + 1 = 2$，这得到 $p_{12} = 1$。\n\n现在，从方程 $(3)$，我们求解 $p_{22}$：\n$2p_{12} + 2 - p_{22}^{2} = 0 \\implies 2(1) + 2 - p_{22}^{2} = 0 \\implies 4 - p_{22}^{2} = 0$。\n这得到 $p_{22} = \\pm 2$。为了稳定性（$p_{22} > 0$），我们必须选择 $p_{22} = 2$。\n\n最后，从方程 $(2)$，我们求解 $p_{11}$：\n$p_{11} + 2 - p_{22}(p_{12} + 1) = 0 \\implies p_{11} + 2 - (2)(2) = 0 \\implies p_{11} - 2 = 0$。\n所以，$p_{11} = 2$。\n\nARE 的唯一稳定对称正定解为：\n$$\nP = \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}.\n$$\n对应的最优状态反馈增益为：\n$$\nK = \\begin{pmatrix} p_{12} + 1 & p_{22} \\end{pmatrix} = \\begin{pmatrix} 2 & 2 \\end{pmatrix}.\n$$\n使用此增益，闭环系统矩阵变为：\n$$\nA - BK = \\begin{pmatrix} 0 & 1 \\\\ -2 & -2 \\end{pmatrix}.\n$$\n为验证闭环稳定性，我们计算 $A - BK$ 的特征值。特征方程为 $\\det(\\lambda I - (A - BK)) = 0$：\n$$\n\\det \\begin{pmatrix} \\lambda & -1 \\\\ 2 & \\lambda + 2 \\end{pmatrix} = \\lambda(\\lambda + 2) - (-1)(2) = \\lambda^{2} + 2\\lambda + 2 = 0.\n$$\n使用二次公式，特征值为：\n$$\n\\lambda = \\frac{-2 \\pm \\sqrt{2^{2} - 4(1)(2)}}{2(1)} = \\frac{-2 \\pm \\sqrt{4 - 8}}{2} = \\frac{-2 \\pm \\sqrt{-4}}{2} = \\frac{-2 \\pm 2i}{2}.\n$$\n特征值为 $\\lambda_{1} = -1 + i$ 和 $\\lambda_{2} = -1 - i$。两者的实部均为 $-1$，是负数，这证实了闭环系统的稳定性。\n\n谱横坐标是闭环矩阵 $A - BK$ 特征值实部的最大值。\n$$\n\\alpha(A - BK) = \\max(\\text{Re}(\\lambda_{1}), \\text{Re}(\\lambda_{2})) = \\max(-1, -1) = -1.\n$$\n这是要报告的最终量。", "answer": "$$\n\\boxed{-1}\n$$", "id": "2913482"}, {"introduction": "理论上在连续时域设计的 LQR 控制器，在实际应用中几乎总是在数字计算机上以离散时间方式实现的。这个过程引入了采样，可能会降低性能甚至导致不稳定性。本练习要求您通过编程来量化比较两种策略：直接在采样系统上应用连续时间增益 $K_{c}$，以及为离散化模型重新设计一个最优的离散时间 LQR 控制器 $K_{d}$ [@problem_id:2913488]。通过分析不同采样周期下的稳定性裕度，您将获得关于数字控制实现中采样效应和保持最优性重要性的宝贵实践经验。", "problem": "考虑由微分方程 $\\,\\dot{x}(t) = A x(t) + B u(t)\\,$ 给出的连续时间线性时不变状态空间模型，其状态为 $\\,x(t) \\in \\mathbb{R}^{2}\\,$，控制输入为 $\\,u(t) \\in \\mathbb{R}\\,$，其中\n$$\nA = \\begin{bmatrix} 0 & 1 \\\\ 0 & 0 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}.\n$$\n要求您设计连续时间和离散时间下的线性二次调节器 (LQR) 状态反馈律，并比较它们在不同采样周期下的闭环稳定性裕度。性能权重由二次型成本指定，其矩阵为\n$$\nQ = \\begin{bmatrix} 10 & 0 \\\\ 0 & 1 \\end{bmatrix}, \\quad R = \\begin{bmatrix} 1 \\end{bmatrix}.\n$$\n连续时间性能指标由下式给出\n$$\nJ = \\int_{0}^{\\infty} \\left( x(t)^{\\top} Q x(t) + u(t)^{\\top} R u(t) \\right)\\, dt.\n$$\n请仅使用基本定义与经过充分验证的结果，按如下步骤进行。首先，通过求解由上述 $\\,A, B, Q, R\\,$ 的 Hamilton–Jacobi–Bellman 最优性条件所产生的连续时间代数 Riccati 方程，计算最优连续时间 LQR 增益 $\\,K_{c}\\,$。然后，对每个指定的采样周期，建立精确的零阶保持离散时间模型，并通过求解相应采样模型的离散时间代数 Riccati 方程，计算最优离散时间 LQR 增益 $\\,K_{d}\\,$。\n\n定义以下闭环稳定性裕度度量。\n1. 对于连续时间闭环 $\\,\\dot{x}(t) = (A - B K_{c}) x(t)\\,$, 定义裕度\n$$\nm_{c} \\triangleq - \\max \\left\\{ \\operatorname{Re}(\\lambda) : \\lambda \\in \\sigma(A - B K_{c}) \\right\\}.\n$$\n该 $\\,m_{c}\\,$ 为正当且仅当连续时间闭环系统是渐近稳定的，并且它度量了最右侧的闭环特征值位于开放左半复平面内的深度。\n\n2. 对于给定的采样周期 $\\,T > 0\\,$，令 $\\,A_{d}(T)\\,$ 和 $\\,B_{d}(T)\\,$ 表示 $\\,A\\,$ 和 $\\,B\\,$ 在采样周期 $\\,T\\,$ 下的精确零阶保持离散化，因此\n$$\nA_{d}(T) = e^{A T}, \\quad B_{d}(T) = \\int_{0}^{T} e^{A \\tau} B \\, d\\tau.\n$$\n对于使用连续时间增益 $\\,K_{c}\\,$ 的采样数据闭环实现，定义\n$$\nm_{d}^{(c)}(T) \\triangleq 1 - \\rho\\!\\left( A_{d}(T) - B_{d}(T) K_{c} \\right),\n$$\n而对于直接在 $\\,\\big(A_{d}(T), B_{d}(T)\\big)\\,$ 上设计、阶段权重为 $\\,Q\\,$ 和 $\\,R\\,$ 的离散时间 LQR 增益 $\\,K_{d}\\,$，定义\n$$\nm_{d}^{(d)}(T) \\triangleq 1 - \\rho\\!\\left( A_{d}(T) - B_{d}(T) K_{d} \\right),\n$$\n其中 $\\,\\rho(\\cdot)\\,$ 表示谱半径。每个离散时间裕度 $\\,m_{d}^{(\\cdot)}(T)\\,$ 为正当且仅当对应的离散时间闭环系统是渐近稳定的，并且它度量了主导闭环特征值的模位于复平面开放单位圆盘内的深度。\n\n构建一个程序，对测试集\n$$\n\\mathcal{T} = \\{\\, 0.01, \\; 0.1, \\; 0.5, \\; 1.0, \\; 2.0 \\,\\},\n$$\n中的每个采样周期执行以下操作，并使用精确零阶保持离散化：\n1. 对于 $\\,T \\in \\mathcal{T}\\,$，使用矩阵指数和积分定义计算 $\\,A_{d}(T)\\,$ 和 $\\,B_{d}(T)\\,$。\n2. 根据 $\\,A, B, Q, R\\,$ 计算连续时间 LQR 增益 $\\,K_{c}\\,$，并为每对 $\\,\\big(A_{d}(T), B_{d}(T)\\big)\\,$ 在相同的 $\\,Q, R\\,$ 下计算离散时间 LQR 增益 $\\,K_{d}\\,$。\n3. 计算如上定义的稳定性裕度 $\\,m_{c}\\,$, $\\,m_{d}^{(c)}(T)\\,$ 和 $\\,m_{d}^{(d)}(T)\\,$。同时报告相应的离散时间闭环稳定性布尔值\n$$\ns_{d}^{(c)}(T) \\triangleq \\big( m_{d}^{(c)}(T) > 0 \\big), \\quad s_{d}^{(d)}(T) \\triangleq \\big( m_{d}^{(d)}(T) > 0 \\big).\n$$\n\n您的程序必须生成单行输出，其中包含结果，形式为一个用方括号括起来的逗号分隔列表。对于每个 $\\,T \\in \\mathcal{T}\\,$，输出一个列表\n$$\n[\\, T, \\; m_{c}, \\; m_{d}^{(c)}(T), \\; m_{d}^{(d)}(T), \\; s_{d}^{(c)}(T), \\; s_{d}^{(d)}(T) \\,],\n$$\n最终输出将是这些列表组成的列表，其顺序与 $\\,\\mathcal{T}\\,$ 相同，例如\n$$\n\\big[ [\\, \\cdot \\,], [\\, \\cdot \\,], \\ldots, [\\, \\cdot \\,] \\big].\n$$\n所有数值必须由您的程序计算。不涉及物理单位，也不使用角度。最终输出必须是包含此列表的单行文本，其中浮点数采用标准十进制表示法，布尔值以逻辑常量的形式给出。该解决方案应具有完全的通用性，且不依赖任何外部输入。", "solution": "问题陈述经过严格验证，证实有效。这是一个现代控制理论中的标准、适定问题，涉及为一个连续时间系统及其离散时间对应系统设计和分析线性二次调节器 (LQR)。该系统是一个双重积分器，在给定的成本矩阵下，系统是可控且可观测的，这保证了稳定的 LQR 解的存在性和唯一性。所有定义和参数都清晰给出，且在科学上是合理的。我们将着手进行求解。\n\n该问题需要一个系统化的流程，包括连续时间 LQR 设计、系统离散化、离散时间 LQR 设计和稳定性分析。\n\n**1. 连续时间 LQR 设计**\n\n最优连续时间状态反馈控制律由 $u(t) = -K_c x(t)$ 给出，其中增益矩阵 $K_c$ 计算为 $K_c = R^{-1} B^\\top P_c$。矩阵 $P_c$ 是连续时间代数 Riccati 方程 (CARE) 的唯一对称正定解：\n$$\nA^\\top P_c + P_c A - P_c B R^{-1} B^\\top P_c + Q = 0\n$$\n给定系统矩阵 $A = \\begin{bmatrix} 0 & 1 \\\\ 0 & 0 \\end{bmatrix}$，$B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$ 和成本矩阵 $Q = \\begin{bmatrix} 10 & 0 \\\\ 0 & 1 \\end{bmatrix}$，$R = [1]$。令 $P_c = \\begin{bmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{bmatrix}$。CARE 展开为以下代数方程组：\n\\begin{enumerate}\n    \\item $-p_{12}^2 + 10 = 0$\n    \\item $p_{11} - p_{12} p_{22} = 0$\n    \\item $2 p_{12} - p_{22}^2 + 1 = 0$\n\\end{enumerate}\n从(1)中，为与此类系统的最优调节器理论保持一致，我们选择正根 $p_{12} = \\sqrt{10}$。从(3)中，我们得到 $p_{22}^2 = 1 + 2\\sqrt{10}$，因此 $p_{22} = \\sqrt{1 + 2\\sqrt{10}}$（因为 $P_c$ 必须是正定的）。从(2)中，我们得到 $p_{11} = p_{12} p_{22} = \\sqrt{10}\\sqrt{1 + 2\\sqrt{10}}$。\n因此解为：\n$$\nP_c = \\begin{bmatrix} \\sqrt{10}\\sqrt{1+2\\sqrt{10}} & \\sqrt{10} \\\\ \\sqrt{10} & \\sqrt{1+2\\sqrt{10}} \\end{bmatrix}\n$$\n最优连续时间增益为：\n$$\nK_c = R^{-1} B^\\top P_c = [1] \\begin{bmatrix} 0 & 1 \\end{bmatrix} P_c = \\begin{bmatrix} p_{12} & p_{22} \\end{bmatrix} = \\left[ \\sqrt{10}, \\; \\sqrt{1 + 2\\sqrt{10}} \\right]\n$$\n连续时间闭环系统矩阵为 $A_{cl,c} = A - B K_c$：\n$$\nA_{cl,c} = \\begin{bmatrix} 0 & 1 \\\\ -\\sqrt{10} & -\\sqrt{1 + 2\\sqrt{10}} \\end{bmatrix}\n$$\n$A_{cl,c}$ 的特征值 $\\lambda$ 是其特征多项式 $\\lambda^2 + \\sqrt{1 + 2\\sqrt{10}} \\lambda + \\sqrt{10} = 0$ 的根。这些特征值的实部为 $\\operatorname{Re}(\\lambda) = -\\frac{\\sqrt{1 + 2\\sqrt{10}}}{2}$。\n因此，连续时间稳定性裕度 $m_c$ 为：\n$$\nm_c = - \\max \\left\\{ \\operatorname{Re}(\\lambda) \\right\\} = \\frac{\\sqrt{1 + 2\\sqrt{10}}}{2}\n$$\n\n**2. 系统离散化**\n\n对于给定的采样周期 $T > 0$，连续时间系统的精确零阶保持离散化由对 $(A_d(T), B_d(T))$ 给出，其中：\n$$\nA_d(T) = e^{AT}, \\quad B_d(T) = \\left( \\int_0^T e^{A\\tau} d\\tau \\right) B\n$$\n矩阵 $A$ 是幂零矩阵，即 $A^2=0$。这简化了矩阵指数的计算：\n$$\nA_d(T) = e^{AT} = I + AT = \\begin{bmatrix} 1 & T \\\\ 0 & 1 \\end{bmatrix}\n$$\n$B_d(T)$ 的积分变为：\n$$\nB_d(T) = \\left( \\int_0^T (I + A\\tau) d\\tau \\right) B = \\left( IT + A\\frac{T^2}{2} \\right) B = \\begin{bmatrix} T & T^2/2 \\\\ 0 & T \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} T^2/2 \\\\ T \\end{bmatrix}\n$$\n对于测试集 $\\mathcal{T}$ 中的每个 $T$，都将计算这些矩阵。\n\n**3. 离散时间 LQR 设计**\n\n对于每个离散时间系统 $(A_d(T), B_d(T))$，我们使用相同的成本矩阵 $Q$ 和 $R$ 设计一个离散时间 LQR。最优控制律为 $u_k = -K_d x_k$，其中增益 $K_d(T)$ 通过求解离散时间代数 Riccati 方程 (DARE) 得到：\n$$\nP_d = A_d^\\top P_d A_d - (A_d^\\top P_d B_d)(R + B_d^\\top P_d B_d)^{-1}(B_d^\\top P_d A_d) + Q\n$$\n那么，最优离散时间增益为：\n$$\nK_d(T) = (R + B_d^\\top P_d B_d)^{-1} (B_d^\\top P_d A_d)\n$$\n其中 $P_d$ 是 DARE 的唯一对称正定解。由于对于任何 $T > 0$，对 $(A_d(T), B_d(T))$ 都是可控的，且对 $(A_d(T), \\sqrt{Q})$ 是可检测的，因此存在唯一的稳定解。\n\n**4. 稳定性裕度计算**\n\n程序将为 $\\mathcal{T}$ 中的每个 $T$ 计算三个稳定性裕度：\n\\begin{enumerate}\n    \\item $m_c$：恒定的连续时间裕度，已在上文推导。\n    \\item $m_d^{(c)}(T)$：使用连续时间增益 $K_c$ 的采样数据系统的裕度。闭环矩阵为 $A_{cl,d}^{(c)} = A_d(T) - B_d(T) K_c$。裕度为 $m_d^{(c)}(T) = 1 - \\rho(A_{cl,d}^{(c)})$，其中 $\\rho(\\cdot)$ 表示谱半径（特征值模的最大值）。对于较大的 $T$，此裕度可能为负，表明系统不稳定。\n    \\item $m_d^{(d)}(T)$：离散时间 LQR 设计的裕度。闭环矩阵为 $A_{cl,d}^{(d)} = A_d(T) - B_d(T) K_d(T)$。裕度为 $m_d^{(d)}(T) = 1 - \\rho(A_{cl,d}^{(d)})$。根据设计，离散时间 LQR 提供了稳定的闭环系统，因此我们预期对于所有 $T$，都有 $m_d^{(d)}(T) > 0$。\n\\end{enumerate}\n相应的稳定性布尔值 $s_d^{(c)}(T)$ 和 $s_d^{(d)}(T)$ 根据这些裕度的符号进行评估。\n\n以下程序实现了这整个过程。它使用来自 `numpy` 和 `scipy` 的成熟数值线性代数例程来求解 Riccati 方程和计算特征值，从而确保准确性和鲁棒性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Solves the LQR design problem for continuous and discrete-time systems.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [0.01, 0.1, 0.5, 1.0, 2.0]\n\n    # System and cost matrices\n    A = np.array([[0.0, 1.0], [0.0, 0.0]])\n    B = np.array([[0.0], [1.0]])\n    Q = np.array([[10.0, 0.0], [0.0, 1.0]])\n    R = np.array([[1.0]])\n    n = A.shape[0]\n    m = B.shape[1]\n\n    # --- Continuous-Time LQR Design ---\n    # Solve the Continuous-time Algebraic Riccati Equation (CARE)\n    Pc = linalg.solve_continuous_are(A, B, Q, R)\n    # Compute the continuous-time LQR gain Kc\n    Kc = np.linalg.inv(R) @ B.T @ Pc\n    # Compute the continuous-time closed-loop system matrix\n    A_cl_c = A - B @ Kc\n    # Compute the eigenvalues and the stability margin mc\n    eigvals_c = linalg.eigvals(A_cl_c)\n    mc = -np.max(np.real(eigvals_c))\n\n    results = []\n    for T in test_cases:\n        # --- System Discretization (Zero-Order Hold) ---\n        # The analytical solution is simple for this nilpotent system.\n        Ad = np.array([[1.0, T], [0.0, 1.0]])\n        Bd = np.array([[T**2 / 2.0], [T]])\n\n        # An alternative, more general numerical method using matrix exponential:\n        # M = np.zeros((n + m, n + m))\n        # M[:n, :n] = A\n        # M[:n, n:] = B\n        # M_exp = linalg.expm(M * T)\n        # Ad_num = M_exp[:n, :n]\n        # Bd_num = M_exp[:n, n:]\n        # np.allclose(Ad, Ad_num) and np.allclose(Bd, Bd_num) would be True\n\n        # --- Discrete-Time LQR Design ---\n        # Solve the Discrete-time Algebraic Riccati Equation (DARE)\n        Pd = linalg.solve_discrete_are(Ad, Bd, Q, R)\n        # Compute the discrete-time LQR gain Kd\n        Kd = np.linalg.inv(R + Bd.T @ Pd @ Bd) @ (Bd.T @ Pd @ Ad)\n\n        # --- Stability Margin Calculations ---\n        # 1. Sampled-data system with continuous gain Kc\n        A_cl_dc = Ad - Bd @ Kc\n        eigvals_dc = linalg.eigvals(A_cl_dc)\n        rho_c = np.max(np.abs(eigvals_dc))\n        md_c = 1.0 - rho_c\n        sd_c = md_c > 0\n\n        # 2. Discrete-time system with discrete gain Kd\n        A_cl_dd = Ad - Bd @ Kd\n        eigvals_dd = linalg.eigvals(A_cl_dd)\n        rho_d = np.max(np.abs(eigvals_dd))\n        md_d = 1.0 - rho_d\n        sd_d = md_d > 0\n        \n        # Assemble the results for the current sampling period T\n        # The output format requires a list of lists.\n        # Python's default str() for list items is used.\n        current_result = [T, mc, md_c, md_d, bool(sd_c), bool(sd_d)]\n        results.append(current_result)\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) converts each inner list to its string representation.\n    # The ','.join(...) concatenates them with commas.\n    # The outer f-string adds the final brackets.\n    # Example: '[[...],[...]]'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2913488"}]}