{"hands_on_practices": [{"introduction": "这项练习是控制理论中的一项基础实践 [@problem_id:2888317]。它将指导您为一个连续时间系统设计一个龙伯格观测器。核心技能是，通过将误差动力学矩阵的特征值放置在期望的位置，来控制状态估计的收敛速度，从而加深您对可观测性与任意配置观测器极点能力之间联系的理解。", "problem": "考虑连续时间线性时不变 (LTI) 状态空间模型\n$$\n\\dot{x}(t)=A\\,x(t),\\quad y(t)=C\\,x(t),\n$$\n其中 $x(t)\\in\\mathbb{R}^{2}$ 是状态， $y(t)\\in\\mathbb{R}$ 是测量输出。系统矩阵为\n$$\nA=\\begin{bmatrix}0&1\\\\-2&-3\\end{bmatrix},\\qquad C=\\begin{bmatrix}1&0\\end{bmatrix}.\n$$\n您需要为估计器设计一个连续时间 Luenberger 观测器 (LO) 增益 $L\\in\\mathbb{R}^{2\\times 1}$\n$$\n\\dot{\\hat{x}}(t)=A\\,\\hat{x}(t)+L\\big(y(t)-C\\,\\hat{x}(t)\\big),\n$$\n使得估计器误差动态能够实现渐近收敛，其特征值位于 $\\{-4,-5\\}$。从第一性原理出发：利用状态和输出方程以及观测器的定义来推导误差动态，利用能观性的定义来证明误差动态特征值的可配置性，然后通过将误差动态的特征多项式与目标多项式匹配来施加所需的特征值。提供能实现此目标的精确 $L$。将最终答案表示为一个 $1\\times 2$ 的行矩阵，其中按从上到下的顺序列出 $L$ 的元素。无需四舍五入，不涉及单位。", "solution": "问题陈述已经过验证，是有效的。这是一个线性系统理论中的适定问题，具体涉及观测器设计。所提供的信息是完整的、一致的且科学上合理的。所有术语都有定义，目标明确。我们可以开始求解。\n\n该问题要求为给定的连续时间 LTI 系统设计一个 Luenberger 观测器。系统动态由以下公式描述：\n$$\n\\dot{x}(t)=A\\,x(t)\n$$\n$$\ny(t)=C\\,x(t)\n$$\n其中状态 $x(t)\\in\\mathbb{R}^{2}$，输出 $y(t)\\in\\mathbb{R}$，系统矩阵为：\n$$\nA=\\begin{bmatrix}0&1\\\\-2&-3\\end{bmatrix},\\qquad C=\\begin{bmatrix}1&0\\end{bmatrix}\n$$\nLuenberger 观测器被设计用于通过系统模型和一个与输出估计误差成比例的修正项来估计状态 $x(t)$。状态估计值 $\\hat{x}(t)$ 的演化遵循以下方程：\n$$\n\\dot{\\hat{x}}(t)=A\\,\\hat{x}(t)+L\\big(y(t)-C\\,\\hat{x}(t)\\big)\n$$\n其中 $L \\in \\mathbb{R}^{2 \\times 1}$ 是我们必须确定的观测器增益矩阵。目标是将估计器误差动态的特征值配置在 $\\{-4, -5\\}$，以确保估计值 $\\hat{x}(t)$ 渐近收敛到真实状态 $x(t)$。\n\n首先，我们推导估计误差的动态，其定义为 $e(t) = x(t) - \\hat{x}(t)$。将误差对时间求导，得到：\n$$\n\\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t)\n$$\n代入 $\\dot{x}(t)$ 和 $\\dot{\\hat{x}}(t)$ 的表达式：\n$$\n\\dot{e}(t) = A\\,x(t) - \\left[ A\\,\\hat{x}(t)+L\\big(y(t)-C\\,\\hat{x}(t)\\big) \\right]\n$$\n现在，将 $y(t) = C\\,x(t)$ 代入该方程：\n$$\n\\dot{e}(t) = A\\,x(t) - A\\,\\hat{x}(t) - L\\big(C\\,x(t)-C\\,\\hat{x}(t)\\big)\n$$\n对各项进行因式分解，我们得到：\n$$\n\\dot{e}(t) = A\\big(x(t) - \\hat{x}(t)\\big) - L\\,C\\big(x(t) - \\hat{x}(t)\\big)\n$$\n考虑到 $e(t) = x(t) - \\hat{x}(t)$，误差动态由以下线性齐次微分方程决定：\n$$\n\\dot{e}(t) = (A - L\\,C)e(t)\n$$\n误差动态的稳定性，也就是 $\\hat{x}(t)$ 到 $x(t)$ 的收敛性，由矩阵 $A_e = A - L\\,C$ 的特征值决定。为使误差收敛到零，$A_e$ 的所有特征值都必须有负实部。问题要求将特征值配置在 $\\{-4, -5\\}$。\n\n通过选择 $L$ 来任意配置 $A - L\\,C$ 的特征值这一能力，当且仅当系统对 $(A, C)$ 是能观的时才能得到保证。我们必须验证这个条件。如果能观性矩阵 $\\mathcal{O}$ 是满秩的，则系统是能观的。对于 $n=2$ 的状态维数，这意味着 $\\text{rank}(\\mathcal{O})=2$。能观性矩阵构造如下：\n$$\n\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\end{bmatrix}\n$$\n首先，我们计算乘积 $CA$：\n$$\nCA = \\begin{bmatrix}1&0\\end{bmatrix} \\begin{bmatrix}0&1\\\\-2&-3\\end{bmatrix} = \\begin{bmatrix}(1)(0)+(0)(-2) & (1)(1)+(0)(-3)\\end{bmatrix} = \\begin{bmatrix}0&1\\end{bmatrix}\n$$\n现在，我们构造能观性矩阵 $\\mathcal{O}$：\n$$\n\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\end{bmatrix} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}\n$$\n这是 $2 \\times 2$ 的单位矩阵。其行列式为 $\\det(\\mathcal{O}) = 1 \\neq 0$，因此其秩为 $2$。由于 $\\mathcal{O}$ 的秩等于状态空间的维数，该系统是完全能观的。因此，通过选择合适的增益矩阵 $L$，误差动态矩阵 $A - L\\,C$ 的特征值可以被任意配置。\n\n我们现在着手求解 $L$。设增益矩阵为 $L = \\begin{bmatrix} l_1 \\\\ l_2 \\end{bmatrix}$。矩阵 $A - L\\,C$ 为：\n$$\nA - L\\,C = \\begin{bmatrix}0&1\\\\-2&-3\\end{bmatrix} - \\begin{bmatrix}l_1\\\\l_2\\end{bmatrix}\\begin{bmatrix}1&0\\end{bmatrix} = \\begin{bmatrix}0&1\\\\-2&-3\\end{bmatrix} - \\begin{bmatrix}l_1 & 0 \\\\ l_2 & 0\\end{bmatrix} = \\begin{bmatrix}-l_1 & 1 \\\\ -2-l_2 & -3\\end{bmatrix}\n$$\n该矩阵的特征值是其特征多项式 $p(\\lambda) = \\det(\\lambda I - (A - L\\,C))$ 的根。\n$$\n\\lambda I - (A - L\\,C) = \\begin{bmatrix}\\lambda & 0 \\\\ 0 & \\lambda\\end{bmatrix} - \\begin{bmatrix}-l_1 & 1 \\\\ -2-l_2 & -3\\end{bmatrix} = \\begin{bmatrix}\\lambda+l_1 & -1 \\\\ 2+l_2 & \\lambda+3\\end{bmatrix}\n$$\n特征多项式为：\n$$\np(\\lambda) = (\\lambda+l_1)(\\lambda+3) - (-1)(2+l_2) = \\lambda^2 + 3\\lambda + l_1\\lambda + 3l_1 + 2 + l_2\n$$\n$$\np(\\lambda) = \\lambda^2 + (3+l_1)\\lambda + (3l_1 + l_2 + 2)\n$$\n期望的特征值给定为 $\\{-4, -5\\}$。期望的特征多项式 $p_{des}(\\lambda)$ 由这些特征值构成：\n$$\np_{des}(\\lambda) = (\\lambda - (-4))(\\lambda - (-5)) = (\\lambda+4)(\\lambda+5) = \\lambda^2 + 9\\lambda + 20\n$$\n为了实现期望的极点配置，我们将实际特征多项式 $p(\\lambda)$ 的系数与期望多项式 $p_{des}(\\lambda)$ 的系数进行匹配：\n$$\n\\lambda^2 + (3+l_1)\\lambda + (3l_1 + l_2 + 2) = \\lambda^2 + 9\\lambda + 20\n$$\n比较 $\\lambda$ 的各次幂的系数：\n\\begin{enumerate}\n    \\item $\\lambda^1$ 的系数： $3+l_1 = 9$\n    \\item $\\lambda^0$ 的系数： $3l_1 + l_2 + 2 = 20$\n\\end{enumerate}\n从第一个方程，我们求得 $l_1$：\n$$\nl_1 = 9 - 3 = 6\n$$\n将 $l_1=6$ 代入第二个方程来求解 $l_2$：\n$$\n3(6) + l_2 + 2 = 20\n$$\n$$\n18 + l_2 + 2 = 20\n$$\n$$\n20 + l_2 = 20\n$$\n$$\nl_2 = 0\n$$\n因此，所需的观测器增益矩阵是：\n$$\nL = \\begin{bmatrix} 6 \\\\ 0 \\end{bmatrix}\n$$\n该增益确保误差动态 $\\dot{e}(t) = (A-LC)e(t)$ 的特征值位于 $\\{-4, -5\\}$，从而保证估计误差 $e(t)$ 渐近收敛到零。", "answer": "$$\n\\boxed{\\begin{pmatrix} 6 & 0 \\end{pmatrix}}\n$$", "id": "2888317"}, {"introduction": "超越确定性观测器，这项练习将带您进入随机状态估计的领域 [@problem_id:2888322]。您将执行卡尔曼滤波器的一个完整的预测-更新周期，该滤波器是处理高斯噪声系统的最优线性估计器。本练习将重点展示滤波器如何权衡来自系统模型（过程噪声）和测量（测量噪声）的不确定性，以更新估计误差的协方差。", "problem": "一个用于一维空间中匀速运动的离散时间线性时不变（LTI）状态空间模型由以下随机差分方程给出：\n$$\nx_{k+1} = A x_{k} + w_{k}, \\quad y_{k} = C x_{k} + v_{k},\n$$\n其中 $x_{k} \\in \\mathbb{R}^{2}$ 是状态，其分量为位置和速度，$y_{k} \\in \\mathbb{R}$ 是位置测量值，$w_{k}$ 是均值为零、协方差为 $Q$ 的过程噪声，$v_{k}$ 是均值为零、协方差为 $R$ 的测量噪声。假设采样间隔为 $1$ 个时间单位，因此\n$$\nA = \\begin{bmatrix} 1 & 1 \\\\ 0 & 1 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1 & 0 \\end{bmatrix}, \\quad Q = \\operatorname{diag}(0.01,\\,0.01), \\quad R = \\begin{bmatrix} 0.04 \\end{bmatrix}.\n$$\n假设在时刻 $k=0$ 的初始后验误差协方差为\n$$\nP_{0} = I_{2}.\n$$\n从此先验开始，执行一个完整的卡尔曼滤波器（KF）预测-更新周期，以获得在时刻 $k=1$ 的后验误差协方差。您的推导应从线性高斯系统的估计误差协方差和最小方差线性估计器的定义开始，并进行到用于预测和更新的协方差递推。计算协方差更新所需的所有中间量，但最终答案只报告在时刻 $k=1$ 的后验误差协方差矩阵。将报告的每个矩阵元素四舍五入到 $4$ 位有效数字。无需物理单位。", "solution": "用户提供的问题陈述已经过评估，并被确定为有效。这是一个在状态估计领域中提法恰当、有科学依据的问题，包含了通过标准卡尔曼滤波器算法获得唯一解所需的所有信息。对于一个理论练习来说，其参数是自洽且符合实际的。\n\n目标是计算在时刻 $k=1$ 的后验误差协方差矩阵，记为 $P_{1|1}$，而已知在时刻 $k=0$ 的后验误差协方差，记为 $P_{0|0}$。卡尔曼滤波器通过一个两步递归循环——预测（时间更新）步骤和更新（测量更新）步骤——来传播状态估计及其误差协方差，从而为带有高斯噪声的线性系统提供最优线性估计器。\n\n协方差传播方程如下。\n预测：\n$$\nP_{k|k-1} = A P_{k-1|k-1} A^T + Q\n$$\n更新：\n$$\nK_k = P_{k|k-1} C^T (C P_{k|k-1} C^T + R)^{-1}\n$$\n$$\nP_{k|k} = (I - K_k C) P_{k|k-1}\n$$\n此处，$P_{k|k-1}$ 是在时刻 $k$ 的先验误差协方差，$P_{k|k}$ 是在时刻 $k$ 的后验误差协方差。$K_k$ 是卡尔曼增益。\n\n给定的参数为：\n状态转移矩阵: $A = \\begin{bmatrix} 1 & 1 \\\\ 0 & 1 \\end{bmatrix}$\n测量矩阵: $C = \\begin{bmatrix} 1 & 0 \\end{bmatrix}$\n过程噪声协方差: $Q = \\begin{bmatrix} 0.01 & 0 \\\\ 0 & 0.01 \\end{bmatrix}$\n测量噪声协方差: $R = [0.04]$\n在 $k=0$ 时的初始后验误差协方差: $P_{0|0} = I_2 = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}$\n\n我们现在对 $k=1$ 执行一个完整的周期。\n\n**步骤 1：预测（时间更新）**\n\n我们使用在 $k=0$ 时的协方差状态来计算在 $k=1$ 时的先验误差协方差 $P_{1|0}$。\n$$\nP_{1|0} = A P_{0|0} A^T + Q\n$$\n代入给定值：\n$$\nA P_{0|0} A^T = \\begin{bmatrix} 1 & 1 \\\\ 0 & 1 \\end{bmatrix} \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} \\begin{bmatrix} 1 & 0 \\\\ 1 & 1 \\end{bmatrix} = \\begin{bmatrix} 1 & 1 \\\\ 0 & 1 \\end{bmatrix} \\begin{bmatrix} 1 & 0 \\\\ 1 & 1 \\end{bmatrix} = \\begin{bmatrix} 1 \\cdot 1 + 1 \\cdot 1 & 1 \\cdot 0 + 1 \\cdot 1 \\\\ 0 \\cdot 1 + 1 \\cdot 1 & 0 \\cdot 0 + 1 \\cdot 1 \\end{bmatrix} = \\begin{bmatrix} 2 & 1 \\\\ 1 & 1 \\end{bmatrix}\n$$\n现在，我们加上过程噪声协方差 $Q$：\n$$\nP_{1|0} = \\begin{bmatrix} 2 & 1 \\\\ 1 & 1 \\end{bmatrix} + \\begin{bmatrix} 0.01 & 0 \\\\ 0 & 0.01 \\end{bmatrix} = \\begin{bmatrix} 2.01 & 1 \\\\ 1 & 1.01 \\end{bmatrix}\n$$\n这是在并入时刻 $k=1$ 的测量值之前的预测误差协方差。\n\n**步骤 2：更新（测量更新）**\n\n首先，我们计算新息协方差，记为 $S_1$：\n$$\nS_1 = C P_{1|0} C^T + R\n$$\n$$\nC P_{1|0} C^T = \\begin{bmatrix} 1 & 0 \\end{bmatrix} \\begin{bmatrix} 2.01 & 1 \\\\ 1 & 1.01 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 2.01 & 1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = [2.01]\n$$\n$$\nS_1 = [2.01] + [0.04] = [2.05]\n$$\n接着，我们计算卡尔曼增益 $K_1$：\n$$\nK_1 = P_{1|0} C^T S_1^{-1}\n$$\n$$\nP_{1|0} C^T = \\begin{bmatrix} 2.01 & 1 \\\\ 1 & 1.01 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 2.01 \\\\ 1 \\end{bmatrix}\n$$\n$$\nK_1 = \\begin{bmatrix} 2.01 \\\\ 1 \\end{bmatrix} [2.05]^{-1} = \\begin{bmatrix} \\frac{2.01}{2.05} \\\\ \\frac{1}{2.05} \\end{bmatrix}\n$$\n最后，我们计算后验误差协方差 $P_{1|1}$：\n$$\nP_{1|1} = (I - K_1 C) P_{1|0}\n$$\n让我们计算 $(I - K_1 C)$ 项：\n$$\nK_1 C = \\begin{bmatrix} \\frac{2.01}{2.05} \\\\ \\frac{1}{2.05} \\end{bmatrix} \\begin{bmatrix} 1 & 0 \\end{bmatrix} = \\begin{bmatrix} \\frac{2.01}{2.05} & 0 \\\\ \\frac{1}{2.05} & 0 \\end{bmatrix}\n$$\n$$\nI - K_1 C = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} - \\begin{bmatrix} \\frac{2.01}{2.05} & 0 \\\\ \\frac{1}{2.05} & 0 \\end{bmatrix} = \\begin{bmatrix} 1 - \\frac{2.01}{2.05} & 0 \\\\ -\\frac{1}{2.05} & 1 \\end{bmatrix} = \\begin{bmatrix} \\frac{0.04}{2.05} & 0 \\\\ -\\frac{1}{2.05} & 1 \\end{bmatrix}\n$$\n现在我们执行最后的矩阵乘法：\n$$\nP_{1|1} = \\begin{bmatrix} \\frac{0.04}{2.05} & 0 \\\\ -\\frac{1}{2.05} & 1 \\end{bmatrix} \\begin{bmatrix} 2.01 & 1 \\\\ 1 & 1.01 \\end{bmatrix}\n$$\n$$\nP_{1|1} = \\begin{bmatrix} (\\frac{0.04}{2.05})(2.01) + (0)(1) & (\\frac{0.04}{2.05})(1) + (0)(1.01) \\\\ (-\\frac{1}{2.05})(2.01) + (1)(1) & (-\\frac{1}{2.05})(1) + (1)(1.01) \\end{bmatrix}\n$$\n$$\nP_{1|1} = \\begin{bmatrix} \\frac{0.0804}{2.05} & \\frac{0.04}{2.05} \\\\ \\frac{-2.01 + 2.05}{2.05} & \\frac{-1 + 1.01 \\cdot 2.05}{2.05} \\end{bmatrix} = \\begin{bmatrix} \\frac{0.0804}{2.05} & \\frac{0.04}{2.05} \\\\ \\frac{0.04}{2.05} & \\frac{1.0705}{2.05} \\end{bmatrix}\n$$\n题目要求将矩阵元素四舍五入到 $4$ 位有效数字。\n$$\nP_{1|1}(1,1) = \\frac{0.0804}{2.05} \\approx 0.0392195... \\approx 0.03922\n$$\n$$\nP_{1|1}(1,2) = P_{1|1}(2,1) = \\frac{0.04}{2.05} \\approx 0.0195121... \\approx 0.01951\n$$\n$$\nP_{1|1}(2,2) = \\frac{1.0705}{2.05} \\approx 0.5221951... \\approx 0.5222\n$$\n因此，在 $k=1$ 时的后验误差协方差矩阵为：\n$$\nP_{1|1} \\approx \\begin{bmatrix} 0.03922 & 0.01951 \\\\ 0.01951 & 0.5222 \\end{bmatrix}\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.03922 & 0.01951 \\\\ 0.01951 & 0.5222 \\end{pmatrix}}\n$$", "id": "2888322"}, {"introduction": "在这最后一个练习中，理论将与实践相结合 [@problem_id:2888309]。您将通过编写一个仿真程序，来直观地观察不同观测器设计下估计误差的行为。这将为您提供具体的证据，证明一个稳定的观测器设计如何导致误差指数收敛，而一个不稳定的设计又如何导致发散，从而巩固您对设计选择重要性的理解。", "problem": "考虑一个连续时间线性时不变状态空间模型，其状态向量为 $x(t) \\in \\mathbb{R}^{2}$，输入为 $u(t) \\in \\mathbb{R}$，输出为 $y(t) \\in \\mathbb{R}$：\n$$\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t),$$\n其中\n$$A = \\begin{bmatrix} 0 & 1 \\\\ -1 & -1 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1 & 0 \\end{bmatrix}。$$\n假设输入为 $u(t) = \\sin(t)$，其中角度单位为弧度，时间单位为秒。考虑一个全阶确定性观测器，其估计状态为 $\\hat{x}(t) \\in \\mathbb{R}^{2}$，观测器增益为 $L \\in \\mathbb{R}^{2 \\times 1}$。初始估计误差为 $e(0) = x(0) - \\hat{x}(0) = \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix}$。\n\n您的任务是先从基本定义出发进行推导，然后实现一个模拟器来验证估计误差的指数收敛性。在本问题中，指数收敛定义如下：存在常数 $k \\ge 1$ 和 $\\alpha > 0$，使得对于所有 $t \\ge 0$，\n$$\\lVert e(t) \\rVert_{2} \\le k \\, e^{-\\alpha t} \\lVert e(0) \\rVert_{2}。$$\n\n要求：\n- 从状态空间系统、利用新息 $y(t) - C \\hat{x}(t)$ 的观测器以及估计误差的诱导动力学的基本定义出发。阐述估计误差自主演化的条件，以及保证上述指数衰减意义下的结构矩阵属性。\n- 实现一个程序，对于几种观测器设计，在一个均匀时间网格 $t_{i} = i h$（其中 $i = 0, 1, \\dots, N$ 且 $Nh = T$）上模拟估计误差 $e(t)$。模拟时使用一种针对线性时不变动力学的精确或数值稳定的方法。您可以选择下面每个测试案例规定的步长 $h$。所有角度必须以弧度为单位，时间必须以秒为单位。\n- 对每个测试案例，通过检查以下不等式进行指数边界的数值验证：\n$$\\max_{0 \\le i \\le N} \\frac{\\lVert e(t_{i}) \\rVert_{2}}{\\lVert e(0) \\rVert_{2} \\, e^{-\\alpha t_{i}}} \\le k。$$\n为每个案例返回一个布尔值：`true` 表示成立，`false` 表示不成立。不允许使用 $1$ 或 $0$；请使用布尔值。\n\n测试套件：\n- 案例 1（极点配置）：选择 $L$，使误差动力学矩阵的特征值位于 $\\{-2, -3\\}$。使用时域 $T = 6$，步长 $h = 0.01$，参数 $\\alpha = 1.0, k = 2.0$。\n- 案例 2（卡尔曼-布西增益）：通过估计器代数 Riccati 方程选择 $L$，其中过程噪声协方差 $Q = q I_{2}$ 且 $q = 0.01$，测量噪声协方差 $R = [1]$。使用时域 $T = 6$，步长 $h = 0.01$，参数 $\\alpha = 0.25, k = 5.0$。\n- 案例 3（开环模型注入）：使用 $L = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。使用时域 $T = 8$，步长 $h = 0.01$，参数 $\\alpha = 0.30, k = 5.0$。\n- 案例 4（用于对比的不稳定设计）：使用 $L = \\begin{bmatrix} -2 \\\\ -3 \\end{bmatrix}$。使用时域 $T = 1.2$，步长 $h = 0.01$，参数 $\\alpha = 0.10, k = 10.0$。\n\n实现说明：\n- 为确保观测器使用与被控对象相同的输入 $u(t)$，并专注于估计误差动力学，您可以直接在所选 $L$ 诱导的自主动力学下模拟估计误差。输入 $u(t)$ 是为了系统模型的完整性而提供的，并且正弦函数的参数以弧度表示。\n- 所有案例的初始误差均为 $e(0) = \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，`[result1,result2,result3,result4]`）。每个结果必须是字符串 \"True\" 或 \"False\"，对应于该测试案例的指数边界是否在网格上成立。", "solution": "该问题要求推导连续时间线性时不变（LTI）系统的估计误差动力学，并对几种观测器设计的指数收敛性进行数值验证。\n\n首先，我们建立基本方程。被控对象由以下公式描述：\n$$ \\dot{x}(t) = A x(t) + B u(t) $$\n$$ y(t) = C x(t) $$\n构建一个全阶 Luenberger 观测器来生成状态 $x(t)$ 的估计值 $\\hat{x}(t)$。观测器的动力学由下式给出：\n$$ \\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L(y(t) - \\hat{y}(t)) $$\n其中 $L$ 是观测器增益矩阵，$\\hat{y}(t) = C\\hat{x}(t)$ 是估计输出。$y(t) - \\hat{y}(t)$ 这一项是新息或输出误差，作为观测器的修正信号。\n\n状态估计误差定义为 $e(t) = x(t) - \\hat{x}(t)$。为了推导该误差的动力学，我们对 $e(t)$ 关于时间求导：\n$$ \\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t) $$\n代入状态和观测器的动力学表达式：\n$$ \\dot{e}(t) = (A x(t) + B u(t)) - (A \\hat{x}(t) + B u(t) + L(y(t) - C\\hat{x}(t))) $$\n将 $y(t) = C x(t)$ 代入方程：\n$$ \\dot{e}(t) = A x(t) + B u(t) - A \\hat{x}(t) - B u(t) - L(C x(t) - C\\hat{x}(t)) $$\n包含输入 $u(t)$ 的项相互抵消。然后我们可以将与 $x(t)$ 和 $\\hat{x}(t)$ 相关的项分组：\n$$ \\dot{e}(t) = A (x(t) - \\hat{x}(t)) - L C (x(t) - \\hat{x}(t)) $$\n根据误差 $e(t)$ 的定义，这可以简化为：\n$$ \\dot{e}(t) = (A - L C) e(t) $$\n这是估计误差动力学的基本方程。可以观察到，该动力学是自主的，意味着它独立于系统输入 $u(t)$ 和系统状态 $x(t)$。误差的行为仅取决于初始误差 $e(0)$ 和矩阵 $A_e = A - LC$ 的属性。\n\n要使估计误差收敛到零，原点必须是系统 $\\dot{e}(t) = A_e e(t)$ 的一个稳定平衡点。由 $\\lVert e(t) \\rVert_{2} \\le k \\, e^{-\\alpha t} \\lVert e(0) \\rVert_{2}$（对于某些常数 $k \\ge 1$ 和 $\\alpha > 0$）定义的指数收敛，其充要条件是矩阵 $A_e = A - LC$ 是 Hurwitz 矩阵。如果一个矩阵的所有特征值都具有严格为负的实部，则该矩阵是 Hurwitz 矩阵。如果 $A_e$ 的特征值为 $\\lambda_j$，则条件是对于所有 $j$，$\\text{Re}(\\lambda_j) < 0$。稳定裕度定义为 $\\sigma = \\min_j \\{-\\text{Re}(\\lambda_j)\\}$。对于任何满足 $0 < \\alpha < \\sigma$ 的 $\\alpha$，上述边界都可以成立。\n\n如果 $(A, C)$ 对是可观测的，那么通过选择 $L$ 来任意配置 $A_e$ 的特征值的能力就得到了保证。该系统的可观测性矩阵为：\n$$ \\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\end{bmatrix} $$\n对于给定的矩阵 $A = \\begin{bmatrix} 0 & 1 \\\\ -1 & -1 \\end{bmatrix}$ 和 $C = \\begin{bmatrix} 1 & 0 \\end{bmatrix}$，我们计算 $CA = \\begin{bmatrix} 1 & 0 \\end{bmatrix} \\begin{bmatrix} 0 & 1 \\\\ -1 & -1 \\end{bmatrix} = \\begin{bmatrix} 0 & 1 \\end{bmatrix}$。因此，可观测性矩阵是：\n$$ \\mathcal{O} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} $$\n由于 $\\det(\\mathcal{O}) = 1 \\ne 0$，系统是完全可观测的，因此极点配置是可能的。\n\n数值验证通过在时间网格 $t_i = i h$ 上模拟误差动力学来执行。误差动力学的精确解是 $e(t) = e^{A_e t} e(0)$。离散时间演化为 $e(t_{i+1}) = e^{A_e h} e(t_i)$。我们一次性计算出状态转移矩阵 $\\Phi_d = e^{A_e h}$，然后迭代 $e_{i+1} = \\Phi_d e_i$。在每一步，我们验证不等式 $\\lVert e(t_{i}) \\rVert_{2} \\le k \\, e^{-\\alpha t_{i}} \\lVert e(0) \\rVert_{2}$ 是否成立。\n\n我们现在分析每个测试案例：\n\n案例 1（极点配置）：我们必须选择 $L = \\begin{bmatrix} l_1 \\\\ l_2 \\end{bmatrix}$ 以将 $A_e = A - LC$ 的特征值配置在 $\\{-2, -3\\}$。\n$$ A_e = A - LC = \\begin{bmatrix} 0 & 1 \\\\ -1 & -1 \\end{bmatrix} - \\begin{bmatrix} l_1 \\\\ l_2 \\end{bmatrix} \\begin{bmatrix} 1 & 0 \\end{bmatrix} = \\begin{bmatrix} -l_1 & 1 \\\\ -1-l_2 & -1 \\end{bmatrix} $$\n特征多项式为 $\\det(\\lambda I - A_e) = \\lambda^2 + (l_1+1)\\lambda + (l_1+1+l_2)$。期望的多项式是 $(\\lambda+2)(\\lambda+3) = \\lambda^2+5\\lambda+6$。通过系数匹配可得 $l_1+1=5 \\implies l_1=4$ 和 $l_1+1+l_2=6 \\implies 5+l_2=6 \\implies l_2=1$。所以 $L = \\begin{bmatrix} 4 \\\\ 1 \\end{bmatrix}$。稳定裕度为 $\\sigma=2$。使用 $\\alpha=1.0 < 2$ 进行检查是合适的。\n\n案例 2（卡尔曼-布西增益）：增益为 $L = PC^T R^{-1}$，其中 $P$ 是估计器代数 Riccati 方程（ARE）$AP + PA^T - PC^T R^{-1} C P + Q = 0$ 的对称半正定解。给定 $Q = 0.01 I_2$ 和 $R = [1]$，该方程可以数值求解。由于系统是可观测的，所得滤波器保证是稳定的。\n\n案例 3（开环模型注入）：这里，$L = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。误差动力学矩阵为 $A_e = A$。$A$ 的特征值是 $\\lambda^2+\\lambda+1=0$ 的根，即 $\\lambda = -0.5 \\pm i \\frac{\\sqrt{3}}{2}$。实部为 $-0.5$，所以开环误差动力学是稳定的。稳定裕度为 $\\sigma=0.5$。使用 $\\alpha=0.3 < 0.5$ 进行检查是合理的。\n\n案例 4（用于对比的不稳定设计）：这里，$L = \\begin{bmatrix} -2 \\\\ -3 \\end{bmatrix}$。误差动力学矩阵是：\n$$ A_e = \\begin{bmatrix} -(-2) & 1 \\\\ -1-(-3) & -1 \\end{bmatrix} = \\begin{bmatrix} 2 & 1 \\\\ 2 & -1 \\end{bmatrix} $$\n特征多项式为 $\\det(\\lambda I - A_e) = (\\lambda-2)(\\lambda+1)-2 = \\lambda^2-\\lambda-4=0$。特征值为 $\\lambda = \\frac{1 \\pm \\sqrt{17}}{2}$。其中一个特征值 $\\frac{1+\\sqrt{17}}{2} \\approx 2.56$ 是正数。误差动力学是不稳定的，因此误差范数 $\\lVert e(t) \\rVert_2$ 将指数增长。指数衰减的不等式对于所有 $t > 0$ 都不可能成立。", "answer": "[True,True,True,False]", "id": "2888309"}]}