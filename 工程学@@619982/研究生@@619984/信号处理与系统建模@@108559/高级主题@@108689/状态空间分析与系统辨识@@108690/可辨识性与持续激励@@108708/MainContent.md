## 引言
在科学与工程领域，我们经常面对一个核心任务：通过外部观测来理解一个未知系统的内部运作机制。我们将这种系统比作一个“黑箱”，通过施加输入并测量其输出来推断其数学模型，这一过程便是系统辨识。然而，并非任何实验都能揭示黑箱的秘密。如果我们提出的“问题”（输入信号）不当，或者系统本身的结构存在模糊性，我们可能会得到误导性的、甚至无穷多个看似合理的答案。这便引出了系统辨识中的两个基本前提，也是本文将要深入探讨的核心：可辨识性（Identifiability）与[激励的持续性](@article_id:368131)（Persistency of Excitation）。本文将系统地阐述这两个概念。首先，我们将探讨什么是“可辨识性”，即一个模型在理论上是否允许我们唯一地确定其参数。接着，我们将揭示“[激励的持续性](@article_id:368131)”的含义，即什么样的输入信号才算足够“丰富”，能够充分激发系统的动态，从而让所有参数都暴露无遗。最后，我们将跨出理论范畴，探讨这些原理在自适应控制、[最优实验设计](@article_id:344685)乃至生物医学等前沿领域的实际应用与挑战。这趟旅程不仅关乎数学和工程，更关乎我们如何提出正确的问题，以及如何解读大自然给予我们的答案。

## 原理与机制

在上一章中，我们开启了探索未知系统内部奥秘的旅程。我们把系统比作一个神秘的黑箱，通过施加“输入”并观察其“输出”来推断其内部的运作法则，也就是“模型”。现在，让我们更深入一步，像物理学家一样，去探寻这个推断过程背后最核心、最普适的原理。这趟旅程不仅关乎数学和工程，更关乎我们如何提出正确的问题，以及如何解读大自然给予我们的答案。

### “它是什么？”游戏：可辨识性的本质

想象一下，你正在玩一个猜谜游戏。我心里想好了一个数学函数——这就是我们的“系统模型”。你可以给我任何数字（输入 $u$），我会告诉你这个函数作用于该数字后的结果（输出 $y$）。你的任务是猜出我心中的函数。

假设我心中的函数是 $y = 2u$。你给我 $u=1$，我告诉你 $y=2$。你再给 $u=3$，我告诉你 $y=6$。很快，你就能充满信心地猜出：“函数是 $y=2u$！” 你成功地“辨识”了我的系统。

现在，我们把游戏稍微变复杂一点。假设我心中的函数形式是 $y = \theta_1^2 u + \theta_2 u^2$，其中 $\theta_1$ 和 $\theta_2$ 是我私下设置的两个参数。你的任务是找出这对参数。[@problem_id:2876781]

你开始进行实验。你输入 $u=1$，我计算后告诉你 $y=13$。你输入 $u=2$，我告诉你 $y=52$。经过一番聪明的计算，你得出结论：$\theta_1^2 = 9$ 且 $\theta_2=4$。但问题来了，$\theta_1$ 究竟是 $3$ 还是 $-3$ 呢？你无法确定。无论 $\theta_1$ 是 $3$ 还是 $-3$，对于你给出的任何输入 $u$，$\theta_1^2 u + 4u^2$ 的结果都是完全一样的！

这就引出了我们遇到的第一个核心概念：**可辨识性（Identifiability）**。一个模型是**全局可辨识**的，当且仅当不同的模型参数必定会导致在“至少一个”可能的输入下产生不同的输出。如果存在两组或更多组不同的参数，它们在“所有”可能的输入下都产生完全相同的输出，那么这个模型就不是全局可辨识的。这些无法区分的参数集就像彼此的“化名”或“别名”，我们永远无法通过输入-输出实验来区分它们。[@problem_id:2876715]

在 $y = \theta_1^2 u + \theta_2 u^2$ 这个例子中，由于平方项的存在，我们丢失了 $\theta_1$ 的符号信息。这个模型就不是全局可辨识的。但是，如果我们有额外的信息，比如我们事先知道 $\theta_1$ 必须是正数，那么在这个约束下，$\theta_1=3$ 就是唯一解。这种情况被称为**局部可辨识**——也就是说，在一个参数所在的足够小的“邻域”内，它是唯一的。

这个简单的游戏揭示了一个深刻的道理：在我们开始收集数据之前，首先要审视模型结构本身。有些秘密，由于其内在的对称性或结构性缺陷，是“天生”就无法被揭示的。

### 提问的艺术：[激励的持续性](@article_id:368131)

回到我们的黑箱实验。仅仅因为一个模型在理论上是可辨识的，并不意味着“任何”实验都能成功揭示其秘密。提问的方式，即我们选择的输入信号，至关重要。

让我们看一个更动态的例子。假设一个简单的系统，其输出由前两个时刻的输入决定：
$y(k) = \theta_1 u(k-1) + \theta_2 u(k-2)$
我们的目标是找出 $\theta_1$ 和 $\theta_2$。[@problem_id:2876760]

假设我们选择了一个非常“单调”的输入信号，比如一个指数衰减信号 $u(k) = (1/2)^k$。在任何时刻 $k$，我们的系统看到的两个历史输入 $u(k-1)$ 和 $u(k-2)$ 之间有什么关系呢？
$u(k-1) = (1/2)^{k-1}$
$u(k-2) = (1/2)^{k-2}$
你会发现，$u(k-1) / u(k-2)$ 永远等于 $1/2$。这意味着，这两个输入信号并非独立的；一个永远是另一个的一半。它们在数据空间中是“共线”的。

那么，当系统输出一个值 $y(k)$ 时，我们试图求解方程 $\theta_1 u(k-1) + \theta_2 u(k-2) = y(k)$。这实际上变成了 $\theta_1 (0.5 u(k-2)) + \theta_2 u(k-2) = y(k)$，也就是 $(0.5\theta_1 + \theta_2)u(k-2) = y(k)$。我们能够确定的仅仅是 $(0.5\theta_1 + \theta_2)$ 这个组合的值，而无法独立地分辨出 $\theta_1$ 和 $\theta_2$。比如，$(\theta_1, \theta_2) = (2, 4)$ 和 $(\theta_1, \theta_2) = (4, 3)$ 可能会给出完全相同的输出序列！

这个失败的实验引出了我们第二个核心概念：**[激励的持续性](@article_id:368131)（Persistency of Excitation, PE）**。一个输入信号被称为是“[持续激励](@article_id:327541)”的，意味着它足够“丰富”和“多变”，能够让系统中所有依赖于它的部分都充分地“动起来”，从而揭示出它们各自的特性。

从数学上看，如果一个模型有 $n$ 个未知参数，那么为了唯一地确定它们，我们需要输入信号能够生成至少 $n$ 个线性独立的“特征”或“回归量”（regressors）。在上面的例子中，回归量是 $[u(k-1), u(k-2)]$。由于我们选择的输入使得这两个回归量线性相关（共线），我们事实上只提出了一个问题，却妄图解出两个未知数，这自然是不可能的。因此，我们需要一个“[持续激励](@article_id:327541)的二阶”输入，来辨识这个[二阶系统](@article_id:340246)。[@problem_id:2876713] [@problem_id:2876752]

### 多少激励才算够？量化PE

“足够丰富”是一个很好的直觉，但作为科学家，我们追求精确。到底要多丰富的输入才算达标？

这个问题有一个异常优美的答案。假设我们正在研究一个更复杂的系统（一个[ARX模型](@article_id:333230)），它有 $n_a$ 个与历史输出相关的参数和 $n_b$ 个与历史输入相关的参数，总共有 $n_a+n_b$ 个未知数。我们应该用什么样的输入信号去“盘问”这个系统呢？[@problem_id:2876753]

一个经典的工程方法是使用由不同频率的[正弦波](@article_id:338691)叠加而成的信号。一个[正弦波](@article_id:338691)就像一个特定频率的“探针”。那么，我们需要多少种不同频率的探针呢？直觉可能会告诉你，需要 $n_a+n_b$ 个。但答案比这更精妙。

经过严谨的推导，我们发现，确保系统可辨识所需的最小[正弦波](@article_id:338691)频率数目 $L$ 是：
$$
L_{\min} = \left\lceil \frac{n_a + n_b}{2} \right\rceil
$$
这里的 $\lceil \cdot \rceil$ 是向[上取整函数](@article_id:326168)。为什么是除以2？这个“2”从何而来？答案藏在伟大的欧拉公式 $e^{i\omega k} = \cos(\omega k) + i\sin(\omega k)$ 之中。一个频率为 $\omega$ 的实数[正弦波](@article_id:338691)，在复数的世界里，实际上是由一对[共轭](@article_id:312168)的频率 $(\omega, -\omega)$ 构成的。每一个[正弦波](@article_id:338691)探针，实际上为我们提供了两个独立的“视角”来审视系统。因此，要揭示 $n_a+n_b$ 个秘密，我们大致只需要一半数量的[正弦波](@article_id:338691)。物理定律的内在和谐与数学的简洁之美在此刻交相辉映。

### 机器中的幽灵：现实世界的复杂性

至此，我们的蓝图似乎已经很清晰了：选择一个理论上可辨识的模型，然后用一个经过精心设计的、足够丰富的输入信号去激励它。然而，现实世界总会给我们带来一些“惊喜”，一些如同“机器中的幽灵”般的微妙问题。

#### 1. 几乎看不见的差异：实践可辨识性

理论上可辨识就等于实践中一定能成功吗？让我们来看一个例子。假设一个物体的衰变过程由两个不同的指数项叠加而成：
$$
y(t) = \theta_1 e^{-t} + \theta_2 e^{-(1+\varepsilon)t}
$$
其中，$\varepsilon$ 是一个很小的正数。理论上，只要 $\varepsilon \neq 0$，这两个[指数函数](@article_id:321821) $e^{-t}$ 和 $e^{-(1+\varepsilon)t}$ 就是线性独立的，因此参数 $\theta_1$ 和 $\theta_2$ 是可辨识的。[@problem_id:2876778]

但如果 $\varepsilon$ 非常非常小，比如 $10^{-6}$，情况会怎样？函数 $e^{-t}$ 和 $e^{-1.000001t}$ 的曲线几乎完全重合。在任何测量都不可避免地带有噪声的现实世界里，想从一个被[噪声污染](@article_id:367913)的叠加信号中精确地分离出这两个几乎一模一样的成分，就像试图通过称量一整桶沙子的重量，来分辨出其中两粒几乎一样重的沙子的各自重量。

这个问题被称为**病态条件（ill-conditioning）**。虽然理论上解是唯一的，但它对测量噪声极其敏感。微小的噪声都可能导致计算出的参数值发生巨大的偏差。因此，除了理论上的**[结构可辨识性](@article_id:362228)**，我们更关心**实践可辨识性**——即在有噪声的情况下，我们能否稳健、可靠地估计出参数。这提醒我们，模型中过于相似的部分会相互“伪装”，使得辨识工作在实践中举步维艰。

#### 2. 当观察者影响被观察者：[闭环辨识](@article_id:324138)

在许多真实的工程系统中——比如家中的空调、飞机的[自动驾驶](@article_id:334498)仪——系统并不是被动地接受我们预设的输入。相反，输入（如空调的制冷功率）是由一个“控制器”根据当前的输出（房间温度）来决定的。这就形成了一个“闭环”系统。

这种反馈机制会引入一个微妙的问题：输入信号不再独立，它现在与系统的输出，包括输出中的随机噪声，产生了关联。[@problem_id:2876710] 控制器会观察到包含噪声的温度，并据此调整[制冷](@article_id:305433)功率，这意味着输入信号在某种程度上开始“追逐”噪声。

这种输入与噪声的“共谋”关系，破坏了我们之前简单辨识方法的基础。我们之前使用的公式，无论是时域的最小二乘法还是[频域](@article_id:320474)的方法，都隐含了一个前提：输入和噪声是“陌生人”，它们互不相关。现在，它们成了“同伙”，我们无法再轻易地将系统的真实响应从噪声的影响中分离开来。单纯分析输入和输出数据，我们可能会把控制器对噪声的反应误判为系统本身的特性，甚至最终辨识出的不是系统模型，反而是控制器模型！

如何打破这个僵局？我们需要一个“局外人”的帮助。我们必须在闭环系统中引入一个额外的、独立于内部噪声的外部激励信号 $r(t)$。这个信号，可以是一个预设的指令（比如我们设定一个新的目标温度），或是一个专门设计的微小扰动信号。因为它与系统内部的噪声没有关系，所以它就像一个“干净”的探针，它的影响可以被清晰地追踪。通过分析系统对这个外部信号的响应，我们才能最终拨开迷雾，准确地辨识出[反馈环](@article_id:337231)路内部的那个神秘黑箱 $G$ 的真实面目。

总而言之，我们发现，辨识一个未知的系统，就像是与它进行一场严谨而智慧的对话。“可辨识性”确保了这场对话有意义，即系统不会用模棱两可的方式回答。“[激励的持续性](@article_id:368131)”则要求我们提出足够丰富、不重复的问题，以全面地了解对方。而从理论上的可能性到实践中的挑战——如病态条件和闭环反馈——则展示了这场对话的深度与复杂性。这不仅仅是一系列数学公式的应用，更是一门揭示事物内在规律的艺术，充满了发现的乐趣与挑战。