{"hands_on_practices": [{"introduction": "能控性秩判据，即能控性矩阵 $\\mathcal{C}$ 的秩等于系统阶数 $n$，是判断系统是否能控的直接方法，但它更像一个“黑箱”测试，只给出“是”或“否”的答案。本实践旨在揭示系统能控性的深层结构。通过分析一个状态矩阵为约旦标准型的系统，我们可以直观地看到输入信号是如何（或无法）影响状态空间中的特定“链条”，从而将抽象的秩亏损概念与具体的物理状态联系起来，加深对能控性本质的理解。[@problem_id:2861179]", "problem": "考虑一个由 $x_{k+1} = A x_{k} + B u_{k}$ 定义的离散时间线性时不变 (LTI) 系统，其状态 $x_{k} \\in \\mathbb{R}^{5}$，输入 $u_{k} \\in \\mathbb{R}^{2}$。状态转移矩阵 $A$ 是具有两个块的若尔当标准型，\n$$\nA \\;=\\; \\begin{pmatrix}\n2 & 1 & 0 & 0 & 0 \\\\\n0 & 2 & 1 & 0 & 0 \\\\\n0 & 0 & 2 & 0 & 0 \\\\\n0 & 0 & 0 & \\tfrac{1}{3} & 1 \\\\\n0 & 0 & 0 & 0 & \\tfrac{1}{3}\n\\end{pmatrix}\n\\;=\\; \\operatorname{diag}\\!\\Big(J_{3}(2),\\, J_{2}\\!\\big(\\tfrac{1}{3}\\big)\\Big),\n$$\n输入矩阵 $B \\in \\mathbb{R}^{5 \\times 2}$ 被选择来驱动大小为 3 的若尔当链中的一个非起始状态和大小为 2 的若尔当链中的起始状态，\n$$\nB \\;=\\; \\begin{pmatrix}\n0 & 0 \\\\\n1 & 0 \\\\\n0 & 0 \\\\\n0 & 1 \\\\\n0 & 0\n\\end{pmatrix}.\n$$\n仅使用离散时间系统的能达性和能控性的基本定义，分析 $B$ 中非零元素相对于 $A$ 的若尔当链的位置如何决定哪些广义特征向量链是能控的或不能控的。然后，根据基本原理，计算能控性矩阵的秩\n$$\n\\mathcal{C}(A,B) \\;=\\; \\big[\\, B \\;\\; A B \\;\\; A^{2} B \\;\\; A^{3} B \\;\\; A^{4} B \\,\\big].\n$$\n将最终答案以单个整数形式给出。无需四舍五入，不涉及单位。", "solution": "对问题陈述进行验证。\n\n第一步：提取已知条件\n- 系统方程：$x_{k+1} = A x_{k} + B u_{k}$\n- 状态向量：$x_{k} \\in \\mathbb{R}^{5}$\n- 输入向量：$u_{k} \\in \\mathbb{R}^{2}$\n- 状态转移矩阵：\n$$\nA \\;=\\; \\begin{pmatrix}\n2 & 1 & 0 & 0 & 0 \\\\\n0 & 2 & 1 & 0 & 0 \\\\\n0 & 0 & 2 & 0 & 0 \\\\\n0 & 0 & 0 & \\tfrac{1}{3} & 1 \\\\\n0 & 0 & 0 & 0 & \\tfrac{1}{3}\n\\end{pmatrix}\n\\;=\\; \\operatorname{diag}\\!\\Big(J_{3}(2),\\, J_{2}\\!\\big(\\tfrac{1}{3}\\big)\\Big)\n$$\n- 输入矩阵：\n$$\nB \\;=\\; \\begin{pmatrix}\n0 & 0 \\\\\n1 & 0 \\\\\n0 & 0 \\\\\n0 & 1 \\\\\n0 & 0\n\\end{pmatrix}\n$$\n- 任务：基于 $A$ 和 $B$ 的结构分析能控性，并计算能控性矩阵 $\\mathcal{C}(A,B) \\;=\\; \\big[\\, B \\;\\; A B \\;\\; A^{2} B \\;\\; A^{3} B \\;\\; A^{4} B \\,\\big]$ 的秩。\n\n第二步：使用提取的已知条件进行验证\n该问题具有科学依据、提法明确且客观。它提出了一个线性系统理论中关于离散时间系统能控性的标准问题。所有矩阵和维度都有明确定义，且系统参数是一致的。该问题是自洽的，没有违反任何数学或科学原理。未发现任何缺陷。\n\n第三步：结论与行动\n问题有效。将提供解答。\n\n状态空间 $\\mathbb{R}^{5}$ 可以分解为两个在 $A$ 作用下不变的子空间 $V_1 = \\operatorname{span}\\{e_1, e_2, e_3\\}$ 和 $V_2 = \\operatorname{span}\\{e_4, e_5\\}$ 的直和。其中，$e_i$ 是第 $i$ 个标准基向量。整个系统 $(A, B)$ 的能控性可以通过考察与每个若尔当块相关联的子系统的能控性来分析。\n\n设状态向量为 $x_k = [x_{1k}, x_{2k}, x_{3k}, x_{4k}, x_{5k}]^T$，输入向量为 $u_k = [u_{1k}, u_{2k}]^T$。系统动态可以写成一组标量差分方程。\n\n对第一个若尔当块 ($J_3(2)$) 的分析：\n对应子空间 $V_1$ 的前三个状态分量的动态方程为：\n$x_{1,k+1} = 2x_{1k} + x_{2k}$\n$x_{2,k+1} = 2x_{2k} + x_{3k} + u_{1k}$\n$x_{3,k+1} = 2x_{3k}$\n\n第三个方程 $x_{3,k+1} = 2x_{3k}$ 表明，状态分量 $x_3$ 仅由其自身的值驱动，完全不受输入 $u_{1k}$ (或 $u_{2k}$) 的影响。该方程的解为 $x_{3,k} = 2^k x_{3,0}$。如果初始状态 $x_{3,0} \\neq 0$，则无法使用任何控制输入序列将 $x_3$ 驱动到 0。这意味着该系统是不能控的。反之，如果从 $x_0=0$ 开始，任何具有非零 $x_3$ 分量的状态都是不可达的。状态向量 $e_3$ 代表一个不能控模态。\n输入 $u_{1k}$ 直接驱动 $x_2$。通过 $x_{1,k+1}$ 方程中的耦合项 $x_{2k}$，状态 $x_1$ 被间接控制。因此，由 $\\{e_1, e_2\\}$ 张成的子空间是能控的。与此若尔当块相关的能控子空间的维数是 $2$。\n这个结果是输入矩阵 $B$ 结构的直接后果。对于一个若尔当链，能控性当且仅当输入作用在链的末端（即最高阶的广义特征向量）时才能实现。在这里，与 $\\lambda=2$ 关联的链是 $e_1 \\leftarrow e_2 \\leftarrow e_3$，其中 $e_1$ 是特征向量。输入作用在 $e_2$ 上，而不是 $e_3$ 上，这使得该链是不能控的。\n\n对第二个若尔当块 ($J_2(1/3)$) 的分析：\n对应子空间 $V_2$ 的最后两个状态分量的动态方程为：\n$x_{4,k+1} = \\frac{1}{3}x_{4k} + x_{5k} + u_{2k}$\n$x_{5,k+1} = \\frac{1}{3}x_{5k}$\n\n类似地，方程 $x_{5,k+1} = \\frac{1}{3}x_{5k}$ 表明状态分量 $x_5$ 独立于任何控制输入。其解为 $x_{5,k} = (\\frac{1}{3})^k x_{5,0}$。这个模态是不能控的。输入 $u_{2k}$ 驱动 $x_4$。由 $\\{e_4\\}$ 张成的子空间是能控的。与此块相关的能控子空间的维数是 $1$。\n$\\lambda=1/3$ 的若尔当链是 $e_4 \\leftarrow e_5$，其中 $e_4$ 是特征向量。输入作用在特征向量 $e_4$ 上，而不是链的末端 $e_5$ 上，导致 $e_5$ 模态不能控。\n\n总能控子空间是每个块的能控子空间的直和，即 $\\operatorname{span}\\{e_1, e_2, e_4\\}$。该子空间的维数是 $2 + 1 = 3$。能控性矩阵 $\\mathcal{C}(A,B)$ 的秩等于能控子空间的维数。因此，秩必为 $3$。\n\n我们现在通过直接计算能控性矩阵 $\\mathcal{C} = [B \\ AB \\ A^2B \\ A^3B \\ A^4B]$ 的秩来验证这一结论。状态维数为 $n=5$。设 $B$ 的两列分别为 $b_1 = e_2$ 和 $b_2 = e_4$。\n\n首先，我们计算 $k=0, \\dots, 4$ 时的矩阵 $A^k B$。\n$B = \\begin{pmatrix} 0 & 0 \\\\ 1 & 0 \\\\ 0 & 0 \\\\ 0 & 1 \\\\ 0 & 0 \\end{pmatrix}$\n\n$AB = A[b_1 \\ b_2] = [Ae_2 \\ Ae_4]$。根据 $A$ 的定义：\n$Ae_2 = 2e_2 + e_1$\n$Ae_4 = \\frac{1}{3}e_4$\n所以，$AB = \\begin{pmatrix} 1 & 0 \\\\ 2 & 0 \\\\ 0 & 0 \\\\ 0 & 1/3 \\\\ 0 & 0 \\end{pmatrix}$。\n\n$A^2B = A(AB) = [A(e_1+2e_2) \\ A(\\frac{1}{3}e_4)]$。\n$A(e_1+2e_2) = Ae_1 + 2Ae_2 = (2e_1) + 2(e_1+2e_2) = 4e_1+4e_2$。\n$A(\\frac{1}{3}e_4) = \\frac{1}{3}Ae_4 = \\frac{1}{3}(\\frac{1}{3}e_4) = \\frac{1}{9}e_4$。\n所以，$A^2B = \\begin{pmatrix} 4 & 0 \\\\ 4 & 0 \\\\ 0 & 0 \\\\ 0 & 1/9 \\\\ 0 & 0 \\end{pmatrix}$。\n\n$A^3B = A(A^2B) = [A(4e_1+4e_2) \\ A(\\frac{1}{9}e_4)]$。\n$A(4e_1+4e_2) = 4Ae_1+4Ae_2 = 4(2e_1)+4(e_1+2e_2) = 12e_1+8e_2$。\n$A(\\frac{1}{9}e_4) = \\frac{1}{9}Ae_4 = \\frac{1}{27}e_4$。\n所以，$A^3B = \\begin{pmatrix} 12 & 0 \\\\ 8 & 0 \\\\ 0 & 0 \\\\ 0 & 1/27 \\\\ 0 & 0 \\end{pmatrix}$。\n\n$A^4B = A(A^3B) = [A(12e_1+8e_2) \\ A(\\frac{1}{27}e_4)]$。\n$A(12e_1+8e_2) = 12Ae_1+8Ae_2 = 12(2e_1)+8(e_1+2e_2) = 32e_1+16e_2$。\n$A(\\frac{1}{27}e_4) = \\frac{1}{27}Ae_4 = \\frac{1}{81}e_4$。\n所以，$A^4B = \\begin{pmatrix} 32 & 0 \\\\ 16 & 0 \\\\ 0 & 0 \\\\ 0 & 1/81 \\\\ 0 & 0 \\end{pmatrix}$。\n\n能控性矩阵 $\\mathcal{C}$ 是一个 $5 \\times 10$ 的矩阵：\n$$\n\\mathcal{C} = \\left[ \\begin{array}{cc|cc|cc|cc|cc}\n0 & 0 & 1 & 0 & 4 & 0 & 12 & 0 & 32 & 0 \\\\\n1 & 0 & 2 & 0 & 4 & 0 & 8 & 0 & 16 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & \\frac{1}{3} & 0 & \\frac{1}{9} & 0 & \\frac{1}{27} & 0 & \\frac{1}{81} \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\n\\end{array} \\right]\n$$\n为了求 $\\mathcal{C}$ 的秩，我们检查它的行。第三行和第五行完全由零组成。这立即将秩限制在最多 $5-2=3$。我们来检查第一、第二和第四行的线性无关性。\n设非零行向量为 $r_1$、$r_2$ 和 $r_4$。\n$r_1 = [0, 0, 1, 0, 4, 0, 12, 0, 32, 0]$\n$r_2 = [1, 0, 2, 0, 4, 0, 8, 0, 16, 0]$\n$r_4 = [0, 1, 0, \\frac{1}{3}, 0, \\frac{1}{9}, 0, \\frac{1}{27}, 0, \\frac{1}{81}]$\n\n考虑一个线性组合 $c_1 r_1 + c_2 r_2 + c_4 r_4 = 0$。\n$r_1$ 和 $r_2$ 的非零项在奇数号列，而 $r_4$ 的非零项在偶数号列。\n观察线性组合的偶数号列，我们得到 $c_4$ 乘以 $r_4$ 的各项。因为 $r_4$ 不是零向量，这意味着 $c_4 = 0$。\n方程化简为 $c_1 r_1 + c_2 r_2 = 0$。\n观察第一列，得到 $c_2 \\cdot 1 = 0$，所以 $c_2 = 0$。\n方程变为 $c_1 r_1 = 0$。因为 $r_1$ 不是零向量，这意味着 $c_1 = 0$。\n唯一的解是 $c_1=c_2=c_4=0$，这证明了三个非零行是线性无关的。\n因此，矩阵 $\\mathcal{C}$ 的秩为 3。这证实了我们基于系统结构的初步分析结果。", "answer": "$$\\boxed{3}$$", "id": "2861179"}, {"introduction": "理解了能控性的结构性含义后，我们自然会问：为什么能控性如此重要？完全能控性是实现强大控制设计的“钥匙”，它允许我们任意配置闭环系统的动态特性。本实践将引导您从第一性原理出发，推导并应用著名的阿克曼公式（Ackermann's formula），这是一种用于状态反馈极点配置的强大工具。通过这个过程，您将牢固地建立起能控性的数学条件与在实践中任意指定系统响应能力之间的桥梁。[@problem_id:2861105]", "problem": "考虑一个单输入单输出 (SISO) 离散时间线性时不变状态空间系统\n$$\nx_{k+1} = A x_k + B u_k, \\quad x_k \\in \\mathbb{R}^n, \\; u_k \\in \\mathbb{R},\n$$\n其状态反馈形式为\n$$\nu_k = -K x_k, \\quad K \\in \\mathbb{R}^{1 \\times n}.\n$$\n请您构建一个状态反馈增益的闭式表达式，该表达式将一个指定的首一特征多项式赋予闭环转移矩阵。请从第一性原理出发，仅从以下基础要素开始：\n- 能达性/能控性的定义以及能控性矩阵\n$$\n\\mathcal{C} \\triangleq \\big[\\, B \\; A B \\; \\cdots \\; A^{n-1} B \\,\\big] \\in \\mathbb{R}^{n \\times n}.\n$$\n- Cayley–Hamilton 定理以及矩阵的标量多项式求值。\n- 对于能控的 SISO 对，在相似变换下存在能控规范（伴随）型。\n\n您的任务是：\n1) 在不引用任何现成的极点配置公式的情况下，从上述基础出发，推导出一个状态反馈行向量 $K$ 的通用闭式表达式，以确保闭环矩阵 $A - B K$ 的特征多项式等于一个指定的首一多项式\n$$\n\\rho_d(z) = z^n + \\alpha_{n-1} z^{n-1} + \\cdots + \\alpha_1 z + \\alpha_0,\n$$\n其中系数 $\\alpha_i$ 为实数。请清晰地列举并论证您最终表达式有效所需的所有假设，并讨论对 $(A,B)$ 的任何最小性或结构要求，包括单输入单输出 (SISO) 和能达性假设是如何以及为何引入的。\n\n2) 将您推导的表达式应用于具体数据\n$$\nA=\\begin{bmatrix}\n1 & 2 & 0\\\\\n0 & 1 & 1\\\\\n0 & 0 & 1\n\\end{bmatrix}, \n\\quad\nB=\\begin{bmatrix}\n0\\\\\n0\\\\\n1\n\\end{bmatrix},\n$$\n以及由实数零点指定的期望闭环多项式\n$$\n\\lambda_1=\\tfrac{1}{5},\\quad \\lambda_2=\\tfrac{2}{5},\\quad \\lambda_3=\\tfrac{4}{5},\n$$\n使得\n$$\n\\rho_d(z)=(z-\\tfrac{1}{5})(z-\\tfrac{2}{5})(z-\\tfrac{4}{5}).\n$$\n计算精确的反馈增益 $K$，以有理数表示。不要四舍五入；将 $K$ 以 $1 \\times 3$ 行向量的最简分数形式报告。无需单位。", "solution": "问题陈述经验证是完整、一致且科学合理的。它构成了线性系统状态空间控制理论中的一个标准问题。我们按照要求从第一性原理开始推导。\n\n问题要求推导一个单输入单输出 (SISO) 离散时间系统\n$$x_{k+1} = A x_k + B u_k$$\n在控制律 $u_k = -K x_k$ 下，状态反馈增益向量 $K \\in \\mathbb{R}^{1 \\times n}$ 的闭式表达式。该增益 $K$ 必须使闭环矩阵 $A_{cl} = A - B K$ 具有一个指定的特征多项式 $\\rho_d(z) = z^n + \\sum_{i=0}^{n-1} \\alpha_i z^i$。\n\n**第 1 部分：通用推导**\n\n推导的关键在于能控性的概念以及在相似变换下存在规范型。\n\n**假设：** 矩阵对 $(A, B)$ 是能控的。对于离散时间系统，这意味着系统是能达的，这等价于能控性矩阵 $\\mathcal{C} = \\begin{bmatrix} B & AB & \\cdots & A^{n-1}B \\end{bmatrix}$ 具有满秩，即 $\\det(\\mathcal{C}) \\neq 0$，因为对于维度为 $n$ 的 SISO 系统，$\\mathcal{C}$ 是一个方阵。这个假设是根本性的；没有它，任意极点配置是不可能的。\n\n**步骤 1：能控规范型 (CCF)**\n若 $(A, B)$ 是能控的，则存在一个可逆的相似变换矩阵 $T$，使得通过 $x = T \\bar{x}$ 变换，系统可以转化为能控规范型 $(\\bar{A}, \\bar{B})$，其中：\n$$ \\bar{A} = T^{-1}AT = \\begin{pmatrix} 0 & 1 & 0 & \\cdots & 0 \\\\ 0 & 0 & 1 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & 0 & 0 & \\cdots & 1 \\\\ -a_0 & -a_1 & -a_2 & \\cdots & -a_{n-1} \\end{pmatrix}, \\quad \\bar{B} = T^{-1}B = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ 1 \\end{pmatrix} $$\n$\\bar{A}$ 中的系数 $a_i$ 是 $A$ 的特征多项式 $\\rho_A(z) = \\det(zI-A) = z^n + \\sum_{i=0}^{n-1} a_i z^i$ 的系数，该多项式在相似变换下是不变的。\n\n**步骤 2：在 CCF 中的状态反馈**\n新坐标系下的状态反馈律变为 $u_k = -Kx_k = -K(T\\bar{x}_k) = -(KT)\\bar{x}_k = -\\bar{K}\\bar{x}_k$，其中 $\\bar{K} = KT = \\begin{bmatrix} \\bar{k}_0 & \\bar{k}_1 & \\cdots & \\bar{k}_{n-1} \\end{bmatrix}$。变换后坐标系中的闭环状态矩阵为 $\\bar{A}_{cl} = \\bar{A} - \\bar{B}\\bar{K}$。\n$$ \\bar{B}\\bar{K} = \\begin{pmatrix} 0 \\\\ \\vdots \\\\ 0 \\\\ 1 \\end{pmatrix} \\begin{bmatrix} \\bar{k}_0 & \\cdots & \\bar{k}_{n-1} \\end{bmatrix} = \\begin{pmatrix} 0 & 0 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & 0 & \\cdots & 0 \\\\ \\bar{k}_0 & \\bar{k}_1 & \\cdots & \\bar{k}_{n-1} \\end{pmatrix} $$\n$$ \\bar{A}_{cl} = \\bar{A} - \\bar{B}\\bar{K} = \\begin{pmatrix} 0 & 1 & 0 & \\cdots & 0 \\\\ 0 & 0 & 1 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & 0 & 0 & \\cdots & 1 \\\\ -a_0-\\bar{k}_0 & -a_1-\\bar{k}_1 & \\cdots & \\cdots & -a_{n-1}-\\bar{k}_{n-1} \\end{pmatrix} $$\n这个伴随矩阵的结构决定了其特征多项式：$\\det(zI - \\bar{A}_{cl}) = z^n + \\sum_{i=0}^{n-1} (a_i+\\bar{k}_i) z^i$。为了与期望的多项式 $\\rho_d(z) = z^n + \\sum_{i=0}^{n-1} \\alpha_i z^i$ 相匹配，我们令系数相等：\n$$ a_i + \\bar{k}_i = \\alpha_i \\implies \\bar{k}_i = \\alpha_i - a_i, \\quad \\text{for } i=0, \\dots, n-1. $$\n因此，在变换后坐标系中所需要的增益是 $\\bar{K} = \\begin{bmatrix} \\alpha_0-a_0 & \\alpha_1-a_1 & \\cdots & \\alpha_{n-1}-a_{n-1} \\end{bmatrix}$。\n\n**步骤 3：变换回原始坐标**\n为了找到原始坐标系中的增益 $K$，我们必须找到变换矩阵 $T$。我们有 $K = \\bar{K}T^{-1}$。变换矩阵 $T^{-1}$ 可以使用能控性矩阵构造。令 $k_c^T$ 为 $\\mathcal{C}^{-1}$ 的最后一行，即 $k_c^T = e_n^T \\mathcal{C}^{-1}$，其中 $e_n^T = \\begin{bmatrix} 0 & \\cdots & 0 & 1 \\end{bmatrix}$。变换矩阵 $T^{-1}$ 由下式给出：\n$$ T^{-1} = \\begin{pmatrix} k_c^T \\\\ k_c^T A \\\\ \\vdots \\\\ k_c^T A^{n-1} \\end{pmatrix} $$\n这种构造确实将 $(A,B)$ 变换为 $(\\bar{A},\\bar{B})$。$\\bar{A}$ 的最后一行由 $k_c^T A^n$ 决定。根据 Cayley-Hamilton 定理，$\\rho_A(A) = A^n + \\sum_{i=0}^{n-1} a_i A^i = 0$，所以 $A^n = -\\sum_{i=0}^{n-1} a_i A^i$。$\\bar{A}$ 的最后一行是 $(k_c^T A^n)T = -\\sum_{i=0}^{n-1} a_i (k_c^T A^i)T$。由于 $T^{-1}$ 的第 $(i+1)$ 行是 $k_c^T A^i$，我们有 $(k_c^T A^i)T = e_{i+1}^T$。这导致 $\\bar{A}$ 的最后一行是 $-\\sum_{i=0}^{n-1} a_i e_{i+1}^T = \\begin{bmatrix} -a_0 & -a_1 & \\cdots & -a_{n-1} \\end{bmatrix}$，这确认了 $\\bar{A}$ 的结构。\n\n**步骤 4：K 的最终表达式**\n我们现在可以把 $K$ 写成\n$$ K = \\bar{K}T^{-1} = \\sum_{i=0}^{n-1} \\bar{k}_i (\\text{$T^{-1}$ 的第 $i+1$ 行}) = \\sum_{i=0}^{n-1} (\\alpha_i - a_i) k_c^T A^i $$\n$$ K = k_c^T \\left( \\sum_{i=0}^{n-1} \\alpha_i A^i - \\sum_{i=0}^{n-1} a_i A^i \\right) $$\n期望的特征多项式在 $A$ 上的求值为 $\\rho_d(A) = A^n + \\sum_{i=0}^{n-1} \\alpha_i A^i$，所以 $\\sum_{i=0}^{n-1} \\alpha_i A^i = \\rho_d(A) - A^n$。类似地，根据 Cayley-Hamilton 定理，$\\rho_A(A) = A^n + \\sum_{i=0}^{n-1} a_i A^i = 0$，所以 $\\sum_{i=0}^{n-1} a_i A^i = -A^n$。\n将这些代入 $K$ 的表达式中：\n$$ K = k_c^T \\left( (\\rho_d(A) - A^n) - (-A^n) \\right) = k_c^T \\rho_d(A) $$\n代入 $k_c^T = e_n^T \\mathcal{C}^{-1}$，我们得到最终表达式：\n$$ K = e_n^T \\mathcal{C}^{-1} \\rho_d(A) $$\n这是一个通用的闭式表达式，通常称为 Ackermann 公式。其有效性依赖于一个关键假设，即系统对 $(A, B)$ 是能控的，这使得 $\\mathcal{C}$ 可逆。\n\n**第 2 部分：应用于具体数据**\n\n给定系统 $n=3$：\n$$ A=\\begin{bmatrix} 1 & 2 & 0\\\\ 0 & 1 & 1\\\\ 0 & 0 & 1 \\end{bmatrix}, \\quad B=\\begin{bmatrix} 0\\\\ 0\\\\ 1 \\end{bmatrix} $$\n期望的闭环极点为 $\\lambda_1=\\frac{1}{5}, \\lambda_2=\\frac{2}{5}, \\lambda_3=\\frac{4}{5}$。期望的特征多项式是：\n$$ \\rho_d(z) = (z-\\tfrac{1}{5})(z-\\tfrac{2}{5})(z-\\tfrac{4}{5}) = (z^2 - \\tfrac{3}{5}z + \\tfrac{2}{25})(z-\\tfrac{4}{5}) = z^3 - \\tfrac{7}{5}z^2 + \\tfrac{14}{25}z - \\tfrac{8}{125} $$\n系数为 $\\alpha_2 = -\\frac{7}{5}$，$\\alpha_1 = \\frac{14}{25}$，$\\alpha_0 = -\\frac{8}{125}$。\n\n**步骤 1：验证能控性**\n我们计算能控性矩阵 $\\mathcal{C} = \\begin{bmatrix} B & AB & A^2B \\end{bmatrix}$。\n$B = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$\n$AB = \\begin{bmatrix} 1 & 2 & 0\\\\ 0 & 1 & 1\\\\ 0 & 0 & 1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 \\\\ 1 \\end{bmatrix}$\n$A^2B = A(AB) = \\begin{bmatrix} 1 & 2 & 0\\\\ 0 & 1 & 1\\\\ 0 & 0 & 1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 2 \\\\ 2 \\\\ 1 \\end{bmatrix}$\n$$ \\mathcal{C} = \\begin{bmatrix} 0 & 0 & 2 \\\\ 0 & 1 & 2 \\\\ 1 & 1 & 1 \\end{bmatrix} $$\n其行列式为 $\\det(\\mathcal{C}) = 0 - 0 + 2(0-1) = -2$。由于 $\\det(\\mathcal{C}) \\neq 0$，系统是能控的。\n\n**步骤 2：计算 $e_3^T \\mathcal{C}^{-1}$**\n我们求 $\\mathcal{C}$ 的逆矩阵：\n$$ \\mathcal{C}^{-1} = \\frac{1}{\\det(\\mathcal{C})} \\text{adj}(\\mathcal{C}) = -\\frac{1}{2} \\begin{bmatrix} 1-2 & -(0-2) & 0-1 \\\\ -(0-2) & 0-2 & -(0-0) \\\\ 0-2 & -(0-0) & 0-0 \\end{bmatrix}^T = -\\frac{1}{2} \\begin{bmatrix} -1 & 2 & -1 \\\\ 2 & -2 & 0 \\\\ -2 & 0 & 0 \\end{bmatrix}^T = -\\frac{1}{2} \\begin{bmatrix} -1 & 2 & -2 \\\\ 2 & -2 & 0 \\\\ -1 & 0 & 0 \\end{bmatrix} = \\begin{bmatrix} 1/2 & -1 & 1 \\\\ -1 & 1 & 0 \\\\ 1/2 & 0 & 0 \\end{bmatrix} $$\n向量 $e_3^T \\mathcal{C}^{-1}$ 是 $\\mathcal{C}^{-1}$ 的最后一行：\n$$ e_3^T \\mathcal{C}^{-1} = \\begin{bmatrix} 1/2 & 0 & 0 \\end{bmatrix} $$\n\n**步骤 3：计算 $\\rho_d(A)$**\n我们必须计算 $\\rho_d(A) = A^3 - \\frac{7}{5}A^2 + \\frac{14}{25}A - \\frac{8}{125}I$。\n首先，我们计算 $A$ 的幂次：\n$A = \\begin{bmatrix} 1 & 2 & 0 \\\\ 0 & 1 & 1 \\\\ 0 & 0 & 1 \\end{bmatrix}$\n$A^2 = A \\cdot A = \\begin{bmatrix} 1 & 4 & 2 \\\\ 0 & 1 & 2 \\\\ 0 & 0 & 1 \\end{bmatrix}$\n$A^3 = A^2 \\cdot A = \\begin{bmatrix} 1 & 6 & 6 \\\\ 0 & 1 & 3 \\\\ 0 & 0 & 1 \\end{bmatrix}$\n现在，代入多项式表达式中：\n$$ \\rho_d(A) = \\begin{bmatrix} 1 & 6 & 6 \\\\ 0 & 1 & 3 \\\\ 0 & 0 & 1 \\end{bmatrix} - \\frac{7}{5}\\begin{bmatrix} 1 & 4 & 2 \\\\ 0 & 1 & 2 \\\\ 0 & 0 & 1 \\end{bmatrix} + \\frac{14}{25}\\begin{bmatrix} 1 & 2 & 0 \\\\ 0 & 1 & 1 \\\\ 0 & 0 & 1 \\end{bmatrix} - \\frac{8}{125}\\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} $$\n\n**步骤 4：计算 K**\n增益为 $K = (e_3^T \\mathcal{C}^{-1}) \\rho_d(A) = \\begin{bmatrix} 1/2 & 0 & 0 \\end{bmatrix} \\rho_d(A)$。该乘积的结果是一个行向量，其值为 $\\rho_d(A)$ 第一行的 $1/2$。令 $R_1(\\cdot)$ 为取第一行的算子。\n$$ R_1(\\rho_d(A)) = \\begin{bmatrix} 1 & 6 & 6 \\end{bmatrix} - \\frac{7}{5}\\begin{bmatrix} 1 & 4 & 2 \\end{bmatrix} + \\frac{14}{25}\\begin{bmatrix} 1 & 2 & 0 \\end{bmatrix} - \\frac{8}{125}\\begin{bmatrix} 1 & 0 & 0 \\end{bmatrix} $$\n我们计算这个行向量的每个分量：\n分量 1：$1 - \\frac{7}{5} + \\frac{14}{25} - \\frac{8}{125} = \\frac{125 - 175 + 70 - 8}{125} = \\frac{12}{125}$。\n分量 2：$6 - \\frac{7}{5}(4) + \\frac{14}{25}(2) = 6 - \\frac{28}{5} + \\frac{28}{25} = \\frac{150 - 140 + 28}{25} = \\frac{38}{25}$。\n分量 3：$6 - \\frac{7}{5}(2) + 0 = 6 - \\frac{14}{5} = \\frac{30 - 14}{5} = \\frac{16}{5}$。\n因此，$R_1(\\rho_d(A)) = \\begin{bmatrix} \\frac{12}{125} & \\frac{38}{25} & \\frac{16}{5} \\end{bmatrix}$。\n最后，我们求得 $K$：\n$$ K = \\frac{1}{2} R_1(\\rho_d(A)) = \\frac{1}{2} \\begin{bmatrix} \\frac{12}{125} & \\frac{38}{25} & \\frac{16}{5} \\end{bmatrix} = \\begin{bmatrix} \\frac{6}{125} & \\frac{19}{25} & \\frac{8}{5} \\end{bmatrix} $$\n这就是所求的精确状态反馈增益向量，其分量为最简分数形式。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{6}{125} & \\frac{19}{25} & \\frac{8}{5} \\end{pmatrix}}$$", "id": "2861105"}, {"introduction": "在控制系统中，能控性的对偶概念——能观测性，同样至关重要。一个在工程上常见但有潜在风险的操作是通过控制器来“抵消”系统中不希望的动态，例如一个不稳定的零点。本练习将通过一个经典案例揭示这种操作的内在危险：一个从输入到输出看似稳定的系统，其内部可能隐藏着不稳定的模式。这个问题的核心在于，不恰当的零极点对消会使不稳定的内部模式变得不可观测，从而导致灾难性的后果，这为我们提供了关于内部稳定性重要性的深刻教训。[@problem_id:2861162]", "problem": "考虑一个单输入单输出（SISO）离散时间被控对象，其传递函数为 $G_{p}(z) = \\dfrac{z - 1.2}{z - 0.3}$，以及一个单输入单输出（SISO）离散时间控制器，其传递函数为 $G_{c}(z) = \\dfrac{z - 0.3}{z - 1.2}$。每个都通过与定义 $G(z) = C (z I - A)^{-1} B + D$ 一致的最小状态空间实现来实施，如下所示：\n- 被控对象：$x_{p}[k+1] = A_{p} x_{p}[k] + B_{p} u[k]$, $y[k] = C_{p} x_{p}[k] + D_{p} u[k]$，其中 $A_{p} = [\\,0.3\\,]$, $B_{p} = [\\,-0.9\\,]$, $C_{p} = [\\,1\\,]$, $D_{p} = [\\,1\\,]$。\n- 控制器：$x_{c}[k+1] = A_{c} x_{c}[k] + B_{c} e[k]$, $u[k] = C_{c} x_{c}[k] + D_{c} e[k]$，其中 $A_{c} = [\\,1.2\\,]$, $B_{c} = [\\,0.9\\,]$, $C_{c} = [\\,1\\,]$, $D_{c} = [\\,1\\,]$。\n\n互联方式为单位负反馈，误差为 $e[k] = r[k] - y[k]$。外部参考输入为 $r[k]$，测量输出为 $y[k]$。\n\n仅使用状态空间离散时间传递函数、能控性、能观性和内部稳定性（内部状态矩阵的所有模式严格位于单位圆盘内）的基本定义，执行以下步骤：\n1. 验证 $G_{p}(z)$ 在 $z = 1.2$ 处有一个不稳定零点，并且 $G_{c}(z)$ 在 $z = 1.2$ 处放置了一个极点，从而导致闭环输入-输出映射中的极零点对消。\n2. 推导状态向量为 $x[k] = \\begin{pmatrix} x_{p}[k] \\\\ x_{c}[k] \\end{pmatrix}$ 的闭环状态空间实现，根据需要消去代数变量，并明确写出其状态更新矩阵 $A_{\\mathrm{cl}}$。\n3. 根据推导出的 $A_{\\mathrm{cl}}$，计算其特征值，并确定闭环互联系统是否内部稳定。\n4. 根据闭环实现的能观性和能控性，解释为什么尽管存在内部不稳定性，不稳定模式仍可能在输入-输出传递函数中被隐藏。\n5. 作为最终答案，给出 $A_{\\mathrm{cl}}$ 的不稳定内部特征值。\n\n最终答案应为一个实数。不需要四舍五入。不需要单位。", "solution": "首先验证问题的正确性和可解性。\n\n已知条件：\n被控对象传递函数：$G_{p}(z) = \\dfrac{z - 1.2}{z - 0.3}$\n被控对象状态空间实现：\n$x_{p}[k+1] = A_{p} x_{p}[k] + B_{p} u[k]$, $y[k] = C_{p} x_{p}[k] + D_{p} u[k]$\n$A_{p} = [\\,0.3\\,]$, $B_{p} = [\\,-0.9\\,]$, $C_{p} = [\\,1\\,]$, $D_{p} = [\\,1\\,]$\n\n控制器传递函数：$G_{c}(z) = \\dfrac{z - 0.3}{z - 1.2}$\n控制器状态空间实现：\n$x_{c}[k+1] = A_{c} x_{c}[k] + B_{c} e[k]$, $u[k] = C_{c} x_{c}[k] + D_{c} e[k]$\n$A_{c} = [\\,1.2\\,]$, $B_{c} = [\\,0.9\\,]$, $C_{c} = [\\,1\\,]$, $D_{c} = [\\,1\\,]$\n\n互联方式：单位负反馈，$e[k] = r[k] - y[k]$。\n组合状态向量：$x[k] = \\begin{pmatrix} x_{p}[k] \\\\ x_{c}[k] \\end{pmatrix}$\n\n验证：\n该问题在线性系统理论中有科学依据。在继续之前，我们使用公式 $G(z) = C (zI - A)^{-1} B + D$ 来验证所提供的状态空间实现是否与给定的传递函数相对应。\n对于被控对象：\n$G_{p}(z) = [\\,1\\,](z - 0.3)^{-1}[\\,-0.9\\,] + 1 = \\dfrac{-0.9}{z - 0.3} + 1 = \\dfrac{-0.9 + z - 0.3}{z - 0.3} = \\dfrac{z - 1.2}{z - 0.3}$。这是一致的。\n对于控制器：\n$G_{c}(z) = [\\,1\\,](z - 1.2)^{-1}[\\,0.9\\,] + 1 = \\dfrac{0.9}{z - 1.2} + 1 = \\dfrac{0.9 + z - 1.2}{z - 1.2} = \\dfrac{z - 0.3}{z - 1.2}$。这也是一致的。\n该问题是自洽的、客观的且适定的。未发现任何缺陷。问题有效。\n\n步骤1：极零点对消\n被控对象传递函数 $G_{p}(z)$ 的分子为 $z - 1.2$，因此它在 $z = 1.2$ 处有一个零点。由于 $|1.2| > 1$，这是一个不稳定零点。\n控制器传递函数 $G_{c}(z)$ 的分母为 $z - 1.2$，因此它在 $z = 1.2$ 处有一个极点。\n开环传递函数为 $L(z) = G_{p}(z) G_{c}(z)$。\n$$L(z) = \\left( \\dfrac{z - 1.2}{z - 0.3} \\right) \\left( \\dfrac{z - 0.3}{z - 1.2} \\right) = 1$$\n从参考 $r[k]$ 到输出 $y[k]$ 的闭环传递函数为 $T(z) = \\dfrac{L(z)}{1 + L(z)}$。\n$$T(z) = \\dfrac{1}{1 + 1} = \\dfrac{1}{2}$$\n计算显示了完全的极零点对消。被控对象的不稳定零点被控制器的不稳定极点所抵消。最终的输入-输出映射是一个常数增益，是稳定的。然而，这种分析只涉及外部行为，可能会隐藏内部的不稳定。\n\n步骤2：闭环状态空间实现的推导\n状态空间方程为：\n1. $x_{p}[k+1] = A_{p} x_{p}[k] + B_{p} u[k]$\n2. $y[k] = C_{p} x_{p}[k] + D_{p} u[k]$\n3. $x_{c}[k+1] = A_{c} x_{c}[k] + B_{c} e[k]$\n4. $u[k] = C_{c} x_{c}[k] + D_{c} e[k]$\n5. $e[k] = r[k] - y[k]$\n\n我们必须消去代数变量 $u[k]$ 和 $e[k]$，以状态向量 $x[k]$ 和外部输入 $r[k]$ 的形式来表示闭环系统。\n首先，将(2)代入(5)：\n$e[k] = r[k] - (C_{p} x_{p}[k] + D_{p} u[k])$\n将此结果代入(4)：\n$u[k] = C_{c} x_{c}[k] + D_{c} (r[k] - C_{p} x_{p}[k] - D_{p} u[k])$\n$u[k] = C_{c} x_{c}[k] + D_{c} r[k] - D_{c} C_{p} x_{p}[k] - D_{c} D_{p} u[k]$\n$u[k] (1 + D_{p} D_{c}) = -D_{c} C_{p} x_{p}[k] + C_{c} x_{c}[k] + D_{c} r[k]$\n令 $M = (1 + D_{p} D_{c})^{-1}$。\n$u[k] = M(-D_{c} C_{p} x_{p}[k] + C_{c} x_{c}[k] + D_{c} r[k])$\n现在以状态和 $r[k]$ 的形式求解 $e[k]$：\n$e[k] = r[k] - y[k] = r[k] - C_{p} x_{p}[k] - D_{p} u[k]$\n$e[k] = r[k] - C_{p} x_{p}[k] - D_{p} M(-D_{c} C_{p} x_{p}[k] + C_{c} x_{c}[k] + D_{c} r[k])$\n$e[k] = (1 - D_{p} M D_{c}) r[k] - (C_{p} - D_{p} M D_{c} C_{p}) x_{p}[k] - D_{p} M C_{c} x_{c}[k]$\n使用恒等式 $(1+D_p D_c)^{-1} = 1 - D_p (1+D_c D_p)^{-1} D_c$，我们可以简化。但是，直接代入给定的数值更直接：$A_{p}=0.3$, $B_{p}=-0.9$, $C_{p}=1$, $D_{p}=1$，以及 $A_{c}=1.2$, $B_{c}=0.9$, $C_{c}=1$, $D_{c}=1$。\n$u[k](1 + 1 \\cdot 1) = -(1)(1)x_{p}[k] + (1)x_{c}[k] + (1)r[k]$\n$2u[k] = -x_{p}[k] + x_{c}[k] + r[k] \\implies u[k] = -0.5 x_{p}[k] + 0.5 x_{c}[k] + 0.5 r[k]$\n对于 $e[k]$：\n$e[k] = r[k] - y[k] = r[k] - (x_{p}[k] + u[k]) = r[k] - x_{p}[k] - (-0.5 x_{p}[k] + 0.5 x_{c}[k] + 0.5 r[k])$\n$e[k] = -0.5 x_{p}[k] - 0.5 x_{c}[k] + 0.5 r[k]$\n现在将这些代入状态更新方程：\n$x_{p}[k+1] = 0.3 x_{p}[k] - 0.9 u[k] = 0.3 x_{p}[k] - 0.9(-0.5 x_{p}[k] + 0.5 x_{c}[k] + 0.5 r[k])$\n$x_{p}[k+1] = (0.3 + 0.45)x_{p}[k] - 0.45 x_{c}[k] - 0.45 r[k] = 0.75 x_{p}[k] - 0.45 x_{c}[k] - 0.45 r[k]$\n$x_{c}[k+1] = 1.2 x_{c}[k] + 0.9 e[k] = 1.2 x_{c}[k] + 0.9(-0.5 x_{p}[k] - 0.5 x_{c}[k] + 0.5 r[k])$\n$x_{c}[k+1] = -0.45 x_{p}[k] + (1.2 - 0.45)x_{c}[k] + 0.45 r[k] = -0.45 x_{p}[k] + 0.75 x_{c}[k] + 0.45 r[k]$\n闭环状态空间系统为：\n$$ \\begin{pmatrix} x_{p}[k+1] \\\\ x_{c}[k+1] \\end{pmatrix} = \\begin{pmatrix} 0.75 & -0.45 \\\\ -0.45 & 0.75 \\end{pmatrix} \\begin{pmatrix} x_{p}[k] \\\\ x_{c}[k] \\end{pmatrix} + \\begin{pmatrix} -0.45 \\\\ 0.45 \\end{pmatrix} r[k] $$\n状态更新矩阵为 $A_{\\mathrm{cl}} = \\begin{pmatrix} 0.75 & -0.45 \\\\ -0.45 & 0.75 \\end{pmatrix}$。\n\n步骤3：$A_{\\mathrm{cl}}$ 的特征值与内部稳定性\n$A_{\\mathrm{cl}}$ 的特征值 $\\lambda$ 可通过 $\\det(A_{\\mathrm{cl}} - \\lambda I) = 0$ 求得。\n$$ \\det \\begin{pmatrix} 0.75 - \\lambda & -0.45 \\\\ -0.45 & 0.75 - \\lambda \\end{pmatrix} = (0.75 - \\lambda)^{2} - (-0.45)^{2} = 0 $$\n$(0.75 - \\lambda)^{2} = (0.45)^{2}$\n$0.75 - \\lambda = \\pm 0.45$\n两个特征值为：\n$\\lambda_{1} = 0.75 - 0.45 = 0.3$\n$\\lambda_{2} = 0.75 + 0.45 = 1.2$\n对于一个离散时间系统，要使其内部稳定，状态矩阵的所有特征值的模必须严格小于1。在这里，$|\\lambda_{2}| = 1.2 > 1$。因此，闭环系统是内部不稳定的。\n\n步骤4：对隐藏的不稳定模式的解释\n不稳定模式对应于特征值 $\\lambda_{2} = 1.2$。传递函数 $T(z)=\\frac{1}{2}$ 未表现出这种不稳定性。这种现象的发生是因为该不稳定模式从输出 $y[k]$ 来看是不可观测的。我们分析闭环系统的能控性和能观性。\n完整的闭环系统为 $x[k+1] = A_{\\mathrm{cl}} x[k] + B_{\\mathrm{cl}} r[k]$, $y[k] = C_{\\mathrm{cl}} x[k] + D_{\\mathrm{cl}} r[k]$。\n根据步骤2，$B_{\\mathrm{cl}} = \\begin{pmatrix} -0.45 \\\\ 0.45 \\end{pmatrix}$。\n我们推导 $C_{\\mathrm{cl}}$ 和 $D_{\\mathrm{cl}}$：\n$y[k] = C_{p}x_{p}[k] + D_{p}u[k] = x_{p}[k] + u[k]$\n$y[k] = x_{p}[k] + (-0.5 x_{p}[k] + 0.5 x_{c}[k] + 0.5 r[k])$\n$y[k] = 0.5 x_{p}[k] + 0.5 x_{c}[k] + 0.5 r[k]$\n所以，$C_{\\mathrm{cl}} = \\begin{pmatrix} 0.5 & 0.5 \\end{pmatrix}$ 且 $D_{\\mathrm{cl}} = 0.5$。\n\n我们使用 Popov-Belevitch-Hautus (PBH) 检验来检查不稳定模式 $\\lambda_2 = 1.2$ 的能观性。如果矩阵 $\\begin{pmatrix} \\lambda_{2} I - A_{\\mathrm{cl}} \\\\ C_{\\mathrm{cl}} \\end{pmatrix}$ 的秩小于状态维度 $n=2$，则该模式是不可观测的。\n$$ \\begin{pmatrix} \\lambda_{2} I - A_{\\mathrm{cl}} \\\\ C_{\\mathrm{cl}} \\end{pmatrix} = \\begin{pmatrix} 1.2 - 0.75 & -(-0.45) \\\\ -(-0.45) & 1.2 - 0.75 \\\\ \\hline 0.5 & 0.5 \\end{pmatrix} = \\begin{pmatrix} 0.45 & 0.45 \\\\ 0.45 & 0.45 \\\\ 0.5 & 0.5 \\end{pmatrix} $$\n该矩阵的所有三行都是线性相关的（每一行都是 $\\begin{pmatrix} 1 & 1 \\end{pmatrix}$ 的倍数）。该矩阵的秩为1，小于 $n=2$。因此，与特征值 $\\lambda_2 = 1.2$ 相关联的模式是不可观测的。\n从物理上看，这意味着尽管与此模式对应的内部状态可以无界增长，但这种增长在输出端被完美抵消，因此通过 $y[k]$ 无法观测到。与 $\\lambda_2 = 1.2$ 对应的特征向量 $v_2$ 通过求解 $(A_{\\mathrm{cl}} - 1.2 I)v_2 = 0$ 得到：\n$\\begin{pmatrix} -0.45 & -0.45 \\\\ -0.45 & -0.45 \\end{pmatrix} v_2 = 0$。这给出一个与 $v_2 = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$ 成比例的特征向量。\n此模式对输出的影响由 $C_{\\mathrm{cl}} v_2 = \\begin{pmatrix} 0.5 & 0.5 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = 0.5 - 0.5 = 0$ 给出。输出测量值与不稳定状态模式的方向正交，使其不可见。这是传递函数域中极零点对消在状态空间中的体现。\n\n步骤5：最终答案\n$A_{\\mathrm{cl}}$ 的特征值为 $0.3$ 和 $1.2$。不稳定的内部特征值是模大于1的那个。这个值是 $1.2$。", "answer": "$$\\boxed{1.2}$$", "id": "2861162"}]}