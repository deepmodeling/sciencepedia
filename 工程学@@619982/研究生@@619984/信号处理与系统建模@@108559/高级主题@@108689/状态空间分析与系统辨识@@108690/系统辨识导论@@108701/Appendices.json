{"hands_on_practices": [{"introduction": "系统辨识的实践常常始于分析系统的频率响应，这是连接理论与实验数据的基本桥梁。本练习将指导您如何从实验测得的波特图（Bode plot）中提取关键信息，并将其转化为一个一阶传递函数模型。通过这个过程，您将掌握从图形化的频域数据中估计静态增益（static gain）$K$和时间常数（time constant）$\\tau$等核心参数的基本技能 [@problem_id:1585873]。", "problem": "一位工程师的任务是根据实验数据辨识一个稳定、最小相位的一阶系统。在进行频率响应分析后，该系统伯德幅频图的渐近线已被精确地确定。\n\n在非常低的频率下，观察到幅频响应趋近于一条恒定的水平渐近线，其值为 $15.0$ dB。在非常高的频率下，幅频响应可以很好地由一条斜率为 $-20$ dB/十倍频程的直线渐近线来近似。已知这条高频渐近线通过角频率为 $250$ rad/s 时幅值为 $-18.5$ dB 的点。\n\n该系统将用形式为 $G(s) = \\frac{K}{\\tau s + 1}$ 的传递函数进行建模，其中 $K$ 是静态增益，$\\tau$ 是时间常数。根据所描述的渐近行为，确定静态增益 $K$ 和转折频率 $\\omega_c = 1/\\tau$ 的值。\n\n以静态增益 $K$ 和转折频率 $\\omega_c$ 的一对数值形式给出你的答案。静态增益 $K$ 是一个无量纲量。转折频率 $\\omega_c$ 以 rad/s 为单位表示。将两个数值都四舍五入到三位有效数字。", "solution": "对于一个一阶低通系统 $G(s)=\\dfrac{K}{\\tau s+1}$，其幅值为\n$$\n|G(j\\omega)|=\\frac{K}{\\sqrt{1+(\\tau\\omega)^{2}}},\n$$\n因此，以分贝表示的伯德幅值为\n$$\nM(\\omega)=20\\log_{10}|G(j\\omega)|=20\\log_{10}K-10\\log_{10}\\!\\big(1+(\\tau\\omega)^{2}\\big).\n$$\n该系统的波特图由两条渐近线构成：一条低频水平渐近线和一条高频斜率为 -20 dB/十倍频程的渐近线。这两条渐近线在转折频率 $\\omega_c = 1/\\tau$ 处相交。\n\n1.  **计算静态增益 $K$**：\n    在低频区 ($\\omega \\to 0$)，幅值渐近线为 $M_{LF} = 20\\log_{10}K$。根据题意，该值为 $15.0$ dB。\n    $$\n    20\\log_{10}K = 15.0 \\implies \\log_{10}K = \\frac{15.0}{20} = 0.75 \\implies K = 10^{0.75} \\approx 5.623\n    $$\n\n2.  **计算转折频率 $\\omega_c$**：\n    在高频区 ($\\omega \\gg \\omega_c$)，幅值渐近线为 $M_{HF}(\\omega) \\approx 20\\log_{10}K - 20\\log_{10}(\\omega/\\omega_c) = 20\\log_{10}K + 20\\log_{10}\\omega_c - 20\\log_{10}\\omega$。\n    我们知道两条渐近线在 $\\omega = \\omega_c$ 处相交，此时幅值为 $20\\log_{10}K$。\n    高频渐近线方程可以写成 $M(\\omega) = -20\\log_{10}\\omega + C$。我们利用已知点 $(\\omega=250, M=-18.5)$ 来确定常数 $C$：\n    $$\n    -18.5 = -20\\log_{10}(250) + C \\implies C = -18.5 + 20\\log_{10}(250)\n    $$\n    在转折频率 $\\omega_c$ 处，低频和高频渐近线的值相等：\n    $$\n    15.0 = -20\\log_{10}(\\omega_c) + C\n    $$\n    将 $C$ 代入：\n    $$\n    15.0 = -20\\log_{10}(\\omega_c) - 18.5 + 20\\log_{10}(250)\n    $$\n    整理可得：\n    $$\n    20\\log_{10}(\\omega_c) = 20\\log_{10}(250) - 18.5 - 15.0 = 20\\log_{10}(250) - 33.5\n    $$\n    $$\n    20\\log_{10}(\\omega_c) \\approx 20 \\times 2.39794 - 33.5 = 47.9588 - 33.5 = 14.4588\n    $$\n    $$\n    \\log_{10}(\\omega_c) \\approx \\frac{14.4588}{20} \\approx 0.72294\n    $$\n    $$\n    \\omega_c = 10^{0.72294} \\approx 5.2838 \\text{ rad/s}\n    $$\n\n3.  **四舍五入**：\n    将静态增益 $K$ 和转折频率 $\\omega_c$ 四舍五入到三位有效数字：\n    $$\n    K \\approx 5.62, \\qquad \\omega_c \\approx 5.28 \\text{ rad/s}\n    $$", "answer": "$$\\boxed{\\begin{pmatrix}5.62 & 5.28\\end{pmatrix}}$$", "id": "1585873"}, {"introduction": "在现实世界的辨识问题中，测量噪声往往不是理想的白噪声，这使得经典的最小二乘法（Ordinary Least Squares）会产生有偏估计。本练习将您置于一个更具挑战性但更贴近实际的场景：一个输出受有色噪声（colored noise）干扰的系统。您将学习并应用工具变量法（Instrumental Variables, IV），这是一种强大的技术，能够在存在相关扰动时获得一致的参数估计 [@problem_id:2878920]。", "problem": "考虑一个单输入单输出离散时间系统，该系统由一个已知的标量输入信号 $u(t)$ 激励，并产生一个可测量的标量输出 $y(t)$。您采用以下具有外源输入的自回归 (ARX) 结构和有色扰动的预测器形式：\n$$\ny(t) \\;=\\; a\\,y(t-1)\\;+\\;b\\,u(t-1)\\;+\\;v(t),\\qquad v(t)\\;=\\;e(t)\\;+\\;c\\,e(t-1),\n$$\n其中 $\\{e(t)\\}$ 是一个独立同分布 (i.i.d.) 的零均值有限方差序列，且 $\\{e(t)\\}$ 在统计上与输入 $\\{u(t)\\}$ 无关。由于扰动 $v(t)$ 是有色的，普通最小二乘法对于估计 $\\theta \\triangleq \\begin{pmatrix} a & b \\end{pmatrix}^{\\top}$ 是不一致的。为了解决这个问题，您将使用工具变量 (IV) 法，其中有效的工具变量矩阵 $Z$ 必须满足两个属性：(i) 工具变量相关性（与回归量非零相关），以及 (ii) 工具变量外生性（与 $v(t)$ 零相关）。\n\n您可以访问从一个稳定系统生成的以下测量数据，其初始条件为 $y(0)=0$ 和 $u(0)=0$：\n- 输入：$u(1)=1$, $u(2)=0$, $u(3)=1$, $u(4)=0$, $u(5)=1$, $u(6)=0$。\n- 输出：$y(1)=1$, $y(2)=1$, $y(3)=0$, $y(4)=2$, $y(5)=1.5$, $y(6)=0.75$。\n\n通过堆叠 $t\\in\\{3,4,5,6\\}$ 的行来形成回归矩阵 $\\Phi$ 和数据向量 $y$，其中 $\\Phi$ 的每一行由 $\\begin{pmatrix} y(t-1) & u(t-1) \\end{pmatrix}$ 给出，而 $y$ 的相应条目由 $y(t)$ 给出。仅使用滞后输入构造一个有效的工具变量矩阵 $Z$，使得对于上述数据，每个工具变量都与 $\\Phi$ 的列相关，但与 $v(t)$ 不相关。然后，使用工具变量法以及由工具变量外生性和相关性所蕴含的样本矩条件，计算工具变量估计值 $\\hat{\\theta}_{\\mathrm{IV}}$。\n\n将您的最终估计表示为单个行向量 $\\begin{pmatrix} \\hat{a} & \\hat{b} \\end{pmatrix}$。无需四舍五入。", "solution": "该问题是系统辨识中的一个经典练习，旨在解决当噪声为有色噪声时，使用普通最小二乘法 (OLS) 会产生有偏估计的问题。为此，我们采用工具变量 (IV) 法来获得一致的参数估计。下面，我们根据题目给出的数据和指示的步骤进行求解。\n\n1.  **构建回归方程**\n    根据题目要求，我们使用 $t \\in \\{3, 4, 5, 6\\}$ 的数据构建回归方程 $\\mathbf{y} = \\Phi\\theta + \\mathbf{v}$。\n    输出向量 $\\mathbf{y}$ 和回归矩阵 $\\Phi$ 分别为：\n    $$\n    \\mathbf{y} = \\begin{pmatrix} y(3) \\\\ y(4) \\\\ y(5) \\\\ y(6) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 2 \\\\ 1.5 \\\\ 0.75 \\end{pmatrix}\n    $$\n    $$\n    \\Phi = \\begin{pmatrix} y(2) & u(2) \\\\ y(3) & u(3) \\\\ y(4) & u(4) \\\\ y(5) & u(5) \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 2 & 0 \\\\ 1.5 & 1 \\end{pmatrix}\n    $$\n\n2.  **构建工具变量矩阵**\n    由于噪声 $v(t) = e(t) + c e(t-1)$ 是有色的，回归量 $y(t-1)$（其自身依赖于 $e(t-1)$）与噪声项 $v(t)$ 相关。这使得 OLS 估计有偏。我们采用工具变量法，并根据题目建议，使用滞后输入构造工具变量。一个有效的选择是 $z_t^{\\top} = \\begin{pmatrix} u(t-2) & u(t-1) \\end{pmatrix}$，因为它与回归量相关，但与噪声 $v(t)$ 不相关。\n    对于 $t \\in \\{3, 4, 5, 6\\}$，我们构造工具变量矩阵 $Z$：\n    $$\n    Z = \\begin{pmatrix} u(1) & u(2) \\\\ u(2) & u(3) \\\\ u(3) & u(4) \\\\ u(4) & u(5) \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n    $$\n\n3.  **计算IV估计值**\n    工具变量估计值 $\\hat{\\theta}_{\\mathrm{IV}}$ 通过求解样本矩条件 $Z^{\\top}(\\mathbf{y} - \\Phi\\hat{\\theta}) = 0$ 得到，其解为：\n    $$\n    \\hat{\\theta}_{\\mathrm{IV}} = (Z^{\\top}\\Phi)^{-1}Z^{\\top}\\mathbf{y}\n    $$\n    我们分步计算所需的矩阵：\n    $$\n    Z^{\\top}\\Phi = \\begin{pmatrix} 1 & 0 & 1 & 0 \\\\ 0 & 1 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 2 & 0 \\\\ 1.5 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + 1 \\cdot 2 & 1 \\cdot 0 + 1 \\cdot 0 \\\\ 1 \\cdot 0 + 1 \\cdot 1.5 & 1 \\cdot 1 + 1 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 3 & 0 \\\\ 1.5 & 2 \\end{pmatrix}\n    $$\n    $$\n    (Z^{\\top}\\Phi)^{-1} = \\frac{1}{3 \\cdot 2 - 0 \\cdot 1.5} \\begin{pmatrix} 2 & 0 \\\\ -1.5 & 3 \\end{pmatrix} = \\frac{1}{6} \\begin{pmatrix} 2 & 0 \\\\ -1.5 & 3 \\end{pmatrix} = \\begin{pmatrix} 1/3 & 0 \\\\ -1/4 & 1/2 \\end{pmatrix}\n    $$\n    $$\n    Z^{\\top}\\mathbf{y} = \\begin{pmatrix} 1 & 0 & 1 & 0 \\\\ 0 & 1 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 2 \\\\ 1.5 \\\\ 0.75 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 0 + 1 \\cdot 1.5 \\\\ 1 \\cdot 2 + 1 \\cdot 0.75 \\end{pmatrix} = \\begin{pmatrix} 1.5 \\\\ 2.75 \\end{pmatrix} = \\begin{pmatrix} 3/2 \\\\ 11/4 \\end{pmatrix}\n    $$\n    最后，计算IV估计值：\n    $$\n    \\hat{\\theta}_{\\mathrm{IV}} = \\begin{pmatrix} \\hat{a} \\\\ \\hat{b} \\end{pmatrix} = (Z^{\\top}\\Phi)^{-1} (Z^{\\top}\\mathbf{y}) = \\begin{pmatrix} 1/3 & 0 \\\\ -1/4 & 1/2 \\end{pmatrix} \\begin{pmatrix} 3/2 \\\\ 11/4 \\end{pmatrix}\n    $$\n    $$\n    \\hat{\\theta}_{\\mathrm{IV}} = \\begin{pmatrix} (1/3)(3/2) + (0)(11/4) \\\\ (-1/4)(3/2) + (1/2)(11/4) \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ -3/8 + 11/8 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 8/8 \\end{pmatrix} = \\begin{pmatrix} 0.5 \\\\ 1 \\end{pmatrix}\n    $$\n    因此，估计的参数为 $\\hat{a} = 0.5$ 和 $\\hat{b} = 1$。按要求表示为行向量。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.5 & 1 \\end{pmatrix}}\n$$", "id": "2878920"}, {"introduction": "在系统辨识中，一个核心挑战是如何选择恰当的模型复杂度——模型过于简单会导致欠拟合，而过于复杂则会过度拟合噪声。本练习介绍了一种解决此问题的原则性方法：贝叶斯信息准则（Bayesian Information Criterion, BIC）。通过对模型复杂度进行惩罚，您将学习如何在一系列候选模型中权衡拟合优度与参数数量，从而选出最合理的模型阶数 [@problem_id:2878934]。", "problem": "给定一个由阶数参数 $p \\in \\{1,2,3,4,5\\}$ 索引的离散时间单输入单输出带外源输入的自回归 (ARX) 模型族。对于每个候选阶数 $p$，在长度为 $N=1000$ 的数据记录上进行了一次辨识实验，其产生的一步预测残差序列可以很好地被建模为均值为零、方差未知的独立同分布高斯噪声。相应的估计残差方差 $\\hat{\\sigma}_{p}^{2}$ (计算为残差平方的经验均值) 和模型自由参数的数量 $k_{p}$ 如下所列：\n- $p=1$: $\\hat{\\sigma}_{1}^{2} = 1.05$, $k_{1} = 3$。\n- $p=2$: $\\hat{\\sigma}_{2}^{2} = 0.98$, $k_{2} = 5$。\n- $p=3$: $\\hat{\\sigma}_{3}^{2} = 0.94$, $k_{3} = 7$。\n- $p=4$: $\\hat{\\sigma}_{4}^{2} = 0.93$, $k_{4} = 9$。\n- $p=5$: $\\hat{\\sigma}_{5}^{2} = 0.929$, $k_{5} = 11$。\n\n从残差的高斯似然出发，并根据贝叶斯信息准则 (BIC) 的定义——即作为负二倍对数模型证据的大样本近似，其包含一个与自由参数数量和样本容量的对数成正比的复杂度惩罚项——推导出一个仅依赖于 $N$、$\\hat{\\sigma}_{p}^{2}$ 和 $k_{p}$ 且足以比较这些模型的选择分数。然后，使用该分数，计算每个 $p \\in \\{1,2,3,4,5\\}$ 对应的值，并确定应选择的阶数 $p^{\\star}$。\n\n仅报告使分数最小化的阶数索引 $p^{\\star}$ 作为最终答案。由于 $p^{\\star}$ 是一个整数，因此无需舍入说明。", "solution": "该问题要求使用贝叶斯信息准则 (BIC) 从一组候选 ARX 模型中选择最优模型阶数 $p$。\n\n1.  **推导BIC选择分数**\n    贝叶斯信息准则 (BIC) 的通用定义为：\n    $$ \\text{BIC}_p = -2 \\ln L_{max, p} + k_p \\ln(N) $$\n    其中 $L_{max, p}$ 是模型 $p$ 的最大似然值，$k_p$ 是自由参数的数量，$N$ 是样本量。\n    对于独立同分布的高斯残差，最大化对数似然 $\\ln L_{max, p}$ 为：\n    $$ \\ln L_{max, p} = -\\frac{N}{2} \\left[ \\ln(\\hat{\\sigma}_p^2) + \\ln(2\\pi) + 1 \\right] $$\n    其中 $\\hat{\\sigma}_p^2$ 是残差方差的最大似然估计。\n    将此代入 BIC 公式：\n    $$ \\text{BIC}_p = N \\left[ \\ln(\\hat{\\sigma}_p^2) + \\ln(2\\pi) + 1 \\right] + k_p \\ln(N) $$\n    $$ \\text{BIC}_p = N \\ln(\\hat{\\sigma}_p^2) + k_p \\ln(N) + N(\\ln(2\\pi) + 1) $$\n    为了比较不同阶数 $p$ 的模型，我们只需关注随 $p$ 变化的项。常数项 $N(\\ln(2\\pi) + 1)$ 可以省略。因此，我们使用以下选择分数 $S_p$ 来选择模型，目标是最小化 $S_p$：\n    $$ S_p = N \\ln(\\hat{\\sigma}_p^2) + k_p \\ln(N) $$\n\n2.  **计算各阶数的分数**\n    我们使用给定的数据 ($N=1000$，$\\ln(1000) \\approx 6.907755$) 来计算每个候选阶数 $p \\in \\{1, 2, 3, 4, 5\\}$ 的分数。\n\n    -   **p=1**: $k_1=3$, $\\hat{\\sigma}_1^2=1.05$\n        $S_1 = 1000 \\ln(1.05) + 3 \\ln(1000) \\approx 1000(0.048790) + 3(6.907755) \\approx 48.790 + 20.723 = 69.513$\n\n    -   **p=2**: $k_2=5$, $\\hat{\\sigma}_2^2=0.98$\n        $S_2 = 1000 \\ln(0.98) + 5 \\ln(1000) \\approx 1000(-0.020203) + 5(6.907755) \\approx -20.203 + 34.539 = 14.336$\n\n    -   **p=3**: $k_3=7$, $\\hat{\\sigma}_3^2=0.94$\n        $S_3 = 1000 \\ln(0.94) + 7 \\ln(1000) \\approx 1000(-0.061875) + 7(6.907755) \\approx -61.875 + 48.354 = -13.521$\n\n    -   **p=4**: $k_4=9$, $\\hat{\\sigma}_4^2=0.93$\n        $S_4 = 1000 \\ln(0.93) + 9 \\ln(1000) \\approx 1000(-0.072571) + 9(6.907755) \\approx -72.571 + 62.170 = -10.401$\n\n    -   **p=5**: $k_5=11$, $\\hat{\\sigma}_5^2=0.929$\n        $S_5 = 1000 \\ln(0.929) + 11 \\ln(1000) \\approx 1000(-0.073651) + 11(6.907755) \\approx -73.651 + 75.985 = 2.334$\n\n3.  **确定最优阶数**\n    比较计算出的分数：\n    $S_1 \\approx 69.513$\n    $S_2 \\approx 14.336$\n    $S_3 \\approx -13.521$ (最小值)\n    $S_4 \\approx -10.401$\n    $S_5 \\approx 2.334$\n\n    当 $p=3$ 时，分数达到最小值。这表明根据贝叶斯信息准则，阶数为 3 的模型在拟合优度（低残差方差）和模型复杂度（参数数量）之间提供了最佳的权衡。因此，所选的最优模型阶数为 $p^{\\star}=3$。", "answer": "$$\\boxed{3}$$", "id": "2878934"}]}