{"hands_on_practices": [{"introduction": "当一个模型过于简单（即欠拟合）时，它所忽略的动态特性将以结构化模式出现在残差中。本练习将引导你完成一个强大的诊断技术：通过分析残差的偏自相关函数（PACF），来识别缺失的自回归动态的阶数。[@problem_id:2884970] 这是改进和完善初始模型的一项基本技能。", "problem": "一个离散时间、零均值的二阶平稳残差过程 $\\{e_t\\}$ 是在对一个稳定线性时不变系统的输入输出数据进行模型拟合时产生的。假设拟合的模型参数化不足，导致残差中保留了线性相关性，这种相关性可以由一个未知阶数 $m$ 的有限阶自回归 (AR) 过程来表示。考虑从 $e_t$ 的 $m$ 个最近的过去值对其进行的一步线性最小均方误差 (MMSE) 预测，记为 $\\hat{e}_t = \\sum_{k=1}^{m} a_k e_{t-k}$，并将预测误差记为 $\\varepsilon_t = e_t - \\hat{e}_t$。\n\n1) 从 MMSE 预测的正交性原理出发，即 $\\varepsilon_t$ 与过去的回归量 $\\{e_{t-i}\\}_{i=1}^{m}$ 正交，推导出连接自协方差函数 $\\gamma(i) = \\mathbb{E}[e_t e_{t-i}]$ 与 AR 系数 $\\{a_k\\}_{k=1}^{m}$ 的正规方程。将结果表示为关于 $\\mathbf{a} = [a_1,\\dots,a_m]^{\\top}$ 的托普利兹 (Toeplitz) 线性系统形式，并用 $\\{\\gamma(k)\\}_{k=0}^{m}$ 和 $\\{a_k\\}_{k=1}^{m}$ 表示残差新息方差 $\\sigma_{\\varepsilon}^{2} = \\mathbb{E}[\\varepsilon_t^2]$。\n\n2) 现在使用这些方程进行残差分析和模型验证。给定 $N = 400$ 个残差样本，其（有偏）样本自协方差为\n$$\\hat{\\gamma}(0) = 1.0000,\\quad \\hat{\\gamma}(1) = 0.5000,\\quad \\hat{\\gamma}(2) = 0.1000,\\quad \\hat{\\gamma}(3) = -0.0400,\\quad \\hat{\\gamma}(4) = -0.0440.$$\n计算 $k=1,2,3,4$ 时的样本自相关 $\\hat{r}(k) = \\hat{\\gamma}(k)/\\hat{\\gamma}(0)$。使用您推导的方程所蕴含的 Durbin–Levinson 递归，计算前四个样本偏自相关系数（偏自相关函数 (PACF)）$\\{\\hat{\\alpha}(k)\\}_{k=1}^{4}$。\n\n3) 在大样本近似下，对于一个真实阶数为 $m$ 的自回归过程，当 $k>m$ 时，$\\hat{\\alpha}(k)$ 的抽样分布近似为均值为 $0$、标准差为 $1/\\sqrt{N}$ 的正态分布。使用 $0.05$ 的双边显著性水平（即，将 $|\\hat{\\alpha}(k)|$ 与阈值 $1.96/\\sqrt{N}$进行比较），选择最小的阶数 $m$，使得所有超过 $m$ 且不大于 $4$ 的滞后项在统计上均不显著。将此 $m$ 解释为因欠拟合而估计出的缺失阶数。\n\n仅报告估计的缺失阶数，以单个整数形式作答。无需单位。", "solution": "所给问题是时间序列分析应用于模型验证的一个标准练习。该问题在科学上是合理的，提法得当，并包含了所有必要信息。我将着手解决它。\n\n第1部分：正规方程和新息方差的推导\n\n平稳过程 $\\{e_t\\}$ 的一步线性最小均方误差 (MMSE) 预测器由 $\\hat{e}_t = \\sum_{k=1}^{m} a_k e_{t-k}$ 给出。预测误差为 $\\varepsilon_t = e_t - \\hat{e}_t$。正交性原理指出，对于 MMSE 预测器，误差向量与观测子空间正交。这意味着误差与任何回归量的乘积的期望为零：\n$$\n\\mathbb{E}[\\varepsilon_t e_{t-i}] = 0 \\quad \\text{for } i \\in \\{1, 2, \\dots, m\\}\n$$\n代入 $\\varepsilon_t$ 的表达式：\n$$\n\\mathbb{E}\\left[\\left(e_t - \\sum_{k=1}^{m} a_k e_{t-k}\\right) e_{t-i}\\right] = 0\n$$\n根据期望算子的线性性质：\n$$\n\\mathbb{E}[e_t e_{t-i}] - \\sum_{k=1}^{m} a_k \\mathbb{E}[e_{t-k} e_{t-i}] = 0\n$$\n设过程的自协方差函数为 $\\gamma(j) = \\mathbb{E}[e_t e_{t-j}]$。对于一个平稳过程，$\\mathbb{E}[e_{t-k} e_{t-i}] = \\gamma((t-i)-(t-k)) = \\gamma(k-i)$。方程变为：\n$$\n\\gamma(i) - \\sum_{k=1}^{m} a_k \\gamma(k-i) = 0 \\quad \\text{for } i \\in \\{1, 2, \\dots, m\\}\n$$\n由于平稳性，$\\gamma(j) = \\gamma(-j)$，因此可以写成 $\\gamma(k-i) = \\gamma(i-k)$。这就得到了 Yule-Walker 方程：\n$$\n\\sum_{k=1}^{m} a_k \\gamma(i-k) = \\gamma(i)\n$$\n这是关于 $m$ 个未知系数 $\\{a_k\\}_{k=1}^{m}$ 的 $m$ 个线性方程组。以矩阵形式表示，这是一个托普利兹 (Toeplitz) 系统 $\\boldsymbol{\\Gamma}_m \\mathbf{a} = \\boldsymbol{\\gamma}_m$，其中 $\\mathbf{a} = [a_1, \\dots, a_m]^\\top$，$\\boldsymbol{\\gamma}_m = [\\gamma(1), \\dots, \\gamma(m)]^\\top$，而 $\\boldsymbol{\\Gamma}_m$ 是一个 $m \\times m$ 的对称托普利兹自协方差矩阵，其元素为 $(\\boldsymbol{\\Gamma}_m)_{ij} = \\gamma(i-j)$：\n$$\n\\begin{pmatrix}\n\\gamma(0) & \\gamma(1) & \\cdots & \\gamma(m-1) \\\\\n\\gamma(1) & \\gamma(0) & \\cdots & \\gamma(m-2) \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n\\gamma(m-1) & \\gamma(m-2) & \\cdots & \\gamma(0)\n\\end{pmatrix}\n\\begin{pmatrix}\na_1 \\\\\na_2 \\\\\n\\vdots \\\\\na_m\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\gamma(1) \\\\\n\\gamma(2) \\\\\n\\vdots \\\\\n\\gamma(m)\n\\end{pmatrix}\n$$\n接下来，推导残差新息方差 $\\sigma_{\\varepsilon}^{2} = \\mathbb{E}[\\varepsilon_t^2]$。\n$$\n\\sigma_{\\varepsilon}^{2} = \\mathbb{E}[\\varepsilon_t \\cdot \\varepsilon_t] = \\mathbb{E}\\left[\\varepsilon_t \\left(e_t - \\sum_{k=1}^{m} a_k e_{t-k}\\right)\\right] = \\mathbb{E}[\\varepsilon_t e_t] - \\sum_{k=1}^{m} a_k \\mathbb{E}[\\varepsilon_t e_{t-k}]\n$$\n根据正交性原理，第二项为零。因此：\n$$\n\\sigma_{\\varepsilon}^{2} = \\mathbb{E}[\\varepsilon_t e_t] = \\mathbb{E}\\left[\\left(e_t - \\sum_{k=1}^{m} a_k e_{t-k}\\right) e_t\\right] = \\mathbb{E}[e_t^2] - \\sum_{k=1}^{m} a_k \\mathbb{E}[e_{t-k} e_t]\n$$\n这就给出了新息方差的最终表达式：\n$$\n\\sigma_{\\varepsilon}^{2} = \\gamma(0) - \\sum_{k=1}^{m} a_k \\gamma(k)\n$$\n\n第2部分：样本自相关和偏自相关的计算\n\n给定样本自协方差： $\\hat{\\gamma}(0) = 1.0000$, $\\hat{\\gamma}(1) = 0.5000$, $\\hat{\\gamma}(2) = 0.1000$, $\\hat{\\gamma}(3) = -0.0400$, $\\hat{\\gamma}(4) = -0.0440$。\n样本自相关 $\\hat{r}(k) = \\hat{\\gamma}(k)/\\hat{\\gamma}(0)$ 为：\n$$\n\\hat{r}(1) = \\frac{0.5000}{1.0000} = 0.5, \\quad \\hat{r}(2) = \\frac{0.1000}{1.0000} = 0.1, \\quad \\hat{r}(3) = \\frac{-0.0400}{1.0000} = -0.04, \\quad \\hat{r}(4) = \\frac{-0.0440}{1.0000} = -0.044\n$$\n样本偏自相关函数 (PACF) $\\{\\hat{\\alpha}(k)\\}$ 使用 Durbin-Levinson 递归计算。系数 $\\hat{\\alpha}(p)$ 是一个 $p$ 阶模型中的最后一个 AR 系数 $\\hat{a}_{p,p}$。\n以预测误差方差 $\\hat{v}_0 = \\hat{\\gamma}(0) = 1.0$ 初始化。\n\n对于阶数 $p=1$：\n$$\n\\hat{\\alpha}(1) = \\hat{a}_{1,1} = \\hat{r}(1) = 0.5\n$$\n$$\n\\hat{v}_1 = \\hat{v}_0(1 - \\hat{\\alpha}(1)^2) = 1.0(1 - 0.5^2) = 0.75\n$$\n\n对于阶数 $p=2$：\n$$\n\\hat{\\alpha}(2) = \\hat{a}_{2,2} = \\frac{\\hat{\\gamma}(2) - \\hat{a}_{1,1} \\hat{\\gamma}(1)}{\\hat{v}_1} = \\frac{0.1 - (0.5)(0.5)}{0.75} = \\frac{-0.15}{0.75} = -0.2\n$$\nAR(2) 系数为 $\\hat{a}_{2,1} = \\hat{a}_{1,1} - \\hat{\\alpha}(2)\\hat{a}_{1,1} = 0.5 - (-0.2)(0.5) = 0.6$ 和 $\\hat{a}_{2,2} = -0.2$。\n方差为 $\\hat{v}_2 = \\hat{v}_1(1 - \\hat{\\alpha}(2)^2) = 0.75(1 - (-0.2)^2) = 0.75(0.96) = 0.72$。\n\n对于阶数 $p=3$：\nAR(2) 模型的系数为 $\\{\\hat{a}_{2,1}, \\hat{a}_{2,2}\\} = \\{0.6, -0.2\\}$。\n$$\n\\hat{\\alpha}(3) = \\hat{a}_{3,3} = \\frac{\\hat{\\gamma}(3) - (\\hat{a}_{2,1}\\hat{\\gamma}(2) + \\hat{a}_{2,2}\\hat{\\gamma}(1))}{\\hat{v}_2} = \\frac{-0.04 - (0.6(0.1) + (-0.2)(0.5))}{0.72} = \\frac{-0.04 - (0.06 - 0.1)}{0.72} = \\frac{0}{0.72} = 0\n$$\n\n对于阶数 $p=4$：\n由于 $\\hat{\\alpha}(3)=0$，AR(3) 系数为 $\\{\\hat{a}_{3,1}, \\hat{a}_{3,2}, \\hat{a}_{3,3}\\} = \\{0.6, -0.2, 0\\}$ 且 $\\hat{v}_3 = \\hat{v}_2(1 - 0^2) = 0.72$。\n$$\n\\hat{\\alpha}(4) = \\hat{a}_{4,4} = \\frac{\\hat{\\gamma}(4) - (\\hat{a}_{3,1}\\hat{\\gamma}(3) + \\hat{a}_{3,2}\\hat{\\gamma}(2) + \\hat{a}_{3,3}\\hat{\\gamma}(1))}{\\hat{v}_3} = \\frac{-0.044 - (0.6(-0.04) + (-0.2)(0.1) + 0(0.5))}{0.72} = \\frac{-0.044 - (-0.024 - 0.02)}{0.72} = \\frac{0}{0.72} = 0\n$$\n计算出的滞后阶数至 4 的样本 PACF 值为 $\\{\\hat{\\alpha}(1), \\hat{\\alpha}(2), \\hat{\\alpha}(3), \\hat{\\alpha}(4)\\} = \\{0.5, -0.2, 0, 0\\}$。\n\n第3部分：模型阶数选择\n\n我们检验滞后 $k=1, 2, 3, 4$ 的原假设 $H_0: \\alpha(k) = 0$。对于一个真实阶数为 $m$ 的 AR 过程，当 $k>m$ 时，样本 PACF 系数 $\\hat{\\alpha}(k)$ 近似服从均值为 $0$、方差为 $1/N$ 的正态分布。当 $N=400$ 时，标准差为 $1/\\sqrt{400} = 0.05$。\n在 $0.05$ 的显著性水平下，临界值为 $z_{0.025} \\approx 1.96$。统计显著性的阈值为 $1.96/\\sqrt{N} = 1.96 \\times 0.05 = 0.098$。\n我们将每个样本 PACF 系数的绝对值与此阈值进行比较：\n- 对于 $k=1$: $|\\hat{\\alpha}(1)| = |0.5| = 0.5$。由于 $0.5 > 0.098$，该系数在统计上是显著的。阶数 $m$ 至少为 $1$。\n- 对于 $k=2$: $|\\hat{\\alpha}(2)| = |-0.2| = 0.2$。由于 $0.2 > 0.098$，该系数在统计上是显著的。阶数 $m$ 至少为 $2$。\n- 对于 $k=3$: $|\\hat{\\alpha}(3)| = |0| = 0$。由于 $0 < 0.098$，该系数在统计上不显著。\n- 对于 $k=4$: $|\\hat{\\alpha}(4)| = |0| = 0$。由于 $0 < 0.098$，该系数在统计上不显著。\n\nPACF 被认为在最后一个显著滞后项之后“截尾”。在本例中，最后一个显著滞后项是 $k=2$。所有后续测试的滞后项（至多到 $4$）在统计上均不显著。这种行为是 $2$ 阶自回归过程的特征。因此，因欠拟合而估计出的缺失阶数为 $m=2$。", "answer": "$$\n\\boxed{2}\n$$", "id": "2884970"}, {"introduction": "除了不相关之外，许多统计推断程序的一个关键假设是模型的创新（以及因此的残差）是正态分布的。本次实践聚焦于 Jarque-Bera 检验，这是一个重要的工具，它结合了关于残差偏度和峰度的信息，来对正态性进行正式检验。[@problem_id:2885047] 执行此检验有助于确保与模型参数相关的置信区间和假设检验的有效性。", "problem": "您已使用参数模型辨识出一个线性时不变（LTI）离散时间系统。设单步预测残差为序列 $\\{\\varepsilon_{t}\\}_{t=1}^{n}$，该序列由一个大小为 $n$ 的验证数据集计算得出。并假设残差分析的标准假设成立，即在一个设定良好的、具有高斯新息的模型下，残差应为独立同分布且服从正态分布。您的目标是通过一个基于矩的综合检验来验证 $\\{\\varepsilon_{t}\\}$ 的正态性，该检验植根于正态性假设下样本偏度和峰度的渐近联合行为。\n\n对于给定的残差，观测到的样本大小为 $n=432$，观测到的样本偏度为 $\\hat{\\gamma}=\\frac{1}{4}$，观测到的样本峰度（非超额峰度）为 $\\hat{\\kappa}=\\frac{19}{6}$。请利用样本矩的基本定义以及在正态性假设下这些统计量的大样本行为，构建一个基于偏度和峰度联合贡献的、用于检验正态性的合适检验统计量，确定其渐近参考分布，为给定数据计算其值，并在显著性水平 $\\alpha=0.05$ 下做出决策。\n\n如果拒绝残差服从正态分布的原假设，则以编码 $d=1$ 报告决策，否则以 $d=0$ 报告。将您的最终答案表示为单行矩阵 $\\begin{pmatrix}\\text{JB} & d\\end{pmatrix}$，其中 $\\text{JB}$ 是计算出的检验统计量，$d$ 是编码后的决策。不要四舍五入；以精确值表示结果，不带单位。", "solution": "问题陈述已经过验证，被认为是科学上可靠、提法恰当且完整的。它提出了一个应用于信号处理中模型验证的统计假设检验的标准问题。我们将着手进行解答。\n\n该问题要求我们对模型残差序列 $\\{\\varepsilon_{t}\\}_{t=1}^{n}$ 进行正态性检验，使用的是关于样本偏度和峰度的联合检验。这被称为 Jarque-Bera 检验。原假设 $H_0$ 是残差来自一个正态分布。对于正态分布，其总体偏度 $\\gamma$ 为 $0$，总体峰度 $\\kappa$ 为 $3$。\n\nJarque-Bera 检验统计量（此处记为 $JB$）是基于样本偏度 $\\hat{\\gamma}$ 和样本超额峰度 $\\hat{\\kappa}-3$ 的大样本性质构建的。在正态性的原假设下，对于大样本量 $n$，样本统计量具有以下渐近分布：\n$$ \\sqrt{n} \\hat{\\gamma} \\xrightarrow{d} N(0, 6) $$\n$$ \\sqrt{n} (\\hat{\\kappa}-3) \\xrightarrow{d} N(0, 24) $$\n其中 $\\xrightarrow{d}$ 表示依分布收敛。此外，这两个统计量是渐近独立的。\n\n根据这些性质，我们可以构建两个渐近服从标准正态分布 $N(0,1)$ 的标准化变量：\n$$ Z_{\\gamma} = \\frac{\\hat{\\gamma}}{\\sqrt{6/n}} = \\sqrt{\\frac{n}{6}}\\hat{\\gamma} $$\n$$ Z_{\\kappa} = \\frac{\\hat{\\kappa}-3}{\\sqrt{24/n}} = \\sqrt{\\frac{n}{24}}(\\hat{\\kappa}-3) $$\nJarque-Bera 统计量是这两个独立标准正态变量的平方和。$k$ 个独立标准正态变量的平方和服从自由度为 $k$ 的卡方分布 $\\chi^2(k)$。因此，$JB$ 统计量由下式给出：\n$$ JB = Z_{\\gamma}^2 + Z_{\\kappa}^2 = \\frac{n}{6}\\hat{\\gamma}^2 + \\frac{n}{24}(\\hat{\\kappa}-3)^2 $$\n在 $H_0$ 下，该统计量渐近服从自由度为 $2$ 的卡方分布，$JB \\sim \\chi^2(2)$。\n\n问题提供了以下数据：\n- 样本大小: $n=432$\n- 样本偏度: $\\hat{\\gamma}=\\frac{1}{4}$\n- 样本峰度（非超额峰度）: $\\hat{\\kappa}=\\frac{19}{6}$\n\n我们首先计算 $JB$ 统计量的值。\n与偏度相关的第一项是：\n$$ \\frac{n}{6}\\hat{\\gamma}^2 = \\frac{432}{6} \\left(\\frac{1}{4}\\right)^2 = 72 \\times \\frac{1}{16} = \\frac{72}{16} = \\frac{9 \\times 8}{2 \\times 8} = \\frac{9}{2} $$\n与峰度相关的第二项需要样本超额峰度：\n$$ \\hat{\\kappa}-3 = \\frac{19}{6} - 3 = \\frac{19}{6} - \\frac{18}{6} = \\frac{1}{6} $$\n现在，我们计算 $JB$ 统计量的峰度项：\n$$ \\frac{n}{24}(\\hat{\\kappa}-3)^2 = \\frac{432}{24} \\left(\\frac{1}{6}\\right)^2 = 18 \\times \\frac{1}{36} = \\frac{18}{36} = \\frac{1}{2} $$\n将两项相加得到检验统计量的值：\n$$ JB = \\frac{9}{2} + \\frac{1}{2} = \\frac{10}{2} = 5 $$\n计算出的检验统计量值为 $JB=5$。\n\n接下来，我们必须在显著性水平 $\\alpha=0.05$ 下做出决策。如果计算出的 $JB$ 值大于来自 $\\chi^2(2)$ 分布的临界值（记为 $\\chi^2_{2, \\alpha}$），我们就拒绝原假设 $H_0$。临界值 $c$ 定义为 $P(X > c) = \\alpha$，其中 $X \\sim \\chi^2(2)$。\n自由度为 $2$ 的卡方分布的累积分布函数（CDF）为 $F(x) = 1 - \\exp(-x/2)$，其中 $x \\ge 0$。临界值 $c$ 满足 $F(c) = 1 - \\alpha$。\n$$ 1 - \\exp(-c/2) = 1 - 0.05 = 0.95 $$\n$$ \\exp(-c/2) = 0.05 = \\frac{1}{20} $$\n对两边取自然对数：\n$$ -\\frac{c}{2} = \\ln\\left(\\frac{1}{20}\\right) = -\\ln(20) $$\n$$ c = 2\\ln(20) $$\n拒绝规则是：如果 $JB > 2\\ln(20)$，则拒绝 $H_0$。我们必须将我们的检验统计量 $JB=5$ 与临界值 $c=2\\ln(20)$ 进行比较。这等价于比较 $\\frac{5}{2}$ 与 $\\ln(20)$。\n我们知道自然对数的底数 $e$ 满足 $2 < e < 3$。让我们为 $e^{5/2}$ 建立一个界：\n$$ e^{5/2} = e^2 \\cdot e^{1/2} = e^2 \\sqrt{e} $$\n因为 $e < 3$，我们有 $e^2 < 3^2=9$ 并且 $\\sqrt{e} < \\sqrt{3} < 2$。\n因此，$e^{5/2} < 9 \\times 2 = 18$。\n因为 $e^{5/2} < 18$ 且 $18 < 20$，我们有 $e^{5/2} < 20$。\n自然对数函数 $\\ln(x)$ 是严格递增的。将其应用于该不等式可得：\n$$ \\ln(e^{5/2}) < \\ln(20) $$\n$$ \\frac{5}{2} < \\ln(20) $$\n乘以 $2$：\n$$ 5 < 2\\ln(20) $$\n这表明我们的检验统计量 $JB=5$ 小于临界值 $c=2\\ln(20)$。\n因此，在 $\\alpha=0.05$ 的显著性水平上，我们未能拒绝原假设 $H_0$。数据没有提供足够的证据来断定残差是非正态的。\n根据问题的编码方式，决策为 $d=0$。\n\n最终答案是一个包含计算出的检验统计量 $JB$ 和决策代码 $d$ 的行矩阵。\n$$ \\begin{pmatrix} JB & d \\end{pmatrix} = \\begin{pmatrix} 5 & 0 \\end{pmatrix} $$", "answer": "$$ \\boxed{\\begin{pmatrix} 5 & 0 \\end{pmatrix}} $$", "id": "2885047"}, {"introduction": "在为非平稳数据建模时，一个常见的错误是过度差分，即对时间序列进行不必要的多次差分。这个理论练习旨在探究这种过度差分的后果，要求你推导出它对模型残差施加的确切结构。通过理解这种错误在时域（自相关）和频域（功率谱）中的特征，你将学会在检查诊断图时立即发现它。[@problem_id:2885077]", "problem": "一位工程师正在为一个标量离散时间过程验证一个时间序列模型。真实的数据生成机制是一个阶数为 $(0,1,0)$ 的自回归积分移动平均 (ARIMA) 过程，由基本差分方程 $(1 - B) x_t = w_t$ 定义，其中 $B$ 是后移算子，$w_t$ 是一个均值为零、方差为 $\\sigma^{2}$ 的白噪声过程。工程师不知道真实的差分阶数，拟合了一个不含确定性常数项的 ARIMA$(0,2,0)$ 模型，并计算了残差 $\\hat{e}_t$，其等于二次差分序列 $\\hat{e}_t = (1 - B)^{2} x_t$。\n\n从差分算子、白噪声、线性时不变滤波以及自协方差与功率谱密度之间的 Wiener–Khinchin 关系等基本定义出发，推导由这种过度差分设定所隐含的期望残差过程。具体而言：\n- 用 $w_t$ 表示 $\\hat{e}_t$，并确定相应的线性滤波器。\n- 以 $\\sigma^{2}$ 为参数，推导残差 $\\hat{e}_t$ 的自协方差函数 $\\gamma_{\\hat{e}}(k)$ 和功率谱密度 $S_{\\hat{e}}(\\omega)$ 的闭式表达式。\n- 解释在时域和频域中的期望残差模式，并提出能够检测过度差分的严谨诊断方法，包括在过度差分情况下，滞后 1 阶的残差自相关以及频谱在零频率附近的行为预计会如何表现。\n\n请提供残差功率谱密度 $S_{\\hat{e}}(\\omega)$ 作为 $\\omega \\in [-\\pi,\\pi]$ 和 $\\sigma^{2}$ 的函数的闭式表达式作为最终答案。不需要四舍五入，最终答案中不应包含任何单位。", "solution": "问题陈述已通过验证。\n\n提取的已知条件如下：\n- 真实数据生成过程：阶数为 $(0,1,0)$ 的自回归积分移动平均 (ARIMA) 过程。\n- 真实过程的差分方程：$(1 - B) x_t = w_t$。\n- $B$ 是后移算子，使得 $B x_t = x_{t-1}$。\n- $w_t$ 是一个均值为零、方差为 $\\sigma^{2}$ 的白噪声过程，因此 $E[w_t] = 0$，$E[w_t^2] = \\sigma^2$，且当 $t \\neq s$ 时 $E[w_t w_s] = 0$。\n- 拟合的模型为不含常数项的 ARIMA$(0,2,0)$。\n- 计算出的残差为 $\\hat{e}_t = (1 - B)^{2} x_t$。\n- 任务是推导残差过程 $\\hat{e}_t$ 的性质，包括其用 $w_t$ 表示的表达式、其自协方差函数 $\\gamma_{\\hat{e}}(k)$、其功率谱密度 $S_{\\hat{e}}(\\omega)$，以及相应的过度差分诊断检验。\n- 要求的最终答案是 $S_{\\hat{e}}(\\omega)$ 的闭式表达式。\n\n验证结论：\n该问题是有效的。它在科学上基于随机过程和时间序列分析的公认理论。所描述的情景——对一个积分过程进行过度差分——是模型识别中的一个标准且重要的主题。该问题定义明确、客观且自洽，为得到唯一且有意义的解提供了所有必要信息。它要求对基本原理进行严谨的应用。\n\n求解推导：\n\n首先，我们用底层的白噪声过程 $w_t$ 来表示残差过程 $\\hat{e}_t$。\n残差的定义如下：\n$$\n\\hat{e}_t = (1 - B)^{2} x_t\n$$\n我们可以通过对算子进行因式分解来重写此表达式：\n$$\n\\hat{e}_t = (1 - B) \\left[ (1 - B) x_t \\right]\n$$\n真实的数据生成过程由方程 $(1 - B) x_t = w_t$ 给出。将此代入 $\\hat{e}_t$ 的表达式中，我们得到：\n$$\n\\hat{e}_t = (1 - B) w_t\n$$\n展开此表达式，得到残差过程的显式形式：\n$$\n\\hat{e}_t = w_t - w_{t-1}\n$$\n这表明残差过程 $\\hat{e}_t$ 不是白噪声。相反，它是一个 1 阶的移动平均过程，即 MA($1$)。将输入白噪声 $w_t$ 转换为输出残差 $\\hat{e}_t$ 的线性时不变滤波器由后移算子的多项式 $H(B) = 1 - B$ 表示。\n\n其次，我们推导残差过程 $\\hat{e}_t$ 的自协方差函数 $\\gamma_{\\hat{e}}(k)$。滞后 $k$ 阶的自协方差定义为 $\\gamma_{\\hat{e}}(k) = E[\\hat{e}_t \\hat{e}_{t-k}]$。我们使用表达式 $\\hat{e}_t = w_t - w_{t-1}$。\n\n对于滞后 $k=0$，我们计算方差：\n$$\n\\gamma_{\\hat{e}}(0) = E[\\hat{e}_t^2] = E[(w_t - w_{t-1})^2] = E[w_t^2 - 2w_t w_{t-1} + w_{t-1}^2]\n$$\n根据期望的线性性质以及白噪声的性质（$E[w_t^2] = \\sigma^2$ 且当 $t \\neq s$ 时 $E[w_t w_s] = 0$）：\n$$\n\\gamma_{\\hat{e}}(0) = E[w_t^2] - 2E[w_t w_{t-1}] + E[w_{t-1}^2] = \\sigma^2 - 2(0) + \\sigma^2 = 2\\sigma^2\n$$\n\n对于滞后 $k=1$：\n$$\n\\gamma_{\\hat{e}}(1) = E[\\hat{e}_t \\hat{e}_{t-1}] = E[(w_t - w_{t-1})(w_{t-1} - w_{t-2})] = E[w_t w_{t-1} - w_t w_{t-2} - w_{t-1}^2 + w_{t-1} w_{t-2}]\n$$\n再次应用白噪声的性质：\n$$\n\\gamma_{\\hat{e}}(1) = E[w_t w_{t-1}] - E[w_t w_{t-2}] - E[w_{t-1}^2] + E[w_{t-1} w_{t-2}] = 0 - 0 - \\sigma^2 + 0 = -\\sigma^2\n$$\n由于自协方差函数的对称性，$\\gamma_{\\hat{e}}(-1) = \\gamma_{\\hat{e}}(1) = -\\sigma^2$。\n\n对于滞后 $|k| \\geq 2$：\n$$\n\\gamma_{\\hat{e}}(k) = E[\\hat{e}_t \\hat{e}_{t-k}] = E[(w_t - w_{t-1})(w_{t-k} - w_{t-k-1})]\n$$\n当 $|k| \\geq 2$ 时，第一个因子中的白噪声项的索引（$t$, $t-1$）与第二个因子中的索引（$t-k$, $t-k-1$）是不同的。因此，任何交叉项的期望均为零。\n$$\n\\gamma_{\\hat{e}}(k) = 0 \\quad \\text{for } |k| \\geq 2\n$$\n总之，残差过程的自协方差函数为：\n$$\n\\gamma_{\\hat{e}}(k) =\n\\begin{cases}\n2\\sigma^2 & k=0 \\\\\n-\\sigma^2 & |k|=1 \\\\\n0 & |k| \\ge 2\n\\end{cases}\n$$\n\n第三，我们推导残差的功率谱密度 (PSD) $S_{\\hat{e}}(\\omega)$。我们利用以下性质：对于一个过程 $y_t = H(B)w_t$，其中 $w_t$ 是 PSD 为 $S_w(\\omega)=\\sigma^2$ 的白噪声，则 $y_t$ 的 PSD 为 $S_y(\\omega) = |H(e^{-i\\omega})|^2 S_w(\\omega)$。\n此处，$\\hat{e}_t = (1-B)w_t$，所以滤波器是 $H(B) = 1 - B$。通过代入 $B = e^{-i\\omega}$ 来求得频率响应：\n$$\nH(e^{-i\\omega}) = 1 - e^{-i\\omega}\n$$\n频率响应的幅值平方为：\n$$\n|H(e^{-i\\omega})|^2 = |1 - e^{-i\\omega}|^2 = (1 - \\cos(\\omega))^2 + (\\sin(\\omega))^2 = 1 - 2\\cos(\\omega) + \\cos^2(\\omega) + \\sin^2(\\omega)\n$$\n使用恒等式 $\\cos^2(\\omega) + \\sin^2(\\omega) = 1$：\n$$\n|H(e^{-i\\omega})|^2 = 1 - 2\\cos(\\omega) + 1 = 2 - 2\\cos(\\omega) = 2(1 - \\cos(\\omega))\n$$\n输入白噪声 $w_t$ 的 PSD 是常数，$S_w(\\omega) = \\sigma^2$。因此，残差过程 $\\hat{e}_t$ 的 PSD 是：\n$$\nS_{\\hat{e}}(\\omega) = |H(e^{-i\\omega})|^2 S_w(\\omega) = 2\\sigma^2(1 - \\cos(\\omega))\n$$\n此表达式在频率区间 $\\omega \\in [-\\pi, \\pi]$ 上有效。\n\n最后，我们解释其诊断意义。一个正确设定的时间序列模型应产生与白噪声无法区分的残差。\n- **时域诊断**：白噪声的自协方差函数对于所有非零滞后均为零。我们推导出的 $\\hat{e}_t$ 的自协方差在滞后 $k=1$ 时不为零。残差的理论自相关函数 (ACF) 是：\n$$\n\\rho_{\\hat{e}}(k) = \\frac{\\gamma_{\\hat{e}}(k)}{\\gamma_{\\hat{e}}(0)}\n$$\n具体来说，对于滞后 1：\n$$\n\\rho_{\\hat{e}}(1) = \\frac{-\\sigma^2}{2\\sigma^2} = -0.5\n$$\n在模型诊断中，工程师会检查残差 $\\hat{e}_t$ 的样本 ACF。在这种过度差分的情况下，ACF 图将在滞后 1 处呈现一个单一、巨大且统计上显著的负向尖峰，其值接近 $-0.5$。所有大于 1 的滞后的 ACF 都将不显著。这是过度差分的典型特征。\n\n- **频域诊断**：白噪声的功率谱密度在所有频率上都是恒定的（平坦的），即 $S(\\omega) = \\sigma^2$。我们推导出的 $\\hat{e}_t$ 的 PSD 是 $S_{\\hat{e}}(\\omega) = 2\\sigma^2(1 - \\cos(\\omega))$。这个函数不是平坦的。关键地，让我们评估其在零频率处的频谱：\n$$\nS_{\\hat{e}}(0) = 2\\sigma^2(1 - \\cos(0)) = 2\\sigma^2(1 - 1) = 0\n$$\n差分算子 $(1-B)$ 充当一个高通滤波器，衰减低频分量。将其应用两次会导致在零频率附近的功率过度衰减，从而在 $\\omega=0$ 处产生一个“谱洞”或凹陷。在模型诊断中，工程师会计算残差的周期图或平滑谱估计。一个在原点处显示出向零显著下降的频谱是过度差分的明确迹象。", "answer": "$$\n\\boxed{2\\sigma^{2}(1 - \\cos(\\omega))}\n$$", "id": "2885077"}]}