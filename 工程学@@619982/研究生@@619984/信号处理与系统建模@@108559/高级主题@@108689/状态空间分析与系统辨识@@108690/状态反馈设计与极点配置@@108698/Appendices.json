{"hands_on_practices": [{"introduction": "本练习是状态反馈控制设计的基础。通过这项实践，你将掌握两项核心技能：使用状态反馈增益 $K$ 来配置闭环极点，从而改变系统动态响应；以及设计一个预滤波器 $N$ 以确保系统输出能够精确跟踪参考输入。这个练习将帮助你巩固状态空间控制器设计的基本流程和计算方法 [@problem_id:2907353]。", "problem": "考虑一个连续时间线性时不变 (LTI) 单输入单输出状态空间模型，其状态向量为 $\\mathbf{x}(t) \\in \\mathbb{R}^{2}$，输入为 $u(t) \\in \\mathbb{R}$，输出为 $y(t) \\in \\mathbb{R}$：\n$$\n\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t), \\quad y(t) = C \\mathbf{x}(t),\n$$\n其中\n$$\nA = \\begin{bmatrix} 0 & 1 \\\\ -1 & -1 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1 & 0 \\end{bmatrix}.\n$$\n设控制律的形式为\n$$\nu(t) = -K \\mathbf{x}(t) + N r(t),\n$$\n其中 $K \\in \\mathbb{R}^{1 \\times 2}$ 是一个状态反馈增益，$N \\in \\mathbb{R}$ 是一个标量预滤波器，$r(t)$ 是一个外部参考信号。闭环状态矩阵为 $A_{c} = A - B K$。\n\n从线性系统的基本原理出发，利用矩阵的特征多项式定义以及线性时不变系统在常数输入下的稳态平衡来：\n- 设计 $K = \\begin{bmatrix} k_{1} & k_{2} \\end{bmatrix}$，使得 $A_{c}$ 的闭环特征值被配置在共轭复数对 $\\{ -2 + j, -2 - j \\}$ 处。\n- 确定预滤波器 $N$，使其在给定控制律下，对于单位阶跃参考 $r(t) = 1$ 实现精确的单位稳态跟踪。\n\n将您的最终答案表示为单行矩阵 $\\begin{pmatrix} k_{1} & k_{2} & N \\end{pmatrix}$ 的形式，使用精确值（不进行四舍五入）。不包含任何单位。", "solution": "所述问题在科学上是合理的、提法恰当且完整的。它是在线性控制系统理论中的一个标准练习，具体涉及用于极点配置和参考跟踪的状态反馈控制器设计。该系统由一个状态空间模型描述，其中矩阵 $A$、$B$ 和 $C$ 已给定。系统的能控性是实现任意极点配置的必要条件。能控性矩阵为 $\\mathcal{C} = \\begin{bmatrix} B & AB \\end{bmatrix}$。\n给定 $A = \\begin{bmatrix} 0 & 1 \\\\ -1 & -1 \\end{bmatrix}$ 和 $B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$，我们计算 $AB = \\begin{bmatrix} 0 & 1 \\\\ -1 & -1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix}$。\n能控性矩阵为 $\\mathcal{C} = \\begin{bmatrix} 0 & 1 \\\\ 1 & -1 \\end{bmatrix}$。其行列式为 $\\det(\\mathcal{C}) = (0)(-1) - (1)(1) = -1 \\neq 0$。该系统是能控的，因此闭环极点可以任意配置。该问题是有效的，并且可以推导出解。\n\n解答按要求分为两部分：首先，设计用于极点配置的状态反馈增益 $K$；其次，确定用于稳态跟踪的预滤波器 $N$。\n\n第1部分：设计状态反馈增益 $K = \\begin{bmatrix} k_{1} & k_{2} \\end{bmatrix}$\n控制律为 $u(t) = -K \\mathbf{x}(t) + N r(t)$。闭环状态动态由下式给出：$\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B(-K \\mathbf{x}(t) + N r(t)) = (A-BK)\\mathbf{x}(t) + BNr(t)$。\n闭环状态矩阵为 $A_c = A - BK$。我们符号化地计算该矩阵：\n$$\nBK = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} k_1 & k_2 \\end{bmatrix} = \\begin{bmatrix} 0 & 0 \\\\ k_1 & k_2 \\end{bmatrix}\n$$\n$$\nA_c = A - BK = \\begin{bmatrix} 0 & 1 \\\\ -1 & -1 \\end{bmatrix} - \\begin{bmatrix} 0 & 0 \\\\ k_1 & k_2 \\end{bmatrix} = \\begin{bmatrix} 0 & 1 \\\\ -1-k_1 & -1-k_2 \\end{bmatrix}\n$$\n闭环系统的特征值是特征多项式 $p_{A_c}(\\lambda) = \\det(\\lambda I - A_c)$ 的根，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n$$\n\\lambda I - A_c = \\lambda \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} - \\begin{bmatrix} 0 & 1 \\\\ -1-k_1 & -1-k_2 \\end{bmatrix} = \\begin{bmatrix} \\lambda & -1 \\\\ 1+k_1 & \\lambda+1+k_2 \\end{bmatrix}\n$$\n特征多项式为：\n$$\np_{A_c}(\\lambda) = \\det(\\lambda I - A_c) = \\lambda(\\lambda+1+k_2) - (-1)(1+k_1) = \\lambda^2 + (1+k_2)\\lambda + (1+k_1)\n$$\n期望的闭环特征值被指定为 $\\{ -2 + j, -2 - j \\}$。期望的特征多项式 $p_{des}(\\lambda)$ 由这些根构成：\n$$\np_{des}(\\lambda) = (\\lambda - (-2+j))(\\lambda - (-2-j)) = ((\\lambda+2)-j)((\\lambda+2)+j)\n$$\n$$\np_{des}(\\lambda) = (\\lambda+2)^2 - j^2 = (\\lambda+2)^2 + 1 = \\lambda^2 + 4\\lambda + 4 + 1 = \\lambda^2 + 4\\lambda + 5\n$$\n为了将极点配置在期望的位置，实际的特征多项式必须与期望的特征多项式相同：$p_{A_c}(\\lambda) = p_{des}(\\lambda)$。我们令 $\\lambda$ 的同次幂系数相等：\n$$\n\\lambda^2 + (1+k_2)\\lambda + (1+k_1) = \\lambda^2 + 4\\lambda + 5\n$$\n比较 $\\lambda^1$ 的系数：\n$$\n1 + k_2 = 4 \\implies k_2 = 3\n$$\n比较 $\\lambda^0$ 的系数（常数项）：\n$$\n1 + k_1 = 5 \\implies k_1 = 4\n$$\n因此，所需的状态反馈增益为 $K = \\begin{bmatrix} 4 & 3 \\end{bmatrix}$。\n\n第2部分：确定预滤波器 $N$\n目标是对于单位阶跃参考实现单位稳态跟踪，这意味着当输入为 $r(t) = 1$（$t \\geq 0$）时，输出 $y(t)$ 必须在 $t \\to \\infty$ 时趋近于 $1$。该稳态值记为 $y_{ss}=1$。\n闭环系统动态为 $\\dot{\\mathbf{x}}(t) = A_c \\mathbf{x}(t) + BNr(t)$，输出为 $y(t) = C\\mathbf{x}(t)$。\n闭环特征值具有负实部（$-2$），因此闭环系统是稳定的。对于一个恒定的参考输入 $r(t)=1$，状态向量 $\\mathbf{x}(t)$ 将收敛到一个恒定的稳态值 $\\mathbf{x}_{ss}$，此时其导数为零：$\\dot{\\mathbf{x}}_{ss} = \\mathbf{0}$。\n稳态平衡方程为：\n$$\n\\mathbf{0} = A_c \\mathbf{x}_{ss} + BN(1)\n$$\n这得到 $A_c \\mathbf{x}_{ss} = -BN$。由于 $A_c$ 的特征值非零，因此 $A_c$ 是可逆的。我们可以解出 $\\mathbf{x}_{ss}$：\n$$\n\\mathbf{x}_{ss} = -A_c^{-1}BN\n$$\n稳态输出 $y_{ss}$ 则由下式给出：\n$$\ny_{ss} = C \\mathbf{x}_{ss} = C (-A_c^{-1}BN) = -C A_c^{-1} B N\n$$\n我们要求 $y_{ss} = 1$。因此，我们必须从以下方程中解出 $N$：\n$$\n1 = -C A_c^{-1} B N\n$$\n首先，我们将 $k_1=4$ 和 $k_2=3$ 的值代入 $A_c$ 中：\n$$\nA_c = \\begin{bmatrix} 0 & 1 \\\\ -1-4 & -1-3 \\end{bmatrix} = \\begin{bmatrix} 0 & 1 \\\\ -5 & -4 \\end{bmatrix}\n$$\n$A_c$ 的逆矩阵是 $A_c^{-1} = \\frac{1}{\\det(A_c)}\\text{adj}(A_c)$。其行列式为 $\\det(A_c) = (0)(-4) - (1)(-5) = 5$。\n$$\nA_c^{-1} = \\frac{1}{5} \\begin{bmatrix} -4 & -1 \\\\ 5 & 0 \\end{bmatrix}\n$$\n现在我们计算标量 $C A_c^{-1} B$：\n$$\nC A_c^{-1} B = \\begin{bmatrix} 1 & 0 \\end{bmatrix} \\left( \\frac{1}{5} \\begin{bmatrix} -4 & -1 \\\\ 5 & 0 \\end{bmatrix} \\right) \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\n$$\n$$\nC A_c^{-1} B = \\frac{1}{5} \\begin{bmatrix} 1 & 0 \\end{bmatrix} \\begin{bmatrix} -4 & -1 \\\\ 5 & 0 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\frac{1}{5} \\begin{bmatrix} -4 & -1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\frac{1}{5}((-4)(0) + (-1)(1)) = -\\frac{1}{5}\n$$\n将此结果代入跟踪条件：\n$$\n1 = - \\left( -\\frac{1}{5} \\right) N = \\frac{1}{5}N\n$$\n解得 $N$：\n$$\nN = 5\n$$\n所需的增益和预滤波器值为 $k_1 = 4$，$k_2 = 3$ 和 $N = 5$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4 & 3 & 5\n\\end{pmatrix}\n}\n$$", "id": "2907353"}, {"introduction": "在掌握了基本的极点配置方法后，下一个关键问题是：如何设计一个“好”的控制器？本练习将引导你思考极点配置的鲁棒性问题。你将通过分析发现，将多个闭环极点放置在同一位置（即重根）可能会导致系统对模型参数的微小扰动异常敏感，这一现象与闭环矩阵的若尔当标准型结构密切相关。通过这个练习，你将学会如何在满足性能指标（如稳定时间）的同时，通过巧妙地分散极点来提升设计的鲁棒性 [@problem_id:2907415]。", "problem": "考虑一个具有全状态反馈的单输入线性时不变（LTI）状态空间系统，\n$$\\dot{x}(t) = A x(t) + b u(t), \\quad u(t) = -K x(t),$$\n其中\n$$A = \\begin{bmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -6 & -11 & -6 \\end{bmatrix}, \\quad b = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix},$$\n且反馈增益 $K \\in \\mathbb{R}^{1 \\times 3}$ 需要通过极点配置来设计。反馈闭环矩阵为 $A_{\\mathrm{cl}} = A - bK$，其特征值即为闭环极点。假设该被控对象存在范数有界的模型不确定性，因此实际实现的闭环矩阵为 $A_{\\mathrm{cl}} + \\Delta A,$ 其中扰动满足 $\\lVert \\Delta A \\rVert_{2} \\le \\varepsilon,$ 对于一个小的非零 $\\varepsilon > 0$。\n\n要求您选择一个极点配置目标，该目标能够减小闭环特征值对扰动 $\\Delta A$ 的敏感性，同时保持时域指标：阶跃响应为非振荡的（所有闭环极点均为实数），且 2% 调节时间不大于 $1\\,\\mathrm{s}$。您可以假设该系统是可控的，并且任何首一三次实系数特征多项式都可以通过适当选择 $K$ 来指派。\n\n下列哪组期望的闭环极点集是最合适的选择？\n\nA. $\\{-5,\\,-5,\\,-5\\}$\n\nB. $\\{-5-0.4,\\,-5,\\,-5+0.4\\}$\n\nC. $\\{-5,\\,-5 \\pm j\\,4\\}$\n\nD. $\\{-3,\\,-5,\\,-7\\}$\n\n请选择唯一的最佳选项，并从第一性原理出发论证您的选择，即根据特征多项式 $\\det(s I - A_{\\mathrm{cl}})$ 的定义、重根特征值对应的若尔当块结构，以及线性时不变系统中极点位置与主导时间常数之间的关系进行推理。请勿假设或引用任何不能从这些基础推导出的结果。解释为什么重根会增加敏感性，以及轻微的极点分离如何在不违反指标的情况下缓解此问题，并论证为何其他选项未能满足鲁棒性或性能指标要求。", "solution": "首先对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 系统模型：单输入线性时不变（LTI）状态空间系统 $\\dot{x}(t) = A x(t) + b u(t)$。\n- 状态反馈：$u(t) = -K x(t)$。\n- 系统矩阵：$A = \\begin{bmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -6 & -11 & -6 \\end{bmatrix}$, $b = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$。\n- 反馈增益：待设计的 $K \\in \\mathbb{R}^{1 \\times 3}$。\n- 闭环系统：$\\dot{x}(t) = (A - bK)x(t) = A_{\\mathrm{cl}}x(t)$。\n- 扰动模型：实际实现的闭环矩阵为 $A_{\\mathrm{cl}} + \\Delta A$，扰动边界为 $\\lVert \\Delta A \\rVert_{2} \\le \\varepsilon$，其中 $\\varepsilon > 0$ 为一个小数。\n- 设计目标：选择一个极点配置目标，以减小特征值对 $\\Delta A$ 的敏感性。\n- 性能指标1：阶跃响应必须是非振荡的。\n- 性能指标2：2% 调节时间 $T_s$ 不得大于 $1\\,\\mathrm{s}$。\n- 假设1：系统对 $(A, b)$ 是可控的。\n- 假设2：任何首一三次实系数特征多项式都可以被指派。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在控制理论领域，特别是在状态反馈设计和鲁棒性分析方面，是适定的。\n1.  **科学依据**：状态空间表示、极点配置、调节时间、非振荡响应以及特征值对矩阵扰动的敏感性等概念，是控制工程和线性代数中的基本原理。给定的 $A$ 矩阵是友矩阵形式（具体来说是可控标准型），这是一种标准表示法。\n2.  **适定性**：状态矩阵和输入矩阵定义了一个三阶单输入系统。可控性假设是极点配置问题的标准前提，并且可以被验证。可控性矩阵为 $$\\mathcal{C} = \\begin{bmatrix} b & Ab & A^2b \\end{bmatrix} = \\begin{bmatrix} 0 & 0 & 1 \\\\ 0 & 1 & -6 \\\\ 1 & -6 & 25 \\end{bmatrix}$$。其行列式为 $\\det(\\mathcal{C}) = -1 \\neq 0$，因此系统确实是可控的。由于系统可控，任意极点配置都是可能的，这验证了第二个假设。该问题要求基于一组清晰、定量和定性的标准，从选项中选出“最合适的”一个，这是一个标准的工程设计问题。\n3.  **客观性**：该问题使用了精确、客观的术语（`2% 调节时间`、`非振荡`、`范数有界不确定性`）。\n4.  **完整性**：该问题提供了评估所有选项所需的所有必要数据和约束。\n\n**步骤3：结论与行动**\n问题陈述在科学上是合理的、适定的、客观的且完整的。声明其**有效**。我们可以继续进行求解。\n\n**求解推导**\n\n求解过程要求选择一组期望的闭环极点，使其满足两项性能指标和一个鲁棒性目标。\n\n**1. 性能指标分析**\n\n- **非振荡响应**：对于线性时不变系统，振荡响应（包含正弦分量）源于具有非零虚部的极点。为确保纯粹的非振荡响应，所有闭环特征值（极点）$\\lambda_i$ 都必须是实数。\n\n- **调节时间**：2% 调节时间 $T_s$ 是指系统对阶跃输入的响应稳定到其终值的 2% 范围内所需的时间。对于一个极点为 $\\lambda_1, \\lambda_2, \\dots, \\lambda_n$ 的系统，其暂态响应是形如 $e^{\\lambda_i t}$（对于重根，则为 $t^k e^{\\lambda_i t}$）的项的线性组合。衰减速率由极点的实部决定。衰减最慢的模式对应于具有最大实部（即最靠近虚轴）的极点。这就是主导极点。令 $\\sigma_{\\min} = \\min_i |\\text{Re}(\\lambda_i)|$。对于主导极点，2% 调节时间近似为 $T_s \\approx \\frac{4}{\\sigma_{\\min}}$。指标 $T_s \\le 1\\,\\mathrm{s}$ 施加了约束 $\\frac{4}{\\sigma_{\\min}} \\le 1$，这意味着 $\\sigma_{\\min} \\ge 4$。由于为了保证稳定性，所有极点都必须位于左半平面，这意味着所有极点 $\\lambda_i$ 都必须满足 $\\text{Re}(\\lambda_i) \\le -4$。\n\n结合这两项指标，任何有效的极点集都必须只包含实数，并且所有实数都必须小于或等于 $-4$。\n\n**2. 鲁棒性目标分析**\n\n目标是减小闭环特征值对扰动 $\\Delta A$ 的敏感性。这种敏感性从根本上与闭环矩阵 $A_{\\mathrm{cl}}$ 的特征向量结构有关。\n\n- **情况1：不同特征值**：如果 $A_{\\mathrm{cl}}$ 具有不同的特征值，则它是可对角化的。它的特征向量构成 $\\mathbb{R}^3$ 的一个基。其特征值对扰动的敏感性与其特征向量矩阵的条件数有关。\n- **情况2：重复特征值**：如果 $A_{\\mathrm{cl}}$ 有重复的特征值，它可能可以也可能不可以对角化。如果一个特征值的几何重数（其特征空间的维数）小于其代数重数（它在特征多项式中的重复次数），则该矩阵被称为“亏损矩阵”，且不能被对角化。取而代之，其标准型是若尔当标准型，其中包含尺寸大于 $1$ 的若尔当块。与非平凡若尔当块相关的特征值对扰动极其敏感。对于一个具有尺寸为 $n$ 的若尔当块的矩阵，一个范数为 $\\varepsilon$ 的扰动可能导致其特征值发生量级为 $\\varepsilon^{1/n}$ 的偏移。对于 $n > 1$ 和小的 $\\varepsilon$，$\\varepsilon^{1/n} \\gg \\varepsilon$，这表明了极高的敏感性。\n\n让我们确定对于给定系统，重复的极点是否会导致亏损矩阵。闭环矩阵为 $A_{\\mathrm{cl}} = A - bK$。给定 $K = \\begin{bmatrix} k_1 & k_2 & k_3 \\end{bmatrix}$，我们有：\n$$A_{\\mathrm{cl}} = \\begin{bmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -6 & -11 & -6 \\end{bmatrix} - \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} k_1 & k_2 & k_3 \\end{bmatrix} = \\begin{bmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -6-k_1 & -11-k_2 & -6-k_3 \\end{bmatrix}$$\n这是一个友矩阵。其特征多项式为 $\\det(sI - A_{\\mathrm{cl}}) = s^3 + (6+k_3)s^2 + (11+k_2)s + (6+k_1)$。\n友矩阵是非减损的，这意味着它的每个特征值的几何重数总是 $1$。因此，如果我们选择一个具有重复特征值（代数重数 $>1$）的极点集，所得到的 $A_{\\mathrm{cl}}$ 矩阵必然是亏损的。对于位于 $s = \\lambda$ 的三重根，将存在一个与 $\\lambda$ 相关的单个 $3 \\times 3$ 若尔当块。这将导致 $\\varepsilon^{1/3}$ 量级的特征值敏感性，这是不希望看到的。\n\n为了实现鲁棒的极点配置，必须避免亏损的闭环矩阵。这意味着所有闭环极点都应该是互不相同的。\n\n**3. 选项评估**\n\n我们现在根据推导出的标准来评估每个选项。\n\n**A. $\\{-5,\\,-5,\\,-5\\}$**\n- **性能**：\n    - 非振荡：所有极点都是实数。满足此条件。\n    - 调节时间：所有极点都在 $-5$。主导极点的实部为 $-5$。$|\\text{Re}(\\lambda)| = 5 \\ge 4$。满足此条件。\n- **鲁棒性**：这个选择包含一个位于 $s=-5$ 的三重根。如上所述，这将迫使闭环矩阵 $A_{\\mathrm{cl}}$ 成为亏损的，带有一个 $3 \\times 3$ 的若尔当块。极点对扰动的敏感性将是 $\\varepsilon^{1/3}$ 量级。这是一个非常不鲁棒的设计。\n- **结论**：**错误**。虽然它满足性能指标，但在鲁棒性要求上灾难性地失败了。\n\n**B. $\\{-5-0.4,\\,-5,\\,-5+0.4\\} = \\{-5.4,\\, -5.0,\\, -4.6\\}$**\n- **性能**：\n    - 非振荡：所有极点都是实数。满足此条件。\n    - 调节时间：主导极点（最靠近虚轴）是 $s=-4.6$。实部为 $-4.6$。我们检验 $|\\text{Re}(\\lambda)| \\ge 4$，这是成立的，因为 $4.6 \\ge 4$。近似调节时间为 $T_s \\approx 4/4.6 \\approx 0.87\\,\\mathrm{s}$，小于 $1\\,\\mathrm{s}$。满足此条件。\n- **鲁棒性**：极点是互不相同的（$-5.4 \\neq -5.0 \\neq -4.6$）。这确保了得到的 $A_{\\mathrm{cl}}$ 矩阵是可对角化的，并且其特征值的敏感性量级为 $\\varepsilon$。通过将极点从 $\\{-5,-5,-5\\}$ 的配置中轻微分开，鲁棒性得到了极大的改善。\n- **结论**：**正确**。此选项通过选择互不相同、且均在左半平面足够深处的实数极点，同时满足了性能指标和鲁棒性目标。它代表了为增强鲁棒性而做出的标准工程折衷。\n\n**C. $\\{-5,\\,-5 \\pm j\\,4\\}$**\n- **性能**：\n    - 非振荡：该极点集包含一个复共轭对 $-5 \\pm j\\,4$。系统响应将是振荡的。这违反了第一项性能指标。\n- **结论**：**错误**。它未能满足一项关键的性能要求。\n\n**D. $\\{-3,\\,-5,\\,-7\\}$**\n- **性能**：\n    - 非振荡：所有极点都是实数。满足此条件。\n    - 调节时间：主导极点是 $s=-3$。实部 $\\text{Re}(\\lambda) = -3$。我们要求 $\\text{Re}(\\lambda) \\le -4$，但 $-3 > -4$，因此该条件未被满足。近似调节时间约为 $T_s \\approx 4/3 \\approx 1.33\\,\\mathrm{s}$，大于所允许的最大值 $1\\,\\mathrm{s}$。\n- **结论**：**错误**。它未能满足调节时间指标。\n\n**结论**\n选项B是唯一一个能同时满足非振荡响应、调节时间不超过 $1\\,\\mathrm{s}$ 以及鲁棒的特征值配置要求的选项。它通过配置互不相同的实数极点，且所有极点都位于 $s=-4$ 的左侧，从而避免了C和D的性能不达标以及A的鲁棒性不达标问题。", "answer": "$$\\boxed{B}$$", "id": "2907415"}, {"introduction": "经典的极点位置分析有时不足以完全揭示系统在面对不确定性时的真实表现。本练习将向你介绍一种更强大的鲁棒性分析工具——伪谱（pseudospectra）。你将通过编写代码，亲手实现一个完整的分析流程：首先进行极点配置设计，然后计算伪谱横坐标（pseudospectral abscissa）等指标，来量化评估闭环系统在存在扰动时的稳定裕度。这项计算实践将为你提供一个现代且深刻的视角，理解控制系统鲁棒性的真正含义 [@problem_id:2907358]。", "problem": "设计一个完整、可运行的程序，该程序使用伪谱鲁棒性指标，为一个连续时间、有限维、线性时不变系统计算并评估状态反馈。该被控对象由状态空间对 $A \\in \\mathbb{R}^{2 \\times 2}$ 和 $B \\in \\mathbb{R}^{2 \\times 1}$ 给出\n$$\nA = \\begin{bmatrix} 0 & 1 \\\\ -100 & -1 \\end{bmatrix}, \\qquad B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}.\n$$\n考虑静态状态反馈 $u = -K x$，$K \\in \\mathbb{R}^{1 \\times 2}$，使得闭环矩阵为 $A_{\\text{cl}} = A - B K$。\n\n对于每个测试用例，程序必须基于线性系统和伪谱分析的基本原理执行以下步骤：\n\n1. 通过极点配置进行状态反馈设计：给定一个期望的实数闭环极点列表 $p_1, p_2 \\in \\mathbb{R}$，计算反馈增益 $K$，使得 $A_{\\text{cl}}$ 的特征值为 $\\{p_1, p_2\\}$。\n\n2. 通过伪谱进行鲁棒性评估：\n   - 对于给定的矩阵 $M \\in \\mathbb{C}^{n \\times n}$ 和 $\\varepsilon \\ge 0$，$\\varepsilon$-伪谱定义为\n     $$\n     \\Lambda_{\\varepsilon}(M) = \\{ z \\in \\mathbb{C} : \\sigma_{\\min}(z I - M) \\le \\varepsilon \\},\n     $$\n     其中 $\\sigma_{\\min}(\\cdot)$ 表示最小奇异值，$I$ 是适当大小的单位矩阵。对于一个稳定的连续时间矩阵 $M$，其到不稳定性的距离为\n     $$\n     \\delta(M) = \\inf_{\\omega \\in \\mathbb{R}} \\sigma_{\\min}(j \\omega I - M).\n     $$\n     在水平 $\\varepsilon$ 上的伪谱横坐标为\n     $$\n     \\alpha_{\\varepsilon}(M) = \\sup\\{ \\operatorname{Re}(z) : z \\in \\Lambda_{\\varepsilon}(M) \\}.\n     $$\n   - 通过在一个对称实数区间上的均匀网格上对 $\\omega$ 进行采样，并计算 $\\min_{\\omega} \\sigma_{\\min}(j \\omega I - A_{\\text{cl}})$，来数值近似 $\\delta(A_{\\text{cl}})$。\n   - 通过在复平面上的一个均匀网格上扫描一个矩形区域，并在满足 $\\sigma_{\\min}(z I - A_{\\text{cl}}) \\le \\varepsilon$ 的点 $z$ 中取最大实部，来数值近似 $\\alpha_{\\varepsilon}(A_{\\text{cl}})$。\n\n使用以下全局数值规范以确保普适性和可复现性：\n- 到不稳定性的距离的虚轴采样：对 $\\omega \\in [-200, 200]$ 内的 $N_{\\omega} = 20001$ 个均匀间隔点，计算 $\\sigma_{\\min}(j \\omega I - A_{\\text{cl}})$。\n- 伪谱横坐标的采样区域与分辨率：\n  - 令 $\\{\\lambda_i\\}$ 表示 $A_{\\text{cl}}$ 的特征值。\n  - 设 $x_{\\min} = \\min_i \\operatorname{Re}(\\lambda_i) - 40$，$x_{\\max} = 10$，以及 $\\Omega = 200$。\n  - 在矩形区域 $\\{ x + j \\omega : x \\in [x_{\\min}, x_{\\max}], \\; \\omega \\in [-\\Omega, \\Omega] \\}$ 上构建一个网格，其中 $x$ 方向有 $N_x = 281$ 个均匀间隔点，$\\omega$ 方向有 $N_{\\omega}^{\\text{rect}} = 361$ 个均匀间隔点。\n  - 在此网格上，通过在满足 $\\sigma_{\\min}((x + j \\omega) I - A_{\\text{cl}}) \\le \\varepsilon$ 的网格点中取最大的 $x$ 值来近似 $\\alpha_{\\varepsilon}(A_{\\text{cl}})$。如果没有网格点满足该不等式，则数值上报告最大值为 $-\\infty$。\n\n测试套件：\n- 每个测试用例指定一组期望的实数极点和一对伪谱水平 $\\varepsilon$：\n  - 用例 1：期望极点 $[-5, -6]$，$\\varepsilon$ 水平 $[0.05, 0.10]$。\n  - 用例 2：期望极点 $[-20, -30]$，$\\varepsilon$ 水平 $[0.05, 0.20]$。\n  - 用例 3：期望极点 $[-0.2, -0.5]$，$\\varepsilon$ 水平 $[0.01, 0.05]$。\n\n对每个用例，程序必须：\n- 计算一个反馈增益 $K$，将闭环极点配置在指定位置。\n- 使用上述虚轴采样方法，计算 $\\delta(A_{\\text{cl}})$ 的数值近似值。\n- 使用上述矩形网格方法，计算两个 $\\varepsilon$ 水平下 $\\alpha_{\\varepsilon}(A_{\\text{cl}})$ 的数值近似值。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例贡献一个包含三个浮点数的子列表，顺序为 $[\\delta(A_{\\text{cl}}), \\alpha_{\\varepsilon_1}(A_{\\text{cl}}), \\alpha_{\\varepsilon_2}(A_{\\text{cl}})]$。\n- 具体来说，输出必须具有以下形式\n  $$\n  \\big[ [d_1, a_{1,1}, a_{1,2}], [d_2, a_{2,1}, a_{2,2}], [d_3, a_{3,1}, a_{3,2}] \\big],\n  $$\n  其中 $d_i$ 是表示到不稳定性距离的浮点数，$a_{i,j}$ 是表示在指定 $\\varepsilon$ 水平下伪谱横坐标的浮点数，顺序与上文列出的一致。\n- 不涉及物理单位。角度 $\\omega$（如果出现）按照连续时间傅里叶分析的惯例，单位是弧度/秒，但无需打印。所有数值答案必须打印为不带任何符号的原始十进制数。", "solution": "该问题是有效的，因为它科学地基于线性控制理论和数值分析的既定原理，是适定的，并且所有参数都已明确指定。我们将着手解决。\n\n任务是为一个线性时不变 (LTI) 系统设计一个状态反馈控制器，并随后使用伪谱指标评估其鲁棒性。该过程包括两个主要阶段：通过极点配置进行控制器综合和鲁棒性分析。\n\n首先，我们设计状态反馈增益 $K$。给定的被控对象由状态空间模型 $\\dot{x} = Ax + Bu$ 描述，其矩阵为\n$$\nA = \\begin{bmatrix} 0 & 1 \\\\ -100 & -1 \\end{bmatrix}, \\qquad B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}.\n$$\n该系统为二阶（$n=2$），具有单个输入（$m=1$）。控制律是静态状态反馈 $u = -Kx$，其中 $K \\in \\mathbb{R}^{1 \\times 2}$。闭环系统动力学由 $\\dot{x} = (A - BK)x = A_{\\text{cl}}x$ 给出。\n\n为了能够进行任意极点配置，系统对 $(A, B)$ 必须是能控的。该系统的能控性矩阵为\n$$\n\\mathcal{C} = \\begin{bmatrix} B & AB \\end{bmatrix} = \\begin{bmatrix} 0 & 1 \\\\ 1 & -1 \\end{bmatrix}.\n$$\n其行列式为 $\\det(\\mathcal{C}) = -1 \\ne 0$，因此该矩阵满秩（秩为2）。所以该系统是能控的，我们可以将闭环特征值配置在复平面上的任何期望位置 $\\{p_1, p_2\\}$（如果为复数，则需成共轭对）。本问题指定的是实数极点。\n\n令反馈增益为 $K = \\begin{bmatrix} k_1 & k_2 \\end{bmatrix}$。闭环矩阵 $A_{\\text{cl}}$ 为\n$$\nA_{\\text{cl}} = A - BK = \\begin{bmatrix} 0 & 1 \\\\ -100 & -1 \\end{bmatrix} - \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} k_1 & k_2 \\end{bmatrix} = \\begin{bmatrix} 0 & 1 \\\\ -100 - k_1 & -1 - k_2 \\end{bmatrix}.\n$$\n$A_{\\text{cl}}$ 的特征多项式是 $\\chi_{A_{\\text{cl}}}(\\lambda) = \\det(\\lambda I - A_{\\text{cl}})$，其计算结果为：\n$$\n\\chi_{A_{\\text{cl}}}(\\lambda) = \\lambda^2 + (1 + k_2)\\lambda + (100 + k_1).\n$$\n对应于极点 $p_1$ 和 $p_2$ 的期望特征多项式是\n$$\n\\chi_{\\text{des}}(\\lambda) = (\\lambda - p_1)(\\lambda - p_2) = \\lambda^2 - (p_1 + p_2)\\lambda + p_1p_2.\n$$\n通过令 $\\chi_{A_{\\text{cl}}}(\\lambda)$ 和 $\\chi_{\\text{des}}(\\lambda)$ 的系数相等，我们得到增益 $k_1$ 和 $k_2$：\n$$\n1 + k_2 = -(p_1 + p_2) \\implies k_2 = -1 - p_1 - p_2\n$$\n$$\n100 + k_1 = p_1 p_2 \\implies k_1 = p_1 p_2 - 100\n$$\n因此，反馈增益由期望极点唯一确定：$K = \\begin{bmatrix} p_1 p_2 - 100 & -1 - p_1 - p_2 \\end{bmatrix}$。\n\n其次，我们评估所得闭环系统的鲁棒性。虽然 $A_{\\text{cl}}$ 的特征值决定了稳定性，但它们可能对扰动高度敏感，特别是当 $A_{\\text{cl}}$ 是非正规矩阵时（即 $A_{\\text{cl}}A_{\\text{cl}}^T \\neq A_{\\text{cl}}^T A_{\\text{cl}}$）。伪谱为不确定性下的系统行为提供了一个更鲁棒的描述。\n\n$\\varepsilon$-伪谱 $\\Lambda_{\\varepsilon}(M)$ 是复数 $z$ 的集合，其中每个 $z$ 都是某个受扰矩阵 $M+E$ 的特征值，且扰动范数 $\\|E\\|_2 \\le \\varepsilon$。一个等价且在计算上更实用的定义如下：\n$$\n\\Lambda_{\\varepsilon}(M) = \\{ z \\in \\mathbb{C} : \\sigma_{\\min}(z I - M) \\le \\varepsilon \\},\n$$\n其中 $\\sigma_{\\min}(\\cdot)$ 是最小奇异值。这个定义将伪谱与预解范数 $\\|(z I - M)^{-1}\\|_2 = 1/\\sigma_{\\min}(z I - M)$ 联系起来。\n\n我们计算从伪谱中派生出的两个关键鲁棒性指标：\n1. 到不稳定性的距离 $\\delta(A_{\\text{cl}})$ 是指（在 2-范数意义下）能将一个特征值移动到虚轴上从而使系统不稳定的最小扰动。对于一个稳定的连续时间系统，它定义为：\n$$\n\\delta(A_{\\text{cl}}) = \\inf_{\\omega \\in \\mathbb{R}} \\sigma_{\\min}(j \\omega I - A_{\\text{cl}}).\n$$\n我们通过在指定的频率区间 $\\omega \\in [-200, 200]$ 上使用 $N_{\\omega} = 20001$ 个点进行网格搜索来近似该值。在此网格上找到的最小 $\\sigma_{\\min}$ 值即为 $\\delta(A_{\\text{cl}})$ 的数值估计。\n\n2. 伪谱横坐标 $\\alpha_{\\varepsilon}(A_{\\text{cl}})$ 是 $\\varepsilon$-伪谱中任意点的最大实部：\n$$\n\\alpha_{\\varepsilon}(A_{\\text{cl}}) = \\sup\\{ \\operatorname{Re}(z) : z \\in \\Lambda_{\\varepsilon}(A_{\\text{cl}}) \\}.\n$$\n该指标量化了可能的最大瞬态增长率或受扰系统的最右侧特征值。对于一个稳定的矩阵 $A_{\\text{cl}}$，若 $\\alpha_{\\varepsilon}(A_{\\text{cl}})$ 为正，则意味着大小为 $\\varepsilon$ 的扰动可以使系统不稳定。我们通过将复平面中的一个矩形区域离散化来近似 $\\alpha_{\\varepsilon}(A_{\\text{cl}})$。该区域由 $x \\in [\\min_i \\operatorname{Re}(\\lambda_i) - 40, 10]$ 和 $\\omega \\in [-200, 200]$ 定义，网格大小为 $N_x = 281$ 和 $N_{\\omega}^{\\text{rect}} = 361$。对于每个网格点 $z = x + j\\omega$，我们计算 $\\sigma_{\\min}(z I - A_{\\text{cl}})$。$\\alpha_{\\varepsilon}(A_{\\text{cl}})$ 的近似值是在所有满足 $\\sigma_{\\min}(z I - A_{\\text{cl}}) \\le \\varepsilon$ 的网格点中最大的实部 $x$。如果没有找到这样的点，则该值取为 $-\\infty$。\n\n程序为提供的每个测试用例实现这些步骤。它首先计算增益 $K$，然后构成 $A_{\\text{cl}}$，接着为给定的 $\\varepsilon$ 水平计算 $\\delta(A_{\\text{cl}})$ 和 $\\alpha_{\\varepsilon}(A_{\\text{cl}})$ 的数值近似值。所有计算均按要求使用浮点运算执行。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import svdvals\n\ndef solve():\n    \"\"\"\n    Computes state feedback gains and evaluates pseudospectral robustness metrics\n    for a given LTI system and a set of test cases.\n    \"\"\"\n    # Define the system matrices as specified in the problem statement.\n    A = np.array([[0.0, 1.0], [-100.0, -1.0]])\n    B = np.array([[0.0], [1.0]])\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'poles': [-5.0, -6.0], 'epsilons': [0.05, 0.10]},\n        {'poles': [-20.0, -30.0], 'epsilons': [0.05, 0.20]},\n        {'poles': [-0.2, -0.5], 'epsilons': [0.01, 0.05]},\n    ]\n    \n    # Global numerical specifications\n    # For distance to instability\n    omega_range_dist = [-200.0, 200.0]\n    N_omega_dist = 20001\n    \n    # For pseudospectral abscissa\n    x_max = 10.0\n    x_min_offset = -40.0\n    omega_range_rect = [-200.0, 200.0]\n    Nx_rect = 281\n    N_omega_rect = 361\n\n    # List to store formatted results for each case.\n    results = []\n    \n    identity = np.eye(2)\n\n    for case in test_cases:\n        poles = case['poles']\n        epsilons = case['epsilons']\n        \n        # 1. State feedback design via pole placement\n        p1, p2 = poles\n        k1 = p1 * p2 - 100.0\n        k2 = -1.0 - (p1 + p2)\n        K = np.array([[k1, k2]])\n        \n        A_cl = A - B @ K\n        \n        # 2. Robustness assessment\n        \n        # 2a. Approximate the distance to instability\n        omega_grid_dist = np.linspace(omega_range_dist[0], omega_range_dist[1], N_omega_dist)\n        \n        min_sv = np.inf\n        for omega in omega_grid_dist:\n            M = (1j * omega) * identity - A_cl\n            # svdvals returns singular values in descending order; smallest is last.\n            s_min = svdvals(M)[-1]\n            if s_min < min_sv:\n                min_sv = s_min\n        \n        dist_instability = min_sv\n        \n        # 2b. Approximate the pseudospectral abscissa for each epsilon\n        alpha_results = []\n        \n        # Since poles are real, Re(lambda) is just the pole value itself.\n        x_min = min(poles) + x_min_offset\n        \n        x_grid = np.linspace(x_min, x_max, Nx_rect)\n        omega_grid_rect = np.linspace(omega_range_rect[0], omega_range_rect[1], N_omega_rect)\n        \n        for eps in epsilons:\n            max_x = -np.inf\n            found_solution = False\n            # Iterate x from largest to smallest for efficiency.\n            # The first x for which a solution exists is the maximum.\n            for x in reversed(x_grid):\n                for omega in omega_grid_rect:\n                    z = x + 1j * omega\n                    M = z * identity - A_cl\n                    s_min = svdvals(M)[-1]\n                    \n                    if s_min <= eps:\n                        max_x = x\n                        found_solution = True\n                        break  # Found omega for this x, break inner loop.\n                if found_solution:\n                    break # Found the largest x, break outer loop.\n\n            alpha_results.append(max_x)\n\n        case_results = [dist_instability] + alpha_results\n        \n        # Format the sublist of results for this case as a string without spaces\n        results.append(f\"[{','.join(map(str, case_results))}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2907358"}]}