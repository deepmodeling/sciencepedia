{"hands_on_practices": [{"introduction": "在系统辨识中，一个基本前提是输入信号必须足够“丰富”，以充分激发系统的动态特性——这一特性被称为持续激励（persistency of excitation）。如果输入信号缺乏足够的变化，那么无论收集多少数据，都无法唯一地确定系统的所有参数。本练习 [@problem_id:2880081] 通过一个具体的例子，要求你从第一性原理出发，定量分析为何单音正弦信号无法辨识一个阶数大于等于3的FIR模型，从而深刻理解持续激励条件的实际意义。", "problem": "考虑一个$m$阶的离散时间线性时不变有限冲激响应 (FIR) 模型，其输入输出关系为 $y[k] = \\sum_{\\ell=0}^{m-1} h_{\\ell} u[k-\\ell] + v[k]$，其中 $h_{\\ell}$ 是未知实系数，$u[k]$ 是已知输入，$v[k]$ 是与 $u[k]$ 不相关的加性零均值测量噪声。您采集了 $N$ 个连续样本 $\\{(u[k], y[k])\\}_{k=0}^{N-1}$，其中 $N \\geq m+1$。令回归量向量为 $x[k] \\triangleq [u[k], u[k-1], \\dots, u[k-m+1]]^{\\top} \\in \\mathbb{R}^{m}$，最小二乘法向矩阵为 $S_N \\triangleq \\sum_{k=m-1}^{N-1} x[k] x[k]^{\\top} \\in \\mathbb{R}^{m \\times m}$。$h = [h_0, \\dots, h_{m-1}]^{\\top}$ 的最小二乘估计量要求 $S_N$ 是可逆的，并且 $m$ 阶持续激励（在无噪声极限下）等价于 $S_N$ 是正定的。假设您使用单音正弦输入 $u[k] = A \\cos(\\omega k + \\phi)$ 来驱动该系统，其振幅 $A \\neq 0$ 非零，频率 $\\omega \\in (0, \\pi)$，相位 $\\phi \\in \\mathbb{R}$ 为任意值。假设 $m \\geq 3$，并在大样本意义下（即 $N \\to \\infty$）解释 $S_N$，使得在 $u[k]$ 的平稳性条件下，样本均值收敛于其期望。\n\n仅从上述设置、FIR 模型的线性特性、法向矩阵 $S_N$ 的定义以及三角和角恒等式出发，当输入 $u[k]$ 是指定的单音正弦波时，确定无法通过最小二乘法从 $\\{(u[k], y[k])\\}$ 中辨识的系数子空间的精确维度（作为 $m$ 的函数）。请用一个关于 $m$ 的单个闭式表达式来表示您的最终答案。不需要单位，也不需要四舍五入。", "solution": "问题要求当输入为单音正弦波时，对于一个 $m$ 阶有限冲激响应 (FIR) 模型，其系数向量 $h = [h_0, h_1, \\dots, h_{m-1}]^{\\top}$ 的不可辨识子空间的维度。FIR 模型由关系式 $y[k] = \\sum_{\\ell=0}^{m-1} h_{\\ell} u[k-\\ell] + v[k]$ 给出。\n\n如果一个系数向量 $h$ 对无噪声输出的贡献恒等于零，那么它就是不可辨识的。在这个条件下，不同的参数向量可以产生相同的输出，使得它们无法从输入输出数据中区分开来。数学上，这对应于所有向量 $h \\in \\mathbb{R}^{m}$ 的集合，对于所有时间 $k$，其回归量-参数乘积为零。这类向量 $h$ 的空间恰好是渐近最小二乘法向矩阵 $S = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{k} x[k]x[k]^{\\top}$ 的零空间，其中 $x[k]$ 是回归量向量。因此，我们的任务是找到这个零空间的维度。\n\n向量 $h$ 位于不可辨识子空间的条件是：\n$$\n\\sum_{\\ell=0}^{m-1} h_{\\ell} u[k-\\ell] = 0 \\quad \\text{对于所有 } k\n$$\n输入信号为 $u[k] = A \\cos(\\omega k + \\phi)$，其中振幅 $A$ 非零，频率 $\\omega \\in (0, \\pi)$，相位 $\\phi$ 是某个实常数。将此代入条件中，我们得到：\n$$\n\\sum_{\\ell=0}^{m-1} h_{\\ell} A \\cos(\\omega(k-\\ell) + \\phi) = 0\n$$\n由于 $A \\neq 0$，我们可以将其除掉：\n$$\n\\sum_{\\ell=0}^{m-1} h_{\\ell} \\cos(\\omega k - \\omega \\ell + \\phi) = 0\n$$\n我们应用三角和角恒等式 $\\cos(\\alpha - \\beta) = \\cos(\\alpha)\\cos(\\beta) + \\sin(\\alpha)\\sin(\\beta)$。令 $\\alpha = \\omega k + \\phi$ 和 $\\beta = \\omega \\ell$。方程变为：\n$$\n\\sum_{\\ell=0}^{m-1} h_{\\ell} \\left( \\cos(\\omega k + \\phi)\\cos(\\omega \\ell) + \\sin(\\omega k + \\phi)\\sin(\\omega \\ell) \\right) = 0\n$$\n我们可以通过提出与 $k$ 相关的项来重新整理求和：\n$$\n\\cos(\\omega k + \\phi) \\left( \\sum_{\\ell=0}^{m-1} h_{\\ell} \\cos(\\omega \\ell) \\right) + \\sin(\\omega k + \\phi) \\left( \\sum_{\\ell=0}^{m-1} h_{\\ell} \\sin(\\omega \\ell) \\right) = 0\n$$\n该方程必须对所有时间步 $k$ 都成立。对于 $\\omega \\in (0, \\pi)$，时间函数 $f_1(k) = \\cos(\\omega k + \\phi)$ 和 $f_2(k) = \\sin(\\omega k + \\phi)$ 是线性无关的。对于线性无关函数的线性组合，若其对自变量的所有值都为零，则这些函数的系数必须全部为零。这就对系数向量 $h = [h_0, h_1, \\dots, h_{m-1}]^{\\top}$ 产生了两个独立的线性约束：\n\n约束 1：\n$$\n\\sum_{\\ell=0}^{m-1} h_{\\ell} \\cos(\\omega \\ell) = 0\n$$\n约束 2：\n$$\n\\sum_{\\ell=0}^{m-1} h_{\\ell} \\sin(\\omega \\ell) = 0\n$$\n不可辨识子空间是这个关于 $m$ 个未知数 $\\{h_0, h_1, \\dots, h_{m-1}\\}$ 的二元线性方程组的解空间。为了找到这个解空间的维度，我们必须验证这两个约束确实是线性无关的。\n\n我们可以将这些约束写成向量形式。令 $c = [\\cos(0), \\cos(\\omega), \\dots, \\cos((m-1)\\omega)]^{\\top}$ 和 $s = [\\sin(0), \\sin(\\omega), \\dots, \\sin((m-1)\\omega)]^{\\top}$。方程组为：\n$$\nc^{\\top} h = 0\n$$\n$$\ns^{\\top} h = 0\n$$\n这两个约束的线性无关性等价于向量 $c$ 和 $s$ 的线性无关性。让我们假设 $c$ 和 $s$ 的一个线性组合是零向量：$\\alpha c + \\beta s = 0$，其中 $\\alpha, \\beta \\in \\mathbb{R}$ 是某些标量。\n\n将其按分量写出，对于索引为 $\\ell=0$ 的元素：\n$$\n\\alpha \\cos(0) + \\beta \\sin(0) = 0 \\implies \\alpha \\cdot 1 + \\beta \\cdot 0 = 0 \\implies \\alpha = 0\n$$\n当 $\\alpha=0$ 时，条件化简为 $\\beta s = 0$。向量 $s$ 是零向量当且仅当对于所有 $\\ell = 1, \\dots, m-1$，都有 $\\sin(\\omega \\ell) = 0$。这要求对于每一个这样的 $\\ell$，$\\omega \\ell$ 都必须是 $\\pi$ 的倍数。对于 $\\ell=1$，这意味着 $\\omega$ 必须是 $\\pi$ 的倍数。然而，问题明确规定 $\\omega \\in (0, \\pi)$，这明确排除了 $\\omega$ 是 $\\pi$ 的倍数的情况。因此，向量 $s$ 不是零向量。\n由于 $\\beta s = 0$ 且 $s \\neq 0$，必然有 $\\beta = 0$。\n唯一的解是 $\\alpha=0$ 和 $\\beta=0$，这证明了向量 $c$ 和 $s$ 是线性无关的。\n\n我们得到了一个包含 $m$ 个变量的，由两个线性无关的齐次方程组成的方程组。解空间（即不可辨识子空间）的维度由变量个数减去独立约束的个数给出。\n$$\n\\text{不可辨识子空间的维度} = m - 2\n$$\n这个结果对于 $m \\geq 2$ 成立。问题条件 $m \\geq 3$ 是该结果有效的一个特例。因此，从给定的正弦输入中，无法通过最小二乘法辨识的系数向量子空间的维度是 $m-2$。", "answer": "$$\n\\boxed{m-2}\n$$", "id": "2880081"}, {"introduction": "一旦满足了可辨识性条件，我们就可以着手估计模型参数。ARX模型是最基本也最广泛应用的结构之一，它将系统动态直接表示为线性回归形式，在这种理想情况下，普通最小二乘法（LS）能提供一致估计。本练习 [@problem_id:2880089] 将引导你推导基于LS估计的ARX模型单步向前预测器，并计算在理想（渐近）条件下的预测误差方差，以此来巩固对LS辨识核心机制及其最优性能的理解。", "problem": "考虑一个服从因果、首一的自回归带外源输入 (ARX) 结构的单输入单输出离散时间系统。设输出表示为 $y(t)$，输入表示为 $u(t)$，并假设真实系统为\n$$\nA(q^{-1})\\,y(t) \\;=\\; B(q^{-1})\\,u(t) \\;+\\; e(t),\n$$\n其中 $q^{-1}$ 是后向移位算子，$A(q^{-1}) \\equiv 1 + a_{1} q^{-1} + \\cdots + a_{n_{a}} q^{-n_{a}}$ 是一个首一多项式，$B(q^{-1}) \\equiv b_{1} q^{-1} + \\cdots + b_{n_{b}} q^{-n_{b}}$ 是一个严格真分多项式，而 $e(t)$ 是方差为 $\\sigma^{2}$ 的零均值白噪声，且对于所有 $\\tau \\le t-1$，它与 $\\{u(\\tau), y(\\tau)\\}$ 不相关。假设模型阶数 $n_{a}$ 和 $n_{b}$ 与真实系统匹配。\n\n设 $\\hat{\\theta}$ 是通过最小二乘 (LS) 法，从长度为 $N$ 的大数据集中得到的参数向量，其中使用了由截至时间 $t-1$ 的过去输出和输入构成的回归量。只使用以下基本事实：期望的线性性质、最小二乘最小化的正交性原理，以及 $e(t)$ 的独立性和白噪声性质。从上述 ARX 方程和这些事实出发，用 $\\hat{\\theta}$ 和过去的数据推导一步向前预测器 $\\hat{y}(t \\mid t-1)$。然后，在 $N$ 足够大以至于 $\\hat{\\theta}$ 依概率等于真实参数向量的渐近状态下，计算一步向前预测误差 $y(t) - \\hat{y}(t \\mid t-1)$ 的方差，结果表示为关于 $\\sigma^{2}$ 的符号表达式。\n\n在解题过程中提供预测器和预测误差方差的完整推导。最终答案只报告预测误差方差。不包含任何单位。无需四舍五入。", "solution": "该问题陈述在科学上是合理的、自洽的且适定的。它提出了系统辨识理论中一个标准但理想化的场景。我们将严格遵循所给出的定义和原则，推导所要求的量。\n\n系统由自回归带外源输入 (ARX) 模型描述：\n$$\nA(q^{-1})\\,y(t) \\;=\\; B(q^{-1})\\,u(t) \\;+\\; e(t)\n$$\n多项式 $A(q^{-1})$ 和 $B(q^{-1})$ 定义如下：\n$$\nA(q^{-1}) = 1 + a_{1} q^{-1} + \\cdots + a_{n_{a}} q^{-n_{a}}\n$$\n$$\nB(q^{-1}) = b_{1} q^{-1} + \\cdots + b_{n_{b}} q^{-n_{b}}\n$$\n将这些定义代入系统方程，并应用后向移位算子 $q^{-k}x(t) = x(t-k)$，我们得到：\n$$\n(1 + a_{1} q^{-1} + \\cdots + a_{n_{a}} q^{-n_{a}}) y(t) = (b_{1} q^{-1} + \\cdots + b_{n_{b}} q^{-n_{b}}) u(t) + e(t)\n$$\n$$\ny(t) + a_{1} y(t-1) + \\cdots + a_{n_{a}} y(t-n_{a}) = b_{1} u(t-1) + \\cdots + b_{n_{b}} u(t-n_{b}) + e(t)\n$$\n为将其形式化为线性回归问题，我们将 $y(t)$ 分离出来：\n$$\ny(t) = -a_{1} y(t-1) - \\cdots - a_{n_{a}} y(t-n_{a}) + b_{1} u(t-1) + \\cdots + b_{n_{b}} u(t-n_{b}) + e(t)\n$$\n该方程可以表示为典范形式 $y(t) = \\phi(t-1)^{T}\\theta_{0} + e(t)$，其中 $\\theta_{0}$ 是真实系统参数的向量，$\\phi(t-1)$ 是回归量向量。这些向量定义如下：\n$$\n\\theta_{0} = \\begin{pmatrix} a_{1} \\\\ \\vdots \\\\ a_{n_{a}} \\\\ b_{1} \\\\ \\vdots \\\\ b_{n_{b}} \\end{pmatrix}, \\quad \\phi(t-1) = \\begin{pmatrix} -y(t-1) \\\\ \\vdots \\\\ -y(t-n_{a}) \\\\ u(t-1) \\\\ \\vdots \\\\ u(t-n_{b}} \\end{pmatrix}\n$$\n回归量向量 $\\phi(t-1)$ 只包含在时间 $t-1$ 可获得的过去输出和输入的测量值。\n\n第一个任务是推导一步向前预测器 $\\hat{y}(t \\mid t-1)$。该预测器是使用通过最小二乘 (LS) 法获得的参数估计向量 $\\hat{\\theta}$ 构建的。预测器的结构反映了系统模型的确定性部分。因此，它由下式给出：\n$$\n\\hat{y}(t \\mid t-1) = \\phi(t-1)^{T} \\hat{\\theta}\n$$\n这个表达式用估计参数 $\\hat{\\theta}$ 和包含在 $\\phi(t-1)$ 中的过去数据定义了预测器，从而完成了推导的第一部分。\n\n第二个任务是计算一步向前预测误差 $\\varepsilon(t) = y(t) - \\hat{y}(t \\mid t-1)$ 的方差。\n我们代入 $y(t)$ 和 $\\hat{y}(t \\mid t-1)$ 的表达式：\n$$\n\\varepsilon(t) = (\\phi(t-1)^{T}\\theta_{0} + e(t)) - (\\phi(t-1)^{T}\\hat{\\theta})\n$$\n根据线性性质，我们可以重排该表达式：\n$$\n\\varepsilon(t) = \\phi(t-1)^{T}(\\theta_{0} - \\hat{\\theta}) + e(t)\n$$\n问题指明我们必须在数据点数量 $N$ 足够大的渐近状态下进行操作。在此极限下，最小二乘估计 $\\hat{\\theta}$ 是一致的，意味着它依概率收敛到真实参数向量 $\\theta_{0}$。这种一致性的根本原因是作为 LS 方法基础的正交性原理，该原理迫使残差与数据样本上的回归量不相关；当 $N \\to \\infty$ 时，这种样本性质确保 $\\hat{\\theta}$ 收敛到真实的 $\\theta_{0}$，对于真实的 $\\theta_{0}$，噪声 $e(t)$ 同样与回归量不相关。\n遵循问题的指示，我们在 $\\hat{\\theta}$ 可被认为等于 $\\theta_{0}$ 的条件下分析该系统。因此，代表参数估计误差的项消失了：\n$$\n\\theta_{0} - \\hat{\\theta} = \\mathbf{0}\n$$\n因此，预测误差简化为内在的过程噪声：\n$$\n\\varepsilon(t) = e(t)\n$$\n我们需要求这个预测误差的方差。使用方差的定义：\n$$\n\\mathrm{Var}(\\varepsilon(t)) = \\mathrm{Var}(e(t)) = E[(e(t) - E[e(t)])^2]\n$$\n问题陈述 $e(t)$ 是一个零均值白噪声过程。因此，其期望值为零：\n$$\nE[e(t)] = 0\n$$\n将此代入方差公式，我们发现方差就是均方值：\n$$\n\\mathrm{Var}(e(t)) = E[e(t)^2]\n$$\n问题还指明了噪声 $e(t)$ 的方差是 $\\sigma^{2}$。\n因此，我们得出结论，一步向前预测误差的方差为：\n$$\n\\mathrm{Var}(\\varepsilon(t)) = \\sigma^{2}\n$$\n这个结果表明，在参数不确定性可以忽略不计的渐近情况下，预测误差纯粹是由不可预测的创新分量 $e(t)$ 引起的，且其方差等于该分量的方差。", "answer": "$$\n\\boxed{\\sigma^{2}}\n$$", "id": "2880089"}, {"introduction": "在实际应用中，过程噪声往往不是白噪声，这使得ARX模型的假设不再成立。ARMAX模型通过引入一个有色的噪声项 $C(q)$ 来描述这种情况，但也导致了标准最小二乘法的估计是有偏的。本练习 [@problem_id:2880109] 将带你探索一种强大的技术——数据预滤波——通过设计一个滤波器来“白化”噪声，从而将问题转化回标准LS可以求解的形式，最终获得一致的参数估计。", "problem": "考虑一个单输入单输出、离散时间的带外源输入的自回归移动平均 (ARMAX) 模型，该模型由一个零均值、独立同分布的高斯序列驱动，\n$$A(q) \\, y(t) \\;=\\; q^{-n_k} B(q) \\, u(t) \\;+\\; C(q) \\, e(t),$$\n其中 $q^{-1}$ 是单位延迟移位算子，$A(q) = 1 + a_{1} q^{-1} + \\cdots + a_{n_{a}} q^{-n_{a}}$，$B(q) = b_{0} + b_{1} q^{-1} + \\cdots + b_{n_{b}} q^{-n_{b}}$，$C(q) = 1 + c_{1} q^{-1} + \\cdots + c_{n_{c}} q^{-n_{c}}$ 是已知的、首一的、稳定的和最小相位的多项式，$n_k \\in \\mathbb{N}$ 是已知的输入延迟，输入 $u(t)$ 独立于 $e(t)$ 并且是足够高阶的持续激励，数据 $\\{u(t),y(t)\\}$ 由一个稳定的、时不变的系统生成，使得最小二乘估计一致性的标准正则性条件（有界矩、遍历性和可辨识性）成立。目标是通过对一个线性回归模型使用普通最小二乘法来估计对象参数向量 $\\theta_{p} = \\begin{pmatrix} a_{1}  \\cdots  a_{n_{a}}  b_{0}  \\cdots  b_{n_{b}} \\end{pmatrix}^{\\top}$。\n\n从第一性原理出发，推导一个因果、稳定、线性时不变的预滤波器 $L(q)$，该预滤波器仅用 $C(q)$ 显式表示，并可由已知的 $C(q)$ 实现，使得当 $L(q)$ 应用于 ARMAX 方程的两边时，得到的线性回归\n$$y_{L}(t) \\;=\\; \\varphi_{L}(t)^{\\top} \\theta_{p} \\;+\\; \\varepsilon_{L}(t)$$\n具有一个与回归量 $\\varphi_{L}(t)$ 不相关的零均值白噪声扰动 $\\varepsilon_{L}(t)$，从而在所述假设下得到一个一致的普通最小二乘估计 $\\theta_{p}$。你的推导必须从模型定义和所述假设开始，并且必须证明为什么在预滤波后扰动会变成白噪声以及为什么它与回归量不相关。\n\n最终答案必须是预滤波器 $L(q)$ 关于 $C(q)$ 的解析表达式。不要提供任何中间表达式或多个表达式作为最终答案；只给出单一算子 $L(q)$ 的闭式解析表达式。本问题无需进行数值取整。", "solution": "对问题陈述进行验证。\n\n步骤1：提取已知条件。\n系统是一个单输入单输出、离散时间的 ARMAX 模型：\n$$A(q) \\, y(t) \\;=\\; q^{-n_k} B(q) \\, u(t) \\;+\\; C(q) \\, e(t)$$\n其中：\n- $q^{-1}$ 是单位延迟移位算子。\n- $A(q) = 1 + a_{1} q^{-1} + \\cdots + a_{n_{a}} q^{-n_{a}}$。\n- $B(q) = b_{0} + b_{1} q^{-1} + \\cdots + b_{n_{b}} q^{-n_{b}}$。\n- $C(q) = 1 + c_{1} q^{-1} + \\cdots + c_{n_{c}} q^{-n_{c}}$。\n- $C(q)$ 被指定为已知、首一、稳定和最小相位的。\n- $e(t)$ 是一个零均值、独立同分布 (i.i.d.) 的高斯序列（白噪声）。\n- $u(t)$ 是输入，独立于 $e(t)$，并且是持续激励的。\n- $n_k \\in \\mathbb{N}$ 是已知的输入延迟。\n- 生成数据 $\\{u(t),y(t)\\}$ 的系统是稳定且时不变的。\n- 假设最小二乘估计一致性的标准正则性条件成立。\n- 目标是估计对象参数向量 $\\theta_{p} = \\begin{pmatrix} a_{1}  \\cdots  a_{n_{a}}  b_{0}  \\cdots  b_{n_{b}} \\end{pmatrix}^{\\top}$。\n- 方法是推导一个使用已知 $C(q)$ 的因果、稳定、线性时不变 (LTI) 预滤波器 $L(q)$，它将模型转换为线性回归 $y_{L}(t) = \\varphi_{L}(t)^{\\top} \\theta_{p} + \\varepsilon_{L}(t)$，其中扰动 $\\varepsilon_{L}(t)$ 是白色的、零均值的，并且与回归量 $\\varphi_{L}(t)$ 不相关，从而确保了普通最小二乘 (OLS) 估计的一致性。\n\n步骤2：使用提取的已知条件进行验证。\n- **科学依据**：该问题是系统辨识领域的一个基本且经典的问题，而系统辨识是信号处理和控制理论的一个子学科。ARMAX 模型、为获得一致估计而进行的预滤波概念，以及 OLS 一致性的条件，都是标准的、已被广泛认可的理论构造。该问题在科学上是合理的。\n- **适定性**：该问题是适定的。它要求基于一组给定的条件推导一个具有特定属性的预滤波器。所提供的信息，特别是 $C(q)$ 是已知的、稳定的和最小相位的，正是唯一确定这样一个滤波器所必需的。\n- **客观性**：该问题以精确、形式化和客观的数学语言陈述，没有任何主观性或模糊性。\n- **完整性与一致性**：该问题是自洽的，没有矛盾。这些假设（例如 $C(q)$ 的稳定性，$u(t)$ 和 $e(t)$ 的独立性）是标准的，并且对于理论推导是必要的。\n\n步骤3：结论与行动。\n问题被判定为有效。现在从第一性原理出发推导完整解。\n\n出发点是 ARMAX 模型方程：\n$$A(q) \\, y(t) = q^{-n_k} B(q) \\, u(t) + C(q) \\, e(t)$$\n我们的目标是估计包含在向量 $\\theta_{p}$ 中的 $A(q)$ 和 $B(q)$ 的参数。我们可以重写该模型，使其类似于一个标准的线性回归形式。利用 $A(q) = 1 + (A(q) - 1)$，我们有：\n$$y(t) + (A(q) - 1)y(t) = q^{-n_k} B(q) u(t) + C(q) e(t)$$\n分离出 $y(t)$ 可得：\n$$y(t) = -(A(q) - 1)y(t) + q^{-n_k} B(q) u(t) + C(q) e(t)$$\n这个方程具有线性回归的结构，可以表示为：\n$$y(t) = \\varphi(t)^{\\top} \\theta_{p} + v(t)$$\n其中回归量向量 $\\varphi(t)$ 和参数向量 $\\theta_p$ 由下式给出：\n$$\\varphi(t)^{\\top} = \\begin{pmatrix} -y(t-1)  \\cdots  -y(t-n_a)  u(t-n_k)  \\cdots  u(t-n_k-n_b) \\end{pmatrix}$$\n$$\\theta_{p} = \\begin{pmatrix} a_{1}  \\cdots  a_{n_{a}}  b_{0}  \\cdots  b_{n_{b}} \\end{pmatrix}^{\\top}$$\n方程误差，或称扰动，是：\n$$v(t) = C(q) e(t) = (1 + c_{1} q^{-1} + \\cdots + c_{n_{c}} q^{-n_{c}}) e(t) = e(t) + c_{1} e(t-1) + \\cdots + c_{n_{c}} e(t-n_{c})$$\n要使 $\\theta_p$ 的普通最小二乘 (OLS) 估计量具有一致性，一个必要条件是扰动 $v(t)$ 必须与回归量向量 $\\varphi(t)$ 不相关，即 $E[\\varphi(t) v(t)] = \\mathbf{0}$。\n\n我们来检验这个条件。扰动 $v(t)$ 是白噪声序列 $e(t)$ 的一个移动平均。由于 $C(q)$（在一般情况下）不等于 $1$，所以 $v(t)$ 是一个有色噪声序列。回归量 $\\varphi(t)$ 包含输出的过去值，$y(t-k)$ 其中 $k \\ge 1$。输出 $y(t)$ 是所有过去输入 $u(s)$ 和噪声 $e(s)$（其中 $s \\le t$）的函数。因此，像 $y(t-1)$ 这样的回归量分量依赖于 $e(t-1), e(t-2), \\dots$。扰动 $v(t)$ 也因为项 $c_1 e(t-1), c_2 e(t-2), \\dots$ 而依赖于 $e(t-1), e(t-2), \\dots$。因此，$y(t-1)$ 和 $v(t)$ 是相关的。这导致 $E[\\varphi(t) v(t)] \\neq \\mathbf{0}$，违反了 OLS 的一致性条件。$\\theta_p$ 的 OLS 估计将是有偏的且不一致的。\n\n为了解决这个问题，我们必须对系统方程进行预滤波，使得新的扰动项是白噪声并且与新的回归量不相关。设 $L(q)$ 是一个因果、稳定、线性时不变的滤波器。将此预滤波器应用于原始 ARMAX 方程的两边，得到：\n$$L(q) A(q) y(t) = L(q) q^{-n_k} B(q) u(t) + L(q) C(q) e(t)$$\n新的扰动项是 $\\varepsilon_{L}(t) = L(q) C(q) e(t)$。为了使这个扰动成为一个白噪声序列，我们必须选择 $L(q)$，使得算子 $L(q) C(q)$ 不引入任何时间相关性。因为 $e(t)$ 本身就是白噪声，所以对 $L(q) C(q)$ 最简单的选择是单位算子 $1$。因此，我们要求：\n$$L(q) C(q) = 1$$\n这意味着预滤波器必须是噪声动态算子 $C(q)$ 的逆：\n$$L(q) = C(q)^{-1} = \\frac{1}{C(q)}$$\n这个选择是可行的，因为问题陈述中说明了 $C(q)$ 是已知的。此外，问题陈述中还说明了 $C(q)$ 是一个稳定的、首一的多项式算子。在系统辨识中，如果多项式 $P(z)=0$ 的所有根都严格位于单位圆 $|z|1$ 内部，则称多项式算子 $P(q)$ 是稳定的。滤波器 $L(q) = 1/C(q)$ 的稳定性由其极点决定，即 $C(z)=0$ 的根。由于 $C(q)$ 是稳定的，因此可以保证滤波器 $L(q)$ 是稳定的。$C(q)$ 的首一性质（即 $C(q) = 1 + \\sum_{i=1}^{n_c} c_i q^{-i}$）确保了 $L(q)$ 是因果的。最小相位的性质与此稳定性要求相关且一致。\n\n选择了 $L(q) = C(q)^{-1}$ 后，预滤波后的方程变为：\n$$C(q)^{-1} A(q) y(t) = C(q)^{-1} q^{-n_k} B(q) u(t) + e(t)$$\n我们定义预滤波后的输出和输入信号为 $y_{L}(t) = C(q)^{-1} y(t)$ 和 $u_{L}(t) = C(q)^{-1} u(t)$。该方程可以写成：\n$$A(q) y_{L}(t) = q^{-n_k} B(q) u_{L}(t) + e(t)$$\n将其整理成回归形式可得：\n$$y_{L}(t) = -(A(q) - 1) y_{L}(t) + q^{-n_k} B(q) u_{L}(t) + e(t)$$\n这与我们期望的回归模型 $y_{L}(t) = \\varphi_{L}(t)^{\\top} \\theta_{p} + \\varepsilon_{L}(t)$ 相匹配，其中：\n- 新的扰动是 $\\varepsilon_{L}(t) = e(t)$。根据定义，$e(t)$ 是一个零均值白噪声序列。\n- 新的回归量是 $\\varphi_{L}(t)^{\\top} = \\begin{pmatrix} -y_{L}(t-1)  \\cdots  -y_{L}(t-n_a)  u_{L}(t-n_k)  \\cdots  u_{L}(t-n_k-n_b) \\end{pmatrix}$。\n\n我们现在必须验证新的回归量 $\\varphi_{L}(t)$ 与新的扰动 $\\varepsilon_{L}(t) = e(t)$ 不相关。$\\varphi_{L}(t)$ 的分量是 $y_L(t-j)$ 和 $u_L(t-k-j)$，其中 $j \\ge 1$。由于 $L(q)=C(q)^{-1}$ 是一个因果滤波器，$y_L(t-j)$ 和 $u_L(t-k-j)$ 是截至时刻 $t-j$ 的 $y$ 和 $u$ 的当前值和过去值的函数。具体来说，$y_{L}(t-j)$ 依赖于 $\\{y(s) | s \\le t-j\\}$，$u_{L}(t-k-j)$ 依赖于 $\\{u(s) | s \\le t-k-j\\}$。由于整个系统是因果且稳定的，输出 $y(s)$ 仅依赖于 $\\tau \\le s$ 时的输入 $u(\\tau)$ 和噪声 $e(\\tau)$。\n因此，回归量 $\\varphi_{L}(t)$ 的所有分量都是 $\\{u(\\tau), e(\\tau) | \\tau \\le t-1\\}$ 的函数。扰动是 $e(t)$。由于 $e(t)$ 是一个独立同分布序列，根据定义，它与其所有过去值 $e(\\tau)$（其中 $\\tau  t$）不相关。输入 $u(t)$ 也被指定为与 $e(t)$ 相互独立。因此，$e(t)$ 与任何过去输入和过去噪声的函数都不相关。\n这证明了 $E[\\varphi_{L}(t) \\varepsilon_{L}(t)] = \\mathbf{0}$。\n\n转换后的回归模型满足了 OLS 一致性的关键条件。因此，对这个预滤波后的模型应用 OLS 将产生对 $\\theta_p$ 的一致估计。实现这一目标的所需预滤波器 $L(q)$ 是噪声多项式模型 $C(q)$ 的逆。", "answer": "$$\\boxed{\\frac{1}{C(q)}}$$", "id": "2880109"}]}