{"hands_on_practices": [{"introduction": "在我们深入研究谱域中的高阶统计量之前，熟练掌握其在时域中的对应物——累积量——是至关重要的。本练习提供了一个具体的目标，旨在加强对矩和累积量之间代数关系的理解，这是所有高阶统计分析的基础技能。通过为一个非高斯随机变量推导一个联合累积量，您将直接应用矩累积量公式，并将抽象的定义（如偏度和峰度）转化为具体的计算结果 [@problem_id:2876215]。", "problem": "设 $X$ 是一个标准化的实值随机变量，即 $\\mathbb{E}[X]=0$ 且 $\\mathrm{Var}(X)=1$，并且 $X$ 是非高斯分布的。设其偏度为 $\\gamma_{1}$，超额峰度为 $\\gamma_{2}$，定义为 $\\gamma_{1}=\\mathbb{E}[X^{3}]$ 和 $\\gamma_{2}=\\mathbb{E}[X^{4}]-3$。假设一个截断累积量模型，其中 $X$ 的所有 $n \\ge 5$ 阶累积量均为零。从三阶联合累积量的定义以及偏度和超额峰度的定义出发，推导联合累积量 $\\kappa(X,X^{2},X^{3})$ 的闭式表达式，并用 $\\gamma_{1}$ 和 $\\gamma_{2}$ 表示。请将您的最终结果表示为一个简化的解析表达式。请勿对答案进行四舍五入。", "solution": "所述问题具有科学依据，提法恰当且客观。推导所需表达式的全部必要信息均已提供。我们将开始求解。\n\n对于三个随机变量 $Y_1$、$Y_2$ 和 $Y_3$，其三阶联合累积量 $\\kappa(Y_1, Y_2, Y_3)$ 的基本定义由其与联合矩的关系给出：\n$$ \\kappa(Y_1, Y_2, Y_3) = \\mathbb{E}[Y_1 Y_2 Y_3] - \\mathbb{E}[Y_1]\\mathbb{E}[Y_2 Y_3] - \\mathbb{E}[Y_2]\\mathbb{E}[Y_1 Y_3] - \\mathbb{E}[Y_3]\\mathbb{E}[Y_1 Y_2] + 2\\mathbb{E}[Y_1]\\mathbb{E}[Y_2]\\mathbb{E}[Y_3] $$\n在本问题中，我们需要求解联合累积量 $\\kappa(X, X^2, X^3)$。因此，我们设 $Y_1 = X$，$Y_2 = X^2$，$Y_3 = X^3$。将这些代入通用公式可得：\n$$ \\kappa(X, X^2, X^3) = \\mathbb{E}[X \\cdot X^2 \\cdot X^3] - \\mathbb{E}[X]\\mathbb{E}[X^2 X^3] - \\mathbb{E}[X^2]\\mathbb{E}[X X^3] - \\mathbb{E}[X^3]\\mathbb{E}[X X^2] + 2\\mathbb{E}[X]\\mathbb{E}[X^2]\\mathbb{E}[X^3] $$\n通过计算期望算子内部的乘积，可以简化此表达式：\n$$ \\kappa(X, X^2, X^3) = \\mathbb{E}[X^6] - \\mathbb{E}[X]\\mathbb{E}[X^5] - \\mathbb{E}[X^2]\\mathbb{E}[X^4] - \\mathbb{E}[X^3]\\mathbb{E}[X^3] + 2\\mathbb{E}[X]\\mathbb{E}[X^2]\\mathbb{E}[X^3] $$\n问题指明随机变量 $X$ 是标准化的，这意味着其均值为零, $\\mathbb{E}[X] = 0$。这极大地简化了表达式，因为任何包含因子 $\\mathbb{E}[X]$ 的项都变为零：\n$$ \\kappa(X, X^2, X^3) = \\mathbb{E}[X^6] - (0)\\mathbb{E}[X^5] - \\mathbb{E}[X^2]\\mathbb{E}[X^4] - (\\mathbb{E}[X^3])^2 + 2(0)\\mathbb{E}[X^2]\\mathbb{E}[X^3] $$\n$$ \\kappa(X, X^2, X^3) = \\mathbb{E}[X^6] - \\mathbb{E}[X^2]\\mathbb{E}[X^4] - (\\mathbb{E}[X^3])^2 $$\n为了求出此联合累积量的值，我们必须用给定的参数 $\\gamma_1$ 和 $\\gamma_2$ 来表示所需的矩 $\\mathbb{E}[X^2]$、$\\mathbb{E}[X^3]$、$\\mathbb{E}[X^4]$ 和 $\\mathbb{E}[X^6]$。我们利用单个随机变量 $X$ 的矩 $\\mathbb{E}[X^n]$ 和累积量 $\\kappa_n$ 之间的关系。\n\n给定的信息直接与 $X$ 的累积量相关：\n1.  均值为 $\\mathbb{E}[X] = 0$。一阶累积量即为均值，所以 $\\kappa_1 = 0$。\n2.  方差为 $\\mathrm{Var}(X) = 1$。二阶累积量即为方差，所以 $\\kappa_2 = 1$。\n3.  对于零均值变量，偏度是三阶矩，也即三阶累积量。因此，$\\kappa_3 = \\mathbb{E}[X^3] = \\gamma_1$。\n4.  对于零均值变量，超额峰度为 $\\mathbb{E}[X^4] - 3(\\mathbb{E}[X^2])^2 = \\mathbb{E}[X^4] - 3$。这恰好是四阶累积量 $\\kappa_4$ 的定义。因此，$\\kappa_4 = \\gamma_2$。\n5.  假设所有 $n \\ge 5$ 阶的累积量均为零。因此，对于所有 $n \\ge 5$，都有 $\\kappa_n = 0$。\n\n可以使用 Leonov-Shiryaev 公式或矩-累积量关系式，将矩 $\\mu'_n = \\mathbb{E}[X^n]$ 用累积量 $\\kappa_k$ 表示。由于 $\\kappa_1=0$，这些关系式得到了显著简化。我们只需考虑将整数分割成大于1的部分。\n- $\\mathbb{E}[X^2] = \\kappa_2 + \\kappa_1^2 = \\kappa_2 = 1$.\n- $\\mathbb{E}[X^3] = \\kappa_3 + 3\\kappa_1\\kappa_2 + \\kappa_1^3 = \\kappa_3 = \\gamma_1$.\n- $\\mathbb{E}[X^4] = \\kappa_4 + 4\\kappa_1\\kappa_3 + 3\\kappa_2^2 + \\dots = \\kappa_4 + 3\\kappa_2^2 = \\gamma_2 + 3(1)^2 = \\gamma_2 + 3$.\n- $\\mathbb{E}[X^5] = \\kappa_5 + 5\\kappa_1\\kappa_4 + 10\\kappa_3\\kappa_2 + \\dots = \\kappa_5 + 10\\kappa_3\\kappa_2$。使用给定值，$\\mathbb{E}[X^5] = 0 + 10(\\gamma_1)(1) = 10\\gamma_1$。\n- $\\mathbb{E}[X^6] = \\kappa_6 + 15\\kappa_4\\kappa_2 + 10\\kappa_3^2 + 15\\kappa_2^3 + \\text{包含 } \\kappa_1 \\text{ 的项}$。由于 $\\kappa_1=0$，这些其他项消失。使用给定值：\n$$ \\mathbb{E}[X^6] = 0 + 15(\\gamma_2)(1) + 10(\\gamma_1)^2 + 15(1)^3 = 10\\gamma_1^2 + 15\\gamma_2 + 15 $$\n\n现在，我们将这些矩的表达式代回到我们简化的联合累积量公式中：\n$$ \\kappa(X, X^2, X^3) = \\mathbb{E}[X^6] - \\mathbb{E}[X^2]\\mathbb{E}[X^4] - (\\mathbb{E}[X^3])^2 $$\n$$ \\kappa(X, X^2, X^3) = (10\\gamma_1^2 + 15\\gamma_2 + 15) - (1)(\\gamma_2 + 3) - (\\gamma_1)^2 $$\n最后，我们通过合并包含 $\\gamma_1^2$、$\\gamma_2$ 和常数部分的项来进行代数简化：\n$$ \\kappa(X, X^2, X^3) = 10\\gamma_1^2 - \\gamma_1^2 + 15\\gamma_2 - \\gamma_2 + 15 - 3 $$\n$$ \\kappa(X, X^2, X^3) = (10-1)\\gamma_1^2 + (15-1)\\gamma_2 + (15-3) $$\n$$ \\kappa(X, X^2, X^3) = 9\\gamma_1^2 + 14\\gamma_2 + 12 $$\n这就是用指定参数表示的联合累积量的最终闭式表达式。", "answer": "$$\\boxed{9\\gamma_1^2 + 14\\gamma_2 + 12}$$", "id": "2876215"}, {"introduction": "理解了累积量的基本运算后，下一步是探索它们在频域中的表现形式，即多谱。这个练习建立了一个至关重要的基准：一个简单、完全随机的独立同分布（i.i.d.）过程的多谱是什么样的。通过推导白噪声序列的四阶谱（Trispectrum），您将看到为什么高阶谱对于检测非线性和非高斯性是如此有价值——因为对于纯粹的随机噪声，其高阶谱是平坦的，任何偏离这个基准的峰值都预示着信号中存在着有趣的结构 [@problem_id:2876232]。", "problem": "考虑一个离散时间、零均值、严平稳的白噪声序列 $\\{x[n]\\}_{n\\in\\mathbb{Z}}$，该序列是独立同分布的 (i.i.d.)。假设其一维累积量直到4阶都存在且有限，其中二阶累积量为 $\\kappa_{2}=\\mathbb{E}\\{x[n]^{2}\\}>0$，三阶累积量 $\\kappa_{3}$ 可能非零，四阶累积量 $\\kappa_{4}=\\mathrm{cum}\\{x[n],x[n],x[n],x[n]\\}\\neq 0$。定义四阶联合累积量序列\n$$\nc_{4}(\\tau_{1},\\tau_{2},\\tau_{3}) \\triangleq \\mathrm{cum}\\{x[n],\\,x[n+\\tau_{1}],\\,x[n+\\tau_{2}],\\,x[n+\\tau_{3}]\\},\n$$\n根据平稳性，该序列仅依赖于时滞 $(\\tau_{1},\\tau_{2},\\tau_{3})\\in\\mathbb{Z}^{3}$。三谱 $T_{x}(\\omega_{1},\\omega_{2},\\omega_{3})$ 是 $c_{4}(\\tau_{1},\\tau_{2},\\tau_{3})$ 的三维离散时间傅里叶变换 (DTFT)，\n$$\nT_{x}(\\omega_{1},\\omega_{2},\\omega_{3}) \\triangleq \\sum_{\\tau_{1}=-\\infty}^{\\infty}\\sum_{\\tau_{2}=-\\infty}^{\\infty}\\sum_{\\tau_{3}=-\\infty}^{\\infty} c_{4}(\\tau_{1},\\tau_{2},\\tau_{3})\\,\\exp\\!\\big(-j(\\omega_{1}\\tau_{1}+\\omega_{2}\\tau_{2}+\\omega_{3}\\tau_{3})\\big),\n$$\n其中角频率 $(\\omega_{1},\\omega_{2},\\omega_{3})\\in[-\\pi,\\pi]^{3}$ 的单位是弧度/样本。\n\n仅使用累积量和独立性的基本性质，推导此白噪声 i.i.d. 序列的 $c_{4}(\\tau_{1},\\tau_{2},\\tau_{3})$，明确计算 $T_{x}(\\omega_{1},\\omega_{2},\\omega_{3})$，并确认其对 $(\\omega_{1},\\omega_{2},\\omega_{3})$ 的依赖性（或独立性）。将你的最终答案表示为 $T_{x}(\\omega_{1},\\omega_{2},\\omega_{3})$ 的单个闭式解析表达式。无需进行数值取整。", "solution": "所述问题是有效的。它有科学依据、适定、客观且内部一致。它提出了一个对基本随机过程进行高阶统计分析的标准任务。我们现在开始推导。\n\n目标是为一个给定的离散时间、零均值、i.i.d. 随机序列 $\\{x[n]\\}_{n\\in\\mathbb{Z}}$，推导其四阶联合累积量序列 $c_{4}(\\tau_{1},\\tau_{2},\\tau_{3})$，并随后计算其三维离散时间傅里叶变换 (DTFT)，即三谱 $T_{x}(\\omega_{1},\\omega_{2},\\omega_{3})$。\n\n主导此问题的累积量基本性质是其在统计独立性方面的特性。对于一组随机变量 $\\{X_{1}, X_{2}, \\dots, X_{k}\\}$，如果这组变量可以被划分为两个或多个彼此统计独立的子集，则它们的联合累积量 $\\mathrm{cum}\\{X_{1}, X_{2}, \\dots, X_{k}\\}$ 为零。\n\n序列 $\\{x[n]\\}$ 被定义为独立同分布 (i.i.d.)。这意味着序列中的任意两个随机变量 $x[n_{1}]$ 和 $x[n_{2}]$ 是统计独立的，当且仅当它们的时间索引不同，即 $n_{1} \\neq n_{2}$。\n\n我们被要求求解四阶累积量序列，其定义为：\n$$\nc_{4}(\\tau_{1},\\tau_{2},\\tau_{3}) = \\mathrm{cum}\\{x[n],\\,x[n+\\tau_{1}],\\,x[n+\\tau_{2}],\\,x[n+\\tau_{3}]\\}\n$$\n累积量参数中的四个随机变量取自时间索引 $n$、$n+\\tau_{1}$、$n+\\tau_{2}$ 和 $n+\\tau_{3}$。让我们分析该累积量可以为非零的条件。\n\n根据 i.i.d. 序列的独立性，如果任意一个时间索引与所有其他索引都不同，那么对应的随机变量就与其余三个变量独立。例如，如果 $n+\\tau_{1}$ 不等于 $n$、$n+\\tau_{2}$ 或 $n+\\tau_{3}$，那么随机变量 $x[n+\\tau_{1}]$ 就与集合 $\\{x[n], x[n+\\tau_{2}], x[n+\\tau_{3}]\\}$ 独立。在这种情况下，这四个随机变量的集合可以被划分为两个独立的子集：$\\{x[n+\\tau_{1}]\\}$ 和 $\\{x[n], x[n+\\tau_{2}], x[n+\\tau_{3}]\\}$。根据累积量的基本性质，它们的联合累积量必须为零。\n\n这种逻辑可以推广到任何划分。对于 i.i.d. 序列，防止划分为独立子集的唯一方法是，所有随机变量实际上是同一个变量。这只在所有时间索引都相同时才会发生。\n因此，要使 $c_{4}(\\tau_{1},\\tau_{2},\\tau_{3})$ 非零，必须满足：\n$$\nn = n+\\tau_{1} = n+\\tau_{2} = n+\\tau_{3}\n$$\n该方程组对时滞得出唯一解：\n$$\n\\tau_{1} = 0, \\quad \\tau_{2} = 0, \\quad \\tau_{3} = 0\n$$\n对于任何其他的时滞组合 $(\\tau_{1},\\tau_{2},\\tau_{3})$，将至少存在两个不同的时间索引，从而允许划分为独立的子集，这迫使累积量为零。\n\n当 $\\tau_{1}=\\tau_{2}=\\tau_{3}=0$ 时，累积量变为：\n$$\nc_{4}(0,0,0) = \\mathrm{cum}\\{x[n], x[n], x[n], x[n]\\}\n$$\n这是来自平稳序列的单个随机变量的四阶累积量，在问题陈述中已给出为 $\\kappa_{4}$。题目说明了 $\\kappa_{4} \\neq 0$。\n\n因此，四阶累积量序列 $c_{4}(\\tau_{1},\\tau_{2},\\tau_{3})$ 仅在时滞空间的原点 $(\\tau_{1},\\tau_{2},\\tau_{3}) = (0,0,0)$ 处非零。这可以用三维离散时间脉冲函数（或 Kronecker delta 函数）正式表示：\n$$\nc_{4}(\\tau_{1},\\tau_{2},\\tau_{3}) = \\kappa_{4} \\cdot \\delta[\\tau_{1}] \\delta[\\tau_{2}] \\delta[\\tau_{3}]\n$$\n其中，当 $k=0$ 时 $\\delta[k]=1$，当 $k \\neq 0$ 时 $\\delta[k]=0$。\n\n现在，我们计算三谱 $T_{x}(\\omega_{1},\\omega_{2},\\omega_{3})$，它是 $c_{4}(\\tau_{1},\\tau_{2},\\tau_{3})$ 的 DTFT：\n$$\nT_{x}(\\omega_{1},\\omega_{2},\\omega_{3}) = \\sum_{\\tau_{1}=-\\infty}^{\\infty}\\sum_{\\tau_{2}=-\\infty}^{\\infty}\\sum_{\\tau_{3}=-\\infty}^{\\infty} c_{4}(\\tau_{1},\\tau_{2},\\tau_{3})\\,\\exp\\!\\big(-j(\\omega_{1}\\tau_{1}+\\omega_{2}\\tau_{2}+\\omega_{3}\\tau_{3})\\big)\n$$\n代入我们得到的 $c_{4}(\\tau_{1},\\tau_{2},\\tau_{3})$ 表达式：\n$$\nT_{x}(\\omega_{1},\\omega_{2},\\omega_{3}) = \\sum_{\\tau_{1}=-\\infty}^{\\infty}\\sum_{\\tau_{2}=-\\infty}^{\\infty}\\sum_{\\tau_{3}=-\\infty}^{\\infty} (\\kappa_{4} \\delta[\\tau_{1}] \\delta[\\tau_{2}] \\delta[\\tau_{3}])\\,\\exp\\!\\big(-j(\\omega_{1}\\tau_{1}+\\omega_{2}\\tau_{2}+\\omega_{3}\\tau_{3})\\big)\n$$\n常数 $\\kappa_{4}$ 可以从求和中提取出来：\n$$\nT_{x}(\\omega_{1},\\omega_{2},\\omega_{3}) = \\kappa_{4} \\sum_{\\tau_{1}=-\\infty}^{\\infty}\\sum_{\\tau_{2}=-\\infty}^{\\infty}\\sum_{\\tau_{3}=-\\infty}^{\\infty} \\delta[\\tau_{1}] \\delta[\\tau_{2}] \\delta[\\tau_{3}]\\,\\exp\\!\\big(-j(\\omega_{1}\\tau_{1}+\\omega_{2}\\tau_{2}+\\omega_{3}\\tau_{3})\\big)\n$$\n我们使用 Kronecker delta 函数的筛选性质，即 $\\sum_{k=-\\infty}^{\\infty} f[k]\\delta[k] = f[0]$。被加项仅在 $\\tau_{1}=0$, $\\tau_{2}=0$ 且 $\\tau_{3}=0$ 时非零。在此单点上计算表达式的值：\n$$\nT_{x}(\\omega_{1},\\omega_{2},\\omega_{3}) = \\kappa_{4} \\cdot \\exp\\!\\big(-j(\\omega_{1}\\cdot 0 + \\omega_{2}\\cdot 0 + \\omega_{3}\\cdot 0)\\big) = \\kappa_{4} \\cdot \\exp(0) = \\kappa_{4} \\cdot 1\n$$\n结果是：\n$$\nT_{x}(\\omega_{1},\\omega_{2},\\omega_{3}) = \\kappa_{4}\n$$\n这个结果表明，一个零均值、i.i.d. 序列的三谱是一个常数，等于其基础分布的四阶累积量 $\\kappa_{4}$。因此，三谱完全不依赖于频率 $(\\omega_{1},\\omega_{2},\\omega_{3})$。这是“白性”性质的高阶等价物，在“白性”性质中功率谱（二阶谱）也是平坦的。对于一个 i.i.d. 过程，所有多阶谱都是常数。", "answer": "$$\n\\boxed{\\kappa_{4}}\n$$", "id": "2876232"}, {"introduction": "理论知识的最终目的是应用于实际数据分析。这个综合性练习将引导您完成构建双谱估计器的整个过程，这是一个用于检测二次相位耦合等非线性现象的核心工具。您将从有限的数据记录中估计三阶累积量，应用窗函数以减少谱泄漏，并利用快速傅里叶变换（FFT）进行高效计算，从而将理论概念转化为可执行的算法 [@problem_id:2876231]。这个实践不仅巩固了理论，还提供了在计算信号处理中至关重要的算法实现经验。", "problem": "你的任务是为一个实值、离散时间、零均值、有限长度的序列实现一个基于直接快速傅里叶变换（FFT）的双谱估计器。该估计器必须首先在有限的延迟网格上计算三阶累积量的估计值，然后应用二维FFT来获得双谱。你还需要计算明确的运算次数以表征其计算复杂度。\n\n仅从以下核心定义开始：\n\n- 一个零均值、宽义平稳离散时间过程的三阶累积量是其三阶矩：对于整数延迟 $ \\tau_1 $ 和 $ \\tau_2 $，三阶累积量为 $ c_3(\\tau_1,\\tau_2) = \\mathbb{E}\\{x[n]\\,x[n+\\tau_1]\\,x[n+\\tau_2]\\} $。\n- 双谱是三阶累积量的二维傅里叶变换（在离散时间傅里叶变换的意义上）：$ B(f_1,f_2) = \\sum_{\\tau_1=-\\infty}^{\\infty}\\sum_{\\tau_2=-\\infty}^{\\infty} c_3(\\tau_1,\\tau_2)\\, e^{-j 2\\pi (f_1 \\tau_1 + f_2 \\tau_2)} $。\n\n你的实现必须使用以下步骤，你必须从上述定义中推导出这些步骤，而不依赖任何预先指定的快捷公式：\n\n1. 给定一个有限序列 $ x[0], x[1], \\dots, x[N-1] $，减去其经验均值以强制其为零均值。对于每对整数延迟 $ \\tau_1, \\tau_2 \\in \\{-L, -L+1, \\dots, 0, \\dots, L-1, L\\} $，通过对所有使各项有定义的索引 $ n $ 上的三重积 $ x[n]\\,x[n+\\tau_1]\\,x[n+\\tau_2] $ 进行平均，来计算三阶累积量的无偏样本估计。具体来说，通过约束条件 $ 0 \\le n \\le N-1 $、$ 0 \\le n+\\tau_1 \\le N-1 $ 和 $ 0 \\le n+\\tau_2 \\le N-1 $ 的交集来定义有效的求和范围。设 $ K(\\tau_1,\\tau_2) $ 是此范围内的有效 $ n $ 的数量。如果 $ K(\\tau_1,\\tau_2) > 0 $，则样本估计是这 $ K(\\tau_1,\\tau_2) $ 个三重积的平均值；否则，将估计值设为 $ 0 $。\n2. 对估计的累积量应用一个可分离的延迟域窗。使用长度为 $ 2L+1 $ 的汉明窗，定义为 $ w[m] $，$ m \\in \\{0,1,\\dots,2L\\} $。形成二维可分离窗 $ W(\\tau_1,\\tau_2) = w[\\tau_1+L]\\,w[\\tau_2+L] $，并将其与累积量估计值进行逐元素相乘。\n3. 通过使用模数索引将延迟索引映射到二维离散傅里叶变换（DFT）索引，将加窗后的累积量嵌入到一个 $ M \\times M $ 的网格中：映射 $ \\tau_1 \\mapsto (\\tau_1 \\bmod M) $ 和 $ \\tau_2 \\mapsto (\\tau_2 \\bmod M) $，其他位置置零。\n4. 计算嵌入数组的二维FFT，以在网格 $ k_1, k_2 \\in \\{0,1,\\dots,M-1\\} $ 上产生双谱的离散近似 $ \\widehat{B}[k_1,k_2] $。使用你编程语言的标准FFT实现。\n5. 报告估计双谱最大幅值的位置，即返回在整个 $ M \\times M $ 网格上使 $ |\\widehat{B}[k_1,k_2]| $ 最大化的索引 $ (k_1^\\star,k_2^\\star) $。\n\n此外，计算并报告以下运算次数，以明确计算复杂度，用 $ N $、$ L $ 和 $ M $ 表示：\n\n- 步骤1中累积的三重积总数，即 $ \\sum_{\\tau_1=-L}^{L}\\sum_{\\tau_2=-L}^{L} K(\\tau_1,\\tau_2) $。将其解释为累积量估计的主要算术运算次数。\n- 步骤2中应用可分离延迟窗（作为外积后与累积量数组逐元素相乘）所需的实数乘法次数。将其计为 $ 2\\,(2L+1)^2 $ 次乘法。\n- 步骤4中二维FFT的复数乘法次数的上限估计，使用教科书中长度为 $ M $ 的一维FFT的基2估计。对于实现为 $ M $ 次行FFT和 $ M $ 次列FFT的二维FFT，报告 $ M^2 \\log_2 M $ 作为复数乘法次数。\n\n实现这个估计器并将其应用于以下测试套件。对于每个测试用例，按描述合成 $ x[n] $，将任何随机性的伪随机种子固定为 $ 0 $，然后使用指定的 $ N $、$ L $ 和 $ M $ 执行上述算法。内部使用的角度（例如，在正弦波生成中）以弧度为单位。\n\n测试套件：\n\n- 案例1（带二次耦合的双音信号，中等噪声）：\n  - 参数：$ N = 512 $，$ L = 31 $，$ M = 256 $，$ k_1 = 20 $，$ k_2 = 40 $，$ \\alpha = 0.8 $，噪声标准差 $ \\sigma = 0.1 $。\n  - 信号：$ u[n] = \\sin\\!\\big(2\\pi k_1 n / N\\big) + \\sin\\!\\big(2\\pi k_2 n / N\\big) $，$ x[n] = u[n] + \\alpha\\,u[n]^2 + \\eta[n] $，其中 $ \\eta[n] $ 是独立同分布的零均值高斯噪声，方差为 $ \\sigma^2 $。\n- 案例2（仅高斯白噪声，较短数据上的边界）：\n  - 参数：$ N = 128 $，$ L = 15 $，$ M = 64 $，$ \\sigma = 1.0 $。\n  - 信号：$ x[n] = \\eta[n] $，如上所述。\n- 案例3（带较弱二次耦合的双音信号，低噪声）：\n  - 参数：$ N = 256 $，$ L = 21 $，$ M = 128 $，$ k_1 = 15 $，$ k_2 = 25 $，$ \\alpha = 0.3 $，$ \\sigma = 0.05 $。\n  - 信号：与案例1相同，但使用指定的参数。\n- 案例4（退化的延迟网格，最小延迟支持）：\n  - 参数：$ N = 64 $，$ L = 0 $，$ M = 16 $，$ \\sigma = 0.5 $。\n  - 信号：$ x[n] = \\eta[n] $，如上所述。\n\n对于每个案例，你的程序必须计算：\n\n- 在整个 $ M \\times M $ 网格上最大幅值双谱估计 $ |\\widehat{B}[k_1,k_2]| $ 的整型索引 $ k_1^\\star $ 和 $ k_2^\\star $。\n- 整型运算次数：\n  - $ T_{\\mathrm{cum}} = \\sum_{\\tau_1=-L}^{L}\\sum_{\\tau_2=-L}^{L} K(\\tau_1,\\tau_2) $。\n  - $ T_{\\mathrm{win}} = 2\\,(2L+1)^2 $。\n  - $ T_{\\mathrm{fft}} = M^2 \\log_2 M $ 四舍五入到最近的整数。\n\n最终输出格式要求：\n\n- 你的程序应生成单行输出，其中包含四个案例的结果，形式为一个用方括号括起来的逗号分隔列表，每个案例表示为五个整数的列表 $ [k_1^\\star, k_2^\\star, T_{\\mathrm{cum}}, T_{\\mathrm{win}}, T_{\\mathrm{fft}}] $。例如：$ [[1,2,3,4,5],[6,7,8,9,10],\\dots] $。", "solution": "任务是为一个实值、有限长度的离散时间信号构建并实现一个基于直接FFT的双谱估计器。该问题定义明确且科学上合理，基于信号处理中高阶统计的既定原则。我们将通过形式化指定算法的每一步，从累积量估计到最终的双谱计算，并为相关的计算复杂度提供明确的公式，来逐步进行。\n\n双谱 $B(f_1, f_2)$ 是三阶累积量 $c_3(\\tau_1, \\tau_2)$ 的二维傅里叶变换。对于零均值过程，三阶累积量与三阶矩相同，即 $c_3(\\tau_1, \\tau_2) = \\mathbb{E}\\{x[n] x[n+\\tau_1] x[n+\\tau_2]\\}$。双谱在检测和表征二次相位耦合方面特别有用，这是一种非线性现象，其中来自两个频率 $f_1$ 和 $f_2$ 的能量被转移到它们的和频 $f_1+f_2$ 和/或差频 $|f_1-f_2|$。这种现象对于标准的功率谱分析是不可见的，因为功率谱是二阶累积量（自相关函数）的傅里叶变换，是相位盲的。双谱保留了部分相位信息，能够揭示这些相互作用，表现为在相应频率对 $(f_1, f_2)$ 处的峰值。\n\n流程如下：\n\n**步骤1：三阶累积量估计**\n\n给定一个长度为 $N$ 的有限数据序列 $x[n]$，$n \\in \\{0, 1, \\dots, N-1\\}$，我们首先通过减去样本均值来强制满足零均值条件：\n$$\nx'[n] = x[n] - \\bar{x}, \\quad \\text{其中 } \\bar{x} = \\frac{1}{N}\\sum_{i=0}^{N-1}x[i]\n$$\n对于在 $\\{-L, \\dots, L\\}$ 范围内的整数延迟 $\\tau_1, \\tau_2$，计算三阶累积量的无偏样本估计 $\\hat{c}_3(\\tau_1, \\tau_2)$。该估计是三重积 $x'[n]x'[n+\\tau_1]x'[n+\\tau_2]$ 在所有可用时间索引 $n$ 上的平均值。有效索引 $n$ 的集合由 $n$、$n+\\tau_1$ 和 $n+\\tau_2$ 都必须位于区间 $[0, N-1]$ 内的要求确定。这为每个 $(\\tau_1, \\tau_2)$ 对定义了求和范围为 $n \\in [n_{\\min}, n_{\\max}]$，其中：\n$$\nn_{\\min}(\\tau_1, \\tau_2) = \\max(0, -\\tau_1, -\\tau_2)\n$$\n$$\nn_{\\max}(\\tau_1, \\tau_2) = \\min(N-1, N-1-\\tau_1, N-1-\\tau_2)\n$$\n对于给定的延迟对，有效乘积的数量为 $K(\\tau_1, \\tau_2) = n_{\\max} - n_{\\min} + 1$（前提是 $n_{\\max} \\ge n_{\\min}$）；否则，$K(\\tau_1, \\tau_2) = 0$。累积量估计则为：\n$$\n\\hat{c}_3(\\tau_1, \\tau_2) = \\begin{cases} \\frac{1}{K(\\tau_1,\\tau_2)} \\sum_{n=n_{\\min}}^{n_{\\max}} x'[n]x'[n+\\tau_1]x'[n+\\tau_2] & \\text{若 } K(\\tau_1,\\tau_2) > 0 \\\\ 0 & \\text{若 } K(\\tau_1,\\tau_2) = 0 \\end{cases}\n$$\n此计算对所有 $\\tau_1, \\tau_2 \\in \\{-L, \\dots, L\\}$ 执行，形成一个 $(2L+1) \\times (2L+1)$ 的累积量估计网格。\n\n此步骤的主要计算成本是计算的三重积总数。这由总数 $T_{\\mathrm{cum}}$ 给出：\n$$\nT_{\\mathrm{cum}} = \\sum_{\\tau_1=-L}^{L}\\sum_{\\tau_2=-L}^{L} K(\\tau_1,\\tau_2)\n$$\n\n**步骤2：延迟域加窗**\n\n累积量估计网格被截断为 $(2L+1) \\times (2L+1)$ 的有限大小。延迟域中的这种突变截断会在双谱域中引起显著的频谱泄漏（旁瓣伪影）。为减轻此影响，应用一个平滑的窗函数。问题指定了一个由一维汉明窗 $w[m]$ 构成的可分离二维窗 $W(\\tau_1, \\tau_2)$。长度为 $2L+1$ 的汉明窗定义为（对于 $m \\in \\{0, 1, \\dots, 2L\\}$）：\n$$\nw[m] = 0.54 - 0.46 \\cos\\left(\\frac{2\\pi m}{2L}\\right)\n$$\n二维窗是外积 $W(\\tau_1, \\tau_2) = w[\\tau_1+L]w[\\tau_2+L]$，其中延迟索引 $\\tau_1, \\tau_2 \\in \\{-L, \\dots, L\\}$ 映射到窗口索引 $\\{0, \\dots, 2L\\}$。加窗后的累积量估计 $\\hat{c}_{3,w}$ 通过逐元素相乘获得：\n$$\n\\hat{c}_{3,w}(\\tau_1, \\tau_2) = \\hat{c}_3(\\tau_1, \\tau_2) \\cdot W(\\tau_1, \\tau_2)\n$$\n根据问题指定的计算方法（外积生成后逐元素相乘），此步骤的实数乘法次数为：\n$$\nT_{\\mathrm{win}} = (2L+1)^2 + (2L+1)^2 = 2(2L+1)^2\n$$\n\n**步骤3：嵌入到DFT网格上**\n\n双谱是通过二维离散傅里叶变换（DFT）来估计的，而DFT可通过快速傅里叶变换（FFT）高效计算。DFT在周期性网格上操作。$(2L+1) \\times (2L+1)$ 的加窗累积量数组必须被放置在一个更大的 $M \\times M$ 网格上。该映射使用模运算执行，这能正确处理DFT的周期性。一个 $M \\times M$ 的复值数组 $C_{\\mathrm{emb}}$ 初始化为零。对于每个延迟对 $(\\tau_1, \\tau_2)$，加窗累积量的值被放置在对应的网格位置 $(k_1, k_2)$：\n$$\nk_1 = \\tau_1 \\pmod M\n$$\n$$\nk_2 = \\tau_2 \\pmod M\n$$\n此操作填充了 $M \\times M$ 网格的一小部分，因为所有测试用例中 $2L+1 \\le M$。$C_{\\mathrm{emb}}[k_1, k_2]$ 的值是加窗后的累积量估计值。\n\n**步骤4：通过2D-FFT计算双谱**\n\n离散双谱估计 $\\widehat{B}[k_1, k_2]$ 是嵌入累积量数组的二维DFT：\n$$\n\\widehat{B}[k_1, k_2] = \\sum_{m_1=0}^{M-1} \\sum_{m_2=0}^{M-1} C_{\\mathrm{emb}}[m_1, m_2] e^{-j 2\\pi (k_1 m_1 + k_2 m_2)/M}\n$$\n此计算使用2D-FFT算法执行。计算复杂度主要由FFT决定。对于一个 $M \\times M$ 网格，这可以实现为 $M$ 次行向1D-FFT，然后是 $M$ 次列向1D-FFT。使用基2 FFT的复杂度估计，即一个长度为 $M$ 的1D-FFT需要 $(M/2) \\log_2 M$ 次复数乘法，2D-FFT的总复数乘法次数为：\n$$\nT_{\\mathrm{fft}} = M \\cdot \\left(\\frac{M}{2} \\log_2 M\\right) + M \\cdot \\left(\\frac{M}{2} \\log_2 M\\right) = M^2 \\log_2 M\n$$\n问题要求将此值四舍五入到最近的整数。\n\n**步骤5：定位双谱最大值**\n\n该过程的最后一步是确定估计双谱幅值中最高峰的位置。这对应于在整个 $M \\times M$ 网格上使 $|\\widehat{B}[k_1, k_2]|$ 最大化的频率索引对 $(k_1^\\star, k_2^\\star)$：\n$$\n(k_1^\\star, k_2^\\star) = \\arg\\max_{k_1, k_2 \\in \\{0, \\dots, M-1\\}} |\\widehat{B}[k_1, k_2]|\n$$\n这些索引以及计算出的运算次数 $T_{\\mathrm{cum}}$、$T_{\\mathrm{win}}$ 和 $T_{\\mathrm{fft}}$，构成了每个测试用例所需的输出。", "answer": "[[40,20,1854593,7938,524288],[55,3,47393,1922,24576],[25,15,404641,3698,114688],[0,0,64,2,1024]]", "id": "2876231"}]}