{"hands_on_practices": [{"introduction": "在实际应用中，直接计算并求逆协方差矩阵 $R$ 不仅计算成本高昂（复杂度为 $O(M^3)$），而且在数值上可能不稳定。更稳健和高效的方法是利用 $R$ 的矩阵分解，例如 Cholesky 分解。本练习将引导您探索如何使用 Cholesky 分解（$R = LL^H$），通过求解三角线性系统来高效地计算 MVDR 谱估计中的关键二次型 $a^H R^{-1} a$，从而避免显式矩阵求逆。[@problem_id:2883219]", "problem": "在最小方差 (Capon) 谱估计（也称为最小方差无失真响应 (MVDR)）中，分母涉及二次型 $a(\\omega)^{H} R^{-1} a(\\omega)$，其中 $R \\in \\mathbb{C}^{M \\times M}$ 是一个 Hermitian 正定协方差矩阵，而 $a(\\omega) \\in \\mathbb{C}^{M}$ 是频率相关的导向矢量。假设 $R$ 已经通过 Cholesky 分解 $R = L L^{H}$ 进行了因式分解，其中 $L$ 是具有严格正对角线的下三角矩阵。为了计算效率和数值稳定性，应避免显式地构建 $R^{-1}$。\n\n以下哪个过程能够仅使用三角求解和向量内积或范数，在不显式构建任何矩阵逆的情况下，正确计算标量 $s = a^{H} R^{-1} a$？\n\nA. 求解 $L y = a$ 得到 $y$，然后求解 $L^{H} x = y$ 得到 $x$，最后计算 $s = a^{H} x$。\n\nB. 求解 $L^{H} y = a$ 得到 $y$，然后求解 $L x = y$ 得到 $x$，最后计算 $s = a^{H} y$。\n\nC. 求解 $L z = a$ 得到 $z$，然后计算 $s = z^{H} z$。\n\nD. 求解 $L^{H} z = a$ 得到 $z$，然后计算 $s = z^{H} z$。\n\nE. 通过 $R^{-1} = L^{-H} L^{-1}$ 显式构建 $R^{-1}$，然后计算 $s = a^{H} R^{-1} a$。\n\n选择所有适用项。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 需要计算的量是标量 $s = a(\\omega)^{H} R^{-1} a(\\omega)$。为简洁起见，我们将使用 $s = a^{H} R^{-1} a$。\n- $R \\in \\mathbb{C}^{M \\times M}$ 是一个 Hermitian 正定协方差矩阵。\n- $a \\in \\mathbb{C}^{M}$ 是频率相关的导向矢量。\n- $R$ 通过 Cholesky 分解进行因式分解：$R = L L^{H}$。\n- $L$ 是一个具有严格正对角元素的下三角矩阵。\n- 目标是找到一个仅使用三角求解和向量内积或范数，而不显式构建任何矩阵逆的方法来计算 $s$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法得当，且客观。它提出了一个数值线性代数在信号处理中应用的标准问题。Hermitian 正定矩阵存在唯一的 Cholesky 分解是一个基本定理。出于计算成本和数值稳定性的考虑而避免显式矩阵求逆是现代数值分析的核心原则。问题陈述是自洽、一致的，没有任何科学或逻辑上的缺陷。\n\n### 步骤 3：结论和行动\n该问题被判定为 **有效**。我们继续进行解答。\n\n目标是计算二次型 $s = a^{H} R^{-1} a$。我们已知 Cholesky 分解 $R = L L^{H}$。将其代入 $s$ 的表达式中可得：\n$$s = a^{H} (L L^{H})^{-1} a$$\n使用矩阵逆的性质 $(AB)^{-1} = B^{-1} A^{-1}$，我们可以写出：\n$$(L L^{H})^{-1} = (L^{H})^{-1} L^{-1}$$\n通常将 $(A^{H})^{-1}$ 表示为 $A^{-H}$。因此，$s$ 的表达式变为：\n$$s = a^{H} L^{-H} L^{-1} a$$\n此表达式的计算必须在不构建逆矩阵 $L^{-1}$、$L^{-H}$ 或 $R^{-1}$ 的情况下进行。我们可以通过定义中间向量并求解线性方程组来实现这一点。这可以通过两种数学上等价的方法完成。\n\n**方法 1：**\n让我们定义一个中间向量 $z \\in \\mathbb{C}^{M}$，使得 $z = L^{-1} a$。这等价于求解下三角方程组：\n$$L z = a$$\n该方程组可以使用前向代入法高效地求解 $z$，其计算复杂度为 $O(M^2)$。\n将 $z = L^{-1} a$ 代回 $s$ 的表达式中：\n$$s = a^{H} L^{-H} (L^{-1} a) = (a^{H} L^{-H}) z$$\n使用共轭转置的性质 $(AB)^H = B^H A^H$，我们有 $(L^{-1} a)^H = a^H (L^{-1})^H = a^H L^{-H}$。\n因此，$a^{H} L^{-H} = z^{H}$。\n$s$ 的表达式简化为：\n$$s = z^{H} z = \\|z\\|_{2}^{2}$$\n该过程涉及一次三角求解，然后是向量内积（或 L2 范数的平方）的计算，这是一个 $O(M)$ 的操作。\n\n**方法 2：**\n让我们以不同的方式对 $s = a^{H} (L^{-H} (L^{-1} a))$ 中的项进行分组。\n首先，定义一个中间向量 $y = L^{-1} a$。这等价于使用前向代入法求解下三角系统 $L y = a$。\n然后，表达式变为 $s = a^{H} (L^{-H} y)$。\n让我们定义第二个中间向量 $x = L^{-H} y = (L^{H})^{-1} y$。这等价于求解上三角系统：\n$$L^{H} x = y$$\n该系统可以使用后向代入法高效地求解 $x$，这也是一个 $O(M^2)$ 的操作。\n根据构造，$x = (L^{H})^{-1} y = (L^{H})^{-1} (L^{-1} a) = (L L^{H})^{-1} a = R^{-1} a$。\n$s$ 的最终计算为：\n$$s = a^{H} x$$\n该过程涉及两次三角求解（一次前向，一次后向）和一次向量内积。\n\n现在我们根据这些推导来评估每个选项。\n\n**选项 A. 求解 $L y = a$ 得到 $y$，然后求解 $L^{H} x = y$ 得到 $x$，最后计算 $s = a^{H} x$。**\n这个过程与上面推导的方法 2 完全匹配。步骤是：\n1.  $y = L^{-1} a$（通过求解 $L y = a$ 得到）。\n2.  $x = (L^{H})^{-1} y$（通过求解 $L^H x = y$ 得到）。\n3.  $s = a^{H} x$。\n代入中间步骤，我们得到 $x = (L^H)^{-1} (L^{-1} a) = R^{-1} a$，因此最终计算为 $s = a^{H} (R^{-1} a) = a^{H} R^{-1} a$。这是正确的。该过程使用两次三角求解和一次内积，避免了显式求逆。\n结论：**正确**。\n\n**选项 B. 求解 $L^{H} y = a$ 得到 $y$，然后求解 $L x = y$ 得到 $x$，最后计算 $s = a^{H} y$。**\n我们来分析这些步骤：\n1.  $y = (L^{H})^{-1} a = L^{-H} a$。\n2.  $x = L^{-1} y = L^{-1} L^{-H} a$。这个向量 $x$ 不是 $R^{-1}a$。\n3.  $s = a^{H} y = a^{H} (L^{-H} a)$。\n正确的表达式是 $s = a^{H} L^{-H} L^{-1} a$。计算出的量 $a^{H} L^{-H} a$ 缺少了 $L^{-1}$ 因子，因此是不正确的。\n结论：**不正确**。\n\n**选项 C. 求解 $L z = a$ 得到 $z$，然后计算 $s = z^{H} z$。**\n这个过程与上面推导的方法 1 完全匹配。步骤是：\n1.  $z = L^{-1} a$（通过求解 $L z = a$ 得到）。\n2.  $s = z^{H} z$。\n代入 $z$ 的表达式，我们得到 $s = (L^{-1} a)^{H} (L^{-1} a) = (a^{H} L^{-H}) (L^{-1} a) = a^{H} L^{-H} L^{-1} a = a^{H} R^{-1} a$。这是正确的。该过程使用一次三角求解和一次内积，避免了显式求逆。实际上，它在计算上比选项 A 更高效。\n结论：**正确**。\n\n**选项 D. 求解 $L^{H} z = a$ 得到 $z$，然后计算 $s = z^{H} z$。**\n我们来分析这些步骤：\n1.  $z = (L^{H})^{-1} a = L^{-H} a$。\n2.  $s = z^{H} z = (L^{-H} a)^{H} (L^{-H} a)$。\n使用共轭转置属性，$(L^{-H} a)^{H} = a^{H} (L^{-H})^{H} = a^{H} L^{-1}$。\n所以，$s = (a^{H} L^{-1}) (L^{-H} a) = a^{H} L^{-1} L^{-H} a$。\n通常，$L^{-1}$ 和 $L^{-H}$ 是不可交换的，所以 $L^{-1} L^{-H} \\neq L^{-H} L^{-1} = R^{-1}$。因此，这个过程是不正确的。\n结论：**不正确**。\n\n**选项 E. 通过 $R^{-1} = L^{-H} L^{-1}$ 显式构建 $R^{-1}$，然后计算 $s = a^{H} R^{-1} a$。**\n问题陈述明确要求，该过程必须“避免显式地构建 $R^{-1}$”，以保证“计算效率和数值稳定性”。虽然数学恒等式 $R^{-1} = L^{-H} L^{-1}$ 是正确的，但构建这个逆矩阵通常需要先求 $L$ 的逆（一个 $O(M^3)$ 的操作），然后执行 $L^{-H}$ 和 $L^{-1}$ 的矩阵乘法（另一个 $O(M^3)$ 的操作）。这直接违反了问题中给出的约束和动机。因此，在问题的背景下，这不是一个有效的过程。\n结论：**不正确**。\n\n总之，选项 A 和 C 都是数学上正确且符合问题计算约束的过程。", "answer": "$$\\boxed{AC}$$", "id": "2883219"}, {"introduction": "MVDR 谱估计器以其高分辨率而著称，但这种性能优势也使其对模型失配非常敏感。一个常见的失配来源是假设的信号频率与真实情况之间存在微小偏差，导致导向矢量不匹配。本练习旨在通过解析推导，量化这种频率失配对滤波器输出功率的影响，从而帮助您深入理解 MVDR 谱估计器的性能边界。[@problem_id:2883242]", "problem": "考虑一个用于复基带正弦谱估计的长度为 $M$ 的快照模型。令 $M \\times 1$ 的导向矢量为 $a(\\omega) \\triangleq [1, e^{-j \\omega}, e^{-j 2 \\omega}, \\dots, e^{-j (M-1)\\omega}]^{\\top}$，其中 $\\omega$ 是以弧度/样本为单位的角频率。接收到的 $M \\times 1$ 矢量建模为 $x = s\\,a(\\omega_{0}) + v$，其中 $s$ 是一个零均值循环复随机振幅，其方差为 $\\mathbb{E}[|s|^{2}] = P$，且与加性噪声 $v \\sim \\mathcal{CN}(0, \\sigma^{2} I_{M})$ 无关。假设为大样本情况，因此协方差矩阵是真实的二阶矩，$R \\triangleq \\mathbb{E}[x x^{H}] = P\\,a(\\omega_{0}) a(\\omega_{0})^{H} + \\sigma^{2} I_{M}$。\n\n一个最小方差无畸变响应（MVDR，也称为 Capon）滤波器在假设频率 $\\omega = \\omega_{0} + \\Delta \\omega$ 处设计，使用的约束条件为 $w^{H} a(\\omega) = 1$。真实的 sinusoid（正弦信号）到达频率为 $\\omega_{0}$，因此真实正弦信号与假设的导向矢量之间存在失配 $\\Delta \\omega$。\n\n仅从优化命题“最小化 $w^{H} R w$，约束条件为 $w^{H} a(\\omega) = 1$”和基本的线性代数恒等式出发，解析地推导：\n- 真实正弦信号所经历的无畸变响应，$g(\\Delta \\omega) \\triangleq w^{H} a(\\omega_{0})$，以及\n- MVDR 输出方差 $v_{\\text{out}}(\\Delta \\omega) \\triangleq w^{H} R w$，\n\n两者都以 $M$、$P$、$\\sigma^{2}$ 和 $\\Delta \\omega$（以弧度为单位）的闭式解函数形式表示。然后简化以获得比率\n$$\n\\rho(\\Delta \\omega) \\triangleq \\frac{v_{\\text{out}}(\\Delta \\omega)}{v_{\\text{out}}(0)}.\n$$\n该比率量化了由于假设的频率失配导致的 MVDR 输出方差的性能下降。\n\n作为最终报告结果，请提供 $\\rho(\\Delta \\omega)$ 关于 $M$、$P$、$\\sigma^{2}$ 和 $\\Delta \\omega$（以弧度为单位）的单一简化闭式解析表达式。无需进行数值评估。角度以弧度表示。最终答案必须是单一的解析表达式；最终答案中不应包含不等式或等式。", "solution": "问题陈述需经过验证。\n\n**步骤1：提取已知条件**\n- 快照长度：$M$。\n- 导向矢量：$a(\\omega) \\triangleq [1, e^{-j \\omega}, e^{-j 2 \\omega}, \\dots, e^{-j (M-1)\\omega}]^{\\top}$。\n- 接收矢量模型：$x = s\\,a(\\omega_{0}) + v$。\n- 信号振幅 $s$：零均值循环复随机变量，方差为 $\\mathbb{E}[|s|^{2}] = P$。\n- 噪声矢量 $v$：加性的，$v \\sim \\mathcal{CN}(0, \\sigma^{2} I_{M})$，与 $s$ 无关。\n- 协方差矩阵：$R \\triangleq \\mathbb{E}[x x^{H}] = P\\,a(\\omega_{0}) a(\\omega_{0})^{H} + \\sigma^{2} I_{M}$。\n- MVDR 优化问题：最小化 $w^{H} R w$，约束条件为 $w^{H} a(\\omega) = 1$。\n- 滤波器设计的假设频率：$\\omega = \\omega_{0} + \\Delta \\omega$。\n- 真实信号频率：$\\omega_{0}$。\n- 失配：$\\Delta \\omega$。\n- 待推导的量：$g(\\Delta \\omega) \\triangleq w^{H} a(\\omega_{0})$ 和 $v_{\\text{out}}(\\Delta \\omega) \\triangleq w^{H} R w$。\n- 最终结果：比率 $\\rho(\\Delta \\omega) \\triangleq \\frac{v_{\\text{out}}(\\Delta \\omega)}{v_{\\text{out}}(0)}$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，提法得当，且是客观的。它描述了自适应阵列处理和谱估计中的一个典型问题——在存在导向矢量失配的情况下，对最小方差无畸变响应（MVDR）或 Capon 波束形成器的性能分析。该模型、定义和目标在信号处理文献中都是标准的。协方差矩阵的结构对于白噪声中的单个信号是正确的。滤波器权重的优化问题是 MVDR 滤波器的标准定义。所有必要的参数（$M$, $P$, $\\sigma^2$, $\\Delta\\omega$）均已提供。该问题没有矛盾、歧义或不成立的前提。\n\n**结论**\n问题有效，可以解决。\n\n**求解推导**\nMVDR 滤波器权重 $w$ 通过求解约束优化问题得到：\n$$ \\text{minimize} \\quad w^{H} R w \\quad \\text{subject to} \\quad w^{H} a(\\omega) = 1 $$\n其中 $\\omega = \\omega_{0} + \\Delta\\omega$。我们使用一个复数拉格朗日乘子 $\\lambda$ 构建拉格朗日函数：\n$$ \\mathcal{L}(w, \\lambda) = w^{H} R w - \\lambda(w^{H} a(\\omega) - 1) - \\lambda^{*}(a(\\omega)^{H} w - 1) $$\n为求最小值，我们计算关于 $w^{H}$ 的复梯度并将其置零：\n$$ \\frac{\\partial \\mathcal{L}}{\\partial w^{H}} = R w - \\lambda a(\\omega) = 0 $$\n这得到 $w = \\lambda R^{-1} a(\\omega)$。协方差矩阵 $R = P a(\\omega_{0}) a(\\omega_{0})^{H} + \\sigma^{2} I_{M}$ 在 $\\sigma^2 > 0$ 时是正定的，因此其逆矩阵存在。我们将 $w$ 代入约束条件来求解 $\\lambda$：\n$$ (\\lambda R^{-1} a(\\omega))^{H} a(\\omega) = 1 \\implies \\lambda^{*} a(\\omega)^{H} R^{-1} a(\\omega) = 1 $$\n由于 $R$ 是 Hermitian 矩阵， $R^{-1}$ 也是 Hermitian 矩阵，且标量 $a(\\omega)^{H} R^{-1} a(\\omega)$ 是实数。因此，$\\lambda = \\lambda^{*} = \\frac{1}{a(\\omega)^{H} R^{-1} a(\\omega)}$。\n最优权重矢量为：\n$$ w = \\frac{R^{-1} a(\\omega)}{a(\\omega)^{H} R^{-1} a(\\omega)} $$\nMVDR 输出方差 $v_{\\text{out}}(\\Delta \\omega)$ 是目标函数在最优 $w$ 处的值：\n$$ v_{\\text{out}}(\\Delta \\omega) = w^{H} R w = \\left(\\frac{R^{-1} a(\\omega)}{a(\\omega)^{H} R^{-1} a(\\omega)}\\right)^{H} R \\left(\\frac{R^{-1} a(\\omega)}{a(\\omega)^{H} R^{-1} a(\\omega)}\\right) = \\frac{a(\\omega)^{H} R^{-1} R R^{-1} a(\\omega)}{|a(\\omega)^{H} R^{-1} a(\\omega)|^{2}} = \\frac{1}{a(\\omega)^{H} R^{-1} a(\\omega)} $$\n为了继续，我们必须求 $R^{-1}$。矩阵 $R$ 是对一个缩放单位矩阵的秩-1 更新。我们使用 Sherman-Morrison 恒等式：$(A + uv^{H})^{-1} = A^{-1} - \\frac{A^{-1}uv^{H}A^{-1}}{1+v^{H}A^{-1}u}$。\n令 $A = \\sigma^2 I_M$，$u=P a(\\omega_0)$，以及 $v=a(\\omega_0)$。则 $A^{-1} = \\frac{1}{\\sigma^2}I_M$。\n$$ R^{-1} = \\frac{1}{\\sigma^2}I_M - \\frac{(\\frac{1}{\\sigma^2}I_M)(P a(\\omega_0)) (a(\\omega_0)^H)(\\frac{1}{\\sigma^2}I_M)}{1 + a(\\omega_0)^H (\\frac{1}{\\sigma^2}I_M) (P a(\\omega_0))} = \\frac{1}{\\sigma^2}I_M - \\frac{\\frac{P}{\\sigma^4} a(\\omega_0)a(\\omega_0)^H}{1 + \\frac{P}{\\sigma^2}a(\\omega_0)^H a(\\omega_0)} $$\n由于 $a(\\omega_0)^H a(\\omega_0) = M$，我们有：\n$$ R^{-1} = \\frac{1}{\\sigma^2}I_M - \\frac{P a(\\omega_0)a(\\omega_0)^H}{\\sigma^4(1 + PM/\\sigma^2)} = \\frac{1}{\\sigma^2}I_M - \\frac{P a(\\omega_0)a(\\omega_0)^H}{\\sigma^2(\\sigma^2 + PM)} $$\n现在我们计算 $v_{\\text{out}}(\\Delta \\omega)$ 的分母，即 $D(\\Delta \\omega) \\triangleq a(\\omega)^H R^{-1} a(\\omega)$：\n$$ D(\\Delta \\omega) = a(\\omega)^H \\left( \\frac{1}{\\sigma^2}I_M - \\frac{P a(\\omega_0)a(\\omega_0)^H}{\\sigma^2(\\sigma^2 + PM)} \\right) a(\\omega) $$\n$$ D(\\Delta \\omega) = \\frac{1}{\\sigma^2} a(\\omega)^H a(\\omega) - \\frac{P}{\\sigma^2(\\sigma^2 + PM)} |a(\\omega)^H a(\\omega_0)|^2 $$\n我们有 $a(\\omega)^H a(\\omega) = M$。内积 $a(\\omega)^H a(\\omega_0)$ 是：\n$$ a(\\omega)^H a(\\omega_0) = a(\\omega_0+\\Delta\\omega)^H a(\\omega_0) = \\sum_{k=0}^{M-1} e^{j(\\omega_0+\\Delta\\omega)k} e^{-j\\omega_0 k} = \\sum_{k=0}^{M-1} (e^{j\\Delta\\omega})^k $$\n这是一个几何级数求和，当 $\\Delta\\omega \\neq 0$ 时，其值为 $\\frac{1-e^{jM\\Delta\\omega}}{1-e^{j\\Delta\\omega}}$。其模的平方是：\n$$ |a(\\omega)^H a(\\omega_0)|^2 = \\left|\\frac{\\sin(M\\Delta\\omega/2)}{\\sin(\\Delta\\omega/2)}\\right|^2 = \\frac{\\sin^2(M\\Delta\\omega/2)}{\\sin^2(\\Delta\\omega/2)} $$\n这个表达式是狄利克雷核 (Dirichlet kernel) 的模平方。代入到 $D(\\Delta \\omega)$ 中：\n$$ D(\\Delta \\omega) = \\frac{M}{\\sigma^2} - \\frac{P}{\\sigma^2(\\sigma^2 + PM)} \\frac{\\sin^2(M\\Delta\\omega/2)}{\\sin^2(\\Delta\\omega/2)} $$\n所以，输出方差为：\n$$ v_{\\text{out}}(\\Delta \\omega) = \\frac{1}{D(\\Delta \\omega)} = \\left(\\frac{M}{\\sigma^2} - \\frac{P}{\\sigma^2(\\sigma^2 + PM)} \\frac{\\sin^2(M\\Delta\\omega/2)}{\\sin^2(\\Delta\\omega/2)}\\right)^{-1} $$\n接下来，我们推导对真实正弦信号的响应，$g(\\Delta\\omega) = w^H a(\\omega_0)$：\n$$ g(\\Delta\\omega) = \\frac{a(\\omega)^H R^{-1} a(\\omega_0)}{a(\\omega)^H R^{-1} a(\\omega)} $$\n分子是 $N(\\Delta\\omega) = a(\\omega)^H R^{-1} a(\\omega_0)$：\n$$ N(\\Delta\\omega) = a(\\omega)^H \\left( \\frac{1}{\\sigma^2}I_M - \\frac{P a(\\omega_0)a(\\omega_0)^H}{\\sigma^2(\\sigma^2 + PM)} \\right) a(\\omega_0) = \\frac{1}{\\sigma^2} a(\\omega)^H a(\\omega_0) - \\frac{P(a(\\omega)^H a(\\omega_0))(a(\\omega_0)^H a(\\omega_0))}{\\sigma^2(\\sigma^2 + PM)} = a(\\omega)^H a(\\omega_0) \\left( \\frac{1}{\\sigma^2} - \\frac{PM}{\\sigma^2(\\sigma^2 + PM)} \\right) = \\frac{a(\\omega)^H a(\\omega_0)}{\\sigma^2 + PM} $$\n因此，\n$$ g(\\Delta \\omega) = \\frac{a(\\omega)^H a(\\omega_0)/(\\sigma^2 + PM)}{D(\\Delta \\omega)} = \\frac{\\frac{1}{\\sigma^2+PM} \\frac{1-e^{jM\\Delta\\omega}}{1-e^{j\\Delta\\omega}}}{\\frac{M}{\\sigma^2} - \\frac{P}{\\sigma^2(\\sigma^2 + PM)} \\frac{\\sin^2(M\\Delta\\omega/2)}{\\sin^2(\\Delta\\omega/2)}} $$\n为了求出比率 $\\rho(\\Delta\\omega)$，我们需要 $v_{\\text{out}}(0)$，它对应于 $\\Delta\\omega=0$ 的情况。在这种情况下，$a(\\omega) = a(\\omega_0)$，所以 $|a(\\omega)^H a(\\omega_0)|^2 = |a(\\omega_0)^H a(\\omega_0)|^2 = M^2$。\n$$ D(0) = \\frac{M}{\\sigma^2} - \\frac{P M^2}{\\sigma^2(\\sigma^2 + PM)} = \\frac{M(\\sigma^2+PM) - PM^2}{\\sigma^2(\\sigma^2+PM)} = \\frac{M\\sigma^2}{\\sigma^2(\\sigma^2+PM)} = \\frac{M}{\\sigma^2+PM} $$\n所以，$v_{\\text{out}}(0) = \\frac{1}{D(0)} = \\frac{\\sigma^2+PM}{M} = P + \\frac{\\sigma^2}{M}$。\n该比率为 $\\rho(\\Delta\\omega) = \\frac{v_{\\text{out}}(\\Delta \\omega)}{v_{\\text{out}}(0)} = \\frac{D(0)}{D(\\Delta \\omega)}$：\n$$ \\rho(\\Delta\\omega) = \\frac{\\frac{M}{\\sigma^2+PM}}{\\frac{M}{\\sigma^2} - \\frac{P}{\\sigma^2(\\sigma^2 + PM)} \\frac{\\sin^2(M\\Delta\\omega/2)}{\\sin^2(\\Delta\\omega/2)}} $$\n将分子和分母同乘以 $\\sigma^2(\\sigma^2+PM)$ 得到：\n$$ \\rho(\\Delta\\omega) = \\frac{M\\sigma^2}{M(\\sigma^2+PM) - P \\frac{\\sin^2(M\\Delta\\omega/2)}{\\sin^2(\\Delta\\omega/2)}} = \\frac{M\\sigma^2}{M\\sigma^2 + M^2 P - P \\frac{\\sin^2(M\\Delta\\omega/2)}{\\sin^2(\\Delta\\omega/2)}} $$\n$$ \\rho(\\Delta\\omega) = \\frac{M\\sigma^2}{M\\sigma^2 + P\\left(M^2 - \\frac{\\sin^2(M\\Delta\\omega/2)}{\\sin^2(\\Delta\\omega/2)}\\right)} $$\n这就是最终的简化闭式表达式。", "answer": "$$\n\\boxed{\\frac{M\\sigma^{2}}{M\\sigma^{2} + P\\left(M^{2} - \\frac{\\sin^{2}(M\\Delta\\omega/2)}{\\sin^{2}(\\Delta\\omega/2)}\\right)}}\n$$", "id": "2883242"}, {"introduction": "为了应对导向矢量失配和使用有限样本估计协方差矩阵所带来的不稳定性，一种被称为“对角加载”的正则化技术被广泛应用。通过在协方差矩阵的对角线上增加一个小的正值 $\\delta$，该方法可以显著提高 MVDR 估计器的鲁棒性。本练习将通过推导加载后的权重和谱估计，帮助您理解对角加载的工作原理，并精确量化其在特定信号模型下引入的偏差。[@problem_id:2883258]", "problem": "考虑一个具有 $M$ 个传感器的窄带阵列处理场景。令 $\\hat{R} \\in \\mathbb{C}^{M \\times M}$ 表示数据协方差矩阵的正定估计，令 $a(\\omega) \\in \\mathbb{C}^{M}$ 表示在空间角频率 $\\omega$ 处的导向矢量。频率 $\\omega$ 处的最小方差无失真响应（MVDR，也称为 Capon）谱估计器是通过求解一个约束二次规划问题得到的，该问题旨在最小化阵列输出功率，同时满足对 $a(\\omega)$ 的无失真响应约束。为了提高鲁棒性，应用对角加载来形成加载后的协方差矩阵 $\\hat{R}_{\\delta} \\triangleq \\hat{R} + \\delta I$，其中 $\\delta > 0$ 且 $I$ 是单位矩阵。\n\n从约束二次最小化的定义和针对复向量的标准 Karush–Kuhn–Tucker 最优性条件出发，执行以下操作：\n\n1) 推导最优权重向量 $w_{\\delta}(\\omega)$，该向量在约束 $a^{H}(\\omega) w = 1$ 下最小化 $w^{H} \\hat{R}_{\\delta} w$。\n\n2) 使用您的结果，推导在频率 $\\omega$ 处对应的 Capon 谱估计 $P_{\\text{MVDR},\\delta}(\\omega)$。\n\n3) 现在，对于真实信号频率 $\\omega_{0}$ 处的真实协方差，采用单信号加白噪声模型：\n$$\nR \\;=\\; \\sigma_{s}^{2}\\, a(\\omega_{0}) a^{H}(\\omega_{0}) \\;+\\; \\sigma_{n}^{2}\\, I,\n$$\n其中 $\\sigma_{s}^{2} > 0$ 是信号功率，$\\sigma_{n}^{2} > 0$ 是噪声功率，并假设扫描导向矢量在 $\\omega_{0}$ 处与真实导向矢量相等，即使用相同的 $a(\\omega_{0})$ 在 $\\omega = \\omega_{0}$ 处评估频谱。在此模型下，通过计算以下公式，明确量化加载后频谱与未正则化频谱之间的偏差：\n$$\n\\Delta P(\\omega_{0}) \\;\\triangleq\\; P_{\\text{MVDR},\\delta}(\\omega_{0}) \\;-\\; P_{\\text{MVDR}}(\\omega_{0}),\n$$\n将其表示为关于 $\\delta$、$\\sigma_{s}^{2}$、$\\sigma_{n}^{2}$ 和 $a(\\omega_{0})$ 的闭式解析表达式。将 $\\Delta P(\\omega_{0})$ 的最终答案表示为单个简化的符号表达式。不要包含单位。\n\n您的最终答案必须是单个闭式表达式。无需四舍五入。", "solution": "所提出的问题是阵列信号处理中的一个标准练习，特别是在自适应波束形成和谱估计领域。该问题具有科学依据、提法明确且客观。没有不一致或模糊之处。问题是有效的，可以通过直接应用优化理论和矩阵代数来解决。\n\n任务是推导对角加载对最小方差无失真响应（MVDR）谱估计器的影响。给定加载后的协方差矩阵 $\\hat{R}_{\\delta} = \\hat{R} + \\delta I$。分析过程分为三个不同的部分。\n\n第 1 部分：最优权重向量 $w_{\\delta}(\\omega)$ 的推导\n\n该问题是一个约束二次最小化问题：\n$$\n\\min_{w} w^{H} \\hat{R}_{\\delta} w \\quad \\text{subject to} \\quad a^{H}(\\omega) w = 1\n$$\n其中 $w \\in \\mathbb{C}^{M}$ 是权重向量，$\\hat{R}_{\\delta} \\in \\mathbb{C}^{M \\times M}$ 是正定的加载后协方差矩阵，而 $a(\\omega) \\in \\mathbb{C}^{M}$ 是导向矢量。\n\n我们为这个优化问题构建拉格朗日函数。目标函数 $J(w) = w^{H} \\hat{R}_{\\delta} w$ 是实值的。约束 $c(w) = a^{H}(\\omega) w - 1 = 0$ 是复值的。拉格朗日函数由下式给出：\n$$\n\\mathcal{L}(w, \\lambda) = w^{H} \\hat{R}_{\\delta} w + \\lambda (a^{H}(\\omega) w - 1) + \\lambda^{*} (w^{H} a(\\omega) - 1)\n$$\n这里，$\\lambda$ 是一个复数拉格朗日乘子。Karush-Kuhn-Tucker (KKT) 最优性条件要求拉格朗日函数相对于 $w^{*}$（$w$的共轭）的梯度为零。使用 Wirtinger 演算，我们求复梯度：\n$$\n\\nabla_{w^{*}} \\mathcal{L}(w, \\lambda) = \\hat{R}_{\\delta} w + \\lambda a(\\omega)\n$$\n将此梯度设为零，得到第一个最优性条件：\n$$\n\\hat{R}_{\\delta} w + \\lambda a(\\omega) = 0\n$$\n由于 $\\hat{R}$ 是正定的且 $\\delta > 0$，加载后的矩阵 $\\hat{R}_{\\delta} = \\hat{R} + \\delta I$ 也是正定的，因此是可逆的。我们可以解出 $w$：\n$$\nw = -\\lambda \\hat{R}_{\\delta}^{-1} a(\\omega)\n$$\n为了确定拉格朗日乘子 $\\lambda$，我们应用无失真响应约束 $a^{H}(\\omega) w = 1$：\n$$\na^{H}(\\omega) \\left( -\\lambda \\hat{R}_{\\delta}^{-1} a(\\omega) \\right) = 1\n$$\n$$\n-\\lambda \\left( a^{H}(\\omega) \\hat{R}_{\\delta}^{-1} a(\\omega) \\right) = 1\n$$\n项 $a^{H}(\\omega) \\hat{R}_{\\delta}^{-1} a(\\omega)$ 是一个正实数标量，因为 $\\hat{R}_{\\delta}^{-1}$ 是正定的。解出 $\\lambda$：\n$$\n\\lambda = -\\frac{1}{a^{H}(\\omega) \\hat{R}_{\\delta}^{-1} a(\\omega)}\n$$\n将 $\\lambda$ 的这个表达式代回到 $w$ 的方程中，我们得到最优权重向量：\n$$\nw_{\\delta}(\\omega) = \\frac{\\hat{R}_{\\delta}^{-1} a(\\omega)}{a^{H}(\\omega) \\hat{R}_{\\delta}^{-1} a(\\omega)}\n$$\n\n第 2 部分：Capon 谱估计 $P_{\\text{MVDR},\\delta}(\\omega)$ 的推导\n\nMVDR 谱估计定义为阵列的最小输出功率，该功率由最优权重向量 $w_{\\delta}(\\omega)$ 实现。功率由 $P = w^{H} \\hat{R}_{\\delta} w$ 给出。因此：\n$$\nP_{\\text{MVDR},\\delta}(\\omega) = w_{\\delta}^{H}(\\omega) \\hat{R}_{\\delta} w_{\\delta}(\\omega)\n$$\n我们代入 $w_{\\delta}(\\omega)$ 的表达式：\n$$\nP_{\\text{MVDR},\\delta}(\\omega) = \\left( \\frac{\\hat{R}_{\\delta}^{-1} a(\\omega)}{a^{H}(\\omega) \\hat{R}_{\\delta}^{-1} a(\\omega)} \\right)^{H} \\hat{R}_{\\delta} \\left( \\frac{\\hat{R}_{\\delta}^{-1} a(\\omega)}{a^{H}(\\omega) \\hat{R}_{\\delta}^{-1} a(\\omega)} \\right)\n$$\n分母是一个标量，所以可以提取出来。由于它是实数，它的共轭就是它自身。\n$$\nP_{\\text{MVDR},\\delta}(\\omega) = \\frac{ (a^{H}(\\omega) (\\hat{R}_{\\delta}^{-1})^{H}) \\hat{R}_{\\delta} (\\hat{R}_{\\delta}^{-1} a(\\omega)) }{ (a^{H}(\\omega) \\hat{R}_{\\delta}^{-1} a(\\omega))^{2} }\n$$\n加载后的协方差矩阵 $\\hat{R}_{\\delta}$ 是 Hermitian 矩阵，所以它的逆矩阵 $(\\hat{R}_{\\delta}^{-1})$ 也是 Hermitian 矩阵，即 $(\\hat{R}_{\\delta}^{-1})^{H} = \\hat{R}_{\\delta}^{-1}$。分子可以简化为：\n$$\na^{H}(\\omega) \\hat{R}_{\\delta}^{-1} \\hat{R}_{\\delta} \\hat{R}_{\\delta}^{-1} a(\\omega) = a^{H}(\\omega) I \\hat{R}_{\\delta}^{-1} a(\\omega) = a^{H}(\\omega) \\hat{R}_{\\delta}^{-1} a(\\omega)\n$$\n将此结果代回到功率的表达式中：\n$$\nP_{\\text{MVDR},\\delta}(\\omega) = \\frac{a^{H}(\\omega) \\hat{R}_{\\delta}^{-1} a(\\omega)}{(a^{H}(\\omega) \\hat{R}_{\\delta}^{-1} a(\\omega))^{2}} = \\frac{1}{a^{H}(\\omega) \\hat{R}_{\\delta}^{-1} a(\\omega)}\n$$\n这是 Capon 谱估计的著名表达式。\n\n第 3 部分：量化偏差 $\\Delta P(\\omega_0)$\n\n我们现在从业界估计的协方差 $\\hat{R}$ 转向一个理论上的真实协方差矩阵 $R$，该矩阵用于描述在白噪声存在下频率为 $\\omega_0$ 的单个信号：\n$$\nR = \\sigma_{s}^{2}\\, a(\\omega_{0}) a^{H}(\\omega_{0}) + \\sigma_{n}^{2}\\, I\n$$\n未正则化的频谱 $P_{\\text{MVDR}}(\\omega_0)$ 使用 $R$ 得到，而加载后的频谱 $P_{\\text{MVDR},\\delta}(\\omega_0)$ 使用 $R_{\\delta} = R + \\delta I$ 得到。\n我们需要计算 $P_{\\text{MVDR}}(\\omega_0) = (a_{0}^{H} R^{-1} a_{0})^{-1}$ 和 $P_{\\text{MVDR},\\delta}(\\omega_0) = (a_{0}^{H} R_{\\delta}^{-1} a_{0})^{-1}$，其中 $a_0 \\triangleq a(\\omega_0)$。\n\n首先，我们求 $R^{-1}$。我们使用 Sherman-Morrison 矩阵求逆引理：$(A + uv^H)^{-1} = A^{-1} - \\frac{A^{-1}uv^H A^{-1}}{1 + v^H A^{-1} u}$。\n对于 $R$，我们定义 $A = \\sigma_{n}^{2} I$，$u = \\sigma_{s}^{2} a_0$ 和 $v = a_0$。那么 $A^{-1} = \\frac{1}{\\sigma_{n}^{2}}I$。\n逆矩阵是：\n$$\nR^{-1} = \\frac{1}{\\sigma_{n}^{2}}I - \\frac{(\\frac{1}{\\sigma_{n}^{2}}I)(\\sigma_{s}^{2} a_0) a_0^H (\\frac{1}{\\sigma_{n}^{2}}I)}{1 + a_0^H (\\frac{1}{\\sigma_{n}^{2}}I) (\\sigma_{s}^{2} a_0)} = \\frac{1}{\\sigma_{n}^{2}}I - \\frac{\\frac{\\sigma_{s}^{2}}{(\\sigma_{n}^{2})^2} a_0 a_0^H}{1 + \\frac{\\sigma_{s}^{2}}{\\sigma_{n}^{2}} a_0^H a_0} = \\frac{1}{\\sigma_{n}^{2}}I - \\frac{\\sigma_{s}^{2} a_0 a_0^H}{\\sigma_{n}^{2}(\\sigma_{n}^{2} + \\sigma_{s}^{2} a_0^H a_0)}\n$$\n现在我们计算二次型 $a_0^H R^{-1} a_0$：\n$$\na_0^H R^{-1} a_0 = a_0^H \\left( \\frac{1}{\\sigma_{n}^{2}}I - \\frac{\\sigma_{s}^{2} a_0 a_0^H}{\\sigma_{n}^{2}(\\sigma_{n}^{2} + \\sigma_{s}^{2} a_0^H a_0)} \\right) a_0\n$$\n$$\n= \\frac{1}{\\sigma_{n}^{2}} a_0^H a_0 - \\frac{\\sigma_{s}^{2} (a_0^H a_0) (a_0^H a_0)}{\\sigma_{n}^{2}(\\sigma_{n}^{2} + \\sigma_{s}^{2} a_0^H a_0)} = \\frac{a_0^H a_0}{\\sigma_{n}^{2}} \\left( 1 - \\frac{\\sigma_{s}^{2} a_0^H a_0}{\\sigma_{n}^{2} + \\sigma_{s}^{2} a_0^H a_0} \\right)\n$$\n$$\n= \\frac{a_0^H a_0}{\\sigma_{n}^{2}} \\left( \\frac{(\\sigma_{n}^{2} + \\sigma_{s}^{2} a_0^H a_0) - \\sigma_{s}^{2} a_0^H a_0}{\\sigma_{n}^{2} + \\sigma_{s}^{2} a_0^H a_0} \\right) = \\frac{a_0^H a_0}{\\sigma_{n}^{2}} \\left( \\frac{\\sigma_{n}^{2}}{\\sigma_{n}^{2} + \\sigma_{s}^{2} a_0^H a_0} \\right) = \\frac{a_0^H a_0}{\\sigma_{n}^{2} + \\sigma_{s}^{2} a_0^H a_0}\n$$\n未正则化的谱估计是该表达式的倒数：\n$$\nP_{\\text{MVDR}}(\\omega_0) = \\frac{\\sigma_{n}^{2} + \\sigma_{s}^{2} a_0^H a_0}{a_0^H a_0} = \\sigma_{s}^{2} + \\frac{\\sigma_{n}^{2}}{a_0^H a_0}\n$$\n对于加载后的情况，协方差为 $R_{\\delta} = R + \\delta I = \\sigma_{s}^{2} a_0 a_0^H + (\\sigma_{n}^{2} + \\delta)I$。这与 $R$ 的形式相同，只是 $\\sigma_{n}^{2}$ 被 $(\\sigma_{n}^{2} + \\delta)$ 替代。因此，我们可以通过直接代入得到加载后的谱估计：\n$$\nP_{\\text{MVDR},\\delta}(\\omega_0) = \\sigma_{s}^{2} + \\frac{\\sigma_{n}^{2} + \\delta}{a_0^H a_0}\n$$\n最后，我们计算偏差 $\\Delta P(\\omega_0)$：\n$$\n\\Delta P(\\omega_0) = P_{\\text{MVDR},\\delta}(\\omega_0) - P_{\\text{MVDR}}(\\omega_0)\n$$\n$$\n= \\left(\\sigma_{s}^{2} + \\frac{\\sigma_{n}^{2} + \\delta}{a_0^H a_0}\\right) - \\left(\\sigma_{s}^{2} + \\frac{\\sigma_{n}^{2}}{a_0^H a_0}\\right)\n$$\n$$\n= \\frac{\\sigma_{n}^{2} + \\delta}{a_0^H a_0} - \\frac{\\sigma_{n}^{2}}{a_0^H a_0} = \\frac{\\sigma_{n}^{2} + \\delta - \\sigma_{n}^{2}}{a_0^H a_0}\n$$\n结果非常简洁，因为涉及信号和噪声功率的项都抵消了。\n$$\n\\Delta P(\\omega_0) = \\frac{\\delta}{a_0^H a_0} = \\frac{\\delta}{a^{H}(\\omega_{0})a(\\omega_{0})}\n$$\n这表明，对于在真实信号方向上评估的单信号模型，由对角加载引入的偏差与信号和噪声功率均无关。它仅取决于加载因子 $\\delta$ 和导向矢量的欧几里得范数的平方。", "answer": "$$\n\\boxed{\\frac{\\delta}{a^{H}(\\omega_{0}) a(\\omega_{0})}}\n$$", "id": "2883258"}]}