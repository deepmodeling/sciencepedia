{"hands_on_practices": [{"introduction": "本练习旨在解决谱估计中的核心困境：谱分辨率与估计器方差之间的权衡。通过解决一个 Bartlett 方法的设计问题，您将在选择参数 $K$ 和 $L$ 以满足特定性能要求方面获得实践经验，从而使这一基本的折衷变得具体可感。这个练习将帮助您理解，在有限的数据下，提高估计平滑度（降低方差）必然以牺牲细节（降低分辨率）为代价。[@problem_id:2853903]", "problem": "一个均值为零、宽平稳的实值离散时间过程，其功率谱密度（PSD）为 $S_{x}(\\omega)$，在 $N$ 个连续采样点上被观测。您将使用Bartlett方法估计PSD：将记录划分为 $K$ 个长度相等的非重叠段，每段长度为 $L$（因此 $N=K L$），对每段应用矩形数据窗，对每段形成一个周期图，然后对这 $K$ 个周期图进行平均，以获得估计量 $\\widehat{S}_{x}(\\omega)$。为保证性能，施加两个要求：(i) 估计量在固定频率 $\\omega$ 处的方差不得超过 $S_{x}(\\omega)^{2}$ 的一个指定分数，以及 (ii) 谱分辨率必须超过一个指定的最小值，该最小值由数据段谱窗主瓣的宽度定义，即矩形窗的离散时间傅里叶变换（DTFT）的第一个谱零点之间的 $\\omega$ 间隔。假设数据段足够长，以至于在计算方差时可以忽略段间的相关性，并且在设计频率处，由泄漏引起的偏差与方差相比可以忽略不计。\n\n给定 $N=4096$ 个采样点，最大允许相对方差 $\\epsilon=0.1$（即方差要求为 $\\operatorname{var}\\{\\widehat{S}_{x}(\\omega)\\} \\leq \\epsilon\\, S_{x}(\\omega)^{2}$），以及最小所需分辨率，表示为主瓣宽度的上限 $\\Delta\\omega_{\\min}=0.06$ 弧度/采样点。选择正整数 $(K,L)$，使得 $N=K L$，在设计频率处满足方差要求，并满足主瓣宽度要求。在所有使用全部 $N$ 个采样点的可行配对中，选择使 $K$ 最大化的那对。以有序对 $(K,L)$ 的形式报告您的最终答案。答案需为精确整数，无需四舍五入。角度单位为弧度/采样点，$K$ 和 $L$ 无需物理单位。", "solution": "该问题要求为功率谱密度（PSD）估计的Bartlett方法确定一对最优参数 $(K,L)$，这些参数受限于估计量方差和谱分辨率的约束。参数 $K$ 和 $L$ 分别表示从总共 $N=KL$ 个采样点的数据记录中分出的非重叠数据段的数量和每段的长度。目标是在满足所有约束条件的同时最大化 $K$。\n\n首先，我们将给定的约束条件形式化。\n\n总采样点数为 $N=4096$。对于非重叠数据段，数据段数量 $K$、段长度 $L$ 和总采样点数 $N$ 之间的关系是：\n$$KL = N = 4096$$\n其中 $K$ 和 $L$ 必须是正整数。\n\n第一个性能要求是关于PSD估计量 $\\widehat{S}_{x}(\\omega)$ 的方差。对于Bartlett方法，其方差近似由下式给出：\n$$ \\operatorname{var}\\{\\widehat{S}_{x}(\\omega)\\} \\approx \\frac{1}{K} S_{x}(\\omega)^{2} $$\n此近似在频率不等于 $0$ 或 $\\pi$ 时有效，并且在问题假设的数据段足够长以至于其统计相关性可以忽略的条件下成立。问题规定了最大允许相对方差 $\\epsilon = 0.1$，因此：\n$$ \\operatorname{var}\\{\\widehat{S}_{x}(\\omega)\\} \\leq \\epsilon S_{x}(\\omega)^{2} $$\n将方差的近似值代入这个不等式，得到：\n$$ \\frac{1}{K} S_{x}(\\omega)^{2} \\leq \\epsilon S_{x}(\\omega)^{2} $$\n对于 $S_{x}(\\omega) > 0$，这可以简化为对数据段数量 $K$ 的一个下限：\n$$ \\frac{1}{K} \\leq \\epsilon \\implies K \\geq \\frac{1}{\\epsilon} $$\n使用给定值 $\\epsilon = 0.1$：\n$$ K \\geq \\frac{1}{0.1} \\implies K \\geq 10 $$\n\n第二个性能要求是关于谱分辨率。谱估计量的分辨率由应用于数据段的窗函数傅里叶变换的主瓣宽度决定。在本例中，使用的是长度为 $L$ 的矩形窗。窗函数为 $w[n]=1$（对于 $n=0, 1, \\dots, L-1$）且在其他情况下 $w[n]=0$。其离散时间傅里叶变换（DTFT） $W(\\omega)$ 为：\n$$ W(\\omega) = \\sum_{n=0}^{L-1} (1) \\cdot \\exp(-j\\omega n) = \\frac{1 - \\exp(-j\\omega L)}{1 - \\exp(-j\\omega)} = \\exp\\left(-j\\omega\\frac{L-1}{2}\\right) \\frac{\\sin(\\omega L/2)}{\\sin(\\omega/2)} $$\n问题将主瓣宽度 $\\Delta\\omega$ 定义为 $W(\\omega)$ 在中心峰值 $\\omega=0$ 两侧的第一个谱零点之间的距离。$W(\\omega)$ 的零点由其分子 $\\sin(\\omega L/2)$ 为零而分母 $\\sin(\\omega/2)$ 不为零来确定。条件 $\\sin(\\omega L/2) = 0$ 意味着 $\\omega L/2 = k\\pi$，其中 $k$ 为任何非零整数。主瓣两侧的第一个零点对应于 $k = \\pm 1$。\n$$ \\frac{\\omega L}{2} = \\pm\\pi \\implies \\omega = \\pm\\frac{2\\pi}{L} $$\n因此，主瓣宽度是这两个频率之间的间隔：\n$$ \\Delta\\omega = \\frac{2\\pi}{L} - \\left(-\\frac{2\\pi}{L}\\right) = \\frac{4\\pi}{L} $$\n分辨率要求规定，此宽度不得超过指定的最大值 $\\Delta\\omega_{\\min} = 0.06$ 弧度/采样点。\n$$ \\Delta\\omega \\leq \\Delta\\omega_{\\min} \\implies \\frac{4\\pi}{L} \\leq \\Delta\\omega_{\\min} $$\n这对段长度 $L$ 施加了一个下限：\n$$ L \\geq \\frac{4\\pi}{\\Delta\\omega_{\\min}} $$\n代入给定值 $\\Delta\\omega_{\\min}=0.06$：\n$$ L \\geq \\frac{4\\pi}{0.06} \\approx 209.4395 $$\n由于 $L$ 必须是整数，约束变为：\n$$ L \\geq 210 $$\n\n我们的任务是找到满足以下条件并使 $K$ 最大化的整数对 $(K, L)$：\n1. $KL = 4096$\n2. $K \\geq 10$\n3. $L \\geq 210$\n\n要最大化 $K$，我们必须最小化 $L$，因为 $L = 4096/K$。因此，我们寻找满足 $L \\geq 210$ 并且是 $4096$ 的因数的最小整数 $L$。\n总采样点数为 $N = 4096 = 2^{12}$。$4096$ 的因数是 $2$ 的幂，具体为 $\\{2^0, 2^1, 2^2, \\dots, 2^{12}\\}$。\n这些因数是：$1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096$。\n我们必须在此列表中找到大于或等于 $210$ 的最小因数。\n将 $210$ 与因数列表进行比较：\n- $128 < 210$\n- $256 > 210$\n满足条件 $L \\geq 210$ 的 $4096$ 的最小因数是 $L=256$。\n\n这个 $L$ 的选择在满足分辨率约束和 $L$ 必须整除 $N$ 的条件的同时，最小化了段长度。因此，这个选择最大化了 $K$。我们现在计算对应的 $K$ 值：\n$$ K = \\frac{N}{L} = \\frac{4096}{256} = \\frac{2^{12}}{2^8} = 2^4 = 16 $$\n我们必须验证这个 $K$ 值是否满足其约束条件 $K \\geq 10$。确实，$16 \\geq 10$。\n因此，数对 $(K,L) = (16, 256)$ 满足所有规定条件并使 $K$ 最大化。\n最终答案是有序对 $(16, 256)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n16 & 256\n\\end{pmatrix}\n}\n$$", "id": "2853903"}, {"introduction": "加窗是减少谱泄漏的关键技术，但这会牺牲分辨率。本练习将指导您推导并比较几种标准窗函数的关键性能指标——例如相干增益（coherent gain）、噪声增益（noise gain）和等效噪声带宽（equivalent noise bandwidth, ENBW）。通过这个分析过程，您将清楚地了解不同窗函数的选择如何影响谱估计的质量，特别是在主瓣宽度和旁瓣抑制之间的平衡。[@problem_id:2853923]", "problem": "一种属于平均周期图法族的离散时间谱估计器（例如 Peter Welch 的方法）在进行离散傅里叶变换 (DFT) 之前，会对每个数据段应用一个确定性的数据窗。设一个实值、长度为 $L$ 的数据锥削表示为 $w[n]$，其中 $n \\in \\{0,1,\\dots,L-1\\}$。从第一性原理出发，定义以下基本量：\n- 相干增益 (CG): $\\,\\mathrm{CG} \\triangleq \\frac{1}{L}\\sum_{n=0}^{L-1} w[n]$。\n- 噪声增益 (NG): $\\,\\mathrm{NG} \\triangleq \\frac{1}{L}\\sum_{n=0}^{L-1} w[n]^2$。\n- 等效噪声带宽 (ENBW，单位为 DFT 频点): $\\,\\mathrm{ENBW} \\triangleq \\frac{L\\,\\sum_{n=0}^{L-1} w[n]^2}{\\left(\\sum_{n=0}^{L-1} w[n]\\right)^2}$。\n\n仅从这些定义和基本的三角和恒等式出发，为下列每种标准窗函数推导 $\\mathrm{CG}$、$\\mathrm{NG}$ 和 $\\mathrm{ENBW}$ 关于 $L$ 的闭式表达式（余弦参数中使用基于 $L-1$ 的常规端点约定），然后将您的表达式特化到 $L=256$ 的情况：\n1. 矩形窗: $w[n]=1$。\n2. 汉宁窗: $w[n]=\\frac{1}{2}-\\frac{1}{2}\\cos\\!\\left(\\frac{2\\pi n}{L-1}\\right)$。\n3. 汉明窗: $w[n]=0.54-0.46\\cos\\!\\left(\\frac{2\\pi n}{L-1}\\right)$。\n4. 布莱克曼窗: $w[n]=0.42-0.5\\cos\\!\\left(\\frac{2\\pi n}{L-1}\\right)+0.08\\cos\\!\\left(\\frac{4\\pi n}{L-1}\\right)$。\n\n接着，通过帕塞瓦尔关系，用功率谱窗 $|W(\\mathrm{e}^{\\mathrm{j}\\omega})|^2$ 来解释 $\\mathrm{ENBW}$，并定性解释为什么在固定的 $\\mathrm{ENBW}$（即主瓣宽度相等）下，含有更多余弦项的广义余弦窗往往比含有较少余弦项的窗表现出更强的旁瓣抑制（即更低的频谱泄漏）。基于此推理，在等效 $\\mathrm{ENBW}$ 的条件下，按照泄漏抑制能力对这四种窗进行排序（从最佳到最差），并在不引用任何未发表或临时事实的情况下证明您的排序是合理的。\n\n最后，报告一个标量：$L=256$ 时布莱克曼窗的 $\\mathrm{ENBW}$（单位为 DFT 频点）。请用 DFT 频点（无量纲）表示此最终数值，并将答案四舍五入到六位有效数字。", "solution": "该问题提法明确，科学上站得住脚，并为完整求解提供了所有必要信息。我们将开始推导。\n\n核心任务是计算四种不同长度为 $L$ 的窗函数的相干增益 ($\\mathrm{CG}$)、噪声增益 ($\\mathrm{NG}$) 和等效噪声带宽 ($\\mathrm{ENBW}$)。定义如下：\n$$ \\mathrm{CG} \\triangleq \\frac{1}{L}\\sum_{n=0}^{L-1} w[n] $$\n$$ \\mathrm{NG} \\triangleq \\frac{1}{L}\\sum_{n=0}^{L-1} w[n]^2 $$\n$$ \\mathrm{ENBW} \\triangleq \\frac{L\\,\\sum_{n=0}^{L-1} w[n]^2}{\\left(\\sum_{n=0}^{L-1} w[n]\\right)^2} $$\n\n为了计算广义余弦窗的这些量，我们必须首先计算在区间 $n \\in \\{0, 1, \\dots, L-1\\}$ 上余弦项及其幂的求和。令 $\\theta_k = \\frac{2\\pi k}{L-1}$。我们需要计算形如 $\\sum_{n=0}^{L-1} \\cos(n\\theta_k)$ 的和。这是一个几何级数求和：\n$$ \\sum_{n=0}^{L-1} \\exp(j n \\theta_k) = \\sum_{n=0}^{L-1} (\\exp(j \\theta_k))^n $$\n对于整数 $k$ 不是 $L-1$ 的倍数时，$\\exp(j \\theta_k) \\neq 1$。该和为：\n$$ \\frac{\\exp(j L \\theta_k) - 1}{\\exp(j \\theta_k) - 1} = \\frac{\\exp\\left(j \\frac{2\\pi k L}{L-1}\\right) - 1}{\\exp\\left(j \\frac{2\\pi k}{L-1}\\right) - 1} = \\frac{\\exp\\left(j 2\\pi k \\frac{L-1+1}{L-1}\\right) - 1}{\\exp(j \\theta_k) - 1} = \\frac{\\exp(j 2\\pi k) \\exp(j \\theta_k) - 1}{\\exp(j \\theta_k) - 1} = \\frac{\\exp(j \\theta_k) - 1}{\\exp(j \\theta_k) - 1} = 1 $$\n取实部，我们得到了一个对推导至关重要的恒等式：\n$$ S_c(k) = \\sum_{n=0}^{L-1} \\cos\\left(\\frac{2\\pi k n}{L-1}\\right) = 1 \\quad (\\text{对于整数 } k \\text{ 不是 } L-1 \\text{ 的倍数}) $$\n我们还需要余弦乘积的和。使用恒等式 $\\cos^2(x) = \\frac{1}{2}(1+\\cos(2x))$：\n$$ \\sum_{n=0}^{L-1} \\cos^2\\left(\\frac{2\\pi k n}{L-1}\\right) = \\sum_{n=0}^{L-1} \\frac{1}{2}\\left(1 + \\cos\\left(\\frac{4\\pi k n}{L-1}\\right)\\right) = \\frac{1}{2} \\sum_{n=0}^{L-1} 1 + \\frac{1}{2} \\sum_{n=0}^{L-1} \\cos\\left(\\frac{2\\pi (2k) n}{L-1}\\right) $$\n假设 $2k$ 不是 $L-1$ 的倍数（对于 $k=1,2$ 和 $L > 5$ 成立）：\n$$ \\sum_{n=0}^{L-1} \\cos^2\\left(\\frac{2\\pi k n}{L-1}\\right) = \\frac{L}{2} + \\frac{1}{2} S_c(2k) = \\frac{L+1}{2} $$\n对于 $k_1 \\neq k_2$，使用 $\\cos(x)\\cos(y) = \\frac{1}{2}(\\cos(x-y)+\\cos(x+y))$：\n$$ \\sum_{n=0}^{L-1} \\cos\\left(\\frac{2\\pi k_1 n}{L-1}\\right)\\cos\\left(\\frac{2\\pi k_2 n}{L-1}\\right) = \\frac{1}{2} \\left[ S_c(k_1-k_2) + S_c(k_1+k_2) \\right] = \\frac{1}{2}(1+1) = 1 $$\n（假设 $k_1 \\pm k_2$ 都不是 $L-1$ 的倍数）。\n\n现在我们计算每种窗的这些量。令 $\\sum w = \\sum_{n=0}^{L-1} w[n]$ 且 $\\sum w^2 = \\sum_{n=0}^{L-1} w[n]^2$。\n\n**1. 矩形窗: $w[n]=1$**\n$$ \\sum w = \\sum_{n=0}^{L-1} 1 = L $$\n$$ \\sum w^2 = \\sum_{n=0}^{L-1} 1^2 = L $$\n$$ \\mathrm{CG} = \\frac{L}{L} = 1 $$\n$$ \\mathrm{NG} = \\frac{L}{L} = 1 $$\n$$ \\mathrm{ENBW} = \\frac{L \\cdot L}{L^2} = 1 $$\n这些结果对任意 $L$ 都精确成立。对于 $L=256$，它们是 $1, 1, 1$。\n\n**2. 汉宁窗: $w[n]=\\frac{1}{2}-\\frac{1}{2}\\cos(\\frac{2\\pi n}{L-1})$**\n$$ \\sum w = \\sum_{n=0}^{L-1} \\left(\\frac{1}{2} - \\frac{1}{2}\\cos\\left(\\frac{2\\pi n}{L-1}\\right)\\right) = \\frac{1}{2}L - \\frac{1}{2}S_c(1) = \\frac{1}{2}(L-1) $$\n$$ \\sum w^2 = \\sum_{n=0}^{L-1} \\left(\\frac{1}{4} - \\frac{1}{2}\\cos\\left(\\frac{2\\pi n}{L-1}\\right) + \\frac{1}{4}\\cos^2\\left(\\frac{2\\pi n}{L-1}\\right)\\right) $$\n$$ \\sum w^2 = \\frac{1}{4}L - \\frac{1}{2}S_c(1) + \\frac{1}{4}\\left(\\frac{L+1}{2}\\right) = \\frac{L}{4} - \\frac{1}{2} + \\frac{L+1}{8} = \\frac{3L-3}{8} = \\frac{3}{8}(L-1) $$\n$$ \\mathrm{CG} = \\frac{\\frac{1}{2}(L-1)}{L} = \\frac{L-1}{2L} $$\n$$ \\mathrm{NG} = \\frac{\\frac{3}{8}(L-1)}{L} = \\frac{3(L-1)}{8L} $$\n$$ \\mathrm{ENBW} = \\frac{L \\cdot \\frac{3}{8}(L-1)}{(\\frac{1}{2}(L-1))^2} = \\frac{\\frac{3}{8}L(L-1)}{\\frac{1}{4}(L-1)^2} = \\frac{3}{2} \\frac{L}{L-1} $$\n对于 $L=256$：$\\mathrm{CG} = \\frac{255}{512} \\approx 0.4980$，$\\mathrm{NG} = \\frac{3 \\cdot 255}{8 \\cdot 256} \\approx 0.3735$，$\\mathrm{ENBW} = 1.5 \\frac{256}{255} \\approx 1.5059$。\n\n**3. 汉明窗: $w[n]=0.54-0.46\\cos(\\frac{2\\pi n}{L-1})$**\n令 $a_0 = 0.54, a_1 = -0.46$。$w[n] = a_0 + a_1\\cos(\\frac{2\\pi n}{L-1})$。\n$$ \\sum w = a_0 L + a_1 S_c(1) = a_0 L + a_1 = 0.54L - 0.46 $$\n$$ \\sum w^2 = \\sum (a_0 + a_1\\cos(\\cdot))^2 = \\sum (a_0^2 + 2a_0 a_1 \\cos(\\cdot) + a_1^2 \\cos^2(\\cdot)) $$\n$$ \\sum w^2 = a_0^2 L + 2a_0 a_1 S_c(1) + a_1^2 \\left(\\frac{L+1}{2}\\right) = (a_0^2 + \\frac{a_1^2}{2})L + 2a_0 a_1 + \\frac{a_1^2}{2} $$\n当 $a_0 = 0.54$ 且 $a_1=-0.46$ 时：$a_0^2=0.2916$, $a_1^2=0.2116$。\n$$ \\sum w^2 = (0.2916 + \\frac{0.2116}{2})L + 2(0.54)(-0.46) + \\frac{0.2116}{2} = 0.3974L - 0.4968 + 0.1058 = 0.3974L - 0.391 $$\n$$ \\mathrm{CG} = \\frac{0.54L - 0.46}{L} $$\n$$ \\mathrm{NG} = \\frac{0.3974L - 0.391}{L} $$\n$$ \\mathrm{ENBW} = \\frac{L(0.3974L - 0.391)}{(0.54L - 0.46)^2} $$\n对于 $L=256$：$\\mathrm{CG} = \\frac{0.54(256) - 0.46}{256} \\approx 0.5382$，$\\mathrm{NG} = \\frac{0.3974(256) - 0.391}{256} \\approx 0.3959$，$\\mathrm{ENBW} = \\frac{256(101.3434)}{137.78^2} \\approx 1.3667$。\n\n**4. 布莱克曼窗: $w[n]=0.42-0.5\\cos(\\frac{2\\pi n}{L-1})+0.08\\cos(\\frac{4\\pi n}{L-1})$**\n令 $c_0=0.42$, $c_1=-0.5$, $c_2=0.08$。$w[n] = c_0 + c_1\\cos(\\frac{2\\pi n}{L-1}) + c_2\\cos(\\frac{4\\pi n}{L-1})$。\n$$ \\sum w = c_0 L + c_1 S_c(1) + c_2 S_c(2) = c_0 L + c_1 + c_2 = 0.42L - 0.5 + 0.08 = 0.42(L-1) $$\n$$ \\sum w^2 = \\sum (c_0 + c_1 C_1 + c_2 C_2)^2 = \\sum(c_0^2 + c_1^2 C_1^2 + c_2^2 C_2^2 + 2c_0 c_1 C_1 + 2c_0 c_2 C_2 + 2c_1 c_2 C_1 C_2) $$\n$$ \\sum w^2 = c_0^2 L + c_1^2(\\frac{L+1}{2}) + c_2^2(\\frac{L+1}{2}) + 2c_0 c_1(1) + 2c_0 c_2(1) + 2c_1 c_2(1) $$\n$$ \\sum w^2 = L(c_0^2 + \\frac{c_1^2}{2} + \\frac{c_2^2}{2}) + (\\frac{c_1^2}{2} + \\frac{c_2^2}{2} + 2c_0c_1 + 2c_0c_2 + 2c_1c_2) $$\n系数：$c_0^2=0.1764$, $c_1^2=0.25$, $c_2^2=0.0064$。\n$L$ 项的系数：$0.1764 + 0.125 + 0.0032 = 0.3046$。\n常数项：$0.125 + 0.0032 + 2(0.42)(-0.5) + 2(0.42)(0.08) + 2(-0.5)(0.08) = 0.1282 - 0.42 + 0.0672 - 0.08 = -0.3046$。\n$$ \\sum w^2 = 0.3046L - 0.3046 = 0.3046(L-1) $$\n$$ \\mathrm{CG} = \\frac{0.42(L-1)}{L} $$\n$$ \\mathrm{NG} = \\frac{0.3046(L-1)}{L} $$\n$$ \\mathrm{ENBW} = \\frac{L \\cdot 0.3046(L-1)}{(0.42(L-1))^2} = \\frac{0.3046 L}{0.42^2 (L-1)} = \\frac{0.3046}{0.1764}\\frac{L}{L-1} $$\n对于 $L=256$：$\\mathrm{CG} = \\frac{0.42(255)}{256} \\approx 0.4184$，$\\mathrm{NG} = \\frac{0.3046(255)}{256} \\approx 0.3034$，$\\mathrm{ENBW} = \\frac{0.3046}{0.1764}\\frac{256}{255} \\approx 1.7335$。\n\n**ENBW的解释与帕塞瓦尔关系**\n窗函数的离散时间傅里叶变换 (DTFT) 为 $W(\\mathrm{e}^{\\mathrm{j}\\omega}) = \\sum_{n=0}^{L-1} w[n] \\mathrm{e}^{-\\mathrm{j}\\omega n}$。\n变换幅度的峰值在 $\\omega=0$ 处：$|W(\\mathrm{e}^{\\mathrm{j}0})| = |\\sum_{n=0}^{L-1} w[n]|$。我们假设 $w[n] \\ge 0$，所以这等于 $\\sum w[n]$。\n离散时间信号的帕塞瓦尔定理指出：$\\sum_{n=-\\infty}^{\\infty} |x[n]|^2 = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} |X(\\mathrm{e}^{\\mathrm{j}\\omega})|^2 \\mathrm{d}\\omega$。\n对于我们的有限长度窗函数 $w[n]$，这给出：$\\sum_{n=0}^{L-1} w[n]^2 = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} |W(\\mathrm{e}^{\\mathrm{j}\\omega})|^2 \\mathrm{d}\\omega$。\n将这些代入 $\\mathrm{ENBW}$ 的定义中：\n$$ \\mathrm{ENBW} = \\frac{L \\sum w[n]^2}{(\\sum w[n])^2} = \\frac{L \\cdot \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} |W(\\mathrm{e}^{\\mathrm{j}\\omega})|^2 \\mathrm{d}\\omega}{|W(\\mathrm{e}^{\\mathrm{j}0})|^2} = \\left(\\frac{L}{2\\pi}\\right) \\frac{\\int_{-\\pi}^{\\pi} |W(\\mathrm{e}^{\\mathrm{j}\\omega})|^2 \\mathrm{d}\\omega}{|W(\\mathrm{e}^{\\mathrm{j}0})|^2} $$\n$\\frac{\\int_{-\\pi}^{\\pi} |W(\\mathrm{e}^{\\mathrm{j}\\omega})|^2 \\mathrm{d}\\omega}{|W(\\mathrm{e}^{\\mathrm{j}0})|^2}$ 项是以弧度/样本为单位的等效矩形带宽。它是一个假设的矩形滤波器的宽度，该滤波器具有相同的峰值功率增益，并且会通过等量的白噪声总功率。因子 $\\frac{L}{2\\pi}$ 将此带宽从弧度/样本转换为DFT频点单位（因为长度为 $L$ 的 DFT 的频点间隔是 $\\frac{2\\pi}{L}$）。因此，$\\mathrm{ENBW}$ 是窗函数主谱瓣有效宽度的度量。\n\n**旁瓣抑制的定性分析**\n广义余弦窗的形式为 $w[n] = \\sum_{k=0}^{M} a_k \\cos(\\frac{2\\pi k n}{L-1})$。其 DTFT 是移位的狄利克雷核（隐式矩形窗的 DTFT）的叠加。选择系数 $a_k$ 是为了让这些核在旁瓣区域发生相消干涉。\n增加余弦项的数量 ($M$) 为频谱整形提供了更多的自由度。在主瓣宽度固定（即 $\\mathrm{ENBW}$ 固定）的情况下，窗函数设计者可以利用这些额外的自由度在频谱响应中引入更多的零点，或以其他方式优化系数集 $\\{a_k\\}$，以实现旁瓣更快的衰减或更低的总体水平。这减少了频谱泄漏。\n这些窗函数可以按余弦项的数量 ($M$) 分类：\n- 矩形窗: $M=0$。\n- 汉宁窗和汉明窗: $M=1$。\n- 布莱克曼窗: $M=2$。\n基于“项数越多，旁瓣控制能力越好”的原理，从最佳到最差的泄漏抑制顺序应对应于递减的 $M$。因此，布莱克曼窗应优于汉宁窗和汉明窗，而这两者又远优于矩形窗。\n在汉宁窗和汉明窗之间，两者都是单余弦项窗，但它们的系数是根据不同的优化目标选择的。汉宁窗的系数（$0.5, 0.5$）在数学上很简单，其结果是放置零点以抵消底层矩形窗响应的主旁瓣。汉明窗的系数（$0.54, 0.46$）经过优化，以最小化最高旁瓣的高度，从而以较慢的远端旁瓣衰减率为代价，实现了比汉宁窗更好的峰值旁瓣抑制。对于大多数关注在强音旁解析弱音的应用来说，峰值旁瓣电平至关重要。\n因此，这四种窗函数按泄漏抑制能力从好到坏的排序是：布莱克曼窗, 汉明窗, 汉宁窗, 矩形窗。\n\n**最终计算**\n题目要求$L=256$时布莱克曼窗的$\\mathrm{ENBW}$，并四舍五入到六位有效数字。\n$$ \\mathrm{ENBW}_{\\text{Blackman}} = \\frac{0.3046}{0.1764} \\times \\frac{256}{255} \\approx 1.7267573696 \\times 1.0039215686 \\approx 1.73353457 $$\n四舍五入到六位有效数字得到 $1.73353$。", "answer": "$$\n\\boxed{1.73353}\n$$", "id": "2853923"}, {"introduction": "一个正确计算的功率谱密度（Power Spectral Density, PSD）必须能表示信号功率在频率上的分布。本练习要求您推导 Welch 估计器的归一化常数，以确保谱中的总积分功率等于信号的方差，这体现了帕塞瓦尔（Parseval）能量守恒定理。掌握这一步骤对于生成具有物理意义且可比较的谱估计至关重要。[@problem_id:2853921]", "problem": "考虑一个实的、离散时间的、零均值的数据记录 $x[n]$，$n=0,\\dots,N-1$，其被建模为广义平稳过程的一次实现。您使用 Welch 平均加窗周期图法来估计其功率谱密度（PSD）。数据被划分为 $K$ 个长度为 $L$ 个样本的段，相邻段起始点之间的跳跃步长为 $D$ 个样本（因此第 $m$ 段从样本索引 $mD$ 开始），其中 $m=0,\\dots,K-1$，且 $0 \\leq mD \\leq N-L$。每个段都乘以一个确定性窗 $w[n]$，$n=0,\\dots,L-1$。对于第 $m$ 段，定义加窗数据的离散傅里叶变换（DFT）为\n$$\nY_m[k] \\triangleq \\sum_{n=0}^{L-1} \\big(x[n+mD]\\,w[n]\\big)\\,\\exp\\!\\left(-j\\frac{2\\pi}{L}kn\\right),\\quad k=0,\\dots,L-1,\n$$\n该变换通过 $L$ 点快速傅里叶变换（FFT）高效计算。DFT 网格上的 Welch PSD 估计定义为对 $K$ 个形式为 $\\alpha\\,|Y_m[k]|^{2}$ 的修正周期图进行平均，即\n$$\n\\widehat{S}_W[k] \\triangleq \\frac{1}{K}\\sum_{m=0}^{K-1}\\alpha\\,|Y_m[k]|^{2},\\quad k=0,\\dots,L-1,\n$$\n其中 $\\alpha$ 是一个待确定的实的、正的归一化常数。\n\n您的任务是从第一性原理出发，推导归一化常数 $\\alpha$ 的精确解析表达式，该表达式在归一化单位（弧度/样本）下对双边 PSD 估计强制执行以下能量守恒要求：\n$$\n\\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi}\\widehat{S}_W(\\omega)\\,d\\omega \\equiv \\frac{1}{L}\\sum_{k=0}^{L-1}\\widehat{S}_W[k] \\;=\\; \\widehat{\\sigma}_x^{2},\n$$\n其中 $\\widehat{\\sigma}_x^{2}$ 是 $x[n]$ 的样本方差，并且由于 $x[n]$ 是零均值，它满足 $\\widehat{\\sigma}_x^{2}=\\frac{1}{N}\\sum_{n=0}^{N-1}x[n]^2$。您的推导必须仅从核心定义和诸如 DFT、离散时间傅里叶变换 (DTFT) 和帕塞瓦尔定理等经过验证的事实出发。不要假设任何预知的 Welch 缩放因子。清晰地论证连接频域平均与时域二次型的每一步。\n\n然后，说明如何在实践中使用每段一个 $L$ 点 FFT 来实现最终的归一化：精确陈述 $\\widehat{S}_W[k]$（$k=0,\\dots,L-1$）的离散公式，该公式在编码后，必须使得离散频率平均 $(1/L)\\sum_{k=0}^{L-1}\\widehat{S}_W[k]$ 在矩形、不重叠分段（$D=L$）条件下对任何有限记录都等于 $\\widehat{\\sigma}_x^{2}$，并且对于通用窗和重叠情况，在一个广义平稳、零均值过程中，其期望值等于 $\\widehat{\\sigma}_x^{2}$。\n\n将您的最终答案表示为关于 $L$ 和 $w[n]$ 的单一闭式解析表达式。不需要数值近似；不要四舍五入。最终答案中不应包含单位。", "solution": "该问题要求推导 Welch 功率谱密度（PSD）估计器的归一化常数 $\\alpha$，使得从频谱估计出的总功率等于时域信号的样本方差。这是一个基本的能量守恒约束。推导将从第一性原理出发，基于所提供的定义和离散傅里叶变换（DFT）的帕塞瓦尔定理。\n\n核心要求由以下恒等式给出：\n$$\n\\frac{1}{L}\\sum_{k=0}^{L-1}\\widehat{S}_W[k] = \\widehat{\\sigma}_x^{2}\n$$\n其中 $\\widehat{S}_W[k]$ 是 Welch PSD 估计，$\\widehat{\\sigma}_x^2$ 是零均值信号 $x[n]$ 的样本方差。我们首先将 $\\widehat{S}_W[k]$ 的定义代入该等式的左侧（LHS）：\n$$\n\\text{LHS} = \\frac{1}{L}\\sum_{k=0}^{L-1} \\left( \\frac{1}{K}\\sum_{m=0}^{K-1}\\alpha\\,|Y_m[k]|^{2} \\right)\n$$\n由于求和的线性性质，常数 $\\alpha$ 和平均因子 $\\frac{1}{L}$、$\\frac{1}{K}$ 可以重新排序：\n$$\n\\text{LHS} = \\frac{\\alpha}{LK} \\sum_{k=0}^{L-1} \\sum_{m=0}^{K-1} |Y_m[k]|^{2} = \\frac{\\alpha}{LK} \\sum_{m=0}^{K-1} \\left( \\sum_{k=0}^{L-1} |Y_m[k]|^{2} \\right)\n$$\n内部的和 $\\sum_{k=0}^{L-1} |Y_m[k]|^{2}$ 涉及第 $m$ 个加窗段的 DFT 系数。这种结构允许我们应用 DFT 的帕塞瓦尔定理。对于任意长度为 $L$ 的序列 $z[n]$ 及其 $L$ 点 DFT $Z[k]$，该定理表述为：\n$$\n\\sum_{k=0}^{L-1} |Z[k]|^2 = L \\sum_{n=0}^{L-1} |z[n]|^2\n$$\n在我们的情境中，对于第 $m$ 段，时域序列为 $z_m[n] = x[n+mD]w[n]$（$n=0, \\dots, L-1$），其 DFT 为 $Y_m[k]$。应用帕塞瓦尔定理，我们得到：\n$$\n\\sum_{k=0}^{L-1} |Y_m[k]|^2 = L \\sum_{n=0}^{L-1} |x[n+mD]w[n]|^2\n$$\n由于数据 $x[n]$ 和窗 $w[n]$ 都是实值的，这可简化为：\n$$\n\\sum_{k=0}^{L-1} |Y_m[k]|^2 = L \\sum_{n=0}^{L-1} x[n+mD]^2 w[n]^2\n$$\n将此结果代回 LHS 的表达式中：\n$$\n\\text{LHS} = \\frac{\\alpha}{LK} \\sum_{m=0}^{K-1} \\left( L \\sum_{n=0}^{L-1} x[n+mD]^2 w[n]^2 \\right) = \\frac{\\alpha}{K} \\sum_{m=0}^{K-1} \\sum_{n=0}^{L-1} x[n+mD]^2 w[n]^2\n$$\n现在，我们将其与初始要求的右侧（RHS）相等，即 $\\widehat{\\sigma}_x^{2} = \\frac{1}{N}\\sum_{n=0}^{N-1}x[n]^2$：\n$$\n\\frac{\\alpha}{K} \\sum_{m=0}^{K-1} \\sum_{n=0}^{L-1} x[n+mD]^2 w[n]^2 = \\frac{1}{N}\\sum_{n=0}^{N-1}x[n]^2\n$$\n对于一个具有通用窗和重叠的任意信号实现 $x[n]$，这个恒等式无法成立，因为左侧对样本 $x[n]^2$ 应用了非均匀加权（$w[n]^2$），而右侧没有。然而，问题指明，对于广义平稳（WSS）过程，此关系必须在期望意义上成立。因此，我们必须令等式两侧的统计期望相等。\n\nLHS 的期望是：\n$$\nE[\\text{LHS}] = E\\left[ \\frac{\\alpha}{K} \\sum_{m=0}^{K-1} \\sum_{n=0}^{L-1} x[n+mD]^2 w[n]^2 \\right] = \\frac{\\alpha}{K} \\sum_{m=0}^{K-1} \\sum_{n=0}^{L-1} E[x[n+mD]^2] w[n]^2\n$$\n对于零均值 WSS 过程，其平方值的期望是过程方差 $\\sigma_x^2$，该方差对所有时间索引都是恒定的：对于任意 $i$，$E[x[i]^2] = \\sigma_x^2$。\n$$\nE[\\text{LHS}] = \\frac{\\alpha}{K} \\sum_{m=0}^{K-1} \\sum_{n=0}^{L-1} \\sigma_x^2 w[n]^2 = \\frac{\\alpha \\sigma_x^2}{K} \\sum_{m=0}^{K-1} \\left( \\sum_{n=0}^{L-1} w[n]^2 \\right)\n$$\n对 $n$ 的内部求和是窗的能量，这是一个不依赖于段索引 $m$ 的常数值。对 $m$ 的外部求和由 $K$ 个相同的项组成。\n$$\nE[\\text{LHS}] = \\frac{\\alpha \\sigma_x^2}{K} \\cdot K \\left( \\sum_{n=0}^{L-1} w[n]^2 \\right) = \\alpha \\sigma_x^2 \\sum_{n=0}^{L-1} w[n]^2\n$$\nRHS 的期望是：\n$$\nE[\\text{RHS}] = E[\\widehat{\\sigma}_x^2] = E\\left[ \\frac{1}{N}\\sum_{n=0}^{N-1}x[n]^2 \\right] = \\frac{1}{N}\\sum_{n=0}^{N-1}E[x[n]^2] = \\frac{1}{N}\\sum_{n=0}^{N-1}\\sigma_x^2 = \\frac{N \\sigma_x^2}{N} = \\sigma_x^2\n$$\n令期望相等，$E[\\text{LHS}] = E[\\text{RHS}]$，得到：\n$$\n\\alpha \\sigma_x^2 \\sum_{n=0}^{L-1} w[n]^2 = \\sigma_x^2\n$$\n假设过程不是平凡的（$\\sigma_x^2 > 0$），我们可以除以 $\\sigma_x^2$ 来求解 $\\alpha$：\n$$\n\\alpha = \\frac{1}{\\sum_{n=0}^{L-1} w[n]^2}\n$$\n这就是所要求的归一化常数。让我们在一个特定情况下验证这一点：矩形窗（对所有 $n$，$w[n]=1$）和不重叠的段（$D=L$，这意味着对于 $K$ 个完整段，$N=KL$）。在这种情况下，公式给出 $\\alpha = \\frac{1}{\\sum_{n=0}^{L-1} 1^2} = \\frac{1}{L}$。精确的（非期望）恒等式变为：\n$$\n\\frac{1/L}{K} \\sum_{m=0}^{K-1} \\sum_{n=0}^{L-1} x[n+mL]^2 (1)^2 = \\frac{1}{KL} \\sum_{i=0}^{KL-1} x[i]^2\n$$\n双重求和 $\\sum_{m=0}^{K-1} \\sum_{n=0}^{L-1} x[n+mL]^2$ 只是对从 $i=0$ 到 $i=KL-1$ 的所有样本 $x[i]^2$ 的求和。因此，该方程简化为一个恒等式，从而证实了我们为这一特定情况推导出的 $\\alpha$ 的正确性。\n\n为了在实践中实现这种归一化，我们首先预先计算窗的能量，$U = \\sum_{n=0}^{L-1} w[n]^2$。然后根据以下公式计算 Welch PSD 估计：\n$$\n\\widehat{S}_W[k] = \\frac{1}{K} \\left( \\frac{1}{\\sum_{l=0}^{L-1} w[l]^2} \\right) \\sum_{m=0}^{K-1} |Y_m[k]|^2 = \\frac{1}{K \\cdot U} \\sum_{m=0}^{K-1} \\left| \\sum_{n=0}^{L-1} x[n+mD]w[n]\\exp\\left(-j\\frac{2\\pi}{L}kn\\right) \\right|^2\n$$\n计算步骤如下：\n1. 将数据 $x[n]$ 分为 $K$ 个长度为 $L$ 的段。\n2. 对每个段 $m$，乘以窗 $w[n]$ 并计算其 $L$ 点 FFT，$Y_m[k]$。\n3. 计算每个段的幅值平方，$|Y_m[k]|^2$。\n4. 对这 $K$ 个段的幅值平方进行平均。\n5. 将结果除以窗能量 $U = \\sum_{n=0}^{L-1} w[n]^2$ 进行归一化。除以 $K$ 已经是平均步骤的一部分。因此，组合的归一化因子为 $\\frac{1}{K \\cdot U}$。\n此过程确保了估计频谱中的总功率与信号的总功率相对应，在期望意义上满足了能量守恒原理。", "answer": "$$\\boxed{\\frac{1}{\\sum_{n=0}^{L-1} w[n]^2}}$$", "id": "2853921"}]}