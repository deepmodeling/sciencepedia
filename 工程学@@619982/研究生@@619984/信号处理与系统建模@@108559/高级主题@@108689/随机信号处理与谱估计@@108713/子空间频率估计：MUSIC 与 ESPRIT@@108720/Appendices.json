{"hands_on_practices": [{"introduction": "在应用 MUSIC 或 ESPRIT 等先进算法之前，我们必须确保传感器阵列的设计是无歧义的。这项实践探讨了空间混叠的基本原理，即当传感器间距 $d$ 相对于信号波长 $\\lambda$ 过大时，便会产生无法区分的测向结果。通过从第一性原理出发，推导阵元间距必须满足的关键条件 [@problem_id:2908478]，您将深刻理解物理阵列设计如何直接决定高分辨率谱估计算法性能的上限。", "problem": "考虑一个由 $M$ 个相同的全向传感器组成的均匀线性阵列 (ULA)，这些传感器沿 $x$ 轴放置，阵元间距为 $d$。一个波长为 $\\lambda$ 的单一远场窄带平面波从波达方向 (DOA) 角 $\\theta$ 入射到阵列上，该角度从侧射方向算起，且 $\\theta \\in \\left[-\\frac{\\pi}{2}, \\frac{\\pi}{2}\\right]$。角度以弧度为单位。在窄带平面波模型下，对于 DOA $\\theta$ 的复基带阵列流形（导向矢量）可以写为\n$$\n\\mathbf{a}(\\theta) = \\begin{bmatrix}\n1 & \\exp\\!\\left(-j\\,2\\pi \\frac{d}{\\lambda}\\sin\\theta\\right) & \\exp\\!\\left(-j\\,2\\pi \\frac{d}{\\lambda}2\\sin\\theta\\right) & \\cdots & \\exp\\!\\left(-j\\,2\\pi \\frac{d}{\\lambda}(M-1)\\sin\\theta\\right)\n\\end{bmatrix}^{\\top}.\n$$\n从基本的传播和采样原理（平面波在空间采样传感器上的相位累积以及 $\\sin\\theta$ 在可见扇区内的有界性）出发，推导出一个关于阵元间距 $d$ 相对于波长 $\\lambda$ 的充要条件，以防止空间混叠。这里的空间混叠指的是，在 $\\left[-\\frac{\\pi}{2}, \\frac{\\pi}{2}\\right]$ 范围内的任意两个不同 DOA 不会产生在相差一个全局复数标量的情况下相同的导向矢量。通过分析两个不同角度 $\\theta_{1}\\neq\\theta_{2}$ 何时会导致相同的模 $2\\pi$ 阵元间相位差集合，明确地建立该条件。\n\n然后，使用同样的基本原理，解释违反此条件对通过多重信号分类 (MUSIC) 和通过旋转不变技术估计信号参数 (ESPRIT) 获得的 DOA 估计唯一性的影响。你的解释应将阵列流形的相位递进与这些算法所利用的子空间结构联系起来，并阐明当存在混叠时为何会出现多个无法区分的 DOA。\n\n最后，以 $\\lambda$ 的符号表达式形式，报告能够保证 MUSIC 和 ESPRIT 在 $\\theta \\in \\left[-\\frac{\\pi}{2}, \\frac{\\pi}{2}\\right]$ 范围内具有全局唯一 DOA 映射的最大阵元间距 $d_{\\max}$。只提供 $d_{\\max}$ 的符号表达式，不带单位。无需进行数值四舍五入。", "solution": "所述问题在科学上是合理的、自洽的且适定的。它涉及阵列信号处理中的基本概念。我们将进行推导和分析。\n\n该问题要求分三部分作答：首先，推导防止空间混叠的阵元间距 $d$ 的条件；其次，解释当此条件被违反时对 MUSIC 和 ESPRIT 算法的影响；最后，给出该间距的具体最大值 $d_{\\max}$。\n\n均匀线性阵列 (ULA) 的导向矢量由下式给出：\n$$\n\\mathbf{a}(\\theta) = \\begin{bmatrix}\n1 & \\exp\\left(-j \\phi(\\theta)\\right) & \\exp\\left(-j 2\\phi(\\theta)\\right) & \\cdots & \\exp\\left(-j (M-1)\\phi(\\theta)\\right)\n\\end{bmatrix}^{\\top}\n$$\n其中阵元间相位差为 $\\phi(\\theta) = 2\\pi \\frac{d}{\\lambda} \\sin\\theta$。这里，$j = \\sqrt{-1}$，$d$ 是阵元间距，$\\lambda$ 是波长，$M$ 是传感器数量，$\\theta$ 是在 $\\left[-\\frac{\\pi}{2}, \\frac{\\pi}{2}\\right]$ 范围内的波达方向 (DOA)。\n\n为防止空间混叠，我们要求从 DOA $\\theta$ 到导向矢量 $\\mathbf{a}(\\theta)$ 的映射在指定的 $\\theta$ 范围内是唯一的。问题将混叠定义为两个不同的 DOA $\\theta_1 \\neq \\theta_2$ 产生在相差一个复数标量的情况下相同的导向矢量。让我们假设对于某个复数标量 $c$，有 $\\mathbf{a}(\\theta_1) = c \\cdot \\mathbf{a}(\\theta_2)$。$\\mathbf{a}(\\theta)$ 的第一个元素定义为 $1$。因此，比较第一个元素，我们得到 $1 = c \\cdot 1$，这迫使 $c=1$。因此，混叠的条件简化为导向矢量的严格相等：当 $\\theta_1 \\neq \\theta_2$ 时，有 $\\mathbf{a}(\\theta_1) = \\mathbf{a}(\\theta_2)$。\n\n为使矢量相等，它们的对应元素必须相等。这要求相位递进是相同的。具体来说，对于第二个元素（以及所有后续元素），我们必须有：\n$$\n\\exp\\left(-j \\phi(\\theta_1)\\right) = \\exp\\left(-j \\phi(\\theta_2)\\right)\n$$\n该等式成立的充要条件是指数量 $2\\pi$ 同余：\n$$\n-j \\phi(\\theta_1) = -j \\phi(\\theta_2) - j 2\\pi k\n$$\n其中 $k \\in \\mathbb{Z}$ 是某个整数。由于 $\\theta_1 \\neq \\theta_2$，要发生混叠，必须有 $k \\neq 0$。代入 $\\phi(\\theta)$ 的定义：\n$$\n2\\pi \\frac{d}{\\lambda} \\sin\\theta_1 = 2\\pi \\frac{d}{\\lambda} \\sin\\theta_2 + 2\\pi k\n$$\n两边除以 $2\\pi$ 并重新整理，得到混叠的基本方程：\n$$\n\\frac{d}{\\lambda} \\left(\\sin\\theta_1 - \\sin\\theta_2\\right) = k, \\quad k \\in \\mathbb{Z} \\setminus \\{0\\}\n$$\n为了保证从 $\\theta$ 到 $\\mathbf{a}(\\theta)$ 的映射是唯一的，我们必须建立一个关于比率 $\\frac{d}{\\lambda}$ 的条件，以防止该方程对于不同的 $\\theta_1, \\theta_2 \\in \\left[-\\frac{\\pi}{2}, \\frac{\\pi}{2}\\right]$ 和任何非零整数 $k$ 有解。\n\n让我们分析 $\\sin\\theta_1 - \\sin\\theta_2$ 这一项。函数 $\\sin\\theta$ 在区间 $\\left[-\\frac{\\pi}{2}, \\frac{\\pi}{2}\\right]$ 上是严格单调的，将其映射到 $[-1, 1]$。对于此区间内的任何 $\\theta_1 \\neq \\theta_2$，有 $\\sin\\theta_1 \\neq \\sin\\theta_2$。差值 $\\sin\\theta_1 - \\sin\\theta_2$ 的最大可能值在 $\\sin\\theta_1 = 1$ (当 $\\theta_1 = \\frac{\\pi}{2}$) 和 $\\sin\\theta_2 = -1$ (当 $\\theta_2 = -\\frac{\\pi}{2}$) 时达到，差值为 $1 - (-1) = 2$。最小值为 $-2$。因此，该差值的范围是 $\\sin\\theta_1 - \\sin\\theta_2 \\in (-2, 2)$，不包括 $0$。\n\n为确保不发生混叠，我们必须防止乘积 $\\frac{d}{\\lambda} \\left(\\sin\\theta_1 - \\sin\\theta_2\\right)$ 等于任何非零整数。如果该乘积的绝对值始终小于 $1$，则此条件得以满足：\n$$\n\\left| \\frac{d}{\\lambda} \\left(\\sin\\theta_1 - \\sin\\theta_2\\right) \\right| < 1\n$$\n该不等式必须对 $\\sin\\theta_1 - \\sin\\theta_2$ 的所有可能值都成立。我们因此必须检查极端情况：\n$$\n\\frac{d}{\\lambda} \\max_{\\theta_1 \\neq \\theta_2} \\left| \\sin\\theta_1 - \\sin\\theta_2 \\right| < 1\n$$\n最大绝对差值为 $2$。代入此值可得：\n$$\n\\frac{d}{\\lambda} \\cdot 2 < 1 \\implies d < \\frac{\\lambda}{2}\n$$\n这就是防止空间混叠的充要条件。如果 $d \\geq \\frac{\\lambda}{2}$，混叠是可能发生的。例如，如果我们选择边界情况 $d = \\frac{\\lambda}{2}$，我们的混叠方程变为 $\\frac{1}{2}(\\sin\\theta_1 - \\sin\\theta_2) = k$。选择 $k=1$ 会得到 $\\sin\\theta_1 - \\sin\\theta_2 = 2$，它有唯一的解对 $\\sin\\theta_1=1$ 和 $\\sin\\theta_2=-1$。这对应于不同的 DOA $\\theta_1 = \\frac{\\pi}{2}$ 和 $\\theta_2 = -\\frac{\\pi}{2}$。在此间距下，两个端射方向产生相同的导向矢量，从而造成模糊。\n\n现在，我们解释其对 MUSIC 和 ESPRIT 的影响。\n这两种方法都是基于子空间的，并且根本上依赖于信号子空间的结构，该子空间由入射信号的导向矢量张成。因此，DOA 估计的唯一性取决于导向矢量流形 $\\mathcal{A} = \\{\\mathbf{a}(\\theta) \\mid \\theta \\in [-\\pi/2, \\pi/2]\\}$ 的唯一性。\n\n对于 **MUSIC (多重信号分类)**，该算法通过搜索其导向矢量 $\\mathbf{a}(\\theta)$ 与估计的噪声子空间正交的角度 $\\theta$ 来寻找 DOA。这等同于在 MUSIC 伪谱 $P_{MU}(\\theta) = (\\mathbf{a}^H(\\theta) \\mathbf{E}_N \\mathbf{E}_N^H \\mathbf{a}(\\theta))^{-1}$ 中寻找峰值，其中 $\\mathbf{E}_N$ 是噪声特征矢量矩阵。如果在 DOA $\\theta_{true}$ 处存在一个信号源，那么 $\\mathbf{a}(\\theta_{true})$ 位于信号子空间中，使得 $P_{MU}(\\theta_{true})$ 的分母趋近于零。如果条件 $d < \\frac{\\lambda}{2}$ 被违反，则存在至少一对不同的角度 $(\\theta_1, \\theta_2)$ 使得 $\\mathbf{a}(\\theta_1) = \\mathbf{a}(\\theta_2)$。如果信号源位于 $\\theta_1$，其导向矢量 $\\mathbf{a}(\\theta_1)$ 将被正确地置于信号子空间中。然而，由于 $\\mathbf{a}(\\theta_2)$ 是相同的，在 DOA 空间上的搜索将揭示 $\\mathbf{a}(\\theta_2)$ 也位于信号子空间中（或者等效地，与噪声子空间正交）。因此，MUSIC 谱将在 $\\theta_1$ 和 $\\theta_2$ 处都表现出峰值，从而无法区分信号源是位于 $\\theta_1$ 还是 $\\theta_2$。DOA 估计是模糊的。\n\n对于 **ESPRIT (通过旋转不变技术估计信号参数)**，该算法利用了两个子阵列之间的平移位移引起的相移。对于 ULA，这是通过形成第一个包含传感器 $1$ 到 $M-1$ 的子阵列和第二个包含传感器 $2$ 到 $M$ 的子阵列来实现的。位移为 $d$。第二个子阵列的信号子空间通过一个对角旋转矩阵 $\\mathbf{\\Psi}$ 与第一个子阵列的信号子空间相关联，其对角元素对于每个信号源 $k$ 为 $\\psi_k = \\exp(-j 2\\pi \\frac{d}{\\lambda} \\sin\\theta_k)$。ESPRIT 估计这些特征值，并通过以下关系恢复 DOA：\n$$\n\\sin\\theta_k = -\\frac{\\lambda}{2\\pi d} \\text{angle}(\\psi_k)\n$$\n其中 $\\text{angle}(\\cdot)$ 返回区间 $(-\\pi, \\pi]$ 内的主相位。此反演的唯一性取决于函数 $f(\\theta) = -2\\pi \\frac{d}{\\lambda} \\sin\\theta$ 在其输出映射到 $(-\\pi, \\pi]$ 时是否是单射的。当 $\\theta \\in [-\\frac{\\pi}{2}, \\frac{\\pi}{2}]$ 时，$f(\\theta)$ 的范围是 $[-2\\pi \\frac{d}{\\lambda}, 2\\pi \\frac{d}{\\lambda}]$。该范围的总跨度为 $4\\pi \\frac{d}{\\lambda}$。为了使从 $\\theta$ 到主相位的映射是一对一的，这个跨度必须小于 $2\\pi$。\n$$\n4\\pi \\frac{d}{\\lambda} < 2\\pi \\implies 2\\frac{d}{\\lambda} < 1 \\implies d < \\frac{\\lambda}{2}\n$$\n这与前面的条件完全相同。如果 $d \\geq \\frac{\\lambda}{2}$，相位范围等于或大于 $2\\pi$，导致相位缠绕。对于一个给定的估计相位 $\\text{angle}(\\psi_k)$，$\\sin\\theta_k$（以及 $\\theta_k$）的多个值都可能成为解。这就是空间混叠在 ESPRIT 中的体现。其根本原因与在 MUSIC 中相同：阵列流形不再由 DOA 唯一确定。\n\n最后，我们必须报告保证全局唯一 DOA 映射的最大阵元间距 $d_{\\max}$。保证唯一性的条件是严格不等式 $d < \\frac{\\lambda}{2}$。任何等于或大于 $\\frac{\\lambda}{2}$ 的间距 $d$ 都会允许至少一种模糊性。值 $d = \\frac{\\lambda}{2}$ 代表了唯一性首次丧失（在端射方向上）的临界边界。因此，作为有效间距集合的上确界，并作为设计极限的“最大”间距就是这个边界值。任何实际设计都必须使用严格小于此极限的间距。\n因此，最大间距为 $d_{\\max} = \\frac{\\lambda}{2}$。", "answer": "$$\n\\boxed{\\frac{\\lambda}{2}}\n$$", "id": "2908478"}, {"introduction": "子空间方法的一个核心假设是信号源是不相关的，然而在多径传播等真实场景中，信号往往是高度相干的，这会导致信号协方差矩阵的秩亏损，从而使算法失效。本练习介绍了空间平滑技术，这是一种强大的预处理方法，能够有效地恢复协方差矩阵的秩。掌握空间平滑的工作原理及其应用条件 [@problem_id:2908526]，对于在实际相干环境中成功应用 MUSIC 和 ESPRIT 至关重要。", "problem": "一个包含 $M$ 个传感器的均匀线性阵列 (ULA) 接收来自不同方向的 $K$ 个窄带远场平面波。其中一组信号是完全相干的，这意味着它们的时间波形是线性相关的（是某个公共波形的尺度缩放和相位平移版本）。加性噪声是空间白噪声，均值为零，且与信号无关。为了能够使用多重信号分类 (MUSIC) 和基于旋转不变技术的信号参数估计 (ESPRIT) 等基于子空间的方法进行波达方向估计，对阵列输出进行空间平滑处理。该处理将 ULA 划分为 $L$ 个大小为 $M_s$ 的重叠连续子阵列，并基于这些子阵列计算一个平均协方差矩阵，用于子空间估计。\n\n哪个选项正确地描述了如何构建空间平滑协方差，并解释了空间平滑在何种机制和条件下能够对相干信源进行充分解相干，以恢复一个 $K$ 维的信号子空间？\n\nA. 将 ULA 划分为 $L = M - M_s + 1$ 个大小为 $M_s$ 的重叠连续子阵列，划分方式为将一个长度为 $M_s$ 的窗口每次滑动一个传感器。对于每个子阵列索引 $\\ell \\in \\{1,\\dots,L\\}$，构建该子阵列上的样本协方差，然后将这 $L$ 个协方差平均以获得平滑协方差。因为每个子阵列是 ULA 的一个平移副本，相干组的秩-1结构被导向矢量中由平移引起的相位递进所打破，从而使得平均信号协方差的秩达到 $\\min\\{K, M_s, L\\}$；因此，如果 $M_s \\ge K$ 且 $L \\ge K$，信号子空间的秩为 $K$，并且白噪声分量在每个子阵列上保持白色且方差不变，从而使得 MUSIC 和 ESPRIT 能够应用。\n\nB. 仅使用不相交、不重叠的子阵列以避免偏差；重叠的子阵列会妨碍相干信源的解相干。只要 $M_s \\ge K$，子阵列的数量 $L$ 不会影响平均协方差的秩，并且相干信源可以在对 $L$ 没有任何要求的情况下被解相干。\n\nC. 不划分阵列；而是在快拍维度上对全阵列协方差进行平均，以随时间随机化相位。这种平均将噪声方差降低 $L$ 倍，并且通常即使在 $M_s = 1$ 的情况下也能分辨相干信源。\n\nD. 通过在平均之前减去每个子阵列输出的均值来构建平滑协方差，以消除相干性。此操作仅在 $L \\ge 2K$ 的条件下才能对相干信源解相干，而与 $M_s$ 无关，并且得到的平滑协方差的秩为 $L$，噪声方差增加了 $L$ 倍。\n\nE. 空间平滑要求 $M_s + L - 1 \\ge K$；在此单一条件下，相干信源总能被解相干，且信号子空间的秩等于 $K$，这与子阵列如何构建或它们是否重叠无关。", "solution": "首先，将验证问题陈述的科学性和逻辑完整性。\n\n### 步骤 1：提取已知条件\n- **阵列**：具有 $M$ 个传感器的均匀线性阵列 (ULA)。\n- **信号**：来自不同方向的 $K$ 个窄带远场平面波。\n- **相干性**：一组信号是完全相干的。\n- **噪声**：加性的、空间白的、零均值的，且与信号无关。\n- **处理**：应用空间平滑以启用 MUSIC 和 ESPRIT。\n- **空间平滑方法**：将 ULA 划分为 $L$ 个大小为 $M_s$ 的重叠连续子阵列。对这些子阵列形成一个平均协方差矩阵。\n- **问题**：哪个选项正确地描述了空间平滑协方差矩阵的构建，并解释了为使 MUSIC 和 ESPRIT 能够恢复 $K$ 维信号子空间而对相干信源进行充分解相干的机制和条件？\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题陈述描述了阵列信号处理中的一个经典场景：在存在相干（或多径）信号的情况下的波达方向 (DOA) 估计。使用空间平滑对数据进行预处理以用于像 MUSIC 和 ESPRIT 这样的基于子空间的方法，是一种标准且成熟的技术。\n\n- **科学上成立**：该问题基于阵列信号处理的基本原理，特别是子空间方法和空间平滑预处理技术。相干性、导向矢量和协方差矩阵等概念是该领域的核心。该问题在科学上是合理的。\n- **适定的**：该问题要求对一个特定的、定义明确的算法及其基本原理进行正确描述。文献中存在唯一且正确的描述，可以据此评估各个选项。\n- **客观的**：语言精确且技术性强，不包含主观或模棱两可的陈述。\n- **自洽且一致的**：该问题提供了回答此概念性问题所需的所有必要背景，内部没有矛盾。\n- **相关性**：该问题与子空间频率估计的主题以及指令中明确提到的 MUSIC 和 ESPRIT 算法直接相关。\n\n### 步骤 3：结论与行动\n问题陈述是有效的。这是信号处理领域一个标准的、适定的问题。我将继续进行推导和求解。\n\n### 原理推导\n设 $M$ 传感器 ULA 上的接收信号矢量为 $\\mathbf{x}(t) \\in \\mathbb{C}^{M \\times 1}$。信号模型为：\n$$ \\mathbf{x}(t) = \\mathbf{A} \\mathbf{s}(t) + \\mathbf{n}(t) $$\n其中 $\\mathbf{A} = [\\mathbf{a}(\\theta_1), \\dots, \\mathbf{a}(\\theta_K)]$ 是 $M \\times K$ 的导向矩阵，$\\mathbf{s}(t)$ 是 $K \\times 1$ 的信源信号矢量，$\\mathbf{n}(t)$ 是 $M \\times 1$ 的噪声矢量。接收信号的协方差矩阵为：\n$$ \\mathbf{R}_x = E[\\mathbf{x}(t)\\mathbf{x}(t)^H] = \\mathbf{A} E[\\mathbf{s}(t)\\mathbf{s}(t)^H] \\mathbf{A}^H + E[\\mathbf{n}(t)\\mathbf{n}(t)^H] = \\mathbf{A} \\mathbf{R}_s \\mathbf{A}^H + \\sigma_n^2 \\mathbf{I}_M $$\n其中 $\\mathbf{R}_s$ 是信源协方差矩阵，$\\sigma_n^2$ 是噪声方差。\n\n像 MUSIC 和 ESPRIT 这样的子空间方法依赖于 $\\mathbf{R}_x$ 的特征分解。它们的成功要求纯信号协方差矩阵 $\\mathbf{A} \\mathbf{R}_s \\mathbf{A}^H$ 的秩等于信源数量 $K$。由于信源来自不同方向，$\\mathbf{A}$ 的列向量是线性无关的（对于 $M \\ge K$），因此 $\\text{rank}(\\mathbf{A}) = K$。所以，纯信号协方差矩阵的秩等于信源协方差矩阵的秩，即 $\\text{rank}(\\mathbf{R}_s)$。\n\n当信源完全相干时，它们互为对方的尺度缩放和延迟版本。如果所有 $K$ 个信源都与一个参考信号相干，则 $\\mathbf{R}_s$ 是一个秩-1矩阵。这种秩亏损会导致 MUSIC 和 ESPRIT 失效，因为它们将只能识别出一个信源。\n\n空间平滑克服了这个问题。ULA 被划分为 $L$ 个大小为 $M_s$ 的重叠子阵列。最常见的方案使用滑动窗口，这会产生 $L = M - M_s + 1$ 个子阵列。对于 $\\ell \\in \\{1, \\dots, L\\}$，第 $\\ell$ 个子阵列的数据矢量可以表示为：\n$$ \\mathbf{x}_\\ell(t) = \\mathbf{A}_{M_s} \\mathbf{D}^{\\ell-1} \\mathbf{s}(t) + \\mathbf{n}_\\ell(t) $$\n这里，$\\mathbf{A}_{M_s}$ 是大小为 $M_s$ 的子阵列的 $M_s \\times K$ 导向矩阵。矩阵 $\\mathbf{D}$ 是一个 $K \\times K$ 的对角矩阵，包含了每个信源在相邻传感器之间的相位偏移：$\\mathbf{D} = \\text{diag}(e^{-j\\phi_1}, \\dots, e^{-j\\phi_K})$，其中 $\\phi_k = (2\\pi d/\\lambda) \\sin \\theta_k$。项 $\\mathbf{D}^{\\ell-1}$ 模拟了由于第 $\\ell$ 个子阵列原点的空间位移而产生的相位递进。\n\n第 $\\ell$ 个子阵列的协方差矩阵是：\n$$ \\mathbf{R}_\\ell = \\mathbf{A}_{M_s} \\mathbf{D}^{\\ell-1} \\mathbf{R}_s (\\mathbf{D}^{\\ell-1})^H \\mathbf{A}_{M_s}^H + \\sigma_n^2 \\mathbf{I}_{M_s} $$\n空间平滑协方差矩阵 $\\bar{\\mathbf{R}}$ 是这些子阵列协方差的平均值：\n$$ \\bar{\\mathbf{R}} = \\frac{1}{L} \\sum_{\\ell=1}^L \\mathbf{R}_\\ell = \\mathbf{A}_{M_s} \\left( \\frac{1}{L} \\sum_{\\ell=1}^L \\mathbf{D}^{\\ell-1} \\mathbf{R}_s (\\mathbf{D}^{\\ell-1})^H \\right) \\mathbf{A}_{M_s}^H + \\sigma_n^2 \\mathbf{I}_{M_s} $$\n括号中的项是平滑信源协方差矩阵 $\\bar{\\mathbf{R}}_s$。关键的洞见在于，这个平均过程可以恢复信源协方差矩阵的秩。如果我们考虑一个包含 $K$ 个信源的单一相干组，那么 $\\mathbf{R}_s$ 是秩-1的。秩-1矩阵之和 $\\mathbf{D}^{\\ell-1} \\mathbf{R}_s (\\mathbf{D}^{\\ell-1})^H$ 的秩由平移操作生成的向量的线性无关性决定。可以证明，如果信源具有不同的DOA，$\\bar{\\mathbf{R}}_s$ 的秩将为 $\\min(K, L)$。\n\n因此，为了将信源协方差矩阵的秩恢复到 $K$，我们需要 $L \\ge K$。\n\n此外，总的平滑信号协方差矩阵是 $\\bar{\\mathbf{R}}_{ss} = \\mathbf{A}_{M_s} \\bar{\\mathbf{R}}_s \\mathbf{A}_{M_s}^H$。其秩的上界由所涉及矩阵的维度决定。具体来说，$\\text{rank}(\\bar{\\mathbf{R}}_{ss}) \\le \\min(\\text{rank}(\\mathbf{A}_{M_s}), \\text{rank}(\\bar{\\mathbf{R}}_s))$。矩阵 $\\mathbf{A}_{M_s}$ 的维度是 $M_s \\times K$。为了使其列向量线性无关（这是分辨 $K$ 个信源的先决条件），我们需要 $M_s \\ge K$。\n\n结合这些条件，为确保 $\\text{rank}(\\bar{\\mathbf{R}}_{ss}) = K$，我们需要：\n1. $L \\ge K$：子阵列的数量必须至少等于相干信源的数量，以恢复信源协方差矩阵的秩。\n2. $M_s \\ge K$：每个子阵列的大小必须至少等于信源的数量，以确保子阵列的导向矢量是线性无关的。\n\n得到的平滑信号协方差矩阵的秩为 $\\min(K, M_s, L)$。为了达到所期望的秩 $K$，两个条件（$M_s \\ge K$ 和 $L \\ge K$）都必须满足。\n平滑协方差的噪声分量为 $\\frac{1}{L} \\sum_{\\ell=1}^L \\sigma_n^2 \\mathbf{I}_{M_s} = \\sigma_n^2 \\mathbf{I}_{M_s}$，因此噪声保持空间白色，其方差仍为原始方差 $\\sigma_n^2$。\n\n### 逐项分析\n\n**A. 将 ULA 划分为 $L = M - M_s + 1$ 个大小为 $M_s$ 的重叠连续子阵列，划分方式为将一个长度为 $M_s$ 的窗口每次滑动一个传感器。对于每个子阵列索引 $\\ell \\in \\{1,\\dots,L\\}$，构建该子阵列上的样本协方差，然后将这 $L$ 个协方差平均以获得平滑协方差。因为每个子阵列是 ULA 的一个平移副本，相干组的秩-1结构被导向矢量中由平移引起的相位递进所打破，从而使得平均信号协方差的秩达到 $\\min\\{K, M_s, L\\}$；因此，如果 $M_s \\ge K$ 且 $L \\ge K$，信号子空间的秩为 $K$，并且白噪声分量在每个子阵列上保持白色且方差不变，从而使得 MUSIC 和 ESPRIT 能够应用。**\n此选项提供了完整而准确的描述。$L$ 的公式对于最大重叠是正确的。通过相位递进实现解相干的机制被正确识别。最终信号协方差的秩 $\\min\\{K, M_s, L\\}$ 是正确的。达到满秩 $K$ 的条件（$M_s \\ge K$ 和 $L \\ge K$）被正确陈述。关于噪声分量保持不变的陈述也是正确的。此描述与已建立的空间平滑理论完全一致。\n**结论：正确**\n\n**B. 仅使用不相交、不重叠的子阵列以避免偏差；重叠的子阵列会妨碍相干信源的解相干。只要 $M_s \\ge K$，子阵列的数量 $L$ 不会影响平均协方差的秩，并且相干信源可以在对 $L$ 没有任何要求的情况下被解相干。**\n此选项从根本上是错误的。重叠子阵列是标准且首选的方法，因为它们在给定的 $M$ 和 $M_s$ 下最大化了子阵列的数量 $L$，从而提高了秩恢复能力。声称重叠会妨碍解相干是错误的。此外，声称 $L$ 无关紧要也是错误的；条件 $L \\ge K$至关重要。\n**结论：错误**\n\n**C. 不划分阵列；而是在快拍维度上对全阵列协方差进行平均，以随时间随机化相位。这种平均将噪声方差降低 $L$ 倍，并且通常即使在 $M_s = 1$ 的情况下也能分辨相干信源。**\n此选项错误地将时间平均（在快拍上平均）描述为解相干的方法。相干性是信源信号互相关的属性，不受时间平均的影响。时间平均用于估计协方差矩阵，而不是改变其固有的秩结构。关于降低噪声方差和在 $M_s=1$ 时分辨信源的说法也是错误的。\n**结论：错误**\n\n**D. 通过在平均之前减去每个子阵列输出的均值来构建平滑协方差，以消除相干性。此操作仅在 $L \\ge 2K$ 的条件下才能对相干信源解相干，而与 $M_s$ 无关，并且得到的平滑协方差的秩为 $L$，噪声方差增加了 $L$ 倍。**\n此选项完全错误。减去均值（如果信号不是零均值）不影响与相干性相关的协方差结构。条件（$L \\ge 2K$，$M_s$ 无关）、最终的秩（秩为 $L$）以及对噪声的影响（方差增加 $L$ 倍）都是关于空间平滑的错误陈述。\n**结论：错误**\n\n**E. 空间平滑要求 $M_s + L - 1 \\ge K$；在此单一条件下，相干信源总能被解相干，且信号子空间的秩等于 $K$，这与子阵列如何构建或它们是否重叠无关。**\n此选项提出了一个必要但不充分的条件。关系式 $M = M_s + L - 1$ 意味着这个条件仅仅是 $M \\ge K$，即传感器总数必须至少等于信源数量。虽然这是对的，但这不足以保证通过空间平滑实现解相干。充分条件是 $M_s \\ge K$ 和 $L \\ge K$，这两者共同对 $M$ 提出了更严格的要求，即对于前向平滑，$M \\ge 2K-1$。声称它与子阵列的构建方式无关也是错误的。\n**结论：错误**", "answer": "$$\\boxed{A}$$", "id": "2908526"}, {"introduction": "即使阵列设计合理且信号不相干，任何算法的性能也存在极限。一个核心问题是：两个信号需要多近，MUSIC 算法才无法将它们分辨出来？这项实践深入探讨了 MUSIC 算法的分辨率极限，将其性能与数据协方差矩阵的内在数学结构，特别是信号与噪声子空间特征值之间的“间隙”直接联系起来。通过分析信噪比 (SNR)、阵元数 $N$ 和信号间隔等因素的作用 [@problem_id:2908507]，您将对 MUSIC 的性能边界建立起深刻的直觉，并理解其为何被称为“高分辨率”方法。", "problem": "考虑两个间距相近、功率相等、不相关的窄带复正弦波，它们入射到一个由$N$个传感器组成的均匀线性阵列（ULA）上；或者等效地，通过一个由$N$个连续采样构成的$N$维快照矢量观察到的两个间距相近的时间正弦波。设加性噪声为空间（时间）上白色的、零均值、方差为$\\sigma^2$的圆对称复高斯噪声，并且有$M$个独立同分布（i.i.d.）的快照可用。数据协方差为$R_x \\in \\mathbb{C}^{N \\times N}$，其样本估计为$\\hat R_x$。多重信号分类（MUSIC）方法通过利用$R_x$的信号子空间和噪声子空间之间的分离来分辨频率。\n\n假设采用通常的窄带线性模型 $x = A s + w$，其中 $A = \\big[a(\\omega_1)\\ a(\\omega_2)\\big]$, $s \\in \\mathbb{C}^{2}$, $w \\sim \\mathcal{CN}(0,\\sigma^2 I_N)$，以及导向矢量 $a(\\omega) = \\big[1,\\ e^{j \\omega},\\ \\dots,\\ e^{j (N-1) \\omega}\\big]^\\top$。设信源功率等于$p>0$，除非另有说明，信源是不相关的，并定义内积 $c = a(\\omega_1)^{\\mathrm{H}} a(\\omega_2)$。每个传感器的信噪比（SNR）被理解为$p/\\sigma^2$。\n\n选择所有正确描述两个间距相近的正弦波在何种条件下变得无法被MUSIC方法分辨，并将其与$R_x$的特征值分离特性正确关联的陈述。\n\nA. 在等功率、不相关的情况下，$R_x$的两个非噪声特征值为$\\lambda_{1,2} = \\sigma^2 + p \\big(N \\pm |c|\\big)$。当频率间隔$\\Delta \\omega = |\\omega_1 - \\omega_2| \\to 0$时，有$|c| \\to N$，因此$\\lambda_2 \\downarrow \\sigma^2$。在快照数量$M$有限的情况下，如果$p \\big(N - |c|\\big) \\lesssim \\|\\hat R_x - R_x\\|_2$，则信号子空间和噪声子空间会发生显著混合，MUSIC方法无法可靠地展现出两个不同的峰值。\n\nB. 如果两个正弦波是完全相干的（相关系数等于$1$），并且没有应用例如空间平滑这样的去相关预处理，那么信号协方差的秩为$1$，$R_x$只有一个严格大于$\\sigma^2$的特征值，因此即使在任意高的信噪比下，MUSIC方法也无法分辨出两个正弦波。\n\nC. 随着信噪比增加（即$p/\\sigma^2$增加），$R_x$的噪声特征值会增加并接近信号特征值，从而缩小特征值差距，降低MUSIC对间距相近的正弦波的分辨能力。\n\nD. 对于固定的频率间隔$\\Delta \\omega$，增加传感器数量$N$总是会减小最小信号特征值与噪声特征值之间的差距，从而总是损害MUSIC的分辨能力。\n\n选择所有适用项。", "solution": "该问题陈述已经过验证，被认为是科学上合理的、自洽的且提法恰当的。我们可以进行严谨的分析。\n\n这个问题的基础在于数据协方差矩阵$R_x$的特征分解。信号模型由$x = As + w$给出，其中$A = [a(\\omega_1)\\ a(\\omega_2)]$是$N \\times 2$的导向矩阵，$s$是$2 \\times 1$的信源信号矢量，$w$是$N \\times 1$的加性噪声矢量。协方差矩阵$R_x$为：\n$$R_x = E[x x^{\\mathrm{H}}] = E[(As+w)(As+w)^{\\mathrm{H}}] = A E[ss^{\\mathrm{H}}] A^{\\mathrm{H}} + E[ww^{\\mathrm{H}}]$$\n令$R_s = E[ss^{\\mathrm{H}}]$为信源协方差矩阵。噪声是白噪声，方差为$\\sigma^2$，所以$E[ww^{\\mathrm{H}}] = \\sigma^2 I_N$。因此，\n$$R_x = A R_s A^{\\mathrm{H}} + \\sigma^2 I_N$$\nMUSIC算法分辨两个信源的能力取决于$R_x$的特征值和特征向量的性质。具体来说，它要求由$A$的列向量张成的信号子空间能够可靠地与其正交补——噪声子空间——分离开来。这种分离是由信号特征值和噪声特征值之间的差距决定的。\n\n我们现在来评估每个陈述。\n\n**陈述 A 的分析**\n\n该陈述考虑的是两个功率相等（$p > 0$）、不相关的信源。在这种情况下，信源协方差矩阵是对角阵：$R_s = p I_2$。数据协方差矩阵变为：\n$$R_x = p A A^{\\mathrm{H}} + \\sigma^2 I_N$$\n$R_x$的特征值由$p\\mu_i + \\sigma^2$给出，其中$\\mu_i$是矩阵$A A^{\\mathrm{H}}$的特征值。$N \\times N$矩阵$A A^{\\mathrm{H}}$的非零特征值与$2 \\times 2$矩阵$A^{\\mathrm{H}} A$的特征值相同。我们计算$A^{\\mathrm{H}} A$：\n$$A^{\\mathrm{H}} A = \\begin{pmatrix} a(\\omega_1)^{\\mathrm{H}} a(\\omega_1) & a(\\omega_1)^{\\mathrm{H}} a(\\omega_2) \\\\ a(\\omega_2)^{\\mathrm{H}} a(\\omega_1) & a(\\omega_2)^{\\mathrm{H}} a(\\omega_2) \\end{pmatrix}$$\n根据导向矢量$a(\\omega)$的定义，我们有$a(\\omega)^{\\mathrm{H}} a(\\omega) = \\sum_{k=0}^{N-1} |e^{jk\\omega}|^2 = N$。非对角项定义为$c = a(\\omega_1)^{\\mathrm{H}} a(\\omega_2)$。因此，\n$$A^{\\mathrm{H}} A = \\begin{pmatrix} N & c \\\\ c^* & N \\end{pmatrix}$$\n该矩阵的特征值$\\mu$可以从特征方程$\\det(A^{\\mathrm{H}} A - \\mu I_2) = 0$求得，即$(N-\\mu)^2 - |c|^2 = 0$。这得到$\\mu = N \\pm |c|$。\n因此，$R_x$的两个信号特征值为$\\lambda_1 = p(N+|c|) + \\sigma^2$和$\\lambda_2 = p(N-|c|) + \\sigma^2$。其余的$N-2$个噪声特征值为$\\lambda_{3, \\dots, N} = \\sigma^2$。陈述中给出的非噪声特征值公式$\\lambda_{1,2} = \\sigma^2 + p \\big(N \\pm |c|\\big)$是正确的。\n\n接下来，我们研究当频率间隔$\\Delta\\omega = |\\omega_1 - \\omega_2| \\to 0$时的行为。内积为$c = \\sum_{k=0}^{N-1} e^{jk(\\omega_2-\\omega_1)}$。当$\\omega_2 \\to \\omega_1$时，每一项$e^{jk(\\omega_2-\\omega_1)} \\to 1$，所以$c \\to \\sum_{k=0}^{N-1} 1 = N$。因此，$|c| \\to N$。\n最小的信号特征值为$\\lambda_2 = \\sigma^2 + p(N-|c|)$。当$|c| \\to N$时，很明显$\\lambda_2 \\downarrow \\sigma^2$。信号子空间和噪声子空间之间的差距$\\lambda_2 - \\sigma^2 = p(N-|c|)$趋于零。\n\n在快照数量$M$有限的实际情况下，我们处理的是样本协方差矩阵$\\hat{R}_x$。估计误差$\\hat{R}_x - R_x$会扰动特征值和特征向量。矩阵扰动理论的一个基本结果是，如果真实矩阵$R_x$的特征值之间的间隔与扰动范数（即$\\|\\hat{R}_x - R_x\\|_2$）相比很小，那么相应的估计特征向量可能会发生严重混合。条件$p (N - |c|) \\lesssim \\|\\hat R_x - R_x\\|_2$精确地陈述了这一点：最小信号特征值与噪声水平之间的差距与统计估计误差在同一量级。在这种条件下，估计出的噪声子空间不再与信号子空间正交，MUSIC谱将无法产生对应于$\\omega_1$和$\\omega_2$的两个不同峰值。该陈述是对分辨极限的完整且正确的描述。\n\nA的结论：**正确**。\n\n**陈述 B 的分析**\n\n该陈述考虑的是完全相干的信源，定义为相关系数为$1$。这意味着信源信号是线性相关的；对于等功率的情况，我们可以写成$s_2(t) = s_1(t)$。信源矢量为$s = [s_1, s_1]^\\top = s_1 [1, 1]^\\top$。信源协方差矩阵为：\n$$R_s = E[s s^{\\mathrm{H}}] = E\\left[ s_1 [1, 1]^\\top s_1^* [1, 1] \\right] = E[|s_1|^2] \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} = p \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}$$\n矩阵$R_s$的秩为$1$。数据协方差的信号部分为$A R_s A^{\\mathrm{H}}$。\n$$A R_s A^{\\mathrm{H}} = p [a(\\omega_1) \\ a(\\omega_2)] \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} \\begin{pmatrix} a(\\omega_1)^{\\mathrm{H}} \\\\ a(\\omega_2)^{\\mathrm{H}} \\end{pmatrix} = p [a(\\omega_1) + a(\\omega_2)] [a(\\omega_1)^{\\mathrm{H}} + a(\\omega_2)^{\\mathrm{H}}] = p (a(\\omega_1) + a(\\omega_2)) (a(\\omega_1) + a(\\omega_2))^{\\mathrm{H}}$$\n这个矩阵是一个外积，其秩基本上为$1$。\n因此，完整的协方差矩阵$R_x = A R_s A^{\\mathrm{H}} + \\sigma^2 I_N$将有一个严格大于$\\sigma^2$的特征值和$N-1$个等于$\\sigma^2$的特征值。\nMUSIC算法将信源数量识别为信号特征值的数量。在这种情况下，它只找到一个。信号子空间被估计为$1$维，由单个矢量$a(\\omega_1)+a(\\omega_2)$张成。而真实的信号子空间是$2$维的，由$\\{a(\\omega_1), a(\\omega_2)\\}$张成。由于信号模型中的这种秩亏，MUSIC无法分辨这两个信源。正如所述，这种失效是结构性的，即使在无限信噪比或无限数量快照的情况下也持续存在。这是一个众所周知的局限性，需要像空间平滑这样的方法来预处理数据，以恢复协方差矩阵的秩。该陈述完全正确。\n\nB的结论：**正确**。\n\n**陈述 C 的分析**\n\n该陈述分析了增加信噪比（定义为$p/\\sigma^2$）的影响。我们可以通过增加信号功率$p$同时保持噪声方差$\\sigma^2$不变来模拟信噪比的增加。\n特征值为：\n信号特征值：$\\lambda_{1,2} = p(N \\pm |c|) + \\sigma^2$。\n噪声特征值：$\\lambda_k = \\sigma^2$，对于$k \\in \\{3, ..., N\\}$。\n\n随着$p$的增加，信号特征值$\\lambda_{1,2}$随$p$线性增加。噪声特征值$\\lambda_k = \\sigma^2$保持不变。\n该陈述声称“$R_x$的噪声特征值会增加”。这是错误的。\n它还声称它们“接近信号特征值”。这也是错误的；信号特征值离恒定的噪声特征值越来越远。\n最小信号特征值与噪声水平之间的差距是$\\lambda_2 - \\sigma^2 = p(N-|c|)$。随着$p$的增加，这个差距会变宽。更宽的差距导致信号和噪声子空间的分离更加鲁棒，从而*提高*了分辨能力。该陈述错误地声称差距缩小且分辨能力下降。该陈述中的每个断言都与事实相反。\n\nC的结论：**不正确**。\n\n**陈述 D 的分析**\n\n该陈述分析了在固定频率间隔$\\Delta\\omega$下增加传感器数量$N$的影响。\n最小信号特征值与噪声水平之间的差距是$G(N) = \\lambda_2 - \\sigma^2 = p(N - |c|)$。项$|c|$是$N$的函数：\n$$|c(N)| = \\left| \\sum_{k=0}^{N-1} e^{jk\\Delta\\omega} \\right| = \\left| \\frac{\\sin(N\\Delta\\omega/2)}{\\sin(\\Delta\\omega/2)} \\right|$$\n对于固定的$\\Delta\\omega \\ne 0$，分母$|\\sin(\\Delta\\omega/2)|$是一个非零常数。分子$|\\sin(N\\Delta\\omega/2)|$有界为$1$。因此，$|c(N)|$是关于$N$的一个有界的振荡函数：$|c(N)| \\le 1/|\\sin(\\Delta\\omega/2)|$。\n差距是$G(N) = p(N - |c(N)|)$。随着$N$的增加，项$N$线性增长，而$|c(N)|$保持有界。因此，差距$G(N)$近似随$N$线性增长。\n我们来分析从$N$到$N+1$的变化。\n$G(N+1) - G(N) = p[(N+1 - |c(N+1)|) - (N - |c(N)|)] = p[1 - (|c(N+1)| - |c(N)|)]$。\n我们知道$c(N+1) = c(N) + e^{jN\\Delta\\omega}$。根据三角不等式，有$|c(N+1)| \\le |c(N)| + |e^{jN\\Delta\\omega}| = |c(N)| + 1$。\n这意味着$|c(N+1)| - |c(N)| \\le 1$。\n因此，$G(N+1) - G(N) \\ge p[1 - 1] = 0$。差距$G(N)$是一个关于$N$的单调非减函数。\n该陈述声称增加$N$“总是会减小差距”。这在事实上是错误的；差距是非减的，并且通常是增加的。更大的差距和更大的阵列孔径（来自更多的传感器）都能显著增强分辨率。该陈述声称增加$N$“总是损害分辨能力”，这与阵列处理的一个基本原理完全相反。\n\nD的结论：**不正确**。", "answer": "$$\\boxed{AB}$$", "id": "2908507"}]}