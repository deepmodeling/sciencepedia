{"hands_on_practices": [{"introduction": "仿射投影算法 (APA) 的核心在于其优雅的几何解释：在最小化对当前滤波器系数扰动的同时，精确满足一组最新的数据约束。这个练习将引导你从最基本的优化原理出发，通过使用拉格朗日乘子法，推导出二阶 APA ($P=2$) 的更新方程 [@problem_id:2850728]。通过亲手推导并进行数值计算，你将深刻理解 APA 如何利用多个数据点的信息来加速收敛，并掌握其在实践中的具体实现。", "problem": "考虑一个长度为 $M$ 的自适应滤波器的实值单输入单输出线性有限脉冲响应系统辨识问题。设当前权重向量为 $\\mathbf{w}(n) \\in \\mathbb{R}^{M}$，并定义回归向量 $\\mathbf{x}(n), \\mathbf{x}(n-1) \\in \\mathbb{R}^{M}$ 及其对应的期望输出 $d(n), d(n-1) \\in \\mathbb{R}$。阶数 $P=2$ 的仿射投影算法 (APA) 旨在寻找一个更新增量 $\\Delta \\mathbf{w}(n) \\in \\mathbb{R}^{M}$，该增量对当前估计的扰动最小，同时满足最近的两个误差方程。最小扰动原则要求，更新后的估计 $\\mathbf{w}(n+1) = \\mathbf{w}(n) + \\mu \\,\\Delta \\mathbf{w}(n)$ 在欧几里得范数意义下尽可能接近 $\\mathbf{w}(n)$，同时在一个由非负正则化参数 $\\delta \\ge 0$ 和正步长 $\\mu > 0$ 控制的正则化意义下，将时刻 $n$ 和 $n-1$ 的一对后验方程驱动至相应的期望值。\n\n1) 从“更新增量 $\\Delta \\mathbf{w}(n)$ 在满足由最近两个数据方程所隐含的仿射约束的条件下，应具有最小欧几里得范数”这一基本优化原则出发，建立一个正则化约束优化问题，其解可产生 $P=2$ 阶仿射投影算法 (APA) 的更新。引入 Lagrange 乘子来施加这两个仿射约束，并对乘子加入一个参数为 $\\delta$ 的 Tikhonov 正则化项以保证数值稳定性。从第一性原理出发，推导 $\\Delta \\mathbf{w}(n)$ 的闭式表达式，该表达式用 $M \\times 2$ 的数据矩阵 $\\mathbf{X}(n) \\triangleq [\\,\\mathbf{x}(n)\\ \\ \\mathbf{x}(n-1)\\,]$、双样本先验误差向量 $\\mathbf{e}(n) \\triangleq \\begin{bmatrix} d(n) - \\mathbf{x}^{\\top}(n)\\mathbf{w}(n) \\\\ d(n-1) - \\mathbf{x}^{\\top}(n-1)\\mathbf{w}(n) \\end{bmatrix}$ 和正则化参数 $\\delta$ 来表示。明确展示更新增量如何是两个回归向量的线性组合，从而结合了两个误差方程中的信息。\n\n2) 使用您推导的表达式，为以下数据计算更新后的权重向量 $\\mathbf{w}(n+1)$ 的明确数值：设 $M=3$, $\\mathbf{w}(n) = \\mathbf{0}_{3\\times 1}$, $\\mathbf{x}(n) = \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix}$, $\\mathbf{x}(n-1) = \\begin{bmatrix} 0 \\\\ 1 \\\\ 1 \\end{bmatrix}$, $d(n) = 2$, $d(n-1)=1$，步长 $\\mu = 1$，正则化参数 $\\delta = 1$。将您最终的 $\\mathbf{w}(n+1)$ 答案表示为单个行向量。\n\n你的最终答案必须是作为行矩阵的单个更新后权重向量。无需四舍五入，且不涉及单位。", "solution": "所述问题具有科学依据、提法明确且客观。这是一个自适应信号处理中的标准问题，要求推导和应用仿射投影算法 (APA)。所提供的参数是一致的，并且足以得到唯一解。因此，该问题是有效的，我将着手进行解答。\n\n该问题分为两部分。第一部分要求推导阶数 $P=2$ 的仿射投影算法的更新增量 $\\Delta \\mathbf{w}(n)$。第二部分要求针对一组特定数据，数值计算更新后的权重向量 $\\mathbf{w}(n+1)$。\n\n第1部分：APA 更新增量的推导\n\nAPA 的核心原则是找到一个更新后的权重向量 $\\mathbf{w}(n+1)$，使其与当前向量 $\\mathbf{w}(n)$ 的差异最小，同时满足一组约束条件。更新由 $\\mathbf{w}(n+1) = \\mathbf{w}(n) + \\mu \\Delta\\mathbf{w}(n)$ 给出，其中 $\\mu > 0$ 是步长，$\\Delta\\mathbf{w}(n)$ 是更新增量。最小化扰动意味着最小化权重向量变化量的欧几里得范数，即 $\\|\\mathbf{w}(n+1) - \\mathbf{w}(n)\\|^2 = \\|\\mu \\Delta\\mathbf{w}(n)\\|^2$。由于 $\\mu$ 是一个正常数，这等价于最小化 $\\|\\Delta\\mathbf{w}(n)\\|^2$。\n\n约束条件是更新后的滤波器应满足最近两个期望输出关系。即，对于时刻 $n$ 和 $n-1$：\n$$ \\mathbf{x}^{\\top}(n)\\mathbf{w}(n+1) = d(n) $$\n$$ \\mathbf{x}^{\\top}(n-1)\\mathbf{w}(n+1) = d(n-1) $$\n代入 $\\mathbf{w}(n+1) = \\mathbf{w}(n) + \\mu \\Delta\\mathbf{w}(n)$，我们可以用更新增量 $\\Delta\\mathbf{w}(n)$ 来表示约束条件：\n$$ \\mathbf{x}^{\\top}(n)(\\mathbf{w}(n) + \\mu \\Delta\\mathbf{w}(n)) = d(n) \\implies \\mu \\mathbf{x}^{\\top}(n) \\Delta\\mathbf{w}(n) = d(n) - \\mathbf{x}^{\\top}(n)\\mathbf{w}(n) $$\n$$ \\mathbf{x}^{\\top}(n-1)(\\mathbf{w}(n) + \\mu \\Delta\\mathbf{w}(n)) = d(n-1) \\implies \\mu \\mathbf{x}^{\\top}(n-1) \\Delta\\mathbf{w}(n) = d(n-1) - \\mathbf{x}^{\\top}(n-1)\\mathbf{w}(n) $$\n使用已给出的数据矩阵 $\\mathbf{X}(n) \\triangleq [\\,\\mathbf{x}(n)\\ \\ \\mathbf{x}(n-1)\\,]$ 和先验误差向量 $\\mathbf{e}(n) \\triangleq \\begin{bmatrix} d(n) - \\mathbf{x}^{\\top}(n)\\mathbf{w}(n) \\\\ d(n-1) - \\mathbf{x}^{\\top}(n-1)\\mathbf{w}(n) \\end{bmatrix}$ 的定义，这两个标量约束可以紧凑地写成一个单一的向量方程：\n$$ \\mu \\mathbf{X}(n)^{\\top} \\Delta\\mathbf{w}(n) = \\mathbf{e}(n) $$\n因此，优化问题是找到能最小化代价函数 $J(\\Delta\\mathbf{w}(n)) = \\frac{1}{2}\\|\\Delta\\mathbf{w}(n)\\|^2$ 且满足线性约束 $\\mu \\mathbf{X}(n)^{\\top} \\Delta\\mathbf{w}(n) = \\mathbf{e}(n)$ 的 $\\Delta\\mathbf{w}(n)$。因子 $\\frac{1}{2}$ 是为了代数计算的方便。\n\n我们使用 Lagrange 乘子法来解决这个约束优化问题。我们引入一个 Lagrange 乘子向量 $\\boldsymbol{\\lambda} \\in \\mathbb{R}^2$ 并构造 Lagrangian 函数：\n$$ L(\\Delta\\mathbf{w}(n), \\boldsymbol{\\lambda}) = \\frac{1}{2} \\Delta\\mathbf{w}(n)^{\\top}\\Delta\\mathbf{w}(n) + \\boldsymbol{\\lambda}^{\\top}(\\mathbf{e}(n) - \\mu \\mathbf{X}(n)^{\\top}\\Delta\\mathbf{w}(n)) $$\n为了找到最小值，我们首先通过将 $L$ 对 $\\Delta\\mathbf{w}(n)$ 的梯度设为零来找到其驻点：\n$$ \\nabla_{\\Delta\\mathbf{w}(n)} L = \\Delta\\mathbf{w}(n) - \\mu \\mathbf{X}(n)\\boldsymbol{\\lambda} = \\mathbf{0} $$\n这给出了最优更新增量的结构：\n$$ \\Delta\\mathbf{w}(n) = \\mu \\mathbf{X}(n)\\boldsymbol{\\lambda} $$\n这个方程表明，更新增量 $\\Delta\\mathbf{w}(n)$ 是回归向量 $\\mathbf{x}(n)$ 和 $\\mathbf{x}(n-1)$（即 $\\mathbf{X}(n)$ 的列向量）的线性组合。\n\n问题指出应对乘子引入正则化。这通过对对偶问题进行正则化来实现。将 $\\Delta\\mathbf{w}(n)$ 的表达式代回 Lagrangian 函数，得到对偶目标函数 $L_D(\\boldsymbol{\\lambda})$：\n$$ L_D(\\boldsymbol{\\lambda}) = \\frac{1}{2}(\\mu \\mathbf{X}(n)\\boldsymbol{\\lambda})^{\\top}(\\mu \\mathbf{X}(n)\\boldsymbol{\\lambda}) + \\boldsymbol{\\lambda}^{\\top}(\\mathbf{e}(n) - \\mu \\mathbf{X}(n)^{\\top}(\\mu \\mathbf{X}(n)\\boldsymbol{\\lambda})) $$\n$$ L_D(\\boldsymbol{\\lambda}) = \\frac{\\mu^2}{2} \\boldsymbol{\\lambda}^{\\top}\\mathbf{X}(n)^{\\top}\\mathbf{X}(n)\\boldsymbol{\\lambda} + \\boldsymbol{\\lambda}^{\\top}\\mathbf{e}(n) - \\mu^2 \\boldsymbol{\\lambda}^{\\top}\\mathbf{X}(n)^{\\top}\\mathbf{X}(n)\\boldsymbol{\\lambda} $$\n$$ L_D(\\boldsymbol{\\lambda}) = \\boldsymbol{\\lambda}^{\\top}\\mathbf{e}(n) - \\frac{\\mu^2}{2} \\boldsymbol{\\lambda}^{\\top}\\mathbf{X}(n)^{\\top}\\mathbf{X}(n)\\boldsymbol{\\lambda} $$\n最大化此对偶函数可得到 Lagrange 乘子。为了按要求对乘子加入 Tikhonov 正则化，我们从对偶目标函数中减去一个二次惩罚项 $\\frac{\\delta}{2}\\|\\boldsymbol{\\lambda}\\|^2$，其中 $\\delta \\ge 0$ 是正则化参数。正则化的对偶目标函数为：\n$$ L_{D,reg}(\\boldsymbol{\\lambda}) = \\boldsymbol{\\lambda}^{\\top}\\mathbf{e}(n) - \\frac{\\mu^2}{2} \\boldsymbol{\\lambda}^{\\top}\\mathbf{X}(n)^{\\top}\\mathbf{X}(n)\\boldsymbol{\\lambda} - \\frac{\\delta}{2} \\boldsymbol{\\lambda}^{\\top}\\boldsymbol{\\lambda} $$\n为了最大化 $L_{D,reg}(\\boldsymbol{\\lambda})$，我们将其关于 $\\boldsymbol{\\lambda}$ 的梯度设为零：\n$$ \\nabla_{\\boldsymbol{\\lambda}} L_{D,reg} = \\mathbf{e}(n) - \\mu^2 \\mathbf{X}(n)^{\\top}\\mathbf{X}(n)\\boldsymbol{\\lambda} - \\delta \\boldsymbol{\\lambda} = \\mathbf{0} $$\n重新整理以求解 $\\boldsymbol{\\lambda}$：\n$$ (\\mu^2 \\mathbf{X}(n)^{\\top}\\mathbf{X}(n) + \\delta \\mathbf{I}) \\boldsymbol{\\lambda} = \\mathbf{e}(n) $$\n其中 $\\mathbf{I}$ 是 $2 \\times 2$ 的单位矩阵。对于 $\\delta > 0$，矩阵 $(\\mu^2 \\mathbf{X}(n)^{\\top}\\mathbf{X}(n) + \\delta \\mathbf{I})$ 保证是正定的，因此是可逆的。Lagrange 乘子为：\n$$ \\boldsymbol{\\lambda} = (\\mu^2 \\mathbf{X}(n)^{\\top}\\mathbf{X}(n) + \\delta \\mathbf{I})^{-1} \\mathbf{e}(n) $$\n最后，我们将这个 $\\boldsymbol{\\lambda}$ 的表达式代回到 $\\Delta\\mathbf{w}(n)$ 的方程中：\n$$ \\Delta\\mathbf{w}(n) = \\mu \\mathbf{X}(n) (\\mu^2 \\mathbf{X}(n)^{\\top}\\mathbf{X}(n) + \\delta \\mathbf{I})^{-1} \\mathbf{e}(n) $$\n这就是更新增量的闭式表达式，它表明了该增量是 $\\mathbf{X}(n)$ 列向量的线性组合。\n\n第2部分：数值计算\n\n我们有以下给定数据：\n- 滤波器长度 $M=3$。\n- 初始权重 $\\mathbf{w}(n) = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix}$。\n- 回归向量 $\\mathbf{x}(n) = \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix}$ 和 $\\mathbf{x}(n-1) = \\begin{bmatrix} 0 \\\\ 1 \\\\ 1 \\end{bmatrix}$。\n- 期望输出 $d(n) = 2$ 和 $d(n-1)=1$。\n- 步长 $\\mu = 1$。\n- 正则化参数 $\\delta = 1$。\n\n首先，我们构造数据矩阵 $\\mathbf{X}(n)$ 和先验误差向量 $\\mathbf{e}(n)$。\n$$ \\mathbf{X}(n) = [\\,\\mathbf{x}(n)\\ \\ \\mathbf{x}(n-1)\\,] = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{bmatrix} $$\n先验误差向量的分量为：\n$$ e(n) = d(n) - \\mathbf{x}^{\\top}(n)\\mathbf{w}(n) = 2 - \\begin{bmatrix} 1 & 0 & 1 \\end{bmatrix}\\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix} = 2 $$\n$$ e(n-1) = d(n-1) - \\mathbf{x}^{\\top}(n-1)\\mathbf{w}(n) = 1 - \\begin{bmatrix} 0 & 1 & 1 \\end{bmatrix}\\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix} = 1 $$\n所以，误差向量为 $\\mathbf{e}(n) = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}$。\n\n接下来，我们计算矩阵乘积 $\\mathbf{X}(n)^{\\top}\\mathbf{X}(n)$：\n$$ \\mathbf{X}(n)^{\\top}\\mathbf{X}(n) = \\begin{bmatrix} 1 & 0 & 1 \\\\ 0 & 1 & 1 \\end{bmatrix} \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{bmatrix} = \\begin{bmatrix} (1)(1)+(0)(0)+(1)(1) & (1)(0)+(0)(1)+(1)(1) \\\\ (0)(1)+(1)(0)+(1)(1) & (0)(0)+(1)(1)+(1)(1) \\end{bmatrix} = \\begin{bmatrix} 2 & 1 \\\\ 1 & 2 \\end{bmatrix} $$\n现在我们使用 $\\mu=1$ 和 $\\delta=1$ 来构造待求逆的矩阵：\n$$ \\mu^2 \\mathbf{X}(n)^{\\top}\\mathbf{X}(n) + \\delta \\mathbf{I} = (1)^2 \\begin{bmatrix} 2 & 1 \\\\ 1 & 2 \\end{bmatrix} + (1) \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} = \\begin{bmatrix} 2 & 1 \\\\ 1 & 2 \\end{bmatrix} + \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} = \\begin{bmatrix} 3 & 1 \\\\ 1 & 3 \\end{bmatrix} $$\n这个 $2 \\times 2$ 矩阵的逆是：\n$$ \\left(\\begin{bmatrix} 3 & 1 \\\\ 1 & 3 \\end{bmatrix}\\right)^{-1} = \\frac{1}{(3)(3)-(1)(1)} \\begin{bmatrix} 3 & -1 \\\\ -1 & 3 \\end{bmatrix} = \\frac{1}{8} \\begin{bmatrix} 3 & -1 \\\\ -1 & 3 \\end{bmatrix} $$\n现在我们可以计算更新增量 $\\Delta\\mathbf{w}(n)$：\n$$ \\Delta\\mathbf{w}(n) = \\mu \\mathbf{X}(n) (\\mu^2 \\mathbf{X}(n)^{\\top}\\mathbf{X}(n) + \\delta \\mathbf{I})^{-1} \\mathbf{e}(n) $$\n$$ \\Delta\\mathbf{w}(n) = (1) \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{bmatrix} \\left( \\frac{1}{8} \\begin{bmatrix} 3 & -1 \\\\ -1 & 3 \\end{bmatrix} \\right) \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} $$\n$$ \\Delta\\mathbf{w}(n) = \\frac{1}{8} \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{bmatrix} \\begin{bmatrix} (3)(2)+(-1)(1) \\\\ (-1)(2)+(3)(1) \\end{bmatrix} = \\frac{1}{8} \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{bmatrix} \\begin{bmatrix} 5 \\\\ 1 \\end{bmatrix} $$\n$$ \\Delta\\mathbf{w}(n) = \\frac{1}{8} \\begin{bmatrix} (1)(5)+(0)(1) \\\\ (0)(5)+(1)(1) \\\\ (1)(5)+(1)(1) \\end{bmatrix} = \\frac{1}{8} \\begin{bmatrix} 5 \\\\ 1 \\\\ 6 \\end{bmatrix} = \\begin{bmatrix} 5/8 \\\\ 1/8 \\\\ 6/8 \\end{bmatrix} = \\begin{bmatrix} 5/8 \\\\ 1/8 \\\\ 3/4 \\end{bmatrix} $$\n最后，我们计算更新后的权重向量 $\\mathbf{w}(n+1)$：\n$$ \\mathbf{w}(n+1) = \\mathbf{w}(n) + \\mu \\Delta\\mathbf{w}(n) = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix} + (1) \\begin{bmatrix} 5/8 \\\\ 1/8 \\\\ 3/4 \\end{bmatrix} = \\begin{bmatrix} 5/8 \\\\ 1/8 \\\\ 3/4 \\end{bmatrix} $$\n最终答案要求表示为单个行向量。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{5}{8} & \\frac{1}{8} & \\frac{3}{4} \\end{pmatrix} } $$", "id": "2850728"}, {"introduction": "理解了算法的更新机制后，下一步是评估其性能。过量均方误差 (Excess Mean-Square Error, EMSE) 是衡量自适应滤波器稳态性能的关键指标。本练习探讨了一个理想化但极具启发性的场景——白噪声输入，并要求你推导在该条件下 APA 的稳态 EMSE [@problem_id:2850820]。通过这个推导，你将发现一个深刻的结论：对于不相关输入，增加投影阶数 $P$ 并不能改善稳态误差，这促使我们深入理解算法性能与输入信号统计特性之间的相互作用。", "problem": "考虑辨识一个由零均值白噪声输入驱动的长度为 $M$ 的线性时不变系统。期望响应的模型为\n$$\nd(n) \\;=\\; \\mathbf{x}^{\\top}(n)\\,\\mathbf{w}_{o} \\;+\\; v(n),\n$$\n其中 $\\mathbf{x}(n)\\in\\mathbb{R}^{M}$ 是一个零均值白噪声输入，其协方差为 $\\mathbb{E}\\{\\mathbf{x}(n)\\mathbf{x}^{\\top}(n)\\}=\\sigma_{x}^{2}\\mathbf{I}_{M}$，$\\mathbf{w}_{o}\\in\\mathbb{R}^{M}$ 是未知的参数向量，而 $v(n)$ 是一个零均值白噪声扰动，其方差为 $\\sigma_{v}^{2}$，且与 $\\mathbf{x}(n)$ 独立。\n\n使用一个阶数为 $P$ 的仿射投影算法 (Affine Projection Algorithm, APA)（无对角加载）来自适应地估计 $\\mathbf{w}(n)$。定义 $M\\times P$ 的回归矩阵和 $P\\times 1$ 的期望向量\n$$\n\\mathbf{X}(n) \\;=\\; \\big[\\mathbf{x}(n),\\,\\mathbf{x}(n-1),\\,\\ldots,\\,\\mathbf{x}(n-P+1)\\big],\\qquad\n\\mathbf{d}(n) \\;=\\; \\big[d(n),\\,d(n-1),\\,\\ldots,\\,d(n-P+1)\\big]^{\\top},\n$$\n以及 $P\\times 1$ 的先验误差向量\n$$\n\\mathbf{e}(n) \\;=\\; \\mathbf{d}(n) \\;-\\; \\mathbf{X}^{\\top}(n)\\,\\mathbf{w}(n).\n$$\nAPA的更新方程为\n$$\n\\mathbf{w}(n+1) \\;=\\; \\mathbf{w}(n) \\;+\\; \\mu\\,\\mathbf{X}(n)\\big(\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)\\big)^{-1}\\mathbf{e}(n),\n$$\n其中 $\\mu\\in(0,2)$ 是一个恒定的步长，并假设 $P\\leq M$，因此对于白噪声输入，$\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)$ 几乎必然是可逆的。定义稳态超量均方误差 (Excess Mean-Square Error, EMSE) 为\n$$\n\\mathrm{EMSE} \\;\\triangleq\\; \\mathbb{E}\\big\\{\\big(\\mathbf{x}^{\\top}(n)\\big(\\mathbf{w}_{o}-\\mathbf{w}(n)\\big)\\big)^{2}\\big\\}.\n$$\n\n从更新方程的定义、$\\mathbf{x}(n)$ 的白噪声特性以及自适应滤波器稳态分析中使用的标准独立性假设出发，推导稳态EMSE作为 $\\mu$ 和 $\\sigma_{v}^{2}$ 的函数的闭式表达式，该表达式适用于任意投影阶数 $P$。然后，将您的表达式具体化到 $P\\in\\{1,2,4\\}$ 的情况，并按此顺序报告这三个EMSE值。\n\n您必须：\n- 从给定的定义和白噪声输入模型出发；不要在没有推导的情况下引用目标结果。\n- 对您使用的任何近似进行论证，包括对随机矩阵使用期望。\n- 明确说明在所述假设下，稳态EMSE是否依赖于 $P$，并解释原因。\n\n将您的最终答案表示为三个闭式解析表达式（对应于 $P=1,2,4$），仅使用 $\\mu$ 和 $\\sigma_{v}^{2}$ 表示。不需要进行数值计算。", "solution": "对问题陈述的科学有效性、完整性和客观性进行审视。\n\n**第一步：提取已知条件**\n- 系统模型：$d(n) = \\mathbf{x}^{\\top}(n)\\mathbf{w}_{o} + v(n)$。\n- 输入向量：$\\mathbf{x}(n) \\in \\mathbb{R}^{M}$ 是一个零均值白噪声向量过程。\n- 输入协方差：$\\mathbb{E}\\{\\mathbf{x}(n)\\mathbf{x}^{\\top}(n)\\} = \\sigma_{x}^{2}\\mathbf{I}_{M}$。\n- 未知系统向量：$\\mathbf{w}_{o} \\in \\mathbb{R}^{M}$。\n- 扰动：$v(n)$ 是一个零均值白噪声过程，其方差为 $\\sigma_{v}^{2}$，与 $\\mathbf{x}(n)$ 独立。\n- APA 投影阶数：$P$。\n- 回归矩阵：$\\mathbf{X}(n) = [\\mathbf{x}(n), \\mathbf{x}(n-1), \\ldots, \\mathbf{x}(n-P+1)]$。\n- 期望响应向量：$\\mathbf{d}(n) = [d(n), d(n-1), \\ldots, d(n-P+1)]^{\\top}$。\n- 先验误差向量：$\\mathbf{e}(n) = \\mathbf{d}(n) - \\mathbf{X}^{\\top}(n)\\mathbf{w}(n)$。\n- APA 更新方程：$\\mathbf{w}(n+1) = \\mathbf{w}(n) + \\mu\\,\\mathbf{X}(n)(\\mathbf{X}^{\\top}(n)\\mathbf{X}(n))^{-1}\\mathbf{e}(n)$。\n- 步长：$\\mu \\in (0,2)$。\n- 可逆性条件：$P \\le M$，且 $\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)$ 是可逆的。\n- EMSE 定义：$\\mathrm{EMSE} \\triangleq \\mathbb{E}\\{(\\mathbf{x}^{\\top}(n)(\\mathbf{w}_{o}-\\mathbf{w}(n)))^{2}\\}$。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据：**该问题是自适应滤波器分析中的一个标准练习，特别是关于仿射投影算法 (APA) 的。所有定义和模型均来自信号处理领域的既定理论。\n- **适定性：**该问题为推导一个特定量 (EMSE) 提供了所有必要的定义和统计特性。它要求一个唯一的解析表达式。\n- **客观性：**该问题以精确的数学语言陈述，没有主观或含糊的术语。\n- **结论：**问题陈述是有效的。它是自洽的、科学上合理的且适定的。可以进行严谨的推导。\n\n**第三步：判定与行动**\n问题是有效的。现在开始推导解。\n\n我们首先定义权重误差向量为 $\\tilde{\\mathbf{w}}(n) \\triangleq \\mathbf{w}(n) - \\mathbf{w}_{o}$。在 APA 更新方程的两边同时减去 $\\mathbf{w}_{o}$，得到权重误差向量的更新方程：\n$$\n\\tilde{\\mathbf{w}}(n+1) = \\tilde{\\mathbf{w}}(n) + \\mu\\,\\mathbf{X}(n)\\big(\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)\\big)^{-1}\\mathbf{e}(n).\n$$\n先验误差向量 $\\mathbf{e}(n)$ 可以用权重误差向量来表示。期望向量 $\\mathbf{d}(n)$ 的第 $i$ 个元素是 $d(n-i) = \\mathbf{x}^{\\top}(n-i)\\mathbf{w}_{o} + v(n-i)$。写成矩阵形式，即为：\n$$\n\\mathbf{d}(n) = \\mathbf{X}^{\\top}(n)\\mathbf{w}_{o} + \\mathbf{v}(n),\n$$\n其中 $\\mathbf{v}(n) = [v(n), v(n-1), \\ldots, v(n-P+1)]^{\\top}$。将此代入 $\\mathbf{e}(n)$ 的定义中：\n$$\n\\mathbf{e}(n) = \\mathbf{X}^{\\top}(n)\\mathbf{w}_{o} + \\mathbf{v}(n) - \\mathbf{X}^{\\top}(n)\\mathbf{w}(n) = \\mathbf{v}(n) - \\mathbf{X}^{\\top}(n)\\tilde{\\mathbf{w}}(n).\n$$\n将此代回误差向量的更新方程中，得到：\n$$\n\\tilde{\\mathbf{w}}(n+1) = \\tilde{\\mathbf{w}}(n) + \\mu\\,\\mathbf{X}(n)\\big(\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)\\big)^{-1}\\big(\\mathbf{v}(n) - \\mathbf{X}^{\\top}(n)\\tilde{\\mathbf{w}}(n)\\big).\n$$\n整理各项，我们得到：\n$$\n\\tilde{\\mathbf{w}}(n+1) = \\left[\\mathbf{I}_{M} - \\mu\\,\\mathbf{X}(n)\\big(\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)\\big)^{-1}\\mathbf{X}^{\\top}(n)\\right]\\tilde{\\mathbf{w}}(n) + \\mu\\,\\mathbf{X}(n)\\big(\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)\\big)^{-1}\\mathbf{v}(n).\n$$\n为分析稳态行为，我们采用能量守恒论证。我们取两边的欧几里得范数的平方：\n$$\n\\|\\tilde{\\mathbf{w}}(n+1)\\|^{2} = \\tilde{\\mathbf{w}}^{\\top}(n+1)\\tilde{\\mathbf{w}}(n+1).\n$$\n在稳态下取期望，我们有 $\\mathbb{E}\\{\\|\\tilde{\\mathbf{w}}(n+1)\\|^{2}\\} = \\mathbb{E}\\{\\|\\tilde{\\mathbf{w}}(n)\\|^{2}\\}$。这意味着能量变化的期望为零。对更新方程的范数平方取期望并消去这些项，可以得到一个稳态能量平衡方程。一个更直接的方法是先求 $\\tilde{\\mathbf{w}}(n+1)$ 的范数平方，然后应用期望。\n我们分析平方后的各项。为简便起见，我们定义矩阵 $\\mathbf{A}(n) = (\\mathbf{X}^{\\top}(n)\\mathbf{X}(n))^{-1}$ 和投影矩阵 $\\mathbf{P}_{\\mathbf{X}}(n) = \\mathbf{X}(n)\\mathbf{A}(n)\\mathbf{X}^{\\top}(n)$。更新方程为 $\\tilde{\\mathbf{w}}(n+1) = (\\mathbf{I}_M - \\mu\\mathbf{P}_{\\mathbf{X}}(n))\\tilde{\\mathbf{w}}(n) + \\mu\\mathbf{X}(n)\\mathbf{A}(n)\\mathbf{v}(n)$。\n平方产生的交叉项是 $2\\mu\\tilde{\\mathbf{w}}^{\\top}(n)(\\mathbf{I}_M - \\mu\\mathbf{P}_{\\mathbf{X}}(n))^{\\top}\\mathbf{X}(n)\\mathbf{A}(n)\\mathbf{v}(n)$。\n在稳态下，我们援引标准的独立性假设：权重误差向量 $\\tilde{\\mathbf{w}}(n)$ 在统计上独立于输入回归矩阵 $\\mathbf{X}(n)$ 和噪声向量 $\\mathbf{v}(n)$。由于 $\\mathbf{v}(n)$ 是零均值的，这个交叉项的期望为零。\n因此，对范数平方取期望得到：\n$$\n\\mathbb{E}\\{\\|\\tilde{\\mathbf{w}}(n+1)\\|^{2}\\} = \\mathbb{E}\\{\\|(\\mathbf{I}_{M} - \\mu\\mathbf{P}_{\\mathbf{X}}(n))\\tilde{\\mathbf{w}}(n)\\|^{2}\\} + \\mu^{2}\\mathbb{E}\\{\\|\\mathbf{X}(n)\\mathbf{A}(n)\\mathbf{v}(n)\\|^{2}\\}.\n$$\n在稳态下，$\\mathbb{E}\\{\\|\\tilde{\\mathbf{w}}(n+1)\\|^{2}\\} = \\mathbb{E}\\{\\|\\tilde{\\mathbf{w}}(n)\\|^{2}\\} \\triangleq \\xi$。\n$$\n\\xi = \\mathbb{E}\\{\\tilde{\\mathbf{w}}^{\\top}(n)(\\mathbf{I}_{M} - \\mu\\mathbf{P}_{\\mathbf{X}}(n))^{2}\\tilde{\\mathbf{w}}(n)\\} + \\mu^{2}\\mathbb{E}\\{\\mathbf{v}^{\\top}(n)\\mathbf{A}(n)\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)\\mathbf{A}(n)\\mathbf{v}(n)\\}.\n$$\n由于 $\\mathbf{P}_{\\mathbf{X}}(n)$ 是一个投影矩阵，$\\mathbf{P}_{\\mathbf{X}}^{2}(n)=\\mathbf{P}_{\\mathbf{X}}(n)$。第一项变为：\n$$\n\\mathbb{E}\\{\\tilde{\\mathbf{w}}^{\\top}(n)(\\mathbf{I}_{M} - (2\\mu-\\mu^2)\\mathbf{P}_{\\mathbf{X}}(n))\\tilde{\\mathbf{w}}(n)\\} = \\xi - (2\\mu-\\mu^2)\\mathbb{E}\\{\\tilde{\\mathbf{w}}^{\\top}(n)\\mathbf{P}_{\\mathbf{X}}(n)\\tilde{\\mathbf{w}}(n)\\}.\n$$\n第二项简化为 $\\mu^{2}\\mathbb{E}\\{\\mathbf{v}^{\\top}(n)\\mathbf{A}(n)\\mathbf{v}(n)\\}$。平衡方程为：\n$$\n(2\\mu-\\mu^2)\\mathbb{E}\\{\\tilde{\\mathbf{w}}^{\\top}(n)\\mathbf{P}_{\\mathbf{X}}(n)\\tilde{\\mathbf{w}}(n)\\} = \\mu^{2}\\mathbb{E}\\{\\mathbf{v}^{\\top}(n)\\mathbf{A}(n)\\mathbf{v}(n)\\}.\n$$\n对于 $\\mu \\neq 0$，我们可以除以 $\\mu$：\n$$\n(2-\\mu)\\mathbb{E}\\{\\tilde{\\mathbf{w}}^{\\top}(n)\\mathbf{P}_{\\mathbf{X}}(n)\\tilde{\\mathbf{w}}(n)\\} = \\mu\\mathbb{E}\\{\\mathbf{v}^{\\top}(n)\\mathbf{A}(n)\\mathbf{v}(n)\\}.\n$$\n现在我们计算期望值。我们使用迹算子和独立性假设。令 $\\mathbf{C} = \\mathbb{E}\\{\\tilde{\\mathbf{w}}(n)\\tilde{\\mathbf{w}}^{\\top}(n)\\}$ 为稳态权重误差协方差矩阵。\n右侧(RHS)的期望是：\n$$\n\\mathbb{E}\\{\\mathbf{v}^{\\top}(n)\\mathbf{A}(n)\\mathbf{v}(n)\\} = \\mathbb{E}\\{\\mathrm{Tr}(\\mathbf{A}(n)\\mathbf{v}(n)\\mathbf{v}^{\\top}(n))\\} = \\mathrm{Tr}(\\mathbb{E}\\{\\mathbf{A}(n)\\}\\mathbb{E}\\{\\mathbf{v}(n)\\mathbf{v}^{\\top}(n)\\}).\n$$\n由于 $v(n)$ 是一个白噪声过程，$\\mathbb{E}\\{\\mathbf{v}(n)\\mathbf{v}^{\\top}(n)\\} = \\sigma_{v}^{2}\\mathbf{I}_{P}$。\n对于白噪声输入向量过程 $\\mathbf{x}(n)$，当 $i \\neq j$ 时，向量 $\\mathbf{x}(n-i)$ 和 $\\mathbf{x}(n-j)$ 是不相关的。$\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)$ 的第 $(i,j)$ 个元素是 $\\mathbf{x}^{\\top}(n-i+1)\\mathbf{x}(n-j+1)$。其期望为 $\\mathbb{E}\\{\\mathbf{x}^{\\top}(n-i+1)\\mathbf{x}(n-j+1)\\} = \\mathrm{Tr}(\\mathbb{E}\\{\\mathbf{x}(n-j+1)\\mathbf{x}^{\\top}(n-i+1)\\}) = \\delta_{ij}\\mathrm{Tr}(\\sigma_{x}^{2}\\mathbf{I}_{M}) = M\\sigma_{x}^{2}\\delta_{ij}$。\n因此，$\\mathbb{E}\\{\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)\\} = M\\sigma_{x}^{2}\\mathbf{I}_{P}$。我们使用常见的近似 $\\mathbb{E}\\{\\mathbf{A}(n)\\} = \\mathbb{E}\\{(\\mathbf{X}^{\\top}(n)\\mathbf{X}(n))^{-1}\\} \\approx (\\mathbb{E}\\{\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)\\})^{-1} = (M\\sigma_{x}^{2})^{-1}\\mathbf{I}_{P}$。对于小步长 $\\mu$，这个近似是合理的。\n右侧的期望变为：\n$$\n\\mathrm{Tr}((M\\sigma_{x}^{2})^{-1}\\mathbf{I}_{P} \\cdot \\sigma_{v}^{2}\\mathbf{I}_{P}) = \\frac{\\sigma_{v}^{2}}{M\\sigma_{x}^{2}}\\mathrm{Tr}(\\mathbf{I}_{P}) = \\frac{P\\sigma_{v}^{2}}{M\\sigma_{x}^{2}}.\n$$\n左侧(LHS)的期望是：\n$$\n\\mathbb{E}\\{\\tilde{\\mathbf{w}}^{\\top}(n)\\mathbf{P}_{\\mathbf{X}}(n)\\tilde{\\mathbf{w}}(n)\\} = \\mathbb{E}\\{\\mathrm{Tr}(\\mathbf{P}_{\\mathbf{X}}(n)\\tilde{\\mathbf{w}}(n)\\tilde{\\mathbf{w}}^{\\top}(n))\\} = \\mathrm{Tr}(\\mathbb{E}\\{\\mathbf{P}_{\\mathbf{X}}(n)\\}\\mathbf{C}).\n$$\n对于白噪声输入，其统计特性是各向同性的。期望投影矩阵 $\\mathbb{E}\\{\\mathbf{P}_{\\mathbf{X}}(n)\\}$ 必须与单位矩阵成比例，即 $\\mathbb{E}\\{\\mathbf{P}_{\\mathbf{X}}(n)\\} = c\\mathbf{I}_{M}$。常数 $c$ 可以通过迹来求得：$\\mathrm{Tr}(\\mathbb{E}\\{\\mathbf{P}_{\\mathbf{X}}(n)\\}) = \\mathbb{E}\\{\\mathrm{Tr}(\\mathbf{P}_{\\mathbf{X}}(n))\\} = \\mathbb{E}\\{\\mathrm{Tr}(\\mathbf{I}_{P})\\} = P$。所以，$cM = P$，这意味着 $c = P/M$。\n因此，$\\mathbb{E}\\{\\mathbf{P}_{\\mathbf{X}}(n)\\} = \\frac{P}{M}\\mathbf{I}_{M}$。\n左侧的期望是 $\\mathrm{Tr}(\\frac{P}{M}\\mathbf{I}_{M}\\mathbf{C}) = \\frac{P}{M}\\mathrm{Tr}(\\mathbf{C})$。\n将这些结果代回能量平衡方程：\n$$\n(2-\\mu)\\frac{P}{M}\\mathrm{Tr}(\\mathbf{C}) = \\mu\\frac{P\\sigma_{v}^{2}}{M\\sigma_{x}^{2}}.\n$$\n项 $P$ 和 $M$ 在等式两边被消掉，这是一个关键的观察。\n$$\n(2-\\mu)\\mathrm{Tr}(\\mathbf{C}) = \\frac{\\mu\\sigma_{v}^{2}}{\\sigma_{x}^{2}}.\n$$\n解出 $\\mathrm{Tr}(\\mathbf{C})$：\n$$\n\\mathrm{Tr}(\\mathbf{C}) = \\frac{\\mu}{(2-\\mu)}\\frac{\\sigma_{v}^{2}}{\\sigma_{x}^{2}}.\n$$\nEMSE 定义为 $\\mathrm{EMSE} = \\mathbb{E}\\{(\\mathbf{x}^{\\top}(n)\\tilde{\\mathbf{w}}(n))^{2}\\} = \\mathbb{E}\\{\\mathbf{x}^{\\top}(n)\\tilde{\\mathbf{w}}(n)\\tilde{\\mathbf{w}}^{\\top}(n)\\mathbf{x}(n)\\}$。利用稳态下 $\\mathbf{x}(n)$ 和 $\\tilde{\\mathbf{w}}(n)$ 的独立性：\n$$\n\\mathrm{EMSE} = \\mathbb{E}\\{\\mathrm{Tr}(\\mathbf{x}(n)\\mathbf{x}^{\\top}(n)\\tilde{\\mathbf{w}}(n)\\tilde{\\mathbf{w}}^{\\top}(n))\\} = \\mathrm{Tr}(\\mathbb{E}\\{\\mathbf{x}(n)\\mathbf{x}^{\\top}(n)\\}\\mathbb{E}\\{\\tilde{\\mathbf{w}}(n)\\tilde{\\mathbf{w}}^{\\top}(n)\\}).\n$$\n$$\n\\mathrm{EMSE} = \\mathrm{Tr}(\\sigma_{x}^{2}\\mathbf{I}_{M}\\mathbf{C}) = \\sigma_{x}^{2}\\mathrm{Tr}(\\mathbf{C}).\n$$\n代入 $\\mathrm{Tr}(\\mathbf{C})$ 的表达式：\n$$\n\\mathrm{EMSE} = \\sigma_{x}^{2} \\left( \\frac{\\mu}{(2-\\mu)}\\frac{\\sigma_{v}^{2}}{\\sigma_{x}^{2}} \\right) = \\frac{\\mu}{2-\\mu}\\sigma_{v}^{2}.\n$$\n这个稳态 EMSE 的最终表达式与投影阶数 $P$ 无关。这是针对白噪声输入信号的一个特定结果，其原因在于，在所述的统计假设下，$P$ 对滤波器学习动态的缩放效应与其对噪声的敏感性相互抵消。对于相关输入，这种抵消不会发生，EMSE 确实依赖于 $P$。\n\n问题要求给出 $P \\in \\{1, 2, 4\\}$ 的 EMSE 值。根据推导出的结果，这三种情况的表达式是相同的。\n\n对于 $P=1$：$\\mathrm{EMSE} = \\frac{\\mu}{2-\\mu}\\sigma_{v}^{2}$。\n对于 $P=2$：$\\mathrm{EMSE} = \\frac{\\mu}{2-\\mu}\\sigma_{v}^{2}$。\n对于 $P=4$：$\\mathrm{EMSE} = \\frac{\\mu}{2-\\mu}\\sigma_{v}^{2}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\mu}{2-\\mu}\\sigma_{v}^{2} & \\frac{\\mu}{2-\\mu}\\sigma_{v}^{2} & \\frac{\\mu}{2-\\mu}\\sigma_{v}^{2}\n\\end{pmatrix}\n}\n$$", "id": "2850820"}, {"introduction": "理论上的算法在实际的有限精度计算机上实现时，会面临数值稳定性的挑战。直接计算并求逆格拉姆矩阵 $X^{\\mathsf{T}}X$ 的标准 APA 实现方案，会放大输入数据的病态性。本练习旨在引导你思考一种更稳健的实现策略，即采用 QR 分解来解决 APA 中的最小二乘问题 [@problem_id:2850737]。通过对比不同实现方法的计算成本和数值优势，你将掌握如何将数值线性代数的先进技术应用于自适应滤波，确保算法的可靠性。", "problem": "考虑一个长度为 $M$、投影阶数为 $P$ 的仿射投影算法 (APA) 自适应滤波器，该滤波器使用最近的 $P$ 个输入回归量来更新权重向量 $w(n) \\in \\mathbb{R}^{M}$。在每次迭代中，更新的直接形式需要求解一个维度为 $P$ 的对称正定线性系统，其系数矩阵由最近的输入回归量的内积以及一个用于正则化的小的对角加载构成，其右端项是包含 $P$ 个先验误差的向量。要求您选择一种实现方式，该方式能避免计算任何显式矩阵逆，并利用正交-三角 (QR) 分解来增强数值稳健性。\n\n仅从以下基本原理出发：\n- 对于一个瘦高矩阵 $A \\in \\mathbb{R}^{m \\times n}$（$m \\ge n$），其最小二乘法方程为 $A^{\\top} A x = A^{\\top} b$，而构造 $A^{\\top} A$ 会使 $A$ 的条件数平方。\n- 一个瘦高矩阵 $B \\in \\mathbb{R}^{m \\times n}$（$m \\ge n$）的瘦 QR 分解可写作 $B = Q R$，其中 $Q \\in \\mathbb{R}^{m \\times n}$ 具有标准正交列，$R \\in \\mathbb{R}^{n \\times n}$ 是上三角矩阵，并且满足 $B^{\\top} B = R^{\\top} R$。\n- 通过回代法求解一个大小为 $P$ 的三角系统的运算量级为 $\\mathcal{O}(P^{2})$，而一个 $m \\times n$（$m \\ge n$）矩阵的 Householder QR 分解大约需要 $2 m n^{2} - \\tfrac{2}{3} n^{3}$ 次浮点运算。\n\n哪个选项最能描述一种基于 QR 的、避免显式矩阵求逆的 APA 逐次迭代实现，并说明其主要的数值优势和计算成本？\n\nA. 构建 $M \\times P$ 的回归量矩阵 $X(n)$ 和 $P \\times 1$ 的先验误差向量 $e(n)$。构造带有小的对角加载 $\\epsilon > 0$ 的 $(M+P) \\times P$ 增广矩阵 $B(n) \\triangleq \\begin{bmatrix} X(n) \\\\ \\sqrt{\\epsilon} I_{P} \\end{bmatrix}$。使用正交变换（例如 Householder 反射或 Givens 旋转）计算瘦 QR 分解 $B(n) = Q(n) R(n)$，使得 $R(n)^{\\top} R(n) = B(n)^{\\top} B(n) = X(n)^{\\top} X(n) + \\epsilon I_{P}$。求解两个三角系统 $R(n)^{\\top} z(n) = e(n)$，然后求解 $R(n) g(n) = z(n)$，并用步长 $\\mu \\in (0,1]$ 更新 $w(n+1) = w(n) + \\mu X(n) g(n)$。每次迭代从头计算的成本大约为：QR 分解为 $2 (M+P) P^{2} - \\tfrac{2}{3} P^{3}$，三角系统求解为 $\\mathcal{O}(P^{2})$，投影为 $\\mathcal{O}(M P)$，即总计 $\\mathcal{O}(M P^{2} + P^{3})$。但通过 Givens 旋转进行滑窗 QR 更新/降阶，摊销成本可降至 $\\mathcal{O}(M P)$。优点：无显式求逆，无显式构造 $X(n)^{\\top} X(n)$，在共线性条件下具有更好的数值稳定性，并通过正则化优雅地处理近似秩亏的情况；权衡：比朴素方法的常数项更高，且需要为 $R(n)$ 和更新算子提供额外存储空间。\n\nB. 在每次迭代中，构造 $P \\times P$ 的 Gram 矩阵 $G(n) \\triangleq X(n)^{\\top} X(n) + \\epsilon I_{P}$，计算其特征值分解 $G(n) = U(n) \\Lambda(n) U(n)^{\\top}$，然后设置 $g(n) = U(n) \\Lambda(n)^{-1} U(n)^{\\top} e(n)$ 以避免显式求逆。这种方法与 QR 分解一样稳定，且每次迭代的成本更低，因为对角矩阵求逆占主导地位且成本仅为 $\\mathcal{O}(P)$；每次迭代的总成本为 $\\mathcal{O}(P^{2})$，与 $M$ 无关。\n\nC. 构造 $P \\times P$ 的 Gram 矩阵 $G(n) \\triangleq X(n)^{\\top} X(n) + \\epsilon I_{P}$，并计算其 Cholesky 分解 $G(n) = L(n) L(n)^{\\top}$。通过对 $L(n)$ 求逆来计算显式逆 $G(n)^{-1}$，然后计算 $g(n) = G(n)^{-1} e(n)$。这将产生每次迭代 $\\mathcal{O}(P^{2})$ 的复杂度，因为三角矩阵求逆成本低廉，并且它在数值上等效于 QR，但没有正交变换的开销。\n\nD. 维护一个瘦 QR 分解 $X(n) = \\tilde{Q}(n) \\tilde{R}(n)$，并在每次迭代时，通过 Givens 旋转附加最新列并移除最旧列来更新 $\\tilde{R}(n)$。然后通过单次回代求解 $\\tilde{R}(n) g(n) = e(n)$，并更新 $w(n+1) = w(n) + \\mu X(n) g(n)$。如果维护 QR 分解，则正则化是不必要的，并且由于三角求解，每次迭代的成本为 $\\mathcal{O}(P^{2})$，与 $M$ 无关。", "solution": "本问题要求分析一种仿射投影算法 (APA) 的数值稳健、基于 QR 且避免显式矩阵求逆的实现。我将首先验证问题陈述，然后在假设其有效的情况下，从所提供的基本原理推导出正确的方法，并评估每个选项。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **算法**：仿射投影算法 (APA) 自适应滤波器。\n- **滤波器长度**：$M$。\n- **投影阶数**：$P$。\n- **权重向量**：$w(n) \\in \\mathbb{R}^{M}$。\n- **更新规则**：基于求解一个 $P$ 维对称正定线性系统。\n- **系统矩阵**：由最近 $P$ 个输入回归量的内积以及一个用于正则化的小的对角加载构成。\n- **系统右端项**：包含 $P$ 个先验误差的向量。\n- **约束条件**：避免显式矩阵求逆；使用 QR 分解以保证稳健性。\n- **已知原理 1**：对于一个瘦高矩阵 $A \\in \\mathbb{R}^{m \\times n}$ ($m \\ge n$)，其最小二乘法方程为 $A^{\\top} A x = A^{\\top} b$。构造 $A^{\\top} A$ 会使 $A$ 的条件数平方。\n- **已知原理 2**：一个瘦高矩阵 $B \\in \\mathbb{R}^{m \\times n}$ ($m \\ge n$) 的瘦 QR 分解为 $B = Q R$，其中 $Q \\in \\mathbb{R}^{m \\times n}$ 具有标准正交列，$R \\in \\mathbb{R}^{n \\times n}$ 是上三角矩阵。此分解满足 $B^{\\top} B = R^{\\top} R$。\n- **已知原理 3**：求解一个大小为 $P$ 的三角系统的成本为 $\\mathcal{O}(P^{2})$。\n- **已知原理 4**：对于一个 $m \\times n$ 的矩阵，其 Householder QR 分解的成本大约为 $2 m n^{2} - \\tfrac{2}{3} n^{3}$ 次浮点运算（$m \\ge n$）。\n\n**步骤 2：使用提取的已知条件进行验证**\n问题陈述在科学上是合理的、适定的和客观的。它描述了自适应信号处理领域中的一个标准问题：正则化 APA 的实现。已知条件是数值线性代数中的标准定义和结果。任务是应用这些原理，从选项中识别出正确的实现策略。问题设置中没有矛盾、歧义或事实错误。上下文是纯科学性的，并且可以形式化。\n\n**步骤 3：结论与行动**\n问题是**有效的**。我将继续进行求解推导。\n\n### 基于 QR 的 APA 实现推导\n\nAPA 权重更新由 $w(n+1) = w(n) + \\mu X(n) g(n)$ 给出，其中 $X(n) \\in \\mathbb{R}^{M \\times P}$ 是最近 $P$ 个输入回归量组成的矩阵。向量 $g(n) \\in \\mathbb{R}^{P}$ 是正则化法方程的解：\n$$ (X(n)^{\\top} X(n) + \\epsilon I_{P}) g(n) = e(n) $$\n其中 $e(n) \\in \\mathbb{R}^{P}$ 是先验误差向量，$\\epsilon > 0$ 是正则化参数，$I_{P}$ 是 $P \\times P$ 的单位矩阵。\n\n主要目标是在不显式构造矩阵 $X(n)^{\\top} X(n)$ 的情况下求解该系统以得到 $g(n)$，因为该操作会使条件数平方，可能导致数值不稳定（如原理 1 所述）。我们必须使用基于 QR 的方法。\n\n让我们构建一个增广矩阵 $B(n)$，使其 Gram 矩阵 $B(n)^{\\top} B(n)$ 正好是我们线性系统的系数矩阵。考虑 $(M+P) \\times P$ 矩阵：\n$$ B(n) = \\begin{bmatrix} X(n) \\\\ \\sqrt{\\epsilon} I_{P} \\end{bmatrix} $$\n计算其 Gram 矩阵可得：\n$$ B(n)^{\\top} B(n) = \\begin{bmatrix} X(n)^{\\top} & \\sqrt{\\epsilon} I_{P} \\end{bmatrix} \\begin{bmatrix} X(n) \\\\ \\sqrt{\\epsilon} I_{P} \\end{bmatrix} = X(n)^{\\top} X(n) + (\\sqrt{\\epsilon} I_{P})(\\sqrt{\\epsilon} I_{P}) = X(n)^{\\top} X(n) + \\epsilon I_{P} $$\n这成功地将我们的问题映射到法方程的结构上，而无需显式构造该乘积。原始系统现在可以写成：\n$$ B(n)^{\\top} B(n) g(n) = e(n) $$\n为了使用 QR 分解（原理 2）求解该问题，我们计算 $B(n)$ 的瘦 QR 分解：\n$$ B(n) = Q(n) R(n) $$\n其中 $Q(n)$ 是一个具有标准正交列的 $(M+P) \\times P$ 矩阵（$Q(n)^{\\top} Q(n) = I_{P}$），$R(n)$ 是一个 $P \\times P$ 的上三角矩阵。\n\n将此代入我们的系统：\n$$ (Q(n) R(n))^{\\top} (Q(n) R(n)) g(n) = e(n) $$\n$$ R(n)^{\\top} Q(n)^{\\top} Q(n) R(n) g(n) = e(n) $$\n$$ R(n)^{\\top} R(n) g(n) = e(n) $$\n该系统可以通过一个涉及三角求解的两步过程高效求解，无需任何矩阵求逆：\n1. 定义一个中间向量 $z(n) = R(n) g(n)$。系统变为 $R(n)^{\\top} z(n) = e(n)$。由于 $R(n)^{\\top}$ 是下三角矩阵，我们可以使用前向替换法求解 $z(n)$。\n2. 已知 $z(n)$ 后，我们求解 $R(n) g(n) = z(n)$ 以得到 $g(n)$。由于 $R(n)$ 是上三角矩阵，我们可以使用回代法。\n\n此过程的计算成本主要由 $(M+P) \\times P$ 矩阵 $B(n)$ 的 QR 分解决定。使用提供的公式（原理 4），令 $m = M+P$ 和 $n = P$，成本约为 $2(M+P)P^2 - \\frac{2}{3}P^3$，其量级为 $\\mathcal{O}(MP^2 + P^3)$。两次三角求解的成本各为 $\\mathcal{O}(P^2)$（原理 3）。最终的权重更新 $w(n+1) = w(n) + \\mu X(n) g(n)$ 涉及一个矩阵-向量乘积，成本为 $\\mathcal{O}(MP)$。因此，如果从头开始计算，每次迭代的总成本为 $\\mathcal{O}(MP^2 + P^3)$。对于滑窗回归量矩阵 $X(n)$，QR 分解的高效更新/降阶过程（例如使用 Givens 旋转）可以将摊销成本降低到 $\\mathcal{O}(MP)$。\n\n### 选项评估\n\n**选项 A：**\n该选项描述了上面推导出的确切过程。它正确地构造了增广矩阵 $B(n) = \\begin{bmatrix} X(n) \\\\ \\sqrt{\\epsilon} I_{P} \\end{bmatrix}$，计算其瘦 QR 分解 $B(n) = Q(n) R(n)$，并通过两步三角求解来求解系统 $R(n)^{\\top} R(n) g(n) = e(n)$：首先求解 $R(n)^{\\top} z(n) = e(n)$，然后求解 $R(n) g(n) = z(n)$。对数值优势（避免显式求逆和 Gram 矩阵构造，提高稳定性）的分析是正确的。计算成本分析，无论是从头计算的版本（$\\mathcal{O}(M P^{2} + P^{3})$）还是快速更新的版本（$\\mathcal{O}(M P)$），也都是正确的。权衡之处也陈述准确。\n**结论：正确**\n\n**选项 B：**\n该选项建议显式构造 Gram 矩阵 $G(n) = X(n)^{\\top} X(n) + \\epsilon I_{P}$。这与避免条件数平方所带来的数值问题的目标相矛盾。它使用特征值分解 (EVD) 而不是所要求的 QR 分解。成本分析不正确：构造 $G(n)$ 的成本为 $\\mathcal{O}(MP^2)$，因此总成本并非与 $M$ 无关。一个 $P \\times P$ 矩阵的 EVD 成本为 $\\mathcal{O}(P^3)$，而不是 $\\mathcal{O}(P^2)$。\n**结论：不正确**\n\n**选项 C：**\n该选项也建议显式构造 Gram 矩阵 $G(n)$，这是不可取的。它建议使用 Cholesky 分解，而不是 QR 分解。最重要的是，它建议“计算显式逆 $G(n)^{-1}$”，这直接违反了问题的核心约束。此外，其“在数值上等效于 QR”的说法是错误的；对数据矩阵 $B(n)$ 进行 QR 分解比对 Gram 矩阵 $B(n)^{\\top}B(n)$ 进行 Cholesky 分解更稳定。复杂度也被错误地陈述为 $\\mathcal{O}(P^2)$，忽略了构造 $G(n)$ 所需的 $\\mathcal{O}(MP^2)$ 成本。\n**结论：不正确**\n\n**选项 D：**\n该选项正确地建议了维护 $X(n)$ 的 QR 分解并使用快速更新。然而，它在构建待解系统时犯了一个关键错误。它声称系统是 $\\tilde{R}(n) g(n) = e(n)$，但从 $(X(n)^{\\top} X(n) + \\epsilon I_{P}) g(n) = e(n)$ 推导出的正确系统是 $(\\tilde{R}(n)^{\\top} \\tilde{R}(n) + \\epsilon I_{P}) g(n) = e(n)$。选项 D 在求解步骤中完全忽略了正则化项 $\\epsilon I_P$，并作出了“如果维护 QR 分解，则正则化是不必要的”这一错误断言。正则化对于处理回归量中的共线性至关重要，QR 分解可以诊断出共线性，但若不修改问题本身，则无法解决该问题。复杂度分析同样存在缺陷；更新成本为 $\\mathcal{O}(MP)$，并非与 $M$ 无关。\n**结论：不正确**", "answer": "$$\\boxed{A}$$", "id": "2850737"}]}