{"hands_on_practices": [{"introduction": "理论学习之后，最佳的巩固方式莫过于亲手实践。本练习将引导您在一个最基础的标量随机游走模型中，完整地执行一次前向卡尔曼滤波和后向RTS平滑过程。通过这个练习，您将深入理解信息如何在时间序列中前向传播以进行预测和更新，以及如何利用未来信息进行后向修正，从而获得对整个数据集最优的状态估计 [@problem_id:2872818]。", "problem": "考虑一个标量线性高斯状态空间模型，其由随机游走动态和直接观测定义：状态演化为 $x_{k+1} = x_k + w_k$，观测为 $y_k = x_k + v_k$，其中 $\\{w_k\\}$ 和 $\\{v_k\\}$ 是相互独立、零均值的高斯序列，其方差分别为 $\\operatorname{Var}(w_k) = q$ 和 $\\operatorname{Var}(v_k) = r$。假设初始状态先验为 $x_0 \\sim \\mathcal{N}(m_0, p_0)$。在全文中，所有随机变量均为实值。\n\n任务：\n1. 仅使用多元高斯分布和条件期望的性质，对于时间域 $N=2$，推导标量 Rauch–Tung–Striebel (RTS) 平滑增益 $J_k$、固定区间平滑均值 $x_{k\\mid N}$ 和固定区间平滑协方差 $P_{k\\mid N}$ 的闭式表达式。您的推导必须从联合高斯变量线性变换的高斯条件恒等式出发，并且可以利用以下事实：对于线性高斯系统，卡尔曼滤波器的一步预测分布和滤波分布是高斯分布。\n2. 对于具体数值案例，$q = 0.5$，$r = 2.0$，$m_0 = 0$，$p_0 = 1$，观测值为 $y_0 = 1.0$，$y_1 = 0.0$ 和 $y_2 = 2.0$，执行前向（滤波）遍，以获得对于 $k \\in \\{0,1,2\\}$ 的滤波均值 $x_{k\\mid k}$ 和协方差 $P_{k\\mid k}$，以及对于 $k \\in \\{0,1\\}$ 的一步预测值 $x_{k+1\\mid k}$ 和 $P_{k+1\\mid k}$。然后计算 RTS 平滑增益 $J_0$ 和 $J_1$，并执行后向（平滑）遍，以获得 $x_{0\\mid 2}$、$x_{1\\mid 2}$、$x_{2\\mid 2}$ 以及 $P_{0\\mid 2}$、$P_{1\\mid 2}$、$P_{2\\mid 2}$。\n3. 以单行矩阵的形式报告最终数值，顺序为 $(J_0, J_1, x_{0\\mid 2}, x_{1\\mid 2}, x_{2\\mid 2}, P_{0\\mid 2}, P_{1\\mid 2}, P_{2\\mid 2})$。将您的条目四舍五入到四位有效数字。不需要单位。", "solution": "该问题陈述具有科学依据、提法恰当、客观且自洽。它描述了 Rauch–Tung–Striebel (RTS) 平滑器在线性高斯状态空间模型中的一个标准应用。所有必需的参数和观测值均已提供。因此，该问题是有效的，并将提供解答。\n\n该问题分三部分解决：首先，推导标量 RTS 平滑器方程；其次，进行数值计算，包括一次前向卡尔曼滤波遍和一次后向 RTS 平滑遍；第三，报告最终数值。\n\n**第 1 部分：Rauch–Tung–Striebel (RTS) 平滑器方程的推导**\n\nRTS 平滑器是一种固定区间平滑算法，它通过后向递归进行操作，从前向卡尔曼滤波遍的最终状态开始。目标是计算平滑状态分布 $p(x_k | y_{0:N})$，其中 $k=0, 1, \\dots, N-1$。该分布是高斯分布，由其均值 $x_{k|N}$ 和协方差 $P_{k|N}$ 表征。\n\n该推导依赖于联合高斯随机变量的性质。我们考虑状态 $x_k$ 和后继状态 $x_{k+1}$ 在给定截至时间 $k$ 的观测值（记为 $y_{0:k}$）下的联合分布。在线性高斯系统中，此分布 $p(x_k, x_{k+1} | y_{0:k})$ 是高斯分布。\n\n该联合分布的均值向量为：\n$$\n\\mathbb{E}\\left[\\begin{pmatrix} x_k \\\\ x_{k+1} \\end{pmatrix} \\middle| y_{0:k}\\right] = \\begin{pmatrix} \\mathbb{E}[x_k \\mid y_{0:k}] \\\\ \\mathbb{E}[x_{k+1} \\mid y_{0:k}] \\end{pmatrix} = \\begin{pmatrix} x_{k|k} \\\\ x_{k+1|k} \\end{pmatrix}\n$$\n协方差矩阵为：\n$$\n\\operatorname{Cov}\\left(\\begin{pmatrix} x_k \\\\ x_{k+1} \\end{pmatrix} \\middle| y_{0:k}\\right) = \\begin{pmatrix} \\operatorname{Cov}(x_k, x_k \\mid y_{0:k}) & \\operatorname{Cov}(x_k, x_{k+1} \\mid y_{0:k}) \\\\ \\operatorname{Cov}(x_{k+1}, x_k \\mid y_{0:k}) & \\operatorname{Cov}(x_{k+1}, x_{k+1} \\mid y_{0:k}) \\end{pmatrix}\n$$\n矩阵元素为滤波协方差 $P_{k|k}$、预测协方差 $P_{k+1|k}$ 以及互协方差。对于状态模型 $x_{k+1} = F_k x_k + w_k$（在本问题中 $F_k=1$），我们有：\n$\\operatorname{Cov}(x_k, x_{k+1} \\mid y_{0:k}) = \\operatorname{Cov}(x_k, x_k + w_k \\mid y_{0:k}) = \\operatorname{Cov}(x_k, x_k \\mid y_{0:k}) = P_{k|k}$，因为过程噪声 $w_k$ 与 $x_k$ 和 $y_{0:k}$ 相互独立。\n因此，联合分布为：\n$$\n\\begin{pmatrix} x_k \\\\ x_{k+1} \\end{pmatrix} \\mid y_{0:k} \\sim \\mathcal{N} \\left( \\begin{pmatrix} x_{k|k} \\\\ x_{k+1|k} \\end{pmatrix}, \\begin{pmatrix} P_{k|k} & P_{k|k} \\\\ P_{k|k} & P_{k+1|k} \\end{pmatrix} \\right)\n$$\nRTS 推导的核心在于将包含在 $p(x_k | y_{0:k})$ 中的关于 $x_k$ 的滤波信息与从未来反向传播的信息（由平滑分布 $p(x_{k+1} | y_{0:N})$ 表示）相结合。这可以通过使用全概率定律和状态空间模型的马尔可夫性质来实现：\n$$\np(x_k | y_{0:N}) = \\int p(x_k, x_{k+1} | y_{0:N}) d x_{k+1} = \\int p(x_k | x_{k+1}, y_{0:N}) p(x_{k+1} | y_{0:N}) d x_{k+1}\n$$\n根据马尔可夫性质，$p(x_k | x_{k+1}, y_{0:N}) = p(x_k | x_{k+1}, y_{0:k})$。我们利用高斯条件化公式，从给定 $y_{0:k}$ 的 $(x_k, x_{k+1})$ 联合分布中求得此条件分布。对于联合均值为 $(\\mu_1, \\mu_2)$、协方差为 $(\\Sigma_{11}, \\Sigma_{12}; \\Sigma_{21}, \\Sigma_{22})$ 的变量 $z_1, z_2$，$z_1$ 给定 $z_2$ 的条件均值和协方差为：\n$$\n\\mathbb{E}[z_1 | z_2] = \\mu_1 + \\Sigma_{12} \\Sigma_{22}^{-1} (z_2 - \\mu_2)\n$$\n$$\n\\operatorname{Cov}(z_1 | z_2) = \\Sigma_{11} - \\Sigma_{12} \\Sigma_{22}^{-1} \\Sigma_{21}\n$$\n将此应用于以 $x_{k+1}$ 和 $y_{0:k}$ 为条件的 $x_k$：\n$$\n\\mathbb{E}[x_k | x_{k+1}, y_{0:k}] = x_{k|k} + P_{k|k} (P_{k+1|k})^{-1} (x_{k+1} - x_{k+1|k})\n$$\n$$\n\\operatorname{Cov}(x_k | x_{k+1}, y_{0:k}) = P_{k|k} - P_{k|k} (P_{k+1|k})^{-1} P_{k|k}\n$$\n平滑均值 $x_{k|N}$ 是通过对 $\\mathbb{E}[x_k | x_{k+1}, y_{0:k}]$ 关于 $p(x_{k+1} | y_{0:N})$ 取期望得到的：\n$$\nx_{k|N} = \\mathbb{E}[\\mathbb{E}[x_k | x_{k+1}, y_{0:k}] | y_{0:N}] = x_{k|k} + P_{k|k} (P_{k+1|k})^{-1} (\\mathbb{E}[x_{k+1} | y_{0:N}] - x_{k+1|k})\n$$\n定义 RTS 增益 $J_k = P_{k|k} F_k^T (P_{k+1|k})^{-1}$（此处 $F_k=1$），我们得到平滑均值更新公式：\n$$\nx_{k|N} = x_{k|k} + J_k (x_{k+1|N} - x_{k+1|k})\n$$\n平滑协方差 $P_{k|N}$ 使用全协方差定律求得：\n$$\nP_{k|N} = \\mathbb{E}[\\operatorname{Cov}(x_k | x_{k+1}, y_{0:k}) | y_{0:N}] + \\operatorname{Cov}(\\mathbb{E}[x_k | x_{k+1}, y_{0:k}] | y_{0:N})\n$$\n第一项相对于外层期望是常数，得出 $P_{k|k} - J_k P_{k+1|k} J_k^T$。第二项是 $\\operatorname{Cov}(J_k x_{k+1} | y_{0:N}) = J_k P_{k+1|N} J_k^T$。将它们组合起来，得到平滑协方差更新公式：\n$$\nP_{k|N} = P_{k|k} + J_k (P_{k+1|N} - P_{k+1|k}) J_k^T\n$$\n这些方程定义了 RTS 平滑器的后向递归。\n\n**第 2 部分：数值计算**\n\n我们给定的参数为 $q=0.5$，$r=2.0$，$m_0=0$，$p_0=1$，观测值为 $y_0=1.0$，$y_1=0.0$，$y_2=2.0$。模型矩阵为 $F=1$，$H=1$，$Q=q=0.5$，$R=r=2.0$。\n\n**前向遍：卡尔曼滤波器**\n滤波器在预测-更新循环中运行。我们从先验 $x_{0|-1}=0$ 和 $P_{0|-1}=1$ 开始。\n\n**步骤 $k=0$：**\n-   **更新：**\n    -   新息协方差：$S_0 = H P_{0|-1} H^T + R = 1 \\cdot 1 \\cdot 1 + 2.0 = 3.0$\n    -   卡尔曼增益：$K_0 = P_{0|-1} H^T S_0^{-1} = 1 \\cdot 1 \\cdot (3.0)^{-1} = 1/3$\n    -   滤波均值：$x_{0|0} = x_{0|-1} + K_0 (y_0 - H x_{0|-1}) = 0 + (1/3)(1.0 - 0) = 1/3$\n    -   滤波协方差：$P_{0|0} = (1 - K_0 H) P_{0|-1} = (1 - 1/3) \\cdot 1 = 2/3$\n\n**步骤 $k=1$：**\n-   **预测：**\n    -   $x_{1|0} = F x_{0|0} = 1 \\cdot (1/3) = 1/3$\n    -   $P_{1|0} = F P_{0|0} F^T + Q = 1 \\cdot (2/3) \\cdot 1 + 0.5 = 2/3 + 1/2 = 7/6$\n-   **更新：**\n    -   $S_1 = H P_{1|0} H^T + R = 1 \\cdot (7/6) \\cdot 1 + 2.0 = 19/6$\n    -   $K_1 = P_{1|0} H^T S_1^{-1} = (7/6) \\cdot 1 \\cdot (19/6)^{-1} = 7/19$\n    -   $x_{1|1} = x_{1|0} + K_1 (y_1 - H x_{1|0}) = 1/3 + (7/19)(0.0 - 1/3) = 4/19$\n    -   $P_{1|1} = (1 - K_1 H) P_{1|0} = (1 - 7/19) \\cdot (7/6) = (12/19) \\cdot (7/6) = 14/19$\n\n**步骤 $k=2$：**\n-   **预测：**\n    -   $x_{2|1} = F x_{1|1} = 1 \\cdot (4/19) = 4/19$\n    -   $P_{2|1} = F P_{1|1} F^T + Q = 1 \\cdot (14/19) \\cdot 1 + 0.5 = 47/38$\n-   **更新：**\n    -   $S_2 = H P_{2|1} H^T + R = 1 \\cdot (47/38) \\cdot 1 + 2.0 = 123/38$\n    -   $K_2 = P_{2|1} H^T S_2^{-1} = (47/38) \\cdot 1 \\cdot (123/38)^{-1} = 47/123$\n    -   $x_{2|2} = x_{2|1} + K_2 (y_2 - H x_{2|1}) = 4/19 + (47/123)(2.0 - 4/19) = 110/123$\n    -   $P_{2|2} = (1 - K_2 H) P_{2|1} = (1 - 47/123) \\cdot (47/38) = (76/123) \\cdot (47/38) = 94/123$\n\n**后向遍：RTS 平滑器**\n后向遍从 $k=N-1=1$ 开始，使用最终的滤波估计值 $x_{2|2} = 110/123$ 和 $P_{2|2} = 94/123$。\n\n**步骤 $k=1$：**\n-   RTS 增益：$J_1 = P_{1|1} F^T (P_{2|1})^{-1} = (14/19) \\cdot 1 \\cdot (47/38)^{-1} = 28/47$\n-   平滑均值：$x_{1|2} = x_{1|1} + J_1 (x_{2|2} - x_{2|1}) = 4/19 + (28/47)(110/123 - 4/19) = 76/123$\n-   平滑协方差：$P_{1|2} = P_{1|1} + J_1 (P_{2|2} - P_{2|1}) J_1^T = 14/19 + (28/47)(94/123 - 47/38)(28/47) = 70/123$\n\n**步骤 $k=0$：**\n-   RTS 增益：$J_0 = P_{0|0} F^T (P_{1|0})^{-1} = (2/3) \\cdot 1 \\cdot (7/6)^{-1} = 4/7$\n-   平滑均值：$x_{0|2} = x_{0|0} + J_0 (x_{1|2} - x_{1|0}) = 1/3 + (4/7)(76/123 - 1/3) = 61/123$\n-   平滑协方差：$P_{0|2} = P_{0|0} + J_0 (P_{1|2} - P_{1|0}) J_0^T = 2/3 + (4/7)(70/123 - 7/6)(4/7) = 58/123$\n\n**第 3 部分：最终数值**\n所需值为 $(J_0, J_1, x_{0\\mid 2}, x_{1\\mid 2}, x_{2\\mid 2}, P_{0\\mid 2}, P_{1\\mid 2}, P_{2\\mid 2})$，四舍五入到四位有效数字。\n\n- $J_0 = 4/7 \\approx 0.571428... \\to 0.5714$\n- $J_1 = 28/47 \\approx 0.595744... \\to 0.5957$\n- $x_{0\\mid 2} = 61/123 \\approx 0.495934... \\to 0.4959$\n- $x_{1\\mid 2} = 76/123 \\approx 0.617886... \\to 0.6179$\n- $x_{2\\mid 2} = 110/123 \\approx 0.894308... \\to 0.8943$\n- $P_{0\\mid 2} = 58/123 \\approx 0.471544... \\to 0.4715$\n- $P_{1\\mid 2} = 70/123 \\approx 0.569105... \\to 0.5691$\n- $P_{2\\mid 2} = 94/123 \\approx 0.764227... \\to 0.7642$\n\n这些值被汇编成最终答案。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.5714 & 0.5957 & 0.4959 & 0.6179 & 0.8943 & 0.4715 & 0.5691 & 0.7642 \\end{pmatrix}}\n$$", "id": "2872818"}, {"introduction": "在掌握了标量系统的基本原理后，我们需将目光投向更贴近现实世界的多维系统。本练习将场景升级为一个二维状态空间模型，这在机器人定位或目标跟踪等领域非常常见，其中状态向量可能同时包含位置和速度等分量。通过解决这个问题，您将练习处理RTS平滑器中的矩阵和向量运算，这是将该算法应用于复杂工程问题的关键一步 [@problem_id:2872807]。", "problem": "考虑以下用于二维状态的线性高斯状态空间模型：\n- 状态动态：$x_{k+1} = F x_{k} + w_{k}$，其中 $w_{k} \\sim \\mathcal{N}(0, Q)$ 随时间独立。\n- 量测模型：$y_{k} = H x_{k} + v_{k}$，其中 $v_{k} \\sim \\mathcal{N}(0, R)$ 随时间独立且与 $\\{w_{k}\\}$ 独立。\n\n给定具体的数值实例：\n- $F = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix}$，\n- $H = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$，\n- $Q = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$，\n- $R = 1$，\n- 先验 $x_{0} \\sim \\mathcal{N}(m_{0}, P_{0})$，其中 $m_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 且 $P_{0} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$，\n- 量测值为 $y_{0} = 1$ 和 $y_{1} = 2$。\n\n仅使用线性高斯推断的第一性原理（特别是 Bayes 法则和联合高斯随机变量的条件恒等式），在区间 $k \\in \\{0, 1\\}$ 上执行一个完整的固定区间平滑：\n- 首先，执行前向贝叶斯滤波过程（在 $k=0$ 和 $k=1$ 处进行预测和更新）。\n- 然后，执行后向 Rauch–Tung–Striebel (RTS) 平滑器过程，以获得在时间 $k=0$ 和 $k=1$ 处的平滑后验均值和协方差。\n\n报告 $x_{0 \\mid 1}$、$P_{0 \\mid 1}$、$x_{1 \\mid 1}$ 和 $P_{1 \\mid 1}$，其中符号 $a_{k \\mid \\ell}$ 表示以截止到时间 $\\ell$ 的所有量测为条件。将您的最终答案精确地（不进行四舍五入）表示为一个单行向量，该向量按顺序串联 $x_{0 \\mid 1}$ 的元素、$P_{0 \\mid 1}$ 按行主序排列的元素、$x_{1 \\mid 1}$ 的元素以及 $P_{1 \\mid 1}$ 按行主序排列的元素。不涉及单位。无需四舍五入。", "solution": "该问题要求计算在时间区间 $k \\in \\{0, 1\\}$ 上，一个线性高斯状态空间模型的平滑后验均值和协方差。这将通过两个过程完成：首先是使用 Kalman 滤波器进行前向过程以获得滤波估计值，然后是使用 Rauch–Tung–Striebel (RTS) 平滑器进行后向过程以获得最终的平滑估计值。所提供的问题陈述是有效的，因为它具有科学依据、问题适定且客观。所有必要的参数都已提供，并且它们的维度是一致的。\n\n解将从联合高斯随机变量的贝叶斯推断的第一性原理导出。核心原理是条件高斯分布的公式。如果两个随机向量 $\\mathbf{x}$ 和 $\\mathbf{y}$ 是联合高斯分布的，\n$$\n\\begin{pmatrix} \\mathbf{x} \\\\ \\mathbf{y} \\end{pmatrix} \\sim \\mathcal{N}\\left( \\begin{pmatrix} \\mathbf{\\mu}_x \\\\ \\mathbf{\\mu}_y \\end{pmatrix}, \\begin{pmatrix} \\Sigma_{xx} & \\Sigma_{xy} \\\\ \\Sigma_{yx} & \\Sigma_{yy} \\end{pmatrix} \\right)\n$$\n那么给定 $\\mathbf{y}$ 的条件下 $\\mathbf{x}$ 的条件分布也是高斯的，$p(\\mathbf{x} | \\mathbf{y}) = \\mathcal{N}(\\mathbf{x}; \\mathbf{\\mu}_{x|y}, \\Sigma_{xx|y})$，其均值和协方差由下式给出：\n$$\n\\mathbf{\\mu}_{x|y} = \\mathbf{\\mu}_x + \\Sigma_{xy} \\Sigma_{yy}^{-1} (\\mathbf{y} - \\mathbf{\\mu}_y)\n$$\n$$\n\\Sigma_{xx|y} = \\Sigma_{xx} - \\Sigma_{xy} \\Sigma_{yy}^{-1} \\Sigma_{yx}\n$$\nKalman 滤波器和 RTS 平滑器方程是这些恒等式的直接应用。\n\n给定的模型参数是：\n- 状态转移矩阵：$F = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix}$\n- 量测矩阵：$H = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$\n- 过程噪声协方差：$Q = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$\n- 量测噪声方差：$R = 1$\n- 先验均值：$m_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$\n- 先验协方差：$P_{0} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$\n- 量测值：$y_{0} = 1$，$y_{1} = 2$\n\n我们使用符号 $m_{k|\\ell}$ 和 $P_{k|\\ell}$ 来表示以截至时间 $\\ell$ 的量测值（即 $y_0, \\dots, y_\\ell$）为条件时，状态 $x_k$ 的均值和协方差。\n\n**第1部分：前向过程 (Kalman 滤波器)**\n\n**时间 k=0：更新**\n$x_0$ 的先验分布给定为 $p(x_0) = \\mathcal{N}(x_0; m_0, P_0)$。这可作为时间 $k=0$ 时的“预测”分布，因此 $m_{0|-1} = m_0$ 且 $P_{0|-1} = P_0$。我们使用量测值 $y_0 = 1$ 对其进行更新。\n\n1.  **预测量测和新息协方差：**\n    新息为 $\\nu_0 = y_0 - H m_{0|-1}$。其分布是高斯的。\n    均值：$E[\\nu_0] = y_0 - E[H x_0 + v_0] = 1 - H m_{0|-1} = 1 - \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = 1$。\n    预测的量测值为 $\\hat{y}_{0|-1} = H m_{0|-1} = 0$。\n    新息协方差：$S_0 = H P_{0|-1} H^T + R = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + 1 = 1 + 1 = 2$。\n\n2.  **Kalman 增益：**\n    $K_0 = P_{0|-1} H^T S_0^{-1} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (2)^{-1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\frac{1}{2} = \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix}$。\n\n3.  **更新后（滤波后）的状态估计：**\n    $m_{0|0} = m_{0|-1} + K_0 (y_0 - \\hat{y}_{0|-1}) = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix} (1 - 0) = \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix}$。\n    $P_{0|0} = (I - K_0 H) P_{0|-1} = \\left(\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix}\\right) \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1 \\end{pmatrix}$。\n\n**时间 k=1：预测和更新**\n\n1.  **预测的状态估计：**\n    $m_{1|0} = F m_{0|0} = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix}$。\n    $P_{1|0} = F P_{0|0} F^T + Q = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1/2 & 1 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 3/2 & 1 \\\\ 1 & 1 \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 5/2 & 1 \\\\ 1 & 2 \\end{pmatrix}$。\n\n2.  **使用 $y_1=2$ 进行更新：**\n    预测的量测值：$\\hat{y}_{1|0} = H m_{1|0} = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix} = 1/2$。\n    新息协方差：$S_1 = H P_{1|0} H^T + R = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 5/2 & 1 \\\\ 1 & 2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + 1 = 5/2 + 1 = 7/2$。\n    Kalman 增益：$K_1 = P_{1|0} H^T S_1^{-1} = \\begin{pmatrix} 5/2 & 1 \\\\ 1 & 2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (7/2)^{-1} = \\begin{pmatrix} 5/2 \\\\ 1 \\end{pmatrix} \\frac{2}{7} = \\begin{pmatrix} 5/7 \\\\ 2/7 \\end{pmatrix}$。\n\n3.  **$k=1$ 时更新后（滤波后）的状态估计：**\n    $m_{1|1} = m_{1|0} + K_1 (y_1 - \\hat{y}_{1|0}) = \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 5/7 \\\\ 2/7 \\end{pmatrix} (2 - 1/2) = \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 5/7 \\\\ 2/7 \\end{pmatrix} \\frac{3}{2} = \\begin{pmatrix} 1/2 + 15/14 \\\\ 3/7 \\end{pmatrix} = \\begin{pmatrix} 7/14 + 15/14 \\\\ 3/7 \\end{pmatrix} = \\begin{pmatrix} 11/7 \\\\ 3/7 \\end{pmatrix}$。\n    $P_{1|1} = (I - K_1 H) P_{1|0} = \\left(\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 5/7 \\\\ 2/7 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix}\\right) \\begin{pmatrix} 5/2 & 1 \\\\ 1 & 2 \\end{pmatrix} = \\begin{pmatrix} 2/7 & 0 \\\\ -2/7 & 1 \\end{pmatrix} \\begin{pmatrix} 5/2 & 1 \\\\ 1 & 2 \\end{pmatrix} = \\begin{pmatrix} 5/7 & 2/7 \\\\ 2/7 & 12/7 \\end{pmatrix}$。\n    \n这些是最终的滤波估计值。根据问题中的符号表示，$x_{1|1} = m_{1|1}$ 和 $P_{1|1}$ 是解的一部分。\n\n**第2部分：后向过程 (RTS 平滑器)**\n\nRTS 平滑器基于前向过程中的滤波估计值，计算 $k < N$ 时的后验 $p(x_k | y_{0:N})$。递归从最终时间步 $N=1$ 开始，此时平滑估计值与滤波估计值相同：$m_{1|1}$ 和 $P_{1|1}$。然后我们后向步进到 $k=0$。\n\n平滑器更新方程为：\n$J_k = P_{k|k} F^T P_{k+1|k}^{-1}$\n$m_{k|N} = m_{k|k} + J_k (m_{k+1|N} - m_{k+1|k})$\n$P_{k|N} = P_{k|k} + J_k (P_{k+1|N} - P_{k+1|k}) J_k^T$\n\n**k=0 时的平滑：**\n我们设定 $k=0$ 和 $N=1$。\n\n1.  **平滑器增益 $J_0$**：\n    我们首先需要 $P_{1|0}^{-1}$。\n    $\\det(P_{1|0}) = (5/2)(2) - (1)(1) = 4$。\n    $P_{1|0}^{-1} = \\frac{1}{4} \\begin{pmatrix} 2 & -1 \\\\ -1 & 5/2 \\end{pmatrix} = \\begin{pmatrix} 1/2 & -1/4 \\\\ -1/4 & 5/8 \\end{pmatrix}$。\n    $J_0 = P_{0|0} F^T P_{1|0}^{-1} = \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix} \\begin{pmatrix} 1/2 & -1/4 \\\\ -1/4 & 5/8 \\end{pmatrix} = \\begin{pmatrix} 1/2 & 0 \\\\ 1 & 1 \\end{pmatrix} \\begin{pmatrix} 1/2 & -1/4 \\\\ -1/4 & 5/8 \\end{pmatrix} = \\begin{pmatrix} 1/4 & -1/8 \\\\ 1/4 & 3/8 \\end{pmatrix}$。\n\n2.  **平滑均值 $m_{0|1}$**：\n    $m_{0|1} = m_{0|0} + J_0 (m_{1|1} - m_{1|0})$。\n    差值项是 $m_{1|1} - m_{1|0} = \\begin{pmatrix} 11/7 \\\\ 3/7 \\end{pmatrix} - \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 15/14 \\\\ 3/7 \\end{pmatrix}$。\n    $m_{0|1} = \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 1/4 & -1/8 \\\\ 1/4 & 3/8 \\end{pmatrix} \\begin{pmatrix} 15/14 \\\\ 3/7 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} (1/4)(15/14) - (1/8)(3/7) \\\\ (1/4)(15/14) + (3/8)(3/7) \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 15/56 - 3/56 \\\\ 15/56 + 9/56 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 12/56 \\\\ 24/56 \\end{pmatrix} = \\begin{pmatrix} 7/14 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 3/14 \\\\ 6/14 \\end{pmatrix} = \\begin{pmatrix} 10/14 \\\\ 3/7 \\end{pmatrix} = \\begin{pmatrix} 5/7 \\\\ 3/7 \\end{pmatrix}$。\n\n3.  **平滑协方差 $P_{0|1}$**：\n    $P_{0|1} = P_{0|0} + J_0 (P_{1|1} - P_{1|0}) J_0^T$。\n    差值项是 $P_{1|1} - P_{1|0} = \\begin{pmatrix} 5/7 & 2/7 \\\\ 2/7 & 12/7 \\end{pmatrix} - \\begin{pmatrix} 5/2 & 1 \\\\ 1 & 2 \\end{pmatrix} = \\begin{pmatrix} 10/14 - 35/14 & 2/7 - 7/7 \\\\ 2/7 - 7/7 & 12/7 - 14/7 \\end{pmatrix} = \\begin{pmatrix} -25/14 & -5/7 \\\\ -5/7 & -2/7 \\end{pmatrix}$。\n    校正项是 $J_0 (P_{1|1} - P_{1|0}) J_0^T$：\n    $J_0 (P_{1|1} - P_{1|0}) = \\begin{pmatrix} 1/4 & -1/8 \\\\ 1/4 & 3/8 \\end{pmatrix} \\begin{pmatrix} -25/14 & -5/7 \\\\ -5/7 & -2/7 \\end{pmatrix} = \\begin{pmatrix} -25/56 + 5/56 & -5/28 + 2/56 \\\\ -25/56 - 15/56 & -5/28 - 6/56 \\end{pmatrix} = \\begin{pmatrix} -20/56 & -8/56 \\\\ -40/56 & -16/56 \\end{pmatrix} = \\begin{pmatrix} -5/14 & -1/7 \\\\ -5/7 & -2/7 \\end{pmatrix}$。\n    校正：$\\begin{pmatrix} -5/14 & -1/7 \\\\ -5/7 & -2/7 \\end{pmatrix} J_0^T = \\begin{pmatrix} -5/14 & -1/7 \\\\ -5/7 & -2/7 \\end{pmatrix} \\begin{pmatrix} 1/4 & 1/4 \\\\ -1/8 & 3/8 \\end{pmatrix} = \\begin{pmatrix} -5/56 + 1/56 & -5/56 - 3/56 \\\\ -5/28 + 2/56 & -5/28 - 6/56 \\end{pmatrix} = \\begin{pmatrix} -4/56 & -8/56 \\\\ -8/56 & -16/56 \\end{pmatrix} = \\begin{pmatrix} -1/14 & -1/7 \\\\ -1/7 & -2/7 \\end{pmatrix}$。\n    $P_{0|1} = P_{0|0} + \\begin{pmatrix} -1/14 & -1/7 \\\\ -1/7 & -2/7 \\end{pmatrix} = \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1 \\end{pmatrix} + \\begin{pmatrix} -1/14 & -1/7 \\\\ -1/7 & -2/7 \\end{pmatrix} = \\begin{pmatrix} 7/14 - 1/14 & -1/7 \\\\ -1/7 & 7/7 - 2/7 \\end{pmatrix} = \\begin{pmatrix} 6/14 & -1/7 \\\\ -1/7 & 5/7 \\end{pmatrix} = \\begin{pmatrix} 3/7 & -1/7 \\\\ -1/7 & 5/7 \\end{pmatrix}$。\n\n**最终结果摘要**\n在区间 $k\\in\\{0,1\\}$ 上完整的平滑估计集为：\n- $k=0$ 时的平滑估计：\n  $x_{0|1} = m_{0|1} = \\begin{pmatrix} 5/7 \\\\ 3/7 \\end{pmatrix}$\n  $P_{0|1} = \\begin{pmatrix} 3/7 & -1/7 \\\\ -1/7 & 5/7 \\end{pmatrix}$\n- $k=1$ 时的平滑估计：\n  $x_{1|1} = m_{1|1} = \\begin{pmatrix} 11/7 \\\\ 3/7 \\end{pmatrix}$\n  $P_{1|1} = \\begin{pmatrix} 5/7 & 2/7 \\\\ 2/7 & 12/7 \\end{pmatrix}$\n\n最终答案是通过按指定顺序串联这些结果的元素来构造的。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{5}{7} & \\frac{3}{7} & \\frac{3}{7} & -\\frac{1}{7} & -\\frac{1}{7} & \\frac{5}{7} & \\frac{11}{7} & \\frac{3}{7} & \\frac{5}{7} & \\frac{2}{7} & \\frac{2}{7} & \\frac{12}{7} \\end{pmatrix}}\n$$", "id": "2872807"}, {"introduction": "RTS平滑器的强大之处不仅在于其标准形式，更在于其在贝叶斯框架下的灵活性，能够融合各种形式的信息。本练习将挑战您处理一个非标准情况：在已知系统终点状态的精确值时，如何修正标准的RTS算法。这个问题要求您从第一性原理出发，推导修正后的后向平滑递归公式，这能极大地加深您对算法背后贝叶斯本质的理解，并培养您根据具体问题调整算法的能力 [@problem_id:2872810]。", "problem": "考虑一个在有限时域 $k=0,1,2,3$ 上的标量、线性、时不变、离散时间的高斯状态空间模型，给定如下：\n- 状态动态：$x_{k+1} = a\\,x_{k} + w_{k}$，其中 $w_{k} \\sim \\mathcal{N}(0,q)$，\n- 测量：$y_{k} = h\\,x_{k} + v_{k}$，其中 $v_{k} \\sim \\mathcal{N}(0,r)$，\n其中 $\\{w_{k}\\}$ 和 $\\{v_{k}\\}$ 相互独立，且独立于初始状态。初始先验为 $x_{0} \\sim \\mathcal{N}(m_{0},P_{0})$。假设在 $k=0,1,2$ 时观测到测量序列，而在 $k=3$ 时没有测量。此外，一个终端状态约束是精确已知的：$x_{3} = \\bar{x}_{3}$。\n\n要求您将此精确的终端约束整合到 Rauch–Tung–Striebel (RTS) 固定区间平滑器中，方法是在 $k=3$ 处构建适当的边界条件，并从高斯条件化的第一性原理出发推导反向递推。具体来说，从一步预测器和滤波器作为线性高斯模型的条件均方最优估计器的定义开始，并仅使用联合高斯向量的性质和贝叶斯法则，推导当 $x_{3}$ 精确已知时，平滑条件均值的反向递推必须如何修正。\n\n然后，对于具有以下参数的具体实例：\n- $a=1$, $h=1$, $q=\\frac{1}{2}$, $r=1$,\n- $m_{0}=0$, $P_{0}=1$,\n- 测量值 $y_{0}=1$, $y_{1}=0$, $y_{2}=2$,\n- 终端约束 $x_{3}=\\bar{x}_{3}=1$ 精确成立，\n计算平滑条件均值 $x_{k\\mid 3} \\triangleq \\mathbb{E}[x_{k} \\mid y_{0},y_{1},y_{2},x_{3}=\\bar{x}_{3}]$，其中 $k=0,1,2,3$。\n\n将您的最终答案表示为一个单行矩阵，按顺序包含 $x_{0\\mid 3}$、$x_{1\\mid 3}$、$x_{2\\mid 3}$、$x_{3\\mid 3}$。无需四舍五入。", "solution": "对问题陈述进行验证。\n\n第 1 步：提取已知条件\n-   模型：标量、线性、时不变、离散时间、高斯状态空间模型。\n-   时域：$k=0,1,2,3$。\n-   状态动态：$x_{k+1} = a\\,x_{k} + w_{k}$，其中 $w_{k} \\sim \\mathcal{N}(0,q)$。\n-   测量模型：$y_{k} = h\\,x_{k} + v_{k}$，其中 $v_{k} \\sim \\mathcal{N}(0,r)$。\n-   噪声属性：过程噪声 $\\{w_{k}\\}$ 和测量噪声 $\\{v_{k}\\}$ 是相互独立的白噪声序列，并且独立于初始状态。\n-   初始先验：$x_{0} \\sim \\mathcal{N}(m_{0},P_{0})$。\n-   观测序列：观测到测量值 $y_0, y_1, y_2$。在 $k=3$ 时没有可用的测量值。\n-   终端约束：在时间 $k=3$ 时的状态是精确已知的：$x_{3} = \\bar{x}_{3}$。\n-   任务 1：基于高斯条件化的第一性原理，推导修正后的平滑条件均值的反向递推，并整合精确的终端约束。\n-   任务 2：对于参数为 $a=1$、$h=1$、$q=\\frac{1}{2}$、$r=1$、$m_{0}=0$、$P_{0}=1$，测量值为 $y_{0}=1$、$y_{1}=0$、$y_{2}=2$，且终端约束为 $\\bar{x}_{3}=1$ 的具体实例，计算平滑条件均值 $x_{k\\mid 3} \\triangleq \\mathbb{E}[x_{k} \\mid y_{0},y_{1},y_{2},x_{3}=\\bar{x}_{3}]$，其中 $k=0,1,2,3$。\n-   最终答案格式：一个包含计算值的单行矩阵，按 $x_{0\\mid 3}$、$x_{1\\mid 3}$、$x_{2\\mid 3}$、$x_{3\\mid 3}$ 的顺序排列。\n\n第 2 步：使用提取的已知条件进行验证\n-   **科学基础：** 该问题是状态估计理论中的一个标准练习，重点是 Rauch–Tung–Striebel (RTS) 平滑器，这是信号处理和控制领域的一个基石算法。包含硬终端约束是一个定义明确且具有实际意义的扩展。该问题基于线性高斯系统的贝叶斯推断的既定理论。\n-   **适定性：** 该问题是适定的。它提供了系统模型的完整描述、所有必要的参数以及一组特定的观测和约束。目标陈述清晰，并且预期有唯一解。\n-   **客观性：** 该问题以精确、客观的数学语言表述，没有歧义或主观因素。\n\n第 3 步：结论与行动\n-   该问题被认为是**有效的**。它在科学上是合理的、适定的、客观的，并且没有明显缺陷。将提供完整的解答。\n\n解答分两部分进行。首先，介绍修正后的平滑器递推的推导。其次，对给定的实例进行数值计算。\n\n**第 1 部分：修正平滑器的推导**\n\n目标是计算平滑状态估计 $x_{k\\mid 3} = \\mathbb{E}[x_k \\mid Y_3]$，其中信息集为 $Y_3 = \\{y_0, y_1, y_2, x_3=\\bar{x}_3\\}$。Rauch-Tung-Striebel (RTS) 平滑器提供了一个反向递推来计算此类估计。我们从第一性原理出发，为给定的信息集推导这个递推。\n\n令 $Y_{0:k} = \\{y_0, \\dots, y_k\\}$。我们使用全期望定律：\n$$x_{k\\mid 3} = \\mathbb{E}[x_k \\mid Y_3] = \\mathbb{E}\\left[ \\mathbb{E}[x_k \\mid x_{k+1}, Y_3] \\mid Y_3 \\right]$$\n关键步骤是分析内层期望 $\\mathbb{E}[x_k \\mid x_{k+1}, Y_3]$。状态 $x_k$ 通过状态动态 $x_{k+1} = a x_k + w_k$ 与 $x_{k+1}$ 相关。信息集 $Y_3$ 可以划分为截至时间 $k$ 的可用信息 $Y_{0:k}$，以及来自时间 $k$ 之后的信息，即 $\\{y_{k+1}, y_{k+2}, x_3=\\bar{x}_3\\}$。\n\n由于状态空间模型的马尔可夫结构，给定下一个状态 $x_{k+1}$，状态 $x_k$ 与所有未来的状态和测量条件独立。也就是说，$x_k \\perp \\{y_{k+1}, y_2, x_3\\} \\mid x_{k+1}$。这意味着一旦 $x_{k+1}$ 已知，对额外的未来信息进行条件化不会改变 $x_k$ 的分布。\n因此，\n$$p(x_k \\mid x_{k+1}, Y_3) = p(x_k \\mid x_{k+1}, y_0, \\dots, y_k) = p(x_k \\mid x_{k+1}, Y_{0:k})$$\n这简化了内层期望：\n$$\\mathbb{E}[x_k \\mid x_{k+1}, Y_3] = \\mathbb{E}[x_k \\mid x_{k+1}, Y_{0:k}]$$\n这个期望是线性高斯系统理论中的一个标准结果。以测量值 $Y_{0:k}$ 为条件的 $(x_k, x_{k+1})$ 的联合分布是高斯的。从卡尔曼滤波器的前向过程中，我们得到滤波分布 $p(x_k \\mid Y_{0:k}) = \\mathcal{N}(x_k; x_{k\\mid k}, P_{k\\mid k})$。对 $x_{k+1}$ 的预测分布是 $p(x_{k+1} \\mid Y_{0:k}) = \\mathcal{N}(x_{k+1}; x_{k+1\\mid k}, P_{k+1\\mid k})$，其中 $x_{k+1\\mid k} = a x_{k\\mid k}$ 且 $P_{k+1\\mid k} = a^2 P_{k\\mid k} + q$。\n\n给定 $Y_{0:k}$ 时，$x_k$ 和 $x_{k+1}$之间的协方差是：\n$$\\mathrm{Cov}(x_k, x_{k+1} \\mid Y_{0:k}) = \\mathrm{Cov}(x_k, a x_k + w_k \\mid Y_{0:k}) = a \\mathrm{Var}(x_k \\mid Y_{0:k}) = a P_{k\\mid k}$$\n使用联合高斯分布的条件均值公式，我们得到：\n$$\\mathbb{E}[x_k \\mid x_{k+1}, Y_{0:k}] = \\mathbb{E}[x_k \\mid Y_{0:k}] + \\mathrm{Cov}(x_k, x_{k+1} \\mid Y_{0:k}) \\mathrm{Var}(x_{k+1} \\mid Y_{0:k})^{-1} (x_{k+1} - \\mathbb{E}[x_{k+1} \\mid Y_{0:k}])$$\n代入卡尔曼滤波器的量：\n$$\\mathbb{E}[x_k \\mid x_{k+1}, Y_{0:k}] = x_{k\\mid k} + (a P_{k\\mid k}) (P_{k+1\\mid k})^{-1} (x_{k+1} - x_{k+1\\mid k})$$\n令平滑增益为 $J_k = P_{k\\mid k} a P_{k+1\\mid k}^{-1}$。表达式变为：\n$$\\mathbb{E}[x_k \\mid x_{k+1}, Y_3] = x_{k\\mid k} + J_k (x_{k+1} - x_{k+1\\mid k})$$\n将此代回全期望定律：\n$$x_{k\\mid 3} = \\mathbb{E}[ x_{k\\mid k} + J_k (x_{k+1} - x_{k+1\\mid k}) \\mid Y_3 ]$$\n根据期望的线性性，并注意到 $x_{k\\mid k}$ 和 $x_{k+1\\mid k}$ 是 $Y_{0:k}$（$Y_3$ 的一个子集）的函数，因此对于外层期望是常数：\n$$x_{k\\mid 3} = x_{k\\mid k} + J_k (\\mathbb{E}[x_{k+1} \\mid Y_3] - x_{k+1\\mid k})$$\n根据定义，$\\mathbb{E}[x_{k+1} \\mid Y_3] = x_{k+1\\mid 3}$。这产生了反向递推：\n$$x_{k\\mid 3} = x_{k\\mid k} + J_k (x_{k+1\\mid 3} - x_{k+1\\mid k})$$\n这个递推在形式上与标准的 RTS 平滑器均值递推相同。修正是通过终端时间 $k=3$ 的边界条件引入的。信息集 $Y_3$ 明确包含值 $x_3=\\bar{x}_3$。因此，给定 $Y_3$ 时 $x_3$ 的期望就是这个已知值：\n$$x_{3\\mid 3} = \\mathbb{E}[x_3 \\mid y_0, y_1, y_2, x_3=\\bar{x}_3] = \\bar{x}_3$$\n这与标准的 RTS 平滑器形成对比，后者会从最终的滤波估计开始。在这里，递推是用精确已知的终端状态初始化的。\n\n**第 2 部分：数值计算**\n\n我们首先执行卡尔曼滤波器的前向过程，以计算所需的滤波量（$x_{k\\mid k}$, $P_{k\\mid k}$）和预测量（$x_{k+1\\mid k}$, $P_{k+1\\mid k}$）。参数为 $a=1$、$h=1$、$q=1/2$、$r=1$、$m_0=0$、$P_0=1$。测量值为 $y_0=1, y_1=0, y_2=2$。\n\n**卡尔曼滤波器前向过程 ($k=0,1,2$)**\n\n卡尔曼滤波器方程：\n-   预测：$x_{k\\mid k-1} = a x_{k-1\\mid k-1}$，$P_{k\\mid k-1} = a^2 P_{k-1\\mid k-1} + q$。\n-   更新：$K_k = P_{k\\mid k-1} h (h^2 P_{k\\mid k-1} + r)^{-1}$，$x_{k\\mid k} = x_{k\\mid k-1} + K_k (y_k - h x_{k\\mid k-1})$，$P_{k\\mid k} = (1 - K_k h) P_{k\\mid k-1}$。\n\n_对于 k = 0:_\n-   先验：$x_{0|-1} = m_0 = 0$，$P_{0|-1} = P_0 = 1$。\n-   卡尔曼增益：$K_0 = 1 \\cdot 1 \\cdot (1^2 \\cdot 1 + 1)^{-1} = 1/2$。\n-   更新：$x_{0\\mid 0} = 0 + \\frac{1}{2}(1 - 1 \\cdot 0) = \\frac{1}{2}$。\n-   更新：$P_{0\\mid 0} = (1 - \\frac{1}{2}\\cdot 1) \\cdot 1 = \\frac{1}{2}$。\n\n_对于 k = 1:_\n-   预测：$x_{1\\mid 0} = 1 \\cdot \\frac{1}{2} = \\frac{1}{2}$。\n-   预测：$P_{1\\mid 0} = 1^2 \\cdot \\frac{1}{2} + \\frac{1}{2} = 1$。\n-   卡尔曼增益：$K_1 = 1 \\cdot 1 \\cdot (1^2 \\cdot 1 + 1)^{-1} = 1/2$。\n-   更新：$x_{1\\mid 1} = \\frac{1}{2} + \\frac{1}{2}(0 - 1 \\cdot \\frac{1}{2}) = \\frac{1}{2} - \\frac{1}{4} = \\frac{1}{4}$。\n-   更新：$P_{1\\mid 1} = (1 - \\frac{1}{2}\\cdot 1) \\cdot 1 = \\frac{1}{2}$。\n\n_对于 k = 2:_\n-   预测：$x_{2\\mid 1} = 1 \\cdot \\frac{1}{4} = \\frac{1}{4}$。\n-   预测：$P_{2\\mid 1} = 1^2 \\cdot \\frac{1}{2} + \\frac{1}{2} = 1$。\n-   卡尔曼增益：$K_2 = 1 \\cdot 1 \\cdot (1^2 \\cdot 1 + 1)^{-1} = 1/2$。\n-   更新：$x_{2\\mid 2} = \\frac{1}{4} + \\frac{1}{2}(2 - 1 \\cdot \\frac{1}{4}) = \\frac{1}{4} + \\frac{1}{2} \\cdot \\frac{7}{4} = \\frac{2}{8} + \\frac{7}{8} = \\frac{9}{8}$。\n-   更新：$P_{2\\mid 2} = (1 - \\frac{1}{2}\\cdot 1) \\cdot 1 = \\frac{1}{2}$。\n\n_对于 k = 3 (仅预测):_\n-   预测：$x_{3\\mid 2} = 1 \\cdot \\frac{9}{8} = \\frac{9}{8}$。\n-   预测：$P_{3\\mid 2} = 1^2 \\cdot \\frac{1}{2} + \\frac{1}{2} = 1$。\n\n**反向平滑过程 ($k=3,2,1,0$)**\n\n平滑器递推：$x_{k\\mid 3} = x_{k\\mid k} + J_k (x_{k+1\\mid 3} - x_{k+1\\mid k})$，其中 $J_k = P_{k\\mid k} a P_{k+1\\mid k}^{-1}$。\n\n_对于 k = 3:_\n-   边界条件：$x_{3\\mid 3} = \\bar{x}_3 = 1$。\n\n_对于 k = 2:_\n-   平滑增益：$J_2 = P_{2\\mid 2} \\cdot 1 \\cdot (P_{3\\mid 2})^{-1} = \\frac{1}{2} \\cdot 1 \\cdot (1)^{-1} = \\frac{1}{2}$。\n-   平滑均值：$x_{2\\mid 3} = x_{2\\mid 2} + J_2 (x_{3\\mid 3} - x_{3\\mid 2}) = \\frac{9}{8} + \\frac{1}{2}(1 - \\frac{9}{8}) = \\frac{9}{8} + \\frac{1}{2}(-\\frac{1}{8}) = \\frac{9}{8} - \\frac{1}{16} = \\frac{18-1}{16} = \\frac{17}{16}$。\n\n_对于 k = 1:_\n-   平滑增益：$J_1 = P_{1\\mid 1} \\cdot 1 \\cdot (P_{2\\mid 1})^{-1} = \\frac{1}{2} \\cdot 1 \\cdot (1)^{-1} = \\frac{1}{2}$。\n-   平滑均值：$x_{1\\mid 3} = x_{1\\mid 1} + J_1 (x_{2\\mid 3} - x_{2\\mid 1}) = \\frac{1}{4} + \\frac{1}{2}(\\frac{17}{16} - \\frac{1}{4}) = \\frac{1}{4} + \\frac{1}{2}(\\frac{17-4}{16}) = \\frac{1}{4} + \\frac{13}{32} = \\frac{8+13}{32} = \\frac{21}{32}$。\n\n_对于 k = 0:_\n-   平滑增益：$J_0 = P_{0\\mid 0} \\cdot 1 \\cdot (P_{1\\mid 0})^{-1} = \\frac{1}{2} \\cdot 1 \\cdot (1)^{-1} = \\frac{1}{2}$。\n-   平滑均值：$x_{0\\mid 3} = x_{0\\mid 0} + J_0 (x_{1\\mid 3} - x_{1\\mid 0}) = \\frac{1}{2} + \\frac{1}{2}(\\frac{21}{32} - \\frac{1}{2}) = \\frac{1}{2} + \\frac{1}{2}(\\frac{21-16}{32}) = \\frac{1}{2} + \\frac{5}{64} = \\frac{32+5}{64} = \\frac{37}{64}$。\n\n计算出的平滑均值为：\n$x_{0\\mid 3} = \\frac{37}{64}$\n$x_{1\\mid 3} = \\frac{21}{32}$\n$x_{2\\mid 3} = \\frac{17}{16}$\n$x_{3\\mid 3} = 1$\n\n将这些值收集到最终答案中。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{37}{64} & \\frac{21}{32} & \\frac{17}{16} & 1\n\\end{pmatrix}\n}\n$$", "id": "2872810"}]}