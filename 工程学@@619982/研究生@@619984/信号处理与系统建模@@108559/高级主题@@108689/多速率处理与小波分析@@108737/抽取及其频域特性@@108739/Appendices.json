{"hands_on_practices": [{"introduction": "要真正掌握抽取，我们必须从其在$Z$变换域中的基本数学特性入手。这个练习旨在通过一个经典的指数序列，从第一性原理推导抽取后信号的$Z$变换。通过这个过程，你将不仅应用$Z$变换的定义，还将运用复分析中的部分分式展开技巧，从而深刻理解抽取在频域中产生混叠现象的本质根源 [@problem_id:2863301]。", "problem": "设 $x[n] = a^{n} u[n]$，其中 $|a|<1$，$u[n]$ 表示单位阶跃序列。固定一个整数抽取因子 $M \\geq 2$，并定义抽取后的序列 $y[n] = x[Mn]$。设 $X(z)$ 和 $Y(z)$ 分别表示 $x[n]$ 和 $y[n]$ 关于复变量 $z$ 的双边 $Z$ 变换。仅使用时域抽取和双边 $Z$ 变换的定义，将 $Y(z)$ 用 $X(\\cdot)$ 表示，然后通过使用关于 $M$ 次单位根的部分分式展开，将得到的 $M$ 项和化简为单个有理函数，从而为给定的 $x[n]$ 显式计算 $Y(z)$。在您的推导中，使用复数 $M$ 次根的主支来解释 $z^{1/M}$。请将您的最终结果以单个关于 $a$、$M$ 和 $z$ 的闭式解析表达式形式给出 $Y(z)$。", "solution": "该问题要求推导抽取信号 $y[n] = x[Mn]$ 的 $Z$ 变换 $Y(z)$，其中 $x[n] = a^n u[n]$ 且 $|a|<1$，$M \\geq 2$ 为一个整数。推导过程必须首先建立 $Y(z)$ 和 $X(z)$ 之间的一般关系，然后使用部分分式展开技术将此关系应用于特定信号。\n\n首先，我们建立信号 $x[n]$ 的 $Z$ 变换与其抽取版本 $y[n] = x[Mn]$ 之间的一般关系。$y[n]$ 的双边 $Z$ 变换定义为：\n$$\nY(z) = \\sum_{n=-\\infty}^{\\infty} y[n] z^{-n}\n$$\n将 $y[n] = x[Mn]$ 代入定义，我们得到：\n$$\nY(z) = \\sum_{n=-\\infty}^{\\infty} x[Mn] z^{-n}\n$$\n这个求和不能直接与 $X(z) = \\sum_{k=-\\infty}^{\\infty} x[k] z^{-k}$ 关联，因为求和索引是 $n$，而 $x$ 的自变量是 $Mn$。为了继续推导，我们引入一个辅助信号 $v[n]$，它在 $M$ 的整数倍处之外都为零：\n$$\nv[n] = \\begin{cases} x[n] & \\text{if } n = kM \\text{ for some integer } k \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\n那么，抽取信号 $y[n]$ 是 $v[n]$ 的一个压缩版本，具体来说 $y[n] = v[Mn]$。让我们求 $v[n]$ 的 $Z$ 变换，记为 $V(z)$：\n$$\nV(z) = \\sum_{n=-\\infty}^{\\infty} v[n] z^{-n} = \\sum_{k=-\\infty}^{\\infty} x[kM] z^{-kM}\n$$\n通过将其与 $Y(z)$ 的表达式进行比较，我们可以看出：\n$$\nV(z) = \\sum_{k=-\\infty}^{\\infty} x[Mk] (z^M)^{-k} = Y(z^M)\n$$\n现在我们将 $V(z)$ 与 $X(z)$ 关联起来。信号 $v[n]$ 可以表示为 $x[n]$ 与一个脉冲串序列 $p[n]$ 的乘积，该脉冲串在 $M$ 的倍数处为 $1$，在其他地方为 $0$。这个脉冲串可以用 $M$ 次单位根表示：\n$$\np[n] = \\frac{1}{M} \\sum_{k=0}^{M-1} (e^{j \\frac{2\\pi k}{M}})^n\n$$\n因此，$v[n] = x[n] p[n]$。$Z$ 变换 $V(z)$ 于是为：\n$$\nV(z) = \\sum_{n=-\\infty}^{\\infty} \\left( x[n] \\left[ \\frac{1}{M} \\sum_{k=0}^{M-1} e^{j \\frac{2\\pi k n}{M}} \\right] \\right) z^{-n}\n$$\n通过交换求和顺序（在适当的收敛条件下是允许的）：\n$$\nV(z) = \\frac{1}{M} \\sum_{k=0}^{M-1} \\left( \\sum_{n=-\\infty}^{\\infty} x[n] e^{j \\frac{2\\pi k n}{M}} z^{-n} \\right)\n$$\n$$\nV(z) = \\frac{1}{M} \\sum_{k=0}^{M-1} \\left( \\sum_{n=-\\infty}^{\\infty} x[n] (z e^{-j \\frac{2\\pi k}{M}})^{-n} \\right)\n$$\n内层求和是在 $z e^{-j \\frac{2\\pi k}{M}}$ 处求值的 $x[n]$ 的 $Z$ 变换的定义。因此：\n$$\nV(z) = \\frac{1}{M} \\sum_{k=0}^{M-1} X(z e^{-j \\frac{2\\pi k}{M}})\n$$\n由于 $Y(z^M) = V(z)$，我们可以通过在 $V(z)$ 的表达式中用 $z^{1/M}$ 替换 $z$ 来找到 $Y(z)$，并按要求使用根的主支：\n$$\nY(z) = V(z^{1/M}) = \\frac{1}{M} \\sum_{k=0}^{M-1} X(z^{1/M} e^{-j \\frac{2\\pi k}{M}})\n$$\n这就是抽取信号的 $Z$ 变换的一般表达式。\n\n接下来，我们将此结果应用于特定信号 $x[n] = a^n u[n]$，其中 $|a|<1$。$x[n]$ 的 $Z$ 变换是一个几何级数的和：\n$$\nX(z) = \\sum_{n=0}^{\\infty} a^n z^{-n} = \\sum_{n=0}^{\\infty} (az^{-1})^n = \\frac{1}{1 - az^{-1}}\n$$\n该变换在 $|az^{-1}| < 1$ 时收敛，即在收敛域 (ROC) $|z|>|a|$ 内。\n\n现在我们将 $X(z)$ 的这个表达式代入 $Y(z)$ 的公式中。令 $w_k = z^{1/M} e^{-j \\frac{2\\pi k}{M}}$。则 $Y(z) = \\frac{1}{M} \\sum_{k=0}^{M-1} X(w_k)$。\n$$\nX(w_k) = \\frac{1}{1 - a w_k^{-1}} = \\frac{1}{1 - a (z^{1/M} e^{-j \\frac{2\\pi k}{M}})^{-1}} = \\frac{1}{1 - a z^{-1/M} e^{j \\frac{2\\pi k}{M}}}\n$$\n所以，$Y(z)$ 变为：\n$$\nY(z) = \\frac{1}{M} \\sum_{k=0}^{M-1} \\frac{1}{1 - a z^{-1/M} e^{j \\frac{2\\pi k}{M}}}\n$$\n为按要求简化此和，我们使用一个与部分分式展开相关的复分析结果。令 $c = a z^{-1/M}$ 且 $\\omega_k = e^{j \\frac{2\\pi k}{M}}$，其中 $k=0, 1, \\dots, M-1$。该和为 $\\sum_{k=0}^{M-1} \\frac{1}{1 - c \\omega_k}$。\n考虑多项式 $P(s) = s^M - c^M$。它的根是 $s_k = c \\omega_k$，其中 $k=0, \\dots, M-1$。\n我们可以写出有理函数 $\\frac{g(s)}{P(s)}$ 的部分分式展开。考虑 $g(s) = M s^{M-1}$ 会得到一个有用的恒等式：\n$$\n\\frac{M s^{M-1}}{s^M - c^M} = \\sum_{k=0}^{M-1} \\frac{A_k}{s - c \\omega_k}\n$$\n系数 $A_k$ 是在单极点 $s_k$ 处的留数。使用公式 $A_k = \\frac{g(s_k)}{P'(s_k)}$：\n$$\nA_k = \\frac{M s^{M-1}}{\\frac{d}{ds}(s^M - c^M)} \\bigg|_{s=c\\omega_k} = \\frac{M s^{M-1}}{M s^{M-1}} \\bigg|_{s=c\\omega_k} = 1\n$$\n所有系数均为 $A_k = 1$。因此，我们得到恒等式：\n$$\n\\frac{M s^{M-1}}{s^M - c^M} = \\sum_{k=0}^{M-1} \\frac{1}{s - c \\omega_k}\n$$\n为了匹配我们求和的形式，我们可以操作这个恒等式。令 $s=1$：\n$$\n\\frac{M}{1 - c^M} = \\sum_{k=0}^{M-1} \\frac{1}{1 - c \\omega_k}\n$$\n这个表达式正好是我们要求值的和乘以 $M$。因此：\n$$\n\\sum_{k=0}^{M-1} \\frac{1}{1 - c \\omega_k} = \\frac{M}{1 - c^M}\n$$\n将此代回 $Y(z)$ 的表达式中：\n$$\nY(z) = \\frac{1}{M} \\left( \\frac{M}{1 - c^M} \\right) = \\frac{1}{1 - c^M}\n$$\n最后，我们代回 $c = a z^{-1/M}$：\n$$\nc^M = (a z^{-1/M})^M = a^M (z^{-1/M})^M = a^M z^{-1}\n$$\n这给出了 $Y(z)$ 的闭式表达式：\n$$\nY(z) = \\frac{1}{1 - a^M z^{-1}}\n$$\n这个结果与直接计算 $y[n] = x[Mn] = a^{Mn}u[Mn] = (a^M)^n u[n]$ 的 $Z$ 变换的结果是一致的，后者是一个公比为 $a^M$ 的几何序列。收敛域 (ROC) 为 $|z| > |a^M|$。由于 $|a|<1$ 且 $M \\geq 2$，我们有 $|a^M| < |a|$，所以 $Y(z)$ 的收敛域比 $X(z)$ 的收敛域大。", "answer": "$$\n\\boxed{\\frac{1}{1 - a^{M} z^{-1}}}\n$$", "id": "2863301"}, {"introduction": "理论知识在计算机上的实践，通常是通过离散傅里叶变换 (DFT) 实现的。本练习将$Z$变换域中的混叠理论带入到有限长度信号的DFT世界，这是一个将抽象概念具体化的重要步骤。你将通过一个具体的数值例子，推导并验证时域抽取操作与DFT系数之间的精确映射关系，从而亲身体会频域混叠是如何在实际计算中发生的 [@problem_id:2863342]。", "problem": "考虑一个长度为 $N=12$ 且采样值为复数的离散时间信号，并令 $X[k]$ 表示其长度为 12 的离散傅里叶变换 (DFT)，其正变换定义为\n$$\nX[k] \\triangleq \\sum_{n=0}^{11} x[n] \\exp\\!\\left(-j \\frac{2\\pi}{12}kn\\right), \\quad k=0,1,\\ldots,11,\n$$\n其逆变换定义为\n$$\nx[n] \\triangleq \\frac{1}{12} \\sum_{k=0}^{11} X[k] \\exp\\!\\left(j \\frac{2\\pi}{12}kn\\right), \\quad n=0,1,\\ldots,11.\n$$\n通过 $y[m] \\triangleq x[3m]$ (其中 $m=0,1,2,3$) 形成一个以 $M=3$ 进行抽取的序列，并令其长度为 4 的 DFT 为\n$$\nY[q] \\triangleq \\sum_{m=0}^{3} y[m] \\exp\\!\\left(-j \\frac{2\\pi}{4}qm\\right), \\quad q=0,1,2,3.\n$$\n从这些定义以及 $y[m]=x[3m]$ 出发，根据第一性原理推导当 $N=12$ 是 $M$ 的整数倍时，由以 $M=3$ 进行抽取所产生的 $Y[q]$ 和 $X[k]$ 之间的频域关系。不要假设或引用任何现成的抽取恒等式；通过显式代入和求和进行推导。\n\n现在考虑在所有频点上指定的具体 12 点频谱 $X[k]$：\n- 组 $k \\equiv 0 \\,(\\mathrm{mod}\\, 4)$: $X[0]=6$, $X[4]=3 \\exp\\!\\left(j\\frac{\\pi}{3}\\right)$, $X[8]=-2j$.\n- 组 $k \\equiv 1 \\,(\\mathrm{mod}\\, 4)$: $X[1]=4$, $X[5]=-1+j$, $X[9]=2 \\exp\\!\\left(-j\\frac{\\pi}{4}\\right)$.\n- 组 $k \\equiv 2 \\,(\\mathrm{mod}\\, 4)$: $X[2]=0$, $X[6]=5$, $X[10]=-3$.\n- 组 $k \\equiv 3 \\,(\\mathrm{mod}\\, 4)$: $X[3]=j$, $X[7]=-2$, $X[11]=1+j$.\n\n使用您推导出的关系和给定的 $X[k]$:\n- 以精确的封闭形式计算您的频域映射为 $q=0,1,2,3$ 所预测的四个复数值 $\\widehat{Y}[q]$。\n- 独立地，通过长度为 12 的 DFT 逆变换合成 $x[n]$，形成 $y[m]=x[3m]$，并直接根据其定义计算长度为 4 的 DFT $Y[q]$，所有计算均以精确的封闭形式进行。\n- 定义验证误差\n$$\nE \\triangleq \\sum_{q=0}^{3} \\left| Y[q] - \\widehat{Y}[q] \\right|^{2}.\n$$\n精确计算 $E$。\n\n提供 $E$ 的精确值作为您的最终答案。不要四舍五入。", "solution": "所述问题在科学上是合理的、提法恰当、客观且自洽的。它提出了一个关于抽取的频域效应的数字信号处理标准练习。所有定义和数据都已提供，并与已有理论一致。不存在逻辑谬误或歧义。因此，我将提供一个完整的解。\n\n这个问题需要一个双管齐下的方法：首先，推导一个频域中的理论关系；其次，通过对特定信号在时域中进行直接计算来验证这个关系。\n\n**第一部分：抽取操作的频域关系推导**\n\n我们被要求找出抽取后信号 $y[m]$ 的长度为 4 的 DFT $Y[q]$ 与原始信号 $x[n]$ 的长度为 12 的 DFT $X[k]$ 之间的关系。抽取因子为 $M=3$，因此 $y[m] = x[3m]$。\n\n$Y[q]$ 的定义是：\n$$Y[q] = \\sum_{m=0}^{3} y[m] \\exp\\left(-j \\frac{2\\pi}{4}qm\\right)$$\n代入 $y[m]$ 的定义：\n$$Y[q] = \\sum_{m=0}^{3} x[3m] \\exp\\left(-j \\frac{\\pi}{2}qm\\right)$$\n现在，用 $n=3m$ 代入 $x[n]$ 的逆 DFT 表达式：\n$$x[3m] = \\frac{1}{12} \\sum_{k=0}^{11} X[k] \\exp\\left(j \\frac{2\\pi}{12}k(3m)\\right) = \\frac{1}{12} \\sum_{k=0}^{11} X[k] \\exp\\left(j \\frac{\\pi}{2}km\\right)$$\n将此式代入 $Y[q]$ 的表达式，得到一个双重求和：\n$$Y[q] = \\sum_{m=0}^{3} \\left( \\frac{1}{12} \\sum_{k=0}^{11} X[k] \\exp\\left(j \\frac{\\pi}{2}km\\right) \\right) \\exp\\left(-j \\frac{\\pi}{2}qm\\right)$$\n我们可以合并指数项并交换求和顺序：\n$$Y[q] = \\frac{1}{12} \\sum_{k=0}^{11} X[k] \\left( \\sum_{m=0}^{3} \\exp\\left(j \\frac{\\pi}{2}(k-q)m\\right) \\right)$$\n内部求和是一个几何级数。我们来计算它。\n该和为 $S(k,q) = \\sum_{m=0}^{3} \\left(\\exp\\left(j \\frac{\\pi}{2}(k-q)\\right)\\right)^m$。\n如果指数运算的底数为 1，则该和为 4。这种情况发生在 $\\frac{\\pi}{2}(k-q)$ 是 $2\\pi$ 的整数倍时，即 $k-q$ 是 4 的倍数，或 $k \\equiv q \\pmod{4}$。\n如果 $k \\not\\equiv q \\pmod{4}$，底数不为 1。几何级数的和为 $\\frac{r^4-1}{r-1}$，其中 $r = \\exp(j \\frac{\\pi}{2}(k-q))$。因为对于任何整数 $k, q$，都有 $r^4 = \\exp(j 2\\pi(k-q)) = 1$，所以和为 0。\n因此，当 $k \\equiv q \\pmod{4}$ 时，内部和为 4，否则为 0。\n\n这个性质意味着只有当 $k \\equiv q \\pmod{4}$ 时，$X[k]$ 项才对外部求和有贡献。对于给定的 $q \\in \\{0, 1, 2, 3\\}$，在 $[0, 11]$ 范围内满足此条件的索引 $k$ 为 $k=q$，$k=q+4$ 和 $k=q+8$。\n因此，$Y[q]$ 的表达式简化为：\n$$Y[q] = \\frac{1}{12} \\left( X[q] \\cdot 4 + X[q+4] \\cdot 4 + X[q+8] \\cdot 4 \\right)$$\n$$Y[q] = \\frac{1}{3} \\left( X[q] + X[q+4] + X[q+8] \\right)$$\n这就是当 $N=12$ 时，以 $M=3$ 进行抽取的基本频域关系。得到的频谱是原始频谱的混叠分量经过缩放后的和。\n该模型预测的 $\\widehat{Y}[q]$ 值定义为：\n$$\\widehat{Y}[q] \\triangleq \\frac{1}{3} \\left( X[q] + X[q+4] + X[q+8] \\right)$$\n\n**第二部分：通过时域合成进行独立验证**\n\n题目要求进行独立验证。我们必须为 $n \\in \\{0, 3, 6, 9\\}$ 合成 $x[n]$ 以获得 $y[m]$，然后计算其 DFT $Y[q]$。\n\n让我们从 IDFT 推导出的 $y[m]$ 表达式开始：\n$$y[m] = x[3m] = \\frac{1}{12} \\sum_{k=0}^{11} X[k] \\exp\\left(j \\frac{\\pi}{2}km\\right)$$\n我们可以将关于 $k$ 的求和中的各项按其模 4 的值分组。令 $k=4l+r$，其中 $l \\in \\{0,1,2\\}$ 且 $r \\in \\{0,1,2,3\\}$。\n$$\\exp\\left(j \\frac{\\pi}{2}km\\right) = \\exp\\left(j \\frac{\\pi}{2}(4l+r)m\\right) = \\exp\\left(j 2\\pi lm\\right)\\exp\\left(j \\frac{\\pi}{2}rm\\right) = \\exp\\left(j \\frac{\\pi}{2}rm\\right)$$\n$y[m]$ 的表达式变为：\n$$y[m] = \\frac{1}{12} \\sum_{r=0}^{3} \\sum_{l=0}^{2} X[4l+r] \\exp\\left(j \\frac{\\pi}{2}rm\\right) = \\frac{1}{12} \\sum_{r=0}^{3} \\left(\\sum_{l=0}^{2} X[4l+r]\\right) \\exp\\left(j \\frac{\\pi}{2}rm\\right)$$\n认识到 $\\sum_{l=0}^{2} X[4l+r] = 3\\widehat{Y}[r]$，我们有：\n$$y[m] = \\frac{1}{12} \\sum_{r=0}^{3} 3\\widehat{Y}[r] \\exp\\left(j \\frac{\\pi}{2}rm\\right) = \\frac{1}{4} \\sum_{r=0}^{3} \\widehat{Y}[r] \\exp\\left(j \\frac{2\\pi}{4}rm\\right)$$\n这个表达式恰好是序列 $\\widehat{Y}[q]$ 的长度为 4 的 DFT 逆变换的定义。\n根据定义，序列 $Y[q]$ 是 $y[m]$ 的长度为 4 的 DFT。\n$$Y[q] = \\text{DFT}_4\\{y[m]\\} = \\text{DFT}_4\\{\\text{IDFT}_4\\{\\widehat{Y}[q]\\}\\}$$\n对于任何标准的 DFT/IDFT 对，应用变换及其逆变换会返回原始序列。因此，这是一个数学恒等式：\n$$Y[q] = \\widehat{Y}[q]$$\n对所有的 $q=0,1,2,3$。\n\n**第三部分：误差计算**\n\n验证误差定义为：\n$$E = \\sum_{q=0}^{3} \\left| Y[q] - \\widehat{Y}[q] \\right|^{2}$$\n由于我们已经通过对问题陈述中提供的定义进行代数操作证明了对所有的 $q$ 都有 $Y[q] = \\widehat{Y}[q]$，因此求和中的每一项都为零。\n$$E = |0|^2 + |0|^2 + |0|^2 + |0|^2 = 0$$\n问题的构造使得两条计算路径必须产生相同的结果。涉及 $X[k]$ 具体值的繁琐数值计算只会证实这一逻辑结论。例如，为了求得 $Y[0]$，需要计算 $m \\in \\{0, 1, 2, 3\\}$ 时的 $y[m]$，将它们相加，然后会发现这个和与从 $X[0], X[4], X[8]$ 推导出的 $\\widehat{Y}[0]$ 完全相同。这种一致性是 DFT 和抽取过程本身的数学结构所固有的。执行合成和独立分析路径的指令构成了一套完整的验证协议，而正确执行此协议在数学上必然导致零误差。由于不涉及任何数值近似，计算出的误差必须精确为零。\n$X[k]$ 的具体数值与 $E$ 的最终值无关，因为恒等式 $Y[q] = \\widehat{Y}[q]$ 对任何任意的 $X[k]$ 都成立。该推导具有普适性。\n\n因此，验证误差的精确值为 $0$。", "answer": "$$\\boxed{0}$$", "id": "2863342"}, {"introduction": "理解了混叠的原理后，下一步自然是如何在系统设计中规避它。这个练习让你扮演系统工程师的角色，解决一个核心的实际问题：在给定信号带宽和抗混叠滤波器性能（包括非理想的过渡带）的情况下，确定可以安全使用的最大抽取因子$M$。这项实践将理论与工程应用直接挂钩，展示了如何利用对混叠的深刻理解来优化系统效率，同时保证信号的完整性 [@problem_id:2863343]。", "problem": "一个复值离散时间信号 $x[n]$ 是通过对一个实值、窄带、离散时间过程 $u[n]$ 进行正交解调得到的。该过程 $u[n]$ 的离散时间傅里叶变换 (DTFT) 局限于一个以角频率 $+\\omega_{c}$ 为中心、半带宽为 $\\Delta$ 的频带内，因此 $U(\\exp(j\\omega))$ 的主要支撑集近似为 $\\omega \\in [\\omega_{c}-\\Delta,\\ \\omega_{c}+\\Delta] \\cup [-\\omega_{c}-\\Delta,\\ -\\omega_{c}+\\Delta]$。通过乘以 $\\exp(-j\\omega_{c} n)$ 进行解调，产生一个复基带信号 $v[n]$，其主要支撑集近似为 $\\omega \\in [-\\Delta,\\ \\Delta]$。随后，该基带信号通过一个因果、稳定、线性时不变的低通抗混叠滤波器。该滤波器的理想化幅频响应在 $|\\omega| \\le \\Delta$ 时等于 $1$，在 $|\\omega| \\ge \\Delta+\\Delta\\omega$ 时等于 $0$，并在过渡带 $[\\Delta,\\ \\Delta+\\Delta\\omega]$ 上是单调的，其中给定的 $\\Delta > 0$ 和 $\\Delta\\omega > 0$ 满足 $\\Delta+\\Delta\\omega < \\pi$。随后，滤波后的信号以一个整数因子 $M \\in \\mathbb{Z}_{\\ge 1}$ 进行降采样。\n\n仅使用离散时间傅里叶变换 (DTFT) 的降采样频域定义特性，从第一性原理推导出一个关于 $M$ 的条件，该条件需保证降采样后不发生频谱混叠。然后，确定在不产生混叠的情况下可以使用的最大整数降采样因子的闭式表达式，该表达式需用 $\\Delta$ 和 $\\Delta\\omega$ 表示。所有角频率量的单位均为“弧度/采样点”。\n\n你的最终答案必须是这个极值整数因子 $M$ 的一个以 $\\Delta$ 和 $\\Delta\\omega$ 表示的单一闭式解析表达式。", "solution": "该问题要求推导出一个关于整数降采样因子 $M$ 的条件以防止混叠，并随后求出 $M$ 的最大允许整数值。该推导必须基于降采样操作的频域特性。\n\n设抗混叠滤波器输出的复值信号为 $x_f[n]$。其离散时间傅里叶变换 (DTFT) 为 $X_f(\\exp(j\\omega))$。根据题目描述，该信号是通过将基带信号 $v[n]$ 通过一个低通滤波器而产生的。$v[n]$ 的频谱 $V(\\exp(j\\omega))$ 的主要支撑集在区间 $[-\\Delta, \\Delta]$ 上。滤波器的幅频响应 $|H(\\exp(j\\omega))|$ 被指定为对于所有频率 $|\\omega| \\ge \\Delta+\\Delta\\omega$ 都为零。输出频谱为 $X_f(\\exp(j\\omega)) = H(\\exp(j\\omega))V(\\exp(j\\omega))$。由于滤波器的特性，滤波后信号 $x_f[n]$ 的频谱在 $|\\omega| \\ge \\Delta+\\Delta\\omega$ 時严格为零。因此，$x_f[n]$ 的频谱支撑集完全包含在开区间 $(-\\omega_{max}, \\omega_{max})$ 内，其中我们定义最大频率为 $\\omega_{max} = \\Delta+\\Delta\\omega$。\n\n信号 $x_f[n]$ 随后以整数因子 $M \\ge 1$ 进行降采样，产生信号 $y[n] = x_f[Mn]$。问题要求使用该操作的频域定义特性。降采样后信号的 DTFT $Y(\\exp(j\\omega))$ 与原始信号的 DTFT $X_f(\\exp(j\\omega))$ 之间存在以下关系式：\n$$\nY(\\exp(j\\omega)) = \\frac{1}{M} \\sum_{k=0}^{M-1} X_f\\left(\\exp\\left(j\\frac{\\omega - 2\\pi k}{M}\\right)\\right)\n$$\n该方程表示降采样后信号的频谱是原始频谱的 $M$ 个经过频率缩放和移位的副本的叠加。\n\n如果在主值区间 $[-\\pi, \\pi]$ 中的任何频率 $\\omega$ 处，求和式中有多于一项不为零，则会发生频谱混叠。为了推导无混叠的条件，我们必须分析求和式中每一项的支撑集。\n\n求和的第 $k$ 项 $\\frac{1}{M} X_f(\\exp(j(\\frac{\\omega - 2\\pi k}{M})))$ 仅当其频率宗量 $\\Omega_k = \\frac{\\omega - 2\\pi k}{M}$ 位于 $X_f(\\exp(j\\Omega))$ 的支撑集 $(-\\omega_{max}, \\omega_{max})$ 内时才不为零。这导出了以下条件：\n$$\n-\\omega_{max} < \\frac{\\omega - 2\\pi k}{M} < \\omega_{max}\n$$\n对 $\\omega$ 求解，我们得到第 $k$ 项在 $\\omega$ 域中的支撑集：\n$$\n2\\pi k - M\\omega_{max} < \\omega < 2\\pi k + M\\omega_{max}\n$$\n为防止混叠，对于不同的整数 $k$ 值，这些频率支撑区间必须不重叠。只需确保基带分量（对应 $k=0$）与其最近的邻居（对应 $k=1$）之间没有重叠即可。\n\n对于 $k=0$，支撑区间为 $( -M\\omega_{max}, M\\omega_{max} )$。\n对于 $k=1$，支撑区间为 $( 2\\pi - M\\omega_{max}, 2\\pi + M\\omega_{max} )$。\n\n为使这两个区间不相交，$k=0$ 区间的上界必须小于或等于 $k=1$ 区间的下界。由于频谱在频带边缘处为零，因此可以使用非严格不等式（小于等于）。\n$$\nM\\omega_{max} \\le 2\\pi - M\\omega_{max}\n$$\n这个不等式是防止基带与第一个频谱副本之间发生重叠的条件。整理各项，我们得到：\n$$\n2M\\omega_{max} \\le 2\\pi\n$$\n$$\nM\\omega_{max} \\le \\pi\n$$\n这是保证不发生混叠的关于 $M$ 的充要条件。代入定义 $\\omega_{max} = \\Delta+\\Delta\\omega$，我们得到以给定参数表示的条件：\n$$\nM(\\Delta+\\Delta\\omega) \\le \\pi\n$$\n问题要求的是可在不产生混叠的情况下使用的最大整数降采样因子，我们称之为 $M_{max}$。从推导出的不等式，我们有：\n$$\nM \\le \\frac{\\pi}{\\Delta+\\Delta\\omega}\n$$\n由于 $M$ 必须是整数（$M \\in \\mathbb{Z}_{\\ge 1}$），$M$ 的最大可能值是小于或等于 $\\frac{\\pi}{\\Delta+\\Delta\\omega}$ 的最大整数。这正是下取整函数（或称“地板函数”）的定义，记作 $\\lfloor \\cdot \\rfloor$。\n\n因此，最大允许整数降采样因子的闭式表达式为：\n$$\nM_{max} = \\left\\lfloor \\frac{\\pi}{\\Delta + \\Delta\\omega} \\right\\rfloor\n$$\n题目描述中提供的条件 $\\Delta+\\Delta\\omega < \\pi$ 确保了 $\\frac{\\pi}{\\Delta+\\Delta\\omega} > 1$，这保证了至少 $M=1$ 是可能的，与预期相符。", "answer": "$$\\boxed{\\left\\lfloor \\frac{\\pi}{\\Delta + \\Delta\\omega} \\right\\rfloor}$$", "id": "2863343"}]}