{"hands_on_practices": [{"introduction": "正交镜像滤波器（QMF）组的理论基石是其能够完美消除由下采样引入的混叠。本实践将引导您完成一个基础推导，以证明经典 QMF 配置的此特性。通过从第一性原理出发，推导双通道系统的频域输入-输出关系，您将精确地看到分析滤波器之间的正交镜像关系以及综合滤波器的特定选择如何共同作用，最终使混叠传递函数 $A(e^{j\\omega})$ 恒等于零 [@problem_id:2915690]。这个练习巩固了多速率滤波器组的核心数学原理，并揭示了其作为强大信号处理工具的内在机制。", "problem": "考虑为离散时间信号设计一个双通道正交镜像滤波器 (QMF) 组。设分析低通滤波器是一个实数、线性相位、对称半带有限冲激响应 (FIR) 滤波器 $H_{0}(\\exp(j\\omega))$，它是通过窗函数法从理想半带低通滤波器得到的。具体来说，从一个理想半带频率响应开始，该响应在 $|\\omega| \\leq \\omega_{c}$ 时为1，在 $|\\omega| \\geq \\pi - \\omega_{c}$ 时为0，过渡带中心在 $\\omega_{c} = \\pi/2$。其理想冲激响应为\n$$\nh_{\\mathrm{ideal}}[n] \\;=\\; \\frac{\\sin\\!\\big(\\frac{\\pi}{2}(n - (N-1)/2)\\big)}{\\pi (n - (N-1)/2)} \\quad \\text{for} \\; n \\neq (N-1)/2,\\quad\nh_{\\mathrm{ideal}}[(N-1)/2] \\;=\\; \\frac{1}{2},\n$$\n其中 $N$ 是一个奇正整数。选择任意一个在 $n = 0,\\dots,N-1$ 上有支撑的偶对称窗函数 $w[n]$，满足 $w[n] = w[N-1-n]$，并将设计的滤波器系数定义为 $h_{0}[n] = h_{\\mathrm{ideal}}[n]\\,w[n]$，使得 $H_{0}(\\exp(j\\omega))$ 是实数、偶对称和半带的。通过正交镜像关系 $H_{1}(\\exp(j\\omega)) = H_{0}(\\exp(j(\\omega - \\pi)))$ 定义相应的分析高通滤波器。考虑一个经典的双通道 QMF 分析-综合系统，该系统在分析后进行2倍降采样，在综合前进行2倍升采样，且选择的综合滤波器为 $F_{0}(\\exp(j\\omega)) = H_{0}(\\exp(j\\omega))$ 和 $F_{1}(\\exp(j\\omega)) = -\\,H_{1}(\\exp(j\\omega))$。\n\n仅从离散时间傅里叶变换 (DTFT)、线性时不变滤波的定义，以及2倍降采样和2倍升采样的频域关系出发，推导输入-输出关系，并分离出系统输出中的期望（非混叠）分量和混叠分量。由此，求出在输出端与调制输入 $X(\\exp(j(\\omega-\\pi)))$ 相乘的混叠传递函数 $A(\\exp(j\\omega))$。然后，仅利用所述的 $H_{0}$、$H_{1}$、$F_{0}$ 和 $F_{1}$ 之间的 QMF 关系，计算 $A(\\exp(j\\omega))$ 的精确闭式表达式。\n\n你的最终答案必须是单一的闭式解析表达式。无需数值近似。", "solution": "该问题陈述是数字信号处理领域中一个有效且适定的问题。它具有科学依据，并包含了推导唯一解所需的所有必要信息。我们将开始推导。\n\n该结构是一个双通道分析-综合滤波器组。设输入信号为 $x[n]$，其离散时间傅里叶变换 (DTFT) 为 $X(\\exp(j\\omega))$。\n\n首先，我们描述分析阶段。输入信号 $x[n]$ 通过一个低通滤波器 $h_{0}[n]$ 和一个高通滤波器 $h_{1}[n]$。输出分别为 $y_{0}[n]$ 和 $y_{1}[n]$。在频域中，它们的 DTFT 由以下公式给出：\n$$Y_{0}(\\exp(j\\omega)) = H_{0}(\\exp(j\\omega)) X(\\exp(j\\omega))$$\n$$Y_{1}(\\exp(j\\omega)) = H_{1}(\\exp(j\\omega)) X(\\exp(j\\omega))$$\n\n接下来，这些信号被以2倍因子进行降采样。设降采样后的信号为 $v_{0}[n] = y_{0}[2n]$ 和 $v_{1}[n] = y_{1}[2n]$。一个经过2倍降采样的信号的 DTFT 与原始信号的 DTFT 之间有以下基本关系：\n$$V_{k}(\\exp(j\\omega)) = \\frac{1}{2} \\left[ Y_{k}(\\exp(j\\omega/2)) + Y_{k}(\\exp(j(\\omega/2 - \\pi))) \\right]$$\n对于 $k = 0, 1$。代入 $Y_{0}(\\exp(j\\omega))$ 和 $Y_{1}(\\exp(j\\omega))$ 的表达式，我们得到：\n$$V_{0}(\\exp(j\\omega)) = \\frac{1}{2} \\left[ H_{0}(\\exp(j\\omega/2)) X(\\exp(j\\omega/2)) + H_{0}(\\exp(j(\\omega/2 - \\pi))) X(\\exp(j(\\omega/2 - \\pi))) \\right]$$\n$$V_{1}(\\exp(j\\omega)) = \\frac{1}{2} \\left[ H_{1}(\\exp(j\\omega/2)) X(\\exp(j\\omega/2)) + H_{1}(\\exp(j(\\omega/2 - \\pi))) X(\\exp(j(\\omega/2 - \\pi))) \\right]$$\n\n这些降采样后的信号被传输，然后在接收端、综合阶段之前被以2倍因子进行升采样。设升采样后的信号为 $u_{0}[n]$ 和 $u_{1}[n]$。升采样信号的 DTFT 由 $U(\\exp(j\\omega)) = V(\\exp(j2\\omega))$ 给出。将此应用于 $v_{0}[n]$ 和 $v_{1}[n]$ 得到：\n$$U_{0}(\\exp(j\\omega)) = V_{0}(\\exp(j2\\omega)) = \\frac{1}{2} \\left[ H_{0}(\\exp(j\\omega)) X(\\exp(j\\omega)) + H_{0}(\\exp(j(\\omega - \\pi))) X(\\exp(j(\\omega - \\pi))) \\right]$$\n$$U_{1}(\\exp(j\\omega)) = V_{1}(\\exp(j2\\omega)) = \\frac{1}{2} \\left[ H_{1}(\\exp(j\\omega)) X(\\exp(j\\omega)) + H_{1}(\\exp(j(\\omega - \\pi))) X(\\exp(j(\\omega - \\pi))) \\right]$$\n\n最后，综合阶段重建信号。升采样后的信号由综合滤波器 $F_{0}(\\exp(j\\omega))$ 和 $F_{1}(\\exp(j\\omega))$ 进行滤波，其输出相加。最终输出信号 $\\hat{x}[n]$ 的 DTFT 是：\n$$\\hat{X}(\\exp(j\\omega)) = F_{0}(\\exp(j\\omega)) U_{0}(\\exp(j\\omega)) + F_{1}(\\exp(j\\omega)) U_{1}(\\exp(j\\omega))$$\n代入 $U_{0}(\\exp(j\\omega))$ 和 $U_{1}(\\exp(j\\omega))$ 的表达式：\n\\begin{align*}\n\\hat{X}(\\exp(j\\omega)) &= \\frac{1}{2} F_{0}(\\exp(j\\omega)) \\left[ H_{0}(\\exp(j\\omega)) X(\\exp(j\\omega)) + H_{0}(\\exp(j(\\omega - \\pi))) X(\\exp(j(\\omega - \\pi))) \\right] \\\\\n&+ \\frac{1}{2} F_{1}(\\exp(j\\omega)) \\left[ H_{1}(\\exp(j\\omega)) X(\\exp(j\\omega)) + H_{1}(\\exp(j(\\omega - \\pi))) X(\\exp(j(\\omega - \\pi))) \\right]\n\\end{align*}\n我们现在将包含原始输入频谱 $X(\\exp(j\\omega))$ 的项与包含混叠频谱 $X(\\exp(j(\\omega - \\pi)))$ 的项分离开来。\n\\begin{align*}\n\\hat{X}(\\exp(j\\omega)) &= \\frac{1}{2} \\left[ F_{0}(\\exp(j\\omega)) H_{0}(\\exp(j\\omega)) + F_{1}(\\exp(j\\omega)) H_{1}(\\exp(j\\omega)) \\right] X(\\exp(j\\omega)) \\\\\n&+ \\frac{1}{2} \\left[ F_{0}(\\exp(j\\omega)) H_{0}(\\exp(j(\\omega - \\pi))) + F_{1}(\\exp(j\\omega)) H_{1}(\\exp(j(\\omega - \\pi))) \\right] X(\\exp(j(\\omega - \\pi)))\n\\end{align*}\n这是双通道滤波器组的一般输入-输出关系，其形式为 $\\hat{X}(\\exp(j\\omega)) = T(\\exp(j\\omega)) X(\\exp(j\\omega)) + A(\\exp(j\\omega)) X(\\exp(j(\\omega - \\pi)))$。\n项 $A(\\exp(j\\omega))$ 是混叠传递函数，由以下公式给出：\n$$A(\\exp(j\\omega)) = \\frac{1}{2} \\left[ F_{0}(\\exp(j\\omega)) H_{0}(\\exp(j(\\omega - \\pi))) + F_{1}(\\exp(j\\omega)) H_{1}(\\exp(j(\\omega - \\pi))) \\right]$$\n问题要求我们使用滤波器之间的指定关系来计算 $A(\\exp(j\\omega))$ 的精确闭式表达式：\n1.  $H_{1}(\\exp(j\\omega)) = H_{0}(\\exp(j(\\omega - \\pi)))$\n2.  $F_{0}(\\exp(j\\omega)) = H_{0}(\\exp(j\\omega))$\n3.  $F_{1}(\\exp(j\\omega)) = -H_{1}(\\exp(j\\omega))$\n\n我们将关系 (2) 和 (3) 代入 $A(\\exp(j\\omega))$ 的表达式中：\n$$A(\\exp(j\\omega)) = \\frac{1}{2} \\left[ H_{0}(\\exp(j\\omega)) H_{0}(\\exp(j(\\omega - \\pi))) + (-H_{1}(\\exp(j\\omega))) H_{1}(\\exp(j(\\omega - \\pi))) \\right]$$\n$$A(\\exp(j\\omega)) = \\frac{1}{2} \\left[ H_{0}(\\exp(j\\omega)) H_{0}(\\exp(j(\\omega - \\pi))) - H_{1}(\\exp(j\\omega)) H_{1}(\\exp(j(\\omega - \\pi))) \\right]$$\n现在，我们使用关系 (1) 将涉及 $H_{1}$ 的项用 $H_{0}$ 表示。我们需要的第一个项是 $H_{1}(\\exp(j\\omega))$，它直接由关系 (1) 给出：\n$$H_{1}(\\exp(j\\omega)) = H_{0}(\\exp(j(\\omega - \\pi)))$$\n我们需要的第二个项是 $H_{1}(\\exp(j(\\omega - \\pi)))$。我们通过将 $\\omega \\to (\\omega - \\pi)$ 代入关系 (1) 来获得此项：\n$$H_{1}(\\exp(j(\\omega - \\pi))) = H_{0}(\\exp(j((\\omega - \\pi) - \\pi))) = H_{0}(\\exp(j(\\omega - 2\\pi)))$$\n由于 DTFT 的周期为 $2\\pi$，所以 $H_{0}(\\exp(j(\\omega - 2\\pi))) = H_{0}(\\exp(j\\omega))$。因此：\n$$H_{1}(\\exp(j(\\omega - \\pi))) = H_{0}(\\exp(j\\omega))$$\n现在我们将这两个恒等式代回我们关于 $A(\\exp(j\\omega))$ 的表达式：\n$$A(\\exp(j\\omega)) = \\frac{1}{2} \\left[ H_{0}(\\exp(j\\omega)) H_{0}(\\exp(j(\\omega - \\pi))) - (H_{0}(\\exp(j(\\omega - \\pi)))) (H_{0}(\\exp(j\\omega))) \\right]$$\n括号内的两项是相同的，并且相互抵消。\n$$A(\\exp(j\\omega)) = \\frac{1}{2} \\left[ 0 \\right]$$\n因此，混叠传递函数恒等于零。\n$$A(\\exp(j\\omega)) = 0$$\n这表明，问题中规定的综合滤波器的特定选择，与分析滤波器之间的正交镜像关系相结合，导致 QMF 滤波器组输出端的混叠分量被完美消除。关于 $H_{0}(\\exp(j\\omega))$ 设计的详尽细节是背景信息，用于确认这种滤波器可以实现，但对于最终的代数简化并非必需。", "answer": "$$\\boxed{0}$$", "id": "2915690"}, {"introduction": "虽然理想的 QMF 组能够消除混叠，但加深理解的最佳方式是检验其失效的场景。本实践提供了一个精心设计的反例：尽管分析滤波器满足正交镜像关系，但不恰当的综合滤波器选择却导致了混叠残留。您的任务是为这个有缺陷的系统推导其非零的混叠传递函数 $T_1(e^{j\\omega})$，从而揭示混叠持续存在的具体形式和根本原因 [@problem_id:2915706]。这项练习能够锻炼您的系统诊断能力，并强调完美重构依赖于整个滤波器组系统的协同设计。", "problem": "考虑一个临界采样的双通道分析-综合滤波器组，其抽取和内插因子为 $2$。设分析滤波器为 $H_{0}(z)$ 和 $H_{1}(z)$，综合滤波器为 $F_{0}(z)$ 和 $F_{1}(z)$。输入为 $x[n]$，其离散时间傅里叶变换 (DTFT) 为 $X(\\exp(\\mathrm{j}\\omega))$，其中 $\\omega$ 是归一化弧度频率。\n\n您需要构建一个具体的反例，其中分析滤波器满足正交镜像条件 $H_{1}(z)=H_{0}(-z)$，但所选的综合滤波器不满足混叠消除条件。具体来说，选择\n- $H_{0}(z)=1+z^{-1}$ 和 $H_{1}(z)=H_{0}(-z)$，\n- $F_{0}(z)=H_{0}(z)$ 和 $F_{1}(z)=H_{1}(z)$。\n\n从因子为 $2$ 的抽取和内插的基本 DTFT 关系以及线性时不变系统的卷积性质出发，推导重建输出 $y[n]$ 的调制域输入-输出关系 $Y(\\exp(\\mathrm{j}\\omega))$，其形式为\n$$\nY(\\exp(\\mathrm{j}\\omega)) \\;=\\; T_{0}(\\exp(\\mathrm{j}\\omega))\\,X(\\exp(\\mathrm{j}\\omega)) \\;+\\; T_{1}(\\exp(\\mathrm{j}\\omega))\\,X(\\exp(\\mathrm{j}(\\omega+\\pi)))\\,,\n$$\n从而确定您所选滤波器的混叠传递函数 $T_{1}(\\exp(\\mathrm{j}\\omega))$。您的推导必须从第一性原理出发：使用因子为 $2$ 的减采样和增采样的 DTFT 定义以及线性卷积，并且不要假定任何预先推导出的混叠消除公式。\n\n以 $\\omega$ 的闭式解析表达式明确计算出最终的 $T_{1}(\\exp(\\mathrm{j}\\omega))$。请以单个解析表达式的形式给出您的最终答案。不需要四舍五入，也不需要单位。请明确说明频率变量 $\\omega$ 的单位是弧度。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 系统：一个双通道分析-综合滤波器组。\n- 抽取和内插因子：$M=2$。\n- 分析滤波器：$H_{0}(z)$ 和 $H_{1}(z)$。\n- 综合滤波器：$F_{0}(z)$ 和 $F_{1}(z)$。\n- 输入信号：$x[n]$，其离散时间傅里叶变换 (DTFT) 为 $X(\\exp(\\mathrm{j}\\omega))$。\n- 输出信号：$y[n]$，其 DTFT 为 $Y(\\exp(\\mathrm{j}\\omega))$。\n- 滤波器定义：\n  - $H_{0}(z) = 1+z^{-1}$\n  - $H_{1}(z) = H_{0}(-z)$\n  - $F_{0}(z) = H_{0}(z)$\n  - $F_{1}(z) = H_{1}(z)$\n- 要求的输出形式：$Y(\\exp(\\mathrm{j}\\omega)) = T_{0}(\\exp(\\mathrm{j}\\omega))X(\\exp(\\mathrm{j}\\omega)) + T_{1}(\\exp(\\mathrm{j}\\omega))X(\\exp(\\mathrm{j}(\\omega+\\pi)))$。\n- 任务：从第一性原理出发，为给定滤波器推导混叠传递函数 $T_{1}(\\exp(\\mathrm{j}\\omega))$ 的表达式，并计算其显式形式。频率变量 $\\omega$ 的单位是弧度。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学性**：该问题是多速率数字信号处理中的一个标准练习，涉及正交镜像滤波器 (QMF) 组的分析。包括 DTFT、z 变换、抽取、内插和滤波器组在内的所有概念都是该领域的基础。\n- **适定性**：问题定义清晰。它提供了具体的滤波器，并要求推导一个特定的量 ($T_{1}(\\exp(\\mathrm{j}\\omega))$)。目标明确，并且存在唯一的解析解。\n- **客观性**：问题使用精确、形式化的数学语言陈述，没有任何主观性或模糊性。\n- **缺陷分析**：\n  1.  **科学/事实不准确性**：无。该问题正确使用了既定原理。滤波器的特定选择旨在展示混叠消除失败的情况，这是一个有效的教学目标。\n  2.  **非形式化/不相关**：无。该问题直接并形式化地与 QMF 滤波器组的主题相关。\n  3.  **不完整/矛盾**：无。所有必要的滤波器定义和系统参数都已提供。\n  4.  **不切实际/不可行**：无。所用滤波器是简单的、稳定的、因果的有限冲激响应 (FIR) 滤波器。\n  5.  **不适定**：无。该问题导向一个唯一的、定义明确的解。\n  6.  **伪深刻/琐碎**：无。该任务要求从第一性原理进行严格推导，这是一项考验基础理解能力的非平凡练习。\n  7.  **超出科学可验证范围**：无。结果是可以通过数学推导和验证的。\n\n**步骤 3：结论与行动**\n该问题是**有效的**。将提供一个完整且论证充分的解答。\n\n**求解推导**\n\n我们首先从第一性原理出发，建立双通道滤波器组的输入-输出关系。该系统由两个并行支路组成，索引为 $k \\in \\{0, 1\\}$。\n\n在每个支路 $k$ 中，输入信号 $x[n]$ 首先由分析滤波器 $h_k[n]$ 进行滤波。该滤波器的输出为 $v_k[n] = (x * h_k)[n]$。在频域中，卷积对应于乘法：\n$$\nV_{k}(\\exp(\\mathrm{j}\\omega)) = X(\\exp(\\mathrm{j}\\omega)) H_{k}(\\exp(\\mathrm{j}\\omega))\n$$\n\n然后，信号 $v_k[n]$ 经过因子为 $2$ 的减采样，产生 $w_k[n] = v_k[2n]$。减采样信号 $w[n] = v[2n]$ 的 DTFT 由下式给出：\n$$\nW(\\exp(\\mathrm{j}\\omega)) = \\frac{1}{2} \\left[ V(\\exp(\\mathrm{j}\\frac{\\omega}{2})) + V(\\exp(\\mathrm{j}(\\frac{\\omega}{2}+\\pi))) \\right]\n$$\n将此应用于我们的系统，我们得到：\n$$\nW_{k}(\\exp(\\mathrm{j}\\omega)) = \\frac{1}{2} \\left[ V_{k}(\\exp(\\mathrm{j}\\frac{\\omega}{2})) + V_{k}(\\exp(\\mathrm{j}(\\frac{\\omega}{2}+\\pi))) \\right]\n$$\n\n然后，减采样信号 $w_k[n]$ 经过因子为 $2$ 的增采样，得到 $u_k[n]$。这个过程在 $w_k[n]$ 的每个样本之间插入一个零。从 $w[n]$ 获得的增采样信号 $u[n]$ 的 DTFT 由下式给出：\n$$\nU(\\exp(\\mathrm{j}\\omega)) = W(\\exp(\\mathrm{j}2\\omega))\n$$\n因此，对于我们的系统：\n$$\nU_{k}(\\exp(\\mathrm{j}\\omega)) = W_{k}(\\exp(\\mathrm{j}2\\omega)) = \\frac{1}{2} \\left[ V_{k}(\\exp(\\mathrm{j}\\omega)) + V_{k}(\\exp(\\mathrm{j}(\\omega+\\pi))) \\right]\n$$\n\n代入 $V_k(\\exp(\\mathrm{j}\\omega))$ 的表达式，我们得到：\n$$\nU_{k}(\\exp(\\mathrm{j}\\omega)) = \\frac{1}{2} \\left[ H_{k}(\\exp(\\mathrm{j}\\omega))X(\\exp(\\mathrm{j}\\omega)) + H_{k}(\\exp(\\mathrm{j}(\\omega+\\pi)))X(\\exp(\\mathrm{j}(\\omega+\\pi))) \\right]\n$$\n\n该信号 $u_k[n]$ 接着通过综合滤波器 $f_k[n]$。该滤波器的输出为 $y_k[n] = (u_k * f_k)[n]$。在频域中：\n$$\nY_{k}(\\exp(\\mathrm{j}\\omega)) = F_{k}(\\exp(\\mathrm{j}\\omega)) U_{k}(\\exp(\\mathrm{j}\\omega))\n$$\n\n最终的重建信号 $y[n]$ 是两个支路输出之和：$y[n] = y_0[n] + y_1[n]$。因此，其 DTFT 为：\n$$\nY(\\exp(\\mathrm{j}\\omega)) = Y_{0}(\\exp(\\mathrm{j}\\omega)) + Y_{1}(\\exp(\\mathrm{j}\\omega))\n$$\n代入 $Y_k$ 和 $U_k$ 的表达式：\n$$\nY(\\exp(\\mathrm{j}\\omega)) = \\sum_{k=0}^{1} F_{k}(\\exp(\\mathrm{j}\\omega)) \\left( \\frac{1}{2} \\left[ H_{k}(\\exp(\\mathrm{j}\\omega))X(\\exp(\\mathrm{j}\\omega)) + H_{k}(\\exp(\\mathrm{j}(\\omega+\\pi)))X(\\exp(\\mathrm{j}(\\omega+\\pi))) \\right] \\right)\n$$\n\n现在我们将对应于 $X(\\exp(\\mathrm{j}\\omega))$ 的项和混叠项 $X(\\exp(\\mathrm{j}(\\omega+\\pi)))$ 分组：\n$$\nY(\\exp(\\mathrm{j}\\omega)) = \\left( \\frac{1}{2} \\sum_{k=0}^{1} F_{k}(\\exp(\\mathrm{j}\\omega))H_{k}(\\exp(\\mathrm{j}\\omega)) \\right) X(\\exp(\\mathrm{j}\\omega)) + \\left( \\frac{1}{2} \\sum_{k=0}^{1} F_{k}(\\exp(\\mathrm{j}\\omega))H_{k}(\\exp(\\mathrm{j}(\\omega+\\pi))) \\right) X(\\exp(\\mathrm{j}(\\omega+\\pi)))\n$$\n\n将其与所需形式 $Y(\\exp(\\mathrm{j}\\omega)) = T_{0}(\\exp(\\mathrm{j}\\omega))X(\\exp(\\mathrm{j}\\omega)) + T_{1}(\\exp(\\mathrm{j}\\omega))X(\\exp(\\mathrm{j}(\\omega+\\pi)))$ 进行比较，我们确定失真传递函数 $T_{0}(\\exp(\\mathrm{j}\\omega))$ 和混叠传递函数 $T_{1}(\\exp(\\mathrm{j}\\omega))$：\n$$\nT_{0}(\\exp(\\mathrm{j}\\omega)) = \\frac{1}{2} \\left[ F_{0}(\\exp(\\mathrm{j}\\omega))H_{0}(\\exp(\\mathrm{j}\\omega)) + F_{1}(\\exp(\\mathrm{j}\\omega))H_{1}(\\exp(\\mathrm{j}\\omega)) \\right]\n$$\n$$\nT_{1}(\\exp(\\mathrm{j}\\omega)) = \\frac{1}{2} \\left[ F_{0}(\\exp(\\mathrm{j}\\omega))H_{0}(\\exp(\\mathrm{j}(\\omega+\\pi))) + F_{1}(\\exp(\\mathrm{j}\\omega))H_{1}(\\exp(\\mathrm{j}(\\omega+\\pi))) \\right]\n$$\n\n问题要求为给定滤波器显式计算 $T_{1}(\\exp(\\mathrm{j}\\omega))$。这些滤波器是：\n- $H_{0}(z) = 1+z^{-1}$\n- $H_{1}(z) = H_{0}(-z) = 1+(-z)^{-1} = 1-z^{-1}$\n- $F_{0}(z) = H_{0}(z) = 1+z^{-1}$\n- $F_{1}(z) = H_{1}(z) = 1-z^{-1}$\n\n首先，我们通过代入 $z = \\exp(\\mathrm{j}\\omega)$ 来评估频率响应：\n- $H_{0}(\\exp(\\mathrm{j}\\omega)) = 1+\\exp(-\\mathrm{j}\\omega)$\n- $H_{1}(\\exp(\\mathrm{j}\\omega)) = 1-\\exp(-\\mathrm{j}\\omega)$\n- $F_{0}(\\exp(\\mathrm{j}\\omega)) = 1+\\exp(-\\mathrm{j}\\omega)$\n- $F_{1}(\\exp(\\mathrm{j}\\omega)) = 1-\\exp(-\\mathrm{j}\\omega)$\n\n接下来，我们评估移频后的分析滤波器响应。这些响应通过正交镜像属性 $H_{1}(z)=H_{0}(-z)$ 相关联：\n- $H_{0}(\\exp(\\mathrm{j}(\\omega+\\pi))) = H_{0}(-\\exp(\\mathrm{j}\\omega)) = H_{1}(\\exp(\\mathrm{j}\\omega)) = 1-\\exp(-\\mathrm{j}\\omega)$\n- $H_{1}(\\exp(\\mathrm{j}(\\omega+\\pi))) = H_{1}(-\\exp(\\mathrm{j}\\omega)) = H_{0}(-\\exp(\\mathrm{j}\\omega))|_{z \\to -z} = H_{0}(z)|_{z \\to \\exp(\\mathrm{j}\\omega)} = H_{0}(\\exp(\\mathrm{j}\\omega)) = 1+\\exp(-\\mathrm{j}\\omega)$\n\n现在，我们将这些代入 $T_{1}(\\exp(\\mathrm{j}\\omega))$ 的表达式中：\n$$\nT_{1}(\\exp(\\mathrm{j}\\omega)) = \\frac{1}{2} \\left[ F_{0}(\\exp(\\mathrm{j}\\omega))H_{1}(\\exp(\\mathrm{j}\\omega)) + F_{1}(\\exp(\\mathrm{j}\\omega))H_{0}(\\exp(\\mathrm{j}\\omega)) \\right]\n$$\n代入具体的滤波器选择 $F_{0}=H_{0}$ 和 $F_{1}=H_{1}$：\n$$\nT_{1}(\\exp(\\mathrm{j}\\omega)) = \\frac{1}{2} \\left[ H_{0}(\\exp(\\mathrm{j}\\omega))H_{1}(\\exp(\\mathrm{j}\\omega)) + H_{1}(\\exp(\\mathrm{j}\\omega))H_{0}(\\exp(\\mathrm{j}\\omega)) \\right]\n$$\n$$\nT_{1}(\\exp(\\mathrm{j}\\omega)) = H_{0}(\\exp(\\mathrm{j}\\omega))H_{1}(\\exp(\\mathrm{j}\\omega))\n$$\n最后，我们代入 $H_{0}$ 和 $H_{1}$ 的显式形式：\n$$\nT_{1}(\\exp(\\mathrm{j}\\omega)) = (1+\\exp(-\\mathrm{j}\\omega))(1-\\exp(-\\mathrm{j}\\omega))\n$$\n使用平方差公式 $(a+b)(a-b) = a^2 - b^2$：\n$$\nT_{1}(\\exp(\\mathrm{j}\\omega)) = 1^{2} - (\\exp(-\\mathrm{j}\\omega))^{2} = 1 - \\exp(-2\\mathrm{j}\\omega)\n$$\n这就是混叠传递函数的闭式解析表达式。由于该函数不恒等于零，因此混叠未被消除，这对于此综合滤波器的选择是预期的结果。频率变量 $\\omega$ 的单位是弧度。", "answer": "$$\n\\boxed{1 - \\exp(-2\\mathrm{j}\\omega)}\n$$", "id": "2915706"}, {"introduction": "理论通过实践才得以彰显其生命力。本实践将视角从代数推导转向动手编程，向您介绍用于构建完美重构滤波器组的高效结构——提升方案（lifting scheme）。您将使用一系列简单的“预测”和“更新”步骤，实现经典的 Haar 滤波器组，它是一种共轭正交滤波器（CQF）。最终目标是利用您构建的分析-综合系统处理一个测试信号，并从数值上验证其混叠传递函数 $T_1(e^{j\\omega})$ 在机器精度范围内确实为零，从而在计算环境中证实理论的预测 [@problem_id:2915687]。", "problem": "你需要实现一个使用两阶段提升方案的双通道共轭正交滤波器（CQF）组，并通过估计一组测试正弦波的混叠传递函数 $T_1(e^{j\\omega})$ 来验证数值上的混叠消除。\n\n目标是从临界采样双通道滤波器组的基本多相和调制框架出发进行论证，并验证对于一个正确设计的 CQF，混叠被消除，即 $T_1(e^{j\\omega}) = 0$。\n\n从以下基本事实开始：\n\n1. 在一个临界采样的双通道分析-综合系统中，频域中的整体输入-输出关系可以写为\n$$\nY\\left(e^{j\\omega}\\right) = \\frac{1}{2}\\left[T_0\\left(e^{j\\omega}\\right) X\\left(e^{j\\omega}\\right) + T_1\\left(e^{j\\omega}\\right) X\\left(e^{j(\\omega+\\pi)}\\right)\\right],\n$$\n其中 $X\\left(e^{j\\omega}\\right)$ 和 $Y\\left(e^{j\\omega}\\right)$ 分别是输入和重构输出信号的离散时间傅里叶变换。函数 $T_0\\left(e^{j\\omega}\\right)$ 是失真传递函数，而 $T_1\\left(e^{j\\omega}\\right)$ 是混叠传递函数。\n\n2. 对于一个具有完美重构特性的共轭正交滤波器（CQF）对，$T_1\\left(e^{j\\omega}\\right) = 0$ 对所有 $\\omega$ 成立，且 $T_0\\left(e^{j\\omega}\\right)$ 等于一个纯延迟（可能带有一个恒定增益）。一个充分的 CQF 条件是 $G_0(z) = H_0(z)$，$G_1(z) = -H_1(z)$，以及对于某个整数延迟 $k$，$H_1(z) = z^{-k} H_0(-z)$。\n\n3. 在双通道滤波器组的提升框架中，一个预测步后跟一个更新步构成一个两阶段提升方案。将输入 $x[n]$ 进行奇偶分裂成 $s[k] = x[2k]$（偶数样本）和 $d[k] = x[2k+1]$（奇数样本），一个预测系数 $p$ 和一个更新系数 $u$ 通过以下方式定义分析过程\n$$\nd \\leftarrow d - p \\, s, \\quad s \\leftarrow s + u \\, d,\n$$\n可以选择性地后跟一个对角缩放（在本问题中你必须将缩放系数设为 1）。综合过程精确地反转这两个步骤：\n$$\ns \\leftarrow s - u \\, d, \\quad d \\leftarrow d + p \\, s,\n$$\n然后交织 $s$ 和 $d$ 以重构输出。\n\n你的具体任务是：\n\n1. 实现两阶段提升方案，通过选择预测系数 $p = 1$ 和更新系数 $u = \\tfrac{1}{2}$，以及单位缩放系数 $\\kappa = 1$，来构造 Haar CQF 滤波器组。通过奇偶分裂、一个预测步和一个更新步执行分析；通过逆更新和逆预测，然后交织奇偶部分以获得重构输出来执行综合。\n\n2. 使用此分析-综合链来处理形式为 $x[n] = e^{j \\omega n}$ 的复值正弦测试信号，其中固定的角频率 $\\omega$ 以弧度表示。因为临界采样的双通道系统是周期为 2 的线性周期时变系统，你可以假设输出具有以下形式\n$$\ny[n] = \\frac{1}{2}\\left(T_0\\left(e^{j\\omega}\\right) e^{j\\omega n} + T_1\\left(e^{j\\omega}\\right) (-1)^n e^{j\\omega n}\\right).\n$$\n\n3. 对于给定的 $\\omega$，通过将 $y[n]$ 投影到 $e^{j\\omega n}$ 和 $(-1)^n e^{j\\omega n}$ 上，来数值估计混叠传递函数 $T_1\\left(e^{j\\omega}\\right)$。具体来说，定义\n$$\nc_1(\\omega) \\triangleq \\frac{1}{N} \\sum_{n=0}^{N-1} y[n] \\, e^{-j \\omega n} \\, (-1)^n,\n$$\n对于一个长度为 $N$ 的偶数长度信号。对于偶数 $N$，有 $\\frac{1}{N}\\sum_{n=0}^{N-1} (-1)^n = 0$，由此可得 $c_1(\\omega) = \\tfrac{1}{2} T_1\\left(e^{j\\omega}\\right)$。因此，你可以估计\n$$\n\\widehat{T}_1\\left(e^{j\\omega}\\right) = 2 \\, c_1(\\omega).\n$$\n对每个测试频率使用此估计器。\n\n4. 通过检查 $\\left|\\widehat{T}_1\\left(e^{j\\omega}\\right)\\right|$ 是否低于指定的容差 $\\epsilon$ 来数值验证 $T_1\\left(e^{j\\omega}\\right) = 0$。\n\n实现要求：\n\n- 使用周期性复指数信号 $x[n] = e^{j \\omega n}$ 作为测试信号，其中 $\\omega$ 以弧度为单位。不涉及物理单位，但你必须将角度视为弧度。\n- 使用偶数信号长度 $N = 4096$。\n- 使用预测系数 $p = 1$，更新系数 $u = \\tfrac{1}{2}$，以及缩放系数 $\\kappa = 1$。\n- 使用数值容差 $\\epsilon = 10^{-10}$。\n\n测试套件：\n\n- 使用以下角频率，均以弧度为单位：$\\omega_1 = 0$, $\\omega_2 = \\tfrac{\\pi}{2}$ 和 $\\omega_3 = \\pi - 10^{-2}$。\n- 对于每个 $\\omega_i$，计算 $\\widehat{T}_1\\left(e^{j\\omega_i}\\right)$ 并检验是否 $\\left|\\widehat{T}_1\\left(e^{j\\omega_i}\\right)\\right|  \\epsilon$。\n\n最终输出格式：\n\n- 你的程序应生成单行输出，其中包含三个布尔值结果（按 $\\omega_1$、$\\omega_2$、$\\omega_3$ 的顺序），形式为用方括号括起来的逗号分隔列表。例如，一个可接受的格式是 $[\\text{True},\\text{False},\\text{True}]$。\n- 不应产生任何其他输出。", "solution": "所提出的问题是验证一个特定的双通道共轭正交滤波器（CQF）组（即通过两阶段提升方案实现的 Haar 滤波器组）的混叠消除特性。这项任务在科学上是合理的、适定的，并基于多速率信号处理的基本原理。所提供的参数和方法是完整且一致的。我们将着手进行形式化的解答。\n\n问题的核心在于临界采样双通道滤波器组的分析-综合结构。提升方案通过对输入信号的多相分量进行操作，为这类滤波器组提供了一种高效的实现方式。\n\n首先，我们对提升操作进行形式化描述。设输入信号为 $x[n]$。其多相表示由偶数索引分量 $s_0[k] = x[2k]$ 和奇数索引分量 $d_0[k] = x[2k+1]$ 组成。\n\n分析阶段将多相分量 $(s_0, d_0)$ 转换为子带分量 $(s_1, d_1)$，它由一系列预测和更新步骤描述。\n1.  **预测步**：根据偶数分量 $s_0[k]$ 形成对奇数分量 $d_0[k]$ 的预测。预测误差构成了高通子带信号 $d_1[k]$。使用给定的预测系数 $p=1$，此操作为：\n    $$\n    d_1[k] = d_0[k] - p \\cdot s_0[k] = d_0[k] - s_0[k]\n    $$\n2.  **更新步**：使用新计算的高通信号 $d_1[k]$ 更新偶数分量 $s_0[k]$，以生成低通子带信号 $s_1[k]$。此步骤旨在保留低通通道中的某些信号特性，例如局部均值。使用更新系数 $u = \\frac{1}{2}$，我们有：\n    $$\n    s_1[k] = s_0[k] + u \\cdot d_1[k] = s_0[k] + \\frac{1}{2} d_1[k]\n    $$\n问题指定了单位缩放因子 $\\kappa=1$，因此不需要对 $s_1[k]$ 和 $d_1[k]$ 进行进一步操作。\n\n综合阶段反转这些操作，以完美重构原始信号。\n1.  **逆更新**：从子带信号 $(s_1, d_1)$ 中恢复原始偶数分量 $s_0[k]$：\n    $$\n    s_{0}^{\\text{rec}}[k] = s_1[k] - u \\cdot d_1[k] = s_1[k] - \\frac{1}{2} d_1[k]\n    $$\n    验证表明此步骤确实是可逆的：$(s_0[k] + \\frac{1}{2} d_1[k]) - \\frac{1}{2} d_1[k] = s_0[k]$。\n2.  **逆预测**：使用高通信号 $d_1[k]$ 和已恢复的偶数分量 $s_{0}^{\\text{rec}}[k]$ 来恢复原始奇数分量 $d_0[k]$：\n    $$\n    d_{0}^{\\text{rec}}[k] = d_1[k] + p \\cdot s_{0}^{\\text{rec}}[k] = d_1[k] + s_{0}^{\\text{rec}}[k]\n    $$\n    验证证实了这一点：$(d_0[k] - s_0[k]) + s_0[k] = d_0[k]$。\n\n重构信号 $y[n]$ 是通过交织恢复的多相分量而形成的：$y[2k] = s_{0}^{\\text{rec}}[k]$ 和 $y[2k+1] = d_{0}^{\\text{rec}}[k]$。由于所有步骤都是完全可逆的，在没有数值误差的情况下，我们期望 $y[n] = x[n]$。\n\n问题要求我们验证混叠传递函数 $T_1(e^{j\\omega})$ 为零。对于正弦输入 $x[n] = e^{j\\omega n}$，一个通用的双通道系统的输出由下式给出：\n$$\ny[n] = \\frac{1}{2}\\left(T_0\\left(e^{j\\omega}\\right) e^{j\\omega n} + T_1\\left(e^{j\\omega}\\right) (-1)^n e^{j\\omega n}\\right)\n$$\n为了估计 $T_1(e^{j\\omega})$，我们使用所提供的估计器，该估计器是根据复指数在偶数长度区间 $N$ 上的正交性推导出来的：\n$$\n\\widehat{T}_1(e^{j\\omega}) = \\frac{2}{N} \\sum_{n=0}^{N-1} y[n] e^{-j\\omega n} (-1)^n\n$$\n如果对于小的容差 $\\epsilon = 10^{-10}$，满足 $|\\widehat{T}_1(e^{j\\omega})|  \\epsilon$，则数值上验证了混叠消除。\n\n对于每个测试频率 $\\omega_i$ 的步骤如下：\n1. 生成长度为 $N=4096$ 的复正弦输入信号向量 $x$，其中 $x[n] = e^{j\\omega_i n}$。\n2. 通过将 $x$ 分裂为奇偶部分，然后应用预测步（$p=1$）和更新步（$u=0.5$）来执行分析阶段。\n3. 通过应用逆更新和逆预测步骤，然后交织结果以获得输出信号 $y$ 来执行综合阶段。\n4. 使用信号 $y$ 和提供的公式计算估计值 $\\widehat{T}_1(e^{j\\omega_i})$。\n5. 将估计值的绝对值与容差 $\\epsilon$ 进行比较，以确定布尔结果。\n\n将对三个指定的角频率：$\\omega_1 = 0$、$\\omega_2 = \\frac{\\pi}{2}$ 和 $\\omega_3 = \\pi - 10^{-2}$ 实施这整个过程。理论上预期混叠会被完美消除，因此任何计算出的 $\\widehat{T}_1$ 值都将完全由浮点算术误差引起，并且应该远低于容差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a two-channel CQF bank via a two-stage lifting scheme\n    to verify numerical aliasing cancellation.\n    \"\"\"\n    \n    # Define problem parameters\n    N = 4096  # Signal length (must be even)\n    p = 1.0   # Predictor coefficient\n    u = 0.5   # Updater coefficient\n    epsilon = 1e-10  # Numerical tolerance for aliasing cancellation\n\n    # Define the test suite of angular frequencies in radians\n    test_omegas = [\n        0.0,\n        np.pi / 2.0,\n        np.pi - 1e-2\n    ]\n\n    results = []\n\n    for omega in test_omegas:\n        # 1. Generate the complex sinusoidal input signal\n        n = np.arange(N)\n        x = np.exp(1j * omega * n)\n\n        # 2. Analysis stage (Lifting)\n        # Even-odd split (polyphase decomposition)\n        s0 = x[0::2]\n        d0 = x[1::2]\n\n        # Predict step\n        d1 = d0 - p * s0\n        \n        # Update step\n        s1 = s0 + u * d1\n\n        # The subband signals are s1 (low-pass) and d1 (high-pass).\n\n        # 3. Synthesis stage (Inverse Lifting)\n        # Inverse update step\n        s0_rec = s1 - u * d1\n        \n        # Inverse predict step\n        d0_rec = d1 + p * s0_rec\n\n        # Interleave to reconstruct the output signal\n        y = np.empty_like(x, dtype=np.complex128)\n        y[0::2] = s0_rec\n        y[1::2] = d0_rec\n        \n        # 4. Estimate the alias transfer function T1(e^jω)\n        # The estimator is T1_hat = 2 * c1(ω), where\n        # c1(ω) = (1/N) * sum_{n=0}^{N-1} y[n] * e^{-jωn} * (-1)^n\n        \n        # Create the modulation term (-1)^n\n        mod_signal = np.power(-1.0, n)\n        \n        # Create the analysis sinusoid e^{-jωn}\n        analysis_signal = np.exp(-1j * omega * n) # or np.conj(x)\n        \n        # Compute c1(ω)\n        c1 = (1.0 / N) * np.sum(y * analysis_signal * mod_signal)\n        \n        # Compute the estimate of T1\n        T1_est = 2.0 * c1\n        \n        # 5. Verify aliasing cancellation\n        # Check if the magnitude of the estimated alias transfer function\n        # is below the specified tolerance.\n        is_cancelled = np.abs(T1_est)  epsilon\n        results.append(is_cancelled)\n\n    # Format the final output as a comma-separated list of booleans\n    # enclosed in square brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str.replace(\"True\", \"True\").replace(\"False\", \"False\"))\n\nsolve()\n```", "id": "2915687"}]}