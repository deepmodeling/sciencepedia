{"hands_on_practices": [{"introduction": "理想的“砖墙”滤波器在现实中无法实现。实际的滤波器具有有限的阻带衰减，这会导致信道间的能量泄漏，并在信号重构时引入混叠失真。本练习提供了一个简化但功能强大的分析模型，用于量化这些非理想效应，特别是计算混叠信号功率比 ($ASR$)。通过这个实践，你将深刻理解为何阻带衰减是滤波器组设计中的一个关键性能指标。", "problem": "考虑一个通过对单个实数、线性相位的原型分析低通滤波器进行复调制而构建的临界采样均匀离散傅里叶变换 (DFT) $M$ 通道分析-综合滤波器组，该原型滤波器的离散时间频率响应为 $H_{0}(\\exp(j\\omega))$。第 $k$ 个分析滤波器为 $H_{k}(\\exp(j\\omega)) = H_{0}(\\exp(j(\\omega - 2\\pi k/M)))$，相应的综合滤波器取为 $G_{k}(\\exp(j\\omega)) = H_{k}^{\\ast}(\\exp(j\\omega))$，其后对综合和施加一个全局实数标量增益 $\\beta$。每个分析支路的输出被降采样 $M$ 倍，每个综合支路的输入被升采样 $M$ 倍。所有角频率的单位均为弧度/样本。\n\n假设原型幅频响应是分段常数且严格 $2\\pi$ 周期的：\n- 对于 $|\\omega| \\le \\pi/M$，$|H_{0}(\\exp(j\\omega))| = 1$\n- 对于 $\\pi/M < |\\omega| \\le \\pi$，$|H_{0}(\\exp(j\\omega))| = \\alpha$\n其中 $0 < \\alpha \\ll 1$。因此，每个调制后的分析滤波器 $H_{k}(\\exp(j\\omega))$ 都有一个宽度为 $2\\pi/M$、中心位于 $\\omega = 2\\pi k/M$ 的通带，在其自身的通带内幅度为单位1，而在其他地方幅度为 $\\alpha$。\n\n设输入 $x[n]$ 为零均值、广义平稳的白噪声，其双边功率谱密度对于所有 $\\omega \\in [-\\pi, \\pi)$ 均为 $S_{x}(\\omega) = \\sigma_{x}^{2}$。\n\n您将分析由于有限阻带导致的相邻通道间的泄露，并预测重建输出中存在的净混叠污染。\n\n任务：\n1) 仅使用上述定义以及以下事实：线性时不变滤波器在某一频率区域内从白噪声输入通过的功率等于该区域上幅度平方响应的积分乘以 $\\sigma_{x}^{2}$。计算从第 $(k+1)$ 个通道的通带泄露到第 $k$ 个分析支路的功率。将此泄露表示为相邻幅频响应重叠部分的积分，并以闭合形式求值。\n\n2) 从多速率信号处理的基本原理出发，即降采样和升采样的精确离散时间傅里叶变换关系：\n- 如果 $v[n] \\xrightarrow{\\mathcal{F}} V(\\omega)$ 且 $d[n] = v[nM]$，则 $D(\\omega) = \\frac{1}{M} \\sum_{r=0}^{M-1} V\\!\\left(\\frac{\\omega - 2\\pi r}{M}\\right)$,\n- 如果 $u[n]$ 是通过对 $d[n]$ 进行 $M$ 倍升采样得到的，则 $U(\\omega) = D(M\\omega)$,\n推导出重建输出谱 $Y(\\omega)$，其形式为\n$$\nY(\\omega) = \\sum_{r=0}^{M-1} T_{r}(\\omega)\\, X\\!\\left(\\omega - \\frac{2\\pi r}{M}\\right),\n$$\n并用 $\\{H_{k}(\\exp(j\\omega))\\}$ 和 $\\{G_{k}(\\exp(j\\omega))\\}$ 明确指出混叠传递函数 $T_{r}(\\omega)$。\n\n3) 在所述的幅度模型下，对于位于任何分析通带内的 $\\omega$，将 $T_{0}(\\omega)$ 以及 $r \\neq 0$ 时的 $T_{r}(\\omega)$ 近似为常数（在通带内与 $\\omega$ 无关），并用 $M$ 和 $\\alpha$ 将它们表示为闭合形式。然后，选择综合标量增益 $\\beta$，使得期望的（非混叠）项等于1，即在通带内 $\\beta\\, T_{0}(\\omega) = 1$。\n\n4) 将重建输出端的总混叠信号功率比 ($\\mathrm{ASR}$) 定义为\n$$\n\\mathrm{ASR} \\triangleq \\frac{\\sum_{r=1}^{M-1} \\left|\\beta\\, T_{r}\\right|^{2}\\, \\sigma_{x}^{2}}{\\left|\\beta\\, T_{0}\\right|^{2}\\, \\sigma_{x}^{2}},\n$$\n在所采用的近似下，该比率与 $\\omega$ 和 $\\sigma_{x}^{2}$ 无关。推导 $\\mathrm{ASR}$ 仅作为 $M$ 和 $\\alpha$ 的函数的单一闭合形式解析表达式。将此单一解析表达式作为您的最终结果提供。无需进行数值代入，且 $\\mathrm{ASR}$ 没有单位。", "solution": "所述问题具有科学依据，提法恰当，客观，并包含足够信息以得到唯一解。这是多速率滤波器组分析中的一个标准练习。我将开始解答。\n\n该问题分为四个连续的任务。我将依次解答每个任务，并以前一个任务的结果为基础。每个数学符号、变量、函数和数字都将按要求使用 LaTeX 格式。\n\n首先，我们计算从第 $(k+1)$ 个通道的通带泄露到第 $k$ 个分析支路的功率。分析滤波器是通过对原型低通滤波器 $H_{0}(\\exp(j\\omega))$ 进行复调制定义的，即 $H_{k}(\\exp(j\\omega)) = H_{0}(\\exp(j(\\omega - 2\\pi k/M)))$。原型滤波器 $H_{0}(\\exp(j\\omega))$ 的通带给定的频率范围是 $|\\omega| \\le \\pi/M$。因此，第 $(k+1)$ 个分析滤波器 $H_{k+1}(\\exp(j\\omega))$ 的通带是满足 $|\\omega - 2\\pi(k+1)/M| \\le \\pi/M$ 的频率 $\\omega$ 的集合。这定义了区间 $\\omega \\in [\\frac{2\\pi(k+1)}{M} - \\frac{\\pi}{M}, \\frac{2\\pi(k+1)}{M} + \\frac{\\pi}{M}]$，可化简为 $[\\frac{\\pi(2k+1)}{M}, \\frac{\\pi(2k+3)}{M}]$。\n\n问题将滤波器在某一频率区域上从白噪声输入通过的功率定义为该区域上幅度平方响应的积分，再乘以输入功率谱密度 $\\sigma_{x}^{2}$。我们被要求计算从通道 $k+1$ 的通带中被通道 $k$ 的滤波器通过的功率。这个泄露功率，记为 $P_{\\text{leak}}$，因此由以下积分给出：\n$$\nP_{\\text{leak}} = \\sigma_{x}^{2} \\int_{\\frac{\\pi(2k+1)}{M}}^{\\frac{\\pi(2k+3)}{M}} \\left|H_{k}(\\exp(j\\omega))\\right|^{2} d\\omega\n$$\n为了计算该积分，我们必须确定被积函数 $|H_{k}(\\exp(j\\omega))|^2$ 在积分区间上的值。我们代入 $H_{k}(\\exp(j\\omega))$ 的定义：\n$$\n|H_{k}(\\exp(j\\omega))|^2 = |H_{0}(\\exp(j(\\omega - 2\\pi k/M)))|^2\n$$\n让我们进行变量替换，令 $\\omega' = \\omega - 2\\pi k/M$。当 $\\omega$ 遍历积分区间 $[\\frac{\\pi(2k+1)}{M}, \\frac{\\pi(2k+3)}{M}]$ 时，新变量 $\\omega'$ 遍历区间 $[\\frac{\\pi}{M}, \\frac{3\\pi}{M}]$。原型幅频响应给定为对于 $\\pi/M < |\\omega'| \\le \\pi$ 有 $|H_{0}(\\exp(j\\omega'))| = \\alpha$。对于任何合理的通道数，例如 $M \\ge 3$，区间 $[\\pi/M, 3\\pi/M]$ 是 $|\\omega'| \\le \\pi$ 区域的子集。因此，对于此区间中的任何 $\\omega'$，都有 $|H_{0}(\\exp(j\\omega'))| = \\alpha$。因此，被积函数在整个积分域上是常数 $|H_{k}(\\exp(j\\omega))|^2 = \\alpha^2$。\n\n积分变得十分简单：\n$$\nP_{\\text{leak}} = \\sigma_{x}^{2} \\int_{\\frac{\\pi(2k+1)}{M}}^{\\frac{\\pi(2k+3)}{M}} \\alpha^2 d\\omega = \\sigma_{x}^{2} \\alpha^2 \\left( \\frac{\\pi(2k+3)}{M} - \\frac{\\pi(2k+1)}{M} \\right)\n$$\n计算积分限得到区间宽度为 $2\\pi/M$。因此泄露功率为：\n$$\nP_{\\text{leak}} = \\sigma_{x}^{2} \\alpha^2 \\frac{2\\pi}{M}\n$$\n\n其次，我们推导重建输出谱 $Y(\\omega)$ 的表达式。过程如下：\n1. 输入信号 $x[n]$（其频谱为 $X(\\omega)$）被 $M$ 个分析滤波器中的每一个进行滤波。第 $k$ 个滤波器的输出为 $v_k[n]$，其频谱为 $V_k(\\omega) = X(\\omega)H_k(\\exp(j\\omega))$。\n2. 每个 $v_k[n]$ 被降采样 $M$ 倍以产生 $d_k[n] = v_k[nM]$。使用所提供的恒等式，其频谱为 $D_k(\\omega) = \\frac{1}{M} \\sum_{r=0}^{M-1} V_k\\left(\\frac{\\omega - 2\\pi r}{M}\\right)$。\n3. 每个 $d_k[n]$ 被升采样 $M$ 倍以产生 $u_k[n]$。其频谱为 $U_k(\\omega) = D_k(M\\omega)$。代入前面步骤的表达式：\n$$\nU_k(\\omega) = \\frac{1}{M} \\sum_{r=0}^{M-1} V_k\\left(\\frac{M\\omega - 2\\pi r}{M}\\right) = \\frac{1}{M} \\sum_{r=0}^{M-1} X\\left(\\omega - \\frac{2\\pi r}{M}\\right) H_k\\left(\\exp\\left(j\\left(\\omega - \\frac{2\\pi r}{M}\\right)\\right)\\right)\n$$\n4. 每个 $u_k[n]$ 被综合滤波器 $G_k(\\exp(j\\omega))$ 滤波。得到的频谱为 $Y_k(\\omega) = U_k(\\omega)G_k(\\exp(j\\omega))$。\n5. 最终输出 $y[n]$ 是所有综合滤波器输出的和，再乘以一个增益 $\\beta$：$Y(\\omega) = \\beta \\sum_{k=0}^{M-1} Y_k(\\omega)$。\n合并这些步骤得到：\n$$\nY(\\omega) = \\beta \\sum_{k=0}^{M-1} G_k(\\exp(j\\omega)) \\left[ \\frac{1}{M} \\sum_{r=0}^{M-1} X\\left(\\omega - \\frac{2\\pi r}{M}\\right) H_k\\left(\\exp\\left(j\\left(\\omega - \\frac{2\\pi r}{M}\\right)\\right)\\right) \\right]\n$$\n为了匹配所需的形式，我们交换求和顺序：\n$$\nY(\\omega) = \\sum_{r=0}^{M-1} \\left[ \\frac{\\beta}{M} \\sum_{k=0}^{M-1} G_k(\\exp(j\\omega)) H_k\\left(\\exp\\left(j\\left(\\omega - \\frac{2\\pi r}{M}\\right)\\right)\\right) \\right] X\\left(\\omega - \\frac{2\\pi r}{M}\\right)\n$$\n由此，我们识别出总传递函数 $T_r(\\omega)$（根据结构，它包含 $\\beta$，虽然第3部分的问题对此稍有重新定义）。为了与第3部分的措辞保持一致，我们定义不含 $\\beta$ 的 $T_r(\\omega)$：\n$$\nT_r(\\omega) = \\frac{1}{M} \\sum_{k=0}^{M-1} G_k(\\exp(j\\omega)) H_k\\left(\\exp\\left(j\\left(\\omega - \\frac{2\\pi r}{M}\\right)\\right)\\right)\n$$\n这样 $Y(\\omega) = \\beta \\sum_{r=0}^{M-1} T_r(\\omega) X(\\omega - \\frac{2\\pi r}{M})$。\n\n第三，我们将 $T_r(\\omega)$ 在通带内（特别是 $|\\omega| \\le \\pi/M$）近似为常数。综合滤波器为 $G_k(\\exp(j\\omega)) = H_k^*(\\exp(j\\omega))$。\n对于 $r=0$，函数 $T_0(\\omega)$ 是失真传递函数：\n$$\nT_0(\\omega) = \\frac{1}{M} \\sum_{k=0}^{M-1} G_k(\\exp(j\\omega)) H_k(\\exp(j\\omega)) = \\frac{1}{M} \\sum_{k=0}^{M-1} |H_k(\\exp(j\\omega))|^2\n$$\n对于 $|\\omega| \\le \\pi/M$：\n- $k=0$ 的项是 $|H_0(\\exp(j\\omega))|^2 = 1^2 = 1$。\n- 对于 $k \\in \\{1, \\dots, M-1\\}$，原型滤波器的自变量是 $\\omega - 2\\pi k/M$。其大小位于 $[\\frac{(2k-1)\\pi}{M}, \\frac{(2k+1)\\pi}{M}]$，该区域在阻带内。因此，$|H_k(\\exp(j\\omega))|^2 = \\alpha^2$。\n因此，和在这个频带内是常数：\n$$\nT_0 = \\frac{1}{M} (1 + (M-1)\\alpha^2)\n$$\n对于 $r \\neq 0$，$T_r(\\omega)$ 是混叠传递函数。利用 $h_0[n]$ 的线性相位特性，$H_0(\\exp(j\\theta)) = |H_0(\\exp(j\\theta))|\\exp(-j\\theta t_g)$，$T_r(\\omega)$ 的求和内部的乘积包含一个相位项，可化简为 $\\exp(j \\frac{2\\pi r t_g}{M})$。\n$$\nT_r(\\omega) = \\frac{1}{M} \\exp(j \\frac{2\\pi r t_g}{M}) \\sum_{k=0}^{M-1} |H_0(\\exp(j(\\omega-\\frac{2\\pi k}{M})))| |H_0(\\exp(j(\\omega-\\frac{2\\pi(k+r)}{M})))|\n$$\n对于 $|\\omega| \\le \\pi/M$，我们分析每个 $k$ 的幅度乘积：\n- 当 $k=0$ 时，乘积为 $|H_0(\\exp(j\\omega))| \\cdot |H_0(\\exp(j(\\omega-\\frac{2\\pi r}{M})))| = 1 \\cdot \\alpha = \\alpha$。\n- 来自第二项 $|H_0(\\exp(j(\\omega-\\frac{2\\pi(k+r)}{M})))|$ 的通带贡献发生在 $k+r$ 是 $M$ 的倍数时。给定 $k \\in \\{0, \\dots, M-1\\}$ 和 $r \\in \\{1, \\dots, M-1\\}$，这种情况只在 $k = M-r$ 时发生。对于这个 $k$ 值，乘积为 $|H_0(\\exp(j(\\omega-\\frac{2\\pi(M-r)}{M})))| \\cdot |H_0(\\exp(j(\\omega-2\\pi)))| = \\alpha \\cdot 1 = \\alpha$。\n- 对于所有其他 $M-2$ 个 $k$ 值，两个自变量都落在阻带内，所以乘积为 $\\alpha \\cdot \\alpha = \\alpha^2$。\n和是常数：$2\\alpha + (M-2)\\alpha^2$。\n$$\nT_r = \\frac{1}{M} \\exp(j \\frac{2\\pi r t_g}{M}) (2\\alpha + (M-2)\\alpha^2) \\quad \\text{对于 } r \\neq 0\n$$\n选择增益 $\\beta$ 以使总失真项为1：$\\beta T_0 = 1$。\n$$\n\\beta = \\frac{1}{T_0} = \\frac{M}{1 + (M-1)\\alpha^2}\n$$\n\n第四，我们推导混叠信号功率比（ASR）。定义是：\n$$\n\\mathrm{ASR} \\triangleq \\frac{\\sum_{r=1}^{M-1} \\left|\\beta\\, T_{r}\\right|^{2}\\, \\sigma_{x}^{2}}{\\left|\\beta\\, T_{0}\\right|^{2}\\, \\sigma_{x}^{2}}\n$$\n根据我们对 $\\beta$ 的选择，分母是 $1^2 \\cdot \\sigma_x^2 = \\sigma_x^2$。$\\sigma_x^2$ 项约去。\n$$\n\\mathrm{ASR} = \\frac{\\sum_{r=1}^{M-1} |\\beta T_r|^2}{|\\beta T_0|^2} = \\sum_{r=1}^{M-1} |\\beta T_r|^2\n$$\n我们计算 $r \\neq 0$ 时的 $|\\beta T_r|$：\n$$\n|\\beta T_r| = |\\beta| \\cdot |T_r| = \\frac{M}{1 + (M-1)\\alpha^2} \\cdot \\left| \\frac{1}{M} \\exp(j \\frac{2\\pi r t_g}{M}) (2\\alpha + (M-2)\\alpha^2) \\right|\n$$\n指数项的幅度为1。因为 $\\alpha > 0$ 且 $M \\ge 2$，所以 $(2\\alpha + (M-2)\\alpha^2)$ 是正的。\n$$\n|\\beta T_r| = \\frac{M}{1 + (M-1)\\alpha^2} \\cdot \\frac{1}{M} (2\\alpha + (M-2)\\alpha^2) = \\frac{2\\alpha + (M-2)\\alpha^2}{1 + (M-1)\\alpha^2}\n$$\n该值与混叠指数 $r$ 无关。ASR表达式中的和由 $M-1$ 个相同的项组成：\n$$\n\\mathrm{ASR} = \\sum_{r=1}^{M-1} \\left( \\frac{2\\alpha + (M-2)\\alpha^2}{1 + (M-1)\\alpha^2} \\right)^2\n$$\n这给出了ASR的最终闭合形式表达式：\n$$\n\\mathrm{ASR} = (M-1) \\left( \\frac{2\\alpha + (M-2)\\alpha^2}{1 + (M-1)\\alpha^2} \\right)^2\n$$\n该表达式只依赖于通道数 $M$ 和阻带衰减因子 $\\alpha$，符合要求。", "answer": "$$\\boxed{(M-1) \\left( \\frac{2\\alpha + (M-2)\\alpha^2}{1 + (M-1)\\alpha^2} \\right)^2}$$", "id": "2881813"}, {"introduction": "在理解了泄漏的重要性之后，下一个实践步骤就是设计一个能有效控制它的滤波器。本练习将指导你完成一个标准且高效的设计流程：使用Kaiser窗方法设计一个FIR原型滤波器，以达到特定的邻道泄漏指标。你将亲手实现这一设计，并验证所设计的滤波器是否满足 $60$ dB的衰减目标，从而将理论设计参数与具体的性能指标联系起来。", "problem": "您的任务是设计并验证一个具有$M=32$个通道的均匀离散傅里叶变换 (DFT) 分析滤波器组，该滤波器组使用一个调制低通原型。设计目标是实现约$60$分贝 (dB) 的邻道泄漏，该指标通过一个根据分析滤波器计算的明确定义的隔离度量来量化。您必须实现一个独立的程序，该程序使用Kaiser窗加权的理想低通滤波器来设计原型，并为一组给定的原型长度测试套件计算指定的通道隔离度量。\n\n定义与基本原理：\n- 考虑一个均匀的$M$通道DFT分析滤波器组，其分析滤波器 $\\{H_k(e^{j\\omega})\\}_{k=0}^{M-1}$ 是通过对一个实数低通原型 $H_0(e^{j\\omega})$进行复调制得到的：\n  $$H_k(e^{j\\omega}) = H_0\\!\\left(e^{j(\\omega - 2\\pi k/M)}\\right),\\quad k=0,1,\\dots,M-1.$$\n- 通道中心频率为 $\\omega_k = \\frac{2\\pi k}{M}$ (弧度)。\n- 原型 $h[n]$ 是一个长度为 $L=K M$ 的有限冲激响应 (FIR) 滤波器，其中 $K$ 是一个正整数。它被设计为一个Kaiser窗加权的理想低通滤波器，其截止频率为\n  $$\\omega_c = \\frac{\\pi}{M},$$\n  其过渡带设计意图由通带边缘 $\\omega_p = \\frac{3\\pi}{4M}$ 和阻带边缘 $\\omega_s = \\frac{5\\pi}{4M}$ (弧度) 指导，因此名义上的过渡带宽为\n  $$\\Delta\\omega = \\omega_s - \\omega_p = \\frac{\\pi}{2M}.$$\n  对于所需旁瓣衰减 $A$ (单位为dB)，Kaiser窗参数 $\\beta$ 满足广泛使用的经验关系式\n  $$\\beta =\n  \\begin{cases}\n  0, & A \\le 21,\\\\\n  0.5842\\,(A-21)^{0.4} + 0.07886\\,(A-21), & 21 < A \\le 50,\\\\\n  0.1102\\,(A-8.7), & A > 50,\n  \\end{cases}$$\n  对于 $A=60$ dB，此公式可得出一个固定的 $\\beta$ 值。\n- 长度为 $L$、截止频率为 $\\omega_c$ 的理想低通原型（加窗前）的离散时间冲激响应为\n  $$h_d[n] = \\frac{\\omega_c}{\\pi}\\,\\mathrm{sinc}\\!\\left(\\frac{\\omega_c}{\\pi}\\left(n - \\frac{L-1}{2}\\right)\\right),\\quad n=0,1,\\dots,L-1,$$\n  其中 $\\mathrm{sinc}(x) = \\frac{\\sin(\\pi x)}{\\pi x}$ 且 $\\mathrm{sinc}(0)=1$。加窗后的原型为 $h[n] = h_d[n]\\,w[n]$，其中 $w[n]$是长度为 $L$ 的Kaiser窗。将 $h[n]$归一化，使得\n  $$H_0(e^{j0}) = \\sum_{n=0}^{L-1} h[n] = 1,$$\n  以确保每个调制后通带的中心具有单位增益。\n\n需要计算的隔离度量：\n- 将分析滤波器组的邻道泄漏 (ACL) 定义为所有通道中，邻近通道中心频率处的幅度响应与本通道中心频率处的幅度响应之比的最大值：\n  $$\\mathrm{ACL} = 20\\log_{10}\\Bigg(\\max_{k\\in\\{0,\\dots,M-1\\}} \\frac{\\left|H_k\\!\\left(e^{j\\omega_{k\\pm 1}}\\right)\\right|}{\\left|H_k\\!\\left(e^{j\\omega_k}\\right)\\right|}\\Bigg).$$\n- 对于均匀调制的滤波器组，这可以简化为基于原型的评估：\n  $$\\mathrm{ACL} = 20\\log_{10}\\left(\\frac{\\left|H_0\\!\\left(e^{j\\frac{2\\pi}{M}}\\right)\\right|}{\\left|H_0\\!\\left(e^{j0}\\right)\\right|}\\right),$$\n  因为 $H_k(e^{j\\omega_{k\\pm1}})=H_0(e^{\\pm j\\frac{2\\pi}{M}})$ 且 $H_k(e^{j\\omega_k})=H_0(e^{j0})$。\n\n您的任务：\n1. 对固定的 $M=32$，实现上述原型设计，其中Kaiser窗参数根据 $A=60$ dB的目标衰减推导得出。\n2. 对于每个给定的 $K$，构建长度为 $L=K\\,M$ 的 $h[n]$，将其在 $\\omega=0$ 处的增益归一化为1，并使用上述基于原型的恒等式计算邻道泄漏（以dB为单位）。所有角度均使用弧度。\n3. 汇总指定测试套件的结果，并以确切要求的格式打印。\n\n测试套件：\n- 使用 $M=32$ 和以下三个不同的 $K$ 值：\n  - $K=6$（短原型；重要的边缘情况），\n  - $K=10$（中等长度；类似边界的情况），\n  - $K=18$（长原型；理想情况）。\n- 对于每个 $K$，计算并返回标量 $\\mathrm{ACL}$ 值（以dB为单位），结果为浮点数并四舍五入到两位小数。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含按测试套件顺序 $[K=6, K=10, K=18]$ 排列的三个结果，形式为方括号内用逗号分隔的列表（例如，\"[a,b,c]\"）。所有内部角度计算均使用弧度，并且不要包含任何额外的文本。", "solution": "我们从均匀离散傅里叶变换 (DFT) 调制分析滤波器组的基本定义开始。设有 $M$ 个分析滤波器 $\\{H_k(e^{j\\omega})\\}$，由单个低通原型 $H_0(e^{j\\omega})$ 经复调制生成：\n$$H_k(e^{j\\omega}) = H_0\\!\\left(e^{j(\\omega - 2\\pi k/M)}\\right),\\quad k=0,1,\\dots,M-1.$$\n通道中心频率为 $\\omega_k = \\frac{2\\pi k}{M}$，单位为弧度/样本。根据设计，原型 $H_0(e^{j\\omega})$ 集中在 $\\omega=0$ 附近，而调制将此低通特性移位至以每个 $\\omega_k$ 为中心。\n\n邻道泄漏量化了为通道 $k$ 设计的滤波器对相邻通道中心频率的抑制程度。仅考虑分析滤波器，一个自然的定义是\n$$\\mathrm{ACL} = 20\\log_{10}\\Bigg(\\max_{k} \\frac{\\left|H_k\\!\\left(e^{j\\omega_{k\\pm 1}}\\right)\\right|}{\\left|H_k\\!\\left(e^{j\\omega_k}\\right)\\right|}\\Bigg),$$\n其中 $k\\pm 1$ 表示 $k$ 在频率圆上的任一直接相邻通道。利用调制恒等式，\n$$H_k(e^{j\\omega_{k}}) = H_0(e^{j0}),\\quad H_k(e^{j\\omega_{k\\pm 1}}) = H_0\\!\\left(e^{\\pm j\\frac{2\\pi}{M}}\\right).$$\n因此，均匀滤波器组的最坏情况比率与 $k$ 无关，并简化为\n$$\\mathrm{ACL} = 20\\log_{10}\\left(\\frac{\\left|H_0\\!\\left(e^{j\\frac{2\\pi}{M}}\\right)\\right|}{\\left|H_0\\!\\left(e^{j0}\\right)\\right|}\\right).$$\n因此，我们只需设计 $H_0$ 并评估上述比值即可。\n\n我们通过对一个理想的离散时间低通滤波器进行加窗来设计 $H_0$。设滤波器长度为 $L=K M$，其中整数 $K\\ge 1$。选择截止频率 $\\omega_c = \\frac{\\pi}{M}$，以将理想通带置于通道带宽之内。为了适应过渡并减少在邻近中心频率 $\\omega=\\frac{2\\pi}{M}$ 处的泄漏，我们采用通带和阻带标记 $\\omega_p=\\frac{3\\pi}{4M}$ 和 $\\omega_s=\\frac{5\\pi}{4M}$，得到名义上的过渡带宽 $\\Delta\\omega=\\frac{\\pi}{2M}$。虽然设置在 $\\omega_c = \\frac{\\pi}{M}$ 的理想低通滤波器具有砖墙式（brick-wall）过渡，但实际的有限长度加窗响应会呈现一个过渡带，其宽度和旁瓣由 $L$ 和窗函数决定。\n\n长度为 $L$、截止频率为 $\\omega_c$ 的低通滤波器的理想冲激响应为\n$$h_d[n] = \\frac{\\omega_c}{\\pi}\\,\\mathrm{sinc}\\!\\left(\\frac{\\omega_c}{\\pi}\\left(n - \\frac{L-1}{2}\\right)\\right),\\quad n=0,1,\\dots,L-1,$$\n其中 $\\mathrm{sinc}(x) = \\frac{\\sin(\\pi x)}{\\pi x}$ 且 $\\mathrm{sinc}(0)=1$。我们应用Kaiser窗 $w[n]$，它由零阶第一类修正Bessel函数 $I_0(\\cdot)$ 定义为\n$$w[n] = \\frac{I_0\\!\\left(\\beta\\,\\sqrt{1 - \\left(\\frac{2n}{L-1}-1\\right)^2}\\right)}{I_0(\\beta)},\\quad n=0,1,\\dots,L-1.$$\nKaiser参数 $\\beta$ 基于所需的旁瓣衰减 $A$（单位为分贝）通过经过充分检验的经验公式来选择：\n$$\\beta =\n\\begin{cases}\n0, & A \\le 21,\\\\\n0.5842\\,(A-21)^{0.4} + 0.07886\\,(A-21), & 21 < A \\le 50,\\\\\n0.1102\\,(A-8.7), & A > 50.\n\\end{cases}$$\n对于 $A=60$ dB，我们处于 $A>50$ 的情况，得出 $\\beta = 0.1102\\,(60-8.7)$，这在数值上设定了典型的 $60$ dB Kaiser设计所具有的旁瓣衰减特性。\n\n加窗后的原型则为\n$$h[n] = h_d[n]\\cdot w[n],$$\n我们将其归一化，使得\n$$\\sum_{n=0}^{L-1} h[n] = 1,$$\n这意味着 $H_0(e^{j0})=1$，从而在每个调制后的通道中心都具有单位增益。这种归一化使得邻道泄漏的计算变得简单\n$$\\mathrm{ACL} = 20\\log_{10}\\left(\\left|H_0\\!\\left(e^{j\\frac{2\\pi}{M}}\\right)\\right|\\right).$$\n\n算法规划：\n1. 固定 $M=32$，目标衰减 $A=60$ dB，并相应计算出 $\\beta$。\n2. 对于每个给定 $K$ 的测试用例，设置 $L=K M$ 并以 $\\omega_c=\\frac{\\pi}{M}$ 生成 $h_d[n]$。\n3. 乘以参数为 $\\beta$ 的Kaiser窗 $w[n]$；然后将 $h[n]$ 归一化以获得单位直流增益。\n4. 使用数值稳定的FIR滤波器频率响应计算程序，计算在 $\\omega=0$ 和 $\\omega=\\frac{2\\pi}{M}$ 处的离散时间频率响应样本 $H_0(e^{j\\omega})$。\n5. 通过上述定义的对数比率评估 $\\mathrm{ACL}$（单位为分贝）。所有角度均使用弧度。\n6. 对测试套件中的所有 $K$ 值重复此过程，将每个结果四舍五入到两位小数，并按指定格式在一行中以单个列表的形式打印。\n\n测试套件基本原理：\n- $K=6$ 产生一个相对较短的原型（$L=192$），这对过渡带宽提出了考验，通常会产生较高的泄漏（边缘情况）。\n- $K=10$ 产生一个中等长度的原型（$L=320$），其性能通常接近 $60$ dB 的目标边界（类似边界情况）。\n- $K=18$ 产生一个更长的原型（$L=576$），应当能提供更好的隔离度（理想情况）。\n\n最终程序遵循这些原则，利用均匀调制恒等式从第一性原理直接计算度量指标，并以单行列表的形式输出指定 $K$ 值对应的三个邻道泄漏值（单位为dB）。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.signal import freqz\n\ndef kaiser_beta(A):\n    # Kaiser window beta from attenuation A (dB)\n    if A = 21:\n        return 0.0\n    elif A = 50:\n        return 0.5842 * (A - 21) ** 0.4 + 0.07886 * (A - 21)\n    else:\n        return 0.1102 * (A - 8.7)\n\ndef design_prototype_kaiser(M, K, A_dB=60.0):\n    \"\"\"\n    Design a low-pass prototype h[n] of length L=K*M using a Kaiser-windowed ideal low-pass\n    with cutoff wc = pi/M. Normalize to unit DC gain.\n    \"\"\"\n    L = K * M\n    wc = np.pi / M  # cutoff in radians/sample\n    n = np.arange(L, dtype=float)\n    m = n - (L - 1) / 2.0\n    # Ideal low-pass impulse response: hd[n] = (wc/pi) * sinc((wc/pi) * m)\n    # np.sinc(x) = sin(pi x)/(pi x)\n    hd = (wc / np.pi) * np.sinc((wc / np.pi) * m)\n    beta = kaiser_beta(A_dB)\n    w = np.kaiser(L, beta)\n    h = hd * w\n    # Normalize to unit DC gain\n    s = np.sum(h)\n    if s == 0.0:\n        # Avoid division by zero; fallback to tiny normalization to keep numerical stability\n        s = 1e-16\n    h /= s\n    return h\n\ndef adjacent_channel_leakage_dB(h, M):\n    \"\"\"\n    Compute ACL in dB: 20*log10(|H0(exp(j*2*pi/M))| / |H0(exp(j*0))|)\n    After normalization, H0(0) ~ 1, but we compute both for robustness.\n    \"\"\"\n    # Evaluate frequency response at omega=0 and omega=2*pi/M\n    omegas = np.array([0.0, 2.0 * np.pi / M], dtype=float)\n    w, H = freqz(h, worN=omegas)\n    H0 = H[0]\n    H_adj = H[1]\n    denom = np.abs(H0)\n    num = np.abs(H_adj)\n    # Guard against numerical zeros\n    eps = 1e-20\n    ratio = (num + eps) / (denom + eps)\n    acl_db = 20.0 * np.log10(ratio)\n    return float(acl_db)\n\ndef solve():\n    # Define the test cases from the problem statement: M=32, K in [6, 10, 18]\n    M = 32\n    test_cases = [6, 10, 18]  # K values\n\n    results = []\n    for K in test_cases:\n        h = design_prototype_kaiser(M=M, K=K, A_dB=60.0)\n        acl_db = adjacent_channel_leakage_dB(h, M)\n        # Round to two decimals for final reporting\n        results.append(f\"{acl_db:.2f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2881712"}, {"introduction": "滤波器组的理论通常是基于无限长信号建立的，但现实世界的数据总是以有限块的形式出现。本练习旨在解决这种不匹配所产生的边界伪影问题。通过将整个系统建模为一个简单的LTI滤波器并假设信号的局部行为，你将分析比较补零和对称延拓两种边界处理方式所导致的重构误差，从而揭示为何后者在最小化数据边缘失真方面通常是更优的选择。", "problem": "考虑一个临界采样的、$M$通道均匀离散傅里叶变换（DFT）调制滤波器组，其原型 $h[n]$ 是一个长度为偶数 $L$ 的实数、线性相位的有限冲激响应。该滤波器组是准酉的，因此对于双边无限信号，其分析-综合级联能实现完美重构（PR），并且在没有子带修改时，混叠会被消除。现在，假设一个对角子带算子在分析和综合之间，对 $M$ 个子带序列施加恒定的实数增益 $\\{G_{k}\\}_{k=0}^{M-1}$。对于无限长信号，该级联等效于一个线性时不变（LTI）系统，其总冲激响应 $t[n]$ 是一个由 $h[n]$ 和 $\\{G_{k}\\}$ 决定的实偶函数。\n\n在本问题中，假设子带增益和原型滤波器的选择使得总冲激响应为对称三抽头平滑器\n$$\nt[-1] \\;=\\; \\alpha,\\qquad t[0] \\;=\\; 1 - 2\\alpha,\\qquad t[1] \\;=\\; \\alpha,\n$$\n其中 $0  \\alpha  \\tfrac{1}{2}$，且对于 $|n| \\ge 2$，$t[n] = 0$。给定一个有限信号 $x[n]$（$n=0,1,\\dots,N-1$），并且你将这一帧信号通过分析-DFT/增益/综合链进行处理。在 $[0,N-1]$ 范围之外，$x[n]$ 的未知样本在分析前通过以下两种边界扩展规则之一进行处理：\n- 补零：对于 $n0$ 和 $n \\ge N$，$x_{\\mathrm{zp}}[n] = 0$。\n- 边缘偶对称扩展：$x_{\\mathrm{sym}}[-1] = x[0]$，$x_{\\mathrm{sym}}[-2] = x[1]$，右边缘类似处理（本问题中可忽略右边缘，因为以下推导仅涉及左边界）。\n\n令 $y[n]$ 表示补偿已知群延迟后的综合输出，使得 $y[n]$ 在时间上与 $x[n]$ 对齐。由于分析-综合级联等效于与 $t[n]$ 的卷积，任意索引 $n$ 处的输出由 $y[n] = \\sum_{m} t[m]\\,x_{\\star}[n-m]$ 给出，其中 $x_{\\star}[\\cdot]$ 是所选的扩展信号（$\\mathrm{zp}$ 或 $\\mathrm{sym}$）。\n\n假设信号在左边界附近满足一个局部仿射模型，\n$$\nx[n] \\;\\approx\\; A + S\\,n \\quad \\text{对于接近 $0$ 的 $n$},\n$$\n其中 $A$ 和 $S$ 是实常数。令 $y_{\\infty}[n]$ 表示假设真实信号在 $[0,N-1]$ 之外对所有 $n\\in\\mathbb{Z}$ 都遵循仿射模型（即对每个 $n$ 都有 $x_{\\infty}[n] = A + S n$）时产生的无限长输出。将每种方法的第一个样本的边界重构误差定义为 $e_{\\mathrm{zp}} \\triangleq y_{\\mathrm{zp}}[0] - y_{\\infty}[0]$ 和 $e_{\\mathrm{sym}} \\triangleq y_{\\mathrm{sym}}[0] - y_{\\infty}[0]$。\n\n仅从 LTI 系统的卷积描述、$t[n]$ 的偶对称性以及局部仿射信号模型出发，推导 $e_{\\mathrm{zp}}$ 和 $e_{\\mathrm{sym}}$ 关于 $A$、$S$ 和 $\\alpha$ 的表达式，然后将误差平方比\n$$\nR \\;\\triangleq\\; \\frac{|e_{\\mathrm{zp}}|^{2}}{|e_{\\mathrm{sym}}|^{2}}\n$$\n简化为一个仅依赖于 $A$ 和 $S$ 的闭式解析表达式（即 $\\alpha$ 必须被消去）。以最简形式给出 $R$ 作为你的最终答案。无需进行数值计算。", "solution": "问题已经过验证。\n\n**步骤1：提取已知条件**\n- **系统**：一个临界采样的、$M$通道均匀离散傅里叶变换（DFT）调制滤波器组。\n- **原型滤波器**：$h[n]$ 是一个实数、线性相位、长度为偶数 $L$ 的有限冲激响应（FIR）原型。\n- **系统特性**：该滤波器组是准酉的，能实现完美重构（PR）。\n- **子带处理**：对子带施加恒定的实数增益 $\\{G_{k}\\}_{k=0}^{M-1}$。\n- **总系统**：分析-综合级联等效于一个线性时不变（LTI）系统，其总冲激响应 $t[n]$ 是实偶函数。\n- **冲激响应 $t[n]$**：\n  - $t[-1] = \\alpha$\n  - $t[0] = 1 - 2\\alpha$\n  - $t[1] = \\alpha$\n  - 对于 $|n| \\ge 2$，$t[n] = 0$。\n- **参数约束**：$0  \\alpha  \\tfrac{1}{2}$。\n- **输入信号**：一个有限信号 $x[n]$，$n=0, 1, \\dots, N-1$。\n- **边界扩展规则**：\n  - 补零：对于 $n0$，$x_{\\mathrm{zp}}[n] = 0$。\n  - 偶对称扩展：$x_{\\mathrm{sym}}[-1] = x[0]$。\n- **输出定义**：$y[n] = \\sum_{m} t[m]\\,x_{\\star}[n-m]$，其中 $x_{\\star}[\\cdot]$ 是扩展信号。输出 $y[n]$ 与输入 $x[n]$ 在时间上对齐。\n- **局部信号模型**：对于接近 $0$ 的 $n$，$x[n] \\approx A + S\\,n$，其中 $A$ 和 $S$ 是实常数。\n- **理想无限长信号与输出**：对于所有 $n \\in \\mathbb{Z}$，$x_{\\infty}[n] = A + Sn$，对应的输出为 $y_{\\infty}[n]$。\n- **误差定义**：\n  - $e_{\\mathrm{zp}} \\triangleq y_{\\mathrm{zp}}[0] - y_{\\infty}[0]$。\n  - $e_{\\mathrm{sym}} \\triangleq y_{\\mathrm{sym}}[0] - y_{\\infty}[0]$。\n- **目标**：推导 $e_{\\mathrm{zp}}$ 和 $e_{\\mathrm{sym}}$ 的表达式，并将比率 $R \\triangleq \\frac{|e_{\\mathrm{zp}}|^{2}}{|e_{\\mathrm{sym}}|^{2}}$ 简化为仅依赖于 $A$ 和 $S$ 的形式。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题在数字信号处理理论，特别是多速率系统和滤波器组方面有充分的依据。LTI 系统、卷积、边界效应和信号建模等概念是标准的，并且应用正确。\n- **适定性**：该问题是适定的。它提供了所有必要的定义和约束，以推导出目标量 $R$ 的唯一解析表达式。目标明确且可实现。\n- **客观性**：该问题以精确、客观、正式的语言表述，没有任何主观或模糊的术语。\n- **结论**：该问题在科学上是合理的，内容是自洽的，并且结构是形式化的。它没有违反任何无效标准。\n\n**步骤3：判定与行动**\n该问题是**有效的**。将提供解答。\n\n该问题要求推导两种不同信号扩展方法的边界重构误差。总系统是 LTI 系统，由与冲激响应 $t[n]$ 的卷积来描述。任意索引处的输出 $y[n]$ 由卷积和给出：\n$$\ny[n] = \\sum_{m=-\\infty}^{\\infty} t[m] x_{\\star}[n-m]\n$$\n其中 $x_{\\star}$ 表示扩展后的输入信号。给定冲激响应 $t[n]$ 仅在 $n \\in \\{-1, 0, 1\\}$ 时非零，输出在 $n=0$ 处的卷积和简化为：\n$$\ny[0] = t[-1]x_{\\star}[1] + t[0]x_{\\star}[0] + t[1]x_{\\star}[-1]\n$$\n代入 $t[n]$ 的给定值：\n$$\ny[0] = \\alpha x_{\\star}[1] + (1 - 2\\alpha)x_{\\star}[0] + \\alpha x_{\\star}[-1]\n$$\n\n我们必须为三种情况计算此表达式：理想无限长信号 $x_{\\infty}$、补零信号 $x_{\\mathrm{zp}}$ 和对称扩展信号 $x_{\\mathrm{sym}}$。局部仿射模型 $x[n] = A + Sn$ 用于定义边界附近的信号值。\n\n首先，我们计算理想输出 $y_{\\infty}[0]$。对应的输入是对于所有整数 $n$ 都有 $x_{\\infty}[n] = A + Sn$。所需的输入样本为：\n- $x_{\\infty}[-1] = A + S(-1) = A - S$\n- $x_{\\infty}[0] = A + S(0) = A$\n- $x_{\\infty}[1] = A + S(1) = A + S$\n\n将这些值代入 $y[0]$ 的表达式，得到 $y_{\\infty}[0]$：\n$$\ny_{\\infty}[0] = \\alpha(A+S) + (1-2\\alpha)A + \\alpha(A-S)\n$$\n$$\ny_{\\infty}[0] = \\alpha A + \\alpha S + A - 2\\alpha A + \\alpha A - \\alpha S\n$$\n$$\ny_{\\infty}[0] = (\\alpha - 2\\alpha + \\alpha)A + (\\alpha - \\alpha)S + A = A\n$$\n这个结果是符合预期的，因为滤波器 $t[n]$ 能够保持仿射信号。该滤波器的直流增益为 $\\sum_{n} t[n] = \\alpha + (1-2\\alpha) + \\alpha = 1$，其一阶矩为 $\\sum_{n} n t[n] = (-1)\\alpha + (0)(1-2\\alpha) + (1)\\alpha = 0$。对于任何仿射输入 $x[n]=A+Sn$，输出为 $y[n] = \\sum_{m} t[m](A+S(n-m)) = (A+Sn)\\sum_{m} t[m] - S\\sum_{m} m t[m] = A+Sn = x[n]$。因此，$y_{\\infty}[0] = x_{\\infty}[0] = A$。\n\n接下来，我们计算补零情况下的输出 $y_{\\mathrm{zp}}[0]$。扩展信号 $x_{\\mathrm{zp}}[n]$ 在 $n \\ge 0$ 时由 $x[n]$ 定义，在 $n  0$ 时为零。所需的样本为：\n- $x_{\\mathrm{zp}}[-1] = 0$（根据补零规则）\n- $x_{\\mathrm{zp}}[0] = x[0] = A + S(0) = A$\n- $x_{\\mathrm{zp}}[1] = x[1] = A + S(1) = A + S$\n\n将这些值代入输出表达式：\n$$\ny_{\\mathrm{zp}}[0] = \\alpha(A+S) + (1-2\\alpha)A + \\alpha(0)\n$$\n$$\ny_{\\mathrm{zp}}[0] = \\alpha A + \\alpha S + A - 2\\alpha A = A - \\alpha A + \\alpha S\n$$\n补零的边界重构误差 $e_{\\mathrm{zp}}$ 为：\n$$\ne_{\\mathrm{zp}} = y_{\\mathrm{zp}}[0] - y_{\\infty}[0] = (A - \\alpha A + \\alpha S) - A = \\alpha S - \\alpha A = \\alpha(S-A)\n$$\n\n现在，我们计算对称扩展情况下的输出 $y_{\\mathrm{sym}}[0]$。扩展信号 $x_{\\mathrm{sym}}[n]$ 使用规则 $x_{\\mathrm{sym}}[-1] = x[0]$。所需的样本为：\n- $x_{\\mathrm{sym}}[-1] = x[0] = A + S(0) = A$\n- $x_{\\mathrm{sym}}[0] = x[0] = A$\n- $x_{\\mathrm{sym}}[1] = x[1] = A + S(1) = A + S$\n\n将这些值代入输出表达式：\n$$\ny_{\\mathrm{sym}}[0] = \\alpha(A+S) + (1-2\\alpha)A + \\alpha(A)\n$$\n$$\ny_{\\mathrm{sym}}[0] = \\alpha A + \\alpha S + A - 2\\alpha A + \\alpha A = A + \\alpha S\n$$\n对称扩展的边界重构误差 $e_{\\mathrm{sym}}$ 为：\n$$\ne_{\\mathrm{sym}} = y_{\\mathrm{sym}}[0] - y_{\\infty}[0] = (A + \\alpha S) - A = \\alpha S\n$$\n\n最后，我们计算误差平方比 $R$：\n$$\nR = \\frac{|e_{\\mathrm{zp}}|^{2}}{|e_{\\mathrm{sym}}|^{2}}\n$$\n代入推导出的误差表达式：\n$$\nR = \\frac{|\\alpha(S-A)|^{2}}{|\\alpha S|^{2}}\n$$\n因为 $\\alpha$、$A$ 和 $S$ 都是实数，所以绝对值的平方就是表达式的平方。此外，由于 $0  \\alpha  \\frac{1}{2}$，$\\alpha$ 非零。\n$$\nR = \\frac{\\alpha^{2}(S-A)^{2}}{\\alpha^{2}S^{2}}\n$$\n根据要求，分子和分母中的 $\\alpha^2$ 项相互抵消。这留下一个仅依赖于 $A$ 和 $S$ 的表达式。\n$$\nR = \\frac{(S-A)^{2}}{S^{2}}\n$$\n该表达式是其作为多项式比率的最简形式。它也可以写成 $\\left(1 - \\frac{A}{S}\\right)^2$。我们以第一种形式给出答案。", "answer": "$$\n\\boxed{\\frac{(S-A)^2}{S^2}}\n$$", "id": "2881797"}]}