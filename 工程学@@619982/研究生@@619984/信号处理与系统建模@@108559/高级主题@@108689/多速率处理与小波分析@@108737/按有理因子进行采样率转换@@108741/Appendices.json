{"hands_on_practices": [{"introduction": "多相分解是构建高效多速率滤波器的核心技术。本练习将引导您完成将一个给定的有限脉冲响应（FIR）滤波器分解为其多相分量的具体过程。通过动手实践，您将掌握索引分配和子滤波器构建的基本机制，为理解更高级的多速率结构奠定坚实的基础。[@problem_id:2902294]", "problem": "考虑一个因果有限冲激响应滤波器，其传递函数 $H(z)$ 由下式给出\n$$\nH(z) \\;=\\; \\sum_{n=0}^{12} h[n]\\, z^{-n},\n$$\n其中冲激响应系数 $\\{h[n]\\}$ 为\n$$\n\\{h[n]\\}_{n=0}^{12} \\;=\\; \\{\\, 0.0040,\\; -0.0120,\\; 0.0280,\\; 0.0800,\\; 0.1350,\\; 0.1650,\\; 0.1800,\\; 0.1650,\\; 0.1350,\\; 0.0800,\\; 0.0280,\\; -0.0120,\\; 0.0040 \\,\\}.\n$$\n在按有理因子进行采样率转换的背景下，一个以 $L$ 倍插值的多相实现通过基于索引模 $L$ 将系数 $\\{h[n]\\}$ 分配到 $L$ 个分支，从而将 $H(z)$ 分解为 $L$ 个子滤波器。仅从 z 变换、有限冲激响应滤波以及均匀模索引划分的概念出发，通过显式构造满足插值多相关系的四个多相分量 $E_{0}(z)$、$E_{1}(z)$、$E_{2}(z)$ 和 $E_{3}(z)$，推导 $L=4$ 插值的多相分解。清晰地展示索引映射如何将系数分配给每个分支。\n\n将你的最终答案以包含四个多项式 $E_{0}(z)$、$E_{1}(z)$、$E_{2}(z)$ 和 $E_{3}(z)$（按此顺序）的行向量形式提供。无需四舍五入；使用上面给出的精确小数值。最终答案应为以 $z$ 为变量的单个封闭形式解析表达式。", "solution": "我们从 z 变换和有限冲激响应滤波的定义开始。一个因果有限冲激响应滤波器由一组有限的冲激响应系数 $\\{h[n]\\}$ 指定，其传递函数为\n$$\nH(z) \\;=\\; \\sum_{n=0}^{N-1} h[n]\\, z^{-n}.\n$$\n此处，我们有 $N=13$ 和给定的 $h[n]$（对于 $n\\in\\{0,1,\\dots,12\\}$）。\n\n对于以整数因子 $L$ 进行插值，多相实现通过将索引集 $\\{0,1,\\dots,N-1\\}$ 划分为模 $L$ 的剩余类，将滤波器系数重组为 $L$ 个子滤波器。具体来说，对于 $L=4$，索引根据它们模 4 的余数进行划分。基本步骤是通过将 $n$ 表示为以下形式来重写关于 $n$ 的单次求和：\n$$\nn \\;=\\; 4m + k, \\quad \\text{其中} \\quad k \\in \\{0,1,2,3\\}, \\quad m \\in \\mathbb{Z}_{\\ge 0},\n$$\n满足 $4m+k \\le N-1$。将此代入 $H(z)$ 得到\n$$\nH(z)\n\\;=\\;\n\\sum_{n=0}^{N-1} h[n]\\, z^{-n}\n\\;=\\;\n\\sum_{k=0}^{3} \\sum_{m \\,\\ge\\, 0:\\, 4m+k \\le N-1} h[\\,4m + k\\,]\\, z^{-(4m + k)}.\n$$\n我们提出公因子 $z^{-k}$ 并将剩余项按 $z^{-4}$ 的幂次分组：\n$$\nH(z)\n\\;=\\;\n\\sum_{k=0}^{3} z^{-k} \\left( \\sum_{m \\,\\ge\\, 0:\\, 4m+k \\le N-1} h[\\,4m + k\\,]\\, (z^{-4})^{m} \\right).\n$$\n将第 $k$ 个多相分量定义为\n$$\nE_{k}(z) \\;=\\; \\sum_{m \\,\\ge\\, 0:\\, 4m+k \\le N-1} h[\\,4m + k\\,]\\, z^{-m},\n$$\n我们得到多相分解（插值的标准形式）如下：\n$$\nH(z) \\;=\\; \\sum_{k=0}^{3} z^{-k}\\, E_{k}\\!\\left(z^{4}\\right).\n$$\n这个构造过程展示了系数是如何分配的：由 $k$ 索引的分支收集所有原始索引与 $k$ 模 4 同余的系数，并按照 $m=(n-k)/4$ 中 $m$ 的递增顺序将它们放入 $E_{k}(z)$。\n\n我们现在将此方法应用于给定的 $h[n]$，其中 $N=13$ 且 $L=4$。\n\n- 分支 $k=0$ 取索引 $n \\in \\{0,4,8,12\\}$，对应于 $m \\in \\{0,1,2,3\\}$：\n  - $h[0] = 0.0040$ 成为 $E_{0}(z)$ 中 $z^{0}$ 的系数。\n  - $h[4] = 0.1350$ 成为 $z^{-1}$ 的系数。\n  - $h[8] = 0.1350$ 成为 $z^{-2}$ 的系数。\n  - $h[12] = 0.0040$ 成为 $z^{-3}$ 的系数。\n  因此，\n  $$\n  E_{0}(z) \\;=\\; 0.0040 \\;+\\; 0.1350\\, z^{-1} \\;+\\; 0.1350\\, z^{-2} \\;+\\; 0.0040\\, z^{-3}.\n  $$\n\n- 分支 $k=1$ 取索引 $n \\in \\{1,5,9\\}$，对应于 $m \\in \\{0,1,2\\}$：\n  - $h[1] = -0.0120$ 成为 $E_{1}(z)$ 中 $z^{0}$ 的系数。\n  - $h[5] = 0.1650$ 成为 $z^{-1}$ 的系数。\n  - $h[9] = 0.0800$ 成为 $z^{-2}$ 的系数。\n  因此，\n  $$\n  E_{1}(z) \\;=\\; -0.0120 \\;+\\; 0.1650\\, z^{-1} \\;+\\; 0.0800\\, z^{-2}.\n  $$\n\n- 分支 $k=2$ 取索引 $n \\in \\{2,6,10\\}$，对应于 $m \\in \\{0,1,2\\}$：\n  - $h[2] = 0.0280$ 成为 $E_{2}(z)$ 中 $z^{0}$ 的系数。\n  - $h[6] = 0.1800$ 成为 $z^{-1}$ 的系数。\n  - $h[10] = 0.0280$ 成为 $z^{-2}$ 的系数。\n  因此，\n  $$\n  E_{2}(z) \\;=\\; 0.0280 \\;+\\; 0.1800\\, z^{-1} \\;+\\; 0.0280\\, z^{-2}.\n  $$\n\n- 分支 $k=3$ 取索引 $n \\in \\{3,7,11\\}$，对应于 $m \\in \\{0,1,2\\}$：\n  - $h[3] = 0.0800$ 成为 $E_{3}(z)$ 中 $z^{0}$ 的系数。\n  - $h[7] = 0.1650$ 成为 $z^{-1}$ 的系数。\n  - $h[11] = -0.0120$ 成为 $z^{-2}$ 的系数。\n  因此，\n  $$\n  E_{3}(z) \\;=\\; 0.0800 \\;+\\; 0.1650\\, z^{-1} \\;-\\; 0.0120\\, z^{-2}.\n  $$\n\n这个显式构造过程验证了模索引映射：每个分支 $k$ 接收所有满足 $n \\equiv k \\pmod{4}$ 的系数 $h[n]$，并且它们在 $E_{k}(z)$ 中的位置遵循 $m = (n-k)/4$ 作为 $z^{-1}$ 的幂次。将这些 $E_{k}(z)$ 代入关系式 $H(z) = \\sum_{k=0}^{3} z^{-k} E_{k}(z^{4})$ 可以重构出原始的 $H(z)$，从而证实了分解的正确性。", "answer": "$$\\boxed{\\begin{pmatrix}\n0.0040 + 0.1350\\, z^{-1} + 0.1350\\, z^{-2} + 0.0040\\, z^{-3} &\n-0.0120 + 0.1650\\, z^{-1} + 0.0800\\, z^{-2} &\n0.0280 + 0.1800\\, z^{-1} + 0.0280\\, z^{-2} &\n0.0800 + 0.1650\\, z^{-1} - 0.0120\\, z^{-2}\n\\end{pmatrix}}$$", "id": "2902294"}, {"introduction": "在学习了如何分解滤波器之后，理解我们为什么要这样做至关重要。本练习通过量化比较，揭示了多相实现与直接实现相比所带来的巨大计算优势。这个实践突出了多相结构在真实世界系统中的实际重要性，解释了为何它是实现高效有理因子采样率转换的首选方法。[@problem_id:2902270]", "problem": "一个离散时间系统通过有理因数 $L/M$ 执行采样率转换，它使用一个长度为 $N$ 的理想化有限冲激响应(FIR)抗镜像和抗混叠滤波器（即具有 $N$ 个非零抽头且未利用系数对称性）。输入采样率为 $F_{\\text{in}}$。考虑对于一组固定的整数 $L \\geq 2$, $M \\geq 2$，该转换器的两种实现方式：\n\n1. 一种朴素的直接型结构，它显式地进行 $L$ 倍上采样（在输入样本之间插入 $L-1$ 个零），在更高的速率下滤波，然后进行 $M$ 倍下采样（每 $M$ 个样本保留一个），整个过程不使用贵族恒等式或多相分解。\n2. 一种多相-贵族优化结构，它利用上采样和下采样的贵族恒等式以及FIR滤波器的 $L$ 支路多相分解，从而仅在最低的可行内部速率下评估必要的滤波器相位。\n\n仅从上采样、下采样和FIR滤波的卷积和的定义出发，推导每种实现的总乘法率（每秒乘法次数）的表达式。然后，对于 $L=7$, $M=5$, $N=301$ 和 $F_{\\text{in}}=96\\,\\mathrm{kHz}$，计算这些表达式的值。最后，计算加速因子，其定义为朴素直接型乘法率与多相-贵族乘法率之比。\n\n将两个乘法率以 $\\mathrm{MAC/s}$ (每秒乘累加操作次数，每次生成样本的每个抽头计为一次乘法) 表示，并将加速因子表示为纯数。提供精确的整数值，无需四舍五入。按顺序 $\\big($直接型 $\\mathrm{MAC/s}$, 多相型 $\\mathrm{MAC/s}$, 加速因子$\\big)$ 报告你的三个最终值。", "solution": "所提出的问题是数字信号处理领域中一个适定且有科学依据的练习，要求分析有理因数采样率转换器两种不同实现的计算复杂度。它基于多速率系统的既定原理，包括上采样、下采样、FIR滤波和多相分解。所有必要的参数均已提供，问题没有任何歧义或矛盾。因此，我们可以进行形式化推导。\n\n设输入信号为 $x[n]$，采样率为 $F_{\\text{in}}$。系统必须将此速率转换 $L/M$ 倍。FIR滤波器的冲激响应为 $h[n]$，长度为 $N$。\n\n首先，我们分析朴素的直接型实现。\n该结构按顺序执行操作：$L$ 倍上采样、FIR滤波和 $M$ 倍下采样。\n$1$. $L$ 倍上采样：通过在 $x[n]$ 的连续样本之间插入 $L-1$ 个零值样本，创建中间信号 $x_u[m]$。$x_u[m]$ 的采样率变为 $F_{\\text{int}} = L \\times F_{\\text{in}}$。\n$2$. FIR 滤波：上采样后的信号 $x_u[m]$ 由长度为 $N$ 的FIR滤波器 $h[n]$ 进行滤波。滤波器输出 $v[m]$ 由卷积和给出：\n$$v[m] = \\sum_{i=0}^{N-1} h[i] x_u[m-i]$$\n要计算每个样本 $v[m]$，需要 $N$ 次乘法（因为我们计算每个滤波器抽头有一次乘累加操作）。滤波器在中间采样率 $F_{\\text{int}}$ 下运行，每秒产生 $L \\times F_{\\text{in}}$ 个样本。因此，滤波器的总乘法率是每个样本的乘法次数与采样率的乘积。\n设 $R_1$ 为朴素实现的乘法率。\n$$R_1 = N \\times F_{\\text{int}} = N \\times (L \\times F_{\\text{in}}) = N L F_{\\text{in}}$$\n$3$. $M$ 倍下采样：滤波后的信号 $v[m]$ 通过每 $M$ 个样本保留一个样本进行下采样，产生最终输出 $y[k] = v[kM]$。此操作不涉及乘法。\n\n因此，朴素直接型结构的总乘法率为 $R_1 = N L F_{\\text{in}}$。\n\n接下来，我们分析多相-贵族优化实现。\n这种结构利用多速率恒等式在较低的采样率下执行滤波。问题指定使用滤波器 $h[n]$ 的 $L$ 支路多相分解。\n$1$. 系统架构：整个系统是上采样（$\\uparrow L$）、滤波（$H(z)$）和下采样（$\\downarrow M$）的级联。\n$2$. $L$ 支路多相分解：滤波器的传递函数 $H(z) = \\sum_{n=0}^{N-1} h[n] z^{-n}$ 被分解为 $L$ 个多相分量 $E_k(z)$：\n$$H(z) = \\sum_{k=0}^{L-1} z^{-k} E_k(z^L)$$\n其中第 $k$ 个多相滤波器 $E_k(z)$ 的系数为 $e_k[n] = h[nL+k]$。滤波器 $E_k(z)$ 的长度为 $N_k = \\lceil (N-k)/L \\rceil$。\n$3$. 应用贵族恒等式：系统可以写为 $y[p] = \\left( \\left( x[n] \\uparrow L \\right) * h[n] \\right) \\downarrow M$。代入 $h[n]$ 的多相展开并分析输出样本 $y[p]$ 的信号路径，可得：\n$$y[p] = \\sum_{i=0}^{N-1} h[i] x_u[pM - i]$$\n其中 $x_u[\\cdot]$ 是上采样的输入。令 $i = nL+k$，其中 $k \\in \\{0, 1, \\dots, L-1\\}$。\n$$y[p] = \\sum_{k=0}^{L-1} \\sum_{n} h[nL+k] x_u[pM - (nL+k)]$$\n项 $x_u[j]$ 仅当 $j$ 是 $L$ 的倍数时才非零。因此，要获得非零贡献，必须有 $pM - (nL+k)$ 是 $L$ 的倍数。这意味着 $pM - k$ 必须是 $L$ 的倍数，或者 $k \\equiv pM \\pmod{L}$。\n对于任何给定的输出索引 $p$，此条件将 $k$ 固定为单个值 $k_p = pM \\pmod{L}$。\n令 $pM - k_p = n_p L$，得到 $n_p = (pM - k_p)/L = \\lfloor pM/L \\rfloor$。$y[p]$ 的求和式收缩为单个多相支路：\n$$y[p] = \\sum_{n} h[nL+k_p] x[n_p-n] = \\sum_{n} e_{k_p}[n] x[n_p-n] = (e_{k_p} * x)[n_p]$$\n此方程表明，要计算输出样本 $y[p]$，我们只需在单个时间瞬间 $n_p$ 计算单个多相滤波器 $E_{k_p}(z)$ 的输出。该计算需要 $N_{k_p} = \\lceil (N-k_p)/L \\rceil$ 次乘法。滤波操作实际上发生在输入速率域，但仅在需要特定多相滤波器输出时才进行。\n\n为了求得平均乘法率 $R_2$，我们确定每个输出样本的平均乘法次数，并乘以输出采样率 $F_{\\text{out}} = F_{\\text{in}} \\frac{L}{M}$。\n所使用的多相索引序列 $k_p = pM \\pmod{L}$ 在 $p$ 上是周期的。周期为 $P = L/\\text{gcd}(L,M)$。当 $\\text{gcd}(L,M)=1$ 时（如此问题），周期为 $L$，序列 $\\{ pM \\pmod{L} \\}_{p=0}^{L-1}$ 是 $\\{0, 1, \\dots, L-1\\}$ 的一个排列。\n在 $L$ 个连续的输出样本中， $L$ 个多相滤波器每个都被精确使用一次。产生这 $L$ 个样本所需的总乘法次数为 $\\sum_{k=0}^{L-1} N_k = \\sum_{k=0}^{L-1} \\lceil (N-k)/L \\rceil$。可以证明这个和恰好等于 $N$。令 $N = qL+r$，其中 $0 \\le r < L$。\n$$\\sum_{k=0}^{L-1} \\lceil \\frac{N-k}{L} \\rceil = \\sum_{k=0}^{L-1} \\left( q + \\lceil \\frac{r-k}{L} \\rceil \\right) = qL + \\sum_{k=0}^{r-1}(1) + \\sum_{k=r}^{L-1}(0) = qL + r = N$$\n因此，生成 $L$ 个输出样本需要进行 $N$ 次乘法。每个输出样本的平均乘法次数为 $N/L$。\n总乘法率 $R_2$ 为：\n$$R_2 = \\left( \\frac{\\text{MACs}}{\\text{output sample}} \\right) \\times \\left( \\frac{\\text{output samples}}{\\text{second}} \\right) = \\left(\\frac{N}{L}\\right) \\times F_{\\text{out}} = \\frac{N}{L} \\times \\left( F_{\\text{in}} \\frac{L}{M} \\right) = \\frac{N F_{\\text{in}}}{M}$$\n$R_2$ 的这个表达式是有效的，因为问题指定了 $L$ 支路分解且 $\\text{gcd}(L,M)=1$。\n\n最后，加速因子 $S$ 是朴素乘法率与优化后乘法率之比。\n$$S = \\frac{R_1}{R_2} = \\frac{N L F_{\\text{in}}}{N F_{\\text{in}} / M} = L M$$\n\n现在我们用给定的值计算这些表达式：$L=7$, $M=5$, $N=301$ 和 $F_{\\text{in}}=96\\,\\mathrm{kHz} = 96000\\,\\mathrm{Hz}$。\n注意 $\\text{gcd}(7,5)=1$，这验证了我们使用的简化公式是正确的。\n\n直接型乘法率：\n$$R_1 = N L F_{\\text{in}} = 301 \\times 7 \\times 96000 = 2107 \\times 96000 = 202,272,000 \\,\\mathrm{MAC/s}$$\n\n多相-贵族乘法率：\n$$R_2 = \\frac{N F_{\\text{in}}}{M} = \\frac{301 \\times 96000}{5} = 301 \\times 19200 = 5,779,200 \\,\\mathrm{MAC/s}$$\n\n加速因子：\n$$S = L M = 7 \\times 5 = 35$$\n\n作为检验，我们可以计算这两个速率的比值：$S = \\frac{202,272,000}{5,779,200} = 35$。结果是一致的。\n\n三个最终值是直接型MAC/s、多相型MAC/s和加速因子。", "answer": "$$\\boxed{\\begin{pmatrix} 202272000 & 5779200 & 35 \\end{pmatrix}}$$", "id": "2902270"}, {"introduction": "除了计算效率，系统级的行为也是实际设计中的关键考量。本练习将视角从计算速度扩展到整体系统参数，例如输出采样率、信号延迟以及输入与输出样本之间的精确定时关系。通过解决这些问题，您将学会如何处理在将采样率转换器集成到更大数据流中所必需的基本设计与集成挑战。[@problem_id:2902306]", "problem": "离散时间信号 $x[n]$ 是通过对一个连续时间严格带限信号 $s(t)$ 以输入采样频率 $f_{x} = 48\\,\\mathrm{kHz}$ 进行理想采样得到的，因此有 $x[n] = s(n T_{x})$，其中 $T_{x} = 1/f_{x}$。考虑一个理想化的有理采样率转换器，它首先将 $x[n]$ 以整数因子 $L = 147$ 进行上采样（插零），然后使用一个长度为 $N_{h} = 321$ 的因果、实数、严格线性相位的有限脉冲响应(FIR)原型滤波器 $h[m]$ 在上采样后的速率下进行滤波，最后再以整数因子 $M = 160$ 进行下采样。假设 $h[m]$ 的设计能够完美抑制与 $s(t)$ 的带限特性相符的镜像和混叠，并且唯一的相位失真是由线性相位滤波器对齐引起的恒定群延迟。\n\n仅从时域中上采样和下采样的基本定义、采样周期和采样频率之间的关系，以及因果对称FIR滤波器的群延迟出发，推导以下内容：\n\n1) 输出采样频率 $f_{y}$（以 $\\mathrm{Hz}$ 为单位）。\n\n2) 为了保持相位对齐（即，使整个系统表现出恒定群延迟，并且除了纯延迟之外没有其他相位失真），多相实现必须施加的最小非负整数延迟 $D_{o}$（以输出样本数为单位）。\n\n3) 一个从输出样本索引 $k$ 到在第 $k$ 个输出采样时刻或之前出现的最近输入样本索引 $n(k)$ 的映射的闭式表达式。仅使用向下取整运算符以及整数 $L$ 和 $M$ 来表示 $n(k)$。\n\n答案规格：\n- 以 $\\mathrm{Hz}$ 表示 $f_{y}$。\n- 将 $D_{o}$ 表示为无量纲的整数输出样本数。\n- 将映射 $n(k)$ 表示为关于 $k$ 的单个解析表达式。\n- 以单行矩阵的形式提供最终答案，其中条目按 $\\bigl[f_{y},\\, D_{o},\\, n(k)\\bigr]$ 的顺序排列。", "solution": "对问题陈述进行验证。\n\n步骤 1：提取已知条件\n- 输入信号：离散时间信号 $x[n]$ 是通过对一个连续时间严格带限信号 $s(t)$ 进行理想采样得到的。\n- 输入采样频率：$f_{x} = 48\\,\\mathrm{kHz} = 48000\\,\\mathrm{Hz}$。\n- 输入采样周期：$T_{x} = 1/f_{x}$。\n- 输入信号关系：$x[n] = s(n T_{x})$。\n- 上采样因子：$L = 147$。\n- 下采样因子：$M = 160$。\n- 滤波器：一个因果、实数、严格线性相位的有限脉冲响应(FIR)原型滤波器 $h[m]$。\n- 滤波器长度：$N_{h} = 321$。\n- 滤波器应用：滤波器作用于上采样后的速率。\n- 滤波器属性：该滤波器能完美抑制镜像和混叠。唯一的相位失真是恒定群延迟。\n- 推导约束：仅从上采样、下采样的基本定义、采样周期/频率关系以及因果对称FIR滤波器的群延迟出发。\n- 要求输出：\n  1. 输出采样频率 $f_{y}$（单位：Hz）。\n  2. 为实现多相实现的相位对齐所需的最小非负整数延迟 $D_{o}$（以输出样本数为单位）。\n  3. 从输出索引 $k$ 到在第 $k$ 个输出采样时刻或之前出现的最近输入索引 $n$ 的映射 $n(k)$ 的闭式表达式。\n\n步骤 2：使用提取的已知条件进行验证\n该问题描述了一个标准有理因子采样率转换器，这是数字信号处理中的一个基本主题。所有参数和概念（$f_{x}$, $L$, $M$, FIR滤波器属性）都有明确定义，并与既定理论一致。该问题具有科学依据，提法恰当，并且是客观的。它不违反任何科学原理，是可形式化的，并包含足够的信息以获得唯一解。滤波器是因果的，且长度 $N_h=321$ 为奇数，这意味着它是一个I型线性相位FIR滤波器，这是前后一致的。数值是符合实际的。问题有效。\n\n步骤 3：结论与行动\n问题有效。将提供一个完整的、有理有据的解答。\n\n$f_{y}$ 的推导：\n以因子 $L/M$ 进行有理采样率转换的过程会改变采样周期。输入采样周期为 $T_{x} = 1/f_{x}$。\n首先，信号 $x[n]$ 被上采样因子 $L$ 上采样。这涉及到在 $x[n]$ 的每两个样本之间插入 $L-1$ 个零。得到的中间信号的采样周期为 $T_{int} = T_{x}/L$。\n其次，这个中间信号经过滤波，然后被下采样因子 $M$ 下采样。下采样涉及到每 $M$ 个样本取一个。这将采样周期增加了因子 $M$。\n因此，输出采样周期 $T_{y}$ 由下式给出：\n$$T_{y} = M \\cdot T_{int} = M \\cdot \\frac{T_{x}}{L} = \\frac{M}{L} T_{x}$$\n输出采样频率 $f_{y}$ 是输出采样周期的倒数：\n$$f_{y} = \\frac{1}{T_{y}} = \\frac{1}{\\frac{M}{L} T_{x}} = \\frac{L}{M} \\frac{1}{T_{x}} = \\frac{L}{M} f_{x}$$\n代入给定值：\n$$f_{y} = \\frac{147}{160} \\cdot 48000\\,\\mathrm{Hz} = 147 \\cdot \\frac{48000}{160}\\,\\mathrm{Hz} = 147 \\cdot 300\\,\\mathrm{Hz} = 44100\\,\\mathrm{Hz}$$\n\n$D_{o}$ 的推导：\n问题指定了一个长度为 $N_{h}$ 的因果、实数、严格线性相位的FIR滤波器 $h[m]$。由于 $N_h=321$ 是奇数，这是一个关于其中点对称的I型FIR滤波器。\n这种滤波器的群延迟是恒定的，并以滤波器工作的速率下的样本数给出。滤波器工作在中间上采样速率 $f_{int} = L f_{x}$ 下。\n在此速率下，以样本数表示的群延迟（记为 $\\tau_{g}$）为：\n$$\\tau_{g} = \\frac{N_{h}-1}{2}$$\n代入给定的滤波器长度 $N_{h}=321$：\n$$\\tau_{g} = \\frac{321-1}{2} = \\frac{320}{2} = 160 \\text{ 个样本}$$\n这是以中间采样周期 $T_{int}$ 为单位的延迟。滤波器引入的总时间延迟 $t_{d}$ 是：\n$$t_{d} = \\tau_{g} \\cdot T_{int} = \\tau_{g} \\cdot \\frac{T_{x}}{L} = \\frac{N_{h}-1}{2L} T_{x}$$\n问题要求将此延迟以输出样本数为单位表示。这个量，$D_{o}$，是时间延迟 $t_{d}$ 除以输出采样周期 $T_{y}$。\n$$D_{o} = \\frac{t_{d}}{T_{y}}$$\n我们有 $T_{y} = \\frac{M}{L} T_{x}$。代入 $t_{d}$ 和 $T_{y}$ 的表达式：\n$$D_{o} = \\frac{\\frac{N_{h}-1}{2L} T_{x}}{\\frac{M}{L} T_{x}} = \\frac{N_{h}-1}{2L} \\cdot \\frac{L}{M} = \\frac{N_{h}-1}{2M}$$\n该表达式给出了以输出样本数表示的总系统群延迟，这对应于在实现中为保持相位对齐所需的延迟。\n代入值 $N_{h}=321$ 和 $M=160$：\n$$D_{o} = \\frac{321-1}{2 \\cdot 160} = \\frac{320}{320} = 1$$\n最小非负整数延迟是 1 个输出样本。\n\n$n(k)$ 的推导：\n问题要求的是在第 $k$ 个输出采样时刻或之前出现的最近输入样本的索引 $n(k)$。这是对输入和输出采样网格上物理时间点的直接比较。\n第 $n$ 个输入样本的物理时间是 $t_{n}^{\\text{in}} = n \\cdot T_{x}$。\n第 $k$ 个输出样本的物理时间是 $t_{k}^{\\text{out}} = k \\cdot T_{y}$。\n输入采样时间“在...或之前”输出采样时间的条件表示为：\n$$t_{n}^{\\text{in}} \\le t_{k}^{\\text{out}}$$\n代入采样周期的定义：\n$$n T_{x} \\le k T_{y}$$\n$$n T_{x} \\le k \\left(\\frac{M}{L} T_{x}\\right)$$\n除以 $T_{x}$（为正）：\n$$n \\le k \\frac{M}{L}$$\n我们正在寻找“最近的”输入样本，它对应于满足此不等式的最大整数值 $n$。这可以通过对右侧取底（向下取整）来实现。\n因此，映射 $n(k)$ 是：\n$$n(k) = \\left\\lfloor k \\frac{M}{L} \\right\\rfloor$$\n此表达式对所有整数 $k \\ge 0$ 有效。代入 $L$ 和 $M$ 的给定值：\n$$n(k) = \\left\\lfloor k \\frac{160}{147} \\right\\rfloor$$\n这就是所要求的闭式表达式。注意，滤波器的群延迟不进入此计算，因为问题严格地是关于采样时刻本身的对齐，而不是受滤波器延迟影响的信号值。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n44100 & 1 & \\left\\lfloor \\frac{160k}{147} \\right\\rfloor\n\\end{pmatrix}\n}\n$$", "id": "2902306"}]}