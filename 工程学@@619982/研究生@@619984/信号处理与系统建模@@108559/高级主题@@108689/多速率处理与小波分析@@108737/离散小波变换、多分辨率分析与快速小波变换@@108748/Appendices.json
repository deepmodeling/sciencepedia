{"hands_on_practices": [{"introduction": "掌握快速小波变换 (FWT) 理论的最佳途径之一是亲自动手进行一次完整的计算。本练习将 FWT 的过程分解为一系列简单的步骤：使用最简洁的 Haar 小波进行滤波和下采样（分析），以及上采样和滤波（综合）。通过这种方式，您可以揭开 FWT 的神秘面纱，将复杂的数学概念转化为具体的算术操作。通过完成从分解到重建的整个流程，您将对变换的内在机制有扎实的理解，并能在一个理想的无损场景中，亲手验证完美重构 (Perfect Reconstruction, PR) 这一核心特性 [@problem_id:2866836]。", "problem": "考虑使用标准正交哈尔系统，并作为临界采样的双通道滤波器组实现的离散小波变换 (DWT)。标准正交哈尔分析滤波器为低通尺度滤波器 $h[0]=\\frac{1}{\\sqrt{2}}$, $h[1]=\\frac{1}{\\sqrt{2}}$和高通小波滤波器 $g[0]=\\frac{1}{\\sqrt{2}}$, $g[1]=-\\frac{1}{\\sqrt{2}}$。使用标准的临界采样树结构，每层进行2倍抽取，且无边界扩展（即，对于长度可被 $2^L$ 整除的序列采用成对分块），并使用相应的标准正交合成滤波器进行逆变换。设输入序列为 $x[n]=[3,1,0,4,8,6,2,0]$，其中索引 $n=0,1,\\dots,7$。\n\n任务：\n- 手动计算 $x[n]$ 的 $3$ 级哈尔DWT，以获得第3级的近似系数和第1、2、3级的细节系数。\n- 使用逆双通道标准正交哈尔滤波器组，从这些系数重构 $\\hat{x}[n]$。\n- 定义标量误差能量\n$$E=\\sum_{n=0}^{7}\\left|x[n]-\\hat{x}[n]\\right|^{2}。$$\n报告 $E$ 的值。\n\n给出 $E$ 的精确值（不要四舍五入）。无需单位。首次使用时需定义所有首字母缩略词：离散小波变换 (Discrete Wavelet Transform, DWT)、快速小波变换 (Fast Wavelet Transform, FWT)、完美重构 (Perfect Reconstruction, PR)。", "solution": "该问题要求计算一个信号的重构误差能量，该信号使用了标准正交哈尔小波基，并经过3级离散小波变换 (Discrete Wavelet Transform, DWT) 及其逆变换的处理。题目指定了临界采样的双通道滤波器组，这是快速小波变换 (Fast Wavelet Transform, FWT) 的标准结构。所考察的关键特性是完美重构 (Perfect Reconstruction, PR)，在没有任何信息损失（如量化）的情况下，这是标准正交滤波器组的一个基本特性。我们将通过显式计算正变换和逆变换，然后计算误差能量来求解。\n\n输入信号为 $x[n] = [3, 1, 0, 4, 8, 6, 2, 0]$，其中 $n \\in \\{0, 1, \\dots, 7\\}$。信号长度为 $N=8$。\n标准正交哈尔分析滤波器是低通尺度滤波器 $h[n]$ 和高通小波滤波器 $g[n]$：\n$$h[n] = \\frac{1}{\\sqrt{2}}\\delta[n] + \\frac{1}{\\sqrt{2}}\\delta[n-1]$$\n$$g[n] = \\frac{1}{\\sqrt{2}}\\delta[n] - \\frac{1}{\\sqrt{2}}\\delta[n-1]$$\nDWT的实现方式是将信号与这些滤波器进行卷积，然后进行2倍抽取。对于哈尔系统，这简化为对信号进行成对的均值和差分运算。我们将第 $j$ 级的近似系数记为 $c_j$，细节系数记为 $d_j$。输入信号为 $c_0[n] = x[n]$。\n\n**第1部分：正向DWT (分析)**\n\n**第1级分解：**\n输入为 $c_0 = [3, 1, 0, 4, 8, 6, 2, 0]$。我们成对处理样本。\n近似系数 $c_1[k]$ 计算如下：\n$c_1[0] = \\frac{c_0[0] + c_0[1]}{\\sqrt{2}} = \\frac{3+1}{\\sqrt{2}} = \\frac{4}{\\sqrt{2}} = 2\\sqrt{2}$\n$c_1[1] = \\frac{c_0[2] + c_0[3]}{\\sqrt{2}} = \\frac{0+4}{\\sqrt{2}} = \\frac{4}{\\sqrt{2}} = 2\\sqrt{2}$\n$c_1[2] = \\frac{c_0[4] + c_0[5]}{\\sqrt{2}} = \\frac{8+6}{\\sqrt{2}} = \\frac{14}{\\sqrt{2}} = 7\\sqrt{2}$\n$c_1[3] = \\frac{c_0[6] + c_0[7]}{\\sqrt{2}} = \\frac{2+0}{\\sqrt{2}} = \\frac{2}{\\sqrt{2}} = \\sqrt{2}$\n所以，$c_1 = [2\\sqrt{2}, 2\\sqrt{2}, 7\\sqrt{2}, \\sqrt{2}]$。\n\n细节系数 $d_1[k]$ 计算如下：\n$d_1[0] = \\frac{c_0[0] - c_0[1]}{\\sqrt{2}} = \\frac{3-1}{\\sqrt{2}} = \\frac{2}{\\sqrt{2}} = \\sqrt{2}$\n$d_1[1] = \\frac{c_0[2] - c_0[3]}{\\sqrt{2}} = \\frac{0-4}{\\sqrt{2}} = -\\frac{4}{\\sqrt{2}} = -2\\sqrt{2}$\n$d_1[2] = \\frac{c_0[4] - c_0[5]}{\\sqrt{2}} = \\frac{8-6}{\\sqrt{2}} = \\frac{2}{\\sqrt{2}} = \\sqrt{2}$\n$d_1[3] = \\frac{c_0[6] - c_0[7]}{\\sqrt{2}} = \\frac{2-0}{\\sqrt{2}} = \\frac{2}{\\sqrt{2}} = \\sqrt{2}$\n所以，$d_1 = [\\sqrt{2}, -2\\sqrt{2}, \\sqrt{2}, \\sqrt{2}]$。\n\n**第2级分解：**\n输入为上一级的近似系数，$c_1 = [2\\sqrt{2}, 2\\sqrt{2}, 7\\sqrt{2}, \\sqrt{2}]$。\n$c_2[0] = \\frac{c_1[0] + c_1[1]}{\\sqrt{2}} = \\frac{2\\sqrt{2} + 2\\sqrt{2}}{\\sqrt{2}} = \\frac{4\\sqrt{2}}{\\sqrt{2}} = 4$\n$c_2[1] = \\frac{c_1[2] + c_1[3]}{\\sqrt{2}} = \\frac{7\\sqrt{2} + \\sqrt{2}}{\\sqrt{2}} = \\frac{8\\sqrt{2}}{\\sqrt{2}} = 8$\n所以，$c_2 = [4, 8]$。\n\n$d_2[0] = \\frac{c_1[0] - c_1[1]}{\\sqrt{2}} = \\frac{2\\sqrt{2} - 2\\sqrt{2}}{\\sqrt{2}} = 0$\n$d_2[1] = \\frac{c_1[2] - c_1[3]}{\\sqrt{2}} = \\frac{7\\sqrt{2} - \\sqrt{2}}{\\sqrt{2}} = \\frac{6\\sqrt{2}}{\\sqrt{2}} = 6$\n所以，$d_2 = [0, 6]$。\n\n**第3级分解：**\n输入为 $c_2 = [4, 8]$。\n$c_3[0] = \\frac{c_2[0] + c_2[1]}{\\sqrt{2}} = \\frac{4+8}{\\sqrt{2}} = \\frac{12}{\\sqrt{2}} = 6\\sqrt{2}$\n所以，$c_3 = [6\\sqrt{2}]$。\n\n$d_3[0] = \\frac{c_2[0] - c_2[1]}{\\sqrt{2}} = \\frac{4-8}{\\sqrt{2}} = -\\frac{4}{\\sqrt{2}} = -2\\sqrt{2}$\n所以，$d_3 = [-2\\sqrt{2}]$。\n\n$x[n]$ 的3级DWT由 $\\{c_3, d_3, d_2, d_1\\}$ 组成。\n\n**第2部分：逆DWT (合成)**\n\n逆变换逐级重构信号。对于一个标准正交滤波器组，合成操作是分析操作的伴随操作。对于哈尔基，这可以导出简单的重构公式：\n$c_{j-1}[2k] = \\frac{c_j[k] + d_j[k]}{\\sqrt{2}}$\n$c_{j-1}[2k+1] = \\frac{c_j[k] - d_j[k]}{\\sqrt{2}}$\n我们将重构的近似系数记为 $\\hat{c}_j$。\n\n**从第3级到第2级的合成：**\n我们从 $c_3=[6\\sqrt{2}]$ 和 $d_3=[-2\\sqrt{2}]$ 重构 $\\hat{c}_2$。\n$\\hat{c}_2[0] = \\frac{c_3[0] + d_3[0]}{\\sqrt{2}} = \\frac{6\\sqrt{2} + (-2\\sqrt{2})}{\\sqrt{2}} = \\frac{4\\sqrt{2}}{\\sqrt{2}} = 4$\n$\\hat{c}_2[1] = \\frac{c_3[0] - d_3[0]}{\\sqrt{2}} = \\frac{6\\sqrt{2} - (-2\\sqrt{2})}{\\sqrt{2}} = \\frac{8\\sqrt{2}}{\\sqrt{2}} = 8$\n所以，$\\hat{c}_2 = [4, 8]$，与原始的 $c_2$ 完全相同。\n\n**从第2级到第1级的合成：**\n我们从 $\\hat{c}_2=[4, 8]$ 和 $d_2=[0, 6]$ 重构 $\\hat{c}_1$。\n对于 $k=0$:\n$\\hat{c}_1[0] = \\frac{\\hat{c}_2[0] + d_2[0]}{\\sqrt{2}} = \\frac{4+0}{\\sqrt{2}} = \\frac{4}{\\sqrt{2}} = 2\\sqrt{2}$\n$\\hat{c}_1[1] = \\frac{\\hat{c}_2[0] - d_2[0]}{\\sqrt{2}} = \\frac{4-0}{\\sqrt{2}} = \\frac{4}{\\sqrt{2}} = 2\\sqrt{2}$\n对于 $k=1$:\n$\\hat{c}_1[2] = \\frac{\\hat{c}_2[1] + d_2[1]}{\\sqrt{2}} = \\frac{8+6}{\\sqrt{2}} = \\frac{14}{\\sqrt{2}} = 7\\sqrt{2}$\n$\\hat{c}_1[3] = \\frac{\\hat{c}_2[1] - d_2[1]}{\\sqrt{2}} = \\frac{8-6}{\\sqrt{2}} = \\frac{2}{\\sqrt{2}} = \\sqrt{2}$\n所以，$\\hat{c}_1 = [2\\sqrt{2}, 2\\sqrt{2}, 7\\sqrt{2}, \\sqrt{2}]$，与原始的 $c_1$ 完全相同。\n\n**从第1级到第0级的合成：**\n我们从 $\\hat{c}_1$ 和 $d_1=[\\sqrt{2}, -2\\sqrt{2}, \\sqrt{2}, \\sqrt{2}]$ 重构最终信号 $\\hat{x}[n] = \\hat{c}_0[n]$。\n对于 $k=0$:\n$\\hat{x}[0] = \\frac{\\hat{c}_1[0] + d_1[0]}{\\sqrt{2}} = \\frac{2\\sqrt{2} + \\sqrt{2}}{\\sqrt{2}} = \\frac{3\\sqrt{2}}{\\sqrt{2}} = 3$\n$\\hat{x}[1] = \\frac{\\hat{c}_1[0] - d_1[0]}{\\sqrt{2}} = \\frac{2\\sqrt{2} - \\sqrt{2}}{\\sqrt{2}} = \\frac{\\sqrt{2}}{\\sqrt{2}} = 1$\n对于 $k=1$:\n$\\hat{x}[2] = \\frac{\\hat{c}_1[1] + d_1[1]}{\\sqrt{2}} = \\frac{2\\sqrt{2} + (-2\\sqrt{2})}{\\sqrt{2}} = 0$\n$\\hat{x}[3] = \\frac{\\hat{c}_1[1] - d_1[1]}{\\sqrt{2}} = \\frac{2\\sqrt{2} - (-2\\sqrt{2})}{\\sqrt{2}} = \\frac{4\\sqrt{2}}{\\sqrt{2}} = 4$\n对于 $k=2$:\n$\\hat{x}[4] = \\frac{\\hat{c}_1[2] + d_1[2]}{\\sqrt{2}} = \\frac{7\\sqrt{2} + \\sqrt{2}}{\\sqrt{2}} = \\frac{8\\sqrt{2}}{\\sqrt{2}} = 8$\n$\\hat{x}[5] = \\frac{\\hat{c}_1[2] - d_1[2]}{\\sqrt{2}} = \\frac{7\\sqrt{2} - \\sqrt{2}}{\\sqrt{2}} = \\frac{6\\sqrt{2}}{\\sqrt{2}} = 6$\n对于 $k=3$:\n$\\hat{x}[6] = \\frac{\\hat{c}_1[3] + d_1[3]}{\\sqrt{2}} = \\frac{\\sqrt{2} + \\sqrt{2}}{\\sqrt{2}} = \\frac{2\\sqrt{2}}{\\sqrt{2}} = 2$\n$\\hat{x}[7] = \\frac{\\hat{c}_1[3] - d_1[3]}{\\sqrt{2}} = \\frac{\\sqrt{2} - \\sqrt{2}}{\\sqrt{2}} = 0$\n重构后的信号为 $\\hat{x}[n]=[3, 1, 0, 4, 8, 6, 2, 0]$。\n\n**第3部分：误差能量计算**\n原始信号为 $x[n]=[3, 1, 0, 4, 8, 6, 2, 0]$。\n重构后的信号为 $\\hat{x}[n]=[3, 1, 0, 4, 8, 6, 2, 0]$。\n显然，对于所有 $n \\in \\{0, 1, \\dots, 7\\}$，$\\hat{x}[n] = x[n]$。\n误差信号为 $e[n] = x[n] - \\hat{x}[n] = [0, 0, 0, 0, 0, 0, 0, 0]$。\n标量误差能量 $E$ 定义为：\n$$E = \\sum_{n=0}^{7} |x[n] - \\hat{x}[n]|^2 = \\sum_{n=0}^{7} |e[n]|^2$$\n代入误差信号：\n$$E = \\sum_{n=0}^{7} |0|^2 = 0$$\n结果 $E=0$ 是符合预期的。问题设定描述了一个标准正交滤波器组，其系数在分析和合成阶段之间未经任何修改（例如量化、阈值处理）。这类系统拥有完美重构特性，意味着输出与输入完全相同，因此重构误差为零。计算结果证实了这一基本原理。", "answer": "$$\\boxed{0}$$", "id": "2866836"}, {"introduction": "理解了理想情况下的变换后，一个关键的实际问题随之而来：当滤波器长度超出有限长信号的边界时，我们该如何处理？本练习聚焦于边界处理，这是离散小波变换 (DWT) 实际应用中的一个基本挑战。您将比较两种常见的策略——补零扩展和对称扩展，并计算它们在信号边缘处产生的变换系数有何不同。完成此练习 [@problem_id:2866820] 将让您深刻认识到，“教科书式”的 DWT 在处理真实数据时需要仔细调整，而边界扩展方法的选择是一个重要的设计决策，它会直接影响后续的分析或压缩性能。", "problem": "考虑一个长度为 $N=10$ 的有限长度离散时间信号 $x[n]$，其定义为 $x[n]=n$，其中 $n\\in\\{0,1,\\dots,9\\}$。在多分辨率分析（MRA）框架内，通过快速小波变换（FWT）实现的离散小波变换（DWT）的第一级分析阶段，使用分析低通和高通有限冲激响应滤波器，然后进行因子为2的下采样。设分析低通滤波器为具有四个消失矩的 Daubechies 小波（db4），其长度为 $L=8$，抽头值（低通分析滤波器）为\n$$\nh[0]=-0.010597401785069032,\\quad h[1]=0.0328830116668852,\\quad h[2]=0.030841381835560763,\\quad h[3]=-0.18703481171888114,\n$$\n$$\nh[4]=-0.027983769416859854,\\quad h[5]=0.6308807679298587,\\quad h[6]=0.7148465705529154,\\quad h[7]=0.23037781330885523.\n$$\n相应的高通分析滤波器由正交镜像关系 $g[n]=(-1)^{n}h[L-1-n]$ 定义，但本任务中您将不需要 $g[n]$。\n\n通过下采样相关，定义第1级近似（低通）系数 $\\{a_{1}[k]\\}$ 为\n$$\na_{1}[k]=\\sum_{n=0}^{L-1}h[n]\\;x_{\\mathrm{ext}}[\\,2k+n\\,],\n$$\n其中 $x_{\\mathrm{ext}}[\\cdot]$ 是根据指定的边界规则在 $x[\\cdot]$ 的支撑集之外的延拓。设输出索引为 $k\\in\\{0,1,2,3,4\\}$。\n\n需要比较两种边界延拓规则：\n- 零延拓：当 $0\\leq n\\leq N-1$ 时，$x_{\\mathrm{Z}}[n]=x[n]$，否则 $x_{\\mathrm{Z}}[n]=0$。\n- 关于末端样本的对称延拓（边缘反射）：对于所有整数 $r\\geq 1$，定义 $x_{\\mathrm{S}}[-r]=x[r-1]$ 和 $x_{\\mathrm{S}}[N-1+r]=x[N-1-r]$。\n\n仅从上述核心定义和给定数据出发，推导在对称延拓和零延拓下最后一个近似系数之间的差值公式，即\n$$\n\\Delta \\triangleq a_{1,\\mathrm{S}}[4]-a_{1,\\mathrm{Z}}[4],\n$$\n并对其进行数值计算。将您的最终答案四舍五入到八位有效数字。不需要单位。", "solution": "目标是计算差值 $\\Delta \\triangleq a_{1,\\mathrm{S}}[4] - a_{1,\\mathrm{Z}}[4]$，其中 $a_{1,\\mathrm{S}}[k]$ 和 $a_{1,\\mathrm{Z}}[k]$ 分别是使用对称边界延拓和零边界延拓计算的第1级近似系数。\n\n近似系数的定义由下式给出：\n$$a_{1}[k] = \\sum_{n=0}^{L-1} h[n] x_{\\mathrm{ext}}[2k+n]$$\n对于特定的系数索引 $k=4$ 和滤波器长度 $L=8$，表达式为：\n$$a_{1,\\mathrm{S}}[4] = \\sum_{n=0}^{7} h[n] x_{\\mathrm{S}}[8+n]$$\n$$a_{1,\\mathrm{Z}}[4] = \\sum_{n=0}^{7} h[n] x_{\\mathrm{Z}}[8+n]$$\n因此，差值为：\n$$\\Delta = a_{1,\\mathrm{S}}[4] - a_{1,\\mathrm{Z}}[4] = \\sum_{n=0}^{7} h[n] \\left( x_{\\mathrm{S}}[8+n] - x_{\\mathrm{Z}}[8+n] \\right)$$\n为计算该表达式，我们必须首先确定延拓信号 $x_{\\mathrm{S}}[m]$ 和 $x_{\\mathrm{Z}}[m]$ 在所需索引范围 $m=8+n$ 上的值，其中 $n \\in \\{0, \\dots, 7\\}$。这对应于索引 $m \\in \\{8, 9, \\dots, 15\\}$。\n\n原始信号为 $x[n]=n$，其中 $n \\in \\{0, 1, \\dots, 9\\}$，长度 $N=10$。\n\n首先，考虑零延拓规则 $x_{\\mathrm{Z}}[n]$。对于原始信号支撑集内的索引，$x_{\\mathrm{Z}}[n] = x[n]$。对于支撑集外的索引，$x_{\\mathrm{Z}}[n] = 0$。\n- $x_{\\mathrm{Z}}[8] = x[8] = 8$\n- $x_{\\mathrm{Z}}[9] = x[9] = 9$\n- $x_{\\mathrm{Z}}[10] = 0$\n- $x_{\\mathrm{Z}}[11] = 0$\n- $x_{\\mathrm{Z}}[12] = 0$\n- $x_{\\mathrm{Z}}[13] = 0$\n- $x_{\\mathrm{Z}}[14] = 0$\n- $x_{\\mathrm{Z}}[15] = 0$\n\n接下来，考虑对称延拓规则 $x_{\\mathrm{S}}[n]$。问题提供了超出右边界（$n > N-1$）的延拓公式，即对于 $r \\geq 1$，$x_{\\mathrm{S}}[N-1+r] = x[N-1-r]$。对于 $N=10$，我们有 $N-1=9$。\n- $x_{\\mathrm{S}}[8] = x[8] = 8$（索引在支撑集内）\n- $x_{\\mathrm{S}}[9] = x[9] = 9$（索引在支撑集内）\n- 对于 $m=10$，我们有 $10=9+1$，因此 $r=1$。$x_{\\mathrm{S}}[10] = x[9-1] = x[8] = 8$。\n- 对于 $m=11$，我们有 $11=9+2$，因此 $r=2$。$x_{\\mathrm{S}}[11] = x[9-2] = x[7] = 7$。\n- 对于 $m=12$，我们有 $12=9+3$，因此 $r=3$。$x_{\\mathrm{S}}[12] = x[9-3] = x[6] = 6$。\n- 对于 $m=13$，我们有 $13=9+4$，因此 $r=4$。$x_{\\mathrm{S}}[13] = x[9-4] = x[5] = 5$。\n- 对于 $m=14$，我们有 $14=9+5$，因此 $r=5$。$x_{\\mathrm{S}}[14] = x[9-5] = x[4] = 4$。\n- 对于 $m=15$，我们有 $15=9+6$，因此 $r=6$。$x_{\\mathrm{S}}[15] = x[9-6] = x[3] = 3$。\n\n现在我们可以计算对于 $n=0, \\dots, 7$ 的差值 $(x_{\\mathrm{S}}[8+n] - x_{\\mathrm{Z}}[8+n])$：\n- $n=0$: $x_{\\mathrm{S}}[8] - x_{\\mathrm{Z}}[8] = 8 - 8 = 0$\n- $n=1$: $x_{\\mathrm{S}}[9] - x_{\\mathrm{Z}}[9] = 9 - 9 = 0$\n- $n=2$: $x_{\\mathrm{S}}[10] - x_{\\mathrm{Z}}[10] = 8 - 0 = 8$\n- $n=3$: $x_{\\mathrm{S}}[11] - x_{\\mathrm{Z}}[11] = 7 - 0 = 7$\n- $n=4$: $x_{\\mathrm{S}}[12] - x_{\\mathrm{Z}}[12] = 6 - 0 = 6$\n- $n=5$: $x_{\\mathrm{S}}[13] - x_{\\mathrm{Z}}[13] = 5 - 0 = 5$\n- $n=6$: $x_{\\mathrm{S}}[14] - x_{\\mathrm{Z}}[14] = 4 - 0 = 4$\n- $n=7$: $x_{\\mathrm{S}}[15] - x_{\\mathrm{Z}}[15] = 3 - 0 = 3$\n\n$\\Delta$ 的求和中，仅当 $n \\in \\{2, 3, 4, 5, 6, 7\\}$ 时项非零：\n$$\\Delta = h[2] \\cdot 8 + h[3] \\cdot 7 + h[4] \\cdot 6 + h[5] \\cdot 5 + h[6] \\cdot 4 + h[7] \\cdot 3$$\n代入给定的滤波器系数值：\n$$\n\\begin{aligned}\n\\Delta = &(0.030841381835560763 \\times 8) + (-0.18703481171888114 \\times 7) + \\\\\n&(-0.027983769416859854 \\times 6) + (0.6308807679298587 \\times 5) + \\\\\n&(0.7148465705529154 \\times 4) + (0.23037781330885523 \\times 3)\n\\end{aligned}\n$$\n执行算术运算：\n$$\n\\begin{aligned}\n\\Delta = &0.2467310546844861 - 1.3092436820321680 + \\\\\n&-0.1679026165011591 + 3.1544038396492935 + \\\\\n&2.8593862822116616 + 0.6911334399265657\n\\end{aligned}\n$$\n将这些项相加得出：\n$$\\Delta \\approx 5.4745083179386798$$\n问题要求最终答案四舍五入到八位有效数字。前八位有效数字是 $5.4745083$。第九位有效数字是 $1$，因此我们不向上取整。\n$$\\Delta \\approx 5.4745083$$", "answer": "$$\\boxed{5.4745083}$$", "id": "2866820"}, {"introduction": "传统 FWT 依赖于卷积运算，而提升方案 (lifting scheme) 则提供了一种更现代、计算效率更高的实现方式，它将小波变换重构为一系列“预测”和“更新”步骤。这个高级练习将指导您实现广泛应用的 CDF 5/3 小波的提升方案。您首先需要从基本原理出发推导出提升系数，然后将其应用于整数到整数的变换中，这对于无损数据压缩至关重要。通过实践提升方案 [@problem_id:2866808]，您不仅能学到一种构建和应用小波的强大而灵活的方法，还能深入了解如何设计一种能将整数映射到整数的变换，这正是无损图像压缩（如 JPEG2000）等应用的核心要求。", "problem": "考虑与 Cohen-Daubechies-Feauveau (CDF) 族相关的双正交双通道完美重构滤波器组，该滤波器组作用于一个离散时间实值有限能量信号 $x[n]$。在提升框架下进行分析，并使用以下基本原理：\n\n- 双通道滤波器组的多相表示，以及任何可逆多相矩阵可以分解为一系列行列式等于 $1$ 的基本上三角和下三角提升步。\n- 分析高通滤波器的消失矩定义：对于任何阶数低于消失矩阶数的多项式输入，高通分支的输出恒为零。\n- 提升分解的完美重构条件：每个基本提升步都是可逆的，因此它们的复合构成一个全局可逆的变换。\n\n已知 CDF $5/3$ 双正交小波变换可以通过一个最近邻预测步和一个最近邻更新步来实现，其提升系数为有理数。设多相分裂为奇偶分解 $s_{\\mathrm{e}}[i] = x[2i]$ 和 $s_{\\mathrm{o}}[i] = x[2i+1]$，$i \\in \\mathbb{Z}$。假设有一个预测步\n$$\nd[i] \\leftarrow s_{\\mathrm{o}}[i] + \\alpha\\big(s_{\\mathrm{e}}[i] + s_{\\mathrm{e}}[i+1]\\big),\n$$\n后跟一个更新步\n$$\ns[i] \\leftarrow s_{\\mathrm{e}}[i] + \\beta\\big(d[i-1] + d[i]\\big),\n$$\n其中 $\\alpha$ 和 $\\beta$ 为未知的有理数。假设等效分析滤波器具有半采样点对称性，以及与 CDF $5/3$ 命名一致的最小有限支撑。\n\n任务：\n\n1) 从上述第一性原理出发，确定实现 CDF $5/3$ 分解的唯一有理数对 $\\alpha$ 和 $\\beta$，其约束条件为：分析高通滤波器至少有一个消失矩，分析低通滤波器是 $5$ 抽头对称的，分析高通滤波器是 $3$ 抽头对称的。\n\n2) 使用这些提升系数，通过指定并应用可逆性所需的取整运算，实现一轮整数到整数版本的变换。在分裂序列 $s_{\\mathrm{e}}[i]$ 和 $s_{\\mathrm{o}}[i]$ 的层面上使用对称边界扩展：\n- 在预测步中，当 $s_{\\mathrm{e}}[i+1]$ 超出范围时，用 $s_{\\mathrm{e}}[i]$ 替代。\n- 在更新步中，当 $d[i-1]$ 超出范围时，用 $d[i]$ 替代；当 $d[i]$ 超出范围时，用 $d[i-1]$ 替代。\n\n对于整数到整数的映射，对整数分量应用以下取整算子：\n- 在预测步中，通过精确平均值的向下取整实现除以 $2$ 的运算：对于任意整数 $a$ 和 $b$，\n$$\n\\left\\lfloor \\frac{a+b}{2} \\right\\rfloor.\n$$\n- 在更新步中，通过\n$$\n\\left\\lfloor \\frac{u+2}{4} \\right\\rfloor\n$$\n实现四舍五入到最近整数的除以 $4$ 的运算，其中 $u$ 为任意整数。\n\n将此变换应用于由下式给出的长度为 $12$ 的序列 $x[n]$\n$$\nx[0..11] = \\big(7,\\;5,\\;3,\\;9,\\;4,\\;8,\\;10,\\;6,\\;1,\\;0,\\;-2,\\;3\\big).\n$$\n\n将首先按 $i$ 递增顺序排列的所有粗尺度近似系数 $s[i]$，然后是按 $i$ 递增顺序排列的所有细节系数 $d[i]$ 拼接起来，得到的 $12$ 元组作为最终答案。将最终答案表示为单个行向量。由于结果是整数，因此无需四舍五入到有效数字。不涉及物理单位。", "solution": "**第1部分：确定提升系数 $\\alpha$ 和 $\\beta$**\n\n我们必须首先根据给定的提升步确定分析滤波器 $h_0[n]$（低通）和 $h_1[n]$（高通）的脉冲响应。这些滤波器的输出经过因子为 $2$ 的下采样后，即为近似系数 $s[i]$ 和细节系数 $d[i]$。\n\n细节系数 $d[i]$ 是高通滤波器 $h_1[n]$ 作用于输入信号 $x[n]$ 后的抽取输出。预测步由下式给出：\n$$d[i] = s_{\\mathrm{o}}[i] + \\alpha\\big(s_{\\mathrm{e}}[i] + s_{\\mathrm{e}}[i+1]\\big) = x[2i+1] + \\alpha\\big(x[2i] + x[2i+2]\\big)$$\n该表达式表示滤波器 $h_1[n]$ 与 $x[n]$ 卷积后在时间 $n=2i+1$ 处的值。令 $y_1[n] = (x * h_1)[n] = \\sum_k h_1[k] x[n-k]$。则 $d[i]=y_1[2i+1]$。\n$$d[i] = \\sum_k h_1[k] x[2i+1-k]$$\n通过比较 $d[i]$ 的两个表达式，我们可确定 $h_1[k]$ 的非零系数：\n- 对于 $k=0$，我们有 $h_1[0]x[2i+1]$，所以 $h_1[0]=1$。\n- 对于 $k=1$，我们有 $h_1[1]x[2i]$，所以 $h_1[1]=\\alpha$。\n- 对于 $k=-1$，我们有 $h_1[-1]x[2i+2]$，所以 $h_1[-1]=\\alpha$。\n因此，分析高通滤波器为 $h_1[n] = \\alpha \\delta[n+1] + \\delta[n] + \\alpha \\delta[n-1]$。该滤波器系数为 $(\\alpha, 1, \\alpha)$，是一个 $3$ 抽头对称滤波器，满足给定的约束之一。\n\n该滤波器的 $Z$ 变换为 $H_1(z) = \\alpha z + 1 + \\alpha z^{-1}$。\n分析高通滤波器至少有一个消失矩的约束意味着其传递函数在 $z=1$ 处必须有一个零点（即，它能消除直流信号）。\n$$H_1(1) = \\alpha(1) + 1 + \\alpha(1)^{-1} = 2\\alpha + 1 = 0$$\n解出 $\\alpha$ 得到唯一的有理数值：\n$$\\alpha = -\\frac{1}{2}$$\n\n接下来，我们确定分析低通滤波器 $h_0[n]$。近似系数 $s[i]$ 由更新步给出：\n$$s[i] = s_{\\mathrm{e}}[i] + \\beta\\big(d[i-1] + d[i]\\big) = x[2i] + \\beta\\big(d[i-1] + d[i]\\big)$$\n将 $d[i]$ 的表达式代入 $s[i]$ 的方程中：\n$$s[i] = x[2i] + \\beta \\Big( \\big(x[2(i-1)+1] + \\alpha(x[2(i-1)] + x[2(i-1)+2])\\big) + \\big(x[2i+1] + \\alpha(x[2i] + x[2i+2])\\big) \\Big)$$\n$$s[i] = x[2i] + \\beta \\Big( x[2i-1] + \\alpha x[2i-2] + \\alpha x[2i] + x[2i+1] + \\alpha x[2i] + \\alpha x[2i+2] \\Big)$$\n按 $x[n]$ 分组各项：\n$$s[i] = \\alpha\\beta x[2i+2] + \\beta x[2i+1] + (1+2\\alpha\\beta)x[2i] + \\beta x[2i-1] + \\alpha\\beta x[2i-2]$$\n该表达式表示滤波器 $h_0[n]$ 与 $x[n]$ 卷积后在时间 $n=2i$ 处的值。令 $y_0[n] = (x * h_0)[n] = \\sum_k h_0[k] x[n-k]$。则 $s[i]=y_0[2i]$。\n$$s[i] = \\sum_k h_0[k] x[2i-k]$$\n通过比较 $s[i]$ 的两个表达式，我们可确定 $h_0[k]$ 的非零系数：\n- $k=-2$: $h_0[-2] = \\alpha\\beta$\n- $k=-1$: $h_0[-1] = \\beta$\n- $k=0$: $h_0[0] = 1+2\\alpha\\beta$\n- $k=1$: $h_0[1] = \\beta$\n- $k=2$: $h_0[2] = \\alpha\\beta$\n滤波器 $h_0[n]$ 的系数为 $(\\alpha\\beta, \\beta, 1+2\\alpha\\beta, \\beta, \\alpha\\beta)$，是一个 $5$ 抽头对称滤波器，满足给定的另一约束。\n\n为了确定 $\\beta$，我们必须引用多分辨率分解中低通滤波器的一个隐含属性。低通滤波器不仅应通过低频信号，还应抑制高频信号。最高的数字频率对应于 $z=-1$。因此，我们施加条件，要求 $H_0(z)$ 在 $z=-1$ 处有一个零点。\n$h_0[n]$ 的 $Z$ 变换为 $H_0(z) = \\alpha\\beta z^2 + \\beta z + (1+2\\alpha\\beta) + \\beta z^{-1} + \\alpha\\beta z^{-2}$。\n设 $H_0(-1)=0$：\n$$H_0(-1) = \\alpha\\beta(-1)^2 + \\beta(-1) + (1+2\\alpha\\beta) + \\beta(-1)^{-1} + \\alpha\\beta(-1)^{-2} = 0$$\n$$\\alpha\\beta - \\beta + 1 + 2\\alpha\\beta - \\beta + \\alpha\\beta = 0$$\n$$4\\alpha\\beta - 2\\beta + 1 = 0$$\n代入 $\\alpha = -1/2$：\n$$4\\left(-\\frac{1}{2}\\right)\\beta - 2\\beta + 1 = 0$$\n$$-2\\beta - 2\\beta + 1 = 0$$\n$$-4\\beta + 1 = 0$$\n解出 $\\beta$ 得到唯一的有理数值：\n$$\\beta = \\frac{1}{4}$$\n唯一的有理数对是 $(\\alpha, \\beta) = (-1/2, 1/4)$。\n\n**第2部分：应用整数到整数变换**\n\n输入信号为 $x = \\big(7, 5, 3, 9, 4, 8, 10, 6, 1, 0, -2, 3\\big)$。长度为 $N=12$。\n首先，我们进行奇偶分裂：\n$s_{\\mathrm{e}} = (x[0], x[2], x[4], x[6], x[8], x[10]) = \\big(7, 3, 4, 10, 1, -2\\big)$。\n$s_{\\mathrm{o}} = (x[1], x[3], x[5], x[7], x[9], x[11]) = \\big(5, 9, 8, 6, 0, 3\\big)$。\n\n接下来，我们使用推导出的系数和指定的整数运算法则来应用提升步。\n提升方程变为：\n预测：$d[i] = s_{\\mathrm{o}}[i] - \\left\\lfloor \\frac{s_{\\mathrm{e}}[i] + s_{\\mathrm{e}}[i+1]}{2} \\right\\rfloor$\n更新：$s[i] = s_{\\mathrm{e}}[i] + \\left\\lfloor \\frac{d[i-1] + d[i] + 2}{4} \\right\\rfloor$\n\n**计算细节系数 $d[i]$（$i=0, \\dots, 5$）：**\n- $i=0$: $d[0] = s_{\\mathrm{o}}[0] - \\lfloor \\frac{s_{\\mathrm{e}}[0] + s_{\\mathrm{e}}[1]}{2} \\rfloor = 5 - \\lfloor \\frac{7+3}{2} \\rfloor = 5 - 5 = 0$。\n- $i=1$: $d[1] = s_{\\mathrm{o}}[1] - \\lfloor \\frac{s_{\\mathrm{e}}[1] + s_{\\mathrm{e}}[2]}{2} \\rfloor = 9 - \\lfloor \\frac{3+4}{2} \\rfloor = 9 - \\lfloor 3.5 \\rfloor = 9 - 3 = 6$。\n- $i=2$: $d[2] = s_{\\mathrm{o}}[2] - \\lfloor \\frac{s_{\\mathrm{e}}[2] + s_{\\mathrm{e}}[3]}{2} \\rfloor = 8 - \\lfloor \\frac{4+10}{2} \\rfloor = 8 - 7 = 1$。\n- $i=3$: $d[3] = s_{\\mathrm{o}}[3] - \\lfloor \\frac{s_{\\mathrm{e}}[3] + s_{\\mathrm{e}}[4]}{2} \\rfloor = 6 - \\lfloor \\frac{10+1}{2} \\rfloor = 6 - \\lfloor 5.5 \\rfloor = 6 - 5 = 1$。\n- $i=4$: $d[4] = s_{\\mathrm{o}}[4] - \\lfloor \\frac{s_{\\mathrm{e}}[4] + s_{\\mathrm{e}}[5]}{2} \\rfloor = 0 - \\lfloor \\frac{1+(-2)}{2} \\rfloor = 0 - \\lfloor -0.5 \\rfloor = 0 - (-1) = 1$。\n- $i=5$: 索引 $i+1=6$ 对 $s_{\\mathrm{e}}$ 超出范围。根据边界规则，$s_{\\mathrm{e}}[6]$ 由 $s_{\\mathrm{e}}[5]$ 替代。\n$d[5] = s_{\\mathrm{o}}[5] - \\lfloor \\frac{s_{\\mathrm{e}}[5] + s_{\\mathrm{e}}[5]}{2} \\rfloor = 3 - \\lfloor \\frac{-2+(-2)}{2} \\rfloor = 3 - (-2) = 5$。\n细节系数为 $d = \\big(0, 6, 1, 1, 1, 5\\big)$。\n\n**计算近似系数 $s[i]$（$i=0, \\dots, 5$）：**\n- $i=0$: 索引 $i-1=-1$ 对 $d$ 超出范围。根据边界规则，$d[-1]$ 由 $d[0]$ 替代。\n$s[0] = s_{\\mathrm{e}}[0] + \\lfloor \\frac{d[0] + d[0] + 2}{4} \\rfloor = 7 + \\lfloor \\frac{0+0+2}{4} \\rfloor = 7 + \\lfloor 0.5 \\rfloor = 7 + 0 = 7$。\n- $i=1$: $s[1] = s_{\\mathrm{e}}[1] + \\lfloor \\frac{d[0] + d[1] + 2}{4} \\rfloor = 3 + \\lfloor \\frac{0+6+2}{4} \\rfloor = 3 + \\lfloor 2 \\rfloor = 3 + 2 = 5$。\n- $i=2$: $s[2] = s_{\\mathrm{e}}[2] + \\lfloor \\frac{d[1] + d[2] + 2}{4} \\rfloor = 4 + \\lfloor \\frac{6+1+2}{4} \\rfloor = 4 + \\lfloor 2.25 \\rfloor = 4 + 2 = 6$。\n- $i=3$: $s[3] = s_{\\mathrm{e}}[3] + \\lfloor \\frac{d[2] + d[3] + 2}{4} \\rfloor = 10 + \\lfloor \\frac{1+1+2}{4} \\rfloor = 10 + \\lfloor 1 \\rfloor = 10 + 1 = 11$。\n- $i=4$: $s[4] = s_{\\mathrm{e}}[4] + \\lfloor \\frac{d[3] + d[4] + 2}{4} \\rfloor = 1 + \\lfloor \\frac{1+1+2}{4} \\rfloor = 1 + \\lfloor 1 \\rfloor = 1 + 1 = 2$。\n- $i=5$: $s[5] = s_{\\mathrm{e}}[5] + \\lfloor \\frac{d[4] + d[5] + 2}{4} \\rfloor = -2 + \\lfloor \\frac{1+5+2}{4} \\rfloor = -2 + \\lfloor 2 \\rfloor = -2 + 2 = 0$。\n近似系数为 $s = \\big(7, 5, 6, 11, 2, 0\\big)$。\n\n最后，变换的输出是先拼接近似系数 $s[i]$，再拼接细节系数 $d[i]$ 的结果。\n结果：一个 $12$ 元组 $\\big(s[0..5], d[0..5]\\big)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n7 & 5 & 6 & 11 & 2 & 0 & 0 & 6 & 1 & 1 & 1 & 5\n\\end{pmatrix}\n}\n$$", "id": "2866808"}]}