{"hands_on_practices": [{"introduction": "本练习将引导你完成一个基础但至关重要的计算：对一个高斯信号应用连续小波变换 (CWT)。通过使用著名的墨西哥帽小波（高斯函数的二阶导数），你将亲手实践 CWT 的定义，并推导出变换结果的解析表达式 [@problem_id:2860051]。这个过程不仅能加深你对 CWT 工作机理的理解，还能让你体会到母小波的“可容许性”条件（如零均值）在实际计算中的作用。", "problem": "考虑 $\\mathbb{R}$ 上的实母小波 $\\psi(t) = \\left(1 - t^{2}\\right)\\exp\\!\\left(-\\frac{t^{2}}{2}\\right)$。从连续小波变换 (CWT) 的定义出发，对于一个平方可积信号 $x(t)$、尺度 $a>0$ 和平移 $b\\in\\mathbb{R}$，其定义为\n$$\nW_{x}(a,b) \\triangleq \\int_{-\\infty}^{\\infty} x(t)\\,\\frac{1}{\\sqrt{a}}\\,\\psi\\!\\left(\\frac{t-b}{a}\\right)\\,dt.\n$$\n仅使用基本定义、高斯积分的标准性质和第一性原理推导，完成以下任务：\n- 证明 $\\psi$ 具有零均值且平方可积，因此在 CWT 意义下可作为母小波。\n- 对于信号 $x(t) = \\exp\\!\\left(-\\frac{t^{2}}{2\\beta^{2}}\\right)$（参数 $\\beta>0$），推导 $W_{x}(a,b)$ 作为 $a>0$、$b\\in\\mathbb{R}$ 和 $\\beta>0$ 的函数的闭式解析表达式。\n\n你的最终答案必须是关于 $a$、$b$、$\\beta$ 和普适常数的单个闭式解析表达式。不要近似或四舍五入。不需要单位。", "solution": "在尝试任何解答之前，必须首先对问题陈述进行严格的验证。\n\n首先，我们逐字提取给定的条件。\n- 母小波：$\\mathbb{R}$ 上的 $\\psi(t) = \\left(1 - t^{2}\\right)\\exp\\!\\left(-\\frac{t^{2}}{2}\\right)$。\n- 对于信号 $x(t)$、尺度 $a>0$、平移 $b\\in\\mathbb{R}$ 的 CWT 定义：$W_{x}(a,b) \\triangleq \\int_{-\\infty}^{\\infty} x(t)\\,\\frac{1}{\\sqrt{a}}\\,\\psi\\!\\left(\\frac{t-b}{a}\\right)\\,dt$。\n- 信号：$x(t) = \\exp\\!\\left(-\\frac{t^{2}}{2\\beta^{2}}\\right)$，参数 $\\beta>0$。\n- 任务：$1$. 证明 $\\psi(t)$ 具有零均值且平方可积。$2$. 推导 $W_{x}(a,b)$ 的闭式解析表达式。\n\n现在，我们根据基本准则验证这些给定条件。\n- **科学基础**：该问题属于信号处理的标准数学理论范畴。连续小波变换、特定的母小波（与高斯函数的二阶导数成比例，称为 Ricker 小波或“墨西哥帽”小波）以及高斯信号都是标准的、定义明确的概念。该问题在科学上和数学上是合理的。\n- **良定性**：问题表述清晰。所涉及的函数 $\\psi(t)$ 和 $x(t)$ 是光滑且快速衰减的，确保了所需积分的收敛性。预期会有一个唯一、稳定且有意义的解。\n- **客观性与完备性**：问题使用精确、客观的数学语言陈述。所有必要的定义和参数都已提供。没有歧义、矛盾或信息缺失。\n\n结论是该问题是**有效的**。我们可以继续进行解答。根据要求，解答包含两个部分。\n\n第一部分：证明 $\\psi(t)$ 是一个可容许的母小波\n一个实值函数 $\\psi(t)$ 若要成为一个可容许的母小波，必须满足两个主要条件：它必须具有零均值（容许性条件）并且是平方可积的（能量有限）。\n\n1.  **零均值条件**：我们必须证明 $\\int_{-\\infty}^{\\infty} \\psi(t) \\, dt = 0$。\n    给定 $\\psi(t) = (1 - t^{2}) \\exp(-t^{2}/2)$。我们定义一个标准高斯函数 $g(t) = \\exp(-t^{2}/2)$。\n    $g(t)$ 的一阶导数是 $g'(t) = -t \\exp(-t^{2}/2)$。\n    二阶导数是 $g''(t) = \\frac{d}{dt}(-t \\exp(-t^{2}/2)) = -1 \\cdot \\exp(-t^{2}/2) + (-t)(-t \\exp(-t^{2}/2)) = (t^{2} - 1) \\exp(-t^{2}/2)$。\n    通过观察，我们发现 $\\psi(t) = -g''(t)$。\n    因此，均值的积分为 $\\int_{-\\infty}^{\\infty} \\psi(t) \\, dt = -\\int_{-\\infty}^{\\infty} g''(t) \\, dt$。\n    根据微积分基本定理，这等于 $-[g'(t)]_{-\\infty}^{\\infty} = -[-t \\exp(-t^{2}/2)]_{-\\infty}^{\\infty}$。\n    我们计算边界项：$\\lim_{t \\to \\pm\\infty} (-t \\exp(-t^{2}/2))$。由于指数函数的快速衰减，此极限在正无穷和负无穷处均为 $0$。\n    因此，积分为 $-(0 - 0) = 0$。零均值条件得到满足。\n\n2.  **平方可积性条件**：我们必须证明 $\\int_{-\\infty}^{\\infty} |\\psi(t)|^{2} \\, dt < \\infty$。\n    由于 $\\psi(t)$ 是一个实函数，我们计算其平方的积分：\n    $\\int_{-\\infty}^{\\infty} \\psi(t)^{2} \\, dt = \\int_{-\\infty}^{\\infty} \\left((1 - t^{2})\\exp(-t^{2}/2)\\right)^{2} \\, dt = \\int_{-\\infty}^{\\infty} (1 - 2t^{2} + t^{4}) \\exp(-t^{2}) \\, dt$。\n    我们可以通过使用标准高斯积分公式 $\\int_{-\\infty}^{\\infty} \\exp(-cx^{2}) \\, dx = \\sqrt{\\pi/c}$ 及其相关形式来求解。对于 $c=1$：\n    $\\int_{-\\infty}^{\\infty} \\exp(-t^{2}) \\, dt = \\sqrt{\\pi}$。\n    $\\int_{-\\infty}^{\\infty} t^{2} \\exp(-t^{2}) \\, dt = - \\frac{d}{dc} \\left[ \\int_{-\\infty}^{\\infty} \\exp(-ct^{2}) \\, dt \\right]_{c=1} = - \\frac{d}{dc} [\\sqrt{\\pi} c^{-1/2}]_{c=1} = -\\sqrt{\\pi}(-\\frac{1}{2})c^{-3/2}|_{c=1} = \\frac{\\sqrt{\\pi}}{2}$。\n    $\\int_{-\\infty}^{\\infty} t^{4} \\exp(-t^{2}) \\, dt = \\frac{d^2}{dc^2} \\left[ \\int_{-\\infty}^{\\infty} \\exp(-ct^{2}) \\, dt \\right]_{c=1} = \\frac{d^2}{dc^2} [\\sqrt{\\pi} c^{-1/2}]_{c=1} = \\sqrt{\\pi}(\\frac{3}{4})c^{-5/2}|_{c=1} = \\frac{3\\sqrt{\\pi}}{4}$。\n    因此，总积分为 $\\sqrt{\\pi} - 2(\\frac{\\sqrt{\\pi}}{2}) + \\frac{3\\sqrt{\\pi}}{4} = \\sqrt{\\pi} - \\sqrt{\\pi} + \\frac{3\\sqrt{\\pi}}{4} = \\frac{3\\sqrt{\\pi}}{4}$。\n    由于此值为有限，$\\psi(t)$ 是平方可积的。两个条件都满足，因此 $\\psi(t)$ 是一个可容许的母小波。\n\n第二部分：CWT $W_{x}(a,b)$ 的推导\n我们从 CWT 的定义开始，并代入给定的函数：\n$$W_{x}(a,b) = \\frac{1}{\\sqrt{a}} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{t^{2}}{2\\beta^{2}}\\right) \\left(1 - \\left(\\frac{t-b}{a}\\right)^{2}\\right) \\exp\\left(-\\frac{1}{2}\\left(\\frac{t-b}{a}\\right)^{2}\\right) dt$$\n两个指数函数的乘积的指数为：\n$$E(t) = -\\frac{t^{2}}{2\\beta^{2}} - \\frac{(t-b)^{2}}{2a^{2}} = -\\frac{1}{2}\\left[ \\left(\\frac{1}{\\beta^{2}}+\\frac{1}{a^{2}}\\right)t^{2} - \\frac{2b}{a^{2}}t + \\frac{b^{2}}{a^{2}} \\right]$$\n我们对 $t$ 的二次多项式进行配方。括号中的项可以写成 $A(t-t_{0})^{2} + K$。\n$t^{2}$ 的系数是 $A = \\frac{1}{\\beta^{2}}+\\frac{1}{a^{2}} = \\frac{a^{2}+\\beta^{2}}{a^{2}\\beta^{2}}$。\n新高斯函数的中心是 $t_{0} = \\frac{b/a^{2}}{A} = \\frac{b/a^{2}}{(a^{2}+\\beta^{2})/(a^{2}\\beta^{2})} = \\frac{b\\beta^{2}}{a^{2}+\\beta^{2}}$。\n常数项是 $K = \\frac{b^{2}}{a^{2}} - At_{0}^{2} = \\frac{b^{2}}{a^{2}} - \\frac{a^{2}+\\beta^{2}}{a^{2}\\beta^{2}}\\left(\\frac{b\\beta^{2}}{a^{2}+\\beta^{2}}\\right)^{2} = \\frac{b^{2}}{a^{2}} - \\frac{b^{2}\\beta^{2}}{a^{2}(a^{2}+\\beta^{2})} = \\frac{b^{2}(a^{2}+\\beta^{2}) - b^{2}\\beta^{2}}{a^{2}(a^{2}+\\beta^{2})} = \\frac{b^{2}}{a^{2}+\\beta^{2}}$。\n指数变为 $E(t) = -\\frac{1}{2}\\left[A(t-t_{0})^{2} + K\\right] = -\\frac{a^{2}+\\beta^{2}}{2a^{2}\\beta^{2}}(t-t_{0})^{2} - \\frac{b^{2}}{2(a^{2}+\\beta^{2})}$。\n我们定义 $\\sigma^{2} = \\frac{a^{2}\\beta^{2}}{a^{2}+\\beta^{2}}$，所以指数的第一部分是 $-\\frac{(t-t_{0})^{2}}{2\\sigma^{2}}$。\nCWT 积分现在可以分离为一个常数指数因子和一个积分 $\\mathcal{I}$：\n$$W_{x}(a,b) = \\frac{1}{\\sqrt{a}} \\exp\\left(-\\frac{b^{2}}{2(a^{2}+\\beta^{2})}\\right) \\mathcal{I}$$\n其中 $\\mathcal{I} = \\int_{-\\infty}^{\\infty} \\left(1 - \\frac{(t-b)^{2}}{a^{2}}\\right) \\exp\\left(-\\frac{(t-t_{0})^{2}}{2\\sigma^{2}}\\right) dt$。\n令 $u = t-t_{0}$，则 $t = u+t_{0}$ 且 $dt=du$。项 $t-b$ 变为 $u+t_{0}-b$。\n我们求得 $t_{0}-b = \\frac{b\\beta^{2}}{a^{2}+\\beta^{2}} - b = \\frac{b\\beta^{2}-b(a^{2}+\\beta^{2})}{a^{2}+\\beta^{2}} = -\\frac{ba^{2}}{a^{2}+\\beta^{2}}$。\n所以，$(t-b)^{2} = (u - \\frac{ba^{2}}{a^{2}+\\beta^{2}})^{2} = u^{2} - \\frac{2uba^{2}}{a^{2}+\\beta^{2}} + \\frac{b^{2}a^{4}}{(a^{2}+\\beta^{2})^{2}}$。\n被积函数的前置因子变为 $1 - \\frac{1}{a^{2}}\\left(u^{2} - \\frac{2uba^{2}}{a^{2}+\\beta^{2}} + \\frac{b^{2}a^{4}}{(a^{2}+\\beta^{2})^{2}}\\right) = 1 - \\frac{u^{2}}{a^{2}} + \\frac{2bu}{a^{2}+\\beta^{2}} - \\frac{b^{2}a^{2}}{(a^{2}+\\beta^{2})^{2}}$。\n积分 $\\mathcal{I}$ 是：\n$$\\mathcal{I} = \\int_{-\\infty}^{\\infty} \\left(1 - \\frac{b^{2}a^{2}}{(a^{2}+\\beta^{2})^{2}}\\right)\\exp\\left(-\\frac{u^{2}}{2\\sigma^{2}}\\right)du - \\frac{1}{a^{2}}\\int_{-\\infty}^{\\infty} u^{2}\\exp\\left(-\\frac{u^{2}}{2\\sigma^{2}}\\right)du + \\frac{2b}{a^{2}+\\beta^{2}}\\int_{-\\infty}^{\\infty} u\\exp\\left(-\\frac{u^{2}}{2\\sigma^{2}}\\right)du$$\n这些是标准积分：$\\int \\exp(-\\frac{u^{2}}{2\\sigma^{2}})du = \\sqrt{2\\pi\\sigma^{2}}$、$\\int u \\exp(...)du=0$ 以及 $\\int u^{2}\\exp(...)du = \\sigma^{2}\\sqrt{2\\pi\\sigma^{2}}$。\n$$\\mathcal{I} = \\left(1 - \\frac{b^{2}a^{2}}{(a^{2}+\\beta^{2})^{2}}\\right)\\sqrt{2\\pi}\\sigma - \\frac{1}{a^{2}}(\\sigma^{2}\\sqrt{2\\pi}\\sigma) + 0 = \\sqrt{2\\pi}\\sigma \\left(1 - \\frac{b^{2}a^{2}}{(a^{2}+\\beta^{2})^{2}} - \\frac{\\sigma^{2}}{a^{2}}\\right)$$\n代入 $\\frac{\\sigma^{2}}{a^{2}} = \\frac{\\beta^{2}}{a^{2}+\\beta^{2}}$：\n$$\\mathcal{I} = \\sqrt{2\\pi}\\sigma \\left( \\frac{a^{2}+\\beta^{2}-\\beta^{2}}{a^{2}+\\beta^{2}} - \\frac{b^{2}a^{2}}{(a^{2}+\\beta^{2})^{2}} \\right) = \\sqrt{2\\pi}\\sigma \\left( \\frac{a^{2}}{a^{2}+\\beta^{2}} - \\frac{b^{2}a^{2}}{(a^{2}+\\beta^{2})^{2}} \\right)$$\n$$\\mathcal{I} = \\sqrt{2\\pi}\\sigma \\frac{a^{2}(a^{2}+\\beta^{2}) - b^{2}a^{2}}{(a^{2}+\\beta^{2})^{2}} = \\sqrt{2\\pi}\\sigma \\frac{a^{2}(a^{2}+\\beta^{2}-b^{2})}{(a^{2}+\\beta^{2})^{2}}$$\n代入 $\\sigma = \\frac{a\\beta}{\\sqrt{a^{2}+\\beta^{2}}}$：\n$$\\mathcal{I} = \\sqrt{2\\pi} \\frac{a\\beta}{(a^{2}+\\beta^{2})^{1/2}} \\frac{a^{2}(a^{2}+\\beta^{2}-b^{2})}{(a^{2}+\\beta^{2})^{2}} = \\sqrt{2\\pi} \\frac{a^{3}\\beta(a^{2}+\\beta^{2}-b^{2})}{(a^{2}+\\beta^{2})^{5/2}}$$\n最后，我们组合 $W_{x}(a,b) = \\frac{1}{\\sqrt{a}} \\exp\\left(-\\frac{b^{2}}{2(a^{2}+\\beta^{2})}\\right) \\mathcal{I}$：\n$$W_{x}(a,b) = \\frac{1}{a^{1/2}} \\exp\\left(-\\frac{b^{2}}{2(a^{2}+\\beta^{2})}\\right) \\sqrt{2\\pi} \\frac{a^{3}\\beta(a^{2}+\\beta^{2}-b^{2})}{(a^{2}+\\beta^{2})^{5/2}}$$\n化简 $a$ 的幂次 ($a^{3-1/2} = a^{5/2}$)，我们得到最终的闭式表达式：\n$$W_{x}(a,b) = \\sqrt{2\\pi} \\frac{a^{5/2}\\beta}{(a^{2}+\\beta^{2})^{5/2}} (a^{2}+\\beta^{2}-b^{2}) \\exp\\left(-\\frac{b^{2}}{2(a^{2}+\\beta^{2})}\\right)$$\n这可以重新整理以合并各项：\n$$W_{x}(a,b) = \\sqrt{2\\pi}\\beta \\left(\\frac{a}{a^{2}+\\beta^{2}}\\right)^{5/2} (a^{2}+\\beta^{2}-b^{2}) \\exp\\left(-\\frac{b^{2}}{2(a^{2}+\\beta^{2})}\\right)$$\n该表达式是推导的完整最终结果。", "answer": "$$\\boxed{\\sqrt{2\\pi}\\beta \\left(\\frac{a}{a^{2}+\\beta^{2}}\\right)^{\\frac{5}{2}} (a^{2}+\\beta^{2}-b^{2}) \\exp\\left(-\\frac{b^{2}}{2(a^{2}+\\beta^{2})}\\right)}$$", "id": "2860051"}, {"introduction": "在处理真实信号时，噪声是不可避免的。这个练习将探讨 CWT 在面对高斯白噪声输入时的统计特性，这是一个连接 CWT 理论与实际应用的关键环节 [@problem_id:2860049]。通过推导小波系数平方幅值的期望，你将发现 CWT 如何在时频域上“处理”白噪声的能量，这一结果对于后续的信号检测和去噪应用具有基石般的重要意义。", "problem": "考虑一个定义在$\\mathbb{R}$上的零均值、圆对称复高斯白噪声过程$x(t)$，其二阶统计特性由$\\mathbb{E}\\{x(t)x^{*}(s)\\}=\\sigma^{2}\\delta(t-s)$定义，其中$\\sigma^{2}>0$是一个常数，$\\delta(\\cdot)$是狄拉克$\\delta$分布。令$\\psi(t)$为一个容许母小波，其平方可积、具有零均值和单位能量，即$\\int_{-\\infty}^{\\infty}|\\psi(t)|^{2}\\,dt=1$。$x(t)$关于母小波$\\psi(t)$的连续小波变换 (CWT) 定义为\n$$\nW_{x}(a,b)=\\int_{-\\infty}^{\\infty} x(t)\\,\\frac{1}{\\sqrt{|a|}}\\,\\psi^{*}\\!\\left(\\frac{t-b}{a}\\right)\\,dt,\n$$\n对于任意尺度$a\\in\\mathbb{R}\\setminus\\{0\\}$和时间平移$b\\in\\mathbb{R}$。仅使用上述定义和性质，推导期望平方幅值$\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\}$的闭式表达式，该表达式应为$a$、$b$、$\\sigma^{2}$和$\\psi$的函数。请以最简精确形式表示你的最终答案。你的最终答案必须是无单位的单个闭式表达式。", "solution": "所述问题具有科学依据，是适定的、客观的。它提供了推导唯一、有意义解所需的所有必要定义和条件。所有概念——复高斯白噪声、连续小波变换和母小波性质——都是信号处理和应用数学领域的标准概念。该问题是有效的。我们着手进行求解。\n\n目标是计算给定噪声过程$x(t)$的连续小波变换 (CWT) 系数的期望平方幅值$\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\}$。CWT的定义为：\n$$\nW_{x}(a,b) = \\int_{-\\infty}^{\\infty} x(t)\\,\\frac{1}{\\sqrt{|a|}}\\,\\psi^{*}\\!\\left(\\frac{t-b}{a}\\right)\\,dt\n$$\n我们首先将平方幅值$|W_{x}(a,b)|^{2}$表示为$W_{x}(a,b)$与其复共轭$W_{x}^{*}(a,b)$的乘积。为避免混淆，我们为每个因子使用不同的积分变量$t$和$s$。\n$$\n|W_{x}(a,b)|^{2} = W_{x}(a,b) W_{x}^{*}(a,b)\n$$\n$W_{x}(a,b)$的复共轭为：\n$$\nW_{x}^{*}(a,b) = \\left( \\int_{-\\infty}^{\\infty} x(s)\\,\\frac{1}{\\sqrt{|a|}}\\,\\psi^{*}\\!\\left(\\frac{s-b}{a}\\right)\\,ds \\right)^{*} = \\int_{-\\infty}^{\\infty} x^{*}(s)\\,\\frac{1}{\\sqrt{|a|}}\\,\\psi\\!\\left(\\frac{s-b}{a}\\right)\\,ds\n$$\n将它们结合起来，我们得到$|W_{x}(a,b)|^{2}$的二重积分表示：\n$$\n|W_{x}(a,b)|^{2} = \\left( \\int_{-\\infty}^{\\infty} x(t)\\,\\frac{1}{\\sqrt{|a|}}\\,\\psi^{*}\\!\\left(\\frac{t-b}{a}\\right)\\,dt \\right) \\left( \\int_{-\\infty}^{\\infty} x^{*}(s)\\,\\frac{1}{\\sqrt{|a|}}\\,\\psi\\!\\left(\\frac{s-b}{a}\\right)\\,ds \\right)\n$$\n$$\n|W_{x}(a,b)|^{2} = \\frac{1}{|a|} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} x(t)x^{*}(s) \\psi^{*}\\!\\left(\\frac{t-b}{a}\\right) \\psi\\!\\left(\\frac{s-b}{a}\\right) \\,dt\\,ds\n$$\n现在，我们对该表达式取统计期望。期望算子$\\mathbb{E}\\{\\cdot\\}$是线性的，可以与积分互换，这一步骤对于良态函数和随机过程，可由Fubini-Tonelli定理证明其合理性。\n$$\n\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\} = \\mathbb{E}\\left\\{ \\frac{1}{|a|} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} x(t)x^{*}(s) \\psi^{*}\\!\\left(\\frac{t-b}{a}\\right) \\psi\\!\\left(\\frac{s-b}{a}\\right) \\,dt\\,ds \\right\\}\n$$\n$$\n\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\} = \\frac{1}{|a|} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\mathbb{E}\\{x(t)x^{*}(s)\\} \\psi^{*}\\!\\left(\\frac{t-b}{a}\\right) \\psi\\!\\left(\\frac{s-b}{a}\\right) \\,dt\\,ds\n$$\n问题给出了零均值复白噪声过程$x(t)$的二阶统计特性：\n$$\n\\mathbb{E}\\{x(t)x^{*}(s)\\} = \\sigma^{2}\\delta(t-s)\n$$\n其中$\\sigma^{2}$是一个正常数，$\\delta(\\cdot)$是狄拉克$\\delta$分布。将此性质代入我们的积分中：\n$$\n\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\} = \\frac{1}{|a|} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\sigma^{2}\\delta(t-s) \\psi^{*}\\!\\left(\\frac{t-b}{a}\\right) \\psi\\!\\left(\\frac{s-b}{a}\\right) \\,dt\\,ds\n$$\n现在我们可以通过应用狄拉克$\\delta$函数的筛选性质来计算关于$s$的内层积分，该性质表明$\\int_{-\\infty}^{\\infty} f(s)\\delta(t-s)\\,ds = f(t)$。\n$$\n\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\} = \\frac{\\sigma^{2}}{|a|} \\int_{-\\infty}^{\\infty} \\psi^{*}\\!\\left(\\frac{t-b}{a}\\right) \\left( \\int_{-\\infty}^{\\infty} \\psi\\!\\left(\\frac{s-b}{a}\\right) \\delta(t-s) \\,ds \\right) \\,dt\n$$\n$$\n\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\} = \\frac{\\sigma^{2}}{|a|} \\int_{-\\infty}^{\\infty} \\psi^{*}\\!\\left(\\frac{t-b}{a}\\right) \\psi\\!\\left(\\frac{t-b}{a}\\right) \\,dt\n$$\n表达式简化为：\n$$\n\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\} = \\frac{\\sigma^{2}}{|a|} \\int_{-\\infty}^{\\infty} \\left| \\psi\\!\\left(\\frac{t-b}{a}\\right) \\right|^{2} \\,dt\n$$\n为求解剩余的积分，我们进行变量代换。令$u = \\frac{t-b}{a}$。这意味着$t = au+b$以及$dt = a\\,du$。我们必须考虑积分的上下限。\n如果$a>0$，当$t$从$-\\infty$变化到$\\infty$时，$u$也从$-\\infty$变化到$\\infty$。\n如果$a<0$，当$t$从$-\\infty$变化到$\\infty$时，$u$从$\\infty$变化到$-\\infty$。\n无论哪种情况，使用$|a|$时，积分都能正确变换。\n积分变为：\n$$\n\\int_{-\\infty}^{\\infty} \\left| \\psi\\left(\\frac{t-b}{a}\\right) \\right|^{2} \\,dt = \\int_{L} |\\psi(u)|^{2} (a\\,du)\n$$\n其中，如果$a>0$，$L$为$(-\\infty, \\infty)$；如果$a<0$，$L$为$(\\infty, -\\infty)$。\n其计算结果为$|a|\\int_{-\\infty}^{\\infty}|\\psi(u)|^{2}\\,du$。更正式地：\n$$\n\\int_{-\\infty}^{\\infty} \\left| \\psi\\left(\\frac{t-b}{a}\\right) \\right|^{2} \\,dt = |a| \\int_{-\\infty}^{\\infty} |\\psi(u)|^{2} \\,du\n$$\n将其代回我们的期望值表达式中：\n$$\n\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\} = \\frac{\\sigma^{2}}{|a|} \\left( |a| \\int_{-\\infty}^{\\infty} |\\psi(u)|^{2} \\,du \\right) = \\sigma^{2} \\int_{-\\infty}^{\\infty} |\\psi(u)|^{2} \\,du\n$$\n问题中规定，母小波$\\psi(t)$具有单位能量，其定义为：\n$$\n\\int_{-\\infty}^{\\infty}|\\psi(t)|^{2}\\,dt=1\n$$\n利用这个性质，积分$\\int_{-\\infty}^{\\infty} |\\psi(u)|^{2} \\,du$等于$1$。\n因此，最终结果为：\n$$\n\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\} = \\sigma^{2} \\times 1 = \\sigma^{2}\n$$\nCWT系数的期望平方幅值对于所有尺度$a$和时间平移$b$都是一个常数。它仅取决于噪声过程的方差参数$\\sigma^{2}$。给出的另一个性质，即小波具有零均值，对于此特定推导并非必需，尽管它是母小波容许性条件的一个关键组成部分。", "answer": "$$\n\\boxed{\\sigma^{2}}\n$$", "id": "2860049"}, {"introduction": "掌握了 CWT 对噪声的响应特性后，我们便可以将其应用于一个核心的工程问题：信号检测。本练习模拟了一个在白噪声背景下检测信号存在的场景，要求你设计一个基于 CWT 能量的检测器 [@problem_id:2860073]。通过推导在给定虚警概率 $\\mathsf{P}_{\\mathrm{FA}}$ 下的检测阈值，你将体验到如何将 CWT 的统计理论转化为解决实际问题的强大工具。", "problem": "考虑一个在所有实数时间上定义的实值观测过程的连续小波变换 (CWT)：\n$$\nW_{x}(a,b) \\triangleq \\int_{-\\infty}^{\\infty} x(t)\\,\\frac{1}{\\sqrt{a}}\\,\\psi^{*}\\!\\left(\\frac{t-b}{a}\\right)\\,dt,\n$$\n其中 $a \\in \\mathbb{R}_{+}$ 是尺度，$b \\in \\mathbb{R}$ 是平移，$\\psi(t)$ 是一个单位能量的复母小波，即\n$$\n\\int_{-\\infty}^{\\infty}|\\psi(t)|^{2}\\,dt \\;=\\; 1.\n$$\n假设母小波是复Morlet小波（对于大中心频率，其可忽略的零均值修正是未考虑的），由下式给出\n$$\n\\psi(t) \\;=\\; \\pi^{-1/4}\\,\\exp\\!\\left(i\\,\\omega_{\\psi}\\,t\\right)\\,\\exp\\!\\left(-\\frac{t^{2}}{2}\\right),\n$$\n因此 $\\Re\\{\\psi\\}$ 和 $\\Im\\{\\psi\\}$ 在 $L^{2}(\\mathbb{R})$ 上是正交的。您观测到\n$$\nx(t) \\;=\\; n(t),\n$$\n其中 $n(t)$ 是一个零均值、实值、宽义平稳高斯白噪声，其双边功率谱密度为 $S_{n}(\\omega)=N_{0}/2$，等价地，其自相关函数为 $R_{n}(\\tau)=(N_{0}/2)\\,\\delta(\\tau)$。\n\n固定一个特定的尺度 $a_{0}>0$ 和平移 $b_{0}\\in\\mathbb{R}$。您希望设计一个检测器，当局部CWT能量超过一个阈值时，宣告检测事件发生，\n$$\n\\text{若}\\quad |W_{x}(a_{0},b_{0})|^{2}>\\tau \\quad \\text{则判定为检测事件}。\n$$\n请仅使用连续小波变换的基本原理、高斯过程的线性泛函以及上述Morlet母小波的性质，推导出一个阈值 $\\tau$ 的闭式解析表达式，该阈值能够达到预设的虚警概率\n$$\n\\mathsf{P}_{\\mathrm{FA}} \\;=\\; \\alpha,\\qquad \\text{其中 } \\alpha\\in(0,1).\n$$\n将您的最终阈值表示为仅含 $N_{0}$ 和 $\\alpha$ 的单个闭式表达式。最终表达式中不要包含单位。", "solution": "我们从连续小波变换 (CWT) 的定义开始，\n$$\nW_{x}(a,b) \\;=\\; \\left\\langle x,\\,\\psi_{a,b}\\right\\rangle\n\\;\\triangleq\\; \\int_{-\\infty}^{\\infty} x(t)\\,\\psi_{a,b}^{*}(t)\\,dt,\n$$\n其中\n$$\n\\psi_{a,b}(t) \\;=\\; \\frac{1}{\\sqrt{a}}\\,\\psi\\!\\left(\\frac{t-b}{a}\\right).\n$$\n在零假设（仅有噪声）下，$x(t)=n(t)$ 是一个自相关函数为 $R_{n}(\\tau)=(N_{0}/2)\\,\\delta(\\tau)$ 的零均值实高斯过程。因此，CWT系数 $W_{n}(a,b)$ 是一个零均值高斯过程的复值线性泛函，因此它本身也是一个零均值复高斯随机变量。\n\n我们首先根据第一性原理计算其二阶矩 $E\\!\\left[\\,|W_{n}(a,b)|^{2}\\,\\right]$。利用 Fubini 定理和 $n(t)$ 的白性，\n$$\n\\begin{aligned}\nE\\!\\left[\\,|W_{n}(a,b)|^{2}\\,\\right]\n&= E\\!\\left[\\left(\\int n(t)\\,\\psi_{a,b}^{*}(t)\\,dt\\right)\\left(\\int n(t')\\,\\psi_{a,b}(t')\\,dt'\\right)\\right] \\\\\n&= \\iint E\\!\\left[n(t)\\,n(t')\\right]\\,\\psi_{a,b}^{*}(t)\\,\\psi_{a,b}(t')\\,dt\\,dt' \\\\\n&= \\iint \\frac{N_{0}}{2}\\,\\delta(t-t')\\,\\psi_{a,b}^{*}(t)\\,\\psi_{a,b}(t')\\,dt\\,dt' \\\\\n&= \\frac{N_{0}}{2}\\,\\int \\left|\\psi_{a,b}(t)\\right|^{2}\\,dt.\n\\end{aligned}\n$$\n根据构造，每个经过缩放和平移的小波的能量都等于母小波的能量，\n$$\n\\int \\left|\\psi_{a,b}(t)\\right|^{2}\\,dt \\;=\\; \\int \\left|\\frac{1}{\\sqrt{a}}\\,\\psi\\!\\left(\\frac{t-b}{a}\\right)\\right|^{2}\\,dt\n\\;=\\; \\int |\\psi(u)|^{2}\\,du \\;=\\; 1,\n$$\n这里我们使用了变量替换 $u=(t-b)/a$。因此，\n$$\nE\\!\\left[\\,|W_{n}(a,b)|^{2}\\,\\right] \\;=\\; \\frac{N_{0}}{2}.\n$$\n\n接下来，我们确定 $|W_{n}(a,b)|^{2}$ 的分布。通过小波的实部和虚部，将 $W_{n}(a,b)$分解为实部和虚部：\n$$\nW_{n}(a,b) \\;=\\; \\left\\langle n,\\Re\\{\\psi_{a,b}\\}\\right\\rangle \\;+\\; i\\,\\left\\langle n,\\Im\\{\\psi_{a,b}\\}\\right\\rangle.\n$$\n由于 $n(t)$ 是高斯的且泛函是线性的，每个投影都是一个实值零均值高斯随机变量。这两个投影的方差为\n$$\n\\mathrm{Var}\\!\\left(\\left\\langle n,\\Re\\{\\psi_{a,b}\\}\\right\\rangle\\right)\n= \\frac{N_{0}}{2}\\,\\left\\|\\Re\\{\\psi_{a,b}\\}\\right\\|_{2}^{2},\\qquad\n\\mathrm{Var}\\!\\left(\\left\\langle n,\\Im\\{\\psi_{a,b}\\}\\right\\rangle\\right)\n= \\frac{N_{0}}{2}\\,\\left\\|\\Im\\{\\psi_{a,b}\\}\\right\\|_{2}^{2}.\n$$\n对于复Morlet小波 $\\psi(t)=\\pi^{-1/4}\\exp(i\\omega_{\\psi}t)\\exp(-t^{2}/2)$，\n$$\n\\Re\\{\\psi(t)\\}=\\pi^{-1/4}\\cos(\\omega_{\\psi} t)\\exp(-t^{2}/2),\\qquad\n\\Im\\{\\psi(t)\\}=\\pi^{-1/4}\\sin(\\omega_{\\psi} t)\\exp(-t^{2}/2).\n$$\n它们的 $L^{2}(\\mathbb{R})$ 内积是\n$$\n\\left\\langle \\Re\\{\\psi\\},\\Im\\{\\psi\\}\\right\\rangle\n= \\pi^{-1/2}\\int_{-\\infty}^{\\infty}\\exp(-t^{2})\\,\\cos(\\omega_{\\psi} t)\\,\\sin(\\omega_{\\psi} t)\\,dt\n= \\frac{\\pi^{-1/2}}{2}\\int_{-\\infty}^{\\infty}\\exp(-t^{2})\\,\\sin(2\\omega_{\\psi} t)\\,dt\n= 0,\n$$\n因为被积函数是奇函数。缩放和平移保持正交性：\n$$\n\\left\\langle \\Re\\{\\psi_{a,b}\\},\\Im\\{\\psi_{a,b}\\}\\right\\rangle\n= \\int \\frac{1}{a}\\,\\Re\\!\\left\\{\\psi\\!\\left(\\frac{t-b}{a}\\right)\\right\\}\\,\\Im\\!\\left\\{\\psi\\!\\left(\\frac{t-b}{a}\\right)\\right\\}\\,dt\n= \\int \\Re\\{\\psi(u)\\}\\,\\Im\\{\\psi(u)\\}\\,du\n= 0.\n$$\n此外，由于 $\\|\\psi_{a,b}\\|_{2}^{2}=1$ 且 $|\\psi|^{2}=(\\Re\\psi)^{2}+(\\Im\\psi)^{2}$，正弦和余弦包络的对称性得出\n$$\n\\left\\|\\Re\\{\\psi_{a,b}\\}\\right\\|_{2}^{2}=\\left\\|\\Im\\{\\psi_{a,b}\\}\\right\\|_{2}^{2}=\\frac{1}{2}.\n$$\n因此，\n$$\n\\mathrm{Var}\\!\\left(\\left\\langle n,\\Re\\{\\psi_{a,b}\\}\\right\\rangle\\right)\n=\\mathrm{Var}\\!\\left(\\left\\langle n,\\Im\\{\\psi_{a,b}\\}\\right\\rangle\\right)\n= \\frac{N_{0}}{4},\n$$\n并且，由于这两个投影是联合高斯且不相关的，所以它们是独立的。因此，$W_{n}(a,b)$ 是一个均值为零的 proper (圆对称) 复高斯随机变量，并且\n$$\nE\\!\\left[\\,|W_{n}(a,b)|^{2}\\,\\right]\n= \\mathrm{Var}\\!\\left(\\Re\\{W_{n}\\}\\right)+\\mathrm{Var}\\!\\left(\\Im\\{W_{n}\\}\\right)\n= \\frac{N_{0}}{4}+\\frac{N_{0}}{4}\n= \\frac{N_{0}}{2}.\n$$\n\n令 $U \\triangleq |W_{n}(a_{0},b_{0})|^{2}$。因为 $W_{n}$ 是具有相等方差的独立实部和虚部的 proper 复高斯随机变量，所以 $U$ 服从均值为 $E[U]=N_{0}/2$ 的指数分布。其在零假设下的互补累积分布函数为\n$$\n\\mathsf{P}\\!\\left(U>\\tau\\,\\middle|\\,H_{0}\\right) \\;=\\; \\exp\\!\\left(-\\frac{\\tau}{E[U]}\\right)\n\\;=\\; \\exp\\!\\left(-\\frac{2\\,\\tau}{N_{0}}\\right).\n$$\n如果 $U>\\tau$，检测器宣告检测。为了达到预设的虚警概率 $\\mathsf{P}_{\\mathrm{FA}}=\\alpha$，我们设定\n$$\n\\alpha \\;=\\; \\mathsf{P}\\!\\left(U>\\tau\\,\\middle|\\,H_{0}\\right) \\;=\\; \\exp\\!\\left(-\\frac{2\\,\\tau}{N_{0}}\\right),\n$$\n由此可唯一地解出 $\\tau$ 为\n$$\n\\tau \\;=\\; -\\,\\frac{N_{0}}{2}\\,\\ln(\\alpha).\n$$\n\n该阈值与尺度 $a_{0}$ 和平移 $b_{0}$ 无关，因为白噪声在投影到任何单位能量小波后的方差是不变的，并且在所述假设下，Morlet小波产生一个 proper 复高斯系数。因此，所要求的仅含 $N_{0}$ 和 $\\alpha$ 的闭式表达式得以建立。", "answer": "$$\\boxed{-\\frac{N_{0}}{2}\\,\\ln(\\alpha)}$$", "id": "2860073"}]}