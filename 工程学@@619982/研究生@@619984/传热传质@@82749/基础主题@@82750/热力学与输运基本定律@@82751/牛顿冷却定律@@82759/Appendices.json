{"hands_on_practices": [{"introduction": "牛顿冷却定律描述的对流换热在现实世界的应用中，往往与热辐射等其他传热模式并存。本练习旨在量化一个常见的建模误差：当分析一个同时存在对流和辐射的冷却过程时，如果忽略辐射效应，将会如何影响对对流换热系数的估算。通过这个实践，您将学会从第一性原理出发，分离不同传热模式的贡献，并深刻理解在参数估计中模型假设完整性的重要性。[@problem_id:2512073]", "problem": "一个半径为 $R=5.00\\times 10^{-3}\\,\\mathrm{m}$、热导率为 $k_{s}=16.0\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$ 的小型、实心、均匀不锈钢球体，被放置在一个温度为 $T_{\\infty}=300\\,\\mathrm{K}$ 的巨大、静止的空气环境中。周围的罩壳很大，并且是温度为 $T_{\\mathrm{sur}}=300\\,\\mathrm{K}$ 的等温体，可以被视为一个黑体辐射汇。球体表面发射率为 $\\varepsilon=0.80$。材料密度为 $\\rho=8.00\\times 10^{3}\\,\\mathrm{kg\\,m^{-3}}$，定压比热容为 $c_{p}=5.00\\times 10^{2}\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$（假定在所考虑的温度变化范围内为常数）。忽略通过支架的任何热传导以及任何内部热源。您可以假设球体在任何时候都保持空间上等温（集总参数法行为）。\n\n在球体表面温度为 $T_{s}=500\\,\\mathrm{K}$ 的瞬间，测得的冷却速率为 $\\mathrm{d}T_{s}/\\mathrm{d}t=-0.600\\,\\mathrm{K\\,s^{-1}}$。一位忽略了热辐射的研究人员，使用集总能量平衡从这个瞬态数据中推断出一个对流传热系数 $h_{\\mathrm{est}}$。实际上，自然对流和向罩壳的热辐射是同时作用的，因此真实的对流传热系数 $h_{c}$ 小于 $h_{\\mathrm{est}}$。\n\n仅从集总系统的瞬态能量平衡、对流传热系数的定义以及 Stefan–Boltzmann 定律（Stefan–Boltzmann 常数 $\\sigma=5.670374419\\times 10^{-8}\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}$）出发，推导在给定瞬间 $h_{\\mathrm{est}}$ 和 $h_{c}$ 之间的关系，并确定绝对高估值\n$$\\Delta h \\equiv h_{\\mathrm{est}}-h_{c}$$。\n在所述条件下，数值计算 $\\Delta h$。将您的答案四舍五入到四位有效数字。以 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$ 为单位表示 $\\Delta h$。", "solution": "首先验证问题，以确保其科学上合理、提法得当且客观。\n\n**步骤 1：提取已知条件**\n- 球体半径: $R=5.00\\times 10^{-3}\\,\\mathrm{m}$\n- 球体热导率: $k_{s}=16.0\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$\n- 环境空气温度: $T_{\\infty}=300\\,\\mathrm{K}$\n- 周围罩壳温度: $T_{\\mathrm{sur}}=300\\,\\mathrm{K}$\n- 球体表面发射率: $\\varepsilon=0.80$\n- 球体材料密度: $\\rho=8.00\\times 10^{3}\\,\\mathrm{kg\\,m^{-3}}$\n- 球体材料比热容: $c_{p}=5.00\\times 10^{2}\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n- 测量瞬间的球体表面温度: $T_{s}=500\\,\\mathrm{K}$\n- 该瞬间测得的冷却速率: $\\mathrm{d}T_{s}/\\mathrm{d}t=-0.600\\,\\mathrm{K\\,s^{-1}}$\n- Stefan–Boltzmann 常数: $\\sigma=5.670374419\\times 10^{-8}\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}$\n- 假设：空间上等温的球体（集总参数模型有效）。\n- 定义：$h_{\\mathrm{est}}$ 是忽略辐射时推断出的对流传热系数；$h_{c}$ 是真实的对流传热系数。\n- 目标：推导 $h_{\\mathrm{est}}$ 和 $h_{c}$ 之间的关系，并计算高估值 $\\Delta h \\equiv h_{\\mathrm{est}}-h_{c}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在科学上基于瞬态传热的原理，特别是集总参数法、Newton 冷却定律和用于辐射的 Stefan–Boltzmann 定律。集总参数法行为的假设被明确说明，并可以验证其合理性。进行 Biot 数检验，$Bi = h_c L_c / k_s$ 其中 $L_c = R/3$，使用空气中自然对流的典型值（$h_c \\sim 10\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$），得到 $Bi \\approx (10 \\cdot 5 \\times 10^{-3}/3) / 16 \\approx 10^{-3} \\ll 0.1$，这证实了该假设的有效性。该问题提法得当，提供了找到 $\\Delta h$ 唯一解所需的所有数据。语言客观、精确。问题是自洽的，没有矛盾或科学上不合理的假设。\n\n**步骤 3：结论和行动**\n问题有效。将推导解答。\n\n分析从应用于球体的热力学第一定律开始，将球体视为一个集总系统。球体内能 $E$ 的变化率必须等于从其表面的净传热率 $\\dot{Q}_{\\mathrm{total}}$。\n$$ \\frac{dE}{dt} = - \\dot{Q}_{\\mathrm{total}} $$\n均匀球体的内能为 $E = m c_p T_s = (\\rho V) c_p T_s$，其中 $V$ 是球体的体积。因此能量变化率为：\n$$ \\frac{dE}{dt} = \\rho V c_p \\frac{dT_s}{dt} $$\n来自表面的总传热是自然对流造成的热损失 $\\dot{Q}_{\\mathrm{conv}}$ 和热辐射造成的热损失 $\\dot{Q}_{\\mathrm{rad}}$ 之和。\n$$ \\dot{Q}_{\\mathrm{total}} = \\dot{Q}_{\\mathrm{conv}} + \\dot{Q}_{\\mathrm{rad}} $$\n对流热损失由 Newton 冷却定律描述，使用真实的对流传热系数 $h_c$：\n$$ \\dot{Q}_{\\mathrm{conv}} = h_c A_s (T_s - T_{\\infty}) $$\n其中 $A_s$ 是球体的表面积。向温度为 $T_{\\mathrm{sur}}$ 的巨大黑色环境的辐射热损失由 Stefan–Boltzmann 定律给出：\n$$ \\dot{Q}_{\\mathrm{rad}} = \\varepsilon \\sigma A_s (T_s^4 - T_{\\mathrm{sur}}^4) $$\n结合这些项，球体的正确瞬态能量平衡方程为：\n$$ \\rho V c_p \\frac{dT_s}{dt} = - [h_c A_s (T_s - T_{\\infty}) + \\varepsilon \\sigma A_s (T_s^4 - T_{\\mathrm{sur}}^4)] $$\n现在，我们考虑那位错误地忽略了辐射的研究人员所使用的模型。该研究人员将整个测得的冷却速率完全归因于对流，从而定义了一个估算或表观的传热系数 $h_{\\mathrm{est}}$。在这个有缺陷的模型中，能量平衡方程为：\n$$ \\rho V c_p \\frac{dT_s}{dt} = - \\dot{Q}_{\\mathrm{est}} = - h_{\\mathrm{est}} A_s (T_s - T_{\\infty}) $$\n正确和有缺陷的能量平衡方程的左侧是相同的，因为它代表了物理上测得的球体储存能量的变化率。因此，我们可以让总热损失率的表达式相等：\n$$ \\dot{Q}_{\\mathrm{est}} = \\dot{Q}_{\\mathrm{total}} $$\n$$ h_{\\mathrm{est}} A_s (T_s - T_{\\infty}) = h_c A_s (T_s - T_{\\infty}) + \\varepsilon \\sigma A_s (T_s^4 - T_{\\mathrm{sur}}^4) $$\n表面积 $A_s$ 是一个公因子，可以从所有项中消去：\n$$ h_{\\mathrm{est}} (T_s - T_{\\infty}) = h_c (T_s - T_{\\infty}) + \\varepsilon \\sigma (T_s^4 - T_{\\mathrm{sur}}^4) $$\n为了找到高估值 $\\Delta h = h_{\\mathrm{est}} - h_c$，我们重新整理方程：\n$$ h_{\\mathrm{est}} (T_s - T_{\\infty}) - h_c (T_s - T_{\\infty}) = \\varepsilon \\sigma (T_s^4 - T_{\\mathrm{sur}}^4) $$\n$$ (h_{\\mathrm{est}} - h_c) (T_s - T_{\\infty}) = \\varepsilon \\sigma (T_s^4 - T_{\\mathrm{sur}}^4) $$\n代入定义 $\\Delta h \\equiv h_{\\mathrm{est}} - h_c$，我们得到所需的关系式：\n$$ \\Delta h (T_s - T_{\\infty}) = \\varepsilon \\sigma (T_s^4 - T_{\\mathrm{sur}}^4) $$\n这个表达式表明，对流系数中的高估值恰好是辐射传热系数，这是辐射热通量的一种常见线性化形式。由此，我们可以解出 $\\Delta h$：\n$$ \\Delta h = \\frac{\\varepsilon \\sigma (T_s^4 - T_{\\mathrm{sur}}^4)}{T_s - T_{\\infty}} $$\n这就是 $h_{\\mathrm{est}}$ 和 $h_c$ 之间的一般关系。请注意，其推导过程既不需要球体的几何或材料属性（$R, \\rho, c_p, k_s$），也不需要测得的冷却速率（$\\mathrm{d}T_s/\\mathrm{d}t$）。这些数据对于所问的问题是多余的。\n\n我们现在使用提供的数据计算 $\\Delta h$ 的数值：$\\varepsilon=0.80$, $\\sigma=5.670374419\\times 10^{-8}\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}$, $T_s=500\\,\\mathrm{K}$, $T_{\\infty}=300\\,\\mathrm{K}$, and $T_{\\mathrm{sur}}=300\\,\\mathrm{K}$。\n$$ \\Delta h = \\frac{(0.80)(5.670374419 \\times 10^{-8}\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}) ((500\\,\\mathrm{K})^4 - (300\\,\\mathrm{K})^4)}{500\\,\\mathrm{K} - 300\\,\\mathrm{K}} $$\n首先，我们计算表达式中的各项：\n$T_s^4 = (500)^4 = 6.25 \\times 10^{10}\\,\\mathrm{K}^4$\n$T_{\\mathrm{sur}}^4 = (300)^4 = 0.81 \\times 10^{10}\\,\\mathrm{K}^4$\n$T_s^4 - T_{\\mathrm{sur}}^4 = (6.25 - 0.81) \\times 10^{10}\\,\\mathrm{K}^4 = 5.44 \\times 10^{10}\\,\\mathrm{K}^4$\n$T_s - T_{\\infty} = 500 - 300 = 200\\,\\mathrm{K}$\n代入这些值：\n$$ \\Delta h = \\frac{(0.80)(5.670374419 \\times 10^{-8}) (5.44 \\times 10^{10})}{200} \\, \\mathrm{W\\,m^{-2}\\,K^{-1}} $$\n$$ \\Delta h = \\frac{4.5362995352 \\times 10^{-8} \\times 5.44 \\times 10^{10}}{200} \\, \\mathrm{W\\,m^{-2}\\,K^{-1}} $$\n$$ \\Delta h = \\frac{2467.747...}{200} \\, \\mathrm{W\\,m^{-2}\\,K^{-1}} $$\n$$ \\Delta h = 12.3387... \\, \\mathrm{W\\,m^{-2}\\,K^{-1}} $$\n根据题目要求，将结果四舍五入到四位有效数字，得到：\n$$ \\Delta h \\approx 12.34 \\, \\mathrm{W\\,m^{-2}\\,K^{-1}} $$\n这个值代表了经验确定的总传热系数中由辐射贡献的部分，而研究人员错误地将其包含在了对流系数中。", "answer": "$$\\boxed{12.34}$$", "id": "2512073"}, {"introduction": "经典的牛顿冷却定律及其指数衰减解是建立在对流换热系数 $h$ 为常数的核心假设之上的。然而，在许多实际情况中，流体物性（如粘度）随温度变化，导致 $h$ 成为表面温度的函数。本练习将引导您处理这种更符合物理实际的非线性问题，您需要从能量守恒出发，建立并求解一个非线性常微分方程，以获得温度随时间演化的精确解析解。这项实践不仅能提升您处理非线性动力学系统的数学能力，还能让您直观地看到变参数对系统行为的影响。[@problem_id:2512093]", "problem": "一个温度均匀的小等温体在一个恒定环境温度的流体环境中冷却。假设集总电容法近似有效。请从第一性原理出发，建立瞬态能量平衡，将物体的内能变化率与表面的对流散热率相等同，并结合对流的本构关系。对流换热系数依赖于表面温度，其函数形式为 $h(T)=h_0\\,[1+\\beta\\,(T-T_\\infty)]$，其中 $h_0$ 和 $\\beta$ 为常数，$T_\\infty$ 为环境温度。推导物体温度 $T(t)$ 的非线性常微分控制方程（ODE），并获得一个关于初始温度 $T(0)=T_0$、材料属性 $\\rho$（密度）和 $c_p$（定压比热）、物体体积 $V$、表面积 $A$、参数 $h_0$ 和 $\\beta$ 以及环境温度 $T_\\infty$ 的 $T(t)$ 的显式闭式表达式。请勿使用数值时间积分；您的推导和实现必须依赖于解析解。\n\n获得解析解后，请编写一个程序，用于评估下述五个测试用例中的 $T(t)$。所有温度以开尔文（Kelvin）表示，时间以秒（seconds）表示。您的程序必须计算每个测试用例在指定评估时间的温度，并生成单行输出。输出内容是以逗号分隔的列表，用方括号括起，每个温度值四舍五入到六位小数，例如 $[300.000000,299.000000]$。\n\n请使用以下测试套件。每一行给定一个元组 $(\\rho,c_p,V,A,h_0,\\beta,T_\\infty,T_0,t)$。所有量均采用标准国际单位（SI）：$\\rho$ 的单位是 $\\mathrm{kg\\,m^{-3}}$，$c_p$ 的单位是 $\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$V$ 的单位是 $\\mathrm{m^3}$，$A$ 的单位是 $\\mathrm{m^2}$，$h_0$ 的单位是 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$，$\\beta$ 的单位是 $\\mathrm{K^{-1}}$，$T_\\infty$ 和 $T_0$ 的单位是 $\\mathrm{K}$，$t$ 的单位是 $\\mathrm{s}$。\n\n- 用例1（一般非线性行为）：$(1000, 4180, 0.001, 0.05, 100, 0.01, 293.15, 363.15, 600)$。\n- 用例2（线性极限）：$(1000, 4180, 0.001, 0.05, 100, 0.0, 293.15, 363.15, 600)$。\n- 用例3（初始无温差）：$(1000, 4180, 0.001, 0.05, 100, 0.01, 293.15, 293.15, 600)$。\n- 用例4（负系数敏感性）：$(1000, 4180, 0.001, 0.05, 100, -0.01, 293.15, 343.15, 600)$。\n- 用例5（初始温度低于环境温度）：$(1000, 4180, 0.001, 0.05, 100, 0.02, 293.15, 273.15, 600)$。\n\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，按用例$1$到用例$5$的顺序排列结果，其中每个条目都是一个浮点数，表示以开尔文为单位的 $T(t)$，并四舍五入到六位小数。请勿打印任何其他文本。不使用角度单位。不使用百分比。", "solution": "经审阅，所提交的问题陈述有效。其科学上基于瞬态热传导的基本原理，数学上作为一个初值问题是适定的，并且其参数在物理上是现实且自洽的。我们将继续进行推导和求解。\n\n该问题要求推导一个由集总电容法控制的等温体的温度 $T(t)$ 的解析表达式，其中对流换热系数 $h$ 是物体与其周围环境温差的线性函数。\n\n设 $T(t)$ 为物体在时间 $t$ 时的均匀温度，设 $T_\\infty$ 为恒定的环境温度。该物体的密度为 $\\rho$，体积为 $V$，定压比热为 $c_p$，表面积为 $A$。将热力学第一定律应用于作为控制体的该物体，其内能变化率 $\\frac{dE}{dt}$ 必须等于传入物体的净热流率。在本例中，热量通过对流从物体传出。\n\n物体的内能变化率由下式给出：\n$$\n\\frac{dE}{dt} = \\rho V c_p \\frac{dT}{dt}\n$$\n\n从物体表面到环境流体的对流换热率 $\\dot{Q}_{conv}$ 由牛顿冷却定律描述：\n$$\n\\dot{Q}_{conv} = h(T) A (T - T_\\infty)\n$$\n问题指定了一个与温度相关的换热系数，其形式为：\n$$\nh(T) = h_0 [1 + \\beta(T - T_\\infty)]\n$$\n其中 $h_0$ 和 $\\beta$ 是已知常数。\n\n物体的能量平衡方程为 $\\frac{dE}{dt} = -\\dot{Q}_{conv}$，其中负号表示热量从物体传出导致其内能减少。代入相关表达式，我们得到非线性常微分控制方程（ODE）：\n$$\n\\rho V c_p \\frac{dT}{dt} = -h_0 [1 + \\beta(T - T_\\infty)] A (T - T_\\infty)\n$$\n为简化求解，我们定义一个新变量来表示温差，$\\theta(t) = T(t) - T_\\infty$。因此，其时间导数为 $\\frac{d\\theta}{dt} = \\frac{dT}{dt}$，初始条件为 $\\theta(0) = T(0) - T_\\infty \\equiv \\theta_0$。将 $\\theta(t)$ 代入ODE，得到：\n$$\n\\rho V c_p \\frac{d\\theta}{dt} = -h_0 A [1 + \\beta\\theta] \\theta\n$$\n这是一个一阶、非线性但可分离的常微分方程。我们可以按如下方式分离变量 $\\theta$ 和 $t$：\n$$\n\\frac{d\\theta}{\\theta(1 + \\beta\\theta)} = -\\frac{h_0 A}{\\rho V c_p} dt\n$$\n我们对等式两边进行积分。左边从初始状态 $\\theta_0$ 积分到任意时间 $t$ 时的状态 $\\theta(t)$，右边从 $t'=0$ 积分到 $t'=t$：\n$$\n\\int_{\\theta_0}^{\\theta(t)} \\frac{d\\theta'}{\\theta'(1 + \\beta\\theta')} = \\int_{0}^{t} -\\frac{h_0 A}{\\rho V c_p} dt'\n$$\n右侧的积分是初等的：\n$$\n-\\frac{h_0 A}{\\rho V c_p} \\int_{0}^{t} dt' = -\\frac{h_0 A t}{\\rho V c_p}\n$$\n为计算左侧的积分，我们对被积函数采用部分分式分解法：\n$$\n\\frac{1}{\\theta'(1 + \\beta\\theta')} = \\frac{C}{\\theta'} + \\frac{D}{1 + \\beta\\theta'}\n$$\n通过求解常数，我们得到 $C=1$ 和 $D=-\\beta$。积分于是变为：\n$$\n\\int_{\\theta_0}^{\\theta(t)} \\left( \\frac{1}{\\theta'} - \\frac{\\beta}{1 + \\beta\\theta'} \\right) d\\theta' = \\left[ \\ln|\\theta'| - \\ln|1 + \\beta\\theta'| \\right]_{\\theta_0}^{\\theta(t)} = \\left[ \\ln\\left| \\frac{\\theta'}{1 + \\beta\\theta'} \\right| \\right]_{\\theta_0}^{\\theta(t)}\n$$\n应用积分限，我们得到：\n$$\n\\ln\\left| \\frac{\\theta(t)}{1 + \\beta\\theta(t)} \\right| - \\ln\\left| \\frac{\\theta_0}{1 + \\beta\\theta_0} \\right| = \\ln\\left| \\frac{\\theta(t)(1 + \\beta\\theta_0)}{\\theta_0(1 + \\beta\\theta(t))} \\right|\n$$\n考虑到对于连续的冷却或加热过程，$\\theta(t)$ 不会改变符号，并且对于给定的参数，项 $1+\\beta\\theta$ 保持为正，因此可以省略绝对值符号。将两边积分的结果相等，得到：\n$$\n\\ln\\left( \\frac{\\theta(t)(1 + \\beta\\theta_0)}{\\theta_0(1 + \\beta\\theta(t))} \\right) = -\\frac{h_0 A t}{\\rho V c_p}\n$$\n对两边取指数以消去对数：\n$$\n\\frac{\\theta(t)(1 + \\beta\\theta_0)}{\\theta_0(1 + \\beta\\theta(t))} = \\exp\\left(-\\frac{h_0 A t}{\\rho V c_p}\\right)\n$$\n现在我们求解这个关于 $\\theta(t)$ 的代数方程：\n$$\n\\theta(t)(1 + \\beta\\theta_0) = \\theta_0 (1 + \\beta\\theta(t)) \\exp\\left(-\\frac{h_0 A t}{\\rho V c_p}\\right)\n$$\n$$\n\\theta(t)(1 + \\beta\\theta_0) = \\theta_0 \\exp\\left(-\\frac{h_0 A t}{\\rho V c_p}\\right) + \\theta_0 \\beta \\theta(t) \\exp\\left(-\\frac{h_0 A t}{\\rho V c_p}\\right)\n$$\n$$\n\\theta(t) \\left[ (1 + \\beta\\theta_0) - \\beta \\theta_0 \\exp\\left(-\\frac{h_0 A t}{\\rho V c_p}\\right) \\right] = \\theta_0 \\exp\\left(-\\frac{h_0 A t}{\\rho V c_p}\\right)\n$$\n分离出 $\\theta(t)$，并将分子和分母同除以指数项，得到以下稳健的形式：\n$$\n\\theta(t) = \\frac{\\theta_0}{(1 + \\beta\\theta_0)\\exp\\left(\\frac{h_0 A t}{\\rho V c_p}\\right) - \\beta\\theta_0}\n$$\n最后，我们换回原始温度变量 $T(t) = T_\\infty + \\theta(t)$，并代入 $\\theta_0 = T_0 - T_\\infty$：\n$$\nT(t) = T_\\infty + \\frac{T_0 - T_\\infty}{(1 + \\beta(T_0 - T_\\infty))\\exp\\left(\\frac{h_0 A t}{\\rho V c_p}\\right) - \\beta(T_0 - T_\\infty)}\n$$\n这就是物体温度演化的闭式解析解。将使用此表达式来计算所提供测试用例的结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the temperature of a body cooling via convection with a\n    temperature-dependent heat transfer coefficient.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is in the format:\n    # (rho, cp, V, A, h0, beta, T_inf, T0, t)\n    # with all quantities in standard SI units.\n    test_cases = [\n        # Case 1 (general nonlinear behavior)\n        (1000, 4180, 0.001, 0.05, 100, 0.01, 293.15, 363.15, 600),\n        # Case 2 (linear limit, beta=0)\n        (1000, 4180, 0.001, 0.05, 100, 0.0, 293.15, 363.15, 600),\n        # Case 3 (no initial temperature difference)\n        (1000, 4180, 0.001, 0.05, 100, 0.01, 293.15, 293.15, 600),\n        # Case 4 (negative coefficient sensitivity)\n        (1000, 4180, 0.001, 0.05, 100, -0.01, 293.15, 343.15, 600),\n        # Case 5 (initially colder than ambient)\n        (1000, 4180, 0.001, 0.05, 100, 0.02, 293.15, 273.15, 600),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        rho, cp, V, A, h0, beta, T_inf, T0, t = case\n        \n        # Calculate the initial temperature difference, theta_0\n        theta0 = T0 - T_inf\n        \n        # Handle the trivial case where initial temperature equals ambient temperature\n        if np.isclose(theta0, 0.0):\n            T_t = T_inf\n            results.append(T_t)\n            continue\n\n        # Derived analytical solution:\n        # T(t) = T_inf + theta_0 / ((1 + beta*theta_0)*exp(k*t) - beta*theta_0)\n        # where k = (h0 * A) / (rho * V * cp)\n\n        # Calculate the exponent coefficient k\n        k = (h0 * A) / (rho * V * cp)\n        \n        # Calculate the exponential term\n        exp_kt = np.exp(k * t)\n        \n        # Calculate the denominator of the theta(t) expression\n        denominator = (1 + beta * theta0) * exp_kt - beta * theta0\n        \n        # Calculate theta(t)\n        theta_t = theta0 / denominator\n        \n        # Calculate the final temperature T(t)\n        T_t = T_inf + theta_t\n        \n        results.append(T_t)\n\n    # Final print statement in the exact required format.\n    # The output is a comma-separated list of temperatures in Kelvin,\n    # rounded to six decimal places, enclosed in square brackets.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2512093"}, {"introduction": "在传统的传热学问题中，我们通常假设模型参数已知，然后预测系统行为。然而，在科学研究和工程实践中，我们更常面对“逆问题”：如何利用带有噪声的实验数据来推断未知的物理参数，例如对流换热系数 $h$ 和环境温度 $T_{\\infty}$。本练习将带您进入参数估计的前沿领域，运用贝叶斯推断的框架来解决这一问题，您将学习如何将物理模型、测量数据（似然函数）和先验知识结合起来，构建参数的后验概率分布。通过这项实践，您将掌握一种处理不确定性的强大范式，这对于任何基于数据的科学和工程研究都至关重要。[@problem_id:2512092]", "problem": "一个质量为 $m$、比热容为 $c_p$、表面积为 $A$ 的小型热均匀体，突然暴露在一个环境温度 $T_{\\infty}$ 未知的静止环境中。该物体通过对流与环境进行热交换，其特征为一个未知的对流换热系数 $h$。物体的初始温度 $T(0)$（记为 $T_0$）是不确定的。您在已知时间 $t_1,\\dots,t_n$ 测量该物体的温度，获得数据 $y_1,\\dots,y_n$，其中每次测量都受到方差为 $\\sigma^2$ 的独立加性噪声的干扰。\n\n采用贝叶斯参数推断的观点，其中未知量为 $h$、$T_{\\infty}$ 和 $T_0$。假设以下独立先验：$\\ln h \\sim \\mathcal{N}(\\mu_h,s_h^2)$、$T_{\\infty} \\sim \\mathcal{N}(\\mu_{\\infty},s_{\\infty}^2)$ 和 $T_0 \\sim \\mathcal{N}(\\mu_0,s_0^2)$，其中所有超参数和物理常数 $(\\mu_h,s_h,\\mu_{\\infty},s_{\\infty},\\mu_0,s_0,m,c_p,A,\\sigma^2)$ 均为已知。\n\n从一个空间等温体在静止环境中进行对流冷却的第一性原理能量平衡出发，推导出决定模型预测的瞬态温度的闭式解 $T(t;h,T_{\\infty},T_0)$，为观测数据 $\\{(t_i,y_i)\\}_{i=1}^n$ 构建高斯似然，然后将其与给定的先验结合，以生成给定数据下 $(h,T_{\\infty},T_0)$ 的未归一化联合后验密度。请将您的最终答案表示为未归一化后验密度 $p(h,T_{\\infty},T_0 \\mid \\{t_i,y_i\\}_{i=1}^n)$ 的单一闭式解析表达式，该表达式可相差一个不依赖于 $(h,T_{\\infty},T_0)$ 的乘法常数。不要简化为特殊情况或假设任何极限状态。\n\n您的最终答案必须是单一的闭式解析表达式。不包含单位。无需数值取整。", "solution": "所提出的问题是贝叶斯参数估计应用于一个已被充分理解的物理过程的标准练习。该问题陈述在科学上是合理的，在数学上是适定的，并且是完整的。我将继续进行推导。\n\n分析始于热均匀体的第一性原理能量平衡。空间等温体的假设等同于传热学中的集总电容模型。物体内能的变化率必须等于从其周围环境传递给物体的净传热速率。在这种情况下，传热仅通过对流发生。因此，能量平衡方程为：\n$$m c_p \\frac{dT}{dt} = -h A (T(t) - T_{\\infty})$$\n在这里，$T(t)$ 是物体在时间 $t$ 的温度，$m$ 是其质量，$c_p$ 是其比热容，$A$ 是其表面积，$h$ 是对流换热系数，$T_{\\infty}$ 是环境温度。负号表示当物体温度 $T(t)$ 高于环境温度 $T_{\\infty}$ 时，物体会损失能量。\n\n这是一个一阶线性常微分方程。为了求解该方程，我们定义一个温差变量 $\\theta(t) = T(t) - T_{\\infty}$。其时间导数为 $\\frac{d\\theta}{dt} = \\frac{dT}{dt}$。方程变换为：\n$$m c_p \\frac{d\\theta}{dt} = -h A \\theta$$\n我们定义热时间常数 $\\tau = \\frac{m c_p}{h A}$。方程变为：\n$$\\frac{d\\theta}{dt} = -\\frac{1}{\\tau} \\theta$$\n该方程是可分离变量的，可以积分：\n$$\\int \\frac{d\\theta}{\\theta} = -\\int \\frac{1}{\\tau} dt$$\n$$\\ln(\\theta) = -\\frac{t}{\\tau} + C_1$$\n其中 $C_1$ 是积分常数。对两边取指数得到：\n$$\\theta(t) = \\exp\\left(-\\frac{t}{\\tau} + C_1\\right) = C \\exp\\left(-\\frac{t}{\\tau}\\right)$$\n其中 $C = \\exp(C_1)$。将 $\\theta(t)$ 和 $\\tau$ 代回：\n$$T(t) - T_{\\infty} = C \\exp\\left(-\\frac{hAt}{m c_p}\\right)$$\n常数 $C$ 由初始条件 $T(0) = T_0$ 确定。在 $t=0$ 时：\n$$T_0 - T_{\\infty} = C \\exp(0) = C$$\n因此，物体瞬态温度的具体解，我们记为 $T(t; h, T_{\\infty}, T_0)$，是：\n$$T(t; h, T_{\\infty}, T_0) = T_{\\infty} + (T_0 - T_{\\infty}) \\exp\\left(-\\frac{hAt}{m c_p}\\right)$$\n这是物体温度的确定性模型预测。\n\n接下来，我们构建似然函数。在时间 $t_i$ 的测量值 $y_i$ 被建模为真实温度 $T(t_i)$ 受到独立加性高斯噪声 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$ 的干扰。因此，单个测量值 $y_i$ 在参数 $(h, T_{\\infty}, T_0)$ 条件下的概率分布是一个高斯分布：\n$$p(y_i \\mid h, T_{\\infty}, T_0) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(y_i - T(t_i; h, T_{\\infty}, T_0))^2}{2\\sigma^2}\\right)$$\n鉴于测量误差是独立的，整个数据集 $\\{y_i\\}_{i=1}^n$ 的联合似然是各个概率的乘积：\n$$p(\\{y_i\\}_{i=1}^n \\mid h, T_{\\infty}, T_0) = \\prod_{i=1}^n p(y_i \\mid h, T_{\\infty}, T_0)$$\n$$p(\\{y_i\\}_{i=1}^n \\mid h, T_{\\infty}, T_0) = \\left(\\frac{1}{2\\pi\\sigma^2}\\right)^{n/2} \\exp\\left(-\\frac{1}{2\\sigma^2}\\sum_{i=1}^n (y_i - T(t_i; h, T_{\\infty}, T_0))^2 \\right)$$\n\n第三步是指定未知参数 $(h, T_{\\infty}, T_0)$ 的联合先验分布。问题陈述它们是独立的，所以联合先验是各个先验的乘积：\n$$p(h, T_{\\infty}, T_0) = p(h) p(T_{\\infty}) p(T_0)$$\n指定的先验如下：\n1. 对于 $h$：$\\ln h \\sim \\mathcal{N}(\\mu_h, s_h^2)$。这是一个关于 $h$ 的对数正态分布。其概率密度函数为 $p(h) = \\frac{1}{h s_h \\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln h - \\mu_h)^2}{2s_h^2}\\right)$。\n2. 对于 $T_{\\infty}$：$T_{\\infty} \\sim \\mathcal{N}(\\mu_{\\infty}, s_{\\infty}^2)$。其密度为 $p(T_{\\infty}) = \\frac{1}{s_{\\infty}\\sqrt{2\\pi}} \\exp\\left(-\\frac{(T_{\\infty} - \\mu_{\\infty})^2}{2s_{\\infty}^2}\\right)$。\n3. 对于 $T_0$：$T_0 \\sim \\mathcal{N}(\\mu_0, s_0^2)$。其密度为 $p(T_0) = \\frac{1}{s_0\\sqrt{2\\pi}} \\exp\\left(-\\frac{(T_0 - \\mu_0)^2}{2s_0^2}\\right)$。\n\n根据贝叶斯定理，后验概率密度与似然和先验的乘积成正比：\n$$p(h, T_{\\infty}, T_0 \\mid \\{y_i\\}_{i=1}^n) \\propto p(\\{y_i\\}_{i=1}^n \\mid h, T_{\\infty}, T_0) \\ p(h, T_{\\infty}, T_0)$$\n题目要求我们给出未归一化的后验，这意味着我们可以忽略任何不依赖于参数 $(h, T_{\\infty}, T_0)$ 的乘法因子。结合似然和先验的表达式，并舍去归一化常数，我们得到：\n$$p(h, T_{\\infty}, T_0 \\mid \\{y_i\\}) \\propto \\exp\\left(-\\frac{1}{2\\sigma^2}\\sum_{i=1}^n \\left[y_i - T(t_i; h, T_{\\infty}, T_0)\\right]^2 \\right) \\times \\frac{1}{h} \\exp\\left(-\\frac{(\\ln h - \\mu_h)^2}{2s_h^2}\\right) \\times \\exp\\left(-\\frac{(T_{\\infty} - \\mu_{\\infty})^2}{2s_{\\infty}^2}\\right) \\times \\exp\\left(-\\frac{(T_0 - \\mu_0)^2}{2s_0^2}\\right)$$\n来自 $h$ 的对数正态先验的雅可比因子 $1/h$ 必须保留。代入 $T(t_i; h, T_{\\infty}, T_0)$ 的表达式并合并指数项，即可得到未归一化后验密度的最终形式：\n\\begin{align*} p(h, T_{\\infty}, T_0 \\mid \\{y_i\\}_{i=1}^n) \\propto \\frac{1}{h} \\exp\\Bigg(-\\frac{(\\ln h - \\mu_h)^2}{2s_h^2} -\\frac{(T_0 - \\mu_0)^2}{2s_0^2} -\\frac{(T_{\\infty} - \\mu_{\\infty})^2}{2s_{\\infty}^2} \\\\ -\\frac{1}{2\\sigma^2} \\sum_{i=1}^n \\left[y_i - T_{\\infty} - (T_0 - T_{\\infty}) \\exp\\left(-\\frac{hAt_i}{m c_p}\\right) \\right]^2 \\Bigg) \\end{align*}\n该表达式代表了所要求的完整解。它是给定数据和先验信念下，参数的未归一化联合后验密度的闭式解析表达式。", "answer": "$$\\boxed{\\frac{1}{h} \\exp\\left(-\\frac{\\left(\\ln h - \\mu_h\\right)^2}{2s_h^2} - \\frac{\\left(T_0 - \\mu_0\\right)^2}{2s_0^2} - \\frac{\\left(T_{\\infty} - \\mu_{\\infty}\\right)^2}{2s_{\\infty}^2} - \\frac{1}{2\\sigma^2} \\sum_{i=1}^n \\left[y_i - T_{\\infty} - (T_0 - T_{\\infty}) \\exp\\left(-\\frac{hAt_i}{m c_p}\\right)\\right]^2\\right)}$$", "id": "2512092"}]}