{"hands_on_practices": [{"introduction": "本练习将从最基本的物理原理出发，建立对数平均温差（LMTD）修正系数的理论基础。通过对非混合交叉流换热器中的微元进行能量平衡分析，您将推导出在热容率比 $C_r \\to 0$ 这一重要极限情况下的修正系数 $F$ 的行为。这项实践将深刻揭示为何在冷凝或蒸发等相变换热过程中，复杂的流型简化并表现出与理想逆流换热器相同的性能([@problem_id:2474747])。", "problem": "一台非混合-非混合错流换热器在总面积为 $A$、总传热系数为 $U$ 的条件下，在热流体和冷流体之间进行热量交换。设热流体的热容率为 $C_{h}$，冷流体的热容率为 $C_{c}$。入口温度分别为 $T_{h,\\mathrm{in}}$ 和 $T_{c,\\mathrm{in}}$。定义热容率比 $C_{r} \\equiv C_{\\min}/C_{\\max}$，其中 $C_{\\min} \\equiv \\min\\{C_{h},C_{c}\\}$ 且 $C_{\\max} \\equiv \\max\\{C_{h},C_{c}\\}$。真实平均温差 $\\Delta T_{\\mathrm{true}}$ 由 $Q = U A\\, \\Delta T_{\\mathrm{true}}$ 隐式定义，其中 $Q$ 是总传热速率。标准逆流对数平均温差 $\\Delta T_{\\mathrm{lm,c}}$ 仅由使用相同四个终端温度的逆流布置下的终端温差定义。\n\n仅使用：\n- 微元控制体上的局部能量平衡，\n- 热容率的定义以及 $C_{r} \\to 0$ 的极限，\n- 以及用终端温差表示的逆流对数平均温差的定义，\n\n推导此非混合-非混合错流换热器在 $C_{r} \\to 0$ 时，对数平均温差修正系数 $F \\equiv \\Delta T_{\\mathrm{true}}/\\Delta T_{\\mathrm{lm,c}}$ 的极限值，并简要地对结果进行物理诠释。将最终答案表示为一个无量纲数。无需四舍五入。", "solution": "该问题被认为是有效的，因为它有科学依据、提法恰当、客观且自洽。这是传热学理论中的一个标准问题，可以使用基本原理来解决。\n\n我们首先对非混合-非混合错流换热器进行建模。设热流体沿 $x$ 方向流动，长度为 $L_x$；冷流体沿 $y$ 方向流动，长度为 $L_y$。总传热面积为 $A = L_x L_y$。对于非混合流，每股流体的温度都是两个坐标的函数，即 $T_h(x, y)$ 和 $T_c(x, y)$。然而，由于两种流体都是非混合的，我们可以分析无限小的流体通道。对于给定 $y$ 处的某一条热流体通道，其温度仅沿 $x$ 方向变化。对于给定 $x$ 处的某一条冷流体通道，其温度仅沿 $y$ 方向变化。在微元面积 $dA=dx\\,dy$ 上的局部能量平衡方程为：\n\n对于热流体：\n$$-\\frac{C_h}{L_y} \\frac{\\partial T_h}{\\partial x} dx\\,dy = U(T_h - T_c) dx\\,dy \\implies \\frac{\\partial T_h}{\\partial x} = -\\frac{U L_y}{C_h} (T_h - T_c)$$\n\n对于冷流体：\n$$\\frac{C_c}{L_x} \\frac{\\partial T_c}{\\partial y} dx\\,dy = U(T_h - T_c) dx\\,dy \\implies \\frac{\\partial T_c}{\\partial y} = \\frac{U L_x}{C_c} (T_h - T_c)$$\n\n题目要求我们求出当热容率比 $C_r \\equiv C_{\\min}/C_{\\max}$ 趋近于零时，修正系数 $F$ 的极限。$C_r \\to 0$ 的极限意味着其中一种流体的热容率比另一种大无穷多。在物理上，当其中一种流体在恒定温度下发生相变（例如冷凝或蒸发）时，便会满足此条件。\n\n我们考虑热流体具有无限大热容率的情况，即 $C_h = C_{\\max} \\to \\infty$ 且 $C_c = C_{\\min}$。当 $C_h \\to \\infty$ 时，对于任意有限的传热速率 $Q = C_h(T_{h,\\mathrm{in}} - T_{h,\\mathrm{out}})$，温差 $(T_{h,\\mathrm{in}} - T_{h,\\mathrm{out}})$ 必须为零。因此，热流体的温度在整个换热器中保持恒定：$T_h(x, y) = T_{h,\\mathrm{in}}$。\n\n在热流体温度恒定的情况下，冷流体的能量平衡方程得以简化。由于热流体温度 $T_{h,\\mathrm{in}}$ 是均匀的，在给定的下游位置 $y$，冷流体温度 $T_c$ 对于任何横向位置 $x$ 都将是相同的。因此，$T_c$ 仅成为 $y$ 的函数，即 $T_c(y)$。冷流体的偏微分方程简化为对于任意 $x$ 处流股的常微分方程：\n$$\\frac{dT_c}{dy} = \\frac{U L_x}{C_c} (T_{h,\\mathrm{in}} - T_c(y))$$\n\n我们求解这个一阶线性常微分方程，其边界条件为 $T_c(y=0) = T_{c,\\mathrm{in}}$。令 $\\Delta T(y) = T_{h,\\mathrm{in}} - T_c(y)$。方程变为 $\\frac{d(\\Delta T)}{dy} = -\\frac{dT_c}{dy}$，于是我们有：\n$$-\\frac{d(\\Delta T)}{dy} = \\frac{U L_x}{C_c} \\Delta T \\implies \\frac{d(\\Delta T)}{\\Delta T} = -\\frac{U L_x}{C_c} dy$$\n\n从入口（$y=0$）积分到位置 $y$：\n$$\\int_{\\Delta T_{\\mathrm{in}}}^{\\Delta T(y)} \\frac{d(\\Delta T')}{\\Delta T'} = -\\int_0^y \\frac{U L_x}{C_c} dy'$$\n其中 $\\Delta T_{\\mathrm{in}} = T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}$。\n$$\\ln\\left(\\frac{\\Delta T(y)}{\\Delta T_{\\mathrm{in}}}\\right) = -\\frac{U L_x y}{C_c} \\implies \\Delta T(y) = \\Delta T_{\\mathrm{in}} \\exp\\left(-\\frac{U L_x y}{C_c}\\right)$$\n冷流体的出口温度 $T_{c,\\mathrm{out}}$ 出现在 $y=L_y$ 处。因为 $T_c$ 不是 $x$ 的函数，所以平均出口温度就是 $T_c(L_y)$。\n$$T_{h,\\mathrm{in}} - T_{c,\\mathrm{out}} = (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) \\exp\\left(-\\frac{U L_x L_y}{C_c}\\right) = (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) \\exp\\left(-\\frac{U A}{C_c}\\right)$$\n在这种情况下，$C_c = C_{\\min}$，因此我们定义传热单元数 $N \\equiv \\frac{UA}{C_{\\min}} = \\frac{UA}{C_c}$。\n$$T_{c,\\mathrm{out}} = T_{h,\\mathrm{in}} - (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) \\exp(-N)$$\n\n总传热速率 $Q$ 由 $Q = C_c(T_{c,\\mathrm{out}}-T_{c,\\mathrm{in}})$ 给出。\n$$Q = C_c \\left[ \\left(T_{h,\\mathrm{in}} - (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) \\exp(-N)\\right) - T_{c,\\mathrm{in}} \\right]$$\n$$Q = C_c \\left[ (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) - (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) \\exp(-N) \\right] = C_c (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}})(1 - \\exp(-N))$$\n由于 $C_c = C_{\\min}$，所以 $Q = C_{\\min} (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}})(1 - \\exp(-N))$。\n\n真实平均温差 $\\Delta T_{\\mathrm{true}}$ 由 $Q = U A\\, \\Delta T_{\\mathrm{true}}$ 定义。\n$$\\Delta T_{\\mathrm{true}} = \\frac{Q}{UA} = \\frac{C_{\\min} (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}})(1 - \\exp(-N))}{UA}$$\n代入 $C_{\\min} = \\frac{UA}{N}$：\n$$\\Delta T_{\\mathrm{true}} = \\frac{(UA/N) (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}})(1 - \\exp(-N))}{UA} = (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) \\frac{1 - \\exp(-N)}{N}$$\n\n接下来，我们使用我们错流换热器的终端温度，计算逆流布置的对数平均温差 $\\Delta T_{\\mathrm{lm,c}}$。四个终端温度是：\n$T_{h,\\mathrm{in}}$\n$T_{h,\\mathrm{out}} = T_{h,\\mathrm{in}}$ (因为 $C_h \\to \\infty$)\n$T_{c,\\mathrm{in}}$\n$T_{c,\\mathrm{out}} = T_{h,\\mathrm{in}} - (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) \\exp(-N)$\n\n对于逆流配置，终端温差为 $\\Delta T_1 = T_{h,\\mathrm{in}} - T_{c,\\mathrm{out}}$ 和 $\\Delta T_2 = T_{h,\\mathrm{out}} - T_{c,\\mathrm{in}}$。\n$$\\Delta T_1 = T_{h,\\mathrm{in}} - \\left[ T_{h,\\mathrm{in}} - (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) \\exp(-N) \\right] = (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) \\exp(-N)$$\n$$\\Delta T_2 = T_{h,\\mathrm{out}} - T_{c,\\mathrm{in}} = T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}$$\n逆流的对数平均温差为 $\\Delta T_{\\mathrm{lm,c}} = \\frac{\\Delta T_1 - \\Delta T_2}{\\ln(\\Delta T_1 / \\Delta T_2)}$。\n$$\\Delta T_{\\mathrm{lm,c}} = \\frac{(T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) \\exp(-N) - (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}})}{\\ln\\left(\\frac{(T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) \\exp(-N)}{(T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}})}\\right)}$$\n$$\\Delta T_{\\mathrm{lm,c}} = \\frac{(T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}})(\\exp(-N) - 1)}{\\ln(\\exp(-N))} = \\frac{(T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}})(\\exp(-N) - 1)}{-N} = (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}})\\frac{1 - \\exp(-N)}{N}$$\n\n最后，我们计算修正系数 $F \\equiv \\Delta T_{\\mathrm{true}}/\\Delta T_{\\mathrm{lm,c}}$。\n$$F = \\frac{(T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) \\frac{1 - \\exp(-N)}{N}}{(T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) \\frac{1 - \\exp(-N)}{N}} = 1$$\n如果我们考虑 $C_c \\to \\infty$ 且 $C_h = C_{\\min}$ 的情况，将得到相同的结果。\n\n这个结果 $F=1$ 的物理诠释是，当一种流体保持恒定温度时，换热器的性能变得与流动布置无关。有限热容率的流体的温度分布是响应来自另一流体的均匀温度场而形成的。因此，错流布置的平均温差变得与纯逆流（或顺流）布置的平均温差相同。用于量化与理想逆流情况偏差的修正系数因此等于 $1$。", "answer": "$$\\boxed{1}$$", "id": "2474747"}, {"introduction": "在掌握了理论极限之后，下一个实践将理论与工程应用联系起来。您将通过编写程序，利用成熟的效能-NTU（$\\varepsilon$-NTU）关系式来计算修正系数 $F$ ([@problem_id:2474698])。通过一系列参数测试，您不仅可以数值验证前一个练习中推导出的理论极限，还能直观地探索在一般工况下，$F$ 是如何随传热单元数（NTU）和热容率比（$C_r$）变化的。", "problem": "考虑两股稳态、单程流体通过一具有均匀总传热系数的等温隔板进行热交换。令热、冷流体分别用下标 $h$ 和 $c$ 表示，流动方式为错流且两股流体均不混合。假设比热恒定，忽略轴向热传导和辐射，且无热量损失到环境中。令热容率分别为 $C_h$ 和 $C_c$，其中 $C_{\\min} = \\min(C_h,C_c)$，$C_{\\max} = \\max(C_h,C_c)$，热容率比 $C_r = C_{\\min}/C_{\\max} \\in (0,1]$。令总传热面积为 $A$，总传热系数为 $U$。定义传热单元数 $\\mathrm{NTU} = U A / C_{\\min}$。令入口温度为 $T_{h,\\mathrm{in}}$ 和 $T_{c,\\mathrm{in}}$。\n\n温度效能定义为 $\\varepsilon = Q / \\left(C_{\\min} (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}})\\right)$，其中 $Q$ 是由能量守恒决定的总传热速率。根据两股流体的混合出口温度计算的逆流对数平均温差 (LMTD) 为\n$$\n\\Delta T_{\\mathrm{lm,counter}} = \\frac{\\Delta T_1 - \\Delta T_2}{\\ln\\left(\\Delta T_1 / \\Delta T_2\\right)},\n\\quad\n\\Delta T_1 = T_{h,\\mathrm{in}} - T_{c,\\mathrm{out}},\n\\quad\n\\Delta T_2 = T_{h,\\mathrm{out}} - T_{c,\\mathrm{in}}.\n$$\n对于非逆流布置，LMTD 修正系数 $F$ 定义为\n$$\nQ = U A \\, F \\, \\Delta T_{\\mathrm{lm,counter}}.\n$$\n\n您的任务是编写一个完整的程序，以数值方式验证以下极限论断：当横截面塌缩成一个与另一股流体反向的细长通道时，错流的 $F$ 值趋近于单程逆流的 $F$ 值。将此极限解释为 $C_r \\to 0$ 的渐近状态，该状态模拟了一股流体相对于另一股流体具有渐近大的热容率（细长通道极限），而流动方式保持为错流且两股流体均不混合。使用能量守恒以及对数平均温差 (LMTD) 和温度效能的定义。对于错流、两流体均不混合的布置，您可以使用任何广泛接受、经过充分检验的效能关联式，以获得作为 $\\mathrm{NTU}$ 和 $C_r$ 函数的 $\\varepsilon(\\mathrm{NTU}, C_r)$。\n\n算法要求：\n- 给定 $(\\mathrm{NTU}, C_r)$，选择 $C_{\\min} = 1 \\,\\mathrm{W/K}$ 和 $C_{\\max} = C_{\\min}/C_r$，并设置 $U A = \\mathrm{NTU}\\, C_{\\min}$，这样问题无需额外的物理尺寸即可完全确定。\n- 在给定的 $T_{h,\\mathrm{in}}$ 和 $T_{c,\\mathrm{in}}$ 下，计算 $\\varepsilon$，然后计算 $Q = \\varepsilon C_{\\min} (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}})$，以及混合出口温度\n$$\nT_{h,\\mathrm{out}} = T_{h,\\mathrm{in}} - \\frac{Q}{C_h}, \\qquad T_{c,\\mathrm{out}} = T_{c,\\mathrm{in}} + \\frac{Q}{C_c}.\n$$\n- 根据 $(T_{h,\\mathrm{in}}, T_{h,\\mathrm{out}}, T_{c,\\mathrm{in}}, T_{c,\\mathrm{out}})$ 计算 $\\Delta T_{\\mathrm{lm,counter}}$，然后计算 $F = Q / \\left(U A \\, \\Delta T_{\\mathrm{lm,counter}}\\right)$。\n- 通过在固定的 $\\mathrm{NTU}$ 下评估 $F$ 值（$C_r$ 递减）以及针对各种 $(\\mathrm{NTU}, C_r)$ 对进行评估，来数值验证该极限论断。\n\n对所有测试案例使用以下固定的入口温度：$T_{h,\\mathrm{in}} = 400 \\,\\mathrm{K}$ 和 $T_{c,\\mathrm{in}} = 300 \\,\\mathrm{K}$。对于错流效能，请使用一个针对两流体均不混合的、经过充分检验的关联式。在奇异极限 $C_r \\to 0$ 时，确保您的实现使用由关联式和守恒原理所蕴含的适当极限形式。\n\n测试套件：\n- 案例 1: $\\mathrm{NTU} = 1.0$, $C_r = 1.0$。\n- 案例 2: $\\mathrm{NTU} = 1.0$, $C_r = 0.1$。\n- 案例 3: $\\mathrm{NTU} = 2.0$, $C_r = 0.01$。\n- 案例 4: $\\mathrm{NTU} = 0.2$, $C_r = 0.5$。\n- 案例 5: $\\mathrm{NTU} = 3.0$, $C_r = 0.7$。\n\n对于每个案例，输出计算出的 $F$ 值，格式为浮点数，保留六位小数。您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表（例如，“[f1,f2,f3,f4,f5]”）。由于 $F$ 是无量纲的，输出中不需要物理单位。", "solution": "问题陈述已得到严格评估，并被确定为有效。它构成了换热器分析领域一个适定性良好的练习，符合传热传质的既定原理。其前提在科学上是合理的，目标定义明确，并提供了足够的信息来构建一个唯一、稳定且有意义的解决方案。任务是数值验证错流布置下对数平均温差 (LMTD) 修正系数 $F$ 的一个已知理论极限。我们将按规定进行求解。\n\n问题的核心是，在给定传热单元数 $\\mathrm{NTU}$ 和热容率比 $C_r = C_{\\min}/C_{\\max}$ 的情况下，计算两流体均不混合的错流换热器的 LMTD 修正系数 $F$。系数 $F$ 通过方程 $Q = U A F \\Delta T_{\\mathrm{lm,counter}}$，将实际传热速率 $Q$ 与具有相同终端温度的理想逆流换热器所能达到的速率联系起来。必须精确遵循问题陈述所规定的程序步骤。\n\n首先，我们必须为两流体均不混合的错流换热器的效能 $\\varepsilon$ 选择一个合适的关联式。一个被广泛接受的、由 Mason (1954) 提出且适用于本问题中 $\\mathrm{NTU}$ 和 $C_r$ 范围的近似关联式是：\n$$\n\\varepsilon = 1 - \\exp\\left[ \\frac{\\mathrm{NTU}^{0.22}}{C_r} \\left( \\exp\\left[-C_r \\mathrm{NTU}^{0.78}\\right] - 1 \\right) \\right]\n$$\n该公式提供了作为 $\\mathrm{NTU}$ 和 $C_r$ 函数的效能 $\\varepsilon$。在 $C_r \\to 0$ 的极限情况下（对应于一种流体具有无限大的热容率，例如在相变过程中），该表达式正确地收敛到适用于任何换热器的极限形式：\n$$\n\\lim_{C_r \\to 0} \\varepsilon = 1 - \\exp\\left[-\\mathrm{NTU}\\right]\n$$\n在计算中，我们将使用完整的关联式，因为给定的 $C_r$ 值还不足以引起数值不稳定性。\n\n对于每个给定的 $(\\mathrm{NTU}, C_r)$ 对，计算顺序如下：\n\n1.  **参数初始化**: 根据问题设定物理参数。我们使用给定的入口温度 $T_{h,\\mathrm{in}} = 400.0 \\, \\mathrm{K}$ 和 $T_{c,\\mathrm{in}} = 300.0 \\, \\mathrm{K}$。为创建一个无量纲的设置，我们设定最小热容率 $C_{\\min} = 1.0 \\, \\mathrm{W/K}$。最大热容率则为 $C_{\\max} = C_{\\min} / C_r = 1.0 / C_r \\, \\mathrm{W/K}$。总传热系数与面积的乘积为 $UA = \\mathrm{NTU} \\cdot C_{\\min}$。当 $C_{\\min} = 1.0$ 时，此式简化为 $UA = \\mathrm{NTU} \\, \\mathrm{W/K}$。\n\n2.  **效能计算**: 我们使用上述关联式为给定的 $\\mathrm{NTU}$ 和 $C_r$ 计算 $\\varepsilon$。\n\n3.  **传热速率**: 总传热速率 $Q$ 由效能的定义确定：\n    $$\n    Q = \\varepsilon C_{\\min} (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}})\n    $$\n\n4.  **出口温度计算**: 出口温度 $T_{h,\\mathrm{out}}$ 和 $T_{c,\\mathrm{out}}$ 通过对热、冷流体的能量平衡计算得出：\n    $$\n    T_{h,\\mathrm{out}} = T_{h,\\mathrm{in}} - \\frac{Q}{C_h}, \\qquad T_{c,\\mathrm{out}} = T_{c,\\mathrm{in}} + \\frac{Q}{C_c}\n    $$\n    在计算 $F$ 的背景下，将 $C_{\\min}$ 和 $C_{\\max}$ 分配给热流体 ($C_h$) 和冷流体 ($C_c$) 是任意的。最终的 $F$ 值仅是 $\\mathrm{NTU}$ 和 $C_r$ 的函数，与哪一股流体具有更高的热容率无关。为确保计算的确定性，我们将指定 $C_h = C_{\\max}$ 和 $C_c = C_{\\min}$，但即使反向指定，结果也是相同的。\n\n5.  **LMTD 计算**: 等效逆流布置的对数平均温差 $\\Delta T_{\\mathrm{lm,counter}}$ 使用终端温度计算：\n    $$\n    \\Delta T_{\\mathrm{lm,counter}} = \\frac{\\Delta T_1 - \\Delta T_2}{\\ln(\\Delta T_1 / \\Delta T_2)}\n    $$\n    其中 $\\Delta T_1 = T_{h,\\mathrm{in}} - T_{c,\\mathrm{out}}$ 和 $\\Delta T_2 = T_{h,\\mathrm{out}} - T_{c,\\mathrm{in}}$。当 $C_r=1$ 时会出现特殊情况，导致 $\\Delta T_1 = \\Delta T_2$。在这种情况下，LMTD 就是 $\\Delta T_{\\mathrm{lm,counter}} = \\Delta T_1$。我们的实现必须处理这种情况以避免除以零。\n\n6.  **修正系数计算**: 最后，通过重新整理其定义来计算修正系数 $F$：\n    $$\n    F = \\frac{Q}{U A \\cdot \\Delta T_{\\mathrm{lm,counter}}}\n    $$\n此程序将应用于问题陈述中提供的每个测试案例。预期结果将表明，随着 $C_r$ 的减小，$F$ 的值趋近于 1，从而证实了所述的极限行为，即错流换热器的性能变得与逆流换热器等效。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the heat exchanger problem by calculating the LMTD correction factor F\n    for a series of test cases as defined in the problem statement.\n    \"\"\"\n\n    # Test suite as provided in the problem.\n    # Each tuple is (NTU, C_r).\n    test_cases = [\n        (1.0, 1.0),\n        (1.0, 0.1),\n        (2.0, 0.01),\n        (0.2, 0.5),\n        (3.0, 0.7),\n    ]\n\n    # Fixed physical parameters for all test cases.\n    T_h_in = 400.0  # Hot stream inlet temperature in K\n    T_c_in = 300.0  # Cold stream inlet temperature in K\n    C_min = 1.0     # Minimum heat capacity rate in W/K\n\n    results = []\n    for ntu, cr in test_cases:\n        # Step 1: Calculate effectiveness (epsilon) for cross-flow, both fluids unmixed.\n        # The problem states C_r is in (0, 1]. For C_r -> 0, epsilon -> 1 - exp(-NTU).\n        # We use a well-known approximate correlation (Mason, 1954).\n        # The correlation is numerically stable for the provided test cases.\n        term1 = (ntu**0.22) / cr\n        term2 = np.exp(-cr * (ntu**0.78)) - 1\n        epsilon = 1.0 - np.exp(term1 * term2)\n        \n        # Step 2: Calculate the total heat transfer rate (Q).\n        Q = epsilon * C_min * (T_h_in - T_c_in)\n        \n        # Step 3: Calculate outlet temperatures.\n        # The final F-factor is independent of which stream (hot or cold) has C_min.\n        # For a consistent calculation, we assign C_max to the hot stream and C_min to the cold stream.\n        # This choice is arbitrary but does not affect the final result for F.\n        if cr == 1.0:\n            C_h = C_min\n            C_c = C_min\n        else:\n            C_max = C_min / cr\n            C_h = C_max\n            C_c = C_min\n            \n        T_h_out = T_h_in - Q / C_h\n        T_c_out = T_c_in + Q / C_c\n        \n        # Step 4: Calculate the Logarithmic Mean Temperature Difference for counter-flow (LMTD).\n        delta_T1 = T_h_in - T_c_out\n        delta_T2 = T_h_out - T_c_in\n        \n        # Handle the special case where delta_T1 is very close to delta_T2 (occurs when C_r=1).\n        # To avoid division by zero or floating point inaccuracies, if the difference is small,\n        # the LMTD is taken as the arithmetic mean (which is equal to delta_T1/delta_T2).\n        if abs(delta_T1 - delta_T2) < 1e-9:\n            lmtd_counter = delta_T1\n        else:\n            lmtd_counter = (delta_T1 - delta_T2) / np.log(delta_T1 / delta_T2)\n            \n        # Step 5: Calculate the LMTD correction factor (F).\n        # UA is defined as NTU * C_min.\n        UA = ntu * C_min\n        \n        # The denominator should not be zero for physically realistic cases with NTU > 0.\n        if UA == 0 or lmtd_counter == 0:\n            # This case should not be reached with the given test inputs.\n            F = 0.0\n        else:\n            F = Q / (UA * lmtd_counter)\n            \n        results.append(F)\n\n    # Format the final output as a comma-separated list of floats rounded to six decimal places,\n    # enclosed in square brackets.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2474698"}, {"introduction": "作为一项进阶实践，本练习要求您从零开始，应用有限体积法构建一个交叉流换热器的数值模拟器。这项任务将超越使用现成的关联式，让您能够直接计算换热器内的二维温度场分布，并由此求得真实的平均温差和修正系数 $F$ ([@problem_id:2474688])。通过亲手实现求解过程，您将对决定修正系数 $F$ 的物理机制获得最根本和深刻的理解。", "problem": "您的任务是推导、实现并测试一个非混合-非混合错流换热器的有限体积模拟，并由此计算数值对数平均温差 (LMTD) 以及与理想逆流情况偏离的隐含修正系数。请从能量守恒和基本定义出发，构建一个对任意空间均匀的总传热系数和矩形换热器面积均有效的算法。\n\n仅使用以下基本依据。\n\n- 每股流体的能量守恒：流段的焓变等于其传入或传出的热量。\n- 总传热系数乘以面积的定义：局部传热速率与局部温差成正比，比例常数等于总传热系数与面积的乘积。\n- 对数平均温差 (LMTD) 的定义：对于两个均为正的终端温差 $\\Delta T_1$ 和 $\\Delta T_2$，LMTD 为 $\\Delta T_{lm} = \\dfrac{\\Delta T_1 - \\Delta T_2}{\\ln\\!\\left(\\dfrac{\\Delta T_1}{\\Delta T_2}\\right)}$，当 $\\Delta T_1 = \\Delta T_2$ 时，其连续性扩展为 $\\Delta T_{lm} = \\Delta T_1$。\n\n设置与离散化。\n\n- 考虑一个总面积为 $A$ 的矩形传热区域，其总传热系数 $U$（单位 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$）在空间上是均匀的。热流体沿 $x$ 方向流动，冷流体沿 $y$ 方向流动，两者在横向方向上均不混合（流线间无混合）。\n- 将该区域离散化为一个 $N_x \\times N_y$ 的逻辑矩形网格，其中包含等面积的有限体积（单元），因此每个单元的面积为 $A_{\\text{cell}} = \\dfrac{A}{N_x N_y}$。\n- 设热流体的总热容率（单位 $\\mathrm{W\\,K^{-1}}$）为 $C_h$，冷流体的总热容率（单位 $\\mathrm{W\\,K^{-1}}$）为 $C_c$。因为每条热流体通道沿 $x$ 方向横跨 $N_x$ 个单元，并且有 $N_y$ 条平行的热流体通道，所以为每条热流体通道分配热容率 $C_{h,\\text{ch}} = \\dfrac{C_h}{N_y}$。类似地，因为有 $N_x$ 条冷流体通道沿 $y$ 方向横跨 $N_y$ 个单元，所以为每条冷流体通道分配热容率 $C_{c,\\text{ch}} = \\dfrac{C_c}{N_x}$。\n- 设热流体的入口温度为 $T_{h,in}$（单位 $\\mathrm{K}$），在 $x=0$ 处对所有热流体通道均匀施加；设冷流体的入口温度为 $T_{c,in}$（单位 $\\mathrm{K}$），在 $y=0$ 处对所有冷流体通道均匀施加。\n\n局部有限体积能量平衡。\n\n- 在每个索引为 $(i,j)$ 的单元中，其中 $i \\in \\{1,\\dots,N_x\\}$ 枚举热流体的下游进程，$j \\in \\{1,\\dots,N_y\\}$ 枚举冷流体的下游进程，设热侧单元入口温度为同一热流体通道中上游热单元的出口温度，即 $T_{h,in}^{(i,j)} = T_h^{(i-1,j)}$；设冷侧单元入口温度为同一冷流体通道中上游冷单元的出口温度，即 $T_{c,in}^{(i,j)} = T_c^{(i,j-1)}$。对于边界入口，对所有 $j$ 设置 $T_h^{(0,j)} = T_{h,in}$，对所有 $i$ 设置 $T_c^{(i,0)} = T_{c,in}$。\n- 通过总传热系数、单元面积和入口温差的乘积来近似计算单元传热速率：$q_{i,j} = U\\,A_{\\text{cell}}\\left(T_{h,in}^{(i,j)} - T_{c,in}^{(i,j)}\\right)$。\n- 根据各流段的能量守恒更新单元出口温度：\n  - 热流体：$T_h^{(i,j)} = T_{h,in}^{(i,j)} - \\dfrac{q_{i,j}}{C_{h,\\text{ch}}}$。\n  - 冷流体：$T_c^{(i,j)} = T_{c,in}^{(i,j)} + \\dfrac{q_{i,j}}{C_{c,\\text{ch}}}$。\n\n需报告的全局量和定义。\n\n- 整个换热器的总传热量为 $Q = \\sum_{i=1}^{N_x}\\sum_{j=1}^{N_y} q_{i,j}$（单位 $\\mathrm{W}$）。总传热系数与面积的总乘积为 $U A$（单位 $\\mathrm{W\\,K^{-1}}$）。\n- 将模拟产生的数值对数平均温差定义为 $\\Delta T_{lm}^{\\text{num}} = \\dfrac{Q}{U A}$（单位 $\\mathrm{K}$）。\n- 将整体出口温度定义为按通道数量加权的出口平均值：$T_{h,out} = \\dfrac{1}{N_y}\\sum_{j=1}^{N_y} T_h^{(N_x,j)}$ 和 $T_{c,out} = \\dfrac{1}{N_x}\\sum_{i=1}^{N_x} T_c^{(i,N_y)}$（单位 $\\mathrm{K}$）。\n- 使用这些整体终端温度为假设的理想逆流比较定义终端温差：$\\Delta T_1 = T_{h,in} - T_{c,out}$ 和 $\\Delta T_2 = T_{h,out} - T_{c,in}$，并根据上述 LMTD 定义计算逆流 LMTD $\\Delta T_{lm}^{\\text{cf}}$。\n- 将隐含的修正系数 $F$ 定义为比率 $F = \\dfrac{\\Delta T_{lm}^{\\text{num}}}{\\Delta T_{lm}^{\\text{cf}}}$（无量纲）。此 $F$ 值量化了实际错流驱动力与仅基于终端温度的理想逆流参考值之间的偏差。\n\n数值实现要求。\n\n- 通过从 $1$ 到 $N_x$ 扫描 $i$，并对每个 $i$ 从 $1$ 到 $N_y$ 扫描 $j$ 来实现有限体积更新，使用所定义的上游入口温度。累加 $q_{i,j}$ 以形成 $Q$。\n- 当 $\\Delta T_1$ 和 $\\Delta T_2$ 近似相等时，使用连续性扩展来稳健地计算 $\\Delta T_{lm}^{\\text{cf}}$。如果 $\\Delta T_1 \\le 0$ 或 $\\Delta T_2 \\le 0$，则该测试案例为不适定问题；所提供的测试套件会避免此类情况。\n\n单位与输出规范。\n\n- 一致使用国际单位制：$U$ 的单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$，$A$ 的单位为 $\\mathrm{m^2}$，$C_h$ 和 $C_c$ 的单位为 $\\mathrm{W\\,K^{-1}}$，温度单位为 $\\mathrm{K}$。报告 $\\Delta T_{lm}^{\\text{num}}$（单位 $\\mathrm{K}$），四舍五入到六位小数；报告 $F$（无量纲浮点数），四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果是一个形如 $[\\Delta T_{lm}^{\\text{num}},F]$ 的双元素列表。例如，输出格式为 $[[x_1,y_1],[x_2,y_2],\\dots]$，其中每个 $x_k$ 和 $y_k$ 都四舍五入到六位小数。\n\n待实现的测试套件。\n\n- 案例 1（通用情况，传热单元数中等偏大，热容率不等）：$U = 600\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$, $A = 25\\,\\mathrm{m^2}$, $C_h = 4000\\,\\mathrm{W\\,K^{-1}}$, $C_c = 3000\\,\\mathrm{W\\,K^{-1}}$, $T_{h,in} = 400\\,\\mathrm{K}$, $T_{c,in} = 300\\,\\mathrm{K}$, $N_x = 60$, $N_y = 60$。\n- 案例 2（低传热单元数边界，修正系数几乎可忽略）：$U = 100\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$, $A = 5\\,\\mathrm{m^2}$, $C_h = 5000\\,\\mathrm{W\\,K^{-1}}$, $C_c = 5000\\,\\mathrm{W\\,K^{-1}}$, $T_{h,in} = 360\\,\\mathrm{K}$, $T_{c,in} = 340\\,\\mathrm{K}$, $N_x = 40$, $N_y = 40$。\n- 案例 3（高传热单元数，热容率严重不平衡）：$U = 1200\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$, $A = 40\\,\\mathrm{m^2}$, $C_h = 8000\\,\\mathrm{W\\,K^{-1}}$, $C_c = 2000\\,\\mathrm{W\\,K^{-1}}$, $T_{h,in} = 450\\,\\mathrm{K}$, $T_{c,in} = 310\\,\\mathrm{K}$, $N_x = 80$, $N_y = 80$。\n- 案例 4（趋近极限温差但未退化，热容率不平衡反转）：$U = 700\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$, $A = 30\\,\\mathrm{m^2}$, $C_h = 2000\\,\\mathrm{W\\,K^{-1}}$, $C_c = 8000\\,\\mathrm{W\\,K^{-1}}$, $T_{h,in} = 420\\,\\mathrm{K}$, $T_{c,in} = 300\\,\\mathrm{K}$, $N_x = 70$, $N_y = 70$。", "solution": "该问题要求为一种非混合-非混合错流换热器构建并实现一个数值解。验证问题陈述是首要且最关键的步骤。\n\n**问题验证**\n\n根据其科学基础、完整性和客观性，对问题进行了严格的评估。\n\n**步骤 1：提取的已知条件**\n- **基本原理**：能量守恒、总传热系数 ($U$) 的定义以及对数平均温差 (LMTD) 的定义。\n- **系统配置**：一个非混合-非混合错流换热器，总传热面积为 $A$，总传热系数 $U$ 均匀。热流体总热容率为 $C_h$，沿 $x$ 方向流动。冷流体总热容率为 $C_c$，沿 $y$ 方向流动。\n- **边界条件**：在 $x=0$ 处，入口温度 $T_{h,in}$ 均匀；在 $y=0$ 处，入口温度 $T_{c,in}$ 均匀。\n- **离散化方案**：面积 $A$ 被划分为一个 $N_x \\times N_y$ 的单元网格，每个单元的面积为 $A_{\\text{cell}} = A/(N_x N_y)$。通道热容率定义为 $C_{h,\\text{ch}} = C_h/N_y$ 和 $C_{c,\\text{ch}} = C_c/N_x$。\n- **有限体积方程**：单元 $(i,j)$ 内的局部传热速率为 $q_{i,j} = U A_{\\text{cell}}(T_{h,in}^{(i,j)} - T_{c,in}^{(i,j)})$，其中单元入口温度取自上游单元的出口：$T_{h,in}^{(i,j)} = T_h^{(i-1,j)}$ 和 $T_{c,in}^{(i,j)} = T_c^{(i,j-1)}$。出口温度通过 $T_h^{(i,j)} = T_{h,in}^{(i,j)} - q_{i,j}/C_{h,\\text{ch}}$ 和 $T_c^{(i,j)} = T_{c,in}^{(i,j)} + q_{i,j}/C_{c,\\text{ch}}$ 进行更新。\n- **输出量**：总传热量 $Q$、数值 LMTD $\\Delta T_{lm}^{\\text{num}} = Q/(UA)$、整体出口温度 $T_{h,out}$ 和 $T_{c,out}$、逆流 LMTD $\\Delta T_{lm}^{\\text{cf}}$，以及修正系数 $F = \\Delta T_{lm}^{\\text{num}}/\\Delta T_{lm}^{\\text{cf}}$。\n- **数值测试案例**：提供了四组不同的参数集。\n\n**步骤 2：验证结论**\n该问题被评估为**有效的**。它在科学上是合理的，基于热力学和传热学的基本原理。其表述是适定的，提供了一套完整的物理参数、边界条件和确定性的数值算法。语言客观而精确。该问题是计算传热学中的一个标准练习，要求开发一个有限体积模型来分析一种常见的工程设备。问题中没有矛盾、歧义或事实性错误。\n\n**数值模型的推导**\n\n我们继续基于所提供的框架来开发解决方案。物理系统是一个换热器，其中热流体和冷流体以直角流动，且在各自的横向方向上不混合。我们通过将传热面积离散化为一个 $N_x \\times N_y$ 的有限体积（或单元）网格来对此进行建模。\n\n让我们考虑位于网格位置 $(i,j)$ 的单个单元，其中 $i \\in \\{1, \\dots, N_x\\}$ 和 $j \\in \\{1, \\dots, N_y\\}$。热流体从单元 $(i-1,j)$ 进入此单元，冷流体从单元 $(i,j-1)$ 进入。问题指定了一个显式的、一阶的近似方法，其中局部传热速率 $q_{i,j}$ 使用单元入口处的温度计算：\n$$q_{i,j} = U A_{\\text{cell}} \\left(T_h^{(i-1,j)} - T_c^{(i,j-1)}\\right)$$\n这里，$T_h^{(i-1,j)}$ 是来自同一通道中上游单元的热流体出口温度，$T_c^{(i,j-1)}$ 是来自其上游单元的冷流体出口温度。边界条件为，对于所有相关的 $i$ 和 $j$，$T_h^{(0,j)} = T_{h,in}$ 和 $T_c^{(i,0)} = T_{c,in}$。\n\n能量守恒定律应用于穿过该单元的每股流体。对于热流体段，其焓变必须等于从其传出的热量。单个热流体通道的热容率为 $C_{h,\\text{ch}} = C_h/N_y$。能量平衡方程为：\n$$C_{h,\\text{ch}} \\left(T_h^{(i-1,j)} - T_h^{(i,j)}\\right) = q_{i,j}$$\n整理以求出出口温度 $T_h^{(i,j)}$，得到热流体的更新方程：\n$$T_h^{(i,j)} = T_h^{(i-1,j)} - \\frac{q_{i,j}}{C_{h,\\text{ch}}}$$\n\n类似地，对于冷流体段，其焓变等于传入的热量。单个冷流体通道的热容率为 $C_{c,\\text{ch}} = C_c/N_x$。能量平衡方程为：\n$$C_{c,\\text{ch}} \\left(T_c^{(i,j)} - T_c^{(i,j-1)}\\right) = q_{i,j}$$\n这给出了冷流体的更新方程：\n$$T_c^{(i,j)} = T_c^{(i,j-1)} + \\frac{q_{i,j}}{C_{c,\\text{ch}}}$$\n\n通过代入 $q_{i,j}$ 的表达式，我们得到一个耦合的显式更新方程组：\n$$T_h^{(i,j)} = T_h^{(i-1,j)} - \\frac{U A_{\\text{cell}}}{C_{h,\\text{ch}}} \\left(T_h^{(i-1,j)} - T_c^{(i,j-1)}\\right)$$\n$$T_c^{(i,j)} = T_c^{(i,j-1)} + \\frac{U A_{\\text{cell}}}{C_{c,\\text{ch}}} \\left(T_h^{(i-1,j)} - T_c^{(i,j-1)}\\right)$$\n让我们定义无量纲系数 $K_h = \\frac{U A_{\\text{cell}}}{C_{h,\\text{ch}}} = \\frac{U A / (N_x N_y)}{C_h / N_y} = \\frac{U A}{N_x C_h}$ 和 $K_c = \\frac{U A_{\\text{cell}}}{C_{c,\\text{ch}}} = \\frac{U A / (N_x N_y)}{C_c / N_x} = \\frac{U A}{N_y C_c}$。方程简化为：\n$$T_h^{(i,j)} = T_h^{(i-1,j)} - K_h \\left(T_h^{(i-1,j)} - T_c^{(i,j-1)}\\right)$$\n$$T_c^{(i,j)} = T_c^{(i,j-1)} + K_c \\left(T_h^{(i-1,j)} - T_c^{(i,j-1)}\\right)$$\n这些方程定义了一个前向推进算法。我们可以通过从入口角点 $(i=1, j=1)$ 开始并向下游迭代网格，来计算所有的温度场 $T_h^{(i,j)}$ 和 $T_c^{(i,j)}$。\n\n整个换热器的总传热速率 $Q$ 是所有单元传热速率的总和：\n$$Q = \\sum_{i=1}^{N_x} \\sum_{j=1}^{N_y} q_{i,j}$$\n\n由此，数值确定的对数平均温差 $\\Delta T_{lm}^{\\text{num}}$ 通过反演标准的换热器设计方程 $Q = U A \\Delta T_{lm}$ 来定义：\n$$\\Delta T_{lm}^{\\text{num}} = \\frac{Q}{U A}$$\n\n为了找到修正系数 $F$，我们需要一个参考 LMTD。这个参考通常是与具有相同终端温度的理想逆流换热器的 LMTD。我们首先通过平均所有出口通道的温度来计算整体出口温度：\n$$T_{h,out} = \\frac{1}{N_y} \\sum_{j=1}^{N_y} T_h^{(N_x, j)}$$\n$$T_{c,out} = \\frac{1}{N_x} \\sum_{i=1}^{N_x} T_c^{(i, N_y)}$$\n利用这些整体温度，我们为逆流参考案例定义终端温差：\n$$\\Delta T_1 = T_{h,in} - T_{c,out}$$\n$$\\Delta T_2 = T_{h,out} - T_{c,in}$$\n然后使用标准公式计算逆流 LMTD $\\Delta T_{lm}^{\\text{cf}}$。对于 $\\Delta T_1 \\neq \\Delta T_2$ 的情况，我们有：\n$$\\Delta T_{lm}^{\\text{cf}} = \\frac{\\Delta T_1 - \\Delta T_2}{\\ln(\\Delta T_1 / \\Delta T_2)}$$\n为了处理 $\\Delta T_1 = \\Delta T_2$ 的情况并确保它们相近时的数值稳定性，我们使用连续性扩展 $\\Delta T_{lm}^{\\text{cf}} = \\Delta T_1$。\n\n最后，LMTD 修正系数 $F$ 是实际（数值）平均温差与理想逆流平均温差的比值：\n$$F = \\frac{\\Delta T_{lm}^{\\text{num}}}{\\Delta T_{lm}^{\\text{cf}}}$$\n该系数定量描述了由于错流配置导致的热驱动力相对于最高效的逆流布置的减小程度。\n\n计算过程如下：\n1. 为热流体和冷流体温度 $T_h$ 和 $T_c$ 初始化两个 $(N_x+1) \\times (N_y+1)$ 的数组。\n2. 应用边界条件：将 $T_c$ 的第 0 行设置为 $T_{c,in}$，将 $T_h$ 的第 0 列设置为 $T_{h,in}$。\n3. 初始化总传热量 $Q = 0$。\n4. 通过循环 $i$ 从 $1$ 到 $N_x$ 以及 $j$ 从 $1$ 到 $N_y$ 来遍历网格。\n5. 在内层循环中，计算 $q_{i,j}$，更新 $T_h^{(i,j)}$ 和 $T_c^{(i,j)}$，并将 $q_{i,j}$ 加到 $Q$ 上。\n6. 循环完成后，计算所有派生的全局量：$T_{h,out}$、 $T_{c,out}$、 $\\Delta T_{lm}^{\\text{num}}$、 $\\Delta T_{lm}^{\\text{cf}}$ 和 $F$。\n该算法将针对指定的测试案例进行实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_lmtd_cf(T_h_in, T_h_out, T_c_in, T_c_out):\n    \"\"\"\n    Calculates the Log Mean Temperature Difference for a counter-flow configuration.\n    \n    Args:\n        T_h_in (float): Hot fluid inlet temperature.\n        T_h_out (float): Hot fluid outlet temperature.\n        T_c_in (float): Cold fluid inlet temperature.\n        T_c_out (float): Cold fluid outlet temperature.\n        \n    Returns:\n        float: The counter-flow LMTD.\n    \"\"\"\n    delta_T1 = T_h_in - T_c_out\n    delta_T2 = T_h_out - T_c_in\n\n    # The problem statement guarantees cases where delta_T1 and delta_T2 are positive.\n    # We must handle the case where they are nearly equal to avoid division by zero.\n    if abs(delta_T1 - delta_T2) < 1e-9:\n        return delta_T1\n    else:\n        return (delta_T1 - delta_T2) / np.log(delta_T1 / delta_T2)\n\ndef simulate_cross_flow_exchanger(U, A, C_h, C_c, T_h_in, T_c_in, Nx, Ny):\n    \"\"\"\n    Performs a finite-volume simulation of an unmixed-unmixed cross-flow heat exchanger.\n\n    Args:\n        U (float): Overall heat transfer coefficient in W/(m^2*K).\n        A (float): Total heat transfer area in m^2.\n        C_h (float): Hot fluid total heat capacity rate in W/K.\n        C_c (float): Cold fluid total heat capacity rate in W/K.\n        T_h_in (float): Hot fluid inlet temperature in K.\n        T_c_in (float): Cold fluid inlet temperature in K.\n        Nx (int): Number of cells in the x-direction (hot fluid flow).\n        Ny (int): Number of cells in the y-direction (cold fluid flow).\n\n    Returns:\n        tuple: A tuple containing the numerical LMTD (dT_lm_num) and the correction factor (F).\n    \"\"\"\n    # Discretization parameters\n    A_cell = A / (Nx * Ny)\n    C_h_ch = C_h / Ny  # Heat capacity rate per hot channel\n    C_c_ch = C_c / Nx  # Heat capacity rate per cold channel\n\n    # Temperature fields (using 0-based indexing)\n    # T_h[i, j] corresponds to T_h^(i, j)\n    # Indices i: 0 to Nx (hot fluid flow direction)\n    # Indices j: 0 to Ny (cold fluid flow direction)\n    T_h = np.zeros((Nx + 1, Ny + 1))\n    T_c = np.zeros((Nx + 1, Ny + 1))\n\n    # Apply boundary conditions\n    T_h[0, :] = T_h_in  # T_h^(0,j) = T_h_in for all j\n    T_c[:, 0] = T_c_in  # T_c^(i,0) = T_c_in for all i\n\n    total_heat_transfer_Q = 0.0\n\n    # Finite-volume marching algorithm\n    for i in range(1, Nx + 1):  # i from 1 to Nx\n        for j in range(1, Ny + 1):  # j from 1 to Ny\n            # Cell inlet temperatures are from upstream cells\n            T_h_in_cell = T_h[i - 1, j]\n            T_c_in_cell = T_c[i, j - 1]\n\n            # Heat transfer in cell (i,j)\n            q_ij = U * A_cell * (T_h_in_cell - T_c_in_cell)\n            total_heat_transfer_Q += q_ij\n\n            # Update cell outlet temperatures\n            T_h[i, j] = T_h_in_cell - q_ij / C_h_ch\n            T_c[i, j] = T_c_in_cell + q_ij / C_c_ch\n\n    # Calculate global quantities\n    UA = U * A\n    \n    # 1. Numerical LMTD from simulation\n    dT_lm_num = total_heat_transfer_Q / UA\n\n    # 2. Bulk outlet temperatures\n    # T_h_out is the average of outlets from all Ny hot channels at x=L (i=Nx)\n    T_h_out = np.mean(T_h[Nx, 1:])\n    # T_c_out is the average of outlets from all Nx cold channels at y=L (j=Ny)\n    T_c_out = np.mean(T_c[1:, Ny])\n\n    # 3. Counter-flow LMTD for reference\n    dT_lm_cf = calculate_lmtd_cf(T_h_in, T_h_out, T_c_in, T_c_out)\n\n    # 4. Correction factor F\n    # If dT_lm_cf is zero or very small, F would be undefined or unstable.\n    # However, for physically meaningful heat exchange, dT_lm_cf > 0.\n    F = dT_lm_num / dT_lm_cf\n    \n    return dT_lm_num, F\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1: general\n        {'U': 600.0, 'A': 25.0, 'C_h': 4000.0, 'C_c': 3000.0, \n         'T_h_in': 400.0, 'T_c_in': 300.0, 'Nx': 60, 'Ny': 60},\n        # Case 2: low NTU, balanced flow\n        {'U': 100.0, 'A': 5.0, 'C_h': 5000.0, 'C_c': 5000.0, \n         'T_h_in': 360.0, 'T_c_in': 340.0, 'Nx': 40, 'Ny': 40},\n        # Case 3: high NTU, unbalanced flow (C_h > C_c)\n        {'U': 1200.0, 'A': 40.0, 'C_h': 8000.0, 'C_c': 2000.0, \n         'T_h_in': 450.0, 'T_c_in': 310.0, 'Nx': 80, 'Ny': 80},\n        # Case 4: high NTU, unbalanced flow (C_c > C_h)\n        {'U': 700.0, 'A': 30.0, 'C_h': 2000.0, 'C_c': 8000.0, \n         'T_h_in': 420.0, 'T_c_in': 300.0, 'Nx': 70, 'Ny': 70},\n    ]\n\n    results = []\n    for case in test_cases:\n        dT_lm_num, F = simulate_cross_flow_exchanger(\n            U=case['U'], A=case['A'], C_h=case['C_h'], C_c=case['C_c'],\n            T_h_in=case['T_h_in'], T_c_in=case['T_c_in'],\n            Nx=case['Nx'], Ny=case['Ny']\n        )\n        results.append([dT_lm_num, F])\n\n    # Format the output exactly as specified.\n    formatted_results = [f\"[{res[0]:.6f},{res[1]:.6f}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2474688"}]}