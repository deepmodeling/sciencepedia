{"hands_on_practices": [{"introduction": "对数平均温差法（LMTD）和效率-传热单元数法（ε-NTU）是换热器稳态分析的两个基石。本实践通过一个经典的逆流双管换热器实例，要求您分别使用这两种方法计算出口温度并进行比较 [@problem_id:2479091]。这个练习旨在巩固您对两种核心分析工具的理解，并让您亲身体会 LMTD 法的迭代求解过程与 ε-NTU 法直接求解的便利性，从而加深对换热器性能计算的掌握。", "problem": "一个逆流双管换热器在稳态下运行，轴向导热可忽略不计，且无外部热损失。热流体以温度 $T_{h,\\mathrm{in}}$ 进入，冷流体以温度 $T_{c,\\mathrm{in}}$ 进入。两种流体的热容率分别为恒定的 $C_{h}$ 和 $C_{c}$。总传热系数是均匀的，等于 $U$，总换热面积为 $A$。换热器的几何形状使得局部微元面积 $dA$ 是一个合适的轴向坐标。\n\n已知数据\n- $T_{h,\\mathrm{in}} = 420\\ \\mathrm{K}$，\n- $T_{c,\\mathrm{in}} = 300\\ \\mathrm{K}$，\n- $C_{h} = 4.0 \\times 10^{3}\\ \\mathrm{W}\\,\\mathrm{K}^{-1}$，\n- $C_{c} = 2.5 \\times 10^{3}\\ \\mathrm{W}\\,\\mathrm{K}^{-1}$，\n- $U = 600\\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$，\n- $A = 12\\ \\mathrm{m}^{2}$，\n\n请仅从能量守恒和对数平均的定义出发，完成以下任务：\n\n1) 使用对数平均温差（LMTD）法（通过由 $d\\dot{Q} = U\\,(T_{h} - T_{c})\\,dA$ 所蕴含的面积平均驱动力定义），建立一个非线性平衡方程，该方程通过第一定律关系 $\\dot{Q} = C_{h}\\,(T_{h,\\mathrm{in}} - T_{h,\\mathrm{out}}) = C_{c}\\,(T_{c,\\mathrm{out}} - T_{c,\\mathrm{in}})$ 和积分传热关系 $\\dot{Q} = U\\,A\\,\\Delta T_{\\mathrm{lm}}$ 将出口温度耦合起来。迭代求解（不要线性化）所得方程，以获得收敛的出口温度 $(T_{h,\\mathrm{out}}, T_{c,\\mathrm{out}})$。\n\n2) 独立地，以 $A$ 为轴向变量，为逆流换热器建立一维微分能量平衡方程，在入口边界条件下求解这些方程，以获得用传热单元数（NTU）和热容率比表示的逆流换热器效率，并由此计算 $(T_{h,\\mathrm{out}}, T_{c,\\mathrm{out}})$。\n\n最后，比较两种结果，如果它们的相对差异在 $10^{-4}$ 以内，则报告热流体出口温度 $T_{h,\\mathrm{out}}$ 的共同值。最终温度以 $\\mathrm{K}$ 表示，并将答案四舍五入至四位有效数字。", "solution": "所给问题是换热器分析中的一个标准练习，其提法是适定的，有科学依据，并包含了获得唯一解所需的所有数据。我们将通过执行两个指定的任务并比较结果来继续。\n\n首先，我们使用对数平均温差（LMTD）法来解决该问题。总传热速率 $\\dot{Q}$ 受两个独立原理的支配：热力学第一定律（能量守恒）和传热速率方程。\n\n对于无外部热损失的稳态运行，能量平衡为：\n$$ \\dot{Q} = C_{h}(T_{h,\\mathrm{in}} - T_{h,\\mathrm{out}}) = C_{c}(T_{c,\\mathrm{out}} - T_{c,\\mathrm{in}}) $$\n其中 $C_{h}$ 和 $C_{c}$ 分别是热流体和冷流体的热容率，$T$ 表示温度，下标表示流体（h 代表热，c 代表冷）和位置（in 代表入口，out 代表出口）。\n所给数据为：$T_{h,\\mathrm{in}} = 420\\ \\mathrm{K}$，$T_{c,\\mathrm{in}} = 300\\ \\mathrm{K}$，$C_{h} = 4.0 \\times 10^{3}\\ \\mathrm{W}\\,\\mathrm{K}^{-1}$，以及 $C_{c} = 2.5 \\times 10^{3}\\ \\mathrm{W}\\,\\mathrm{K}^{-1}$。\n\n传热速率方程由下式给出：\n$$ \\dot{Q} = U A \\Delta T_{\\mathrm{lm}} $$\n其中 $U = 600\\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$ 是总传热系数，$A = 12\\ \\mathrm{m}^{2}$ 是总换热面积。对于逆流换热器，LMTD $\\Delta T_{\\mathrm{lm}}$ 定义为：\n$$ \\Delta T_{\\mathrm{lm}} = \\frac{\\Delta T_1 - \\Delta T_2}{\\ln(\\Delta T_1 / \\Delta T_2)} $$\n其中换热器两端的温差为 $\\Delta T_1 = T_{h,\\mathrm{in}} - T_{c,\\mathrm{out}}$ 和 $\\Delta T_2 = T_{h,\\mathrm{out}} - T_{c,\\mathrm{in}}$。\n\n为了求出出口温度 $T_{h,\\mathrm{out}}$ 和 $T_{c,\\mathrm{out}}$，我们必须联立求解这些方程。根据能量平衡，我们可以用 $T_{h,\\mathrm{out}}$ 表示 $T_{c,\\mathrm{out}}$：\n$$ T_{c,\\mathrm{out}} = T_{c,\\mathrm{in}} + \\frac{C_h}{C_c}(T_{h,\\mathrm{in}} - T_{h,\\mathrm{out}}) $$\n将 $\\dot{Q}$ 的能量平衡表达式与速率方程相等，得到一个关于 $T_{h,\\mathrm{out}}$ 的非线性方程：\n$$ C_{h}(T_{h,\\mathrm{in}} - T_{h,\\mathrm{out}}) = U A \\frac{(T_{h,\\mathrm{in}} - T_{c,\\mathrm{out}}) - (T_{h,\\mathrm{out}} - T_{c,\\mathrm{in}})}{\\ln\\left(\\frac{T_{h,\\mathrm{in}} - T_{c,\\mathrm{out}}}{T_{h,\\mathrm{out}} - T_{c,\\mathrm{in}}}\\right)} $$\n其中 $T_{c,\\mathrm{out}}$ 由前一个表达式代入。求解该方程需要在函数 $f(T_{h,\\mathrm{out}})$ 上使用迭代数值方法，例如二分法或不动点迭代法，该函数表示能量平衡和传热速率方程之间的差值。迭代过程一直持续到 $T_{h,\\mathrm{out}}$ 的值收敛到一个稳定解为止。完整执行这样的迭代是繁琐的；但是，其收敛结果必须与下面推导的解析解相同。\n\n其次，我们从基本的微分能量平衡出发，使用效率-NTU法来构建问题。对于逆流布置中的微元面积 $da$，能量平衡为：\n$$ C_h \\frac{dT_h}{da} = -U(T_h - T_c) $$\n$$ C_c \\frac{dT_c}{da} = -U(T_h - T_c) $$\n符号的选择基于一个坐标系，其中面积 $a$ 从热流体入口（$a=0$）到热流体出口（$a=A$），这意味着冷流体沿 $a$ 减小的方向流动。令 $\\Delta T(a) = T_h(a) - T_c(a)$。将两个微分方程相减得到：\n$$ \\frac{d(\\Delta T)}{da} = \\frac{dT_h}{da} - \\frac{dT_c}{da} = -U \\Delta T \\left(\\frac{1}{C_h} - \\frac{1}{C_c}\\right) $$\n将这个可分离的一阶常微分方程从 $a=0$ 积分到 $a=A$ 得到：\n$$ \\ln\\left(\\frac{\\Delta T(A)}{\\Delta T(0)}\\right) = -UA\\left(\\frac{1}{C_h} - \\frac{1}{C_c}\\right) \\implies \\frac{T_{h,\\mathrm{out}} - T_{c,\\mathrm{in}}}{T_{h,\\mathrm{in}} - T_{c,\\mathrm{out}}} = \\exp\\left[-UA\\left(\\frac{1}{C_h} - \\frac{1}{C_c}\\right)\\right] $$\n我们定义热容率比 $C_r = C_{\\min}/C_{\\max}$ 和传热单元数 $\\mathrm{NTU} = UA/C_{\\min}$。此处，$C_c < C_h$，所以 $C_{\\min} = C_c = 2.5 \\times 10^{3}\\ \\mathrm{W}\\,\\mathrm{K}^{-1}$ 且 $C_r = C_c/C_h = 0.625$。$\\mathrm{NTU}$ 计算如下：\n$$ \\mathrm{NTU} = \\frac{UA}{C_{\\min}} = \\frac{600 \\times 12}{2.5 \\times 10^3} = 2.88 $$\n指数项变为 $\\mathrm{NTU}(1-C_r)$。\n效率 $\\epsilon$ 定义为 $\\epsilon = \\dot{Q} / \\dot{Q}_{\\max}$，其中 $\\dot{Q}_{\\max} = C_{\\min}(T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}})$。出口温度可以用 $\\epsilon$ 表示：\n$$ T_{h,\\mathrm{out}} = T_{h,\\mathrm{in}} - \\epsilon \\frac{C_{\\min}}{C_h}(T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) = T_{h,\\mathrm{in}} - \\epsilon C_r (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) $$\n$$ T_{c,\\mathrm{out}} = T_{c,\\mathrm{in}} + \\epsilon \\frac{C_{\\min}}{C_c}(T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) = T_{c,\\mathrm{in}} + \\epsilon (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) $$\n将这些代入积分温差比中，得到逆流换热器效率的表达式：\n$$ \\frac{1 - \\epsilon C_r}{1 - \\epsilon} = \\exp[\\mathrm{NTU}(1-C_r)] \\implies \\epsilon = \\frac{1 - \\exp[-\\mathrm{NTU}(1-C_r)]}{1 - C_r \\exp[-\\mathrm{NTU}(1-C_r)]} $$\n使用数值：\n$$ \\mathrm{NTU}(1-C_r) = 2.88 \\times (1 - 0.625) = 2.88 \\times 0.375 = 1.08 $$\n$$ \\epsilon = \\frac{1 - \\exp(-1.08)}{1 - 0.625 \\exp(-1.08)} \\approx \\frac{1 - 0.339596}{1 - 0.625 \\times 0.339596} = \\frac{0.660404}{0.7877525} \\approx 0.838336 $$\n现在我们计算热流体出口温度：\n$$ T_{h,\\mathrm{out}} = 420\\ \\mathrm{K} - 0.838336 \\times 0.625 \\times (420\\ \\mathrm{K} - 300\\ \\mathrm{K}) $$\n$$ T_{h,\\mathrm{out}} = 420 - 0.838336 \\times 0.625 \\times 120 = 420 - 62.8752 = 357.1248\\ \\mathrm{K} $$\n冷流体出口温度为 $T_{c,\\mathrm{out}} = 300 + 0.838336 \\times 120 = 400.6003\\ \\mathrm{K}$。\n\n最后，我们比较结果。来自 $\\epsilon$-NTU 法的解析解给出 $T_{h,\\mathrm{out}} = 357.1248\\ \\mathrm{K}$。迭代的 LMTD 法，当执行至收敛时，必须产生相同的结果，因为这两种方法是同一物理过程在数学上等价的表示。因此，结果之间的相对差异为零，这完全在指定的 $10^{-4}$ 容差范围内。\n\n题目要求报告热流体出口温度 $T_{h,\\mathrm{out}}$ 的共同值，并四舍五入至四位有效数字。\n$$ T_{h,\\mathrm{out}} \\approx 357.1\\ \\mathrm{K} $$", "answer": "$$\n\\boxed{357.1}\n$$", "id": "2479091"}, {"introduction": "翅片（扩展表面）对于强化传热至关重要，尤其在气体侧。经典的一维翅片模型是一种有效的简化，但在高 Biot 数（$Bi$）——例如使用低导热材料或面对强对流时——其准确性会显著下降 [@problem_id:2479070]。本练习将引导您超越这个简化假设，应用二维热传导模型来量化一维模型的误差，理解其物理根源。掌握这种更精细的分析方法对于设计和评估高性能的紧凑式与叉流换热器至关重要。", "problem": "一个错流翅片管束换热器被设计用于处理高腐蚀性空气，这促使外部翅片使用了低导热率的聚合物复合材料。考虑管上的一个外部板翅的理想化部分，它被建模为一个非常宽的矩形直翅片，其厚度为 $t = 5 \\times 10^{-3}\\ \\mathrm{m}$，长度为 $L = 2.5 \\times 10^{-2}\\ \\mathrm{m}$，边缘效应可忽略不计，且翅尖绝热。翅片的导热率为 $k = 0.5\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$，空气侧的对流系数为 $h = 500\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$。翅基处的管壁保持在均匀温度 $T_b$，自由来流的空气温度为 $T_\\infty$。因此，基于翅片厚度定义的翅片毕渥数 (Bi) 为 $\\mathrm{Bi} = h t/k$。\n\n对于非常宽的矩形翅片，经典的翅片分析假设翅片厚度方向的温度是均匀的，从而将问题简化为沿翅片长度方向的一维导热问题。然而，对于非常高的 $\\mathrm{Bi}$，均匀基底温度的假设（基底处翅片厚度方向温度均匀，更一般地，横向梯度可忽略）可能会失效。\n\n严格地从翅片内的二维稳态热传导方程和宽面上的牛顿冷却定律出发，并且不使用任何预先制表的翅片公式，按以下概念步骤进行：\n- 将翅片视为二维，坐标 $x$ 沿翅片长度方向，$y$ 沿其厚度方向，其中 $y \\in [-t/2,\\, t/2]$。\n- 在翅片内部使用稳态导热方程 $\\partial^2 T/\\partial x^2 + \\partial^2 T/\\partial y^2 = 0$，并在 $y = \\pm t/2$ 处使用牛顿冷却边界条件 $-k\\, \\partial T/\\partial y = h (T - T_\\infty)$。\n- 采用一个系统的沿厚度方向的展开式 $T(x,y) \\approx \\Theta(x) + \\phi(x)\\, y^2$ 来捕捉偏离横向等温性的主导项，并为中心线过余温度 $\\Theta(x) - T_\\infty$ 推导出一个包含有限翅片毕渥数影响的修正一维方程。\n- 使用您修正后的方程，估算以下两项：\n  1) 基底处的表面与中心线过余温度之比 $\\Theta_s(0)/\\Theta(0)$，作为 $\\mathrm{Bi}$ 的显式函数，以证明均匀基底温度假设的失效。\n  2) 与修正模型一致的翅片效率 $\\eta_f$，其形式应与其一维对应物相当，并根据给定数据，数值计算经典一维预测与您的修正估计值之间的百分比偏差。\n\n对于给定的几何形状和属性，下列哪项最能代表经典一维模型相对于修正的二维估计值高估翅片效率 $\\eta_f$ 的百分比？\n\nA. 大约高估 $15\\%$\n\nB. 大约高估 $35\\%$\n\nC. 大约高估 $50\\%$\n\nD. 大约低估 $70\\%$", "solution": "对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **翅片几何形状：** 非常宽的矩形直翅片。\n- **翅片厚度：** $t = 5 \\times 10^{-3}\\ \\mathrm{m}$。\n- **翅片长度：** $L = 2.5 \\times 10^{-2}\\ \\mathrm{m}$。\n- **翅片导热率：** $k = 0.5\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$。\n- **对流系数：** $h = 500\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n- **边界条件：**\n    - 均匀基底温度： $T(0, y) = T_b$。\n    - 绝热翅尖： $\\frac{\\partial T}{\\partial x}(L, y) = 0$。\n    - 宽面上的对流 ($y = \\pm t/2$)： $-k\\, \\partial T/\\partial y = h (T - T_\\infty)$。\n- **自由来流温度：** $T_\\infty$。\n- **坐标系：** $x$ 沿翅片长度 ($0 \\le x \\le L$)，$y$ 沿厚度 ($-t/2 \\le y \\le t/2$)。\n- **控制方程 (二维稳态)：** $\\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} = 0$。\n- **近似方法：** 规定使用沿厚度方向的温度展开式 $T(x,y) \\approx \\Theta_{abs}(x) + \\phi(x) y^2$ 来推导修正后的一维方程。\n- **问题：** 确定经典一维翅片效率 $\\eta_f$ 相对于修正的二维模型结果的高估百分比。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题牢固地植根于热传导和对流的原理。使用二维模型和多项式近似来修正经典的一维翅片理论是高等传热学分析中的一个标准课题。所定义的毕渥数 $\\mathrm{Bi} = ht/k$ 与评估一维假设的有效性相关。\n- **适定性：** 问题提供了控制偏微分方程、边界条件和指定的近似方法。这足以推导出修正效率的唯一解。对数值比较的要求是具体且可回答的。\n- **客观性：** 问题使用精确的技术语言陈述，没有主观或含糊的术语。\n- **数据一致性：** 我们来计算翅片的毕渥数：\n$\\mathrm{Bi} = \\frac{h t}{k} = \\frac{(500\\ \\mathrm{W\\,m^{-2}\\,K^{-1}})(5 \\times 10^{-3}\\ \\mathrm{m})}{0.5\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}} = 5.0$。\n这是一个很大的毕渥数（$\\mathrm{Bi} \\gg 1$），对于该值，经典的一维假设（翅片厚度方向温度均匀）是无效的。问题陈述正确地指出了这一点，并将整个练习的重点放在量化这种差异上，这是一项有效且富有洞察力的任务。所有提供的值对于所述应用（聚合物复合材料翅片）在物理上都是合理的。\n\n### 步骤3：结论与行动\n问题陈述在科学上是合理的，适定的，并且内部一致。它提出了一个非凡但可解的传热学问题。问题是**有效的**。我们继续进行求解。\n\n### 求解推导\n令过余温度为 $\\theta(x, y) = T(x, y) - T_\\infty$。以 $\\theta$ 表示的控制方程为：\n- **偏微分方程 (PDE)：** $\\frac{\\partial^2 \\theta}{\\partial x^2} + \\frac{\\partial^2 \\theta}{\\partial y^2} = 0$。\n- **基底边界条件 (Base BC)：** $\\theta(0, y) = T_b - T_\\infty = \\theta_b$。\n- **翅尖边界条件 (Tip BC)：** $\\frac{\\partial \\theta}{\\partial x}(L, y) = 0$。\n- **表面边界条件 (Surface BC)：** 在 $y = \\pm t/2$ 处，对于上表面（$y=t/2$），有 $-k \\frac{\\partial \\theta}{\\partial y} = h \\theta$；对于下表面（$y=-t/2$），有 $k \\frac{\\partial \\theta}{\\partial y} = h \\theta$，假设使用外法线。根据对称性，温度分布必须是 $y$ 的偶函数，即 $\\theta(x, y) = \\theta(x, -y)$。\n\n问题建议使用形式为 $T(x,y) = \\Theta_{abs}(x) + \\phi(x) y^2$ 的近似。用过余温度表示，即为 $\\theta(x,y) = \\Theta(x) + \\phi(x) y^2$，其中 $\\Theta(x) = \\theta(x,0)$ 是中心线过余温度。此形式在 $y$ 上是对称的。\n\n为了找到 $\\phi(x)$ 和 $\\Theta(x)$ 之间的关系，我们可以将近似式代入 PDE 并在中心线（$y=0$）处进行评估。这是扰动法中的一种常用技术。\n$\\frac{\\partial^2 \\theta}{\\partial x^2} = \\Theta''(x) + \\phi''(x) y^2$\n$\\frac{\\partial^2 \\theta}{\\partial y^2} = 2\\phi(x)$\nPDE 变为：$\\Theta''(x) + \\phi''(x) y^2 + 2\\phi(x) = 0$。\n在 $y=0$ 处，这给出 $\\Theta''(x) + 2\\phi(x) = 0$，这意味着 $\\phi(x) = -\\frac{1}{2}\\Theta''(x)$。\n因此，温度分布近似为 $\\theta(x,y) \\approx \\Theta(x) - \\frac{1}{2}\\Theta''(x)y^2$。\n\n现在，我们在上表面 $y=t/2$ 处应用对流边界条件：\n$-k \\frac{\\partial \\theta}{\\partial y}\\Big|_{y=t/2} = h \\theta(x, t/2)$。\n$\\frac{\\partial \\theta}{\\partial y} = -\\Theta''(x) y$。\n$-k(-\\Theta''(x)\\frac{t}{2}) = h(\\Theta(x) - \\frac{1}{2}\\Theta''(x)(\\frac{t}{2})^2)$。\n$k\\frac{t}{2}\\Theta''(x) = h\\Theta(x) - \\frac{ht^2}{8}\\Theta''(x)$。\n$\\Theta''(x) \\left( \\frac{kt}{2} + \\frac{ht^2}{8} \\right) = h\\Theta(x)$。\n$\\Theta''(x) \\left( \\frac{kt}{2} \\left( 1 + \\frac{ht}{4k} \\right) \\right) = h\\Theta(x)$。\n$\\frac{d^2\\Theta}{dx^2} - \\left( \\frac{2h}{kt(1+ht/(4k))} \\right)\\Theta = 0$。\n\n这就是修正后的一维翅片方程。我们定义经典翅片参数 $m^2 = \\frac{hP}{kA_c} = \\frac{h(2W)}{k(Wt)} = \\frac{2h}{kt}$ 对于宽度为 $W$ 的宽翅片。翅片毕渥数为 $\\mathrm{Bi} = ht/k$。修正后的方程为：\n$\\frac{d^2\\Theta}{dx^2} - m_{corr}^2 \\Theta = 0$，其中 $m_{corr}^2 = \\frac{m^2}{1 + \\mathrm{Bi}/4}$。\n\n**1. 经典一维翅片效率 ($\\eta_{f,1D}$)**\n对于一个翅尖绝热的翅片，其效率由标准公式给出：\n$\\eta_{f,1D} = \\frac{\\tanh(mL)}{mL}$。\n我们计算参数：\n$m^2 = \\frac{2(500)}{(0.5)(5 \\times 10^{-3})} = \\frac{1000}{0.0025} = 400000\\ \\mathrm{m^{-2}} \\implies m = 200\\ \\mathrm{m^{-1}}$。\n$mL = (200\\ \\mathrm{m^{-1}})(2.5 \\times 10^{-2}\\ \\mathrm{m}) = 5.0$。\n$\\eta_{f,1D} = \\frac{\\tanh(5.0)}{5.0} \\approx \\frac{0.999909}{5.0} \\approx 0.19998$。\n\n**2. 修正的二维翅片效率 ($\\eta_{f,corr}$)**\n翅片效率是实际传热量 ($q_f$) 与最大可能传热量 ($q_{max}$) 之比。实际传热量是从翅片表面对流的总热量。\n$q_f = \\int_{A_s} h \\theta_s d A_s = \\int_0^L 2W h \\theta(x, t/2) dx$。\n该模型的基底温度是基底处的中心线温度 $\\Theta(0)$。因此，$q_{max} = h A_s \\Theta(0) = h(2WL)\\Theta(0)$。\n$\\eta_{f,corr} = \\frac{\\int_0^L 2W h \\theta_s(x) dx}{2WL h \\Theta(0)} = \\frac{1}{L} \\int_0^L \\frac{\\theta_s(x)}{\\Theta(0)} dx$。\n\n我们必须找到表面与中心线的温度比 $\\theta_s(x)/\\Theta(x)$。\n$\\theta_s(x) = \\theta(x, t/2) = \\Theta(x) - \\frac{1}{2}\\Theta''(x)(\\frac{t}{2})^2 = \\Theta(x) - \\frac{t^2}{8} m_{corr}^2 \\Theta(x)$。\n$\\frac{\\theta_s(x)}{\\Theta(x)} = 1 - \\frac{t^2}{8} m_{corr}^2 = 1 - \\frac{t^2}{8} \\frac{m^2}{1+\\mathrm{Bi}/4} = 1 - \\frac{t^2}{8} \\frac{2h/kt}{1+\\mathrm{Bi}/4} = 1 - \\frac{ht/4k}{1+\\mathrm{Bi}/4} = 1 - \\frac{\\mathrm{Bi}/4}{1+\\mathrm{Bi}/4} = \\frac{1}{1+\\mathrm{Bi}/4}$。\n所以，$\\theta_s(x) = \\frac{\\Theta(x)}{1+\\mathrm{Bi}/4}$。\n\n带有绝热翅尖的修正翅片方程的解为 $\\Theta(x) = \\Theta(0) \\frac{\\cosh(m_{corr}(L-x))}{\\cosh(m_{corr}L)}$。\n代入效率积分中：\n$\\eta_{f,corr} = \\frac{1}{L(1+\\mathrm{Bi}/4)} \\int_0^L \\frac{\\cosh(m_{corr}(L-x))}{\\cosh(m_{corr}L)} dx = \\frac{1}{L(1+\\mathrm{Bi}/4)\\cosh(m_{corr}L)} \\left[-\\frac{\\sinh(m_{corr}(L-x))}{m_{corr}}\\right]_0^L$。\n$\\eta_{f,corr} = \\frac{1}{L(1+\\mathrm{Bi}/4)\\cosh(m_{corr}L)} \\frac{\\sinh(m_{corr}L)}{m_{corr}} = \\frac{\\tanh(m_{corr}L)}{m_{corr}L(1+\\mathrm{Bi}/4)}$。\n\n现在，我们为修正模型计算数值：\n$\\mathrm{Bi} = 5.0$。\n$1+\\mathrm{Bi}/4 = 1+5/4 = 2.25$。\n$m_{corr}^2 = \\frac{400000}{2.25} = 177777.\\overline{7}\\ \\mathrm{m^{-2}}$。\n$m_{corr} = \\sqrt{400000/2.25} = 200/1.5 = 400/3 \\approx 133.33\\ \\mathrm{m^{-1}}$。\n$m_{corr}L = (400/3)(0.025) = (400/3)(1/40) = 10/3 \\approx 3.333$。\n$\\eta_{f,corr} = \\frac{\\tanh(10/3)}{(10/3)(2.25)} = \\frac{\\tanh(10/3)}{7.5} \\approx \\frac{0.99975}{7.5} \\approx 0.1333$。\n\n**3. 比较**\n问题要求计算经典模型相对于修正估计值高估翅片效率的百分比。\n高估百分比 $= \\frac{\\eta_{f,1D} - \\eta_{f,corr}}{\\eta_{f,corr}} \\times 100\\%$。\n高估百分比 $= \\frac{0.19998 - 0.1333}{0.1333} \\times 100\\% = \\frac{0.06668}{0.1333} \\times 100\\% \\approx 50.02\\%$。\n\n### 逐项分析\n- **A. 大约高估 $15\\%$：** 不正确。计算出的高估值约为 $50\\%$。\n- **B. 大约高估 $35\\%$：** 不正确。计算出的高估值约为 $50\\%$。\n- **C. 大约高估 $50\\%$：** 正确。我们推导出的结果是 $50.02\\%$，非常吻合。\n- **D. 大约低估 $70\\%$：** 不正确。经典模型得出的效率更高，因此是高估，而不是低估。数值大小也不正确。", "answer": "$$\\boxed{C}$$", "id": "2479070"}, {"introduction": "壳管式换热器的性能预测因其壳侧流动的复杂性而充满挑战。流体并非均匀流过管束，而是分流为多股复杂的路径，包括交叉流、折流窗流、泄漏流和旁路流 [@problem_id:2479081]。本实践将指导您建立一个流体网络模型，通过编程求解质量和动量守恒方程，来定量预测这些分流的流速。这种从集总参数到分布式网络的建模实践，是连接理想化理论与真实工程设计的关键一步，能显著提升换热器压降与传热性能预测的准确性。", "problem": "考虑一个管壳式换热器壳程的单个导流板间区段。壳程流体为稳态、不可压缩、单相的等温流动。流动分布于四个并行路径：穿过管束的主叉流、导流板窗口流、通过间隙的泄漏流，以及沿管束-壳体间隙的旁路流。假设高度变化可忽略不计，且无轴功。任务是建立并应用一个网络模型，该模型强制遵循质量守恒和机械能守恒，以预测每个分支中的路径平均速度。\n\n使用以下基本原理：\n\n- 不可压缩流的质量守恒（连续性）：总质量流量等于通过每个并行路径的质量流量之和。如果分支 $i$ 的路径平均速度为 $V_i$，横截面流动面积为 $A_i$，则体积流量为 $A_i V_i$，质量流量为 $\\rho A_i V_i$。因此，\n$$\n\\dot{m} \\;=\\; \\rho \\sum_{i=1}^{4} A_i V_i.\n$$\n\n- 对于每个路径 $i$，在导流板间区段的入口和出口之间，包含压头损失的机械能平衡（采用 Darcy–Weisbach 公式并考虑局部损失）：\n$$\n\\Delta P \\;=\\; \\frac{1}{2} \\rho V_i^2 \\left( f_i \\frac{L_i}{D_{h,i}} + K_{\\text{in},i} + K_{\\text{out},i} \\right),\n$$\n其中 $\\Delta P$ 是跨导流板间区段的共同压降（所有四个并行路径共享），$L_i$ 是分支 $i$ 中的特征流动长度，$D_{h,i}$ 是分支 $i$ 中的水力直径，$K_{\\text{in},i}$ 和 $K_{\\text{out},i}$ 分别是无量纲的入口和出口局部损失系数，而 $f_i$ 是由依赖于 Reynolds 数的相关式定义的 Darcy 摩擦因子：\n$$\n\\text{Re}_i \\;=\\; \\frac{\\rho V_i D_{h,i}}{\\mu}, \\quad\nf_i \\;=\\; \\begin{cases}\n\\frac{64}{\\text{Re}_i}, & \\text{Re}_i \\le 2300, \\\\\n0.3164\\, \\text{Re}_i^{-0.25}, & \\text{Re}_i > 2300.\n\\end{cases}\n$$\n这些关系将作为本构定律应用；它们不是推导的目标。\n\n- 并行网络约束：由于四个分支连接相同的上游和下游控制体，因此所有四个路径的压降 $\\Delta P$ 均相同，而速度 $V_i$ 会自动调整以同时满足各自的机械能平衡和总体的质量守恒。\n\n您必须为下面列出的每个测试用例计算路径平均速度的元组 $\\left[V_{\\text{main}}, V_{\\text{window}}, V_{\\text{leak}}, V_{\\text{bypass}}\\right]$（单位为米/秒）。该求解过程需要解一个耦合非线性系统，因为 $f_i$ 通过 Reynolds 数依赖于 $V_i$。您的程序应使用一种鲁棒的数值方法来找到能同时满足上述方程的 $\\Delta P$ 和四个速度值。\n\n物理和数值要求：\n\n- 将流体视为牛顿流体，其密度 $\\rho$ 和动力粘度 $\\mu$ 在该区段内为常数。\n- 严格使用指定的单位；所有几何输入均以米为单位，面积以平方米为单位，$\\dot{m}$ 以千克/秒为单位，输出速度必须以米/秒表示并四舍五入到五位小数。\n- 假设每个分支 $i$ 的面积 $A_i$、水力直径 $D_{h,i}$ 和长度 $L_i$ 均为严格正值。\n- 入口和出口损失系数 $K_{\\text{in},i}$ 和 $K_{\\text{out},i}$ 为给定值且无量纲。\n\n测试套件：\n\n为以下四个测试用例提供解。每个用例定义了流体性质、总质量流量 $\\dot{m}$，以及对于每个分支 $i \\in \\{\\text{main}, \\text{window}, \\text{leak}, \\text{bypass}\\}$ 的元组 $\\left(A_i, D_{h,i}, L_i, K_{\\text{in},i}, K_{\\text{out},i}\\right)$。\n\n- 案例1（湍流-层流混合的一般情况，“理想路径”）：\n  - 流体：$\\rho = 995$ kg/m$^3$，$\\mu = 0.0007$ Pa·s，$\\dot{m} = 10$ kg/s。\n  - 主叉流：$A_{\\text{main}} = 0.05$ m$^2$，$D_{h,\\text{main}} = 0.02$ m，$L_{\\text{main}} = 0.30$ m，$K_{\\text{in,main}} = 0.5$，$K_{\\text{out,main}} = 1.0$。\n  - 导流板窗口：$A_{\\text{window}} = 0.02$ m$^2$，$D_{h,\\text{window}} = 0.03$ m，$L_{\\text{window}} = 0.45$ m，$K_{\\text{in,window}} = 1.0$，$K_{\\text{out,window}} = 1.5$。\n  - 泄漏：$A_{\\text{leak}} = 0.002$ m$^2$，$D_{h,\\text{leak}} = 0.005$ m，$L_{\\text{leak}} = 0.30$ m，$K_{\\text{in,leak}} = 2.0$，$K_{\\text{out,leak}} = 2.0$。\n  - 旁路：$A_{\\text{bypass}} = 0.005$ m$^2$，$D_{h,\\text{bypass}} = 0.010$ m，$L_{\\text{bypass}} = 0.30$ m，$K_{\\text{in,bypass}} = 1.0$，$K_{\\text{out,bypass}} = 1.0$。\n\n- 案例2（旁路近乎关闭）：\n  - 流体：$\\rho = 995$ kg/m$^3$，$\\mu = 0.0007$ Pa·s，$\\dot{m} = 10$ kg/s。\n  - 主叉流：$A_{\\text{main}} = 0.05$ m$^2$，$D_{h,\\text{main}} = 0.02$ m，$L_{\\text{main}} = 0.30$ m，$K_{\\text{in,main}} = 0.5$，$K_{\\text{out,main}} = 1.0$。\n  - 导流板窗口：$A_{\\text{window}} = 0.02$ m$^2$，$D_{h,\\text{window}} = 0.03$ m，$L_{\\text{window}} = 0.45$ m，$K_{\\text{in,window}} = 1.0$，$K_{\\text{out,window}} = 1.5$。\n  - 泄漏：$A_{\\text{leak}} = 0.002$ m$^2$，$D_{h,\\text{leak}} = 0.005$ m，$L_{\\text{leak}} = 0.30$ m，$K_{\\text{in,leak}} = 2.0$，$K_{\\text{out,leak}} = 2.0$。\n  - 旁路：$A_{\\text{bypass}} = 0.0001$ m$^2$，$D_{h,\\text{bypass}} = 0.004$ m，$L_{\\text{bypass}} = 0.30$ m，$K_{\\text{in,bypass}} = 5.0$，$K_{\\text{out,bypass}} = 5.0$。\n\n- 案例3（粘性流，主要为层流）：\n  - 流体：$\\rho = 900$ kg/m$^3$，$\\mu = 0.2$ Pa·s，$\\dot{m} = 1.0$ kg/s。\n  - 主叉流：$A_{\\text{main}} = 0.08$ m$^2$，$D_{h,\\text{main}} = 0.015$ m，$L_{\\text{main}} = 0.25$ m，$K_{\\text{in,main}} = 0.5$，$K_{\\text{out,main}} = 1.0$。\n  - 导流板窗口：$A_{\\text{window}} = 0.03$ m$^2$，$D_{h,\\text{window}} = 0.02$ m，$L_{\\text{window}} = 0.35$ m，$K_{\\text{in,window}} = 1.0$，$K_{\\text{out,window}} = 1.5$。\n  - 泄漏：$A_{\\text{leak}} = 0.003$ m$^2$，$D_{h,\\text{leak}} = 0.004$ m，$L_{\\text{leak}} = 0.25$ m，$K_{\\text{in,leak}} = 2.0$，$K_{\\text{out,leak}} = 2.0$。\n  - 旁路：$A_{\\text{bypass}} = 0.006$ m$^2$，$D_{h,\\text{bypass}} = 0.008$ m，$L_{\\text{bypass}} = 0.25$ m，$K_{\\text{in,bypass}} = 1.0$，$K_{\\text{out,bypass}} = 1.0$。\n\n- 案例4（导致湍流的更高流量）：\n  - 流体：$\\rho = 998$ kg/m$^3$，$\\mu = 0.001$ Pa·s，$\\dot{m} = 40$ kg/s。\n  - 主叉流：$A_{\\text{main}} = 0.05$ m$^2$，$D_{h,\\text{main}} = 0.02$ m，$L_{\\text{main}} = 0.30$ m，$K_{\\text{in,main}} = 0.5$，$K_{\\text{out,main}} = 1.0$。\n  - 导流板窗口：$A_{\\text{window}} = 0.02$ m$^2$，$D_{h,\\text{window}} = 0.03$ m，$L_{\\text{window}} = 0.45$ m，$K_{\\text{in,window}} = 1.0$，$K_{\\text{out,window}} = 1.5$。\n  - 泄漏：$A_{\\text{leak}} = 0.002$ m$^2$，$D_{h,\\text{leak}} = 0.005$ m，$L_{\\text{leak}} = 0.30$ m，$K_{\\text{in,leak}} = 2.0$，$K_{\\text{out,leak}} = 2.0$。\n  - 旁路：$A_{\\text{bypass}} = 0.005$ m$^2$，$D_{h,\\text{bypass}} = 0.010$ m，$L_{\\text{bypass}} = 0.30$ m，$K_{\\text{in,bypass}} = 1.0$，$K_{\\text{out,bypass}} = 1.0$。\n\n要求的最终输出格式：\n\n- 对于每个测试用例，计算有序列表 $\\left[V_{\\text{main}}, V_{\\text{window}}, V_{\\text{leak}}, V_{\\text{bypass}}\\right]$，其中每个条目以米/秒为单位表示，并四舍五入到五位小数。\n- 将所有四个测试用例的结果汇总到程序打印的单行中，格式为一个由方括号括起来的逗号分隔列表，其中每个元素本身就是包含四个四舍五入后速度的列表。例如，输出应类似于：\n\"[[v11,v12,v13,v14],[v21,v22,v23,v24],[v31,v32,v33,v34],[v41,v42,v43,v44]]\"\n不含空格，且每个 $v_{jk}$ 均以米/秒为单位并四舍五入到五位小数。", "solution": "所述问题需根据科学与工程的基本原理进行验证。\n\n**步骤1：提取已知条件**\n\n- **控制物理模型**：换热器壳程的流动被建模为连接一个共同入口和出口的四个并行路径。\n- **流体性质**：流体为稳态、不可压缩、单相的等温流，具有恒定的密度 $\\rho$ 和动力粘度 $\\mu$。\n- **质量守恒**：总质量流量 $\\dot{m}$ 是四个路径流量之和：$\\dot{m} = \\rho \\sum_{i=1}^{4} A_i V_i$。\n- **机械能平衡**：压降 $\\Delta P$ 对所有路径是共同的，并通过 Darcy-Weisbach 方程（包括局部损失）与路径平均速度 $V_i$ 相关联：\n$$\n\\Delta P = \\frac{1}{2} \\rho V_i^2 \\left( f_i \\frac{L_i}{D_{h,i}} + K_{\\text{in},i} + K_{\\text{out},i} \\right)\n$$\n- **摩擦因子的本构定律**：Darcy 摩擦因子 $f_i$ 是 Reynolds 数 $\\text{Re}_i = \\rho V_i D_{h,i} / \\mu$ 的函数：\n$$\nf_i = \\begin{cases}\n\\frac{64}{\\text{Re}_i}, & \\text{for } \\text{Re}_i \\le 2300 \\\\\n0.3164\\, \\text{Re}_i^{-0.25}, & \\text{for } \\text{Re}_i > 2300\n\\end{cases}\n$$\n- **参数**：对于四个测试用例，提供了 $\\rho, \\mu, \\dot{m}$ 的数值，以及四个路径中每个路径的几何和损失参数 $(A_i, D_{h,i}, L_i, K_{\\text{in},i}, K_{\\text{out},i})$。\n- **目标**：为每个测试用例计算四个路径的平均速度 $[V_{\\text{main}}, V_{\\text{window}}, V_{\\text{leak}}, V_{\\text{bypass}}]$。\n\n**步骤2：已知条件验证**\n\n对问题的有效性进行审查：\n- **科学依据**：该问题基于流体力学的基础原理——质量守恒和机械能方程。使用 Darcy-Weisbach 方程以及标准的摩擦因子相关式是分析管道流动的正确且成熟的工程实践。并行网络模型是壳程流动分析的标准简化方法。\n- **适定性**：该问题指定了一个包含五个未知数（四个速度 $V_i$ 和压降 $\\Delta P$）的系统。它提供了五个独立的方程：四个机械能平衡实例和一个质量守恒方程。当质量流量 $\\dot{m}$ 为正时，可以证明该系统对于 $(\\Delta P, V_1, V_2, V_3, V_4)$ 存在唯一的正解，因为总流量是压降的单调递增函数。\n- **客观性与完备性**：该问题使用精确、客观且无歧义的术语进行陈述。解决问题所需的所有数据均已提供。所提供的物理参数和几何尺寸在工程应用的现实范围内。\n\n**步骤3：结论与行动**\n\n该问题被确定为**有效**。这是一个适定的、科学上合理的工程流体力学问题。将提供一个解决方案。\n\n**基于原理的解决方案**\n\n该问题需要求解一个包含五个耦合非线性代数方程的系统，以确定五个变量：压降 $\\Delta P$ 和四个路径速度 $V_i$（其中 $i \\in \\{1, 2, 3, 4\\}$）。\n\n控制方程如下：\n1.  每个路径 $i$ 的机械能平衡：\n    $$ \\Delta P = \\frac{1}{2} \\rho V_i^2 \\left( f_i(V_i) \\frac{L_i}{D_{h,i}} + K_{\\Sigma,i} \\right) $$\n    其中 $K_{\\Sigma,i} = K_{\\text{in},i} + K_{\\text{out},i}$ 是路径 $i$ 的局部损失系数之和，摩擦因子 $f_i$ 是通过 Reynolds 数与 $V_i$ 相关的函数。\n2.  并行网络的连续性方程：\n    $$ \\dot{m} = \\rho \\sum_{i=1}^4 A_i V_i $$\n\n由于摩擦因子 $f_i$ 依赖于速度 $V_i$，该系统是非线性的。直接解析求解是不可行的。需要一种鲁棒的数值方法。所选方法是一个迭代的嵌套求根过程，它利用了问题的物理结构。\n\n总体策略是将共同压降 $\\Delta P$ 视为驱动流量分配的自变量。总质量流量 $\\dot{m}$ 可以表示为 $\\Delta P$ 的函数。问题于是简化为找到一个 $\\Delta P$ 值，使得计算出的质量流量与给定的质量流量 $\\dot{m}_{\\text{target}}$ 相匹配。\n\n**数值算法：**\n\n1.  **外层循环：求解压降 $\\Delta P$**。\n    我们为总质量流量定义一个残差函数：\n    $$ R(\\Delta P) = \\dot{m}_{\\text{calc}}(\\Delta P) - \\dot{m}_{\\text{target}} = \\left( \\rho \\sum_{i=1}^4 A_i V_i(\\Delta P) \\right) - \\dot{m}_{\\text{target}} $$\n    此处，$V_i(\\Delta P)$ 表示在压降为 $\\Delta P$ 时路径 $i$ 中的速度。函数 $\\dot{m}_{\\text{calc}}(\\Delta P)$ 对于 $\\Delta P > 0$ 是单调递增的。因此，我们可以采用一种区间求根算法，例如 Brent 方法，来高效地找到唯一的正根 $\\Delta P^*$，使得 $R(\\Delta P^*) = 0$。\n\n2.  **内层循环：求解路径速度 $V_i$**。\n    对于外层循环给出的任意 $\\Delta P$ 值，我们必须确定每个路径对应的速度 $V_i$。这需要求解关于 $V_i$ 的机械能平衡方程：\n    $$ \\frac{1}{2} \\rho V_i^2 \\left( f_i(V_i) \\frac{L_i}{D_{h,i}} + K_{\\Sigma,i} \\right) - \\Delta P = 0 $$\n    这是一个关于 $V_i$ 的非线性方程。我们为每个路径定义一个残差：\n    $$ F_i(V_i; \\Delta P) = \\frac{1}{2} \\rho V_i^2 \\left( f_i(V_i) \\frac{L_i}{D_{h,i}} + K_{\\Sigma,i} \\right) - \\Delta P $$\n    对于一个固定的 $\\Delta P > 0$，函数 $F_i(V_i)$ 对于 $V_i > 0$ 是单调递增的。我们可以再次使用区间求根器来找到满足 $F_i(V_i; \\Delta P) = 0$ 的唯一正速度 $V_i$。对四个路径中的每一个都重复此过程。\n\n3.  **实现细节**：\n    - 计算被构造为对数值求解器的嵌套调用。用于求解 $\\Delta P$ 的外层求解器在评估其残差函数时，会为每个 $V_i$ 调用一个内层求解器。\n    - 在极限 $V_i \\to 0$ ($\\text{Re}_i \\to 0$) 处必须小心处理；在此极限下，粘性压降占主导地位，计算出的总压降正确地趋于零。\n    - `scipy.optimize.root_scalar` 函数与 `method='brentq'` 参数对于内外层循环均适用，因为它对单调函数具有鲁棒性。根的搜索区间是基于物理推理建立的。对于 $\\Delta P$，下界接近于零，上界则通过迭代增加一个猜测值直到残差 `R(ΔP)` 变为正来找到。对于每个 $V_i$，下界接近于零，上界也用类似的方法找到。\n    - 一旦外层循环确定了正确的压降 $\\Delta P^*$，就需要用这个 $\\Delta P^*$ 为每个路径最后一次求解内层循环问题，从而计算出最终速度。得到的四个速度构成了一个给定测试用例的解。此过程将应用于所有四个测试用例。", "answer": "```python\n# language: Python\n# version: 3.12\n# libraries:\n#   name: numpy\n#   version: 1.23.5\n#   name: scipy\n#   version: 1.11.4\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves for path-average velocities in a shell-and-tube heat exchanger model.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"fluid\": (995, 0.0007, 10),  # (rho, mu, m_dot)\n            \"paths\": {\n                \"main\":   (0.05, 0.02, 0.30, 0.5, 1.0), # (A, Dh, L, Kin, Kout)\n                \"window\": (0.02, 0.03, 0.45, 1.0, 1.5),\n                \"leak\":   (0.002, 0.005, 0.30, 2.0, 2.0),\n                \"bypass\": (0.005, 0.010, 0.30, 1.0, 1.0),\n            },\n        },\n        {\n            \"fluid\": (995, 0.0007, 10),\n            \"paths\": {\n                \"main\":   (0.05, 0.02, 0.30, 0.5, 1.0),\n                \"window\": (0.02, 0.03, 0.45, 1.0, 1.5),\n                \"leak\":   (0.002, 0.005, 0.30, 2.0, 2.0),\n                \"bypass\": (0.0001, 0.004, 0.30, 5.0, 5.0),\n            },\n        },\n        {\n            \"fluid\": (900, 0.2, 1.0),\n            \"paths\": {\n                \"main\":   (0.08, 0.015, 0.25, 0.5, 1.0),\n                \"window\": (0.03, 0.02, 0.35, 1.0, 1.5),\n                \"leak\":   (0.003, 0.004, 0.25, 2.0, 2.0),\n                \"bypass\": (0.006, 0.008, 0.25, 1.0, 1.0),\n            },\n        },\n        {\n            \"fluid\": (998, 0.001, 40),\n            \"paths\": {\n                \"main\":   (0.05, 0.02, 0.30, 0.5, 1.0),\n                \"window\": (0.02, 0.03, 0.45, 1.0, 1.5),\n                \"leak\":   (0.002, 0.005, 0.30, 2.0, 2.0),\n                \"bypass\": (0.005, 0.010, 0.30, 1.0, 1.0),\n            },\n        },\n    ]\n\n    def get_friction_factor(reynolds_number):\n        \"\"\"Calculates the Darcy friction factor.\"\"\"\n        if reynolds_number = 2300:\n            # For Re -> 0, f -> inf. The caller must handle V -> 0 limit.\n            if reynolds_number  1e-9: return np.inf\n            return 64.0 / reynolds_number\n        else:\n            return 0.3164 * reynolds_number**(-0.25)\n\n    def find_velocity_for_path(delta_P, rho, mu, A, Dh, L, Kin, Kout):\n        \"\"\"\n        Inner loop: For a given pressure drop, finds the velocity in a single path.\n        \"\"\"\n        if delta_P = 0:\n            return 0.0\n\n        def velocity_residual(V):\n            \"\"\"Residual for the mechanical energy equation for a single path.\"\"\"\n            if V  1e-9:\n                return -delta_P\n            \n            Re = rho * V * Dh / mu\n            f = get_friction_factor(Re)\n            K_total = f * L / Dh + Kin + Kout\n            \n            calculated_delta_P = 0.5 * rho * V**2 * K_total\n            return calculated_delta_P - delta_P\n\n        try:\n            # Heuristic for bracket. Lower bound is near zero.\n            v_low = 1e-9\n            # Upper bound must yield a positive residual.\n            v_high_guess = np.sqrt(2 * delta_P / (rho * (Kin + Kout))) if (Kin + Kout) > 0 else np.sqrt(2 * delta_P/rho)\n            v_high = max(0.1, v_high_guess * 2)\n\n            # Iteratively increase upper bound until it brackets the root\n            max_iter = 10\n            for _ in range(max_iter):\n                if velocity_residual(v_high) > 0:\n                    break\n                v_high *= 5.0\n            else:\n                 raise RuntimeError(\"Could not find upper bracket for velocity.\")\n\n            sol = root_scalar(velocity_residual, bracket=[v_low, v_high], method='brentq')\n            return sol.root\n        except Exception:\n            return 0.0\n\n    def solve_case(case_data):\n        \"\"\"\n        Outer loop: Solves for velocities for a full test case.\n        \"\"\"\n        rho, mu, m_dot_target = case_data[\"fluid\"]\n        path_list = list(case_data[\"paths\"].values())\n\n        def m_dot_residual(delta_P):\n            \"\"\"Residual for the total mass flow rate.\"\"\"\n            if delta_P = 0:\n                return -m_dot_target\n            \n            m_dot_calculated = 0.0\n            for path_params in path_list:\n                A, Dh, L, Kin, Kout = path_params\n                V = find_velocity_for_path(delta_P, rho, mu, A, Dh, L, Kin, Kout)\n                m_dot_calculated += rho * A * V\n            \n            return m_dot_calculated - m_dot_target\n\n        # Find bracket for delta_P root.\n        dp_low = 1e-3\n        dp_high = 100.0  # Initial guess in Pascals\n\n        max_iter = 15\n        for _ in range(max_iter):\n            if m_dot_residual(dp_high) > 0:\n                break\n            dp_high *= 10.0\n        else:\n            raise RuntimeError(\"Could not find upper bracket for delta_P.\")\n\n        sol = root_scalar(m_dot_residual, bracket=[dp_low, dp_high], method='brentq')\n        final_delta_P = sol.root\n\n        # Calculate final velocities with the correct pressure drop\n        velocities = []\n        for path_params in path_list:\n            A, Dh, L, Kin, Kout = path_params\n            V = find_velocity_for_path(final_delta_P, rho, mu, A, Dh, L, Kin, Kout)\n            velocities.append(V)\n\n        return velocities\n\n    all_results = []\n    for case in test_cases:\n        velocities = solve_case(case)\n        rounded_velocities = [round(v, 5) for v in velocities]\n        all_results.append(rounded_velocities)\n    \n    # Format output string\n    case_strings = [f\"[{','.join(f'{v:.5f}' for v in vel_list)}]\" for vel_list in all_results]\n    final_output_string = f\"[{','.join(case_strings)}]\"\n    print(final_output_string)\n\nsolve()\n```", "id": "2479081"}]}