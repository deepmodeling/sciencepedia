{"hands_on_practices": [{"introduction": "对流换热的经验关联式并非纯粹的曲线拟合，而是植根于流体力学和传热学的基本物理原理。本练习将带您回到问题的本源，从层流边界层的基础控制方程出发。通过运用相似性分析，您将推导出动量边界层厚度 $\\delta$ 与热边界层厚度 $\\delta_t$ 之间的关系如何依赖于流体的普朗特数 $Pr$。完成这项实践 [@problem_id:2486674] 不仅能让您掌握一个重要的计算技能，更能让您深刻理解为何诸如 $Pr^{1/3}$ 这样的因子会系统性地出现在众多强制对流关联式中，从而将抽象的偏微分方程与具体的工程模型紧密联系起来。", "problem": "当自由来流速度为 $U_{\\infty}$、温度为 $T_{\\infty}$ 的牛顿流体流经一个温度保持在 $T_{w}$（其中 $T_{w} \\neq T_{\\infty}$）的等温平板时，形成一个二维、稳态、不可压缩、物性恒定的强迫层流边界层。设 $\\delta(x)$ 表示动量边界层厚度，$\\delta_{t}(x)$ 表示温度边界层厚度，两者均由标准的边界层边缘判据定义（例如，$u(x,\\delta)=0.99\\,U_{\\infty}$ 和 $\\theta(x,\\delta_{t})=0.01$，其中 $\\theta=(T-T_{\\infty})/(T_{w}-T_{\\infty})$）。假设忽略流向热传导、忽略粘性耗散、流向压力梯度为零，并且普朗特数 $Pr=\\nu/\\alpha$ 为常数。\n\n从层流边界层的动量和能量方程出发，并使用基于 Blasius 速度场作为基本解的相似性分析，推导当 $Pr$ 为 1 的量级及更大时，比值 $\\delta_{t}/\\delta$ 对普朗特数的依赖关系。然后，使用该依赖关系估算当 $Pr=0.7$ 和 $Pr=7$ 时 $\\delta_{t}/\\delta$ 的值。最后，根据你的结果，在壁面与自由来流温差 $(T_{w}-T_{\\infty})$ 固定的情况下，定性评论哪种情况下壁面处的法向温度梯度绝对值更大。\n\n报告 $\\delta_{t}/\\delta$ 的两个数值估算结果，按 $(Pr=0.7,\\,Pr=7)$ 的顺序，并保留三位有效数字。比值 $\\delta_{t}/\\delta$ 是无量纲的；最终答案只需给出数值。", "solution": "题目陈述需经过验证。\n\n**第一步：提取已知条件**\n- **流动条件**：二维、稳态、不可压缩、物性恒定、强迫层流边界层。\n- **流体**：牛顿流体。\n- **自由来流参数**：速度 $U_{\\infty}$，温度 $T_{\\infty}$。\n- **壁面条件**：等温平板，温度为 $T_{w}$，且 $T_{w} \\neq T_{\\infty}$。\n- **边界层厚度**：$\\delta(x)$ 为动量边界层厚度，$\\delta_{t}(x)$ 为温度边界层厚度。\n- **边界层边缘判据**：$u(x,\\delta)=0.99\\,U_{\\infty}$ 和 $\\theta(x,\\delta_{t})=0.01$，其中 $\\theta=(T-T_{\\infty})/(T_{w}-T_{\\infty})$。\n- **假设**：忽略流向热传导，忽略粘性耗散，流向压力梯度为零。\n- **流体物性**：普朗特数 $Pr=\\nu/\\alpha$ 为常数。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了平板上伴有传热的经典 Blasius 边界层流动。其控制方程和假设在流体力学和传热学中是标准的。该问题在根本上是成立的。\n- **良态问题**：该问题是良态的。它提供了足够的信息和标准假设，可以推导出所关注变量之间的唯一关系。基于所提供的模型，所提问题有确定的答案。\n- **客观性**：问题以精确、客观、技术性的语言陈述，不含任何主观或非科学性主张。\n\n**第三步：结论与行动**\n该问题有效。它是对流传热理论中一个标准的、基本的问题。将提供解答。\n\n该问题要求从平板上稳态、二维、不可压缩、物性恒定的流动的基本边界层方程出发进行推导。零压力梯度和忽略粘性耗散的假设简化了控制方程。\n\n连续性方程为：\n$$ \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0 $$\n\n边界层动量方程（$x$方向）为：\n$$ u\\frac{\\partial u}{\\partial x} + v\\frac{\\partial u}{\\partial y} = \\nu \\frac{\\partial^2 u}{\\partial y^2} $$\n\n边界层能量方程为：\n$$ u\\frac{\\partial T}{\\partial x} + v\\frac{\\partial T}{\\partial y} = \\alpha \\frac{\\partial^2 T}{\\partial y^2} $$\n其中 $\\nu$ 是运动粘度，$\\alpha$ 是热扩散率。\n\n边界条件为：\n在壁面处（$y=0$）：$u=0$, $v=0$, $T=T_w$。\n在自由来流中（$y \\to \\infty$）：$u \\to U_{\\infty}$, $T \\to T_{\\infty}$。\n\n这些偏微分方程可以使用相似性变换转化为常微分方程。我们引入相似性变量 $\\eta$ 和无量纲流函数 $f(\\eta)$：\n$$ \\eta = y \\sqrt{\\frac{U_{\\infty}}{\\nu x}}, \\quad \\psi(x,y) = \\sqrt{\\nu x U_{\\infty}} f(\\eta) $$\n速度分量由流函数 $\\psi$ 导出：\n$$ u = \\frac{\\partial \\psi}{\\partial y} = U_{\\infty} f'(\\eta) $$\n$$ v = -\\frac{\\partial \\psi}{\\partial x} = \\frac{1}{2} \\sqrt{\\frac{\\nu U_{\\infty}}{x}} (\\eta f'(\\eta) - f(\\eta)) $$\n其中撇号表示对 $\\eta$ 求导。\n\n将这些代入动量方程，得到 Blasius 方程：\n$$ 2 f''' + f f'' = 0 $$\n速度的边界条件变换为：\n$$ f(0) = 0, \\quad f'(0) = 0, \\quad f'(\\infty) = 1 $$\n\n接下来，我们使用无量纲温度 $\\theta(\\eta)$ 对能量方程进行无量纲化：\n$$ \\theta(\\eta) = \\frac{T(x,y) - T_{\\infty}}{T_w - T_{\\infty}} $$\n温度的导数变换如下：\n$$ \\frac{\\partial T}{\\partial x} = (T_w - T_{\\infty}) \\frac{\\partial \\theta}{\\partial \\eta} \\frac{\\partial \\eta}{\\partial x} = (T_w - T_{\\infty}) \\theta' (-\\frac{\\eta}{2x}) $$\n$$ \\frac{\\partial T}{\\partial y} = (T_w - T_{\\infty}) \\frac{\\partial \\theta}{\\partial \\eta} \\frac{\\partial \\eta}{\\partial y} = (T_w - T_{\\infty}) \\theta' \\sqrt{\\frac{U_{\\infty}}{\\nu x}} $$\n$$ \\frac{\\partial^2 T}{\\partial y^2} = (T_w - T_{\\infty}) \\theta'' \\left(\\frac{U_{\\infty}}{\\nu x}\\right) $$\n将速度分量和温度导数代入能量方程，我们得到：\n$$ U_{\\infty}f' (T_w-T_{\\infty}) \\theta'(-\\frac{\\eta}{2x}) + \\frac{1}{2}\\sqrt{\\frac{\\nu U_{\\infty}}{x}}(\\eta f' - f)(T_w-T_{\\infty})\\theta'\\sqrt{\\frac{U_{\\infty}}{\\nu x}} = \\alpha (T_w-T_{\\infty})\\theta''\\left(\\frac{U_{\\infty}}{\\nu x}\\right) $$\n消去项并简化后，方程变为：\n$$ -\\frac{1}{2} f \\theta' = \\frac{\\alpha}{\\nu} \\theta'' $$\n使用普朗特数 $Pr = \\nu/\\alpha$ 的定义重新整理，我们得到温度分布的常微分方程：\n$$ 2 \\theta'' + Pr f \\theta' = 0 $$\n温度边界条件变换为：\n$$ \\theta(0) = 1, \\quad \\theta(\\infty) = 0 $$\n\n问题要求解温度边界层厚度 $\\delta_t$ 与动量边界层厚度 $\\delta$ 之比。根据相似性变量 $\\eta$ 的定义，厚度由下式给出：\n$$ \\delta(x) = \\eta_{\\delta} \\sqrt{\\frac{\\nu x}{U_{\\infty}}}, \\quad \\delta_t(x) = \\eta_{\\delta_t} \\sqrt{\\frac{\\nu x}{U_{\\infty}}} $$\n其中 $\\eta_{\\delta}$ 是 $u/U_{\\infty} = f'(\\eta_{\\delta}) = 0.99$ 处的 $\\eta$ 值，而 $\\eta_{\\delta_t}$ 是 $\\theta(\\eta_{\\delta_t}) = 0.01$ 处的 $\\eta$ 值。该比值即为 $\\delta_t/\\delta = \\eta_{\\delta_t}/\\eta_{\\delta}$。$\\eta_{\\delta}$ 的值是一个由 Blasius 方程的解确定的常数，约为 $\\eta_{\\delta} \\approx 5.0$。$\\eta_{\\delta_t}$ 的值取决于热方程的解，该解包含参数 $Pr$。\n\n为找到对 $Pr$ 的依赖关系，我们比较动量方程 ($2f''' + ff'' = 0$) 和能量方程 ($2\\theta'' + Pr f \\theta' = 0$)。对于大普朗特数 $Pr \\gg 1$ 的情况，温度边界层远薄于速度边界层 ($\\delta_t \\ll \\delta$)。在这个薄层内，速度分布近似为线性，因此流函数是二次的。根据 $f(\\eta)$ 在 $\\eta=0$ 处的泰勒展开，$f(\\eta) = f(0) + f'(0)\\eta + \\frac{1}{2}f''(0)\\eta^2 + ... = \\frac{1}{2}f''(0)\\eta^2$，其中 $f''(0) \\approx 0.332$ 是一个已知的数值结果。\n能量方程近似变为：\n$$ 2 \\theta'' + Pr \\left(\\frac{f''(0)}{2}\\eta^2\\right) \\theta' \\approx 0 $$\n此方程的解表明，温度分布的特征宽度 $\\eta_{\\delta_t}$ 的标度关系使得解中指数项的宗量为 1 的量级。这导出了标度关系 $\\eta_{\\delta_t} \\propto Pr^{-1/3}$。\n由于 $\\eta_{\\delta}$ 是一个常数，我们有：\n$$ \\frac{\\delta_t}{\\delta} = \\frac{\\eta_{\\delta_t}}{\\eta_{\\delta}} \\propto Pr^{-1/3} $$\n通过求解 $\\theta(\\eta)$ 并从解中确定 $\\eta_{\\delta_t}$ 的值，可以更正式地建立这种关系。\n\n对于 $Pr=1$ 的特殊情况，能量方程变为 $2\\theta'' + f\\theta' = 0$。通过观察可以验证，如果 Blasius 方程的一个解是 $f'(\\eta)$，那么 $\\theta(\\eta) = 1 - f'(\\eta)$ 就是能量方程的一个解，因为 $2(-f''') + f(-f'') = -(2f''' + ff'') = 0$。这个解也满足边界条件：$\\theta(0) = 1 - f'(0) = 1$ 和 $\\theta(\\infty) = 1 - f'(\\infty) = 0$。\n基于此，厚度的定义得出：\n$f'(\\eta_{\\delta}) = 0.99$\n$\\theta(\\eta_{\\delta_t}) = 1 - f'(\\eta_{\\delta_t}) = 0.01 \\implies f'(\\eta_{\\delta_t}) = 0.99$\n因此，对于 $Pr=1$，我们发现 $\\eta_{\\delta_t} = \\eta_{\\delta}$，这意味着 $\\delta_t/\\delta = 1$。\n\n将 $Pr=1$ 时的这个精确结果与大 $Pr$ 的标度关系相结合，通常的做法是用下式来近似 $Pr \\gtrsim 0.6$ 时的比值：\n$$ \\frac{\\delta_t}{\\delta} \\approx Pr^{-1/3} $$\n已知这个近似在很宽的普朗特数范围内都相当准确。\n\n使用这个关系，我们可以估算给定普朗特数下的比值。\n对于 $Pr=0.7$：\n$$ \\frac{\\delta_t}{\\delta} \\approx (0.7)^{-1/3} \\approx 1.1255 $$\n保留三位有效数字，结果是 $1.13$。\n\n对于 $Pr=7$：\n$$ \\frac{\\delta_t}{\\delta} \\approx (7)^{-1/3} \\approx 0.5226 $$\n保留三位有效数字，结果是 $0.523$。\n\n最后，我们来解决关于壁面处法向温度梯度绝对值 $|\\partial T/\\partial y|_{y=0}$ 的定性问题。这个梯度与壁面热通量有关。\n$$ \\left. \\frac{\\partial T}{\\partial y} \\right|_{y=0} = (T_w - T_{\\infty}) \\left. \\frac{\\partial \\theta}{\\partial y} \\right|_{y=0} = (T_w - T_{\\infty}) \\theta'(0) \\sqrt{\\frac{U_{\\infty}}{\\nu x}} $$\n问题是在保持 $(T_w-T_{\\infty})$ 不变的情况下，比较 $Pr=0.7$ 和 $Pr=7$ 时该梯度绝对值的大小。这简化为比较壁面处无量纲温度梯度 $|\\theta'(0)|$ 的大小。\n$\\theta(\\eta)$ 的解给出的结果是，对于 $Pr \\gtrsim 0.6$ 的情况，$\\theta'(0)$ 与 $Pr^{1/3}$ 成正比。精确解给出：\n$$ \\theta'(0) = - \\frac{1}{\\int_0^{\\infty} \\exp(-Pr \\int_0^{\\eta} \\frac{f(\\xi)}{2} d\\xi) d\\eta} $$\n这个表达式清楚地表明，随着 $Pr$ 的增加，指数项衰减得更快，分母减小，因此绝对值 $|\\theta'(0)|$ 增大。\n因此，较大的普朗特数对应于壁面处较大的温度梯度绝对值。这在物理上是一致的：对于较大的 $Pr$，温度边界层更薄（$\\delta_t$ 更小），因此相同的温差 $(T_w - T_{\\infty})$ 在更小的距离内实现，导致壁面处的温度梯度更陡（绝对值更大）。\n因此，与 $Pr=0.7$ 的情况相比，$Pr=7$ 的情况下壁面处的法向温度梯度绝对值更大。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.13  0.523\n\\end{pmatrix}\n}\n$$", "id": "2486674"}, {"introduction": "理论分析为我们揭示了努塞尔数 $Nu_x$ 对雷诺数 $Re_x$ 和普朗特数 $Pr$ 的幂律依赖关系，但关联式中的具体系数（如 $0.332$）和指数（如 $0.5$）从何而来？本练习旨在通过一种现代工程师和科学家必备的技能——数据分析，来回答这一问题。您将扮演实验研究者的角色，对给定的模拟实验数据进行对数变换，并应用线性回归方法来拟合形如 $Nu_x = A Re_x^m Pr^n$ 的幂律模型。通过亲手实践 [@problem_id:2486694]，您将从数据中“发现”层流和湍流状态下各自的特征指数，这不仅验证了理论预测，更让您对经验关联式的建立过程获得具体而深入的理解。", "problem": "考虑在自由来流湍流可忽略不计且物性恒定的情况下，流体在等温平板上的外部强制对流。对于固定下游位置的局部传热，无量纲局部努塞尔数 $Nu_x$ 通常通过一个形式为 $Nu_x = A \\, Re_x^{m} \\, Pr^{n}$ 的可分离幂律模型，与局部雷诺数 $Re_x$ 和普朗特数 $Pr$ 进行经验关联。其中，$A$、$m$ 和 $n$ 是待定的常数，需要根据给定的数据集来确定。努塞尔数 $Nu_x$、雷诺数 $Re_x$ 和普朗特数 $Pr$ 这三个量均为无量纲量。\n\n基于以下基本原理出发：\n- 无量纲群的定义：$Nu_x \\equiv \\dfrac{h_x \\, x}{k}$，$Re_x \\equiv \\dfrac{\\rho U_\\infty x}{\\mu}$，$Pr \\equiv \\dfrac{c_p \\mu}{k}$，其中 $h_x$ 是局部对流传热系数，$x$ 是下游坐标，$k$ 是导热系数，$\\rho$ 是密度，$U_\\infty$ 是自由来流速度，$\\mu$ 是动力粘度，$c_p$ 是定压比热。\n- 牛顿冷却定律和边界层相似性论证，这些论证为自相似或类相似区域中 $Nu_x$ 对 $Re_x$ 和 $Pr$ 的可分离幂律依赖关系的可能性提供了理论依据。\n- 针对乘性幂律模型的对数空间线性回归方法。\n\n您的任务是实现一个回归程序，该程序根据给定的数据 $(Re_x, Pr, Nu_x)$，通过最小化对数变换后模型的残差平方和来估计 $(A,m,n)$。具体来说，如果令 $y = \\ln(Nu_x)$，预测变量为 $1$、$\\ln(Re_x)$ 和 $\\ln(Pr)$，则模型为 $y = \\ln(A) + m \\ln(Re_x) + n \\ln(Pr)$，在此空间中进行普通最小二乘法可以确定 $\\ln(A)$、$m$ 和 $n$。如果某个测试用例不包含足以唯一确定 $n$ 的信息（例如，一个 $Pr$ 值恒定的数据集），则应使用能够返回一个明确定义的最小范数解的最小二乘法；在这种情况下，根据可识别性原则，$n$ 的值应为 $0$。\n\n我们为您提供了四个测试数据集。每个数据集都是一个由元组 $(Re_x, Pr, Nu_x)$ 组成的列表，其中所有值均为正数和无量纲量。为保证数值结果的可复现性，请完全按照所提供的数据进行计算，不要重新生成或修改它们。\n\n- 测试用例1（类层流数据）：\n  - $(1000,\\;0.7,\\;9.323)$\n  - $(1000,\\;7.0,\\;20.083)$\n  - $(10000,\\;0.7,\\;29.478)$\n  - $(10000,\\;7.0,\\;63.510)$\n  - $(100000,\\;0.7,\\;93.218)$\n  - $(100000,\\;7.0,\\;200.833)$\n  - $(300000,\\;0.7,\\;161.461)$\n  - $(300000,\\;7.0,\\;347.855)$\n\n- 测试用例2（类湍流数据）：\n  - $(500000,\\;0.7,\\;952.430)$\n  - $(500000,\\;7.0,\\;2051.946)$\n  - $(1000000,\\;0.7,\\;1658.303)$\n  - $(1000000,\\;7.0,\\;3572.662)$\n  - $(5000000,\\;0.7,\\;6007.366)$\n  - $(5000000,\\;7.0,\\;12943.257)$\n  - $(10000000,\\;0.7,\\;10463.050)$\n  - $(10000000,\\;7.0,\\;22542.057)$\n\n- 测试用例3（跨越过渡区的混合层流-湍流数据）：\n  - $(30000,\\;0.7,\\;51.059)$\n  - $(30000,\\;7.0,\\;110.001)$\n  - $(100000,\\;0.7,\\;93.218)$\n  - $(100000,\\;7.0,\\;200.833)$\n  - $(300000,\\;0.7,\\;161.461)$\n  - $(300000,\\;7.0,\\;347.855)$\n  - $(800000,\\;0.7,\\;1385.309)$\n  - $(800000,\\;7.0,\\;2984.596)$\n  - $(1500000,\\;0.7,\\;2294.455)$\n  - $(1500000,\\;7.0,\\;4943.355)$\n\n- 测试用例4（$Pr$ 恒定下的可识别性边界情况）：\n  - $(10000,\\;1.0,\\;33.200)$\n  - $(100000,\\;1.0,\\;104.988)$\n  - $(300000,\\;1.0,\\;181.844)$\n\n要求：\n- 按照描述，在对数空间中实现回归，使用普通最小二乘法。请使用自然对数。\n- 对每个测试用例，估计 $(A,m,n)$ 并将结果四舍五入到三位小数后报告。\n- 科学解释是分析的一部分：在获得 $(m,n)$ 后，应将 $m$ 与流向上的动量边界层厚度的发展联系起来，将 $n$ 与热边界层和动量边界层之间的耦合关系联系起来。但是，您的程序必须只输出数值结果。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表形式的结果，格式应完全如下：\n  - $[[A_1,m_1,n_1],[A_2,m_2,n_2],[A_3,m_3,n_3],[A_4,m_4,n_4]]$\n- 每个 $A_i$、$m_i$ 和 $n_i$ 都必须打印为四舍五入到三位小数的小数。", "solution": "在尝试任何解决方案之前，首先分析问题陈述的有效性。\n\n### 第一步：提取已知条件\n\n- **模型**：局部努塞尔数 ($Nu_x$)、局部雷诺数 ($Re_x$) 和普朗特数 ($Pr$) 之间的关系由幂律模型给出：$Nu_x = A \\, Re_x^{m} \\, Pr^{n}$。\n- **待估参数**：常数 $A$、$m$ 和 $n$。\n- **无量纲群定义**：\n    - $Nu_x \\equiv \\dfrac{h_x \\, x}{k}$\n    - $Re_x \\equiv \\dfrac{\\rho U_\\infty x}{\\mu}$\n    - $Pr \\equiv \\dfrac{c_p \\mu}{k}$\n- **方法论**：必须将普通最小二乘法 (OLS) 回归应用于对数变换后的模型：$\\ln(Nu_x) = \\ln(A) + m \\ln(Re_x) + n \\ln(Pr)$。对于参数无法被唯一确定的情况（例如，$Pr$ 恒定），需要使用最小范数最小二乘解，该解应将不可识别参数的系数 ($n$) 设为 $0$。\n- **数据集**：提供了四个不同的数据集，形式为元组列表 $(Re_x, Pr, Nu_x)$：\n    - **测试用例1**：八个数据点，$Re_x$ 从 $1000$ 到 $300000$，$Pr$ 值为 $0.7$ 和 $7.0$。\n    - **测试用例2**：八个数据点，$Re_x$ 从 $500000$ 到 $10000000$，$Pr$ 值为 $0.7$ 和 $7.0$。\n    - **测试用例3**：十个数据点，$Re_x$ 从 $30000$ 到 $1500000$，$Pr$ 值为 $0.7$ 和 $7.0$。\n    - **测试用例4**：三个数据点，其中 $Pr$ 恒定为 $1.0$。\n- **输出要求**：最终输出必须是列表的列表 $[[A_1,m_1,n_1],[A_2,m_2,n_2],[A_3,m_3,n_3],[A_4,m_4,n_4]]$，所有数值四舍五入到三位小数。\n\n### 第二步：使用提取的已知条件进行验证\n\n1.  **科学依据**：该问题在科学上是成立的。它涉及确定强制对流的经验关联式，这是传热传质学中的一个标准课题。无量纲群 $Nu_x$、$Re_x$ 和 $Pr$ 是该领域的核心。幂律模型是在特定流态（层流、湍流）下此类关联式的广为接受的形式。其基础物理学是完善的。\n\n2.  **适定性**：该问题是适定的。它清晰地定义了模型、数据以及用以寻找唯一解的数学程序（对数空间中的线性回归）。它正确地预见了当 $Pr$ 恒定时可能出现的共线性问题，并规定了一种标准的、明确的解决方案：使用最小范数最小二乘解。\n\n3.  **客观性**：问题陈述使用精确、客观和定量的语言。它没有主观性或歧义。\n\n4.  **缺陷核对表**：该问题没有违反任何指定的无效性标准。它在科学上是有效的、可形式化的、完整的、可行的且结构良好。它提出了一个在工程学科中常见的非平凡分析任务。\n\n### 第三步：结论与行动\n\n问题陈述是**有效的**。将按照指定的方法论来开发解决方案。\n\n### 求解推导\n\n所提出的模型是一个乘性幂律：\n$$Nu_x = A \\, Re_x^{m} \\, Pr^{n}$$\n这个非线性方程可以通过对两边取自然对数来进行线性化：\n$$\\ln(Nu_x) = \\ln(A) + \\ln(Re_x^m) + \\ln(Pr^n)$$\n利用对数的性质，我们得到一个线性方程：\n$$\\ln(Nu_x) = \\ln(A) + m \\ln(Re_x) + n \\ln(Pr)$$\n此方程是多元线性回归模型的形式。我们为回归定义变量：\n- 响应变量：$y = \\ln(Nu_x)$\n- 预测变量：$x_1 = \\ln(Re_x)$ 和 $x_2 = \\ln(Pr)$\n- 待定系数：$\\beta_0 = \\ln(A)$，$\\beta_1 = m$，$\\beta_2 = n$。\n\n该模型现在可以写成：\n$$y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2_i$$\n给定一组 $N$ 个数据点 $(Re_{x,i}, Pr_i, Nu_{x,i})$（$i = 1, \\dots, N$），我们可以构建一个线性方程组。该系统最方便地以矩阵形式表示：\n$$\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}$$\n其中：\n- $\\mathbf{y}$ 是观测响应值的 $N \\times 1$ 列向量：\n  $$\\mathbf{y} = \\begin{pmatrix} \\ln(Nu_{x,1}) \\\\ \\ln(Nu_{x,2}) \\\\ \\vdots \\\\ \\ln(Nu_{x,N}) \\end{pmatrix}$$\n- $\\mathbf{X}$ 是 $N \\times 3$ 的设计矩阵，其中第一列全为1，用于解释截距项 $\\beta_0$：\n  $$\\mathbf{X} = \\begin{pmatrix}\n  1  \\ln(Re_{x,1})  \\ln(Pr_1) \\\\\n  1  \\ln(Re_{x,2})  \\ln(Pr_2) \\\\\n  \\vdots  \\vdots  \\vdots \\\\\n  1  \\ln(Re_{x,N})  \\ln(Pr_N)\n  \\end{pmatrix}$$\n- $\\boldsymbol{\\beta}$ 是 $3 \\times 1$ 的系数列向量：\n  $$\\boldsymbol{\\beta} = \\begin{pmatrix} \\beta_0 \\\\ \\beta_1 \\\\ \\beta_2 \\end{pmatrix} = \\begin{pmatrix} \\ln(A) \\\\ m \\\\ n \\end{pmatrix}$$\n- $\\boldsymbol{\\epsilon}$ 是 $N \\times 1$ 的残差向量。\n\n普通最小二乘法 (OLS) 的目标是找到使残差平方和 $\\|\\boldsymbol{\\epsilon}\\|^2 = \\|\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta}\\|^2$ 最小化的系数向量 $\\boldsymbol{\\hat{\\beta}}$。\n\n当 $\\mathbf{X}$ 的列线性无关时，矩阵 $\\mathbf{X}^T \\mathbf{X}$ 可逆，唯一的 OLS 解由正规方程给出：\n$$\\boldsymbol{\\hat{\\beta}} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y}$$\n然而，如果 $\\mathbf{X}$ 的列线性相关（即完全多重共线性），$\\mathbf{X}^T \\mathbf{X}$ 是奇异的，无法求逆。这种情况出现在测试用例4中，其中 $Pr$ 是常数。此时，$\\mathbf{X}$ 的第三列（包含 $\\ln(Pr_i)$ 值）是一个常数，比如说 $c$。因此，该列是第一列（全为1）的倍数，具体为第一列的 $c$ 倍。\n\n对于这种情况，问题要求一个最小范数最小二乘解。这通常使用 $\\mathbf{X}$ 的伪逆（或 Moore-Penrose 逆），记作 $\\mathbf{X}^+$，来计算。解为：\n$$\\boldsymbol{\\hat{\\beta}} = \\mathbf{X}^+ \\mathbf{y}$$\n这提供的解 $\\boldsymbol{\\hat{\\beta}}$ 既能最小化 $\\|\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta}\\|^2$，又在所有满足这一条件的向量中具有最小的欧几里得范数 $\\|\\boldsymbol{\\hat{\\beta}}\\|$。对于像测试用例4中的秩亏系统，此方法能正确识别冗余参数并有效地将其系数设置为零，因为数据中没有信息可以估计它。在这种情况下，它将得出 $n = \\beta_2 = 0$。\n\n实现中将使用 `numpy.linalg.lstsq`，该函数可以精确计算这种最小范数最小二乘解，能够正确处理满秩和秩亏两种情况。\n\n一旦为每个测试用例确定了系数向量 $\\boldsymbol{\\hat{\\beta}} = [\\hat{\\beta}_0, \\hat{\\beta}_1, \\hat{\\beta}_2]^T$，就可以按如下方式恢复原始模型参数：\n- $m = \\hat{\\beta}_1$\n- $n = \\hat{\\beta}_2$\n- $A = \\exp(\\hat{\\beta}_0)$\n\n然后将这些值按要求四舍五入到三位小数。此程序将应用于所有四个测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs multiple linear regression on log-transformed data to find\n    the parameters of the power-law model Nu = A * Re^m * Pr^n for\n    several heat transfer data sets.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1 (Laminar-like data)\n        [\n            (1000, 0.7, 9.323),\n            (1000, 7.0, 20.083),\n            (10000, 0.7, 29.478),\n            (10000, 7.0, 63.510),\n            (100000, 0.7, 93.218),\n            (100000, 7.0, 200.833),\n            (300000, 0.7, 161.461),\n            (300000, 7.0, 347.855)\n        ],\n        # Test Case 2 (Turbulent-like data)\n        [\n            (500000, 0.7, 952.430),\n            (500000, 7.0, 2051.946),\n            (1000000, 0.7, 1658.303),\n            (1000000, 7.0, 3572.662),\n            (5000000, 0.7, 6007.366),\n            (5000000, 7.0, 12943.257),\n            (10000000, 0.7, 10463.050),\n            (10000000, 7.0, 22542.057)\n        ],\n        # Test Case 3 (Mixed laminar–turbulent data across transition)\n        [\n            (30000, 0.7, 51.059),\n            (30000, 7.0, 110.001),\n            (100000, 0.7, 93.218),\n            (100000, 7.0, 200.833),\n            (300000, 0.7, 161.461),\n            (300000, 7.0, 347.855),\n            (800000, 0.7, 1385.309),\n            (800000, 7.0, 2984.596),\n            (1500000, 0.7, 2294.455),\n            (1500000, 7.0, 4943.355)\n        ],\n        # Test Case 4 (Identifiability edge case with constant Pr)\n        [\n            (10000, 1.0, 33.200),\n            (100000, 1.0, 104.988),\n            (300000, 1.0, 181.844)\n        ]\n    ]\n\n    results = []\n    for case_data in test_cases:\n        # Unpack data into numpy arrays\n        data = np.array(case_data)\n        re_x = data[:, 0]\n        pr = data[:, 1]\n        nu_x = data[:, 2]\n\n        # Linearize the model by taking the natural logarithm of the variables.\n        # The model is ln(Nu_x) = ln(A) + m*ln(Re_x) + n*ln(Pr).\n        # This is a multiple linear regression problem y = b0 + b1*x1 + b2*x2\n        # where y = ln(Nu_x), x1 = ln(Re_x), x2 = ln(Pr)\n        # and the coefficients are b0 = ln(A), b1 = m, b2 = n.\n        \n        y = np.log(nu_x)\n        x1 = np.log(re_x)\n        x2 = np.log(pr)\n\n        # Construct the design matrix X. The first column of ones is for the intercept (ln(A)).\n        N = len(re_x)\n        X = np.vstack([np.ones(N), x1, x2]).T\n\n        # Solve the least-squares problem X * beta = y for beta.\n        # beta contains the coefficients [ln(A), m, n].\n        # np.linalg.lstsq returns the minimal-norm solution for rank-deficient\n        # matrices, which is required for Test Case 4.\n        coeffs, _, _, _ = np.linalg.lstsq(X, y, rcond=None)\n        \n        # Extract the parameters from the regression coefficients\n        beta0_hat = coeffs[0]\n        m = coeffs[1]\n        n = coeffs[2]\n\n        # Recover A from ln(A)\n        A = np.exp(beta0_hat)\n        \n        # Round the results to three decimal places\n        A_rounded = round(A, 3)\n        m_rounded = round(m, 3)\n        n_rounded = round(n, 3)\n\n        results.append([A_rounded, m_rounded, n_rounded])\n\n    # Format the final output string exactly as specified.\n    # We convert float numbers to strings with desired precision to avoid\n    # floating point representation issues, e.g., 0.5 becoming 0.500000001\n    output_str = \"[\"\n    for i, res in enumerate(results):\n        A_str = f\"{res[0]:.3f}\"\n        m_str = f\"{res[1]:.3f}\"\n        n_str = f\"{res[2]:.3f}\"\n        output_str += f\"[{A_str},{m_str},{n_str}]\"\n        if i  len(results) - 1:\n            output_str += \",\"\n    output_str += \"]\"\n\n    print(output_str)\n\nsolve()\n```", "id": "2486694"}, {"introduction": "在真实的工程应用中，流动很少会完全处于理想的单一状态。本练习将引导您处理一个更贴近现实的复杂情境：当流体流经一块平板时，边界层会经历从层流到湍流的转捩过程。您的核心任务是综合运用层流和湍流的局部换热关联式，通过积分计算来预测整个平板的平均换热性能。更进一步，本练习 [@problem_id:2486671] 引入了灵敏度分析，要求您量化转捩雷诺数 $Re_{x,cr}$（一个在实际中常有不确定性的参数）的变化对总体换热预测结果的影响。这项综合性实践旨在培养您的工程整合能力与批判性思维，使您能从理想化分析迈向对多区体系的综合评估与不确定性量化。", "problem": "一块长度为 $L$ 的光滑等温平板，置于物性恒定的牛顿流体的均匀、零压力梯度外流中，且与流动方向平行。流动在流向位置 $x_{cr}$ 处从层流急剧转捩为湍流，该位置由临界雷诺数 $Re_{x,cr} \\equiv u_{\\infty} x_{cr} / \\nu$ 定义，其中 $u_{\\infty}$ 是自由来流速度，$\\nu$ 是运动粘度。在 $x_{cr}$ 之后，直到 $x=L$ 处，边界层均为完全湍流。努塞尔特数 $Nu$ 按照通常的方式，由传热系数 $h$、导热系数 $k$ 和一个特征长度定义，其中局部努塞尔特数为 $Nu_x \\equiv h_x x / k$，平板上的平均努塞尔特数为 $Nu_L \\equiv \\bar{h}_L L / k$。\n\n从 $Nu_x$ 和 $Nu_L$ 的定义出发，并使用中等普朗特数下光滑平板上层流和湍流边界层内局部对流传热的成熟平板关联式（视湍流区域始于 $x_{cr}$），推导 $Nu_L$ 作为平板雷诺数 $Re_L \\equiv u_{\\infty} L / \\nu$、普朗特数 $Pr$ 和临界雷诺数 $Re_{x,cr}$ 的函数的解析表达式。然后，基于此表达式，在下面给出的名义参数下，求一阶对数灵敏度\n$$\nS \\equiv \\frac{\\partial \\ln Nu_L}{\\partial \\ln Re_{x,cr}}\n$$\n利用该灵敏度，估算由 $Re_{x,cr}$ 的 $\\pm 20\\%$ 不确定度引起的 $Nu_L$ 的一阶传递分数不确定度。\n\n假设以下名义条件：\n- $Re_L = 1.00 \\times 10^{7}$，\n- $Pr = 0.71$，\n- $Re_{x,cr} = 5.00 \\times 10^{5}$ (此名义值有 $\\pm 20\\%$ 的不确定度)。\n\n对这些关联式做标准假设：光滑平板、物性恒定、可忽略的自由来流加热、可忽略的粘性耗散、零压力梯度，以及在 $x_{cr}$ 处的急剧转捩。\n\n使用一阶近似 $|\\Delta Nu_L|/Nu_L \\approx |S| \\, |\\Delta Re_{x,cr}|/Re_{x,cr}$ 计算 $Nu_L$ 的传递分数不确定度（作为一个纯数），并将最终结果四舍五入至四位有效数字，以无量纲小数形式报告（无单位）。", "solution": "该问题陈述在科学上是成立的、提法恰当、客观且自洽。这是对流传热领域的一个标准问题，涉及应用成熟的半经验关联式和灵敏度分析。所有必要的数据和定义均已提供。该问题有效。\n\n求解过程分三个阶段：首先，推导平均努塞尔特数 $Nu_L$；其次，推导对数灵敏度 $S$；第三，数值计算传递不确定度。\n\n长度为 $L$ 的平板上的平均传热系数 $\\bar{h}_L$ 定义为局部传热系数 $h_x$ 沿平板长度的积分：\n$$\n\\bar{h}_L = \\frac{1}{L} \\int_{0}^{L} h_x dx\n$$\n因此，平均努塞尔特数 $Nu_L = \\bar{h}_L L / k$ 由下式给出：\n$$\nNu_L = \\frac{(\\frac{1}{L} \\int_{0}^{L} h_x dx) L}{k} = \\frac{1}{k} \\int_{0}^{L} h_x dx\n$$\n局部传热系数 $h_x$ 与局部努塞尔特数 $Nu_x \\equiv h_x x / k$ 的关系为 $h_x = k \\cdot Nu_x / x$。\n\n流动在临界位置 $x_{cr}$ 之前为层流，之后为湍流。因此，积分必须分为两部分：从 $x=0$ 到 $x_{cr}$ 的层流部分，以及从 $x_{cr}$ 到 $x=L$ 的湍流部分。\n$$\nNu_L = \\frac{1}{k} \\left[ \\int_{0}^{x_{cr}} h_{x,lam} dx + \\int_{x_{cr}}^{L} h_{x,turb} dx \\right]\n$$\n我们使用光滑等温平板上局部传热的标准、成熟关联式。\n对于层流 ($Re_x  Re_{x,cr}$):\n$$\nNu_{x,lam} = C_1 Re_x^{1/2} Pr^{1/3} \\quad \\text{其中} \\quad C_1 = 0.332\n$$\n对于湍流 ($Re_x  Re_{x,cr}$)，视湍流边界层始于 $x_{cr}$：\n$$\nNu_{x,turb} = C_2 Re_x^{4/5} Pr^{1/3} \\quad \\text{其中} \\quad C_2 = 0.0296\n$$\n此处，$Re_x = u_{\\infty} x / \\nu$。我们可以用 $Re_x$ 表示 $h_x$：\n$h_x = \\frac{k}{x} Nu_x$。\n\n首先，我们计算层流部分的积分：\n$$\n\\int_{0}^{x_{cr}} h_{x,lam} dx = \\int_{0}^{x_{cr}} \\frac{k}{x} \\left( C_1 \\left(\\frac{u_{\\infty}x}{\\nu}\\right)^{1/2} Pr^{1/3} \\right) dx\n$$\n$$\n= k C_1 Pr^{1/3} \\left(\\frac{u_{\\infty}}{\\nu}\\right)^{1/2} \\int_{0}^{x_{cr}} x^{-1/2} dx = k C_1 Pr^{1/3} \\left(\\frac{u_{\\infty}}{\\nu}\\right)^{1/2} [2x^{1/2}]_{0}^{x_{cr}}\n$$\n$$\n= 2 k C_1 Pr^{1/3} \\left(\\frac{u_{\\infty}x_{cr}}{\\nu}\\right)^{1/2} = 2 k C_1 Pr^{1/3} Re_{x,cr}^{1/2}\n$$\n\n接下来，我们计算湍流部分的积分：\n$$\n\\int_{x_{cr}}^{L} h_{x,turb} dx = \\int_{x_{cr}}^{L} \\frac{k}{x} \\left( C_2 \\left(\\frac{u_{\\infty}x}{\\nu}\\right)^{4/5} Pr^{1/3} \\right) dx\n$$\n$$\n= k C_2 Pr^{1/3} \\left(\\frac{u_{\\infty}}{\\nu}\\right)^{4/5} \\int_{x_{cr}}^{L} x^{-1/5} dx = k C_2 Pr^{1/3} \\left(\\frac{u_{\\infty}}{\\nu}\\right)^{4/5} \\left[\\frac{5}{4}x^{4/5}\\right]_{x_{cr}}^{L}\n$$\n$$\n= \\frac{5}{4} k C_2 Pr^{1/3} \\left[ \\left(\\frac{u_{\\infty}L}{\\nu}\\right)^{4/5} - \\left(\\frac{u_{\\infty}x_{cr}}{\\nu}\\right)^{4/5} \\right] = \\frac{5}{4} k C_2 Pr^{1/3} (Re_L^{4/5} - Re_{x,cr}^{4/5})\n$$\n将这些结果代回 $Nu_L$ 的表达式：\n$$\nNu_L = \\frac{1}{k} \\left[ 2 k C_1 Pr^{1/3} Re_{x,cr}^{1/2} + \\frac{5}{4} k C_2 Pr^{1/3} (Re_L^{4/5} - Re_{x,cr}^{4/5}) \\right]\n$$\n这可以简化为所要求的 $Nu_L$ 的解析表达式：\n$$\nNu_L = Pr^{1/3} \\left[ 2 C_1 Re_{x,cr}^{1/2} + \\frac{5}{4} C_2 (Re_L^{4/5} - Re_{x,cr}^{4/5}) \\right]\n$$\n该表达式通常写成 $Nu_L = Pr^{1/3} (C_{2,avg} Re_L^{4/5} - A)$ 的形式，其中 $C_{2,avg} = \\frac{5}{4}C_2 = 0.037$，且 $A = C_{2,avg} Re_{x,cr}^{4/5} - C_{1,avg} Re_{x,cr}^{1/2}$，$C_{1,avg}=2C_1=0.664$。我们的表达式是等效的：\n$$\nNu_L = Pr^{1/3} \\left[ \\frac{5}{4} C_2 Re_L^{4/5} - \\left( \\frac{5}{4} C_2 Re_{x,cr}^{4/5} - 2 C_1 Re_{x,cr}^{1/2} \\right) \\right]\n$$\n\n现在，我们推导灵敏度 $S \\equiv \\frac{\\partial \\ln Nu_L}{\\partial \\ln Re_{x,cr}}$。使用链式法则，$S = \\frac{Re_{x,cr}}{Nu_L} \\frac{\\partial Nu_L}{\\partial Re_{x,cr}}$。\n我们计算 $Nu_L$ 关于 $Re_{x,cr}$ 的偏导数：\n$$\n\\frac{\\partial Nu_L}{\\partial Re_{x,cr}} = \\frac{\\partial}{\\partial Re_{x,cr}} \\left( Pr^{1/3} \\left[ 2 C_1 Re_{x,cr}^{1/2} + \\frac{5}{4} C_2 Re_L^{4/5} - \\frac{5}{4} C_2 Re_{x,cr}^{4/5} \\right] \\right)\n$$\n$$\n= Pr^{1/3} \\left[ 2 C_1 \\left(\\frac{1}{2} Re_{x,cr}^{-1/2}\\right) + 0 - \\frac{5}{4} C_2 \\left(\\frac{4}{5} Re_{x,cr}^{-1/5}\\right) \\right]\n$$\n$$\n= Pr^{1/3} \\left[ C_1 Re_{x,cr}^{-1/2} - C_2 Re_{x,cr}^{-1/5} \\right]\n$$\n将此代入 $S$ 的表达式：\n$$\nS = \\frac{Re_{x,cr}}{Nu_L} \\left( Pr^{1/3} \\left[ C_1 Re_{x,cr}^{-1/2} - C_2 Re_{x,cr}^{-1/5} \\right] \\right)\n= \\frac{Pr^{1/3}}{Nu_L} \\left[ C_1 Re_{x,cr}^{1/2} - C_2 Re_{x,cr}^{4/5} \\right]\n$$\n\n最后，我们计算数值。给定的参数是：\n$Re_L = 1.00 \\times 10^7$\n$Pr = 0.71$\n$Re_{x,cr} = 5.00 \\times 10^5$\n临界雷诺数的分数不确定度为 $|\\Delta Re_{x,cr}|/Re_{x,cr} = 0.20$。\n\n首先，我们计算 $Nu_L$ 所需的各项：\n$Pr^{1/3} = (0.71)^{1/3} \\approx 0.89214$\n$Re_{x,cr}^{1/2} = (5 \\times 10^5)^{1/2} \\approx 707.107$\n$Re_{x,cr}^{4/5} = (5 \\times 10^5)^{4/5} \\approx 36239.5$\n$Re_L^{4/5} = (10^7)^{4/5} \\approx 398107.2$\n\n我们计算 $Nu_L$：\n$$\nNu_L = 0.89214 \\left[ (2 \\times 0.332 \\times 707.107) + \\frac{5}{4} \\times 0.0296 \\times (398107.2 - 36239.5) \\right]\n$$\n$$\nNu_L = 0.89214 \\left[ 469.515 + 0.037 \\times (361867.7) \\right]\n$$\n$$\nNu_L = 0.89214 \\left[ 469.515 + 13389.1 \\right] = 0.89214 \\times 13858.6 = 12363.3\n$$\n\n接下来，我们计算灵敏度 $S$：\n$S$ 的分子：\n$$\nPr^{1/3} \\left[ C_1 Re_{x,cr}^{1/2} - C_2 Re_{x,cr}^{4/5} \\right] = 0.89214 \\left[ 0.332 \\times 707.107 - 0.0296 \\times 36239.5 \\right]\n$$\n$$\n= 0.89214 \\left[ 234.76 - 1072.69 \\right] = 0.89214 \\times (-837.93) = -747.53\n$$\n灵敏度为：\n$$\nS = \\frac{-747.53}{12363.3} \\approx -0.060463\n$$\n\n$Nu_L$ 的一阶传递分数不确定度为：\n$$\n\\frac{|\\Delta Nu_L|}{Nu_L} \\approx |S| \\frac{|\\Delta Re_{x,cr}|}{Re_{x,cr}} = |-0.060463| \\times 0.20\n$$\n$$\n= 0.060463 \\times 0.20 = 0.0120926\n$$\n四舍五入到四位有效数字，结果是 $0.01209$。", "answer": "$$\n\\boxed{0.01209}\n$$", "id": "2486671"}]}