{"hands_on_practices": [{"introduction": "在自然对流分析中，Boussinesq 近似是简化控制方程的基石。该近似假设密度变化很小，可以忽略，但当密度变化与重力相乘时（即浮力项）则必须保留。本练习 [@problem_id:2510673] 将指导您通过计算无量纲参数 $\\beta \\Delta T$ 来量化这一关键假设的有效性，从而加深您在应用理论模型前理解其局限性的重要性。", "problem": "一块特征长度为 $L$ 的大型水平等温板，浸没在环境温度为 $T_{\\infty}$、环境密度为 $\\rho_{\\infty}$ 的静止液态水中。该板比周围液体温度高，其表面温度均匀，为 $T_{s}=T_{\\infty}+\\Delta T$。在 Boussinesq 框架下，考虑朝上热板上方的自然对流。\n\n仅从具有可变密度的连续介质的质量守恒、包含重力的动量方程以及针对小温差的线性化状态方程出发：\n$$\n\\frac{\\partial \\rho}{\\partial t}+\\nabla\\cdot(\\rho \\mathbf{u})=0,\\qquad\n\\rho \\frac{D\\mathbf{u}}{Dt}=-\\nabla p+\\mu \\nabla^{2}\\mathbf{u}+\\rho \\mathbf{g},\\qquad\n\\rho(T)=\\rho_{\\infty}\\left[1-\\beta\\left(T-T_{\\infty}\\right)\\right],\n$$\n论证哪个无量纲小参数控制了 Boussinesq 近似在此配置中的有效性，并确定该参数在流场中的何处达到其最大值。然后，对于 $20\\,^{\\circ}\\mathrm{C}$ 的液态水，其等压体积热膨胀系数为 $\\beta=2.07\\times 10^{-4}\\ \\mathrm{K}^{-1}$，板与环境的温差为 $\\Delta T=20\\ \\mathrm{K}$，板长为 $L=0.1\\ \\mathrm{m}$，计算该小参数的数值。最后，利用你的结果解释板附近相对于 $\\rho_{\\infty}$ 的相对密度变化。\n\n将最终结果表示为一个纯数（无量纲），并四舍五入到三位有效数字。", "solution": "该问题要求进行论证，以确定控制自然对流中 Boussinesq 近似有效性的无量纲参数，找出其影响最显著的位置，并针对给定的物理情景计算其数值。\n\n出发点是针对密度 $\\rho$ 可变的流体的一组控制方程，以及一个线性化状态方程。\n质量守恒：\n$$\n\\frac{\\partial \\rho}{\\partial t}+\\nabla\\cdot(\\rho \\mathbf{u})=0\n$$\n动量守恒：\n$$\n\\rho \\frac{D\\mathbf{u}}{Dt}=-\\nabla p+\\mu \\nabla^{2}\\mathbf{u}+\\rho \\mathbf{g}\n$$\n线性化状态方程：\n$$\n\\rho(T)=\\rho_{\\infty}\\left[1-\\beta\\left(T-T_{\\infty}\\right)\\right]\n$$\n其中，$\\rho_{\\infty}$ 和 $T_{\\infty}$ 是静止环境流体的参考密度和参考温度，$\\beta$ 是等压体积热膨胀系数，$\\mathbf{u}$ 是速度矢量，$p$ 是压力，$\\mu$ 是动力粘度，$\\mathbf{g}$ 是重力加速度。\n\nBoussinesq 近似通过假设密度变化相对于参考密度很小来简化这些方程。我们可以通过分析状态方程来形式化这一假设。密度 $\\rho$ 可以表示为参考密度 $\\rho_{\\infty}$ 和一个偏差量 $\\delta\\rho$ 的和：\n$$\n\\rho = \\rho_{\\infty} + \\delta\\rho\n$$\n根据状态方程，这个偏差量为：\n$$\n\\delta\\rho = -\\rho_{\\infty}\\beta(T-T_{\\infty})\n$$\n因此，相对密度变化为：\n$$\n\\frac{\\delta\\rho}{\\rho_{\\infty}} = \\frac{\\rho - \\rho_{\\infty}}{\\rho_{\\infty}} = -\\beta(T-T_{\\infty})\n$$\n如果在整个流场域内，此相对密度变化的量级远小于1，则 Boussinesq 近似有效：\n$$\n\\left|\\frac{\\rho - \\rho_{\\infty}}{\\rho_{\\infty}}\\right| = \\beta|T-T_{\\infty}| \\ll 1\n$$\n流体中的温度界于环境温度 $T_{\\infty}$ 和板表面温度 $T_s$ 之间。因此，最大温差为 $\\Delta T = T_s - T_{\\infty}$。所以，相对密度变化的最大可能值为：\n$$\n\\max \\left( \\left|\\frac{\\rho - \\rho_{\\infty}}{\\rho_{\\infty}}\\right| \\right) = \\beta(T_s - T_{\\infty}) = \\beta \\Delta T\n$$\n这个无量纲数群 $\\beta \\Delta T$ 就是控制该近似有效性的参数。为使近似精确，我们必须有 $\\beta \\Delta T \\ll 1$。\n\n让我们研究一下该参数如何简化控制方程。\n在惯性项 $\\rho \\frac{D\\mathbf{u}}{Dt}$ 中，我们代入 $\\rho = \\rho_{\\infty} + \\delta\\rho$：\n$$\n\\rho \\frac{D\\mathbf{u}}{Dt} = (\\rho_{\\infty} + \\delta\\rho)\\frac{D\\mathbf{u}}{Dt} = \\rho_{\\infty}\\frac{D\\mathbf{u}}{Dt} + \\delta\\rho\\frac{D\\mathbf{u}}{Dt}\n$$\n由于 $\\frac{|\\delta\\rho|}{\\rho_{\\infty}} \\le \\beta \\Delta T \\ll 1$，$\\delta\\rho \\frac{D\\mathbf{u}}{Dt}$ 这一项与 $\\rho_{\\infty}\\frac{D\\mathbf{u}}{Dt}$ 相比可忽略不计。因此，惯性项近似为 $\\rho_{\\infty}\\frac{D\\mathbf{u}}{Dt}$。\n\n在连续性方程 $\\frac{\\partial \\rho}{\\partial t}+\\nabla\\cdot(\\rho \\mathbf{u})=0$ 中，代入 $\\rho = \\rho_{\\infty}(1-\\beta(T-T_\\infty))$ 得到\n$\\frac{\\partial}{\\partial t}(\\rho_{\\infty}(1-\\beta(T-T_\\infty))) + \\nabla\\cdot(\\rho_{\\infty}(1-\\beta(T-T_\\infty))\\mathbf{u}) = 0$。用 $\\rho_\\infty$ 除并化简后，方程变为 $-\\beta \\frac{DT}{Dt} + (1-\\beta(T-T_\\infty))\\nabla\\cdot\\mathbf{u}=0$。如果 $\\beta \\Delta T \\ll 1$，则 $1-\\beta(T-T_\\infty) \\approx 1$，且如果 $\\beta \\frac{DT}{Dt}$ 项也很小，方程就简化为经典的不可压缩形式 $\\nabla\\cdot\\mathbf{u}=0$。\n\n然而，在体力项 $\\rho\\mathbf{g}$ 中，同样的代入得到 $\\rho\\mathbf{g} = (\\rho_{\\infty} + \\delta\\rho)\\mathbf{g} = \\rho_{\\infty}\\mathbf{g} + \\delta\\rho\\mathbf{g}$。第一项 $\\rho_{\\infty}\\mathbf{g}$ 代表了参考密度下流体的静水重力。该项与静水压力梯度 $\\nabla p_h = \\rho_{\\infty}\\mathbf{g}$ 相平衡，其中 $p=p_h+p_m$。第二项 $\\delta\\rho\\mathbf{g} = -\\rho_{\\infty}\\beta(T-T_{\\infty})\\mathbf{g}$ 是浮力。尽管 $\\delta\\rho$ 很小，但这个力是驱动整个对流运动的力，因此是主导阶，在动量平衡中被保留。此近似的关键在于 $\\delta\\rho$ 相对于 $\\rho_{\\infty}$ 足够小，但 $\\delta\\rho\\mathbf{g}$ 与惯性力和粘性力等其他动力项具有可比性。\n\n因此，控制 Boussinesq 近似有效性的无量纲参数是 $\\beta \\Delta T$。\n\n条件 $\\beta |T-T_{\\infty}| \\ll 1$ 在 $|T-T_{\\infty}|$ 最大的地方最为严格。在本问题中，流体温度范围从 $T_{\\infty}$ 到 $T_s$。最大温差 $\\Delta T = T_s-T_\\infty$ 出现在热板表面。因此，相对密度偏差 $|\\rho-\\rho_\\infty|/\\rho_\\infty = \\beta|T-T_\\infty|$ 在板表面达到其最大值 $\\beta \\Delta T$。\n\n现在，我们根据给定条件计算该参数的数值：\n- 等压体积热膨胀系数，$\\beta = 2.07 \\times 10^{-4}\\ \\mathrm{K}^{-1}$。\n- 板与环境的温差，$\\Delta T = 20\\ \\mathrm{K}$。\n\n该无量纲参数为：\n$$\n\\beta \\Delta T = (2.07 \\times 10^{-4}\\ \\mathrm{K}^{-1}) \\times (20\\ \\mathrm{K}) = 41.4 \\times 10^{-4} = 4.14 \\times 10^{-3}\n$$\n该参数的值为 $0.00414$。\n\n最后，我们解释这个结果。数值 $\\beta \\Delta T \\approx 0.00414$ 代表了相对于环境密度的最大密度分数变化。具体来说，在板表面，密度 $\\rho_s$ 比环境密度 $\\rho_{\\infty}$ 低了大约 $0.414\\%$：\n$$\n\\frac{\\rho_{\\infty} - \\rho_s}{\\rho_{\\infty}} = \\beta(T_s - T_{\\infty}) = \\beta \\Delta T = 4.14 \\times 10^{-3}\n$$\n这个密度变化非常小（远小于 $1\\%$），这为应用 Boussinesq 近似来模拟这个特定的自然对流问题提供了有力的支持。对于这个关于材料属性近似有效性的具体问题，特征长度 $L=0.1\\,\\mathrm{m}$ 是无关的。", "answer": "$$\\boxed{4.14 \\times 10^{-3}}$$", "id": "2510673"}, {"introduction": "水平板的传热速率很大程度上取决于其加热面是朝上还是朝下。这种差异源于流体动力学稳定性：向上加热的板会产生不稳定的密度分层，导致剧烈的羽流；而向下加热的板则处于稳定状态，会抑制垂直运动。通过对这两种情况进行标度分析 [@problem_id:2510711]，您将从第一性原理推导出为何努塞尔数 $Nu$ 与瑞利数 $Ra_L$ 的标度关系 ($Nu \\sim Ra_L^n$) 不同，这不仅揭示了经验关联式的物理起源，还能锻炼您运用标度分析预测系统行为的能力。", "problem": "一块特征长度为 $L$ 的大型等温水平板，浸没在温度均匀（为 $T_{\\infty}$）且原本静止的牛顿流体中。板的温度为 $T_{s}$，且有 $|T_{s}-T_{\\infty}|=\\Delta T$。假设物性恒定，采用Boussinesq近似（BA），且边缘效应可忽略，因此可以用单一的主导长度 $L$ 来表征其平面形状。考虑两种放置方向：(i) 热表面朝上的热板，$T_{s}>T_{\\infty}$，热表面朝上；(ii) 热表面朝下的热板，$T_{s}>T_{\\infty}$，热表面朝下。将基于 $L$ 的瑞利数定义为 $Ra_{L}=g\\,\\beta\\,\\Delta T\\,L^{3}/(\\nu\\,\\alpha)$，其中 $g$ 为重力加速度，$\\beta$ 为体积热膨胀系数，$\\nu$ 为运动粘度，$\\alpha$ 为热扩散率。并将努塞尔数定义为 $Nu=h\\,L/k$，其中 $h$ 为对流换热系数， $k$ 为流体的导热系数。\n\n文献中的许多经验关联式具有 $Nu=C\\,Ra_{L}^{\\,n}$ 的形式，并且对于热表面朝上与朝下的两种情况，报导了不同的指数 $n$。请不引用任何经验关联式，仅使用BA条件下的质量、动量和能量守恒定律以及标准的尺度分析，从第一性原理出发，对每种放置方向和不同流动状态下控制热边界层和对流运动的主导平衡关系进行推理。然后，判断以下哪个选项最正确地解释了为何两种放置方向报导了不同的指数 $n$，并能将这些报导的 $n$ 值与其潜在的流动状态连贯地联系起来。你的推理应基于可识别的平衡关系（例如，浮力、粘性扩散、惯性力；传导与对流的对比），并在可能的情况下，推导出这些流动状态下 $n$ 的代表性标度指数。\n\n哪个选项与此第一性原理分析最为一致？\n\nA. 热表面朝上的热板产生不稳定的密度分层，超过临界点后，会自组织形成浮力羽流或Rayleigh–Bénard环流，其近壁热层会自调整到一个临界子层瑞利数，从而在足够大的$Ra_{L}$下，得出$Nu\\sim Ra_{L}^{\\,1/3}$。而在较低的$Ra_{L}$下，浮力、粘性和热扩散之间的层流边界层平衡得出$Nu\\sim Ra_{L}^{\\,1/4}$。热表面朝下的热板是稳定分层的，抑制了羽流或环流的形成，因此弱的层流边界层得以持续存在；同样的浮力-粘性-扩散平衡会产生一个比不稳定情况更小的有效$n$值，与报导的指数在或低于$n\\approx 1/4$（在一些数据集中通常更接近$n\\approx 1/5$）相符。\n\nB. 对于热表面朝上和朝下的情况，指数$n$必须相同，因为重力仅通过$Ra_{L}$影响该问题，所以放置方向不能改变$Nu\\sim Ra_{L}^{\\,n}$的依赖关系。\n\nC. 对于热表面朝上的热板，浮力消除了对热扩散的需求，因此$Nu$随$Ra_{L}$线性增长，且$n\\approx 1$。对于热表面朝下的热板，对流被稳定性完全抑制，因此$Nu$与$Ra_{L}$无关，且$n\\approx 0$。\n\nD. 观测到的$n$的差异仅由板的导热系数与流体导热系数之比控制；对于一个完美导热（等温）的板，两种放置方向下的$n$均约为$1/2$，因此任何报导的$n$值差异必然是由于有限的板导热系数，而不是由于放置方向或流动状态。", "solution": "在继续之前，对问题陈述进行验证。\n\n**第1步：提取已知条件**\n-   系统：一块大型等温水平板。\n-   特征长度：$L$。\n-   流体：静止、牛顿流体、温度为 $T_{\\infty}$。\n-   板温：$T_s$。\n-   温差：$\\Delta T = |T_s - T_{\\infty}|$。\n-   假设：物性恒定，Boussinesq近似（BA），边缘效应可忽略。\n-   放置方向：\n    -   (i) 热表面朝上：$T_s > T_{\\infty}$，表面朝上。\n    -   (ii) 热表面朝下：$T_s > T_{\\infty}$，表面朝下。\n-   定义：\n    -   瑞利数：$Ra_{L} = g\\,\\beta\\,\\Delta T\\,L^{3}/(\\nu\\,\\alpha)$。\n    -   努塞尔数：$Nu = h\\,L/k$。\n-   任务：从第一性原理和尺度分析出发，解释在关联式 $Nu = C\\,Ra_{L}^{n}$ 中，指数 $n$ 为何因两种放置方向而不同，并将 $n$ 的值与流动状态联系起来。\n\n**第2步：使用提取的已知条件进行验证**\n-   **科学依据：**该问题是传热学领域的一个经典课题，即自然对流。其物理设置、控制原理（Boussinesq近似下的守恒定律）以及无量纲参数（$Ra_L$，$Nu$）都是标准的且在根本上是可靠的。\n-   **适定性：**该问题要求对标度律进行物理解释和推导，这是理论流体力学中一个明确定义的任务。它不要求数值解，而是需要概念性分析，为此已提供了足够的信息。\n-   **客观性：**语言是技术性的、精确的，并且没有主观或模糊的术语。\n\n**第3步：结论与行动**\n问题陈述在科学上是合理的、适定的和客观的。它是**有效的**。将基于第一性原理推导出一个解决方案。\n\n**从第一性原理推导**\n\n水平板自然对流的物理过程由浮力与密度分层的稳定或不稳定效应之间的相互作用所决定。重力矢量 $\\mathbf{g}$ 相对于温度梯度 $\\nabla T$ 的方向至关重要。我们使用 Boussinesq 近似下的稳态守恒方程的尺度分析来分析这两种特定的放置方向。设 $\\delta_T$ 为热边界层的厚度。努塞尔数的标度关系为 $Nu_L \\sim L/\\delta_T$。我们的目标是找出 $\\delta_T$ 如何依赖于相关物理参数，这些参数都包含在 $Ra_L$ 中。\n\n**情况 (i)：热表面朝上的热板 ($T_s > T_{\\infty}$)**\n在这种配置下，热的、密度较小的流体位于冷的、密度较大的主流体下方。这种布置是**流体动力学不稳定**的。重力会放大任何微小的扰动，导致热流体上升和冷流体下沉。\n\n-   **高$Ra_L$区（湍流或胞状对流）：**\n    对于足够大的$Ra_L$，边界层变得不稳定并分解为上升的羽流和下降的流体片，或形成胞状结构。热传递由这些剧烈的对流运动主导。对于这种湍流状态的一个关键见解是，热边界层厚度 $\\delta_T$ 不再依赖于板的总长度 $L$。相反，$\\delta_T$ 会自行调整，使得基于此厚度的局部瑞利数 $Ra_{\\delta_T} = g\\,\\beta\\,\\Delta T\\,\\delta_T^{3}/(\\nu\\,\\alpha)$ 保持在一个临界常数值 $Ra_c$ 附近，在该值下，子层本身处于临界稳定状态。\n    $$Ra_{\\delta_T} \\sim \\text{constant}$$\n    $$ \\frac{g\\,\\beta\\,\\Delta T\\,\\delta_T^{3}}{\\nu\\,\\alpha} \\sim \\text{constant}$$\n    求解 $\\delta_T$:\n    $$\\delta_T \\sim \\left( \\frac{\\nu\\,\\alpha}{g\\,\\beta\\,\\Delta T} \\right)^{1/3}$$\n    然后通过代入 $\\delta_T$ 的这个标度关系来求得努塞尔数：\n    $$Nu_L \\sim \\frac{L}{\\delta_T} \\sim L \\left( \\frac{g\\,\\beta\\,\\Delta T}{\\nu\\,\\alpha} \\right)^{1/3} = \\left( \\frac{g\\,\\beta\\,\\Delta T\\,L^3}{\\nu\\,\\alpha} \\right)^{1/3}$$\n    因此，对于不稳定的高$Ra_L$区，我们恢复了标度关系：\n    $$Nu_L \\sim Ra_L^{1/3}$$\n\n-   **低$Ra_L$区（层流对流）：**\n    在强湍流对流的阈值以下，但在运动起始之上，流动是层流。分层的不稳定特性仍然促进垂直运动。在这种状态下，力的平衡通常在浮力、粘性和热扩散之间。对于垂直板，浮力在边界层内直接驱动流动以抵抗粘性拖曳力，其标度关系得出 $Nu_L \\sim Ra_L^{1/4}$。鉴于不稳定的水平板流动涉及显著的垂直流体交换，可以合理地预期其标度行为与垂直板相似。因此，对于该流动状态，指数 $n=1/4$ 是一个合理的期望。\n\n**情况 (ii)：热表面朝下的热板 ($T_s > T_{\\infty}$)**\n在这种配置下，热的、密度较小的流体位于冷的、密度较大的主流体上方。这种布置是**流体动力学稳定**的。浮力起到抑制垂直运动并使流体分层的作用。\n\n-   **流动状态：**\n    稳定的分层阻止了羽流的形成和湍流的分解。对流并未完全消失；在浮力引起的水平压力梯度的驱动下，受热的流体层从板的中心水平向外扩散至边缘。这导致在非常宽的$Ra_L$范围内存在一个弱的、持续的层流边界层。主导平衡关系存在于压力梯度、粘性力和热扩散之间。对此情况的尺度分析如下：\n    1.  垂直压力梯度与浮力平衡：$\\partial p'/\\partial y \\sim \\rho g \\beta \\Delta T$。在整个边界层上，$p' \\sim \\rho g \\beta \\Delta T \\delta_T$。\n    2.  这产生驱动流动的水平压力梯度：$\\partial p'/\\partial x \\sim p'/L \\sim \\rho g \\beta \\Delta T \\delta_T/L$。\n    3.  该压力梯度与粘性剪切力平衡：$(1/\\rho)\\partial p'/\\partial x \\sim \\nu U/\\delta_T^2$。这得出 $U \\sim g \\beta \\Delta T \\delta_T^3 / (\\nu L)$。\n    4.  能量方程平衡了水平对流与垂直扩散：$U \\Delta T/L \\sim \\alpha \\Delta T/\\delta_T^2$。这得出 $U \\sim \\alpha L/\\delta_T^2$。\n    5.  将特征速度 $U$ 的两个表达式相等：\n        $$\\frac{g \\beta \\Delta T \\delta_T^3}{\\nu L} \\sim \\frac{\\alpha L}{\\delta_T^2} \\implies \\delta_T^5 \\sim \\frac{\\nu \\alpha L^2}{g \\beta \\Delta T}$$\n    6.  用 $Ra_L$ 表示：\n        $$\\left(\\frac{\\delta_T}{L}\\right)^5 \\sim \\frac{\\nu \\alpha}{g \\beta \\Delta T L^3} = Ra_L^{-1}$$\n        $$\\frac{\\delta_T}{L} \\sim Ra_L^{-1/5}$$\n    7.  最后，努塞尔数的标度关系为：\n        $$Nu_L \\sim \\frac{L}{\\delta_T} \\sim Ra_L^{1/5}$$\n    这个指数 $n=1/5$ 小于 $n=1/4$ 和 $n=1/3$，反映了在稳定配置下热传递效率较低。\n\n**选项评估**\n\n-   **选项 A：**该选项指出，热表面朝上的板是不稳定的，导致羽流/环流和在高$Ra_L$下因亚层临界稳定性而有$Nu \\sim Ra_L^{1/3}$，以及在较低$Ra_L$下的层流区有$Nu \\sim Ra_L^{1/4}$。它还指出，热表面朝下的板是稳定的，导致存在一个持续的弱层流层，其指数较小，例如$n \\approx 1/5$。这与第一性原理的推导完全一致。其物理推理是合理的，并且预测的标度指数对于其各自的流动状态是正确的。**正确**。\n\n-   **选项 B：**该选项声称两种放置方向的指数$n$必须相同，因为重力只存在于$Ra_L$中。这在根本上是错误的。板相对于重力矢量的方向决定了密度分层的稳定性。正是浮力的方向性导致了这两种情况之间深刻的物理差异。**错误**。\n\n-   **选项 C：**该选项声称，对于热表面朝上的情况，$n \\approx 1$，因为浮力消除了对扩散的需求；对于热表面朝下的情况，$n \\approx 0$，因为对流被完全抑制。这两个论断在物理上都是没有根据的。在壁面处，热量传递给流体总是需要扩散，因此 $n=1$ 没有物理来源。在稳定情况下，对流被削弱，但并未被消除，因此当 $Ra_L > 0$ 时，$Nu$ 不是常数（$n \\neq 0$）。**错误**。\n\n-   **选项 D：**该选项错误地将$n$的差异归因于板的导热系数，并声称对于完美导热（等温）板，两种情况下的$n \\approx 1/2$。问题中已假设板是等温的，所以这不能作为解释。主要原因是流体动力学稳定性，而不是共轭传热。指数 $n=1/2$ 对于此问题是不正确的，并且关于理想板的放置方向无关紧要的说法是错误的。**错误**。\n\n基于严谨的分析，选项A为观测到的现象提供了唯一在物理上一致且全面的解释。", "answer": "$$\\boxed{A}$$", "id": "2510711"}, {"introduction": "标度律，例如前一个练习中推导出的那些，不仅仅用于理论理解，它们在实际的数值模拟中同样不可或缺。热边界层的特征长度尺度 $\\delta$ 可以通过标度分析预测，它直接决定了精确的直接数值模拟 (DNS) 所需的网格分辨率。这项高级实践 [@problem_id:2510675] 将挑战您设计一个完整的 DNS 设置，您将利用标度关系式 $\\delta \\sim L \\, Ra^{-1/5}$ 来确定计算域大小和网格间距，从而搭建起基础理论与现代计算流体动力学之间的桥梁。", "problem": "您需要设计一个程序，将具有物理意义的输入转化为一个可复现的直接数值模拟 (DNS) 设置，用于模拟等温、朝上、有限水平板上方的层流自然对流。该设计必须基于第一性原理，并从控制方程中推导出特征边界层尺度。程序必须实现最终得出的公式，并返回一个紧凑的规范，包括计算域尺寸、垂直于壁面方向上能解析边界层的网格加密方案，以及一个保守的流向分辨率。所有结果必须以国际单位制 (SI) 表示，浮点数量必须四舍五入至六位有效数字。\n\n从以下基本基础开始：\n- 在平坦水平表面上方的边界层极限下，Boussinesq 近似的不可压缩 Navier–Stokes 方程和能量方程：\n  - 连续性方程：$\\nabla \\cdot \\mathbf{u} = 0$。\n  - 动量方程：$\\rho \\left( \\mathbf{u} \\cdot \\nabla \\right)\\mathbf{u} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\rho \\mathbf{g} \\beta \\left( T - T_{\\infty} \\right)\\hat{\\mathbf{g}}$。\n  - 能量方程：$\\rho c_p \\left( \\mathbf{u} \\cdot \\nabla \\right) T = k \\nabla^2 T$。\n- 材料属性和参数：密度 $\\rho$、动力粘度 $\\mu$、热导率 $k$、定压比热容 $c_p$、热膨胀系数 $\\beta$、重力加速度大小 $g$、板的特征长度 $L$，以及温差 $\\Delta T = T_s - T_{\\infty}$。\n- 运动粘度 $\\nu = \\mu / \\rho$ 和热扩散率 $\\alpha = k / (\\rho c_p)$。\n- 瑞利数 $Ra = \\dfrac{g \\beta \\Delta T L^3}{\\nu \\alpha}$。\n\n对层流状态下朝上的等温水平板进行适当的量级边界层标度分析。从基本方程出发（不引用任何现成的对流传热关联式），论证：\n- 板上方的特征水平压力梯度源于一个尺度为 $\\rho g \\beta \\Delta T \\delta$ 的静水压力亏损，该亏损作用在长度为 $L$ 的水平距离上，其中 $\\delta$ 是板上方的特征边界层厚度。\n- 将此流向压力梯度与水平动量的粘性扩散相平衡，并对边界层中的温度采用对流-扩散平衡，可以得到一个关于 $\\delta$、$L$ 和通过瑞利数表示的材料-重力参数之间的预测性代数关系。\n- 使用您推导出的精确代数关系，从输入计算 $\\delta$。\n\n使用以下要求设计 DNS 设置：\n1) 计算域尺寸：\n- 法向范围 $H$ 等于 $c_H \\, \\delta$，其中 $c_H = 12$。\n- 流向计算域范围 $L_{\\text{dom}}$ 等于 $L + c_{\\text{side}} \\, \\delta$，其中 $c_{\\text{side}} = 10$。\n\n2) 边界条件（在您的设计中概念性使用，但不打印）：\n- 底部边界 ($y = 0$)：无滑移速度和等温 $T = T_s$。\n- 顶部边界 ($y = H$)：无应力速度，法向梯度为零，以及固定的环境温度 $T = T_{\\infty}$。\n- 侧向边界 ($x = 0$ 和 $x = L_{\\text{dom}}$)：对称（零法向速度和零法向梯度），以在二维近似中最小化限制效应。\n\n3) 板附近的网格加密：\n- 法向网格间距形成一个几何级数 $\\Delta y_i = \\Delta y_1 \\, r^{\\, i - 1}$，其中 $i = 1, 2, \\ldots, N_y$，$N_{\\text{bl}} = 48$ 时 $\\Delta y_1 = \\delta / N_{\\text{bl}}$ 是跨越边界层的目标分辨率。\n- 公比 $r$ 必须满足 $1 \\le r \\le r_{\\max}$，其中 $r_{\\max} = 1.08$。\n- 确定最小的整数 $N_y \\ge N_{\\text{bl}}$，使得存在一个 $r \\in [1, r_{\\max}]$ 满足\n$$\n\\sum_{i=1}^{N_y} \\Delta y_i \\;=\\; \\Delta y_1 \\, \\frac{r^{N_y} - 1}{r - 1} \\;=\\; H,\n$$\n且相对公差不超过 $10^{-6}$。如果 $r = 1$，则将左侧的和式解释为其极限形式 $N_y \\Delta y_1$。对于给定的 $N_y$，如果在 $r_{\\max}$ 处的和超过 $H$，则在 $[1, r_{\\max}]$ 上使用二分法求解 $r$；否则增加 $N_y$ 并重试。对于下文测试套件中的输入，此搜索必须在 $N_y$ 不超过 4096 的情况下成功。\n\n4) 流向网格分辨率：\n- 选择一个保守的目标间距 $\\Delta x_{\\text{tgt}} = \\min \\left( \\delta / 4, \\, L_{\\text{dom}} / 200 \\right)$，并将流向单元数设为 $N_x = \\lceil L_{\\text{dom}} / \\Delta x_{\\text{tgt}} \\rceil$。\n\n测试套件：\n为以下三个测试案例实现您的程序。每个案例由元组 $(L, \\Delta T, \\rho, \\mu, k, c_p, \\beta, g)$ 定义。\n- 案例 A（空气，中等 $\\Delta T$）：$(0.2, 10, 1.177, 1.85\\times 10^{-5}, 0.026, 1007, 1/300, 9.81)$。\n- 案例 B（接近 $40\\,^{\\circ}\\mathrm{C}$ 的水，较高普朗特数）：$(0.1, 5, 992.0, 6.53\\times 10^{-4}, 0.628, 4179.0, 3.5\\times 10^{-4}, 9.81)$。\n- 案例 C（空气，低 $\\Delta T$ 和较大板）：$(0.3, 1, 1.177, 1.85\\times 10^{-5}, 0.026, 1007, 1/300, 9.81)$。\n\n对于每个案例，您的程序必须按此确切顺序计算并返回一个列表：\n- $Ra$ (无量纲),\n- $\\delta$ (米),\n- $H$ (米),\n- $L_{\\text{dom}}$ (米),\n- $N_x$ (整数),\n- $N_y$ (整数),\n- $\\Delta y_1$ (米),\n- $r$ (无量纲)。\n\n最终输出格式：\n- 您的程序必须打印单行，其中包含一个逗号分隔的三个案例结果列表，每个结果都是一个用方括号括起来的、按上述顺序排列的逗号分隔列表。例如：$[ [\\ldots \\text{案例 A} \\ldots], [\\ldots \\text{案例 B} \\ldots], [\\ldots \\text{案例 C} \\ldots] ]$。\n- 所有浮点输出必须四舍五入至六位有效数字。所有长度单位必须是米，其他量使用上述隐含的自然单位。", "solution": "如问题所述，需要从第一性原理出发，为加热水平板上方的自然对流推导一个直接数值模拟 (DNS) 的计算设置。这要求在进行求解之前对问题陈述进行严格的验证。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n\n- **控制方程**：边界层极限下的 Boussinesq 近似不可压缩 Navier–Stokes 方程和能量方程：\n  - 连续性方程：$\\nabla \\cdot \\mathbf{u} = 0$。\n  - 动量方程：$\\rho \\left( \\mathbf{u} \\cdot \\nabla \\right)\\mathbf{u} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\rho \\mathbf{g} \\beta \\left( T - T_{\\infty} \\right)\\hat{\\mathbf{g}}$。\n  - 能量方程：$\\rho c_p \\left( \\mathbf{u} \\cdot \\nabla \\right) T = k \\nabla^2 T$。\n- **材料属性和参数**：密度 $\\rho$、动力粘度 $\\mu$、热导率 $k$、比热容 $c_p$、热膨胀系数 $\\beta$、重力加速度 $g$、板长 $L$ 和温差 $\\Delta T = T_s - T_{\\infty}$。\n- **导出属性**：运动粘度 $\\nu = \\mu / \\rho$，热扩散率 $\\alpha = k / (\\rho c_p)$。\n- **无量纲群**：瑞利数 $Ra = \\dfrac{g \\beta \\Delta T L^3}{\\nu \\alpha}$。\n- **标度分析任务**：进行量级分析，推导出边界层厚度 $\\delta$ 作为 $L$ 和 $Ra$ 的函数的一个代数关系。该推导必须平衡由浮力引起的水平压力梯度与粘性力，并结合能量方程中的对流-扩散平衡。\n- **DNS 设置要求**：\n  1. **计算域尺寸**：法向范围 $H = c_H \\, \\delta$，其中 $c_H = 12$。流向范围 $L_{\\text{dom}} = L + c_{\\text{side}} \\, \\delta$，其中 $c_{\\text{side}} = 10$。\n  2. **网格加密**：法向网格间距形成一个几何级数：$\\Delta y_i = \\Delta y_1 \\, r^{\\, i - 1}$。第一个单元高度 $\\Delta y_1 = \\delta / N_{\\text{bl}}$，其中 $N_{\\text{bl}} = 48$。找到最小的整数 $N_y \\ge N_{\\text{bl}}$ 和一个公比 $r \\in [1, r_{\\max}]$（其中 $r_{\\max} = 1.08$），使得 $\\sum_{i=1}^{N_y} \\Delta y_i = H$ 的相对公差为 $10^{-6}$。\n  3. **流向分辨率**：目标间距为 $\\Delta x_{\\text{tgt}} = \\min \\left( \\delta / 4, \\, L_{\\text{dom}} / 200 \\right)$。单元数为 $N_x = \\lceil L_{\\text{dom}} / \\Delta x_{\\text{tgt}} \\rceil$。\n- **测试案例**：提供了三组针对空气和水的物理参数。\n- **输出格式**：一个特定的嵌套列表结构，所有浮点值四舍五入至六位有效数字。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n- **科学依据**：该问题基于流体动力学和传热学的基本方程。对于由浮力驱动且温差较小的流动，Boussinesq 近似是一种标准的、科学上有效的简化方法。要求进行量级标度分析是物理学和工程学中一种经典的教学和研究技术。该过程在物理上和数学上都是合理的。\n- **适定性**：该问题是适定的。标度律的推导是基于既定原理的分析任务。随后的 DNS 设置的计算设计是一个具有精确定义的输入、步骤和确定性输出的算法。为 $N_y$ 和 $r$ 指定的搜索算法保证了唯一解的存在且可以被找到。\n- **客观性**：问题的所有方面都以客观、量化的标准指定。没有模糊性、主观性或依赖于观点。\n\n**第 3 步：结论与行动**\n\n该问题具有科学依据，是适定的、客观的且自洽的。这是一个有效的科学问题。我现在将提供解决方案。\n\n### 求解推导与算法设计\n\n求解过程按要求分两个阶段进行。首先，对控制方程进行标度分析以推导特征边界层厚度 $\\delta$。其次，利用此结果为生成 DNS 参数开发一个具体的计算算法。\n\n**1. 边界层标度分析**\n\n我们考虑一个长度为 $L$ 的有限水平板，被加热到温度 $T_s$，置于温度为 $T_\\infty$ 的环境流体中。板上方的流体被加热，密度变小，随之产生浮力驱动流。对于有限板，板上方轻的热流体柱与侧面重的冷流体之间的压力差驱动水平向内的流动。然后，此流动转而以羽流形式上升。我们分析当流体水平流过板面时形成的边界层。\n\n设 $x$ 为水平（流向）坐标，$y$ 为垂直（法向）坐标。设 $U$ 和 $V$ 分别为这些方向上的特征速度。边界层厚度为 $\\delta$，并在长度 $L$ 上发展。\n\n问题假设水平运动由水平压力梯度 $\\partial p/\\partial x$ 驱动。该梯度 arises 因为高度约为 $\\delta$ 的热流体柱下的静水压力低于周围冷流体中的静水压力。在水平长度 $L$ 上的压力差 $\\Delta P_x$ 与浮力压头的量级相当：\n$$\n\\Delta P_x \\sim (\\rho_\\infty - \\rho) g \\delta\n$$\n使用 Boussinesq 近似 $\\rho_\\infty - \\rho \\approx \\rho_\\infty \\beta (T - T_\\infty)$，并取特征温差 $\\Delta T = T_s - T_\\infty$，我们得到：\n$$\n\\Delta P_x \\sim \\rho g \\beta \\Delta T \\delta\n$$\n因此，动量方程中的水平压力梯度项可标度为：\n$$\n\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x} \\sim \\frac{\\Delta P_x}{\\rho L} \\sim \\frac{g \\beta \\Delta T \\delta}{L}\n$$\n问题要求将此压力梯度与水平动量的粘性扩散相平衡。在 $\\delta \\ll L$ 的薄边界层中，主导的粘性项是由法向的剪切引起的：\n$$\n\\nu \\nabla^2 u \\sim \\nu \\frac{\\partial^2 u}{\\partial y^2} \\sim \\nu \\frac{U}{\\delta^2}\n$$\n平衡压力项和粘性项得到第一个关系：\n$$\n\\frac{g \\beta \\Delta T \\delta}{L} \\sim \\nu \\frac{U}{\\delta^2} \\quad \\implies \\quad U \\sim \\frac{g \\beta \\Delta T \\delta^3}{\\nu L}\n$$\n接下来，我们对能量方程进行标度分析。在边界层中，由对流带入的热量与扩散相平衡。主导的对流项是 $u \\partial T/\\partial x$（或在连续性约束下尺度相同的 $v \\partial T/\\partial y$），主导的扩散项是 $\\alpha \\partial^2 T/\\partial y^2$：\n$$\nu\\frac{\\partial T}{\\partial x} \\sim U \\frac{\\Delta T}{L} \\quad \\text{和} \\quad \\alpha \\frac{\\partial^2 T}{\\partial y^2} \\sim \\alpha \\frac{\\Delta T}{\\delta^2}\n$$\n平衡这些项得到 $U$ 的第二个关系：\n$$\nU \\frac{\\Delta T}{L} \\sim \\alpha \\frac{\\Delta T}{\\delta^2} \\quad \\implies \\quad U \\sim \\frac{\\alpha L}{\\delta^2}\n$$\n令特征速度 $U$ 的两个表达式相等，得到 $\\delta$ 的关系：\n$$\n\\frac{g \\beta \\Delta T \\delta^3}{\\nu L} \\sim \\frac{\\alpha L}{\\delta^2}\n$$\n求解 $\\delta^5$：\n$$\n\\delta^5 \\sim \\frac{\\nu \\alpha L^2}{g \\beta \\Delta T} = L^5 \\left( \\frac{g \\beta \\Delta T L^3}{\\nu \\alpha} \\right)^{-1} = L^5 Ra^{-1}\n$$\n这为边界层厚度提供了所需的预测性代数关系。我们取标度常数为 1：\n$$\n\\delta = L \\, Ra^{-1/5}\n$$\n\n**2. DNS 设置算法**\n\n对于每个给定的测试案例，我们执行以下计算流程。\n\n- **第 1 步：计算物理属性和 $Ra$**。给定元组 $(L, \\Delta T, \\rho, \\mu, k, c_p, \\beta, g)$，首先计算导出属性 $\\nu = \\mu / \\rho$ 和 $\\alpha = k / (\\rho c_p)$。然后，计算瑞利数 $Ra = (g \\beta \\Delta T L^3) / (\\nu \\alpha)$。\n\n- **第 2 步：计算特征尺度**。使用上面推导的标度律，计算边界层厚度 $\\delta = L \\, Ra^{-1/5}$。然后，计算计算域范围 $H = 12 \\delta$ 和 $L_{\\text{dom}} = L + 10 \\delta$。\n\n- **第 3 步：计算法向网格参数 $(N_y, \\Delta y_1, r)$**。\n  - 第一个单元的高度由边界层分辨率要求固定：$\\Delta y_1 = \\delta / 48$。\n  - 总高度 $H$ 必须由 $N_y$ 个单元跨越，其高度形成一个几何级数：$H = \\sum_{i=1}^{N_y} \\Delta y_1 r^{i-1}$。几何级数的和为 $S_{N_y}(r) = \\Delta y_1 (r^{N_y} - 1) / (r - 1)$（对于 $r \\neq 1$）和 $S_{N_y}(1) = N_y \\Delta y_1$。\n  - 该问题定义的一个有趣结果是，比率 $H / \\Delta y_1$ 是一个常数：$H / \\Delta y_1 = (12\\delta) / (\\delta/48) = 12 \\times 48 = 576$。\n  - 因此，对 $N_y$ 和 $r$ 的搜索与测试案例的输入无关。我们必须找到最小的整数 $N_y \\ge 48$，使得方程 $(r^{N_y} - 1)/(r - 1) = 576$ 在 $r \\in [1, 1.08]$ 中有解。\n  - 如果目标值 576 介于区间 $[1, 1.08]$ 上和函数的最小值和最大值之间，则存在 $r$ 的解。该函数是单调的。我们需要找到满足以下条件的最小 $N_y \\ge 48$：$N_y \\le 576 \\le (1.08^{N_y} - 1)/(1.08 - 1)$。\n  - 第一个不等式 $N_y \\le 576$ 对于合理的 $N_y$ 总是成立。第二个不等式是决定性因素：$(1.08^{N_y} - 1)/0.08 \\ge 576$，化简为 $1.08^{N_y} \\ge 47.08$，或 $N_y \\ge \\log_{1.08}(47.08) \\approx 50.048$。\n  - 因此，最小的整数 $N_y$ 为 51。\n  - 在 $N_y=51$ 的情况下，我们使用二分法在区间 $[1, 1.08]$ 上求解 $(r^{51} - 1)/(r - 1) = 576$ 中 $r$ 的值，直到和 $S_{51}(r)$ 与 $H$ 的相对公差达到 $10^{-6}$。\n\n- **第 4 步：计算流向网格参数 $(N_x)$**。\n  - 目标流向单元尺寸为 $\\Delta x_{\\text{tgt}} = \\min(\\delta / 4, L_{\\text{dom}} / 200)$。这个选择取决于 $L < 40\\delta$ 是否成立。\n  - 如果 $L < 40\\delta$，则 $\\delta/4 > (L+10\\delta)/200 = L_{dom}/200$。因此，$\\Delta x_{\\text{tgt}} = L_{\\text{dom}} / 200$，且 $N_x = \\lceil L_{\\text{dom}} / (L_{\\text{dom}} / 200) \\rceil = 200$。\n  - 如果 $L \\ge 40\\delta$，则 $\\Delta x_{\\text{tgt}} = \\delta / 4$。因此，$N_x = \\lceil L_{\\text{dom}} / (\\delta / 4) \\rceil = \\lceil (L+10\\delta)/(\\delta/4) \\rceil = \\lceil 4L/\\delta + 40 \\rceil$。\n  - 流向单元数 $N_x$ 相应地计算。\n\n- **第 5 步：格式化输出**。所有计算出的浮点值 ($Ra, \\delta, H, L_{\\text{dom}}, \\Delta y_1, r$) 均四舍五入至六位有效数字。整数值 ($N_x, N_y$) 按原样输出。结果按指定的列表格式组装。\n\n这个结构化的流程保证了从给定参数生成可复现且具有物理动机的 DNS 设置。", "answer": "```python\nimport numpy as np\n\ndef _round_to_sf(value, sig_figs):\n    \"\"\"\n    Rounds a floating-point number to a specified number of significant figures\n    and returns it as a float.\n    \"\"\"\n    if value == 0:\n        return 0.0\n    return float(f'{value:.{sig_figs-1}e}')\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It calculates DNS setup parameters based on a scaling analysis\n    of natural convection from a horizontal plate.\n    \"\"\"\n    # Test cases: (L, delta_T, rho, mu, k, c_p, beta, g)\n    test_cases = [\n        # Case A (air, moderate dT)\n        (0.2, 10, 1.177, 1.85e-5, 0.026, 1007, 1/300, 9.81),\n        # Case B (water near 40C)\n        (0.1, 5, 992.0, 6.53e-4, 0.628, 4179.0, 3.5e-4, 9.81),\n        # Case C (air, low dT, larger plate)\n        (0.3, 1, 1.177, 1.85e-5, 0.026, 1007, 1/300, 9.81),\n    ]\n\n    # DNS setup constants\n    C_H = 12.0\n    C_SIDE = 10.0\n    N_BL = 48\n    R_MAX = 1.08\n    REL_TOL = 1e-6\n    MAX_NY_SEARCH = 4096\n\n    all_results = []\n\n    for case in test_cases:\n        L, delta_T, rho, mu, k, c_p, beta, g = case\n\n        # Step 1: Compute Physical Properties and Ra\n        nu = mu / rho\n        alpha = k / (rho * c_p)\n        Ra = (g * beta * delta_T * L**3) / (nu * alpha)\n\n        # Step 2: Compute Characteristic Scales\n        delta = L * Ra**(-1/5)\n        H = C_H * delta\n        L_dom = L + C_SIDE * delta\n\n        # Step 3: Compute Wall-Normal Grid Parameters (Ny, dy1, r)\n        dy1 = delta / N_BL\n        \n        # As derived, H/dy1 is a constant 576.\n        # Find the minimum Ny >= N_BL\n        Ny = N_BL\n        target_sum_ratio = H / dy1 # This is always 576.0\n        \n        while Ny <= MAX_NY_SEARCH:\n            # Check if a solution for r exists in [1, R_MAX]\n            # Max sum ratio is (R_MAX**Ny - 1) / (R_MAX - 1)\n            # Min sum ratio is Ny\n            if Ny == 1.0:\n                max_sum_ratio = Ny\n            else:\n                max_sum_ratio = (R_MAX**Ny - 1) / (R_MAX - 1)\n\n            if target_sum_ratio <= max_sum_ratio:\n                break\n            Ny += 1\n        \n        # Solve for r using bisection\n        low_r, high_r = 1.0, R_MAX\n        r = 1.0\n        \n        # The sum function can be defined based on the target ratio\n        def sum_ratio(r_val, n_val):\n            if r_val == 1.0:\n                return float(n_val)\n            return (r_val**n_val - 1) / (r_val - 1)\n\n        # Bisection loop to find r that satisfies the geometric sum\n        for _ in range(100): # Sufficient iterations for high precision\n            mid_r = (low_r + high_r) / 2\n            current_sum_ratio = sum_ratio(mid_r, Ny)\n            \n            if current_sum_ratio < target_sum_ratio:\n                low_r = mid_r\n            else:\n                high_r = mid_r\n        \n        r = (low_r + high_r) / 2\n        \n        # Final check on tolerance, although bisection guarantees it.\n        # final_sum = dy1 * sum_ratio(r, Ny)\n        # assert abs(final_sum - H) / H <= REL_TOL, \"Bisection failed to converge\"\n        \n        # Step 4: Compute Streamwise Grid Parameter (Nx)\n        # Condition is equivalent to L < 40*delta\n        if L < 40 * delta:\n            dx_tgt = L_dom / 200.0\n        else:\n            dx_tgt = delta / 4.0\n            \n        Nx = int(np.ceil(L_dom / dx_tgt))\n\n        # Step 5: Format Output with 6 significant figures\n        case_results = [\n            _round_to_sf(Ra, 6),\n            _round_to_sf(delta, 6),\n            _round_to_sf(H, 6),\n            _round_to_sf(L_dom, 6),\n            Nx,\n            Ny,\n            _round_to_sf(dy1, 6),\n            _round_to_sf(r, 6),\n        ]\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format\n    # Convert all numbers to strings for the final join\n    output_str = '[' + ','.join([\n        '[' + ','.join(map(str, res)) + ']' for res in all_results\n    ]) + ']'\n    print(output_str)\n\nsolve()\n```", "id": "2510675"}]}