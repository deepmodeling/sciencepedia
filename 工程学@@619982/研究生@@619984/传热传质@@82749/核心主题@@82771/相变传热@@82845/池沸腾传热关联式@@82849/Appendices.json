{"hands_on_practices": [{"introduction": "在深入研究复杂的池沸腾关联式之前，理解其背后的基本物理机制至关重要。本练习将引导您从第一性原理出发，通过结合热力学（克劳修斯-克拉佩龙方程）、流体静力学（拉普拉斯压力）和传热学（导热边界层）的基本概念，推导出核态沸腾起始 (ONB) 的壁面过热度。通过这个推导过程[@problem_id:2475176]，您不仅能提升分析问题的能力，还能深刻理解为何需要过热液体才能引发沸腾，为后续学习更复杂的模型奠定坚实的物理基础。", "problem": "一块带有工程微腔的水平、抛光金属板浸入在一个处于环境压力下的大型纯流体静止池中。在沸腾开始前，近壁液体被温度为 $T_{w}$ 的平板加热，而主体液体保持在温度 $T_{\\infty} = T_{\\mathrm{sat}} - \\Delta T_{\\mathrm{sub}}$ 的过冷状态，其中 $T_{\\mathrm{sat}}$ 是系统压力下的饱和温度，$\\Delta T_{\\mathrm{sub}} > 0$ 是主体液体的过冷度。假设，在核态沸腾起始（ONB）之前，邻近壁面的液体中的传热以热传导为主，因此穿过厚度为 $\\delta_{T}$ 的热边界层的温度分布是从壁面（$y=0$）处的 $T_{w}$ 到 $y=\\delta_{T}$ 处的 $T_{\\infty}$ 呈线性关系。\n\n考虑一系列腔口半径为 $r$ 的表面腔，这些腔可以容纳汽胚。使用以下基于经典毛细作用和相平衡热力学的理想化假设：\n- 跨越弯曲汽液界面的拉普拉斯压力跳跃为 $\\Delta p = 2\\sigma/R$，其中 $\\sigma$ 是液汽表面张力，$R$ 是胚胎界面的局部曲率半径。\n- 对于小的过热度，饱和压力-温度关系可以通过克劳修斯-克拉佩龙关系 $dp_{\\mathrm{sat}}/dT \\approx \\rho_{v} h_{fg}/T_{\\mathrm{sat}}$ 进行线性化，其中 $\\rho_{v}$ 是蒸汽密度，$h_{fg}$ 是汽化潜热。\n- 只有当腔的腔口半径 $r$ 超过由壁面温度下的拉普拉斯-克拉佩龙平衡所决定的临界曲率半径 $R_{c}$ 时，该腔才能维持一个稳定的汽胚，并且该汽胚必须位于边界层中液体温度至少为 $T_{\\mathrm{sat}}$ 的部分之内。设 $y^{\\ast}$ 表示在 ONB 前的温度分布中，液体温度等于 $T_{\\mathrm{sat}}$ 时离壁面的距离，并用 $r_{\\max} = C_{\\mathrm{H}}\\, y^{\\ast}$ 来近似可被激活的最大腔体，其中常数几何因子 $0  C_{\\mathrm{H}} \\le 1$ 考虑了界面形状和接触角效应。取最小可激活腔为 $r_{\\min} = R_{c}$。\n\n此处，核态沸腾起始（ONB）被定义为至少有一个腔可以被激活的条件，即当 $r_{\\min} \\le r_{\\max}$ 时。仅使用上述假设，推导 ONB 时的壁面过热度 $\\Delta T_{\\mathrm{ONB}} \\equiv T_{w}-T_{\\mathrm{sat}}$ 的一个显式闭式表达式，该表达式是关于过冷度 $\\Delta T_{\\mathrm{sub}}$、边界层厚度 $\\delta_{T}$、几何因子 $C_{\\mathrm{H}}$ 以及流体性质 $\\sigma$、$T_{\\mathrm{sat}}$、$\\rho_{v}$ 和 $h_{fg}$ 的函数。将你的最终答案表示为一个以开尔文为单位的单一解析表达式。不需要进行数值计算，也无需四舍五入。\n\n你的推导必须从所述的物理原理和定义（线性的 ONB 前温度分布、拉普拉斯压力和线性化的克劳修斯-克拉佩龙关系）开始，并应通过分析所得表达式来论证随着 $\\Delta T_{\\mathrm{sub}}$ 的增加，$\\Delta T_{\\mathrm{ONB}}$ 变化的趋势和幅度。最终答案必须是 $\\Delta T_{\\mathrm{ONB}}(\\Delta T_{\\mathrm{sub}})$ 的一个单一、闭式的解析表达式，用给定的参数和常数表示，并以开尔文为单位。不要在最终的方框表达式中包含单位。", "solution": "本题要求推导核态沸腾起始所需的壁面过热度 $\\Delta T_{\\mathrm{ONB}}$ 的一个闭式表达式，该表达式是指定的系统参数和流体性质的函数。推导必须基于所提供的基本原理和理想化假设。\n\n首先，我们建立沸腾前邻近加热板的液体中的温度分布。题目指出，穿过厚度为 $\\delta_{T}$ 的热边界层的温度分布是线性的。在壁面 $y=0$ 处，温度为 $T(0) = T_{w}$。在边界层边缘 $y=\\delta_{T}$ 处，温度为主体液体温度 $T(\\delta_{T}) = T_{\\infty} = T_{\\mathrm{sat}} - \\Delta T_{\\mathrm{sub}}$。因此，线性温度分布由下式给出：\n$$T(y) = T_{w} - \\left( \\frac{T_{w} - T_{\\infty}}{\\delta_{T}} \\right) y$$\n我们定义壁面过热度为 $\\Delta T_{w} \\equiv T_{w} - T_{\\mathrm{sat}}$。穿过边界层的总温降为 $T_{w} - T_{\\infty} = (T_{w} - T_{\\mathrm{sat}}) + (T_{\\mathrm{sat}} - T_{\\infty}) = \\Delta T_{w} + \\Delta T_{\\mathrm{sub}}$。将此代入温度分布方程，得到：\n$$T(y) = T_{w} - \\left( \\frac{\\Delta T_{w} + \\Delta T_{\\mathrm{sub}}}{\\delta_{T}} \\right) y$$\n汽胚只能在边界层中液体处于过热状态的部分维持，即 $T(y) \\ge T_{\\mathrm{sat}}$ 的区域。设 $y^{\\ast}$ 为离壁面的距离，在该处温度恰好为 $T_{\\mathrm{sat}}$。\n$$T(y^{\\ast}) = T_{\\mathrm{sat}} = T_{w} - \\left( \\frac{\\Delta T_{w} + \\Delta T_{\\mathrm{sub}}}{\\delta_{T}} \\right) y^{\\ast}$$\n整理以求解 $y^{\\ast}$：\n$$T_{w} - T_{\\mathrm{sat}} = \\Delta T_{w} = \\left( \\frac{\\Delta T_{w} + \\Delta T_{\\mathrm{sub}}}{\\delta_{T}} \\right) y^{\\ast}$$\n$$y^{\\ast} = \\delta_{T} \\frac{\\Delta T_{w}}{\\Delta T_{w} + \\Delta T_{\\mathrm{sub}}}$$\n题目假设，最大可激活腔的半径 $r_{\\max}$ 通过一个几何因子 $C_{\\mathrm{H}}$（其中 $0  C_{\\mathrm{H}} \\le 1$）与 $y^{\\ast}$ 相关。因此，\n$$r_{\\max} = C_{\\mathrm{H}} y^{\\ast} = C_{\\mathrm{H}} \\delta_{T} \\frac{\\Delta T_{w}}{\\Delta T_{w} + \\Delta T_{\\mathrm{sub}}}$$\n该表达式将最大可激活腔尺寸与热力学条件（$\\Delta T_{w}$、$\\Delta T_{\\mathrm{sub}}$、$\\delta_{T}$）联系起来。\n\n接下来，我们建立最小可激活腔 $r_{\\min}$ 的条件。这由汽胚的机械稳定性决定。题目指出 $r_{\\min} = R_{c}$，其中 $R_{c}$ 是临界曲率半径。一个稳定的胚胎要求其内部的蒸汽压力 $p_{v}$ 足够高，以平衡周围的液体压力 $p_{l}$ 和表面张力。压力差由拉普拉斯方程给出，$\\Delta p = p_{v} - p_{l} = 2\\sigma/R_{c}$。\n胚胎内部的蒸汽压力是对应于壁面温度的饱和压力，即 $p_{v} = p_{\\mathrm{sat}}(T_{w})$。液体压力是系统压力，它对应于主体流体的饱和温度，即 $p_{l} = p_{\\mathrm{sat}}(T_{\\mathrm{sat}})$。因此，压力差为 $\\Delta p = p_{\\mathrm{sat}}(T_{w}) - p_{\\mathrm{sat}}(T_{\\mathrm{sat}})$。\n使用所提供的线性化克劳修斯-克拉佩龙关系 $dp_{\\mathrm{sat}}/dT \\approx \\rho_{v} h_{fg}/T_{\\mathrm{sat}}$，我们可以对一个小的壁面过热度 $\\Delta T_{w}$ 近似这个压力差：\n$$\\Delta p \\approx \\left( \\frac{dp_{\\mathrm{sat}}}{dT} \\right)_{T_{\\mathrm{sat}}} \\Delta T_{w} = \\frac{\\rho_{v} h_{fg}}{T_{\\mathrm{sat}}} \\Delta T_{w}$$\n令两个 $\\Delta p$ 的表达式相等：\n$$\\frac{2\\sigma}{R_{c}} = \\frac{\\rho_{v} h_{fg}}{T_{\\mathrm{sat}}} \\Delta T_{w}$$\n求解临界半径 $R_{c}$：\n$$R_{c} = \\frac{2\\sigma T_{\\mathrm{sat}}}{\\rho_{v} h_{fg} \\Delta T_{w}}$$\n由于 $r_{\\min} = R_{c}$，我们得到：\n$$r_{\\min} = \\frac{2\\sigma T_{\\mathrm{sat}}}{\\rho_{v} h_{fg} \\Delta T_{w}}$$\n\n核态沸腾起始（ONB）被定义为至少有一个腔可以被激活的条件，这发生在最小可激活腔与最大可激活腔尺寸相等的阈值处，即 $r_{\\min} = r_{\\max}$。在此起始条件下，壁面过热度 $\\Delta T_{w}$ 成为 ONB 时的过热度 $\\Delta T_{\\mathrm{ONB}}$。\n令 $r_{\\min}$ 和 $r_{\\max}$ 的表达式相等：\n$$\\frac{2\\sigma T_{\\mathrm{sat}}}{\\rho_{v} h_{fg} \\Delta T_{\\mathrm{ONB}}} = C_{\\mathrm{H}} \\delta_{T} \\frac{\\Delta T_{\\mathrm{ONB}}}{\\Delta T_{\\mathrm{ONB}} + \\Delta T_{\\mathrm{sub}}}$$\n必须求解该方程以得到 $\\Delta T_{\\mathrm{ONB}}$。重新整理各项，我们得到一个关于 $\\Delta T_{\\mathrm{ONB}}$ 的二次方程：\n$$(C_{\\mathrm{H}} \\delta_{T}) (\\Delta T_{\\mathrm{ONB}})^2 - \\left(\\frac{2\\sigma T_{\\mathrm{sat}}}{\\rho_{v} h_{fg}}\\right) \\Delta T_{\\mathrm{ONB}} - \\left(\\frac{2\\sigma T_{\\mathrm{sat}}}{\\rho_{v} h_{fg}}\\right) \\Delta T_{\\mathrm{sub}} = 0$$\n这是一个形如 $ax^2 + bx + c = 0$ 的二次方程，其中 $x = \\Delta T_{\\mathrm{ONB}}$，系数为：\n$a = C_{\\mathrm{H}} \\delta_{T}$\n$b = -\\frac{2\\sigma T_{\\mathrm{sat}}}{\\rho_{v} h_{fg}}$\n$c = -\\frac{2\\sigma T_{\\mathrm{sat}}}{\\rho_{v} h_{fg}} \\Delta T_{\\mathrm{sub}}$\n\n解由二次公式给出，$x = (-b \\pm \\sqrt{b^2 - 4ac})/(2a)$。由于壁面过热度 $\\Delta T_{\\mathrm{ONB}}$ 必须为正值才能发生沸腾，且已知 $a>0$、$b0$ 和 $c \\le 0$，平方根下的项 $\\sqrt{b^2 - 4ac}$ 是实数且大于或等于 $|b|$。因此，我们必须选择正号以确保得到一个物理上有意义的 $\\Delta T_{\\mathrm{ONB}}$ 正解。\n$$\\Delta T_{\\mathrm{ONB}} = \\frac{-b + \\sqrt{b^2 - 4ac}}{2a}$$\n代入系数：\n$$\\Delta T_{\\mathrm{ONB}} = \\frac{\\frac{2\\sigma T_{\\mathrm{sat}}}{\\rho_{v} h_{fg}} + \\sqrt{\\left(-\\frac{2\\sigma T_{\\mathrm{sat}}}{\\rho_{v} h_{fg}}\\right)^2 - 4(C_{\\mathrm{H}} \\delta_{T})\\left(-\\frac{2\\sigma T_{\\mathrm{sat}}}{\\rho_{v} h_{fg}} \\Delta T_{\\mathrm{sub}}\\right)}}{2 C_{\\mathrm{H}} \\delta_{T}}$$\n简化平方根下的表达式：\n$$\\Delta T_{\\mathrm{ONB}} = \\frac{\\frac{2\\sigma T_{\\mathrm{sat}}}{\\rho_{v} h_{fg}} + \\sqrt{\\left(\\frac{2\\sigma T_{\\mathrm{sat}}}{\\rho_{v} h_{fg}}\\right)^2 + \\frac{8C_{\\mathrm{H}} \\delta_{T} \\sigma T_{\\mathrm{sat}} \\Delta T_{\\mathrm{sub}}}{\\rho_{v} h_{fg}}}}{2 C_{\\mathrm{H}} \\delta_{T}}$$\n从平方根中提出因子 $(2\\sigma T_{\\mathrm{sat}} / (\\rho_{v} h_{fg}))^2$：\n$$\\Delta T_{\\mathrm{ONB}} = \\frac{\\frac{2\\sigma T_{\\mathrm{sat}}}{\\rho_{v} h_{fg}} \\left( 1 + \\sqrt{1 + \\frac{8C_{\\mathrm{H}} \\delta_{T} \\sigma T_{\\mathrm{sat}} \\Delta T_{\\mathrm{sub}}}{\\rho_{v} h_{fg}} \\left(\\frac{\\rho_{v} h_{fg}}{2\\sigma T_{\\mathrm{sat}}}\\right)^2} \\right)}{2 C_{\\mathrm{H}} \\delta_{T}}$$\n$$\\Delta T_{\\mathrm{ONB}} = \\frac{\\sigma T_{\\mathrm{sat}}}{C_{\\mathrm{H}} \\delta_{T} \\rho_{v} h_{fg}} \\left( 1 + \\sqrt{1 + \\frac{2 C_{\\mathrm{H}} \\delta_{T} \\rho_{v} h_{fg} \\Delta T_{\\mathrm{sub}}}{\\sigma T_{\\mathrm{sat}}}} \\right)$$\n这就是所要求的 $\\Delta T_{\\mathrm{ONB}}$ 的显式闭式表达式。\n\n最后，我们分析过冷度 $\\Delta T_{\\mathrm{sub}}$ 对 $\\Delta T_{\\mathrm{ONB}}$ 的影响。表达式中的所有参数（$\\sigma$、$T_{\\mathrm{sat}}$、$C_{\\mathrm{H}}$、$\\delta_{T}$、$\\rho_{v}$、$h_{fg}$）都是正常数。平方根内的项形式为 $1 + K \\Delta T_{\\mathrm{sub}}$，其中 $K = 2 C_{\\mathrm{H}} \\delta_{T} \\rho_{v} h_{fg} / (\\sigma T_{\\mathrm{sat}})$ 是一个正常数。随着过冷度 $\\Delta T_{\\mathrm{sub}} > 0$ 的增加，平方根的自变量也增加。由于平方根函数对其正自变量是单调递增的，所以 $\\Delta T_{\\mathrm{ONB}}$ 的整个表达式也随之增加。因此，更高的过冷度需要更高的壁面过热度来引发沸腾。这在物理上是一致的：较冷的主体液体通过减小壁面附近过热液体层的厚度来抑制沸腾，这需要更高的壁面温度来满足成核准则。对于大的过冷度（$\\Delta T_{\\mathrm{sub}} \\to \\infty$），该表达式表明 $\\Delta T_{\\mathrm{ONB}}$ 渐近地以 $\\sqrt{\\Delta T_{\\mathrm{sub}}}$ 的形式增长。", "answer": "$$\\boxed{\\frac{\\sigma T_{\\mathrm{sat}}}{C_{\\mathrm{H}} \\delta_{T} \\rho_{v} h_{fg}} \\left( 1 + \\sqrt{1 + \\frac{2 C_{\\mathrm{H}} \\delta_{T} \\rho_{v} h_{fg} \\Delta T_{\\mathrm{sub}}}{\\sigma T_{\\mathrm{sat}}}} \\right)}$$", "id": "2475176"}, {"introduction": "从沸腾的起始点，我们转向核态沸腾的上限——临界热流密度 (CHF)，这是一个决定换热设备安全运行极限的关键参数。本练习将理论与实际应用相结合，要求您使用经典的Zuber模型来预测CHF，并结合一个给定的经验关联式来计算实际工作点的热流密度。通过计算安全裕度 $M = q''_{\\mathrm{CHF}}/q''_{\\mathrm{op}}$ [@problem_id:2475155]，您将实践热设计中的一项核心任务，加深对沸腾传热极限及其在工程安全评估中重要性的理解。", "problem": "一块横向尺寸远大于毛细管长度的水平电解抛光铜板，在池沸腾条件下，于大气压下使饱和水沸腾。其运行设计要求壁面过热度控制在饱和温度以上 $\\Delta T = 25\\,\\mathrm{K}$。对于该表面和流体，工作范围内核态沸腾分支的沸腾曲线可通过实验标定的幂律形式 $q'' = C_{\\mathrm{nb}}\\,\\Delta T^{n}$ 表示，其中 $C_{\\mathrm{nb}} = 180\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-n}$ 且 $n = 2.6$。\n\n取 $p = 1\\,\\mathrm{atm}$ 时饱和水的物性参数为：$h_{fg} = 2.257 \\times 10^{6}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$，$\\rho_{\\ell} = 958\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，$\\rho_{v} = 0.597\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，$\\sigma = 0.0589\\,\\mathrm{N}\\,\\mathrm{m}^{-1}$，重力加速度 $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$。假设该板有效无限大，因此适用大表面的流体动力学极限。\n\n从大水平面上逆流的蒸汽和液体的界面流体动力学稳定性考虑出发，推导临界热通量（CHF）的表达式（用 $g$, $\\sigma$, $\\rho_{\\ell}$, $\\rho_{v}$ 和 $h_{fg}$ 表示），然后使用给定的物性参数对其进行数值计算。将临界热通量的安全裕度因子定义为 $M = q''_{\\mathrm{CHF}}/q''_{\\mathrm{op}}$，其中 $q''_{\\mathrm{op}}$ 是通过给定的核态沸腾关联式，对应于目标 $\\Delta T$ 的工作热通量。\n\n使用提供的标称物性参数和关联式参数，计算 $M$ 的数值。将答案四舍五入到三位有效数字。将 $M$ 报告为无量纲小数。此外，在您的解答中，讨论物性数据和表面状况（影响核态沸腾关联式）的不确定性如何影响计算出的安全裕度，并在不进行完整不确定性传播计算的情况下，确定最敏感的量。", "solution": "首要任务是基于界面流体动力学稳定性，推导临界热通量（CHF）的表达式，记为 $q''_{\\mathrm{CHF}}$。这一方法由 N. Zuber 首创，它将CHF条件建模为离开受热面的蒸汽和返回受热面的液体的逆流稳定性极限。在大的水平板上，蒸汽以柱状或射流形式逸出。当这些蒸汽射流的速度变得非常高，以至于阻止液体重新润湿表面，导致形成稳定的蒸汽膜时，就达到了 CHF。这是蒸汽射流与周围液体界面处开尔文-亥姆霍兹不稳定性的表现。\n\n这种不稳定性在特征波长处最为显著，该波长与泰勒波长 $\\lambda_{T}$ 相关，后者描述了由表面张力 $\\sigma$ 稳定的、稠密流体位于较轻流体之上的不稳定界面。临界泰勒波长由 $\\lambda_{c} = 2\\pi \\sqrt{\\frac{\\sigma}{g(\\rho_{\\ell}-\\rho_{v})}}$ 给出。Zuber 的模型假设蒸汽射流以方形网格排列，其间距对应于此临界波长 $\\lambda_{c}$。蒸汽射流的直径取为 $D_{jet} = \\frac{\\lambda_{c}}{2}$。加热器被蒸汽占据的面积 $A_{v}$ 相对于总加热器面积 $A_{h}$ 的比例则为 $A_{v}/A_{h} = \\frac{\\pi (D_{jet}/2)^2}{\\lambda_{c}^2} = \\frac{\\pi (\\lambda_{c}/4)^2}{\\lambda_{c}^2} = \\frac{\\pi}{16}$，但这是几种可能的几何假设之一。公认的模型则将表观蒸汽速度 $j_{v}$ 与不稳定性联系起来。\n\n总热通量是汽化潜热 $h_{fg}$ 与蒸汽质量通量 $\\rho_{v} j_{v}$ 的乘积，因此 $q'' = \\rho_{v} h_{fg} j_{v}$。临界条件 $q''_{\\mathrm{CHF}}$ 对应于最大可能的蒸汽表观速度 $j_{v, \\mathrm{max}}$。流体动力学稳定性理论为此最大速度提供了一个表达式：\n$$j_{v, \\mathrm{max}} = K \\left[ \\frac{\\sigma g (\\rho_{\\ell} - \\rho_v)}{\\rho_v^2} \\right]^{1/4}$$\n其中 $K$ 是一个常数。对于无限大水平板，理论分析得出 $K = \\frac{\\pi}{24}$。将这些结合起来，得到 Zuber 的 CHF 关联式：\n$$q''_{\\mathrm{CHF}} = \\rho_{v} h_{fg} \\left( \\frac{\\pi}{24} \\right) \\left[ \\frac{\\sigma g (\\rho_{\\ell} - \\rho_v)}{\\rho_v^2} \\right]^{1/4}$$\n此表达式可重新整理为推导的最终形式：\n$$q''_{\\mathrm{CHF}} = \\frac{\\pi}{24} h_{fg} \\left[ \\sigma g (\\rho_{\\ell} - \\rho_v) \\rho_v^2 \\right]^{1/4}$$\n此公式即为根据指定物性参数推导出的 CHF 表达式。\n\n接下来，我们使用所提供的数据对该表达式进行数值计算：\n重力加速度, $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$。\n表面张力, $\\sigma = 0.0589\\,\\mathrm{N}\\,\\mathrm{m}^{-1}$。\n液体密度, $\\rho_{\\ell} = 958\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$。\n蒸汽密度, $\\rho_{v} = 0.597\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$。\n汽化潜热, $h_{fg} = 2.257 \\times 10^{6}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$。\n密度差为 $\\rho_{\\ell} - \\rho_{v} = 958 - 0.597 = 957.403\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$。\n\n首先，我们计算四次方根内的项：\n$$X = \\sigma g (\\rho_{\\ell} - \\rho_v) \\rho_v^2 = (0.0589) \\cdot (9.81) \\cdot (957.403) \\cdot (0.597)^2 \\approx 197.16 \\, \\mathrm{kg}^2\\,\\mathrm{s}^{-6}$$\n$$X^{1/4} \\approx (197.16)^{1/4} \\approx 3.748 \\, \\mathrm{kg}^{1/2}\\,\\mathrm{s}^{-3/2}$$\n现在，我们计算CHF：\n$$q''_{\\mathrm{CHF}} = \\frac{\\pi}{24} h_{fg} X^{1/4} \\approx \\frac{\\pi}{24} \\cdot (2.257 \\times 10^{6}) \\cdot (3.748) \\approx 1.1083 \\times 10^{6} \\, \\mathrm{W}\\,\\mathrm{m}^{-2}$$\n因此，$q''_{\\mathrm{CHF}} \\approx 1.11\\,\\mathrm{MW}\\,\\mathrm{m}^{-2}$。\n\n下一步是使用给定的核态沸腾关联式 $q'' = C_{\\mathrm{nb}}\\,\\Delta T^{n}$，根据指定的壁面过热度 $\\Delta T = 25\\,\\mathrm{K}$，计算工作热通量 $q''_{\\mathrm{op}}$。参数为 $C_{\\mathrm{nb}} = 180\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-n}$ 和 $n = 2.6$。\n$$q''_{\\mathrm{op}} = (180) \\cdot (25)^{2.6} \\approx (180) \\cdot (4311.63) \\approx 776093 \\, \\mathrm{W}\\,\\mathrm{m}^{-2}$$\n因此，$q''_{\\mathrm{op}} \\approx 0.776\\,\\mathrm{MW}\\,\\mathrm{m}^{-2}$。\n\n安全裕度因子 $M$ 定义为临界热通量与工作热通量之比，$M = q''_{\\mathrm{CHF}}/q''_{\\mathrm{op}}$。\n$$M = \\frac{1.1083 \\times 10^{6}}{776093} \\approx 1.42807$$\n四舍五入到三位有效数字，安全裕度为 $M \\approx 1.43$。\n\n最后，我们讨论不确定性对计算出的安全裕度 $M$ 的影响。$M$ 的表达式为：\n$$M = \\frac{q''_{\\mathrm{CHF}}}{q''_{\\mathrm{op}}} = \\frac{ \\frac{\\pi}{24} h_{fg} \\left[ \\sigma g (\\rho_{\\ell} - \\rho_v) \\rho_v^2 \\right]^{1/4} }{ C_{\\mathrm{nb}}\\,\\Delta T^{n} }$$\n$1\\,\\mathrm{atm}$ 下水的热物理性质（$h_{fg}, \\sigma, \\rho_{\\ell}, \\rho_{v}$）的不确定性通常很小，因为这些性质已被充分表征。$M$ 对这些性质的敏感度各不相同。它与 $h_{fg}$ 呈线性关系，与 $\\rho_{v}^{1/2}$ 成正比，与 $\\sigma^{1/4}$ 和 $(\\rho_{\\ell} - \\rho_{v})^{1/4}$ 成正比。对于四次方根下的量，其依赖性最弱。即使是常数 $K = \\pi/24$ 也是一个理论值；经验数据通常表明其值略有不同（例如 $K \\approx 0.149$），这会引入约 $10-15\\%$ 的模型不确定性。\n\n最重要的不确定性来源是分母，它描述了工作中的核态沸腾条件。参数 $C_{\\mathrm{nb}}$ 和 $n$ 是经验性的，对表面状况（包括其微观几何形状（粗糙度）、化学性质、清洁度和老化）极为敏感。“电解抛光”是一个技术规格，但它不能保证完美的再现性。表面处理的微小变化可能导致 $C_{\\mathrm{nb}}$ 以及在较小程度上 $n$ 的巨大变化。因此，根据此关联式计算出的工作热通量 $q''_{\\mathrm{op}}$ 带有显著的不确定性。\n\n此外，$q''_{\\mathrm{op}}$ 依赖于 $\\Delta T$ 的 $n=2.6$ 次幂。这个高指数会放大壁面过热度 $\\Delta T$ 测量或控制中的任何误差。与设计值 $\\Delta T = 25\\,\\mathrm{K}$ 的微小偏差将导致 $q''_{\\mathrm{op}}$ 的分数变化大得多，从而影响安全裕度 $M$。例如，$\\Delta T$ 中仅 $5\\%$ 的误差（即 $\\pm 1.25\\,\\mathrm{K}$）就会导致 $q''_{\\mathrm{op}}$ 发生约 $1.05^{2.6} - 1 \\approx 13.5\\%$ 的变化。\n\n总而言之，安全裕度 $M$ 对核态沸腾关联式的参数（$C_{\\mathrm{nb}}$, $n$）和工作壁面过热度（$\\Delta T$）最为敏感，因为这些参数是经验性的、依赖于表面的，并且涉及强幂律关系。与这些因素相关的不确定性通常远远超过与 CHF 模型中使用的基本热物理性质相关的不确定性。", "answer": "$$\\boxed{1.43}$$", "id": "2475155"}, {"introduction": "工程实践中使用的许多传热关联式，例如前一个练习中的核态沸腾公式，都源于对实验数据的拟合。本练习旨在揭示这些经验模型是如何从原始测量中诞生的。您将通过一个动手编程任务[@problem_id:2475157]，学习如何应用统计学方法（具体为对数变换后的线性回归）来确定核态沸腾关联式的关键参数。这项实践不仅能让您掌握从数据到模型的核心技能，还能让您对经验关联式的不确定性及其适用范围有更深入的认识。", "problem": "给定三个在恒定环境压力和材料系统下通过实验测量的核态池沸数据集。每个数据集由壁面过热度 $\\Delta T$ 和热通量 $q^{\\prime\\prime}$ 的配对测量值 $\\{(\\Delta T_i, q^{\\prime\\prime}_i)\\}_{i=1}^N$ 组成。假设在核态沸腾区间内，对于给定的流体、表面和重力水平，热通量对驱动温差的函数依赖关系在感兴趣的范围内是单调且强标度不变的。根据此标度不变性假设和量纲齐次性原理，可以用一个依赖于表面-流体的双参数幂律模型来描述该关系。模型的系数编码了表面-流体的相互作用，而指数则编码了热通量对过热度的敏感性。您的任务是：\n\n1) 从标度不变性假设 $q^{\\prime\\prime}(\\lambda\\,\\Delta T) \\propto \\lambda^{n}\\,q^{\\prime\\prime}(\\Delta T)$ 以及当 $\\Delta T  0$ 时 $q^{\\prime\\prime}  0$ 的要求出发，证明一个可接受的经验模型是双参数幂律，并确定系数的量纲。\n\n2) 采用一个统计误差模型，其中测量噪声在原始变量中是乘性的，因此在响应的对数中是加性且服从高斯分布。使用一种变换使模型在其参数上是线性的。提出一个基于最小二乘法的估计程序，该程序：\n- 在未提供每个数据的标准差时，简化为普通最小二乘法 (OLS)，并且\n- 在提供了变换后响应的每个数据的标准差时，成为加权最小二乘法 (WLS)，并将这些标准差视为已知。\n\n3) 从线性回归的基本原理出发，推导参数估计值及其标准不确定度（一个标准差）的闭式表达式。使用变换空间中线性估计器的协方差矩阵，并通过一阶不确定度传播将不确定度传回原始系数。\n\n4) 实现该估计器并将其应用于下面的测试集。对于每个数据集，返回估计的系数 $C_{sf}$、指数 $n$ 及其标准不确定度 $u_{C_{sf}}$ 和 $u_n$。将 $C_{sf}$ 以国际单位制 (SI 单位) $\\mathrm{W\\,m^{-2}\\,K^{-n}}$ 表示，$n$ 为无量纲，所有报告值均为浮点数。输出中不要包含任何单位符号。将每个报告的浮点值四舍五入到六位有效数字。\n\n使用以下数据集。所有的 $\\Delta T$ 单位为 $\\mathrm{K}$，所有的 $q^{\\prime\\prime}$ 单位为 $\\mathrm{W\\,m^{-2}}$。若提供，$\\sigma_{y,i}$ 表示变换后响应 $y_i = \\ln q^{\\prime\\prime}_i$ 中噪声的标准差。\n\n- 数据集 A (无每个数据的标准差；在变换空间中使用 OLS)：\n  - $\\Delta T$: $\\{5.0, 8.0, 12.0, 16.0, 22.0, 30.0\\}$\n  - $q^{\\prime\\prime}$: $\\{470925.0, 1252464.0, 3473280.0, 5652480.0, 12974797.6, 24018660.0\\}$\n\n- 数据集 B (提供了每个数据的标准差；在变换空间中使用 WLS)：\n  - $\\Delta T$: $\\{4.0, 6.0, 9.0, 13.0, 18.0, 26.0\\}$\n  - $q^{\\prime\\prime}$: $\\{370933.0, 732537.0, 1645344.0, 2921279.0, 5533386.0, 10564200.0\\}$\n  - $\\sigma_{y}$: $\\{0.04, 0.06, 0.05, 0.07, 0.05, 0.04\\}$\n\n- 数据集 C (提供了每个数据的标准差；在变换空间中使用 WLS)：\n  - $\\Delta T$: $\\{2.0, 3.5, 5.0, 6.5, 8.0\\}$\n  - $q^{\\prime\\prime}$: $\\{9020.0, 38793.0, 131409.0, 253540.0, 594859.0\\}$\n  - $\\sigma_{y}$: $\\{0.15, 0.12, 0.10, 0.12, 0.15\\}$\n\n您的程序必须为每个数据集计算元组 $(C_{sf}, n, u_{C_{sf}}, u_n)$，然后生成单行输出，其中包含一个由逗号分隔的三个方括号列表，每个列表对应一个数据集，并用方括号括起来。每个内部列表必须按 $[C_{sf}, n, u_{C_{sf}}, u_n]$ 的顺序排列。例如，输出格式必须完全如下所示：\n\"[ [cA,nA,uCA,unA],[cB,nB,uCB,unB],[cC,nC,uCC,unC] ]\"\n除了使用实际数值四舍五入到六位有效数字外，没有其他附加文本。", "solution": "**第 1 部分：模型合理性与量纲分析**\n\n问题始于热通量 $q^{\\prime\\prime}$ 作为壁面过热度 $\\Delta T = T_w - T_{sat}$ 的函数时具有标度不变性的假设。该物理学假设表示为：\n$$ q^{\\prime\\prime}(\\lambda\\,\\Delta T) \\propto \\lambda^{n}\\,q^{\\prime\\prime}(\\Delta T) $$\n其中 $\\lambda$ 是任意正的标度因子，$n$ 是一个常数指数。问题指出，函数依赖关系是单调且*强*标度不变的，这意味着比例关系可以视为等式关系。这将 $q^{\\prime\\prime}(\\Delta T)$ 定义为一个 $n$ 次齐次函数：\n$$ q^{\\prime\\prime}(\\lambda\\,\\Delta T) = \\lambda^{n}\\,q^{\\prime\\prime}(\\Delta T) $$\n我们设 $\\Delta T = 1$（暂时假设为无量纲单位）。那么 $q^{\\prime\\prime}(\\lambda) = \\lambda^n q^{\\prime\\prime}(1)$。如果我们将 $\\lambda$ 替换为变量 $\\Delta T$，我们得到 $q^{\\prime\\prime}(\\Delta T) = (\\Delta T)^n q^{\\prime\\prime}(1)$。对于给定的流体-表面组合和压力，项 $q^{\\prime\\prime}(1)$ 是一个常数。我们称这个常数为 $C_{sf}$。因此，函数形式必须是幂律：\n$$ q^{\\prime\\prime}(\\Delta T) = C_{sf} (\\Delta T)^n $$\n这是传热学中经验关联式的常见形式，最著名的是用于核态沸腾的 Rohsenow 关联式。当 $\\Delta T  0$ 时 $q^{\\prime\\prime}  0$ 的条件要求 $C_{sf}  0$，因为当 $\\Delta T  0$ 时 $\\Delta T^n  0$。\n\n接下来，我们根据量纲齐次性原理确定系数 $C_{sf}$ 的量纲。方程中每一项的单位必须一致。当 $\\Delta T$ 有量纲时，指数 $n$ 必须是一个无量纲数，这样 $(\\Delta T)^n$ 的运算才有物理意义。\n单位由方括号 $[\\cdot]$ 表示。\n-   热通量, $q^{\\prime\\prime}$: $[q^{\\prime\\prime}] = \\mathrm{W\\,m^{-2}}$\n-   壁面过热度, $\\Delta T$: $[\\Delta T] = \\mathrm{K}$\n-   指数, $n$: $[n] = 1$ (无量纲)\n\n根据模型方程，我们有：\n$$ [q^{\\prime\\prime}] = [C_{sf}] \\cdot [\\Delta T]^n $$\n代入已知单位：\n$$ \\mathrm{W\\,m^{-2}} = [C_{sf}] \\cdot \\mathrm{K}^n $$\n求解 $C_{sf}$ 的单位：\n$$ [C_{sf}] = \\frac{\\mathrm{W\\,m^{-2}}}{\\mathrm{K}^n} = \\mathrm{W\\,m^{-2}\\,K^{-n}} $$\n这证实了问题中所述的量纲。\n\n**第 2 部分：统计模型与估计程序**\n\n幂律模型 $q^{\\prime\\prime} = C_{sf}(\\Delta T)^n$ 在其参数 $C_{sf}$ 和 $n$ 上是非线性的。为了使用线性回归技术，我们必须将该模型线性化。问题指定了乘性误差结构，这表明应进行对数变换。对模型方程两边取自然对数，得到：\n$$ \\ln(q^{\\prime\\prime}) = \\ln(C_{sf} (\\Delta T)^n) = \\ln(C_{sf}) + n \\ln(\\Delta T) $$\n这个方程在变换后的参数上是线性的。我们定义以下变量：\n-   变换后的响应变量: $y_i = \\ln(q^{\\prime\\prime}_i)$\n-   变换后的预测变量: $x_i = \\ln(\\Delta T_i)$\n-   截距: $\\beta_0 = \\ln(C_{sf})$\n-   斜率: $\\beta_1 = n$\n\n每个数据点 $i$ 的模型变为：\n$$ y_i = \\beta_0 + \\beta_1 x_i + \\epsilon_i $$\n其中 $\\epsilon_i$ 表示变换空间中的测量误差。问题指出此误差是加性的且服从高斯分布，$\\epsilon_i \\sim \\mathcal{N}(0, \\sigma_{y,i}^2)$。\n\n为了估计参数 $\\beta_0$ 和 $\\beta_1$，我们使用最小二乘法，它最小化残差平方和。具体程序取决于有关方差 $\\sigma_{y,i}^2$ 的可用信息。\n\n-   **普通最小二乘法 (OLS)**：当标准差 $\\sigma_{y,i}$ 未知或假定对所有数据点都恒定（同方差性，$\\sigma_{y,i} = \\sigma_y$）时使用此方法。我们最小化残差平方和 $S$：\n    $$ S(\\beta_0, \\beta_1) = \\sum_{i=1}^N (y_i - (\\beta_0 + \\beta_1 x_i))^2 $$\n    这是适用于数据集 A 的程序。\n\n-   **加权最小二乘法 (WLS)**：当标准差 $\\sigma_{y,i}$ 已知且在数据点之间变化（异方差性）时使用此方法。每个残差都由其方差的倒数加权，$w_i = 1/\\sigma_{y,i}^2$。我们最小化卡方统计量 $\\chi^2$：\n    $$ \\chi^2(\\beta_0, \\beta_1) = \\sum_{i=1}^N w_i(y_i - (\\beta_0 + \\beta_1 x_i))^2 = \\sum_{i=1}^N \\left( \\frac{y_i - (\\beta_0 + \\beta_1 x_i)}{\\sigma_{y,i}} \\right)^2 $$\n    此程序为更精确的测量赋予更大权重，适用于数据集 B 和 C。\n\n**第 3 部分：估计器和不确定度的推导**\n\n我们将线性模型用矩阵表示为 $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}$，其中：\n$$ \\mathbf{y} = \\begin{pmatrix} y_1 \\\\ y_2 \\\\ \\vdots \\\\ y_N \\end{pmatrix}, \\quad \\mathbf{X} = \\begin{pmatrix} 1  x_1 \\\\ 1  x_2 \\\\ \\vdots  \\vdots \\\\ 1  x_N \\end{pmatrix}, \\quad \\boldsymbol{\\beta} = \\begin{pmatrix} \\beta_0 \\\\ \\beta_1 \\end{pmatrix}, \\quad \\boldsymbol{\\epsilon} = \\begin{pmatrix} \\epsilon_1 \\\\ \\epsilon_2 \\\\ \\vdots \\\\ \\epsilon_N \\end{pmatrix} $$\nWLS 的目标函数是 $(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta})^T \\mathbf{W} (\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta})$，其中 $\\mathbf{W}$ 是由权重 $w_i = 1/\\sigma_{y,i}^2$ 构成的对角矩阵。通过将关于 $\\boldsymbol{\\beta}$ 的梯度设为零，可以找到最小化该目标函数的解，从而得到正规方程组：\n$$ (\\mathbf{X}^T \\mathbf{W} \\mathbf{X}) \\hat{\\boldsymbol{\\beta}} = \\mathbf{X}^T \\mathbf{W} \\mathbf{y} $$\n参数矢量 $\\boldsymbol{\\beta}$ 的 WLS 估计为：\n$$ \\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\mathbf{y} $$\n对于 OLS，权重矩阵 $\\mathbf{W}$ 是单位矩阵 $\\mathbf{I}$。\n\n估计器 $\\hat{\\boldsymbol{\\beta}}$ 的协方差矩阵对于确定参数的不确定度至关重要。\n-   **对于 WLS（已知方差）**：问题要求将给定的 $\\sigma_{y,i}$ 视为已知。在这种情况下，$\\hat{\\boldsymbol{\\beta}}$ 的协方差矩阵精确地由以下公式给出：\n    $$ \\mathrm{Cov}(\\hat{\\boldsymbol{\\beta}}) = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} $$\n-   **对于 OLS（未知共同方差）**：共同方差 $\\sigma_y^2$ 是未知的，必须从数据中估计。$\\sigma_y^2$ 的无偏估计量是 $s_y^2 = \\frac{1}{N-p} \\sum_{i=1}^N (y_i - \\hat{y}_i)^2$，其中 $\\hat{y}_i = \\hat{\\beta}_0 + \\hat{\\beta}_1 x_i$ 是拟合值，$p=2$ 是参数的数量。估计的协方差矩阵是：\n    $$ \\widehat{\\mathrm{Cov}}(\\hat{\\boldsymbol{\\beta}}) = s_y^2 (\\mathbf{X}^T \\mathbf{X})^{-1} $$\n\n协方差矩阵的对角线元素是参数估计值的方差：\n$$ \\mathrm{Cov}(\\hat{\\boldsymbol{\\beta}}) = \\begin{pmatrix} u_{\\hat{\\beta}_0}^2  \\mathrm{cov}(\\hat{\\beta}_0, \\hat{\\beta}_1) \\\\ \\mathrm{cov}(\\hat{\\beta}_0, \\hat{\\beta}_1)  u_{\\hat{\\beta}_1}^2 \\end{pmatrix} $$\n标准不确定度是 $u_{\\hat{\\beta}_0}$ 和 $u_{\\hat{\\beta}_1}$。\n\n最后，我们将这些不确定度传回原始模型参数 $n$ 和 $C_{sf}$。\n-   对于指数 $n$：关系是直接的，$\\hat{n} = \\hat{\\beta}_1$。因此，不确定度也直接传递：$u_n = u_{\\hat{\\beta}_1}$。\n-   对于系数 $C_{sf}$：关系是 $\\hat{C}_{sf} = \\exp(\\hat{\\beta}_0)$。我们使用一阶不确定度传播：\n    $$ u_{C_{sf}}^2 \\approx \\left(\\frac{\\partial C_{sf}}{\\partial \\beta_0}\\bigg|_{\\hat{\\beta}_0}\\right)^2 u_{\\hat{\\beta}_0}^2 $$\n    导数是 $\\frac{\\partial}{\\partial \\beta_0} \\exp(\\beta_0) = \\exp(\\beta_0) = C_{sf}$。\n    $$ u_{C_{sf}}^2 \\approx (\\hat{C}_{sf})^2 u_{\\hat{\\beta}_0}^2 \\implies u_{C_{sf}} \\approx \\hat{C}_{sf} u_{\\hat{\\beta}_0} $$\n这意味着 $C_{sf}$ 的相对不确定度等于其对数 $\\beta_0$ 的绝对不确定度。\n\n**第 4 部分：实现**\n\n推导出的公式在一个 Python 脚本中实现。对于每个数据集：\n$1$. 输入数据 $(\\Delta T_i, q^{\\prime\\prime}_i)$ 经过对数变换得到 $x_i = \\ln(\\Delta T_i)$ 和 $y_i = \\ln(q^{\\prime\\prime}_i)$。\n$2$. 对于数据集 A (OLS)，权重矩阵 $\\mathbf{W}$ 取单位矩阵。求解线性系统得到 $\\hat{\\boldsymbol{\\beta}}$。计算残差的样本方差 $s_y^2$，协方差矩阵计算公式为 $s_y^2(\\mathbf{X}^T\\mathbf{X})^{-1}$。\n$3$. 对于数据集 B 和 C (WLS)，根据提供的标准差，用元素 $w_i = 1/\\sigma_{y,i}^2$ 构造权重矩阵 $\\mathbf{W}$。求解线性系统得到 $\\hat{\\boldsymbol{\\beta}}$，协方差矩阵计算公式为 $(\\mathbf{X}^T\\mathbf{W}\\mathbf{X})^{-1}$。\n$4$. 从协方差矩阵的对角线元素中，获得不确定度 $u_{\\hat{\\beta}_0}$ 和 $u_{\\hat{\\beta}_1}$。\n$5$. 将参数及其不确定度变换回原始物理空间：$\\hat{n} = \\hat{\\beta}_1$，$u_n = u_{\\hat{\\beta}_1}$，$\\hat{C}_{sf} = \\exp(\\hat{\\beta}_0)$，以及 $u_{C_{sf}} = \\hat{C}_{sf} u_{\\hat{\\beta}_0}$。\n$6$. 最终的数值结果按照要求四舍五入并格式化为六位有效数字。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\n# --- Data Definition ---\n\ntest_cases = [\n    {\n        \"name\": \"A\",\n        \"delta_T\": np.array([5.0, 8.0, 12.0, 16.0, 22.0, 30.0]),\n        \"q_double_prime\": np.array([470925.0, 1252464.0, 3473280.0, 5652480.0, 12974797.6, 24018660.0]),\n        \"sigma_y\": None,\n    },\n    {\n        \"name\": \"B\",\n        \"delta_T\": np.array([4.0, 6.0, 9.0, 13.0, 18.0, 26.0]),\n        \"q_double_prime\": np.array([370933.0, 732537.0, 1645344.0, 2921279.0, 5533386.0, 10564200.0]),\n        \"sigma_y\": np.array([0.04, 0.06, 0.05, 0.07, 0.05, 0.04]),\n    },\n    {\n        \"name\": \"C\",\n        \"delta_T\": np.array([2.0, 3.5, 5.0, 6.5, 8.0]),\n        \"q_double_prime\": np.array([9020.0, 38793.0, 131409.0, 253540.0, 594859.0]),\n        \"sigma_y\": np.array([0.15, 0.12, 0.10, 0.12, 0.15]),\n    }\n]\n\ndef format_sf(value, sigfigs):\n    \"\"\"\n    Formats a floating-point number to a string with a specified number of significant figures.\n    Handles both fixed-point and scientific notation, including trailing zeros.\n    \"\"\"\n    if value == 0:\n        return '0.' + '0' * (sigfigs - 1)\n    \n    # Use 'e' format to perform rounding correctly to sigfigs\n    try:\n        rounded_e_str = f\"{value:.{sigfigs-1}e}\"\n        mantissa_str, exp_str = rounded_e_str.split('e')\n        exponent = int(exp_str)\n    except (ValueError, IndexError):\n        return str(value) # Fallback for non-standard numbers\n\n    # Decide final format based on exponent magnitude ('g' format logic)\n    if -4 = exponent  sigfigs:\n        # Reconstruct the rounded value to handle formatting\n        rounded_value = float(mantissa_str) * (10**exponent)\n        num_decimals = sigfigs - 1 - exponent\n        return f\"{rounded_value:.{num_decimals}f}\"\n    else:\n        return rounded_e_str\n\ndef solve():\n    \"\"\"\n    Main solver function that processes all test cases.\n    \"\"\"\n    results = []\n    for case in test_cases:\n        delta_T = case[\"delta_T\"]\n        q_double_prime = case[\"q_double_prime\"]\n        sigma_y = case[\"sigma_y\"]\n        N = len(delta_T)\n        num_params = 2\n\n        # 1. Transform variables to linearize the model\n        x = np.log(delta_T)\n        y = np.log(q_double_prime)\n\n        # 2. Construct design matrix X\n        X = np.vstack([np.ones(N), x]).T\n\n        C_inv = None\n        \n        if sigma_y is None: # OLS Case (Dataset A)\n            # Normal equations for OLS: (X^T X) beta = X^T y\n            XTX = X.T @ X\n            XTy = X.T @ y\n            beta_hat = np.linalg.solve(XTX, XTy)\n\n            # Estimate variance of residuals\n            y_hat = X @ beta_hat\n            residuals = y - y_hat\n            SSE = np.sum(residuals**2)\n            df = N - num_params\n            s_y_sq = SSE / df\n            \n            # Covariance matrix of parameters\n            C_inv = np.linalg.inv(XTX)\n            cov_beta = s_y_sq * C_inv\n\n        else: # WLS Case (Datasets B, C)\n            W = np.diag(1 / sigma_y**2)\n            # Normal equations for WLS: (X^T W X) beta = X^T W y\n            XTWX = X.T @ W @ X\n            XTWy = X.T @ W @ y\n            beta_hat = np.linalg.solve(XTWX, XTWy)\n            \n            # Covariance matrix of parameters\n            cov_beta = np.linalg.inv(XTWX)\n\n        # 3. Extract parameter estimates and uncertainties\n        beta0_hat = beta_hat[0]  # ln(C_sf)\n        beta1_hat = beta_hat[1]  # n\n\n        u_beta0_sq = cov_beta[0, 0]\n        u_beta1_sq = cov_beta[1, 1]\n        \n        u_beta0 = np.sqrt(u_beta0_sq)\n        u_beta1 = np.sqrt(u_beta1_sq)\n\n        # 4. Propagate back to original parameters\n        # Exponent n\n        n_hat = beta1_hat\n        u_n = u_beta1\n        \n        # Coefficient C_sf\n        C_sf_hat = np.exp(beta0_hat)\n        # u_C_sf = |C_sf_hat| * u_beta0 for first-order propagation\n        u_C_sf = C_sf_hat * u_beta0\n\n        # Assemble the tuple of results for this case\n        case_results = [C_sf_hat, n_hat, u_C_sf, u_n]\n        \n        # Format results to 6 significant figures\n        formatted_results = [format_sf(v, 6) for v in case_results]\n        \n        results.append(f\"[{','.join(formatted_results)}]\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2475157"}]}