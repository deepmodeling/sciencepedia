{"hands_on_practices": [{"introduction": "第一个练习旨在通过从第一性原理直接计算立体角，为您打下坚实的基础。您将从微分立体角 $d\\omega$ 的基本定义出发，对一个典型的几何结构——从轴线上观察一个圆形盘——进行积分。通过这个实践，您将对宏观的立体角是如何构成的，以及无处不在的远场近似如何从严格的推导中自然产生，获得切实的理解 [@problem_id:2517646]。", "problem": "一个半径为 $a$ 的圆盘位于平面 $z=0$ 内，其圆心在原点。一个点探测器位于对称轴上的点 $(0,0,z)$ 处，其中 $z>0$。仅使用立体角的基本定义，即单位球面上的投影面积，也就是说，立体角元为 $d\\omega = dA_{n}/r^{2}$（其中 $dA_{n}$ 是面元 $dA$ 在垂直于视线方向上的投影，而 $r$ 是探测器到该面元的距离），通过对圆盘进行直接积分，推导出该圆盘相对于探测器所张的精确总立体角 $\\Omega_{\\text{exact}}(a,z)$。然后，通过假设从探测器看，该圆盘是光学小目标（即 $z$ 相对于 $a$ 很大），并在此近似下一致地应用相同的基本定义，求出远场近似值 $\\Omega_{\\text{ff}}(a,z)$。最后，将相对误差定义为 $\\varepsilon(a/z) = \\left(\\Omega_{\\text{ff}} - \\Omega_{\\text{exact}}\\right)/\\Omega_{\\text{exact}}$，并以小参数 $a/z$ 的幂次形式，确定其首个非零项的明确渐近表达式。\n\n所有立体角均以球面度（steradians）为单位（角度以弧度（radians）为单位）。将你的最终答案表示为一个行矩阵，其中依次包含 $\\Omega_{\\text{exact}}(a,z)$、$\\Omega_{\\text{ff}}(a,z)$ 以及当 $a/z \\to 0$ 时 $\\varepsilon(a/z)$ 的主阶渐近表达式。", "solution": "所述问题定义明确，具有科学依据，并存在唯一、稳定的解。我们将按照指示，通过直接积分进行推导。\n\n该问题要求计算半径为 $a$ 的圆盘在距离为 $z$ 的轴上点探测器处所张的立体角 $\\Omega$。该圆盘位于平面 $z=0$ 内，圆心在原点 $(0,0,0)$。探测器位于 $(0,0,z)$ 处，其中 $z>0$。推导必须从立体角元 $d\\omega$ 的基本定义开始：\n$$d\\omega = \\frac{dA_n}{r^2}$$\n其中 $dA_n$ 是表面上面元 $dA$ 在垂直于视线方向上的投影，而 $r$ 是探测器到 $dA$ 的距离。\n\n我们建立一个柱坐标系 $(\\rho, \\phi, z)$。圆盘上的一个点由坐标 $(\\rho \\cos\\phi, \\rho \\sin\\phi, 0)$ 描述，其中 $0 \\le \\rho \\le a$ 且 $0 \\le \\phi < 2\\pi$。圆盘上的面元为 $dA = \\rho \\, d\\rho \\, d\\phi$。\n\n从位于 $(0,0,z)$ 的探测器指向位于 $(\\rho \\cos\\phi, \\rho \\sin\\phi, 0)$ 的面元 $dA$ 的矢量为：\n$$\\vec{s} = (\\rho \\cos\\phi, \\rho \\sin\\phi, -z)$$\n距离 $r$ 是该矢量的大小：\n$$r = |\\vec{s}| = \\sqrt{(\\rho \\cos\\phi)^2 + (\\rho \\sin\\phi)^2 + (-z)^2} = \\sqrt{\\rho^2 + z^2}$$\n投影面积 $dA_n$ 由 $dA_n = dA \\cos\\psi$ 给出，其中 $\\psi$ 是面元 $dA$ 的法线与视线矢量 $\\vec{s}$ 之间的夹角。位于 $z=0$ 平面内的圆盘的法向量为 $\\vec{n} = \\hat{k} = (0,0,1)$。夹角 $\\psi$ 可通过点积求得：\n$$\\cos\\psi = \\frac{|\\vec{s} \\cdot \\vec{n}|}{|\\vec{s}| |\\vec{n}|} = \\frac{|(\\rho \\cos\\phi, \\rho \\sin\\phi, -z) \\cdot (0,0,1)|}{\\sqrt{\\rho^2 + z^2} \\cdot 1} = \\frac{|-z|}{\\sqrt{\\rho^2 + z^2}} = \\frac{z}{\\sqrt{\\rho^2 + z^2}}$$\n因为 $z>0$。\n\n因此，立体角元为：\n$$d\\omega = \\frac{dA_n}{r^2} = \\frac{(dA) \\cos\\psi}{r^2} = \\frac{(\\rho \\, d\\rho \\, d\\phi) \\left(\\frac{z}{\\sqrt{\\rho^2+z^2}}\\right)}{(\\sqrt{\\rho^2+z^2})^2} = \\frac{z \\rho}{(\\rho^2+z^2)^{3/2}} \\, d\\rho \\, d\\phi$$\n\n**1. 精确立体角 $\\Omega_{\\text{exact}}(a,z)$**\n\n为了求出总立体角 $\\Omega_{\\text{exact}}$，我们将 $d\\omega$ 在整个圆盘面积上积分。积分范围为 $\\rho$ 从 $0$ 到 $a$，$\\phi$ 从 $0$ 到 $2\\pi$。\n$$\\Omega_{\\text{exact}} = \\int_{0}^{2\\pi} \\int_{0}^{a} \\frac{z \\rho}{(\\rho^2+z^2)^{3/2}} \\, d\\rho \\, d\\phi$$\n由于被积函数不依赖于 $\\phi$，对 $\\phi$ 的积分得到一个因子 $2\\pi$：\n$$\\Omega_{\\text{exact}} = 2\\pi z \\int_{0}^{a} \\frac{\\rho}{(\\rho^2+z^2)^{3/2}} \\, d\\rho$$\n为了计算剩余的积分，我们使用换元法，令 $u = \\rho^2+z^2$，则 $du = 2\\rho \\, d\\rho$。积分变为：\n$$\\int \\frac{\\rho}{(\\rho^2+z^2)^{3/2}} \\, d\\rho = \\frac{1}{2} \\int u^{-3/2} \\, du = \\frac{1}{2} \\frac{u^{-1/2}}{-1/2} = -u^{-1/2} = -\\frac{1}{\\sqrt{\\rho^2+z^2}}$$\n计算从 $\\rho=0$ 到 $\\rho=a$ 的定积分：\n$$\\int_{0}^{a} \\frac{\\rho}{(\\rho^2+z^2)^{3/2}} \\, d\\rho = \\left[ -\\frac{1}{\\sqrt{\\rho^2+z^2}} \\right]_{0}^{a} = \\left(-\\frac{1}{\\sqrt{a^2+z^2}}\\right) - \\left(-\\frac{1}{\\sqrt{0^2+z^2}}\\right) = \\frac{1}{z} - \\frac{1}{\\sqrt{a^2+z^2}}$$\n将此结果代回 $\\Omega_{\\text{exact}}$ 的表达式中：\n$$\\Omega_{\\text{exact}}(a,z) = 2\\pi z \\left(\\frac{1}{z} - \\frac{1}{\\sqrt{a^2+z^2}}\\right) = 2\\pi \\left(1 - \\frac{z}{\\sqrt{a^2+z^2}}\\right)$$\n\n**2. 远场近似 $\\Omega_{\\text{ff}}(a,z)$**\n\n在远场极限下，探测器远离圆盘，因此 $z \\gg a$。这意味着对于圆盘上的任何点，都有 $\\rho \\le a \\ll z$。在此近似下：\n\\begin{itemize}\n    \\item 距离 $r = \\sqrt{\\rho^2+z^2}$ 近似为常数 $z$。\n    \\item 投影因子 $\\cos\\psi = \\frac{z}{\\sqrt{\\rho^2+z^2}}$ 近似为 $\\frac{z}{\\sqrt{0+z^2}} = 1$。\n\\end{itemize}\n将这些近似应用于基本定义 $\\Omega = \\int \\frac{dA \\cos\\psi}{r^2}$：\n$$\\Omega_{\\text{ff}} \\approx \\int_{\\text{disk}} \\frac{dA \\cdot 1}{z^2} = \\frac{1}{z^2} \\int_{\\text{disk}} dA$$\n$dA$ 在圆盘上的积分是其总面积 $A = \\pi a^2$。因此，远场近似为：\n$$\\Omega_{\\text{ff}}(a,z) = \\frac{\\pi a^2}{z^2}$$\n\n**3. 相对误差 $\\varepsilon(a/z)$**\n\n相对误差定义为 $\\varepsilon(a/z) = \\frac{\\Omega_{\\text{ff}} - \\Omega_{\\text{exact}}}{\\Omega_{\\text{exact}}}$。我们寻求当小参数 $x = a/z \\to 0$ 时，此表达式的首个非零项。\n\n首先，我们用 $x$ 重写 $\\Omega_{\\text{exact}}$：\n$$\\Omega_{\\text{exact}} = 2\\pi \\left(1 - \\frac{z}{\\sqrt{a^2+z^2}}\\right) = 2\\pi \\left(1 - \\frac{1}{\\sqrt{(a/z)^2+1}}\\right) = 2\\pi \\left(1 - (1+x^2)^{-1/2}\\right)$$\n我们使用二项式级数展开 $(1+u)^{\\alpha}$，其中 $u=x^2$ 且 $\\alpha=-1/2$：\n$$(1+x^2)^{-1/2} = 1 - \\frac{1}{2}x^2 + \\frac{(-1/2)(-3/2)}{2!}(x^2)^2 + O((x^2)^3) = 1 - \\frac{1}{2}x^2 + \\frac{3}{8}x^4 + O(x^6)$$\n将此代入 $\\Omega_{\\text{exact}}$ 的表达式中：\n$$\\Omega_{\\text{exact}} = 2\\pi \\left(1 - \\left[1 - \\frac{1}{2}x^2 + \\frac{3}{8}x^4 - \\dots\\right]\\right) = 2\\pi \\left(\\frac{1}{2}x^2 - \\frac{3}{8}x^4 + \\dots\\right) = \\pi x^2 - \\frac{3\\pi}{4}x^4 + O(x^6)$$\n远场表达式为 $\\Omega_{\\text{ff}} = \\pi (a/z)^2 = \\pi x^2$。\n\n现在，我们计算相对误差：\n$$\\varepsilon(x) = \\frac{\\Omega_{\\text{ff}}}{\\Omega_{\\text{exact}}} - 1 = \\frac{\\pi x^2}{\\pi x^2 - \\frac{3\\pi}{4}x^4 + \\dots} - 1 = \\frac{1}{1 - \\frac{3}{4}x^2 + \\dots} - 1$$\n使用几何级数展开式 $(1-v)^{-1} = 1 + v + v^2 + \\dots$，其中 $v = \\frac{3}{4}x^2$：\n$$\\varepsilon(x) = \\left(1 + \\frac{3}{4}x^2 + O(x^4)\\right) - 1 = \\frac{3}{4}x^2 + O(x^4)$$\n相对误差的首个非零项是 $\\frac{3}{4}x^2$。用 $a/z$ 替换 $x$，我们得到渐近表达式：\n$$\\varepsilon(a/z) \\sim \\frac{3}{4}\\left(\\frac{a}{z}\\right)^2 \\quad \\text{as } a/z \\to 0$$\n\n因此，三个所需的量都已确定。", "answer": "$$ \\boxed{ \\begin{pmatrix} 2\\pi \\left( 1 - \\frac{z}{\\sqrt{a^2+z^2}} \\right) & \\frac{\\pi a^2}{z^2} & \\frac{3}{4} \\left(\\frac{a}{z}\\right)^2 \\end{pmatrix} } $$", "id": "2517646"}, {"introduction": "在几何基础之上，本练习通过分析一个非理想发射表面，引入了物理真实性。您将研究方向性量（如特定位置探测器观测到的辐射亮度）与半球积分量（代表总输出功率）之间的关键区别。这个问题突出了常用的 Lambertian 假设在实际应用中的影响，并锻炼您在不同工程情境下评估该假设有效性的能力 [@problem_id:2517648]。", "problem": "一个面积为 $A_{s}$ 的不透明、等温、灰色面元向真空中发出热辐射。其微观结构导致其行为与理想朗伯行为存在微小的、轴对称的、类镜面反射的角向偏离，这种偏离可以通过对双向反射分布函数（BRDF）的扰动来建模。根据基尔霍夫热辐射定律，对于处于平衡状态的等温表面，其双向发射率等于双向吸收率，因此角发射率可以写为\n$$\\varepsilon(\\theta)=\\varepsilon_{L}\\left[1+\\eta \\cos^{2}\\theta\\right],$$\n其中 $\\varepsilon_{L}\\in(0,1)$ 是朗伯基准发射率，$\\eta$ 是一个无量纲扰动振幅，满足 $|\\eta|<1$，描述了朝向表面法线方向的中等镜面增强效应，而 $\\theta\\in[0,\\pi/2]$ 是从表面法线测量的发射天顶角（单位为弧度）。\n\n令 $L_{b}(T)$ 表示表面在温度 $T$ 时、对所有波长积分后的黑体辐射亮度（一个与方向无关的常数），因此表面的方向发射辐射亮度为 $L_{o}(\\theta)=\\varepsilon(\\theta)\\,L_{b}(T)$。一种常见的工程近似是用朗伯常数 $\\varepsilon_{L}$ 来替代实际的 $\\varepsilon(\\theta)$。\n\n定义面元的半球辐射出射度，\n$$E=\\int_{\\Omega^{+}} L_{o}(\\theta)\\,\\cos\\theta\\,\\mathrm{d}\\omega,$$\n其中 $\\Omega^{+}$ 是外向半球，$\\mathrm{d}\\omega$ 是立体角微元。令 $E_{L}$ 表示在朗伯近似 $\\varepsilon(\\theta)\\equiv\\varepsilon_{L}$ 下获得的值，并令 $\\Delta_{E}=\\left(E-E_{L}\\right)/E_{L}$ 为由非朗伯扰动引起的 $E$ 的相对偏差。\n\n现在，将一个小的平面探测器放置在距离面元 $R=10.0\\,\\mathrm{m}$ 的表面法线轴上，该探测器的孔径相对于源的表观尺寸可忽略不计，且其法线对准并直指该面元。假设面元面积为 $A_{s}=1.00\\times 10^{-4}\\,\\mathrm{m}^{2}$，且远场、小角度条件适用，因此该面元在探测器处所张的立体角为 $\\Omega_{s}\\approx A_{s}/R^{2}$，且入射光线可视为垂直于探测器。探测器上的辐照度为\n$$G=\\int_{\\Omega_{s}} L_{o}(\\theta)\\,\\cos\\theta_{d}\\,\\mathrm{d}\\omega,$$\n其中 $\\theta_{d}$ 是相对于探测器法线的入射角（单位为弧度）。在相同的远场、轴上条件下，使用辐射亮度不变性和适当的小角度近似，用轴上发射辐射亮度来表示 $G$。令 $G_{L}$ 为在朗伯近似下计算的值，并定义相对偏差 $\\Delta_{G}=\\left(G-G_{L}\\right)/G_{L}$。\n\n对于数值参数 $\\varepsilon_{L}=0.85$、$\\eta=0.20$、$A_{s}=1.00\\times 10^{-4}\\,\\mathrm{m}^{2}$ 和 $R=10.0\\,\\mathrm{m}$，计算单个无量纲量\n$$\\kappa=\\frac{\\Delta_{G}}{\\Delta_{E}}.$$\n您必须从辐射亮度、立体角和半球积分的基本定义出发。不要假设任何以朗伯行为为前提的结果。将 $\\kappa$ 的最终答案四舍五入到四位有效数字。将答案表示为无单位的纯数，且所有角度均以弧度为单位。", "solution": "该问题要求计算无量纲量 $\\kappa$，它被定义为两个相对偏差 $\\Delta_{G}$ 和 $\\Delta_{E}$ 的比值。我们将首先计算半球辐射出射度的相对偏差 $\\Delta_{E}$，然后计算探测器辐照度的相对偏差 $\\Delta_{G}$。\n\n首先，我们确定半球辐射出射度 $E$。根据定义，它是方向发射辐射亮度 $L_{o}(\\theta)$ 乘以发射角 $\\theta$ 的余弦，并在外向半球 $\\Omega^{+}$上积分：\n$$E = \\int_{\\Omega^{+}} L_{o}(\\theta)\\,\\cos\\theta\\,\\mathrm{d}\\omega$$\n方向发射辐射亮度由 $L_{o}(\\theta) = \\varepsilon(\\theta)L_{b}(T)$ 给出，其中方向发射率 $\\varepsilon(\\theta) = \\varepsilon_{L}[1+\\eta \\cos^{2}\\theta]$。项 $L_{b}(T)$ 是黑体辐射亮度，一个与方向无关的常数。在球坐标系中，立体角微元为 $\\mathrm{d}\\omega = \\sin\\theta\\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi$，其中 $\\theta$ 是天顶角，范围从 $0$ 到 $\\pi/2$，$\\phi$ 是方位角，范围从 $0$ 到 $2\\pi$。\n\n将这些表达式代入 $E$ 的积分中：\n$$E = \\int_{0}^{2\\pi} \\int_{0}^{\\pi/2} \\left( \\varepsilon_{L}[1+\\eta \\cos^{2}\\theta] L_{b}(T) \\right) \\cos\\theta \\sin\\theta\\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi$$\n被积函数与 $\\phi$ 无关，因此对 $\\phi$ 的积分会得出一个因子 $2\\pi$。常数 $\\varepsilon_{L}$ 和 $L_{b}(T)$ 可以被提出来：\n$$E = 2\\pi \\varepsilon_{L} L_{b}(T) \\int_{0}^{\\pi/2} (1+\\eta \\cos^{2}\\theta) \\cos\\theta \\sin\\theta\\,\\mathrm{d}\\theta$$\n为了计算对 $\\theta$ 的积分，我们进行变量替换。令 $u = \\cos\\theta$，这意味着 $\\mathrm{d}u = -\\sin\\theta\\,\\mathrm{d}\\theta$。积分限从 $\\theta=0$ 变为 $u=1$，从 $\\theta=\\pi/2$ 变为 $u=0$。\n$$E = 2\\pi \\varepsilon_{L} L_{b}(T) \\int_{1}^{0} (1+\\eta u^{2}) u (-\\mathrm{d}u) = 2\\pi \\varepsilon_{L} L_{b}(T) \\int_{0}^{1} (u + \\eta u^{3})\\,\\mathrm{d}u$$\n对 $u$ 进行积分：\n$$E = 2\\pi \\varepsilon_{L} L_{b}(T) \\left[ \\frac{u^{2}}{2} + \\frac{\\eta u^{4}}{4} \\right]_{0}^{1} = 2\\pi \\varepsilon_{L} L_{b}(T) \\left( \\frac{1}{2} + \\frac{\\eta}{4} \\right)$$\n$$E = \\pi \\varepsilon_{L} L_{b}(T) \\left( 1 + \\frac{\\eta}{2} \\right)$$\n在朗伯近似下的半球辐射出射度 $E_{L}$ 对应于使用 $\\varepsilon(\\theta) \\equiv \\varepsilon_{L}$，这等价于在我们推导出的 $E$ 的表达式中设置扰动振幅 $\\eta=0$。\n$$E_{L} = \\pi \\varepsilon_{L} L_{b}(T) \\left( 1 + \\frac{0}{2} \\right) = \\pi \\varepsilon_{L} L_{b}(T)$$\n现在，我们可以计算相对偏差 $\\Delta_{E}$：\n$$\\Delta_{E} = \\frac{E-E_{L}}{E_{L}} = \\frac{\\pi \\varepsilon_{L} L_{b}(T) (1 + \\eta/2) - \\pi \\varepsilon_{L} L_{b}(T)}{\\pi \\varepsilon_{L} L_{b}(T)} = \\frac{1 + \\eta/2 - 1}{1} = \\frac{\\eta}{2}$$\n\n接下来，我们计算探测器上的辐照度 $G$。探测器位于距离很远的 $R$ 处的表面法线轴上，而源面积 $A_{s}$ 很小。这些是远场、小角度条件。辐照度由以下公式给出：\n$$G = \\int_{\\Omega_{s}} L_{o}(\\theta)\\,\\cos\\theta_{d}\\,\\mathrm{d}\\omega$$\n其中 $\\Omega_{s}$ 是源在探测器处所张的小立体角，$\\theta_{d}$ 是在探测器上的入射角。由于轴上和平行平面几何结构，光线的发射角 $\\theta$ 等于其入射角 $\\theta_{d}$。因此，$\\cos\\theta_d = \\cos\\theta$。\n\n问题指明要使用小角度近似，并用轴上发射辐射亮度来表示 $G$。对于从小物面元到达探测器的所有光线，角度 $\\theta$ 都非常接近于 $0$。这使得以下两个近似成立：\n1. 在小立体角 $\\Omega_{s}$ 上，方向发射辐射亮度 $L_{o}(\\theta)$ 可近似为常数，并等于其轴上值 $L_{o}(0)$。\n2. 项 $\\cos\\theta_{d}$ 可近似为 $\\cos(0) = 1$，这也与“入射光线可视为垂直于探测器”的陈述相符。\n\n应用这些近似，$G$ 的积分简化为：\n$$G \\approx \\int_{\\Omega_{s}} L_{o}(0) \\cdot 1 \\cdot \\mathrm{d}\\omega = L_{o}(0) \\int_{\\Omega_{s}} \\mathrm{d}\\omega = L_{o}(0)\\Omega_{s}$$\n轴上辐射亮度 $L_{o}(0)$ 可通过在 $L_{o}(\\theta)$ 表达式中设置 $\\theta=0$ 得到：\n$$L_{o}(0) = \\varepsilon(0) L_{b}(T) = \\varepsilon_{L}[1+\\eta \\cos^{2}(0)] L_{b}(T) = \\varepsilon_{L}(1+\\eta) L_{b}(T)$$\n立体角由 $\\Omega_{s} \\approx A_{s}/R^{2}$ 给出。因此，辐照度为：\n$$G \\approx \\varepsilon_{L}(1+\\eta) L_{b}(T) \\frac{A_{s}}{R^{2}}$$\n在朗伯近似下的辐照度 $G_{L}$，可通过设置 $\\eta=0$ 得到：\n$$G_{L} \\approx \\varepsilon_{L}(1+0) L_{b}(T) \\frac{A_{s}}{R^{2}} = \\varepsilon_{L} L_{b}(T) \\frac{A_{s}}{R^{2}}$$\n那么相对偏差 $\\Delta_{G}$ 为：\n$$\\Delta_{G} = \\frac{G-G_{L}}{G_{L}} \\approx \\frac{\\varepsilon_{L}(1+\\eta) L_{b}(T) (A_{s}/R^{2}) - \\varepsilon_{L} L_{b}(T) (A_{s}/R^{2})}{\\varepsilon_{L} L_{b}(T) (A_{s}/R^{2})} = \\frac{1+\\eta-1}{1} = \\eta$$\n结果 $\\Delta_G = \\eta$ 代表了发射率扰动的局部、轴上效应，而 $\\Delta_E = \\eta/2$ 代表了其半球平均值。\n\n最后，我们计算所求的量 $\\kappa$，即 $\\Delta_{G}$ 与 $\\Delta_{E}$ 的比值：\n$$\\kappa = \\frac{\\Delta_{G}}{\\Delta_{E}} = \\frac{\\eta}{\\eta/2} = 2$$\n这个结果是一个常数，与为 $\\varepsilon_{L}$、$\\eta$、$A_{s}$ 和 $R$ 提供的数值无关。题目要求将答案四舍五入到四位有效数字。\n\n$$\\kappa = 2.000$$", "answer": "$$\\boxed{2.000}$$", "id": "2517648"}, {"introduction": "我们最后的练习转向了高级计算技术，这对于解决复杂的实际辐射传递问题是必不可少的。您将面临的挑战是为辐射通量构建一个 Monte Carlo 估计器，并巧妙地设计一个重要性采样方案以提高其计算效率。通过解析推导方差减小量，您将深入洞察驱动现代热辐射数值模拟的统计学原理 [@problem_id:2517698]。", "problem": "一个表面法线沿极轴的平面黑体微分接收器，受到一个辐射源的照射，该辐射源的谱平均辐射强度在上半球空间（$\\theta\\in[0,\\pi/2]$）具有角向依赖性 $I(\\theta)=I_{0}\\cos^{k}\\theta$，在其他方向为零。其中，$\\theta$ 是从表面法线算起的极角，$k>-1$ 是一个已知的实数参数。所有角度均以弧度为单位。根据基本原理，到达接收器的半球辐射热通量定义为\n$$\nq=\\int_{\\Omega^{+}} I(\\theta)\\,\\cos\\theta\\,d\\omega,\n$$\n其中 $d\\omega=\\sin\\theta\\,d\\theta\\,d\\varphi$ 是微分立体角，积分范围为上半球空间 $\\Omega^{+}$（$\\theta\\in[0,\\pi/2]$，$\\varphi\\in[0,2\\pi)$）。考虑使用蒙特卡罗（MC）估计量来估算 $q$，该估计量基于从一个立体角上的概率密度函数中抽取的随机方向 $(\\theta,\\varphi)$。\n\n- 定义被积函数 $h(\\theta,\\varphi)=I(\\theta)\\cos\\theta$，并为 $q$ 构建两个无偏蒙特卡罗估计量：\n  1. 均匀立体角采样：在半球空间上均匀采样 $(\\theta,\\varphi)$。\n  2. 一种重要性采样方案，该方案以与已知的强度角向形态成正比的概率密度函数进行方向采样，即在 $\\Omega^{+}$ 上 $p(\\theta,\\varphi)\\propto I(\\theta)$。\n\n对于重要性采样方案，推导其归一化的采样密度 $p(\\theta,\\varphi)$、其关于 $\\theta$ 的边缘概率密度，以及一个从 $[0,1]$ 上的均匀随机变量生成 $\\theta$ 的显式逆变换法则。对于每种方案，以 $k$ 和 $I_{0}$ 的函数形式，推导出相应无偏估计量的单样本方差的闭合表达式。最后，通过给出单样本方差的精确比率（均匀采样方差除以重要性采样方差），量化重要性采样方案相对于均匀立体角采样的方差缩减效果，并将结果简化为仅依赖于 $k$ 的单个解析表达式。将最终的方差缩减因子表示为 $k$ 的无单位闭合形式函数。如果您决定计算任何中间数值，仅在必要时进行四舍五入；最终答案必须是精确表达式，而非数值近似。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 接收器特性：平面、黑体、微分，表面法线沿极轴。\n- 辐射源强度：在上半球空间 $\\theta\\in[0,\\pi/2]$ 内为 $I(\\theta)=I_{0}\\cos^{k}\\theta$，其他方向为 $I(\\theta)=0$。\n- 参数约束：$k>-1$ 是一个实数参数。\n- 角度单位：弧度。\n- 半球辐射热通量定义：$q=\\int_{\\Omega^{+}} I(\\theta)\\,\\cos\\theta\\,d\\omega$。\n- 微分立体角：$d\\omega=\\sin\\theta\\,d\\theta\\,d\\varphi$。\n- 积分域：上半球空间 $\\Omega^{+}$，由 $\\theta\\in[0,\\pi/2]$ 和 $\\varphi\\in[0,2\\pi)$ 定义。\n- 被积函数定义：$h(\\theta,\\varphi)=I(\\theta)\\cos\\theta$。\n- 任务：\n  1. 构建一个基于均匀立体角采样的 $q$ 的无偏蒙特卡罗（MC）估计量。\n  2. 构建一个基于重要性采样的 $q$ 的无偏MC估计量，其概率密度函数为 $p(\\theta,\\varphi)\\propto I(\\theta)$。\n  3. 对于重要性采样方案：推导归一化密度 $p(\\theta,\\varphi)$、其关于 $\\theta$ 的边缘概率密度，以及 $\\theta$ 的逆变换法则。\n  4. 对于两种方案：推导单样本方差的闭合形式。\n  5. 计算方差缩减比 $\\sigma_{\\text{uniform}}^2 / \\sigma_{\\text{importance}}^2$ 作为 $k$ 的函数。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，是蒙特卡罗方法在辐射传热中的标准应用，而辐射传热是物理学和工程学中的一个基本课题。辐射强度、立体角和热通量的定义都是标准的。该问题是适定的，提供了推导唯一解析解所需的所有信息、定义和约束条件（例如，$k>-1$ 确保了所需积分的收敛性）。语言客观、精确。该问题未违反任何无效性标准。\n\n**步骤3：结论与行动**\n该问题有效。将提供完整解答。\n\n**求解推导**\n\n问题涉及使用蒙特卡罗积分估计半球辐射热通量 $q$。该积分由下式给出\n$$\nq = \\int_{\\Omega^{+}} I(\\theta)\\cos\\theta\\,d\\omega = \\int_{0}^{2\\pi}d\\varphi \\int_{0}^{\\pi/2} (I_0 \\cos^k\\theta) \\cos\\theta \\sin\\theta\\,d\\theta\n$$\n我们首先计算 $q$ 的精确值。被积函数与 $\\varphi$ 无关，因此对 $\\varphi$ 的积分得到一个因子 $2\\pi$。\n$$\nq = 2\\pi I_0 \\int_{0}^{\\pi/2} \\cos^{k+1}\\theta \\sin\\theta\\,d\\theta\n$$\n我们使用换元法，令 $u = \\cos\\theta$，这意味着 $du = -\\sin\\theta\\,d\\theta$。积分上下限从 $\\theta=0 \\to u=1$ 和 $\\theta=\\pi/2 \\to u=0$ 改变。\n$$\nq = 2\\pi I_0 \\int_{1}^{0} u^{k+1} (-du) = 2\\pi I_0 \\int_{0}^{1} u^{k+1}\\,du = 2\\pi I_0 \\left[ \\frac{u^{k+2}}{k+2} \\right]_0^1 = \\frac{2\\pi I_0}{k+2}\n$$\n该积分在 $k+2 > 0$ 时收敛，即 $k > -2$。问题条件 $k>-1$ 更为严格，并确保了其良定义性。\n\n蒙特卡罗估计的被积函数为 $h(\\theta, \\varphi) = I(\\theta)\\cos\\theta = I_0\\cos^{k+1}\\theta$。\n使用从概率密度函数（PDF）$p(\\theta, \\varphi)$ 中抽取的 $N$ 个样本来估计 $q$ 的无偏MC估计量的一般形式为 $\\hat{q}_N = \\frac{1}{N} \\sum_{j=1}^N \\frac{h(\\theta_j, \\varphi_j)}{p(\\theta_j, \\varphi_j)}$。该估计量的单样本方差由 $\\sigma^2 = \\text{Var}\\left[\\frac{h}{p}\\right] = E\\left[\\left(\\frac{h}{p}\\right)^2\\right] - \\left(E\\left[\\frac{h}{p}\\right]\\right)^2$ 给出。由于该估计量是无偏的，所以 $E[h/p]=q$，因此方差简化为：\n$$\n\\sigma^2 = \\int_{\\Omega^{+}} \\frac{h(\\theta, \\varphi)^2}{p(\\theta, \\varphi)} \\, d\\omega - q^2\n$$\n\n**1. 均匀立体角采样**\n对于半球上的均匀采样，概率密度函数是常数。半球的总立体角为 $\\int_{\\Omega^{+}} d\\omega = \\int_0^{2\\pi}d\\varphi \\int_0^{\\pi/2}\\sin\\theta d\\theta = 2\\pi$ 球面度。\n因此，均匀概率密度函数为 $p_u(\\theta, \\varphi) = 1/(2\\pi)$。\n单样本估计量为 $Y_u = \\frac{h(\\theta, \\varphi)}{p_u(\\theta, \\varphi)} = \\frac{I_0 \\cos^{k+1}\\theta}{1/(2\\pi)} = 2\\pi I_0 \\cos^{k+1}\\theta$。\n方差 $\\sigma_u^2$ 的计算公式为 $\\sigma_u^2 = E[Y_u^2] - q^2$。\n$$\nE[Y_u^2] = \\int_{\\Omega^{+}} Y_u^2 p_u(\\theta, \\varphi) \\, d\\omega = \\int_{\\Omega^{+}} \\frac{h(\\theta, \\varphi)^2}{p_u(\\theta, \\varphi)} \\, d\\omega\n$$\n$$\nE[Y_u^2] = \\int_{0}^{2\\pi}d\\varphi \\int_{0}^{\\pi/2} \\frac{(I_0 \\cos^{k+1}\\theta)^2}{1/(2\\pi)} \\sin\\theta\\,d\\theta = 2\\pi I_0^2 \\int_{0}^{2\\pi}d\\varphi \\int_{0}^{\\pi/2} \\cos^{2(k+1)}\\theta \\sin\\theta\\,d\\theta\n$$\n$$\nE[Y_u^2] = 4\\pi^2 I_0^2 \\int_{0}^{\\pi/2} \\cos^{2k+2}\\theta \\sin\\theta\\,d\\theta\n$$\n使用换元法 $u=\\cos\\theta$，我们得到：\n$$\nE[Y_u^2] = 4\\pi^2 I_0^2 \\int_0^1 u^{2k+2}\\,du = 4\\pi^2 I_0^2 \\left[ \\frac{u^{2k+3}}{2k+3} \\right]_0^1 = \\frac{4\\pi^2 I_0^2}{2k+3}\n$$\n这要求 $2k+3>0$，即 $k>-3/2$。问题条件 $k>-1$ 满足此要求。\n方差为：\n$$\n\\sigma_u^2 = E[Y_u^2] - q^2 = \\frac{4\\pi^2 I_0^2}{2k+3} - \\left(\\frac{2\\pi I_0}{k+2}\\right)^2 = 4\\pi^2 I_0^2 \\left( \\frac{1}{2k+3} - \\frac{1}{(k+2)^2} \\right)\n$$\n$$\n\\sigma_u^2 = 4\\pi^2 I_0^2 \\left( \\frac{(k+2)^2 - (2k+3)}{(2k+3)(k+2)^2} \\right) = 4\\pi^2 I_0^2 \\left( \\frac{k^2+4k+4 - 2k-3}{(2k+3)(k+2)^2} \\right)\n$$\n$$\n\\sigma_u^2 = 4\\pi^2 I_0^2 \\frac{k^2+2k+1}{(2k+3)(k+2)^2} = \\frac{4\\pi^2 I_0^2 (k+1)^2}{(2k+3)(k+2)^2}\n$$\n\n**2. 重要性采样**\n采样概率密度函数与强度成正比，即 $p_i(\\theta, \\varphi) \\propto I(\\theta) = I_0 \\cos^k\\theta$。\n令 $p_i(\\theta, \\varphi) = C \\cos^k\\theta$。我们通过要求 $\\int_{\\Omega^{+}} p_i(\\theta, \\varphi) \\,d\\omega = 1$ 来找到归一化常数 $C$。\n$$\n\\int_{0}^{2\\pi}d\\varphi \\int_{0}^{\\pi/2} C \\cos^k\\theta \\sin\\theta\\,d\\theta = 2\\pi C \\int_{0}^{\\pi/2} \\cos^k\\theta \\sin\\theta\\,d\\theta = 1\n$$\n使用 $u=\\cos\\theta$：\n$$\n2\\pi C \\int_0^1 u^k\\,du = 2\\pi C \\left[ \\frac{u^{k+1}}{k+1} \\right]_0^1 = \\frac{2\\pi C}{k+1} = 1\n$$\n这要求 $k+1>0$，即 $k>-1$，这是给定的。因此，$C = \\frac{k+1}{2\\pi}$。\n归一化的概率密度函数为 $p_i(\\theta, \\varphi) = \\frac{k+1}{2\\pi} \\cos^k\\theta$。\n\n为了求出随机变量 $\\theta$ 的边缘概率密度函数，我们首先通过关系式 $f(\\theta, \\varphi)\\,d\\theta\\,d\\varphi = p_i(\\theta, \\varphi)\\,d\\omega = p_i(\\theta, \\varphi)\\sin\\theta\\,d\\theta\\,d\\varphi$ 建立坐标 $(\\theta, \\varphi)$ 的联合概率密度函数 $f(\\theta, \\varphi)$ 和立体角上的概率密度函数 $p_i(\\theta, \\varphi)$ 的联系。\n所以，$f(\\theta, \\varphi) = p_i(\\theta, \\varphi)\\sin\\theta = \\frac{k+1}{2\\pi}\\cos^k\\theta\\sin\\theta$。\n$\\theta$ 的边缘概率密度函数，记为 $f_\\theta(\\theta)$，通过对 $f(\\theta, \\varphi)$ 关于 $\\varphi$ 积分得到：\n$$\nf_\\theta(\\theta) = \\int_0^{2\\pi} f(\\theta, \\varphi)\\,d\\varphi = \\int_0^{2\\pi} \\frac{k+1}{2\\pi}\\cos^k\\theta\\sin\\theta\\,d\\varphi = (k+1)\\cos^k\\theta\\sin\\theta\n$$\n对于 $\\theta \\in [0, \\pi/2]$。\n\n对于逆变换采样，我们首先计算累积分布函数（CDF）$F_\\theta(\\theta)$：\n$$\nF_\\theta(\\theta) = \\int_0^\\theta f_\\theta(t)\\,dt = \\int_0^\\theta (k+1)\\cos^k t \\sin t\\,dt\n$$\n使用换元法 $u=\\cos t, du=-\\sin t\\,dt$：\n$$\nF_\\theta(\\theta) = (k+1)\\int_{\\cos 0}^{\\cos \\theta} u^k(-du) = (k+1)\\int_{\\cos\\theta}^1 u^k\\,du = (k+1)\\left[\\frac{u^{k+1}}{k+1}\\right]_{\\cos\\theta}^1 = 1 - \\cos^{k+1}\\theta\n$$\n为了生成 $\\theta$ 的一个随机样本，我们设 $F_\\theta(\\theta) = R$，其中 $R$ 是在 $[0,1]$ 上的一个均匀随机变量。\n$R = 1 - \\cos^{k+1}\\theta \\implies \\cos^{k+1}\\theta = 1-R$。由于 $1-R$ 也均匀分布在 $[0,1]$ 上，我们可以写成 $\\cos^{k+1}\\theta = R'$，其中 $R' \\sim U[0,1]$。\n显式的逆变换法则是 $\\theta = \\arccos\\left(R'^{1/(k+1)}\\right)$。\n\n单样本估计量为 $Y_i = \\frac{h(\\theta, \\varphi)}{p_i(\\theta, \\varphi)} = \\frac{I_0\\cos^{k+1}\\theta}{\\frac{k+1}{2\\pi}\\cos^k\\theta} = \\frac{2\\pi I_0}{k+1}\\cos\\theta$。\n方差 $\\sigma_i^2$ 为 $E[Y_i^2] - q^2$。\n$$\nE[Y_i^2] = \\int_{\\Omega^{+}} \\frac{h(\\theta, \\varphi)^2}{p_i(\\theta, \\varphi)} \\, d\\omega = \\int_{\\Omega^{+}} \\frac{(I_0\\cos^{k+1}\\theta)^2}{\\frac{k+1}{2\\pi}\\cos^k\\theta} \\, d\\omega\n$$\n$$\nE[Y_i^2] = \\frac{2\\pi I_0^2}{k+1} \\int_{0}^{2\\pi}d\\varphi \\int_{0}^{\\pi/2} \\cos^{k+2}\\theta \\sin\\theta\\,d\\theta = \\frac{4\\pi^2 I_0^2}{k+1} \\int_{0}^{\\pi/2} \\cos^{k+2}\\theta \\sin\\theta\\,d\\theta\n$$\n该积分等于 $\\frac{1}{k+3}$（要求 $k>-3$，此条件已满足）。\n$$\nE[Y_i^2] = \\frac{4\\pi^2 I_0^2}{(k+1)(k+3)}\n$$\n方差为：\n$$\n\\sigma_i^2 = E[Y_i^2] - q^2 = \\frac{4\\pi^2 I_0^2}{(k+1)(k+3)} - \\left(\\frac{2\\pi I_0}{k+2}\\right)^2 = 4\\pi^2 I_0^2 \\left( \\frac{1}{(k+1)(k+3)} - \\frac{1}{(k+2)^2} \\right)\n$$\n$$\n\\sigma_i^2 = 4\\pi^2 I_0^2 \\left( \\frac{(k+2)^2 - (k+1)(k+3)}{(k+1)(k+3)(k+2)^2} \\right) = 4\\pi^2 I_0^2 \\left( \\frac{k^2+4k+4 - (k^2+4k+3)}{(k+1)(k+3)(k+2)^2} \\right)\n$$\n$$\n\\sigma_i^2 = \\frac{4\\pi^2 I_0^2}{(k+1)(k+2)^2(k+3)}\n$$\n\n**3. 方差缩减比**\n最后，我们计算方差之比，以量化重要性采样方案的有效性。\n$$\n\\frac{\\sigma_u^2}{\\sigma_i^2} = \\frac{\\frac{4\\pi^2 I_0^2 (k+1)^2}{(2k+3)(k+2)^2}}{\\frac{4\\pi^2 I_0^2}{(k+1)(k+2)^2(k+3)}}\n$$\n$$\n\\frac{\\sigma_u^2}{\\sigma_i^2} = \\frac{(k+1)^2}{(2k+3)(k+2)^2} \\cdot \\frac{(k+1)(k+2)^2(k+3)}{1}\n$$\n$$\n\\frac{\\sigma_u^2}{\\sigma_i^2} = \\frac{(k+1)^3(k+3)}{2k+3}\n$$\n此表达式即为方差缩减因子的完整最终答案。根据规定，它在 $k>-1$ 时有效。", "answer": "$$\n\\boxed{\\frac{(k+1)^3(k+3)}{2k+3}}\n$$", "id": "2517698"}]}