{"hands_on_practices": [{"introduction": "在任何计算流体动力学（CFD）模拟开始之前，首要任务是建立正确的数学模型。这通常涉及到根据具体问题的物理特性，对完整的控制方程进行简化。无量纲分析是实现这一目标的强大工具，它使我们能够量化和比较不同物理效应的相对重要性。\n\n本练习 [@problem_id:2497439] 将指导您计算微通道流动的关键无量纲数，并基于这些数值做出明智的判断：在能量方程中是否需要包含粘性耗散项。这个过程是CFD建模中确保计算效率和物理保真度的核心步骤。", "problem": "一位换热器设计师考虑使用计算流体动力学 (CFD) 模型，模拟一种在矩形微通道中流动的稳态、不可压缩、常物性牛顿流体。该液体是甘油，其主体温度接近 $40\\,^{\\circ}\\mathrm{C}$，具有以下（假定为常数的）物性参数：密度 $\\rho = 1260\\,\\mathrm{kg/m^3}$，动力粘度 $\\mu = 0.200\\,\\mathrm{Pa\\cdot s}$，导热系数 $k = 0.285\\,\\mathrm{W/(m\\cdot K)}$，以及定压比热容 $c_p = 2400\\,\\mathrm{J/(kg\\cdot K)}$。流动的主体速度为 $U = 2.00\\,\\mathrm{m/s}$，特征长度为 $L = 4.00\\,\\mathrm{mm}$（使用水力直径作为特征长度）。壁面与入口流体之间的代表性温差为 $\\Delta T = 5.00\\,\\mathrm{K}$。\n\n从质量、动量和能量守恒定律出发，并使用长度特征尺度 $L$、速度特征尺度 $U$ 和温度特征尺度 $\\Delta T$ 进行无量纲化，辨识相关的无量纲数群并计算它们的值：本案例中的雷诺数 $Re$、普朗特数 $Pr$、佩克莱数 $Pe$ 和埃克特数 $Ec$。然后，基于无量纲能量方程进行数量级分析，论证对于此流动的 CFD 模拟，是否必须将粘性耗散项包含在能量方程中。\n\n以单个数字形式报告您的最终决定：如果必须包含粘性耗散，则填写 $1$；如果可以忽略，则填写 $0$。不要在最终答案中报告任何中间量。", "solution": "该问题要求基于对无量纲控制方程的数量级分析，评估在给定流动场景下，将粘性耗散项包含在能量方程中的必要性。这是建立任何用于传热的计算流体动力学 (CFD) 模型的关键步骤，因为它决定了哪些物理现象必须被求解。\n\n出发点是适用于稳态、不可压缩、常物性牛顿流体的能量守恒定律。热能方程如下：\n$$ \\rho c_p (\\mathbf{u} \\cdot \\nabla) T = k \\nabla^2 T + \\Phi_v $$\n此处，$\\rho$ 是密度，$c_p$ 是定压比热容，$\\mathbf{u}$ 是速度矢量，$T$ 是温度，$k$ 是导热系数，$\\Phi_v$ 是粘性耗散函数，它表示由粘性应力所做的不可逆功的速率，将动能转化为内能。对于牛顿流体，$\\Phi_v$ 由速度梯度的二次型给出。\n\n为了进行数量级分析，我们对该方程进行无量纲化。我们引入以下基于所提供特征尺度的无量纲变量（用星号 $*$ 表示）：长度尺度 $L$、速度尺度 $U$ 和温度尺度 $\\Delta T$。\n$$ x_i^* = \\frac{x_i}{L}, \\quad u_i^* = \\frac{u_i}{U}, \\quad T^* = \\frac{T - T_{ref}}{\\Delta T} $$\n其中 $T_{ref}$ 是一个参考温度，例如入口温度。微分算子变换为 $\\nabla = \\frac{1}{L}\\nabla^*$ 和 $\\nabla^2 = \\frac{1}{L^2}\\nabla^{*2}$。粘性耗散函数的量级为 $\\Phi_v \\sim \\mu (U/L)^2$。将这些代入能量方程，得到：\n$$ \\rho c_p \\left( (U \\mathbf{u}^*) \\cdot \\frac{1}{L}\\nabla^* \\right) (\\Delta T \\cdot T^*) = k \\frac{\\Delta T}{L^2} \\nabla^{*2} T^* + \\mathcal{O}\\left(\\frac{\\mu U^2}{L^2}\\right) $$\n整理各项：\n$$ \\left( \\frac{\\rho c_p U \\Delta T}{L} \\right) (\\mathbf{u}^* \\cdot \\nabla^*) T^* = \\left( \\frac{k \\Delta T}{L^2} \\right) \\nabla^{*2} T^* + \\left( \\frac{\\mu U^2}{L^2} \\right) \\Phi_v^* $$\n其中 $\\Phi_v^*$ 是量级为 1 的无量纲粘性耗散函数。\n\n为了比较各项的相对大小，我们对该方程进行归一化。一种具有物理意义的归一化方法是，将方程各项除以传导项的系数 $\\frac{k \\Delta T}{L^2}$：\n$$ \\left( \\frac{\\rho c_p U L}{k} \\right) (\\mathbf{u}^* \\cdot \\nabla^*) T^* = \\nabla^{*2} T^* + \\left( \\frac{\\mu U^2}{k \\Delta T} \\right) \\Phi_v^* $$\n从这个方程中，我们辨识出相关的无量纲数群。对流项的系数是佩克莱数 $Pe$。粘性耗散项的系数是布林克曼数 $Br$。\n$$ Pe = \\frac{\\rho c_p U L}{k} = \\frac{\\rho U L}{\\mu} \\cdot \\frac{\\mu c_p}{k} = Re \\cdot Pr $$\n$$ Br = \\frac{\\mu U^2}{k \\Delta T} = \\frac{U^2}{c_p \\Delta T} \\cdot \\frac{\\mu c_p}{k} = Ec \\cdot Pr $$\n因此，无量纲能量方程为：\n$$ Pe \\, (\\mathbf{u}^* \\cdot \\nabla^*) T^* = \\nabla^{*2} T^* + Br \\, \\Phi_v^* $$\n只有当 $Br \\, \\Phi_v^*$ 项远小于其他项，特别是远小于总是存在且定义了热边界条件响应的传导项 $\\nabla^{*2} T^*$ 时，粘性耗散才是可以忽略的。因此，忽略粘性耗散的准则为 $Br \\ll 1$。\n\n现在我们使用给定的数据计算这些无量纲数：\n- 密度：$\\rho = 1260\\,\\mathrm{kg/m^3}$\n- 动力粘度：$\\mu = 0.200\\,\\mathrm{Pa\\cdot s}$\n- 导热系数：$k = 0.285\\,\\mathrm{W/(m\\cdot K)}$\n- 比热容：$c_p = 2400\\,\\mathrm{J/(kg\\cdot K)}$\n- 主体速度：$U = 2.00\\,\\mathrm{m/s}$\n- 特征长度：$L = 4.00\\,\\mathrm{mm} = 4.00 \\times 10^{-3}\\,\\mathrm{m}$\n- 温差：$\\Delta T = 5.00\\,\\mathrm{K}$\n\n雷诺数 $Re$ 为：\n$$ Re = \\frac{\\rho U L}{\\mu} = \\frac{(1260\\,\\mathrm{kg/m^3}) (2.00\\,\\mathrm{m/s}) (4.00 \\times 10^{-3}\\,\\mathrm{m})}{0.200\\,\\mathrm{Pa\\cdot s}} = 50.4 $$\n普朗特数 $Pr$ 为：\n$$ Pr = \\frac{\\mu c_p}{k} = \\frac{(0.200\\,\\mathrm{Pa\\cdot s}) (2400\\,\\mathrm{J/(kg\\cdot K)})}{0.285\\,\\mathrm{W/(m\\cdot K)}} = \\frac{480}{0.285} \\approx 1684.2 $$\n埃克特数 $Ec$ 为：\n$$ Ec = \\frac{U^2}{c_p \\Delta T} = \\frac{(2.00\\,\\mathrm{m/s})^2}{(2400\\,\\mathrm{J/(kg\\cdot K)}) (5.00\\,\\mathrm{K})} = \\frac{4}{12000} = \\frac{1}{3000} \\approx 3.33 \\times 10^{-4} $$\n佩克莱数 $Pe$ 为：\n$$ Pe = Re \\cdot Pr = 50.4 \\times \\frac{480}{0.285} \\approx 84884 $$\n高佩克莱数表明传热在主流区由对流主导。然而，决定壁面热通量的固体表面附近各项的平衡情况，需要考察布林克曼数。\n\n布林克曼数 $Br$ 为：\n$$ Br = Ec \\cdot Pr = \\left(\\frac{1}{3000}\\right) \\left(\\frac{480}{0.285}\\right) = \\frac{480}{855} = \\frac{32}{57} \\approx 0.5614 $$\n布林克曼数的值为 $Br \\approx 0.56$。这个值并不远小于 $1$。它表明由粘性力产生的热量与由分子传导输运的热量处于同一数量级（约占 $56\\%$）。在一个旨在精确预测温度场和传热率的 CFD 模拟中，特别是在速度梯度很大的近壁面高剪切区域，这样一个相对大小的源项若被忽略，将会引入显著的误差。\n\n因此，为了对此微通道流动进行具有物理真实性的模拟，能量方程中必须包含粘性耗散项。最终的决定是包含该项，这对应于数值 $1$。", "answer": "$$\n\\boxed{1}\n$$", "id": "2497439"}, {"introduction": "确定了控制方程之后，下一步是将其离散化，转换成计算机可以求解的代数方程组。离散格式的选择至关重要，因为它直接影响解的精度和稳定性，是CFD方法的核心。\n\n在此练习 [@problem_id:2497371] 中，您将亲手实现并比较两种基本格式——一阶迎风格式和二阶中心差分格式——来求解经典的一维对流扩散问题。通过将数值解与精确解进行对比，您将亲身体验数值扩散和非物理振荡这两个CFD中的关键挑战，并理解单元格佩克莱数（cell Peclet number）在其中的作用。", "problem": "考虑一个一维、稳态的对流-扩散问题，求解域为 $x \\in [0,L]$ 上的标量温度场 $T(x)$。该问题具有恒定的物性参数和 Dirichlet 边界条件。控制微分方程由能量守恒和具有常系数的 Fickian 扩散导出：$$\\frac{d}{dx}\\left(\\Gamma \\frac{dT}{dx}\\right) - \\rho u \\frac{dT}{dx} = 0,$$ 其中 $\\Gamma$ 是扩散系数，$\\rho$ 是密度， $u$ 是 x 正方向上的均匀流速。Dirichlet 边界条件为 $T(0)=T_L$ 和 $T(L)=T_R$。假设 $\\Gamma>0$, $\\rho \\ge 0$ 且 $u \\ge 0$。从此基本方程出发，使用包含 $N$ 个区间的均匀网格（因此 $\\Delta x = L/N$），为内部网格点推导一个相容的有限差分离散格式。对流导数项采用以下两种近似方法：(a) 一阶迎风格式（适用于 $u \\ge 0$）和 (b) 二阶中心差分格式。在两种情况下，扩散项均使用中心差分格式。利用 Dirichlet 数据处理边界，不引入额外的未知数。对每种格式，为内部未知量建立并求解所得的线性方程组。\n\n您的程序还必须通过解析求解相关的常微分方程来推导并实现该微分方程的精确连续解，应用边界条件，并在网格节点 $x_j = j \\Delta x$（其中 $j = 0,1,\\dots,N$）上计算其值。\n\n定义网格 Peclet 数为 $$\\mathrm{Pe}_{\\Delta x} = \\frac{\\rho u \\Delta x}{\\Gamma}。$$ 对于下面的每个测试用例，计算并报告以下量：\n- $\\mathrm{Pe}_{\\Delta x}$ 的值，为一个非负实数。\n- 中心差分格式的离散节点解与精确解之间的最大范数误差（绝对值），在所有网格节点上进行评估，表示为一个实数。\n- 一阶迎风格式的离散节点解与精确解之间的最大范数误差（绝对值），在所有网格节点上进行评估，表示为一个实数。\n- 一个布尔值，指示中心差分格式的离散解在所有网格节点（包括边界）上是否都界于 $\\min(T_L,T_R)$ 和 $\\max(T_L,T_R)$ 之间。\n\n测试套件由以下参数集组成，旨在探测 $\\mathrm{Pe}_{\\Delta x}$ 的不同区域（其中 $L$、$T_L$ 和 $T_R$ 保持不变）：\n- 用例 A（扩散主导，一般情况）：$L=1$, $T_L=0$, $T_R=1$, $\\rho=1$, $u=0.2$, $\\Gamma=1$, $N=50$。\n- 用例 B（接近中心差分单调性极限）：$L=1$, $T_L=0$, $T_R=1$, $\\rho=1$, $u=4$, $\\Gamma=0.2$, $N=10$。\n- 用例 C（对流主导，中心差分可能出现振荡）：$L=1$, $T_L=0$, $T_R=1$, $\\rho=1$, $u=10$, $\\Gamma=0.1$, $N=10$。\n- 用例 D（纯扩散边界情况）：$L=1$, $T_L=0$, $T_R=1$, $\\rho=1$, $u=0$, $\\Gamma=1$, $N=20$。\n\n由于控制方程中隐含的无量纲化，所有量都是无量纲的；因此不需要也无需报告物理单位。不涉及角度，也不使用百分比。\n\n您的程序应生成单行输出，包含一个由逗号分隔的列表组成的列表，每个子列表对应一个测试用例，顺序与上文所列相同。每个子列表的形式必须为 $[\\mathrm{Pe}_{\\Delta x}, e_\\infty^{\\mathrm{central}}, e_\\infty^{\\mathrm{upwind}}, \\text{bounded}_{\\mathrm{central}}]$，其中 $e_\\infty$ 表示最大范数误差，$\\text{bounded}_{\\mathrm{central}}$ 是一个布尔值。例如，输出格式必须类似于 $[[a,b,c,\\mathrm{True}],[d,e,f,\\mathrm{False}],\\dots]$，用相应的数值替换，并打印在单行上。", "solution": "所给出的问题是计算流体力学领域一个标准的、适定的练习，具体涉及一维稳态对流-扩散方程的数值解。该问题在科学上是合理的，其参数定义清晰。因此，可以构造出解决方案。\n\n任务是分析和比较两种有限差分格式与控制方程的精确解析解：\n$$\n\\frac{d}{dx}\\left(\\Gamma \\frac{dT}{dx}\\right) - \\rho u \\frac{dT}{dx} = 0\n$$\n鉴于扩散系数 $\\Gamma$、密度 $\\rho$ 和速度 $u$ 均为常数，该方程可简化为一个具有常系数的二阶线性常微分方程 (ODE)：\n$$\n\\Gamma \\frac{d^2T}{dx^2} - \\rho u \\frac{dT}{dx} = 0\n$$\n求解域为 $x \\in [0, L]$，具有 Dirichlet 边界条件 $T(0) = T_L$ 和 $T(L) = T_R$。\n\n首先，我们推导精确解析解。该 ODE 对应的特征方程是：\n$$\n\\Gamma r^2 - \\rho u r = 0 \\implies r(\\Gamma r - \\rho u) = 0\n$$\n其根为 $r_1 = 0$ 和 $r_2 = \\frac{\\rho u}{\\Gamma}$。\n\n情况 1：$\\rho u \\neq 0$。\n通解的形式为 $T(x) = C_1 e^{r_1 x} + C_2 e^{r_2 x}$，即：\n$$\nT(x) = C_1 + C_2 e^{(\\rho u / \\Gamma) x}\n$$\n常数 $C_1$ 和 $C_2$ 通过应用边界条件来确定：\n$T(0) = T_L \\implies C_1 + C_2 = T_L$\n$T(L) = T_R \\implies C_1 + C_2 e^{(\\rho u L / \\Gamma)} = T_R$\n\n求解这个二元线性方程组可得：\n$C_2 = \\frac{T_R - T_L}{e^{(\\rho u L / \\Gamma)} - 1}$\n$C_1 = T_L - C_2 = T_L - \\frac{T_R - T_L}{e^{(\\rho u L / \\Gamma)} - 1}$\n\n将这些常数代回通解，得到精确解：\n$$\nT(x) = T_L + (T_R - T_L) \\frac{e^{(\\rho u x / \\Gamma)} - 1}{e^{(\\rho u L / \\Gamma)} - 1}\n$$\n\n情况 2：$\\rho u = 0$。\n控制方程简化为 $\\Gamma \\frac{d^2T}{dx^2} = 0$，由于 $\\Gamma > 0$，这意味着 $\\frac{d^2T}{dx^2} = 0$。通解是一个线性函数：\n$$\nT(x) = C_1 x + C_2\n$$\n应用边界条件：\n$T(0) = T_L \\implies C_2 = T_L$\n$T(L) = T_R \\implies C_1 L + C_2 = T_R \\implies C_1 = \\frac{T_R - T_L}{L}$\n\n纯扩散情况的精确解是：\n$$\nT(x) = T_L + (T_R - T_L) \\frac{x}{L}\n$$\n这个结果也是情况 1 的解在 $\\rho u \\to 0$ 时的极限，这可以使用 L'Hôpital 法则进行验证。\n\n接下来，我们建立有限差分格式。将区域离散为 $N$ 个大小为 $\\Delta x = L/N$ 的均匀区间。网格点为 $x_j = j \\Delta x$，其中 $j = 0, 1, \\dots, N$。这些点上的温度记为 $T_j = T(x_j)$。$T_0 = T_L$ 和 $T_N = T_R$ 的值是已知的。我们需要求解 $N-1$ 个内部点 $T_1, \\dots, T_{N-1}$ 的解。\n\n在任何内部节点 $j \\in \\{1, \\dots, N-1\\}$，我们对控制方程进行离散化。扩散项使用二阶中心差分格式进行近似：\n$$\n\\Gamma \\frac{d^2T}{dx^2}\\bigg|_j \\approx \\Gamma \\frac{T_{j+1} - 2T_j + T_{j-1}}{(\\Delta x)^2}\n$$\n对流项 $-\\rho u \\frac{dT}{dx}$ 通过两种方式进行近似。\n\n(a) 一阶迎风 (FOU) 格式：\n对于 $u \\ge 0$，流动方向为 x 正方向，因此“迎风”信息来自节点 $j-1$。\n$$\n-\\rho u \\frac{dT}{dx}\\bigg|_j \\approx -\\rho u \\frac{T_j - T_{j-1}}{\\Delta x}\n$$\n合并各项，离散化方程为：\n$$\n\\Gamma \\frac{T_{j+1} - 2T_j + T_{j-1}}{(\\Delta x)^2} - \\rho u \\frac{T_j - T_{j-1}}{\\Delta x} = 0\n$$\n两边乘以 $(\\Delta x)^2 / \\Gamma$ 并引入网格 Peclet 数 $\\mathrm{Pe}_{\\Delta x} = \\frac{\\rho u \\Delta x}{\\Gamma}$：\n$$\n(T_{j+1} - 2T_j + T_{j-1}) - \\mathrm{Pe}_{\\Delta x} (T_j - T_{j-1}) = 0\n$$\n按节点温度分组，我们得到节点 $j$ 的代数方程：\n$$\n(1 + \\mathrm{Pe}_{\\Delta x}) T_{j-1} - (2 + \\mathrm{Pe}_{\\Delta x}) T_j + T_{j+1} = 0\n$$\n\n(b) 二阶中心差分 (CD) 格式：\n对流项使用二阶中心差分进行近似：\n$$\n-\\rho u \\frac{dT}{dx}\\bigg|_j \\approx -\\rho u \\frac{T_{j+1} - T_{j-1}}{2 \\Delta x}\n$$\n离散化方程变为：\n$$\n\\Gamma \\frac{T_{j+1} - 2T_j + T_{j-1}}{(\\Delta x)^2} - \\rho u \\frac{T_{j+1} - T_{j-1}}{2 \\Delta x} = 0\n$$\n乘以 $(\\Delta x)^2 / \\Gamma$：\n$$\n(T_{j+1} - 2T_j + T_{j-1}) - \\frac{\\mathrm{Pe}_{\\Delta x}}{2} (T_{j+1} - T_{j-1}) = 0\n$$\n按节点温度分组：\n$$\n\\left(1 + \\frac{\\mathrm{Pe}_{\\Delta x}}{2}\\right) T_{j-1} - 2 T_j + \\left(1 - \\frac{\\mathrm{Pe}_{\\Delta x}}{2}\\right) T_{j+1} = 0\n$$\n众所周知，如果 $|\\mathrm{Pe}_{\\Delta x}| > 2$，该格式会产生非物理振荡，因为 $T_{j+1}$ 的系数变为负数，这违反了离散极值原理的条件。\n\n对于这两种格式，我们为 $N-1$ 个未知的内部温度组装一个包含 $N-1$ 个线性方程的方程组。该系统是三对角的，可以写成 $A \\mathbf{T} = \\mathbf{b}$ 的形式，其中 $\\mathbf{T} = [T_1, T_2, \\dots, T_{N-1}]^T$。\n\n对于 FOU 格式，节点 $j$ 处方程的系数为：\n- 次对角线 ($T_{j-1}$): $l = 1 + \\mathrm{Pe}_{\\Delta x}$\n- 主对角线 ($T_j$): $d = -(2 + \\mathrm{Pe}_{\\Delta x})$\n- 超对角线 ($T_{j+1}$): $u = 1$\n\n对于 CD 格式，系数为：\n- 次对角线 ($T_{j-1}$): $l = 1 + \\frac{\\mathrm{Pe}_{\\Delta x}}{2}$\n- 主对角线 ($T_j$): $d = -2$\n- 超对角线 ($T_{j+1}$): $u = 1 - \\frac{\\mathrm{Pe}_{\\Delta x}}{2}$\n\n右端向量 $\\mathbf{b}$ 是通过将已知边界项 $T_0=T_L$ 和 $T_N=T_R$ 移到节点 $j=1$ 和 $j=N-1$ 方程的右侧而形成的。\n对于 $j=1$: $d T_1 + u T_2 = -l T_0 = -l T_L$\n对于 $j=N-1$: $l T_{N-2} + d T_{N-1} = -u T_N = -u T_R$\n\n程序将实现此逻辑，为两种格式构建并求解三对角系统，在网格节点上评估精确解，并为每个测试用例计算所需的误差范数和有界性。\n最大范数误差定义为 $e_{\\infty} = \\max_{j=0, \\dots, N} |T_j^{\\text{numerical}} - T_j^{\\text{exact}}|$。\n中心差分格式的有界性检查用于验证对于所有 $j$，$T_j$ 是否保持在边界值范围 $[\\min(T_L, T_R), \\max(T_L, T_R)]$ 内。\n\n该实现将利用 `scipy.linalg.solve_banded` 来高效求解三对角系统。", "answer": "```text\n[[0.04,2.768682e-06,0.000109121,True],[2.0,0.00244018,0.0347313,True],[10.0,1.25925,0.444444,False],[0.0,1.110223e-16,1.110223e-16,True]]\n```", "id": "2497371"}, {"introduction": "我们如何确信编写的CFD代码正确地求解了我们预设的方程？代码验证（Code Verification）是一个严谨的过程，用于检查代码实现中是否存在错误。人造解方法（Method of Manufactured Solutions, MMS）是用于此目的的一种强大而形式化的技术。\n\n本练习 [@problem_id:2497372] 将引导您完成MMS的整个流程。您将推导一个解析源项，该源项强制一个预设的“人造”函数成为能量方程的精确解，从而创造一个具有已知解的基准问题，用以严格测试数值求解器的精度和正确性。", "problem": "一种二维、稳态、不可压缩的牛顿流体，其物性恒定，占据一个边长为 $L$ 的正方形区域，笛卡尔坐标为 $(x,y)\\in[0,L]\\times[0,L]$。密度为 $\\rho$，定压比热容为 $c_p$，热导率为 $k$。粘性耗散和压力功可忽略不计。速度场是给定的且无散度。在计算流体力学（CFD）入门的背景下，要求您对能量方程使用人造解方法（Method of Manufactured Solutions, MMS）。\n\n首先，从能量守恒原理出发，简要阐述在此情景下应用于能量方程的人造解方法（MMS）的逻辑步骤。\n\n然后，考虑以下人造温度场和无散度速度场：\n- 人造温度：$T(x,y)=T_0+\\Theta \\sin\\!\\big(\\tfrac{\\pi x}{L}\\big)\\cos\\!\\big(\\tfrac{\\pi y}{L}\\big)$，其中 $T_0$ 和 $\\Theta$ 是常数。\n- 速度场：$u(x,y)=U_0 \\cos\\!\\big(\\tfrac{\\pi y}{L}\\big)$ 和 $v(x,y)=U_0 \\sin\\!\\big(\\tfrac{\\pi x}{L}\\big)$，其中 $U_0$ 是一个常数。\n\n从稳态、不可压缩、物性恒定的流动（具有所述建模假设）的能量守恒出发，推导温度方程的强形式，并构造人造体积热源项 $S(x,y)$，使得给定的 $T(x,y)$ 是该方程在整个区域内的精确解。将您最终的人造源项 $S(x,y)$ 表示为包含 $x$、$y$、$L$、$\\rho$、$c_p$、$k$、$U_0$、$T_0$ 和 $\\Theta$ 的单个封闭形式的解析表达式。不要近似或四舍五入；以精确形式给出答案。三角函数参数必须以弧度解释。将最终的 $S(x,y)$ 以国际单位制（SI）表示为 $\\text{W}\\,\\text{m}^{-3}$。", "solution": "对问题陈述进行验证。\n\n**步骤一：提取已知条件**\n- **区域**：二维正方形区域，$(x,y) \\in [0,L] \\times [0,L]$。\n- **流体**：牛顿流体，稳态、不可压缩流动，物性恒定。\n- **物性**：密度 $\\rho$，定压比热容 $c_p$，热导率 $k$。\n- **假设**：粘性耗散和压力功可忽略不计。\n- **速度场**：给定的无散度场，分量为 $u(x,y)=U_0 \\cos(\\frac{\\pi y}{L})$ 和 $v(x,y)=U_0 \\sin(\\frac{\\pi x}{L})$。$U_0$ 是一个常数。\n- **人造温度场**：$T(x,y)=T_0+\\Theta \\sin(\\frac{\\pi x}{L})\\cos(\\frac{\\pi y}{L})$，其中 $T_0$ 和 $\\Theta$ 是常数。\n- **任务**：阐述人造解方法（MMS），推导温度方程的强形式，并构造人造体积热源项 $S(x,y)$，使给定的 $T(x,y)$ 成为精确解。\n\n**步骤二：使用提取的已知条件进行验证**\n该问题具有科学依据，基于能量守恒基本原理和一种标准的代码验证技术（MMS）。语言客观而精确。问题是自洽的。一致性的一个必要条件是所给定的速度场必须如所述是无散度的。我们对此进行验证：\n$$\n\\nabla \\cdot \\mathbf{v} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\n$$\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ U_0 \\cos\\left(\\frac{\\pi y}{L}\\right) \\right] = 0\n$$\n$$\n\\frac{\\partial v}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ U_0 \\sin\\left(\\frac{\\pi x}{L}\\right) \\right] = 0\n$$\n因此，$\\nabla \\cdot \\mathbf{v} = 0 + 0 = 0$。速度场确实是无散度的，这证实了问题陈述的内部一致性。问题要求为给定解构造一个源项，这是一个适定的过程。未检测到科学、逻辑或结构上的缺陷。\n\n**步骤三：结论与行动**\n该问题有效。将提供解答。\n\n首先，应用于能量方程的人造解方法（MMS）的逻辑步骤如下：\n$1$. 选择控制性偏微分方程（PDE），对于本问题即为能量守恒方程。\n$2$. 假设或“制造”一个光滑的解析函数作为解变量，本例中即为温度场 $T(x,y)$。\n$3$. 将此人造解及其导数代入控制性偏微分方程。由于该函数不是原始齐次方程的精确解，代入后将产生非零残差。\n$4$. 定义一个源项 $S(x,y)$，使其等于该残差。这将原始偏微分方程重新定义为一个新的非齐次方程。\n$5$. 通过构造，人造函数 $T(x,y)$ 现在是这个新的非齐次偏微分方程的一个精确解析解。这个具有已知解析解的新问题，可用于严格验证数值代码的准确性和实现。\n\n接下来，我们推导温度方程的强形式。对于物性恒定的不可压缩流体，能量守恒方程的一般形式为：\n$$\n\\rho c_p \\left( \\frac{\\partial T}{\\partial t} + \\mathbf{v} \\cdot \\nabla T \\right) = \\nabla \\cdot (k \\nabla T) + S_{visc} + \\beta T \\frac{Dp}{Dt} + \\dot{q}\n$$\n应用问题陈述的假设：\n- 稳态：$\\frac{\\partial T}{\\partial t} = 0$。\n- 物性恒定：$\\rho$、$c_p$ 和 $k$ 是常数。扩散项变为 $k \\nabla^2 T$。\n- 粘性耗散（$S_{visc}$）和压力功（$\\beta T \\frac{Dp}{Dt}$）可忽略：这些项为零。\n- 项 $\\dot{q}$ 是体积热源，我们将其表示为 $S(x,y)$。\n\n最终得到的温度方程强形式为：\n$$\n\\rho c_p (\\mathbf{v} \\cdot \\nabla T) = k \\nabla^2 T + S(x,y)\n$$\n在二维笛卡尔坐标系中，这展开为：\n$$\n\\rho c_p \\left( u \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} \\right) = k \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} \\right) + S(x,y)\n$$\n为了构造人造源项，我们重新整理此方程以求解 $S(x,y)$：\n$$\nS(x,y) = \\rho c_p \\left( u \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} \\right) - k \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} \\right)\n$$\n现在，我们计算人造温度场 $T(x,y)=T_0+\\Theta \\sin(\\frac{\\pi x}{L})\\cos(\\frac{\\pi y}{L})$ 的必要导数。\n一阶偏导数为：\n$$\n\\frac{\\partial T}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ T_0+\\Theta \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right) \\right] = \\Theta \\left(\\frac{\\pi}{L}\\right) \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right)\n$$\n$$\n\\frac{\\partial T}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ T_0+\\Theta \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right) \\right] = -\\Theta \\left(\\frac{\\pi}{L}\\right) \\sin\\left(\\frac{\\pi x}{L}\\right)\\sin\\left(\\frac{\\pi y}{L}\\right)\n$$\n二阶偏导数为：\n$$\n\\frac{\\partial^2 T}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left[ \\Theta \\left(\\frac{\\pi}{L}\\right) \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right) \\right] = -\\Theta \\left(\\frac{\\pi}{L}\\right)^2 \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right)\n$$\n$$\n\\frac{\\partial^2 T}{\\partial y^2} = \\frac{\\partial}{\\partial y} \\left[ -\\Theta \\left(\\frac{\\pi}{L}\\right) \\sin\\left(\\frac{\\pi x}{L}\\right)\\sin\\left(\\frac{\\pi y}{L}\\right) \\right] = -\\Theta \\left(\\frac{\\pi}{L}\\right)^2 \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right)\n$$\n现在，我们使用速度分量 $u(x,y)=U_0 \\cos(\\frac{\\pi y}{L})$ 和 $v(x,y)=U_0 \\sin(\\frac{\\pi x}{L})$ 来构建对流项 $\\rho c_p (u \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y})$。\n$$\nu \\frac{\\partial T}{\\partial x} = \\left( U_0 \\cos\\left(\\frac{\\pi y}{L}\\right) \\right) \\left( \\Theta \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right) \\right) = \\frac{\\pi U_0 \\Theta}{L} \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos^2\\left(\\frac{\\pi y}{L}\\right)\n$$\n$$\nv \\frac{\\partial T}{\\partial y} = \\left( U_0 \\sin\\left(\\frac{\\pi x}{L}\\right) \\right) \\left( -\\Theta \\frac{\\pi}{L} \\sin\\left(\\frac{\\pi x}{L}\\right)\\sin\\left(\\frac{\\pi y}{L}\\right) \\right) = -\\frac{\\pi U_0 \\Theta}{L} \\sin^2\\left(\\frac{\\pi x}{L}\\right)\\sin\\left(\\frac{\\pi y}{L}\\right)\n$$\n完整的对流项是：\n$$\n\\rho c_p \\left( u \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} \\right) = \\frac{\\pi \\rho c_p U_0 \\Theta}{L} \\left[ \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos^2\\left(\\frac{\\pi y}{L}\\right) - \\sin^2\\left(\\frac{\\pi x}{L}\\right)\\sin\\left(\\frac{\\pi y}{L}\\right) \\right]\n$$\n接下来，我们构建扩散项 $-k (\\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2})$。\n$$\n\\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} = -\\Theta \\left(\\frac{\\pi}{L}\\right)^2 \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right) - \\Theta \\left(\\frac{\\pi}{L}\\right)^2 \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right) = -2 \\Theta \\left(\\frac{\\pi}{L}\\right)^2 \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right)\n$$\n需要减去的扩散贡献为：\n$$\n-k \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} \\right) = -k \\left[ -2 \\Theta \\left(\\frac{\\pi}{L}\\right)^2 \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right) \\right] = \\frac{2 \\pi^2 k \\Theta}{L^2} \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right)\n$$\n最后，我们将对流项和扩散项组合起来，得到人造源项 $S(x,y)$：\n$$\nS(x,y) = \\frac{\\pi \\rho c_p U_0 \\Theta}{L} \\left[ \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos^2\\left(\\frac{\\pi y}{L}\\right) - \\sin^2\\left(\\frac{\\pi x}{L}\\right)\\sin\\left(\\frac{\\pi y}{L}\\right) \\right] + \\frac{2 \\pi^2 k \\Theta}{L^2} \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right)\n$$\n此表达式是所要求的人造源项 $S(x,y)$ 的封闭形式解析函数。", "answer": "$$\n\\boxed{\\frac{\\pi \\rho c_p U_0 \\Theta}{L} \\left[ \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos^{2}\\left(\\frac{\\pi y}{L}\\right) - \\sin^{2}\\left(\\frac{\\pi x}{L}\\right)\\sin\\left(\\frac{\\pi y}{L}\\right) \\right] + \\frac{2 \\pi^2 k \\Theta}{L^2} \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right)}\n$$", "id": "2497372"}]}