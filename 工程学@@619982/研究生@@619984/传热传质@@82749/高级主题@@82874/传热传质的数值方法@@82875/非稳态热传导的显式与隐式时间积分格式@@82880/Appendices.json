{"hands_on_practices": [{"introduction": "显式时间积分方案，如前向时间中心空间（FTCS）方法，因其实现简单而具有吸引力。然而，它们的致命弱点是其条件稳定性。这个练习将引导你通过冯·诺依曼稳定性分析，推导出一维热传导问题中 FTCS 方案的稳定性判据，并计算出允许的最大时间步长。掌握这个核心概念对于在工程实践中有效使用显式方法至关重要，因为它揭示了时间步长 $\\Delta t$、空间网格尺寸 $\\Delta x$ 和材料属性 $\\alpha$ 之间的内在联系 [@problem_id:2483538]。", "problem": "一个均匀、各向同性的一维固体，其热扩散系数为常数，其瞬态热方程由能量守恒和 Fourier 定律导出，得到 $\\frac{\\partial T}{\\partial t}=\\alpha\\,\\frac{\\partial^{2}T}{\\partial x^{2}}$，其中 $T$ 是温度，$t$ 是时间，$x$ 是沿杆的空间坐标，$\\alpha$ 是热扩散系数。考虑一个间距为 $\\Delta x$ 的均匀网格，并应用前向时间中心空间（FTCS）显式时间积分格式，该格式使用前向 Euler 步长来推进 $T$ 的时间，并用二阶中心差分来近似空间二阶导数。使用 von Neumann（Fourier）稳定性分析，确定最大时间步长 $\\Delta t_{\\max}$，使得该格式对所有空间 Fourier 模式都处于临界稳定状态。\n\n使用数据 $\\alpha=1.4\\times 10^{-5}\\,\\mathrm{m^{2}/s}$ 和 $\\Delta x=0.5\\,\\mathrm{mm}$，计算此一维 FTCS 离散化对应的 $\\Delta t_{\\max}$。将你的答案四舍五入到四位有效数字，并以秒为单位表示时间。", "solution": "一维瞬态热传导的控制方程如下所示：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n其中，$T(x, t)$ 是温度，$x$ 是空间坐标，$t$ 是时间，$\\alpha$ 是热扩散系数。我们要做的是分析该方程的前向时间中心空间（FTCS）离散格式的稳定性。\n\n我们定义一个空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格。在网格节点 $i$ 和时间层 $n$ 的温度表示为 $T_i^n \\equiv T(i\\Delta x, n\\Delta t)$。\n\nFTCS 格式对偏导数的近似如下：\n时间导数使用一阶前向差分近似：\n$$\n\\frac{\\partial T}{\\partial t} \\bigg|_{i,n} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}\n$$\n空间二阶导数使用二阶中心差分近似：\n$$\n\\frac{\\partial^2 T}{\\partial x^2} \\bigg|_{i,n} \\approx \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2}\n$$\n将这些近似代入控制方程，得到 FTCS 格式的离散形式：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\left( \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2} \\right)\n$$\n我们可以重排该方程，以显式求解下一时间步的温度 $T_i^{n+1}$：\n$$\nT_i^{n+1} = T_i^n + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (T_{i+1}^n - 2T_i^n + T_{i-1}^n)\n$$\n我们定义无量纲 Fourier 数 $Fo$（也称为扩散数）为：\n$$\nFo = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}\n$$\n离散化方程简化为：\n$$\nT_i^{n+1} = T_i^n + Fo (T_{i+1}^n - 2T_i^n + T_{i-1}^n) = Fo \\, T_{i+1}^n + (1 - 2Fo)T_i^n + Fo \\, T_{i-1}^n\n$$\n为了确定此数值格式的稳定性，我们进行 von Neumann 稳定性分析。我们考虑解的单个 Fourier 模式的行为。设时间层 $n$ 的温度分布由一个 Fourier 分量表示：\n$$\nT_i^n = \\hat{T}^n(k) e^{I k x_i}\n$$\n其中 $k$ 是波数，$x_i = i\\Delta x$ 是节点 $i$ 的空间位置，$I = \\sqrt{-1}$ 是虚数单位。在时间 $n$ 时，该模式的振幅为 $\\hat{T}^n(k)$。经过一个时间步长后，该模式将被一个因子 $G(k)$（放大因子）放大：\n$$\nT_i^{n+1} = \\hat{T}^{n+1}(k) e^{I k x_i} = G(k) \\hat{T}^n(k) e^{I k x_i}\n$$\n为使数值格式稳定，对于任何波数 $k$，放大因子的模都不能超过 1。稳定性条件是：\n$$\n|G(k)| \\le 1\n$$\n我们将 Fourier 模式的表示方法代入离散方程：\n$$\nG(k) \\hat{T}^n(k) e^{I k (i\\Delta x)} = Fo \\, \\hat{T}^n(k) e^{I k ((i+1)\\Delta x)} + (1 - 2Fo) \\hat{T}^n(k) e^{I k (i\\Delta x)} + Fo \\, \\hat{T}^n(k) e^{I k ((i-1)\\Delta x)}\n$$\n两边同除以 $\\hat{T}^n(k) e^{I k (i\\Delta x)}$，得到放大因子 $G(k)$ 的表达式：\n$$\nG(k) = Fo \\, e^{I k \\Delta x} + (1 - 2Fo) + Fo \\, e^{-I k \\Delta x}\n$$\n使用 Euler 恒等式 $e^{I\\theta} + e^{-I\\theta} = 2\\cos(\\theta)$，我们可以简化此表达式：\n$$\nG(k) = 1 - 2Fo + Fo (e^{I k \\Delta x} + e^{-I k \\Delta x}) = 1 - 2Fo + 2Fo \\cos(k \\Delta x)\n$$\n$$\nG(k) = 1 - 2Fo(1 - \\cos(k \\Delta x))\n$$\n使用三角半角公式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们得到：\n$$\nG(k) = 1 - 4Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n现在我们应用稳定性条件 $|G(k)| \\le 1$。由于 $Fo > 0$，项 $4Fo \\sin^2(k\\Delta x/2)$ 是非负的。因此，$G(k)$ 总是小于或等于 $1$。稳定性因而由下界决定：\n$$\nG(k) \\ge -1\n$$\n$$\n1 - 4Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\ge -1\n$$\n$$\n2 \\ge 4Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\frac{1}{2} \\ge Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n这个不等式必须对所有可能的波数 $k$ 都成立。最严格的条件出现在项 $\\sin^2(k\\Delta x/2)$ 达到其最大值时。$\\sin^2(\\theta)$ 的最大值是 $1$。这对应于网格上可表示的最高频率（振荡最快）的模式，此时 $k \\Delta x = \\pi$。\n因此，稳定性条件变为：\n$$\nFo \\le \\frac{1}{2}\n$$\n当达到此条件的极限，即 $Fo = 1/2$ 时，实现临界稳定。最大允许时间步长 $\\Delta t_{\\max}$ 对应于此极限：\n$$\n\\frac{\\alpha \\Delta t_{\\max}}{(\\Delta x)^2} = \\frac{1}{2}\n$$\n求解 $\\Delta t_{\\max}$：\n$$\n\\Delta t_{\\max} = \\frac{(\\Delta x)^2}{2\\alpha}\n$$\n我们已知以下数据：\n$\\alpha = 1.4 \\times 10^{-5} \\, \\mathrm{m^2/s}$\n$\\Delta x = 0.5 \\, \\mathrm{mm} = 0.5 \\times 10^{-3} \\, \\mathrm{m}$\n\n将这些值代入 $\\Delta t_{\\max}$ 的表达式中：\n$$\n(\\Delta x)^2 = (0.5 \\times 10^{-3} \\, \\mathrm{m})^2 = 0.25 \\times 10^{-6} \\, \\mathrm{m^2}\n$$\n$$\n\\Delta t_{\\max} = \\frac{0.25 \\times 10^{-6} \\, \\mathrm{m^2}}{2 \\times (1.4 \\times 10^{-5} \\, \\mathrm{m^2/s})} = \\frac{0.25 \\times 10^{-6}}{2.8 \\times 10^{-5}} \\, \\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} = \\frac{0.25}{2.8} \\times 10^{-1} \\, \\mathrm{s} \\approx 0.0892857 \\times 10^{-1} \\, \\mathrm{s} = 0.00892857 \\, \\mathrm{s}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\Delta t_{\\max} \\approx 0.008929 \\, \\mathrm{s}\n$$", "answer": "$$\n\\boxed{0.008929}\n$$", "id": "2483538"}, {"introduction": "为了克服显式方法的稳定性限制，我们常常转向无条件稳定的隐式方法，如 Crank-Nicolson 方案。这种稳定性的代价是在每个时间步都需要求解一个线性方程组。本练习将通过一个具体的算例，让你亲手实践如何为一维热传导问题构建并求解 Crank-Nicolson 方案的离散方程。通过这个过程，你将清晰地理解隐式方法的工作原理，并体会到它在处理具有挑战性的初始条件（如温度阶跃）时的鲁棒性 [@problem_id:2483452]。", "problem": "考虑一根长度为 $L$、具有恒定热扩散系数 $\\alpha$ 的细长均匀杆中的一维瞬态热传导，该过程由热方程 $\\partial T/\\partial t=\\alpha\\,\\partial^{2}T/\\partial x^{2}$ 控制，并服从狄利克雷(Dirichlet)边界条件。对于所有 $t\\ge 0$，杆的左端位于 $x=0$，保持在恒定温度 $T(0,t)=T_{\\text{L}}$；右端位于 $x=L$，保持在恒定温度 $T(L,t)=T_{\\text{R}}$。该杆在一个包含两端的均匀五节点网格上进行离散化，节点位于 $x_{i}=i\\,\\Delta x$，其中 $i=0,1,2,3,4$，且 $\\Delta x=L/4$。将从 $t^{n}$ 到 $t^{n+1}=t^{n}+\\Delta t$ 取一个时间步。\n\n给定物理和数值参数 $L=0.4\\,\\mathrm{m}$，$\\alpha=1.00\\times 10^{-4}\\,\\mathrm{m^{2}\\,s^{-1}}$，以及 $\\Delta t=50\\,\\mathrm{s}$，狄利克雷边界温度 $T_{\\text{L}}=400\\,\\mathrm{K}$ 和 $T_{\\text{R}}=300\\,\\mathrm{K}$，以及在时间 $t^{n}$ 的节点值，\n$$\nT_{0}^{n}=400\\,\\mathrm{K},\\quad T_{1}^{n}=400\\,\\mathrm{K},\\quad T_{2}^{n}=400\\,\\mathrm{K},\\quad T_{3}^{n}=300\\,\\mathrm{K},\\quad T_{4}^{n}=300\\,\\mathrm{K},\n$$\n使用应用于热方程的 Crank–Nicolson 时间积分法（时间上的梯形法则结合空间上的二阶中心有限差分）推导内部节点的线性代数方程组，并执行一次隐式更新以计算所有五个节点上的 $T^{n+1}$。\n\n清晰地陈述您为内部节点获得的离散方程，在您的线性系统中一致地引入 $x=0$ 和 $x=L$ 处的狄利克雷边界条件，并精确求解或在舍入误差范围内求解该三对角系统。将您的最终数值结果表示为行向量\n$$\n\\bigl[T_{0}^{n+1},\\,T_{1}^{n+1},\\,T_{2}^{n+1},\\,T_{3}^{n+1},\\,T_{4}^{n+1}\\bigr],\n$$\n并四舍五入到六位有效数字。温度以开尔文(K)为单位表示。", "solution": "一维热方程由下式给出\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\nCrank-Nicolson 方法是一种在时间和空间上均为二阶精度的有限差分法。它通过对时间导数应用梯形法则，并对空间导数在时间层 $n$ 和 $n+1$ 上取平均的中心差分近似来推导。对内部节点 $i$ 的最终离散格式为：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\frac{\\alpha}{2} \\left( \\frac{T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1}}{(\\Delta x)^2} + \\frac{T_{i-1}^{n} - 2T_i^{n} + T_{i+1}^{n}}{(\\Delta x)^2} \\right)\n$$\n我们定义无量纲傅里叶数 $r$ 为 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$。我们重排方程，将时间层 $n+1$ 的项放在左侧(LHS)，将时间层 $n$ 的项放在右侧(RHS)：\n$$\nT_i^{n+1} - T_i^n = \\frac{r}{2} \\left( (T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1}) + (T_{i-1}^{n} - 2T_i^{n} + T_{i+1}^{n}) \\right)\n$$\n$$\n-\\frac{r}{2} T_{i-1}^{n+1} + (1+r)T_i^{n+1} - \\frac{r}{2} T_{i+1}^{n+1} = \\frac{r}{2} T_{i-1}^{n} + (1-r)T_i^{n} + \\frac{r}{2} T_{i+1}^{n}\n$$\n首先，我们根据给定参数计算 $\\Delta x$ 和 $r$ 的值：\n$$\n\\Delta x = \\frac{L}{4} = \\frac{0.4\\,\\mathrm{m}}{4} = 0.1\\,\\mathrm{m}\n$$\n$$\nr = \\frac{\\alpha \\Delta t}{(\\Delta x)^2} = \\frac{(1.00 \\times 10^{-4}\\,\\mathrm{m^2\\,s^{-1}})(50\\,\\mathrm{s})}{(0.1\\,\\mathrm{m})^2} = \\frac{5 \\times 10^{-3}}{10^{-2}} = 0.5\n$$\n将 $r=0.5$ 代入通用离散方程得到：\n$$\n-\\frac{0.5}{2} T_{i-1}^{n+1} + (1+0.5)T_i^{n+1} - \\frac{0.5}{2} T_{i+1}^{n+1} = \\frac{0.5}{2} T_{i-1}^{n} + (1-0.5)T_i^{n} + \\frac{0.5}{2} T_{i+1}^{n}\n$$\n$$\n-0.25 T_{i-1}^{n+1} + 1.5 T_i^{n+1} - 0.25 T_{i+1}^{n+1} = 0.25 T_{i-1}^{n} + 0.5 T_i^{n} + 0.25 T_{i+1}^{n}\n$$\n该方程适用于网格的内部节点，即 $i=1, 2, 3$。边界节点 $i=0$ 和 $i=4$ 的温度由狄利克雷边界条件给出：\n$T(0,t) = T_0^{n+1} = T_{\\text{L}} = 400\\,\\mathrm{K}$\n$T(L,t) = T_4^{n+1} = T_{\\text{R}} = 300\\,\\mathrm{K}$\n\n我们为未知的内部节点温度 $\\{T_1^{n+1}, T_2^{n+1}, T_3^{n+1}\\}$ 建立一个线性系统。\n对于每个内部节点 $i$，方程的右侧(RHS)仅取决于时间 $t^n$ 的已知值。我们将节点 $i$ 的右侧记为 $d_i$：\n$d_i = 0.25 T_{i-1}^{n} + 0.5 T_i^{n} + 0.25 T_{i+1}^{n}$\n使用给定的初始数据 $T^{n} = [400, 400, 400, 300, 300]\\,\\mathrm{K}$：\n对于 $i=1$：$d_1 = 0.25 T_0^n + 0.5 T_1^n + 0.25 T_2^n = 0.25(400) + 0.5(400) + 0.25(400) = 100 + 200 + 100 = 400$。\n对于 $i=2$：$d_2 = 0.25 T_1^n + 0.5 T_2^n + 0.25 T_3^n = 0.25(400) + 0.5(400) + 0.25(300) = 100 + 200 + 75 = 375$。\n对于 $i=3$：$d_3 = 0.25 T_2^n + 0.5 T_3^n + 0.25 T_4^n = 0.25(400) + 0.5(300) + 0.25(300) = 100 + 150 + 75 = 325$。\n\n现在我们写出左侧(LHS)的方程，并引入 $t^{n+1}$ 时刻的已知边界温度：\n对于 $i=1$：$-0.25 T_0^{n+1} + 1.5 T_1^{n+1} - 0.25 T_2^{n+1} = d_1 = 400$。\n由于 $T_0^{n+1} = 400$，我们有 $1.5 T_1^{n+1} - 0.25 T_2^{n+1} = 400 + 0.25(400) = 500$。\n\n对于 $i=2$：$-0.25 T_1^{n+1} + 1.5 T_2^{n+1} - 0.25 T_3^{n+1} = d_2 = 375$。\n\n对于 $i=3$：$-0.25 T_2^{n+1} + 1.5 T_3^{n+1} - 0.25 T_4^{n+1} = d_3 = 325$。\n由于 $T_4^{n+1} = 300$，我们有 $-0.25 T_2^{n+1} + 1.5 T_3^{n+1} = 325 + 0.25(300) = 400$。\n\n得到的内部温度向量 $[T_1^{n+1}, T_2^{n+1}, T_3^{n+1}]^T$ 的线性系统是一个三对角系统：\n$$\n\\begin{pmatrix}\n1.5 & -0.25 & 0 \\\\\n-0.25 & 1.5 & -0.25 \\\\\n0 & -0.25 & 1.5\n\\end{pmatrix}\n\\begin{pmatrix}\nT_1^{n+1} \\\\\nT_2^{n+1} \\\\\nT_3^{n+1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n500 \\\\\n375 \\\\\n400\n\\end{pmatrix}\n$$\n为求解这个 $3 \\times 3$ 系统，我们可以使用代入法。由第一个方程：\n$T_1^{n+1} = \\frac{500 + 0.25 T_2^{n+1}}{1.5} = \\frac{1000}{3} + \\frac{1}{6} T_2^{n+1}$。\n由第三个方程：\n$T_3^{n+1} = \\frac{400 + 0.25 T_2^{n+1}}{1.5} = \\frac{800}{3} + \\frac{1}{6} T_2^{n+1}$。\n将 $T_1^{n+1}$ 和 $T_3^{n+1}$ 的表达式代入第二个方程：\n$-0.25 \\left(\\frac{1000}{3} + \\frac{1}{6} T_2^{n+1}\\right) + 1.5 T_2^{n+1} - 0.25 \\left(\\frac{800}{3} + \\frac{1}{6} T_2^{n+1}\\right) = 375$。\n$-\\frac{250}{3} - \\frac{1}{24} T_2^{n+1} + \\frac{3}{2} T_2^{n+1} - \\frac{200}{3} - \\frac{1}{24} T_2^{n+1} = 375$。\n合并同类项：\n$\\left(\\frac{3}{2} - \\frac{2}{24}\\right) T_2^{n+1} - \\frac{450}{3} = 375$。\n$\\left(\\frac{18}{12} - \\frac{1}{12}\\right) T_2^{n+1} - 150 = 375$。\n$\\frac{17}{12} T_2^{n+1} = 525$。\n$T_2^{n+1} = \\frac{525 \\times 12}{17} = \\frac{6300}{17}\\,\\mathrm{K}$。\n\n现在我们回代以求得 $T_1^{n+1}$ 和 $T_3^{n+1}$：\n$T_1^{n+1} = \\frac{1000}{3} + \\frac{1}{6} \\left(\\frac{6300}{17}\\right) = \\frac{1000}{3} + \\frac{1050}{17} = \\frac{17000 + 3150}{51} = \\frac{20150}{51}\\,\\mathrm{K}$。\n$T_3^{n+1} = \\frac{800}{3} + \\frac{1}{6} \\left(\\frac{6300}{17}\\right) = \\frac{800}{3} + \\frac{1050}{17} = \\frac{13600 + 3150}{51} = \\frac{16750}{51}\\,\\mathrm{K}$。\n\n内部节点的温度为：\n$T_1^{n+1} = \\frac{20150}{51} \\approx 395.098039... \\,\\mathrm{K}$\n$T_2^{n+1} = \\frac{6300}{17} \\approx 370.588235... \\,\\mathrm{K}$\n$T_3^{n+1} = \\frac{16750}{51} \\approx 328.431372... \\,\\mathrm{K}$\n\n将这些值四舍五入到六位有效数字：\n$T_1^{n+1} = 395.098\\,\\mathrm{K}$\n$T_2^{n+1} = 370.588\\,\\mathrm{K}$\n$T_3^{n+1} = 328.431\\,\\mathrm{K}$\n\n在时间 $t^{n+1}$，包含边界节点的完整温度向量是：\n$T_0^{n+1} = 400.000\\,\\mathrm{K}$\n$T_1^{n+1} = 395.098\\,\\mathrm{K}$\n$T_2^{n+1} = 370.588\\,\\mathrm{K}$\n$T_3^{n+1} = 328.431\\,\\mathrm{K}$\n$T_4^{n+1} = 300.000\\,\\mathrm{K}$\n\n这个结果表示经过一个 $\\Delta t=50\\,\\mathrm{s}$ 的时间步长后的温度分布，显示了从初始的陡峭前沿剖面演变为最终的线性稳态剖面的过程。", "answer": "$$\n\\boxed{\\begin{pmatrix} 400.000 & 395.098 & 370.588 & 328.431 & 300.000 \\end{pmatrix}}\n$$", "id": "2483452"}, {"introduction": "稳定性是数值方案的基本要求，但仅仅保证误差不无限增长是不够的，我们还期望解在物理上是合理的。Crank-Nicolson 方案虽然是无条件稳定的，但在某些情况下（尤其是当时间步长相对于网格尺寸较大时）可能会产生非物理的数值振荡。这个高级练习将带你深入探究这一现象，通过分析放大因子，推导出避免数值振荡的条件 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2} \\le \\frac{1}{2}$。完成这个练习将让你对数值解的“质量”有更深刻的理解，而不仅仅是其“稳定性” [@problem_id:2483557]。", "problem": "考虑均匀介质中的一维瞬态热传导，其热扩散系数为 $\\alpha$，定义在周期性域 $[0,L]$ 上，由偏微分方程 $\\frac{\\partial T}{\\partial t}=\\alpha \\frac{\\partial^{2}T}{\\partial x^{2}}$ 控制。在间距为 $\\Delta x$ 的均匀网格上，使用标准二阶中心差分对空间算子进行离散化，并采用 Crank–Nicolson (CN) 格式（即时间上的梯形法则）进行时间积分。对该全离散格式使用 von Neumann 傅里叶模态分析，推导一个充分必要条件，使得 Crank–Nicolson 更新在时间上是非单调的（即，至少一个傅里叶模态的振幅在步间改变符号），即使该格式在有界放大系数的意义下是无条件稳定的。定义无量纲时间步长参数 $r=\\alpha \\Delta t/\\Delta x^{2}$，并通过对周期性网格所允许的所有空间傅里叶模态进行优化，确定最大值 $r_{\\text{crit}}$，使得对于所有 $0 \\le r \\le r_{\\text{crit}}$，每个傅里叶模态的单步放大因子都是非负的。你的最终答案必须是 $r_{\\text{crit}}$ 的单个闭式解值。不要代入数值。以单个不带单位的数字形式给出 $r_{\\text{crit}}$。", "solution": "一维瞬态热传导的控制方程由下式给出：\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^{2}T}{\\partial x^{2}} $$\n其中 $T$ 是温度，$t$ 是时间，$x$ 是空间坐标，$\\alpha$ 是热扩散系数。\n\n根据要求，我们在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上对此方程进行离散化。设 $T_j^n$ 为 $T(j\\Delta x, n\\Delta t)$ 的数值近似。空间二阶导数使用二阶中心差分进行近似：\n$$ \\frac{\\partial^{2}T}{\\partial x^{2}} \\bigg|_{x_j} \\approx \\frac{T_{j+1} - 2T_j + T_{j-1}}{(\\Delta x)^{2}} $$\n时间积分使用 Crank–Nicolson 格式进行，该格式等价于梯形法则。此格式对时间层 $n$ 和 $n+1$ 上的空间导数算子取平均：\n$$ \\frac{T_j^{n+1} - T_j^n}{\\Delta t} = \\frac{\\alpha}{2} \\left[ \\left( \\frac{T_{j+1}^{n+1} - 2T_j^{n+1} + T_{j-1}^{n+1}}{(\\Delta x)^{2}} \\right) + \\left( \\frac{T_{j+1}^{n} - 2T_j^{n} + T_{j-1}^{n}}{(\\Delta x)^{2}} \\right) \\right] $$\n引入无量纲时间步长参数 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$，我们可以将方程重排为：\n$$ T_j^{n+1} - T_j^n = \\frac{r}{2} \\left[ (T_{j+1}^{n+1} - 2T_j^{n+1} + T_{j-1}^{n+1}) + (T_{j+1}^{n} - 2T_j^{n} + T_{j-1}^{n}) \\right] $$\n为了分析此格式的性质，我们使用 von Neumann 傅里叶分析。我们考虑温度场的单个傅里叶模态：\n$$ T_j^n = \\hat{T}^n(k) \\exp(i k x_j) $$\n其中 $k$ 是波数，$i = \\sqrt{-1}$。模态振幅从一个时间步到下一个时间步的演化由放大因子 $G(k)$ 描述，其定义为 $\\hat{T}^{n+1}(k) = G(k) \\hat{T}^n(k)$。因此有 $T_j^{n+1} = G(k) T_j^n$。\n将傅里叶模态代入离散方程得到：\n$$ G(k)T_j^n - T_j^n = \\frac{r}{2} \\left[ G(k)(T_{j+1}^n - 2T_j^n + T_{j-1}^n) + (T_{j+1}^n - 2T_j^n + T_{j-1}^n) \\right] $$\n我们使用关系式 $T_{j\\pm 1}^n = T_j^n \\exp(\\pm i k \\Delta x)$。将整个方程除以 $T_j^n$（非零），得出：\n$$ G(k) - 1 = \\frac{r}{2} (G(k) + 1) \\left[ \\exp(i k \\Delta x) - 2 + \\exp(-i k \\Delta x) \\right] $$\n令无量纲波数（或相角）为 $\\theta = k \\Delta x$。使用恒等式 $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$，方括号中的项变为：\n$$ 2\\cos(\\theta) - 2 = -2(1-\\cos(\\theta)) $$\n使用半角恒等式 $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$，此式可进一步简化为：\n$$ -4\\sin^2\\left(\\frac{\\theta}{2}\\right) $$\n将此结果代回关于 $G(k)$（现在写作 $G(\\theta)$）的方程：\n$$ G(\\theta) - 1 = \\frac{r}{2} (G(\\theta) + 1) \\left[ -4\\sin^2\\left(\\frac{\\theta}{2}\\right) \\right] $$\n$$ G(\\theta) - 1 = -2r(G(\\theta) + 1)\\sin^2\\left(\\frac{\\theta}{2}\\right) $$\n我们现在求解 $G(\\theta)$：\n$$ G(\\theta) \\left(1 + 2r\\sin^2\\left(\\frac{\\theta}{2}\\right)\\right) = 1 - 2r\\sin^2\\left(\\frac{\\theta}{2}\\right) $$\n$$ G(\\theta) = \\frac{1 - 2r\\sin^2\\left(\\frac{\\theta}{2}\\right)}{1 + 2r\\sin^2\\left(\\frac{\\theta}{2}\\right)} $$\n问题要求的是格式非单调的条件，这发生在放大因子 $G(\\theta)$ 可能为负的情况下。对于所有模态都应单调衰减的扩散过程来说，这是不符合物理规律的。我们寻求 $r$ 的最大值，记为 $r_{\\text{crit}}$，使得对于所有可能的傅里叶模态，其放大因子都是非负的，即对所有 $\\theta$ 都有 $G(\\theta) \\ge 0$。\n\n鉴于 $r \\ge 0$，分母 $1 + 2r\\sin^2(\\theta/2)$ 总是大于或等于 $1$。因此，$G(\\theta)$ 的符号由其分子决定。条件 $G(\\theta) \\ge 0$ 变为：\n$$ 1 - 2r\\sin^2\\left(\\frac{\\theta}{2}\\right) \\ge 0 $$\n此不等式必须对网格所能解析的所有傅里叶模态都成立。相角 $\\theta=k\\Delta x$ 的范围是 $[-\\pi, \\pi]$，其中最高频率（奈奎斯特）模态对应于 $\\theta = \\pm \\pi$。为确保不等式对所有 $\\theta$ 都成立，我们必须在最严格的情况下满足它。该不等式可以写为：\n$$ r \\le \\frac{1}{2\\sin^2\\left(\\frac{\\theta}{2}\\right)} $$\n为使此式对所有 $\\theta$ 成立，$r$ 必须小于或等于右侧表达式的最小值。该表达式的最小值在其分母 $\\sin^2(\\theta/2)$ 取最大值时出现。在 $\\theta \\in [-\\pi, \\pi]$ 范围内，$\\sin^2(\\theta/2)$ 的最大值在 $\\theta = \\pm \\pi$ 时取得：\n$$ \\max_{\\theta \\in [-\\pi, \\pi]} \\left(\\sin^2\\left(\\frac{\\theta}{2}\\right)\\right) = \\sin^2\\left(\\frac{\\pi}{2}\\right) = 1^2 = 1 $$\n将此最大值代入不等式，可得到对 $r$ 最严格的条件：\n$$ r \\le \\frac{1}{2(1)} \\implies r \\le \\frac{1}{2} $$\n因此，为保证 Crank–Nicolson 格式对所有傅里叶模态的放大因子均为非负，参数 $r$ 不得超过 $1/2$。满足此条件的最大 $r$ 值即为 $r_{\\text{crit}}$。\n如果 $r > 1/2$，最高频率模态会表现出伪振荡，因为其放大因子 $G(\\pi) = (1-2r)/(1+2r)$ 会变为负值。\n因此，临界值为：\n$$ r_{\\text{crit}} = \\frac{1}{2} $$", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2483557"}]}