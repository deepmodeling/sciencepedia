{"hands_on_practices": [{"introduction": "在理论学习之后，将知识付诸实践是掌握SIMPLE和PISO这类压力-速度耦合算法的关键。本章的动手实践旨在通过一系列精心设计的问题，帮助你巩固核心概念，并从基本原理出发，逐步深入到实际的计算流体动力学（CFD）问题中。这些练习不仅仅是公式的套用，更是对算法思想、实施细节和数值挑战的深刻理解。\n\n我们的第一个实践是基础性的。我们将一个复杂的流动问题简化到其最核心的部分，以便从第一性原理出发，推导SIMPLE算法的核心——压力修正方程。这个练习将向你展示，压力-速度耦合的中心思想是如何通过建立压力修正量 $p'$ 和速度修正量 $u'$ 之间的联系来迭代地强制执行质量守恒的[@problem_id:2516621]。", "problem": "考虑牛顿流体在一维、稳态、不可压缩、层流状态下流经一个横截面积 $A$ 为常数的直矩形管道。流动方向与 $x$ 方向一致，物性均匀，且雷诺数足够低，以至于对流相对于粘性扩散可以忽略不计。计算采用均匀交错网格：压力存储在单元中心，速度存储在单元面上。设压力控制体的间距为均匀的 $\\Delta x$。\n\n你需要从概念上推导压力链接方程组的半隐式方法 (Semi-Implicit Method for Pressure-Linked Equations, SIMPLE) 中使用的压力-速度耦合步骤。使用以下假设：\n\n- $x$-动量方程是唯一的动量平衡方程，针对每个交错的速度控制体编写，通过对粘性项进行中心差分和在控制体长度 $\\Delta x$ 上对压力梯度源项进行积分来实现离散化。\n- 忽略体力、瞬态项和对流项。\n- 设 $u^{*}$ 表示猜测（预测）的速度， $p'$ 和 $u'$ 分别为压力和速度的修正值，因此修正后的场为 $p = p^{*} + p'$ 和 $u = u^{*} + u'$。\n\n任务：\n\n1. 从压力控制体的稳态、不可压缩质量守恒积分形式和交错速度控制体的 $x$-动量平衡积分形式出发，并对猜测场进行线性化，推导出一个面上的速度修正值与相邻压力修正值之间的局部线性关系，其形式为\n   $$u'_{f} = d_{f}\\,\\big(p'_{L} - p'_{R}\\big),$$\n   其中 $f$ 表示一个面， $L$ 和 $R$ 是与面 $f$ 相邻的左右压力节点。用面上的动量离散化系数和几何量来表示 $d_{f}$。\n\n2. 通过要求修正后通过其各个面的净体积通量为零，在一个内部压力控制体 $P$ 上强制执行离散质量守恒。利用任务1中得到的在 $P$ 的西面 $W$ 和东面 $E$ 上的关系，推导三点压力修正方程\n   $$a_{P}^{p'}\\,p'_{P} \\;=\\; a_{W}^{p'}\\,p'_{W} \\;+\\; a_{E}^{p'}\\,p'_{E} \\;+\\; b_{P},$$\n   并根据 $A$ 以及在面 $W$ 和 $E$ 上的动量系数，得到对角系数 $a_{P}^{p'}$ 的封闭形式表达式。\n\n3. 对于物性恒定、采用均匀网格且粘性项使用中心差分的情况，仅考虑扩散平衡时，面动量系数的形式为 $a_{u} = 2\\,\\mu\\,A/\\Delta x$，该形式在每个内部面上均成立，其中 $\\mu$ 是动力粘度。利用此公式将您的 $a_{P}^{p'}$ 表达式简化为一个仅依赖于 $A$、 $\\mu$ 和 $\\Delta x$ 的封闭形式。\n\n4. 对于给定的 $A = 1.0 \\times 10^{-2}\\,\\mathrm{m^{2}}$，$\\mu = 1.0 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$ 和 $\\Delta x = 5.0 \\times 10^{-2}\\,\\mathrm{m}$，计算 $a_{P}^{p'}$ 的表达式的值。将 $a_{P}^{p'}$ 的最终值以 $\\mathrm{m^{3}/(s\\cdot Pa)}$ 为单位表示，并四舍五入到四位有效数字。", "solution": "本问题要求为简化的一维、稳态、不可压缩流动推导 SIMPLE 算法中压力修正步骤的核心方程，并进行数值计算。推导将按要求分步进行。\n\n首先，我们推导单元面上的速度修正值与相邻控制体中压力修正值之间的关系。在对流、瞬态项和体力可忽略的假设下，位于通用面 $f$ 上的速度 $u_f$ 的离散化 $x$-动量方程将粘性力与压力梯度联系起来。在标准的有限体积形式下，该方程写作：\n$$a_f u_f = \\sum_{nb} a_{nb} u_{nb} + (p_L - p_R)A$$\n其中 $a_f$ 是 $u_f$ 的主动量离散化系数，$\\sum_{nb} a_{nb} u_{nb}$ 代表由粘性扩散引起的相邻速度的贡献，$A$ 是横截面积，$p_L$ 和 $p_R$ 是面 $f$ 左右两侧节点上的压力。SIMPLE 算法采用预测-校正方法。使用一个猜测的压力场 $p^*$ 求解动量方程，得到一个预测的速度场 $u^*$：\n$$a_f u_f^* = \\left(\\sum_{nb} a_{nb} u_{nb}\\right)^* + (p_L^* - p_R^*)A$$\n此处，涉及相邻速度的项使用可用的最佳值（通常是上一次迭代的值）进行计算。修正后的场，$p = p^*+p'$ 和 $u = u^*+u'$，必须满足完整的动量方程：\n$$a_f (u_f^*+u_f') = \\sum_{nb} a_{nb} (u_{nb}^*+u_{nb}') + (p_L^*+p_L' - (p_R^*+p_R'))A$$\n从完整方程中减去预测方程，得到一个关于修正值的方程：\n$$a_f u_f' = \\sum_{nb} a_{nb} u_{nb}' + (p_L' - p_R')A$$\nSIMPLE 算法的一个核心近似是忽略包含相邻速度修正值的项 $\\sum_{nb} a_{nb} u_{nb}'$。这一省略解耦了速度修正方程，从而为每个速度修正值产生了一个简单的显式关系：\n$$a_f u_f' \\approx (p_L' - p_R')A$$\n整理后得到所需的速度修正值 $u_f'$ 与相邻压力修正值 $p_L'$ 和 $p_R'$ 之间的线性关系：\n$$u_f' = \\frac{A}{a_f} (p_L' - p_R')$$\n将其与所要求的形式 $u'_{f} = d_{f}\\,\\big(p'_{L} - p'_{R}\\big)$ 进行比较，我们确定系数 $d_f$ 为：\n$$d_f = \\frac{A}{a_f}$$\n该系数将速度修正值与压力修正梯度联系起来，其大小由面积 $A$ 和动量系数 $a_f$ 决定。\n\n接下来，我们通过强制执行质量守恒来推导压力修正方程。对于一个以节点 $P$ 为中心、西面为 $w$、东面为 $e$ 的压力控制体，稳态不可压缩质量守恒要求净体积通量为零：$(uA)_e - (uA)_w = 0$。由于面积 $A$ 是常数，这可以简化为 $A(u_e - u_w) = 0$。修正后的速度场必须满足此条件：\n$$A\\left( (u_e^* + u_e') - (u_w^* + u_w') \\right) = 0$$\n这意味着修正值必须平衡来自预测场的质量不平衡：\n$$A(u_e' - u_w') = -A(u_e^* - u_w^*) = A(u_w^* - u_e^*)$$\n我们现在代入速度修正式。东面 $e$ 位于节点 $P$ 和 $E$ 之间，因此 $u_e' = d_e(p_P' - p_E')$。西面 $w$ 位于节点 $W$ 和 $P$ 之间，因此 $u_w' = d_w(p_W' - p_P')$。将这些代入连续性方程，得到：\n$$A \\left[ d_e(p_P' - p_E') - d_w(p_W' - p_P') \\right] = A(u_w^* - u_e^*)$$\n对未知的压力修正值 $p_W'$、$p_P'$ 和 $p_E'$ 进行分组，得到：\n$$A(d_e + d_w)p_P' - A d_w p_W' - A d_e p_E' = A(u_w^* - u_e^*)$$\n将其整理成标准线性系统形式 $a_{P}^{p'}\\,p'_{P} = a_{W}^{p'}\\,p'_{W} + a_{E}^{p'}\\,p'_{E} + b_{P}$，得到：\n$$A(d_e + d_w)p_P' = A d_w p_W' + A d_e p_E' + A(u_w^* - u_e^*)$$\n通过比较这两种形式，我们确定各项系数：$a_W^{p'} = Ad_w$, $a_E^{p'} = Ad_e$, $b_P = A(u_w^* - u_e^*)$，以及对角系数：\n$$a_P^{p'} = a_W^{p'} + a_E^{p'} = A(d_e + d_w)$$\n使用先前推导的表达式 $d_f = A/a_f$，我们将 $a_P^{p'}$ 用面积 $A$ 以及西面和东面上的动量系数 $a_w$ 和 $a_e$ 分别表示：\n$$a_P^{p'} = A \\left( \\frac{A}{a_e} + \\frac{A}{a_w} \\right) = A^2 \\left( \\frac{1}{a_e} + \\frac{1}{a_w} \\right)$$\n\n对于第三个任务，我们使用提供的公式来简化此表达式，该公式适用于均匀网格上仅有扩散且采用中心差分时的动量系数：$a_u = 2\\,\\mu\\,A/\\Delta x$。由于网格是均匀的且物性是恒定的，我们有 $a_w = a_e = a_u = 2\\,\\mu\\,A/\\Delta x$。将此代入我们关于 $a_P^{p'}$ 的表达式中：\n$$a_P^{p'} = A^2 \\left( \\frac{1}{2\\mu A/\\Delta x} + \\frac{1}{2\\mu A/\\Delta x} \\right) = A^2 \\left( \\frac{\\Delta x}{2\\mu A} + \\frac{\\Delta x}{2\\mu A} \\right)$$\n$$a_P^{p'} = A^2 \\left( \\frac{2\\Delta x}{2\\mu A} \\right) = A^2 \\left( \\frac{\\Delta x}{\\mu A} \\right)$$\n这可以简化为一个非常简洁的形式：\n$$a_P^{p'} = \\frac{A \\Delta x}{\\mu}$$\n该表达式的单位是 $(m^2 \\cdot m) / (Pa \\cdot s)$，即 $m^3/(Pa \\cdot s)$，这与压力修正方程中 $b_P$ 的单位为体积流率 ($m^3/s$) 相一致。\n\n最后，我们对给定的数值进行计算：$A = 1.0 \\times 10^{-2}\\,\\mathrm{m^{2}}$，$\\mu = 1.0 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$，和 $\\Delta x = 5.0 \\times 10^{-2}\\,\\mathrm{m}$。\n$$a_P^{p'} = \\frac{(1.0 \\times 10^{-2}) \\cdot (5.0 \\times 10^{-2})}{1.0 \\times 10^{-3}} = \\frac{5.0 \\times 10^{-4}}{1.0 \\times 10^{-3}} = 0.5$$\n压力修正方程的对角系数计算结果为 $0.5\\,\\mathrm{m^3/(s \\cdot Pa)}$。按要求表示为四位有效数字，其值为 $0.5000$。", "answer": "$$\n\\boxed{0.5000}\n$$", "id": "2516621"}, {"introduction": "在推导出计算域内部的控制方程后，下一个关键步骤是处理边界。本练习将探讨如何将物理边界条件（如固定的速度入口或压力出口）转化为压力修正方程的数学边界条件。正确实施这些边界条件对于任何有效的计算流体动力学（CFD）模拟都至关重要，它确保了数值解能够准确反映物理现实[@problem_id:2516603]。", "problem": "考虑在等截面直通道中的稳态、一维、不可压缩流动，该流场沿流向被有限体积法离散为两个相等的控制体积。压力-速度耦合将使用压力关联方程的半隐式方法 (Semi-Implicit Method for Pressure-Linked Equations, SIMPLE) 或算子分裂的压力隐式方法 (Pressure-Implicit with Splitting of Operators, PISO) 进行。入口（$x=0$）给定均匀法向速度，出口（$x=L$）给定静压。令 $p$ 表示静压，$p^{*}$ 表示预测压力，$p^{\\prime}$ 表示压力修正，因此 $p = p^{*} + p^{\\prime}$。引入无量纲压力修正 $\\hat{p}^{\\prime} = p^{\\prime}/p_{\\mathrm{ref}}$，其中 $p_{\\mathrm{ref}}$ 是一个恒定的参考压力。\n\n给定两个标记为 $1$ 和 $2$ 的内部单元的代数压力修正算子的集成内部面贡献（在施加边界条件之前）。对于一个具有西侧相邻单元 $W$ 和东侧相邻单元 $E$ 的通用内部单元 $P$，其规范代数形式为：\n$$\n\\hat{a}_{P}\\,\\hat{p}^{\\prime}_{P} \\;=\\; \\hat{a}_{W}\\,\\hat{p}^{\\prime}_{W} \\;+\\; \\hat{a}_{E}\\,\\hat{p}^{\\prime}_{E} \\;+\\; \\hat{b}_{P},\n$$\n其中 $\\hat{a}_{W}$ 和 $\\hat{a}_{E}$ 是西侧和东侧相邻单元的耦合系数，$\\hat{a}_{P}$ 是对角系数，$\\hat{b}_{P}$ 是由预测速度场的局部质量通量不平衡产生的源项。无量纲化的几何间距是均匀的，为 $\\Delta \\hat{x} = 1$。\n\n数值（已无量纲化）如下：\n- 入口面耦合系数：$\\hat{a}_{w} = 0.63$。\n- 单元 $1$ 和 $2$ 之间的内部面耦合系数：$\\hat{a}_{12} = 1.37$。\n- 出口面耦合系数：$\\hat{a}_{e} = 0.81$。\n- 预测通量不平衡产生的源项：$\\hat{b}_{1} = 0.071$ 和 $\\hat{b}_{2} = 0.023$。\n- 内部对角系数（施加边界条件前）：$\\hat{a}_{P,1} = \\hat{a}_{w} + \\hat{a}_{12}$ 和 $\\hat{a}_{P,2} = \\hat{a}_{12} + \\hat{a}_{e}$。\n\n仅从基本质量守恒定律 $\\nabla \\cdot \\mathbf{u} = 0$、有限体积形式的连续性方程以及将速度修正与压力修正联系起来的动量方程的预测-修正形式出发，完成以下任务：\n\n1. 针对 SIMPLE/PISO 算法，在入口（给定速度）和出口（给定静压）处，为压力 $p$ 和压力修正 $p^{\\prime}$ 推导物理上一致的边界条件，并解释为什么这些条件在修正步骤中能保持所施加的物理边界数据。\n2. 将这些边界条件转换为入口面和出口面上关于 $\\hat{p}^{\\prime}$ 的代数条件，并消去任何虚拟值，从而为未知的单元中心修正值 $\\hat{p}^{\\prime}_{1}$ 和 $\\hat{p}^{\\prime}_{2}$ 得到一个封闭的 $2\\times 2$ 线性系统。\n3. 求解该线性系统以获得 $\\hat{p}^{\\prime}_{1}$ 的值。\n\n将 $\\hat{p}^{\\prime}_{1}$ 的最终值以纯数字（无量纲）形式报告，并四舍五入到五位有效数字。", "solution": "该问题要求在一个离散化的一维通道流中确定无量纲压力修正 $\\hat{p}^{\\prime}_{1}$。这将按规定分三个阶段完成：首先，推导压力修正方程的适当边界条件；其次，构建由此产生的代数系统；第三，求解该系统。\n\n诸如 SIMPLE 和 PISO 等压力修正方法的基础，是对一个经过预测-修正序列更新的速度场强制执行质量守恒。修正后的速度场 $\\mathbf{u}$ 通过 $\\mathbf{u} = \\mathbf{u}^* + \\mathbf{u}'$ 与预测场 $\\mathbf{u}^*$ 相关联。预测场 $\\mathbf{u}^*$ 是使用预测压力场 $p^*$ 从动量方程中获得的，但它通常不满足连续性方程 $\\nabla \\cdot \\mathbf{u} = 0$。压力修正 $p'$ 的作用是产生一个速度修正 $\\mathbf{u}'$，以使最终的速度场 $\\mathbf{u}$ 是无散度的。\n\n速度修正与压力修正之间的联系由动量方程推导得出。对于一个垂直于 $x$ 方向的面 $f$，其简化形式为，速度修正与压力修正的梯度成正比：\n$$\nu'_f \\approx -d_f \\left(\\frac{\\partial p'}{\\partial x}\\right)_f\n$$\n其中 $d_f$ 是一个包含几何因子和离散化动量矩阵对角系数的项。压力修正方程本身是应用于修正后速度场的连续性方程的离散形式：$\\nabla \\cdot (\\mathbf{u}^* + \\mathbf{u}') = 0$，变为 $\\nabla \\cdot \\mathbf{u}' = -\\nabla \\cdot \\mathbf{u}^*$。右侧的项代表预测场的局部质量不平衡，并作为压力修正方程的源项。\n\n**第1部分：边界条件的推导**\n\n我们必须推导在入口和出口处压力修正 $p'$ 的边界条件。这些条件必须确保最终修正后的流动变量符合施加在域上的物理边界条件。\n\n*   **入口 ($x=0$)：给定速度**\n    入口速度 $u_{inlet}$ 是一个指定的恒定值。修正过程不能改变这个给定值。因此，入口面上的速度修正必须恒等于零：$u'_{inlet} = 0$。根据关系式 $u' \\propto -\\frac{\\partial p'}{\\partial x}$，零速度修正意味着压力修正在垂直于边界方向上的梯度为零。\n    $$\n    u'_{inlet} = 0 \\quad \\implies \\quad \\frac{\\partial p'}{\\partial x} \\bigg|_{x=0} = 0\n    $$\n    这是 $p'$ 的齐次诺伊曼 (Neumann) 边界条件。\n\n*   **出口 ($x=L$)：给定静压**\n    出口处的静压 $p_{outlet}$ 是给定的。在该边界上最终修正后的压力 $p_{outlet}$ 必须等于这个值。修正后的压力是预测压力与压力修正之和：$p = p^* + p'$。在出口处，这意味着 $p_{outlet} = p^*_{outlet} + p'_{outlet}$。\n    在标准做法中，预测压力场被外插到边界。一个常见且简单的选择是，将预测的边界压力设置为已知的最终边界压力：$p^*_{outlet} = p_{outlet}$。将此代入关系式，得到：\n    $$\n    p_{outlet} = p_{outlet} + p'_{outlet} \\quad \\implies \\quad p'_{outlet} = 0\n    $$\n    这是 $p'$ 的齐次狄利克雷 (Dirichlet) 边界条件。\n\n**第2部分：代数系统的构建**\n\n现在我们将这些边界条件应用于标记为 $1$ 和 $2$ 的两个控制体积 (CV) 的代数压力修正方程。问题提供了具有相邻单元 $W$ 和 $E$ 的内部单元 $P$ 的通用方程形式：\n$$\n\\hat{a}_{P}\\,\\hat{p}^{\\prime}_{P} = \\hat{a}_{W}\\,\\hat{p}^{\\prime}_{W} + \\hat{a}_{E}\\,\\hat{p}^{\\prime}_{E} + \\hat{b}_{P}\n$$\n其中，对于内部单元，$\\hat{a}_{P} = \\hat{a}_{W} + \\hat{a}_{E}$。\n\n*   **CV1 的方程：**\n    该单元与入口相邻。其西侧相邻的是入口边界面，东侧相邻的是单元 $2$。在施加边界条件之前，方程为：\n    $$\n    \\hat{a}_{P,1}\\,\\hat{p}^{\\prime}_{1} = \\hat{a}_{w}\\,\\hat{p}^{\\prime}_{ghost} + \\hat{a}_{12}\\,\\hat{p}^{\\prime}_{2} + \\hat{b}_{1}\n    $$\n    此处，$\\hat{p}^{\\prime}_{ghost}$ 是位于入口西侧的一个假设的虚拟单元中的值，用于实现诺伊曼 (Neumann) 条件。入口面上 $\\frac{\\partial \\hat{p}'}{\\partial x} = 0$ 的条件被离散化为 $(\\hat{p}^{\\prime}_1 - \\hat{p}^{\\prime}_{ghost})/\\Delta \\hat{x} = 0$，由此得出 $\\hat{p}^{\\prime}_{ghost} = \\hat{p}^{\\prime}_{1}$。将此代入 CV1 的方程：\n    $$\n    \\hat{a}_{P,1}\\,\\hat{p}^{\\prime}_{1} = \\hat{a}_{w}\\,\\hat{p}^{\\prime}_{1} + \\hat{a}_{12}\\,\\hat{p}^{\\prime}_{2} + \\hat{b}_{1}\n    $$\n    使用给定的定义 $\\hat{a}_{P,1} = \\hat{a}_{w} + \\hat{a}_{12}$：\n    $$\n    (\\hat{a}_{w} + \\hat{a}_{12})\\,\\hat{p}^{\\prime}_{1} = \\hat{a}_{w}\\,\\hat{p}^{\\prime}_{1} + \\hat{a}_{12}\\,\\hat{p}^{\\prime}_{2} + \\hat{b}_{1}\n    $$\n    $\\hat{a}_{w}\\,\\hat{p}^{\\prime}_{1}$ 项相互抵消，得到我们系统的第一个方程：\n    $$\n    \\hat{a}_{12}\\,\\hat{p}^{\\prime}_{1} - \\hat{a}_{12}\\,\\hat{p}^{\\prime}_{2} = \\hat{b}_{1}\n    $$\n\n*   **CV2 的方程：**\n    该单元与出口相邻。其西侧相邻的是单元 $1$，东侧相邻的是出口边界面。方程为：\n    $$\n    \\hat{a}_{P,2}\\,\\hat{p}^{\\prime}_{2} = \\hat{a}_{12}\\,\\hat{p}^{\\prime}_{1} + \\hat{a}_{e}\\,\\hat{p}^{\\prime}_{outlet} + \\hat{b}_{2}\n    $$\n    出口处的狄利克雷 (Dirichlet) 条件是 $\\hat{p}'_{outlet}=0$。代入后得到：\n    $$\n    \\hat{a}_{P,2}\\,\\hat{p}^{\\prime}_{2} = \\hat{a}_{12}\\,\\hat{p}^{\\prime}_{1} + \\hat{b}_{2}\n    $$\n    使用定义 $\\hat{a}_{P,2} = \\hat{a}_{12} + \\hat{a}_{e}$ 并重新整理，我们得到系统的第二个方程：\n    $$\n    -\\hat{a}_{12}\\,\\hat{p}^{\\prime}_{1} + (\\hat{a}_{12} + \\hat{a}_{e})\\,\\hat{p}^{\\prime}_{2} = \\hat{b}_{2}\n    $$\n\n得到的关于 $(\\hat{p}^{\\prime}_{1}, \\hat{p}^{\\prime}_{2})$ 的 $2 \\times 2$ 线性系统是：\n$$\n\\begin{pmatrix}\n\\hat{a}_{12} & -\\hat{a}_{12} \\\\\n-\\hat{a}_{12} & \\hat{a}_{12} + \\hat{a}_{e}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\hat{p}^{\\prime}_{1} \\\\\n\\hat{p}^{\\prime}_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\hat{b}_{1} \\\\\n\\hat{b}_{2}\n\\end{pmatrix}\n$$\n\n**第3部分：线性系统的求解**\n\n我们现在求解这个系统以得到 $\\hat{p}^{\\prime}_{1}$。一个简单的求解路径是将两个方程相加：\n$$\n(\\hat{a}_{12} - \\hat{a}_{12})\\hat{p}^{\\prime}_{1} + (-\\hat{a}_{12} + \\hat{a}_{12} + \\hat{a}_{e})\\hat{p}^{\\prime}_{2} = \\hat{b}_{1} + \\hat{b}_{2}\n$$\n这可以简化为：\n$$\n\\hat{a}_{e}\\hat{p}^{\\prime}_{2} = \\hat{b}_{1} + \\hat{b}_{2} \\quad \\implies \\quad \\hat{p}^{\\prime}_{2} = \\frac{\\hat{b}_{1} + \\hat{b}_{2}}{\\hat{a}_{e}}\n$$\n从物理上看，这表明来自两个单元的总质量不平衡 $\\hat{b}_{1} + \\hat{b}_{2}$ 必须通过出口排出，这是由最后一个单元中的压力修正 $\\hat{p}^{\\prime}_{2}$ 驱动的。\n\n现在，我们将 $\\hat{p}^{\\prime}_{2}$ 的这个表达式代回第一个方程 $\\hat{a}_{12}\\,\\hat{p}^{\\prime}_{1} - \\hat{a}_{12}\\,\\hat{p}^{\\prime}_{2} = \\hat{b}_{1}$，以求解 $\\hat{p}^{\\prime}_{1}$：\n$$\n\\hat{p}^{\\prime}_{1} = \\frac{\\hat{b}_{1}}{\\hat{a}_{12}} + \\hat{p}^{\\prime}_{2}\n$$\n$$\n\\hat{p}^{\\prime}_{1} = \\frac{\\hat{b}_{1}}{\\hat{a}_{12}} + \\frac{\\hat{b}_{1} + \\hat{b}_{2}}{\\hat{a}_{e}}\n$$\n这是 $\\hat{p}^{\\prime}_{1}$ 的符号解。\n\n最后，我们代入给定的数值：\n$\\hat{a}_{12} = 1.37$\n$\\hat{a}_{e} = 0.81$\n$\\hat{b}_{1} = 0.071$\n$\\hat{b}_{2} = 0.023$\n\n$$\n\\hat{p}^{\\prime}_{1} = \\frac{0.071}{1.37} + \\frac{0.071 + 0.023}{0.81}\n$$\n$$\n\\hat{p}^{\\prime}_{1} = \\frac{0.071}{1.37} + \\frac{0.094}{0.81}\n$$\n$$\n\\hat{p}^{\\prime}_{1} \\approx 0.051824817... + 0.116049382...\n$$\n$$\n\\hat{p}^{\\prime}_{1} \\approx 0.1678742...\n$$\n四舍五入到五位有效数字，结果是 $0.16787$。", "answer": "$$\n\\boxed{0.16787}\n$$", "id": "2516603"}, {"introduction": "虽然交错网格在教学中非常直观，但现代CFD代码通常更青睐于将所有变量存储在同一位置的同位网格（collocated grid）。然而，这种便利的网格布置可能导致压力场出现非物理性的棋盘状振荡。本练习将介绍具有重要影响力的Rhie-Chow插值格式，这是一种巧妙构建面网格速度的方法，它能有效防止压力-速度解耦，从而使同位网格成为一种既稳健又流行的选择[@problem_id:2516559]。", "problem": "某一直管道内的一维、定常、不可压缩牛顿流体流动，采用同位有限体积网格进行离散化，并借鉴压力耦合方程组的半隐式方法（SIMPLE）和算子分裂的压力隐式方法（PISO）算法的精神来耦合压力和速度。为防止同位网格上出现压力-速度解耦，采用 Rhie–Chow 插值方法来构建通过控制体表面的质量通量，使其与离散化的动量方程保持一致。\n\n考虑两个相邻的控制体，其中心分别位于 $P$ 点和 $E$ 点，共用一个交界面 $e$。设横截面积为 $A$，流体密度为常数 $\\rho$，且网格为均匀网格。对一个通用控制体写出的有限体积形式的 x 方向动量方程，可得到如下形式的线性代数方程\n$$\na_{i}\\,u_{i} \\;=\\; H_{i} \\;-\\; \\mathcal{P}_{i},\n$$\n其中 $i \\in \\{P,E\\}$，$u_{i}$ 是 x 方向的控制体中心速度，$a_{i}$ 是动量方程的对角系数（来自对流、扩散及任何线性化的时间项），$H_{i}$ 汇总了在当前迭代步计算的所有非压力贡献项，而 $\\mathcal{P}_{i}$ 代表了控制体表面上的离散压力-作用力贡献项。在 Rhie–Chow 方法中，用于构成表面质量通量的表面法向速度 $u_{e}$，是通过动量平衡中的非压力部分和一个与动量算子相一致的压力差项构建的，从而消除了虚假的压力振荡。\n\n两个相邻控制体及共享表面的数据如下：\n- $a_{P} = 5.00\\ \\mathrm{kg/s}$，$H_{P} = 12.00\\ \\mathrm{N}$，\n- $a_{E} = 4.00\\ \\mathrm{kg/s}$，$H_{E} = 8.00\\ \\mathrm{N}$，\n- $p_{P} = 101325\\ \\mathrm{Pa}$，$p_{E} = 101305\\ \\mathrm{Pa}$，\n- $A = 0.0200\\ \\mathrm{m^{2}}$，$\\rho = 1.20\\ \\mathrm{kg/m^{3}}$。\n\n从一个控制体的积分形式 x 方向动量平衡方程出发，并根据 $H_{i}$ 不包含压力作用力的定义，通过以下步骤推导与 Rhie–Chow 方法一致的、用 $H_{P}$、$H_{E}$、$a_{P}$、$a_{E}$、$A$、$p_{P}$ 和 $p_{E}$ 表示的交界面 $e$ 处的法向速度 $u_{e}$ 的线性表达式：\n- 首先，表示出 $P$ 点和 $E$ 点的无压力速度 $u_{i}^{H} = H_{i}/a_{i}$，\n- 然后，将 $u_{i}^{H}$ 的插值与一个使用动量方程对角系数倒数的算术平均值乘以 $A$ 的表面压力差贡献项相结合，从而构建 $u_{e}$。\n\n使用您推导的表达式，计算通过表面 $e$ 的质量流率，即 $\\dot{m}_{e} = \\rho\\,A\\,u_{e}$。请用 $\\mathrm{kg/s}$ 作为单位表示最终答案，并将结果四舍五入至四位有效数字。", "solution": "任务是推导与 Rhie-Chow 方法一致的表面法向速度 $u_e$ 的表达式，然后计算质量流率 $\\dot{m}_e$。\n\n我们从一个通用控制体 $i$ 的离散化动量方程开始：\n$$a_{i}\\,u_{i} \\;=\\; H_{i} \\;-\\; \\mathcal{P}_{i}$$\n其中 $u_i$ 是控制体中心速度，$a_i$ 是动量方程矩阵的对角系数，$H_i$ 包含除显式压力梯度项之外的所有源项和相邻控制体的贡献，而 $\\mathcal{P}_{i}$ 是控制体 $i$ 的压力-作用力项。\n\n为避免在使用朴素插值的同位网格上出现的压力-速度解耦，Rhie-Chow 方法不是通过直接插值控制体中心速度来构建表面速度 $u_e$，而是通过插值动量方程本身的分量来构建。\n\n遵循问题的指示，我们首先将在控制体中心 $i \\in \\{P,E\\}$ 的“无压力”速度定义为 $u_{i}^{H} = H_{i}/a_{i}$。这个伪速度代表了在没有显式压力梯度项时存在的速度场。对于控制体 $P$ 和 $E$ 之间的交界面 $e$，来自这些非压力项的贡献通过对 $u_{P}^{H}$ 和 $u_{E}^{H}$ 进行线性插值（对于均匀网格即为算术平均值）得到：\n$$\n\\overline{u^{H}}_{e} = \\frac{u_{P}^{H} + u_{E}^{H}}{2} = \\frac{1}{2}\\left(\\frac{H_{P}}{a_{P}} + \\frac{H_{E}}{a_{E}}\\right)\n$$\n接下来，我们添加一个压力贡献项。该项必须与动量离散化相一致，并使用交界面处的局部压力梯度，该梯度最好由相邻控制体中心压力之差 $p_E - p_P$ 来表示。问题指明，这个压力差需要按一个因子进行缩放，该因子由“动量方程对角系数倒数的算术平均值乘以 $A$”构建而成。对角系数的倒数是 $1/a_{P}$ 和 $1/a_{E}$。它们的算术平均值为：\n$$\n\\overline{\\left(\\frac{1}{a}\\right)}_{e} = \\frac{1}{2}\\left(\\frac{1}{a_{P}} + \\frac{1}{a_{E}}\\right)\n$$\n因此，在交界面处的压力驱动速度修正是与压力差 $(p_{P} - p_{E})$ 成正比的，比例常数涉及面积 $A$ 和平均后的系数倒数。正的压力梯度（即 $p_P > p_E$）必须驱动流体向正方向流动，因此在以下表达式中没有负号：\n$$\nu_{e, p} = A \\cdot \\overline{\\left(\\frac{1}{a}\\right)}_{e} \\cdot (p_{P} - p_{E}) = \\frac{A}{2}\\left(\\frac{1}{a_{P}} + \\frac{1}{a_{E}}\\right)(p_{P} - p_{E})\n$$\n结合这两个部分，交界面速度 $u_e$ 的最终 Rhie-Chow 表达式为：\n$$\nu_{e} = \\overline{u^{H}}_{e} + u_{e, p} = \\frac{1}{2}\\left(\\frac{H_{P}}{a_{P}} + \\frac{H_{E}}{a_{E}}\\right) + \\frac{A}{2}\\left(\\frac{1}{a_{P}} + \\frac{1}{a_{E}}\\right)(p_{P} - p_{E})\n$$\n现在我们代入给定的数值数据：\n- $a_{P} = 5.00\\ \\mathrm{kg/s}$\n- $H_{P} = 12.00\\ \\mathrm{N}$\n- $a_{E} = 4.00\\ \\mathrm{kg/s}$\n- $H_{E} = 8.00\\ \\mathrm{N}$\n- $p_{P} = 101325\\ \\mathrm{Pa}$\n- $p_{E} = 101305\\ \\mathrm{Pa}$\n- $A = 0.0200\\ \\mathrm{m^{2}}$\n- $\\rho = 1.20\\ \\mathrm{kg/m^{3}}$\n\n首先，我们计算插值的无压力速度项：\n$$\n\\overline{u^{H}}_{e} = \\frac{1}{2}\\left(\\frac{12.00}{5.00} + \\frac{8.00}{4.00}\\right) = \\frac{1}{2}(2.40 + 2.00) = 2.20\\ \\mathrm{m/s}\n$$\n接下来，我们计算压力贡献项。压力差为 $p_{P} - p_{E} = 101325 - 101305 = 20.0\\ \\mathrm{Pa}$。\n压力贡献系数为：\n$$\n\\frac{A}{2}\\left(\\frac{1}{a_{P}} + \\frac{1}{a_{E}}\\right) = \\frac{0.0200}{2}\\left(\\frac{1}{5.00} + \\frac{1}{4.00}\\right) = 0.0100 \\cdot (0.200 + 0.250) = 0.0100 \\cdot 0.450 = 0.00450\\ \\frac{\\mathrm{m^2 \\cdot s}}{\\mathrm{kg}}\n$$\n速度贡献值为：\n$$\nu_{e, p} = \\left(0.00450\\ \\frac{\\mathrm{m^2 \\cdot s}}{\\mathrm{kg}}\\right) \\cdot (20.0\\ \\mathrm{Pa}) = 0.0900\\ \\frac{\\mathrm{m^2 \\cdot s \\cdot N}}{\\mathrm{kg \\cdot m^2}} = 0.0900\\ \\frac{\\mathrm{kg \\cdot m \\cdot s}}{\\mathrm{s^2 \\cdot kg}} = 0.0900\\ \\mathrm{m/s}\n$$\n因此，总的交界面速度为：\n$$\nu_{e} = 2.20\\ \\mathrm{m/s} + 0.0900\\ \\mathrm{m/s} = 2.290\\ \\mathrm{m/s}\n$$\n最后一步是计算通过交界面 $e$ 的质量流率 $\\dot{m}_{e} = \\rho\\,A\\,u_{e}$：\n$$\n\\dot{m}_{e} = (1.20\\ \\mathrm{kg/m^3}) \\cdot (0.0200\\ \\mathrm{m^2}) \\cdot (2.290\\ \\mathrm{m/s}) = 0.05496\\ \\mathrm{kg/s}\n$$\n问题要求将结果四舍五入至四位有效数字。计算出的值 $0.05496$ 已经恰好是四位有效数字（$5$、$4$、$9$、$6$）。因此，无需进行四舍五入。", "answer": "$$\\boxed{0.05496}$$", "id": "2516559"}]}