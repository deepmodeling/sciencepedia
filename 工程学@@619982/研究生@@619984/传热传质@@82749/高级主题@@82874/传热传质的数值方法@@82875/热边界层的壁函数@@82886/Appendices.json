{"hands_on_practices": [{"introduction": "在实现任何计算模型之前，深入理解其解析形式及预测结果对经验常数的依赖性至关重要。本练习将引导您从基本的热输运假设出发，推导出经典的对数律温度分布，并运用敏感性分析来量化模型常数（如 $\\kappa$ 和 $Pr_t$）的不确定性对壁面热流预测的影响 [@problem_id:2537406]。这项实践不仅强化了理论基础，更揭示了壁函数的经验本质，并为评估模型的预测不确定度提供了定量方法。", "problem": "使用近壁热壁函数对等温光滑平板壁面上的湍流边界层在平衡重叠区进行建模。考虑一个近壁计算节点 $P$，其与壁面的法向距离为 $y_P$。假设流动为稳定、完全湍流、高雷诺数流动，在重叠区内，压力梯度效应可忽略不计，且与湍流热输运相比，分子热传导可忽略不计。使用梯度输运假设和涡扩散率封闭，并对湍流的动量和热量输运采用经典重叠标度。\n\n定义与数据：\n- $P$ 点处的流体性质：密度 $\\rho$、比热 $c_p$ 和运动粘度 $\\nu$。\n- 摩阻速度 $u_{\\tau}$、$P$ 点的当地平均速度 $U_P$、以及壁面与节点间的温差 $T_w - T_P$ 均为已知量。\n- 无量纲壁面距离 $y^+ \\equiv y_P u_{\\tau}/\\nu$ 和无量纲温度 $\\theta^+ \\equiv (T_w - T)\\,\\rho c_p u_{\\tau}/q_w$，其中 $q_w$ 是从壁面指向流体的壁面热通量。\n- 重叠区的热壁函数由 von Kármán 常数 $\\kappa$、一个捕捉了内层-外层匹配的热力学加性常数 $B_t$ 和湍流普朗特数 $Pr_t$ 表征。\n- 当地斯坦顿数由其量值定义为 $St \\equiv |q_w|/\\big(\\rho c_p U_P\\,|T_P - T_w|\\big)$。\n\n任务：\n1) 从近壁热通量封闭式 $q_w = -\\rho c_p(\\alpha + \\alpha_t)\\,\\partial T/\\partial y$（其中 $\\alpha$ 为分子热扩散率，$\\alpha_t$ 为湍流热扩散率）、平衡重叠区形式 $\\nu_t = \\kappa y u_{\\tau}$ 和 $\\alpha_t = \\nu_t/Pr_t$、以及上述 $\\theta^+$ 和 $y^+$ 的定义出发，推导 $\\theta^+$ 和 $y^+$ 之间的对数壁函数关系，其形式为 $\\theta^+(y^+) = \\text{(斜率)}\\times \\ln y^+ + \\text{(常数)}$。然后，在节点 $P$ 处对该关系式求值，并将 $q_w$ 显式求解为 $\\kappa$, $B_t$ 和 $Pr_t$ 的函数，其中 $y_P^+ \\equiv y_P u_{\\tau}/\\nu$ 及所有其他列出的量均视为已知。\n2) 使用你得到的 $q_w$ 表达式，将 $St$ 写成 $\\kappa$, $B_t$ 和 $Pr_t$ 的表达式。\n3) 对 $q_w$ 和 $St$ 相对于 $\\kappa$, $B_t$ 和 $Pr_t$ 进行基于一阶方差的局部灵敏度分析。假设这三个输入是独立的、服从高斯分布，且其不确定性仅通过以下名义值和单标准差不确定度体现：\n   - $\\kappa = 0.41$，$\\sigma_{\\kappa} = 0.02$，\n   - $B_t = 3.40$，$\\sigma_{B_t} = 0.50$，\n   - $Pr_t = 0.85$，$\\sigma_{Pr_t} = 0.05$.\n   所有其他量均为确定性的（无不确定性）。\n4) 使用名义点附近的一阶泰勒展开，量化 $\\kappa$, $B_t$ 和 $Pr_t$ 对输出方差 $\\operatorname{Var}(q_w)$ 和 $\\operatorname{Var}(St)$ 的分数贡献，即，对于一个输出 $f$，\n$$\n\\operatorname{Var}(f)\\,\\approx\\,\\left(\\frac{\\partial f}{\\partial \\kappa}\\right)^{\\!2}\\sigma_{\\kappa}^{2} \\;+\\; \\left(\\frac{\\partial f}{\\partial B_t}\\right)^{\\!2}\\sigma_{B_t}^{2} \\;+\\; \\left(\\frac{\\partial f}{\\partial Pr_t}\\right)^{\\!2}\\sigma_{Pr_t}^{2},\n$$\n且来自输入 $x_i$ 的分数贡献等于其对应项除以 $\\operatorname{Var}(f)$。在对 $\\kappa$, $B_t$ 和 $Pr_t$ 求导时，将 $y_P^+$ 视为常数。\n5) 使用以下数值数据进行评估：\n   - $\\rho = 1.20\\,\\text{kg}\\,\\text{m}^{-3}$, $c_p = 1005\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$,\n   - $\\nu = 1.50 \\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}$,\n   - $y_P = 1.00 \\times 10^{-3}\\,\\text{m}$,\n   - $u_{\\tau} = 0.50\\,\\text{m}\\,\\text{s}^{-1}$,\n   - $U_P = 10.0\\,\\text{m}\\,\\text{s}^{-1}$,\n   - $T_w - T_P = 20.0\\,\\text{K}$.\n按以下顺序报告六个方差贡献分数：\n$\\kappa$ in $q_w$, $B_t$ in $q_w$, $Pr_t$ in $q_w$, $\\kappa$ in $St$, $B_t$ in $St$, $Pr_t$ in $St$.\n将每个值表示为小数（无单位），并将答案四舍五入到四位有效数字。将这六个数字以单行矩阵的形式呈现。", "solution": "在尝试求解之前，对问题陈述进行验证。\n\n步骤 1：提取已知条件\n- **流动条件**：稳定、完全湍流、高雷诺数流动，流经等温光滑平板壁面。压力梯度效应可忽略不计。\n- **关注区域**：平衡重叠区。\n- **传热模型**：梯度输运假设和涡扩散率封闭。在重叠区，分子热传导 $\\alpha$ 与湍流热输运 $\\alpha_t$ 相比可忽略不计。\n- **本构关系**：$q_w = -\\rho c_p(\\alpha + \\alpha_t)\\,\\partial T/\\partial y$, $\\nu_t = \\kappa y u_{\\tau}$, $\\alpha_t = \\nu_t/Pr_t$。\n- **流体性质**：密度 $\\rho$、比热 $c_p$、运动粘度 $\\nu$。\n- **已知变量**：摩阻速度 $u_{\\tau}$、节点 $P$ 处的平均速度 $U_P$、温差 $T_w - T_P$、节点 $P$ 距壁面的距离 $y_P$。\n- **定义**：\n  - 无量纲壁面距离：$y^+ \\equiv y u_{\\tau}/\\nu$。\n  - 无量纲温度：$\\theta^+ \\equiv (T_w - T)\\,\\rho c_p u_{\\tau}/q_w$。\n  - 壁面热通量 $q_w$ 从壁面指向流体。\n  - 当地斯坦顿数：$St \\equiv |q_w|/\\big(\\rho c_p U_P\\,|T_P - T_w|\\big)$。\n- **模型参数**：von Kármán 常数 $\\kappa$、热力学加性常数 $B_t$、湍流普朗特数 $Pr_t$。\n- **灵敏度分析输入**：\n  - $\\kappa = 0.41$，$\\sigma_{\\kappa} = 0.02$。\n  - $B_t = 3.40$，$\\sigma_{B_t} = 0.50$。\n  - $Pr_t = 0.85$，$\\sigma_{Pr_t} = 0.05$。\n  - 这些输入是独立的，服从高斯分布。\n- **灵敏度分析公式**：$\\operatorname{Var}(f)\\,\\approx\\,\\sum_i \\left(\\frac{\\partial f}{\\partial x_i}\\right)^{\\!2}\\sigma_{x_i}^{2}$。\n- **灵敏度分析约束**：在对 $\\kappa$, $B_t$ 和 $Pr_t$ 求导时，将 $y_P^+$ 视为常数。\n- **用于评估的数值数据**：\n  - $\\rho = 1.20\\,\\text{kg}\\,\\text{m}^{-3}$, $c_p = 1005\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$, $\\nu = 1.50 \\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}$。\n  - $y_P = 1.00 \\times 10^{-3}\\,\\text{m}$, $u_{\\tau} = 0.50\\,\\text{m}\\,\\text{s}^{-1}$, $U_P = 10.0\\,\\text{m}\\,\\text{s}^{-1}$, $T_w - T_P = 20.0\\,\\text{K}$。\n\n步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是湍流传热和计算流体动力学（CFD）中关于壁函数的标准练习。问题是适定的，有足够的信息和一致的定义来推导出唯一解。语言客观而精确。物理参数符合实际。该问题不违反任何基本原理，并且完全可以形式化。\n\n步骤 3：结论与行动\n该问题被认为是**有效的**。将提供解答。\n\n**任务 1：热壁函数的推导及 $q_w$ 的表达式**\n\n起点是法向 $y$ 上的近壁热通量封闭式：\n$$\nq_w = -\\rho c_p(\\alpha + \\alpha_t)\\frac{dT}{dy}\n$$\n在湍流重叠区，分子扩散率与湍流扩散率相比可以忽略不计，即 $\\alpha \\ll \\alpha_t$。因此，方程简化为：\n$$\nq_w \\approx -\\rho c_p \\alpha_t \\frac{dT}{dy}\n$$\n使用给定的湍流扩散率关系式 $\\alpha_t = \\nu_t/Pr_t$ 和涡粘度关系式 $\\nu_t = \\kappa y u_{\\tau}$：\n$$\nq_w \\approx -\\rho c_p \\left( \\frac{\\kappa y u_{\\tau}}{Pr_t} \\right) \\frac{dT}{dy}\n$$\n我们重新整理方程以求解温度梯度：\n$$\n\\frac{dT}{dy} \\approx -\\frac{q_w Pr_t}{\\rho c_p \\kappa y u_{\\tau}}\n$$\n接下来，我们使用无量纲温度 $\\theta^+$ 和无量纲壁面距离 $y^+$ 的定义。对 $\\theta^+ = (T_w - T)\\rho c_p u_{\\tau}/q_w$ 关于 $y$ 求导，得到：\n$$\n\\frac{d\\theta^+}{dy} = -\\frac{\\rho c_p u_{\\tau}}{q_w} \\frac{dT}{dy}\n$$\n代入 $dT/dy$ 的表达式：\n$$\n\\frac{d\\theta^+}{dy} = -\\frac{\\rho c_p u_{\\tau}}{q_w} \\left( -\\frac{q_w Pr_t}{\\rho c_p \\kappa y u_{\\tau}} \\right) = \\frac{Pr_t}{\\kappa y}\n$$\n为了用壁面单位表示，我们使用链式法则和 $y^+ = y u_{\\tau}/\\nu$：\n$$\n\\frac{d\\theta^+}{dy^+} = \\frac{d\\theta^+}{dy} \\frac{dy}{dy^+} = \\left( \\frac{Pr_t}{\\kappa y} \\right) \\left( \\frac{\\nu}{u_{\\tau}} \\right)\n$$\n代入 $y = y^+ \\nu / u_{\\tau}$：\n$$\n\\frac{d\\theta^+}{dy^+} = \\frac{Pr_t}{\\kappa (y^+ \\nu / u_{\\tau})} \\frac{\\nu}{u_{\\tau}} = \\frac{Pr_t}{\\kappa y^+}\n$$\n对这个常微分方程积分，得到温度的对数律：\n$$\n\\theta^+(y^+) = \\int \\frac{Pr_t}{\\kappa y^+} dy^+ = \\frac{Pr_t}{\\kappa} \\ln(y^+) + C\n$$\n积分常数 $C$ 是热力学加性常数，此处记为 $B_t$。因此，壁函数为：\n$$\n\\theta^+(y^+) = \\frac{Pr_t}{\\kappa} \\ln(y^+) + B_t\n$$\n这与所要求的形式 $\\theta^+(y^+) = \\text{(斜率)}\\times \\ln y^+ + \\text{(常数)}$ 相匹配，其中斜率为 $Pr_t/\\kappa$，常数为 $B_t$。\n为了求解 $q_w$，我们在近壁节点 $P$ (此处 $y=y_P$ 且 $T=T_P$) 处计算该关系式：\n$$\n\\theta^+_P = \\frac{(T_w - T_P)\\rho c_p u_{\\tau}}{q_w} = \\frac{Pr_t}{\\kappa} \\ln(y^+_P) + B_t\n$$\n显式求解 $q_w$：\n$$\nq_w = \\frac{(T_w - T_P)\\rho c_p u_{\\tau}}{\\frac{Pr_t}{\\kappa} \\ln(y^+_P) + B_t}\n$$\n\n**任务 2：斯坦顿数 $St$ 的表达式**\n\n斯坦顿数定义为 $St \\equiv |q_w|/\\big(\\rho c_p U_P\\,|T_P - T_w|\\big)$。由于 $T_w - T_P > 0$，可知从壁面到流体的热通量 $q_w$ 为正。因此，$|q_w| = q_w$ 且 $|T_P - T_w| = T_w - T_P$。定义可简化为：\n$$\nSt = \\frac{q_w}{\\rho c_p U_P (T_w - T_P)}\n$$\n将任务 1 中得到的 $q_w$ 表达式代入：\n$$\nSt = \\frac{1}{\\rho c_p U_P (T_w - T_P)} \\left( \\frac{(T_w - T_P)\\rho c_p u_{\\tau}}{\\frac{Pr_t}{\\kappa} \\ln(y^+_P) + B_t} \\right)\n$$\n消去公因子 $\\rho$, $c_p$ 和 $(T_w - T_P)$，得到 $St$ 的表达式：\n$$\nSt = \\frac{u_{\\tau}}{U_P \\left( \\frac{Pr_t}{\\kappa} \\ln(y^+_P) + B_t \\right)}\n$$\n\n**任务 3 和 4：灵敏度分析与方差贡献**\n\n令分母项为 $D(\\kappa, B_t, Pr_t) = \\frac{Pr_t}{\\kappa} \\ln(y^+_P) + B_t$。则我们有：\n$$\nq_w = \\frac{C_1}{D} \\quad \\text{其中} \\quad C_1 = (T_w - T_P)\\rho c_p u_{\\tau}\n$$\n$$\nSt = \\frac{C_2}{D} \\quad \\text{其中} \\quad C_2 = \\frac{u_{\\tau}}{U_P}\n$$\n问题陈述要求在对 $\\kappa$, $B_t$ 和 $Pr_t$ 求导时将 $y_P^+$ 视为常数。因此，$C_1$和 $C_2$ 也被视为常数。\n对于一般函数 $f = C/D$，其对 $D$ 的一个参数 $x_i$ 的偏导数为 $\\frac{\\partial f}{\\partial x_i} = -\\frac{C}{D^2} \\frac{\\partial D}{\\partial x_i} = -\\frac{f}{D} \\frac{\\partial D}{\\partial x_i}$。\n输入 $x_i$ 的方差项为 $\\left(\\frac{\\partial f}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2 = \\left(-\\frac{f}{D}\\right)^2 \\left(\\frac{\\partial D}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2 = \\frac{f^2}{D^2} \\left(\\frac{\\partial D}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2$。\n总的一阶方差为 $\\operatorname{Var}(f) \\approx \\sum_i \\frac{f^2}{D^2} \\left(\\frac{\\partial D}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2 = \\frac{f^2}{D^2} \\sum_i \\left(\\frac{\\partial D}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2$。\n输入 $x_k$ 对 $f$ 的方差的分数贡献为：\n$$\nF_{f, x_k} = \\frac{\\frac{f^2}{D^2} \\left(\\frac{\\partial D}{\\partial x_k}\\right)^2 \\sigma_{x_k}^2}{\\frac{f^2}{D^2} \\sum_i \\left(\\frac{\\partial D}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2} = \\frac{\\left(\\frac{\\partial D}{\\partial x_k}\\right)^2 \\sigma_{x_k}^2}{\\sum_i \\left(\\frac{\\partial D}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2}\n$$\n只要函数 $f$ 的形式为 $C/D$，这个分数就与 $f$（$q_w$ 或 $St$）无关。因此，对 $q_w$ 和 $St$ 的方差分数贡献是相同的。我们只需计算一次。\n\n令 $L = \\ln(y^+_P)$。所需的 $D = \\frac{Pr_t}{\\kappa}L + B_t$ 的偏导数为：\n$$\n\\frac{\\partial D}{\\partial \\kappa} = -\\frac{Pr_t}{\\kappa^2}L\n$$\n$$\n\\frac{\\partial D}{\\partial B_t} = 1\n$$\n$$\n\\frac{\\partial D}{\\partial Pr_t} = \\frac{L}{\\kappa}\n$$\n构成总方差因子 $\\sum_i (\\partial D/\\partial x_i)^2 \\sigma_{x_i}^2$ 的三个项是：\n- $\\kappa$ 的项： $V_\\kappa = \\left(-\\frac{Pr_t L}{\\kappa^2}\\right)^2 \\sigma_\\kappa^2 = \\frac{Pr_t^2 L^2}{\\kappa^4} \\sigma_\\kappa^2$\n- $B_t$ 的项： $V_{B_t} = (1)^2 \\sigma_{B_t}^2 = \\sigma_{B_t}^2$\n- $Pr_t$ 的项： $V_{Pr_t} = \\left(\\frac{L}{\\kappa}\\right)^2 \\sigma_{Pr_t}^2 = \\frac{L^2}{\\kappa^2} \\sigma_{Pr_t}^2$\n\n总方差因子为 $V_{tot} = V_\\kappa + V_{B_t} + V_{Pr_t}$。分数贡献为 $F_\\kappa = V_\\kappa/V_{tot}$, $F_{B_t} = V_{B_t}/V_{tot}$ 和 $F_{Pr_t} = V_{Pr_t}/V_{tot}$。\n\n**任务 5：数值评估**\n\n首先，计算无量纲壁面距离 $y^+_P$：\n$$\ny^+_P = \\frac{y_P u_{\\tau}}{\\nu} = \\frac{(1.00 \\times 10^{-3}\\,\\text{m}) (0.50\\,\\text{m}\\,\\text{s}^{-1})}{1.50 \\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}} = \\frac{0.5 \\times 10^{-3}}{1.5 \\times 10^{-5}} = \\frac{1}{3} \\times 10^2 = \\frac{100}{3}\n$$\n现在，计算 $L = \\ln(y^+_P)$：\n$$\nL = \\ln\\left(\\frac{100}{3}\\right) \\approx 3.5065579\n$$\n我们使用参数的名义值：$\\kappa = 0.41$, $B_t = 3.40$, $Pr_t = 0.85$。标准差为 $\\sigma_\\kappa=0.02$, $\\sigma_{B_t}=0.50$, $\\sigma_{Pr_t}=0.05$.\n\n现在，计算方差分量：\n$$\nV_\\kappa = \\frac{0.85^2 \\times (\\ln(100/3))^2}{0.41^4} \\times 0.02^2\n= \\frac{0.7225 \\times 12.295946}{0.02825761} \\times 0.0004 \\approx 314.390 \\times 0.0004 \\approx 0.125756\n$$\n$$\nV_{B_t} = 0.50^2 = 0.25\n$$\n$$\nV_{Pr_t} = \\frac{(\\ln(100/3))^2}{0.41^2} \\times 0.05^2\n= \\frac{12.295946}{0.1681} \\times 0.0025 \\approx 73.1466 \\times 0.0025 \\approx 0.182867\n$$\n总方差分量为：\n$$\nV_{tot} = V_\\kappa + V_{B_t} + V_{Pr_t} \\approx 0.125756 + 0.25 + 0.182867 = 0.558623\n$$\n分数贡献为：\n$$\nF_\\kappa = \\frac{V_\\kappa}{V_{tot}} \\approx \\frac{0.125756}{0.558623} \\approx 0.22514\n$$\n$$\nF_{B_t} = \\frac{V_{B_t}}{V_{tot}} \\approx \\frac{0.25}{0.558623} \\approx 0.44755\n$$\n$$\nF_{Pr_t} = \\frac{V_{Pr_t}}{V_{tot}} \\approx \\frac{0.182867}{0.558623} \\approx 0.32731\n$$\n四舍五入到四位有效数字：\n- 来自 $\\kappa$ 的贡献： $0.2251$\n- 来自 $B_t$ 的贡献： $0.4476$\n- 来自 $Pr_t$ 的贡献： $0.3273$\n总和为 $0.2251 + 0.4476 + 0.3273 = 1.0000$.\n\n如前所述，对 $q_w$ 方差的分数贡献与对 $St$ 的相同。所需的六个值是这三个数字重复一次。\n最终值：\n- $F_{q_w,\\kappa} = F_{St,\\kappa} \\approx 0.2251$\n- $F_{q_w,B_t} = F_{St,B_t} \\approx 0.4476$\n- $F_{q_w,Pr_t} = F_{St,Pr_t} \\approx 0.3273$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.2251 & 0.4476 & 0.3273 & 0.2251 & 0.4476 & 0.3273\n\\end{pmatrix}\n}\n$$", "id": "2537406"}, {"introduction": "真实世界的工程问题常常涉及剧烈的温度变化，这使得流体的物性不再是常数。本练习旨在解决这一复杂性，要求您设计并实现一个不动点迭代方案 [@problem_id:2537356]。通过该迭代，壁函数计算中所使用的流体物性（如密度 $\\rho$、粘度 $\\mu$ 等）能够与壁函数自身预测的温度分布保持热力学一致性。这是在实际工程场景中获得精确传热预测的关键一步，也锻炼了处理强耦合非线性问题的能力。", "problem": "考虑一个等温平壁上充分发展的定常湍流边界层，该边界层中有一个近壁计算网格，其中心距壁面的法向距离为 $y_P$。设网格中心温度为 $T_P$，壁面温度为 $T_w$。假设空气为低马赫数流动，因此热物理性质可视为仅是温度的函数。任务目标是使用热壁函数计算一个热力学上一致的壁面热通量 $q_w$，同时在 $T_P$ 和 $T_w$ 之间迭代更新物性参数的计算值。\n\n从以下基本原理和经过充分检验的公式出发：\n\n- 恒定静压 $p$ 下的空气理想气体定律：$\\rho(T) = \\dfrac{p}{R T}$，其中 $R = 287.058\\ \\mathrm{J/(kg\\cdot K)}$。\n- 通过Sutherland定律计算的动力粘度：\n$$\n\\mu(T) = \\mu_0 \\left(\\dfrac{T}{T_0}\\right)^{3/2} \\dfrac{T_0 + S}{T + S},\\quad \\mu_0 = 1.716\\times 10^{-5}\\ \\mathrm{Pa\\cdot s},\\ T_0 = 273.15\\ \\mathrm{K},\\ S = 110.4\\ \\mathrm{K}.\n$$\n- 热导率（空气在中等温度范围内的经验线性拟合）：\n$$\nk(T) = k_0 + a_k\\,(T - T_0),\\quad k_0 = 0.0241\\ \\mathrm{W/(m\\cdot K)},\\ a_k = 7.2\\times 10^{-5}\\ \\mathrm{W/(m\\cdot K^2)},\\ T_0 = 273.15\\ \\mathrm{K}.\n$$\n- 定压比热（经验线性拟合）：\n$$\nc_p(T) = c_{p0} + a_{cp}\\,(T - 300\\ \\mathrm{K}),\\quad c_{p0} = 1006.43\\ \\mathrm{J/(kg\\cdot K)},\\ a_{cp} = 0.1\\ \\mathrm{J/(kg\\cdot K^2)}.\n$$\n- 分子普朗特数：\n$$\n\\Pr(T) = \\dfrac{\\mu(T)\\,c_p(T)}{k(T)}.\n$$\n- 湍流普朗特数视为常数：$\\Pr_t = 0.85$。\n- 定义摩擦速度 $u_\\tau$ 和无量纲壁面距离\n$$\ny^+ = \\dfrac{\\rho\\,u_\\tau\\,y_P}{\\mu}.\n$$\n- 由下式定义温度标度与壁面热通量：\n$$\nT_\\tau = \\dfrac{q_w}{\\rho\\,c_p\\,u_\\tau},\\qquad q_w = \\rho\\,c_p\\,u_\\tau\\,T_\\tau,\n$$\n以及网格中心的内尺度温度\n$$\nT^+ = \\dfrac{T_P - T_w}{T_\\tau}.\n$$\n\n采用一个标准的分段热壁函数剖面，它在匹配点处连续地连接粘性子层和对数区。设 $\\kappa = 0.41$，$E = 9.8$ 且 $y_0^+ = 11.81$。定义有效对数斜率为 $\\kappa_t = \\kappa\\,\\Pr_t$。那么，对于给定的 $y^+$ 和分子普朗特数 $\\Pr$，\n$$\nT^+(y^+;\\Pr) =\n\\begin{cases}\n\\Pr\\,y^+, & y^+ \\le y_0^+ \\\\[4pt]\n\\dfrac{1}{\\kappa_t}\\ln\\!\\big(E\\,y^+\\big) + B_t(\\Pr), & y^+ > y_0^+\n\\end{cases}\n$$\n其中加性常数确保在 $y_0^+$ 处的连续性：\n$$\nB_t(\\Pr) = \\Pr\\,y_0^+ - \\dfrac{1}{\\kappa_t}\\ln\\!\\big(E\\,y_0^+\\big).\n$$\n\n任务 A（推导）。使用上述定义和壁面的能量平衡，推导出一个不动点迭代方法，用于在壁函数循环中对 $T_P$ 和 $T_w$ 之间的物性评估强制实现热力学一致性。你的迭代过程必须：\n- 使用一个参考温度 $T_{\\mathrm{ref}}$ 来评估 $\\rho(T_{\\mathrm{ref}})$、$\\mu(T_{\\mathrm{ref}})$、$k(T_{\\mathrm{ref}})$、$c_p(T_{\\mathrm{ref}})$ 和 $\\Pr(T_{\\mathrm{ref}})$。\n- 计算 $y^+ = \\rho(T_{\\mathrm{ref}})\\,u_\\tau\\,y_P/\\mu(T_{\\mathrm{ref}})$，然后计算 $T^+(y^+;\\Pr(T_{\\mathrm{ref}}))$，接着是 $T_\\tau = (T_P - T_w)/T^+(y^+;\\Pr(T_{\\mathrm{ref}}))$ 和 $q_w = \\rho(T_{\\mathrm{ref}})\\,c_p(T_{\\mathrm{ref}})\\,u_\\tau\\,T_\\tau$。\n- 根据壁函数温度分布更新 $T_{\\mathrm{ref}}$，以更好地表示 $T_P$ 和 $T_w$ 之间的热力学状态。一种有据可循的选择是取基于剖面的中点温度：令 $y_m^+ = y^+/2$ 并设置\n$$\nT_{\\mathrm{mid}} = T_w + T_\\tau\\,T^+(y_m^+;\\Pr(T_{\\mathrm{ref}})).\n$$\n用松弛因子 $\\beta \\in (0,1]$ 构造一个松弛不动点更新 $T_{\\mathrm{ref}} \\leftarrow (1-\\beta)\\,T_{\\mathrm{ref}} + \\beta\\,T_{\\mathrm{mid}}$，并进行迭代直至 $T_{\\mathrm{ref}}$ 收敛。\n\n提供一个关于 $|T_{\\mathrm{ref}}^{(n+1)} - T_{\\mathrm{ref}}^{(n)}|$ 的清晰停止准则，并讨论如何防止发散，以及如何确保更新后的 $T_{\\mathrm{ref}}$ 保持在 $T_w$ 和 $T_P$ 之间的物理允许区间内。\n\n任务 B（实现）。将推导出的迭代过程实现为代码，对每个测试用例返回：\n- 收敛后的壁面热通量 $q_w$，单位为 $\\mathrm{W/m^2}$，四舍五入到3位小数，\n- 收敛后的 $y^+$，四舍五入到3位小数，\n- 迭代次数（一个整数），\n- 一个整数形式的收敛标志，其中 $1$ 表示收敛， $0$ 表示在迭代次数限制内未能收敛。\n\n使用以下测试套件，它涵盖了一个典型情况、一个粘性子层主导的情况、一个物性变化剧烈的高 $y^+$ 情况，以及一个小温差情况：\n\n- 情况 1：$p = 101325\\ \\mathrm{Pa}$，$T_w = 300\\ \\mathrm{K}$，$T_P = 600\\ \\mathrm{K}$，$u_\\tau = 0.5\\ \\mathrm{m/s}$，$y_P = 5.0\\times 10^{-4}\\ \\mathrm{m}$。\n- 情况 2：$p = 101325\\ \\mathrm{Pa}$，$T_w = 350\\ \\mathrm{K}$，$T_P = 400\\ \\mathrm{K}$，$u_\\tau = 0.3\\ \\mathrm{m/s}$，$y_P = 1.0\\times 10^{-4}\\ \\mathrm{m}$。\n- 情况 3：$p = 101325\\ \\mathrm{Pa}$，$T_w = 300\\ \\mathrm{K}$，$T_P = 1200\\ \\mathrm{K}$，$u_\\tau = 1.0\\ \\mathrm{m/s}$，$y_P = 3.0\\times 10^{-3}\\ \\mathrm{m}$。\n- 情况 4：$p = 101325\\ \\mathrm{Pa}$，$T_w = 320\\ \\mathrm{K}$，$T_P = 321\\ \\mathrm{K}$，$u_\\tau = 0.2\\ \\mathrm{m/s}$，$y_P = 1.0\\times 10^{-3}\\ \\mathrm{m}$。\n\n数值和实现要求：\n\n- 使用 $10^{-6}\\ \\mathrm{K}$ 的收敛容差 $|T_{\\mathrm{ref}}^{(n+1)} - T_{\\mathrm{ref}}^{(n)}| < 10^{-6}\\ \\mathrm{K}$，最多 $100$ 次迭代，并选择松弛因子 $\\beta = 0.5$。\n- 在每次迭代中，将更新的 $T_{\\mathrm{ref}}$ 限制在以 $\\min(T_w,T_P)$ 和 $\\max(T_w,T_P)$ 为端点的闭区间内。\n- 所有常数和系数必须与上面指定的完全一致。\n- 你的程序应该生成单行输出，其中包含所有测试用例的结果，格式为无空格、逗号分隔的列表之列表，并按测试用例的顺序排列。格式必须是：\n\"[ [q1,yplus1,it1,conv1], [q2,yplus2,it2,conv2], [q3,yplus3,it3,conv3], [q4,yplus4,it4,conv4] ]\"\n但无空格，即：\n\"[[q1,yplus1,it1,conv1],[q2,yplus2,it2,conv2],[q3,yplus3,it3,conv3],[q4,yplus4,it4,conv4]]\"\n其中每个 $q_i$ 的单位是 $\\mathrm{W/m^2}$ 并四舍五入到3位小数，每个 $y^+_i$ 四舍五入到3位小数，$it_i$ 和 $conv_i$ 是整数。", "solution": "问题陈述经过验证，被认为是科学上可靠、提法恰当且完整的。它描述了计算传热学中一个标准且重要的问题：在湍流边界层中使用热壁函数计算壁面热通量，并增加了处理随温度变化的流体性质这一复杂性。为获得唯一解所需的所有物理模型、常数和数值参数均已提供。任务是推导并实现一个不动点迭代，以确保流体性质在一个热力学上一致的参考温度下进行评估。\n\n推导和实现如下。\n\n目标是计算壁面热通量 $q_w$，给定壁面温度 $T_w$、近壁网格中心在距离 $y_P$ 处的温度 $T_P$、静压 $p$ 和摩擦速度 $u_\\tau$。由于流体性质（$\\rho$、$\\mu$、$k$、$c_p$）是温度的强函数，它们必须在一个能正确反映近壁层热状态的代表性温度 $T_{\\mathrm{ref}}$ 下进行评估。需要一个迭代过程来找到一个自洽的 $T_{\\mathrm{ref}}$ 及相应的 $q_w$。为此目的构建了一个不动点迭代方案。\n\n设迭代由 $n$ 索引。该过程从参考温度的初始猜测值 $T_{\\mathrm{ref}}^{(0)}$ 开始。一个稳健的初始猜测值是壁面温度和网格中心温度的算术平均值：\n$$\nT_{\\mathrm{ref}}^{(0)} = \\frac{T_w + T_P}{2}\n$$\n\n对于 $n = 0, 1, 2, \\dots$，迭代过程如下：\n\n1.  **评估热物理性质**：在当前参考温度 $T_{\\mathrm{ref}}^{(n)}$ 下，计算所有随温度变化的性质：\n    *   根据理想气体定律计算密度：$\\rho^{(n)} = \\rho(T_{\\mathrm{ref}}^{(n)}) = \\dfrac{p}{R T_{\\mathrm{ref}}^{(n)}}$。\n    *   根据Sutherland定律计算动力粘度：$\\mu^{(n)} = \\mu(T_{\\mathrm{ref}}^{(n)})$。\n    *   根据线性拟合计算热导率：$k^{(n)} = k(T_{\\mathrm{ref}}^{(n)})$。\n    *   根据线性拟合计算定压比热：$c_p^{(n)} = c_p(T_{\\mathrm{ref}}^{(n)})$。\n    *   分子普朗特数：$\\Pr^{(n)} = \\Pr(T_{\\mathrm{ref}}^{(n)}) = \\dfrac{\\mu^{(n)} c_p^{(n)}}{k^{(n)}}$。\n\n2.  **计算无量纲参数**：计算位于 $y_P$ 处的网格中心的无量纲壁面距离：\n    $$\n    y^{+(n)} = \\frac{\\rho^{(n)} u_\\tau y_P}{\\mu^{(n)}}\n    $$\n\n3.  **评估无量纲温度 $T^+$**：使用所提供的分段热壁面律，计算网格中心的无量纲温度 $T_P^{+(n)} = T^+(y^{+(n)}; \\Pr^{(n)})$。有效对数斜率为 $\\kappa_t = \\kappa \\Pr_t = 0.41 \\times 0.85 = 0.3485$。首先确定加性常数 $B_t$ 以确保在匹配点 $y_0^+ = 11.81$ 处的连续性：\n    $$\n    B_t^{(n)} = \\Pr^{(n)} y_0^+ - \\frac{1}{\\kappa_t}\\ln(E y_0^+)\n    $$\n    然后，由下式求出 $T_P^{+(n)}$：\n    $$\n    T_P^{+(n)} =\n    \\begin{cases}\n    \\Pr^{(n)} y^{+(n)}, & \\text{若 } y^{+(n)} \\le y_0^+ \\\\\n    \\dfrac{1}{\\kappa_t}\\ln(E y^{+(n)}) + B_t^{(n)}, & \\text{若 } y^{+(n)} > y_0^+\n    \\end{cases}\n    $$\n\n4.  **计算热通量**：根据其定义计算温度标度 $T_\\tau^{(n)}$：\n    $$\n    T_\\tau^{(n)} = \\frac{T_P - T_w}{T_P^{+(n)}}\n    $$\n    则本次迭代的壁面热通量为：\n    $$\n    q_w^{(n)} = \\rho^{(n)} c_p^{(n)} u_\\tau T_\\tau^{(n)}\n    $$\n\n5.  **更新参考温度**：基于当前解计算一个新的、更准确的参考温度。计算一个新温度 $T_{\\mathrm{mid}}^{(n)}$，它代表近壁层中点 $y_m = y_P/2$ 处的物理温度。首先，无量纲中点距离为 $y_m^{+(n)} = y^{+(n)}/2$。使用与步骤3中相同的分段函数计算该点处的无量纲温度 $T_m^{+(n)} = T^+(y_m^{+(n)}; \\Pr^{(n)})$。则物理中点温度为：\n    $$\n    T_{\\mathrm{mid}}^{(n)} = T_w + T_\\tau^{(n)} T_m^{+(n)}\n    $$\n    使用松弛因子 $\\beta = 0.5$ 通过松弛更新获得下一次迭代的参考温度 $T_{\\mathrm{ref}}^{(n+1)}$：\n    $$\n    T_{\\mathrm{ref, cand}}^{(n+1)} = (1-\\beta)T_{\\mathrm{ref}}^{(n)} + \\beta T_{\\mathrm{mid}}^{(n)}\n    $$\n\n6.  **稳定化与收敛性检查**：\n    *   **防止发散**：为确保数值稳定性和物理合理性，更新后的参考温度必须保持在由壁面温度和网格中心温度设定的界限内。因此，对 $T_{\\mathrm{ref, cand}}^{(n+1)}$ 进行限制：\n      $$\n      T_{\\mathrm{ref}}^{(n+1)} = \\max(\\min(T_w, T_P), \\min(\\max(T_w, T_P), T_{\\mathrm{ref, cand}}^{(n+1)}))\n      $$\n      此步骤可防止迭代产生不符合物理实际的温度，特别是在温差较大或迭代初始阶段的情况下。\n    *   **停止准则**：当连续参考温度之间的绝对差值小于指定的容差 $\\epsilon_T = 10^{-6}\\ \\mathrm{K}$ 时，认为迭代已收敛：\n      $$\n      |T_{\\mathrm{ref}}^{(n+1)} - T_{\\mathrm{ref}}^{(n)}| < \\epsilon_T\n      $$\n    *   **迭代次数限制**：设定最大迭代次数 $N_{\\max} = 100$。如果在此限制内未达到收敛准则，则终止过程并标记为未收敛。\n\n收敛或达到迭代次数限制后，报告 $q_w$、$y^+$、迭代次数和收敛标志的最终值。这完成了所需算法的逻辑，该算法在提供的Python代码中实现。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for wall heat flux using a thermal wall function with iterative property updates.\n    \"\"\"\n    # Constants\n    R = 287.058  # J/(kg.K), specific gas constant for air\n    # Sutherland's law for viscosity\n    MU0 = 1.716e-5  # Pa.s\n    T0_MU = 273.15  # K\n    S_MU = 110.4  # K\n    # Linear fit for thermal conductivity\n    K0 = 0.0241  # W/(m.K)\n    AK = 7.2e-5  # W/(m.K^2)\n    T0_K = 273.15 # K\n    # Linear fit for specific heat\n    CP0 = 1006.43  # J/(kg.K)\n    ACP = 0.1  # J/(kg.K^2)\n    T0_CP = 300.0 # K\n    # Turbulence model constants\n    PR_T = 0.85\n    KAPPA = 0.41\n    E = 9.8\n    Y0_PLUS = 11.81\n    KAPPA_T = KAPPA * PR_T\n\n    # Numerical parameters\n    BETA = 0.5  # Relaxation factor\n    TOL = 1e-6  # Convergence tolerance for T_ref\n    MAX_ITER = 100  # Maximum number of iterations\n\n    # Test cases\n    test_cases = [\n        # (p, Tw, Tp, u_tau, yP)\n        (101325.0, 300.0, 600.0, 0.5, 5.0e-4),\n        (101325.0, 350.0, 400.0, 0.3, 1.0e-4),\n        (101325.0, 300.0, 1200.0, 1.0, 3.0e-3),\n        (101325.0, 320.0, 321.0, 0.2, 1.0e-3),\n    ]\n\n    # --- Helper functions for thermophysical properties ---\n    def get_rho(T, p):\n        return p / (R * T)\n\n    def get_mu(T):\n        return MU0 * (T / T0_MU)**1.5 * (T0_MU + S_MU) / (T + S_MU)\n\n    def get_k(T):\n        return K0 + AK * (T - T0_K)\n\n    def get_cp(T):\n        return CP0 + ACP * (T - T0_CP)\n\n    def get_Pr(mu_val, cp_val, k_val):\n        return mu_val * cp_val / k_val\n\n    # --- Helper function for the piecewise wall function T+ ---\n    def get_T_plus(y_plus, pr_val):\n        # Calculate B_t, the additive constant for the log-law part\n        Bt_val = pr_val * Y0_PLUS - (1.0 / KAPPA_T) * np.log(E * Y0_PLUS)\n        if y_plus = Y0_PLUS:\n            return pr_val * y_plus\n        else:\n            return (1.0 / KAPPA_T) * np.log(E * y_plus) + Bt_val\n\n    results = []\n    for p, Tw, Tp, u_tau, yP in test_cases:\n        \n        # Initial guess for reference temperature\n        T_ref = (Tw + Tp) / 2.0\n        T_min = min(Tw, Tp)\n        T_max = max(Tw, Tp)\n        \n        converged = 0\n        iter_count = 0\n        q_w = 0.0\n        y_plus = 0.0\n        \n        for i in range(MAX_ITER):\n            iter_count = i + 1\n            T_ref_old = T_ref\n\n            # 1. Evaluate properties at T_ref\n            rho_val = get_rho(T_ref, p)\n            mu_val = get_mu(T_ref)\n            k_val = get_k(T_ref)\n            cp_val = get_cp(T_ref)\n            pr_val = get_Pr(mu_val, cp_val, k_val)\n            \n            # 2. Compute dimensionless parameters\n            y_plus = (rho_val * u_tau * yP) / mu_val\n\n            # 3. Evaluate dimensionless temperature at cell center\n            T_plus_P = get_T_plus(y_plus, pr_val)\n\n            # 4. Compute heat flux\n            delta_T = Tp - Tw\n            if abs(delta_T)  1e-9 or T_plus_P  1e-9:\n                T_tau = 0.0\n            else:\n                T_tau = delta_T / T_plus_P\n\n            q_w = rho_val * cp_val * u_tau * T_tau\n            \n            # 5. Update reference temperature\n            y_m_plus = y_plus / 2.0\n            T_plus_m = get_T_plus(y_m_plus, pr_val)\n            T_mid = Tw + T_tau * T_plus_m\n            \n            T_ref_cand = (1.0 - BETA) * T_ref + BETA * T_mid\n            \n            # 6. Clamp and check for convergence\n            T_ref = max(T_min, min(T_max, T_ref_cand))\n            \n            if abs(T_ref - T_ref_old)  TOL:\n                converged = 1\n                break\n\n        # Append results for this case\n        results.append([round(q_w, 3), round(y_plus, 3), iter_count, converged])\n    \n    # Format final output string as per requirement\n    # \"[[q1,yplus1,it1,conv1],[q2,yplus2,it2,conv2],...]\"\n    string_results = [f\"[{','.join(map(str, r))}]\" for r in results]\n    final_output = f\"[{','.join(string_results)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2537356"}]}