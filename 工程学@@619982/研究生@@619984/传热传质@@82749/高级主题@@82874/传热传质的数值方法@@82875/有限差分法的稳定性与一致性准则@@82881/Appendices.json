{"hands_on_practices": [{"introduction": "掌握数值方法的第一步是分析最简单格式的稳定性。本练习将引导你运用经典的冯·诺依曼(von Neumann)稳定性分析方法，从第一性原理出发，为应用于一维热传导方程的前向时间中心空间（FTCS）格式推导出其著名的稳定性约束条件。通过这个基础练习 [@problem_id:2524603]，你将掌握分析显式差分格式稳定性的核心技能。", "problem": "一个具有恒定热扩散系数 $\\alpha$ 的一维均匀固体正在经历瞬态热传导。根据能量守恒和傅里叶热传导定律，温度场 $T(x,t)$ 满足扩散方程 $\\frac{\\partial T}{\\partial t}=\\alpha \\frac{\\partial^2 T}{\\partial x^2}$。考虑一个间距为 $\\Delta x$ 的均匀空间网格，并使用前向时间中心空间（FTCS）有限差分格式来近似该方程。使用应用于完全离散更新的线性傅里叶（von Neumann）稳定性分析，从第一性原理推导出为使所有空间傅里叶模不被放大，$\\Delta t$、$\\Delta x$ 和 $\\alpha$ 之间必须满足的稳定性要求。然后，对于 $\\alpha=1.4\\times 10^{-7}\\,\\text{m}^2/\\text{s}$ 和 $\\Delta x=0.5\\,\\text{mm}$，计算最大稳定时间步长。将您的最终数值答案以秒为单位表示，并四舍五入到三位有效数字。", "solution": "该问题是有效的。这是一个在偏微分方程数值分析领域，特别是在热传导背景下的标准、适定的问题。所有必要信息均已提供，且该问题在科学上是合理的。\n\n一维瞬态热传导的控制偏微分方程是扩散方程：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n其中 $T(x,t)$ 是温度，$t$ 是时间，$x$ 是空间坐标，$\\alpha$ 是恒定的热扩散系数。\n\n我们需要分析前向时间中心空间（FTCS）有限差分格式。我们将连续域离散化为网格，空间步长为 $\\Delta x$，时间步长为 $\\Delta t$。令 $T_j^n$ 表示在空间节点 $j$ 和时间层 $n$ 的温度数值近似，即 $T_j^n \\approx T(j\\Delta x, n\\Delta t)$。\n\n时间导数 $\\frac{\\partial T}{\\partial t}$ 使用一阶向前差分进行近似：\n$$\n\\frac{\\partial T}{\\partial t} \\bigg|_{j,n} \\approx \\frac{T_j^{n+1} - T_j^n}{\\Delta t}\n$$\n空间二阶导数 $\\frac{\\partial^2 T}{\\partial x^2}$ 使用二阶中心差分进行近似：\n$$\n\\frac{\\partial^2 T}{\\partial x^2} \\bigg|_{j,n} \\approx \\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{(\\Delta x)^2}\n$$\n将这些近似代入控制方程，得到FTCS格式：\n$$\n\\frac{T_j^{n+1} - T_j^n}{\\Delta t} = \\alpha \\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{(\\Delta x)^2}\n$$\n整理方程以求解下一个时间步的温度 $T_j^{n+1}$，我们得到显式更新规则：\n$$\nT_j^{n+1} = T_j^n + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\n我们定义无量纲网格傅里叶数 $r$ 为：\n$$\nr = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}\n$$\n更新方程简化为：\n$$\nT_j^{n+1} = T_j^n + r(T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\n\n为了分析这个线性格式的稳定性，我们使用 von Neumann（或傅里叶）稳定性分析。我们考虑数值解中单个傅里叶模的演化。在任意时间层 $n$ 的解可以表示为傅里叶级数。我们考察该级数在空间节点 $j$ 的一个通项：\n$$\nT_j^n = A^{(n)}(k) e^{i k x_j} = A^{(n)}(k) e^{i k j \\Delta x}\n$$\n其中 $i = \\sqrt{-1}$，$k$ 是傅里叶模的波数，$A^{(n)}(k)$ 是该模在时间层 $n$ 的振幅。为使格式稳定，任何傅里叶模的振幅都不能随时间增长。这意味着放大因子 $G(k) = \\frac{A^{(n+1)}(k)}{A^{(n)}(k)}$ 对于所有可能的波数 $k$ 都必须满足条件 $|G(k)| \\le 1$。\n\n将傅里叶模表达式代入FTCS更新方程：\n$$\nA^{(n+1)} e^{i k j \\Delta x} = A^{(n)} e^{i k j \\Delta x} + r \\left( A^{(n)} e^{i k (j+1) \\Delta x} - 2A^{(n)} e^{i k j \\Delta x} + A^{(n)} e^{i k (j-1) \\Delta x} \\right)\n$$\n将整个方程除以 $A^{(n)} e^{i k j \\Delta x}$（此项非零），得到放大因子 $G = \\frac{A^{(n+1)}}{A^{(n)}}$ 的表达式：\n$$\nG = 1 + r \\left( e^{i k \\Delta x} - 2 + e^{-i k \\Delta x} \\right)\n$$\n使用欧拉恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，我们可以简化括号中的表达式：\n$$\ne^{i k \\Delta x} + e^{-i k \\Delta x} - 2 = 2\\cos(k \\Delta x) - 2\n$$\n因此，放大因子变为：\n$$\nG = 1 + 2r(\\cos(k \\Delta x) - 1)\n$$\n我们可以使用半角三角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\frac{\\theta}{2})$：\n$$\nG = 1 - 4r\\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nvon Neumann 稳定性判据为 $|G| \\leq 1$，这等价于 $-1 \\leq G \\leq 1$。\n\n由于 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$ 是正数，且 $\\sin^2(\\frac{k \\Delta x}{2})$ 总是非负的，所以 $4r\\sin^2(\\frac{k \\Delta x}{2})$ 这一项总是非负的。因此，$G = 1 - (\\text{一个非负量})$，这意味着 $G \\le 1$。条件的这一部分总是被满足。\n\n稳定性条件的关键部分是 $G \\ge -1$：\n$$\n1 - 4r\\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\ge -1\n$$\n$$\n2 \\ge 4r\\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\frac{1}{2} \\ge r\\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n这个不等式必须对所有可能的波数 $k$ 成立。最严格的条件（即“最坏情况”）发生在 $\\sin^2(\\frac{k \\Delta x}{2})$ 达到其最大值时。正弦平方函数的最大值为1。这发生在网格能够解析的最高频率模态，即 $k \\Delta x = \\pi$ 时。\n因此，稳定性判据简化为：\n$$\nr \\le \\frac{1}{2}\n$$\n将 $r$ 的定义代回：\n$$\n\\frac{\\alpha \\Delta t}{(\\Delta x)^2} \\le \\frac{1}{2}\n$$\n这就是应用于一维热方程的FTCS格式的稳定性要求。\n\n现在，我们计算最大稳定时间步长 $\\Delta t_{max}$。从推导出的判据，我们有：\n$$\n\\Delta t \\le \\frac{(\\Delta x)^2}{2\\alpha}\n$$\n最大稳定时间步长是等式成立的极限情况：\n$$\n\\Delta t_{max} = \\frac{(\\Delta x)^2}{2\\alpha}\n$$\n题目给出了以下数值：\n$\\alpha = 1.4 \\times 10^{-7}\\,\\text{m}^2/\\text{s}$\n$\\Delta x = 0.5\\,\\text{mm}$\n\n首先，我们必须确保单位一致。我们将 $\\Delta x$ 从毫米（mm）转换为米（m）：\n$\\Delta x = 0.5\\,\\text{mm} = 0.5 \\times 10^{-3}\\,\\text{m} = 5 \\times 10^{-4}\\,\\text{m}$。\n\n现在，我们将数值代入 $\\Delta t_{max}$ 的表达式中：\n$$\n\\Delta t_{max} = \\frac{(5 \\times 10^{-4}\\,\\text{m})^2}{2 \\times (1.4 \\times 10^{-7}\\,\\text{m}^2/\\text{s})} = \\frac{25 \\times 10^{-8}\\,\\text{m}^2}{2.8 \\times 10^{-7}\\,\\text{m}^2/\\text{s}}\n$$\n$$\n\\Delta t_{max} = \\frac{25}{2.8} \\times 10^{-1}\\,\\text{s} = \\frac{2.5}{2.8}\\,\\text{s} \\approx 0.892857... \\,\\text{s}\n$$\n题目要求将答案四舍五入到三位有效数字。\n$$\n\\Delta t_{max} \\approx 0.893\\,\\text{s}\n$$\n这就是对于给定的参数，FTCS格式保持数值稳定的最大时间步长。", "answer": "$$\\boxed{0.893}$$", "id": "2524603"}, {"introduction": "在掌握了一维问题的基础之上，我们需要将稳定性分析推广到更一般的情形。本练习 [@problem_id:2524677] 从一个更具物理直观性的角度——单调性——来探讨稳定性，通过要求数值更新是邻近节点的凸组合来保证不产生非物理的局部极值。这种方法不仅为稳定性提供了充分条件，还能自然地推广到多维问题。", "problem": "考虑一个均匀介质中的瞬态热扩散，其过程由热方程\n$$\n\\frac{\\partial u}{\\partial t}=\\alpha \\nabla^{2} u,\n$$\n控制，其中 $u=u(\\mathbf{x},t)$ 是温度，$\\alpha>0$ 是热扩散率。设空间域在 $d$ 维空间中被一个正交笛卡尔网格离散化，沿各坐标方向的均匀间距分别为 $\\Delta x_{1},\\dots,\\Delta x_{d}$。考虑采用时间步长为 $\\Delta t>0$ 的显式前向欧拉方法进行时间离散化，并对内部节点上各坐标方向的拉普拉斯算子使用标准二阶中心差分近似。假设没有内部源，边界数据随时间非负，并且所有网格点上的初始数据均为非负。\n\n从控制方程和所述的离散化选择出发，写出一个内部节点的全离散更新公式，其形式应分离出乘以当前节点值及其最近邻点值的权重。施加以下要求：(i) 这些权重均为非负；(ii) 它们的和为 $1$，从而使更新是当前值和邻近值的凸组合。推导相应的 $\\Delta t$ 的精确上界，该上界保证这两个属性在每个内部节点都成立，并将其表示为最大容许时间步长 $\\Delta t_{\\max}$ 关于 $\\alpha$ 和间距 $\\Delta x_{1},\\dots,\\Delta x_{d}$ 的单个闭式解析表达式。\n\n以函数 $\\Delta t_{\\max}=\\,$(表达式) 的形式报告你的答案。最终表达式中不要包含单位。", "solution": "所述问题具有科学依据，是适定的、客观的且自洽的。它提出了偏微分方程数值分析中的一个标准、基础的任务。其前提事实正确，术语精确，目标明确。该问题是有效的。我们现在开始求解。\n\n控制方程是在 $d$ 维空间中的瞬态热扩散方程，由下式给出\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\nabla^2 u\n$$\n其中 $u(\\mathbf{x}, t)$ 是温度，$\\mathbf{x} \\in \\mathbb{R}^d$，$t \\ge 0$，而 $\\alpha > 0$ 是常数热扩散率。笛卡尔坐标系中的拉普拉斯算子是 $\\nabla^2 = \\sum_{k=1}^d \\frac{\\partial^2}{\\partial x_k^2}$。\n\n我们在一个正交笛卡尔网格上离散化该方程。设 $\\Delta t > 0$ 是均匀的时间步长，$\\Delta x_k$ 是第 $k$ 个坐标方向上的均匀网格间距，其中 $k=1, \\dots, d$。令 $u_{\\mathbf{i}}^n$ 表示温度 $u(\\mathbf{x}_{\\mathbf{i}}, t_n)$ 的数值近似，其中 $\\mathbf{i} = (i_1, \\dots, i_d)$ 是网格节点的多重索引，$t_n = n \\Delta t$。\n\n时间导数 $\\frac{\\partial u}{\\partial t}$ 在点 $(\\mathbf{x}_{\\mathbf{i}}, t_n)$ 处使用显式前向欧拉格式近似为：\n$$\n\\left. \\frac{\\partial u}{\\partial t} \\right|_{\\mathbf{x}_{\\mathbf{i}}, t_n} \\approx \\frac{u_{\\mathbf{i}}^{n+1} - u_{\\mathbf{i}}^n}{\\Delta t}\n$$\n拉普拉斯算子 $\\nabla^2 u$ 使用标准二阶中心差分格式进行近似。关于 $x_k$ 的二阶偏导数近似为：\n$$\n\\left. \\frac{\\partial^2 u}{\\partial x_k^2} \\right|_{\\mathbf{x}_{\\mathbf{i}}, t_n} \\approx \\frac{u_{\\mathbf{i}+\\mathbf{e}_k}^n - 2u_{\\mathbf{i}}^n + u_{\\mathbf{i}-\\mathbf{e}_k}^n}{(\\Delta x_k)^2}\n$$\n其中 $\\mathbf{e}_k$ 是索引空间中对应于第 $k$ 个方向的单位向量。因此，完整的拉普拉斯算子近似为：\n$$\n\\left. \\nabla^2 u \\right|_{\\mathbf{x}_{\\mathbf{i}}, t_n} \\approx \\sum_{k=1}^d \\frac{u_{\\mathbf{i}+\\mathbf{e}_k}^n - 2u_{\\mathbf{i}}^n + u_{\\mathbf{i}-\\mathbf{e}_k}^n}{(\\Delta x_k)^2}\n$$\n将这些离散近似代入控制方程，得到全离散格式：\n$$\n\\frac{u_{\\mathbf{i}}^{n+1} - u_{\\mathbf{i}}^n}{\\Delta t} = \\alpha \\sum_{k=1}^d \\frac{u_{\\mathbf{i}+\\mathbf{e}_k}^n - 2u_{\\mathbf{i}}^n + u_{\\mathbf{i}-\\mathbf{e}_k}^n}{(\\Delta x_k)^2}\n$$\n为了找到 $u_{\\mathbf{i}}^{n+1}$ 的更新规则，我们求解该项：\n$$\nu_{\\mathbf{i}}^{n+1} = u_{\\mathbf{i}}^n + \\alpha \\Delta t \\sum_{k=1}^d \\frac{u_{\\mathbf{i}+\\mathbf{e}_k}^n - 2u_{\\mathbf{i}}^n + u_{\\mathbf{i}-\\mathbf{e}_k}^n}{(\\Delta x_k)^2}\n$$\n问题要求将此表达式写成一种形式，以分离出当前节点值 $u_{\\mathbf{i}}^n$ 及其最近邻点的权重。我们通过重新排列各项来实现这一点：\n$$\nu_{\\mathbf{i}}^{n+1} = u_{\\mathbf{i}}^n - \\left( 2 \\alpha \\Delta t \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2} \\right) u_{\\mathbf{i}}^n + \\sum_{k=1}^d \\left( \\frac{\\alpha \\Delta t}{(\\Delta x_k)^2} u_{\\mathbf{i}+\\mathbf{e}_k}^n + \\frac{\\alpha \\Delta t}{(\\Delta x_k)^2} u_{\\mathbf{i}-\\mathbf{e}_k}^n \\right)\n$$\n合并乘以 $u_{\\mathbf{i}}^n$ 的各项，得到所需的形式：\n$$\nu_{\\mathbf{i}}^{n+1} = \\left( 1 - 2 \\alpha \\Delta t \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2} \\right) u_{\\mathbf{i}}^n + \\sum_{k=1}^d \\frac{\\alpha \\Delta t}{(\\Delta x_k)^2} \\left( u_{\\mathbf{i}+\\mathbf{e}_k}^n + u_{\\mathbf{i}-\\mathbf{e}_k}^n \\right)\n$$\n此更新是在当前时间步 $n$ 时，节点 $\\mathbf{i}$ 处的值及其 $2d$ 个最近邻点的线性组合。权重为：\n-   中心节点 $u_{\\mathbf{i}}^n$ 的权重：$C_0 = 1 - 2 \\alpha \\Delta t \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2}$\n-   每个邻点 $u_{\\mathbf{i}\\pm\\mathbf{e}_k}^n$ 的权重：$C_k = \\frac{\\alpha \\Delta t}{(\\Delta x_k)^2}$，其中 $k=1, \\dots, d$。\n\n问题要求此更新必须是一个凸组合。这需要满足两个条件：\n(i) 所有权重必须为非负。\n(ii) 所有权重的和必须等于 $1$。\n\n我们先验证条件 (ii)。所有权重的和为：\n$$\n\\sum (\\text{weights}) = C_0 + \\sum_{k=1}^d (\\text{weight of } u_{\\mathbf{i}+\\mathbf{e}_k}^n + \\text{weight of } u_{\\mathbf{i}-\\mathbf{e}_k}^n)\n$$\n$$\n\\sum (\\text{weights}) = \\left( 1 - 2 \\alpha \\Delta t \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2} \\right) + \\sum_{k=1}^d \\left( \\frac{\\alpha \\Delta t}{(\\Delta x_k)^2} + \\frac{\\alpha \\Delta t}{(\\Delta x_k)^2} \\right)\n$$\n$$\n\\sum (\\text{weights}) = 1 - 2 \\alpha \\Delta t \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2} + 2 \\alpha \\Delta t \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2} = 1\n$$\n因此，条件 (ii) 是该离散公式的内在属性，无论参数如何选择，该条件始终满足。\n\n现在我们必须强制执行条件 (i)，即权重的非负性。\n邻点权重 $C_k = \\frac{\\alpha \\Delta t}{(\\Delta x_k)^2}$ 始终为非负，因为 $\\alpha > 0$，$\\Delta t > 0$ 且 $(\\Delta x_k)^2 > 0$。\n关键的约束来自中心节点权重 $C_0$：\n$$\nC_0 = 1 - 2 \\alpha \\Delta t \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2} \\ge 0\n$$\n为使更新成为凸组合，此不等式必须成立。我们求解 $\\Delta t$：\n$$\n1 \\ge 2 \\alpha \\Delta t \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2}\n$$\n由于 $\\alpha > 0$ 且求和项严格为正，我们可以直接相除而不改变不等号方向：\n$$\n\\Delta t \\le \\frac{1}{2 \\alpha \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2}}\n$$\n该不等式给出了时间步长 $\\Delta t$ 的上界。最大容许时间步长 $\\Delta t_{\\max}$ 是使该不等式成为等式的值。这是在给定约束下的最精确的上界。\n\n因此，最大容许时间步长的表达式为：\n$$\n\\Delta t_{\\max} = \\frac{1}{2 \\alpha \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2}}\n$$\n这是保证系数非负性的稳定性条件，而系数非负性又确保了数值解遵循离散极值原理，这是此类抛物线型问题稳定性的一个充分条件。", "answer": "$$\n\\boxed{\\frac{1}{2\\alpha \\sum_{k=1}^{d} \\frac{1}{(\\Delta x_k)^{2}}}}\n$$", "id": "2524677"}, {"introduction": "实际的工程问题往往比纯扩散过程更为复杂。本练习 [@problem_id:2524648] 引入了对流-扩散方程，迫使我们必须在不同的离散策略之间做出权衡。它突出了在处理对流项时，迎风格式（upwinding）与中心差分在精度、稳定性及单调性之间的取舍，并对比了显式与隐式时间积分方法的优劣。", "problem": "描述一个细长管道中温度（或浓度）的一维对流扩散模型由以下守恒平衡方程控制\n$$\n\\frac{\\partial u}{\\partial t} + v\\,\\frac{\\partial u}{\\partial x} \\;=\\; \\alpha\\,\\frac{\\partial^2 u}{\\partial x^2},\n$$\n其中 $u(x,t)$ 是被输运的标量，$v>0$ 是一个恒定的对流速度，$\\alpha>0$ 是一个恒定的扩散系数。考虑一个空间步长为 $\\Delta x>0$、时间步长为 $\\Delta t>0$ 的均匀网格。对于给定的 $v$、$\\alpha$ 和 $\\Delta x$，请您选择一种时间积分和空间离散的方案，该方案能同时保证线性稳定性和单调性（即对于非负初始数据，不产生新的局部极值），并正确地论证其相应的精度权衡。\n\n选择所有满足以下两个条件的选项：\n- 它们提供了一种 $\\Delta t$ 的选择和一种空间离散方法，在假定根据 $v$ 的符号采用适当的迎风格式和使用 Dirichlet 边界数据的条件下，能够保证所述格式对于所有内部节点都具有稳定性和单调性。\n- 它们正确地指出了该设计所隐含的主阶精度权衡。\n\n此处，单调性应理解为满足离散极值原理，稳定性应酌情理解为满足 Courant–Friedrichs–Lewy (CFL) 条件或无条件稳定。\n\n选项：\n- A. 时间上使用前向欧拉法，对流项使用一阶迎风格式，扩散项使用二阶中心差分。选择\n$$\n\\Delta t \\;\\le\\; \\frac{1}{\\,\\dfrac{v}{\\Delta x} \\;+\\; \\dfrac{2\\alpha}{\\Delta x^2}\\,}.\n$$\n该设计是线性稳定且单调的。其时间精度为一阶，对流项的空间精度为一阶（由于使用迎风格式），扩散项的空间精度为二阶。\n\n- B. 时间上使用前向欧拉法，对流项和扩散项均使用二阶中心差分。选择\n$$\n\\Delta t \\;\\le\\; \\frac{1}{\\,\\dfrac{2\\alpha}{\\Delta x^2}\\,}.\n$$\n该设计对任意 $v$ 都是线性稳定且单调的。其空间精度为二阶，时间精度为一阶。\n\n- C. 时间上使用后向欧拉法，对流项使用一阶迎风格式，扩散项使用二阶中心差分。取任意 $\\Delta t>0$。由于线性系统的 $M$-矩阵结构，该设计是无条件稳定且单调的。其时间精度为一阶，对流项的空间精度为一阶，扩散项的空间精度为二阶。\n\n- D. 时间上使用 Crank–Nicolson 格式，对流项和扩散项均使用二阶中心差分。取任意 $\\Delta t>0$。该设计是无条件稳定且单调的。其时间和空间精度均为二阶。\n\n- E. 时间上使用前向欧拉法，对流项使用一阶迎风格式，扩散项使用二阶中心差分。选择\n$$\n\\Delta t \\;\\le\\; \\min\\!\\Big\\{\\,\\frac{\\Delta x}{v},\\,\\frac{\\Delta x^2}{2\\alpha}\\,\\Big\\}.\n$$\n该设计是线性稳定且单调的。其时间精度为一阶，对流项的空间精度为一阶（由于使用迎风格式），扩散项的空间精度为二阶。\n\n选择所有适用选项。", "solution": "在尝试求解之前，需要对问题陈述进行严格验证。\n\n### 第1步：提取已知条件\n- **控制方程：** 一维线性对流扩散方程如下\n$$\n\\frac{\\partial u}{\\partial t} + v\\,\\frac{\\partial u}{\\partial x} \\;=\\; \\alpha\\,\\frac{\\partial^2 u}{\\partial x^2}\n$$\n- **参数：** $v>0$ 是恒定对流速度，$\\alpha>0$ 是恒定扩散系数。\n- **离散化：** 网格是均匀的，空间步长为 $\\Delta x > 0$，时间步长为 $\\Delta t > 0$。\n- **有效格式的条件：** 格式必须同时保证线性和单调性（稳定性方面指 CFL 条件或无条件稳定，单调性方面指离散极值原理，即不产生新的极值）。对于给定的常数 $v, \\alpha, \\Delta x$，此保证必须成立。\n- **对选项的要求：** 每个选中的选项都必须提供一个正确的组合，包括一种数值格式、一个确保稳定性和单调性的有效 $\\Delta t$ 条件，以及一个关于主阶精度的正确陈述。\n\n### 第2步：使用提取的已知条件进行验证\n所给出的问题是偏微分方程数值方法领域的一个标准的、基础性的问题，特别是在计算传热学和计算流体力学中。\n1.  **科学依据：** 该控制方程是输运现象的基石。稳定性、单调性、Courant–Friedrichs–Lewy (CFL) 条件和精度阶数等概念都是数值格式的严格定义的数学属性。该问题牢固地建立在公认的科学和数学原理之上。\n2.  **适定性和客观性：** 问题陈述清晰，所有术语都有定义。它要求根据客观标准（稳定性、单调性、精度）分析几种标准的有限差分格式。该问题是适定的，并且允许对每个选项进行唯一的、可验证的分析。\n3.  **完整性：** 该问题提供了分析这些格式所需的所有必要信息。将参数定义为正常数（$v>0, \\alpha>0$）既有物理意义，在数学上也很方便。提及“适当的迎风格式”和 Dirichlet 数据提供了必要的背景。\n\n### 第3步：结论与行动\n问题陈述是有效的。这是有限差分方法分析中的一个标准练习题。我现在将通过分析每个选项来推导解答。\n\n设 $u_j^n$ 表示 $u(j\\Delta x, n\\Delta t)$ 的数值近似。我们定义 Courant 数 $C = \\frac{v\\Delta t}{\\Delta x}$ 和扩散数 $d = \\frac{\\alpha\\Delta t}{\\Delta x^2}$。对于形如 $u_j^{n+1} = \\sum_k c_k u_{j-k}^n$ 的显式格式，单调性分析要求所有系数 $c_k$ 均为非负。对于隐式格式 $A\\mathbf{u}^{n+1} = B\\mathbf{u}^n$，如果矩阵 $A^{-1}B$ 是正的（所有元素非负），则通常可以保证单调性。\n\n**选项 A 的分析**\n该格式在时间上使用前向欧拉法 (FTCS)，对流项使用一阶迎风格式（$v>0$ 意味着使用后向差分），扩散项使用二阶中心差分。离散化方程为：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -v \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) + \\alpha \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2} \\right)\n$$\n整理得到 $u_j^{n+1}$：\n$$\nu_j^{n+1} = u_j^n - \\frac{v\\Delta t}{\\Delta x}(u_j^n - u_{j-1}^n) + \\frac{\\alpha\\Delta t}{\\Delta x^2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n用 $C$ 和 $d$ 表示：\n$$\nu_j^{n+1} = (1 - C - 2d)u_j^n + (C+d)u_{j-1}^n + d u_{j+1}^n\n$$\n为保证单调性，右侧各项的系数必须为非负。\n1.  $d = \\frac{\\alpha\\Delta t}{\\Delta x^2} \\ge 0$。这是成立的，因为 $\\alpha, \\Delta t, \\Delta x$ 均为正数。\n2.  $C+d = \\frac{v\\Delta t}{\\Delta x} + \\frac{\\alpha\\Delta t}{\\Delta x^2} \\ge 0$。这是成立的，因为 $v, \\alpha, \\Delta t, \\Delta x$ 均为正数。\n3.  $1 - C - 2d \\ge 0 \\implies C + 2d \\le 1$。\n代入 $C$ 和 $d$ 的定义：\n$$\n\\frac{v\\Delta t}{\\Delta x} + \\frac{2\\alpha\\Delta t}{\\Delta x^2} \\le 1 \\implies \\Delta t \\left( \\frac{v}{\\Delta x} + \\frac{2\\alpha}{\\Delta x^2} \\right) \\le 1\n$$\n$$\n\\Delta t \\le \\frac{1}{\\frac{v}{\\Delta x} + \\frac{2\\alpha}{\\Delta x^2}}\n$$\n这个条件与选项中给出的条件相符。该条件对于稳定性也是充分的（von Neumann 分析证实了在此条件下 $|G| \\le 1$）。\n精度由截断误差决定。前向欧拉法是 $O(\\Delta t)$，一阶迎风是 $O(\\Delta x)$，二阶中心差分是 $O(\\Delta x^2)$。最低阶项占主导地位，因此整个格式在时间和空间上都是一阶的。关于精度的描述是正确的。\n对选项 A 的判定：**正确**。\n\n**选项 B 的分析**\n该格式在时间上使用前向欧拉法，对流项和扩散项均使用二阶中心差分。\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -v \\left( \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} \\right) + \\alpha \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2} \\right)\n$$\n整理得到 $u_j^{n+1}$：\n$$\nu_j^{n+1} = (1 - 2d)u_j^n + (d - C/2)u_{j+1}^n + (d + C/2)u_{j-1}^n\n$$\n为保证单调性，各项系数必须为非负。\n1.  $d+C/2 \\ge 0$。成立，因为 $C,d > 0$。\n2.  $1-2d \\ge 0 \\implies 2d \\le 1 \\implies \\Delta t \\le \\frac{\\Delta x^2}{2\\alpha}$。这与提出的条件相符。\n3.  $d - C/2 \\ge 0 \\implies 2d \\ge C \\implies 2\\frac{\\alpha\\Delta t}{\\Delta x^2} \\ge \\frac{v\\Delta t}{\\Delta x} \\implies \\frac{2\\alpha}{v\\Delta x} \\ge 1$。\n这最后一个条件等价于网格 Péclet 数 $Pe_\\Delta = \\frac{v\\Delta x}{\\alpha}$ 小于或等于 $2$。该格式仅在 $Pe_\\Delta \\le 2$ 时才是单调的。而选项声称它对“任意 $v$”都是单调的，这是错误的。众所周知，当对流占主导时（即 $Pe_\\Delta > 2$），该格式会产生非物理振荡。因此，保证单调性的说法是错误的。此外，该格式的稳定性条件是 $\\Delta t \\le \\min(\\frac{2\\alpha}{v^2}, \\frac{\\Delta x^2}{2\\alpha})$。选项中给出的条件 $\\Delta t \\le \\frac{\\Delta x^2}{2\\alpha}$ 是不完整的，不能保证对任意 $v$ 都稳定。\n对选项 B 的判定：**不正确**。\n\n**选项 C 的分析**\n该格式在时间上使用后向欧拉法，对流项使用一阶迎风格式，扩散项使用二阶中心差分。\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -v \\left( \\frac{u_j^{n+1} - u_{j-1}^{n+1}}{\\Delta x} \\right) + \\alpha \\left( \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{\\Delta x^2} \\right)\n$$\n重新整理各项，形成线性系统 $A\\mathbf{u}^{n+1} = \\mathbf{u}^n$：\n$$\n(-d)u_{j+1}^{n+1} + (1 + C + 2d)u_j^{n+1} + (-C - d)u_{j-1}^{n+1} = u_j^n\n$$\n矩阵 $A$ 是三对角的。对于任意内部行 $j$，非零元素为 $A_{j,j+1}=-d$，$A_{j,j}=1+C+2d$ 和 $A_{j,j-1}=-(C+d)$。\n为判断单调性，我们检查 $A$ 是否为 M-矩阵。\n1.  对角元素：对任意 $\\Delta t > 0$，都有 $A_{j,j} = 1+C+2d > 0$。\n2.  非对角元素：$A_{j,j+1} = -d < 0$ 且 $A_{j,j-1} = -(C+d) < 0$。所以 $A$ 是一个 Z-矩阵。\n3.  对角占优性：$|A_{j,j}| = 1+C+2d$。行中非对角元素的绝对值之和为 $|A_{j,j-1}|+|A_{j,j+1}| = C+d+d = C+2d$。条件 $|A_{j,j}| \\ge \\sum_{k\\ne j}|A_{j,k}|$ 变为 $1+C+2d \\ge C+2d$，这是成立的。该矩阵是对角占优的（当包含边界条件时，是不可约对角占优的）。\n一个具有正对角元的对角占优 Z-矩阵是一个 M-矩阵。M-矩阵的逆矩阵具有非负元素（$A^{-1} \\ge 0$）。因此，如果 $\\mathbf{u}^n \\ge 0$，那么 $\\mathbf{u}^{n+1} = A^{-1}\\mathbf{u}^n \\ge 0$。该格式对任意 $\\Delta t > 0$ 都是无条件单调的。无条件单调性意味着无条件稳定性。\n来自后向欧拉法的时间精度为一阶（$O(\\Delta t)$），来自迎风格式的空间精度为一阶（$O(\\Delta x)$）。关于精度的陈述是正确的。\n对选项 C 的判定：**正确**。\n\n**选项 D 的分析**\n该格式在时间上使用 Crank-Nicolson 格式，对流和扩散项都使用二阶中心差分。对于线性对流扩散方程，该格式是众所周知地无条件稳定的，因为其增长因子 $G$ 的模为 $|G|=|\\frac{1 + \\hat{L}_h\\Delta t/2}{1 - \\hat{L}_h\\Delta t/2}|=1$，其中 $\\hat{L}_h$ 是空间算子的符号，其实部为非正。因此，关于无条件稳定性的说法是正确的。\n然而，在单调性方面，该格式与显式中心差分格式（选项 B）存在同样的问题。它仅在网格 Péclet 数 $Pe_\\Delta = \\frac{v\\Delta x}{\\alpha} \\le 2$ 时才是单调的。对于对流占优的流动（$Pe_\\Delta > 2$），该格式会产生伪振荡，因此不是单调的。关于无条件单调性的说法是错误的。\n其精度确实是时间和空间上的二阶，$O(\\Delta t^2, \\Delta x^2)$。但由于不满足无条件单调性的要求，该选项是无效的。\n对选项 D 的判定：**不正确**。\n\n**选项 E 的分析**\n该选项提出了与选项 A 相同的格式，但对时间步长提出了一个不同的条件：\n$$\n\\Delta t \\;\\le\\; \\min\\!\\Big\\{\\,\\frac{\\Delta x}{v},\\,\\frac{\\Delta x^2}{2\\alpha}\\,\\Big\\}\n$$\n这个条件等价于同时要求 $C = \\frac{v\\Delta t}{\\Delta x} \\le 1$ 和 $d = \\frac{\\alpha\\Delta t}{\\Delta x^2} \\le \\frac{1}{2}$（或 $2d \\le 1$）。这些分别是纯对流（使用迎风格式）和纯扩散（使用 FTCS）的稳定性极限。然而，对于组合的对流扩散方程，正确的单调性和稳定性条件是 $C+2d \\le 1$，正如在选项 A 的分析中推导出的那样。\n条件 $C \\le 1$ 和 $2d \\le 1$ 并*不*能推导出 $C+2d \\le 1$。例如，如果 $C=0.7$ 且 $2d=0.7$，选项 E 的两个条件都满足，但是 $C+2d = 1.4 > 1$，这违反了单调性条件。因此，选项 E 中提出的时间步长条件不能保证稳定性或单调性。关于精度的陈述是正确的，但稳定性/单调性条件不正确。\n对选项 E 的判定：**不正确**。\n\n总之，只有选项 A 和 C 提供的格式、稳定性/单调性条件以及精度陈述的组合是完全正确的。", "answer": "$$\\boxed{AC}$$", "id": "2524648"}]}