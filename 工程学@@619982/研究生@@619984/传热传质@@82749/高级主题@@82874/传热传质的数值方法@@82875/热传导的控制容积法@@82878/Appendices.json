{"hands_on_practices": [{"introduction": "在应用控制体积法时，一个核心的挑战是如何精确地处理不同材料或不同尺寸网格单元之间的交界面。为了保证整个计算域的能量守恒，我们必须正确地计算通过这些交界面的热通量。本练习引导我们通过热阻串联的类比，推导出一个物理上一致的交界面等效导热系数，这种方法被称为“调和平均法”。掌握这一概念对于在非均匀网格或复合材料问题中构建准确的数值格式至关重要。[@problem_id:2472545]", "problem": "一个一维 ($1$D) 稳态热传导问题采用有限体积法 (FVM) 进行离散化。两个相邻的控制体共享一个面积为 $A$ 的公共平面，该平面与两个均匀、各向同性固体之间的理想接触界面重合。西侧单元的热导率恒为 $k_1$，其形心距离该界面 $\\delta_1$；东侧单元的热导率恒为 $k_2$，其形心距离同一界面 $\\delta_2$。没有体积热源，且横截面积 $A$ 是均匀的。设形心温度分别为 $T_W$ (西) 和 $T_E$ (东)。需要定义一个等效界面热导率 $k_f$，使得两个形心之间的单元间扩散热通量，与一个厚度为 $(\\delta_1+\\delta_2)$、热导率为 $k_f$ 的单一均匀平板的热通量相同，同时严格遵守每种材料中的傅里叶定律以及界面上的热通量连续性。\n\n对于任意正值 $k_1$、$k_2$、$\\delta_1$ 和 $\\delta_2$，以下哪个关于 $k_f$ 的表达式符合这些第一性原理的要求？\n\nA. $k_f=\\dfrac{\\delta_1+\\delta_2}{\\dfrac{\\delta_1}{k_1}+\\dfrac{\\delta_2}{k_2}}$\n\nB. $k_f=\\dfrac{\\delta_1 k_1+\\delta_2 k_2}{\\delta_1+\\delta_2}$\n\nC. $k_f=\\sqrt{k_1 k_2}$\n\nD. $k_f=\\left(\\dfrac{\\delta_1}{k_1}+\\dfrac{\\delta_2}{k_2}\\right)^{-1}$", "solution": "首先，将对问题陈述的科学和逻辑完整性进行验证。\n\n### 步骤 1：提取已知条件\n以下信息由问题陈述提供：\n- 系统涉及一个一维 ($1$D) 稳态热传导问题。\n- 它使用有限体积法 (FVM) 进行离散化。\n- 两个相邻的控制体共享一个面积为 $A$ 的公共平面。\n- 该平面是两个均匀、各向同性固体之间的理想接触界面。\n- 西侧单元 (索引为 1)：热导率恒为 $k_1$，形心距界面的距离为 $\\delta_1$。\n- 东侧单元 (索引为 2)：热导率恒为 $k_2$，形心距界面的距离为 $\\delta_2$。\n- 没有体积热源。\n- 横截面积 $A$ 是均匀的。\n- 形心温度分别为西侧单元的 $T_W$ 和东侧单元的 $T_E$。\n- 需要为一个厚度为 $(\\delta_1 + \\delta_2)$ 的单一均匀平板定义一个等效界面热导率 $k_f$。\n- 该定义必须确保单元间的热通量与使用 $k_f$ 计算得到的热通量相同。\n- 推导必须遵守每种材料中的傅里叶定律以及界面上的热通量连续性。\n- $k_f$ 的表达式必须对任意正值 $k_1$、$k_2$、$\\delta_1$ 和 $\\delta_2$ 都有效。\n\n### 步骤 2：使用提取的已知条件进行验证\n这个问题是在有限体积法中处理复合材料时推导界面性质的一个标准基础练习。\n\n- **科学依据：** 该问题基于热传导的傅里叶定律和能量守恒原理（热通量连续性），这些是传热学理论的基石。该设置是分析通过复合平板的热流的标准模型。它在科学上是合理的。\n- **适定性：** 该问题提供了推导等效热导率 $k_f$ 的唯一表达式所需的所有物理参数（$k_1$、$k_2$、$\\delta_1$、$\\delta_2$）和约束条件（稳态、一维、无热源、连续性条件）。问题是明确的。\n- **客观性：** 语言技术性强、精确，不含任何主观或非科学内容。\n\n问题陈述没有可识别的缺陷。它并非科学上不合理、不可形式化、不完整、自相矛盾、不切实际或不适定。它代表了计算传热学中一个有效且定义明确的问题。\n\n### 步骤 3：结论与行动\n该问题是有效的。将基于所提供的第一性原理推导解答。\n\n### 解答推导\n目标是找到一个等效热导率 $k_f$ 的表达式，使得通过等效均匀介质的热流与通过实际复合介质的热流相匹配。\n\n设 $\\dot{Q}$ 为从西侧形心 ($W$) 到东侧形心 ($E$) 的传热速率。该系统可以建模为两个串联的热阻。第一个热阻 $R_1$ 对应于西侧形心与界面之间的材料，第二个热阻 $R_2$ 对应于界面与东侧形心之间的材料。\n\n根据一维热传导的傅里叶定律，一个厚度为 $L$、热导率为 $k$、面积为 $A$ 的平板的热阻 $R$ 由公式 $R = \\frac{L}{kA}$ 给出。\n\n对于控制体布置的西侧部分：\n- 厚度 = $\\delta_1$\n- 热导率 = $k_1$\n- 面积 = $A$\n其热阻为：\n$$R_1 = \\frac{\\delta_1}{k_1 A}$$\n\n对于东侧部分：\n- 厚度 = $\\delta_2$\n- 热导率 = $k_2$\n- 面积 = $A$\n其热阻为：\n$$R_2 = \\frac{\\delta_2}{k_2 A}$$\n\n由于热量必须先流过西侧部分，再流过东侧部分，这些热阻是串联的。位于 $T_W$ 和 $T_E$ 的形心之间的总热阻 $R_{total}$ 是各个热阻之和：\n$$R_{total} = R_1 + R_2 = \\frac{\\delta_1}{k_1 A} + \\frac{\\delta_2}{k_2 A} = \\frac{1}{A} \\left( \\frac{\\delta_1}{k_1} + \\frac{\\delta_2}{k_2} \\right)$$\n\n由于温差 $(T_W - T_E)$，通过该总热阻的传热速率 $\\dot{Q}$ 为：\n$$\\dot{Q} = \\frac{T_W - T_E}{R_{total}} = \\frac{T_W - T_E}{\\frac{1}{A} \\left( \\frac{\\delta_1}{k_1} + \\frac{\\delta_2}{k_2} \\right)} = A \\frac{T_W - T_E}{\\frac{\\delta_1}{k_1} + \\frac{\\delta_2}{k_2}}$$\n\n问题要求该传热速率与通过一个厚度为 $(\\delta_1 + \\delta_2)$、面积为 $A$、等效热导率为 $k_f$ 的单一均匀平板的传热速率相同。这个等效平板的传热速率 $\\dot{Q}_{eff}$ 由傅里叶定律给出：\n$$\\dot{Q}_{eff} = k_f A \\frac{T_W - T_E}{\\delta_1 + \\delta_2}$$\n\n令两个传热速率的表达式相等，$\\dot{Q} = \\dot{Q}_{eff}$：\n$$A \\frac{T_W - T_E}{\\frac{\\delta_1}{k_1} + \\frac{\\delta_2}{k_2}} = k_f A \\frac{T_W - T_E}{\\delta_1 + \\delta_2}$$\n\n假设存在非零的温度梯度，$(T_W - T_E) \\neq 0$，且由于 $A > 0$，我们可以消去等式两边的项 $A(T_W - T_E)$：\n$$\\frac{1}{\\frac{\\delta_1}{k_1} + \\frac{\\delta_2}{k_2}} = \\frac{k_f}{\\delta_1 + \\delta_2}$$\n\n求解等效热导率 $k_f$：\n$$k_f = \\frac{\\delta_1 + \\delta_2}{\\frac{\\delta_1}{k_1} + \\frac{\\delta_2}{k_2}}$$\n这是热导率的加权调和平均值。\n\n### 逐项分析\n\n**A. $k_f=\\dfrac{\\delta_1+\\delta_2}{\\dfrac{\\delta_1}{k_1}+\\dfrac{\\delta_2}{k_2}}$**\n此表达式与从第一性原理推导出的表达式相同。它正确地表示了通过两种串联材料的一维热传导的等效热导率。\n结论：**正确**\n\n**B. $k_f=\\dfrac{\\delta_1 k_1+\\delta_2 k_2}{\\delta_1+\\delta_2}$**\n该表达式代表加权算术平均值。此公式适用于平行于复合材料层的热流，此时热路径是并联的，而非串联。本题描述的是垂直于界面的热流，这是一个串联热传导问题。\n结论：**错误**\n\n**C. $k_f=\\sqrt{k_1 k_2}$**\n这是热导率的几何平均值。该表达式并非源于一维串联热传导的基本原理。虽然它可能在某些特定的多维场景中作为近似值出现，但它不是所述的适定一维问题的精确解。\n结论：**错误**\n\n**D. $k_f=\\left(\\dfrac{\\delta_1}{k_1}+\\dfrac{\\delta_2}{k_2}\\right)^{-1}$**\n该表达式可以写为 $k_f = \\frac{1}{\\frac{\\delta_1}{k_1} + \\frac{\\delta_2}{k_2}}$。我们来检查一下它的物理量纲。热导率 $k$ 的单位是 $\\mathrm{W} \\cdot \\mathrm{m}^{-1} \\cdot \\mathrm{K}^{-1}$。距离 $\\delta$ 的单位是 $\\mathrm{m}$。项 $\\frac{\\delta}{k}$ 的单位是 $\\frac{\\mathrm{m}}{\\mathrm{W} \\cdot \\mathrm{m}^{-1} \\cdot \\mathrm{K}^{-1}} = \\mathrm{m}^2 \\cdot \\mathrm{K} \\cdot \\mathrm{W}^{-1}$。该选项中给出的这个项的倒数，其单位将是 $\\mathrm{m}^{-2} \\cdot \\mathrm{K}^{-1} \\cdot \\mathrm{W}$，这不是热导率的单位。该表达式量纲不一致，因此在物理上是错误的。它在数学上也与推导出的结果不同，因为它在分子上缺少 $(\\delta_1 + \\delta_2)$ 项。\n结论：**错误**", "answer": "$$\\boxed{A}$$", "id": "2472545"}, {"introduction": "掌握了界面处理的基本原理后，我们可以将其应用于构建完整的控制体积离散格式。本练习将指导您从最基本的能量守恒定律出发，针对非均匀网格上的一维非稳态导热问题，推导出一个通用控制体积的半离散方程。您将学习如何系统地处理内部单元、以及施加了不同类型边界条件（狄利克雷和诺伊曼）的边界单元，最终形成一个常微分方程组。这个实践是构建一个有限体积求解器的核心步骤，是连接理论与计算实践的关键桥梁。[@problem_id:2472571]", "problem": "要求您推导并实现一个用于非均匀网格上一维瞬态热传导的控制体积公式。从第一性原理出发：对一个通用控制体积应用能量守恒，并使用热传导定律（Fourier定律）来表示控制体积表面的传导热率。假设相邻单元中心之间为分段线性温度分布，并在内部界面上应用热通量连续性。您的推导必须明确展示如何得到通用单元中心温度的半离散常微分方程 (ODE)，包括界面热导如何依赖于相邻单元的尺寸和热导率。\n\n定义和约定：\n- 空间域是一维的，具有非均匀尺寸的单元中心控制体积。对于一个通用内部单元，将其西侧相邻单元表示为 $W$，中心单元为 $P$，东侧相邻单元为 $E$。设 $P$ 的控制体积长度为 $ \\Delta x_P $，横截面积为 $ A $。相邻控制体积的长度分别为 $ \\Delta x_W $ 和 $ \\Delta x_E $。\n- 材料属性被视为单元中心常数：密度 $ \\rho $、比热容 $ c_p $ 和热导率 $ k $。对于中心单元，它们表示为 $ \\rho_P, c_{p,P}, k_P $；对于相邻单元，热导率表示为 $ k_W, k_E $。$P$ 中的体积生热率为 $ \\dot{s}_P $，单位为瓦特/立方米。\n- 规定传导热率在指向控制体积内部时为正。将进入单元 $P$ 的西侧和东侧表面的传导热率分别表示为 $ q_w $ 和 $ q_e $。\n- 对于内部界面，假设相邻单元中心之间存在分段线性的温度剖面，并在此界面上施加通量连续性，从而得到相邻单元中心温度之间的两点通量关系。这应该能确定依赖于 $ A $、单元中心到界面的距离以及相邻热导率的热导。\n- 对于位于单元 $P$ 西侧表面的壁面上的左边界，设有给定温度（Dirichlet条件）$ T_L $，使用相同的定义和与 $P$ 中假设的分段线性一致的单侧界面梯度。处理边界时，应使其影响可以作为线性贡献项被纳入 $T_P$ 的半离散平衡方程中。\n- 对于位于单元 $P$ 东侧表面上的右边界，设有给定外向热通量（Neumann条件）$ q''_R $，将正的 $ q''_R $ 解释为离开求解域的热量。使用上面定义的符号约定，将其转换为进入控制体积的相应热率。\n\n您为通用单元 $P$ 推导出的半离散平衡方程必须写成以下规范的线性形式\n$$\nM_P \\, \\frac{d T_P}{d t} \\;=\\; C_W \\, T_W \\;+\\; C_P \\, T_P \\;+\\; C_E \\, T_E \\;+\\; B,\n$$\n其中 $ M_P $ 是控制体积 $P$ 的热容（单位为焦耳/开尔文），$ C_W, C_P, C_E $ 是乘以相邻单元和自身温度的线性系数，$ B $ 是集总了体积生热和任何边界条件贡献的净源项。所有量都必须用国际单位制（SI 单位）表示。\n\n编程任务：\n- 实现一个程序，使用您推导的控制体积公式，为以下每个测试用例计算 $ [C_W, C_P, C_E, B, M_P] $。请使用上述的符号约定和建模假设。您的实现必须全程使用 SI 单位，并且必须输出四舍五入到六位小数的浮点数。\n\n测试套件（所有量均以 SI 单位给出）：\n1. 内部单元（三单元模板）：\n   - 横截面积 $ A = 0.008 $ 平方米\n   - 单元长度 $ \\Delta x_W = 0.012 $ 米，$ \\Delta x_P = 0.015 $ 米，$ \\Delta x_E = 0.020 $ 米\n   - 热导率 $ k_W = 150 $ 瓦特/米·开尔文，$ k_P = 180 $ 瓦特/米·开尔文，$ k_E = 210 $ 瓦特/米·开尔文\n   - $P$ 的密度和比热：$ \\rho_P = 7800 $ 千克/立方米，$ c_{p,P} = 500 $ 焦耳/千克·开尔文\n   - 体积生热率 $ \\dot{s}_P = 2.0 \\times 10^5 $ 瓦特/立方米\n\n2. 带有给定温度的左边界单元（西侧表面为Dirichlet条件）：\n   - 横截面积 $ A = 0.005 $ 平方米\n   - 单元长度 $ \\Delta x_P = 0.010 $ 米，$ \\Delta x_E = 0.020 $ 米\n   - 热导率 $ k_P = 200 $ 瓦特/米·开尔文，$ k_E = 180 $ 瓦特/米·开尔文\n   - $P$ 的密度和比热：$ \\rho_P = 8900 $ 千克/立方米，$ c_{p,P} = 385 $ 焦耳/千克·开尔文\n   - 体积生热率 $ \\dot{s}_P = 0 $\n   - 西侧表面的边界温度 $ T_L = 400 $ 开尔文\n\n3. 带有给定外向热通量的右边界单元（东侧表面为Neumann条件）：\n   - 横截面积 $ A = 0.010 $ 平方米\n   - 单元长度 $ \\Delta x_W = 0.020 $ 米，$ \\Delta x_P = 0.010 $ 米\n   - 热导率 $ k_W = 30 $ 瓦特/米·开尔文，$ k_P = 15 $ 瓦特/米·开尔文\n   - $P$ 的密度和比热：$ \\rho_P = 1200 $ 千克/立方米，$ c_{p,P} = 1800 $ 焦耳/千克·开尔文\n   - 体积生热率 $ \\dot{s}_P = 5.0 \\times 10^4 $ 瓦特/立方米\n   - 东侧表面的给定外向热通量 $ q''_R = 1.0 \\times 10^4 $ 瓦特/平方米\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个列表的列表，每个内部列表对应一个测试用例，并按上述顺序排列。每个内部列表必须是 $ [C_W, C_P, C_E, B, M_P] $ 的形式，其中每个条目都四舍五入到六位小数。输出必须只有一行，并且格式应如 \"[[case1_values], [case2_values], [case3_values]]\"，不含任何额外文本。例如：\"[[1.234000,-5.678000,0.000000,9.000000,2.500000],[...],[...]]\"。", "solution": "我们使用能量守恒和Fourier热传导定律，推导非均匀网格上一维瞬态热传导的控制体积公式。\n\n从围绕单元中心 $P$ 的控制体积的能量守恒方程开始：\n$$\n\\frac{d}{dt} \\int_{\\text{CV}_P} \\rho \\, c_p \\, T \\, dV \\;=\\; q_w \\;+\\; q_e \\;+\\; \\dot{s}_P \\, V_P,\n$$\n其中 $ q_w $ 和 $ q_e $ 分别是通过西侧和东侧表面进入控制体积的传导热率，$ \\dot{s}_P $ 是在 $P$ 处计算的体积生热率，$ V_P $ 是控制体积。此处的符号约定是，当热率指向控制体积内部时为正。方程左侧是热能的时间变化率。假设在 $ \\text{CV}_P $ 上 $ \\rho $ 和 $ c_p $ 是分段常数，定义控制体积的热容（热质量）：\n$$\nM_P \\;\\equiv\\; \\rho_P \\, c_{p,P} \\, V_P \\;=\\; \\rho_P \\, c_{p,P} \\, A \\, \\Delta x_P,\n$$\n这样，\n$$\nM_P \\, \\frac{d T_P}{d t} \\;=\\; q_w \\;+\\; q_e \\;+\\; \\dot{s}_P \\, V_P.\n$$\n\n为了封闭该问题，我们使用一维Fourier热传导定律：\n$$\nq = - k \\, A \\, \\frac{d T}{d x}.\n$$\n我们使用与相邻单元中心之间的分段线性温度和内部界面上的热通量连续性相一致的两点通量近似来计算界面通量。\n\n对于西侧内部界面（在单元 $W$ 和 $P$ 之间），设从西侧界面到各自中心的距离分别为 $ \\delta x_{Ww} = \\Delta x_W / 2 $ 和 $ \\delta x_{Pw} = \\Delta x_P / 2 $。在每个半单元内温度呈线性分布且通量连续的假设下，通过西侧表面进入 $P$ 的传导热率可以写为\n$$\nq_w \\;=\\; A \\, \\frac{T_W - T_P}{\\dfrac{\\delta x_{Pw}}{k_P} + \\dfrac{\\delta x_{Ww}}{k_W}}\n\\;=\\;\nA \\, \\frac{T_W - T_P}{\\dfrac{\\Delta x_P}{2 k_P} + \\dfrac{\\Delta x_W}{2 k_W}}.\n$$\n定义西侧界面热导\n$$\na_W \\;\\equiv\\; \\frac{A}{\\dfrac{\\Delta x_P}{2 k_P} + \\dfrac{\\Delta x_W}{2 k_W}},\n$$\n这样，$ q_w = a_W \\, (T_W - T_P) $。\n\n类似地，对于东侧内部界面（在 $P$ 和 $E$ 之间），其中 $ \\delta x_{Pe} = \\Delta x_P / 2 $ 和 $ \\delta x_{Ee} = \\Delta x_E / 2 $，通量连续性和分段线性温度意味着\n$$\nq_e \\;=\\; A \\, \\frac{T_E - T_P}{\\dfrac{\\delta x_{Pe}}{k_P} + \\dfrac{\\delta x_{Ee}}{k_E}}\n\\;=\\;\nA \\, \\frac{T_E - T_P}{\\dfrac{\\Delta x_P}{2 k_P} + \\dfrac{\\Delta x_E}{2 k_E}}\n\\;\\equiv\\; a_E \\, (T_E - T_P),\n$$\n其中\n$$\na_E \\;\\equiv\\; \\frac{A}{\\dfrac{\\Delta x_P}{2 k_P} + \\dfrac{\\Delta x_E}{2 k_E}}.\n$$\n\n将这些代入守恒方程，对于一个内部单元，可得：\n$$\nM_P \\, \\frac{d T_P}{d t} \\;=\\; a_W \\, (T_W - T_P) \\;+\\; a_E \\, (T_E - T_P) \\;+\\; \\dot{s}_P \\, V_P.\n$$\n将其整理成规范的线性形式，\n$$\nM_P \\, \\frac{d T_P}{d t} \\;=\\; C_W \\, T_W \\;+\\; C_P \\, T_P \\;+\\; C_E \\, T_E \\;+\\; B,\n$$\n我们可以确定\n$$\nC_W \\;=\\; a_W,\\qquad\nC_E \\;=\\; a_E,\\qquad\nC_P \\;=\\; -\\,(a_W + a_E),\\qquad\nB \\;=\\; \\dot{s}_P \\, V_P.\n$$\n\n左侧 Dirichlet 边界（西侧表面给定温度）：\n设单元 $P$ 西侧边界表面上的温度为 $ T_L $。跨越半单元的界面梯度的单侧线性近似给出了进入控制体积的热率：\n$$\nq_w \\;=\\; A \\, \\frac{T_L - T_P}{\\dfrac{\\Delta x_P}{2 k_P}} \\;=\\; a_b \\, (T_L - T_P),\n$$\n其中边界热导为\n$$\na_b \\;\\equiv\\; \\frac{A \\, k_P}{\\Delta x_P/2}.\n$$\n由于没有西侧相邻单元，半离散平衡方程变为\n$$\nM_P \\, \\frac{d T_P}{d t} \\;=\\; a_b \\, (T_L - T_P) \\;+\\; a_E \\, (T_E - T_P) \\;+\\; \\dot{s}_P \\, V_P,\n$$\n通过设置以下系数，可将其写成规范形式：\n$$\nC_W \\;=\\; 0,\\qquad\nC_E \\;=\\; a_E,\\qquad\nC_P \\;=\\; -\\,(a_b + a_E),\\qquad\nB \\;=\\; \\dot{s}_P \\, V_P \\;+\\; a_b \\, T_L.\n$$\n\n右侧 Neumann 边界（东侧表面给定外向热通量）：\n设 $ q''_R $ 表示单元 $P$ 东侧表面给定的外向热通量，离开求解域时为正。根据符号约定（进入单元为正），通过东侧表面进入 $P$ 的相应热率为 $ q_e = - \\, q''_R \\, A $。西侧内部界面贡献的热率为 $ q_w = a_W \\, (T_W - T_P) $。半离散平衡方程为\n$$\nM_P \\, \\frac{d T_P}{d t} \\;=\\; a_W \\, (T_W - T_P) \\;-\\; q''_R \\, A \\;+\\; \\dot{s}_P \\, V_P,\n$$\n因此\n$$\nC_W \\;=\\; a_W,\\qquad\nC_E \\;=\\; 0,\\qquad\nC_P \\;=\\; -\\,a_W,\\qquad\nB \\;=\\; \\dot{s}_P \\, V_P \\;-\\; q''_R \\, A.\n$$\n\n计算系数的算法：\n- 计算 $ V_P = A \\, \\Delta x_P $ 和 $ M_P = \\rho_P \\, c_{p,P} \\, V_P $。\n- 对于任意两个热导率为 $k_i$、到界面距离为 $ \\delta x_i $ 的单元之间的内部界面，使用通量连续性/两点通量近似来计算热导：\n$$\n\\frac{A}{\\sum_i \\delta x_i / k_i}.\n$$\n对于西侧内部界面 $ (W,P) $，使用 $ \\delta x_{Ww} = \\Delta x_W/2 $ 和 $ \\delta x_{Pw} = \\Delta x_P/2 $。对于东侧内部界面 $ (P,E) $，使用 $ \\delta x_{Pe} = \\Delta x_P/2 $ 和 $ \\delta x_{Ee} = \\Delta x_E/2 $。\n- 对于左侧 Dirichlet 边界，计算 $ a_b = A \\, k_P / (\\Delta x_P/2) $。对于右侧 Neumann 边界，计算进入单元的边界热率为 $ -\\, q''_R \\, A $。\n- 根据上述情况组合 $ C_W, C_P, C_E, B $。\n- 始终使用 SI 单位。\n\n测试套件的数值计算：\n\n1. 内部单元：\n- $ A = 0.008 $, $ \\Delta x_W = 0.012 $, $ \\Delta x_P = 0.015 $, $ \\Delta x_E = 0.020 $, $ k_W = 150 $, $ k_P = 180 $, $ k_E = 210 $, $ \\rho_P = 7800 $, $ c_{p,P} = 500 $, $ \\dot{s}_P = 2.0 \\times 10^5 $。\n- $ V_P = 0.008 \\times 0.015 = 0.00012 $ 立方米，$ M_P = 7800 \\times 500 \\times 0.00012 = 468.0 $ 焦耳/开尔文。\n- $ a_W = \\dfrac{0.008}{\\dfrac{0.015}{2 \\times 180} + \\dfrac{0.012}{2 \\times 150}} \\approx 97.959183673 $ 瓦特/开尔文。\n- $ a_E = \\dfrac{0.008}{\\dfrac{0.015}{2 \\times 180} + \\dfrac{0.020}{2 \\times 210}} = 89.6 $ 瓦特/开尔文。\n- $ C_W = 97.959183673 $，$ C_E = 89.6 $，$ C_P = - (97.959183673 + 89.6) = -187.559183673 $。\n- $ B = \\dot{s}_P \\, V_P = 200000 \\times 0.00012 = 24.0 $。\n\n2. 左侧 Dirichlet 边界：\n- $ A = 0.005 $, $ \\Delta x_P = 0.010 $, $ \\Delta x_E = 0.020 $, $ k_P = 200 $, $ k_E = 180 $, $ \\rho_P = 8900 $, $ c_{p,P} = 385 $, $ \\dot{s}_P = 0 $, $ T_L = 400 $。\n- $ V_P = 0.005 \\times 0.010 = 0.00005 $，$ M_P = 8900 \\times 385 \\times 0.00005 = 171.325 $。\n- $ a_E = \\dfrac{0.005}{\\dfrac{0.010}{2 \\times 200} + \\dfrac{0.020}{2 \\times 180}} \\approx 62.068965517 $。\n- $ a_b = \\dfrac{0.005 \\times 200}{0.010/2} = 200.0 $。\n- $ C_W = 0 $，$ C_E = 62.068965517 $，$ C_P = - (200.0 + 62.068965517) = -262.068965517 $。\n- $ B = 0 + 200.0 \\times 400 = 80000.0 $。\n\n3. 右侧 Neumann 边界：\n- $ A = 0.010 $, $ \\Delta x_W = 0.020 $, $ \\Delta x_P = 0.010 $, $ k_W = 30 $, $ k_P = 15 $, $ \\rho_P = 1200 $, $ c_{p,P} = 1800 $, $ \\dot{s}_P = 5.0 \\times 10^4 $, $ q''_R = 1.0 \\times 10^4 $。\n- $ V_P = 0.010 \\times 0.010 = 0.0001 $，$ M_P = 1200 \\times 1800 \\times 0.0001 = 216.0 $。\n- $ a_W = \\dfrac{0.010}{\\dfrac{0.010}{2 \\times 15} + \\dfrac{0.020}{2 \\times 30}} = \\dfrac{0.010}{\\dfrac{0.010}{30} + \\dfrac{0.020}{60}} = 15.0 $。\n- $ C_W = 15.0 $，$ C_E = 0.0 $，$ C_P = -15.0 $。\n- $ B = \\dot{s}_P \\, V_P - q''_R \\, A = 50000 \\times 0.0001 - 10000 \\times 0.010 = 5.0 - 100.0 = -95.0 $。\n\n因此，对于这三个用例，所需的输出 $ [C_W, C_P, C_E, B, M_P] $ 在四舍五入到六位小数后为：\n- 用例 $1$：$ [97.959184, -187.559184, 89.600000, 24.000000, 468.000000] $。\n- 用例 $2$：$ [0.000000, -262.068966, 62.068966, 80000.000000, 171.325000] $。\n- 用例 $3$：$ [15.000000, -15.000000, 0.000000, -95.000000, 216.000000] $。\n\n下面的程序根据给定的输入，遵循上述推导来计算这些值，并以所需的确切单行格式打印它们。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_interior_coeffs(A, dxW, dxP, dxE, kW, kP, kE, rhoP, cpP, sdot):\n    # Volume and capacity\n    V = A * dxP\n    MP = rhoP * cpP * V\n    # Conductances via two-point flux approximation (harmonic resistance sum)\n    denom_W = dxP / (2.0 * kP) + dxW / (2.0 * kW)\n    denom_E = dxP / (2.0 * kP) + dxE / (2.0 * kE)\n    aW = A / denom_W\n    aE = A / denom_E\n    # Canonical coefficients\n    CW = aW\n    CE = aE\n    CP = -(aW + aE)\n    B = sdot * V\n    return CW, CP, CE, B, MP\n\ndef compute_left_dirichlet_coeffs(A, dxP, dxE, kP, kE, rhoP, cpP, sdot, TL):\n    V = A * dxP\n    MP = rhoP * cpP * V\n    # East interior face conductance\n    denom_E = dxP / (2.0 * kP) + dxE / (2.0 * kE)\n    aE = A / denom_E\n    # Boundary conductance at west face\n    ab = A * kP / (dxP / 2.0)\n    CW = 0.0\n    CE = aE\n    CP = -(ab + aE)\n    B = sdot * V + ab * TL\n    return CW, CP, CE, B, MP\n\ndef compute_right_neumann_coeffs(A, dxW, dxP, kW, kP, rhoP, cpP, sdot, qR_out):\n    V = A * dxP\n    MP = rhoP * cpP * V\n    # West interior face conductance\n    denom_W = dxP / (2.0 * kP) + dxW / (2.0 * kW)\n    aW = A / denom_W\n    # Boundary heat rate into the control volume is -qR_out * A\n    CW = aW\n    CE = 0.0\n    CP = -aW\n    B = sdot * V - qR_out * A\n    return CW, CP, CE, B, MP\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case returns [C_W, C_P, C_E, B, M_P]\n    results = []\n\n    # Case 1: Interior cell\n    case1 = compute_interior_coeffs(\n        A=0.008, dxW=0.012, dxP=0.015, dxE=0.020,\n        kW=150.0, kP=180.0, kE=210.0,\n        rhoP=7800.0, cpP=500.0, sdot=2.0e5\n    )\n    results.append(case1)\n\n    # Case 2: Left boundary with Dirichlet temperature\n    case2 = compute_left_dirichlet_coeffs(\n        A=0.005, dxP=0.010, dxE=0.020,\n        kP=200.0, kE=180.0,\n        rhoP=8900.0, cpP=385.0, sdot=0.0, TL=400.0\n    )\n    results.append(case2)\n\n    # Case 3: Right boundary with Neumann flux (outward positive)\n    case3 = compute_right_neumann_coeffs(\n        A=0.010, dxW=0.020, dxP=0.010,\n        kW=30.0, kP=15.0,\n        rhoP=1200.0, cpP=1800.0, sdot=5.0e4, qR_out=1.0e4\n    )\n    results.append(case3)\n\n    # Round to six decimals and format the output\n    def fmt(x):\n        return f\"{x:.6f}\"\n\n    rounded = [[fmt(val) for val in res] for res in results]\n    # Final print statement in the exact required format.\n    # Convert inner lists to numeric-looking strings (no quotes)\n    out = \"[\" + \",\".join([\"[\" + \",\".join(vals) + \"]\" for vals in rounded]) + \"]\"\n    print(out)\n\nsolve()\n```", "id": "2472571"}, {"introduction": "将导热问题离散化后，我们得到一个关于时间演化的常微分方程组。在使用显式时间积分方法（如前向欧拉法）求解时，一个至关重要的问题是数值稳定性：时间步长的选择受到严格限制，否则计算结果会出现不符合物理规律的振荡甚至发散。本练习通过经典的冯·诺依曼稳定性分析，揭示了显式格式的稳定性条件。通过这个实践，您将推导出以无量纲傅里叶数（Fourier number）表示的稳定性判据，深刻理解时间步长、网格尺寸和材料属性之间的内在制约关系。[@problem_id:2472555]", "problem": "一根均匀、各向同性的实心杆，其热导率 $k$、质量密度 $\\rho$ 和比热容 $c_p$ 均为常数，在一个空间维度上使用控制体离散化方法进行建模，该方法基于间距为 $\\Delta x$ 的均匀网格和恒定的横截面积 $A$。内部没有体积热源。考虑显式时间积分，其中所有扩散通量都在前一时间步进行评估，并假设为无限域或周期性边界条件，以便空间傅里叶模态分析得以适用。\n\n从单个控制体的积分能量平衡和傅里叶热传导定律出发，推导在控制体中心 $i$ 和时间步 $n$ 的节点温度 $T_i^{n}$ 的全离散显式更新方程。然后，进行线性冯·诺依曼稳定性分析，以无量纲傅里叶数 $\\mathrm{Fo}$（定义如下）的形式确定使得显式格式对所有空间傅里叶模态都稳定的 $\\mathrm{Fo}$ 的最大值。\n$$\n\\mathrm{Fo} \\equiv \\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}}, \\quad \\alpha \\equiv \\frac{k}{\\rho c_p},\n$$\n\n将傅里叶数的最大允许值作为一个纯数报告为最终答案。无需四舍五入，最终数值中不应包含单位，因为傅里叶数是无量纲的。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n步骤1：提取已知条件。\n- 一根均匀、各向同性的实心杆。\n- 恒定的热导率 $k$。\n- 恒定的质量密度 $\\rho$。\n- 恒定的比热容 $c_p$。\n- 一个空间维度 ($1D$)。\n- 在间距为 $\\Delta x$ 的均匀网格上进行控制体离散化。\n- 恒定的横截面积 $A$。\n- 无内部体积热源 ($ \\dot{q}'''=0 $)。\n- 显式时间积分格式。\n- 无限域或周期性边界条件，允许进行傅里叶模态分析。\n- 任务是推导节点温度 $T_i^n$ 的全离散显式更新方程。\n- 后续任务是执行冯·诺依曼稳定性分析以找到稳定性判据。\n- 傅里叶数定义为 $\\mathrm{Fo} \\equiv \\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}}$。\n- 热扩散率定义为 $\\alpha \\equiv \\frac{k}{\\rho c_p}$。\n- 最终输出必须是 $\\mathrm{Fo}$ 的最大允许值。\n\n步骤2：使用提取的已知条件进行验证。\n该问题是计算传热学领域一个经典的、适定的问题。它要求使用显式时间推进格式推导一维热传导方程的有限体积离散化，然后进行标准的冯·诺依曼稳定性分析以确定稳定性极限。\n\n- **科学依据**：该问题基于传热学（傅里叶定律）和数值方法（有限体积法，冯·诺依曼稳定性分析）的基本原理。它在科学上是合理的。\n- **适定性**：该问题提供了足够的信息来推导出一个唯一且有意义的稳定性判据。使用无限域或周期性边界条件是冯·诺依曼分析适用的标准假设。\n- **客观性**：该问题使用来自工程和应用数学的精确、客观和标准的术语进行陈述。\n\n该问题不包含科学上的不合理之处，没有缺失信息，没有矛盾，也没有主观论断。在其所述主题中，这是一个可形式化且相关的问题。\n\n步骤3：结论与行动。\n问题有效。将提供完整解答。\n\n第一步是从控制体的积分能量平衡推导离散更新方程。以节点 $i$ 为中心、体积为 $V = A \\Delta x$ 的控制体 $CV_i$ 的能量平衡由下式给出：\n$$\n\\frac{dE_{stored}}{dt} = \\dot{E}_{in} - \\dot{E}_{out} + \\dot{E}_{gen}\n$$\n储存能量的变化率是 $\\frac{dE_{stored}}{dt} = \\frac{d}{dt} (\\rho c_p T_i V) = \\rho c_p A \\Delta x \\frac{dT_i}{dt}$。问题陈述中没有内部热源，因此 $\\dot{E}_{gen} = 0$。净能量传递是由于在控制体表面 $x_{i-1/2}$ 和 $x_{i+1/2}$ 处的传导。\n$$\n\\dot{E}_{in} - \\dot{E}_{out} = \\dot{Q}_{x, i-1/2} - \\dot{Q}_{x, i+1/2}\n$$\n根据傅里叶热传导定律，热流率为 $\\dot{Q}_x = -kA \\frac{\\partial T}{\\partial x}$。我们使用相邻节点间的中心差分来近似控制体表面的梯度：\n$$\n\\dot{Q}_{x, i-1/2} \\approx -kA \\frac{T_i - T_{i-1}}{\\Delta x}\n$$\n$$\n\\dot{Q}_{x, i+1/2} \\approx -kA \\frac{T_{i+1} - T_i}{\\Delta x}\n$$\n将这些代入能量平衡方程：\n$$\n\\rho c_p A \\Delta x \\frac{dT_i}{dt} = \\left( -kA \\frac{T_i - T_{i-1}}{\\Delta x} \\right) - \\left( -kA \\frac{T_{i+1} - T_i}{\\Delta x} \\right)\n$$\n简化右侧：\n$$\n\\rho c_p A \\Delta x \\frac{dT_i}{dt} = kA \\left( \\frac{T_{i-1} - T_i}{\\Delta x} + \\frac{T_{i+1} - T_i}{\\Delta x} \\right) = \\frac{kA}{\\Delta x} (T_{i-1} - 2T_i + T_{i+1})\n$$\n除以 $\\rho c_p A \\Delta x$ 得到半离散方程：\n$$\n\\frac{dT_i}{dt} = \\frac{k}{\\rho c_p} \\frac{T_{i-1} - 2T_i + T_{i+1}}{\\Delta x^2} = \\alpha \\frac{T_{i-1} - 2T_i + T_{i+1}}{\\Delta x^2}\n$$\n对于显式时间积分格式，我们对时间导数使用前向差分，并在已知的时间步 $n$ 评估空间导数。时间导数近似为 $\\frac{dT_i}{dt} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}$。\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\frac{T_{i-1}^n - 2T_i^n + T_{i+1}^n}{\\Delta x^2}\n$$\n求解下一个时间步的温度 $T_i^{n+1}$：\n$$\nT_i^{n+1} = T_i^n + \\frac{\\alpha \\Delta t}{\\Delta x^2} (T_{i-1}^n - 2T_i^n + T_{i+1}^n)\n$$\n使用傅里叶数的定义 $\\mathrm{Fo} \\equiv \\frac{\\alpha \\Delta t}{\\Delta x^2}$，全离散显式更新方程为：\n$$\nT_i^{n+1} = T_i^n + \\mathrm{Fo} (T_{i-1}^n - 2T_i^n + T_{i+1}^n)\n$$\n$$\nT_i^{n+1} = \\mathrm{Fo} T_{i-1}^n + (1 - 2\\mathrm{Fo}) T_i^n + \\mathrm{Fo} T_{i+1}^n\n$$\n这就是所求的离散更新方程。现在，我们进行冯·诺依曼稳定性分析。我们假设解可以表示为傅里叶级数。由于方程的线性特性，我们只需考虑单一通用模态，形式如下：\n$$\nT_i^n = \\hat{T}^n e^{j K x_i}\n$$\n其中 $j = \\sqrt{-1}$ 是虚数单位，$K$ 是波数，$x_i = i \\Delta x$ 是节点 $i$ 的空间坐标，$\\hat{T}^n$ 是时间步 $n$ 时该模态的振幅。下一个时间步的温度由 $T_i^{n+1} = G T_i^n$ 给出，其中 $G = \\frac{\\hat{T}^{n+1}}{\\hat{T}^n}$ 是放大因子。为使格式稳定，放大因子的模不得超过1，即 $|G| \\leq 1$。\n\n我们将傅里叶模态表示代入离散更新方程。相邻节点的温度为：\n$$\nT_{i-1}^n = \\hat{T}^n e^{j K (i-1)\\Delta x} = \\hat{T}^n e^{j K i \\Delta x} e^{-j K \\Delta x} = T_i^n e^{-j K \\Delta x}\n$$\n$$\nT_{i+1}^n = \\hat{T}^n e^{j K (i+1)\\Delta x} = \\hat{T}^n e^{j K i \\Delta x} e^{j K \\Delta x} = T_i^n e^{j K \\Delta x}\n$$\n将这些代入更新方程：\n$$\nG T_i^n = \\mathrm{Fo} (T_i^n e^{-j K \\Delta x}) + (1 - 2\\mathrm{Fo}) T_i^n + \\mathrm{Fo} (T_i^n e^{j K \\Delta x})\n$$\n除以 $T_i^n$ (非零) 得到放大因子 $G$ 的表达式：\n$$\nG = \\mathrm{Fo} (e^{-j K \\Delta x} + e^{j K \\Delta x}) + 1 - 2\\mathrm{Fo}\n$$\n使用欧拉恒等式 $e^{j\\theta} + e^{-j\\theta} = 2\\cos(\\theta)$，其中 $\\theta = K \\Delta x$：\n$$\nG = 2\\mathrm{Fo}\\cos(K \\Delta x) + 1 - 2\\mathrm{Fo} = 1 + 2\\mathrm{Fo}(\\cos(K \\Delta x) - 1)\n$$\n使用三角恒等式 $\\cos(\\theta) - 1 = -2\\sin^2(\\frac{\\theta}{2})$：\n$$\nG = 1 + 2\\mathrm{Fo}(-2\\sin^2(\\frac{K \\Delta x}{2})) = 1 - 4\\mathrm{Fo}\\sin^2(\\frac{K \\Delta x}{2})\n$$\n放大因子 $G$ 是一个实数。稳定性条件 $|G| \\leq 1$ 变为 $-1 \\leq G \\leq 1$。\n第一个不等式 $G \\leq 1$ 是：\n$$\n1 - 4\\mathrm{Fo}\\sin^2(\\frac{K \\Delta x}{2}) \\leq 1 \\implies -4\\mathrm{Fo}\\sin^2(\\frac{K \\Delta x}{2}) \\leq 0\n$$\n由于 $\\mathrm{Fo} \\geq 0$ 且 $\\sin^2(\\cdot) \\geq 0$，此条件总是满足的。这表明该格式是耗散的，而不是放大的。\n\n第二个不等式 $G \\geq -1$ 施加了关键约束：\n$$\n1 - 4\\mathrm{Fo}\\sin^2(\\frac{K \\Delta x}{2}) \\geq -1\n$$\n$$\n2 \\geq 4\\mathrm{Fo}\\sin^2(\\frac{K \\Delta x}{2})\n$$\n$$\n\\frac{1}{2} \\geq \\mathrm{Fo}\\sin^2(\\frac{K \\Delta x}{2})\n$$\n这必须对所有可能的波数 $K$ 成立。当 $\\sin^2(\\frac{K \\Delta x}{2})$ 项达到最大值时，稳定性面临最大挑战。$\\sin^2(\\cdot)$ 的最大值是 $1$。这个最大值出现在网格所能支持的最高频率（最短波长）模态，此时温度分布在相邻节点间交替变号。这对应于波长 $\\lambda = 2\\Delta x$ 和波数 $K = \\frac{2\\pi}{\\lambda} = \\frac{\\pi}{\\Delta x}$。对于此模态，$\\frac{K \\Delta x}{2} = \\frac{\\pi}{2}$，且 $\\sin^2(\\frac{\\pi}{2}) = 1$。\n\n将此最大值代入不等式，得到对 $\\mathrm{Fo}$ 的最严格条件：\n$$\n\\frac{1}{2} \\geq \\mathrm{Fo} \\cdot 1\n$$\n$$\n\\mathrm{Fo} \\leq \\frac{1}{2}\n$$\n因此，使得显式格式对所有傅里叶模态都稳定的傅里叶数的最大值为 $\\frac{1}{2}$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2472555"}]}