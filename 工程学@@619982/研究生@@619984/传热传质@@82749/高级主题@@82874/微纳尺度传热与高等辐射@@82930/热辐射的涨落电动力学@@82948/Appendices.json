{"hands_on_practices": [{"introduction": "本练习旨在巩固涨落电动力学的基础。它将引导您从普朗克谱这一微观量子描述出发，通过严格的推导，得出描述黑体总辐射功率的宏观斯特藩-玻尔兹曼定律。\n\n完成此练习将加深您对辐射强度、能量密度和辐射通量等核心概念之间关系的理解，并熟练掌握处理热辐射理论中常见积分的技巧。这是一个奠定理论基础的关键实践。[@problem_id:2487672]", "problem": "一个温度为 $T$ 的理想吸收等温平面置于真空中。在涨落电动力学框架下，真空中的平衡电磁场在统计上是各向同性且平稳的，其单位角频率的光谱能量密度由 Planck 分布给出\n$$\nu_{\\omega}(T) \\equiv \\frac{du}{d\\omega} = \\frac{\\hbar\\,\\omega^{3}}{\\pi^{2} c^{3}}\\frac{1}{\\exp\\!\\big(\\hbar \\omega/(k_{B} T)\\big)-1},\n$$\n其中 $\\hbar$ 是约化 Planck 常数，$k_{B}$ 是 Boltzmann 常数，$c$ 是真空中的光速，$\\omega$ 是角频率。\n\n仅从光谱辐射强度 $I_{\\omega}$、能量密度 $u_{\\omega}$ 和辐射通量的定义出发，并利用真空中平衡辐射场的统计各向同性，按以下步骤进行：\n\n1. 建立 $u_{\\omega}$ 和 $I_{\\omega}$ 之间的关系，然后通过对向外的半球进行显式角平均，推导角频率为 $\\omega$ 的半球辐射出射度（离开表面的辐射通量），记为 $j^{\\star}_{\\omega}$，并用 $u_{\\omega}$ 和 $c$ 表示。\n\n2. 对 $j^{\\star}_{\\omega}$ 在所有角频率上积分，得到总半球辐射出射度 $j^{\\star}$ 作为 $T$ 的函数。精确计算该频率积分，并证明 $j^{\\star}$ 与 $T^{4}$ 成正比。确定关系式 $j^{\\star}=\\sigma T^{4}$ 中的比例常数 $\\sigma$ 的闭合形式表达式，用 $\\hbar$，$k_{B}$ 和 $c$ 表示。\n\n将你的最终答案表示为 $\\sigma$ 关于基本常数的单个闭合形式解析表达式。不要进行数值计算。$\\sigma$ 的国际单位制（SI）单位是 $\\mathrm{W\\, m^{-2}\\, K^{-4}}$，但在你的方框最终答案中不要包含单位。", "solution": "该问题陈述具有科学依据、问题明确、客观且自成体系。它代表了热辐射理论中的一个标准推导过程。我们开始进行解答。\n\n第一个任务是对于各向同性辐射场，建立光谱能量密度 $u_{\\omega}$ 与光谱辐射强度 $I_{\\omega}$ 之间的关系，然后推导半球辐射出射度 $j^{\\star}_{\\omega}$。\n\n光谱辐射强度 $I_{\\omega}$ 定义为单位时间、单位垂直于传播方向的面积、单位立体角和单位角频率的能量。能量密度 $u_{\\omega}$ 是单位体积、单位角频率的能量。在体积元 $dV$ 中，由在立体角 $d\\Omega$ 内传播的辐射所包含的能量 $dE$ 可由穿过该体积的能流给出，即单位面积上的 $I_{\\omega} d\\Omega$ 除以传播速度 $c$。穿过长度 $dL$ 所需时间为 $dL/c$。因此，体积元 $dA \\cdot dL$ 中的能量为 $(I_{\\omega} d\\Omega dA) (dL/c)$。来自该立体角的能量密度贡献为 $du_{\\omega} = \\frac{(I_{\\omega} d\\Omega dA) (dL/c)}{dA \\cdot dL} = \\frac{I_{\\omega}}{c} d\\Omega$。\n\n为了求得总光谱能量密度 $u_{\\omega}$，我们将此贡献在所有可能方向上积分，这对应于 $4\\pi$ 球面度的立体角。\n$$\nu_{\\omega} = \\int_{4\\pi} \\frac{I_{\\omega}}{c} d\\Omega\n$$\n问题陈述指出，平衡辐射场是统计上各向同性的。这意味着光谱辐射强度 $I_{\\omega}$ 与方向无关。因此，我们可以将其从积分中提出：\n$$\nu_{\\omega} = \\frac{I_{\\omega}}{c} \\int_{4\\pi} d\\Omega = \\frac{I_{\\omega}}{c} (4\\pi)\n$$\n由此，我们建立了各向同性场的光谱辐射强度和光谱能量密度之间的关系：\n$$\nI_{\\omega} = \\frac{c u_{\\omega}}{4\\pi}\n$$\n接下来，我们定义辐射通量。穿过单位法向量为 $\\mathbf{\\hat{n}}$ 的表面的光谱辐射通量是单位面积的净功率，通过对投影的光谱辐射强度在所有立体角上积分计算得出。投影由传播方向 $\\mathbf{\\hat{s}}$ 和表面法线 $\\mathbf{\\hat{n}}$ 的点积给出。\n$$\nq''_{\\omega} = \\int_{4\\pi} I_{\\omega} (\\mathbf{\\hat{s}} \\cdot \\mathbf{\\hat{n}}) d\\Omega\n$$\n半球辐射出射度 $j^{\\star}_{\\omega}$ 是远离表面的通量。对于一个法线与 $z$ 轴对齐（$\\mathbf{\\hat{n}} = \\mathbf{\\hat{z}}$）的平面，这对应于在向外的半球上积分，其中 $\\mathbf{\\hat{s}} \\cdot \\mathbf{\\hat{n}}  0$。在球坐标系中，$\\theta$ 是与法线的极角，$\\phi$ 是方位角，我们有 $\\mathbf{\\hat{s}} \\cdot \\mathbf{\\hat{n}} = \\cos\\theta$，立体角元为 $d\\Omega = \\sin\\theta d\\theta d\\phi$。积分限为 $0 \\le \\theta \\le \\pi/2$ 和 $0 \\le \\phi \\le 2\\pi$。\n\n我们现在按要求进行显式角平均：\n$$\nj^{\\star}_{\\omega} = \\int_{0}^{2\\pi} \\int_{0}^{\\pi/2} I_{\\omega} \\cos\\theta \\sin\\theta d\\theta d\\phi\n$$\n由于辐射是各向同性的，$I_{\\omega}$ 对于角变量是常数，可以从积分中提出。\n$$\nj^{\\star}_{\\omega} = I_{\\omega} \\left( \\int_{0}^{2\\pi} d\\phi \\right) \\left( \\int_{0}^{\\pi/2} \\sin\\theta \\cos\\theta d\\theta \\right)\n$$\n关于 $\\phi$ 的积分为 $2\\pi$。关于 $\\theta$ 的积分可以使用换元法 $u = \\sin\\theta$，$du = \\cos\\theta d\\theta$ 来计算，得到 $\\int_{0}^{1} u du = [u^2/2]_{0}^{1} = 1/2$。\n$$\nj^{\\star}_{\\omega} = I_{\\omega} (2\\pi) \\left(\\frac{1}{2}\\right) = \\pi I_{\\omega}\n$$\n代入先前推导的关系式 $I_{\\omega} = c u_{\\omega} / (4\\pi)$，我们得到用光谱能量密度表示的半球辐射出射度：\n$$\nj^{\\star}_{\\omega} = \\pi \\left(\\frac{c u_{\\omega}}{4\\pi}\\right) = \\frac{c u_{\\omega}}{4}\n$$\n这完成了问题的第一部分。\n\n对于第二部分，我们必须通过对 $j^{\\star}_{\\omega}$ 在从 $0$ 到 $\\infty$ 的所有角频率上积分，来求得总半球辐射出射度 $j^{\\star}$。\n$$\nj^{\\star} = \\int_{0}^{\\infty} j^{\\star}_{\\omega} d\\omega = \\int_{0}^{\\infty} \\frac{c}{4} u_{\\omega}(T) d\\omega\n$$\n我们代入给定的 $u_{\\omega}(T)$ 的 Planck 分布：\n$$\nj^{\\star} = \\int_{0}^{\\infty} \\frac{c}{4} \\left( \\frac{\\hbar\\,\\omega^{3}}{\\pi^{2} c^{3}}\\frac{1}{\\exp(\\hbar \\omega/(k_{B} T))-1} \\right) d\\omega\n$$\n简化常数，我们得到：\n$$\nj^{\\star} = \\frac{\\hbar}{4\\pi^{2} c^{2}} \\int_{0}^{\\infty} \\frac{\\omega^{3}}{\\exp(\\hbar \\omega/(k_{B} T))-1} d\\omega\n$$\n为了计算这个积分，我们进行变量替换。令 $x = \\hbar \\omega / (k_{B} T)$。则 $\\omega = x k_{B} T / \\hbar$ 且 $d\\omega = (k_{B} T / \\hbar) dx$。积分限仍然是从 $0$ 到 $\\infty$。\n$$\n\\int_{0}^{\\infty} \\frac{\\omega^{3} d\\omega}{\\exp(\\hbar \\omega/(k_{B} T))-1} = \\int_{0}^{\\infty} \\frac{(x k_{B} T / \\hbar)^{3}}{\\exp(x)-1} \\left(\\frac{k_{B} T}{\\hbar} dx\\right) = \\left(\\frac{k_{B} T}{\\hbar}\\right)^{4} \\int_{0}^{\\infty} \\frac{x^{3}}{\\exp(x)-1} dx\n$$\n将此代回 $j^{\\star}$ 的表达式中：\n$$\nj^{\\star} = \\frac{\\hbar}{4\\pi^{2} c^{2}} \\left(\\frac{k_{B} T}{\\hbar}\\right)^{4} \\int_{0}^{\\infty} \\frac{x^{3}}{\\exp(x)-1} dx = \\frac{k_{B}^{4} T^{4}}{4\\pi^{2} c^{2} \\hbar^{3}} \\int_{0}^{\\infty} \\frac{x^{3}}{\\exp(x)-1} dx\n$$\n这个表达式表明 $j^{\\star}$ 与 $T^{4}$ 成正比。剩下的任务是计算这个定积分，这是一个与 Riemann zeta 函数 $\\zeta(s)$ 和 Gamma 函数 $\\Gamma(s)$ 相关的标准形式：\n$$\n\\int_{0}^{\\infty} \\frac{x^{s-1}}{\\exp(x)-1} dx = \\Gamma(s)\\zeta(s)\n$$\n在我们的例子中，$s-1=3$，所以 $s=4$。积分的值是 $\\Gamma(4)\\zeta(4)$。我们知道 $\\Gamma(4) = (4-1)! = 3! = 6$。Riemann zeta 函数在 $s=4$ 处的值是 $\\zeta(4) = \\pi^{4}/90$。\n因此，我们的积分值为：\n$$\n\\int_{0}^{\\infty} \\frac{x^{3}}{\\exp(x)-1} dx = \\Gamma(4)\\zeta(4) = 6 \\cdot \\frac{\\pi^{4}}{90} = \\frac{\\pi^{4}}{15}\n$$\n将此值代回 $j^{\\star}$ 的表达式中：\n$$\nj^{\\star} = \\frac{k_{B}^{4} T^{4}}{4\\pi^{2} c^{2} \\hbar^{3}} \\left( \\frac{\\pi^{4}}{15} \\right) = \\frac{\\pi^{2} k_{B}^{4}}{60 \\hbar^{3} c^{2}} T^{4}\n$$\n通过将此结果与 Stefan-Boltzmann 定律 $j^{\\star} = \\sigma T^{4}$ 进行比较，我们确定比例常数 $\\sigma$，即 Stefan-Boltzmann 常数，为：\n$$\n\\sigma = \\frac{\\pi^{2} k_{B}^{4}}{60 \\hbar^{3} c^{2}}\n$$\n这就是 $\\sigma$ 以基本常数 $\\hbar$，$k_{B}$ 和 $c$ 表示的闭合形式解析表达式。", "answer": "$$\\boxed{\\frac{\\pi^{2} k_{B}^{4}}{60 \\hbar^{3} c^{2}}}$$", "id": "2487672"}, {"introduction": "在处理分层介质中的电磁问题，特别是近场辐射传热时，索末菲积分是不可或缺的数学工具。本练习要求您为一个位于半空间上方的偶极子建立其电场的积分表达式。\n\n通过这个实践，您不仅能掌握如何构建积分，更重要的是学会如何分析积分的复平面结构，识别出决定远场、近场和表面波行为的支点、极点和鞍点。这是理解近场物理并进行精确计算的理论核心。[@problem_id:2487647]", "problem": "考虑一个时谐垂直电偶极子，其偶极矩为 $p_{z}$，位于 $\\mathbf{r}_{0}=(\\rho_{0},\\phi_{0},z_{0})=(0, 0, z_{0})$。该位置处于一个均匀、各向同性、非磁性的半空间中，在一个位于 $z=0$ 的平面分界面上方。上半空间 $z>0$ 是真空，其介电常数为 $\\epsilon_{1}=\\epsilon_{0}$，磁导率为 $\\mu_{1}=\\mu_{0}$。下半空间 $z0$ 是一种耗散介质，其介电常数 $\\epsilon_{2}(\\omega)$ 随频率变化，磁导率为 $\\mu_{2}=\\mu_{0}$。假设时间依赖关系为 $\\exp(-i\\omega t)$，角频率 $\\omega>0$，并定义波数 $k_{j}=\\omega\\sqrt{\\mu_{0}\\epsilon_{j}}$，其中 $j\\in\\{1, 2\\}$。设观测点位于上半空间，坐标为 $\\mathbf{r}=(\\rho,\\phi,z)$，其中柱坐标半径 $\\rho \\geq 0$，高度 $z>0$。\n\n从频域麦克斯韦方程组和分层介质中点电偶极子源场的并矢格林函数表示出发，使用角谱表示法（Sommerfeld积分）推导上半空间中电场 $z$ 分量 $E_{z}(\\rho,z)$ 的谱积分。您的推导应：\n- 将 $E_{z}(\\rho,z)$ 表示为关于面内波矢大小 $k_{\\parallel}\\in[0, \\infty)$ 的单个Sommerfeld积分，其中包含零阶贝塞尔函数 $J_{0}$、满足辐射条件 $\\operatorname{Im}\\{\\gamma_{j}\\}\\geq0$ 的纵向谱波数 $\\gamma_{j}(k_{\\parallel})=\\sqrt{k_{j}^{2}-k_{\\parallel}^{2}}$，以及在 $z=0$ 处的p偏振（横磁）菲涅尔反射系数 $r_{p}(k_{\\parallel})$。\n- 在被积函数中清晰地分离出直达（源）项和反射项。\n- 在复 $k_{\\parallel}$ 平面中，确定与 $\\gamma_{1}(k_{\\parallel})$ 和 $\\gamma_{2}(k_{\\parallel})$ 中的平方根相关的支点位置，与p偏振反射系数的表面束缚模式相关的任何单极点的条件，以及当 $\\rho$ 和 $z+z_{0}$ 很大且比值固定时，决定反射项远场的稳相鞍点。\n- 对于鞍点分析，使用 $J_{0}$ 的大宗量指数近似来提取反射贡献的相位函数，并给出由此得到的 $k_{\\parallel}^{\\star}$ 作为 $\\rho$、$z+z_{0}$ 和 $k_{1}$ 的函数的显式表达式。\n\n请将您的最终结果以一个包含四个条目的单行矩阵形式给出：\n(1) 上半空间中 $E_{z}(\\rho,z)$ 的Sommerfeld积分表达式，用 $p_{z}$、$k_{\\parallel}$、$\\gamma_{1}$、$\\gamma_{2}$、$r_{p}$ 和 $J_{0}$ 表示；(2) 支点位置的集合；(3) $r_{p}$ 的显式极点条件；以及 (4) 反射项的显式鞍点表达式。最终答案中不要包含单位。最终答案必须是指定的单个闭式解析表达式。不需要进行数值计算。", "solution": "所提出的问题是电磁波理论中的一个典型问题，涉及偶极子源在分隔两种介质的平面界面存在时所产生的场。该问题陈述具有科学依据，提法恰当，并包含了进行严格推导所需的所有信息。这是一个有效的理论物理问题。我现在将按要求进行完整的推导。\n\n在线性、各向同性介质中，由时谐电流分布 $\\mathbf{J}$ 产生的电场 $\\mathbf{E}$ 是矢量亥姆霍兹方程的解，可以通过并矢格林函数 $\\mathbf{G}(\\mathbf{r}, \\mathbf{r}')$ 表示为：\n$$\n\\mathbf{E}(\\mathbf{r}) = i\\omega\\mu_0 \\int \\mathbf{G}(\\mathbf{r}, \\mathbf{r}') \\cdot \\mathbf{J}(\\mathbf{r}') dV'\n$$\n源是一个位于 $\\mathbf{r}_0 = (0, 0, z_0)$ 的垂直点电偶极子，其偶极矩为 $\\mathbf{p} = p_z \\hat{\\mathbf{z}}$。相应的电流密度为 $\\mathbf{J}(\\mathbf{r}') = -i\\omega \\mathbf{p} \\delta(\\mathbf{r}' - \\mathbf{r}_0) = -i\\omega p_z \\hat{\\mathbf{z}} \\delta(\\mathbf{r}' - \\mathbf{r}_0)$。将此代入场积分可得：\n$$\n\\mathbf{E}(\\mathbf{r}) = i\\omega\\mu_0 (-i\\omega p_z) \\int \\mathbf{G}(\\mathbf{r}, \\mathbf{r}') \\cdot \\hat{\\mathbf{z}} \\delta(\\mathbf{r}' - \\mathbf{r}_0) dV' = \\omega^2\\mu_0 p_z \\mathbf{G}(\\mathbf{r}, \\mathbf{r}_0) \\cdot \\hat{\\mathbf{z}}\n$$\n我们需要电场的 $z$ 分量，$E_z = \\hat{\\mathbf{z}} \\cdot \\mathbf{E}(\\mathbf{r})$。它由以下公式给出：\n$$\nE_z(\\mathbf{r}) = \\omega^2\\mu_0 p_z G_{zz}(\\mathbf{r}, \\mathbf{r}_0)\n$$\n其中 $G_{zz}(\\mathbf{r}, \\mathbf{r}_0) = \\hat{\\mathbf{z}} \\cdot \\mathbf{G}(\\mathbf{r}, \\mathbf{r}_0) \\cdot \\hat{\\mathbf{z}}$ 是并矢格林函数的 $zz$ 分量。\n\n该问题使用角谱表示法求解，也称为Sommerfeld积分表示法。对于一个在 $z=0$ 处有分界面的分层介质，当源也位于上半空间（$z_00$）时，上半空间（$z0$）中的格林函数是直达（自由空间）部分和反射部分之和。一个垂直电偶极子只激发横磁（TM或p偏振）波。对于此配置，格林函数的 $zz$ 分量在角谱表示中给出为：\n$$\nG_{zz}(\\mathbf{r}, \\mathbf{r}_0) = \\frac{i}{8\\pi^2} \\iint_{-\\infty}^{\\infty} \\frac{k_\\parallel^2}{k_1^2 \\gamma_1(k_\\parallel)} \\left[ \\exp(i\\gamma_1(k_\\parallel)|z-z_0|) + r_p(k_\\parallel) \\exp(i\\gamma_1(k_\\parallel)(z+z_0)) \\right] \\exp(i\\mathbf{k}_\\parallel \\cdot (\\boldsymbol{\\rho} - \\boldsymbol{\\rho}_0)) d^2k_\\parallel\n$$\n此处，$\\mathbf{k}_\\parallel = (k_x, k_y)$ 是面内波矢，$k_\\parallel=|\\mathbf{k}_\\parallel|$，$\\boldsymbol{\\rho} = (x, y)$ 是面内位置矢量。源位于 $\\boldsymbol{\\rho}_0 = 0$。介质 $j$ 中的纵向波数是 $\\gamma_j(k_\\parallel) = \\sqrt{k_j^2 - k_\\parallel^2}$，并满足条件 $\\operatorname{Im}\\{\\gamma_j\\} \\geq 0$ 以确保波在远离源/界面时衰减。项 $r_p(k_\\parallel)$ 是在 $z=0$ 界面上，来自介质1的入射波的p偏振菲涅尔反射系数：\n$$\nr_p(k_\\parallel) = \\frac{\\epsilon_2(\\omega) \\gamma_1(k_\\parallel) - \\epsilon_1 \\gamma_2(k_\\parallel)}{\\epsilon_2(\\omega) \\gamma_1(k_\\parallel) + \\epsilon_1 \\gamma_2(k_\\parallel)}\n$$\n其中 $\\epsilon_1 = \\epsilon_0$。\n\n通过利用问题的柱对称性，可以简化对 $d^2k_\\parallel = k_\\parallel dk_\\parallel d\\phi_k$ 的二维积分。我们使用零阶贝塞尔函数 $J_0$ 的恒等式：\n$$\n\\int_0^{2\\pi} \\exp(i\\mathbf{k}_\\parallel \\cdot \\boldsymbol{\\rho}) d\\phi_k = \\int_0^{2\\pi} \\exp(ik_\\parallel \\rho \\cos(\\phi_k - \\phi)) d\\phi_k = 2\\pi J_0(k_\\parallel \\rho)\n$$\n将此代入 $G_{zz}$ 的表达式，可得：\n$$\nG_{zz}(\\rho, z) = \\frac{i}{4\\pi} \\int_0^\\infty \\frac{k_\\parallel^3}{k_1^2 \\gamma_1(k_\\parallel)} J_0(k_\\parallel \\rho) \\left[ \\exp(i\\gamma_1(k_\\parallel)|z-z_0|) + r_p(k_\\parallel) \\exp(i\\gamma_1(k_\\parallel)(z+z_0)) \\right] dk_\\parallel\n$$\n现在，我们使用 $E_z = \\omega^2\\mu_0 p_z G_{zz}$ 来求电场分量 $E_z$。给定 $k_1^2 = \\omega^2\\mu_1\\epsilon_1 = \\omega^2\\mu_0\\epsilon_0$，我们有 $\\omega^2\\mu_0 = k_1^2/\\epsilon_0$。这导致：\n$$\nE_z(\\rho,z) = \\frac{k_1^2 p_z}{\\epsilon_0} G_{zz}(\\rho, z) = \\frac{i k_1^2 p_z}{4\\pi\\epsilon_0} \\int_0^\\infty \\frac{k_\\parallel^3}{k_1^2 \\gamma_1(k_\\parallel)} J_0(k_\\parallel \\rho) \\left[ \\dots \\right] dk_\\parallel\n$$\n$k_1^2$ 项相消，得到 $E_z(\\rho,z)$ 的最终积分表达式。这构成了第一个要求的结果。\n\n第二个和第三个要求的结果与复 $k_\\parallel$ 平面中被积函数的奇点有关。这些奇点决定了波的传播特性。\n1. 支点：被积函数包含多值函数 $\\gamma_1(k_\\parallel) = \\sqrt{k_1^2 - k_\\parallel^2}$ 和 $\\gamma_2(k_\\parallel) = \\sqrt{k_2^2 - k_\\parallel^2}$。当平方根的宗量为零时，出现支点。\n   - 对于 $\\gamma_1(k_\\parallel)$：$k_1^2 - k_\\parallel^2 = 0 \\implies k_\\parallel = \\pm k_1$。\n   - 对于 $\\gamma_2(k_\\parallel)$：$k_2^2 - k_\\parallel^2 = 0 \\implies k_\\parallel = \\pm k_2$。\n   由于介质1是真空，$k_1$ 是实数。由于介质2是耗散的，$\\epsilon_2(\\omega)$ 是复数且 $\\operatorname{Im}\\{\\epsilon_2(\\omega)\\}  0$，因此 $k_2 = \\omega \\sqrt{\\mu_0\\epsilon_2(\\omega)}$ 是复数，通常位于复平面的第一象限。因此，所有支点的集合为 $\\{k_1, -k_1, k_2, -k_2\\}$。\n\n2. 极点：极点可能源于反射系数 $r_p(k_\\parallel)$ 的分母。这些极点对应于可以在界面上激发的表面束缚模式（表面等离激元）。通过将 $r_p(k_\\parallel)$ 的分母设为零，可以找到极点条件：\n   $$\n   \\epsilon_2(\\omega) \\gamma_1(k_\\parallel) + \\epsilon_1 \\gamma_2(k_\\parallel) = 0\n   $$\n   代入 $\\epsilon_1 = \\epsilon_0$，条件为 $\\epsilon_2 \\sqrt{k_1^2 - k_\\parallel^2} + \\epsilon_0 \\sqrt{k_2^2 - k_\\parallel^2} = 0$。\n\n第四个要求的结果是远场极限下反射场的鞍点。电场的反射部分为：\n$$\nE_z^{(r)}(\\rho,z) = \\frac{i p_z}{4\\pi\\epsilon_0} \\int_0^\\infty \\frac{k_\\parallel^3}{\\gamma_1(k_\\parallel)} r_p(k_\\parallel) \\exp[i\\gamma_1(k_\\parallel)(z+z_0)] J_0(k_\\parallel \\rho) dk_\\parallel\n$$\n对于大距离（$\\rho$ 和 $z+z_0$ 很大），我们使用稳相法（或鞍点法）来计算该积分。我们首先对大宗量 $k_\\parallel \\rho \\gg 1$ 的贝塞尔函数进行近似：\n$$\nJ_0(k_\\parallel \\rho) \\approx \\sqrt{\\frac{1}{2\\pi k_\\parallel \\rho}} \\left[ \\exp\\left(i(k_\\parallel \\rho - \\frac{\\pi}{4})\\right) + \\exp\\left(-i(k_\\parallel \\rho - \\frac{\\pi}{4})\\right) \\right]\n$$\n该积分分成具有两个不同相位函数的两部分。主要贡献来自稳相点，在该点，被积函数总相位的导数消失。让我们考虑第一项的相位：$\\Phi(k_\\parallel) = \\gamma_1(k_\\parallel)(z+z_0) + k_\\parallel \\rho$。稳相点 $k_\\parallel^\\star$ 由条件 $\\frac{d\\Phi}{dk_\\parallel}|_{k_\\parallel^\\star} = 0$ 找到：\n$$\n\\frac{d}{dk_\\parallel} \\left[ \\sqrt{k_1^2 - k_\\parallel^2}(z+z_0) + k_\\parallel \\rho \\right] = \\frac{-k_\\parallel}{\\sqrt{k_1^2 - k_\\parallel^2}}(z+z_0) + \\rho = 0\n$$\n求解 $k_\\parallel = k_\\parallel^\\star$：\n$$\n\\rho = \\frac{k_\\parallel^\\star}{\\sqrt{k_1^2 - (k_\\parallel^\\star)^2}}(z+z_0)\n$$\n两边平方并重新整理：\n$$\n\\rho^2 (k_1^2 - (k_\\parallel^\\star)^2) = (k_\\parallel^\\star)^2 (z+z_0)^2\n$$\n$$\n\\rho^2 k_1^2 = (k_\\parallel^\\star)^2 (\\rho^2 + (z+z_0)^2)\n$$\n这给出了鞍点的显式表达式：\n$$\nk_\\parallel^\\star = k_1 \\frac{\\rho}{\\sqrt{\\rho^2 + (z+z_0)^2}}\n$$\n这个鞍点有明确的物理意义。如果我们将从镜像偶极子 $(0, 0, -z_0)$ 到观测点 $(\\rho, z)$ 的反射角 $\\theta_r$ 定义为 $\\sin\\theta_r = \\rho / \\sqrt{\\rho^2+(z+z_0)^2}$，那么 $k_\\parallel^\\star = k_1 \\sin\\theta_r$。这意味着对远场的主要贡献来自于其波矢投影与从镜像源到观测者的几何射线相匹配的平面波。来自贝塞尔函数近似的第二项的相位为 $\\gamma_1(z+z_0) - k_\\parallel \\rho$，对于正实数 $k_\\parallel, \\rho, z, z_0$，它没有稳相点。\n\n这四个结果为所提出的问题提供了完整的解答。", "answer": "$$\n\\boxed{\n\\pmatrix{\nE_{z}(\\rho,z) = \\frac{i p_z}{4\\pi\\epsilon_0} \\int_0^\\infty \\frac{k_\\parallel^3}{\\gamma_1(k_\\parallel)} J_0(k_\\parallel \\rho) \\left[ \\exp(i\\gamma_1(k_\\parallel)|z-z_0|) + r_p(k_\\parallel) \\exp(i\\gamma_1(k_\\parallel)(z+z_0))\\right] dk_\\parallel\n\n\\{k_1, -k_1, k_2, -k_2\\}\n\n\\epsilon_2 \\gamma_1(k_\\parallel) + \\epsilon_0 \\gamma_2(k_\\parallel) = 0\n\nk_\\parallel^\\star = k_1 \\frac{\\rho}{\\sqrt{\\rho^2+(z+z_0)^2}}\n}\n}\n$$", "id": "2487647"}, {"introduction": "理论的最终目的是进行可与实验相比的定量预测，这在涨落电动力学中通常需要进行复杂的数值积分。本练习聚焦于近场热辐射计算中的一个核心实际挑战：如何高效、准确地处理贡献巨大的大平行波矢（倏逝波）积分。\n\n您将通过一个精心设计的代理问题，亲手实现并比较几种关键的数值求积方案，从而深刻理解不同变量变换和求积方法在处理此类积分时的优劣。这项计算技能是本领域研究工作中的必备工具。[@problem_id:2487670]", "problem": "考虑在固定角频率下，两个由厚度为 $d$ 的真空间隙隔开的、平行的、局域平面的半空间之间的谱近场辐射传热。在涨落电动力学和涨落-耗散定理（FDT）的框架下，平行波矢积分中的倏逝波贡献具有一个大$k_{\\parallel}$渐近结构，其中法向衰减常数的行为类似 $\\kappa \\approx k_{\\parallel}$，并且被积函数随着 $e^{-2 d k_{\\parallel}}$ 指数抑制，而面内模式数则引入了一个关于 $k_{\\parallel}$ 的多项式前因子。为分离并研究 $k_{\\parallel}$ 积分的数值收敛性，我们将完整的物理被积函数替换为以下代理族\n$$\nf_{p,d}(k) = k^{p}e^{-2 d k},\n$$\n其中 $k$ 表示 $k_{\\parallel}$，$p$ 是一个反映主导多项式前因子的非负整数，$d$ 是以米为单位的真空间隙。该代理保留了基本的大$k$尾部特性，同时又可解析积分：\n$$\nI_{p}(d) \\equiv \\int_{0}^{\\infty} k^{p}e^{-2 d k}dk = \\frac{\\Gamma(p+1)}{(2 d)^{p+1}},\n$$\n其中 $\\Gamma(\\cdot)$ 表示伽玛函数。\n\n任务。仅从上述代理及其解析值出发，实现并比较三种用于计算 $I_{p}(d)$ 的求积策略：\n\n- 在有限区间上使用截断的高斯-勒让德求积。选择截断值 $K_{\\max} = \\alpha/d$（其中 $\\alpha = 25$），使得 $e^{-2 d K_{\\max}} = e^{-50}$ 可忽略不计，并在 $[0, K_{\\max}]$ 上应用 $N_{\\mathrm{GL}} = 64$ 点的高斯-勒让德求积。\n\n- 通过正切映射到有限角度区间后使用高斯-勒让德求积。使用变量替换 $k = \\tan\\theta / d$，其中 $\\theta \\in [0, \\pi/2)$ （角度以弧度为单位），从而得到\n$$\nI_{p}(d) = \\int_{0}^{\\pi/2} \\left(\\frac{\\tan\\theta}{d}\\right)^{p} e^{-2 \\tan\\theta}\\frac{\\sec^{2}\\theta}{d}d\\theta,\n$$\n并使用 $N_{\\tan} = 64$ 点的高斯-勒让德求积在 $[0, \\pi/2]$ 上近似计算该 $\\theta$ 积分。\n\n- 通过指数缩放后使用高斯-拉盖尔求积。使用缩放 $u = 2 d k$，得到\n$$\nI_{p}(d) = \\frac{1}{(2 d)^{p+1}}\\int_{0}^{\\infty} u^{p}e^{-u}du,\n$$\n并通过 $N_{\\mathrm{Lag}} = 16$ 点的高斯-拉盖尔求积来近似计算剩余的积分。\n\n对于每种方法和测试用例，计算其相对误差\n$$\n\\varepsilon = \\frac{| I_{\\mathrm{num}} - I_{p}(d) |}{I_{p}(d)},\n$$\n其中 $I_{\\mathrm{num}}$ 是数值结果。所有角度必须以弧度为单位进行计算，所有距离 $d$ 必须使用米为单位，最终报告的误差为无量纲小数。\n\n测试套件。为以下五个测试用例（每个用例指定为 $(d, p)$）评估相对误差：\n- 用例 1: $(d, p) = (10^{-9}\\,\\mathrm{m}, 1)$.\n- 用例 2: $(d, p) = (10^{-7}\\,\\mathrm{m}, 1)$.\n- 用例 3: $(d, p) = (10^{-6}\\,\\mathrm{m}, 1)$.\n- 用例 4: $(d, p) = (10^{-7}\\,\\mathrm{m}, 0)$.\n- 用例 5: $(d, p) = (10^{-7}\\,\\mathrm{m}, 2)$.\n\n输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n$$\n[\\varepsilon_{\\mathrm{GL,Case1}}, \\varepsilon_{\\tan,\\mathrm{Case1}}, \\varepsilon_{\\mathrm{Lag,Case1}}, \\ldots, \\varepsilon_{\\mathrm{GL,Case5}}, \\varepsilon_{\\tan,\\mathrm{Case5}}, \\varepsilon_{\\mathrm{Lag,Case5}}].\n$$\n不应打印任何额外文本。请使用米为单位表示所有的 $d$，整数表示所有的 $p$，并确保所有计算均使用弧度作为角度单位。输出结果为无量纲小数。", "solution": "问题陈述经验证。\n\n已知条件提取如下：\n- 用于平行波矢积分的代理被积函数：$f_{p,d}(k) = k^{p}e^{-2 d k}$，其中 $k$ 是 $k_{\\parallel}$ 的代理，$p$ 是一个非负整数，$d$ 是以米为单位的真空间隙距离。\n- 在半无限域上的积分解析值：$I_{p}(d) \\equiv \\int_{0}^{\\infty} k^{p}e^{-2 d k}dk = \\frac{\\Gamma(p+1)}{(2 d)^{p+1}}$。\n- 求积策略1（截断的高斯-勒让德）：\n  - 积分区间：$[0, K_{\\max}]$ 其中 $K_{\\max} = \\alpha/d$ 且 $\\alpha = 25$。\n  - 方法：使用 $N_{\\mathrm{GL}} = 64$ 点的高斯-勒让德求积。\n- 求积策略2（使用正切映射的高斯-勒让德）：\n  - 变量替换：$k = \\tan\\theta / d$，对于 $\\theta \\in [0, \\pi/2)$。\n  - 变换后的积分：$I_{p}(d) = \\int_{0}^{\\pi/2} (\\frac{\\tan\\theta}{d})^{p} e^{-2 \\tan\\theta}\\frac{\\sec^{2}\\theta}{d}d\\theta$。\n  - 方法：在 $\\theta$ 区间 $[0, \\pi/2]$ 上使用 $N_{\\tan} = 64$ 点的高斯-勒让德求积。\n- 求积策略3（高斯-拉盖尔）：\n  - 变量替换：$u = 2 d k$。\n  - 变换后的积分：$I_{p}(d) = \\frac{1}{(2 d)^{p+1}}\\int_{0}^{\\infty} u^{p}e^{-u}du$。\n  - 方法：使用 $N_{\\mathrm{Lag}} = 16$ 点的高斯-拉盖尔求积。\n- 误差度量：相对误差 $\\varepsilon = \\frac{| I_{\\mathrm{num}} - I_{p}(d) |}{I_{p}(d)}$。\n- 测试用例 $(d, p)$：用例 1：$(10^{-9}\\,\\mathrm{m}, 1)$，用例 2：$(10^{-7}\\,\\mathrm{m}, 1)$，用例 3：$(10^{-6}\\,\\mathrm{m}, 1)$，用例 4：$(10^{-7}\\,\\mathrm{m}, 0)$，用例 5：$(10^{-7}\\,\\mathrm{m}, 2)$。\n\n验证结论：\n该问题是有效的。它在数值分析方面有科学依据，问题设定良好，提供了所有必要信息，并且是客观的。源于涨落电动力学的物理动机，为比较数值求积技术的严谨数学问题提供了一个现实的背景。参数和方法定义清晰，可以导出一个唯一的、可验证的解。\n\n开始求解。\n目标是针对一组指定的参数，计算三种不同的数值求积策略相对于一个已知解析积分的相对误差。\n\n首先，我们确定积分的精确值，它将作为我们误差计算的参考。该积分由下式给出\n$$\nI_{p}(d) = \\int_{0}^{\\infty} k^{p}e^{-2 d k}dk = \\frac{\\Gamma(p+1)}{(2 d)^{p+1}}\n$$\n其中 $\\Gamma(\\cdot)$ 是伽玛函数。对于指定的非负整数 $p$ 值，$\\Gamma(p+1) = p!$。\n\n任务的核心是实现这三种求积方案。数值求积通过加权和 $\\sum_{i=1}^N w_i g(x_i)$ 来近似定积分 $\\int_a^b g(x) dx$，其中点 $x_i$ 和权重 $w_i$ 特定于所选的规则。当积分区间不是求积规则的标准区间时，需要进行变量替换。\n\n方法1：截断的高斯-勒让德求积\n积分在 $K_{\\max} = \\alpha/d = 25/d$ 处被截断。我们要近似计算 $I_{p}(d) \\approx \\int_{0}^{K_{\\max}} k^{p}e^{-2 d k}dk$。\n$N_{\\mathrm{GL}}=64$ 点的高斯-勒让德求积定义在区间 $[-1, 1]$ 上。我们必须将此区间映射到 $[0, K_{\\max}]$。设标准变量为 $t \\in [-1, 1]$，物理变量为 $k \\in [0, K_{\\max}]$。仿射映射为：\n$$\nk(t) = \\frac{K_{\\max} - 0}{2} t + \\frac{K_{\\max} + 0}{2} = \\frac{K_{\\max}}{2}(t+1)\n$$\n微分元变换为 $dk = \\frac{K_{\\max}}{2}dt$。积分变为：\n$$\n\\int_{0}^{K_{\\max}} f_{p,d}(k) dk = \\int_{-1}^{1} f_{p,d}\\left(\\frac{K_{\\max}}{2}(t+1)\\right) \\frac{K_{\\max}}{2} dt\n$$\n使用具有点 $t_i$ 和权重 $w_i^{\\mathrm{GL}}$ 的 $N_{\\mathrm{GL}}$ 点高斯-勒让德法则，数值近似为：\n$$\nI_{\\mathrm{GL}} = \\frac{K_{\\max}}{2} \\sum_{i=1}^{N_{\\mathrm{GL}}} w_i^{\\mathrm{GL}} f_{p,d}\\left(\\frac{K_{\\max}}{2}(t_i+1)\\right)\n$$\n其中 $f_{p,d}(k) = k^p e^{-2dk}$。\n\n方法2：使用正切映射的高斯-勒让德求积\n此方法首先使用代换 $k = (\\tan\\theta)/d$ 将半无限积分域 $[0, \\infty)$ 变换为有限积分域 $[0, \\pi/2)$ 。微分量为 $dk = (\\sec^2\\theta)/d \\, d\\theta$。积分变换为：\n$$\nI_p(d) = \\int_{0}^{\\pi/2} \\left(\\frac{\\tan\\theta}{d}\\right)^{p} e^{-2 \\tan\\theta} \\frac{\\sec^{2}\\theta}{d} d\\theta\n$$\n设关于 $\\theta$ 的被积函数为 $g(\\theta)$。我们在区间 $[0, \\pi/2]$ 上应用 $N_{\\tan}=64$ 点的高斯-勒让德求积。我们将标准区间 $t \\in [-1, 1]$ 映射到 $\\theta \\in [0, \\pi/2]$：\n$$\n\\theta(t) = \\frac{\\pi/2 - 0}{2} t + \\frac{\\pi/2 + 0}{2} = \\frac{\\pi}{4}(t+1)\n$$\n微分量为 $d\\theta = \\frac{\\pi}{4}dt$。数值近似变为：\n$$\nI_{\\tan} = \\frac{\\pi}{4} \\sum_{i=1}^{N_{\\tan}} w_i^{\\mathrm{GL}} g\\left(\\frac{\\pi}{4}(t_i+1)\\right)\n$$\n\n方法3：高斯-拉盖尔求积\n此方法使用缩放 $u = 2dk$，这意味着 $k = u/(2d)$ 且 $dk = du/(2d)$。积分变为：\n$$\nI_p(d) = \\int_{0}^{\\infty} \\left(\\frac{u}{2d}\\right)^p e^{-u} \\frac{du}{2d} = \\frac{1}{(2d)^{p+1}} \\int_{0}^{\\infty} u^p e^{-u} du\n$$\n积分 $\\int_{0}^{\\infty} u^p e^{-u} du$ 是高斯-拉盖尔求积的标准形式 $\\int_0^\\infty h(u) e^{-u} du$。此处，要采样的函数是 $h(u) = u^p$。一个 $N$ 点的高斯-拉盖尔求积对于次数最高为 $2N-1$ 的多项式 $h(u)$ 是精确的。\n数值近似由下式给出：\n$$\n\\int_{0}^{\\infty} u^p e^{-u} du \\approx \\sum_{i=1}^{N_{\\mathrm{Lag}}} w_i^{\\mathrm{Lag}} u_i^p\n$$\n其中 $u_i$ 和 $w_i^{\\mathrm{Lag}}$ 是 $N_{\\mathrm{Lag}} = 16$ 的高斯-拉盖尔点和权重。完整的积分近似为：\n$$\nI_{\\mathrm{Lag}} = \\frac{1}{(2d)^{p+1}} \\sum_{i=1}^{N_{\\mathrm{Lag}}} w_i^{\\mathrm{Lag}} u_i^p\n$$\n对于此问题，整数参数 $p$ 取值为 $0, 1, 2$。由于我们使用 $N_{\\mathrm{Lag}} = 16$ 点，该求积对于次数最高为 $2(16)-1 = 31$ 的多项式是精确的。因为 $p \\le 31$，求和 $\\sum w_i^{\\mathrm{Lag}} u_i^p$ 将以机器精度计算出 $\\int_0^\\infty u^p e^{-u} du = \\Gamma(p+1)$。因此，对于所有测试用例，相对误差 $\\varepsilon_{\\mathrm{Lag}}$ 预计都将接近于零。\n\n对于五个测试用例中的每一个 $(d,p)$，我们计算 $I_{\\mathrm{GL}}$、$I_{\\tan}$ 和 $I_{\\mathrm{Lag}}$，然后计算它们各自的相对误差 $\\varepsilon = |I_{\\mathrm{num}} - I_p(d)|/I_p(d)$。然后按指定顺序排列结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import gamma, roots_legendre, roots_laguerre\n\ndef solve():\n    \"\"\"\n    Solves the numerical quadrature comparison problem.\n\n    Implements three quadrature strategies (Truncated Gauss-Legendre,\n    Gauss-Legendre with tangent mapping, and Gauss-Laguerre) to evaluate\n    a surrogate integral from fluctuational electrodynamics. It computes\n    the relative error of each method for a suite of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (d in meters, p as integer)\n        (1e-9, 1),\n        (1e-7, 1),\n        (1e-6, 1),\n        (1e-7, 0),\n        (1e-7, 2),\n    ]\n\n    results = []\n\n    for d, p in test_cases:\n        #\n        # 1. Analytical Solution\n        #\n        # I_p(d) = Gamma(p+1) / (2*d)^(p+1)\n        # For integer p, Gamma(p+1) = p!\n        I_exact = gamma(p + 1) / ((2 * d)**(p + 1))\n\n        #\n        # 2. Method 1: Truncated Gauss-Legendre Quadrature\n        #\n        alpha = 25.0\n        N_gl = 64\n        K_max = alpha / d\n\n        # Get standard Gauss-Legendre points and weights for interval [-1, 1]\n        points_gl, weights_gl = roots_legendre(N_gl)\n\n        # Map points and weights to the integration interval [0, K_max]\n        # k = (K_max/2) * (t + 1), where t is in [-1, 1]\n        # Integral = (K_max/2) * sum(w_i * f(k_i))\n        k_vals = 0.5 * K_max * (points_gl + 1)\n        integrand_vals_gl = k_vals**p * np.exp(-2 * d * k_vals)\n        I_gl = 0.5 * K_max * np.sum(weights_gl * integrand_vals_gl)\n        \n        err_gl = np.abs(I_gl - I_exact) / I_exact\n        results.append(err_gl)\n\n        #\n        # 3. Method 2: Gauss-Legendre with Tangent Mapping\n        #\n        # Integral over theta from 0 to pi/2\n        N_tan = 64\n\n        # Get standard Gauss-Legendre points and weights for interval [-1, 1]\n        points_tan, weights_tan = roots_legendre(N_tan)\n\n        # Map points and weights to the integration interval [0, pi/2]\n        # theta = (pi/4) * (t + 1), where t is in [-1, 1]\n        # Integral = (pi/4) * sum(w_i * g(theta_i))\n        theta_vals = (np.pi / 4.0) * (points_tan + 1)\n        \n        tan_theta = np.tan(theta_vals)\n        # sec^2(theta) = 1/cos^2(theta)\n        sec_sq_theta = 1.0 / (np.cos(theta_vals)**2)\n        \n        # Integrand g(theta) = ((tan(theta)/d)^p) * exp(-2*tan(theta)) * (sec^2(theta)/d)\n        integrand_vals_tan = (\n            (tan_theta / d)**p *\n            np.exp(-2 * tan_theta) *\n            (sec_sq_theta / d)\n        )\n        I_tan = (np.pi / 4.0) * np.sum(weights_tan * integrand_vals_tan)\n        \n        err_tan = np.abs(I_tan - I_exact) / I_exact\n        results.append(err_tan)\n\n        #\n        # 4. Method 3: Gauss-Laguerre Quadrature\n        #\n        # Integral = (1/(2d)^(p+1)) * Integral_0^inf(u^p * exp(-u) du)\n        N_lag = 16\n\n        # Get standard Gauss-Laguerre points and weights for integral over [0, inf)\n        # with weight function exp(-u)\n        points_lag, weights_lag = roots_laguerre(N_lag)\n\n        # The function to integrate is h(u) = u^p\n        # The quadrature sum is sum(w_i * h(u_i))\n        # This is exact for polynomials of degree up to 2*N_lag - 1 = 31.\n        # Since max(p) is 2, this will be highly accurate.\n        integral_part_num = np.sum(weights_lag * (points_lag**p))\n        \n        I_lag = integral_part_num / ((2 * d)**(p + 1))\n        \n        err_lag = np.abs(I_lag - I_exact) / I_exact\n        results.append(err_lag)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2487670"}]}