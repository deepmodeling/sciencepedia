{"hands_on_practices": [{"introduction": "本练习是应用玻尔兹曼输运方程（BTE）的一项基础实践。你将从单模弛豫时间近似下的BTE出发，为各向异性晶体推导热导率张量。这项推导练习能够巩固你对微观性质（如声子色散关系）与宏观输运系数之间联系的理解，让你从第一性原理的层面掌握热导率的物理内涵。[@problem_id:2514919]", "problem": "考虑一个三维正交晶体，其长波声学声子由一个线性、各向异性的色散关系描述\n$$\n\\omega(\\mathbf{q})=\\sqrt{v_{x}^{2} q_{x}^{2}+v_{y}^{2} q_{y}^{2}+v_{z}^{2} q_{z}^{2}},\n$$\n其中 $v_{x}$、$v_{y}$ 和 $v_{z}$ 是主方向上的声速，$\\mathbf{q}=(q_{x},q_{y},q_{z})$ 是波矢。假设如下：\n- 晶体处于经典（高温）区，其中模式热容趋向于 $k_{B}$，并且体积比热 $C_{v}$ 在所关心的温度范围内不随温度改变。\n- 热输运由一个微小的、静态的温度梯度驱动，因此线性响应理论适用。\n- 声子动力学由玻尔兹曼输运方程（BTE）控制，碰撞算符在单模弛豫时间近似（SMRTA）下处理，弛豫时间 $\\tau$ 与频率无关。\n- 光学支可以忽略，并使用带有适当截断的德拜近似，以使 $C_{v}$ 能够正确地再现声学模式的总数。\n- 边界散射和同位素散射在被弛豫时间 $\\tau$ 所表示的范围之外是可忽略的，并且乌姆克拉普过程（U过程）也包含在 $\\tau$ 的影响中。\n\n在这些假设下，从第一性原理推导该正交晶体热导率张量 $k_{ij}$ 的主分量 $k_{xx}$、 $k_{yy}$ 和 $k_{zz}$。用 $v_{x}$、$v_{y}$、$v_{z}$、$\\tau$ 和 $C_{v}$ 符号化地表示你的最终结果。答案以国际单位制（SI）表示。以包含三个分量的单行的形式给出你的最终答案。", "solution": "所述问题具有科学依据、提法明确、客观且内部一致。它提出了一个固态物理学中关于声子输运的标准问题，尽管是各向异性的。所提供的假设是此类推导中常用的明确简化条件。因此，该问题是有效的，我们可以着手求解。\n\n此推导的起点是在单模弛豫时间近似（SMRTA）下，由玻尔兹曼输运方程（BTE）得到的热导率张量 $k_{ij}$ 的表达式。对于声子系统，该表达式为：\n$$\nk_{ij} = \\frac{1}{V} \\sum_{\\mathbf{q},p} C_{\\mathbf{q},p} v_{i}(\\mathbf{q},p) v_{j}(\\mathbf{q},p) \\tau(\\mathbf{q},p)\n$$\n此处，$V$ 是晶体体积，求和遍及所有声子波矢 $\\mathbf{q}$ 和极化 $p$，$C_{\\mathbf{q},p}$ 是模式 $(\\mathbf{q},p)$ 的热容，$\\mathbf{v}(\\mathbf{q},p) = \\nabla_{\\mathbf{q}}\\omega(\\mathbf{q},p)$ 是群速度，$\\tau(\\mathbf{q},p)$ 是弛豫时间。\n\n该问题通过几个假设简化了这个通用框架：\n1.  我们只考虑一个有效的声学支，因此可以省略极化指数 $p$。\n2.  弛豫时间 $\\tau$ 是一个常数，且与频率或波矢无关。\n3.  我们处于经典（高温）区，其中每个声子模式的热容都趋近于杜隆-珀蒂极限，$C_{\\mathbf{q}} = k_B$，其中 $k_B$ 是玻尔兹曼常数。\n\n在这些假设下，张量分量变为：\n$$\nk_{ij} = \\frac{k_B \\tau}{V} \\sum_{\\mathbf{q}} v_{i}(\\mathbf{q}) v_{j}(\\mathbf{q})\n$$\n对离散波矢 $\\mathbf{q}$ 的求和可以转换为在第一布里渊区（或者，在本例中是在 $\\mathbf{q}$ 空间中的德拜截断体积）上的积分：\n$$\n\\sum_{\\mathbf{q}} \\rightarrow V \\int \\frac{d^3q}{(2\\pi)^3}\n$$\n这给出了热导率张量的积分形式：\n$$\nk_{ij} = k_B \\tau \\int v_{i}(\\mathbf{q}) v_{j}(\\mathbf{q}) \\frac{d^3q}{(2\\pi)^3}\n$$\n问题指明了使用适当的德拜截断。让我们将 $k_{ij}$ 与给定的体积比热 $C_v$ 联系起来。在高温极限下，$C_v$ 是单位体积内所有模式热容的总和：\n$$\nC_v = \\frac{1}{V} \\sum_{\\mathbf{q}} C_{\\mathbf{q}} = \\frac{1}{V} \\sum_{\\mathbf{q}} k_B = k_B \\int \\frac{d^3q}{(2\\pi)^3}\n$$\n该积分的范围与计算 $k_{ij}$ 时所用的德拜截断体积相同。我们现在可以将 $k_{ij}$ 表示为：\n$$\nk_{ij} = C_v \\tau \\frac{\\int v_{i}(\\mathbf{q}) v_{j}(\\mathbf{q}) d^3q}{\\int d^3q} = C_v \\tau \\langle v_i v_j \\rangle\n$$\n其中 $\\langle \\dots \\rangle$ 表示在 $\\mathbf{q}$ 空间中对已布居声子模式的平均。问题现在简化为计算群速度分量乘积的平均值。\n\n群速度 $\\mathbf{v}(\\mathbf{q})$ 是色散关系 $\\omega(\\mathbf{q})$ 的梯度：\n$$\n\\mathbf{v}(\\mathbf{q}) = \\nabla_{\\mathbf{q}} \\omega(\\mathbf{q}) = \\left(\\frac{\\partial\\omega}{\\partial q_x}, \\frac{\\partial\\omega}{\\partial q_y}, \\frac{\\partial\\omega}{\\partial q_z}\\right)\n$$\n给定色散关系 $\\omega(\\mathbf{q}) = \\sqrt{v_{x}^{2} q_{x}^{2} + v_{y}^{2} q_{y}^{2} + v_{z}^{2} q_{z}^{2}}$，群速度的分量为：\n$$\nv_x(\\mathbf{q}) = \\frac{v_x^2 q_x}{\\omega(\\mathbf{q})}, \\quad v_y(\\mathbf{q}) = \\frac{v_y^2 q_y}{\\omega(\\mathbf{q})}, \\quad v_z(\\mathbf{q}) = \\frac{v_z^2 q_z}{\\omega(\\mathbf{q})}\n$$\n对于正交晶体，布里渊区关于 $q_x \\rightarrow -q_x$ 这类反射是对称的。热导率张量的非对角分量（如 $k_{xy}$）的被积函数将包含 $v_x v_y \\propto q_x q_y$ 这样的项。由于该函数对 $q_x$ 或 $q_y$ 都是奇函数，其在对称域上的积分为零。因此，当 $i \\neq j$ 时，$k_{ij} = 0$，我们只需要计算主分量 $k_{xx}$、$k_{yy}$ 和 $k_{zz}$。\n\n我们来计算 $k_{xx}$：\n$$\nk_{xx} = C_v \\tau \\langle v_x^2 \\rangle = C_v \\tau \\frac{\\int v_x(\\mathbf{q})^2 d^3q}{\\int d^3q}\n$$\n代入 $v_x(\\mathbf{q})$ 的表达式：\n$$\n\\langle v_x^2 \\rangle = \\frac{\\int \\frac{v_x^4 q_x^2}{v_x^2 q_x^2 + v_y^2 q_y^2 + v_z^2 q_z^2} d^3q}{\\int d^3q}\n$$\n为计算这些积分，我们进行变量替换以简化分母。令 $\\mathbf{Q} = (Q_x, Q_y, Q_z)$，其中 $Q_x = v_x q_x$、$Q_y = v_y q_y$ 且 $Q_z = v_z q_z$。此变换的雅可比行列式给出了体积元 $d^3q = \\frac{d^3Q}{v_x v_y v_z}$。分母变为 $Q_x^2 + Q_y^2 + Q_z^2 = Q^2$。适当的德拜截断是一个等频面，$\\omega(\\mathbf{q}) = \\omega_D$，这在新坐标系中对应于一个半径为 $Q = \\omega_D$ 的球。\n分子中的积分变换为：\n$$\n\\int \\frac{v_x^4 (Q_x/v_x)^2}{Q^2} \\frac{d^3Q}{v_x v_y v_z} = \\frac{v_x}{v_y v_z} \\int_{Q \\le \\omega_D} \\frac{Q_x^2}{Q^2} d^3Q\n$$\n分母中的积分变为：\n$$\n\\int d^3q = \\int_{Q \\le \\omega_D} \\frac{d^3Q}{v_x v_y v_z} = \\frac{1}{v_x v_y v_z} \\int_{Q \\le \\omega_D} d^3Q\n$$\n因此，平均值为：\n$$\n\\langle v_x^2 \\rangle = \\frac{\\frac{v_x}{v_y v_z} \\int \\frac{Q_x^2}{Q^2} d^3Q}{\\frac{1}{v_x v_y v_z} \\int d^3Q} = v_x^2 \\frac{\\int \\frac{Q_x^2}{Q^2} d^3Q}{\\int d^3Q}\n$$\n积分域是 $\\mathbf{Q}$ 空间中的一个球。根据对称性，在此球形体积上对 $Q_x^2/Q^2$、$Q_y^2/Q^2$ 和 $Q_z^2/Q^2$ 的积分必定相等。因此：\n$$\n\\int \\frac{Q_x^2}{Q^2} d^3Q = \\int \\frac{Q_y^2}{Q^2} d^3Q = \\int \\frac{Q_z^2}{Q^2} d^3Q\n$$\n将它们相加得到：\n$$\n\\int \\frac{Q_x^2 + Q_y^2 + Q_z^2}{Q^2} d^3Q = \\int \\frac{Q^2}{Q^2} d^3Q = \\int d^3Q\n$$\n这意味着 $3 \\int \\frac{Q_x^2}{Q^2} d^3Q = \\int d^3Q$。因此，积分的比值为：\n$$\n\\frac{\\int \\frac{Q_x^2}{Q^2} d^3Q}{\\int d^3Q} = \\frac{1}{3}\n$$\n将此结果代回 $\\langle v_x^2 \\rangle$ 的表达式中：\n$$\n\\langle v_x^2 \\rangle = v_x^2 \\cdot \\frac{1}{3} = \\frac{1}{3}v_x^2\n$$\n最后，我们得到 $k_{xx}$ 的表达式：\n$$\nk_{xx} = C_v \\tau \\langle v_x^2 \\rangle = \\frac{1}{3} C_v \\tau v_x^2\n$$\n根据对称性，$k_{yy}$ 和 $k_{zz}$ 的计算是相同的，仅涉及指标 $x$、$y$ 和 $z$ 的置换。这得到：\n$$\nk_{yy} = \\frac{1}{3} C_v \\tau v_y^2\n$$\n$$\nk_{zz} = \\frac{1}{3} C_v \\tau v_z^2\n$$\n这些是热导率张量的主分量。结果在量纲上是正确的，因为热导率的单位是 W m$^{-1}$ K$^{-1}$，这与 $C_v \\tau v^2$ 的单位（J m$^{-3}$ K$^{-1}$ $\\cdot$ s $\\cdot$ m$^2$ s$^{-2}$ = J m$^{-1}$ s$^{-1}$ K$^{-1}$）相匹配。如果 $v_x = v_y = v_z = v_s$，该结果正确地简化为众所周知的各向同性公式 $k = \\frac{1}{3}C_v v_s^2 \\tau$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{3} C_v \\tau v_x^2 & \\frac{1}{3} C_v \\tau v_y^2 & \\frac{1}{3} C_v \\tau v_z^2\n\\end{pmatrix}\n}\n$$", "id": "2514919"}, {"introduction": "在基础理论之上，本练习将从抽象的推导过渡到实际应用，旨在对与温度相关的热导率 $\\kappa(T)$ 进行建模。你将实现一个综合了多种声子散射机制（包括U-过程、杂质和边界散射）的模型，并将其与合成的“实验”数据进行拟合。这项练习将让你深刻理解在不同温度区间内，各种散射过程是如何相互竞争并占据主导地位的，这是材料表征和设计中的一项关键技能。[@problem_id:2514903]", "problem": "您的任务是在弛豫时间近似的声子玻尔兹曼输运方程框架下，推导、实现并校准一个基于物理的晶格热导率模型。您必须从第一性原理和核心定义开始，而不是从预先给出的简化公式开始。目标是使用一个模型来拟合随温度变化的导热系数曲线，该模型中的散射率由三个过程决定：三声子 Umklapp 散射、点缺陷（瑞利）杂质散射和边界散射。\n\n起点和约束：\n- 从稳态输运的弛豫时间近似下的声子玻尔兹曼输运方程开始，将热通量与模式比热容、声子群速度和弛豫时间联系起来，并对三维声学声子使用具有恒定群速度的德拜模型。\n- 使用 Matthiessen 法则组合散射机制。总弛豫时间 $\\tau(\\omega,T)$ 满足 $\\tau^{-1}(\\omega,T) = \\tau_{U}^{-1}(\\omega,T) + \\tau_{I}^{-1}(\\omega) + \\tau_{B}^{-1}$，其中：\n  1. Umklapp 散射率的形式为 $\\tau_{U}^{-1}(\\omega,T) \\sim A \\,\\omega^{2}\\, T \\,\\exp\\!\\left(-\\Theta_{D}/(b T)\\right)$，其中 $A$ 和 $b$ 将通过数据拟合得到。\n  2. 点缺陷（杂质）散射率的形式为 $\\tau_{I}^{-1}(\\omega) \\sim B \\,\\omega^{4}$，其中 $B$ 将通过拟合得到。\n  3. 边界散射率为 $\\tau_{B}^{-1} = v/L$，其中 $v$ 是恒定的群速度，$L$ 是特征边界长度，将为每个数据集指定。\n- 使用三维德拜态密度以及与德拜模型和玻色-爱因斯坦统计一致的标准模式比热容表达式。假设所有声学模式具有单一的平均声速 $v$。\n\n使用的单位和常数：\n- 玻尔兹曼常数 $k_{B} = 1.380649\\times 10^{-23}\\ \\text{J/K}$。\n- 约化普朗克常数 $\\hbar = 1.054571817\\times 10^{-34}\\ \\text{J}\\cdot\\text{s}$。\n- 德拜温度 $\\Theta_{D} = 645\\ \\text{K}$。\n- 平均声子群速度 $v = 6400\\ \\text{m/s}$。\n- 所有温度 $T$ 的单位均为 $\\text{K}$。\n- 特征长度 $L$ 的单位均为 $\\text{m}$。\n- 拟合常数必须以以下单位报告：$A$ 的单位为 $\\text{s/K}$，$b$ 无量纲，$B$ 的单位为 $\\text{s}^{3}$。\n- 所有最终数值输出均以国际单位制（SI）表示，并将每个拟合参数四舍五入至三位有效数字。\n\n程序任务：\n1. 在上述假设下，从玻尔兹曼输运方程推导出晶格热导率 $\\kappa(T)$ 的一个易于处理的积分表达式，该表达式是关于声子角频率（或等效的无量纲积分变量）的积分，并明确体现德拜模型、模式比热容和 Matthiessen 法则的使用。您的实现必须能够对任意给定的 $T$, $A$, $b$, $B$, $L$, $\\Theta_{D}$ 和 $v$ 通过数值积分计算 $\\kappa(T)$。\n2. 通过在指定温度下评估您推导的 $\\kappa(T)$，为以下三种情况生成合成的“实验”数据集（不添加噪声）。每个数据集使用上面给出的相同的 $\\Theta_{D}$ 和 $v$，但使用不同的 $L$ 和不同的基准散射参数 $(A_{\\text{true}}, b_{\\text{true}}, B_{\\text{true}})$：\n   - 数据集 $1$（块体，高纯度）：$L = 10^{-3}\\ \\text{m}$，$A_{\\text{true}} = 2.0\\times 10^{-19}\\ \\text{s/K}$，$b_{\\text{true}} = 3.0$，$B_{\\text{true}} = 1.0\\times 10^{-45}\\ \\text{s}^{3}$，温度 $T \\in \\{20, 50, 100, 150, 200, 250, 300\\}\\ \\text{K}$。\n   - 数据集 $2$（纳米线，边界限制）：$L = 10^{-6}\\ \\text{m}$，$A_{\\text{true}} = 2.0\\times 10^{-19}\\ \\text{s/K}$，$b_{\\text{true}} = 3.0$，$B_{\\text{true}} = 1.0\\times 10^{-45}\\ \\text{s}^{3}$，温度 $T \\in \\{20, 50, 100, 150, 200, 250, 300\\}\\ \\text{K}$。\n   - 数据集 $3$（块体，更多杂质）：$L = 10^{-3}\\ \\text{m}$，$A_{\\text{true}} = 2.0\\times 10^{-19}\\ \\text{s/K}$，$b_{\\text{true}} = 3.0$，$B_{\\text{true}} = 5.0\\times 10^{-44}\\ \\text{s}^{3}$，温度 $T \\in \\{20, 50, 100, 150, 200, 250, 300\\}\\ \\text{K}$。\n3. 对每个数据集，对模型参数 $(A,b,B)$ 进行非线性最小二乘法拟合，以拟合合成的“实验”$\\kappa(T)$值，从而恢复估计值 $(\\hat{A}, \\hat{b}, \\hat{B})$。对 $A$ 和 $B$ 施加正值约束，并对 $b$ 施加一个物理上合理的范围（例如，在 $1$ 和 $10$ 之间）。\n4. 报告每个数据集的拟合参数，以国际单位制（SI）的浮点数形式表示，每个参数四舍五入至三位有效数字。此外，强制规定任何角度（如果有）都以弧度为单位，尽管此处未使用角度量。\n\n测试套件和要求的最终输出：\n- 您的程序必须精确使用上述三个数据集。\n- 您的程序必须输出单行内容，该行包含一个用方括号括起来的逗号分隔列表。该列表必须包含三项，每项对应一个数据集，其中每项是一个包含三个浮点数 $[\\hat{A},\\hat{b},\\hat{B}]$ 的列表，这些浮点数已四舍五入至三位有效数字并采用所需单位。例如，最终输出格式必须为 $[[\\hat{A}_{1},\\hat{b}_{1},\\hat{B}_{1}],[\\hat{A}_{2},\\hat{b}_{2},\\hat{B}_{2}],[\\hat{A}_{3},\\hat{b}_{3},\\hat{B}_{3}]]$。\n- 输出必须是数值型且单位一致：$A$ 的单位为 $\\text{s/K}$，$b$ 无量纲，$B$ 的单位为 $\\text{s}^{3}$。\n\n科学真实性与覆盖范围：\n- 数据集 $1$ 探究了理想情况，即在高温下 Umklapp 过程占主导地位，而杂质/边界散射较弱。\n- 数据集 $2$ 探究了边界限制的情况，其中 $\\tau_{B}^{-1}$ 大得多，从而在中低温度下抑制了 $\\kappa$。\n- 数据集 $3$ 通过增加 $B$ 来探究中低温度下杂质主导的行为。\n- 您的推导和实现必须与上述物理模型和约束保持一致，并且校准必须通过最小化模型计算的 $\\kappa(T)$ 值与合成的“实验”$\\kappa(T)$ 值之间的残差平方和来执行。\n\n所有数值答案必须以国际单位制（SI）表示，并按要求四舍五入至三位有效数字。最终输出必须是严格按照上述格式的一行文本，不得包含任何额外文字。", "solution": "该问题要求基于声子玻尔兹曼输运方程（BTE）推导并实现一个晶格热导率 $\\kappa(T)$ 的模型。模型的参数将使用非线性最小二乘法拟合，根据合成数据集进行校准。对问题陈述的验证表明，它在科学上是合理的、适定的且内部一致的。这是固态物理学中的一个标准问题。我们开始求解。\n\n首先，我们推导晶格热导率 $\\kappa$ 的表达式。在弛豫时间近似（RTA）下，声子在小温差梯度 $\\nabla T$ 作用下的 BTE 导出了热通量 $\\mathbf{J}_q$ 的表达式。对于各向同性系统，这简化为一个标量关系式 $\\mathbf{J}_q = -\\kappa \\nabla T$。热导率 $\\kappa$ 是通过对所有声子模式（由波矢 $\\mathbf{k}$ 和极化 $p$ 索引）的贡献求和得到的。\n来自气体动理论的标准结果是：\n$$ \\kappa = \\frac{1}{3} \\int C_{ph}(\\omega, T) v^2 \\tau(\\omega, T) g(\\omega) d\\omega $$\n在这里，我们对声子角频率 $\\omega$ 进行积分。该积分的组成部分定义如下：\n$1$. $C_{ph}(\\omega, T)$ 是模式比热容，描述单个声子模式的能量如何随温度变化。根据玻色-爱因斯坦统计，对于频率为 $\\omega$ 的谐振子，其表达式为：\n$$ C_{ph}(\\omega, T) = k_B \\left( \\frac{\\hbar\\omega}{k_B T} \\right)^2 \\frac{\\exp(\\hbar\\omega/k_B T)}{[\\exp(\\hbar\\omega/k_B T) - 1]^2} $$\n其中 $\\langle n \\rangle$ 是平均声子占据数，$\\hbar$ 是约化普朗克常数，$k_B$ 是玻尔兹曼常数。\n\n$2$. $v$ 是声子群速度，假设其对于所有声学模式都是一个恒定的平均声速。因子 $1/3$ 是由于在各向同性的三维空间中进行平均（$v_x^2 \\to v^2/3$）而产生的。\n\n$3$. $\\tau(\\omega, T)$ 是声子模式的总弛豫时间（或寿命），它表征一个模式在被散射前能持续多长时间。\n\n$4$. $g(\\omega)$ 是单位体积的声子态密度。对于具有单一平均声速 $v$ 的三维德拜模型，3 个极化方向的态密度为：\n$$ g(\\omega) = \\frac{3\\omega^2}{2\\pi^2 v^3} $$\n积分的上限是德拜频率 $\\omega_D$，它由德拜温度 $\\Theta_D = \\hbar\\omega_D/k_B$ 定义。\n\n将这些分量代入 $\\kappa$ 的表达式中，得到：\n$$ \\kappa(T) = \\frac{1}{3} \\int_0^{\\omega_D} \\left[ k_B \\left( \\frac{\\hbar\\omega}{k_B T} \\right)^2 \\frac{e^{\\hbar\\omega/k_B T}}{(e^{\\hbar\\omega/k_B T} - 1)^2} \\right] v^2 \\tau(\\omega, T) \\left[ \\frac{3\\omega^2}{2\\pi^2 v^3} \\right] d\\omega $$\n简化此表达式得到：\n$$ \\kappa(T) = \\frac{k_B}{2\\pi^2 v} \\int_0^{\\omega_D} \\tau(\\omega, T) \\omega^2 \\left( \\frac{\\hbar\\omega}{k_B T} \\right)^2 \\frac{e^{\\hbar\\omega/k_B T}}{(e^{\\hbar\\omega/k_B T} - 1)^2} d\\omega $$\n为了使积分无量纲化且易于数值处理，我们引入变量 $x = \\hbar\\omega/k_B T$。由此得到 $\\omega = (k_B T/\\hbar)x$ 和 $d\\omega = (k_B T/\\hbar)dx$。积分上限变为 $x_D = \\hbar\\omega_D/k_B T = \\Theta_D/T$。代入并简化后，得到最终的积分形式：\n$$ \\kappa(T) = \\frac{k_B}{2\\pi^2 v} \\left( \\frac{k_B T}{\\hbar} \\right)^3 \\int_0^{\\Theta_D/T} \\tau(x, T) \\frac{x^4 e^x}{(e^x-1)^2} dx $$\n总弛豫时间 $\\tau$ 是通过 Matthiessen 法则组合不同散射机制的速率来确定的：$\\tau^{-1} = \\sum_i \\tau_i^{-1}$。问题指定了三种机制：\n$1$. Umklapp 散射：$\\tau_{U}^{-1} = A \\omega^2 T \\exp(-\\Theta_D/(bT))$\n$2$. 点缺陷（杂质）散射：$\\tau_{I}^{-1} = B \\omega^4$\n$3$. 边界散射：$\\tau_{B}^{-1} = v/L$\n此处，$A$、$b$ 和 $B$ 是拟合参数。用无量纲变量 $x$ 表示总散射率 $\\tau^{-1}$：\n$$ \\tau^{-1}(x, T) = \\tau_U^{-1} + \\tau_I^{-1} + \\tau_B^{-1} = A T \\left(\\frac{k_B T x}{\\hbar}\\right)^2 e^{-\\Theta_D/(bT)} + B \\left(\\frac{k_B T x}{\\hbar}\\right)^4 + \\frac{v}{L} $$\n$$ \\tau^{-1}(x, T) = A \\left(\\frac{k_B}{\\hbar}\\right)^2 T^3 e^{-\\Theta_D/(bT)} x^2 + B \\left(\\frac{k_B}{\\hbar}\\right)^4 T^4 x^4 + \\frac{v}{L} $$\n将此 $\\tau = 1/\\tau^{-1}$ 的表达式代入 $\\kappa(T)$ 的积分中。\n\n解决该问题的算法设计如下：\n$1$. **$\\kappa(T)$ 的数值计算**：实现一个 Python 函数，用于为给定的一组参数 $(T, A, b, B, L)$ 和物理常数计算 $\\kappa(T)$。该函数定义了如上推导的被积函数，并使用 `scipy.integrate.quad` 例程进行数值积分以评估定积分。\n\n$2$. **合成数据生成**：对于三种指定情况中的每一种，通过使用提供的真实参数 $(A_{\\text{true}}, b_{\\text{true}}, B_{\\text{true}})$ 和特征长度 $L$ 调用步骤 $1$ 中的函数，生成合成的“实验”数据点 $(\\kappa(T_i), T_i)$。\n\n$3$. **参数拟合**：采用 `scipy.optimize.curve_fit` 函数执行非线性最小二乘法拟合。对于每个数据集，它最小化合成的 $\\kappa(T_i)$ 值与模型预测值之间的残差平方和。该函数寻找能最好地复现数据的最优参数 $(\\hat{A}, \\hat{b}, \\hat{B})$。问题对参数指定了物理约束（$A>0$, $B>0$, and $1 \\le b \\le 10$），这些约束在拟合过程中作为边界条件施加。\n\n$4$. **输出格式化**：将三个数据集各自的拟合参数 $(\\hat{A}, \\hat{b}, \\hat{B})$ 四舍五入到三位有效数字，并格式化为最终输出所需的列表的列表结构。四舍五入通过编程方式处理以确保精度。\n\n这种结构化方法确保解决方案是从第一性原理推导出来的，正确实现，并通过与自生成数据的拟合进行验证，从而满足问题陈述的所有要求。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Derives, implements, and calibrates a model for lattice thermal conductivity.\n    \"\"\"\n\n    # Physical constants in SI units\n    K_B = 1.380649e-23  # Boltzmann constant (J/K)\n    HBAR = 1.054571817e-34 # Reduced Planck constant (J*s)\n    THETA_D = 645.0      # Debye temperature (K)\n    V = 6400.0         # Average phonon group velocity (m/s)\n\n    def round_to_sf(x, sf):\n        \"\"\"\n        Rounds a number to a specified number of significant figures.\n        \"\"\"\n        if x == 0:\n            return 0.0\n        # Use scientific notation formatting to control significant figures\n        return float(f\"{x:.{sf-1}e}\")\n\n    def kappa_integrand(x, T, A, b, B, L):\n        \"\"\"\n        The integrand for the thermal conductivity integral.\n        \"\"\"\n        # The term is ill-defined at x=0, but its limit is 0.\n        if x <= 1e-9:\n            return 0.0\n\n        # Phonon relaxation time (tau) is the inverse of the sum of scattering rates.\n        # 1. Umklapp scattering rate\n        tau_inv_U = A * T**3 * (K_B / HBAR)**2 * np.exp(-THETA_D / (b * T)) * x**2\n        # 2. Impurity (Rayleigh) scattering rate\n        tau_inv_I = B * T**4 * (K_B / HBAR)**4 * x**4\n        # 3. Boundary scattering rate\n        tau_inv_B = V / L\n        \n        total_tau_inv = tau_inv_U + tau_inv_I + tau_inv_B\n        \n        # This safeguard should not be triggered with L > 0.\n        if total_tau_inv <= 0:\n            return np.inf  # Represents infinite relaxation time\n\n        tau = 1.0 / total_tau_inv\n        \n        # The x-dependent part from heat capacity and density of states\n        # The term is x^4 * exp(x) / (exp(x)-1)^2\n        ex = np.exp(x)\n        heat_capacity_term = (x**4 * ex) / (ex - 1)**2\n\n        return tau * heat_capacity_term\n\n    def kappa_model(T_arr, A, b, B, L):\n        \"\"\"\n        Computes the lattice thermal conductivity kappa(T) for an array of temperatures.\n        \"\"\"\n        T_arr = np.atleast_1d(T_arr)\n        k_vals = np.zeros_like(T_arr, dtype=float)\n        \n        prefactor = (K_B / (2 * np.pi**2 * V)) * (K_B / HBAR)**3\n\n        for i, T in enumerate(T_arr):\n            if T <= 0:\n                k_vals[i] = 0.0\n                continue\n            \n            x_D = THETA_D / T\n            \n            args = (T, A, b, B, L)\n            # Perform numerical integration with increased precision\n            integral_val, _ = quad(kappa_integrand, 0, x_D, args=args, limit=200, epsabs=1e-12, epsrel=1e-12)\n            \n            k_vals[i] = prefactor * T**3 * integral_val\n            \n        return k_vals\n    \n    # Define the three synthetic datasets and their ground-truth parameters\n    test_cases = [\n        {\n            'L': 1e-3, \n            'params': (2.0e-19, 3.0, 1.0e-45), \n            'T': np.array([20, 50, 100, 150, 200, 250, 300])\n        },\n        {\n            'L': 1e-6, \n            'params': (2.0e-19, 3.0, 1.0e-45), \n            'T': np.array([20, 50, 100, 150, 200, 250, 300])\n        },\n        {\n            'L': 1e-3,\n            'params': (2.0e-19, 3.0, 5.0e-44),\n            'T': np.array([20, 50, 100, 150, 200, 250, 300])\n        },\n    ]\n\n    all_fitted_params = []\n    \n    for case in test_cases:\n        L = case['L']\n        true_params = case['params']\n        T_data = case['T']\n\n        # 1. Generate synthetic \"experimental\" data using the model\n        kappa_data = kappa_model(T_data, *true_params, L=L)\n\n        # 2. Define the model function for curve_fit, capturing the fixed L\n        def model_for_fit(T_arr, A, b, B):\n            return kappa_model(T_arr, A, b, B, L=L)\n\n        # 3. Set bounds and initial guess for the fitting procedure\n        bounds = ([0, 1, 0], [np.inf, 10, np.inf])\n        # Use true parameters as the initial guess to ensure robust convergence\n        p0 = true_params\n\n        # 4. Perform the nonlinear least-squares fit\n        popt, _ = curve_fit(model_for_fit, T_data, kappa_data, p0=p0, bounds=bounds, method='trf', max_nfev=5000)\n\n        # 5. Round the fitted parameters to 3 significant figures and store\n        rounded_params = [round_to_sf(p, 3) for p in popt]\n        all_fitted_params.append(rounded_params)\n\n    # 6. Format the final output string to match the required format exactly\n    # e.g., [[1.23e-19,3.0,1.0e-45],[...],[...]], with no whitespace.\n    outer_list_str_parts = []\n    for params in all_fitted_params:\n        inner_str = f\"[{','.join(map(str, params))}]\"\n        outer_list_str_parts.append(inner_str)\n    final_output_str = f\"[{','.join(outer_list_str_parts)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```", "id": "2514903"}, {"introduction": "前面的练习主要关注稳态和扩散性输运。本练习将挑战这一范式，探索傅里叶定律失效的情景。你将针对一个瞬态加热场景，对比傅里叶定律、双曲型Cattaneo模型以及BTE本身的预测结果，并确定每种模型的适用范围。这项计算练习突显了从扩散输运到弹道输运的转变过程，并强调了BTE作为描述非平衡现象的更基本理论的地位。[@problem_id:2514922]", "problem": "考虑一个一维晶体介质，其受到空间周期性的脉冲加热，产生形式为 $T(x,0)=T_{0}+\\Delta T_{0}\\cos(q x)$ 的初始温度场，其中 $q$ 是波数。假设声子系统可以通过三种不同方式建模：基于傅里叶定律的扩散模型、基于 Maxwell–Cattaneo–Vernotte 定律的双曲模型，以及在弛豫时间近似（RTA）下的灰体声子玻尔兹曼输运方程（BTE）。您的任务是推导、实现并比较这些模型在脉冲加热场景下预测的 $x=0$ 处余弦温度振幅的时间衰减，并确定在每个测试案例中，哪种连续介质模型相对于 BTE 预测最为准确。\n\n从以下基本定律出发：\n- 对于体积热容为 $C$ 的刚性固体，能量守恒定律为：$\\dfrac{\\partial T}{\\partial t}+\\dfrac{1}{C}\\dfrac{\\partial q}{\\partial x}=0$。\n- 傅里叶定律：$q=-k\\,\\dfrac{\\partial T}{\\partial x}$，其中 $k$ 是热导率，$\\alpha=k/C$ 是热扩散率。\n- Maxwell–Cattaneo–Vernotte (Cattaneo) 定律：$q+\\tau\\,\\dfrac{\\partial q}{\\partial t}=-k\\,\\dfrac{\\partial T}{\\partial x}$，其中弛豫时间 $\\tau$ 产生有限的热波速度 $c_{\\mathrm{th}}=\\sqrt{\\alpha/\\tau}$。\n- 在弛豫时间近似下，一维空间中每个方向上的偏离能量密度 $g(\\mu,t)$ 的灰体声子 BTE（方向余弦 $\\mu\\in[-1,1]$）：$\\dfrac{\\partial g}{\\partial t}+v\\,\\mu\\,\\dfrac{\\partial g}{\\partial x}=-\\dfrac{g-C\\,T}{\\tau}$，其中 $v$ 是平均声子群速度，$\\Lambda=v\\tau$ 是平均自由程。\n\n任务：\n1) 对于傅里叶模型，将可分离变量的拟设 $T(x,t)=A_{\\mathrm{F}}(t)\\cos(qx)$ 代入包含傅里叶定律的能量守恒方程，并推导出关于 $A_{\\mathrm{F}}(t)$ 的常微分方程（以 $q$ 和 $\\alpha$ 表示）。指明由 $T(x,0)=T_{0}+\\Delta T_{0}\\cos(qx)$ 所隐含的初始条件，并给出由 $\\Delta T_{0}$ 归一化的 $A_{\\mathrm{F}}(t)$ 的闭式表达式。\n\n2) 对于 Cattaneo 模型，将能量守恒与 Maxwell–Cattaneo–Vernotte 定律结合，并代入 $T(x,t)=A_{\\mathrm{C}}(t)\\cos(qx)$，以推导出涉及 $\\tau$、$\\alpha$ 和 $q$ 的关于 $A_{\\mathrm{C}}(t)$ 的控制常微分方程。指明由零初始热流所隐含的 $t=0$ 时 $A_{\\mathrm{C}}(t)$ 和 $\\dfrac{d A_{\\mathrm{C}}}{dt}(t)$ 的初始条件，并以统一的方式处理过阻尼、临界阻尼和欠阻尼情况，给出由 $\\Delta T_{0}$ 归一化的 $A_{\\mathrm{C}}(t)$ 相应的闭式表达式。\n\n3) 对于一维弛豫时间近似下的灰体声子 BTE，使用 $T(x,t)=A_{\\mathrm{B}}(t)\\cos(qx)$ 变换到空间频率域，并将 $g(\\mu,t)$ 定义为与该空间谐波相关的方向偏离能量振幅。使用具有横坐标 $\\{\\mu_{m}\\}$ 和权重 $\\{w_{m}\\}$（满足 $\\sum_{m=1}^{N}w_{m}=2$）的 $N$ 点 Gauss–Legendre 求积法离散化角度域 $\\mu\\in[-1,1]$。证明向量 $\\mathbf{g}(t)=[g(\\mu_{1},t),\\dots,g(\\mu_{N},t)]^{\\mathsf{T}}$ 的离散演化可以写成一个线性系统\n$$\n\\frac{d\\mathbf{g}}{dt}=\\mathbf{M}\\,\\mathbf{g},\\quad\n\\mathbf{M}=-\\mathrm{diag}\\left(\\frac{1}{\\tau}+i\\,v\\,q\\,\\mu_{m}\\right)+\\frac{1}{2\\tau}\\,\\mathbf{1}\\,\\mathbf{w}^{\\mathsf{T}},\n$$\n其中 $\\mathbf{1}$ 是全为 1 的向量，$\\mathbf{w}=[w_{1},\\dots,w_{N}]^{\\mathsf{T}}$。温度振幅则为 $A_{\\mathrm{B}}(t)=\\dfrac{1}{2}\\sum_{m=1}^{N}w_{m}\\,g(\\mu_{m},t)$，初始条件为对所有 $m$ 都有 $g(\\mu_{m},0)=\\Delta T_{0}$。解释如何通过矩阵指数 $\\mathbf{M}$ 计算 $A_{\\mathrm{B}}(t)$。\n\n4) 使用本构一致性关系 $\\alpha=\\dfrac{v^{2}\\tau}{3}$（对于各向同性灰体模型），在三个时间点 $t\\in\\{0.2\\,\\tau,\\,1.0\\,\\tau,\\,5.0\\,\\tau\\}$ 数值计算由 $\\Delta T_{0}$ 归一化的 $A_{\\mathrm{F}}(t)$、$A_{\\mathrm{C}}(t)$ 和 $A_{\\mathrm{B}}(t)$，并计算连续介质模型相对于 BTE 预测的均方根误差：\n$$\n\\varepsilon_{\\mathrm{F}}=\\sqrt{\\frac{1}{3}\\sum_{j=1}^{3}\\left(A_{\\mathrm{F}}(t_{j})-A_{\\mathrm{B}}(t_{j})\\right)^{2}},\\quad\n\\varepsilon_{\\mathrm{C}}=\\sqrt{\\frac{1}{3}\\sum_{j=1}^{3}\\left(A_{\\mathrm{C}}(t_{j})-A_{\\mathrm{B}}(t_{j})\\right)^{2}}.\n$$\n将误差较小的连续介质模型声明为每种情况下更准确的模型。\n\n5) 定义以下测试套件（所有量均为国际单位制，角度为弧度，温度为开尔文，时间为秒）。在 BTE 计算中使用 $N=16$ 个角点进行 Gauss–Legendre 求积，并为归一化设置 $\\Delta T_{0}=1$：\n- 案例 A（扩散区）：$v=4000$，$\\tau=2\\times 10^{-10}$，光栅周期 $L=1.0\\times 10^{-4}$，因此 $q=2\\pi/L$。\n- 案例 B（接近临界电报方程边界）：$v=4000$，$\\tau=2\\times 10^{-10}$，$L=5.711986\\times 10^{-6}$（因此 $q\\approx 1.1\\times 10^{6}$）。\n- 案例 C（准弹道区）：$v=4000$，$\\tau=2\\times 10^{-10}$，$L=2.513274\\times 10^{-6}$（因此 $q\\approx 2.5\\times 10^{6}$）。\n- 案例 D（弹道主导区）：$v=4000$，$\\tau=2\\times 10^{-10}$，$L=2.513274\\times 10^{-7}$（因此 $q\\approx 2.5\\times 10^{7}$）。\n\n应使用无量纲参数 $\\eta=v\\,q\\,\\tau$ 及其通过 $\\alpha=\\dfrac{v^{2}\\tau}{3}$ 与 $\\alpha$ 的关系来讨论区域识别和准确性预期。通过数值比较，明确指出在每种情况下哪种连续介质模型更接近 BTE。\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔的整数列表作为结果。每个整数按 A、B、C、D 的顺序对应一个测试案例，并指示相对于 BTE 更准确的连续介质模型：使用 $0$ 代表傅里叶模型，$1$ 代表 Cattaneo 模型。例如，输出 `[0,1,1,1]` 表示在案例 A 中傅里叶模型更接近，而在案例 B–D 中 Cattaneo 模型更接近。", "solution": "问题陈述已经过严格审查，并被确定为有效。其科学基础植根于已确立的非平衡热输运原理，问题提法良好，信息充分，足以获得唯一解，并且其表述客观、正式，没有矛盾或歧义。开始求解。\n\n针对空间周期性初始条件 $T(x,0)=T_{0}+\\Delta T_{0}\\cos(q x)$ 的温度衰减分析，将对三种不同的声子输运模型进行。常数偏移量 $T_{0}$ 是静态的，不参与动态过程。我们分析扰动振幅的演化，其初始值为 $\\Delta T_{0}$。为简单起见且不失一般性，我们在归一化推导中设置 $\\Delta T_{0}=1$。\n\n**1. 傅里叶定律（扩散模型）**\n\n基本方程是能量守恒和傅里叶热传导定律：\n$$\n\\frac{\\partial T}{\\partial t}+\\frac{1}{C}\\frac{\\partial q_{h}}{\\partial x}=0\n$$\n$$\nq_{h}=-k\\,\\frac{\\partial T}{\\partial x}\n$$\n其中 $T$ 是温度，$q_{h}$ 是热通量，$C$ 是体积热容，$k$ 是热导率。将它们结合起来，得到经典的热扩散方程：\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{k}{C}\\frac{\\partial^2 T}{\\partial x^2} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n这里，$\\alpha$ 是热扩散率。我们引入可分离变量的拟设用于温度扰动，$T(x,t) - T_0 = A_{\\mathrm{F}}(t)\\cos(qx)$。将其代入热方程，得到：\n$$\n\\frac{d A_{\\mathrm{F}}(t)}{dt}\\cos(qx) = \\alpha A_{\\mathrm{F}}(t)(-q^2\\cos(qx))\n$$\n这简化为关于振幅 $A_{\\mathrm{F}}(t)$ 的一阶常微分方程（ODE）：\n$$\n\\frac{d A_{\\mathrm{F}}(t)}{dt} = -(\\alpha q^2) A_{\\mathrm{F}}(t)\n$$\n初始条件为 $T(x,0) - T_0 = \\Delta T_{0}\\cos(qx)$，这意味着 $A_{\\mathrm{F}}(0) = \\Delta T_{0}$。此初值问题的解是一个简单的指数衰减：\n$$\nA_{\\mathrm{F}}(t) = \\Delta T_{0} \\, e^{-\\alpha q^2 t}\n$$\n因此，归一化振幅为：\n$$\n\\frac{A_{\\mathrm{F}}(t)}{\\Delta T_{0}} = e^{-\\alpha q^2 t}\n$$\n\n**2. Maxwell–Cattaneo–Vernotte 定律（双曲模型）**\n\n该模型用 Cattaneo 关系式取代傅里叶定律，以考虑热流响应中有限的弛豫时间 $\\tau$：\n$$\nq_{h}+\\tau\\,\\frac{\\partial q_{h}}{\\partial t}=-k\\,\\frac{\\partial T}{\\partial x}\n$$\n将其与能量守恒结合，得到双曲热方程，也称为电报员方程：\n$$\n\\frac{\\partial^2 T}{\\partial t^2} + \\frac{1}{\\tau}\\frac{\\partial T}{\\partial t} = \\frac{\\alpha}{\\tau}\\frac{\\partial^2 T}{\\partial x^2}\n$$\n再次代入拟设 $T(x,t) - T_0 = A_{\\mathrm{C}}(t)\\cos(qx)$，得到关于振幅 $A_{\\mathrm{C}}(t)$ 的常微分方程：\n$$\n\\frac{d^2 A_{\\mathrm{C}}(t)}{dt^2} + \\frac{1}{\\tau}\\frac{d A_{\\mathrm{C}}(t)}{dt} + \\frac{\\alpha q^2}{\\tau} A_{\\mathrm{C}}(t) = 0\n$$\n这是一个二阶线性齐次常微分方程。根据初始温度分布，初始条件为 $A_{\\mathrm{C}}(0) = \\Delta T_{0}$；根据零初始热流条件 $q_h(x,0)=0$ 和能量守恒方程，可得 $\\frac{d A_{\\mathrm{C}}}{dt}(0) = 0$。特征方程为 $r^2 + \\frac{1}{\\tau}r + \\frac{\\alpha q^2}{\\tau} = 0$，其根为：\n$$\nr_{1,2} = -\\frac{1}{2\\tau} \\pm \\sqrt{\\left(\\frac{1}{2\\tau}\\right)^2 - \\frac{\\alpha q^2}{\\tau}} = -\\frac{1}{2\\tau} \\pm \\frac{1}{2\\tau}\\sqrt{1 - 4\\alpha\\tau q^2}\n$$\n满足初始条件的 $A_{\\mathrm{C}}(t)$ 的通解可以用一个统一的形式表示，该形式适用于所有阻尼情况（过阻尼、临界阻尼和欠阻尼）：\n$$\n\\frac{A_{\\mathrm{C}}(t)}{\\Delta T_{0}} = \\frac{r_2 e^{r_1 t} - r_1 e^{r_2 t}}{r_2 - r_1}\n$$\n该表达式可以进行数值实现。为了分析上的清晰，可以根据判别式 $D = 1 - 4\\alpha\\tau q^2$ 区分三种情况：\n- **过阻尼 ($D > 0$)：** $A_{\\mathrm{C}}(t)/\\Delta T_{0} = e^{-t/2\\tau} \\left(\\cosh(\\beta t) + \\frac{1}{2\\tau\\beta}\\sinh(\\beta t)\\right)$，其中 $\\beta = \\frac{1}{2\\tau}\\sqrt{D}$。\n- **欠阻尼 ($D < 0$)：** $A_{\\mathrm{C}}(t)/\\Delta T_{0} = e^{-t/2\\tau} \\left(\\cos(\\omega t) + \\frac{1}{2\\tau\\omega}\\sin(\\omega t)\\right)$，其中 $\\omega = \\frac{1}{2\\tau}\\sqrt{-D}$。\n- **临界阻尼 ($D = 0$)：** $A_{\\mathrm{C}}(t)/\\Delta T_{0} = \\left(1 + \\frac{t}{2\\tau}\\right) e^{-t/2\\tau}$。\n\n**3. 灰体声子玻尔兹曼输运方程（BTE）**\n\n在弛豫时间近似（RTA）下，关于偏离能量分布 $g(\\mu,x,t)$ 的 BTE 方程为：\n$$\n\\frac{\\partial g}{\\partial t}+v\\,\\mu\\,\\frac{\\partial g}{\\partial x}=-\\frac{g-T}{\\tau}\n$$\n这里我们采纳问题的约定，将体积热容设为1。温度扰动 $T$ 可由 $g$ 的角矩恢复：$T(x,t) = \\frac{1}{2}\\int_{-1}^{1} g(\\mu,x,t) d\\mu$。为了分析单个空间傅里叶模式的演化，我们使用复数表示，寻求形式为 $g(\\mu,x,t) = \\hat{g}(\\mu,t) e^{iqx}$ 的解。将其代入 BTE，得到关于复振幅 $\\hat{g}(\\mu,t)$ 的积分-微分方程：\n$$\n\\frac{\\partial \\hat{g}}{\\partial t} = -\\left(\\frac{1}{\\tau} + ivq\\mu\\right)\\hat{g} + \\frac{1}{2\\tau}\\int_{-1}^{1} \\hat{g}(\\mu',t)d\\mu'\n$$\n使用 $N$ 点 Gauss-Legendre 求积法（横坐标 $\\{\\mu_{m}\\}$，权重 $\\{w_{m}\\}$）将角度域 $\\mu \\in [-1,1]$ 离散化，将其转化为一个包含 $N$ 个耦合线性常微分方程的系统。令 $\\mathbf{g}(t) = [\\hat{g}(\\mu_1,t), \\dots, \\hat{g}(\\mu_N,t)]^{\\mathsf{T}}$。该系统为 $\\frac{d\\mathbf{g}}{dt} = \\mathbf{M}\\mathbf{g}$，其中复数矩阵 $\\mathbf{M}$ 由下式给出：\n$$\n\\mathbf{M}=-\\mathrm{diag}\\left(\\frac{1}{\\tau}+i\\,v\\,q\\,\\mu_{m}\\right)+\\frac{1}{2\\tau}\\,\\mathbf{1}\\,\\mathbf{w}^{\\mathsf{T}}\n$$\n其中 $\\mathbf{1}$ 是全为 1 的列向量，$\\mathbf{w} = [w_1, \\dots, w_N]^{\\mathsf{T}}$。初始条件 $T(x,0) - T_0 = \\Delta T_0 \\cos(qx)$ 对应于空间周期性、各向同性的初始分布，意味着对所有 $\\mu$ 都有 $\\hat{g}(\\mu,0) = \\Delta T_0$。因此，初始条件向量为 $\\mathbf{g}(0) = \\Delta T_0 \\mathbf{1}$。\n\n该线性系统的解由矩阵指数给出：\n$$\n\\mathbf{g}(t) = e^{\\mathbf{M}t}\\mathbf{g}(0) = \\Delta T_0 e^{\\mathbf{M}t}\\mathbf{1}\n$$\n温度模式的复振幅为 $\\hat{T}(q,t) = \\frac{1}{2}\\sum_{m=1}^{N} w_m \\hat{g}(\\mu_m,t) = \\frac{1}{2}\\mathbf{w}^\\mathsf{T}\\mathbf{g}(t)$。余弦模式的物理温度场为 $A_{\\mathrm{B}}(t)\\cos(qx)$，其中 $A_{\\mathrm{B}}(t)$ 是复振幅 $\\hat{T}(q,t)$ 的实部。归一化振幅为：\n$$\n\\frac{A_{\\mathrm{B}}(t)}{\\Delta T_{0}} = \\mathrm{Re}\\left(\\frac{1}{2}\\mathbf{w}^\\mathsf{T} e^{\\mathbf{M}t} \\mathbf{1}\\right)\n$$\n这对每个所需的时间 $t$ 进行数值计算。\n\n**4. 数值比较方法**\n\n使用关系式 $\\alpha = \\frac{1}{3} v^2 \\tau$ 对模型进行比较，该关系式将宏观的热扩散率与微观的声子特性（$v$，$\\tau$）联系起来。比较针对由光栅波数 $q$ 区分的四种情况进行，这些情况可通过无量纲参数 $\\eta=vq\\tau = \\Lambda q$ 来表征，其中 $\\Lambda=v\\tau$ 是声子平均自由程。\n- 案例 A（$\\eta \\approx 0.05$）：扩散区（$\\Lambda \\ll 1/q$）。预期傅里叶定律是准确的。\n- 案例 B（$\\eta \\approx 0.88$）：过渡区，接近 Cattaneo 模型的临界阻尼边界（$\\eta \\approx \\sqrt{3}/2 \\approx 0.866$）。\n- 案例 C（$\\eta = 2.0$）：准弹道区（$\\Lambda > 1/q$）。\n- 案例 D（$\\eta = 20.0$）：弹道主导区（$\\Lambda \\gg 1/q$）。\n\n在 $\\eta$ 不小的区域，扩散近似失效，而 Cattaneo 模型所捕捉的以及 BTE 固有的波动特性变得显著。我们预期对于 $\\eta \\gtrsim 1$ 的情况，Cattaneo 模型会比傅里叶模型更准确。计算傅里叶模型和 Cattaneo 模型相对于 BTE 解（作为基准）的均方根误差度量 $\\varepsilon$。产生较小误差的模型被视为在该情况下更准确的模型。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\nfrom numpy.polynomial.legendre import leggauss\n\ndef solve():\n    \"\"\"\n    Solves the heat transport problem for four test cases, comparing Fourier,\n    Cattaneo, and BTE models, and determines the more accurate continuum model.\n    \"\"\"\n    \n    # Define physical constants and problem setup\n    v = 4000.0  # m/s\n    tau = 2.0e-10  # s\n    N_quad = 16  # Number of Gauss-Legendre quadrature points\n    delta_T0 = 1.0 # Initial temperature amplitude for normalization\n\n    # Derived thermal diffusivity, consistent for all models\n    alpha = v**2 * tau / 3.0\n\n    # Dimensionless times for evaluation\n    t_points_factor = np.array([0.2, 1.0, 5.0])\n    t_points = t_points_factor * tau\n\n    # Define the test cases from the problem statement\n    # Each case is defined by the grating period L, which gives q=2*pi/L\n    test_cases_L = [\n        1.0e-4,          # Case A: Diffusive\n        5.711986e-6,     # Case B: Near critical\n        2.513274e-6,     # Case C: Quasi-ballistic\n        2.513274e-7      # Case D: Ballistic-dominated\n    ]\n    test_cases_q = [2.0 * np.pi / L for L in test_cases_L]\n\n    def solve_fourier(t_vec, alpha_p, q_p):\n        \"\"\"Calculates normalized temperature amplitude for Fourier model.\"\"\"\n        return np.exp(-alpha_p * q_p**2 * t_vec)\n\n    def solve_cattaneo(t_vec, alpha_p, tau_p, q_p):\n        \"\"\"Calculates normalized temperature amplitude for Cattaneo model.\"\"\"\n        results = []\n        # Discriminant determines the damping regime\n        discriminant = 1.0 - 4.0 * alpha_p * tau_p * q_p**2\n        \n        # Use a small tolerance for floating point comparison\n        if discriminant > 1e-9:  # Overdamped\n            beta = (1.0 / (2.0 * tau_p)) * np.sqrt(discriminant)\n            for t in t_vec:\n                val = np.exp(-t / (2.0 * tau_p)) * (np.cosh(beta * t) + np.sinh(beta * t) / (2.0 * tau_p * beta))\n                results.append(val)\n        elif discriminant < -1e-9:  # Underdamped\n            omega = (1.0 / (2.0 * tau_p)) * np.sqrt(-discriminant)\n            for t in t_vec:\n                val = np.exp(-t / (2.0 * tau_p)) * (np.cos(omega * t) + np.sin(omega * t) / (2.0 * tau_p * omega))\n                results.append(val)\n        else:  # Critically damped\n            for t in t_vec:\n                val = (1.0 + t / (2.0 * tau_p)) * np.exp(-t / (2.0 * tau_p))\n                results.append(val)\n                \n        return np.array(results)\n\n    def solve_bte(t_vec, v_p, tau_p, q_p, N_p):\n        \"\"\"Calculates normalized temperature amplitude for BTE model.\"\"\"\n        # Get Gauss-Legendre abscissae and weights for the interval [-1, 1]\n        mu, w = leggauss(N_p)\n        \n        # Construct the BTE evolution matrix M\n        diag_term = 1.0/tau_p + 1j * v_p * q_p * mu\n        M = -np.diag(diag_term) + (1.0 / (2.0 * tau_p)) * np.outer(np.ones(N_p), w)\n        \n        # Initial condition: g(mu, 0) = delta_T0\n        g0 = np.ones(N_p, dtype=np.complex128) * delta_T0\n        \n        results = []\n        for t in t_vec:\n            # Evolve the distribution function amplitude vector: g(t) = exp(M*t) * g0\n            exp_Mt = expm(M * t)\n            g_t = exp_Mt @ g0\n            \n            # Complex temperature amplitude: T_hat(q,t) = 0.5 * integral(g dmu)\n            T_hat = 0.5 * np.dot(w, g_t)\n            \n            # The physical cosine amplitude is the real part of T_hat\n            A_B = T_hat.real\n            results.append(A_B)\n            \n        # Normalize by the initial amplitude\n        return np.array(results) / delta_T0\n\n    final_results = []\n    for q_val in test_cases_q:\n        # BTE solution serves as the reference benchmark\n        A_B = solve_bte(t_points, v, tau, q_val, N_quad)\n        \n        # Fourier model solution\n        A_F = solve_fourier(t_points, alpha, q_val)\n        \n        # Cattaneo model solution\n        A_C = solve_cattaneo(t_points, alpha, tau, q_val)\n        \n        # Compute root-mean-square errors relative to BTE\n        err_F = np.sqrt(np.mean((A_F - A_B)**2))\n        err_C = np.sqrt(np.mean((A_C - A_B)**2))\n        \n        # Compare errors and determine the more accurate model\n        if err_F < err_C:\n            final_results.append(0)  # 0 indicates Fourier model is better\n        else:\n            final_results.append(1)  # 1 indicates Cattaneo model is better\n\n    # Print the final result in the specified format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```", "id": "2514922"}]}