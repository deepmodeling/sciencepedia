{"hands_on_practices": [{"introduction": "这项首个练习旨在解决任何显式时间步进模拟的一个基本要求：数值稳定性。通过分析一个一维对流-扩散方程，我们将为一个常见的离散格式推导其组合稳定性极限，即所谓的 Courant-Friedrichs-Lewy (CFL) 条件 [@problem_id:2500565]。掌握这种分析是确保模拟能够产生有物理意义的结果而非数值发散的关键第一步。", "problem": "在被动标量输运的大涡模拟（Large-Eddy Simulation, LES）中，考虑具有恒定解析速度和恒定有效扩散系数的一维滤波标量方程：\n$$\n\\frac{\\partial \\tilde{\\phi}}{\\partial t} + \\frac{\\partial}{\\partial x}\\big(\\bar{u}\\,\\tilde{\\phi}\\big) \\;=\\; \\frac{\\partial}{\\partial x}\\!\\left(\\kappa\\,\\frac{\\partial \\tilde{\\phi}}{\\partial x}\\right),\n$$\n其中 $\\tilde{\\phi}$ 是滤波后的标量，$\\bar{u}$ 是解析速度，$\\kappa$ 是有效扩散系数（分子扩散与亚格子贡献之和）。空间域在间距为 $\\Delta$ 的均匀网格上离散，时间推进采用显式前向欧拉法。对流通量采用一阶迎风格式离散，扩散通量采用二阶中心差分格式离散，两者均在守恒有限体积形式下进行。假设 $\\bar{u} \\ge 0$，因此迎风格式使用左侧状态；必要时，用 $|\\bar{u}|$ 替代 $\\bar{u}$。\n\n从时间 $t^n$ 时网格平均值 $\\tilde{\\phi}_j^n$ 的守恒有限体积更新式出发，推导出一个形式如下的单一不等式：\n$$\nf(\\Delta t;\\,\\Delta,\\,|\\bar{u}|,\\,\\kappa)\\;\\le\\;1\n$$\n该不等式需保证显式格式的线性单调性（即更新系数为非负且其和为一）。然后，对于给定的网格和材料参数：\n$$\n\\Delta \\;=\\; 2.5 \\times 10^{-3}\\ \\mathrm{m},\\qquad |\\bar{u}|\\;=\\; 3.2\\ \\mathrm{m/s},\\qquad \\kappa \\;=\\; 1.5 \\times 10^{-4}\\ \\mathrm{m^2/s},\n$$\n在试探时间步长\n$$\n\\Delta t \\;=\\; 3.00 \\times 10^{-4}\\ \\mathrm{s}\n$$\n下，计算您所推导不等式左侧的值，并将稳定裕度解释为 $1$ 减去该值。最后，确定恰好使您的不等式饱和的最大稳定显式时间步长 $\\Delta t_{\\max}$。\n\n以秒为单位，将您的最终答案表示为 $\\Delta t_{\\max}$ 的值，并四舍五入至四位有效数字。在适当之处使用 Courant–Friedrichs–Lewy (CFL) 命名法，并清楚地说明您引入的任何中间无量纲群，但不要假设任何未从所述离散化和控制方程中推导出的结果。", "solution": "对所述问题进行验证。\n\n步骤1：提取已知条件。\n- 控制方程：$\\frac{\\partial \\tilde{\\phi}}{\\partial t} + \\frac{\\partial}{\\partial x}\\big(\\bar{u}\\,\\tilde{\\phi}\\big) = \\frac{\\partial}{\\partial x}\\!\\left(\\kappa\\,\\frac{\\partial \\tilde{\\phi}}{\\partial x}\\right)$，其中 $\\tilde{\\phi}$ 是滤波后的标量，$\\bar{u}$ 是恒定解析速度，$\\kappa$ 是恒定有效扩散系数。\n- 离散化：间距为 $\\Delta$ 的均匀网格。时间上采用显式前向欧拉法。空间上采用守恒有限体积形式。\n- 通量格式：对流通量 $\\frac{\\partial}{\\partial x}(\\bar{u}\\,\\tilde{\\phi})$ 采用一阶迎风格式。扩散通量 $\\frac{\\partial}{\\partial x}(\\kappa\\,\\frac{\\partial \\tilde{\\phi}}{\\partial x})$ 采用二阶中心差分格式。\n- 迎风约定：对于 $\\bar{u} \\ge 0$，使用左侧状态。必要时，用 $|\\bar{u}|$ 替代 $\\bar{u}$。\n- 任务1：推导一个单一不等式 $f(\\Delta t;\\,\\Delta,\\,|\\bar{u}|,\\,\\kappa)\\;\\le\\;1$ 以保证线性单调性。\n- 任务2：对于给定参数，计算不等式左侧的值。\n- 任务3：解释稳定裕度。\n- 任务4：确定最大稳定显式时间步长 $\\Delta t_{\\max}$。\n- 参数：$\\Delta = 2.5 \\times 10^{-3}\\ \\mathrm{m}$， $|\\bar{u}| = 3.2\\ \\mathrm{m/s}$， $\\kappa = 1.5 \\times 10^{-4}\\ \\mathrm{m^2/s}$， $\\Delta t = 3.00 \\times 10^{-4}\\ \\mathrm{s}$。\n\n步骤2：使用提取的已知条件进行验证。\n- 问题是**有科学依据的**：它涉及对流扩散方程的标准数值格式的稳定性分析，这是计算流体力学及热质传递中的一个基本课题。大涡模拟 (LES) 的背景是恰当的，因为这种方程形式是 LES 中标量输运模型的基础。\n- 问题是**适定的**：它要求基于明确定义的离散化方法和控制方程，推导稳定性准则并进行后续计算。对于此类问题，所要求的结果（时间步长限制）是已知存在且唯一的。\n- 问题是**客观的**：所有术语都有定义，离散格式的规定没有歧义，任务是定量的、可验证的。不存在主观因素。\n- 问题是**完整且一致的**：所有必要信息（方程、格式、参数）都已提供。没有矛盾之处。\n\n步骤3：结论与行动。\n问题有效。将提供严谨的解答。\n\n我们首先构建控制方程的守恒有限体积离散格式。我们将偏微分方程在控制体（网格单元）$j$ 上进行积分，该控制体范围从 $x_{j-1/2}$ 到 $x_{j+1/2}$，其网格中心为 $x_j$ ，宽度为 $\\Delta = x_{j+1/2} - x_{j-1/2}$。\n$$\n\\int_{x_{j-1/2}}^{x_{j+1/2}} \\frac{\\partial \\tilde{\\phi}}{\\partial t} \\,dx \\;+\\; \\int_{x_{j-1/2}}^{x_{j+1/2}} \\frac{\\partial}{\\partial x}\\big(\\bar{u}\\,\\tilde{\\phi}\\big) \\,dx \\;=\\; \\int_{x_{j-1/2}}^{x_{j+1/2}} \\frac{\\partial}{\\partial x}\\!\\left(\\kappa\\,\\frac{\\partial \\tilde{\\phi}}{\\partial x}\\right) \\,dx\n$$\n设 $\\tilde{\\phi}_j(t)$ 为网格单元 $j$ 中 $\\tilde{\\phi}$ 的网格平均值。应用散度定理和网格平均值的定义，方程变为：\n$$\n\\frac{d \\tilde{\\phi}_j}{d t} \\Delta \\;+\\; \\left[F_c\\right]_{j+1/2} - \\left[F_c\\right]_{j-1/2} \\;=\\; \\left[F_d\\right]_{j+1/2} - \\left[F_d\\right]_{j-1/2}\n$$\n其中 $F_c = \\bar{u}\\,\\tilde{\\phi}$ 是对流通量，$F_d = \\kappa\\,\\frac{\\partial \\tilde{\\phi}}{\\partial x}$ 是扩散通量。整理得到网格平均值的时间导数：\n$$\n\\frac{d \\tilde{\\phi}_j}{d t} \\;=\\; -\\frac{1}{\\Delta} \\left( F_{c, j+1/2} - F_{c, j-1/2} \\right) \\;+\\; \\frac{1}{\\Delta} \\left( F_{d, j+1/2} - F_{d, j-1/2} \\right)\n$$\n现在，我们对网格单元交界面上的通量进行离散。问题要求对流项使用一阶迎风格式。由于假设 $\\bar{u} \\ge 0$，我们将其推广为使用 $|\\bar{u}|$，因此交界面上 $\\tilde{\\phi}$ 的值取自上游（左侧）的网格单元。\n$$\nF_{c, j+1/2} = |\\bar{u}| \\tilde{\\phi}_j\n$$\n$$\nF_{c, j-1/2} = |\\bar{u}| \\tilde{\\phi}_{j-1}\n$$\n扩散通量使用二阶中心差分格式进行离散：\n$$\nF_{d, j+1/2} = \\kappa \\left( \\frac{\\tilde{\\phi}_{j+1} - \\tilde{\\phi}_j}{\\Delta} \\right)\n$$\n$$\nF_{d, j-1/2} = \\kappa \\left( \\frac{\\tilde{\\phi}_j - \\tilde{\\phi}_{j-1}}{\\Delta} \\right)\n$$\n将这些通量离散格式代入半离散方程，得到：\n$$\n\\frac{d \\tilde{\\phi}_j}{d t} = -\\frac{|\\bar{u}|}{\\Delta} (\\tilde{\\phi}_j - \\tilde{\\phi}_{j-1}) + \\frac{\\kappa}{\\Delta^2} (\\tilde{\\phi}_{j+1} - 2\\tilde{\\phi}_j + \\tilde{\\phi}_{j-1})\n$$\n接下来，我们应用显式前向欧拉格式进行时间积分，其中 $\\tilde{\\phi}_j^n = \\tilde{\\phi}_j(t^n)$：\n$$\n\\frac{\\tilde{\\phi}_j^{n+1} - \\tilde{\\phi}_j^n}{\\Delta t} = -\\frac{|\\bar{u}|}{\\Delta} (\\tilde{\\phi}_j^n - \\tilde{\\phi}_{j-1}^n) + \\frac{\\kappa}{\\Delta^2} (\\tilde{\\phi}_{j+1}^n - 2\\tilde{\\phi}_j^n + \\tilde{\\phi}_{j-1}^n)\n$$\n求解 $\\tilde{\\phi}_j^{n+1}$：\n$$\n\\tilde{\\phi}_j^{n+1} = \\tilde{\\phi}_j^n - \\frac{|\\bar{u}|\\Delta t}{\\Delta} (\\tilde{\\phi}_j^n - \\tilde{\\phi}_{j-1}^n) + \\frac{\\kappa\\Delta t}{\\Delta^2} (\\tilde{\\phi}_{j+1}^n - 2\\tilde{\\phi}_j^n + \\tilde{\\phi}_{j-1}^n)\n$$\n为了分析线性单调性，我们根据空间索引对右侧的项进行分组：\n$$\n\\tilde{\\phi}_j^{n+1} = \\left(\\frac{|\\bar{u}|\\Delta t}{\\Delta} + \\frac{\\kappa\\Delta t}{\\Delta^2}\\right) \\tilde{\\phi}_{j-1}^n + \\left(1 - \\frac{|\\bar{u}|\\Delta t}{\\Delta} - \\frac{2\\kappa\\Delta t}{\\Delta^2}\\right) \\tilde{\\phi}_j^n + \\left(\\frac{\\kappa\\Delta t}{\\Delta^2}\\right) \\tilde{\\phi}_{j+1}^n\n$$\n该更新式的形式为 $\\tilde{\\phi}_j^{n+1} = C_{j-1}\\tilde{\\phi}_{j-1}^n + C_j\\tilde{\\phi}_j^n + C_{j+1}\\tilde{\\phi}_{j+1}^n$。线性单调性的条件是所有系数 $C_k$ 必须为非负，并且它们的和必须为1。我们来检验其和：\n$$\n\\sum C_k = \\left(\\frac{|\\bar{u}|\\Delta t}{\\Delta} + \\frac{\\kappa\\Delta t}{\\Delta^2}\\right) + \\left(1 - \\frac{|\\bar{u}|\\Delta t}{\\Delta} - \\frac{2\\kappa\\Delta t}{\\Delta^2}\\right) + \\left(\\frac{\\kappa\\Delta t}{\\Delta^2}\\right) = 1\n$$\n其和恒为1，这是守恒格式的一个特点。现在我们要求每个系数都为非负。令 $C = \\frac{|\\bar{u}|\\Delta t}{\\Delta}$ 为对流库朗数，$d = \\frac{\\kappa\\Delta t}{\\Delta^2}$ 为扩散库朗数（或冯·诺依曼数）。\n系数为：\n$$\nC_{j-1} = C + d = \\frac{|\\bar{u}|\\Delta t}{\\Delta} + \\frac{\\kappa\\Delta t}{\\Delta^2} \\ge 0\n$$\n$$\nC_{j+1} = d = \\frac{\\kappa\\Delta t}{\\Delta^2} \\ge 0\n$$\n$$\nC_j = 1 - C - 2d = 1 - \\frac{|\\bar{u}|\\Delta t}{\\Delta} - \\frac{2\\kappa\\Delta t}{\\Delta^2} \\ge 0\n$$\n由于 $\\Delta t$、$\\Delta$、 $|\\bar{u}|$ 和 $\\kappa$ 都是非负的物理量，因此 $C_{j-1}$ 和 $C_{j+1}$ 的条件总是满足的。格式的稳定性和单调性的约束来自于系数 $C_j$：\n$$\n1 - \\frac{|\\bar{u}|\\Delta t}{\\Delta} - \\frac{2\\kappa\\Delta t}{\\Delta^2} \\ge 0\n$$\n整理后得到所要求的不等式：\n$$\n\\frac{|\\bar{u}|\\Delta t}{\\Delta} + \\frac{2\\kappa\\Delta t}{\\Delta^2} \\le 1\n$$\n这可以写作 $C + 2d \\le 1$。问题陈述中要求的函数 $f$ 是此不等式的左侧：\n$$\nf(\\Delta t;\\,\\Delta,\\,|\\bar{u}|,\\,\\kappa) = \\Delta t \\left( \\frac{|\\bar{u}|}{\\Delta} + \\frac{2\\kappa}{\\Delta^2} \\right)\n$$\n现在，我们代入给定参数计算此函数的值：\n$\\Delta = 2.5 \\times 10^{-3}\\ \\mathrm{m}$\n$|\\bar{u}| = 3.2\\ \\mathrm{m/s}$\n$\\kappa = 1.5 \\times 10^{-4}\\ \\mathrm{m^2/s}$\n$\\Delta t = 3.00 \\times 10^{-4}\\ \\mathrm{s}$\n\n首先，我们计算括号内的各项：\n$$\n\\frac{|\\bar{u}|}{\\Delta} = \\frac{3.2}{2.5 \\times 10^{-3}} = 1280\\ \\mathrm{s^{-1}}\n$$\n$$\n\\frac{2\\kappa}{\\Delta^2} = \\frac{2 \\times (1.5 \\times 10^{-4})}{(2.5 \\times 10^{-3})^2} = \\frac{3.0 \\times 10^{-4}}{6.25 \\times 10^{-6}} = 48\\ \\mathrm{s^{-1}}\n$$\n因此，括号内的量是 $1280 + 48 = 1328\\ \\mathrm{s^{-1}}$。\n不等式的左侧为：\n$$\nf = (3.00 \\times 10^{-4}) \\times 1328 = 0.3984\n$$\n稳定裕度为 $1 - f = 1 - 0.3984 = 0.6016$。由于 $0.3984 \\le 1$，对于此试探时间步长，该格式是稳定且单调的。\n\n最后，我们确定使不等式饱和的最大稳定显式时间步长 $\\Delta t_{\\max}$：\n$$\n\\Delta t_{\\max} \\left( \\frac{|\\bar{u}|}{\\Delta} + \\frac{2\\kappa}{\\Delta^2} \\right) = 1\n$$\n$$\n\\Delta t_{\\max} = \\frac{1}{\\frac{|\\bar{u}|}{\\Delta} + \\frac{2\\kappa}{\\Delta^2}} = \\frac{1}{1328\\ \\mathrm{s^{-1}}} \\approx 0.000753012... \\ \\mathrm{s}\n$$\n按要求四舍五入至四位有效数字：\n$$\n\\Delta t_{\\max} \\approx 7.530 \\times 10^{-4}\\ \\mathrm{s}\n$$\n这是所指定的显式数值格式为保持单调性和稳定性所允许的最大时间步长。该限制是对流CFL条件（$\\Delta t \\le \\Delta/|\\bar{u}|$) 和扩散CFL条件（$\\Delta t \\le \\Delta^2/(2\\kappa)$）的组合。组合后的条件比任何单个条件都更为严格。", "answer": "$$\\boxed{7.530 \\times 10^{-4}}$$", "id": "2500565"}, {"introduction": "仅仅保证稳定性是不够的，数值格式的选择深刻影响着大涡模拟的准确性。本练习将通过分析不同对流格式的数值耗散和色散误差，深入探讨它们之间的关键权衡 [@problem_id:2500593]。这一分析将揭示格式的内在属性如何有益地模拟或有害地干扰 LES 模型旨在表示的亚格子尺度物理耗散。", "problem": "考虑在大涡模拟 (LES) 中，使用恒定的亚格子尺度 (SGS) 标量扩散系数时的一维无源标量输运。滤波后的标量场记为 $\\phi(x,t)$，该场满足以下对流-扩散方程\n$$\n\\frac{\\partial \\phi}{\\partial t} + U \\frac{\\partial \\phi}{\\partial x} = \\kappa_{t} \\frac{\\partial^{2} \\phi}{\\partial x^{2}},\n$$\n其中 $U$ 是恒定的对流速度，$\\kappa_{t}$ 是恒定的 SGS 标量扩散系数。假设有一个间距为 $\\Delta$ 的均匀周期性网格，并为傅里叶模态 $\\phi(x,0) = \\sin(k x)$ 定义无量纲波数 $\\theta \\equiv k \\Delta$。\n\n您将分析用于对流导数 $\\partial \\phi/\\partial x$ 的两种空间离散格式，这两种格式都用于 LES 中的标量输运：\n- 二阶迎风格式（对于正 $U$）：在网格点 $j$ 处的半离散空间导数近似为\n$$\n\\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{j} \\approx \\frac{3 \\phi_{j} - 4 \\phi_{j-1} + \\phi_{j-2}}{2 \\Delta}.\n$$\n- 四阶中心格式：在网格点 $j$ 处的半离散空间导数近似为\n$$\n\\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{j} \\approx \\frac{-\\phi_{j+2} + 8 \\phi_{j+1} - 8 \\phi_{j-1} + \\phi_{j-2}}{12 \\Delta}.\n$$\n对于扩散项，使用标准的二阶中心近似，\n$$\n\\left.\\frac{\\partial^{2} \\phi}{\\partial x^{2}}\\right|_{j} \\approx \\frac{\\phi_{j+1} - 2 \\phi_{j} + \\phi_{j-1}}{\\Delta^{2}}.\n$$\n\n从对流-扩散方程和上述半离散算子出发，对周期性网格上的单个模态 $\\phi_{j}(t) = A(t) \\sin(j \\theta)$ 进行傅里叶分析，以实现以下目标：\n1. 推导在每种对流格式下模态的半离散放大率，仔细区分对流引起的色散（虚部）和耗散（实部）的贡献，以及 SGS 扩散引起的耗散。仅用 $\\theta$ 表示二阶迎风对流符号的实部。\n2. 通过令二阶迎风对流引入的数值耗散率等于 SGS 扩散耗散率（两者均在相同网格上针对相同的 $\\theta$ 计算），推导出唯一的无量纲波数 $\\theta_{\\star} \\in (0,\\pi)$ 的解析表达式，在该波数上这两个耗散率相等。\n3. 当 $U = 1.0 \\ \\mathrm{m/s}$，$\\Delta = 1.0 \\times 10^{-2} \\ \\mathrm{m}$，$\\kappa_{t} = 5.0 \\times 10^{-3} \\ \\mathrm{m^{2}/s}$ 时，计算 $\\theta_{\\star}$ 的值。答案以弧度为单位。将答案四舍五入至四位有效数字。\n\n最后，简要地将您的发现与 SGS 项的混叠联系起来：对于一个二次 SGS 贡献，它由一个波数为 $k$ 的输入模态生成一个波数为 $2k$ 的模态，请说明 $2\\theta_{\\star}$ 是位于奈奎斯特无量纲波数之下、之上还是恰好等于它，并解释当使用四阶中心对流（非耗散）与二阶迎风对流（耗散）相比时，这对混叠的潜在严重性意味着什么。您的讨论应是定性且简洁的。最终需要报告的数值答案仅为 $\\theta_{\\star}$ 的计算值。", "solution": "所给出的问题经过验证，被认为是有效的。它在计算流体动力学领域，特别是在大涡模拟（LES）方面，具有科学依据。该问题是适定的、客观的，并包含足够的信息以得到唯一解。问题陈述中关于傅里叶模态形式 $\\phi_{j}(t) = A(t) \\sin(j \\theta)$ 的一个微小模糊之处，可通过将其解释为执行标准 von Neumann (傅里叶) 稳定性分析的指令来解决。这一标准程序利用复指数模态 $\\phi_j(t) = \\hat{\\phi}(t) e^{ij\\theta}$，因为它们是周期性域上线性、常系数有限差分算子的特征函数。对于一个实系数线性系统，对复指数模态的实部 ($\\cos(j\\theta)$) 和虚部 ($\\sin(j\\theta)$) 的分析是等价的。因此，这种解释是严谨的，并能得到确定的解。\n\n在网格点 $j$ 处，控制对流-扩散方程的半离散形式为：\n$$\n\\frac{d\\phi_j}{dt} = -U \\left( \\frac{\\partial \\phi}{\\partial x} \\right)_j + \\kappa_t \\left( \\frac{\\partial^2 \\phi}{\\partial x^2} \\right)_j\n$$\n将复傅里叶模态 $\\phi_j(t) = \\hat{\\phi}(t) e^{ij\\theta}$ 代入此方程，其中 $\\theta = k\\Delta$ 是无量纲波数，得到：\n$$\n\\frac{d\\hat{\\phi}}{dt} e^{ij\\theta} = \\hat{\\phi}(t) \\left[ \\mathcal{L}_{adv}(e^{ij\\theta}) + \\mathcal{L}_{diff}(e^{ij\\theta}) \\right]\n$$\n这里，$\\mathcal{L}_{adv}$ 和 $\\mathcal{L}_{diff}$ 分别代表对流和扩散的空间有限差分算子。由于 $e^{ij\\theta}$ 是这些算子的一个特征函数，我们可以写出 $\\mathcal{L}(e^{ij\\theta}) = \\hat{\\mathcal{L}}(\\theta) e^{ij\\theta}$，其中 $\\hat{\\mathcal{L}}(\\theta)$ 是算子的复符号或谱表示。该方程简化为模态振幅 $\\hat{\\phi}(t)$ 的常微分方程：\n$$\n\\frac{d\\hat{\\phi}}{dt} = \\sigma(\\theta) \\hat{\\phi}\n$$\n其中 $\\sigma(\\theta) = \\hat{\\mathcal{L}}_{adv}(\\theta) + \\hat{\\mathcal{L}}_{diff}(\\theta)$ 是总的半离散放大率。$\\sigma(\\theta)$ 的实部控制模态的耗散（如果为负）或放大（如果为正），而虚部与其相速度和色散有关。\n\n我们分析每个空间算子以找到其符号。\n\nSGS 扩散项的二阶中心差分算子为：\n$$\n\\mathcal{L}_{diff}(\\phi_j) = \\kappa_t \\frac{\\phi_{j+1} - 2\\phi_j + \\phi_{j-1}}{\\Delta^2}\n$$\n其符号 $\\hat{\\mathcal{L}}_{diff}(\\theta)$ 通过代入 $\\phi_j = e^{ij\\theta}$ 求得：\n$$\n\\hat{\\mathcal{L}}_{diff}(\\theta) = \\frac{\\kappa_t}{\\Delta^2} (e^{i\\theta} - 2 + e^{-i\\theta}) = \\frac{\\kappa_t}{\\Delta^2} (2\\cos\\theta - 2) = -\\frac{2\\kappa_t}{\\Delta^2} (1 - \\cos\\theta)\n$$\n此项为纯实数且非正，代表了 SGS 模型的耗散效应。使用恒等式 $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$，我们可以将其写为 $\\hat{\\mathcal{L}}_{diff}(\\theta) = -\\frac{4\\kappa_t}{\\Delta^2} \\sin^2(\\frac{\\theta}{2})$。\n\n现在，我们推导两种对流格式的符号。\n\n**1. 放大率及其组成部分的推导**\n\n**二阶迎风对流：**\n对流算子（当 $U>0$ 时）为：\n$$\n\\mathcal{L}_{adv, up2}(\\phi_j) = -U \\frac{3\\phi_j - 4\\phi_{j-1} + \\phi_{j-2}}{2\\Delta}\n$$\n其符号为：\n$$\n\\hat{\\mathcal{L}}_{adv, up2}(\\theta) = -\\frac{U}{2\\Delta} (3 - 4e^{-i\\theta} + e^{-i2\\theta}) = -\\frac{U}{2\\Delta} [3 - 4(\\cos\\theta - i\\sin\\theta) + (\\cos(2\\theta) - i\\sin(2\\theta))]\n$$\n使用此对流格式的半离散系统的总放大率为 $\\sigma_{up2}(\\theta) = \\hat{\\mathcal{L}}_{adv, up2}(\\theta) + \\hat{\\mathcal{L}}_{diff}(\\theta)$。\n各自的贡献为：\n-   **对流引起的耗散（数值耗散）：** 这是 $\\hat{\\mathcal{L}}_{adv, up2}(\\theta)$ 的实部。\n    $$\n    \\mathrm{Re}[\\hat{\\mathcal{L}}_{adv, up2}(\\theta)] = -\\frac{U}{2\\Delta} (3 - 4\\cos\\theta + \\cos(2\\theta))\n    $$\n    使用恒等式 $\\cos(2\\theta) = 2\\cos^2\\theta - 1$，括号中的项变为 $3 - 4\\cos\\theta + 2\\cos^2\\theta - 1 = 2(1 - 2\\cos\\theta + \\cos^2\\theta) = 2(1 - \\cos\\theta)^2$。\n    因此，实部为：\n    $$\n    \\mathrm{Re}[\\hat{\\mathcal{L}}_{adv, up2}(\\theta)] = -\\frac{U}{\\Delta} (1 - \\cos\\theta)^2\n    $$\n-   **对流引起的色散：** 这是 $\\hat{\\mathcal{L}}_{adv, up2}(\\theta)$ 的虚部。\n    $$\n    \\mathrm{Im}[\\hat{\\mathcal{L}}_{adv, up2}(\\theta)] = -\\frac{U}{2\\Delta} (4\\sin\\theta - \\sin(2\\theta))\n    $$\n-   **SGS 扩散引起的耗散：** 如前所述，这部分为：\n    $$\n    \\hat{\\mathcal{L}}_{diff}(\\theta) = -\\frac{2\\kappa_t}{\\Delta^2} (1 - \\cos\\theta)\n    $$\n\n**四阶中心对流：**\n对流算子为：\n$$\n\\mathcal{L}_{adv, c4}(\\phi_j) = -U \\frac{-\\phi_{j+2} + 8\\phi_{j+1} - 8\\phi_{j-1} + \\phi_{j-2}}{12\\Delta}\n$$\n其符号为：\n$$\n\\hat{\\mathcal{L}}_{adv, c4}(\\theta) = -\\frac{U}{12\\Delta} (-e^{i2\\theta} + 8e^{i\\theta} - 8e^{-i\\theta} + e^{-i2\\theta}) = -\\frac{U}{12\\Delta} [- (e^{i2\\theta} - e^{-i2\\theta}) + 8(e^{i\\theta} - e^{-i\\theta})]\n$$\n使用恒等式 $e^{i\\alpha} - e^{-i\\alpha} = 2i\\sin\\alpha$：\n$$\n\\hat{\\mathcal{L}}_{adv, c4}(\\theta) = -\\frac{U}{12\\Delta} [-2i\\sin(2\\theta) + 16i\\sin\\theta] = -i \\frac{U}{6\\Delta} (8\\sin\\theta - \\sin(2\\theta))\n$$\n该格式的总放大率为 $\\sigma_{c4}(\\theta) = \\hat{\\mathcal{L}}_{adv, c4}(\\theta) + \\hat{\\mathcal{L}}_{diff}(\\theta)$。各自的贡献为：\n-   **对流引起的耗散（数值耗散）：** 符号 $\\hat{\\mathcal{L}}_{adv, c4}(\\theta)$ 是纯虚数，因此其实部为零。\n    $$\n    \\mathrm{Re}[\\hat{\\mathcal{L}}_{adv, c4}(\\theta)] = 0\n    $$\n    该格式是非耗散的。\n-   **对流引起的色散：**\n    $$\n    \\mathrm{Im}[\\hat{\\mathcal{L}}_{adv, c4}(\\theta)] = -\\frac{U}{6\\Delta} (8\\sin\\theta - \\sin(2\\theta))\n    $$\n-   **SGS 扩散引起的耗散：** 这与迎风格式的相同：\n    $$\n    \\hat{\\mathcal{L}}_{diff}(\\theta) = -\\frac{2\\kappa_t}{\\Delta^2} (1 - \\cos\\theta)\n    $$\n\n**2. 无量纲波数 $\\theta_{\\star}$ 的推导**\n\n问题要求将二阶迎风对流格式引入的数值耗散率与SGS扩散耗散率相等。耗散*率*是相应符号的（负的）实部的绝对值。\n-   数值耗散率： $| \\mathrm{Re}[\\hat{\\mathcal{L}}_{adv, up2}(\\theta)] | = \\frac{U}{\\Delta} (1 - \\cos\\theta)^2$。\n-   SGS 耗散率： $| \\hat{\\mathcal{L}}_{diff}(\\theta) | = \\frac{2\\kappa_t}{\\Delta^2} (1 - \\cos\\theta)$。\n\n在特定波数 $\\theta_{\\star}$ 处令这两个率相等：\n$$\n\\frac{U}{\\Delta} (1 - \\cos\\theta_{\\star})^2 = \\frac{2\\kappa_t}{\\Delta^2} (1 - \\cos\\theta_{\\star})\n$$\n对于 $\\theta_{\\star} \\in (0, \\pi)$，$(1 - \\cos\\theta_{\\star})$ 项非零，因此我们可以两边同除以该项：\n$$\n\\frac{U}{\\Delta} (1 - \\cos\\theta_{\\star}) = \\frac{2\\kappa_t}{\\Delta^2}\n$$\n解出 $(1 - \\cos\\theta_{\\star})$：\n$$\n1 - \\cos\\theta_{\\star} = \\frac{2\\kappa_t}{U\\Delta}\n$$\n这给出了 $\\cos\\theta_{\\star}$ 的表达式：\n$$\n\\cos\\theta_{\\star} = 1 - \\frac{2\\kappa_t}{U\\Delta}\n$$\n无量纲群 $\\frac{U\\Delta}{\\kappa_t}$ 是网格佩克莱特数（grid Péclet number），记为 $Pe_{\\Delta}$。用 $Pe_{\\Delta}$ 表示，该表达式为 $\\cos\\theta_{\\star} = 1 - \\frac{2}{Pe_{\\Delta}}$。要使解 $\\theta_{\\star} \\in (0, \\pi)$ 存在，反余弦函数的自变量必须在 $(-1, 1)$ 区间内，这要求 $Pe_{\\Delta} > 1$。\n\n因此，$\\theta_{\\star}$ 的解析表达式为：\n$$\n\\theta_{\\star} = \\arccos\\left(1 - \\frac{2\\kappa_t}{U\\Delta}\\right)\n$$\n\n**3. $\\theta_{\\star}$ 的计算**\n\n我们给定的值为 $U = 1.0$ m/s, $\\Delta = 1.0 \\times 10^{-2}$ m, and $\\kappa_t = 5.0 \\times 10^{-3}$ m$^2$/s。所有值都采用一致的国际单位制单位。\n首先，我们计算 arccos 函数的无量纲自变量：\n$$\n1 - \\frac{2\\kappa_t}{U\\Delta} = 1 - \\frac{2 \\times (5.0 \\times 10^{-3})}{(1.0) \\times (1.0 \\times 10^{-2})} = 1 - \\frac{1.0 \\times 10^{-2}}{1.0 \\times 10^{-2}} = 1 - 1 = 0\n$$\n现在，我们求 $\\theta_{\\star}$：\n$$\n\\theta_{\\star} = \\arccos(0)\n$$\n在所需的区间 $(0, \\pi)$ 内，$\\arccos(0)$ 的主值为 $\\pi/2$。\n$$\n\\theta_{\\star} = \\frac{\\pi}{2} \\ \\mathrm{radians}\n$$\n为了提供一个四舍五入到四位有效数字的数值答案：\n$$\n\\theta_{\\star} \\approx 1.570796... \\ \\mathrm{radians}\n$$\n四舍五入到四位有效数字得到 $1.571$。\n\n**4. 关于混叠的讨论**\n\n奈奎斯特无量纲波数，对应于间距为 $\\Delta$ 的网格上可分辨的最高波数，是 $\\theta_{Nyquist} = k_{Nyquist} \\Delta = (\\pi/\\Delta)\\Delta = \\pi$。\n\n问题考虑了一个二次SGS贡献，它从一个波数为 $k$ 的输入模态生成一个波数为 $2k$ 的模态。这代表了模态的自相互作用，是湍流中将能量转移到更小尺度（更高波数）的一个基本过程。对于我们计算出的波数 $\\theta_{\\star} = \\pi/2$，生成的模态的无量纲波数为 $2\\theta_{\\star} = 2(\\pi/2) = \\pi$。\n\n这个结果，$2\\theta_{\\star} = \\pi$，意味着由在 $\\theta_{\\star}$ 处的模态自相互作用生成的模态恰好**位于**奈奎斯特无量纲波数上。\n\n这对比较两种对流格式时混叠的潜在严重性具有重要启示：\n-   **四阶中心对流：** 这种格式是非耗散的（$\\mathrm{Re}[\\hat{\\mathcal{L}}_{adv, c4}(\\theta)] = 0$）。在没有任何数值耗散的情况下，由非线性相互作用传递到高波数的能量不会被数值格式移除。当能量被传递到奈奎斯特波数 $\\pi$ 时，它无法传播到更高、未解析的波数。相反，它会在已解析谱的末端累积，这种现象称为谱阻塞。如果能量被传递到超过 $\\pi$ 的波数，它将被混叠（被错误地表示）为一个较低波数的模态，从而污染解。在 $\\theta = \\pi$ 处的堆积是一种严重的数值伪影，可能导致不稳定性。控制这种情况的唯一机制是显式的SGS耗散，但这本身可能不足，特别是在解析不足的模拟中。\n\n-   **二阶迎风对流：** 这种格式是耗散的。其数值耗散率 $\\frac{U}{\\Delta}(1-\\cos\\theta)^2$ 在 $(0, \\pi)$ 区间内随 $\\theta$ 增加而增加，并在最高波数处最强。在 $\\theta_{\\star} = \\pi/2$ 处，其耗散率已经与显式SGS模型的耗散率相匹配。对于 $\\theta > \\theta_{\\star}$，数值耗散甚至变得比SGS耗散更大。这种内在的阻尼机制从高波数模态中移除能量，包括那些在奈奎斯特频率及其附近的模态。因此，它有效地防止了中心格式中出现的严重能量堆积，并通过耗散掉那些否则会发生混叠的能量，减轻了混叠的污染效应。其代价是由于这种数值阻尼，已解析模态的精度降低，但它提供了稳定性。\n\n总而言之，$2\\theta_\\star$ 位于奈奎斯特极限这一事实，凸显了非耗散中心格式的一个关键弱点（对混叠引发的不稳定性的敏感性）和耗散迎风格式的一个关键特性（增强稳定性的隐式阻尼）。", "answer": "$$\\boxed{1.571}$$", "id": "2500593"}, {"introduction": "一次成功的大涡模拟不仅依赖于稳定和精确的数值方法，还需要一个经过良好校准的亚格子尺度 (SGS) 模型。这最后一项练习模拟了一个常见的真实世界建模挑战：校准湍流普朗特数 ($Pr_t$)，以确保我们 LES 中的 SGS 模型能够正确预测在高保真直接数值模拟 (DNS) 数据中观察到的标量通量 [@problem_id:2500563]。这个问题强调了模型参数、网格分辨率 ($\\Delta$) 和模拟整体保真度之间的关键相互作用。", "problem": "考虑一个统计定常、充分发展的湍流槽道流，其中输运着一个被动标量$\\,\\theta\\,$。给定一个由直接数值模拟 (DNS) 得到的目标平面平均法向标量通量剖面，记为$\\,\\langle \\widetilde{w \\theta} \\rangle_{\\mathrm{DNS}}(z)\\,$。我们希望在一个固定的法向位置$\\,z_0\\,$，为大涡模拟 (LES) 标定一个有效的湍流普朗特数$\\,Pr_t\\,$，使得模拟的平均法向标量通量在$\\,z_0\\,$处与 DNS 的值相匹配。\n\n在$\\,z_0\\,$处采用以下模拟假设：\n\n- 在给定的滤波宽度$\\,\\Delta\\,$下，平面平均的法向输运由亚格子尺度 (SGS) 的贡献主导，因此在$\\,z_0\\,$处的平均法向标量通量模拟为$\\,\\langle \\widetilde{w \\theta} \\rangle \\approx \\langle q^{\\mathrm{sgs}}_z \\rangle\\,$。\n- SGS 标量通量遵循梯度-扩散封闭，其涡扩散率为$\\,\\nu_t/Pr_t\\,$，即$\\,q^{\\mathrm{sgs}}_z = - \\left(\\nu_t/Pr_t\\right) \\,\\partial_z \\widetilde{\\theta}\\,$。\n- 涡粘性由 Smagorinsky 模型给出：$\\,\\nu_t = \\left(C_s \\Delta\\right)^2 \\,|S|\\,$，其中$\\,C_s\\,$是 Smagorinsky 常数，$\\,|S|\\,$是$\\,z_0\\,$处的可解应变率大小。\n- 在$\\,z_0\\,$处，可解平均标量梯度随滤波宽度$\\,\\Delta\\,$的变化遵循一个二阶相容性关系\n$$\n\\partial_z \\widetilde{\\theta}(\\Delta) \\equiv G(\\Delta) = G_{\\infty} \\left[ 1 - \\alpha \\left(\\frac{\\Delta}{\\ell}\\right)^{m} \\right],\n$$\n其中$\\,m=2\\,$，$\\,G_{\\infty}\\,$是渐近（精细滤波）梯度，$\\,\\alpha\\,$是一个正常数，$\\,\\ell\\,$是一个特征局部外区长度尺度。\n\n在法向位置$\\,z_0\\,$，以下量是已知的：\n- $\\,C_s = 0.16\\,$，\n- $\\,|S| = 50\\,\\mathrm{s}^{-1}\\,$，\n- $\\,G_{\\infty} = 120\\,\\mathrm{K}\\cdot \\mathrm{m}^{-1}\\,$，\n- $\\,\\alpha = \\frac{25}{6}\\,$，\n- $\\,m = 2\\,$，\n- $\\,\\ell = 0.10\\,\\mathrm{m}\\,$，\n- $\\,\\langle \\widetilde{w \\theta} \\rangle_{\\mathrm{DNS}}(z_0) = -0.050\\,\\mathrm{K}\\cdot \\mathrm{m}\\cdot \\mathrm{s}^{-1}\\,$。\n\n1. 从滤波后的标量输运方程和上述封闭模型出发，推导在$\\,z_0\\,$处有效湍流普朗特数$\\,Pr_t(\\Delta)\\,$的表达式，该表达式能精确匹配$\\,z_0\\,$处的 DNS 通量，并用$\\,\\Delta\\,$和给定常数表示。\n\n2. 将标定湍流普朗特数相对于滤波宽度的弹性定义为\n$$\nE(\\Delta) \\equiv \\frac{\\Delta}{Pr_t(\\Delta)} \\,\\frac{\\mathrm{d} Pr_t(\\Delta)}{\\mathrm{d} \\Delta}.\n$$\n使用所提供的数据，计算当$\\,\\Delta = 0.020\\,\\mathrm{m}\\,$时$\\,E(\\Delta)\\,$的值。\n\n将$\\,E(0.020\\,\\mathrm{m})\\,$的数值作为最终答案，表示为一个无量纲数，并四舍五入到四位有效数字。", "solution": "该问题要求推导有效湍流普朗特数$Pr_t(\\Delta)$的表达式，并随后计算其在特定点对滤波宽度$\\Delta$的弹性。\n\n首先，我们建立湍流普朗特数$Pr_t$的关系式。基本条件是在位置$z_0$处，模拟的平面平均法向标量通量$\\langle \\widetilde{w \\theta} \\rangle_{\\mathrm{LES}}(z_0)$必须与给定的直接数值模拟 (DNS) 目标值$\\langle \\widetilde{w \\theta} \\rangle_{\\mathrm{DNS}}(z_0)$相匹配。我们将 DNS 目标通量记为 $F_{\\mathrm{DNS}}$。\n\n根据模拟假设，模拟通量由其亚格子尺度 (SGS) 贡献近似，该贡献通过梯度-扩散模型封闭：\n$$ \\langle \\widetilde{w \\theta} \\rangle_{\\mathrm{LES}} \\approx \\langle q^{\\mathrm{sgs}}_z \\rangle = - \\frac{\\nu_t}{Pr_t} \\partial_z \\widetilde{\\theta} $$\n右侧的量均在$z_0$处取值。涡粘性$\\nu_t$由 Smagorinsky 模型给出：\n$$ \\nu_t = (C_s \\Delta)^2 |S| $$\n可解平均标量梯度$\\partial_z \\widetilde{\\theta}$作为滤波宽度$\\Delta$的函数给出：\n$$ \\partial_z \\widetilde{\\theta}(\\Delta) = G(\\Delta) = G_{\\infty} \\left[ 1 - \\alpha \\left(\\frac{\\Delta}{\\ell}\\right)^{m} \\right] $$\n结合这些表达式，我们将模拟通量写为：\n$$ \\langle \\widetilde{w \\theta} \\rangle_{\\mathrm{LES}} = - \\frac{(C_s \\Delta)^2 |S|}{Pr_t(\\Delta)} G_{\\infty} \\left[ 1 - \\alpha \\left(\\frac{\\Delta}{\\ell}\\right)^{m} \\right] $$\n将此式设为等于 DNS 目标通量$F_{\\mathrm{DNS}} = \\langle \\widetilde{w \\theta} \\rangle_{\\mathrm{DNS}}(z_0)$，我们得到：\n$$ F_{\\mathrm{DNS}} = - \\frac{(C_s \\Delta)^2 |S| G_{\\infty}}{Pr_t(\\Delta)} \\left[ 1 - \\alpha \\left(\\frac{\\Delta}{\\ell}\\right)^{m} \\right] $$\n求解$Pr_t(\\Delta)$，我们得到所需的表达式：\n$$ Pr_t(\\Delta) = - \\frac{(C_s \\Delta)^2 |S| G_{\\infty}}{F_{\\mathrm{DNS}}} \\left[ 1 - \\alpha \\left(\\frac{\\Delta}{\\ell}\\right)^{m} \\right] $$\n这就完成了问题的第一部分。\n\n接下来，我们必须计算$Pr_t$相对于$\\Delta$的弹性，其定义为：\n$$ E(\\Delta) \\equiv \\frac{\\Delta}{Pr_t(\\Delta)} \\frac{\\mathrm{d} Pr_t(\\Delta)}{\\mathrm{d} \\Delta} $$\n这在数学上等价于对数导数$\\frac{\\mathrm{d}(\\ln Pr_t)}{\\mathrm{d}(\\ln \\Delta)}$。为了简化微分，我们对$Pr_t(\\Delta)$的表达式取自然对数。我们可以将不依赖于$\\Delta$的项归为一个常数$K = - \\frac{C_s^2 |S| G_{\\infty}}{F_{\\mathrm{DNS}}}$。\n$$ Pr_t(\\Delta) = K \\Delta^2 \\left[ 1 - \\alpha \\left(\\frac{\\Delta}{\\ell}\\right)^{m} \\right] $$\n取对数：\n$$ \\ln(Pr_t(\\Delta)) = \\ln(K) + \\ln(\\Delta^2) + \\ln\\left[1 - \\alpha \\left(\\frac{\\Delta}{\\ell}\\right)^{m}\\right] $$\n$$ \\ln(Pr_t(\\Delta)) = \\ln(K) + 2\\ln(\\Delta) + \\ln\\left[1 - \\frac{\\alpha}{\\ell^m}\\Delta^m\\right] $$\n对$\\Delta$求导，得到：\n$$ \\frac{1}{Pr_t(\\Delta)} \\frac{\\mathrm{d}Pr_t}{\\mathrm{d}\\Delta} = \\frac{2}{\\Delta} + \\frac{1}{1 - \\frac{\\alpha}{\\ell^m}\\Delta^m} \\left( -\\frac{\\alpha m}{\\ell^m}\\Delta^{m-1} \\right) $$\n为了求得弹性$E(\\Delta)$，我们将整个表达式乘以$\\Delta$：\n$$ E(\\Delta) = \\Delta \\left( \\frac{2}{\\Delta} - \\frac{\\alpha m \\Delta^{m-1} / \\ell^m}{1 - \\alpha (\\Delta/\\ell)^m} \\right) = 2 - \\frac{\\alpha m (\\Delta/\\ell)^m}{1 - \\alpha (\\Delta/\\ell)^m} $$\n问题指明$m=2$。弹性的表达式变为：\n$$ E(\\Delta) = 2 - \\frac{2 \\alpha (\\Delta/\\ell)^2}{1 - \\alpha (\\Delta/\\ell)^2} $$\n我们需要计算其在$\\Delta = 0.020\\,\\mathrm{m}$处的值。给定$\\ell = 0.10\\,\\mathrm{m}$和$\\alpha = \\frac{25}{6}$。我们首先计算无量纲群$X \\equiv \\alpha (\\Delta/\\ell)^2$：\n$$ X = \\frac{25}{6} \\left(\\frac{0.020\\,\\mathrm{m}}{0.10\\,\\mathrm{m}}\\right)^2 = \\frac{25}{6} (0.2)^2 = \\frac{25}{6} (0.04) = \\frac{1}{6} $$\n现在我们将$X = 1/6$这个值代入$E(\\Delta)$的表达式中：\n$$ E = 2 - \\frac{2X}{1-X} = 2 - \\frac{2(1/6)}{1 - 1/6} = 2 - \\frac{1/3}{5/6} $$\n$$ E = 2 - \\left(\\frac{1}{3} \\cdot \\frac{6}{5}\\right) = 2 - \\frac{2}{5} = 2 - 0.4 = 1.6 $$\n问题要求最终答案四舍五入到四位有效数字。因此，该值为$1.600$。", "answer": "$$\\boxed{1.600}$$", "id": "2500563"}]}