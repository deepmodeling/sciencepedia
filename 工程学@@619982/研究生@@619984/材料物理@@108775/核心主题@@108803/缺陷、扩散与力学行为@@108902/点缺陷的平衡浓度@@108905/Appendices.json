{"hands_on_practices": [{"introduction": "在材料科学中，掺杂是调控材料电学、光学和离子导电性能的核心策略。本练习将引导您完成一项基础但至关重要的计算：如何通过引入外来杂质（掺杂剂）来控制本征点缺陷的浓度。通过运用质量作用定律和电荷中性原理，您将推导出在氧化铝（$Al_2O_3$）掺杂的氧化镁（$MgO$）中氧空位的平衡浓度，这对于理解掺杂半导体和离子导体中的缺陷化学至关重要 [@problem_id:1977042]。", "problem": "氧化镁 (MgO) 是一种陶瓷材料，其在高温下的主要本征点缺陷是肖特基对。在MgO中，一个肖特基对由一个镁空位和一个氧空位组成。使用克勒格尔-文克标记法，这些缺陷分别表示为 $V_{Mg}^{''}$ 和 $V_{O}^{\\bullet\\bullet}$。这些缺陷对的形成是一个热激活过程，由平衡反应控制：$\\text{null} \\rightleftharpoons V_{Mg}^{''} + V_{O}^{\\bullet\\bullet}$，其中 `null` 代表完美晶格。在给定温度 $T$ 下，相应的质量作用平衡常数用 $K_S$ 表示。\n\n为了改变其电学性质，MgO晶体被掺杂了特定浓度的氧化铝 (Al2O3)。已知铝离子 ($Al^{3+}$) 会在阳离子亚晶格上取代镁离子 ($Mg^{2+}$) ，形成 $Al_{Mg}^{\\bullet}$ 缺陷。设这些替代铝缺陷的总浓度为 $C_{Al}$。\n\n假设系统处于热力学平衡状态，并且与离子缺陷浓度相比，电子缺陷（电子和空穴）的浓度可以忽略不计。所有缺陷浓度均以无量纲的摩尔分数表示。\n\n确定掺杂MgO晶体中氧空位的平衡浓度 $[V_{O}^{\\bullet\\bullet}]$。请用 $K_S$ 和 $C_{Al}$ 的公式表示你的答案。", "solution": "设 $[V_{O}^{\\bullet\\bullet}] \\equiv c_{O}$，$[V_{Mg}^{''}] \\equiv c_{Mg}$，以及 $[Al_{Mg}^{\\bullet}] \\equiv C_{Al}$。肖特基形成反应为\n$$\\text{null} \\rightleftharpoons V_{Mg}^{''} + V_{O}^{\\bullet\\bullet},$$\n其质量作用平衡常数为\n$$K_{S} = [V_{Mg}^{''}][V_{O}^{\\bullet\\bullet}] = c_{Mg} c_{O}.$$\n\n电中性要求有效电荷的总和为零。这些缺陷的电荷为：$V_{Mg}^{''}$ 带 $-2$ 电荷，$V_{O}^{\\bullet\\bullet}$ 带 $+2$ 电荷，$Al_{Mg}^{\\bullet}$ 带 $+1$ 电荷。因此，\n$$-2 c_{Mg} + 2 c_{O} + C_{Al} = 0 \\quad \\Rightarrow \\quad c_{Mg} = c_{O} + \\frac{C_{Al}}{2}.$$\n\n代入质量作用关系式得到\n$$K_{S} = \\left(c_{O} + \\frac{C_{Al}}{2}\\right) c_{O} = c_{O}^{2} + \\frac{C_{Al}}{2} c_{O}.$$\n重新整理得，\n$$c_{O}^{2} + \\frac{C_{Al}}{2} c_{O} - K_{S} = 0.$$\n\n解这个关于 $c_{O}$ 的一元二次方程，并取物理上有意义的（非负）根，\n$$c_{O} = \\frac{-\\frac{C_{Al}}{2} + \\sqrt{\\left(\\frac{C_{Al}}{2}\\right)^{2} + 4 K_{S}}}{2} = \\frac{-C_{Al} + \\sqrt{C_{Al}^{2} + 16 K_{S}}}{4}.$$\n\n因此，氧空位的平衡浓度为\n$$[V_{O}^{\\bullet\\bullet}] = \\frac{-C_{Al} + \\sqrt{C_{Al}^{2} + 16 K_{S}}}{4}.$$", "answer": "$$\\boxed{\\frac{-C_{Al}+\\sqrt{C_{Al}^{2}+16K_{S}}}{4}}$$", "id": "1977042"}, {"introduction": "点缺陷的形成是一个热力学过程，其平衡浓度不仅受温度影响，也对外部施加的机械应力（如压力）敏感。本练习旨在拓宽您对缺陷热力学的理解，将压力的影响纳入考量 [@problem_id:1324770]。通过分析静水压力如何通过缺陷形成体积（$\\Delta V_d$）项来改变吉布斯自由能，您将推导出压力对肖特基（Schottky）缺陷和弗伦克尔（Frenkel）缺陷浓度的不同影响，这一原理在高压材料合成、地球物理学以及应力工程领域具有重要意义。", "problem": "在晶体固体中，本征点缺陷的存在是一个热力学驱动的现象。这些缺陷的平衡浓度由其形成吉布斯自由能决定。考虑离子晶体中两种常见的缺陷类型：肖特基缺陷，由一对阳离子和阴离子空位组成；以及弗伦克尔缺陷，由一个空位和一个间隙离子组成。\n\n我们希望比较这些缺陷在外部静水压力下的行为。考虑两个维持在恒定绝对温度 $T$ 下的不同模型系统：\n1. 氯化钠 (NaCl)，其中肖特基缺陷占主导地位。一个肖特基缺陷对的形成导致晶体净体积变化量为 $\\Delta V_S$，这是一个正值。\n2. 氯化银 (AgCl)，其中阳离子亚晶格中的弗伦克尔缺陷占主导地位。一个弗伦克尔缺陷（一个银离子空位和一个银间隙离子）的形成导致晶体净体积变化量为 $\\Delta V_F$，这是一个负值。\n\n由于施加的静水压力 $P$，缺陷形成的吉布斯自由能的变化 $\\Delta G_d$ 由 $\\Delta G_d(P) = \\Delta G_d(0) + P\\Delta V_d$ 给出，其中 $\\Delta G_d(0)$ 是零压力下的形成能，$\\Delta V_d$ 是每个缺陷的体积变化。\n\n设 $n_S(P)$ 和 $n_F(P)$ 分别是在压力 $P$ 下 NaCl 中肖特基缺陷和 AgCl 中弗伦克尔缺陷的平衡浓度。设 $n_S(0)$ 和 $n_F(0)$ 分别是它们在零压力下的浓度。\n\n推导比率 $R = \\frac{n_S(P)/n_S(0)}{n_F(P)/n_F(0)}$ 的闭合形式解析表达式，用施加的压力 $P$、温度 $T$、激活体积 $\\Delta V_S$ 和 $\\Delta V_F$ 以及玻尔兹曼常数 $k_B$ 来表示。", "solution": "在热平衡状态下，压力 $P$ 和温度 $T$ 下某种缺陷 $d$ 的浓度与其形成吉布斯自由能的玻尔兹曼因子成正比：\n$$\nn_{d}(P) \\propto \\exp\\left(-\\frac{\\Delta G_{d}(P)}{k_B T}\\right).\n$$\n形成吉布斯自由能对压力的依赖关系由下式给出\n$$\n\\Delta G_{d}(P) = \\Delta G_{d}(0) + P \\Delta V_{d},\n$$\n其中 $\\Delta V_{d}$ 是每个缺陷的体积变化。因此，对于同一种缺陷 $d$，在压力 $P$ 和零压力下的浓度比为\n$$\n\\frac{n_{d}(P)}{n_{d}(0)} = \\exp\\left(-\\frac{\\Delta G_{d}(P) - \\Delta G_{d}(0)}{k_B T}\\right) = \\exp\\left(-\\frac{P \\Delta V_{d}}{k_B T}\\right).\n$$\n将此公式应用于 NaCl 中的肖特基缺陷和 AgCl 中的弗伦克尔缺陷，得到\n$$\n\\frac{n_{S}(P)}{n_{S}(0)} = \\exp\\left(-\\frac{P \\Delta V_{S}}{k_B T}\\right), \\quad \\frac{n_{F}(P)}{n_{F}(0)} = \\exp\\left(-\\frac{P \\Delta V_{F}}{k_B T}\\right).\n$$\n因此所求的比率为\n$$\nR = \\frac{n_{S}(P)/n_{S}(0)}{n_{F}(P)/n_{F}(0)} = \\exp\\left(-\\frac{P}{k_B T}\\left(\\Delta V_{S} - \\Delta V_{F}\\right)\\right).\n$$\n因为 $\\Delta V_{S} > 0$ 且 $\\Delta V_{F}  0$，所以当 $P>0$ 时指数为负，这意味着压力会抑制肖特基缺陷并促进弗伦克尔缺陷，这与物理预期相符。", "answer": "$$\\boxed{\\exp\\left(-\\frac{P}{k_B T}\\left(\\Delta V_{S}-\\Delta V_{F}\\right)\\right)}$$", "id": "1324770"}, {"introduction": "本综合性练习模拟了当代材料物理研究中的一个核心计算任务，将点缺陷化学与半导体物理紧密结合。您将构建一个自洽模型，用以确定晶体中所有带电物质——包括电子、空穴以及处于不同价态的多种缺陷——的平衡浓度 [@problem_id:2820008]。这个问题的关键在于理解费米能级（$E_{\\mathrm{F}}$）作为化学势，控制着整个系统的电荷平衡，而其自身的位置则由电荷中性条件决定。通过将物理模型转化为数值求解算法，您将亲身体验解决复杂、多方面相互作用的缺陷平衡问题的强大方法。", "problem": "给定一个晶体固体中带电点缺陷的平衡浓度模型，其中电子库由费米能级 $E_{\\mathrm{F}}$ 表征，该能级是相对于价带顶 $E_{\\mathrm{V}}=0$ 测量的。导带底位于 $E_{\\mathrm{C}}=E_{\\mathrm{g}}$。假设系统是稀疏且非简并的，温度为 $T$。目标是通过强制实现电中性来确定平衡费米能级以及由此产生的移动载流子和缺陷的浓度。\n\n基本原理和建模假设：\n- 每种缺陷在晶格中都有大量的等效位置，其数量为 $N_{\\mathrm{sites}}$ (单位为 $\\mathrm{cm^{-3}}$)。在稀疏极限下，缺陷之间的构型相互作用可以忽略不计，每种可区分的电荷态 $q$ 的缺陷都独立地对平衡做出贡献，其简并因子 $g_q$ 用于说明微观态的多重性。电荷态 $q$ 的平衡热平均浓度 $c_q$ 由其形成自由能 $E_{\\mathrm{f}}(q;E_{\\mathrm{F}})$ 通过玻尔兹曼因子控制。\n- 导带中的电子和价带中的空穴布居是非简并的，可以用有效态密度来描述。载流子布居响应于温度 $T$ 下的费米能级 $E_{\\mathrm{F}}$。\n- 平衡时保持电中性：总正电荷密度等于总负电荷密度。正电荷来自带正电的缺陷和空穴；负电荷来自带负电的缺陷和电子。\n\n根据这些原理，推导计算以下各项所需的表达式：\n1. 在给定的 $E_{\\mathrm{F}}$ 和 $T$ 下，某种缺陷电荷态 $q$ 的平衡浓度 $c_q$，已知其在 $E_{\\mathrm{F}}=0$ 时的形成自由能截距、电荷 $q$ 和简并度 $g_q$。\n2. 电子密度 $n$ 和空穴密度 $p$ 作为 $E_{\\mathrm{F}}$、带隙 $E_{\\mathrm{g}}$ 以及有效态密度 $N_{\\mathrm{C}}$ 和 $N_{\\mathrm{V}}$ 的函数。\n3. 在区间 $[0,E_{\\mathrm{g}}]$ 上，以 $E_{\\mathrm{F}}$ 为变量的电中性条件标量方程。\n\n然后，实现一个稳健的数值方法，找出电中性方程在 $E_{\\mathrm{F}} \\in [0,E_{\\mathrm{g}}]$ 内的唯一解，并计算两种缺陷的总浓度：\n- 一种类施主缺陷 $\\mathrm{D}$，其电荷态为 $q \\in \\{0,+1,+2\\}$，\n- 一种类受主缺陷 $\\mathrm{A}$，其电荷态为 $q \\in \\{0,-1,-2\\}$。\n\n对于下方的每个测试用例，使用提供的参数。使用以下常数和约定：\n- 使用玻尔兹曼常数 $k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K}$。\n- 所有能量单位必须是 $\\mathrm{eV}$。\n- 所有载流子和缺陷浓度单位必须是 $\\mathrm{cm^{-3}}$。\n- 费米能级 $E_{\\mathrm{F}}$ 被限制在 $[0,E_{\\mathrm{g}}]$ 区间内。\n\n测试套件（三个用例），每个用例由 $(T, E_{\\mathrm{g}}, N_{\\mathrm{C}}, N_{\\mathrm{V}}, \\mathrm{D}, \\mathrm{A})$ 指定：\n- 用例 1：\n  - $T = 1200\\,\\mathrm{K}$，\n  - $E_{\\mathrm{g}} = 3.2\\,\\mathrm{eV}$，\n  - $N_{\\mathrm{C}} = 5.0\\times 10^{19}\\,\\mathrm{cm^{-3}}$，\n  - $N_{\\mathrm{V}} = 1.0\\times 10^{20}\\,\\mathrm{cm^{-3}}$，\n  - $\\mathrm{D}$：$N_{\\mathrm{sites}} = 1.0\\times 10^{22}\\,\\mathrm{cm^{-3}}$，电荷态由 $(q,E_{\\mathrm{f}}^{0}(q),g_q)$ 给出：\n    - $(0, 2.8\\,\\mathrm{eV}, 1)$，\n    - $(+1, 2.0\\,\\mathrm{eV}, 2)$，\n    - $(+2, 3.0\\,\\mathrm{eV}, 1)$，\n  - $\\mathrm{A}$：$N_{\\mathrm{sites}} = 1.0\\times 10^{22}\\,\\mathrm{cm^{-3}}$，电荷态：\n    - $(0, 2.7\\,\\mathrm{eV}, 1)$，\n    - $(-1, 2.2\\,\\mathrm{eV}, 1)$，\n    - $(-2, 4.0\\,\\mathrm{eV}, 1)$。\n- 用例 2：\n  - $T = 800\\,\\mathrm{K}$，\n  - $E_{\\mathrm{g}} = 1.1\\,\\mathrm{eV}$，\n  - $N_{\\mathrm{C}} = 3.0\\times 10^{19}\\,\\mathrm{cm^{-3}}$，\n  - $N_{\\mathrm{V}} = 2.0\\times 10^{19}\\,\\mathrm{cm^{-3}}$，\n  - $\\mathrm{D}$：$N_{\\mathrm{sites}} = 1.0\\times 10^{22}\\,\\mathrm{cm^{-3}}$，电荷态：\n    - $(0, 3.0\\,\\mathrm{eV}, 1)$，\n    - $(+1, 3.0\\,\\mathrm{eV}, 2)$，\n    - $(+2, 4.5\\,\\mathrm{eV}, 1)$，\n  - $\\mathrm{A}$：$N_{\\mathrm{sites}} = 1.0\\times 10^{22}\\,\\mathrm{cm^{-3}}$，电荷态：\n    - $(0, 2.0\\,\\mathrm{eV}, 1)$，\n    - $(-1, 1.5\\,\\mathrm{eV}, 1)$，\n    - $(-2, 3.5\\,\\mathrm{eV}, 1)$。\n- 用例 3：\n  - $T = 1000\\,\\mathrm{K}$，\n  - $E_{\\mathrm{g}} = 6.0\\,\\mathrm{eV}$，\n  - $N_{\\mathrm{C}} = 3.0\\times 10^{19}\\,\\mathrm{cm^{-3}}$，\n  - $N_{\\mathrm{V}} = 3.0\\times 10^{19}\\,\\mathrm{cm^{-3}}$，\n  - $\\mathrm{D}$：$N_{\\mathrm{sites}} = 1.0\\times 10^{22}\\,\\mathrm{cm^{-3}}$，电荷态：\n    - $(0, 1.8\\,\\mathrm{eV}, 1)$，\n    - $(+1, 1.2\\,\\mathrm{eV}, 2)$，\n    - $(+2, 1.6\\,\\mathrm{eV}, 1)$，\n  - $\\mathrm{A}$：$N_{\\mathrm{sites}} = 1.0\\times 10^{22}\\,\\mathrm{cm^{-3}}$，电荷态：\n    - $(0, 3.0\\,\\mathrm{eV}, 1)$，\n    - $(-1, 3.2\\,\\mathrm{eV}, 1)$，\n    - $(-2, 5.0\\,\\mathrm{eV}, 1)$。\n\n任务：\n- 对每个用例，求解电中性条件以获得 $E_{\\mathrm{F}}$。\n- 计算与该 $E_{\\mathrm{F}}$ 对应的电子密度 $n$ 和空穴密度 $p$。\n- 计算缺陷 $\\mathrm{D}$ 和 $\\mathrm{A}$ 的总浓度，分别为 $c_{\\mathrm{D}} = \\sum_{q\\in\\{0,+1,+2\\}} c_q$ 和 $c_{\\mathrm{A}} = \\sum_{q\\in\\{0,-1,-2\\}} c_q$。\n\n要求的数值输出和格式：\n- 单位：报告 $E_{\\mathrm{F}}$ 的单位为 $\\mathrm{eV}$，$n$、$p$、$c_{\\mathrm{D}}$、$c_{\\mathrm{A}}$ 的单位为 $\\mathrm{cm^{-3}}$。不要打印单位符号；单位是隐含的。\n- 四舍五入：将报告的每个数字四舍五入到 $6$ 位有效数字。\n- 输出格式：你的程序应生成单行输出，包含一个由三个列表组成的列表，每个内部列表对应一个测试用例，按 $[E_{\\mathrm{F}}, n, p, c_{\\mathrm{D}}, c_{\\mathrm{A}}]$ 的顺序排列。外部和内部列表必须用逗号分隔并用方括号括起来。例如，打印的行应如下所示：\n  $[ [x_{1},y_{1},z_{1},u_{1},v_{1}], [x_{2},y_{2},z_{2},u_{2},v_{2}], [x_{3},y_{3},z_{3},u_{3},v_{3}] ]$,\n  其中每个符号表示一个四舍五入到 $6$ 位有效数字的浮点数。", "solution": "该问题陈述已经过严格验证，被认为是科学上合理、论证充分且完整的。它提出了一个材料物理学中关于自洽计算平衡缺陷和载流子浓度的标准的、典型的问题。所提供的参数和假设在物理上是合理的，在数学上是一致的。因此，我们着手求解。\n\n分析基于统计力学原理应用于处于热平衡状态的晶体固体。该系统由一个可能存在点缺陷的晶格和一个由费米-狄拉克分布描述的电子库组成，在非简并极限下，该分布简化为玻尔兹曼分布。平衡状态通过最小化系统总自由能来确定，这等效于满足电中性条件。\n\n首先，我们推导必要的表达式。所有能量均以电子伏特（$\\mathrm{eV}$）表示，费米能级 $E_{\\mathrm{F}}$ 从价带顶开始测量，即 $E_{\\mathrm{V}} = 0$。导带底位于 $E_{\\mathrm{C}} = E_{\\mathrm{g}}$。\n\n1.  **缺陷电荷态的浓度 ($c_q$)**\n    处于电荷态 $q$ 的缺陷的形成自由能是费米能级 $E_{\\mathrm{F}}$ 的线性函数：\n    $$E_{\\mathrm{f}}(q; E_{\\mathrm{F}}) = E_{\\mathrm{f}}^{0}(q) + q E_{\\mathrm{F}}$$\n    其中 $E_{\\mathrm{f}}^{0}(q)$ 是在 $E_{\\mathrm{F}} = 0$ 时的形成能。在稀疏近似下，缺陷浓度远小于可用晶格位置密度 $N_{\\mathrm{sites}}$，平衡浓度 $c_q$ 遵循玻尔兹曼统计：\n    $$c_q(E_{\\mathrm{F}}) = N_{\\mathrm{sites}} g_q \\exp\\left(-\\frac{E_{\\mathrm{f}}(q; E_{\\mathrm{F}})}{k_{\\mathrm{B}}T}\\right)$$\n    代入形成能的表达式，我们得到给定缺陷种类的单个电荷态 $q$ 的浓度，作为 $E_{\\mathrm{F}}$ 和温度 $T$ 的函数：\n    $$c_q(E_{\\mathrm{F}}) = N_{\\mathrm{sites}} g_q \\exp\\left(-\\frac{E_{\\mathrm{f}}^{0}(q) + q E_{\\mathrm{F}}}{k_{\\mathrm{B}}T}\\right)$$\n    这里，$g_q$ 是该电荷态的简并因子，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n2.  **电子和空穴浓度 ($n, p$)**\n    在载流子非简并统计的假设下，导带中的电子浓度 ($n$) 和价带中的空穴浓度 ($p$) 由以下公式给出：\n    $$n(E_{\\mathrm{F}}) = N_{\\mathrm{C}} \\exp\\left(-\\frac{E_{\\mathrm{C}} - E_{\\mathrm{F}}}{k_{\\mathrm{B}}T}\\right)$$\n    $$p(E_{\\mathrm{F}}) = N_{\\mathrm{V}} \\exp\\left(-\\frac{E_{\\mathrm{F}} - E_{\\mathrm{V}}}{k_{\\mathrm{B}}T}\\right)$$\n    其中 $N_{\\mathrm{C}}$ 和 $N_{\\mathrm{V}}$ 分别是导带和价带中的有效态密度。使用已建立的能量参考（$E_{\\mathrm{V}} = 0$, $E_{\\mathrm{C}} = E_{\\mathrm{g}}$），这些公式变为：\n    $$n(E_{\\mathrm{F}}) = N_{\\mathrm{C}} \\exp\\left(-\\frac{E_{\\mathrm{g}} - E_{\\mathrm{F}}}{k_{\\mathrm{B}}T}\\right)$$\n    $$p(E_{\\mathrm{F}}) = N_{\\mathrm{V}} \\exp\\left(-\\frac{E_{\\mathrm{F}}}{k_{\\mathrm{B}}T}\\right)$$\n\n3.  **电中性条件**\n    这个平衡问题的基石是强制实现宏观电中性。总正电荷密度必须等于总负电荷密度。正电荷是空穴和带正电的缺陷。负电荷是电子和带负电的缺陷。\n    $$\\sum_{\\text{正电荷}} \\text{密度} = \\sum_{\\text{负电荷}} \\text{密度}$$\n    我们定义一个净电荷密度函数 $\\rho(E_{\\mathrm{F}})$，其根对应于平衡费米能级。\n    $$\\rho(E_{\\mathrm{F}}) = p(E_{\\mathrm{F}}) - n(E_{\\mathrm{F}}) + \\sum_{i \\in \\{\\mathrm{D}, \\mathrm{A}\\}} \\sum_q q \\cdot c_q^i(E_{\\mathrm{F}}) = 0$$\n    项 $q \\cdot c_q^i$ 正确地说明了每种缺陷态对净电荷密度的贡献。对于指定的施主（$\\mathrm{D}$）和受主（$\\mathrm{A}$）缺陷，方程为：\n    $$\\rho(E_{\\mathrm{F}}) = p(E_{\\mathrm{F}}) - n(E_{\\mathrm{F}}) + \\left[ (1)c_{+1}^{\\mathrm{D}}(E_{\\mathrm{F}}) + (2)c_{+2}^{\\mathrm{D}}(E_{\\mathrm{F}}) \\right] + \\left[ (-1)c_{-1}^{\\mathrm{A}}(E_{\\mathrm{F}}) + (-2)c_{-2}^{\\mathrm{A}}(E_{\\mathrm{F}}) \\right] = 0$$\n    此方程中的每一项都依赖于 $E_{\\mathrm{F}}$。函数 $\\rho(E_{\\mathrm{F}})$ 在区间 $E_{\\mathrm{F}} \\in [0, E_{\\mathrm{g}}]$ 上是严格单调的（具体来说，是递减函数），因为每种正电荷物质的浓度随 $E_{\\mathrm{F}}$ 增加而减少，而每种负电荷物质的浓度随 $E_{\\mathrm{F}}$ 增加而增加。这保证了在带隙内 $E_{\\mathrm{F}}$ 有唯一解，前提是发生符号变化，这是物理上现实系统的特征。\n\n**数值求解策略**\n\n问题简化为在有界区间 $[0, E_{\\mathrm{g}}]$ 上找到标量、单调函数 $\\rho(E_{\\mathrm{F}}) = 0$ 的根。对于此任务，一个稳健的区间求根算法是合适的。我们将采用 Brent 方法，正如 `scipy.optimize.brentq` 库函数所实现的，它结合了二分法的可靠性与割线法和逆二次插值法的速度。\n\n对每个测试用例，执行以下步骤：\n1.  使用该用例的特定参数（$T$, $E_{\\mathrm{g}}$, $N_{\\mathrm{C}}$, $N_{\\mathrm{V}}$, 和缺陷属性）定义电中性函数 $\\rho(E_{\\mathrm{F}})$。\n2.  通过在区间 $[0, E_{\\mathrm{g}}]$ 中找到 $\\rho(E_{\\mathrm{F}}) = 0$ 的根来数值求解平衡费米能级 $E_{\\mathrm{F}}^{*}$。\n3.  使用获得的 $E_{\\mathrm{F}}^{*}$，计算最终量：\n    -   电子浓度 $n = n(E_{\\mathrm{F}}^{*})$。\n    -   空穴浓度 $p = p(E_{\\mathrm{F}}^{*})$。\n    -   总施主浓度 $c_{\\mathrm{D}} = \\sum_{q \\in \\{0, +1, +2\\}} c_q^{\\mathrm{D}}(E_{\\mathrm{F}}^{*})$。\n    -   总受主浓度 $c_{\\mathrm{A}} = \\sum_{q \\in \\{0, -1, -2\\}} c_q^{\\mathrm{A}}(E_{\\mathrm{F}}^{*})$。\n4.  结果被格式化为 $6$ 位有效数字，并以指定的嵌套列表结构呈现。\n实现将使用提供的玻尔兹曼常数值 $k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K}$。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for equilibrium Fermi level and defect/carrier concentrations\n    in a crystalline solid for a given set of test cases.\n    \"\"\"\n    KB = 8.617333262145e-5  # Boltzmann constant in eV/K\n\n    test_cases = [\n        # Case 1\n        {\n            \"T\": 1200, \"Eg\": 3.2, \"NC\": 5.0e19, \"NV\": 1.0e20,\n            \"D\": {\"Nsites\": 1.0e22, \"states\": [(0, 2.8, 1), (+1, 2.0, 2), (+2, 3.0, 1)]},\n            \"A\": {\"Nsites\": 1.0e22, \"states\": [(0, 2.7, 1), (-1, 2.2, 1), (-2, 4.0, 1)]}\n        },\n        # Case 2\n        {\n            \"T\": 800, \"Eg\": 1.1, \"NC\": 3.0e19, \"NV\": 2.0e19,\n            \"D\": {\"Nsites\": 1.0e22, \"states\": [(0, 3.0, 1), (+1, 3.0, 2), (+2, 4.5, 1)]},\n            \"A\": {\"Nsites\": 1.0e22, \"states\": [(0, 2.0, 1), (-1, 1.5, 1), (-2, 3.5, 1)]}\n        },\n        # Case 3\n        {\n            \"T\": 1000, \"Eg\": 6.0, \"NC\": 3.0e19, \"NV\": 3.0e19,\n            \"D\": {\"Nsites\": 1.0e22, \"states\": [(0, 1.8, 1), (+1, 1.2, 2), (+2, 1.6, 1)]},\n            \"A\": {\"Nsites\": 1.0e22, \"states\": [(0, 3.0, 1), (-1, 3.2, 1), (-2, 5.0, 1)]}\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        T = case[\"T\"]\n        Eg = case[\"Eg\"]\n        NC = case[\"NC\"]\n        NV = case[\"NV\"]\n        defect_D_props = case[\"D\"]\n        defect_A_props = case[\"A\"]\n        \n        kBT = KB * T\n\n        def calculate_concentrations(EF, defects):\n            \"\"\"Calculates concentrations for a defect species at a given EF.\"\"\"\n            concs = {}\n            for q, E0, g in defects[\"states\"]:\n                # Formation energy: E_f = E0 + q*EF\n                # Concentration: c = N_sites * g * exp(-E_f / kBT)\n                exponent = -(E0 + q * EF) / kBT\n                concs[q] = defects[\"Nsites\"] * g * np.exp(exponent)\n            return concs\n\n        def net_charge_density(EF):\n            \"\"\"\n            Calculates the total net charge density in the system\n            as a function of the Fermi level EF. The root of this function\n            is the equilibrium Fermi level.\n            rho(EF) = p - n + sum(q * c_q)\n            \"\"\"\n            # Carrier concentrations\n            n = NC * np.exp(-(Eg - EF) / kBT)\n            p = NV * np.exp(-EF / kBT)\n            \n            # Defect concentrations and their charge contribution\n            donor_concs = calculate_concentrations(EF, defect_D_props)\n            acceptor_concs = calculate_concentrations(EF, defect_A_props)\n            \n            defect_charge = 0.0\n            for q, c in donor_concs.items():\n                defect_charge += q * c\n            for q, c in acceptor_concs.items():\n                defect_charge += q * c\n                \n            return p - n + defect_charge\n\n        # Find the root of the net charge density function to get equilibrium EF\n        # The search interval is the band gap [0, Eg].\n        try:\n            EF_eq = brentq(net_charge_density, 0, Eg, xtol=1e-12, rtol=1e-12)\n        except ValueError:\n            # This would happen if net_charge_density(0) and net_charge_density(Eg)\n            # have the same sign, indicating no root in the interval.\n            # For this well-posed problem, this should not occur.\n            EF_eq = np.nan # Or handle error appropriately\n\n        # Calculate final quantities at equilibrium EF\n        n_eq = NC * np.exp(-(Eg - EF_eq) / kBT)\n        p_eq = NV * np.exp(-EF_eq / kBT)\n\n        donor_concs_eq = calculate_concentrations(EF_eq, defect_D_props)\n        cD_total = sum(donor_concs_eq.values())\n\n        acceptor_concs_eq = calculate_concentrations(EF_eq, defect_A_props)\n        cA_total = sum(acceptor_concs_eq.values())\n\n        # Store results for this case\n        case_results = [EF_eq, n_eq, p_eq, cD_total, cA_total]\n        all_results.append(case_results)\n\n    # Format output to 6 significant figures and print in the required format\n    output_parts = []\n    for inner_list in all_results:\n        formatted_list = [f\"{val:.6g}\" for val in inner_list]\n        output_parts.append(f\"[{','.join(formatted_list)}]\")\n    \n    final_output = f\"[{','.join(output_parts)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2820008"}]}