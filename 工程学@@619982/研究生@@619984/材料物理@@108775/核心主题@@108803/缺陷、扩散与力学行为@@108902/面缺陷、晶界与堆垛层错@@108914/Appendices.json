{"hands_on_practices": [{"introduction": "在晶体中，位错并非总是以一个整体的形式存在，它们常常会分解成更稳定的分位错，其间夹着一片平面缺陷——层错。本练习将引导你深入这一现象的核心，通过平衡分位错之间的弹性排斥力和层错的能量代价，定量地推导出层错带的平衡宽度。这是一个将经典的位错弹性理论与材料内禀的层错能联系起来的关键实践。[@problem_id:2511183]", "problem": "一个面心立方晶体中初始为纯螺型的全位错在 $\\{111\\}$ 晶面上分解为两个 Shockley 分位错，并界定出一个内禀堆垛层错。假设材料为各向同性线弹性体，位错线为无限长的平行直线，且单位面积的堆垛层错能为一常数 $\\gamma_{\\mathrm{SF}}$。全位错的伯格斯矢量大小为 $b$，类型为 $\\frac{a}{2}\\langle 110\\rangle$，每个 Shockley 分位错的类型为 $\\frac{a}{6}\\langle 112\\rangle$。剪切模量为 $G$，泊松比为 $\\nu$。\n\n从直位错之间弹性相互作用的基本原理以及堆垛层错能作为与层错面积成正比的能量惩罚的定义出发，推导在这种纯螺型情况下，两个 Shockley 分位错之间的平衡分离距离 $d$ 的表达式，然后使用以下材料参数对其进行数值计算：\n- $G = 48\\ \\mathrm{GPa}$，\n- $\\nu = 0.34$，\n- $b = 0.2556\\ \\mathrm{nm}$，\n- $\\gamma_{\\mathrm{SF}} = 0.045\\ \\mathrm{J/m^2}$。\n\n报告最终分离距离 $d$（单位为 $\\mathrm{nm}$），并将答案四舍五入至三位有效数字。", "solution": "该问题要求推导面心立方（FCC）晶体中一个全螺位错分解产生的两个 Shockley 分位錯之间的平衡分离距离 $d$，然后进行数值计算。\n\n首先，我们必须验证问题陈述的有效性。\n已知条件如下：\n- FCC 晶体中的一个纯螺型全位錯。\n- 分解发生在 {$111$} 晶面上。\n- 产物是两个 Shockley 分位錯和一个内禀堆垛层错。\n- 假设：各向同性线弹性；直的、无限长的平行位错线。\n- 单位面积的堆垛层錯能：$\\gamma_{\\mathrm{SF}}$（常数）。\n- 全位错的伯格斯矢量类型：$\\frac{a}{2}\\langle 110\\rangle$，大小为 $b$。\n- Shockley 分位错的伯格斯矢量类型：$\\frac{a}{6}\\langle 112\\rangle$。\n- 材料参数：剪切模量 $G$，泊松比 $\\nu$。\n- 数值：$G = 48\\ \\mathrm{GPa}$，$\\nu = 0.34$，$b = 0.2556\\ \\mathrm{nm}$，$\\gamma_{\\mathrm{SF}} = 0.045\\ \\mathrm{J/m^2}$。\n\n该问题具有科学依据、提法明确且客观。所描述的现象是晶体材料位错理论的基石。对于 FCC 晶格在 (111) 滑移面上的分解反应，例如 $\\frac{a}{2}[1\\bar{1}0] \\rightarrow \\frac{a}{6}[2\\bar{1}\\bar{1}] + \\frac{a}{6}[1\\bar{2}1]$ 是正确的。初始位错是纯螺型，意味着其位错线方向 $\\vec{\\xi}$ 平行于其伯格斯矢量 $\\vec{b}_{\\text{total}}$。产生的 Shockley 分位错是混合型的，具体为 $30^{\\circ}$ 位错，因为它们的伯格斯矢量与位错线方向之间的夹角为 $30^{\\circ}$。使用各向同性弹性理论是一个标准且有效的近似。所有必要的参数都已提供，可得到唯一解。该问题是有效的。\n\n当作用在分位错上的单位长度的两个力达到平衡时，就建立了平衡分离距离 $d$：一个是弹性排斥力 $F_{\\text{repulsive}}/L$，另一个是来自堆垛层错的吸引力 $F_{\\text{attractive}}/L$。\n\n堆垛层错产生一个与其面积成正比的能量惩罚。对于长度为 $L$、宽度为 $d$ 的一段，其能量为 $E_{\\mathrm{SF}} = \\gamma_{\\mathrm{SF}} d L$。单位长度的吸引力是该能量对分离距离的负导数：\n$$ \\frac{F_{\\text{attractive}}}{L} = -\\frac{1}{L} \\frac{\\partial E_{\\mathrm{SF}}}{\\partial d} = -\\gamma_{\\mathrm{SF}} $$\n因此，这个恒定的单位长度吸引力的大小为 $\\gamma_{\\mathrm{SF}}$。\n\n必须计算两个平行直分位错之间的排斥力。问题指定了一个全螺位错的分解。设总伯格斯矢量为 $\\vec{b}_{\\text{total}}$，其大小为 $b$。位错线方向 $\\vec{\\xi}$ 平行于 $\\vec{b}_{\\text{total}}$。分解产生两个分位错，其伯格斯矢量分别为 $\\vec{b}_{1}$ 和 $\\vec{b}_2$。\n全位错伯格斯矢量的大小 $b=|\\frac{a}{2}\\langle 110 \\rangle| = \\frac{a\\sqrt{2}}{2}$ 与分位错伯格斯矢量的大小 $b_p=|\\frac{a}{6}\\langle 112 \\rangle| = \\frac{a\\sqrt{6}}{6}$ 之间的关系是 $b_p = b/\\sqrt{3}$。\n\n在滑移面内，两个相距为 $d$ 的平行位错之间的单位长度作用力由下式给出：\n$$ \\frac{F_{\\text{repulsive}}}{L} = \\frac{G}{2\\pi d} \\left( b_{s1}b_{s2} + \\frac{\\vec{b}_{e1} \\cdot \\vec{b}_{e2}}{1-\\nu} \\right) $$\n其中 $b_{si}$ 是第 $i$ 个分位错伯格斯矢量的螺型分量，$\\vec{b}_{ei}$ 是其刃型分量矢量。\n对于纯螺位错的分解，两个分位错的螺型分量是平行的，它们的和等于总伯格斯矢量，因此 $\\vec{b}_{s1}+\\vec{b}_{s2}=\\vec{b}_{\\text{total}}$。刃型分量相互抵消，因此 $\\vec{b}_{e1}+\\vec{b}_{e2}=0$，这意味着 $\\vec{b}_{e2} = -\\vec{b}_{e1}$。两个分位错的性质相同，所以 $b_{s1}=b_{s2}=b_s$ 并且 $|\\vec{b}_{e1}|=|\\vec{b}_{e2}|=b_e$。\n因此，$2b_s = b$，得出 $b_s=b/2$。\n分位錯的伯格斯矢量与位错线方向之间的夹角 $\\theta$ 是 $30^{\\circ}$。因此，刃型分量的大小为 $b_e = b_p \\sin(30^{\\circ}) = (\\frac{b}{\\sqrt{3}})(\\frac{1}{2}) = \\frac{b}{2\\sqrt{3}}$。\n将这些分量代入力方程中：\n$$ \\frac{F_{\\text{repulsive}}}{L} = \\frac{G}{2\\pi d} \\left( \\left(\\frac{b}{2}\\right)\\left(\\frac{b}{2}\\right) + \\frac{-b_e^2}{1-\\nu} \\right) = \\frac{G}{2\\pi d} \\left( \\frac{b^2}{4} - \\frac{1}{1-\\nu}\\left(\\frac{b}{2\\sqrt{3}}\\right)^2 \\right) $$\n$$ \\frac{F_{\\text{repulsive}}}{L} = \\frac{G b^2}{2\\pi d} \\left( \\frac{1}{4} - \\frac{1}{12(1-\\nu)} \\right) = \\frac{G b^2}{2\\pi d} \\left( \\frac{3(1-\\nu) - 1}{12(1-\\nu)} \\right) $$\n$$ \\frac{F_{\\text{repulsive}}}{L} = \\frac{G b^2 (2-3\\nu)}{24\\pi d (1-\\nu)} $$\n在平衡状态下，该排斥力与来自堆垛层错的吸引力相平衡：\n$$ \\frac{G b^2 (2-3\\nu)}{24\\pi d (1-\\nu)} = \\gamma_{\\mathrm{SF}} $$\n解出平衡分离距离 $d$：\n$$ d = \\frac{G b^2 (2-3\\nu)}{24\\pi \\gamma_{\\mathrm{SF}} (1-\\nu)} $$\n这就是所要求的解析表达式。\n\n现在，我们使用给定的参数对此表达式进行数值计算，确保所有单位均为国际单位制（SI）。\n- $G = 48\\ \\mathrm{GPa} = 48 \\times 10^9\\ \\mathrm{N/m^2}$\n- $b = 0.2556\\ \\mathrm{nm} = 0.2556 \\times 10^{-9}\\ \\mathrm{m}$\n- $\\nu = 0.34$\n- $\\gamma_{\\mathrm{SF}} = 0.045\\ \\mathrm{J/m^2} = 0.045\\ \\mathrm{N/m}$\n\n首先计算无量纲项：\n$2-3\\nu = 2 - 3(0.34) = 2 - 1.02 = 0.98$\n$1-\\nu = 1 - 0.34 = 0.66$\n\n将数值代入 $d$ 的表达式中：\n$$ d = \\frac{(48 \\times 10^9\\ \\mathrm{N/m^2}) (0.2556 \\times 10^{-9}\\ \\mathrm{m})^2 (0.98)}{24\\pi (0.045\\ \\mathrm{N/m}) (0.66)} $$\n$$ d = \\frac{48 \\times 10^9 \\times (0.2556)^2 \\times 10^{-18} \\times 0.98}{24 \\pi \\times 0.045 \\times 0.66}\\ \\mathrm{m} $$\n$$ d = \\frac{48 \\times 0.06533136 \\times 0.98}{24 \\pi \\times 0.045 \\times 0.66} \\times 10^{-9}\\ \\mathrm{m} $$\n$$ d = \\frac{3.070806}{2.235683} \\times 10^{-9}\\ \\mathrm{m} $$\n$$ d \\approx 1.37354 \\times 10^{-9}\\ \\mathrm{m} $$\n转换为纳米：\n$$ d \\approx 1.37354\\ \\mathrm{nm} $$\n问题要求答案四舍五入到三位有效数字。\n$$ d \\approx 1.37\\ \\mathrm{nm} $$", "answer": "$$\n\\boxed{1.37}\n$$", "id": "2511183"}, {"introduction": "晶界不仅仅是晶粒间的被动界面，它们还能通过吸收晶格位错来主动参与塑性变形。本练习将挑战你将一个外来晶格位错分解为特定孪晶界的基本结构单元——晶界位错。通过这个过程，你将掌握伯氏矢量在界面处守恒的核心原则，并深刻理解晶界本身所具有的有序结构。[@problem_id:184972]", "problem": "在一个晶格常数为 $a$ 的面心立方（FCC）金属中，考虑一个位于(111)晶面上的对称$\\Sigma 3$共格孪晶界。一个源于某个晶粒、Burgers矢量为 $\\vec{b}_L = \\frac{a}{2}[101]$ 的全位错被此晶界吸收。\n\n吸收过程涉及该晶格位错分解为一组晶界位错。这些所产生位错的Burgers矢量 $\\vec{b}_{GB,i}$ 必须是对应于$\\Sigma 3$晶界的位移全匹配（DSC）点阵的基矢。此过程必须满足总Burgers矢量守恒，即 $\\vec{b}_L = \\sum_i \\vec{b}_{GB,i}$。\n\n对于$\\Sigma 3$ {111}孪晶界，DSC点阵基矢有两种类型：\n1. Burgers矢量类型为 $\\frac{a}{6}\\langle 11\\bar{2} \\rangle$ 的滑移位错，其位于(111)晶界平面内。\n2. 对应于晶界台阶的固着位错，其Burgers矢量类型为 $\\frac{a}{3}\\langle 111 \\rangle$，垂直于晶界平面。\n\n晶格位错会分解为满足Burgers矢量守恒的最少数量的DSC基矢位错。\n\n计算由此吸收事件产生的晶界基矢位错的Burgers矢量模长总和 $\\sum_i |\\vec{b}_{GB,i}|$。", "solution": "该问题要求将晶格位错Burgers矢量 $\\vec{b}_L = \\frac{a}{2}[101]$ 分解为$\\Sigma 3$ {111}孪晶界的最少数量的DSC基矢位错。DSC点阵有两种类型的基矢：\n- 滑移位错：$\\frac{a}{6}\\langle 11\\bar{2} \\rangle$（面内）\n- 固着位错：$\\frac{a}{3}\\langle 111 \\rangle$（垂直于平面）\n\n**步骤1：将$\\vec{b}_L$分解为相对于(111)平面的法向和切向分量。**  \n(111)平面的法线方向是$[111]$。$\\vec{b}_L$在$[111]$方向上的投影为：  \n$$\n\\vec{b}_n = \\left( \\frac{\\vec{b}_L \\cdot [111]}{[111] \\cdot [111]} \\right) [111] = \\left( \\frac{\\frac{a}{2}(1 + 0 + 1)}{3} \\right) [111] = \\frac{a}{3}[111].\n$$\n切向（面内）分量为：  \n$$\n\\vec{b}_t = \\vec{b}_L - \\vec{b}_n = \\frac{a}{2}[101] - \\frac{a}{3}[111] = \\frac{a}{6}[1\\bar{2}1].\n$$\n\n**步骤2：验证$\\vec{b}_t$和$\\vec{b}_n$是否对应于DSC基矢。**  \n- $\\vec{b}_t = \\frac{a}{6}[1\\bar{2}1]$ 与滑移类型 $\\frac{a}{6}\\langle 11\\bar{2} \\rangle$ 相匹配（因为$[1\\bar{2}1]$是$\\langle 11\\bar{2} \\rangle$族中的一个）。\n- $\\vec{b}_n = \\frac{a}{3}[111]$ 与固着类型 $\\frac{a}{3}\\langle 111 \\rangle$ 相匹配。\n\n**步骤3：确认Burgers矢量守恒。**  \n$$\n\\vec{b}_L = \\vec{b}_t + \\vec{b}_n = \\frac{a}{6}[1\\bar{2}1] + \\frac{a}{3}[111] = \\frac{a}{2}[101],\n$$\n这满足守恒。\n\n**步骤4：计算DSC位错的模长。**  \n- 滑移位错的模长：  \n$$\n|\\vec{b}_{GB,1}| = \\left| \\frac{a}{6}[1\\bar{2}1] \\right| = \\frac{a}{6} \\sqrt{1^2 + (-2)^2 + 1^2} = \\frac{a}{6} \\sqrt{6} = \\frac{a}{\\sqrt{6}}.\n$$\n- 固着位错的模长：  \n$$\n|\\vec{b}_{GB,2}| = \\left| \\frac{a}{3}[111] \\right| = \\frac{a}{3} \\sqrt{1^2 + 1^2 + 1^2} = \\frac{a}{3} \\sqrt{3} = \\frac{a}{\\sqrt{3}}.\n$$\n\n**步骤5：将模长相加。**  \n$$\n\\sum_i |\\vec{b}_{GB,i}| = \\frac{a}{\\sqrt{6}} + \\frac{a}{\\sqrt{3}} = a \\left( \\frac{1}{\\sqrt{6}} + \\frac{1}{\\sqrt{3}} \\right) = a \\left( \\frac{\\sqrt{6}}{6} + \\frac{2\\sqrt{3}}{6} \\right) = \\frac{a(\\sqrt{6} + 2\\sqrt{3})}{6}.\n$$\n该分解使用了最少数量的位错（1个滑移位错 + 1个固着位错），因为由于法向和切向分量均不为零，所以更少数量的位错无法满足守恒。", "answer": "$$\\boxed{\\dfrac{a(\\sqrt{6} + 2\\sqrt{3})}{6}}$$", "id": "184972"}, {"introduction": "晶界能是决定晶界行为和稳定性的最基本属性，它直接影响着材料的宏观性能。本项高级计算实践将指导你完成一个从第一性原理计算数据中提取晶界能的现代工作流程。这个练习为你搭建了一座桥梁，连接了晶界能量的理论概念与计算材料科学中数据驱动的研究现实。[@problem_id:2851507]", "problem": "要求你通过代码实现一个有原则且可测试的工作流，用于为给定的重合位置点阵 (CSL) 和晶面从第一性原理计算晶界能。该工作流必须基于以下基本原理：单位面积的界面过剩自由能，是通过比较包含界面的双晶能量与相同数量原子在体材料中的能量得到的，并且在低温下，内能近似于自由能。在周期性电子结构方法中，总能量的布里渊区积分误差会随着 $k$ 点采样的增加而衰减，而简单的代数模型足以捕捉其收敛行为并支持外推计算。你必须实现以下算法组件：\n\n- 几何与晶胞构建抽象：假设已经为指定的 CSL 和晶界平面构建了一个双晶超胞，每个周期性晶胞中包含 $n_\\text{GB}$ 个相同的平面界面，界面面积为 $A$，总原子数为 $N$。\n- $k$ 点收敛性外推：给定在多个 $k$ 点网格尺寸（由有效数量 $K$ 概括，例如不可约 $k$ 点的总数）下计算出的总能量 $E_\\text{cell}(K)$，拟合一个形式为 $E_\\text{cell}(K)=E_\\infty + c K^{-p}$ 的代数衰减模型，其中 $E_\\infty$、$c$ 和 $p$ 为未知参数，并从中提取收敛后的总能量 $E_\\infty$。\n- 单位面积的界面过剩能：结合收敛的双晶能量、体材料中每个原子的能量 $E_\\text{bulk}$、原子数 $N$、界面数 $n_\\text{GB}$ 和面积 $A$，计算单位面积的界面过剩能（以焦耳/平方米为单位）。使用精确的物理常数 $1\\,\\mathrm{eV}=1.602176634\\times 10^{-19}\\,\\mathrm{J}$ 和 $1\\,\\mathrm{\\AA}^2=10^{-20}\\,\\mathrm{m}^2$。所有中间计算必须量纲一致。\n- 与经验势的比较：对于每种情况，将基于第一性原理计算得到的值与一个给定的经验势预测值（例如，来自嵌入原子方法 (EAM) 模型）进行比较，并报告绝对偏差和有符号分数偏差。后者是差值与经验势值的有符号比率，表示为一个纯数（而非百分比）。\n\n你的程序必须将此工作流应用于以下测试套件。每个测试用例都提供了 $N$、$A$、$n_\\text{GB}$、$E_\\text{bulk}$ 和一组配对数据 $\\{(K, E_\\text{cell}(K))\\}$，以及一个经验比较值。所有能量单位为电子伏特，所有面积单位为平方埃。\n\n- 测试用例 1 (通用理想路径):\n  - 原子数 $N=200$。\n  - 界面面积 $A=100\\,\\mathrm{\\AA}^2$。\n  - 界面数 $n_\\text{GB}=2$。\n  - 体材料单原子能量 $E_\\text{bulk}=-3.5\\,\\mathrm{eV}$。\n  - $k$ 点数和总能量 $\\{(K, E_\\text{cell}(K))\\}$: $[(100,\\,-688.3),\\,(200,\\,-688.8),\\,(400,\\,-689.05),\\,(800,\\,-689.175)]$。\n  - 经验势比较值 $\\gamma_\\text{emp}=0.80\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$。\n- 测试用例 2 (小面积和较慢的 $k$ 点收敛):\n  - 原子数 $N=48$。\n  - 界面面积 $A=40\\,\\mathrm{\\AA}^2$。\n  - 界面数 $n_\\text{GB}=2$。\n  - 体材料单原子能量 $E_\\text{bulk}=-4.0\\,\\mathrm{eV}$。\n  - $k$ 点数和总能量 $\\{(K, E_\\text{cell}(K))\\}$: $[(50,\\,-190.3),\\,(100,\\,-190.5),\\,(200,\\,-190.6),\\,(400,\\,-190.65)]$。\n  - 经验势比较值 $\\gamma_\\text{emp}=0.30\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$。\n- 测试用例 3 (边界情况：每个周期性晶胞只有一个晶界):\n  - 原子数 $N=150$。\n  - 界面面积 $A=120\\,\\mathrm{\\AA}^2$。\n  - 界面数 $n_\\text{GB}=1$。\n  - 体材料单原子能量 $E_\\text{bulk}=-3.2\\,\\mathrm{eV}$。\n  - $k$ 点数和总能量 $\\{(K, E_\\text{cell}(K))\\}$: $[(80,\\,-470.55),\\,(160,\\,-470.8),\\,(320,\\,-470.925),\\,(640,\\,-470.9875)]$。\n  - 经验势比较值 $\\gamma_\\text{emp}=1.10\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$。\n- 测试用例 4 (大面积、多 $k$ 点、更高能量的晶界):\n  - 原子数 $N=220$。\n  - 界面面积 $A=150\\,\\mathrm{\\AA}^2$。\n  - 界面数 $n_\\text{GB}=2$。\n  - 体材料单原子能量 $E_\\text{bulk}=-3.7\\,\\mathrm{eV}$。\n  - $k$ 点数和总能量 $\\{(K, E_\\text{cell}(K))\\}$: $[(90,\\,-784.9),\\,(180,\\,-785.4),\\,(360,\\,-785.65),\\,(720,\\,-785.775),\\,(1440,\\,-785.8375)]$。\n  - 经验势比较值 $\\gamma_\\text{emp}=1.20\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$。\n\n此测试套件中不涉及角度测量。所有涉及物理单位的输出必须以 $\\mathrm{J}\\,\\mathrm{m}^{-2}$ 表示。你的程序必须：\n\n- 对于每个测试用例，拟合模型 $E_\\text{cell}(K)=E_\\infty + c K^{-p}$ 以确定 $E_\\infty$；计算基于第一性原理的单位面积界面能；计算与经验值的绝对偏差；并计算定义为 $(\\gamma_\\text{FP}-\\gamma_\\text{emp})/\\gamma_\\text{emp}$ 的有符号分数偏差，其中 $\\gamma_\\text{FP}$ 是基于第一性原理计算的结果。\n- 将所有报告的浮点数四舍五入到恰好 $6$ 位小数。\n\n最终输出格式：你的程序应生成单行输出，其中包含一个按测试用例顺序排列的、由逗号分隔的列表的列表。其中每个内部列表都精确包含三个浮点数，顺序为 $[\\gamma_\\text{FP},\\ \\lvert \\gamma_\\text{FP}-\\gamma_\\text{emp} \\rvert,\\ (\\gamma_\\text{FP}-\\gamma_\\text{emp})/\\gamma_\\text{emp}]$。例如，打印的字符串必须类似于 $[[x_{11},x_{12},x_{13}],[x_{21},x_{22},x_{23}],\\dots]$，不含多余的空格或文本。", "solution": "所提出的问题是计算材料物理领域一个有效且定义明确的练习。它要求实现一个标准工作流，通过一系列第一性原理总能量计算来确定晶界能。该问题具有科学依据，提供了清晰的物理模型、真实的数据以及用于数据分析的合理数学流程。它是客观且自洽的，提供了所有必需的参数和常数。\n\n基本任务是计算单位面积的界面过剩自由能，记为 $\\gamma$。在低温下，这可以很好地通过过剩内能来近似。其控制方程为：\n$$\n\\gamma = \\frac{E_{\\text{cell}}^{\\text{total}} - E_{\\text{bulk}}^{\\text{total}}}{n_{\\text{GB}} A}\n$$\n此处，$E_{\\text{cell}}^{\\text{total}}$ 是包含晶界的计算超胞的总能量，$E_{\\text{bulk}}^{\\text{total}}$ 是等量原子在完美体相晶体中的能量，$n_{\\text{GB}}$ 是周期性超胞内相同界面的数量，$A$ 是单个界面的面积。给定体材料中每个原子的能量 $E_{\\text{bulk}}$ 和超胞中的总原子数 $N$，则总体材料能量为 $E_{\\text{bulk}}^{\\text{total}} = N E_{\\text{bulk}}$。因此，$\\gamma$ 的公式变为：\n$$\n\\gamma = \\frac{E_{\\text{cell}}^{\\text{total}} - N E_{\\text{bulk}}}{n_{\\text{GB}} A}\n$$\n对 $E_{\\text{cell}}^{\\text{total}}$ 的第一性原理计算是使用平面波基组和周期性边界条件进行的，这需要在布里渊区上进行积分。该积分通过在所谓的 $k$ 点离散网格上求和来进行数值近似。总能量的准确性取决于此 $k$ 点网格的密度。问题指定，超胞能量 $E_{\\text{cell}}$ 相对于有效 $k$ 点数 $K$ 的收敛行为，由以下代数衰减函数建模：\n$$\nE_{\\text{cell}}(K) = E_{\\infty} + c K^{-p}\n$$\n此处，$E_{\\infty}$ 代表外推得到的超胞完全收敛的总能量，对应于无限密的 $k$ 点网格 ($K \\to \\infty$)。参数 $c$ 和 $p$ 表征了收敛速率。我们的首要任务是通过将此非线性模型拟合到每个测试用例所提供的 $(K, E_{\\text{cell}}(K))$ 数据集，来确定 $E_{\\infty}$ 的值。这是一个标准的非线性最小二乘回归问题，可以通过数值方法求解。从此拟合中得到的参数 $E_{\\infty}$ 将作为我们晶界能计算中的 $E_{\\text{cell}}^{\\text{total}}$。\n\n每个测试用例的步骤如下：\n\n1.  **外推收敛能量**：给定一组数据点 $\\{(K_i, E_i)\\}$，我们拟合函数 $E(K) = E_{\\infty} + c K^{-p}$ 以找到最优参数 $(E_{\\infty}, c, p)$。参数 $E_{\\infty}$ 就是我们期望的收敛超胞能量。为此，我们利用一个数值优化程序，具体是 `scipy.optimize.curve_fit` 中实现的 Levenberg-Marquardt 算法。\n\n2.  **以自然单位计算界面能**：使用外推能量 $E_{\\infty}$，我们计算晶界能，记为 $\\gamma_{\\text{FP}}$（代表第一性原理），其自然单位为电子伏特/平方埃 ($\\mathrm{eV}\\,\\mathrm{\\AA}^{-2}$):\n    $$\n    \\gamma_{\\text{FP}} [\\mathrm{eV}\\,\\mathrm{\\AA}^{-2}] = \\frac{E_{\\infty} - N E_{\\text{bulk}}}{n_{\\text{GB}} A}\n    $$\n    所有输入量（$E_{\\infty}$、$E_{\\text{bulk}}$、$N$、$n_{\\text{GB}}$、$A$）都以兼容的单位提供。\n\n3.  **转换为国际单位制 (SI) 单位**：问题要求最终能量以焦耳/平方米 ($\\mathrm{J}\\,\\mathrm{m}^{-2}$) 表示。我们应用给定的转换因子：\n    $$\n    1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}\n    $$\n    $$\n    1\\,\\mathrm{\\AA}^2 = 10^{-20}\\,\\mathrm{m}^2\n    $$\n    因此，从 $\\mathrm{eV}\\,\\mathrm{\\AA}^{-2}$ 到 $\\mathrm{J}\\,\\mathrm{m}^{-2}$ 的转换因子是：\n    $$\n    \\frac{1.602176634 \\times 10^{-19}\\,\\mathrm{J}/\\mathrm{eV}}{10^{-20}\\,\\mathrm{m}^2/\\mathrm{\\AA}^2} = 16.02176634 \\, \\frac{\\mathrm{J}\\,\\mathrm{m}^{-2}}{\\mathrm{eV}\\,\\mathrm{\\AA}^{-2}}\n    $$\n\n4.  **进行比较分析**：我们计算两个指标，以将我们计算出的 $\\gamma_{\\text{FP}}$ 与提供的经验值 $\\gamma_{\\text{emp}}$ 进行比较：\n    -   绝对偏差: $\\Delta\\gamma_{\\text{abs}} = |\\gamma_{\\text{FP}} - \\gamma_{\\text{emp}}|$。\n    -   有符号分数偏差: $\\Delta\\gamma_{\\text{frac}} = (\\gamma_{\\text{FP}} - \\gamma_{\\text{emp}}) / \\gamma_{\\text{emp}}$。\n\n对每个测试用例都系统地应用这一系列步骤。所有最终的浮点数结果都按要求四舍五入到六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Computes grain boundary energies from first-principles data for a suite of test cases.\n    The workflow involves:\n    1. Extrapolating the converged total cell energy by fitting a decay model.\n    2. Calculating the excess interfacial energy using the extrapolated value.\n    3. Converting units from eV/Å^2 to J/m^2.\n    4. Comparing the result with an empirical value.\n    \"\"\"\n\n    # Physical constants for unit conversion\n    EV_TO_J = 1.602176634e-19\n    AA2_TO_M2 = 1e-20\n    CONVERSION_FACTOR = EV_TO_J / AA2_TO_M2\n\n    test_cases = [\n        # Test case 1\n        {\n            \"N\": 200, \"A\": 100, \"n_GB\": 2, \"E_bulk\": -3.5,\n            \"k_data\": np.array([100, 200, 400, 800]),\n            \"E_cell_data\": np.array([-688.3, -688.8, -689.05, -689.175]),\n            \"gamma_emp\": 0.80\n        },\n        # Test case 2\n        {\n            \"N\": 48, \"A\": 40, \"n_GB\": 2, \"E_bulk\": -4.0,\n            \"k_data\": np.array([50, 100, 200, 400]),\n            \"E_cell_data\": np.array([-190.3, -190.5, -190.6, -190.65]),\n            \"gamma_emp\": 0.30\n        },\n        # Test case 3\n        {\n            \"N\": 150, \"A\": 120, \"n_GB\": 1, \"E_bulk\": -3.2,\n            \"k_data\": np.array([80, 160, 320, 640]),\n            \"E_cell_data\": np.array([-470.55, -470.8, -470.925, -470.9875]),\n            \"gamma_emp\": 1.10\n        },\n        # Test case 4\n        {\n            \"N\": 220, \"A\": 150, \"n_GB\": 2, \"E_bulk\": -3.7,\n            \"k_data\": np.array([90, 180, 360, 720, 1440]),\n            \"E_cell_data\": np.array([-784.9, -785.4, -785.65, -785.775, -785.8375]),\n            \"gamma_emp\": 1.20\n        }\n    ]\n\n    # Model for k-point convergence: E_cell(K) = E_inf + c * K^(-p)\n    def convergence_model(k_points, e_inf, c, p):\n        return e_inf + c * k_points**(-p)\n\n    all_results = []\n\n    for case in test_cases:\n        k_data = case[\"k_data\"]\n        energy_data = case[\"E_cell_data\"]\n        N = case[\"N\"]\n        A = case[\"A\"]\n        n_GB = case[\"n_GB\"]\n        E_bulk = case[\"E_bulk\"]\n        gamma_emp = case[\"gamma_emp\"]\n\n        # 1. Extrapolate Converged Energy (E_inf)\n        # Provide reasonable initial guesses for the fit parameters.\n        # E_inf guess: energy at highest K. c/p guesses: generic starting points.\n        initial_guesses = [energy_data[-1], 1.0, 1.0]\n        params, _ = curve_fit(convergence_model, k_data, energy_data, p0=initial_guesses)\n        e_inf = params[0]\n\n        # 2. Calculate Interfacial Energy in eV/Å^2\n        excess_energy = e_inf - N * E_bulk\n        total_area = n_GB * A\n        gamma_fp_eV_per_A2 = excess_energy / total_area\n\n        # 3. Convert to SI units (J/m^2)\n        gamma_fp = gamma_fp_eV_per_A2 * CONVERSION_FACTOR\n\n        # 4. Perform Comparative Analysis\n        abs_dev = abs(gamma_fp - gamma_emp)\n        frac_dev = (gamma_fp - gamma_emp) / gamma_emp\n        \n        # Collect and round results\n        case_results = [\n            round(gamma_fp, 6),\n            round(abs_dev, 6),\n            round(frac_dev, 6)\n        ]\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists is the desired format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2851507"}]}