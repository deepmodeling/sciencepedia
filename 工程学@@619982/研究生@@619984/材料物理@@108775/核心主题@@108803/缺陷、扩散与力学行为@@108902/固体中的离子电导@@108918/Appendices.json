{"hands_on_practices": [{"introduction": "固态离子导体中的导电性源于晶格中的点缺陷，例如离子空位。本练习将带你回到第一性原理，通过一个经典的替位掺杂钙钛矿氧化物的思想实验，练习如何利用电中性原理来定量推导缺陷浓度。掌握这种通过化学掺杂来调控材料载流子浓度的方法，是设计和优化固态电解质材料的一项基础而核心的技能 [@problem_id:2831042]。", "problem": "考虑一种化学计量比为 $ABO_3$ 的钙钛矿氧化物，其中 B 位阳离子的电荷数为 $z_{B}$，氧阴离子的电荷数为 $z_{O} = -2$。该材料掺杂了受主阳离子 $M$，它专门取代 B 亚晶格上的离子，其电荷数为 $z_{M} < z_{B}$。设 B 亚晶格上的掺杂摩尔分数为 $x$，定义为被 $M$ 占据的 B 位点的分数（即，$x = 0$ 对应无掺杂，$x = 1$ 对应 B 亚晶格上的 B 被 $M$ 完全取代）。假设：\n- 晶体完全脱水，因此不存在质子缺陷。\n- 在所考虑的条件下，与离子缺陷相比，电子缺陷的浓度可以忽略不计。\n- 唯一的补偿点缺陷是氧亚晶格上的氧空位。\n- 所有掺杂剂都完全电离，不存在缺陷缔合，且稀释极限成立。\n- 氧亚晶格每单位体积包含 $N_{O}$ 个格点，B 亚晶格每单位体积包含 $N_{B}$ 个格点，根据钙钛矿的化学计量关系有 $N_{O} = 3 N_{B}$。\n\n仅从局部电中性、格点计数和给定的化学计量关系出发，推导氧空位的平衡分数 $y_{V}$ 作为 $x$、$z_{B}$ 和 $z_{M}$ 函数的闭式表达式。请将您的最终答案表示为 $y_{V}(x, z_{B}, z_{M})$ 的最简解析形式。无需进行数值计算，最终表达式中不应包含任何单位。", "solution": "所陈述的问题是有效的。这是一个在固态缺陷化学领域中表述清晰、有科学依据的问题，没有矛盾或含糊之处。所有假设和参数都已明确定义，可以进行严谨的推导。我现在开始进行解答。\n\n目标是推导氧空位分数 $y_V$ 的表达式，该表达式是关于掺杂摩尔分数 $x$ 以及主晶格和掺杂 B 位阳离子的电荷数 $z_B$ 和 $z_M$ 的函数。推导将严格基于局部电中性和格点计数的原则，并遵循给定的假设。\n\n首先，我们必须确定晶体中的带电缺陷种类。根据问题陈述，该系统包含一个受主掺杂剂 $M$，它在 B 亚晶格上取代主晶格阳离子 $B$，并通过仅形成氧空位来进行电荷补偿。电子缺陷和质子缺陷可以忽略不计。因此，为了维持电荷平衡，我们唯一需要考虑的带电种类是掺杂离子和氧空位。\n\n我们来确定这些种类的有效电荷。一个缺陷的有效电荷是其相对于其在完美、未掺杂晶体中所占格点位置的电荷。\n1.  一个氧空位，我们表示为 $V_O$，是通过从一个氧晶格格点上移除一个氧离子 $O^{2-}$ 形成的。该格点的电荷从离子的电荷 $z_O = -2$ 变为零。因此，氧空位的有效电荷 $q_{V_O}$ 为 $q_{V_O} = 0 - z_O = 0 - (-2) = +2$。\n2.  一个电荷数为 $z_M$ 的受主掺杂离子 $M$ 取代了一个电荷数为 $z_B$ 的主晶格 B 位阳离子 $B$。这种取代缺陷，我们可以表示为 $M_B$，其有效电荷是电荷数之差：$q_{M_B} = z_M - z_B$。正如所规定的，$z_M < z_B$，这使得有效电荷为负，与受主缺陷的性质一致。\n\n局部电中性原理要求晶体在宏观上保持电中性。这意味着所有缺陷种类的浓度与有效电荷乘积之和必须为零。设 $[V_O]$ 为氧空位的体积浓度（单位体积内的数量），$[M_B]$ 为 B 位上掺杂离子的体积浓度。电中性条件为：\n$$[V_O] \\cdot q_{V_O} + [M_B] \\cdot q_{M_B} = 0$$\n代入我们推导出的有效电荷：\n$$[V_O] \\cdot (+2) + [M_B] \\cdot (z_M - z_B) = 0$$\n这个方程可以重新整理，以分离带正电和带负电的种类：\n$$2[V_O] = [M_B](z_B - z_M)$$\n\n接下来，我们必须将这些体积浓度与问题陈述中给出的分数联系起来。\n1.  变量 $y_V$ 定义为氧空位分数。如果 $N_O$ 是单位体积内氧格点的总数，那么氧空位的浓度为 $[V_O] = y_V N_O$。\n2.  变量 $x$ 定义为被掺杂剂 $M$ 占据的 B 亚晶格格点的分数。如果 $N_B$ 是单位体积内 B 亚晶格格点的总数，那么掺杂剂的浓度为 $[M_B] = x N_B$。\n\n将这些浓度表达式代入电中性方程：\n$$2(y_V N_O) = (x N_B)(z_B - z_M)$$\n\n最后一步是利用 $ABO_3$ 钙钛矿结构的化学计量关系。化学式表明，每有 1 个 B 位阳离子，就对应有 3 个氧原子。这意味着相应亚晶格的格点密度之间存在直接关系：$N_O = 3 N_B$。\n\n将此化学计量约束代入我们的方程：\n$$2 y_V (3 N_B) = x N_B (z_B - z_M)$$\n$$6 y_V N_B = x N_B (z_B - z_M)$$\nB 亚晶格的格点密度 $N_B$ 是一个非零量，可以从方程两边消去：\n$$6 y_V = x(z_B - z_M)$$\n最后，我们求解 $y_V$，得到所需的表达式：\n$$y_V = \\frac{x(z_B - z_M)}{6}$$\n这就是在严格遵循给定前提下推导出的，氧空位平衡分数作为掺杂分数 $x$ 和电荷态 $z_B$、$z_M$ 函数的闭式表达式。", "answer": "$$\\boxed{\\frac{x(z_B - z_M)}{6}}$$", "id": "2831042"}, {"introduction": "离子在晶格中的迁移是一个热激活过程，其宏观表现为电导率 $σ$ 随温度 $T$ 的变化。本练习将理论推导与实验数据分析相结合，指导你如何从电导率的阿伦尼乌斯图（$\\ln \\sigma$ vs $1/T$）中提取关键的物理参数——迁移激活能 $E_{a}$。理解并计算激活能对于评估离子导体的性能和揭示其微观输运机理至关重要 [@problem_id:2858758]。", "problem": "一种致密多晶超离子导体的离子输运主要由单价阳离子在等效晶格位置之间的热激活跳跃所主导。假设在所研究的温度区间内，可动离子浓度与温度无关，且跳跃速率的主要温度依赖性源于克服迁移势垒。\n\n从跳跃模型和扩散系数与迁移率之间的 Einstein 关系式出发，结合电导率的定义，运用基本原理推导 $\\ln \\sigma$ 和 $1/T$ 之间的线性关系，并用具有物理意义的参数来表示其斜率和截距。您可以假设，在一个有限的温度区间内，任何缓慢变化的指前因子都可以被视为近似恒定，从而可以被一个有效的指前因子所包含。\n\n该材料的 $\\ln \\sigma$ 对 $1/T$（横轴单位为 $\\mathrm{K}^{-1}$）的 Arrhenius 图显示出一条最佳拟合直线，其斜率 $m$ 和截距 $b$ 如下：\n- $m = -3.481355436 \\times 10^{3} \\ \\mathrm{K}$，\n- $b = 9.210340372$。\n\n取玻尔兹曼常数为 $k_{B} = 8.617333262 \\times 10^{-5} \\ \\mathrm{eV/K}$。\n\n使用您推导出的线性关系，确定活化能 $E_{a}$ 和指前因子 $\\sigma_{0}$。以电子伏特报告 $E_{a}$，以西门子/米报告 $\\sigma_{0}$。将两个量都四舍五入到四位有效数字。\n\n基于您的推导，简要解释在固体电解质和超离子导体的背景下，$E_{a}$ 和 $\\sigma_{0}$ 的物理意义。\n\n您的最终答案必须是一个由 $E_{a}$ 和 $\\sigma_{0}$ 按此顺序组成的数对。", "solution": "问题陈述被评估为有效。它在科学上基于固态物理学的原理，特别是晶体固体中的离子输运理论。问题提法恰当，提供了足够的信息和清晰、客观的指令，以推导一个标准物理模型并将其应用于给定的数据集。所有提供的数据和假设都是一致且物理上合理的。\n\n任务是推导离子电导率的 Arrhenius 关系，然后使用提供的实验数据来确定活化能 $E_{a}$ 和指前因子 $\\sigma_{0}$。\n\n电导率 $\\sigma$ 定义为可动载流子浓度 $n$、每个载流子的电荷 $q$ 和载流子迁移率 $\\mu$ 的乘积：\n$$\n\\sigma = n q \\mu\n$$\n问题陈述指出，可动载流子是单价阳离子，因此它们的电荷是基本电荷 $q = e$。假设浓度 $n$ 与温度 $T$ 无关。\n\n迁移率 $\\mu$ 通过 Einstein 关系式（在此背景下也称为 Nernst-Einstein 关系式）与扩散系数 $D$ 相关联：\n$$\n\\mu = \\frac{q D}{k_{B} T}\n$$\n其中 $k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n将 $\\mu$ 的表达式代入 $\\sigma$ 的方程，得到：\n$$\n\\sigma = n q \\left( \\frac{q D}{k_{B} T} \\right) = \\frac{n q^{2} D}{k_{B} T}\n$$\n问题指明离子输运主要由热激活跳跃主导。对于三维晶格中的跳跃机制，扩散系数 $D$ 由下式给出：\n$$\nD = \\frac{1}{6} z a^{2} f \\Gamma\n$$\n其中 $z$ 是最近邻位置的数量，$a$ 是跳跃距离，$f$ 是一个相关因子（对于本问题，可以认为其是常数并被吸收到指前因子中），$\\Gamma$ 是离子跳跃速率。为简化起见，我们可以将其表示为 $D = D_0 \\Gamma$，其中 $D_0$ 是一个与温度无关的几何因子。\n\n跳跃速率 $\\Gamma$ 是热激活的，并遵循 Arrhenius 定律：\n$$\n\\Gamma = \\nu_{0} \\exp\\left(-\\frac{E_{a}}{k_{B} T}\\right)\n$$\n此处，$\\nu_{0}$ 是尝试频率，与离子在其势阱中的振动频率有关；$E_{a}$ 是迁移活化能，代表一次跳跃的能垒。\n\n综合这些表达式，电导率变为：\n$$\n\\sigma = \\frac{n q^{2}}{k_{B} T} D = \\frac{n q^{2}}{k_{B} T} \\left( \\frac{1}{6} z a^{2} f \\nu_{0} \\exp\\left(-\\frac{E_{a}}{k_{B} T}\\right) \\right)\n$$\n这可以写作：\n$$\n\\sigma = \\frac{1}{T} \\left( \\frac{n q^{2} z a^{2} f \\nu_{0}}{6 k_{B}} \\right) \\exp\\left(-\\frac{E_{a}}{k_{B} T}\\right)\n$$\n问题指示要假设在一个有限的温度区间内，任何缓慢变化的指前因子都可以被视为近似恒定。$1/T$ 项的变化比指数项 $\\exp(-E_{a}/(k_{B}T))$ 慢得多。因此，我们可以将 $1/T$ 项和所有其他与温度无关的因子吸收到一个单一的有效指前因子 $\\sigma_{0}$ 中。\n$$\n\\sigma_{0} \\approx \\frac{n q^{2} z a^{2} f \\nu_{0}}{6 k_{B} T_{\\text{avg}}}\n$$\n其中 $T_{\\text{avg}}$ 是测量范围内的代表性平均温度。通过这一标准近似，电导率方程简化为众所周知的 Arrhenius 形式：\n$$\n\\sigma(T) = \\sigma_{0} \\exp\\left(-\\frac{E_{a}}{k_{B} T}\\right)\n$$\n为获得所需的线性关系，我们对两边取自然对数：\n$$\n\\ln \\sigma = \\ln \\left( \\sigma_{0} \\exp\\left(-\\frac{E_{a}}{k_{B} T}\\right) \\right) = \\ln \\sigma_{0} + \\ln \\left( \\exp\\left(-\\frac{E_{a}}{k_{B} T}\\right) \\right)\n$$\n$$\n\\ln \\sigma = \\ln \\sigma_{0} - \\frac{E_{a}}{k_{B}} \\frac{1}{T}\n$$\n该方程具有 $y = b + mx$ 的形式，其中 $y = \\ln \\sigma$，$x = 1/T$。斜率 $m$ 和 y 轴截距 $b$ 被确定为：\n- 斜率：$m = -\\frac{E_{a}}{k_{B}}$\n- 截距：$b = \\ln \\sigma_{0}$\n\n问题提供了从 Arrhenius 图中得到的斜率和截距的实验值：\n- $m = -3.481355436 \\times 10^{3} \\ \\mathrm{K}$\n- $b = 9.210340372$\n\n我们现在可以计算 $E_{a}$ 和 $\\sigma_{0}$。\n从斜率可得：\n$$\nE_{a} = -m \\cdot k_{B}\n$$\n代入给定值：\n$$\nE_{a} = -(-3.481355436 \\times 10^{3} \\ \\mathrm{K}) \\times (8.617333262 \\times 10^{-5} \\ \\mathrm{eV/K})\n$$\n$$\nE_{a} = 0.2999999999... \\ \\mathrm{eV}\n$$\n四舍五入到四位有效数字，我们得到 $E_{a} = 0.3000 \\ \\mathrm{eV}$。\n\n从截距可得：\n$$\n\\sigma_{0} = \\exp(b)\n$$\n代入给定的 $b$ 值：\n$$\n\\sigma_{0} = \\exp(9.210340372)\n$$\n由于 $\\ln(10^{4}) = 4 \\ln(10) \\approx 4 \\times 2.302585 = 9.21034$，因此 $b$ 的值对应于 $\\ln(10000)$。\n$$\n\\sigma_{0} = 10000.0... \\ \\mathrm{S/m}\n$$\n四舍五入到四位有效数字，我们得到 $\\sigma_{0} = 1.000 \\times 10^{4} \\ \\mathrm{S/m}$。\n\n物理意义：\n- **活化能 ($E_{a}$)**：在此背景下，即可动离子浓度恒定时，$E_{a}$ 代表迁移焓。它是一个可动阳离子必须拥有的、用以克服由周围晶格离子产生的静电势能垒并跳跃到相邻等效空位点所需的最小动能。它是衡量离子在晶体结构中运动难易程度的直接指标。\n- **指前因子 ($\\sigma_{0}$)**：该因子代表在无限温度下（此时指数项为1）的理论电导率。它整合了多个与材料相关的参数：$\\sigma_{0} \\propto n q^{2} a^{2} \\nu_{0}$。物理上，它取决于可用载流子的数量 ($n$)、其电荷的平方 ($q^{2}$)、跳跃路径的几何形状（跳跃距离 $a$ 和结构因子），以及离子尝试跳跃的特征频率（$\\nu_{0}$，即尝试频率，与晶格振动有关）。对于给定的输运机制，它设定了电导率的上限。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.3000 & 1.000 \\times 10^4\n\\end{pmatrix}\n}\n$$", "id": "2858758"}, {"introduction": "传统的离子输运模型常常假设离子是独立运动的，但这在许多高载流子浓度的超离子导体中并不完全准确。本练习是一项高级计算实践，要求你处理分子动力学（MD）模拟数据，以深入探索区分离子的自扩散与集体电荷输运。通过计算Haven比 $H$，你将学会如何从微观层面量化离子运动的协同效应，这是理解和设计高性能离子导体的前沿技能 [@problem_id:2831047]。", "problem": "给定三维晶体固体中相同单价离子的确定性分子动力学 (MD) 速度时间序列。您的任务是从基础的涨落-耗散关系出发，构建一个程序，以分离多粒子速度相关函数中的自贡献和异贡献，从而为几个合成测试用例计算示踪扩散系数和 Haven 比。\n\n请使用以下经过充分检验且被广泛接受的出发点作为您推导和算法设计的基础，除了这些基础之外，不假定任何快捷表达式：\n\n- 离子电导率的 Green–Kubo (GK) 关系指出，宏观电导率与微观电荷流的平衡自相关的时域积分成正比。对于电荷为 $q$、数密度为 $n$ 的单一离子种类，微观电流为 $\\mathbf{J}(t)=q\\sum_{i=1}^{N}\\mathbf{v}_i(t)$，电导率满足\n  $$\n  \\sigma=\\frac{1}{3Vk_{\\mathrm{B}}T}\\int_{0}^{\\infty}\\langle\\mathbf{J}(0)\\cdot\\mathbf{J}(t)\\rangle\\,dt,\n  $$\n  其中 $V$ 是体积，$T$ 是温度，$k_{\\mathrm{B}}$ 是 Boltzmann 常数。\n- 示踪扩散系数 $D_{\\mathrm{tr}}$ 可以通过涨落-耗散定理从标记离子的速度自相关函数 (VACF) 中获得：\n  $$\n  D_{\\mathrm{tr}}=\\frac{1}{3}\\int_{0}^{\\infty}\\langle\\mathbf{v}_i(0)\\cdot\\mathbf{v}_i(t)\\rangle\\,dt,\n  $$\n  其中，平均是在平衡初始条件和相同粒子的离子索引 $i$ 上进行的。\n- Nernst–Einstein (NE) 扩散系数 $D_{\\sigma}$ 由 $\\sigma=nq^2D_{\\sigma}/(k_{\\mathrm{B}}T)$ 定义。\n\n从这些基础出发，推导一个分解式，以分离速度相关矩阵的自部分和异部分，从而将 $D_{\\mathrm{tr}}$ 和 $D_{\\sigma}$ 与这些相关函数的时间积分联系起来，并由此将 Haven 比 $H$ 定义为离子间相关性的无量纲度量。实现一个数值稳定的离散时间算法，该算法从提供的有限长度速度轨迹中估算所需的相关函数，并在可用的相关窗口上使用一致的时间积分规则。\n\n离散时间定义与要求：\n\n- 给定 $N$ 个离子，离散时间 $t_m=m\\Delta t$（其中 $m\\in\\{0,1,\\dots,M-1\\}$，时间步长为 $\\Delta t$），以及 SI 单位下的速度矢量 $\\mathbf{v}_i(t_m)\\in\\mathbb{R}^3$。对于任意非负整数延迟 $k$，定义无偏离散互相关估计量\n  $$\n  C_{ij}(k)=\\frac{1}{M-k}\\sum_{m=0}^{M-k-1}\\mathbf{v}_i(t_m)\\cdot\\mathbf{v}_j(t_{m+k}).\n  $$\n- 定义每个延迟的自速度和总速度相关标量\n  $$\n  Z_{\\mathrm{self}}(k)=\\frac{1}{3N}\\sum_{i=1}^{N}C_{ii}(k),\\quad Z_{\\mathrm{tot}}(k)=\\frac{1}{3N}\\sum_{i=1}^{N}\\sum_{j=1}^{N}C_{ij}(k).\n  $$\n  异贡献为 $Z_{\\mathrm{distinct}}(k)=Z_{\\mathrm{tot}}(k)-Z_{\\mathrm{self}}(k)$。\n- 在可用的非负延迟上使用梯形法则来近似时间积分：\n  $$\n  D_{\\mathrm{tr}}\\approx\\Delta t\\left(\\frac{Z_{\\mathrm{self}}(0)}{2}+\\sum_{k=1}^{M-2}Z_{\\mathrm{self}}(k)+\\frac{Z_{\\mathrm{self}}(M-1)}{2}\\right),\n  $$\n  $$\n  D_{\\sigma}\\approx\\Delta t\\left(\\frac{Z_{\\mathrm{tot}}(0)}{2}+\\sum_{k=1}^{M-2}Z_{\\mathrm{tot}}(k)+\\frac{Z_{\\mathrm{tot}}(M-1)}{2}\\right).\n  $$\n  那么 Haven 比为\n  $$\n  H=\\frac{D_{\\sigma}}{D_{\\mathrm{tr}}}.\n  $$\n\n测试套件（三个案例；所有量均为确定性的，并采用 SI 单位）：\n\n对于所有案例，定义标量速率分布\n$$\ns(t)=A\\,e^{-\\gamma t}\\cos(\\omega t),\n$$\n其中 $A=100\\,\\mathrm{m/s}$，$\\gamma=5\\times 10^{11}\\,\\mathrm{s}^{-1}$，$\\omega=1\\times 10^{12}\\,\\mathrm{rad/s}$，时间步长 $\\Delta t=5\\times 10^{-15}\\,\\mathrm{s}$，以及 $M=2001$ 个样本（因此最大时间为 $(M-1)\\Delta t=1.0005\\times 10^{-11}\\,\\mathrm{s}$）。对于每个离子 $i$，其速度为\n$$\n\\mathbf{v}_i(t_m)=s(t_m)\\,\\mathbf{u}_i,\n$$\n其中 $\\mathbf{u}_i$ 是一个指定离子 $i$ 运动方向的恒定单位矢量。\n\n- 案例 A（通过正交性实现的非相关异运动）：$N=3$ 且 $\\mathbf{u}_1=(1,0,0)$, $\\mathbf{u}_2=(0,1,0)$, $\\mathbf{u}_3=(0,0,1)$。\n- 案例 B（最大相关异运动）：$N=4$ 且对所有 $i\\in\\{1,2,3,4\\}$ 都有 $\\mathbf{u}_i=(1,0,0)$。\n- 案例 C（净电流为零的最大反相关异运动）：$N=4$ 且 $\\mathbf{u}_1=\\mathbf{u}_2=(1,0,0)$ 及 $\\mathbf{u}_3=\\mathbf{u}_4=(-1,0,0)$。\n\n您的程序必须：\n\n- 精确按照定义构建每个案例的速度数组 $\\mathbf{v}_i(t_m)$。\n- 在所有非负延迟 $k\\in\\{0,1,\\dots,M-1\\}$ 上计算 $C_{ij}(k)$、$Z_{\\mathrm{self}}(k)$ 和 $Z_{\\mathrm{tot}}(k)$。\n- 如上计算 $D_{\\mathrm{tr}}$ 和 $H$。将 $D_{\\mathrm{tr}}$ 以 $\\mathrm{m}^2/\\mathrm{s}$ 表示，将 $H$ 表示为纯数。将每个 $D_{\\mathrm{tr}}$ 四舍五入到六位有效数字，将每个 $H$ 四舍五入到小数点后六位。\n- 输出格式：您的程序应生成单行输出，其中包含所有六个结果，格式为逗号分隔的列表，并用方括号括起，顺序如下\n  $$\n  [D_{\\mathrm{tr}}^{(A)},H^{(A)},D_{\\mathrm{tr}}^{(B)},H^{(B)},D_{\\mathrm{tr}}^{(C)},H^{(C)}].\n  $$\n\n所有计算都必须使用上述定义进行，不得使用任何外部数据。严格遵守指定的单位和定义，确保科学真实性。每个测试用例的答案必须是数值浮点数。这三个案例一起旨在测试：异相关消失的基线、一个最大相关区域和一个最大反相关区域。", "solution": "首先对问题陈述进行严格的验证过程。所有给定的定义，包括电导率的 Green-Kubo 关系、示踪扩散系数和 Nernst-Einstein 扩散系数的定义，以及相关函数的离散估计量，在统计力学和材料物理领域都是公认且成熟的。合成测试用例的参数定义清晰、量纲一致，并且在简化模型的背景下是物理上合理的。该问题是自洽的、数学上适定的，并且没有科学或逻辑上的矛盾。因此，它被认为是有效的，我们可以继续进行形式化的推导和求解。\n\n目标是从分子动力学数据计算示踪扩散系数 `$D_{\\mathrm{tr}}$` 和 Haven 比 `$H = D_{\\sigma}/D_{\\mathrm{tr}}$`。该解决方案需要一个推导过程，将宏观输运系数与微观速度相关函数联系起来。\n\n我们从直流离子电导率 `$\\sigma$` 的 Green-Kubo 关系开始：\n$$\n\\sigma=\\frac{1}{3Vk_{\\mathrm{B}}T}\\int_{0}^{\\infty}\\langle\\mathbf{J}(0)\\cdot\\mathbf{J}(t)\\rangle\\,dt\n$$\n对于 `$N$` 个电荷为 `$q$` 的相同单价离子，微观电荷流 `$\\mathbf{J}(t)$` 由 `$\\mathbf{J}(t)=q\\sum_{i=1}^{N}\\mathbf{v}_i(t)$` 给出。将其代入 `$\\sigma$` 的表达式中，得到：\n$$\n\\sigma=\\frac{q^2}{3Vk_{\\mathrm{B}}T}\\int_{0}^{\\infty}\\left\\langle \\left(\\sum_{i=1}^{N}\\mathbf{v}_i(0)\\right)\\cdot\\left(\\sum_{j=1}^{N}\\mathbf{v}_j(t)\\right) \\right\\rangle\\,dt\n$$\n根据系综平均 `$\\langle \\cdot \\rangle$` 的线性性质，我们可以将求和符号移到外面：\n$$\n\\sigma=\\frac{q^2}{3Vk_{\\mathrm{B}}T}\\int_{0}^{\\infty} \\sum_{i=1}^{N}\\sum_{j=1}^{N} \\langle \\mathbf{v}_i(0)\\cdot\\mathbf{v}_j(t) \\rangle \\,dt\n$$\n接下来，我们使用 Nernst-Einstein 关系，它通过 `$\\sigma = nq^2D_{\\sigma}/(k_{\\mathrm{B}}T)$` 定义了扩散系数 `$D_{\\sigma}$`，其中 `$n=N/V$` 是离子的数密度。将 `$\\sigma$` 的两个表达式相等，得到：\n$$\n\\frac{Nq^2}{Vk_{\\mathrm{B}}T} D_{\\sigma} = \\frac{q^2}{3Vk_{\\mathrm{B}}T}\\int_{0}^{\\infty} \\sum_{i=1}^{N}\\sum_{j=1}^{N} \\langle \\mathbf{v}_i(0)\\cdot\\mathbf{v}_j(t) \\rangle \\,dt\n$$\n消去两侧的共同前置因子 `$q^2/(Vk_{\\mathrm{B}}T)$`，剩下：\n$$\nN D_{\\sigma} = \\frac{1}{3} \\int_{0}^{\\infty} \\sum_{i=1}^{N}\\sum_{j=1}^{N} \\langle \\mathbf{v}_i(0)\\cdot\\mathbf{v}_j(t) \\rangle \\,dt\n$$\n分离出 `$D_{\\sigma}$`，我们得到 Nernst-Einstein 扩散系数用总速度相关函数表示的表达式：\n$$\nD_{\\sigma} = \\frac{1}{3N} \\int_{0}^{\\infty} \\sum_{i=1}^{N}\\sum_{j=1}^{N} \\langle \\mathbf{v}_i(0)\\cdot\\mathbf{v}_j(t) \\rangle \\,dt\n$$\n这个双重求和可以分裂成一个“自”部分（其中 `$i=j$`）和一个“异”部分（其中 `$i \\neq j$`）：\n$$\nD_{\\sigma} = \\frac{1}{3N} \\int_{0}^{\\infty} \\left( \\sum_{i=1}^{N} \\langle \\mathbf{v}_i(0)\\cdot\\mathbf{v}_i(t) \\rangle + \\sum_{i=1}^{N}\\sum_{j \\neq i}^{N} \\langle \\mathbf{v}_i(0)\\cdot\\mathbf{v}_j(t) \\rangle \\right) \\,dt\n$$\n由于所有离子都是相同的，单粒子速度自相关函数 (VACF) `$\\langle \\mathbf{v}_i(0)\\cdot\\mathbf{v}_i(t) \\rangle$` 对所有离子 `$i$` 都是相同的。求和 `$\\sum_{i=1}^{N}$` 简单地得到该值的 `$N$` 倍。因此，我们可以写成：\n$$\nD_{\\sigma} = \\frac{1}{3} \\int_{0}^{\\infty} \\langle \\mathbf{v}_i(0)\\cdot\\mathbf{v}_i(t) \\rangle \\,dt + \\frac{1}{3N} \\int_{0}^{\\infty} \\sum_{i=1}^{N}\\sum_{j \\neq i}^{N} \\langle \\mathbf{v}_i(0)\\cdot\\mathbf{v}_j(t) \\rangle \\,dt\n$$\n第一项恰好是示踪扩散系数 `$D_{\\mathrm{tr}}$` 的定义。这揭示了基本分解：\n$$\nD_{\\sigma} = D_{\\mathrm{tr}} + D_{\\mathrm{distinct}}\n$$\n其中 `$D_{\\mathrm{distinct}}$` 代表来自不同离子之间相关的贡献。那么，Haven 比 `$H = D_{\\sigma} / D_{\\mathrm{tr}}$` 为：\n$$\nH = 1 + \\frac{D_{\\mathrm{distinct}}}{D_{\\mathrm{tr}}}\n$$\n该比率量化了离子运动中的相关程度。`$H=1$` 表示非相关运动，`$H > 1$` 表示相关运动（例如，离子朝同一方向移动），而 `$0 \\le H < 1$` 表示反相关运动（例如，一个离子跳入一个空位，导致邻近位置上先前的占据者以相反的方式被取代）。\n\n对于数值实现，我们使用提供的离散估计量。核心计算是互相关 `$C_{ij}(k)$`。问题指定了一个高度结构化的速度分布：`$\\mathbf{v}_i(t_m)=s(t_m)\\,\\mathbf{u}_i$`。这允许进行显著的简化。\n用于 `$C_{ij}(k)$` 的求和式中的点积变为：\n$$\n\\mathbf{v}_i(t_m)\\cdot\\mathbf{v}_j(t_{m+k}) = \\left(s(t_m)\\mathbf{u}_i\\right) \\cdot \\left(s(t_{m+k})\\mathbf{u}_j\\right) = s(t_m)s(t_{m+k}) (\\mathbf{u}_i \\cdot \\mathbf{u}_j)\n$$\n将其代入 `$C_{ij}(k)$` 的定义中：\n$$\nC_{ij}(k) = \\frac{1}{M-k}\\sum_{m=0}^{M-k-1} s(t_m)s(t_{m+k}) (\\mathbf{u}_i \\cdot \\mathbf{u}_j) = (\\mathbf{u}_i \\cdot \\mathbf{u}_j) \\left( \\frac{1}{M-k}\\sum_{m=0}^{M-k-1} s(t_m)s(t_{m+k}) \\right)\n$$\n让我们定义标量速率自相关函数 `$S(k) = \\frac{1}{M-k}\\sum_{m=0}^{M-k-1} s(t_m)s(t_{m+k})$`。那么 `$C_{ij}(k) = (\\mathbf{u}_i \\cdot \\mathbf{u}_j) S(k)$`。\n\n现在，我们可以写出每个延迟的标量 `$Z_{\\mathrm{self}}(k)$` 和 `$Z_{\\mathrm{tot}}(k)$`：\n$$\nZ_{\\mathrm{self}}(k)=\\frac{1}{3N}\\sum_{i=1}^{N}C_{ii}(k) = \\frac{1}{3N}\\sum_{i=1}^{N}(\\mathbf{u}_i\\cdot\\mathbf{u}_i) S(k)\n$$\n由于 `$\\mathbf{u}_i$` 是单位矢量，`$\\mathbf{u}_i\\cdot\\mathbf{u}_i = 1$`。因此：\n$$\nZ_{\\mathrm{self}}(k) = \\frac{1}{3N} (N \\cdot 1) S(k) = \\frac{1}{3}S(k)\n$$\n这表明 `$Z_{\\mathrm{self}}(k)$` 以及因此的 `$D_{\\mathrm{tr}}$` 对所有三个测试用例都是相同的，因为它们仅取决于共同的速率分布 `$s(t)$`。\n\n对于 `$Z_{\\mathrm{tot}}(k)$`：\n$$\nZ_{\\mathrm{tot}}(k)=\\frac{1}{3N}\\sum_{i=1}^{N}\\sum_{j=1}^{N}C_{ij}(k) = \\frac{S(k)}{3N} \\sum_{i=1}^{N}\\sum_{j=1}^{N}(\\mathbf{u}_i \\cdot \\mathbf{u}_j)\n$$\n`$Z_{\\mathrm{tot}}(k)$` 的值是 `$Z_{\\mathrm{self}}(k)$` 的倍数，其乘数取决于特定案例的矢量集合 `$\\{\\mathbf{u}_i\\}$`。令 `$U = \\sum_{i,j}(\\mathbf{u}_i \\cdot \\mathbf{u}_j)$`。那么 `$Z_{\\mathrm{tot}}(k) = \\frac{U}{N} Z_{\\mathrm{self}}(k)$`。因此，积分也将成比例：`$D_{\\sigma} = \\frac{U}{N} D_{\\mathrm{tr}}$`。这意味着 Haven 比就是 `$H = D_{\\sigma} / D_{\\mathrm{tr}} = U / N$`。\n\n我们可以预测每个案例的 Haven 比：\n- 案例 A：`$N=3$`，`$\\{\\mathbf{u}_i\\}$` 是正交的。`$\\mathbf{u}_i \\cdot \\mathbf{u}_j = \\delta_{ij}$`。因此，`$U_A = \\sum_{i,j}\\delta_{ij} = \\sum_i 1 = N = 3$`。Haven 比为 `$H_A = U_A/N = 3/3 = 1$`。\n- 案例 B：`$N=4$`，`$\\{\\mathbf{u}_i\\}$`全都相同。`$\\mathbf{u}_i \\cdot \\mathbf{u}_j = 1$`。因此，`$U_B = \\sum_{i,j} 1 = N^2 = 16$`。Haven 比为 `$H_B = U_B/N = 16/4 = 4$`。\n- 案例 C：`$N=4$`，两个矢量是 `$(1,0,0)$`，另外两个是 `$(-1,0,0)$`。点积矩阵具有 `$2 \\times 2$` 的 `1` 块和 `$2 \\times 2$` 的 `-1` 块。所有元素的总和是 `$U_C = 4 \\times 1 + 4 \\times 1 + 4 \\times (-1) + 4 \\times (-1) = 0$`。Haven 比为 `$H_C = U_C/N = 0/4 = 0$`。\n\n该算法将首先计算 `$s(t)$`。然后，它将计算所有延迟 `$k$` 的 `$S(k)$`，这决定了 `$Z_{\\mathrm{self}}(k)$`。通过梯形法则对 `$Z_{\\mathrm{self}}(k)$` 进行积分，得到 `$D_{\\mathrm{tr}}$`。对于每个案例，计算标量因子 `$U/N$`，找到 `$Z_{\\mathrm{tot}}(k)$`，通过积分计算 `$D_{\\sigma}$`，最后计算出 `$H$`。最终的数值结果将按规定进行四舍五入。", "answer": "$$\n\\boxed{[2.00047 \\times 10^{-10}, 1.000000, 2.00047 \\times 10^{-10}, 4.000000, 2.00047 \\times 10^{-10}, 0.000000]}\n$$", "id": "2831047"}]}