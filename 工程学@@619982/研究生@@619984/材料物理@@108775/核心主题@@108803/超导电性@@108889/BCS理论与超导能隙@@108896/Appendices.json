{"hands_on_practices": [{"introduction": "第一个练习旨在巩固巴丁-库珀-施里弗（Bardeen-Cooper-Schrieffer, BCS）理论的核心成果。通过应用简化的恒定吸引势模型，我们将推导出著名的零温能隙 $\\Delta_0$ 的指数公式。这个实践对于理解超导能隙与微观吸引相互作用强度 $\\lambda$ 之间关键的、非微扰的依赖关系至关重要。[@problem_id:2802551]", "problem": "考虑一个在弱耦合Bardeen–Cooper–Schrieffer（BCS）框架下描述的常规$s$-波超导体。假设在费米能级$N(0)$处，单自旋电子态密度为常数，且存在一个吸引性配对相互作用$V$，该作用仅在费米能量周围半宽度为$\\hbar \\omega_D$的德拜窗口内的电子能量范围内非零。取无量纲耦合参数为$\\lambda \\equiv N(0) V$，并假设$\\lambda = 0.3$以及$\\hbar \\omega_D = 40$ meV。\n\n从这些假设下的零温BCS能隙方程出发，并仅采用由$\\hbar \\omega_D \\gg \\Delta_0$所保证的标准弱耦合近似，推导零温能隙$\\Delta_0$关于$\\lambda$和$\\hbar \\omega_D$的解析表达式。然后，定义能隙对无量纲耦合的对数敏感度，\n$$\nS(\\lambda) \\equiv \\frac{\\partial \\ln \\Delta_0}{\\partial \\lambda},\n$$\n并在$\\lambda = 0.3$处计算$S$的值。\n\n计算：\n- 以meV为单位表示的$\\Delta_0$的数值，以及\n- $S$的数值，\n两者均在$\\lambda = 0.3$和$\\hbar \\omega_D = 40$ meV的条件下计算。\n\n将两个数值结果四舍五入至$3$位有效数字。最终答案必须表示为一行中的两个数字（按$\\Delta_0$，$S$的顺序）。在最终方框内的答案中不要包含单位。", "solution": "首先，将对问题进行强制性验证。\n\n从问题陈述中提取的已知条件如下：\n- 物理系统包含一个常规$s$-波超导体。\n- 理论模型是弱耦合Bardeen–Cooper–Schrieffer (BCS) 框架。\n- 费米能级处的单自旋电子态密度$N(0)$为常数。\n- 吸引性配对相互作用（记为$V$）是一个非零常数，且仅当电子能量$\\xi$满足$|\\xi| < \\hbar \\omega_D$时非零，其中$\\hbar \\omega_D$是德拜能量的半宽度。\n- 无量纲耦合参数定义为$\\lambda \\equiv N(0) V$。\n- 参数的数值为$\\lambda = 0.3$和$\\hbar \\omega_D = 40$ meV。\n- 任务要求使用由条件$\\hbar \\omega_D \\gg \\Delta_0$所保证的弱耦合近似。\n- 能隙的对数敏感度定义为$S(\\lambda) \\equiv \\frac{\\partial \\ln \\Delta_0}{\\partial \\lambda}$。\n\n该问题被评估为有效。它在科学上是合理的，植根于凝聚态物理学的基本原理，特别是超导的BCS理论。所有术语都定义明确，并提供了足够的信息来得出一个唯一的、有意义的解。问题表述客观，没有任何不一致、模糊或事实错误。因此，我们可以着手求解。\n\n推导始于指定模型的标准零温BCS能隙方程。在德拜窗口内，单自旋态密度$N(0)$和吸引势$V$为常数，因此能隙方程简化为：\n$$\n1 = \\lambda \\int_{-\\hbar\\omega_D}^{\\hbar\\omega_D} \\frac{d\\xi}{2\\sqrt{\\xi^2 + \\Delta_0^2}}\n$$\n其中$\\Delta_0$是零温能隙，$\\xi$是相对于费米能级的能量。被积函数是$\\xi$的偶函数，因此积分可以重写为：\n$$\n1 = \\lambda \\cdot 2 \\int_{0}^{\\hbar\\omega_D} \\frac{d\\xi}{2\\sqrt{\\xi^2 + \\Delta_0^2}} = \\lambda \\int_{0}^{\\hbar\\omega_D} \\frac{d\\xi}{\\sqrt{\\xi^2 + \\Delta_0^2}}\n$$\n这是一个标准积分，其解为反双曲正弦函数：\n$$\n\\int_{0}^{u} \\frac{dx}{\\sqrt{x^2+a^2}} = \\left[ \\arcsinh\\left(\\frac{x}{a}\\right) \\right]_{0}^{u} = \\arcsinh\\left(\\frac{u}{a}\\right)\n$$\n将此结果应用于能隙方程，得到：\n$$\n\\frac{1}{\\lambda} = \\arcsinh\\left(\\frac{\\hbar\\omega_D}{\\Delta_0}\\right)\n$$\n这是此简化模型中能隙的精确解。问题要求我们采用弱耦合近似，该近似在$\\hbar\\omega_D \\gg \\Delta_0$时有效。在此极限下，$\\arcsinh$函数的自变量很大。我们使用$\\arcsinh(x)$在$x$很大时的渐近展开：\n$$\n\\arcsinh(x) = \\ln(x + \\sqrt{x^2+1}) \\approx \\ln(x+x) = \\ln(2x) \\quad \\text{for } x \\gg 1\n$$\n将此近似应用于我们的能隙方程：\n$$\n\\frac{1}{\\lambda} \\approx \\ln\\left(\\frac{2\\hbar\\omega_D}{\\Delta_0}\\right)\n$$\n现在我们求解零温能隙$\\Delta_0$。对两边取指数，得到：\n$$\n\\exp\\left(\\frac{1}{\\lambda}\\right) = \\frac{2\\hbar\\omega_D}{\\Delta_0}\n$$\n这就得出了$\\Delta_0$的最终解析表达式：\n$$\n\\Delta_0 = 2\\hbar\\omega_D \\exp\\left(-\\frac{1}{\\lambda}\\right)\n$$\n现在，我们使用给定参数$\\lambda = 0.3$和$\\hbar\\omega_D = 40$ meV来计算$\\Delta_0$的数值。\n$$\n\\Delta_0 = 2 \\times (40 \\text{ meV}) \\times \\exp\\left(-\\frac{1}{0.3}\\right) = 80 \\exp\\left(-\\frac{10}{3}\\right) \\text{ meV}\n$$\n$$\n\\Delta_0 \\approx 80 \\times 0.035674 \\text{ meV} \\approx 2.8539 \\text{ meV}\n$$\n四舍五入到$3$位有效数字，我们得到$\\Delta_0 = 2.85$ meV。我们注意到$\\hbar\\omega_D = 40$ meV确实远大于$\\Delta_0 \\approx 2.85$ meV，这反过来证明了使用弱耦合近似的合理性。\n\n接下来，我们计算对数敏感度$S(\\lambda)$。首先，我们对$\\Delta_0$的表达式取自然对数：\n$$\n\\ln(\\Delta_0) = \\ln\\left(2\\hbar\\omega_D \\exp\\left(-\\frac{1}{\\lambda}\\right)\\right) = \\ln(2\\hbar\\omega_D) + \\ln\\left(\\exp\\left(-\\frac{1}{\\lambda}\\right)\\right) = \\ln(2\\hbar\\omega_D) - \\frac{1}{\\lambda}\n$$\n敏感度$S(\\lambda)$是$\\ln(\\Delta_0)$关于$\\lambda$的偏导数：\n$$\nS(\\lambda) = \\frac{\\partial}{\\partial\\lambda}\\left(\\ln(\\Delta_0)\\right) = \\frac{\\partial}{\\partial\\lambda}\\left(\\ln(2\\hbar\\omega_D) - \\frac{1}{\\lambda}\\right)\n$$\n由于$\\hbar\\omega_D$与$\\lambda$无关，第一项的导数为零。\n$$\nS(\\lambda) = -\\frac{\\partial}{\\partial\\lambda}(\\lambda^{-1}) = -(-1)\\lambda^{-2} = \\frac{1}{\\lambda^2}\n$$\n现在我们计算在$\\lambda=0.3$时$S$的数值：\n$$\nS(0.3) = \\frac{1}{(0.3)^2} = \\frac{1}{0.09} = \\frac{100}{9} \\approx 11.111...\n$$\n四舍五入到$3$位有效数字，得到$S = 11.1$。\n\n经确定，所需的两个数值为$\\Delta_0 \\approx 2.85$ meV和$S \\approx 11.1$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 2.85 & 11.1 \\end{pmatrix}}\n$$", "id": "2802551"}, {"introduction": "理想的BCS理论预测在准粒子态密度中存在奇异的峰值，但由于各种散射过程，这一特征在实际实验中很少被观察到。本练习引入了 Dynes 参数 $\\Gamma$，它是一个强大的唯象工具，用以模拟有限准粒子寿命带来的展宽效应。通过计算展宽后的态密度，你将学习如何将理想化的理论模型与真实的扫描隧道谱等实验数据联系起来。[@problem_id:2802562]", "problem": "一个各向同性、三维、洁净、常规的 Bardeen–Cooper–Schrieffer （BCS） $s$波超导体，在温度 $T=0$ 时，可以在 Nambu 空间中由推迟 Gor’kov 格林函数来描述。令 $\\Delta>0$ 为实数、与能量无关的超导能隙，并令 $\\xi_{\\mathbf{k}}$ 表示从费米能级测量的单粒子色散。该推迟格林函数具有以下形式\n$$\nG^{R}(\\mathbf{k},E)\\;=\\;\\frac{1}{(E+i0^{+})^{2}-\\xi_{\\mathbf{k}}^{2}-\\Delta^{2}}\\begin{pmatrix}\nE+i0^{+}+\\xi_{\\mathbf{k}} & \\Delta \\\\\n\\Delta & E+i0^{+}-\\xi_{\\mathbf{k}}\n\\end{pmatrix}.\n$$\n每个自旋的准粒子态密度（DOS）由以下标准谱关系给出\n$$\nN_{s}(E)\\;=\\;-\\frac{1}{\\pi}\\,\\Im\\sum_{\\mathbf{k}}\\,G^{R}_{11}(\\mathbf{k},E),\n$$\n其中 $G^{R}_{11}$ 是粒子-粒子分量。假设在费米能量附近，每个自旋的正常态态密度 $N_{0}$ 是一个常数（宽带近似），因此 $\\sum_{\\mathbf{k}}(\\cdots)\\to N_{0}\\int_{-\\infty}^{\\infty}d\\xi\\,(\\cdots)$。通过唯象的 Dynes 展宽来模拟有限的准粒子寿命，具体实现方法是进行替换 $0^{+}\\to\\Gamma$，其中 $\\Gamma>0$（与能量无关）。\n\n(a) 仅从这些要素出发，推导归一化超导态密度 $N_{s}(E,\\Gamma)/N_{0}$ 的闭合形式解析表达式，该表达式用 $E$、$\\Delta$ 和 $\\Gamma$ 表示。\n\n(b) 对于 $\\Delta=1.50\\,\\mathrm{meV}$ 和 $\\Gamma=0.10\\,\\mathrm{meV}$，在 $E=\\Delta$ 处计算你的表达式的值，并报告所得的无量纲归一化态密度 $N_{s}(\\Delta,\\Gamma)/N_{0}$。将你的最终数值答案四舍五入到四位有效数字。将最终答案表示为一个无量纲数。", "solution": "问题陈述需经验证。\n\n**第 1 步：提取已知条件**\n- 一个各向同性、三维、洁净、常规的 Bardeen–Cooper–Schrieffer (BCS) $s$波超导体。\n- 温度 $T=0$。\n- 实数、与能量无关的超导能隙：$\\Delta>0$。\n- 从费米能级算起的单粒子色散：$\\xi_{\\mathbf{k}}$。\n- 推迟 Gor’kov 格林函数：\n$$ G^{R}(\\mathbf{k},E)\\;=\\;\\frac{1}{(E+i0^{+})^{2}-\\xi_{\\mathbf{k}}^{2}-\\Delta^{2}}\\begin{pmatrix} E+i0^{+}+\\xi_{\\mathbf{k}} & \\Delta \\\\ \\Delta & E+i0^{+}-\\xi_{\\mathbf{k}} \\end{pmatrix} $$\n- 每个自旋的准粒子态密度 (DOS)：\n$$ N_{s}(E)\\;=\\;-\\frac{1}{\\pi}\\,\\Im\\sum_{\\mathbf{k}}\\,G^{R}_{11}(\\mathbf{k},E) $$\n- 宽带近似：$\\sum_{\\mathbf{k}}(\\cdots)\\to N_{0}\\int_{-\\infty}^{\\infty}d\\xi\\,(\\cdots)$，其中 $N_{0}$ 是恒定的每个自旋正常态态密度。\n- Dynes 展宽：用 $i\\Gamma$ 替换 $i0^{+}$，其中 $\\Gamma>0$ 是一个常数。\n- 任务 (a)：推导归一化态密度 $N_{s}(E,\\Gamma)/N_{0}$。\n- 任务 (b)：对于 $\\Delta=1.50\\,\\mathrm{meV}$ 和 $\\Gamma=0.10\\,\\mathrm{meV}$，计算 $N_{s}(\\Delta,\\Gamma)/N_{0}$。结果必须四舍五入到四位有效数字。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题在科学上基于标准的 BCS 超导理论及其格林函数表述。Dynes 参数是准粒子散射的一个有效且常用的唯象模型。该问题是适定的，提供了所有必要的定义和数据。它是客观且可形式化的。所提供的参数值在物理上是现实的。该问题是理论凝聚态物理中一个标准的、非平凡的计算。\n\n**第 3 步：结论与行动**\n该问题有效。将提供解答。\n\n**部分 (a)：归一化超导态密度的推导**\n\n我们从给定的每个自旋准粒子态密度 $N_{s}(E)$ 的表达式开始。我们通过用 $\\tilde{E} = E+i\\Gamma$ 替换 $E+i0^{+}$ 来引入 Dynes 展宽。\n格林函数的 11-分量是：\n$$ G^{R}_{11}(\\mathbf{k},E) = \\frac{E+i\\Gamma+\\xi_{\\mathbf{k}}}{(E+i\\Gamma)^{2}-\\xi_{\\mathbf{k}}^{2}-\\Delta^{2}} = \\frac{\\tilde{E}+\\xi_{\\mathbf{k}}}{\\tilde{E}^{2}-\\xi_{\\mathbf{k}}^{2}-\\Delta^{2}} $$\n态密度则由下式给出：\n$$ N_{s}(E,\\Gamma) = -\\frac{1}{\\pi}\\,\\Im\\sum_{\\mathbf{k}} G^{R}_{11}(\\mathbf{k},E) $$\n应用宽带近似，我们将对 $\\mathbf{k}$ 的求和替换为对能量 $\\xi$ 的积分，并由正常态态密度 $N_{0}$ 加权：\n$$ N_{s}(E,\\Gamma) = -\\frac{N_{0}}{\\pi}\\,\\Im\\left[\\int_{-\\infty}^{\\infty} d\\xi\\,\\frac{\\tilde{E}+\\xi}{\\tilde{E}^{2}-\\Delta^{2}-\\xi^{2}}\\right] $$\n我们可以将被积函数分解为关于 $\\xi$ 的偶部和奇部：\n$$ \\int_{-\\infty}^{\\infty} d\\xi\\,\\frac{\\tilde{E}+\\xi}{\\tilde{E}^{2}-\\Delta^{2}-\\xi^{2}} = \\int_{-\\infty}^{\\infty} d\\xi\\,\\frac{\\tilde{E}}{\\tilde{E}^{2}-\\Delta^{2}-\\xi^{2}} + \\int_{-\\infty}^{\\infty} d\\xi\\,\\frac{\\xi}{\\tilde{E}^{2}-\\Delta^{2}-\\xi^{2}} $$\n第二个被积函数 $\\xi/(\\tilde{E}^{2}-\\Delta^{2}-\\xi^{2})$ 是 $\\xi$ 的奇函数。由于极点不在实轴上（对于 $\\Gamma>0$），其在对称区间（$-\\infty, \\infty$）上的主值积分为零。因此，我们只需要计算第一个积分：\n$$ I = \\int_{-\\infty}^{\\infty} d\\xi\\,\\frac{\\tilde{E}}{\\tilde{E}^{2}-\\Delta^{2}-\\xi^{2}} = -\\tilde{E}\\int_{-\\infty}^{\\infty} \\frac{d\\xi}{\\xi^{2} - (\\tilde{E}^{2}-\\Delta^{2})} $$\n这个积分可以使用围道积分求解。令 $\\Omega^{2} = \\tilde{E}^{2}-\\Delta^{2}$。被积函数的极点位于 $\\xi = \\pm\\Omega$。我们必须为 $\\Omega$ 选择平方根的一个分支，以使推迟格林函数具有正确的解析性质。我们采用的标准约定是选择虚部为正的根，即 $\\Im(\\Omega) > 0$。\n通过在复 $\\xi$ 平面的上半部分闭合围道来计算该积分。唯一被包围的极点在 $\\xi=+\\Omega$ 处。积分的值是 $2\\pi i$ 乘以该极点处的留数：\n$$ I = -\\tilde{E} \\times (2\\pi i) \\, \\mathrm{Res}\\left[\\frac{1}{(\\xi-\\Omega)(\\xi+\\Omega)}, \\xi=\\Omega\\right] = -\\tilde{E} \\times (2\\pi i) \\times \\frac{1}{2\\Omega} = -\\frac{i\\pi\\tilde{E}}{\\Omega} $$\n将此代回态密度的表达式中：\n$$ N_{s}(E,\\Gamma) = -\\frac{N_{0}}{\\pi}\\,\\Im\\left(-\\frac{i\\pi\\tilde{E}}{\\Omega}\\right) = N_{0}\\,\\Im\\left(i\\frac{\\tilde{E}}{\\Omega}\\right) $$\n利用恒等式 $\\Im(iz) = \\Re(z)$，我们得到归一化态密度：\n$$ \\frac{N_{s}(E,\\Gamma)}{N_{0}} = \\Re\\left(\\frac{\\tilde{E}}{\\Omega}\\right) = \\Re\\left(\\frac{E+i\\Gamma}{\\sqrt{(E+i\\Gamma)^{2}-\\Delta^{2}}}\\right) $$\n这就是 (a) 部分所要求的闭合形式表达式。\n\n**部分 (b)：数值计算**\n\n我们被要求在 $E=\\Delta$ 处计算此表达式，其中 $\\Delta=1.50\\,\\mathrm{meV}$，$\\Gamma=0.10\\,\\mathrm{meV}$。\n代入 $E=\\Delta$：\n$$ \\frac{N_{s}(\\Delta,\\Gamma)}{N_{0}} = \\Re\\left(\\frac{\\Delta+i\\Gamma}{\\sqrt{(\\Delta+i\\Gamma)^{2}-\\Delta^{2}}}\\right) $$\n平方根内的项是：\n$$ (\\Delta+i\\Gamma)^{2}-\\Delta^{2} = (\\Delta^{2}+2i\\Delta\\Gamma-\\Gamma^{2})-\\Delta^{2} = -\\Gamma^{2}+2i\\Delta\\Gamma $$\n令 $r = \\Delta/\\Gamma = 1.50/0.10 = 15$。我们可以从该项中因子分解出 $\\Gamma^{2}$：\n$$ -\\Gamma^{2}+2i\\Delta\\Gamma = \\Gamma^{2}(-1+2i\\frac{\\Delta}{\\Gamma}) = \\Gamma^{2}(-1+2ir) $$\n归一化态密度的表达式变为：\n$$ \\frac{N_{s}(\\Delta,\\Gamma)}{N_{0}} = \\Re\\left(\\frac{\\Gamma(r+i)}{\\sqrt{\\Gamma^{2}(-1+2ir)}}\\right) = \\Re\\left(\\frac{r+i}{\\sqrt{-1+2ir}}\\right) $$\n我们必须计算复平方根 $\\sqrt{-1+2ir}$。设其为 $a+ib$。我们的约定 $\\Im(\\Omega)>0$ 意味着对于 $E>0$，$\\Re(\\Omega)$ 和 $\\Im(\\Omega)$ 都必须为正。这对应于 $a>0$ 和 $b>0$。\n$$ (a+ib)^2 = a^{2}-b^{2}+2iab = -1+2ir $$\n令实部和虚部相等：\n$$ a^{2}-b^{2} = -1 \\quad \\text{和} \\quad 2ab = 2r \\implies ab=r $$\n将 $b=r/a$ 代入第一个方程：\n$$ a^{2} - \\frac{r^{2}}{a^{2}} = -1 \\implies a^{4} + a^{2} - r^{2} = 0 $$\n解关于 $a^{2}$ 的二次方程：\n$$ a^{2} = \\frac{-1 \\pm \\sqrt{1-4(1)(-r^{2})}}{2} = \\frac{-1 \\pm \\sqrt{1+4r^{2}}}{2} $$\n因为 $a$ 是实数，$a^{2}$ 必须为正。我们取正根：\n$$ a^{2} = \\frac{\\sqrt{1+4r^{2}}-1}{2} \\implies a = \\sqrt{\\frac{\\sqrt{1+4r^{2}}-1}{2}} $$\n同样，$b^{2} = a^{2}+1$：\n$$ b^{2} = \\frac{\\sqrt{1+4r^{2}}+1}{2} \\implies b = \\sqrt{\\frac{\\sqrt{1+4r^{2}}+1}{2}} $$\n现在我们计算 $\\frac{r+i}{a+ib}$ 的实部：\n$$ \\Re\\left(\\frac{(r+i)(a-ib)}{a^{2}+b^{2}}\\right) = \\frac{ra+b}{a^{2}+b^{2}} $$\n分母是 $a^{2}+b^{2} = \\frac{\\sqrt{1+4r^{2}}-1}{2} + \\frac{\\sqrt{1+4r^{2}}+1}{2} = \\sqrt{1+4r^{2}}$。\n所以，我们有：\n$$ \\frac{N_{s}(\\Delta,\\Gamma)}{N_{0}} = \\frac{ra+b}{\\sqrt{1+4r^{2}}} = \\frac{r\\sqrt{\\frac{\\sqrt{1+4r^{2}}-1}{2}} + \\sqrt{\\frac{\\sqrt{1+4r^{2}}+1}{2}}}{\\sqrt{1+4r^{2}}} $$\n代入 $r=15$：\n$$ \\sqrt{1+4(15)^{2}} = \\sqrt{1+4(225)} = \\sqrt{901} $$\n表达式变为：\n$$ \\frac{N_{s}}{N_{0}} = \\frac{15\\sqrt{\\frac{\\sqrt{901}-1}{2}} + \\sqrt{\\frac{\\sqrt{901}+1}{2}}}{\\sqrt{901}} $$\n数值计算：\n$$ \\sqrt{901} \\approx 30.016662 $$\n$$ a = \\sqrt{\\frac{30.016662-1}{2}} = \\sqrt{14.508331} \\approx 3.808980 $$\n$$ b = \\sqrt{\\frac{30.016662+1}{2}} = \\sqrt{15.508331} \\approx 3.938062 $$\n分子是 $15a+b \\approx 15(3.808980) + 3.938062 = 57.134700 + 3.938062 = 61.072762$。\n值为 $\\frac{61.072762}{30.016662} \\approx 2.034615$。\n四舍五入到四位有效数字得到 $2.035$。", "answer": "$$\\boxed{2.035}$$", "id": "2802562"}, {"introduction": "对于许多材料，特别是强耦合超导体，BCS理论的近似不再适用。这个高级计算练习将指导你求解作为BCS理论严格推广的 Eliashberg 方程。通过直接处理一个模型的电子-声子谱函数 $\\alpha^2 F(\\omega)$，你将实现一个数值求解过程，该过程反映了现代研究中用于从微观相互作用定量预测超导性质的方法。[@problem_id:2802515]", "problem": "您的任务是编写一个完整、可运行的程序，该程序使用虚轴各向同性 Eliashberg 理论，从隧穿实验导出的电子-声子谱函数 $\\alpha^2 F(\\omega)$ 计算零温下的超导能隙 $\\Delta_0$。该方法必须基于已公认的基础：Matsubara 轴上的 Migdal-Eliashberg 方程。您的程序必须将虚频轴离散化，求解质量重整化函数和配对自能的耦合自洽方程，然后在低但有限的温度下提取 $\\Delta_0$ 的近似值。最后，您必须将计算出的 $\\Delta_0$ 与为每个测试用例提供的实验值进行比较。\n\n待使用的基本原理和定义：\n- Matsubara 费米子频率为 $\\omega_n = \\pi k_{\\mathrm{B}} T (2n+1)$，其中 $T$ 是温度，$k_{\\mathrm{B}}$ 是 Boltzmann 常数。\n- 质量重整化函数 $Z(i\\omega_n)$ 和配对自能 $\\phi(i\\omega_n)$ 的各向同性虚轴 Eliashberg 方程为\n$$\nZ(i\\omega_n) = 1 + \\frac{\\pi k_{\\mathrm{B}} T}{\\omega_n} \\sum_{m=0}^{N-1} \\lambda(i\\omega_n - i\\omega_m)\\,\\frac{\\omega_m}{\\sqrt{\\omega_m^2 + \\Delta_m^2}},\n$$\n$$\n\\phi(i\\omega_n) = \\pi k_{\\mathrm{B}} T \\sum_{m=0}^{N-1} \\left[\\lambda(i\\omega_n - i\\omega_m) - \\mu^\\ast\\,\\Theta(\\omega_{\\mu c} - |\\omega_m|)\\right] \\frac{\\Delta_m}{\\sqrt{\\omega_m^2 + \\Delta_m^2}},\n$$\n其中 $\\Delta_n = \\phi(i\\omega_n)/Z(i\\omega_n)$，并且 $\\Theta$ 是 Heaviside 阶跃函数，$\\mu^\\ast$ 是库仑赝势，$\\omega_{\\mu c}$ 是库仑排斥的高能截断。\n- 虚轴上的电子-声子核通过谱函数由以下公式获得\n$$\n\\lambda(i\\nu) = 2 \\int_0^{\\infty} d\\Omega \\, \\alpha^2 F(\\Omega)\\, \\frac{\\Omega}{\\Omega^2 + \\nu^2},\n$$\n其中 $\\nu$ 是一个玻色子 Matsubara 频率差，此处取为连续的虚频差 $\\nu = \\omega_n - \\omega_m$。\n- 无量纲耦合常数为\n$$\n\\lambda = 2 \\int_0^\\infty d\\Omega \\, \\frac{\\alpha^2 F(\\Omega)}{\\Omega}.\n$$\n\n算法要求：\n- 使用毫电子伏特作为能量单位，因此所有能量，包括 $\\omega$、$\\Omega$ 和 $\\Delta$，都必须以 $\\mathrm{meV}$ 为单位。温度使用开尔文。使用 $k_{\\mathrm{B}} = 0.08617333262\\,\\mathrm{meV/K}$。\n- 使用一个固定的低温 $T = 3.0\\,\\mathrm{K}$，通过最低 Matsubara 频率值 $\\Delta(i\\omega_0)$ 来近似 $\\Delta_0$，即报告 $\\Delta_0 \\approx \\Delta(i\\omega_0)$（以 $\\mathrm{meV}$ 为单位）。\n- 用 $N$ 个频率离散化 Matsubara 轴，其中 $N = 120$，使得对于 $n = 0,1,\\dots,N-1$，有 $\\omega_n = \\pi k_{\\mathrm{B}} T (2n+1)$。\n- 将 $\\alpha^2 F(\\Omega)$ 表示为高斯模的有限和：\n$$\n\\alpha^2 F(\\Omega) = \\sum_{j=1}^{M_{\\text{modes}}} A_j \\frac{1}{\\sigma_j \\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\Omega - \\Omega_j)^2}{2\\sigma_j^2}\\right),\n$$\n其中振幅 $A_j$、中心 $\\Omega_j$ 和宽度 $\\sigma_j$ 均以 $\\mathrm{meV}$ 为单位。\n- 使用梯形法则，在一个均匀频率网格 $\\Omega \\in [0,\\Omega_{\\max}]$ 上（$\\Omega_{\\max} = 60.0\\,\\mathrm{meV}$，300个网格点）通过计算积分来数值计算核 $\\lambda(i\\nu)$。使用被积函数 $2\\,\\alpha^2 F(\\Omega)\\,\\Omega/(\\Omega^2 + \\nu^2)$。\n- 使用库仑赝势 $\\mu^\\ast$ 和库仑截断 $\\omega_{\\mu c} = 3\\,\\Omega_{\\max}$，两者均在下方的每个测试用例中指定。\n- 通过带线性混合的不动点迭代法求解自洽问题，直到收敛。当所有 $n$ 的 $\\Delta_n$ 的最大绝对变化小于 $10^{-5}\\,\\mathrm{meV}$，或达到 150 次迭代的最大次数时，即达到收敛。用一个小的常数 $\\Delta_n = 10^{-3}\\,\\mathrm{meV}$ 和 $Z_n = 1$ 进行初始化。\n- 收敛后，报告 $\\Delta_0 \\equiv \\Delta(i\\omega_0)$ 的值（以 $\\mathrm{meV}$ 为单位）。\n\n测试套件：\n为以下三个测试用例实现求解器。对于每个用例，程序必须计算数值解，并将其与提供的实验值 $\\Delta_0^{\\text{(exp)}}$（以 $\\mathrm{meV}$ 为单位）进行比较，最后报告绝对偏差 $|\\Delta_0 - \\Delta_0^{\\text{(exp)}}|$。\n\n- 案例 1（单模中等耦合）：\n  - 模：$M_{\\text{modes}} = 1$，其中 $(\\Omega_1,\\sigma_1,A_1) = (15.0, 1.5, 6.0)$，单位为 $\\mathrm{meV}$。\n  - 库仑赝势：$\\mu^\\ast = 0.13$。\n  - 实验能隙：$\\Delta_0^{\\text{(exp)}} = 1.00\\,\\mathrm{meV}$。\n- 案例 2（双模强耦合）：\n  - 模：$M_{\\text{modes}} = 2$，其中 $(\\Omega_1,\\sigma_1,A_1) = (8.0, 1.0, 3.5)$ 和 $(\\Omega_2,\\sigma_2,A_2) = (20.0, 2.0, 4.0)$，单位为 $\\mathrm{meV}$。\n  - 库仑赝势：$\\mu^\\ast = 0.10$。\n  - 实验能隙：$\\Delta_0^{\\text{(exp)}} = 2.00\\,\\mathrm{meV}$。\n- 案例 3（接近正常态且温度为 $T = 3.0\\,\\mathrm{K}$ 的单模弱耦合）：\n  - 模：$M_{\\text{modes}} = 1$，其中 $(\\Omega_1,\\sigma_1,A_1) = (10.0, 1.5, 1.2)$，单位为 $\\mathrm{meV}$。\n  - 库仑赝势：$\\mu^\\ast = 0.12$。\n  - 实验能隙：$\\Delta_0^{\\text{(exp)}} = 0.00\\,\\mathrm{meV}$。\n\n最终输出要求：\n- 您的程序必须输出单行，其中包含一个列表，列表内是案例1、2和3的绝对偏差（单位为 $\\mathrm{meV}$）。这三个浮点数分别对应三个案例，每个数都四舍五入到三位小数。\n- 输出的格式必须完全符合 Python 列表字面量的形式，使用逗号分隔值且没有多余的空格，例如：$[0.123,0.456,0.789]$。\n\n角度单位不适用。所有待输出的物理量都必须按规定以 $\\mathrm{meV}$ 表示。不使用百分比；如果计算任何比率，请保持其小数形式。\n\n您的实现必须是通用的，并且不得依赖任何预先计算的捷径或超导能隙的闭合形式表达式；它必须直接实现上述指定的虚轴各向同性 Eliashberg 方程，包括数值积分和迭代自洽过程。", "solution": "问题已被分析并确定为有效。它提出了一个计算凝聚态物理学中定义明确的任务，该任务基于已确立的 Migdal-Eliashberg 超导理论。所提供的方程、参数和数值要求是自洽的、科学上合理的，并且足以构建一个唯一的解。\n\n问题陈述中关于高斯振幅 $A_j$ 的单位存在一个微小的不精确之处。它指出元组 $(\\Omega_j, \\sigma_j, A_j)$ 的单位是 $\\mathrm{meV}$。为使控制方程在量纲上保持一致，特别是对于无量纲耦合常数 $\\lambda = 2 \\int_0^\\infty d\\Omega \\, \\frac{\\alpha^2 F(\\Omega)}{\\Omega}$ 和质量重整化函数 $Z$，谱函数 $\\alpha^2 F(\\Omega)$ 以及因此的振幅 $A_j$ 必须是无量纲的。唯一合乎逻辑的解释是，单位说明仅适用于能量参数 $\\Omega_j$ 和 $\\sigma_j$。解答在此必要澄清下进行。\n\n任务是求解各向同性虚轴 Eliashberg 方程，以找到零温下的超导能隙 $\\Delta_0$。我们将通过计算低有限温度 $T = 3.0\\,\\mathrm{K}$ 下的能隙，并取最低 Matsubara 频率处的值来近似，即 $\\Delta_0 \\approx \\Delta(i\\omega_0)$。解决方案通过以下系统步骤构建，并严格遵守所提供的物理和数值框架。\n\n**1. 理论框架与离散化**\n\n其基础是在离散的费米子 Matsubara 频率轴 $\\omega_n = \\pi k_{\\mathrm{B}} T (2n+1)$（$n=0, 1, \\dots, N-1$）上，关于质量重整化函数 $Z(i\\omega_n)$ 和配对自能 $\\phi(i\\omega_n)$ 的耦合非线性方程组。这些方程是：\n$$\nZ_n \\equiv Z(i\\omega_n) = 1 + \\frac{\\pi k_{\\mathrm{B}} T}{\\omega_n} \\sum_{m=0}^{N-1} \\lambda_{nm} \\frac{\\omega_m}{\\sqrt{\\omega_m^2 + \\Delta_m^2}}\n$$\n$$\n\\phi_n \\equiv \\phi(i\\omega_n) = \\pi k_{\\mathrm{B}} T \\sum_{m=0}^{N-1} \\left[\\lambda_{nm} - \\mu^\\ast\\,\\Theta(\\omega_{\\mu c} - \\omega_m)\\right] \\frac{\\Delta_m}{\\sqrt{\\omega_m^2 + \\Delta_m^2}}\n$$\n此处，超导能隙由 $\\Delta_n = \\phi_n / Z_n$ 给出。项 $\\lambda_{nm} = \\lambda(i(\\omega_n - \\omega_m))$ 是在玻色子频率差 $\\nu_{nm} = \\omega_n - \\omega_m$ 处求值的电子-声子相互作用核。库仑排斥由赝势 $\\mu^\\ast$ 和截断能 $\\omega_{\\mu c}$ 描述。\n\n**2. 电子-声子相互作用核的计算**\n\n核 $\\lambda(i\\nu)$ 是从电子-声子谱函数 $\\alpha^2 F(\\Omega)$ 通过以下关系式导出的：\n$$\n\\lambda(i\\nu) = 2 \\int_0^{\\infty} d\\Omega \\, \\alpha^2 F(\\Omega)\\, \\frac{\\Omega}{\\Omega^2 + \\nu^2}\n$$\n函数 $\\alpha^2 F(\\Omega)$ 以高斯模之和的形式提供。该积分按照规定，使用梯形法则在声子频率的离散网格 $\\Omega \\in [0, \\Omega_{\\max}]$ 上进行数值计算。由于核仅依赖于 Matsubara 频率之间的差值，我们预先计算并存储一个将在迭代求解器中使用的 $N \\times N$ 矩阵 $\\lambda_{nm}$。\n\n**3. 自洽迭代解**\n\n该耦合方程组构成一个非线性系统，使用不动点迭代法求解。算法如下：\n- 初始化能隙数组 $\\Delta_n$ 为一个小的非零值（例如 $10^{-3}\\,\\mathrm{meV}$），并将重整化数组 $Z_n$ 初始化为1。\n- 在每次迭代中，使用 $\\Delta_n$ 和 $\\omega_n$ 的当前值计算新值 $Z_n^{\\text{new}}$ 和 $\\phi_n^{\\text{new}}$ 的求和项。这些求和可以高效地实现为矩阵-向量乘积。\n- 新的能隙数组计算为 $\\Delta_n^{\\text{new}} = \\phi_n^{\\text{new}} / Z_n^{\\text{new}}$。\n- 为确保稳定收敛并防止振荡，采用线性混合。下一次迭代的更新能隙数组是旧值和新计算值的加权平均：$\\Delta^{\\text{next}} = \\alpha \\Delta^{\\text{new}} + (1-\\alpha) \\Delta^{\\text{old}}$，其中 $\\alpha$ 是一个混合参数（这里选用标准值0.5）。重整化函数 $Z_n$ 不进行混合，直接更新为 $Z_n^{\\text{new}}$。\n- 重复此过程，直到 $\\Delta_n$ 数组中任意元素在连续迭代间的最大绝对变化降至指定的容差 $10^{-5}\\,\\mathrm{meV}$ 以下，或者达到最大迭代次数。\n\n**4. 最终结果提取与比较**\n\n收敛后，数组 $\\Delta_n$ 包含每个 Matsubara 频率下超导能隙的自洽值。零温能隙 $\\Delta_0$ 由最低 Matsubara 频率处的值近似，即 $\\Delta_0 \\approx \\Delta(i\\omega_0) = \\Delta_0$。对于每个测试用例，将此数值计算值与提供的实验值 $\\Delta_0^{\\text{(exp)}}$ 进行比较，以求得绝对偏差 $|\\Delta_0 - \\Delta_0^{\\text{(exp)}}|$。程序会汇总所有测试用例的这些偏差，并按要求格式化结果。对于物理状态为正常态（$T > T_c$）的情况，迭代会收敛到 $\\Delta_n \\approx 0$，这种情况会被正确处理。\n\n所提供的程序实现了这整个过程，将 Eliashberg 理论的物理原理封装在一个稳健的数值结构中。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_eliashberg(modes, mu_star):\n    \"\"\"\n    Solves the isotropic Eliashberg equations on the imaginary axis.\n    \n    Args:\n        modes (list of tuples): Parameters for Gaussian modes of alpha^2 F(Omega).\n                               Each tuple is (Omega_j, sigma_j, A_j).\n        mu_star (float): The Coulomb pseudopotential.\n\n    Returns:\n        float: The calculated superconducting gap Delta_0 in meV.\n    \"\"\"\n    # 1. Constants and Parameters from the problem statement\n    KB = 0.08617333262  # meV/K\n    T = 3.0  # K\n    N = 120  # Number of Matsubara frequencies\n    MAX_ITER = 150\n    TOLERANCE = 1e-5\n    MIXING_ALPHA = 0.5\n\n    OMEGA_MAX = 60.0  # meV\n    N_OMEGA_GRID = 300\n    \n    OMEGA_MU_C = 3.0 * OMEGA_MAX\n\n    # 2. Define Grids\n    # Matsubara frequency grid (fermionic)\n    n_indices = np.arange(N)\n    omega_n = np.pi * KB * T * (2 * n_indices + 1)\n    \n    # Integration grid for the kernel (bosonic)\n    omega_integration_grid, d_omega = np.linspace(0, OMEGA_MAX, N_OMEGA_GRID, retstep=True)\n\n    # 3. Define Electron-Phonon Spectral Function alpha^2 F(Omega)\n    def alpha_squared_F(Omega, modes_params):\n        # As noted in the solution, for dimensional consistency, amplitude A_j\n        # must be dimensionless. The problem statement's unit assignment is interpreted\n        # as applying only to the energy parameters.\n        a2F = np.zeros_like(Omega)\n        for params in modes_params:\n            Omega_j, sigma_j, A_j = params\n            if sigma_j > 1e-9: # Avoid division by zero\n                norm_factor = 1.0 / (sigma_j * np.sqrt(2 * np.pi))\n                gaussian = norm_factor * np.exp(-((Omega - Omega_j)**2) / (2 * sigma_j**2))\n                a2F += A_j * gaussian\n        return a2F\n\n    # 4. Pre-compute Electron-Phonon Kernel lambda(i(omega_n - omega_m))\n    lambda_matrix = np.zeros((N, N))\n    a2F_values = alpha_squared_F(omega_integration_grid, modes)\n    \n    for n in range(N):\n        for m in range(N):\n            nu_sq = (omega_n[n] - omega_n[m])**2\n            integrand = 2 * a2F_values * omega_integration_grid / (omega_integration_grid**2 + nu_sq)\n            # Using numpy.trapz for trapezoidal integration\n            lambda_matrix[n, m] = np.trapz(integrand, x=omega_integration_grid)\n    \n    # 5. Iteratively Solve the Self-Consistency Equations\n    # Initialization\n    Z = np.ones(N)\n    Delta = np.full(N, 1e-3) # Small initial superconducting gap\n\n    # Pre-calculate the kernel for the phi equation\n    mu_star_cutoff_mask = (omega_n  OMEGA_MU_C).astype(float)\n    mu_star_term_matrix = np.outer(np.ones(N), mu_star * mu_star_cutoff_mask) # Shape (N, N)\n    phi_kernel = lambda_matrix - mu_star_term_matrix\n\n    for _ in range(MAX_ITER):\n        Delta_old = np.copy(Delta)\n        \n        # Common denominator term in the sums\n        sqrt_term = np.sqrt(omega_n**2 + Delta**2)\n        \n        # Vectors to be summed over m, for each n\n        Z_sum_vector = omega_n / sqrt_term\n        phi_sum_vector = Delta / sqrt_term\n        \n        # Update Z using matrix-vector product for the sum\n        Z_sum = lambda_matrix @ Z_sum_vector\n        Z_new = 1.0 + (np.pi * KB * T / omega_n) * Z_sum\n        \n        # Update phi using matrix-vector product for the sum\n        phi_sum = phi_kernel @ phi_sum_vector\n        phi_new = np.pi * KB * T * phi_sum\n        \n        # Update Delta\n        Delta_new = phi_new / Z_new\n\n        # Apply linear mixing for stable convergence\n        Delta = MIXING_ALPHA * Delta_new + (1.0 - MIXING_ALPHA) * Delta\n        Z = Z_new # Z follows Delta, no mixing needed\n\n        # Check for convergence\n        max_change = np.max(np.abs(Delta - Delta_old))\n        if max_change  TOLERANCE:\n            break\n\n    # 6. Extract Final Result\n    # Approximate Delta_0 by the value at the lowest Matsubara frequency\n    delta_0_calc = Delta[0]\n    \n    # For normal state solutions, numerics can lead to small negative values.\n    # The physical gap must be non-negative.\n    return max(0.0, delta_0_calc)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (single-mode moderate coupling)\n        {\n            \"modes\": [(15.0, 1.5, 6.0)],\n            \"mu_star\": 0.13,\n            \"exp_gap\": 1.00\n        },\n        # Case 2 (two-mode stronger coupling)\n        {\n            \"modes\": [(8.0, 1.0, 3.5), (20.0, 2.0, 4.0)],\n            \"mu_star\": 0.10,\n            \"exp_gap\": 2.00\n        },\n        # Case 3 (single-mode weak coupling near normal state)\n        {\n            \"modes\": [(10.0, 1.5, 1.2)],\n            \"mu_star\": 0.12,\n            \"exp_gap\": 0.00\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        calculated_gap = solve_eliashberg(case[\"modes\"], case[\"mu_star\"])\n        deviation = abs(calculated_gap - case[\"exp_gap\"])\n        results.append(deviation)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{r:.3f}' for r in results])}]\")\n\nsolve()\n```", "id": "2802515"}]}