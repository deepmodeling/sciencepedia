{"hands_on_practices": [{"introduction": "理论学习了复介电函数和复折射率如何描述材料的光学响应，但我们如何将这些抽象概念与可测量的物理量联系起来？此练习将引导您从麦克斯韦方程组和基本的 Drude 模型出发，推导出吸收系数 $\\alpha$ 和趋肤深度 $\\delta$。这项实践将巩固您对电磁波在导电介质中衰减的物理图像的理解，并锻炼您从第一性原理出发解决问题的能力。[@problem_id:2810175]", "problem": "一种均匀、各向同性、非磁性金属由局域Drude介电函数描述。一束自由空间波长为 $\\lambda_{0} = 600\\,\\text{nm}$ 的单色平面波在真空中正入射到该金属上。该金属的高频介电常数为 $\\varepsilon_{\\infty} = 1$，等离子体频率为 $\\omega_{p} = 9.00 \\times 10^{15}\\,\\text{s}^{-1}$，阻尼率为 $\\gamma = 1.00 \\times 10^{14}\\,\\text{s}^{-1}$。介电函数为\n$$\n\\varepsilon(\\omega) = \\varepsilon_{\\infty} - \\frac{\\omega_{p}^{2}}{\\omega^{2} + i \\gamma \\omega}.\n$$\n从物质中的Maxwell方程组、本构关系 $\\mathbf{D} = \\varepsilon_{0}\\varepsilon(\\omega)\\mathbf{E}$ 和 $\\mathbf{B} = \\mu_{0}\\mathbf{H}$，以及均匀介质中的平面波拟设出发，首先推导连接复介电函数 $\\varepsilon(\\omega)$ 与复折射率 $\\tilde{n} = n + i \\kappa$ 的关系，然后推导连接消光系数 $\\kappa$ 与吸收系数 $\\alpha$ 的关系。吸收系数由金属内部的强度衰减 $I(z) = I_{0} \\exp(-\\alpha z)$ 定义。利用这些关系计算强度趋肤深度 $\\delta$，其定义为强度下降至其表面值的 $1/e$ 时所经过的距离，即 $\\delta = 1/\\alpha$。\n\n取真空中的光速为 $c = 2.99792458 \\times 10^{8}\\,\\text{m}\\,\\text{s}^{-1}$，并假设选择平方根的主支以保证 $\\kappa \\ge 0$。以纳米为单位表示 $\\delta$ 的最终值，并将答案四舍五入到三位有效数字。", "solution": "该问题要求推导金属光学中的基本关系，并随后计算强度趋肤深度。分析将从第一性原理，即Maxwell方程组开始。\n\n在没有自由电荷或自由电流的均匀、各向同性、线性、非磁性介质中，Maxwell方程组为：\n$$\n\\nabla \\cdot \\mathbf{D} = 0\n$$\n$$\n\\nabla \\cdot \\mathbf{B} = 0\n$$\n$$\n\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n$$\n\\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t}\n$$\n本构关系为 $\\mathbf{D} = \\varepsilon_{0}\\varepsilon(\\omega)\\mathbf{E}$ 和 $\\mathbf{B} = \\mu_{0}\\mathbf{H}$。对于非磁性介质，相对磁导率 $\\mu_r$ 为 $1$。\n\n为了推导电场 $\\mathbf{E}$ 的波动方程，我们对第三个Maxwell方程（Faraday定律）取旋度：\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{E}) = -\\frac{\\partial}{\\partial t}(\\nabla \\times \\mathbf{B})\n$$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$，左侧变为 $\\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2 \\mathbf{E}$。由 $\\nabla \\cdot \\mathbf{D} = 0$ 和介质的均匀性（因此 $\\varepsilon$ 不是位置的函数），我们有 $\\varepsilon_{0}\\varepsilon(\\omega)(\\nabla \\cdot \\mathbf{E}) = 0$，这意味着 $\\nabla \\cdot \\mathbf{E} = 0$。因此，波动方程简化为：\n$$\n-\\nabla^2 \\mathbf{E} = -\\frac{\\partial}{\\partial t}(\\nabla \\times \\mathbf{B})\n$$\n代入 $\\mathbf{B} = \\mu_0 \\mathbf{H}$，然后代入第四个Maxwell方程（Ampere定律），得到：\n$$\n-\\nabla^2 \\mathbf{E} = -\\mu_0 \\frac{\\partial}{\\partial t}\\left(\\frac{\\partial \\mathbf{D}}{\\partial t}\\right) = -\\mu_0 \\frac{\\partial^2 \\mathbf{D}}{\\partial t^2}\n$$\n最后，代入 $\\mathbf{D}$ 的本构关系：\n$$\n\\nabla^2 \\mathbf{E} = \\mu_0 \\varepsilon_0 \\varepsilon(\\omega) \\frac{\\partial^2 \\mathbf{E}}{\\partial t^2}\n$$\n我们考虑一个沿 $z$ 方向传播的单色平面波解：\n$$\n\\mathbf{E}(\\mathbf{r}, t) = \\mathbf{E}_0 \\exp(i(\\tilde{k}z - \\omega t))\n$$\n其中 $\\tilde{k}$ 是介质中的复波矢。将此拟设代入波动方程，我们发现其导数为 $\\nabla^2 \\mathbf{E} = -\\tilde{k}^2 \\mathbf{E}$ 和 $\\frac{\\partial^2 \\mathbf{E}}{\\partial t^2} = -\\omega^2 \\mathbf{E}$。这导出了色散关系：\n$$\n-\\tilde{k}^2 \\mathbf{E} = \\mu_0 \\varepsilon_0 \\varepsilon(\\omega) (-\\omega^2 \\mathbf{E})\n$$\n$$\n\\tilde{k}^2 = \\omega^2 \\mu_0 \\varepsilon_0 \\varepsilon(\\omega)\n$$\n使用真空中光速的关系式 $c = 1/\\sqrt{\\mu_0 \\varepsilon_0}$，色散关系变为：\n$$\n\\tilde{k}^2 = \\frac{\\omega^2}{c^2} \\varepsilon(\\omega)\n$$\n复折射率 $\\tilde{n} = n + i \\kappa$ 由关系式 $\\tilde{k} = \\tilde{n}\\frac{\\omega}{c}$ 定义。将此定义代入色散关系，得到：\n$$\n\\left(\\tilde{n}\\frac{\\omega}{c}\\right)^2 = \\frac{\\omega^2}{c^2} \\varepsilon(\\omega)\n$$\n这简化为第一个所求的关系式：\n$$\n\\tilde{n}^2 = \\varepsilon(\\omega)\n$$\n展开后得到 $(n + i\\kappa)^2 = \\varepsilon(\\omega) = \\varepsilon_1 + i\\varepsilon_2$，其中 $\\varepsilon_1$ 和 $\\varepsilon_2$ 分别是介电函数的实部和虚部。\n\n接下来，我们建立消光系数 $\\kappa$ 和吸收系数 $\\alpha$ 之间的联系。电场的空间依赖性由项 $\\exp(i\\tilde{k}z)$ 给出。代入 $\\tilde{k} = (n + i\\kappa)\\frac{\\omega}{c}$：\n$$\n\\exp(i\\tilde{k}z) = \\exp\\left(i(n + i\\kappa)\\frac{\\omega}{c}z\\right) = \\exp\\left(-\\kappa\\frac{\\omega}{c}z\\right)\\exp\\left(in\\frac{\\omega}{c}z\\right)\n$$\n波的强度 $I(z)$ 与电场振幅的平方成正比，因此其空间衰减遵循：\n$$\nI(z) \\propto |E_0 \\exp(i\\tilde{k}z)|^2 \\propto \\left|\\exp\\left(-\\kappa\\frac{\\omega}{c}z\\right)\\right|^2 = \\exp\\left(-2\\kappa\\frac{\\omega}{c}z\\right)\n$$\n因此，$I(z) = I_0 \\exp\\left(-2\\kappa\\frac{\\omega}{c}z\\right)$。与题目给出的定义 $I(z) = I_0 \\exp(-\\alpha z)$ 比较，我们确定吸收系数为：\n$$\n\\alpha = 2\\kappa\\frac{\\omega}{c}\n$$\n这是第二个所求的关系式。强度趋肤深度为 $\\delta = 1/\\alpha$。利用 $\\omega/c = 2\\pi/\\lambda_0$，我们也可以写出 $\\alpha = 4\\pi\\kappa/\\lambda_0$，这给出 $\\delta = \\lambda_0/(4\\pi\\kappa)$。\n\n现在，我们进行数值计算。\n入射光的角频率为：\n$$\n\\omega = \\frac{2\\pi c}{\\lambda_0} = \\frac{2\\pi (2.99792458 \\times 10^{8}\\,\\text{m}\\,\\text{s}^{-1})}{600 \\times 10^{-9}\\,\\text{m}} \\approx 3.1395 \\times 10^{15}\\,\\text{s}^{-1}\n$$\n复介电函数为 $\\varepsilon(\\omega) = \\varepsilon_{\\infty} - \\frac{\\omega_{p}^{2}}{\\omega^{2} + i \\gamma \\omega}$。根据给定的参数 $\\varepsilon_{\\infty} = 1$，$\\omega_{p} = 9.00 \\times 10^{15}\\,\\text{s}^{-1}$，以及 $\\gamma = 1.00 \\times 10^{14}\\,\\text{s}^{-1}$：\n$$\n\\omega^2 \\approx (3.1395 \\times 10^{15})^2 \\approx 9.8566 \\times 10^{30}\\,\\text{s}^{-2}\n$$\n$$\ni \\gamma \\omega \\approx i (1.00 \\times 10^{14}) (3.1395 \\times 10^{15}) = i(0.3140 \\times 10^{30})\\,\\text{s}^{-2}\n$$\n$$\n\\omega_p^2 = (9.00 \\times 10^{15})^2 = 81.0 \\times 10^{30}\\,\\text{s}^{-2}\n$$\n所以，\n$$\n\\varepsilon(\\omega) = 1 - \\frac{81.0 \\times 10^{30}}{9.8566 \\times 10^{30} + i(0.3140 \\times 10^{30})} = 1 - \\frac{81.0}{9.8566 + i(0.3140)}\n$$\n将分式的分母有理化：\n$$\n\\frac{81.0}{9.8566 + i(0.3140)} = \\frac{81.0(9.8566 - i(0.3140))}{9.8566^2 + 0.3140^2} = \\frac{798.38 - i(25.43)}{97.15 + 0.0986} \\approx \\frac{798.38 - i(25.43)}{97.25} \\approx 8.2096 - i(0.2615)\n$$\n因此，介电函数为：\n$$\n\\varepsilon(\\omega) \\approx 1 - (8.2096 - i(0.2615)) = -7.2096 + i(0.2615)\n$$\n我们确定实部和虚部分别为 $\\varepsilon_1 = -7.2096$ 和 $\\varepsilon_2 = 0.2615$。\n根据关系式 $\\tilde{n}^2 = \\varepsilon$，我们有 $(n + i\\kappa)^2 = \\varepsilon_1 + i\\varepsilon_2$，这导出方程组 $n^2 - \\kappa^2 = \\varepsilon_1$ 和 $2n\\kappa = \\varepsilon_2$。解出 $\\kappa^2$ 得到：\n$$\n\\kappa^2 = \\frac{1}{2}\\left(\\sqrt{\\varepsilon_1^2 + \\varepsilon_2^2} - \\varepsilon_1\\right)\n$$\n我们计算必要的量：\n$$\n\\varepsilon_1^2 + \\varepsilon_2^2 \\approx (-7.2096)^2 + (0.2615)^2 \\approx 51.978 + 0.0684 \\approx 52.046\n$$\n$$\n\\sqrt{\\varepsilon_1^2 + \\varepsilon_2^2} \\approx \\sqrt{52.046} \\approx 7.2143\n$$\n现在，我们求 $\\kappa^2$：\n$$\n\\kappa^2 \\approx \\frac{1}{2}(7.2143 - (-7.2096)) = \\frac{1}{2}(14.4239) \\approx 7.2120\n$$\n消光系数 $\\kappa$ 是正平方根：\n$$\n\\kappa = \\sqrt{7.2120} \\approx 2.6855\n$$\n现在我们计算吸收系数 $\\alpha$：\n$$\n\\alpha = \\frac{4\\pi\\kappa}{\\lambda_0} = \\frac{4\\pi(2.6855)}{600 \\times 10^{-9}\\,\\text{m}} \\approx \\frac{33.748}{600 \\times 10^{-9}\\,\\text{m}} \\approx 5.6247 \\times 10^7\\,\\text{m}^{-1}\n$$\n最后，强度趋肤深度 $\\delta$ 是 $\\alpha$ 的倒数：\n$$\n\\delta = \\frac{1}{\\alpha} \\approx \\frac{1}{5.6247 \\times 10^7\\,\\text{m}^{-1}} \\approx 1.7779 \\times 10^{-8}\\,\\text{m}\n$$\n为了以纳米表示，我们乘以 $10^9$：\n$$\n\\delta \\approx 1.7779 \\times 10^{-8}\\,\\text{m} \\times (10^9\\,\\text{nm}/\\text{m}) = 17.779\\,\\text{nm}\n$$\n四舍五入到三位有效数字，最终结果是 $17.8\\,\\text{nm}$。", "answer": "$$\n\\boxed{17.8}\n$$", "id": "2810175"}, {"introduction": "掌握了光在单一介质中的传播行为后，下一个关键问题是光在不同介质界面处的行为。当其中一种介质是耗散性的（即有吸收），情况会变得更加微妙和有趣。本练习将深入探讨 p 偏振光在有损介质界面上的反射，并挑战您去思考为何在这种情况下不存在完美的布鲁斯特角和全内反射。通过从菲涅尔方程出发进行严谨的分析，您将对耗散效应如何从根本上改变光学现象有更深刻的认识。[@problem_id:2810155]", "problem": "位于$z<0$区域、折射率为实数$n_{1}$的非磁性介质中的一束单色平面波，入射到$z>0$区域一个耗散性、非磁性介质的平面界面上。第二种介质的复折射率为$\\tilde{n}_{2}=n_{2}^{\\prime}+i\\,\\kappa_{2}$，其中$n_{2}^{\\prime}>0$且$\\kappa_{2}>0$。其复相对介电函数为$\\varepsilon_{2}=\\tilde{n}_{2}^{2}$，而第一种介质的介电函数为$\\varepsilon_{1}=n_{1}^{2}$。假设两种介质的磁导率均为常数、与频率无关且等于真空磁导率，即$\\mu_{1}=\\mu_{2}=\\mu_{0}$，时间依赖关系为$\\exp(-i\\omega t)$。设入射面为$x$-$z$平面，入射角为$\\theta_{1}\\in(0,\\pi/2)$，从界面法线量起。\n\n从麦克斯韦方程组、复折射率和介电函数的定义，以及平面界面上的电磁边界条件出发，对$p$偏振（平行）入射情况完成以下任务：\n\n1) 推导菲涅耳反射振幅$r_{p}$，用$\\varepsilon_{1}$、$\\varepsilon_{2}$、$n_{1}$、$\\tilde{n}_{2}$以及纵向波矢分量表示，或等效地用受复数斯涅耳关系$n_{1}\\sin\\theta_{1}=\\tilde{n}_{2}\\sin\\theta_{2}$约束的入射角$\\theta_{1}$和折射角$\\theta_{2}$表示。表达$r_{p}$时，应使其到复数$\\theta_{2}$的解析延拓显而易见。\n\n2) 利用(1)中的结果和无源条件$\\operatorname{Im}(\\varepsilon_{2})>0$，仔细论证当$\\kappa_{2}>0$时，是否存在任何实数入射角$\\theta_{1}$，使得$p$偏振反射率$R_{p}=|r_{p}|^{2}$为零（布儒斯特条件）。你的论证不应假设任何现成的“有损介质中的布儒斯特角”公式；应从阻抗匹配或$r_{p}$的结构和边界条件出发进行推理。\n\n3) 讨论在有损耗的情况下$p$偏振的全内反射（TIR）概念，对比无损耗情况（$\\kappa_{2}=0$）和有损耗情况（$\\kappa_{2}>0$）。使用你得到的$r_{p}$表达式和复数角度的斯涅耳关系，解释为什么当$\\kappa_{2}>0$时，即使$\\operatorname{Re}(\\tilde{n}_{2})<n_{1}$，也不会发生完美的TIR（即对于某个实数$\\theta_{1}$区间，$r_{p}$的模为1）。\n\n4) 现在，考虑$n_{1}=1.50$和$\\tilde{n}_{2}=2.10+i\\,0.12$的特定情况。使用可控的小损耗分析，证明使$R_{p}$最小化的入射角$\\theta_{1}$与无损耗布儒斯特角$\\theta_{B,0}$之间的差异仅在$\\kappa_{2}$的二阶。因此，在$\\kappa_{2}$的主导阶上，这个最小化角度就是通过设置$\\kappa_{2}=0$得到的无损耗布儒斯特角$\\theta_{B,0}$。请明确计算出这个主导阶的最小化角度，结果以弧度为单位的单个数值表示。\n\n将你的最终角度四舍五入至四位有效数字，并以弧度表示。在最终的方框答案中不要包含任何单位符号。", "solution": "这个问题要求对$p$偏振电磁波在电介质和耗散介质界面上的反射进行系统分析。我们将按顺序解决所要求的四个任务。\n\n此设置为：在$z=0$处有一个平面界面。介质1（$z<0$）是一种非磁性电介质，其实数折射率为$n_1$，介电函数为$\\varepsilon_1 = n_1^2$。介质2（$z>0$）是一种非磁性耗散介质，其复折射率为$\\tilde{n}_2 = n_2' + i\\kappa_2$（$n_2' > 0$, $\\kappa_2 > 0$），复介电函数为$\\varepsilon_2 = \\tilde{n}_2^2$。各处的磁导率均为$\\mu_0$。时间依赖关系为$\\exp(-i\\omega t)$。入射面为$x$-$z$平面。\n\n1) 菲涅耳反射振幅$r_p$的推导。\n对于$p$偏振波，磁场矢量$\\vec{H}$垂直于入射面，因此我们取$\\vec{H} = H_y(x,z) \\hat{y} \\exp(-i\\omega t)$。电场$\\vec{E}$位于$x$-$z$平面内。入射波（$\\mathrm{i}$）、反射波（$\\mathrm{r}$）和透射波（$\\mathrm{t}$）的场为：\n$$ \\vec{H}_{\\mathrm{i}} = \\vec{H}_{0,i} \\exp(i(k_{1x}x + k_{1z}z)) $$\n$$ \\vec{H}_{\\mathrm{r}} = \\vec{H}_{0,r} \\exp(i(k_{1x}x - k_{1z}z)) $$\n$$ \\vec{H}_{\\mathrm{t}} = \\vec{H}_{0,t} \\exp(i(k_{2x}x + k_{2z}z)) $$\n其中，相位匹配要求界面两侧的切向波矢分量相等：$k_{1x} = k_{2x}$。这就给出了斯涅耳定律：$n_1 \\sin\\theta_1 = \\tilde{n}_2 \\sin\\theta_2$。法向波矢分量为$k_{1z} = k_1 \\cos\\theta_1 = (n_1\\omega/c)\\cos\\theta_1$和$k_{2z} = \\tilde{k}_2 \\cos\\theta_2 = (\\tilde{n}_2\\omega/c)\\cos\\theta_2$。对于介质2中的衰减波，我们必须有$\\operatorname{Im}(k_{2z})>0$。\n\n相应的电场可以从麦克斯韦方程$\\nabla \\times \\vec{H} = -i\\omega\\varepsilon\\vec{E}$得到。切向分量为$E_x = \\frac{i}{\\omega\\varepsilon} \\frac{\\partial H_y}{\\partial z}$。\n$$ E_{x,\\mathrm{i}} = -\\frac{k_{1z}}{\\omega\\varepsilon_1} H_{y,\\mathrm{i}} \\quad , \\quad E_{x,\\mathrm{r}} = \\frac{k_{1z}}{\\omega\\varepsilon_1} H_{y,\\mathrm{r}} \\quad , \\quad E_{x,\\mathrm{t}} = -\\frac{k_{2z}}{\\omega\\varepsilon_2} H_{y,\\mathrm{t}} $$\n在界面$z=0$处，$\\vec{H}$和$\\vec{E}$的切向分量必须连续。设$H_{i0}, H_{r0}, H_{t0}$为界面处磁场的复振幅。\n$H_y$的连续性：\n$$ H_{i0} + H_{r0} = H_{t0} \\quad (1) $$\n$E_x$的连续性：\n$$ -\\frac{k_{1z}}{\\omega\\varepsilon_1} H_{i0} + \\frac{k_{1z}}{\\omega\\varepsilon_1} H_{r0} = -\\frac{k_{2z}}{\\omega\\varepsilon_2} H_{t0} \\quad (2) $$\n将(1)代入(2)：\n$$ \\frac{k_{1z}}{\\varepsilon_1} (H_{i0} - H_{r0}) = \\frac{k_{2z}}{\\varepsilon_2} (H_{i0} + H_{r0}) $$\n反射振幅$r_p$是为入射面内的电场振幅定义的。根据场矢量坐标系选择的不同，标准约定将磁场振幅关系定义为$r_p = -H_{r0}/H_{i0}$或$r_p=H_{r0}/H_{i0}$。我们先求解$H_{r0}/H_{i0}$。\n$$ H_{r0} \\left( \\frac{k_{2z}}{\\varepsilon_2} + \\frac{k_{1z}}{\\varepsilon_1} \\right) = H_{i0} \\left( \\frac{k_{1z}}{\\varepsilon_1} - \\frac{k_{2z}}{\\varepsilon_2} \\right) $$\n$$ \\frac{H_{r0}}{H_{i0}} = \\frac{k_{1z}/\\varepsilon_1 - k_{2z}/\\varepsilon_2}{k_{1z}/\\varepsilon_1 + k_{2z}/\\varepsilon_2} = \\frac{\\varepsilon_2 k_{1z} - \\varepsilon_1 k_{2z}}{\\varepsilon_2 k_{1z} + \\varepsilon_1 k_{2z}} $$\n这个表达式对应于一种$r_p$的定义，其中入射和反射电场的切向分量相加。一种更常见的约定使用总电场振幅来定义$r_p$，这会导致一个取决于所选$\\vec{E}_r$方向的符号翻转。如果我们将此结果等同于$r_p$，推导出的形式与标准菲涅耳方程相符。代入$k_{1z} = (n_1\\omega/c)\\cos\\theta_1$、$k_{2z} = (\\tilde{n}_2\\omega/c)\\cos\\theta_2$、$\\varepsilon_1=n_1^2$和$\\varepsilon_2=\\tilde{n}_2^2$，我们得到：\n$$ r_p = \\frac{\\tilde{n}_2^2 (n_1\\omega/c)\\cos\\theta_1 - n_1^2 (\\tilde{n}_2\\omega/c)\\cos\\theta_2}{\\tilde{n}_2^2 (n_1\\omega/c)\\cos\\theta_1 + n_1^2 (\\tilde{n}_2\\omega/c)\\cos\\theta_2} = \\frac{n_1\\tilde{n}_2(\\tilde{n}_2\\cos\\theta_1 - n_1\\cos\\theta_2)}{n_1\\tilde{n}_2(\\tilde{n}_2\\cos\\theta_1 + n_1\\cos\\theta_2)} = \\frac{\\tilde{n}_2 \\cos\\theta_1 - n_1 \\cos\\theta_2}{\\tilde{n}_2 \\cos\\theta_1 + n_1 \\cos\\theta_2} $$\n这个用角度$\\theta_1$和复数$\\theta_2$表示的最终表达式，使其解析延拓变得清晰透明。复数角$\\theta_2$受斯涅耳定律$n_1\\sin\\theta_1 = \\tilde{n}_2\\sin\\theta_2$约束，这意味着$\\cos\\theta_2 = \\sqrt{1-\\sin^2\\theta_2} = \\sqrt{1 - (n_1/\\tilde{n}_2)^2\\sin^2\\theta_1}$。\n\n2) 有损介质中布儒斯特角的存在性。\n布儒斯特条件为$R_p = |r_p|^2 = 0$，这要求$r_p=0$。根据第(1)部分推导的表达式，这意味着分子必须为零：\n$$ \\tilde{n}_2 \\cos\\theta_1 - n_1 \\cos\\theta_2 = 0 $$\n这个条件必须与斯涅耳定律$n_1 \\sin\\theta_1 = \\tilde{n}_2 \\sin\\theta_2$同时满足。我们可以结合这两个方程来找到关于$\\theta_1$的条件。从布儒斯特条件，$\\tilde{n}_2^2 \\cos^2\\theta_1 = n_1^2 \\cos^2\\theta_2 = n_1^2(1-\\sin^2\\theta_2)$。从斯涅耳定律代入$\\sin\\theta_2$：\n$$ \\tilde{n}_2^2 \\cos^2\\theta_1 = n_1^2 \\left(1 - \\frac{n_1^2}{\\tilde{n}_2^2} \\sin^2\\theta_1\\right) $$\n使用$\\cos^2\\theta_1 = 1-\\sin^2\\theta_1$并整理$\\sin^2\\theta_1$的项：\n$$ \\tilde{n}_2^2 (1-\\sin^2\\theta_1) = n_1^2 - \\frac{n_1^4}{\\tilde{n}_2^2} \\sin^2\\theta_1 $$\n$$ \\sin^2\\theta_1 \\left( \\frac{n_1^4}{\\tilde{n}_2^2} - \\tilde{n}_2^2 \\right) = n_1^2 - \\tilde{n}_2^2 $$\n$$ \\sin^2\\theta_1 \\frac{n_1^4 - \\tilde{n}_2^4}{\\tilde{n}_2^2} = n_1^2 - \\tilde{n}_2^2 $$\n假设$n_1^2 \\neq \\tilde{n}_2^2$（如果$\\kappa_2>0$则该条件必须成立），我们可以除以$n_1^2 - \\tilde{n}_2^2$：\n$$ \\sin^2\\theta_1 \\frac{(n_1^2-\\tilde{n}_2^2)(n_1^2+\\tilde{n}_2^2)}{\\tilde{n}_2^2} = n_1^2 - \\tilde{n}_2^2 \\implies \\sin^2\\theta_1 = \\frac{\\tilde{n}_2^2}{n_1^2 + \\tilde{n}_2^2} $$\n为了使$\\theta_1$是一个实数入射角，$\\sin^2\\theta_1$必须是范围在$[0, 1]$内的实数。我们来检查右边是否为实数。设$\\varepsilon_1 = n_1^2$（实数）和$\\varepsilon_2 = \\tilde{n}_2^2$。\n$$ \\sin^2\\theta_1 = \\frac{\\varepsilon_2}{\\varepsilon_1 + \\varepsilon_2} $$\n介质是耗散性的，所以$\\operatorname{Im}(\\varepsilon_2) = \\operatorname{Im}((n_2' + i\\kappa_2)^2) = 2n_2'\\kappa_2 > 0$。设$\\varepsilon_2 = \\varepsilon_2' + i\\varepsilon_2''$，其中$\\varepsilon_2'' > 0$。\n$$ \\sin^2\\theta_1 = \\frac{\\varepsilon_2' + i\\varepsilon_2''}{(\\varepsilon_1 + \\varepsilon_2') + i\\varepsilon_2''} $$\n该表达式的虚部为：\n$$ \\operatorname{Im}(\\sin^2\\theta_1) = \\frac{\\varepsilon_2''(\\varepsilon_1 + \\varepsilon_2') - \\varepsilon_2'(\\varepsilon_2'')}{(\\varepsilon_1 + \\varepsilon_2')^2 + (\\varepsilon_2'')^2} = \\frac{\\varepsilon_1 \\varepsilon_2''}{(\\varepsilon_1 + \\varepsilon_2')^2 + (\\varepsilon_2'')^2} $$\n因为$\\varepsilon_1 = n_1^2 > 0$且$\\varepsilon_2'' = 2n_2'\\kappa_2 > 0$，所以分子严格为正。分母也严格为正。因此，$\\operatorname{Im}(\\sin^2\\theta_1) > 0$。\n实数角度$\\theta_1$必须有实数的$\\sin^2\\theta_1$。而所要求的$\\sin^2\\theta_1$是复数这一事实导致了矛盾。因此，不存在实数入射角$\\theta_1$能满足条件$r_p=0$。对于耗散介质，反射率$R_p = |r_p|^2$可以有最小值，但永远不可能为零。\n\n3) 有损耗情况下的全内反射（TIR）。\n在无损耗情况下（$\\kappa_2=0$），当$n_1 > n_2$且入射角$\\theta_1$大于临界角$\\theta_c = \\arcsin(n_2/n_1)$时，会发生TIR。对于$\\theta_1 > \\theta_c$，$\\sin\\theta_2 = (n_1/n_2)\\sin\\theta_1 > 1$，使得$\\cos\\theta_2 = \\sqrt{1-\\sin^2\\theta_2}$成为纯虚数，即$\\cos\\theta_2 = i\\beta$（其中$\\beta$为实数）。反射系数变为$r_p = \\frac{n_2\\cos\\theta_1 - in_1\\beta}{n_2\\cos\\theta_1 + in_1\\beta}$，这是一个复数与其共轭复数之比。其模为$|r_p|=1$，表示完美反射。\n\n在有损耗情况下（$\\kappa_2>0$），完美TIR对应于条件$|r_p|=1$。这意味着没有能量传输到第二种介质中。介质2中单位体积的时间平均耗散功率由$\\frac{1}{2}\\omega \\operatorname{Im}(\\varepsilon_2) |\\vec{E}_{\\mathrm{t}}|^2$给出。由于我们假设$\\kappa_2 > 0$，我们有$\\operatorname{Im}(\\varepsilon_2) = 2n_2'\\kappa_2 > 0$。除非透射场$\\vec{E}_{\\mathrm{t}}$恒为零，否则在介质2内部必定有能量耗散。如果$\\vec{E}_{\\mathrm{t}}=0$，边界条件将要求入射场也为零，这是一个平凡解。因此，非零的入射场意味着$\\vec{E}_{\\mathrm{t}}$非零，且有功率被耗散。\n\n这些耗散的能量必须由入射波提供。界面处的能量平衡要求入射功率通量等于反射功率通量和吸收功率通量之和。如果$|r_p|=1$，则反射率$R_p=1$，意味着所有入射功率都被反射。这就没有功率透射到介质2中来解释那里必须发生的耗散。这是一个物理上的矛盾。因此，必须有能量净流入有损介质，这意味着吸收率大于零，因此反射率$R_p$必须严格小于1。\n因此，当从耗散介质反射时，完美的TIR（$|r_p|=1$）是不可能的，无论$\\operatorname{Re}(\\tilde{n}_2) < n_1$是否成立。反射率可能会变得很高，但永远不会达到1。\n\n4) 最小反射率的小损耗分析。\n题目要求我们找到使$R_p = |r_p|^2$最小化的角度$\\theta_{min}$，对于$n_1=1.50$和$\\tilde{n}_2=2.10+i\\,0.12$。如第(2)部分所示，反射率的最小值非零。题目指出，小损耗分析表明$\\theta_{min}$与无损耗布儒斯特角$\\theta_{B,0}$的差异仅在$\\kappa_2$的二阶。我们可以通过考虑使$r_p(\\theta_B) = 0$的复数布儒斯特角$\\theta_B$来证明这一点。\n如第(2)部分所证，$\\sin^2\\theta_B = \\tilde{n}_2^2 / (n_1^2 + \\tilde{n}_2^2)$。\n对于实数$\\theta_1$，使$R_p$最小化的角度（记为$\\theta_{min}$）可以很好地由$\\operatorname{Re}(\\theta_B)$近似。我们对$\\sin^2\\theta_B$按小$\\kappa_2$展开。设$n_2' = 2.10$且$\\kappa_2=0.12$。\n对$\\kappa_2$取一阶近似，$\\tilde{n}_2^2 = (n_2'+i\\kappa_2)^2 \\approx n_2'^2 + 2in_2'\\kappa_2$。\n$$ \\sin^2\\theta_B \\approx \\frac{n_2'^2 + 2in_2'\\kappa_2}{n_1^2 + n_2'^2 + 2in_2'\\kappa_2} = \\left(\\frac{n_2'^2}{n_1^2 + n_2'^2}\\right) \\frac{1 + 2i\\kappa_2/n_2'}{1 + 2in_2'\\kappa_2/(n_1^2+n_2'^2)} $$\n无损耗布儒斯特角$\\theta_{B,0}$满足$\\tan\\theta_{B,0} = n_2'/n_1$，这给出$\\sin^2\\theta_{B,0} = \\frac{(n_2'/n_1)^2}{1+(n_2'/n_1)^2} = \\frac{n_2'^2}{n_1^2+n_2'^2}$。\n$$ \\sin^2\\theta_B \\approx \\sin^2\\theta_{B,0} \\left(1 + \\frac{2i\\kappa_2}{n_2'}\\right) \\left(1 - \\frac{2in_2'\\kappa_2}{n_1^2+n_2'^2}\\right) $$\n$$ \\sin^2\\theta_B \\approx \\sin^2\\theta_{B,0} \\left(1 + 2i\\kappa_2 \\left(\\frac{1}{n_2'} - \\frac{n_2'}{n_1^2+n_2'^2}\\right)\\right) + O(\\kappa_2^2) $$\n$$ \\sin^2\\theta_B \\approx \\sin^2\\theta_{B,0} + i \\cdot 2\\kappa_2 \\sin^2\\theta_{B,0} \\left(\\frac{n_1^2+n_2'^2 - n_2'^2}{n_2'(n_1^2+n_2'^2)}\\right) = \\sin^2\\theta_{B,0} + i \\frac{2\\kappa_2 n_1^2 n_2'}{(n_1^2+n_2'^2)^2} $$\n设$\\theta_B = \\theta_{B,0} + \\Delta\\theta$。对于小的$\\Delta\\theta$，$\\sin^2\\theta_B \\approx \\sin^2\\theta_{B,0} + \\Delta\\theta \\sin(2\\theta_{B,0})$。\n比较这两个表达式，$\\Delta\\theta \\sin(2\\theta_{B,0})$是一个$\\kappa_2$阶的纯虚数项。这意味着$\\Delta\\theta$本身对$\\kappa_2$取一阶近似时是纯虚数。\n因此，$\\operatorname{Re}(\\theta_B) = \\theta_{B,0} + O(\\kappa_2^2)$。由于$\\theta_{min} \\approx \\operatorname{Re}(\\theta_B)$，最小化角度与无损耗布儒斯特角之差仅在$\\kappa_2$的二阶。\n取主导阶，最小化角度即为无损耗布儒斯特角：\n$$ \\theta_{min} \\approx \\theta_{B,0} = \\arctan\\left(\\frac{n_2'}{n_1}\\right) $$\n使用给定值$n_1=1.50$和$n_2'=2.10$：\n$$ \\theta_{B,0} = \\arctan\\left(\\frac{2.10}{1.50}\\right) = \\arctan(1.40) $$\n以弧度计算该值：\n$$ \\theta_{B,0} \\approx 0.950546... \\text{ rad} $$\n四舍五入到四位有效数字，主导阶的最小化角度为$0.9505$弧度。", "answer": "$$\\boxed{0.9505}$$", "id": "2810155"}, {"introduction": "我们已经学习了如何为材料的 $\\varepsilon(\\omega)$ 建立模型，以及如何预测它在界面上的光学效应，但一个至关重要的问题是：我们如何在实验上精确地测量一个未知材料的复介电函数？本练习将向您介绍一种强大的非接触式表征技术——椭圆偏振光谱法。您将亲自推导从椭偏测量数据反演材料 $\\varepsilon$ 的核心公式，并编写程序实现这一过程，从而将理论、实验和计算紧密地联系在一起。[@problem_id:2810177]", "problem": "您的任务是反演椭圆偏振光谱测量数据，以恢复各向同性、半无限体材料的复介电函数。椭圆偏振光谱法测量p偏振和s偏振的Fresnel反射系数的复数比，定义为 $\\rho = \\tan(\\Psi)\\,\\exp(\\mathrm{i}\\Delta) = r_p / r_s$，其中 $r_p$ 和 $r_s$ 分别是p偏振和s偏振的复反射系数，$\\Psi$ 是椭偏振幅比，$\\Delta$ 是椭偏相位差。对于一个折射率为 $n_0$（实数，非吸收）的非磁性环境介质与一个由复介电函数 $\\varepsilon$（无单位）表征的非磁性样品之间的平面界面，当以入射角 $\\theta$（单位：度）照射时，假定衬底为半无限大（无背面反射）。\n\n从基本的电磁边界条件和Fresnel方程出发，依据第一性原理推导一个关于 $\\varepsilon$ 的显式表达式，该表达式用 $\\rho$、$n_0$ 和 $\\theta$ 表示，且不使用任何额外的简化。然后，实现一个程序，使用您推导出的表达式为以下测试套件计算 $\\varepsilon$。\n\n请使用以下精确的测试用例。每个测试用例提供入射角 $\\theta$（单位：度）、环境折射率 $n_0$（无单位）和复椭偏比 $\\rho$（无单位）。虚数单位用 $\\mathrm{i}$ 表示。\n\n- 测试用例 1：$\\theta = 60$，$n_0 = 1.0$，$\\rho = 0.5 + 0.2\\,\\mathrm{i}$。\n- 测试用例 2：$\\theta = 75$，$n_0 = 1.0$，$\\rho = 0.2 - 0.8\\,\\mathrm{i}$。\n- 测试用例 3：$\\theta = 65$，$n_0 = 1.33$，$\\rho = 0.3 + 0.1\\,\\mathrm{i}$。\n- 测试用例 4：$\\theta = 85$，$n_0 = 1.0$，$\\rho = -0.2 + 0.05\\,\\mathrm{i}$。\n\n要求与约定：\n- 角度必须以度为单位进行解释。\n- 介电函数 $\\varepsilon$ 是无单位的。\n- 您的程序必须为每个测试用例计算复介电函数 $\\varepsilon = \\varepsilon_1 + \\mathrm{i}\\,\\varepsilon_2$，并为每个用例返回两个浮点数：$\\varepsilon_1$ 和 $\\varepsilon_2$。\n- 数值格式：将实部和虚部都四舍五入到 $6$ 位小数。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表中的每个元素是一个包含两个元素的列表，形式为 $[\\varepsilon_1,\\varepsilon_2]$，两个条目都四舍五入到 $6$ 位小数。例如，输出必须看起来像 $[[x_1,y_1],[x_2,y_2],\\dots]$，不含多余的空格或文本。\n\n交付内容：\n- 一个完整的、可运行的程序，该程序对提供的测试套件进行计算，并以所要求的精确格式单行打印结果。", "solution": "该问题要求从椭偏数据中推导出各向同性、半无限体材料的复介电函数 $\\varepsilon$ 的显式表达式。提供的数据包括复反射率比 $\\rho$、入射角 $\\theta$ 和非吸收环境介质的折射率 $n_0$。推导过程必须从第一性原理出发，在此背景下，这意味着从Fresnel反射系数开始，而这些系数本身是电磁边界条件在界面上应用的直接结果。\n\n该物理系统是两种介质之间的一个平面界面。介质0是环境介质，其折射率为实数 $n_0$。介质1是衬底，其复折射率为 $n_1$，复介电函数为 $\\varepsilon$。对于非磁性材料，这些量之间的关系是 $\\varepsilon = n_1^2$。波从介质0以角度 $\\theta_0 = \\theta$ 入射，并以复数角度 $\\theta_1$ 折射进入介质1。\n\n界面上s偏振光（$r_s$）和p偏振光（$r_p$）的Fresnel反射系数由下式给出：\n$$r_s = \\frac{n_0 \\cos\\theta_0 - n_1 \\cos\\theta_1}{n_0 \\cos\\theta_0 + n_1 \\cos\\theta_1}$$\n$$r_p = \\frac{n_1 \\cos\\theta_0 - n_0 \\cos\\theta_1}{n_1 \\cos\\theta_0 + n_0 \\cos\\theta_1}$$\n\n椭圆偏振光谱学的基本方程定义了复数比 $\\rho$：\n$$\\rho = \\frac{r_p}{r_s}$$\n\n我们的目标是通过反演此方程来找到 $\\varepsilon = n_1^2$ 的表达式。一种有效的代数策略是处理量 $(1-\\rho)/(1+\\rho)$：\n$$\\frac{1-\\rho}{1+\\rho} = \\frac{1 - r_p/r_s}{1 + r_p/r_s} = \\frac{r_s - r_p}{r_s + r_p}$$\n现在我们来计算反射系数的和与差。为简便起见，令 $c_0 = \\cos\\theta_0$ 和 $c_1 = \\cos\\theta_1$。\n$$r_s + r_p = \\frac{n_0 c_0 - n_1 c_1}{n_0 c_0 + n_1 c_1} + \\frac{n_1 c_0 - n_0 c_1}{n_1 c_0 + n_0 c_1}$$\n$$r_s + r_p = \\frac{(n_0 c_0 - n_1 c_1)(n_1 c_0 + n_0 c_1) + (n_1 c_0 - n_0 c_1)(n_0 c_0 + n_1 c_1)}{(n_0 c_0 + n_1 c_1)(n_1 c_0 + n_0 c_1)}$$\n分子展开为：\n$$(n_0 n_1 c_0^2 + n_0^2 c_0 c_1 - n_1^2 c_0 c_1 - n_0 n_1 c_1^2) + (n_1 n_0 c_0^2 + n_1^2 c_0 c_1 - n_0^2 c_0 c_1 - n_0 n_1 c_1^2) = 2 n_0 n_1 (c_0^2 - c_1^2)$$\n差值 $r_s - r_p$ 为：\n$$r_s - r_p = \\frac{(n_0 c_0 - n_1 c_1)(n_1 c_0 + n_0 c_1) - (n_1 c_0 - n_0 c_1)(n_0 c_0 + n_1 c_1)}{(n_0 c_0 + n_1 c_1)(n_1 c_0 + n_0 c_1)}$$\n分子展开为：\n$$(n_0 n_1 c_0^2 + n_0^2 c_0 c_1 - n_1^2 c_0 c_1 - n_0 n_1 c_1^2) - (n_1 n_0 c_0^2 + n_1^2 c_0 c_1 - n_0^2 c_0 c_1 - n_0 n_1 c_1^2) = 2 c_0 c_1 (n_0^2 - n_1^2)$$\n将这些代入 $(1-\\rho)/(1+\\rho)$ 的表达式中：\n$$\\frac{1-\\rho}{1+\\rho} = \\frac{2 c_0 c_1 (n_0^2 - n_1^2)}{2 n_0 n_1 (c_0^2 - c_1^2)} = \\frac{\\cos\\theta_0 \\cos\\theta_1 (n_0^2 - n_1^2)}{n_0 n_1 (\\cos^2\\theta_0 - \\cos^2\\theta_1)}$$\n使用恒等式 $\\cos^2 x = 1 - \\sin^2 x$，项 $(\\cos^2\\theta_0 - \\cos^2\\theta_1)$ 变为 $(\\sin^2\\theta_1 - \\sin^2\\theta_0)$。\n$$\\frac{1-\\rho}{1+\\rho} = \\frac{\\cos\\theta_0 \\cos\\theta_1 (n_0^2 - n_1^2)}{n_0 n_1 (\\sin^2\\theta_1 - \\sin^2\\theta_0)}$$\n现在，我们使用Snell定律，$n_0 \\sin\\theta_0 = n_1 \\sin\\theta_1$，这意味着 $\\sin^2\\theta_1 = (n_0/n_1)^2 \\sin^2\\theta_0$。我们将其代入分母：\n$$n_0 n_1 (\\sin^2\\theta_1 - \\sin^2\\theta_0) = n_0 n_1 \\left( \\frac{n_0^2}{n_1^2}\\sin^2\\theta_0 - \\sin^2\\theta_0 \\right) = n_0 n_1 \\sin^2\\theta_0 \\left( \\frac{n_0^2 - n_1^2}{n_1^2} \\right) = \\frac{n_0}{n_1} \\sin^2\\theta_0 (n_0^2 - n_1^2)$$\n将此代回主表达式：\n$$\\frac{1-\\rho}{1+\\rho} = \\frac{\\cos\\theta_0 \\cos\\theta_1 (n_0^2 - n_1^2)}{\\frac{n_0}{n_1} \\sin^2\\theta_0 (n_0^2 - n_1^2)} = \\frac{n_1 \\cos\\theta_0 \\cos\\theta_1}{n_0 \\sin^2\\theta_0}$$\n该表达式仍包含未知角度 $\\theta_1$。我们可以再次使用Snell定律来表示 $\\cos\\theta_1$，从而消去它：\n$$\\cos\\theta_1 = \\sqrt{1 - \\sin^2\\theta_1} = \\sqrt{1 - \\frac{n_0^2 \\sin^2\\theta_0}{n_1^2}} = \\frac{\\sqrt{n_1^2 - n_0^2 \\sin^2\\theta_0}}{n_1}$$\n将此代入我们的 $(1-\\rho)/(1+\\rho)$ 方程：\n$$\\frac{1-\\rho}{1+\\rho} = \\frac{n_1 \\cos\\theta_0}{n_0 \\sin^2\\theta_0} \\left( \\frac{\\sqrt{n_1^2 - n_0^2 \\sin^2\\theta_0}}{n_1} \\right) = \\frac{\\cos\\theta_0 \\sqrt{n_1^2 - n_0^2 \\sin^2\\theta_0}}{n_0 \\sin^2\\theta_0}$$\n现在我们可以解出 $n_1^2 = \\varepsilon$。令 $\\theta_0=\\theta$。\n$$\\left( \\frac{1-\\rho}{1+\\rho} \\right) \\frac{n_0 \\sin^2\\theta}{\\cos\\theta} = \\sqrt{n_1^2 - n_0^2 \\sin^2\\theta}$$\n两边平方得到：\n$$\\left( \\frac{1-\\rho}{1+\\rho} \\right)^2 \\frac{n_0^2 \\sin^4\\theta}{\\cos^2\\theta} = n_1^2 - n_0^2 \\sin^2\\theta$$\n$$n_1^2 = n_0^2 \\sin^2\\theta + n_0^2 \\frac{\\sin^4\\theta}{\\cos^2\\theta} \\left( \\frac{1-\\rho}{1+\\rho} \\right)^2$$\n提出因子 $n_0^2 \\sin^2\\theta$ 并使用 $\\tan^2\\theta = \\sin^2\\theta/\\cos^2\\theta$：\n$$n_1^2 = n_0^2 \\sin^2\\theta \\left[ 1 + \\tan^2\\theta \\left( \\frac{1-\\rho}{1+\\rho} \\right)^2 \\right]$$\n最后，根据 $\\varepsilon = n_1^2$，我们得到复介电函数的显式表达式：\n$$\\varepsilon = n_0^2 \\sin^2\\theta \\left[ 1 + \\tan^2\\theta \\left( \\frac{1-\\rho}{1+\\rho} \\right)^2 \\right]$$\n这就是所要求的公式。程序将实现此方程，为给定的测试用例计算 $\\varepsilon = \\varepsilon_1 + \\mathrm{i}\\,\\varepsilon_2$。角度 $\\theta$ 必须从度转换为弧度才能用于三角函数。复数运算使用Python内置的 `complex` 类型和 `numpy` 函数处理。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the complex dielectric function from ellipsometric data.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (theta_degrees, n0, rho_complex)\n    test_cases = [\n        (60, 1.0, 0.5 + 0.2j),\n        (75, 1.0, 0.2 - 0.8j),\n        (65, 1.33, 0.3 + 0.1j),\n        (85, 1.0, -0.2 + 0.05j),\n    ]\n\n    results = []\n    for case in test_cases:\n        theta_deg, n0, rho = case\n\n        # Convert angle of incidence from degrees to radians for trigonometric functions\n        theta_rad = np.deg2rad(theta_deg)\n\n        # Pre-calculate trigonometric values\n        sin_theta = np.sin(theta_rad)\n        tan_theta = np.tan(theta_rad)\n        \n        # Calculate the dielectric function epsilon using the derived formula:\n        # epsilon = n0^2 * sin^2(theta) * [1 + tan^2(theta) * ((1-rho)/(1+rho))^2]\n        \n        # Calculate the term involving rho\n        rho_term = (1 - rho) / (1 + rho)\n        \n        # Calculate epsilon\n        epsilon = (n0 * sin_theta)**2 * (1 + (tan_theta * rho_term)**2)\n        \n        # Extract real (e1) and imaginary (e2) parts\n        e1 = epsilon.real\n        e2 = epsilon.imag\n        \n        # Round the results to 6 decimal places as required\n        e1_rounded = round(e1, 6)\n        e2_rounded = round(e2, 6)\n        \n        results.append([e1_rounded, e2_rounded])\n\n    # Format the final output string according to the problem specification.\n    # Example format: [[x1,y1],[x2,y2],...]\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]}]\" for r in results]) + \"]\"\n\n    # The final print statement must produce only the specified single-line format.\n    print(output_str)\n\nsolve()\n```", "id": "2810177"}]}