{"hands_on_practices": [{"introduction": "理解外部压力如何改变半导体的电子结构，对于基础研究和设计在应力下工作的器件都至关重要。本练习将演示形变势理论的应用，该理论在宏观应变与能带边缘的微观能量位移之间建立了有力的联系。通过解决这个问题，你将定量地理解如何预测材料带隙 $E_g$ 在静水压力 $P$ 下的变化，从而将微观参数（如形变势 $a_c$ 和 $a_v$ ）与一个可测量的宏观系数联系起来 [@problem_id:89375]。", "problem": "考虑一种具有立方晶体结构（例如 zincblende 或 diamond）的半导体。该材料在布里渊区的 Γ-点（$k=0$）具有直接带隙。导带底的能量为 $E_c$，价带顶的能量为 $E_v$。\n\n在由应变张量 $\\mathbf{\\epsilon}$ 描述的外加应变作用下，带边的能级会发生移动。对于 Γ-点的 s-like 导带底和 p-like 价带顶，由体应变引起的能量移动由形变势理论给出。导带和价带边能量的变化量由下式给出：\n$$\n\\Delta E_c = a_c \\cdot \\mathrm{Tr}(\\mathbf{\\epsilon})\n$$\n$$\n\\Delta E_v = a_v \\cdot \\mathrm{Tr}(\\mathbf{\\epsilon})\n$$\n其中 $a_c$ 和 $a_v$ 分别是导带和价带的静水形变势，$\\mathrm{Tr}(\\mathbf{\\epsilon}) = \\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz}$ 是应变张量的迹，代表体积分数变化。\n\n材料受到均匀静水压 $P$ 的作用。该压力对应于应力张量 $\\sigma_{ij} = -P \\delta_{ij}$。根据立方晶体的线性弹性理论，应力张量的对角分量与应变张量的对角分量通过以下方程相关联：\n$$\n\\sigma_{xx} = C_{11}\\epsilon_{xx} + C_{12}(\\epsilon_{yy} + \\epsilon_{zz})\n$$\n$$\n\\sigma_{yy} = C_{11}\\epsilon_{yy} + C_{12}(\\epsilon_{xx} + \\epsilon_{zz})\n$$\n$$\n\\sigma_{zz} = C_{11}\\epsilon_{zz} + C_{12}(\\epsilon_{xx} + \\epsilon_{yy})\n$$\n其中 $C_{11}$ 和 $C_{12}$ 是立方晶体的独立弹性刚度常数。\n\n假设材料的响应是线性的，计算直接带隙的压力系数 $\\frac{dE_g}{dP}$，并用形变势 $a_c$、$a_v$ 和弹性常数 $C_{11}$、$C_{12}$ 表示。", "solution": "带隙能量定义为 $E_g = E_c - E_v$。由应变引起的带隙变化为：\n\n$$\n\\Delta E_g = \\Delta E_c - \\Delta E_v\n$$\n\n代入 $\\Delta E_c$ 和 $\\Delta E_v$ 的给定表达式：\n\n$$\n\\Delta E_g = a_c \\cdot \\mathrm{Tr}(\\mathbf{\\epsilon}) - a_v \\cdot \\mathrm{Tr}(\\mathbf{\\epsilon}) = (a_c - a_v) \\cdot \\mathrm{Tr}(\\mathbf{\\epsilon})\n$$\n\n其中 $\\mathrm{Tr}(\\mathbf{\\epsilon}) = \\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz}$。\n\n在均匀静水压 $P$ 作用下，应力张量为 $\\sigma_{ij} = -P \\delta_{ij}$。对于立方晶体，弹性方程为：\n\n$$\n\\sigma_{xx} = C_{11} \\epsilon_{xx} + C_{12} (\\epsilon_{yy} + \\epsilon_{zz}) = -P\n$$\n\n\n$$\n\\sigma_{yy} = C_{11} \\epsilon_{yy} + C_{12} (\\epsilon_{xx} + \\epsilon_{zz}) = -P\n$$\n\n\n$$\n\\sigma_{zz} = C_{11} \\epsilon_{zz} + C_{12} (\\epsilon_{xx} + \\epsilon_{yy}) = -P\n$$\n\n由于静水压下的对称性，应变分量相等：$\\epsilon_{xx} = \\epsilon_{yy} = \\epsilon_{zz} = \\epsilon$。因此：\n\n$$\n\\mathrm{Tr}(\\mathbf{\\epsilon}) = 3\\epsilon\n$$\n\n代入其中一个弹性方程，例如 $\\sigma_{xx}$：\n\n$$\n-P = C_{11} \\epsilon + C_{12} (\\epsilon + \\epsilon) = C_{11} \\epsilon + 2 C_{12} \\epsilon = (C_{11} + 2 C_{12}) \\epsilon\n$$\n\n解出 $\\epsilon$：\n\n$$\n\\epsilon = -\\frac{P}{C_{11} + 2 C_{12}}\n$$\n\n那么：\n\n$$\n\\mathrm{Tr}(\\mathbf{\\epsilon}) = 3\\epsilon = -\\frac{3P}{C_{11} + 2 C_{12}}\n$$\n\n代入 $\\Delta E_g$：\n\n$$\n\\Delta E_g = (a_c - a_v) \\cdot \\left( -\\frac{3P}{C_{11} + 2 C_{12}} \\right) = -\\frac{3(a_c - a_v)P}{C_{11} + 2 C_{12}}\n$$\n\n带隙的压力系数是 $E_g$ 对 $P$ 的导数。由于无应变时的 $E_g$ 是常数，因此 $\\frac{dE_g}{dP} = \\frac{d(\\Delta E_g)}{dP}$：\n\n$$\n\\frac{dE_g}{dP} = \\frac{d}{dP} \\left[ -\\frac{3(a_c - a_v)P}{C_{11} + 2 C_{12}} \\right] = -\\frac{3(a_c - a_v)}{C_{11} + 2 C_{12}}\n$$\n\n因为分母与 $P$ 无关。", "answer": "$$\n\\boxed{ -\\dfrac{3(a_c - a_v)}{C_{11} + 2C_{12}} }\n$$", "id": "89375"}, {"introduction": "在量子阱等量子限制结构中，光与物质的相互作用变得高度各向异性，从而对光学跃迁产生了严格的选择定则。本实践通过考察光学矩阵元 $M = \\langle \\Psi_c | \\mathbf{p} \\cdot \\mathbf{\\epsilon} | \\Psi_v \\rangle$，深入探讨了这些定则的量子力学起源，该矩阵元依赖于导带和价带波函数的对称性以及入射光的偏振 $\\mathbf{\\epsilon}$。计算电子到轻空穴跃迁的偏振依赖性，将巩固你对现代光电器件中如何利用量子限制来控制光与物质相互作用的理解 [@problem_id:89350]。", "problem": "考虑一个沿$z$轴生长的I型半导体量子阱（QW），它对电子和空穴进行限制。我们关注的是在布里渊区中心（$\\mathbf{k}_\\parallel = 0$）处，价带（VB）和导带（CB）之间的直接带间光学跃迁。\n\n光与半导体之间的相互作用在电偶极近似下进行描述。跃迁速率与光学矩阵元的模平方$|M|^2$成正比，其中 $M = \\langle \\Psi_c | \\mathbf{p} \\cdot \\mathbf{\\epsilon} | \\Psi_v \\rangle$。此处，$\\mathbf{p}$ 是动量算符，$\\mathbf{\\epsilon}$ 是光的偏振矢量，而 $\\Psi_c$ 和 $\\Psi_v$ 分别是导带中的电子和价带中的空穴的波函数。\n\n在有效质量近似下，波函数是带边处的缓变包络函数 $\\phi(\\mathbf{r})$ 和快变布洛赫函数 $u(\\mathbf{r})$ 的乘积：$\\Psi(\\mathbf{r}) = \\phi(\\mathbf{r}) u_{\\mathbf{k}=0}(\\mathbf{r})$。该矩阵元可近似为 $M \\approx \\langle u_c | \\mathbf{\\epsilon} \\cdot \\mathbf{p} | u_v \\rangle \\langle \\phi_c | \\phi_v \\rangle$。\n\n对于典型的III-V族半导体，导带布洛赫函数 $u_c$ 是类s的，记为 $|S\\rangle$，而价带布洛赫函数 $u_v$ 是类p的，记为 $|X\\rangle, |Y\\rangle, |Z\\rangle$。自旋-轨道相互作用使价带发生分裂。轻空穴（LH）态对应于总角动量 $J=3/2$ 和投影 $m_J=\\pm 1/2$。在布里渊区中心，这些布洛赫态由以下公式给出：\n$$|u_{lh, +1/2}\\rangle = \\sqrt{\\frac{1}{6}} |(X+iY)\\downarrow\\rangle - \\sqrt{\\frac{2}{3}} |Z\\uparrow\\rangle$$\n$$|u_{lh, -1/2}\\rangle = \\sqrt{\\frac{1}{6}} |(X-iY)\\uparrow\\rangle + \\sqrt{\\frac{2}{3}} |Z\\downarrow\\rangle$$\n其中箭头表示自旋向上（$\\uparrow$）和自旋向下（$\\downarrow$）的状态。动量算符 $\\mathbf{p}$ 不作用于自旋。其在类s的导带态和类p的价带态之间的非零矩阵元由Kane参数 $P = \\langle S | p_x | X \\rangle = \\langle S | p_y | Y \\rangle = \\langle S | p_z | Z \\rangle$ 给出。\n\n我们考虑两种不同的光偏振：\n1.  **TE（横电）偏振：** 电场矢量 $\\mathbf{\\epsilon}$ 位于量子阱平面（$xy$平面）内。\n2.  **TM（横磁）偏振：** 电场矢量 $\\mathbf{\\epsilon}$ 平行于生长方向（$z$轴）。\n\n计算对于第一次电子到轻空穴（$e1-lh1$）的跃迁，TM偏振光与TE偏振光所对应的光学矩阵元平方的比值，即 $\\frac{|M_{TM}|^2}{|M_{TE}|^2}$。假设包络函数交叠 $\\langle \\phi_{e1} | \\phi_{lh1} \\rangle$ 不为零。", "solution": "我们分步计算两种偏振下的光学矩阵元模平方。\n跃迁发生在导带态 $|u_c\\rangle = |S\\rangle$ 和轻空穴态 $|u_{lh,+\\frac{1}{2}}\\rangle = \\sqrt{\\frac{1}{6}} |(X+iY)\\downarrow\\rangle - \\sqrt{\\frac{2}{3}} |Z\\uparrow\\rangle$ 之间。\n\n1.  **TM 偏振 ($\\mathbf{\\epsilon} \\parallel z$):**\n    只有 $p_z$ 分量有贡献，与 $|u_{lh}\\rangle$ 中的 $|Z\\rangle$ 部分耦合。\n    $$M_{TM} = \\langle S | p_z | (-\\sqrt{\\frac{2}{3}}Z) \\rangle = -\\sqrt{\\frac{2}{3}}\\langle S|p_z|Z\\rangle = -\\sqrt{\\frac{2}{3}}P$$\n    所以，\n    $$|M_{TM}|^2 = \\frac{2}{3}|P|^2$$\n\n2.  **TE 偏振 ($\\mathbf{\\epsilon} \\parallel x$):**\n    只有 $p_x$ 分量有贡献，与 $|u_{lh}\\rangle$ 中的 $|X\\rangle$ 部分耦合。\n    $$M_{TE} = \\langle S | p_x | (\\sqrt{\\frac{1}{6}}X) \\rangle = \\sqrt{\\frac{1}{6}}\\langle S|p_x|X\\rangle = \\sqrt{\\frac{1}{6}}P$$\n    所以，\n    $$|M_{TE}|^2 = \\frac{1}{6}|P|^2$$\n\n3.  **比值:**\n    将 TM 和 TE 的结果相比：\n    $$\\frac{|M_{TM}|^2}{|M_{TE}|^2} = \\frac{\\frac{2}{3}|P|^2}{\\frac{1}{6}|P|^2} = \\frac{2}{3} \\times 6 = 4$$", "answer": "$$\\boxed{4}$$", "id": "89350"}, {"introduction": "虽然理论模型可以描述带间跃迁，但要确定真实材料的精确光学性质，则需要复杂的实验技术和数据分析。这个计算练习模拟了光谱椭偏仪的分析过程——一种强大的无损表征方法，并要求你建立一个模型，从原始测量数据 $\\rho = \\tan\\Psi e^{i\\Delta}$ 中提取材料的复介电函数 $\\epsilon(\\omega)$。通过实施回归分析，将洛伦兹振子模型拟合到模拟的椭偏数据，你将获得研究人员用于表征和理解新材料中电子跃迁的完整工作流程的实践经验 [@problem_id:2819423]。", "problem": "您的任务是制定并实现一个参数提取程序，用于通过光谱椭偏法 (SE) 分析电子带间跃迁。正向物理模型基于电磁边界条件和模型介电函数，而逆问题通过非线性回归求解。您的程序必须能够计算复介电函数，并通过拟合由已知参数人工合成的椭偏数据来恢复带间临界点参数。\n\n从以下基本原理开始：\n- 在环境介质与半无限各向同性介质之间的平面界面上，麦克斯韦界面边界条件可导出 $s$ 和 $p$ 偏振的菲涅尔反射系数。对于环境介质中的入射角 $\\,\\theta\\,$ 和样品中的复介电函数 $\\,\\epsilon(\\omega)\\,$，设环境介电常数 $\\,\\epsilon_{0} = 1\\,$ 且 $\\mu = 1$，则反射系数为\n$$\nr_{s}(\\omega,\\theta) = \\frac{\\cos\\theta - \\beta(\\omega,\\theta)}{\\cos\\theta + \\beta(\\omega,\\theta)},\\qquad\nr_{p}(\\omega,\\theta) = \\frac{\\epsilon(\\omega)\\cos\\theta - \\beta(\\omega,\\theta)}{\\epsilon(\\omega)\\cos\\theta + \\beta(\\omega,\\theta)},\n$$\n其中\n$$\n\\beta(\\omega,\\theta) = \\sqrt{\\epsilon(\\omega) - \\sin^{2}\\theta}.\n$$\n- 椭偏比定义为\n$$\n\\rho(\\omega,\\theta) = \\frac{r_{p}(\\omega,\\theta)}{r_{s}(\\omega,\\theta)} = \\tan\\Psi(\\omega,\\theta)\\,e^{i\\Delta(\\omega,\\theta)},\n$$\n由此可以通过 $\\,\\tan\\Psi = |\\rho|\\,$ 和 $\\,\\Delta = \\arg\\rho\\,$ 推断出椭偏角 $\\,\\Psi\\,$ 和 $\\,\\Delta\\,$。在本问题中，您将直接使用复数比 $\\,\\rho\\,$ 以避免相位解缠问题。\n- 此处，带间跃迁通过经典的洛伦兹振子介电函数模型进行描述，该函数以光子能量单位 $\\,E = \\hbar\\omega\\,$ 表示。使用无量纲振子强度 $\\,F_{j}\\,$、共振能量 $\\,E_{j}\\,(\\mathrm{eV})\\,$、阻尼参数 $\\,\\Gamma_{j}\\,(\\mathrm{eV})\\,$ 和高频常数 $\\,\\epsilon_{\\infty}\\,$，定义\n$$\n\\epsilon(E) = \\epsilon_{\\infty} + \\sum_{j=1}^{N}\\frac{F_{j}\\,E_{j}^{2}}{E_{j}^{2} - E^{2} - i\\,\\Gamma_{j}\\,E}.\n$$\n\n任务：\n- 实现将参数矢量 $\\,\\boldsymbol{\\theta} = \\left(\\epsilon_{\\infty}, F_{1}, E_{1}, \\Gamma_{1}, \\dots, F_{N}, E_{N}, \\Gamma_{N}\\right)\\,$ 在给定的采样点 $\\,\\{E_{k}\\}\\,$ 和固定入射角 $\\,\\theta\\,$ 下映射到 $\\,\\rho(E_{k},\\theta)\\,$ 的正向模型。\n- 实现一个非线性最小二乘回归，在给定由已知真实参数生成的合成数据 $\\,\\rho_{\\mathrm{meas}}(E_{k},\\theta)\\,$ 的情况下，通过最小化由所有采样能量上 $\\,\\rho\\,$ 的实部和虚部组成的残差矢量的欧几里得范数来估计 $\\,\\widehat{\\boldsymbol{\\theta}}\\,$：\n$$\n\\min_{\\boldsymbol{\\theta}}\\ \\sum_{k}\\left(\\Re\\left[\\rho(E_{k};\\boldsymbol{\\theta}) - \\rho_{\\mathrm{meas}}(E_{k})\\right]^{2} + \\Im\\left[\\rho(E_{k};\\boldsymbol{\\theta}) - \\rho_{\\mathrm{meas}}(E_{k})\\right]^{2}\\right).\n$$\n- 在估计出 $\\,\\widehat{\\boldsymbol{\\theta}}\\,$ 后，在相同的能量网格上计算提取的介电函数 $\\,\\widehat{\\epsilon}(E_{k})\\,$，并使用均方根 (RMS) 幅值误差来量化其相对于真实介电函数 $\\,\\epsilon_{\\mathrm{true}}(E_{k})\\,$ 的提取精度：\n$$\n\\mathrm{RMS}_{\\epsilon} = \\sqrt{\\frac{1}{K}\\sum_{k=1}^{K}\\left|\\widehat{\\epsilon}(E_{k}) - \\epsilon_{\\mathrm{true}}(E_{k})\\right|^{2}}.\n$$\n为每个测试用例报告 $\\,\\mathrm{RMS}_{\\epsilon}\\,$。该指标是无量纲的。\n\n角度单位和物理单位：\n- 使用以度为单位指定的入射角 $\\,\\theta\\,$。在内部计算三角函数时，需将其转换为弧度。\n- 光子能量 $\\,E\\,$ 以 $\\mathrm{eV}$ 为单位。\n- 椭偏相位 $\\,\\Delta\\,$（如果需要）必须以弧度为单位。\n- 输出的 RMS 误差是无量纲的。\n\n约束和建模选择：\n- 假设样品为半无限、各向同性、非磁性材料，且环境为真空。\n- 在回归中使用边界来强制 $\\,\\epsilon_{\\infty} > 0\\,$, $\\,F_{j} \\ge 0\\,$, $\\,E_{j} > 0\\,$ 和 $\\,\\Gamma_{j} > 0\\,$。\n- 选择一种在斜入射下对复数运算具有数值稳定性的实现方式。\n- 您不得依赖任何外部文件或用户输入。\n\n测试套件：\n实现并求解以下 $\\,3\\,$ 个测试用例。在每个用例中，根据指定的真实参数人工合成 $\\,\\rho_{\\mathrm{meas}}\\,$，然后从指定的初始猜测值开始执行回归。所有用例均使用相同的入射角 $\\,\\theta = 70^{\\circ}\\,$。\n\n- 用例 $\\,1\\,$（由单个洛伦兹振子近似的单个带间临界点）：\n  - 能量采样点 $\\,E\\,(\\mathrm{eV}):\\,\\{\\,1.5,\\,2.2,\\,2.8,\\,3.2,\\,3.8\\,\\}\\,$.\n  - 真实参数 $\\,(\\epsilon_{\\infty}, F_{1}, E_{1}\\,(\\mathrm{eV}), \\Gamma_{1}\\,(\\mathrm{eV})) = (\\,1.5,\\,8.0,\\,3.0,\\,0.3\\,)\\,$.\n  - 初始猜测值 $\\,(\\epsilon_{\\infty}, F_{1}, E_{1}, \\Gamma_{1}) = (\\,1.2,\\,5.0,\\,2.5,\\,0.2\\,)\\,$.\n\n- 用例 $\\,2\\,$（窄带间特征，小阻尼）：\n  - 能量采样点 $\\,E\\,(\\mathrm{eV}):\\,\\{\\,1.8,\\,2.0,\\,2.1,\\,2.2,\\,2.3,\\,2.5\\,\\}\\,$.\n  - 真实参数 $\\,(\\epsilon_{\\infty}, F_{1}, E_{1}\\,(\\mathrm{eV}), \\Gamma_{1}\\,(\\mathrm{eV})) = (\\,1.2,\\,6.0,\\,2.2,\\,0.05\\,)\\,$.\n  - 初始猜测值 $\\,(\\epsilon_{\\infty}, F_{1}, E_{1}, \\Gamma_{1}) = (\\,1.0,\\,4.0,\\,2.0,\\,0.1\\,)\\,$.\n\n- 用例 $\\,3\\,$（由两个洛伦兹振子近似的两个带间临界点）：\n  - 能量采样点 $\\,E\\,(\\mathrm{eV}):\\,\\{\\,1.4,\\,2.0,\\,2.6,\\,3.2,\\,3.6,\\,4.0\\,\\}\\,$.\n  - 真实参数 $\\,(\\epsilon_{\\infty}, F_{1}, E_{1}\\,(\\mathrm{eV}), \\Gamma_{1}\\,(\\mathrm{eV}), F_{2}, E_{2}\\,(\\mathrm{eV}), \\Gamma_{2}\\,(\\mathrm{eV})) = (\\,1.0,\\,7.0,\\,2.0,\\,0.25,\\,3.0,\\,3.6,\\,0.4\\,)\\,$.\n  - 初始猜测值 $\\,(\\epsilon_{\\infty}, F_{1}, E_{1}, \\Gamma_{1}, F_{2}, E_{2}, \\Gamma_{2}) = (\\,1.2,\\,5.0,\\,1.8,\\,0.2,\\,2.0,\\,3.5,\\,0.3\\,)\\,$.\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含 $\\,3\\,$ 个 RMS 误差 $\\,\\mathrm{RMS}_{\\epsilon}\\,$，每个测试用例一个，按上述顺序列出，格式为逗号分隔的列表并用方括号括起来，例如 $\\,\\left[\\mathrm{err}_{1},\\mathrm{err}_{2},\\mathrm{err}_{3}\\right]\\,$。\n- 每个数字必须以浮点值的形式打印，并四舍五入到六位小数。", "solution": "该问题陈述是一个有效且定义良好的科学计算任务。它在科学上基于经典电磁学和固态物理学的原理，其表述客观，并提供了进行求解所需的所有必要信息。未检测到不一致或缺陷。\n\n任务是使用光谱椭偏法的模拟，为一个材料的光学特性（特别是其复介电函数）实现一个参数提取程序。这涉及一个三步过程：定义正向模型、执行逆回归和计算误差度量。\n\n首先，构建正向模型以从一组物理参数预测实验可观测量——复椭偏比 $\\rho(E)$。材料对电磁场的响应由复介电函数模型 $\\epsilon(E)$ 描述，其中 $E$ 是光子能量。问题指定了一个洛伦兹振子模型，该模型适用于描述电子带间跃迁。对于 $N$ 个此类跃迁，模型为：\n$$\n\\epsilon(E; \\boldsymbol{\\theta}) = \\epsilon_{\\infty} + \\sum_{j=1}^{N}\\frac{F_{j}\\,E_{j}^{2}}{E_{j}^{2} - E^{2} - i\\,\\Gamma_{j}\\,E}\n$$\n参数矢量 $\\boldsymbol{\\theta}$ 由一个高频介电常数 $\\epsilon_{\\infty}$ 以及每个振子的强度 $F_{j}$、共振能量 $E_{j}$ 和阻尼参数 $\\Gamma_{j}$ 组成。\n\n椭偏测量本身使用菲涅尔方程进行建模，该方程描述了在真空环境（介电常数 $\\epsilon_{0}=1$）和半无限材料之间的平面界面处的反射。对于入射角 $\\theta$，s 偏振光和 p 偏振光的反射系数由以下公式给出：\n$$\nr_{s}(E, \\theta) = \\frac{\\cos\\theta - \\beta(E, \\theta)}{\\cos\\theta + \\beta(E, \\theta)}\n$$\n$$\nr_{p}(E, \\theta) = \\frac{\\epsilon(E)\\cos\\theta - \\beta(E, \\theta)}{\\epsilon(E)\\cos\\theta + \\beta(E, \\theta)}\n$$\n其中 $\\beta(E, \\theta) = \\sqrt{\\epsilon(E) - \\sin^{2}\\theta}$。入射角 $\\theta$ 以度为单位给出，在计算时必须转换为弧度。必须为 $\\beta$ 选择物理上正确的复平方根分支，即实部非负的分支。标准数值库会自动处理此问题。\n\n可观测量 $\\rho$ 是这些系数的比值：\n$$\n\\rho(E; \\boldsymbol{\\theta}) = \\frac{r_{p}(E, \\theta)}{r_{s}(E, \\theta)}\n$$\n这组方程构成了正向模型，它接受参数矢量 $\\boldsymbol{\\theta}$ 并在一系列离散能量 $\\{E_{k}\\}$ 处生成预测的椭偏谱 $\\rho(E_{k})$。\n\n其次，逆问题是从测量数据中确定模型参数。问题指定了非线性最小二乘回归。使用具有一组已知真实参数 $\\boldsymbol{\\theta}_{\\mathrm{true}}$ 的正向模型生成合成“测量”数据 $\\rho_{\\mathrm{meas}}(E_{k})$。目标是找到一个估计的参数矢量 $\\widehat{\\boldsymbol{\\theta}}$，使模型预测与合成数据之间的残差平方和最小化。要最小化的目标函数是：\n$$\n\\min_{\\boldsymbol{\\theta}} \\sum_{k} \\left| \\rho(E_{k}; \\boldsymbol{\\theta}) - \\rho_{\\mathrm{meas}}(E_{k}) \\right|^{2}\n$$\n这等同于最小化残差的实部和虚部的平方和。此最小化问题将使用 `scipy.optimize.least_squares` 函数解决，该函数非常适合此类任务。该函数需要一个残差矢量，它将通过连接复数差 $\\rho(E_{k}; \\boldsymbol{\\theta}) - \\rho_{\\mathrm{meas}}(E_{k})$ 的实部和虚部来构建一个一维实数数组。优化从一个初始猜测值 $\\boldsymbol{\\theta}_{\\mathrm{initial}}$ 开始，并受到参数的物理意义边界的约束：$\\epsilon_{\\infty} > 0$、$F_{j} \\ge 0$、$E_{j} > 0$ 和 $\\Gamma_{j} > 0$。为了数值稳健性，严格为正的下界实现为一个小的正数（例如 $10^{-9}$）。\n\n第三，在回归得到估计参数 $\\widehat{\\boldsymbol{\\theta}}$ 之后，必须评估结果的准确性。这是通过将从估计参数计算出的介电函数 $\\widehat{\\epsilon}(E_{k}) = \\epsilon(E_{k}; \\widehat{\\boldsymbol{\\theta}})$ 与已知的真实介电函数 $\\epsilon_{\\mathrm{true}}(E_{k}) = \\epsilon(E_{k}; \\boldsymbol{\\theta}_{\\mathrm{true}})$ 进行比较来完成的。使用均方根 (RMS) 幅值误差进行此比较：\n$$\n\\mathrm{RMS}_{\\epsilon} = \\sqrt{\\frac{1}{K}\\sum_{k=1}^{K}\\left|\\widehat{\\epsilon}(E_{k}) - \\epsilon_{\\mathrm{true}}(E_{k})\\right|^{2}}\n$$\n这个无量纲的度量提供了对恢复的介电函数中平均误差的定量测量。\n\n整个算法将应用于指定的三个测试用例中的每一个。对于给定的用例，我们计算 $\\rho_{\\mathrm{meas}}$，执行回归以找到 $\\widehat{\\boldsymbol{\\theta}}$，然后计算最终的 $\\mathrm{RMS}_{\\epsilon}$。然后收集所有用例的结果并按要求格式化。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Solves the Spectroscopic Ellipsometry parameter extraction problem for three test cases.\n    \"\"\"\n\n    # Angle of incidence for all experiments.\n    angle_deg = 70.0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Single Lorentz oscillator\n        {\n            \"energies_eV\": np.array([1.5, 2.2, 2.8, 3.2, 3.8]),\n            \"true_params\": np.array([1.5, 8.0, 3.0, 0.3]),\n            \"initial_guess\": np.array([1.2, 5.0, 2.5, 0.2]),\n        },\n        # Case 2: Narrow feature, small damping\n        {\n            \"energies_eV\": np.array([1.8, 2.0, 2.1, 2.2, 2.3, 2.5]),\n            \"true_params\": np.array([1.2, 6.0, 2.2, 0.05]),\n            \"initial_guess\": np.array([1.0, 4.0, 2.0, 0.1]),\n        },\n        # Case 3: Two Lorentz oscillators\n        {\n            \"energies_eV\": np.array([1.4, 2.0, 2.6, 3.2, 3.6, 4.0]),\n            \"true_params\": np.array([1.0, 7.0, 2.0, 0.25, 3.0, 3.6, 0.4]),\n            \"initial_guess\": np.array([1.2, 5.0, 1.8, 0.2, 2.0, 3.5, 0.3]),\n        },\n    ]\n\n    # --- Helper functions for the forward model and regression ---\n\n    def lorentz_epsilon(params, energies):\n        \"\"\"Calculates the complex dielectric function from Lorentz oscillator parameters.\"\"\"\n        eps_inf = params[0]\n        num_oscillators = (len(params) - 1) // 3\n        osc_params = params[1:].reshape(num_oscillators, 3) # (F, E, Gamma)\n        \n        epsilon_sum = np.zeros_like(energies, dtype=complex)\n        for F_j, E_j, Gamma_j in osc_params:\n            denominator = E_j**2 - energies**2 - 1j * Gamma_j * energies\n            epsilon_sum += (F_j * E_j**2) / denominator\n            \n        return eps_inf + epsilon_sum\n\n    def calculate_rho(params, energies, angle_rad):\n        \"\"\"Calculates the complex ellipsometric ratio rho.\"\"\"\n        epsilon = lorentz_epsilon(params, energies)\n        \n        sin_theta_sq = np.sin(angle_rad)**2\n        cos_theta = np.cos(angle_rad)\n        \n        beta = np.sqrt(epsilon - sin_theta_sq)\n        \n        r_s = (cos_theta - beta) / (cos_theta + beta)\n        r_p = (epsilon * cos_theta - beta) / (epsilon * cos_theta + beta)\n        \n        # Avoid division by zero in the unlikely case r_s is zero\n        rho = np.full_like(r_s, np.inf + 0j)\n        mask = r_s != 0\n        rho[mask] = r_p[mask] / r_s[mask]\n        \n        return rho\n\n    def residuals(params, energies, angle_rad, rho_meas):\n        \"\"\"Calculates the residual vector for the least-squares fit.\"\"\"\n        rho_model = calculate_rho(params, energies, angle_rad)\n        diff = rho_model - rho_meas\n        # Return a 1D real array stacking real and imaginary parts\n        return np.concatenate((diff.real, diff.imag))\n\n    # --- Main loop to process test cases ---\n    \n    results = []\n    angle_rad = np.deg2rad(angle_deg)\n\n    for case in test_cases:\n        energies = case[\"energies_eV\"]\n        true_params = case[\"true_params\"]\n        initial_guess = case[\"initial_guess\"]\n        \n        num_oscillators = (len(true_params) - 1) // 3\n        \n        # 1. Generate synthetic measurement data using ground-truth parameters\n        rho_meas = calculate_rho(true_params, energies, angle_rad)\n        \n        # 2. Set up bounds for the regression parameters\n        # eps_inf > 0, F_j >= 0, E_j > 0, Gamma_j > 0\n        lower_bounds = [1e-9]  # eps_inf\n        upper_bounds = [np.inf]\n        for _ in range(num_oscillators):\n            lower_bounds.extend([0.0, 1e-9, 1e-9])  # F, E, Gamma\n            upper_bounds.extend([np.inf, np.inf, np.inf])\n            \n        # 3. Perform nonlinear least-squares regression\n        opt_result = least_squares(\n            residuals,\n            initial_guess,\n            args=(energies, angle_rad, rho_meas),\n            bounds=(lower_bounds, upper_bounds),\n            method='trf'\n        )\n        estimated_params = opt_result.x\n        \n        # 4. Calculate dielectric functions from true and estimated parameters\n        epsilon_true = lorentz_epsilon(true_params, energies)\n        epsilon_estimated = lorentz_epsilon(estimated_params, energies)\n        \n        # 5. Compute the RMS magnitude error\n        rms_error = np.sqrt(np.mean(np.abs(epsilon_estimated - epsilon_true)**2))\n        results.append(rms_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2819423"}]}