{"hands_on_practices": [{"introduction": "洛伦兹局域场 $E_L = P/(3\\epsilon_0)$ 的经典结果是基于一个高度对称的假设——即原子排列具有立方对称性或介质是完全各向同性的。但在真实的晶体材料中，这种理想情况并不总是存在。本练习将引导你通过直接计算来探究当晶体结构偏离立方对称性时（例如，在一个假想的四方晶格中），局域场将如何表现出各向异性，这个实践将加深你对微观结构如何决定宏观电学响应的理解。[@problem_id:1818305]", "problem": "一个假想的介电晶体由排列成简正方晶格的原子组成，其晶格常数为 $a=b$ 和 $c$，其中 $a \\neq c$。当施加外部电场时，每个原子都会产生一个感应偶极矩 $\\vec{p}$，其方向与原子所在位置的局域电场方向一致。\n\n任何给定原子的局域电场是外部电场与晶体中所有其他原子偶极子产生的电场之和。为分析周围偶极子的贡献，我们关注位于原点 $(0,0,0)$ 的原子其最近邻原子所产生的电场。对于简正方晶格，这些最近邻原子位于六个位置：$(\\pm a, 0, 0)$、$(0, \\pm a, 0)$ 和 $(0, 0, \\pm c)$。\n\n我们将研究感应偶极子的取向如何影响这个最近邻电场贡献，我们将其记为 $\\vec{E}_{nn}$。\n\n考虑两种不同的情况：\n1.  晶体中所有原子都具有偶极矩 $\\vec{p} = p\\hat{k}$，其中 $p$ 是一个恒定的量值，$\\hat{k}$ 是沿z轴（与c轴平行）的单位矢量。设 $(E_{nn})_z$ 是原点处最近邻电场 $\\vec{E}_{nn}$ 沿z轴的分量。\n2.  晶体中所有原子都具有偶极矩 $\\vec{p} = p\\hat{i}$，其中 $\\hat{i}$ 是沿x轴（与其中一个a轴平行）的单位矢量。设 $(E_{nn})_x$ 是原点处最近邻电场 $\\vec{E}_{nn}$ 沿x轴的分量。\n\n计算差值 $(E_{nn})_z - (E_{nn})_x$。用偶极矩量值 $p$、晶格常数 $a$ 和 $c$ 以及真空介电常数 $\\epsilon_0$ 来表示你的最终答案的解析表达式。", "solution": "由点偶极子 $\\vec{p}$ 在距离偶极子 $\\vec{r}$ 矢量位置处产生的电场 $\\vec{E}$ 为：\n$$ \\vec{E}(\\vec{r}) = \\frac{1}{4\\pi\\epsilon_0} \\left( \\frac{3(\\vec{p} \\cdot \\vec{r})\\vec{r}}{r^5} - \\frac{\\vec{p}}{r^3} \\right) $$\n原点处的电场 $\\vec{E}_{nn}$ 是来自六个最近邻原子的电场的矢量和。\n\n**步骤 1：计算情况 1 下的 $(E_{nn})_z$**\n\n在此情况下，所有偶极子均为 $\\vec{p} = p\\hat{k}$。我们需要计算原点处总电场的z分量，即 $(E_{nn})_z = \\vec{E}_{nn} \\cdot \\hat{k}$。\n\n六个最近邻原子位于：\n- 两个邻居在 $\\vec{r}_{1,2} = \\pm a\\hat{i}$。对于它们，$r=a$ 且 $\\vec{p} \\cdot \\vec{r} = (p\\hat{k}) \\cdot (\\pm a\\hat{i}) = 0$。\n这两个偶极子各自产生的电场为 $\\vec{E}_{1,2} = \\frac{1}{4\\pi\\epsilon_0} (0 - \\frac{p\\hat{k}}{a^3})$。其z分量为 $-\\frac{p}{4\\pi\\epsilon_0 a^3}$。\n- 两个邻居在 $\\vec{r}_{3,4} = \\pm a\\hat{j}$。对于它们，$r=a$ 且 $\\vec{p} \\cdot \\vec{r} = (p\\hat{k}) \\cdot (\\pm a\\hat{j}) = 0$。\n每个偶极子产生的电场为 $\\vec{E}_{3,4} = \\frac{1}{4\\pi\\epsilon_0} (0 - \\frac{p\\hat{k}}{a^3})$。其z分量为 $-\\frac{p}{4\\pi\\epsilon_0 a^3}$。\n- 两个邻居在 $\\vec{r}_{5,6} = \\pm c\\hat{k}$。对于它们，$r=c$。对于 $\\vec{r}_5 = c\\hat{k}$，$\\vec{p} \\cdot \\vec{r}_5 = (p\\hat{k}) \\cdot (c\\hat{k}) = pc$。\n该偶极子产生的电场为 $\\vec{E}_5 = \\frac{1}{4\\pi\\epsilon_0} (\\frac{3(pc)(c\\hat{k})}{c^5} - \\frac{p\\hat{k}}{c^3}) = \\frac{p}{4\\pi\\epsilon_0 c^3}(3\\hat{k} - \\hat{k}) = \\frac{2p}{4\\pi\\epsilon_0 c^3}\\hat{k}$。\nz分量为 $\\frac{2p}{4\\pi\\epsilon_0 c^3}$。\n对于 $\\vec{r}_6 = -c\\hat{k}$，$\\vec{p} \\cdot \\vec{r}_6 = (p\\hat{k}) \\cdot (-c\\hat{k}) = -pc$。\n电场为 $\\vec{E}_6 = \\frac{1}{4\\pi\\epsilon_0} (\\frac{3(-pc)(-c\\hat{k})}{c^5} - \\frac{p\\hat{k}}{c^3}) = \\frac{p}{4\\pi\\epsilon_0 c^3}(3\\hat{k} - \\hat{k}) = \\frac{2p}{4\\pi\\epsilon_0 c^3}\\hat{k}$。\nz分量也为 $\\frac{2p}{4\\pi\\epsilon_0 c^3}$。\n\n将所有六个邻居的z分量相加：\n$$ (E_{nn})_z = 2 \\left( -\\frac{p}{4\\pi\\epsilon_0 a^3} \\right) + 2 \\left( -\\frac{p}{4\\pi\\epsilon_0 a^3} \\right) + 2 \\left( \\frac{2p}{4\\pi\\epsilon_0 c^3} \\right) $$\n$$ (E_{nn})_z = \\frac{p}{4\\pi\\epsilon_0} \\left( -\\frac{4}{a^3} + \\frac{4}{c^3} \\right) = \\frac{p}{\\pi\\epsilon_0} \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) $$\n\n**步骤 2：计算情况 2 下的 $(E_{nn})_x$**\n\n在此情况下，所有偶极子均为 $\\vec{p} = p\\hat{i}$。我们需要计算总电场的x分量，即 $(E_{nn})_x = \\vec{E}_{nn} \\cdot \\hat{i}$。\n\n- 两个邻居在 $\\vec{r}_{1,2} = \\pm a\\hat{i}$。对于它们，$r=a$。对于 $\\vec{r}_1=a\\hat{i}$，$\\vec{p}\\cdot\\vec{r}_1 = (p\\hat{i})\\cdot(a\\hat{i}) = pa$。\n该偶极子产生的电场为 $\\vec{E}_1 = \\frac{1}{4\\pi\\epsilon_0} (\\frac{3(pa)(a\\hat{i})}{a^5} - \\frac{p\\hat{i}}{a^3}) = \\frac{2p}{4\\pi\\epsilon_0 a^3}\\hat{i}$。x分量为 $\\frac{2p}{4\\pi\\epsilon_0 a^3}$。根据对称性，位于 $\\vec{r}_2=-a\\hat{i}$ 的偶极子产生相同的电场。\n- 两个邻居在 $\\vec{r}_{3,4} = \\pm a\\hat{j}$。对于它们，$r=a$ 且 $\\vec{p} \\cdot \\vec{r} = (p\\hat{i}) \\cdot (\\pm a\\hat{j}) = 0$。\n每个偶极子产生的电场为 $\\vec{E}_{3,4} = \\frac{1}{4\\pi\\epsilon_0} (0 - \\frac{p\\hat{i}}{a^3})$。x分量为 $-\\frac{p}{4\\pi\\epsilon_0 a^3}$。\n- 两个邻居在 $\\vec{r}_{5,6} = \\pm c\\hat{k}$。对于它们，$r=c$ 且 $\\vec{p} \\cdot \\vec{r} = (p\\hat{i}) \\cdot (\\pm c\\hat{k}) = 0$。\n每个偶极子产生的电场为 $\\vec{E}_{5,6} = \\frac{1}{4\\pi\\epsilon_0} (0 - \\frac{p\\hat{i}}{c^3})$。x分量为 $-\\frac{p}{4\\pi\\epsilon_0 c^3}$。\n\n将所有六个邻居的x分量相加：\n$$ (E_{nn})_x = 2 \\left( \\frac{2p}{4\\pi\\epsilon_0 a^3} \\right) + 2 \\left( -\\frac{p}{4\\pi\\epsilon_0 a^3} \\right) + 2 \\left( -\\frac{p}{4\\pi\\epsilon_0 c^3} \\right) $$\n$$ (E_{nn})_x = \\frac{p}{4\\pi\\epsilon_0} \\left( \\frac{4}{a^3} - \\frac{2}{a^3} - \\frac{2}{c^3} \\right) = \\frac{p}{4\\pi\\epsilon_0} \\left( \\frac{2}{a^3} - \\frac{2}{c^3} \\right) = \\frac{p}{2\\pi\\epsilon_0} \\left( \\frac{1}{a^3} - \\frac{1}{c^3} \\right) $$\n\n**步骤 3：计算差值 $(E_{nn})_z - (E_{nn})_x$**\n\n现在我们用 $(E_{nn})_z$ 的表达式减去 $(E_{nn})_x$ 的表达式：\n$$ (E_{nn})_z - (E_{nn})_x = \\frac{p}{\\pi\\epsilon_0} \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) - \\frac{p}{2\\pi\\epsilon_0} \\left( \\frac{1}{a^3} - \\frac{1}{c^3} \\right) $$\n为了合并这些项，我们提出公因子 $\\frac{p}{2\\pi\\epsilon_0}$ 并重写第二项：\n$$ (E_{nn})_z - (E_{nn})_x = \\frac{p}{\\pi\\epsilon_0} \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) + \\frac{p}{2\\pi\\epsilon_0} \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) $$\n$$ (E_{nn})_z - (E_{nn})_x = \\frac{p}{2\\pi\\epsilon_0} \\left[ 2\\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) + \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) \\right] $$\n$$ (E_{nn})_z - (E_{nn})_x = \\frac{p}{2\\pi\\epsilon_0} \\left[ 3\\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) \\right] $$\n$$ (E_{nn})_z - (E_{nn})_x = \\frac{3p}{2\\pi\\epsilon_0} \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) $$\n这个结果表明，内部电场贡献是各向异性的（即，它依赖于方向），并且只有当 $a=c$ 时（对应于立方晶格的情况），这种各向异性才会消失。", "answer": "$$\\boxed{\\frac{3p}{2\\pi\\epsilon_0} \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right)}$$", "id": "1818305"}, {"introduction": "从连续介质模型推导出的洛伦兹场是一个优雅的理论结果，但它在多大程度上精确地描述了由分立原子构成的真实晶格？本计算练习为你提供了一个用数值方法检验这一核心近似的机会。你将通过编写程序，直接对特定晶格结构（如简立方、体心立方和面心立方）中离散偶极子的电场进行求和，并与连续介质理论的预测进行比较。这项实践不仅能锻炼你的计算物理技能，还能让你直观地感受从离散到连续的过渡，并理解模型近似所带来的误差。[@problem_id:2836885]", "problem": "一个相对介电常数为 $\\varepsilon_{r}$ 的无限、均匀、线性、各向同性的电介质中，包含一个半径为 $a$ 的球形空腔（真空）。在远离空腔处，电介质内部的宏观电场是均匀的，大小为 $E$，方向沿 $z$ 轴。假设为静电情形（不随时间变化），体内没有自由电荷，并且空腔足够小，可以忽略任何远端边界的边缘效应。\n\n仅从静电学中的麦克斯韦方程组、线性电介质中的本构关系 $\\mathbf{D}=\\varepsilon \\mathbf{E}$ 以及电介质界面上的标准边界条件出发，完成以下任务：\n\n- 通过求解两个区域（空腔内的真空和外部的电介质）中标量势的相应边值问题，确定球形空腔中心处的精确电场。\n- 独立地，将洛伦兹腔场定义为腔中心的宏观电场与束缚面电荷在中心产生的电场之和，该束缚面电荷存在于从均匀极化电介质中挖出的球形空腔的表面。利用周围电介质的极化强度计算此洛伦兹腔场。\n\n设电介质的介电常数为 $\\varepsilon=\\varepsilon_{0}\\varepsilon_{r}$，其中 $\\varepsilon_{0}$ 是真空介电常数。以一个关于 $\\varepsilon_{r}$ 的闭合解析表达式的形式，报告比值\n$$\nR(\\varepsilon_{r})=\\frac{E_{\\text{void}}}{E_{\\text{L}}},\n$$\n其中 $E_{\\text{void}}$ 是空腔中心处精确电场的大小，$E_{\\text{L}}$ 是该点洛伦兹腔场的大小。最终答案是无量纲的，无需四舍五入。", "solution": "在进行求解之前，对问题陈述进行严格分析和验证。\n\n### 步骤1：提取已知条件\n- 材料：一个无限、均匀、线性、各向同性的电介质。\n- 相对介电常数：$\\varepsilon_{r}$。\n- 几何形状：一个半径为 $a$ 的球形空腔包含在电介质中。\n- 外部条件：远离空腔处，电介质内部的宏观电场是均匀的，大小为 $E$，方向沿 $z$ 轴。\n- 物理体系：静电学（不随时间变化）。\n- 电荷：体内没有自由电荷。\n- 假设：空腔很小，可以忽略远端边界的边缘效应。\n- 定义：$\\varepsilon = \\varepsilon_{0}\\varepsilon_{r}$，其中 $\\varepsilon_{0}$ 是真空介电常数。\n- 任务1：通过求解标量势的边值问题，确定球形空腔中心的精确电场大小 $E_{\\text{void}}$。\n- 任务2：独立地，计算腔中心的洛伦兹腔场大小 $E_{\\text{L}}$。\n- 最终输出：报告比值 $R(\\varepsilon_{r})=\\frac{E_{\\text{void}}}{E_{\\text{L}}}$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于静电学的基本原理，特别是麦克斯韦方程组和线性电介质的行为。电介质中的空腔情景是物理学中一个经典的、经过充分研究的问题。该问题在科学上是合理的。\n- **适定性**：该问题是适定的。几何形状、材料属性和边界条件（无穷远处场均匀）都已指定，这保证了通过拉普拉斯方程可以得到静电势的唯一解。\n- **客观性**：问题陈述使用了物理学和工程学中常见的精确、客观的语言。它没有主观性或歧义。\n- **完整性**：解决问题所需的所有信息都已提供。\n\n### 步骤3：结论与行动\n问题是有效的。这是一个电磁学中的标准问题，具有科学合理性、适定性和客观性。将提供完整的解答。\n\n### 解答推导\n\n问题需要进行两个独立的计算：空腔中的精确电场 $E_{\\text{void}}$ 和洛伦兹腔场 $E_{\\text{L}}$。\n\n#### 第1部分：精确电场（$E_{\\text{void}}$）的计算\n\n我们在两个区域求解静电势 $\\Phi$：空腔内部（区域1：$r < a$）和外部电介质中（区域2：$r > a$）。由于没有自由电荷，电势在两个区域都满足拉普拉斯方程 $\\nabla^{2}\\Phi = 0$。由于外部电场沿 $z$ 轴施加，具有轴对称性，我们使用球坐标 $(r, \\theta, \\phi)$，并寻找与 $\\phi$ 无关的解。\n\n具有方位角对称性的拉普拉斯方程的通解是一系列勒让德多项式 $P_{l}(\\cos\\theta)$：\n$$ \\Phi(r, \\theta) = \\sum_{l=0}^{\\infty} (A_{l}r^{l} + B_{l}r^{-(l+1)}) P_{l}(\\cos\\theta) $$\n\n**区域1：空腔内部 ($r < a$)**\n电势 $\\Phi_{1}$ 在原点 ($r=0$) 处必须是有限的。这要求所有系数 $B_{l}$ 都为零。\n$$ \\Phi_{1}(r, \\theta) = \\sum_{l=0}^{\\infty} A_{l}r^{l} P_{l}(\\cos\\theta) $$\n\n**区域2：外部电介质中 ($r > a$)**\n在远离空腔处 ($r \\to \\infty$)，电势 $\\Phi_{2}$ 必须对应于均匀的宏观电场 $\\mathbf{E} = E\\hat{\\mathbf{z}}$。该电场的电势为 $\\Phi_{\\infty} = -Ez = -Er\\cos\\theta = -ErP_{1}(\\cos\\theta)$。由空腔存在引起的电势在无穷远处必须消失。因此，解的形式为：\n$$ \\Phi_{2}(r, \\theta) = -Er\\cos\\theta + \\sum_{l=0}^{\\infty} B_{l}r^{-(l+1)} P_{l}(\\cos\\theta) $$\n\n我们在球面 $r=a$ 处应用边界条件：\n1.  电势的连续性：$\\Phi_{1}(a, \\theta) = \\Phi_{2}(a, \\theta)$。\n    $$ \\sum_{l=0}^{\\infty} A_{l}a^{l} P_{l}(\\cos\\theta) = -EaP_{1}(\\cos\\theta) + \\sum_{l=0}^{\\infty} B_{l}a^{-(l+1)} P_{l}(\\cos\\theta) $$\n    根据勒让德多项式的正交性，我们可以对每个 $l$ 的系数进行等式化：\n    $$ A_{l}a^{l} = -Ea\\delta_{l1} + B_{l}a^{-(l+1)} $$\n    其中 $\\delta_{l1}$ 是克罗内克δ函数。\n\n2.  电位移矢量 $\\mathbf{D} = \\varepsilon\\mathbf{E} = -\\varepsilon\\nabla\\Phi$ 的法向分量的连续性。法向为 $\\hat{\\mathbf{r}}$。\n    $$ \\varepsilon_{1} \\frac{\\partial\\Phi_{1}}{\\partial r}\\bigg|_{r=a} = \\varepsilon_{2} \\frac{\\partial\\Phi_{2}}{\\partial r}\\bigg|_{r=a} $$\n    这里，$\\varepsilon_1 = \\varepsilon_0$（真空），$\\varepsilon_2 = \\varepsilon = \\varepsilon_{0}\\varepsilon_{r}$。\n    $$ \\varepsilon_{0} \\sum_{l=0}^{\\infty} A_{l}la^{l-1} P_{l}(\\cos\\theta) = \\varepsilon_{0}\\varepsilon_{r} \\left( -EP_{1}(\\cos\\theta) - \\sum_{l=0}^{\\infty} B_{l}(l+1)a^{-(l+2)} P_{l}(\\cos\\theta) \\right) $$\n    对每个 $l$ 的系数进行等式化：\n    $$ A_{l}la^{l-1} = \\varepsilon_{r} \\left( -E\\delta_{l1} - B_{l}(l+1)a^{-(l+2)} \\right) $$\n\n对于 $l \\neq 1$，方程变为：\n$A_{l}a^{l} = B_{l}a^{-(l+1)}$\n$A_{l}l a^{l-1} = -\\varepsilon_{r}B_{l}(l+1)a^{-(l+2)}$\n将 $B_{l} = A_{l}a^{2l+1}$ 代入第二个方程得到 $A_{l}l = -\\varepsilon_{r}A_{l}(l+1)$，即 $A_{l}(l + \\varepsilon_{r}(l+1)) = 0$。由于 $l \\ge 0$ 且 $\\varepsilon_{r} \\ge 1$，括号中的项不为零，因此对于所有 $l \\neq 1$，$A_{l}=0$ 且 $B_{l}=0$。\n\n对于 $l=1$，方程组为：\n1) $A_{1}a = -Ea + B_{1}a^{-2}$\n2) $A_{1} = \\varepsilon_{r}(-E - 2B_{1}a^{-3})$\n\n从 (1) 中，我们将 $B_{1}$ 表示为 $B_{1} = a^{3}(A_{1} + E)$。将其代入 (2) 中：\n$A_{1} = \\varepsilon_{r}(-E - 2a^{-3} \\cdot a^{3}(A_{1} + E))$\n$A_{1} = -\\varepsilon_{r}E - 2\\varepsilon_{r}(A_{1} + E) = -\\varepsilon_{r}E - 2\\varepsilon_{r}A_{1} - 2\\varepsilon_{r}E$\n$A_{1}(1 + 2\\varepsilon_{r}) = -3\\varepsilon_{r}E$\n$$ A_{1} = -\\frac{3\\varepsilon_{r}}{2\\varepsilon_{r}+1} E $$\n空腔内部的电势则为 $\\Phi_{1}(r, \\theta) = A_{1}rP_{1}(\\cos\\theta) = A_{1}r\\cos\\theta = A_{1}z$。\n空腔内部的电场是均匀的：\n$$ \\mathbf{E}_{\\text{void}} = -\\nabla\\Phi_{1} = -\\frac{\\partial}{\\partial z}(A_{1}z)\\hat{\\mathbf{z}} = -A_{1}\\hat{\\mathbf{z}} $$\n$$ \\mathbf{E}_{\\text{void}} = \\frac{3\\varepsilon_{r}}{2\\varepsilon_{r}+1} E \\hat{\\mathbf{z}} $$\n该电场的大小为：\n$$ E_{\\text{void}} = \\frac{3\\varepsilon_{r}}{2\\varepsilon_{r}+1} E $$\n\n#### 第2部分：洛伦兹腔场（$E_{\\text{L}}$）的计算\n\n洛伦兹腔场是宏观电场 $\\mathbf{E}$ 与由腔壁上的束缚面电荷在腔中心产生的电场 $\\mathbf{E}_{\\text{surf}}$ 之和。\n$$ \\mathbf{E}_{\\text{L}} = \\mathbf{E} + \\mathbf{E}_{\\text{surf}} $$\n宏观电场给定为 $\\mathbf{E} = E\\hat{\\mathbf{z}}$。线性电介质中的极化强度 $\\mathbf{P}$ 通过 $\\mathbf{P} = \\varepsilon_{0}(\\varepsilon_{r}-1)\\mathbf{E}$ 与 $\\mathbf{E}$ 相关。\n$$ \\mathbf{P} = \\varepsilon_{0}(\\varepsilon_{r}-1)E\\hat{\\mathbf{z}} = P\\hat{\\mathbf{z}} $$\n腔表面的束缚面电荷密度 $\\sigma_{b}$ 由 $\\sigma_{b} = \\mathbf{P} \\cdot \\hat{\\mathbf{n}}$ 给出，其中 $\\hat{\\mathbf{n}}$ 是从电介质指向外部（即指向腔内）的单位法向量。在由径向矢量 $\\mathbf{r}'$ 描述的球面上一点，$\\hat{\\mathbf{n}} = -\\hat{\\mathbf{r}}'$。\n$$ \\sigma_{b} = (P\\hat{\\mathbf{z}}) \\cdot (-\\hat{\\mathbf{r}}') = -P(\\hat{\\mathbf{z}}\\cdot\\hat{\\mathbf{r}}') = -P\\cos\\theta' $$\n其中 $\\theta'$ 是 $\\mathbf{r}'$ 与 $z$ 轴之间的夹角。\n由该电荷分布在球心（原点）产生的电场 $\\mathbf{E}_{\\text{surf}}$ 通过对球面 $S'$ 进行积分计算得出：\n$$ \\mathbf{E}_{\\text{surf}} = \\frac{1}{4\\pi\\varepsilon_{0}} \\int_{S'} \\frac{\\sigma_{b}dS'}{|\\mathbf{r}'|^{2}}(-\\hat{\\mathbf{r}}') = \\frac{1}{4\\pi\\varepsilon_{0}} \\int_{S'} \\frac{(-P\\cos\\theta')dS'}{a^{2}}(-\\hat{\\mathbf{r}}') = \\frac{P}{4\\pi\\varepsilon_{0}a^{2}} \\int_{S'} \\cos\\theta'\\hat{\\mathbf{r}}'dS' $$\n我们用笛卡尔坐标表示 $\\hat{\\mathbf{r}}'$：$\\hat{\\mathbf{r}}' = \\sin\\theta'\\cos\\phi'\\hat{\\mathbf{x}} + \\sin\\theta'\\sin\\phi'\\hat{\\mathbf{y}} + \\cos\\theta'\\hat{\\mathbf{z}}$。面元为 $dS' = a^{2}\\sin\\theta'd\\theta'd\\phi'$。\n由于对 $\\phi'$ 从 $0$ 到 $2\\pi$ 进行积分（$\\int_{0}^{2\\pi}\\cos\\phi'd\\phi'=0$ 和 $\\int_{0}^{2\\pi}\\sin\\phi'd\\phi'=0$），积分的x和y分量为零。\n积分的z分量为：\n$$ \\hat{\\mathbf{z}} \\int_{0}^{2\\pi}d\\phi' \\int_{0}^{\\pi} \\cos\\theta'(\\cos\\theta') a^{2}\\sin\\theta'd\\theta' = \\hat{\\mathbf{z}} (2\\pi a^{2}) \\int_{0}^{\\pi} \\cos^{2}\\theta'\\sin\\theta'd\\theta' $$\n令 $u=\\cos\\theta'$，$du=-\\sin\\theta'd\\theta'$。积分变为 $\\int_{1}^{-1} u^{2}(-du) = \\int_{-1}^{1} u^{2}du = [\\frac{u^{3}}{3}]_{-1}^{1} = \\frac{2}{3}$。\n因此，积分为 $\\hat{\\mathbf{z}} (2\\pi a^{2})(\\frac{2}{3}) = \\frac{4\\pi a^{2}}{3}\\hat{\\mathbf{z}}$。\n将此代回 $\\mathbf{E}_{\\text{surf}}$ 的表达式中：\n$$ \\mathbf{E}_{\\text{surf}} = \\frac{P}{4\\pi\\varepsilon_{0}a^{2}} \\left( \\frac{4\\pi a^{2}}{3}\\hat{\\mathbf{z}} \\right) = \\frac{P}{3\\varepsilon_{0}}\\hat{\\mathbf{z}} $$\n现在，代入 $P = \\varepsilon_{0}(\\varepsilon_{r}-1)E$：\n$$ \\mathbf{E}_{\\text{surf}} = \\frac{\\varepsilon_{0}(\\varepsilon_{r}-1)E}{3\\varepsilon_{0}}\\hat{\\mathbf{z}} = \\frac{\\varepsilon_{r}-1}{3}E\\hat{\\mathbf{z}} $$\n洛伦兹场则为：\n$$ \\mathbf{E}_{\\text{L}} = E\\hat{\\mathbf{z}} + \\frac{\\varepsilon_{r}-1}{3}E\\hat{\\mathbf{z}} = \\left(1 + \\frac{\\varepsilon_{r}-1}{3}\\right)E\\hat{\\mathbf{z}} = \\left(\\frac{3+\\varepsilon_{r}-1}{3}\\right)E\\hat{\\mathbf{z}} = \\frac{\\varepsilon_{r}+2}{3}E\\hat{\\mathbf{z}} $$\n洛伦兹场的大小为：\n$$ E_{\\text{L}} = \\frac{\\varepsilon_{r}+2}{3} E $$\n\n#### 第3部分：比值 $R(\\varepsilon_{r})$ 的计算\n最后，我们计算比值 $R(\\varepsilon_{r})=\\frac{E_{\\text{void}}}{E_{\\text{L}}}$。\n$$ R(\\varepsilon_{r}) = \\frac{\\frac{3\\varepsilon_{r}}{2\\varepsilon_{r}+1} E}{\\frac{\\varepsilon_{r}+2}{3} E} = \\frac{3\\varepsilon_{r}}{2\\varepsilon_{r}+1} \\cdot \\frac{3}{\\varepsilon_{r}+2} $$\n$$ R(\\varepsilon_{r}) = \\frac{9\\varepsilon_{r}}{(2\\varepsilon_{r}+1)(\\varepsilon_{r}+2)} $$\n这就是所要求的闭合解析表达式。", "answer": "$$\n\\boxed{\\frac{9\\varepsilon_r}{(2\\varepsilon_r+1)(\\varepsilon_r+2)}}\n$$", "id": "2836885"}, {"introduction": "从连续介质模型推导出的洛伦兹场是一个优雅的理论结果，但它在多大程度上精确地描述了由分立原子构成的真实晶格？本计算练习为你提供了一个用数值方法检验这一核心近似的机会。你将通过编写程序，直接对特定晶格结构（如简立方、体心立方和面心立方）中离散偶极子的电场进行求和，并与连续介质理论的预测进行比较。这项实践不仅能锻炼你的计算物理技能，还能让你直观地感受从离散到连续的过渡，并理解模型近似所带来的误差。[@problem_id:2836909]", "problem": "您的任务是通过显式地对一个晶格点周围挖出的球形腔外的离散偶极子场进行求和，来计算晶体电介质中对洛伦兹局域场的有限腔修正。请从以下基本依据出发：\n\n- 极化的定义：对于均匀极化 $\\mathbf{P} = P \\,\\hat{\\mathbf{z}}$，每个格点的偶极矩为 $\\boldsymbol{\\mu} = \\mu \\,\\hat{\\mathbf{z}}$，其中 $\\mu = P \\, V_{\\text{site}}$，$V_{\\text{site}}$ 是每个晶格点的体积。\n- 点偶极子的静电场：位于原点的点偶极子 $\\boldsymbol{\\mu}$ 在位置 $\\mathbf{r}$ 处产生的电场为\n$$\n\\mathbf{E}(\\mathbf{r}) = \\frac{1}{4\\pi \\varepsilon_0} \\left[\\frac{3(\\boldsymbol{\\mu}\\cdot \\hat{\\mathbf{r}})\\,\\hat{\\mathbf{r}} - \\boldsymbol{\\mu}}{r^3}\\right],\n$$\n其中 $\\hat{\\mathbf{r}} = \\mathbf{r}/r$，$r=\\|\\mathbf{r}\\|$。\n- 对于嵌入在均匀极化连续介质中的球形腔，腔外极化物质在腔中心产生的场沿 $\\hat{\\mathbf{z}}$ 方向等于 $E_{z}^{\\text{cont}} = P/(3\\varepsilon_0)$。在 $1/(4\\pi\\varepsilon_0)=1$ 的单位制中，此参考值等于 $E_{z}^{\\text{cont}} = 4\\pi P/3$。\n\n您将对三种立方晶格进行建模：简单立方（SC）、体心立方（BCC）和面心立方（FCC）。采用晶格常数为 $a$ 的常规立方晶胞，其基矢如下：\n- SC：一个位于分数坐标 $(0,0,0)$ 的格点，因此 $n_{\\text{site}}=1$。\n- BCC：格点位于 $(0,0,0)$ 和 $(\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{1}{2})$，因此 $n_{\\text{site}}=2$。\n- FCC：格点位于 $(0,0,0)$、$(0,\\tfrac{1}{2},\\tfrac{1}{2})$、$(\\tfrac{1}{2},0,\\tfrac{1}{2})$ 和 $(\\tfrac{1}{2},\\tfrac{1}{2},0)$，因此 $n_{\\text{site}}=4$。\n\n设 $\\mathbf{P}=P\\,\\hat{\\mathbf{z}}$，其中 $P$ 为常数。对于每种晶格类型，构建一个由整数索引 $(i,j,k)$ 构成的有限立方阵列，其中 $-N \\le i,j,k \\le N$，从而得到一个边长为 $(2N+1)a$ 的超胞。对于所选晶格中的每个基矢 $(\\xi,\\eta,\\zeta)$，将偶极子放置在位置 $\\mathbf{r} = a\\,(i+\\xi, j+\\eta, k+\\zeta)$ 处。通过排除所有满足 $r < R_c$ 的格点，移除中心位于原点、半径为 $R_c$ 的球形腔内的偶极子。如果原点处有格点，也应将其排除。为每个格点分配一个偶极矩 $\\boldsymbol{\\mu} = \\mu \\hat{\\mathbf{z}}$，其中 $\\mu = P a^3 / n_{\\text{site}}$，这与均匀极化一致。\n\n计算所有包含在内的偶极子在原点处产生的场的 $z$ 分量的离散估计值，\n$$\nE_{z}^{\\text{disc}}(R_c,N;\\text{lattice}) = \\sum_{\\mathbf{r}} \\left[\\frac{1}{4\\pi \\varepsilon_0}\\left(\\frac{3(\\boldsymbol{\\mu}\\cdot\\mathbf{r})\\,z}{r^5} - \\frac{\\mu}{r^3}\\right)\\right],\n$$\n其中 $z$ 是 $\\mathbf{r}$ 的 $z$ 坐标，求和遍及有限阵列中所有包含在内的偶极子。\n\n采用无量纲单位制，其中 $1/(4\\pi \\varepsilon_0)=1$ 且 $P=1$，因此 $E_{z}^{\\text{cont}}=4\\pi/3$ 且 $\\mu = a^3/n_{\\text{site}}$。\n\n将无量纲的有限腔修正定义为\n$$\n\\delta(R_c,N;\\text{lattice}) = \\frac{E_{z}^{\\text{disc}}(R_c,N;\\text{lattice})}{E_{z}^{\\text{cont}}} - 1.\n$$\n\n您的任务是实现一个程序，该程序：\n- 构建指定的晶格和基。\n- 对半径为 $R_c$ 的球形腔外、由 $N$ 设定的立方截断范围内的离散偶极子贡献进行求和。\n- 为每个测试用例计算 $\\delta(R_c,N;\\text{lattice})$。\n\n所有输出必须是无量纲实数（浮点数）。如果内部出现角度，必须以弧度处理。由于所选的单位归一化，输出中不出现国际单位制（SI）的量纲。\n\n用于评估覆盖范围的测试套件：\n- 用例 1：lattice $\\in\\{\\text{SC}\\}$，$a=1.0$，$R_c=1.2$，$N=10$（一般收敛情况）。\n- 用例 2：lattice $\\in\\{\\text{SC}\\}$，$a=1.0$，$R_c=0.51$，$N=10$（小腔半径，接近最近邻格点的排除距离）。\n- 用例 3：lattice $\\in\\{\\text{SC}\\}$，$a=1.0$，$R_c=1.2$，$N=3$（小截断半径，用于探究不完整壳层的收敛性）。\n- 用例 4：lattice $\\in\\{\\text{BCC}\\}$，$a=1.0$，$R_c=1.2$，$N=10$（不同的基密度）。\n- 用例 5：lattice $\\in\\{\\text{FCC}\\}$，$a=1.0$，$R_c=1.2$，$N=10$（密排基）。\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[result1,result2,result3]\"）。列表元素按顺序对应于上述用例，并且必须是为每个用例定义的 $\\delta$ 的数值。所有中间选择必须遵循上述定义，并且不允许外部输入。", "solution": "所给出的问题陈述是计算物理学中一个定义明确的练习。它要求通过直接对离散偶极子晶格的电场进行求和来计算局域场修正，这是电介质研究中的一个基本概念。该问题具有科学依据，内部一致，且所有参数都已指定。因此，它被认为是有效的，可以构建一个严谨的解决方案。\n\n任务是计算对洛伦兹局域场的有限腔修正。在给定晶格点上的局域场 $\\mathbf{E}_{\\text{local}}$ 是指除该点上的偶极子外，所有源产生的总电场。P. A. M. Lorentz 提出了一种计算方法，即在概念上围绕该格点挖出一个小的球形空腔。场随后被分解为来自腔内偶极子的贡献（“近场”）和腔外极化介质的贡献（“远场”）。\n\n在标准的洛伦兹模型中，球体外部均匀极化连续介质产生的远场在腔中心的贡献为 $\\mathbf{E}_{\\text{cont}} = \\mathbf{P}/(3\\varepsilon_0)$。然后对腔内的离散偶极子进行近场求和。对于具有高对称性（例如，立方对称性）的晶格，这个近场和为零，从而得到著名的洛伦兹关系。\n\n本问题重新审视了远场的贡献。我们不将其视为连续介质，而是通过对半径为 $R_c$ 的腔外、且边长为 $(2N+1)a$ 的有限立方体内的格点上的偶极子场进行直接的离散求和来计算它。这个离散和与连续介质值的偏差即为有限腔修正 $\\delta$。\n\n位于位置 $\\mathbf{r}$ 的点偶极子 $\\boldsymbol{\\mu}$ 在原点产生的电场由下式给出：\n$$\n\\mathbf{E}(\\mathbf{r}) = \\frac{1}{4\\pi \\varepsilon_0} \\left[ \\frac{3(\\boldsymbol{\\mu} \\cdot \\mathbf{r})\\mathbf{r}}{r^5} - \\frac{\\boldsymbol{\\mu}}{r^3} \\right]\n$$\n问题指定了均匀极化 $\\mathbf{P} = P \\hat{\\mathbf{z}}$，因此每个偶极矩为 $\\boldsymbol{\\mu} = \\mu \\hat{\\mathbf{z}}$。对于位置矢量 $\\mathbf{r} = (x, y, z)$，点积为 $\\boldsymbol{\\mu} \\cdot \\mathbf{r} = \\mu z$。来自这个单一偶极子的电场 $z$ 分量为：\n$$\nE_z = \\frac{\\mu}{4\\pi \\varepsilon_0} \\left( \\frac{3z^2}{r^5} - \\frac{1}{r^3} \\right)\n$$\n我们采用无量纲单位，使得 $1/(4\\pi\\varepsilon_0) = 1$，极化强度大小 $P=1$。每个格点的偶极矩为 $\\mu = P V_{\\text{site}}$。对于一个边长为 $a$、包含 $n_{\\text{site}}$ 个基元原子的常规立方晶胞，每个格点的体积为 $V_{\\text{site}} = a^3/n_{\\text{site}}$。因此，在这些单位下，偶极矩为 $\\mu = a^3/n_{\\text{site}}$。\n\n场 $z$ 分量的离散和 $E_z^{\\text{disc}}$ 是对所有满足两个条件的晶格点 $\\mathbf{r}_{i,j,k,\\beta}$ 进行的：\n1. 它们位于由整数索引 $-N \\le i, j, k \\le N$ 定义的计算超胞内。\n2. 它们位于半径为 $R_c$ 的球形腔外，即 $\\|\\mathbf{r}_{i,j,k,\\beta}\\| \\ge R_c$。\n一个格点的位置由 $\\mathbf{r}_{i,j,k,\\beta} = a((i, j, k) + (\\xi, \\eta, \\zeta)_{\\beta})$ 给出，其中 $(i,j,k)$ 是晶胞索引，$(\\xi, \\eta, \\zeta)_{\\beta}$ 是基元格点 $\\beta$ 的分数坐标。原点处的格点 $(\\mathbf{r} = \\mathbf{0})$ 被显式排除。\n\n总的离散场是以下和：\n$$\nE_{z}^{\\text{disc}}(R_c, N; \\text{lattice}) = \\sum_{i,j,k,\\beta \\text{ s.t. } r \\ge R_c, r \\ne 0} \\mu \\left( \\frac{3z_{i,j,k,\\beta}^2}{r_{i,j,k,\\beta}^5} - \\frac{1}{r_{i,j,k,\\beta}^3} \\right)\n$$\n在我们选择的单位中，参考连续介质场为 $E_z^{\\text{cont}} = 4\\pi P/3$。当 $P=1$ 时，此值为 $E_z^{\\text{cont}} = 4\\pi/3$。\n\n无量纲的有限腔修正 $\\delta$ 随后计算如下：\n$$\n\\delta(R_c, N; \\text{lattice}) = \\frac{E_{z}^{\\text{disc}}(R_c, N; \\text{lattice})}{E_{z}^{\\text{cont}}} - 1\n$$\n这个量衡量了用均匀连续介质替代腔外离散晶格所引入的相对误差。这个误差源于晶格的颗粒性以及求和体积的有限立方体形状。对于一个无限的、按球形求和的晶格，此修正将为零。\n\n要实现的算法如下：\n1. 对于每个由晶格类型（SC、BCC 或 FCC）、晶格常数 $a$、腔半径 $R_c$ 和超胞尺寸参数 $N$ 指定的测试用例，我们将总离散场 $E_{z}^{\\text{disc}}$ 初始化为 $0$。\n2. 我们为所选晶格定义基矢 $(\\xi, \\eta, \\zeta)$ 和格点数 $n_{\\text{site}}$。我们计算偶极矩 $\\mu = a^3/n_{\\text{site}}$。\n3. 我们遍历所有从 $-N$ 到 $N$ 的晶胞索引 $(i, j, k)$。\n4. 在每个晶胞内，我们遍历所有基矢。对于每个格点，我们计算其位置矢量 $\\mathbf{r} = (x, y, z)$。\n5. 我们检查格点是否在原点 ($r=0$)。如果是，则跳过。\n6. 我们检查格点是否在球形腔内 ($r < R_c$)。如果是，则跳过。\n7. 如果格点被包含在内，我们计算其对场的贡献 $\\Delta E_z = \\mu (3z^2/r^5 - 1/r^3)$，并将其加到 $E_{z}^{\\text{disc}}$ 上。\n8. 对所有包含的格点求和后，我们计算参考场 $E_z^{\\text{cont}} = 4\\pi/3$。\n9. 最后，我们计算修正 $\\delta = E_{z}^{\\text{disc}}/E_z^{\\text{cont}} - 1$ 并报告结果。\n\n这个过程构成了对所述问题的直接数值评估。", "answer": "```python\nimport numpy as np\n\ndef calculate_delta(lattice_type: str, a: float, Rc: float, N: int) -> float:\n    \"\"\"\n    Computes the finite-cavity correction to the Lorentz local field.\n\n    Args:\n        lattice_type: The type of cubic lattice ('SC', 'BCC', 'FCC').\n        a: The lattice constant.\n        Rc: The radius of the spherical exclusion cavity.\n        N: The half-size of the cubic supercell in units of conventional cells.\n\n    Returns:\n        The dimensionless finite-cavity correction delta.\n    \"\"\"\n    # Define lattice basis vectors in fractional coordinates and number of sites per conventional cell.\n    bases = {\n        'SC': np.array([[0.0, 0.0, 0.0]]),\n        'BCC': np.array([[0.0, 0.0, 0.0], [0.5, 0.5, 0.5]]),\n        'FCC': np.array([[0.0, 0.0, 0.0], [0.0, 0.5, 0.5], [0.5, 0.0, 0.5], [0.5, 0.5, 0.0]]),\n    }\n    nsites = {\n        'SC': 1,\n        'BCC': 2,\n        'FCC': 4,\n    }\n\n    n_site = nsites[lattice_type]\n    basis_vectors = bases[lattice_type]\n    \n    # In dimensionless units, P=1, so mu = V_site = a^3 / n_site.\n    mu = a**3 / n_site\n    \n    E_z_disc = 0.0\n    \n    # Loop over conventional cells indexed by (i, j, k) from -N to N.\n    cell_indices = np.arange(-N, N + 1)\n    for i in cell_indices:\n        for j in cell_indices:\n            for k in cell_indices:\n                # Loop over basis sites within the cell.\n                for basis_vec in basis_vectors:\n                    pos_vec = a * (np.array([i, j, k]) + basis_vec)\n                    \n                    r_sq = np.sum(pos_vec**2)\n                    \n                    # Exclude the site at the origin where the field is calculated.\n                    # A small tolerance is used for floating-point comparison to zero.\n                    if r_sq < 1e-12:\n                        continue\n                    \n                    r = np.sqrt(r_sq)\n                    \n                    # Include only dipoles outside the cavity radius Rc.\n                    if r >= Rc:\n                        z = pos_vec[2]\n                        # The z-component of the field from a single dipole, with 1/(4*pi*eps_0) = 1.\n                        # E_z = mu * (3*z^2/r^5 - 1/r^3)\n                        r_cubed = r**3\n                        r_fifth = r_cubed * r**2 # Computationally cheaper than r**5\n                        E_z_single = mu * (3 * z**2 / r_fifth - 1 / r_cubed)\n                        E_z_disc += E_z_single\n\n    # The continuum field at the center of a spherical cavity, with P=1 and 1/(4*pi*eps_0)=1.\n    E_z_cont = 4 * np.pi / 3.0\n    \n    # Calculate the dimensionless finite-cavity correction.\n    delta = E_z_disc / E_z_cont - 1.0\n    \n    return delta\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite and prints the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'lattice': 'SC', 'a': 1.0, 'R_c': 1.2, 'N': 10},\n        {'lattice': 'SC', 'a': 1.0, 'R_c': 0.51, 'N': 10},\n        {'lattice': 'SC', 'a': 1.0, 'R_c': 1.2, 'N': 3},\n        {'lattice': 'BCC', 'a': 1.0, 'R_c': 1.2, 'N': 10},\n        {'lattice': 'FCC', 'a': 1.0, 'R_c': 1.2, 'N': 10},\n    ]\n\n    results = []\n    for case in test_cases:\n        delta = calculate_delta(case['lattice'], case['a'], case['R_c'], case['N'])\n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2836909"}]}