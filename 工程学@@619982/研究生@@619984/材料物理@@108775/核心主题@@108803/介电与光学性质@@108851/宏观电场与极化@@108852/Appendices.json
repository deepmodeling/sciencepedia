{"hands_on_practices": [{"introduction": "求解置于外部电场中的电介质物体内部及周围的电场是一项基本技能。本练习 [@problem_id:2838411] 探讨了均匀电场 $\\mathbf{E}_0$ 中电介质球这一经典问题。通过应用拉普拉斯方程 $\\nabla^2 \\Phi = 0$ 和电介质界面上适当的边界条件，你将推导出感应偶极矩 $\\mathbf{p}$，这是解释材料如何极化并与电场相互作用的关键结果。", "problem": "一个半径为 $R$、介电常数为 $\\varepsilon$ 的固态、均匀、各向同性、线性介电球体置于介电常数为 $\\varepsilon_{0}$ 的真空中。该系统是静态的，空间中除远处产生均匀宏观电场 $\\mathbf{E}_{0}$ 的源之外，没有任何自由电荷。在没有球体的情况下，该均匀电场存在。均匀场沿 $\\hat{\\mathbf{z}}$ 轴方向，因此 $\\mathbf{E}_{0} = E_{0}\\,\\hat{\\mathbf{z}}$，其中 $E_{0}$ 是一个正标量。\n\n从宏观麦克斯韦方程组、球体内部的本构关系 $\\mathbf{D} = \\varepsilon \\mathbf{E}$ 和球体外部的本构关系 $\\mathbf{D} = \\varepsilon_{0} \\mathbf{E}$，以及宏观极化强度 $\\mathbf{P} = \\mathbf{D} - \\varepsilon_{0}\\mathbf{E}$ 的定义出发，推导球体内部（$r<R$）和外部（$r>R$）的宏观标量势和宏观电场。只使用从宏观麦克斯韦方程组在介电质-真空界面处得出的边界条件，并要求电势在 $r=0$ 处是有限的，并且当 $r\\to\\infty$ 时，除背景场之外，电势适当地趋于零。然后计算该球体的感应宏观偶极矩矢量。\n\n仅以一个包含 $\\varepsilon$、$\\varepsilon_{0}$、$R$ 和 $\\mathbf{E}_{0}$ 的封闭形式解析表达式报告感应偶极矩矢量。不需要进行数值计算。将答案表示为矢量，并且在最终报告的表达式中不要包含单位。", "solution": "所述问题是有效的。这是一个标准的、适定的静电学问题，具有科学依据且内容自洽。将按要求从第一性原理推导求解。\n\n在没有自由电荷密度的静态情况下，宏观麦克斯韦方程组为 $\\nabla \\cdot \\mathbf{D} = 0$ 和 $\\nabla \\times \\mathbf{E} = \\mathbf{0}$。第二个方程意味着存在一个标量势 $\\Phi$，使得电场由其负梯度给出，即 $\\mathbf{E} = -\\nabla \\Phi$。将此式与线性本构关系 $\\mathbf{D} = \\epsilon \\mathbf{E}$（其中 $\\epsilon$ 是介质的介电常数）一同代入第一个方程，我们得到 $\\nabla \\cdot (\\epsilon \\mathbf{E}) = \\nabla \\cdot (-\\epsilon \\nabla \\Phi) = 0$。对于均匀介质，其中 $\\epsilon$ 是常数，此式简化为拉普拉斯方程，$\\nabla^2 \\Phi = 0$。\n\n我们必须在两个区域求解拉普拉斯方程以得到电势：球体内部（$r < R$）和球体外部（$r > R$）。设内外电势分别为 $\\Phi_{in}$ 和 $\\Phi_{out}$。\n\n由于均匀外场 $\\mathbf{E}_0 = E_0 \\hat{\\mathbf{z}}$ 的存在，该问题具有方位角对称性。在球坐标系 $(r, \\theta, \\phi)$ 中，具有方位角对称性的拉普拉斯方程的通解是勒让德多项式 $P_l(\\cos\\theta)$ 的叠加：\n$$ \\Phi(r, \\theta) = \\sum_{l=0}^{\\infty} \\left( A_l r^l + B_l r^{-(l+1)} \\right) P_l(\\cos\\theta) $$\n\n对于球体内部区域（$r < R$），电势 $\\Phi_{in}$ 在原点（$r=0$）处必须保持有限。这要求所有在原点处奇异的项的系数 $B_l$ 必须为零。因此，内部电势的形式为：\n$$ \\Phi_{in}(r, \\theta) = \\sum_{l=0}^{\\infty} A_l r^l P_l(\\cos\\theta) $$\n\n对于球体外部区域（$r > R$），当 $r \\to \\infty$ 时，电势 $\\Phi_{out}$ 必须趋近于均匀外场的电势。与 $\\mathbf{E}_0 = E_0 \\hat{\\mathbf{z}}$ 对应的电势是 $\\Phi_0 = -E_0 z = -E_0 r \\cos\\theta = -E_0 r P_1(\\cos\\theta)$。因此，当 $r \\to \\infty$ 时，$\\Phi_{out}$ 的行为必须像 $-E_0 r P_1(\\cos\\theta)$。这个条件要求所有 $l \\neq 1$ 的系数 $A_l$ 必须为零，且 $A_1 = -E_0$。因此，外部电势的通解形式为：\n$$ \\Phi_{out}(r, \\theta) = -E_0 r P_1(\\cos\\theta) + \\sum_{l=0}^{\\infty} B_l r^{-(l+1)} P_l(\\cos\\theta) $$\n\n系数 $A_l$ 和 $B_l$ 由介电质界面 $r=R$ 处的边界条件确定。\n1.  电势的连续性：$\\Phi_{in}(R, \\theta) = \\Phi_{out}(R, \\theta)$。\n2.  电位移场 $\\mathbf{D}$ 法向分量的连续性：$D_{in, \\perp} = D_{out, \\perp}$。由于 $\\mathbf{D} = -\\epsilon \\nabla \\Phi$，且法向为 $\\hat{\\mathbf{r}}$，该条件变为 $\\varepsilon \\frac{\\partial \\Phi_{in}}{\\partial r}\\bigg|_{r=R} = \\varepsilon_0 \\frac{\\partial \\Phi_{out}}{\\partial r}\\bigg|_{r=R}$。\n\n在 $r=R$ 处应用第一个边界条件：\n$$ \\sum_{l=0}^{\\infty} A_l R^l P_l(\\cos\\theta) = -E_0 R P_1(\\cos\\theta) + \\sum_{l=0}^{\\infty} B_l R^{-(l+1)} P_l(\\cos\\theta) $$\n由于勒让德多项式的正交性，我们可以对每个 $l$ 值分别令其系数相等：\n对于 $l=1$：$A_1 R = -E_0 R + B_1 R^{-2}$。\n对于 $l \\neq 1$：$A_l R^l = B_l R^{-(l+1)}$。\n\n在 $r=R$ 处应用第二个边界条件：\n$$ \\varepsilon \\sum_{l=0}^{\\infty} A_l l R^{l-1} P_l(\\cos\\theta) = \\varepsilon_0 \\left( -E_0 P_1(\\cos\\theta) - \\sum_{l=0}^{\\infty} B_l (l+1) R^{-(l+2)} P_l(\\cos\\theta) \\right) $$\n对每个 $l$ 分别令其系数相等：\n对于 $l=1$：$\\varepsilon (A_1) = \\varepsilon_0 (-E_0 - 2 B_1 R^{-3})$。\n对于 $l \\neq 1$：$\\varepsilon A_l l R^{l-1} = -\\varepsilon_0 B_l (l+1) R^{-(l+2)}$。\n\n让我们求解 $l \\neq 1$ 的方程组。由第一个边界条件得 $B_l = A_l R^{2l+1}$。将此代入第二个条件：\n$$ \\varepsilon A_l l R^{l-1} = -\\varepsilon_0 (A_l R^{2l+1}) (l+1) R^{-(l+2)} $$\n$$ \\varepsilon A_l l R^{l-1} = -\\varepsilon_0 A_l (l+1) R^{l-1} $$\n$$ A_l (\\varepsilon l + \\varepsilon_0 (l+1)) = 0 $$\n因为 $\\varepsilon > 0$，$\\varepsilon_0 > 0$，且对于 $l \\ge 0$, 项 $(\\varepsilon l + \\varepsilon_0 (l+1))$ 恒为正。因此，对于所有 $l \\neq 1$ 必有 $A_l=0$。这也意味着对于所有 $l \\neq 1$ 都有 $B_l=0$。唯一的非零系数是 $A_1$ 和 $B_1$。\n\n现在我们求解 $l=1$ 的方程组：\n(i) $A_1 R = -E_0 R + B_1 R^{-2} \\implies A_1 = -E_0 + B_1 R^{-3}$\n(ii) $\\varepsilon A_1 = -\\varepsilon_0 E_0 - 2\\varepsilon_0 B_1 R^{-3}$\n将 (i) 中的 $A_1$ 代入 (ii)：\n$$ \\varepsilon(-E_0 + B_1 R^{-3}) = -\\varepsilon_0 E_0 - 2\\varepsilon_0 B_1 R^{-3} $$\n$$ -\\varepsilon E_0 + \\varepsilon B_1 R^{-3} = -\\varepsilon_0 E_0 - 2\\varepsilon_0 B_1 R^{-3} $$\n$$ B_1 R^{-3}(\\varepsilon + 2\\varepsilon_0) = E_0(\\varepsilon - \\varepsilon_0) $$\n$$ B_1 = R^3 E_0 \\frac{\\varepsilon - \\varepsilon_0}{\\varepsilon + 2\\varepsilon_0} $$\n利用 $B_1$ 我们可以求出 $A_1$：\n$$ A_1 = -E_0 + \\left( R^3 E_0 \\frac{\\varepsilon - \\varepsilon_0}{\\varepsilon + 2\\varepsilon_0} \\right) R^{-3} = E_0 \\left( -1 + \\frac{\\varepsilon - \\varepsilon_0}{\\varepsilon + 2\\varepsilon_0} \\right) = E_0 \\frac{-(\\varepsilon + 2\\varepsilon_0) + (\\varepsilon - \\varepsilon_0)}{\\varepsilon + 2\\varepsilon_0} = -\\frac{3\\varepsilon_0 E_0}{\\varepsilon + 2\\varepsilon_0} $$\n因此电势被完全确定。球体外部的电势为：\n$$ \\Phi_{out}(r, \\theta) = -E_0 r \\cos\\theta + \\left( R^3 E_0 \\frac{\\varepsilon - \\varepsilon_0}{\\varepsilon + 2\\varepsilon_0} \\right) \\frac{\\cos\\theta}{r^2} $$\n外部电势是均匀外场电势与极化球体产生的电势的叠加。第二项是位于原点的理想电偶极子的电势。一个偶极子 $\\mathbf{p}$ 的电势由 $\\Phi_{dipole}(r, \\theta) = \\frac{\\mathbf{p} \\cdot \\hat{\\mathbf{r}}}{4 \\pi \\varepsilon_0 r^2}$ 给出。对于一个偶极子 $\\mathbf{p} = p \\hat{\\mathbf{z}}$，这变为 $\\Phi_{dipole} = \\frac{p \\cos\\theta}{4 \\pi \\varepsilon_0 r^2}$。\n\n将此形式与 $\\Phi_{out}$ 中的第二项进行比较：\n$$ \\frac{p \\cos\\theta}{4 \\pi \\varepsilon_0 r^2} = \\left( R^3 E_0 \\frac{\\varepsilon - \\varepsilon_0}{\\varepsilon + 2\\varepsilon_0} \\right) \\frac{\\cos\\theta}{r^2} $$\n由此，我们确定感应偶极矩的大小 $p$：\n$$ p = 4 \\pi \\varepsilon_0 R^3 E_0 \\frac{\\varepsilon - \\varepsilon_0}{\\varepsilon + 2\\varepsilon_0} $$\n偶极子的方向沿 $\\hat{\\mathbf{z}}$ 轴，与外场 $\\mathbf{E}_0$ 平行。因此，感应偶极矩矢量 $\\mathbf{p}$ 可以写为：\n$$ \\mathbf{p} = \\left( 4 \\pi \\varepsilon_0 R^3 \\frac{\\varepsilon - \\varepsilon_0}{\\varepsilon + 2\\varepsilon_0} \\right) E_0\\hat{\\mathbf{z}} $$\n认识到 $\\mathbf{E}_0 = E_0\\hat{\\mathbf{z}}$，我们用给定的矢量 $\\mathbf{E}_0$ 来表示最终答案。\n$$ \\mathbf{p} = 4 \\pi \\varepsilon_0 R^3 \\left( \\frac{\\varepsilon - \\varepsilon_0}{\\varepsilon + 2\\varepsilon_0} \\right) \\mathbf{E}_0 $$\n这就是所要求的球体感应宏观偶极矩矢量的表达式。", "answer": "$$\n\\boxed{4 \\pi \\varepsilon_{0} R^{3} \\left(\\frac{\\varepsilon - \\varepsilon_{0}}{\\varepsilon + 2\\varepsilon_{0}}\\right) \\mathbf{E}_{0}}\n$$", "id": "2838411"}, {"introduction": "虽然静电问题是基础，但真实材料展现的是动态行为。本实践 [@problem_id:147440] 从静电学转向研究“有损”或导电电介质内部的电荷动力学。你将研究初始电荷分布如何随时间耗散，并推导出特征弛豫时间 $\\tau$。这个弛豫时间由材料的介电张量 $\\boldsymbol{\\epsilon}$ 和电导张量 $\\boldsymbol{\\sigma}$ 共同决定，有助于我们深入理解材料的瞬态响应。", "problem": "考虑一个均匀、各向异性、线性的“有损耗”介电材料。该材料对电场 $\\mathbf{E}$ 的响应由电位移 $\\mathbf{D}$ 和自由电流密度 $\\mathbf{J}$ 的本构关系描述：\n$$ \\mathbf{D} = \\boldsymbol{\\epsilon} \\mathbf{E} $$\n$$ \\mathbf{J} = \\boldsymbol{\\sigma} \\mathbf{E} $$\n在笛卡尔坐标系 $(x,y,z)$ 中，介电常数张量 $\\boldsymbol{\\epsilon}$ 和电导率张量 $\\boldsymbol{\\sigma}$ 是对角的，其主分量分别为常数 $(\\epsilon_x, \\epsilon_y, \\epsilon_z)$ 和 $(\\sigma_x, \\sigma_y, \\sigma_z)$。\n\n自由电荷密度 $\\rho_f$ 的动力学由高斯定律 $\\nabla \\cdot \\mathbf{D} = \\rho_f$ 和电荷连续性方程 $\\nabla \\cdot \\mathbf{J} + \\frac{\\partial \\rho_f}{\\partial t} = 0$ 决定。可以忽略任何磁效应，这意味着电场是无旋的，可以表示为一个标量势的梯度，即 $\\mathbf{E} = -\\nabla V$。\n\n在时间 $t=0$ 时，材料内部建立了一个小的自由电荷密度微扰。该微扰具有 $\\rho_f(\\mathbf{r}, 0) \\propto \\cos(\\mathbf{k} \\cdot \\mathbf{r})$ 形式的正弦空间依赖性，其中 $\\mathbf{k}$ 是波矢量。由于材料的导电性，这种电荷分布会随时间耗散。可以证明，这样的电荷密度模式会按 $\\rho_f(\\mathbf{r}, t) = \\rho_f(\\mathbf{r}, 0) e^{-t/\\tau}$ 指数衰减。\n\n计算一个电荷密度微扰的时间常数 $\\tau$，其波矢量 $\\mathbf{k}$ 的方向与向量 $\\mathbf{u} = (a, b, c)$ 的方向相同，其中 $a, b, c$ 是给定的常数。", "solution": "1. 高斯定律和连续性方程给出\n$$\\nabla\\cdot\\mathbf{D}=\\rho_f,\\qquad \\nabla\\cdot\\mathbf{J}+\\frac{\\partial\\rho_f}{\\partial t}=0.$$\n根据 $\\mathbf{D}=\\boldsymbol\\epsilon\\mathbf{E}$，$\\mathbf{J}=\\boldsymbol\\sigma\\mathbf{E}$ 和 $\\mathbf{E}=-\\nabla V$，假设一个模式\n$$\\rho_f(\\mathbf r,t)=\\rho_k e^{i\\mathbf k\\cdot\\mathbf r}e^{-t/\\tau},\\quad V(\\mathbf r,t)=V_k e^{i\\mathbf k\\cdot\\mathbf r}e^{-t/\\tau}.$$\n2. 根据高斯定律，\n$$\\nabla\\cdot\\mathbf{D}=i\\mathbf k\\cdot(\\boldsymbol\\epsilon(-i\\mathbf k)V_k e^{i\\mathbf k\\cdot\\mathbf r}e^{-t/\\tau})\n=(\\mathbf k\\cdot\\boldsymbol\\epsilon\\mathbf k)\\,V_ke^{i\\mathbf k\\cdot\\mathbf r}e^{-t/\\tau}\n=\\rho_k e^{i\\mathbf k\\cdot\\mathbf r}e^{-t/\\tau}.$$\n因此\n$$V_k=\\frac{\\rho_k}{\\mathbf k\\cdot\\boldsymbol\\epsilon\\,\\mathbf k}.$$\n3. 根据连续性方程，\n$$\\nabla\\cdot\\mathbf{J}+\\frac{\\partial\\rho_f}{\\partial t}\n=i\\mathbf k\\cdot(\\boldsymbol\\sigma(-i\\mathbf k)V_k)e^{i\\mathbf k\\cdot\\mathbf r}e^{-t/\\tau}\n+\\bigl(-\\tfrac1\\tau\\rho_k\\bigr)e^{i\\mathbf k\\cdot\\mathbf r}e^{-t/\\tau}=0.$$\n因此\n$$(\\mathbf k\\cdot\\boldsymbol\\sigma\\,\\mathbf k)\\,V_k=\\frac{1}{\\tau}\\rho_k\n\\;\\Longrightarrow\\;\n\\frac{1}{\\tau}=\\frac{\\mathbf k\\cdot\\boldsymbol\\sigma\\,\\mathbf k}{\\mathbf k\\cdot\\boldsymbol\\epsilon\\,\\mathbf k}.$$\n4. 对于 $\\mathbf k\\parallel\\mathbf u=(a,b,c)$，$\\mathbf k$ 的大小会消去，得到\n$$\\tau=\\frac{\\mathbf u\\cdot\\boldsymbol\\epsilon\\,\\mathbf u}{\\mathbf u\\cdot\\boldsymbol\\sigma\\,\\mathbf u}\n=\\frac{a^2\\epsilon_x+b^2\\epsilon_y+c^2\\epsilon_z}{a^2\\sigma_x+b^2\\sigma_y+c^2\\sigma_z}.$$", "answer": "$$\\boxed{\\frac{a^2\\epsilon_x+b^2\\epsilon_y+c^2\\epsilon_z}{a^2\\sigma_x+b^2\\sigma_y+c^2\\sigma_z}}$$", "id": "147440"}, {"introduction": "对材料性质最深刻的理解，源于将其在时域中的响应与其在频域中的行为联系起来。这个高级计算练习 [@problem_id:2838447] 模拟了光谱表征的过程。你将把时域的极化响应数据 $P(t)$ 转换成频率依赖的复相对介电常数 $\\varepsilon_r(\\omega)$，然后利用作为因果律深刻推论的克拉默斯-克勒尼希关系 (Kramers-Kronig relations)，来检验结果的物理自洽性。", "problem": "您必须编写一个完整且可运行的程序。该程序需使用一个线性、因果电介质中对阶跃电场的宏观极化响应的综合（但科学上合理的）时域数据，反演出复的、频率相关的相对介电常数，并评估其结果是否与 Kramers–Kronig 关系一致。推导必须从基本定义开始：在时域中，宏观位移场满足 $\\,\\mathbf{D}(t)=\\varepsilon_{0}\\mathbf{E}(t)+\\mathbf{P}(t)\\,$；对于线性、时不变、因果的介质，极化由因果卷积给出 $\\,P(t)=\\varepsilon_{0}\\int_{-\\infty}^{\\infty}\\chi_{\\mathrm{e}}(t-t')E(t')\\,\\mathrm{d}t'\\,$，其中对于 $\\,t<0\\,$ 有 $\\,\\chi_{\\mathrm{e}}(t)=0\\,$。采用双边傅里叶变换约定 $\\,F(\\omega)=\\int_{-\\infty}^{\\infty}f(t)\\,e^{i\\omega t}\\,\\mathrm{d}t\\,$，从而时域中的卷积对应于频域中的乘积，并使用相对介电常数 $\\,\\varepsilon_{\\mathrm{r}}(\\omega)=\\varepsilon_{\\infty}+\\chi_{\\mathrm{e}}(\\omega)\\,$，其中 $\\,\\varepsilon_{\\infty}\\,$ 是高频极限（无量纲），$\\,\\chi_{\\mathrm{e}}(\\omega)\\,$ 是频域中的电极化率。程序必须从阶跃电场 $\\,E(t)=E_{0}u(t)\\,$ 下生成的给定 $\\,P(t)\\,$ 记录中恢复出 $\\,\\varepsilon_{\\mathrm{r}}(\\omega)\\,$，然后测试恢复的 $\\,\\varepsilon_{\\mathrm{r}}(\\omega)\\,$ 是否与适用于因果、线性电介质的 Kramers–Kronig 关系一致。\n\n您的程序必须遵守以下所有要求。\n\n- 物理和数值设置：\n  - 在国际单位制（SI）下工作。使用 $\\,\\varepsilon_{0}=8.854\\,187\\,817\\times 10^{-12}\\,\\mathrm{F/m}\\,$。时间单位为 $\\,\\mathrm{s}\\,$，角频率单位为 $\\,\\mathrm{rad/s}\\,$，电场单位为 $\\,\\mathrm{V/m}\\,$，极化单位为 $\\,\\mathrm{C/m^{2}}\\,$。\n  - $\\,P(t)\\,$ 的输入数据应在您的程序内部按如下方式合成。对于阶跃电场 $\\,E(t)=E_{0}u(t)\\,$, 为 $\\,t\\ge 0\\,$ 定义模型极化\n    $$\\frac{P(t)}{\\varepsilon_{0}E_{0}}=\\sum_{k=1}^{K}\\Delta\\varepsilon_{k}\\left(1-e^{-t/\\tau_{k}}\\right),$$\n    其中 $\\,\\Delta\\varepsilon_{k}>0\\,$ 和 $\\,\\tau_{k}>0\\,$ 是给定的材料参数，$\\,k=1,\\dots,K\\,$。对于 $\\,t<0\\,$, 设置 $\\,P(t)=0\\,$。可选择性地，如下方测试套件中所述，向 $\\,P(t)\\,$ 添加零均值高斯噪声。\n  - 从合成的 $\\,P(t)\\,$ 和已知的 $\\,E_{0}\\,$，数值恢复 $\\,t\\ge 0\\,$ 的时域电极化率 $\\,\\chi_{\\mathrm{e}}(t)\\,$，然后在一个选定的角频率网格 $\\,\\{\\omega_{m}\\}_{m=1}^{M}\\,$ 上计算其频域对应物 $\\,\\chi_{\\mathrm{e}}(\\omega)\\,$。该网格至少从 $\\,\\omega_{\\min}=2\\pi/T\\,$ 跨越到 $\\,\\omega_{\\max}=\\pi/\\Delta t\\,$，其中 $\\,T\\,$ 是总记录长度，$\\,\\Delta t\\,$ 是采样间隔。对傅里叶积分使用与所述约定一致的数值稳健的求积方法。\n  - 构建 $\\,\\varepsilon_{\\mathrm{r}}(\\omega)=\\varepsilon_{\\infty}+\\chi_{\\mathrm{e}}(\\omega)\\,$。\n\n- Kramers–Kronig 一致性测试：\n  - 实现适用于具有有限 $\\,\\varepsilon_{\\infty}\\,$ 的弛豫电介质的减除型 Kramers–Kronig 关系，在离散频率网格上从 $\\,\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}(\\omega)\\,$ 重构 $\\,\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}(\\omega)-\\varepsilon_{\\infty}\\,$，反之亦然。使用排除奇异自项的主值求积法。求积使用线性频率间距，数值积分使用梯形法则。\n  - 在一个内部频带上定义相对误差，该频带排除少量最低和最高频率样本以减轻有限频带效应。相对误差必须计算为原始分量与 Kramers–Kronig 重构分量之间 $\\,\\ell^{2}\\,$ 范数的比率，必要时可加入小的正则化项以避免除以零。\n  - 对于每个测试用例，报告一个布尔值，当且仅当两个相对误差都小于或等于一个固定的容差 $\\,\\delta\\,$ 时，该值为真。\n\n- 测试套件：\n  - 使用以下四个测试用例，每个用例都提供了 $\\,P(t)\\,$ 的自包含合成：\n    1. 用例1（单弛豫，良好分辨，无噪声）：$\\,E_{0}=1.0\\times 10^{5}\\,\\mathrm{V/m}\\,$，$\\,\\varepsilon_{\\infty}=2.0\\,$，一个项，其中 $\\,\\Delta\\varepsilon_{1}=3.0\\,$ 和 $\\,\\tau_{1}=5.0\\times 10^{-7}\\,\\mathrm{s}\\,$，采样间隔 $\\,\\Delta t=1.0\\times 10^{-8}\\,\\mathrm{s}\\,$，样本数 $\\,N=4096\\,$，无添加噪声。\n    2. 用例2（双弛豫，良好分辨，无噪声）：$\\,E_{0}=1.0\\times 10^{5}\\,\\mathrm{V/m}\\,$，$\\,\\varepsilon_{\\infty}=1.4\\,$，两个项，其中 $\\,(\\Delta\\varepsilon_{1},\\tau_{1})=(2.0,2.0\\times 10^{-7}\\,\\mathrm{s})\\,$ 和 $\\,(\\Delta\\varepsilon_{2},\\tau_{2})=(1.0,4.0\\times 10^{-6}\\,\\mathrm{s})\\,$，采样间隔 $\\,\\Delta t=1.0\\times 10^{-8}\\,\\mathrm{s}\\,$，样本数 $\\,N=4096\\,$，无添加噪声。\n    3. 用例3（单弛豫，记录粗糙且短，有噪声）：$\\,E_{0}=1.0\\times 10^{5}\\,\\mathrm{V/m}\\,$，$\\,\\varepsilon_{\\infty}=2.0\\,$，一个项，其中 $\\,\\Delta\\varepsilon_{1}=3.0\\,$ 和 $\\,\\tau_{1}=3.0\\times 10^{-6}\\,\\mathrm{s}\\,$，采样间隔 $\\,\\Delta t=5.0\\times 10^{-8}\\,\\mathrm{s}\\,$，样本数 $\\,N=256\\,$，添加独立同分布的高斯噪声，其标准差等于 $\\,\\eta\\,\\max_{t\\in[0,T]}|P(t)|\\,$，其中 $\\,\\eta=1.0\\times 10^{-1}\\,$。\n    4. 用例4（单弛豫，相对于弛豫的记录非常短）：$\\,E_{0}=1.0\\times 10^{5}\\,\\mathrm{V/m}\\,$，$\\,\\varepsilon_{\\infty}=2.0\\,$，一个项，其中 $\\,\\Delta\\varepsilon_{1}=3.0\\,$ 和 $\\,\\tau_{1}=1.0\\times 10^{-4}\\,\\mathrm{s}\\,$，采样间隔 $\\,\\Delta t=1.0\\times 10^{-8}\\,\\mathrm{s}\\,$，样本数 $\\,N=256\\,$，无添加噪声。\n  - 对于所有用例，根据上述记录参数构建频率网格，并将 Kramers–Kronig 一致性容差设置为 $\\,\\delta=2.5\\times 10^{-1}\\,$。\n\n- 输出格式：\n  - 您的程序必须输出一行，其中包含与上述用例相对应的四个布尔结果，按顺序排列，格式为方括号内以逗号分隔的列表，例如 $\\,\\left[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True}\\right]\\,$。不得打印任何其他文本。\n\n所有内部物理量均以 SI 单位表示，并确保所有数值角度均以弧度为单位。最终输出为布尔值，因此无量纲。您实现的推导和算法步骤必须由所述的基本定律和定义来证明，而不是无根据的捷径。", "solution": "我们从时域中的宏观本构关系 $\\,\\mathbf{D}(t)=\\varepsilon_{0}\\mathbf{E}(t)+\\mathbf{P}(t)\\,$ 和线性时不变响应 $\\,P(t)=\\varepsilon_{0}\\int_{-\\infty}^{\\infty}\\chi_{\\mathrm{e}}(t-t')E(t')\\,\\mathrm{d}t'\\,$ 开始，其中因果性要求 $\\,t<0\\,$ 时 $\\,\\chi_{\\mathrm{e}}(t)=0\\,$。对于阶跃电场 $\\,E(t)=E_{0}u(t)\\,$，当 $\\,t\\ge 0\\,$ 时我们有\n$$\nP(t)=\\varepsilon_{0}E_{0}\\int_{0}^{t}\\chi_{\\mathrm{e}}(\\tau)\\,\\mathrm{d}\\tau,\n$$\n这是通过代入 $\\,E(t')=E_{0}u(t')\\,$ 和更换变量得到的。对 $\\,t\\,$ 求导得出\n$$\n\\frac{\\mathrm{d}P}{\\mathrm{d}t}(t)=\\varepsilon_{0}E_{0}\\,\\chi_{\\mathrm{e}}(t),\\quad t>0.\n$$\n这个恒等式是线性和因果性的直接结果，当输入是阶跃时，它提供了时域中的一个可操作的反演：给定 $\\,P(t)\\,$ 和 $\\,E_{0}\\,$，可以得到\n$$\n\\chi_{\\mathrm{e}}(t)=\\frac{1}{\\varepsilon_{0}E_{0}}\\frac{\\mathrm{d}P}{\\mathrm{d}t}(t),\\quad t\\ge 0.\n$$\n\n为了进入频域，我们采用傅里叶变换约定\n$$\n\\mathcal{F}\\{f\\}(\\omega)=\\int_{-\\infty}^{\\infty}f(t)\\,e^{i\\omega t}\\,\\mathrm{d}t,\n$$\n使得对于时间卷积 $\\,f*g\\,$，有 $\\,\\mathcal{F}\\{f*g\\}(\\omega)=\\mathcal{F}\\{f\\}(\\omega)\\,\\mathcal{F}\\{g\\}(\\omega)\\,$。对于在 $\\,t\\ge 0\\,$ 上有支撑的因果 $\\,\\chi_{\\mathrm{e}}(t)\\,$，其傅里叶变换为\n$$\n\\chi_{\\mathrm{e}}(\\omega)=\\int_{0}^{\\infty}\\chi_{\\mathrm{e}}(t)\\,e^{i\\omega t}\\,\\mathrm{d}t.\n$$\n在频域中，相对介电常数为\n$$\n\\varepsilon_{\\mathrm{r}}(\\omega)=\\varepsilon_{\\infty}+\\chi_{\\mathrm{e}}(\\omega),\n$$\n其中 $\\,\\varepsilon_{\\infty}=\\lim_{\\omega\\to\\infty}\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}(\\omega)\\,$ 是高频极限。对于一个时间常数为 $\\,\\tau\\,$ 且强度为 $\\,\\Delta\\varepsilon\\,$ 的 Debye 弛豫，有 $\\,\\chi_{\\mathrm{e}}(t)=(\\Delta\\varepsilon/\\tau)e^{-t/\\tau}\\,u(t)\\,$，这与用于合成测试数据的阶跃响应模型 $\\,P(t)/(\\varepsilon_{0}E_{0})=\\Delta\\varepsilon(1-e^{-t/\\tau})\\,$ 一致。对于多重弛豫，适用线性叠加原理。\n\nKramers–Kronig 关系源于因果性和响应函数在复频率上半平面的解析性。对于具有有限 $\\,\\varepsilon_{\\infty}\\,$ 的电介质，连接 $\\,\\varepsilon_{\\mathrm{r}}(\\omega)\\,$ 实部与虚部的减除型关系为\n$$\n\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}(\\omega)-\\varepsilon_{\\infty}=\\frac{2}{\\pi}\\,\\mathcal{P}\\int_{0}^{\\infty}\\frac{\\Omega\\,\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}(\\Omega)}{\\Omega^{2}-\\omega^{2}}\\,\\mathrm{d}\\Omega,\n$$\n$$\n\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}(\\omega)=-\\frac{2\\omega}{\\pi}\\,\\mathcal{P}\\int_{0}^{\\infty}\\frac{\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}(\\Omega)-\\varepsilon_{\\infty}}{\\Omega^{2}-\\omega^{2}}\\,\\mathrm{d}\\Omega,\n$$\n其中 $\\,\\mathcal{P}\\,$ 表示 Cauchy 主值。这些公式为测试测量或计算出的 $\\,\\varepsilon_{\\mathrm{r}}(\\omega)\\,$ 是否与因果性一致提供了基础。\n\n程序中实现的算法步骤如下。\n\n1. 使用测试套件参数，为 $\\,t_{n}=n\\,\\Delta t\\,$（其中 $\\,n=0,1,\\dots,N-1\\,$）合成 $\\,P(t)\\,$。对于 $\\,t<0\\,$，设置 $\\,P(t)=0\\,$。如果指定，则添加标准差为 $\\,\\eta\\,\\max_{n}|P(t_{n})|\\,$ 的零均值高斯噪声。所有量均采用 SI 单位。\n\n2. 计算数值时间导数 $\\,\\mathrm{d}P/\\mathrm{d}t\\,$，例如通过适用于均匀采样的梯度算子使用中心有限差分。得到\n$$\n\\chi_{\\mathrm{e}}(t_{n})=\\frac{1}{\\varepsilon_{0}E_{0}}\\left.\\frac{\\mathrm{d}P}{\\mathrm{d}t}\\right|_{t=t_{n}},\\quad n=0,1,\\dots,N-1.\n$$\n可选地，在存在噪声的情况下，可以对导数进行轻度正则化或平滑处理，但这并非物理上的严格要求。\n\n3. 选择一个在 $\\,\\left[\\omega_{\\min},\\omega_{\\max}\\right]\\,$ 上线性间隔的频率网格 $\\,\\omega_{m}\\,$，其中 $\\,\\omega_{\\min}=2\\pi/T\\,$（$\\,T=N\\,\\Delta t\\,$）且 $\\,\\omega_{\\max}=\\pi/\\Delta t\\,$。对于 $\\,\\omega=\\omega_{m}\\,$，通过黎曼和近似傅里叶变换\n$$\n\\chi_{\\mathrm{e}}(\\omega_{m})\\approx\\sum_{n=0}^{N-1}\\chi_{\\mathrm{e}}(t_{n})\\,e^{i\\omega_{m}t_{n}}\\,\\Delta t.\n$$\n构建\n$$\n\\varepsilon_{\\mathrm{r}}(\\omega_{m})=\\varepsilon_{\\infty}+\\chi_{\\mathrm{e}}(\\omega_{m}).\n$$\n\n4. 在离散网格上数值实现减除型 Kramers–Kronig 关系。对于线性频率间距 $\\,\\Delta\\omega\\,$ 和梯形权重，对每个内部索引 $\\,m\\,$，通过对 $\\,j\\neq m\\,$ 求和来计算主值积分：\n$$\n\\left[\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}(\\omega_{m})\\right]_{\\mathrm{KK}}=\\varepsilon_{\\infty}+\\frac{2}{\\pi}\\sum_{j\\neq m}w_{j}\\,\\frac{\\omega_{j}\\,\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}(\\omega_{j})}{\\omega_{j}^{2}-\\omega_{m}^{2}},\n$$\n$$\n\\left[\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}(\\omega_{m})\\right]_{\\mathrm{KK}}=-\\frac{2\\omega_{m}}{\\pi}\\sum_{j\\neq m}w_{j}\\,\\frac{\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}(\\omega_{j})-\\varepsilon_{\\infty}}{\\omega_{j}^{2}-\\omega_{m}^{2}},\n$$\n其中 $\\,w_{j}\\,$ 是梯形权重，对于内部点等于 $\\,\\Delta\\omega\\,$，在端点等于 $\\,\\Delta\\omega/2\\,$。省略自项 $\\,j=m\\,$ 以实现主值。\n\n5. 在内部频带 $\\,m=m_{\\mathrm{lo}},\\dots,m_{\\mathrm{hi}}\\,$ 上评估相对误差以避免边界效应，例如舍弃两端的几个样本。定义\n$$\n\\epsilon_{\\mathrm{Re}}=\\frac{\\left\\|\\left(\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}-\\varepsilon_{\\infty}\\right)-\\left(\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}\\right)_{\\mathrm{KK}}+\\varepsilon_{\\infty}\\right\\|_{2}}{\\left\\|\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}-\\varepsilon_{\\infty}\\right\\|_{2}+\\epsilon_{0}},\n\\quad\n\\epsilon_{\\mathrm{Im}}=\\frac{\\left\\|\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}-\\left(\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}\\right)_{\\mathrm{KK}}\\right\\|_{2}}{\\left\\|\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}\\right\\|_{2}+\\epsilon_{0}},\n$$\n其中有一个小的正则化项 $\\,\\epsilon_{0}\\,$（例如 $\\,\\epsilon_{0}=10^{-12}\\,$）以避免在病态情况下除以零。如果 $\\,\\max(\\epsilon_{\\mathrm{Re}},\\epsilon_{\\mathrm{Im}})\\le \\delta\\,$（其中 $\\,\\delta=2.5\\times 10^{-1}\\,$），则声明 Kramers–Kronig 一致。\n\n四个测试用例按问题陈述中的规定构建。具有良好分辨、无噪声数据的用例（用例1和2）应产生远低于容差的较小相对误差，因此符合一致性。具有短记录或粗糙记录以及噪声的用例（用例3和4）会降低反演和有限频带 Kramers–Kronig 求积的质量，通常会产生超过容差的较大相对误差，因此不符合一致性。\n\n程序必须为每个用例合成 $\\,P(t)\\,$，执行上述步骤，最后打印一行 Python 风格的布尔值列表 $\\,\\left[\\mathrm{b}_{1},\\mathrm{b}_{2},\\mathrm{b}_{3},\\mathrm{b}_{4}\\right]\\,$，按顺序指示用例1到4的 Kramers–Kronig 一致性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Constants (SI units)\nEPS0 = 8.854187817e-12  # F/m\n\ndef synthesize_P(t, E0, terms, noise_level=0.0, rng=None):\n    \"\"\"\n    Synthesize P(t) for a step field E(t) = E0 * u(t) with Debye relaxations:\n    P(t)/(eps0*E0) = sum_k Delta_eps_k * (1 - exp(-t/tau_k)), for t >= 0.\n    terms: list of (Delta_eps, tau)\n    noise_level: relative std dev with respect to max|P(t)| (absolute).\n    \"\"\"\n    P = np.zeros_like(t)\n    # t>=0 assumed for supplied t\n    for d_eps, tau in terms:\n        P += EPS0 * E0 * d_eps * (1.0 - np.exp(-t / tau))\n    if noise_level > 0.0:\n        if rng is None:\n            rng = np.random.default_rng(12345)\n        sigma = noise_level * np.max(np.abs(P)) if np.max(np.abs(P)) > 0 else 0.0\n        P = P + rng.normal(0.0, sigma, size=P.shape)\n    return P\n\ndef numerical_derivative_uniform(y, dt):\n    \"\"\"\n    Compute numerical derivative dy/dt for uniformly sampled y(t) with spacing dt.\n    Uses central differences for interior, forward/backward for edges.\n    \"\"\"\n    dy = np.empty_like(y)\n    # Forward difference at start\n    dy[0] = (y[1] - y[0]) / dt\n    # Central differences interior\n    dy[1:-1] = (y[2:] - y[:-2]) / (2.0 * dt)\n    # Backward difference at end\n    dy[-1] = (y[-1] - y[-2]) / dt\n    return dy\n\ndef compute_susceptibility_time(P, E0, dt):\n    \"\"\"\n    Compute chi_e(t) = (1/(eps0*E0)) * dP/dt from P(t)\n    \"\"\"\n    dPdt = numerical_derivative_uniform(P, dt)\n    chi_t = dPdt / (EPS0 * E0)\n    return chi_t\n\ndef fourier_transform_one_sided(chi_t, t, omega):\n    \"\"\"\n    Compute chi_e(omega) = integral_0^T chi_e(t) * exp(i*omega*t) dt\n    using Riemann sum.\n    \"\"\"\n    dt = t[1] - t[0]\n    # Matrix exponential evaluation: t[:,None] * omega[None,:]\n    phase = np.exp(1j * np.outer(t, omega))  # shape (N, M)\n    chi_w = dt * (chi_t[:, None] * phase).sum(axis=0)\n    return chi_w\n\ndef kk_from_imag(omega, eps_im, eps_inf):\n    \"\"\"\n    Compute Re[eps_r](omega) via Kramers-Kronig from Im[eps_r](omega), subtracted form.\n    Re[eps_r](w) - eps_inf = (2/pi) P ∫_0^∞ [Omega * Im eps_r(Omega)]/(Omega^2 - w^2) dOmega\n    Implemented on discrete, linearly spaced omega grid with trapezoidal weights.\n    \"\"\"\n    M = omega.size\n    # Linear spacing assumed\n    domega = omega[1] - omega[0]\n    weights = np.ones(M) * domega\n    weights[0] *= 0.5\n    weights[-1] *= 0.5\n\n    re_eps = np.empty(M, dtype=float)\n    for m in range(M):\n        # Principal value: exclude j == m\n        denom = omega**2 - omega[m]**2\n        with np.errstate(divide='ignore', invalid='ignore'):\n            integrand = omega * eps_im / denom\n        integrand[m] = 0.0  # exclude self-term\n        val = (2.0 / np.pi) * np.sum(weights * integrand)\n        re_eps[m] = eps_inf + val\n    return re_eps\n\ndef kk_from_real(omega, eps_re, eps_inf):\n    \"\"\"\n    Compute Im[eps_r](omega) via Kramers-Kronig from Re[eps_r](omega), subtracted form.\n    Im[eps_r](w) = -(2*w/pi) P ∫_0^∞ [Re eps_r(Omega) - eps_inf]/(Omega^2 - w^2) dOmega\n    Discrete principal value with trapezoidal weights on linear omega grid.\n    \"\"\"\n    M = omega.size\n    domega = omega[1] - omega[0]\n    weights = np.ones(M) * domega\n    weights[0] *= 0.5\n    weights[-1] *= 0.5\n\n    im_eps = np.empty(M, dtype=float)\n    for m in range(M):\n        denom = omega**2 - omega[m]**2\n        with np.errstate(divide='ignore', invalid='ignore'):\n            integrand = (eps_re - eps_inf) / denom\n        integrand[m] = 0.0  # exclude self-term\n        val = -(2.0 * omega[m] / np.pi) * np.sum(weights * integrand)\n        im_eps[m] = val\n    return im_eps\n\ndef kk_compliance(eps_re, eps_im, omega, eps_inf, trim=5, tol=0.25):\n    \"\"\"\n    Compute relative L2 errors between eps and its KK reconstructions on interior band,\n    and return boolean for compliance (both errors <= tol).\n    \"\"\"\n    # K-K reconstructions\n    re_from_im = kk_from_imag(omega, eps_im, eps_inf)\n    im_from_re = kk_from_real(omega, eps_re, eps_inf)\n\n    # Interior slicing to reduce edge effects\n    lo = trim\n    hi = len(omega) - trim\n    if hi <= lo + 1:\n        lo = 1\n        hi = len(omega) - 1\n\n    # Relative L2 errors\n    eps0 = 1e-12\n    num_re = np.linalg.norm((eps_re - eps_inf)[lo:hi] - (re_from_im - eps_inf)[lo:hi])\n    den_re = np.linalg.norm((eps_re - eps_inf)[lo:hi]) + eps0\n    err_re = num_re / den_re\n\n    num_im = np.linalg.norm(eps_im[lo:hi] - im_from_re[lo:hi])\n    den_im = np.linalg.norm(eps_im[lo:hi]) + eps0\n    err_im = num_im / den_im\n\n    return (max(err_re, err_im) <= tol), err_re, err_im\n\ndef invert_and_test_case(E0, eps_inf, terms, dt, N, noise_level=0.0, seed=1234,\n                         M_freq=256, tol=0.25):\n    \"\"\"\n    Full pipeline for one case:\n    - synthesize P(t)\n    - compute chi_e(t)\n    - compute chi_e(omega) and eps_r(omega)\n    - test Kramers-Kronig compliance\n    Returns boolean compliance.\n    \"\"\"\n    # Time grid\n    t = np.arange(N, dtype=float) * dt\n    # Synthesize P(t)\n    rng = np.random.default_rng(seed)\n    P = synthesize_P(t, E0, terms, noise_level=noise_level, rng=rng)\n    # Time-domain susceptibility via derivative\n    chi_t = compute_susceptibility_time(P, E0, dt)\n    # Frequency grid: linear from 2*pi/T to pi/dt\n    T = N * dt\n    w_min = 2.0 * np.pi / T\n    w_max = np.pi / dt\n    omega = np.linspace(w_min, w_max, M_freq)\n    # Fourier transform\n    chi_w = fourier_transform_one_sided(chi_t, t, omega)\n    # Relative permittivity\n    eps_r = eps_inf + chi_w\n    eps_re = np.real(eps_r)\n    eps_im = np.imag(eps_r)\n    # KK test\n    compliant, _, _ = kk_compliance(eps_re, eps_im, omega, eps_inf, trim=5, tol=tol)\n    return compliant\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Case 1: Single relaxation, well-resolved, no noise\n    case1 = dict(\n        E0=1.0e5,\n        eps_inf=2.0,\n        terms=[(3.0, 5.0e-7)],\n        dt=1.0e-8,\n        N=4096,\n        noise_level=0.0\n    )\n    # Case 2: Two relaxations, well-resolved, no noise\n    case2 = dict(\n        E0=1.0e5,\n        eps_inf=1.4,\n        terms=[(2.0, 2.0e-7), (1.0, 4.0e-6)],\n        dt=1.0e-8,\n        N=4096,\n        noise_level=0.0\n    )\n    # Case 3: Single relaxation, coarse/short record, noisy\n    case3 = dict(\n        E0=1.0e5,\n        eps_inf=2.0,\n        terms=[(3.0, 3.0e-6)],\n        dt=5.0e-8,\n        N=256,\n        noise_level=1.0e-1\n    )\n    # Case 4: Single relaxation, very short record relative to tau\n    case4 = dict(\n        E0=1.0e5,\n        eps_inf=2.0,\n        terms=[(3.0, 1.0e-4)],\n        dt=1.0e-8,\n        N=256,\n        noise_level=0.0\n    )\n\n    test_cases = [case1, case2, case3, case4]\n\n    results = []\n    for idx, params in enumerate(test_cases):\n        compliant = invert_and_test_case(\n            E0=params[\"E0\"],\n            eps_inf=params[\"eps_inf\"],\n            terms=params[\"terms\"],\n            dt=params[\"dt\"],\n            N=params[\"N\"],\n            noise_level=params[\"noise_level\"],\n            seed=1234 + idx,  # different seeds for different cases\n            M_freq=256,\n            tol=0.25\n        )\n        results.append(compliant)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(['True' if r else 'False' for r in results])}]\")\n\nsolve()\n```", "id": "2838447"}]}