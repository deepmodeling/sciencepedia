{"hands_on_practices": [{"introduction": "第一个练习是固态物理学的基石。我们将为最简单的晶体——由弹簧连接的相同原子组成的一维链——推导声子色散关系。这个基础模型让我们能够理解集体振动（声子）是如何从离散的原子相互作用中产生的，以及它们的频率$ \\omega $如何依赖于波矢$ q $，从而引入布里渊区的基本概念。[@problem_id:2848415]", "problem": "考虑一个由质量为 $M$ 的相同原子组成的无限长一维单原子 Bravais 格子，其晶格常数为 $a$。相邻原子通过劲度系数为 $K$ 的相同线性谐和弹簧耦合，该弹簧仅在最近邻原子之间起作用。假设原子偏离平衡位置的位移 $u_n(t)$ 很小，以便 Hooke 定律成立。对包含 $N$ 个原子的原子链施加 Born–von Karman (BvK) 周期性边界条件，然后在需要时取极限 $N \\to \\infty$。\n\n从 Newton 第二定律和关于最近邻之间恢复力的 Hooke 定律出发，推导位移 $\\{u_n(t)\\}$ 的线性运动方程。根据这些方程，构建此单原子晶格在倒易空间中的动力学矩阵 $D(q)$，并求解相应的本征值问题，以获得一维晶格第一布里渊区中波矢为 $q$ 的声子角频率 $\\omega(q)$ 的显式解析形式。\n\n所有角量均使用弧度，并取第一布里渊区为 $q \\in [-\\pi/a,\\pi/a]$。将最终频率 $\\omega(q)$ 表示为以 $K$、$M$、$a$ 和 $q$ 表示的封闭形式解析表达式，单位为弧度/秒。最终答案必须是 $\\omega(q)$ 的单个表达式（不含等号）。无需进行数值计算或四舍五入。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 系统：无限长一维单原子 Bravais 格子。\n- 原子属性：质量 $M$。\n- 晶格几何：晶格常数 $a$。\n- 相互作用：劲度系数为 $K$ 的线性谐和弹簧，仅作用于最近邻原子。\n- 动力学：偏离平衡位置的小位移 $u_n(t)$。\n- 控制定律：Newton 第二定律，Hooke 定律。\n- 边界条件：对包含 $N$ 个原子的原子链施加 Born–von Karman (BvK) 周期性边界条件，并取极限 $N \\to \\infty$。\n- 任务：\n    1. 推导 $\\{u_n(t)\\}$ 的线性运动方程。\n    2. 构建动力学矩阵 $D(q)$。\n    3. 求解本征值问题以找到声子角频率 $\\omega(q)$。\n- 定义域：波矢 $q$ 位于第一布里渊区，$q \\in [-\\frac{\\pi}{a}, \\frac{\\pi}{a}]$。\n- 要求输出格式：一个用 $K$、$M$、$a$ 和 $q$ 表示的关于 $\\omega(q)$ 的封闭形式解析表达式。\n\n**步骤 2：使用已知条件进行验证**\n该问题是固态物理学中关于一维单原子链晶格动力学的一个典型练习题。\n- **科学依据：** 该问题基于经典力学（Newton 第二定律、Hooke 定律）的基本原理和凝聚态物理学（Bravais 格子、Born-von Karman 条件）的标准模型。它是科学合理的。\n- **适定性：** 所有必需的参数（$M$、$K$、$a$）均已提供。目标定义清晰，问题结构能够导出一个唯一且有意义的色散关系 $\\omega(q)$ 解。\n- **客观性：** 问题以精确、无歧义的科学语言陈述。\n\n**步骤 3：结论与行动**\n该问题被判定为 **有效**。它是入门固态物理学中的一个标准、适定的问题。将提供完整解答。\n\n我们首先对一维晶格进行建模。第 $n$ 个原子的平衡位置由 $x_n = na$ 给出，其中 $n$ 为整数。设 $u_n(t)$ 为第 $n$ 个原子偏离其平衡位置的位移。该分析假设位移很小，因此 Hooke 定律适用。\n\n第 $n$ 个原子所受的力是其最近邻，即位于 $(n-1)$ 和 $(n+1)$ 位置的原子作用力的总和。\n位于 $(n+1)$ 的原子对位于 $n$ 的原子的作用力，记为 $F_{n \\leftarrow n+1}$，是由连接它们的弹簧的伸长引起的。该弹簧的长度变化为 $(x_{n+1} + u_{n+1}) - (x_n + u_n) - a = (na+a+u_{n+1}) - (na+u_n) - a = u_{n+1} - u_n$。根据 Hooke 定律，这会对原子 $n$ 产生一个恢复力，大小为 $F_{n \\leftarrow n+1} = K(u_{n+1} - u_n)$。\n类似地，位于 $(n-1)$ 的原子对位于 $n$ 的原子的作用力为 $F_{n \\leftarrow n-1}$。原子 $n$ 和 $(n-1)$ 之间弹簧的伸长量为 $(x_n+u_n)-(x_{n-1}+u_{n-1})-a = u_n - u_{n-1}$。这会对原子 $n$ 产生一个恢复力，大小为 $F_{n \\leftarrow n-1} = -K(u_n - u_{n-1})$。\n\n第 $n$ 个原子上的总力是这两个力的和：\n$$F_n = F_{n \\leftarrow n+1} + F_{n \\leftarrow n-1} = K(u_{n+1} - u_n) - K(u_n - u_{n-1}) = K(u_{n+1} + u_{n-1} - 2u_n)$$\n根据 Newton 第二定律，$F_n = M \\ddot{u}_n$，其中 $\\ddot{u}_n = \\frac{d^2u_n}{dt^2}$。这给出了第 $n$ 个原子的运动方程：\n$$M \\ddot{u}_n(t) = K \\left( u_{n+1}(t) + u_{n-1}(t) - 2u_n(t) \\right)$$\n这就是位移 $u_n(t)$ 的线性运动方程。\n\n由于晶格的平移对称性，我们寻求如下形式的行波解（简正模式）：\n$$u_n(t) = A \\exp[i(q x_n - \\omega t)] = A \\exp[i(qna - \\omega t)]$$\n其中 $A$ 是振幅，$q$ 是波矢，$\\omega$ 是角频率。将此拟设代入运动方程需要以下各项：\n$$ \\ddot{u}_n(t) = (-i\\omega)^2 u_n(t) = -\\omega^2 u_n(t) $$\n$$ u_{n+1}(t) = A \\exp[i(q(n+1)a - \\omega t)] = u_n(t) \\exp(iqa) $$\n$$ u_{n-1}(t) = A \\exp[i(q(n-1)a - \\omega t)] = u_n(t) \\exp(-iqa) $$\n将这些代入运动方程得到：\n$$ M(-\\omega^2) u_n(t) = K \\left( u_n(t)\\exp(iqa) + u_n(t)\\exp(-iqa) - 2u_n(t) \\right) $$\n对于非平凡解（$u_n(t) \\neq 0$），我们可以除以 $u_n(t)$：\n$$ -M\\omega^2 = K (\\exp(iqa) + \\exp(-iqa) - 2) $$\n使用 Euler 恒等式 $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$，我们有：\n$$ -M\\omega^2 = K(2\\cos(qa) - 2) = -2K(1 - \\cos(qa)) $$\n$$ M\\omega^2 = 2K(1 - \\cos(qa)) $$\n这个方程就是声子色散关系。我们可以使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\frac{\\theta}{2})$ 来简化它：\n$$ M\\omega^2(q) = 2K \\left( 2\\sin^2\\left(\\frac{qa}{2}\\right) \\right) = 4K \\sin^2\\left(\\frac{qa}{2}\\right) $$\n这个表达式关联了角频率 $\\omega$和波矢 $q$。\n\n问题还要求构建动力学矩阵 $D(q)$。运动方程的矩阵形式的一般形式是 $M\\omega^2 \\vec{u} = D(q) \\vec{u}$。对于单原子基元，这变成一个标量方程 $M\\omega^2 = D(q)$。动力学矩阵是原子间力常数 $\\Phi_{nn'}$ 的空间傅里叶变换。运动方程可以写成 $M\\ddot{u}_n = -\\sum_{n'} \\Phi_{nn'} u_{n'}$。从我们推导的运动方程 $M \\ddot{u}_n = K u_{n+1} + K u_{n-1} - 2K u_{n}$，我们可以确定力常数：\n$$ \\Phi_{nn} = 2K $$\n$$ \\Phi_{n, n+1} = -K $$\n$$ \\Phi_{n, n-1} = -K $$\n$$ \\Phi_{nn'} = 0 \\quad \\text{for } |n-n'| > 1 $$\n动力学矩阵（在本例中为标量）由下式给出：\n$$ D(q) = \\sum_{n'} \\Phi_{n, n'} \\exp[iq(x_{n'} - x_n)] $$\n由于平移不变性，这个和与 $n$无关。设 $n=0$：\n$$ D(q) = \\sum_{n'} \\Phi_{0, n'} \\exp[iq x_{n'}] = \\Phi_{0,0} + \\Phi_{0,1}\\exp(iqa) + \\Phi_{0,-1}\\exp(-iqa) $$\n$$ D(q) = 2K - K\\exp(iqa) - K\\exp(-iqa) = 2K - K(\\exp(iqa) + \\exp(-iqa)) $$\n$$ D(q) = 2K - 2K\\cos(qa) = 2K(1 - \\cos(qa)) $$\n本征值问题是 $M\\omega^2(q) = D(q)$，这给出：\n$$ M\\omega^2(q) = 2K(1 - \\cos(qa)) = 4K \\sin^2\\left(\\frac{qa}{2}\\right) $$\n这证实了先前获得的结果。\n\n求解 $\\omega(q)$，我们取平方根。由于频率是一个物理上的正量，我们取正根：\n$$ \\omega^2(q) = \\frac{4K}{M} \\sin^2\\left(\\frac{qa}{2}\\right) $$\n$$ \\omega(q) = \\sqrt{\\frac{4K}{M}} \\sqrt{\\sin^2\\left(\\frac{qa}{2}\\right)} = \\sqrt{\\frac{4K}{M}} \\left|\\sin\\left(\\frac{qa}{2}\\right)\\right| $$\n绝对值是必要的，因为波矢 $q$ 属于第一布里渊区，$q \\in [-\\frac{\\pi}{a}, \\frac{\\pi}{a}]$，对于这个区间，正弦函数的自变量 $\\frac{qa}{2}$ 的范围是从 $-\\frac{\\pi}{2}$ 到 $\\frac{\\pi}{2}$。在此区间内，$\\sin(\\frac{qa}{2})$ 可以是负数，而 $\\omega$ 必须为非负数。\n\n声子角频率的最终表达式为：\n$$ \\omega(q) = 2\\sqrt{\\frac{K}{M}} \\left|\\sin\\left(\\frac{qa}{2}\\right)\\right| $$\n这是一维单原子链的色散关系。它表明，对于小 $q$（长波长），$\\omega \\approx a\\sqrt{K/M}|q|$，这是声学波特有的线性关系。在布里渊区的边界，$q = \\pm \\frac{\\pi}{a}$，频率达到其最大值 $\\omega_{max} = 2\\sqrt{\\frac{K}{M}}$。", "answer": "$$ \\boxed{2\\sqrt{\\frac{K}{M}} \\left|\\sin\\left(\\frac{qa}{2}\\right)\\right|} $$", "id": "2848415"}, {"introduction": "真实材料中的相互作用并不仅限于最近邻。本练习在我们的基础模型之上，引入了次近邻相互作用，展示了一个更精细的模型如何能够解释实验中观测到的、偏离简单正弦色散曲线的现象。通过将模型与假设的实验数据进行拟合，你将深入了解如何运用理论模型来解释和量化实验结果背后的物理学原理。[@problem_id:2848436]", "problem": "当一个单原子立方晶体沿 $[100]$ 晶向被探测时，其声学支在波矢接近布里渊区边界的高对称点 $X$ 处，表现出与仅考虑最近邻简谐相互作用时所预期的简单正弦形状的偏离。为了合理解释这一反常现象，考虑一个代表沿 $[100]$ 方向纵向声子的一维单原子链模型，其晶格间距为 $a$，原子质量为 $m$，且简谐相互作用延伸至次近邻，由力常数 $C_{1}$ (最近邻) 和 $C_{2}$ (次近邻) 表征。\n\n仅从牛顿第二定律以及第 $n$ 个原子位移的平面波简正模式定义 $u_{n}(t)=u\\,\\exp(i k n a - i \\omega t)$ 出发，推导这条同时包含 $C_{1}$ 和 $C_{2}$ 相互作用的链的色散关系 $\\omega(k)$。然后，利用在 $k_{0}=3\\pi/(4a)$ 和 $X=\\pi/a$ 处实验观测到的频率比 $\\omega(k_{0})/\\omega(X)=0.96$，消去未知数 $m$ 和 $C_{1}$，并求解比值 $\\alpha=C_{2}/C_{1}$。\n\n给出 $\\alpha$ 的最终值，四舍五入到 $3$ 位有效数字。最终答案是无量纲的，应以不带单位的纯数字形式给出。", "solution": "问题要求推导包含最近邻和次近邻相互作用的一维单原子链的声子色散关系，然后确定力常数的比值。该问题提法恰当且有科学依据。我们从第一性原理出发进行推导。\n\n设第 $n$ 个原子的平衡位置为 $na$，其中 $a$ 是晶格间距。设 $u_n$ 为第 $n$ 个原子偏离其平衡位置的纵向位移。在简谐近似下，作用在某个原子上的力与其邻居的相对位移成线性关系。\n\n位于 $(n-1)a$ 和 $(n+1)a$ 位置的最近邻原子对第 $n$ 个原子施加的力由胡克定律给出：\n$$F_{n, \\text{nn}} = C_1(u_{n+1} - u_n) + C_1(u_{n-1} - u_n) = C_1(u_{n+1} + u_{n-1} - 2u_n)$$\n其中 $C_1$ 是最近邻力常数。\n\n位于 $(n-2)a$ 和 $(n+2)a$ 位置的次近邻原子对第 $n$ 个原子施加的力为：\n$$F_{n, \\text{nnn}} = C_2(u_{n+2} - u_n) + C_2(u_{n-2} - u_n) = C_2(u_{n+2} + u_{n-2} - 2u_n)$$\n其中 $C_2$ 是次近邻力常数。\n\n第 $n$ 个原子所受的总力 $F_n$ 是这些贡献之和。根据牛顿第二定律，质量为 $m$ 的第 $n$ 个原子的运动方程为 $m \\ddot{u}_n = F_n$：\n$$m \\frac{d^2 u_n}{dt^2} = C_1(u_{n+1} + u_{n-1} - 2u_n) + C_2(u_{n+2} + u_{n-2} - 2u_n)$$\n\n我们寻求代表链的简正模式的平面波解，其形式如问题陈述中所给出的：\n$$u_n(t) = u \\exp(i(kna - \\omega t))$$\n其中 $k$ 是波矢，$\\omega$ 是角频率，而 $u$ 是振幅。相邻原子的位移通过一个相位因子相关联：$u_{n\\pm p}(t) = u \\exp(i(k(n\\pm p)a - \\omega t)) = u_n(t) \\exp(\\pm ikpa)$。\n对时间的二阶导数为 $\\ddot{u}_n = (-i\\omega)^2 u_n = -\\omega^2 u_n$。\n\n将这些代入运动方程中：\n$$-\\omega^2 m u_n = C_1(u_n e^{ika} + u_n e^{-ika} - 2u_n) + C_2(u_n e^{i2ka} + u_n e^{-i2ka} - 2u_n)$$\n对于非平庸解 ($u_n \\neq 0$)，我们可以两边同除以 $u_n$：\n$$-\\omega^2 m = C_1(e^{ika} + e^{-ika} - 2) + C_2(e^{i2ka} + e^{-i2ka} - 2)$$\n使用欧拉恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，我们得到：\n$$-\\omega^2 m = C_1(2\\cos(ka) - 2) + C_2(2\\cos(2ka) - 2)$$\n$$\\omega^2 m = 2C_1(1 - \\cos(ka)) + 2C_2(1 - \\cos(2ka))$$\n使用三角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$:\n$$\\omega^2 m = 2C_1 \\left(2\\sin^2\\left(\\frac{ka}{2}\\right)\\right) + 2C_2 \\left(2\\sin^2\\left(\\frac{2ka}{2}\\right)\\right)$$\n$$\\omega^2 m = 4C_1 \\sin^2\\left(\\frac{ka}{2}\\right) + 4C_2 \\sin^2(ka)$$\n这就给出了色散关系 $\\omega(k)$：\n$$\\omega^2(k) = \\frac{4}{m} \\left(C_1 \\sin^2\\left(\\frac{ka}{2}\\right) + C_2 \\sin^2(ka)\\right)$$\n对频率取正平方根：\n$$\\omega(k) = 2 \\sqrt{\\frac{1}{m} \\left(C_1 \\sin^2\\left(\\frac{ka}{2}\\right) + C_2 \\sin^2(ka)\\right)}$$\n这就完成了问题的第一部分。\n\n接下来，我们必须利用所提供的实验数据来确定比值 $\\alpha = C_2/C_1$。让我们用 $\\alpha$ 来重写 $\\omega^2(k)$：\n$$\\omega^2(k) = \\frac{4C_1}{m} \\left(\\sin^2\\left(\\frac{ka}{2}\\right) + \\alpha \\sin^2(ka)\\right)$$\n问题给出了在两个特定波矢处的频率比：$k_0 = 3\\pi/(4a)$ 和布里渊区边界点 $X$，其波矢为 $k_X = \\pi/a$。\n\n首先，我们计算在 $k_X = \\pi/a$ 处的 $\\omega^2(k)$：\n$ka = \\pi \\implies \\frac{ka}{2} = \\frac{\\pi}{2}$\n$$\\omega^2(X) = \\frac{4C_1}{m} \\left(\\sin^2\\left(\\frac{\\pi}{2}\\right) + \\alpha \\sin^2(\\pi)\\right) = \\frac{4C_1}{m} \\left(1^2 + \\alpha \\cdot 0^2\\right) = \\frac{4C_1}{m}$$\n\n接下来，我们计算在 $k_0 = 3\\pi/(4a)$ 处的 $\\omega^2(k)$：\n$ka = \\frac{3\\pi}{4} \\implies \\frac{ka}{2} = \\frac{3\\pi}{8}$\n$$\\omega^2(k_0) = \\frac{4C_1}{m} \\left(\\sin^2\\left(\\frac{3\\pi}{8}\\right) + \\alpha \\sin^2\\left(\\frac{3\\pi}{4}\\right)\\right)$$\n我们使用恒等式 $\\sin^2(\\theta) = (1-\\cos(2\\theta))/2$ 和 $\\sin(3\\pi/4) = \\sqrt{2}/2$：\n$$\\sin^2\\left(\\frac{3\\pi}{8}\\right) = \\frac{1 - \\cos(3\\pi/4)}{2} = \\frac{1 - (-\\sqrt{2}/2)}{2} = \\frac{2+\\sqrt{2}}{4}$$\n$$\\sin^2\\left(\\frac{3\\pi}{4}\\right) = \\left(\\frac{\\sqrt{2}}{2}\\right)^2 = \\frac{2}{4} = \\frac{1}{2}$$\n将这些代入 $\\omega^2(k_0)$ 的表达式中：\n$$\\omega^2(k_0) = \\frac{4C_1}{m} \\left(\\frac{2+\\sqrt{2}}{4} + \\alpha \\frac{1}{2}\\right)$$\n\n现在我们构造比值 $\\omega^2(k_0)/\\omega^2(X)$：\n$$\\frac{\\omega^2(k_0)}{\\omega^2(X)} = \\frac{\\frac{4C_1}{m} \\left(\\frac{2+\\sqrt{2}}{4} + \\frac{\\alpha}{2}\\right)}{\\frac{4C_1}{m}} = \\frac{2+\\sqrt{2}}{4} + \\frac{\\alpha}{2}$$\n问题提供了频率比 $\\omega(k_0)/\\omega(X) = 0.96$。将这个值平方，得到频率平方的比值：\n$0.96^2 = 0.9216$\n我们现在可以建立一个关于 $\\alpha$ 的方程：\n$$0.9216 = \\frac{2+\\sqrt{2}}{4} + \\frac{\\alpha}{2}$$\n求解 $\\alpha$：\n$$\\frac{\\alpha}{2} = 0.9216 - \\frac{2+\\sqrt{2}}{4}$$\n$$\\alpha = 2 \\left(0.9216 - \\frac{2+\\sqrt{2}}{4}\\right) = 1.8432 - (1 + \\frac{\\sqrt{2}}{2}) = 0.8432 - \\frac{\\sqrt{2}}{2}$$\n为了得到数值，我们使用 $\\sqrt{2} \\approx 1.41421356$：\n$$\\alpha \\approx 0.8432 - \\frac{1.41421356}{2} = 0.8432 - 0.70710678 = 0.13609322$$\n问题要求将值四舍五入到 $3$ 位有效数字。\n$$\\alpha \\approx 0.136$$\n$\\alpha$ 的这个正值表明次近邻相互作用也是一种恢复力，这对于稳定的晶格是物理上所预期的。", "answer": "$$\\boxed{0.136}$$", "id": "2848436"}, {"introduction": "当从解析模型过渡到数值计算时，我们必须确保基本的物理原理得到遵守。这个编程练习将探讨声学求和规则（Acoustic Sum Rule, ASR），这是晶体平移不变性的一个必然数学结果，它规定了声学声子在布里渊区中心（$ \\Gamma $点）的频率必须为零。你将编写一个程序来量化当ASR被违背时出现的非物理“带隙”，并实施修正以恢复这一关键的物理特性。[@problem_id:2848329]", "problem": "编写一个完整的程序，从谐振子格点动力学方程和动力学矩阵的定义出发，通过计算布里渊区中心的伪能隙并应用强制满足平移不变性的修正，来量化违反声学求和规则对声学支低波矢行为的影响。\n\n使用以下基本依据。在谐振子近似下，小位移的运动方程是 Newton 第二定律，$M \\,\\ddot{\\mathbf{u}} = -\\Phi \\,\\mathbf{u}$，其中 $M$ 是对角质量矩阵，$\\Phi$ 是力常数矩阵。一个平面波尝试解 $\\mathbf{u}_{\\kappa}(n,t) = \\boldsymbol{\\epsilon}_{\\kappa} \\,\\mathrm{e}^{\\mathrm{i}(q R_{n} - \\omega t)}$ 导出了动力学矩阵 $D(q)$ 的本征问题，\n$$\nD_{\\kappa\\kappa'}(q)\\,\\boldsymbol{\\epsilon}_{\\kappa'} = \\omega^{2}(q)\\,\\boldsymbol{\\epsilon}_{\\kappa},\n$$\n其中\n$$\nD_{\\kappa\\kappa'}(q) = \\frac{1}{\\sqrt{m_{\\kappa} m_{\\kappa'}}} \\sum_{R} \\Phi_{\\kappa\\kappa'}(R)\\,\\mathrm{e}^{\\mathrm{i} q R},\n$$\n在此，$m_{\\kappa}$ 是参考原胞中原子 $\\kappa$ 的质量，$\\Phi_{\\kappa\\kappa'}(R)$ 是耦合参考原胞中原子 $\\kappa$ 和由晶格矢量 $R$ 位移的元胞中原子 $\\kappa'$ 的实空间力常数块，$q$ 是晶体波矢（角度以弧度为单位）。平移不变性意味着声学求和规则成立，即对每个 $\\kappa$ 都有 $\\sum_{\\kappa',R} \\Phi_{\\kappa\\kappa'}(R) = 0$。如果此规则不满足，则均匀平移不再是零能模式，在布里渊区中心 $\\Gamma$ ($q=0$) 处会出现一个非物理的非零声学频率。\n\n对于每个给定的测试用例，您的程序必须执行以下操作：\n1. 使用给定的实空间力常数和质量，在布里渊区中心 $q=0$ 处构建 $D(q)$。在所有情况下，取一维晶格常数 $a = 1$，因此 $R \\in \\{ \\ldots, -2, -1, 0, 1, 2, \\ldots \\}$ 是以 $a$ 的倍数表示的，角度以弧度为单位。\n2. 计算 $D(0)$ 的最小本征值 $\\lambda_{\\min}$，它对应于声学支。将 $\\Gamma$ 点的伪声学能隙定义为 $\\omega_{\\Gamma} = \\sqrt{\\max(\\lambda_{\\min}, 0)}$。\n3. 通过修改每个原子 $\\kappa$ 的在位块，在实空间中应用声学求和规则修正：\n$$\n\\Phi_{\\kappa\\kappa}(0) \\leftarrow \\Phi_{\\kappa\\kappa}(0) - \\sum_{\\kappa',R} \\Phi_{\\kappa\\kappa'}(R),\n$$\n同时保持所有离位块不变。这将对每个原子 $\\kappa$ 精确地强制 $\\sum_{\\kappa',R} \\Phi_{\\kappa\\kappa'}(R) = 0$。\n4. 重新计算 $D(0)$ 和修正后的伪能隙 $\\omega_{\\Gamma}^{(\\mathrm{corr})}$。\n5. 为每个测试用例报告数值对 $[\\omega_{\\Gamma}, \\omega_{\\Gamma}^{(\\mathrm{corr})}]$。\n\n使用无量纲单位，其中参考质量和刚度分别为 $m_{0}=1$ 和 $K_{0}=1$，因此角频率以自然单位 $\\sqrt{K_{0}/m_{0}}$ 表示。所有角频率输出均使用此无量纲单位，并四舍五入到六位小数。\n\n实现以下测试套件。在所有情况下，仅考虑沿链的标量位移（每个原子一个自由度）。\n\n测试用例 A（单原子链，满足声学求和规则）：\n- 原胞中的原子数：$N=1$，质量 $m_{1}=1$。\n- 最近邻弹簧刚度 $K=1$。\n- 非零实空间力常数：\n  - $\\Phi_{11}(0) = 2$,\n  - $\\Phi_{11}(+1) = -1$,\n  - $\\Phi_{11}(-1) = -1$。\n- 预期的物理行为：精确的平移不变性和零声学能隙。\n\n测试用例 B（单原子链，违反声学求和规则）：\n- 原胞中的原子数：$N=1$，质量 $m_{1}=1$。\n- 最近邻弹簧刚度 $K=1$，带有一个违反求和规则的小的在位微扰 $\\varepsilon = 0.02$。\n- 非零实空间力常数：\n  - $\\Phi_{11}(0) = 2 + 0.02$,\n  - $\\Phi_{11}(+1) = -1$,\n  - $\\Phi_{11}(-1) = -1$。\n- 预期的物理行为：$\\Gamma$ 点存在非零伪能隙，修正后消失。\n\n测试用例 C（双原子链，混合质量，违反声学求和规则）：\n- 原胞中的原子数：$N=2$，质量 $m_{1}=1$ 和 $m_{2}=2$。\n- 最近邻弹簧刚度 $K=1$，带有小的在位微扰 $\\varepsilon_{1} = 0.01$ 和 $\\varepsilon_{2} = -0.005$。\n- 非零实空间力常数：\n  - 在位：$\\Phi_{11}(0) = 2 + 0.01$, $\\Phi_{22}(0) = 2 - 0.005$,\n  - 同一原胞内的子晶格间：$\\Phi_{12}(0) = -1$, $\\Phi_{21}(0) = -1$,\n  - 与相邻原胞的子晶格间：$\\Phi_{12}(-1) = -1$, $\\Phi_{21}(+1) = -1$。\n- 所有其他 $\\Phi_{\\kappa\\kappa'}(R)$ 均为零。\n- 预期的物理行为：$\\Gamma$ 点存在非零伪能隙，修正后消失。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表，列表包含六个结果，顺序如下：\n$$\n\\big[\\omega_{\\Gamma}^{(A)},\\,\\omega_{\\Gamma}^{(A,\\mathrm{corr})},\\,\\omega_{\\Gamma}^{(B)},\\,\\omega_{\\Gamma}^{(B,\\mathrm{corr})},\\,\\omega_{\\Gamma}^{(C)},\\,\\omega_{\\Gamma}^{(C,\\mathrm{corr})}\\big],\n$$\n结果四舍五入到六位小数，以无量纲单位 $\\sqrt{K_{0}/m_{0}}$ 表示。例如：\"[0.000000,0.000000,0.141421,0.000000,0.040693,0.000000]\"。", "solution": "所提出的问题是格点动力学中的一个标准练习，因此被认为是有效的。它以固态物理学原理为科学基础，提法恰当且提供了所有必要信息，并以客观、正式的语言陈述。我们将开始解答。\n\n核心任务是分析违反声学求和规则（ASR）对布里渊区中心（$\\Gamma$点，波矢$q=0$）声子频率的影响。晶格的平移不变性要求所有原子的均匀位移必须是一个零能模式，对应于$q=0$处的零频率声学声子支。这一物理要求在数学上被编码在 ASR 中。\n\n出发点是动力学矩阵 $D(q)$ 的本征值方程：\n$$\n\\sum_{\\kappa'} D_{\\kappa\\kappa'}(q)\\,\\epsilon_{\\kappa'}^{\\nu} = \\omega_{\\nu}^{2}(q)\\,\\epsilon_{\\kappa}^{\\nu}\n$$\n其中 $\\omega_{\\nu}(q)$ 和 $\\boldsymbol{\\epsilon}^{\\nu}$ 分别是声子模式 $(\\nu, q)$ 的频率和极化矢量。动力学矩阵由实空间原子间力常数 $\\Phi_{\\kappa\\kappa'}(R)$ 和原子质量 $m_{\\kappa}$ 定义为：\n$$\nD_{\\kappa\\kappa'}(q) = \\frac{1}{\\sqrt{m_{\\kappa} m_{\\kappa'}}} \\sum_{R} \\Phi_{\\kappa\\kappa'}(R)\\,\\mathrm{e}^{\\mathrm{i} q R}\n$$\n这里，$\\kappa$ 和 $\\kappa'$ 是原胞内原子的索引，$R$ 是一个晶格矢量。\n\n在布里渊区中心（$q=0$），指数因子变为1，动力学矩阵简化为：\n$$\nD_{\\kappa\\kappa'}(0) = \\frac{1}{\\sqrt{m_{\\kappa} m_{\\kappa'}}} \\sum_{R} \\Phi_{\\kappa\\kappa'}(R)\n$$\n\n声学求和规则源于这样一个条件：如果整个晶体被一个均匀矢量平移，任何原子上都不应有力作用。这意味着对于每个原子 $\\kappa$，晶体中所有其他原子对其施加的所有力的总和必须为零。这导出了以下条件：\n$$\n\\sum_{\\kappa', R} \\Phi_{\\kappa\\kappa'}(R) = 0 \\quad \\text{对每个 } \\kappa\n$$\n如果此规则得到满足，可以证明 $D(0)$ 的一个本征矢量与 $(\\sqrt{m_1}, \\sqrt{m_2}, \\dots, \\sqrt{m_N})$ 成比例，其对应的本征值为零，从而确保三个声学支在 $q=0$ 处 $\\omega(q=0) = 0$。\n\n在数值计算中，特别是当力常数来自由限程模型或从头算时，微小的数值误差可能导致违反 ASR：\n$$\n\\sum_{\\kappa', R} \\Phi_{\\kappa\\kappa'}(R) = \\Delta_{\\kappa} \\neq 0\n$$\n这种违反 $\\Delta_{\\kappa}$ 会导致声学模式在 $q=0$ 处的本征值不为零，从而在声学谱中产生一个非物理的“能隙”。伪频率由 $\\omega_{\\Gamma} = \\sqrt{\\max(\\lambda_{\\min}, 0)}$ 给出，其中 $\\lambda_{\\min}$ 是 $D(0)$ 的最小本征值。\n\n为了纠正这一点，必须强制执行 ASR。一种常见的修正方案如下修改在位力常数 $\\Phi_{\\kappa\\kappa}(0)$：\n$$\n\\Phi'_{\\kappa\\kappa}(0) = \\Phi_{\\kappa\\kappa}(0) - \\Delta_{\\kappa} = \\Phi_{\\kappa\\kappa}(0) - \\sum_{\\kappa', R} \\Phi_{\\kappa\\kappa'}(R)\n$$\n所有其他力常数（$\\kappa \\neq \\kappa'$ 或 $R \\neq 0$）保持不变。根据构造，新的一组力常数 $\\Phi'$ 现在对每个 $\\kappa$ 都满足 ASR：\n$$\n\\sum_{\\kappa', R} \\Phi'_{\\kappa\\kappa'}(R) = \\sum_{\\kappa', R} \\Phi_{\\kappa\\kappa'}(R) - \\Delta_{\\kappa} = \\Delta_{\\kappa} - \\Delta_{\\kappa} = 0\n$$\n用这些修正后的力常数重新计算动力学矩阵 $D'(0)$ 将得到声学模式的零本征值，从而消除伪能隙。\n\n每个测试用例的步骤如下：\n1.  构建 $N \\times N$ 矩阵 $S$，其元素为 $S_{\\kappa\\kappa'} = \\sum_{R} \\Phi_{\\kappa\\kappa'}(R)$，其中 $N$ 是原胞中的原子数。索引 $\\kappa, \\kappa'$ 将从 $1, \\dots, N$ 映射到 $0, \\dots, N-1$ 以便计算。\n2.  构建未修正的动力学矩阵 $D(0)$，其元素为 $D_{\\kappa\\kappa'}(0) = S_{\\kappa\\kappa'} / \\sqrt{m_{\\kappa} m_{\\kappa'}}$。\n3.  计算厄米矩阵 $D(0)$ 的本征值并找到最小本征值 $\\lambda_{\\min}$。初始伪能隙为 $\\omega_{\\Gamma} = \\sqrt{\\max(\\lambda_{\\min}, 0)}$。\n4.  对每个原子 $\\kappa$，计算 ASR 违反量 $\\Delta_{\\kappa} = \\sum_{\\kappa'} S_{\\kappa\\kappa'}$。\n5.  通过修改 $S$ 的对角元素来构建修正后的矩阵 $S'$：$S'_{\\kappa\\kappa} = S_{\\kappa\\kappa} - \\Delta_{\\kappa}$。\n6.  构建修正后的动力学矩阵 $D'(0)$，其元素为 $D'_{\\kappa\\kappa'}(0) = S'_{\\kappa\\kappa'} / \\sqrt{m_{\\kappa} m_{\\kappa'}}$。\n7.  计算 $D'(0)$ 的本征值，找到修正后的最小本征值 $\\lambda'_{\\min}$ 和修正后的能隙 $\\omega_{\\Gamma}^{(\\mathrm{corr})} = \\sqrt{\\max(\\lambda'_{\\min}, 0)}$，该值应为零。\n\n所有计算均使用无量纲单位，其中 $m_0=1$ 和 $K_0=1$。一维晶格常数为 $a=1$。最终频率以 $\\sqrt{K_0/m_0}$ 为单位报告。\n\n对于测试用例 A（单原子，满足 ASR），我们有 $N=1$ 和 $m_1=1$。力常数之和为 $\\sum_R \\Phi_{11}(R) = 2 - 1 - 1 = 0$。这立刻得出 $D_{11}(0)=0$，因此 $\\omega_{\\Gamma}=0$。修正项 $\\Delta_1$ 也为 $0$，所以修正后的能隙仍为 $0$。\n\n对于测试用例 B（单原子，违反 ASR），$N=1$ 和 $m_1=1$。总和为 $\\sum_R \\Phi_{11}(R) = 2.02 - 1 - 1 = 0.02$。因此，$D_{11}(0)=0.02$，且 $\\omega_{\\Gamma}=\\sqrt{0.02}$。修正是 $\\Delta_1=0.02$，导致修正后的 $\\Phi'_{11}(0) = 2.02 - 0.02 = 2$。修正后的总和为 $0$，得到 $\\omega_{\\Gamma}^{(\\mathrm{corr})}=0$。\n\n对于测试用例 C（双原子，违反 ASR），$N=2$，质量为 $m_1=1, m_2=2$。首先计算总和矩阵 $S_{\\kappa\\kappa'}$。违反量 $\\Delta_1 = \\sum_{\\kappa'} S_{1\\kappa'}$ 和 $\\Delta_2 = \\sum_{\\kappa'} S_{2\\kappa'}$ 是非零的。得到的 $2 \\times 2$ 矩阵 $D(0)$ 的本征值会产生一个非零的 $\\omega_{\\Gamma}$。在对 $S_{11}$ 和 $S_{22}$ 应用修正后，重新计算的矩阵 $D'(0)$ 将有一个零本征值，给出 $\\omega_{\\Gamma}^{(\\mathrm{corr})}=0$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating and correcting spurious acoustic gaps\n    at the Gamma point due to acoustic sum rule violations.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            # Test case A (monatomic chain, acoustic sum rule satisfied)\n            \"name\": \"A\",\n            \"masses\": np.array([1.0]),\n            \"force_constants\": {\n                (1, 1, 0): 2.0,\n                (1, 1, 1): -1.0,\n                (1, 1, -1): -1.0,\n            }\n        },\n        {\n            # Test case B (monatomic chain, acoustic sum rule violated)\n            \"name\": \"B\",\n            \"masses\": np.array([1.0]),\n            \"force_constants\": {\n                (1, 1, 0): 2.02,\n                (1, 1, 1): -1.0,\n                (1, 1, -1): -1.0,\n            }\n        },\n        {\n            # Test case C (diatomic chain, mixed masses, ASR violated)\n            \"name\": \"C\",\n            \"masses\": np.array([1.0, 2.0]),\n            \"force_constants\": {\n                (1, 1, 0): 2.01,\n                (2, 2, 0): 1.995,\n                (1, 2, 0): -1.0,\n                (2, 1, 0): -1.0,\n                (1, 2, -1): -1.0,\n                (2, 1, 1): -1.0,\n            }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        masses = case[\"masses\"]\n        fc_dict = case[\"force_constants\"]\n        num_atoms = len(masses)\n\n        # Step 1: Compute S_k_kp = sum_R Phi_k_kp(R)\n        sum_phi = np.zeros((num_atoms, num_atoms))\n        for (k1, k2, R), value in fc_dict.items():\n            # Convert 1-based atom indices to 0-based array indices\n            sum_phi[k1 - 1, k2 - 1] += value\n\n        # Step 2: Compute the uncorrected dynamical matrix D(0) and the spurious gap\n        \n        # Function to compute gap from a sum_phi matrix\n        def compute_gap(s_phi, m):\n            n_atoms = len(m)\n            d0 = np.zeros((n_atoms, n_atoms))\n            for i in range(n_atoms):\n                for j in range(n_atoms):\n                    d0[i, j] = s_phi[i, j] / np.sqrt(m[i] * m[j])\n            \n            # The dynamical matrix at q=0 is real and symmetric, use eigvalsh\n            eigenvalues = np.linalg.eigvalsh(d0)\n            min_eigenvalue = np.min(eigenvalues)\n            \n            # The problem defines the gap from the smallest eigenvalue\n            # guarding against small negative numerical noise becoming NaN\n            gap = np.sqrt(max(0, min_eigenvalue))\n            return gap\n\n        omega_gamma = compute_gap(sum_phi, masses)\n        results.append(omega_gamma)\n\n        # Step 3: Apply acoustic sum rule correction\n        sum_phi_corr = sum_phi.copy()\n        for k in range(num_atoms):\n            # ASR violation for atom k is the sum over its row in sum_phi\n            asr_violation = np.sum(sum_phi[k, :])\n            # The correction is applied to the on-site sum_phi element\n            sum_phi_corr[k, k] -= asr_violation\n\n        # Step 4: Recompute the gap with the corrected force constants\n        omega_gamma_corr = compute_gap(sum_phi_corr, masses)\n        results.append(omega_gamma_corr)\n\n    # Final print statement in the exact required format.\n    # Format each result to six decimal places.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2848329"}]}