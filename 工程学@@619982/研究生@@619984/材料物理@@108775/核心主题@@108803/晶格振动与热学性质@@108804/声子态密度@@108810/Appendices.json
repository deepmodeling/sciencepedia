{"hands_on_practices": [{"introduction": "在分析真实材料复杂的声子态密度之前，理解其强大的首个近似——德拜模型——是至关重要的。本练习将引导您推导德拜频率（$ \\omega_D $），这是一个将原子和声速的微观世界与宏观声子谱联系起来的基本参数。这项实践巩固了 $ k $ 空间和模式计数的概念，这些都是凝聚态物理学的基石。[@problem_id:179778]", "problem": "德拜模型为理解固体的热学性质提供了一个强大的框架。它用一个简化的连续模型来近似晶格复杂的振动谱。考虑一个简单的三维单原子固体，在体积 $V$ 中包含 $N$ 个原子。其原子数密度由 $n = N/V$ 给出。\n\n德拜模型的关键假设是：\n1.  固体被视为一个连续的弹性介质。\n2.  对所有偏振模式，声子的色散关系都是线性和各向同性的：$\\omega(\\vec{k}) = v_s |\\vec{k}|$，其中 $\\omega$ 是角频率，$\\vec{k}$ 是波矢，$v_s$ 是有效声速，并假设对所有模式都为常数。\n3.  总振动模式数固定为 $3N$，对应于 $N$ 个原子的经典自由度。\n4.  为满足前一个条件，引入了一个截止频率，即德拜频率 $\\omega_D$。不存在频率大于 $\\omega_D$ 的模式。这意味着存在一个相应的截止波矢 $k_D$，使得所有允许的模式都位于 k 空间中一个半径为 $k_D$ 的球体（德拜球）内。\n\n利用这些假设，推导德拜频率 $\\omega_D$ 关于原子数密度 $n$ 和有效声速 $v_s$ 的表达式。", "solution": "目标是找到德拜频率 $\\omega_D$ 作为原子数密度 $n$ 和有效声速 $v_s$ 的函数。推导过程通过确定截止波矢 $k_D$ 来进行，以确保总振动模式数等于 $3N$。\n\n**第一步：k 空间中波矢的量子化**\n\n对于体积为 $V = L^3$ 且具有周期性边界条件的固体，允许的波矢 $\\vec{k} = (k_x, k_y, k_z)$ 是量子化的：\n$$ k_i = \\frac{2\\pi m_i}{L} \\quad \\text{for} \\quad i = x, y, z $$\n其中 $m_i$ 是整数。这意味着在 k 空间中，每个允许的 $\\vec{k}$ 矢量占据的体积为 $(2\\pi/L)^3 = (2\\pi)^3/V$。k 空间中的态密度是这个体积的倒数，即 $V/(2\\pi)^3$。\n\n**第二步：计算德拜球内的总模式数**\n\n固体中的总振动模式数为 $3N$。在德拜模型中，这些模式被假设分布在 k 空间中一个半径为 $k_D$ 的球体内。对于每个允许的 $\\vec{k}$ 矢量，存在三个正交的偏振模式（一个纵向和两个横向）。该模型通过假设它们都具有相同的声速 $v_s$ 来简化此问题。\n\n为了求出总模式数，我们将德拜球内允许的 $\\vec{k}$ 态的数量乘以偏振数（3）。$\\vec{k}$ 态的数量是通过对 k 空间态密度在德拜球体积上积分得到的。\n\n$$ 3N = (\\text{偏振数}) \\times (\\text{k 态密度}) \\times (\\text{德拜球体积}) $$\n$$ 3N = 3 \\times \\frac{V}{(2\\pi)^3} \\times \\left( \\int_{|\\vec{k}| \\le k_D} d^3k \\right) $$\n\n该积分就是三维 k 空间中半径为 $k_D$ 的球的体积，即 $\\frac{4}{3}\\pi k_D^3$。\n\n$$ 3N = 3 \\times \\frac{V}{(2\\pi)^3} \\times \\left( \\frac{4}{3}\\pi k_D^3 \\right) $$\n\n**第三步：求解德拜波矢 $k_D$**\n\n我们可以简化第二步中的表达式。等式两边的因子 3 可以消去：\n$$ N = \\frac{V}{8\\pi^3} \\times \\frac{4\\pi}{3} k_D^3 $$\n$$ N = \\frac{V k_D^3}{6\\pi^2} $$\n\n现在，我们求解 $k_D^3$。我们回顾一下，原子数密度为 $n = N/V$。\n$$ k_D^3 = \\frac{6\\pi^2 N}{V} $$\n$$ k_D^3 = 6\\pi^2 n $$\n\n取立方根，得到德拜波矢的表达式：\n$$ k_D = (6\\pi^2 n)^{1/3} $$\n\n**第四步：将德拜波矢与德拜频率联系起来**\n\n德拜模型假设色散关系是线性的 $\\omega = v_s k$。德拜频率 $\\omega_D$ 是对应于截止波矢 $k_D$ 的频率：\n$$ \\omega_D = v_s k_D $$\n\n将第三步中得到的 $k_D$ 表达式代入，我们得到最终结果。\n$$ \\omega_D = v_s (6\\pi^2 n)^{1/3} $$\n这个表达式给出了德拜频率与固体基本性质（其原子数密度和声速）的关系。", "answer": "$$ \\boxed{v_s (6\\pi^2 n)^{1/3}} $$", "id": "179778"}, {"introduction": "声子态密度并非一成不变；它会直接响应晶体基本性质（如原子质量）的变化。本练习利用谐振子近似，推导出一个精确的标度律，描述了在均匀同位素替换下态密度 $ g(\\omega) $ 如何变换。掌握这种解析推导能让您深刻理解振动谱的质量依赖性，并且是解读拉曼光谱或非弹性中子散射等实验结果的关键工具。[@problem_id:2847832]", "problem": "一个每个原胞（primitive unit cell）包含 $n$ 个原子的晶体固体，在谐振近似下，其物理特性由一个二次势能描述，该势能具有一个与同位素质量无关的力常数矩阵 $\\Phi$。设原子位移被汇集在向量 $u(t)$ 中，并设对角的、正定的质量矩阵为 $M$。运动方程由线性二阶系统 $M\\,\\ddot{u}(t)=-\\Phi\\,u(t)$ 给出。存在形式为 $u(t)=\\Re\\{U\\exp(-\\mathrm{i}\\,\\omega t)\\}$ 的简正模解，其角频率 $\\omega\\ge 0$ 由广义特征值问题 $\\Phi\\,U=\\omega^{2}M\\,U$ 确定。\n\n考虑一个均匀的同位素替换，该替换将每个原子质量乘以相同的正常数因子 $\\alpha>0$，因此 $M\\mapsto M'=\\alpha M$，而力常数矩阵 $\\Phi$ 保持不变。设 $g_{\\mathrm{old}}(\\omega)$ 表示原始晶体的声子态密度（单位角频率的模式密度），其定义为在 $\\omega\\in[0,\\infty)$ 上的积分等于简正模的总数。并设 $g_{\\mathrm{new}}(\\omega)$ 表示同位素替换后的声子态密度。\n\n仅从谐振运动方程和声子态密度的定义出发，推导所有声子角频率在这种质量标度变换下的变换规律，并由此确定在均匀同位素替换下态密度的变换法则。将您的最终结果表示为 $g_{\\mathrm{new}}(\\omega)$ 关于 $g_{\\mathrm{old}}(\\cdot)$、$\\omega$ 和 $\\alpha$ 的单个闭合形式表达式。不要使用任何预先推导出的标度公式。最终答案必须是单个解析表达式。不需要进行数值计算，最终方框内的表达式中不应包含任何单位。", "solution": "所述问题具有科学依据，提法恰当且自洽。它描述了晶格动力学谐振理论中的一个标准情景。所有提供的信息都是一致的，足以进行严格的推导。因此，我们开始求解。\n\n在谐振近似中，晶格的动力学由以下线性二阶微分方程组控制：\n$$M\\,\\ddot{u}(t)=-\\Phi\\,u(t)$$\n其中 $M$ 是对角质量矩阵，$\\Phi$ 是力常数矩阵，$u(t)$ 是原子位移向量。我们寻求形式为 $u(t)=\\Re\\{U\\exp(-\\mathrm{i}\\,\\omega t)\\}$ 的简正模解，其中 $U$ 是一个与时间无关的振幅向量，$\\omega$ 是角频率。将此拟设代入运动方程，得到广义特征值问题：\n$$\\Phi\\,U = \\omega^2 M\\,U$$\n该方程的解提供了原始晶体的一组简正模频率 $\\{\\omega_j\\}$。\n\n该问题可以被重构为一个标准的特征值问题。由于质量矩阵 $M$ 是对角的且正定的，其逆矩阵 $M^{-1}$ 存在。从左侧乘以 $M^{-1}$，我们得到：\n$$ M^{-1}\\Phi\\,U = \\omega^2 U $$\n因此，频率的平方 $\\omega_j^2$ 是动力学矩阵 $D = M^{-1}\\Phi$ 的特征值。\n\n现在，考虑均匀同位素替换，其中每个原子质量都按因子 $\\alpha > 0$ 进行缩放。新的质量矩阵是 $M' = \\alpha M$。力常数矩阵 $\\Phi$ 被说明保持不变，因为它取决于原子间的电子相互作用，而非原子核质量。新的运动方程为 $M'\\,\\ddot{u}'(t)=-\\Phi\\,u'(t)$，这导致了针对新频率 $\\omega'$ 和新振幅 $U'$ 的一个新的特征值问题：\n$$\\Phi\\,U' = (\\omega')^2 M'\\,U'$$\n代入 $M' = \\alpha M$，我们有：\n$$\\Phi\\,U' = (\\omega')^2 (\\alpha M)\\,U'$$\n我们可以再次将其转化为一个标准的特征值问题，方法是从左侧乘以 $(M')^{-1} = (\\alpha M)^{-1} = \\frac{1}{\\alpha} M^{-1}$：\n$$ (M')^{-1}\\Phi\\,U' = (\\omega')^2 U' $$\n$$ \\frac{1}{\\alpha} M^{-1}\\Phi\\,U' = (\\omega')^2 U' $$\n设原始动力学矩阵 $D = M^{-1}\\Phi$ 的特征值为 $\\{\\lambda_j = \\omega_j^2\\}$，对应的特征向量为 $\\{U_j\\}$。新的动力学矩阵是 $D' = \\frac{1}{\\alpha} D$。如果一个矩阵乘以一个标量，它的特征值也乘以相同的标量，而其特征向量保持不变。因此，新的特征向量与旧的相同，$U'_j = U_j$，新的特征值 $(\\omega'_j)^2$ 与旧的特征值 $\\omega_j^2$ 的关系为：\n$$ (\\omega'_j)^2 = \\frac{1}{\\alpha} \\omega_j^2 $$\n由于频率被定义为非负的（$\\omega_j \\ge 0$ 且 $\\omega'_j \\ge 0$），我们可以对两边取正平方根：\n$$ \\omega'_j = \\frac{1}{\\sqrt{\\alpha}} \\omega_j $$\n这是任何单个声子频率的变换规律。整个频谱按因子 $1/\\sqrt{\\alpha}$ 进行缩放。\n\n接下来，我们必须确定声子态密度 $g(\\omega)$ 的变换。函数 $g(\\omega)$ 的定义使得 $g(\\omega)d\\omega$ 是频率处于无穷小区间 $[\\omega, \\omega+d\\omega]$ 内的简正模的数量。对于一个给定的晶体结构，模式总数是一个常数，由 $\\int_0^\\infty g(\\omega)d\\omega$ 给出。\n\n设 $g_{\\mathrm{old}}(\\omega)$ 是原始晶体的态密度，$g_{\\mathrm{new}}(\\omega)$ 是同位素替换后晶体的态密度。考虑原始系统中的一个无穷小频率区间 $[\\omega, \\omega+d\\omega]$。此区间内的模式数量 $dN$ 为：\n$$ dN = g_{\\mathrm{old}}(\\omega)\\,d\\omega $$\n在质量标度变换下，这些相同的模式其频率会发生移动。一个原始频率为 $\\omega$ 的模式现在的频率将是 $\\omega' = \\omega/\\sqrt{\\alpha}$。因此，原来在区间 $[\\omega, \\omega+d\\omega]$ 中的模式现在将占据新的频率区间 $[\\omega', \\omega'+d\\omega']$，其中：\n$$ \\omega' = \\frac{\\omega}{\\sqrt{\\alpha}} \\quad \\text{和} \\quad \\omega'+d\\omega' = \\frac{\\omega+d\\omega}{\\sqrt{\\alpha}} $$\n这个新区间的宽度是 $d\\omega' = d\\omega/\\sqrt{\\alpha}$。\n\n在新区间 $[\\omega', \\omega'+d\\omega']$ 内的模式数量由 $g_{\\mathrm{new}}(\\omega')d\\omega'$ 给出。因为我们考虑的是完全相同的物理模式集，所以它们的数量必须是守恒的。因此：\n$$ g_{\\mathrm{old}}(\\omega)\\,d\\omega = g_{\\mathrm{new}}(\\omega')\\,d\\omega' $$\n根据这个等式，我们可以表示出 $g_{\\mathrm{new}}(\\omega')$：\n$$ g_{\\mathrm{new}}(\\omega') = g_{\\mathrm{old}}(\\omega) \\frac{d\\omega}{d\\omega'} $$\n为了完成这个表达式，我们必须将右边完全用新的频率变量 $\\omega'$ 来表示。从频率变换 $\\omega' = \\omega/\\sqrt{\\alpha}$，我们有 $\\omega = \\omega'\\sqrt{\\alpha}$。将 $\\omega$ 对 $\\omega'$ 求导，得到变换的雅可比：\n$$ \\frac{d\\omega}{d\\omega'} = \\sqrt{\\alpha} $$\n将 $\\omega = \\omega'\\sqrt{\\alpha}$ 和 $d\\omega/d\\omega' = \\sqrt{\\alpha}$ 同时代入 $g_{\\mathrm{new}}(\\omega')$ 的表达式中，得到：\n$$ g_{\\mathrm{new}}(\\omega') = g_{\\mathrm{old}}(\\omega'\\sqrt{\\alpha}) \\sqrt{\\alpha} $$\n最后一步是用 $\\omega$ 替换哑变量 $\\omega'$，以将新的态密度表示为 $\\omega$ 的函数。这就给出了声子态密度的最终变换法则：\n$$ g_{\\mathrm{new}}(\\omega) = \\sqrt{\\alpha} \\, g_{\\mathrm{old}}(\\omega\\sqrt{\\alpha}) $$\n这个结果正确地反映了：如果质量增加（$\\alpha > 1$），频率会降低，而态密度的数值必须增加并沿频率轴被压缩，以保持总态数守恒。相反，如果质量减少（$0 < \\alpha < 1$），频率会增加，而态密度的数值会减小并沿频率轴被拉伸。推导完成。", "answer": "$$\n\\boxed{\\sqrt{\\alpha} \\, g_{\\mathrm{old}}(\\omega\\sqrt{\\alpha})}\n$$", "id": "2847832"}, {"introduction": "从分析到设计，这最后一个练习将让您扮演材料设计者的角色。您将应用晶格动力学原理，设计一个具有特定带隙的一维声子晶体——一个声子无法在其中传播的频率范围。这个计算练习将基础理论与现代材料工程联系起来，要求您计算态密度和透射谱，以验证您的设计是否达到了目标性能。[@problem_id:2847795]", "problem": "您必须根据晶格动力学的第一性原理，设计并验证一个一维周期性声子晶体。考虑一个中心对称的双原子晶胞，其包含两个相同的点质量，在每个晶胞内由两个不同的最近邻线性弹簧串联（弹簧常数交替变化），这通常被称为二聚化单原子链。其物理模型为：一条无限长的点质量链，质量为 $m$ 的点质量位于直线上，点间距为晶格常数 $a$，胞内和胞间的最近邻耦合由两个沿链交替排列的不同弹簧常数 $K_{1}$ 和 $K_{2}$ 给出。假设无阻尼谐波运动，并应用 Newton 第二定律和 Bloch 定理来建立晶格振动的本征值问题。使用声子态密度 (DOS) $g(\\omega)$ 的定义，即对每个晶胞的本征频率处的 Dirac delta 函数对波矢的求和，并通过 Brillouin 区采样和高斯展宽对其进行数值近似。使用是否存在实数 Bloch 波矢作为区分传播解与倏逝解的判据。\n\n设计任务：\n- 给定目标角频率 $\\omega_{0}$、固定质量 $m$、晶格常数 $a$ 以及由 $r = K_{1}/K_{2}$ 定义的指定弹簧常数比 $r$，选择弹簧常数 $K_{1}$ 和 $K_{2}$，使得无限周期链的基带隙以 $\\omega_{0}$ 为中心。您必须从第一性原理出发，确定如何将带隙中心与模型参数关联起来。\n- 对于由 $N$ 个晶胞组成的有限链段，在给定角频率 $\\omega$ 下定义一个近似的透射度量：当不存在实数 Bloch 波矢时（倏逝区），使用复数 Bloch 波矢 $\\kappa$；当存在实数 Bloch 波矢时（传播区），使用单位 1。在倏逝区中，将跨越 $N$ 个晶胞的衰减建模为振幅的指数衰减，并将透射率定义为 $\\exp(-2 \\kappa N a)$。您必须通过对 Bloch 波矢进行解析延拓，从色散关系中获得 $\\kappa$。\n\n验证要求：\n- 通过对第一 Brillouin 区进行采样并应用给定标准差 $\\sigma$（单位为 $\\mathrm{rad/s}$）的高斯展宽，数值近似计算每个晶胞的声子态密度 $g(\\omega)$。计算 $g(\\omega_{0})$ 以检验其在目标带隙中心附近是否受到强烈抑制。将 $g(\\omega_{0})$ 以 $\\mathrm{s}$（即 $\\mathrm{(rad/s)}^{-1}$）为单位表示，每个晶胞。\n- 确定无限链的声学支上边缘和光学支下边缘，并以 $\\mathrm{rad/s}$ 为单位报告它们的角频率。仅使用从控制方程进行的推导；不得在没有推导的情况下引用任何简化的“教科书式”带边公式。\n- 按照上述描述，计算由 $N$ 个晶胞组成的有限链在 $\\omega_{0}$ 处的近似透射率，并报告其无量纲值 $T(\\omega_{0})$。\n\n$\\omega_{0}$ 处设计成功的接受准则：\n- 目标频率严格位于声学带顶和光学带底之间（存在非零带隙），\n- 数值估算的 $g(\\omega_{0})$ 小于指定阈值，\n- 透射率 $T(\\omega_{0})$ 小于指定阈值。\n\n您的程序必须为每个测试用例生成以下结果元组：\n- $[K_{1},K_{2},\\omega_{\\mathrm{ac,max}},\\omega_{\\mathrm{op,min}},g(\\omega_{0}),T(\\omega_{0}),\\text{success}]$，\n其中 $K_{1}$ 和 $K_{2}$ 的单位是 $\\mathrm{N/m}$，$\\omega_{\\mathrm{ac,max}}$ 和 $\\omega_{\\mathrm{op,min}}$ 的单位是 $\\mathrm{rad/s}$，$g(\\omega_{0})$ 的单位是 $\\mathrm{s}$，$T(\\omega_{0})$ 是无量纲的，而 $\\text{success}$ 是一个布尔值。\n\n数值说明和约束：\n- Brillouin 区采样必须在一个不可约区间内对 $k$ 均匀进行，并且在计算 $g(\\omega)$ 时必须包括两个声子支；使用宽度为 $\\sigma$（每个测试提供）的高斯展宽来近似 Dirac delta 函数。角度以弧度表示。\n- 在评估 $\\omega_{0}$ 处的透射率时，通过 Bloch 波矢对传播进行分类：如果 Bloch 波数在 $\\omega_{0}$ 处为实数，则设 $T(\\omega_{0})=1$；否则，如果它是衰减常数为 $\\kappa$ 的纯虚数，则设 $T(\\omega_{0})=\\exp(-2\\kappa N a)$。\n- 使用以下接受阈值：$g(\\omega_{0})<10^{-14}\\,\\mathrm{s}$ 和 $T(\\omega_{0})<10^{-5}$。\n\n测试套件：\n提供以下三种情况的结果，每种情况指定为 $(\\omega_{0}, m, a, r, N, \\sigma)$：\n- 情况 A（正常路径，有相当大的带隙）：$(2\\pi\\times 8.0\\times 10^{12}\\,\\mathrm{rad/s},\\, 2.0\\times 10^{-26}\\,\\mathrm{kg},\\, 3.0\\times 10^{-10}\\,\\mathrm{m},\\, 2.0,\\, 50,\\, 5.0\\times 10^{11}\\,\\mathrm{rad/s})$。\n- 情况 B（边界情况，无带隙）：$(2\\pi\\times 5.0\\times 10^{12}\\,\\mathrm{rad/s},\\, 2.0\\times 10^{-26}\\,\\mathrm{kg},\\, 3.0\\times 10^{-10}\\,\\mathrm{m},\\, 1.0,\\, 50,\\, 5.0\\times 10^{11}\\,\\mathrm{rad/s})$。\n- 情况 C（窄带隙）：$(2\\pi\\times 10.0\\times 10^{12}\\,\\mathrm{rad/s},\\, 1.5\\times 10^{-26}\\,\\mathrm{kg},\\, 2.5\\times 10^{-10}\\,\\mathrm{m},\\, 1.1,\\, 80,\\, 5.0\\times 10^{11}\\,\\mathrm{rad/s})$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个逗号分隔的列表的列表形式的结果，并用方括号括起来，顺序与测试套件案例的顺序一致，例如 $[[\\dots],[\\dots],[\\dots]]$。输出中不允许包含任何额外文本。", "solution": "该问题陈述是材料物理学中一个有效且适定的问题，具体涉及一维周期结构中的晶格动力学研究。它具有科学依据，是客观的，并包含了得出唯一解所需的所有必要信息。该模型是二聚化链的标准表示，等效于具有相等质量的双原子链。设计弹簧常数以使带隙居中、计算带边、态密度和透射率等任务，都是从第一性原理推导出的标准程序。\n\n以下是必要物理量的推导过程。\n\n该模型是一条由质量为 $m$ 的相同质量块组成的一维链，其弹簧常数 $K_{1}$ 和 $K_{2}$ 交替出现。该系统具有由包含两个质量块的晶胞定义的周期性。设晶格常数，即晶胞的长度为 $a$。设第 $n$ 个晶胞中两个质量块的平衡位移分别为 $u_{n,1}$ 和 $u_{n,2}$。对谐波运动应用 Newton 第二定律，得到运动方程：\n$$m \\ddot{u}_{n,1} = -K_{1}(u_{n,1} - u_{n,2}) - K_{2}(u_{n,1} - u_{n-1,2})$$\n$$m \\ddot{u}_{n,2} = -K_{1}(u_{n,2} - u_{n,1}) - K_{2}(u_{n,2} - u_{n+1,1})$$\n\n我们应用 Bloch 定理，并寻求形式为 $u_{n,\\alpha} = U_{\\alpha} e^{i(kna - \\omega t)}$ 的平面波解，其中 $k$ 是波矢，$\\omega$ 是角频率，$U_{1}, U_{2}$ 是振幅。将此试探解代入运动方程，可得到关于振幅 $U_1, U_2$ 的线性方程组：\n$$\\left( K_{1}+K_{2} - m\\omega^2 \\right) U_1 - \\left( K_{1} + K_{2} e^{-ika} \\right) U_2 = 0$$\n$$-\\left( K_{1} + K_{2} e^{ika} \\right) U_1 + \\left( K_{1}+K_{2} - m\\omega^2 \\right) U_2 = 0$$\n\n为了得到非平庸解，系数矩阵的行列式必须为零。这得出了久期方程：\n$$\\left( K_{1}+K_{2} - m\\omega^2 \\right)^2 - \\left( K_{1} + K_{2} e^{-ika} \\right) \\left( K_{1} + K_{2} e^{ika} \\right) = 0$$\n$$\\left( K_{1}+K_{2} - m\\omega^2 \\right)^2 = K_{1}^2 + K_{2}^2 + 2K_{1}K_{2}\\cos(ka)$$\n\n求解 $m\\omega^2$ 得到色散关系 $\\omega(k)$，它有两个分支，分别对应声学声子和光学声子：\n$$\\omega_{\\pm}^2(k) = \\frac{1}{m} \\left( K_{1}+K_{2} \\pm \\sqrt{K_{1}^2 + K_{2}^2 + 2K_{1}K_{2}\\cos(ka)} \\right)$$\n“$-$”号对应低频的声学支，“$+$”号对应高频的光学支。\n\n带边位于第一 Brillouin 区的边界处，即 $k=0$（区中心）和 $k=\\pi/a$（区边界）。\n当 $k=0$ 时, $\\cos(ka)=1$:\n$\\omega_{-}^2(0) = \\frac{1}{m}(K_{1}+K_{2} - \\sqrt{(K_{1}+K_{2})^2}) = 0$。\n$\\omega_{+}^2(0) = \\frac{1}{m}(K_{1}+K_{2} + \\sqrt{(K_{1}+K_{2})^2}) = \\frac{2(K_{1}+K_{2})}{m}$。\n\n当 $k=\\pi/a$ 时, $\\cos(ka)=-1$:\n$\\omega_{-}^2(\\pi/a) = \\frac{1}{m}(K_{1}+K_{2} - \\sqrt{(K_{1}-K_{2})^2}) = \\frac{1}{m}(K_{1}+K_{2} - |K_{1}-K_{2}|) = \\frac{2\\min(K_{1},K_{2})}{m}$。\n$\\omega_{+}^2(\\pi/a) = \\frac{1}{m}(K_{1}+K_{2} + \\sqrt{(K_{1}-K_{2})^2}) = \\frac{1}{m}(K_{1}+K_{2} + |K_{1}-K_{2}|) = \\frac{2\\max(K_{1},K_{2})}{m}$。\n\n声学支的顶部为 $\\omega_{\\mathrm{ac,max}} = \\sqrt{2\\min(K_{1},K_{2})/m}$，光学支的底部为 $\\omega_{\\mathrm{op,min}} = \\sqrt{2\\max(K_{1},K_{2})/m}$。如果 $K_{1} \\neq K_{2}$，则在这两个频率之间存在声子带隙。\n\n设计任务要求选择 $K_{1}$ 和 $K_{2}$ 以将带隙中心置于给定频率 $\\omega_{0}$。为了代数上的简化，我们在 $\\omega^2$ 域中解释“居中”，这对应于带边频率平方的算术平均值：$\\omega_{0}^2 = \\frac{1}{2}(\\omega_{\\mathrm{ac,max}}^2 + \\omega_{\\mathrm{op,min}}^2) = \\frac{K_{1}+K_{2}}{m}$。利用给定的比率 $r=K_{1}/K_{2}$，我们求解以下两个方程组：\n$K_{1}+K_{2} = m\\omega_{0}^2$\n$K_{1}=rK_{2}$\n这就得出了弹簧常数的设计方程：\n$$K_{2} = \\frac{m\\omega_{0}^2}{r+1}, \\quad K_{1} = \\frac{rm\\omega_{0}^2}{r+1}$$\n\n每个晶胞的声子态密度 (DOS) $g(\\omega)$ 是单位频率内的模式数。它是通过对所有波矢和声子支求和来计算的。在数值上，我们用 $N_k$ 个点对不可约 Brillouin 区（$k \\in [0, \\pi/a]$）进行采样，并使用高斯展宽来近似 Dirac delta 函数：\n$$g(\\omega) = \\frac{1}{N_k}\\sum_{i=1}^{N_k} \\sum_{j \\in \\{-,+\\}} \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(\\omega-\\omega_{j}(k_i))^2}{2\\sigma^2}\\right)$$\n该表达式是归一化的，因此其对所有频率的积分等于 2，即每个晶胞的分支数。\n\n对于带隙内的频率，波矢 $k$ 变为复数 $k=q+i\\kappa$，表示倏逝波。从色散关系中，我们可以求解 $\\cos(ka)$：\n$$\\cos(ka) = \\frac{(m\\omega^2 - K_{1} - K_{2})^2 - K_{1}^2 - K_{2}^2}{2K_{1}K_{2}}$$\n只有当 $|\\cos(ka)| \\le 1$ 时，传播模式才存在。如果 $|\\cos(ka)| > 1$，波是倏逝的。$k$ 的复数性质要求 $\\sin(qa)=0$，因此 $q=0$ 或 $q=\\pi/a$。由于带隙在 $k=\\pi/a$ 处打开，我们取 $q=\\pi/a$，这导致 $\\cos(ka) = -\\cosh(\\kappa a)$。\n\n在目标设计频率 $\\omega_0$ 处，其中 $m\\omega_0^2 = K_1+K_2$，该条件变为：\n$$-\\cosh(\\kappa_0 a) = \\frac{-(K_1^2+K_2^2)}{2K_1K_2} \\implies \\cosh(\\kappa_0 a) = \\frac{K_1^2+K_2^2}{2K_1K_2} = \\frac{r^2+1}{2r}$$\n使用恒等式 $\\mathrm{arccosh}(x) = \\ln(x+\\sqrt{x^2-1})$，我们得到了一个简洁的结果 $\\kappa_0 a = |\\ln r|$。衰减常数为 $\\kappa_0 = \\frac{|\\ln r|}{a}$。\n通过 $N$ 个晶胞的透射率 $T$ 由 $T(\\omega_0) = \\exp(-2\\kappa_{0} N a)$ 给出。代入 $\\kappa_0$ 得：\n$$T(\\omega_0) = \\exp(-2N|\\ln r|)$$\n如果 $r=1$，则没有带隙，$\\kappa_0 = 0$，模式是传播的；根据定义，$T(\\omega_0)=1$。\n\n设计的成功与否通过三个准则进行评估：\n1. 目标频率 $\\omega_0$ 严格位于带隙内：$\\omega_{\\mathrm{ac,max}} < \\omega_0 < \\omega_{\\mathrm{op,min}}$。这等效于条件 $r \\ne 1$。\n2. 目标频率处的态密度低于阈值：$g(\\omega_0) < 10^{-14}\\,\\mathrm{s}$。\n3. 目标频率处的透射率低于阈值：$T(\\omega_0) < 10^{-5}$。\n\n具体的实现将遵循这些推导出的公式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the phononic crystal design and verification problem.\n    \"\"\"\n    # Test cases: (omega0, m, a, r, N, sigma)\n    # omega0 in rad/s, m in kg, a in m, r dimensionless, N dimensionless, sigma in rad/s\n    test_cases = [\n        # Case A: Happy path, sizable gap\n        (2 * np.pi * 8.0e12, 2.0e-26, 3.0e-10, 2.0, 50, 5.0e11),\n        # Case B: Boundary case, no gap\n        (2 * np.pi * 5.0e12, 2.0e-26, 3.0e-10, 1.0, 50, 5.0e11),\n        # Case C: Narrow gap\n        (2 * np.pi * 10.0e12, 1.5e-26, 2.5e-10, 1.1, 80, 5.0e11),\n    ]\n\n    results = []\n    \n    # Number of k-points for Brillouin zone sampling\n    N_k = 20000\n\n    for case in test_cases:\n        omega0, m, a, r, N, sigma = case\n\n        # 1. Calculate spring constants K1 and K2 from design specifications\n        # The band gap is centered at omega0^2, meaning omega0^2 = (K1+K2)/m.\n        # The spring constant ratio is r = K1/K2.\n        K2 = m * omega0**2 / (r + 1)\n        K1 = r * K2\n\n        # 2. Determine the band edge frequencies\n        # The band gap opens at the Brillouin zone edge k = pi/a.\n        # omega_ac_max^2 = 2 * min(K1, K2) / m\n        # omega_op_min^2 = 2 * max(K1, K2) / m\n        K_min = min(K1, K2)\n        K_max = max(K1, K2)\n        \n        omega_ac_max = np.sqrt(2 * K_min / m)\n        omega_op_min = np.sqrt(2 * K_max / m)\n\n        # 3. Numerically approximate the phonon density of states g(omega0)\n        # We sample k uniformly over the irreducible Brillouin zone [0, pi/a].\n        k_values = np.linspace(0, np.pi / a, N_k)\n\n        # Dispersion relation: omega^2(k) = (1/m) * (K1+K2 +/- sqrt(K1^2+K2^2+2*K1*K2*cos(ka)))\n        cos_ka = np.cos(k_values * a)\n        # The term under the square root is always non-negative for real k.\n        sqrt_term = np.sqrt(K1**2 + K2**2 + 2 * K1 * K2 * cos_ka)\n        \n        omega_sq_plus = (1 / m) * (K1 + K2 + sqrt_term)\n        omega_sq_minus = (1 / m) * (K1 + K2 - sqrt_term)\n\n        # Handle potential floating point inaccuracies leading to small negative values\n        omega_plus = np.sqrt(np.maximum(0, omega_sq_plus))\n        omega_minus = np.sqrt(np.maximum(0, omega_sq_minus))\n\n        # Approximate DOS using Gaussian broadening\n        # g(w) = (1/Nk) * sum_{k,branch} (1/(sqrt(2pi)*sigma)) * exp(-(w-w_k,branch)^2 / (2*sigma^2))\n        gauss_contrib_plus = np.exp(-((omega0 - omega_plus)**2) / (2 * sigma**2))\n        gauss_contrib_minus = np.exp(-((omega0 - omega_minus)**2) / (2 * sigma**2))\n        \n        g_omega0 = np.sum(gauss_contrib_plus + gauss_contrib_minus) / (N_k * np.sqrt(2 * np.pi) * sigma)\n        \n        # 4. Compute the approximate transmission T(omega0)\n        # If r=1, no band gap exists. omega0 lies on a propagating band.\n        if np.isclose(r, 1.0):\n            T_omega0 = 1.0\n        else:\n            # If r!=1, a gap exists and omega0 is within it. The wave is evanescent.\n            # The decay constant kappa is derived from kappa*a = |ln(r)|.\n            # T = exp(-2 * kappa * N * a) = exp(-2 * N * |ln(r)|).\n            T_omega0 = np.exp(-2 * N * np.abs(np.log(r)))\n\n        # 5. Verify the design against acceptance criteria\n        g_threshold = 1.0e-14\n        T_threshold = 1.0e-5\n        \n        # Criterion 1: omega0 must be strictly inside the band gap.\n        gap_condition = (omega0 > omega_ac_max) and (omega0 < omega_op_min)\n        \n        # Criterion 2: DOS at omega0 must be below the threshold.\n        dos_condition = g_omega0 < g_threshold\n\n        # Criterion 3: Transmission at omega0 must be below the threshold.\n        transmission_condition = T_omega0 < T_threshold\n        \n        success = gap_condition and dos_condition and transmission_condition\n\n        # 6. Collate results into the required format\n        results.append([\n            K1, \n            K2, \n            omega_ac_max, \n            omega_op_min, \n            g_omega0, \n            T_omega0, \n            bool(success)\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2847795"}]}