{"hands_on_practices": [{"introduction": "这个练习提供了一个具体的例子，说明如何从微观散射模型推导出玻尔兹曼输运方程中的关键参数——输运弛豫时间。我们将使用费米黄金定则来处理杂质散射，并看到动量衰减因子 $(1-\\cos\\theta)$ 是如何自然出现的，最终得到著名的 Brooks-Herring 公式。这项实践对于将抽象的玻尔兹曼方程与具体的材料属性联系起来至关重要。[@problem_id:2803304]", "problem": "考虑某晶体固体中具有色散关系 $\\,\\varepsilon_{\\mathbf{k}} = \\hbar^{2} k^{2} / (2m)\\,$ 的各向同性、抛物线能带电子气，及其在绝对零度下半径为 $\\,k_{F}\\,$ 的球形费米面。弹性散射由电荷为 $\\,Z e\\,$、浓度为 $\\,n_{i}\\,$ 的稀疏静态电离杂质引起。在玻恩近似下，波矢 $\\,\\mathbf{k}\\,$ 与 $\\,\\mathbf{k}'\\,$ 之间的跃迁概率由以下模型给出\n$$\nW_{\\mathbf{k}\\mathbf{k}'} \\;=\\; \\frac{2\\pi}{\\hbar}\\,n_{i}\\,\\big|V(\\mathbf{k}-\\mathbf{k}')\\big|^{2}\\,\\delta\\!\\big(\\varepsilon_{\\mathbf{k}}-\\varepsilon_{\\mathbf{k}'}\\big),\n$$\n其中杂质势是静态屏蔽的（托马斯-费米屏蔽），其傅里叶变换为\n$$\nV(\\mathbf{q}) \\;=\\; \\frac{4\\pi Z e^{2}}{\\varepsilon\\,(q^{2}+\\kappa^{2})},\n$$\n其中 $\\,\\varepsilon\\,$ 是背景介电常数，$\\,\\kappa\\,$ 是屏蔽波矢。从稳态、空间均匀的玻尔兹曼输运方程 (BTE) 和费米黄金定则出发，并使用包含动量衰减因子 $\\,\\big(1-\\cos\\theta\\big)\\,$（其中 $\\,\\theta\\,$ 是 $\\,\\mathbf{k}\\,$ 与 $\\,\\mathbf{k}'\\,$ 之间的散射角）的输运弛豫率定义，推导在三维空间中费米面上的杂质限制输运弛豫率 $\\,1/\\tau_{\\mathrm{tr}}(k_{F})\\,$ 的精确闭合形式表达式。请用 $\\,m\\,$, $\\,\\hbar\\,$, $\\,k_{F}\\,$, $\\,n_{i}\\,$, $\\,Z\\,$, $\\,e\\,$, $\\,\\varepsilon\\,$, 和 $\\,\\kappa\\,$ 将您的最终答案表示为单个解析表达式。请勿代入数值。最终结果必须以一个闭合形式表达式给出。无需四舍五入。", "solution": "该问题陈述在科学上是合理的、提法得当且客观。它代表了凝聚态物理学中关于电子输运理论的一个标准范式问题。所提供的所有信息都充分、一致，并且没有任何科学或逻辑上的瑕疵。因此，将提供解答。\n\n目标是推导费米面上电子的输运弛豫率 $1/\\tau_{\\mathrm{tr}}$。该弛豫率定义为从态 $\\mathbf{k}$ 散射到任何其他态 $\\mathbf{k}'$ 的总概率，并由因子 $(1-\\cos\\theta)$ 加权，该因子解释了沿初始方向的动量衰减。此处，$\\theta$ 是初始波矢 $\\mathbf{k}$ 和末态波矢 $\\mathbf{k}'$ 之间的夹角。其定义由下式给出\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(\\mathbf{k})} = \\sum_{\\mathbf{k}'} W_{\\mathbf{k}\\mathbf{k}'} (1 - \\cos\\theta)\n$$\n其中 $W_{\\mathbf{k}\\mathbf{k}'}$ 是从态 $\\mathbf{k}$ 到态 $\\mathbf{k}'$ 的单位时间跃迁概率。在热力学极限下，对离散态 $\\mathbf{k}'$ 的求和被替换为在 $\\mathbf{k}'$ 空间上的积分，单位体积的态密度为 $1/(2\\pi)^3$。\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(\\mathbf{k})} = \\int \\frac{d^3k'}{(2\\pi)^3} W_{\\mathbf{k}\\mathbf{k}'} (1 - \\cos\\theta)\n$$\n我们已知在玻恩近似下，根据费米黄金定则得到的跃迁概率为：\n$$\nW_{\\mathbf{k}\\mathbf{k}'} = \\frac{2\\pi}{\\hbar} n_{i} |V(\\mathbf{k}-\\mathbf{k}')|^2 \\delta(\\varepsilon_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}'})\n$$\n将此代入弛豫率的表达式中可得：\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(\\mathbf{k})} = \\int \\frac{d^3k'}{(2\\pi)^3} \\frac{2\\pi n_{i}}{\\hbar} |V(\\mathbf{q})|^2 \\delta(\\varepsilon_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}'}) (1 - \\cos\\theta),\n$$\n其中动量转移为 $\\mathbf{q} = \\mathbf{k} - \\mathbf{k}'$。简化常数前置因子可得：\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(\\mathbf{k})} = \\frac{n_{i}}{4\\pi^2 \\hbar} \\int d^3k' |V(\\mathbf{q})|^2 \\delta(\\varepsilon_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}'}) (1 - \\cos\\theta)\n$$\n为了计算该积分，我们对 $\\mathbf{k}'$ 使用球坐标，并选择 $\\mathbf{k}$ 的方向作为极轴。因此，$d^3k' = k'^2 dk' d\\Omega = k'^2 \\sin\\theta dk' d\\theta d\\phi$。体积元中的角 $\\theta$ 与散射角相同。由于被积函数具有柱对称性，对从 $0$ 到 $2\\pi$ 的方位角 $\\phi$ 的积分得到一个因子 $2\\pi$。\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(\\mathbf{k})} = \\frac{2\\pi n_{i}}{4\\pi^2 \\hbar} \\int_0^\\infty k'^2 dk' \\int_0^\\pi \\sin\\theta d\\theta \\, |V(\\mathbf{q})|^2 \\delta(\\varepsilon_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}'}) (1 - \\cos\\theta)\n$$\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(\\mathbf{k})} = \\frac{n_{i}}{2\\pi \\hbar} \\int_0^\\infty k'^2 dk' \\int_0^\\pi |V(\\mathbf{q})|^2 \\delta(\\varepsilon_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}'}) (1 - \\cos\\theta) \\sin\\theta d\\theta\n$$\n狄拉克δ函数强制能量守恒。对于抛物线能带 $\\varepsilon_k = \\hbar^2 k^2 / (2m)$，δ函数的自变量为 $\\varepsilon_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}'} = \\frac{\\hbar^2}{2m}(k^2 - k'^2)$。我们使用性质 $\\delta(g(x)) = \\sum_{i} \\frac{\\delta(x-x_i)}{|g'(x_i)|}$。此处，$g(k') = \\frac{\\hbar^2}{2m}(k^2 - k'^2)$，其在 $k'>0$ 时的根为 $k'=k$。其导数为 $g'(k') = -\\frac{\\hbar^2 k'}{m}$，所以 $|g'(k)| = \\frac{\\hbar^2 k}{m}$。因此，\n$$\n\\delta(\\varepsilon_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}'}) = \\frac{m}{\\hbar^2 k} \\delta(k' - k)\n$$\n将此代入我们的积分中，就可以对 $k'$ 进行积分：\n$$\n\\int_0^\\infty k'^2 \\delta(\\varepsilon_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}'}) dk' = \\int_0^\\infty k'^2 \\frac{m}{\\hbar^2 k} \\delta(k' - k) dk' = k^2 \\frac{m}{\\hbar^2 k} = \\frac{mk}{\\hbar^2}\n$$\n现在，弛豫率的表达式变成一个只关于散射角 $\\theta$ 的积分：\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(k)} = \\frac{n_{i}}{2\\pi \\hbar} \\left( \\frac{mk}{\\hbar^2} \\right) \\int_0^\\pi |V(\\mathbf{q})|^2 (1 - \\cos\\theta) \\sin\\theta d\\theta\n$$\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(k)} = \\frac{n_{i} m k}{2\\pi \\hbar^3} \\int_0^\\pi |V(\\mathbf{q})|^2 (1 - \\cos\\theta) \\sin\\theta d\\theta\n$$\n动量转移大小的平方是 $q^2 = |\\mathbf{k} - \\mathbf{k}'|^2 = k^2 + k'^2 - 2\\mathbf{k}\\cdot\\mathbf{k}'$。由于散射是弹性的，$k'=k$，所以 $q^2 = 2k^2(1 - \\cos\\theta)$。\n屏蔽势的傅里叶变换为 $V(q) = \\frac{4\\pi Z e^2}{\\varepsilon (q^2 + \\kappa^2)}$。其平方为：\n$$\n|V(\\mathbf{q})|^2 = \\left( \\frac{4\\pi Z e^2}{\\varepsilon} \\right)^2 \\frac{1}{(q^2 + \\kappa^2)^2} = \\frac{16\\pi^2 Z^2 e^4}{\\varepsilon^2} \\frac{1}{(2k^2(1 - \\cos\\theta) + \\kappa^2)^2}\n$$\n将此代入弛豫率的积分中：\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(k)} = \\frac{n_{i} m k}{2\\pi \\hbar^3} \\frac{16\\pi^2 Z^2 e^4}{\\varepsilon^2} \\int_0^\\pi \\frac{(1 - \\cos\\theta)\\sin\\theta}{(2k^2(1 - \\cos\\theta) + \\kappa^2)^2} d\\theta\n$$\n我们来计算这个积分。我们进行换元，令 $x = 1 - \\cos\\theta$。那么 $dx = \\sin\\theta d\\theta$。积分上下限从 $\\theta \\in [0, \\pi]$ 变为 $x \\in [0, 2]$。\n$$\nI = \\int_0^2 \\frac{x}{(2k^2 x + \\kappa^2)^2} dx\n$$\n该积分可以通过进一步换元 $y = 2k^2 x + \\kappa^2$ 来求解，这意味着 $dy = 2k^2 dx$ 并且 $x = (y-\\kappa^2)/(2k^2)$。积分上下限变为 $y \\in [\\kappa^2, 4k^2 + \\kappa^2]$。\n$$\nI = \\int_{\\kappa^2}^{4k^2+\\kappa^2} \\frac{(y-\\kappa^2)/(2k^2)}{y^2} \\frac{dy}{2k^2} = \\frac{1}{4k^4} \\int_{\\kappa^2}^{4k^2+\\kappa^2} \\left( \\frac{1}{y} - \\frac{\\kappa^2}{y^2} \\right) dy\n$$\n$$\nI = \\frac{1}{4k^4} \\left[ \\ln|y| + \\frac{\\kappa^2}{y} \\right]_{\\kappa^2}^{4k^2+\\kappa^2} = \\frac{1}{4k^4} \\left\\{ \\left( \\ln(4k^2+\\kappa^2) + \\frac{\\kappa^2}{4k^2+\\kappa^2} \\right) - \\left( \\ln(\\kappa^2) + \\frac{\\kappa^2}{\\kappa^2} \\right) \\right\\}\n$$\n$$\nI = \\frac{1}{4k^4} \\left\\{ \\ln\\left(\\frac{4k^2+\\kappa^2}{\\kappa^2}\\right) + \\frac{\\kappa^2 - (4k^2+\\kappa^2)}{4k^2+\\kappa^2} \\right\\} = \\frac{1}{4k^4} \\left\\{ \\ln\\left(1 + \\frac{4k^2}{\\kappa^2}\\right) - \\frac{4k^2}{4k^2+\\kappa^2} \\right\\}\n$$\n现在，我们将所有部分组合起来。前置因子为 $\\frac{n_{i} m k}{2\\pi \\hbar^3} \\frac{16\\pi^2 Z^2 e^4}{\\varepsilon^2} = \\frac{8\\pi n_{i} m k Z^2 e^4}{\\hbar^3 \\varepsilon^2}$。\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(k)} = \\frac{8\\pi n_{i} m k Z^2 e^4}{\\hbar^3 \\varepsilon^2} \\times \\frac{1}{4k^4} \\left[ \\ln\\left(1 + \\frac{4k^2}{\\kappa^2}\\right) - \\frac{4k^2}{4k^2+\\kappa^2} \\right]\n$$\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(k)} = \\frac{2\\pi n_{i} m Z^2 e^4}{\\hbar^3 \\varepsilon^2 k^3} \\left[ \\ln\\left(1 + \\frac{4k^2}{\\kappa^2}\\right) - \\frac{4k^2}{4k^2+\\kappa^2} \\right]\n$$\n问题要求的是费米面上的弛豫率，所以我们计算该表达式在 $k = k_F$ 时的值：\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(k_F)} = \\frac{2\\pi n_{i} m Z^2 e^4}{\\hbar^3 \\varepsilon^2 k_F^3} \\left[ \\ln\\left(1 + \\frac{4k_F^2}{\\kappa^2}\\right) - \\frac{4k_F^2}{4k_F^2+\\kappa^2} \\right]\n$$\n这就是费米面上杂质限制的输运弛豫率的最终闭合形式表达式，通常被称为Brooks-Herring公式。", "answer": "$$\n\\boxed{\\frac{2 \\pi n_{i} m Z^{2} e^{4}}{\\hbar^{3} \\varepsilon^{2} k_{F}^{3}} \\left[ \\ln\\left(1 + \\frac{4 k_{F}^{2}}{\\kappa^{2}}\\right) - \\frac{4 k_{F}^{2}}{4 k_{F}^{2} + \\kappa^{2}} \\right]}\n$$", "id": "2803304"}, {"introduction": "弛豫时间近似(RTA)功能强大，但也有其局限性。本练习探讨了一个前向散射占主导的场景，在这种情况下，使用总散射率的 RTA 会得出完全错误的结论。通过将玻尔兹曼方程作为一个积分方程来求解，你将理解总散射率和输运散射率之间的关键区别，并阐明为何小角度散射对于衰减电流效率低下。[@problem_id:2803361]", "problem": "考虑一个三维晶体，其具有能量色散关系为 $\\varepsilon_{\\mathbf{k}} = \\hbar^{2} k^{2} / (2 m^{\\ast})$ 的单一各向同性抛物线能带。系统处于低温下，因此只有费米能量处的电子态对输运有贡献，并施加一个均匀静态电场 $\\mathbf{E} = E \\hat{\\mathbf{z}}$。假设由静态无序引起的散射是弹性的、无自旋的，且在空间上是统计各向同性的，因此从方向为 $\\hat{\\mathbf{k}}$ 的态散射到 $\\hat{\\mathbf{k}}'$ 的态的单位立体角微分散射率仅取决于它们之间的散射角 $\\gamma$。\n\n对微分散射核采用以下前向峰化玩具模型：\n$$\nW(\\gamma) \\equiv W(\\cos\\gamma) \\;=\\; A \\,\\frac{1 - g^{2}}{\\left(1 + g^{2} - 2 g \\cos\\gamma\\right)^{3/2}},\n$$\n其中 $A > 0$ 是一个常数，单位为“速率/立体角”，$0 \\le g < 1$ 控制前向峰化的特性（$g$ 越大，前向峰化越显著）。\n\n在稳态、空间均匀、线性响应区中进行分析，并围绕费米-狄拉克平衡态 $f_{0}(\\varepsilon)$ 线性化玻尔兹曼输运方程。将非平衡修正项记为 $f_{1}(\\mathbf{k})$，且 $|f_{1}| \\ll 1$。不要为碰撞积分预先假设任何弛豫时间形式。\n\n仅利用球形费米面上弹性、角度依赖散射的线性化碰撞算符的结构，并且不使用任何输运捷径公式，完成以下步骤：\n\n1. 推导控制费米面上 $f_{1}(\\hat{\\mathbf{k}})$ 角度依赖性的标量积分方程。证明对于沿 $\\hat{\\mathbf{z}}$ 方向的电场，解可取为与 $\\cos\\theta$ 成正比，其中 $\\theta$ 是 $\\hat{\\mathbf{k}}$ 相对于 $\\hat{\\mathbf{z}}$ 的极角，并将碰撞算符的相应本征值确定为一个关于 $W(\\gamma)$ 的角积分。\n\n2. 定义从该完整散射解得到的精确电导率 $\\sigma_{\\mathrm{full}}$（沿 $\\hat{\\mathbf{z}}$ 方向），以及通过弛豫时间近似得到的电导率 $\\sigma_{\\mathrm{RTA}}$。该近似将碰撞算符替换为 $-f_{1}(\\hat{\\mathbf{k}})/\\tau_{0}$，其中 $1/\\tau_{0} \\equiv \\int d\\Omega' \\, W(\\gamma)$，$d\\Omega'$ 是 $\\hat{\\mathbf{k}}'$ 的立体角元，$\\gamma$ 是 $\\hat{\\mathbf{k}}$ 和 $\\hat{\\mathbf{k}}'$ 之间的夹角。将比率 $R(g) \\equiv \\sigma_{\\mathrm{full}}/\\sigma_{\\mathrm{RTA}}$ 纯粹用关于 $W(\\gamma)$ 的角积分来表示。\n\n3. 对于给定的 $W(\\gamma)$，精确计算这些角积分，并获得 $R(g)$ 作为 $g$ 的函数的闭合形式表达式。\n\n你的最终答案必须是仅用 $g$ 表示的 $R(g)$ 的单个简化解析表达式，无需进行数值计算，也无单位。你可以假设任何依赖于能带参数和 $A$ 的公共预因子在该比率中被消除了。", "solution": "该问题已经过验证，被认为是科学上可靠、提法恰当且内容自洽的。因此，提供完整的解答。\n\n稳态、空间均匀的玻尔兹曼输运方程（BTE）由下式给出\n$$\n\\left(\\frac{\\partial f}{\\partial t}\\right)_{\\text{field}} + \\left(\\frac{\\partial f}{\\partial t}\\right)_{\\text{coll}} = 0\n$$\n对于均匀电场 $\\mathbf{E}$，场项为 $\\left(\\frac{\\partial f}{\\partial t}\\right)_{\\text{field}} = -\\frac{e\\mathbf{E}}{\\hbar} \\cdot \\nabla_{\\mathbf{k}} f$。\n分布函数线性化为 $f(\\mathbf{k}) = f_{0}(\\varepsilon_{\\mathbf{k}}) + f_{1}(\\mathbf{k})$，其中 $f_0$ 是平衡费米-狄拉克分布，$f_1$ 是非平衡修正项。\n场项通过近似 $f \\approx f_0$ 进行线性化：\n$$\n-\\frac{e\\mathbf{E}}{\\hbar} \\cdot \\nabla_{\\mathbf{k}} f_0 = -\\frac{e\\mathbf{E}}{\\hbar} \\cdot (\\nabla_{\\mathbf{k}} \\varepsilon_{\\mathbf{k}}) \\frac{\\partial f_0}{\\partial \\varepsilon} = -e(\\mathbf{E} \\cdot \\mathbf{v}_{\\mathbf{k}}) \\frac{\\partial f_0}{\\partial \\varepsilon}\n$$\n对于球形费米面上的弹性散射，作用于 $f_1$ 的线性化碰撞算符为\n$$\n\\left(\\frac{\\partial f_1}{\\partial t}\\right)_{\\text{coll}} = \\int d\\Omega' \\, W(\\gamma) [f_1(\\mathbf{k}') - f_1(\\mathbf{k})]\n$$\n其中 $d\\Omega'$ 是散射波矢 $\\mathbf{k}'$ 的立体角元，$\\gamma$ 是 $\\mathbf{k}$ 和 $\\mathbf{k}'$ 之间的夹角。波矢 $\\mathbf{k}$ 和 $\\mathbf{k}'$ 被限制在费米面上。\n\n因此，线性化的 BTE 为\n$$\n-e(\\mathbf{E} \\cdot \\mathbf{v}_{\\mathbf{k}}) \\frac{\\partial f_0}{\\partial \\varepsilon} = \\int d\\Omega' \\, W(\\gamma) [f_1(\\mathbf{k}') - f_1(\\mathbf{k})]\n$$\n在低温下，$\\frac{\\partial f_0}{\\partial \\varepsilon}$在费米能量 $\\varepsilon_F$ 处呈尖峰状，因此我们寻找如下形式的解：\n$f_1(\\mathbf{k}) = \\Phi(\\hat{\\mathbf{k}}) \\left(-\\frac{\\partial f_0}{\\partial \\varepsilon}\\right)$。将此代入 BTE 并消去公因子 $\\left(-\\frac{\\partial f_0}{\\partial \\varepsilon}\\right)$，我们得到关于角度部分 $\\Phi(\\hat{\\mathbf{k}})$ 的一个积分方程：\n$$\ne(\\mathbf{E} \\cdot \\mathbf{v}_{\\mathbf{k}}) = \\int d\\Omega' \\, W(\\gamma) [\\Phi(\\hat{\\mathbf{k}}) - \\Phi(\\hat{\\mathbf{k}}')]\n$$\n当 $\\mathbf{E} = E \\hat{\\mathbf{z}}$ 且 $\\mathbf{v}_{\\mathbf{k}} = v_F \\hat{\\mathbf{k}}$（其中 $v_F$ 是费米速度）时，左手边变为 $e E v_F (\\hat{\\mathbf{z}} \\cdot \\hat{\\mathbf{k}}) = e E v_F \\cos\\theta$。这里，$\\theta$ 是 $\\hat{\\mathbf{k}}$ 相对于 $\\hat{\\mathbf{z}}$ 轴的极角。\n\n**1. 标量积分方程的推导与本征值确定**\n\n费米面上关于 $\\Phi(\\hat{\\mathbf{k}})$ 的积分方程为：\n$$\ne E v_F \\cos\\theta = \\int d\\Omega' \\, W(\\hat{\\mathbf{k}} \\cdot \\hat{\\mathbf{k}}') [\\Phi(\\hat{\\mathbf{k}}) - \\Phi(\\hat{\\mathbf{k}}')]\n$$\n右手边是作用于 $\\Phi$ 的一个线性算符。我们称之为 $\\mathcal{L}[\\Phi]$。\n源项 $e E v_F \\cos\\theta$ 与球谐函数 $Y_{1,0}(\\hat{\\mathbf{k}})$ 成正比。碰撞算符 $\\mathcal{L}$ 是旋转不变的，因为它的核 $W$ 仅依赖于相对角度 $\\gamma = \\arccos(\\hat{\\mathbf{k}} \\cdot \\hat{\\mathbf{k}}')$。因此，球谐函数 $Y_{lm}(\\hat{\\mathbf{k}})$ 是它的本征函数。所以解 $\\Phi(\\hat{\\mathbf{k}})$ 必须与源项处于同一球谐函数子空间，即与 $\\cos\\theta$ 成正比。\n我们假设解的形式为 $\\Phi(\\hat{\\mathbf{k}}) = c \\cos\\theta$，其中 $c$ 为某个常数。\n$$\ne E v_F \\cos\\theta = c \\left[ \\cos\\theta \\int d\\Omega' W(\\gamma) - \\int d\\Omega' W(\\gamma) \\cos\\theta' \\right]\n$$\n碰撞算符作用于本征函数 $Y_{lm}$ 的结果是 $\\mathcal{L}[Y_{lm}] = (\\Lambda_0 - \\Lambda_l) Y_{lm}$，其中 $\\Lambda_l$ 是算符积分部分的本征值，由 $\\Lambda_l = 2\\pi \\int_{-1}^{1} W(x) P_l(x) dx$ 给出，$x=\\cos\\gamma$ 且 $P_l(x)$ 是勒让德多项式。\n对于我们与 $\\cos\\theta \\propto P_1(\\cos\\theta)$ 成正比的解，我们关心算符 $\\mathcal{L}$ 对应于 $l=1$ 的本征值。驱动项对应于 $l=1$。\n$$\n\\mathcal{L}[c \\cos\\theta] = c(\\Lambda_0 - \\Lambda_1) \\cos\\theta\n$$\nBTE 变为 $e E v_F \\cos\\theta = c(\\Lambda_0 - \\Lambda_1) \\cos\\theta$。对应于 $l=1$ 模式的碰撞算符的本征值为 $\\Lambda_0 - \\Lambda_1$。\n该本征值可以表示为对 $W(\\gamma)$ 的角积分：\n$$\n\\Lambda_0 - \\Lambda_1 = 2\\pi \\int_{-1}^{1} W(\\cos\\gamma) P_0(\\cos\\gamma) d(\\cos\\gamma) - 2\\pi \\int_{-1}^{1} W(\\cos\\gamma) P_1(\\cos\\gamma) d(\\cos\\gamma)\n$$\n由于 $P_0(x)=1$ 且 $P_1(x)=x$：\n$$\n\\Lambda_0 - \\Lambda_1 = 2\\pi \\int_{-1}^{1} W(\\cos\\gamma) (1 - \\cos\\gamma) d(\\cos\\gamma) = \\int d\\Omega' W(\\gamma) (1-\\cos\\gamma)\n$$\n这个量是输运散射率，通常记为 $1/\\tau_{\\text{tr}}$。\n\n**2. 电导率比值**\n\n沿 $\\hat{\\mathbf{z}}$ 方向的电流密度为 $j_z = -e \\int v_z f_1(\\mathbf{k}) \\frac{d^3k}{(2\\pi)^3}$（对于无自旋电子）。\n使用 $f_1(\\mathbf{k}) = \\Phi(\\hat{\\mathbf{k}}) (-\\frac{\\partial f_0}{\\partial \\varepsilon})$，我们有 $\\Phi(\\hat{\\mathbf{k}}) = c \\cos\\theta = \\frac{e E v_F}{\\Lambda_0 - \\Lambda_1} \\cos\\theta$。\n对能量的积分得到给定自旋下费米能级处的态密度 $D(\\varepsilon_F)$。我们将与能量和能带相关的常数归为一个预因子 $C_0 = \\frac{e^2 v_F^2 D(\\varepsilon_F)}{4\\pi}$。\n$$\nj_z = C_0 \\frac{E}{\\Lambda_0 - \\Lambda_1} \\int d\\Omega \\, \\cos^2\\theta\n$$\n根据 $\\int \\cos^2\\theta \\, d\\Omega = 4\\pi/3$，我们得到 $j_z = \\frac{C_0 E}{3(\\Lambda_0 - \\Lambda_1)} (4\\pi)$。完整电导率 $\\sigma_{\\mathrm{full}} = j_z/E$ 为：\n$$\n\\sigma_{\\mathrm{full}} = \\frac{4\\pi C_0}{3(\\Lambda_0 - \\Lambda_1)}\n$$\n\n在弛豫时间近似（RTA）中，碰撞算符被简化为 $\\mathcal{L}_{\\mathrm{RTA}}[f_1] = -f_1/\\tau_0$，其中问题定义了 $1/\\tau_0 = \\int d\\Omega' W(\\gamma)$。这对应于我们的本征值 $\\Lambda_0$。RTA 中的 BTE 为 $-e(\\mathbf{E} \\cdot \\mathbf{v}_{\\mathbf{k}})(-\\frac{\\partial f_0}{\\partial\\varepsilon}) = -f_1/\\tau_0 = -\\Lambda_0 f_1$。\n这给出 $f_{1, \\mathrm{RTA}}(\\mathbf{k}) = \\frac{e(\\mathbf{E} \\cdot \\mathbf{v}_{\\mathbf{k}})}{\\Lambda_0} (-\\frac{\\partial f_0}{\\partial\\varepsilon}) = \\frac{e E v_F \\cos\\theta}{\\Lambda_0} (-\\frac{\\partial f_0}{\\partial\\varepsilon})$。\nRTA 电导率 $\\sigma_{\\mathrm{RTA}}$ 通过相同的电流计算得出，只需将 $(\\Lambda_0-\\Lambda_1)^{-1}$ 替换为 $\\Lambda_0^{-1}$：\n$$\n\\sigma_{\\mathrm{RTA}} = \\frac{4\\pi C_0}{3 \\Lambda_0}\n$$\n比值 $R(g) = \\sigma_{\\mathrm{full}} / \\sigma_{\\mathrm{RTA}}$ 为：\n$$\nR(g) = \\frac{\\Lambda_0}{\\Lambda_0 - \\Lambda_1} = \\frac{\\int d\\Omega' \\, W(\\gamma)}{\\int d\\Omega' \\, W(\\gamma) (1-\\cos\\gamma)} = \\frac{\\int_{-1}^{1} W(\\cos\\gamma) d(\\cos\\gamma)}{\\int_{-1}^{1} W(\\cos\\gamma) (1-\\cos\\gamma) d(\\cos\\gamma)}\n$$\n\n**3. 对给定核的求值**\n\n给定的散射核为 $W(\\cos\\gamma) = A \\frac{1 - g^{2}}{(1 + g^{2} - 2 g \\cos\\gamma)^{3/2}}$。\n此表达式与勒让德多项式的生成函数成正比：\n$$\n\\sum_{l=0}^\\infty (2l+1) g^l P_l(x) = \\frac{1-g^2}{(1+g^2-2gx)^{3/2}}\n$$\n其中 $x=\\cos\\gamma$。因此，我们可以写出 $W(x) = A \\sum_{l=0}^\\infty (2l+1) g^l P_l(x)$。\n现在我们可以利用勒让德多项式的正交性 $\\int_{-1}^{1} P_l(x) P_j(x) dx = \\frac{2}{2l+1}\\delta_{lj}$ 来求本征值 $\\Lambda_l$。\n$$\n\\Lambda_l = 2\\pi \\int_{-1}^{1} W(x) P_l(x) dx = 2\\pi \\int_{-1}^{1} \\left(A \\sum_{j=0}^\\infty (2j+1) g^j P_j(x)\\right) P_l(x) dx\n$$\n$$\n\\Lambda_l = 2\\pi A \\sum_{j=0}^\\infty (2j+1) g^j \\left(\\frac{2}{2l+1}\\delta_{lj}\\right) = 2\\pi A (2l+1) g^l \\frac{2}{2l+1} = 4\\pi A g^l\n$$\n这给了我们所需的 $l=0$ 和 $l=1$ 的本征值：\n$$\n\\Lambda_0 = 4\\pi A g^0 = 4\\pi A\n$$\n$$\n\\Lambda_1 = 4\\pi A g^1 = 4\\pi A g\n$$\n另外，也可以直接计算积分。令 $x = \\cos\\gamma$。\n$$\n\\int_{-1}^{1} (1+g^2-2gx)^{-3/2} dx = \\left[\\frac{1}{g\\sqrt{1+g^2-2gx}}\\right]_{-1}^{1} = \\frac{1}{g}\\left(\\frac{1}{1-g} - \\frac{1}{1+g}\\right) = \\frac{2}{1-g^2}\n$$\n所以 $\\int_{-1}^{1} W(x) dx = A(1-g^2)\\frac{2}{1-g^2} = 2A$，且 $\\Lambda_0 = 2\\pi(2A) = 4\\pi A$。\n$$\n\\int_{-1}^{1} x(1+g^2-2gx)^{-3/2} dx = \\frac{2g}{1-g^2}\n$$\n所以 $\\int_{-1}^{1} W(x)x dx = A(1-g^2)\\frac{2g}{1-g^2} = 2Ag$，且 $\\Lambda_1 = 2\\pi(2Ag) = 4\\pi Ag$。\n两种方法得出相同的结果。\n\n最后，我们计算比值 $R(g)$：\n$$\nR(g) = \\frac{\\Lambda_0}{\\Lambda_0 - \\Lambda_1} = \\frac{4\\pi A}{4\\pi A - 4\\pi A g} = \\frac{4\\pi A}{4\\pi A(1-g)} = \\frac{1}{1-g}\n$$\n这个结果表明，对于高度前向峰化的散射（$g \\to 1$），使用总散射率的弛豫时间近似会严重低估电导率。而通过 $(1-\\cos\\gamma)$ 正确加权散射事件的输运散射率趋于零，导致电导率远高于 RTA 的预测值。", "answer": "$$\\boxed{\\frac{1}{1-g}}$$", "id": "2803361"}, {"introduction": "本练习将我们从解析推导带入一个强大的、用以理解输运现象的计算框架。通过将碰撞算符视为一个矩阵，我们可以找到它的本征模态，即“弛豫子”(relaxons)，它们代表了非平衡分布的基本衰减通道。这项练习要求你对碰撞算符进行对角化，以观察每个弛豫子模态如何对物理电流和熵产生做出贡献，这为了解计算材料科学中广泛使用的现代视角提供了基础。[@problem_id:2803343]", "problem": "给定晶体固体中载流子的线性化玻尔兹曼输运方程，该方程是在平衡态附近进行线性化后，在晶体动量态空间中写出的。在对称化表示中，碰撞算符是一个作用于态振幅矢量 $|\\psi\\rangle \\in \\mathbb{R}^{N}$ 上的对称半正定矩阵 $\\mathbf{A} \\in \\mathbb{R}^{N \\times N}$。在弱热力学驱动场存在下的稳态由以下线性系统定义\n$$\n\\mathbf{A}\\,|\\psi\\rangle = |d\\rangle,\n$$\n其中 $|d\\rangle$ 表示由例如微小均匀温度梯度引起的驱动项。我们感兴趣的物理流（例如热流）被建模为线性泛函\n$$\nJ = \\langle j | \\psi \\rangle,\n$$\n其中 $|j\\rangle \\in \\mathbb{R}^{N}$ 是同一对称化空间中给定的流耦合矢量。稳态下的熵产生率（单位归一化体积）由以下二次型给出\n$$\n\\dot{S} = \\langle \\psi | \\mathbf{A} | \\psi \\rangle \\ge 0.\n$$\n$\\mathbf{A}$的本征模式，称为弛豫子 (relaxons)，通过谱分解得到\n$$\n\\mathbf{A} = \\sum_{i=1}^{N} \\lambda_i\\, |e_i\\rangle \\langle e_i|,\n$$\n其中 $|e_i\\rangle$ 为标准正交本征矢量，$\\lambda_i \\ge 0$ 为非负本征值。请将稳态、流和熵产生表示为关于弛豫子的模态和，并设计一个算法，对于给定的对称矩阵 $\\mathbf{A}$ 和矢量 $|d\\rangle$, $|j\\rangle$，计算：\n- 总流 $J$，\n- 总熵产生 $\\dot{S}$，\n- 各模态的流贡献 $J_i$，\n- 各模态的熵产生贡献 $\\dot{S}_i$，\n其中模态贡献是在 $\\mathbf{A}$ 的本征基中定义的。为确保数值稳定性，请使用伪逆约定：定义一个小的截断值 $\\varepsilon = 10^{-10}$，并且在求和中只包含那些满足 $\\lambda_i > \\varepsilon$ 的模态。\n\n请从适用于材料物理和输运理论的基本原理出发：线性化玻尔兹曼方程的结构、细致平衡原理、允许碰撞算符对称化的 Onsager 倒易关系约束，以及熵产生的非负性（Boltzmann 的 $H$ 定理）。不要假定任何快捷公式；直接从本征分解和线性代数中导出模态贡献的表达式。\n\n此问题中的所有量都是无量纲化的；将所有输出报告为四舍五入到 $6$ 位小数的无量纲浮点数。\n\n你的程序必须：\n- 使用适用于对称矩阵的数值稳定的本征分解方法对角化每个给定的 $\\mathbf{A}$。\n- 将 $|d\\rangle$ 和 $|j\\rangle$ 投影到弛豫子本征基上。\n- 使用阈值为 $\\varepsilon = 10^{-10}$ 的伪逆规则计算各模态的贡献。\n- 报告结果时，本征模式需按非递减的本征值 $\\lambda_i$ 排序。\n\n测试套件：\n对于每个测试用例，$\\mathbf{A}$ 通过构造即为对称，并且已经处于对称化表示中。\n\n- 测试用例 1 (一般良态)：\n  - $\\mathbf{A}_1 = \\begin{bmatrix} 2.0 & -0.5 & 0.0 \\\\ -0.5 & 1.5 & -0.2 \\\\ 0.0 & -0.2 & 1.0 \\end{bmatrix}$\n  - $|d_1\\rangle = \\begin{bmatrix} 1.0 \\\\ 0.5 \\\\ -0.2 \\end{bmatrix}$\n  - $|j_1\\rangle = \\begin{bmatrix} 0.8 \\\\ -0.3 \\\\ 0.4 \\end{bmatrix}$\n\n- 测试用例 2 (近守恒的弛豫子主导)：\n  - $\\mathbf{A}_2 = \\begin{bmatrix} 10^{-4} & 0.0 & 0.0 \\\\ 0.0 & 1.0 & 0.1 \\\\ 0.0 & 0.1 & 2.0 \\end{bmatrix}$\n  - $|d_2\\rangle = \\begin{bmatrix} 0.2 \\\\ 0.1 \\\\ -0.1 \\end{bmatrix}$\n  - $|j_2\\rangle = \\begin{bmatrix} 1.0 \\\\ 0.0 \\\\ 0.0 \\end{bmatrix}$\n\n- 测试用例 3 (正交性导致零流但正耗散)：\n  - $\\mathbf{A}_3 = \\begin{bmatrix} 1.2 & 0.0 & 0.0 \\\\ 0.0 & 0.9 & 0.0 \\\\ 0.0 & 0.0 & 1.1 \\end{bmatrix}$\n  - $|d_3\\rangle = \\begin{bmatrix} 0.0 \\\\ 1.0 \\\\ 0.0 \\end{bmatrix}$\n  - $|j_3\\rangle = \\begin{bmatrix} 1.0 \\\\ 0.0 \\\\ 0.0 \\end{bmatrix}$\n\n对于每个 $N=3$ 的测试用例，你的程序必须按以下顺序输出一个包含 8 个数字的块：\n- 首先是总流 $J$，\n- 接着是总熵产生 $\\dot{S}$，\n- 然后是三个模态的流贡献 $J_1, J_2, J_3$，\n- 最后是三个模态的熵产生贡献 $\\dot{S}_1, \\dot{S}_2, \\dot{S}_3$，\n其中模态按 $\\lambda_i$ 升序排列。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含所有测试用例的所有结果，形式为方括号括起来的、无空格的逗号分隔列表。按测试用例的顺序串联三个 8 数字块。每个数字必须四舍五入到 6 位小数。例如，总体形式为\n$[J^{(1)},\\dot{S}^{(1)},J^{(1)}_1,J^{(1)}_2,J^{(1)}_3,\\dot{S}^{(1)}_1,\\dot{S}^{(1)}_2,\\dot{S}^{(1)}_3, J^{(2)},\\dot{S}^{(2)},\\dots, J^{(3)},\\dot{S}^{(3)},\\dots]$。", "solution": "在尝试任何解决方案之前，对问题陈述进行严格验证。\n\n### 第 1 步：提取给定条件\n\n给定条件逐字从问题陈述中提取：\n-   稳态线性化玻尔兹曼输运方程：$\\mathbf{A}\\,|\\psi\\rangle = |d\\rangle$，其中 $\\mathbf{A} \\in \\mathbb{R}^{N \\times N}$ 是一个对称半正定碰撞算符， $|\\psi\\rangle \\in \\mathbb{R}^{N}$ 是态振幅矢量，而 $|d\\rangle \\in \\mathbb{R}^{N}$ 是驱动项。\n-   物理流：$J = \\langle j | \\psi \\rangle$，其中 $|j\\rangle \\in \\mathbb{R}^{N}$ 是一个流耦合矢量。\n-   熵产生率：$\\dot{S} = \\langle \\psi | \\mathbf{A} | \\psi \\rangle \\ge 0$。\n-   碰撞算符的谱分解：$\\mathbf{A} = \\sum_{i=1}^{N} \\lambda_i\\, |e_i\\rangle \\langle e_i|$，其中 $|e_i\\rangle$ 为标准正交本征矢量，$\\lambda_i \\ge 0$ 为非负本征值。\n-   伪逆约定的数值截断值：$\\varepsilon = 10^{-10}$。求和中包含 $\\lambda_i > \\varepsilon$ 的模态。\n-   测试用例 1：\n    -   $\\mathbf{A}_1 = \\begin{bmatrix} 2.0 & -0.5 & 0.0 \\\\ -0.5 & 1.5 & -0.2 \\\\ 0.0 & -0.2 & 1.0 \\end{bmatrix}$\n    -   $|d_1\\rangle = \\begin{bmatrix} 1.0 \\\\ 0.5 \\\\ -0.2 \\end{bmatrix}$\n    -   $|j_1\\rangle = \\begin{bmatrix} 0.8 \\\\ -0.3 \\\\ 0.4 \\end{bmatrix}$\n-   测试用例 2：\n    -   $\\mathbf{A}_2 = \\begin{bmatrix} 10^{-4} & 0.0 & 0.0 \\\\ 0.0 & 1.0 & 0.1 \\\\ 0.0 & 0.1 & 2.0 \\end{bmatrix}$\n    -   $|d_2\\rangle = \\begin{bmatrix} 0.2 \\\\ 0.1 \\\\ -0.1 \\end{bmatrix}$\n    -   $|j_2\\rangle = \\begin{bmatrix} 1.0 \\\\ 0.0 \\\\ 0.0 \\end{bmatrix}$\n-   测试用例 3：\n    -   $\\mathbf{A}_3 = \\begin{bmatrix} 1.2 & 0.0 & 0.0 \\\\ 0.0 & 0.9 & 0.0 \\\\ 0.0 & 0.0 & 1.1 \\end{bmatrix}$\n    -   $|d_3\\rangle = \\begin{bmatrix} 0.0 \\\\ 1.0 \\\\ 0.0 \\end{bmatrix}$\n    -   $|j_3\\rangle = \\begin{bmatrix} 1.0 \\\\ 0.0 \\\\ 0.0 \\end{bmatrix}$\n\n### 第 2 步：使用提取的给定条件进行验证\n\n根据指定的验证标准对问题进行分析。\n-   **科学基础扎实**：该问题植根于晶体固体中电子和声子输运的基本理论。线性化玻尔兹曼方程、对称化碰撞算符的概念（微观可逆性和细致平衡原理的结果）、熵产生的定义以及碰撞算符的谱分析（弛豫子模态）都是现代凝聚态物理中的标准核心概念。\n-   **问题适定**：该问题是适定的。对于给定的对称半正定矩阵 $\\mathbf{A}$ 和驱动项 $|d\\rangle$，系统 $\\mathbf{A}|\\psi\\rangle = |d\\rangle$ 在与 $\\mathbf{A}$ 的零空间正交的子空间内有唯一解。使用带有截断值 $\\varepsilon$ 的伪逆提供了一种正则化、数值稳定且物理上有意义的方法来处理近零本征值，这些本征值对应于准守恒量。输入已提供，要求的输出也已明确定义。\n-   **目标明确**：问题以精确、客观的数学语言陈述。矩阵和矢量定义清晰，没有歧义。\n-   **未检测到其他缺陷**：该问题是自洽的、一致的且计算上可行的。它不包含任何列出的缺陷，如不健全、不可形式化、不完整、不切实际或无关紧要。\n\n### 第 3 步：结论与行动\n\n该问题是**有效的**。我们继续进行完整、有理有据的求解。\n\n### 求解推导\n\n目标是根据碰撞算符 $\\mathbf{A}$ 的本征模式（弛豫子）来表示稳态解 $|\\psi\\rangle$、流 $J$ 和熵产生 $\\dot{S}$。\n\n碰撞算符 $\\mathbf{A}$ 是一个实对称矩阵，因此它拥有一组完备的标准正交本征矢量基 $\\{|e_i\\rangle\\}_{i=1}^N$ 及相应的实本征值 $\\{\\lambda_i\\}_{i=1}^N$。标准正交条件为 $\\langle e_i | e_k \\rangle = \\delta_{ik}$，其中 $\\delta_{ik}$ 是克罗内克 δ 符号。态空间 $\\mathbb{R}^N$ 中的任何矢量都可以在此基上展开。\n\n我们在弛豫子基上展开态矢量 $|\\psi\\rangle$ 和驱动矢量 $|d\\rangle$：\n$$\n|\\psi\\rangle = \\sum_{i=1}^{N} \\psi_i |e_i\\rangle, \\quad \\text{其中} \\quad \\psi_i = \\langle e_i | \\psi \\rangle\n$$\n$$\n|d\\rangle = \\sum_{i=1}^{N} d_i |e_i\\rangle, \\quad \\text{其中} \\quad d_i = \\langle e_i | d \\rangle\n$$\n系数 $\\psi_i$ 和 $d_i$ 分别是相应矢量在本征矢量 $|e_i\\rangle$ 上的投影。\n\n我们将这些展开式代入稳态玻尔兹曼方程 $\\mathbf{A}|\\psi\\rangle = |d\\rangle$中：\n$$\n\\mathbf{A}\\left(\\sum_{i=1}^{N} \\psi_i |e_i\\rangle\\right) = \\sum_{i=1}^{N} d_i |e_i\\rangle\n$$\n利用 $\\mathbf{A}$ 的线性性质以及本征值方程 $\\mathbf{A}|e_i\\rangle = \\lambda_i |e_i\\rangle$，我们得到：\n$$\n\\sum_{i=1}^{N} \\psi_i (\\mathbf{A}|e_i\\rangle) = \\sum_{i=1}^{N} \\psi_i \\lambda_i |e_i\\rangle = \\sum_{i=1}^{N} d_i |e_i\\rangle\n$$\n由于基 $\\{|e_i\\rangle\\}$ 的标准正交性，我们可以对每个模态 $i$ 的系数进行等同：\n$$\n\\lambda_i \\psi_i = d_i\n$$\n为了求解 $\\psi_i$，我们必须考虑 $\\lambda_i$ 的值。如果 $\\lambda_i \\ne 0$，那么 $\\psi_i = d_i / \\lambda_i$。如果 $\\lambda_i = 0$，方程 $0 \\cdot \\psi_i = d_i$ 要求 $d_i=0$ 才有解。这就是 Fredholm 择一性：解存在的条件是驱动项与 $\\mathbf{A}$ 的零空间正交。零空间模态对应于守恒量（例如，在具有完美平移对称性的晶体中的总动量）。问题指定了使用阈值为 $\\varepsilon = 10^{-10}$ 的伪逆约定。这导出了态矢量系数的以下表达式：\n$$\n\\psi_i = \\begin{cases} d_i / \\lambda_i & \\text{if } \\lambda_i > \\varepsilon \\\\ 0 & \\text{if } \\lambda_i \\le \\varepsilon \\end{cases}\n$$\n因此，完整的态矢量是 $|\\psi\\rangle = \\sum_{i: \\lambda_i > \\varepsilon} \\frac{\\langle e_i | d \\rangle}{\\lambda_i} |e_i\\rangle$。\n\n现在，我们推导流 $J$ 和熵产生 $\\dot{S}$ 的表达式。首先，我们展开流耦合矢量 $|j\\rangle$：\n$$\n|j\\rangle = \\sum_{i=1}^{N} j_i |e_i\\rangle, \\quad \\text{其中} \\quad j_i = \\langle e_i | j \\rangle\n$$\n总流 $J = \\langle j | \\psi \\rangle$ 为：\n$$\nJ = \\left\\langle \\sum_{k=1}^{N} j_k |e_k\\rangle \\middle| \\sum_{i=1}^{N} \\psi_i |e_i\\rangle \\right\\rangle = \\sum_{i,k=1}^{N} j_k \\psi_i \\langle e_k | e_i \\rangle = \\sum_{i=1}^{N} j_i \\psi_i\n$$\n代入 $\\psi_i$ 的表达式：\n$$\nJ = \\sum_{i: \\lambda_i > \\varepsilon} j_i \\frac{d_i}{\\lambda_i} = \\sum_{i: \\lambda_i > \\varepsilon} \\frac{\\langle e_i | j \\rangle \\langle e_i | d \\rangle}{\\lambda_i}\n$$\n对流的各模态贡献 $J_i$ 是此和中的第 $i$ 项：\n$$\nJ_i = \\begin{cases} \\frac{\\langle e_i | j \\rangle \\langle e_i | d \\rangle}{\\lambda_i} & \\text{if } \\lambda_i > \\varepsilon \\\\ 0 & \\text{if } \\lambda_i \\le \\varepsilon \\end{cases}\n$$\n总流是这些贡献的总和：$J = \\sum_{i=1}^{N} J_i$。\n\n接下来，我们计算熵产生 $\\dot{S} = \\langle \\psi | \\mathbf{A} | \\psi \\rangle$。利用稳态下 $\\mathbf{A}|\\psi\\rangle = |d\\rangle$ 这一事实，我们可以写出 $\\dot{S} = \\langle \\psi | d \\rangle$。我们使用这种形式，因为它在计算上更高效：\n$$\n\\dot{S} = \\left\\langle \\sum_{k=1}^{N} \\psi_k |e_k\\rangle \\middle| \\sum_{i=1}^{N} d_i |e_i\\rangle \\right\\rangle = \\sum_{i,k=1}^{N} \\psi_k d_i \\langle e_k | e_i \\rangle = \\sum_{i=1}^{N} \\psi_i d_i\n$$\n代入 $\\psi_i$ 的表达式：\n$$\n\\dot{S} = \\sum_{i: \\lambda_i > \\varepsilon} \\frac{d_i}{\\lambda_i} d_i = \\sum_{i: \\lambda_i > \\varepsilon} \\frac{d_i^2}{\\lambda_i} = \\sum_{i: \\lambda_i > \\varepsilon} \\frac{(\\langle e_i | d \\rangle)^2}{\\lambda_i}\n$$\n对熵产生的各模态贡献 $\\dot{S}_i$ 是此和中的第 $i$ 项：\n$$\n\\dot{S}_i = \\begin{cases} \\frac{(\\langle e_i | d \\rangle)^2}{\\lambda_i} & \\text{if } \\lambda_i > \\varepsilon \\\\ 0 & \\text{if } \\lambda_i \\le \\varepsilon \\end{cases}\n$$\n总熵产生是这些贡献的总和：$\\dot{S} = \\sum_{i=1}^{N} \\dot{S}_i$。由于 $\\lambda_i \\ge 0$，可以保证 $\\dot{S}_i \\ge 0$，因此 $\\dot{S} \\ge 0$，这与热力学第二定律一致。\n\n计算算法如下：\n1. 对于每个测试用例 $(\\mathbf{A}, |d\\rangle, |j\\rangle)$，对对称矩阵 $\\mathbf{A}$ 进行本征分解，以获得本征值 $\\lambda_i$ 和相应的标准正交本征矢量矩阵 $\\mathbf{E}$ (其列为 $|e_i\\rangle$)。像 `numpy.linalg.eigh` 这样数值稳定的算法是合适的；它返回按非递减顺序排序的本征值，这满足了问题的要求。\n2. 对每个本征模态 $i=1, \\dots, N$：\n    a. 提取本征值 $\\lambda_i$ 和本征矢量 $|e_i\\rangle$。\n    b. 将驱动矢量和流矢量投影到本征矢量上以获得系数：$d_i = \\langle e_i | d \\rangle = |e_i\\rangle^T |d\\rangle$ 和 $j_i = \\langle e_i | j \\rangle = |e_i\\rangle^T |j\\rangle$。\n    c. 应用伪逆规则。如果 $\\lambda_i > \\varepsilon = 10^{-10}$，则计算模态贡献 $J_i = (j_i d_i) / \\lambda_i$ 和 $\\dot{S}_i = d_i^2 / \\lambda_i$。否则，设置 $J_i=0$ 和 $\\dot{S}_i=0$。\n3. 对各模态贡献求和，以找到总流 $J = \\sum_i J_i$ 和总熵产生 $\\dot{S} = \\sum_i \\dot{S}_i$。\n4. 按指定顺序为每个测试用例整理结果：$[J, \\dot{S}, J_1, J_2, J_3, \\dot{S}_1, \\dot{S}_2, \\dot{S}_3]$。\n5. 将所有数值结果格式化为四舍五入到 6 位小数的浮点数。\n\n该程序是为提供的测试用例实现的。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the linearized Boltzmann transport equation for given test cases\n    using modal analysis on the collision operator.\n    \"\"\"\n    \n    # Define the numerical cutoff for the pseudoinverse\n    epsilon = 1e-10\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        (\n            np.array([[2.0, -0.5, 0.0], [-0.5, 1.5, -0.2], [0.0, -0.2, 1.0]]),\n            np.array([1.0, 0.5, -0.2]),\n            np.array([0.8, -0.3, 0.4])\n        ),\n        (\n            np.array([[1e-4, 0.0, 0.0], [0.0, 1.0, 0.1], [0.0, 0.1, 2.0]]),\n            np.array([0.2, 0.1, -0.1]),\n            np.array([1.0, 0.0, 0.0])\n        ),\n        (\n            np.array([[1.2, 0.0, 0.0], [0.0, 0.9, 0.0], [0.0, 0.0, 1.1]]),\n            np.array([0.0, 1.0, 0.0]),\n            np.array([1.0, 0.0, 0.0])\n        )\n    ]\n    \n    all_results = []\n\n    for A, d_vec, j_vec in test_cases:\n        # Step 1: Diagonalize the symmetric matrix A.\n        # np.linalg.eigh returns eigenvalues in ascending order and corresponding\n        # eigenvectors as columns in the matrix e_vecs. This matches the problem\n        # requirement to order modes by nondecreasing eigenvalues.\n        lambdas, e_vecs = np.linalg.eigh(A)\n        \n        N = A.shape[0]\n        J_modes = np.zeros(N)\n        S_dot_modes = np.zeros(N)\n        \n        # Step 2: Loop through each mode (eigenvalue/eigenvector pair)\n        for i in range(N):\n            lambda_i = lambdas[i]\n            e_i = e_vecs[:, i]\n            \n            # Project d and j onto the current eigenvector\n            d_i = e_i.T @ d_vec # equivalent to np.dot(e_i, d_vec)\n            j_i = e_i.T @ j_vec # equivalent to np.dot(e_i, j_vec)\n            \n            # Step 3: Apply pseudoinverse convention and compute contributions\n            if lambda_i > epsilon:\n                J_modes[i] = (j_i * d_i) / lambda_i\n                S_dot_modes[i] = (d_i**2) / lambda_i\n            else:\n                J_modes[i] = 0.0\n                S_dot_modes[i] = 0.0\n        \n        # Step 4: Calculate total current and entropy production\n        J_total = np.sum(J_modes)\n        S_dot_total = np.sum(S_dot_modes)\n        \n        # Step 5: Collate results for the current test case in the specified order\n        # [J_total, S_dot_total, J_1, J_2, J_3, S_dot_1, S_dot_2, S_dot_3]\n        case_results = [J_total, S_dot_total]\n        case_results.extend(J_modes.tolist())\n        case_results.extend(S_dot_modes.tolist())\n        \n        all_results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    # Each number is rounded to 6 decimal places.\n    formatted_results = [f\"{x:.6f}\" for x in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2803343"}]}