{"hands_on_practices": [{"introduction": "在理解铁磁性时，平均场理论提供了一个强大而直观的切入点。该理论的核心思想是将一个磁矩与其所有邻居之间的复杂交换作用，简化为一个等效的、巨大的内禀磁场——即外斯交换场 $H_{\\mathrm{ex}}$ 的作用。本练习将指导你通过一个具体的计算，亲手估算这个交换场的大小，并将其与典型的外部磁场进行比较，从而深刻理解为何交换作用是决定材料自发磁化温度依赖性的主导因素 [@problem_id:2865526]。", "problem": "一个简单立方晶格上的三维铁磁体，其模型由各向同性 Heisenberg 交换作用和与均匀磁场的 Zeeman 耦合描述。最近邻自旋之间的哈密顿量的交换部分取为 $-J \\sum_{\\langle i, j \\rangle} \\mathbf{S}_i \\cdot \\mathbf{S}_j$，其中 $J>0$ 有利于平行排列，$\\langle i, j \\rangle$ 表示最近邻对。考虑零温、完全对齐的状态，其中每个自旋的大小为 $S$，所有相邻自旋都平行。使用单个自旋在磁场中的 Zeeman 能量 $-g \\mu_B \\mathbf{S} \\cdot \\mathbf{H}$，通过将每个自旋的交换能与等效的 Zeeman 能量相匹配，估算有效 Weiss 交换场 $H_{\\mathrm{ex}}$ 的大小。然后，对于配位数 $z=6$ 的简单立方晶格、自旋量子数 $S=1$、Landé 因子 $g=2$、交换常数 $J$ 由 $J/k_B=10\\,\\mathrm{K}$ 指定的情况（Boltzmann 常数 $(k_B)$ 和 Bohr 磁子 $(\\mu_B)$ 如下给出），计算无量纲比值\n$$r \\equiv \\frac{H_{\\mathrm{ex}}}{1\\,\\mathrm{T}}.$$\n使用 $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$ 和 $\\mu_B = 9.2740100783 \\times 10^{-24}\\,\\mathrm{J\\,T^{-1}}$。将最终比值 $r$ 报告为一个纯数，四舍五入到三位有效数字。将您计算的任何中间场以特斯拉为单位表示，但只有比值 $r$ 会被评分。\n\n最后，根据 $r$ 的大小，简要说明在 Curie 温度 $(T_C)$ 附近及以下，哪种场标度主要决定了自发磁化强度 $M_s(T)$ 对温度的依赖性。您的定性说明不会被评分；只有 $r$ 的数值会被评分。", "solution": "该问题要求计算 Heisenberg 铁磁体的有效 Weiss 交换场 $H_{\\mathrm{ex}}$，以及随后的无量纲比值 $r$。此计算的基础是平均场理论，其中单个磁矩与其所有邻居的相互作用被替换为与这些邻居产生的平均（或“均”）场的相互作用。\n\n首先，我们考虑单个自旋的交换能，我们用索引 $i$ 来标记它。根据所提供的哈密顿量 $H_{\\mathrm{exch}} = -J \\sum_{\\langle k, l \\rangle} \\mathbf{S}_k \\cdot \\mathbf{S}_l$，涉及自旋 $\\mathbf{S}_i$ 的那部分能量是由于它与其 $z$ 个最近邻（用索引 $j$ 表示）的相互作用：\n$$\nE_{\\mathrm{exch}, i} = -J \\mathbf{S}_i \\cdot \\sum_{j \\in \\text{n.n.}} \\mathbf{S}_j\n$$\n在平均场近似中，与每个相邻自旋算符 $\\mathbf{S}_j$ 的显式相互作用被替换为与其统计平均值 $\\langle \\mathbf{S} \\rangle$ 的相互作用。因此，自旋 $i$ 的平均场能量为：\n$$\nE_{\\mathrm{MF}, i} = -z J (\\mathbf{S}_i \\cdot \\langle \\mathbf{S} \\rangle)\n$$\n问题指定了零温（$T=0\\,\\mathrm{K}$）极限，此时系统处于完全对齐的铁磁态。在此基态下，任何自旋的期望值 $\\langle \\mathbf{S} \\rangle$ 都是一个指向磁化方向的矢量，其大小由自旋量子数 $S$ 给出。因此，点积 $\\mathbf{S}_i \\cdot \\langle \\mathbf{S} \\rangle$ 可以经典地处理为 $S \\cdot S \\cos(0) = S^2$。然而，更严谨的推导来自于算符形式的等同。\n\n有效 Weiss 交换场 $\\mathbf{H}_{\\mathrm{ex}}$ 定义为能够产生等效 Zeeman 能量的磁场。自旋 $\\mathbf{S}_i$ 在此有效场中的 Zeeman 能量由下式给出：\n$$\nE_{\\mathrm{Z}, i} = -g \\mu_B \\mathbf{S}_i \\cdot \\mathbf{H}_{\\mathrm{ex}}\n$$\n其中 $g$ 是 Landé g 因子，$\\mu_B$ 是 Bohr 磁子。\n\n通过将平均场交换能表达式与等效 Zeeman 能量表达式相等，我们建立了 $\\mathbf{H}_{\\mathrm{ex}}$ 的定义：\n$$\n-z J (\\mathbf{S}_i \\cdot \\langle \\mathbf{S} \\rangle) = -g \\mu_B \\mathbf{S}_i \\cdot \\mathbf{H}_{\\mathrm{ex}}\n$$\n这意味着场与平均自旋之间存在以下关系：\n$$\ng \\mu_B \\mathbf{H}_{\\mathrm{ex}} = z J \\langle \\mathbf{S} \\rangle\n$$\n为了找到大小 $H_{\\mathrm{ex}}$，我们考虑矢量的大小。在零温下，$\\langle \\mathbf{S} \\rangle$ 的大小是 $S$。这得出：\n$$\ng \\mu_B H_{\\mathrm{ex}} = z J S\n$$\n由此，我们推导出 $H_{\\mathrm{ex}}$ 的表达式：\n$$\nH_{\\mathrm{ex}} = \\frac{z J S}{g \\mu_B}\n$$\n现在，我们必须代入问题陈述中提供的数值：\n- 简单立方晶格的配位数：$z=6$。\n- 自旋量子数：$S=1$。\n- Landé g 因子：$g=2$。\n- 交换常数相对于 Boltzmann 常数：$J/k_B = 10\\,\\mathrm{K}$。这给出 $J = 10 \\times k_B$。\n- Boltzmann 常数：$k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$。\n- Bohr 磁子：$\\mu_B = 9.2740100783 \\times 10^{-24}\\,\\mathrm{J\\,T^{-1}}$。\n\n将这些值代入 $H_{\\mathrm{ex}}$ 的公式中：\n$$\nH_{\\mathrm{ex}} = \\frac{6 \\times (10 \\times 1.380649 \\times 10^{-23}\\,\\mathrm{J}) \\times 1}{2 \\times (9.2740100783 \\times 10^{-24}\\,\\mathrm{J\\,T^{-1}})}\n$$\n$$\nH_{\\mathrm{ex}} = \\frac{8.283894 \\times 10^{-22}\\,\\mathrm{J}}{1.85480201566 \\times 10^{-23}\\,\\mathrm{J\\,T^{-1}}}\n$$\n$$\nH_{\\mathrm{ex}} \\approx 44.6622\\,\\mathrm{T}\n$$\n问题要求计算无量纲比值 $r$，定义为 $r \\equiv \\frac{H_{\\mathrm{ex}}}{1\\,\\mathrm{T}}$。\n$$\nr = \\frac{44.6622\\,\\mathrm{T}}{1\\,\\mathrm{T}} \\approx 44.6622\n$$\n按照要求将此结果四舍五入到三位有效数字：\n$$\nr \\approx 44.7\n$$\n对于最后一个不评分问题的简要说明：这个内部交换场的大小 $H_{\\mathrm{ex}} \\approx 45\\,\\mathrm{T}$，与通常施加的外部磁场（通常在 $1\\,\\mathrm{T}$ 的量级）相比是巨大的。在 Curie 温度 $T_C$ 以下自发磁化强度 $M_s(T)$ 的存在是由于这种强大的量子力学交换相互作用。$M_s(T)$ 的行为由这个巨大的内部场的有序化效应与热能 $k_B T$ 的无序化效应之间的平衡所决定。因此，是交换场的标度，而非任何典型外部实验室场的标度，主要决定了自发磁化强度对温度的依赖性。", "answer": "$$\n\\boxed{44.7}\n$$", "id": "2865526"}, {"introduction": "除了从微观相互作用出发，我们还可以从宏观热力学的角度，利用朗道相变理论来描述磁相变。该理论基于对称性，将自由能 $F$ 展开为序参量（在此为磁化强度 $M$）的多项式，并通过最小化自由能来预测体系在临界温度 $T_C$ 附近的平衡行为。通过这个练习，你将学会如何运用朗道理论推导自发磁化和磁化率的温度依赖性，并联系实验可测量来确定理论中的唯象参数，这是连接理论模型与实验数据的关键技能 [@problem_id:1808228]。", "problem": "一位材料物理学家正在研究一种新合成的铁磁材料，该材料表现出从顺磁态到铁磁态的二阶相变。基于对称性论证，该物理学家使用朗道展开，将材料在其临界温度 $T_C$ 附近的亥姆霍兹自由能密度 $F$ 建模为磁化强度 $M$ 和温度 $T$ 的函数：\n$$F(M, T) = F_0(T) + a(T - T_C)M^2 + bM^4$$\n其中 $F_0(T)$ 是自由能的非磁性部分，而 $a$ 和 $b$ 是该材料特有的正的常数。该系统处于热平衡状态，因此其磁化强度将取使自由能最小化的值。\n\n在没有任何外磁场的情况下，进行了两个关键实验：\n1.  将材料冷却到温度 $T_1 = T_C - \\Delta T$，其中 $\\Delta T$ 是一个小的正温差。在此温度下，测得自发磁化强度的大小为 $M_1$。\n2.  使用相同的温度偏移 $\\Delta T$，将材料加热到温度 $T_2 = T_C + \\Delta T$。在此温度下，测得零场磁化率（定义为 $\\chi = \\left( \\frac{\\partial M}{\\partial H} \\right)_{H=0}$）为 $\\chi_2$。\n\n你的任务是确定材料常数 $b$ 的表达式，用测量量 $M_1$ 和 $\\chi_2$ 来表示。", "solution": "在固定温度和零外场下，平衡磁化强度使朗道自由能密度最小化。平稳条件由下式得出：\n$$\n\\frac{\\partial F}{\\partial M}=2a(T-T_{C})M+4bM^{3}=0.\n$$\n这给出了 $M=0$ 或 $M^{2}=-\\frac{a(T-T_{C})}{2b}=\\frac{a(T_{C}-T)}{2b}$ 的解。\n对于 $T<T_{C}$，存在非零解，且该解对应一个最小值，因为\n$$\n\\frac{\\partial^{2}F}{\\partial M^{2}}=2a(T-T_{C})+12bM^{2}=2a(T-T_{C})+12b\\left(\\frac{a(T_{C}-T)}{2b}\\right)=4a(T_{C}-T)>0,\n$$\n考虑到 $a>0$ 且 $T<T_{C}$。因此，在 $T_{1}=T_{C}-\\Delta T$ 时，\n$$\nM_{1}^{2}=\\frac{a\\Delta T}{2b}.\n$$\n\n为了将高于 $T_{C}$ 的磁化率与 $a$ 联系起来，通过自由能中的耦合项 $-HM$ 引入一个小的外磁场。最小化给出了状态方程\n$$\nH=2a(T-T_{C})M+4bM^{3}.\n$$\n零场磁化率为\n$$\n\\chi=\\left(\\frac{\\partial M}{\\partial H}\\right)_{H=0}=\\left[\\frac{\\partial H}{\\partial M}\\right]_{M=0}^{-1}=\\left[2a(T-T_{C})\\right]^{-1}.\n$$\n在 $T_{2}=T_{C}+\\Delta T$ 时，这得到\n$$\n\\chi_{2}=\\frac{1}{2a\\Delta T}\\quad\\Longrightarrow\\quad a\\Delta T=\\frac{1}{2\\chi_{2}}.\n$$\n将此代入 $M_{1}^{2}$ 的表达式中，\n$$\nM_{1}^{2}=\\frac{a\\Delta T}{2b}=\\frac{1}{4b\\chi_{2}},\n$$\n由此可解得 $b$ 为\n$$\nb=\\frac{1}{4\\chi_{2}M_{1}^{2}}.\n$$", "answer": "$$\\boxed{\\frac{1}{4\\,\\chi_{2}\\,M_{1}^{2}}}$$", "id": "1808228"}, {"introduction": "在低温区，平均场理论的预测与实验出现偏差，此时更为精确的描述来自于自旋波理论。该理论将系统偏离完全有序基态的低能激发看作是准粒子——即磁振子（magnons）的集合。本综合性实践将理论推导与计算数据分析相结合，你将首先从物理第一性原理出发，建立磁化强度随温度变化的 $T^{3/2}$ 律系数与自旋波刚度 $D$ 之间的定量关系。随后，你将编写程序来拟合模拟的实验数据，从而提取出关键物理参数 $D$ 及其不确定度，完整地体验从理论建模到数据分析的现代物理学研究全过程 [@problem_id:2865514]。", "problem": "您的任务是开发一个完整的程序，根据低温自发磁化数据对自旋波刚度进行有原则的推断。您的程序必须实现物理约束模型和统计上可靠的不确定性量化。目标是将三维各向同性铁磁体的低温自发磁化数据 $M_s(T)$ 拟合到低温展开式，并从拟合系数中提取自旋波刚度，同时通过不确定性传播获得其置信区间。\n\n在您的推导和算法设计中，请使用以下基本依据：\n- 各向同性铁磁体中的自旋波激发具有长波色散关系 $\\epsilon_{\\mathbf{k}} = D k^2$，其中 $D$ 是自旋波刚度，$k = \\lvert \\mathbf{k} \\rvert$。\n- 玻色子的玻色-爱因斯坦分布 (BED) 为 $n_{\\mathbf{k}} = 1/\\left(\\exp(\\beta \\epsilon_{\\mathbf{k}}) - 1\\right)$，其中 $\\beta = 1/(k_{\\mathrm{B}} T)$，$k_{\\mathrm{B}}$ 是玻尔兹曼常数。\n- 每个磁振子使磁化强度减少 $g \\mu_{\\mathrm{B}}$，其中 $g$ 是朗德 $g$ 因子，$\\mu_{\\mathrm{B}}$ 是玻尔磁子；总减少量由在连续谱极限 $\\int d^3 k/(2\\pi)^3$ 下计算的磁振子数密度给出。\n- 在低温下，对 $M_s(T)$ 的主要修正项与 $T^{3/2}$ 成正比；由于磁振子-磁振子相互作用和其他高阶效应，次要修正项可能以 $T^{5/2}$ 的阶数出现。\n\n基于此，推导出低温下的形式\n- $M_s(T) = M_s(0) - A\\,T^{3/2} - B\\,T^{5/2}$（对于足够小的 $T$），\n- 以及一个由色散关系和BED导出、不依赖任何经验捷径的 $A$ 和 $D$ 之间的关系。\n\n然后实现以下计算过程：\n- 使用普通最小二乘法，在独立、同方差高斯噪声的假设下，将测量值 $\\{(T_i, M_i)\\}$ 拟合到 $M_i \\approx M_s(0) - A T_i^{3/2} - B T_i^{5/2}$。从线性回归的正规方程中估计 $M_s(0)$、$A$ 和 $B$ 及其协方差矩阵。\n- 使用您推导的解析关系 $D = f(A)$，从拟合系数 $\\hat{A}$ 计算估计值 $\\hat{D}$。使用一阶误差传播（德尔塔方法）将 $\\hat{A}$ 的不确定性传播到 $\\hat{D}$，以获得一个 95% 置信区间。使用自由度为 $\\nu = N - p$ 的学生 $t$ 分布的分位数，其中 $N$ 是数据点数，$p = 3$ 是拟合参数的数量。\n\n常数和单位：\n- 使用国际单位制 (SI)。取 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$，$\\mu_{\\mathrm{B}} = 9.2740100783 \\times 10^{-24}\\,\\mathrm{A \\cdot m^2}$，且 $g = 2.0$。所有磁化强度 $M_s$ 的单位为 $\\mathrm{A/m}$，温度 $T$ 的单位为 $\\mathrm{K}$，而 $D$ 必须以 $\\mathrm{J \\cdot m^2}$ 报告。\n\n测试套件规范：\n- 您的程序必须内部生成三个使用模型 $M_s(T) = M_s(0) - A_{\\mathrm{true}} T^{3/2} - B_{\\mathrm{true}} T^{5/2} + \\varepsilon$（$\\varepsilon \\sim \\mathcal{N}(0,\\sigma^2)$ 为独立高斯噪声）的合成数据集。对于每种情况，使用列出的 $D_{\\mathrm{true}}$ 和您推导的 $A$-$D$ 关系计算 $A_{\\mathrm{true}}$。这三种情况是：\n  - 情况 1 (一般“顺利路径”)：$M_s(0) = 1.70 \\times 10^6\\,\\mathrm{A/m}$，$D_{\\mathrm{true}} = 4.5 \\times 10^{-40}\\,\\mathrm{J \\cdot m^2}$，$B_{\\mathrm{true}} = 2.0 \\times 10^{-2}\\,\\mathrm{A \\cdot m^{-1} \\cdot K^{-5/2}}$，$T \\in [2,20]\\,\\mathrm{K}$，$N=25$ 个均匀间隔点，噪声标准差 $\\sigma = 50\\,\\mathrm{A/m}$，随机种子 $12345$。\n  - 情况 2 (可忽略的次要项)：$M_s(0) = 8.00 \\times 10^5\\,\\mathrm{A/m}$，$D_{\\mathrm{true}} = 6.0 \\times 10^{-40}\\,\\mathrm{J \\cdot m^2}$，$B_{\\mathrm{true}} = 0$，$T \\in [2,12]\\,\\mathrm{K}$，$N=20$，$\\sigma = 30\\,\\mathrm{A/m}$，种子 $24680$。\n  - 情况 3 (边界：极低 $T$ 窗口和较大噪声)：$M_s(0) = 1.40 \\times 10^6\\,\\mathrm{A/m}$，$D_{\\mathrm{true}} = 3.0 \\times 10^{-40}\\,\\mathrm{J \\cdot m^2}$，$B_{\\mathrm{true}} = 1.0 \\times 10^{-2}\\,\\mathrm{A \\cdot m^{-1} \\cdot K^{-5/2}}$，$T \\in [2,6]\\,\\mathrm{K}$，$N=6$，$\\sigma = 80\\,\\mathrm{A/m}$，种子 $13579$。\n\n统计估计要求：\n- 通过最小化参数为 $M_s(0)$、$A$、$B$ 的线性模型的残差平方和，计算普通最小二乘估计值。\n- 将参数协方差矩阵估计为 $\\hat{\\sigma}^2 (X^\\top X)^{-1}$，其中 $\\hat{\\sigma}^2 = \\mathrm{RSS}/(N-p)$，$X$ 是设计矩阵，$\\mathrm{RSS}$ 是残差平方和。\n\n不确定性传播和置信区间：\n- 令 $\\hat{D} = f(\\hat{A})$ 为您的物理推导所暗示的 $D$ 的估计量。使用德尔塔方法 $\\mathrm{Var}[\\hat{D}] \\approx (f'(\\hat{A}))^2 \\mathrm{Var}[\\hat{A}]$ 和一个双侧 95%-置信区间 $\\hat{D} \\pm t_{0.975,\\nu} \\sqrt{\\mathrm{Var}[\\hat{D}]}$，其中 $\\nu = N-p$。\n\n最终输出格式：\n- 您的程序必须生成一行输出，其中包含一个含三个列表的列表，每个内部列表对应一种情况，按情况 1、2、3 的顺序排列。每个内部列表必须是 $[\\hat{D}, D_{\\mathrm{low}}, D_{\\mathrm{high}}]$ 的形式，所有三个值的单位都是 $\\mathrm{J \\cdot m^2}$。所有数字均用包含 6 位有效数字的科学记数法表示。确切要求的格式为单行：\n\"[[d1,d1_lo,d1_hi],[d2,d2_lo,d2_hi],[d3,d3_lo,d3_hi]]\"\n不含空格 (例如：\"[[1.234000e-03,1.000000e-03,1.468000e-03],[...],[...]]\")。", "solution": "该问题陈述已经过严格验证，并被确定为有效。它在科学上植根于固态物理学原理，特别是铁磁体中的磁振子理论。该问题提法明确，为理论推导和计算实现提供了一套完整且一致的要求。其语言客观而精确。因此，我将提供完整的解决方案。\n\n解决方案分为两部分：首先，是自旋波刚度与低温磁化强度中 $T^{3/2}$ 项系数之间关系的必要理论推导；其次，是实现统计分析的计算方法纲要。\n\n**1. 理论推导**\n\n铁磁体在有限温度 $T$ 下的自发磁化强度 $M_s(T)$ 相对于其在绝对零度下的饱和值 $M_s(0)$ 有所降低，这是由于磁振子（即自旋波的量子）的热激发所致。每个磁振子携带的自旋与净磁化方向相反，在最简单的模型中，它的产生会使总磁矩减少 $g \\mu_{\\mathrm{B}}$，其中 $g$ 是朗德g因子，$\\mu_{\\mathrm{B}}$ 是玻尔磁子。\n\n磁化强度的总减少量 $\\Delta M_s(T) = M_s(0) - M_s(T)$ 与磁振子数密度 $n_{\\text{mag}}$ 成正比。\n$$\n\\Delta M_s(T) = g \\mu_{\\mathrm{B}} n_{\\text{mag}}\n$$\n磁振子数密度是通过对第一布里渊区内所有波矢 $\\mathbf{k}$ 的玻色-爱因斯坦分布函数 $n_{\\mathbf{k}}$ 进行积分来计算的。在低温下，只有长波磁振子被显著占据，因此积分可以扩展到整个k空间，并且晶格结构可以被连续谱取代。\n$$\nn_{\\text{mag}} = \\int_{\\mathbb{R}^3} \\frac{d^3k}{(2\\pi)^3} n_{\\mathbf{k}} = \\int_{\\mathbb{R}^3} \\frac{d^3k}{(2\\pi)^3} \\frac{1}{\\exp(\\beta \\epsilon_{\\mathbf{k}}) - 1}\n$$\n其中 $\\beta = 1/(k_{\\mathrm{B}}T)$，$\\epsilon_{\\mathbf{k}}$ 是磁振子色散关系。对于各向同性铁磁体，长波色散是二次的：$\\epsilon_{\\mathbf{k}} = Dk^2$，其中 $D$ 是自旋波刚度， $k = |\\mathbf{k}|$。\n\n为了计算该积分，我们转换到k空间中的球坐标，其体积元为 $d^3k = 4\\pi k^2 dk$。\n$$\nn_{\\text{mag}} = \\frac{4\\pi}{(2\\pi)^3} \\int_{0}^{\\infty} \\frac{k^2}{\\exp(\\beta D k^2) - 1} dk = \\frac{1}{2\\pi^2} \\int_{0}^{\\infty} \\frac{k^2}{\\exp(\\beta D k^2) - 1} dk\n$$\n我们进行变量替换。令 $x = \\beta D k^2$。则 $k = (x/\\beta D)^{1/2}$ 且 $dk = \\frac{1}{2}(x\\beta D)^{-1/2} dx$。\n将这些代入积分中得到：\n$$\nn_{\\text{mag}} = \\frac{1}{2\\pi^2} \\int_{0}^{\\infty} \\frac{x}{\\beta D} \\frac{1}{e^x - 1} \\frac{1}{2\\sqrt{\\beta D}} \\frac{1}{\\sqrt{x}} dx\n= \\frac{1}{4\\pi^2 (\\beta D)^{3/2}} \\int_{0}^{\\infty} \\frac{x^{1/2}}{e^x - 1} dx\n$$\n该积分是与黎曼zeta函数 $\\zeta(s)$ 和伽马函数 $\\Gamma(s)$ 相关的标准形式：\n$$\n\\int_{0}^{\\infty} \\frac{x^{s-1}}{e^x - 1} dx = \\Gamma(s)\\zeta(s)\n$$\n对于我们的积分，$s-1 = 1/2$，这意味着 $s = 3/2$。相关值为 $\\Gamma(3/2) = \\sqrt{\\pi}/2$ 和 $\\zeta(3/2)$。$\\zeta(3/2)$ 的值约为 $2.612375$。\n该积分计算结果为 $\\Gamma(3/2)\\zeta(3/2) = \\zeta(3/2)\\sqrt{\\pi}/2$。将其代回：\n$$\nn_{\\text{mag}} = \\frac{1}{4\\pi^2 (\\beta D)^{3/2}} \\left( \\frac{\\sqrt{\\pi}}{2} \\zeta(3/2) \\right) = \\frac{\\zeta(3/2)}{8\\pi^{3/2}} (\\beta D)^{-3/2}\n$$\n现在，代入 $\\beta = 1/(k_{\\mathrm{B}}T)$:\n$$\nn_{\\text{mag}} = \\frac{\\zeta(3/2)}{8\\pi^{3/2}} \\left(\\frac{D}{k_{\\mathrm{B}}T}\\right)^{-3/2} = \\frac{\\zeta(3/2)}{8\\pi^{3/2}} \\left(\\frac{k_{\\mathrm{B}}T}{D}\\right)^{3/2}\n$$\n磁化强度的减少量为：\n$$\n\\Delta M_s(T) = g \\mu_{\\mathrm{B}} \\frac{\\zeta(3/2)}{8\\pi^{3/2}} \\left(\\frac{k_{\\mathrm{B}}}{D}\\right)^{3/2} T^{3/2}\n$$\n这就是著名的布洛赫 $T^{3/2}$ 定律。问题陈述给出的低温展开式为 $M_s(T) = M_s(0) - A T^{3/2} - B T^{5/2}$。比较领头项，我们确定系数 $A$：\n$$\nA = g \\mu_{\\mathrm{B}} \\frac{\\zeta(3/2)}{8\\pi^{3/2}} \\left(\\frac{k_{\\mathrm{B}}}{D}\\right)^{3/2} = g \\mu_{\\mathrm{B}} \\zeta(3/2) \\left(\\frac{k_{\\mathrm{B}}}{4\\pi D}\\right)^{3/2}\n$$\n这就是 $A$ 和 $D$ 之间的关系。为了对 $D$ 进行推断，我们需要将 $D$ 表示为 $A$ 的函数，即 $D = f(A)$。反转该关系可得：\n$$\nD^{3/2} = g \\mu_{\\mathrm{B}} \\zeta(3/2) \\left(\\frac{k_{\\mathrm{B}}}{4\\pi}\\right)^{3/2} A^{-1}\n$$\n$$\nD = \\left( g \\mu_{\\mathrm{B}} \\zeta(3/2) \\left(\\frac{k_{\\mathrm{B}}}{4\\pi}\\right)^{3/2} A^{-1} \\right)^{2/3} = \\left( g \\mu_{\\mathrm{B}} \\zeta(3/2) \\right)^{2/3} \\frac{k_{\\mathrm{B}}}{4\\pi} A^{-2/3}\n$$\n这就是所要求的解析关系 $D = f(A)$。此推导为后续的数据分析提供了物理基础。\n\n**2. 计算方法**\n\n分析过程是通过将实验数据 $\\{(T_i, M_i)\\}$ 拟合到模型 $M_s(T) = M_s(0) - AT^{3/2} - BT^{5/2}$ 来进行的。这是一个多元线性回归问题。\n\n**a. 线性模型构建：**\n该模型可以表达为矩阵形式 $\\mathbf{y} = X\\mathbf{\\beta} + \\mathbf{\\epsilon}$。\n- 响应向量 $\\mathbf{y}$ 包含磁化强度测量值，$y_i = M_i$。\n- 参数矢量为 $\\mathbf{\\beta} = [M_s(0), A, B]^\\top$。\n- 设计矩阵 $X$ 有 $N$ 行（对应 $N$ 个数据点）和 $p=3$ 列。第 $i$ 行为 $[1, -T_i^{3/2}, -T_i^{5/2}]$。\n- $\\mathbf{\\epsilon}$ 是未观测到的随机误差向量，假设其独立同分布于 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。\n\n**b. 参数估计：**\n参数矢量的普通最小二乘 (OLS) 估计 $\\hat{\\mathbf{\\beta}}$ 通过求解正规方程得到：\n$$\n\\hat{\\mathbf{\\beta}} = (X^\\top X)^{-1} X^\\top \\mathbf{y}\n$$\n这会产生估计值 $\\hat{M}_s(0)$、$\\hat{A}$ 和 $\\hat{B}$。\n\n**c. 不确定性量化：**\n估计参数的协方差矩阵由 $\\mathrm{Cov}(\\hat{\\mathbf{\\beta}}) = \\sigma^2 (X^\\top X)^{-1}$ 给出。由于 $\\sigma^2$ 未知，我们根据残差来估计它。\n- 残差：$\\mathbf{r} = \\mathbf{y} - X\\hat{\\mathbf{\\beta}}$\n- 残差平方和 (RSS)：$\\mathrm{RSS} = \\mathbf{r}^\\top\\mathbf{r}$\n- $\\sigma^2$ 的无偏估计量：$\\hat{\\sigma}^2 = \\frac{\\mathrm{RSS}}{N-p}$\n估计的协方差矩阵为 $\\widehat{\\mathrm{Cov}}(\\hat{\\mathbf{\\beta}}) = \\hat{\\sigma}^2 (X^\\top X)^{-1}$。我们关心的系数 $\\hat{A}$ 的方差是该矩阵的第二个对角元素，$\\mathrm{Var}(\\hat{A}) = [\\widehat{\\mathrm{Cov}}(\\hat{\\mathbf{\\beta}})]_{1,1}$ (使用从0开始的索引)。\n\n**d. 误差传播 (德尔塔方法)：**\n我们使用推导出的函数来估计自旋波刚度：$\\hat{D} = f(\\hat{A})$。为了找到 $\\hat{D}$ 的不确定性，我们使用一阶泰勒展开（德尔塔方法）：\n$$\n\\mathrm{Var}(\\hat{D}) \\approx \\left( \\frac{df}{dA} \\bigg|_{A=\\hat{A}} \\right)^2 \\mathrm{Var}(\\hat{A})\n$$\n所需的导数为：\n$$\n\\frac{df}{dA} = \\frac{d}{dA} \\left( C A^{-2/3} \\right) = C \\left(-\\frac{2}{3}\\right) A^{-5/3} = -\\frac{2}{3} \\frac{C A^{-2/3}}{A} = -\\frac{2}{3}\\frac{D}{A}\n$$\n其中 $C$ 是 $D$ 表达式中的常数项。\n因此，估计的方差为 $\\mathrm{Var}(\\hat{D}) \\approx \\left(-\\frac{2}{3}\\frac{\\hat{D}}{\\hat{A}}\\right)^2 \\mathrm{Var}(\\hat{A})$。标准误差为 $\\mathrm{SE}(\\hat{D}) = \\sqrt{\\mathrm{Var}(\\hat{D})}$。\n\n**e. 置信区间：**\n由于 $\\sigma^2$ 是估计出来的，我们使用t分布来构建 $D$ 的双侧 $95\\%$ 置信区间。自由度为 $\\nu = N-p = N-3$。\n$$\n\\text{CI}_{95\\%}(D) = \\hat{D} \\pm t_{1-0.05/2, \\nu} \\cdot \\mathrm{SE}(\\hat{D})\n$$\n其中 $t_{0.975, \\nu}$ 是具有 $\\nu$ 个自由度的学生t分布的上临界值。此过程将对问题规范中提供的每个合成数据集实施。", "answer": "```python\nimport numpy as np\nfrom scipy.special import zeta as riemann_zeta\nfrom scipy.stats import t as t_distribution\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the final result.\n    \"\"\"\n    # Physical constants in SI units\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    MU_B = 9.2740100783e-24  # Bohr magneton in A*m^2\n    G_FACTOR = 2.0  # Landé g-factor\n    ZETA_3_2 = riemann_zeta(1.5)  # Riemann zeta function at 3/2\n\n    # Pre-calculate the constant factor connecting D and A\n    # D = (C/A)^(2/3), where C = G_FACTOR * MU_B * ZETA_3_2 * (K_B / (4 * np.pi))**(3/2)\n    CONSTANT_DA = G_FACTOR * MU_B * ZETA_3_2 * (K_B / (4 * np.pi))**(1.5)\n\n    def d_from_a(a_val):\n        \"\"\"Computes spin-wave stiffness D from coefficient A.\"\"\"\n        return (CONSTANT_DA / a_val)**(2.0 / 3.0)\n\n    def a_from_d(d_val):\n        \"\"\"Computes coefficient A from spin-wave stiffness D.\"\"\"\n        return CONSTANT_DA / (d_val**(1.5))\n\n    def process_case(m0_true, d_true, b_true, t_range, n_points, sigma, seed):\n        \"\"\"\n        Analyzes a single synthetic dataset to infer D and its confidence interval.\n        \"\"\"\n        # 1. Generate synthetic data\n        a_true = a_from_d(d_true)\n        rng = np.random.default_rng(seed)\n        t_values = np.linspace(t_range[0], t_range[1], n_points)\n        \n        m_true = m0_true - a_true * t_values**1.5 - b_true * t_values**2.5\n        noise = rng.normal(0, sigma, n_points)\n        m_observed = m_true + noise\n\n        # 2. Perform Ordinary Least Squares regression\n        # The model is M = M0 - A*T^1.5 - B*T^2.5, which is linear in parameters M0, A, B.\n        # M = beta_0 * 1 + beta_1 * (-T^1.5) + beta_2 * (-T^2.5)\n        # where beta = [M0, A, B]^T.\n        x0 = np.ones(n_points)\n        x1 = -t_values**1.5\n        x2 = -t_values**2.5\n        X = np.stack([x0, x1, x2], axis=1)\n        y = m_observed\n\n        # Solve normal equations: beta_hat = (X.T @ X)^-1 @ X.T @ y\n        try:\n            XTX_inv = np.linalg.inv(X.T @ X)\n        except np.linalg.LinAlgError:\n            # Handle cases of singular matrix, which might occur with very few points\n            # or extreme collinearity, although unlikely with given test cases.\n            return [np.nan, np.nan, np.nan]\n            \n        beta_hat = XTX_inv @ X.T @ y\n        m0_hat, a_hat, b_hat = beta_hat[0], beta_hat[1], beta_hat[2]\n\n        # 3. Estimate parameter uncertainties\n        num_params = 3\n        dof = n_points - num_params\n        residuals = y - X @ beta_hat\n        rss = np.sum(residuals**2)\n        sigma_sq_hat = rss / dof\n        \n        cov_beta = sigma_sq_hat * XTX_inv\n        var_a_hat = cov_beta[1, 1]\n\n        # 4. Propagate uncertainty to D using the delta method\n        if a_hat <= 0:  # Physically non-sensical, would lead to complex D\n            return [np.nan, np.nan, np.nan]\n        \n        d_hat = d_from_a(a_hat)\n        \n        # Derivative of D = f(A) is f'(A) = -2/3 * D/A\n        deriv_d_a = - (2.0 / 3.0) * d_hat / a_hat\n        var_d_hat = (deriv_d_a**2) * var_a_hat\n        se_d_hat = np.sqrt(var_d_hat)\n\n        # 5. Calculate the 95% confidence interval\n        # Use Student's t-distribution as sigma was estimated\n        t_crit = t_distribution.ppf(0.975, df=dof)\n        ci_margin = t_crit * se_d_hat\n        d_low = d_hat - ci_margin\n        d_high = d_hat + ci_margin\n\n        return [d_hat, d_low, d_high]\n\n    # Test cases as specified in the problem\n    test_cases = [\n        # Case 1: General \"happy path\"\n        (1.70e6, 4.5e-40, 2.0e-2, (2, 20), 25, 50.0, 12345),\n        # Case 2: Negligible subleading term\n        (8.00e5, 6.0e-40, 0.0, (2, 12), 20, 30.0, 24680),\n        # Case 3: Boundary (low T, few points, high noise)\n        (1.40e6, 3.0e-40, 1.0e-2, (2, 6), 6, 80.0, 13579),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = process_case(*case)\n        results.append(result)\n\n    # Format the output string as per requirement\n    # \"[[d1,d1_lo,d1_hi],[d2,d2_lo,d2_hi],[d3,d3_lo,d3_hi]]\" with scientific notation and 6 sig figs.\n    # The format specifier {:.5e} provides 1 digit before and 5 after the decimal point.\n    def format_val(v):\n        return f\"{v:.5e}\"\n        \n    inner_strings = []\n    for res in results:\n        formatted_res = [format_val(v) for v in res]\n        inner_strings.append(f\"[{','.join(formatted_res)}]\")\n    \n    final_output = f\"[{','.join(inner_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2865514"}]}