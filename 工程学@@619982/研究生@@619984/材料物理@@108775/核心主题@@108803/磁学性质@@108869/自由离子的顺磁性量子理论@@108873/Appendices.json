{"hands_on_practices": [{"introduction": "要真正掌握自由离子的顺磁性理论，我们必须能够从离子的电子组态一直推导到其宏观磁响应。本练习将引导你完成这一关键过程，从应用洪特 (Hund) 规则确定一个多电子离子的基态谱项 (${}^{2S+1}L_J$) 开始。然后，你将推导出朗德 (Landé) $g_J$ 因子和居里 (Curie) 常数，从而将微观的角动量量子数与可测量的宏观量直接联系起来。[@problem_id:2854626]", "problem": "一种稀顺磁盐包含无相互作用的自由离子，其电子构型为 $4f^9$ 。假设为 Russell-Saunders (LS) 耦合，且任何晶体电场与原子内相互作用相比都可以忽略不计。考虑高温、弱场体系，其中 $k_B T$ 远大于基态 $J$-多重态内的 Zeeman 分裂，但远小于到激发 $J$-多重态的能量间隔（因此只有基态 ${}^{2S+1}L_J$ 多重态对顺磁性有贡献）。\n\n从自由离子的第一性原理出发：\n- 使用 Hund 规则确定 $4f^9$ 构型的基态谱项符号 ${}^{2S+1}L_J$ 。清楚地确定 $S$、$L$ 和 $J$ 的值，并解释“大半充满”壳层与“小半充满”壳层在决定 $J$ 时的作用。\n- 从轨道和自旋磁矩与弱磁场的 Zeeman 耦合以及 LS 耦合的角动量代数出发，推导你找到的基态多重态的 Landé 因子 $g_J$ 。\n- 利用总角动量为 $J$ 的多重态在弱磁场中的平衡统计力学和摩尔磁化率的 Curie 定律，推导摩尔 Curie 常数 $C_m$（用 $J$ 和 $g_J$ 表示）。然后代入你求出的特定 $J$ 和 $g_J$ 值，得到一个仅依赖于普适常数的简化闭合形式表达式。\n\n将摩尔 Curie 常数的最终答案以国际单位制（SI）单位 $\\mathrm{m^3 \\, K \\, mol^{-1}}$ 表示，写成一个由自由空间磁导率 $\\mu_0$、Bohr 磁子 $\\mu_B$、Boltzmann 常数 $k_B$ 和 Avogadro 常数 $N_A$ 组成的单一闭合形式解析表达式。不要进行数值计算。你的最终答案必须是指定的单一表达式。", "solution": "在尝试任何解答之前，对问题陈述进行验证。\n\n逐字提取已知条件：\n- 系统：一种包含无相互作用自由离子的稀顺磁盐。\n- 电子构型：$4f^9$。\n- 耦合方案：Russell-Saunders (LS) 耦合。\n- 晶体电场：与原子内相互作用相比可忽略不计。\n- 体系：高温、弱场。\n- 条件1：$k_B T$ 远大于 Zeeman 分裂。\n- 条件2：$k_B T$ 远小于到激发 $J$-多重态的能量间隔。\n- 目标1：使用 Hund 规则确定基态谱项符号 ${}^{2S+1}L_J$。\n- 目标2：推导 Landé 因子 $g_J$。\n- 目标3：推导摩尔 Curie 常数 $C_m$。\n- 最终答案格式：$C_m$ 以国际单位制（SI）单位（$\\mathrm{m^3 \\, K \\, mol^{-1}}$）表示，写成一个由 $\\mu_0$、$\\mu_B$、$k_B$ 和 $N_A$ 组成的闭合形式解析表达式。\n\n验证结论：\n此问题有效。这是一个在磁性量子理论（材料物理学的一个子领域）中的标准、适定问题。它在科学上基于量子力学和统计力学的既定原理，包括 Hund 规则、LS 耦合、Zeeman 效应以及 Curie 定律的推导。所提供的假设（无相互作用离子、可忽略的晶体场、特定的温度范围）是使问题能够解析处理的标准理想化条件。该问题是自洽的、客观的，并且没有任何科学或逻辑上的缺陷。\n\n现在提供完整解答。\n\n该问题需要通过三部分推导来求出电子构型为 $4f^9$ 的自由离子的摩尔 Curie 常数。\n\n第1部分：使用 Hund 规则确定基态谱项符号 ${}^{2S+1}L_J$。\n\n电子构型为 $4f^9$。对于 $f$ 亚壳层，轨道角动量量子数为 $l=3$。该亚壳层有 $2l+1 = 2(3)+1 = 7$ 个轨道，对应磁量子数 $m_l = -3, -2, -1, 0, 1, 2, 3$。一个全满的 $f$ 亚壳层包含 $2(2l+1) = 14$ 个电子。构型 $4f^9$ 代表一个“大半充满”壳层，因为 $9 > 7$。\n\nHund 第一规则：总自旋 $S$ 最大化。\n为了最大化 $S$，我们首先用自旋向上的电子填充这 7 个可用轨道。这占据了 7 个电子。根据 Pauli 不相容原理，剩下的 $9-7=2$ 个电子必须以自旋向下的方式从 $m_l$ 值最高的轨道开始填充。\n总自旋投影为 $M_S = \\sum m_s = 7 \\times (+\\frac{1}{2}) + 2 \\times (-\\frac{1}{2}) = \\frac{7}{2} - 1 = \\frac{5}{2}$。\n总自旋量子数为 $S = M_{S,max} = \\frac{5}{2}$。\n自旋多重度为 $2S+1 = 2(\\frac{5}{2}) + 1 = 6$。\n\nHund 第二规则：对于给定的 $S$，总轨道角动量 $L$ 最大化。\n对于大半充满的壳层，总轨道角动量 $L$ 与全满壳层中的“空穴”的 $L$ 相同。空穴数为 $14-9=5$。因此，我们求解 $4f^5$ 构型的基态谱项。对于 5 个电子，为了最大化 $S$，它们必须全部自旋向上 ($S=5/2$)。为了最大化 $L$，这 5 个电子被放置在 $m_l$ 值最高的轨道中：$m_l = 3, 2, 1, 0, -1$。\n总轨道投影为 $M_L = \\sum m_l = 3+2+1+0+(-1) = 5$。\n总轨道角动量量子数为 $L = M_{L,max} = 5$。$L=5$ 对应的光谱学字母为 H。\n\nHund 第三规则：确定总角动量 $J$。\n$J$ 的取值取决于壳层是小半充满 ($J=|L-S|$) 还是大半充满 ($J=L+S$)。\n对于 $4f^9$ 构型，壳层是大半充满的。\n因此，$J = L+S = 5 + \\frac{5}{2} = \\frac{15}{2}$。\n\n因此，基态谱项符号 ${}^{2S+1}L_J$ 为 ${}^{6}H_{15/2}$。量子数为 $S=5/2$，$L=5$ 和 $J=15/2$。\n\n第2部分： Landé $g$-因子, $g_J$的推导。\n\n离子的磁矩算符 $\\boldsymbol{\\mu}$ 是其轨道磁矩和自旋磁矩之和：\n$$ \\boldsymbol{\\mu} = \\boldsymbol{\\mu}_L + \\boldsymbol{\\mu}_S = -\\frac{\\mu_B}{\\hbar} (\\mathbf{L} + g_s \\mathbf{S}) $$\n其中 $\\mu_B$ 是 Bohr 磁子，$g_s \\approx 2.0023$ 是电子自旋 $g$-因子，我们近似取 $g_s=2$。\n在 Russell-Saunders 耦合方案中，对于弱磁场，状态由总角动量 $\\mathbf{J} = \\mathbf{L} + \\mathbf{S}$ 表征。Wigner-Eckart 定理意味着在 $J$ 恒定的流形内，磁矩算符有效地正比于总角动量算符 $\\mathbf{J}$：\n$$ \\boldsymbol{\\mu}_{eff} = -g_J \\frac{\\mu_B}{\\hbar} \\mathbf{J} $$\n比例常数 $g_J$ 就是 Landé $g$-因子。我们可以通过将 $\\boldsymbol{\\mu}$ 投影到 $\\mathbf{J}$ 上来求得它：\n$$ g_J \\frac{\\mu_B}{\\hbar} \\mathbf{J} = \\frac{(\\boldsymbol{\\mu} \\cdot \\mathbf{J})}{\\mathbf{J}^2} \\mathbf{J} = \\frac{\\mu_B}{\\hbar} \\frac{((\\mathbf{L} + 2\\mathbf{S}) \\cdot (\\mathbf{L}+\\mathbf{S}))}{\\mathbf{J}^2} \\mathbf{J} $$\n这得到 $g_J = \\frac{\\mathbf{L}^2 + 2\\mathbf{S}^2 + 3\\mathbf{L} \\cdot \\mathbf{S}}{\\mathbf{J}^2}$。使用关系式 $\\mathbf{L} \\cdot \\mathbf{S} = \\frac{1}{2}(\\mathbf{J}^2 - \\mathbf{L}^2 - \\mathbf{S}^2)$，我们代入并化简：\n$$ g_J = \\frac{\\mathbf{L}^2 + 2\\mathbf{S}^2 + \\frac{3}{2}(\\mathbf{J}^2 - \\mathbf{L}^2 - \\mathbf{S}^2)}{\\mathbf{J}^2} = \\frac{\\frac{3}{2}\\mathbf{J}^2 + \\frac{1}{2}\\mathbf{S}^2 - \\frac{1}{2}\\mathbf{L}^2}{\\mathbf{J}^2} $$\n将角动量平方算符替换为其本征值 $\\hbar^2 X(X+1)$，我们得到标准公式：\n$$ g_J = \\frac{3}{2} + \\frac{S(S+1) - L(L+1)}{2J(J+1)} = 1 + \\frac{J(J+1) + S(S+1) - L(L+1)}{2J(J+1)} $$\n现在，我们代入基态 ${}^{6}H_{15/2}$ 的值：$S=5/2$，$L=5$，$J=15/2$。\n- $S(S+1) = \\frac{5}{2}(\\frac{7}{2}) = \\frac{35}{4}$\n- $L(L+1) = 5(6) = 30 = \\frac{120}{4}$\n- $J(J+1) = \\frac{15}{2}(\\frac{17}{2}) = \\frac{255}{4}$\n将这些值代入 $g_J$ 的公式中：\n$$ g_J = 1 + \\frac{\\frac{255}{4} + \\frac{35}{4} - \\frac{120}{4}}{2 \\left(\\frac{255}{4}\\right)} = 1 + \\frac{255 + 35 - 120}{2 \\times 255} = 1 + \\frac{170}{510} = 1 + \\frac{1}{3} $$\n$$ g_J = \\frac{4}{3} $$\n\n第3部分：摩尔 Curie 常数 $C_m$ 的推导。\n\n在外磁场 $\\mathbf{B} = B\\hat{z}$ 中，Zeeman 哈密顿量将基态 $J$-多重态分裂为 $2J+1$ 个能级：\n$$ E_{M_J} = g_J \\mu_B B M_J $$\n其中 $M_J = -J, -J+1, \\dots, J$。\n单个离子的配分函数为 $Z = \\sum_{M_J=-J}^{J} \\exp(-\\frac{E_{M_J}}{k_B T})$。沿场方向的每个离子的平均磁矩为 $\\langle \\mu_z \\rangle = k_B T \\frac{\\partial \\ln Z}{\\partial B}$。\n令 $x = \\frac{g_J \\mu_B B}{k_B T}$。高温、弱场条件意味着 $x \\ll 1$。我们在配分函数中展开指数项：\n$$ Z = \\sum_{M_J=-J}^{J} \\exp(-x M_J) \\approx \\sum_{M_J=-J}^{J} \\left(1 - xM_J + \\frac{1}{2}x^2 M_J^2 \\right) $$\n求和结果为：$\\sum 1 = 2J+1$，$\\sum M_J = 0$，以及 $\\sum M_J^2 = \\frac{1}{3}J(J+1)(2J+1)$。\n$$ Z \\approx (2J+1) + \\frac{x^2}{2} \\frac{J(J+1)(2J+1)}{3} = (2J+1) \\left(1 + \\frac{x^2 J(J+1)}{6} \\right) $$\n取自然对数，并对小的 $y$ 使用近似 $\\ln(1+y) \\approx y$：\n$$ \\ln Z \\approx \\ln(2J+1) + \\frac{x^2 J(J+1)}{6} = \\ln(2J+1) + \\frac{(g_J \\mu_B)^2 J(J+1)}{6(k_B T)^2} B^2 $$\n现在我们计算平均磁矩：\n$$ \\langle \\mu_z \\rangle = k_B T \\frac{\\partial}{\\partial B} \\left( \\frac{(g_J \\mu_B)^2 J(J+1)}{6(k_B T)^2} B^2 \\right) = \\frac{(g_J \\mu_B)^2 J(J+1)}{3 k_B T} B $$\n磁化强度（单位体积的磁矩）为 $M = N_V \\langle \\mu_z \\rangle$，其中 $N_V$ 是离子的数密度。对于弱顺磁体，国际单位制中的磁化率为 $\\chi = \\mu_0 M/B$。\n$$ \\chi = \\mu_0 N_V \\frac{\\langle \\mu_z \\rangle}{B} = \\frac{\\mu_0 N_V (g_J \\mu_B)^2 J(J+1)}{3 k_B T} $$\n这具有 Curie 定律的形式，$\\chi=C/T$。摩尔磁化率 $\\chi_m$ 可通过将 $\\chi$ 乘以摩尔体积 $V_m = N_A/N_V$ 得到，其中 $N_A$ 是 Avogadro 常数。\n$$ \\chi_m = V_m \\chi = \\frac{N_A}{N_V} \\frac{\\mu_0 N_V (g_J \\mu_B)^2 J(J+1)}{3 k_B T} = \\frac{C_m}{T} $$\n因此，摩尔 Curie 常数 $C_m$ 为：\n$$ C_m = \\frac{\\mu_0 N_A (g_J \\mu_B)^2 J(J+1)}{3 k_B} $$\n这可以写成有效磁子数 $p_{eff} = g_J \\sqrt{J(J+1)}$ 的形式，即 $C_m = \\frac{\\mu_0 N_A \\mu_B^2}{3 k_B} p_{eff}^2$。\n\n最后，我们代入 $g_J$ 和 $J$ 的具体值：\n- $g_J = \\frac{4}{3}$\n- $J(J+1) = \\frac{255}{4}$\n有效磁子数的平方为：\n$$ p_{eff}^2 = g_J^2 J(J+1) = \\left(\\frac{4}{3}\\right)^2 \\left(\\frac{255}{4}\\right) = \\frac{16}{9} \\frac{255}{4} = \\frac{4 \\times 255}{9} = \\frac{4 \\times (3 \\times 85)}{9} = \\frac{4 \\times 85}{3} = \\frac{340}{3} $$\n将此结果代入 $C_m$ 的表达式中：\n$$ C_m = \\frac{\\mu_0 N_A \\mu_B^2}{3 k_B} \\left(\\frac{340}{3}\\right) = \\frac{340 \\mu_0 N_A \\mu_B^2}{9 k_B} $$\n该表达式即为所求的、以国际单位制表示的摩尔 Curie 常数的闭合形式结果。", "answer": "$$\n\\boxed{\\frac{340 \\mu_0 N_A \\mu_B^2}{9 k_B}}\n$$", "id": "2854626"}, {"introduction": "理论推导的价值在于其预测能力，而将理论应用于特定离子并计算出可观测量是检验理解的下一步。本练习以钆离子 ($\\text{Gd}^{3+}$) 为例，这是一个近乎理想的“纯自旋”磁矩体系，因为其轨道角动量为零 ($L=0$)。[@problem_id:2854643] 通过从头计算其有效磁矩和在特定温度下的磁化率，你将加深对模型如何应用于真实材料的理解。", "problem": "一种稀磁顺磁性固体含有三价态的自由钆离子 $\\text{Gd}^{3+}$，其总角动量量子数 $J=\\tfrac{7}{2}$，基项为 ${}^{8}\\!S_{7/2}$（因此轨道角动量 $L=0$，自旋 $S=\\tfrac{7}{2}$）。磁离子数密度为 $n=1.0\\times 10^{27}\\ \\text{m}^{-3}$。将离子视为无相互作用，忽略晶体场效应，并使用国际单位制（SI）进行计算。\n\n仅从弱匀强磁场 $B$ 中一组塞曼分裂能级的磁化强度的量子统计定义出发：\n- 塞曼能量为 $E_{m}=-g_{J}\\,\\mu_{B}\\,m\\,B$，其中 $m=-J,-J+1,\\dots,J$，朗德因子 $g_{J}$ 由角动量耦合决定，\n- 单离子配分函数为 $Z=\\sum_{m=-J}^{J}\\exp(-\\beta E_{m})$，其中 $\\beta=1/(k_{B}T)$，\n- 磁化强度为 $M=n\\,\\langle \\mu_{z}\\rangle$，其中 $\\langle \\mu_{z}\\rangle=\\frac{1}{Z}\\sum_{m} (g_{J}\\mu_{B} m)\\,\\exp(-\\beta E_{m})$，\n\n请在该自由离子顺磁体的高温、弱场极限下，推导磁化率 $\\chi(T)$ 的居里定律形式。从你的推导中，确定与该离子相关的居里常数 $C$ 和有效磁矩 $\\mu_{\\text{eff}}$。\n\n然后，对于 $J=\\tfrac{7}{2}$ 的 $\\text{Gd}^{3+}$，数值计算：\n- 居里常数 $C$，\n- 有效磁矩 $\\mu_{\\text{eff}}$，\n- 以及在 $T=300\\ \\text{K}$ 时的磁化率 $\\chi$。\n\n使用以下常数：\n- 玻尔磁子 $\\mu_{B}=9.2740100783\\times 10^{-24}\\ \\text{J T}^{-1}$，\n- 玻尔兹曼常数 $k_{B}=1.380649\\times 10^{-23}\\ \\text{J K}^{-1}$，\n- 真空磁导率 $\\mu_{0}=4\\pi\\times 10^{-7}\\ \\text{H m}^{-1}$。\n\n报告：\n- $C$ 以开尔文为单位，\n- $\\mu_{\\text{eff}}$ 以玻尔磁子 $\\mu_{B}$ 为单位，\n- $\\chi$ 为无量纲数。\n\n将所有三个数值结果四舍五入到四位有效数字。以有序形式 $\\big(C,\\ \\mu_{\\text{eff}},\\ \\chi(300\\ \\text{K})\\big)$ 给出你的最终数值结果。", "solution": "在尝试求解之前，对问题陈述进行验证。\n\n首先，逐字提取所有给定条件。\n- 系统：含有自由 $\\text{Gd}^{3+}$ 离子的稀磁顺磁性固体。\n- 离子性质：总角动量量子数 $J=\\tfrac{7}{2}$，基项 ${}^{8}\\!S_{7/2}$ ($L=0$, $S=\\tfrac{7}{2}$)。\n- 离子数密度: $n=1.0\\times 10^{27}\\ \\text{m}^{-3}$。\n- 假设：离子无相互作用，忽略晶体场效应。\n- 单位制：国际单位制（SI）。\n- 塞曼能级: $E_{m}=-g_{J}\\,\\mu_{B}\\,m\\,B$，其中 $m=-J,-J+1,\\dots,J$。\n- 配分函数: $Z=\\sum_{m=-J}^{J}\\exp(-\\beta E_{m})$，其中 $\\beta=1/(k_{B}T)$。\n- 磁化强度: $M=n\\,\\langle \\mu_{z}\\rangle$，其中 $\\langle \\mu_{z}\\rangle=\\frac{1}{Z}\\sum_{m} (g_{J}\\mu_{B} m)\\,\\exp(-\\beta E_{m})$。\n- 朗德因子 $g_J$ 由角动量耦合决定。\n- 目标1：在高温、弱场极限下推导磁化率 $\\chi(T)$ 的居里定律形式。\n- 目标2：确定居里常数 $C$ 和有效磁矩 $\\mu_{\\text{eff}}$。\n- 目标3：对 $\\text{Gd}^{3+}$ ($J=7/2$) 数值计算：$C$ (单位 K)，$\\mu_{\\text{eff}}$ (单位 $\\mu_B$)，以及在 $T=300\\ \\text{K}$ 时的 $\\chi$ (无量纲)。所有结果保留四位有效数字。\n- 常数: $\\mu_{B}=9.2740100783\\times 10^{-24}\\ \\text{J T}^{-1}$， $k_{B}=1.380649\\times 10^{-23}\\ \\text{J K}^{-1}$， $\\mu_{0}=4\\pi\\times 10^{-7}\\ \\text{H m}^{-1}$。\n\n接下来，根据指定的标准对问题进行验证。\n- **科学依据**：该问题是统计力学应用于顺磁性量子理论的一个标准练习。基于塞曼分裂和玻尔兹曼统计的物理模型是固态物理学中一个基本且已成熟的部分。$\\text{Gd}^{3+}$ 离子是类自由离子顺磁体的一个经典例子。\n- **适定性**：问题陈述清晰，提供了所有必要的物理参数（$J, L, S, n$）、常数和理论出发点。要求在特定极限（高温、弱场）下进行推导，确保了唯一的解析路径。\n- **客观性**：语言精确、定量，没有任何主观性或模糊性。\n\n该问题被认为是**有效的**，因为它是科学上合理的、自洽的且适定的。没有矛盾或不切实际的要求。要求居里常数 $C$ 以开尔文为单位，这与磁化率的国际单位制定义一致，因为对于无量纲的 $\\chi$, $\\chi = C/T$ 要求 $[C]=K$。\n\n我们现在开始求解。\n\n单个离子在外加磁场 $B$ 方向上的平均磁矩由 $\\langle \\mu_z \\rangle$ 给出。总磁化强度 $M$ 是数密度 $n$ 乘以该平均磁矩。\n$$\nM = n\\,\\langle \\mu_{z}\\rangle = n\\,\\frac{\\sum_{m=-J}^{J} (g_{J}\\mu_{B} m)\\,\\exp(-\\beta E_{m})}{\\sum_{m=-J}^{J}\\exp(-\\beta E_{m})}\n$$\n代入塞曼能量 $E_{m}=-g_{J}\\mu_{B}mB$，我们有：\n$$\nM = n\\,\\frac{\\sum_{m=-J}^{J} (g_{J}\\mu_{B} m)\\,\\exp(\\beta g_{J}\\mu_{B}mB)}{\\sum_{m=-J}^{J}\\exp(\\beta g_{J}\\mu_{B}mB)}\n$$\n令 $x = \\beta g_{J}\\mu_{B}B = \\frac{g_{J}\\mu_{B}B}{k_B T}$。表达式变为：\n$$\nM = n g_J \\mu_B \\frac{\\sum_{m=-J}^{J} m e^{mx}}{\\sum_{m=-J}^{J} e^{mx}}\n$$\n分子中的求和可以表示为分母中的求和对 $x$ 的导数。令 $Z(x) = \\sum_{m=-J}^{J} e^{mx}$。则 $\\sum_{m=-J}^{J} m e^{mx} = \\frac{dZ}{dx}$。\n$$\nM = n g_J \\mu_B \\frac{1}{Z} \\frac{dZ}{dx} = n g_J \\mu_B \\frac{d(\\ln Z)}{dx}\n$$\n求和 $Z(x)$ 是一个有限几何级数，首项为 $e^{-Jx}$，公比为 $e^x$，共有 $2J+1$ 项。\n$$\nZ(x) = \\frac{e^{-Jx}( (e^x)^{2J+1} - 1 )}{e^x - 1} = \\frac{e^{(J+1)x} - e^{-Jx}}{e^x - 1} = \\frac{e^{(J+1/2)x} - e^{-(J+1/2)x}}{e^{x/2} - e^{-x/2}} = \\frac{\\sinh((J+\\tfrac{1}{2})x)}{\\sinh(\\tfrac{1}{2}x)}\n$$\n对其对数求导：\n$$\n\\frac{d(\\ln Z)}{dx} = \\frac{d}{dx}\\left[ \\ln\\left(\\sinh((J+\\tfrac{1}{2})x)\\right) - \\ln\\left(\\sinh(\\tfrac{1}{2}x)\\right) \\right] = (J+\\tfrac{1}{2})\\coth((J+\\tfrac{1}{2})x) - \\tfrac{1}{2}\\coth(\\tfrac{1}{2}x)\n$$\n这给出了磁化强度的完整表达式，其中包含布里渊函数。我们关心的是高温、弱场极限，这对应于 $x \\ll 1$。我们对小宗量 $y$ 使用双曲余切函数的泰勒展开：$\\coth(y) \\approx \\frac{1}{y} + \\frac{y}{3}$。\n将此展开式应用于我们的导数：\n$$\n\\frac{d(\\ln Z)}{dx} \\approx (J+\\tfrac{1}{2})\\left[\\frac{1}{(J+\\tfrac{1}{2})x} + \\frac{(J+\\tfrac{1}{2})x}{3}\\right] - \\tfrac{1}{2}\\left[\\frac{1}{\\tfrac{1}{2}x} + \\frac{\\tfrac{1}{2}x}{3}\\right]\n$$\n$$\n= \\left(\\frac{1}{x} + \\frac{(J+\\tfrac{1}{2})^2 x}{3}\\right) - \\left(\\frac{1}{x} + \\frac{x}{12}\\right) = \\left[\\frac{(J^2+J+\\tfrac{1}{4})}{3} - \\frac{1}{12}\\right]x\n$$\n$$\n= \\frac{4J^2+4J+1-1}{12}x = \\frac{4J(J+1)}{12}x = \\frac{J(J+1)}{3}x\n$$\n将此结果代回磁化强度 $M$ 的表达式中：\n$$\nM \\approx n g_J \\mu_B \\left( \\frac{J(J+1)}{3} x \\right) = n g_J \\mu_B \\frac{J(J+1)}{3} \\left( \\frac{g_J \\mu_B B}{k_B T} \\right)\n$$\n$$\nM = \\frac{n g_J^2 \\mu_B^2 J(J+1)}{3 k_B T} B\n$$\n无量纲磁化率 $\\chi$ 由 $M = \\chi H$ 定义。对于稀磁顺磁体，磁场 $B$ 与磁场强度 $H$ 的关系为 $B = \\mu_0(H+M) \\approx \\mu_0 H$。因此，$H \\approx B/\\mu_0$。\n$$\nM = \\chi \\frac{B}{\\mu_0}\n$$\n比较 $M$ 的两个表达式，我们发现：\n$$\n\\frac{\\chi B}{\\mu_0} = \\frac{n g_J^2 \\mu_B^2 J(J+1)}{3 k_B T} B\n$$\n这给出了作为温度函数的磁化率：\n$$\n\\chi(T) = \\frac{\\mu_0 n g_J^2 \\mu_B^2 J(J+1)}{3 k_B T}\n$$\n这就是居里定律，$\\chi(T) = C/T$。\n\n从这个推导中，我们确定居里常数 $C$：\n$$\nC = \\frac{\\mu_0 n g_J^2 \\mu_B^2 J(J+1)}{3 k_B}\n$$\n有效磁矩 $\\mu_{\\text{eff}}$ 的定义使得磁化率的表达式具有形式 $\\chi(T) = \\frac{\\mu_0 n \\mu_{\\text{eff}}^2}{3 k_B T}$。将此与我们推导的公式进行比较，我们确定：\n$$\n\\mu_{\\text{eff}}^2 = g_J^2 \\mu_B^2 J(J+1) \\quad \\implies \\quad \\mu_{\\text{eff}} = g_J \\sqrt{J(J+1)} \\mu_B\n$$\n\n现在我们为 $\\text{Gd}^{3+}$ 离子计算这些量。基项是 ${}^{8}\\!S_{7/2}$，这意味着轨道角动量为 $L=0$，自旋角动量为 $S=7/2$。总角动量为 $J=L+S=7/2$。\n朗德 g 因子 $g_J$ 计算如下：\n$$\ng_J = 1 + \\frac{J(J+1) + S(S+1) - L(L+1)}{2J(J+1)}\n$$\n对于 $L=0$ 和 $J=S$，这简化为 $g_J = 1 + \\frac{J(J+1)+J(J+1)-0}{2J(J+1)} = 1+1=2$。\n\n首先，我们以玻尔磁子 $\\mu_B$ 为单位计算有效磁矩 $\\mu_{\\text{eff}}$：\n$$\n\\frac{\\mu_{\\text{eff}}}{\\mu_B} = g_J \\sqrt{J(J+1)} = 2 \\sqrt{\\frac{7}{2}\\left(\\frac{7}{2}+1\\right)} = 2 \\sqrt{\\frac{7}{2}\\cdot\\frac{9}{2}} = 2 \\frac{\\sqrt{63}}{2} = \\sqrt{63} = 3\\sqrt{7} \\approx 7.93725...\n$$\n精确到四位有效数字，$\\mu_{\\text{eff}} / \\mu_B = 7.937$。\n\n接下来，我们计算居里常数 $C$：\n$$\nC = \\frac{\\mu_0 n}{3 k_B} \\left( g_J^2 J(J+1) \\mu_B^2 \\right) = \\frac{\\mu_0 n}{3 k_B} \\left( (2)^2 \\left(\\frac{63}{4}\\right) \\mu_B^2 \\right) = \\frac{63 \\mu_0 n \\mu_B^2}{3 k_B} = \\frac{21 \\mu_0 n \\mu_B^2}{k_B}\n$$\n代入给定值：\n$$\nC = \\frac{21 \\cdot (4\\pi \\times 10^{-7}\\ \\text{H m}^{-1}) \\cdot (1.0 \\times 10^{27}\\ \\text{m}^{-3}) \\cdot (9.2740100783 \\times 10^{-24}\\ \\text{J T}^{-1})^2}{1.380649 \\times 10^{-23}\\ \\text{J K}^{-1}}\n$$\n$$\nC \\approx 0.164389\\ \\text{K}\n$$\n精确到四位有效数字，$C = 0.1644$ K。\n\n最后，我们计算在 $T=300\\ \\text{K}$ 时的磁化率 $\\chi$：\n$$\n\\chi(300\\ \\text{K}) = \\frac{C}{T} = \\frac{0.164389...\\ \\text{K}}{300\\ \\text{K}} \\approx 5.4796... \\times 10^{-4}\n$$\n精确到四位有效数字，$\\chi(300\\ \\text{K}) = 5.480 \\times 10^{-4}$。\n\n最终数值结果按要求顺序给出。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1644 & 7.937 & 5.480 \\times 10^{-4} \\end{pmatrix}}\n$$", "id": "2854643"}, {"introduction": "现代材料物理学不仅需要从理论预测实验，还需要能从实验数据中提取关键的物理参数。本练习将带你进入数据分析的世界，通过拟合磁化强度随磁场和温度变化的曲线，来确定离子的总角动量 $J$ 和朗德 (Landé) $g_J$ 因子。[@problem_id:2854654] 你将学习如何利用磁化数据在 $B/T$ 标度下的普适标度行为——所有数据点都坍缩到一条由布里渊 (Brillouin) 函数描述的单一曲线上——这是一个强大而优雅的分析工具。", "problem": "您的任务是根据多个温度下的磁化强度-磁场数据，估算自由离子的总角动量量子数 $J$ 和朗德 $g$ 因子 $g_J$。您的解决方案应从一个处于均匀磁场中、具有总角动量 $J$ 且存在塞曼相互作用的自由离子的正则系综出发。假设离子之间无相互作用，且样品足够稀释，以致集体效应可以忽略不计。磁化强度应按单个离子计算。\n\n使用的基本假设：\n- 一个沿 $\\hat{z}$ 方向、处于均匀磁场 $\\mathbf{B}$ 中、具有总角动量 $J$ 的自由离子的塞曼能量由哈密顿量 $\\hat{H} = -g_J \\mu_B \\hat{J}_z B$ 给出，其中 $\\mu_B$ 是玻尔磁子，$B$ 是磁场大小。\n- 温度为 $T$ 时的正则系综使用玻尔兹曼因子 $\\exp(-E_m/(k_B T))$，其中 $k_B$ 是玻尔兹曼常数。\n- 配分函数是对 $(2J+1)$ 个塞曼能级 $m \\in \\{-J,-J+1,\\dots,J\\}$ 的求和。\n\n您的程序必须实现一种拟合方法，该方法利用标度变量 $x = g_J \\mu_B J B / (k_B T)$ 来将不同温度下的磁化曲线合并，并从中提取 $J$ 和 $g_J$。您必须设计一个有原则的目标函数和一个算法，通过利用自由离子正则系综中出现的温度-磁场标度结构，来估算 $J$（视为离散的半整数或整数）和 $g_J$（视为正实数）。\n\n使用的物理常数和单位：\n- 玻尔磁子 $\\mu_B = 9.274\\,009\\,994 \\times 10^{-24}$ 焦耳/特斯拉 (J/tesla)。\n- 玻尔兹曼常数 $k_B = 1.380\\,649 \\times 10^{-23}$ 焦耳/开尔文 (J/kelvin)。\n- 温度 $T$ 的单位是开尔文。\n- 磁场 $B$ 的单位是特斯拉。\n- 单位离子的磁化强度 $M$ 必须以焦耳/特斯拉/离子 (J/tesla per ion) 为单位处理。\n\n综合数据生成协议（用于可复现性和可测试性）：\n- 对于每个测试用例，您将根据上述基本假设所蕴含的自由离子正则系综模型，生成单位离子的综合磁化数据 $M(B,T)$，然后添加均值为零、标准差与饱和磁矩尺度成正比的独立高斯噪声。\n- 为每个用例使用以下确定性随机数生成器种子，以确保数据集是可复现的。\n\n测试套件：\n- 用例 1（多个温度下的普适数据合并，中等噪声）：\n  - 真实参数：$J_{\\text{true}} = 2.5$， $g_{J,\\text{true}} = 2.0$。\n  - 温度：$[2.0, 5.0, 10.0, 20.0]$ 开尔文。\n  - 磁场：$[0.0, 0.5, 1.0, 2.0, 3.0, 5.0, 7.0]$ 特斯拉。\n  - 噪声标准差：$\\sigma = 0.01 \\times (g_{J,\\text{true}} \\mu_B J_{\\text{true}})$。\n  - 随机种子：$12345$。\n- 用例 2（更高的 $J$ 值，更强的形状区分度，更高噪声）：\n  - 真实参数：$J_{\\text{true}} = 4.0$， $g_{J,\\text{true}} = 1.5$。\n  - 温度：$[4.0, 8.0, 16.0]$ 开尔文。\n  - 磁场：$[0.0, 0.2, 0.5, 1.0, 2.0, 3.5, 5.0, 6.0]$ 特斯拉。\n  - 噪声标准差：$\\sigma = 0.02 \\times (g_{J,\\text{true}} \\mu_B J_{\\text{true}})$。\n  - 随机种子：$24680$。\n- 用例 3（边界情况，纯自旋$1/2$极限）：\n  - 真实参数：$J_{\\text{true}} = 0.5$, $g_{J,\\text{true}} = 2.0$。\n  - 温度：$[1.5, 3.0, 6.0, 12.0]$ 开尔文。\n  - 磁场：$[0.0, 0.1, 0.3, 0.6, 1.0, 2.0, 3.0]$ 特斯拉。\n  - 噪声标准差：$\\sigma = 0.005 \\times (g_{J,\\text{true}} \\mu_B J_{\\text{true}})$。\n  - 随机种子：$13579$。\n\n算法要求：\n- $J$ 应被视为从集合 $\\{0.5, 1.0, 1.5, \\dots, 8.0\\}$ 中选择的离散变量。\n- $g_J$ 应被视为一个连续的正实数，通过最小化一个明确定义的标量损失函数来估算。该损失函数汇集了在所有温度和磁场下，测量的 $M(B,T)$ 与自由离子正则系综预测值之间的差异。您的设计必须明确利用标度变量 $x = g_J \\mu_B J B / (k_B T)$ 在目标函数中实现温度合并。\n- 您的程序必须对 $B=0$ 的数据点和小的 $x$ 值具有鲁棒性，使用在小参数下与正则系综展开一致的数值稳定计算方法。\n- 对于每个测试用例，从上述协议生成的综合数据中估算 $(J, g_J)$。\n\n最终输出规格：\n- 您的程序必须生成单行输出，包含一个长度为3的列表，其中每个元素是对应测试用例的 $[J_{\\text{est}}, g_{J,\\text{est}}]$ 双元素列表，按顺序排列。\n- 将每个报告值四舍五入到三位小数。\n- 最终打印的行必须具有类似 $[[2.500,2.000],[4.000,1.500],[0.500,2.000]]$ 的确切格式，条目之间用逗号分隔，不含任何额外的空白、文本或单位。\n\n不需要用户输入。程序必须是自包含的，且只能使用指定的库和上面给出的物理常数。", "solution": "所提出的问题是计算物理学领域中一个定义明确且有科学依据的练习，具体涉及量子统计力学在材料科学中的应用。它要求从综合磁化数据中估算自由离子的基本量子特性——总角动量量子数 $J$ 和朗德 $g$ 因子 $g_J$。该问题提供了一个清晰的物理模型，明确了所有必需的常数和数据生成协议，并概述了所需的算法方法。它没有歧义、矛盾和科学谬误。因此，该问题被认为是**有效的**，并将提供一个完整的解决方案。\n\n解决方案分两个阶段进行。首先，我们推导自由离子磁化强度的理论模型。其次，我们设计并实现一个数值拟合程序，以从所提供的数据中估算模型参数 $(J, g_J)$。\n\n**1. 理论模型：布里渊函数**\n\n该系统由处于均匀磁场 $\\mathbf{B}$ 中的无相互作用的自由离子组成，我们设定磁场方向沿 $z$ 轴，因此 $\\mathbf{B} = B\\hat{z}$。单个离子的哈密顿量由塞曼相互作用给出：\n$$\n\\hat{H} = - \\hat{\\boldsymbol{\\mu}} \\cdot \\mathbf{B} = -g_J \\mu_B \\hat{J}_z B\n$$\n其中 $\\hat{\\boldsymbol{\\mu}} = g_J \\mu_B \\hat{\\mathbf{J}}/\\hbar$ 是磁矩算符，$\\hat{J}_z$ 是总角动量算符的 $z$ 分量，$\\mu_B$ 是玻尔磁子，$g_J$ 是朗德 $g$ 因子。$\\hat{J}_z$ 的本征值为 $m\\hbar$，其中 $m$ 是磁量子数，$m \\in \\{-J, -J+1, \\dots, J\\}$。为简单起见，并且在这种情况下通常如此，我们使用无量纲的角动量算符，使得 $\\hat{J}_z$ 的本征值就是 $m$。因此，能量本征值为：\n$$\nE_m = -g_J \\mu_B m B \\quad \\text{对于 } m = -J, -J+1, \\dots, J\n$$\n系统在温度 $T$ 下处于热平衡状态。在正则系综中，单个离子的配分函数 $Z$ 是对所有 $(2J+1)$ 个状态的玻尔兹曼因子的求和：\n$$\nZ = \\sum_{m=-J}^{J} e^{-E_m / (k_B T)} = \\sum_{m=-J}^{J} e^{g_J \\mu_B m B / (k_B T)}\n$$\n我们定义无量纲变量 $y = g_J \\mu_B B / (k_B T)$。配分函数变成一个几何级数：\n$$\nZ = \\sum_{m=-J}^{J} (e^y)^m = \\frac{e^{-Jy}(1 - (e^y)^{2J+1})}{1 - e^y} = \\frac{e^{-Jy} - e^{(J+1)y}}{1 - e^y}\n$$\n这个表达式可以使用双曲正弦函数的定义 $\\sinh(z) = (e^z - e^{-z})/2$ 来简化：\n$$\nZ = \\frac{e^{(J+1/2)y} - e^{-(J+1/2)y}}{e^{y/2} - e^{-y/2}} = \\frac{\\sinh\\left(\\left(J+\\frac{1}{2}\\right)y\\right)}{\\sinh\\left(\\frac{y}{2}\\right)}\n$$\n沿磁场方向的单位离子平均磁化强度 $M$ 是磁矩分量的期望值，$\\langle \\mu_z \\rangle = \\langle g_J \\mu_B m \\rangle$。\n$$\nM = \\langle g_J \\mu_B m \\rangle = g_J \\mu_B \\langle m \\rangle\n$$\n期望值 $\\langle m \\rangle$ 的计算如下：\n$$\n\\langle m \\rangle = \\frac{1}{Z} \\sum_{m=-J}^{J} m e^{my} = \\frac{1}{Z} \\frac{\\partial Z}{\\partial y} = \\frac{\\partial (\\ln Z)}{\\partial y}\n$$\n对 $\\ln Z$ 关于 $y$ 求导得到：\n$$\n\\langle m \\rangle = \\left(J+\\frac{1}{2}\\right)\\coth\\left(\\left(J+\\frac{1}{2}\\right)y\\right) - \\frac{1}{2}\\coth\\left(\\frac{y}{2}\\right)\n$$\n通常将磁化强度表示为饱和磁化强度 $M_{sat} = g_J \\mu_B J$ 和布里渊函数 $B_J(x)$ 的形式。布里渊函数的自变量 $x$ 定义为 $x = J y = g_J \\mu_B J B / (k_B T)$。归一化磁化强度 $M/M_{sat}$ 则为 $\\langle m \\rangle/J = B_J(x)$。将 $y=x/J$ 代入 $\\langle m \\rangle/J$ 的表达式中，得到布里渊函数的标准形式：\n$$\nB_J(x) = \\frac{2J+1}{2J}\\coth\\left(\\frac{2J+1}{2J}x\\right) - \\frac{1}{2J}\\coth\\left(\\frac{1}{2J}x\\right)\n$$\n因此，单位离子磁化强度的完整理论模型是：\n$$\nM(B, T; J, g_J) = g_J \\mu_B J B_J(x) \\quad \\text{其中} \\quad x = \\frac{g_J \\mu_B J B}{k_B T}\n$$\n为了在 $x \\to 0$ 时保持数值稳定性，我们注意到当 $z$ 很小时，$\\coth(z) \\approx 1/z + z/3$。直接计算 $B_J(x)$ 涉及两个大数相减，这在数值上是不稳定的。我们可以通过定义一个函数 $f(z) = \\coth(z) - 1/z \\approx z/3$ 来重新排列表达式，使其稳定。然后布里渊函数可以写成：\n$$\nB_J(x) = \\left(\\frac{2J+1}{2J}\\right) f\\left(\\left(\\frac{2J+1}{2J}\\right)x\\right) - \\left(\\frac{1}{2J}\\right) f\\left(\\left(\\frac{1}{2J}\\right)x\\right)\n$$\n这种形式对所有 $x$ 都是数值稳定的，因为有问题的 $1/x$ 项在解析上被消除了。对于 $x=0$，$B_J(0)=0$，对应于在没有磁场时磁化强度为零。\n\n**2. 参数估算策略**\n\n问题在于找到能最好地描述实验数据 $\\{M_i^{\\text{data}}, B_i, T_i\\}$ 的参数对 $(J, g_J)$。这些参数类型不同：$J$ 是一个离散的半整数，而 $g_J$ 是一个连续的实数。这表明可以采用一个两阶段的优化过程。我们将对 $J$ 的允许值集合 $J \\in \\{0.5, 1.0, \\dots, 8.0\\}$ 进行网格搜索。对于每个固定的 $J$ 值，我们将进行一维优化，以找到最佳的对应 $g_J$ 值。\n\n目标是最小化测量数据与模型之间的差异。损失函数的标准选择是残差平方和 (SSE)：\n$$\n\\text{Loss}(J, g_J) = \\sum_{i} \\left( M_i^{\\text{data}} - M(B_i, T_i; J, g_J) \\right)^2\n$$\n算法如下：\n1.  对每个测试用例，在指定的温度 $T$ 和磁场 $B$ 网格上生成综合磁化数据矩阵 $M_{\\text{data}}$，并按描述加入高斯噪声。\n2.  初始化一个变量 `min_overall_loss` 为无穷大，`best_params` 为空值。\n3.  遍历集合 $\\{0.5, 1.0, \\dots, 8.0\\}$ 中的每个候选值 $J_{\\text{cand}}$。\n4.  对于当前的 $J_{\\text{cand}}$，定义一个关于 $g_J$ 的一维目标函数：\n    $$\n    L(g_J) = \\text{Loss}(J_{\\text{cand}}, g_J)\n    $$\n5.  使用一个数值优化算法，具体为 `scipy.optimize.minimize_scalar`，找到使 $L(g_J)$ 最小化的 $g_{J, \\text{opt}}$ 值。对 $g_J$ 的搜索被约束为正数，例如，在区间 $(0, 10]$ 内。\n6.  当前 $J_{\\text{cand}}$ 的最小损失为 $L(g_{J, \\text{opt}})$。\n7.  如果此损失小于 `min_overall_loss`，则用这个新的最小值更新 `min_overall_loss`，并将当前的参数对存储为迄今为止的最佳参数：`best_params` = $(J_{\\text{cand}}, g_{J, \\text{opt}})$。\n8.  遍历所有候选 $J$ 值后，`best_params` 将包含最能拟合数据的全局最优 $(J, g_J)$ 参数对。\n9.  对每个测试用例重复此过程。收集最终结果并按规定格式化。\n\n该方法内在地利用了布里渊函数的标度性质。通过同时拟合来自不同温度和磁场的所有数据点，算法找到能使实验点 $(M_i, B_i/T_i)$ 合并到由 $B_J(x)$ 定义的单一理论曲线上的参数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Main function to run the parameter estimation for all test cases.\n    \"\"\"\n    # Physical constants\n    MU_B = 9.274009994e-24  # J/T\n    K_B = 1.380649e-23      # J/K\n\n    def coth_minus_inv(z):\n        \"\"\"\n        Numerically stable implementation of coth(z) - 1/z.\n        Uses Taylor series for small |z| to avoid floating point errors.\n        f(z) = z/3 - z^3/45 + O(z^5)\n        \"\"\"\n        z = np.asanyarray(z, dtype=np.float64)\n        result = np.zeros_like(z)\n        \n        small_z_mask = np.abs(z) < 1e-5\n\n        z_small = z[small_z_mask]\n        result[small_z_mask] = z_small/3.0 - z_small**3/45.0\n        \n        z_large = z[~small_z_mask]\n        # For non-zero z_large, computation is stable.\n        # np.tanh(z) is numerically stable for large z.\n        # The only issue is z->0, which is handled above.\n        result[~small_z_mask] = 1.0/np.tanh(z_large) - 1.0/z_large\n        \n        return result\n\n    def brillouin_function(J, x):\n        \"\"\"\n        Calculates the Brillouin function B_J(x) in a numerically stable way.\n        B_J(x) = C1 * f(C1*x) - C2 * f(C2*x) where f(z)=coth(z)-1/z\n        and C1 = (2J+1)/(2J), C2 = 1/(2J)\n        \"\"\"\n        x = np.asanyarray(x, dtype=np.float64)\n        \n        # Handle J=0 case, although not in candidate list.\n        if J == 0:\n            return np.zeros_like(x)\n            \n        result = np.zeros_like(x)\n        nonzero_mask = x != 0\n        x_nz = x[nonzero_mask]\n        \n        c1 = (2.0 * J + 1.0) / (2.0 * J)\n        c2 = 1.0 / (2.0 * J)\n        \n        arg1 = c1 * x_nz\n        arg2 = c2 * x_nz\n        \n        term1 = c1 * coth_minus_inv(arg1)\n        term2 = c2 * coth_minus_inv(arg2)\n        \n        result[nonzero_mask] = term1 - term2\n        \n        return result\n\n    def magnetization_model(B_grid, T_grid, J, g_J):\n        \"\"\"\n        Calculates the theoretical magnetization M for a grid of B and T values.\n        M = g_J * mu_B * J * B_J(x)\n        x = g_J * mu_B * J * B / (k_B * T)\n        \"\"\"\n        if J == 0 or g_J == 0:\n             return np.zeros_like(B_grid)\n\n        # The term B/T is handled safely with np.divide or direct division\n        # since T values are all positive.\n        x_arg = (g_J * MU_B * J / K_B) * (B_grid / T_grid)\n        M_sat = g_J * MU_B * J\n        \n        M_pred = M_sat * brillouin_function(J, x_arg)\n        return M_pred\n\n    def generate_synthetic_data(J_true, g_J_true, T_vals, B_vals, sigma_factor, seed):\n        \"\"\"\n        Generates synthetic magnetization data with Gaussian noise.\n        \"\"\"\n        B_grid, T_grid = np.meshgrid(B_vals, T_vals)\n        M_true = magnetization_model(B_grid, T_grid, J_true, g_J_true)\n        \n        saturation_moment_scale = g_J_true * MU_B * J_true\n        noise_std = sigma_factor * saturation_moment_scale\n        \n        rng = np.random.default_rng(seed)\n        noise = rng.normal(0, noise_std, size=M_true.shape)\n        \n        M_noisy = M_true + noise\n        return M_noisy, B_grid, T_grid\n\n    def objective_function(g_J, J, M_data_grid, B_grid, T_grid):\n        \"\"\"\n        Calculates the sum of squared errors between predicted and data M.\n        This is the function to be minimized with respect to g_J for a fixed J.\n        \"\"\"\n        if g_J <= 0:\n            return np.inf\n            \n        M_pred = magnetization_model(B_grid, T_grid, J, g_J)\n        sse = np.sum((M_data_grid - M_pred)**2)\n        return sse\n\n    test_cases = [\n        {'J_true': 2.5, 'g_J_true': 2.0, 'T': [2.0, 5.0, 10.0, 20.0], 'B': [0.0, 0.5, 1.0, 2.0, 3.0, 5.0, 7.0], 'sigma_factor': 0.01, 'seed': 12345},\n        {'J_true': 4.0, 'g_J_true': 1.5, 'T': [4.0, 8.0, 16.0], 'B': [0.0, 0.2, 0.5, 1.0, 2.0, 3.5, 5.0, 6.0], 'sigma_factor': 0.02, 'seed': 24680},\n        {'J_true': 0.5, 'g_J_true': 2.0, 'T': [1.5, 3.0, 6.0, 12.0], 'B': [0.0, 0.1, 0.3, 0.6, 1.0, 2.0, 3.0], 'sigma_factor': 0.005, 'seed': 13579}\n    ]\n\n    J_candidates = np.arange(0.5, 8.1, 0.5)\n    \n    final_results = []\n    \n    for case in test_cases:\n        M_data, B_grid, T_grid = generate_synthetic_data(\n            case['J_true'], case['g_J_true'], case['T'], case['B'], case['sigma_factor'], case['seed']\n        )\n        \n        best_overall_loss = np.inf\n        best_params = (None, None)\n        \n        for J_cand in J_candidates:\n            # For each J, find the best g_J by minimizing the loss function\n            result = minimize_scalar(\n                objective_function,\n                args=(J_cand, M_data, B_grid, T_grid),\n                bounds=(0.1, 10.0), # g_J > 0, reasonable upper bound\n                method='bounded'\n            )\n            \n            current_g_J = result.x\n            current_loss = result.fun\n            \n            if current_loss < best_overall_loss:\n                best_overall_loss = current_loss\n                best_params = (J_cand, current_g_J)\n                \n        final_results.append(list(best_params))\n\n    # Format the output string exactly as specified.\n    formatted_inner = [f\"[{r[0]:.3f},{r[1]:.3f}]\" for r in final_results]\n    final_string = f\"[{','.join(formatted_inner)}]\"\n    print(final_string)\n\nsolve()\n```", "id": "2854654"}]}