{"hands_on_practices": [{"introduction": "我们实践的第一步是回到本源，从量子力学第一性原理出发，推导控制朗之万抗磁性的基本方程。这个练习将带你通过微扰理论，揭示外加磁场如何改变电子轨道，从而产生一个与磁场方向相反的磁矩。通过这个推导和随后的数值估算，你将对典型固体中抗磁磁化率的数量级建立起扎实的物理直觉 [@problem_id:2835239]。", "problem": "一个具有闭合电子壳层的单原子绝缘固体可以被建模为在球对称势中的束缚电子集合。考虑一个施加于此固体的弱、静态、空间均匀的磁场 $\\mathbf{B}$。在国际单位制（SI）下进行计算。假设自 spin 效应和原子间重叠可以忽略不计，并且线性响应成立。\n\n从一个电荷为 $-e$、质量为 $m_\\text{e}$ 的束缚电子的经典最小耦合哈密顿量出发，\n$$\nH = \\frac{1}{2m_\\text{e}}\\left(\\mathbf{p} + e\\,\\mathbf{A}\\right)^{2} + V(r),\n$$\n其中均匀场矢量势选择在对称规范 $\\mathbf{A} = \\frac{1}{2}\\,\\mathbf{B}\\times \\mathbf{r}$ 下，推导单位体积内有 $n$ 个此类束缚电子的固体的领头阶体抗磁磁化率（朗之万抗磁性）$\\chi$。使用磁化强度 $\\mathbf{M}$ 的定义，即能量密度对 $\\mathbf{B}$ 的导数的负值，并通过 $\\mathbf{M} = \\chi\\,\\mathbf{H}$ 定义磁化率。您可以利用弱抗磁性介质的线性响应，$\\mathbf{H} \\approx \\mathbf{B}/\\mu_{0}$，其中 $\\mu_{0}$ 是真空磁导率。\n\n然后，对于数密度 $n = 1.0 \\times 10^{29}\\,\\text{m}^{-3}$、典型束缚电子均方半径 $\\langle r^{2} \\rangle = \\left(0.50\\,\\text{\\AA}\\right)^{2}$ 的固体，使用常数 $\\mu_{0} = 4\\pi \\times 10^{-7}\\,\\text{N}\\,\\text{A}^{-2}$，$e = 1.602176634 \\times 10^{-19}\\,\\text{C}$ 和 $m_\\text{e} = 9.1093837015 \\times 10^{-31}\\,\\text{kg}$，估算 $\\chi$ 的数值。\n\n将您的 $\\chi$ 的最终数值答案四舍五入到一位有效数字。将最终答案表示为一个纯数（无量纲）。", "solution": "所给问题是凝聚态物理中的一个标准练习，其表述清晰，科学依据充分，并包含了完整求解所需的所有信息。我们将着手进行推导。\n\n出发点是单个电子（电荷为 $-e$，质量为 $m_\\text{e}$）在中心势 $V(r)$ 和均匀磁场 $\\mathbf{B}$ 中的哈密顿量：\n$$\nH = \\frac{1}{2m_\\text{e}}\\left(\\mathbf{p} + e\\mathbf{A}\\right)^{2} + V(r)\n$$\n此处，$\\mathbf{p}$ 是正则动量算符，$\\mathbf{A}$ 是磁矢量势。问题指定了对称规范，$\\mathbf{A} = \\frac{1}{2}\\mathbf{B}\\times \\mathbf{r}$。\n\n我们展开动能项：\n$$\n\\left(\\mathbf{p} + e\\mathbf{A}\\right)^{2} = \\mathbf{p}^2 + e\\left(\\mathbf{p}\\cdot\\mathbf{A} + \\mathbf{A}\\cdot\\mathbf{p}\\right) + e^2\\mathbf{A}^2\n$$\n通常情况下，算符 $\\mathbf{p}$ 和 $\\mathbf{A}$ 不对易。它们的对易子是 $[\\mathbf{p}_i, \\mathbf{A}_j] = -i\\hbar \\frac{\\partial A_j}{\\partial x_i}$。在对称规范 $\\mathbf{A} = \\frac{1}{2}(B_y z - B_z y, B_z x - B_x z, B_x y - B_y x)$下，我们发现 $\\nabla \\cdot \\mathbf{A} = 0$。利用恒等式 $\\mathbf{p}\\cdot\\mathbf{A} + \\mathbf{A}\\cdot\\mathbf{p} = 2\\mathbf{A}\\cdot\\mathbf{p} - i\\hbar(\\nabla\\cdot\\mathbf{A})$，条件 $\\nabla \\cdot \\mathbf{A} = 0$ 将表达式简化为 $2\\mathbf{A}\\cdot\\mathbf{p}$。\n\n哈密顿量可以写成 $H = H_0 + \\Delta H$，其中 $H_0 = \\frac{\\mathbf{p}^2}{2m_\\text{e}} + V(r)$ 是未扰哈密顿量，$\\Delta H$ 是由磁场引起的微扰：\n$$\n\\Delta H = \\frac{e}{m_\\text{e}}\\mathbf{A}\\cdot\\mathbf{p} + \\frac{e^2}{2m_\\text{e}}\\mathbf{A}^2\n$$\n我们来分析这两项。对于第一项，我们代入 $\\mathbf{A} = \\frac{1}{2}\\mathbf{B}\\times \\mathbf{r}$：\n$$\n\\frac{e}{m_\\text{e}}\\mathbf{A}\\cdot\\mathbf{p} = \\frac{e}{2m_\\text{e}}(\\mathbf{B}\\times\\mathbf{r})\\cdot\\mathbf{p} = \\frac{e}{2m_\\text{e}}\\mathbf{B}\\cdot(\\mathbf{r}\\times\\mathbf{p}) = \\frac{e}{2m_\\text{e}}\\mathbf{B}\\cdot\\mathbf{L}\n$$\n其中 $\\mathbf{L} = \\mathbf{r}\\times\\mathbf{p}$ 是轨道角动量算符。这是塞曼项。\n\n对于第二项，我们有：\n$$\n\\frac{e^2}{2m_\\text{e}}\\mathbf{A}^2 = \\frac{e^2}{2m_\\text{e}}\\left(\\frac{1}{2}\\mathbf{B}\\times\\mathbf{r}\\right)^2 = \\frac{e^2}{8m_\\text{e}}(\\mathbf{B}\\times\\mathbf{r})\\cdot(\\mathbf{B}\\times\\mathbf{r})\n$$\n使用矢量恒等式 $(\\mathbf{a}\\times\\mathbf{b})\\cdot(\\mathbf{c}\\times\\mathbf{d}) = (\\mathbf{a}\\cdot\\mathbf{c})(\\mathbf{b}\\cdot\\mathbf{d}) - (\\mathbf{a}\\cdot\\mathbf{d})(\\mathbf{b}\\cdot\\mathbf{c})$，我们得到：\n$$\n(\\mathbf{B}\\times\\mathbf{r})^2 = (\\mathbf{B}\\cdot\\mathbf{B})(\\mathbf{r}\\cdot\\mathbf{r}) - (\\mathbf{B}\\cdot\\mathbf{r})^2 = B^2r^2 - (\\mathbf{B}\\cdot\\mathbf{r})^2\n$$\n所以第二项微扰是：\n$$\n\\Delta H_{dia} = \\frac{e^2}{8m_\\text{e}}\\left(B^2 r^2 - (\\mathbf{B}\\cdot\\mathbf{r})^2\\right)\n$$\n总微扰为 $\\Delta H = \\frac{e}{2m_\\text{e}}\\mathbf{B}\\cdot\\mathbf{L} + \\frac{e^2}{8m_\\text{e}}\\left(B^2 r^2 - (\\mathbf{B}\\cdot\\mathbf{r})^2\\right)$。\n\n问题考虑的是具有闭合电子壳层的原子。对于此类系统，基态的总轨道角动量为零，即 $\\langle \\mathbf{L} \\rangle = 0$。根据一阶微扰理论，由塞曼项引起的能量移动是 $\\Delta E_{Zeeman} = \\langle \\psi_0 | \\frac{e}{2m_\\text{e}}\\mathbf{B}\\cdot\\mathbf{L} | \\psi_0 \\rangle = \\frac{e}{2m_\\text{e}}\\mathbf{B}\\cdot \\langle \\mathbf{L} \\rangle = 0$。因此，$\\mathbf{B}$ 的线性项对基态能量移动没有贡献。对能量的领头修正来自于 $\\mathbf{B}$ 的二次项，即抗磁项 $\\Delta H_{dia}$。单个电子的能量移动由该项在未扰基态 $\\psi_0$ 中的期望值给出：\n$$\n\\Delta E = \\langle \\psi_0 | \\Delta H_{dia} | \\psi_0 \\rangle = \\frac{e^2 B^2}{8m_\\text{e}} \\langle r^2 - (\\hat{\\mathbf{B}}\\cdot\\mathbf{r})^2 \\rangle\n$$\n其中 $\\hat{\\mathbf{B}}$ 是 $\\mathbf{B}$ 方向上的单位矢量。\n\n势 $V(r)$ 是球对称的，这意味着基态波函数 $\\psi_0$ 也是球对称的。对于一个球对称态，其期望值是各向同性的。我们可以不失一般性地将 $\\mathbf{B}$ 与 $z$ 轴对齐，因此 $\\hat{\\mathbf{B}}\\cdot\\mathbf{r} = z$。期望值变为：\n$$\n\\langle r^2 - z^2 \\rangle = \\langle x^2+y^2+z^2 - z^2 \\rangle = \\langle x^2+y^2 \\rangle\n$$\n由于球对称性，$\\langle x^2 \\rangle = \\langle y^2 \\rangle = \\langle z^2 \\rangle$。因为 $r^2=x^2+y^2+z^2$，所以我们有 $\\langle r^2 \\rangle = \\langle x^2 \\rangle + \\langle y^2 \\rangle + \\langle z^2 \\rangle = 3\\langle z^2 \\rangle$。因此，$\\langle z^2 \\rangle = \\frac{1}{3}\\langle r^2 \\rangle$。这样期望值就是：\n$$\n\\langle r^2 - z^2 \\rangle = \\langle r^2 \\rangle - \\frac{1}{3}\\langle r^2 \\rangle = \\frac{2}{3}\\langle r^2 \\rangle\n$$\n将此结果代回到单个电子的能量移动表达式中：\n$$\n\\Delta E = \\frac{e^2 B^2}{8m_\\text{e}} \\left(\\frac{2}{3}\\langle r^2 \\rangle\\right) = \\frac{e^2 B^2}{12m_\\text{e}}\\langle r^2 \\rangle\n$$\n该固体包含数密度为 $n$ 的此类束缚电子。总能量密度变化 $\\mathcal{E}$ 是每个电子的能量移动乘以数密度：\n$$\n\\mathcal{E} = n \\Delta E = \\frac{n e^2 B^2}{12m_\\text{e}}\\langle r^2 \\rangle\n$$\n问题将磁化强度 $\\mathbf{M}$ 定义为 $\\mathbf{M} = -\\frac{\\partial \\mathcal{E}}{\\partial \\mathbf{B}}$。我们将 $\\mathcal{E}$ 用矢量 $\\mathbf{B}$ 表示：$\\mathcal{E} = \\frac{n e^2 \\langle r^2 \\rangle}{12m_\\text{e}} |\\mathbf{B}|^2$。其导数是关于 $\\mathbf{B}$ 各分量的梯度：\n$$\n\\mathbf{M} = -\\nabla_{\\mathbf{B}} \\left( \\frac{n e^2 \\langle r^2 \\rangle}{12m_\\text{e}} B^2 \\right) = -\\frac{n e^2 \\langle r^2 \\rangle}{12m_\\text{e}} (2\\mathbf{B}) = -\\frac{n e^2 \\langle r^2 \\rangle}{6m_\\text{e}}\\mathbf{B}\n$$\n此表达式表明感生磁化强度与外加磁场方向相反，这是抗磁性的特征。\n\n磁化率 $\\chi$ 由 $\\mathbf{M} = \\chi \\mathbf{H}$ 定义。对于弱磁性材料，磁场强度 $\\mathbf{H}$ 与磁感应强度 $\\mathbf{B}$ 的关系为 $\\mathbf{H} \\approx \\mathbf{B}/\\mu_0$，其中 $\\mu_0$ 是真空磁导率。将此关系代入 $\\chi$ 的定义中：\n$$\n\\mathbf{M} = \\chi \\frac{\\mathbf{B}}{\\mu_0}\n$$\n令 $\\mathbf{M}$ 的两个表达式相等：\n$$\n\\chi \\frac{\\mathbf{B}}{\\mu_0} = -\\frac{n e^2 \\langle r^2 \\rangle}{6m_\\text{e}}\\mathbf{B}\n$$\n求解 $\\chi$，我们得到朗之万抗磁磁化率：\n$$\n\\chi = -\\frac{\\mu_0 n e^2 \\langle r^2 \\rangle}{6m_\\text{e}}\n$$\n至此推导完成。现在，我们必须使用所给数据计算其数值：\n$n = 1.0 \\times 10^{29}\\,\\text{m}^{-3}$\n$\\langle r^2 \\rangle = (0.50\\,\\text{\\AA})^2 = (0.50 \\times 10^{-10}\\,\\text{m})^2 = 0.25 \\times 10^{-20}\\,\\text{m}^2$\n$\\mu_0 = 4\\pi \\times 10^{-7}\\,\\text{N}\\,\\text{A}^{-2}$\n$e = 1.602176634 \\times 10^{-19}\\,\\text{C}$\n$m_\\text{e} = 9.1093837015 \\times 10^{-31}\\,\\text{kg}$\n\n将这些值代入 $\\chi$ 的表达式中：\n$$\n\\chi = -\\frac{(4\\pi \\times 10^{-7}\\,\\text{N}\\,\\text{A}^{-2}) (1.0 \\times 10^{29}\\,\\text{m}^{-3}) (1.602176634 \\times 10^{-19}\\,\\text{C})^2 (0.25 \\times 10^{-20}\\,\\text{m}^2)}{6 (9.1093837015 \\times 10^{-31}\\,\\text{kg})}\n$$\n我们来计算这个表达式。所有单位都是国际单位制（SI），所以 $\\chi$ 的结果将是无量纲的，符合要求。\n$$\n\\chi \\approx -\\frac{(1.2566 \\times 10^{-6}) (1.0 \\times 10^{29}) (2.5670 \\times 10^{-38}) (0.25 \\times 10^{-20})}{6 (9.1094 \\times 10^{-31})}\n$$\n$$\n\\chi \\approx -\\frac{0.8065 \\times 10^{-35}}{5.4656 \\times 10^{-30}} \\approx -0.1475 \\times 10^{-5} = -1.475 \\times 10^{-6}\n$$\n问题要求将结果四舍五入到一位有效数字。\n$$\n\\chi \\approx -1 \\times 10^{-6}\n$$", "answer": "$$\n\\boxed{-1 \\times 10^{-6}}\n$$", "id": "2835239"}, {"introduction": "真实的晶体材料很少是各向同性的，它们的电子云分布常常是不对称的。这个练习将我们的分析从简单的标量磁化率 $\\chi$ 推广到更普适的张量形式 $\\chi_{ij}$，从而能够描述各向异性材料的响应。通过推导磁化率张量与电子位置二阶矩张量 $\\langle r_i r_j \\rangle$ 之间的关系，该问题为连接第一性原理计算（如密度泛函理论）和宏观磁性测量搭建了一座桥梁 [@problem_id:2835295]。", "problem": "您的任务是将估算抗磁磁化率的概念性工作流程转化为一个可以作为程序实现的精确计算算法。物理背景设定为一个处于零温下的三维、非磁性、非金属的晶体绝缘体，其电子壳层为闭合壳层，因此轨道磁性主要由束缚电子的抗磁响应主导。您的目标是从第一性原理出发，推导出一个用位置算符的二阶矩表示轨道抗磁磁化率张量的公式，然后对一个小的、固定的测试集实现该公式。\n\n起点和假设：\n- 使用在外部空间均匀磁场中的单个电子的最小耦合哈密顿量，即 $H = \\frac{1}{2 m_{\\mathrm{e}}}\\left(\\mathbf{p} + e \\mathbf{A}\\right)^{2} + V(\\mathbf{r})$，其中 $m_{\\mathrm{e}}$ 是电子质量，$e$ 是基本电荷（约定电子电荷为 $-e$），$\\mathbf{A}$ 是均匀磁场 $\\mathbf{B}$ 的矢量势，$V(\\mathbf{r})$ 是束缚势。\n- 选择对称规范 $\\mathbf{A} = \\frac{1}{2}\\,\\mathbf{B} \\times \\mathbf{r}$，将哈密顿量展开到 $\\mathbf{B}$ 的二次项，并对具有局域化闭合壳层电子的绝缘体使用零温下的平衡热力学。假设顺磁性（带间）轨道贡献对于本问题可以忽略，并专注于抗磁贡献。\n- 通过 $\\mathbf{M} = -\\partial f/\\partial \\mathbf{B}$，从依赖于磁场的自由能密度 $f(\\mathbf{B})$ 定义磁化强度 $\\mathbf{M}$。在线性响应区，通过 $M_{i} = \\sum_{j} \\chi_{ij} H_{j}$ 定义轨道磁化率张量 $\\chi_{ij}$，并在弱场区近似 $H_{j} \\approx B_{j}/\\mu_{0}$，其中 $\\mu_{0}$ 是自由空间（真空）磁导率。\n- 将该固体建模为包含数密度为 $n_{\\mathrm{e}}$ 的束缚电子。令 $\\langle r_{i} r_{j} \\rangle$ 表示相对于每个电子自身中心的位置的单电子二阶矩张量（因此已经减去了 $\\langle r_{i} \\rangle = 0$）。在第一性原理方面，计算此张量的一个实用途径是，通过基态密度泛函理论（DFT）计算一组局域轨道（如最大局域化Wannier函数），评估它们的展宽张量 $S^{(n)}_{ij} = \\langle w_{n} \\vert (r_{i} - \\langle r_{i} \\rangle) (r_{j} - \\langle r_{j} \\rangle) \\vert w_{n} \\rangle$，对每个电子的占据态进行平均，并使用该平均值作为 $\\langle r_{i} r_{j} \\rangle$。本问题专注于将给定的 $\\langle r_{i} r_{j} \\rangle$ 与抗磁理论相结合以获得 $\\chi_{ij}$ 的步骤。\n\n任务A（推导）：\n- 从上述的最小耦合哈密顿量和热力学定义出发，推导一个以 $n_{\\mathrm{e}}$, $e$, $m_{\\mathrm{e}}$, $\\mu_{0}$ 和单电子二阶矩张量 $\\langle r_{i} r_{j} \\rangle$ 及其迹 $\\langle r^{2} \\rangle = \\sum_{k} \\langle r_{k} r_{k} \\rangle$ 表示的抗磁磁化率张量 $\\chi_{ij}$ 的表达式。您的推导必须在小场极限下有效，并且必须清楚地说明所使用的每一个近似。\n\n任务B（算法设计）：\n- 将您推导的表达式转化为一个计算算法，其输入为：\n  1. 电子数密度 $n_{\\mathrm{e}}$，单位为 $\\mathrm{m}^{-3}$，\n  2. $3 \\times 3$ 的对称二阶矩矩阵 $\\langle r_{i} r_{j} \\rangle$，单位为 $\\mathrm{m}^{2}$，\n  并输出对称磁化率张量 $\\chi_{ij}$（无量纲，国际单位制）。\n- 您的算法对于半正定矩阵 $\\langle r_{i} r_{j} \\rangle$ 必须是数值稳定的，并且应能正确处理如 $n_{\\mathrm{e}} = 0$ 或 $\\langle r_{i} r_{j} \\rangle = 0$ 的边界情况。\n\n任务C（实现与测试集）：\n- 将您的算法实现为一个程序，使用以下国际单位制（SI）的物理常数：\n  - $\\mu_{0} = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}$,\n  - $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$,\n  - $m_{\\mathrm{e}} = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$。\n- 程序必须精确处理以下四个测试用例。对于每个测试，给定 $n_{\\mathrm{e}}$ 和完整的对称矩阵 $\\langle r_{i} r_{j} \\rangle$，其元素单位为 $\\mathrm{m}^{2}$：\n  1. 类各向同性展宽：\n     - $n_{\\mathrm{e}} = 1.000000000 \\times 10^{29}\\,\\mathrm{m}^{-3}$，\n     - $\\langle r_{i} r_{j} \\rangle = \\begin{pmatrix}\n       0.800000000 \\times 10^{-21} & 0.000000000 \\times 10^{0} & 0.000000000 \\times 10^{0} \\\\\n       0.000000000 \\times 10^{0} & 0.800000000 \\times 10^{-21} & 0.000000000 \\times 10^{0} \\\\\n       0.000000000 \\times 10^{0} & 0.000000000 \\times 10^{0} & 0.800000000 \\times 10^{-21}\n       \\end{pmatrix}$。\n  2. 单轴各向异性：\n     - $n_{\\mathrm{e}} = 1.500000000 \\times 10^{29}\\,\\mathrm{m}^{-3}$，\n     - $\\langle r_{i} r_{j} \\rangle = \\begin{pmatrix}\n       1.200000000 \\times 10^{-21} & 0.000000000 \\times 10^{0} & 0.000000000 \\times 10^{0} \\\\\n       0.000000000 \\times 10^{0} & 0.600000000 \\times 10^{-21} & 0.000000000 \\times 10^{0} \\\\\n       0.000000000 \\times 10^{0} & 0.000000000 \\times 10^{0} & 0.600000000 \\times 10^{-21}\n       \\end{pmatrix}$。\n  3. 具有相关性的一般各向异性：\n     - $n_{\\mathrm{e}} = 0.500000000 \\times 10^{29}\\,\\mathrm{m}^{-3}$，\n     - $\\langle r_{i} r_{j} \\rangle = \\begin{pmatrix}\n       1.000000000 \\times 10^{-21} & 0.200000000 \\times 10^{-21} & 0.000000000 \\times 10^{0} \\\\\n       0.200000000 \\times 10^{-21} & 0.900000000 \\times 10^{-21} & 0.100000000 \\times 10^{-21} \\\\\n       0.000000000 \\times 10^{0} & 0.100000000 \\times 10^{-21} & 0.800000000 \\times 10^{-21}\n       \\end{pmatrix}$。\n  4. 边界情况（无空间延展）：\n     - $n_{\\mathrm{e}} = 1.000000000 \\times 10^{29}\\,\\mathrm{m}^{-3}$，\n     - $\\langle r_{i} r_{j} \\rangle = \\begin{pmatrix}\n       0.000000000 \\times 10^{0} & 0.000000000 \\times 10^{0} & 0.000000000 \\times 10^{0} \\\\\n       0.000000000 \\times 10^{0} & 0.000000000 \\times 10^{0} & 0.000000000 \\times 10^{0} \\\\\n       0.000000000 \\times 10^{0} & 0.000000000 \\times 10^{0} & 0.000000000 \\times 10^{0}\n       \\end{pmatrix}$。\n- 对于每个测试用例，您的程序必须计算国际单位制（无量纲）下的对称磁化率张量 $\\chi_{ij}$。最终输出应为单行，包含一个长度为 $4$ 的列表，其中每个元素对应一个测试用例，并且本身是一个包含 $\\chi_{ij}$ 的 $6$ 个独立分量的列表，顺序为 $\\left[\\chi_{xx}, \\chi_{yy}, \\chi_{zz}, \\chi_{xy}, \\chi_{xz}, \\chi_{yz}\\right]$。每个分量必须以浮点数形式输出。该行必须是一个用方括号括起来的逗号分隔列表，例如：$\\left[\\left[a,b,c,d,e,f\\right],\\left[\\dots\\right],\\left[\\dots\\right],\\left[\\dots\\right]\\right]$。\n- 本问题中没有角度或百分比。在国际单位制中，磁化率是无量纲的，因此输出值无需进行单位转换。\n\n您的程序不得读取任何输入；运行时必须完全按照上述规定为固定的测试集生成输出。", "solution": "该问题是有效的。这是一个在凝聚态物理学中定义明确的问题，具有科学依据、提法恰当且客观。它要求从第一性原理推导轨道抗磁磁化率张量并进行计算实现。我现在开始进行解答。\n\n推导从问题陈述中指定的、在均匀磁场 $\\mathbf{B}$ 中的单电子最小耦合哈密顿量开始。哈密顿量由下式给出\n$$H = \\frac{1}{2 m_{\\mathrm{e}}}\\left(\\mathbf{p} + e \\mathbf{A}\\right)^{2} + V(\\mathbf{r})$$\n其中 $m_{\\mathrm{e}}$ 是电子质量，$\\mathbf{p}$ 是动量算符，$V(\\mathbf{r})$ 是离子势，$\\mathbf{A}$ 是磁矢量势。电子的电荷取为 $-e$，其中 $e$ 是正的基本电荷。对于电荷为 $q$ 的粒子，最小耦合哈密顿量为 $H = \\frac{1}{2m}(\\mathbf{p}-q\\mathbf{A})^2 + V(\\mathbf{r})$。当 $q=-e$ 时，它变成 $\\frac{1}{2m_\\text{e}}(\\mathbf{p}+e\\mathbf{A})^2+V(\\mathbf{r})$，与所给表达式相符。\n\n我们展开动能项：\n$$(\\mathbf{p} + e \\mathbf{A})^{2} = \\mathbf{p}^2 + e(\\mathbf{p} \\cdot \\mathbf{A} + \\mathbf{A} \\cdot \\mathbf{p}) + e^2 \\mathbf{A}^2$$\n哈密顿量可以分为未微扰部分 $H_0$ 和由磁场引起的微扰 $\\Delta H$：\n$$H_0 = \\frac{\\mathbf{p}^2}{2m_{\\mathrm{e}}} + V(\\mathbf{r})$$\n$$\\Delta H = \\frac{e}{2m_{\\mathrm{e}}}(\\mathbf{p} \\cdot \\mathbf{A} + \\mathbf{A} \\cdot \\mathbf{p}) + \\frac{e^2}{2m_{\\mathrm{e}}} \\mathbf{A}^2$$\n我们采用均匀磁场 $\\mathbf{B}$ 的对称规范：\n$$\\mathbf{A} = \\frac{1}{2}(\\mathbf{B} \\times \\mathbf{r})$$\n该规范满足库仑规范条件 $\\nabla \\cdot \\mathbf{A} = 0$，这意味着 $\\mathbf{p}$ 和 $\\mathbf{A}$ 对易，即 $\\mathbf{p} \\cdot \\mathbf{A} = \\mathbf{A} \\cdot \\mathbf{p}$。$\\Delta H$ 中的第一项简化为：\n$$\\frac{e}{m_{\\mathrm{e}}} \\mathbf{A} \\cdot \\mathbf{p} = \\frac{e}{m_{\\mathrm{e}}} \\frac{1}{2}(\\mathbf{B} \\times \\mathbf{r}) \\cdot \\mathbf{p} = \\frac{e}{2m_{\\mathrm{e}}} \\mathbf{B} \\cdot (\\mathbf{r} \\times \\mathbf{p}) = \\frac{e}{2m_{\\mathrm{e}}} \\mathbf{B} \\cdot \\mathbf{L}$$\n其中 $\\mathbf{L} = \\mathbf{r} \\times \\mathbf{p}$ 是轨道角动量算符。该项与 $\\mathbf{B}$ 呈线性关系，是轨道顺磁性的来源。\n\n$\\Delta H$中的第二项是$\\mathbf{B}$的二次项：\n$$\\frac{e^2}{2m_{\\mathrm{e}}} \\mathbf{A}^2 = \\frac{e^2}{2m_{\\mathrm{e}}} \\left( \\frac{1}{2}(\\mathbf{B} \\times \\mathbf{r}) \\right)^2 = \\frac{e^2}{8m_{\\mathrm{e}}} (\\mathbf{B} \\times \\mathbf{r}) \\cdot (\\mathbf{B} \\times \\mathbf{r})$$\n使用矢量恒等式 $(\\mathbf{a} \\times \\mathbf{b}) \\cdot (\\mathbf{c} \\times \\mathbf{d}) = (\\mathbf{a} \\cdot \\mathbf{c})(\\mathbf{b} \\cdot \\mathbf{d}) - (\\mathbf{a} \\cdot \\mathbf{d})(\\mathbf{b} \\cdot \\mathbf{c})$，上式变为：\n$$\\frac{e^2}{8m_{\\mathrm{e}}} \\left( (\\mathbf{B} \\cdot \\mathbf{B})(\\mathbf{r} \\cdot \\mathbf{r}) - (\\mathbf{B} \\cdot \\mathbf{r})^2 \\right) = \\frac{e^2}{8m_{\\mathrm{e}}} (B^2 r^2 - (\\mathbf{B} \\cdot \\mathbf{r})^2)$$\n该项是轨道抗磁性的来源。\n\n单个电子的基态能量因场而产生的变化通过微扰理论求得。该系统是一个具有闭合电子壳层的绝缘体，这意味着基态 $|\\psi_0\\rangle$ 的角动量算符期望值为零，即 $\\langle \\psi_0 | \\mathbf{L} | \\psi_0 \\rangle = 0$。因此，来自 $\\mathbf{B}$ 的线性项的一阶能量修正为零。问题陈述也指示我们忽略该项的二阶微扰（Van Vleck顺磁贡献）。\n因此，主要的能量修正是来自 $\\mathbf{B}$ 的二次项的一阶微扰：\n$$\\Delta E = \\left\\langle \\psi_0 \\left| \\frac{e^2}{8m_{\\mathrm{e}}} (B^2 r^2 - (\\mathbf{B} \\cdot \\mathbf{r})^2) \\right| \\psi_0 \\right\\rangle$$\n在零温下，包含密度为 $n_{\\mathrm{e}}$ 的此类独立电子的固体的自由能密度 $f(\\mathbf{B})$ 为 $f(\\mathbf{B}) = n_{\\mathrm{e}} \\Delta E$。\n$$f(\\mathbf{B}) = n_{\\mathrm{e}} \\frac{e^2}{8m_{\\mathrm{e}}} \\left\\langle B^2 r^2 - (\\mathbf{B} \\cdot \\mathbf{r})^2 \\right\\rangle$$\n其中 $\\langle \\dots \\rangle$ 现在表示问题中给出的单电子基态期望值。在笛卡尔分量中展开各项（$i, j, k \\in \\{x, y, z\\}$）：\n$$f(\\mathbf{B}) = n_{\\mathrm{e}} \\frac{e^2}{8m_{\\mathrm{e}}} \\left\\langle \\left(\\sum_i B_i^2\\right) \\left(\\sum_k r_k^2\\right) - \\left(\\sum_i B_i r_i\\right) \\left(\\sum_j B_j r_j\\right) \\right\\rangle$$\n由于 $\\mathbf{B}$ 是一个常矢量，我们可以将其分量从期望值中提出：\n$$f(\\mathbf{B}) = n_{\\mathrm{e}} \\frac{e^2}{8m_{\\mathrm{e}}} \\left( \\sum_{i,k} B_i^2 \\langle r_k^2 \\rangle - \\sum_{i,j} B_i B_j \\langle r_i r_j \\rangle \\right)$$\n使用克罗内克δ函数 $\\delta_{ij}$，我们写作 $\\sum_{i,k} B_i^2 \\langle r_k^2 \\rangle = \\sum_{i,j} B_i B_j \\delta_{ij} \\sum_k \\langle r_k^2 \\rangle$。令 $\\langle r^2 \\rangle = \\sum_k \\langle r_k^2 \\rangle$ 为二阶矩张量的迹。\n$$f(\\mathbf{B}) = n_{\\mathrm{e}} \\frac{e^2}{8m_{\\mathrm{e}}} \\sum_{i,j} B_i B_j \\left( \\delta_{ij} \\langle r^2 \\rangle - \\langle r_i r_j \\rangle \\right)$$\n磁化强度矢量 $\\mathbf{M}$ 通过对自由能密度对磁场求导得到：$M_k = - \\frac{\\partial f}{\\partial B_k}$。\n$$M_k = - \\frac{\\partial}{\\partial B_k} \\left[ n_{\\mathrm{e}} \\frac{e^2}{8m_{\\mathrm{e}}} \\sum_{i,j} B_i B_j \\left( \\delta_{ij} \\langle r^2 \\rangle - \\langle r_i r_j \\rangle \\right) \\right]$$\n二次型 $\\sum_{i,j} B_i Q_{ij} B_j$ 对 $B_k$ 的导数是 $\\sum_j (Q_{kj} + Q_{jk})B_j$。由于张量 $Q_{ij} = \\delta_{ij} \\langle r^2 \\rangle - \\langle r_i r_j \\rangle$ 是对称的，这变为 $2\\sum_j Q_{kj} B_j$。\n$$M_k = - n_{\\mathrm{e}} \\frac{e^2}{8m_{\\mathrm{e}}} \\left[ 2 \\sum_j B_j \\left( \\delta_{kj} \\langle r^2 \\rangle - \\langle r_k r_j \\rangle \\right) \\right]$$\n$$M_k = - n_{\\mathrm{e}} \\frac{e^2}{4m_{\\mathrm{e}}} \\sum_j \\left( \\delta_{kj} \\langle r^2 \\rangle - \\langle r_k r_j \\rangle \\right) B_j$$\n磁化率张量 $\\chi_{ij}$ 由 $M_i = \\sum_j \\chi_{ij} H_j$ 定义。在非磁性材料的弱场区，我们使用近似 $H_j \\approx B_j / \\mu_0$，其中 $\\mu_0$ 是真空磁导率。\n$$M_i = \\sum_j \\frac{\\chi_{ij}}{\\mu_0} B_j$$\n通过将推导出的 $M_k$ 表达式（将索引 $k$ 替换为 $i$）与定义进行比较，我们确定乘以 $B_j$ 的项：\n$$\\frac{\\chi_{ij}}{\\mu_0} = - n_{\\mathrm{e}} \\frac{e^2}{4m_{\\mathrm{e}}} \\left( \\delta_{ij} \\langle r^2 \\rangle - \\langle r_i r_j \\rangle \\right)$$\n最后，我们解出无量纲磁化率张量 $\\chi_{ij}$：\n$$\\chi_{ij} = - \\frac{\\mu_0 n_{\\mathrm{e}} e^2}{4 m_{\\mathrm{e}}} \\left( \\delta_{ij} \\langle r^2 \\rangle - \\langle r_i r_j \\rangle \\right)$$\n其中 $\\langle r^2 \\rangle = \\mathrm{Tr}(\\langle r_k r_l \\rangle) = \\sum_k \\langle r_k r_k \\rangle$。这是最终表达式，适用于具有局域化电子的绝缘体中的抗磁响应。\n\n计算算法直接实现了这个公式。\n1.  定义物理常数 $\\mu_0, e, m_{\\mathrm{e}}$。\n2.  对于每个测试用例，取输入 $n_{\\mathrm{e}}$ 和 $3 \\times 3$ 矩阵 $\\langle r_i r_j \\rangle$。\n3.  计算标量预因子 $C = - \\frac{\\mu_0 n_{\\mathrm{e}} e^2}{4 m_{\\mathrm{e}}}$。\n4.  计算二阶矩张量的迹：$\\langle r^2 \\rangle = \\mathrm{Tr}(\\langle r_i r_j \\rangle)$。\n5.  构建矩阵项 $T_{ij} = \\delta_{ij} \\langle r^2 \\rangle - \\langle r_i r_j \\rangle$。在矩阵表示法中，这是 $\\mathrm{Tr}(\\mathbf{R}) \\mathbf{I} - \\mathbf{R}$，其中 $\\mathbf{R}$ 是 $\\langle r_i r_j \\rangle$ 的矩阵，$\\mathbf{I}$ 是单位矩阵。\n6.  计算磁化率张量 $\\chi_{ij} = C \\cdot T_{ij}$。\n7.  从得到的对称矩阵 $\\chi_{ij}$ 中提取六个独立分量 $(\\chi_{xx}, \\chi_{yy}, \\chi_{zz}, \\chi_{xy}, \\chi_{xz}, \\chi_{yz})$ 用于输出。\n该算法对于指定的边界情况（如 $n_e=0$ 或 $\\langle r_i r_j \\rangle$ 是零矩阵）是鲁棒的，会如物理预期那样产生零磁化率张量。", "answer": "```python\nimport numpy as np\nimport math\n\n# The problem is valid and a solution is provided below.\n\ndef solve():\n    \"\"\"\n    Derives and implements an algorithm to compute the diamagnetic susceptibility tensor.\n    \"\"\"\n\n    # Physical constants in SI units, as specified in the problem.\n    MU0 = 4 * math.pi * 1e-7  # Vacuum permeability (H/m)\n    E_CHARGE = 1.602176634e-19  # Elementary charge (C)\n    M_E = 9.1093837015e-31  # Electron mass (kg)\n\n    # Test cases as specified in the problem statement.\n    test_cases = [\n        {\n            \"ne\": 1.000000000e29,\n            \"r2_tensor\": np.array([\n                [0.800000000e-21, 0.0, 0.0],\n                [0.0, 0.800000000e-21, 0.0],\n                [0.0, 0.0, 0.800000000e-21]\n            ])\n        },\n        {\n            \"ne\": 1.500000000e29,\n            \"r2_tensor\": np.array([\n                [1.200000000e-21, 0.0, 0.0],\n                [0.0, 0.600000000e-21, 0.0],\n                [0.0, 0.0, 0.600000000e-21]\n            ])\n        },\n        {\n            \"ne\": 0.500000000e29,\n            \"r2_tensor\": np.array([\n                [1.000000000e-21, 0.200000000e-21, 0.0],\n                [0.200000000e-21, 0.900000000e-21, 0.100000000e-21],\n                [0.0, 0.100000000e-21, 0.800000000e-21]\n            ])\n        },\n        {\n            \"ne\": 1.000000000e29,\n            \"r2_tensor\": np.array([\n                [0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0]\n            ])\n        }\n    ]\n\n    def calculate_chi_tensor(ne, r2_tensor):\n        \"\"\"\n        Calculates the diamagnetic susceptibility tensor chi_ij based on the derived formula.\n\n        Args:\n            ne (float): Electron number density in m^-3.\n            r2_tensor (np.ndarray): The 3x3 symmetric matrix of second moments <r_i r_j> in m^2.\n\n        Returns:\n            np.ndarray: The 3x3 symmetric susceptibility tensor chi_ij (dimensionless).\n        \"\"\"\n        if ne == 0.0:\n            return np.zeros((3, 3))\n\n        # Calculate the scalar prefactor from the derived formula:\n        # C = - (mu_0 * n_e * e^2) / (4 * m_e)\n        prefactor = - (MU0 * ne * E_CHARGE**2) / (4 * M_E)\n\n        # Calculate the trace of the second moment tensor: <r^2> = Tr(<r_i r_j>)\n        trace_r2 = np.trace(r2_tensor)\n\n        # Construct the matrix term: (delta_ij * <r^2> - <r_i r_j>)\n        # This is Tr(R)*I - R in matrix form.\n        identity_matrix = np.identity(3)\n        term_matrix = trace_r2 * identity_matrix - r2_tensor\n\n        # Calculate the final susceptibility tensor\n        chi = prefactor * term_matrix\n        return chi\n\n    results = []\n    for case in test_cases:\n        ne = case[\"ne\"]\n        r2_tensor = case[\"r2_tensor\"]\n        \n        # Calculate the susceptibility tensor for the current test case.\n        chi_tensor = calculate_chi_tensor(ne, r2_tensor)\n\n        # Extract the 6 independent components in the specified order.\n        chi_components = [\n            chi_tensor[0, 0],  # chi_xx\n            chi_tensor[1, 1],  # chi_yy\n            chi_tensor[2, 2],  # chi_zz\n            chi_tensor[0, 1],  # chi_xy\n            chi_tensor[0, 2],  # chi_xz\n            chi_tensor[1, 2]   # chi_yz\n        ]\n        results.append(chi_components)\n\n    # Format the final output according to the problem specification.\n    # The default string representation of a list is used as it matches the format `[a, b, ...]`.\n    # The outer list is then formatted as `[ [..], [..] ]`.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2835295"}, {"introduction": "任何线性响应理论都有其适用边界。朗之万抗磁性理论假设磁场是一个小微扰，但当磁场强大到何种程度时，这个假设会失效？本练习通过比较磁场的特征能量量子 $\\hbar\\omega_\\text{c}$ 与电子的束缚能，来估算线性响应开始失效的临界磁场强度。这个实践有助于我们理解理论的适用范围，并判断在当前可实现的实验条件下，我们是否需要考虑非线性效应 [@problem_id:2835265]。", "problem": "在弱磁场中，闭壳层绝缘固体可以很好地由经典的朗之万抗磁性来描述，其磁化强度与外加磁场呈线性关系。估算非线性响应起始点的一种方法，是将特征磁量子化能标与典型的电子结合能进行比较。从匀强磁场中电子所受的洛伦兹力定律出发，推导出回旋频率，然后通过令能量子 $\\hbar \\omega_{\\text{c}}$ 等于一个代表性的束缚电子能标 $E_{b}$ 来定义一个特征磁场 $B^{\\star}$。对于一个共价键合的固体，取 $E_{b} = 5\\,\\mathrm{eV}$ 作为价电子结合的典型能标。\n\n- 使用 $m_{\\text{e}} = 9.109\\,383\\,7015 \\times 10^{-31}\\,\\mathrm{kg}$, $e = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{C}$, $\\hbar = 1.054\\,571\\,817 \\times 10^{-34}\\,\\mathrm{J\\cdot s}$，以及 $1\\,\\mathrm{eV} = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J}$。\n- 在以符号形式获得 $B^{\\star}$ 后，对其在 $E_{b} = 5\\,\\mathrm{eV}$ 的情况下进行数值计算。\n\n将你最终的磁场估算值四舍五入到三位有效数字。以特斯拉为单位表示该磁场。在你的推理中，评论高达 $45\\,\\mathrm{T}$ 的稳态实验室磁场或高达 $100\\,\\mathrm{T}$ 的脉冲磁场是否可能达到此阈值，但最终答案只报告 $B^{\\star}$ 的数值。", "solution": "所述问题具有科学依据，提法明确，并包含唯一解所需的所有信息。我们将着手进行推导。\n\n出发点是洛伦兹力定律，它描述了在电场 $\\vec{E}$ 和磁场 $\\vec{B}$ 中，一个运动速度为 $\\vec{v}$ 的点电荷 $q$ 所受的力 $\\vec{F}$：\n$$\n\\vec{F} = q(\\vec{E} + \\vec{v} \\times \\vec{B})\n$$\n对于一个在匀强磁场 $\\vec{B}$ 中、电荷为 $q = -e$ 且没有电场 ($\\vec{E} = 0$) 的电子，该力简化为：\n$$\n\\vec{F} = -e(\\vec{v} \\times \\vec{B})\n$$\n这个力始终垂直于电子的速度 $\\vec{v}$。因此，磁场不对电子做功，其动能保持不变。如果电子的初速度有垂直于 $\\vec{B}$ 的分量，这个力就充当向心力，使电子在垂直于 $\\vec{B}$ 的平面内做匀速圆周运动。\n\n磁力的大小为 $F_B = e v_{\\perp} B$，其中 $v_{\\perp}$ 是垂直于 $\\vec{B}$ 的速度分量。半径为 $r$ 的圆周运动所需的向心力由牛顿第二定律给出：\n$$\nF_c = m_\\text{e} a_c = \\frac{m_\\text{e} v_{\\perp}^2}{r}\n$$\n其中 $m_\\text{e}$ 是电子的质量。将磁力与向心力相等，得到稳定轨道的条件：\n$$\ne v_{\\perp} B = \\frac{m_\\text{e} v_{\\perp}^2}{r}\n$$\n这个圆周运动的角频率定义为回旋频率 $\\omega_\\text{c}$。它通过 $\\omega_\\text{c} = v_{\\perp}/r$ 与线速度和半径相关。从力平衡方程中，我们可以解出这个频率：\n$$\n\\omega_\\text{c} = \\frac{v_{\\perp}}{r} = \\frac{eB}{m_\\text{e}}\n$$\n这个回旋频率的表达式是基础性的。注意，它与电子的速度或轨道半径无关。\n\n问题要求我们定义一个特征磁场 $B^{\\star}$，在该磁场下，磁能的能量子 $\\hbar \\omega_\\text{c}$ 与典型的电子结合能 $E_b$ 相当。这标志着一个阈值，超过该阈值，磁相互作用不再是小微扰，朗之万抗磁性的线性响应预计将失效。我们令这两个能标相等：\n$$\n\\hbar \\omega_\\text{c} = E_b\n$$\n将 $\\omega_\\text{c}$ 的表达式代入，并令 $B = B^{\\star}$：\n$$\n\\hbar \\left( \\frac{e B^{\\star}}{m_\\text{e}} \\right) = E_b\n$$\n现在我们可以用符号形式解出特征磁场 $B^{\\star}$：\n$$\nB^{\\star} = \\frac{m_\\text{e} E_b}{e \\hbar}\n$$\n现在，我们必须对这个表达式进行数值计算。给定的结合能是 $E_b = 5\\,\\mathrm{eV}$。我们必须使用提供的转换因子 $1\\,\\mathrm{eV} = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J}$ 将其转换为国际单位制（焦耳）。值得注意的是，元电荷 $e$ 的值为 $1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{C}$，因此从电子伏特到焦耳的转换因子在数值上与以库仑为单位的元电荷值相同。\n令 $E_b = (5) \\times (1.602\\,176\\,634 \\times 10^{-19})\\,\\mathrm{J}$。\n代入所有给定的常数：\n$$\nB^{\\star} = \\frac{(9.109\\,383\\,7015 \\times 10^{-31}\\,\\mathrm{kg}) \\times (5 \\times 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J})}{(1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{C}) \\times (1.054\\,571\\,817 \\times 10^{-34}\\,\\mathrm{J\\cdot s})}\n$$\n来自能量转换的数值因子 $1.602\\,176\\,634 \\times 10^{-19}$ 与分母中的元电荷值相消。计算简化为：\n$$\nB^{\\star} = \\frac{5 \\times m_\\text{e}}{\\hbar} = \\frac{5 \\times 9.109\\,383\\,7015 \\times 10^{-31}\\,\\mathrm{kg}}{1.054\\,571\\,817 \\times 10^{-34}\\,\\mathrm{J\\cdot s}}\n$$\n单位为 $\\mathrm{kg} / (\\mathrm{J\\cdot s}) = \\mathrm{kg} / (\\mathrm{kg \\cdot m^2 \\cdot s^{-1}}) = \\mathrm{s/m^2}$。要得到特斯拉，即 $\\mathrm{kg/(s \\cdot C)}$，这必须乘以因相消而产生的因子 $\\mathrm{J/C}$。该计算在量纲上确实是正确的。进行算术运算：\n$$\nB^{\\star} = \\frac{4.554\\,691\\,85075 \\times 10^{-30}}{1.054\\,571\\,817 \\times 10^{-34}} \\,\\mathrm{T} \\approx 43193.3\\,\\mathrm{T}\n$$\n$$\nB^{\\star} \\approx 4.31933 \\times 10^4\\,\\mathrm{T}\n$$\n按要求四舍五入到三位有效数字：\n$$\nB^{\\star} \\approx 4.32 \\times 10^4\\,\\mathrm{T}\n$$\n这个大约为 $43,200\\,\\mathrm{T}$ 的特征磁场强度非常大。实验室中可达到的最高稳态磁场约为 $45\\,\\mathrm{T}$，而最高脉冲磁场则在 $100\\,\\mathrm{T}$ 的量级（破坏性技术可达到更高）。两者都比 $B^{\\star}$ 小几个数量级。这意味着对于一个典型的闭壳层固体，即使在可用的最强实验室磁场下，其电子结构也只受到微弱的扰动，抗磁响应仍然牢固地处于线性区。根据此标准估算的非线性效应在实验上是无法达到的。", "answer": "$$\n\\boxed{4.32 \\times 10^4}\n$$", "id": "2835265"}]}