{"hands_on_practices": [{"introduction": "倒易晶格是理解晶体衍射现象的基础数学框架。它将晶体在实空间中的周期性转化为“倒易空间”中的一系列点，这些点直接对应于衍射峰可能出现的位置。本练习 [@problem_id:2821810] 要求您为一个非正交的单斜晶系推导其倒易晶格基矢，这将为您提供从具体的实空间晶体结构过渡到抽象但功能强大的倒易晶格概念的必要实践。", "problem": "在一个对单斜晶体（单斜轴为 $\\,\\mathbf{b}\\,$）进行的衍射实验中，其正格子由边长 $\\,a\\,$, $\\,b\\,$ 和 $\\,c\\,$ 以及轴间角 $\\,\\alpha = \\gamma = 90^{\\circ}\\,$ 和 $\\,\\mathbf{a}\\,$ 与 $\\,\\mathbf{c}\\,$ 之间的夹角 $\\,\\beta \\in (0,\\pi)\\,$ 来表征。在正格子基矢下，度规张量 $\\,G\\,$ 的元为 $\\,g_{ij} = \\mathbf{a}_{i}\\cdot \\mathbf{a}_{j}\\,$，由下式给出\n$$\nG \\equiv \\begin{pmatrix}\na^{2} & 0 & a c \\cos\\beta \\\\\n0 & b^{2} & 0 \\\\\na c \\cos\\beta & 0 & c^{2}\n\\end{pmatrix}.\n$$\n采用一个与该度规和传统单斜设置相一致的右手标准正交笛卡尔坐标系 $\\,\\{\\hat{\\mathbf{x}},\\hat{\\mathbf{y}},\\hat{\\mathbf{z}}\\}\\,$，即 $\\,\\mathbf{a}\\,$ 沿 $\\,\\hat{\\mathbf{x}}\\,$ 方向，$\\,\\mathbf{b}\\,$ 沿 $\\,\\hat{\\mathbf{y}}\\,$ 方向，且 $\\,\\mathbf{c}\\,$ 位于 $\\,\\hat{\\mathbf{x}}$–$\\,\\hat{\\mathbf{z}}\\,$ 平面内，其 $\\,\\hat{\\mathbf{z}}\\,$ 分量为正。\n\n从倒易基矢 $\\,\\{\\mathbf{a}^{\\ast},\\mathbf{b}^{\\ast},\\mathbf{c}^{\\ast}\\}\\,$ 的基本定义 $\\,\\mathbf{a}_{i}\\cdot \\mathbf{a}_{j}^{\\ast} = 2\\pi\\,\\delta_{ij}\\,$ 出发，推导 $\\,\\mathbf{a}^{\\ast}\\,$, $\\,\\mathbf{b}^{\\ast}\\,$ 和 $\\,\\mathbf{c}^{\\ast}\\,$ 的笛卡尔分量的闭合形式表达式（用 $\\,a\\,$, $\\,b\\,$, $\\,c\\,$ 和 $\\,\\beta\\,$ 表示）。然后验证正交归一关系 $\\,\\mathbf{a}\\cdot\\mathbf{a}^{\\ast} = 2\\pi\\,$, $\\,\\mathbf{b}\\cdot\\mathbf{b}^{\\ast} = 2\\pi\\,$, $\\,\\mathbf{c}\\cdot\\mathbf{c}^{\\ast} = 2\\pi\\,$ 以及 $\\,\\mathbf{a}\\cdot\\mathbf{b}^{\\ast} = \\mathbf{a}\\cdot\\mathbf{c}^{\\ast} = \\mathbf{b}\\cdot\\mathbf{a}^{\\ast} = \\mathbf{b}\\cdot\\mathbf{c}^{\\ast} = \\mathbf{c}\\cdot\\mathbf{a}^{\\ast} = \\mathbf{c}\\cdot\\mathbf{b}^{\\ast} = 0\\,$.\n\n答案规格：\n- 将最终答案以单行的形式给出，包含九个笛卡尔分量 $\\,\\left(a^{\\ast}_{x},a^{\\ast}_{y},a^{\\ast}_{z},\\,b^{\\ast}_{x},b^{\\ast}_{y},b^{\\ast}_{z},\\,c^{\\ast}_{x},c^{\\ast}_{y},c^{\\ast}_{z}\\right)\\,$。\n- 最终答案必须是使用 $\\,a\\,$, $\\,b\\,$, $\\,c\\,$ 和 $\\,\\beta\\,$表示的闭合形式解析表达式。\n- 方框内的答案不应包含单位。", "solution": "该问题是良定的，且在科学上合理，是晶体学中的一个标准练习。我们将进行其形式推导。\n\n第一步是在指定的右手标准正交笛卡尔坐标系 $\\{\\hat{\\mathbf{x}}, \\hat{\\mathbf{y}}, \\hat{\\mathbf{z}}\\}$ 中表示正格子基矢 $\\mathbf{a}$、$\\mathbf{b}$ 和 $\\mathbf{c}$。根据题意：\n向量 $\\mathbf{a}$ 长度为 $a$，沿 $\\hat{\\mathbf{x}}$ 轴方向。\n$$\n\\mathbf{a} = a \\hat{\\mathbf{x}}\n$$\n向量 $\\mathbf{b}$ 长度为 $b$，沿 $\\hat{\\mathbf{y}}$ 轴方向。\n$$\n\\mathbf{b} = b \\hat{\\mathbf{y}}\n$$\n向量 $\\mathbf{c}$ 长度为 $c$，位于 $\\hat{\\mathbf{x}}$-$\\hat{\\mathbf{z}}$ 平面内。设其分量为 $(c_x, 0, c_z)$。题目说明其沿 $\\hat{\\mathbf{z}}$ 的分量为正，因此 $c_z > 0$。\n$\\mathbf{c}$ 的模为 $c$，所以 $c_x^{2} + c_z^{2} = c^{2}$。\n$\\mathbf{a}$ 和 $\\mathbf{c}$ 之间的夹角 $\\beta$ 由点积 $\\mathbf{a} \\cdot \\mathbf{c} = ac \\cos\\beta$ 给出。在笛卡尔坐标系中，这表示为：\n$$\n\\mathbf{a} \\cdot \\mathbf{c} = (a \\hat{\\mathbf{x}}) \\cdot (c_x \\hat{\\mathbf{x}} + c_z \\hat{\\mathbf{z}}) = a c_x\n$$\n比较这两个表达式，我们得到 $a c_x = ac \\cos\\beta$，这意味着 $c_x = c \\cos\\beta$。\n将此代入模长方程：\n$$\n(c \\cos\\beta)^{2} + c_z^{2} = c^{2} \\implies c_z^{2} = c^{2} (1 - \\cos^{2}\\beta) = c^{2} \\sin^{2}\\beta\n$$\n由于 $\\beta \\in (0, \\pi)$，$\\sin\\beta > 0$。因为我们要求 $c_z > 0$，所以我们取正根：$c_z = c \\sin\\beta$。\n因此，向量 $\\mathbf{c}$ 为：\n$$\n\\mathbf{c} = c \\cos\\beta \\hat{\\mathbf{x}} + c \\sin\\beta \\hat{\\mathbf{z}}\n$$\n相对于笛卡尔基，用列向量表示法，正格子矢量为：\n$$\n\\mathbf{a} = \\begin{pmatrix} a \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{b} = \\begin{pmatrix} 0 \\\\ b \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{c} = \\begin{pmatrix} c \\cos\\beta \\\\ 0 \\\\ c \\sin\\beta \\end{pmatrix}\n$$\n正晶胞的体积 $V$ 由标量三重积 $V = |\\mathbf{a} \\cdot (\\mathbf{b} \\times \\mathbf{c})|$ 给出。这可以计算为由这些矢量构成的矩阵的行列式的绝对值：\n$$\nV = \\left| \\det \\begin{pmatrix} a & 0 & c \\cos\\beta \\\\ 0 & b & 0 \\\\ 0 & 0 & c \\sin\\beta \\end{pmatrix} \\right| = | a(b c \\sin\\beta) |\n$$\n由于当 $\\beta \\in (0, \\pi)$ 时 $a, b, c > 0$ 且 $\\sin\\beta > 0$，体积为 $V = abc \\sin\\beta$。\n\n倒易基矢 $\\{\\mathbf{a}^{\\ast}, \\mathbf{b}^{\\ast}, \\mathbf{c}^{\\ast}\\}$ 定义为 $\\mathbf{a}_{i} \\cdot \\mathbf{a}_{j}^{\\ast} = 2\\pi \\delta_{ij}$，其中 $\\mathbf{a}_1=\\mathbf{a}$、$\\mathbf{a}_2=\\mathbf{b}$、$\\mathbf{a}_3=\\mathbf{c}$。这些定义导出以下标准公式：\n$$\n\\mathbf{a}^{\\ast} = \\frac{2\\pi}{V} (\\mathbf{b} \\times \\mathbf{c})\n\\quad , \\quad\n\\mathbf{b}^{\\ast} = \\frac{2\\pi}{V} (\\mathbf{c} \\times \\mathbf{a})\n\\quad , \\quad\n\\mathbf{c}^{\\ast} = \\frac{2\\pi}{V} (\\mathbf{a} \\times \\mathbf{b})\n$$\n我们现在在笛卡尔坐标系中计算叉积。\n对于 $\\mathbf{a}^{\\ast}$：\n$$\n\\mathbf{b} \\times \\mathbf{c} = \\det \\begin{pmatrix} \\hat{\\mathbf{x}} & \\hat{\\mathbf{y}} & \\hat{\\mathbf{z}} \\\\ 0 & b & 0 \\\\ c \\cos\\beta & 0 & c \\sin\\beta \\end{pmatrix} = (bc \\sin\\beta) \\hat{\\mathbf{x}} - 0 \\cdot \\hat{\\mathbf{y}} + (-bc \\cos\\beta) \\hat{\\mathbf{z}}\n$$\n$$\n\\mathbf{a}^{\\ast} = \\frac{2\\pi}{abc \\sin\\beta} (bc \\sin\\beta \\hat{\\mathbf{x}} - bc \\cos\\beta \\hat{\\mathbf{z}}) = \\frac{2\\pi}{a} \\hat{\\mathbf{x}} - \\frac{2\\pi \\cos\\beta}{a \\sin\\beta} \\hat{\\mathbf{z}} = \\frac{2\\pi}{a} \\hat{\\mathbf{x}} - \\frac{2\\pi \\cot\\beta}{a} \\hat{\\mathbf{z}}\n$$\n对于 $\\mathbf{b}^{\\ast}$：\n$$\n\\mathbf{c} \\times \\mathbf{a} = \\det \\begin{pmatrix} \\hat{\\mathbf{x}} & \\hat{\\mathbf{y}} & \\hat{\\mathbf{z}} \\\\ c \\cos\\beta & 0 & c \\sin\\beta \\\\ a & 0 & 0 \\end{pmatrix} = 0 \\cdot \\hat{\\mathbf{x}} - (-ac \\sin\\beta) \\hat{\\mathbf{y}} + 0 \\cdot \\hat{\\mathbf{z}}\n$$\n$$\n\\mathbf{b}^{\\ast} = \\frac{2\\pi}{abc \\sin\\beta} (ac \\sin\\beta \\hat{\\mathbf{y}}) = \\frac{2\\pi}{b} \\hat{\\mathbf{y}}\n$$\n对于 $\\mathbf{c}^{\\ast}$：\n$$\n\\mathbf{a} \\times \\mathbf{b} = \\det \\begin{pmatrix} \\hat{\\mathbf{x}} & \\hat{\\mathbf{y}} & \\hat{\\mathbf{z}} \\\\ a & 0 & 0 \\\\ 0 & b & 0 \\end{pmatrix} = 0 \\cdot \\hat{\\mathbf{x}} - 0 \\cdot \\hat{\\mathbf{y}} + (ab) \\hat{\\mathbf{z}}\n$$\n$$\n\\mathbf{c}^{\\ast} = \\frac{2\\pi}{abc \\sin\\beta} (ab \\hat{\\mathbf{z}}) = \\frac{2\\pi}{c \\sin\\beta} \\hat{\\mathbf{z}}\n$$\n因此，笛卡尔分量 $(a^{\\ast}_x, a^{\\ast}_y, a^{\\ast}_z)$、$(b^{\\ast}_x, b^{\\ast}_y, b^{\\ast}_z)$ 和 $(c^{\\ast}_x, c^{\\ast}_y, c^{\\ast}_z)$ 分别为：\n$$\n\\mathbf{a}^{\\ast} = \\left( \\frac{2\\pi}{a}, 0, -\\frac{2\\pi \\cot\\beta}{a} \\right)\n$$\n$$\n\\mathbf{b}^{\\ast} = \\left( 0, \\frac{2\\pi}{b}, 0 \\right)\n$$\n$$\n\\mathbf{c}^{\\ast} = \\left( 0, 0, \\frac{2\\pi}{c \\sin\\beta} \\right)\n$$\n我们现在必须验证关系式 $\\mathbf{a}_{i} \\cdot \\mathbf{a}_{j}^{\\ast} = 2\\pi\\delta_{ij}$。\n$$\n\\mathbf{a} \\cdot \\mathbf{a}^{\\ast} = (a\\hat{\\mathbf{x}}) \\cdot (\\frac{2\\pi}{a}\\hat{\\mathbf{x}} - \\frac{2\\pi \\cot\\beta}{a}\\hat{\\mathbf{z}}) = a(\\frac{2\\pi}{a}) = 2\\pi\n$$\n$$\n\\mathbf{a} \\cdot \\mathbf{b}^{\\ast} = (a\\hat{\\mathbf{x}}) \\cdot (\\frac{2\\pi}{b}\\hat{\\mathbf{y}}) = 0\n$$\n$$\n\\mathbf{a} \\cdot \\mathbf{c}^{\\ast} = (a\\hat{\\mathbf{x}}) \\cdot (\\frac{2\\pi}{c \\sin\\beta}\\hat{\\mathbf{z}}) = 0\n$$\n$$\n\\mathbf{b} \\cdot \\mathbf{a}^{\\ast} = (b\\hat{\\mathbf{y}}) \\cdot (\\frac{2\\pi}{a}\\hat{\\mathbf{x}} - \\frac{2\\pi \\cot\\beta}{a}\\hat{\\mathbf{z}}) = 0\n$$\n$$\n\\mathbf{b} \\cdot \\mathbf{b}^{\\ast} = (b\\hat{\\mathbf{y}}) \\cdot (\\frac{2\\pi}{b}\\hat{\\mathbf{y}}) = b(\\frac{2\\pi}{b}) = 2\\pi\n$$\n$$\n\\mathbf{b} \\cdot \\mathbf{c}^{\\ast} = (b\\hat{\\mathbf{y}}) \\cdot (\\frac{2\\pi}{c \\sin\\beta}\\hat{\\mathbf{z}}) = 0\n$$\n$$\n\\mathbf{c} \\cdot \\mathbf{a}^{\\ast} = (c \\cos\\beta \\hat{\\mathbf{x}} + c \\sin\\beta \\hat{\\mathbf{z}}) \\cdot (\\frac{2\\pi}{a}\\hat{\\mathbf{x}} - \\frac{2\\pi \\cot\\beta}{a}\\hat{\\mathbf{z}}) = c \\cos\\beta (\\frac{2\\pi}{a}) + c \\sin\\beta (-\\frac{2\\pi \\cot\\beta}{a}) = \\frac{2\\pi c \\cos\\beta}{a} - \\frac{2\\pi c \\sin\\beta}{a}\\frac{\\cos\\beta}{\\sin\\beta} = 0\n$$\n$$\n\\mathbf{c} \\cdot \\mathbf{b}^{\\ast} = (c \\cos\\beta \\hat{\\mathbf{x}} + c \\sin\\beta \\hat{\\mathbf{z}}) \\cdot (\\frac{2\\pi}{b}\\hat{\\mathbf{y}}) = 0\n$$\n$$\n\\mathbf{c} \\cdot \\mathbf{c}^{\\ast} = (c \\cos\\beta \\hat{\\mathbf{x}} + c \\sin\\beta \\hat{\\mathbf{z}}) \\cdot (\\frac{2\\pi}{c \\sin\\beta}\\hat{\\mathbf{z}}) = c \\sin\\beta (\\frac{2\\pi}{c \\sin\\beta}) = 2\\pi\n$$\n所有九个关系式都成立，这证实了我们推导的表达式的正确性。最终结果是倒易基矢的九个笛卡尔分量的有序列表。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2\\pi}{a} & 0 & -\\frac{2\\pi \\cot\\beta}{a} & 0 & \\frac{2\\pi}{b} & 0 & 0 & 0 & \\frac{2\\pi}{c \\sin\\beta} \\end{pmatrix}}\n$$", "id": "2821810"}, {"introduction": "在知道了衍射峰可能出现的“位置”后，下一个关键问题是它们的“强度”。晶体结构因子 $F_{hkl}$ 正是决定强度的核心物理量，它编码了单位晶胞内原子的排列方式。本练习 [@problem_id:2821795] 探讨了由反常散射（或共振散射）引起的衍射强度变化，这是一种当入射X射线能量接近原子吸收边时，散射能力发生显著改变的强大现象。掌握此计算对于理解用于元素选择性分析和解析复杂结构的先进实验技术至关重要。", "problem": "某二元化合物单晶具有原胞简单立方Bravais晶格，其每个晶胞中包含一个位于分数坐标 $\\left(0,0,0\\right)$ 的A类原子和一个位于分数坐标 $\\left(\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{1}{2}\\right)$ 的B类原子。考虑在某一狭窄光子能量范围内的运动学X射线衍射，在此范围内所有几何因子和热学因子均可视为常数。您需要考察由米勒(Miller)指数 $\\left(1,1,1\\right)$ 标记的布拉格(Bragg)反射。\n\nA原子被调谐扫过其一个吸收边。在此能量范围内，A原子的原子散射因子可写作 $f_{A}=f_{0,A}+f_{A}^{\\prime}+i\\,f_{A}^{\\prime\\prime}$，其中 $f_{0,A}$ 是正常（汤姆孙(Thomson)）项，$f_{A}^{\\prime}$ 是色散修正项，$f_{A}^{\\prime\\prime}$ 是吸收（反常）项。在此范围内，B原子可被视为非共振的，其原子散射因子 $f_{B}=f_{0,B}$ 为实数且不依赖于能量。\n\n在刚好低于吸收边的入射能量下，散射因子的特征为\n- $f_{0,A}=20$ (以电子为单位)，\n- $f_{A}^{\\prime}=-4$ 且 $f_{A}^{\\prime\\prime}=2$，\n- $f_{0,B}=12$ (以电子为单位)，其色散和吸收部分可忽略不计。\n\n当入射能量增加并跨过吸收边时，A原子的变化为\n- $\\Delta f_{A}^{\\prime}=-5$，\n- $\\Delta f_{A}^{\\prime\\prime}=+3$，\n而 $f_{0,A}$ 和 $f_{0,B}$ 保持不变，且B原子保持非共振状态。\n\n请仅使用晶体结构因子的基本定义（即对晶胞内所有原子及其相应相位因子的求和）、原子散射因子分解为其正常和反常部分的方法，以及在运动学极限下衍射强度与结构因子模的平方成正比这一事实，来确定 $\\left(1,1,1\\right)$ 反射的以下物理量：\n\n1. 吸收边前后结构因子大小的变化量，$\\Delta\\lvert F\\rvert=\\lvert F\\rvert_{\\text{above}}-\\lvert F\\rvert_{\\text{below}}$。\n2. 衍射强度之比 $I_{\\text{above}}/I_{\\text{below}}$。\n\n请将大小的变化量以电子为单位表示，强度比表示为无量纲数。将两个报告值均四舍五入至四位有效数字。按顺序 $\\Delta\\lvert F\\rvert$（电子），$I_{\\text{above}}/I_{\\text{below}}$ 提供您的最终结果，形式为两个数字。", "solution": "本题要求计算当入射X射线能量调谐扫过某一原子种类的吸收边时，特定布拉格(Bragg)反射的结构因子大小的变化量以及衍射强度的比值。我们从晶体结构因子的基本定义出发，并进行严格的逻辑推导。\n\n对于由米勒(Miller)指数 $(h,k,l)$ 标记的反射，其晶体结构因子 $F_{hkl}$ 定义为对一个晶胞内所有 $j$ 个原子的求和：\n$$F_{hkl} = \\sum_{j} f_j \\exp[2\\pi i (h x_j + k y_j + l z_j)]$$\n其中 $f_j$ 是原子 $j$ 的原子散射因子，$(x_j, y_j, z_j)$ 是其分数坐标。\n\n该晶胞包含两个原子：\n1. A原子，位于位置 $\\vec{\\tau}_A = (0, 0, 0)$。\n2. B原子，位于位置 $\\vec{\\tau}_B = (\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$。\n\n将这些位置代入结构因子的定义中，可得：\n$$F_{hkl} = f_A \\exp[2\\pi i (h \\cdot 0 + k \\cdot 0 + l \\cdot 0)] + f_B \\exp[2\\pi i (h \\cdot \\frac{1}{2} + k \\cdot \\frac{1}{2} + l \\cdot \\frac{1}{2})]$$\n$$F_{hkl} = f_A \\exp(0) + f_B \\exp[i\\pi(h+k+l)]$$\n$$F_{hkl} = f_A + f_B (-1)^{h+k+l}$$\n\n我们需要考察 $(1,1,1)$ 反射。对于此反射，米勒指数之和为 $h+k+l = 1+1+1=3$，是一个奇数。因此，该反射的结构因子为：\n$$F_{111} = f_A - f_B$$\n\n原子散射因子已知。对于A原子，由于反常色散，其散射因子是复数且依赖于能量：\n$$f_A = f_{0,A} + f_A' + i f_A''$$\n其中 $f_{0,A}$ 是汤姆孙(Thomson)散射项，$f_A'$ 和 $f_A''$ 分别是反常修正的实部和虚部。对于B原子，散射是非共振的，其散射因子为实数且是常数：\n$$f_B = f_{0,B}$$\n\n将这些代入 $F_{111}$ 的表达式中：\n$$F_{111} = (f_{0,A} + f_A' + i f_A'') - f_{0,B}$$\n$$F_{111} = (f_{0,A} + f_A' - f_{0,B}) + i f_A''$$\n衍射强度 $I_{hkl}$ 与结构因子模的平方成正比，即 $I_{hkl} \\propto |F_{hkl}|^2$。$F_{111}$ 的大小为：\n$$|F_{111}| = \\sqrt{(\\text{Re}(F_{111}))^2 + (\\text{Im}(F_{111}))^2} = \\sqrt{(f_{0,A} + f_A' - f_{0,B})^2 + (f_A'')^2}$$\n\n现在我们针对两种指定的能量条件计算这些量。\n\n首先，在刚好低于吸收边的能量下：\n给定的散射因子分量为：\n- $f_{0,A} = 20$\n- $(f_A')_{\\text{below}} = -4$\n- $(f_A'')_{\\text{below}} = 2$\n- $f_{0,B} = 12$\n\n结构因子 $F_{\\text{below}}$ 的实部和虚部分别为：\n$$\\text{Re}(F_{\\text{below}}) = f_{0,A} + (f_A')_{\\text{below}} - f_{0,B} = 20 + (-4) - 12 = 4$$\n$$\\text{Im}(F_{\\text{below}}) = (f_A'')_{\\text{below}} = 2$$\n低于吸收边时结构因子的大小为：\n$$|F|_{\\text{below}} = \\sqrt{(4)^2 + (2)^2} = \\sqrt{16+4} = \\sqrt{20}$$\n\n其次，在刚好高于吸收边的能量下：\nA原子的散射因子发生变化。变化量为 $\\Delta f_A' = -5$ 和 $\\Delta f_A'' = +3$。新的分量为：\n$$(f_A')_{\\text{above}} = (f_A')_{\\text{below}} + \\Delta f_A' = -4 + (-5) = -9$$\n$$(f_A'')_{\\text{above}} = (f_A'')_{\\text{below}} + \\Delta f_A'' = 2 + 3 = 5$$\n正常散射项 $f_{0,A}$ 和 $f_{0,B}$ 保持不变。\n\n结构因子 $F_{\\text{above}}$ 的实部和虚部分别为：\n$$\\text{Re}(F_{\\text{above}}) = f_{0,A} + (f_A')_{\\text{above}} - f_{0,B} = 20 + (-9) - 12 = -1$$\n$$\\text{Im}(F_{\\text{above}}) = (f_A'')_{\\text{above}} = 5$$\n高于吸收边时结构因子的大小为：\n$$|F|_{\\text{above}} = \\sqrt{(-1)^2 + (5)^2} = \\sqrt{1+25} = \\sqrt{26}$$\n\n至此，我们可以计算所要求的量了。\n\n1. 结构因子大小的变化量 $\\Delta |F|$：\n$$\\Delta|F| = |F|_{\\text{above}} - |F|_{\\text{below}} = \\sqrt{26} - \\sqrt{20}$$\n数值上， $|F|_{\\text{above}} \\approx 5.0990195$ 电子， $|F|_{\\text{below}} \\approx 4.4721360$ 电子。\n$$\\Delta|F| \\approx 5.0990195 - 4.4721360 = 0.6268835$$\n四舍五入到四位有效数字，我们得到 $\\Delta|F| \\approx 0.6269$ 电子。\n\n2. 衍射强度的比值 $I_{\\text{above}}/I_{\\text{below}}$：\n由于 $I \\propto |F|^2$，该比值为：\n$$\\frac{I_{\\text{above}}}{I_{\\text{below}}} = \\frac{|F|_{\\text{above}}^2}{|F|_{\\text{below}}^2} = \\frac{(\\sqrt{26})^2}{(\\sqrt{20})^2} = \\frac{26}{20} = 1.3$$\n按照要求表示为四位有效数字，该值为 $1.300$。\n\n最终结果是大小变化量和强度比的数值。", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.6269 & 1.300 \\end{pmatrix} } $$", "id": "2821795"}, {"introduction": "衍射峰的位置揭示了晶格的类型与大小，其强度揭示了原子排布，而峰的“形状”与“宽度”则蕴含了关于材料微观结构的丰富信息。这个计算实践 [@problem_id:2821831] 将指导您建立一个模型来分析粉末衍射数据中的峰形展宽。通过综合考虑仪器效应、有限的晶粒尺寸以及内部微应变所导致的展宽，您将学到一项材料定量分析的核心技能，从而将理论模型与实际数据的解读联系起来。", "problem": "您的任务是构建一个程序，该程序通过结合仪器和样品的贡献，来模拟粉末衍射峰展宽的角度依赖性，然后将模拟的半峰全宽（FWHM）与作为散射角函数观测到的值进行比较。在所有线宽贡献中，请使用高斯近似，并基于以下经过充分测试和广泛使用的基本事实和定义进行推导：(i) 在独立高斯分布的卷积下，方差是相加的；(ii) Bragg-Brentano衍射仪的仪器分辨率函数由三个仪器参数指定的Caglioti形式描述；(iii) 微晶尺寸展宽遵循Scherrer方程；(iv) 微应变展宽遵循Williamson–Hall框架。所有的三角函数依赖关系必须用布拉格角$\\theta$表示，其中$2\\theta$是常规的衍射散射角。输入和输出的角度将以度为单位，但在使用三角函数时，您必须在内部将其转换为弧度。您的程序必须为每个测试用例输出一个均方根误差（RMSE）作为定量比较。\n\n从这些基本事实出发，通过适当地表示仪器、尺寸和应变的贡献，并在高斯卷积假设下将它们组合起来，推导出预测的总FWHM $H_{\\text{tot}}(2\\theta)$ 的工作表达式，单位为$2\\theta$度。请确保所有需要的单位转换都得到一致处理。仪器分辨率由三个常数$\\,U\\,、\\,V\\,$和$\\,W\\,$完全表征，单位为平方度；由样品尺寸和微应变引起的线形展宽将由形状因子$\\,K\\,$（无量纲）、X射线波长$\\lambda$（单位为埃）、体积平均微晶尺寸$\\,L\\,$（单位为纳米）和均方根微应变$\\,\\varepsilon\\,$（无量纲）参数化。观测到的FWHM值以$2\\theta$度为单位给出。程序必须计算在给定$2\\theta$值列表下的预测FWHM，与观测值进行比较，并报告以度为单位的RMSE。\n\n角度单位：所有给定的角度$2\\theta$都是以度为单位，所有三角函数都必须在$\\theta = (2\\theta)/2$（表示为弧度）下求值。输出单位：以$2\\theta$度为单位报告RMSE值，四舍五入到六位小数。\n\n测试套件。实现您的程序以精确评估以下三种情况。对于每种情况，计算模拟FWHM值与观测FWHM值之间的RMSE。您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的RMSE列表，顺序为案例A、案例B、案例C；例如，输出形式为$\\,\\texttt{[x\\_A,x\\_B,x\\_C]}\\,$，其中每个$\\,x\\,$都四舍五入到六位小数。\n\n- 案例A（具有中等尺寸和应变的典型混合展宽）：\n  - 仪器参数 (Caglioti): $\\,U = 0.003\\,$, $\\,V = 0.000\\,$, $\\,W = 0.002\\,$ (单位均为平方度)。\n  - 样品参数: $\\,K = 0.9\\,$, $\\,\\lambda = 1.5406\\,$ 埃, $\\,L = 80\\,$ 纳米, $\\,\\varepsilon = 0.001\\,$.\n  - 散射角 ($2\\theta$度): $\\,\\{20,\\,40,\\,60,\\,80,\\,100\\}\\,$.\n  - 观测到的FWHM ($2\\theta$度): $\\,\\{0.1179,\\,0.1432,\\,0.1835,\\,0.2406,\\,0.3236\\}\\,$.\n\n- 案例B（仪器主导的展宽）：\n  - 仪器参数 (Caglioti): $\\,U = 0.010\\,$, $\\,V = 0.000\\,$, $\\,W = 0.002\\,$ (单位均为平方度)。\n  - 样品参数（近似可忽略的尺寸/应变）: $\\,K = 0.9\\,$, $\\,\\lambda = 1.5406\\,$ 埃, $\\,L = 10^{9}\\,$ 纳米, $\\,\\varepsilon = 0.000\\,$.\n  - 散射角 ($2\\theta$度): $\\,\\{15,\\,30,\\,60,\\,120\\}\\,$.\n  - 观测到的FWHM ($2\\theta$度): $\\,\\{0.0466,\\,0.0522,\\,0.0730,\\,0.1789\\}\\,$.\n\n- 案例C（高角度微应变主导的展宽）：\n  - 仪器参数 (Caglioti): $\\,U = 0.000\\,$, $\\,V = 0.000\\,$, $\\,W = 0.005\\,$ (单位均为平方度)。\n  - 样品参数: $\\,K = 0.9\\,$, $\\,\\lambda = 1.5406\\,$ 埃, $\\,L = 10^{9}\\,$ 纳米, $\\,\\varepsilon = 0.002\\,$.\n  - 散射角 ($2\\theta$度): $\\,\\{30,\\,90,\\,150\\}\\,$.\n  - 观测到的FWHM ($2\\theta$度): $\\,\\{0.1418,\\,0.4640,\\,1.7116\\}\\,$.\n\n最终输出格式。您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，严格按照$\\,\\texttt{[RMSE\\_A,RMSE\\_B,RMSE\\_C]}\\,$的顺序。每个$\\,\\texttt{RMSE}\\,$值必须四舍五入到六位小数。不允许有其他输出。", "solution": "该问题要求推导一个X射线衍射峰展宽的模型，并应用该模型计算预测的半峰全宽（FWHM）值与观测值之间的均方根误差（RMSE）。推导过程必须基于第一性原理和指定的确立模型。\n\n组合不同来源的峰展宽的基本原理基于一个假设：每个对线形（仪器、微晶尺寸、微应变）的贡献都可以用一个高斯函数来描述。观测到的总峰形是这些单个峰形的卷积。高斯函数的一个关键数学性质是，两个或多个高斯函数的卷积结果是另一个高斯函数，其方差（$\\sigma^2$）是各个高斯函数方差的总和。\n\n高斯函数的半峰全宽（$H$）与其标准差（$\\sigma$）通过一个常数因子相关：$H = 2\\sqrt{2\\ln{2}} \\sigma$。因此，FWHM的平方与方差成正比：$H^2 = (8\\ln{2})\\sigma^2$。所以，方差的相加等同于FWHM平方值的相加：\n$$\nH_{\\text{tot}}^2 = H_{\\text{instr}}^2 + H_{\\text{specimen}}^2\n$$\n样品展宽本身是有限微晶尺寸（$H_{\\text{size}}$）和晶格微应变（$H_{\\text{strain}}$）贡献的组合。假设这些也是独立的高斯贡献，总FWHM的平方由下式给出：\n$$\nH_{\\text{pred}}^2(2\\theta) = H_{\\text{instr}}^2(2\\theta) + H_{\\text{size}}^2(2\\theta) + H_{\\text{strain}}^2(2\\theta)\n$$\n其中$H_{\\text{pred}}$是预测的总FWHM。每一项都是散射角$2\\theta$的函数。我们现在推导每个贡献的表达式，单位为$2\\theta$度。所有用于三角函数的角度都必须转换为弧度。布拉格角$\\theta$是散射角的一半，即$\\theta = (2\\theta)/2$。\n\n1.  **仪器展宽, $H_{\\text{instr}}(2\\theta)$**: 问题指出，仪器分辨率由Caglioti方程描述。这个经验公式将FWHM的平方表示为$\\tan\\theta$的多项式：\n    $$\n    H_{\\text{instr}}^2(2\\theta) = U \\tan^2\\theta + V \\tan\\theta + W\n    $$\n    参数$U$、$V$和$W$是仪器特定的常数，单位为平方度（deg$^2$）。布拉格角$\\theta$在传递给$\\tan$函数时必须是弧度，得到的$H_{\\text{instr}}^2$单位是deg$^2$。\n\n2.  **微晶尺寸展宽, $H_{\\text{size}}(2\\theta)$**: 这个贡献由Scherrer方程决定，该方程将体积平均微晶尺寸$L$与以弧度表示的峰的FWHM $\\beta_{\\text{size}}$联系起来：\n    $$\n    L = \\frac{K \\lambda}{\\beta_{\\text{size}} \\cos\\theta}\n    $$\n    这里，$K$是无量纲的Scherrer形状因子，$\\lambda$是X射线波长。为确保单位一致，我们必须用相同的单位表示$L$和$\\lambda$，例如埃（Å）。给定$L$的单位是纳米（nm），$\\lambda$的单位是埃（Å），我们使用换算关系$1 \\text{ nm} = 10 \\text{ Å}$。解出$\\beta_{\\text{size}}$：\n    $$\n    \\beta_{\\text{size}} \\text{ [弧度]} = \\frac{K \\lambda_{\\text{[Å]}}}{(L_{\\text{[nm]}} \\times 10) \\cos\\theta}\n    $$\n    以度为单位的FWHM $H_{\\text{size}}$，可以通过将$\\beta_{\\text{size}}$从弧度转换得到：$H_{\\text{size}} = \\beta_{\\text{size}} \\times \\frac{180}{\\pi}$。将此表达式平方，得到以deg$^2$为单位的贡献：\n    $$\n    H_{\\text{size}}^2(2\\theta) = \\left( \\frac{K \\lambda}{10 L \\cos\\theta} \\cdot \\frac{180}{\\pi} \\right)^2\n    $$\n\n3.  **微应变展宽, $H_{\\text{strain}}(2\\theta)$**: 在Williamson-Hall框架内，来自均方根微应变$\\varepsilon$的FWHM贡献与$\\tan\\theta$相关。以弧度表示的展宽$\\beta_{\\text{strain}}$由下式给出：\n    $$\n    \\beta_{\\text{strain}} \\text{ [弧度]} = 4 \\varepsilon \\tan\\theta\n    $$\n    因子$4$是该模型的常规常数。与尺寸贡献类似，我们将其转换为度并平方，以获得以deg$^2$为单位的FWHM平方：\n    $$\n    H_{\\text{strain}}^2(2\\theta) = \\left( 4 \\varepsilon \\tan\\theta \\cdot \\frac{180}{\\pi} \\right)^2\n    $$\n\n将这三个贡献组合起来，得到总的预测FWHM平方：\n$$\nH_{\\text{pred}}^2(2\\theta) = (U \\tan^2\\theta + V \\tan\\theta + W) + \\left( \\frac{K \\lambda}{10 L \\cos\\theta} \\frac{180}{\\pi} \\right)^2 + \\left( 4 \\varepsilon \\tan\\theta \\frac{180}{\\pi} \\right)^2\n$$\n以度为单位的预测FWHM是此表达式的平方根：\n$$\nH_{\\text{pred}}(2\\theta) = \\sqrt{(U \\tan^2\\theta + V \\tan\\theta + W) + \\left( \\frac{K \\lambda}{10 L \\cos\\theta} \\frac{180}{\\pi} \\right)^2 + \\left( 4 \\varepsilon \\tan\\theta \\frac{180}{\\pi} \\right)^2}\n$$\n在此公式中，$\\theta = \\frac{2\\theta_{\\text{deg}}}{2}$，必须将其转换为弧度以用于三角函数。参数$\\lambda$和$L$分别以埃和纳米为单位给出。\n\n最后，为量化模型与观测值之间的一致性，我们计算均方根误差（RMSE）。对于一组$N$个观测值，RMSE定义为：\n$$\n\\text{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} (H_{\\text{pred}}(2\\theta_i) - H_{\\text{obs}}(2\\theta_i))^2}\n$$\n其中$H_{\\text{pred}}(2\\theta_i)$是在角度$2\\theta_i$处的预测FWHM，$H_{\\text{obs}}(2\\theta_i)$是相应的观测FWHM。最终的RMSE将以度为单位报告。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the RMSE between simulated and observed powder diffraction FWHM values\n    for three distinct test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case A: Typical mixed broadening\n        {\n            \"params\": {\"U\": 0.003, \"V\": 0.000, \"W\": 0.002, \"K\": 0.9, \"lam\": 1.5406, \"L\": 80, \"eps\": 0.001},\n            \"two_theta_deg\": np.array([20, 40, 60, 80, 100]),\n            \"h_obs_deg\": np.array([0.1179, 0.1432, 0.1835, 0.2406, 0.3236]),\n        },\n        # Case B: Instrument-dominated broadening\n        {\n            \"params\": {\"U\": 0.010, \"V\": 0.000, \"W\": 0.002, \"K\": 0.9, \"lam\": 1.5406, \"L\": 1e9, \"eps\": 0.000},\n            \"two_theta_deg\": np.array([15, 30, 60, 120]),\n            \"h_obs_deg\": np.array([0.0466, 0.0522, 0.0730, 0.1789]),\n        },\n        # Case C: High-angle microstrain-dominated broadening\n        {\n            \"params\": {\"U\": 0.000, \"V\": 0.000, \"W\": 0.005, \"K\": 0.9, \"lam\": 1.5406, \"L\": 1e9, \"eps\": 0.002},\n            \"two_theta_deg\": np.array([30, 90, 150]),\n            \"h_obs_deg\": np.array([0.1418, 0.4640, 1.7116]),\n        },\n    ]\n\n    def calculate_predicted_fwhm(params, two_theta_deg):\n        \"\"\"\n        Calculates the predicted total FWHM based on instrumental, size, and strain broadening.\n\n        Args:\n            params (dict): Dictionary of model parameters (U, V, W, K, lam, L, eps).\n            two_theta_deg (np.ndarray): Array of 2-theta scattering angles in degrees.\n\n        Returns:\n            np.ndarray: Predicted FWHM values in degrees of 2-theta.\n        \"\"\"\n        U, V, W, K, lam, L, eps = params[\"U\"], params[\"V\"], params[\"W\"], params[\"K\"], params[\"lam\"], params[\"L\"], params[\"eps\"]\n        \n        # Calculate theta in radians\n        theta_rad = np.deg2rad(two_theta_deg / 2.0)\n\n        # Trigonometric terms\n        tan_theta = np.tan(theta_rad)\n        cos_theta = np.cos(theta_rad)\n\n        # 1. Instrumental broadening contribution (Caglioti)\n        # U, V, W are given in deg^2, so H_instr_sq is in deg^2\n        h_instr_sq = U * tan_theta**2 + V * tan_theta + W\n\n        # 2. Crystallite size broadening contribution (Scherrer)\n        # Convert beta_size from radians to degrees, then square\n        # L must be converted from nm to Angstroms by multiplying by 10\n        # The np.divide handles potential division by zero for cos(theta), although not for theta=90 deg.\n        # At 2theta=180, cos(theta)=0. We protect against this case.\n        h_size_sq = np.zeros_like(cos_theta)\n        non_zero_cos = cos_theta != 0\n        beta_size_rad = (K * lam) / (10 * L * cos_theta[non_zero_cos])\n        h_size_deg = np.rad2deg(beta_size_rad)\n        h_size_sq[non_zero_cos] = h_size_deg**2\n        \n        # 3. Microstrain broadening contribution (Williamson-Hall)\n        # Convert beta_strain from radians to degrees, then square\n        beta_strain_rad = 4 * eps * tan_theta\n        h_strain_deg = np.rad2deg(beta_strain_rad)\n        h_strain_sq = h_strain_deg**2\n\n        # Total FWHM squared is the sum of the squared contributions\n        h_pred_sq = h_instr_sq + h_size_sq + h_strain_sq\n        \n        # Predicted FWHM is the square root\n        h_pred = np.sqrt(h_pred_sq)\n        \n        return h_pred\n\n    results = []\n    for case in test_cases:\n        h_pred = calculate_predicted_fwhm(case[\"params\"], case[\"two_theta_deg\"])\n        \n        # Calculate Root Mean Square Error (RMSE)\n        squared_errors = np.square(h_pred - case[\"h_obs_deg\"])\n        mean_squared_error = np.mean(squared_errors)\n        rmse = np.sqrt(mean_squared_error)\n        \n        results.append(rmse)\n\n    # Format the final output string as [RMSE_A,RMSE_B,RMSE_C]\n    # with each RMSE rounded to six decimal places.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2821831"}]}