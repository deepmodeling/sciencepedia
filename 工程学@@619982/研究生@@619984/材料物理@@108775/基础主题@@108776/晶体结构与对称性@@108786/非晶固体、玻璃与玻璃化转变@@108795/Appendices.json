{"hands_on_practices": [{"introduction": "与晶体不同，玻璃缺乏长程有序结构，这使得描述其原子排列成为一项挑战。为了理解玻璃的性质，我们必须首先量化其局域原子环境。维诺(Voronoi)分析是一种强大的几何工具，它为系统中的每个原子分配一个唯一的空间区域，从而使我们能够精确地表征局域结构。这个练习将指导你使用一组给定的、描述金属玻璃中不同局域原子“基元”及其占比的假设数据，通过第一性原理计算其平均配位数和宏观堆积分数，从而将微观结构信息与宏观物理性质联系起来。", "problem": "一种单原子金属玻璃表现出一种由沃罗诺伊指数表征的局域原子环境分布。对于一个原子，其沃罗诺伊指数记为 $\\langle n_{3}, n_{4}, n_{5}, n_{6} \\rangle$，其中 $n_{k}$ 是具有 $k$ 条边的沃罗诺伊多面体面的数量。根据定义，配位数是沃罗诺伊多面体上的总面数。\n\n考虑样品中以下五种最常见的基元及其占比：\n- $\\langle 0,0,12,0 \\rangle$，分数为 $f_{1} = 0.42$，\n- $\\langle 0,1,10,2 \\rangle$，分数为 $f_{2} = 0.18$，\n- $\\langle 0,2,8,2 \\rangle$，分数为 $f_{3} = 0.15$，\n- $\\langle 0,3,6,0 \\rangle$，分数为 $f_{4} = 0.12$，\n- $\\langle 0,0,10,2 \\rangle$，分数为 $f_{5} = 0.13$。\n\n独立的结构分析表明，对于半径为 $r$ 的等径原子，每种基元中原子的平均沃罗诺伊胞腔体积（以单原子体积 $v_{\\mathrm{atom}} = \\frac{4}{3} \\pi r^{3}$ 为单位）为：\n- $V_{1} = 1.52 \\, v_{\\mathrm{atom}}$，\n- $V_{2} = 1.58 \\, v_{\\mathrm{atom}}$，\n- $V_{3} = 1.56 \\, v_{\\mathrm{atom}}$，\n- $V_{4} = 1.72 \\, v_{\\mathrm{atom}}$，\n- $V_{5} = 1.54 \\, v_{\\mathrm{atom}}$。\n\n从第一性原理出发，完成以下任务：\n1. 使用沃罗诺伊多面体配位数的定义，计算样品的平均配位数。\n2. 使用堆积率（原子占据的空间分数）的定义，以及将沃罗诺伊镶嵌解释为一种为每个原子分配唯一体积的空间填充划分，推导一个用基元分数、各基元的沃罗诺伊体积和 $v_{\\mathrm{atom}}$ 表示的宏观堆积率表达式。对给定数据进行数值计算。\n\n最终答案只报告堆积率的数值，表示为无量纲小数，并四舍五入到四位有效数字。", "solution": "该问题要求分析一种单原子金属玻璃的结构特性，具体而言，就是基于给定的由沃罗诺伊指数描述的局域原子环境分布，计算其平均配位数和宏观堆积率。\n\n首先，有必要对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- **沃罗诺伊指数：** $\\langle n_{3}, n_{4}, n_{5}, n_{6} \\rangle$，其中 $n_k$ 是具有 $k$ 条边的沃罗诺伊多面体面的数量。\n- **配位数 ($CN$)：** 定义为沃罗诺伊多面体的总面数，所以 $CN = \\sum_k n_k$。\n- **基元占比：**\n  - 基元 1: $\\langle 0,0,12,0 \\rangle$，分数 $f_{1} = 0.42$\n  - 基元 2: $\\langle 0,1,10,2 \\rangle$，分数 $f_{2} = 0.18$\n  - 基元 3: $\\langle 0,2,8,2 \\rangle$，分数 $f_{3} = 0.15$\n  - 基元 4: $\\langle 0,3,6,0 \\rangle$，分数 $f_{4} = 0.12$\n  - 基元 5: $\\langle 0,0,10,2 \\rangle$，分数 $f_{5} = 0.13$\n- **单原子体积：** 对于半径为 $r$ 的原子，$v_{\\mathrm{atom}} = \\frac{4}{3} \\pi r^{3}$。\n- **平均沃罗诺伊胞腔体积 ($V_i$)：**\n  - $V_{1} = 1.52 \\, v_{\\mathrm{atom}}$\n  - $V_{2} = 1.58 \\, v_{\\mathrm{atom}}$\n  - $V_{3} = 1.56 \\, v_{\\mathrm{atom}}$\n  - $V_{4} = 1.72 \\, v_{\\mathrm{atom}}$\n  - $V_{5} = 1.54 \\, v_{\\mathrm{atom}}$\n- **堆积率 ($\\phi$)：** 定义为原子占据的空间分数。\n- **任务：**\n  1. 计算平均配位数 $\\overline{CN}$。\n  2. 推导并计算宏观堆积率 $\\phi$ 的表达式。\n- **最终答案：** 只报告堆积率的数值，四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，采用了材料物理学中的标准概念，例如用沃罗诺伊分析来表征非晶结构。所提供的数据是一致的；基元分数的总和为 $f_1+f_2+f_3+f_4+f_5 = 0.42 + 0.18 + 0.15 + 0.12 + 0.13 = 1.00$，使得该问题是自洽的。提供的沃罗诺伊指数对应于已知的稳定多面体（例如，$\\langle 0,0,12,0 \\rangle$ 是二十面体）。定义清晰明确。该问题是适定的、客观的。\n\n**步骤3：结论与行动**\n该问题有效。将构建解答。\n\n解答按要求分为两部分进行，尽管只有第二部分的结果构成最终答案。\n\n**第一部分：平均配位数**\n\n对于基元 $i$ 中的一个原子，其配位数 $CN_i$ 是其沃罗诺伊指数中整数的总和，$CN_i = n_3 + n_4 + n_5 + n_6$。\n对于每个基元：\n- $\\langle 0,0,12,0 \\rangle$ 的 $CN_1$ 是 $0+0+12+0 = 12$。\n- $\\langle 0,1,10,2 \\rangle$ 的 $CN_2$ 是 $0+1+10+2 = 13$。\n- $\\langle 0,2,8,2 \\rangle$ 的 $CN_3$ 是 $0+2+8+2 = 12$。\n- $\\langle 0,3,6,0 \\rangle$ 的 $CN_4$ 是 $0+3+6+0 = 9$。\n- $\\langle 0,0,10,2 \\rangle$ 的 $CN_5$ 是 $0+0+10+2 = 12$。\n\n样品的平均配位数 $\\overline{CN}$ 是各个配位数的加权平均值，其中权重为基元分数 $f_i$：\n$$\n\\overline{CN} = \\sum_{i=1}^{5} f_i CN_i\n$$\n代入给定值：\n$$\n\\overline{CN} = (0.42)(12) + (0.18)(13) + (0.15)(12) + (0.12)(9) + (0.13)(12)\n$$\n$$\n\\overline{CN} = 5.04 + 2.34 + 1.80 + 1.08 + 1.56 = 11.82\n$$\n对于致密的金属玻璃来说，这个结果在物理上是合理的。然而，它不是所要求的最终答案。\n\n**第二部分：宏观堆积率**\n\n宏观堆积率 $\\phi$ 定义为原子占据的总體積除以系统的总体积。\n$$\n\\phi = \\frac{V_{\\text{atoms}}}{V_{\\text{total}}}\n$$\n考虑一个包含大量原子（数量为 $N$）的系统。由于所有原子都相同，原子的总体积为 $V_{\\text{atoms}} = N \\cdot v_{\\mathrm{atom}}$。\n沃罗诺伊镶嵌将系统总体积划分为 $N$ 个胞腔，每个原子对应一个。总体积是这些胞腔的体积之和。这个总和可以按基元类型分组。类型为 $i$ 的基元原子数为 $N_i = f_i N$。基元 $i$ 的平均沃罗诺伊胞腔体积为 $V_i$。因此，系统的总体积为：\n$$\nV_{\\text{total}} = \\sum_{i=1}^{5} N_i V_i = \\sum_{i=1}^{5} (f_i N) V_i = N \\sum_{i=1}^{5} f_i V_i\n$$\n那么，堆积率为：\n$$\n\\phi = \\frac{N \\cdot v_{\\mathrm{atom}}}{N \\sum_{i=1}^{5} f_i V_i} = \\frac{v_{\\mathrm{atom}}}{\\sum_{i=1}^{5} f_i V_i}\n$$\n问题以单原子体积为单位提供了平均沃罗诺伊胞腔体积，即 $V_i = c_i v_{\\mathrm{atom}}$，其中 $c_i$ 是给定的无量纲常数（$c_1=1.52$，$c_2=1.58$ 等）。将此代入 $\\phi$ 的表达式中：\n$$\n\\phi = \\frac{v_{\\mathrm{atom}}}{\\sum_{i=1}^{5} f_i (c_i v_{\\mathrm{atom}})} = \\frac{v_{\\mathrm{atom}}}{v_{\\mathrm{atom}} \\sum_{i=1}^{5} f_i c_i} = \\frac{1}{\\sum_{i=1}^{5} f_i c_i}\n$$\n这就是推导出的解析表达式。堆积率是以 $v_{\\mathrm{atom}}$ 为单位的平均沃罗诺伊胞腔体积的倒数。\n\n现在，我们对此表达式进行数值计算。分母是平均无量纲体积 $\\bar{c}$。\n$$\n\\bar{c} = \\sum_{i=1}^{5} f_i c_i = f_1 c_1 + f_2 c_2 + f_3 c_3 + f_4 c_4 + f_5 c_5\n$$\n代入给定值：\n$$\n\\bar{c} = (0.42)(1.52) + (0.18)(1.58) + (0.15)(1.56) + (0.12)(1.72) + (0.13)(1.54)\n$$\n$$\n\\bar{c} = 0.6384 + 0.2844 + 0.2340 + 0.2064 + 0.2002 = 1.5634\n$$\n堆积率是此值的倒数：\n$$\n\\phi = \\frac{1}{1.5634} \\approx 0.63963157...\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\n\\phi \\approx 0.6396\n$$\n这个值与球体的密实随机堆积的典型堆积率一致。", "answer": "$$\\boxed{0.6396}$$", "id": "2799722"}, {"introduction": "在理解了玻璃的局域几何结构之后，下一步是探究这些原子如何通过化学键连接成一个宏观的刚性网络。拓扑约束理论（Topological Constraint Theory, TCT）提供了一个简洁而深刻的理论框架，它将网络的原子连接性（即平均配位数 $\\langle r \\rangle$）与其宏观力学稳定性直接关联起来。本练习将让你应用TCT的核心思想——通过计算化学键产生的力学约束数量，并将其与原子的平动自由度数量进行比较——来预测一个硫系玻璃网络是柔性的、等约束的还是应力刚性的。", "problem": "考虑一种宏观均匀、化学有序的锗-砷-硒体系硫系玻璃，其原子分数组成为 $\\mathrm{Ge}_{0.17}\\mathrm{As}_{0.19}\\mathrm{Se}_{0.64}$。假设在一个大$N$极限下，该网络为完全聚合的三维共价网络，无悬挂键，无冗余环约束。使用八隅体（8-N）规则来确定局部配位数：锗为四配位（$r_{\\mathrm{Ge}}=4$），砷为三配位（$r_{\\mathrm{As}}=3$），硒为二配位（$r_{\\mathrm{Se}}=2$）。假设所有的中心力键伸缩和键弯曲相互作用都是完整且独立的。\n\n使用拓扑约束理论（TCT），从三维空间中自由度和约束的麦克斯韦计数出发，以第一性原理确定：\n- 每原子的键伸缩约束数，$n_s$，\n- 每原子的键弯曲约束数，$n_b$，\n- 以及每原子的总约束数，$n_c=n_s+n_b$，\n\n针对此成分。根据您计算出的 $n_c$ 值，判断该网络是柔性的、等静定的还是应力刚性的，其判据为：在三维空间中，当每原子的约束数等于每原子的平移自由度数时，系统达到力学等静定状态。\n\n最终答案仅需提供每原子的总约束数 $n_c$，以一个无量纲数字表示。将最终答案四舍五入至4位有效数字。", "solution": "首先对问题陈述进行验证。\n\n步骤1：提取已知条件。\n- 系统：宏观均匀、化学有序的锗-砷-硒体系硫系玻璃。\n- 组成：原子分数为 $\\mathrm{Ge}_{x}\\mathrm{As}_{y}\\mathrm{Se}_{z}$，其中 $x=0.17$, $y=0.19$, $z=0.64$。\n- 网络假设：完全聚合的三维（$d=3$）共价网络，处于大$N$极限下，无悬挂键，无冗余环约束。\n- 配位数：根据八隅体（8-N）规则，$r_{\\mathrm{Ge}}=4$，$r_{\\mathrm{As}}=3$，$r_{\\mathrm{Se}}=2$。\n- 相互作用：所有中心力键伸缩和键弯曲相互作用均完整且独立。\n- 理论框架：使用麦克斯韦计数的拓扑约束理论（TCT）。\n- 目标：确定每原子的键伸缩约束数（$n_s$）、每原子的键弯曲约束数（$n_b$）和每原子的总约束数（$n_c$），并对网络的刚性进行分类。\n- 等静定判据：在三维空间中，当 $n_c=3$ 时，达到力学等静定状态。\n\n步骤2：使用提取的已知条件进行验证。\n- 该问题具有科学依据。它涉及拓扑约束理论的应用，这是凝聚态物理学中一个用于描述硫系玻璃等非晶网络性质的标准且成熟的模型。其组成和配位规则对于此类材料是标准的。\n- 该问题提法恰当且自洽。它提供了进行计算所需的所有必要参数（原子分数、配位数、维度）。目标明确无歧义。\n- 该问题是客观的。语言精确且定量，没有任何推测性或主观性陈述。\n- 原子分数之和为 $0.17 + 0.19 + 0.64 = 1.00$，确认了成分的一致性。\n\n步骤3：结论与行动。\n该问题被认为是有效的，因为它科学合理、提法恰当、客观且完整。可以构建严谨的解决方案。\n\n拓扑约束理论的基本原理是将每原子的力学约束数 $n_c$ 与每原子的平移自由度数 $d$ 进行比较。对于指定的三维网络，$d=3$。网络的稳定性由差值 $d - n_c$ 的符号确定。\n\n第一步是计算网络的平均配位数，记为 $\\langle r \\rangle$。这是构成原子的配位数的加权平均值，其中权重为其原子分数。\n给定组成为 $\\mathrm{Ge}_{0.17}\\mathrm{As}_{0.19}\\mathrm{Se}_{0.64}$，配位数为 $r_{\\mathrm{Ge}}=4$, $r_{\\mathrm{As}}=3$ 和 $r_{\\mathrm{Se}}=2$，则平均配位数为：\n$$\n\\langle r \\rangle = x \\cdot r_{\\mathrm{Ge}} + y \\cdot r_{\\mathrm{As}} + z \\cdot r_{\\mathrm{Se}}\n$$\n代入给定值：\n$$\n\\langle r \\rangle = (0.17)(4) + (0.19)(3) + (0.64)(2) = 0.68 + 0.57 + 1.28 = 2.53\n$$\n\n接下来，我们确定每原子的约束数，它是每原子的键伸缩约束数和键弯曲约束数之和，$n_c = n_s + n_b$。\n\n每原子的键伸缩约束数 $n_s$ 由化学键的数量确定。在一个包含 $N$ 个原子的网络中，由于每个键连接两个原子，总的化学键数为 $\\frac{1}{2} N \\langle r \\rangle$。由于每个键代表一个中心力约束，因此每原子的伸缩约束数为：\n$$\nn_s = \\frac{\\frac{1}{2} N \\langle r \\rangle}{N} = \\frac{\\langle r \\rangle}{2}\n$$\n使用计算出的 $\\langle r \\rangle$ 值：\n$$\nn_s = \\frac{2.53}{2} = 1.265\n$$\n\n每原子的键弯曲约束数 $n_b$ 源于每个原子处的角向约束。对于一个在 $d=3$ 维空间中配位数为 $r_i \\geq 2$ 的中心原子，存在 $2r_i - 3$ 个独立的键弯曲约束。配位数 $r_i < 2$ 的原子不产生弯曲约束。在本问题中，所有原子种类的配位数均满足 $r_i \\geq 2$。每原子的总键弯曲约束数是组分的平均值：\n$$\nn_b = \\sum_{i} x_i (2r_i - 3) = x(2r_{\\mathrm{Ge}} - 3) + y(2r_{\\mathrm{As}} - 3) + z(2r_{\\mathrm{Se}} - 3)\n$$\n这个表达式可以用平均配位数来简化：\n$$\nn_b = 2 \\left( \\sum_{i} x_i r_i \\right) - 3 \\left( \\sum_{i} x_i \\right) = 2\\langle r \\rangle - 3\n$$\n代入 $\\langle r \\rangle$ 的值：\n$$\nn_b = 2(2.53) - 3 = 5.06 - 3 = 2.06\n$$\n\n每原子的总约束数 $n_c$ 是伸缩约束和弯曲约束之和：\n$$\nn_c = n_s + n_b = \\frac{\\langle r \\rangle}{2} + (2\\langle r \\rangle - 3) = \\frac{5}{2}\\langle r \\rangle - 3\n$$\n使用计算出的值：\n$$\nn_c = 1.265 + 2.06 = 3.325\n$$\n或者，使用最终公式：\n$$\nn_c = \\frac{5}{2}(2.53) - 3 = 6.325 - 3 = 3.325\n$$\n结果一致。\n\n最后，我们根据麦克斯韦等静定判据对网络进行分类，在 $d=3$ 维空间中，当 $n_c = d = 3$ 时，达到等静定状态。\n- 若 $n_c < 3$，网络是柔性的（欠约束）。\n- 若 $n_c = 3$，网络是等静定的（最佳约束）。\n- 若 $n_c > 3$，网络是应力刚性的（过约束）。\n\n在这种情况下，我们计算出 $n_c = 3.325$。由于 $n_c > 3$，该网络被分类为应力刚性网络。\n\n问题要求提供每原子的总约束数 $n_c$，作为一个四舍五入至4位有效数字的无量纲数。计算值为 $3.325$，该值已具有4位有效数字。", "answer": "$$\\boxed{3.325}$$", "id": "2799773"}, {"introduction": "玻璃态物质的一个决定性特征是，当其从液态冷却时，其动力学弛豫时间会发生惊人的减速。本实践练习深入探讨了如何量化这一行为，它基于高分子和玻璃形成液体中广泛应用的两个核心概念：时间-温度叠加原理（time-temperature superposition, TTS）和Williams-Landel-Ferry (WLF) 方程。通过对一组假设的实验数据进行非线性拟合，你不仅将掌握一种实用的数据分析方法，还将计算出动力学脆性指数 $m$，这是一个对玻璃形成液体动力学行为进行分类的关键参数。", "problem": "考虑一个遵循时间-温度叠加 (TTS) 原理的聚合物玻璃形成体，其水平位移因子 $a_T$ 关联了粘弹性响应函数的温度依赖性。在玻璃化转变点附近，一个广泛使用的关于位移因子常用对数的经验关系式是 Williams–Landel–Ferry (WLF) 方程。该方程通过两个材料特定常数 $C_1$ 和 $C_2$ 来表达 $a_T$ 围绕参考温度 $T_{\\mathrm{ref}}$ 的温度依赖性。动态脆性指数 $m$ 用于量化特征弛豫时间（或粘度）在玻璃化转变温度 $T_g$ 处对温度依赖性的陡峭程度，其定义为弛豫时间的常用对数 $\\log_{10}$ 对 $T_g/T$ 的斜率，并在 $T=T_g$ 处取值。\n\n从上述定义出发，并将 WLF 方程视为一个适用于玻璃化转变点附近聚合物的、经过充分检验的经验定律，编写一个程序，针对下方的每个测试用例执行以下任务：\n\n- 使用非线性最小二乘法，根据提供的关于指定参考温度 $T_{\\mathrm{ref}}$ 的测量值 $\\log_{10} a_T$ 作为温度 $T$ 的函数，拟合 WLF 参数 $C_1$ 和 $C_2$。\n- 根据拟合出的参数以及脆性指数 $m$ 的定义（即特征时间的 $\\log_{10}$ 对 $T_g/T$ 在 $T=T_g$ 处的斜率），利用微积分和 WLF 拟合结果推导并计算 $m$。假设测得的 $\\log_{10} a_T$ 通过 TTS 原理捕捉了特征时间的温度依赖性，因此 $\\log_{10} a_T$ 的斜率决定了脆性。\n- 对每个测试用例，以浮点数形式返回 $m$。\n\n所有温度必须以开尔文（即 $\\mathrm{K}$）为单位进行处理和报告。脆性指数 $m$ 是无量纲的。您的程序应计算每个测试用例的 $m$ 值，并报告四舍五入到三位小数的结果。\n\n测试套件（每个用例提供 $T_{\\mathrm{ref}}$、$T_g$、一组温度 $T_i$（单位为 $\\mathrm{K}$）以及测量的 $\\log_{10} a_T(T_i)$ 值）：\n\n- 用例 A（理想情况；数据分布适中，实验噪声较小）：\n  - $T_{\\mathrm{ref}} = 373\\,\\mathrm{K}$, $T_g = 373\\,\\mathrm{K}$。\n  - 温度：$[353,363,373,383,393]\\,\\mathrm{K}$。\n  - 测量的 $\\log_{10} a_T$：$[11.058,4.182,0.000,-2.821,-4.893]$。\n- 用例 B（强玻璃形成体；脆性较低；实验噪声较小）：\n  - $T_{\\mathrm{ref}} = 323\\,\\mathrm{K}$, $T_g = 323\\,\\mathrm{K}$。\n  - 温度：$[303,313,323,333,343]\\,\\mathrm{K}$。\n  - 测量的 $\\log_{10} a_T$：$[4.970,2.020,0.000,-1.439,-2.470]$。\n- 用例 C（涵盖 $T_{\\mathrm{ref}} \\neq T_g$ 的情况；与 WLF 方程精确一致的数据）：\n  - $T_{\\mathrm{ref}} = 333\\,\\mathrm{K}$, $T_g = 348\\,\\mathrm{K}$。\n  - 温度：$[313,323,333,343,353]\\,\\mathrm{K}$。\n  - 测量的 $\\log_{10} a_T$：$[5.000,2.142857,0.000,-1.666667,-3.000]$。\n\n算法要求：\n\n- 对每个用例，使用非线性最小二乘拟合，从数据 $\\{(T_i, \\log_{10} a_T(T_i))\\}$ 中估计 $C_1$ 和 $C_2$，并施加 $C_1>0$ 和 $C_2>0$ 的约束。\n- 根据定义 $m = \\left.\\dfrac{d \\log_{10} \\tau(T)}{d \\left(T_g/T\\right)}\\right|_{T=T_g}$ 推导 $m$。根据 TTS 原理，在 $T_g$ 附近，可以认为 $\\tau(T) \\propto a_T(T)$，两者相差一个与温度无关的乘法常数。使用基于 WLF 的拟合在 $T=T_g$ 处计算此导数。\n\n输出要求：\n\n- 将 $m$ 表示为无量纲浮点数，四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，顺序为 $[m_{\\mathrm{A}}, m_{\\mathrm{B}}, m_{\\mathrm{C}}]$。\n\n程序无需用户输入；必须是完全自包含的，并必须完全按照上述测试套件编写。", "solution": "所述问题已根据公认的科学和数学原理进行了验证，并被证实是有效的。该问题在科学上植根于成熟的非晶态材料物理学，是良态的、无歧义的，并为获得唯一解提供了所有必要信息。因此，我们可以进行形式化的求解。\n\n目标是根据给定的粘弹性响应数据，计算聚合物玻璃形成体的动态脆性指数 $m$。该解决方案基于两个关键概念：Williams–Landel–Ferry (WLF) 方程和脆性的定义。\n\nWLF 方程描述了粘弹性位移因子 $a_T$ 相对于参考温度 $T_{\\mathrm{ref}}$ 的温度依赖性：\n$$ \\log_{10} a_T(T) = -\\frac{C_1 (T - T_{\\mathrm{ref}})}{C_2 + (T - T_{\\mathrm{ref}})} $$\n此处，$C_1$ 和 $C_2$ 是正的材料常数。\n\n动态脆性指数 $m$ 定义为弛豫动力学在玻璃化转变温度 $T_g$ 处的陡峭程度：\n$$ m = \\left. \\frac{d (\\log_{10} \\tau)}{d (T_g/T)} \\right|_{T=T_g} $$\n其中 $\\tau(T)$ 是特征结构弛豫时间。问题假定时间-温度叠加 (TTS) 原理适用，该原理通过 $\\tau(T) = \\tau(T_{\\mathrm{ref}}) a_T(T)$ 将 $\\tau(T)$ 与位移因子 $a_T$ 联系起来。因此，$\\log_{10} \\tau(T) = \\log_{10} \\tau(T_{\\mathrm{ref}}) + \\log_{10} a_T(T)$。由于 $\\tau(T_{\\mathrm{ref}})$ 是一个常数，$\\log_{10} \\tau(T)$ 对任何变量的导数都与 $\\log_{10} a_T(T)$ 的导数相同。因此，$m$ 的定义可以改写为用 $a_T$ 表示的形式：\n$$ m = \\left. \\frac{d (\\log_{10} a_T)}{d (T_g/T)} \\right|_{T=T_g} $$\n为了推导 $m$ 的解析表达式，我们应用链式法则。令 $f(T) = \\log_{10} a_T(T)$ 且 $x(T) = T_g/T$。我们需要在 $T=T_g$ 处计算 $df/dx$ 的值。\n$$ \\frac{df}{dx} = \\frac{df/dT}{dx/dT} $$\n首先，我们使用 WLF 方程和微分的商法则计算 $f(T)$ 对温度 $T$ 的导数：\n$$ \\frac{df}{dT} = \\frac{d}{dT} \\left( -\\frac{C_1 (T - T_{\\mathrm{ref}})}{C_2 + (T - T_{\\mathrm{ref}})} \\right) = -C_1 \\left[ \\frac{(1)(C_2 + T - T_{\\mathrm{ref}}) - (T - T_{\\mathrm{ref}})(1)}{(C_2 + T - T_{\\mathrm{ref}})^2} \\right] $$\n$$ \\frac{df}{dT} = -\\frac{C_1 C_2}{(C_2 + T - T_{\\mathrm{ref}})^2} $$\n其次，我们计算 $x(T)$ 对温度 $T$ 的导数：\n$$ \\frac{dx}{dT} = \\frac{d}{dT} \\left( \\frac{T_g}{T} \\right) = -\\frac{T_g}{T^2} $$\n结合这些结果，我们得到斜率的表达式：\n$$ \\frac{df}{dx} = \\frac{-C_1 C_2 / (C_2 + T - T_{\\mathrm{ref}})^2}{-T_g / T^2} = \\frac{C_1 C_2 T^2}{T_g (C_2 + T - T_{\\mathrm{ref}})^2} $$\n为求得脆性 $m$，我们在 $T = T_g$ 处计算该表达式的值：\n$$ m = \\left. \\frac{df}{dx} \\right|_{T=T_g} = \\frac{C_1 C_2 T_g^2}{T_g (C_2 + T_g - T_{\\mathrm{ref}})^2} $$\n这可以简化为基于 WLF 参数的脆性指数最终解析公式：\n$$ m = \\frac{C_1 C_2 T_g}{(C_2 + T_g - T_{\\mathrm{ref}})^2} $$\n当参考温度选为玻璃化转变温度，即 $T_{\\mathrm{ref}} = T_g$ 时，会出现一个特殊情况。该公式简化为：\n$$ m = \\frac{C_1 C_2 T_g}{(C_2)^2} = \\frac{C_1 T_g}{C_2} $$\n\n每个测试用例的计算过程包括两个步骤：\n$1$. 将 WLF 参数 $C_1$ 和 $C_2$ 与提供的实验数据对 $(T_i, \\log_{10} a_T(T_i))$ 进行拟合。这是一个非线性回归问题，通过最小二乘算法求解。必须强制执行 $C_1 > 0$ 和 $C_2 > 0$ 的约束，因为这是物理上要求的。\n$2$. 将拟合得到的参数 $C_1$ 和 $C_2$，以及给定的 $T_g$ 和 $T_{\\mathrm{ref}}$，代入推导出的 $m$ 的解析表达式中，以计算脆性指数。\n\n所提供的程序实现了这一过程。对于每个用例，它将 WLF 模型定义为一个函数，并利用 `scipy.optimize.curve_fit` 例程执行非线性最小二乘拟合。`bounds` 参数用于强制 $C_1$ 和 $C_2$ 的正性。然后，将得到的最优参数用于计算 $m$。最终结果按照要求四舍五入到三位小数并格式化。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Fits WLF parameters to viscoelastic data and computes the fragility index.\n    \"\"\"\n    test_cases = [\n        {\n            \"id\": \"A\",\n            \"T_ref\": 373.0,\n            \"T_g\": 373.0,\n            \"T_data\": np.array([353.0, 363.0, 373.0, 383.0, 393.0]),\n            \"log_aT_data\": np.array([11.058, 4.182, 0.000, -2.821, -4.893])\n        },\n        {\n            \"id\": \"B\",\n            \"T_ref\": 323.0,\n            \"T_g\": 323.0,\n            \"T_data\": np.array([303.0, 313.0, 323.0, 333.0, 343.0]),\n            \"log_aT_data\": np.array([4.970, 2.020, 0.000, -1.439, -2.470])\n        },\n        {\n            \"id\": \"C\",\n            \"T_ref\": 333.0,\n            \"T_g\": 348.0,\n            \"T_data\": np.array([313.0, 323.0, 333.0, 343.0, 353.0]),\n            \"log_aT_data\": np.array([5.000, 2.142857, 0.000, -1.666667, -3.000])\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        T_ref = case[\"T_ref\"]\n        T_g = case[\"T_g\"]\n        T_data = case[\"T_data\"]\n        log_aT_data = case[\"log_aT_data\"]\n        \n        # Define the WLF model function. T_ref is captured from the outer scope.\n        def wlf_model(T, C1, C2):\n            \"\"\"Williams-Landel-Ferry (WLF) equation.\"\"\"\n            return -C1 * (T - T_ref) / (C2 + (T - T_ref))\n\n        # Initial guess for the parameters [C1, C2].\n        # These are typical values for many polymers.\n        initial_guess = [10.0, 50.0]\n        \n        # Define bounds for the parameters, C1 > 0 and C2 > 0.\n        bounds = ([0, 0], [np.inf, np.inf])\n\n        # Perform nonlinear least-squares fitting.\n        try:\n            popt, _ = curve_fit(\n                wlf_model,\n                T_data,\n                log_aT_data,\n                p0=initial_guess,\n                bounds=bounds\n            )\n        except RuntimeError:\n            # If fit fails, append a placeholder and continue.\n            # This is for robustness, though not expected for the given test cases.\n            results.append(float('nan'))\n            continue\n\n        C1_fit, C2_fit = popt\n\n        # Derived formula for fragility index m:\n        # m = (C1 * C2 * T_g) / (C2 + T_g - T_ref)^2\n        numerator = C1_fit * C2_fit * T_g\n        denominator = (C2_fit + T_g - T_ref)**2\n        \n        fragility_m = numerator / denominator\n\n        results.append(fragility_m)\n\n    # Format the results for final output\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2799721"}]}