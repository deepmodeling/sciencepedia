{"hands_on_practices": [{"introduction": "本次练习将从头开始构建我们的理解。我们将使用简单的硬球接触模型，推导面心立方（fcc）和密排六方（hcp）这两种最常见的密排结构的基本几何关系。这种实践不仅能巩固决定晶体结构的几何第一性原理，还能揭示为何这两种结构都能达到理论上的最大堆积密度。[@problem_id:2808480]", "problem": "一个单原子晶体被建模为半径为 $r$ 的相同刚性球体的密堆积，这些球体以密排序列排列。考虑两种典型的密排结构：具有ABC堆积序列的面心立方（fcc）结构和具有AB堆积序列的六方密排（hcp）结构。对于fcc结构，令 $a_{\\mathrm{fcc}}$ 表示常规立方晶格参数。对于hcp结构，令 $a_{\\mathrm{hcp}}$ 表示基面晶格参数， $c$ 表示常规六方晶胞的平面外晶格参数。从接触球体构成的密排三角层的几何定义以及 $a_{\\mathrm{fcc}}$、$a_{\\mathrm{hcp}}$ 和 $c$ 的常规定义出发，在不使用任何预先记忆的、特定于结构的公式的情况下，完成以下任务：\n\n- 推导fcc结构中 $r$ 和 $a_{\\mathrm{fcc}}$ 之间的关系，以及hcp结构中 $r$ 和 $a_{\\mathrm{hcp}}$ 之间的关系。\n- 利用硬球堆积的几何结构，确定hcp结构的理想 $c/a_{\\mathrm{hcp}}$ 比值。\n- 仅使用几何事实和上述关系，计算每种常规晶胞的堆积分数 $\\eta$ （球体占据晶胞体积的比例），并证明这两个值相等。给出共同的解析值。\n\n将您的最终结果以单行矩阵的形式报告，按顺序包含三个精确表达式 $(r/a_{\\mathrm{fcc}},\\, r/a_{\\mathrm{hcp}},\\, \\eta)$。不要四舍五入。由于所有量都是无量纲的比值或纯数，因此不需要单位。", "solution": "该问题陈述是固态物理学和晶体学中一个标准的、定义明确的练习。它有科学依据，内容自洽，且没有矛盾或含糊之处。它要求基于几何第一性原理进行基本推导，这是一项有效且富有启发性的任务。我们可以开始解题。\n\n该问题要求推导面心立方（fcc）和六方密排（hcp）结构的几何关系和堆积分数，其中原子被建模为半径为 $r$ 的相同刚性球体。\n\n首先，我们分析fcc结构。其常规晶胞是一个晶格参数为 $a_{\\mathrm{fcc}}$ 的立方体。原子位于8个角和6个面的中心。在密排结构中，球体是相互接触的。在fcc晶胞内部，球体沿着面心对角线接触。面心对角线连接一个面的两个相对顶点，并穿过面心的原子。这条对角线的长度容纳了角上原子的半径、面心原子的直径以及另一个角上原子的半径。因此，面心对角线的长度为 $r + 2r + r = 4r$。\n从边长为 $a_{\\mathrm{fcc}}$ 的立方体的几何形状来看，面心对角线的长度由勾股定理给出：$\\sqrt{a_{\\mathrm{fcc}}^2 + a_{\\mathrm{fcc}}^2} = a_{\\mathrm{fcc}}\\sqrt{2}$。\n将这两个关于面心对角线长度的表达式相等，可得：\n$$a_{\\mathrm{fcc}}\\sqrt{2} = 4r$$\n这建立了球体半径 $r$ 和晶格参数 $a_{\\mathrm{fcc}}$ 之间的关系。由此，我们推导出所要求的比值 $r/a_{\\mathrm{fcc}}$：\n$$\\frac{r}{a_{\\mathrm{fcc}}} = \\frac{\\sqrt{2}}{4} = \\frac{1}{2\\sqrt{2}}$$\n\n接下来，我们分析hcp结构。hcp结构是由密排平面以ABAB...序列堆积而成的。其常规晶胞是一个以六边形为底的正棱柱。晶格参数为基面边长 $a_{\\mathrm{hcp}}$ 和棱柱高度 $c$ 。\n在基面（例如A层）中，原子排列成一个密排的三角晶格。相邻接触球体的中心相距 $2r$。这个距离对应于晶格参数 $a_{\\mathrm{hcp}}$。\n$$a_{\\mathrm{hcp}} = 2r$$\n由此，比值 $r/a_{\\mathrm{hcp}}$ 立即可得：\n$$\\frac{r}{a_{\\mathrm{hcp}}} = \\frac{1}{2}$$\n\n现在，我们确定理想的 $c/a_{\\mathrm{hcp}}$ 比值。该比值由密排平面之间的间距决定。B层中的一个球体位于A层中三个接触球体形成的空隙中。设A层中三个球体的中心位置为 $A_1$、$A_2$ 和 $A_3$，B层中球体的中心位置为 $B$。由于所有球体都相互接触，这四个点形成一个正四面体。这个四面体的棱长是任意两个接触球体的中心距，即 $2r = a_{\\mathrm{hcp}}$。\n这个四面体的高度是B层到A层的垂直距离，这恰好是常规晶胞高度的一半，即 $c/2$。\n我们可以计算边长为 $s = a_{\\mathrm{hcp}}$ 的正四面体的高度。四面体的顶点（B点）投影到由 $A_1$, $A_2$, $A_3$ 构成的等边三角形底面的中心（形心）。边长为 $s$ 的等边三角形的任意顶点到其形心的距离为 $d = \\frac{s}{\\sqrt{3}}$。\n使用勾股定理，四面体的高度 $h_t$ 满足 $s^2 = h_t^2 + d^2$。\n$$h_t^2 = s^2 - \\left(\\frac{s}{\\sqrt{3}}\\right)^2 = s^2 - \\frac{s^2}{3} = \\frac{2s^2}{3}$$\n$$h_t = s\\sqrt{\\frac{2}{3}}$$\n代入 $h_t = c/2$ 和 $s = a_{\\mathrm{hcp}}$：\n$$\\frac{c}{2} = a_{\\mathrm{hcp}}\\sqrt{\\frac{2}{3}}$$\n这给出了理想的 $c/a_{\\mathrm{hcp}}$ 比值：\n$$\\frac{c}{a_{\\mathrm{hcp}}} = 2\\sqrt{\\frac{2}{3}} = \\sqrt{\\frac{8}{3}}$$\n\n最后，我们计算两种结构的堆积分数 $\\eta$。堆积分数定义为晶胞内所有球体的总体积除以晶胞本身的体积，即 $\\eta = N V_{\\text{sphere}} / V_{\\text{cell}}$。单个球体的体积为 $V_{\\text{sphere}} = \\frac{4}{3}\\pi r^3$。\n\n对于fcc结构：\n每个fcc常规晶胞中的原子数 $N_{\\mathrm{fcc}}$ 为 $8$ 个角上的原子 $\\times$ (每个占 $1/8$) + $6$ 个面心原子 $\\times$ (每个占 $1/2$) = $1 + 3 = 4$。\n晶胞体积为 $V_{\\mathrm{fcc}} = a_{\\mathrm{fcc}}^3$。使用我们推导出的关系 $a_{\\mathrm{fcc}} = 2\\sqrt{2}r$：\n$$V_{\\mathrm{fcc}} = (2\\sqrt{2}r)^3 = 8 \\cdot 2\\sqrt{2} r^3 = 16\\sqrt{2}r^3$$\n堆积分数 $\\eta_{\\mathrm{fcc}}$ 为：\n$$\\eta_{\\mathrm{fcc}} = \\frac{N_{\\mathrm{fcc}} V_{\\text{sphere}}}{V_{\\mathrm{fcc}}} = \\frac{4 \\cdot \\frac{4}{3}\\pi r^3}{16\\sqrt{2}r^3} = \\frac{\\frac{16}{3}\\pi r^3}{16\\sqrt{2}r^3} = \\frac{\\pi}{3\\sqrt{2}}$$\n\n对于hcp结构：\n每个常规六方晶胞中的原子数 $N_{\\mathrm{hcp}}$ 为 $12$ 个角上的原子 $\\times$ (每个占 $1/6$) + $2$ 个面心原子 $\\times$ (每个占 $1/2$) + $3$ 个内部原子 = $2 + 1 + 3 = 6$。\n六方晶胞的体积 $V_{\\mathrm{hcp}}$ 是其六边形底面的面积乘以其高度 $c$。其底面由 $6$ 个边长为 $a_{\\mathrm{hcp}}$ 的等边三角形组成。一个这样的三角形的面积是 $\\frac{\\sqrt{3}}{4} a_{\\mathrm{hcp}}^2$。\n底面面积为 $A_{\\text{base}} = 6 \\cdot \\frac{\\sqrt{3}}{4} a_{\\mathrm{hcp}}^2 = \\frac{3\\sqrt{3}}{2} a_{\\mathrm{hcp}}^2$。\n晶胞体积为 $V_{\\mathrm{hcp}} = A_{\\text{base}} \\cdot c = \\frac{3\\sqrt{3}}{2} a_{\\mathrm{hcp}}^2 \\cdot c$。\n使用 $c = a_{\\mathrm{hcp}}\\sqrt{8/3}$：\n$$V_{\\mathrm{hcp}} = \\frac{3\\sqrt{3}}{2} a_{\\mathrm{hcp}}^2 \\left( a_{\\mathrm{hcp}}\\sqrt{\\frac{8}{3}} \\right) = \\frac{3\\sqrt{3}}{2} a_{\\mathrm{hcp}}^3 \\frac{2\\sqrt{2}}{\\sqrt{3}} = 3\\sqrt{2} a_{\\mathrm{hcp}}^3$$\n现在代入 $a_{\\mathrm{hcp}} = 2r$：\n$$V_{\\mathrm{hcp}} = 3\\sqrt{2} (2r)^3 = 3\\sqrt{2} \\cdot 8r^3 = 24\\sqrt{2}r^3$$\n堆积分数 $\\eta_{\\mathrm{hcp}}$ 为：\n$$\\eta_{\\mathrm{hcp}} = \\frac{N_{\\mathrm{hcp}} V_{\\text{sphere}}}{V_{\\mathrm{hcp}}} = \\frac{6 \\cdot \\frac{4}{3}\\pi r^3}{24\\sqrt{2}r^3} = \\frac{8\\pi r^3}{24\\sqrt{2}r^3} = \\frac{\\pi}{3\\sqrt{2}}$$\n如上所示，两种结构的堆积分数是相同的：$\\eta_{\\mathrm{fcc}} = \\eta_{\\mathrm{hcp}} = \\frac{\\pi}{3\\sqrt{2}}$。这个结果是意料之中的，因为fcc和hcp都是由相同的密排平面通过不同的堆积序列构成的，因此对于相同的球体，它们具有相同的最大可能堆积密度。\n\n最终结果是 $r/a_{\\mathrm{fcc}}$、$r/a_{\\mathrm{hcp}}$ 和公共堆积分数 $\\eta$ 的有序表达式集合。\n$r/a_{\\mathrm{fcc}} = \\frac{\\sqrt{2}}{4}$\n$r/a_{\\mathrm{hcp}} = \\frac{1}{2}$\n$\\eta = \\frac{\\pi}{3\\sqrt{2}}$\n这些是所要求的精确解析值。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\sqrt{2}}{4} & \\frac{1}{2} & \\frac{\\pi}{3\\sqrt{2}} \\end{pmatrix}}$$", "id": "2808480"}, {"introduction": "在简单的 $AB$ 和 $ABC$ 序列之外，还存在着一个由复杂的长周期堆叠序列构成的广阔世界，称为多型体（polytypes）。这个问题挑战你分析一个给定的周期性序列，确定其基本周期性，并推断其底层的布拉维格子对称性。掌握这项技能使你能够分类和理解在碳化硅（$SiC$）和某些层状矿物等材料中发现的复杂结构。[@problem_id:2808431]", "problem": "一个密排晶体是通过沿单一轴线堆叠相同的二维六方层而构建的。相对于其下方层，一个层的允许横向套排有三个不同的位置 $A$、$B$和 $C$，规则是任意两个相邻层不得占据相同的套排位置。考虑一个由实验推断出的无限堆垛，其片段描述为\n$$\nA\\,B\\,A\\,B\\,C\\,B\\,C\\,A\\,C\\,\\ldots\n$$\n该序列无缺陷地周期性延续。仅从密排堆垛和三维平移对称性的定义出发，确定最小重复周期 $n$（即使层套排序列在 $n$ 层之后精确重复的最小正整数 $n$），并由此推导出 Ramsdell 记法，该记法由整数 $n$ 和一个表示布拉菲晶格类型（六方($H$)、立方($C$)或菱方($R$)）的字母组成。不要使用任何列表化的多型体目录或预先记忆的分类规则；而是要从第一性原理出发，推导堆垛操作如何复合以及平移对称性如何约束布拉菲晶格。\n\n作为最终数值答案，请仅报告最小重复周期的整数 $n$。请提供精确整数（不进行四舍五入）。", "solution": "该问题要求分析一个给定的无限、周期性的密排六方层堆垛序列，以确定其最小重复周期 $n$ 及其布拉菲晶格类型，从而得出 Ramsdell 记法。此分析必须基于第一性原理。\n\n给定的堆垛序列片段是 $A\\,B\\,A\\,B\\,C\\,B\\,C\\,A\\,C\\ldots$。这些层沿某一轴（例如 $z$ 轴）堆叠，标签 $A, B, C$ 表示层三种可能的横向套排。规则是相邻层不能有相同的套排，例如，没有 $AA$ 或 $BB$ 堆叠。\n\n**第1步：确定最小周期 $n$**\n\n问题指出该序列周期性延续。这意味着给定的片段是一个重复单元或包含一个或多个重复单元。设该序列表示为 $S = (S_1, S_2, S_3, \\ldots)$。最小周期 $n$ 是满足对所有 $k \\ge 1$ 都有 $S_{k+n} = S_k$ 的最小正整数。\n\n给定的片段是 $U = A\\,B\\,A\\,B\\,C\\,B\\,C\\,A\\,C$。其长度为 $9$。我们假设这就是重复单元，那么完整序列就是 $U, U, U, \\ldots$。这意味着周期为 $n=9$。我们必须验证这是*最小*周期。一个小于 $9$ 的周期 $p$ 将意味着长度为 $p$ 的前缀重复形成该序列。我们来检查所有可能的周期 $p \\in \\{1, 2, \\ldots, 8\\}$。\n\n如果对所有 $k$ 都有 $S_k = S_{k+p}$，则序列的周期为 $p$。我们根据给定的片段 $U = S_1 S_2 \\ldots S_9$ 检查此条件。\n- $p=1$：$S_1=A, S_2=B$。$S_1 \\neq S_2$。周期不是 $1$。\n- $p=2$：$S_1=A, S_3=A$。这符合。但是，$S_3=A, S_5=C$。$S_3 \\neq S_5$。周期不是 $2$。\n- $p=3$：$S_1=A, S_4=B$。$S_1 \\neq S_4$。周期不是 $3$。\n- $p=4$：$S_1=A, S_5=C$。$S_1 \\neq S_5$。周期不是 $4$。\n- $p=5$：$S_1=A, S_6=B$。$S_1 \\neq S_6$。周期不是 $5$。\n- $p=6$：$S_1=A, S_7=C$。$S_1 \\neq S_7$。周期不是 $6$。\n- $p=7$：$S_2=B, S_9=C$。$S_2 \\neq S_9$。周期不是 $7$。\n- $p=8$：$S_1=A, S_9=C$。$S_1 \\neq S_9$。周期不是 $8$。\n\n由于没有小于 $9$ 的整数 $p$ 是由该片段定义的序列的周期，因此最小周期必定是 $n=9$。\n\n**第2步：确定布拉菲晶格类型**\n\n密排结构的布拉菲晶格是六方($H$)或菱方($R$)。立方($C$)情况是菱方晶格的一个具有更高对称性的特例。$H$ 和 $R$ 之间的区别在于三维平移对称性。\n\n设二维六方层位于 $xy$ 平面内。这个二维六方网格的晶格矢量是 $\\vec{a}_1$ 和 $\\vec{a}_2$。横向套排 $A, B, C$ 可以用二维晶胞内的分数坐标矢量表示。一种标准选择是：\n$$\n\\vec{\\tau}_A = (0,0) \\quad ; \\quad \\vec{\\tau}_B = \\left(\\frac{1}{3}, \\frac{2}{3}\\right) \\quad ; \\quad \\vec{\\tau}_C = \\left(\\frac{2}{3}, \\frac{1}{3}\\right)\n$$\n这些矢量表示相对于一个公共原点的位移。注意 $\\vec{\\tau}_A+\\vec{\\tau}_B+\\vec{\\tau}_C = (1,1)$，这是一个二维晶格矢量，因此 $\\vec{\\tau}_C \\equiv -(\\vec{\\tau}_A+\\vec{\\tau}_B)$ 模晶格。我们可以将这些类型建模为循环群 $\\mathbb{Z}_3$ 的元素：$A \\equiv 0$，$B \\equiv 1$，$C \\equiv 2$。这样，$\\vec{\\tau}_B + \\vec{\\tau}_B = 2\\vec{\\tau}_B = (2/3, 4/3) \\equiv (2/3, 1/3) = \\vec{\\tau}_C$。类似地，$\\vec{\\tau}_B + \\vec{\\tau}_C = (1,1) \\equiv (0,0) = \\vec{\\tau}_A$。因此，层类型的相加对应于其套排矢量在模二维晶格下的矢量相加。\n\n一个结构具有菱方布拉菲晶格的充要条件是，在其六方晶胞描述中存在心式平移。一个必要条件是堆垛周期 $n$ 必须是 $3$ 的倍数。在我们的例子中，$n=9$，所以这个条件满足。\n\n菱方定心意味着存在一个形式为 $\\vec{v} = \\vec{t} + \\frac{c}{3}\\hat{z}$ 的平移对称矢量，其中 $c$ 是六方晶胞的高度（$c=nc_0$，$c_0$ 是层间距），$\\vec{t}$ 是 $xy$ 平面内的定心矢量。对于反向（\"R\"）设置，$\\vec{t}$ 可以是 $\\vec{\\tau}_B$；对于正向设置，可以是 $\\vec{\\tau}_C$。我们来检验是否存在这种对称性。\n\n我们检验通过 $\\vec{v} = \\vec{\\tau}_B + \\frac{nc_0}{3}\\hat{z}$ 的平移是否将晶体映射到自身。设一个原子位于类型为 $S_k$ 的第 $k$ 层。其位置为 $\\vec{p} = \\vec{R}_{2D} + \\vec{\\tau}_{S_k} + (k-1)c_0\\hat{z}$，其中 $\\vec{R}_{2D}$ 是一个二维晶格矢量。\n将平移 $\\vec{v}$ 应用于 $\\vec{p}$：\n$$\n\\vec{p}' = \\vec{p} + \\vec{v} = \\vec{R}_{2D} + \\vec{\\tau}_{S_k} + (k-1)c_0\\hat{z} + \\vec{\\tau}_B + \\frac{n}{3}c_0\\hat{z}\n$$\n$$\n\\vec{p}' = \\vec{R}_{2D} + (\\vec{\\tau}_{S_k} + \\vec{\\tau}_B) + \\left(k-1+\\frac{n}{3}\\right)c_0\\hat{z}\n$$\n新位置 $\\vec{p}'$ 位于第 $k' = k + n/3$ 层。要使 $\\vec{v}$ 成为一个晶格矢量，整个晶体结构必须在该平移下保持不变。\n这要求点 $\\vec{p}'$ 对应晶体中的一个原子位置。这意味着第 $k'$ 层的层类型必须与横向位移一致。也就是说，位置 $\\vec{R}_{2D} + (\\vec{\\tau}_{S_k} + \\vec{\\tau}_B)$ 必须是 $S_{k+n/3}$ 类型原子的一个位置。如果以下条件成立，这将为真：\n$$\n\\vec{\\tau}_{S_k} + \\vec{\\tau}_B \\equiv \\vec{\\tau}_{S_{k+n/3}} \\pmod{\\text{2D lattice}}\n$$\n这必须对周期内的所有层 $k$ 都成立。使用 $\\mathbb{Z}_3$ 表示法，即为 $S_k + 1 \\equiv S_{k+n/3} \\pmod 3$。\n\n我们对我们的序列进行检验。$n=9$，所以 $n/3=3$。层类型为 $S = (A,B,A,B,C,B,C,A,C)$ 或在 $\\mathbb{Z}_3$ 中为 $S = (0,1,0,1,2,1,2,0,2)$。我们检查对于 $k=1, \\ldots, 9$ 是否有 $S_{k+3} \\equiv S_k+1 \\pmod 3$。\n- $k=1$: $S_4 = 1$。$S_1+1 = 0+1=1$。（正确）\n- $k=2$: $S_5 = 2$。$S_2+1 = 1+1=2$。（正确）\n- $k=3$: $S_6 = 1$。$S_3+1 = 0+1=1$。（正确）\n- $k=4$: $S_7 = 2$。$S_4+1 = 1+1=2$。（正确）\n- $k=5$: $S_8 = 0$。$S_5+1 = 2+1=3 \\equiv 0$。（正确）\n- $k=6$: $S_9 = 2$。$S_6+1 = 1+1=2$。（正确）\n- $k=7$: $S_{10}=S_1=0$。$S_7+1 = 2+1=3 \\equiv 0$。（正确）\n- $k=8$: $S_{11}=S_2=1$。$S_8+1 = 0+1=1$。（正确）\n- $k=9$: $S_{12}=S_3=0$。$S_9+1 = 2+1=3 \\equiv 0$。（正确）\n\n此条件对所有 $k$ 都成立。这证实了菱方心式平移的存在。因此，布拉菲晶格是菱方($R$)。\nRamsdell 记法是整数 $n$ 后面跟着晶格类型的字母。对于此结构，记法为 $9R$。\n\n问题要求的是最小重复周期 $n$。根据我们的分析，这是 $n=9$。", "answer": "$$\n\\boxed{9}\n$$", "id": "2808431"}, {"introduction": "堆垛层错的几何描述必须与其由能量决定的物理现实联系起来。这个计算练习模拟了一项真实的研究任务：从第一性原理（DFT）数据中计算固有堆垛层错能（$\\gamma_{\\text{ISF}}$）。通过分析能量如何随板坯厚度变化并应用适当的有限尺寸校正，你将学习到计算材料科学中量化产生平面缺陷所需能量成本的标准流程。[@problem_id:2808552]", "problem": "您会获得三个用于沿 $\\{111\\}$ 平面构建的面心立方 (fcc) 密排平板的密度泛函理论 (DFT) 赝势数据集。每个平板在真空中都嵌入了一个内禀层错。您的任务是，通过使用与各向同性线弹性理论一致的基本定义和有限尺寸修正，将每单位面积的过剩能量外推至无限平板厚度，从而计算每种材料的内禀层错能 $\\gamma_{\\text{ISF}}$。\n\n定义和物理基础：\n- 在密排 fcc 晶格中，沿 $\\langle 111 \\rangle$ 方向的理想堆垛序列为 $ABCABC\\ldots$。一个内禀层错是该序列中的一个局部错乱，可以看作是移走了一个密排面，例如，$ABCACABC\\ldots$。\n- 内禀层错能 $\\gamma_{\\text{ISF}}$ 定义为包含单个内禀层错的晶体相对于完美晶体的每单位面积的过剩能量，\n  $$\n  \\gamma_{\\text{ISF}} \\equiv \\lim_{L \\to \\infty} \\frac{E_{\\text{fault}}(L) - E_{\\text{perfect}}(L)}{m A},\n  $$\n  其中 $E_{\\text{fault}}(L)$ 和 $E_{\\text{perfect}}(L)$ 分别是厚度为 $L$（沿堆垛方向测量）的平板的总能量，$A$ 是 $\\{111\\}$ 平面二维原胞的面内面积，$m$ 是周期性超胞中包含的层错数量。在所提供的数据集中，所有情况下 $m=1$。由于两种结构具有相同的自由表面，能量差 $E_{\\text{fault}}(L) - E_{\\text{perfect}}(L)$ 在主导阶上消除了表面能和表面应力的影响。\n- 对于具有无牵引力平行表面的单层错平板，过剩能量密度的残余有限尺寸修正源于自由表面反射的长程弹性场。关于平板中面的镜像对称性意味着远场展开中只会出现 $L$ 的奇次负幂项。因此，过剩能量密度存在一个渐近展开式，\n  $$\n  \\frac{E_{\\text{fault}}(L) - E_{\\text{perfect}}(L)}{m A} = \\gamma_{\\infty} + \\frac{c_1}{L} + \\frac{c_3}{L^3} + \\mathcal{O}\\!\\left(\\frac{1}{L^5}\\right),\n  $$\n  其中 $\\gamma_{\\infty} \\equiv \\gamma_{\\text{ISF}}$ 是您必须确定的无限厚度极限值，而 $c_1$、$c_3$ 是依赖于材料的系数，用以表征弹性镜像相互作用。\n\n几何基础：\n- 对于立方晶格参数为 $a$ 的 fcc 晶格，$\\{111\\}$ 平面的晶面间距为 $d_{111} = a/\\sqrt{3}$，$\\{111\\}$ 平面二维原胞的面内面积为 $A = (\\sqrt{3}/2)\\,a^2$。\n- 对于由 $n$ 个密排面组成的平板，其厚度为 $L = n\\,d_{111}$。\n\n计算任务：\n- 对于下面的每个数据集，使用基本定义计算原始过剩能量密度，\n  $$\n  \\gamma(L_i) = \\frac{E_{\\text{fault}}(L_i) - E_{\\text{perfect}}(L_i)}{m A},\n  $$\n  对于给定的与所列层数 $n_i$ 相关联的厚度序列 $L_i$。\n- 然后，使用上述基于各向同性线弹性理论和对称性的渐近展开式，通过对所提供的 $L$ 值，将 $\\gamma(L)$ 对基 $\\{1, 1/L, 1/L^3\\}$ 进行最小二乘拟合，来确定 $\\gamma_{\\infty}$。\n- 以毫焦耳/平方米 (mJ/m$^2$) 为单位报告 $\\gamma_{\\infty}$，结果四舍五入到三位小数。使用精确转换因子 $1~\\text{J/m}^2 = 0.06241509~\\text{eV/\\AA}^2$。本问题不使用角度。\n- 所有能量单位为电子伏特 (eV)，长度单位为埃 ($\\text{\\AA}$)，面积单位为平方埃 ($\\text{\\AA}^2$)。最终答案以 mJ/m$^2$ 为单位表示，并四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[x_1,x_2,x_3]$），其中每个 $x_k$ 是数据集 $k$ 的 $\\gamma_{\\infty}$ 的四舍五入值。\n\n测试套件（所有数据集的 $m=1$）：\n\n数据集 1:\n- 立方晶格参数: $a = 4.05~\\text{\\AA}$。\n- 密排层数: $n = [8, 10, 14, 18, 24]$。\n- 完美平板总能量 (eV): $E_{\\text{perfect}} = [-25.3908, -32.5908, -46.9908, -61.3908, -82.9908]$。\n- 含错平板总能量 (eV): $E_{\\text{fault}} = [-25.2098, -32.4215, -46.8309, -61.2382, -82.8424]$。\n\n数据集 2:\n- 立方晶格参数: $a = 3.60~\\text{\\AA}$。\n- 密排层数: $n = [12, 16, 20, 28, 36]$。\n- 完美平板总能量 (eV): $E_{\\text{perfect}} = [-42.2329, -57.4329, -72.6329, -103.0329, -133.4329]$。\n- 含错平板总能量 (eV): $E_{\\text{fault}} = [-42.2012, -57.4051, -72.6079, -103.0114, -133.4129]$。\n\n数据集 3:\n- 立方晶格参数: $a = 3.30~\\text{\\AA}$。\n- 密排层数: $n = [10, 12, 15, 22, 30]$。\n- 完美平板总能量 (eV): $E_{\\text{perfect}} = [-36.6048, -44.6048, -56.6048, -84.6048, -116.6048]$。\n- 含错平板总能量 (eV): $E_{\\text{fault}} = [-36.5937, -44.5957, -56.5972, -84.5994, -116.6007]$。\n\n确保普遍适用性的要求：\n- 不要假设任何外部文件输入；上述数据已嵌入到您的代码中。\n- 仅使用代数、fcc 晶格的几何学和最小二乘回归来实现外推。\n- 最终输出必须是单行，包含一个 Python 列表，其中有三个浮点数，分别代表三个数据集的 $\\gamma_{\\infty}$ 值（单位为 mJ/m$^2$），每个值都四舍五入到三位小数，输出行中不包含任何单位。", "solution": "所述问题已经过验证。所有给定条件，包括物理定义、控制方程、几何关系、特定于材料的数据集和计算要求，都已被提取和分析。该问题在科学上基于固态物理学和计算材料科学的原理，特别是关于平面缺陷能的计算。所描述的方法，涉及使用基于弹性理论推导的渐近展开式将有限尺寸平板的计算结果外推至体极限，是一个标准且定义良好的程序。该问题是客观、自洽的，并且没有矛盾或歧义。因此，该问题被认为是有效的，并将呈现一个严谨的解决方案。\n\n目标是为三种不同的面心立方 (fcc) 材料计算内禀层错能 $\\gamma_{\\text{ISF}}$。该物理量表示在无限大晶体中创建单位面积层错所需的能量成本。我们获得了来自密度泛函理论 (DFT) 计算的、针对含层错和不含层错的有限厚度平板的总能量数据。解决方案要求将这些有限尺寸的结果外推至无限厚度极限。\n\n每个数据集的处理过程如下：\n\n1.  **几何参数计算**：对于给定的立方晶格参数为 $a$ 的 fcc 晶体，$\\{111\\}$ 平面的几何结构决定了平板的尺寸。沿 $\\langle 111 \\rangle$ 方向的晶面间距为 $d_{111} = a/\\sqrt{3}$。$\\{111\\}$ 平面的二维原胞面积为 $A = (\\sqrt{3}/2)a^2$。对于由 $n$ 个此类平面构成的平板，其厚度为 $L = n \\cdot d_{111}$。需为每种材料计算这些参数。\n\n2.  **有限尺寸层错能计算**：问题为几种不同厚度 $L_i$ 的完美平板提供了总能量 $E_{\\text{perfect}}(L_i)$，以及包含单个内禀层错的平板的总能量 $E_{\\text{fault}}(L_i)$。原始的（或称有限尺寸的）层错能密度 $\\gamma(L_i)$ 定义为每单位面积的过剩能量。对于单个层错（$m=1$）的情况，其表达式为：\n    $$\n    \\gamma(L_i) = \\frac{E_{\\text{fault}}(L_i) - E_{\\text{perfect}}(L_i)}{A}\n    $$\n    对每种材料的每个可用平板厚度都执行此计算。$\\gamma(L_i)$ 的单位是电子伏特/平方埃 ($\\text{eV}/\\text{\\AA}^2$)。\n\n3.  **外推至无限厚度**：层错与平板自由表面之间的相互作用引入了依赖于平板厚度 $L$ 的有限尺寸误差。基于线弹性理论和平板的对称性，这种依赖关系可以表示为 $L$ 的奇次负幂的渐近展开式：\n    $$\n    \\gamma(L) = \\gamma_{\\infty} + \\frac{c_1}{L} + \\frac{c_3}{L^3} + \\mathcal{O}\\!\\left(\\frac{1}{L^5}\\right)\n    $$\n    此处，$\\gamma_{\\infty}$ 是我们期望得到的内禀层错能 $\\gamma_{\\text{ISF}}$，$c_1$ 和 $c_3$ 是与弹性相互作用相关的系数。为确定 $\\gamma_{\\infty}$，我们将此模型拟合到计算出的数据点 $(\\gamma(L_i), L_i)$。这构成了一个线性最小二乘回归问题。我们寻求系数 $\\beta = [\\gamma_{\\infty}, c_1, c_3]^T$ 以最小化以下线性方程组的残差平方和：\n    $$\n    \\begin{pmatrix}\n    1 & 1/L_1 & 1/L_1^3 \\\\\n    1 & 1/L_2 & 1/L_2^3 \\\\\n    \\vdots & \\vdots & \\vdots \\\\\n    1 & 1/L_N & 1/L_N^3\n    \\end{pmatrix}\n    \\begin{pmatrix}\n    \\gamma_{\\infty} \\\\\n    c_1 \\\\\n    c_3\n    \\end{pmatrix}\n    =\n    \\begin{pmatrix}\n    \\gamma(L_1) \\\\\n    \\gamma(L_2) \\\\\n    \\vdots \\\\\n    \\gamma(L_N)\n    \\end{pmatrix}\n    $$\n    该系统表示为 $X\\beta = y$，我们求解参数矢量 $\\beta$。解矢量中的第一个分量 $\\beta_0$ 对应于 $\\gamma_{\\infty}$。\n\n4.  **单位转换和最终报告**：从拟合中获得的 $\\gamma_{\\infty}$ 值的单位是 $\\text{eV}/\\text{\\AA}^2$。它必须被转换为毫焦耳/平方米 ($\\text{mJ}/\\text{m}^2$)。使用提供的转换因子 $1~\\text{J/m}^2 = 0.06241509~\\text{eV/\\AA}^2$，转换公式为：\n    $$\n    \\gamma_{\\infty} [\\text{mJ/m}^2] = \\gamma_{\\infty} [\\text{eV/\\AA}^2] \\times \\frac{1}{0.06241509~\\text{eV/\\AA}^2 \\cdot \\text{m}^{-2} \\cdot \\text{J}^{-1}} \\times 1000~\\text{mJ/J}\n    $$\n    每个数据集的最终数值结果按要求四舍五入到三位小数。对所有三个数据集执行此过程，以获得最终的结果列表。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the intrinsic stacking fault energy (ISF) for three materials\n    by extrapolating finite-size slab DFT data to infinite thickness.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"a\": 4.05,  # Cubic lattice parameter in Angstroms\n            \"n\": np.array([8, 10, 14, 18, 24]),  # Number of layers\n            \"E_perfect\": np.array([-25.3908, -32.5908, -46.9908, -61.3908, -82.9908]),  # eV\n            \"E_fault\": np.array([-25.2098, -32.4215, -46.8309, -61.2382, -82.8424]),  # eV\n        },\n        {\n            \"a\": 3.60,\n            \"n\": np.array([12, 16, 20, 28, 36]),\n            \"E_perfect\": np.array([-42.2329, -57.4329, -72.6329, -103.0329, -133.4329]),\n            \"E_fault\": np.array([-42.2012, -57.4051, -72.6079, -103.0114, -133.4129]),\n        },\n        {\n            \"a\": 3.30,\n            \"n\": np.array([10, 12, 15, 22, 30]),\n            \"E_perfect\": np.array([-36.6048, -44.6048, -56.6048, -84.6048, -116.6048]),\n            \"E_fault\": np.array([-36.5937, -44.5957, -56.5972, -84.5994, -116.6007]),\n        },\n    ]\n\n    # Constants\n    m = 1  # Number of stacking faults in the supercell\n    # Conversion factor: 1 J/m^2 = 0.06241509 eV/A^2\n    # This implies 1 eV/A^2 = (1 / 0.06241509) J/m^2\n    eV_A2_to_mJ_m2 = (1.0 / 0.06241509) * 1000.0\n\n    results = []\n\n    for case in test_cases:\n        a = case[\"a\"]\n        n_layers = case[\"n\"]\n        E_perfect = case[\"E_perfect\"]\n        E_fault = case[\"E_fault\"]\n\n        # Step 1: Calculate geometric parameters\n        # Interplanar spacing for {111} planes\n        d_111 = a / np.sqrt(3)\n        # Area of the 2D primitive cell of the {111} plane\n        Area = (np.sqrt(3) / 2.0) * a**2\n        # Slab thickness for each n\n        L = n_layers * d_111\n\n        # Step 2: Calculate finite-size stacking fault energies (gamma(L))\n        # Energy difference between faulted and perfect slabs\n        delta_E = E_fault - E_perfect\n        # Raw SFE in eV/A^2\n        gamma_L = delta_E / (m * Area)\n\n        # Step 3: Perform least-squares fit for extrapolation\n        # Model: gamma(L) = gamma_inf + c1/L + c3/L^3\n        # We need to solve a linear system X * beta = y where beta = [gamma_inf, c1, c3]\n        \n        # Construct the design matrix X\n        # The columns are the basis functions: 1, 1/L, 1/L^3\n        X = np.vstack([np.ones_like(L), 1.0 / L, 1.0 / L**3]).T\n        \n        # The dependent variable vector y is gamma_L\n        y = gamma_L\n        \n        # Solve the least-squares problem\n        coeffs, _, _, _ = np.linalg.lstsq(X, y, rcond=None)\n        \n        # The extrapolated ISF energy is the first coefficient (the intercept)\n        gamma_inf_eV_A2 = coeffs[0]\n\n        # Step 4: Convert units and round\n        gamma_inf_mJ_m2 = gamma_inf_eV_A2 * eV_A2_to_mJ_m2\n        \n        rounded_result = round(gamma_inf_mJ_m2, 3)\n        results.append(rounded_result)\n\n    # Format the final output as a string representing a list\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2808552"}]}