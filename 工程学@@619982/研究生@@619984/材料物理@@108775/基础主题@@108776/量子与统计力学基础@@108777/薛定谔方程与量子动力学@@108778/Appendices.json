{"hands_on_practices": [{"introduction": "激子作为半导体中基本的准粒子，其行为可以通过一个类氢原子的薛定谔方程来描述。这个练习将引导你求解三维（体材料）和二维（量子阱）中激子的束缚能，旨在揭示量子限制效应如何随维度变化而显著影响能级结构。通过直接比较两种情况下的能级间距，你可以亲身体会到从三维到二维的转变如何重塑量子系统的性质，这是理解和设计现代量子材料（如二维材料和量子阱）的核心技能 [@problem_id:2857747]。", "problem": "半导体中的类氢激子可以用相对坐标的不含时Schrödinger方程来建模，其中电子和空穴通过被均匀背景电介质屏蔽的库仑势相互作用。考虑一个限制在平面内的严格二维激子和一个体材料中的三维激子，两者都处于同一材料中，其电子有效质量为 $m_{e}^{\\star}$，空穴有效质量为 $m_{h}^{\\star}$，背景相对介电常数为 $\\varepsilon_{r}$。设约化质量为 $\\mu = \\frac{m_{e}^{\\star} m_{h}^{\\star}}{m_{e}^{\\star} + m_{h}^{\\star}}$，库仑相互作用为 $V(r) = - \\frac{e^{2}}{4 \\pi \\varepsilon_{0} \\varepsilon_{r} r}$，其中 $r$ 是电子-空穴间距。\n\n从相对坐标的Schrödinger方程出发，在相应的空间维度中分离变量，施加束缚态的归一化条件，并求出二维和三维情况下用 $\\mu$、$\\varepsilon_{r}$、$e$、$\\varepsilon_{0}$ 和 $\\hbar$ 表示的分立束缚能谱。使用这些能谱来定义空间维度为 $d$ 时，第一激发态（$n=2$）与基态（$n=1$）之间的能级间距 $\\Delta E_{1 \\to 2}^{(d)} \\equiv E_{2}^{(d)} - E_{1}^{(d)}$。\n\n精确比值\n$$\n\\mathcal{R} \\equiv \\frac{\\Delta E_{1 \\to 2}^{(2\\text{D})}}{\\Delta E_{1 \\to 2}^{(3\\text{D})}} \\, ?\n$$\n是多少？\n请以一个精确数值作为最终答案。无需单位。不要四舍五入，给出精确值。", "solution": "所述问题具有科学依据、提法明确、客观，并包含得出唯一解所需的所有信息。这是凝聚态物理中的一个标准问题。我们将开始推导。\n\n为激子建模的出发点是电子-空穴对相对运动的不含时Schrödinger方程。相对坐标 $\\mathbf{r}$ 的哈密顿量由下式给出：\n$$\n\\hat{H} = -\\frac{\\hbar^2}{2\\mu} \\nabla^2 + V(r)\n$$\n其中 $\\mu = \\frac{m_{e}^{\\star} m_{h}^{\\star}}{m_{e}^{\\star} + m_{h}^{\\star}}$ 是约化质量，$\\hbar$ 是约化普朗克常数，势能是屏蔽库仑相互作用 $V(r) = - \\frac{e^{2}}{4 \\pi \\varepsilon_{0} \\varepsilon_{r} r}$。此处，$e$ 是元电荷，$\\varepsilon_{0}$ 是真空介电常数，$\\varepsilon_{r}$ 是材料的相对介电常数。Schrödinger方程为 $\\hat{H}\\psi(\\mathbf{r}) = E\\psi(\\mathbf{r})$。\n\n我们必须对三维（$3$D）和二维（$2$D）系统求解此方程，以找到束缚态（$E < 0$）的分立能谱。\n\n首先，我们分析三维激子。在球坐标中，Schrödinger方程是可分离变量的。此问题在数学上与氢原子问题等同，只需将电子质量 $m_e$ 替换为约化质量 $\\mu$，并将真空介电常数 $\\varepsilon_0$ 替换为有效介电常数 $\\varepsilon_0 \\varepsilon_r$。众所周知的氢原子量子化能级为 $E_n^{\\text{H}} = - \\frac{m_e e^4}{2(4\\pi\\varepsilon_0)^2\\hbar^2 n^2}$。应用上述替换，可得到 $3$D激子的能谱：\n$$\nE_{n}^{(3\\text{D})} = - \\frac{\\mu e^4}{2(4\\pi\\varepsilon_0\\varepsilon_r)^2\\hbar^2} \\frac{1}{n^2}\n$$\n其中主量子数 $n$ 可取整数值 $n=1, 2, 3, \\dots$。\n让我们定义特征能量标度，即激子Rydberg，为：\n$$\nR_X \\equiv \\frac{\\mu e^4}{2(4\\pi\\varepsilon_0\\varepsilon_r)^2\\hbar^2}\n$$\n因此，$3$D情况下的能谱可简明地写为：\n$$\nE_{n}^{(3\\text{D})} = -\\frac{R_X}{n^2}\n$$\n基态（$n=1$）能量为 $E_{1}^{(3\\text{D})} = -R_X$。\n第一激发态（$n=2$）能量为 $E_{2}^{(3\\text{D})} = -\\frac{R_X}{2^2} = -\\frac{R_X}{4}$。\n这两个能级之间的能量间距为：\n$$\n\\Delta E_{1 \\to 2}^{(3\\text{D})} = E_{2}^{(3\\text{D})} - E_{1}^{(3\\text{D})} = \\left(-\\frac{R_X}{4}\\right) - (-R_X) = R_X\\left(1 - \\frac{1}{4}\\right) = \\frac{3}{4}R_X\n$$\n\n接下来，我们分析严格二维激子。Schrödinger方程在 $2$D 平面内求解，在极坐标 $(r, \\phi)$ 中也是可分离变量的。这就是“二维氢原子”问题。在束缚态的归一化条件下求解径向方程，可得到能谱：\n$$\nE_{n}^{(2\\text{D})} = - \\frac{\\mu e^4}{2(4\\pi\\varepsilon_0\\varepsilon_r)^2\\hbar^2} \\frac{1}{(n - 1/2)^2}\n$$\n此处，量子数 $n$ 标记能级，可取整数值 $n=1, 2, 3, \\dots$。使用相同的激子Rydberg定义 $R_X$，我们可以将 $2$D 能谱写为：\n$$\nE_{n}^{(2\\text{D})} = -\\frac{R_X}{(n - 1/2)^2}\n$$\n基态（$n=1$）能量为 $E_{1}^{(2\\text{D})} = -\\frac{R_X}{(1 - 1/2)^2} = -\\frac{R_X}{(1/2)^2} = -4R_X$。\n第一激发态（$n=2$）能量为 $E_{2}^{(2\\text{D})} = -\\frac{R_X}{(2 - 1/2)^2} = -\\frac{R_X}{(3/2)^2} = -\\frac{4}{9}R_X$。\n这两个能级之间的能量间距为：\n$$\n\\Delta E_{1 \\to 2}^{(2\\text{D})} = E_{2}^{(2\\text{D})} - E_{1}^{(2\\text{D})} = \\left(-\\frac{4}{9}R_X\\right) - (-4R_X) = R_X\\left(4 - \\frac{4}{9}\\right) = R_X\\left(\\frac{36-4}{9}\\right) = \\frac{32}{9}R_X\n$$\n\n最后，我们计算所求的比值 $\\mathcal{R}$。\n$$\n\\mathcal{R} \\equiv \\frac{\\Delta E_{1 \\to 2}^{(2\\text{D})}}{\\Delta E_{1 \\to 2}^{(3\\text{D})}} = \\frac{\\frac{32}{9}R_X}{\\frac{3}{4}R_X}\n$$\n激子Rydberg常数 $R_X$ 会被消去，因为它依赖于两种情况下都相同的材料参数。\n$$\n\\mathcal{R} = \\frac{32/9}{3/4} = \\frac{32}{9} \\times \\frac{4}{3} = \\frac{128}{27}\n$$\n这就是所求的精确数值比。", "answer": "$$\n\\boxed{\\frac{128}{27}}\n$$", "id": "2857747"}, {"introduction": "理想化的抛物线能带模型虽然简洁，但在许多真实材料中并不完全准确。为了更精确地描述激子能谱，我们需要考虑能带的非抛物线性效应，这正是本练习的核心 [@problem_id:2857751]。你将运用微扰论这一强大的量子力学工具，计算非抛物线性能带对激子能级的一阶修正，从而学会如何从一个理想模型出发，系统地引入并量化次级效应，这是连接理论模型与实验现实的关键一步。", "problem": "考虑一个$3$维、各向同性的直接带隙半导体，其静态介电常数为 $\\varepsilon$，带边有效质量为抛物线形的 $m_{c}$（导带）和 $m_{v}$（价带）。设电子-空穴的相对运动在有效质量和包络函数近似下，由未微扰的哈密顿量描述：\n$$\nH_{0}=\\frac{\\mathbf{p}^{2}}{2\\mu}-\\frac{\\kappa}{r},\n$$\n其中 $\\mu=\\left(m_{c}^{-1}+m_{v}^{-1}\\right)^{-1}$ 是折合质量，$\\kappa=\\frac{e^{2}}{4\\pi \\varepsilon}$，$\\mathbf{p}$ 是相对动量算符，$r=|\\mathbf{r}|$ 是电子-空穴间距。相应的束缚态谱 $\\{\\,|n\\ell m\\rangle\\,\\}$ 是类氢的，主量子数为 $n\\in\\mathbb{N}$，角量子数为 $\\ell\\in\\{0,1,\\dots,n-1\\}$。\n\n现在，将单粒子色散关系扩展到晶体动量的四次项，以此在领头阶上引入弱的能带非抛物线性效应：\n$$\nE_{c}(\\mathbf{k})\\approx E_{c}(0)+\\frac{\\hbar^{2}k^{2}}{2m_{c}}+\\alpha_{c}\\,k^{4},\\qquad\nE_{v}(\\mathbf{k})\\approx E_{v}(0)-\\frac{\\hbar^{2}k^{2}}{2m_{v}}-\\alpha_{v}\\,k^{4},\n$$\n其中 $\\alpha_{c}$ 和 $\\alpha_{v}$ 是小的正值材料参数（单位为能量乘以长度的四次方）。对于一个总质心（COM）动量为 $\\mathbf{K}=\\mathbf{0}$ 的激子，将动量的四次项贡献视为对相对哈密顿量的一个微扰 $\\delta H$。\n\n对 $H_{0}$ 应用非简并一级不含时微扰理论，推导针对任意类氢原子态 $|n\\ell m\\rangle$ 的激子能量里德堡级数的领头能量修正 $\\Delta E_{n\\ell}$ 的闭式解析表达式。最终答案仅用 $\\alpha_{c}$、$\\alpha_{v}$、$\\mu$、$\\varepsilon$、$e$、$\\hbar$ 以及量子数 $n$ 和 $\\ell$ 表示。无需进行数值计算。提供 $\\Delta E_{n\\ell}$ 的表达式作为最终答案。", "solution": "基本出发点是，在屏蔽库仑势中描述电子-空穴相对坐标的有效质量包络函数薛定谔方程：\n$$\nH_{0}=\\frac{\\mathbf{p}^{2}}{2\\mu}-\\frac{\\kappa}{r},\\qquad \\kappa=\\frac{e^{2}}{4\\pi \\varepsilon},\n$$\n其类氢本征态为 $|n\\ell m\\rangle$，能量为\n$$\nE_{n}=-\\frac{\\mu \\kappa^{2}}{2\\hbar^{2}n^{2}}。\n$$\n能带非抛物线性将单粒子色散关系修正为\n$$\nE_{c}(\\mathbf{k}_{e})\\approx E_{c}(0)+\\frac{\\hbar^{2}k_{e}^{2}}{2m_{c}}+\\alpha_{c}k_{e}^{4},\\qquad\nE_{v}(\\mathbf{k}_{h})\\approx E_{v}(0)-\\frac{\\hbar^{2}k_{h}^{2}}{2m_{v}}-\\alpha_{v}k_{h}^{4}。\n$$\n通过以下方式引入质心（COM）波矢 $\\mathbf{K}$ 和相对波矢 $\\mathbf{q}$：\n$$\n\\mathbf{k}_{e}=\\frac{m_{c}}{M}\\mathbf{K}+\\mathbf{q},\\qquad \n\\mathbf{k}_{h}=\\frac{m_{v}}{M}\\mathbf{K}-\\mathbf{q},\\qquad M=m_{c}+m_{v}。\n$$\n对于 $\\mathbf{K}=\\mathbf{0}$ 的激子，有 $\\mathbf{k}_{e}=\\mathbf{q}$ 和 $\\mathbf{k}_{h}=-\\mathbf{q}$，所以 $k_{e}^{4}=k_{h}^{4}=q^{4}$。因此，在固定的 $\\mathbf{K}=\\mathbf{0}$ 条件下，动量的四次项对双粒子能量的贡献为\n$$\n\\delta H=\\alpha_{c}q^{4}+\\alpha_{v}q^{4}=\\left(\\alpha_{c}+\\alpha_{v}\\right)\\,q^{4}。\n$$\n在相对坐标表象中，$\\mathbf{p}=\\hbar \\mathbf{q}$，因此\n$$\n\\delta H=\\left(\\alpha_{c}+\\alpha_{v}\\right)\\left(\\frac{\\mathbf{p}}{\\hbar}\\right)^{4}=\\frac{\\alpha_{c}+\\alpha_{v}}{\\hbar^{4}}\\,\\mathbf{p}^{4}。\n$$\n将 $\\delta H$ 视为对 $H_{0}$ 的微扰，非简并类氢能级 $|n\\ell m\\rangle$ 的一级能量移动为\n$$\n\\Delta E_{n\\ell}^{(1)}=\\langle n\\ell m|\\delta H|n\\ell m\\rangle=\\frac{\\alpha_{c}+\\alpha_{v}}{\\hbar^{4}}\\;\\langle n\\ell m|\\mathbf{p}^{4}|n\\ell m\\rangle。\n$$\n因此，我们需要计算库仑束缚态中 $\\langle \\mathbf{p}^{4}\\rangle$ 的期望值。使用恒等式\n$$\n\\mathbf{p}^{2}=2\\mu\\left(H_{0}-V\\right),\\qquad V(r)=-\\frac{\\kappa}{r},\n$$\n这意味着\n$$\n\\mathbf{p}^{4}=\\left[2\\mu\\left(H_{0}-V\\right)\\right]^{2}=4\\mu^{2}\\left(H_{0}-V\\right)^{2}。\n$$\n在能量为 $H_{0}|n\\ell m\\rangle=E_{n}|n\\ell m\\rangle$ 的本征态 $|n\\ell m\\rangle$ 中取期望值，得到\n$$\n\\langle \\mathbf{p}^{4}\\rangle=4\\mu^{2}\\left(\\langle H_{0}^{2}\\rangle-2\\langle H_{0}V\\rangle+\\langle V^{2}\\rangle\\right)\n=4\\mu^{2}\\left(E_{n}^{2}-2E_{n}\\langle V\\rangle+\\langle V^{2}\\rangle\\right)。\n$$\n对于库仑问题，量子维里定理给出 $\\langle V\\rangle=2E_{n}$。因此，\n$$\n\\langle \\mathbf{p}^{4}\\rangle=4\\mu^{2}\\left(E_{n}^{2}-4E_{n}^{2}+\\langle V^{2}\\rangle\\right)\n=4\\mu^{2}\\left(-3E_{n}^{2}+\\langle V^{2}\\rangle\\right)。\n$$\n由于 $V(r)=-\\kappa/r$，有 $V^{2}(r)=\\kappa^{2}/r^{2}$，以及\n$$\n\\langle V^{2}\\rangle=\\kappa^{2}\\left\\langle \\frac{1}{r^{2}}\\right\\rangle。\n$$\n对于三维空间中的类氢原子态，一个经过充分检验的期望值结果是\n$$\n\\left\\langle \\frac{1}{r^{2}}\\right\\rangle=\\frac{1}{a^{*2}\\,n^{3}\\left(\\ell+\\frac{1}{2}\\right)},\\qquad a^{*}=\\frac{\\hbar^{2}}{\\mu \\kappa},\n$$\n此结果可通过计算含缔合Laguerre多项式的径向积分，或使用库仑问题的标准算符方法得到。使用 $a^{*}=\\hbar^{2}/(\\mu \\kappa)$，这给出\n$$\n\\langle V^{2}\\rangle=\\kappa^{2}\\cdot \\frac{1}{a^{*2}\\,n^{3}\\left(\\ell+\\frac{1}{2}\\right)}\n=\\kappa^{2}\\cdot \\frac{\\mu^{2}\\kappa^{2}}{\\hbar^{4}}\\cdot \\frac{1}{n^{3}\\left(\\ell+\\frac{1}{2}\\right)}\n=\\frac{\\mu^{2}\\kappa^{4}}{\\hbar^{4}}\\cdot \\frac{1}{n^{3}\\left(\\ell+\\frac{1}{2}\\right)}。\n$$\n并且，\n$$\nE_{n}^{2}=\\left(\\frac{-\\mu \\kappa^{2}}{2\\hbar^{2}n^{2}}\\right)^{2}=\\frac{\\mu^{2}\\kappa^{4}}{4\\hbar^{4}n^{4}}。\n$$\n代入 $\\langle \\mathbf{p}^{4}\\rangle$ 中，\n$$\n\\langle \\mathbf{p}^{4}\\rangle=4\\mu^{2}\\left[-3\\cdot \\frac{\\mu^{2}\\kappa^{4}}{4\\hbar^{4}n^{4}}+\\frac{\\mu^{2}\\kappa^{4}}{\\hbar^{4}}\\cdot \\frac{1}{n^{3}\\left(\\ell+\\frac{1}{2}\\right)}\\right]\n=\\frac{\\mu^{4}\\kappa^{4}}{\\hbar^{4}}\\left[-\\frac{3}{n^{4}}+\\frac{4}{n^{3}\\left(\\ell+\\frac{1}{2}\\right)}\\right]。\n$$\n因此，由非抛物线性引起的一级能量修正是\n$$\n\\Delta E_{n\\ell}^{(1)}=\\frac{\\alpha_{c}+\\alpha_{v}}{\\hbar^{4}}\\;\\langle \\mathbf{p}^{4}\\rangle\n=\\frac{\\alpha_{c}+\\alpha_{v}}{\\hbar^{4}}\\cdot \\frac{\\mu^{4}\\kappa^{4}}{\\hbar^{4}}\\left[-\\frac{3}{n^{4}}+\\frac{4}{n^{3}\\left(\\ell+\\frac{1}{2}\\right)}\\right]。\n$$\n整理各项并回顾 $\\kappa=\\frac{e^{2}}{4\\pi \\varepsilon}$，得到闭式解析表达式\n$$\n\\Delta E_{n\\ell}^{(1)}=\\left(\\alpha_{c}+\\alpha_{v}\\right)\\frac{\\mu^{4}}{\\hbar^{8}}\\left(\\frac{e^{2}}{4\\pi \\varepsilon}\\right)^{4}\\left[\\frac{4}{n^{3}\\left(\\ell+\\frac{1}{2}\\right)}-\\frac{3}{n^{4}}\\right]。\n$$\n这就完成了从有效质量薛定谔方程和一级微扰理论出发的推导。", "answer": "$$\\boxed{\\left(\\alpha_{c}+\\alpha_{v}\\right)\\,\\frac{\\mu^{4}}{\\hbar^{8}}\\left(\\frac{e^{2}}{4\\pi \\varepsilon}\\right)^{4}\\left[\\frac{4}{n^{3}\\left(\\ell+\\frac{1}{2}\\right)}-\\frac{3}{n^{4}}\\right]}$$", "id": "2857751"}, {"introduction": "虽然解析方法对于理解理想模型至关重要，但对真实材料的复杂量子动力学过程进行建模，往往需要依赖强大的数值模拟技术。本练习将指导你动手编写代码，实现求解含时薛定谔方程的核心算法之一——算符分裂法 [@problem_id:2857777]。通过模拟谐振子基态的演化并分析其数值误差，你将不仅掌握一种模拟量子系统随时间演化的实用工具，更将学会如何验证和评估计算方法的准确性，这是成为一名计算材料科学家的基本功。", "problem": "实现一个程序，该程序基于二阶Trotter (Strang) 分解，使用分裂算符法求解一维含时薛定谔方程，并数值分析全局误差随时间步长的标度关系。从基本定律 $i\\hbar \\frac{\\partial}{\\partial t}\\psi(x,t)=H\\psi(x,t)$ 开始，其中哈密顿量被分解为 $H=H_T+H_V$，$H_T$ 是动能算符，$H_V$ 是势能算符。使用Hartree原子单位制，其中 $\\hbar=1$ 且电子质量 $m=1$；因此，在该单位制中所有量均为无量纲。定义 $H_T = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}$ 和 $H_V=V(x)$，因此 $H_T$ 在动量空间中是对角的，而 $H_V$ 在位置空间中是对角的。二阶Trotter分解将一个时间步长的演化近似为\n$$\ne^{-i(H_T+H_V)\\Delta t}\\approx e^{-iH_V\\Delta t/2}\\,e^{-iH_T\\Delta t}\\,e^{-iH_V\\Delta t/2},\n$$\n该近似是幺正的，并且其局域误差为 $\\mathcal{O}(\\Delta t^3)$ 阶。\n\n您必须使用快速傅里叶变换 (FFT, Fast Fourier Transform) 来实现此近似，在动量空间中应用 $e^{-iH_T\\Delta t}$，在位置空间中应用 $e^{-iH_V\\Delta t/2}$。对于收敛性研究，限定于谐振子势 $V(x)=\\frac{1}{2}\\omega^2 x^2$，并选择谐振子的精确归一化基态作为初始态，\n$$\n\\psi_0(x)=\\left(\\frac{\\omega}{\\pi}\\right)^{1/4}\\exp\\!\\left(-\\frac{\\omega x^2}{2}\\right).\n$$\n在原子单位制中，基态能量为 $E_0=\\frac{\\omega}{2}$，因此在时间 $t$ 的精确波函数为 $\\psi_{\\text{exact}}(x,t)=\\psi_0(x)\\,e^{-iE_0 t}$。\n\n在长度为 $L$ 的区域上，使用由FFT所隐含的周期性边界条件，将空间离散化为包含 $N$ 个点的均匀网格。设网格间距为 $\\Delta x=L/N$，坐标选择为 $x_j=-L/2 + j\\,\\Delta x$，其中 $j\\in\\{0,1,\\dots,N-1\\}$。为每个时间步长 $\\Delta t$ 实现以下步骤：\n- 在位置空间中应用势能半步演化：$\\psi(x)\\leftarrow e^{-iV(x)\\Delta t/2}\\psi(x)$。\n- 在动量空间中应用动能全步演化：$\\tilde{\\psi}(k)=\\mathcal{F}[\\psi(x)]$，然后 $\\tilde{\\psi}(k)\\leftarrow e^{-ik^2\\Delta t/2}\\tilde{\\psi}(k)$，再然后 $\\psi(x)=\\mathcal{F}^{-1}[\\tilde{\\psi}(k)]$，其中 $k$ 是由FFT频率约定定义的角波数，而 $k^2$ 在原子单位制中来自于 $H_T$。\n- 在位置空间中再次应用势能半步演化。\n\n对于每个指定的 $\\Delta t$，使用 $n=T/\\Delta t$ 步（假设 $n$ 为整数）将初始态演化总时间 $T$，并计算在时间 $T$ 的离散 $L^2$-误差：\n$$\nE(\\Delta t)=\\left(\\sum_{j=0}^{N-1}\\left|\\psi_{\\text{num}}(x_j,T)-\\psi_{\\text{exact}}(x_j,T)\\right|^2\\,\\Delta x\\right)^{1/2}。\n$$\n数值上归一化初始态，使得 $\\sum_j|\\psi_0(x_j)|^2\\,\\Delta x=1$。在所有计算中，使用双精度复数运算。\n\n通过对一组给定的 $\\Delta t$ 值，将 $\\log E(\\Delta t)$ 对 $\\log \\Delta t$ 进行线性拟合，来分析全局误差标度，并报告斜率 $s$。该斜率应反映二阶精度，即 $E(\\Delta t)\\propto \\Delta t^2$ 意味着 $s\\approx 2$。为进行额外的定量检查，还需计算连续误差比 $E(\\Delta t)/E(\\Delta t/2)$。\n\n使用以下三个测试用例。对于每个用例，所有参数都必须完全按照给定的方式实现。所有量都以原子单位制表示。\n\n- 测试用例 1 (通用情况)：\n  - 角频率为 $\\omega=1.0$ 的谐振子。\n  - 空间域长度 $L=20.0$，网格点数 $N=4096$。\n  - 总演化时间 $T=1.0$。\n  - 时间步长 $\\Delta t\\in\\{0.2,\\,0.1,\\,0.05,\\,0.025\\}$。\n  - 此用例需报告的输出：\n    - 通过对 $\\log E(\\Delta t)$ 与 $\\log \\Delta t$进行线性回归得到的拟合斜率 $s_1$。\n    - 三个连续误差比 $r_{1a}=E(0.2)/E(0.1)$、$r_{1b}=E(0.1)/E(0.05)$ 和 $r_{1c}=E(0.05)/E(0.025)$。\n\n- 测试用例 2 (更强约束)：\n  - 角频率为 $\\omega=2.0$ 的谐振子。\n  - 空间域长度 $L=20.0$，网格点数 $N=4096$。\n  - 总演化时间 $T=1.0$。\n  - 时间步长 $\\Delta t\\in\\{0.2,\\,0.1,\\,0.05,\\,0.025\\}$。\n  - 需报告的输出：拟合斜率 $s_2$。\n\n- 测试用例 3 (更长时间)：\n  - 角频率为 $\\omega=1.0$ 的谐振子。\n  - 空间域长度 $L=20.0$，网格点数 $N=4096$。\n  - 总演化时间 $T=2.0$。\n  - 时间步长 $\\Delta t\\in\\{0.2,\\,0.1,\\,0.05,\\,0.025\\}$。\n  - 需报告的输出：拟合斜率 $s_3$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列并进行四舍五入：\n- $[s_1,\\,r_{1a},\\,r_{1b},\\,r_{1c},\\,s_2,\\,s_3]$，\n- 其中每个数字都精确到 $6$ 位小数。\n\n在原子单位制中，所有数学量都是无量纲的。不报告任何角度，所有最终输出均为不带单位的纯数字。确保空间离散化足够精确，使得对于指定的参数，观察到的标度关系主要由时间离散化误差决定。您的实现必须是自包含的，且不得需要任何外部输入文件。", "solution": "所提出的问题是计算量子力学中的一个标准练习，并被认为是有效的。它具有科学依据、问题适定、客观，并包含唯一解所需的所有必要信息。我们将着手阐述解决方案的构建。\n\n基本任务是求解势 $V(x)$ 中粒子的​​一维含时薛定谔方程 (TDSE)。在Hartree原子单位制中，约化普朗克常数 $\\hbar$ 和电子质量 $m$ 均为1，此时TDSE由以下公式给出：\n$$\ni \\frac{\\partial}{\\partial t}\\psi(x,t) = \\hat{H}\\psi(x,t)\n$$\n哈密顿算符 $\\hat{H}$ 是动能算符 $\\hat{H}_T$ 和势能算符 $\\hat{H}_V$ 的和：\n$$\n\\hat{H} = \\hat{H}_T + \\hat{H}_V = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} + V(x)\n$$\n波函数 $\\psi(x,t)$ 从时间 $t$ 到 $t+\\Delta t$ 演化的形式解可通过时间演化算符 $\\hat{U}(\\Delta t) = e^{-i\\hat{H}\\Delta t}$ 表示：\n$$\n\\psi(x, t+\\Delta t) = e^{-i\\hat{H}\\Delta t} \\psi(x,t)\n$$\n直接数值应用此指数算符是不可行的，因为动能算符 $\\hat{H}_T$ 和势能算符 $\\hat{H}_V$ 不对易，即 $[\\hat{H}_T, \\hat{H}_V] \\neq 0$。这种不对易性使得简单的分解 $e^{-i(\\hat{H}_T + \\hat{H}_V)\\Delta t} = e^{-i\\hat{H}_T\\Delta t} e^{-i\\hat{H}_V\\Delta t}$ 不成立。\n\n为了解决这个问题，我们采用分裂算符法，该方法基于Trotter-Suzuki乘积公式。题目要求的具体变体是二阶对称Strang分裂，它将小时间步长 $\\Delta t$ 的演化算符近似为：\n$$\n\\hat{U}(\\Delta t) = e^{-i(\\hat{H}_T + \\hat{H}_V)\\Delta t} \\approx e^{-i\\hat{H}_V\\Delta t/2} \\, e^{-i\\hat{H}_T\\Delta t} \\, e^{-i\\hat{H}_V\\Delta t/2}\n$$\n此近似是幺正的，保持波函数的范数不变，其局域误差为 $\\mathcal{O}(\\Delta t^3)$ 阶。将系统演化总时间 $T$ 需要 $n = T/\\Delta t$ 步，导致的全局误差为 $\\mathcal{O}(\\Delta t^2)$ 阶。这正是我们必须验证的标度行为。\n\n该方法的强大之处在于其实现方式。算符 $\\hat{H}_V$ 在位置表象中是对角的（其作用是简单地乘以函数 $V(x)$），而算符 $\\hat{H}_T$ 在动量表象中是对角的。快速傅里叶变换 (FFT) 提供了一种在位置表象和动量表象之间高效转换波函数的数值方法。\n\n设波函数表示在一个包含 $N$ 个点 $\\{x_j\\}$、间距为 $\\Delta x = L/N$ 的离散空间网格上。相应的动量（波数）网格 $\\{k_j\\}$ 由离散傅里叶变换的性质确定。将波函数 $\\psi(x)$ 演化一个时间步长 $\\Delta t$ 的算法如下：\n\n1.  **第一步势能半步演化**：波函数处于位置表象中。我们应用势能传播算符的前一半，这是一个简单的乘法操作：\n    $$\n    \\psi(x_j, t + \\Delta t/2) = e^{-iV(x_j)\\Delta t/2} \\psi(x_j, t)\n    $$\n    对于指定的谐振子势，$V(x) = \\frac{1}{2}\\omega^2 x^2$。\n\n2.  **动能全步演化**：为了应用动能传播算符，我们使用FFT将波函数转换到动量表象：\n    $$\n    \\tilde{\\psi}(k_j, t + \\Delta t/2) = \\mathcal{F}[\\psi(x_j, t + \\Delta t/2)]\n    $$\n    在动量空间中，算符 $\\hat{H}_T = \\hat{p}^2/2$ 变为乘以函数 $k^2/2$（因为在我们的单位制中 $p=k$）。因此动能演化为：\n    $$\n    \\tilde{\\psi}(k_j, t + \\Delta t/2)_{\\text{after}} = e^{-ik_j^2\\Delta t/2} \\tilde{\\psi}(k_j, t + \\Delta t/2)\n    $$\n    然后使用逆FFT (iFFT) 将波函数转换回位置表象：\n    $$\n    \\psi'(x_j, t + \\Delta t/2) = \\mathcal{F}^{-1}[\\tilde{\\psi}(k_j, t + \\Delta t/2)_{\\text{after}}]\n    $$\n\n3.  **第二步势能半步演化**：最后一步是在位置表象中应用势能传播算符的后一半：\n    $$\n    \\psi(x_j, t + \\Delta t) = e^{-iV(x_j)\\Delta t/2} \\psi'(x_j, t + \\Delta t/2)\n    $$\n\n这个三步序列将状态从 $t$ 推进到 $t + \\Delta t$。重复该过程 $n = T/\\Delta t$ 次，以达到最终时间 $T$。\n\n对于收敛性分析，我们使用量子谐振子的精确基态作为初始态，即 $\\psi(x,0) = \\psi_0(x)$。这是哈密顿算符的本征态，能量为 $E_0 = \\omega/2$。因此，时间演化后的精确状态是解析已知的：\n$$\n\\psi_{\\text{exact}}(x,t) = \\psi_0(x) \\, e^{-iE_0 t}\n$$\n在最终时间 $T$ 获得数值解 $\\psi_{\\text{num}}(x_j, T)$ 后，我们计算离散 $L^2$-误差：\n$$\nE(\\Delta t) = \\left(\\sum_{j=0}^{N-1} |\\psi_{\\text{num}}(x_j, T) - \\psi_{\\text{exact}}(x_j, T)|^2 \\Delta x\\right)^{1/2}\n$$\n收敛阶数通过分析关系 $E(\\Delta t) \\propto (\\Delta t)^s$ 来确定。在对数尺度上，这变为 $\\log E = s \\log \\Delta t + C$，这是一个线性关系。我们对 $(\\log \\Delta t, \\log E)$ 数据点进行线性回归，以找到斜率 $s$，其值应约等于 $2$。此外，对于一个 $s$ 阶方法，连续步长的误差比 $E(\\Delta t) / E(\\Delta t/2)$ 应趋近于 $2^s$。当 $s=2$ 时，此比值为 $4$。\n\n因此，计算流程如下：对于每个测试用例，我们设置空间网格，定义并归一化初始波函数，并预先计算在时间 $T$ 的精确解。然后我们遍历指定的时间步长列表 $\\Delta t$。对于每个 $\\Delta t$，我们运行分裂算符模拟并计算最终误差 $E(\\Delta t)$。最后，我们使用收集到的误差数据来计算所需的斜率和误差比。整个过程都封装在提供的Python代码中。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef run_simulation(omega, L, N, T, delta_t_list):\n    \"\"\"\n    Runs a simulation for a given set of parameters and returns the error analysis.\n\n    Args:\n        omega (float): Angular frequency of the harmonic oscillator.\n        L (float): Length of the spatial domain.\n        N (int): Number of grid points.\n        T (float): Total propagation time.\n        delta_t_list (list of float): List of time steps for the convergence study.\n\n    Returns:\n        tuple: A tuple containing the fitted slope (float) and a list of error ratios (list of float).\n    \"\"\"\n\n    # 1. Setup spatial and momentum grids\n    dx = L / N\n    x = -L / 2 + np.arange(N) * dx\n    k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # 2. Define initial and exact final wavefunctions\n    # The initial state is the analytic ground state of the harmonic oscillator.\n    # We ensure it is a complex array for subsequent calculations.\n    psi0_analytic = ((omega / np.pi)**0.25 * np.exp(-omega * x**2 / 2)).astype(np.complex128)\n\n    # Numerically normalize the initial state on the discrete grid.\n    norm_factor = np.sqrt(np.sum(np.abs(psi0_analytic)**2) * dx)\n    psi0 = psi0_analytic / norm_factor\n\n    # The exact state at time T is the initial state multiplied by a phase factor.\n    # We use the numerically normalized psi0 for consistency.\n    E0 = omega / 2\n    psi_exact_T = psi0 * np.exp(-1j * E0 * T)\n\n    errors = []\n    \n    # Define the potential energy operator V(x)\n    V = 0.5 * omega**2 * x**2\n\n    # 3. Time evolution loop for each delta_t\n    for dt in delta_t_list:\n        n_steps = int(round(T / dt))\n        psi_current = psi0.copy()\n        \n        # Pre-compute time-evolution operators for this dt\n        exp_V_half = np.exp(-1j * V * dt / 2)\n        exp_T_full = np.exp(-1j * k**2 * dt / 2)\n        \n        for _ in range(n_steps):\n            # Apply first potential half-step in position space\n            psi_current *= exp_V_half\n            \n            # Apply kinetic full-step in momentum space\n            psi_k = np.fft.fft(psi_current)\n            psi_k *= exp_T_full\n            psi_current = np.fft.ifft(psi_k)\n            \n            # Apply second potential half-step in position space\n            psi_current *= exp_V_half\n            \n        # 4. Compute L2 error\n        error = np.sqrt(np.sum(np.abs(psi_current - psi_exact_T)**2) * dx)\n        errors.append(error)\n\n    # 5. Analyze error scaling\n    log_dt = np.log(delta_t_list)\n    log_E = np.log(errors)\n    \n    # Fit a line to log(E) vs log(dt) to find the slope\n    slope, _, _, _, _ = linregress(log_dt, log_E)\n    \n    # Compute successive error ratios\n    ratios = [errors[i] / errors[i+1] for i in range(len(errors) - 1)]\n    \n    return slope, ratios\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final results.\n    \"\"\"\n    \n    # Common Parameters\n    L = 20.0\n    N = 4096\n    delta_t_list = [0.2, 0.1, 0.05, 0.025]\n\n    # Test Case 1: General case\n    omega1 = 1.0\n    T1 = 1.0\n    s1, ratios1 = run_simulation(omega1, L, N, T1, delta_t_list)\n    r1a, r1b, r1c = ratios1[0], ratios1[1], ratios1[2]\n    \n    # Test Case 2: Stronger confinement\n    omega2 = 2.0\n    T2 = 1.0\n    s2, _ = run_simulation(omega2, L, N, T2, delta_t_list)\n\n    # Test Case 3: Longer time\n    omega3 = 1.0\n    T3 = 2.0\n    s3, _ = run_simulation(omega3, L, N, T3, delta_t_list)\n    \n    # Consolidate and format results\n    results = [s1, r1a, r1b, r1c, s2, s3]\n    formatted_results = [f\"{num:.6f}\" for num in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2857777"}]}