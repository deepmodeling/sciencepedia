{"hands_on_practices": [{"introduction": "掌握了麦克斯韦关系的核心思想后，让我们通过一个具体实例来练习如何从一个给定的热力学势函数出发，推导出麦克斯韦关系并将其应用于实际的物理模型。这个练习将帮助你连接抽象的数学推导与具体的材料行为，通过计算一个居里-外斯（Curie-Weiss）顺磁体在等温磁化过程中的熵变，来巩固你的理解。[@problem_id:2840422]", "problem": "一个均匀、宏观各向同性的磁性固体占据固定的体积，并处于一个空间均匀的准静态磁场 $H_m$ 中。使用国际单位制（SI），并考虑单位体积的物理量。假设除磁场外的力学变量保持不变，因此在所关心的场强范围内，热力学描述中可以忽略磁致伸缩和弹性功。\n\n仅从以下热力学假设出发：存在一个以 $(T,H_m)$ 为自然变量的勒让德变换自由能密度，并结合磁介质热力学第一定律的基本形式，推导一个麦克斯韦关系式，该关系式将恒定磁场下磁化强度的温度导数 $(\\partial M/\\partial T)_{H_m}$ 与恒定温度下熵的磁场导数 $(\\partial s/\\partial H_m)_T$ 联系起来。利用此结果，表示当 $H_m$ 在恒定温度 $T$ 下从 $H_{m,1}$ 准静态地变为 $H_{m,2}$ 时，单位体积的等温熵变 $\\Delta s(T,\\Delta H_m)$。\n\n现在，将问题具体化为一个高于其外斯温度的居里-外斯顺磁体，其磁化强度由以下线性本构关系决定\n$$\nM(T,H_m)=\\chi(T)\\,H_m,\\quad \\chi(T)=\\frac{C}{T-\\Theta},\\quad T\\Theta,\n$$\n其中 $C$ 是居里常数（单位体积），$\\Theta$ 是外斯温度。对此模型，计算 $\\Delta s(T,\\Delta H_m)$ 的闭合形式解。\n\n最后，明确指出为使沿路径 $T=\\mathrm{const}$ 的等温熵变在 $H_m$ 中与路径无关，所需的最小热力学假设。\n\n以焦耳每开尔文每立方米（$\\mathrm{J\\,K^{-1}\\,m^{-3}}$）为单位表示最终的单位体积熵变。你的最终答案必须是一个单一的闭合形式解析表达式，用 $T$、$H_{m,1}$、$H_{m,2}$、$C$、$\\Theta$ 和磁常数 $\\mu_0$ 表示。在最终的方框表达式中不要包含任何单位。", "solution": "所述问题具有科学依据，提法明确且客观。它是磁热力学中的一个标准练习，基于已建立的物理原理和数学方法。该问题提供了所有必要信息，并且内部一致。因此，该问题被认为是有效的，并将提供完整的解答。\n\n该问题要求一个以温度 $T$ 和外加磁场 $H_m$ 为自然变量的热力学势。所有量均为单位体积量。我们从内能密度 $u$ 的微分形式开始，对于在指定条件下（体积固定，无其他功项）的磁系统，热力学第一定律给出：\n$$\ndu = T ds + \\mu_0 H_m dM\n$$\n这里，$s$ 是熵密度，$M$ 是磁化强度，$\\mu_0$ 是磁常数。$u$ 的自然变量是 $(s, M)$。为了获得以 $(T, H_m)$ 为自然变量的势，我们必须进行双重勒让德变换。\n\n首先，我们定义类亥姆霍兹自由能密度 $f = u - Ts$。其微分为：\n$$\ndf = du - Tds - sdT = (Tds + \\mu_0 H_m dM) - Tds - sdT = -s dT + \\mu_0 H_m dM\n$$\n$f$ 的自然变量是 $(T, M)$。\n\n接下来，我们定义类吉布斯自由能密度 $g = f - \\mu_0 H_m M$。这个变换是必要的，以便将自然变量从磁化强度 $M$ 变为磁场 $H_m$。其微分为：\n$$\ndg = df - \\mu_0 H_m dM - \\mu_0 M dH_m = (-s dT + \\mu_0 H_m dM) - \\mu_0 H_m dM - \\mu_0 M dH_m\n$$\n$$\ndg = -s dT - \\mu_0 M dH_m\n$$\n这个自由能密度 $g(T, H_m)$ 具有所需的自然变量。问题假定存在这样一个函数。$g$ 作为状态函数的存在性意味着其微分 $dg$ 是一个全微分。从微分形式中，我们确定偏导数：\n$$\ns = -\\left(\\frac{\\partial g}{\\partial T}\\right)_{H_m} \\quad \\text{和} \\quad \\mu_0 M = -\\left(\\frac{\\partial g}{\\partial H_m}\\right)_T\n$$\n对于一个全微分，混合二阶偏导数必须相等（根据 Clairaut 定理的混合偏导数相等原则）：\n$$\n\\frac{\\partial}{\\partial H_m}\\left(\\frac{\\partial g}{\\partial T}\\right)_{H_m} = \\frac{\\partial}{\\partial T}\\left(\\frac{\\partial g}{\\partial H_m}\\right)_T\n$$\n代入一阶导数的表达式可得：\n$$\n\\frac{\\partial}{\\partial H_m}(-s)_T = \\frac{\\partial}{\\partial T}(-\\mu_0 M)_{H_m}\n$$\n$$\n-\\left(\\frac{\\partial s}{\\partial H_m}\\right)_T = -\\mu_0 \\left(\\frac{\\partial M}{\\partial T}\\right)_{H_m}\n$$\n这就得出了所要求的麦克斯韦关系式：\n$$\n\\left(\\frac{\\partial s}{\\partial H_m}\\right)_T = \\mu_0 \\left(\\frac{\\partial M}{\\partial T}\\right)_{H_m}\n$$\n\n第二个任务是求当磁场在恒定温度 $T$ 下从 $H_{m,1}$ 准静态地变化到 $H_{m,2}$ 时的等温熵变 $\\Delta s$。这一变化是通过沿等温线对熵关于磁场的偏导数进行积分来计算的：\n$$\n\\Delta s = s(T, H_{m,2}) - s(T, H_{m,1}) = \\int_{H_{m,1}}^{H_{m,2}} \\left(\\frac{\\partial s}{\\partial H_m}\\right)_T dH_m\n$$\n使用推导出的麦克斯韦关系式，这变为：\n$$\n\\Delta s = \\int_{H_{m,1}}^{H_{m,2}} \\mu_0 \\left(\\frac{\\partial M}{\\partial T}\\right)_{H_m} dH_m\n$$\n\n现在，我们具体到居里-外斯顺磁体的情况，其磁化强度 $M$ 由以下本构关系给出：\n$$\nM(T,H_m) = \\chi(T) H_m = \\frac{C}{T-\\Theta} H_m\n$$\n其中 $T  \\Theta$。我们必须计算 $M$ 相对于 $T$ 在 $H_m$ 固定的情况下的偏导数：\n$$\n\\left(\\frac{\\partial M}{\\partial T}\\right)_{H_m} = \\frac{\\partial}{\\partial T}\\left(\\frac{C H_m}{T-\\Theta}\\right) = C H_m \\frac{\\partial}{\\partial T}\\left((T-\\Theta)^{-1}\\right)\n$$\n$$\n\\left(\\frac{\\partial M}{\\partial T}\\right)_{H_m} = C H_m \\left(-1 \\cdot (T-\\Theta)^{-2} \\cdot 1\\right) = -\\frac{C H_m}{(T-\\Theta)^2}\n$$\n我们将该导数代入 $\\Delta s$ 的积分中：\n$$\n\\Delta s = \\int_{H_{m,1}}^{H_{m,2}} \\mu_0 \\left(-\\frac{C H_m}{(T-\\Theta)^2}\\right) dH_m\n$$\n由于 $\\mu_0$、$C$、$T$ 和 $\\Theta$ 相对于积分变量 $H_m$ 是常数，我们可以将它们移到积分符号之外：\n$$\n\\Delta s = -\\frac{\\mu_0 C}{(T-\\Theta)^2} \\int_{H_{m,1}}^{H_{m,2}} H_m dH_m\n$$\n$H_m$ 的积分是初等的：\n$$\n\\int_{H_{m,1}}^{H_{m,2}} H_m dH_m = \\left[\\frac{1}{2}H_m^2\\right]_{H_{m,1}}^{H_{m,2}} = \\frac{1}{2}(H_{m,2}^2 - H_{m,1}^2)\n$$\n将此结果代回，我们得到单位体积等温熵变的最终闭合形式表达式：\n$$\n\\Delta s(T) = -\\frac{\\mu_0 C}{2(T-\\Theta)^2}(H_{m,2}^2 - H_{m,1}^2)\n$$\n\n最后，我们讨论为使等温熵变在 $H_m$ 中与路径无关所需的最小热力学假设。两个状态 $(T, H_{m,1})$ 和 $(T, H_{m,2})$ 之间的熵变由 $\\Delta s = s(T, H_{m,2}) - s(T, H_{m,1})$ 给出。这种变化是固有地与路径无关的，当且仅当熵 $s$ 是一个状态函数，这意味着它的值由热力学平衡系统中系统的状态变量 $(T, H_m)$ 唯一确定。满足此条件的最小假设是热力学第二定律，该定律假定对于经历可逆过程的系统存在这样一个状态函数。在本问题的背景下，这等同于最初的假设，即存在一个吉布斯自由能密度 $g(T, H_m)$，它是一个具有连续二阶导数的状态函数，熵由其导出为 $s = -(\\partial g/\\partial T)_{H_m}$。过程的准静态性质确保了系统通过一系列平衡状态演化，使得积分有意义。", "answer": "$$\n\\boxed{-\\frac{\\mu_0 C (H_{m,2}^{2} - H_{m,1}^{2})}{2 (T-\\Theta)^{2}}}\n$$", "id": "2840422"}, {"introduction": "麦克斯韦关系及其派生理论的威力在于它们能在不同物理量之间建立起意想不到的联系。在本练习中，我们将探讨一个二级相变（连续相变）的例子，其中体积和熵没有突变。你将运用与麦克斯韦关系同源的埃伦费斯特方程（Ehrenfest equations），利用材料的热膨胀系数和等温压缩率在相变点两侧的非连续性，来计算相变边界在压力-温度（$P-T$）图上的斜率。[@problem_id:2840464]", "problem": "一种晶态金属间化合物在温度 $T_{0}$ 和压力 $P_{0}$ 下表现出连续的固-固有序-无序相变。在 $(T_{0},P_{0})$ 附近，实验观察到该相变的摩尔体积和摩尔熵均无明显的不连续性，因此摩尔吉布斯自由能对压力和温度的一阶导数在相变点是连续的。给定以下在 $(T_{0},P_{0})$ 两侧紧邻处独立测得的热物理性质：\n\n- A相的体热膨胀系数: $\\alpha_{A} = 3.0 \\times 10^{-5}\\,\\mathrm{K^{-1}}$。\n- B相的体热膨胀系数: $\\alpha_{B} = 1.5 \\times 10^{-5}\\,\\mathrm{K^{-1}}$。\n- A相的等温压缩率: $\\kappa_{T,A} = 5.0 \\times 10^{-12}\\,\\mathrm{Pa^{-1}}$。\n- B相的等温压缩率: $\\kappa_{T,B} = 3.0 \\times 10^{-12}\\,\\mathrm{Pa^{-1}}$。\n\n假设摩尔体积在相变点是连续的。从摩尔吉布斯自由能的微分形式 $dG = V\\,dP - S\\,dT$ 和麦克斯韦关系式 $(\\partial S/\\partial P)_{T} = -(\\partial V/\\partial T)_{P}$ 出发，推导相界在 $(T_{0},P_{0})$ 处的斜率 $dP/dT$ 的表达式，该表达式应以相应响应函数在相变点的不连续性来表示。然后使用上述数据计算其数值。\n\n请用 $\\mathrm{MPa/K}$ 单位表示斜率的最终数值答案，并将答案四舍五入到三位有效数字。最终答案必须是一个实数值。", "solution": "该问题是材料热力学中一个有效的练习。它具有科学依据，提法严谨，并提供了足够的数据以得到唯一解。我们将进行推导和计算。\n\n两相（A和B）达到相平衡的条件是它们的摩尔吉布斯自由能相等，即 $G_{A}(T, P) = G_{B}(T, P)$。对于相界上的任意一点 $(T, P)$，一个微分位移 $(dT, dP)$ 必须保持此相等关系。因此，$dG_{A} = dG_{B}$。使用基本关系式 $dG = V dP - S dT$，我们有：\n$$V_{A}dP - S_{A}dT = V_{B}dP - S_{B}dT$$\n这导出了相界斜率的克拉佩龙方程：\n$$\\frac{dP}{dT} = \\frac{S_{B} - S_{A}}{V_{B} - V_{A}} = \\frac{\\Delta S}{\\Delta V}$$\n\n该问题描述的是一个连续相变，或称二级相变。根据定义，对于此类相变，吉布斯自由能的一阶导数是连续的。这意味着在相变点 $(T_0, P_0)$ 处，摩尔熵 ($S$) 或摩尔体积 ($V$) 没有不连续性。\n$$S_{A}(T_0, P_0) = S_{B}(T_0, P_0) \\implies \\Delta S = 0$$\n$$V_{A}(T_0, P_0) = V_{B}(T_0, P_0) \\implies \\Delta V = 0$$\n将这些代入克拉佩龙方程会得到 $0/0$ 的不定式，这表明需要采用一种不同的方法，即使用吉布斯自由能的二阶导数，而这些导数对于这类相变是不连续的。这些导数与可测量的响应函数相关，如热容、热膨胀系数和等温压缩率。\n\n我们可以推导出两个关于 $dP/dT$ 的表达式，称为埃伦费斯特方程。我们从一阶导数沿着相共存曲线 $P(T)$ 的连续性出发。让我们考虑摩尔体积的连续性：$V_{A}(T, P(T)) = V_{B}(T, P(T))$。沿着该曲线对此恒等式关于温度 $T$ 求导，并应用全微分链式法则，我们得到：\n$$\\frac{d}{dT} \\left[V_{A}(T, P(T))\\right] = \\frac{d}{dT} \\left[V_{B}(T, P(T))\\right]$$\n$$ \\left(\\frac{\\partial V_{A}}{\\partial T}\\right)_{P} + \\left(\\frac{\\partial V_{A}}{\\partial P}\\right)_{T} \\frac{dP}{dT} = \\left(\\frac{\\partial V_{B}}{\\partial T}\\right)_{P} + \\left(\\frac{\\partial V_{B}}{\\partial P}\\right)_{T} \\frac{dP}{dT} $$\n我们可以重新整理此方程以求解斜率 $dP/dT$：\n$$ \\frac{dP}{dT} \\left[ \\left(\\frac{\\partial V_{A}}{\\partial P}\\right)_{T} - \\left(\\frac{\\partial V_{B}}{\\partial P}\\right)_{T} \\right] = \\left(\\frac{\\partial V_{B}}{\\partial T}\\right)_{P} - \\left(\\frac{\\partial V_{A}}{\\partial T}\\right)_{P} $$\n$$ \\frac{dP}{dT} = \\frac{\\left(\\frac{\\partial V_{B}}{\\partial T}\\right)_{P} - \\left(\\frac{\\partial V_{A}}{\\partial T}\\right)_{P}}{\\left(\\frac{\\partial V_{A}}{\\partial P}\\right)_{T} - \\left(\\frac{\\partial V_{B}}{\\partial P}\\right)_{T}} $$\n现在，我们将这些偏导数与所给的热物理性质联系起来：体热膨胀系数 $\\alpha = \\frac{1}{V}\\left(\\frac{\\partial V}{\\partial T}\\right)_{P}$，以及等温压缩率 $\\kappa_{T} = -\\frac{1}{V}\\left(\\frac{\\partial V}{\\partial P}\\right)_{T}$。\n根据这些定义，我们有 $\\left(\\frac{\\partial V}{\\partial T}\\right)_{P} = V\\alpha$ 和 $\\left(\\frac{\\partial V}{\\partial P}\\right)_{T} = -V\\kappa_{T}$。将它们代入 $dP/dT$ 的表达式中：\n$$ \\frac{dP}{dT} = \\frac{V_{B}\\alpha_{B} - V_{A}\\alpha_{A}}{-V_{A}\\kappa_{T,A} - (-V_{B}\\kappa_{T,B})} = \\frac{V_{B}\\alpha_{B} - V_{A}\\alpha_{A}}{V_{B}\\kappa_{T,B} - V_{A}\\kappa_{T,A}} $$\n由于摩尔体积在相变点是连续的，即在 $(T_0, P_0)$ 处 $V_{A} = V_{B} = V_0$。分子和分母中的 $V_0$ 项可以消去：\n$$ \\frac{dP}{dT} = \\frac{V_0(\\alpha_{B} - \\alpha_{A})}{V_0(\\kappa_{T,B} - \\kappa_{T,A})} = \\frac{\\alpha_{B} - \\alpha_{A}}{\\kappa_{T,B} - \\kappa_{T,A}} $$\n这就是第二埃伦费斯特方程。它恰好使用了问题陈述中提供的实验数据。问题中提到的麦克斯韦关系式 $(\\partial S/\\partial P)_{T} = -(\\partial V/\\partial T)_{P}$ 与整个热力学框架相关，并用于推导第一埃伦费斯特方程 $\\frac{dP}{dT} = \\frac{\\Delta C_P}{T_0 V_0 \\Delta \\alpha}$，但由于没有提供热容 $C_P$ 的数据，我们无法使用该方程。该问题可以使用我们已经推导出的第二埃伦费斯特方程求解。\n\n我们将不连续性定义为 $\\Delta \\alpha = \\alpha_{B} - \\alpha_{A}$ 和 $\\Delta \\kappa_{T} = \\kappa_{T,B} - \\kappa_{T,A}$。表达式变为：\n$$ \\frac{dP}{dT} = \\frac{\\Delta \\alpha}{\\Delta \\kappa_{T}} $$\n我们已知以下数值：\n$\\alpha_{A} = 3.0 \\times 10^{-5}\\,\\mathrm{K^{-1}}$\n$\\alpha_{B} = 1.5 \\times 10^{-5}\\,\\mathrm{K^{-1}}$\n$\\kappa_{T,A} = 5.0 \\times 10^{-12}\\,\\mathrm{Pa^{-1}}$\n$\\kappa_{T,B} = 3.0 \\times 10^{-12}\\,\\mathrm{Pa^{-1}}$\n\n首先，计算不连续性：\n$$ \\Delta\\alpha = (1.5 \\times 10^{-5}) - (3.0 \\times 10^{-5}) = -1.5 \\times 10^{-5}\\,\\mathrm{K^{-1}} $$\n$$ \\Delta\\kappa_{T} = (3.0 \\times 10^{-12}) - (5.0 \\times 10^{-12}) = -2.0 \\times 10^{-12}\\,\\mathrm{Pa^{-1}} $$\n现在，我们计算斜率：\n$$ \\frac{dP}{dT} = \\frac{-1.5 \\times 10^{-5}\\,\\mathrm{K^{-1}}}{-2.0 \\times 10^{-12}\\,\\mathrm{Pa^{-1}}} = 0.75 \\times 10^{7}\\,\\mathrm{Pa/K} $$\n题目要求答案以 $\\mathrm{MPa/K}$ 为单位。由于 $1\\,\\mathrm{MPa} = 10^6\\,\\mathrm{Pa}$，我们进行单位换算：\n$$ \\frac{dP}{dT} = (0.75 \\times 10^{7}\\,\\mathrm{Pa/K}) \\times \\left(\\frac{1\\,\\mathrm{MPa}}{10^6\\,\\mathrm{Pa}}\\right) = 7.5\\,\\mathrm{MPa/K} $$\n最终答案必须保留三位有效数字。因此，我们将结果表示为 $7.50\\,\\mathrm{MPa/K}$。", "answer": "$$\\boxed{7.50}$$", "id": "2840464"}, {"introduction": "为了将麦克斯韦关系的数学确定性带入计算实践中，这个练习将指导你构建一个计算工作流。你将为一个假设的热弹性材料，通过编写代码和使用有限差分法，数值验证一个由亥姆霍兹自由能导出的麦克斯韦关系。这个过程不仅能加深你对热力学势、应力张量 $\\sigma_{ij}$ 和熵密度 $s$ 之间定义的理解，还能让你体会到理论恒等式在数值计算中的精确体现。[@problem_id:2840379]", "problem": "您的任务是为一种热弹性材料构建并验证一个计算工作流，该工作流需要数值上验证一个连接了Helmholtz自由能密度混合导数的Maxwell型关系。重点在于验证一个纯粹从Helmholtz自由能密度定义中推导出的关系，该关系联系了在应变固定时Cauchy应力张量对温度的导数，以及在温度固定时熵密度对应变的相应导数。您必须完全从第一性原理出发，且仅使用以下基本定义和事实：\n- Helmholtz自由能密度是一个标量势$\\,\\psi(T,\\epsilon_{ij})\\,$，对于均匀热弹性固体，它取决于绝对温度$\\,T\\,$和小应变张量$\\,\\epsilon_{ij}\\,$。\n- Cauchy应力张量由共轭关系$\\,\\sigma_{ij} = \\dfrac{\\partial \\psi}{\\partial \\epsilon_{ij}}\\,$定义，此时$\\,T\\,$固定。\n- 熵密度由$\\,s = - \\dfrac{\\partial \\psi}{\\partial T}\\,$定义，此时$\\,\\epsilon_{ij}\\,$固定。\n- 对于足够光滑的$\\,\\psi\\,$，混合偏导数相等。\n\n您的程序必须：\n1) 为二维小应变固体定义一个光滑、热力学上合理的Helmholtz自由能密度函数$\\,\\psi(T,\\epsilon_{ij})\\,$，其具体形式和常数如下：\n   - 使用各向同性弹性基底，其Lamé系数为$\\,\\lambda = 60.0 \\times 10^{9}\\,\\mathrm{Pa}\\,$和$\\,\\mu = 40.0 \\times 10^{9}\\,\\mathrm{Pa}\\,$。\n   - 包含线性热弹性耦合项和温度的二次项：\n     $$\\psi(T,\\epsilon) = \\frac{1}{2}\\lambda \\left(\\mathrm{tr}\\,\\epsilon\\right)^{2} + \\mu \\left(\\epsilon_{11}^{2} + \\epsilon_{22}^{2} + 2\\,\\epsilon_{12}^{2}\\right) - T\\left(\\alpha_{11}\\epsilon_{11} + \\alpha_{22}\\epsilon_{22}\\right) + \\frac{1}{2}a\\,T^{2} + \\frac{1}{2}T^{2}\\left(D_{11}\\epsilon_{11} + D_{22}\\epsilon_{22}\\right),$$\n     其中$\\,\\mathrm{tr}\\,\\epsilon = \\epsilon_{11} + \\epsilon_{22}\\,$，常数为\n     $\\,\\alpha_{11} = 1.2 \\times 10^{7}\\,\\mathrm{Pa/K}\\,$，$\\,\\alpha_{22} = 0.9 \\times 10^{7}\\,\\mathrm{Pa/K}\\,$，$\\,a = 1.0 \\times 10^{6}\\,\\mathrm{Pa/K^{2}}\\,$，$\\,D_{11} = 2.5 \\times 10^{5}\\,\\mathrm{Pa/K^{2}}\\,$，以及$\\,D_{22} = 1.7 \\times 10^{5}\\,\\mathrm{Pa/K^{2}}\\,$。设定$\\,\\epsilon_{12} = \\epsilon_{21}\\,$，但不包括非对角热弹性耦合项；仅$\\,\\alpha_{11}, \\alpha_{22}, D_{11}, D_{22}\\,$按规定为非零。由于弹性模量是正定的，此形式对于小应变是稳定的，并且它引入了非平凡的温度-应变耦合，从而使得相关的混合导数不为零且与温度相关。\n2) 使用中心有限差分来近似导数。对于一个给定的基准状态$\\,\\left(T_{0}, \\epsilon^{(0)}\\right)\\,$、一个施加于单个分量$\\,\\epsilon_{ij}\\,$的温度增量$\\,h_{T}\\,$和一个应变增量$\\,h_{\\epsilon}\\,$，为$\\, (i,j) \\in \\{(1,1),(2,2)\\}\\,$中的每个分量计算两个数值近似值：\n   - 路径A：使用嵌套中心差分计算$\\,\\left(\\dfrac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\epsilon}\\,$，\n     $$\\sigma_{ij}(T,\\epsilon) \\approx \\frac{\\psi\\!\\left(T,\\epsilon + h_{\\epsilon}\\,\\mathbf{E}^{(ij)}\\right) - \\psi\\!\\left(T,\\epsilon - h_{\\epsilon}\\,\\mathbf{E}^{(ij)}\\right)}{2 h_{\\epsilon}},$$\n     $$\\left(\\frac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\epsilon} \\approx \\frac{\\sigma_{ij}(T_{0} + h_{T},\\epsilon^{(0)}) - \\sigma_{ij}(T_{0} - h_{T},\\epsilon^{(0)})}{2 h_{T}},$$\n     其中$\\,\\mathbf{E}^{(ij)}\\,$表示在$\\,\\epsilon_{ij}\\,$分量上的单位扰动，并且对称性$\\,\\epsilon_{12}=\\epsilon_{21}\\,$始终保持。对于各自的分量，仅$\\,\\epsilon_{11}\\,$或$\\,\\epsilon_{22}\\,$被扰动。\n   - 路径B：使用嵌套中心差分计算$\\, -\\left(\\dfrac{\\partial s}{\\partial \\epsilon_{ij}}\\right)_{T}\\,$，\n     $$s(T,\\epsilon) \\approx -\\frac{\\psi(T_{0}+h_{T},\\epsilon) - \\psi(T_{0}-h_{T},\\epsilon)}{2 h_{T}},$$\n     $$-\\left(\\frac{\\partial s}{\\partial \\epsilon_{ij}}\\right)_{T} \\approx -\\frac{s\\!\\left(T_{0},\\epsilon^{(0)} + h_{\\epsilon}\\,\\mathbf{E}^{(ij)}\\right) - s\\!\\left(T_{0},\\epsilon^{(0)} - h_{\\epsilon}\\,\\mathbf{E}^{(ij)}\\right)}{2 h_{\\epsilon}}.$$\n   您的实现必须完全按照所写的方式使用中心差分，不得进行任何符号微分或使用快捷公式。\n3) 对于每个测试用例，计算在被验证的分量$\\, (1,1)\\,$和$\\, (2,2)\\,$上的最大相对不匹配度：\n   $$\\mathrm{rel\\_err} = \\max_{(i,j)\\in\\{(1,1),(2,2)\\}} \\frac{\\left|\\left(\\dfrac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\epsilon} + \\left(\\dfrac{\\partial s}{\\partial \\epsilon_{ij}}\\right)_{T}\\right|}{\\max\\!\\left(1, \\left|\\left(\\dfrac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\epsilon}\\right|, \\left|\\left(\\dfrac{\\partial s}{\\partial \\epsilon_{ij}}\\right)_{T}\\right|\\right)}.$$\n   该量是无量纲的；请将其作为浮点数报告。\n4) 使用以下测试套件。在所有情况下，基准应变都是对称的，其分量为$\\,\\epsilon_{11}^{(0)}, \\epsilon_{22}^{(0)}, \\epsilon_{12}^{(0)}\\,$（且$\\,\\epsilon_{21}^{(0)} = \\epsilon_{12}^{(0)}\\,$）。温度增量的单位是开尔文，应变增量是无量纲的。对于每个测试用例，计算一个单一的浮点数结果，即上面定义的$\\,\\mathrm{rel\\_err}\\,$。\n   - 案例A（一般“顺利路径”）：$\\,T_{0} = 300.0\\,\\mathrm{K}\\,$，$\\,\\epsilon_{11}^{(0)} = 1.0 \\times 10^{-3}\\,$, $\\,\\epsilon_{22}^{(0)} = -2.0 \\times 10^{-4}\\,$, $\\,\\epsilon_{12}^{(0)} = 5.0 \\times 10^{-4}\\,$, $\\,h_{T} = 1.0\\,\\mathrm{K}\\,$，$\\,h_{\\epsilon} = 1.0 \\times 10^{-6}\\,$。\n   - 案例B（低温和小步长）：$\\,T_{0} = 10.0\\,\\mathrm{K}\\,$，$\\,\\epsilon_{11}^{(0)} = -4.0 \\times 10^{-4}\\,$, $\\,\\epsilon_{22}^{(0)} = 3.0 \\times 10^{-4}\\,$, $\\,\\epsilon_{12}^{(0)} = 0.0\\,$, $\\,h_{T} = 0.1\\,\\mathrm{K}\\,$，$\\,h_{\\epsilon} = 5.0 \\times 10^{-7}\\,$。\n   - 案例C（高温和较大步长）：$\\,T_{0} = 1000.0\\,\\mathrm{K}\\,$，$\\,\\epsilon_{11}^{(0)} = 2.0 \\times 10^{-3}\\,$, $\\,\\epsilon_{22}^{(0)} = -1.0 \\times 10^{-3}\\,$, $\\,\\epsilon_{12}^{(0)} = 1.0 \\times 10^{-4}\\,$, $\\,h_{T} = 10.0\\,\\mathrm{K}\\,$，$\\,h_{\\epsilon} = 2.0 \\times 10^{-5}\\,$。\n   - 案例D（近零应变，非常小的$\\,h_{\\epsilon}\\,$）：$\\,T_{0} = 1.0\\,\\mathrm{K}\\,$，$\\,\\epsilon_{11}^{(0)} = 1.0 \\times 10^{-6}\\,$, $\\,\\epsilon_{22}^{(0)} = -1.0 \\times 10^{-6}\\,$, $\\,\\epsilon_{12}^{(0)} = 0.0\\,$, $\\,h_{T} = 5.0\\,\\mathrm{K}\\,$，$\\,h_{\\epsilon} = 1.0 \\times 10^{-8}\\,$。\n5) 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[x0,x1,x2,x3]”），列表中的每个条目依次对应于案例A、B、C和D计算出的$\\,\\mathrm{rel\\_err}\\,$。如上所述，每个条目都是一个无量纲的浮点数。\n\n重要说明：\n- 此处不涉及角度单位。\n- 最终报告的量是无量纲的；不要在输出值上附加任何物理单位。\n- 在实现逻辑中不允许使用任何符号微分或封闭形式的“捷径”；只能使用上面陈述的中心有限差分公式。", "solution": "该问题要求对一种热弹性材料，数值验证一个从Helmholtz自由能密度$\\psi$推导出的Maxwell关系。在继续之前，必须对问题陈述进行严格的验证。\n\n### 问题验证\n\n**步骤1：提取的已知条件**\n\n1.  **势与场**：\n    *   Helmholtz自由能密度：$\\psi(T, \\epsilon_{ij})$，一个取决于绝对温度$T$和小应变张量$\\epsilon_{ij}$的标量势函数。\n    *   Cauchy应力张量：$\\sigma_{ij} = \\dfrac{\\partial \\psi}{\\partial \\epsilon_{ij}}$，在$T$恒定时。\n    *   熵密度：$s = - \\dfrac{\\partial \\psi}{\\partial T}$，在$\\epsilon_{ij}$恒定时。\n\n2.  **Maxwell关系**：该关系源于对于一个足够光滑的函数$\\psi$的混合偏导数相等性（Clairaut-Schwarz定理）：\n    $$ \\frac{\\partial^2 \\psi}{\\partial T \\partial \\epsilon_{ij}} = \\frac{\\partial^2 \\psi}{\\partial \\epsilon_{ij} \\partial T} $$\n    代入$\\sigma_{ij}$和$s$的定义，得到待验证的关系式：\n    $$ \\frac{\\partial}{\\partial T}\\left(\\frac{\\partial \\psi}{\\partial \\epsilon_{ij}}\\right) = -\\frac{\\partial}{\\partial \\epsilon_{ij}}\\left(-\\frac{\\partial \\psi}{\\partial T}\\right) \\implies \\left(\\frac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\epsilon} = -\\left(\\frac{\\partial s}{\\partial \\epsilon_{ij}}\\right)_{T} $$\n\n3.  **本构模型**：问题提供了二维固体的Helmholtz自由能密度的具体形式：\n    $$ \\psi(T,\\epsilon) = \\frac{1}{2}\\lambda \\left(\\mathrm{tr}\\,\\epsilon\\right)^{2} + \\mu \\left(\\epsilon_{11}^{2} + \\epsilon_{22}^{2} + 2\\,\\epsilon_{12}^{2}\\right) - T\\left(\\alpha_{11}\\epsilon_{11} + \\alpha_{22}\\epsilon_{22}\\right) + \\frac{1}{2}a\\,T^{2} + \\frac{1}{2}T^{2}\\left(D_{11}\\epsilon_{11} + D_{22}\\epsilon_{22}\\right) $$\n    其中$\\mathrm{tr}\\,\\epsilon = \\epsilon_{11} + \\epsilon_{22}$，且应变张量是对称的（$\\epsilon_{12} = \\epsilon_{21}$）。\n\n4.  **材料常数**：\n    *   $\\lambda = 60.0 \\times 10^{9}\\,\\mathrm{Pa}$\n    *   $\\mu = 40.0 \\times 10^{9}\\,\\mathrm{Pa}$\n    *   $\\alpha_{11} = 1.2 \\times 10^{7}\\,\\mathrm{Pa/K}$\n    *   $\\alpha_{22} = 0.9 \\times 10^{7}\\,\\mathrm{Pa/K}$\n    *   $a = 1.0 \\times 10^{6}\\,\\mathrm{Pa/K^{2}}$\n    *   $D_{11} = 2.5 \\times 10^{5}\\,\\mathrm{Pa/K^{2}}$\n    *   $D_{22} = 1.7 \\times 10^{5}\\,\\mathrm{Pa/K^{2}}$\n\n5.  **数值方法**：必须使用指定的中心有限差分格式来近似导数。\n    *   **路径A，用于计算$(\\partial\\sigma_{ij}/\\partial T)_{\\epsilon}$**：一种嵌套中心差分，其中内层差分近似$\\sigma_{ij}$，外层差分近似其关于$T$的导数。\n    *   **路径B，用于计算$-(\\partial s/\\partial\\epsilon_{ij})_T$**：一种嵌套中心差分，其中内层差分近似$s$，外层差分近似其关于$\\epsilon_{ij}$的导数。\n    *   问题明确定义了所要使用的数值公式。\n    *   问题要求严格遵守这些数值方案，不得进行任何符号代换。\n\n6.  **误差度量**：在分量$(i,j) \\in \\{(1,1), (2,2)\\}$上的最大相对不匹配度计算如下：\n    $$ \\mathrm{rel\\_err} = \\max_{(i,j)\\in\\{(1,1),(2,2)\\}} \\frac{\\left|\\left(\\dfrac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\epsilon} + \\left(\\dfrac{\\partial s}{\\partial \\epsilon_{ij}}\\right)_{T}\\right|}{\\max\\!\\left(1, \\left|\\left(\\dfrac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\epsilon}\\right|, \\left|\\left(\\dfrac{\\partial s}{\\partial \\epsilon_{ij}}\\right)_{T}\\right|\\right)} $$\n\n7.  **测试用例**：提供了四个不同的测试用例 (A, B, C, D)，指定了基准状态$(T_0, \\epsilon^{(0)})$以及有限差分增量$h_T$和$h_\\epsilon$。\n\n**步骤2：已知条件的验证**\n\n该问题具有坚实的科学基础，源于平衡态热力学应用于连续介质的基本假设。所选的Helmholtz自由能形式是应变和温度的标准二阶展开式，适用于模拟热弹性行为。所有常数、变量和数值方法都已明确定义，使得问题自成体系且适定。目标清晰，没有歧义。该数值任务是直接实现所提供的公式，以验证一个基本的物理定律。不存在矛盾、缺失数据或科学上不成立的前提。\n\n值得注意的是，如果对指定的$(\\partial\\sigma_{ij}/\\partial T)_{\\epsilon}$和$-(\\partial s/\\partial\\epsilon_{ij})_T$的数值近似进行代数展开，会发现它们是恒等的。对于一个分量$(i,j)$，令$\\epsilon_{ij}^{\\pm} = \\epsilon^{(0)} \\pm h_{\\epsilon}\\mathbf{E}^{(ij)}$。\n$(\\partial\\sigma_{ij}/\\partial T)_{\\epsilon}$的数值近似为：\n$$ \\frac{1}{4 h_T h_\\epsilon} \\left[ \\psi(T_0+h_T, \\epsilon_{ij}^{+}) - \\psi(T_0+h_T, \\epsilon_{ij}^{-}) - \\psi(T_0-h_T, \\epsilon_{ij}^{+}) + \\psi(T_0-h_T, \\epsilon_{ij}^{-}) \\right] $$\n$(\\partial s/\\partial\\epsilon_{ij})_T$的数值近似为：\n$$ \\frac{1}{4 h_T h_\\epsilon} \\left[ -\\psi(T_0+h_T, \\epsilon_{ij}^{+}) + \\psi(T_0-h_T, \\epsilon_{ij}^{+}) + \\psi(T_0+h_T, \\epsilon_{ij}^{-}) - \\psi(T_0-h_T, \\epsilon_{ij}^{-}) \\right] $$\n显而易见，第一个表达式是第二个表达式的负数。这证实了对于规定的数值格式，该Maxwell关系是依构造而成立的。因此，本练习变成了对正确实现的一种测试，以及对浮点舍入误差量级的观察。\n\n**步骤3：结论**\n\n问题是**有效的**。将构建一个解决方案。\n\n### 解决方案\n\n计算工作流始于按规定实现Helmholtz自由能密度函数$\\psi(T, \\epsilon_{ij})$。该函数是基础元素，所有其他量都从它数值推导得出。应变状态由其在二维空间中的三个独立分量表示：$\\epsilon_{11}$、$\\epsilon_{22}$和$\\epsilon_{12}$。\n\n任务的核心是为每个分量$(i,j)$计算两个量并进行比较。这些量是混合偏导数$\\frac{\\partial^2 \\psi}{\\partial T \\partial \\epsilon_{ij}}$和$\\frac{\\partial^2 \\psi}{\\partial \\epsilon_{ij} \\partial T}$的数值近似。\n\n1.  **计算$(\\partial\\sigma_{ij}/\\partial T)_{\\epsilon}$（我们称之为$Q_{A,ij}$）**：这通过规定的嵌套中心差分来执行。\n    *   首先，我们定义一个函数来近似$\\sigma_{ij}(T, \\epsilon^{(0)})$。问题指定使用中心差分法，对$\\psi$关于$\\epsilon_{ij}$分量求导，步长为$h_\\epsilon$。\n    *   然后，我们在另一个中心差分中使用这个$\\sigma_{ij}$的近似值，这次是关于温度$T$在$T_0$附近求导，步长为$h_T$，以获得$Q_{A,ij}$的最终值。\n\n2.  **计算$(\\partial s/\\partial\\epsilon_{ij})_T$（我们称之为$Q_{S,ij}$）**：这也通过嵌套中心差分来执行。\n    *   首先，我们定义一个函数来近似$s(T_0, \\epsilon)$。问题明确指出，这是通过对$\\psi$关于温度$T$在$T_0$附近使用中心差分来完成的，步长为$h_T$。\n    *   然后，我们将这个$s$的近似值用于关于应变分量$\\epsilon_{ij}$在$\\epsilon^{(0)}$附近的中心差分，步长为$h_\\epsilon$，以求得$Q_{S,ij}$。\n\nMaxwell关系规定$Q_{A,ij} = -Q_{S,ij}$，或者说$Q_{A,ij} + Q_{S,ij} = 0$。数值实现将评估这个恒等式。\n\n对于每个测试用例，流程如下：\n*   对于每个分量$\\epsilon_{11}$和$\\epsilon_{22}$（索引为$(1,1)$和$(2,2)$）：\n    *   在指定的基准状态$(T_0, \\epsilon^{(0)})$下，使用提供的增量$h_T$和$h_\\epsilon$计算$Q_{A,ij}$和$Q_{S,ij}$的数值。\n    *   计算分量级别的相对误差：\n        $$ \\text{err}_{ij} = \\frac{|Q_{A,ij} + Q_{S,ij}|}{\\max(1, |Q_{A,ij}|, |Q_{S,ij}|)} $$\n*   该测试用例的最终结果是这些分量误差中的最大值：$\\mathrm{rel\\_err} = \\max(\\text{err}_{11}, \\text{err}_{22})$。\n\n整个过程被封装在一个Python脚本中。所有物理常数和测试用例参数都是硬编码的。该实现使用`numpy`来处理应变分量，从而使代码整洁易读。最终输出格式化为一个浮点数列表，按顺序表示每个测试用例计算出的最大相对误差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs and validates a computational workflow to numerically verify a\n    Maxwell relation for a thermoelastic material.\n    \"\"\"\n\n    # --- Define Constants ---\n    LAMBDA = 60.0e9  # Pa\n    MU = 40.0e9      # Pa\n    ALPHA11 = 1.2e7  # Pa/K\n    ALPHA22 = 0.9e7  # Pa/K\n    A_CONST = 1.0e6      # Pa/K^2\n    D11 = 2.5e5      # Pa/K^2\n    D22 = 1.7e5      # Pa/K^2\n\n    # --- Helmholtz Free Energy Density Function ---\n    def psi(T, eps11, eps22, eps12):\n        \"\"\"\n        Calculates the Helmholtz free energy density psi(T, epsilon_ij).\n        \"\"\"\n        tr_eps = eps11 + eps22\n        \n        # Elastic part\n        psi_el = 0.5 * LAMBDA * tr_eps**2 + MU * (eps11**2 + eps22**2 + 2 * eps12**2)\n        \n        # Thermoelastic coupling part\n        psi_th = -T * (ALPHA11 * eps11 + ALPHA22 * eps22) \\\n                 + 0.5 * T**2 * (D11 * eps11 + D22 * eps22)\n\n        # Thermal part\n        psi_T = 0.5 * A_CONST * T**2\n        \n        return psi_el + psi_th + psi_T\n\n    def compute_max_relative_mismatch(T0, eps0, hT, h_eps):\n        \"\"\"\n        Computes the maximum relative mismatch for a given test case.\n        eps0 is expected as a numpy array [eps11, eps22, eps12].\n        \"\"\"\n        component_errors = []\n        \n        # Loop over components (1,1) and (2,2)\n        # component_index 0 - eps11, 1 - eps22\n        for component_index in [0, 1]:\n            # --- Route A: Calculate (d(sigma_ij)/dT)_epsilon ---\n            def sigma_ij_approx(T_eval, eps_eval_vec):\n                eps_plus = eps_eval_vec.copy()\n                eps_plus[component_index] += h_eps\n                eps_minus = eps_eval_vec.copy()\n                eps_minus[component_index] -= h_eps\n                \n                psi_plus = psi(T_eval, *eps_plus)\n                psi_minus = psi(T_eval, *eps_minus)\n                \n                return (psi_plus - psi_minus) / (2 * h_eps)\n\n            sigma_at_T_plus = sigma_ij_approx(T0 + hT, eps0)\n            sigma_at_T_minus = sigma_ij_approx(T0 - hT, eps0)\n            \n            # This is the numerical approximation of (d(sigma_ij)/dT)\n            q_A = (sigma_at_T_plus - sigma_at_T_minus) / (2 * hT)\n\n            # --- Calculation for (d(s)/d(epsilon_ij))_T ---\n            def s_approx(eps_eval_vec):\n                psi_at_T_plus = psi(T0 + hT, *eps_eval_vec)\n                psi_at_T_minus = psi(T0 - hT, *eps_eval_vec)\n                \n                return -(psi_at_T_plus - psi_at_T_minus) / (2 * hT)\n\n            eps_pert_plus = eps0.copy()\n            eps_pert_plus[component_index] += h_eps\n            eps_pert_minus = eps0.copy()\n            eps_pert_minus[component_index] -= h_eps\n\n            s_at_eps_plus = s_approx(eps_pert_plus)\n            s_at_eps_minus = s_approx(eps_pert_minus)\n            \n            # This is the numerical approximation of (d(s)/d(epsilon_ij))\n            q_S = (s_at_eps_plus - s_at_eps_minus) / (2 * h_eps)\n\n            # --- Calculate Relative Error for the component ---\n            # Maxwell relation: q_A = -q_S, so q_A + q_S should be zero\n            numerator = abs(q_A + q_S)\n            denominator = max(1.0, abs(q_A), abs(q_S))\n            \n            component_errors.append(numerator / denominator)\n            \n        return max(component_errors)\n\n    # --- Test Cases from the problem statement ---\n    test_cases = [\n        # Case A\n        {'T0': 300.0, 'eps0': np.array([1.0e-3, -2.0e-4, 5.0e-4]), 'hT': 1.0, 'h_eps': 1.0e-6},\n        # Case B\n        {'T0': 10.0, 'eps0': np.array([-4.0e-4, 3.0e-4, 0.0]), 'hT': 0.1, 'h_eps': 5.0e-7},\n        # Case C\n        {'T0': 1000.0, 'eps0': np.array([2.0e-3, -1.0e-3, 1.0e-4]), 'hT': 10.0, 'h_eps': 2.0e-5},\n        # Case D\n        {'T0': 1.0, 'eps0': np.array([1.0e-6, -1.0e-6, 0.0]), 'hT': 5.0, 'h_eps': 1.0e-8},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_max_relative_mismatch(case['T0'], case['eps0'], case['hT'], case['h_eps'])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2840379"}]}