{"hands_on_practices": [{"introduction": "从局域密度近似（LDA）到广义梯度近似（GGA）的跨越是提升密度泛函理论精度的关键一步。本练习提供了一个直接的解析计算，让您亲眼见证约化密度梯度 $s(\\mathbf{r})$ 如何为纯局域的LDA能量引入修正。通过这个实践，您将为诸如PBE这类GGA泛函的内在工作机制建立起具体而深入的直觉。[@problem_id:2821030]", "problem": "考虑一个与材料物理学中的凝胶表面模型相关的自旋非极化平面电子密度。电子密度仅依赖于垂直于表面的坐标 $x$，并在横向方向上的单位面积内是均匀的。该模型密度为\n$$\nn(x) \\;=\\; n_{0}\\,\\exp\\!\\big(-\\alpha\\,|x|\\big), \\quad \\alpha>0,\\; n_{0}>0,\n$$\n其中积分范围为 $x \\in (-\\infty,\\infty)$。在 Kohn-Sham 密度泛函理论的框架内进行计算，并仅关注交换贡献（忽略相关）。从以下基本要素出发：\n\n- 源自均匀电子气的局域密度近似 (LDA) 交换能量密度，表示为单位体积的能量 $e_{x}^{\\mathrm{LDA}}(n) = -C_{x}\\,n^{4/3}$，其中 $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$。\n- 用于交换的约化密度梯度，定义为 $s(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|}{2\\,k_{F}(\\mathbf{r})\\,n(\\mathbf{r})}$，其中对于自旋非极化体系，局域费米波矢为 $k_{F}(\\mathbf{r}) = \\big(3\\pi^{2}n(\\mathbf{r})\\big)^{1/3}$。\n- 与 Perdew–Burke–Ernzerhof (PBE) 类型的广义梯度近似 (GGA) 一致的针对交换的小 $s$ 二阶梯度展开，其中增强因子为 $F_{x}(s) \\approx 1 + \\mu\\, s^{2}$，$\\mu$ 是标准的 PBE 交换梯度系数。假设此二阶形式对于当前的模型密度是有效的。\n\n任务：\n1) 使用这些定义，用 $n(x)$ 和 $s(x)$ 表示 LDA 中的单位面积交换能 $E_{x}^{\\mathrm{LDA}}$，以及 PBE 形式所对应的二阶 GGA 修正项 $E_{x}^{\\mathrm{PBE}} - E_{x}^{\\mathrm{LDA}}$。\n2) 对于给定的 $n(x)$，精确计算所得积分，以获得单位面积上能量差\n$$\n\\Delta E_{x} \\;=\\; E_{x}^{\\mathrm{PBE}} - E_{x}^{\\mathrm{LDA}}\n$$\n的闭合形式解析表达式，该表达式是 $n_{0}$、$\\alpha$、$\\mu$ 和基本常数的函数。\n3) 用一到两句话简要解释 $s(x)$ 的空间依赖性如何控制此密度分布下 $\\Delta E_{x}$ 的符号和大小。\n\n请将您的最终答案表示为单位面积上 $\\Delta E_{x}$ 的单个闭合形式解析表达式。不要代入常数的数值。无需四舍五入。最终答案框中不要包含单位。", "solution": "该问题陈述已经过验证，被认为是科学上可靠、定义明确且客观的。它提出了在密度泛函理论框架内的一个标准理论计算，利用了已有的定义和一个有效的模型体系。因此，我们可以进行严格的求解推导。\n\n该问题要求计算在特定的一维电子密度分布下，广义梯度近似 (GGA) 与局域密度近似 (LDA) 交换能之间的差值。这些任务将按顺序解决。\n\n1) 首先，我们构建单位面积交换能的一般表达式。总交换能 $E_x$ 是交换能量密度 $e_x$ 的空间积分。对于一个密度为 $n(x)$ 且在横向单位面积上均匀的体系，这由一个对坐标 $x$ 的积分给出。\n\n单位面积上的 LDA 交换能 $E_{x}^{\\mathrm{LDA}}$ 通过对 LDA 交换能量密度 $e_{x}^{\\mathrm{LDA}}(n) = -C_{x}n^{4/3}$ 进行积分得到：\n$$\nE_{x}^{\\mathrm{LDA}} = \\int_{-\\infty}^{\\infty} e_{x}^{\\mathrm{LDA}}(n(x)) \\,dx = -C_{x} \\int_{-\\infty}^{\\infty} n(x)^{4/3} \\,dx\n$$\nGGA 交换能由 $E_{x}^{\\mathrm{GGA}} = \\int_{-\\infty}^{\\infty} e_{x}^{\\mathrm{LDA}}(n(x)) F_{x}(s(x)) \\,dx$ 给出。使用所提供的 PBE 类型增强因子的二阶展开式 $F_{x}(s) \\approx 1 + \\mu s^{2}$，相应的单位面积交换能 $E_{x}^{\\mathrm{PBE}}$ 变为：\n$$\nE_{x}^{\\mathrm{PBE}} = \\int_{-\\infty}^{\\infty} e_{x}^{\\mathrm{LDA}}(n(x)) \\left(1 + \\mu s(x)^{2}\\right) \\,dx\n$$\n因此，代表二阶梯度修正的差值 $\\Delta E_{x} = E_{x}^{\\mathrm{PBE}} - E_{x}^{\\mathrm{LDA}}$ 为：\n$$\n\\Delta E_{x} = \\int_{-\\infty}^{\\infty} \\left[ e_{x}^{\\mathrm{LDA}}(n(x))(1 + \\mu s(x)^{2}) - e_{x}^{\\mathrm{LDA}}(n(x)) \\right] \\,dx = \\mu \\int_{-\\infty}^{\\infty} e_{x}^{\\mathrm{LDA}}(n(x)) s(x)^{2} \\,dx\n$$\n代入 $e_{x}^{\\mathrm{LDA}}(n)$ 的表达式，我们得到所需的修正项表达式：\n$$\n\\Delta E_{x} = -\\mu C_{x} \\int_{-\\infty}^{\\infty} n(x)^{4/3} s(x)^{2} \\,dx\n$$\n\n2) 接下来，我们对给定的密度分布 $n(x) = n_{0}\\exp(-\\alpha|x|)$ 计算这个积分。第一步是计算约化密度梯度 $s(x)$。密度的梯度是 $\\nabla n(x) = \\frac{dn}{dx}\\mathbf{\\hat{x}}$。对于 $x \\neq 0$，导数为 $\\frac{dn}{dx} = -\\alpha \\, \\mathrm{sgn}(x) \\, n_{0}\\exp(-\\alpha|x|) = -\\alpha \\, \\mathrm{sgn}(x) \\, n(x)$。梯度的模为 $|\\nabla n(x)| = \\alpha n(x)$。\n\n约化梯度 $s(x)$ 定义为 $s(x) = \\frac{|\\nabla n(x)|}{2k_{F}(x)n(x)}$，其中 $k_{F}(x) = (3\\pi^{2}n(x))^{1/3}$。代入 $|\\nabla n(x)|$ 和 $k_{F}(x)$ 的表达式：\n$$\ns(x) = \\frac{\\alpha n(x)}{2\\left(3\\pi^{2}n(x)\\right)^{1/3}n(x)} = \\frac{\\alpha}{2(3\\pi^{2})^{1/3}n(x)^{1/3}}\n$$\n现在我们可以计算被积函数 $n(x)^{4/3} s(x)^{2}$：\n$$\nn(x)^{4/3} s(x)^{2} = n(x)^{4/3} \\left( \\frac{\\alpha}{2(3\\pi^{2})^{1/3}n(x)^{1/3}} \\right)^{2} = n(x)^{4/3} \\frac{\\alpha^{2}}{4(3\\pi^{2})^{2/3}n(x)^{2/3}} = \\frac{\\alpha^{2}}{4(3\\pi^{2})^{2/3}} n(x)^{2/3}\n$$\n将这个简化结果代入 $\\Delta E_{x}$ 的表达式中：\n$$\n\\Delta E_{x} = -\\mu C_{x} \\int_{-\\infty}^{\\infty} \\frac{\\alpha^{2}}{4(3\\pi^{2})^{2/3}} n(x)^{2/3} \\,dx = -\\frac{\\mu C_{x} \\alpha^{2}}{4(3\\pi^{2})^{2/3}} \\int_{-\\infty}^{\\infty} n(x)^{2/3} \\,dx\n$$\n现在我们计算剩下的积分。被积函数是偶函数，因此我们可以从 $0$ 积分到 $\\infty$，然后乘以 $2$。\n$$\n\\int_{-\\infty}^{\\infty} n(x)^{2/3} \\,dx = \\int_{-\\infty}^{\\infty} \\left(n_{0}\\exp(-\\alpha|x|)\\right)^{2/3} \\,dx = n_{0}^{2/3} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{2\\alpha|x|}{3}\\right) \\,dx\n$$\n$$\n= 2 n_{0}^{2/3} \\int_{0}^{\\infty} \\exp\\left(-\\frac{2\\alpha x}{3}\\right) \\,dx = 2 n_{0}^{2/3} \\left[ -\\frac{3}{2\\alpha} \\exp\\left(-\\frac{2\\alpha x}{3}\\right) \\right]_{0}^{\\infty} = 2 n_{0}^{2/3} \\left( 0 - \\left(-\\frac{3}{2\\alpha}\\right) \\right) = \\frac{3 n_{0}^{2/3}}{\\alpha}\n$$\n将此结果代回 $\\Delta E_{x}$ 的表达式中：\n$$\n\\Delta E_{x} = -\\frac{\\mu C_{x} \\alpha^{2}}{4(3\\pi^{2})^{2/3}} \\left( \\frac{3 n_{0}^{2/3}}{\\alpha} \\right) = -\\frac{3 \\mu C_{x} \\alpha n_{0}^{2/3}}{4(3\\pi^{2})^{2/3}}\n$$\n最后，我们代入常数 $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$ 的定义：\n$$\n\\Delta E_{x} = -\\frac{3 \\mu \\alpha n_{0}^{2/3}}{4(3\\pi^{2})^{2/3}} \\left( \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\right) = -\\frac{9 \\mu \\alpha n_{0}^{2/3}}{16(3\\pi^2)^{2/3}} \\frac{3^{1/3}}{\\pi^{1/3}}\n$$\n$$\n= -\\frac{9}{16} \\mu \\alpha n_{0}^{2/3} \\frac{3^{1/3}}{3^{2/3}\\pi^{4/3}\\pi^{1/3}} = -\\frac{9}{16} \\mu \\alpha n_{0}^{2/3} 3^{-1/3} \\pi^{-5/3}\n$$\n因为 $9 = 3^{2}$，我们有 $9 \\cdot 3^{-1/3} = 3^{2 - 1/3} = 3^{5/3}$。最终表达式为：\n$$\n\\Delta E_{x} = -\\frac{3^{5/3}}{16} \\mu \\alpha n_{0}^{2/3} \\pi^{-5/3} = -\\frac{\\mu \\alpha n_{0}^{2/3}}{16} \\left(\\frac{3}{\\pi}\\right)^{5/3}\n$$\n\n3) $\\Delta E_{x}$ 的符号和大小由被积函数 $\\mu s(x)^2 e_{x}^{\\mathrm{LDA}}(n(x))$ 控制。由于交换梯度系数 $\\mu$ 和 $s(x)^2$ 为正，而对于任何非零密度，LDA 能量密度 $e_{x}^{\\mathrm{LDA}}(n(x))$ 均为负，因此被积函数处处为负，导致能量修正 $\\Delta E_{x}$ 严格为负。局域贡献的大小取决于约化梯度 $s(x)$（它从中心向外呈指数增长）与密度 $n(x)$（它呈指数衰减）之间的竞争；对于此特定分布，它们的共同作用产生了一个与 $n(x)^{2/3}$ 成正比的被积函数，其对总能量的贡献在密度最大处（$x=0$）最大，并向两侧对称衰减。", "answer": "$$\n\\boxed{-\\frac{\\mu \\alpha n_{0}^{2/3}}{16} \\left(\\frac{3}{\\pi}\\right)^{5/3}}\n$$", "id": "2821030"}, {"introduction": "当DFT计算给出不准确的结果时，其根源是泛函本身对精确密度处理不佳，还是泛函在自洽过程中产生了有缺陷的密度？本练习介绍了一种强大的诊断技术，用以区分这两种误差来源——即泛函驱动误差和密度驱动误差。通过分析氯阴离子的电子亲和能，您将学会如何更精确地归因误差，这是任何DFT实践者都应具备的核心技能。[@problem_id:2821151]", "problem": "使用第一性原理定义，对一个固定的原子体系，在密度泛函理论中的多种交换关联近似下计算并分析电子亲和能。从以下基本基础出发：(i) Hohenberg–Kohn 定理断言，基态电子密度与所有基态可观测量之间存在一一对应的关系；(ii) 在 Kohn–Sham 密度泛函理论 (Kohn–Sham DFT) 中，总基态能量是电子密度的泛函，记作 $E[n]$；(iii) 电子亲和能定义为中性体系与其阴离子的基态能量之差。用 $\\mathrm{Cl}$ 表示含有 $N$ 个电子的中性氯原子，用 $\\mathrm{Cl}^{-}$ 表示含有 $N+1$ 个电子的氯阴离子。精确电子亲和能由下式给出\n$$\n\\mathrm{EA}_{\\mathrm{ref}} \\equiv E_{\\mathrm{ref}}(N) - E_{\\mathrm{ref}}(N+1),\n$$\n其中 $E_{\\mathrm{ref}}$ 表示相应电子数的参考总能量（例如，来自高精度方法）。\n\n在近似交换关联泛函的设定中，用 $E_{\\mathrm{approx}}[n]$ 表示近似能量泛函。该泛函的自洽（变分）密度 $n_{\\mathrm{scf}}$ 使 $E_{\\mathrm{approx}}[n]$ 最小化，从而得到自洽能量 $E_{\\mathrm{approx}}[n_{\\mathrm{scf}}(N)]$ 和 $E_{\\mathrm{approx}}[n_{\\mathrm{scf}}(N+1)]$。非自洽能量评估 $E_{\\mathrm{approx}}[n_{\\mathrm{ref}}]$ 使用一个固定的高质量参考密度 $n_{\\mathrm{ref}}$，而不是变分密度。定义相应的电子亲和能\n$$\n\\mathrm{EA}_{\\mathrm{scf}} \\equiv E_{\\mathrm{approx}}[n_{\\mathrm{scf}}(N)] - E_{\\mathrm{approx}}[n_{\\mathrm{scf}}(N+1)],\n\\quad\n\\mathrm{EA}_{\\mathrm{nscf}} \\equiv E_{\\mathrm{approx}}[n_{\\mathrm{ref}}(N)] - E_{\\mathrm{approx}}[n_{\\mathrm{ref}}(N+1)].\n$$\n\n将总电子亲和能误差、泛函驱动分量和密度驱动分量定义为\n$$\n\\Delta \\mathrm{EA}_{\\mathrm{total}} \\equiv \\mathrm{EA}_{\\mathrm{scf}} - \\mathrm{EA}_{\\mathrm{ref}},\n\\quad\n\\Delta \\mathrm{EA}_{\\mathrm{func}} \\equiv \\mathrm{EA}_{\\mathrm{nscf}} - \\mathrm{EA}_{\\mathrm{ref}},\n\\quad\n\\Delta \\mathrm{EA}_{\\mathrm{den}} \\equiv \\Delta \\mathrm{EA}_{\\mathrm{total}} - \\Delta \\mathrm{EA}_{\\mathrm{func}} = \\mathrm{EA}_{\\mathrm{scf}} - \\mathrm{EA}_{\\mathrm{nscf}}.\n$$\n使用以下标准：当且仅当 $|\\Delta \\mathrm{EA}_{\\mathrm{den}}| > |\\Delta \\mathrm{EA}_{\\mathrm{func}}|$ 时，电子亲和能误差是密度驱动的。\n\n实现一个程序，给定中性态和阴离子态在三种交换关联近似——局域密度近似 (LDA)、Perdew–Burke–Ernzerhof 广义梯度近似 (PBE) 和强约束和适当范数化 Meta-广义梯度近似 (SCAN)——下的自洽和非自洽总能量，计算氯阴离子的上述物理量，并对主要误差来源进行分类。\n\n所有能量均以电子伏特 (eV) 为单位。所有输出均以电子伏特 (eV) 表示，四舍五入到三位小数。不涉及角度。您的程序不得读取任何输入。它必须使用下面的固定测试套件。\n\n测试套件数据（所有能量单位均为电子伏特）：\n- 参考能量：$E_{\\mathrm{ref}}(N) = -1250.000$， $E_{\\mathrm{ref}}(N+1) = -1253.613$，所以 $\\mathrm{EA}_{\\mathrm{ref}} = 3.613$。\n- LDA:\n  - 自洽能量：$E_{\\mathrm{approx}}[n_{\\mathrm{scf}}](N) = -1248.600$， $E_{\\mathrm{approx}}[n_{\\mathrm{scf}}](N+1) = -1251.000$。\n  - 非自洽（参考密度）能量：$E_{\\mathrm{approx}}[n_{\\mathrm{ref}}](N) = -1248.700$， $E_{\\mathrm{approx}}[n_{\\mathrm{ref}}](N+1) = -1252.200$。\n- PBE:\n  - 自洽能量：$E_{\\mathrm{approx}}[n_{\\mathrm{scf}}](N) = -1249.500$， $E_{\\mathrm{approx}}[n_{\\mathrm{scf}}](N+1) = -1252.500$。\n  - 非自洽（参考密度）能量：$E_{\\mathrm{approx}}[n_{\\mathrm{ref}}](N) = -1249.600$， $E_{\\mathrm{approx}}[n_{\\mathrm{ref}}](N+1) = -1252.880$。\n- SCAN:\n  - 自洽能量：$E_{\\mathrm{approx}}[n_{\\mathrm{scf}}](N) = -1249.800$， $E_{\\mathrm{approx}}[n_{\\mathrm{scf}}](N+1) = -1253.390$。\n  - 非自洽（参考密度）能量：$E_{\\mathrm{approx}}[n_{\\mathrm{ref}}](N) = -1249.820$， $E_{\\mathrm{approx}}[n_{\\mathrm{ref}}](N+1) = -1253.420$。\n\n要实现的任务：\n1. 对于每种泛函 (LDA, PBE, SCAN)，计算 $\\mathrm{EA}_{\\mathrm{scf}}$、$\\mathrm{EA}_{\\mathrm{nscf}}$、$\\Delta \\mathrm{EA}_{\\mathrm{total}}$、$\\Delta \\mathrm{EA}_{\\mathrm{func}}$ 和 $\\Delta \\mathrm{EA}_{\\mathrm{den}}$（单位 eV），每个值都四舍五入到三位小数。\n2. 使用严格不等式 $|\\Delta \\mathrm{EA}_{\\mathrm{den}}| > |\\Delta \\mathrm{EA}_{\\mathrm{func}}|$ 对电子亲和能误差是否为密度驱动进行分类；为此分类输出一个布尔值。\n\n最终输出格式：\n生成单行输出，其中包含一个列表，该列表按 $[\\mathrm{LDA}, \\mathrm{PBE}, \\mathrm{SCAN}]$ 的顺序包含三个子列表。每个子列表必须为\n$\n[\\mathrm{EA}_{\\mathrm{scf}},\\ \\mathrm{EA}_{\\mathrm{nscf}},\\ \\Delta \\mathrm{EA}_{\\mathrm{total}},\\ \\Delta \\mathrm{EA}_{\\mathrm{func}},\\ \\Delta \\mathrm{EA}_{\\mathrm{den}},\\ \\text{density\\_driven}],\n$\n其中前五个条目是单位为 eV 的浮点数，四舍五入到三位小数，最后一个条目是如上定义的布尔值。例如，输出可能看起来像\n$\n[[x_1,x_2,x_3,x_4,x_5,\\mathrm{True}],[\\dots],[\\dots]].\n$", "solution": "该问题要求在密度泛函理论框架内，使用三种不同的交换关联泛函，计算和分析氯原子的电子亲和能。该分析涉及将电子亲和能的总误差分解为可归因于泛函近似和由此产生的电子密度的分量。\n\n提供的基本定义如下。参考电子亲和能为\n$$\n\\mathrm{EA}_{\\mathrm{ref}} = E_{\\mathrm{ref}}(N) - E_{\\mathrm{ref}}(N+1)\n$$\n其中 $E_{\\mathrm{ref}}(M)$ 是具有 $M$ 个电子的体系的精确总基态能量。中性氯原子 $\\mathrm{Cl}$ 的电子数为 $N$。\n\n对于一个近似泛函，定义了两种亲和能：\n1.  自洽电子亲和能 $\\mathrm{EA}_{\\mathrm{scf}}$，由总能量计算得出，该总能量是针对给定近似泛函通过对密度进行变分而最小化的：\n    $$\n    \\mathrm{EA}_{\\mathrm{scf}} = E_{\\mathrm{approx}}[n_{\\mathrm{scf}}(N)] - E_{\\mathrm{approx}}[n_{\\mathrm{scf}}(N+1)]\n    $$\n2.  非自洽电子亲和能 $\\mathrm{EA}_{\\mathrm{nscf}}$，通过在固定的高质量参考密度 $n_{\\mathrm{ref}}$ 上评估近似能量泛函来计算：\n    $$\n    \\mathrm{EA}_{\\mathrm{nscf}} = E_{\\mathrm{approx}}[n_{\\mathrm{ref}}(N)] - E_{\\mathrm{approx}}[n_{\\mathrm{ref}}(N+1)]\n    $$\n\n误差分量定义如下：\n-   总误差：$\\Delta \\mathrm{EA}_{\\mathrm{total}} = \\mathrm{EA}_{\\mathrm{scf}} - \\mathrm{EA}_{\\mathrm{ref}}$\n-   泛函驱动误差：$\\Delta \\mathrm{EA}_{\\mathrm{func}} = \\mathrm{EA}_{\\mathrm{nscf}} - \\mathrm{EA}_{\\mathrm{ref}}$\n-   密度驱动误差：$\\Delta \\mathrm{EA}_{\\mathrm{den}} = \\mathrm{EA}_{\\mathrm{scf}} - \\mathrm{EA}_{\\mathrm{nscf}}$\n\n从这些定义可以得出 $\\Delta \\mathrm{EA}_{\\mathrm{total}} = \\Delta \\mathrm{EA}_{\\mathrm{func}} + \\Delta \\mathrm{EA}_{\\mathrm{den}}$。如果密度驱动误差的绝对值超过泛函驱动误差的绝对值，即 $|\\Delta \\mathrm{EA}_{\\mathrm{den}}| > |\\Delta \\mathrm{EA}_{\\mathrm{func}}|$，则该误差被归类为密度驱动。\n\n我们被赋予了以下以电子伏特 ($\\mathrm{eV}$) 为单位的能量值：\n-   参考能量：$E_{\\mathrm{ref}}(N) = -1250.000\\ \\mathrm{eV}$，$E_{\\mathrm{ref}}(N+1) = -1253.613\\ \\mathrm{eV}$。\n-   LDA 能量：$E_{\\mathrm{scf}}(N) = -1248.600$，$E_{\\mathrm{scf}}(N+1) = -1251.000$；$E_{\\mathrm{nscf}}(N) = -1248.700$，$E_{\\mathrm{nscf}}(N+1) = -1252.200$。\n-   PBE 能量：$E_{\\mathrm{scf}}(N) = -1249.500$，$E_{\\mathrm{scf}}(N+1) = -1252.500$；$E_{\\mathrm{nscf}}(N) = -1249.600$，$E_{\\mathrm{nscf}}(N+1) = -1252.880$。\n-   SCAN 能量：$E_{\\mathrm{scf}}(N) = -1249.800$，$E_{\\mathrm{scf}}(N+1) = -1253.390$；$E_{\\mathrm{nscf}}(N) = -1249.820$，$E_{\\mathrm{nscf}}(N+1) = -1253.420$。\n\n首先，我们计算参考电子亲和能：\n$$\n\\mathrm{EA}_{\\mathrm{ref}} = (-1250.000\\ \\mathrm{eV}) - (-1253.613\\ \\mathrm{eV}) = 3.613\\ \\mathrm{eV}\n$$\n\n现在，我们对每种泛函进行分析。\n\n**1. 局域密度近似 (LDA)**\n-   自洽电子亲和能：\n    $$\n    \\mathrm{EA}_{\\mathrm{scf, LDA}} = (-1248.600\\ \\mathrm{eV}) - (-1251.000\\ \\mathrm{eV}) = 2.400\\ \\mathrm{eV}\n    $$\n-   非自洽电子亲和能：\n    $$\n    \\mathrm{EA}_{\\mathrm{nscf, LDA}} = (-1248.700\\ \\mathrm{eV}) - (-1252.200\\ \\mathrm{eV}) = 3.500\\ \\mathrm{eV}\n    $$\n-   误差分量：\n    $$\n    \\Delta \\mathrm{EA}_{\\mathrm{total, LDA}} = 2.400 - 3.613 = -1.213\\ \\mathrm{eV} \\\\\n    \\Delta \\mathrm{EA}_{\\mathrm{func, LDA}} = 3.500 - 3.613 = -0.113\\ \\mathrm{eV} \\\\\n    \\Delta \\mathrm{EA}_{\\mathrm{den, LDA}} = 2.400 - 3.500 = -1.100\\ \\mathrm{eV}\n    $$\n-   分类：我们比较 $|\\Delta \\mathrm{EA}_{\\mathrm{den, LDA}}| = |-1.100| = 1.100$ 和 $|\\Delta \\mathrm{EA}_{\\mathrm{func, LDA}}| = |-0.113| = 0.113$。由于 $1.100 > 0.113$，LDA 的误差是**密度驱动**的。\n\n**2. Perdew–Burke–Ernzerhof (PBE) 广义梯度近似 (GGA)**\n-   自洽电子亲和能：\n    $$\n    \\mathrm{EA}_{\\mathrm{scf, PBE}} = (-1249.500\\ \\mathrm{eV}) - (-1252.500\\ \\mathrm{eV}) = 3.000\\ \\mathrm{eV}\n    $$\n-   非自洽电子亲和能：\n    $$\n    \\mathrm{EA}_{\\mathrm{nscf, PBE}} = (-1249.600\\ \\mathrm{eV}) - (-1252.880\\ \\mathrm{eV}) = 3.280\\ \\mathrm{eV}\n    $$\n-   误差分量：\n    $$\n    \\Delta \\mathrm{EA}_{\\mathrm{total, PBE}} = 3.000 - 3.613 = -0.613\\ \\mathrm{eV} \\\\\n    \\Delta \\mathrm{EA}_{\\mathrm{func, PBE}} = 3.280 - 3.613 = -0.333\\ \\mathrm{eV} \\\\\n    \\Delta \\mathrm{EA}_{\\mathrm{den, PBE}} = 3.000 - 3.280 = -0.280\\ \\mathrm{eV}\n    $$\n-   分类：我们比较 $|\\Delta \\mathrm{EA}_{\\mathrm{den, PBE}}| = |-0.280| = 0.280$ 和 $|\\Delta \\mathrm{EA}_{\\mathrm{func, PBE}}| = |-0.333| = 0.333$。由于 $0.280 \\ngtr 0.333$，PBE 的误差**不是**密度驱动的；它是泛函驱动的。\n\n**3. 强约束和适当范数化 (SCAN) Meta-GGA**\n-   自洽电子亲和能：\n    $$\n    \\mathrm{EA}_{\\mathrm{scf, SCAN}} = (-1249.800\\ \\mathrm{eV}) - (-1253.390\\ \\mathrm{eV}) = 3.590\\ \\mathrm{eV}\n    $$\n-   非自洽电子亲和能：\n    $$\n    \\mathrm{EA}_{\\mathrm{nscf, SCAN}} = (-1249.820\\ \\mathrm{eV}) - (-1253.420\\ \\mathrm{eV}) = 3.600\\ \\mathrm{eV}\n    $$\n-   误差分量：\n    $$\n    \\Delta \\mathrm{EA}_{\\mathrm{total, SCAN}} = 3.590 - 3.613 = -0.023\\ \\mathrm{eV} \\\\\n    \\Delta \\mathrm{EA}_{\\mathrm{func, SCAN}} = 3.600 - 3.613 = -0.013\\ \\mathrm{eV} \\\\\n    \\Delta \\mathrm{EA}_{\\mathrm{den, SCAN}} = 3.590 - 3.600 = -0.010\\ \\mathrm{eV}\n    $$\n-   分类：我们比较 $|\\Delta \\mathrm{EA}_{\\mathrm{den, SCAN}}| = |-0.010| = 0.010$ 和 $|\\Delta \\mathrm{EA}_{\\mathrm{func, SCAN}}| = |-0.013| = 0.013$。由于 $0.010 \\ngtr 0.013$，SCAN 的误差**不是**密度驱动的；它是泛函驱动的。\n\n以下程序实现了这些计算，并以指定格式提供输出。结果必须四舍五入到三位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes electron affinities and error components for different DFT functionals.\n    \"\"\"\n    # Reference energies in eV.\n    E_ref_N = -1250.000\n    E_ref_N1 = -1253.613\n\n    # Test suite data: (name, E_scf(N), E_scf(N+1), E_nscf(N), E_nscf(N+1))\n    test_cases = [\n        (\"LDA\", -1248.600, -1251.000, -1248.700, -1252.200),\n        (\"PBE\", -1249.500, -1252.500, -1249.600, -1252.880),\n        (\"SCAN\", -1249.800, -1253.390, -1249.820, -1253.420),\n    ]\n\n    # Calculate the reference electron affinity.\n    EA_ref = E_ref_N - E_ref_N1\n\n    all_results = []\n    for name, e_scf_n, e_scf_n1, e_nscf_n, e_nscf_n1 in test_cases:\n        # Calculate self-consistent and non-self-consistent electron affinities.\n        EA_scf = e_scf_n - e_scf_n1\n        EA_nscf = e_nscf_n - e_nscf_n1\n\n        # Calculate the error components.\n        Delta_EA_total = EA_scf - EA_ref\n        Delta_EA_func = EA_nscf - EA_ref\n        Delta_EA_den = EA_scf - EA_nscf\n\n        # Classify the error source.\n        is_density_driven = abs(Delta_EA_den) > abs(Delta_EA_func)\n\n        # Store the results for this functional.\n        sublist = [\n            EA_scf,\n            EA_nscf,\n            Delta_EA_total,\n            Delta_EA_func,\n            Delta_EA_den,\n            is_density_driven\n        ]\n        all_results.append(sublist)\n\n    # Format the final output string to match the problem specification exactly.\n    # The format is a list of lists, with no spaces and floats formatted to 3 decimal places.\n    sublist_strs = []\n    for sublist in all_results:\n        item_strs = []\n        # First 5 elements are floats and must be formatted to 3 decimal places.\n        for i in range(5):\n            item_strs.append(f\"{sublist[i]:.3f}\")\n        # The last element is a boolean.\n        item_strs.append(str(sublist[5]))\n        \n        sublist_strs.append(f\"[{','.join(item_strs)}]\")\n    \n    final_output_str = f\"[{','.join(sublist_strs)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_str)\n\nsolve()\n```", "id": "2821151"}]}