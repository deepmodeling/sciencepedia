{"hands_on_practices": [{"introduction": "自旋-轨道耦合 (SOC) 是一种重要的相对论效应，它在理解半导体能带结构和探索自旋电子学等前沿领域中扮演着核心角色。本练习 [@problem_id:2846766] 将引导您运用简并微扰理论，计算由 SOC 引起的 $p$ 轨道能级劈裂。这个实践的核心在于展示一个关键技巧：通过选择能够使微扰哈密顿量对角化的“好”基矢（即总角动量 $\\mathbf{J}$ 的本征态），可以将一个看似复杂的 $6 \\times 6$ 矩阵对角化问题，转化为一个简洁的本征值计算。", "problem": "考虑一个立方半导体，其布里渊区中心的价带边态可以很好地近似为轨道角动量 $l=1$ 和电子自旋 $s=\\frac{1}{2}$ 的类原子 $p$ 轨道。忽略晶体场各向异性及其他相互作用，未受扰动的哈密顿量 $H_{0}$ 在此流形内是球对称的，并在能量为 $E_{p}$ 处产生一个六重简并，对应于基矢 $\\{|l=1,m_{l}\\rangle\\otimes|s=\\frac{1}{2},m_{s}\\rangle\\}$，其中 $m_{l}\\in\\{-1,0,1\\}$ 且 $m_{s}\\in\\{-\\frac{1}{2},\\frac{1}{2}\\}$。现在引入自旋轨道耦合 (SOC) 作为弱微扰\n$$\nH' \\;=\\; \\lambda\\,\\frac{\\mathbf{L}\\cdot\\mathbf{S}}{\\hbar^{2}},\n$$\n其中 $\\mathbf{L}$ 和 $\\mathbf{S}$ 分别是轨道角动量算符和自旋角动量算符，$\\hbar$ 是约化普朗克常数，而 $\\lambda$ 是一个具有能量单位、与材料相关的常数。假设 $H_{0}$ 的六重简并是严格的，并且 $|\\lambda|$ 相对于与其他能带的间隔而言很小，因此一阶简并微扰理论适用于此六维子空间。\n\n仅从角动量相加、算符对易关系的基本定义以及一阶简并微扰理论的原理出发，确定由耦合 $\\mathbf{J}=\\mathbf{L}+\\mathbf{S}$ 产生的总角动量多重态之间，由 $H'$ 引起的一阶能量分裂 $\\Delta E \\equiv E_{J=\\frac{3}{2}} - E_{J=\\frac{1}{2}}$。将您的最终答案表示为仅含 $\\lambda$ 的单一闭式解析表达式。能量以电子伏特 (eV) 为单位表示，并设 $\\lambda$ 的单位也为电子伏特。无需进行数值舍入。", "solution": "该问题要求确定一个六重简并电子能级在自旋轨道耦合影响下的能量分裂，其中自旋轨道耦合被视为微扰。未受扰动的系统由类原子 $p$ 轨道表征，其轨道角动量量子数为 $l=1$。电子的自旋为 $s=\\frac{1}{2}$。未受扰动的简并子空间由非耦合基矢中的 $2(2l+1) = 2(2 \\cdot 1+1)=6$ 个态张成，即 $\\{|l, m_l\\rangle \\otimes |s, m_s\\rangle\\}$，其中 $l=1$，$s=\\frac{1}{2}$，$m_l \\in \\{-1, 0, 1\\}$，$m_s \\in \\{-\\frac{1}{2}, \\frac{1}{2}\\}$。所有这些态都具有相同的未受扰动能量 $E_p$。\n\n微扰是自旋轨道哈密顿量 $H' = \\lambda \\frac{\\mathbf{L}\\cdot\\mathbf{S}}{\\hbar^2}$。为求得一阶能量修正，我们必须应用简并微扰理论。这需要将微扰哈密顿量在简并子空间内对角化。能量修正即为 $H'$ 在此子空间中 $6 \\times 6$ 矩阵表示的本征值。\n\n一个更直接的方法是找到一个能够直接将 $H'$ 对角化的基矢。算符 $\\mathbf{L}\\cdot\\mathbf{S}$ 与总角动量的平方 $J^2$ 及其在 $z$ 轴上的投影 $J_z$ 对易，其中 $\\mathbf{J} = \\mathbf{L} + \\mathbf{S}$。这是因为 $J^2$ 和 $J_z$ 是由 $\\mathbf{L}$ 和 $\\mathbf{S}$ 的分量构成的，而 $\\mathbf{L} \\cdot \\mathbf{S}$ 是一个在轨道和自旋空间同时旋转下的标量不变量。因此，在 $J^2$ 和 $J_z$ 的共同本征态基矢中，$H'$ 是对角的。这个基矢被称为耦合基矢，记为 $|j, m_j, l, s\\rangle$。\n\n我们首先通过耦合 $l=1$ 和 $s=\\frac{1}{2}$ 来确定总角动量量子数 $j$ 的可能取值。根据角动量相加法则，$j$ 的取值范围为 $|l-s| \\le j \\le l+s$。对于给定的值：\n$$\n|1 - \\frac{1}{2}| \\le j \\le 1 + \\frac{1}{2}\n$$\n$$\n\\frac{1}{2} \\le j \\le \\frac{3}{2}\n$$\n因此，$j$ 的可能取值为 $j=\\frac{1}{2}$ 和 $j=\\frac{3}{2}$。这对应于两个不同的多重态。原来的六重简并能级分裂为：\n一个 $j=\\frac{3}{2}$ 的多重态，其简并度为 $2j+1 = 2(\\frac{3}{2})+1=4$。\n一个 $j=\\frac{1}{2}$ 的多重态，其简并度为 $2j+1 = 2(\\frac{1}{2})+1=2$。\n总态数 $4+2=6$ 保持守恒。\n\n利用从 $J^2 = (\\mathbf{L}+\\mathbf{S})^2 = L^2+S^2+2\\mathbf{L}\\cdot\\mathbf{S}$ 导出的恒等式，算符 $\\mathbf{L}\\cdot\\mathbf{S}$ 可以用总角动量、轨道角动量和自旋角动量算符表示：\n$$\n\\mathbf{L}\\cdot\\mathbf{S} = \\frac{1}{2} (J^2 - L^2 - S^2)\n$$\n对于特定 $j$ 多重态内的态，其一阶能量修正 $\\Delta E_j^{(1)}$ 是 $H'$ 对于这些态的本征值。由于态 $|j, m_j, l, s\\rangle$ 是 $J^2$、$L^2$ 和 $S^2$ 的本征态，计算过程非常直接：\n$$\n\\Delta E_j^{(1)} = \\langle j, m_j | H' | j, m_j \\rangle = \\frac{\\lambda}{\\hbar^2} \\langle j, m_j | \\frac{1}{2} (J^2 - L^2 - S^2) | j, m_j \\rangle\n$$\n$J^2$、$L^2$ 和 $S^2$ 的本征值分别为 $\\hbar^2 j(j+1)$、$\\hbar^2 l(l+1)$ 和 $\\hbar^2 s(s+1)$。因此，能量移动为：\n$$\n\\Delta E_j^{(1)} = \\frac{\\lambda}{2\\hbar^2} \\left[ \\hbar^2 j(j+1) - \\hbar^2 l(l+1) - \\hbar^2 s(s+1) \\right] = \\frac{\\lambda}{2} \\left[ j(j+1) - l(l+1) - s(s+1) \\right]\n$$\n该修正与 $m_j$ 无关，因此给定 $j$ 多重态内的所有态都移动相同的能量。现在我们代入已知的量子数：$l=1$ 和 $s=\\frac{1}{2}$。这给出 $l(l+1)=1(2)=2$ 和 $s(s+1)=\\frac{1}{2}(\\frac{3}{2})=\\frac{3}{4}$。\n\n对于 $j=\\frac{3}{2}$ 多重态：\n$j(j+1) = \\frac{3}{2}(\\frac{5}{2}) = \\frac{15}{4}$。\n能量修正是：\n$$\n\\Delta E_{j=3/2}^{(1)} = \\frac{\\lambda}{2} \\left[ \\frac{15}{4} - 2 - \\frac{3}{4} \\right] = \\frac{\\lambda}{2} \\left[ \\frac{12}{4} - 2 \\right] = \\frac{\\lambda}{2} [3-2] = \\frac{\\lambda}{2}\n$$\n该能级的能量为 $E_{J=3/2} = E_p + \\frac{\\lambda}{2}$。\n\n对于 $j=\\frac{1}{2}$ 多重态：\n$j(j+1) = \\frac{1}{2}(\\frac{3}{2}) = \\frac{3}{4}$。\n能量修正是：\n$$\n\\Delta E_{j=1/2}^{(1)} = \\frac{\\lambda}{2} \\left[ \\frac{3}{4} - 2 - \\frac{3}{4} \\right] = \\frac{\\lambda}{2} [-2] = -\\lambda\n$$\n该能级的能量为 $E_{J=1/2} = E_p - \\lambda$。\n\n问题要求的是能量分裂 $\\Delta E$，定义为 $\\Delta E \\equiv E_{J=\\frac{3}{2}} - E_{J=\\frac{1}{2}}$。\n$$\n\\Delta E = \\left( E_p + \\frac{\\lambda}{2} \\right) - \\left( E_p - \\lambda \\right) = \\frac{\\lambda}{2} - (-\\lambda) = \\frac{3}{2}\\lambda\n$$\n最终结果仅用与材料相关的参数 $\\lambda$ 表示。", "answer": "$$\n\\boxed{\\frac{3}{2}\\lambda}\n$$", "id": "2846766"}, {"introduction": "晶格振动通常在简谐近似下进行描述，但这忽略了导致热膨胀和有限声子寿命等重要物理现象的非谐效应。本练习 [@problem_id:2846758] 旨在通过一个简化的爱因斯坦模型，让您实践如何使用二阶微扰理论来量化由三次非谐项引起的声子频率移动。通过这个计算，您将熟练掌握在微扰理论框架下运用梯形算符处理声子等玻色子系统的技巧，这是凝聚态理论中的一项基本功。", "problem": "考虑一个无色散的单光学声子模式（爱因斯坦模型），其质量为 $M$，谐振频率为 $\\omega$，由哈密顿量\n$$\nH_{0}=\\frac{p^{2}}{2M}+\\frac{1}{2}M\\omega^{2}x^{2},\n$$\n描述，并受到一个弱三次非谐微扰\n$$\nV=\\frac{\\alpha}{3!}\\,x^{3},\n$$\n其中 $\\alpha$ 是一个实数参数，其量纲为能量每位移的立方。在零温下，通过第一激发态与基态之间能级间距的变化来模拟由非谐性引起的声子频率重整化，即，将重整化频率 $\\omega+\\Delta\\omega$ 定义为\n$$\n\\hbar(\\omega+\\Delta\\omega)=\\left[E_{1}^{(0)}+E_{1}^{(\\mathrm{anh})}\\right]-\\left[E_{0}^{(0)}+E_{0}^{(\\mathrm{anh})}\\right],\n$$\n其中 $E_{n}^{(0)}$ 是未受微扰的能量，$E_{n}^{(\\mathrm{anh})}$ 是由 $V$ 引起的修正。使用不含时微扰论，计算到 $\\alpha$ 的二阶，求出频率移动 $\\Delta\\omega$ 关于 $\\alpha$、$M$、$\\omega$ 和 $\\hbar$ 的首个非零表达式。假设谐振子采用标准的正则量子化，并计算到 $\\mathcal{O}(\\alpha^{2})$ 阶。将你的最终答案 $\\Delta\\omega$ 以弧度/秒表示。不要代入任何数值，并给出一个单一的闭合形式解析表达式。", "solution": "该问题要求计算一个受到弱三次非谐微扰的爱因斯坦声子模式的频率移动 $\\Delta\\omega$。该移动由第一激发态与基态之间能隙的变化来定义。我们将使用不含时微扰论，计算到微扰参数 $\\alpha$ 的二阶。\n\n未受微扰的系统是一个一维量子谐振子，其哈密顿量为 $H_{0}=\\frac{p^{2}}{2M}+\\frac{1}{2}M\\omega^{2}x^{2}$。其能量本征值为 $E_{n}^{(0)} = \\hbar\\omega(n + \\frac{1}{2})$，其中 $n=0, 1, 2, \\dots$。微扰由 $V=\\frac{\\alpha}{3!}\\,x^{3} = \\frac{\\alpha}{6}x^3$ 给出。\n\n在升降算符的形式下，位置算符 $x$ 表示为 $x = \\sqrt{\\frac{\\hbar}{2M\\omega}}(a + a^{\\dagger})$，其中 $a$ 和 $a^{\\dagger}$ 分别是湮灭算符和产生算符。它们作用在能量本征态 $|n\\rangle$ 上，其结果为 $a|n\\rangle = \\sqrt{n}|n-1\\rangle$ 和 $a^{\\dagger}|n\\rangle = \\sqrt{n+1}|n+1\\rangle$。\n\n受微扰修正后的本征态 $|n\\rangle$ 的总能量为 $E_n = E_n^{(0)} + E_n^{(1)} + E_n^{(2)} + \\mathcal{O}(\\alpha^3)$，其中 $E_n^{(k)}$ 是 $k$ 阶能量修正。一阶修正由微扰在未受微扰态中的期望值给出：$E_n^{(1)} = \\langle n | V | n \\rangle = \\frac{\\alpha}{6}\\langle n | x^3 | n \\rangle$。与本征态 $|n\\rangle$ 对应的波函数具有确定的宇称，对于偶数 $n$ 是偶宇称，对于奇数 $n$ 是奇宇称。算符 $x^3$ 是一个奇宇称算符。在一个具有确定宇称的态中，一个奇宇称算符的期望值恒为零。因此，所有态的一阶能量修正都为零：$E_{n}^{(1)} = 0$。\n\n对能量移动的首个非零贡献将来自二阶修正，其公式为：\n$$\nE_{n}^{(2)} = \\sum_{m \\neq n} \\frac{|\\langle m | V | n \\rangle|^2}{E_{n}^{(0)} - E_{m}^{(0)}}\n$$\n问题通过关系式 $\\hbar(\\omega+\\Delta\\omega)=\\left[E_{1}^{(0)}+E_{1}^{(\\mathrm{anh})}\\right]-\\left[E_{0}^{(0)}+E_{0}^{(\\mathrm{anh})}\\right]$ 来定义重整化频率 $\\omega + \\Delta\\omega$。由于一阶修正为零，所以 $E_n^{(\\mathrm{anh})} \\approx E_n^{(2)}$。未受微扰的能级间距为 $E_1^{(0)} - E_0^{(0)} = \\hbar\\omega$。因此，我们有 $\\hbar\\omega + \\hbar\\Delta\\omega = \\hbar\\omega + (E_1^{(2)} - E_0^{(2)})$，可简化为 $\\hbar\\Delta\\omega = E_1^{(2)} - E_0^{(2)}$。\n\n我们必须计算基态（$n=0$）和第一激发态（$n=1$）的二阶能量修正。这需要微扰 $V = \\frac{\\alpha}{6}x^3$ 的矩阵元。让我们定义常数 $C = \\sqrt{\\frac{\\hbar}{2M\\omega}}$，于是 $x = C(a+a^{\\dagger})$。算符 $x^3$ 将态 $|n\\rangle$ 连接到态 $|n\\pm 1\\rangle$ 和 $|n\\pm 3\\rangle$。\n\n首先，我们计算基态 $|0\\rangle$ 所需的矩阵元。我们计算 $x^3$ 对 $|0\\rangle$ 的作用：\n$$\nx^3|0\\rangle = C^3 (a+a^{\\dagger})^3 |0\\rangle = C^3 (a+a^{\\dagger}) (a+a^{\\dagger}) (a+a^{\\dagger})|0\\rangle\n$$\n$$\nx|0\\rangle = C a^{\\dagger}|0\\rangle = C|1\\rangle\n$$\n$$\nx^2|0\\rangle = C^2(a+a^{\\dagger})|1\\rangle = C^2(a|1\\rangle + a^{\\dagger}|1\\rangle) = C^2(|0\\rangle + \\sqrt{2}|2\\rangle)\n$$\n$$\nx^3|0\\rangle = C^3(a+a^{\\dagger})(|0\\rangle + \\sqrt{2}|2\\rangle) = C^3(a^{\\dagger}|0\\rangle + \\sqrt{2}a|2\\rangle + \\sqrt{2}a^{\\dagger}|2\\rangle) = C^3(|1\\rangle + 2|1\\rangle + \\sqrt{6}|3\\rangle) = C^3(3|1\\rangle + \\sqrt{6}|3\\rangle)\n$$\n从基态出发的 $x^3$ 的非零矩阵元为 $\\langle 1 | x^3 | 0 \\rangle = 3C^3$ 和 $\\langle 3 | x^3 | 0 \\rangle = \\sqrt{6}C^3$。\n\n基态能量的二阶修正是：\n$$\nE_{0}^{(2)} = \\frac{|\\langle 1 | V | 0 \\rangle|^2}{E_{0}^{(0)} - E_{1}^{(0)}} + \\frac{|\\langle 3 | V | 0 \\rangle|^2}{E_{0}^{(0)} - E_{3}^{(0)}}\n$$\n由于 $E_n^{(0)} - E_m^{(0)} = (n-m)\\hbar\\omega$，上式变为：\n$$\nE_{0}^{(2)} = \\left(\\frac{\\alpha}{6}\\right)^2 \\left( \\frac{|\\langle 1 | x^3 | 0 \\rangle|^2}{-\\hbar\\omega} + \\frac{|\\langle 3 | x^3 | 0 \\rangle|^2}{-3\\hbar\\omega} \\right) = \\frac{\\alpha^2}{36} \\left( \\frac{(3C^3)^2}{-\\hbar\\omega} + \\frac{(\\sqrt{6}C^3)^2}{-3\\hbar\\omega} \\right)\n$$\n$$\nE_{0}^{(2)} = \\frac{\\alpha^2 C^6}{36} \\left( -\\frac{9}{\\hbar\\omega} - \\frac{6}{3\\hbar\\omega} \\right) = \\frac{\\alpha^2 C^6}{36\\hbar\\omega} (-9 - 2) = -\\frac{11\\alpha^2 C^6}{36\\hbar\\omega}\n$$\n\n接下来，我们计算第一激发态 $|1\\rangle$ 的矩阵元。我们计算 $x^3|1\\rangle$：\n$$\nx|1\\rangle = C(a+a^{\\dagger})|1\\rangle = C(|0\\rangle + \\sqrt{2}|2\\rangle)\n$$\n$$\nx^2|1\\rangle = C^2(a+a^{\\dagger})(|0\\rangle + \\sqrt{2}|2\\rangle) = C^2(a^{\\dagger}|0\\rangle + \\sqrt{2}a|2\\rangle + \\sqrt{2}a^{\\dagger}|2\\rangle) = C^2(|1\\rangle + 2|1\\rangle + \\sqrt{6}|3\\rangle) = C^2(3|1\\rangle + \\sqrt{6}|3\\rangle)\n$$\n$$\nx^3|1\\rangle = C^3(a+a^{\\dagger})(3|1\\rangle + \\sqrt{6}|3\\rangle) = C^3(3a|1\\rangle + 3a^{\\dagger}|1\\rangle + \\sqrt{6}a|3\\rangle + \\sqrt{6}a^{\\dagger}|3\\rangle)\n$$\n$$\nx^3|1\\rangle = C^3(3|0\\rangle + 3\\sqrt{2}|2\\rangle + \\sqrt{18}|2\\rangle + \\sqrt{24}|4\\rangle) = C^3(3|0\\rangle + 6\\sqrt{2}|2\\rangle + 2\\sqrt{6}|4\\rangle)\n$$\n非零矩阵元为 $\\langle 0 | x^3 | 1 \\rangle = 3C^3$、$\\langle 2 | x^3 | 1 \\rangle = 6\\sqrt{2}C^3$ 和 $\\langle 4 | x^3 | 1 \\rangle = 2\\sqrt{6}C^3$。\n\n第一激发态能量的二阶修正是：\n$$\nE_{1}^{(2)} = \\frac{|\\langle 0 | V | 1 \\rangle|^2}{E_{1}^{(0)} - E_{0}^{(0)}} + \\frac{|\\langle 2 | V | 1 \\rangle|^2}{E_{1}^{(0)} - E_{2}^{(0)}} + \\frac{|\\langle 4 | V | 1 \\rangle|^2}{E_{1}^{(0)} - E_{4}^{(0)}}\n$$\n$$\nE_{1}^{(2)} = \\left(\\frac{\\alpha}{6}\\right)^2 \\left( \\frac{|\\langle 0 | x^3 | 1 \\rangle|^2}{\\hbar\\omega} + \\frac{|\\langle 2 | x^3 | 1 \\rangle|^2}{-\\hbar\\omega} + \\frac{|\\langle 4 | x^3 | 1 \\rangle|^2}{-3\\hbar\\omega} \\right)\n$$\n$$\nE_{1}^{(2)} = \\frac{\\alpha^2}{36} \\left( \\frac{(3C^3)^2}{\\hbar\\omega} - \\frac{(6\\sqrt{2}C^3)^2}{\\hbar\\omega} - \\frac{(2\\sqrt{6}C^3)^2}{3\\hbar\\omega} \\right) = \\frac{\\alpha^2 C^6}{36\\hbar\\omega} \\left( 9 - 72 - \\frac{24}{3} \\right)\n$$\n$$\nE_{1}^{(2)} = \\frac{\\alpha^2 C^6}{36\\hbar\\omega} (9 - 72 - 8) = -\\frac{71\\alpha^2 C^6}{36\\hbar\\omega}\n$$\n\n现在我们计算频率移动 $\\Delta\\omega$：\n$$\n\\hbar\\Delta\\omega = E_1^{(2)} - E_0^{(2)} = \\left(-\\frac{71\\alpha^2 C^6}{36\\hbar\\omega}\\right) - \\left(-\\frac{11\\alpha^2 C^6}{36\\hbar\\omega}\\right) = \\frac{(-71+11)\\alpha^2 C^6}{36\\hbar\\omega} = -\\frac{60\\alpha^2 C^6}{36\\hbar\\omega} = -\\frac{5\\alpha^2 C^6}{3\\hbar\\omega}\n$$\n最后，我们代入 $C^6 = \\left(\\frac{\\hbar}{2M\\omega}\\right)^3 = \\frac{\\hbar^3}{8M^3\\omega^3}$：\n$$\n\\hbar\\Delta\\omega = -\\frac{5\\alpha^2}{3\\hbar\\omega} \\left(\\frac{\\hbar^3}{8M^3\\omega^3}\\right) = -\\frac{5\\alpha^2\\hbar^2}{24M^3\\omega^4}\n$$\n两边除以 $\\hbar$ 得到频率移动：\n$$\n\\Delta\\omega = -\\frac{5\\alpha^2\\hbar}{24M^3\\omega^4}\n$$\n这是由三次非谐性引起的声子频率的首个非零修正，在 $\\mathcal{O}(\\alpha^2)$ 阶内有效。负号表示非谐性通过降低声子模式的频率来使其软化。", "answer": "$$\n\\boxed{-\\frac{5\\alpha^{2}\\hbar}{24M^{3}\\omega^{4}}}\n$$", "id": "2846758"}, {"introduction": "虽然密度泛函理论 (DFT) 是计算材料电子性质的强大工具，但它通常低估了材料的带隙。多体微扰理论，特别是 GW 近似，为修正这些系统性偏差提供了坚实的理论框架。本练习 [@problem_id:2846767] 将带您从理论推导走向实践计算，通过对戴森方程进行线性化来求解准粒子能量。这项实践不仅能让您理解如何将复杂的理论（如格林函数和自能）转化为可行的计算方案，还能帮助您深入领会准粒子重整化因子 $Z$ 等核心概念的物理意义。", "problem": "考虑一个晶体固体中的单电子布洛赫态，其初始状态由密度泛函理论（DFT）的 Kohn–Sham（KS）本征值描述。在多体微扰理论中，准粒子（QP）能量被定义为相互作用格林函数的极点，该极点通过求解带有自能算符的 Dyson 方程得到。在格林函数乘以屏蔽库仑相互作用（GW）近似中，电子自能近似为单粒子格林函数与动态屏蔽库仑相互作用的乘积。对于一个给定的态，当自能的虚部在极点附近被忽略时，Dyson 方程简化为关于实部准粒子能量 $E$ 的标量不动点条件。\n\n请从 Dyson 方程和准粒子极点的定义出发，构建一个标量方程，该方程用 KS 参考能量 $\\varepsilon$、投影 GW 自能的实部 $\\mathrm{Re}\\,\\Sigma(\\omega)$ 以及 DFT 交换相关势的期望值 $v_{\\mathrm{xc}}$ 来确定 $E$。然后，在 $\\omega=\\varepsilon$ 附近将此方程线性化，以获得准粒子能量修正的一个实用的一阶表达式。使用以下具有物理动机的 GW 自能实部的单极点模型（一种与因果性和粒子-空穴对称性一致的简化等离激元-极点表示法）：\n$$\n\\mathrm{Re}\\,\\Sigma(\\omega) \\equiv \\Sigma(\\omega) = s_0 + s_1\\,\\omega + c\\,\\frac{\\omega}{\\omega^2 - \\Omega^2},\n$$\n其中 $s_0$ 和 $\\Omega$ 的单位是电子伏特，$s_1$ 是无量纲的，$c$ 的单位是平方电子伏特。所有能量和频率都必须以电子伏特为单位处理。\n\n您的任务是：\n- 从第一性原理推导准粒子能量 $E$ 的线性化解，该解用 $\\varepsilon$、$v_{\\mathrm{xc}}$、$\\Sigma(\\omega)$ 及其在 $\\omega=\\varepsilon$ 处对频率的一阶导数表示。\n- 实现一个程序，通过将您的线性化表达式应用于上述模型 $\\Sigma(\\omega)$，为以下每个测试用例计算 $E$ 的值。使用提供的显式参数。对于每个测试，输出以电子伏特为单位的准粒子能量，四舍五入到三位小数。\n\n测试套件（所有能量单位均为电子伏特）：\n- 测试 $1$：$\\varepsilon = 1.0$, $v_{\\mathrm{xc}} = -7.0$, $s_0 = -6.5$, $s_1 = 0.1$, $c = 2.0$, $\\Omega = 10.0$。\n- 测试 $2$：$\\varepsilon = -2.0$, $v_{\\mathrm{xc}} = -4.0$, $s_0 = -3.9$, $s_1 = 0.0$, $c = 0.1$, $\\Omega = 8.0$。\n- 测试 $3$：$\\varepsilon = 2.0$, $v_{\\mathrm{xc}} = -5.4$, $s_0 = -5.0, s_1 = 0.05, c = 1.2, \\Omega = 2.5$。\n- 测试 $4$：$\\varepsilon = 0.5$, $v_{\\mathrm{xc}} = -3.0$, $s_0 = -2.6$, $s_1 = 0.9, c = 0.0, \\Omega = 9.0$。\n\n最终输出规范：\n- 您的程序必须生成单行输出，其中包含一个 Python 风格的列表，该列表按顺序包含测试 1 到 4 的准粒子能量。列表格式为逗号分隔，并用方括号括起，每个能量值以电子伏特为单位，四舍五入到三位小数（例如，$[1.234,-0.567,8.900,0.000]$）。", "solution": "问题陈述在科学上是有效的且表述清晰。我们将着手进行推导和后续计算。\n\n确定准粒子（QP）能量 $E$ 的出发点是 Dyson 方程。对于一个具有本征值 $\\varepsilon_{n\\mathbf{k}}$ 的特定 Kohn-Sham（KS）态 $| \\psi_{n\\mathbf{k}} \\rangle$，其准粒子能量 $E_{n\\mathbf{k}}$ 是相互作用单粒子格林函数 $G$ 的一个极点。这个条件表示为以下非线性标量方程的解：\n$$\nE = \\varepsilon + \\mathrm{Re} \\left[ \\Sigma(E) \\right] - v_{\\mathrm{xc}}\n$$\n此处，$\\varepsilon$ 是初始 KS 本征值，$v_{\\mathrm{xc}}$ 是该 KS 态的交换相关势的期望值，而 $\\Sigma(\\omega)$ 是依赖于频率的自能算符。问题提供了一个自能实部 $\\mathrm{Re}[\\Sigma(\\omega)]$ 的模型，由于模型是纯实数的，我们将简记其为 $\\Sigma(\\omega)$。所有量都被理解为是针对所讨论的态的期望值。待求解的方程是：\n$$\nE = \\varepsilon + \\Sigma(E) - v_{\\mathrm{xc}}\n$$\n这个方程是非线性的，因为未知能量 $E$ 作为自变量出现在自能函数 $\\Sigma$ 中。求解该方程的一个常用且实用的方法是在已知的 KS 能量 $\\varepsilon$ 附近对自能项进行线性化。这通过对 $\\Sigma(E)$ 在 $E = \\varepsilon$ 处进行一阶泰勒级数展开来实现：\n$$\n\\Sigma(E) \\approx \\Sigma(\\varepsilon) + (E - \\varepsilon) \\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon}\n$$\n当准粒子修正 $E - \\varepsilon$ 相较于 $\\Sigma(\\omega)$ 发生显著变化的能量标度而言很小时，这个近似在物理上是合理的。将 $\\Sigma(E)$ 的线性化表达式代入准粒子方程，得到：\n$$\nE \\approx \\varepsilon + \\left[ \\Sigma(\\varepsilon) + (E - \\varepsilon) \\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon} \\right] - v_{\\mathrm{xc}}\n$$\n我们现在必须求解这个关于 $E$ 的线性方程。整理各项以分离出 $E$：\n$$\nE - (E - \\varepsilon) \\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon} = \\varepsilon + \\Sigma(\\varepsilon) - v_{\\mathrm{xc}}\n$$\n$$\nE \\left( 1 - \\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon} \\right) = \\varepsilon - \\varepsilon \\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon} + \\Sigma(\\varepsilon) - v_{\\mathrm{xc}}\n$$\n$$\nE \\left( 1 - \\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon} \\right) = \\varepsilon \\left( 1 - \\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon} \\right) + \\Sigma(\\varepsilon) - v_{\\mathrm{xc}}\n$$\n两边同除以括号中的项，我们便得到准粒子能量的线性化解：\n$$\nE = \\varepsilon + \\frac{\\Sigma(\\varepsilon) - v_{\\mathrm{xc}}}{1 - \\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon}}\n$$\n此表达式通常用准粒子重整化因子 $Z$ 来表示：\n$$\nZ = \\left( 1 - \\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon} \\right)^{-1}\n$$\n这样，准粒子能量由下式给出：\n$$\nE = \\varepsilon + Z (\\Sigma(\\varepsilon) - v_{\\mathrm{xc}})\n$$\n推导至此完成。\n\n为应用此结果，我们使用所提供的自能单极点模型：\n$$\n\\Sigma(\\omega) = s_0 + s_1\\,\\omega + c\\,\\frac{\\omega}{\\omega^2 - \\Omega^2}\n$$\n我们需要这个函数及其一阶导数在 $\\omega = \\varepsilon$ 处的值。该函数在 $\\varepsilon$ 处的值为：\n$$\n\\Sigma(\\varepsilon) = s_0 + s_1\\,\\varepsilon + c\\,\\frac{\\varepsilon}{\\varepsilon^2 - \\Omega^2}\n$$\n对 $\\omega$ 的一阶导数可使用商法则计算第三项：\n$$\n\\frac{d\\Sigma(\\omega)}{d\\omega} = s_1 + c \\cdot \\frac{d}{d\\omega}\\left( \\frac{\\omega}{\\omega^2 - \\Omega^2} \\right) = s_1 + c \\cdot \\frac{1(\\omega^2 - \\Omega^2) - \\omega(2\\omega)}{(\\omega^2 - \\Omega^2)^2} = s_1 - c \\frac{\\omega^2 + \\Omega^2}{(\\omega^2 - \\Omega^2)^2}\n$$\n计算该导数在 $\\omega = \\varepsilon$ 处的值：\n$$\n\\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon} = s_1 - c \\frac{\\varepsilon^2 + \\Omega^2}{(\\varepsilon^2 - \\Omega^2)^2}\n$$\n利用这些解析表达式，我们现在可以通过将给定参数代入 $\\Sigma(\\varepsilon)$、其导数、重整化因子 $Z$ 以及最终 $E$ 的公式中，来计算每个测试用例的准粒子能量 $E$。此过程的实现在最终答案中提供。\n各测试用例的计算结果如下：\n测试 $1$：$E = 1.630$ eV\n测试 $2$：$E = -1.897$ eV\n测试 $3$：$E = 1.832$ eV\n测试 $4$：$E = 9.000$ eV\n这些值是通过直接应用推导出的线性化公式获得的，并按要求四舍五入到三位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the linearized quasiparticle (QP) energy for several test cases\n    based on the GW approximation in many-body perturbation theory.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Parameters are: (epsilon, v_xc, s0, s1, c, Omega)\n    test_cases = [\n        (1.0, -7.0, -6.5, 0.1, 2.0, 10.0),  # Test 1\n        (-2.0, -4.0, -3.9, 0.0, 0.1, 8.0),  # Test 2\n        (2.0, -5.4, -5.0, 0.05, 1.2, 2.5),  # Test 3\n        (0.5, -3.0, -2.6, 0.9, 0.0, 9.0),   # Test 4\n    ]\n\n    results = []\n    for case in test_cases:\n        eps, v_xc, s0, s1, c, Omega = case\n\n        # Calculate Sigma(epsilon) using the provided single-pole model.\n        # Sigma(w) = s0 + s1*w + c*w / (w^2 - Omega^2)\n        # Denominator of the pole term:\n        denom_sigma = eps**2 - Omega**2\n        \n        # The problem data is chosen to avoid the pole where eps = Omega.\n        sigma_eps = s0 + s1 * eps + c * eps / denom_sigma\n\n        # Calculate the derivative of Sigma with respect to omega, evaluated at epsilon.\n        # dSigma/dw = s1 - c * (w^2 + Omega^2) / (w^2 - Omega^2)^2\n        # Denominator of the derivative term:\n        denom_deriv = (eps**2 - Omega**2)**2\n        \n        d_sigma_d_omega = s1 - c * (eps**2 + Omega**2) / denom_deriv\n\n        # Calculate the quasiparticle renormalization factor Z.\n        # Z = 1 / (1 - dSigma/domega)\n        Z = 1.0 / (1.0 - d_sigma_d_omega)\n\n        # Calculate the linearized quasiparticle energy E.\n        # E = eps + Z * (Sigma(eps) - v_xc)\n        E = eps + Z * (sigma_eps - v_xc)\n\n        # Append the result, formatted to three decimal places.\n        results.append(f\"{E:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2846767"}]}