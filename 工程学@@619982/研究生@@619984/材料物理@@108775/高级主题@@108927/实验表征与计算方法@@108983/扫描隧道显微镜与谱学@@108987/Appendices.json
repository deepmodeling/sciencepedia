{"hands_on_practices": [{"introduction": "隧道电流随针尖-样品间距呈指数衰减的特性，是扫描隧道显微镜（STM）原子级垂直分辨率的物理基础。本练习旨在将这一基本原理付诸实践。通过分析一个可测量的实验参数——电流的对数斜率（$ \\partial_z \\ln I $），你将推导出表观势垒高度（$ \\phi_{\\text{app}} $）的计算方法，并进一步考虑有限偏压下的梯形势垒修正，从而加深对WKB近似在STM中的应用的理解，并掌握从原始数据中提取关键物理参数的核心技能。[@problem_id:2856462]", "problem": "一个扫描隧道显微镜 (STM) 实验在低温下测量了金属针尖和金属样品之间隧道电流随距离变化的依赖关系。在样品偏压 $V = 100\\,\\mathrm{mV}$ 时，测得电流对数随针尖-样品间距变化的斜率为 $\\partial_{z} \\ln I = -20\\,\\mathrm{nm}^{-1}$。假设一个具有自由电子质量 $m_{e}$ 的电子隧穿真空势垒，并忽略镜像势和态密度的变化。\n\n从隧穿经典禁区的一维 Wentzel–Kramers–Brillouin (WKB) 近似出发，利用隧道透射率的指数距离依赖性，推导在低偏压、矩形势垒极限下，斜率 $\\partial_{z} \\ln I$ 与表观势垒高度 $\\phi_{\\mathrm{app}}$ 之间的关系。然后计算 $\\phi_{\\mathrm{app}}$。\n\n接下来，考虑有限偏压 $V$ 在两个相同金属（对称电极）之间产生一个梯形真空势垒。在与 WKB 图像一致的小参量 $e|V|/\\phi$ 的一阶处理下，说明有限偏压如何修正从 $\\partial_{z}\\ln I$ 推断出的有效势垒高度，并利用此关系和在 $V = 100\\,\\mathrm{mV}$ 下测得的斜率，估算校正后的功函数等效势垒高度 $\\phi_{\\mathrm{corr}}$。\n\n将 $\\phi_{\\mathrm{app}}$ 和 $\\phi_{\\mathrm{corr}}$ 均以 $\\mathrm{eV}$ 为单位表示，并将答案四舍五入到四位有效数字。使用 $m_{e}$ 表示电子质量，$\\hbar$ 表示约化普朗克常数，$e$ 表示基本电荷。在跨越真空的能量降 $e|V|$ 中，将 $V$ 视为正值。", "solution": "问题陈述已经过验证，被认为是具有科学依据、提法恰当且客观的。它代表了在一个简化但富有启发性的理论框架内对扫描隧道显微镜数据的标准分析。我们将按要求进行推导和计算。\n\n我们分析的基础是，质量为 $m_e$、能量为 $E$ 的粒子隧穿一个从 $x=x_1$ 延伸到 $x=x_2$ 的势垒 $U(x)$ 的透射概率 $T$ 的一维 Wentzel–Kramers–Brillouin (WKB) 近似：\n$$ T \\approx \\exp\\left( -2 \\int_{x_1}^{x_2} \\sqrt{\\frac{2m_e (U(x)-E)}{\\hbar^2}} \\, dx \\right) $$\n隧道电流 $I$ 与此透射概率成正比，即 $I \\propto T$。因此，电流的对数与 WKB 指数相关：\n$$ \\ln I = C - 2 \\int_{x_1}^{x_2} \\sqrt{\\frac{2m_e (U(x)-E)}{\\hbar^2}} \\, dx $$\n其中 $C$ 是一个与针尖-样品间距 $z$ 无关的常数。因此 $\\ln I$ 对 $z$ 的导数将取决于该积分的导数。\n\n首先，我们分析低偏压极限，即外加电压 $V \\to 0$。在此极限下，金属针尖和样品之间的势垒是一个宽度为 $z$（针尖-样品间距）、高度为 $\\phi$ 的简单矩形势垒。发生隧穿的电子是处于费米能 $E_F$ 上的电子。我们可以设定 $E=E_F=0$ 作为我们的能量参考点。那么势垒为 $U(x) = \\phi$，其中 $0 \\le x \\le z$。问题将此极限下推断出的势垒高度定义为“表观势垒高度” $\\phi_{\\mathrm{app}}$。\n\nWKB 积分变为：\n$$ \\int_{0}^{z} \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} \\, dx = z \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} $$\n将此代入 $\\ln I$ 的表达式中：\n$$ \\ln I = C - 2z \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} $$\n电流对数随间距 $z$ 变化的斜率即为其导数：\n$$ \\frac{\\partial \\ln I}{\\partial z} = -2 \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} $$\n这就是所求的斜率与表观势垒高度之间的关系。问题给出了该斜率的测量值，我们将其记为 $S = \\partial_{z} \\ln I = -20\\,\\mathrm{nm}^{-1}$。现在我们可以解出 $\\phi_{\\mathrm{app}}$：\n$$ S = -2 \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} $$\n$$ S^2 = 4 \\left( \\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2} \\right) = \\frac{8m_e \\phi_{\\mathrm{app}}}{\\hbar^2} $$\n$$ \\phi_{\\mathrm{app}} = \\frac{\\hbar^2 S^2}{8m_e} $$\n为了计算数值，我们使用给定的斜率 $S = -20\\,\\mathrm{nm}^{-1} = -2 \\times 10^{10}\\,\\mathrm{m}^{-1}$，以及约化普朗克常数 $\\hbar$ 和电子质量 $m_e$ 的基本常数值：\n$$ \\phi_{\\mathrm{app}} = \\frac{(1.05457 \\times 10^{-34}\\,\\mathrm{J}\\cdot\\mathrm{s})^2 (-2 \\times 10^{10}\\,\\mathrm{m}^{-1})^2}{8 (9.10938 \\times 10^{-31}\\,\\mathrm{kg})} \\approx 6.1043 \\times 10^{-19}\\,\\mathrm{J} $$\n为了将其单位表示为电子伏特 ($\\mathrm{eV}$)，我们除以基本电荷 $e$：\n$$ \\phi_{\\mathrm{app}} (\\mathrm{eV}) = \\frac{6.1043 \\times 10^{-19}\\,\\mathrm{J}}{1.60218 \\times 10^{-19}\\,\\mathrm{C}} \\approx 3.8100\\,\\mathrm{eV} $$\n四舍五入到四位有效数字，$\\phi_{\\mathrm{app}} = 3.810\\,\\mathrm{eV}$。\n\n接下来，我们考虑有限偏压 $V$ 的影响。对于两个功函数为 $\\phi_{\\mathrm{corr}}$ 的相同金属，施加在样品上的偏压 $V$ 会产生一个梯形势垒。间隙中电子的势能近似呈线性关系：\n$$ U(x) = \\phi_{\\mathrm{corr}} - \\frac{eV}{z}x \\quad \\text{for } 0 \\le x \\le z $$\n此处，$\\phi_{\\mathrm{corr}}$ 是我们希望求得的真实的、不依赖于偏压的功函数等效势垒高度。我们再次计算针尖费米能级（$E=0$）上电子的隧道指数。现在的 WKB 积分是：\n$$ \\int_{0}^{z} \\sqrt{\\frac{2m_e}{\\hbar^2} \\left( \\phi_{\\mathrm{corr}} - \\frac{eV}{z}x \\right)} \\, dx = \\sqrt{\\frac{2m_e\\phi_{\\mathrm{corr}}}{\\hbar^2}} \\int_{0}^{z} \\sqrt{1 - \\frac{eV}{\\phi_{\\mathrm{corr}} z}x} \\, dx $$\n问题指明要对小参量 $e|V|/\\phi_{\\mathrm{corr}}$ 做一阶处理。我们对小的 $u$ 使用泰勒展开 $\\sqrt{1-u} \\approx 1 - u/2$：\n$$ \\sqrt{1 - \\frac{eV}{\\phi_{\\mathrm{corr}} z}x} \\approx 1 - \\frac{1}{2}\\frac{eV}{\\phi_{\\mathrm{corr}} z}x $$\n积分变为：\n$$ \\int_{0}^{z} \\left(1 - \\frac{eV}{2\\phi_{\\mathrm{corr}} z}x\\right) \\, dx = \\left[ x - \\frac{eV}{4\\phi_{\\mathrm{corr}} z}x^2 \\right]_{0}^{z} = z - \\frac{eV z^2}{4\\phi_{\\mathrm{corr}} z} = z \\left(1 - \\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right) $$\n将此结果代回，完整的隧道指数被修正。电流的对数为：\n$$ \\ln I \\approx C - 2 \\sqrt{\\frac{2m_e\\phi_{\\mathrm{corr}}}{\\hbar^2}} \\cdot z \\left(1 - \\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right) $$\n在有限偏压 $V$ 下测得的斜率 $S$ 是 $\\ln I$ 对 $z$ 的导数，其中 $V$ 保持不变：\n$$ S = \\frac{\\partial \\ln I}{\\partial z} = -2\\sqrt{\\frac{2m_e\\phi_{\\mathrm{corr}}}{\\hbar^2}} \\left(1 - \\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right) $$\n此表达式显示了有限偏压如何修正斜率。为了将其与表观势垒高度 $\\phi_{\\mathrm{app}}$ 联系起来，我们令两个关于 $S$ 的表达式相等：\n$$ -2 \\sqrt{\\frac{2m_e\\phi_{\\mathrm{app}}}{\\hbar^2}} = -2\\sqrt{\\frac{2m_e\\phi_{\\mathrm{corr}}}{\\hbar^2}} \\left(1 - \\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right) $$\n$$ \\sqrt{\\phi_{\\mathrm{app}}} = \\sqrt{\\phi_{\\mathrm{corr}}} \\left(1 - \\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right) $$\n两边平方，并保留到 $V$ 的一阶项：\n$$ \\phi_{\\mathrm{app}} = \\phi_{\\mathrm{corr}} \\left(1 - \\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right)^2 \\approx \\phi_{\\mathrm{corr}} \\left(1 - 2\\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right) = \\phi_{\\mathrm{corr}} \\left(1 - \\frac{eV}{2\\phi_{\\mathrm{corr}}}\\right) $$\n$$ \\phi_{\\mathrm{app}} \\approx \\phi_{\\mathrm{corr}} - \\frac{eV}{2} $$\n这个结果表明，在有限偏压 $V$ 下测量的表观势垒高度比真实势垒高度 $\\phi_{\\mathrm{corr}}$ 大约低 $eV/2$。我们现在可以解出校正后的势垒高度：\n$$ \\phi_{\\mathrm{corr}} \\approx \\phi_{\\mathrm{app}} + \\frac{eV}{2} $$\n使用给定的偏压 $V=100\\,\\mathrm{mV} = 0.1\\,\\mathrm{V}$，校正项为 $\\frac{eV}{2} = \\frac{e(0.1\\,\\mathrm{V})}{2} = 0.05\\,\\mathrm{eV}$。\n$$ \\phi_{\\mathrm{corr}} \\approx 3.8100\\,\\mathrm{eV} + 0.05\\,\\mathrm{eV} = 3.8600\\,\\mathrm{eV} $$\n四舍五入到四位有效数字，$\\phi_{\\mathrm{corr}} = 3.860\\,\\mathrm{eV}$。\n两个所求的值是 $\\phi_{\\mathrm{app}}$ 和 $\\phi_{\\mathrm{corr}}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.810 & 3.860\n\\end{pmatrix}\n}\n$$", "id": "2856462"}, {"introduction": "STM恒流形貌图并不仅仅是表面的几何轮廓，它实际上是几何结构与电子结构信息的复杂卷积。本练习将通过一个模拟任务，让你直观地理解这一核心概念 [@problem_id:2856463]。你将基于Tersoff–Hamann模型，编程实现一个局部电子态密度（LDOS）中的特征（例如一个能带边或一个分子轨道）如何转化为恒流图像中的“电子高度”贡献。这项实践有助于揭示STM作为一种能够“看见”电子态的强大工具的本质，并阐明为何有时STM图像中的“原子”高度并不直接对应其物理高度。", "problem": "考虑在恒流模式下运行的扫描隧道显微镜 (STM)，用于扫描一个在能量 $E_0$ 处具有局域态密度 (LDOS) 特征的样品。在 Tersoff–Hamann 近似下，针尖-样品间距为 $z$、样品偏压为 $V$ 时的隧道电流满足 $I(z,V) \\propto \\exp(-2 \\kappa z) \\int_{0}^{e V} \\rho_s(E)\\, dE$，其中 $\\kappa = \\sqrt{2 m \\phi}/\\hbar$，$m$ 是电子质量，$\\phi$ 是有效隧穿势垒高度，$\\hbar$ 是约化普朗克常数。假设针尖为金属材质，在相关偏压窗口内其态密度和透射率与能量无关。在恒流形貌测量中，反馈回路调节 $z$，使得对于每个横向位置，$I(z,V)$ 等于一个固定的设定值。\n\n两个横向位置（标记为 $A$ 和 $B$）具有相同的几何形貌，仅存在一个已知的真实高度差 $\\Delta z_\\mathrm{true}$，且它们的电子结构仅在样品 LDOS 上有所不同。具体而言，将 LDOS（单位为 $\\mathrm{eV}^{-1}$）建模如下：\n- 在位置 $A$：$\\rho_A(E) = \\rho_0$，对于 $E \\ge 0$。\n- 在位置 $B$：$\\rho_B(E) = \\rho_0 + A_p \\exp\\!\\left( -\\dfrac{(E - E_0)^2}{2 \\sigma^2} \\right)$，对于 $E \\ge 0$。\n\n此处，$E$ 和 $E_0$ 是相对于费米能级测量的能量，$V > 0$ 是样品偏压，因此积分范围为从 $E = 0$ 到 $E = e V$。\n\n任务：\n1. 仅从隧穿概率对距离的指数依赖关系和 Tersoff–Hamann 近似中隧道电流的定义出发，推导在偏压 $V$ 下通过恒流成像测得的位置 $B$ 和 $A$ 之间的表观高度差 $\\Delta z_\\mathrm{app}(V)$ 的表达式。将 $\\Delta z_\\mathrm{app}(V)$ 分解为真实几何高度差 $\\Delta z_\\mathrm{true}$ 和一个通过能量积分依赖于 LDOS 的电子贡献 $\\Delta z_\\mathrm{el}(V)$ 之和。\n2. 实现此模型，以计算当偏压 $V$ 扫描经过能量 $E_0$ 处的 LDOS 特征峰时，$\\Delta z_\\mathrm{app}(V)$ 对偏压的依赖关系，并明确地量化 $\\Delta z_\\mathrm{el}(V)$。\n3. 使用以下国际单位制 (SI) 的物理常数：电子质量 $m = 9.10938356 \\times 10^{-31}\\,\\mathrm{kg}$，约化普朗克常数 $\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J \\cdot s}$，基本电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$。在计算 $\\kappa = \\sqrt{2 m \\phi}/\\hbar$ 时，将势垒高度 $\\phi$ 从 $\\mathrm{eV}$ 转换为 $\\mathrm{J}$。\n4. 对于下方的每个测试用例，计算并报告针对指定偏压值的两个列表：表观高度列表 $\\left[\\Delta z_\\mathrm{app}(V_i)\\right]$ 和纯电子贡献列表 $\\left[\\Delta z_\\mathrm{el}(V_i)\\right]$。所有高度均以皮米表示，并将每个浮点数四舍五入到三位小数。\n\n测试套件（每个用例指定 $\\rho_0$、$A_p$、$E_0$（单位 $\\mathrm{eV}$）、$\\sigma$（单位 $\\mathrm{eV}$）、$\\Delta z_\\mathrm{true}$（单位 $\\mathrm{pm}$）、$\\phi$（单位 $\\mathrm{eV}$），以及 $V_\\mathrm{set}$ 值的列表（单位 $\\mathrm{V}$））：\n- 用例 1（跨越特征峰的理想路径）：$\\rho_0 = 1.0$, $A_p = 2.0$, $E_0 = 0.30$, $\\sigma = 0.05$, $\\Delta z_\\mathrm{true} = 50.0$, $\\phi = 4.5$, biases $V_\\mathrm{set} \\in \\{0.10, 0.30, 0.60\\}$。\n- 用例 2（尖锐、强烈的特征峰；纯电子衬度）：$\\rho_0 = 1.0$, $A_p = 5.0$, $E_0 = 0.20$, $\\sigma = 0.01$, $\\Delta z_\\mathrm{true} = 0.0$, $\\phi = 4.5$, biases $V_\\mathrm{set} \\in \\{0.15, 0.20, 0.25\\}$。\n- 用例 3（无特征峰；纯形貌）：$\\rho_0 = 1.0$, $A_p = 0.0$, $E_0 = 0.30$, $\\sigma = 0.05$, $\\Delta z_\\mathrm{true} = 200.0$, $\\phi = 4.5$, biases $V_\\mathrm{set} \\in \\{0.10, 0.40\\}$。\n\n你的程序必须：\n- 实现上述物理模型，不使用任何外部输入。\n- 对每个用例，计算以皮米为单位的两个列表 $\\left[\\Delta z_\\mathrm{app}(V_i)\\right]$ 和 $\\left[\\Delta z_\\mathrm{el}(V_i)\\right]$，并四舍五入到三位小数。\n- 生成单行输出，其中包含一个各用例结果的列表，每个用例的结果是一个包含两个列表的二元列表，顺序为 $\\left[\\left[\\Delta z_\\mathrm{app}(V_i)\\right], \\left[\\Delta z_\\mathrm{el}(V_i)\\right]\\right]$。例如，一个有效的输出结构形式为 $\\left[ \\left[ [\\cdots], [\\cdots] \\right], \\left[ [\\cdots], [\\cdots] \\right], \\left[ [\\cdots], [\\cdots] \\right] \\right]$。", "solution": "所述问题在科学上是合理的、提法明确，并包含得出唯一解所需的所有信息。这是扫描隧道显微镜（STM）的 Tersoff–Hamann 模型的标准应用，该模型是理论表面科学的基石。我们将首先进行形式推导，然后实现最终得到的模型。\n\n此分析的基础是在 Tersoff–Hamann 近似框架内，隧道电流 $I$ 作为针尖-样品间距 $z$ 和样品偏压 $V$ 的函数的表达式：\n$$\nI(z, V) = C \\exp(-2 \\kappa z) \\int_{0}^{e V} \\rho_s(E) dE\n$$\n这里，$C$ 是一个比例常数，依赖于针尖的电子结构（假定为常数）和其他因素；$\\rho_s(E)$ 是样品的局域态密度 (LDOS)；$\\kappa = \\sqrt{2 m \\phi}/\\hbar$ 是真空衰减常数，由电子质量 $m$、有效隧穿势垒高度 $\\phi$ 和约化普朗克常数 $\\hbar$ 决定。所有能量 $E$ 都是从样品的费米能级开始测量的。\n\n在恒流模式下，反馈回路通过在每个横向位置 $(x, y)$ 调节针尖高度 $z$ 来维持一个固定的设定电流 $I_{\\text{set}}$。考虑两个横向位置 $A$ 和 $B$。设在偏压 $V$ 下，它们各自测得的针尖-样品间距为 $z_A(V)$ 和 $z_B(V)$。恒流条件意味着：\n$$\nI_{\\text{set}} = C \\exp(-2 \\kappa z_A(V)) \\int_{0}^{e V} \\rho_A(E) dE\n$$\n$$\nI_{\\text{set}} = C \\exp(-2 \\kappa z_B(V)) \\int_{0}^{e V} \\rho_B(E) dE\n$$\n将这两个表达式置于相等，并消去常数 $C$，可得：\n$$\n\\exp(-2 \\kappa z_A(V)) \\int_{0}^{e V} \\rho_A(E) dE = \\exp(-2 \\kappa z_B(V)) \\int_{0}^{e V} \\rho_B(E) dE\n$$\n重新整理以分离出与高度差相关的项，我们得到：\n$$\n\\exp(2 \\kappa [z_B(V) - z_A(V)]) = \\frac{\\int_{0}^{e V} \\rho_B(E) dE}{\\int_{0}^{e V} \\rho_A(E) dE}\n$$\n对两边取自然对数并求解针尖-样品间距之差，可得：\n$$\nz_B(V) - z_A(V) = \\frac{1}{2 \\kappa} \\ln\\left( \\frac{\\int_{0}^{e V} \\rho_B(E) dE}{\\int_{0}^{e V} \\rho_A(E) dE} \\right)\n$$\n由 STM 测得的表面表观高度 $z_{\\text{app}}$ 是针尖的垂直位置。如果样品在位置 $A$ 和 $B$ 的真实几何高度分别为 $h_A$ 和 $h_B$，则针尖的垂直位置由 $z_{\\text{tip}} = h_{\\text{surface}} + z_{\\text{separation}}$ 给出。因此，表观高度差为：\n$$\n\\Delta z_{\\text{app}}(V) = z_{\\text{tip}, B}(V) - z_{\\text{tip}, A}(V) = [h_B + z_B(V)] - [h_A + z_A(V)] = (h_B - h_A) + (z_B(V) - z_A(V))\n$$\n我们将 $(h_B - h_A)$ 定义为真实几何高度差 $\\Delta z_{\\text{true}}$。表观高度差的表达式变为：\n$$\n\\Delta z_{\\text{app}}(V) = \\Delta z_{\\text{true}} + \\frac{1}{2 \\kappa} \\ln\\left( \\frac{\\int_{0}^{e V} \\rho_B(E) dE}{\\int_{0}^{e V} \\rho_A(E) dE} \\right)\n$$\n此结果的形式为 $\\Delta z_{\\text{app}}(V) = \\Delta z_{\\text{true}} + \\Delta z_{\\mathrm{el}}(V)$，其中对表观高度的电子贡献为：\n$$\n\\Delta z_{\\mathrm{el}}(V) = \\frac{1}{2 \\kappa} \\ln\\left( \\frac{\\int_{0}^{e V} \\rho_B(E) dE}{\\int_{0}^{e V} \\rho_A(E) dE} \\right)\n$$\n这就完成了第一项推导任务。\n\n接下来，我们针对指定的 LDOS 模型计算积分。能量参数和 LDOS 分别以 $\\mathrm{eV}$ 和 $\\mathrm{eV}^{-1}$ 为单位，因此我们将积分变量 $E$ 解释为以电子伏特 ($\\mathrm{eV}$) 为单位的能量，并将积分上限 $e V$ 解释为偏压 $V$ 的数值（以伏特为单位）。\n对于位置 $A$，$\\rho_A(E) = \\rho_0$：\n$$\n\\int_0^V \\rho_A(E) dE = \\int_0^V \\rho_0 dE = \\rho_0 V\n$$\n对于位置 $B$，$\\rho_B(E) = \\rho_0 + A_p \\exp\\left( -\\frac{(E - E_0)^2}{2 \\sigma^2} \\right)$：\n$$\n\\int_0^V \\rho_B(E) dE = \\int_0^V \\rho_0 dE + A_p \\int_0^V \\exp\\left( -\\frac{(E - E_0)^2}{2 \\sigma^2} \\right) dE\n$$\n第二个积分与误差函数 $\\mathrm{erf}(x) = \\frac{2}{\\sqrt{\\pi}} \\int_0^x e^{-t^2} dt$ 相关。通过变量代换 $t = (E - E_0)/(\\sigma\\sqrt{2})$，该积分变为：\n$$\n\\int_0^V \\exp\\left( -\\frac{(E - E_0)^2}{2 \\sigma^2} \\right) dE = \\sigma\\sqrt{\\frac{\\pi}{2}} \\left[ \\mathrm{erf}\\left(\\frac{V - E_0}{\\sigma\\sqrt{2}}\\right) - \\mathrm{erf}\\left(\\frac{-E_0}{\\sigma\\sqrt{2}}\\right) \\right]\n$$\n利用性质 $\\mathrm{erf}(-x) = -\\mathrm{erf}(x)$，上式可简化为：\n$$\n\\sigma\\sqrt{\\frac{\\pi}{2}} \\left[ \\mathrm{erf}\\left(\\frac{V - E_0}{\\sigma\\sqrt{2}}\\right) + \\mathrm{erf}\\left(\\frac{E_0}{\\sigma\\sqrt{2}}\\right) \\right]\n$$\n将这些积分计算结果代入 $\\Delta z_{\\mathrm{el}}(V)$ 的表达式：\n$$\n\\Delta z_{\\mathrm{el}}(V) = \\frac{1}{2 \\kappa} \\ln\\left( \\frac{\\rho_0 V + A_p \\sigma\\sqrt{\\frac{\\pi}{2}} \\left[ \\mathrm{erf}\\left(\\frac{V - E_0}{\\sigma\\sqrt{2}}\\right) + \\mathrm{erf}\\left(\\frac{E_0}{\\sigma\\sqrt{2}}\\right) \\right]}{\\rho_0 V} \\right)\n$$\n$$\n\\Delta z_{\\mathrm{el}}(V) = \\frac{1}{2 \\kappa} \\ln\\left( 1 + \\frac{A_p \\sigma}{\\rho_0 V} \\sqrt{\\frac{\\pi}{2}} \\left[ \\mathrm{erf}\\left(\\frac{V - E_0}{\\sigma\\sqrt{2}}\\right) + \\mathrm{erf}\\left(\\frac{E_0}{\\sigma\\sqrt{2}}\\right) \\right] \\right)\n$$\n为了计算数值，$\\kappa$ 公式中的所有量都必须使用国际单位制（SI）单位。以 $\\mathrm{eV}$ 为单位给出的势垒高度 $\\phi$ 必须通过乘以基本电荷 $e$ 转换为焦耳。得到的 $\\kappa$ 的单位将是 $\\mathrm{m}^{-1}$。因此，因子 $1/(2\\kappa)$ 的单位将是米。为了以皮米 ($\\mathrm{pm}$) 为单位表示最终高度，该因子需乘以 $10^{12}$。对数函数内部的量（$V, E_0, \\sigma, A_p, \\rho_0$）使用其给定单位，因为它们构成了一个无量纲组合。\n\n计算实现将按以下步骤进行：\n1. 以国际单位制定义物理常数 $m, \\hbar, e$。\n2. 对每个测试用例，使用指定的势垒高度 $\\phi$ 计算常数 $\\kappa$。\n3. 计算预因子 $1/(2\\kappa)$ 并将其单位转换为皮米。\n4. 在给定的测试用例中，对于每个指定的偏压 $V$：\n    a. 使用推导出的公式计算 $\\Delta z_{\\mathrm{el}}(V)$，这需要计算 $\\mathrm{erf}$ 函数。\n    b. 计算 $\\Delta z_{\\mathrm{app}}(V) = \\Delta z_{\\mathrm{true}} + \\Delta z_{\\mathrm{el}}(V)$，确保 $\\Delta z_{\\mathrm{true}}$ 以皮米为单位。\n5. 收集计算出的 $\\Delta z_{\\mathrm{app}}(V_i)$ 和 $\\Delta z_{\\mathrm{el}}(V_i)$ 列表，将数值四舍五入到三位小数，并根据指定的结构格式化输出。\n\n这一系统性步骤确保了基于凝聚态物理基本原理的正确且可复现的解决方案。", "answer": "```python\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Main function to solve the STM problem for all test cases.\n    It orchestrates the calculation and formats the final output.\n    \"\"\"\n    # Physical constants in SI units\n    M_E = 9.10938356e-31  # Electron mass (kg)\n    HBAR = 1.054571817e-34  # Reduced Planck constant (J*s)\n    E_CHARGE = 1.602176634e-19  # Elementary charge (C or J/eV)\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        # Case 1: Happy path across the feature\n        # (rho0, Ap, E0_eV, sigma_eV, dz_true_pm, phi_eV, V_set_V)\n        (1.0, 2.0, 0.30, 0.05, 50.0, 4.5, [0.10, 0.30, 0.60]),\n        # Case 2: Sharp, strong feature; pure electronic contrast\n        (1.0, 5.0, 0.20, 0.01, 0.0, 4.5, [0.15, 0.20, 0.25]),\n        # Case 3: No feature; purely topographic\n        (1.0, 0.0, 0.30, 0.05, 200.0, 4.5, [0.10, 0.40]),\n    ]\n\n    all_results_str = []\n    for case in test_cases:\n        rho0, ap, e0, sigma, dz_true, phi, v_set = case\n        \n        # Calculate kappa in SI units (m^-1)\n        phi_joules = phi * E_CHARGE\n        kappa = np.sqrt(2 * M_E * phi_joules) / HBAR\n        \n        # Pre-factor for z_el calculation, converted to picometers\n        z_el_prefactor_pm = 1e12 / (2 * kappa)\n        \n        dz_app_list = []\n        dz_el_list = []\n        \n        for v_bias in v_set:\n            if v_bias == 0:\n                # Handle the case V=0, where electronic contribution is zero\n                dz_el = 0.0\n            elif ap == 0:\n                # If there is no electronic feature, a_p=0, contribution is zero\n                dz_el = 0.0\n            else:\n                # Calculate the argument of the logarithm\n                erf_arg1 = (v_bias - e0) / (sigma * np.sqrt(2))\n                erf_arg2 = e0 / (sigma * np.sqrt(2))\n                erf_term = erf(erf_arg1) + erf(erf_arg2)\n                \n                log_argument_term = (ap * sigma / (rho0 * v_bias)) * np.sqrt(np.pi / 2) * erf_term\n                \n                # Calculate the electronic contribution to height\n                dz_el = z_el_prefactor_pm * np.log(1 + log_argument_term)\n            \n            # Apparent height is the sum of true and electronic contributions\n            dz_app = dz_true + dz_el\n            \n            dz_app_list.append(dz_app)\n            dz_el_list.append(dz_el)\n\n        # Format the results for this case into the required string structure\n        str_dz_app = f\"[{','.join(f'{z:.3f}' for z in dz_app_list)}]\"\n        str_dz_el = f\"[{','.join(f'{z:.3f}' for z in dz_el_list)}]\"\n        case_result_str = f\"[{str_dz_app},{str_dz_el}]\"\n        all_results_str.append(case_result_str)\n\n    # Print the final output in the required single-line format\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```", "id": "2856463"}, {"introduction": "虽然扫描隧道谱（STS）是探测样品局域电子态密度（LDOS）的有力工具，但实验测得的微分电导谱（$dI/dV$）并非原始的LDOS，而是经过了归一化的结果。这个归一化因子取决于谱线采集前的反馈回路稳定“设定点”（即稳定偏压$V_s$和稳定电流$I_s$）。本编码练习将引导你模拟这种重要的“设定点效应”[@problem_id:2856453]，通过精确计算，你将定量地展示不同设定点如何改变谱线中特征峰的表观强度。掌握这一效应对正确解译乃至设计STS实验至关重要，是进行定量谱学分析的必备知识。", "problem": "编写一个完整程序，使用适用于扫描隧道显微镜 (STM) 的第一性原理关系，模拟在扫描隧道谱 (STS) 中由设定点引起的微分电导峰值振幅的变化。请从以下基本原理出发：在 Tersoff–Hamann 近似中，当针尖-样品间距为 $z$、样品偏压为 $V$ 时，对于正的 $V$，隧道电流可以写为 $I(V,z) \\propto e^{-2\\kappa z} \\int_{0}^{V} \\rho_{s}(E)\\,\\mathrm{d}E$，其中 $\\rho_{s}(E)$ 是样品局域态密度 (LDOS)，微分电导满足 $\\,\\mathrm{d}I/\\mathrm{d}V \\propto \\rho_{s}(V)\\,e^{-2\\kappa z}$。谱学设定点由一个点对 $(V_{s}, I_{s})$ 定义，该设定点通过反馈调节 $z_{s}$ 来强制满足 $I(V_{s}, z_{s}) = I_{s}$。假设针尖态密度恒定，真空势垒固定，因此 $\\kappa$ 与 $V$ 无关。共振被建模为一个叠加在平坦背景上的窄洛伦兹峰，\n$$\n\\rho_{s}(E) = \\rho_{0} + \\frac{A_{L}\\,\\Gamma^{2}}{(E - E_{r})^{2} + \\Gamma^{2}},\n$$\n其中平坦背景 $\\rho_{0} > 0$，中心能量 $E_{r} > 0$，半峰半宽 $\\Gamma > 0$，洛伦兹峰高 $A_{L} > 0$。在整个问题中，$E$ 和 $V$ 的单位均为电子伏特 ($\\mathrm{eV}$)，并假设 $V \\ge 0$。您的任务是，对于每一组给定的参数，模拟在两种不同设定点 $(V_{s1}, I_{s1})$ 和 $(V_{s2}, I_{s2})$ 下测得的 $V = E_{r}$ 处的 $\\mathrm{d}I/\\mathrm{d}V$ 峰值振幅之比。程序必须仅根据上述基本定义计算此比率，不得引入任何额外的唯象模型。\n\n在数学和算法上：\n- 从给定的基本原理出发，推导谱学设定点 $(V_{s}, I_{s})$ 如何归一化所测得的 $\\mathrm{d}I/\\mathrm{d}V(V)$。\n- 使用给定的 LDOS 模型精确计算所有需要的能量积分，不使用数值积分方法，从而确保结果对于窄 $\\Gamma$ 是明确且稳健的。\n- 对每种情况，计算无量纲比率 $R = \\left[\\left.\\mathrm{d}I/\\mathrm{d}V\\right|_{V=E_{r}}\\right]_{\\text{设定点 }2} \\big/ \\left[\\left.\\mathrm{d}I/\\mathrm{d}V\\right|_{V=E_{r}}\\right]_{\\text{设定点 }1}$。\n\n使用以下测试套件。每个测试用例提供 $(\\rho_{0}, A_{L}, \\Gamma, E_{r}; V_{s1}, I_{s1}; V_{s2}, I_{s2})$，其中能量单位为 $\\mathrm{eV}$，电流单位为安培。程序必须为每个测试用例生成一个结果 $R$ (一个浮点数)。\n\n- 测试用例 1 (通用“理想路径”，一个设定点低于共振，一个高于共振)：\n  - $\\rho_{0} = 1.0$, $A_{L} = 8.0$, $\\Gamma = 0.005$, $E_{r} = 0.200$。\n  - $(V_{s1}, I_{s1}) = (0.100, 1.0\\times 10^{-9})$, $(V_{s2}, I_{s2}) = (0.300, 1.0\\times 10^{-9})$。\n\n- 测试用例 2 (相同的偏压设定点，不同的电流，用于分离出电流的标度效应)：\n  - $\\rho_{0} = 1.0$, $A_{L} = 10.0$, $\\Gamma = 0.010$, $E_{r} = 0.200$。\n  - $(V_{s1}, I_{s1}) = (0.250, 0.5\\times 10^{-9})$, $(V_{s2}, I_{s2}) = (0.250, 1.0\\times 10^{-9})$。\n\n- 测试用例 3 (设定点恰好在共振能量处，电流不同)：\n  - $\\rho_{0} = 0.8$, $A_{L} = 6.0$, $\\Gamma = 0.004$, $E_{r} = 0.200$。\n  - $(V_{s1}, I_{s1}) = (0.200, 1.0\\times 10^{-9})$, $(V_{s2}, I_{s2}) = (0.200, 0.8\\times 10^{-9})$。\n\n- 测试用例 4 (非常窄的共振，一个设定点低于共振，一个高于共振，以探究强设定点效应)：\n  - $\\rho_{0} = 1.2$, $A_{L} = 12.0$, $\\Gamma = 0.001$, $E_{r} = 0.020$。\n  - $(V_{s1}, I_{s1}) = (0.050, 1.0\\times 10^{-9})$, $(V_{s2}, I_{s2}) = (0.015, 1.0\\times 10^{-9})$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含按测试用例顺序排列的四个比率，形式为逗号分隔的列表，并用方括号括起来，例如 $[r_{1},r_{2},r_{3},r_{4}]$。列表中的条目必须是浮点数。因为所要求的输出是纯比率，所以不需要物理单位 (无量纲)。", "solution": "所述问题在科学上是合理的，在数学上是适定的。它基于扫描隧道显微镜 (STM) 的标准 Tersoff-Hamann 近似，这是该领域的基石之一。局域态密度 (LDOS) 被建模为一个物理上合理的函数，即一个叠加在恒定背景上的洛伦兹共振。所有参数都已定义，目标明确。因此，我们可以进行严谨的推导。\n\n在样品偏压为 $V$ 和针尖-样品间距为 $z$ 时，隧道电流 $I$ 的基本关系式如下：\n$$\nI(V,z) = C_{0} e^{-2\\kappa z} \\int_{0}^{V} \\rho_{s}(E)\\,\\mathrm{d}E\n$$\n其中 $\\rho_{s}(E)$ 是样品 LDOS，$\\kappa$ 是电子波函数在真空势垒中的衰减长度的倒数，而 $C_{0}$ 是一个包含了仪器因素和基本常数的比例常数。我们假设 $V \\ge 0$。\n\n微分电导 $\\mathrm{d}I/\\mathrm{d}V$ 可通过对 $I(V,z)$ 的表达式应用莱布尼茨积分法则得到：\n$$\n\\frac{\\mathrm{d}I}{\\mathrm{d}V}(V,z) = \\frac{\\mathrm{d}}{\\mathrm{d}V} \\left( C_{0} e^{-2\\kappa z} \\int_{0}^{V} \\rho_{s}(E)\\,\\mathrm{d}E \\right) = C_{0} e^{-2\\kappa z} \\rho_{s}(V)\n$$\n这证实了问题中所述的正比关系 $\\mathrm{d}I/\\mathrm{d}V \\propto \\rho_{s}(V)\\,e^{-2\\kappa z}$。\n\n在扫描隧道谱 (STS) 中，谱图是在一个固定的针尖位置上采集的。该位置 $z_{s}$ 由反馈回路根据设定点条件 $(V_{s}, I_{s})$ 确定，该条件要求 $I(V_{s}, z_{s}) = I_{s}$。从电流的表达式中，我们可以分离出项 $C_{0} e^{-2\\kappa z_{s}}$，它在整个后续的谱学测量中充当一个归一化前因子：\n$$\nI_{s} = C_{0} e^{-2\\kappa z_{s}} \\int_{0}^{V_{s}} \\rho_{s}(E)\\,\\mathrm{d}E\n$$\n$$\n\\implies C_{0} e^{-2\\kappa z_{s}} = \\frac{I_{s}}{\\int_{0}^{V_{s}} \\rho_{s}(E)\\,\\mathrm{d}E}\n$$\n因此，在此设定点下测得的微分电导谱为：\n$$\n\\left(\\frac{\\mathrm{d}I}{\\mathrm{d}V}\\right)_{\\text{meas}}(V) = \\left( C_{0} e^{-2\\kappa z_{s}} \\right) \\rho_{s}(V) = \\left( \\frac{I_{s}}{\\int_{0}^{V_{s}} \\rho_{s}(E)\\,\\mathrm{d}E} \\right) \\rho_{s}(V)\n$$\n注意，未知常数 $C_{0}$ 和 $\\kappa$ 已被消除。测得的电导谱是真实的样品 LDOS $\\rho_{s}(V)$，它被一个归一化因子缩放，该因子完全取决于设定点 $(V_{s}, I_{s})$ 和直到 $V_{s}$ 的积分 LDOS。\n\n问题要求计算在两个不同设定点 $(V_{s1}, I_{s1})$ 和 $(V_{s2}, I_{s2})$ 下，于共振能量 $V=E_{r}$ 处测得的微分电导峰值振幅之比 $R$。让 $V=E_{r}$ 处对应的测量电导分别记为 $(\\mathrm{d}I/\\mathrm{d}V)_{1}$ 和 $(\\mathrm{d}I/\\mathrm{d}V)_{2}$。\n$$\nR = \\frac{\\left.\\left(\\mathrm{d}I/\\mathrm{d}V\\right)_{2}\\right|_{V=E_{r}}}{\\left.\\left(\\mathrm{d}I/\\mathrm{d}V\\right)_{1}\\right|_{V=E_{r}}} = \\frac{\\left( \\frac{I_{s2}}{\\int_{0}^{V_{s2}} \\rho_{s}(E)\\,\\mathrm{d}E} \\right) \\rho_{s}(E_{r})}{\\left( \\frac{I_{s1}}{\\int_{0}^{V_{s1}} \\rho_{s}(E)\\,\\mathrm{d}E} \\right) \\rho_{s}(E_{r})}\n$$\n代表共振处 LDOS 峰值的项 $\\rho_{s}(E_{r})$ 会被消掉。这是一个关键的简化。比率 $R$ 变为：\n$$\nR = \\frac{I_{s2}}{I_{s1}} \\cdot \\frac{\\int_{0}^{V_{s1}} \\rho_{s}(E)\\,\\mathrm{d}E}{\\int_{0}^{V_{s2}} \\rho_{s}(E)\\,\\mathrm{d}E}\n$$\n为计算此表达式，我们必须计算给定 LDOS 模型的定积分 $\\mathcal{I}(V) = \\int_{0}^{V} \\rho_{s}(E)\\,\\mathrm{d}E$。LDOS 给出为：\n$$\n\\rho_{s}(E) = \\rho_{0} + \\frac{A_{L}\\,\\Gamma^{2}}{(E - E_{r})^{2} + \\Gamma^{2}}\n$$\n积分可分为两部分：\n$$\n\\mathcal{I}(V) = \\int_{0}^{V} \\rho_{0} \\,\\mathrm{d}E + \\int_{0}^{V} \\frac{A_{L}\\,\\Gamma^{2}}{(E - E_{r})^{2} + \\Gamma^{2}} \\,\\mathrm{d}E\n$$\n第一个积分是平凡的：\n$$\n\\int_{0}^{V} \\rho_{0} \\,\\mathrm{d}E = \\rho_{0}[E]_{0}^{V} = \\rho_{0}V\n$$\n第二个积分是标准的洛伦兹形式。使用不定积分 $\\int \\frac{a^{2}}{x^{2}+a^{2}} \\,\\mathrm{d}x = a \\arctan(x/a)$，我们令 $x = E - E_{r}$ 和 $a = \\Gamma$：\n$$\n\\int \\frac{\\Gamma^{2}}{(E - E_{r})^{2} + \\Gamma^{2}} \\,\\mathrm{d}E = \\Gamma \\arctan\\left(\\frac{E-E_{r}}{\\Gamma}\\right)\n$$\n计算定积分：\n$$\n\\int_{0}^{V} \\frac{A_{L}\\,\\Gamma^{2}}{(E - E_{r})^{2} + \\Gamma^{2}} \\,\\mathrm{d}E = A_{L}\\Gamma \\left[ \\arctan\\left(\\frac{E-E_{r}}{\\Gamma}\\right) \\right]_{0}^{V} = A_{L}\\Gamma \\left( \\arctan\\left(\\frac{V-E_{r}}{\\Gamma}\\right) - \\arctan\\left(\\frac{-E_{r}}{\\Gamma}\\right) \\right)\n$$\n使用恒等式 $\\arctan(-x) = -\\arctan(x)$，上式简化为：\n$$\n= A_{L}\\Gamma \\left( \\arctan\\left(\\frac{V-E_{r}}{\\Gamma}\\right) + \\arctan\\left(\\frac{E_{r}}{\\Gamma}\\right) \\right)\n$$\n结合两部分，我们得到积分 LDOS 的精确解析表达式：\n$$\n\\mathcal{I}(V) = \\rho_{0}V + A_{L}\\Gamma \\left( \\arctan\\left(\\frac{V-E_{r}}{\\Gamma}\\right) + \\arctan\\left(\\frac{E_{r}}{\\Gamma}\\right) \\right)\n$$\n最后，通过代入该积分的解析形式，比率 $R$ 可以用给定参数表示为：\n$$\nR = \\frac{I_{s2}}{I_{s1}} \\cdot \\frac{\\rho_{0}V_{s1} + A_{L}\\Gamma \\left( \\arctan\\left(\\frac{V_{s1}-E_{r}}{\\Gamma}\\right) + \\arctan\\left(\\frac{E_{r}}{\\Gamma}\\right) \\right)}{\\rho_{0}V_{s2} + A_{L}\\Gamma \\left( \\arctan\\left(\\frac{V_{s2}-E_{r}}{\\Gamma}\\right) + \\arctan\\left(\\frac{E_{r}}{\\Gamma}\\right) \\right)}\n$$\n对于给定的测试用例，直接实现这个最终方程来计算所需的比率。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the ratio of STS peak amplitudes under different setpoints.\n    \"\"\"\n\n    # Each test case is defined as:\n    # (rho0, AL, Gamma, Er, Vs1, Is1, Vs2, Is2)\n    # where all energies are in eV and currents are in A.\n    test_cases = [\n        (1.0, 8.0, 0.005, 0.200, 0.100, 1.0e-9, 0.300, 1.0e-9),\n        (1.0, 10.0, 0.010, 0.200, 0.250, 0.5e-9, 0.250, 1.0e-9),\n        (0.8, 6.0, 0.004, 0.200, 0.200, 1.0e-9, 0.200, 0.8e-9),\n        (1.2, 12.0, 0.001, 0.020, 0.050, 1.0e-9, 0.015, 1.0e-9),\n    ]\n\n    def calculate_integrated_ldos(V_s, rho_0, A_L, Gamma, E_r):\n        \"\"\"\n        Calculates the integral of the LDOS from 0 to V_s analytically.\n        \n        The integral is I(V) = integral_0^V [rho_0 + A_L*Gamma^2/((E-E_r)^2 + Gamma^2)] dE\n        which evaluates to:\n        I(V) = rho_0*V + A_L*Gamma*[arctan((V-E_r)/Gamma) + arctan(E_r/Gamma)]\n        \"\"\"\n        if V_s < 0:\n            # Per problem statement V >= 0. For completeness, we define this.\n            return 0.0\n\n        # Linear background contribution\n        integral_part1 = rho_0 * V_s\n        \n        # Lorentzian peak contribution\n        arg1_arctan = (V_s - E_r) / Gamma\n        arg2_arctan = E_r / Gamma\n        integral_part2 = A_L * Gamma * (np.arctan(arg1_arctan) + np.arctan(arg2_arctan))\n        \n        return integral_part1 + integral_part2\n\n    results = []\n    for case in test_cases:\n        rho_0, A_L, Gamma, E_r, V_s1, I_s1, V_s2, I_s2 = case\n        \n        # Calculate the integrated LDOS for each setpoint voltage\n        integral_1 = calculate_integrated_ldos(V_s1, rho_0, A_L, Gamma, E_r)\n        integral_2 = calculate_integrated_ldos(V_s2, rho_0, A_L, Gamma, E_r)\n        \n        # The ratio of the measured peak heights is given by:\n        # R = (I_s2 / I_s1) * (integral_1 / integral_2)\n        # This holds because the rho_s(E_r) term cancels out.\n        \n        # Problem constraints (rho_0 > 0, V_s >= 0) ensure integral_2 is not zero\n        # unless V_s2 is zero, which is not the case in the test suite.\n        # I_s is also non-zero.\n        \n        ratio = (I_s2 / I_s1) * (integral_1 / integral_2)\n        results.append(ratio)\n\n    # Format the final output as specified in the problem statement.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2856453"}]}