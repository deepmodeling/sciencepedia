{"hands_on_practices": [{"introduction": "我们的探索始于 Fröhlich 极化子的弱耦合极限这一基本情形。该练习将引导你运用经典的 Rayleigh-Schrödinger 微扰理论，计算与晶格振动相互作用的电子的基态能量移动。掌握这一计算对于理解电子-声子相互作用如何产生极化子准粒子并降低其能量至关重要 [@problem_id:2853065]。", "problem": "在三维空间中，一个能带质量为 $m$ 的单导带电子在极性晶体中，根据 Fröhlich 模型与频率为 $\\omega_{\\mathrm{LO}}$ 的无色散纵向光学 (LO) 声子相互作用。在体积为 $V$ 的盒子中施加周期性边界条件。使用正则无量纲极化子单位制，其中能量单位为 $\\hbar \\omega_{\\mathrm{LO}}$，长度单位为 $\\sqrt{\\hbar/(2 m \\omega_{\\mathrm{LO}})}$，从而使得未微扰电子动能为 $k^{2}$，LO 声子能量为 $1$。在这些单位制中，Fröhlich 哈密顿量可以写为\n$$\n\\hat{H} \\;=\\; \\hat{\\mathbf{p}}^{2} \\;+\\; \\sum_{\\mathbf{k}} \\hat{a}_{\\mathbf{k}}^{\\dagger} \\hat{a}_{\\mathbf{k}} \\;+\\; \\sum_{\\mathbf{k}}\\left( V_{\\mathbf{k}} \\, \\mathrm{e}^{i \\mathbf{k}\\cdot \\hat{\\mathbf{r}}} \\hat{a}_{\\mathbf{k}} \\;+\\; V_{\\mathbf{k}}^{\\ast} \\, \\mathrm{e}^{-i \\mathbf{k}\\cdot \\hat{\\mathbf{r}}} \\hat{a}_{\\mathbf{k}}^{\\dagger} \\right),\n$$\n其中电子-声子顶点选用标准的三维归一化形式\n$$\nV_{\\mathbf{k}} \\;=\\; i \\left( \\frac{4 \\pi \\alpha}{V} \\right)^{1/2} \\frac{1}{k},\n$$\n其中 $\\alpha$ 是无量纲的 Fröhlich 耦合常数。\n\n使用非简并 Rayleigh–Schrödinger 微扰理论，对由零动量电子和声子真空组成的未微扰基态展开至 $\\alpha$ 的最低非零阶，通过将动量求和作为连续谱积分来计算，推导在此单位制下的主导弱耦合基态能量移动 $E_{0} \\approx - C_{1} \\alpha$。然后恢复物理单位，写出 $E_{0} \\approx - C_{1} \\alpha \\hbar \\omega_{\\mathrm{LO}}$。确定系数 $C_{1}$。将最终答案表示为一个不带单位的纯数字。", "solution": "出发点是未微扰哈密顿量，它由自由电子和自由声子组成，\n$$\n\\hat{H}_{0} \\;=\\; \\hat{\\mathbf{p}}^{2} \\;+\\; \\sum_{\\mathbf{k}} \\hat{a}_{\\mathbf{k}}^{\\dagger} \\hat{a}_{\\mathbf{k}},\n$$\n以及相互作用\n$$\n\\hat{V} \\;=\\; \\sum_{\\mathbf{k}}\\left( V_{\\mathbf{k}} \\, \\mathrm{e}^{i \\mathbf{k}\\cdot \\hat{\\mathbf{r}}} \\hat{a}_{\\mathbf{k}} \\;+\\; V_{\\mathbf{k}}^{\\ast} \\, \\mathrm{e}^{-i \\mathbf{k}\\cdot \\hat{\\mathbf{r}}} \\hat{a}_{\\mathbf{k}}^{\\dagger} \\right).\n$$\n在指定的无量纲极化子单位制中，未微扰基态是零动量电子平面波与声子真空的直积，\n$$\n\\lvert 0 \\rangle \\;\\equiv\\; \\lvert \\mathbf{k}_{\\mathrm{e}} = \\mathbf{0} \\rangle \\otimes \\lvert \\{0\\}_{\\mathrm{ph}} \\rangle,\n$$\n根据构造，其未微扰能量为 $E_{0}^{(0)} = 0$。一阶 Rayleigh–Schrödinger (RS) 修正是\n$$\nE_{0}^{(1)} \\;=\\; \\langle 0 \\lvert \\hat{V} \\rvert 0 \\rangle \\;=\\; 0,\n$$\n因为 $\\hat{a}_{\\mathbf{k}} \\lvert \\{0\\}_{\\mathrm{ph}} \\rangle = 0$ 且 $\\langle \\{0\\}_{\\mathrm{ph}} \\rvert \\hat{a}_{\\mathbf{k}}^{\\dagger} = 0$，所以线性耦合的真空期望值为零。\n\n因此，主导的非零修正出现在二阶。非简并 RS 二阶基态能量移动为\n$$\nE_{0}^{(2)} \\;=\\; \\sum_{n \\neq 0} \\frac{ \\left| \\langle n \\lvert \\hat{V} \\rvert 0 \\rangle \\right|^{2} }{ E_{0}^{(0)} - E_{n}^{(0)} }.\n$$\n唯一能够产生非零矩阵元的中间态 $\\lvert n \\rangle$ 是那些包含一个动量为 $\\mathbf{q}$ 的 LO 声子，且由于平面波因子 $\\mathrm{e}^{i \\mathbf{q}\\cdot \\hat{\\mathbf{r}}}$ 电子反冲到动量为 $-\\mathbf{q}$ 的态。将这样的态记为 $\\lvert \\mathbf{q} \\rangle \\equiv \\lvert \\mathbf{k}_{\\mathrm{e}} = -\\mathbf{q} \\rangle \\otimes \\lvert 1_{\\mathbf{q}} \\rangle$，其未微扰能量为\n$$\nE_{\\mathbf{q}}^{(0)} \\;=\\; 1 \\;+\\; q^{2},\n$$\n因为在所选单位制中，声子贡献了 $1$，电子贡献了 $q^{2}$。相关的矩阵元是\n$$\n\\langle \\mathbf{q} \\lvert \\hat{V} \\rvert 0 \\rangle \\;=\\; V_{\\mathbf{q}},\n$$\n不计一个在取模平方后会消失的总体相位。因此，\n$$\nE_{0}^{(2)} \\;=\\; - \\sum_{\\mathbf{q}} \\frac{ \\left| V_{\\mathbf{q}} \\right|^{2} }{ 1 + q^{2} }.\n$$\n使用指定的顶点，\n$$\n\\left| V_{\\mathbf{q}} \\right|^{2} \\;=\\; \\frac{4 \\pi \\alpha}{V} \\frac{1}{q^{2}}.\n$$\n通过周期性边界条件的标准替换，过渡到连续谱，\n$$\n\\sum_{\\mathbf{q}} \\;\\to\\; \\frac{V}{(2\\pi)^{3}} \\int d^{3}q,\n$$\n这得到\n$$\nE_{0}^{(2)} \\;=\\; - \\frac{V}{(2\\pi)^{3}} \\int d^{3}q \\, \\frac{4 \\pi \\alpha}{V} \\frac{1}{q^{2}\\left( 1 + q^{2} \\right)} \\;=\\; - \\frac{4 \\pi \\alpha}{(2\\pi)^{3}} \\int d^{3}q \\, \\frac{1}{q^{2}\\left( 1 + q^{2} \\right)}.\n$$\n在球坐标中计算这个收敛的三维积分，\n$$\n\\int d^{3}q \\, \\frac{1}{q^{2}\\left( 1 + q^{2} \\right)} \\;=\\; 4\\pi \\int_{0}^{\\infty} \\frac{dq}{1 + q^{2}} \\;=\\; 4\\pi \\left[ \\arctan(q) \\right]_{0}^{\\infty} \\;=\\; 4\\pi \\cdot \\frac{\\pi}{2} \\;=\\; 2 \\pi^{2}.\n$$\n代入此结果可得\n$$\nE_{0}^{(2)} \\;=\\; - \\frac{4 \\pi \\alpha}{(2\\pi)^{3}} \\cdot 2 \\pi^{2} \\;=\\; - \\alpha.\n$$\n因此，在所选的无量纲极化子单位制中，主导的弱耦合基态能量移动为 $E_{0} \\approx - \\alpha$。\n\n恢复物理单位（能量以 $\\hbar \\omega_{\\mathrm{LO}}$ 为单位测量），可得\n$$\nE_{0} \\;\\approx\\; - \\alpha \\, \\hbar \\omega_{\\mathrm{LO}} \\;\\equiv\\; - C_{1} \\, \\alpha \\, \\hbar \\omega_{\\mathrm{LO}},\n$$\n由此可确定系数为\n$$\nC_{1} \\;=\\; 1.\n$$\n无需四舍五入，且该系数按要求是无量纲的。", "answer": "$$\\boxed{1}$$", "id": "2853065"}, {"introduction": "接下来，我们转向强耦合区域，并使用在晶格电子问题中尤其重要的 Holstein 模型。本练习将介绍强大的 Lang-Firsov 幺正变换，这是一种非微扰方法，能够显式地为电子“穿上”声子云。通过这个实践，你将推导出强耦合对电子迁移率的显著影响：其有效质量 $m^*$ 的指数级增加 [@problem_id:2853079]。", "problem": "考虑一个单电子，它在晶格常数为 $a$ 的 $d$ 维超立方晶格上，由 Holstein 模型描述。该模型包含最近邻电子跃迁振幅 $t$、频率为 $\\omega_0$ 的局域无色散光学声子以及局域电子-声子耦合强度 $g$。Holstein 哈密顿量为\n$$\nH \\;=\\; -\\,t \\sum_{\\langle i,j\\rangle} c_i^{\\dagger} c_j \\;+\\; \\omega_0 \\sum_{i} b_i^{\\dagger} b_i \\;+\\; g \\sum_{i} n_i \\left(b_i + b_i^{\\dagger}\\right),\n$$\n其中 $c_i^{\\dagger}$ 在格点 $i$ 处产生一个电子，$b_i^{\\dagger}$ 在格点 $i$ 处产生一个声子，且 $n_i = c_i^{\\dagger} c_i$。假设系统处于单极化子、零温和稀疏极限。\n\n仅使用基本算符代数和正则变换，进行由下式产生的 Lang-Firsov (LF) 正则变换\n$$\nS \\;=\\; \\frac{g}{\\omega_0} \\sum_{i} n_i \\left(b_i^{\\dagger} - b_i\\right),\n$$\n并且，在变换后的框架中，计算到 $t$ 的最低阶，推导出 $d$ 维空间中小极化子的能带色散 $\\varepsilon_{\\boldsymbol{k}}$。然后在能带最小值附近对小的 $|\\boldsymbol{k}|$ 展开 $\\varepsilon_{\\boldsymbol{k}}$，并通过以下定义提取极化子有效质量 $m^*$\n$$\n\\varepsilon_{\\boldsymbol{k}} \\;=\\; \\varepsilon_{\\boldsymbol{0}} \\;+\\; \\frac{\\hbar^{2} |\\boldsymbol{k}|^{2}}{2 m^*} \\;+\\; \\mathcal{O}\\!\\left(|\\boldsymbol{k}|^{4}\\right),\n$$\n其中 $\\hbar$ 是约化普朗克常数。将裸能带质量 $m_b$ 定义为在没有电子-声子耦合时（即，对于相同的晶格和跃迁振幅 $t$），紧束缚电子的有效质量。\n\n请清楚地说明您使用的任何近似，并确保您的表达式在所述阶数上有效。不要代入任何数值。作为您的最终答案，请报告用 $g/\\omega_0$ 表示的无量纲质量增强因子 $m^*/m_b$ 的解析表达式。最终答案不需要单位。", "solution": "问题要求从 Holstein 哈密顿量出发，推导小极化子的有效质量和质量增强因子 $m^*/m_b$。该推导将通过应用 Lang-Firsov (LF) 正则变换来完成。\n\n给定的 Holstein 哈密顿量是\n$$ H = H_e + H_{ph} + H_{e-ph} = -t \\sum_{\\langle i,j\\rangle} c_i^{\\dagger} c_j + \\omega_0 \\sum_{i} b_i^{\\dagger} b_i + g \\sum_{i} n_i \\left(b_i + b_i^{\\dagger}\\right) $$\n其中 $c_i^{\\dagger}$ ($c_i$) 在格点 $i$ 处产生（湮灭）一个无自旋费米子，$b_i^{\\dagger}$ ($b_i$) 在格点 $i$ 处产生（湮灭）一个局域声子，$n_i = c_i^{\\dagger} c_i$ 是格点 $i$ 处的电子数算符。这些算符遵循标准的正则（反）对易关系：$\\{c_i, c_j^{\\dagger}\\} = \\delta_{ij}$，$\\{c_i, c_j\\} = 0$，以及 $[b_i, b_j^{\\dagger}] = \\delta_{ij}$，$[b_i, b_j] = 0$。\n\nLF 变换是一个由 $U = e^S$ 生成的幺正变换，其中生成元 $S$ 由下式给出\n$$ S = \\frac{g}{\\omega_0} \\sum_{i} n_i \\left(b_i^{\\dagger} - b_i\\right) $$\n生成元 $S$ 是反厄米（anti-Hermitian）的，$S^{\\dagger} = -S$，这确保了 $U$ 是幺正的，即 $U^{\\dagger} = U^{-1} = e^{-S}$。变换后的哈密顿量为 $\\tilde{H} = U H U^{\\dagger} = e^S H e^{-S}$。我们将每个算符 $A$ 变换为 $\\tilde{A} = e^S A e^{-S}$。这可以使用 Baker-Campbell-Hausdorff (BCH) 展开式进行展开：$\\tilde{A} = A + [S, A] + \\frac{1}{2!}[S, [S, A]] + \\dots$。\n\n首先，我们求出基本算符的变换。\n1.  声子算符的变换 $\\tilde{b}_k = e^S b_k e^{-S}$：\n对易子为 $[S, b_k] = \\left[ \\frac{g}{\\omega_0} \\sum_j n_j (b_j^{\\dagger} - b_j), b_k \\right] = \\frac{g}{\\omega_0} n_k [b_k^{\\dagger} - b_k, b_k] = \\frac{g}{\\omega_0} n_k [b_k^{\\dagger}, b_k] = -\\frac{g}{\\omega_0} n_k$。\n第二个对易子是 $[S, [S, b_k]] = [S, -\\frac{g}{\\omega_0}n_k] = 0$，因为对于一个给定的格点，$S$ 只包含该格点的声子算符，它们与其他格点的电子算符 $n_k$ 对易，并且 $[n_k(b_k^\\dagger - b_k), n_k] = 0$。\n因此，BCH 级数截断为：$\\tilde{b}_k = b_k + [S, b_k] = b_k - \\frac{g}{\\omega_0} n_k$。\n其厄米共轭为 $\\tilde{b}_k^{\\dagger} = b_k^{\\dagger} - \\frac{g}{\\omega_0} n_k$。\n\n2.  电子算符的变换 $\\tilde{c}_k = e^S c_k e^{-S}$：\n费米子算符的相关性质是 $[n_k, c_k] = [c_k^{\\dagger}c_k, c_k] = -c_k$。\n对易子为 $[S, c_k] = \\left[ \\frac{g}{\\omega_0} \\sum_j n_j (b_j^{\\dagger} - b_j), c_k \\right] = \\frac{g}{\\omega_0} [n_k, c_k] (b_k^{\\dagger} - b_k) = -\\frac{g}{\\omega_0} c_k (b_k^{\\dagger} - b_k)$。\n为了计算更高阶的对易子，我们需要 $[S, b_k^\\dagger-b_k]$。\n$[S, b_k^\\dagger] = \\frac{g}{\\omega_0} n_k [b_k^\\dagger-b_k,b_k^\\dagger] = \\frac{g}{\\omega_0}n_k(-[b_k,b_k^\\dagger]) = -\\frac{g}{\\omega_0}n_k$。\n这个结果以及关于 $[S,b_k]$ 的结果给出 $[S, b_k^{\\dagger} - b_k] = [S, b_k^{\\dagger}] - [S, b_k] = (-\\frac{g}{\\omega_0}n_k) - (-\\frac{g}{\\omega_0}n_k) = 0$。\n在 $[S, c_k]$ 中的算符项 $(b_k^{\\dagger} - b_k)$ 与 $S$ 对易。这简化了 BCH 级数：\n$[S, [S, c_k]] = [S, -\\frac{g}{\\omega_0} c_k (b_k^{\\dagger} - b_k)] = -\\frac{g}{\\omega_0} [S, c_k](b_k^{\\dagger} - b_k) = \\left(-\\frac{g}{\\omega_0}\\right)^2 c_k (b_k^{\\dagger} - b_k)^2$。\n$p$ 阶对易子是 $[S, \\dots [S, c_k]\\dots]_p = \\left(-\\frac{g}{\\omega_0}\\right)^p c_k (b_k^{\\dagger} - b_k)^p$。\n对级数求和得到：\n$$ \\tilde{c}_k = \\sum_{p=0}^{\\infty} \\frac{1}{p!} \\left(-\\frac{g}{\\omega_0}\\right)^p c_k (b_k^{\\dagger} - b_k)^p = c_k \\exp\\left(-\\frac{g}{\\omega_0}(b_k^{\\dagger} - b_k)\\right) $$\n类似地，对于 $c_k^{\\dagger}$，有 $[n_k, c_k^{\\dagger}]=c_k^{\\dagger}$，所以 $[S, c_k^{\\dagger}] = +\\frac{g}{\\omega_0} c_k^{\\dagger} (b_k^{\\dagger} - b_k)$。\n$$ \\tilde{c}_k^{\\dagger} = c_k^{\\dagger} \\exp\\left(\\frac{g}{\\omega_0}(b_k^{\\dagger} - b_k)\\right) $$\n此外，$\\tilde{n}_k = \\tilde{c}_k^{\\dagger}\\tilde{c}_k = c_k^{\\dagger}c_k = n_k$，所以数算符是不变的。\n\n现在我们变换哈密顿量 $H$。\n声子和电子-声子部分合并为：\n$\\tilde{H}_{ph} + \\tilde{H}_{e-ph} = \\omega_0 \\sum_i \\tilde{b}_i^{\\dagger}\\tilde{b}_i + g \\sum_i \\tilde{n}_i(\\tilde{b}_i+\\tilde{b}_i^{\\dagger})$\n$= \\omega_0 \\sum_i \\left(b_i^{\\dagger} - \\frac{g}{\\omega_0}n_i\\right)\\left(b_i - \\frac{g}{\\omega_0}n_i\\right) + g \\sum_i n_i \\left(b_i - \\frac{g}{\\omega_0}n_i + b_i^{\\dagger} - \\frac{g}{\\omega_0}n_i\\right)$\n$= \\omega_0 \\sum_i \\left(b_i^{\\dagger}b_i - \\frac{g}{\\omega_0}n_i(b_i^{\\dagger}+b_i) + \\frac{g^2}{\\omega_0^2}n_i^2\\right) + g \\sum_i n_i(b_i+b_i^{\\dagger}) - \\frac{2g^2}{\\omega_0}\\sum_i n_i^2$\n$= \\omega_0 \\sum_i b_i^{\\dagger}b_i - g \\sum_i n_i(b_i+b_i^{\\dagger}) + \\frac{g^2}{\\omega_0}\\sum_i n_i^2 + g \\sum_i n_i(b_i+b_i^{\\dagger}) - \\frac{2g^2}{\\omega_0}\\sum_i n_i^2$\n$= \\omega_0 \\sum_i b_i^{\\dagger}b_i - \\frac{g^2}{\\omega_0}\\sum_i n_i^2$。\n在单电子扇区，$n_i^2=n_i$。所以这变为 $H_{ph} - \\frac{g^2}{\\omega_0}\\sum_i n_i$。\n\n电子跃迁项变换为：\n$\\tilde{H}_e = -t \\sum_{\\langle i,j\\rangle} \\tilde{c}_i^{\\dagger} \\tilde{c}_j = -t \\sum_{\\langle i,j\\rangle} c_i^{\\dagger} \\exp\\left(\\frac{g}{\\omega_0}(b_i^{\\dagger}-b_i)\\right) c_j \\exp\\left(-\\frac{g}{\\omega_0}(b_j^{\\dagger}-b_j)\\right)$。\n由于 $i \\ne j$，电子算符与另一格点上的声子算符对易。令 $X_i = \\exp\\left(-\\frac{g}{\\omega_0}(b_i^{\\dagger} - b_i)\\right)$。\n$\\tilde{H}_e = -t \\sum_{\\langle i,j\\rangle} c_i^{\\dagger} c_j X_i^{-1} X_j$。\n\n总的变换后的哈密顿量是：\n$$ \\tilde{H} = -\\frac{g^2}{\\omega_0}\\sum_i n_i + \\omega_0 \\sum_i b_i^{\\dagger}b_i - t \\sum_{\\langle i,j\\rangle} c_i^{\\dagger} c_j X_i^{-1} X_j $$\n对于单个电子，$\\sum_i n_i = 1$，所以第一项是一个恒定的极化子束缚能 $E_p = -g^2/\\omega_0$。\n现在的问题是求解 $\\tilde{H}$ 的能谱。我们在小极化子极限下工作，其中跃迁 $t$ 与耦合 $g$ 相比很小。我们将跃迁项视为微扰。到 $t$ 的最低阶，极化子色散是通过计算 $\\tilde{H}$ 相对于零温声子基态 $|0\\rangle_{ph}$ 的期望值得到的，该基态被所有 $b_i$ 湮灭。这给出了一个有效的电子哈密顿量。\n$$ H_{eff} = \\langle 0 |_{ph} \\tilde{H} | 0 \\rangle_{ph} = E_p - t_{eff} \\sum_{\\langle i,j\\rangle} c_i^{\\dagger} c_j $$\n其中 $t_{eff} = t \\langle 0 |_{ph} X_i^{-1} X_j | 0 \\rangle_{ph}$。由于不同格点上的声子算符对易，所以有 $t_{eff} = t \\langle 0 |_{ph} X_i^{-1} | 0 \\rangle_{ph} \\langle 0 |_{ph} X_j | 0 \\rangle_{ph}$。\n我们使用当 $[A,B]$ 为 c-数时的 BCH 公式 $e^{A+B}=e^A e^B e^{-[A,B]/2}$ 来计算此期望值。\n$\\langle 0 | X_j | 0 \\rangle = \\langle 0 | \\exp(-\\frac{g}{\\omega_0}(b_j^{\\dagger}-b_j)) | 0 \\rangle = \\langle 0 | \\exp(-\\frac{g}{\\omega_0}b_j^{\\dagger})\\exp(\\frac{g}{\\omega_0}b_j) \\exp(-\\frac{1}{2}[-\\frac{g}{\\omega_0}b_j^{\\dagger}, \\frac{g}{\\omega_0}b_j]) | 0 \\rangle$。\n指数中的对易子是 $-\\frac{1}{2}(\\frac{g}{\\omega_0})^2[b_j^{\\dagger},-b_j] = -\\frac{1}{2}(\\frac{g}{\\omega_0})^2$。\n由于 $b_j|0\\rangle_{ph}=0$ 且 $\\langle 0|_{ph}b_j^{\\dagger}=0$，我们得到 $\\langle 0 | \\exp(\\frac{g}{\\omega_0} b_j)|0\\rangle = 1$ 且 $\\langle 0 | \\exp(-\\frac{g}{\\omega_0} b_j^{\\dagger})|0\\rangle=1$。\n因此，$\\langle 0 | X_j | 0 \\rangle = \\exp\\left(-\\frac{1}{2}(g/\\omega_0)^2\\right)$。\n类似地，$\\langle 0 | X_i^{-1} | 0 \\rangle = \\langle 0 | \\exp\\left(\\frac{g}{\\omega_0}(b_i^{\\dagger}-b_i)\\right) | 0 \\rangle = \\exp\\left(-\\frac{1}{2}(g/\\omega_0)^2\\right)$。\n所以有效跃迁振幅为 $t_{eff} = t \\exp\\left(-(g/\\omega_0)^2\\right)$。\n\n有效哈密顿量描述了一个在紧束缚能带中运动的极化子，其跃迁振幅减小为 $t_{eff}$：\n$$ H_{polaron} = -\\frac{g^2}{\\omega_0} - t_{eff} \\sum_{\\langle i,j\\rangle} c_i^{\\dagger} c_j $$\n这个哈密顿量在 $d$ 维超立方晶格上的色散关系通过傅里叶变换 $c_j = \\frac{1}{\\sqrt{N}}\\sum_{\\boldsymbol{k}} e^{i\\boldsymbol{k}\\cdot \\boldsymbol{R}_j} c_{\\boldsymbol{k}}$ 求得：\n$$ \\varepsilon_{\\boldsymbol{k}} = -\\frac{g^2}{\\omega_0} - t_{eff} \\sum_{\\boldsymbol{\\delta}} e^{i\\boldsymbol{k}\\cdot\\boldsymbol{\\delta}} = -\\frac{g^2}{\\omega_0} - 2t_{eff} \\sum_{l=1}^d \\cos(k_l a) $$\n其中 $\\boldsymbol{\\delta}$ 是最近邻矢量。代入 $t_{eff}$：\n$$ \\varepsilon_{\\boldsymbol{k}} = -\\frac{g^2}{\\omega_0} - 2t\\exp\\left(-\\left(\\frac{g}{\\omega_0}\\right)^2\\right) \\sum_{l=1}^d \\cos(k_l a) $$\n为了求有效质量 $m^*$，我们在能带最小值 $\\boldsymbol{k}=\\boldsymbol{0}$ 附近对小的 $|\\boldsymbol{k}|$ 展开 $\\varepsilon_{\\boldsymbol{k}}$。使用 $\\cos(x) \\approx 1 - x^2/2$：\n$$ \\varepsilon_{\\boldsymbol{k}} \\approx -\\frac{g^2}{\\omega_0} - 2t_{eff} \\sum_{l=1}^d \\left(1 - \\frac{(k_l a)^2}{2}\\right) = -\\frac{g^2}{\\omega_0} - 2dt_{eff} + t_{eff} a^2 \\sum_{l=1}^d k_l^2 $$\n能带最小能量是 $\\varepsilon_{\\boldsymbol{0}} = -g^2/\\omega_0 - 2dt_{eff}$。所以，\n$$ \\varepsilon_{\\boldsymbol{k}} \\approx \\varepsilon_{\\boldsymbol{0}} + t_{eff} a^2 |\\boldsymbol{k}|^2 = \\varepsilon_{\\boldsymbol{0}} + t a^2 \\exp\\left(-\\left(\\frac{g}{\\omega_0}\\right)^2\\right) |\\boldsymbol{k}|^2 $$\n将此与有效质量的定义 $\\varepsilon_{\\boldsymbol{k}} = \\varepsilon_{\\boldsymbol{0}} + \\frac{\\hbar^2 |\\boldsymbol{k}|^2}{2m^*}$ 相比较，我们确定：\n$$ \\frac{\\hbar^2}{2m^*} = t a^2 \\exp\\left(-\\left(\\frac{g}{\\omega_0}\\right)^2\\right) \\implies m^* = \\frac{\\hbar^2}{2ta^2} \\exp\\left(\\left(\\frac{g}{\\omega_0}\\right)^2\\right) $$\n裸能带质量 $m_b$ 对应于没有电子-声子耦合的情况（$g=0$）。在此极限下，$t_{eff}=t$。裸电子色散是 $\\varepsilon_{\\boldsymbol{k}}^{bare} = -2t \\sum_{l=1}^d \\cos(k_l a)$。其对小 $|\\boldsymbol{k}|$ 的展开式是 $\\varepsilon_{\\boldsymbol{k}}^{bare} \\approx \\varepsilon_{\\boldsymbol{0}}^{bare} + ta^2|\\boldsymbol{k}|^2$。\n从定义 $\\varepsilon_{\\boldsymbol{k}}^{bare} = \\varepsilon_{\\boldsymbol{0}}^{bare} + \\frac{\\hbar^2 |\\boldsymbol{k}|^2}{2m_b}$，我们得到：\n$$ \\frac{\\hbar^2}{2m_b} = ta^2 \\implies m_b = \\frac{\\hbar^2}{2ta^2} $$\n无量纲质量增强是比值 $m^*/m_b$：\n$$ \\frac{m^*}{m_b} = \\frac{\\frac{\\hbar^2}{2ta^2} \\exp\\left(\\left(\\frac{g}{\\omega_0}\\right)^2\\right)}{\\frac{\\hbar^2}{2ta^2}} = \\exp\\left(\\left(\\frac{g}{\\omega_0}\\right)^2\\right) $$\n这表明，极化子质量因无量纲耦合强度 $g/\\omega_0$ 的平方而被指数级增强。", "answer": "$$\\boxed{\\exp\\left(\\left(\\frac{g}{\\omega_0}\\right)^2\\right)}$$", "id": "2853079"}, {"introduction": "为了将我们的理论模型与现代计算物理学联系起来，这最后一个实践解决了一个关键挑战：如何从数值模拟中提取物理可观测量。你将实现一个解析延拓程序，从模拟量子蒙特卡洛（QMC）计算结果的虚时格林函数合成数据中，确定极化子的色散关系 $E(\\mathbf{k})$。这个动手编程练习可以让你实际地理解，诸如谱函数和准粒子峰等理论概念是如何从计算数据中被揭示出来的 [@problem_id:3010624]。", "problem": "考虑一个单极化子问题，其中一个电子与无色散光学声子浴相互作用，在低能区产生一个明确定义的准粒子，并在高能区产生一个非相干连续谱。在零温下，对于 $\\tau>0$ 的电子增添虚时格林函数 $G(\\mathbf{k},\\tau)$ 具有一个以非负谱函数 $A^{+}(\\mathbf{k},\\omega)$ 表示的Lehmann表示，该谱函数的支撑集在 $\\omega \\ge 0$ 上。从基础的多体形式理论出发，使用谱表示和拉普拉斯变换的逆变换来提取极化子色散关系 $E(\\mathbf{k})$。\n\n你的推导必须基于以下经过充分检验的事实和定义：\n- 电子增添谱函数的Lehmann表示意味着，在零温下且对于 $\\tau>0$，虚时格林函数满足\n$$\nG(\\mathbf{k},\\tau) = -\\int_{0}^{\\infty} d\\omega\\, A^{+}(\\mathbf{k},\\omega) e^{-\\omega \\tau},\n$$\n其中 $A^{+}(\\mathbf{k},\\omega)\\ge 0$ 代表了增添一个动量为 $\\mathbf{k}$、能量为 $\\omega$ 的电子的概率幅密度。\n- 低能准粒子峰将极化子色散关系 $E(\\mathbf{k})$ 定义为 $A^{+}(\\mathbf{k},\\omega)$ 中能量最低的孤立峰的位置。\n\n你必须通过在非负性和光滑性约束下对上述积分方程进行求逆，来实现一个从虚时到实频的解析延拓过程。具体来说：\n- 将 $\\omega$ 在间距为 $\\Delta \\omega$ 的均匀网格 $\\{\\omega_j\\}_{j=0}^{N_\\omega-1}$ 上离散化，将 $\\tau$ 在均匀网格 $\\{\\tau_i\\}_{i=0}^{N_\\tau-1}$ 上离散化。\n- 通过一个线性系统来近似该积分方程\n$$\nG_i \\approx \\sum_{j=0}^{N_\\omega-1} K_{ij} A_j, \\quad K_{ij} = e^{-\\omega_j \\tau_i}\\Delta \\omega,\n$$\n其中 $A_j \\approx A^{+}(\\mathbf{k},\\omega_j)$。\n- 通过求解一个正则化的非负最小二乘 (NNLS) 问题来恢复 $A_j$\n$$\n\\min_{A_j \\ge 0} \\left\\| K A - G \\right\\|_2^2 + \\lambda \\left\\| L A \\right\\|_2^2,\n$$\n其中 $L$ 是一个施加光滑性约束的一阶差分算子，而 $\\lambda>0$ 是一个正则化强度。通过将系统增广为\n$$\n\\begin{pmatrix}\nK \\\\\n\\sqrt{\\lambda} L\n\\end{pmatrix} A \\approx\n\\begin{pmatrix}\nG \\\\\n0\n\\end{pmatrix},\n$$\n并对 $A$ 求解 NNLS 来实现这一点。\n- 将 $E(\\mathbf{k})$ 确定为 $A^{+}(\\mathbf{k},\\omega)$ 中能量最低的显著局域最大值的位置 $\\omega$。\n\n你的程序必须实现此处理流程，并针对一个由已知谱函数生成的类量子蒙特卡洛合成数据组成的指定测试套件，输出极化子色散关系。所有能量必须以毫电子伏 (meV) 为单位表示，虚时以毫电子伏的倒数 ($\\mathrm{meV}^{-1}$) 为单位。角度单位在此不适用。输出的能量必须四舍五入到六位小数。\n\n测试套件的数据生成必须使用具有物理动机的谱函数，其形式为\n$$\nA^{+}(\\mathbf{k},\\omega) = Z(\\mathbf{k})\\, \\frac{1}{\\sqrt{2\\pi}\\sigma_{\\mathrm{pk}}}\\exp\\!\\left(-\\frac{[\\omega - E(\\mathbf{k})]^2}{2\\sigma_{\\mathrm{pk}}^2}\\right) + A_{\\mathrm{cont}}\\, \\frac{1}{\\sqrt{2\\pi}\\sigma_{\\mathrm{cont}}}\\exp\\!\\left(-\\frac{[\\omega - \\omega_{\\mathrm{cont}}]^2}{2\\sigma_{\\mathrm{cont}}^2}\\right),\n$$\n其中 $Z(\\mathbf{k})$ 是准粒子权重，$\\sigma_{\\mathrm{pk}}$ 是一个近似 $\\delta$ 峰的小宽度，$A_{\\mathrm{cont}}$ 是非相干连续谱的积分权重（因此连续谱高斯函数的积分为 $A_{\\mathrm{cont}}$），而 $\\omega_{\\mathrm{cont}}$、$\\sigma_{\\mathrm{cont}}$ 是其中心和宽度。极化子色散关系在其最小值附近被建模为抛物线型，\n$$\nE(\\mathbf{k}) = E_0 + a\\, |\\mathbf{k}|^2,\n$$\n其中 $E_0$ 的单位是 meV，$a$ 的单位是 $\\mathrm{meV}\\cdot\\mathrm{nm}^2$。这种简化的有效质量形式是一种标准的低$\\mathbf{k}$近似，并且足以用于生成测试数据。\n\n实现以下测试套件。对于每个测试用例，在 $\\omega \\in [0, \\omega_{\\max}]$ 的网格上构造 $A^{+}(\\mathbf{k},\\omega)$，其中 $\\omega_{\\max} = 300\\,\\mathrm{meV}$ 且 $\\Delta\\omega = 1\\,\\mathrm{meV}$；通过在一个 $\\tau \\in [\\tau_{\\min}, \\tau_{\\max}]$ 的网格上对积分进行离散化来构造 $G(\\mathbf{k},\\tau)$，其中 $\\tau_{\\min}=0.05\\,\\mathrm{meV}^{-1}$，$\\tau_{\\max}=5.00\\,\\mathrm{meV}^{-1}$，且有 $N_\\tau=100$ 个均匀间隔的点；并添加均值为零、标准差等于该用例中 $G(\\mathbf{k},\\tau)$ 最大值的 $10^{-4}$ 倍的小高斯噪声。\n\n测试套件参数集：\n- 用例1（一般情况）：$|\\mathbf{k}| = 0.50\\,\\mathrm{nm}^{-1}$, $E_0 = 20\\,\\mathrm{meV}$, $a = 8\\,\\mathrm{meV}\\cdot\\mathrm{nm}^2$, $Z(\\mathbf{k}) = 0.7$, $A_{\\mathrm{cont}} = 0.3$, $\\omega_{\\mathrm{cont}} = 110\\,\\mathrm{meV}$, $\\sigma_{\\mathrm{cont}} = 35\\,\\mathrm{meV}$, $\\sigma_{\\mathrm{pk}} = 2\\,\\mathrm{meV}$。\n- 用例2（重准粒子）：$|\\mathbf{k}| = 1.50\\,\\mathrm{nm}^{-1}$, $E_0 = 30\\,\\mathrm{meV}$, $a = 3\\,\\mathrm{meV}\\cdot\\mathrm{nm}^2$, $Z(\\mathbf{k}) = 0.5$, $A_{\\mathrm{cont}} = 0.6$, $\\omega_{\\mathrm{cont}} = 90\\,\\mathrm{meV}$, $\\sigma_{\\mathrm{cont}} = 50\\,\\mathrm{meV}$, $\\sigma_{\\mathrm{pk}} = 2\\,\\mathrm{meV}$。\n- 用例3（低准粒子权重，强连续谱）：$|\\mathbf{k}| = 0.10\\,\\mathrm{nm}^{-1}$, $E_0 = 12\\,\\mathrm{meV}$, $a = 5\\,\\mathrm{meV}\\cdot\\mathrm{nm}^2$, $Z(\\mathbf{k}) = 0.2$, $A_{\\mathrm{cont}} = 0.9$, $\\omega_{\\mathrm{cont}} = 80\\,\\mathrm{meV}$, $\\sigma_{\\mathrm{cont}} = 60\\,\\mathrm{meV}$, $\\sigma_{\\mathrm{pk}} = 2\\,\\mathrm{meV}$。\n\n使用正则化强度 $\\lambda = 10^{-2}$ 和由下式定义的一阶差分矩阵 $L$\n$$\n(LA)_j = A_{j} - A_{j+1}, \\quad j=0,\\dots,N_\\omega-2.\n$$\n\n峰值识别规则：在离散网格上确定 $A^{+}(\\mathbf{k},\\omega)$ 的局域最大值。在满足 $\\omega \\le \\omega_{\\mathrm{search}}$ 且幅度大于全局最大值 $\\alpha$ 倍的局域最大值中，选择 $\\omega$ 最小的那个。使用 $\\omega_{\\mathrm{search}} = 60\\,\\mathrm{meV}$ 和 $\\alpha = 0.05$。如果没有局域最大值满足这些标准，则选择 $\\omega \\le \\omega_{\\mathrm{search}}$ 限制范围内的全局最大值。\n\n你的程序应为上述测试套件生成单行输出，其中包含提取出的三个色散值 $[E(\\mathbf{k}_1),E(\\mathbf{k}_2),E(\\mathbf{k}_3)]$，形式为用方括号括起来的逗号分隔列表，每个能量值单位为 meV 并四舍五入到六位小数，精确格式为：\n$[E_1,E_2,E_3]$。", "solution": "这个问题的核心任务是通过分析合成的虚时格林函数数据 $G(\\mathbf{k},\\tau)$ 来确定极化子色散关系 $E(\\mathbf{k})$。这是计算凝聚态物理中的一个常见问题，尤其是在采用量子蒙特卡洛 (QMC) 方法的研究中，因为该方法天然地在虚时中进行运算。其解决方案需要执行一个从虚时 $\\tau$ 到实频 $\\omega$ 的解析延拓，这是一个在数值上具有挑战性的过程。\n\n该过程的理论基础是Lehmann谱表示。在零温 ($T=0$) 下，动量为 $\\mathbf{k}$ 的电子的增添虚时格林函数 $G(\\mathbf{k},\\tau)$ 通过一个拉普拉斯变换与其对应的谱函数 $A^{+}(\\mathbf{k},\\omega)$ 相关联：\n$$\nG(\\mathbf{k},\\tau) = -\\int_{0}^{\\infty} d\\omega\\, A^{+}(\\mathbf{k},\\omega) e^{-\\omega \\tau} \\quad (\\text{for } \\tau>0)\n$$\n谱函数 $A^{+}(\\mathbf{k},\\omega)$ 是一个非负量，表示向系统中增添一个动量为 $\\mathbf{k}$、能量为 $\\omega$ 的电子的概率密度。极化子是一种由电子被声子云“缀饰”而形成的准粒子，它在 $A^{+}(\\mathbf{k},\\omega)$ 的最低能量处表现为一个清晰的尖锐峰。这个峰的位置定义了极化子色散关系 $E(\\mathbf{k})$。我们的目标是从 $G(\\mathbf{k},\\tau)$ 的含噪声数据中恢复 $A^{+}(\\mathbf{k},\\omega)$，然后定位这个峰。\n\n拉普拉斯逆变换是一个经典的不适定问题；输入数据 $G(\\mathbf{k},\\tau)$ 中的微小噪声可能导致恢复出的解 $A^{+}(\\mathbf{k},\\omega)$ 出现大的、非物理的振荡。为了获得稳定且具有物理意义的解，我们采用指定的正则化反演方案。\n\n第一步是离散化问题。我们在均匀网格上表示连续函数：$\\tau$ 在网格 $\\{\\tau_i\\}_{i=0}^{N_\\tau-1}$上，$\\omega$ 在网格 $\\{\\omega_j\\}_{j=0}^{N_\\omega-1}$ 上。积分方程随后变成一个线性方程组。令 $D_i = -G(\\mathbf{k},\\tau_i) > 0$。离散化后的关系式为：\n$$\nD_i = \\int_{0}^{\\infty} d\\omega\\, A^{+}(\\mathbf{k},\\omega) e^{-\\omega \\tau_i} \\approx \\sum_{j=0}^{N_\\omega-1} A^{+}(\\mathbf{k},\\omega_j) e^{-\\omega_j \\tau_i} \\Delta\\omega\n$$\n这可以写成矩阵形式 $D \\approx K A$，其中 $A$ 是未知谱函数值 $A_j = A^{+}(\\mathbf{k},\\omega_j)$ 的向量，$D$ 是输入数据 $D_i$ 的向量，$K$ 是核矩阵，其元素为 $K_{ij} = e^{-\\omega_j \\tau_i} \\Delta\\omega$。\n\n为了对抗这种反演的不适定性，我们引入两个约束。第一，谱函数必须非负的物理要求，即 $A_j \\ge 0$。第二，我们添加一个Tikhonov正则化项，对解施加光滑性约束。这是通过最小化一个复合目标函数来实现的：\n$$\n\\min_{A \\ge 0} \\left\\| K A - D \\right\\|_2^2 + \\lambda \\left\\| L A \\right\\|_2^2\n$$\n此处，$\\| \\cdot \\|_2^2$ 表示欧几里得范数的平方，$\\lambda$ 是一个正的正则化参数，它控制着数据拟合与解的光滑度之间的权衡，$L$ 是一个近似微分算子的矩阵。问题指定了一个一阶差分算子 $(LA)_j = A_j - A_{j+1}$，它会对谱中相邻点之间的大跳跃进行惩罚。\n\n这个带有非负约束的正则化最小化问题，可以方便地重新表述为一个标准的非负最小二乘 (NNLS) 问题。我们构造一个增广矩阵和一个增广数据向量：\n$$\n\\tilde{K} = \\begin{pmatrix} K \\\\ \\sqrt{\\lambda} L \\end{pmatrix}, \\quad \\tilde{D} = \\begin{pmatrix} D \\\\ \\mathbf{0} \\end{pmatrix}\n$$\n问题于是等价于求解 $\\min_{\\tilde{A} \\ge 0} \\| \\tilde{K} \\tilde{A} - \\tilde{D} \\|_2^2$，对此存在高效的数值求解器，例如 `scipy.optimize.nnls`。\n\n对于每个测试用例，整体算法按如下步骤进行：\n1.  **数据合成**：我们首先生成合成的“实验”数据。一个具有物理动机的谱函数 $A^{+}(\\mathbf{k},\\omega)$ 被构造为一个用于极化子峰的尖锐高斯函数和一个用于非相干连续谱的宽阔高斯函数之和。极化子峰的位置 $E(\\mathbf{k})$ 由抛物线有效质量近似 $E(\\mathbf{k}) = E_0 + a|\\mathbf{k}|^2$ 给出。通过将这个 $A^{+}(\\mathbf{k},\\omega)$ 与拉普拉斯核 $e^{-\\omega \\tau_i}$ 进行数值积分来计算格林函数 $G(\\mathbf{k},\\tau_i)$。最后，添加少量高斯噪声以模拟实验不确定性。求解器的输入向量则设为 $D_i = -G_{\\text{noisy}}(\\mathbf{k},\\tau_i)$。\n\n2.  **解析延拓**：使用给定的参数（$\\lambda$、网格定义等）构造增广线性系统 $(\\tilde{K}, \\tilde{D})$。求解 NNLS 问题以获得重构的谱函数 $A_{\\text{recon}}$。\n\n3.  **峰值识别**：最后一步是从 $A_{\\text{recon}}$ 中提取极化子能量。我们在重构的谱中识别所有的局域最大值。根据指定的规则，我们筛选这些最大值，只考虑那些低于搜索能量截断 $\\omega_{\\mathrm{search}} = 60\\,\\mathrm{meV}$ 且幅度超过 $A_{\\text{recon}}$ 全局最大值 $\\alpha=0.05$ 倍的峰。然后，极化子能量 $E(\\mathbf{k})$ 被确定为满足这些标准的频率最低的峰的能量。如果找不到这样的峰，一个备用方案将选择搜索区域 $\\omega \\le \\omega_{\\text{search}}$ 内的全局最大值。\n\n该过程为从虚时关联数据中提取谱信息提供了一种稳健且标准的方法论，这是现代计算物理学中的一项基本任务。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Solves the polaron dispersion problem by performing analytic continuation\n    on synthetic imaginary-time Green's function data.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {  # Case 1 (general case)\n            \"k_mag\": 0.50, \"E0\": 20.0, \"a\": 8.0, \"Zk\": 0.7, \"A_cont\": 0.3,\n            \"omega_cont\": 110.0, \"sigma_cont\": 35.0, \"sigma_pk\": 2.0\n        },\n        {  # Case 2 (heavy quasiparticle)\n            \"k_mag\": 1.50, \"E0\": 30.0, \"a\": 3.0, \"Zk\": 0.5, \"A_cont\": 0.6,\n            \"omega_cont\": 90.0, \"sigma_cont\": 50.0, \"sigma_pk\": 2.0\n        },\n        {  # Case 3 (low quasiparticle weight, strong continuum)\n            \"k_mag\": 0.10, \"E0\": 12.0, \"a\": 5.0, \"Zk\": 0.2, \"A_cont\": 0.9,\n            \"omega_cont\": 80.0, \"sigma_cont\": 60.0, \"sigma_pk\": 2.0\n        }\n    ]\n\n    # --- Global parameters ---\n    # Grids\n    omega_max = 300.0\n    delta_omega = 1.0\n    tau_min = 0.05\n    tau_max = 5.00\n    N_tau = 100\n    \n    # Analytic continuation parameters\n    reg_lambda = 1e-2\n    \n    # Peak identification parameters\n    omega_search = 60.0\n    alpha_threshold = 0.05\n    \n    # Use a seeded random number generator for reproducibility\n    rng = np.random.default_rng(42)\n\n    # --- Setup grids ---\n    omega_grid = np.arange(0, omega_max + delta_omega, delta_omega)\n    N_omega = len(omega_grid)\n    tau_grid = np.linspace(tau_min, tau_max, N_tau)\n\n    results = []\n    \n    for params in test_cases:\n        # --- 1. Generate synthetic data ---\n        \n        # True polaron dispersion energy\n        E_k_true = params[\"E0\"] + params[\"a\"] * params[\"k_mag\"]**2\n        \n        # Spectral function A(k, w)\n        def gaussian(x, mu, sigma):\n            return 1.0 / (np.sqrt(2 * np.pi) * sigma) * np.exp(-(x - mu)**2 / (2 * sigma**2))\n            \n        A_peak = params[\"Zk\"] * gaussian(omega_grid, E_k_true, params[\"sigma_pk\"])\n        A_continuum = params[\"A_cont\"] * gaussian(omega_grid, params[\"omega_cont\"], params[\"sigma_cont\"])\n        A_true = A_peak + A_continuum\n        \n        # Imaginary-time Green's function G(k, tau)\n        # G(tau) = - integral A(w) * exp(-w*tau) dw\n        kernel_for_integration = np.exp(-np.outer(tau_grid, omega_grid))\n        G_true = -delta_omega * (kernel_for_integration @ A_true)\n        \n        # Add a small amount of Gaussian noise\n        noise_std_dev = 1e-4 * np.max(np.abs(G_true))\n        noise = rng.normal(loc=0.0, scale=noise_std_dev, size=N_tau)\n        G_noisy = G_true + noise\n        \n        # The input data for the least-squares problem is D = -G\n        D_data = -G_noisy\n        \n        # --- 2. Perform Analytic Continuation ---\n        \n        # Construct kernel matrix K for the linear system D = KA\n        # K_ij = exp(-w_j * tau_i) * delta_omega\n        K = kernel_for_integration * delta_omega\n        \n        # Construct the first-difference regularization matrix L\n        # (LA)_j = A_j - A_{j+1}\n        L = np.diag(np.ones(N_omega)) - np.diag(np.ones(N_omega - 1), k=1)\n        L = L[:-1, :]\n        \n        # Construct the augmented system for regularized NNLS\n        sqrt_lambda = np.sqrt(reg_lambda)\n        K_augmented = np.vstack([K, sqrt_lambda * L])\n        D_augmented = np.concatenate([D_data, np.zeros(L.shape[0])])\n        \n        # Solve the NNLS problem to find the reconstructed spectral function\n        A_recon, _ = nnls(K_augmented, D_augmented)\n        \n        # --- 3. Extract Polaron Energy from Reconstructed Spectrum ---\n        \n        # Find all local maxima in the reconstructed spectrum A_recon\n        local_maxima_indices = []\n        for j in range(1, N_omega - 1):\n            if A_recon[j] > A_recon[j-1] and A_recon[j] > A_recon[j+1]:\n                local_maxima_indices.append(j)\n        \n        # Filter the maxima based on the given criteria\n        A_max_global = np.max(A_recon)\n        candidate_peaks = []\n        if A_max_global > 0:\n            for idx in local_maxima_indices:\n                if (omega_grid[idx] <= omega_search and \n                    A_recon[idx] > alpha_threshold * A_max_global):\n                    candidate_peaks.append((omega_grid[idx], A_recon[idx]))\n\n        # Sort candidates by energy (lowest first)\n        candidate_peaks.sort(key=lambda p: p[0])\n        \n        extracted_energy = 0.0\n        if candidate_peaks:\n            # The polaron energy is the lowest-energy significant peak\n            extracted_energy = candidate_peaks[0][0]\n        else:\n            # Fallback: find the global maximum within the search energy window\n            search_region_indices = np.where(omega_grid <= omega_search)[0]\n            if len(search_region_indices) > 0:\n                A_recon_search_region = A_recon[search_region_indices]\n                max_idx_in_region = np.argmax(A_recon_search_region)\n                # Convert back to index in the full omega_grid\n                best_idx = search_region_indices[max_idx_in_region]\n                extracted_energy = omega_grid[best_idx]\n            else:\n                 # Should not happen as omega_search > 0\n                extracted_energy = -1.0 \n    \n        results.append(extracted_energy)\n\n    # Format the results to 6 decimal places and print in the required format\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3010624"}]}