{"hands_on_practices": [{"introduction": "分数量子霍尔效应最引人注目的特征之一是其激发态携带分数电荷，这与所有基本粒子都携带整数倍基本电荷 $e$ 的常识相悖。这项练习引导我们重温 Robert Laughlin 的经典思想实验，它通过一种巧妙的方式揭示了这一惊人现象。通过分析在 Laughlin 波函数描述的量子流体中心绝热地插入一个磁通量子 $\\Phi_0 = h/e$ 后系统总角动量的变化，我们可以推断出准粒子所携带的有效电荷 [@problem_id:1141614]。这个练习不仅是 FQHE 理论的基石，也是理解拓扑激发和分数化概念的绝佳范例。", "problem": "Laughlin 态描述了在强垂直磁场中，处于分数填充因子 $\\nu = 1/m$（其中 $m$ 是一个奇数）下的二维电子气的基态。对于最低朗道能级中的 $N$ 个电子，在对称规范下，使用第 $k$ 个电子的复坐标 $z_k = x_k + iy_k$，其波函数由下式给出：\n$$ \\Psi_{1/m}(z_1, \\dots, z_N) = \\mathcal{N} \\prod_{i<j}^N (z_i - z_j)^m \\prod_{k=1}^N e^{-|z_k|^2 / (4l_B^2)} $$\n其中 $l_B = \\sqrt{\\hbar/(eB)}$ 是磁长度，$\\mathcal{N}$ 是归一化常数。该状态描述了一个密度近似均匀的不可压缩量子流体液滴。该状态的总角动量 z 分量为 $L_{z, \\text{initial}}^{\\text{total}} = \\frac{mN(N-1)}{2}\\hbar$。\n\n考虑这样一个处于 Laughlin $\\nu=1/m$ 态的 $N$ 电子系统。一个磁通量子 $\\Phi_0 = h/e$ 被绝热地穿过位于原点的一个细螺线管，该螺线管穿过电子液滴的中心。该过程足够缓慢，以至于系统始终保持在其基态（相对于瞬时哈密顿量）。\n\n利用电磁学和量子力学的基本原理，计算在插入一个磁通量子后，系统总角动量 z 分量的变化量 $\\Delta L_z^{\\text{total}} = L_{z, \\text{final}}^{\\text{total}} - L_{z, \\text{initial}}^{\\text{total}}$。", "solution": "填充因子为 $\\nu = 1/m$ 的 Laughlin 态的初始波函数由下式给出：\n$$\n\\Psi_{1/m}(z_1, \\dots, z_N) = \\mathcal{N} \\prod_{i<j}^N (z_i - z_j)^m \\prod_{k=1}^N e^{-|z_k|^2 / (4l_B^2)}\n$$\n多项式部分 $f_{\\text{initial}} = \\prod_{i<j} (z_i - z_j)^m$ 是齐次的。该多项式的总次数为：\n$$\nD_{\\text{initial}} = m \\binom{N}{2} = \\frac{m N (N-1)}{2}\n$$\n对于形式为 $\\Psi = f(z_1, \\dots, z_N) \\exp\\left(-\\sum_{k=1}^N |z_k|^2 / (4l_B^2)\\right)$（其中 $f$ 是解析的）的波函数，总角动量 z 分量为：\n$$\nL_z^{\\text{total}} = \\hbar \\sum_{k=1}^N z_k \\frac{\\partial f}{\\partial z_k}\n$$\n对于一个次数为 $D$ 的齐次多项式，根据 Euler 定理：\n$$\n\\sum_{k=1}^N z_k \\frac{\\partial f}{\\partial z_k} = D f\n$$\n因此，初始角动量为：\n$$\nL_{z, \\text{initial}}^{\\text{total}} = \\hbar D_{\\text{initial}} = \\hbar \\frac{m N (N-1)}{2}\n$$\n在原点处通过一个螺线管绝热地插入一个磁通量子 $\\Phi_0 = h/e$ 后，系统仍保持在其基态。最终的波函数对应于在原点处有一个准空穴的 Laughlin 态，即：\n$$\n\\Psi_{\\text{final}} = \\mathcal{N}' \\left( \\prod_{k=1}^N z_k \\right) \\prod_{i<j}^N (z_i - z_j)^m \\prod_{k=1}^N e^{-|z_k|^2 / (4l_B^2)}\n$$\n此时的多项式部分为 $f_{\\text{final}} = \\left( \\prod_{k=1}^N z_k \\right) f_{\\text{initial}}$。因子 $\\prod_{k=1}^N z_k$ 是 $N$ 次齐次的，所以 $f_{\\text{final}}$ 的总次数为：\n$$\nD_{\\text{final}} = D_{\\text{initial}} + N = \\frac{m N (N-1)}{2} + N\n$$\n最终的角动量为：\n$$\nL_{z, \\text{final}}^{\\text{total}} = \\hbar D_{\\text{final}} = \\hbar \\left( \\frac{m N (N-1)}{2} + N \\right)\n$$\n角动量的变化量为：\n$$\n\\Delta L_z^{\\text{total}} = L_{z, \\text{final}}^{\\text{total}} - L_{z, \\text{initial}}^{\\text{total}} = \\hbar \\left( \\frac{m N (N-1)}{2} + N \\right) - \\hbar \\frac{m N (N-1)}{2} = \\hbar N\n$$\n因此，变化量为 $N \\hbar$。", "answer": "$$\\boxed{N \\hbar}$$", "id": "1141614"}, {"introduction": "虽然 Laughlin 波函数为填充因子为 $\\nu=1/m$ 的态提供了精确的描述，但复合费米子（Composite Fermion, CF）理论为解释更广泛的分数霍尔效应序列提供了一个统一而强大的框架。其核心思想是将强相互作用的电子系统映射为一个弱相互作用的复合费米子系统。这个练习将这一抽象概念具体化：它要求我们计算复合费米子之间的有效相互作用，即所谓的“赝势” [@problem_id:1141650]。通过这个计算，您可以亲身体会到电子间的强库仑排斥是如何被“吸收”到复合费米子的构造中，从而转化为一种更简单、更弱的剩余相互作用，这正是复合费米子理论成功的关键。", "problem": "在分数量子霍尔效应 (FQHE) 理论中，处于强磁场中的电子之间的复杂相互作用可以通过复合费米子 (CF) 图像来简化。对于朗道能级填充因子为 $\\nu=1/3$ 的电子，每个电子被认为与两个磁通量子 ($2p=2$) 绑定，形成一个复合费米子。这些复合费米子随后会感受到一个弱得多的有效磁场，并形成它们自己的类朗道能级，称为 $\\Lambda$-能级。\n\n在最低朗道能级 (LLL) 中，一对电子之间的相互作用能由一组 Haldane 赝势 $V_m$ 来表征，其中 $m$ 是该电子对的相对角动量。由于电子是费米子，它们的波函数必须是反对称的，这限制了 $m$ 只能是奇数：$m=1, 3, 5, \\dots$。\n\n类似地，一对复合费米子之间的剩余相互作用可以用一组有效赝势 $V_{m_{CF}}^{CF}$ 来描述，其中 $m_{CF}$ 是该复合费米子对的相对角动量。一个具有给定相对角动量 $m_{CF}$ 的双复合费米子态不是一个简单的双电子态。相反，它对应于具有不同相对角动量 $m_e$ 的双电子态的叠加。因此，复合费米子赝势 $V_{m_{CF}}^{CF}$ 是裸电子赝势 $V_{m_e}$ 的线性组合。\n\n对于在 $\\nu=1/3$ 处、相对角动量为 $m_{CF}=1$ 的两个复合费米子的特定情况，相应的双电子态是 $m_e=1, 3, 5, \\dots$ 各态的叠加。找到具有给定相对角动量 $m_e$ 的电子对的概率已被确定为 $P(m_e=1) = 1/6$ 和 $P(m_e=3) = 5/6$。对于本问题，假设来自 $m_e \\geq 5$ 的贡献可以忽略不计。\n\n给定裸电子的前两个非零 Haldane 赝势 $V_1$ 和 $V_3$，求相对角动量为 1 的复合费米子的有效相互作用赝势 $V_1^{CF}$。", "solution": "相对角动量为 $m_{CF} = 1$ 的复合费米子的有效赝势是在该复合费米子态中相互作用能的期望值。该态是具有相对角动量 $m_e$ 的电子对态的叠加，其期望值由使用所提供概率对裸电子赝势 $V_{m_e}$ 进行加权平均得到。\n\n已知：\n- $m_e = 1$ 的概率：$P(m_e=1) = \\frac{1}{6}$\n- $m_e = 3$ 的概率：$P(m_e=3) = \\frac{5}{6}$\n- 对于 $m_e \\geq 5$ 的贡献可以忽略不计。\n\n有效复合费米子赝势为：\n\n$$\nV_1^{CF} = \\sum_{m_e} P(m_e) V_{m_e}\n$$\n\n代入概率值：\n\n$$\nV_1^{CF} = P(m_e=1) \\cdot V_1 + P(m_e=3) \\cdot V_3\n$$\n\n\n$$\nV_1^{CF} = \\left( \\frac{1}{6} \\right) V_1 + \\left( \\frac{5}{6} \\right) V_3\n$$\n\n此表达式取决于裸电子赝势 $V_1$ 和 $V_3$。", "answer": "$$\n\\boxed{\\dfrac{1}{6}V_{1} + \\dfrac{5}{6}V_{3}}\n$$", "id": "1141650"}, {"introduction": "理论的深刻见解最终需要通过实验或数值模拟来验证。这项动手实践是一次计算物理的入门体验，它邀请您通过精确对角化方法来研究一个简化的分数量子霍尔系统模型 [@problem_id:2824440]。您将为一个由少数电子组成的系统编写程序，计算其在“薄环”极限下的能谱。这个练习的价值在于，您将能从第一性原理出发，亲眼见证 FQHE 的标志性特征浮现出来，例如在环形几何中与拓扑序相关的简并基态，以及激发态与基态之间的能量差（即多体能隙）。这有助您将抽象的拓扑概念与具体的可观测量联系起来。", "problem": "您需要在一个细长环（Tao–Thouless）极限下，为分数量子霍尔效应实现一个精确对角化研究。请从业界公认且基础的以下物理设定和映射开始。在强垂直磁场中的二维电子气具有朗道能级量子化；当回旋能隙很大时，低能物理由最低朗道能级所描述。在环面或圆柱面的朗道规范下，导心坐标将问题映射到一条由整数 $i \\in \\{0,1,\\dots,N_\\phi-1\\}$ 标记的 $N_\\phi$ 个轨道组成的一维链。在细长环极限下，投影到最低朗道能级的两体相互作用简化为纯粹的静电密度-密度相互作用，该作用仅依赖于已占据轨道之间的间距。这产生了一个在占据数基底下对角的哈密顿量：\n$$\nH \\;=\\; \\sum_{0 \\le i < j \\le N_\\phi-1} V_{d(i,j)} \\, n_i \\, n_j,\n$$\n其中 $n_i \\in \\{0,1\\}$ 是费米子占据数，而 $d(i,j)$ 是一个依赖于几何构型的间距：对于环面（周期性边界条件），$d(i,j) = \\min\\!\\big(|i-j|,\\, N_\\phi - |i-j|\\big)$；对于圆柱面（开放边界条件），$d(i,j) = |i-j|$。系数 $V_k$ 是正的，并随间距 $k$ 单调递减，这描述了导心之间的短程排斥作用。为了数值上的确定性，将相互作用在范围 $K_{\\max}$ 处截断，并取\n$$\nV_k \\;=\\; e^{-\\alpha k}, \\quad \\text{其中 } k \\in \\{1,2,\\dots,K_{\\max}\\}, \\quad \\text{并且当 } k > K_{\\max} \\text{ 时 } V_k \\;=\\; 0,\n$$\n其中给定衰减参数 $\\alpha > 0$。这是一个标准的细长环静电模型，它能捕捉到分数量子霍尔相特有的基态模式和低能激发。\n\n您的任务是：给定几何构型、轨道数 $N_\\phi$、粒子数 $N$（Fock 空间限制在固定的 $N$ 上）以及相互作用参数 $(\\alpha, K_{\\max})$，通过枚举所有 $N$ 粒子 Fock 基态，计算它们在哈密顿量 $H$ 下的能量，并提取低能谱来进行精确对角化。由于 $H$ 在占据数基底下是对角的，因此“对角化”简化为计算能量集合及其简并度。请从第一性原理出发，按如下方式诠释低能谱：\n- 在填充数为 $1/3$ 时，即对于整数 $N_\\phi/3$ 有 $N = N_\\phi/3$，在环面上，细长环基态形成晶胞长度为 $3$ 的 Tao–Thouless 电荷密度模式，例如 $100100\\ldots$。平移对称性意味着存在恰好 $3$ 个简并基态，对应于晶胞的 $3$ 种不同平移。第一激发流形对应于最近邻畴壁的产生，可被诠释为一个局域的准粒子-准空穴对。\n- 在圆柱面（开放边界）上，平移对称性被破坏，因此基态是唯一的且被钉扎。最低激发是边缘重排，其能量由 $V_k$ 决定，且在参数上可以远小于体畴壁能量。\n\n请实现上述过程，并为每个测试用例计算以下四个量：\n- $E_0$：基态能量（所有 $N$ 粒子基态中的最低能量），\n- $g_0$：基态简并度（在数值容差范围内，能量恰好为 $E_0$ 的态的数量），\n- $E_1$：第一激发能（严格大于 $E_0$ 且超出容差范围的最小能量），\n- $\\Delta \\equiv E_1 - E_0$：多体能隙，即基态流形与第一激发能级之间的能量差。\n\n算法要求：\n- 枚举所有 $\\binom{N_\\phi}{N}$ 个长度为 $N_\\phi$ 且恰好有 $N$ 个 1 的占据数位串。\n- 对每个位串，通过对所有满足 $d(i,j) \\le K_{\\max}$ 的已占据轨道对 $(i,j)$ 求和 $V_{d(i,j)}$ 来计算能量。\n- 使用 $10^{-12}$ 的绝对容差来识别能量简并和区分不同的能级。\n- 对于环面几何构型，使用距离 $d(i,j) = \\min(|i-j|,\\, N_\\phi - |i-j|)$；对于圆柱面几何构型，使用距离 $d(i,j) = |i-j|$。\n- 当 $k \\in \\{1,2,\\dots,K_{\\max}\\}$ 时使用相互作用 $V_k = e^{-\\alpha k}$，否则 $V_k = 0$。\n\n测试套件：\n请为以下五个情况提供输出（它们分别涵盖了一个普适的 $1/3$ 填充环面、一个较小的 $1/3$ 填充体系、一个开放边界的边缘情况、一个边界尺寸情况，以及一个用以说明畴壁的非公度填充）：\n- 情况A：几何构型 = 环面, $N_\\phi = 12$, $N = 4$, $\\alpha = 0.7$, $K_{\\max} = 4$。\n- 情况B：几何构型 = 环面, $N_\\phi = 9$, $N = 3$, $\\alpha = 0.7$, $K_{\\max} = 4$。\n- 情况C：几何构型 = 圆柱面, $N_\\phi = 9$, $N = 3$, $\\alpha = 0.7$, $K_{\\max} = 4$。\n- 情况D：几何构型 = 环面, $N_\\phi = 6$, $N = 2$, $\\alpha = 0.7$, $K_{\\max} = 4$。\n- 情况E：几何构型 = 环面, $N_\\phi = 10$, $N = 3$, $\\alpha = 0.7$, $K_{\\max} = 4$。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个类 JSON 格式的列表，内含五个条目，每个条目对应一个测试用例，顺序与上述情况相同。每个条目必须是 $[E_0, g_0, E_1, \\Delta]$ 形式的列表，其中 $E_0$、$E_1$ 和 $\\Delta$ 是四舍五入到恰好 10 位小数的浮点数，而 $g_0$ 是一个整数。例如，一个包含两个假设用例的输出应如下所示：$[[0.1234567890,3,0.2345678901,0.1111111011],[\\dots]]$。没有物理单位；根据构造，能量是无量纲的。不使用角度。所有小数必须使用句点作为小数点分隔符。", "solution": "该问题是一个在计算凝聚态物理领域中适定且标准的练习，专门研究分数量子霍尔效应的 Tao-Thouless（细长环）极限。所给出的模型、哈密顿量和参数在科学上是合理的，并为进行有意义的数值研究提供了一个自洽的框架。其中不存在逻辑矛盾、歧义或事实性错误。因此，该问题被认为是**有效的**，我们可以开始求解。\n\n核心任务是确定一个由 $N$ 个相互作用的无自旋费米子分布在 $N_\\phi$ 个轨道上的体系的低能谱部分。哈密顿量为：\n$$\nH = \\sum_{0 \\le i < j \\le N_\\phi-1} V_{d(i,j)} \\, n_i \\, n_j\n$$\n其中 $n_i \\in \\{0, 1\\}$ 是轨道 $i$ 的占据数。此哈密顿量在占据数的 Fock 基下是对角的。因此，“精确对角化”是一个用词不当的说法；任务简化为对每个基态能量的直接计算。一个基态由已占据轨道的集合 $\\{o_1, o_2, \\dots, o_N\\}$ 定义，其中当 $k \\in \\{1, \\dots, N\\}$ 时，$n_{o_k} = 1$，否则 $n_i=0$。这样一种状态的能量是：\n$$\nE = \\sum_{1 \\le a < b \\le N} V_{d(o_a, o_b)}\n$$\n求解步骤如下：\n\n1.  **态空间枚举**：希尔伯特空间由 $N$ 个粒子在 $N_\\phi$ 个轨道上的所有可能构型张成。这对应于从集合 $\\{0, 1, \\dots, N_\\phi-1\\}$ 中枚举 $N$ 个不同轨道指标的所有组合。这样的态总数为 $\\binom{N_\\phi}{N}$。每个态由一个已占据轨道指标的元组表示。\n\n2.  **相互作用势**：两个相距为 $k$ 的粒子之间的相互作用势 $V_k$ 定义为：\n    $$\n    V_k = \\begin{cases} e^{-\\alpha k} & \\text{若 } 1 \\le k \\le K_{\\max} \\\\ 0 & \\text{若 } k > K_{\\max} \\end{cases}\n    $$\n    其中 $\\alpha > 0$ 是一个衰减参数，而 $K_{\\max}$ 是最大相互作用范围。预先计算并存储 $k \\in \\{1, \\dots, K_{\\max}\\}$ 的 $V_k$ 值在计算上是高效的。\n\n3.  **距离度量**：轨道 $i$ 和 $j$ 之间的距离 $d(i,j)$ 取决于系统的几何构型。\n    -   对于**环面**，意味着周期性边界条件，距离是沿圆周的两条路径中较短的一条：\n        $$\n        d(i, j) = \\min(|i-j|, N_\\phi - |i-j|)\n        $$\n    -   对于**圆柱面**，意味着开放边界条件，距离就是直线上的间隔：\n        $$\n        d(i, j) = |i-j|\n        $$\n\n4.  **能量计算**：对于 $\\binom{N_\\phi}{N}$ 个态中的每一个，我们计算其能量。这包括遍历该态内所有唯一的已占据轨道对 $(o_a, o_b)$，计算它们的距离 $d(o_a, o_b)$，并将相应的相互作用势 $V_{d(o_a, o_b)}$ 求和。\n\n5.  **能谱分析**：计算完 Fock 空间中每个态的能量后，对得到的能量列表进行分析以提取所需物理量。\n    -   首先，将所有能量的列表按升序排序。\n    -   由于浮点数运算的有限精度，必须使用一个数值容差（指定为 $\\epsilon = 10^{-12}$）来比较能量。\n    -   基态能量 $E_0$ 是排序后列表的第一个元素。\n    -   基态简并度 $g_0$ 通过计算列表中与 $E_0$ 的差在容差 $\\epsilon$ 内的能量数量来确定。形式上，它是满足 $|E - E_0| \\le \\epsilon$ 的能量 $E$ 的计数。\n    -   第一激发能 $E_1$ 是排序列表中严格大于 $E_0$ 且超出容差 $\\epsilon$ 的最小能量。形式上，它是满足 $E - E_0 > \\epsilon$ 的最小能量 $E$。如果所有态都是简并的，则不存在这样的 $E_1$；然而，对于给定的测试用例，所提供的相互作用模型保证了非平凡能谱的存在。\n    -   多体能隙 $\\Delta$ 是第一激发能与基态能量之差：\n        $$\n        \\Delta = E_1 - E_0\n        $$\n\n这种系统性的、暴力枚举和计算方法保证能为给定的模型哈密顿量找到精确的基态和第一激发态，因为希尔伯特空间是有限的，且哈密顿量在所选基底下是对角的。实现将精确地遵循此算法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport itertools\nimport scipy.special\n\ndef solve():\n    \"\"\"\n    Main function to run the exact diagonalization for all test cases and print results.\n    \"\"\"\n    \n    # Test cases from the problem statement.\n    test_cases = [\n        # (geometry, N_phi, N, alpha, K_max)\n        ('torus', 12, 4, 0.7, 4),    # Case A\n        ('torus', 9, 3, 0.7, 4),     # Case B\n        ('cylinder', 9, 3, 0.7, 4), # Case C\n        ('torus', 6, 2, 0.7, 4),     # Case D\n        ('torus', 10, 3, 0.7, 4),    # Case E\n    ]\n\n    all_results = []\n    for case in test_cases:\n        geometry, N_phi, N, alpha, K_max = case\n        E0, g0, E1, Delta = compute_spectrum(geometry, N_phi, N, alpha, K_max)\n        \n        # Format results to the required precision.\n        formatted_result = [\n            f\"{E0:.10f}\",\n            g0,\n            f\"{E1:.10f}\",\n            f\"{Delta:.10f}\"\n        ]\n        all_results.append(f\"[{','.join(map(str, formatted_result))}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\ndef compute_spectrum(geometry, N_phi, N, alpha, K_max):\n    \"\"\"\n    Computes the low-energy spectrum for a given set of parameters.\n\n    Args:\n        geometry (str): 'torus' or 'cylinder'.\n        N_phi (int): Number of orbitals.\n        N (int): Number of particles.\n        alpha (float): Interaction decay parameter.\n        K_max (int): Maximum interaction range.\n        \n    Returns:\n        tuple: (E0, g0, E1, Delta)\n               E0 (float): Ground-state energy.\n               g0 (int): Ground-state degeneracy.\n               E1 (float): First excited energy.\n               Delta (float): Many-body gap.\n    \"\"\"\n    tolerance = 1e-12\n\n    if N < 2:\n        # If there are fewer than 2 particles, interaction energy is always 0.\n        # E1 and Delta are not well-defined, but we can set them to 0.\n        return 0.0, int(np.round(scipy.special.comb(N_phi, N))), 0.0, 0.0\n\n    # Pre-compute interaction potentials V_k = exp(-alpha * k)\n    # V[k] will store V_k. Index 0 is unused.\n    V = np.zeros(K_max + 1)\n    k_range = np.arange(1, K_max + 1)\n    V[1:] = np.exp(-alpha * k_range)\n    \n    # Define distance function based on geometry\n    if geometry == 'torus':\n        def dist_func(i, j, N_phi_val):\n            d = abs(i - j)\n            return min(d, N_phi_val - d)\n    elif geometry == 'cylinder':\n        def dist_func(i, j, N_phi_val):\n            return abs(i - j)\n    else:\n        raise ValueError(\"Invalid geometry specified. Must be 'torus' or 'cylinder'.\")\n\n    all_energies = []\n    \n    # Enumerate all N-particle Fock basis states\n    # A state is a tuple of occupied orbital indices\n    orbital_indices = range(N_phi)\n    for state in itertools.combinations(orbital_indices, N):\n        current_energy = 0.0\n        \n        # Sum pairwise interactions for the current state\n        for site_pair in itertools.combinations(state, 2):\n            i, j = site_pair\n            \n            # Calculate distance and add interaction energy\n            d = dist_func(i, j, N_phi)\n            if 1 <= d <= K_max:\n                current_energy += V[d]\n        \n        all_energies.append(current_energy)\n\n    # Sort energies to find the low-lying spectrum\n    all_energies.sort()\n    \n    # Identify E0, g0, E1, and Delta\n    if not all_energies: # Should not happen for N>0\n        return 0.0, 0, 0.0, 0.0\n        \n    # Ground state energy E0\n    E0 = all_energies[0]\n    \n    # Find ground state degeneracy g0\n    g0 = 0\n    first_excited_idx = -1\n    for i, energy in enumerate(all_energies):\n        if abs(energy - E0) <= tolerance:\n            g0 += 1\n        else:\n            first_excited_idx = i\n            break\n            \n    # First excited energy E1 and gap Delta\n    if first_excited_idx != -1:\n        E1 = all_energies[first_excited_idx]\n        Delta = E1 - E0\n    else:\n        # All states are degenerate, no excited state\n        E1 = E0 # Or handle as an error, but problem implies it exists\n        Delta = 0.0\n        \n    return E0, g0, E1, Delta\n\n# Run the simulation.\nsolve()\n```", "id": "2824440"}]}