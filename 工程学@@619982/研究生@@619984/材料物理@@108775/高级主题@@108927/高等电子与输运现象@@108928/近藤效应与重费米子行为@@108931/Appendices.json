{"hands_on_practices": [{"introduction": "近藤模型是研究磁性杂质物理的核心，但它本身是一个有效模型。这项实践将带你追本溯源，通过执行一次 Schrieffer-Wolff 变换，从更基本的安德森模型出发，亲自推导出近藤哈密顿量 [@problem_id:2833089]。这个过程不仅能加深你对有效理论如何通过消除高能自由度而产生的理解，还将揭示粒子-空穴对称性等基本对称性与系统散射性质之间的深刻联系。", "problem": "考虑描述一个与导带杂化的局域轨道的单杂质安德森模型 (single-impurity Anderson model)，\n$$\nH=\\sum_{k,\\sigma} \\epsilon_k\\, c_{k\\sigma}^{\\dagger}c_{k\\sigma} + E_d \\sum_{\\sigma} n_{d\\sigma} + U\\, n_{d\\uparrow}n_{d\\downarrow} + V \\sum_{k,\\sigma}\\left(c_{k\\sigma}^{\\dagger} d_{\\sigma} + d_{\\sigma}^{\\dagger} c_{k\\sigma}\\right),\n$$\n其中 $c_{k\\sigma}$ 湮灭一个动量为 $k$、自旋为 $\\sigma$ 的导带电子，$d_{\\sigma}$ 湮灭一个杂质上的局域电子，$n_{d\\sigma}=d_{\\sigma}^{\\dagger}d_{\\sigma}$，$E_d$ 是杂质能级能量，$U$ 是在位库仑排斥，$V$ 是一个与 $k$ 无关的杂化强度。假设导带是无特征的，在费米能级处有有限的态密度，并且低能区是单占据的杂质子空间。\n\n1) 使用正则 (Schrieffer–Wolff) 变换，在 $V$ 的二阶近似下消除电荷涨落，推导在单占据子空间中的有效低能近藤 (Kondo) 哈密顿量。通过计算经过空杂质态和双占据杂质态的虚过程，用 $E_d$，$U$ 和 $V$ 表示反铁磁交换耦合 $J$ 和势散射振幅 $K$。在此阶段，不要假设 $E_d$ 和 $U$ 之间有任何特殊关系。\n\n2) 将你的结果特殊化到粒子–空穴对称点 $E_d=-U/2$，并证明势散射振幅 $K$ 为零。\n\n3) 对于此对称情况，使用零温费米液体描述和 Friedel 求和规则，确定费米能级处导带电子的 s-波散射相移 $\\delta_{\\sigma}$。以弧度为单位，给出一个单一数值作为最终答案。你可以假设在零温和粒子-空穴对称条件下，杂质占据数为 $n_d=1$，并且时间反演和自旋旋转对称性未被破坏，因此 $\\delta_{\\uparrow}=\\delta_{\\downarrow}$。\n\n给出 $\\delta_{\\sigma}$ 的最终数值，单位为弧度。无需四舍五入。", "solution": "所提出的问题是理论凝聚态物理中的一个标准练习，涉及安德森 (Anderson) 模型和近藤 (Kondo) 模型之间的关系。我们将验证其前提，然后进行严谨的求解。\n\n该问题具有科学依据，提法恰当且客观。所有提供的信息，包括安德森哈密顿量、指定的假设和任务，在已建立的多体理论框架内都是标准和一致的。这些问题从一般性推导到基本原理的具体应用，形成了一个逻辑上的递进。该问题被认为是有效的，并将提供解答。\n\n问题分为三个部分。我们将依次解决它们。\n\n**第一部分：近藤哈密顿量的推导**\n\n给定单杂质安德森哈密顿量：\n$$H=H_0 + H_1$$\n其中 $H_0$ 描述未耦合的导带和局域杂质，$H_1$ 是杂化项。\n$$H_0=\\sum_{k,\\sigma} \\epsilon_k\\, c_{k\\sigma}^{\\dagger}c_{k\\sigma} + E_d \\sum_{\\sigma} n_{d\\sigma} + U\\, n_{d\\uparrow}n_{d\\downarrow}$$\n$$H_1 = V \\sum_{k,\\sigma}\\left(c_{k\\sigma}^{\\dagger} d_{\\sigma} + d_{\\sigma}^{\\dagger} c_{k\\sigma}\\right)$$\n我们被要求在杂质为单占据（$n_d = n_{d\\uparrow} + n_{d\\downarrow} = 1$）的低能区进行计算。这定义了我们的低能子空间，投影算符 $P$ 作用于该子空间。高能激发态涉及空杂质（$n_d=0$）或双占据杂质（$n_d=2$）。投影到这个高能子空间的算符是 $Q=1-P$。\n\nSchrieffer-Wolff 变换是一种正则变换，$H_{eff} = e^S H e^{-S}$，旨在将哈密顿量中耦合低能和高能子空间的项消除到给定阶。在微扰 $H_1$ 的二阶，作用于低能子空间的有效哈密顿量由标准微扰理论给出：\n$$H_{eff} = P H_0 P + P H_1 Q \\frac{1}{E_{low} - H_0} Q H_1 P$$\n此处，$E_{low}$ 是低能子空间中初态的能量。为方便起见，我们设置费米能 $E_F = 0$。初态由导带电子的费米海和一个单占据的杂质组成。其能量为 $E_{low} \\approx E_d$。高能子空间 $Q$ 中的中间态具有能量 $E_{high}$。我们必须考虑两种起始和终止于 $n_d=1$ 子空间的虚过程。\n\n路径1：中间态有一个双占据的杂质（$n_d=2$）。\n一个来自费米能级附近（$\\epsilon_k \\approx 0$）导带的电子跳到杂质上。这个中间态的能量是 $E_{n_d=2} = 2E_d + U$。此过程的能量分母是：\n$$\\Delta E_1 = E_{low} - E_{n_d=2} \\approx E_d - (2E_d + U) = -E_d - U$$\n\n路径2：中间态有一个空杂质（$n_d=0$）。\n杂质上的电子跳入费米能级以上的一个导带空态中（$\\epsilon_k \\approx 0$）。杂质变为空，能量为0。此过程的能量分母是：\n$$\\Delta E_2 = E_{low} - E_{n_d=0} \\approx E_d - 0 = E_d$$\n注意符号约定需要小心。更严谨的计算使用 $(\\epsilon_k - E_d)$ 作为向杂质态添加一个空穴的能量，因此分母是 $-E_d + \\epsilon_k$。对于 $\\epsilon_k \\approx 0$，此值为 $-E_d$。\n\n有效相互作用哈密顿量是这两个路径贡献的总和。经过一个繁琐但标准的计算，该计算涉及将费米子算符投影到 $n_d=1$ 子空间中的自旋算符上，最终得到的有效哈密顿量具有近藤哈密顿量的形式：\n$$H_{Kondo} = \\sum_{k,k'} c^{\\dagger}_{k\\sigma} c_{k'\\sigma'} \\left( K \\delta_{\\sigma\\sigma'} + \\frac{J}{2} \\mathbf{S}_d \\cdot \\mathbf{\\sigma}_{\\sigma\\sigma'} \\right) $$\n其中 $\\mathbf{S}_d$ 是局域磁矩的自旋-$1/2$算符，$\\mathbf{\\sigma}$ 是导带电子自旋的泡利矩阵矢量。耦合常数通过对两个虚过程的贡献求和得到：\n$$J = V^2 \\left( \\frac{1}{E_d+U} - \\frac{1}{E_d} \\right) = \\frac{-U V^2}{E_d(E_d+U)}$$\n$$K = \\frac{V^2}{2} \\left( \\frac{1}{E_d+U} + \\frac{1}{E_d} \\right) = \\frac{V^2(2E_d+U)}{2E_d(E_d+U)}$$\n为了观测到近藤效应，交换耦合 $J$ 必须是正的（反铁磁性）。这发生在 $E_d < 0$ 和 $E_d+U > 0$ 的区域。\n\n**第二部分：粒子-空穴对称情况**\n\n我们被要求将情况特殊化到粒子-空穴对称点，该点由条件 $E_d = -\\frac{U}{2}$ 定义。我们将此条件代入势散射振幅 $K$ 的表达式中：\n$$K = \\frac{V^2}{2} \\left( \\frac{1}{-\\frac{U}{2}+U} + \\frac{1}{-\\frac{U}{2}} \\right) = \\frac{V^2}{2} \\left( \\frac{1}{\\frac{U}{2}} - \\frac{1}{\\frac{U}{2}} \\right) = \\frac{V^2}{2} \\left( \\frac{2}{U} - \\frac{2}{U} \\right) = 0$$\n因此，在粒子-空穴对称点，势散射项为零。相互作用纯粹是自旋交换类型的。为了完整起见，此点的交换耦合为：\n$$J = V^2 \\left( \\frac{1}{-\\frac{U}{2}+U} - \\frac{1}{-\\frac{U}{2}} \\right) = V^2 \\left( \\frac{1}{U/2} + \\frac{1}{U/2} \\right) = V^2 \\left( \\frac{2}{U/2} \\right) = \\frac{4V^2}{U}$$\n该值为正，符合预期。\n\n**第三部分：散射相移**\n\n我们要使用 Friedel 求和规则来确定费米能级处的 s-波散射相移 $\\delta_{\\sigma}$。Friedel 求和规则提供了费米能级处的散射相移与杂质所排开的总电荷之间的基本联系。对于单个自旋通道 $\\sigma$，该规则表述为：\n$$\\Delta N_{\\sigma} = \\frac{\\delta_{\\sigma}}{\\pi}$$\n其中 $\\Delta N_{\\sigma}$ 是被杂质排开的自旋为 $\\sigma$ 的电子数。在安德森模型的背景下，这个被排开的电荷恰好是该自旋的杂质能级占据数 $n_{d\\sigma}$。\n$$\\delta_{\\sigma} = \\pi n_{d\\sigma}$$\n对于零温下的对称情况，问题提供了关键信息：\n1.  总杂质占据数为 $n_d = 1$。\n2.  时间反演和自旋旋转对称性未被破坏，这意味着自旋向上和自旋向下电子的相移和占据数相等：$\\delta_{\\uparrow} = \\delta_{\\downarrow}$ 和 $n_{d\\uparrow} = n_{d\\downarrow}$。\n\n从总占据数，我们有：\n$$n_d = n_{d\\uparrow} + n_{d\\downarrow} = 1$$\n使用对称性条件 $n_{d\\uparrow} = n_{d\\downarrow}$，我们立即可以求出每个自旋通道的占据数：\n$$2 n_{d\\sigma} = 1 \\implies n_{d\\sigma} = \\frac{1}{2}$$\n现在，我们将此结果代入单个自旋通道 $\\sigma$ 的 Friedel 求和规则中：\n$$\\delta_{\\sigma} = \\pi \\cdot n_{d\\sigma} = \\pi \\cdot \\frac{1}{2} = \\frac{\\pi}{2}$$\n这个结果表明在费米能级发生了共振散射，这是近藤单重态基态的特征。每个自旋通道的相移是 $\\pi/2$ 弧度。", "answer": "$$\\boxed{\\frac{\\pi}{2}}$$", "id": "2833089"}, {"introduction": "在低温下，近藤问题呈现出费米液体的行为，但这是一个由强相互作用主导的非凡状态。威尔逊比（$R_W$）为我们提供了一个定量的“指纹”来识别这种强关联特性，它将磁化率的增强与比热的增强联系在一个普适的常数上。通过推导这一关键比率 [@problem_id:2833123]，你将掌握如何运用 Nozières 的局域费米液体图像，并深刻体会到宏观热力学测量如何揭示微观世界的普适物理规律。", "problem": "考虑一个嵌入在三维金属中的单个自旋-$\\tfrac{1}{2}$磁性杂质，其低能行为由反铁磁近藤模型描述。将杂质对均匀自旋磁化率 $\\chi_{\\mathrm{imp}}$ 和对温度线性比热系数 $\\gamma_{\\mathrm{imp}}$ 的贡献，定义为在低温极限下，含杂质系统与不含杂质的参考系统之间的数值差异。威尔逊比是一个无量纲的度量，衡量自旋响应相对于比热的增强程度，其定义具有这样的性质：对于无相互作用的自旋简并费米气体，其值等于$1$。\n\n从无相互作用的自旋简并费米气体的泡利磁化率和索末菲展开出发，构造唯一的归一化常数 $A$，使得对于无相互作用的情况，$R_{W}=A\\,\\chi/\\gamma=1$。该常数用 $k_{B}$、$g$、$\\mu_{B}$ 和 $\\pi$ 表示。然后，使用朗道费米液体（FL）理论，用反对称朗道参数 $F_{0}^{a}$ 表示 $R_{W}$。最后，利用自旋-$\\tfrac{1}{2}$近藤模型强耦合不动点的局域费米液体描述（Nozières的费米液体），论证在该不动点处 $F_{0}^{a}$ 的普适值，并确定自旋-$\\tfrac{1}{2}$近藤杂质的 $R_{W}$ 的普适值。\n\n将最终答案表示为一个无单位的无量纲数。", "solution": "该问题陈述在科学上是合理的、提法恰当且客观的。它基于凝聚态物理的既定原理，即无相互作用费米气体理论、朗道费米液体理论以及Nozières对近藤效应的费米液体描述。该问题是自洽的，并为得到一个唯一且有意义的解提供了一条清晰的逻辑路径。在强关联电子系统的研究中，这是一个标准的、非平凡的问题。因此，该问题是有效的，我们可以着手求解。\n\n该问题需要分三部分推导，以确定自旋-$\\frac{1}{2}$近藤杂质的普适威尔逊比。\n\n首先，我们必须通过要求对于无相互作用的三维自旋简并费米气体，$R_{W}=1$，来确定威尔逊比 $R_{W}=A\\,\\chi/\\gamma$ 的归一化常数 $A$。\n\n线性比热系数 $\\gamma$ 由索末菲展开给出：\n$$\n\\gamma = \\frac{C_V}{T} = \\frac{\\pi^2}{3} k_B^2 N(E_F)\n$$\n其中 $k_B$ 是玻尔兹曼常数，$N(E_F)$ 是费米能 $E_F$ 处的总态密度。\n\n均匀静态自旋磁化率是泡利磁化率 $\\chi$。在微小磁场 $B$ 的存在下，自旋向上和自旋向下的能带能量分别移动 $\\mp \\frac{1}{2}g\\mu_B B$，其中 $g$ 是朗德 $g$ 因子，$\\mu_B$ 是玻尔磁子。在零温下，对于小磁场 $B$，产生的净磁化强度 $M$ 为\n$$\nM = \\frac{1}{2}g\\mu_B (N_\\uparrow - N_\\downarrow) = \\frac{1}{2}g\\mu_B \\left( \\frac{1}{2}N(E_F) \\cdot \\frac{1}{2}g\\mu_B B - \\frac{1}{2}N(E_F) \\cdot (-\\frac{1}{2}g\\mu_B B) \\right) = \\frac{1}{4}(g\\mu_B)^2 N(E_F) B\n$$\n磁化率定义为 $\\chi = \\frac{M}{B}$，这给出\n$$\n\\chi = \\frac{1}{4}(g\\mu_B)^2 N(E_F)\n$$\n现在，我们构造比值 $\\chi/\\gamma$：\n$$\n\\frac{\\chi}{\\gamma} = \\frac{\\frac{1}{4}(g\\mu_B)^2 N(E_F)}{\\frac{\\pi^2}{3} k_B^2 N(E_F)} = \\frac{3(g\\mu_B)^2}{4\\pi^2 k_B^2}\n$$\n威尔逊比定义为 $R_W = A \\, \\chi/\\gamma$。我们对无相互作用的情况强制施加条件 $R_W=1$：\n$$\nA \\left( \\frac{3(g\\mu_B)^2}{4\\pi^2 k_B^2} \\right) = 1\n$$\n求解归一化常数 $A$，我们得到\n$$\nA = \\frac{4\\pi^2 k_B^2}{3(g\\mu_B)^2}\n$$\n\n第二，我们使用朗道费米液体（FL）理论，用反对称朗道参数 $F_0^a$ 来表示威尔逊比。在有相互作用的费米液体中，元激发是具有有效质量 $m^*$ 的准粒子。比热系数 $\\gamma$ 和自旋磁化率 $\\chi$ 被重整化。费米能量处的准粒子态密度是 $N^*(E_F)$，它相对于无相互作用的值 $N(E_F)$ 增强了 $m^*/m$ 的比率。比热正比于这个增强的态密度：\n$$\n\\gamma = \\frac{\\pi^2}{3} k_B^2 N^*(E_F)\n$$\n自旋磁化率被有效质量增强，但被准粒子间的相互作用减弱，这种相互作用由无量纲的反对称朗道参数 $F_0^a$ 表征：\n$$\n\\chi = \\frac{\\frac{1}{4}(g\\mu_B)^2 N^*(E_F)}{1+F_0^a}\n$$\n现在我们使用我们导出的常数 $A$ 来计算相互作用系统的威尔逊比：\n$$\nR_W = A \\frac{\\chi}{\\gamma} = \\left( \\frac{4\\pi^2 k_B^2}{3(g\\mu_B)^2} \\right) \\frac{\\frac{1}{4}(g\\mu_B)^2 \\frac{N^*(E_F)}{1+F_0^a}}{\\frac{\\pi^2}{3} k_B^2 N^*(E_F)}\n$$\n除了相互作用项外，所有项都抵消了，留下一个非常简洁的普适表达式：\n$$\nR_W = \\frac{1}{1+F_0^a}\n$$\n\n第三，我们将此框架应用于自旋-$\\frac{1}{2}$近藤杂质问题。在低温下（$T \\ll T_K$，其中 $T_K$ 是近藤温度），杂质自旋被导电电子屏蔽，低能物理由局域费米液体描述，这是由 Nozières 开创的概念。杂质对比热的贡献 $\\gamma_{\\mathrm{imp}}$ 和对磁化率的贡献 $\\chi_{\\mathrm{imp}}$ 遵循相同的费米液体结构，其中相关的态密度是费米能级上由杂质引起的准粒子态密度 $\\rho_{\\mathrm{imp}}(0)$，相互作用参数是局域朗道参数 $F_0^a$。\n$$\n\\gamma_{\\mathrm{imp}} = \\frac{\\pi^2 k_B^2}{3} \\rho_{\\mathrm{imp}}(0)\n$$\n$$\n\\chi_{\\mathrm{imp}} = \\frac{1}{4}(g\\mu_B)^2 \\frac{\\rho_{\\mathrm{imp}}(0)}{1+F_0^a}\n$$\n因此，杂质贡献的威尔逊比为 $R_{W, \\mathrm{imp}} = \\frac{1}{1+F_0^a}$。\n\n关键步骤是确定自旋-$\\frac{1}{2}$近藤不动点处 $F_0^a$ 的普适值。这个值可以从 Nozières 的理论中论证得出，并由精确的 Bethe ansatz 解所证实。近藤模型的一个关键普适结果是，与仅由比热增强所预期的值相比，自旋磁化率恰好增强了 $2$ 倍。\n\n让我们将其形式化。给定一个由 $\\gamma_{\\mathrm{imp}}$ 表征的比热增强，它定义了一个有效的杂质态密度 $\\rho_{\\mathrm{imp}}(0)$，一个具有相同态密度的无相互作用共振能级的磁化率将是\n$$\n\\chi_{\\mathrm{non-int}} = \\frac{1}{4}(g\\mu_B)^2 \\rho_{\\mathrm{imp}}(0)\n$$\n对于自旋-$\\frac{1}{2}$近藤问题，其普适结果表明，实际的杂质磁化率为\n$$\n\\chi_{\\mathrm{imp}} = 2 \\times \\chi_{\\mathrm{non-int}} = 2 \\left( \\frac{1}{4}(g\\mu_B)^2 \\rho_{\\mathrm{imp}}(0) \\right)\n$$\n通过将这个精确结果与 $\\chi_{\\mathrm{imp}}$ 的局域费米液体表达式进行比较，我们可以确定 $F_0^a$：\n$$\n\\frac{1}{4}(g\\mu_B)^2 \\frac{\\rho_{\\mathrm{imp}}(0)}{1+F_0^a} = 2 \\left( \\frac{1}{4}(g\\mu_B)^2 \\rho_{\\mathrm{imp}}(0) \\right)\n$$\n这意味着\n$$\n\\frac{1}{1+F_0^a} = 2\n$$\n由此，我们推断出局域反对称朗道参数的值为 $F_0^a = -\\frac{1}{2}$。这个特定的负值反映了由被屏蔽的杂质介导的准粒子之间的有效铁磁相互作用，从而导致了磁化率的增强。\n\n最后，我们将这个 $F_0^a$ 的值代回到我们的威尔逊比表达式中。自旋-$\\frac{1}{2}$近藤杂质的普适威尔逊比是\n$$\nR_W = \\frac{1}{1+F_0^a} = \\frac{1}{1 + (-\\frac{1}{2})} = \\frac{1}{\\frac{1}{2}} = 2\n$$\n这个无量纲数 $2$ 是自旋-$\\frac{1}{2}$近藤模型强耦合不动点的一个标志。", "answer": "$$\\boxed{2}$$", "id": "2833123"}, {"introduction": "单个杂质的行为我们已经了解，但重费米子材料是由密集的磁矩晶格构成的，集体行为是如何涌现的？这项计算实践将引导你使用动力学平均场理论（DMFT）来模拟周期性格子模型，这是理解重费米子系统从高温非相干散射到低温相干重费米液体转变的现代方法 [@problem_id:2833108]。通过亲手构建一个简化的 DMFT 循环，你将直接模拟相干温度 $T^*$ 的出现并观察重准粒子能带的形成，从而连接起教科书模型与前沿研究。", "problem": "实现一个完整的、可运行的程序，该程序为 Bethe 格点上的周期性安德森格点模型构建并迭代一个简化的动态平均场理论 (DMFT) 循环，使用一个唯象的费米液体杂质自能来模拟近藤共振和重费米子相干性。您的程序必须在固定温度 $T$ 下，对每个测试用例执行三个典型的 DMFT 步骤，直至收敛：(i) 杂质求解，(ii) 格点格林函数更新，以及 (iii) 杂化更新。然后，根据收敛的谱函数，它必须通过一个与窄低能峰的出现相关的、数学上明确的判据来确定格点相干温度 $T^{*}$。\n\n物理和数学设置如下。\n\n- 模型：周期性安德森模型，导带具有半圆形态密度（Bethe 格点，无限配位数）。导带的半带宽为 $D$，跃迁振幅为 $t = D/2$，导带与 $f$ 轨道之间的局域杂化振幅为 $V$，局域 $f$ 能级能量为 $E_{f}$，化学势为 $\\mu$。温度在平衡态下用费米-狄拉克统计处理。\n\n- 使用的基本关系式：\n  - Bethe 格点上导带电子格林函数 $G_{c}(\\omega)$ 与局域导带自能 $\\Sigma_{c}(\\omega)$ 的局域和推迟 ($\\omega + i 0^{+}$) DMFT 自洽条件：\n    $$\n    G_{c}(\\omega)^{-1} \\;=\\; \\omega + \\mu - \\Sigma_{c}(\\omega) - t^{2} G_{c}(\\omega).\n    $$\n  - 通过对具有局域 f 自能 $\\Sigma_{f}(\\omega)$ 的局域 f 轨道积分消元得到的局域导带电子自能：\n    $$\n    \\Sigma_{c}(\\omega) \\;=\\; \\frac{V^{2}}{\\omega + \\mu - E_{f} - \\Sigma_{f}(\\omega)}.\n    $$\n  - f 杂质问题的 DMFT 杂化函数：\n    $$\n    \\Delta(\\omega) \\;=\\; V^{2} \\, G_{c}(\\omega).\n    $$\n  - f 电子格林函数的杂质戴森方程：\n    $$\n    G_{f}(\\omega) \\;=\\; \\frac{1}{\\omega + \\mu - E_{f} - \\Delta(\\omega) - \\Sigma_{f}(\\omega)}.\n    $$\n\n- 杂质求解器（唯象费米液体拟设）：在每个温度 $T$ 下，将 f 电子自能近似为\n  $$\n  \\Sigma_{f}(\\omega) \\;=\\; \\Sigma_{f}(0) \\;+\\; \\left(1 - \\frac{1}{Z}\\right)\\omega \\;-\\; i \\, \\frac{\\omega^{2} + \\left(\\pi k_{B} T\\right)^{2}}{T_{K}},\n  $$\n  其中 $k_{B}$ 是玻尔兹曼常数，$Z$ 是一个准粒子权重参数，在低温下视为与温度无关，$T_{K}$ 是根据 Schrieffer-Wolff 有效近藤交换估算的近藤标度（近藤温度）。使用半圆能带在费米能级处的导带态密度 $\\rho_{0}(0) = \\dfrac{2}{\\pi D}$ 和有效近藤交换 $J = \\dfrac{2 V^{2}}{|E_{f}|}$。然后计算近藤标度为\n  $$\n  T_{K} \\;=\\; D \\, \\sqrt{\\rho_{0}(0) \\, J} \\, \\exp\\!\\left( - \\frac{1}{\\rho_{0}(0) \\, J} \\right),\n  $$\n  并设置一个与重费米子标度行为一致的低温准粒子权重，\n  $$\n  Z \\;\\approx\\; \\min\\!\\left(0.9, \\max\\!\\left(10^{-3}, \\frac{T_{K}}{D}\\right)\\right).\n  $$\n  通过强制执行以下条件来施加 f 共振的低能钉扎：\n  $$\n  \\Sigma_{f}(0) \\;=\\; \\mu - E_{f} - \\operatorname{Re}\\Delta(\\omega{=}0),\n  $$\n  在每次 DMFT 迭代中更新，以使重整化的 f 能级被钉扎在费米能量附近。\n\n- 在固定温度 $T$ 下，在实频格点 $\\omega \\in [-\\omega_{\\max}, \\omega_{\\max}]$ 上的 DMFT 迭代，其中为推迟函数对 $\\omega$ 添加一个微小的正虚部 $+ i \\eta$：\n  1. 从 $\\Sigma_{f}(0)$ 的一个初始猜测（例如 $\\Sigma_{f}(0)=0$）开始。根据上述参数固定 $Z$和 $T_{K}$。\n  2. 使用费米液体形式和当前的 $\\Sigma_{f}(0)$ 构建 $\\Sigma_{f}(\\omega)$。\n  3. 根据上述关系式计算 $\\Sigma_{c}(\\omega)$。\n  4. 对每个 $\\omega$，求解 DMFT 二次方程 $t^{2} G_{c}^{2} - (\\omega+\\mu - \\Sigma_{c}) G_{c} + 1 = 0$ 并选择具有负虚部的物理根以获得 $G_{c}(\\omega)$。\n  5. 更新杂化函数 $\\Delta(\\omega) = V^{2} G_{c}(\\omega)$ 并设置 $\\Sigma_{f}(0) \\leftarrow \\mu - E_{f} - \\operatorname{Re}\\Delta(0)$，使用线性混合直至收敛（使用一个小的混合参数以确保稳定）。\n  6. 收敛后，计算 f 谱函数 $A_{f}(\\omega) = - \\dfrac{1}{\\pi} \\, \\operatorname{Im} G_{f}(\\omega)$。\n\n- 格点相干温度 $T^{*}$ 的出现：将在给定温度 $T$ 下，根据收敛的 $A_{f}(\\omega)$ 和自能计算出的以下三个定量条件的同时满足定义为相 coherent：\n  1. 窄峰条件（半高全宽）。令 $A_{f}(0)$ 为 $\\omega=0$ 处的谱函数值，并令 $\\mathrm{FWHM}$ 表示 $A_{f}(\\omega)$ 中中心峰的半高全宽。要求：\n     $$\n     \\mathrm{FWHM} \\;<\\; 0.05 \\, D.\n     $$\n  2. 峰显著性条件。令 $\\langle A_{f} \\rangle_{\\mathrm{base}}$ 为 $A_{f}(\\omega)$ 在基线窗口 $|\\omega| \\in [0.1 D, 0.2 D]$ 上的平均值。要求：\n     $$\n     \\frac{A_{f}(0)}{\\langle A_{f} \\rangle_{\\mathrm{base}}} \\;>\\; 5.\n     $$\n  3. 散射抑制条件。令 $\\Gamma_{\\Delta}(0) = - \\operatorname{Im}\\Delta(0)$ 且 $\\Gamma_{\\Sigma}(0) = - \\operatorname{Im}\\Sigma_{f}(0) = \\dfrac{\\left(\\pi k_{B} T\\right)^{2}}{T_{K}}$。要求：\n     $$\n     \\Gamma_{\\Sigma}(0) \\;<\\; \\frac{1}{2} \\, \\Gamma_{\\Delta}(0).\n     $$\n  对于给定的参数集，从高到低扫描一个指定的离散温度列表 $\\{ T_{i} \\}$，并将 $T^{*}$ 定义为所有三个条件都满足的最大 $T_{i}$。如果列表中没有温度满足相干条件，则定义 $T^{*} = 0$。\n\n- 单位和数值常数：\n  - 能量使用电子伏特，即 $D$, $V$, $E_{f}$, $\\mu$, $\\omega$ 和 $\\eta$ 的单位是 $\\mathrm{eV}$。\n  - 温度使用开尔文，且 $k_{B} = 8.617333262145 \\times 10^{-5} \\, \\mathrm{eV/K}$。\n  - 您的程序必须为每个测试用例输出以开尔文为单位的 $T^{*}$，并四舍五入到一位小数。\n\n- 频率格点和数值方法：\n  - 使用对称格点 $\\omega \\in [-\\omega_{\\max}, \\omega_{\\max}]$，其中 $\\omega_{\\max} = 0.6 D$ 且至少有 $1601$ 个点，以及一个小的 $\\eta = 10^{-5} \\, \\mathrm{eV}$。\n  - 对 $\\Sigma_{f}(0)$ 的更新使用简单的线性混合，混合参数在 $(0,1)$ 区间内，并迭代至收敛，$\\Sigma_{f}(0)$ 和 $\\Delta(0)$ 变化的容差小于 $10^{-8}$。\n\n测试套件。您的程序必须使用给定的温度列表，为以下三个参数集（每个都是一个独立的测试用例）计算 $T^{*}$。所有参数 $D$, $V$, $E_{f}$ 和 $\\mu$ 的单位都是 $\\mathrm{eV}$，输出的 $T^{*}$ 必须以 $\\mathrm{K}$ 为单位：\n\n- 测试用例 1（理想路径，较强杂化）：\n  - $D = 1.0$, $V = 0.30$, $E_{f} = -0.50$, $\\mu = 0.0$,\n  - 温度 $\\{ T_{i} \\}$，单位 K：$[300, 250, 200, 150, 120, 100, 80, 60, 50, 40, 30, 20, 15, 10]$。\n- 测试用例 2（具有低近藤标度的重费米子）：\n  - $D = 1.0$, $V = 0.20$, $E_{f} = -0.50$, $\\mu = 0.0$,\n  - 温度 $\\{ T_{i} \\}$，单位 K：$[300, 200, 150, 100, 80, 60, 40, 30, 20, 15, 10, 8, 6, 5, 4, 3, 2, 1]$。\n- 测试用例 3（边缘情况，极弱杂化；预计在扫描范围内无相干性）：\n  - $D = 1.0$, $V = 0.10$, $E_{f} = -0.50$, $\\mu = 0.0$,\n  - 温度 $\\{ T_{i} \\}$，单位 K：$[300, 200, 150, 100, 80, 60, 40, 30, 20, 15, 10, 8, 6, 5, 4, 3, 2, 1]$。\n\n最终输出格式。您的程序应生成单行输出，包含一个方括号括起来的逗号分隔列表，例如 $[x_{1},x_{2},x_{3}]$，其中每个 $x_{j}$ 是测试用例 $j$ 的 $T^{*}$ 值（单位为 K），四舍五入到一位小数的浮点数。", "solution": "该问题要求实现一个程序，用于计算 Bethe 格点上周期性安德森模型的重费米子相干温度，记为 $T^{*}$。计算框架是动态平均场理论 (DMFT)，并为杂质问题增补了一个唯象的费米液体自能。解决方案涉及两个主要阶段：首先，对于给定的温度 $T$，执行自洽的 DMFT 计算以获得收敛的电子格林函数；其次，根据一组明确的判据分析所得的光谱特性，以确定是否已形成相干态。对一个温度列表重复此过程，以找到建立相干性的最高温度 $T^{*}$。整个实现必须基于所提供的精确物理和数学规范。\n\n物理系统是周期性安德森模型，这是重费米子材料的一个典型模型，其中局域化的 f 电子与巡游的导带电子相互作用。模型参数是导带半带宽 $D$、局域杂化 $V$、f 能级能量 $E_f$ 和化学势 $\\mu$。格点是具有无限配位数的 Bethe 格点，这通过使自能变为纯局域量简化了 DMFT 形式体系。导带态密度是半圆形的，跃迁参数通过 $t = D/2$ 与半带宽相关。\n\n计算的核心是 DMFT 自洽循环，它将格点问题映射到一个必须自洽求解的单杂质安德森模型。在固定温度 $T$ 下，循环过程如下：\n\n$1$. 对局域 f 电子自能 $\\Sigma_f(\\omega)$ 作出初始猜测。问题在实频轴上为 $\\Sigma_f(\\omega)$ 指定了一个唯象的费米液体拟设（为了满足因果性，附带一个小的虚部 $i\\eta$，即 $\\omega \\to \\omega + i\\eta$）：\n$$\n\\Sigma_{f}(\\omega) \\;=\\; \\Sigma_{f}(0) \\;+\\; \\left(1 - \\frac{1}{Z}\\right)\\omega \\;-\\; i \\, \\frac{\\omega^{2} + \\left(\\pi k_{B} T\\right)^{2}}{T_{K}}\n$$\n这种形式捕捉了近藤共振的基本物理。项 $(1 - 1/Z)\\omega$ 描述了重费米子特有的大质量增强（小准粒子权重 $Z$）。虚部描述了准粒子的非弹性散射，它遵循费米液体理论所预期的 $T^2$ 和 $\\omega^2$ 依赖关系。参数 $T_K$（近藤温度）和 $Z$ 是根据指定的输入参数 $D$、$V$ 和 $E_f$ 为每个测试用例预先计算的，反映了从 Schrieffer-Wolff 变换派生的潜在单杂质近藤物理。自能的静态部分 $\\Sigma_f(0)$ 是在 DMFT 循环中更新的主要变量。\n\n$2$. 利用当前的 $\\Sigma_f(\\omega)$，计算导带电子的自能 $\\Sigma_c(\\omega)$。该项源于连接导带和 f 轨道的局域杂化 $V$：\n$$\n\\Sigma_{c}(\\omega) \\;=\\; \\frac{V^{2}}{\\omega + \\mu - E_{f} - \\Sigma_{f}(\\omega)}\n$$\n\n$3$. 然后，使用 Bethe 格点的 DMFT 自洽方程计算导带电子的局域格点格林函数 $G_c(\\omega)$。这会得到一个关于 $G_c(\\omega)$ 的二次方程：\n$$\nt^{2} G_{c}^{2}(\\omega) - (\\omega + \\mu - \\Sigma_{c}(\\omega)) G_{c}(\\omega) + 1 = 0\n$$\n物理上正确的解是满足因果性（即 $\\mathrm{Im}G_c(\\omega) < 0$）并且对于大 $\\omega$ 具有正确渐近行为 $G_c(\\omega) \\sim 1/\\omega$ 的解。这唯一地确定了 $G_c(\\omega)$。\n\n$4$. 然后，根据更新的 $G_c(\\omega)$ 计算有效杂质问题的新杂化函数 $\\Delta(\\omega)$：\n$$\n\\Delta(\\omega) \\;=\\; V^{2} \\, G_{c}(\\omega)\n$$\n该函数描述了局域 f 电子所处的有效媒介或“浴”。\n\n$5$. 通过更新 f 自能的静态部分 $\\Sigma_f(0)$ 来闭合循环。问题指定了一个钉扎条件，确保重整化的 f 能级保持在费米能量处，这对近藤共振的形成至关重要。该更新由下式给出：\n$$\n\\Sigma_{f}(0)_{\\text{new}} \\;=\\; \\mu - E_{f} - \\operatorname{Re}\\Delta(\\omega{=}0)\n$$\n为确保稳定收敛，使用线性混合参数将此新值与前一次迭代的值混合。重复步骤 1 到 5，直到 $\\Sigma_f(0)$ 和 $\\Delta(\\omega=0)$ 在迭代间的变化小于指定的容差。\n\n一旦 DMFT 循环在给定温度 $T$ 下收敛，系统的性质就完全确定了。最后一步是检查相干性的出现。相干温度 $T^{*}$ 被定义为给定列表中，三个特定的物理条件同时满足的最高温度，这标志着在费米能级处形成了一个相干的、窄的准粒子能带。这些条件是使用收敛的量来评估的：\n\n$1$. **窄峰条件**：f 电子谱函数 $A_f(\\omega) = -\\frac{1}{\\pi}\\mathrm{Im}G_f(\\omega)$ 中中心峰的半高全宽（FWHM）必须远小于总能带尺度：$\\mathrm{FWHM} < 0.05 D$。这标志着长寿命准粒子的形成。\n\n$2$. **峰显著性条件**：费米能级（$\\omega=0$）处的峰必须与高能背景特征有明显区分。峰高 $A_f(0)$ 与基线窗口 $|\\omega| \\in [0.1 D, 0.2 D]$ 内平均谱权重的比率必须超过一个阈值：$A_f(0) / \\langle A_f \\rangle_{\\text{base}} > 5$。\n\n$3$. **散射抑制条件**：相干性要求准粒子寿命长。费米能级处的非弹性散射率 $\\Gamma_{\\Sigma}(0) = -\\mathrm{Im}\\Sigma_f(0) = (\\pi k_B T)^2 / T_K$ 必须显著小于由杂化引起的展宽 $\\Gamma_{\\Delta}(0) = -\\mathrm{Im}\\Delta(0)$。具体条件是 $\\Gamma_{\\Sigma}(0) < 0.5 \\Gamma_{\\Delta}(0)$。\n\n程序从高到低遍历一个提供的温度列表。第一个满足所有三个条件的温度被宣布为 $T^{*}$。如果列表中的温度均不满足标准，则 $T^{*}$ 被设为 0。该算法使用指定的数值参数，在离散的频率格点上进行数值实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the DMFT calculation for all test cases and print the results.\n    \"\"\"\n    # Boltzmann constant in eV/K\n    KB_EV_K = 8.617333262145e-5\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'D': 1.0, 'V': 0.30, 'E_f': -0.50, 'mu': 0.0,\n            'T_list': [300, 250, 200, 150, 120, 100, 80, 60, 50, 40, 30, 20, 15, 10]\n        },\n        {\n            'D': 1.0, 'V': 0.20, 'E_f': -0.50, 'mu': 0.0,\n            'T_list': [300, 200, 150, 100, 80, 60, 40, 30, 20, 15, 10, 8, 6, 5, 4, 3, 2, 1]\n        },\n        {\n            'D': 1.0, 'V': 0.10, 'E_f': -0.50, 'mu': 0.0,\n            'T_list': [300, 200, 150, 100, 80, 60, 40, 30, 20, 15, 10, 8, 6, 5, 4, 3, 2, 1]\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        t_star = calculate_coherence_temp(KB_EV_K=KB_EV_K, **params)\n        results.append(t_star)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.1f}' for r in results)}]\")\n\ndef run_dmft_loop(T, D, V, E_f, mu, t, T_K, Z, omega_complex, zero_idx, KB_EV_K):\n    \"\"\"\n    Performs the self-consistent DMFT calculation at a fixed temperature T.\n    \"\"\"\n    mixing = 0.2\n    tol = 1e-9\n    max_iter = 500\n\n    Sigma_f0 = 0.0\n    Delta0_val = 0.0 + 0.0j\n\n    for _ in range(max_iter):\n        Sigma_f0_old = Sigma_f0\n        Delta0_old_val = Delta0_val\n\n        # Step 1-2: Construct Sigma_f(w)\n        omega_real = omega_complex.real\n        Sigma_f = (Sigma_f0_old + (1.0 - 1.0/Z) * omega_real\n                   - 1j * (omega_real**2 + (np.pi * KB_EV_K * T)**2) / T_K)\n\n        # Step 3: Compute Sigma_c(w)\n        denominator_Sc = omega_complex + mu - E_f - Sigma_f\n        # Avoid division by zero, although eta should prevent it.\n        denominator_Sc[np.abs(denominator_Sc) < 1e-12] = 1e-12\n        Sigma_c = V**2 / denominator_Sc\n\n        # Step 4: Solve for G_c(w)\n        w_z = omega_complex + mu\n        b = -(w_z - Sigma_c)\n        discriminant = np.sqrt(b**2 - 4 * t**2)\n        G_c = (-b - discriminant) / (2 * t**2)\n\n        # Step 5: Update Delta and Sigma_f(0)\n        Delta = V**2 * G_c\n        Delta0_val = Delta[zero_idx]\n        \n        Sigma_f0_new_unmixed = mu - E_f - Delta0_val.real\n        Sigma_f0 = mixing * Sigma_f0_new_unmixed + (1.0 - mixing) * Sigma_f0_old\n        \n        err_S = abs(Sigma_f0 - Sigma_f0_old)\n        err_D = abs(Delta0_val - Delta0_old_val)\n        if err_S < tol and err_D < tol:\n            return Delta, Sigma_f\n\n    return None, None # Convergence failed\n\ndef calculate_coherence_temp(D, V, E_f, mu, T_list, KB_EV_K):\n    \"\"\"\n    Scans temperatures to find the coherence temperature T*.\n    \"\"\"\n    eta = 1e-5\n    omega_max = 0.6 * D\n    num_points = 1601\n    omega = np.linspace(-omega_max, omega_max, num_points)\n    omega_complex = omega + 1j * eta\n    zero_idx = (num_points - 1) // 2\n    \n    t = D / 2.0\n    rho0_0 = 2.0 / (np.pi * D)\n    J = 2.0 * V**2 / abs(E_f)\n    \n    rho0_J = rho0_0 * J\n    if rho0_J <= 0:\n        return 0.0 # No Kondo effect\n    T_K = D * np.sqrt(rho0_J) * np.exp(-1.0 / rho0_J)\n    Z = min(0.9, max(1e-3, T_K / D))\n\n    for T in sorted(T_list, reverse=True):\n        converged_data = run_dmft_loop(T, D, V, E_f, mu, t, T_K, Z, omega_complex, zero_idx, KB_EV_K)\n        \n        if converged_data[0] is None:\n            continue\n        \n        Delta, Sigma_f = converged_data\n\n        # Calculate spectral function A_f\n        G_f = 1.0 / (omega_complex + mu - E_f - Delta - Sigma_f)\n        A_f = -1.0 / np.pi * G_f.imag\n\n        # Condition 1: Narrow peak (FWHM)\n        A_f_0 = A_f[zero_idx]\n        half_max = A_f_0 / 2.0\n        \n        omega_pos = omega[zero_idx:]\n        A_f_pos = A_f[zero_idx:]\n        cross_indices_r = np.where(A_f_pos < half_max)[0]\n        \n        if len(cross_indices_r) == 0 or cross_indices_r[0] == 0:\n            fwhm = 2 * omega_max\n        else:\n            idx_r = cross_indices_r[0]\n            w_right = np.interp(half_max, [A_f_pos[idx_r], A_f_pos[idx_r-1]], [omega_pos[idx_r], omega_pos[idx_r-1]])\n            fwhm = 2.0 * w_right\n        \n        cond1_met = (fwhm < 0.05 * D)\n\n        # Condition 2: Peak prominence\n        baseline_mask = (np.abs(omega) >= 0.1 * D) & (np.abs(omega) <= 0.2 * D)\n        if not np.any(baseline_mask) or np.mean(A_f[baseline_mask]) < 1e-9:\n             cond2_met = False\n        else:\n            A_f_base_avg = np.mean(A_f[baseline_mask])\n            prominence = A_f_0 / A_f_base_avg\n            cond2_met = (prominence > 5.0)\n\n        # Condition 3: Scattering suppression\n        Gamma_Sigma_0 = (np.pi * KB_EV_K * T)**2 / T_K\n        Gamma_Delta_0 = -Delta[zero_idx].imag\n        cond3_met = (Gamma_Sigma_0 < 0.5 * Gamma_Delta_0)\n\n        if cond1_met and cond2_met and cond3_met:\n            return float(T)\n            \n    return 0.0\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2833108"}]}