{"hands_on_practices": [{"introduction": "在深入探讨量子霍尔效应的完全量子图像之前，首先回顾电子在电场和磁场中的经典运动是很有启发性的。这个练习将引导你运用导心漂移的概念来分析电子在谐振子禁闭势中的轨道进动。通过解决这个问题，你将获得对构成霍尔效应基础的 $\\mathbf{E} \\times \\mathbf{B}$ 漂移的半经典直观理解 [@problem_id:1155392]。", "problem": "一个电荷为 $-e$、质量为 $m_e$ 的电子被限制在 $xy$ 平面内运动。一个均匀的静磁场 $\\mathbf{B} = B\\hat{z}$ 垂直于该平面施加。此外，该电子还受到一个弱的、圆柱对称的谐波限制势能 $U(r) = \\frac{1}{2} k r^2$ 的作用，其中 $r = \\sqrt{x^2+y^2}$ 是离原点的径向距离，而 $k$ 是一个代表限制刚度的正常数。\n\n假设限制足够弱，以至于电子的运动可以用其导向中心的经典漂移来描述。导向中心是电子在其快速回旋运动过程中的平均位置。这种漂移运动描绘出一条围绕原点的圆形路径。\n\n计算这个进动的角速度 $\\Omega$。角速度由关系式 $\\mathbf{v}_{gc} = \\boldsymbol{\\Omega} \\times \\mathbf{r}$ 定义，其中 $\\mathbf{v}_{gc}$ 是导向中心速度，$\\mathbf{r}$ 是其位置矢量，而 $\\boldsymbol{\\Omega} = \\Omega \\hat{z}$。", "solution": "1.  **从势能确定电场**\n\n    题目给出了电子的势能 $U(r)$。作用在电子上的静电力由其势能的负梯度给出，即 $\\mathbf{F} = -\\nabla U$。电场 $\\mathbf{E}$ 与作用在电荷 $q$ 上的力 $\\mathbf{F}$ 的关系为 $\\mathbf{F} = q\\mathbf{E}$。对于我们的电子，电荷为 $q = -e$。\n\n    所以，$\\mathbf{E} = \\frac{\\mathbf{F}}{q} = \\frac{-\\nabla U}{-e} = \\frac{1}{e}\\nabla U$。\n\n    势能为 $U(r) = \\frac{1}{2} k r^2 = \\frac{1}{2} k (x^2 + y^2)$。\n    在笛卡尔坐标系中，梯度为：\n    $$\n    \\nabla U = \\left( \\frac{\\partial U}{\\partial x}, \\frac{\\partial U}{\\partial y}, \\frac{\\partial U}{\\partial z} \\right) = (kx, ky, 0) = k\\mathbf{r}\n    $$\n    其中 $\\mathbf{r} = (x, y, 0)$ 是平面内的位置矢量。\n    因此，电场为：\n    $$\n    \\mathbf{E} = \\frac{k}{e}\\mathbf{r} = \\frac{k}{e}(x\\hat{x} + y\\hat{y})\n    $$\n\n2.  **导向中心漂移速度**\n\n    在同时存在电场 $\\mathbf{E}$ 和磁场 $\\mathbf{B}$ 的情况下，带电粒子会表现出一种漂移速度，称为 $\\mathbf{E}\\times\\mathbf{B}$ 漂移。这种漂移垂直于两个场。导向中心近似假设力在平均意义上是平衡的，忽略了导向中心的加速度。洛伦兹力方程为：\n    $$\n    m_e \\frac{d\\mathbf{v}}{dt} = -e(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B})\n    $$\n    假设漂移速度 $\\mathbf{v}_{gc}$ 是恒定的或缓慢变化的，我们可以将平均力设为零：\n    $$\n    0 \\approx -e(\\mathbf{E} + \\mathbf{v}_{gc} \\times \\mathbf{B})\n    $$\n    这得到 $\\mathbf{E} = -\\mathbf{v}_{gc} \\times \\mathbf{B} = \\mathbf{B} \\times \\mathbf{v}_{gc}$。为了求解 $\\mathbf{v}_{gc}$，我们用 $\\mathbf{B}$ 做叉积：\n    $$\n    \\mathbf{E} \\times \\mathbf{B} = (\\mathbf{B} \\times \\mathbf{v}_{gc}) \\times \\mathbf{B}\n    $$\n    使用矢量三重积恒等式 $\\mathbf{A}\\times(\\mathbf{B}\\times\\mathbf{C}) = \\mathbf{B}(\\mathbf{A}\\cdot\\mathbf{C}) - \\mathbf{C}(\\mathbf{A}\\cdot\\mathbf{B})$：\n    $$\n    \\mathbf{E} \\times \\mathbf{B} = \\mathbf{v}_{gc}(\\mathbf{B}\\cdot\\mathbf{B}) - \\mathbf{B}(\\mathbf{v}_{gc}\\cdot\\mathbf{B})\n    $$\n    由于运动在 $xy$ 平面内，$\\mathbf{v}_{gc}$ 垂直于 $\\mathbf{B}$，所以 $\\mathbf{v}_{gc}\\cdot\\mathbf{B} = 0$。方程简化为：\n    $$\n    \\mathbf{E} \\times \\mathbf{B} = \\mathbf{v}_{gc} B^2\n    $$\n    这给出了著名的漂移速度公式：\n    $$\n    \\mathbf{v}_{gc} = \\frac{\\mathbf{E} \\times \\mathbf{B}}{B^2}\n    $$\n\n3.  **计算具体的漂移速度**\n\n    现在我们将 $\\mathbf{E}$ 和 $\\mathbf{B}$ 的表达式代入漂移速度公式。\n    $\\mathbf{E} = \\frac{k}{e}\\mathbf{r} = (\\frac{kx}{e}, \\frac{ky}{e}, 0)$\n    $\\mathbf{B} = (0, 0, B)$\n\n    叉积 $\\mathbf{E} \\times \\mathbf{B}$ 是：\n    $$\n    \\mathbf{E} \\times \\mathbf{B} = \\begin{vmatrix} \\hat{x} & \\hat{y} & \\hat{z} \\\\ kx/e & ky/e & 0 \\\\ 0 & 0 & B \\end{vmatrix} = \\hat{x}\\left(\\frac{ky}{e}B\\right) - \\hat{y}\\left(\\frac{kx}{e}B\\right) + \\hat{z}(0) = \\left(\\frac{kBy}{e}, -\\frac{kBx}{e}, 0\\right)\n    $$\n    现在，我们求出速度：\n    $$\n    \\mathbf{v}_{gc} = \\frac{1}{B^2} \\left(\\frac{kBy}{e}, -\\frac{kBx}{e}, 0\\right) = \\left(\\frac{ky}{eB}, -\\frac{kx}{eB}, 0\\right)\n    $$\n\n4.  **确定角速度**\n\n    题目要求标量角速度 $\\Omega$，其中导向中心的速度由 $\\mathbf{v}_{gc} = \\mathbf{\\Omega} \\times \\mathbf{r}$ 给出。当 $\\mathbf{\\Omega} = \\Omega \\hat{z}$ 且 $\\mathbf{r} = (x, y, 0)$ 时，该关系式给出：\n    $$\n    \\mathbf{\\Omega} \\times \\mathbf{r} = \\begin{vmatrix} \\hat{x} & \\hat{y} & \\hat{z} \\\\ 0 & 0 & \\Omega \\\\ x & y & 0 \\end{vmatrix} = \\hat{x}(-\\Omega y) - \\hat{y}(-\\Omega x) + \\hat{z}(0) = (-\\Omega y, \\Omega x, 0)\n    $$\n    我们将其与我们计算出的导向中心速度表达式相等：\n    $$\n    (-\\Omega y, \\Omega x, 0) = \\left(\\frac{ky}{eB}, -\\frac{kx}{eB}, 0\\right)\n    $$\n    通过比较分量，我们可以求出 $\\Omega$。从 $\\hat{x}$ 分量：\n    $$\n    -\\Omega y = \\frac{ky}{eB} \\implies \\Omega = -\\frac{k}{eB}\n    $$\n    从 $\\hat{y}$ 分量：\n    $$\n    \\Omega x = -\\frac{kx}{eB} \\implies \\Omega = -\\frac{k}{eB}\n    $$\n    两个分量给出了相同的结果。角速度为负，表示顺时针进动，这对于处于该势场中的电子是预期的结果。", "answer": "$$ \\boxed{-\\frac{k}{eB}} $$", "id": "1155392"}, {"introduction": "Landauer-Büttiker 形式主义是描述介观系统中量子输运的强大理论框架。这个练习将该形式主义应用于一个四端霍尔棒结构，探索其中一个接触不完美时系统的行为。通过这个计算，你将亲身验证一个量子霍尔效应的核心特征：即使存在局部散射，霍尔电阻的量子化依然保持不变，这深刻揭示了边缘态的拓扑鲁棒性 [@problem_id:1155444]。", "problem": "一个四端霍尔棒由二维电子气（2DEG）制成。这些端点排列成十字几何结构，并按逆时针顺序标记为 1, 2, 3, 4。一个强的垂直磁场 $B$ 使系统处于整数量子霍尔（IQH）区，体填充因子为 $\\nu$，从而产生 $\\nu$ 个同样逆时针传播的手性边缘通道。\n\n霍尔电阻 $R_H$ 的测量方法是：将电流 $I$ 注入端点 1 并从端点 3 引出，同时测量端点 2 和 4 之间的电压差 $V_H = V_2 - V_4$。端点 2 和 4 作为理想电压探针（不汲取电流）。\n\n端点 4 与二维电子气存在非理想耦合。该耦合通过一个局域、时间反演对称的散射体进行建模。一个电子通过边缘通道到达端点 4 的连接处时，有概率 $T$ 透射进入端点 4 的电极库，有概率 $1-T$ 被反射并沿着下一段边缘继续传播。透射概率 $T$ 满足 $0 < T < 1$。\n\n使用 Landauer-Büttiker 形式理论，确定霍尔电阻 $R_H = V_H / I$。", "solution": "根据Landauer-Büttiker形式理论，流入第 $i$ 个端点的净电流 $I_i$ 由进入该端点的边缘态的化学势 $\\mu_{in}$ 与该端点自身电极库的化学势 $\\mu_i$ 之差决定。对于 $\\nu$ 个边缘通道，有 $I_i = \\frac{\\nu e}{h}(\\mu_{in} - \\mu_i)$。\n\n1.  **分析各端点的化学势和电流**\n    - 系统的手性边缘通道按 $1 \\to 2 \\to 3 \\to 4 \\to 1$ 的顺序逆时针传播。\n    - 端点 2 和 4 是理想电压探针，意味着没有净电流流入或流出 ($I_2 = 0$ 且 $I_4 = 0$) 。\n    - 对于端点 2，流入的电子来自端点 1，因此其流入化学势为 $\\mu_1$。所以 $I_2 = \\frac{\\nu e}{h}(\\mu_1 - \\mu_2) = 0$，这得出 $\\mu_2 = \\mu_1$。\n    - 对于端点 4，流入的电子来自端点 3，但会经过一个散射体。进入端点 4 的电流正比于透射概率 $T$ 和化学势之差 $(\\mu_3 - \\mu_4)$。由于 $I_4 = \\frac{\\nu e}{h} T (\\mu_3 - \\mu_4) = 0$ 且 $T \\neq 0$，我们必须有 $\\mu_4 = \\mu_3$。\n\n2.  **计算霍尔电阻**\n    - 测量设置规定，将电流 $I$ 注入端点 1 并从端点 3 引出。这意味着在端点 2 和 3 之间的边缘通道上承载了大小为 $I$ 的净电流（从端点2流向端点3）。该电流由两端化学势之差驱动：$I = \\frac{\\nu e}{h}(\\mu_2 - \\mu_3)$。\n    - 霍尔电压定义为 $V_H = V_2 - V_4$。电压与化学势的关系为 $V = \\mu/e$。\n    - 因此，$V_H = (\\mu_2 - \\mu_4) / e$。\n    - 将第一步的结果（$\\mu_2 = \\mu_1$ 和 $\\mu_4 = \\mu_3$）代入电压表达式：$V_H = (\\mu_1 - \\mu_3) / e$。\n    - 从电流的表达式中，我们有 $\\mu_2 - \\mu_3 = \\frac{I h}{\\nu e}$。因为 $\\mu_2 = \\mu_1$，所以 $\\mu_1 - \\mu_3 = \\frac{I h}{\\nu e}$。\n    - 将此关系代入电压表达式：$V_H = \\frac{1}{e} \\left( \\frac{I h}{\\nu e} \\right) = \\frac{I h}{\\nu e^2}$。\n    - 最后，霍尔电阻为 $R_H = \\frac{V_H}{I} = \\frac{h}{\\nu e^2}$。\n\n这个结果表明，霍尔电阻的值仅取决于填充因子 $\\nu$ 和基本物理常数，而与不完美接触的透射概率 $T$ 无关。这正是量子霍尔效应鲁棒性的一个体现，其根源在于边缘态的拓扑保护。", "answer": "$$\\boxed{\\dfrac{h}{\\nu e^2}}$$", "id": "1155444"}, {"introduction": "本练习是一个面向研究的高级计算实践，要求你建立一个真实的半导体量子阱的自洽模型，从而超越过分简化的理论模型。你需要通过数值方法求解耦合的薛定谔-泊松方程，来探索电子间的相互作用（哈特里势）如何重塑子带结构。最终，你将确定在给定的磁场和电子密度下，哪些子带的朗道能级对整数填充因子有贡献，这与凝聚态物理的前沿研究工作紧密相连 [@problem_id:2830254]。", "problem": "考虑一个二维电子系统，被限制在沿 $z$ 方向生长的单个对称宽量子阱中。电子在 $x$–$y$ 平面内自由运动，而在 $z$ 方向上的运动是量子化的。在一个沿 $+\\hat{z}$ 方向的垂直磁场 $B$ 中，假设系统在 $x$–$y$ 平面具有平移不变性，并用有效质量 $m^\\ast$ 和静态介电常数 $\\varepsilon=\\varepsilon_r\\varepsilon_0$ 来对电子进行建模。在零温下进行计算。你的任务是，对于给定的参数，计算沿 $z$ 方向的自洽 Hartree 势和由此产生的子带结构，然后确定在整数量子霍尔效应 (IQHE) 中，哪些子带对整数填充因子有贡献。\n\n计算所依据的基本和建模假设如下：\n- 描述沿 $z$ 方向运动的一维单粒子薛定谔方程为：\n$$\n\\left[-\\frac{\\hbar^2}{2 m^\\ast}\\frac{d^2}{dz^2} + V_{\\mathrm{conf}}(z) + V_{\\mathrm{H}}(z)\\right]\\psi_n(z) = \\varepsilon_n \\,\\psi_n(z)\n$$\n其中 $V_{\\mathrm{conf}}(z)$ 是量子阱的结构限制势，$V_{\\mathrm{H}}(z)$ 是由电子-电子排斥和正背景引起的 Hartree 势能。\n- 在平面内，朗道量子化产生能量为以下值的朗道能级：\n$$\nE_{n,\\ell} = \\varepsilon_n + \\left(\\ell + \\tfrac{1}{2}\\right)\\hbar\\omega_c,\n$$\n其中 $\\omega_c = eB/m^\\ast$ 且 $\\ell \\in \\{0,1,2,\\dots\\}$。每个朗道能级单位面积的简并度为：\n$$\ng_B = \\frac{eB}{h}.\n$$\n- 静电势 $\\phi(z)$ 满足泊松方程：\n$$\n\\frac{d^2 \\phi}{dz^2} = -\\frac{\\rho(z)}{\\varepsilon},\n$$\n其电荷密度为 $\\rho(z) = e\\left[n_{\\mathrm{bg}}(z) - n_e(z)\\right]$。电子的 Hartree 势能为 $V_{\\mathrm{H}}(z) = -e\\,\\phi(z)$，因此：\n$$\n\\frac{d^2 V_{\\mathrm{H}}}{dz^2} = \\frac{e^2}{\\varepsilon}\\left[n_{\\mathrm{bg}}(z) - n_e(z)\\right].\n$$\n- 三维电子密度由下式给出：\n$$\nn_e(z) = \\sum_{n} n_n\\,|\\psi_n(z)|^2,\n$$\n其中 $n_n$ 是由子带 $n$ 贡献的面密度，包络函数归一化为 $\\int |\\psi_n(z)|^2\\,dz = 1$。\n- 量子阱是对称且宽的。为明确起见，将 $V_{\\mathrm{conf}}(z)$ 视为宽度为 $W$、以生长轴为中心的无限深势阱，即运动被限制在长度为 $W$ 的区间内，在两侧阱壁处满足狄利克雷边界条件 $\\psi_n=0$，且阱内 $V_{\\mathrm{conf}}(z)=0$。对 Hartree 势能，在两侧阱壁处施加狄利克雷边界条件 $V_{\\mathrm{H}}=0$。\n- 为保持整体电中性，在阱内使用均匀的正背景电荷，其密度为 $n_{\\mathrm{bg}}(z) = N_s/W$，其中 $N_s$ 是指定的总电子面密度。\n\n算法任务：\n1. 在宽度为 $W$ 的区间上对 $z$ 域进行均匀离散化，并在边界处对 $\\psi_n$ 和 $V_{\\mathrm{H}}$ 施加狄利克雷边界条件。使用中心有限差分法来近似二阶导数。\n2. 初始化 $V_{\\mathrm{H}}(z)=0$。求解一维薛定谔本征问题，并保留固定数量的能量为 $\\varepsilon_n$ 的最低子带及其归一化包络函数 $\\psi_n(z)$。\n3. 对于给定的磁场 $B$ 和面密度 $N_s$，通过按能量递增的顺序填充离散能级集合 $\\{E_{n,\\ell}\\}$，直到总面密度 $N_s$ 被简并度 $g_B$ 完全占据，从而在零温下确定各子带的面密度 $n_n$。根据子带能量偏移 $\\varepsilon_n$ 和回旋能量的相对大小，可能出现多个子带的朗道能级先于最低子带的较高朗道能级被填充的情况。如果填充因子不是整数，则最高的部分填充朗道能级会贡献一个分数权重；然而，在下面的测试集中，参数的选择使得填充因子为整数。\n4. 通过已占据态构建电子密度 $n_e(z)$：$n_e(z) = \\sum_n n_n |\\psi_n(z)|^2$。\n5. 在指定的边界条件下求解泊松方程得到 $V_{\\mathrm{H}}(z)$，并通过线性混合更新 $V_{\\mathrm{H}}(z)$ 以达到自洽。迭代步骤 2-5，直到 $V_{\\mathrm{H}}(z)$ 收敛。\n6. 收敛后，确定子带索引集合 $\\{n\\}$，其中 $n_n > 0$，即子带 $n$ 中至少有一个朗道能级被填充。整数填充因子为 $\\nu = N_s/g_B = N_s h/(eB)$。\n\n材料参数常数：\n- 使用 $m^\\ast = 0.067\\,m_e$，其中 $m_e$ 是电子质量。\n- 对砷化镓，使用 $\\varepsilon_r = 12.9$，因此 $\\varepsilon = \\varepsilon_r \\varepsilon_0$。\n- 对 $e$、$h$ 和 $\\hbar$ 使用标准值。\n\n数值要求：\n- 确保有限差分离散化和本征值求解器对于给定的阱宽具有足够的精度。\n- 对 Hartree 势的更新使用鲁棒的迭代混合方案。\n- 自洽收敛容差的选择应确保所识别出的有贡献的子带对于进一步的迭代是稳定的。\n\n测试集：\n计算并报告以下三个参数集的结果。每个案例指定了阱宽 $W$、磁场 $B$ 和总电子面密度 $N_s$。所有物理输入量均以国际单位制（SI）给出。输出为无量纲整数。\n\n- 案例 1：$W = 30\\,\\mathrm{nm}$，$B = 8\\,\\mathrm{T}$，$N_s = 3.8690469\\times 10^{15}\\,\\mathrm{m}^{-2}$。\n- 案例 2：$W = 60\\,\\mathrm{nm}$，$B = 6\\,\\mathrm{T}$，$N_s = 5.8029803\\times 10^{15}\\,\\mathrm{m}^{-2}$。\n- 案例 3：$W = 80\\,\\mathrm{nm}$，$B = 6\\,\\mathrm{T}$，$N_s = 8.7044704\\times 10^{15}\\,\\mathrm{m}^{-2}$。\n\n每个案例要求的最终输出：\n- 整数填充因子 $\\nu$，计算公式为 $\\nu = N_s h/(eB)$，并四舍五入到最接近的整数。\n- 对 $\\nu$ 有贡献的子带数量 $K$ (即那些 $n_n > 0$ 的子带)。\n- $K$ 个有贡献的子带索引，按升序排列。子带按 $\\varepsilon_n$ 递增排序，并使用基于 1 的索引。\n\n最终输出格式：\n你的程序应产生单行输出，包含一个由三个列表组成的列表，每个案例对应一个列表，其形式为 $[\\nu, K, s_1, s_2, \\dots, s_K]$，且只包含整数。全部输出必须是遵循以下确切格式的单行：\n$$\n[[\\nu_1, K_1, s_{1,1}, \\dots, s_{1,K_1}], [\\nu_2, K_2, s_{2,1}, \\dots, s_{2,K_2}], [\\nu_3, K_3, s_{3,1}, \\dots, s_{3,K_3}]].\n$$\n输出中不应出现单位。不使用角度单位。所有中间计算必须在内部使用国际单位制（SI）进行。", "solution": "所述问题是有效的。它提出了一个凝聚态物理学中标准的、适定的问题：在垂直磁场下，对宽量子阱中二维电子气的电子结构进行自洽计算。该物理模型基于 Hartree 近似框架下的薛定谔-泊松方程组，这是多体物理学的基石。参数、边界条件和算法步骤的说明足够清晰，并且在科学上是合理的。这是一个非平凡的计算任务，它正确地模拟了在整数量子霍尔效应体系中，量子限制、电子-电子相互作用和朗道量子化之间的竞争。\n\n解决方案是通过实现指定的迭代自洽场 (SCF) 程序获得的。该方法的核心是为 Hartree 势 $V_{\\mathrm{H}}(z)$ 以及相应的电子波函数 $\\psi_n(z)$ 和子带能量 $\\varepsilon_n$ 寻找一个定态解。\n\n计算区域，一个宽度为 $W$ 的一维量子阱，沿 $z$ 轴被离散化为一个包含 $N_z$ 个点、间距为 $\\Delta z$ 的均匀网格。我以 $z=0$ 作为阱的中心，因此区域为 $[-W/2, W/2]$。在阱壁处施加狄利克雷边界条件 $\\psi_n(\\pm W/2)=0$ 和 $V_{\\mathrm{H}}(\\pm W/2)=0$。\n\n包络函数 $\\psi_n(z)$ 的一维薛定谔方程为\n$$\n\\left[-\\frac{\\hbar^2}{2 m^\\ast}\\frac{d^2}{dz^2} + V_{\\mathrm{H}}(z)\\right]\\psi_n(z) = \\varepsilon_n \\psi_n(z)\n$$\n该方程在离散网格上作为矩阵本征值问题求解。二阶导数算符使用中心有限差分格式进行近似，从而得到针对内部网格点的三对角哈密顿矩阵。本征解 $(\\varepsilon_n, \\psi_n)$ 通过数值本征求解器找到。计算出的本征向量被归一化，使得 $\\int_{-W/2}^{W/2} |\\psi_n(z)|^2 dz = 1$。必须计算足够多的子带数量 $N_{sub}$，以便为已占据态形成一个足够完备的基。\n\n对于 $V_{\\mathrm{H}}(z)$ 的某次迭代，一旦子带能量 $\\varepsilon_n$ 已知，朗道能级的能量就由 $E_{n,\\ell} = \\varepsilon_n + (\\ell + 1/2)\\hbar\\omega_c$ 给出，其中 $\\omega_c = eB/m^\\ast$ 是回旋频率。在零温下，电子从最低能级开始填充这些离散能级。每个朗道能级单位面积的简并度是 $g_B = eB/h$。给定总电子面密度 $N_s$，整数填充因子为 $\\nu = N_s/g_B$。我们从所有态 $\\{E_{n,\\ell}\\}$ 的组合列表中填充能量最低的 $\\nu$ 个能级。然后，通过对属于该子带的所有已占据朗道能级的简并度求和，来计算每个子带的面密度 $n_n$：$n_n = g_B \\times (\\text{子带 } n \\text{ 中已占据的能级数})$。\n\n利用子带密度 $n_n$ 和波函数 $\\psi_n(z)$，可构建三维电子密度 $n_e(z) = \\sum_n n_n |\\psi_n(z)|^2$。该密度作为泊松方程的输入，用于确定新的 Hartree 势：\n$$\n\\frac{d^2 V_{\\mathrm{H}}}{dz^2} = \\frac{e^2}{\\varepsilon}\\left[n_{\\mathrm{bg}}(z) - n_e(z)\\right]\n$$\n此处，$n_{\\mathrm{bg}}(z) = N_s/W$ 是为保持整体电中性所需的均匀正背景电荷密度。这是一个一维边值问题，通过将其转换为关于内部网格点上势值 $V_{\\mathrm{H}}(z_i)$ 的线性方程组，在网格上求解。\n\n自洽循环按以下步骤进行：\n1. 初始化 Hartree 势，通常为 $V_{\\mathrm{H}}^{(0)}(z) = 0$。\n2. 在第 $k$ 次迭代中：\n   a. 使用 $V_{\\mathrm{H}}^{(k-1)}(z)$ 求解薛定谔方程，以找到 $\\varepsilon_n$ 和 $\\psi_n(z)$。\n   b. 通过填充朗道能级确定子带占据数 $n_n$。\n   c. 计算新的电子密度 $n_e(z)$。\n   d. 求解泊松方程，找到由此产生的势 $V_{\\mathrm{H, new}}(z)$。\n   e. 使用线性混合更新 Hartree 势以确保稳定收敛：$V_{\\mathrm{H}}^{(k)}(z) = (1-\\alpha)V_{\\mathrm{H}}^{(k-1)}(z) + \\alpha V_{\\mathrm{H, new}}(z)$，其中 $\\alpha$ 是一个小的混合参数。\n3. 当两次迭代之间的势能变化小于指定的容差时，循环终止，例如 $\\max_z|V_{\\mathrm{H}}^{(k)}(z) - V_{\\mathrm{H}}^{(k-1)}(z)| < \\delta$。\n\n收敛后，使用最终的占据数集合 $\\{n_n\\}$ 来确定对总密度有贡献的子带（$n_n>0$）。这些子带的数量 $K$ 及其基于 1 的索引将与填充因子 $\\nu$ 一并报告。所提供的代码为三个指定的测试案例实现了这一完整的数值过程。在数值实现中，我使用了一个包含 $N_z=401$ 个点的网格，计算了 $N_{sub}=20$ 个子带，混合参数为 $\\alpha=0.1$，收敛容差为 $10^{-6} \\text{ eV}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal, solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the self-consistent Hartree problem for a 2DEG in a wide quantum well\n    under a magnetic field for the given test cases.\n    \"\"\"\n    \n    # Physical Constants (CODATA 2018)\n    e = 1.602176634e-19      # Elementary charge in C\n    m_e = 9.1093837015e-31   # Electron mass in kg\n    h = 6.62607015e-34      # Planck constant in J*s\n    hbar = h / (2 * np.pi)   # Reduced Planck constant in J*s\n    eps0 = 8.8541878128e-12 # Vacuum permittivity in F/m\n\n    # Material Parameters for GaAs\n    m_star = 0.067 * m_e  # Effective mass\n    eps_r = 12.9          # Relative permittivity\n    epsilon = eps_r * eps0 # Permittivity\n\n    # Numerical parameters for the simulation\n    Nz = 401             # Number of grid points (must be odd for centering)\n    Nsub = 20            # Number of subbands to compute\n    Lmax = 20            # Maximum Landau level index to consider\n    alpha = 0.1          # Mixing parameter for SCF\n    tolerance = 1e-6 * e # Convergence tolerance in Joules (1 micro-eV)\n    max_iter = 200       # Maximum SCF iterations\n\n    def run_scf(W, B, Ns):\n        \"\"\"\n        Performs the self-consistent field calculation for a single case.\n        \"\"\"\n        # Discretization of the well from -W/2 to W/2\n        z_grid = np.linspace(-W / 2, W / 2, Nz)\n        dz = z_grid[1] - z_grid[0]\n\n        # Schrödinger equation: Kinetic part setup (tridiagonal matrix)\n        # H = (-hbar^2/2m*) d^2/dz^2 + V(z)\n        diag_kin = np.full(Nz - 2, 2.0)\n        offdiag_kin = np.full(Nz - 3, -1.0)\n        K_factor = -hbar**2 / (2 * m_star * dz**2)\n        \n        # Poisson equation: Laplacian setup (tridiagonal matrix)\n        # solve_banded expects the matrix in a specific banded format.\n        # For a tridiagonal matrix, it's 3 rows: (super-diag, main-diag, sub-diag)\n        A_poisson = np.zeros((3, Nz - 2))\n        A_poisson[0, 1:] = 1.0   # Superdiagonal\n        A_poisson[1, :] = -2.0  # Main diagonal\n        A_poisson[2, :-1] = 1.0  # Subdiagonal\n        \n        # Pre-calculate constants for the current case\n        g_B = e * B / h\n        nu = int(round(Ns / g_B))\n        hbar_wc = e * B / m_star * hbar\n        n_bg_val = Ns / W\n        \n        # SCF iteration loop\n        V_H = np.zeros_like(z_grid)\n        \n        final_occupied_levels = []\n\n        for i in range(max_iter):\n            V_H_old = V_H.copy()\n            \n            # 1. Solve Schrödinger equation for eigenvalues and eigenvectors\n            V_total_internal = V_H[1:-1]\n            main_diag = K_factor * diag_kin + V_total_internal\n            off_diag = K_factor * offdiag_kin\n            \n            eigenvalues, eigenvectors = eigh_tridiagonal(main_diag, off_diag)\n            \n            eps_n = eigenvalues[:Nsub]\n            \n            # Normalize wavefunctions: integral |psi|^2 dz = 1\n            psi_n_unnorm = eigenvectors[:, :Nsub]\n            norm_factor = np.sqrt(np.sum(psi_n_unnorm**2, axis=0) * dz)\n            psi_n_norm = psi_n_unnorm / norm_factor\n            \n            # 2. Populate Landau levels based on energy\n            levels = []\n            for n_idx in range(Nsub):\n                for l_idx in range(Lmax):\n                    E_nl = eps_n[n_idx] + (l_idx + 0.5) * hbar_wc\n                    levels.append({'E': E_nl, 'n': n_idx + 1, 'l': l_idx})\n            \n            levels.sort(key=lambda x: x['E'])\n            occupied_levels = levels[:nu]\n            \n            # 3. Calculate subband densities n_n\n            n_n = np.zeros(Nsub)\n            for level in occupied_levels:\n                n_n[level['n'] - 1] += g_B\n                \n            # 4. Construct total electron density profile n_e(z)\n            n_e = np.zeros_like(z_grid)\n            n_e[1:-1] = np.sum(n_n * np.abs(psi_n_norm)**2, axis=1)\n            \n            # 5. Solve Poisson equation for the new Hartree potential\n            source = (e**2 / epsilon) * (n_bg_val - n_e[1:-1])\n            rhs = source * dz**2\n            V_H_internal = solve_banded((1, 1), A_poisson, rhs)\n            \n            V_H_new = np.zeros_like(z_grid)\n            V_H_new[1:-1] = V_H_internal\n            \n            # 6. Mix potentials and check for convergence\n            V_H = (1 - alpha) * V_H_old + alpha * V_H_new\n            \n            diff = np.max(np.abs(V_H - V_H_old))\n            if diff  tolerance:\n                final_occupied_levels = occupied_levels\n                break\n        else: # If loop finishes without break\n            final_occupied_levels = occupied_levels\n\n        if not final_occupied_levels:\n            final_occupied_levels = occupied_levels\n\n        # After convergence, determine the set of contributing subbands\n        occupied_subband_indices = sorted(list({level['n'] for level in final_occupied_levels}))\n        K = len(occupied_subband_indices)\n        \n        return [nu, K] + occupied_subband_indices\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (W in m, B in T, Ns in m^-2)\n        (30e-9, 8.0, 3.8690469e15),\n        (60e-9, 6.0, 5.8029803e15),\n        (80e-9, 6.0, 8.7044704e15),\n    ]\n\n    results = []\n    for case in test_cases:\n        W, B, Ns = case\n        result = run_scf(W, B, Ns)\n        results.append(result)\n\n    # Final print statement in the exact required format without spaces.\n    output_str = '[' + ','.join([f\"[{','.join(map(str, r))}]\" for r in results]) + ']'\n    print(output_str)\n\nsolve()\n```", "id": "2830254"}]}