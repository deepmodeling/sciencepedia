{"hands_on_practices": [{"introduction": "要真正理解内禀自旋霍尔效应，我们需要深入其量子力学根源。本实践将指导你使用一个紧束缚模型和久保公式（Kubo formula），通过数值计算来获得自旋霍尔电导率 $\\sigma_{sH}$。这项练习的价值在于它将抽象的线性响应理论与一个具体的计算算法联系起来，让你深刻体会到像自旋轨道耦合这样的材料内禀属性是如何决定宏观自旋霍尔效应的。[@problem_id:2860271]", "problem": "您的任务是使用 Wannier 插值策略，为一个二维反演不对称紧束缚模型实现内禀自旋霍尔电导率（记为 $\\sigma_{sH}$）的数值评估。其目的在于将线性响应理论中的基本定义与一个可执行的具体算法联系起来，并评估 $\\sigma_{sH}$ 关于布里渊区采样的收敛性。\n\n考虑一个单轨道正方晶格，晶格常数设为 $a=1$，并采用周期性边界条件。在动量空间中，布洛赫哈密顿量是自旋空间中的一个 $2 \\times 2$ 矩阵，其自旋轨道耦合由反演不对稱性引起（Rashba 形式）：\n$$\nH(\\mathbf{k}) = \\varepsilon(\\mathbf{k}) \\,\\sigma_0 + \\alpha \\left( \\sin k_y \\,\\sigma_x - \\sin k_x \\,\\sigma_y \\right),\n$$\n其中 $\\mathbf{k} = (k_x,k_y)$，$\\varepsilon(\\mathbf{k}) = -2t \\left( \\cos k_x + \\cos k_y \\right)$，$\\sigma_0$ 是 $2 \\times 2$ 单位矩阵，$\\sigma_{x,y,z}$ 是作用在自旋空间的泡利矩阵，$t>0$ 是最近邻跃迁强度，$\\alpha$ 是 Rashba 自旋轨道耦合强度。角度应以弧度为单位，布里渊区为 $k_x,k_y \\in [-\\pi,\\pi)$。\n\n请使用以下基本定义和事实作为您的出发点：\n- Kubo 线性响应理论将 $\\sigma_{sH}$ 与晶体的平衡态性质及其本征态联系起来。\n- 速度算符定义为 $v_\\mu(\\mathbf{k}) = \\partial H(\\mathbf{k})/\\partial k_\\mu$，其中 $\\mu \\in \\{x,y\\}$。\n- 自旋算符为 $s_z = \\frac{1}{2}\\sigma_z$。沿 $x$ 方向、自旋极化沿 $z$ 方向的自旋流是对称化乘积 $j_x^{(s)}(\\mathbf{k}) = \\frac{1}{2}\\{s_z, v_x(\\mathbf{k})\\}$。\n- 在此背景下，Wannier 插值意味着在局域（紧束缚/Wannier）基下工作，从实空间跃迁振幅解析地获得 $H(\\mathbf{k})$ 及其导数，而不是通过 $\\mathbf{k}$ 空间的有限差分。\n\n基于这些基础，推导一个适用于布里渊区数值积分的可实现公式，该公式能够计算在零温和指定费米能 $E_F$ 下的内禀自旋霍尔电导率。使用约定 $\\hbar = 1$ 和 $e = 1$，这样您计算的数值就是以 $e/\\hbar$ 为单位表示的 $\\sigma_{sH}$。在此约定下，布里渊区平均取代了因子 $(2\\pi)^{-2}\\int_{\\text{BZ}} d^2k$，因此布里淵區上的积分由一个 $N_k \\times N_k$ 的 $\\mathbf{k}$ 点网格上的均匀平均值来近似。\n\n您的程序必须：\n1. 实现上述模型，并从紧束缚形式解析地构造 $H(\\mathbf{k})$、$v_x(\\mathbf{k})$、$v_y(\\mathbf{k})$ 和 $j_x^{(s)}(\\mathbf{k})$（这就是 Wannier 插值步骤）。\n2. 在给定的费米能 $E_F$ 下，使用零温费米占据数。\n3. 使用一个均匀的 Monkhorst–Pack 式网格 $k_x,k_y \\in [-\\pi,\\pi)$（每个方向有 $N_k$ 个点）对布里渊区进行积分来评估 $\\sigma_{sH}$。角度以弧度为单位。\n4. 将最终结果以 $e/\\hbar$ 为单位表示为一个纯数。\n\n测试套件和要求的输出：\n- 使用以下五组参数 $(t,\\alpha,E_F,N_k)$:\n    1. $(1.0,\\,0.35,\\,-3.20,\\,25)$\n    2. $(1.0,\\,0.35,\\,-3.20,\\,51)$\n    3. $(1.0,\\,0.35,\\,-3.20,\\,101)$\n    4. $(1.0,\\,0.00,\\,0.00,\\,31)$\n    5. $(1.0,\\,0.60,\\,0.00,\\,81)$\n- 对每种情况，计算以 $e/\\hbar$ 为单位的 $\\sigma_{sH}$，并将结果四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含五个结果，形式为方括号括起来的逗号分隔列表（例如，`[r1,r2,r3,r4,r5]`），其中每个 $r_i$ 是对应测试用例的四舍五入后的浮点值。\n\n科学真实性和适用性说明：\n- 所选的哈密顿量是一个最小的反演不对称紧束缚模型，它在洁净极限下支持有限的内禀自旋霍尔响应。\n- 通过使用从实空间跃迁推导出的紧束缚哈密顿量关于 $\\mathbf{k}$ 的解析导数，满足了 Wannier 插值的要求。\n- 通过比较前三个输出结果来评估关于 $N_k$ 的收敛性；它们之间结果的稳定性表明了采样收敛。\n\n所有角度必须以弧度为单位。所有最终数值答案必须按规定以 $e/\\hbar$ 为单位报告，并四舍五入到六位小数。最终输出格式必须是包含五个结果的单行 Python 列表。", "solution": "用户要求对一个给定的二维紧束缚模型进行内禀自旋霍尔电导率 $\\sigma_{sH}$ 的数值评估。根据指令，第一步是严格验证问题陈述。\n\n### 步骤 1：问题验证\n\n我们从问题陈述中提取了以下已知条件：\n- **模型：** 晶格常数 $a=1$ 的二维单轨道紧束缚正方晶格模型。\n- **哈密顿量：** $H(\\mathbf{k}) = \\varepsilon(\\mathbf{k}) \\,\\sigma_0 + \\alpha \\left( \\sin k_y \\,\\sigma_x - \\sin k_x \\,\\sigma_y \\right)$，其中 $\\varepsilon(\\mathbf{k}) = -2t \\left( \\cos k_x + \\cos k_y \\right)$。$\\sigma_{0,x,y,z}$ 是泡利矩阵。\n- **基本算符：** 速度算符 $v_\\mu(\\mathbf{k}) = \\partial H(\\mathbf{k})/\\partial k_\\mu$。自旋-$z$ 算符 $s_z = \\frac{1}{2}\\sigma_z$。自旋流 $j_x^{(s)}(\\mathbf{k}) = \\frac{1}{2}\\{s_z, v_x(\\mathbf{k})\\}$。\n- **物理常数：** $\\hbar=1$, $e=1$。\n- **任务：** 在零温 $T=0$ 和费米能 $E_F$ 下计算内禀自旋霍尔电导率 $\\sigma_{sH}$。\n- **数值方法：** 用 $k_x, k_y \\in [-\\pi, \\pi)$ 上的均匀 $N_k \\times N_k$ 网格求和来近似布里渊区（BZ）积分。\n- **测试用例：** 提供了五组参数 $(t, \\alpha, E_F, N_k)$ 用于测试。\n\n该问题具有科学依据，描述了一个晶格上的标准 Rashba 模型。使用 Kubo 线性响应形式的表述是凝聚态物理中正确且标准的方法。所有项都有明确的定义，参数在物理上是合理的。问题是自洽且客观的。因此，该问题被认定为**有效的**。我们将着手求解。\n\n### 步骤 2：可计算公式的推导\n\n内禀自旋霍尔电导率 $\\sigma_{sH}$（更准确地说是 $\\sigma_{xy}^{s_z}$）是一个线性响应系数，它将自旋流 $j_x^{(s)}$ 与横向电场 $E_y$ 联系起来。在零温下，可以使用 Kubo 公式计算，该公式可以表示为每个能带 $n$ 的自旋贝里曲率 $\\Omega_{n,xy}^{(s)}(\\mathbf{k})$：\n$$\n\\sigma_{sH} = \\sum_{n} \\int_{\\text{BZ}} \\frac{d^2k}{(2\\pi)^2} f(E_{n\\mathbf{k}}) \\Omega_{n,xy}^{(s)}(\\mathbf{k})\n$$\n其中 $f(E_{n\\mathbf{k}})$ 是费米-狄拉克分布，在 $T=0$ 时它是一个阶跃函数 $\\Theta(E_F - E_{n\\mathbf{k}})$。自旋贝里曲率由下式给出：\n$$\n\\Omega_{n,xy}^{(s)}(\\mathbf{k}) = -2 \\, \\text{Im} \\sum_{m \\neq n} \\frac{ \\langle u_{n\\mathbf{k}} | j_x^{(s)}(\\mathbf{k}) | u_{m\\mathbf{k}} \\rangle \\langle u_{m\\mathbf{k}} | v_y(\\mathbf{k}) | u_{n\\mathbf{k}} \\rangle }{(E_{n\\mathbf{k}} - E_{m\\mathbf{k}})^2}\n$$\n其中 $|u_{n\\mathbf{k}}\\rangle$ 和 $E_{n\\mathbf{k}}$ 是 $H(\\mathbf{k})$ 的本征矢量和本征值。问题指定用离散网格上的归一化求和来替换布里渊区上的积分。\n\n首先，我们必须在哈密顿量的本征基下推导算符的解析形式。\n\n**1. 哈密顿量及其本征态/本征值：**\n哈密顿量为 $H(\\mathbf{k}) = \\varepsilon(\\mathbf{k})\\sigma_0 + \\mathbf{d}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$，其中 $\\mathbf{d}(\\mathbf{k}) = (\\alpha \\sin k_y, -\\alpha \\sin k_x, 0)$。\n本征值为 $E_{\\pm}(\\mathbf{k}) = \\varepsilon(\\mathbf{k}) \\pm |\\mathbf{d}(\\mathbf{k})|$。令 $n=1$ 表示下能带（$E_1 = E_-$），$n=2$ 表示上能带（$E_2 = E_+$）。\n$$\nE_{1,2}(\\mathbf{k}) = -2t(\\cos k_x + \\cos k_y) \\mp |\\alpha|\\sqrt{\\sin^2 k_x + \\sin^2 k_y}\n$$\n能量差为 $\\Delta E = E_2 - E_1 = 2|\\alpha|\\sqrt{\\sin^2 k_x + \\sin^2 k_y}$。\n对应的本征矢量 $|u_1\\rangle$ 和 $|u_2\\rangle$ 可以被确定，但我们会发现直接计算矩阵元更为稳健。在每个 $\\mathbf{k}$ 点进行数值对角化是最实用的方法。\n\n**2. 速度和自旋流算符：**\n速度算符通过对 $H(\\mathbf{k})$ 进行解析微分得到：\n$$\nv_x(\\mathbf{k}) = \\frac{\\partial H}{\\partial k_x} = (2t \\sin k_x) \\sigma_0 - \\alpha \\cos k_x \\sigma_y = \\begin{pmatrix} 2t \\sin k_x & i\\alpha \\cos k_x \\\\ -i\\alpha \\cos k_x & 2t \\sin k_x \\end{pmatrix}\n$$\n$$\nv_y(\\mathbf{k}) = \\frac{\\partial H}{\\partial k_y} = (2t \\sin k_y) \\sigma_0 + \\alpha \\cos k_y \\sigma_x = \\begin{pmatrix} 2t \\sin k_y & \\alpha \\cos k_y \\\\ \\alpha \\cos k_y & 2t \\sin k_y \\end{pmatrix}\n$$\n自旋流算符为 $j_x^{(s)}(\\mathbf{k}) = \\frac{1}{2}\\{s_z, v_x(\\mathbf{k})\\} = \\frac{1}{4}\\{ \\sigma_z, v_x(\\mathbf{k}) \\}$。利用泡利矩阵反对易关系 $\\{\\sigma_i, \\sigma_j\\} = 2\\delta_{ij}\\sigma_0$，我们知道 $\\{\\sigma_z, \\sigma_y\\} = 0$。\n$$\nj_x^{(s)}(\\mathbf{k}) = \\frac{1}{4} \\left( (2t \\sin k_x) \\{\\sigma_z, \\sigma_0\\} - \\alpha \\cos k_x \\{\\sigma_z, \\sigma_y\\} \\right) = \\frac{1}{4} (2t \\sin k_x) (2\\sigma_z) = (t \\sin k_x) \\sigma_z\n$$\n$$\nj_x^{(s)}(\\mathbf{k}) = \\begin{pmatrix} t \\sin k_x & 0 \\\\ 0 & -t \\sin k_x \\end{pmatrix}\n$$\n\n**3. 矩阵元和自旋贝里曲率：**\n对于我们的 $2 \\times 2$ 系统，$\\Omega_{n,xy}^{(s)}$ 的公式得到简化。对于下能带（$n=1$）：\n$$\n\\Omega_{1,xy}^{(s)}(\\mathbf{k}) = -2 \\, \\text{Im} \\frac{ \\langle u_1 | j_x^{(s)} | u_2 \\rangle \\langle u_2 | v_y | u_1 \\rangle }{(E_1 - E_2)^2}\n$$\n矩阵元必须在本征矢量 $|u_1\\rangle$ 和 $|u_2\\rangle$ 之间计算。虽然解析计算是可能的，但容易出现相位误差。一种更安全的方法是在每个 $\\mathbf{k}$ 点对 $H(\\mathbf{k})$ 进行数值对角化以获得 $|u_{1,2}\\rangle$，然后计算矩阵元。\n我们将分子记为 $M_{12} = \\langle u_1 | j_x^{(s)} | u_2 \\rangle \\langle u_2 | v_y | u_1 \\rangle$。两条能带的自旋贝里曲率通过 $\\Omega_{2,xy}^{(s)}(\\mathbf{k}) = -\\Omega_{1,xy}^{(s)}(\\mathbf{k})$ 相互关联。\n\n**4. 电导率的最终表达式：**\n总的自旋霍尔电导率是所有占据态贡献的总和。\n$$\n\\sigma_{sH} = \\frac{1}{N_k^2} \\sum_{\\mathbf{k}} \\left( \\Theta(E_F - E_{1\\mathbf{k}})\\Omega_{1,xy}^{(s)}(\\mathbf{k}) + \\Theta(E_F - E_{2\\mathbf{k}})\\Omega_{2,xy}^{(s)}(\\mathbf{k}) \\right)\n$$\n利用 $\\Omega_2 = -\\Omega_1$，上式变为：\n$$\n\\sigma_{sH} = \\frac{1}{N_k^2} \\sum_{\\mathbf{k}} \\left( \\Theta(E_F - E_{1\\mathbf{k}}) - \\Theta(E_F - E_{2\\mathbf{k}}) \\right) \\Omega_{1,xy}^{(s)}(\\mathbf{k})\n$$\n由于 $E_1 < E_2$，仅当费米能 $E_F$ 位于两条能带之间（$E_1 < E_F < E_2$）时，项 $(\\Theta(E_F - E_1) - \\Theta(E_F - E_2))$ 才为 1，否则为 0。\n因此，用于数值实现的最终表达式为：\n$$\n\\sigma_{sH} = \\frac{1}{N_k^2} \\sum_{\\mathbf{k} \\text{ where } E_{1\\mathbf{k}} < E_F < E_{2\\mathbf{k}}} \\left( -2 \\, \\text{Im} \\frac{ \\langle u_{1\\mathbf{k}} | j_x^{(s)}(\\mathbf{k}) | u_{2\\mathbf{k}} \\rangle \\langle u_{2\\mathbf{k}} | v_y(\\mathbf{k}) | u_{1\\mathbf{k}} \\rangle }{(E_{1\\mathbf{k}} - E_{2\\mathbf{k}})^2} \\right)\n$$\n特殊情况：如果 $\\alpha=0$，能带是简并的，自旋轨道耦合机制消失。哈密顿量在自旋空间中是对角的，计算 $\\sigma_{sH}$ 所需的非对角矩阵元为零。因此，当 $\\alpha=0$ 时 $\\sigma_{sH}=0$。\n\n### 步骤 3：算法设计\nPython 实现的算法如下：\n1.  对于每个测试用例 $(t, \\alpha, E_F, N_k)$：\n2.  如果 $\\alpha=0$，则结果为 $0.0$。\n3.  否则，在 $[-\\pi, \\pi) \\times [-\\pi, \\pi)$ 范围内生成一个 $N_k \\times N_k$ 的 Monkhorst-Pack $\\mathbf{k}$ 点网格。\n4.  初始化一个总电导率累加器为 $0$。\n5.  遍历网格上的每个 $\\mathbf{k}=(k_x, k_y)$ 点。\n    a. 构造 $2 \\times 2$ 的哈密顿量矩阵 $H(\\mathbf{k})$。\n    b. 使用库函数（例如 `numpy.linalg.eigh`）对 $H(\\mathbf{k})$ 进行数值对角化，以获得本征值 $E_1, E_2$ 和本征矢量 $|u_1\\rangle, |u_2\\rangle$。\n    c. 如果能隙 $(E_2 - E_1)$ 小于一个很小的容差（以避免在简并点处除以零），则继续处理下一个 $\\mathbf{k}$ 点。\n    d. 构造 $j_x^{(s)}(\\mathbf{k})$ 和 $v_y(\\mathbf{k})$ 的矩阵。\n    e. 计算矩阵元 $j_{12} = \\langle u_1 | j_x^{(s)} | u_2 \\rangle$ 和 $v_{21} = \\langle u_2 | v_y | u_1 \\rangle$。\n    f. 计算它们乘积的虚部：$\\text{Im}(j_{12} \\cdot v_{21})$。\n    g. 计算下能带的自旋贝里曲率：$\\Omega_1 = -2 \\cdot \\text{Im}(j_{12} \\cdot v_{21}) / (E_1 - E_2)^2$。\n    h. 检查占据条件：如果 $E_1 < E_F$，则将 $\\Omega_1$ 加到累加器中。如果 $E_2 < E_F$，则减去 $\\Omega_1$（因为 $\\Omega_2 = -\\Omega_1$）。\n6.  将最终的总和除以 $N_k^2$ 得到平均值，即为 $\\sigma_{sH}$。\n7.  将结果四舍五入到六位小数。\n8.  收集所有测试用例的结果并格式化最终的输出字符串。\n此过程提供了一个基于基本原理的直接而稳健的数值解。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the intrinsic spin Hall conductivity for a 2D Rashba\n    tight-binding model using Wannier interpolation (analytical operators)\n    and Kubo formalism.\n    \"\"\"\n\n    # Pauli matrices and identity\n    sigma0 = np.array([[1, 0], [0, 1]], dtype=complex)\n    sigma_x = np.array([[0, 1], [1, 0]], dtype=complex)\n    sigma_y = np.array([[0, -1j], [1j, 0]], dtype=complex)\n    sigma_z = np.array([[1, 0], [0, -1]], dtype=complex)\n\n    def calculate_sigma_sh(t, alpha, E_F, Nk):\n        \"\"\"\n        Calculates sigma_sH for a single set of parameters.\n        \"\"\"\n        # Case alpha=0: No spin-orbit coupling, so SHE is zero.\n        if alpha == 0:\n            return 0.0\n\n        # Create a uniform k-grid in the 1st Brillouin Zone: [-pi, pi)\n        k_coords = np.linspace(-np.pi, np.pi, Nk, endpoint=False)\n        kx_grid, ky_grid = np.meshgrid(k_coords, k_coords)\n\n        total_sigma_sh_sum = 0.0\n\n        for ikx in range(Nk):\n            for iky in range(Nk):\n                kx = kx_grid[ikx, iky]\n                ky = ky_grid[ikx, iky]\n\n                # 1. Construct Hamiltonian H(k)\n                epsilon_k = -2 * t * (np.cos(kx) + np.cos(ky))\n                H_k = epsilon_k * sigma0 + alpha * (np.sin(ky) * sigma_x - np.sin(kx) * sigma_y)\n\n                # 2. Diagonalize H(k) to get eigenvalues and eigenvectors\n                # eigh ensures real eigenvalues and orthonormal eigenvectors\n                energies, eigenstates = np.linalg.eigh(H_k)\n                E1, E2 = energies[0], energies[1]\n                u1, u2 = eigenstates[:, 0], eigenstates[:, 1]\n                \n                # Energy denominator\n                energy_gap = E2 - E1\n                if np.abs(energy_gap) < 1e-9:  # Avoid division by zero at degeneracies\n                    continue\n\n                # 3. Construct operators v_y(k) and j_x^s(k)\n                vy_k = (2 * t * np.sin(ky)) * sigma0 + alpha * np.cos(ky) * sigma_x\n                jxs_k = (t * np.sin(kx)) * sigma_z\n                \n                # 4. Calculate matrix elements\n                # Numpy's vdot computes u_conj.T @ v\n                v_21 = np.vdot(u2, vy_k @ u1)\n                j_12 = np.vdot(u1, jxs_k @ u2)\n                \n                # 5. Calculate numerator of spin Berry curvature\n                numerator_im_part = np.imag(j_12 * v_21)\n\n                # 6. Calculate spin Berry curvature for the lower band (n=1)\n                Omega1 = -2 * numerator_im_part / (energy_gap**2)\n\n                # 7. Sum contributions based on Fermi level occupation\n                # sigma_sH = sum_k (f(E1)*Omega1 + f(E2)*Omega2)\n                # Since Omega2 = -Omega1, this is sum_k (f(E1)-f(E2))*Omega1\n                # At T=0, f(E) is a step function Theta(E_F - E).\n                contribution = 0.0\n                if E1 < E_F:\n                    contribution += Omega1\n                if E2 < E_F:\n                    contribution -= Omega1 # equivalent to adding Omega2\n\n                total_sigma_sh_sum += contribution\n\n        # Average over all k-points\n        sigma_sh = total_sigma_sh_sum / (Nk**2)\n        \n        return sigma_sh\n\n    # Test cases from the problem statement\n    test_cases = [\n        # (t,   alpha, E_F,   Nk)\n        (1.0, 0.35, -3.20, 25),\n        (1.0, 0.35, -3.20, 51),\n        (1.0, 0.35, -3.20, 101),\n        (1.0, 0.00, 0.00, 31),\n        (1.0, 0.60, 0.00, 81),\n    ]\n\n    results = []\n    for params in test_cases:\n        t, alpha, E_F, Nk = params\n        result = calculate_sigma_sh(t, alpha, E_F, Nk)\n        # Round to six decimal places as required\n        results.append(round(result, 6))\n\n    # Format and print the final output as a single-line list\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2860271"}, {"introduction": "通过自旋霍尔效应产生自旋流之后，下一个关键问题是：这些自旋流在材料内部以及在界面处是如何传输和演化的？本实践引入了应用广泛的漂移-扩散模型来描述自旋积累 $\\mu_s$ 与输运过程。通过分析一个包含界面“自旋记忆丢失”（interfacial spin memory loss）效应的系统，你将学习如何量化分析界面对自旋信号的影响——这对于任何自旋电子器件的设计都至关重要。[@problem_id:2860200]", "problem": "一个非磁性重金属薄膜占据区域 $0 \\le x \\le t$，并受到一个沿 $y$ 方向的均匀面内电场 $E$ 的作用。由于自旋霍尔效应（SHE），一个自旋流密度 $j_{s}(x)$ 沿 $x$ 方向流动，其自旋沿 $z$ 方向极化。在一维稳态下，假设采用以下经过充分验证的漂移-扩散模型：\n- 自旋积累（自旋电化学势差）$\\mu_{s}(x)$ 遵循扩散方程 $d^{2}\\mu_{s}/dx^{2}=\\mu_{s}/\\lambda^{2}$，其中 $\\lambda$ 是自旋扩散长度。\n- 自旋流密度（以电荷流单位度量）为 $j_{s}(x)=\\theta_{\\mathrm{SH}}\\,\\sigma\\,E - \\left(\\sigma/2e\\right)\\,d\\mu_{s}/dx$，其中 $\\theta_{\\mathrm{SH}}$ 是自旋霍尔角，$\\sigma$ 是电导率，而 $e$ 是元电荷。\n- 在自由表面 $x=t$ 处，没有自旋流流出薄膜：$j_{s}(t)=0$。\n\n在界面 $x=0$ 处，该薄膜通过一个表现出界面自旋记忆损耗的界面与一个理想的自旋阱（阱侧的自旋积累为零）接触。通过单位面积的界面自旋翻转电导 $G_{\\mathrm{sf}}$ 来模拟自旋记忆损耗，使得流入自旋阱的界面自旋流等于 $\\left(G_{\\mathrm{sf}}/2e\\right)\\left[\\mu_{s}(0)-0\\right]$。规定符号惯例为：$j_{s}>0$ 表示自旋流流入 $+x$ 方向（进入薄膜）。\n\n任务：\n1) 从上述物理原理出发，推导在 $x=0$ 处耦合 $j_{s}(0)$ 和 $\\mu_{s}(0)$ 的边界条件，并明确展示界面自旋翻转电导 $G_{\\mathrm{sf}}$ 如何修正标准边界条件。\n2) 求解在 $0\\le x \\le t$ 上关于 $\\mu_{s}(x)$ 的所得边值问题。\n3) 定义无量纲比值 $R \\equiv \\mu_{s}(0)\\big|_{G_{\\mathrm{sf}}}/\\mu_{s}(0)\\big|_{G_{\\mathrm{sf}}=0}$，并使用参数组\n$t=4.0\\times 10^{-9}$，$\\lambda=1.5\\times 10^{-9}$，$\\sigma=5.0\\times 10^{6}$，$\\theta_{\\mathrm{SH}}=0.20$，$E=1.0\\times 10^{5}$，以及 $G_{\\mathrm{sf}}=2.0\\times 10^{15}$ 计算 $R$ 的值，其中 $t$ 和 $\\lambda$ 的单位是米，$\\sigma$ 的单位是 $\\mathrm{S/m}$，$E$ 的单位是 $\\mathrm{V/m}$，$G_{\\mathrm{sf}}$ 的单位是 $\\mathrm{S/m^{2}}$。将 $R$ 的最终数值结果保留四位有效数字。该答案为无量纲；报告时无需单位。", "solution": "我们从稳态自旋扩散方程和存在自旋霍尔效应（SHE）时的自旋流本构关系出发。自旋积累 $\\mu_{s}(x)$ 满足\n$$\n\\frac{d^{2}\\mu_{s}}{dx^{2}}=\\frac{\\mu_{s}}{\\lambda^{2}},\n$$\n其通解为\n$$\n\\mu_{s}(x)=A\\cosh\\!\\left(\\frac{x}{\\lambda}\\right)+B\\sinh\\!\\left(\\frac{x}{\\lambda}\\right),\n$$\n其中常数 $A$ 和 $B$ 由边界条件确定。自旋流密度（以电荷流单位表示）由下式给出\n$$\nj_{s}(x)=\\theta_{\\mathrm{SH}}\\,\\sigma\\,E-\\frac{\\sigma}{2e}\\frac{d\\mu_{s}}{dx}.\n$$\n\n在 $x=t$ 处的边界（自由表面，无自旋流损耗）：$j_{s}(t)=0$。因此，\n$$\n0=\\theta_{\\mathrm{SH}}\\,\\sigma\\,E-\\frac{\\sigma}{2e}\\,\\mu_{s}'(t)\\quad\\Rightarrow\\quad \\mu_{s}'(t)=\\frac{2e}{\\sigma}\\,\\theta_{\\mathrm{SH}}\\,\\sigma\\,E=2e\\,\\theta_{\\mathrm{SH}}\\,E.\n$$\n利用 $\\mu_{s}$ 的导数，\n$$\n\\mu_{s}'(x)=\\frac{A}{\\lambda}\\sinh\\!\\left(\\frac{x}{\\lambda}\\right)+\\frac{B}{\\lambda}\\cosh\\!\\left(\\frac{x}{\\lambda}\\right),\n$$\n我们得到第一个线性关系\n$$\n\\frac{A}{\\lambda}\\sinh\\!\\left(\\frac{t}{\\lambda}\\right)+\\frac{B}{\\lambda}\\cosh\\!\\left(\\frac{t}{\\lambda}\\right)=2e\\,\\theta_{\\mathrm{SH}}\\,E.\n$$\n\n在 $x=0$ 处的边界（界面自旋记忆损耗）：该界面将自旋流传导至相邻的理想自旋阱，其单位面积电导为 $G_{\\mathrm{sf}}$。根据线性响应，流入自旋阱的界面自旋流等于 $\\left(G_{\\mathrm{sf}}/2e\\right)\\left[\\mu_{s}(0)-\\mu_{\\mathrm{sink}}\\right]$，其中 $\\mu_{\\mathrm{sink}}=0$。根据 $j_{s}>0$ 表示流入 $+x$ 方向（进入薄膜）的符号规定，流入自旋阱的界面电流沿 $-x$ 方向流动，因此对应于 $j_{s}(0)=-\\left(G_{\\mathrm{sf}}/2e\\right)\\mu_{s}(0)$。因此，修正后的边界条件为\n$$\n\\theta_{\\mathrm{SH}}\\,\\sigma\\,E-\\frac{\\sigma}{2e}\\,\\mu_{s}'(0)=-\\frac{G_{\\mathrm{sf}}}{2e}\\,\\mu_{s}(0).\n$$\n乘以 $2e$ 得\n$$\n2e\\,\\theta_{\\mathrm{SH}}\\,\\sigma\\,E-\\sigma\\,\\mu_{s}'(0)=-G_{\\mathrm{sf}}\\,\\mu_{s}(0).\n$$\n利用 $\\mu_{s}'(0)=B/\\lambda$ 和 $\\mu_{s}(0)=A$，我们得到第二个线性关系\n$$\n2e\\,\\theta_{\\mathrm{SH}}\\,\\sigma\\,E-\\sigma\\,\\frac{B}{\\lambda}=-G_{\\mathrm{sf}}\\,A,\n$$\n或等价地\n$$\n\\frac{\\sigma}{\\lambda}\\,B=2e\\,\\theta_{\\mathrm{SH}}\\,\\sigma\\,E+G_{\\mathrm{sf}}\\,A.\n$$\n\n为方便起见，定义\n$$\nS\\equiv 2e\\,\\theta_{\\mathrm{SH}}\\,E,\\quad \\tau\\equiv \\frac{t}{\\lambda},\\quad \\Lambda\\equiv \\frac{\\lambda\\,G_{\\mathrm{sf}}}{\\sigma}.\n$$\n于是两个边界方程为\n$$\nA\\sinh\\tau+B\\cosh\\tau=\\lambda S,\\qquad B=\\lambda S+\\Lambda A.\n$$\n将 $B$ 代入第一个方程，\n$$\nA\\sinh\\tau+\\left(\\lambda S+\\Lambda A\\right)\\cosh\\tau=\\lambda S,\n$$\n解得\n$$\nA\\left[\\sinh\\tau+\\Lambda\\cosh\\tau\\right]=\\lambda S\\left(1-\\cosh\\tau\\right).\n$$\n因此，界面自旋积累为\n$$\n\\mu_{s}(0)=A=\\lambda\\,S\\,\\frac{1-\\cosh\\tau}{\\sinh\\tau+\\Lambda\\cosh\\tau}.\n$$\n在没有界面自旋记忆损耗的情况下，$G_{\\mathrm{sf}}=0$，因此 $\\Lambda=0$，且\n$$\n\\mu_{s}(0)\\big|_{G_{\\mathrm{sf}}=0}=\\lambda\\,S\\,\\frac{1-\\cosh\\tau}{\\sinh\\tau}.\n$$\n因此，所求的无量纲比值简化为\n$$\nR\\equiv \\frac{\\mu_{s}(0)\\big|_{G_{\\mathrm{sf}}}}{\\mu_{s}(0)\\big|_{G_{\\mathrm{sf}}=0}}=\\frac{\\sinh\\tau}{\\sinh\\tau+\\Lambda\\cosh\\tau}=\\frac{1}{1+\\Lambda\\,\\coth\\tau}.\n$$\n\n我们现在根据给定的参数计算 $R$：\n$$\nt=4.0\\times 10^{-9},\\quad \\lambda=1.5\\times 10^{-9},\\quad \\sigma=5.0\\times 10^{6},\\quad \\theta_{\\mathrm{SH}}=0.20,\\quad E=1.0\\times 10^{5},\\quad G_{\\mathrm{sf}}=2.0\\times 10^{15}.\n$$\n计算无量纲组合\n$$\n\\tau=\\frac{t}{\\lambda}=\\frac{4.0\\times 10^{-9}}{1.5\\times 10^{-9}}=\\frac{8}{3}\\approx 2.666666\\ldots,\n$$\n$$\n\\Lambda=\\frac{\\lambda\\,G_{\\mathrm{sf}}}{\\sigma}=\\frac{\\left(1.5\\times 10^{-9}\\right)\\left(2.0\\times 10^{15}\\right)}{5.0\\times 10^{6}}=0.6.\n$$\n计算 $\\tau=8/3$ 处的双曲函数值：\n$$\n\\sinh\\tau\\approx 7.161213836,\\qquad \\cosh\\tau\\approx 7.230697566,\n$$\n于是\n$$\nR=\\frac{\\sinh\\tau}{\\sinh\\tau+\\Lambda\\cosh\\tau}=\\frac{7.161213836}{7.161213836+0.6\\times 7.230697566}\\approx \\frac{7.161213836}{11.499632376}\\approx 0.622716860.\n$$\n保留四位有效数字，结果为 $0.6227$。该值小于1，反映了界面自旋翻转电导导致界面自旋积累幅度的减小。", "answer": "$$\\boxed{0.6227}$$", "id": "2860200"}, {"introduction": "产生和控制自旋流的最终目的之一是操控磁矩。本实践聚焦于这一核心应用，通过分析自旋轨道矩（SOT）诱导的磁化翻转，来阐释其物理原理，这也是现代磁性随机存取存储器（MRAM）技术的基石。你将通过计算探索自旋霍尔效应、Dzyaloshinskii-Moriya 相互作用（DMI）以及磁各向异性之间的精妙协作，是如何决定纳米磁体翻转效率的。[@problem_id:2860225]", "problem": "一个具有垂直磁各向异性 (PMA) 的铁磁体 (FM) 垂直磁化纳米点被沉积在一个表现出自旋霍尔效应 (SHE) 的重金属层上。在重金属中沿 $+x$ 方向施加电荷电流密度 $J$，在铁磁体界面处沿 $+y$ 方向产生自旋极化 $\\boldsymbol{\\sigma}$。该铁磁体的饱和磁化强度为 $M_{s}$，厚度为 $t_{F}$，并具有有效的单轴各向异性，其特征是沿 $+z$ 方向的各向异性场 $H_{k}$。界面上存在 Dzyaloshinskii–Moriya 相互作用 (DMI)，它选择一种 Néel 手性 $\\chi \\in \\{+1,-1\\}$，并且在纳米点尺度上可以被建模为一个有效的平面内手性偏置场 $\\chi\\,H_{D}\\,\\hat{\\boldsymbol{x}}$，其中 $0&lt;H_{D}&lt;H_{k}$。磁化动力学遵循 Landau–Lifshitz–Gilbert (LLG) 方程，其中包含一个类阻尼自旋轨道矩 (SOT)，其自旋霍尔角为 $\\theta_{\\mathrm{SH}}$，形式如下\n$$\n\\frac{d\\boldsymbol{m}}{dt} \\;=\\; -\\gamma \\mu_{0}\\,\\boldsymbol{m}\\times\\boldsymbol{H}_{\\mathrm{eff}} \\;+\\; \\alpha\\,\\boldsymbol{m}\\times\\frac{d\\boldsymbol{m}}{dt} \\;+\\; \\gamma \\mu_{0} H_{\\mathrm{DL}}\\,\\boldsymbol{m}\\times(\\boldsymbol{\\sigma}\\times\\boldsymbol{m}),\n$$\n其中 $\\boldsymbol{m}$ 是磁化单位矢量，$\\gamma$ 是旋磁比，$\\mu_{0}$ 是真空磁导率，$\\alpha$ 是 Gilbert 阻尼参数，类阻尼有效场振幅满足\n$$\n\\mu_{0} H_{\\mathrm{DL}} \\;=\\; \\frac{\\hbar\\,\\theta_{\\mathrm{SH}}}{2 e\\,M_{s}\\,t_{F}}\\,J.\n$$\n假设从初始态 $\\boldsymbol{m}\\approx +\\hat{\\boldsymbol{z}}$ 发生准静态、确定性的翻转，其中类阻尼 SOT 是唯一的电流诱导力矩，而 DMI 仅贡献静态手性偏置场 $\\chi\\,H_{D}\\,\\hat{\\boldsymbol{x}}$。将纳米点视为具有单轴各向异性能的宏自旋，并在存在平面内场的情况下，使用 Stoner–Wohlfarth 型的亚稳态消失分析。在零温下进行计算，并忽略热激活和类场力矩。\n\n1. 从上述 LLG 结构和单轴各向异性能出发，证明一个准静态映射是合理的：当 $\\boldsymbol{\\sigma}\\parallel +\\hat{\\boldsymbol{y}}$ 时，在 $\\boldsymbol{m}\\approx +\\hat{\\boldsymbol{z}}$ 附近，类阻尼 SOT 充当一个沿 $+\\hat{\\boldsymbol{x}}$ 方向的有效平面内场 $H_{\\mathrm{DL}}$。将其与 DMI 诱导的手性场结合，得到总平面内场 $H_{x}^{(\\chi)}$。\n\n2. 对一个受到横向平面内场 $H_{x}^{(\\chi)}$ 作用的单轴宏自旋，使用基于能量的稳定性判据，确定使 $\\boldsymbol{m}\\approx +\\hat{\\boldsymbol{z}}$ 态失去亚稳态的临界类阻尼场 $H_{\\mathrm{DL}}^{c}(\\chi)$。\n\n3. 通过上述自旋霍尔效应关系，将 $H_{\\mathrm{DL}}^{c}(\\chi)$ 转换为临界电流密度 $J_{c}^{(\\chi)}$。\n\n定义手性依赖的翻转效率对比度为以下比率\n$$\nR \\;\\equiv\\; \\frac{J_{c}^{(+1)}}{J_{c}^{(-1)}}.\n$$\n推导并给出一个仅用 $H_{k}$ 和 $H_{D}$ 表示的 $R$ 的闭式解析表达式。将你的最终答案表示为单个简化表达式。不需要进行数值计算，最终表达式中不应包含单位。", "solution": "该问题要求对垂直磁化纳米点中由自旋轨道矩 (SOT) 诱导的磁化翻转进行准静态分析。分析必须遵循使用 Stoner–Wohlfarth 型亚稳态消失判据的具体指令。我们将按照概述的三个连续部分来解决这个问题。\n\n首先，我们必须确定作用在磁化上的总有效平面内场。问题陈述，Dzyaloshinskii–Moriya 相互作用 (DMI) 表现为一个有效手性偏置场 $\\boldsymbol{H}_{\\mathrm{DMI}} = \\chi H_{D} \\hat{\\boldsymbol{x}}$，其中 $\\chi \\in \\{+1, -1\\}$。此外，类阻尼 SOT 必须被映射到一个有效的平面内场。Landau–Lifshitz–Gilbert (LLG) 方程中的 SOT 项为 $\\boldsymbol{T}_{\\mathrm{DL}} = \\gamma \\mu_{0} H_{\\mathrm{DL}}\\,\\boldsymbol{m}\\times(\\boldsymbol{\\sigma}\\times\\boldsymbol{m})$。在指定的准静态、基于能量的框架中，非保守的 SOT 被建模为一个等效的静态磁场 $\\boldsymbol{H}_{\\mathrm{SOT}}$，它为翻转提供驱动力。该场的方向由力矩相对于初始磁化状态的几何关系确定。给定自旋极化 $\\boldsymbol{\\sigma} = +\\hat{\\boldsymbol{y}}$ 和初始磁化 $\\boldsymbol{m} \\approx +\\hat{\\boldsymbol{z}}$，有效场的方向与两者正交，由 $\\boldsymbol{\\sigma} \\times \\hat{\\boldsymbol{z}} = \\hat{\\boldsymbol{y}} \\times \\hat{\\boldsymbol{z}} = \\hat{\\boldsymbol{x}}$ 给出。其大小取为 $H_{\\mathrm{DL}}$。因此，有效 SOT 场为 $\\boldsymbol{H}_{\\mathrm{SOT}} = H_{\\mathrm{DL}}\\hat{\\boldsymbol{x}}$。总有效平面内场 $H_{x}^{(\\chi)}$ 是 DMI 和 SOT 有效场的和，因为两者都沿 $\\hat{\\boldsymbol{x}}$ 方向作用：\n$$ H_{x}^{(\\chi)} = H_{\\mathrm{SOT}} + H_{\\mathrm{DMI}} = H_{\\mathrm{DL}} + \\chi H_{D} $$\n这完成了分析的第一部分。\n\n其次，我们确定翻转的临界条件。问题指示对单轴宏自旋使用基于能量的稳定性判据。对于一个沿 $\\hat{\\boldsymbol{z}}$ 方向具有单轴各向异性（由各向异性场 $H_{k}$ 表征）并受到沿 $\\hat{\\boldsymbol{x}}$ 方向的横向场 $H_{x}^{(\\chi)}$ 作用的磁体，其磁自由能密度 $U$ 为：\n$$ U = -K_{\\mathrm{eff}}m_z^2 - \\mu_0 M_s H_{x}^{(\\chi)} m_x $$\n有效各向异性常数 $K_{\\mathrm{eff}}$ 与各向异性场 $H_{k}$ 的关系为 $H_{k} = \\frac{2K_{\\mathrm{eff}}}{\\mu_0 M_s}$。代入此式，我们得到：\n$$ U = -\\frac{1}{2} \\mu_0 M_s H_{k} m_z^2 - \\mu_0 M_s H_{x}^{(\\chi)} m_x $$\n为了找到平衡态，我们在球坐标系中表示磁化单位矢量 $\\boldsymbol{m}$，即 $\\boldsymbol{m} = (\\sin\\theta\\cos\\phi, \\sin\\theta\\sin\\phi, \\cos\\theta)$。横向场 $H_{x}^{(\\chi)}$ 将稳定状态限制在 $xz$ 平面内，其中 $\\phi=0$ 或 $\\phi=\\pi$。假设 $H_{x}^{(\\chi)} > 0$，则当 $\\phi=0$ 时能量最小。能量仅变为 $\\theta$ 的函数：\n$$ U(\\theta) = -\\mu_0 M_s \\left( \\frac{1}{2} H_{k} \\cos^2\\theta + H_{x}^{(\\chi)} \\sin\\theta \\right) $$\n通过将关于 $\\theta$ 的一阶导数设为零来找到平衡位置：\n$$ \\frac{dU}{d\\theta} = -\\mu_0 M_s \\left( -H_{k} \\cos\\theta \\sin\\theta + H_{x}^{(\\chi)} \\cos\\theta \\right) = \\mu_0 M_s \\cos\\theta \\left( H_{k} \\sin\\theta - H_{x}^{(\\chi)} \\right) = 0 $$\n这得到解 $\\cos\\theta=0$ (即 $\\theta=\\frac{\\pi}{2}$) 或 $\\sin\\theta = \\frac{H_{x}^{(\\chi)}}{H_{k}}$。初始态 $\\boldsymbol{m} \\approx +\\hat{\\boldsymbol{z}}$ 对应于一个小的 $\\theta$ 值，这是一个由 $\\sin\\theta = \\frac{H_{x}^{(\\chi)}}{H_{k}}$ 描述的稳定极小值点。该状态的稳定性由二阶导数的符号决定：\n$$ \\frac{d^2U}{d\\theta^2} = \\mu_0 M_s \\left( -H_{k} \\sin^2\\theta + H_{k} \\cos^2\\theta + H_{x}^{(\\chi)}\\sin\\theta \\right) = \\mu_0 M_s H_k \\left( \\cos(2\\theta) + \\frac{H_{x}^{(\\chi)}}{H_{k}}\\sin\\theta \\right)$$\n代入 $\\sin\\theta = \\frac{H_{x}^{(\\chi)}}{H_{k}}$ 和 $\\cos(2\\theta) = 1 - 2\\sin^2\\theta$，我们发现：\n$$ \\frac{d^2U}{d\\theta^2} = \\mu_0 M_s H_k \\left( 1 - 2\\left(\\frac{H_{x}^{(\\chi)}}{H_{k}}\\right)^2 + \\left(\\frac{H_{x}^{(\\chi)}}{H_{k}}\\right)^2 \\right) = \\mu_0 M_s H_k \\left( 1 - \\left(\\frac{H_{x}^{(\\chi)}}{H_{k}}\\right)^2 \\right) $$\n只要 $\\frac{d^2U}{d\\theta^2} > 0$，状态就是稳定的，这要求 $|H_{x}^{(\\chi)}| < H_{k}$。亚稳态的消失恰好发生在能量极小值点不复存在之时，即在 $|H_{x}^{(\\chi)}| = H_{k}$ 处。在此临界点，SOT 有效场为 $H_{\\mathrm{DL}} = H_{\\mathrm{DL}}^{c}(\\chi)$，因此我们有：\n$$ H_{\\mathrm{DL}}^{c}(\\chi) + \\chi H_{D} = H_k $$\n求解临界类阻尼场，得到：\n$$ H_{\\mathrm{DL}}^{c}(\\chi) = H_k - \\chi H_D $$\n\n第三，我们将此临界场转换为临界电流密度 $J_{c}^{(\\chi)}$。问题给出了直接比例关系：\n$$ \\mu_{0} H_{\\mathrm{DL}} = \\frac{\\hbar\\,\\theta_{\\mathrm{SH}}}{2 e\\,M_{s}\\,t_{F}}\\,J $$\n由于 $J$ 与 $H_{\\mathrm{DL}}$ 成正比，临界电流密度 $J_{c}^{(\\chi)}$ 与 $H_{\\mathrm{DL}}^{c}(\\chi)$ 成正比。具体来说：\n$$ J_c^{(\\chi)} = \\left(\\frac{2 e M_s t_F \\mu_0}{\\hbar \\theta_{SH}}\\right) H_{\\mathrm{DL}}^c(\\chi) = \\left(\\frac{2 e M_s t_F \\mu_0}{\\hbar \\theta_{SH}}\\right) (H_k - \\chi H_D) $$\n最后，我们计算手性依赖的翻转效率对比度 $R$:\n$$ R \\equiv \\frac{J_{c}^{(+1)}}{J_{c}^{(-1)}} $$\n我们代入 $J_{c}^{(+1)}$ 和 $J_{c}^{(-1)}$ 的表达式：\n$$ J_{c}^{(+1)} = \\left(\\frac{2 e M_s t_F \\mu_0}{\\hbar \\theta_{SH}}\\right) (H_k - H_D) $$\n$$ J_{c}^{(-1)} = \\left(\\frac{2 e M_s t_F \\mu_0}{\\hbar \\theta_{SH}}\\right) (H_k + H_D) $$\n由于比例常数相消，比率简化为：\n$$ R = \\frac{(H_k - H_D)}{(H_k + H_D)} $$\n这是仅用 $H_{k}$ 和 $H_{D}$ 表示的 $R$ 的最终闭式表达式。给定条件 $0 < H_{D} < H_{k}$ 确保了分子和分母均为正，从而得到一个物理上有意义的结果，其中 $0 < R < 1$。", "answer": "$$ \\boxed{\\frac{H_{k} - H_{D}}{H_{k} + H_{D}}} $$", "id": "2860225"}]}