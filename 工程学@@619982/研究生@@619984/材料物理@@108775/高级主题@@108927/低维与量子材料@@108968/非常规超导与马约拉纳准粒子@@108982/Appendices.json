{"hands_on_practices": [{"introduction": "许多非常规超导体的配对机制源于看似“不友好”的电子间排斥相互作用。本练习将引导你通过一个简化的“热点”模型，亲手推导自旋涨落如何介导有效的吸引作用力。通过求解BCS线性化能隙方程，你将发现一个符号交错的超导能隙解，这是理解d波等非常规超导态的关键一步。[@problem_id:2869544]", "problem": "考虑一个$2$维金属，其费米面近似为圆形，并存在低能反铁磁自旋涨落。该涨落在一个单一波矢 $\\mathbf{Q}$ 处达到峰值，此波矢连接了费米面上两个对跖的热点区域。由这些自旋涨落媒介的有效单重态配对相互作用由以下模型描述\n\n$$\nV(\\mathbf{q}) \\;=\\; \\frac{3}{2} \\, U^{2} \\, \\chi(\\mathbf{q}), \\qquad \\chi(\\mathbf{q}) \\;=\\; \\frac{\\chi_{0}}{1 + \\xi^{2} |\\mathbf{q}-\\mathbf{Q}|^{2}},\n$$\n\n其中 $U>0$，$\\chi_{0}>0$，且关联长度 $\\xi \\gg k_{F}^{-1}$。在一个仅保留以动量 $\\mathbf{k}_{F}$ 和 $\\mathbf{k}_{F}+\\mathbf{Q}$ 为中心的两个热点区域的二区域简化模型中，假设如下：\n\n$$\nV_{11} \\approx 0, \\quad V_{22} \\approx 0, \\quad V_{12} = V_{21} \\approx \\frac{3}{2} \\, U^{2} \\, \\chi_{0},\n$$\n\n即，在 $1/\\xi$ 的领头阶上，区域间散射远强于区域内散射。设费米能级上每个区域的态密度为常数 $N_{p}$，并对库珀通道使用一个标准的弱耦合紫外频率截断 $\\omega_{c}$。\n\n从超导转变温度 $T_{c}$ 处的 Bardeen–Cooper–Schrieffer (BCS) 线性化能隙方程出发，\n\n$$\n\\Delta_{i} \\;=\\; - \\sum_{j\\in\\{1,2\\}} \\int d\\xi \\, N_{p} \\, V_{ij} \\, \\frac{\\tanh\\!\\big(\\xi/(2T_{c})\\big)}{2\\xi} \\, \\Delta_{j},\n$$\n\n将问题简化为热点区域上的一个 $2\\times 2$ 本征值方程，并求解以得到：\n\n$$\n\\text{(i) 归一化的领头本征函数 } (\\Delta_{1},\\Delta_{2}) \\text{，满足 } |\\Delta_{1}|^{2}+|\\Delta_{2}|^{2}=1, \n$$\n\n\n$$\n\\text{(ii) 以 } \\omega_{c},\\, U,\\, \\chi_{0},\\, N_{p} \\text{ 表示的超导转变温度 } T_{c}。\n$$\n\n采用玻尔兹曼常数 $k_{B}=1$ 的单位制，因此 $T_{c}$ 是一个能量。将最终的 $T_{c}$ 用 $\\omega_{c}$ 表示，除了对数库珀积分自然导出的因子外，不要引入任何额外的数值前置因子。将你的最终答案以一个包含 $\\Delta_{1}$、$\\Delta_{2}$ 和 $T_{c}$ 的单行向量形式给出。无需四舍五入；请给出封闭形式的解析表达式。", "solution": "所述问题具有科学依据，提法恰当，并包含足够的信息以在指定的理论模型内获得唯一解。这是非常规超导理论中的一个标准问题。因此，我将开始推导。\n\n出发点是问题中给出的线性化 Bardeen–Cooper–Schrieffer (BCS) 能隙方程：\n$$\n\\Delta_{i} \\;=\\; - \\sum_{j\\in\\{1,2\\}} \\int d\\xi \\, N_{p} \\, V_{ij} \\, \\frac{\\tanh\\!\\big(\\xi/(2T_{c})\\big)}{2\\xi} \\, \\Delta_{j}\n$$\n对单粒子能量 $\\xi$ 的积分在区间 $[-\\omega_{c}, \\omega_{c}]$ 上进行，其中 $\\omega_{c}$ 是紫外截断。该积分与区域指标 $i$ 和 $j$ 无关。我们将此积分因子定义为 $L(T_c)$：\n$$\nL(T_{c}) = \\int_{-\\omega_{c}}^{\\omega_{c}} d\\xi \\, N_{p} \\, \\frac{\\tanh(\\xi/(2T_{c}))}{2\\xi}\n$$\n被积函数是 $\\xi$ 的偶函数，因此积分可以简化为：\n$$\nL(T_{c}) = 2 N_{p} \\int_{0}^{\\omega_{c}} d\\xi \\, \\frac{\\tanh(\\xi/(2T_{c}))}{2\\xi} = N_{p} \\int_{0}^{\\omega_{c}} \\frac{d\\xi}{\\xi} \\tanh\\left(\\frac{\\xi}{2T_{c}}\\right)\n$$\n在弱耦合极限下，即转变温度 $T_c$ 远小于截断 $\\omega_c$ ($T_c \\ll \\omega_c$)，该积分由一个对数项主导。根据问题要求不引入额外数值前置因子的指示，我们对库珀积分采用标准的领头对数近似：\n$$\nL(T_{c}) \\approx N_{p} \\ln\\left(\\frac{\\omega_{c}}{T_{c}}\\right)\n$$\n将其代回能隙方程，得到关于能隙分量 $\\Delta_1$ 和 $\\Delta_2$ 的一个线性方程组：\n$$\n\\Delta_{i} = - L(T_{c}) \\sum_{j\\in\\{1,2\\}} V_{ij} \\Delta_{j}\n$$\n这可以表示为一个矩阵本征值方程：\n$$\n\\begin{pmatrix} V_{11} & V_{12} \\\\ V_{21} & V_{22} \\end{pmatrix} \\begin{pmatrix} \\Delta_1 \\\\ \\Delta_2 \\end{pmatrix} = -\\frac{1}{L(T_{c})} \\begin{pmatrix} \\Delta_1 \\\\ \\Delta_2 \\end{pmatrix}\n$$\n设 $\\mathbf{V}$ 为相互作用矩阵，$\\lambda_{V}$ 为其一个本征值。能隙向量 $(\\Delta_{1}, \\Delta_{2})$ 存在非平凡解的条件是：\n$$\n\\lambda_{V} = -\\frac{1}{L(T_{c})}\n$$\n为了在有限温度 $T_c > 0$ 下形成超导态，我们需要 $L(T_c) = N_p \\ln(\\omega_c/T_c) > 0$。这意味着只有当相互作用矩阵拥有一个负的（吸引的）本征值 $\\lambda_{V} < 0$ 时，解才可能存在。最高的转变温度由最负的本征值 $\\lambda_{V, \\text{min}}$ 决定。\n\n问题给出了二区域模型的相互作用矩阵元：$V_{11} \\approx 0$，$V_{22} \\approx 0$，以及 $V_{12} = V_{21} \\approx \\frac{3}{2} U^{2} \\chi_{0}$。我们用 $V_{0} = \\frac{3}{2} U^{2} \\chi_{0}$ (其中 $V_{0} > 0$) 表示排斥性的区域间相互作用强度。因此，相互作用矩阵 $\\mathbf{V}$ 为：\n$$\n\\mathbf{V} = \\begin{pmatrix} 0 & V_{0} \\\\ V_{0} & 0 \\end{pmatrix}\n$$\n我们通过求解特征方程 $\\det(\\mathbf{V} - \\lambda_{V}\\mathbf{I}) = 0$ 来求 $\\mathbf{V}$ 的本征值：\n$$\n\\det \\begin{pmatrix} -\\lambda_{V} & V_{0} \\\\ V_{0} & -\\lambda_{V} \\end{pmatrix} = (-\\lambda_{V})^{2} - V_{0}^{2} = \\lambda_{V}^{2} - V_{0}^{2} = 0\n$$\n本征值为 $\\lambda_{V, \\pm} = \\pm V_{0}$。领头不稳定性对应于具有最负本征值 $\\lambda_{V, \\text{min}} = -V_{0}$ 的吸引通道。\n\n(i) 我们首先确定归一化的领头本征函数 $(\\Delta_1, \\Delta_2)$。这是对应于本征值 $\\lambda_{V, \\text{min}} = -V_{0}$ 的本征向量。\n$$\n\\begin{pmatrix} 0 & V_{0} \\\\ V_{0} & 0 \\end{pmatrix} \\begin{pmatrix} \\Delta_1 \\\\ \\Delta_2 \\end{pmatrix} = -V_{0} \\begin{pmatrix} \\Delta_1 \\\\ \\Delta_2 \\end{pmatrix}\n$$\n该矩阵方程给出了条件 $V_{0}\\Delta_{2} = -V_{0}\\Delta_{1}$ 和 $V_{0}\\Delta_{1} = -V_{0}\\Delta_{2}$，两者都可简化为 $\\Delta_{2} = -\\Delta_{1}$。这表明能隙结构是变号的，这是类 d 波配对的特征。为了找到具体的分量，我们应用归一化条件 $|\\Delta_{1}|^{2} + |\\Delta_{2}|^{2} = 1$：\n$$\n|\\Delta_{1}|^{2} + |-\\Delta_{1}|^{2} = 2|\\Delta_{1}|^{2} = 1 \\implies |\\Delta_{1}| = \\frac{1}{\\sqrt{2}}\n$$\n选择使 $\\Delta_1$ 为实数且为正的全局相位，我们得到归一化的本征函数：\n$$\n\\Delta_{1} = \\frac{1}{\\sqrt{2}}, \\quad \\Delta_{2} = -\\frac{1}{\\sqrt{2}}\n$$\n\n(ii) 接下来，我们计算超导转变温度 $T_c$。我们使用领头不稳定性的条件，其中 $\\lambda_{V, \\text{min}} = -V_{0}$：\n$$\n-V_{0} = -\\frac{1}{L(T_{c})} = -\\frac{1}{N_{p} \\ln(\\omega_{c}/T_{c})}\n$$\n这可以简化为：\n$$\nV_{0} = \\frac{1}{N_{p} \\ln(\\omega_{c}/T_{c})}\n$$\n求解对数项得到：\n$$\n\\ln\\left(\\frac{\\omega_{c}}{T_{c}}\\right) = \\frac{1}{N_{p} V_{0}}\n$$\n现在我们代入 $V_{0} = \\frac{3}{2} U^{2} \\chi_{0}$ 的表达式：\n$$\n\\ln\\left(\\frac{\\omega_{c}}{T_{c}}\\right) = \\frac{1}{N_{p} (\\frac{3}{2} U^{2} \\chi_{0})} = \\frac{2}{3 N_{p} U^{2} \\chi_{0}}\n$$\n对等式两边取指数，得到：\n$$\n\\frac{\\omega_{c}}{T_{c}} = \\exp\\left(\\frac{2}{3 N_{p} U^{2} \\chi_{0}}\\right)\n$$\n最后，我们分离出 $T_c$ 以获得转变温度的最终表达式：\n$$\nT_{c} = \\omega_{c} \\exp\\left(-\\frac{2}{3 N_{p} U^{2} \\chi_{0}}\\right)\n$$\n这个结果具有 BCS 型理论的典型指数形式，其中有效无量纲耦合由态密度与吸引相互作用强度 $N_p V_0$ 的乘积给出。\n\n最终答案是一个包含 $\\Delta_1$、$\\Delta_2$ 和 $T_c$ 的行向量。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{\\sqrt{2}} & -\\frac{1}{\\sqrt{2}} & \\omega_{c} \\exp\\left(-\\frac{2}{3 N_{p} U^{2} \\chi_{0}}\\right) \\end{pmatrix}}\n$$", "id": "2869544"}, {"introduction": "寻找和创造拓扑超导是凝聚态物理学的前沿课题，它有望承载马约拉纳准粒子。本练习聚焦于构筑拓扑超导的经典平台——半导体纳米线，并要求你推导其拓扑相变发生的临界条件。通过分析系统的体能隙何时关闭，你将精确地在参数空间中绘制出平凡相与拓扑相之间的边界线。[@problem_id:2869603]", "problem": "考虑一个洁净、无限长的一维半导体纳米线，其具有 Rashba 自旋轨道耦合，并与一个常规的自旋单态超导体邻近耦合。其低能准粒子由 Bogoliubov–de Gennes (BdG) 哈密顿量在 Nambu 旋量基 $\\Psi_{k} = (c_{k\\uparrow}, c_{k\\downarrow}, c^{\\dagger}_{-k\\uparrow}, c^{\\dagger}_{-k\\downarrow})^{T}$ 下描述，\n$$\nH(k) \\;=\\; \\bigg(\\frac{\\hbar^{2} k^{2}}{2m} - \\mu\\bigg)\\,\\tau_{z} \\;+\\; \\alpha\\,k\\,\\sigma_{y}\\,\\tau_{z} \\;+\\; V_{Z}\\,\\sigma_{x} \\;+\\; \\Delta\\,\\tau_{x},\n$$\n其中 $m$ 是有效质量，$\\mu$ 是化学势，$\\alpha$ 是 Rashba 自旋轨道耦合强度，$V_{Z}$ 是与沿 $x$ 轴的均匀磁场相关的塞曼能，而 $\\Delta>0$ 是感应的 s 波配对振幅。此处 $\\sigma_{i}$ 和 $\\tau_{i}$ 分别是作用在自旋空间和粒子-空穴（Nambu）空间中的泡利矩阵。假设系统具有平移不变性，并忽略轨道磁效应和无序。\n\n一个能够承载马约拉纳准粒子的体拓扑相变，要求体准粒子能隙在某个晶格动量 $k$ 处闭合。对于固定的 $\\alpha$ 和 $\\Delta$，通过确定体能隙闭合处的参数轨迹，来确定 $(\\mu, V_{Z})$ 平面上的相图。您的推导必须从上述哈密顿量和基本判据出发，即当存在一个动量 $k$ 使得最低正能 BdG 能带接触零点时，能隙发生闭合。\n\n请提供能隙闭合线 $V_{Z}^{\\ast}(\\mu)$ 的精确解析表达式，该表达式给出作为 $\\mu$ 和 $\\Delta$ 函数的正分支。在中间步骤中，您可以设置 $\\hbar = 1$，并将 $m$ 和 $\\alpha$ 视为有限常数。最终答案必须是一个不带单位的单一闭式表达式。请勿近似。", "solution": "本问题要求确定一维纳米线系统中拓扑相变的相边界。该边界对应于体准粒子能隙闭合的参数集合 $(\\mu, V_{Z})$。出发点是给定的 Bogoliubov-de Gennes (BdG) 哈密顿量，在 Nambu 旋量基 $\\Psi_{k} = (c_{k\\uparrow}, c_{k\\downarrow}, c^{\\dagger}_{-k\\uparrow}, c^{\\dagger}_{-k\\downarrow})^{T}$ 下表示为\n$$\nH(k) \\;=\\; \\bigg(\\frac{\\hbar^{2} k^{2}}{2m} - \\mu\\bigg)\\,\\tau_{z} \\;+\\; \\alpha\\,k\\,\\sigma_{y}\\,\\tau_{z} \\;+\\; V_{Z}\\,\\sigma_{x} \\;+\\; \\Delta\\,\\tau_{x}\n$$\n泡利矩阵 $\\sigma_{i}$ 和 $\\tau_{i}$ 分别作用于自旋空间和粒子-空穴空间。根据题目要求，我们设置 $\\hbar = 1$。涉及泡利矩阵乘积的项使用克罗内克积形式进行解释，这与该模型的标准文献一致。具体来说，像 $\\sigma_x$ 这样只包含 $\\sigma$ 矩阵的项被解释为 $I_{\\tau} \\otimes \\sigma_x$，像 $\\tau_x$ 这样只包含 $\\tau$ 矩阵的项被解释为 $\\tau_x \\otimes I_{\\sigma}$，而乘积 $\\sigma_y \\tau_z$ 则是 $(\\tau_z \\otimes I_{\\sigma})(I_{\\tau} \\otimes \\sigma_y) = \\tau_z \\otimes \\sigma_y$。\n\n令 $\\xi_k = \\frac{k^2}{2m} - \\mu$。哈密顿量可以写成 $4 \\times 4$ 矩阵形式。其组成矩阵的表示为：\n$$\n\\tau_z \\rightarrow \\begin{pmatrix} I & 0 \\\\ 0 & -I \\end{pmatrix}, \\quad \\sigma_y \\tau_z \\rightarrow \\begin{pmatrix} \\sigma_y & 0 \\\\ 0 & -\\sigma_y \\end{pmatrix}, \\quad \\sigma_x \\rightarrow \\begin{pmatrix} \\sigma_x & 0 \\\\ 0 & \\sigma_x \\end{pmatrix}, \\quad \\tau_x \\rightarrow \\begin{pmatrix} 0 & I \\\\ I & 0 \\end{pmatrix}\n$$\n其中 $I$ 和 $\\sigma_i$ 是自旋空间中的 $2 \\times 2$ 单位矩阵和泡利矩阵。\n将这些组合起来，哈密顿量表示为一个分块矩阵：\n$$\nH(k) = \\begin{pmatrix} \\xi_k I + \\alpha k \\sigma_y + V_Z \\sigma_x & \\Delta I \\\\ \\Delta I & -\\xi_k I - \\alpha k \\sigma_y + V_Z \\sigma_x \\end{pmatrix}\n$$\n体能隙的闭合标志着拓扑相变。当存在某个动量 $k$，使得准粒子能量本征值 $E(k)$ 变为零时，就会发生这种情况。本征值由特征方程 $\\det(H(k) - E \\cdot I_4) = 0$ 确定。对于能隙闭合，我们需要一个零能解，这要求 $\\det(H(k)) = 0$。\n\n使用 $2 \\times 2$ 分块矩阵的行列式公式，如果 $C$ 可逆，则有 $\\det \\begin{pmatrix} A & B \\\\ C & D \\end{pmatrix} = \\det(AD - CBC^{-1}B)$。一个更通用的公式是当 $B$ 和 $C$ 与 $A$ 和 $D$ 对易时的 $\\det(AD-BC)$。在这里，这些块通常不对易。我们使用以下形式：\n$$\n\\det(H(k)) = \\det\\left( (\\xi_k I + \\alpha k \\sigma_y + V_Z \\sigma_x)(-\\xi_k I - \\alpha k \\sigma_y + V_Z \\sigma_x) - \\Delta^2 I \\right) = 0\n$$\n我们定义 $h_0(k) = \\xi_k I + \\alpha k \\sigma_y$。行列式内的表达式变为：\n$$\n(h_0(k) + V_Z \\sigma_x)(-h_0(k) + V_Z \\sigma_x) - \\Delta^2 I = -h_0(k)^2 + h_0(k)V_Z\\sigma_x - V_Z\\sigma_x h_0(k) + V_Z^2 \\sigma_x^2 - \\Delta^2 I\n$$\n这可以简化为：\n$$\n-h_0(k)^2 + V_Z[h_0(k), \\sigma_x] + (V_Z^2 - \\Delta^2) I\n$$\n我们计算对易子：\n$$\n[h_0(k), \\sigma_x] = [\\xi_k I + \\alpha k \\sigma_y, \\sigma_x] = \\alpha k [\\sigma_y, \\sigma_x] = -2i\\alpha k \\sigma_z\n$$\n我们还计算 $h_0(k)$ 的平方：\n$$\nh_0(k)^2 = (\\xi_k I + \\alpha k \\sigma_y)^2 = \\xi_k^2 I + 2\\alpha k \\xi_k \\sigma_y + (\\alpha k)^2 \\sigma_y^2 = (\\xi_k^2 + (\\alpha k)^2)I + 2\\alpha k \\xi_k \\sigma_y\n$$\n将这些代回，我们需要计算其行列式的矩阵是：\n$$\nM = - ((\\xi_k^2 + (\\alpha k)^2)I + 2\\alpha k \\xi_k \\sigma_y) - 2i\\alpha k V_Z \\sigma_z + (V_Z^2 - \\Delta^2) I\n$$\n$$\nM = (V_Z^2 - \\Delta^2 - \\xi_k^2 - (\\alpha k)^2)I - 2\\alpha k \\xi_k \\sigma_y - 2i\\alpha k V_Z \\sigma_z\n$$\n这是一个形如 $A I + B \\sigma_y + C \\sigma_z$ 的 $2 \\times 2$ 矩阵。其行列式为 $A^2 - B^2 - C^2$。\n$$\n\\det(M) = (V_Z^2 - \\Delta^2 - \\xi_k^2 - (\\alpha k)^2)^2 - (-2\\alpha k \\xi_k)^2 - (-2i\\alpha k V_Z)^2 = 0\n$$\n$$\n(V_Z^2 - \\Delta^2 - \\xi_k^2 - (\\alpha k)^2)^2 - 4(\\alpha k)^2 \\xi_k^2 - (4 i^2 (\\alpha k V_Z)^2) = 0\n$$\n$$\n(V_Z^2 - \\Delta^2 - \\xi_k^2 - (\\alpha k)^2)^2 - 4(\\alpha k)^2 \\xi_k^2 + 4(\\alpha k)^2 V_Z^2 = 0\n$$\n这简化为能隙闭合条件：\n$$\n(V_Z^2 - \\Delta^2 - \\xi_k^2 - (\\alpha k)^2)^2 + 4(\\alpha k)^2(V_Z^2 - \\xi_k^2) = 0\n$$\n该方程必须有一个关于动量 $k$ 的实数解，才能使能隙闭合。第一项是一个实数的平方，因此是非负的。第二项的符号取决于 $V_Z^2 - \\xi_k^2$。\n我们来分析 $k$ 的解的可能性：\n情况1：$V_Z^2 - \\xi_k^2 \\geq 0$。和中的两项都是非负的。要使和为零，两项都必须为零。\n$4(\\alpha k)^2(V_Z^2 - \\xi_k^2) = 0$。由于 $\\alpha$ 是一个有限常数，这要求 $k=0$ 或 $V_Z^2 = \\xi_k^2$。\n如果 $k=0$，那么 $\\xi_0 = -\\mu$。条件变为 $(V_Z^2 - \\Delta^2 - \\mu^2)^2 = 0$，这给出 $V_Z^2 = \\mu^2 + \\Delta^2$。这是一个有效解。\n如果 $k \\ne 0$ 且 $V_Z^2 = \\xi_k^2$，则第一项变为 $(V_Z^2 - \\Delta^2 - V_Z^2 - (\\alpha k)^2)^2 = (-\\Delta^2 - (\\alpha k)^2)^2 = (\\Delta^2 + (\\alpha k)^2)^2$。该项仅在 $\\Delta=0$ 和 $\\alpha k = 0$ 时才能为零。然而，题目说明 $\\Delta > 0$。因此，这个子情况没有解。\n\n情况2：$V_Z^2 - \\xi_k^2 < 0$。第二项为负。方程可以写成 $(V_Z^2 - \\Delta^2 - \\xi_k^2 - (\\alpha k)^2)^2 = 4(\\alpha k)^2(\\xi_k^2 - V_Z^2)$。这看起来是可能的。\n\n一个更直接的方法是将能隙闭合条件视为关于变量 $X=V_Z^2$ 的二次方程，其系数依赖于 $k$。\n令 $A=\\Delta^2$，$B_k = \\xi_k^2+(\\alpha k)^2$，$C_k=4(\\alpha k)^2$ 和 $D_k=\\xi_k^2$。方程为 $(X - A - B_k)^2 + C_k(X - D_k) = 0$。\n$X^2 + X(-2(A+B_k)+C_k) + (A+B_k)^2 - C_k D_k = 0$。\n$X=V_Z^2$ 的解由二次公式给出。此方程的判别式 $D_s$ 为：\n$D_s = (C_k-2(A+B_k))^2 - 4((A+B_k)^2 - C_k D_k) = C_k^2 - 4C_k(A+B_k) + 4C_k D_k = C_k(C_k-4A-4B_k+4D_k)$。\n代入定义：\n$C_k-4A-4B_k+4D_k = 4(\\alpha k)^2 - 4\\Delta^2 - 4(\\xi_k^2+(\\alpha k)^2) + 4\\xi_k^2 = -4\\Delta^2$。\n所以，$D_s = C_k(-4\\Delta^2) = 4(\\alpha k)^2(-4\\Delta^2) = -16(\\alpha k \\Delta)^2$。\n$V_Z^2$ 的解是：\n$$\nV_Z^2 = \\frac{2(A+B_k)-C_k \\pm \\sqrt{D_s}}{2} = \\Delta^2+\\xi_k^2+(\\alpha k)^2 - 2(\\alpha k)^2 \\pm \\frac{\\sqrt{-16(\\alpha k \\Delta)^2}}{2}\n$$\n$$\nV_Z^2 = \\Delta^2 + \\xi_k^2 - (\\alpha k)^2 \\pm 2i|\\alpha k \\Delta|\n$$\n由于 $V_Z$ 是一个真实的物理参数，$V_Z^2$ 必须是一个实数。这要求解的虚部为零：\n$$\n2|\\alpha k \\Delta| = 0\n$$\n考虑到 $\\alpha$ 是一个有限常数且 $\\Delta > 0$，此条件只能在 $k=0$ 时满足。\n因此，能隙闭合只能在动量 $k=0$ 处发生。\n\n将 $k=0$ 代入 $V_Z^2$ 的条件中，虚部消失，我们得到：\n$$\nV_Z^2 = \\Delta^2 + \\xi_0^2 - 0 = \\Delta^2 + (-\\mu)^2 = \\mu^2 + \\Delta^2\n$$\n这个方程定义了 $(\\mu, V_{Z})$ 平面中体能隙闭合的点的轨迹，这对应于拓扑相变边界。问题要求的是正分支 $V_Z^*(\\mu)$。\n为了使 $V_Z$ 为实数，我们需要 $\\mu^2+\\Delta^2 \\ge 0$。由于 $\\Delta > 0$，对于任何实数 $\\mu$ 这总是成立的。\n因此，正的能隙闭合线的表达式是：\n$$\nV_Z^*(\\mu) = \\sqrt{\\mu^2 + \\Delta^2}\n$$\n这描述了 $(\\mu, V_Z)$ 平面中的一条双曲线，它将平庸超导相 ($V_Z < \\sqrt{\\mu^2 + \\Delta^2}$) 与拓扑超导相 ($V_Z > \\sqrt{\\mu^2 + \\Delta^2}$) 分开。", "answer": "$$\n\\boxed{\\sqrt{\\mu^{2} + \\Delta^{2}}}\n$$", "id": "2869603"}, {"introduction": "拓扑物态的“拓扑”性质并非空谈，而是由一个量子化的整数——拓扑不变量来精确刻画的。本练习将指导你运用一种强大的数值方法（Fukui–Hatsugai–Suzuki方法）来计算一个二维手性 $p+ip$ 超导体的陈数。完成此练习后，你将掌握一个从第一性原理出发，通过计算来鉴别拓扑相的实用技能。[@problem_id:2869469]", "problem": "实现一个完整的程序，该程序使用适用于数值计算的贝里曲率的规范不变格点离散化方法，来计算二维无自旋方格子上手性 $p+ip$ 超导体的占据带的第一陈数，并在布里渊区网格细化时验证结果的收敛性。使用以下物理上标准的 Bogoliubov–de Gennes (BdG) 形式作为基本框架。\n\n考虑一个方格子上的紧束缚模型，其最近邻跃迁振幅为 $t$，化学势为 $\\mu$，手性配对振幅为 $\\Delta$。在动量空间中，这个 $2 \\times 2$ 的 BdG 哈密顿量为\n$$\nH(\\mathbf{k}) =\n\\begin{pmatrix}\n\\xi(\\mathbf{k}) & \\Delta(\\mathbf{k}) \\\\\n\\Delta^{\\ast}(\\mathbf{k}) & -\\xi(\\mathbf{k})\n\\end{pmatrix},\n$$\n其中\n$$\n\\xi(\\mathbf{k}) = -2t\\left(\\cos k_x + \\cos k_y\\right) - \\mu,\\qquad\n\\Delta(\\mathbf{k}) = \\Delta\\left(\\sin k_x + i \\sin k_y\\right),\n$$\n其中 $\\mathbf{k}=(k_x,k_y)$ 位于布里渊区 $[-\\pi,\\pi)\\times[-\\pi,\\pi)$ 内。在 $\\hbar=1$ 的单位制下进行计算。\n\n从以下核心定义开始。占据带是 $H(\\mathbf{k})$ 的负能量本征态 $\\lvert u(\\mathbf{k})\\rangle$。贝里联络为 $A_i(\\mathbf{k})=-i\\langle u(\\mathbf{k})\\rvert \\partial_{k_i}\\lvert u(\\mathbf{k})\\rangle$（$i\\in\\{x,y\\}$），贝里曲率为 $F_{xy}(\\mathbf{k})=\\partial_{k_x}A_y(\\mathbf{k})-\\partial_{k_y}A_x(\\mathbf{k})$，第一陈数为\n$$\nC = \\frac{1}{2\\pi}\\int_{\\text{BZ}} F_{xy}(\\mathbf{k})\\,d^2\\mathbf{k},\n$$\n当能谱完全有隙时，其值为整数。\n\n您的任务：\n- 将布里渊区在 $k$ 空间中均匀离散化为一个 $N_k\\times N_k$ 的网格，其中 $k_x,k_y\\in[-\\pi,\\pi)$ 在 $N_k$ 个等距点上以弧度为单位进行采样。实现一种稳定、规范不变的贝里曲率积分的格点离散化方法（例如，最初由 Takahiro Fukui、Yasuhiro Hatsugai 和 Hiroshi Suzuki 提出的 Fukui–Hatsugai–Suzuki 方法）来计算占据带的陈数 $C$。除了占据带定义所隐含的条件外，不要对规范或相位的平滑性做任何特殊假设。\n- 在离散布里渊区上构建有限差分或链变量时，确保动量空间中的周期性边界条件。\n- 对每组参数，在逐渐加密的网格上计算陈数，并通过比较在连续的 $N_k$ 下计算出的值来评估收敛性。收敛性定义如下：给定三个尺寸为 $N_k^{(1)}<N_k^{(2)}<N_k^{(3)}$ 的网格，计算出三个估算值 $C^{(1)},C^{(2)},C^{(3)}$（在进行任何舍入操作前为实数），如果 $\\lvert C^{(2)}-C^{(1)}\\rvert<10^{-3}$ 并且 $\\lvert C^{(3)}-C^{(2)}\\rvert<10^{-3}$，则声明为收敛。报告时，将最密网格的值 $C^{(3)}$ 使用标准舍入规则四舍五入到最近的整数，以获得整数陈数。\n- 数值单位：角度以弧度为单位。不需要其他物理单位。\n\n测试套件：\n计算以下参数集的结果（所有参数集均设置 $t=1.0$ 和 $\\Delta=1.0$）：\n- 情况 1：$\\mu=-2.0$，网格 $N_k\\in\\{11,21,41\\}$。\n- 情况 2：$\\mu=2.0$，网格 $N_k\\in\\{11,21,41\\}$。\n- 情况 3：$\\mu=5.0$，网格 $N_k\\in\\{11,21,41\\}$。\n\n每种情况所需的输出：\n- 一个整数，等于从最密网格 $N_k=41$ 得到的陈数四舍五入后的值。\n- 一个布尔值，指示这三个网格上的序列是否满足上述收敛准则。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每种情况由一个形式为 $[C_{\\text{int}},\\text{converged}]$ 的双元素列表表示。具体来说，输出必须具有以下形式\n$[[C_{\\text{int}}^{(1)},\\text{converged}^{(1)}],[C_{\\text{int}}^{(2)},\\text{converged}^{(2)}],[C_{\\text{int}}^{(3)},\\text{converged}^{(3)}]]$\n不带任何多余的空格或文本。根据构造，角度以弧度为单位，输出中不需要其他单位。", "solution": "所提出的问题是计算凝聚态物理学中一个适定且有科学依据的任务。它要求为一个二维手性超导体的典范模型计算一个拓扑不变量，即第一陈数。所有参数、定义和数值步骤都得到了明确陈述，并与拓拓扑能带理论的既定原则相符。该模型是方格子上无自旋 $p+ip$ 超导体的 Bogoliubov–de Gennes (BdG) 哈密顿量，这是研究拓扑相和马约拉纳准粒子的基石。该问题是有效的。\n\n核心任务是计算给定 BdG 哈密顿量 $H(\\mathbf{k})$ 的占据带（负能带）的第一陈数 $C$。在基 $(\\psi_{\\mathbf{k}}, \\psi_{-\\mathbf{k}}^{\\dagger})^T$ 下，哈密顿量为：\n$$\nH(\\mathbf{k}) =\n\\begin{pmatrix}\n\\xi(\\mathbf{k}) & \\Delta(\\mathbf{k}) \\\\\n\\Delta^{\\ast}(\\mathbf{k}) & -\\xi(\\mathbf{k})\n\\end{pmatrix} = \\mathbf{d}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}\n$$\n其中 $\\boldsymbol{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ 是泡利矩阵矢量，矢量 $\\mathbf{d}(\\mathbf{k})$ 由 $\\mathbf{d}(\\mathbf{k}) = (\\text{Re}[\\Delta(\\mathbf{k})], -\\text{Im}[\\Delta(\\mathbf{k})], \\xi(\\mathbf{k}))$ 给出。其分量为：\n$$\n\\xi(\\mathbf{k}) = -2t\\left(\\cos k_x + \\cos k_y\\right) - \\mu\n$$\n$$\n\\Delta(\\mathbf{k}) = \\Delta\\left(\\sin k_x + i \\sin k_y\\right)\n$$\n$H(\\mathbf{k})$ 的本征值为 $E_{\\pm}(\\mathbf{k}) = \\pm |\\mathbf{d}(\\mathbf{k})| = \\pm\\sqrt{\\xi(\\mathbf{k})^2 + |\\Delta(\\mathbf{k})|^2}$。只要在整个布里渊区 (BZ)（即 $[-\\pi, \\pi) \\times [-\\pi, \\pi)$）内对所有 $\\mathbf{k}$ 都有 $|\\mathbf{d}(\\mathbf{k})| \\neq 0$，系统就是有能隙的。占据带对应于负本征值 $E_-(\\mathbf{k})$，其归一化本征矢量记为 $\\lvert u(\\mathbf{k})\\rangle$。对于此双能带模型，$\\lvert u(\\mathbf{k})\\rangle$ 可以用归一化矢量 $\\hat{\\mathbf{d}}(\\mathbf{k}) = \\mathbf{d}(\\mathbf{k})/|\\mathbf{d}(\\mathbf{k})|$ 来表示。\n\n第一陈数定义为贝里曲率 $F_{xy}(\\mathbf{k})$ 在整个布里渊区上的积分：\n$$\nC = \\frac{1}{2\\pi} \\int_{\\text{BZ}} F_{xy}(\\mathbf{k}) \\, dk_x dk_y\n$$\n贝里曲率为 $F_{xy}(\\mathbf{k}) = \\partial_{k_x} A_y(\\mathbf{k}) - \\partial_{k_y} A_x(\\mathbf{k})$，其中贝里联络分量为 $A_i(\\mathbf{k}) = -i \\langle u(\\mathbf{k}) \\rvert \\partial_{k_i} \\lvert u(\\mathbf{k}) \\rangle$。通过离散化此定义直接进行数值实现是有问题的。本征矢量 $\\lvert u(\\mathbf{k})\\rangle$ 的定义只在一个任意的相位因子（或规范）$e^{i\\chi(\\mathbf{k})}$ 内确定。数值本征求解器可能返回具有快速波动、不平滑规范的本征矢量，这使得对 $\\lvert u(\\mathbf{k})\\rangle$ 的数值微分变得不可靠。\n\n为了规避这个问题，我们使用由 Fukui、Hatsugai 和 Suzuki 开发的规范不变数值方法。该方法在离散的布里渊区上计算陈数，而无需平滑的规范。布里渊区被离散化成一个均匀的 $N_k \\times N_k$ 格点，点坐标为 $\\mathbf{k}_{j_x, j_y} = (-\\pi + j_x \\delta k, -\\pi + j_y \\delta k)$，其中 $\\delta k = 2\\pi/N_k$ 且 $j_x, j_y = 0, \\dots, N_k-1$。\n\n首先，我们定义连接该动量空间格点上相邻点的 U(1) 链变量。对于从点 $\\mathbf{k}$ 出发、方向为 $i \\in \\{x,y\\}$ 的链，其链变量为：\n$$\nU_i(\\mathbf{k}) = \\frac{\\langle u(\\mathbf{k}) \\lvert u(\\mathbf{k} + \\delta k \\hat{e}_i) \\rangle}{|\\langle u(\\mathbf{k}) \\lvert u(\\mathbf{k} + \\delta k \\hat{e}_i) \\rangle|}\n$$\n其中 $\\hat{e}_i$ 是 $k_i$ 方向的单位矢量。此变量捕捉了相邻点处本征态之间的相对相位，其模为 1。分母使得定义对本征矢量的任意缩放具有鲁棒性，尽管我们假设它们是归一化的。通过环绕网格来施加布里渊区的周期性边界条件，即索引对 $N_k$ 取模。\n\n接下来，我们在离散布里渊区的每个基本格框上定义格点场强（或格框磁通）。对于左下角位于 $\\mathbf{k}$ 的格框，其磁通由环绕它的链变量的乘积导出：\n$$\n\\tilde{F}_{xy}(\\mathbf{k}) = U_x(\\mathbf{k}) \\, U_y(\\mathbf{k} + \\delta k \\hat{e}_x) \\, U_x(\\mathbf{k} + \\delta k \\hat{e}_y)^{-1} \\, U_y(\\mathbf{k})^{-1}\n$$\n此格框上的贝里曲率定义为该复数的辐角：\n$$\nF_{xy}^{\\text{lat}}(\\mathbf{k}) = \\arg(\\tilde{F}_{xy}(\\mathbf{k})) = \\text{Im}[\\ln(\\tilde{F}_{xy}(\\mathbf{k}))]\n$$\n`arg` 函数必须返回区间 $(-\\pi, \\pi]$ 内的主值。这个量是显式规范不变的。\n\n总陈数即为所有格框上这些局部曲率的总和，并用 $2\\pi$ 进行归一化：\n$$\nC = \\frac{1}{2\\pi} \\sum_{j_x, j_y = 0}^{N_k-1} F_{xy}^{\\text{lat}}(\\mathbf{k}_{j_x, j_y})\n$$\n只要系统是有能隙的，当 $N_k \\to \\infty$ 时，这个和将收敛到真实的整数陈数。\n\n计算流程如下：\n1. 对于每组参数 $(\\mu, t, \\Delta)$，为给定的网格尺寸 $N_k$，定义一个计算 $C$ 的函数。\n2. 在函数内部，生成 $\\mathbf{k}$ 点的 $N_k \\times N_k$ 网格。\n3. 对于网格上的每个 $\\mathbf{k}$，构造 $2 \\times 2$ 的哈密顿矩阵 $H(\\mathbf{k})$。\n4. 使用数值本征求解器（例如 `numpy.linalg.eigh`）对角化 $H(\\mathbf{k})$。存储每个 $\\mathbf{k}$ 对应的较低（负）本征值的本征矢量。这将得到一个由二维复矢量组成的 $N_k \\times N_k$ 数组。\n5. 计算网格上所有链的链变量 $U_x$ 和 $U_y$。这通过对本征矢量数组与其移位后的版本（使用 `numpy.roll` 实现周期性边界）进行矢量化内积来完成。结果被归一化为单位模。\n6. 使用链变量数组和适当的移位来计算格框乘积 $\\tilde{F}_{xy}$。\n7. 通过取格框乘积的辐角（使用 `numpy.angle`）来计算格点曲率 $F_{xy}^{\\text{lat}}$。\n8. 将所有 $F_{xy}^{\\text{lat}}$ 值相加，然后除以 $2\\pi$ 得到作为浮点数的陈数 $C$。\n9. 对于每个参数集，对网格尺寸 $N_k \\in \\{11, 21, 41\\}$ 重复此计算，以获得 $C^{(1)}, C^{(2)}, C^{(3)}$。\n10. 通过检查 $|C^{(2)} - C^{(1)}| < 10^{-3}$ 和 $|C^{(3)} - C^{(2)}| < 10^{-3}$ 来评估收敛性。\n11. 将最密网格的结果 $C^{(3)}$ 四舍五入到最近的整数，以报告最终的陈数。根据理论推导，测试用例的期望值为：$\\mu=-2.0$ 时为 $1$，$\\mu=2.0$ 时为 $-1$，$\\mu=5.0$ 时为 $0$，这为正确性提供了有力的检验。", "answer": "```python\nimport numpy as np\n\ndef compute_chern(t, mu, delta, Nk):\n    \"\"\"\n    Computes the first Chern number of the occupied band of a p+ip superconductor.\n\n    Args:\n        t (float): Hopping amplitude.\n        mu (float): Chemical potential.\n        delta (float): Pairing amplitude.\n        Nk (int): Size of the Brillouin zone mesh (Nk x Nk).\n\n    Returns:\n        float: The computed Chern number.\n    \"\"\"\n    # 1. Discretize the Brillouin Zone\n    # kx, ky grid from -pi to pi (exclusive of pi)\n    k_vals = np.linspace(-np.pi, np.pi, Nk, endpoint=False)\n    kx, ky = np.meshgrid(k_vals, k_vals)\n\n    # 2. Calculate Hamiltonian components and eigenvectors\n    xi_k = -2 * t * (np.cos(kx) + np.cos(ky)) - mu\n    delta_k = delta * (np.sin(kx) + 1j * np.sin(ky))\n    \n    # The BdG Hamiltonian is H = xi*sigma_z + Re(delta)*sigma_x - Im(delta)*sigma_y\n    # The eigenvectors of d.sigma are known analytically, but numerical diagonalization is more general.\n    # We construct the Hamiltonian for each k-point and diagonalize it.\n    eigenvectors = np.zeros((Nk, Nk, 2), dtype=np.complex128)\n    \n    for i in range(Nk):\n        for j in range(Nk):\n            H_k = np.array([\n                [xi_k[i, j], delta_k[i, j]],\n                [np.conj(delta_k[i, j]), -xi_k[i, j]]\n            ], dtype=np.complex128)\n            \n            # Diagonalize to get eigenvalues and eigenvectors\n            # eigh returns sorted eigenvalues, so the first eigenvector\n            # corresponds to the lowest eigenvalue (occupied band)\n            eigenvalues, eigvecs = np.linalg.eigh(H_k)\n            eigenvectors[i, j, :] = eigvecs[:, 0]\n\n    # 3. Compute U(1) link variables using the Fukui-Hatsugai-Suzuki method\n    # Shift eigenvectors for periodic boundary conditions\n    eigenvectors_x_shifted = np.roll(eigenvectors, -1, axis=1) # Shift in +kx (j)\n    eigenvectors_y_shifted = np.roll(eigenvectors, -1, axis=0) # Shift in +ky (i)\n\n    # Calculate overlaps (inner products)\n    # <u(k)|u(k+dk_x)>\n    U_x = np.einsum('ijk,ijk->ij', np.conj(eigenvectors), eigenvectors_x_shifted)\n    # <u(k)|u(k+dk_y)>\n    U_y = np.einsum('ijk,ijk->ij', np.conj(eigenvectors), eigenvectors_y_shifted)\n    \n    # Normalize to get U(1) link variables\n    U_x /= np.abs(U_x)\n    U_y /= np.abs(U_y)\n\n    # 4. Compute plaquette flux\n    U_y_x_shifted = np.roll(U_y, -1, axis=1)\n    U_x_y_shifted = np.roll(U_x, -1, axis=0)\n    \n    # Plaquette product: U_x(k) * U_y(k+dk_x) * U_x(k+dk_y)^-1 * U_y(k)^-1\n    plaquette_prod = U_x * U_y_x_shifted * np.conj(U_x_y_shifted) * np.conj(U_y)\n\n    # 5. Calculate Berry curvature and sum to get Chern number\n    # F_xy = arg(plaquette_prod)\n    berry_curvature = np.angle(plaquette_prod)\n    \n    chern_number = np.sum(berry_curvature) / (2 * np.pi)\n    \n    return chern_number\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and format output.\n    \"\"\"\n    problem_params = [\n        {'mu': -2.0, 'Nk_meshes': [11, 21, 41]},\n        {'mu': 2.0, 'Nk_meshes': [11, 21, 41]},\n        {'mu': 5.0, 'Nk_meshes': [11, 21, 41]},\n    ]\n    \n    t = 1.0\n    delta = 1.0\n    convergence_threshold = 1.0e-3\n    \n    results = []\n    \n    for params in problem_params:\n        mu = params['mu']\n        meshes = params['Nk_meshes']\n        \n        # Compute Chern numbers for the three mesh sizes\n        c_vals = [compute_chern(t, mu, delta, Nk) for Nk in meshes]\n        C1, C2, C3 = c_vals[0], c_vals[1], c_vals[2]\n        \n        # Check for convergence\n        converged = (abs(C2 - C1) < convergence_threshold) and \\\n                    (abs(C3 - C2) < convergence_threshold)\n        \n        # Round the finest mesh result to the nearest integer\n        # Python's round() rounds .5 to the nearest even integer, which is fine here.\n        C_int = int(round(C3))\n        \n        results.append([C_int, converged])\n\n    # Format the final output string exactly as required\n    output_str = '[' + ','.join([f'[{c},{str(b).lower()}]' for c, b in results]) + ']'\n    print(output_str)\n\nsolve()\n```", "id": "2869469"}]}