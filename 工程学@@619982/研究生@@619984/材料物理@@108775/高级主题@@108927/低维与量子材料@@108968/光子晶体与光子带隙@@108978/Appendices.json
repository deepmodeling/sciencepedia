{"hands_on_practices": [{"introduction": "当光波的波长远大于光子晶体的周期时，我们如何描述这种复杂周期性结构的光学行为？这个练习将引导你运用有效介质理论，将异质结构近似为一个均匀的各向异性介质。通过推导有效折射率的二阶修正项，你将深入理解均匀化这一在超材料和光子学中极为强大的概念，并揭示人工色散的物理起源。[@problem_id:2850161]", "problem": "一维光子晶体由两种非磁性电介质层周期性堆叠而成，其标量相对介电常数分别为 $\\varepsilon_{1}$ 和 $\\varepsilon_{2}$，厚度分别为 $d_{1}$ 和 $d_{2}$，周期为 $a = d_{1} + d_{2}$。该结构在堆叠方向 $z$ 上是无限的，在横向方向上是均匀的。一束单色平面波以角频率 $\\omega$、真空光速 $c$ 和 Bloch 波数 $k_{B}(\\omega)$ 沿 $z$ 方向垂直入射传播。假设电介质是各向同性、无损的，并且满足亚波长（均匀化）条件 $|\\omega| a / c \\ll 1$。\n\n从频域中的无源宏观 Maxwell 方程组、每个界面上切向场的边界条件以及周期性介质的 Bloch 定理出发，推导 Bloch 色散的长波长展开，并通过 $k_{B}(\\omega) = (\\omega/c)\\, n_{\\mathrm{eff}}(\\omega)$ 定义有效折射率 $n_{\\mathrm{eff}}(\\omega)$。证明该展开具有如下结构\n$$\nn_{\\mathrm{eff}}^{2}(\\omega) \\;=\\; \\varepsilon_{\\parallel} \\;+\\; \\alpha \\left(\\frac{\\omega a}{c}\\right)^{2} \\;+\\; \\mathcal{O}\\!\\left(\\left(\\frac{\\omega a}{c}\\right)^{4}\\right),\n$$\n其中 $\\varepsilon_{\\parallel} \\equiv f\\,\\varepsilon_{1} + (1-f)\\,\\varepsilon_{2}$ 是算术（面内）平均介电常数，填充因子为 $f \\equiv d_{1}/a$。\n\n确定系数 $\\alpha$ 关于 $\\varepsilon_{1}$、$\\varepsilon_{2}$ 和 $f$ 的闭式解析表达式。你的最终答案必须是 $\\alpha$ 作为 $\\varepsilon_{1}$、$\\varepsilon_{2}$ 和 $f$ 的函数的唯一显式表达式。不需要进行数值计算。", "solution": "首先对用户提供的问题进行严格的验证过程。\n\n**步骤 1：提取已知条件**\n\n-   系统：一维光子晶体，由两种非磁性电介质层周期性堆叠而成。\n-   堆叠方向：$z$。\n-   层 1 属性：相对介电常数 $\\varepsilon_{1}$，厚度 $d_{1}$。\n-   层 2 属性：相对介电常数 $\\varepsilon_{2}$，厚度 $d_{2}$。\n-   周期：$a = d_{1} + d_{2}$。\n-   波的属性：单色平面波，垂直入射（沿 $z$ 传播），角频率 $\\omega$。\n-   常数：真空光速 $c$。\n-   Bloch 波数：$k_{B}(\\omega)$。\n-   假设：各向同性、无损、非磁性电介质。亚波长（均匀化）条件 $|\\omega| a / c \\ll 1$。\n-   目标关系：由 $k_{B}(\\omega) = (\\omega/c)\\, n_{\\mathrm{eff}}(\\omega)$ 定义的有效折射率 $n_{\\mathrm{eff}}(\\omega)$。\n-   目标展开结构：$n_{\\mathrm{eff}}^{2}(\\omega) = \\varepsilon_{\\parallel} + \\alpha \\left(\\frac{\\omega a}{c}\\right)^{2} + \\mathcal{O}\\!\\left(\\left(\\frac{\\omega a}{c}\\right)^{4}\\right)$。\n-   定义：填充因子 $f \\equiv d_{1}/a$，算术平均介电常数 $\\varepsilon_{\\parallel} \\equiv f\\,\\varepsilon_{1} + (1-f)\\,\\varepsilon_{2}$。\n-   目标：确定系数 $\\alpha$ 关于 $\\varepsilon_{1}$、$\\varepsilon_{2}$ 和 $f$ 的闭式解析表达式。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题基于周期性介质（光子晶体）中电磁学的基本原理，由 Maxwell 方程组和 Bloch 定理支配。均匀化极限是超材料和有效介质理论中的一个标准且具有物理意义的范畴。该问题在科学上是合理的。\n-   **适定性**：该问题要求推导微扰展开中的一个特定系数。设置清晰，预期存在唯一解。\n-   **客观性**：语言精确、技术性强，没有主观或含糊的陈述。\n-   **完整性**：所有必要的参数（$\\varepsilon_{1}, \\varepsilon_{2}, d_{1}, d_{2}$）和条件（垂直入射、长波长极限）都已提供。该问题是自洽的。\n-   **一致性与可行性**：该问题没有矛盾之处。所给条件描述了一个可以通过实验实现的标准物理系统。\n\n**步骤 3：结论与行动**\n\n该问题是**有效的**。这是一个凝聚态物理/光子学领域的标准、适定问题。我现在将开始推导。\n\n单色平面波在一维非磁性电介质中沿 z 轴垂直入射的传播由标量波动方程控制，该方程源自 Maxwell 方程组。对于沿 x 方向偏振的电场 $E_x(z)$，方程为：\n$$\n\\frac{d^2 E_x(z)}{dz^2} + \\left(\\frac{\\omega}{c}\\right)^2 \\varepsilon(z) E_x(z) = 0\n$$\n其中 $k_0 = \\omega/c$ 是真空波数，$\\varepsilon(z)$ 是空间变化的相对介电常数。函数 $\\varepsilon(z)$ 是周期函数，周期为 $a$，即 $\\varepsilon(z+a) = \\varepsilon(z)$。\n\n根据 Bloch 定理，这个带有周期系数的微分方程的解必须具有 $E_x(z) = u(z) e^{i k_B z}$ 的形式，其中 $u(z)$ 是一个与介质周期相同的周期函数，即 $u(z+a) = u(z)$，而 $k_B$ 是 Bloch 波数。\n\n解决这个问题的一个强大方法是平面波展开。场的周期部分 $u(z)$ 和周期性介电常数 $\\varepsilon(z)$ 都可以展开成 Fourier 级数：\n$$\nE_x(z) = \\sum_{m=-\\infty}^{\\infty} A_m e^{i(k_B + \\frac{2\\pi m}{a})z}\n$$\n$$\n\\varepsilon(z) = \\sum_{n=-\\infty}^{\\infty} \\epsilon_n e^{i \\frac{2\\pi n}{a} z}\n$$\n介电常数分布的 Fourier 系数 $\\epsilon_n$ 由下式给出：\n$$\n\\epsilon_n = \\frac{1}{a} \\int_0^a \\varepsilon(z') e^{-i \\frac{2\\pi n}{a} z'} dz'\n$$\n对于 $n=0$，我们得到介电常数的空间平均值：\n$$\n\\epsilon_0 = \\frac{1}{a} \\left( \\int_0^{d_1} \\varepsilon_1 dz' + \\int_{d_1}^{a} \\varepsilon_2 dz' \\right) = \\frac{\\varepsilon_1 d_1 + \\varepsilon_2 d_2}{a} = f \\varepsilon_1 + (1-f) \\varepsilon_2 = \\varepsilon_{\\parallel}\n$$\n对于 $n \\neq 0$：\n$$\n\\epsilon_n = \\frac{1}{a} \\left( \\varepsilon_1 \\int_0^{d_1} e^{-i \\frac{2\\pi n z'}{a}} dz' + \\varepsilon_2 \\int_{d_1}^{a} e^{-i \\frac{2\\pi n z'}{a}} dz' \\right)\n$$\n$$\n\\epsilon_n = \\frac{1}{a} \\left[ \\varepsilon_1 \\frac{a}{-i 2\\pi n} \\left(e^{-i 2\\pi n f} - 1\\right) + \\varepsilon_2 \\frac{a}{-i 2\\pi n} \\left(e^{-i 2\\pi n} - e^{-i 2\\pi n f}\\right) \\right]\n$$\n由于 $e^{-i 2\\pi n} = 1$:\n$$\n\\epsilon_n = \\frac{i}{2\\pi n} \\left[ \\varepsilon_1(1 - e^{-i 2\\pi n f}) - \\varepsilon_2(1 - e^{-i 2\\pi n f}) \\right] = \\frac{i(\\varepsilon_1 - \\varepsilon_2)}{2\\pi n} (1 - e^{-i 2\\pi n f})\n$$\n注意 $\\epsilon_{-n} = \\epsilon_n^*$，其中 $*$ 表示复共轭。\n\n将 $E_x(z)$ 和 $\\varepsilon(z)$ 的 Fourier 展开代入波动方程，得到关于系数 $A_m$ 的一个无限耦合代数方程组：\n$$\n-\\left(k_B + \\frac{2\\pi m}{a}\\right)^2 A_m + k_0^2 \\sum_{n=-\\infty}^{\\infty} \\epsilon_{m-n} A_n = 0\n$$\n在长波长极限下，$k_0 a = \\frac{\\omega a}{c} \\ll 1$，我们可以使用微扰理论来处理这个系统。Bloch 波数 $k_B$ 也会很小。未受微扰的解对应于介电常数为 $\\epsilon_0 = \\varepsilon_\\parallel$ 的均匀介质。这对应于只保留 $m=0$ 的项：\n$$\n-k_B^2 A_0 + k_0^2 \\epsilon_0 A_0 = 0 \\implies k_B^2 = k_0^2 \\epsilon_0\n$$\n使用定义 $k_B = k_0 n_{\\mathrm{eff}}$，我们发现 $n_{\\mathrm{eff}}^2 = \\epsilon_0 = \\varepsilon_\\parallel$。这是零阶近似。\n\n为了找到下一阶修正，我们考虑 $m \\neq 0$ 的方程。在长波长极限下，$k_B \\ll \\frac{2\\pi m}{a}$，项 $A_m$ 与 $A_0$ 相比会很小。对于 $m \\neq 0$ 的方程可以近似为：\n$$\n-\\left(\\frac{2\\pi m}{a}\\right)^2 A_m + k_0^2 \\epsilon_m A_0 \\approx 0\n$$\n这给出了 $m \\neq 0$ 时振幅 $A_m$ 的一阶修正：\n$$\nA_m \\approx \\frac{k_0^2 \\epsilon_m}{(\\frac{2\\pi m}{a})^2} A_0 = \\frac{(k_0 a)^2}{4\\pi^2 m^2} \\epsilon_m A_0\n$$\n现在，我们将其代回到 $m=0$ 的方程中：\n$$\n-k_B^2 A_0 + k_0^2 \\left( \\epsilon_0 A_0 + \\sum_{n \\neq 0} \\epsilon_{-n} A_n \\right) = 0\n$$\n除以 $A_0$ 并代入 $A_n$ 的表达式：\n$$\nk_B^2 = k_0^2 \\left( \\epsilon_0 + \\sum_{n \\neq 0} \\epsilon_{-n} \\frac{(k_0 a)^2}{4\\pi^2 n^2} \\epsilon_n \\right) = k_0^2 \\epsilon_0 + (k_0 a)^2 k_0^2 \\sum_{n \\neq 0} \\frac{|\\epsilon_n|^2}{4\\pi^2 n^2}\n$$\n我们有 $n_{\\mathrm{eff}}^2 = k_B^2 / k_0^2$。与目标形式 $n_{\\mathrm{eff}}^{2}(\\omega) = \\varepsilon_{\\parallel} + \\alpha (k_0 a)^2 + \\mathcal{O}((k_0 a)^4)$ 进行比较，我们可以确定系数 $\\alpha$为：\n$$\n\\alpha = \\sum_{n \\neq 0} \\frac{|\\epsilon_n|^2}{4\\pi^2 n^2}\n$$\n让我们计算 $|\\epsilon_n|^2$：\n$$\n|\\epsilon_n|^2 = \\left| \\frac{i(\\varepsilon_1 - \\varepsilon_2)}{2\\pi n} (1 - e^{-i 2\\pi n f}) \\right|^2 = \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{4\\pi^2 n^2} |1 - \\cos(2\\pi nf) + i\\sin(2\\pi nf)|^2\n$$\n$$\n|\\epsilon_n|^2 = \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{4\\pi^2 n^2} \\left( (1-\\cos(2\\pi nf))^2 + \\sin^2(2\\pi nf) \\right) = \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{4\\pi^2 n^2} (2 - 2\\cos(2\\pi nf))\n$$\n使用恒等式 $1 - \\cos(2x) = 2\\sin^2(x)$，我们得到：\n$$\n|\\epsilon_n|^2 = \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{4\\pi^2 n^2} \\left( 4\\sin^2(\\pi nf) \\right) = \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{\\pi^2 n^2} \\sin^2(\\pi nf)\n$$\n现在，将此代入 $\\alpha$ 的表达式中：\n$$\n\\alpha = \\sum_{n \\neq 0} \\frac{1}{4\\pi^2 n^2} \\left( \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{\\pi^2 n^2} \\sin^2(\\pi nf) \\right) = \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{4\\pi^4} \\sum_{n \\neq 0} \\frac{\\sin^2(\\pi nf)}{n^4}\n$$\n该求和可以写成 $2 \\sum_{n=1}^{\\infty} \\frac{\\sin^2(\\pi nf)}{n^4}$。我们可以利用傅里叶级数理论来计算这个和。使用恒等式 $\\sin^2(\\theta) = \\frac{1}{2}(1 - \\cos(2\\theta))$，级数变为：\n$$ \\sum_{n=1}^{\\infty} \\frac{\\sin^2(\\pi nf)}{n^4} = \\frac{1}{2} \\sum_{n=1}^{\\infty} \\frac{1}{n^4} - \\frac{1}{2} \\sum_{n=1}^{\\infty} \\frac{\\cos(2\\pi nf)}{n^4} $$\n其中第一项是黎曼zeta函数 $\\zeta(4) = \\frac{\\pi^4}{90}$。第二项的级数和可以从四阶伯努利多项式 $B_4(f) = f^4 - 2f^3 + f^2 - \\frac{1}{30}$ 的傅里叶级数展开得到，对于 $0 < f < 1$：\n$$ \\sum_{n=1}^{\\infty} \\frac{\\cos(2\\pi n f)}{n^4} = (-1)^{2-1} \\frac{(2\\pi)^4}{2(4!)} B_4(f) = -\\frac{16\\pi^4}{48} B_4(f) = -\\frac{\\pi^4}{3} \\left( f^2(1-f)^2 - \\frac{1}{30} \\right) $$\n将这两部分代入，我们得到：\n$$ \\sum_{n=1}^{\\infty} \\frac{\\sin^2(\\pi nf)}{n^4} = \\frac{1}{2} \\left( \\frac{\\pi^4}{90} \\right) - \\frac{1}{2} \\left[ -\\frac{\\pi^4}{3} \\left( f^2(1-f)^2 - \\frac{1}{30} \\right) \\right] = \\frac{\\pi^4}{180} + \\frac{\\pi^4}{6} f^2(1-f)^2 - \\frac{\\pi^4}{180} = \\frac{\\pi^4}{6} f^2(1-f)^2 $$\n所以，$\\sum_{n \\neq 0} \\frac{\\sin^2(\\pi nf)}{n^4} = 2 \\times \\frac{\\pi^4}{6} f^2(1-f)^2 = \\frac{\\pi^4}{3} f^2(1-f)^2$。\n\n最后，我们将此和代回 $\\alpha$ 的表达式中：\n$$\n\\alpha = \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{4\\pi^4} \\left( \\frac{\\pi^4}{3} f^2(1-f)^2 \\right) = \\frac{1}{12} (\\varepsilon_1 - \\varepsilon_2)^2 f^2 (1-f)^2\n$$\n这就是系数 $\\alpha$ 的闭式解析表达式。", "answer": "$$\\boxed{\\frac{1}{12} f^2 (1-f)^2 (\\varepsilon_1 - \\varepsilon_2)^2}$$", "id": "2850161"}, {"introduction": "我们如何通过数值计算来精确模拟光与半无限光子晶体之间的相互作用？本练习将指导你实现传输矩阵法（TMM），这是光子器件模拟的核心计算工具。通过将传输矩阵法与布洛赫定理相结合，你将学会如何为半无限结构施加正确的辐射边界条件，从而区分传播模式与倏逝模式，这是分析任何波导系统都必须掌握的基本技能。[@problem_id:2850217]", "problem": "考虑一个一维无损介质光子晶体，它由两种均匀、各向同性、非磁性层（标记为 A 和 B）周期性堆叠而成，其折射率分别为 $n_{\\mathrm{A}}$ 和 $n_{\\mathrm{B}}$，厚度分别为 $d_{\\mathrm{A}}$ 和 $d_{\\mathrm{B}}$。周期为 $a = d_{\\mathrm{A}} + d_{\\mathrm{B}}$。该结构占据 $x \\ge 0$ 的空间，一束角频率为 $\\omega$ 的时间谐波平面波从占据 $x < 0$ 且折射率为 $n_{\\mathrm{in}}$ 的均匀半无限入射介质中正入射到该结构上。采用 $\\exp(-i \\omega t)$ 的时间依赖关系，并假设为非磁性介质，其相对磁导率等于 $1$。三角函数中的所有角度均须以弧度为单位。使用无量纲归一化，使得长度以 $a$ 为单位表示，并定义无量纲频率 $u = \\omega a / c$，其中 $c$ 是真空中的光速。\n\n仅从无源、分段均匀介质中的麦克斯韦方程组、界面处切向电场和磁场的连续性条件，以及周期性结构的布洛赫定理出发，推导一个算法，用以计算在以下辐射边界条件下，当半无限周期晶体被入射平面波激发时，在 $x=0$ 处的功率反射率 $R$：在周期晶体内部，只允许存在沿 $+x$ 方向传输功率的布洛赫解（如果存在传播的布洛赫模式），或当 $x \\to +\\infty$ 时衰减的布洛赫解（如果不存在传播的布洛赫模式）。您的推导必须明确地构建晶胞的传输矩阵，提取布洛赫本征值和本征矢量，利用辐射边界条件选择物理的布洛赫模式，计算界面处的布洛赫模式有效导纳，并通过匹配场来确定反射系数。最终需要计算的量是功率反射率 $R = |r|^2$，其中 $r$ 是复振幅反射系数。\n\n将您的推导实现为一个程序，对于每个指定的测试用例，计算在正入射情况下 $x = 0$ 处的单程功率反射率 $R$。状态必须用位于界面 $x=0$ 右侧（即 A 层的起始处）参考平面上的切向电场 $E$ 和切向磁场 $H$ 来表示。每层的传播必须用一个 $2 \\times 2$ 传输（特性）矩阵来表示，该矩阵通过求解每层中的齐次亥姆霍兹方程并强制满足界面处的场连续性条件而获得。布洛赫条件是晶胞传输矩阵 $\\mathbf{M}_{\\text{cell}}$ 的本征问题，其本征值为 $\\lambda = \\exp(i k_{\\mathrm{B}} a)$（其中 $k_{\\mathrm{B}}$ 是布洛赫波数），本征矢量为在所选参考平面上定义的 $\\mathbf{v} = (E, H)^{\\mathsf{T}}$。\n\n为保证数值稳定性，在为给定的无量纲频率 $u$ 选择物理布洛赫本征矢量 $\\mathbf{v}$ 时，请强制执行以下规则：\n- 如果两个布洛赫乘子都满足 $|\\lambda| - 1|$ 的绝对值小于一个微小的容差（通带），则选择其时间平均的沿 $x$ 方向的坡印亭通量密度（与 $\\operatorname{Re}\\{E H^*\\}$ 成正比）为正的本征矢量（功率流入 $+x$ 方向）。\n- 否则（禁带），选择 $|\\lambda| < 1$ 的本征矢量（向 $+x$ 方向衰减）。\n\n然后，根据所选的本征矢量计算在 $x = 0^+$ 处的布洛赫模式有效导纳 $Y_{\\mathrm{B}} = H/E$，并通过与入射介质总场（入射场+反射场）进行匹配，利用切向场连续性，得到在 $x = 0$ 处的振幅反射系数。在所述归一化条件下，入射介质的导纳为 $Y_{\\mathrm{in}} = n_{\\mathrm{in}}$。最后，返回反射率 $R = |r|^2$（一个实数）。\n\n在所有测试用例中使用以下固定参数：\n- $n_{\\mathrm{A}} = 1.0$，\n- $n_{\\mathrm{B}} = 3.4$，\n- $n_{\\mathrm{in}} = 1.0$，\n- $d_{\\mathrm{A}}$ 和 $d_{\\mathrm{B}}$ 的选择需满足 $n_{\\mathrm{A}} d_{\\mathrm{A}} = n_{\\mathrm{B}} d_{\\mathrm{B}}$ 和 $d_{\\mathrm{A}} + d_{\\mathrm{B}} = 1$（即，在所选单位下，光学厚度相等且一个周期 $a = 1$）。\n\n通过以下无量纲频率 $u$ 的列表定义三个测试用例：\n- 测试用例 1（通带，“理想路径”）：$u = 0.5\\, u_0$，\n- 测试用例 2（在第一个禁带中心）：$u = u_0$，\n- 测试用例 3（较高频率的通带）：$u = 1.5\\, u_0$，\n其中 $u_0$ 是对应于上述相等光学厚度条件的带隙中心（布拉格）归一化频率。所有计算必须使用弧度作为相位的单位。您的程序必须在所述归一化条件下，根据给定的 $n_{\\mathrm{A}}$、$n_{\\mathrm{B}}$、$d_{\\mathrm{A}}$ 和 $d_{\\mathrm{B}}$ 计算出 $u_0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[r1,r2,r3]”），列表中的每个条目是按上文所列顺序的相应测试用例的浮点值 $R$。除了这个确切的单行格式外，不得有任何额外的字符或空格。所有输出都是无量纲的实数（无物理单位），并应以标准十进制表示法打印。", "solution": "该问题要求推导并实现一个算法，用以计算来自半无限一维光子晶体的功率反射率。这将通过遵循传输矩阵法、应用布洛赫定理以及在边界处匹配场来完成。\n\n首先，我们从无源（$\\rho=0, \\mathbf{J}=0$）、各向同性、非磁性（$\\mu=\\mu_0$）、折射率为 $n$ 的介电介质中的麦克斯韦方程组开始：\n$$ \\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t} = i\\omega\\mu_0\\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t} = -i\\omega\\epsilon\\mathbf{E} = -i\\omega n^2 \\epsilon_0\\mathbf{E} $$\n我们采用了 $\\exp(-i\\omega t)$ 的时间谐波约定。对于沿 $x$ 轴传播、电场沿 $y$ 方向极化（$\\mathbf{E} = E(x)\\hat{y}$）、磁场沿 $z$ 方向极化（$\\mathbf{H} = H(x)\\hat{z}$）的正入射平面波，麦克斯韦方程组简化为一组常微分方程：\n$$ \\frac{dE}{dx} = -i\\omega\\mu_0 H $$\n$$ \\frac{dH}{dx} = -i\\omega n^2 \\epsilon_0 E $$\n合并这两个方程，我们得到一维亥姆霍兹方程：\n$$ \\frac{d^2 E}{dx^2} + \\left(\\frac{\\omega n}{c}\\right)^2 E = 0 $$\n其中 $c = 1/\\sqrt{\\epsilon_0 \\mu_0}$ 是真空中的光速。\n\n问题定义了一个无量纲频率 $u = \\omega a / c$，其中 $a$ 是晶体的周期。用 $a$ 归一化长度意味着在这些单位中 $a=1$。此外，我们采用一个单位制，其中 $c=1$ 且自由空间阻抗 $Z_0 = \\sqrt{\\mu_0/\\epsilon_0} = 1$。在这些单位中，折射率为 $n$ 的介质中的波数为 $k = \\omega n = u n$，特性导纳为 $Y=n$。控制方程变为：\n$$ \\frac{dE}{dx} = -i u H $$\n$$ \\frac{dH}{dx} = -i u n^2 E $$\n在厚度为 $d$、折射率为 $n$ 的均匀层中，亥姆霍兹方程的解可以用一个传输矩阵 $\\mathbf{M}$ 表示，该矩阵将 $x$ 处的场与 $x=0$ 处的场联系起来：$\\begin{pmatrix} E(x) \\\\ H(x) \\end{pmatrix} = \\mathbf{M}(x) \\begin{pmatrix} E(0) \\\\ H(0) \\end{pmatrix}$。厚度为 $d$ 的层的传输矩阵为：\n$$ \\mathbf{M}_{\\text{layer}}(d, n, u) = \\begin{pmatrix} \\cos(und) & i \\frac{1}{n} \\sin(und) \\\\ i n \\sin(und) & \\cos(und) \\end{pmatrix} $$\n光子晶体的晶胞由从 $x=0$ 开始的 A 和 B 两层组成。整个晶胞的传输矩阵 $\\mathbf{M}_{\\text{cell}}$ 是各层矩阵的乘积：\n$$ \\mathbf{M}_{\\text{cell}} = \\mathbf{M}_{\\text{B}} \\mathbf{M}_{\\text{A}} $$\n其中 $\\mathbf{M}_{\\text{A}}$ 和 $\\mathbf{M}_{\\text{B}}$ 分别是厚度为 $d_{\\mathrm{A}}$、$d_{\\mathrm{B}}$、折射率为 $n_{\\mathrm{A}}$、$n_{\\mathrm{B}}$ 的 A 层和 B 层的传输矩阵。\n\n根据布洛赫定理，对于周期性势场，解必须具有 $\\mathbf{v}(x+a) = \\lambda \\mathbf{v}(x)$ 的形式，其中 $\\mathbf{v}(x) = (E(x), H(x))^{\\mathsf{T}}$ 是场矢量，$\\lambda = \\exp(ik_{\\mathrm{B}}a)$ 是布洛赫乘子，$k_{\\mathrm{B}}$ 是布洛赫波数。由于一个晶胞起点的场矢量通过 $\\mathbf{M}_{\\text{cell}}$ 映射到终点的场矢量，因此在晶胞边界处允许的场构型是 $\\mathbf{M}_{\\text{cell}}$ 的本征矢量：\n$$ \\mathbf{M}_{\\text{cell}} \\mathbf{v} = \\lambda \\mathbf{v} $$\n本征值 $\\lambda$ 由特征方程 $\\det(\\mathbf{M}_{\\text{cell}} - \\lambda \\mathbf{I}) = 0$ 求得。由于 $\\det(\\mathbf{M}_{\\text{cell}})=1$（无损系统的性质），该方程为 $\\lambda^2 - \\text{Tr}(\\mathbf{M}_{\\text{cell}}) \\lambda + 1 = 0$。其解为 $\\lambda_{1,2} = \\frac{T \\pm \\sqrt{T^2-4}}{2}$，其中 $T = \\text{Tr}(\\mathbf{M}_{\\text{cell}})$。\n- 如果 $|T/2| \\le 1$，本征值是模为单位的复共轭对，$\\lambda = \\exp(\\pm i k_{\\mathrm{B}} a)$。这对应于传播的布洛赫模式（通带）。\n- 如果 $|T/2| > 1$，本征值是实数，其中一个满足 $|\\lambda| > 1$（增长模式），另一个满足 $|\\lambda| < 1$（衰减模式）。这对应于倏逝模式（禁带）。\n\n问题指定了一个位于 $x \\ge 0$ 的半无限晶体。晶体内部的物理场解必须是满足辐射边界条件的单个布洛赫模式：它必须要么将功率带离界面（进入晶体，即 $+x$ 方向），要么在 $x \\to \\infty$ 时衰减为零。\n- 在通带中，我们选择对应于正的时间平均坡印亭通量 $S_x = \\frac{1}{2}\\operatorname{Re}\\{E_{\\mathrm{B}} H_{\\mathrm{B}}^*\\} > 0$ 的本征矢量 $\\mathbf{v}_{\\mathrm{B}} = (E_{\\mathrm{B}}, H_{\\mathrm{B}})^{\\mathsf{T}}$。\n- 在禁带中，我们选择对应于模 $|\\lambda| < 1$ 的本征值的本征矢量。\n\n一旦在界面 $x=0^+$ 处确定了物理的布洛赫模式本征矢量 $\\mathbf{v}_{\\mathrm{B}}$，我们就计算其有效导纳 $Y_{\\mathrm{B}} = H_{\\mathrm{B}} / E_{\\mathrm{B}}$。对于入射介质（$x < 0$），场是入射和反射平面波的叠加。在 $x=0^-$ 处的总导纳为 $Y(0^-) = Y_{\\mathrm{in}} \\frac{1-r}{1+r}$，其中 $r$ 是振幅反射系数，$Y_{\\mathrm{in}} = n_{\\mathrm{in}}$ 是入射介质的导纳。\n在 $x=0$ 处切向场的连续性意味着 $Y(0^-) = Y(0^+) = Y_{\\mathrm{B}}$。因此，我们可以求解反射系数：\n$$ r = \\frac{Y_{\\mathrm{in}} - Y_{\\mathrm{B}}}{Y_{\\mathrm{in}} + Y_{\\mathrm{B}}} $$\n功率反射率则为 $R = |r|^2$。\n\n四分之一波长堆叠的具体参数是 $n_{\\mathrm{A}}=1.0$，$n_{\\mathrm{B}}=3.4$，$n_{\\mathrm{in}}=1.0$，$a=1$，以及 $n_{\\mathrm{A}}d_{\\mathrm{A}} = n_{\\mathrm{B}}d_{\\mathrm{B}}$。根据 $d_{\\mathrm{A}}+d_{\\mathrm{B}}=a=1$，我们得到 $d_{\\mathrm{A}} = n_{\\mathrm{B}}/(n_{\\mathrm{A}}+n_{\\mathrm{B}})$ 和 $d_{\\mathrm{B}} = n_{\\mathrm{A}}/(n_{\\mathrm{A}}+n_{\\mathrm{B}})$。带隙中心频率 $u_0$ 对应于每层光学厚度为四分之一波长的条件，即相移为 $\\pi/2$。因此，$u_0 n_{\\mathrm{A}} d_{\\mathrm{A}} = \\pi/2$，这给出 $u_0 = \\frac{\\pi (n_{\\mathrm{A}}+n_{\\mathrm{B}})}{2n_{\\mathrm{A}}n_{\\mathrm{B}}}$。\n\n算法流程如下：\n1.  计算 $d_{\\mathrm{A}}$、$d_{\\mathrm{B}}$ 和 $u_0$。\n2.  对于每个测试频率 $u$：\n    a. 构建 $\\mathbf{M}_{\\text{A}}$ 和 $\\mathbf{M}_{\\text{B}}$，并计算 $\\mathbf{M}_{\\text{cell}} = \\mathbf{M}_{\\text{B}}\\mathbf{M}_{\\text{A}}$。\n    b. 计算迹 $T$。\n    c. 如果在禁带中（$|T/2| > 1$，如 $u=u_0$ 时），选择本征值 $|\\lambda|<1$。对于在 $u_0$ 处的四分之一波长堆叠，矩阵 $\\mathbf{M}_{\\text{cell}}$ 是对角阵，导致衰减模式的本征矢量为 $(1,0)^{\\mathsf{T}}$，布洛赫导纳 $Y_{\\mathrm{B}}=0$。\n    d. 如果在通带中（$|T/2| \\le 1$，如 $u=0.5u_0, 1.5u_0$ 时），找到两个本征值。选择对应于前向功率流的一个。这个选择取决于矩阵元素 $M_{12}$ 虚部的符号。布洛赫导纳为 $Y_{\\mathrm{B}} = (\\lambda_{\\text{fwd}} - M_{11}) / M_{12}$。\n    e. 计算 $r = (n_{\\mathrm{in}} - Y_{\\mathrm{B}}) / (n_{\\mathrm{in}} + Y_{\\mathrm{B}})$ 和 $R = |r|^2$。\n\n此过程在以下程序中实现。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the reflectance of a semi-infinite 1D photonic crystal.\n    \"\"\"\n    # Fixed parameters from problem statement\n    n_A = 1.0\n    n_B = 3.4\n    n_in = 1.0\n    \n    # In normalized units, period a = 1.\n    # d_A + d_B = 1 and n_A * d_A = n_B * d_B\n    d_A = n_B / (n_A + n_B)\n    d_B = n_A / (n_A + n_B)\n\n    # Midgap (Bragg) normalized frequency for the quarter-wave stack\n    # This comes from the condition that phase thickness u0 * nA * dA = pi/2\n    u0 = np.pi / (2 * n_A * d_A)\n    \n    test_frequencies = [0.5 * u0, u0, 1.5 * u0]\n    \n    results = []\n    \n    for u in test_frequencies:\n        # Phase thickness in each layer. Due to the quarter-wave condition,\n        # phi_A = u * n_A * d_A and phi_B = u * n_B * d_B are equal.\n        phi = u * n_A * d_A\n        \n        c, s = np.cos(phi), np.sin(phi)\n        \n        # Check for special case: center of a stop band, where c = cos(pi/2) = 0\n        if np.isclose(c, 0.0):\n            # This is the center of the Bragg stopgap. M_cell is diagonal.\n            # Eigenvalues are -n_A/n_B and -n_B/n_A.\n            # The decaying mode corresponds to eigenvalue with magnitude < 1,\n            # which is -n_A/n_B. Its eigenvector is (1, 0)^T.\n            # Bloch admittance Y_B = H/E = 0.\n            Y_B = 0.0\n        else:\n            # General case (pass band for the given test frequencies)\n            M11 = c**2 - (n_A / n_B) * s**2\n            M22 = c**2 - (n_B / n_A) * s**2\n            M12 = 1j * s * c * (1/n_A + 1/n_B)\n            \n            T = M11 + M22\n            \n            # For a pass band, |T/2| <= 1.\n            gamma_sqrt = np.sqrt(4.0 - T**2)\n\n            # Select the forward-propagating Bloch mode.\n            # Poynting flux is proportional to Re(E H*).\n            # For eigenvector choice v=(M12, lambda-M11), S_x ~ Re(M12 * (lambda*-M11)).\n            # The sign of this depends on the sign of Im(M12) which is sign(s*c).\n            # We must select lambda to make the flux positive.\n            if s * c > 0:\n                lambda_fwd = (T + 1j * gamma_sqrt) / 2.0\n            else:\n                lambda_fwd = (T - 1j * gamma_sqrt) / 2.0\n\n            # Bloch admittance Y_B = H_B / E_B\n            Y_B = (lambda_fwd - M11) / M12\n\n        # Reflection coefficient at the interface x=0\n        r = (n_in - Y_B) / (n_in + Y_B)\n        \n        # Power reflectance R = |r|^2\n        R = np.abs(r)**2\n        results.append(R)\n        \n    # Format the output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2850217"}, {"introduction": "光子晶体的带边具有一些独特的性质，例如近乎为零的群速度，即所谓的“慢光”效应。这种现象如何影响光子晶体与其他光学元件（如谐振腔）的相互作用？这个练习将通过耦合模式理论（CMT），让你探索群速度 $v_g$、光学态密度和耦合速率之间的深刻联系，并最终推导出实现临界耦合的条件。通过这个练习，你将学会如何利用光子晶体独特的色散特性来设计和调控光与物质的相互作用，这是现代光子学设计的基石。[@problem_id:2850209]", "problem": "一个一维光子晶体波导在其上能带边（波矢为 $k_{b}=\\pi/a$，频率为 $\\omega_{b}$）附近支持单个布洛赫模式。在能带边附近，其色散关系可以很好地用二次形式 $\\omega(k)=\\omega_{b}+A\\,(k-k_{b})^{2}$（其中 $A>0$）来近似。一个谐振频率为 $\\omega_{0}$ 的单模局域谐振器通过一个点侧向耦合到该波导，并表现出本征（非辐射）能量衰减率 $\\gamma_{i}$，$\\gamma_{i}$ 以角频率单位表示。谐振器与布洛赫模式之间的耦合由一个空间局域的短程微扰所决定。\n\n从麦克斯韦方程组和周期性介质的布洛赫定理出发，并利用费米黄金定则将向一维连续谱的外部（辐射）衰减率与连续谱的态密度联系起来，论证外部衰减率 $\\gamma_{e}(\\omega)$ 与群速度成反比，即 $\\gamma_{e}(\\omega)\\propto 1/v_{g}(\\omega)$，其中 $v_{g}(\\omega)=\\mathrm{d}\\omega/\\mathrm{d}k$。引入一个正常数比例常数 $\\beta$，该常数包含了谐振器-波导的交叠和归一化，使得 $\\gamma_{e}(\\omega)=\\beta/v_{g}(\\omega)$。\n\n对于波导是半无限长且谐振器作为唯一终端（因此没有传输端口）的单端口配置，使用时间耦合模理论 (TCMT) 推导谐振时的反射振幅以及临界耦合的条件（此处定义为在 $\\omega=\\omega_{0}$ 时反射为零）。然后，利用能带边色散关系将 $v_{g}(\\omega)$ 表示为失谐量 $\\Delta\\equiv \\omega-\\omega_{b}$ 的函数，确定当谐振器调谐至工作频率 $\\omega=\\omega_{0}=\\omega_{b}+\\Delta_{c}$ 时，实现临界耦合所需的相对于能带边的失谐量 $\\Delta_{c}$。\n\n将最终答案表示为 $\\Delta_{c}$ 关于 $A$、$\\beta$ 和 $\\gamma_{i}$ 的闭合形式解析表达式。最终的方框答案中不要包含单位。", "solution": "所提出的问题是有效的，因为它在科学上基于固态物理和电磁学的既定原理，特别是光子晶体理论和耦合模系统理论。该问题提法适定、客观、内部一致，并且需要应用标准的、可验证的形式体系。我们将开始推导。\n\n问题要求完成三个主要任务：首先，为外部衰减率 $\\gamma_{e}$ 与群速度 $v_{g}$ 的标度关系提供一个物理解释；其次，使用时间耦合模理论 (TCMT) 找到临界耦合的条件；第三，将这些结果与给定的色散关系相结合，以找到临界耦合时的特定失谐量 $\\Delta_{c}$。\n\n分立的谐振器态衰减到波导模式连续谱中的过程由费米黄金定则决定。跃迁速率，我们将其等同于外部能量衰减率 $\\gamma_{e}$，它正比于耦合微扰矩阵元的平方 $|V_{fi}|^2$ 和末态的态密度 $\\rho(\\omega)$。以角频率单位表示，这可以写成：\n$$ \\gamma_{e}(\\omega) = \\frac{2\\pi}{\\hbar} |V_{fi}|^2 \\rho(\\omega) $$\n耦合矩阵元 $|V_{fi}|^2$ 取决于局域谐振器模式与波导的扩展布洛赫模式之间的空间交叠。对于短程局域耦合以及在谐振频率 $\\omega_{0}$ 附近的频率，该项可以被视为常数。关键的频率依赖性来自一维波导连续谱的态密度 $\\rho(\\omega)$。\n\n对于长度为 $L$ 的一维系统，在一个小的波矢区间 $dk$ 内的态数 $dN$ 由 $dN = (\\frac{L}{2\\pi}) dk$ 给出。那么，频率上的态密度为：\n$$ \\rho(\\omega) = \\frac{dN}{d\\omega} = \\frac{L}{2\\pi} \\frac{dk}{d\\omega} $$\n波导模式的群速度定义为 $v_{g}(\\omega) = d\\omega/dk$。因此，导数 $dk/d\\omega$ 就是群速度的倒数 $1/v_{g}(\\omega)$。这对于两个简并的反向传播模式都成立。可用于衰减的总态密度是这些模式的和。然而，对于侧向耦合的谐振器，对称性考虑通常决定了它只与这些模式的一种宇称组合耦合。无论如何，其标度关系保持不变。所以，我们有：\n$$ \\rho(\\omega) \\propto \\frac{1}{|v_{g}(\\omega)|} $$\n综合这些事实，外部衰减率 $\\gamma_{e}(\\omega)$ 正比于态密度，因此与群速度成反比：\n$$ \\gamma_{e}(\\omega) \\propto \\frac{1}{v_{g}(\\omega)} $$\n正如问题中所规定的，我们引入一个正常数 $\\beta$，它包含了耦合矩阵元和所有其他比例因子，从而得到关系式 $\\gamma_{e}(\\omega) = \\beta/v_{g}(\\omega)$。此处，$v_{g}$ 被理解为群速度的大小。\n\n接下来，我们对单端口系统采用时间耦合模理论。设 $a(t)$ 为谐振器模式的复振幅，归一化使得 $|a(t)|^2$ 是存储在谐振器中的能量。设 $s_{+}(t)$ 和 $s_{-}(t)$ 分别是半无限波导中入射波和出射波的振幅，归一化使得 $|s_{\\pm}(t)|^2$ 是功率。该系统的运动方程为：\n$$ \\frac{da}{dt} = (j\\omega_{0} - \\gamma_{i} - \\gamma_{e})a + \\sqrt{2\\gamma_{e}} s_{+} $$\n$$ s_{-} = -s_{+} + \\sqrt{2\\gamma_{e}} a $$\n此处，$\\omega_{0}$ 为谐振频率，$\\gamma_{i}$ 为本征损耗率，$\\gamma_{e}$ 为向波导的外部（耦合）损耗率。第二个方程中的 $-s_{+}$ 项代表来自耦合结构的背景反射，对于侧向耦合系统，这会引入一个 $\\pi$ 的相移。我们假设在频率 $\\omega$ 下存在时间谐波激励，因此 $a(t) = a e^{j\\omega t}$ 且 $s_{\\pm}(t) = s_{\\pm} e^{j\\omega t}$。将这些代入第一个方程可得：\n$$ j\\omega a = (j\\omega_{0} - \\gamma_{i} - \\gamma_{e})a + \\sqrt{2\\gamma_{e}} s_{+} $$\n解出谐振器振幅 $a$：\n$$ a = \\frac{\\sqrt{2\\gamma_{e}}}{j(\\omega - \\omega_{0}) + \\gamma_{i} + \\gamma_{e}} s_{+} $$\n反射振幅为 $r(\\omega) = s_{-}/s_{+}$。将 $a$ 的表达式代入 $s_{-}$ 的方程中：\n$$ s_{-} = -s_{+} + \\sqrt{2\\gamma_{e}} \\left( \\frac{\\sqrt{2\\gamma_{e}}}{j(\\omega - \\omega_{0}) + \\gamma_{i} + \\gamma_{e}} \\right) s_{+} $$\n$$ r(\\omega) = \\frac{s_{-}}{s_{+}} = -1 + \\frac{2\\gamma_{e}}{j(\\omega - \\omega_{0}) + \\gamma_{i} + \\gamma_{e}} = \\frac{-(j(\\omega - \\omega_{0}) + \\gamma_{i} + \\gamma_{e}) + 2\\gamma_{e}}{j(\\omega - \\omega_{0}) + \\gamma_{i} + \\gamma_{e}} $$\n$$ r(\\omega) = \\frac{-j(\\omega - \\omega_{0}) + \\gamma_{e} - \\gamma_{i}}{j(\\omega - \\omega_{0}) + \\gamma_{e} + \\gamma_{i}} $$\n临界耦合定义为在谐振频率处反射为零，即 $r(\\omega_{0}) = 0$。在 $r(\\omega)$ 的表达式中令 $\\omega = \\omega_{0}$：\n$$ r(\\omega_{0}) = \\frac{\\gamma_{e} - \\gamma_{i}}{\\gamma_{e} + \\gamma_{i}} $$\n为使该值为零，分子必须为零，这就给出了临界耦合条件：\n$$ \\gamma_{e} = \\gamma_{i} $$\n这意味着，要在谐振时实现完美吸收，能量从谐振器泄漏到波导中的速率必须与内部耗散的速率完全匹配。\n\n现在我们必须找到满足此条件的失谐量 $\\Delta_{c}$。问题指定了能带边（$k_b = \\pi/a$）附近的色散关系为 $\\omega(k) = \\omega_{b} + A(k - k_{b})^2$，其中 $A > 0$。我们需要群速度 $v_{g}(\\omega)$。首先，我们计算 $v_{g}$ 作为 $k$ 的函数：\n$$ v_{g}(k) = \\frac{d\\omega}{dk} = 2A(k - k_{b}) $$\n我们需要用相对于能带边的频率失谐量 $\\Delta \\equiv \\omega - \\omega_{b}$ 来表示它。从色散关系可知，$\\Delta = A(k - k_{b})^2$。由于 $A>0$，传播模式仅在 $\\Delta > 0$ 时存在，这与上能带边的情况一致。解出 $(k - k_{b})$ 得到 $(k - k_{b}) = \\pm \\sqrt{\\Delta/A}$。因此，群速度的大小为：\n$$ v_{g}(\\omega) = |2A (\\pm \\sqrt{\\Delta/A})| = 2\\sqrt{A\\Delta} = 2\\sqrt{A(\\omega - \\omega_{b})} $$\n现在，外部衰减率可以写成频率的函数：\n$$ \\gamma_{e}(\\omega) = \\frac{\\beta}{v_{g}(\\omega)} = \\frac{\\beta}{2\\sqrt{A(\\omega - \\omega_{b})}} $$\n我们寻求当谐振器调谐到频率 $\\omega_{0} = \\omega_{b} + \\Delta_{c}$ 时的临界耦合条件。在这个频率下，必须满足临界耦合条件 $\\gamma_{e}(\\omega_{0}) = \\gamma_{i}$。我们计算在 $\\omega_{0}$ 处的 $\\gamma_{e}$：\n$$ \\gamma_{e}(\\omega_0) = \\frac{\\beta}{2\\sqrt{A(\\omega_{0} - \\omega_{b})}} = \\frac{\\beta}{2\\sqrt{A\\Delta_{c}}} $$\n将其设为等于本征衰减率 $\\gamma_{i}$：\n$$ \\gamma_{i} = \\frac{\\beta}{2\\sqrt{A\\Delta_{c}}} $$\n我们现在求解临界失谐量 $\\Delta_{c}$：\n$$ 2\\sqrt{A\\Delta_{c}} = \\frac{\\beta}{\\gamma_{i}} $$\n$$ \\sqrt{A\\Delta_{c}} = \\frac{\\beta}{2\\gamma_{i}} $$\n方程两边平方：\n$$ A\\Delta_{c} = \\left(\\frac{\\beta}{2\\gamma_{i}}\\right)^2 = \\frac{\\beta^2}{4\\gamma_{i}^2} $$\n最后，分离出 $\\Delta_{c}$ 可得到所需的表达式：\n$$ \\Delta_{c} = \\frac{\\beta^2}{4A\\gamma_{i}^2} $$\n这就是为了实现临界耦合，谐振频率 $\\omega_{0}$ 必须设定的相对于能带边频率 $\\omega_{b}$ 的失谐量。", "answer": "$$\\boxed{\\frac{\\beta^2}{4A\\gamma_{i}^2}}$$", "id": "2850209"}]}