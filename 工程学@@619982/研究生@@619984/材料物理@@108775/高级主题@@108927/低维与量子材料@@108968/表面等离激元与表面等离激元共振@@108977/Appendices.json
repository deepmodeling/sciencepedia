{"hands_on_practices": [{"introduction": "在深入研究复杂应用之前，我们必须首先验证表面等离激元在界面上存在的基本条件。本练习提供了一种亲身实践的方式，运用金属光学的基石——德鲁德模型（Drude model），来计算金属的介电常数。通过这个计算，您将检验一个真实界面是否满足 $\\mathrm{Re}(\\epsilon_m) + \\epsilon_d < 0$ 的条件，从而巩固对为何只有特定材料组合才能支持这些表面波的核心物理理解。[@problem_id:2864084]", "problem": "如果金属介电常数的实部与电介质介电常数之和为负，金属与电介质之间的平面界面可以支持表面等离子体激元（SPP）。考虑用一个忽略了带间跃迁并假设背景介电常数为1的自由电子Drude模型来描述金。该金属与水接触，在可见光频率下，水的相对介电常数可近似视为常数，$\\epsilon_{d} \\simeq 1.77$。在自由空间波长 $\\lambda = 633\\ \\mathrm{nm}$ 处，给定金属等离子体频率 $\\omega_{p} = 1.37 \\times 10^{16}\\ \\mathrm{s}^{-1}$ 和唯象阻尼率 $\\gamma = 1.05 \\times 10^{14}\\ \\mathrm{s}^{-1}$，请使用Drude模型从基本原理计算复金属介电常数 $\\epsilon_{m}(\\omega)$。使用光速 $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m/s}$ 和角频率 $\\omega = 2\\pi c/\\lambda$。\n\n然后，评估量 $\\mathrm{Re}(\\epsilon_{m}(\\omega)) + \\epsilon_{d}$，并根据其符号判断在 $\\lambda = 633\\ \\mathrm{nm}$ 的金-水界面上是否满足SPP的存在条件。将您的最终数值答案表示为一个纯数（无量纲），等于 $\\mathrm{Re}(\\epsilon_{m}(\\omega)) + \\epsilon_{d}$，并四舍五入到三位有效数字。", "solution": "该问题陈述已经过验证，被认为是科学上合理、定义明确、客观且信息自洽的。它提出了一个材料物理学中的标准问题，可以使用既定原理解答。因此，我将继续进行解答。\n\n该问题要求使用自由电子Drude模型计算金的复介电常数 $\\epsilon_{m}(\\omega)$，然后利用此结果来检验在金-水界面处表面等离子体激元（SPP）的存在条件。在金属（介电常数为 $\\epsilon_m$）和电介质（介电常数为 $\\epsilon_d > 0$）的界面上，SPP的存在条件是金属介电常数的实部必须为负，并且其绝对值要大于电介质的介电常数，即 $\\mathrm{Re}(\\epsilon_m) < -\\epsilon_d$，这等价于条件 $\\mathrm{Re}(\\epsilon_{m}) + \\epsilon_{d} < 0$。\n\n在Drude模型框架下，假设背景介电常数为1（$\\epsilon_{\\infty} = 1$），金属的复相对介电常数 $\\epsilon_{m}(\\omega)$ 由以下表达式给出：\n$$ \\epsilon_{m}(\\omega) = 1 - \\frac{\\omega_{p}^{2}}{\\omega(\\omega + i\\gamma)} $$\n其中 $\\omega$ 是电磁场的角频率，$\\omega_{p}$ 是金属的等离子体频率，$\\gamma$ 是唯象阻尼率。\n\n首先，我们必须计算给定自由空间波长 $\\lambda = 633 \\ \\mathrm{nm} = 633 \\times 10^{-9} \\ \\mathrm{m}$ 所对应的角频率 $\\omega$。使用光速 $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m/s}$，我们有：\n$$ \\omega = \\frac{2\\pi c}{\\lambda} = \\frac{2\\pi (2.99792458 \\times 10^{8}\\ \\mathrm{m/s})}{633 \\times 10^{-9}\\ \\mathrm{m}} \\approx 2.9759235 \\times 10^{15}\\ \\mathrm{s}^{-1} $$\n\n接下来，为了评估SPP的存在条件，我们需要 $\\epsilon_{m}(\\omega)$ 的实部。我们首先对Drude公式中与频率相关的项的分母进行有理化：\n$$ \\frac{\\omega_{p}^{2}}{\\omega(\\omega + i\\gamma)} = \\frac{\\omega_{p}^{2}}{\\omega^{2} + i\\gamma\\omega} = \\frac{\\omega_{p}^{2}(\\omega^{2} - i\\gamma\\omega)}{(\\omega^{2} + i\\gamma\\omega)(\\omega^{2} - i\\gamma\\omega)} = \\frac{\\omega_{p}^{2}(\\omega^{2} - i\\gamma\\omega)}{\\omega^{4} + \\gamma^{2}\\omega^{2}} = \\frac{\\omega_{p}^{2}}{\\omega^{2} + \\gamma^{2}} - i \\frac{\\omega_{p}^{2} \\gamma}{\\omega(\\omega^{2} + \\gamma^{2})} $$\n将此结果代回 $\\epsilon_{m}(\\omega)$ 的表达式中：\n$$ \\epsilon_{m}(\\omega) = 1 - \\left( \\frac{\\omega_{p}^{2}}{\\omega^{2} + \\gamma^{2}} - i \\frac{\\omega_{p}^{2} \\gamma}{\\omega(\\omega^{2} + \\gamma^{2})} \\right) = \\left( 1 - \\frac{\\omega_{p}^{2}}{\\omega^{2} + \\gamma^{2}} \\right) + i \\left( \\frac{\\omega_{p}^{2} \\gamma}{\\omega(\\omega^{2} + \\gamma^{2})} \\right) $$\n由此，可以确定实部为：\n$$ \\mathrm{Re}(\\epsilon_{m}(\\omega)) = 1 - \\frac{\\omega_{p}^{2}}{\\omega^{2} + \\gamma^{2}} $$\n\n我们已知金的Drude模型参数：$\\omega_{p} = 1.37 \\times 10^{16}\\ \\mathrm{s}^{-1}$ 和 $\\gamma = 1.05 \\times 10^{14}\\ \\mathrm{s}^{-1}$。现在，我们将这些值以及计算出的 $\\omega$ 值代入 $\\mathrm{Re}(\\epsilon_{m}(\\omega))$ 的表达式中。让我们计算频率的平方：\n$$ \\omega_{p}^{2} = (1.37 \\times 10^{16}\\ \\mathrm{s}^{-1})^{2} = 1.8769 \\times 10^{32}\\ \\mathrm{s}^{-2} $$\n$$ \\omega^{2} \\approx (2.9759235 \\times 10^{15}\\ \\mathrm{s}^{-1})^{2} \\approx 8.856116 \\times 10^{30}\\ \\mathrm{s}^{-2} $$\n$$ \\gamma^{2} = (1.05 \\times 10^{14}\\ \\mathrm{s}^{-1})^{2} = 1.1025 \\times 10^{28}\\ \\mathrm{s}^{-2} $$\n因此，分母为：\n$$ \\omega^{2} + \\gamma^{2} \\approx 8.856116 \\times 10^{30}\\ \\mathrm{s}^{-2} + 1.1025 \\times 10^{28}\\ \\mathrm{s}^{-2} \\approx 8.867141 \\times 10^{30}\\ \\mathrm{s}^{-2} $$\n现在，我们计算介电常数的实部：\n$$ \\mathrm{Re}(\\epsilon_{m}(\\omega)) = 1 - \\frac{1.8769 \\times 10^{32}\\ \\mathrm{s}^{-2}}{8.867141 \\times 10^{30}\\ \\mathrm{s}^{-2}} \\approx 1 - 21.16733 = -20.16733 $$\n\n最后，我们评估量 $\\mathrm{Re}(\\epsilon_{m}(\\omega)) + \\epsilon_{d}$。利用给定的水的介电常数 $\\epsilon_{d} = 1.77$，我们得到：\n$$ \\mathrm{Re}(\\epsilon_{m}(\\omega)) + \\epsilon_{d} \\approx -20.16733 + 1.77 = -18.39733 $$\n结果为强负值，这证实在指定Drude模型的简化条件下，对于波长 $\\lambda = 633 \\ \\mathrm{nm}$，金-水界面上表面等离子体激元的存在条件得到满足。\n\n问题要求将 $\\mathrm{Re}(\\epsilon_{m}(\\omega)) + \\epsilon_{d}$ 的最终数值答案四舍五入到三位有效数字。\n$$ -18.39733 \\approx -18.4 $$\n这就是所要求的值。", "answer": "$$ \\boxed{-18.4} $$", "id": "2864084"}, {"introduction": "在德鲁德模型的基础上，本练习将探索一个更深层次的概念：材料的微观结构如何影响其宏观光学响应。我们将研究薄金属膜中的晶界散射如何改变电子的阻尼率，并因此影响表面等离激元共振的锐度。这项练习将固态物理学中的概念（Mayadas-Shatzkes 模型）与等离激元学联系起来，揭示了材料属性如何决定等离激元器件的性能。[@problem_id:2864028]", "problem": "一层多晶贵金属薄膜在其与无损耗电介质的平坦界面上支持表面等离激元极化子。该金属的响应由具有带间背景和弱阻尼电子气的自由电子模型描述。薄膜的晶粒在晶界处引入了额外的电子散射，这改变了电子动量弛豫率，从而改变了表面等离激元共振（SPR）的线宽。\n\n假设以下具有物理依据的要素：\n- 金属的自由电子介电响应由带有背景的 Drude 形式给出，\n  其中金属的介电常数为 $\\varepsilon_{m}(\\omega)$，背景介电常数为 $\\varepsilon_{\\infty}$，体等离激元频率为 $\\omega_{p}$，总阻尼率为 $\\gamma$。\n- 金属-电介质界面处的表面等离激元极化子共振发生在 $\\operatorname{Re}\\,\\varepsilon_{m}(\\omega) + \\varepsilon_{d} = 0$ 的解附近，其中 $\\varepsilon_{d}$ 是无损耗电介质的介电常数。\n- 在 Mayadas–Shatzkes (MS) 模型的稀疏晶界散射极限下，无量纲参数为 $\\alpha = \\dfrac{R}{1-R}\\dfrac{\\lambda_{0}}{D_{g}}$，其中 $R$ 是晶界反射系数，$\\lambda_{0}$ 是体平均自由程，$D_{g}$ 是平均晶粒尺寸。在一阶近似下，电阻率随 $\\alpha$ 线性增加。\n- 电阻率、电导率、动量弛豫时间和阻尼率之间的 Drude 关系适用。\n\n基于以上基础，推导在稀疏散射极限下，以能量单位表示的 SPR 谱的半峰全宽（FWHM）$\\Delta E$ 关于材料参数和 MS 参数 $\\alpha$ 的解析表达式。然后，使用以下实际参数对其进行数值计算：\n- 晶界反射系数 $R = 0.20$，\n- 体平均自由程 $\\lambda_{0} = 35\\,\\mathrm{nm}$，\n- 平均晶粒尺寸 $D_{g} = 70\\,\\mathrm{nm}$，\n- 体 Drude 阻尼率 $\\gamma_{0} = 1.00 \\times 10^{14}\\,\\mathrm{s}^{-1}$，\n- 背景介电常数 $\\varepsilon_{\\infty} = 9.5$，\n- 电介质介电常数 $\\varepsilon_{d} = 2.25$，\n- 体等离激元频率 $\\omega_{p} = 1.37 \\times 10^{16}\\,\\mathrm{s}^{-1}$，\n- 约化普朗克常数 $\\hbar = 6.582 \\times 10^{-16}\\,\\mathrm{eV\\cdot s}$。\n\n以电子伏特为单位，报告 $\\Delta E$ 的数值。答案四舍五入至三位有效数字。", "solution": "该问题要求推导受金属薄膜中晶界散射影响的表面等离激元共振（SPR）的谱线宽度，然后进行数值评估。我们将首先进行严格的验证，然后基于固态物理和电磁学的基本原理进行系统推导。\n\n首先，我们验证问题陈述的有效性。已知条件如下：\n- 金属介电常数：$\\varepsilon_{m}(\\omega)$，具有背景 $\\varepsilon_{\\infty}$、等离激元频率 $\\omega_{p}$ 和阻尼率 $\\gamma$ 的 Drude 形式。\n- 电介质介电常数：$\\varepsilon_{d}$（无损耗，实数）。\n- SPR 条件（近似）：$\\operatorname{Re}\\,\\varepsilon_{m}(\\omega) + \\varepsilon_{d} = 0$。\n- Mayadas-Shatzkes 参数：$\\alpha = \\dfrac{R}{1-R}\\dfrac{\\lambda_{0}}{D_{g}}$，其中包含晶界反射系数 $R$、体平均自由程 $\\lambda_{0}$ 和平均晶粒尺寸 $D_{g}$。\n- 电阻率依赖关系：在一阶近似下随 $\\alpha$ 线性增加。\n- Drude 关系适用。\n- 数值：$R = 0.20$，$\\lambda_{0} = 35\\,\\mathrm{nm}$，$D_{g} = 70\\,\\mathrm{nm}$，$\\gamma_{0} = 1.00 \\times 10^{14}\\,\\mathrm{s}^{-1}$，$\\varepsilon_{\\infty} = 9.5$，$\\varepsilon_{d} = 2.25$，$\\omega_{p} = 1.37 \\times 10^{16}\\,\\mathrm{s}^{-1}$，$\\hbar = 6.582 \\times 10^{-16}\\,\\mathrm{eV\\cdot s}$。\n\n该问题在科学上是合理的，它基于成熟的 Drude 模型和 Mayadas-Shatzkes 模型，以及表面等离激元极化子的标准理论。该问题提法恰当、客观，并包含了获得唯一解所需的所有信息。所提供的数值参数对于与标准电介质接触的贵金属是符合物理实际的。因此，该问题被认为是有效的。我们开始求解。\n\n金属的介电函数由 Drude 模型描述，其中包含由恒定背景介电常数 $\\varepsilon_{\\infty}$ 表示的带间跃迁贡献：\n$$ \\varepsilon_m(\\omega) = \\varepsilon_{\\infty} - \\frac{\\omega_p^2}{\\omega(\\omega + i\\gamma)} $$\n其中 $\\omega$ 是角频率，$\\omega_p$ 是体等离激元频率，$\\gamma$ 是总的电子动量弛豫率（阻尼率）。我们可以将 $\\varepsilon_m(\\omega)$ 分解为实部和虚部：\n$$ \\varepsilon_m(\\omega) = \\varepsilon_{\\infty} - \\frac{\\omega_p^2(\\omega - i\\gamma)}{\\omega(\\omega^2 + \\gamma^2)} = \\left(\\varepsilon_{\\infty} - \\frac{\\omega_p^2}{\\omega^2 + \\gamma^2}\\right) + i\\left(\\frac{\\omega_p^2\\gamma}{\\omega(\\omega^2 + \\gamma^2)}\\right) $$\n因此，我们有：\n$$ \\operatorname{Re}\\,\\varepsilon_m(\\omega) = \\varepsilon_{\\infty} - \\frac{\\omega_p^2}{\\omega^2 + \\gamma^2} $$\n$$ \\operatorname{Im}\\,\\varepsilon_m(\\omega) = \\frac{\\omega_p^2\\gamma}{\\omega(\\omega^2 + \\gamma^2)} $$\n表面等离激元极化子是一种被限制在电介质和导体之间界面上的电磁波。该模式的共振频率 $\\omega_{sp}$ 由两种介质的性质决定。对于弱阻尼等离激元（$\\gamma \\ll \\omega$），共振峰非常尖锐，其发生的频率使得 SPP 色散关系的分母 $\\varepsilon_m(\\omega) + \\varepsilon_d$ 的实部趋近于零。问题陈述中给出了这个条件：\n$$ \\operatorname{Re}\\,\\varepsilon_m(\\omega_{sp}) + \\varepsilon_d = 0 $$\n代入 $\\operatorname{Re}\\,\\varepsilon_m(\\omega)$ 的表达式：\n$$ \\varepsilon_{\\infty} - \\frac{\\omega_p^2}{\\omega_{sp}^2 + \\gamma^2} + \\varepsilon_d = 0 \\implies \\varepsilon_{\\infty} + \\varepsilon_d = \\frac{\\omega_p^2}{\\omega_{sp}^2 + \\gamma^2} $$\n\n共振的谱线形状（例如在衰减全反射（ATR）实验中）近似为洛伦兹形，并与 $|\\varepsilon_m(\\omega) + \\varepsilon_d|^{-2}$ 成正比。此洛伦兹线形的半峰全宽（FWHM），记为 $\\Delta\\omega$，可以通过分析共振频率 $\\omega_{sp}$ 附近的分母函数 $D(\\omega) = \\varepsilon_m(\\omega) + \\varepsilon_d$ 来找到。FWHM 由共振的通用公式给出：\n$$ \\Delta\\omega = 2 \\left| \\frac{\\operatorname{Im}\\,D(\\omega_{sp})}{\\frac{d}{d\\omega}(\\operatorname{Re}\\,D(\\omega))|_{\\omega=\\omega_{sp}}} \\right| $$\n由于 $\\varepsilon_d$ 是一个实常数，因此 $\\operatorname{Im}\\,D(\\omega) = \\operatorname{Im}\\,\\varepsilon_m(\\omega)$ 且 $\\operatorname{Re}\\,D(\\omega) = \\operatorname{Re}\\,\\varepsilon_m(\\omega) + \\varepsilon_d$。我们来计算必要的项。共振时的虚部为：\n$$ \\operatorname{Im}\\,\\varepsilon_m(\\omega_{sp}) = \\frac{\\omega_p^2\\gamma}{\\omega_{sp}(\\omega_{sp}^2 + \\gamma^2)} $$\n使用共振条件 $\\omega_p^2 = (\\varepsilon_{\\infty} + \\varepsilon_d)(\\omega_{sp}^2 + \\gamma^2)$，我们将其简化为：\n$$ \\operatorname{Im}\\,\\varepsilon_m(\\omega_{sp}) = \\frac{(\\varepsilon_{\\infty} + \\varepsilon_d)(\\omega_{sp}^2 + \\gamma^2)\\gamma}{\\omega_{sp}(\\omega_{sp}^2 + \\gamma^2)} = \\frac{\\gamma(\\varepsilon_{\\infty} + \\varepsilon_d)}{\\omega_{sp}} $$\n接下来，我们计算实部的导数：\n$$ \\frac{d}{d\\omega}(\\operatorname{Re}\\,\\varepsilon_m(\\omega)) = \\frac{d}{d\\omega}\\left(\\varepsilon_{\\infty} - \\frac{\\omega_p^2}{\\omega^2 + \\gamma^2}\\right) = \\frac{2\\omega\\omega_p^2}{(\\omega^2 + \\gamma^2)^2} $$\n在 $\\omega = \\omega_{sp}$ 处求值，并再次代入 $\\omega_p^2$：\n$$ \\left.\\frac{d}{d\\omega}(\\operatorname{Re}\\,\\varepsilon_m(\\omega))\\right|_{\\omega_{sp}} = \\frac{2\\omega_{sp}\\omega_p^2}{(\\omega_{sp}^2 + \\gamma^2)^2} = \\frac{2\\omega_{sp}(\\varepsilon_{\\infty} + \\varepsilon_d)(\\omega_{sp}^2 + \\gamma^2)}{(\\omega_{sp}^2 + \\gamma^2)^2} = \\frac{2\\omega_{sp}(\\varepsilon_{\\infty} + \\varepsilon_d)}{\\omega_{sp}^2 + \\gamma^2} $$\n现在，我们将这些代入 FWHM 公式：\n$$ \\Delta\\omega = 2 \\frac{\\frac{\\gamma(\\varepsilon_{\\infty} + \\varepsilon_d)}{\\omega_{sp}}}{\\frac{2\\omega_{sp}(\\varepsilon_{\\infty} + \\varepsilon_d)}{\\omega_{sp}^2 + \\gamma^2}} = \\gamma \\frac{\\omega_{sp}^2 + \\gamma^2}{\\omega_{sp}^2} = \\gamma\\left(1 + \\left(\\frac{\\gamma}{\\omega_{sp}}\\right)^2\\right) $$\n对于“弱阻尼电子气”，条件 $\\gamma \\ll \\omega_{sp}$ 成立。我们使用所提供的参数来验证这一点。$\\omega_{sp}^2 \\approx \\omega_p^2 / (\\varepsilon_{\\infty} + \\varepsilon_d) = (1.37 \\times 10^{16})^2 / (9.5 + 2.25) \\approx 1.6 \\times 10^{31}\\,\\mathrm{s}^{-2}$，因此 $\\omega_{sp} \\approx 4.0 \\times 10^{15}\\,\\mathrm{s}^{-1}$。阻尼 $\\gamma$ 的量级约为 $\\gamma_0 = 1.0 \\times 10^{14}\\,\\mathrm{s}^{-1}$。比率 $(\\gamma/\\omega_{sp})^2$ 的量级为 $(10^{14}/(4 \\times 10^{15}))^2 = (0.025)^2 = 6.25 \\times 10^{-4}$，这是可以忽略不计的。因此，以下是一个极好的近似：\n$$ \\Delta\\omega \\approx \\gamma $$\n问题指出，晶界处的电子散射对总阻尼有额外的贡献。总阻尼率 $\\gamma$ 是体阻尼率 $\\gamma_0$（来自电子-声子和电子-电子散射）与晶界贡献 $\\gamma_{gb}$ 之和：$\\gamma = \\gamma_0 + \\gamma_{gb}$。\n根据 Drude 模型，电阻率 $\\rho$ 与阻尼率的关系为 $\\rho = m^*/(ne^2\\tau) = \\gamma m^*/(ne^2)$，其中 $\\tau=1/\\gamma$ 是弛豫时间，$n$ 是电子密度，$m^*$ 是有效质量。等离激元频率的平方为 $\\omega_p^2 = ne^2/(\\varepsilon_0 m^*)$。因此，$\\rho = \\gamma/(\\varepsilon_0\\omega_p^2)$。假设 $\\omega_p$ 不受晶界影响，则电阻率与阻尼率成正比：$\\rho \\propto \\gamma$。\nMayadas-Shatzkes 模型量化了由晶界散射引起的电阻率增加。对于稀疏散射（$\\alpha \\ll 1$），总电阻率 $\\rho$ 由下式给出：\n$$ \\rho \\approx \\rho_0 \\left(1 + \\frac{3}{2}\\alpha\\right) $$\n其中 $\\rho_0$ 是体电阻率。这就是问题陈述中提到的随 $\\alpha$ 线性增加的关系。在此极限下，该比例常数是 MS 模型的直接结果。\n由于 $\\rho$ 和 $\\gamma$ 之间的正比关系，总阻尼率为：\n$$ \\gamma = \\gamma_0 \\left(1 + \\frac{3}{2}\\alpha\\right) $$\n代入 MS 参数 $\\alpha$ 的定义：\n$$ \\gamma = \\gamma_0 \\left(1 + \\frac{3}{2} \\frac{R}{1-R} \\frac{\\lambda_0}{D_g}\\right) $$\n以能量单位表示的 FWHM $\\Delta E$ 是 $\\hbar \\Delta\\omega$。使用我们的近似 $\\Delta\\omega \\approx \\gamma$：\n$$ \\Delta E = \\hbar \\gamma = \\hbar \\gamma_0 \\left(1 + \\frac{3}{2} \\frac{R}{1-R} \\frac{\\lambda_0}{D_g}\\right) $$\n这就是所求的解析表达式。\n\n现在我们用给定的参数对该表达式进行数值计算：\n- $R = 0.20$\n- $\\lambda_{0} = 35\\,\\mathrm{nm}$\n- $D_{g} = 70\\,\\mathrm{nm}$\n- $\\gamma_{0} = 1.00 \\times 10^{14}\\,\\mathrm{s}^{-1}$\n- $\\hbar = 6.582 \\times 10^{-16}\\,\\mathrm{eV\\cdot s}$\n\n首先，计算无量纲因子：\n$$ 1 + \\frac{3}{2} \\frac{R}{1-R} \\frac{\\lambda_0}{D_g} = 1 + \\frac{3}{2} \\cdot \\frac{0.20}{1-0.20} \\cdot \\frac{35}{70} $$\n$$ = 1 + 1.5 \\cdot \\frac{0.20}{0.80} \\cdot 0.5 $$\n$$ = 1 + 1.5 \\cdot 0.25 \\cdot 0.5 = 1 + 0.1875 = 1.1875 $$\n现在，计算能量展宽 $\\Delta E$：\n$$ \\Delta E = (6.582 \\times 10^{-16}\\,\\mathrm{eV\\cdot s}) \\cdot (1.00 \\times 10^{14}\\,\\mathrm{s}^{-1}) \\cdot (1.1875) $$\n$$ \\Delta E = (0.06582\\,\\mathrm{eV}) \\cdot (1.1875) $$\n$$ \\Delta E = 0.07817025\\,\\mathrm{eV} $$\n按要求四舍五入到三位有效数字，我们得到：\n$$ \\Delta E \\approx 0.0782\\,\\mathrm{eV} $$", "answer": "$$\\boxed{0.0782}$$", "id": "2864028"}, {"introduction": "最后的这项练习将通过模拟等离激元学研究中的一项常见任务——分析实验数据，来弥合理论与实验之间的鸿沟。给定一个通过棱镜耦合装置测得的反射率曲线，我们将学习如何拟合一个物理模型，以提取表面等离激元内在传播长度等关键参数。这项练习不仅能提供数据分析的实践经验，还展示了共振线型的理论模型是如何被用来量化等离激元系统的性质的。[@problem_id:2864092]", "problem": "您会获得在棱镜耦合表面等离极化激元 (SPP) 激发（Kretschmann 结构）下产生的角分辨反射率数据，其中由于耦合到 SPP，反射率在相位匹配角附近表现出一个凹陷。您的任务是编写一个完整的程序，对每个给定的数据集，通过拟合凹陷宽度来提取本征 SPP 传播长度，同时考虑已知的棱镜辐射损耗。\n\n使用的基本原理和建模假设：\n- 从麦克斯韦方程组和平面界面的边界条件出发，证明在金属-电介质界面上存在束缚 SPP 模式。面内 SPP 波矢表示为 $k_{\\mathrm{sp}} = \\beta = \\mathrm{Re}(\\beta) + i\\,\\mathrm{Im}(\\beta)$，其中 $\\mathrm{Im}(\\beta) > 0$ 代表损耗。\n- 沿界面的本征 SPP 传播长度由指数振幅衰减 $e^{-\\mathrm{Im}(\\beta) x}$ 定义，并由 $L_{\\mathrm{int}} = 1/(2\\,\\mathrm{Im}(\\beta))$ 给出。\n- 在棱镜耦合实验中，入射光的面内波矢分量为 $k_x(\\theta) = n_p\\,k_0\\,\\sin(\\theta)$，其中 $n_p$ 是棱镜折射率，$\\theta$ 是棱镜内的入射角，$k_0 = 2\\pi/\\lambda_0$ 是波长为 $\\lambda_0$ 时的自由空间波数。\n- 在共振附近，由于单个主导模式耦合到连续谱，作为 $k_x$ 函数的反射率凹陷可以通过洛伦兹线型来建模。面内波矢域中的总半宽，记作 $\\,\\Gamma_{\\mathrm{tot}}\\,$，是本征损耗贡献 $\\,\\Gamma_{\\mathrm{int}}\\,$（欧姆损耗）和由于泄漏回棱镜的外部辐射贡献 $\\,\\Gamma_{\\mathrm{rad}}\\,$ 的总和：$\\Gamma_{\\mathrm{tot}} = \\Gamma_{\\mathrm{int}} + \\Gamma_{\\mathrm{rad}}$。这种可加性是时间耦合模理论中衰减率可加性在动量域中的类比。\n- 因此，本征传播长度为 $L_{\\mathrm{int}} = 1/\\left(2\\,\\Gamma_{\\mathrm{int}}\\right) = 1/\\left(2\\,(\\Gamma_{\\mathrm{tot}} - \\Gamma_{\\mathrm{rad}})\\right)$。\n\n需要实现的算法规范：\n1. 将给定的反射率对角度数据 $R(\\theta)$ 转换为面内波矢的函数 $k_x(\\theta) = n_p\\,k_0\\,\\sin(\\theta)$，其中 $\\theta$ 以弧度为单位，$k_0 = 2\\pi/\\lambda_0$。\n2. 在角度域中使用以下模型拟合测量的凹陷，该模型隐式地表示了 $k_x$ 域的洛伦兹函数：\n   $$R_{\\mathrm{model}}(\\theta) = R_{\\mathrm{bg}} - \\frac{A}{1 + \\left(\\dfrac{k_x(\\theta) - k_{\\mathrm{res}}}{\\Gamma_{\\mathrm{tot}}}\\right)^2},$$\n   其中 $R_{\\mathrm{bg}}$ 是基线反射率，$A$ 是凹陷深度，$k_{\\mathrm{res}}$ 是共振面内波矢，$\\Gamma_{\\mathrm{tot}}$ 是面内波矢域中的总半宽。参数 $R_{\\mathrm{bg}}$、$A$、$k_{\\mathrm{res}}$ 和 $\\Gamma_{\\mathrm{tot}}$ 应通过对所提供数据进行非线性最小二乘拟合来获得。\n3. 使用已知的棱镜辐射半宽 $\\Gamma_{\\mathrm{rad}}$（为每个案例给定），计算 $\\Gamma_{\\mathrm{int}} = \\Gamma_{\\mathrm{tot}} - \\Gamma_{\\mathrm{rad}}$，然后计算 $L_{\\mathrm{int}} = 1/\\left(2\\,\\Gamma_{\\mathrm{int}}\\right)$。\n4. 将 $L_{\\mathrm{int}}$ 乘以 $10^{6}$ 以微米表示，并将结果四舍五入到三位小数。\n\n您的程序必须处理以下测试套件。对于每个案例，在指定的角度网格上使用上述模型合成反射率数据 $R(\\theta)$，不添加噪声，然后执行拟合并计算 $L_{\\mathrm{int}}$。\n\n对于每个测试用例，数据生成参数如下：\n- 案例 1：\n  - $\\lambda_0 = 6.33\\times 10^{-7}\\,\\mathrm{m}$，$n_p = 1.515$\n  - 真实共振角 $\\theta_{\\mathrm{res}} = 43.5\\,\\mathrm{deg}$\n  - 辐射半宽 $\\Gamma_{\\mathrm{rad}} = 2.0\\times 10^{4}\\,\\mathrm{m}^{-1}$\n  - 总半宽 $\\Gamma_{\\mathrm{tot}} = 7.0\\times 10^{4}\\,\\mathrm{m}^{-1}$（意味着本征半宽 $\\Gamma_{\\mathrm{int}} = 5.0\\times 10^{4}\\,\\mathrm{m}^{-1}$）\n  - 基线 $R_{\\mathrm{bg}} = 0.85$，凹陷深度 $A = 0.25$\n  - 角度网格：$\\theta \\in [\\theta_{\\mathrm{res}} - 2.0\\,\\mathrm{deg},\\, \\theta_{\\mathrm{res}} + 2.0\\,\\mathrm{deg}]$，采样间隔为 $0.02\\,\\mathrm{deg}$\n- 案例 2：\n  - $\\lambda_0 = 7.85\\times 10^{-7}\\,\\mathrm{m}$，$n_p = 1.6$\n  - 真实共振角 $\\theta_{\\mathrm{res}} = 41.0\\,\\mathrm{deg}$\n  - 辐射半宽 $\\Gamma_{\\mathrm{rad}} = 5.0\\times 10^{4}\\,\\mathrm{m}^{-1}$\n  - 总半宽 $\\Gamma_{\\mathrm{tot}} = 2.1666666667\\times 10^{5}\\,\\mathrm{m}^{-1}$（意味着本征半宽 $\\Gamma_{\\mathrm{int}} \\approx 1.6666666667\\times 10^{5}\\,\\mathrm{m}^{-1}$）\n  - 基线 $R_{\\mathrm{bg}} = 0.90$，凹陷深度 $A = 0.20$\n  - 角度网格：$\\theta \\in [\\theta_{\\mathrm{res}} - 2.0\\,\\mathrm{deg},\\, \\theta_{\\mathrm{res}} + 2.0\\,\\mathrm{deg}]$，采样间隔为 $0.02\\,\\mathrm{deg}$\n- 案例 3：\n  - $\\lambda_0 = 5.32\\times 10^{-7}\\,\\mathrm{m}$，$n_p = 1.7$\n  - 真实共振角 $\\theta_{\\mathrm{res}} = 44.0\\,\\mathrm{deg}$\n  - 辐射半宽 $\\Gamma_{\\mathrm{rad}} = 1.5\\times 10^{4}\\,\\mathrm{m}^{-1}$\n  - 总半宽 $\\Gamma_{\\mathrm{tot}} = 2.5\\times 10^{4}\\,\\mathrm{m}^{-1}$（意味着本征半宽 $\\Gamma_{\\mathrm{int}} = 1.0\\times 10^{4}\\,\\mathrm{m}^{-1}$）\n  - 基线 $R_{\\mathrm{bg}} = 0.75$，凹陷深度 $A = 0.15$\n  - 角度网格：$\\theta \\in [\\theta_{\\mathrm{res}} - 2.0\\,\\mathrm{deg},\\, \\theta_{\\mathrm{res}} + 2.0\\,\\mathrm{deg}]$，采样间隔为 $0.02\\,\\mathrm{deg}$\n\n在所有案例中，计算 $k_{\\mathrm{res}} = n_p\\,k_0\\,\\sin(\\theta_{\\mathrm{res}})$，然后使用上面给出的模型 $R_{\\mathrm{model}}(\\theta)$ 以及指定的 $R_{\\mathrm{bg}}$、$A$、$\\Gamma_{\\mathrm{tot}}$ 和 $k_{\\mathrm{res}}$ 参数，在角度网格上合成反射率数据。使用这些合成数据作为您拟合程序的“测量”输入。\n\n角度单位和输出单位要求：\n- 模型中所有角度 $\\theta$ 必须在内部以弧度处理，但提供的网格以度为单位，因此请使用 $\\theta_{\\mathrm{rad}} = \\theta_{\\mathrm{deg}} \\times \\pi/180$ 将度转换为弧度。\n- 将最终的本征 SPP 传播长度 $L_{\\mathrm{int}}$ 以微米表示，并四舍五入到三位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。该列表必须按顺序包含案例 1、2 和 3 的三个 $L_{\\mathrm{int}}$ 值（以微米为单位）。例如，具有三个值的输出应类似于 $[x_1,x_2,x_3]$，其中每个 $x_i$ 是一个四舍五入到三位小数的十进制数。", "solution": "所呈现的问题是一个关于分析源自 Kretschmann-Raether 棱镜耦合结构的表面等离振子共振 (SPR) 数据的直接计算练习。它要求通过将理论模型拟合到合成数据来提取表面等离极化激元 (SPP) 的本征传播长度。该问题具有科学依据、内部一致且是良态的。尽管将模型拟合到由同一模型生成的理想、无噪声数据的任务有些简单，其目的仅在于验证算法的实现，而非一个真正的科学问题，但我们将以预期的严谨性执行所要求的程序。\n\n首先，我们必须确立其物理原理。表面等离极化激元是横磁 (TM) 电磁表面波，沿着电介质和具有负介电常数实部的导体（如金属）之间的界面传播。它们的存在是麦克斯韦方程组在界面边界条件下的直接推论。连接频率 $\\omega$ 和波矢 $k$ 的 SPP 色散关系，与周围电介质介质中的光线不相交。这意味着 SPP 不能由直接入射到界面上的光激发。\n\nKretschmann 结构规避了这种动量失配。一个高折射率棱镜 ($n_p$) 被放置在紧邻金属膜的位置。以大于全内反射临界角的角度 $\\theta$ 入射到棱镜底面上的 P 偏振光会产生一个穿透金属膜的倏逝场。入射光波矢的面内分量由下式给出：\n$$k_x(\\theta) = n_p k_0 \\sin(\\theta)$$\n其中 $k_0 = 2\\pi/\\lambda_0$ 是给定真空波长 $\\lambda_0$ 的自由空间波数。在一个特定的共振角 $\\theta_{\\mathrm{res}}$，该波矢与 SPP 波矢的实部匹配，$k_x(\\theta_{\\mathrm{res}}) \\approx \\mathrm{Re}(k_{\\mathrm{sp}})$。此相位匹配条件允许能量从入射光有效耦合到 SPP 模式，从而在衰减全反射 (ATR) 光谱 $R(\\theta)$ 中产生一个尖锐的凹陷。\n\nSPP 波矢是一个复数量，$k_{\\mathrm{sp}} = \\beta = \\mathrm{Re}(\\beta) + i\\,\\mathrm{Im}(\\beta)$，其中虚部 $\\mathrm{Im}(\\beta)$ 代表由损耗引起的阻尼。在动量 ($k$) 空间域中，共振具有有限宽度，可以用洛伦兹线型建模。此洛伦兹线型的总半峰半宽 (HWHM)，记作 $\\Gamma_{\\mathrm{tot}}$，源于两个主要衰减通道：\n$1$. 本征阻尼 $\\Gamma_{\\mathrm{int}}$，由金属内部的欧姆损耗（吸收）引起。\n$2$. 辐射阻尼 $\\Gamma_{\\mathrm{rad}}$，由 SPP 能量再辐射或“泄漏”回棱镜引起。\n\n根据耦合模理论，这些损耗率是可相加的：\n$$\\Gamma_{\\mathrm{tot}} = \\Gamma_{\\mathrm{int}} + \\Gamma_{\\mathrm{rad}}$$\n本征传播长度 $L_{\\mathrm{int}}$ 是 SPP *强度* 仅因欧姆损耗而衰减到其初始值 1/e 时所经过的距离。它与本征阻尼常数的关系如下：\n$$L_{\\mathrm{int}} = \\frac{1}{2\\Gamma_{\\mathrm{int}}}$$\n因子 2 的出现是因为强度与场振幅的平方成正比，而场振幅按 $e^{-\\Gamma_{\\mathrm{int}} x}$ 衰减。\n\n该问题要求我们将模拟的反射率数据 $R(\\theta)$ 拟合到以下模型：\n$$R_{\\mathrm{model}}(\\theta) = R_{\\mathrm{bg}} - \\frac{A}{1 + \\left(\\dfrac{k_x(\\theta) - k_{\\mathrm{res}}}{\\Gamma_{\\mathrm{tot}}}\\right)^2}$$\n此处，$R_{\\mathrm{bg}}$ 是远离共振处的背景反射率，$A$ 是凹陷深度，$k_{\\mathrm{res}}$ 是共振面内波矢，$\\Gamma_{\\mathrm{tot}}$ 是波矢域中的总半峰半宽。\n\n每个测试用例的步骤如下：\n$1$. 对于一组给定的参数（$\\lambda_0, n_p, \\theta_{\\mathrm{res}}, \\Gamma_{\\mathrm{rad}}, \\Gamma_{\\mathrm{tot}}, R_{\\mathrm{bg}}, A$），我们首先合成“测量”的反射率数据。我们在真实共振角 $\\theta_{\\mathrm{res}}$ 周围定义一个角度网格 $\\theta$。在进行三角函数计算时，角度必须从度转换为弧度。我们计算真实共振波矢 $k_{\\mathrm{res}} = n_p (2\\pi/\\lambda_0) \\sin(\\theta_{\\mathrm{res}})$。然后，对于网格中的每个角度 $\\theta_i$，我们计算 $k_x(\\theta_i)$ 并随后计算模型反射率 $R(\\theta_i)$。\n$2$. 然后，我们使用 `scipy.optimize.curve_fit` 函数，对这些合成数据执行非线性最小二乘拟合过程。待拟合的函数正是上面定义的 $R_{\\mathrm{model}}(\\theta)$，其中 $R_{\\mathrm{bg}}$、$A$、$k_{\\mathrm{res}}$ 和 $\\Gamma_{\\mathrm{tot}}$ 为自由参数。\n$3$. 从拟合结果中，我们提取总宽度 $\\Gamma_{\\mathrm{tot,fit}}$ 的优化值。\n$4$. 我们通过减去已知的辐射宽度来计算本征宽度：$\\Gamma_{\\mathrm{int}} = \\Gamma_{\\mathrm{tot,fit}} - \\Gamma_{\\mathrm{rad}}$。\n$5$. 最后，我们计算本征传播长度：$L_{\\mathrm{int}} = 1 / (2\\Gamma_{\\mathrm{int}})$。此结果原始单位为米，通过乘以 $10^6$ 转换为微米，然后按要求四舍五入到三位小数。\n\n由于数据是在没有噪声的情况下，从用于拟合的相同模型生成的，因此拟合过程预计将高精度地恢复原始参数，这使得本次任务成为对正确实现的一次检验。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves the surface plasmon resonance analysis problem for three test cases.\n    For each case, it synthesizes reflectivity data and then fits a model to\n    extract the intrinsic SPP propagation length.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (lambda_0, n_p, theta_res_deg, Gamma_rad, Gamma_tot, R_bg, A)\n    test_cases = [\n        # Case 1\n        (6.33e-7, 1.515, 43.5, 2.0e4, 7.0e4, 0.85, 0.25),\n        # Case 2\n        (7.85e-7, 1.6, 41.0, 5.0e4, 2.1666666667e5, 0.90, 0.20),\n        # Case 3\n        (5.32e-7, 1.7, 44.0, 1.5e4, 2.5e4, 0.75, 0.15),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Unpack parameters for the current test case\n        lambda_0, n_p, theta_res_deg, Gamma_rad, Gamma_tot_true, R_bg_true, A_true = case\n\n        # --- 1. Synthesize Reflectivity Data ---\n\n        # Calculate free-space wavenumber\n        k0 = 2 * np.pi / lambda_0\n        \n        # Convert resonance angle to radians\n        theta_res_rad = np.deg2rad(theta_res_deg)\n        \n        # Calculate the true resonant in-plane wavevector\n        k_res_true = n_p * k0 * np.sin(theta_res_rad)\n        \n        # Define the model function for data generation and fitting.\n        # It takes angle theta (in radians) as the independent variable.\n        # This wrapper handles the conversion from angle to k_x internally.\n        def reflectivity_model(theta_rad, R_bg, A, k_res, Gamma_tot):\n            k_x = n_p * k0 * np.sin(theta_rad)\n            lorentzian_term = 1 + ((k_x - k_res) / Gamma_tot)**2\n            return R_bg - A / lorentzian_term\n            \n        # Generate the angle grid for the synthetic data\n        theta_grid_deg = np.arange(theta_res_deg - 2.0, theta_res_deg + 2.0, 0.02)\n        theta_grid_rad = np.deg2rad(theta_grid_deg)\n        \n        # Generate synthetic reflectivity data without noise\n        R_synthetic = reflectivity_model(theta_grid_rad, R_bg_true, A_true, k_res_true, Gamma_tot_true)\n\n        # --- 2. Fit the Model to the Data ---\n\n        # Provide initial guesses for the fitting parameters.\n        # Using the true values is a good strategy for this verification task.\n        initial_guesses = [R_bg_true, A_true, k_res_true, Gamma_tot_true]\n        \n        # Perform non-linear least-squares fitting\n        try:\n            popt, _ = optimize.curve_fit(reflectivity_model, theta_grid_rad, R_synthetic, p0=initial_guesses)\n        except RuntimeError:\n            # Handle cases where the fit might fail, although unlikely with noise-free data\n            results.append(np.nan)\n            continue\n            \n        # Extract the fitted total width\n        _R_bg_fit, _A_fit, _k_res_fit, Gamma_tot_fit = popt\n        \n        # --- 3. Compute Intrinsic Propagation Length ---\n        \n        # Calculate the intrinsic width\n        Gamma_int = Gamma_tot_fit - Gamma_rad\n        \n        # Calculate the intrinsic propagation length\n        # L_int = 1 / (2 * Gamma_int)\n        # Check for division by zero or negative Gamma_int, although not expected here\n        if Gamma_int > 0:\n            L_int_meters = 1.0 / (2.0 * Gamma_int)\n        else:\n            L_int_meters = np.inf\n        \n        # Convert from meters to micrometers\n        L_int_micrometers = L_int_meters * 1e6\n        \n        # Round to three decimal places\n        L_int_rounded = round(L_int_micrometers, 3)\n        \n        results.append(L_int_rounded)\n        \n    # Final print statement in the exact required format.\n    # Using format specifier to ensure three decimal places, e.g., 10.0 becomes 10.000\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2864092"}]}