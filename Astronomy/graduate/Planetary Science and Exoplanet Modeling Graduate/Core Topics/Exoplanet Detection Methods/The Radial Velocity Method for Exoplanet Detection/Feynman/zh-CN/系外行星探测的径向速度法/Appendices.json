{
    "hands_on_practices": [
        {
            "introduction": "在开始搜寻系外行星之前，了解我们期望测量的信号强度至关重要。这项练习将引导你从第一性原理出发，仅使用基本的牛顿力学，推导由轨道行星引起的恒星径向速度半振幅。通过为一个类木行星计算这个值，你将对现代径向速度仪器所需的精度建立起具体的认识。",
            "id": "4184022",
            "problem": "一颗质量为 $M_{\\star} = 1\\,M_{\\odot}$ 的类日主星，被一颗质量为 $m_p = 1\\,M_{\\mathrm{J}}$ 的行星在圆形轨道上环绕，其半长轴为 $a = 1\\,\\mathrm{AU}$，轨道倾角为 $i = \\pi/2$（侧向观测）。仅使用牛顿万有引力定律和圆形轨道的双体动力学，从第一性原理推导该恒星的视向径向速度作为时间的函数表达式，并确定径向速度半振幅。然后对给定系统，对此半振幅进行数值计算。不要使用任何预先推导的系外行星专用公式；从基础力学和双体问题的质心描述开始。最后，简要评论目前的​​高精度摄谱仪是否能够探测到这样的信号。\n\n取以下常数：\n- 引力常数 $G = 6.67430\\times 10^{-11}\\,\\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$。\n- 太阳质量 $M_{\\odot} = 1.98847\\times 10^{30}\\,\\mathrm{kg}$。\n- 木星质量 $M_{\\mathrm{J}} = 1.89813\\times 10^{27}\\,\\mathrm{kg}$。\n- 天文单位 $\\mathrm{AU} = 1.495978707\\times 10^{11}\\,\\mathrm{m}$。\n\n将你最终的半振幅数值答案四舍五入至三位有效数字。最终的半振幅以米每秒（m/s）为单位表示。",
            "solution": "所述问题在科学上是合理的、自洽的且定义明确的。解决问题所需的所有数据和常数均已提供，不存在内部矛盾或违反基本物理原理的情况。因此，该问题被认为是有效的，并将推导出解答。\n\n该问题要求从第一性原理出发，为一个由质量为 $M_{\\star}$ 的恒星和质量为 $m_p$ 的行星组成的双体系统推导恒星的视向径向速度。由于相互的引力吸引，这两个天体围绕它们的共同质心（CM）运行。\n\n在质心参考系中，恒星 ($\\vec{r}_{\\star}$) 和行星 ($\\vec{r}_p$) 相对于质心的位置矢量通过质心的定义相互关联：\n$$M_{\\star}\\vec{r}_{\\star} + m_p\\vec{r}_p = \\vec{0}$$\n恒星和行星之间的分离矢量定义为 $\\vec{a} = \\vec{r}_p - \\vec{r}_{\\star}$。从质心方程我们得到 $\\vec{r}_p = -\\frac{M_{\\star}}{m_p}\\vec{r}_{\\star}$。将此代入 $\\vec{a}$ 的定义中：\n$$\\vec{a} = -\\frac{M_{\\star}}{m_p}\\vec{r}_{\\star} - \\vec{r}_{\\star} = -\\left(\\frac{M_{\\star} + m_p}{m_p}\\right)\\vec{r}_{\\star}$$\n这使我们能够用分离矢量 $\\vec{a}$ 来表示恒星相对于质心的位置矢量：\n$$\\vec{r}_{\\star} = -\\frac{m_p}{M_{\\star} + m_p}\\vec{a}$$\n对于圆形轨道，分离矢量的大小是恒定的，即 $|\\vec{a}| = a$，也就是半长轴。因此，恒星围绕质心做半径为 $a_{\\star}$ 的圆周运动，其半径由下式给出：\n$$a_{\\star} = |\\vec{r}_{\\star}| = \\frac{m_p}{M_{\\star} + m_p}a$$\n行星施加于恒星的引力为恒星的轨道运动提供了所需的向心力。然而，分析等效的单体问题更为直接，其中约化质量 $\\mu = \\frac{M_{\\star}m_p}{M_{\\star}+m_p}$ 在距离 $a$ 处围绕总质量 $M_{\\mathrm{tot}} = M_{\\star} + m_p$ 运行。引力由牛顿定律给出：\n$$F_g = \\frac{G M_{\\star} m_p}{a^2}$$\n这个力为系统提供了向心加速度。使用相对坐标系，运动方程为 $F_g = \\mu a_{\\mathrm{rel}}$，其中 $a_{\\mathrm{rel}}$ 是相对加速度。对于角速度为 $\\omega$ 的圆形轨道，相对加速度的大小为 $\\omega^2 a$。\n$$\\frac{G M_{\\star} m_p}{a^2} = \\left(\\frac{M_{\\star} m_p}{M_{\\star} + m_p}\\right) \\omega^2 a$$\n解出 $\\omega^2$ 得到双体系统的开普勒第三定律：\n$$\\omega^2 = \\frac{G(M_{\\star} + m_p)}{a^3}$$\n恒星以相同的角速度 $\\omega$ 围绕质心运行。因此，恒星轨道速度的大小 $v_{\\star}$ 为：\n$$v_{\\star} = \\omega a_{\\star} = \\sqrt{\\frac{G(M_{\\star} + m_p)}{a^3}} \\left(\\frac{m_p}{M_{\\star} + m_p}a\\right)$$\n简化这个表达式，我们得到：\n$$v_{\\star} = \\frac{m_p \\sqrt{G(M_{\\star} + m_p)} a}{\\sqrt{a^3} (M_{\\star} + m_p)} = \\frac{m_p \\sqrt{G}}{\\sqrt{a} \\sqrt{M_{\\star} + m_p}} = m_p \\sqrt{\\frac{G}{a(M_{\\star} + m_p)}}$$\n视向径向速度 $v_r(t)$ 是恒星轨道速度矢量 $\\vec{v}_{\\star}(t)$ 在观测者视线方向上的分量。轨道倾角 $i$ 是轨道平面法线与视线之间的夹角。对于圆形轨道，速度矢量 $\\vec{v}_{\\star}(t)$ 的大小 $v_{\\star}$ 恒定，并在轨道平面内旋转。沿视线方向的分量随时间呈正弦变化。这个分量的最大值，即径向速度半振幅 $K$，由下式给出：\n$$K = v_{\\star} \\sin i$$\n恒星径向速度随时间变化的完整表达式是 $v_r(t) = K \\cos(\\omega t + \\phi)$，其中 $\\phi$ 是一个相位常数。问题要求 $v_r(t)$ 的表达式和半振幅 $K$。\n半振幅的表达式为：\n$$K = \\left(m_p \\sqrt{\\frac{G}{a(M_{\\star} + m_p)}}\\right) \\sin i$$\n恒星的视向径向速度作为时间的函数是：\n$$v_r(t) = \\left(m_p \\sin i \\sqrt{\\frac{G}{a(M_{\\star} + m_p)}}\\right) \\cos\\left(\\sqrt{\\frac{G(M_{\\star} + m_p)}{a^3}} t + \\phi\\right)$$\n现在，我们对半振幅 $K$ 进行数值计算。给定值为：\n$M_{\\star} = 1\\,M_{\\odot} = 1.98847\\times 10^{30}\\,\\mathrm{kg}$\n$m_{p} = 1\\,M_{\\mathrm{J}} = 1.89813\\times 10^{27}\\,\\mathrm{kg}$\n$a = 1\\,\\mathrm{AU} = 1.495978707\\times 10^{11}\\,\\mathrm{m}$\n$i = \\pi/2$，所以 $\\sin i = \\sin(\\pi/2) = 1$\n$G = 6.67430\\times 10^{-11}\\,\\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$\n\n首先，计算总质量 $M_{\\star} + m_p$:\n$$M_{\\star} + m_p = 1.98847\\times 10^{30}\\,\\mathrm{kg} + 1.89813\\times 10^{27}\\,\\mathrm{kg} = 1.99036813\\times 10^{30}\\,\\mathrm{kg}$$\n接下来，我们计算项 $a(M_{\\star} + m_p)$:\n$$a(M_{\\star} + m_p) = (1.495978707\\times 10^{11}\\,\\mathrm{m}) \\times (1.99036813\\times 10^{30}\\,\\mathrm{kg}) \\approx 2.977543\\times 10^{41}\\,\\mathrm{kg \\cdot m}$$\n现在我们计算平方根内的项：\n$$\\frac{G}{a(M_{\\star} + m_p)} = \\frac{6.67430\\times 10^{-11}\\,\\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}}{2.977543\\times 10^{41}\\,\\mathrm{kg \\cdot m}} \\approx 2.24158\\times 10^{-52}\\,\\mathrm{m^2\\,kg^{-2}\\,s^{-2}}$$\n取平方根：\n$$\\sqrt{\\frac{G}{a(M_{\\star} + m_p)}} \\approx \\sqrt{2.24158\\times 10^{-52}\\,\\mathrm{m^2\\,kg^{-2}\\,s^{-2}}} \\approx 1.49719\\times 10^{-26}\\,\\mathrm{m\\,kg^{-1}\\,s^{-1}}$$\n最后，我们计算 $K$:\n$$K = m_p \\sin i \\sqrt{\\frac{G}{a(M_{\\star} + m_p)}} = (1.89813\\times 10^{27}\\,\\mathrm{kg}) \\times 1 \\times (1.49719\\times 10^{-26}\\,\\mathrm{m\\,kg^{-1}\\,s^{-1}})$$\n$$K \\approx 28.418\\,\\mathrm{m/s}$$\n四舍五入到三位有效数字，径向速度半振幅为 $28.4\\,\\mathrm{m/s}$。\n\n关于可探测性，一个半振幅为 $K \\approx 28.4\\,\\mathrm{m/s}$ 的径向速度信号完全在现代高精度摄谱仪的探测能力范围之内。像高精度径向速度行星搜索器（HARPS）这样的仪器可以达到约 $1\\,\\mathrm{m/s}$ 的长期精度，而像 ESPRESSO 这样更新的摄谱仪旨在达到 $10\\,\\mathrm{cm/s}$ 的精度。因此，这种量级的信号将被认为是环绕轨道运行的系外行星的一个强烈且易于探测的特征信号。在类日恒星周围发现的第一颗系外行星，飞马座51b ($51\\,\\mathrm{Pegasi\\,b}$)，引起的径向速度变化的半振幅约为 $56\\,\\mathrm{m/s}$。木星在太阳的速度中引起约 $12.4\\,\\mathrm{m/s}$ 的变化。因此，计算出的信号非常显著。",
            "answer": "$$\n\\boxed{28.4}\n$$"
        },
        {
            "introduction": "虽然圆形轨道产生简单的正弦径向速度信号，但大多数系外行星遵循偏心轨道，从而导致更复杂的曲线。为了对这些曲线进行建模，我们必须求解开普勒方程，这是连接时间与轨道位置的天体力学基石。本练习将让你实现并分析用于求解这一基本方程的数值方法，从而深入了解径向速度建模的计算核心。",
            "id": "4184031",
            "problem": "考虑在系外行星探测的径向速度 (RV) 方法中，推断一个恒星-行星系统的轨道相位任务。其核心计算子问题是求解椭圆轨道的Kepler方程，\n$$\nM = E - e\\sin E,\n$$\n其中 $M$ 是平近点角，$E$ 是偏近点角，$e$ 是轨道离心率，满足 $0 \\le e  1$。角度必须以弧度处理。\n\n你的任务是：\n\n1. 从求根问题 $$f(E) = E - e\\sin E - M,$$ 的定义出发，仅使用基础微积分和成熟的数值分析理论，推导一个基于 Newton–Raphson 方法的迭代格式，用于在给定 $M$ 和 $e$ 的情况下求解 $E$。不要直接使用预先给出的迭代公式；而是从基本原理出发推导迭代规则。\n\n2. 通过将Kepler方程重排为 $$E = g(E)$$ 的形式，推导一个不动点迭代法，并论证该映射在何种情况下是 $\\mathbb{R}$ 上的一个压缩映射，从而保证全局收敛。明确说明保证收敛的条件，包括任何所需的界。\n\n3. 使用一个依赖于 $f(E)$、$f'(E)$ 以及 $f'(E)$ 在初始猜测值邻域内的 Lipschitz 界的标准一维 Kantorovich 型界，为 Newton–Raphson 方法的保证收敛提供一个可计算的充分条件。\n\n4. 实现一个程序，该程序：\n   - 使用 Newton–Raphson 方法计算 $E$，其初始猜测值根据第一性原理选择（在解答中说明你的选择动机）。\n   - 使用不动点迭代法计算 $E$。\n   - 在选定的初始猜测值处，评估 Newton–Raphson 方法收敛的充分条件。\n   - 对两种方法均使用停止准则 $\\lvert f(E)\\rvert \\le 1\\times 10^{-12}$。\n   - Newton–Raphson 方法最多使用 $50$ 次迭代，不动点迭代法最多使用 $10000$ 次迭代。\n   - 角度单位为弧度，所有计算必须以弧度进行。\n\n5. 测试套件。对以下科学上合理的测试用例（角度单位为弧度）运行你的实现：\n   - 用例 A (理想情况): $e = 0.1$, $M = 1.0$。\n   - 用例 B (圆形边界): $e = 0.0$, $M = 2.0$。\n   - 用例 C (高离心率, 接近远心点): $e = 0.9$, $M = 3.1$。\n   - 用例 D (边界平近点角): $e = 0.7$, $M = 0.0$。\n   - 用例 E (接近 $2\\pi$): $e = 0.5$, $M = 6.0$。\n\n6. 输出规范。对每个测试用例，生成一个包含以下内容的三元组：\n   - Newton–Raphson 解 $E_{\\mathrm{NR}}$ (一个以弧度为单位的浮点数)，\n   - 不动点迭代解 $E_{\\mathrm{FP}}$ (一个以弧度为单位的浮点数)，\n   - 一个布尔值，指示在选定的初始猜测值处，Kantorovich 型充分条件是否满足。\n   将所有测试用例的结果，按上述顺序列出，聚合成单行输出，形式为方括号内包含的逗号分隔列表，其中条目按测试用例排序，每个用例内按方法排序，然后是布尔值。例如，输出必须具有以下形式：\n$$\n[ E_{\\mathrm{NR},A}, E_{\\mathrm{FP},A}, \\text{bool}_A, E_{\\mathrm{NR},B}, E_{\\mathrm{FP},B}, \\text{bool}_B, \\dots, E_{\\mathrm{NR},E}, E_{\\mathrm{FP},E}, \\text{bool}_E ].\n$$\n所有角度必须以弧度为单位，作为浮点数报告，布尔值必须是字面量 $\\text{True}$ 或 $\\text{False}$。\n\n你的程序必须是自包含的，不需要任何输入，并严格遵守指定的输出格式。",
            "solution": "该问题要求推导、分析并实现数值方法，以在给定平近点角 $M$ 和轨道离心率 $e$ 的情况下，求解Kepler方程 $M = E - e\\sin E$，从而得到偏近点角 $E$。\n\n求根问题由函数 $f(E) = E - e\\sin E - M = 0$ 定义。所有涉及角度的计算和变量解释都必须以弧度为单位，离心率限制在 $0 \\le e  1$。\n\n### 1. Newton-Raphson 迭代格式的推导\n\nNewton-Raphson 方法是一种求根算法，它能为实值函数的根生成一系列越来越精确的近似值。对于函数 $f(x)$，求根的通用迭代公式为：\n$$\nx_{k+1} = x_k - \\frac{f(x_k)}{f'(x_k)}\n$$\n为将此方法应用于Kepler方程，我们首先定义函数 $f(E)$ 并求其关于 $E$ 的导数。\n函数给出如下：\n$$\nf(E) = E - e\\sin E - M\n$$\n其导数 $f'(E)$ 通过基础微积分求得：\n$$\nf'(E) = \\frac{d}{dE}(E - e\\sin E - M) = 1 - e\\cos E\n$$\n保证收敛性和稳定性的一个关键性质是 $f'(E)$ 永不为零。由于离心率 $e$ 严格小于 $1$ ($0 \\le e  1$) 且 $|\\cos E| \\le 1$，$f'(E)$ 的最小值为 $1 - e$，该值严格为正。因此，绝不会有除以零的风险。\n\n将 $f(E)$ 和 $f'(E)$ 代入通用的 Newton-Raphson 公式，我们得到求解Kepler方程的具体迭代格式：\n$$\nE_{k+1} = E_k - \\frac{E_k - e\\sin E_k - M}{1 - e\\cos E_k}\n$$\n这个公式允许我们根据当前的近似值 $E_k$ 计算下一个近似值 $E_{k+1}$。\n\n### 2. 不动点迭代的推导与收敛性\n\n不动点迭代通过迭代 $x_{k+1} = g(x_k)$ 来寻找形如 $x = g(x)$ 的方程的解。为了推导这样的格式，我们将Kepler方程 $M = E - e\\sin E$ 重新整理，将 $E$ 单独置于一侧：\n$$\nE = M + e\\sin E\n$$\n这为我们提供了一个对函数 $g(E)$ 的自然选择：\n$$\ng(E) = M + e\\sin E\n$$\n相应的不动点迭代格式是：\n$$\nE_{k+1} = M + e\\sin E_k\n$$\n为了论证该迭代何时保证收敛，我们使用 Banach 不动点定理（或压缩映射原理）。该定理指出，如果 $g$ 是一个完备度量空间上的压缩映射，那么它有一个唯一的不动点，并且对于该空间中的任何初始猜测值 $E_0$，迭代 $E_{k+1} = g(E_k)$ 都将收敛到这个不动点。\n\n对于一个定义在某个区间上的实值函数 $g(E)$，如果其导数的绝对值被一个小于 $1$ 的常数一致地界定，即存在一个常数 $L$ 使得对于定义域中所有的 $E$，都有 $|g'(E)| \\le L  1$，那么它就是一个压缩映射。\n让我们计算 $g(E)$ 的导数：\n$$\ng'(E) = \\frac{d}{dE}(M + e\\sin E) = e\\cos E\n$$\n为了找到 $|g'(E)|$ 的界，我们取其绝对值：\n$$\n|g'(E)| = |e\\cos E| = |e||\\cos E|\n$$\n由于给定的离心率满足 $0 \\le e  1$，并且余弦函数有界 $|\\cos E| \\le 1$，我们有：\n$$\n|g'(E)| \\le e \\cdot 1 = e\n$$\n问题陈述 $0 \\le e  1$。因此，对于所有实数 $E$，我们有 $|g'(E)| \\le e  1$。这意味着 $g(E) = M + e\\sin E$ 是整个实数轴 $\\mathbb{R}$ 上的一个压缩映射。因此，根据 Banach 不动点定理，只要 $0 \\le e  1$，不动点迭代 $E_{k+1} = M + e\\sin E_k$ 对于任何实数初始猜测值 $E_0$ 都保证收敛到Kepler方程的唯一解。\n\n### 3. Newton-Raphson 收敛的可计算充分条件\n\nKantorovich 定理为 Newton-Raphson 方法从给定起始点 $E_0$ 开始的收敛性提供了一个充分条件。该定理的一个一维版本指出，如果对于初始猜测值 $E_0$ 以下不等式成立：\n$$\nh = |f'(E_0)^{-1} f(E_0)| \\cdot L \\cdot |f'(E_0)^{-1}| \\le \\frac{1}{2}\n$$\n其中 $L$ 是 $f'(E)$ 在解的一个邻域内的 Lipschitz 常数。Lipschitz 条件意味着 $|f'(x) - f'(y)| \\le L|x-y|$。满足此条件的一个充分条件是二阶导数有界，即 $L \\ge |f''(E)|$。\n\n让我们求函数 $f(E)$ 的二阶导数：\n$$\nf'(E) = 1 - e\\cos E\n$$\n$$\nf''(E) = \\frac{d}{dE}(1 - e\\cos E) = e\\sin E\n$$\n在 $\\mathbb{R}$ 上，二阶导数有界 $|f''(E)| = |e\\sin E| \\le |e| = e$。因此，我们可以选择 Lipschitz 常数 $L = e$。\n\n将我们的函数和 Lipschitz 常数 $L=e$ 代入 Kantorovich 条件：\n$$\nh = \\frac{|f(E_0)|}{|f'(E_0)|} \\cdot e \\cdot \\frac{1}{|f'(E_0)|} = \\frac{e |f(E_0)|}{(f'(E_0))^2} \\le \\frac{1}{2}\n$$\n（我们使用 $(f'(E_0))^2$ 而不是 $|f'(E_0)|^2$ 是因为 $f'(E) = 1 - e\\cos E > 0$）。\n代入 $f(E_0)$ 和 $f'(E_0)$ 的表达式：\n$$\n\\frac{e |E_0 - e\\sin E_0 - M|}{(1 - e\\cos E_0)^2} \\le \\frac{1}{2}\n$$\n这就是保证 Newton-Raphson 方法收敛的可计算充分条件。\n\n### 4. 实现选择\n\n**初始猜测值 ($E_0$):** 对于两种迭代方法，一个精心选择的初始猜测值对效率很重要。对于Kepler方程，如果离心率 $e$ 为 $0$，方程简化为 $E = M$。这提供了一个有物理动机且简单的初步近似。因此，我们将使用初始猜测值：\n$$\nE_0 = M\n$$\n这个选择是稳健的，尤其是在低离心率的情况下，并且可作为一个标准基线。\n\n**$E_0=M$ 处的 Kantorovich 条件:** 选择了 $E_0=M$ 后，上面推导出的充分条件变得具体且易于计算。\n我们在 $E_0=M$ 处计算 $f(E_0)$ 和 $f'(E_0)$：\n$$\nf(M) = M - e\\sin M - M = -e\\sin M\n$$\n$$\nf'(M) = 1 - e\\cos M\n$$\n将这些代入条件中：\n$$\n\\frac{e |-e\\sin M|}{(1 - e\\cos M)^2} \\le \\frac{1}{2}\n$$\n$$\n\\frac{e^2 |\\sin M|}{(1 - e\\cos M)^2} \\le \\frac{1}{2}\n$$\n这就是在选定的初始猜测值 $E_0=M$ 处，将为每个测试用例评估的具体布尔条件。\n\n**停止准则:** 按照规定，两种算法都将在Kepler方程的残差量级低于容差 $\\epsilon = 1 \\times 10^{-12}$ 时终止。也就是说，如果 $|f(E_k)| = |E_k - e\\sin E_k - M| \\le 1 \\times 10^{-12}$，则估计值 $E_k$ 被接受为解。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves Kepler's equation using Newton-Raphson and fixed-point iteration methods\n    for a suite of test cases and evaluates a Kantorovich-type sufficient condition\n    for Newton-Raphson convergence.\n    \"\"\"\n\n    # Test cases: (e, M)\n    test_cases = [\n        (0.1, 1.0),  # Case A: Happy path\n        (0.0, 2.0),  # Case B: Circular boundary\n        (0.9, 3.1),  # Case C: High eccentricity, near apocenter\n        (0.7, 0.0),  # Case D: Boundary mean anomaly\n        (0.5, 6.0)   # Case E: Near 2*pi\n    ]\n\n    results = []\n    \n    # Define constants for the solvers\n    TOLERANCE = 1.0e-12\n    NR_MAX_ITER = 50\n    FP_MAX_ITER = 10000\n\n    def kepler_f(E, e, M):\n        \"\"\"The function f(E) = E - e*sin(E) - M for which we seek the root.\"\"\"\n        return E - e * np.sin(E) - M\n\n    def kepler_f_prime(E, e):\n        \"\"\"The derivative f'(E) = 1 - e*cos(E).\"\"\"\n        return 1.0 - e * np.cos(E)\n\n    def compute_nr(e, M):\n        \"\"\"Computes eccentric anomaly E using Newton-Raphson.\"\"\"\n        # Initial guess E_0 = M.\n        # This is a good first-order approximation, as E=M for e=0.\n        E = float(M)\n\n        for _ in range(NR_MAX_ITER):\n            f_val = kepler_f(E, e, M)\n            if np.abs(f_val) = TOLERANCE:\n                return E\n            \n            f_prime_val = kepler_f_prime(E, e)\n            # Since 0 = e  1, f_prime_val = 1 - e*cos(E) >= 1 - e > 0.\n            # No division-by-zero check is necessary.\n            E = E - f_val / f_prime_val\n        \n        # Return the last computed value if max iterations are reached\n        return E\n\n    def compute_fp(e, M):\n        \"\"\"Computes eccentric anomaly E using fixed-point iteration.\"\"\"\n        # Initial guess E_0 = M.\n        # As per the derivation, convergence is guaranteed for any E_0.\n        E = float(M)\n\n        # The loop must check the condition on f(E), not on the step size.\n        # So we check f(E) before computing the next E.\n        for _ in range(FP_MAX_ITER):\n            if np.abs(kepler_f(E, e, M)) = TOLERANCE:\n                return E\n            \n            # The fixed-point update rule: E_{k+1} = M + e*sin(E_k)\n            E = M + e * np.sin(E)\n        \n        # Return the last computed value if max iterations are reached\n        # One final check on the final value\n        if np.abs(kepler_f(E, e, M)) = TOLERANCE:\n            return E\n        # Failed to converge within max iterations to the required tolerance.\n        # Although theoretically guaranteed, this indicates slow convergence.\n        # Returning the last value as per problem structure.\n        return E\n\n    def check_kantorovich(e, M):\n        \"\"\"\n        Checks the sufficient condition for Newton-Raphson convergence\n        for the initial guess E_0 = M.\n        Condition: e^2 * |sin(M)| / (1 - e*cos(M))^2 = 0.5\n        \"\"\"\n        # For e=0, the condition is 0 = 0.5, which is True.\n        if e == 0.0:\n            return True\n\n        E0 = float(M)\n        numerator = e**2 * np.abs(np.sin(E0))\n        denominator = (1.0 - e * np.cos(E0))**2\n\n        # Denominator is guaranteed to be non-zero for e  1.\n        h = numerator / denominator\n        return h = 0.5\n\n    for e, M in test_cases:\n        e_nr = compute_nr(e, M)\n        e_fp = compute_fp(e, M)\n        kantorovich_satisfied = check_kantorovich(e, M)\n        \n        results.extend([e_nr, e_fp, kantorovich_satisfied])\n\n    # Format the output as a single comma-separated list in brackets\n    # Boolean values are automatically converted to \"True\" or \"False\" by str()\n    output_str = \"[\" + \",\".join(map(str, results)) + \"]\"\n    print(output_str)\n\nsolve()\n\n```"
        },
        {
            "introduction": "径向速度法的一个关键限制是它只能测量行星的最小质量 $M_{p}\\sin i$，因为轨道倾角 $i$ 是未知的。为了从这个测量值推断行星的真实质量 $M_{p}$，我们必须转向统计推理。这项练习将探讨如何从第一性原理推导倾角的概率分布，并用它来计算行星真实质量超过某一阈值的可能性，这是系外行星统计学中的一项基本技能。",
            "id": "4184037",
            "problem": "一颗类日恒星展现出周期性的多普勒摆动，这是通过视向速度（RV）法探测到的。测量得到的伴星最小质量为乘积 $M_{p}\\sin i$，其中 $M_{p}$ 是行星的真实质量，而 $i$ 是相对于视线的轨道倾角。假设系外行星系统的轨道角动量矢量在空间中是随机取向的（各向同性），$M_{p}\\sin i$ 的测量不确定度可以忽略不计，并且视向速度信号仅取决于 $\\sin i$，因此 $i$ 和 $\\pi - i$ 是简并的。角度以弧度为单位。\n\n1. 根据各向同性假设和球体几何学，推导轨道倾角 $i$ 的先验概率密度 $p(i)$，其中 $i$ 的取值范围限定在 $i \\in [0,\\pi/2]$。\n\n2. 对于一个测得 $M_{p}\\sin i = 20\\,M_{\\oplus}$ 的特定系统（其中 $M_{\\oplus}$ 表示地球质量），使用您推导出的先验概率，计算其真实质量超过 $30\\,M_{\\oplus}$ 的概率。将最终概率表示为四舍五入到四位有效数字的小数。不要使用百分号。",
            "solution": "该问题陈述经评估具有科学依据、问题明确、客观且自洽。它基于系外行星学中视向速度法的既定原理以及统计各向同性的标准假设。所有提供的数据和条件都是一致的，并且足以进行严格的数学求解。因此，该问题被认定为 **有效**。\n\n该问题分为两部分。首先，我们必须在各向同性取向的假设下，推导轨道倾角的先验概率密度函数（PDF）$p(i)$。其次，我们应用此PDF来计算给定系外行星系统的特定概率。\n\n**第一部分：先验概率密度 $p(i)$ 的推导**\n\n轨道角动量矢量在空间中随机取向（各向同性）的假设意味着，该矢量的方向在球面上呈均匀概率分布。设从观测者到恒星的视线定义为球坐标系的 $z$ 轴。倾角 $i$ 是轨道角动量矢量与视线之间的夹角，对应于该坐标系中的极角。\n\n对应于单位球面上一小块面积的立体角微元 $d\\Omega$ 由下式给出：\n$$d\\Omega = \\sin(i) \\, di \\, d\\phi$$\n其中 $i$ 是极角（倾角），$\\phi$ 是方位角。这些角度的取值范围是 $i \\in [0, \\pi]$ 和 $\\phi \\in [0, 2\\pi)$。\n\n对于球面上的均匀分布，矢量指向给定立体角 $d\\Omega$ 的概率与该立体角的大小成正比。一个球面的总立体角为 $4\\pi$ 球面度。因此，关于立体角的概率密度是一个常数，$p(\\Omega) = \\frac{1}{4\\pi}$。在立体角微元 $d\\Omega$ 内找到该矢量的概率 $dP$ 为：\n$$dP = p(\\Omega) \\, d\\Omega = \\frac{1}{4\\pi} \\sin(i) \\, di \\, d\\phi$$\n\n为了求出倾角 $i$ 的概率密度函数，我们对所有可能的方位角 $\\phi$ 值（从 $0$ 到 $2\\pi$）进行积分。倾角在 $i$ 和 $i+di$ 之间的概率，记为 $p_{\\text{full}}(i)di$，是：\n$$p_{\\text{full}}(i)di = \\int_{0}^{2\\pi} \\frac{1}{4\\pi} \\sin(i) \\, di \\, d\\phi = \\frac{\\sin(i)di}{4\\pi} \\int_{0}^{2\\pi} d\\phi = \\frac{\\sin(i)di}{4\\pi} (2\\pi) = \\frac{1}{2}\\sin(i)di$$\n因此，对于倾角的完整范围 $i \\in [0, \\pi]$，其概率密度函数为 $p_{\\text{full}}(i) = \\frac{1}{2}\\sin(i)$。\n\n问题陈述中提到，对于倾角 $i$ 和 $\\pi - i$，视向速度的测量是简并的，因为观测到的速度取决于 $\\sin(i)$，而 $\\sin(i) = \\sin(\\pi - i)$。按照惯例，我们将分析限制在定义域 $i \\in [0, \\pi/2]$ 内。在这个受限域内，观测到倾角在一个小区间 $[i, i+di]$ 内的概率，是真实倾角在 $[i, i+di]$ 或 $[\\pi-i, \\pi-i+di]$ 内的概率之和。\n设 $p(i)$ 为受限域 $i \\in [0, \\pi/2]$ 的概率密度函数。那么：\n$$p(i)di = p_{\\text{full}}(i)di + p_{\\text{full}}(\\pi-i)di = \\frac{1}{2}\\sin(i)di + \\frac{1}{2}\\sin(\\pi-i)di$$\n由于 $\\sin(i) = \\sin(\\pi - i)$，上式可简化为：\n$$p(i)di = \\frac{1}{2}\\sin(i)di + \\frac{1}{2}\\sin(i)di = \\sin(i)di$$\n所以，对于 $i \\in [0, \\pi/2]$，概率密度函数为 $p(i) = \\sin(i)$。\n\n我们验证此概率密度函数在其定义域上是正确归一化的：\n$$\\int_{0}^{\\pi/2} p(i) \\, di = \\int_{0}^{\\pi/2} \\sin(i) \\, di = [-\\cos(i)]_{0}^{\\pi/2} = -\\cos\\left(\\frac{\\pi}{2}\\right) - (-\\cos(0)) = -0 - (-1) = 1$$\n该概率密度函数已正确归一化。因此，倾角 $i \\in [0, \\pi/2]$ 的先验概率密度为 $p(i) = \\sin(i)$。\n\n**第二部分：概率计算**\n\n给定一个系统的最小质量测量值为 $M_{p}\\sin i = 20\\,M_{\\oplus}$。我们需要计算其真实质量 $M_{p}$ 超过 $30\\,M_{\\oplus}$ 的概率。\n\n真实质量 $M_{p}$ 可以用测量值和倾角 $i$ 表示为：\n$$M_{p} = \\frac{20\\,M_{\\oplus}}{\\sin i}$$\n条件 $M_{p}  30\\,M_{\\oplus}$ 可以转化为关于倾角 $i$ 的条件：\n$$\\frac{20\\,M_{\\oplus}}{\\sin i}  30\\,M_{\\oplus}$$\n$$\\frac{20}{30}  \\sin i$$\n$$\\sin i  \\frac{2}{3}$$\n由于我们处于定义域 $i \\in [0, \\pi/2]$，正弦函数是单调递增的。不等式 $\\sin i  2/3$ 等价于 $0 \\le i  \\arcsin(2/3)$。\n\n因此，概率 $P(M_{p}  30\\,M_{\\oplus})$ 就是倾角 $i$ 位于区间 $[0, \\arcsin(2/3))$ 内的概率。我们可以通过在该区间上对概率密度函数 $p(i) = \\sin(i)$ 进行积分来求得此概率：\n$$P(M_{p}  30\\,M_{\\oplus}) = P\\left(0 \\le i  \\arcsin\\left(\\frac{2}{3}\\right)\\right) = \\int_{0}^{\\arcsin(2/3)} \\sin(i) \\, di$$\n计算该积分：\n$$P = [-\\cos(i)]_{0}^{\\arcsin(2/3)} = -\\cos\\left(\\arcsin\\left(\\frac{2}{3}\\right)\\right) - (-\\cos(0))$$\n我们知道 $\\cos(0) = 1$。为了计算 $\\cos(\\arcsin(2/3))$，我们使用三角恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$，对于第一象限的 $\\theta$，这意味着 $\\cos(\\theta) = \\sqrt{1 - \\sin^2(\\theta)}$。由于 $i = \\arcsin(2/3)$ 位于 $[0, \\pi/2]$，其对应的余弦值为正。\n设 $\\theta = \\arcsin(2/3)$，因此 $\\sin(\\theta) = 2/3$。\n$$\\cos\\left(\\arcsin\\left(\\frac{2}{3}\\right)\\right) = \\sqrt{1 - \\left(\\frac{2}{3}\\right)^2} = \\sqrt{1 - \\frac{4}{9}} = \\sqrt{\\frac{5}{9}} = \\frac{\\sqrt{5}}{3}$$\n将此结果代回概率计算中：\n$$P = -\\frac{\\sqrt{5}}{3} - (-1) = 1 - \\frac{\\sqrt{5}}{3}$$\n现在，我们计算数值并四舍五入到四位有效数字。\n使用 $\\sqrt{5} \\approx 2.2360679...$：\n$$P \\approx 1 - \\frac{2.2360679}{3} \\approx 1 - 0.7453559... \\approx 0.2546440...$$\n四舍五入到四位有效数字，我们得到 $0.2546$。",
            "answer": "$$\\boxed{0.2546}$$"
        }
    ]
}