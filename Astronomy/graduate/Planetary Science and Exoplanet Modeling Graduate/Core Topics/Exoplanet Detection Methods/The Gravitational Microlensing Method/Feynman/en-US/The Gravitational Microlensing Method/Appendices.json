{
    "hands_on_practices": [
        {
            "introduction": "The foundational scale of any gravitational microlensing event is the angular Einstein radius, $\\theta_E$. This exercise guides you through its derivation from the first principles of light deflection in General Relativity. By calculating $\\theta_E$ for a typical stellar lens in the Milky Way, you will gain a quantitative understanding of the term 'microlensing' and appreciate why these events are observed through photometric magnification rather than resolved images .",
            "id": "4182103",
            "problem": "A point-mass gravitational microlens in the Milky Way deflects light according to General Relativity (GR). Consider a source star at distance $D_S = 8\\,\\mathrm{kpc}$ behind a lens of mass $M = 0.3\\,M_{\\odot}$ located at $D_L = 6\\,\\mathrm{kpc}$. Work within the thin-lens, small-angle approximation and assume a static, weak-field point-mass lens in flat space appropriate for Galactic scales. Use the following foundational elements as your starting point: (i) the GR light deflection by a point mass at impact parameter $b$, $\\hat{\\alpha} = 4GM/(c^2 b)$, and (ii) the small-angle lens geometry in which the reduced deflection angle is $\\alpha = (D_{LS}/D_S)\\,\\hat{\\alpha}$ with $D_{LS} = D_S - D_L$, and all angles are related to physical distances by $b \\approx D_L \\,\\theta$.\n\n1. Derive from these bases the expression for the angular Einstein radius $\\theta_E$ for perfect source-lens-observer alignment. Then evaluate $\\theta_E$ numerically for $M=0.3\\,M_{\\odot}$, $D_L=6\\,\\mathrm{kpc}$, and $D_S=8\\,\\mathrm{kpc}$.\n\n2. Express the final numerical value of $\\theta_E$ in milliarcseconds (milliarcsecond (mas)). Round your answer to three significant figures.\n\n3. Briefly assess, in words, whether the corresponding Einstein ring or the individual micro-images would be directly resolvable with typical ground-based seeing-limited angular resolution of order $0.7$–$1.0\\,\\mathrm{arcsec}$ full width at half maximum (FWHM). Your assessment is not part of the final numeric answer.",
            "solution": "The problem statement has been validated and is deemed scientifically sound, well-posed, and objective. It presents a standard problem in gravitational microlensing based on established principles of General Relativity in the weak-field limit. All necessary data and foundational equations are provided. We may therefore proceed with the solution.\n\nThe problem is structured in three parts: first, to derive the expression for the angular Einstein radius $\\theta_E$; second, to calculate its numerical value for the given parameters; and third, to assess its observability.\n\n**Part 1: Derivation and Numerical Evaluation of the Einstein Radius $\\theta_E$**\n\nThe lens equation relates the true angular position of the source, $\\beta$, to the apparent angular position of an image, $\\theta$. For a point-mass lens, the geometry is axially symmetric, and the scalar lens equation is given by:\n$$ \\beta = \\theta - \\alpha(\\theta) $$\nwhere $\\alpha(\\theta)$ is the reduced deflection angle, which depends on the image position $\\theta$.\n\nPerfect alignment of the source, lens, and observer corresponds to the case where the true source position is on the optical axis, i.e., $\\beta=0$. In this specific configuration, the lensed images form a perfect ring around the lens position, known as the Einstein ring. The angular radius of this ring is, by definition, the Einstein radius, $\\theta_E$.\n\nSetting $\\beta = 0$ and $\\theta = \\theta_E$ in the lens equation yields the condition for the Einstein radius:\n$$ \\theta_E = \\alpha(\\theta_E) $$\nThe problem provides the necessary relations to express $\\alpha(\\theta_E)$. The reduced deflection angle $\\alpha$ is related to the true GR deflection angle $\\hat{\\alpha}$ by:\n$$ \\alpha = \\frac{D_{LS}}{D_S} \\hat{\\alpha} $$\nwhere $D_S$ is the observer-source distance, $D_L$ is the observer-lens distance, and $D_{LS} = D_S - D_L$ is the lens-source distance.\n\nThe true deflection angle $\\hat{\\alpha}$ for a point mass $M$ at an impact parameter $b$ is given as:\n$$ \\hat{\\alpha} = \\frac{4GM}{c^2 b} $$\nwhere $G$ is the gravitational constant and $c$ is the speed of light.\n\nFinally, in the small-angle approximation, the impact parameter $b$ corresponding to an image at angle $\\theta$ is given by $b \\approx D_L \\theta$. For the Einstein ring, the impact parameter is $b_E = D_L \\theta_E$.\n\nWe can now substitute these expressions into the condition for $\\theta_E$. First, express $\\alpha$ in terms of $\\theta$:\n$$ \\hat{\\alpha}(\\theta) = \\frac{4GM}{c^2 (D_L \\theta)} $$\n$$ \\alpha(\\theta) = \\frac{D_{LS}}{D_S} \\left( \\frac{4GM}{c^2 D_L \\theta} \\right) = \\frac{4GM}{c^2} \\frac{D_{LS}}{D_L D_S} \\frac{1}{\\theta} $$\nNow, applying the condition $\\theta_E = \\alpha(\\theta_E)$:\n$$ \\theta_E = \\frac{4GM}{c^2} \\frac{D_{LS}}{D_L D_S} \\frac{1}{\\theta_E} $$\nSolving for $\\theta_E$ gives:\n$$ \\theta_E^2 = \\frac{4GM}{c^2} \\frac{D_{LS}}{D_L D_S} $$\nTaking the square root yields the desired expression for the angular Einstein radius:\n$$ \\theta_E = \\sqrt{\\frac{4GM}{c^2} \\frac{D_{LS}}{D_L D_S}} $$\nThis is the derived expression. We can substitute $D_{LS} = D_S - D_L$ to obtain the equivalent form:\n$$ \\theta_E = \\sqrt{\\frac{4GM}{c^2} \\frac{D_S - D_L}{D_L D_S}} $$\n\nNext, we evaluate this expression numerically. The given parameters are:\n- Lens mass: $M = 0.3\\,M_{\\odot}$\n- Lens distance: $D_L = 6\\,\\mathrm{kpc}$\n- Source distance: $D_S = 8\\,\\mathrm{kpc}$\n\nThis implies a lens-source distance of $D_{LS} = D_S - D_L = 2\\,\\mathrm{kpc}$. We use the following standard physical constants in SI units:\n- Gravitational constant: $G \\approx 6.674 \\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$\n- Speed of light: $c \\approx 2.998 \\times 10^8\\,\\mathrm{m\\,s^{-1}}$\n- Solar mass: $M_{\\odot} \\approx 1.989 \\times 10^{30}\\,\\mathrm{kg}$\n- Kiloparsec: $1\\,\\mathrm{kpc} \\approx 3.086 \\times 10^{19}\\,\\mathrm{m}$\n\nFirst, we convert the given quantities to SI units:\n- $M = 0.3 \\times (1.989 \\times 10^{30}\\,\\mathrm{kg}) = 5.967 \\times 10^{29}\\,\\mathrm{kg}$\n- $D_L = 6 \\times (3.086 \\times 10^{19}\\,\\mathrm{m}) = 1.8516 \\times 10^{20}\\,\\mathrm{m}$\n- $D_S = 8 \\times (3.086 \\times 10^{19}\\,\\mathrm{m}) = 2.4688 \\times 10^{20}\\,\\mathrm{m}$\n- $D_{LS} = 2 \\times (3.086 \\times 10^{19}\\,\\mathrm{m}) = 6.172 \\times 10^{19}\\,\\mathrm{m}$\n\nNow, we compute the two terms in the expression for $\\theta_E^2$:\nThe first term is the characteristic length scale associated with the lens mass:\n$$ \\frac{4GM}{c^2} = \\frac{4 \\times (6.674 \\times 10^{-11}) \\times (5.967 \\times 10^{29})}{(2.998 \\times 10^8)^2} \\approx 1.772 \\times 10^3\\,\\mathrm{m} $$\nThe second term is a geometric factor with units of inverse length:\n$$ \\frac{D_{LS}}{D_L D_S} = \\frac{6.172 \\times 10^{19}}{(1.8516 \\times 10^{20}) \\times (2.4688 \\times 10^{20})} \\approx 1.350 \\times 10^{-22}\\,\\mathrm{m^{-1}} $$\nNote that this geometric term can also be calculated as $\\frac{2\\,\\mathrm{kpc}}{6\\,\\mathrm{kpc} \\times 8\\,\\mathrm{kpc}} = \\frac{1}{24\\,\\mathrm{kpc}}$. Converting this to inverse meters: $\\frac{1}{24 \\times 3.086 \\times 10^{19}\\,\\mathrm{m}} \\approx 1.350 \\times 10^{-21}\\,\\mathrm{m^{-1}}$. There is a calculation error in the block above, let's re-verify. The calculation using kpc units is more direct and less prone to intermediate rounding errors.\nThe term is $\\frac{D_S - D_L}{D_L D_S} = \\frac{1}{D_L} - \\frac{1}{D_S}$. Let's recalculate the product of distances: $D_L D_S = (1.8516 \\times 10^{20}) \\times (2.4688 \\times 10^{20}) = 4.5719 \\times 10^{41}\\,\\mathrm{m^2}$. The ratio is $\\frac{6.172 \\times 10^{19}}{4.5719 \\times 10^{41}} = 1.350 \\times 10^{-22}\\,\\mathrm{m^{-1}}$. This confirms the first calculation. My check must have been flawed. Ah, the error is in thinking $(D_{LS})/(D_L D_S)$ is equal to $(2\\,\\mathrm{kpc})/(48\\,\\mathrm{kpc}^2)$, which is $(1/24)\\,\\mathrm{kpc}^{-1}$. Let's re-evaluate $1/24\\,\\mathrm{kpc}^{-1}$ in meters: $1/(24 \\times 3.086 \\times 10^{19}) = 1/(7.4064 \\times 10^{20}) = 1.350 \\times 10^{-21}\\,\\mathrm{m^{-1}}$.\nThe discrepancy arises from a common notational confusion. The term is $\\frac{D_{LS}}{D_L D_S}$, not $\\frac{D_{LS}}{D_L D_S}$ with distances in kpc. We have $\\frac{2 \\text{ kpc}}{48 \\text{ kpc}^2} = \\frac{1}{24} \\text{kpc}^{-1}$. This is the correct value. The calculation error must be in my initial product of SI distances. Let's recalculate $\\theta_E^2$ using the clearer formulation:\n$$ \\theta_E^2 = \\left(\\frac{4GM}{c^2}\\right) \\left(\\frac{1}{24\\,\\mathrm{kpc}}\\right) = (1.772 \\times 10^3\\,\\mathrm{m}) \\times (1.350 \\times 10^{-21}\\,\\mathrm{m^{-1}}) = 2.392 \\times 10^{-18} $$\nThis value is dimensionless, as required for an angle squared in radians.\nTaking the square root gives $\\theta_E$ in radians:\n$$ \\theta_E = \\sqrt{2.392 \\times 10^{-18}} \\approx 1.547 \\times 10^{-9}\\,\\mathrm{radians} $$\n\n**Part 2: Conversion to Milliarcseconds**\n\nThe final step is to convert this angle from radians to milliarcseconds (mas) and round to three significant figures. The conversion factors are:\n$1\\,\\mathrm{radian} = \\frac{180}{\\pi}\\,\\mathrm{degrees}$\n$1\\,\\mathrm{degree} = 3600\\,\\mathrm{arcseconds}$\n$1\\,\\mathrm{arcsecond} = 1000\\,\\mathrm{mas}$\nTherefore, $1\\,\\mathrm{radian} \\approx 206264.8\\,\\mathrm{arcseconds} = 2.062648 \\times 10^8\\,\\mathrm{mas}$.\n\n$$ \\theta_E (\\mathrm{mas}) = (1.547 \\times 10^{-9}\\,\\mathrm{rad}) \\times (2.062648 \\times 10^8\\,\\mathrm{mas/rad}) \\approx 0.31915\\,\\mathrm{mas} $$\nRounding to three significant figures, we get:\n$$ \\theta_E \\approx 0.319\\,\\mathrm{mas} $$\n\n**Part 3: Assessment of Resolvability**\n\nThe characteristic angular scale of this microlensing event is the diameter of the Einstein ring, $2\\theta_E \\approx 2 \\times 0.319\\,\\mathrm{mas} = 0.638\\,\\mathrm{mas}$. The problem states that typical ground-based seeing-limited angular resolution is of the order of $0.7$–$1.0\\,\\mathrm{arcsec}$. Converting this to milliarcseconds gives a seeing disk FWHM of $700$–$1000\\,\\mathrm{mas}$.\n\nThe angular size of the lensed images ($\\sim 0.6\\,\\mathrm{mas}$) is more than three orders of magnitude smaller than the atmospheric seeing limit ($\\sim 1000\\,\\mathrm{mas}$). Consequently, it is impossible to resolve the individual micro-images or the Einstein ring with a seeing-limited ground-based telescope. The observer would instead see a single, unresolved point of light whose apparent brightness is the sum of the brightnesses of the source and its lensed images. The primary observable effect of microlensing is this photometric magnification, which varies as the alignment between the source, lens, and observer changes over time. This is precisely why the phenomenon is termed *micro*lensing.",
            "answer": "$$\n\\boxed{0.319}\n$$"
        },
        {
            "introduction": "While single-star lensing provides a smooth, symmetric light curve, the true power of microlensing for exoplanet science lies in detecting perturbations caused by planetary companions. These companions create complex caustic structures, and a source star crossing a caustic produces a sharp, high-magnification spike in the light curve. This practice focuses on the kinematics of such a caustic crossing, allowing you to derive the crossing duration from the source star's size and trajectory, a crucial step in characterizing a potential planet .",
            "id": "4182049",
            "problem": "A planetary perturbation in a gravitational microlensing event produces a sharp fold caustic that a background source star crosses. Assume the caustic is locally well-approximated by a straight line over the duration of the crossing, the source star has a uniform surface brightness with angular radius $\\theta_{\\ast}$, and the lens-source geocentric relative proper motion is $\\mu_{\\rm rel}$ (an angular speed on the sky). Let $\\alpha$ be the angle, measured in the plane of the sky, between the source trajectory and the tangent to the caustic at the crossing point. Neglect any curvature of the caustic over the stellar diameter, lens orbital motion during the crossing, and microlens parallax effects.\n\nUsing only geometric reasoning and the definition of proper motion as an angular speed, derive from first principles an expression for the duration $t_{\\rm cc}$ between first and second contact of the stellar limb with the caustic (the full-disk caustic crossing duration) in terms of $\\theta_{\\ast}$, $\\mu_{\\rm rel}$, and $\\alpha$. Then evaluate your expression numerically for\n- $\\theta_{\\ast} = 1.2\\,\\mu\\mathrm{as}$ (microarcseconds, where $1\\,\\mu\\mathrm{as} = 10^{-6}\\,\\mathrm{arcsec}$),\n- $\\mu_{\\rm rel} = 6.0\\,\\mathrm{mas}\\,\\mathrm{yr}^{-1}$ (milliarcseconds per year, where $1\\,\\mathrm{mas} = 10^{-3}\\,\\mathrm{arcsec}$),\n- $\\alpha = 30.0^\\circ$ (degrees).\n\nExpress the final duration in hours and round your answer to three significant figures. Use $1\\,\\mathrm{yr} = 365.25\\,\\mathrm{days}$ and $1\\,\\mathrm{day} = 24\\,\\mathrm{hours}$. Do not assume any pre-packaged microlensing formula; start from basic kinematics and planar geometry. Your final answer must be a single real number.",
            "solution": "The problem is well-posed and scientifically sound, allowing for a direct solution based on first principles of geometry and kinematics. We are tasked with deriving an expression for the duration of a caustic crossing and then evaluating it numerically.\n\nLet us model the event in the plane of the sky. The caustic is approximated as a straight line. Let's set up a Cartesian coordinate system such that the caustic lies along the x-axis, so its equation is $y=0$. The source star is a circular disk of angular radius $\\theta_{\\ast}$. The center of the source star moves with a constant geocentric relative proper motion $\\mu_{\\text{rel}}$, which is an angular speed. The path of the star's center is a straight line, which we call the trajectory. This trajectory forms an angle $\\alpha$ with the caustic (the x-axis).\n\nThe caustic crossing duration, $t_{\\text{cc}}$, is the time interval between \"first contact\" and \"last contact\".\nFirst contact occurs when the leading limb of the stellar disk first touches the caustic line. At this instant, the center of the star is at a position $(x_1, y_1)$, and the disk is tangent to the line $y=0$. For a disk of radius $\\theta_{\\ast}$ centered at $(x_1, y_1)$ to be tangent to the line $y=0$, the perpendicular distance from the center to the line must be equal to the radius. Assuming the star is approaching from $y0$, first contact happens when the center is at a position where its y-coordinate is $y_1 = -\\theta_{\\ast}$. If it approaches from $y0$, then $y_1 = \\theta_{\\ast}$. In general, the perpendicular distance from the center to the caustic is $\\theta_{\\ast}$ at first contact.\n\nLast contact occurs when the trailing limb of the stellar disk leaves the caustic line. By a similar argument, at this moment, the star has completely crossed the caustic, and its disk is again tangent to the line $y=0$ but on the opposite side. The perpendicular distance from the center of the star to the caustic is again $\\theta_{\\ast}$.\n\nLet $d_{\\perp}$ be the total distance the star's center travels in the direction perpendicular to the caustic during the full crossing event. The center must move from a perpendicular distance of $\\theta_{\\ast}$ on one side of the caustic to a perpendicular distance of $\\theta_{\\ast}$ on the other side. Therefore, the total perpendicular distance traveled is $d_{\\perp} = \\theta_{\\ast} + \\theta_{\\ast} = 2\\theta_{\\ast}$.\n\nThe velocity of the star's center is a vector of magnitude $\\mu_{\\text{rel}}$ directed at an angle $\\alpha$ with respect to the caustic. We can decompose this velocity into two components: one parallel to the caustic, $\\mu_{\\parallel} = \\mu_{\\text{rel}} \\cos(\\alpha)$, and one perpendicular to the caustic, $\\mu_{\\perp} = \\mu_{\\text{rel}} \\sin(\\alpha)$. We must consider the absolute value, but since an angle between two lines is usually taken to be in $[0, 90^\\circ]$ or physics problems imply a geometry where $\\sin(\\alpha)$ is positive, we proceed with $\\sin(\\alpha)$. For $\\alpha=30.0^\\circ$, this is valid.\n\nThe duration of the crossing, $t_{\\text{cc}}$, is determined by the time it takes for the star to travel the perpendicular distance $d_{\\perp}$ at the perpendicular speed $\\mu_{\\perp}$.\n$$t_{\\text{cc}} = \\frac{d_{\\perp}}{\\mu_{\\perp}}$$\nSubstituting the expressions for $d_{\\perp}$ and $\\mu_{\\perp}$, we get:\n$$t_{\\text{cc}} = \\frac{2\\theta_{\\ast}}{\\mu_{\\text{rel}} \\sin(\\alpha)}$$\nThis is the symbolic expression for the full-disk caustic crossing duration, derived from first principles.\n\nNow, we evaluate this expression for the given numerical values:\n- Angular radius of the star: $\\theta_{\\ast} = 1.2\\,\\mu\\mathrm{as} = 1.2 \\times 10^{-6}\\,\\mathrm{arcsec}$.\n- Relative proper motion: $\\mu_{\\text{rel}} = 6.0\\,\\mathrm{mas}\\,\\mathrm{yr}^{-1} = 6.0 \\times 10^{-3}\\,\\mathrm{arcsec}\\,\\mathrm{yr}^{-1}$.\n- Crossing angle: $\\alpha = 30.0^\\circ$.\n\nFirst, we calculate $\\sin(\\alpha)$:\n$$\\sin(30.0^\\circ) = 0.5$$\n\nNext, we substitute the values into the derived formula for $t_{\\text{cc}}$:\n$$t_{\\text{cc}} = \\frac{2 \\times (1.2 \\times 10^{-6}\\,\\mathrm{arcsec})}{(6.0 \\times 10^{-3}\\,\\mathrm{arcsec}\\,\\mathrm{yr}^{-1}) \\times 0.5}$$\n$$t_{\\text{cc}} = \\frac{2.4 \\times 10^{-6}\\,\\mathrm{arcsec}}{3.0 \\times 10^{-3}\\,\\mathrm{arcsec}\\,\\mathrm{yr}^{-1}}$$\n$$t_{\\text{cc}} = 0.8 \\times 10^{-3}\\,\\mathrm{yr} = 8.0 \\times 10^{-4}\\,\\mathrm{yr}$$\n\nThe problem requires the final answer in hours. We use the given conversion factors:\n- $1\\,\\mathrm{yr} = 365.25\\,\\mathrm{days}$\n- $1\\,\\mathrm{day} = 24\\,\\mathrm{hours}$\n\nThe number of hours in one year is:\n$$1\\,\\mathrm{yr} = 365.25\\,\\mathrm{days} \\times 24\\,\\mathrm{hours/day} = 8766\\,\\mathrm{hours}$$\n\nNow, we convert $t_{\\text{cc}}$ from years to hours:\n$$t_{\\text{cc}} = (8.0 \\times 10^{-4}\\,\\mathrm{yr}) \\times (8766\\,\\mathrm{hours/yr})$$\n$$t_{\\text{cc}} = 7.0128\\,\\mathrm{hours}$$\n\nFinally, we round the result to three significant figures, as requested:\n$$t_{\\text{cc}} \\approx 7.01\\,\\mathrm{hours}$$",
            "answer": "$$\\boxed{7.01}$$"
        },
        {
            "introduction": "Interpreting real-world microlensing data requires confronting systematic effects that can corrupt parameter estimation. One of the most common challenges is flux blending, where unresolved light from stars near the source or lens contaminates the photometric measurements. This coding exercise simulates a scenario where a blended light curve is naively fit with a pure, unblended model, allowing you to quantify the resulting biases in the estimated Einstein timescale $t_E$ and impact parameter $u_0$ . This hands-on experience is critical for developing the skills needed to perform robust data analysis and avoid misinterpretation of microlensing events.",
            "id": "4182113",
            "problem": "You are tasked with quantifying parameter biases introduced by neglecting flux blending when fitting a Point Source Point Lens (PSPL) gravitational microlensing light curve. The PSPL magnification for a point source lensed by a single point mass is given by $A(u) = \\dfrac{u^2 + 2}{u \\sqrt{u^2 + 4}}$, where $u(t) = \\sqrt{u_0^2 + \\left(\\dfrac{t - t_0}{t_E}\\right)^2}$, $u_0$ is the minimum impact parameter, $t_0$ is the time of peak magnification, and $t_E$ is the Einstein timescale. The observed blended flux is $F(t) = F_s A(u(t)) + F_b$, where $F_s$ is the source flux and $F_b$ is the blended flux from unrelated sources. The baseline flux is $F_0 = F_s + F_b$, and the apparent baseline-normalized magnification is $\\tilde{A}(t) = \\dfrac{F(t)}{F_0} = 1 + s \\left(A(u(t)) - 1\\right)$, where $s = \\dfrac{F_s}{F_s + F_b} = 1 - g$ and $g = \\dfrac{F_b}{F_s + F_b}$ is the blend fraction.\n\nIn a naive fit that neglects blending, one assumes $\\tilde{A}(t)$ is generated by an unblended PSPL model and fits $\\tilde{A}(t)$ with $A\\!\\left(\\sqrt{u_0'^2 + \\left(\\dfrac{t - t_0}{t_E'}\\right)^2}\\right)$, thereby estimating $u_0'$ and $t_E'$ from the blended light curve by minimizing the squared residual between the unblended PSPL model and $\\tilde{A}(t)$ over a time grid. The goal is to compute the fractional biases $(\\delta t_E/t_E)$ and $(\\delta u_0/u_0)$, where $\\delta t_E = t_E' - t_E$ and $\\delta u_0 = u_0' - u_0$.\n\nStarting from the fundamental PSPL magnification $A(u)$ and the flux superposition $F(t) = F_s A(u(t)) + F_b$, derive an algorithm that, for a given set of true parameters $(u_0, t_E, t_0, g)$, constructs $\\tilde{A}(t)$ on a time grid and then estimates $(u_0', t_E')$ by minimizing the nonlinear least-squares objective $\\sum_t \\left[A\\!\\left(\\sqrt{u_0'^2 + \\left(\\dfrac{t - t_0}{t_E'}\\right)^2}\\right) - \\tilde{A}(t)\\right]^2$. Use this to compute $(\\delta t_E/t_E)$ and $(\\delta u_0/u_0)$.\n\nImplement the algorithm in a complete, runnable program. The following test suite must be evaluated:\n\n- Case $1$: $u_0 = 0.1$, $t_E = 20$ days, $t_0 = 0$ days, $g = 0.0$.\n- Case $2$: $u_0 = 0.1$, $t_E = 20$ days, $t_0 = 0$ days, $g = 0.5$.\n- Case $3$: $u_0 = 0.01$, $t_E = 30$ days, $t_0 = 0$ days, $g = 0.9$.\n- Case $4$: $u_0 = 1.0$, $t_E = 5$ days, $t_0 = 0$ days, $g = 0.2$.\n\nFor each case, construct a uniform time grid of $201$ samples spanning from $t = t_0 - 5 t_E$ to $t = t_0 + 5 t_E$ (in days), compute $\\tilde{A}(t)$, and fit $(u_0', t_E')$ by nonlinear least squares with the constraints $u_0'  0$ and $t_E'  0$. The fractional biases to report are $(\\delta t_E/t_E)$ and $(\\delta u_0/u_0)$, which are unitless decimals.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case’s result is a two-element list $[\\delta t_E/t_E,\\delta u_0/u_0]$ with no spaces, in the order of the cases above. For example, the format must be $[[\\delta t_{E,1}/t_{E,1},\\delta u_{0,1}/u_{0,1}],[\\delta t_{E,2}/t_{E,2},\\delta u_{0,2}/u_{0,2}],\\dots]$. No other text should be printed. Since the fractional biases are unitless, no physical units appear in the final output.",
            "solution": "The problem requires the quantification of parameter biases that arise when a blended gravitational microlensing event is incorrectly fitted with a non-blended Point Source Point Lens (PSPL) model. This involves generating synthetic data for a blended event and then performing a nonlinear least-squares fit to find the parameters of the incorrect model that best match this data. The biases are the fractional differences between the fitted parameters and the true parameters.\n\nThe logical procedure is as follows:\n1.  Define the mathematical models for the true (blended) and fitted (unblended) light curves.\n2.  For each test case, generate a synthetic, blended light curve based on the \"true\" parameters provided.\n3.  Establish the optimization problem by defining the objective function to be minimized.\n4.  Solve the optimization problem numerically to find the biased parameters.\n5.  Calculate the requested fractional biases from the true and biased parameters.\n\n**1. Mathematical Models**\n\nThe fundamental building block is the PSPL magnification $A(u)$, which depends on the dimensionless projected separation $u$ between the source and the lens star:\n$$A(u) = \\frac{u^2 + 2}{u \\sqrt{u^2 + 4}}$$\nThis expression is valid for $u  0$. For $u \\to 0$, the magnification diverges as $A(u) \\approx 1/u$, which corresponds to a perfect alignment.\n\nThe separation $u$ is a function of time $t$, given by:\n$$u(t) = \\sqrt{u_0^2 + \\left(\\frac{t - t_0}{t_E}\\right)^2}$$\nHere, $u_0$ is the impact parameter (minimum separation in units of the Einstein radius), $t_0$ is the time of closest approach (and thus peak magnification), and $t_E$ is the Einstein timescale, which characterizes the duration of the event.\n\nIn a realistic scenario, the observed light may contain flux from unresolved stars near the source or lens, known as blended light. The total observed flux $F(t)$ is the sum of the magnified source flux, $F_s A(u(t))$, and the constant blended flux, $F_b$:\n$$F(t) = F_s A(u(t)) + F_b$$\nWhen analyzing a light curve, the flux is typically normalized by the baseline flux $F_0$, which is the flux far from the lensing event peak, where $A(u(t)) \\to 1$. Thus, $F_0 = F_s + F_b$. The apparent, baseline-normalized magnification $\\tilde{A}(t)$ is:\n$$\\tilde{A}(t) = \\frac{F(t)}{F_0} = \\frac{F_s A(u(t)) + F_b}{F_s + F_b}$$\nThis can be rewritten using the blending fraction $g = F_b / (F_s + F_b)$ and the source flux fraction $s = F_s / (F_s + F_b) = 1 - g$:\n$$\\tilde{A}(t) = \\frac{F_s}{F_s + F_b} A(u(t)) + \\frac{F_b}{F_s + F_b} = s A(u(t)) + g = (1-g)A(u(t)) + g$$\nRearranging to a more standard form highlights the deviation from the baseline of $1$:\n$$\\tilde{A}(t) = 1 + s(A(u(t)) - 1)$$\nThis is the \"true\" model for the synthetic data we will generate.\n\nA naive analysis neglects blending (i.e., assumes $g=0$ and $s=1$) and attempts to fit the data $\\tilde{A}(t)$ with a pure PSPL model. This fitted model, which we denote $A_{fit}$, has its own parameters, $u_0'$ and $t_E'$:\n$$A_{fit}(t; u_0', t_E') = A\\left(\\sqrt{u_0'^2 + \\left(\\frac{t - t_0}{t_E'}\\right)^2}\\right)$$\nThe problem specifies that the time of peak magnification is not a fitted parameter and is fixed to the true value $t_0$.\n\n**2. Synthetic Data Generation**\n\nFor each given set of true parameters $(u_0, t_E, t_0, g)$, we must first generate the synthetic \"observed\" data. This involves:\n- Creating a time grid of $201$ points from $t_{start} = t_0 - 5 t_E$ to $t_{end} = t_0 + 5 t_E$. Let this grid be $\\{t_i\\}$.\n- Calculating the true separation $u(t_i)$ at each time sample using the true parameters $(u_0, t_E, t_0)$.\n- Calculating the true PSPL magnification $A(u(t_i))$ at each sample.\n- Calculating the source flux fraction $s = 1 - g$.\n- Calculating the apparent magnification $\\tilde{A}(t_i) = 1 + s(A(u(t_i)) - 1)$ for all $t_i$. The resulting array $\\{\\tilde{A}(t_i)\\}$ is our synthetic dataset.\n\n**3. The Optimization Problem**\n\nThe goal is to find the parameters $(u_0', t_E')$ that make the naive model $A_{fit}(t; u_0', t_E')$ best match the synthetic data $\\{\\tilde{A}(t_i)\\}$. This is achieved by minimizing the sum of squared residuals (the objective function $\\chi^2$):\n$$\\chi^2(u_0', t_E') = \\sum_i \\left[ A_{fit}(t_i; u_0', t_E') - \\tilde{A}(t_i) \\right]^2$$\nThis is a standard nonlinear least-squares optimization problem. The parameters to be optimized are the vector $\\mathbf{p} = [u_0', t_E']$. The minimization must be performed subject to the physical constraints $u_0'  0$ and $t_E'  0$.\n\n**4. Numerical Solution**\n\nWe employ the `scipy.optimize.least_squares` function, which is designed for such problems. This function iteratively adjusts the parameter vector $\\mathbf{p}$ to minimize the sum of squares of a user-provided residual function.\nThe residual function, $R(\\mathbf{p})$, returns a vector whose elements are the differences between the model and the data at each time step:\n$$R_i(\\mathbf{p}) = A_{fit}(t_i; u_0', t_E') - \\tilde{A}(t_i)$$\nThe `least_squares` algorithm minimizes $\\sum_i R_i^2$.\n- **Initial Guess:** A good initial guess for the optimization is crucial for convergence. The true parameters $(u_0, t_E)$ serve as an excellent starting point.\n- **Bounds:** The constraints $u_0'  0$ and $t_E'  0$ are enforced by providing `bounds=([0, 0], [inf, inf])` to the solver.\n\nThe solver returns a result object from which we extract the optimal parameter vector $\\mathbf{p}_{opt} = [u_0', t_E']$.\n\n**5. Bias Calculation**\n\nOnce the best-fit parameters $(u_0', t_E')$ are determined, the final step is to compute the fractional biases relative to the true parameters $(u_0, t_E)$:\n- Fractional bias in Einstein timescale: $\\dfrac{\\delta t_E}{t_E} = \\dfrac{t_E' - t_E}{t_E}$\n- Fractional bias in impact parameter: $\\dfrac{\\delta u_0}{u_0} = \\dfrac{u_0' - u_0}{u_0}$\n\nFor the case where the blending fraction $g=0$, we have $s=1$, so $\\tilde{A}(t) = A(u(t))$. The synthetic data is an exact unblended PSPL curve. The least-squares fit should therefore recover the true parameters, yielding $(u_0', t_E') = (u_0, t_E)$ and resulting in zero bias, up to numerical precision. This provides a valuable sanity check for the implementation. For $g  0$, we expect the fit to be compromised, leading to non-zero biases. Typically, blending makes the event appear to have a lower peak magnification and narrower wings, which the unblended model compensates for by increasing the impact parameter ($u_0'  u_0$) and decreasing the timescale ($t_E'  t_E$). This leads to a positive bias for $u_0$ and a negative bias for $t_E$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef pspl_magnification(u):\n    \"\"\"\n    Computes the Point Source Point Lens (PSPL) magnification.\n    Args:\n        u (float or np.ndarray): The dimensionless source-lens separation.\n    Returns:\n        float or np.ndarray: The magnification A(u).\n    \"\"\"\n    u_sq = u**2\n    return (u_sq + 2) / (u * np.sqrt(u_sq + 4))\n\ndef model_unblended(t, u0, tE, t0):\n    \"\"\"\n    Computes the unblended PSPL model light curve.\n    Args:\n        t (np.ndarray): Array of times.\n        u0 (float): Impact parameter.\n        tE (float): Einstein timescale.\n        t0 (float): Time of peak magnification.\n    Returns:\n        np.ndarray: The model magnification at each time t.\n    \"\"\"\n    u = np.sqrt(u0**2 + ((t - t0) / tE)**2)\n    # Handle u=0 case to avoid division by zero, although it's unlikely on a grid.\n    # We add a small epsilon to u to prevent division by zero.\n    epsilon = 1e-12\n    return pspl_magnification(u + epsilon)\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the validation and calculation for all test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (u0_true, tE_true, t0_true, g_true)\n        (0.1, 20.0, 0.0, 0.0),   # Case 1\n        (0.1, 20.0, 0.0, 0.5),   # Case 2\n        (0.01, 30.0, 0.0, 0.9),  # Case 3\n        (1.0, 5.0, 0.0, 0.2),    # Case 4\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        u0_true, tE_true, t0_true, g_true = case\n        \n        # 1. Generate synthetic \"observed\" data\n        s_true = 1.0 - g_true\n        \n        time_grid = np.linspace(t0_true - 5 * tE_true, t0_true + 5 * tE_true, 201)\n        \n        # True unblended magnification\n        A_true = model_unblended(time_grid, u0_true, tE_true, t0_true)\n        \n        # Apparent (blended) magnification\n        A_tilde_data = 1.0 + s_true * (A_true - 1.0)\n        \n        # 2. Set up the nonlinear least-squares fit\n        \n        def residual_function(params, t, t0, data):\n            \"\"\"\n            Residual function for the least-squares fitter.\n            The function to be minimized is the sum of squares of this residual.\n            \"\"\"\n            u0_fit, tE_fit = params\n            model_pred = model_unblended(t, u0_fit, tE_fit, t0)\n            return model_pred - data\n\n        # Initial guess for the parameters [u0_prime, tE_prime]\n        initial_guess = [u0_true, tE_true]\n        \n        # Physical bounds for the parameters: u0'  0, tE'  0\n        param_bounds = ([1e-9, 1e-9], [np.inf, np.inf])\n\n        # 3. Perform the fit\n        fit_result = least_squares(\n            residual_function,\n            initial_guess,\n            bounds=param_bounds,\n            args=(time_grid, t0_true, A_tilde_data)\n        )\n        \n        u0_fit, tE_fit = fit_result.x\n        \n        # 4. Calculate fractional biases\n        delta_tE_over_tE = (tE_fit - tE_true) / tE_true\n        delta_u0_over_u0 = (u0_fit - u0_true) / u0_true\n        \n        results.append([delta_tE_over_tE, delta_u0_over_u0])\n\n    # Final print statement in the exact required format.\n    # e.g., [[-0.1,0.2],[-0.3,0.4]]\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}