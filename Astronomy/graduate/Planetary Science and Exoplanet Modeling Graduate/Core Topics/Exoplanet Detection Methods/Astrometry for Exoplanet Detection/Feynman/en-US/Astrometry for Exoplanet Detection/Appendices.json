{
    "hands_on_practices": [
        {
            "introduction": "Before embarking on a complex search for exoplanets, a crucial first step is to estimate the expected magnitude of the signal. This practice provides a foundational exercise in calculating the astrometric wobble of a star due to a massive companion using basic Newtonian mechanics. By comparing this result to the typical scale of planetary signals, you will develop an essential intuition for classifying celestial objects and vetting potential planetary candidates from background binaries .",
            "id": "4152281",
            "problem": "A Sun-like primary star of mass $M_{\\star} = 1.0\\,M_{\\odot}$ hosts a stellar companion of mass $M_{c} = 0.2\\,M_{\\odot}$ on a bound orbit with relative semi-major axis $a_{c} = 10\\,\\mathrm{AU}$, where $\\mathrm{AU}$ denotes the Astronomical Unit. The system is at a distance $d = 50\\,\\mathrm{pc}$ from Earth, where $\\mathrm{pc}$ denotes the parsec. Assume a near-circular orbit and note that, for astrometric measurements, the sky-projected semi-major axis of the primary’s barycentric orbit equals its true semi-major axis. Starting only from Newtonian two-body mechanics and the center-of-mass definition, and using the geometric definition of the parsec (the distance at which $1\\,\\mathrm{AU}$ subtends $1$ arcsecond), derive the expected angular astrometric semi-major axis $\\alpha$ (the primary’s reflex motion on the sky) caused by the companion. Express $\\alpha$ in milliarcseconds (mas), where $\\mathrm{mas}$ denotes milliarcsecond, and round your answer to three significant figures. Then, briefly explain how this amplitude compares to typical planetary astrometric signals around Sun-like stars to illustrate a simple classification criterion that uses a $1\\,\\mathrm{mas}$ demarcation between planetary-scale and stellar-companion-scale astrometric signatures. Your final reported value must be the numerical $\\alpha$ in milliarcseconds.",
            "solution": "The user-provided problem is subjected to validation before proceeding with a solution.\n\n### Step 1: Extract Givens\n- Primary star mass: $M_{\\star} = 1.0\\,M_{\\odot}$\n- Stellar companion mass: $M_{c} = 0.2\\,M_{\\odot}$\n- Relative semi-major axis of the companion's orbit: $a_{c} = 10\\,\\mathrm{AU}$\n- Distance to the system: $d = 50\\,\\mathrm{pc}$\n- Assumption: The orbit is near-circular.\n- Assumption: The sky-projected semi-major axis of the primary’s barycentric orbit equals its true semi-major axis.\n- Definition: The parsec is the distance at which $1\\,\\mathrm{AU}$ subtends an angle of $1$ arcsecond.\n- Task: Derive the angular astrometric semi-major axis $\\alpha$ in milliarcseconds ($\\mathrm{mas}$) and round to three significant figures.\n- Task: Briefly explain the comparison of this amplitude to typical planetary astrometric signals using a $1\\,\\mathrm{mas}$ demarcation.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity based on scientific principles and logical consistency.\n\n- **Scientific Grounding**: The problem is based on fundamental principles of Newtonian two-body mechanics and standard definitions used in astrometry. The physical parameters ($M_{\\star}$, $M_c$, $a_c$, $d$) are entirely realistic for a nearby binary star system.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary data and clearly stated assumptions (circular orbit, favorable projection) to determine a unique solution for the astrometric amplitude $\\alpha$.\n- **Objectivity**: The problem is stated using precise, objective language and quantitative data.\n- **Completeness and Consistency**: The problem is self-contained and free of contradictions. The given data are sufficient and consistent.\n- **Realism**: The conditions and values are physically plausible.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be formulated based on the provided information and established physical principles.\n\n### Derivation of the Solution\nThe astrometric signal is the apparent angular motion of the primary star on the celestial sphere. This motion is a reflex of its orbit around the common center of mass (barycenter) of the system it shares with its companion.\n\nFirst, we determine the physical size of the primary star's orbit. The system's barycenter is defined by the relation $M_{\\star}\\vec{r}_{\\star} + M_{c}\\vec{r}_{c} = \\vec{0}$, assuming the barycenter is at the origin of our coordinate system. Here, $\\vec{r}_{\\star}$ and $\\vec{r}_{c}$ are the position vectors of the primary star and the companion, respectively. The relative position vector is defined as $\\vec{r} = \\vec{r}_{c} - \\vec{r}_{\\star}$.\n\nWe can express the primary star's position vector, $\\vec{r}_{\\star}$, in terms of the relative vector $\\vec{r}$. From the barycenter equation, $M_{\\star}\\vec{r}_{\\star} = -M_{c}\\vec{r}_{c}$. Substituting $\\vec{r}_{c} = \\vec{r} + \\vec{r}_{\\star}$ gives:\n$$ M_{\\star}\\vec{r}_{\\star} = -M_{c}(\\vec{r} + \\vec{r}_{\\star}) $$\n$$ (M_{\\star} + M_{c})\\vec{r}_{\\star} = -M_{c}\\vec{r} $$\n$$ \\vec{r}_{\\star} = -\\frac{M_{c}}{M_{\\star} + M_{c}}\\vec{r} $$\nThis equation shows that the primary star orbits the barycenter in a path that is a scaled-down version of the relative orbit of the companion. The semi-major axis of the primary star's orbit, $a_{\\star}$, is therefore related to the relative semi-major axis, $a_{c}$, by the same scaling factor:\n$$ a_{\\star} = \\frac{M_{c}}{M_{\\star} + M_{c}}a_{c} $$\nSubstituting the given mass values:\n$$ a_{\\star} = \\frac{0.2\\,M_{\\odot}}{1.0\\,M_{\\odot} + 0.2\\,M_{\\odot}} a_{c} = \\frac{0.2}{1.2} a_{c} = \\frac{1}{6} a_{c} $$\nGiven $a_{c} = 10\\,\\mathrm{AU}$, the semi-major axis of the primary star's physical orbit is:\n$$ a_{\\star} = \\frac{1}{6} \\times 10\\,\\mathrm{AU} = \\frac{10}{6}\\,\\mathrm{AU} \\approx 1.667\\,\\mathrm{AU} $$\nNext, we calculate the angular size of this orbit as seen from Earth. The problem provides the geometric definition of the parsec, from which the small-angle formula for astrometry is directly derived: an object of size $s$ at a distance $d$ subtends an angle $\\theta$ given by $\\theta_{[\\mathrm{arcsec}]} = \\frac{s_{[\\mathrm{AU}]}}{d_{[\\mathrm{pc}]}}$.\n\nThe angular semi-major axis, $\\alpha$, is the apparent size of the physical semi-major axis $a_{\\star}$ at distance $d$. Applying the formula:\n$$ \\alpha = \\frac{a_{\\star, \\mathrm{AU}}}{d_{\\mathrm{pc}}} $$\nwhere $a_{\\star, \\mathrm{AU}}$ is the value of $a_{\\star}$ in units of $\\mathrm{AU}$ and $d_{\\mathrm{pc}}$ is the distance in $\\mathrm{pc}$.\nSubstituting the values $a_{\\star} = \\frac{10}{6}\\,\\mathrm{AU}$ and $d = 50\\,\\mathrm{pc}$:\n$$ \\alpha = \\frac{10/6}{50} = \\frac{10}{6 \\times 50} = \\frac{1}{30}\\,\\mathrm{arcseconds} $$\nThe problem requires the answer in milliarcseconds ($\\mathrm{mas}$). Since $1\\,\\mathrm{arcsecond} = 1000\\,\\mathrm{mas}$:\n$$ \\alpha = \\frac{1}{30} \\times 1000\\,\\mathrm{mas} = \\frac{100}{3}\\,\\mathrm{mas} \\approx 33.333...\\,\\mathrm{mas} $$\nRounding to three significant figures, we get:\n$$ \\alpha \\approx 33.3\\,\\mathrm{mas} $$\nThis value represents the amplitude of the astrometric wobble of the primary star.\n\n### Comparison to Planetary Signals\nThe calculated astrometric amplitude of $\\alpha \\approx 33.3\\,\\mathrm{mas}$ is significantly larger than the $1\\,\\mathrm{mas}$ threshold mentioned in the problem. This illustrates a key distinction:\nThe amplitude of the astrometric signal, $a_{\\star}$, is directly proportional to the mass of the companion, $M_c$ (for $M_c \\ll M_{\\star}$). Stellar companions, which have masses typically in the range of $0.08\\,M_{\\odot}$ to $1.0\\,M_{\\odot}$, are orders of magnitude more massive than even the most massive gas giant planets (which have masses up to about $0.013\\,M_{\\odot}$). Consequently, a stellar companion induces a much larger reflex motion in the primary star compared to a planet at a similar orbital separation. Planetary astrometric signals are typically in the sub-milliarcsecond ($< 1\\,\\mathrm{mas}$) to microarcsecond ($\\mu\\mathrm{as}$) range for solar-type stars at typical interstellar distances. For instance, Jupiter induces a reflex motion in the Sun with an amplitude of about $0.5\\,\\mathrm{mas}$ as seen from a distance of $10\\,\\mathrm{pc}$. The $1\\,\\mathrm{mas}$ value therefore serves as a useful, albeit approximate, empirical boundary. An astrometrically detected reflex motion significantly exceeding $1\\,\\mathrm{mas}$ is very likely caused by a stellar or brown dwarf companion rather than a planet.",
            "answer": "$$\\boxed{33.3}$$"
        },
        {
            "introduction": "Knowing the expected signal size is half the battle; the other is understanding the limits of our ability to measure it. This exercise delves into the theoretical foundation of astrometric precision by tasking you with deriving the Cramér-Rao lower bound, a fundamental limit set by photon-counting statistics. This practice demonstrates how the number of photons collected ($N$) and the sharpness of the stellar image ($\\sigma_{\\mathrm{PSF}}$) determine the absolute best-case precision, providing a vital benchmark for evaluating real-world instrument performance .",
            "id": "4152353",
            "problem": "A single-epoch astrometric centroid measurement is performed on a bright star relevant for exoplanet wobble detection. Assume the observation is shot-noise limited, with ideal detector sampling (no pixelation effects, no readout noise, negligible background, and perfectly known form of the Point Spread Function (PSF)). The PSF is isotropic and can be approximated by a Gaussian with standard deviation $\\sigma_{\\mathrm{PSF}}$, and the total number of detected photons in the exposure is $N$. The target is a Gaia $G$-band apparent magnitude ($G$) $12$ star observed with effective $\\sigma_{\\mathrm{PSF}} = 100\\,\\mathrm{mas}$, and the exposure collects $N = 10^{6}$ photons.\n\nStarting from photon-counting (Poisson) statistics and the definition of Fisher information for a location parameter, derive the Cramér–Rao lower bound (CRLB) on the one-dimensional centroid variance along a single axis for a Gaussian PSF, expressed in terms of $\\sigma_{\\mathrm{PSF}}$ and $N$. Then use this bound to compute the expected centroiding noise (one standard deviation) for the given observational parameters. Round your numerical answer to three significant figures and express the final result in microarcseconds.",
            "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- **Process:** Single-epoch astrometric centroid measurement.\n- **Noise Model:** Shot-noise limited (photon-counting Poisson statistics).\n- **Detector Model:** Ideal sampling (no pixelation, no readout noise, negligible background).\n- **Point Spread Function (PSF):** Isotropic, perfectly known form, approximated as a Gaussian with standard deviation $\\sigma_{\\mathrm{PSF}}$.\n- **Total Photons:** $N$.\n- **Specific Parameters:**\n    - Gaia $G$-band apparent magnitude: $G=12$.\n    - Effective PSF standard deviation: $\\sigma_{\\mathrm{PSF}} = 100\\,\\mathrm{mas}$.\n    - Total collected photons: $N = 10^{6}$.\n- **Required Derivation:** Derive the Cramér–Rao lower bound (CRLB) on the one-dimensional centroid variance for a Gaussian PSF in terms of $\\sigma_{\\mathrm{PSF}}$ and $N$.\n- **Required Calculation:** Compute the expected centroiding noise (one standard deviation) for the given parameters, rounded to three significant figures and expressed in microarcseconds.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, employing standard principles of statistical optics and information theory (Poisson statistics, Fisher information, Cramér-Rao bound) as applied to observational astronomy. The scenario is a well-established idealization for calculating fundamental limits on astrometric precision. The problem is well-posed, providing all necessary information for the derivation and subsequent calculation. The inclusion of the star's magnitude ($G=12$) alongside the photon count ($N=10^6$) does not constitute a contradiction but rather provides realistic context, as the problem explicitly directs the use of the given $N$. The parameters are physically realistic for modern instrumentation. The language is objective and the requirements are unambiguous.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A full solution will be provided.\n\nThe solution proceeds in two parts as requested: first, the derivation of the Cramér–Rao lower bound, and second, the numerical calculation.\n\n**Part 1: Derivation of the Cramér–Rao Lower Bound**\n\nIn a shot-noise limited observation, the arrival of photons follows a Poisson process. For a total of $N$ detected photons, their positions $\\{x_i\\}_{i=1}^N$ on a one-dimensional detector are independent and identically distributed random variables. Their probability distribution is governed by the normalized Point Spread Function (PSF), which we denote by $f(x)$. The PSF is centered at an unknown true position $x_0$. Thus, the probability density for a single photon detected at position $x$ is $f(x-x_0)$.\n\nThe likelihood function for observing the set of $N$ photon positions, given the parameter $x_0$, is the product of the individual probabilities:\n$$ \\mathcal{L}(x_0; \\{x_i\\}) = \\prod_{i=1}^{N} f(x_i - x_0) $$\nThe log-likelihood function, $\\ln \\mathcal{L}$, is therefore:\n$$ \\ln \\mathcal{L}(x_0) = \\sum_{i=1}^{N} \\ln f(x_i - x_0) $$\nThe Cramér–Rao Lower Bound (CRLB) on the variance of any unbiased estimator $\\hat{x}_0$ of the parameter $x_0$ is given by the inverse of the Fisher information, $I(x_0)$:\n$$ \\mathrm{Var}(\\hat{x}_0) \\ge \\frac{1}{I(x_0)} $$\nThe Fisher information is defined as the expectation of the squared score (the derivative of the log-likelihood):\n$$ I(x_0) = E\\left[ \\left( \\frac{\\partial \\ln \\mathcal{L}}{\\partial x_0} \\right)^2 \\right] $$\nFirst, we compute the score:\n$$ \\frac{\\partial \\ln \\mathcal{L}}{\\partial x_0} = \\frac{\\partial}{\\partial x_0} \\sum_{i=1}^{N} \\ln f(x_i - x_0) = \\sum_{i=1}^{N} \\frac{1}{f(x_i - x_0)} \\frac{\\partial f(x_i - x_0)}{\\partial x_0} $$\nUsing the chain rule, with $u = x_i - x_0$, we have $\\frac{\\partial}{\\partial x_0} = \\frac{\\partial u}{\\partial x_0}\\frac{\\partial}{\\partial u} = (-1)\\frac{\\partial}{\\partial u}$. Let $f'(u)$ be the derivative of $f$ with respect to its argument.\n$$ \\frac{\\partial \\ln \\mathcal{L}}{\\partial x_0} = \\sum_{i=1}^{N} \\frac{-f'(x_i - x_0)}{f(x_i - x_0)} $$\nSince the photon positions are independent, the expectation of the product of terms for different photons separates. The score has a mean of zero, $E[\\frac{\\partial \\ln \\mathcal{L}}{\\partial x_0}] = 0$. Thus, the cross-terms in the expansion of the squared sum vanish in expectation. The Fisher information becomes the sum of the expectations for each photon:\n$$ I(x_0) = \\sum_{i=1}^{N} E\\left[ \\left( \\frac{f'(x_i - x_0)}{f(x_i - x_0)} \\right)^2 \\right] $$\nAs each photon position is drawn from the same distribution $f(x-x_0)$, the expectation is the same for all $i$.\n$$ I(x_0) = N \\int_{-\\infty}^{\\infty} \\left( \\frac{f'(x - x_0)}{f(x - x_0)} \\right)^2 f(x - x_0) \\,dx $$\nLet $u = x - x_0$, so $du = dx$. The integral becomes:\n$$ I(x_0) = N \\int_{-\\infty}^{\\infty} \\frac{[f'(u)]^2}{f(u)} \\,du $$\nThis is the general expression for the Fisher information for a location parameter $x_0$ with $N$ i.i.d. samples.\n\nNow, we apply this to the specified Gaussian PSF. The 2D isotropic Gaussian PSF has a 1D marginal distribution that is also a Gaussian with the same standard deviation, which we denote as $\\sigma_{\\mathrm{PSF}}$.\n$$ f(u) = \\frac{1}{\\sigma_{\\mathrm{PSF}}\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2\\sigma_{\\mathrm{PSF}}^2}\\right) $$\nIts first derivative is:\n$$ f'(u) = \\frac{1}{\\sigma_{\\mathrm{PSF}}\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2\\sigma_{\\mathrm{PSF}}^2}\\right) \\cdot \\left(-\\frac{2u}{2\\sigma_{\\mathrm{PSF}}^2}\\right) = -\\frac{u}{\\sigma_{\\mathrm{PSF}}^2} f(u) $$\nWe substitute this into the integral for $I(x_0)$:\n$$ I(x_0) = N \\int_{-\\infty}^{\\infty} \\frac{\\left(-\\frac{u}{\\sigma_{\\mathrm{PSF}}^2} f(u)\\right)^2}{f(u)} \\,du = N \\int_{-\\infty}^{\\infty} \\frac{u^2}{\\sigma_{\\mathrm{PSF}}^4} f(u) \\,du $$\n$$ I(x_0) = \\frac{N}{\\sigma_{\\mathrm{PSF}}^4} \\int_{-\\infty}^{\\infty} u^2 f(u) \\,du $$\nThe integral $\\int_{-\\infty}^{\\infty} u^2 f(u) \\,du$ is the second moment of the distribution $f(u)$. Since $f(u)$ is a zero-mean Gaussian distribution, its second moment is equal to its variance, which is $\\sigma_{\\mathrm{PSF}}^2$.\n$$ \\int_{-\\infty}^{\\infty} u^2 f(u) \\,du = \\sigma_{\\mathrm{PSF}}^2 $$\nSubstituting this result back gives the Fisher information:\n$$ I(x_0) = \\frac{N}{\\sigma_{\\mathrm{PSF}}^4} \\cdot \\sigma_{\\mathrm{PSF}}^2 = \\frac{N}{\\sigma_{\\mathrm{PSF}}^2} $$\nThe CRLB on the variance of the centroid estimate is the reciprocal of the Fisher information:\n$$ \\mathrm{Var}(\\hat{x}_0) \\ge \\frac{1}{I(x_0)} = \\frac{\\sigma_{\\mathrm{PSF}}^2}{N} $$\nThis is the requested expression for the one-dimensional centroid variance lower bound.\n\n**Part 2: Numerical Calculation**\n\nThe problem provides the following values:\n- PSF standard deviation: $\\sigma_{\\mathrm{PSF}} = 100\\,\\mathrm{mas}$\n- Total number of photons: $N = 10^6$\n\nWe use the derived formula for the CRLB variance, which represents the minimum achievable variance for an ideal estimator.\n$$ \\mathrm{Var}(\\hat{x}_0) = \\frac{\\sigma_{\\mathrm{PSF}}^2}{N} = \\frac{(100\\,\\mathrm{mas})^2}{10^6} $$\n$$ \\mathrm{Var}(\\hat{x}_0) = \\frac{10000\\,\\mathrm{mas}^2}{1000000} = \\frac{10^4}{10^6}\\,\\mathrm{mas}^2 = 0.01\\,\\mathrm{mas}^2 $$\nThe expected centroiding noise is the standard deviation, $\\sigma_{\\hat{x}_0}$, which is the square root of the variance:\n$$ \\sigma_{\\hat{x}_0} = \\sqrt{\\mathrm{Var}(\\hat{x}_0)} = \\sqrt{0.01\\,\\mathrm{mas}^2} = 0.1\\,\\mathrm{mas} $$\nThe problem requires the answer to be in microarcseconds ($\\mu$as). We use the conversion $1\\,\\mathrm{mas} = 1000\\,\\mu\\mathrm{as}$:\n$$ \\sigma_{\\hat{x}_0} = 0.1\\,\\mathrm{mas} \\times \\frac{1000\\,\\mu\\mathrm{as}}{1\\,\\mathrm{mas}} = 100\\,\\mu\\mathrm{as} $$\nThe result is exactly $100$. The problem asks to round the numerical answer to three significant figures. The number $100$ is consistent with this requirement, as it can be represented as $1.00 \\times 10^2$.",
            "answer": "$$\\boxed{100}$$"
        },
        {
            "introduction": "High-precision measurements can be misleading if the underlying model used for analysis is flawed. This computational practice explores a classic pitfall in astrometry: the degeneracy between a planet's orbital signal and the star's annual parallax, especially when the orbital period is close to one year. By simulating data and fitting a misspecified model, you will quantify how an incorrect assumption can introduce significant systematic bias into fundamental stellar parameters, highlighting the critical importance of careful model selection and validation .",
            "id": "4152260",
            "problem": "You are to write a complete, runnable program that generates synthetic one-dimensional along-scan astrometric measurements for a star with known true parallax and an orbiting planet, then fits an incorrect single-planet model to these data in order to quantify the resulting bias in the fitted parallax. Your program must compute the parallax bias for a small test suite of cases that explore the degeneracy when the planetary period is close to one year. All modeling and computation must be posed in purely mathematical terms and use physically plausible parameters and units.\n\nBegin from the following fundamental base and definitions.\n\n- Astrometric along-scan displacement is modeled as the sum of a constant position, a linear proper motion, the annual parallax signal due to the Earth's orbit, and the reflex motion induced by a single planet. We adopt a circular Earth orbit and work in an along-scan frame aligned with the ecliptic such that the annual parallax factor is a pure cosine at one-year period.\n\n- The along-scan observation at time $t$ (in years) is\n  $$ y(t) \\;=\\; \\theta_0 \\;+\\; \\mu \\,(t - t_\\mathrm{ref}) \\;+\\; \\varpi_\\mathrm{true} \\, p(t) \\;+\\; a \\,\\cos\\!\\big(\\omega_\\mathrm{true}\\, t + \\phi\\big) \\;+\\; \\varepsilon(t), $$\n  where $t_\\mathrm{ref}$ is a reference epoch in years, $\\theta_0$ is a constant offset in milliarcseconds, $\\mu$ is proper motion in milliarcseconds per year, $\\varpi_\\mathrm{true}$ is the true parallax in milliarcseconds, $p(t)$ is the scalar parallax factor, $a$ is the along-scan reflex amplitude in milliarcseconds, $\\omega_\\mathrm{true} = 2\\pi / P_\\mathrm{true}$ with $P_\\mathrm{true}$ the true orbital period in years, $\\phi$ is the orbital phase in radians, and $\\varepsilon(t)$ is zero-mean measurement noise in milliarcseconds.\n\n- The parallax factor is specified as\n  $$ p(t) \\;=\\; \\cos(2\\pi t), $$\n  which corresponds to a unit-amplitude annual ellipse projected onto the along-scan direction for a star on the ecliptic with suitably aligned scanning geometry. This is a standard and scientifically realistic simplification for exploring degeneracies between parallax and near-annual orbital periods.\n\nYou will fit an incorrect single-planet model to these data in which the planet's period is fixed to a value $P_\\mathrm{fit}$ that may differ from $P_\\mathrm{true}$. The fitted model is linear in its parameters:\n$$ y(t) \\approx \\theta_0' \\;+\\; \\mu' \\,(t - t_\\mathrm{ref}) \\;+\\; \\varpi_\\mathrm{fit} \\, p(t) \\;+\\; B \\,\\sin(\\omega_\\mathrm{fit} t) \\;+\\; C \\,\\cos(\\omega_\\mathrm{fit} t), $$\nwith unknowns $\\theta_0'$, $\\mu'$, $\\varpi_\\mathrm{fit}$, $B$, and $C$, and with $\\omega_\\mathrm{fit} = 2\\pi / P_\\mathrm{fit}$ fixed. The quantity of interest is the parallax bias\n$$ \\Delta \\varpi \\;=\\; \\varpi_\\mathrm{fit} \\;-\\; \\varpi_\\mathrm{true}, $$\nexpressed in milliarcseconds. You must obtain $\\varpi_\\mathrm{fit}$ via linear least squares for each test case.\n\nUse the following global measurement prescription, which is identical for all test cases unless otherwise specified:\n\n- Observation times: use $N = 80$ epochs uniformly spaced over a baseline of $T = 5$ years, starting at $t = 0$ years. That is, $t_i = i \\,\\Delta t$ for $i = 0, 1, \\dots, 79$, where $\\Delta t = T/N$ years.\n\n- Reference epoch: $t_\\mathrm{ref} = 2.5$ years.\n\n- Constant offset and proper motion: $\\theta_0 = 0$ milliarcseconds and $\\mu = 0$ milliarcseconds per year.\n\n- Noise: set $\\varepsilon(t) = 0$ for all $t$ (that is, no noise) to isolate structural bias.\n\n- Parallax factor: $p(t) = \\cos(2\\pi t)$, where the argument of the cosine is in radians, and $t$ is in years.\n\n- Angle unit: all angles such as $\\phi$ must be in radians.\n\n- Periods: all periods $P_\\mathrm{true}$ and $P_\\mathrm{fit}$ must be in years.\n\n- Amplitudes and parallax: all displacements and parallaxes must be in milliarcseconds.\n\nImplement the linear least squares fit by constructing the design matrix with columns corresponding to $1$, $(t - t_\\mathrm{ref})$, $p(t)$, $\\sin(\\omega_\\mathrm{fit} t)$, and $\\cos(\\omega_\\mathrm{fit} t)$, and solving for the parameters that minimize the squared residuals.\n\nTest suite. Compute $\\Delta \\varpi$ for each of the following five parameter sets, using the above observation prescription:\n\n- Case A (happy path, far from one year):\n  - $\\varpi_\\mathrm{true} = 100.0$ milliarcseconds,\n  - $a = 0.2$ milliarcseconds,\n  - $P_\\mathrm{true} = 2.0$ years,\n  - $\\phi = 0.7$ radians,\n  - $P_\\mathrm{fit} = 2.0$ years.\n\n- Case B (near-degenerate, slightly mismatched period):\n  - $\\varpi_\\mathrm{true} = 100.0$ milliarcseconds,\n  - $a = 0.2$ milliarcseconds,\n  - $P_\\mathrm{true} = 1.03$ years,\n  - $\\phi = 1.1$ radians,\n  - $P_\\mathrm{fit} = 1.01$ years.\n\n- Case C (degenerate true period at one year, incorrect fitted period):\n  - $\\varpi_\\mathrm{true} = 100.0$ milliarcseconds,\n  - $a = 0.2$ milliarcseconds,\n  - $P_\\mathrm{true} = 1.00$ years,\n  - $\\phi = 2.2$ radians,\n  - $P_\\mathrm{fit} = 0.95$ years.\n\n- Case D (edge case with no planet):\n  - $\\varpi_\\mathrm{true} = 100.0$ milliarcseconds,\n  - $a = 0.0$ milliarcseconds,\n  - $P_\\mathrm{true} = 0.80$ years,\n  - $\\phi = 0.0$ radians,\n  - $P_\\mathrm{fit} = 1.05$ years.\n\n- Case E (different parallax scale and near-annual periods):\n  - $\\varpi_\\mathrm{true} = 50.0$ milliarcseconds,\n  - $a = 0.5$ milliarcseconds,\n  - $P_\\mathrm{true} = 1.10$ years,\n  - $\\phi = 0.3$ radians,\n  - $P_\\mathrm{fit} = 1.02$ years.\n\nYour program must output a single line containing the biases for these five cases as a comma-separated Python-style list of floating-point numbers in milliarcseconds, each rounded to six decimal places, in the order [Case A, Case B, Case C, Case D, Case E]. For example, your program should produce a single line of output in the form\n\"[bA,bB,bC,bD,bE]\"\nwhere each entry is a float with exactly six digits after the decimal point and the unit implied to be milliarcseconds. No other text should be printed.",
            "solution": "The objective is to compute the bias induced in the astrometric parallax of a star when its observed motion is fitted with a model that assumes an incorrect orbital period for an orbiting exoplanet. The bias, $\\Delta \\varpi = \\varpi_\\mathrm{fit} - \\varpi_\\mathrm{true}$, is determined by generating synthetic, noise-free astrometric data based on a \"true\" model and then performing a linear least-squares fit using an \"incorrect\" model. This procedure isolates the structural bias arising from model misspecification, particularly in the challenging regime where the planetary period is close to one year, causing a degeneracy with the annual parallax signature.\n\nThe analysis is performed according to the following mathematical and algorithmic framework.\n\n### Mathematical Framework\n\n**1. Data Generation (True Model)**\n\nThe synthetic along-scan displacement data, $y(t_i)$, are generated at a series of discrete time points $t_i$. The model for the true displacement is given by:\n$$ y(t) \\;=\\; \\theta_0 \\;+\\; \\mu \\,(t - t_\\mathrm{ref}) \\;+\\; \\varpi_\\mathrm{true} \\, p(t) \\;+\\; a \\,\\cos\\!\\big(\\omega_\\mathrm{true}\\, t + \\phi\\big) \\;+\\; \\varepsilon(t) $$\nAccording to the problem specification, we use the global parameters $\\theta_0 = 0$, $\\mu = 0$, and $\\varepsilon(t) = 0$. The parallax factor is $p(t) = \\cos(2\\pi t)$. The true angular frequency of the planet is $\\omega_\\mathrm{true} = 2\\pi / P_\\mathrm{true}$. The equation for the generated data points thus simplifies to:\n$$ y(t_i) \\;=\\; \\varpi_\\mathrm{true} \\cos(2\\pi t_i) \\;+\\; a \\cos\\left(\\frac{2\\pi}{P_\\mathrm{true}} t_i + \\phi\\right) $$\nThe observation times are $t_i = i \\cdot \\Delta t$ for $i \\in \\{0, 1, \\dots, N-1\\}$, where the number of observations is $N=80$ over a total baseline of $T=5$ years, so the time step is $\\Delta t = T/N = 5/80 = 0.0625$ years.\n\n**2. Model Fitting (Linear Least Squares)**\n\nThe generated data vector, $\\mathbf{y} = [y(t_0), y(t_1), \\dots, y(t_{N-1})]^T$, is fitted with a linear model:\n$$ y(t) \\approx \\theta_0' \\;+\\; \\mu' \\,(t - t_\\mathrm{ref}) \\;+\\; \\varpi_\\mathrm{fit} \\, p(t) \\;+\\; B \\,\\sin(\\omega_\\mathrm{fit} t) \\;+\\; C \\,\\cos(\\omega_\\mathrm{fit} t) $$\nwhere $\\omega_\\mathrm{fit} = 2\\pi / P_\\mathrm{fit}$ is fixed for each test case. This can be expressed in matrix form as a linear system $\\mathbf{y} \\approx \\mathbf{A} \\mathbf{x}$, where $\\mathbf{x}$ is the vector of parameters to be determined and $\\mathbf{A}$ is the design matrix.\n\nThe parameter vector $\\mathbf{x}$ is a $5 \\times 1$ column vector containing the unknown coefficients:\n$$ \\mathbf{x} \\;=\\; \\begin{bmatrix} \\theta_0' \\\\ \\mu' \\\\ \\varpi_\\mathrm{fit} \\\\ B \\\\ C \\end{bmatrix} $$\n\nThe design matrix $\\mathbf{A}$ is an $N \\times 5$ matrix, where each column consists of a basis function evaluated at each observation time $t_i$. The $i$-th row of $\\mathbf{A}$ is:\n$$ \\mathbf{A}_{i,:} \\;=\\; \\begin{bmatrix} 1 & (t_i - t_\\mathrm{ref}) & \\cos(2\\pi t_i) & \\sin(\\omega_\\mathrm{fit} t_i) & \\cos(\\omega_\\mathrm{fit} t_i) \\end{bmatrix} $$\nwith the reference epoch being $t_\\mathrm{ref} = 2.5$ years.\n\n**3. Solution and Bias Calculation**\n\nThe best-fit parameter vector, $\\hat{\\mathbf{x}}$, is the one that minimizes the sum of squared residuals, $\\|\\mathbf{y} - \\mathbf{A}\\mathbf{x}\\|^2$. This is the standard linear least-squares problem, and its solution is formally given by $\\hat{\\mathbf{x}} = (\\mathbf{A}^T \\mathbf{A})^{-1} \\mathbf{A}^T \\mathbf{y}$. Numerically, this is solved robustly using methods such as QR decomposition, available in standard scientific computing libraries.\n\nAfter solving for $\\hat{\\mathbf{x}}$, the fitted parallax, $\\varpi_\\mathrm{fit}$, corresponds to the third element of the solution vector (index $2$, using $0$-based indexing):\n$$ \\varpi_\\mathrm{fit} \\;=\\; \\hat{\\mathbf{x}}_2 $$\nFinally, the parallax bias, $\\Delta \\varpi$, is computed for each test case as the difference between the fitted and true parallax values:\n$$ \\Delta \\varpi \\;=\\; \\varpi_\\mathrm{fit} - \\varpi_\\mathrm{true} $$\n\n### Algorithmic Implementation\n\nThe computation proceeds as follows for each of the five test cases:\n1.  Set the universal observation parameters: $N=80$, $T=5$ years, and $t_\\mathrm{ref} = 2.5$ years.\n2.  Generate the array of $N$ observation times, $t$, from $t=0$ up to, but not including, $t=T$.\n3.  For a given test case, retrieve the true parameters: $\\varpi_\\mathrm{true}$, $a$, $P_\\mathrm{true}$, $\\phi$, and the fitted period $P_\\mathrm{fit}$.\n4.  Construct the \"true\" data vector $\\mathbf{y}$ by evaluating $y(t_i)$ at each time point using the true model.\n5.  Construct the $N \\times 5$ design matrix $\\mathbf{A}$. The five columns are vectors representing the basis functions: $1$, $t - t_\\mathrm{ref}$, $\\cos(2\\pi t)$, $\\sin((2\\pi/P_\\mathrm{fit}) t)$, and $\\cos((2\\pi/P_\\mathrm{fit}) t)$.\n6.  Use a numerical least-squares solver, such as `numpy.linalg.lstsq`, to find the parameter vector $\\hat{\\mathbf{x}}$ that best fits the data $\\mathbf{y}$ with the model defined by $\\mathbf{A}$.\n7.  Extract the fitted parallax $\\varpi_\\mathrm{fit}$ from the third component of the resulting vector $\\hat{\\mathbf{x}}$.\n8.  Calculate the parallax bias $\\Delta \\varpi = \\varpi_\\mathrm{fit} - \\varpi_\\mathrm{true}$.\n9.  This process is repeated for all five test cases, and the resulting biases are collected and formatted for output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the parallax bias for a series of astrometric test cases.\n\n    This function generates synthetic astrometric data for a star with a planet\n    and then fits a misspecified model to quantify the resulting bias in the\n    derived parallax.\n    \"\"\"\n    # Global measurement prescription\n    N = 80  # Number of epochs\n    T = 5.0  # Observation baseline in years\n    t_ref = 2.5  # Reference epoch in years\n    \n    # Observation times array\n    # t_i = i * Delta_t for i=0, ..., N-1, where Delta_t = T/N\n    # np.linspace(start, stop, num, endpoint=False) generates `num` points\n    # from `start` up to but not including `stop`.\n    times = np.linspace(0.0, T, N, endpoint=False)\n\n    # Test suite:\n    # (varpi_true, a, P_true, phi, P_fit)\n    test_cases = [\n        # Case A: happy path, far from one year\n        (100.0, 0.2, 2.0, 0.7, 2.0),\n        # Case B: near-degenerate, slightly mismatched period\n        (100.0, 0.2, 1.03, 1.1, 1.01),\n        # Case C: degenerate true period at one year, incorrect fitted period\n        (100.0, 0.2, 1.00, 2.2, 0.95),\n        # Case D: edge case with no planet\n        (100.0, 0.0, 0.80, 0.0, 1.05),\n        # Case E: different parallax scale and near-annual periods\n        (50.0, 0.5, 1.10, 0.3, 1.02),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        varpi_true, a_true, P_true, phi_true, P_fit = case\n\n        # 1. Generate synthetic \"true\" data\n        # y(t) = varpi_true * p(t) + a * cos(omega_true*t + phi)\n        # Note: theta_0 and mu are zero.\n        omega_true = 2.0 * np.pi / P_true\n        parallax_signal_true = varpi_true * np.cos(2.0 * np.pi * times)\n        planet_signal_true = a_true * np.cos(omega_true * times + phi_true)\n        y_observed = parallax_signal_true + planet_signal_true\n\n        # 2. Construct the design matrix for the least-squares fit\n        # The fitted model has 5 parameters: theta_0', mu', varpi_fit, B, C\n        # y(t) ~ theta_0' + mu'*(t-t_ref) + varpi_fit*p(t) + B*sin(omega_fit*t) + C*cos(omega_fit*t)\n        omega_fit = 2.0 * np.pi / P_fit\n        \n        # Columns of the design matrix A\n        col1 = np.ones(N)                  # Basis for theta_0'\n        col2 = times - t_ref               # Basis for mu'\n        col3 = np.cos(2.0 * np.pi * times) # Basis for varpi_fit\n        col4 = np.sin(omega_fit * times)   # Basis for B\n        col5 = np.cos(omega_fit * times)   # Basis for C\n        \n        design_matrix = np.vstack([col1, col2, col3, col4, col5]).T\n\n        # 3. Solve the linear least-squares problem Ax = y\n        # We use rcond=None to use the machine-precision default and suppress future warnings.\n        # lstsq returns a tuple; the first element is the solution vector x.\n        params_fit = np.linalg.lstsq(design_matrix, y_observed, rcond=None)[0]\n\n        # 4. Extract the fitted parallax and compute the bias\n        varpi_fit = params_fit[2]  # varpi_fit is the 3rd parameter (index 2)\n        parallax_bias = varpi_fit - varpi_true\n        \n        results.append(parallax_bias)\n\n    # Final print statement in the exact required format.\n    # The format specifier \"{:.6f}\" rounds the number to six decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}