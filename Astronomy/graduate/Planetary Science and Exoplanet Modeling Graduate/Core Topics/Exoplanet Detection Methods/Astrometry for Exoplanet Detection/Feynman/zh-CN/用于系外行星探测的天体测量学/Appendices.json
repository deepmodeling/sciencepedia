{
    "hands_on_practices": [
        {
            "introduction": "任何探测工作的第一步都是理解目标信号的性质。本练习将通过牛顿力学的基本原理，推导恒星因伴星引力而产生的反射运动幅度，为我们希望探测的天体测量信号建立一个至关重要的尺度感。通过这项实践，您将能量化区分行星和恒星级伴星所引起的信号差异。",
            "id": "4152281",
            "problem": "一颗类日主星，质量为 $M_{\\star} = 1.0\\,M_{\\odot}$，拥有一颗质量为 $M_{c} = 0.2\\,M_{\\odot}$ 的恒星伴星，该伴星在一个束缚轨道上，相对半长轴为 $a_{c} = 10\\,\\mathrm{AU}$，其中 $\\mathrm{AU}$ 表示天文单位。该系统距离地球 $d = 50\\,\\mathrm{pc}$，其中 $\\mathrm{pc}$ 表示秒差距。假设轨道近圆形，并注意，对于天体测量，主星质心轨道的天空投影半长轴等于其真实半长轴。仅从牛顿二体动力学和质心定义出发，并使用秒差距的几何定义（即 $1\\,\\mathrm{AU}$ 的距离在该距离处张角为 $1$ 角秒），推导由伴星引起的预期角天体测量半长轴 $\\alpha$（主星在天空中的反射运动）。将 $\\alpha$ 以毫角秒（mas）表示，其中 $\\mathrm{mas}$ 表示毫角秒，并将您的答案四舍五入至三位有效数字。然后，简要解释此振幅与类日恒星周围典型行星天体测量信号的比较，以说明一个使用 $1\\,\\mathrm{mas}$ 作为行星级和恒星伴星级天体测量信号之间分界线的简单分类标准。您最终报告的值必须是数值 $\\alpha$（以毫角秒为单位）。",
            "solution": "在进行求解之前，用户提供的问题需要经过验证。\n\n### 步骤1：提取已知条件\n- 主星质量：$M_{\\star} = 1.0\\,M_{\\odot}$\n- 恒星伴星质量：$M_{c} = 0.2\\,M_{\\odot}$\n- 伴星轨道的相对半长轴：$a_{c} = 10\\,\\mathrm{AU}$\n- 系统距离：$d = 50\\,\\mathrm{pc}$\n- 假设：轨道近圆形。\n- 假设：主星质心轨道的天空投影半长轴等于其真实半长轴。\n- 定义：秒差距是在该距离上 $1\\,\\mathrm{AU}$ 张角为 $1$ 角秒的距离。\n- 任务：推导角天体测量半长轴 $\\alpha$，以毫角秒（$\\mathrm{mas}$）为单位，并四舍五入至三位有效数字。\n- 任务：简要解释此振幅与典型行星天体测量信号的比较，使用 $1\\,\\mathrm{mas}$ 的分界线。\n\n### 步骤2：使用提取的已知条件进行验证\n根据科学原理和逻辑一致性评估问题的有效性。\n\n- **科学依据**：该问题基于牛顿二体动力学的基本原理和天体测量学中使用的标准定义。物理参数（$M_{\\star}$、$M_c$、$a_c$、$d$）对于一个邻近的双星系统来说完全真实。\n- **适定性**：该问题是适定的。它提供了所有必要的数据和明确的假设（圆形轨道、有利的投影），以确定天体测量振幅 $\\alpha$ 的唯一解。\n- **客观性**：该问题使用精确、客观的语言和定量数据陈述。\n- **完整性与一致性**：该问题是自洽的，没有矛盾。给定的数据充分且一致。\n- **真实性**：条件和数值在物理上是合理的。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。将根据所提供的信息和已建立的物理原理制定解决方案。\n\n### 解题推导\n天体测量信号是主星在天球上的视角运动。这种运动是它围绕与伴星共享的系统共同质心（barycenter）运行轨道的反射。\n\n首先，我们确定主星轨道的物理尺寸。系统的质心由关系式 $M_{\\star}\\vec{r}_{\\star} + M_{c}\\vec{r}_{c} = \\vec{0}$ 定义，假设质心位于我们坐标系的原点。这里，$\\vec{r}_{\\star}$ 和 $\\vec{r}_{c}$ 分别是主星和伴星的位置向量。相对位置向量定义为 $\\vec{r} = \\vec{r}_{c} - \\vec{r}_{\\star}$。\n\n我们可以用相对向量 $\\vec{r}$ 来表示主星的位置向量 $\\vec{r}_{\\star}$。从质心方程可知，$M_{\\star}\\vec{r}_{\\star} = -M_{c}\\vec{r}_{c}$。代入 $\\vec{r}_{c} = \\vec{r} + \\vec{r}_{\\star}$ 得：\n$$ M_{\\star}\\vec{r}_{\\star} = -M_{c}(\\vec{r} + \\vec{r}_{\\star}) $$\n$$ (M_{\\star} + M_{c})\\vec{r}_{\\star} = -M_{c}\\vec{r} $$\n$$ \\vec{r}_{\\star} = -\\frac{M_{c}}{M_{\\star} + M_{c}}\\vec{r} $$\n这个方程表明，主星围绕质心运行的轨道是伴星相对轨道的一个缩小版。因此，主星轨道的半长轴 $a_{\\star}$ 与相对半长轴 $a_{c}$ 通过相同的比例因子相关联：\n$$ a_{\\star} = \\frac{M_{c}}{M_{\\star} + M_{c}}a_{c} $$\n代入给定的质量值：\n$$ a_{\\star} = \\frac{0.2\\,M_{\\odot}}{1.0\\,M_{\\odot} + 0.2\\,M_{\\odot}} a_{c} = \\frac{0.2}{1.2} a_{c} = \\frac{1}{6} a_{c} $$\n给定 $a_{c} = 10\\,\\mathrm{AU}$，主星物理轨道的半长轴为：\n$$ a_{\\star} = \\frac{1}{6} \\times 10\\,\\mathrm{AU} = \\frac{10}{6}\\,\\mathrm{AU} \\approx 1.667\\,\\mathrm{AU} $$\n接下来，我们计算从地球看这个轨道的角大小。问题提供了秒差距的几何定义，由此可以直接推导出天体测量的小角公式：一个大小为 $s$ 的物体在距离 $d$ 处所张的角 $\\theta$ 由公式 $\\theta_{[\\mathrm{arcsec}]} = \\frac{s_{[\\mathrm{AU}]}}{d_{[\\mathrm{pc}]}}$ 给出。\n\n角半长轴 $\\alpha$ 是物理半长轴 $a_{\\star}$ 在距离 $d$ 处的视大小。应用该公式：\n$$ \\alpha = \\frac{a_{\\star, \\mathrm{AU}}}{d_{\\mathrm{pc}}} $$\n其中 $a_{\\star, \\mathrm{AU}}$ 是以 $\\mathrm{AU}$ 为单位的 $a_{\\star}$ 的值，$d_{\\mathrm{pc}}$ 是以 $\\mathrm{pc}$ 为单位的距离。\n代入数值 $a_{\\star} = \\frac{10}{6}\\,\\mathrm{AU}$ 和 $d = 50\\,\\mathrm{pc}$：\n$$ \\alpha = \\frac{10/6}{50} = \\frac{10}{6 \\times 50} = \\frac{1}{30}\\,\\mathrm{arcseconds} $$\n问题要求答案以毫角秒（$\\mathrm{mas}$）为单位。因为 $1\\,\\mathrm{arcsecond} = 1000\\,\\mathrm{mas}$：\n$$ \\alpha = \\frac{1}{30} \\times 1000\\,\\mathrm{mas} = \\frac{100}{3}\\,\\mathrm{mas} \\approx 33.333...\\,\\mathrm{mas} $$\n四舍五入到三位有效数字，我们得到：\n$$ \\alpha \\approx 33.3\\,\\mathrm{mas} $$\n这个值代表了主星天体测量摆动的振幅。\n\n### 与行星信号的比较\n计算出的天体测量振幅 $\\alpha \\approx 33.3\\,\\mathrm{mas}$ 显著大于问题中提到的 $1\\,\\mathrm{mas}$ 阈值。这说明了一个关键的区别：\n天体测量信号的振幅 $a_{\\star}$ 与伴星的质量 $M_c$ 成正比（对于 $M_c \\ll M_{\\star}$）。恒星伴星的质量通常在 $0.08\\,M_{\\odot}$ 到 $1.0\\,M_{\\odot}$ 的范围内，比即使是质量最大的气态巨行星（其质量最高约为 $0.013\\,M_{\\odot}$）也要重几个数量级。因此，与在相似轨道分离度上的行星相比，恒星伴星在主星中引起的反射运动要大得多。对于在典型星际距离上的类日恒星，行星天体测量信号通常在亚毫角秒（$ 1\\,\\mathrm{mas}$）到微角秒（$\\mu\\mathrm{as}$）的范围内。例如，从 $10\\,\\mathrm{pc}$ 的距离看，木星在太阳中引起的反射运动振幅约为 $0.5\\,\\mathrm{mas}$。因此，$1\\,\\mathrm{mas}$ 这个值可以作为一个有用的、尽管是近似的经验性界限。一个天体测量探测到的显著超过 $1\\,\\mathrm{mas}$ 的反射运动，很可能是由恒星或褐矮星伴星引起的，而不是行星。",
            "answer": "$$\\boxed{33.3}$$"
        },
        {
            "introduction": "天体测量的精度并非无限，它从根本上受到光的量子性质的制约。本练习通过推导克拉默-拉奥下限（Cramér–Rao Lower Bound），探讨了由光子散粒噪声所设定的最终精度极限。这是信息论中的一个关键概念，它为给定光子数量下的最佳测量精度划定了理论边界。",
            "id": "4152353",
            "problem": "对一颗与系外行星摆动探测相关的亮星进行单历元天体测量质心测量。假设观测是散粒噪声受限的，具有理想的探测器采样（无像素化效应，无读出噪声，背景可忽略不计，且点扩散函数（PSF）的形式完全已知）。PSF是各向同性的，可以近似为一个标准差为 $\\sigma_{\\mathrm{PSF}}$ 的高斯函数，曝光中探测到的总光子数为 $N$。目标是一颗盖亚（Gaia）$G$波段视星等（$G$）为12的恒星，使用有效的 $\\sigma_{\\mathrm{PSF}} = 100\\,\\mathrm{mas}$ 进行观测，曝光收集了 $N = 10^{6}$ 个光子。\n\n从光子计数（泊松）统计和位置参数的费雪信息（Fisher information）定义出发，推导高斯PSF下沿单轴的一维质心方差的克拉默-拉奥下界（Cramér–Rao lower bound, CRLB），并用 $\\sigma_{\\mathrm{PSF}}$ 和 $N$ 表示。然后利用此下界计算给定观测参数下的预期质心定位噪声（一个标准差）。将你的数值答案四舍五入到三位有效数字，并以微角秒为单位表示最终结果。",
            "solution": "问题陈述需要经过验证。\n\n**步骤1：提取已知条件**\n- **过程：** 单历元天体测量质心测量。\n- **噪声模型：** 散粒噪声受限（光子计数泊松统计）。\n- **探测器模型：** 理想采样（无像素化，无读出噪声，背景可忽略）。\n- **点扩散函数（PSF）：** 各向同性，形式完全已知，近似为标准差为 $\\sigma_{\\mathrm{PSF}}$ 的高斯函数。\n- **总光子数：** $N$。\n- **具体参数：**\n    - 盖亚（Gaia）$G$波段视星等：$G=12$。\n    - 有效PSF标准差：$\\sigma_{\\mathrm{PSF}} = 100\\,\\mathrm{mas}$。\n    - 收集的总光子数：$N = 10^{6}$。\n- **要求推导：** 推导高斯PSF下的一维质心方差的克拉默-拉奥下界（CRLB），用 $\\sigma_{\\mathrm{PSF}}$ 和 $N$ 表示。\n- **要求计算：** 计算给定参数下的预期质心定位噪声（一个标准差），四舍五入到三位有效数字，并以微角秒表示。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，应用了统计光学和信息论的标准原理（泊松统计、费雪信息、克拉默-拉奥下界）于观测天文学。该场景是计算天体测量精度的基本极限时一个公认的理想化模型。问题提法很恰当，为推导和后续计算提供了所有必要信息。将恒星的星等（$G=12$）与光子数（$N=10^6$）一同给出并不构成矛盾，而是提供了现实背景，因为问题明确指示使用给定的 $N$。参数对于现代仪器来说是物理上现实的。语言客观，要求明确。\n\n**步骤3：结论与行动**\n问题被认为是有效的。将提供完整解答。\n\n解答按要求分为两部分进行：首先，推导克拉默-拉奥下界；其次，进行数值计算。\n\n**第一部分：推导克拉默-拉奥下界**\n\n在散粒噪声受限的观测中，光子的到达遵循泊松过程。对于总共探测到的 $N$ 个光子，它们在一维探测器上的位置 $\\{x_i\\}_{i=1}^N$ 是独立同分布的随机变量。它们的概率分布由归一化的点扩散函数（PSF）决定，我们记为 $f(x)$。PSF的中心位于一个未知的真实位置 $x_0$。因此，在位置 $x$ 探测到单个光子的概率密度为 $f(x-x_0)$。\n\n在给定参数 $x_0$ 的情况下，观测到这组 $N$ 个光子位置的似然函数是各个概率的乘积：\n$$ \\mathcal{L}(x_0; \\{x_i\\}) = \\prod_{i=1}^{N} f(x_i - x_0) $$\n因此，对数似然函数 $\\ln \\mathcal{L}$ 为：\n$$ \\ln \\mathcal{L}(x_0) = \\sum_{i=1}^{N} \\ln f(x_i - x_0) $$\n参数 $x_0$ 的任何无偏估计量 $\\hat{x}_0$ 的方差的克拉默-拉奥下界（CRLB）由费雪信息 $I(x_0)$ 的倒数给出：\n$$ \\mathrm{Var}(\\hat{x}_0) \\ge \\frac{1}{I(x_0)} $$\n费雪信息的定义为得分（对数似然函数的导数）平方的期望值：\n$$ I(x_0) = E\\left[ \\left( \\frac{\\partial \\ln \\mathcal{L}}{\\partial x_0} \\right)^2 \\right] $$\n首先，我们计算得分：\n$$ \\frac{\\partial \\ln \\mathcal{L}}{\\partial x_0} = \\frac{\\partial}{\\partial x_0} \\sum_{i=1}^{N} \\ln f(x_i - x_0) = \\sum_{i=1}^{N} \\frac{1}{f(x_i - x_0)} \\frac{\\partial f(x_i - x_0)}{\\partial x_0} $$\n使用链式法则，令 $u = x_i - x_0$，我们有 $\\frac{\\partial}{\\partial x_0} = \\frac{\\partial u}{\\partial x_0}\\frac{\\partial}{\\partial u} = (-1)\\frac{\\partial}{\\partial u}$。设 $f'(u)$ 是 $f$ 对其自变量的导数。\n$$ \\frac{\\partial \\ln \\mathcal{L}}{\\partial x_0} = \\sum_{i=1}^{N} \\frac{-f'(x_i - x_0)}{f(x_i - x_0)} $$\n由于光子位置是独立的，不同光子项的乘积的期望可以分开计算。得分的均值为零，$E[\\frac{\\partial \\ln \\mathcal{L}}{\\partial x_0}] = 0$。因此，平方和展开式中的交叉项的期望值为零。费雪信息变为每个光子期望的总和：\n$$ I(x_0) = \\sum_{i=1}^{N} E\\left[ \\left( \\frac{f'(x_i - x_0)}{f(x_i - x_0)} \\right)^2 \\right] $$\n由于每个光子的位置都从相同的分布 $f(x-x_0)$ 中抽取，因此对所有 $i$ 而言，期望是相同的。\n$$ I(x_0) = N \\int_{-\\infty}^{\\infty} \\left( \\frac{f'(x - x_0)}{f(x - x_0)} \\right)^2 f(x - x_0) \\,dx $$\n令 $u = x - x_0$，则 $du = dx$。积分变为：\n$$ I(x_0) = N \\int_{-\\infty}^{\\infty} \\frac{[f'(u)]^2}{f(u)} \\,du $$\n这是具有 $N$ 个独立同分布样本的位置参数 $x_0$ 的费雪信息的一般表达式。\n\n现在，我们将其应用于指定的高斯PSF。二维各向同性高斯PSF的一维边缘分布也是一个高斯分布，其标准差相同，我们记为 $\\sigma_{\\mathrm{PSF}}$。\n$$ f(u) = \\frac{1}{\\sigma_{\\mathrm{PSF}}\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2\\sigma_{\\mathrm{PSF}}^2}\\right) $$\n它的一阶导数是：\n$$ f'(u) = \\frac{1}{\\sigma_{\\mathrm{PSF}}\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2\\sigma_{\\mathrm{PSF}}^2}\\right) \\cdot \\left(-\\frac{2u}{2\\sigma_{\\mathrm{PSF}}^2}\\right) = -\\frac{u}{\\sigma_{\\mathrm{PSF}}^2} f(u) $$\n我们将此代入 $I(x_0)$ 的积分中：\n$$ I(x_0) = N \\int_{-\\infty}^{\\infty} \\frac{\\left(-\\frac{u}{\\sigma_{\\mathrm{PSF}}^2} f(u)\\right)^2}{f(u)} \\,du = N \\int_{-\\infty}^{\\infty} \\frac{u^2}{\\sigma_{\\mathrm{PSF}}^4} f(u) \\,du $$\n$$ I(x_0) = \\frac{N}{\\sigma_{\\mathrm{PSF}}^4} \\int_{-\\infty}^{\\infty} u^2 f(u) \\,du $$\n积分 $\\int_{-\\infty}^{\\infty} u^2 f(u) \\,du$ 是分布 $f(u)$ 的二阶矩。由于 $f(u)$ 是一个零均值高斯分布，其二阶矩等于其方差，即 $\\sigma_{\\mathrm{PSF}}^2$。\n$$ \\int_{-\\infty}^{\\infty} u^2 f(u) \\,du = \\sigma_{\\mathrm{PSF}}^2 $$\n将此结果代回，得到费雪信息：\n$$ I(x_0) = \\frac{N}{\\sigma_{\\mathrm{PSF}}^4} \\cdot \\sigma_{\\mathrm{PSF}}^2 = \\frac{N}{\\sigma_{\\mathrm{PSF}}^2} $$\n质心估计方差的CRLB是费雪信息的倒数：\n$$ \\mathrm{Var}(\\hat{x}_0) \\ge \\frac{1}{I(x_0)} = \\frac{\\sigma_{\\mathrm{PSF}}^2}{N} $$\n这就是所要求的一维质心方差下界的表达式。\n\n**第二部分：数值计算**\n\n问题提供了以下数值：\n- PSF标准差：$\\sigma_{\\mathrm{PSF}} = 100\\,\\mathrm{mas}$\n- 总光子数：$N = 10^6$\n\n我们使用推导出的CRLB方差公式，它代表了理想估计量可实现的最小方差。\n$$ \\mathrm{Var}(\\hat{x}_0) = \\frac{\\sigma_{\\mathrm{PSF}}^2}{N} = \\frac{(100\\,\\mathrm{mas})^2}{10^6} $$\n$$ \\mathrm{Var}(\\hat{x}_0) = \\frac{10000\\,\\mathrm{mas}^2}{1000000} = \\frac{10^4}{10^6}\\,\\mathrm{mas}^2 = 0.01\\,\\mathrm{mas}^2 $$\n预期的质心定位噪声是标准差 $\\sigma_{\\hat{x}_0}$，即方差的平方根：\n$$ \\sigma_{\\hat{x}_0} = \\sqrt{\\mathrm{Var}(\\hat{x}_0)} = \\sqrt{0.01\\,\\mathrm{mas}^2} = 0.1\\,\\mathrm{mas} $$\n问题要求答案以微角秒（$\\mu$as）为单位。我们使用换算关系 $1\\,\\mathrm{mas} = 1000\\,\\mu\\mathrm{as}$：\n$$ \\sigma_{\\hat{x}_0} = 0.1\\,\\mathrm{mas} \\times \\frac{1000\\,\\mu\\mathrm{as}}{1\\,\\mathrm{mas}} = 100\\,\\mu\\mathrm{as} $$\n结果恰好是 $100$。问题要求将数值答案四舍五入到三位有效数字。数字 $100$ 符合此要求，因为它可以表示为 $1.00 \\times 10^2$。",
            "answer": "$$\\boxed{100}$$"
        },
        {
            "introduction": "在随机噪声之外，系统误差是数据分析中的一个巨大挑战。这项计算练习旨在解决天体测量学中最经典的问题之一：行星轨道信号与恒星周年视差之间的简并性。您将通过模拟和拟合，揭示即使在无噪声的理想情况下，模型的不准确设定也会如何导致结果产生偏差。",
            "id": "4152260",
            "problem": "你需要编写一个完整的、可运行的程序，为一颗具有已知真实视差并环绕着一颗行星的恒星生成一维沿扫描方向的合成天体测量数据，然后用一个不正确的单行星模型来拟合这些数据，以量化拟合视差中产生的偏差。你的程序必须计算一小组测试案例的视差偏差，这些案例旨在探讨当行星周期接近一年时出现的简并性。所有的建模和计算都必须以纯数学术语表述，并使用物理上合理的参数和单位。\n\n请从以下基本依据和定义开始。\n\n- 沿扫描方向的天体测量位移被建模为一个常数位置、一个线性自行、由地球轨道引起的周年视差信号以及由单个行星引起的反射运动的总和。我们采用一个圆形的地球轨道，并在一个与黄道对齐的沿扫描坐标系中工作，从而使得周年视差因子是一个周期为一年的纯余弦函数。\n\n- 在时间 $t$（以年为单位）的沿扫描方向观测值为\n  $$ y(t) \\;=\\; \\theta_0 \\;+\\; \\mu \\,(t - t_\\mathrm{ref}) \\;+\\; \\varpi_\\mathrm{true} \\, p(t) \\;+\\; a \\,\\cos\\!\\big(\\omega_\\mathrm{true}\\, t + \\phi\\big) \\;+\\; \\varepsilon(t), $$\n  其中 $t_\\mathrm{ref}$ 是以年为单位的参考历元，$\\theta_0$ 是以毫角秒为单位的常数偏移，$\\mu$ 是以毫角秒/年为单位的自行，$\\varpi_\\mathrm{true}$ 是以毫角秒为单位的真实视差，$p(t)$ 是标量视差因子，$a$ 是以毫角秒为单位的沿扫描方向反射运动振幅，$\\omega_\\mathrm{true} = 2\\pi / P_\\mathrm{true}$，其中 $P_\\mathrm{true}$ 是以年为单位的真实轨道周期，$\\phi$ 是以弧度为单位的轨道相位，$\\varepsilon(t)$ 是以毫角秒为单位的零均值测量噪声。\n\n- 视差因子被指定为\n  $$ p(t) \\;=\\; \\cos(2\\pi t), $$\n  这对应于一个单位振幅的周年椭圆在沿扫描方向上的投影，适用于一颗位于黄道上且具有适当对齐扫描几何的恒星。这是一个标准的、科学上现实的简化方法，用于探讨视差与接近一年周期的轨道周期之间的简并性。\n\n你将使用一个不正确的单行星模型来拟合这些数据，其中行星的周期被固定为一个值 $P_\\mathrm{fit}$，该值可能与 $P_\\mathrm{true}$ 不同。该拟合模型对其参数是线性的：\n$$ y(t) \\approx \\theta_0' \\;+\\; \\mu' \\,(t - t_\\mathrm{ref}) \\;+\\; \\varpi_\\mathrm{fit} \\, p(t) \\;+\\; B \\,\\sin(\\omega_\\mathrm{fit} t) \\;+\\; C \\,\\cos(\\omega_\\mathrm{fit} t), $$\n其中未知数为 $\\theta_0'$、$\\mu'$、$\\varpi_\\mathrm{fit}$、$B$ 和 $C$，并且 $\\omega_\\mathrm{fit} = 2\\pi / P_\\mathrm{fit}$ 是固定的。我们感兴趣的量是视差偏差\n$$ \\Delta \\varpi \\;=\\; \\varpi_\\mathrm{fit} \\;-\\; \\varpi_\\mathrm{true}, $$\n以毫角秒表示。你必须通过对每个测试案例进行线性最小二乘法来获得 $\\varpi_\\mathrm{fit}$。\n\n除非另有说明，所有测试案例均使用以下通用的测量设定：\n\n- 观测时间：使用在 $T = 5$ 年的基线上均匀分布的 $N = 80$ 个历元，从 $t = 0$ 年开始。即，$t_i = i \\,\\Delta t$，对于 $i = 0, 1, \\dots, 79$，其中 $\\Delta t = T/N$ 年。\n\n- 参考历元：$t_\\mathrm{ref} = 2.5$ 年。\n\n- 常数偏移和自行：$\\theta_0 = 0$ 毫角秒和 $\\mu = 0$ 毫角秒/年。\n\n- 噪声：对所有 $t$ 设置 $\\varepsilon(t) = 0$（即无噪声），以分离结构性偏差。\n\n- 视差因子：$p(t) = \\cos(2\\pi t)$，其中余弦函数的参数以弧度为单位，$t$ 以年为单位。\n\n- 角度单位：所有角度（如 $\\phi$）必须以弧度为单位。\n\n- 周期：所有周期 $P_\\mathrm{true}$ 和 $P_\\mathrm{fit}$ 必须以年为单位。\n\n- 振幅和视差：所有位移和视差必须以毫角秒为单位。\n\n通过构建设计矩阵来实现线性最小二乘拟合，其列分别对应于 $1$、$(t - t_\\mathrm{ref})$、$p(t)$、$\\sin(\\omega_\\mathrm{fit} t)$ 和 $\\cos(\\omega_\\mathrm{fit} t)$，并求解使残差平方和最小化的参数。\n\n测试套件。为以下五个参数集中的每一个计算 $\\Delta \\varpi$，使用上述观测设定：\n\n- Case A (理想情况，远离一年周期):\n  - $\\varpi_\\mathrm{true} = 100.0$ 毫角秒，\n  - $a = 0.2$ 毫角秒，\n  - $P_\\mathrm{true} = 2.0$ 年，\n  - $\\phi = 0.7$ 弧度，\n  - $P_\\mathrm{fit} = 2.0$ 年。\n\n- Case B (接近简并，周期轻微不匹配):\n  - $\\varpi_\\mathrm{true} = 100.0$ 毫角秒，\n  - $a = 0.2$ 毫角秒，\n  - $P_\\mathrm{true} = 1.03$ 年，\n  - $\\phi = 1.1$ 弧度，\n  - $P_\\mathrm{fit} = 1.01$ 年。\n\n- Case C (真实周期为一年导致简并，拟合周期不正确):\n  - $\\varpi_\\mathrm{true} = 100.0$ 毫角秒，\n  - $a = 0.2$ 毫角秒，\n  - $P_\\mathrm{true} = 1.00$ 年，\n  - $\\phi = 2.2$ 弧度，\n  - $P_\\mathrm{fit} = 0.95$ 年。\n\n- Case D (无行星的边缘情况):\n  - $\\varpi_\\mathrm{true} = 100.0$ 毫角秒，\n  - $a = 0.0$ 毫角秒，\n  - $P_\\mathrm{true} = 0.80$ 年，\n  - $\\phi = 0.0$ 弧度，\n  - $P_\\mathrm{fit} = 1.05$ 年。\n\n- Case E (不同视差尺度和接近一年的周期):\n  - $\\varpi_\\mathrm{true} = 50.0$ 毫角秒，\n  - $a = 0.5$ 毫角秒，\n  - $P_\\mathrm{true} = 1.10$ 年，\n  - $\\phi = 0.3$ 弧度，\n  - $P_\\mathrm{fit} = 1.02$ 年。\n\n你的程序必须输出一行，其中包含这五个案例的偏差，格式为一个逗号分隔的 Python 风格的浮点数列表，单位为毫角秒，每个数值四舍五入到小数点后六位，顺序为 [Case A, Case B, Case C, Case D, Case E]。例如，你的程序应该产生单行输出，形式为\n\"[bA,bB,bC,bD,bE]\"\n其中每个条目都是一个小数点后恰好有六位数字的浮点数，单位默认为毫角秒。不应打印任何其他文本。",
            "solution": "目标是计算天体测量视差中引入的偏差，该偏差产生于当恒星的观测运动被一个为环绕的系外行星假设了不正确轨道周期的模型拟合时。该偏差 $\\Delta \\varpi = \\varpi_\\mathrm{fit} - \\varpi_\\mathrm{true}$ 通过基于“真实”模型生成合成的无噪声天体测量数据，然后使用“不正确”模型进行线性最小二乘拟合来确定。此过程分离了由模型设定不当引起的结构性偏差，特别是在行星周期接近一年而导致与周年视差信号发生简并的挑战性情况下。\n\n分析根据以下数学和算法框架进行。\n\n### 数学框架\n\n**1. 数据生成（真实模型）**\n\n合成的沿扫描方向位移数据 $y(t_i)$ 在一系列离散时间点 $t_i$ 上生成。真实位移的模型由下式给出：\n$$ y(t) \\;=\\; \\theta_0 \\;+\\; \\mu \\,(t - t_\\mathrm{ref}) \\;+\\; \\varpi_\\mathrm{true} \\, p(t) \\;+\\; a \\,\\cos\\!\\big(\\omega_\\mathrm{true}\\, t + \\phi\\big) \\;+\\; \\varepsilon(t) $$\n根据问题规范，我们使用全局参数 $\\theta_0 = 0$、$\\mu = 0$ 和 $\\varepsilon(t) = 0$。视差因子为 $p(t) = \\cos(2\\pi t)$。因此，生成的数据点的方程简化为：\n$$ y(t_i) \\;=\\; \\varpi_\\mathrm{true} \\cos(2\\pi t_i) \\;+\\; a \\cos\\left(\\frac{2\\pi}{P_\\mathrm{true}} t_i + \\phi\\right) $$\n观测时间为 $t_i = i \\cdot \\Delta t$，对于 $i \\in \\{0, 1, \\dots, N-1\\}$，其中观测次数为 $N=80$，总基线为 $T=5$ 年，因此时间步长为 $\\Delta t = T/N = 5/80 = 0.0625$ 年。\n\n**2. 模型拟合（线性最小二乘法）**\n\n生成的数据向量 $\\mathbf{y} = [y(t_0), y(t_1), \\dots, y(t_{N-1})]^T$ 通过一个线性模型进行拟合：\n$$ y(t) \\approx \\theta_0' \\;+\\; \\mu' \\,(t - t_\\mathrm{ref}) \\;+\\; \\varpi_\\mathrm{fit} \\, p(t) \\;+\\; B \\,\\sin(\\omega_\\mathrm{fit} t) \\;+\\; C \\,\\cos(\\omega_\\mathrm{fit} t) $$\n其中 $\\omega_\\mathrm{fit} = 2\\pi / P_\\mathrm{fit}$ 对于每个测试案例都是固定的。这可以表示为矩阵形式的线性系统 $\\mathbf{y} \\approx \\mathbf{A} \\mathbf{x}$，其中 $\\mathbf{x}$ 是待确定的参数向量，$\\mathbf{A}$ 是设计矩阵。\n\n参数向量 $\\mathbf{x}$ 是一个 $5 \\times 1$ 的列向量，包含未知系数：\n$$ \\mathbf{x} \\;=\\; \\begin{bmatrix} \\theta_0' \\\\ \\mu' \\\\ \\varpi_\\mathrm{fit} \\\\ B \\\\ C \\end{bmatrix} $$\n\n设计矩阵 $\\mathbf{A}$ 是一个 $N \\times 5$ 的矩阵，其中每列由在每个观测时间 $t_i$ 处求值的基函数组成。$\\mathbf{A}$ 的第 $i$ 行为：\n$$ \\mathbf{A}_{i,:} \\;=\\; \\begin{bmatrix} 1  (t_i - t_\\mathrm{ref})  \\cos(2\\pi t_i)  \\sin(\\omega_\\mathrm{fit} t_i)  \\cos(\\omega_\\mathrm{fit} t_i) \\end{bmatrix} $$\n其中参考历元为 $t_\\mathrm{ref} = 2.5$ 年。\n\n**3. 求解与偏差计算**\n\n最佳拟合参数矢量 $\\hat{\\mathbf{x}}$ 是使残差平方和 $\\|\\mathbf{y} - \\mathbf{A}\\mathbf{x}\\|^2$ 最小化的矢量。这是标准的线性最小二乘问题，其形式解为 $\\hat{\\mathbf{x}} = (\\mathbf{A}^T \\mathbf{A})^{-1} \\mathbf{A}^T \\mathbf{y}$。在数值上，这可以通过 QR 分解等稳健的方法求解，这些方法在标准的科学计算库中可用。\n\n求解 $\\hat{\\mathbf{x}}$ 后，拟合的视差 $\\varpi_\\mathrm{fit}$ 对应于解向量的第三个元素（使用从 0 开始的索引，即索引为 2）：\n$$ \\varpi_\\mathrm{fit} \\;=\\; \\hat{\\mathbf{x}}_2 $$\n最后，对于每个测试案例，计算视差偏差 $\\Delta \\varpi$ 作为拟合视差值与真实视差值之间的差：\n$$ \\Delta \\varpi \\;=\\; \\varpi_\\mathrm{fit} - \\varpi_\\mathrm{true} $$\n\n### 算法实现\n\n对于五个测试案例中的每一个，计算过程如下：\n1.  设置通用的观测参数：$N=80$，$T=5$ 年，以及 $t_\\mathrm{ref} = 2.5$ 年。\n2.  生成包含 $N$ 个观测时间的数组 $t$，从 $t=0$ 开始，但不包括 $t=T$。\n3.  对于给定的测试案例，检索真实参数：$\\varpi_\\mathrm{true}$、$a$、$P_\\mathrm{true}$、$\\phi$ 以及拟合周期 $P_\\mathrm{fit}$。\n4.  通过在每个时间点使用真实模型计算 $y(t_i)$，构建“真实”数据向量 $\\mathbf{y}$。\n5.  构建 $N \\times 5$ 的设计矩阵 $\\mathbf{A}$。五个列是代表基函数的向量：$1$、$t - t_\\mathrm{ref}$、$\\cos(2\\pi t)$、$\\sin((2\\pi/P_\\mathrm{fit}) t)$ 和 $\\cos((2\\pi/P_\\mathrm{fit}) t)$。\n6.  使用数值最小二乘求解器，例如 `numpy.linalg.lstsq`，找到最能用由 $\\mathbf{A}$ 定义的模型拟合数据 $\\mathbf{y}$ 的参数向量 $\\hat{\\mathbf{x}}$。\n7.  从得到的向量 $\\hat{\\mathbf{x}}$ 的第三个分量中提取拟合的视差 $\\varpi_\\mathrm{fit}$。\n8.  计算视差偏差 $\\Delta \\varpi = \\varpi_\\mathrm{fit} - \\varpi_\\mathrm{true}$。\n9.  对所有五个测试案例重复此过程，并收集结果偏差，然后格式化以供输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the parallax bias for a series of astrometric test cases.\n\n    This function generates synthetic astrometric data for a star with a planet\n    and then fits a misspecified model to quantify the resulting bias in the\n    derived parallax.\n    \"\"\"\n    # Global measurement prescription\n    N = 80  # Number of epochs\n    T = 5.0  # Observation baseline in years\n    t_ref = 2.5  # Reference epoch in years\n    \n    # Observation times array\n    # t_i = i * Delta_t for i=0, ..., N-1, where Delta_t = T/N\n    # np.linspace(start, stop, num, endpoint=False) generates `num` points\n    # from `start` up to but not including `stop`.\n    times = np.linspace(0.0, T, N, endpoint=False)\n\n    # Test suite:\n    # (varpi_true, a, P_true, phi, P_fit)\n    test_cases = [\n        # Case A: happy path, far from one year\n        (100.0, 0.2, 2.0, 0.7, 2.0),\n        # Case B: near-degenerate, slightly mismatched period\n        (100.0, 0.2, 1.03, 1.1, 1.01),\n        # Case C: degenerate true period at one year, incorrect fitted period\n        (100.0, 0.2, 1.00, 2.2, 0.95),\n        # Case D: edge case with no planet\n        (100.0, 0.0, 0.80, 0.0, 1.05),\n        # Case E: different parallax scale and near-annual periods\n        (50.0, 0.5, 1.10, 0.3, 1.02),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        varpi_true, a_true, P_true, phi_true, P_fit = case\n\n        # 1. Generate synthetic \"true\" data\n        # y(t) = varpi_true * p(t) + a * cos(omega_true*t + phi)\n        # Note: theta_0 and mu are zero.\n        omega_true = 2.0 * np.pi / P_true\n        parallax_signal_true = varpi_true * np.cos(2.0 * np.pi * times)\n        planet_signal_true = a_true * np.cos(omega_true * times + phi_true)\n        y_observed = parallax_signal_true + planet_signal_true\n\n        # 2. Construct the design matrix for the least-squares fit\n        # The fitted model has 5 parameters: theta_0', mu', varpi_fit, B, C\n        # y(t) ~ theta_0' + mu'*(t-t_ref) + varpi_fit*p(t) + B*sin(omega_fit*t) + C*cos(omega_fit*t)\n        omega_fit = 2.0 * np.pi / P_fit\n        \n        # Columns of the design matrix A\n        col1 = np.ones(N)                  # Basis for theta_0'\n        col2 = times - t_ref               # Basis for mu'\n        col3 = np.cos(2.0 * np.pi * times) # Basis for varpi_fit\n        col4 = np.sin(omega_fit * times)   # Basis for B\n        col5 = np.cos(omega_fit * times)   # Basis for C\n        \n        design_matrix = np.vstack([col1, col2, col3, col4, col5]).T\n\n        # 3. Solve the linear least-squares problem Ax = y\n        # We use rcond=None to use the machine-precision default and suppress future warnings.\n        # lstsq returns a tuple; the first element is the solution vector x.\n        params_fit = np.linalg.lstsq(design_matrix, y_observed, rcond=None)[0]\n\n        # 4. Extract the fitted parallax and compute the bias\n        varpi_fit = params_fit[2]  # varpi_fit is the 3rd parameter (index 2)\n        parallax_bias = varpi_fit - varpi_true\n        \n        results.append(parallax_bias)\n\n    # Final print statement in the exact required format.\n    # The format specifier \"{:.6f}\" rounds the number to six decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}