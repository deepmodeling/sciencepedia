{
    "hands_on_practices": [
        {
            "introduction": "行星内部的总压力可以分解为一个在绝对零度下由压缩产生的“冷”贡献和一个由热振动产生的“热”贡献。本练习将通过第一性原理推导，帮助您掌握计算热压力的核心方法。通过从格林爱森参数 $\\gamma$ 和定容热容 $C_V$ 的基本热力学定义出发，您将推导出在等容加热过程中压力是如何增加的，这是理解和构建行星内部状态方程的关键一步 ()。",
            "id": "4159851",
            "problem": "一个固态、成分均匀的行星幔矿物通过由维奈特状态方程描述的冷压缩曲线进行建模，该曲线提供了沿 $T=0$ K 等温线的压力函数 $P_{\\text{cold}}(V)$。该材料遵循米-格吕内森热模型，其中格吕内森参数被视为常数 $\\gamma=1.3$，定容热容遵循杜隆-珀蒂定律，$C_V = 3\\,n\\,R$，其中 $n$ 是摩尔数，$R$ 是通用气体常数。考虑一个固定体积的热力学状态，满足 $V/V_0 = 0.85$，其中 $V_0$ 是在相同压力和参考温度 $T_{\\text{ref}} = 300\\,\\mathrm{K}$ 下的参考体积。仅使用核心热力学定义，即格吕内森参数定义 $\\gamma \\equiv V\\left(\\partial P/\\partial E\\right)_V$ 和定容热容定义 $C_V \\equiv \\left(\\partial E/\\partial T\\right)_V$，从第一性原理出发推导并计算在温度 $T=3000\\,\\mathrm{K}$ 和 $V/V_0=0.85$ 时的热压增量\n$$\\Delta P_{\\text{th}}(V,T) \\equiv P(V,T)-P_{\\text{cold}}(V)$$\n在积分区间内，将 $\\gamma$ 和 $C_V$ 视为与 $T$ 和 $V$ 无关，并假设增量是相对于相同体积下 $T_{\\text{ref}}=300\\,\\mathrm{K}$ 的状态计算的。将最终结果以帕斯卡为单位表示，形式为包含 $n$、$R$ 和 $V_0$ 的单一闭式解析表达式。最终的方框答案中不要包含单位；在国际单位制中使用 $R$，在 $\\mathrm{m}^3$ 中使用 $V_0$，以使结果以帕斯卡为单位。无需四舍五入。",
            "solution": "### 推导\n本题的目标是基于米-格吕内森热模型，推导在固定体积 $V$ 下，当温度从 $T_{\\text{ref}}$ 变为 $T$ 时压力变化的表达式。我们从提供的两个基本热力学定义开始。\n\n格吕内森参数的定义是：\n$$ \\gamma \\equiv V\\left(\\frac{\\partial P}{\\partial E}\\right)_V $$\n其中 $P$ 是压力，$E$ 是内能，$V$ 是体积。对于一个定容过程，这个偏微分方程可以重排为：\n$$ dP = \\frac{\\gamma}{V} dE \\quad (\\text{定容过程}) $$\n我们需要求的是在相同体积 $V$ 但不同温度 $T_{\\text{ref}}$ 和 $T$ 下两个状态之间的压力差。设相应的压力和内能分别为 $(P_{\\text{ref}}, E_{\\text{ref}})$ 和 $(P, E)$。在定容 $V$ 条件下，将上述表达式从参考状态积分到最终状态：\n$$ \\int_{P_{\\text{ref}}}^{P} dP' = \\int_{E_{\\text{ref}}}^{E} \\frac{\\gamma}{V} dE' $$\n问题中说明 $\\gamma$ 可被视为常数。由于在此等容过程中体积 $V$ 也保持不变，因此项 $\\frac{\\gamma}{V}$ 可以移到积分符号外：\n$$ P - P_{\\text{ref}} = \\frac{\\gamma}{V} \\int_{E_{\\text{ref}}}^{E} dE' $$\n$$ P(V,T) - P(V,T_{\\text{ref}}) = \\frac{\\gamma}{V} [E(V,T) - E(V,T_{\\text{ref}})] $$\n该方程将定容下的压力变化与内能变化联系起来。\n\n接下来，我们使用定容热容的定义：\n$$ C_V \\equiv \\left(\\frac{\\partial E}{\\partial T}\\right)_V $$\n对于一个定容过程，这可以写成：\n$$ dE = C_V dT \\quad (\\text{定容过程}) $$\n为了求出内能的变化量 $E(V,T) - E(V,T_{\\text{ref}})$，我们在定容 $V$ 条件下，将此表达式对温度从 $T_{\\text{ref}}$ 积分到 $T$：\n$$ \\int_{E_{\\text{ref}}}^{E} dE' = \\int_{T_{\\text{ref}}}^{T} C_V(V,T') dT' $$\n问题中说明 $C_V$ 可被视为与温度（和体积）无关。因此，在此积分中 $C_V$ 是一个常数：\n$$ E(V,T) - E(V,T_{\\text{ref}}) = C_V \\int_{T_{\\text{ref}}}^{T} dT' $$\n$$ E(V,T) - E(V,T_{\\text{ref}}) = C_V (T - T_{\\text{ref}}) $$\n\n现在，我们将内能变化的这个结果代回到压力变化的表达式中：\n$$ P(V,T) - P(V,T_{\\text{ref}}) = \\frac{\\gamma C_V}{V} (T - T_{\\text{ref}}) $$\n这个表达式表示当一种材料在定容下从 $T_{\\text{ref}}$ 加热到 $T$ 时的压力增加。这正是问题陈述所要求的量：相对于 $T_{\\text{ref}}=300\\,\\mathrm{K}$ 状态，在 $T=3000\\,\\mathrm{K}$ 时的热压增量。我们用 $\\Delta P$ 来表示这个量。\n\n现在我们可以代入给定的数值来计算最终的表达式。\n给定的数值是：\n- $\\gamma = 1.3$\n- $C_V = 3\\,n\\,R$\n- $V = 0.85\\,V_0$\n- $T = 3000\\,\\mathrm{K}$\n- $T_{\\text{ref}} = 300\\,\\mathrm{K}$\n\n将这些值代入我们推导出的 $\\Delta P$ 公式中：\n$$ \\Delta P = \\frac{(1.3) (3\\,n\\,R)}{0.85\\,V_0} (3000 - 300) $$\n首先，计算温差：\n$$ T - T_{\\text{ref}} = 3000 - 300 = 2700\\,\\mathrm{K} $$\n表达式变为：\n$$ \\Delta P = \\frac{1.3 \\times 3 \\times n R \\times 2700}{0.85\\,V_0} $$\n现在，我们简化数值系数：\n$$ \\text{系数} = \\frac{1.3 \\times 3 \\times 2700}{0.85} = \\frac{3.9 \\times 2700}{0.85} $$\n为了简化分数，我们可以将小数写成整数的比值：\n$$ 3.9 = \\frac{39}{10}, \\quad 0.85 = \\frac{85}{100} = \\frac{17}{20} $$\n系数是：\n$$ \\frac{\\frac{39}{10} \\times 2700}{\\frac{17}{20}} = \\frac{39 \\times 270}{\\frac{17}{20}} = (39 \\times 270) \\times \\frac{20}{17} = \\frac{39 \\times 270 \\times 20}{17} $$\n让我们计算分子：\n$$ 39 \\times 270 \\times 20 = 39 \\times (27 \\times 10) \\times 20 = 39 \\times 27 \\times 200 $$\n$$ 39 \\times 27 = (40 - 1) \\times 27 = 40 \\times 27 - 27 = 1080 - 27 = 1053 $$\n$$ 1053 \\times 200 = 210600 $$\n所以系数是：\n$$ \\text{系数} = \\frac{210600}{17} $$\n热压增量的最终解析表达式是：\n$$ \\Delta P = \\frac{210600}{17} \\frac{n R}{V_0} $$\n单位是一致的。当 $R$ 的单位是 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，$n$ 的单位是 $\\mathrm{mol}$，$V_0$ 的单位是 $\\mathrm{m}^3$ 时，$\\frac{nR}{V_0}$ 的单位是 $\\mathrm{J}\\,\\mathrm{m}^{-3}$，这等同于 $\\mathrm{N}\\,\\mathrm{m}^{-2}$ 或帕斯卡。系数 $\\frac{210600}{17}$ 是无量纲的，$\\gamma$ 也是。该表达式的单位正确地为压力单位。",
            "answer": "$$\\boxed{\\frac{210600}{17} \\frac{n R}{V_0}}$$"
        },
        {
            "introduction": "行星内部的相变边界并非一层不变的平坦界面，而是会因横向的温度变化而产生起伏。本练习将热力学（克拉佩龙方程）与力学（静岩压力）联系起来，让您亲手计算由地幔中的温度异常引起的相变边界地形。通过这个计算，您将深刻理解一个关键的地球动力学过程：热柱或俯冲板块等热结构如何影响地球 D'' 层等区域的结构，例如钙钛矿到后钙钛矿的相变边界 ()。",
            "id": "4159877",
            "problem": "一个正在经历从硅酸镁钙钛矿到后钙钛矿相变的深部硅酸盐地幔，在高压下具有正的克拉珀龙斜率。考虑一颗类地系外行星，其下地幔在 $120~\\mathrm{GPa}$ 的参考压力下存在钙钛矿-后钙钛矿相界面。一个横向对流温度异常产生了两个相邻区域，相对于相界面处的参考绝热线，一个区域温度高 $+300~\\mathrm{K}$，另一个区域温度低 $-300~\\mathrm{K}$。假设以下参数代表了 $120~\\mathrm{GPa}$ 压力下的条件：相界面处的克拉珀龙斜率 $dP/dT$ 为 $9~\\mathrm{MPa\\,K^{-1}}$，密度 $\\rho = 5.5 \\times 10^{3}~\\mathrm{kg\\,m^{-3}}$，局部重力加速度 $g = 10.7~\\mathrm{m\\,s^{-2}}$。将岩石静压力梯度视为均匀的，且等于静水压力值。\n\n从基本的热力学和力学原理出发，确定相界面的峰到谷的横向地形起伏（即暖区和冷区下相界面的垂直深度差）。以公里为单位表示最终答案，并四舍五入到四位有效数字。",
            "solution": "本题的求解过程结合了两个基本原理：由克劳修斯-克拉珀龙关系描述的相平衡热力学条件，以及静水平衡的力学条件。\n\n设 $P$ 为压力，$T$ 为温度。钙钛矿-后钙钛矿相界面由 $P-T$ 平面中的一条曲线定义。该曲线的斜率即为克拉珀龙斜率 $\\gamma$，表示为：\n$$\n\\gamma = \\frac{dP}{dT}\n$$\n对于与参考状态 $(P_0, T_0)$ 的微小偏离，我们可以使用线性近似来关联相变压力的变化 $\\Delta P$ 与温度的变化 $\\Delta T$：\n$$\n\\Delta P \\approx \\gamma \\Delta T\n$$\n\n行星地幔内的压力主要来自上覆岩石的重量，这种情况被称为岩石静压力。题目要求将其视为静水压力梯度。设 $z$ 为深度，从某个参考水平面向下为正。静水平衡方程为：\n$$\n\\frac{dP}{dz} = \\rho g\n$$\n其中 $\\rho$ 是物质的密度，$g$ 是局部重力加速度。题目允许我们假设 $\\rho$ 和 $g$ 在相界面的垂直挠度范围内是恒定的。对该方程积分可得出压力变化 $\\Delta P$ 与深度变化 $\\Delta z$ 之间的关系：\n$$\n\\Delta P = \\rho g \\Delta z\n$$\n\n横向温度变化 $\\Delta T$ 会改变相变发生的压力。为了使地幔保持在相界面上，其深度必须调整以匹配这个新的相变压力。通过令 $\\Delta P$ 的两个表达式相等，我们可以求出由温度异常 $\\Delta T$ 引起的相界面垂直挠度 $\\Delta z$：\n$$\n\\rho g \\Delta z = \\gamma \\Delta T\n$$\n求解深度变化 $\\Delta z$ 可得：\n$$\n\\Delta z = \\frac{\\gamma}{\\rho g} \\Delta T\n$$\n\n题目描述了参考绝热线附近存在两个区域：一个暖区，其温度异常为 $\\Delta T_{warm} = +300~\\mathrm{K}$；一个冷区，其温度异常为 $\\Delta T_{cold} = -300~\\mathrm{K}$。\n\n题目给出了一个正的克拉珀龙斜率 $\\gamma = 9~\\mathrm{MPa\\,K^{-1}} > 0$。这意味着更高的温度需要更高的压力来引发相变。由于压力随深度增加，相界面在较暖的区域会更深，在较冷的区域会更浅。\n\n相对于参考深度，相界面在暖区的垂直挠度为：\n$$\n\\Delta z_{warm} = \\frac{\\gamma}{\\rho g} \\Delta T_{warm}\n$$\n由于 $\\Delta T_{warm}$ 是正值，$\\Delta z_{warm}$ 也是正值，表示向下挠曲（深度更大）。\n\n相界面在冷区的垂直挠度为：\n$$\n\\Delta z_{cold} = \\frac{\\gamma}{\\rho g} \\Delta T_{cold}\n$$\n由于 $\\Delta T_{cold}$ 是负值，$\\Delta z_{cold}$ 也是负值，表示向上挠曲（深度更浅）。\n\n峰到谷的横向地形起伏是相界面在暖区的位置（谷，或最深点）和在冷区的位置（峰，或最浅点）之间的总垂直距离。这个总地形起伏 $\\Delta z_{total}$ 是它们深度之差：\n$$\n\\Delta z_{total} = (\\text{暖区深度}) - (\\text{冷区深度})\n$$\n如果 $z_0$ 是参考深度，那么两个区域的深度分别为 $z_0 + \\Delta z_{warm}$ 和 $z_0 + \\Delta z_{cold}$。\n$$\n\\Delta z_{total} = (z_0 + \\Delta z_{warm}) - (z_0 + \\Delta z_{cold}) = \\Delta z_{warm} - \\Delta z_{cold}\n$$\n代入挠度的表达式：\n$$\n\\Delta z_{total} = \\frac{\\gamma}{\\rho g} \\Delta T_{warm} - \\frac{\\gamma}{\\rho g} \\Delta T_{cold} = \\frac{\\gamma}{\\rho g} (\\Delta T_{warm} - \\Delta T_{cold})\n$$\n两个区域之间的总温差为 $\\Delta T_{warm} - \\Delta T_{cold} = 300~\\mathrm{K} - (-300~\\mathrm{K}) = 600~\\mathrm{K}$。\n\n现在我们代入给定值，确保所有单位都使用国际单位制（SI）。\n克拉珀龙斜率为 $\\gamma = 9~\\mathrm{MPa\\,K^{-1}} = 9 \\times 10^{6}~\\mathrm{Pa\\,K^{-1}}$。\n密度为 $\\rho = 5.5 \\times 10^{3}~\\mathrm{kg\\,m^{-3}}$。\n重力加速度为 $g = 10.7~\\mathrm{m\\,s^{-2}}$。\n总温差为 $\\Delta T_{total} = \\Delta T_{warm} - \\Delta T_{cold} = 600~\\mathrm{K}$。\n\n总地形起伏为：\n$$\n\\Delta z_{total} = \\frac{(9 \\times 10^{6}~\\mathrm{Pa\\,K^{-1}}) \\times (600~\\mathrm{K})}{(5.5 \\times 10^{3}~\\mathrm{kg\\,m^{-3}}) \\times (10.7~\\mathrm{m\\,s^{-2}})}\n$$\n计算分子和分母：\n$$\n\\text{分子} = 9 \\times 10^{6} \\times 600 = 5400 \\times 10^{6} = 5.4 \\times 10^{9}~\\mathrm{Pa}\n$$\n$$\n\\text{分母} = 5.5 \\times 10^{3} \\times 10.7 = 58.85 \\times 10^{3}~\\mathrm{kg\\,m^{-2}\\,s^{-2}}\n$$\n分母的单位是 $\\mathrm{Pa\\,m^{-1}}$。\n$$\n\\Delta z_{total} = \\frac{5.4 \\times 10^{9}~\\mathrm{Pa}}{58850~\\mathrm{Pa\\,m^{-1}}} \\approx 91758.70858~\\mathrm{m}\n$$\n题目要求答案以公里表示，并四舍五入到四位有效数字。\n$$\n\\Delta z_{total} \\approx 91.7587~\\mathrm{km}\n$$\n四舍五入到四位有效数字可得：\n$$\n\\Delta z_{total} = 91.76~\\mathrm{km}\n$$",
            "answer": "$$\\boxed{91.76}$$"
        },
        {
            "introduction": "真实地幔矿物是固溶体，其相平衡涉及复杂的组分分配。本练习是一个高级计算实践，将指导您通过编程实现一个基于化学势平衡的热力学模型。您将通过求解非线性方程组，来确定一个二元固溶体系在给定条件下的稳定相组合、以及各相的成分与摩尔比例，这是实际行星建模中的一项核心技能 ()。",
            "id": "4159816",
            "problem": "给定两种代表下地幔的二元固溶体相：钙钛矿和后钙钛矿。您的热力学任务是通过最小化吉布斯自由能，来确定在固定压力和温度下，特定整体成分的稳定相组合与相摩尔比例。您必须从第一性原理出发实现以下内容。\n\n假设在硅酸镁和硅酸铁端元之间存在二元替换，其中成分变量 $x$ 表示硅酸铁的摩尔分数（无量纲，以小数表示）。在固定压力 $P$ 和温度 $T$ 下，一个相 $\\phi \\in \\{\\text{钙钛矿}, \\text{后钙钛矿}\\}$ 的摩尔吉布斯自由能由一个正规溶体模型描述：\n$$\ng_{\\phi}(T,P,x) \\;=\\; x\\,g_{\\phi,\\mathrm{Fe}}(T,P) \\;+\\; (1-x)\\,g_{\\phi,\\mathrm{Mg}}(T,P) \\;+\\; R\\,T\\left[x\\ln x + (1-x)\\ln(1-x)\\right] \\;+\\; W_{\\phi}(T,P)\\,x(1-x),\n$$\n其中，$g_{\\phi,\\mathrm{Fe}}(T,P)$ 和 $g_{\\phi,\\mathrm{Mg}}(T,P)$ 分别是相 $\\phi$ 中硅酸铁和硅酸镁端元的标准摩尔吉布斯自由能（J/mol），$R$ 是普适气体常数，$W_{\\phi}(T,P)$ 是相 $\\phi$ 的对称相互作用参数（J/mol）。对于正规溶体模型中单个亚晶格上的二元替换，组分的化学势为：\n$$\n\\mu_{\\phi,\\mathrm{Fe}}(x) \\;=\\; g_{\\phi,\\mathrm{Fe}}(T,P) \\;+\\; R\\,T\\,\\ln x \\;+\\; W_{\\phi}(T,P)\\,(1-x)^2,\n$$\n$$\n\\mu_{\\phi,\\mathrm{Mg}}(x) \\;=\\; g_{\\phi,\\mathrm{Mg}}(T,P) \\;+\\; R\\,T\\,\\ln(1-x) \\;+\\; W_{\\phi}(T,P)\\,x^2.\n$$\n在固定 $P$ 和 $T$ 条件下，当各相达到平衡时，每个组分在共存相中的化学势相等，并且质量平衡（杠杆定则）成立。对于一个两相组合，其控制约束条件是：\n- 化学势相等：\n$$\n\\mu_{\\mathrm{perovskite},\\mathrm{Fe}}(x_{\\mathrm{pv}}) \\;=\\; \\mu_{\\mathrm{post\\text{-}perovskite},\\mathrm{Fe}}(x_{\\mathrm{ppv}}), \\quad\n\\mu_{\\mathrm{perovskite},\\mathrm{Mg}}(x_{\\mathrm{pv}}) \\;=\\; \\mu_{\\mathrm{post\\text{-}perovskite},\\mathrm{Mg}}(x_{\\mathrm{ppv}}).\n$$\n- 整体成分 $x_{\\mathrm{bulk}}$ 的质量平衡：\n$$\n(1-f)\\,x_{\\mathrm{pv}} \\;+\\; f\\,x_{\\mathrm{ppv}} \\;=\\; x_{\\mathrm{bulk}},\n$$\n其中 $f$ 是组合中后钙钛矿的相摩尔比例（摩尔分数，无量纲，以小数表示），而 $(1-f)$ 是钙钛矿的相摩尔比例。如果两相解不满足 $0 \\le f \\le 1$ 或 $x_{\\mathrm{pv}} = x_{\\mathrm{ppv}}$，则稳定的相组合是具有较低摩尔吉布斯自由能 $g_{\\phi}(T,P,x_{\\mathrm{bulk}})$ 的单相。\n\n在 $P = 120\\,\\mathrm{GPa}$ 和 $T = 2500\\,\\mathrm{K}$ 条件下，使用以下参数化：\n\n- 普适气体常数：$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 端元吉布斯多项式，单位为 $\\mathrm{J/mol}$，其中 $P$ 的单位为 $\\mathrm{GPa}$，$T$ 的单位为 $\\mathrm{K}$：\n  - 钙钛矿端元：\n    $$\n    g_{\\mathrm{pv},\\mathrm{Mg}}(T,P) = a_{0,\\mathrm{pv,Mg}} + a_{T,\\mathrm{pv,Mg}}\\,T + a_{P,\\mathrm{pv,Mg}}\\,P + a_{TP,\\mathrm{pv,Mg}}\\,T\\,P,\n    $$\n    $$\n    g_{\\mathrm{pv},\\mathrm{Fe}}(T,P) = a_{0,\\mathrm{pv,Fe}} + a_{T,\\mathrm{pv,Fe}}\\,T + a_{P,\\mathrm{pv,Fe}}\\,P + a_{TP,\\mathrm{pv,Fe}}\\,T\\,P,\n    $$\n    系数如下：\n    $a_{0,\\mathrm{pv,Mg}} = -5.95\\times 10^{5}$, $a_{T,\\mathrm{pv,Mg}} = 48$, $a_{P,\\mathrm{pv,Mg}} = 400$, $a_{TP,\\mathrm{pv,Mg}} = -4.8\\times 10^{-3}$；\n    $a_{0,\\mathrm{pv,Fe}} = -5.85\\times 10^{5}$, $a_{T,\\mathrm{pv,Fe}} = 44$, $a_{P,\\mathrm{pv,Fe}} = 420$, $a_{TP,\\mathrm{pv,Fe}} = -4.6\\times 10^{-3}$。\n  - 后钙钛矿端元：\n    $$\n    g_{\\mathrm{ppv},\\mathrm{Mg}}(T,P) = a_{0,\\mathrm{ppv,Mg}} + a_{T,\\mathrm{ppv,Mg}}\\,T + a_{P,\\mathrm{ppv,Mg}}\\,P + a_{TP,\\mathrm{ppv,Mg}}\\,T\\,P,\n    $$\n    $$\n    g_{\\mathrm{ppv},\\mathrm{Fe}}(T,P) = a_{0,\\mathrm{ppv,Fe}} + a_{T,\\mathrm{ppv,Fe}}\\,T + a_{P,\\mathrm{ppv,Fe}}\\,P + a_{TP,\\mathrm{ppv,Fe}}\\,T\\,P,\n    $$\n    系数如下：\n    $a_{0,\\mathrm{ppv,Mg}} = -6.10\\times 10^{5}$, $a_{T,\\mathrm{ppv,Mg}} = 52$, $a_{P,\\mathrm{ppv,Mg}} = 380$, $a_{TP,\\mathrm{ppv,Mg}} = -4.5\\times 10^{-3}$；\n    $a_{0,\\mathrm{ppv,Fe}} = -5.90\\times 10^{5}$, $a_{T,\\mathrm{ppv,Fe}} = 50$, $a_{P,\\mathrm{ppv,Fe}} = 390$, $a_{TP,\\mathrm{ppv,Fe}} = -4.4\\times 10^{-3}$。\n- 相互作用参数，单位为 $\\mathrm{J/mol}$：\n  $$\n  W_{\\mathrm{pv}}(T,P) = 20000 + 2\\,T - 10\\,P, \\quad\n  W_{\\mathrm{ppv}}(T,P) = 18000 + 1.8\\,T - 8\\,P.\n  $$\n\n在 $P = 120\\,\\mathrm{GPa}$ 和 $T = 2500\\,\\mathrm{K}$ 下的热力学判据：\n1. 计算每个相 $\\phi$ 的 $g_{\\phi,\\mathrm{Fe}}(T,P)$ 和 $g_{\\phi,\\mathrm{Mg}}(T,P)$。\n2. 对于给定的整体成分 $x_{\\mathrm{bulk}}$，评估单相摩尔吉布斯自由能 $g_{\\mathrm{pv}}(T,P,x_{\\mathrm{bulk}})$ 和 $g_{\\mathrm{ppv}}(T,P,x_{\\mathrm{bulk}})$。\n3. 通过求解满足化学势相等条件的 $x_{\\mathrm{pv}}$ 和 $x_{\\mathrm{ppv}}$ 来尝试计算两相平衡。然后根据质量平衡计算 $f$。仅当 $0 \\le f \\le 1$ 且 $0  x_{\\mathrm{ppv}}  x_{\\mathrm{pv}}  1$ 时（在给定的参数化下，物理上预期钙钛矿富铁而后钙钛矿富镁），才接受该两相解。计算混合物的摩尔吉布斯自由能 $g_{\\mathrm{mix}} = (1-f)\\,g_{\\mathrm{pv}}(T,P,x_{\\mathrm{pv}}) + f\\,g_{\\mathrm{ppv}}(T,P,x_{\\mathrm{ppv}})$。\n4. 在有效的两相混合物和单相选项中，选择具有最低摩尔吉布斯自由能的相组合。\n\n对于每个测试用例，您的程序必须生成一个包含四个条目的列表：$[\\text{state code}, f, x_{\\mathrm{pv}}, x_{\\mathrm{ppv}}]$，其中：\n- $\\text{state code}$ 是一个整数：$0$ 表示纯钙钛矿相，$1$ 表示纯后钙钛矿相，$2$ 表示钙钛矿和后钙钛矿的两相混合物。\n- $f$ 是后钙钛矿的相摩尔比例（无量纲小数）。\n- $x_{\\mathrm{pv}}$ 和 $x_{\\mathrm{ppv}}$ 是钙钛矿和后钙钛矿中的平衡铁摩尔分数（无量纲小数）。对于单相结果，当为纯钙钛矿相时，报告 $x_{\\mathrm{pv}} = x_{\\mathrm{ppv}} = x_{\\mathrm{bulk}}$ 且 $f = 0$；当为纯后钙钛矿相时，报告 $x_{\\mathrm{pv}} = x_{\\mathrm{ppv}} = x_{\\mathrm{bulk}}$ 且 $f = 1$。\n\n所有浮点数输出必须四舍五入到六位小数。压力必须以 $\\mathrm{GPa}$ 为单位处理，温度以 $\\mathrm{K}$ 为单位，所有吉布斯自由能和相互作用参数以 $\\mathrm{J/mol}$ 为单位。不涉及角度。不得使用百分比；成分均为小数。\n\n测试套件：\n- 案例 1：$x_{\\mathrm{bulk}} = 0.02$。\n- 案例 2：$x_{\\mathrm{bulk}} = 0.10$。\n- 案例 3：$x_{\\mathrm{bulk}} = 0.20$。\n- 案例 4：$x_{\\mathrm{bulk}} = 0.50$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含四个测试用例的结果，格式为一个由方括号括起来的、逗号分隔的列表的列表。例如，外层列表必须形如 $[[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$，且必须仅打印在一行上。",
            "solution": "该问题要求通过最小化系统的总吉布斯自由能，来确定一个二元(Mg,Fe)-硅酸盐固溶体在固定压力（$P$）和温度（$T$）下的稳定相组合。可能的相是钙钛矿（pv）和后钙钛矿（ppv）。该解法遵循用于多组分、多相体系的化学热力学原理。\n\n其指导原则是，一个在恒定 $P$ 和 $T$ 下的系统将在对应其总吉布斯自由能全局最小值的状态下达到平衡。对于给定的整体成分，此状态可以是一个单一的均匀相，也可以是两个或多个相的混合物。该问题按以下算法步骤求解：\n\n**步骤 1：热力学参数的计算**\n首先，我们计算在给定压力 $P = 120\\,\\mathrm{GPa}$ 和温度 $T = 2500\\,\\mathrm{K}$ 下保持恒定的所有热力学参数。\n\n普适气体常数为 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。热能项为 $R\\,T = 8.314 \\times 2500 = 20785\\,\\mathrm{J\\,mol^{-1}}$。\n\n纯端元的摩尔吉布斯自由能 $g_{\\phi,\\mathrm{Mg}}(T,P)$ 和 $g_{\\phi,\\mathrm{Fe}}(T,P)$ 使用所提供的多项式表达式计算：\n$g(T,P) = a_0 + a_T T + a_P P + a_{TP} TP$。\n对于钙钛矿（pv）：\n$$\ng_{\\mathrm{pv},\\mathrm{Mg}} = -5.95\\times 10^{5} + 48(2500) + 400(120) - 4.8\\times 10^{-3}(2500)(120) = -428440\\,\\mathrm{J\\,mol^{-1}}\n$$\n$$\ng_{\\mathrm{pv},\\mathrm{Fe}} = -5.85\\times 10^{5} + 44(2500) + 420(120) - 4.6\\times 10^{-3}(2500)(120) = -425980\\,\\mathrm{J\\,mol^{-1}}\n$$\n对于后钙钛矿（ppv）：\n$$\ng_{\\mathrm{ppv},\\mathrm{Mg}} = -6.10\\times 10^{5} + 52(2500) + 380(120) - 4.5\\times 10^{-3}(2500)(120) = -435750\\,\\mathrm{J\\,mol^{-1}}\n$$\n$$\ng_{\\mathrm{ppv},\\mathrm{Fe}} = -5.90\\times 10^{5} + 50(2500) + 390(120) - 4.4\\times 10^{-3}(2500)(120) = -419520\\,\\mathrm{J\\,mol^{-1}}\n$$\n\n正规溶体相互作用参数 $W_{\\phi}(T,P)$ 也进行计算：\n$$\nW_{\\mathrm{pv}} = 20000 + 2(2500) - 10(120) = 23800\\,\\mathrm{J\\,mol^{-1}}\n$$\n$$\nW_{\\mathrm{ppv}} = 18000 + 1.8(2500) - 8(120) = 21540\\,\\mathrm{J\\,mol^{-1}}\n$$\n\n**步骤 2：两相平衡成分的确定**\n我们研究存在两相（pv + ppv）平衡的可能性。如果存在这样的平衡，它由成分 $x_{\\mathrm{pv}}$ 和 $x_{\\mathrm{ppv}}$ 来表征，在这些成分下，每个组分（Fe 和 Mg）在两相中的化学势相等。这在分析上等同于吉布斯自由能曲线上的几何公切线构造。两个控制方程是：\n$$\n\\mu_{\\mathrm{pv},\\mathrm{Fe}}(x_{\\mathrm{pv}}) = \\mu_{\\mathrm{ppv},\\mathrm{Fe}}(x_{\\mathrm{ppv}})\n$$\n$$\n\\mu_{\\mathrm{pv},\\mathrm{Mg}}(x_{\\mathrm{pv}}) = \\mu_{\\mathrm{ppv},\\mathrm{Mg}}(x_{\\mathrm{ppv}})\n$$\n将正规溶体模型中的化学势表达式代入，我们得到一个关于两个未知成分 $x_{\\mathrm{pv}}$ 和 $x_{\\mathrm{ppv}}$ 的非线性方程组：\n$$\ng_{\\mathrm{pv},\\mathrm{Fe}} + R\\,T\\,\\ln x_{\\mathrm{pv}} + W_{\\mathrm{pv}}(1-x_{\\mathrm{pv}})^2 = g_{\\mathrm{ppv},\\mathrm{Fe}} + R\\,T\\,\\ln x_{\\mathrm{ppv}} + W_{\\mathrm{ppv}}(1-x_{\\mathrm{ppv}})^2\n$$\n$$\ng_{\\mathrm{pv},\\mathrm{Mg}} + R\\,T\\,\\ln(1-x_{\\mathrm{pv}}) + W_{\\mathrm{pv}}(x_{\\mathrm{pv}})^2 = g_{\\mathrm{ppv},\\mathrm{Mg}} + R\\,T\\,\\ln(1-x_{\\mathrm{ppv}}) + W_{\\mathrm{ppv}}(x_{\\mathrm{ppv}})^2\n$$\n该方程组通过数值方法求解。假设解对为 $(x_1, x_2)$。然后我们检查该解是否物理有效，即两种成分是否都在 $0$ 和 $1$ 之间。根据该系统的物理预期，我们将较大的成分分配给钙钛矿，$x^*_{\\mathrm{pv}} = \\max(x_1, x_2)$，将较小的成分分配给后钙钛矿，$x^*_{\\mathrm{ppv}} = \\min(x_1, x_2)$。如果两相解遵循约束条件 $0  x^*_{\\mathrm{ppv}}  x^*_{\\mathrm{pv}}  1$，则接受该解。这两种成分定义了两相不混溶间隙（或相环）的边界。如果没有找到这样的有效解，则在此 $P, T$ 条件下无法形成两相混合物，任何整体成分的稳定状态都将是单相。\n\n**步骤 3：给定整体成分的稳定性确定**\n对于测试套件中提供的每个整体成分 $x_{\\mathrm{bulk}}$，我们通过比较吉布斯自由能来确定稳定的相组合。\n\n如果存在一个有效的两相解 $(x^*_{\\mathrm{pv}}, x^*_{\\mathrm{ppv}})$，我们首先检查 $x_{\\mathrm{bulk}}$ 是否位于不混溶间隙内，即 $x^*_{\\mathrm{ppv}}  x_{\\mathrm{bulk}}  x^*_{\\mathrm{pv}}$。\n- 如果 $x_{\\mathrm{bulk}}$ 在间隙内部，系统通过分相形成成分为 $x^*_{\\mathrm{pv}}$ 的钙钛矿和成分为 $x^*_{\\mathrm{ppv}}$ 的后钙钛矿来最小化其吉布斯自由能。状态码为 $2$。后钙钛矿的相摩尔比例 $f$ 由杠杆定则给出：\n$$\nf = \\frac{x_{\\mathrm{bulk}} - x^*_{\\mathrm{pv}}}{x^*_{\\mathrm{ppv}} - x^*_{\\mathrm{pv}}}\n$$\n- 如果 $x_{\\mathrm{bulk}}$ 在间隙外部（或者如果不存在有效的两相解），则单相是稳定的。为确定是哪一相，我们比较在整体成分下两个单相选项的摩尔吉布斯自由能 $g_{\\mathrm{pv}}(T,P,x_{\\mathrm{bulk}})$ 和 $g_{\\mathrm{ppv}}(T,P,x_{\\mathrm{bulk}})$，它们使用完整的正规溶体模型计算得出：\n$$\ng_{\\phi}(T,P,x) = x\\,g_{\\phi,\\mathrm{Fe}} + (1-x)\\,g_{\\phi,\\mathrm{Mg}} + R\\,T\\left[x\\ln x + (1-x)\\ln(1-x)\\right] + W_{\\phi}\\,x(1-x)\n$$\n  - 如果 $g_{\\mathrm{pv}}(x_{\\mathrm{bulk}})  g_{\\mathrm{ppv}}(x_{\\mathrm{bulk}})$，钙钛矿相是稳定的。状态码为 $0$，$f=0$，且 $x_{\\mathrm{pv}} = x_{\\mathrm{ppv}} = x_{\\mathrm{bulk}}$。\n  - 如果 $g_{\\mathrm{ppv}}(x_{\\mathrm{bulk}})  g_{\\mathrm{pv}}(x_{\\mathrm{bulk}})$，后钙钛矿相是稳定的。状态码为 $1$，$f=1$，且 $x_{\\mathrm{pv}} = x_{\\mathrm{ppv}} = x_{\\mathrm{bulk}}$。\n\n此过程被系统地应用于每个测试用例以生成最终结果。该实现利用 `scipy` 库中的一个数值求根算法来求解两相成分的非线性方程组。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Solves for the stable phase assemblage of a binary solid solution\n    by minimizing the Gibbs free energy at a fixed pressure and temperature.\n    \"\"\"\n    \n    # --- Step 1: Define constants and calculate thermodynamic parameters ---\n    \n    # Fixed conditions and constants\n    P = 120.0  # GPa\n    T = 2500.0 # K\n    R = 8.314  # J/mol/K\n    RT = R * T\n\n    # Coefficients for Gibbs free energy polynomials: g = a0 + aT*T + aP*P + aTP*T*P\n    coeffs = {\n        \"pv_Mg\": np.array([-5.95e5, 48.0, 400.0, -4.8e-3]),\n        \"pv_Fe\": np.array([-5.85e5, 44.0, 420.0, -4.6e-3]),\n        \"ppv_Mg\": np.array([-6.10e5, 52.0, 380.0, -4.5e-3]),\n        \"ppv_Fe\": np.array([-5.90e5, 50.0, 390.0, -4.4e-3]),\n    }\n    \n    # Calculate endmember Gibbs free energies at T, P\n    g_endmembers = {\n        name: c[0] + c[1]*T + c[2]*P + c[3]*T*P\n        for name, c in coeffs.items()\n    }\n    g_pv_Mg = g_endmembers[\"pv_Mg\"]\n    g_pv_Fe = g_endmembers[\"pv_Fe\"]\n    g_ppv_Mg = g_endmembers[\"ppv_Mg\"]\n    g_ppv_Fe = g_endmembers[\"ppv_Fe\"]\n    \n    # Calculate interaction parameters at T, P\n    W_pv = 20000.0 + 2.0*T - 10.0*P\n    W_ppv = 18000.0 + 1.8*T - 8.0*P\n\n    # --- Step 2: Solve for two-phase equilibrium compositions ---\n\n    def two_phase_equations(x_vec, g_pv_Mg, g_pv_Fe, g_ppv_Mg, g_ppv_Fe, W_pv, W_ppv, RT):\n        \"\"\"System of non-linear equations for chemical potential equality.\"\"\"\n        x1, x2 = x_vec\n        \n        # Check domain to guide solver\n        if not (1e-9  x1  1.0 - 1e-9 and 1e-9  x2  1.0 - 1e-9):\n            return [1e9, 1e9]\n\n        delta_g_Fe = g_pv_Fe - g_ppv_Fe\n        delta_g_Mg = g_pv_Mg - g_ppv_Mg\n\n        eq1 = delta_g_Fe + RT * np.log(x1 / x2) + W_pv * (1 - x1)**2 - W_ppv * (1 - x2)**2\n        eq2 = delta_g_Mg + RT * np.log((1 - x1) / (1 - x2)) + W_pv * x1**2 - W_ppv * x2**2\n        return [eq1, eq2]\n\n    # Arguments for the solver\n    solver_args = (g_pv_Mg, g_pv_Fe, g_ppv_Mg, g_ppv_Fe, W_pv, W_ppv, RT)\n    \n    # Use an initial guess consistent with physical expectations (x_pv > x_ppv)\n    initial_guess = [0.2, 0.1]\n    solution = root(two_phase_equations, initial_guess, args=solver_args, method='hybr')\n\n    x_pv_star, x_ppv_star = None, None\n    two_phase_possible = False\n    if solution.success:\n        x1, x2 = solution.x\n        # Assign pv to Fe-rich and ppv to Mg-rich phase\n        _x_pv_candidate = max(x1, x2)\n        _x_ppv_candidate = min(x1, x2)\n        # Check if the solution is physically valid\n        if 0  _x_ppv_candidate  _x_pv_candidate  1:\n            two_phase_possible = True\n            x_pv_star = _x_pv_candidate\n            x_ppv_star = _x_ppv_candidate\n\n    # --- Step 3: Determine stable assemblage for each test case ---\n\n    def get_gibbs_energy(x, g_Fe, g_Mg, W, RT):\n        \"\"\"Calculates molar Gibbs energy for a single phase.\"\"\"\n        if not (1e-9  x  1.0-1e-9): return np.inf\n        g_mechanical = x * g_Fe + (1 - x) * g_Mg\n        g_ideal_mix = RT * (x * np.log(x) + (1 - x) * np.log(1 - x))\n        g_excess = W * x * (1 - x)\n        return g_mechanical + g_ideal_mix + g_excess\n\n    test_cases = [0.02, 0.10, 0.20, 0.50]\n    results = []\n\n    for x_bulk in test_cases:\n        # Check if bulk composition falls within the two-phase loop\n        if two_phase_possible and x_ppv_star  x_bulk  x_pv_star:\n            state_code = 2\n            f = (x_bulk - x_pv_star) / (x_ppv_star - x_pv_star)\n            x_pv = x_pv_star\n            x_ppv = x_ppv_star\n        else:\n            # Single-phase region: compare Gibbs energies\n            g_pv_bulk = get_gibbs_energy(x_bulk, g_pv_Fe, g_pv_Mg, W_pv, RT)\n            g_ppv_bulk = get_gibbs_energy(x_bulk, g_ppv_Fe, g_ppv_Mg, W_ppv, RT)\n            \n            if g_pv_bulk  g_ppv_bulk:\n                # Perovskite stable\n                state_code = 0\n                f = 0.0\n                x_pv = x_bulk\n                x_ppv = x_bulk\n            else:\n                # Post-perovskite stable\n                state_code = 1\n                f = 1.0\n                x_pv = x_bulk\n                x_ppv = x_bulk\n        \n        results.append([state_code, f, x_pv, x_ppv])\n\n    # Format output according to problem specification\n    formatted_results = []\n    for res in results:\n        s = f\"[{res[0]},{res[1]:.6f},{res[2]:.6f},{res[3]:.6f}]\"\n        formatted_results.append(s)\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}