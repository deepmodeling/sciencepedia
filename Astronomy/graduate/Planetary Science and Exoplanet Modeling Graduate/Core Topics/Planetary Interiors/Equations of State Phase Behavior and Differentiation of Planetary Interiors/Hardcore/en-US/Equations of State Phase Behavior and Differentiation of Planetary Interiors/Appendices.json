{
    "hands_on_practices": [
        {
            "introduction": "This practice focuses on a cornerstone of high-pressure physics: the Mie-Grüneisen equation of state. We will explore how to separate the total pressure inside a planetary body into a \"cold\" component from compression and a \"thermal\" component from heat. By deriving the thermal pressure from fundamental thermodynamic definitions, you will gain a hands-on understanding of how temperature contributes to the internal pressure profile of a planet, a key factor in its structure and evolution .",
            "id": "4159851",
            "problem": "A solid, compositionally homogeneous planetary mantle mineral is modeled with a cold compression curve described by the Vinet equation of state, providing a function $P_{\\text{cold}}(V)$ for the pressure along the $T=0$ K isotherm. The material follows a Mie–Grüneisen thermal model in which the Grüneisen parameter is taken to be constant, $\\gamma=1.3$, and the constant-volume heat capacity obeys the Dulong–Petit limit, $C_V = 3\\,n\\,R$, with $n$ the number of moles and $R$ the universal gas constant. Consider a thermodynamic state at a fixed volume satisfying $V/V_0 = 0.85$, where $V_0$ is the reference volume at the same pressure and a reference temperature $T_{\\text{ref}} = 300\\,\\mathrm{K}$. Using only core thermodynamic definitions, namely the Grüneisen parameter definition $\\gamma \\equiv V\\left(\\partial P/\\partial E\\right)_V$ and the constant-volume heat capacity definition $C_V \\equiv \\left(\\partial E/\\partial T\\right)_V$, derive from first principles and then compute the thermal pressure increment\n$$\\Delta P_{\\text{th}}(V,T) \\equiv P(V,T)-P_{\\text{cold}}(V)$$\nat temperature $T=3000\\,\\mathrm{K}$ and $V/V_0=0.85$. Treat $\\gamma$ and $C_V$ as independent of $T$ and $V$ over the interval of integration and assume the increment is taken relative to $T_{\\text{ref}}=300\\,\\mathrm{K}$ at the same volume. Express your final result in pascals, as a single closed-form analytical expression in terms of $n$, $R$, and $V_0$. Do not include units in your final boxed answer; use $R$ in the International System of Units and `$V_0$` in $\\mathrm{m}^3$ so that the result is in pascals. No rounding is required.",
            "solution": "The problem asks for the calculation of a thermal pressure increment for a solid mineral at a specific volume and temperature, based on a Mie–Grüneisen thermal model. Before proceeding, the problem statement must be validated.\n\n### Step 1: Extract Givens\n-   Equation of state for cold compression: $P_{\\text{cold}}(V)$ from the Vinet equation.\n-   Grüneisen parameter: $\\gamma=1.3$ (constant).\n-   Constant-volume heat capacity: $C_V = 3\\,n\\,R$ (Dulong–Petit limit, constant), where $n$ is the number of moles and $R$ is the universal gas constant.\n-   Volume condition: $V/V_0 = 0.85$, where $V_0$ is the reference volume at the same pressure and a reference temperature $T_{\\text{ref}} = 300\\,\\mathrm{K}$.\n-   Target temperature: $T=3000\\,\\mathrm{K}$.\n-   Reference temperature: $T_{\\text{ref}}=300\\,\\mathrm{K}$.\n-   Fundamental definitions to be used:\n    1.  Grüneisen parameter: $\\gamma \\equiv V\\left(\\frac{\\partial P}{\\partial E}\\right)_V$.\n    2.  Constant-volume heat capacity: $C_V \\equiv \\left(\\frac{\\partial E}{\\partial T}\\right)_V$.\n-   Quantity to compute: The thermal pressure increment $\\Delta P_{\\text{th}}(V,T) \\equiv P(V,T)-P_{\\text{cold}}(V)$ at $T=3000\\,\\mathrm{K}$, with the condition that the increment is calculated relative to the state at $T_{\\text{ref}}=300\\,\\mathrm{K}$ at the same volume.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, employing the standard Mie–Grüneisen equation of state, a cornerstone model in high-pressure solid-state physics and geophysics. The use of a constant Grüneisen parameter and the Dulong–Petit limit for heat capacity are common and valid approximations in the high-temperature regime. The given values are physically plausible. The problem is well-posed, providing all necessary definitions, variables, and constraints to derive a unique analytical expression. The language is objective and formal. The phrasing regarding the \"increment...taken relative to $T_{\\text{ref}}$\" is interpreted to mean the quantity to be computed is the change in pressure at constant volume between $T_{\\text{ref}}$ and $T$, i.e., $P(V,T) - P(V,T_{\\text{ref}})$. This is the most consistent physical interpretation that utilizes all provided information.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be derived from first principles as requested.\n\n### Derivation\nThe objective is to derive an expression for the change in pressure at a fixed volume $V$ as the temperature changes from $T_{\\text{ref}}$ to $T$. We start from the two fundamental thermodynamic definitions provided.\n\nThe definition of the Grüneisen parameter is:\n$$ \\gamma \\equiv V\\left(\\frac{\\partial P}{\\partial E}\\right)_V $$\nwhere $P$ is pressure, $E$ is internal energy, and $V$ is volume. For a process at constant volume, this partial differential equation can be rearranged to:\n$$ dP = \\frac{\\gamma}{V} dE \\quad (\\text{at constant } V) $$\nWe are asked to find the pressure difference between two states at the same volume $V$, but at different temperatures, $T_{\\text{ref}}$ and $T$. Let the corresponding pressures and internal energies be $(P_{\\text{ref}}, E_{\\text{ref}})$ and $(P, E)$, respectively. Integrating the above expression from the reference state to the final state at constant $V$:\n$$ \\int_{P_{\\text{ref}}}^{P} dP' = \\int_{E_{\\text{ref}}}^{E} \\frac{\\gamma}{V} dE' $$\nThe problem states that $\\gamma$ can be treated as a constant. Since the volume $V$ is also held constant during this isochoric process, the term $\\frac{\\gamma}{V}$ can be taken outside the integral:\n$$ P - P_{\\text{ref}} = \\frac{\\gamma}{V} \\int_{E_{\\text{ref}}}^{E} dE' $$\n$$ P(V,T) - P(V,T_{\\text{ref}}) = \\frac{\\gamma}{V} [E(V,T) - E(V,T_{\\text{ref}})] $$\nThis equation relates the change in pressure to the change in internal energy at constant volume.\n\nNext, we use the definition of the constant-volume heat capacity:\n$$ C_V \\equiv \\left(\\frac{\\partial E}{\\partial T}\\right)_V $$\nFor a process at constant volume, this can be written as:\n$$ dE = C_V dT \\quad (\\text{at constant } V) $$\nTo find the change in internal energy, $E(V,T) - E(V,T_{\\text{ref}})$, we integrate this expression with respect to temperature from $T_{\\text{ref}}$ to $T$ at constant $V$:\n$$ \\int_{E_{\\text{ref}}}^{E} dE' = \\int_{T_{\\text{ref}}}^{T} C_V(V,T') dT' $$\nThe problem states that $C_V$ can be treated as independent of temperature (and volume). Therefore, $C_V$ is a constant in this integration:\n$$ E(V,T) - E(V,T_{\\text{ref}}) = C_V \\int_{T_{\\text{ref}}}^{T} dT' $$\n$$ E(V,T) - E(V,T_{\\text{ref}}) = C_V (T - T_{\\text{ref}}) $$\n\nNow, we substitute this result for the change in internal energy back into our expression for the change in pressure:\n$$ P(V,T) - P(V,T_{\\text{ref}}) = \\frac{\\gamma C_V}{V} (T - T_{\\text{ref}}) $$\nThis expression represents the pressure increase when a material is heated from $T_{\\text{ref}}$ to $T$ at constant volume. This is precisely the quantity requested by the problem statement: the thermal pressure increment at $T=3000\\,\\mathrm{K}$ relative to the state at $T_{\\text{ref}}=300\\,\\mathrm{K}$. Let us denote this quantity by $\\Delta P$.\n\nWe can now substitute the given values to compute the final expression.\nThe given values are:\n- $\\gamma = 1.3$\n- $C_V = 3\\,n\\,R$\n- $V = 0.85\\,V_0$\n- $T = 3000\\,\\mathrm{K}$\n- $T_{\\text{ref}} = 300\\,\\mathrm{K}$\n\nSubstituting these into our derived formula for $\\Delta P$:\n$$ \\Delta P = \\frac{(1.3) (3\\,n\\,R)}{0.85\\,V_0} (3000 - 300) $$\nFirst, calculate the temperature difference:\n$$ T - T_{\\text{ref}} = 3000 - 300 = 2700\\,\\mathrm{K} $$\nThe expression becomes:\n$$ \\Delta P = \\frac{1.3 \\times 3 \\times n R \\times 2700}{0.85\\,V_0} $$\nNow, we simplify the numerical coefficient:\n$$ \\text{Coefficient} = \\frac{1.3 \\times 3 \\times 2700}{0.85} = \\frac{3.9 \\times 2700}{0.85} $$\nTo simplify the fraction, we can write the decimal numbers as ratios of integers:\n$$ 3.9 = \\frac{39}{10}, \\quad 0.85 = \\frac{85}{100} = \\frac{17}{20} $$\nThe coefficient is:\n$$ \\frac{\\frac{39}{10} \\times 2700}{\\frac{17}{20}} = \\frac{39 \\times 270}{\\frac{17}{20}} = (39 \\times 270) \\times \\frac{20}{17} = \\frac{39 \\times 270 \\times 20}{17} $$\nLet's compute the numerator:\n$$ 39 \\times 270 \\times 20 = 39 \\times (27 \\times 10) \\times 20 = 39 \\times 27 \\times 200 $$\n$$ 39 \\times 27 = (40 - 1) \\times 27 = 40 \\times 27 - 27 = 1080 - 27 = 1053 $$\n$$ 1053 \\times 200 = 210600 $$\nSo the coefficient is:\n$$ \\text{Coefficient} = \\frac{210600}{17} $$\nThe final analytical expression for the thermal pressure increment is:\n$$ \\Delta P = \\frac{210600}{17} \\frac{n R}{V_0} $$\nThe units are consistent. With $R$ in $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, $n$ in $\\mathrm{mol}$, and $V_0$ in $\\mathrm{m}^3$, the units of $\\frac{nR}{V_0}$ are $\\mathrm{J}\\,\\mathrm{m}^{-3}$, which is equivalent to $\\mathrm{N}\\,\\mathrm{m}^{-2}$ or Pascals. The coefficient $\\frac{210600}{17}$ is dimensionless, as is $\\gamma$. The expression is correctly in units of pressure.",
            "answer": "$$\\boxed{\\frac{210600}{17} \\frac{n R}{V_0}}$$"
        },
        {
            "introduction": "Phase transitions are not just lines on a diagram; they are dynamic boundaries within planets that respond to their thermal environment. This exercise connects the thermodynamic rule governing phase transitions, the Clapeyron slope, to the mechanical reality of hydrostatic pressure. You will calculate the vertical topography of a phase boundary caused by lateral temperature variations from mantle convection, demonstrating how thermodynamics sculpts the large-scale structure of planetary interiors .",
            "id": "4159877",
            "problem": "A deep silicate mantle undergoing the transition from magnesium silicate perovskite to post-perovskite has a positive Clapeyron slope at high pressure. Consider an Earth-like exoplanet whose lower mantle at a reference pressure of $120~\\mathrm{GPa}$ contains the perovskite–post-perovskite phase boundary. A lateral convective temperature anomaly produces two adjacent regions, one warmer by $+300~\\mathrm{K}$ and one colder by $-300~\\mathrm{K}$ relative to a reference adiabat at the boundary. Assume the following are representative of conditions at $120~\\mathrm{GPa}$: the Clapeyron slope $dP/dT$ at the boundary is $9~\\mathrm{MPa\\,K^{-1}}$, the density is $\\rho = 5.5 \\times 10^{3}~\\mathrm{kg\\,m^{-3}}$, and the local gravitational acceleration is $g = 10.7~\\mathrm{m\\,s^{-2}}$. Treat the lithostatic pressure gradient as uniform and equal to the hydrostatic value.\n\nStarting from fundamental thermodynamic and mechanical principles, determine the peak-to-trough lateral topography of the phase boundary (the vertical depth difference between the boundary under the warm and cold regions). Express your final answer in kilometers and round your answer to four significant figures.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It provides a set of consistent physical parameters to determine the topographic response of a mineral phase boundary to lateral temperature variations, a standard problem in planetary geodynamics.\n\nThe solution proceeds by combining two fundamental principles: the thermodynamic condition for phase equilibrium, described by the Clausius-Clapeyron relation, and the mechanical condition of hydrostatic equilibrium.\n\nLet $P$ be the pressure and $T$ be the temperature. The perovskite–post-perovskite phase boundary is defined by a curve in the $P-T$ plane. The slope of this curve is the Clapeyron slope, $\\gamma$, given as:\n$$\n\\gamma = \\frac{dP}{dT}\n$$\nFor small deviations from a reference state $(P_0, T_0)$, we can use a linear approximation to relate the change in transition pressure, $\\Delta P$, to the change in temperature, $\\Delta T$:\n$$\n\\Delta P \\approx \\gamma \\Delta T\n$$\n\nThe pressure within the planetary mantle is primarily due to the weight of the overlying rock, a condition known as lithostatic pressure. The problem states to treat this as a hydrostatic pressure gradient. Let $z$ be the depth, measured positive downwards from some reference level. The equation for hydrostatic equilibrium is:\n$$\n\\frac{dP}{dz} = \\rho g\n$$\nwhere $\\rho$ is the density of the material and $g$ is the local gravitational acceleration. The problem allows us to assume $\\rho$ and $g$ are constant over the vertical deflections of the boundary. Integrating this equation yields the relationship between a change in pressure, $\\Delta P$, and a change in depth, $\\Delta z$:\n$$\n\\Delta P = \\rho g \\Delta z\n$$\n\nA lateral variation in temperature $\\Delta T$ will shift the pressure at which the phase transition occurs. For the mantle to remain at the phase boundary, its depth must adjust to match this new transition pressure. By equating the two expressions for $\\Delta P$, we can find the vertical deflection of the phase boundary, $\\Delta z$, caused by a temperature anomaly $\\Delta T$:\n$$\n\\rho g \\Delta z = \\gamma \\Delta T\n$$\nSolving for the depth change $\\Delta z$ gives:\n$$\n\\Delta z = \\frac{\\gamma}{\\rho g} \\Delta T\n$$\n\nThe problem describes two regions adjacent to a reference adiabat: a warm region with a temperature anomaly $\\Delta T_{warm} = +300~\\mathrm{K}$ and a cold region with an anomaly $\\Delta T_{cold} = -300~\\mathrm{K}$.\n\nThe problem gives a positive Clapeyron slope, $\\gamma = 9~\\mathrm{MPa\\,K^{-1}}  0$. This means that a higher temperature requires a higher pressure to induce the phase transition. Since pressure increases with depth, the phase boundary will be located deeper in the warmer region and shallower in the colder region.\n\nThe vertical deflection of the boundary in the warm region, relative to the reference depth, is:\n$$\n\\Delta z_{warm} = \\frac{\\gamma}{\\rho g} \\Delta T_{warm}\n$$\nSince $\\Delta T_{warm}$ is positive, $\\Delta z_{warm}$ is positive, indicating a downward deflection (greater depth).\n\nThe vertical deflection of the boundary in the cold region is:\n$$\n\\Delta z_{cold} = \\frac{\\gamma}{\\rho g} \\Delta T_{cold}\n$$\nSince $\\Delta T_{cold}$ is negative, $\\Delta z_{cold}$ is negative, indicating an upward deflection (shallower depth).\n\nThe peak-to-trough lateral topography is the total vertical distance between the boundary's position in the warm region (the trough, or deepest point) and its position in the cold region (the peak, or shallowest point). This total topography, $\\Delta z_{total}$, is the difference between their depths:\n$$\n\\Delta z_{total} = (\\text{depth in warm region}) - (\\text{depth in cold region})\n$$\nIf $z_0$ is the reference depth, the depths are $z_0 + \\Delta z_{warm}$ and $z_0 + \\Delta z_{cold}$.\n$$\n\\Delta z_{total} = (z_0 + \\Delta z_{warm}) - (z_0 + \\Delta z_{cold}) = \\Delta z_{warm} - \\Delta z_{cold}\n$$\nSubstituting the expressions for the deflections:\n$$\n\\Delta z_{total} = \\frac{\\gamma}{\\rho g} \\Delta T_{warm} - \\frac{\\gamma}{\\rho g} \\Delta T_{cold} = \\frac{\\gamma}{\\rho g} (\\Delta T_{warm} - \\Delta T_{cold})\n$$\nThe total temperature difference between the two regions is $\\Delta T_{warm} - \\Delta T_{cold} = 300~\\mathrm{K} - (-300~\\mathrm{K}) = 600~\\mathrm{K}$.\n\nNow we substitute the given values, ensuring all units are in the International System of Units (SI).\nThe Clapeyron slope is $\\gamma = 9~\\mathrm{MPa\\,K^{-1}} = 9 \\times 10^{6}~\\mathrm{Pa\\,K^{-1}}$.\nThe density is $\\rho = 5.5 \\times 10^{3}~\\mathrm{kg\\,m^{-3}}$.\nThe gravitational acceleration is $g = 10.7~\\mathrm{m\\,s^{-2}}$.\nThe total temperature difference is $\\Delta T_{total} = \\Delta T_{warm} - \\Delta T_{cold} = 600~\\mathrm{K}$.\n\nThe total topography is:\n$$\n\\Delta z_{total} = \\frac{(9 \\times 10^{6}~\\mathrm{Pa\\,K^{-1}}) \\times (600~\\mathrm{K})}{(5.5 \\times 10^{3}~\\mathrm{kg\\,m^{-3}}) \\times (10.7~\\mathrm{m\\,s^{-2}})}\n$$\nCalculating the numerator and denominator:\n$$\n\\text{Numerator} = 9 \\times 10^{6} \\times 600 = 5400 \\times 10^{6} = 5.4 \\times 10^{9}~\\mathrm{Pa}\n$$\n$$\n\\text{Denominator} = 5.5 \\times 10^{3} \\times 10.7 = 58.85 \\times 10^{3}~\\mathrm{kg\\,m^{-2}\\,s^{-2}}\n$$\nThe units of the denominator are $\\mathrm{Pa\\,m^{-1}}$.\n$$\n\\Delta z_{total} = \\frac{5.4 \\times 10^{9}~\\mathrm{Pa}}{5.885 \\times 10^{4}~\\mathrm{Pa\\,m^{-1}}} \\approx 91758.70858~\\mathrm{m}\n$$\nThe problem requires the answer to be expressed in kilometers and rounded to four significant figures.\n$$\n\\Delta z_{total} \\approx 91.7587~\\mathrm{km}\n$$\nRounding to four significant figures gives:\n$$\n\\Delta z_{total} = 91.76~\\mathrm{km}\n$$",
            "answer": "$$\\boxed{91.76}$$"
        },
        {
            "introduction": "Realistic planetary mantles are complex chemical mixtures, not pure substances. This computational practice challenges you to move beyond simple phase diagrams and calculate the stable mineral assemblage for a multi-component solid solution. By implementing Gibbs free energy minimization and the principle of chemical potential equality, you will solve for the equilibrium compositions and proportions of coexisting phases, a core skill in modern computational petrology and planetary modeling .",
            "id": "4159816",
            "problem": "You are given two binary solid-solution phases representative of the lower mantle: perovskite and post-perovskite. The thermodynamic task is to determine the stable phase assemblage and modal proportions for a bulk composition at fixed pressure and temperature by minimizing the Gibbs free energy. You must implement the following from first principles.\n\nAssume a binary substitution between magnesium silicate and iron silicate endmembers, where the composition variable $x$ denotes the mole fraction of iron silicate (dimensionless, as a decimal). At fixed pressure $P$ and temperature $T$, the molar Gibbs free energy of a phase $\\phi \\in \\{\\text{perovskite}, \\text{post-perovskite}\\}$ is modeled by a regular solution:\n$$\ng_{\\phi}(T,P,x) \\;=\\; x\\,g_{\\phi,\\mathrm{Fe}}(T,P) \\;+\\; (1-x)\\,g_{\\phi,\\mathrm{Mg}}(T,P) \\;+\\; R\\,T\\left[x\\ln x + (1-x)\\ln(1-x)\\right] \\;+\\; W_{\\phi}(T,P)\\,x(1-x),\n$$\nwhere $g_{\\phi,\\mathrm{Fe}}(T,P)$ and $g_{\\phi,\\mathrm{Mg}}(T,P)$ are the standard molar Gibbs free energies (J/mol) of the iron silicate and magnesium silicate endmembers in phase $\\phi$, $R$ is the universal gas constant, and $W_{\\phi}(T,P)$ is the symmetric interaction parameter (J/mol) for phase $\\phi$. For a binary substitution on a single sublattice within the regular solution model, the component chemical potentials are:\n$$\n\\mu_{\\phi,\\mathrm{Fe}}(x) \\;=\\; g_{\\phi,\\mathrm{Fe}}(T,P) \\;+\\; R\\,T\\,\\ln x \\;+\\; W_{\\phi}(T,P)\\,(1-x)^2,\n$$\n$$\n\\mu_{\\phi,\\mathrm{Mg}}(x) \\;=\\; g_{\\phi,\\mathrm{Mg}}(T,P) \\;+\\; R\\,T\\,\\ln(1-x) \\;+\\; W_{\\phi}(T,P)\\,x^2.\n$$\nAt equilibrium among phases at fixed $P$ and $T$, the chemical potentials of each component are equal across coexisting phases, and the mass balance (lever rule) holds. The governing constraints for a two-phase assemblage are:\n- Chemical potential equalities:\n$$\n\\mu_{\\mathrm{perovskite},\\mathrm{Fe}}(x_{\\mathrm{pv}}) \\;=\\; \\mu_{\\mathrm{post\\text{-}perovskite},\\mathrm{Fe}}(x_{\\mathrm{ppv}}), \\quad\n\\mu_{\\mathrm{perovskite},\\mathrm{Mg}}(x_{\\mathrm{pv}}) \\;=\\; \\mu_{\\mathrm{post\\text{-}perovskite},\\mathrm{Mg}}(x_{\\mathrm{ppv}}).\n$$\n- Mass balance for bulk composition $x_{\\mathrm{bulk}}$:\n$$\n(1-f)\\,x_{\\mathrm{pv}} \\;+\\; f\\,x_{\\mathrm{ppv}} \\;=\\; x_{\\mathrm{bulk}},\n$$\nwhere $f$ is the modal proportion (mole fraction) of post-perovskite in the assemblage (dimensionless, as a decimal), and $(1-f)$ is the modal proportion of perovskite. If the two-phase solution violates $0 \\le f \\le 1$ or $x_{\\mathrm{pv}} = x_{\\mathrm{ppv}}$, the stable assemblage is the single phase with the lower molar Gibbs free energy $g_{\\phi}(T,P,x_{\\mathrm{bulk}})$.\n\nUse the following parameterizations at $P = 120\\,\\mathrm{GPa}$ and $T = 2500\\,\\mathrm{K}$:\n\n- Universal gas constant: $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- Endmember Gibbs polynomials, in $\\mathrm{J/mol}$, with $P$ in $\\mathrm{GPa}$ and $T$ in $\\mathrm{K}$:\n  - Perovskite endmembers:\n    $$\n    g_{\\mathrm{pv},\\mathrm{Mg}}(T,P) = a_{0,\\mathrm{pv,Mg}} + a_{T,\\mathrm{pv,Mg}}\\,T + a_{P,\\mathrm{pv,Mg}}\\,P + a_{TP,\\mathrm{pv,Mg}}\\,T\\,P,\n    $$\n    $$\n    g_{\\mathrm{pv},\\mathrm{Fe}}(T,P) = a_{0,\\mathrm{pv,Fe}} + a_{T,\\mathrm{pv,Fe}}\\,T + a_{P,\\mathrm{pv,Fe}}\\,P + a_{TP,\\mathrm{pv,Fe}}\\,T\\,P,\n    $$\n    with coefficients:\n    $a_{0,\\mathrm{pv,Mg}} = -5.95\\times 10^{5}$, $a_{T,\\mathrm{pv,Mg}} = 48$, $a_{P,\\mathrm{pv,Mg}} = 400$, $a_{TP,\\mathrm{pv,Mg}} = -4.8\\times 10^{-3}$;\n    $a_{0,\\mathrm{pv,Fe}} = -5.85\\times 10^{5}$, $a_{T,\\mathrm{pv,Fe}} = 44$, $a_{P,\\mathrm{pv,Fe}} = 420$, $a_{TP,\\mathrm{pv,Fe}} = -4.6\\times 10^{-3}$.\n  - Post-perovskite endmembers:\n    $$\n    g_{\\mathrm{ppv},\\mathrm{Mg}}(T,P) = a_{0,\\mathrm{ppv,Mg}} + a_{T,\\mathrm{ppv,Mg}}\\,T + a_{P,\\mathrm{ppv,Mg}}\\,P + a_{TP,\\mathrm{ppv,Mg}}\\,T\\,P,\n    $$\n    $$\n    g_{\\mathrm{ppv},\\mathrm{Fe}}(T,P) = a_{0,\\mathrm{ppv,Fe}} + a_{T,\\mathrm{ppv,Fe}}\\,T + a_{P,\\mathrm{ppv,Fe}}\\,P + a_{TP,\\mathrm{ppv,Fe}}\\,T\\,P,\n    $$\n    with coefficients:\n    $a_{0,\\mathrm{ppv,Mg}} = -6.10\\times 10^{5}$, $a_{T,\\mathrm{ppv,Mg}} = 52$, $a_{P,\\mathrm{ppv,Mg}} = 380$, $a_{TP,\\mathrm{ppv,Mg}} = -4.5\\times 10^{-3}$;\n    $a_{0,\\mathrm{ppv,Fe}} = -5.90\\times 10^{5}$, $a_{T,\\mathrm{ppv,Fe}} = 50$, $a_{P,\\mathrm{ppv,Fe}} = 390$, $a_{TP,\\mathrm{ppv,Fe}} = -4.4\\times 10^{-3}$.\n- Interaction parameters, in $\\mathrm{J/mol}$:\n  $$\n  W_{\\mathrm{pv}}(T,P) = 20000 + 2\\,T - 10\\,P, \\quad\n  W_{\\mathrm{ppv}}(T,P) = 18000 + 1.8\\,T - 8\\,P.\n  $$\n\nThermodynamic criteria at $P = 120\\,\\mathrm{GPa}$ and $T = 2500\\,\\mathrm{K}$:\n1. Compute $g_{\\phi,\\mathrm{Fe}}(T,P)$ and $g_{\\phi,\\mathrm{Mg}}(T,P)$ for each phase $\\phi$.\n2. For a given bulk composition $x_{\\mathrm{bulk}}$, evaluate the single-phase molar Gibbs energies $g_{\\mathrm{pv}}(T,P,x_{\\mathrm{bulk}})$ and $g_{\\mathrm{ppv}}(T,P,x_{\\mathrm{bulk}})$.\n3. Attempt two-phase equilibrium by solving for $x_{\\mathrm{pv}}$ and $x_{\\mathrm{ppv}}$ that satisfy the chemical potential equalities. Then compute $f$ from the mass balance. Accept the two-phase solution only if $0 \\le f \\le 1$ and $0  x_{\\mathrm{ppv}}  x_{\\mathrm{pv}}  1$ (iron-enrichment in perovskite and magnesium-enrichment in post-perovskite are physically expected under the given parameterization). Compute the mixture molar Gibbs energy $g_{\\mathrm{mix}} = (1-f)\\,g_{\\mathrm{pv}}(T,P,x_{\\mathrm{pv}}) + f\\,g_{\\mathrm{ppv}}(T,P,x_{\\mathrm{ppv}})$.\n4. Select the assemblage with the lowest molar Gibbs energy among the valid two-phase mixture and the single-phase options.\n\nYour program must produce, for each test case, a list with four entries: $[\\text{state code}, f, x_{\\mathrm{pv}}, x_{\\mathrm{ppv}}]$, where:\n- $\\text{state code}$ is an integer: $0$ for perovskite-only, $1$ for post-perovskite-only, $2$ for two-phase mixture of perovskite and post-perovskite.\n- $f$ is the modal proportion of post-perovskite (dimensionless decimal).\n- $x_{\\mathrm{pv}}$ and $x_{\\mathrm{ppv}}$ are the equilibrium iron mole fractions in perovskite and post-perovskite (dimensionless decimals). For single-phase results, report $x_{\\mathrm{pv}} = x_{\\mathrm{ppv}} = x_{\\mathrm{bulk}}$ with $f = 0$ for perovskite-only or $f = 1$ for post-perovskite-only.\n\nAll floating-point outputs must be rounded to six decimal places. The pressure must be treated in $\\mathrm{GPa}$, temperature in $\\mathrm{K}$, and all Gibbs energies and interaction parameters in $\\mathrm{J/mol}$. Angles are not involved. Percentages must not be used; compositions are decimals.\n\nTest suite:\n- Case $1$: $x_{\\mathrm{bulk}} = 0.02$.\n- Case $2$: $x_{\\mathrm{bulk}} = 0.10$.\n- Case $3$: $x_{\\mathrm{bulk}} = 0.20$.\n- Case $4$: $x_{\\mathrm{bulk}} = 0.50$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of lists enclosed in square brackets, for the four test cases in order. For example, the outer list must look like $[[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$ and must be printed on one line only.",
            "solution": "The problem requires the determination of the stable phase assemblage for a binary (Mg,Fe)-silicate solid solution at a fixed pressure ($P$) and temperature ($T$) by minimizing the total Gibbs free energy of the system. The potential phases are perovskite (pv) and post-perovskite (ppv). The solution follows the principles of chemical thermodynamics for multi-component, multi-phase systems.\n\nThe guiding principle is that a system at constant $P$ and $T$ will attain equilibrium in the state corresponding to the global minimum of its total Gibbs free energy. For a given bulk composition, this state can either be a single homogeneous phase or a mixture of two or more phases. The problem is solved algorithmically as follows:\n\n**Step 1: Calculation of Thermodynamic Parameters**\nFirst, we evaluate all thermodynamic parameters that are constant at the given pressure $P = 120\\,\\mathrm{GPa}$ and temperature $T = 2500\\,\\mathrm{K}$.\n\nThe universal gas constant is $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$. The thermal energy term is $R\\,T = 8.314 \\times 2500 = 20785\\,\\mathrm{J\\,mol^{-1}}$.\n\nThe molar Gibbs free energies of the pure endmembers, $g_{\\phi,\\mathrm{Mg}}(T,P)$ and $g_{\\phi,\\mathrm{Fe}}(T,P)$, are calculated using the provided polynomial expressions:\n$g(T,P) = a_0 + a_T T + a_P P + a_{TP} TP$.\nFor perovskite (pv):\n$$\ng_{\\mathrm{pv},\\mathrm{Mg}} = -5.95\\times 10^{5} + 48(2500) + 400(120) - 4.8\\times 10^{-3}(2500)(120) = -428440\\,\\mathrm{J\\,mol^{-1}}\n$$\n$$\ng_{\\mathrm{pv},\\mathrm{Fe}} = -5.85\\times 10^{5} + 44(2500) + 420(120) - 4.6\\times 10^{-3}(2500)(120) = -425980\\,\\mathrm{J\\,mol^{-1}}\n$$\nFor post-perovskite (ppv):\n$$\ng_{\\mathrm{ppv},\\mathrm{Mg}} = -6.10\\times 10^{5} + 52(2500) + 380(120) - 4.5\\times 10^{-3}(2500)(120) = -435750\\,\\mathrm{J\\,mol^{-1}}\n$$\n$$\ng_{\\mathrm{ppv},\\mathrm{Fe}} = -5.90\\times 10^{5} + 50(2500) + 390(120) - 4.4\\times 10^{-3}(2500)(120) = -419520\\,\\mathrm{J\\,mol^{-1}}\n$$\n\nThe regular solution interaction parameters, $W_{\\phi}(T,P)$, are also calculated:\n$$\nW_{\\mathrm{pv}} = 20000 + 2(2500) - 10(120) = 23800\\,\\mathrm{J\\,mol^{-1}}\n$$\n$$\nW_{\\mathrm{ppv}} = 18000 + 1.8(2500) - 8(120) = 21540\\,\\mathrm{J\\,mol^{-1}}\n$$\n\n**Step 2: Determination of the Two-Phase Equilibrium Compositions**\nThe possibility of a two-phase (pv + ppv) equilibrium is investigated. If such an equilibrium exists, it is characterized by the compositions $x_{\\mathrm{pv}}$ and $x_{\\mathrm{ppv}}$ at which the chemical potentials of each component (Fe and Mg) are equal in both phases. This is the analytical equivalent of the geometric common-tangent construction on the Gibbs free energy curves. The two governing equations are:\n$$\n\\mu_{\\mathrm{pv},\\mathrm{Fe}}(x_{\\mathrm{pv}}) = \\mu_{\\mathrm{ppv},\\mathrm{Fe}}(x_{\\mathrm{ppv}})\n$$\n$$\n\\mu_{\\mathrm{pv},\\mathrm{Mg}}(x_{\\mathrm{pv}}) = \\mu_{\\mathrm{ppv},\\mathrm{Mg}}(x_{\\mathrm{ppv}})\n$$\nSubstituting the expressions for the chemical potentials in a regular solution model, we obtain a system of two non-linear equations for the two unknown compositions, $x_{\\mathrm{pv}}$ and $x_{\\mathrm{ppv}}$:\n$$\ng_{\\mathrm{pv},\\mathrm{Fe}} + R\\,T\\,\\ln x_{\\mathrm{pv}} + W_{\\mathrm{pv}}(1-x_{\\mathrm{pv}})^2 = g_{\\mathrm{ppv},\\mathrm{Fe}} + R\\,T\\,\\ln x_{\\mathrm{ppv}} + W_{\\mathrm{ppv}}(1-x_{\\mathrm{ppv}})^2\n$$\n$$\ng_{\\mathrm{pv},\\mathrm{Mg}} + R\\,T\\,\\ln(1-x_{\\mathrm{pv}}) + W_{\\mathrm{pv}}(x_{\\mathrm{pv}})^2 = g_{\\mathrm{ppv},\\mathrm{Mg}} + R\\,T\\,\\ln(1-x_{\\mathrm{ppv}}) + W_{\\mathrm{ppv}}(x_{\\mathrm{ppv}})^2\n$$\nThis system is solved numerically. Let the solution pair be $(x_1, x_2)$. We then check if this solution is physically valid, i.e., both compositions are between $0$ and $1$. Based on physical expectations for this system, we assign the larger composition to perovskite, $x^*_{\\mathrm{pv}} = \\max(x_1, x_2)$, and the smaller one to post-perovskite, $x^*_{\\mathrm{ppv}} = \\min(x_1, x_2)$. The two-phase solution is accepted if it adheres to the constraint $0  x^*_{\\mathrm{ppv}}  x^*_{\\mathrm{pv}}  1$. These two compositions define the boundaries of the two-phase miscibility gap (or phase loop). If no such valid solution is found, a two-phase mixture cannot form at this $P, T$, and the stable state for any bulk composition will be a single phase.\n\n**Step 3: Stability Determination for a Given Bulk Composition**\nFor each bulk composition $x_{\\mathrm{bulk}}$ provided in the test suite, we determine the stable assemblage by comparing Gibbs free energies.\n\nIf a valid two-phase solution $(x^*_{\\mathrm{pv}}, x^*_{\\mathrm{ppv}})$ exists, we first check if $x_{\\mathrm{bulk}}$ lies within the miscibility gap, i.e., $x^*_{\\mathrm{ppv}}  x_{\\mathrm{bulk}}  x^*_{\\mathrm{pv}}$.\n- If $x_{\\mathrm{bulk}}$ is inside the gap, the system minimizes its Gibbs energy by unmixing into perovskite of composition $x^*_{\\mathrm{pv}}$ and post-perovskite of composition $x^*_{\\mathrm{ppv}}$. The state code is $2$. The modal proportion of post-perovskite, $f$, is given by the lever rule:\n$$\nf = \\frac{x_{\\mathrm{bulk}} - x^*_{\\mathrm{pv}}}{x^*_{\\mathrm{ppv}} - x^*_{\\mathrm{pv}}}\n$$\n- If $x_{\\mathrm{bulk}}$ is outside the gap (or if no valid two-phase solution exists), a single phase is stable. To determine which one, we compare the molar Gibbs free energies of the two single-phase options at the bulk composition, $g_{\\mathrm{pv}}(T,P,x_{\\mathrm{bulk}})$ and $g_{\\mathrm{ppv}}(T,P,x_{\\mathrm{bulk}})$, calculated using the full regular solution model:\n$$\ng_{\\phi}(T,P,x) = x\\,g_{\\phi,\\mathrm{Fe}} + (1-x)\\,g_{\\phi,\\mathrm{Mg}} + R\\,T\\left[x\\ln x + (1-x)\\ln(1-x)\\right] + W_{\\phi}\\,x(1-x)\n$$\n  - If $g_{\\mathrm{pv}}(x_{\\mathrm{bulk}})  g_{\\mathrm{ppv}}(x_{\\mathrm{bulk}})$, the perovskite phase is stable. The state code is $0$, $f=0$, and $x_{\\mathrm{pv}} = x_{\\mathrm{ppv}} = x_{\\mathrm{bulk}}$.\n  - If $g_{\\mathrm{ppv}}(x_{\\mathrm{bulk}})  g_{\\mathrm{pv}}(x_{\\mathrm{bulk}})$, the post-perovskite phase is stable. The state code is $1$, $f=1$, and $x_{\\mathrm{pv}} = x_{\\mathrm{ppv}} = x_{\\mathrm{bulk}}$.\n\nThis procedure is systematically applied to each test case to generate the final results. The implementation utilizes a numerical root-finding algorithm from the `scipy` library to solve the non-linear system for the two-phase compositions.",
            "answer": "[[1,1.000000,0.020000,0.020000],[2,0.627200,0.180905,0.051910],[0,0.000000,0.200000,0.200000],[0,0.000000,0.500000,0.500000]]"
        }
    ]
}