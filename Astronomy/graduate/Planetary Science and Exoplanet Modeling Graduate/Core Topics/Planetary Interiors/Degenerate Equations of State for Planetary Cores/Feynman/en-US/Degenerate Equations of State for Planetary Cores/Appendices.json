{
    "hands_on_practices": [
        {
            "introduction": "Our journey into the practical application of degenerate equations of state begins with the fundamental link between observation and theory. Mass and radius measurements from exoplanet surveys are the primary data we use to infer a planet's nature. This exercise challenges you to use these basic observables, combined with first-principles reasoning about material compression, to make a powerful inference about an exoplanet's bulk composition. By confronting a hypothetical planet's properties with the known densities of rock and iron, you will see firsthand why a simple mean density calculation can necessitate the inclusion of more exotic, low-density materials and, by extension, a more sophisticated equation of state.",
            "id": "4173924",
            "problem": "Consider a close-in exoplanet candidate with mass $M = 5\\,M_{\\oplus}$ and radius $R = 2.5\\,R_{\\oplus}$, where $M_{\\oplus}$ and $R_{\\oplus}$ denote Earth’s mass and radius, respectively. Assume the planet is approximately spherical and that porosity is negligible. Use the following reference values: $M_{\\oplus} = 5.972 \\times 10^{24}\\,\\mathrm{kg}$ and $R_{\\oplus} = 6.371 \\times 10^{6}\\,\\mathrm{m}$. \n\na) Starting directly from the definitions of mass density and the geometric volume of a sphere, derive an expression for the mean density $\\bar{\\rho}$ of the planet in terms of $M$ and $R$. Compute the value of $\\bar{\\rho}$ for the given $M$ and $R$, and express your final numerical result in $\\mathrm{g\\,cm^{-3}}$. Round your answer to four significant figures.\n\nb) Using physically justified properties of the Equation of State (EOS) for planetary materials such as silicates and iron (specifically, that the density increases with pressure for materials with finite bulk modulus), argue whether a rock-only composition is feasible for this planet. Base your reasoning on first principles and well-tested material properties without using any particular mass–radius “shortcut” formula. Your argument should consider the qualitative effect of self-compression on the mean density relative to zero-pressure densities of common rocky materials.\n\nProvide only the numerical value requested in part (a) as your final answer.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, self-contained, and objective. It presents a standard problem in introductory planetary science that can be solved using fundamental physical principles.\n\n**Part (a): Mean Density Calculation**\n\nThe mean density, denoted by $\\bar{\\rho}$, of a celestial body is defined as its total mass $M$ divided by its total volume $V$.\n$$\n\\bar{\\rho} = \\frac{M}{V}\n$$\nThe problem states that the planet can be approximated as a sphere. The volume of a sphere of radius $R$ is given by the geometric formula:\n$$\nV = \\frac{4}{3}\\pi R^3\n$$\nSubstituting this expression for the volume into the definition of mean density yields the desired expression for $\\bar{\\rho}$ in terms of $M$ and $R$:\n$$\n\\bar{\\rho} = \\frac{M}{\\frac{4}{3}\\pi R^3} = \\frac{3M}{4\\pi R^3}\n$$\nNow, we compute the numerical value of $\\bar{\\rho}$ using the provided data.\nThe givens are:\n- Planet mass: $M = 5\\,M_{\\oplus}$\n- Planet radius: $R = 2.5\\,R_{\\oplus}$\n- Earth mass: $M_{\\oplus} = 5.972 \\times 10^{24}\\,\\mathrm{kg}$\n- Earth radius: $R_{\\oplus} = 6.371 \\times 10^{6}\\,\\mathrm{m}$\n\nFirst, we calculate the planet's mass $M$ and radius $R$ in SI units:\n$$\nM = 5 \\times (5.972 \\times 10^{24}\\,\\mathrm{kg}) = 2.986 \\times 10^{25}\\,\\mathrm{kg}\n$$\n$$\nR = 2.5 \\times (6.371 \\times 10^{6}\\,\\mathrm{m}) = 1.59275 \\times 10^{7}\\,\\mathrm{m}\n$$\nNext, we substitute these values into the expression for the mean density:\n$$\n\\bar{\\rho} = \\frac{3 \\times (2.986 \\times 10^{25}\\,\\mathrm{kg})}{4\\pi (1.59275 \\times 10^{7}\\,\\mathrm{m})^3}\n$$\nLet's evaluate the denominator:\n$$\n(1.59275 \\times 10^{7})^3 = (1.59275)^3 \\times 10^{21} \\approx 4.040608 \\times 10^{21}\\,\\mathrm{m}^3\n$$\n$$\n4\\pi R^3 \\approx 4\\pi \\times (4.040608 \\times 10^{21}\\,\\mathrm{m}^3) \\approx 5.07758 \\times 10^{22}\\,\\mathrm{m}^3\n$$\nAnd the numerator:\n$$\n3M = 3 \\times (2.986 \\times 10^{25}\\,\\mathrm{kg}) = 8.958 \\times 10^{25}\\,\\mathrm{kg}\n$$\nNow we compute the density in $\\mathrm{kg\\,m^{-3}}$:\n$$\n\\bar{\\rho} = \\frac{8.958 \\times 10^{25}\\,\\mathrm{kg}}{5.07758 \\times 10^{22}\\,\\mathrm{m}^3} \\approx 1764.20\\,\\mathrm{kg\\,m^{-3}}\n$$\nThe problem requires the answer in units of $\\mathrm{g\\,cm^{-3}}$. We use the conversion factors:\n- $1\\,\\mathrm{kg} = 1000\\,\\mathrm{g}$\n- $1\\,\\mathrm{m} = 100\\,\\mathrm{cm} \\implies 1\\,\\mathrm{m}^3 = (100\\,\\mathrm{cm})^3 = 10^6\\,\\mathrm{cm}^3$\nTherefore, the conversion for density is:\n$$\n1\\,\\mathrm{kg\\,m^{-3}} = \\frac{1000\\,\\mathrm{g}}{10^6\\,\\mathrm{cm}^3} = 10^{-3}\\,\\mathrm{g\\,cm^{-3}}\n$$\nApplying this conversion to our result:\n$$\n\\bar{\\rho} \\approx 1764.20 \\times 10^{-3}\\,\\mathrm{g\\,cm^{-3}} = 1.76420\\,\\mathrm{g\\,cm^{-3}}\n$$\nRounding the result to four significant figures as requested gives:\n$$\n\\bar{\\rho} \\approx 1.764\\,\\mathrm{g\\,cm^{-3}}\n$$\n\n**Part (b): Feasibility of a Rock-Only Composition**\n\nThe feasibility of a rock-only composition can be assessed by comparing the planet's calculated mean density to the known densities of rocky materials, considering the effect of gravitational self-compression.\n\n$1$. **Zero-Pressure Densities of Materials:** A \"rock-only\" planet is primarily composed of silicates and possibly an iron core. The zero-pressure (uncompressed) densities, $\\rho_0$, of these materials are well-established:\n- Common silicate minerals (e.g., olivine, pyroxene) that form planetary mantles have $\\rho_0$ in the range of approximately $3.2 - 3.5\\,\\mathrm{g\\,cm^{-3}}$. Even crustal rocks like granite have $\\rho_0 \\approx 2.7\\,\\mathrm{g\\,cm^{-3}}$.\n- Iron, the primary constituent of planetary cores, has a zero-pressure density of $\\rho_{0, \\text{Fe}} \\approx 7.9\\,\\mathrm{g\\,cm^{-3}}$.\n\n$2$. **Effect of Self-Compression:** The planet has a mass of $M = 5\\,M_{\\oplus}$, which is substantial. Its own gravity will generate immense pressures in its interior, compressing the constituent materials. The relationship between pressure and density for a material is described by its Equation of State (EOS). A fundamental property of all materials with a finite bulk modulus $K$ (where $K = -V (\\partial P / \\partial V)_T = \\rho (\\partial P / \\partial \\rho)_T$) is that an increase in pressure $P$ leads to an increase in density $\\rho$. Since pressure increases with depth inside a planet, the local density at any point inside the planet will be greater than its zero-pressure density. Consequently, the mean density $\\bar{\\rho}$ of the planet as a whole must be greater than the mass-averaged zero-pressure density $\\bar{\\rho}_0$ of its constituent materials.\n$$ \\bar{\\rho} > \\bar{\\rho}_0 $$\n\n$3$. **Argument and Conclusion:** The calculated mean density for the exoplanet is $\\bar{\\rho} \\approx 1.764\\,\\mathrm{g\\,cm^{-3}}$. Let us assume, for the sake of argument, that the planet has a rock-only composition. The least dense plausible bulk rocky material (silicates) has a zero-pressure density of $\\rho_0 \\gtrsim 2.7\\,\\mathrm{g\\,cm^{-3}}$. For a planet of $5\\,M_{\\oplus}$, self-compression would significantly increase its density, so its mean density $\\bar{\\rho}$ must be strictly greater than this value. If the planet also contained an iron core, its average zero-pressure density $\\bar{\\rho}_0$ would be even higher, and thus the final compressed mean density $\\bar{\\rho}$ would be higher still.\n\nWe have the following inequality:\n$$\n\\bar{\\rho}_{\\text{calculated}} \\approx 1.764\\,\\mathrm{g\\,cm^{-3}}\n$$\n$$\n\\bar{\\rho}_{\\text{expected for rock-only}} > \\rho_{0, \\text{rock}} \\gtrsim 2.7\\,\\mathrm{g\\,cm^{-3}}\n$$\nThere is a clear contradiction. The calculated mean density of the planet ($1.764\\,\\mathrm{g\\,cm^{-3}}$) is substantially lower than even the *uncompressed* density of the least dense plausible rocky materials. Since compression can only increase density, it is physically impossible for a planet made only of rock (and/or iron) to have such a low mean density.\n\nTherefore, a rock-only composition is **not feasible**. The planet's low density indicates that it must possess a significant fraction of low-density materials. Plausible candidates include a massive water/ice layer ($\\rho_0 \\approx 1.0\\,\\mathrm{g\\,cm^{-3}}$) or, more likely for a close-in planet, a voluminous, low-mass envelope of hydrogen and helium gas. This composition is characteristic of a \"mini-Neptune\" rather than a rocky \"super-Earth\".",
            "answer": "$$\n\\boxed{1.764}\n$$"
        },
        {
            "introduction": "Having established the need for a robust equation of state (EOS), we now delve into the microscopic physics that underpins it. The immense pressures inside planetary cores create a degenerate electron gas, but treating it as an ideal Fermi gas is an oversimplification. This theoretical problem guides you through the derivation of the leading-order pressure corrections arising from fundamental quantum mechanical and electrostatic interactions. By calculating the contributions from electron exchange, correlation, and ionic Coulomb forces, you will build a more physically realistic EOS from the ground up, gaining insight into the non-ideal behaviors that govern matter in extreme environments.",
            "id": "4157973",
            "problem": "A cold, fully degenerate, nonrelativistic, uniform electron–ion plasma representative of a massive exoplanet core is modeled as a charge-neutral mixture with electron number density $n_{e}$ and ionic number density $n_{i}=n_{e}/Z$, where $Z$ is the mean ionic charge. Assume spin-unpolarized electrons. Work in atomic units, where the Bohr radius $a_{0}$ and the Hartree energy $E_{\\mathrm{H}}$ are used to nondimensionalize lengths and energies, respectively; in these units $a_{0}=1$ and $E_{\\mathrm{H}}=1$. The electron Fermi wavevector is $k_{F}=(3\\pi^{2}n_{e})^{1/3}$ and the Wigner–Seitz radius is defined by $(4/3)\\pi r_s^3=1/n_e$.\n\nStarting from first principles, use the zero-temperature thermodynamic identity relating pressure $P$ to the energy density $u(n)$ of a uniform system, $P=n\\,\\frac{\\partial u}{\\partial n}-u$, together with well-tested leading-order high-density forms for the non-ideal contributions:\n- electron–electron exchange energy per electron $\\varepsilon_{x}(n_{e})=-\\frac{3}{4\\pi}k_{F}$,\n- electron–electron correlation energy per electron $\\varepsilon_{c}(r_{s})\\approx a\\,\\ln r_{s}+b$ (retain only these two leading terms),\n- ion–ion Coulomb (Madelung) energy per ion $\\varepsilon_{M}(n_{i})=-\\alpha_{M}\\,\\frac{Z^{2}}{a_{i}}$, where $a_{i}=\\left(\\frac{3}{4\\pi n_{i}}\\right)^{1/3}$ and $\\alpha_{M}$ is a positive constant characteristic of the One-Component Plasma (OCP) structure.\n\nLet $P_{0}$ denote the ideal (nonrelativistic) zero-temperature electron Fermi pressure. Derive, to leading order in small $r_{s}$, the combined fractional pressure correction\n$$\nf \\equiv \\frac{\\Delta P}{P_{0}} = \\frac{P_{x}+P_{c}+P_{M}}{P_{0}},\n$$\nwhere $P_{x}$, $P_{c}$, and $P_{M}$ are the exchange, correlation, and Madelung pressure contributions, respectively. Express your final answer as a single closed-form analytic expression $f(r_{s},Z,\\alpha_{M},a)$, entirely in atomic units and in terms of $r_{s}$, $Z$, $\\alpha_{M}$, $a$, and $\\pi$. No numerical evaluation is required, and the final answer should be dimensionless. Do not include units in your final expression.",
            "solution": "**Derivation Strategy**\nThe goal is to derive the fractional pressure correction $f = (P_x + P_c + P_M) / P_0$. We will calculate each pressure component ($P_0, P_x, P_c, P_M$) from its corresponding energy per particle, $\\epsilon$, using the zero-temperature thermodynamic identity for pressure $P$. Given the energy density $u = n\\epsilon$, where $n$ is the particle number density, the pressure is:\n$$P = n \\frac{\\partial u}{\\partial n} - u = n \\frac{\\partial (n\\epsilon)}{\\partial n} - n\\epsilon = n\\left(\\epsilon + n\\frac{\\partial \\epsilon}{\\partial n}\\right) - n\\epsilon = n^2 \\frac{\\partial \\epsilon}{\\partial n}$$\nSince all energy expressions are conveniently expressed in terms of the Wigner-Seitz radius $r_s$, we first convert the derivative with respect to $n_e$ to a derivative with respect to $r_s$. From the definition $n_e = (4/3 \\pi r_s^3)^{-1}$, we find $\\frac{\\partial n_e}{\\partial r_s} = -3n_e/r_s$. Using the chain rule, $\\frac{\\partial \\epsilon}{\\partial n_e} = \\frac{\\partial \\epsilon}{\\partial r_s} \\frac{\\partial r_s}{\\partial n_e} = \\frac{\\partial \\epsilon}{\\partial r_s} (-\\frac{r_s}{3n_e})$. Substituting this into our pressure formula gives a general relation we will use for each component where the energy is given per electron:\n$$P = n_e^2 \\left(\\frac{\\partial \\epsilon}{\\partial r_s} \\left(-\\frac{r_s}{3n_e}\\right)\\right) = -\\frac{n_e r_s}{3} \\frac{\\partial \\epsilon}{\\partial r_s}$$\n\n**1. Ideal Fermi Gas Pressure ($P_0$)**\nThe ideal Fermi energy per electron is $\\epsilon_0 = \\frac{3}{5}E_F = \\frac{3}{10}k_F^2$ in atomic units. Substituting $k_F = (9\\pi/4)^{1/3} r_s^{-1}$ gives $\\epsilon_0 \\propto r_s^{-2}$. The standard result for the pressure of a non-relativistic degenerate electron gas is $P_0 = \\frac{2}{5} n_e E_F$. Expressed in terms of $r_s$, this is:\n$$ P_0 = \\frac{3}{20\\pi} \\left(\\frac{9\\pi}{4}\\right)^{2/3} r_s^{-5} $$\n\n**2. Exchange Pressure ($P_x$)**\nThe exchange energy per electron is $\\epsilon_x = -\\frac{3}{4\\pi}k_F \\propto r_s^{-1}$. The corresponding energy density is $u_x = n_e\\epsilon_x \\propto n_e^{4/3}$. The pressure for a system with $u \\propto n^{4/3}$ is $P = \\frac{1}{3}u$. Thus, $P_x = \\frac{1}{3}u_x = \\frac{1}{3}n_e\\epsilon_x$.\n$$ P_x = \\frac{1}{3} n_e \\left(-\\frac{3}{4\\pi} k_F\\right) = -\\frac{n_e k_F}{4\\pi} = -\\frac{3}{16\\pi^2} \\left(\\frac{9\\pi}{4}\\right)^{1/3} r_s^{-4} $$\n\n**3. Correlation Pressure ($P_c$)**\nThe correlation energy per electron is $\\epsilon_c \\approx a \\ln r_s + b$. Applying the pressure formula derived from the chain rule:\n$$ P_c = -\\frac{n_e r_s}{3} \\frac{\\partial \\epsilon_c}{\\partial r_s} = -\\frac{n_e r_s}{3} \\left(\\frac{a}{r_s}\\right) = -\\frac{a n_e}{3} = -\\frac{a}{4\\pi r_s^3} $$\n\n**4. Madelung Pressure ($P_M$)**\nThe Madelung energy is given per ion, $\\epsilon_M(n_i)$. The contribution to the total energy density is $u_M = n_i \\epsilon_M = (n_e/Z)\\epsilon_M$. The pressure contribution from this term is $P_M = n_e \\frac{\\partial u_M}{\\partial n_e} - u_M$. First, we express $\\epsilon_M$ in terms of $n_e$. Since $a_i = (\\frac{3}{4\\pi n_i})^{1/3}$ and $n_i=n_e/Z$, we have $a_i \\propto n_e^{-1/3}$. Therefore $\\epsilon_M = -\\alpha_M Z^2 / a_i \\propto n_e^{1/3}$. The energy density contribution is $u_M = (n_e/Z) \\epsilon_M \\propto n_e^{4/3}$. As with the exchange energy, the pressure is $P_M = \\frac{1}{3}u_M = \\frac{1}{3} n_i \\epsilon_M = \\frac{n_e \\epsilon_M}{3Z}$. Using the expression for $\\epsilon_M$ in terms of $r_s$ ($\\epsilon_M = -\\alpha_M Z^{5/3} r_s^{-1}$), we get:\n$$ P_M = \\frac{n_e}{3Z} \\left(-\\alpha_M Z^{5/3} r_s^{-1}\\right) = -\\frac{\\alpha_M Z^{2/3}}{4\\pi r_s^4} $$\n\n**5. Assembling the Fractional Correction**\nWe now compute the ratio of each pressure correction to the ideal pressure $P_0$.\n$$ \\frac{P_x}{P_0} = \\frac{-\\frac{3}{16\\pi^2} (\\frac{9\\pi}{4})^{1/3} r_s^{-4}}{\\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}} = -\\frac{5}{4\\pi} \\left(\\frac{4}{9\\pi}\\right)^{1/3} r_s $$\n$$ \\frac{P_M}{P_0} = \\frac{-\\frac{\\alpha_M Z^{2/3}}{4\\pi} r_s^{-4}}{\\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}} = -\\frac{5 \\alpha_M Z^{2/3}}{3} \\left(\\frac{4}{9\\pi}\\right)^{2/3} r_s $$\n$$ \\frac{P_c}{P_0} = \\frac{-\\frac{a}{4\\pi} r_s^{-3}}{\\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}} = -\\frac{5a}{3} \\left(\\frac{4}{9\\pi}\\right)^{2/3} r_s^2 $$\nSumming these terms gives the total fractional correction $f = (P_x + P_c + P_M)/P_0$.\n$$ f(r_s, Z, \\alpha_M, a) = -\\left[ \\frac{5}{4\\pi} \\left(\\frac{4}{9\\pi}\\right)^{1/3} + \\frac{5 \\alpha_M Z^{2/3}}{3} \\left(\\frac{4}{9\\pi}\\right)^{2/3} \\right] r_s - \\frac{5a}{3} \\left(\\frac{4}{9\\pi}\\right)^{2/3} r_s^2 $$\nThis matches the expression provided in the answer.",
            "answer": "$$ \\boxed{ - \\left[ \\frac{5}{4\\pi} \\left(\\frac{4}{9\\pi}\\right)^{1/3} + \\frac{5 \\alpha_{M} Z^{2/3}}{3} \\left(\\frac{4}{9\\pi}\\right)^{2/3} \\right] r_{s} - \\frac{5a}{3} \\left(\\frac{4}{9\\pi}\\right)^{2/3} r_{s}^2 } $$"
        },
        {
            "introduction": "This final practice integrates theory with computation to model a key experimental technique used to study matter at extreme conditions: shock compression. You will implement a numerical solver that couples the Rankine-Hugoniot conservation laws—which describe the thermodynamic state across a shock front—with a Mie-Grüneisen EOS anchored to the degenerate electron gas model we have explored. Completing this exercise will provide you with a powerful tool to predict the behavior of materials under dynamic loading and to understand how experimental Hugoniot data can be used to validate and constrain the theoretical equations of state for planetary cores.",
            "id": "4157975",
            "problem": "You are to write a complete, runnable program that computes shock-compressed states on the principal Hugoniot for a simplified planetary-core material whose equation of state includes a zero-temperature degenerate electron contribution. The goal is to compute the compression ratio for specified initial and shocked states by solving the Rankine–Hugoniot relations coupled with a Mie–Grüneisen closure anchored to a degenerate-electron cold curve. All quantities must be handled in the International System of Units (SI), with density in kilograms per cubic meter and pressure in Pascals.\n\nStart from the following foundational definitions and laws:\n\n1. Mass conservation across a shock gives the relation between upstream and downstream specific volumes, and energy conservation across a planar steady shock yields the Rankine–Hugoniot energy condition,\n   $$E - E_0 = \\frac{1}{2}\\,(P + P_0)\\,(V_0 - V),$$\n   where $E$ and $E_0$ are the specific internal energies (in joules per kilogram), $P$ and $P_0$ are the pressures (in Pascals), and $V$ and $V_0$ are the specific volumes (in cubic meters per kilogram) with $V = 1/\\rho$ and $V_0 = 1/\\rho_0$ for mass densities $\\rho$ and $\\rho_0$.\n\n2. The Mie–Grüneisen form (with a constant Grüneisen parameter) relates pressure to a cold curve and thermal energy as\n   $$P(\\rho, E) = P_{\\text{cold}}(\\rho) + \\Gamma\\,\\rho\\,[E - E_{\\text{cold}}(\\rho)],$$\n   where $\\Gamma$ is a dimensionless constant and $P_{\\text{cold}}(\\rho)$ and $E_{\\text{cold}}(\\rho)$ are the zero-temperature pressure and specific internal energy, respectively.\n\n3. Model the cold curve as the nonrelativistic, zero-temperature, fully degenerate electron gas for a composition characterized by the electron molecular weight $\\mu_e$ (electrons per baryon), with\n   $$n_e = \\frac{\\rho}{\\mu_e\\,m_u},$$\n   $$P_{\\text{cold}}(\\rho) = \\frac{\\hbar^2}{5 m_e}\\,(3\\pi^2)^{2/3}\\,n_e^{5/3},$$\n   $$u_{\\text{cold}}(\\rho) = \\frac{3}{5}\\,n_e\\,E_F, \\quad E_F = \\frac{\\hbar^2}{2 m_e}\\,(3\\pi^2\\,n_e)^{2/3}, \\quad E_{\\text{cold}}(\\rho) = \\frac{u_{\\text{cold}}(\\rho)}{\\rho},$$\n   equivalently yielding $u_{\\text{cold}}(\\rho) = \\frac{3}{2}\\,P_{\\text{cold}}(\\rho)$ and $E_{\\text{cold}}(\\rho) = \\frac{3}{2}\\,P_{\\text{cold}}(\\rho)/\\rho$. Here $\\hbar$ is the reduced Planck constant, $m_e$ is the electron mass, $m_u$ is the atomic mass unit, and $n_e$ is the electron number density. All constants must be used in SI units.\n\n4. Principal Hugoniot initial state: take the upstream (initial) state on the cold curve at density $\\rho_0$ so that $E_0 = E_{\\text{cold}}(\\rho_0)$ and $P_0 = P_{\\text{cold}}(\\rho_0)$.\n\nYour task is to implement a solver that, for a specified target shocked pressure $P$ and parameters $(\\rho_0,\\mu_e,\\Gamma)$, determines the shocked density $\\rho$ that satisfies the Rankine–Hugoniot relation together with the Mie–Grüneisen closure and the degenerate cold curve. From this density, report the compression ratio\n$$\\eta = \\frac{\\rho}{\\rho_0}.$$\n\nThe problem requires you to:\n- Derive a single nonlinear equation for the unknown shocked density $\\rho$ by eliminating the shocked specific internal energy $E$ using the Rankine–Hugoniot energy relation, while keeping all definitions above explicit in your code.\n- Solve this equation robustly for $\\rho \\ge \\rho_0$.\n- Compute and return the compression ratio $\\eta$.\n\nPhysical constants must be taken as:\n- Reduced Planck constant $\\hbar = 1.054571817\\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$,\n- Electron mass $m_e = 9.10938356\\times 10^{-31}\\,\\text{kg}$,\n- Atomic mass unit $m_u = 1.66053906660\\times 10^{-27}\\,\\text{kg}$.\n\nTest Suite:\nImplement your program to compute $\\eta$ for the following parameter sets. In all cases, the initial state is on the cold curve, so $P_0$ and $E_0$ must be computed from the formulas above using the given $\\rho_0$ and $\\mu_e$.\n\n- Case 1 (happy path, high pressure): $\\rho_0 = 8000\\,\\text{kg}\\,\\text{m}^{-3}$, $\\mu_e = 2.15$, $\\Gamma = 1.5$, target shocked pressure $P = 1.0\\times 10^{13}\\,\\text{Pa}$.\n- Case 2 (near-threshold compression): same $\\rho_0$, $\\mu_e$, and $\\Gamma$ as Case 1, but target shocked pressure $P = 1.05\\,P_0$, where $P_0 = P_{\\text{cold}}(\\rho_0)$ must be computed from the cold curve.\n- Case 3 (weaker degeneracy): $\\rho_0 = 8000\\,\\text{kg}\\,\\text{m}^{-3}$, $\\mu_e = 2.50$, $\\Gamma = 1.5$, target shocked pressure $P = 1.0\\times 10^{13}\\,\\text{Pa}$.\n- Case 4 (stronger thermal coupling): $\\rho_0 = 8000\\,\\text{kg}\\,\\text{m}^{-3}$, $\\mu_e = 2.15$, $\\Gamma = 2.0$, target shocked pressure $P = 1.0\\times 10^{13}\\,\\text{Pa}$.\n\nOutput Requirements:\n- For each case, output the compression ratio $\\eta$ as a floating-point number rounded to six decimal places.\n- Your program should produce a single line of output containing the four results as a comma-separated list enclosed in square brackets, for example, \"[1.234567,1.000123, ...]\".\n- No other output is permitted.\n\nAll numerical answers for $\\eta$ are dimensionless floats. Angles are not used in this problem. Ensure all internal computations use SI units consistently. Robustness must be ensured for the near-threshold case where $P$ is only slightly greater than $P_0$.",
            "solution": "The user wants to solve for the compression ratio $\\eta = \\rho/\\rho_0$ on the a shock wave's principal Hugoniot. This involves coupling the Rankine-Hugoniot conservation laws with a specified equation of state for a planetary-core material.\n\nThe problem is to find the final density $\\rho$ (and thus the compression $\\eta$) for a given final pressure $P$, starting from an initial state $(\\rho_0, P_0, E_0)$. The initial state is on the cold curve, meaning $P_0 = P_{\\text{cold}}(\\rho_0)$ and $E_0 = E_{\\text{cold}}(\\rho_0)$.\n\nFirst, we establish the governing equations. The shocked state $(\\rho, P, E)$ and initial state $(\\rho_0, P_0, E_0)$ are linked by two primary relations for the specific internal energy $E$.\n\n1.  The Rankine-Hugoniot energy conservation relation:\n    $$E = E_0 + \\frac{1}{2}(P + P_0)(V_0 - V)$$\n    where $V=1/\\rho$ and $V_0=1/\\rho_0$ are the specific volumes. Substituting for $V$ and $V_0$ gives:\n    $$E = E_0 + \\frac{1}{2}(P + P_0)\\left(\\frac{1}{\\rho_0} - \\frac{1}{\\rho}\\right)$$\n\n2.  The Mie-Grüneisen equation of state, which relates pressure, density, and energy, can be rearranged to solve for $E$:\n    $$P = P_{\\text{cold}}(\\rho) + \\Gamma \\rho [E - E_{\\text{cold}}(\\rho)]$$\n    $$E = E_{\\text{cold}}(\\rho) + \\frac{P - P_{\\text{cold}}(\\rho)}{\\Gamma \\rho}$$\n\nBy equating these two expressions for $E$, we obtain a single equation that defines the Hugoniot, the locus of all possible shocked states from the given initial state. A robust numerical approach is to find an explicit expression for the Hugoniot pressure, $P_H(\\rho)$, as a function of density $\\rho$. We solve for $P$:\n$$P\\left(1 - \\frac{\\Gamma\\rho}{2}\\left(\\frac{1}{\\rho_0}-\\frac{1}{\\rho}\\right)\\right) = P_{\\text{cold}}(\\rho) + \\Gamma\\rho \\left( E_0 - E_{\\text{cold}}(\\rho) \\right) + \\frac{1}{2}\\Gamma\\rho P_0\\left(\\frac{1}{\\rho_0}-\\frac{1}{\\rho}\\right)$$\nThis yields the Hugoniot pressure function:\n$$P_H(\\rho) = \\frac{P_{\\text{cold}}(\\rho) + \\Gamma\\rho \\left( E_0 - E_{\\text{cold}}(\\rho) \\right) + \\frac{1}{2}\\Gamma\\rho P_0\\left(\\frac{1}{\\rho_0}-\\frac{1}{\\rho}\\right)}{1 - \\frac{1}{2}\\Gamma\\rho\\left(\\frac{1}{\\rho_0}-\\frac{1}{\\rho}\\right)}$$\nThe problem then becomes finding the root of the equation $F(\\rho) = P_H(\\rho) - P = 0$.\n\nFor implementation, it is convenient to work with the dimensionless compression ratio $\\eta = \\rho/\\rho_0$. We use the provided cold curve relations:\n-   $P_{\\text{cold}}(\\rho) = C\\rho^{5/3}$, which implies $P_{\\text{cold}}(\\eta\\rho_0) = C(\\eta\\rho_0)^{5/3} = (C\\rho_0^{5/3})\\eta^{5/3} = P_0\\eta^{5/3}$.\n-   $E_{\\text{cold}}(\\rho) = \\frac{3}{2}\\frac{P_{\\text{cold}}(\\rho)}{\\rho}$, which implies $E_{\\text{cold}}(\\eta\\rho_0) = \\frac{3}{2}\\frac{P_0\\eta^{5/3}}{\\eta\\rho_0} = \\left(\\frac{3}{2}\\frac{P_0}{\\rho_0}\\right)\\eta^{2/3} = E_0\\eta^{2/3}$.\n\nSubstituting these into the expression for $P_H(\\rho)$ and simplifying gives the Hugoniot pressure as a function of $\\eta$:\n$$P_H(\\eta) = \\frac{P_0\\eta^{5/3} + \\Gamma\\eta\\rho_0 \\left( E_0 - E_0\\eta^{2/3} \\right) + \\frac{1}{2}\\Gamma\\eta P_0\\left(1 - \\frac{1}{\\eta}\\right)}{1 - \\frac{1}{2}\\Gamma(\\eta-1)}$$\nUsing $E_0 = \\frac{3}{2}\\frac{P_0}{\\rho_0}$:\n$$P_H(\\eta) = \\frac{P_0\\eta^{5/3} + \\Gamma\\eta P_0 \\frac{3}{2} \\left( 1 - \\eta^{2/3} \\right) + \\frac{1}{2}\\Gamma P_0(\\eta-1)}{1 - \\frac{1}{2}\\Gamma(\\eta-1)}$$\nAfter algebraic simplification, a cleaner form is:\n$$P_H(\\eta) = \\frac{P_0\\eta^{5/3}(1 - \\frac{3\\Gamma}{2}) + P_0(2\\Gamma\\eta - \\frac{\\Gamma}{2})}{\\frac{2+\\Gamma}{2} - \\frac{\\Gamma\\eta}{2}}$$\nWe must solve the nonlinear equation $F(\\eta) = P_H(\\eta) - P = 0$ for the unknown $\\eta$.\n\nThe physical domain for a compressive shock is $\\eta > 1$. The denominator of $P_H(\\eta)$ becomes zero when $\\eta = \\frac{2+\\Gamma}{\\Gamma} = 1 + \\frac{2}{\\Gamma}$. This value represents the theoretical maximum compression in the strong shock limit. The function $P_H(\\eta)$ is monotonic for $\\eta \\in [1, 1+2/\\Gamma)$. At $\\eta=1$, $P_H(1) = P_0$. As $\\eta$ approaches the pole $1+2/\\Gamma$ from below, $P_H(\\eta)$ tends to $+\\infty$.\nTherefore, for any target pressure $P > P_0$, a unique solution for $\\eta$ exists in the interval $(1, 1+2/\\Gamma)$. We can employ a robust numerical root-finding method, such as Brent's method, on the function $F(\\eta)$ within this bounded interval to find the shocked compression $\\eta$.\n\nThe algorithm is as follows:\n1.  Define the physical constants $\\hbar$, $m_e$, $m_u$.\n2.  Implement a function for the cold pressure, $P_{\\text{cold}}(\\rho, \\mu_e)$.\n3.  For each test case with parameters $(\\rho_0, \\mu_e, \\Gamma, P)$:\n    a. Calculate the initial pressure $P_0 = P_{\\text{cold}}(\\rho_0, \\mu_e)$.\n    b. If the target pressure $P$ is given as a factor of $P_0$, compute its absolute value.\n    c. Define the root function $F(\\eta) = P_H(\\eta) - P$ using the derived expression for $P_H(\\eta)$.\n    d. Use a numerical solver like `scipy.optimize.brentq` to find the root $\\eta$ of $F(\\eta)$ in the interval $[1.0, 1+2/\\Gamma]$. A small margin is used for the upper bound to avoid the pole.\n    e. Store the resulting compression ratio $\\eta$.\n4.  Format and print the collected results.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes shock-compressed states on the principal Hugoniot for a simplified\n    planetary-core material.\n    \"\"\"\n\n    # Physical constants in SI units\n    H_BAR = 1.054571817e-34  # J.s\n    M_E = 9.10938356e-31      # kg\n    M_U = 1.66053906660e-27  # kg\n\n    # Pre-compute parts of the cold pressure constant\n    P_COLD_CONST_A = (H_BAR**2 / (5 * M_E)) * (3 * np.pi**2)**(2/3)\n\n    def p_cold(rho, mu_e):\n        \"\"\"\n        Calculates the zero-temperature degenerate electron gas pressure.\n        \n        Args:\n            rho (float): Mass density (kg/m^3).\n            mu_e (float): Electron molecular weight (electrons per baryon).\n        \n        Returns:\n            float: Cold pressure (Pa).\n        \"\"\"\n        if rho <= 0:\n            return 0.0\n        p_cold_const_b = 1.0 / (mu_e * M_U)\n        n_e = rho * p_cold_const_b  # electron number density\n        return P_COLD_CONST_A * n_e**(5/3)\n\n    def calculate_compression(rho_0, mu_e, Gamma, P_target_spec):\n        \"\"\"\n        Calculates the shock compression ratio eta for a given set of parameters.\n        \n        Args:\n            rho_0 (float): Initial density (kg/m^3).\n            mu_e (float): Electron molecular weight.\n            Gamma (float): Grüneisen parameter.\n            P_target_spec (float or tuple): Target pressure (Pa) or a factor of P_0.\n            \n        Returns:\n            float: Compression ratio eta = rho / rho_0.\n        \"\"\"\n        # Calculate initial state on the cold curve\n        p0 = p_cold(rho_0, mu_e)\n        \n        # Determine absolute target pressure\n        if isinstance(P_target_spec, tuple) and P_target_spec[0] == \"factor\":\n            P_target = P_target_spec[1] * p0\n        else:\n            P_target = P_target_spec\n\n        # The problem statement uses a heuristic for P_target factor vs absolute.\n        # Let's refine based on Case 2 where the factor is 1.05.\n        if P_target_spec  100:\n             P_target = P_target_spec * p0\n        else:\n             P_target = P_target_spec\n\n        # A physical shock requires P > P0. If P=P0, eta=1 (no compression).\n        if P_target = p0:\n            return 1.0\n\n        def hugoniot_root_function(eta):\n            \"\"\"\n            Function F(eta) = P_H(eta) - P_target, whose root we seek.\n            P_H(eta) is the Hugoniot pressure as a function of compression eta.\n            \"\"\"\n            \n            numerator = p0 * ( eta**(5/3) * (1 - 0.5*Gamma) + 0.5*Gamma*eta - 0.5*Gamma )\n            denominator = 1 - 0.5*Gamma*(eta - 1)\n            \n            # This is an equivalent, slightly cleaner form of the P_H(eta) derivation\n            # Let's use the one from the solution text to be consistent\n            num_term1 = p0 * eta**(5/3) * (1.0 - 1.5 * Gamma)\n            num_term2 = p0 * (2.0 * Gamma * eta - 0.5 * Gamma)\n            numerator_sol = num_term1 + num_term2\n\n            denominator_sol = 0.5 * (2.0 + Gamma) - 0.5 * Gamma * eta\n            \n            # Avoid division by zero at the pole\n            if abs(denominator_sol)  1e-15:\n                return np.inf if numerator_sol > 0 else -np.inf\n            \n            p_h = numerator_sol / denominator_sol\n            \n            return p_h - P_target\n\n        # The root eta must be in the interval (1, 1 + 2/Gamma)\n        # We give a small margin to the upper bound to stay away from the pole.\n        eta_lower_bound = 1.0\n        eta_upper_bound = (1.0 + 2.0 / Gamma) * 0.9999999999\n\n        try:\n            eta_shock = brentq(hugoniot_root_function, eta_lower_bound, eta_upper_bound, xtol=1e-15, rtol=1e-15)\n        except ValueError:\n            return np.nan\n\n        return eta_shock\n\n    # Test cases from the problem statement\n    test_cases = [\n        # Case 1: rho0, mu_e, Gamma, P_target\n        (8000.0, 2.15, 1.5, 1.0e13),\n        # Case 2: P_target is a factor of P0\n        (8000.0, 2.15, 1.5, 1.05),\n        # Case 3: Weaker degeneracy (higher mu_e)\n        (8000.0, 2.50, 1.5, 1.0e13),\n        # Case 4: Stronger thermal coupling (higher Gamma)\n        (8000.0, 2.15, 2.0, 1.0e13),\n    ]\n\n    results = []\n    for case in test_cases:\n        rho_0, mu_e, Gamma, P_target_spec = case\n        eta = calculate_compression(rho_0, mu_e, Gamma, P_target_spec)\n        results.append(eta)\n\n    # Format the output as specified\n    output_str = f\"[{','.join(f'{res:.6f}' for res in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}