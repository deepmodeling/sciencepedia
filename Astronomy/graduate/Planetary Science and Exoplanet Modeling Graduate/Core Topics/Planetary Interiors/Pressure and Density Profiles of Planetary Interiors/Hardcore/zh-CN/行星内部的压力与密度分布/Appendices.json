{
    "hands_on_practices": [
        {
            "introduction": "行星内部的压力剖面是由自身引力和流体静力学平衡共同决定的。本练习将通过一个简化的双层行星模型，带你从第一性原理出发，推导核幔边界的压力。这个实践旨在让你掌握将流体静力学平衡方程 $dP/dr = -\\rho(r)g(r)$ 从行星表面向内积分的核心技巧，这是理解更复杂行星结构模型的基础。",
            "id": "4173247",
            "problem": "考虑一个球对称、不自转的两层行星，它由一个半径为 $R_{c}$、质量密度恒为 $\\rho_{c}$ 的内核，以及一个覆盖其上、质量密度恒为 $\\rho_{m}$、延伸至行星半径 $R$ 的地幔组成。假设内部完全处于牛顿引力（引力常数为 $G$）和静水力学平衡状态。表面压力为零，除自身引力外的外力可忽略不计。仅使用 (i) 静水力学平衡方程 $dP/dr=-\\rho(r)\\,g(r)$ 和 (ii) 通过包含质量 $M(r)$ 表示的牛顿引力定律 $g(r)=G\\,M(r)/r^{2}$，从第一性原理出发，通过将 $dP/dr$ 从行星表面向内地幔积分，推导核幔边界（定义为 $r=R_{c}$）处的压力解析表达式。您的最终表达式必须是仅含 $G$、$\\pi$、$\\rho_{c}$、$\\rho_{m}$、$R_{c}$ 和 $R$ 的单个闭合形式解析表达式。在国际单位制（SI）下，压力以帕斯卡为单位表示。无需进行数值计算或四舍五入。",
            "solution": "首先验证问题，以确保其科学上合理、内容自洽且提法恰当。\n\n### 步骤1：提取已知条件\n-   球对称、不自转的行星。\n-   内核半径：$R_{c}$。\n-   内核密度：$\\rho_{c}$（恒定）。\n-   外地幔密度：$\\rho_{m}$（恒定）。\n-   行星总半径：$R$。\n-   引力常数：$G$。\n-   静水力学平衡条件：$\\frac{dP}{dr} = -\\rho(r)g(r)$。\n-   牛顿引力：$g(r) = \\frac{G M(r)}{r^2}$，其中 $M(r)$ 是半径 $r$ 内包含的质量。\n-   边界条件：表面压力为零，$P(R) = 0$。\n-   外力可忽略不计。\n-   目标是推导核幔边界处的压力 $P(R_c)$ 的解析表达式，该表达式仅含 $G$、$\\pi$、$\\rho_{c}$、$\\rho_{m}$、$R_{c}$ 和 $R$。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学基础：** 该问题基于牛顿引力和静水力学平衡的基本原理，这是行星结构初步建模的标准、公认框架。两层恒定密度模型是一种常见且有效的简化。\n-   **提法恰当：** 该问题提法恰当。它提供了一个微分方程、清晰的积分路径以及必要的边界条件（$P(R)=0$），这些共同保证了 $P(r)$ 存在唯一解。所有必需的参数均已定义。\n-   **目标明确：** 问题以精确、客观的语言陈述，没有歧义或主观看法。\n-   **结论：** 该问题有效，因为它是一致、完整且基于既定的物理原理的。\n\n### 步骤3：结论与行动\n问题有效。将提供详细的解答。\n\n### 推导过程\n对于一个处于静水力学平衡状态的球对称物体，其中心径向距离为 $r$ 处的压力 $P$ 由以下方程决定：\n$$\n\\frac{dP}{dr} = -\\rho(r)g(r)\n$$\n其中 $\\rho(r)$ 是半径 $r$ 处的密度，$g(r)$ 是该半径处的引力加速度。\n\n问题要求我们通过将此方程从表面（$r=R$）向内积分至 $r=R_c$ 来求得核幔边界处的压力 $P(R_c)$。已知表面压力为 $P(R)=0$。\n$$\n\\int_{P(R)}^{P(R_c)} dP = \\int_{R}^{R_c} -\\rho(r)g(r) dr\n$$\n计算左侧并使用 $P(R)=0$ 可得：\n$$\nP(R_c) - P(R) = P(R_c)\n$$\n我们可以反转右侧的积分上下限以消除负号：\n$$\nP(R_c) = \\int_{R_c}^{R} \\rho(r)g(r) dr\n$$\n从 $r=R_c$ 到 $r=R$ 的积分路径完全位于地幔内。因此，对于 $R_c \\leq r \\leq R$ 范围内的任何 $r$，密度是恒定的：$\\rho(r) = \\rho_m$。\n$$\nP(R_c) = \\int_{R_c}^{R} \\rho_m g(r) dr\n$$\n引力加速度 $g(r)$ 由 $g(r) = \\frac{G M(r)}{r^2}$ 给出，其中 $M(r)$ 是半径 $r$ 内包含的质量。对于地幔中的 $r$（$R_c \\le r \\le R$），包含的质量 $M(r)$ 是内核质量与从半径 $R_c$ 到 $r$ 的地幔球壳质量之和。\n\n内核的质量 $M_c$ 是其体积乘以其恒定密度 $\\rho_c$：\n$$\nM_c = \\rho_c \\left(\\frac{4}{3}\\pi R_c^3\\right)\n$$\n从 $R_c$ 到 $r$ 的地幔球壳的质量 $M_{m, shell}(r)$ 是其体积乘以其恒定密度 $\\rho_m$：\n$$\nM_{m, shell}(r) = \\rho_m \\left(\\frac{4}{3}\\pi r^3 - \\frac{4}{3}\\pi R_c^3\\right)\n$$\n总包含质量 $M(r)$ 是 $M_c + M_{m, shell}(r)$ 之和：\n$$\nM(r) = \\frac{4}{3}\\pi \\rho_c R_c^3 + \\frac{4}{3}\\pi \\rho_m (r^3 - R_c^3) = \\frac{4}{3}\\pi \\left[ \\rho_m r^3 + (\\rho_c - \\rho_m)R_c^3 \\right]\n$$\n现在，我们将 $M(r)$ 的这个表达式代入 $g(r)$ 的公式中：\n$$\ng(r) = \\frac{G}{r^2} \\left(\\frac{4}{3}\\pi \\left[ \\rho_m r^3 + (\\rho_c - \\rho_m)R_c^3 \\right]\\right) = \\frac{4\\pi G}{3} \\left( \\rho_m r + \\frac{(\\rho_c - \\rho_m)R_c^3}{r^2} \\right)\n$$\n我们现在可以将 $g(r)$ 的这个表达式代回 $P(R_c)$ 的积分中：\n$$\nP(R_c) = \\int_{R_c}^{R} \\rho_m \\left[ \\frac{4\\pi G}{3} \\left( \\rho_m r + \\frac{(\\rho_c - \\rho_m)R_c^3}{r^2} \\right) \\right] dr\n$$\n将常数从积分中提出：\n$$\nP(R_c) = \\frac{4\\pi G \\rho_m}{3} \\int_{R_c}^{R} \\left( \\rho_m r + (\\rho_c - \\rho_m) R_c^3 r^{-2} \\right) dr\n$$\n我们现在逐项进行积分：\n$$\nP(R_c) = \\frac{4\\pi G \\rho_m}{3} \\left[ \\rho_m \\frac{r^2}{2} + (\\rho_c - \\rho_m) R_c^3 \\frac{r^{-1}}{-1} \\right]_{R_c}^{R}\n$$\n$$\nP(R_c) = \\frac{4\\pi G \\rho_m}{3} \\left[ \\frac{1}{2}\\rho_m r^2 - \\frac{(\\rho_c - \\rho_m)R_c^3}{r} \\right]_{R_c}^{R}\n$$\n现在，我们在积分上下限 $R$ 和 $R_c$ 处计算表达式的值：\n$$\nP(R_c) = \\frac{4\\pi G \\rho_m}{3} \\left\\{ \\left( \\frac{1}{2}\\rho_m R^2 - \\frac{(\\rho_c - \\rho_m)R_c^3}{R} \\right) - \\left( \\frac{1}{2}\\rho_m R_c^2 - \\frac{(\\rho_c - \\rho_m)R_c^3}{R_c} \\right) \\right\\}\n$$\n简化各项：\n$$\nP(R_c) = \\frac{4\\pi G \\rho_m}{3} \\left\\{ \\frac{1}{2}\\rho_m R^2 - \\frac{(\\rho_c - \\rho_m)R_c^3}{R} - \\frac{1}{2}\\rho_m R_c^2 + (\\rho_c - \\rho_m)R_c^2 \\right\\}\n$$\n按 $R$ 和 $R_c$ 对各项进行分组：\n$$\nP(R_c) = \\frac{4\\pi G \\rho_m}{3} \\left\\{ \\frac{1}{2}\\rho_m (R^2 - R_c^2) + (\\rho_c - \\rho_m) \\left( R_c^2 - \\frac{R_c^3}{R} \\right) \\right\\}\n$$\n从括号中的第二项中提出因子 $R_c^2$：\n$$\nP(R_c) = \\frac{4\\pi G \\rho_m}{3} \\left\\{ \\frac{1}{2}\\rho_m (R^2 - R_c^2) + (\\rho_c - \\rho_m) R_c^2 \\left( 1 - \\frac{R_c}{R} \\right) \\right\\}\n$$\n为了给出一个单一表达式，我们可以提出常数 $\\frac{2\\pi G}{3}$：\n$$\nP(R_c) = \\frac{2\\pi G}{3} \\left[ \\rho_m^2 (R^2 - R_c^2) + 2\\rho_m (\\rho_c - \\rho_m) R_c^2 \\left(1 - \\frac{R_c}{R}\\right) \\right]\n$$\n这就是以给定参数表示的核幔边界压力的最终闭合形式解析表达式。该表达式在量纲上是一致的，因为项 $G \\rho^2 R^2$ 的单位是压力。",
            "answer": "$$\n\\boxed{\\frac{2\\pi G}{3} \\left[ \\rho_{m}^{2} (R^{2} - R_{c}^{2}) + 2\\rho_{m} (\\rho_{c} - \\rho_{m}) R_{c}^{2} \\left(1 - \\frac{R_{c}}{R}\\right) \\right]}\n$$"
        },
        {
            "introduction": "在掌握了基本积分方法后，我们来探讨物质的可压缩性如何影响行星的内部结构。本练习通过对比两个总质量和半径相同的模型——一个不可压缩的均匀密度球体和一个可压缩的 $n=1$ 多方球体——来揭示状态方程（EOS）的核心作用。通过推导并比较它们的中心压力，你将从物理上理解为什么质量越向中心集中，就需要越高的中心压力来维持流体静力学平衡。",
            "id": "4173216",
            "problem": "一个处于流体静力学平衡中的自引力球形系外行星内部，可以用两种总质量 $M$ 和半径 $R$ 相同的方式来建模。模型A是一个不可压缩的均匀密度球体，其密度在 $0 \\le r \\le R$ 范围内为 $\\rho(r) = \\rho_{0}$。模型B是一个可压缩的多方球体，其指数为 $n=1$，遵循多方物态方程 (EOS) $P = K \\rho^{1 + 1/n}$，当 $n=1$ 时为 $P = K \\rho^{2}$，其中 $K$ 是一个常数。在两个模型中，表面压力均满足 $P(R)=0$。假设为牛顿引力，引力常数为 $G$，并忽略旋转和温度效应。\n\n从流体静力学平衡基本方程 $dP/dr = -G m(r)\\rho(r)/r^{2}$ 和质量守恒方程 $dm/dr = 4\\pi r^{2} \\rho(r)$ 出发，并结合模型B中的多方物态方程，推导出每个模型的中心压力 $P_{c}$，且表达式中只包含 $G$、$M$ 和 $R$。对于模型B，使用适用于多方球体的 Lane–Emden 公式，根据需要引入无量纲变量，在中心处使用正则性条件求解 $n=1$ 时的 Lane–Emden 方程，然后在密度为零的表面应用边界条件。不要使用任何外部公式集；请从第一性原理出发进行推导。\n\n作为你的最终答案，给出中心压力之比的精确简化表达式\n$$\\frac{P_{c,\\mathrm{poly}}}{P_{c,\\mathrm{uniform}}}$$\n其中 $P_{c,\\mathrm{poly}}$ 表示 $n=1$ 多方球体的中心压力，$P_{c,\\mathrm{uniform}}$ 表示均匀密度球体的中心压力。将你的答案表示为闭合形式的解析表达式，不要进行四舍五入。此外，在你的推导过程中，从物理上解释为什么在 $M$ 和 $R$ 相同的情况下，两个模型的中心压力会有所不同。",
            "solution": "对该问题的分析始于为处于流体静力学平衡中的自引力、不旋转的球形天体建立控制方程。这些方程分别是流体静力学支撑方程和质量守恒方程，如下所示：\n$$\n\\frac{dP}{dr} = -\\frac{G m(r) \\rho(r)}{r^2}\n$$\n$$\n\\frac{dm}{dr} = 4\\pi r^2 \\rho(r)\n$$\n此处，$P(r)$ 是压力，$\\rho(r)$ 是密度，$m(r)$ 是半径 $r$ 内包含的质量。$G$ 是引力常数。我们的任务是为两种具有相同总质量 $M$ 和总半径 $R$ 的不同行星结构模型，求出其中心压力 $P_c = P(0)$。\n\n**模型A：不可压缩的均匀密度球体**\n\n对于此模型，密度是常数，$\\rho(r) = \\rho_0$，适用于 $0 \\le r \\le R$。总质量 $M$ 通过以下关系式与该恒定密度 $\\rho_0$ 和总半径 $R$ 相关联：\n$$\nM = \\int_0^R 4\\pi r^2 \\rho_0 dr = \\frac{4}{3}\\pi R^3 \\rho_0\n$$\n因此，均匀密度可以用 $M$ 和 $R$ 表示为：\n$$\n\\rho_0 = \\frac{3M}{4\\pi R^3}\n$$\n半径 $r$ 内包含的质量为：\n$$\nm(r) = \\int_0^r 4\\pi r'^2 \\rho_0 dr' = \\frac{4}{3}\\pi r^3 \\rho_0 = M \\left(\\frac{r}{R}\\right)^3\n$$\n将 $m(r)$ 和 $\\rho(r) = \\rho_0$ 代入流体静力学平衡方程：\n$$\n\\frac{dP}{dr} = -\\frac{G \\left( M \\frac{r^3}{R^3} \\right) \\rho_0}{r^2} = -\\frac{G M \\rho_0}{R^3} r\n$$\n为求得压力分布 $P(r)$，我们使用边界条件 $P(R)=0$，将该方程从一个通用半径 $r$ 积分到表面 $R$：\n$$\n\\int_{P(r)}^{P(R)=0} dP' = -\\int_r^R \\frac{G M \\rho_0}{R^3} r' dr'\n$$\n$$\n-P(r) = -\\frac{G M \\rho_0}{R^3} \\left[ \\frac{r'^2}{2} \\right]_r^R = -\\frac{G M \\rho_0}{2R^3} (R^2 - r^2)\n$$\n因此，任意半径 $r$ 处的压力为：\n$$\nP(r) = \\frac{G M \\rho_0}{2R^3} (R^2 - r^2)\n$$\n为仅用 $G$、$M$ 和 $R$ 表示此式，我们代入 $\\rho_0$ 的表达式：\n$$\nP(r) = \\frac{G M}{2R^3} \\left( \\frac{3M}{4\\pi R^3} \\right) (R^2 - r^2) = \\frac{3GM^2}{8\\pi R^6} (R^2 - r^2)\n$$\n中心压力 $P_{c,\\mathrm{uniform}}$ 是 $r=0$ 处的压力：\n$$\nP_{c,\\mathrm{uniform}} = P(0) = \\frac{3GM^2}{8\\pi R^4}\n$$\n\n**模型B：可压缩的多方球体 ($n=1$)**\n\n对于此模型，压力和密度由指数 $n=1$ 的多方物态方程关联：$P = K \\rho^{1+1/1} = K \\rho^2$，其中 $K$ 是一个常数。我们首先结合流体静力学平衡和质量守恒方程。将流体静力学平衡方程对 $r$ 求导并整理各项，得到恒星结构的一般方程：\n$$\n\\frac{d}{dr}\\left(\\frac{r^2}{\\rho}\\frac{dP}{dr}\\right) = \\frac{d}{dr}(-Gm(r)) = -G \\frac{dm}{dr} = -4\\pi G r^2 \\rho\n$$\n两边除以 $r^2$ 得到：\n$$\n\\frac{1}{r^2} \\frac{d}{dr}\\left(\\frac{r^2}{\\rho}\\frac{dP}{dr}\\right) = -4\\pi G \\rho\n$$\n现在，我们代入多方关系式。由于 $P=K\\rho^2$，我们有 $\\frac{dP}{dr} = 2K\\rho\\frac{d\\rho}{dr}$。将其代入结构方程：\n$$\n\\frac{1}{r^2} \\frac{d}{dr}\\left(\\frac{r^2}{\\rho} \\left(2K\\rho\\frac{d\\rho}{dr}\\right)\\right) = -4\\pi G \\rho\n$$\n$$\n\\frac{2K}{r^2} \\frac{d}{dr}\\left(r^2 \\frac{d\\rho}{dr}\\right) = -4\\pi G \\rho\n$$\n为求解此方程，我们引入无量纲的 Lane–Emden 变量。设 $\\rho_c$ 为中心密度。我们定义无量纲密度变量 $\\theta$ 和无量纲半径变量 $\\xi$ 如下：\n$$\n\\rho = \\rho_c \\theta^n = \\rho_c \\theta \\quad (\\text{对于 } n=1)\n$$\n$$\nr = a\\xi \\quad \\text{其中 } a = \\left[ \\frac{(n+1)K\\rho_c^{1/n-1}}{4\\pi G} \\right]^{1/2} = \\left[ \\frac{2K}{4\\pi G} \\right]^{1/2} = \\sqrt{\\frac{K}{2\\pi G}}\n$$\n将这些代入微分方程：$dr=ad\\xi$ 且 $d\\rho = \\rho_c d\\theta$。\n方程左边变为：\n$$\n\\frac{2K}{(a\\xi)^2} \\frac{d}{a d\\xi}\\left((a\\xi)^2 \\rho_c \\frac{d\\theta}{a d\\xi}\\right) = \\frac{2K\\rho_c}{a^2 \\xi^2} \\frac{d}{d\\xi}\\left(\\xi^2 \\frac{d\\theta}{d\\xi}\\right)\n$$\n将其与右边 $-4\\pi G \\rho = -4\\pi G \\rho_c \\theta$ 相等：\n$$\n\\frac{2K\\rho_c}{a^2 \\xi^2} \\frac{d}{d\\xi}\\left(\\xi^2 \\frac{d\\theta}{d\\xi}\\right) = -4\\pi G \\rho_c \\theta\n$$\n$$\n\\frac{1}{\\xi^2} \\frac{d}{d\\xi}\\left(\\xi^2 \\frac{d\\theta}{d\\xi}\\right) = -\\frac{4\\pi G a^2}{2K} \\theta\n$$\n代入长度标度 $a^2 = K/(2\\pi G)$ 的表达式：\n$$\n\\frac{1}{\\xi^2} \\frac{d}{d\\xi}\\left(\\xi^2 \\frac{d\\theta}{d\\xi}\\right) = -\\frac{4\\pi G}{2K} \\left(\\frac{K}{2\\pi G}\\right) \\theta = -\\theta\n$$\n这就是 $n=1$ 时的 Lane-Emden 方程。这个二阶常微分方程 $\\theta'' + \\frac{2}{\\xi}\\theta' + \\theta = 0$ 需要在中心处（$r=0$，因此 $\\xi=0$）使用正则性条件来求解：密度是有限的，$\\rho(0)=\\rho_c$，这意味着 $\\theta(0)=1$；压力梯度为零，这意味着 $\\frac{d\\theta}{d\\xi}|_{\\xi=0}=0$。\n其通解为 $\\theta(\\xi) = A \\frac{\\sin\\xi}{\\xi} + B \\frac{\\cos\\xi}{\\xi}$。条件 $\\theta(0)=1$ 要求 $B=0$ 且 $A=1$。因此，具有物理意义的解是：\n$$\n\\theta(\\xi) = \\frac{\\sin\\xi}{\\xi}\n$$\n位于 $r=R$ 的行星表面被定义为密度（以及压力）降为零的点。这对应于 $\\theta(\\xi)$ 的第一个非平凡零点，我们将其记为 $\\xi_1$。\n$$\n\\theta(\\xi_1) = \\frac{\\sin\\xi_1}{\\xi_1} = 0 \\implies \\sin\\xi_1 = 0 \\implies \\xi_1 = \\pi\n$$\n所以，行星的半径为 $R = a\\xi_1 = a\\pi$。这将物理半径与标度因子 $a$ 联系起来。\n总质量 $M$ 通过对密度分布积分得到：\n$$\nM = \\int_0^R 4\\pi r^2 \\rho dr = \\int_0^{\\xi_1} 4\\pi (a\\xi)^2 (\\rho_c \\theta(\\xi)) (a d\\xi) = 4\\pi a^3 \\rho_c \\int_0^\\pi \\xi^2 \\frac{\\sin\\xi}{\\xi} d\\xi = 4\\pi a^3 \\rho_c \\int_0^\\pi \\xi \\sin\\xi d\\xi\n$$\n该积分的计算结果为 $\\int_0^\\pi \\xi \\sin\\xi d\\xi = [-\\xi\\cos\\xi+\\sin\\xi]_0^\\pi = \\pi$。\n因此，质量为 $M = 4\\pi^2 a^3 \\rho_c$。\n我们现在用 $M$、$R$ 和 $G$ 来表示中心压力 $P_{c,\\mathrm{poly}} = K\\rho_c^2$。根据我们得到的关系式：\n$a = \\frac{R}{\\pi}$\n$M = 4\\pi^2 a^3 \\rho_c = 4\\pi^2 \\left(\\frac{R}{\\pi}\\right)^3 \\rho_c = \\frac{4R^3}{\\pi} \\rho_c \\implies \\rho_c = \\frac{\\pi M}{4R^3}$。\n$a^2 = \\frac{R^2}{\\pi^2}$ 且 $a^2 = \\frac{K}{2\\pi G} \\implies K = 2\\pi G a^2 = 2\\pi G \\frac{R^2}{\\pi^2} = \\frac{2GR^2}{\\pi}$。\n现在我们计算中心压力：\n$$\nP_{c,\\mathrm{poly}} = K \\rho_c^2 = \\left(\\frac{2GR^2}{\\pi}\\right) \\left(\\frac{\\pi M}{4R^3}\\right)^2 = \\frac{2GR^2}{\\pi} \\frac{\\pi^2 M^2}{16R^6} = \\frac{2\\pi G M^2 R^2}{16R^6} = \\frac{\\pi GM^2}{8R^4}\n$$\n\n**物理比较与中心压力之比**\n\n多方模型的中心压力高于均匀密度模型。为了理解原因，我们比较它们的质量分布。均匀模型的密度为 $\\rho_0 = \\frac{3M}{4\\pi R^3}$。多方模型的中心密度为 $\\rho_c = \\frac{\\pi M}{4R^3}$。对于 $n=1$ 的多方球体，其中心密度与平均密度 $\\bar{\\rho} = \\rho_0 = \\frac{3M}{4\\pi R^3}$ 之比为 $\\frac{\\rho_c}{\\bar{\\rho}} = \\frac{\\pi M/4R^3}{3M/(4\\pi R^3)} = \\frac{\\pi^2}{3} \\approx 3.29$。这表明多方模型的中心凝聚程度要高得多。\n任何一点的压力都必须支撑其上方所有质量的引力。在一个中心凝聚程度更高的天体中，更大比例的总质量位于其内部深处，在那里它对自身和外层施加强大的引力。为了抵抗这种更强的自引力并维持流体静力学平衡，就需要更大的压力梯度，因此也需要更高的中心压力。\n\n最后，我们计算中心压力之比：\n$$\n\\frac{P_{c,\\mathrm{poly}}}{P_{c,\\mathrm{uniform}}} = \\frac{\\frac{\\pi G M^2}{8R^4}}{\\frac{3 G M^2}{8\\pi R^4}} = \\frac{\\pi/8}{3/(8\\pi)} = \\frac{\\pi}{8} \\cdot \\frac{8\\pi}{3} = \\frac{\\pi^2}{3}\n$$\n这个比值是一个纯粹的数学常数，与 $M$、$R$ 或 $G$ 无关。",
            "answer": "$$\n\\boxed{\\frac{\\pi^2}{3}}\n$$"
        },
        {
            "introduction": "理论模型为了便于解析求解，通常会做很多简化。在行星科学研究中，我们更多地依赖数值方法来处理真实材料的复杂状态方程。本练习将引导你使用在研究中广泛应用的伯奇-莫纳汉（Birch-Murnaghan）状态方程，通过编写数值程序来求解行星的内部结构。你将通过“打靶法”这一强大的数值技术，计算并比较相同质量的水世界和硅酸盐行星的中心压力，亲身体验真实系外行星建模的核心过程。",
            "id": "4173237",
            "problem": "考虑由单一均匀材料组成的球对称、自引力行星。其内部结构由流体静力学平衡和质量守恒定律决定。从第一性原理出发，这些由以下常微分方程给出：\n$$\\frac{dP}{dr} = - \\frac{G m(r) \\rho(r)}{r^2}, \\qquad \\frac{dm}{dr} = 4\\pi r^2 \\rho(r),$$\n其中 $P$ 是压力，$r$ 是半径，$m(r)$ 是半径 $r$ 内的总质量，$\\rho(r)$ 是密度，$G$ 是引力常数。为使方程组封闭，需要引入与材料相关的状态方程 (EOS)，定义为函数 $P(\\rho)$，它将压力与材料的密度联系起来。使用三阶 Birch-Murnaghan 状态方程，对于参考密度 $\\rho_0$、参考体积模量 $K_0$ 及其在零压下的一阶导数 $K_0'$，该方程给出：\n$$P(\\rho) = \\frac{3}{2}K_0 \\left(\\eta^{7/3} - \\eta^{5/3}\\right)\\left[1 + \\frac{3}{4}(K_0' - 4)\\left(\\eta^{2/3} - 1\\right)\\right], \\quad \\text{其中 } \\eta = \\frac{\\rho}{\\rho_0}。$$\n假设行星是冷的并且是等温的，因此温度不出现在状态方程中。\n\n你的任务是量化一个水世界与一个相同总质量的硅酸盐行星相比，其中心压力的相对变化。每个行星都建模为其各自状态方程下的均匀体。中心压力是 $r=0$ 处的压力，记为 $P_c$，并且必须通过打靶法求解边值问题来确定：选择一个 $P_c$，使用上述方程向外积分，直到表面压力消失，然后调整 $P_c$，使得表面的总质量等于目标质量。你必须以吉帕斯卡 (GPa) 为单位表示中心压力，并四舍五入到三位小数。\n\n使用以下常数和状态方程参数，这些参数对于高压相是科学上合理的：\n- 引力常数：$G = 6.67430\\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$。\n- 地球质量：$M_\\oplus = 5.972\\times 10^{24}\\,\\mathrm{kg}$。\n- 水世界（代表性高压冰，例如冰 VII）：\n  - $\\rho_0 = 1.5\\times 10^3\\,\\mathrm{kg\\,m^{-3}}$，$K_0 = 25\\,\\mathrm{GPa}$，$K_0' = 4.2$。\n- 硅酸盐行星（代表性硅酸镁钙钛矿）：\n  - $\\rho_0 = 3.3\\times 10^3\\,\\mathrm{kg\\,m^{-3}}$，$K_0 = 200\\,\\mathrm{GPa}$，$K_0' = 4.0$。\n在状态方程中，$K_0$ 必须使用帕斯卡单位（因此将 $25\\,\\mathrm{GPa}$ 转换为 $2.5\\times 10^{10}\\,\\mathrm{Pa}$，将 $200\\,\\mathrm{GPa}$ 转换为 $2.0\\times 10^{11}\\,\\mathrm{Pa}$）。\n\n实现一个稳健的数值程序，该程序：\n- 对于给定的成分，选择一个试验中心压力 $P_c$，并使用在 $P_c$ 下由状态方程所隐含的中心密度，从一个小的初始半径 $r_0$ 开始向外积分结构方程。\n- 在半径 $R$ 处停止积分，其中 $P(R)=0$。\n- 计算得到的总质量 $m(R)$ 并迭代 $P_c$，直到 $m(R)$ 高精度地匹配目标质量。\n\n定义中心压力的相对变化为\n$$\\Delta = \\frac{P_{c,\\mathrm{water}} - P_{c,\\mathrm{silicate}}}{P_{c,\\mathrm{silicate}}},$$\n这是无量纲的。报告 $\\Delta$ 并四舍五入到三位小数。\n\n测试套件：\n计算以下三种情况的结果以检验不同体系：\n1. $M = 5\\,M_\\oplus$（目标情景）。\n2. $M = 1\\,M_\\oplus$。\n3. $M = 0.1\\,M_\\oplus$。\n\n对于每种情况，生成一个包含以下内容的三元组：\n- $P_{c,\\mathrm{water}}$，单位为 GPa，四舍五入到三位小数，\n- $P_{c,\\mathrm{silicate}}$，单位为 GPa，四舍五入到三位小数，\n- $\\Delta$（无量綱），四舍五入到三位小数。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个逗号分隔的三个三元组列表，并用方括号括起来。例如，具有以下通用形式的一行\n$$[[P_{w,1},P_{s,1},\\Delta_1],[P_{w,2},P_{s,2},\\Delta_2],[P_{w,3},P_{s,3},\\Delta_3]]$$\n其中每个 $P$ 的单位是 GPa，每个 $\\Delta$ 是无量纲的，均四舍五入到三位小数。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它具有科学依据，定义明确，客观且完整。它描述了行星结构建模中的一个标准问题，可以使用既定的数值技术来解决。我们继续进行完整解答。\n\n该问题要求我们确定给定质量和成分的球对称、自引力行星的内部结构。这由流体静力学平衡和质量守恒原理决定。描述该结构的常微分方程组 (ODE) 如下：\n$$\n\\frac{dP}{dr} = - \\frac{G m(r) \\rho(r)}{r^2} \\quad \\text{(流体静力学平衡)}\n$$\n$$\n\\frac{dm}{dr} = 4\\pi r^2 \\rho(r) \\quad \\text{(质量守恒)}\n$$\n在此，$r$ 是距中心的径向距离，$P(r)$ 是压力，$m(r)$ 是半径 $r$ 内包含的质量，$\\rho(r)$ 是局部密度，$G$ 是引力常数。\n\n为了求解这个包含三个未知函数（$P(r)$, $m(r)$, $\\rho(r)$）的两个方程的系统，需要第三个关系式。这由状态方程 (EOS) 提供，它将压力与所讨论材料的密度联系起来。问题指定了三阶 Birch-Murnaghan 状态方程：\n$$\nP(\\rho) = \\frac{3}{2}K_0 \\left(\\eta^{7/3} - \\eta^{5/3}\\right)\\left[1 + \\frac{3}{4}(K_0' - 4)\\left(\\eta^{2/3} - 1\\right)\\right]\n$$\n其中 $\\eta = \\rho / \\rho_0$，$\\rho_0$ 是零压下的参考密度，$K_0$ 是体积模量，$K_0'$ 是其一阶压力导数。\n\n该问题被表述为一个两点边值问题 (BVP)。边界条件是：\n1.  在中心（$r=0$）：$m(0) = 0$ 且 $P(0) = P_c$，其中 $P_c$ 是未知的中心压力。\n2.  在表面（$r=R$）：$P(R) = 0$ 且 $m(R) = M_{\\text{target}}$，即给定的行星总质量。\n\n我们将使用打靶法来解决这个 BVP。这种数值技术将 BVP 重构为一个初值问题 (IVP)。我们以未知中心压力 $P_c$ 的一个试验值从中心“发射”，并向外积分结构方程。当压力降至零时停止积分，这定义了表面半径 $R$ 和由此产生的总质量 $m(R)$。然后调整 $P_c$ 的试验值，直到计算出的质量 $m(R)$ 与目标质量 $M_{\\text{target}}$ 匹配。这需要一个求根算法。\n\n数值解的核心是一个目标函数，$E(P_c) = m_{\\text{calc}}(P_c) - M_{\\text{target}}$，其中 $m_{\\text{calc}}(P_c)$ 是使用给定 $P_c$ 进行积分得到的质量。我们寻求使 $E(P_c) = 0$ 的根 $P_c$。由于总质量是中心压力的单调递增函数，像 Brent-Dekker 方法这样的稳健的有界求根算法非常适合这项任务。\n\n从中心向外积分结构方程时，在流体静力学平衡方程中 $r=0$ 处会出现一个奇点。这是该问题的标准特征，通过从一个小的非零半径 $r_0$ 开始积分来处理。在 $r_0$ 处的质量和压力的初始值是通过假设恒定的中心密度 $\\rho_c$（通过 EOS 对应于 $P_c$）进行级数展开得到的：\n$$\nm(r_0) = \\int_0^{r_0} 4\\pi r'^2 \\rho_c dr' = \\frac{4\\pi}{3} \\rho_c r_0^3\n$$\n$$\nP(r_0) - P_c = \\int_0^{r_0} -\\frac{G m(r') \\rho_c}{r'^2} dr' = \\int_0^{r_0} -G \\left(\\frac{4\\pi}{3} r' \\rho_c\\right) \\rho_c dr' = -\\frac{2\\pi G \\rho_c^2}{3} r_0^2\n$$\n因此，初始条件为 $m(r_0) = \\frac{4\\pi}{3} \\rho_c r_0^3$ 和 $P(r_0) = P_c - \\frac{2\\pi G \\rho_c^2}{3} r_0^2$。\n\n状态向量 $y(r) = [m(r), P(r)]^T$ 的数值积分使用自适应步长的 Runge-Kutta 方法进行，如 `scipy.integrate.solve_ivp` 中所实现的。在每个积分步骤中，对于给定的压力 $P$，必须通过数值反演 Birch-Murnaghan 状态方程来找到相应的密度 $\\rho$。这本身就是一个求根问题，即求解 $P_{\\text{BM}}(\\rho) - P = 0$ 以得到 $\\rho$。我们再次使用数值求根器来达到此目的。当 $P(r)$ 恰好穿过零时，积分终止，这一特性由 ODE 求解器的事件检测功能处理。\n\n总体算法如下：\n1.  对于每个目标质量 $M_{\\text{target}}$ 和成分（水或硅酸盐）：\n    a. 定义一个误差函数，它接受一个试验中心压力 $P_c$作为输入。\n    b. 在此函数内部：\n        i.   通过对 $P_c$ 反演状态方程来计算中心密度 $\\rho_c$。\n        ii.  在一个小半径 $r_0$ 处设置初始条件 $y_0 = [m(r_0), P(r_0)]$。\n        iii. 使用 `solve_ivp` 向外积分 ODE 系统，直到触发 $P(r)=0$ 事件。\n        iv.  返回计算出的最终质量与目标质量之差，$m(R) - M_{\\text{target}}$。\n    c. 使用求根算法（带有 'brentq' 方法的 `scipy.optimize.root_scalar`）来找到使误差函数为零的 $P_c$。\n2.  对于给定的质量，利用收敛的中心压力 $P_{c,\\mathrm{water}}$ 和 $P_{c,\\mathrm{silicate}}$，计算相对变化 $\\Delta = (P_{c,\\mathrm{water}} - P_{c,\\mathrm{silicate}}) / P_{c,\\mathrm{silicate}}$。\n3.  将压力转换为吉帕斯卡 (GPa)，并将所有结果四舍五入到三位小数。\n4.  将所有测试用例的结果编译成指定的输出格式。整个过程在下面的 Python 程序中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Main function to solve the planetary structure problem for the given test cases.\n    \"\"\"\n    # Define physical constants\n    G = 6.67430e-11  # Gravitational constant in m^3 kg^-1 s^-2\n    M_EARTH = 5.972e24  # Earth mass in kg\n\n    # Define EOS parameters for the two compositions\n    eos_params = {\n        'water': {\n            'rho0': 1.5e3,     # kg/m^3\n            'K0': 2.5e10,      # Pa (25 GPa)\n            'K0_prime': 4.2\n        },\n        'silicate': {\n            'rho0': 3.3e3,     # kg/m^3\n            'K0': 2.0e11,      # Pa (200 GPa)\n            'K0_prime': 4.0\n        }\n    }\n\n    # Define test cases: target masses\n    test_masses = [5.0 * M_EARTH, 1.0 * M_EARTH, 0.1 * M_EARTH]\n    \n    # --- Helper Functions ---\n\n    def birch_murnaghan_eos(eta, K0, K0_prime):\n        \"\"\"\n        Calculates pressure from the third-order Birch-Murnaghan EOS.\n        eta = rho / rho0.\n        \"\"\"\n        term1 = eta**(7/3) - eta**(5/3)\n        term2 = 1.0 + 0.75 * (K0_prime - 4.0) * (eta**(2/3) - 1.0)\n        return 1.5 * K0 * term1 * term2\n\n    memo_density = {}\n    def get_density_from_pressure(P, rho0, K0, K0_prime):\n        \"\"\"\n        Numerically inverts the EOS to find density for a given pressure.\n        Uses memoization for performance.\n        \"\"\"\n        # A unique key for memoization\n        key = (P, rho0, K0, K0_prime)\n        if key in memo_density:\n            return memo_density[key]\n        \n        if P == 0:\n            return rho0\n\n        # Function to find root of: BM_EOS(eta) - P = 0\n        def func_to_zero(eta):\n            return birch_murnaghan_eos(eta, K0, K0_prime) - P\n\n        try:\n            # Bracket for eta. P > 0 implies eta > 1.\n            sol = root_scalar(func_to_zero, bracket=[1.0, 200.0], method='brentq')\n            eta_sol = sol.root\n        except ValueError:\n             # If root is not in bracket, try a wider one. This can happen at extreme pressures.\n             sol = root_scalar(func_to_zero, bracket=[1.0, 2000.0], method='brentq')\n             eta_sol = sol.root\n\n        density = eta_sol * rho0\n        memo_density[key] = density\n        return density\n\n    def ode_system(r, y, G_const, params):\n        \"\"\"\n        Defines the system of ODEs for planetary structure.\n        y = [mass, pressure]\n        \"\"\"\n        m, P = y\n        rho0, K0, K0_prime = params['rho0'], params['K0'], params['K0_prime']\n        \n        if P = 0:\n            rho = rho0\n        else:\n            rho = get_density_from_pressure(P, rho0, K0, K0_prime)\n        \n        if r == 0:\n            return [0, 0]\n\n        dmdr = 4.0 * np.pi * r**2 * rho\n        dpdr = -G_const * m * rho / r**2\n        return [dmdr, dpdr]\n\n    def stop_on_pressure_zero(r, y, G_const, params):\n        return y[1] # Event when pressure P=y[1] hits zero\n    stop_on_pressure_zero.terminal = True\n    stop_on_pressure_zero.direction = -1\n\n    def integrate_planet(Pc, params):\n        \"\"\"\n        Performs one \"shot\" of the integration for a given central pressure Pc.\n        \"\"\"\n        rho0, K0, K0_prime = params['rho0'], params['K0'], params['K0_prime']\n        \n        # Central density from central pressure\n        rho_c = get_density_from_pressure(Pc, rho0, K0, K0_prime)\n        \n        # Initial conditions at a small radius r0 to avoid singularity\n        r0 = 1.0  # meters\n        m0 = (4.0/3.0) * np.pi * r0**3 * rho_c\n        P0 = Pc - (2.0/3.0) * np.pi * G * rho_c**2 * r0**2\n        \n        if P0 = 0: # Central pressure must be high enough\n            return 0.0\n\n        y0 = [m0, P0]\n        \n        # Integration span up to a large radius\n        r_max = 5e7 # 50,000 km\n        \n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=[r0, r_max],\n            y0=y0,\n            args=(G, params),\n            events=stop_on_pressure_zero,\n            method='RK45',\n            rtol=1e-8,\n            atol=1e-8\n        )\n        \n        # Return final mass\n        if sol.status == 1 and sol.y_events[0].size > 0:\n            final_mass = sol.y_events[0][0][0]\n            return final_mass\n        else: # Integration failed or P never reached zero\n            return sol.y[0, -1]\n\n    def find_central_pressure(target_mass, params):\n        \"\"\"\n        Implements the shooting method to find the correct central pressure.\n        \"\"\"\n        def error_func(Pc):\n            # Pc must be positive\n            if Pc = 1e8: # minimum sensible pressure ~100 MPa\n                return -target_mass\n            \n            mass_out = integrate_planet(Pc, params)\n            return mass_out - target_mass\n        \n        # Wide pressure bracket for the root finder [Pa]\n        # (0.1 GPa to 100 TPa) should be sufficient for all cases\n        p_low = 1e8\n        p_high = 1e14\n\n        # Check if the bracket is valid\n        err_low = error_func(p_low)\n        err_high = error_func(p_high)\n\n        if np.sign(err_low) == np.sign(err_high):\n            # This can happen if p_high is not high enough for a very massive planet\n            p_high *= 10\n        \n        sol = root_scalar(error_func, bracket=[p_low, p_high], method='brentq')\n        return sol.root\n\n    # --- Main Calculation Loop ---\n    \n    final_results = []\n    \n    for mass in test_masses:\n        # Clear memoization cache for each mass case\n        memo_density.clear()\n        Pc_water = find_central_pressure(mass, eos_params['water'])\n        \n        memo_density.clear()\n        Pc_silicate = find_central_pressure(mass, eos_params['silicate'])\n\n        # Calculate relative change\n        delta = (Pc_water - Pc_silicate) / Pc_silicate\n        \n        # Convert pressures to GPa and round all values\n        Pc_water_gpa = round(Pc_water / 1e9, 3)\n        Pc_silicate_gpa = round(Pc_silicate / 1e9, 3)\n        delta_rounded = round(delta, 3)\n        \n        final_results.append(f\"[{Pc_water_gpa},{Pc_silicate_gpa},{delta_rounded}]\")\n        \n    # Format and print the final output\n    print(f\"[[{','.join(final_results)}]]\")\n\nsolve()\n```"
        }
    ]
}