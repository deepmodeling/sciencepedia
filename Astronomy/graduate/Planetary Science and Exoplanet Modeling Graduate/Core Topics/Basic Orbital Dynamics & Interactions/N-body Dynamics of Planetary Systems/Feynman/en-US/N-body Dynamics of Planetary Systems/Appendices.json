{
    "hands_on_practices": [
        {
            "introduction": "The first step in simplifying the complex N-body problem is often a judicious choice of coordinates. Jacobi coordinates provide a powerful framework that separates the center-of-mass motion and hierarchically structures the relative positions of bodies, which is invaluable for both theoretical analysis and numerical simulation. This exercise  will give you direct, hands-on experience in constructing these coordinates from the more familiar barycentric positions, cementing your understanding of this foundational transformation.",
            "id": "4168043",
            "problem": "Consider a star–planet system in which three planets are modeled as an interacting sub-system, and their coordinates are given in the barycentric frame of the planetary sub-system alone (excluding the host star). Let the three planets have masses $m_{1}$, $m_{2}$, $m_{3}$ and barycentric position vectors $\\mathbf{X}_{1}$, $\\mathbf{X}_{2}$, $\\mathbf{X}_{3}$ at a fixed epoch. Assume the barycentric constraint of the planetary sub-system holds, namely that the center of mass (COM) of the three planets is at the origin, so $\\sum_{i=1}^{3} m_{i} \\mathbf{X}_{i} = \\mathbf{0}$. Using only Newtonian mechanics (translational invariance and the definition of the center of mass), construct hierarchical relative coordinates for this three-body sub-system that eliminate the global translational degree of freedom, and define the corresponding two Jacobi coordinates. Then compute the numerical values of these Jacobi coordinates for the following physically plausible data and verify that the hierarchical mass-weighted definitions are satisfied:\n\n- Masses (in Solar masses): $m_{1} = 1.5 \\times 10^{-3}$, $m_{2} = 4.0 \\times 10^{-4}$, $m_{3} = 1.0 \\times 10^{-3}$.\n- Barycentric positions (in astronomical units, AU): $\\mathbf{X}_{1} = (0.50,\\, 0.10,\\, 0.00)$, $\\mathbf{X}_{2} = (-0.20,\\, 0.40,\\, 0.00)$, $\\mathbf{X}_{3} = (-0.67,\\, -0.31,\\, 0.00)$.\n\nUse the center of mass definition to construct the hierarchical coordinates, derive the inverse mapping back to $\\mathbf{X}_{i}$, and explicitly check that the given $\\mathbf{X}_{i}$ are recovered. Finally, report the two Jacobi vectors as a single row matrix of six entries $(y_{1x},\\, y_{1y},\\, y_{1z},\\, y_{2x},\\, y_{2y},\\, y_{2z})$.\n\nRound your numerical entries to four significant figures. Express coordinates in astronomical units (AU). The final answer must be the row matrix only, with no units included in the box.",
            "solution": "The foundational starting point is translational invariance in Newtonian mechanics and the definition of the center of mass (COM). For masses $m_{i}$ and inertial positions $\\mathbf{X}_{i}$, the COM of a set of bodies is defined by\n$$\n\\mathbf{C} = \\frac{\\sum_{i} m_{i} \\mathbf{X}_{i}}{\\sum_{i} m_{i}}.\n$$\nIn a barycentric frame for the planetary sub-system, $\\mathbf{C} = \\mathbf{0}$ for the three planets, so\n$$\nm_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2} + m_{3} \\mathbf{X}_{3} = \\mathbf{0}.\n$$\nJacobi coordinates are hierarchical relative coordinates constructed to remove the global translation and to reflect the mass-weighted hierarchy. For three bodies, we define two Jacobi vectors by using the COM of the first $k$ bodies at each step.\n\nFirst, define the partial center of mass of bodies $1$ and $2$:\n$$\n\\mathbf{C}_{12} = \\frac{m_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2}}{M_{12}}, \\quad \\text{where} \\quad M_{12} = m_{1} + m_{2}.\n$$\nThe two Jacobi vectors for the three-body sub-system are then defined by\n$$\n\\mathbf{y}_{1} = \\mathbf{X}_{2} - \\mathbf{X}_{1},\n$$\n$$\n\\mathbf{y}_{2} = \\mathbf{X}_{3} - \\mathbf{C}_{12}.\n$$\nThese follow directly from the hierarchical use of the COM: the first vector is the relative coordinate of body $2$ with respect to body $1$, and the second is the position of body $3$ relative to the COM of bodies $1$ and $2$.\n\nWe also derive the inverse mapping from $\\mathbf{y}_{1}$ and $\\mathbf{y}_{2}$ to the barycentric positions $\\mathbf{X}_{i}$. Using $\\mathbf{X}_{2} = \\mathbf{X}_{1} + \\mathbf{y}_{1}$ and the definition of $\\mathbf{C}_{12}$,\n$$\nm_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2} = M_{12} \\mathbf{C}_{12}\n\\quad \\Rightarrow \\quad\n(m_{1} + m_{2}) \\mathbf{X}_{1} + m_{2} \\mathbf{y}_{1} = M_{12} \\mathbf{C}_{12},\n$$\nwhich gives\n$$\n\\mathbf{X}_{1} = \\mathbf{C}_{12} - \\frac{m_{2}}{M_{12}} \\mathbf{y}_{1}, \\quad\n\\mathbf{X}_{2} = \\mathbf{C}_{12} + \\frac{m_{1}}{M_{12}} \\mathbf{y}_{1}.\n$$\nFor the third body,\n$$\n\\mathbf{X}_{3} = \\mathbf{y}_{2} + \\mathbf{C}_{12}.\n$$\nIf the three-body COM is at the origin, then\n$$\nm_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2} + m_{3} \\mathbf{X}_{3} = \\mathbf{0},\n$$\nwhich is consistent with the definitions above because $m_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2} = M_{12} \\mathbf{C}_{12}$ and thus\n$$\nM_{12} \\mathbf{C}_{12} + m_{3} (\\mathbf{y}_{2} + \\mathbf{C}_{12}) = (M_{12} + m_{3}) \\mathbf{C}_{12} + m_{3} \\mathbf{y}_{2}.\n$$\nIn a strictly barycentric frame for the sub-system, $\\mathbf{C} = \\mathbf{0}$, and the choice of $\\mathbf{y}_{2}$ relative to $\\mathbf{C}_{12}$ retains translational invariance while providing hierarchical mass-weighting.\n\nWe now compute the required quantities for the given data.\n\nGiven masses:\n$$\nm_{1} = 1.5 \\times 10^{-3}, \\quad m_{2} = 4.0 \\times 10^{-4}, \\quad m_{3} = 1.0 \\times 10^{-3},\n$$\nand barycentric positions (in astronomical units):\n$$\n\\mathbf{X}_{1} = (0.50,\\, 0.10,\\, 0.00), \\quad\n\\mathbf{X}_{2} = (-0.20,\\, 0.40,\\, 0.00), \\quad\n\\mathbf{X}_{3} = (-0.67,\\, -0.31,\\, 0.00).\n$$\nFirst, verify the barycentric constraint:\n$$\nm_{1} \\mathbf{X}_{1} = (0.0015 \\cdot 0.50,\\, 0.0015 \\cdot 0.10,\\, 0) = (0.00075,\\, 0.00015,\\, 0),\n$$\n$$\nm_{2} \\mathbf{X}_{2} = (0.0004 \\cdot (-0.20),\\, 0.0004 \\cdot 0.40,\\, 0) = (-0.00008,\\, 0.00016,\\, 0),\n$$\n$$\nm_{3} \\mathbf{X}_{3} = (0.001 \\cdot (-0.67),\\, 0.001 \\cdot (-0.31),\\, 0) = (-0.00067,\\, -0.00031,\\, 0).\n$$\nSumming,\n$$\nm_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2} + m_{3} \\mathbf{X}_{3} = (0.00075 - 0.00008 - 0.00067,\\, 0.00015 + 0.00016 - 0.00031,\\, 0) = (0,\\, 0,\\, 0),\n$$\nso the COM is at the origin.\n\nCompute the partial COM of bodies $1$ and $2$:\n$$\nM_{12} = m_{1} + m_{2} = 1.5 \\times 10^{-3} + 4.0 \\times 10^{-4} = 1.9 \\times 10^{-3},\n$$\n$$\n\\mathbf{C}_{12} = \\frac{m_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2}}{M_{12}} \n= \\frac{(0.00075 - 0.00008,\\, 0.00015 + 0.00016,\\, 0)}{0.0019}\n= \\frac{(0.00067,\\, 0.00031,\\, 0)}{0.0019}.\n$$\nNumerically,\n$$\n\\mathbf{C}_{12} \\approx (0.3526315789,\\, 0.1631578947,\\, 0).\n$$\nCompute the Jacobi vectors:\n$$\n\\mathbf{y}_{1} = \\mathbf{X}_{2} - \\mathbf{X}_{1} = (-0.20 - 0.50,\\, 0.40 - 0.10,\\, 0.00 - 0.00) = (-0.70,\\, 0.30,\\, 0.00),\n$$\n$$\n\\mathbf{y}_{2} = \\mathbf{X}_{3} - \\mathbf{C}_{12} = (-0.67 - 0.3526315789,\\, -0.31 - 0.1631578947,\\, 0.00 - 0.00).\n$$\nThus,\n$$\n\\mathbf{y}_{2} \\approx (-1.0226315789,\\, -0.4731578947,\\, 0.00).\n$$\nRound each entry to four significant figures (in astronomical units):\n$$\n\\mathbf{y}_{1} \\to (-0.7000,\\, 0.3000,\\, 0.0000), \\quad\n\\mathbf{y}_{2} \\to (-1.023,\\, -0.4732,\\, 0.0000).\n$$\nVerification of the hierarchical mass-weighted definitions proceeds by reconstructing $\\mathbf{X}_{i}$ from $\\mathbf{y}_{1}$, $\\mathbf{y}_{2}$, and $\\mathbf{C}_{12}$. Using\n$$\n\\mathbf{X}_{1} = \\mathbf{C}_{12} - \\frac{m_{2}}{M_{12}} \\mathbf{y}_{1}, \\quad \\mathbf{X}_{2} = \\mathbf{C}_{12} + \\frac{m_{1}}{M_{12}} \\mathbf{y}_{1}, \\quad \\mathbf{X}_{3} = \\mathbf{y}_{2} + \\mathbf{C}_{12},\n$$\nwith $m_{2}/M_{12} = \\frac{4.0 \\times 10^{-4}}{1.9 \\times 10^{-3}} \\approx 0.2105263158$ and $m_{1}/M_{12} \\approx 0.7894736842$, we obtain\n$$\n\\mathbf{X}_{1} \\approx (0.3526315789,\\, 0.1631578947,\\, 0) - 0.2105263158 \\cdot (-0.70,\\, 0.30,\\, 0)\n\\approx (0.3526315789 + 0.1473684211,\\, 0.1631578947 - 0.0631578947,\\, 0)\n= (0.50,\\, 0.10,\\, 0),\n$$\n$$\n\\mathbf{X}_{2} \\approx (0.3526315789,\\, 0.1631578947,\\, 0) + 0.7894736842 \\cdot (-0.70,\\, 0.30,\\, 0)\n\\approx (0.3526315789 - 0.5526315789,\\, 0.1631578947 + 0.2368421053,\\, 0)\n= (-0.20,\\, 0.40,\\, 0),\n$$\n$$\n\\mathbf{X}_{3} \\approx (-1.0226315789,\\, -0.4731578947,\\, 0) + (0.3526315789,\\, 0.1631578947,\\, 0)\n= (-0.67,\\, -0.31,\\, 0).\n$$\nTherefore the hierarchical mass-weighted definitions are satisfied and the inverse mapping recovers the original barycentric positions.\n\nAs requested, the final answer is the single row matrix of the two Jacobi vectors’ components, rounded to four significant figures, in astronomical units (AU):\n$$\n(y_{1x},\\, y_{1y},\\, y_{1z},\\, y_{2x},\\, y_{2y},\\, y_{2z}) = (-0.7000,\\, 0.3000,\\, 0.0000,\\, -1.023,\\, -0.4732,\\, 0.0000).\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}-0.7000 & 0.3000 & 0.0000 & -1.023 & -0.4732 & 0.0000\\end{pmatrix}}$$"
        },
        {
            "introduction": "While Jacobi coordinates help structure the problem, the core of planetary dynamics lies in analyzing the gravitational interactions themselves. In many systems, the most significant effects arise from long-term, gentle perturbations between planets in or near a mean-motion resonance. This practice  connects the theoretical concept of a resonant angle to a key astronomical observable, the Transit Timing Variation (TTV), guiding you to derive the relationship between the TTV super-period and the system's proximity to resonance.",
            "id": "4168048",
            "problem": "Consider two coplanar, nearly Keplerian planets orbiting a star, with inner-planet orbital period $P_{1}$ and outer-planet orbital period $P_{2}$. Assume the system lies near a first-order mean-motion commensurability $p\\!:\\!p\\!-\\!1$ with integer $p \\ge 2$, and that the transit timing variation (TTV) signal of the inner planet is dominated by the near-resonant forcing. Define the mean motions by $n_{i} \\equiv 2\\pi/P_{i}$ and the resonant combination of mean longitudes by $\\theta \\equiv p\\,\\lambda_{2} - (p-1)\\,\\lambda_{1}$, where $\\lambda_{i}$ are mean longitudes. Define the detuning parameter by\n$$\n\\Delta \\equiv \\frac{p\\,P_{2}}{(p-1)\\,P_{1}} - 1.\n$$\nStarting from fundamental kinematics of conjunctions and resonance angles under Newtonian gravity, derive the expression for the TTV super-period $P_{\\mathrm{TTV}}$ (the dominant TTV period) as the timescale on which $\\theta$ advances by $2\\pi$, first in terms of $P_{1}$ and $P_{2}$, and then reduce it to a closed-form expression depending only on $P_{1}$, $p$, and $\\Delta$.\n\nFinally, evaluate $P_{\\mathrm{TTV}}$ numerically for the case $p=3$, $P_{1} = 10.000\\,\\mathrm{d}$, and $P_{2} = 15.200\\,\\mathrm{d}$. Express your final numerical answer in days and round to four significant figures.",
            "solution": "The TTV super-period, $P_{\\mathrm{TTV}}$, is defined as the time required for the resonant angle, $\\theta$, to advance by $2\\pi$. This period is determined by the rate of change of $\\theta$, denoted as $\\dot{\\theta}$. The angular frequency of the resonant angle, $\\omega_{\\theta}$, is given by $\\dot{\\theta}$. Therefore, the TTV super-period is $P_{\\mathrm{TTV}} = 2\\pi/|\\dot{\\theta}|$.\n\nThe resonant angle is given by $\\theta = p\\,\\lambda_{2} - (p-1)\\,\\lambda_{1}$. The mean longitudes, $\\lambda_{i}$, evolve linearly with time on average: $\\lambda_{i}(t) = \\lambda_{i,0} + n_{i}t$, where $n_{i}$ is the mean motion and $\\lambda_{i,0}$ is the mean longitude at time $t=0$. The rate of change of $\\theta$ is found by differentiating with respect to time:\n$$\n\\dot{\\theta} = \\frac{d}{dt} \\left( p\\,\\lambda_{2} - (p-1)\\,\\lambda_{1} \\right) = p\\,\\dot{\\lambda}_{2} - (p-1)\\,\\dot{\\lambda}_{1} = p\\,n_{2} - (p-1)\\,n_{1}\n$$\nThe mean motion $n_{i}$ is related to the orbital period $P_{i}$ by the definition $n_{i} \\equiv 2\\pi/P_{i}$. Substituting this into the expression for $\\dot{\\theta}$ yields:\n$$\n\\dot{\\theta} = p \\left( \\frac{2\\pi}{P_{2}} \\right) - (p-1) \\left( \\frac{2\\pi}{P_{1}} \\right) = 2\\pi \\left( \\frac{p}{P_{2}} - \\frac{p-1}{P_{1}} \\right)\n$$\nThe TTV super-period is thus:\n$$\nP_{\\mathrm{TTV}} = \\frac{2\\pi}{|\\dot{\\theta}|} = \\frac{2\\pi}{\\left| 2\\pi \\left( \\frac{p}{P_{2}} - \\frac{p-1}{P_{1}} \\right) \\right|} = \\frac{1}{\\left| \\frac{p}{P_{2}} - \\frac{p-1}{P_{1}} \\right|}\n$$\nTo obtain the first required expression, we combine the terms in the denominator:\n$$\nP_{\\mathrm{TTV}} = \\frac{1}{\\left| \\frac{p P_{1} - (p-1) P_{2}}{P_{1} P_{2}} \\right|} = \\frac{P_{1} P_{2}}{|p P_{1} - (p-1) P_{2}|}\n$$\nThis is the expression for the TTV super-period in terms of $P_{1}$ and $P_{2}$. For a system near a $p:p-1$ resonance, the period ratio $P_{2}/P_{1}$ is close to $p/(p-1)$, which makes the denominator $p P_1 - (p-1) P_2$ close to zero, resulting in a long super-period, as expected.\n\nNext, we derive the expression for $P_{\\mathrm{TTV}}$ in terms of $P_{1}$, $p$, and the detuning parameter $\\Delta$. The problem defines $\\Delta$ as:\n$$\n\\Delta = \\frac{p\\,P_{2}}{(p-1)\\,P_{1}} - 1\n$$\nFrom this definition, we can express $P_{2}$ in terms of the other parameters.\n$$\n\\Delta + 1 = \\frac{p\\,P_{2}}{(p-1)\\,P_{1}} \\implies P_{2} = P_{1} \\frac{(p-1)(\\Delta+1)}{p}\n$$\nNow, we substitute this expression for $P_{2}$ into our first result for $P_{\\mathrm{TTV}}$. Let's first simplify the term in the absolute value, $|p P_{1} - (p-1) P_{2}|$:\n$$\np P_{1} - (p-1) P_{2} = p P_{1} - (p-1) \\left( P_{1} \\frac{(p-1)(\\Delta+1)}{p} \\right)\n$$\nFactoring out $P_{1}$:\n$$\n= P_{1} \\left( p - \\frac{(p-1)^2 (\\Delta+1)}{p} \\right) = \\frac{P_{1}}{p} \\left( p^2 - (p-1)^2 (\\Delta+1) \\right)\n$$\nExpanding $(p-1)^2 = p^2 - 2p + 1$:\n$$\n= \\frac{P_{1}}{p} \\left( p^2 - (p^2 - 2p + 1)(\\Delta+1) \\right)\n$$\n$$\n= \\frac{P_{1}}{p} \\left( p^2 - [(p^2 - 2p + 1)\\Delta + (p^2 - 2p + 1)] \\right)\n$$\n$$\n= \\frac{P_{1}}{p} \\left( p^2 - (p-1)^2\\Delta - p^2 + 2p - 1 \\right) = \\frac{P_{1}}{p} \\left( 2p - 1 - (p-1)^2\\Delta \\right)\n$$\nNow, we substitute this and the expression for $P_{2}$ into the formula for $P_{\\mathrm{TTV}}$:\n$$\nP_{\\mathrm{TTV}} = \\frac{P_{1} P_{2}}{|p P_{1} - (p-1) P_{2}|} = \\frac{P_{1} \\left( P_{1} \\frac{(p-1)(\\Delta+1)}{p} \\right)}{\\left| \\frac{P_{1}}{p} \\left( 2p - 1 - (p-1)^2\\Delta \\right) \\right|}\n$$\n$$\nP_{\\mathrm{TTV}} = \\frac{\\frac{P_1^2 (p-1)(\\Delta+1)}{p}}{\\frac{P_1}{p} |2p - 1 - (p-1)^2\\Delta|}\n$$\nSimplifying the expression by canceling $P_{1}/p$:\n$$\nP_{\\mathrm{TTV}} = \\frac{P_{1} (p-1) (\\Delta+1)}{|2p - 1 - (p-1)^2\\Delta|}\n$$\nSince the problem states the system is \"near\" resonance, $\\Delta$ will be such that $\\Delta+1 = \\frac{p P_2}{(p-1)P_1} > 0$. Therefore, we do not need an absolute value around $(\\Delta+1)$. This is the desired closed-form expression.\n\nFinally, we evaluate $P_{\\mathrm{TTV}}$ numerically for the case $p=3$, $P_{1} = 10.000\\,\\mathrm{d}$, and $P_{2} = 15.200\\,\\mathrm{d}$. It is most direct to use the first derived formula:\n$$\nP_{\\mathrm{TTV}} = \\frac{P_{1} P_{2}}{|p P_{1} - (p-1) P_{2}|}\n$$\nSubstituting the given values:\n$$\np-1 = 3-1=2\n$$\n$$\nP_{\\mathrm{TTV}} = \\frac{(10.000)(15.200)}{|3(10.000) - 2(15.200)|} = \\frac{152.00}{|30.000 - 30.400|} = \\frac{152.00}{|-0.400|} = \\frac{152.00}{0.400}\n$$\n$$\nP_{\\mathrm{TTV}} = 380.0\\,\\mathrm{d}\n$$\nTo verify, we can also use the second formula. First, we compute $\\Delta$:\n$$\n\\Delta = \\frac{3(15.200)}{2(10.000)} - 1 = \\frac{45.600}{20.000} - 1 = 2.280 - 1 = 1.280\n$$\nNow, we use the second expression for $P_{\\mathrm{TTV}}$:\n$$\nP_{\\mathrm{TTV}} = \\frac{P_{1} (p-1) (\\Delta+1)}{|2p - 1 - (p-1)^2\\Delta|} = \\frac{10.000 (2) (1.280+1)}{|2(3) - 1 - (3-1)^2(1.280)|} = \\frac{20.000 (2.280)}{|5 - 4(1.280)|}\n$$\n$$\nP_{\\mathrm{TTV}} = \\frac{45.60}{|5 - 5.120|} = \\frac{45.60}{|-0.120|} = \\frac{45.60}{0.120} = 380.0\\,\\mathrm{d}\n$$\nBoth methods yield the same result. The problem asks for the final numerical answer to be rounded to four significant figures. The result is exactly $380.0$, which has four significant figures. To express this unambiguously in scientific notation, it is $3.800 \\times 10^2$.",
            "answer": "$$\n\\boxed{3.800 \\times 10^{2}}\n$$"
        },
        {
            "introduction": "In contrast to the long-term, perturbative effects of resonances, planetary system evolution can also be punctuated by dramatic, short-timescale close encounters. The physics of these events is governed by two-body hyperbolic scattering, where the outcome can range from a slight deflection to a physical collision. This coding exercise  challenges you to translate the theory of gravitational encounters into a practical algorithm, computing the minimum approach distance and assessing collision criteria, which is a critical skill for developing or interpreting modern N-body simulations.",
            "id": "4168034",
            "problem": "A two-body gravitational encounter in planetary science can be meaningfully analyzed in the relative frame of the reduced mass under Newtonian gravity. Consider two planets treated as uniform spheres with physical radii and no dissipative forces. The interaction is modeled as a Keplerian hyperbolic trajectory characterized by the relative speed at infinity and an impact parameter. The objective is to compute the minimum approach distance between the planetary centers during the encounter and to assess whether a physical collision occurs, or whether the outcome is a non-collisional gravitational scattering, evaluated using the escape velocity at the contact radius and the spheres’ radii.\n\nYou must implement a complete program that, for a specified set of test cases, returns for each case the minimum approach distance and two logical assessments: whether a collision occurs according to the exact pericenter calculation, and whether a collision would be predicted by the gravitational focusing threshold derived from escape velocity and the physical radii.\n\nAll quantities must be treated in the International System of Units (SI). Distances must be expressed in meters, velocities in meters per second, masses in kilograms, and the gravitational constant in SI units. Angles are not required. The final numerical outputs for distances must be in meters. Booleans must be provided as the programming language native true or false values.\n\nFundamental base assumptions and definitions:\n- Newton’s law of universal gravitation applies: the gravitational parameter is $G$, with $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$.\n- The two-body reduction is used, with total mass $M = m_1 + m_2$, reduced mass $\\mu_{\\mathrm{red}} = \\frac{m_1 m_2}{m_1 + m_2}$, and gravitational parameter $\\mu = G M$.\n- The incoming relative speed at infinity is $v_{\\infty} > 0$, and the impact parameter is $b \\ge 0$. The specific orbital energy (per unit reduced mass) is $E = \\frac{v_{\\infty}^{2}}{2}$ and the specific angular momentum (per unit reduced mass) is $h = b\\,v_{\\infty}$.\n- The relative orbit is hyperbolic with eccentricity $e = \\sqrt{1 + \\frac{2 E h^{2}}{\\mu^{2}}}$.\n- The minimum approach distance (the pericenter of the hyperbolic orbit) is given by $r_{\\min} = \\frac{h^{2}}{\\mu\\,(1 + e)}$.\n- The physical contact threshold is $R_{\\mathrm{tot}} = R_1 + R_2$, where $R_1$ and $R_2$ are the physical radii of the two planets. A collision occurs if and only if $r_{\\min} \\le R_{\\mathrm{tot}}$.\n- The escape velocity defined at the contact distance is $v_{\\mathrm{esc}}(R_{\\mathrm{tot}}) = \\sqrt{\\frac{2 \\mu}{R_{\\mathrm{tot}}}}$. Gravitational focusing yields a critical impact parameter\n$$\nb_{\\mathrm{crit}} = R_{\\mathrm{tot}}\\,\\sqrt{1 + \\frac{v_{\\mathrm{esc}}^{2}(R_{\\mathrm{tot}})}{v_{\\infty}^{2}}} = R_{\\mathrm{tot}}\\,\\sqrt{1 + \\frac{2\\mu}{R_{\\mathrm{tot}}\\,v_{\\infty}^{2}}}.\n$$\nA collision is predicted by the focusing threshold if and only if $b \\le b_{\\mathrm{crit}}$.\n\nProgram requirements:\n- For each test case, compute $r_{\\min}$ in meters, the collision boolean $C_{\\mathrm{peri}}$ defined as $C_{\\mathrm{peri}} := (r_{\\min} \\le R_{\\mathrm{tot}})$, and the gravitational focusing boolean $C_{\\mathrm{foc}}$ defined as $C_{\\mathrm{foc}} := (b \\le b_{\\mathrm{crit}})$.\n- Use the formulas exactly as stated above, without shortcut formulas other than those explicitly defined in the fundamental base.\n\nTest suite:\nProvide computations for the following five test cases. Each case specifies $(m_1, R_1, m_2, R_2, v_{\\infty}, b)$:\n\n1. Happy path scattering case with terrestrial planets:\n   - $m_1 = 5.972 \\times 10^{24}\\ \\mathrm{kg}$, $R_1 = 6.371 \\times 10^{6}\\ \\mathrm{m}$.\n   - $m_2 = 6.417 \\times 10^{23}\\ \\mathrm{kg}$, $R_2 = 3.3895 \\times 10^{6}\\ \\mathrm{m}$.\n   - $v_{\\infty} = 5.0 \\times 10^{3}\\ \\mathrm{m/s}$.\n   - $b = 5.0 \\times 10^{7}\\ \\mathrm{m}$.\n\n2. Boundary case at the gravitational focusing threshold for a Jupiter–Earth encounter:\n   - $m_1 = 1.898 \\times 10^{27}\\ \\mathrm{kg}$, $R_1 = 6.9911 \\times 10^{7}\\ \\mathrm{m}$.\n   - $m_2 = 5.972 \\times 10^{24}\\ \\mathrm{kg}$, $R_2 = 6.371 \\times 10^{6}\\ \\mathrm{m}$.\n   - $v_{\\infty} = 2.0 \\times 10^{4}\\ \\mathrm{m/s}$.\n   - $b$ is defined to be equal to $b_{\\mathrm{crit}}$ computed from the above formula for these parameters.\n\n3. Head-on encounter of two super-Earths:\n   - $m_1 = 8.0 \\times 10^{24}\\ \\mathrm{kg}$, $R_1 = 8.0 \\times 10^{6}\\ \\mathrm{m}$.\n   - $m_2 = 6.0 \\times 10^{24}\\ \\mathrm{kg}$, $R_2 = 7.0 \\times 10^{6}\\ \\mathrm{m}$.\n   - $v_{\\infty} = 1.0 \\times 10^{3}\\ \\mathrm{m/s}$.\n   - $b = 0$.\n\n4. High-speed near-miss between ice giants:\n   - $m_1 = 1.02413 \\times 10^{26}\\ \\mathrm{kg}$, $R_1 = 2.4622 \\times 10^{7}\\ \\mathrm{m}$.\n   - $m_2 = 8.6810 \\times 10^{25}\\ \\mathrm{kg}$, $R_2 = 2.5362 \\times 10^{7}\\ \\mathrm{m}$.\n   - $v_{\\infty} = 1.0 \\times 10^{5}\\ \\mathrm{m/s}$.\n   - $b = 1.0 \\times 10^{8}\\ \\mathrm{m}$.\n\n5. Edge case slightly above the focusing threshold for the terrestrial case in 1:\n   - $m_1 = 5.972 \\times 10^{24}\\ \\mathrm{kg}$, $R_1 = 6.371 \\times 10^{6}\\ \\mathrm{m}$.\n   - $m_2 = 6.417 \\times 10^{23}\\ \\mathrm{kg}$, $R_2 = 3.3895 \\times 10^{6}\\ \\mathrm{m}$.\n   - $v_{\\infty} = 5.0 \\times 10^{3}\\ \\mathrm{m/s}$.\n   - $b$ is defined as $b = b_{\\mathrm{crit}} \\times (1 + 10^{-8})$ computed for these parameters, so that the pericenter is just above the contact threshold.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case result and is itself a list of the form $[r_{\\min}, C_{\\mathrm{peri}}, C_{\\mathrm{foc}}]$. For example, the output must have the format\n$[[r_{\\min,1}, C_{\\mathrm{peri},1}, C_{\\mathrm{foc},1}], [r_{\\min,2}, C_{\\mathrm{peri},2}, C_{\\mathrm{foc},2}], \\dots]$\nwith $r_{\\min,i}$ in meters and booleans given in the language’s native format. No additional text may be printed.",
            "solution": "The solution proceeds by implementing the specified formulas for each test case. The gravitational constant is $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$.\n\nFor each test case, specified by the masses $m_1$ and $m_2$, physical radii $R_1$ and $R_2$, relative velocity at infinity $v_{\\infty}$, and impact parameter $b$, we perform the following calculations:\n\n1.  **System Parameters**: First, we compute the parameters of the two-body system.\n    -   Total mass: $M = m_1 + m_2$.\n    -   Gravitational parameter for the system: $\\mu = G M$. This parameter governs the strength of the gravitational interaction.\n    -   Total physical radius for contact: $R_{\\mathrm{tot}} = R_1 + R_2$. A collision occurs if the centers of the two bodies approach a distance less than or equal to this value.\n\n2.  **Orbital Parameters**: Next, we characterize the hyperbolic trajectory of the relative motion.\n    -   Specific orbital energy (per unit reduced mass): $E = \\frac{v_{\\infty}^{2}}{2}$. Since $v_{\\infty} > 0$, the energy is positive, which corresponds to an unbound, hyperbolic orbit.\n    -   Specific angular momentum (per unit reduced mass): $h = b\\,v_{\\infty}$. This is a conserved quantity, reflecting the rotational aspect of the motion.\n    -   Eccentricity: $e = \\sqrt{1 + \\frac{2 E h^{2}}{\\mu^{2}}}$. Substituting the expressions for $E$ and $h$, this becomes $e = \\sqrt{1 + \\frac{v_{\\infty}^{2} (b v_{\\infty})^2}{\\mu^{2}}} = \\sqrt{1 + \\frac{b^2 v_{\\infty}^4}{\\mu^2}}$. The eccentricity quantifies the shape of the orbit; for a hyperbola, $e > 1$. A special case occurs if $b=0$, yielding $h=0$ and $e=1$, which represents a degenerate hyperbola (a straight-line trajectory).\n\n3.  **Pericenter Calculation ($r_{\\min}$ and $C_{\\mathrm{peri}}$)**: We determine the minimum separation distance based on the orbit's geometry.\n    -   Minimum approach distance (pericenter): $r_{\\min} = \\frac{h^{2}}{\\mu\\,(1 + e)}$. This formula gives the distance of closest approach between the two bodies' centers of mass. In the special case where $b=0$, we have $h=0$ and $e=1$, which gives $r_{\\min} = 0$.\n    -   Pericenter-based collision condition: A collision occurs if the minimum separation is less than or equal to the sum of the radii. This is represented by the boolean $C_{\\mathrm{peri}} := (r_{\\min} \\le R_{\\mathrm{tot}})$.\n\n4.  **Gravitational Focusing Calculation ($b_{\\mathrm{crit}}$ and $C_{\\mathrm{foc}}$)**: We determine whether a collision occurs based on an alternative, but equivalent, criterion derived from energy and momentum conservation. This concept is known as gravitational focusing, where gravity \"focuses\" incoming particle paths, increasing the effective collision cross-section.\n    -   Critical impact parameter: A collision occurs if the impact parameter $b$ is less than or equal to a critical value, $b_{\\mathrm{crit}}$. This critical parameter is derived by setting the pericenter distance $r_{\\min}$ equal to the contact radius $R_{\\mathrm{tot}}$ and solving for $b$. The formula is given as $b_{\\mathrm{crit}} = R_{\\mathrm{tot}}\\,\\sqrt{1 + \\frac{2\\mu}{R_{\\mathrm{tot}}\\,v_{\\infty}^{2}}}$.\n    -   Focusing-based collision condition: The collision is predicted if the actual impact parameter is within this critical range. This is represented by the boolean $C_{\\mathrm{foc}} := (b \\le b_{\\mathrm{crit}})$.\n\nThe mathematical equivalence of the conditions $r_{\\min} \\le R_{\\mathrm{tot}}$ and $b \\le b_{\\mathrm{crit}}$ is a fundamental result of orbital mechanics. A correct implementation must yield $C_{\\mathrm{peri}} = C_{\\mathrm{foc}}$ for all test cases, accounting for potential floating-point inaccuracies at the boundary. The provided test cases are designed to verify this, including a case exactly at the boundary ($b = b_{\\mathrm{crit}}$) and one just outside ($b = b_{\\mathrm{crit}} \\times (1 + 10^{-8})$).\n\nThe algorithm for the program will be to iterate through the five test cases. For each case:\n- Parse the input parameters $(m_1, R_1, m_2, R_2, v_{\\infty}, b)$.\n- Note that for test cases $2$ and $5$, the value of $b$ is not given directly but is defined relative to $b_{\\mathrm{crit}}$. Therefore, for these cases, an initial calculation of $b_{\\mathrm{crit}}$ is required to determine the value of $b$ to be used in subsequent steps.\n- Apply the sequence of formulas described above to calculate $r_{\\min}$, $C_{\\mathrm{peri}}$, and $C_{\\mathrm{foc}}$.\n- Store the resulting triplet $[r_{\\min}, C_{\\mathrm{peri}}, C_{\\mathrm{foc}}]$.\n- After processing all cases, format the collected results into the specified string format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the minimum approach distance and collision booleans for a series\n    of two-body gravitational encounters.\n    \"\"\"\n    # Gravitational constant in SI units (m^3 kg^-1 s^-2)\n    G = 6.67430e-11\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (m1, R1, m2, R2, v_inf, b_spec)\n    # where b_spec is either a numeric value or a descriptive string.\n    test_cases = [\n        # 1. Happy path scattering case with terrestrial planets\n        (5.972e24, 6.371e6, 6.417e23, 3.3895e6, 5.0e3, 5.0e7),\n\n        # 2. Boundary case at the gravitational focusing threshold for a Jupiter–Earth encounter\n        (1.898e27, 6.9911e7, 5.972e24, 6.371e6, 2.0e4, \"b_crit\"),\n\n        # 3. Head-on encounter of two super-Earths\n        (8.0e24, 8.0e6, 6.0e24, 7.0e6, 1.0e3, 0.0),\n\n        # 4. High-speed near-miss between ice giants\n        (1.02413e26, 2.4622e7, 8.6810e25, 2.5362e7, 1.0e5, 1.0e8),\n\n        # 5. Edge case slightly above the focusing threshold for the terrestrial case in 1\n        (5.972e24, 6.371e6, 6.417e23, 3.3895e6, 5.0e3, \"b_crit_plus_eps\")\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        m1, R1, m2, R2, v_inf, b_spec = case\n\n        # Step 1: System Parameters\n        M = m1 + m2\n        mu = G * M\n        R_tot = R1 + R2\n\n        # Determine the impact parameter b based on the test case specification\n        if isinstance(b_spec, str):\n            # Calculate b_crit for cases 2 and 5\n            b_crit_sq = R_tot**2 * (1 + (2 * mu) / (R_tot * v_inf**2))\n            b_crit = np.sqrt(b_crit_sq)\n            if b_spec == \"b_crit\":\n                b = b_crit\n            elif b_spec == \"b_crit_plus_eps\":\n                b = b_crit * (1 + 1e-8)\n        else:\n            b = b_spec\n            # Calculate b_crit for the C_foc check\n            b_crit_sq = R_tot**2 * (1 + (2 * mu) / (R_tot * v_inf**2))\n            b_crit = np.sqrt(b_crit_sq)\n\n        # Step 2: Orbital Parameters\n        E = (v_inf**2) / 2\n        h = b * v_inf\n\n        # Step 3: Pericenter Calculation\n        if b == 0:  # Head-on collision case\n            r_min = 0.0\n        else:\n            # Eccentricity\n            e_sq = 1 + (2 * E * h**2) / (mu**2)\n            e = np.sqrt(e_sq)\n            \n            # Minimum approach distance (pericenter)\n            r_min = (h**2) / (mu * (1 + e))\n\n        # Pericenter-based collision boolean\n        C_peri = bool(r_min = R_tot)\n\n        # Step 4: Gravitational Focusing Calculation\n        # b_crit is already calculated for all cases now.\n        C_foc = bool(b = b_crit)\n        \n        # Append the results for this case\n        results.append([r_min, C_peri, C_foc])\n\n    # Final print statement in the exact required format.\n    # Convert bools to lowercase 'true'/'false' to match example if needed,\n    # but Python's default str(True) is 'True', which is a language-native format.\n    # The output format requests native boolean format.\n    # repr() is a robust way to format lists containing various types.\n    print(f\"[{','.join(map(repr, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}