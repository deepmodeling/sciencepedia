{
    "hands_on_practices": [
        {
            "introduction": "共振链的基础是单个的共振环节。这个练习将引导你使用一个简化的哈密顿量模型，来探索平动（稳定平衡）和循环这两个核心概念。通过分析不动点及其稳定性，你将亲手实践并理解一对行星“锁入”共振的动力学本质。",
            "id": "4176535",
            "problem": "考虑两个共面行星，它们处于一阶平均运动共振附近，例如整数 $k \\geq 2$ 的 $k:(k-1)$ 可公度性。在对快角进行平均并对单个共振角-作用量对应用正则共振变换后，这样一个共振链中一个环节的共振动力学可以用一个单自由度哈密顿量来建模，其形式为\n$$\nH(\\phi,p)\\;=\\;\\frac{1}{2}\\,a\\,p^{2}\\;+\\;\\delta\\,p\\;-\\;\\varepsilon\\,\\cos\\phi,\n$$\n其中 $a>0$ 和 $\\varepsilon>0$ 是分别由开普勒部分的局部曲率和摄动函数一阶项的振幅决定的常数，而 $\\delta$ 是一个小的失谐参数，用于衡量与精确可公度性的偏移。正则坐标 $\\phi$ 是共振角，而 $p$ 是其共轭动量，与平均运动偏离精确共振的偏差成正比。假设这是一个平面问题，并忽略任何额外的慢进动项。\n\n仅使用哈密顿方程和对平衡点附近的运动方程进行线性化，完成以下任务：\n- 识别系统在 $(\\phi,p)$ 平面上的所有平衡点 $(\\phi^{\\star},p^{\\star})$。\n- 通过计算在每个平衡点处求值的线性化运动方程的雅可比矩阵的特征值，来确定每个平衡点的线性稳定性。\n\n最后，报告一个单一的量：线性稳定平衡点处特征值的绝对值（即线性天平动频率的大小），表示为 $a$ 和 $\\varepsilon$ 的闭式符号函数。仅以符号表达式形式提供最终答案；不要包含单位或数值，也不要进行近似。角度以弧度为单位。",
            "solution": "问题陈述被认为是有效的，因为它在哈密顿力学和天体力学方面具有科学依据，是适定的、客观的，并包含推导出唯一解所需的所有必要信息。\n\n系统的动力学由哈密顿量控制\n$$\nH(\\phi,p) = \\frac{1}{2} a p^{2} + \\delta p - \\varepsilon \\cos\\phi\n$$\n其中 $(\\phi, p)$ 是正则共轭变量，$a$、$\\delta$、$\\varepsilon$ 是参数，且 $a > 0$ 和 $\\varepsilon > 0$。运动方程由哈密顿方程给出：\n$$\n\\dot{\\phi} = \\frac{\\partial H}{\\partial p}\n$$\n$$\n\\dot{p} = -\\frac{\\partial H}{\\partial \\phi}\n$$\n首先，我们计算哈密顿量的偏导数：\n$$\n\\frac{\\partial H}{\\partial p} = a p + \\delta\n$$\n$$\n\\frac{\\partial H}{\\partial \\phi} = \\frac{\\partial}{\\partial \\phi} (-\\varepsilon \\cos\\phi) = -\\varepsilon (-\\sin\\phi) = \\varepsilon \\sin\\phi\n$$\n将这些代入哈密顿方程，得到系统的运动方程：\n$$\n\\dot{\\phi} = a p + \\delta\n$$\n$$\n\\dot{p} = -\\varepsilon \\sin\\phi\n$$\n平衡点，记为 $(\\phi^{\\star}, p^{\\star})$，是相空间中系统处于静止状态的点。通过将时间导数设为零来找到它们：$\\dot{\\phi} = 0$ 和 $\\dot{p} = 0$。\n$$\nap^{\\star} + \\delta = 0 \\quad \\implies \\quad p^{\\star} = -\\frac{\\delta}{a}\n$$\n$$\n-\\varepsilon \\sin\\phi^{\\star} = 0\n$$\n由于 $\\varepsilon > 0$，第二个方程要求 $\\sin\\phi^{\\star} = 0$。在区间 $\\phi \\in [0, 2\\pi)$ 内，当 $\\phi^{\\star} = 0$ 和 $\\phi^{\\star} = \\pi$ 时，此条件成立。\n因此，我们有两个不同的平衡点：\n$1$. $E_1: (\\phi^{\\star}, p^{\\star}) = (0, -\\frac{\\delta}{a})$\n$2$. $E_2: (\\phi^{\\star}, p^{\\star}) = (\\pi, -\\frac{\\delta}{a})$\n\n为了确定这些平衡点的线性稳定性，我们围绕每个点对运动方程进行线性化。该系统可以写成向量形式 $\\dot{\\mathbf{x}} = \\mathbf{F}(\\mathbf{x})$，其中 $\\mathbf{x} = (\\phi, p)^T$ 且 $\\mathbf{F}(\\mathbf{x}) = (ap + \\delta, -\\varepsilon \\sin\\phi)^T$。稳定性由在平衡点处求值的 $\\mathbf{F}$ 的雅可比矩阵的特征值决定。雅可比矩阵 $J$ 是：\n$$\nJ(\\phi, p) = \\begin{pmatrix} \\frac{\\partial \\dot{\\phi}}{\\partial \\phi}  \\frac{\\partial \\dot{\\phi}}{\\partial p} \\\\ \\frac{\\partial \\dot{p}}{\\partial \\phi}  \\frac{\\partial \\dot{p}}{\\partial p} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial}{\\partial \\phi}(ap+\\delta)  \\frac{\\partial}{\\partial p}(ap+\\delta) \\\\ \\frac{\\partial}{\\partial \\phi}(-\\varepsilon \\sin\\phi)  \\frac{\\partial}{\\partial p}(-\\varepsilon \\sin\\phi) \\end{pmatrix} = \\begin{pmatrix} 0  a \\\\ -\\varepsilon \\cos\\phi  0 \\end{pmatrix}\n$$\n现在，我们在两个平衡点处分别计算这个雅可比矩阵。\n\n对于第一个平衡点 $E_1 = (0, -\\frac{\\delta}{a})$：\n我们将 $\\phi^{\\star} = 0$ 代入雅可比矩阵：\n$$\nJ(E_1) = \\begin{pmatrix} 0  a \\\\ -\\varepsilon \\cos(0)  0 \\end{pmatrix} = \\begin{pmatrix} 0  a \\\\ -\\varepsilon  0 \\end{pmatrix}\n$$\n特征值 $\\lambda$ 通过求解特征方程 $\\det(J(E_1) - \\lambda I) = 0$ 得到，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n$$\n\\det\\begin{pmatrix} -\\lambda  a \\\\ -\\varepsilon  -\\lambda \\end{pmatrix} = (-\\lambda)(-\\lambda) - (a)(-\\varepsilon) = \\lambda^2 + a\\varepsilon = 0\n$$\n这得到 $\\lambda^2 = -a\\varepsilon$。由于 $a > 0$ 且 $\\varepsilon > 0$，乘积 $a\\varepsilon$ 为正。特征值为：\n$$\n\\lambda = \\pm \\sqrt{-a\\varepsilon} = \\pm i\\sqrt{a\\varepsilon}\n$$\n由于特征值是纯虚数且成共轭复数对，平衡点 $E_1$ 在线性化系统中是一个中心点。因此，它是线性稳定的。该点附近的物理运动对应于天平动。\n\n对于第二个平衡点 $E_2 = (\\pi, -\\frac{\\delta}{a})$：\n我们将 $\\phi^{\\star} = \\pi$ 代入雅可比矩阵：\n$$\nJ(E_2) = \\begin{pmatrix} 0  a \\\\ -\\varepsilon \\cos(\\pi)  0 \\end{pmatrix} = \\begin{pmatrix} 0  a \\\\ -\\varepsilon(-1)  0 \\end{pmatrix} = \\begin{pmatrix} 0  a \\\\ \\varepsilon  0 \\end{pmatrix}\n$$\n特征方程为 $\\det(J(E_2) - \\lambda I) = 0$：\n$$\n\\det\\begin{pmatrix} -\\lambda  a \\\\ \\varepsilon  -\\lambda \\end{pmatrix} = (-\\lambda)(-\\lambda) - (a)(\\varepsilon) = \\lambda^2 - a\\varepsilon = 0\n$$\n这得到 $\\lambda^2 = a\\varepsilon$。特征值为：\n$$\n\\lambda = \\pm\\sqrt{a\\varepsilon}\n$$\n由于 $a\\varepsilon > 0$，特征值为实数，一个为正，一个为负。这表明平衡点 $E_2$ 是一个鞍点，因而是不稳定的。\n\n问题要求的是线性稳定平衡点处特征值的绝对值。稳定平衡点是 $E_1$。该点的特征值为 $\\lambda = \\pm i\\sqrt{a\\varepsilon}$。这些特征值的绝对值是：\n$$\n|\\lambda| = |\\pm i\\sqrt{a\\varepsilon}| = \\sqrt{a\\varepsilon}\n$$\n这个量表示围绕稳定平衡点的微小振动（天平动）的角频率。按要求，该表达式仅是 $a$ 和 $\\varepsilon$ 的函数。",
            "answer": "$$\n\\boxed{\\sqrt{a\\varepsilon}}\n$$"
        },
        {
            "introduction": "在理解了单个共振之后，下一步自然是将它们连接起来形成共振链。这个练习将展示，当相邻的共振对同时发生平动时，会如何对整个系统的轨道周期施加一个严格的数学约束。从第一性原理出发推导这个拉普拉斯型关系式，你将揭示这些多行星系统精巧的运动学结构。",
            "id": "4176568",
            "problem": "考虑一颗质量远大于其行星的恒星，使得行星的运动可以很好地用具有弱相互摄动的近开普勒轨道来描述。标记为 $1$、$2$ 和 $3$ 的三颗行星形成一个共振链，其中行星 $1$ 和行星 $2$ 被锁定在一个阶数为 $q \\geq 1$ 的 $(p+q):p$ 平均运动共振中，而行星 $2$ 和行星 $3$ 被锁定在一个阶数为 $q' \\geq 1$ 的 $(p'+q'):p'$ 平均运动共振中，其中 $p,p',q,q'$ 是正整数。设行星 $i$ 的平均黄经为 $\\lambda_i$，近心点经度为 $\\varpi_i$，平均运动为 $n_i = d\\lambda_i/dt$。角度以弧度为单位。\n\n在平均运动共振的标准摄动函数描述中，每个二体共振 $(p+q):p$ 都容许 $q+1$ 个不同的共振角，这些共振角耦合了平均黄经和近心点经度。对于行星对 $(1,2)$，其中一个这样的角度是 $\\phi_{12} = (p+q)\\lambda_2 - p\\lambda_1 - q\\varpi_2$；对于行星对 $(2,3)$，一个相应的角度是 $\\phi_{23} = (p'+q')\\lambda_3 - p'\\lambda_2 - q'\\varpi_2$。假设 $\\phi_{12}$ 和 $\\phi_{23}$ 都围绕常数值发生天平动，因此在长期意义上，它们的时间导数平均为零。\n\n仅从这些定义和近开普勒关系 $n_i = d\\lambda_i/dt$ 出发，通过对 $\\phi_{12}$ 和 $\\phi_{23}$ 取整数线性组合，构造一个与 $\\varpi_2$ 无关的单三体角。通过对该组合关于时间求导并利用天平动假设，推导出平均运动之间的一种拉普拉斯型三体关系，其形式为一个在领头阶上为零的整数线性组合。将分别乘以 $n_1$、$n_2$ 和 $n_3$ 的整数系数 $k_1$、$k_2$ 和 $k_3$，用 $p$、$q$、$p'$ 和 $q'$ 明确表示。\n\n你的最终答案必须是表示为单个行矩阵的有序三元组 $\\left(k_1, k_2, k_3\\right)$。不需要进行数值计算，且最终表达式中不应包含单位。",
            "solution": "该问题要求为一个处于共振链中的三行星系统推导一个拉普拉斯型三体关系。该关系应为行星平均运动的线性组合，$k_1 n_1 + k_2 n_2 + k_3 n_3 = 0$，任务是求出整数系数 $(k_1, k_2, k_3)$。\n\n出发点是为相邻行星对提供的两个共振角：\n1. 对于行星对 $(1,2)$，在一个 $(p+q):p$ 共振中，角度为 $\\phi_{12} = (p+q)\\lambda_2 - p\\lambda_1 - q\\varpi_2$。\n2. 对于行星对 $(2,3)$，在一个 $(p'+q'):p'$ 共振中，角度为 $\\phi_{23} = (p'+q')\\lambda_3 - p'\\lambda_2 - q'\\varpi_2$。\n\n这些定义的一个关键特征是，两个共振角都依赖于中间行星的近心点经度 $\\varpi_2$。第一步是构造一个新的、与 $\\varpi_2$ 无关的三体角 $\\Phi$。我们将 $\\Phi$ 构造成 $\\phi_{12}$ 和 $\\phi_{23}$ 的一个整数线性组合：\n$$ \\Phi = a\\phi_{12} + b\\phi_{23} $$\n其中 $a$ 和 $b$ 是整数。代入 $\\phi_{12}$ 和 $\\phi_{23}$ 的定义：\n$$ \\Phi = a \\left( (p+q)\\lambda_2 - p\\lambda_1 - q\\varpi_2 \\right) + b \\left( (p'+q')\\lambda_3 - p'\\lambda_2 - q'\\varpi_2 \\right) $$\n为了使 $\\Phi$ 与 $\\varpi_2$ 无关，$\\varpi_2$ 项的系数之和必须为零。让我们按角变量对各项进行分组：\n$$ \\Phi = (-ap)\\lambda_1 + (a(p+q) - bp')\\lambda_2 + (b(p'+q'))\\lambda_3 - (aq + bq')\\varpi_2 $$\n与 $\\varpi_2$ 无关的条件是：\n$$ aq + bq' = 0 $$\n$$ aq = -bq' $$\n由于 $p, q, p', q'$ 是正整数，$a$ 和 $b$ 的最简单的非平凡整数解是选择 $a = q'$ 和 $b = -q$。这个选择（或其负值，$a = -q'$ 和 $b = q$）给出了所需的组合。我们将采用 $a = q'$ 和 $b = -q$ 继续。\n\n由此产生的三体角是 $\\Phi = q'\\phi_{12} - q\\phi_{23}$。让我们用平均黄经明确地写出它：\n$$ \\Phi = q'\\left( (p+q)\\lambda_2 - p\\lambda_1 - q\\varpi_2 \\right) - q\\left( (p'+q')\\lambda_3 - p'\\lambda_2 - q'\\varpi_2 \\right) $$\n$$ \\Phi = pq'\\lambda_2 + qq'\\lambda_2 - pq'\\lambda_1 - qq'\\varpi_2 - qp'\\lambda_3 - qq'\\lambda_3 + qp'\\lambda_2 + qq'\\varpi_2 $$\n涉及 $\\varpi_2$ 的项按设计抵消了。按行星编号对剩余项进行分组：\n$$ \\Phi = (-pq')\\lambda_1 + (pq' + qq' + qp')\\lambda_2 + (-qp' - qq')\\lambda_3 $$\n\n问题陈述 $\\phi_{12}$ 和 $\\phi_{23}$ 发生天平动，这意味着它们围绕一个常数值振荡。因此，它们的线性组合 $\\Phi$ 也必须围绕一个常数值发生天平动。这意味着其时间导数的长期平均值必须为零：$\\langle \\dot{\\Phi} \\rangle = 0$。\n\n我们使用定义 $n_i = \\dot{\\lambda}_i$ 对 $\\Phi$ 关于时间求导：\n$$ \\dot{\\Phi} = \\frac{d}{dt} \\left[ (-pq')\\lambda_1 + (pq' + qq' + qp')\\lambda_2 - (qp' + qq')\\lambda_3 \\right] $$\n假设在所关心的时间尺度上，平均运动 $n_i$ 是恒定的（长期近似），我们得到：\n$$ \\dot{\\Phi} = (-pq')\\dot{\\lambda}_1 + (pq' + qq' + qp')\\dot{\\lambda}_2 + (-qp' - qq')\\dot{\\lambda}_3 $$\n$$ \\dot{\\Phi} = (-pq')n_1 + (pq' + qq' + qp')n_2 + (-qp' - qq')n_3 $$\n\n条件 $\\langle \\dot{\\Phi} \\rangle = 0$ 意味着平均运动的这个线性组合在领头阶上必须为零：\n$$ (-pq')n_1 + (pq' + qq' + qp')n_2 - (qp' + qq')n_3 = 0 $$\n这就是形式为 $k_1 n_1 + k_2 n_2 + k_3 n_3 = 0$ 的拉普拉斯型关系。通过比较这两种形式，我们可以确定整数系数 $k_1$、$k_2$ 和 $k_3$：\n$$ k_1 = -pq' $$\n$$ k_2 = pq' + qq' + qp' $$\n$$ k_3 = -qp' - qq' $$\n这些就是所要求的、用二体共振参数表示的系数。",
            "answer": "$$\\boxed{\\begin{pmatrix} -pq' & pq' + qq' + qp' & -qp' - qq' \\end{pmatrix}}$$"
        },
        {
            "introduction": "理论虽然强大，但我们如何从复杂的数值模拟或真实观测数据中确认共振的存在呢？这项计算练习将理论与实践联系起来，要求你开发一个稳健的算法，用以区分共振角的平动和循环。通过这个练习，你将掌握现代系外行星科学研究所必需的关键数据分析技能。",
            "id": "4176476",
            "problem": "我们为您提供一个候选行星对或行星链的单个临界共振角 $\\phi(t)$ 的均匀采样时间序列。在牛顿引力动力学和近公度平运动的背景下，共振构型与一个或多个临界角的平动（libration）相关联，而非共振构型则对应于这些角在整个圆周上的循环（circulation）。您的任务是设计并实现一个有科学依据的诊断方法，以根据数值输出来判断给定的角度时间序列 $\\phi(t)$ 是处于平动状态还是循环状态。\n\n您必须将您的推导和算法设计基于以下基本定律和核心定义：\n- 牛顿力学控制轨道运动，共振产生于近公度的平运动，导致相位保护，其特征是临界角的有界运动。\n- 临界角 $\\phi(t)$ 是 $2\\pi$ 周期的，可能表现为平动（围绕一个中心点的有界振荡）或循环（模 $2\\pi$ 的无界单调遍历）。\n- 单位圆上的循环统计学使用平均合矢量长度来量化集中度与均匀度。\n\n您必须仅使用在 $N$ 个均匀时间点 $\\{t_i\\}_{i=0}^{N-1}$（步长 $\\Delta t$ 恒定）上采样的时间序列 $\\phi(t)$ 来开发定量诊断指标。角度必须被视为 $2\\pi$ 周期的，并以弧度表示。该诊断方法必须计算关于 $\\{\\phi(t_i)\\}$ 的以下度量指标：\n\n1. 循环集中度：计算循环平均值 $\\mu$ 和平均合矢量长度 $R$，定义如下\n$$\nC = \\frac{1}{N} \\sum_{i=0}^{N-1} \\cos\\left(\\phi_i\\right), \\quad S = \\frac{1}{N} \\sum_{i=0}^{N-1} \\sin\\left(\\phi_i\\right), \\quad \\mu = \\operatorname{atan2}(S, C), \\quad R = \\sqrt{C^2 + S^2}.\n$$\n大的 $R$ 值表示与平动一致的集中性；小的 $R$ 值表示与循环一致的分散性。\n\n2. 最小包围弧宽：计算包含单位圆上所有采样点的最小弧宽 $W$（以弧度为单位）。这通过将角度排序到 $[0, 2\\pi)$ 区间，计算连续角度之间的循环间隙集合（包括环绕间隙），找到最大间隙 $G_{\\max}$，然后得到 $W = 2\\pi - G_{\\max}$。\n\n3. 稳健振幅估计：计算振幅估计值 $A$。首先评估相对于循环平均值的角偏差 $\\delta_i = \\operatorname{wrap}(\\phi_i - \\mu)$，其中 $\\operatorname{wrap}$ 函数将角度映射到 $(-\\pi, \\pi]$。设 $q_{0.05}$ 和 $q_{0.95}$ 分别表示 $\\{\\delta_i\\}$ 的 $5\\%$ 和 $95\\%$ 分位数。定义\n$$\nA = \\frac{1}{2} \\left(q_{0.95} - q_{0.05}\\right).\n$$\n这是关于 $\\mu$ 的运动角范围一半的稳健估计。\n\n4. 频率内容和谱集中度：构建有界信号 $x_i = \\sin(\\phi_i)$，移除其样本均值得到 $\\tilde{x}_i = x_i - \\bar{x}$，计算其离散傅里叶变换（DFT）和非零频率的功率谱 $P_k = |\\hat{x}_k|^2$。定义谱峰比\n$$\nS_{\\mathrm{peak}} = \\frac{\\max_{k \\neq 0} P_k}{\\sum_{k \\neq 0} P_k}.\n$$\n较大的 $S_{\\mathrm{peak}}$ 值表示变异性主要由窄带振荡主导，这符合平动的预期；宽带功率或弱峰表示循环或复杂运动。\n\n5. 平动分数：对于选定的振幅阈值 $A_{\\mathrm{thr}}$，定义位于循环平均值周围此角半宽内的样本分数，\n$$\nF_{\\mathrm{lib}} = \\frac{1}{N} \\sum_{i=0}^{N-1} \\mathbf{1}\\left(|\\delta_i| \\le A_{\\mathrm{thr}}\\right),\n$$\n其中 $\\mathbf{1}(\\cdot)$ 是指示函数。\n\n定义宣告平动的定量阈值：\n- $R \\ge R_{\\mathrm{thr}}$,\n- $W \\le W_{\\mathrm{thr}}$,\n- $A \\le A_{\\mathrm{thr}}$,\n- $S_{\\mathrm{peak}} \\ge S_{\\mathrm{thr}}$,\n- $F_{\\mathrm{lib}} \\ge F_{\\mathrm{thr}}$.\n\n您必须基于第一性原理以及平动与循环的简单模型，为 $R_{\\mathrm{thr}}$、$W_{\\mathrm{thr}}$、$A_{\\mathrm{thr}}$、$S_{\\mathrm{thr}}$ 和 $F_{\\mathrm{thr}}$ 推导出合理的数值，然后实现一个决策规则，仅当所有阈值都满足时才宣告“平动”。所有角度都以弧度为单位，频率分析使用无单位采样的离散时间索引 $i$；除了均匀采样外，不需要进行物理时间单位的转换。\n\n测试套件：\n构建以下五个合成测试案例，每个案例提供一个包含 $N=300$ 个 $\\phi(t)$ 样本的数组，单位为弧度，在整数索引 $t_i = i$ 处采样：\n- 案例 1（明确的平动，“理想路径”）：$\\phi(t) = 0 + 0.6 \\sin(2\\pi f t) + \\epsilon(t)$，其中 $f = 0.03$，$\\epsilon(t)$ 是标准差为 $0.05$ 弧度的高斯噪声。预期结果：布尔值 True。\n- 案例 2（明确的循环）：$\\phi(t) = \\operatorname{wrap}(0.20 t + \\epsilon(t))$，其中 $\\epsilon(t)$ 是标准差为 $0.05$ 弧度的高斯噪声，$\\operatorname{wrap}(\\cdot)$ 映射到 $(-\\pi, \\pi]$。预期结果：布尔值 False。\n- 案例 3（近边界宽振幅）：$\\phi(t) = 0 + 1.5 \\sin(2\\pi f t) + \\epsilon(t)$，其中 $f = 0.02$，$\\epsilon(t)$ 是标准差为 $0.05$ 弧度的高斯噪声。预期结果：布尔值 False。\n- 案例 4（多模平动）：$\\phi(t) = \\frac{\\pi}{3} + 0.4 \\sin(2\\pi f_1 t) + 0.25 \\sin(2\\pi f_2 t) + \\epsilon(t)$，其中 $f_1 = 0.025$, $f_2 = 0.042$，$\\epsilon(t)$ 是标准差为 $0.03$ 弧度的高斯噪声。预期结果：布尔值 True。\n- 案例 5（间歇性：一半平动，一半循环）：对于 $t \\le 150$，$\\phi(t) = 0.4 \\sin(2\\pi \\cdot 0.03 \\cdot t)$；对于 $t > 150$，$\\phi(t) = \\operatorname{wrap}(0.25 (t-150))$; 向所有样本添加标准差为 $0.04$ 弧度的高斯噪声，并对整个序列应用 $\\operatorname{wrap}$。预期结果：布尔值 False。\n\n您的程序必须：\n- 实现上述度量指标，选择并记录严格从您的推理中得出的阈值。\n- 将决策规则应用于五个测试案例中的每一个。\n- 生成一行输出，其中包含用方括号括起来的、以逗号分隔的布尔结果列表，例如，\"[True,False,True,False,True]\"。\n\n角度必须以弧度表示。输入或输出中不出现其他物理单位。所有角度和阈值均以弧度为单位，任何频率内容分析都在无单位频率的离散样本索引域上进行。",
            "solution": "用户要求提供一种诊断算法，以确定行星共振角 $\\phi(t)$ 的时间序列代表平动还是循环。解决方案需要推导一组定量度量指标和相应的阈值，并加以实现，然后在合成数据上进行测试。\n\n首先，对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- **任务**：设计一种诊断方法，将临界角 $\\phi(t)$ 的时间序列分类为平动或循环。\n- **基本原理**：牛顿力学，共振动力学，循环统计学。平动是有界振荡；循环是模 $2\\pi$ 的无界单调遍历。\n- **输入**：在均匀时间步长上采样的角度时间序列 $\\{\\phi_i\\}_{i=0}^{N-1}$，单位为弧度。\n- **待计算的度量指标**：\n    1.  **循环集中度**：平均合矢量长度 $R$，来自 $C = \\frac{1}{N} \\sum_{i=0}^{N-1} \\cos(\\phi_i)$ 和 $S = \\frac{1}{N} \\sum_{i=0}^{N-1} \\sin(\\phi_i)$，其中 $R = \\sqrt{C^2 + S^2}$ 且循环平均值 $\\mu = \\operatorname{atan2}(S, C)$。\n    2.  **最小包围弧宽**：$W = 2\\pi - G_{\\max}$，其中 $G_{\\max}$ 是排序后角度之间的最大循环间隙。\n    3.  **稳健振幅估计**：$A = \\frac{1}{2} (q_{0.95} - q_{0.05})$，其中 $q_p$ 是偏差 $\\delta_i = \\operatorname{wrap}(\\phi_i - \\mu)$ 到 $(-\\pi, \\pi]$ 的分位数。\n    4.  **谱峰比**：$S_{\\mathrm{peak}} = \\frac{\\max_{k \\neq 0} P_k}{\\sum_{k \\neq 0} P_k}$，来自减去均值的信号 $x_i = \\sin(\\phi_i)$ 的功率谱 $P_k$。\n    5.  **平动分数**：$F_{\\mathrm{lib}} = \\frac{1}{N} \\sum_{i=0}^{N-1} \\mathbf{1}(|\\delta_i| \\le A_{\\mathrm{thr}})$。\n- **决策规则**：当且仅当所有五个条件都满足时，序列才被分类为平动：$R \\ge R_{\\mathrm{thr}}$，$W \\le W_{\\mathrm{thr}}$，$A \\le A_{\\mathrm{thr}}$，$S_{\\mathrm{peak}} \\ge S_{\\mathrm{thr}}$，$F_{\\mathrm{lib}} \\ge F_{\\mathrm{thr}}$。\n- **任务**：为阈值 $R_{\\mathrm{thr}}$、$W_{\\mathrm{thr}}$、$A_{\\mathrm{thr}}$、$S_{\\mathrm{thr}}$ 和 $F_{\\mathrm{thr}}$ 推导出合理的数值。\n- **测试套件**：提供了五个合成案例，每个案例有 $N=300$ 个样本：\n    -   案例 1（平动）：$\\phi(t) = 0.6 \\sin(2\\pi \\cdot 0.03 \\cdot t) + \\epsilon(t)$，$\\sigma_\\epsilon=0.05$。预期：True。\n    -   案例 2（循环）：$\\phi(t) = \\operatorname{wrap}(0.20 t + \\epsilon(t))$，$\\sigma_\\epsilon=0.05$。预期：False。\n    -   案例 3（宽平动）：$\\phi(t) = 1.5 \\sin(2\\pi \\cdot 0.02 \\cdot t) + \\epsilon(t)$，$\\sigma_\\epsilon=0.05$。预期：False。\n    -   案例 4（多模平动）：$\\phi(t) = \\frac{\\pi}{3} + 0.4 \\sin(2\\pi \\cdot 0.025 \\cdot t) + 0.25 \\sin(2\\pi \\cdot 0.042 \\cdot t) + \\epsilon(t)$，$\\sigma_\\epsilon=0.03$。预期：True。\n    -   案例 5（间歇性）：一半平动，一半循环，噪声 $\\sigma_\\epsilon=0.04$。预期：False。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在天体力学和信号处理方面有科学依据。共振角、平动、循环、循环统计学和傅里叶分析等概念都是标准的且定义正确。问题陈述清晰，提供了构建解决方案所需的所有数学定义和数据。推导阈值的任务是设计分类算法的标准部分。语言客观而精确。合成的测试案例定义明确，可以作为真实世界数据的合理简化代理，从而能够清晰地测试算法的逻辑。该问题是自洽且内部一致的。\n\n### 步骤 3：结论和行动\n问题是**有效的**。将开发一个解决方案。\n\n### 基于原理的设计与阈值推导\n\n该算法必须能稳健地区分有界的、集中的角度运动（平动）和无界的、分散的运动（循环）。阈值的推导是通过考虑这两种对立情况下每个度量指标的理想化行为得出的。\n\n1.  **度量指标 $A_{\\mathrm{thr}}$（振幅阈值）**：这个阈值是核心，因为它定义了被视为平动的状态所允许的最大振幅，并且也用于计算 $F_{\\mathrm{lib}}$。平动意味着限制。虽然理论上平动的振幅可以高达 $\\pi$，但在实践中，稳定的低阶共振通常表现出远低于此值的振幅。案例3是一个振幅 $A_0=1.5$ 弧度的“宽振幅”平动，必须被拒绝，而案例1的振幅 $A_0=0.6$ 弧度必须被接受。这为 $A_{\\mathrm{thr}}$ 的选择提供了强有力的指导。需要一个介于这两个振幅之间的值。我们选择一个代表了 $\\pi/2$ 的显著部分，但明显小于1.5的值。选择 $A_{\\mathrm{thr}} = 1.2$ 弧度是合理的。这个值足够大，可以容纳许多真实的平动，但又足够小，可以拒绝接近循环的宽振幅情况。决策规则是 $A \\le A_{\\mathrm{thr}}$。\n\n2.  **度量指标 $R_{\\mathrm{thr}}$（平均合矢量长度阈值）**：对于一个完美的循环体，角度在 $[0, 2\\pi)$ 上均匀分布，对于无限样本，$R=0$。对于大小为 $N=300$ 的有限样本，预期的 $R$ 值很小，约为 $\\sqrt{\\pi/(4N)} \\approx 0.05$。相反，对于一个振幅为 $A_0$ 且围绕 $\\mu=0$ 的小振幅平动，$R \\approx \\langle \\cos(A_0 \\sin\\omega t) \\rangle \\approx 1 - A_0^2/4$。对于案例1（$A_0=0.6$），$R \\approx 1 - 0.36/4 = 0.91$。对于案例3（$A_0=1.5$），$R \\approx 1 - 2.25/4 \\approx 0.44$。阈值 $R_{\\mathrm{thr}} = 0.5$ 能稳健地将这些情况分开。它能正确识别宽振幅案例3和任何循环案例中缺乏集中性的特点，同时接受明显集中的案例。\n\n3.  **度量指标 $W_{\\mathrm{thr}}$（弧宽阈值）**：对于振幅为 $A_0$ 的平动，数据应被限制在宽度接近 $2A_0$ 的弧上。对于循环，数据应跨越整个圆周，因此 $W \\approx 2\\pi$。阈值必须拒绝循环体和案例3，后者的角范围为 $2 \\times 1.5 = 3.0$ 弧度。一个略低于此值的阈值 $W_{\\mathrm{thr}} = 2.8$ 弧度可以实现这一点。这确保了运动被限制在一个明显小于整个圆周（$\\approx 6.28$ 弧度）的区域内。\n\n4.  **度量指标 $S_{\\mathrm{thr}}$（谱峰比阈值）**：平动是一种振荡，意味着其功率谱应由一个或几个频率主导。信号是 $x_i = \\sin(\\phi_i)$。对于小振幅平动 $\\phi_i \\approx A_0\\sin(\\omega i)$，$x_i$ 近似于正弦波，将所有功率集中在单个DFT峰值上，导致 $S_{\\mathrm{peak}} \\approx 1$。对于循环，$\\phi_i$ 是一个斜坡函数，使得 $x_i$ 成为一个类啁啾信号，频谱较宽，因此 $S_{\\mathrm{peak}}$ 很小。对于白噪声，$S_{\\mathrm{peak}} \\approx 1/(N/2) = 2/300 \\approx 0.007$。像 $\\sin(1.5\\sin(\\omega t))$ 这样的宽振幅平动会产生显著的高次谐波，使功率分散并降低 $S_{\\mathrm{peak}}$。我们选择阈值 $S_{\\mathrm{thr}} = 0.2$。这个值表明，信号的非直流功率中至少有20%必须包含在其最强的单个频率分量中，这对准周期振荡来说是一个合理的要求。\n\n5.  **度量指标 $F_{\\mathrm{thr}}$（平动分数阈值）**：该度量指标量化了数据与推导出的振幅阈值 $A_{\\mathrm{thr}} = 1.2$ 弧度的符合程度。对于振幅 $A  < A_{\\mathrm{thr}}$ 的真实平动（例如，案例1和4），我们期望几乎所有点都落在此界限内，因此 $F_{\\mathrm{lib}} \\approx 1$。对于循环，偏差 $\\delta_i$ 在 $(-\\pi, \\pi]$ 上大致均匀分布，因此满足 $|\\delta_i| \\le 1.2$ 的点所占的比例应约为 $2 \\times 1.2 / (2\\pi) \\approx 0.38$。对于案例3，其实际振幅1.5超过了阈值1.2，因此有相当一部分点会落在此界限之外。我们设定一个严格的阈值 $F_{\\mathrm{thr}} = 0.9$，要求至少90%的运动包含在名义平动振幅之内。这能有效地拒绝循环、间歇性案例以及被认为不稳定的更宽幅度的平动。\n\n总而言之，推导出的阈值为：\n- $R_{\\mathrm{thr}} = 0.5$\n- $W_{\\mathrm{thr}} = 2.8$\n- $A_{\\mathrm{thr}} = 1.2$\n- $S_{\\mathrm{thr}} = 0.2$\n- $F_{\\mathrm{thr}} = 0.9$\n\n实现过程将为每个测试案例计算这五个度量指标，并应用决策规则：当且仅当所有五个阈值条件都满足时，平动为 `True`。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to generate test cases, apply the libration diagnostic,\n    and print the results in the required format.\n    \"\"\"\n\n    def generate_test_cases():\n        \"\"\"Generates the five synthetic test cases for phi(t).\"\"\"\n        N = 300\n        t = np.arange(N)\n        np.random.seed(42)  # for reproducibility\n\n        cases = []\n\n        # Case 1: Clear libration\n        f1 = 0.03\n        noise1 = np.random.normal(0, 0.05, N)\n        phi1 = 0.6 * np.sin(2 * np.pi * f1 * t) + noise1\n        cases.append(phi1)\n\n        # Case 2: Clear circulation\n        noise2 = np.random.normal(0, 0.05, N)\n        phi2_raw = 0.20 * t + noise2\n        # Use np.angle for wrapping to (-pi, pi]\n        phi2 = np.angle(np.exp(1j * phi2_raw))\n        cases.append(phi2)\n\n        # Case 3: Near-boundary wide amplitude libration\n        f3 = 0.02\n        noise3 = np.random.normal(0, 0.05, N)\n        phi3 = 1.5 * np.sin(2 * np.pi * f3 * t) + noise3\n        cases.append(phi3)\n\n        # Case 4: Multi-mode libration\n        f4_1, f4_2 = 0.025, 0.042\n        noise4 = np.random.normal(0, 0.03, N)\n        phi4 = (np.pi / 3) + 0.4 * np.sin(2 * np.pi * f4_1 * t) + \\\n               0.25 * np.sin(2 * np.pi * f4_2 * t) + noise4\n        cases.append(phi4)\n\n        # Case 5: Intermittent\n        noise5 = np.random.normal(0, 0.04, N)\n        phi5 = np.zeros(N)\n        # Libration part\n        t_lib = t[t = 150]\n        phi5[t = 150] = 0.4 * np.sin(2 * np.pi * 0.03 * t_lib)\n        # Circulation part\n        t_circ = t[t > 150]\n        phi5[t > 150] = 0.25 * (t_circ - 150)\n        phi5_raw = phi5 + noise5\n        phi5_final = np.angle(np.exp(1j * phi5_raw))\n        cases.append(phi5_final)\n\n        return cases\n\n    def is_librating(phi, thresholds):\n        \"\"\"\n        Determines if a time series phi is librating based on a set of metrics\n        and thresholds.\n        \n        Args:\n            phi (np.ndarray): Time series of the critical angle in radians.\n            thresholds (dict): Dictionary of threshold values.\n        \n        Returns:\n            bool: True if libration is detected, False otherwise.\n        \"\"\"\n        N = len(phi)\n\n        # 1. Circular concentration\n        C = np.mean(np.cos(phi))\n        S = np.mean(np.sin(phi))\n        R = np.sqrt(C**2 + S**2)\n        mu = np.arctan2(S, C)\n\n        # 2. Minimal enclosing arc width\n        # Map angles to [0, 2*pi) for sorting\n        phi_mod_2pi = phi % (2 * np.pi)\n        phi_sorted = np.sort(phi_mod_2pi)\n        gaps = np.diff(phi_sorted)\n        # Include the wrap-around gap\n        wrap_around_gap = 2 * np.pi - (phi_sorted[-1] - phi_sorted[0])\n        G_max = np.max(np.append(gaps, wrap_around_gap))\n        W = 2 * np.pi - G_max\n\n        # Helper function to wrap angles to (-pi, pi]\n        def wrap_to_pi(x):\n            return np.angle(np.exp(1j * x))\n\n        # 3. Robust amplitude estimate\n        delta = wrap_to_pi(phi - mu)\n        q05, q95 = np.quantile(delta, [0.05, 0.95])\n        A = 0.5 * (q95 - q05)\n\n        # 4. Spectral peak ratio\n        x = np.sin(phi)\n        x_tilde = x - np.mean(x)\n        # Use rfft for real-valued signals\n        dft_x = np.fft.rfft(x_tilde)\n        # Power spectrum for non-zero frequencies\n        # rfft output corresponds to frequencies k/N for k = 0, 1, ..., N/2\n        # Index 0 is the DC component\n        power_spectrum = np.abs(dft_x[1:])**2\n        \n        if len(power_spectrum) == 0 or np.sum(power_spectrum) == 0:\n            S_peak = 0.0\n        else:\n            max_power = np.max(power_spectrum)\n            total_power = np.sum(power_spectrum)\n            S_peak = max_power / total_power\n            \n        # 5. Libration fraction\n        A_thr = thresholds['A_thr']\n        F_lib = np.mean(np.abs(delta) = A_thr)\n\n        # Decision rule\n        res_R = R >= thresholds['R_thr']\n        res_W = W = thresholds['W_thr']\n        res_A = A = thresholds['A_thr']\n        res_Speak = S_peak >= thresholds['S_thr']\n        res_Flib = F_lib >= thresholds['F_thr']\n\n        return all([res_R, res_W, res_A, res_Speak, res_Flib])\n\n    # Derived threshold values\n    thresholds = {\n        'R_thr': 0.5,\n        'W_thr': 2.8,\n        'A_thr': 1.2,\n        'S_thr': 0.2,\n        'F_thr': 0.9,\n    }\n\n    test_cases = generate_test_cases()\n    results = []\n    for phi_series in test_cases:\n        result = is_librating(phi_series, thresholds)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}