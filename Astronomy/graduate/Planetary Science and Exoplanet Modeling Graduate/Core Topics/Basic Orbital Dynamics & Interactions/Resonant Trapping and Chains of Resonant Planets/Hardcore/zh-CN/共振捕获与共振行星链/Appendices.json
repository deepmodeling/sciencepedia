{
    "hands_on_practices": [
        {
            "introduction": "要理解行星如何在共振链中被捕获，我们首先必须分析单个共振环节的动力学行为。这个练习将引导你分析一个简化但极具代表性的一阶共振哈密顿量，这是描述两个行星相互作用的基础模型。通过确定系统的平衡点并分析它们的线性稳定性，你将亲手揭示共振相空间的基本结构，包括稳定的天平动中心和不稳定的鞍点，从而从根本上理解行星为何会围绕某些特定构型进行“天平动”（libration）而非“环流”（circulation）。",
            "id": "4176535",
            "problem": "考虑两个共面行星，它们接近于一个一阶平均运动共振，例如整数 $k \\geq 2$ 的 $k:(k-1)$ 共振关系。在对快角进行平均并对单个共振角-作用量对应用正则共振变换后，此类共振链中一个环节的共振动力学可以用以下形式的单自由度哈密顿量来建模\n$$\nH(\\phi,p)\\;=\\;\\frac{1}{2}\\,a\\,p^{2}\\;+\\;\\delta\\,p\\;-\\;\\varepsilon\\,\\cos\\phi,\n$$\n其中 $a0$ 和 $\\varepsilon0$ 是分别由开普勒部分的局部曲率和摄动函数一阶项的振幅决定的常数，而 $\\delta$ 是一个衡量与精确共振偏差的小失谐参数。正则坐标 $\\phi$ 是共振角，而 $p$ 是其共轭动量，与平均运动偏离精确共振的量成正比。假设这是一个平面问题，并忽略任何额外的慢进动项。\n\n仅使用哈密顿方程和围绕平衡点的运动方程线性化，完成以下任务：\n- 在 $(\\phi,p)$ 平面上找出系统的所有平衡点 $(\\phi^{\\star},p^{\\star})$。\n- 通过计算在每个平衡点处求值的线性化运动方程的雅可比矩阵的特征值，来确定每个平衡点的线性稳定性。\n\n最后，报告一个量：线性稳定平衡点处特征值的绝对值（即线性天平动频率的大小），表示为仅含 $a$ 和 $\\varepsilon$ 的闭式符号函数。最终答案只提供符号表达式；不包括单位或数值，且不要近似。角度以弧度为单位。",
            "solution": "问题陈述被认为是有效的，因为它在哈密顿力学和天体动力学方面有科学依据，是适定的、客观的，并包含了推导唯一解所需的所有必要信息。\n\n系统的动力学由哈密顿量决定\n$$\nH(\\phi,p) = \\frac{1}{2} a p^{2} + \\delta p - \\varepsilon \\cos\\phi\n$$\n其中 $(\\phi, p)$ 是正则共轭变量，$a$、$ \\delta$、$\\varepsilon$ 是参数，且 $a  0$ 和 $\\varepsilon  0$。运动方程由哈密顿方程给出：\n$$\n\\dot{\\phi} = \\frac{\\partial H}{\\partial p}\n$$\n$$\n\\dot{p} = -\\frac{\\partial H}{\\partial \\phi}\n$$\n首先，我们计算哈密顿量的偏导数：\n$$\n\\frac{\\partial H}{\\partial p} = a p + \\delta\n$$\n$$\n\\frac{\\partial H}{\\partial \\phi} = \\frac{\\partial}{\\partial \\phi} (-\\varepsilon \\cos\\phi) = -\\varepsilon (-\\sin\\phi) = \\varepsilon \\sin\\phi\n$$\n将这些代入哈密顿方程，得到系统的运动方程：\n$$\n\\dot{\\phi} = a p + \\delta\n$$\n$$\n\\dot{p} = -\\varepsilon \\sin\\phi\n$$\n平衡点，记为 $(\\phi^{\\star}, p^{\\star})$，是相空间中系统处于静止状态的点。通过将时间导数设为零来找到它们：$\\dot{\\phi} = 0$ 和 $\\dot{p} = 0$。\n$$\nap^{\\star} + \\delta = 0 \\quad \\implies \\quad p^{\\star} = -\\frac{\\delta}{a}\n$$\n$$\n-\\varepsilon \\sin\\phi^{\\star} = 0\n$$\n由于 $\\varepsilon  0$，第二个方程要求 $\\sin\\phi^{\\star} = 0$。在区间 $\\phi \\in [0, 2\\pi)$ 内，当 $\\phi^{\\star} = 0$ 和 $\\phi^{\\star} = \\pi$ 时满足此条件。\n因此，我们有两个不同的平衡点：\n$1$. $E_1: (\\phi^{\\star}, p^{\\star}) = (0, -\\frac{\\delta}{a})$\n$2$. $E_2: (\\phi^{\\star}, p^{\\star}) = (\\pi, -\\frac{\\delta}{a})$\n\n为了确定这些平衡点的线性稳定性，我们在每个点周围对运动方程进行线性化。该系统可以写成向量形式 $\\dot{\\mathbf{x}} = \\mathbf{F}(\\mathbf{x})$，其中 $\\mathbf{x} = (\\phi, p)^T$ 且 $\\mathbf{F}(\\mathbf{x}) = (ap + \\delta, -\\varepsilon \\sin\\phi)^T$。稳定性由在平衡点处求值的 $\\mathbf{F}$ 的雅可比矩阵的特征值决定。雅可比矩阵 $J$ 是：\n$$\nJ(\\phi, p) = \\begin{pmatrix} \\frac{\\partial \\dot{\\phi}}{\\partial \\phi}  \\frac{\\partial \\dot{\\phi}}{\\partial p} \\\\ \\frac{\\partial \\dot{p}}{\\partial \\phi}  \\frac{\\partial \\dot{p}}{\\partial p} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial}{\\partial \\phi}(ap+\\delta)  \\frac{\\partial}{\\partial p}(ap+\\delta) \\\\ \\frac{\\partial}{\\partial \\phi}(-\\varepsilon \\sin\\phi)  \\frac{\\partial}{\\partial p}(-\\varepsilon \\sin\\phi) \\end{pmatrix} = \\begin{pmatrix} 0  a \\\\ -\\varepsilon \\cos\\phi  0 \\end{pmatrix}\n$$\n现在，我们在两个平衡点上分别对该雅可比矩阵求值。\n\n对于第一个平衡点 $E_1 = (0, -\\frac{\\delta}{a})$：\n我们将 $\\phi^{\\star} = 0$ 代入雅可比矩阵：\n$$\nJ(E_1) = \\begin{pmatrix} 0  a \\\\ -\\varepsilon \\cos(0)  0 \\end{pmatrix} = \\begin{pmatrix} 0  a \\\\ -\\varepsilon  0 \\end{pmatrix}\n$$\n特征值 $\\lambda$ 通过求解特征方程 $\\det(J(E_1) - \\lambda I) = 0$ 来找到，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n$$\n\\det\\begin{pmatrix} -\\lambda  a \\\\ -\\varepsilon  -\\lambda \\end{pmatrix} = (-\\lambda)(-\\lambda) - (a)(-\\varepsilon) = \\lambda^2 + a\\varepsilon = 0\n$$\n这得到 $\\lambda^2 = -a\\varepsilon$。由于 $a  0$ 和 $\\varepsilon  0$，乘积 $a\\varepsilon$ 是正的。特征值为：\n$$\n\\lambda = \\pm \\sqrt{-a\\varepsilon} = \\pm i\\sqrt{a\\varepsilon}\n$$\n由于特征值是纯虚数且成共轭复数对，平衡点 $E_1$ 在线性化系统中是一个中心点。因此，它是线性稳定的。该点附近的物理运动对应于天平动。\n\n对于第二个平衡点 $E_2 = (\\pi, -\\frac{\\delta}{a})$：\n我们将 $\\phi^{\\star} = \\pi$ 代入雅可比矩阵：\n$$\nJ(E_2) = \\begin{pmatrix} 0  a \\\\ -\\varepsilon \\cos(\\pi)  0 \\end{pmatrix} = \\begin{pmatrix} 0  a \\\\ -\\varepsilon(-1)  0 \\end{pmatrix} = \\begin{pmatrix} 0  a \\\\ \\varepsilon  0 \\end{pmatrix}\n$$\n特征方程为 $\\det(J(E_2) - \\lambda I) = 0$：\n$$\n\\det\\begin{pmatrix} -\\lambda  a \\\\ \\varepsilon  -\\lambda \\end{pmatrix} = (-\\lambda)(-\\lambda) - (a)(\\varepsilon) = \\lambda^2 - a\\varepsilon = 0\n$$\n这得到 $\\lambda^2 = a\\varepsilon$。特征值为：\n$$\n\\lambda = \\pm\\sqrt{a\\varepsilon}\n$$\n由于 $a\\varepsilon  0$，特征值是实数，一个为正，一个为负。这表明平衡点 $E_2$ 是一个鞍点，是不稳定的。\n\n问题要求的是线性稳定平衡点处特征值的绝对值。稳定平衡点是 $E_1$。该点的特征值为 $\\lambda = \\pm i\\sqrt{a\\varepsilon}$。这些特征值的绝对值是：\n$$\n|\\lambda| = |\\pm i\\sqrt{a\\varepsilon}| = \\sqrt{a\\varepsilon}\n$$\n这个量表示围绕稳定平衡点的微小振荡（天平动）的角频率。按照要求，该表达式只是 $a$ 和 $\\varepsilon$ 的函数。",
            "answer": "$$\n\\boxed{\\sqrt{a\\varepsilon}}\n$$"
        },
        {
            "introduction": "在掌握了单个共振对的动力学之后，下一步自然是将其扩展到由多个行星构成的共振链。这个练习要求你从两个相邻的二体共振关系出发，推导出描述整个三体系统运动的拉普拉斯型关系。通过构建一个不依赖于特定行星轨道参数（此处为中间行星的近心点经度 $\\varpi_2$）的组合角，你将学会如何从底层的二体相互作用中提炼出更高层次的系统性约束，这是分析和理解系外行星系统中复杂共振链（如著名的TRAPPIST-1系统）的关键理论技巧。",
            "id": "4176568",
            "problem": "考虑一颗恒星，其质量远大于其行星，因此行星的运动可以很好地用具有微弱相互扰动的近开普勒轨道来描述。三颗行星，标记为 $1$、$2$ 和 $3$，形成一个共振链，其中行星 $1$ 和行星 $2$ 被锁定在一个阶数为 $q \\geq 1$ 的 $(p+q):p$ 平均运动共振中，而行星 $2$ 和行星 $3$ 被锁定在一个阶数为 $q' \\geq 1$ 的 $(p'+q'):p'$ 平均运动共振中，其中 $p$、$p'$、$q$、$q'$ 均为正整数。设行星 $i$ 的平经度为 $\\lambda_i$，近心点经度为 $\\varpi_i$，平均运动为 $n_i = d\\lambda_i/dt$。角度以弧度为单位。\n\n在平均运动共振的标准摄动函数描述中，每个二体共振 $(p+q):p$ 都有 $q+1$ 个不同的共振角，这些共振角耦合了平经度和近心点经度。对于行星对 $(1,2)$，其中一个这样的角度是 $\\phi_{12} = (p+q)\\lambda_2 - p\\lambda_1 - q\\varpi_2$；对于行星对 $(2,3)$，一个相应的角度是 $\\phi_{23} = (p'+q')\\lambda_3 - p'\\lambda_2 - q'\\varpi_2$。假设 $\\phi_{12}$ 和 $\\phi_{23}$ 都在常数值附近天平动，因此它们的导数在长期意义上平均为零。\n\n仅从这些定义和近开普勒关系 $n_i = d\\lambda_i/dt$ 出发，通过对 $\\phi_{12}$ 和 $\\phi_{23}$ 进行整数线性组合，构造一个与 $\\varpi_2$ 无关的单三体角。通过对这个组合求时间导数并利用天平动假设，推导出关于平均运动的 Laplace 型三体关系，其形式为一个在主导阶上为零的整数线性组合。将分别乘以 $n_1$、$n_2$ 和 $n_3$ 的整数系数 $k_1$、$k_2$ 和 $k_3$ 用 $p$、$q$、$p'$ 和 $q'$ 明确表示出来。\n\n您的最终答案必须是序三元组 $\\left(k_1, k_2, k_3\\right)$，以单行矩阵的形式给出。不需要进行数值计算，最终表达式中不应包含任何单位。",
            "solution": "该问题要求推导一个共振链中三行星系统的 Laplace 型三体关系。该关系应为行星平均运动的线性组合，$k_1 n_1 + k_2 n_2 + k_3 n_3 = 0$，任务是求出整数系数 $(k_1, k_2, k_3)$。\n\n出发点是为相邻行星对提供的两个共振角：\n1. 对于行星对 $(1,2)$，在 $(p+q):p$ 共振中，角度为 $\\phi_{12} = (p+q)\\lambda_2 - p\\lambda_1 - q\\varpi_2$。\n2. 对于行星对 $(2,3)$，在 $(p'+q'):p'$ 共振中，角度为 $\\phi_{23} = (p'+q')\\lambda_3 - p'\\lambda_2 - q'\\varpi_2$。\n\n这些定义的一个关键特征是，两个共振角都依赖于中间行星的近心点经度 $\\varpi_2$。第一步是构造一个新的、与 $\\varpi_2$ 无关的三体角 $\\Phi$。我们将 $\\Phi$ 构造成 $\\phi_{12}$ 和 $\\phi_{23}$ 的整数线性组合：\n$$ \\Phi = a\\phi_{12} + b\\phi_{23} $$\n其中 $a$ 和 $b$ 是整数。代入 $\\phi_{12}$ 和 $\\phi_{23}$ 的定义：\n$$ \\Phi = a \\left( (p+q)\\lambda_2 - p\\lambda_1 - q\\varpi_2 \\right) + b \\left( (p'+q')\\lambda_3 - p'\\lambda_2 - q'\\varpi_2 \\right) $$\n为了使 $\\Phi$ 与 $\\varpi_2$ 无关，$\\varpi_2$ 项的系数之和必须为零。让我们按角变量对各项进行分组：\n$$ \\Phi = (-ap)\\lambda_1 + (a(p+q) - bp')\\lambda_2 + (b(p'+q'))\\lambda_3 - (aq + bq')\\varpi_2 $$\n与 $\\varpi_2$ 无关的条件是：\n$$ aq + bq' = 0 $$\n$$ aq = -bq' $$\n由于 $p, q, p', q'$ 都是正整数，对于 $a$ 和 $b$，最简单的非平凡整数解是选择 $a = q'$ 和 $b = -q$。这个选择（或其负值，$a = -q'$ 和 $b = q$）给出了所需的组合。我们将以 $a = q'$ 和 $b = -q$ 继续进行。\n\n得到的三体角为 $\\Phi = q'\\phi_{12} - q\\phi_{23}$。让我们用平经度明确地写出这个表达式：\n$$ \\Phi = q'\\left( (p+q)\\lambda_2 - p\\lambda_1 - q\\varpi_2 \\right) - q\\left( (p'+q')\\lambda_3 - p'\\lambda_2 - q'\\varpi_2 \\right) $$\n$$ \\Phi = pq'\\lambda_2 + qq'\\lambda_2 - pq'\\lambda_1 - qq'\\varpi_2 - qp'\\lambda_3 - qq'\\lambda_3 + qp'\\lambda_2 + qq'\\varpi_2 $$\n包含 $\\varpi_2$ 的项按设计抵消了。按行星编号对剩余项进行分组：\n$$ \\Phi = (-pq')\\lambda_1 + (pq' + qq' + qp')\\lambda_2 + (-qp' - qq')\\lambda_3 $$\n\n问题陈述 $\\phi_{12}$ 和 $\\phi_{23}$ 天平动，这意味着它们围绕一个恒定值振荡。因此，它们的线性组合 $\\Phi$ 也必须围绕一个恒定值天平动。这意味着其时间导数的长期平均值必须为零：$\\langle \\dot{\\Phi} \\rangle = 0$。\n\n我们对 $\\Phi$ 求时间导数，使用定义 $n_i = \\dot{\\lambda}_i$：\n$$ \\dot{\\Phi} = \\frac{d}{dt} \\left[ (-pq')\\lambda_1 + (pq' + qq' + qp')\\lambda_2 - (qp' + qq')\\lambda_3 \\right] $$\n假设平均运动 $n_i$ 在所关心的时间尺度上是恒定的（长期近似），我们得到：\n$$ \\dot{\\Phi} = (-pq')\\dot{\\lambda}_1 + (pq' + qq' + qp')\\dot{\\lambda}_2 + (-qp' - qq')\\dot{\\lambda}_3 $$\n$$ \\dot{\\Phi} = (-pq')n_1 + (pq' + qq' + qp')n_2 + (-qp' - qq')n_3 $$\n\n条件 $\\langle \\dot{\\Phi} \\rangle = 0$ 意味着平均运动的这个线性组合在主导阶上必须为零：\n$$ (-pq')n_1 + (pq' + qq' + qp')n_2 - (qp' + qq')n_3 = 0 $$\n这就是形式为 $k_1 n_1 + k_2 n_2 + k_3 n_3 = 0$ 的 Laplace 型关系。通过比较两种形式，我们可以确定整数系数 $k_1$、$k_2$ 和 $k_3$：\n$$ k_1 = -pq' $$\n$$ k_2 = pq' + qq' + qp' $$\n$$ k_3 = -qp' - qq' $$\n这些就是用二体共振的参数表示的所求系数。",
            "answer": "$$\\boxed{\\begin{pmatrix} -pq'  pq' + qq' + qp'  -qp' - qq' \\end{pmatrix}}$$"
        },
        {
            "introduction": "理论模型最终需要与观测数据相结合。这个练习将理论与实践联系起来，要求你扮演一个数据分析师的角色，对一个耦合共振链的模拟“观测”数据进行反演。给定系统的两个天平动周期、阻尼时标和模态振幅比等信息，你的任务是反向推导出描述该系统的物理参数，如共振强度和耦合系数。这项实践训练了从系统的宏观动力学行为（可观测的振荡模式）推断其微观物理属性（潜在的相互作用力）的关键能力，是行星系统建模和表征中的核心技能。",
            "id": "4176589",
            "problem": "考虑一个由两个相邻行星对组成的近共振链，其共振角的微小偏差可以被建模为——在对从牛顿第二定律和近共振哈密顿量导出的运动方程进行线性化之后——一个由两个耦合的、弱阻尼的自由度（DOF）组成的系统。设小角度偏差的向量为 $x(t) = \\begin{bmatrix} x_1(t) \\\\ x_2(t) \\end{bmatrix}$，其中每个 $x_i(t)$ 以弧度为单位。假设动力学由以下方程控制\n$$\n\\frac{d^2 x}{dt^2} + 2 \\gamma \\frac{dx}{dt} + A x = 0,\n$$\n其中 $\\gamma$ 是一个单位为 $\\mathrm{s}^{-1}$ 的恒定阻尼系数，而 $A$ 是一个恒定的、对称的 $2 \\times 2$ 矩阵，其元素单位为 $\\mathrm{s}^{-2}$，由下式给出\n$$\nA = \\begin{bmatrix} \\alpha_1  \\kappa \\\\ \\kappa  \\alpha_2 \\end{bmatrix}.\n$$\n参数 $\\alpha_1$ 和 $\\alpha_2$ 代表与两个自由度相关的有效共振强度，$\\kappa$ 是耦合强度。在弱阻尼和每个自由度中由行星-盘相互作用（偏心率阻尼和迁移）引起的比例耗散的假设下，对该链天平动的观测揭示了两个不同的欠阻尼简正模，它们具有测量的周期和一个共同的振幅衰减时间尺度。\n\n对于每个独立案例，您将获得以下可观测量：\n- 两个阻尼天平动周期 $P_{\\mathrm{low}}$ 和 $P_{\\mathrm{high}}$（单位为秒），分别对应于低频和高频简正模，其中频率定义为 $\\omega_{\\mathrm{d}} = 2\\pi / P$（单位为 $\\mathrm{rad}\\,\\mathrm{s}^{-1}$）。\n- 振幅衰减至 $1/e$ 的时间 $T$（单位为秒），假设对两个模式是共同的，并且意味着振幅包络按 $e^{-t/T}$ 衰减。\n- 测得的低频模式的模态振幅比 $r$（无量纲），定义为与低频模式相关的特征向量分量的比值 $r = v_1 / v_2$，因此该模式的特征向量可以在相差一个正比例因子的前提下表示为 $\\begin{bmatrix} r \\\\ 1 \\end{bmatrix}$。\n\n您的任务是反演该耦合模模型，以估算每个案例的参数 $\\alpha_1$、$\\alpha_2$、$\\kappa$（单位均为 $\\mathrm{s}^{-2}$）和 $\\gamma$（单位为 $\\mathrm{s}^{-1}$）。您必须从第一性原理出发，仅使用基本定律和核心定义（例如，牛顿第二定律、线性系统性质、特征值问题以及欠阻尼振荡的模态阻尼定义），并推导出完整的反演过程，而不依赖任何预先给定的简化公式。\n\n物理和数值单位：\n- 返回 $\\alpha_1$、$\\alpha_2$ 和 $\\kappa$，单位为 $\\mathrm{s}^{-2}$。\n- 返回 $\\gamma$，单位为 $\\mathrm{s}^{-1}$。\n- 所有角度均以弧度为单位。\n- 所有时间均以秒为单位。\n- 所有频率均以 $\\mathrm{rad}\\,\\mathrm{s}^{-1}$ 为单位。\n\n测试套件：\n为以下三个案例提供估算值。对于每个案例，使用指定的可观测量作为您的反演算法的输入。\n\n- 案例1（不同模式，中等耦合，弱阻尼）：\n    - $P_{\\mathrm{low}} = 290200.0\\,\\mathrm{s}$\n    - $P_{\\mathrm{high}} = 218200.0\\,\\mathrm{s}$\n    - $T = 1000000.0\\,\\mathrm{s}$\n    - $r = -3.303300859$\n\n- 案例2（近简并的非耦合频率，小耦合，较强阻尼）：\n    - $P_{\\mathrm{low}} = 239200.0\\,\\mathrm{s}$\n    - $P_{\\mathrm{high}} = 229000.0\\,\\mathrm{s}$\n    - $T = 500000.0\\,\\mathrm{s}$\n    - $r = -2.850000000$\n\n- 案例3（强频率分离，弱阻尼）：\n    - $P_{\\mathrm{low}} = 319000.0\\,\\mathrm{s}$\n    - $P_{\\mathrm{high}} = 180300.0\\,\\mathrm{s}$\n    - $T = 3333333.333333333\\,\\mathrm{s}$\n    - $r = -8.122493000$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表形式的结果，每个内部列表按 $[\\alpha_1,\\alpha_2,\\kappa,\\gamma]$ 排序并使用浮点数。例如，输出必须如下所示：\n$$\n\\texttt{[[a\\_1,a\\_2,\\kappa,\\gamma],[a\\_1,a\\_2,\\kappa,\\gamma],[a\\_1,a\\_2,\\kappa,\\gamma]]}\n$$\n其中每个 $a\\_i$、$\\kappa$ 和 $\\gamma$ 都是十进制表示。不应打印任何附加文本。",
            "solution": "该问题定义明确，具有科学依据，并提供了足够的信息来唯一确定物理模型的未知参数。反演过程将从第一性原理推导。\n\n系统的动力学由以下线性二阶矩阵微分方程描述：\n$$\n\\frac{d^2 x}{dt^2} + 2 \\gamma \\frac{dx}{dt} + A x = 0\n$$\n其中 $x(t) = \\begin{bmatrix} x_1(t) \\\\ x_2(t) \\end{bmatrix}$ 是角度偏差向量，$\\gamma$ 是阻尼系数，而 $A = \\begin{bmatrix} \\alpha_1  \\kappa \\\\ \\kappa  \\alpha_2 \\end{bmatrix}$ 是一个对称矩阵，代表系统动力学的保守部分。阻尼项 $2 \\gamma I \\frac{dx}{dt}$（其中 $I$ 是 $2 \\times 2$ 单位矩阵）代表比例阻尼。比例阻尼的一个关键结果是，阻尼系统的特征向量与非阻尼系统（由矩阵 $A$ 控制）的特征向量相同。这使得运动方程可以解耦为一组独立的模态方程。\n\n为了找到简正模，我们首先考虑矩阵 $A$ 的特征值问题：\n$$\nA v = \\Lambda v\n$$\n其中 $\\Lambda$ 是特征值，而 $v$ 是特征向量。$A$ 的特征值，记为 $\\Lambda_1$ 和 $\\Lambda_2$，是系统非阻尼固有角频率 $\\omega_{0,i}$ 的平方：$\\Lambda_i = \\omega_{0,i}^2$。\n\n设 $V$ 是其列为 $A$ 的标准正交特征向量的矩阵。我们可以执行坐标变换到模态基，$x = Vq$，其中 $q$ 是模态坐标向量。将此代入控制方程得到：\n$$\nV \\frac{d^2 q}{dt^2} + 2 \\gamma V \\frac{dq}{dt} + A V q = 0\n$$\n利用 $A V = V \\Lambda_D$ 的性质，其中 $\\Lambda_D$ 是特征值的对角矩阵，$\\Lambda_D = \\begin{pmatrix} \\Lambda_1  0 \\\\ 0  \\Lambda_2 \\end{pmatrix}$，并通过左乘 $V^{-1}$（对于标准正交特征向量，即为 $V^T$），我们得到一个解耦的系统：\n$$\n\\frac{d^2 q}{dt^2} + 2 \\gamma \\frac{dq}{dt} + \\Lambda_D q = 0\n$$\n这代表了每个模态坐标 $q_i(t)$ 的两个独立的二阶常微分方程：\n$$\n\\frac{d^2 q_i}{dt^2} + 2 \\gamma \\frac{dq_i}{dt} + \\Lambda_i q_i = 0 \\quad \\text{for } i=1, 2\n$$\n这是阻尼谐振子的标准方程。为了找到它的解，我们通过代入 $q_i(t) \\propto e^{st}$ 来检验特征方程：\n$$\ns^2 + 2\\gamma s + \\Lambda_i = 0\n$$\n根为 $s = -\\gamma \\pm \\sqrt{\\gamma^2 - \\Lambda_i}$。问题指出模式是欠阻尼的，这意味着 $\\gamma^2  \\Lambda_i$。因此，根是复数：\n$$\ns = -\\gamma \\pm i \\sqrt{\\Lambda_i - \\gamma^2}\n$$\n$q_i(t)$ 的解是一个振幅呈指数衰减的正弦波：\n$$\nq_i(t) = C_i e^{-\\gamma t} \\cos(\\omega_{d,i} t + \\phi_i)\n$$\n从复数根中，我们确定振幅衰减因子为 $e^{-\\gamma t}$，阻尼角频率为 $\\omega_{d,i} = \\sqrt{\\Lambda_i - \\gamma^2}$。\n\n反演过程是利用给定的可观测量（$P_{\\mathrm{low}}$、$P_{\\mathrm{high}}$、$T$、$r$）来求解模型参数（$\\alpha_1$、$\\alpha_2$、$\\kappa$、$\\gamma$）。\n\n1.  **确定阻尼系数 $\\gamma$**：\n    问题指出振幅衰减时间为 $T$。将振幅包络 $e^{-t/T}$ 与我们推导出的 $e^{-\\gamma t}$ 进行比较，我们发现直接关系：\n    $$\n    \\gamma = \\frac{1}{T}\n    $$\n\n2.  **确定 $A$ 的特征值**：\n    测得的阻尼天平动周期 $P_{\\mathrm{low}}$ 和 $P_{\\mathrm{high}}$ 对应于两个模态频率 $\\omega_{d,1}$ 和 $\\omega_{d,2}$。我们将较低的频率与模式1相关联，较高的频率与模式2相关联：\n    $$\n    \\omega_{d,1} = \\omega_{d, \\text{low}} = \\frac{2\\pi}{P_{\\mathrm{low}}}\n    $$\n    $$\n    \\omega_{d,2} = \\omega_{d, \\text{high}} = \\frac{2\\pi}{P_{\\mathrm{high}}}\n    $$\n    根据关系式 $\\omega_{d,i} = \\sqrt{\\Lambda_i - \\gamma^2}$，我们可以解出矩阵 $A$ 的特征值 $\\Lambda_i$：\n    $$\n    \\Lambda_i = \\omega_{d,i}^2 + \\gamma^2\n    $$\n    由于 $P_{\\mathrm{low}}  P_{\\mathrm{high}}$，因此 $\\omega_{d,1}  \\omega_{d,2}$，从而 $\\Lambda_1  \\Lambda_2$。所以我们有：\n    $$\n    \\Lambda_1 = \\left(\\frac{2\\pi}{P_{\\mathrm{low}}}\\right)^2 + \\gamma^2\n    $$\n    $$\n    \\Lambda_2 = \\left(\\frac{2\\pi}{P_{\\mathrm{high}}}\\right)^2 + \\gamma^2\n    $$\n\n3.  **确定矩阵参数 $\\alpha_1$、$\\alpha_2$ 和 $\\kappa$**：\n    我们还有另外两条信息：$A$ 的迹是其特征值之和，以及低频模式的特征向量。\n    迹的性质给出：\n    $$\n    \\text{Tr}(A) = \\alpha_1 + \\alpha_2 = \\Lambda_1 + \\Lambda_2 \\quad (\\text{Eq. I})\n    $$\n    问题指出，对于低频模式（与特征值 $\\Lambda_1$ 相关），特征向量 $v_1$ 与 $\\begin{bmatrix} r \\\\ 1 \\end{bmatrix}$ 成比例。特征向量方程 $(A - \\Lambda_1 I)v_1 = 0$ 变为：\n    $$\n    \\begin{bmatrix} \\alpha_1 - \\Lambda_1  \\kappa \\\\ \\kappa  \\alpha_2 - \\Lambda_1 \\end{bmatrix} \\begin{bmatrix} r \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}\n    $$\n    这产生了两个相关的方程：\n    $$\n    (\\alpha_1 - \\Lambda_1)r + \\kappa = 0 \\quad (\\text{Eq. II})\n    $$\n    $$\n    \\kappa r + (\\alpha_2 - \\Lambda_1) = 0 \\quad (\\text{Eq. III})\n    $$\n    我们现在有了一个包含三个未知数 $\\alpha_1$、$\\alpha_2$ 和 $\\kappa$ 的三个线性方程组（I, II, III）。从方程 (I)，我们表达 $\\alpha_2 = \\Lambda_1 + \\Lambda_2 - \\alpha_1$。将此代入方程 (III) 得到 $\\kappa r + (\\Lambda_1 + \\Lambda_2 - \\alpha_1) - \\Lambda_1 = 0$，简化为 $\\kappa r = \\alpha_1 - \\Lambda_2$，或 $\\kappa = (\\alpha_1 - \\Lambda_2)/r$。\n    从方程 (II)，我们有 $\\kappa = -(\\alpha_1 - \\Lambda_1)r$。\n    将两个关于 $\\kappa$ 的表达式相等：\n    $$\n    \\frac{\\alpha_1 - \\Lambda_2}{r} = -(\\alpha_1 - \\Lambda_1)r\n    $$\n    $$\n    \\alpha_1 - \\Lambda_2 = -r^2(\\alpha_1 - \\Lambda_1) = -\\alpha_1 r^2 + \\Lambda_1 r^2\n    $$\n    $$\n    \\alpha_1(1 + r^2) = \\Lambda_1 r^2 + \\Lambda_2\n    $$\n    求解 $\\alpha_1$：\n    $$\n    \\alpha_1 = \\frac{\\Lambda_1 r^2 + \\Lambda_2}{1 + r^2}\n    $$\n    现在，我们使用方程 (I) 来求解 $\\alpha_2$：\n    $$\n    \\alpha_2 = \\Lambda_1 + \\Lambda_2 - \\alpha_1 = \\Lambda_1 + \\Lambda_2 - \\frac{\\Lambda_1 r^2 + \\Lambda_2}{1 + r^2} = \\frac{(\\Lambda_1 + \\Lambda_2)(1+r^2) - (\\Lambda_1 r^2 + \\Lambda_2)}{1+r^2}\n    $$\n    $$\n    \\alpha_2 = \\frac{\\Lambda_1 + \\Lambda_1 r^2 + \\Lambda_2 + \\Lambda_2 r^2 - \\Lambda_1 r^2 - \\Lambda_2}{1+r^2} = \\frac{\\Lambda_1 + \\Lambda_2 r^2}{1+r^2}\n    $$\n    最后，我们用例如 $\\kappa = -(\\alpha_1 - \\Lambda_1)r$ 来求解 $\\kappa$：\n    $$\n    \\kappa = -\\left(\\frac{\\Lambda_1 r^2 + \\Lambda_2}{1+r^2} - \\Lambda_1\\right)r = -\\left(\\frac{\\Lambda_1 r^2 + \\Lambda_2 - \\Lambda_1(1+r^2)}{1+r^2}\\right)r\n    $$\n    $$\n    \\kappa = -\\left(\\frac{\\Lambda_2 - \\Lambda_1}{1+r^2}\\right)r = \\frac{(\\Lambda_1 - \\Lambda_2)r}{1+r^2}\n    $$\n    这些公式使得可以从给定的可观测量中完全确定模型参数。由于 $\\Lambda_1  \\Lambda_2$，$\\kappa$ 的符号与 $r$ 的符号相反。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the parameters of a coupled oscillator system based on observational data.\n    \"\"\"\n\n    # Test cases defined in the problem statement.\n    # Each case is a tuple: (P_low, P_high, T, r)\n    test_cases = [\n        (290200.0, 218200.0, 1000000.0, -3.303300859),\n        (239200.0, 229000.0, 500000.0, -2.850000000),\n        (319000.0, 180300.0, 3333333.333333333, -8.122493000),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        p_low, p_high, t, r = case\n\n        # 1. Calculate the damping coefficient gamma\n        # The amplitude decays as exp(-gamma * t), and the decay time T is the 1/e time.\n        # So, gamma * T = 1.\n        gamma = 1.0 / t\n\n        # 2. Calculate the damped angular frequencies\n        # omega_d = 2 * pi / P\n        omega_d_low = 2.0 * np.pi / p_low\n        omega_d_high = 2.0 * np.pi / p_high\n\n        # 3. Calculate the eigenvalues of the matrix A\n        # The damped frequency is omega_d = sqrt(Lambda - gamma^2),\n        # where Lambda are the eigenvalues of A.\n        # So, Lambda = omega_d^2 + gamma^2.\n        # Lambda_1 corresponds to the lower frequency mode.\n        lambda_1 = omega_d_low**2 + gamma**2\n        lambda_2 = omega_d_high**2 + gamma**2\n\n        # 4. Calculate the matrix parameters alpha_1, alpha_2, kappa\n        # These are derived from the eigenvector relation and the trace property of matrix A.\n        r_sq = r**2\n        \n        # alpha_1 = (Lambda_1 * r^2 + Lambda_2) / (1 + r^2)\n        alpha_1 = (lambda_1 * r_sq + lambda_2) / (1.0 + r_sq)\n        \n        # alpha_2 = (Lambda_1 + Lambda_2 * r^2) / (1 + r^2)\n        alpha_2 = (lambda_1 + lambda_2 * r_sq) / (1.0 + r_sq)\n        \n        # kappa = (Lambda_1 - Lambda_2) * r / (1 + r^2)\n        kappa = (lambda_1 - lambda_2) * r / (1.0 + r_sq)\n\n        results.append([alpha_1, alpha_2, kappa, gamma])\n\n    # Format the output string to match the problem specification exactly.\n    # The format is [[a1,a2,k,g],[a1,a2,k,g],...], with no spaces inside inner lists.\n    formatted_results = []\n    for res in results:\n        # Convert each float in the inner list to a string and join with commas.\n        # Enclose in square brackets.\n        formatted_results.append('[' + ','.join(map(str, res)) + ']')\n    \n    # Join the formatted inner lists with commas and enclose in outer square brackets.\n    final_output = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}