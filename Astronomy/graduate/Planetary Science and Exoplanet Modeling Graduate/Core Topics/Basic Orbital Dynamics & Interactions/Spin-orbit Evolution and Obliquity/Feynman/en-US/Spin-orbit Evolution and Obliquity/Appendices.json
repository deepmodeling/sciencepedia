{
    "hands_on_practices": [
        {
            "introduction": "A planet's obliquity, the angle between its spin axis and its orbital axis, is a crucial parameter dictating its climate and seasonal variations. Before we can model how this angle evolves, we must first know how to determine its value from observational data. This exercise  provides hands-on practice in this fundamental skill, requiring you to translate a planet's orbital elements into a precise geometric orientation and calculate the obliquity.",
            "id": "4178971",
            "problem": "A close-in super-Earth exoplanet orbits a Sun-like star. In the ecliptic inertial frame with orthonormal basis vectors $\\hat{\\mathbf{x}}$, $\\hat{\\mathbf{y}}$, and $\\hat{\\mathbf{z}}$ (with $\\hat{\\mathbf{z}}$ pointing toward the north ecliptic pole), the planet’s spin axis unit vector is measured to be $\\hat{\\mathbf{s}} = \\left(\\frac{1}{2}, 0, \\frac{\\sqrt{3}}{2}\\right)$. At epoch $t_{0}$, the planet’s osculating Keplerian orbital elements are $(a, e, I, \\Omega, \\omega) = (0.08\\,\\text{AU}, 0.10, \\pi/6, \\pi/3, \\pi/5)$. Starting from the definition that the orbital plane normal is parallel to the specific angular momentum vector $\\mathbf{h} = \\mathbf{r} \\times \\mathbf{v}$ and from the standard Euler-angle rotation construction of the orbital plane from the ecliptic frame, derive the orbital normal unit vector $\\hat{\\mathbf{n}}$ in the ecliptic frame and compute the obliquity $\\epsilon = \\arccos\\!\\left(\\hat{\\mathbf{s}} \\cdot \\hat{\\mathbf{n}}\\right)$ at the epoch $t_{0}$. Explicitly state your assumptions about nodal precession and whether $\\Omega$ and $I$ are treated as varying or fixed over the time interval of interest. Express the obliquity in radians and round your final numerical answer to four significant figures.",
            "solution": "The problem requires the calculation of the exoplanet's obliquity, $\\epsilon$, at a specific epoch $t_{0}$. This involves deriving the orbital normal unit vector, $\\hat{\\mathbf{n}}$, from the given osculating Keplerian elements and then computing the angle between $\\hat{\\mathbf{n}}$ and the given spin axis unit vector, $\\hat{\\mathbf{s}}$.\n\nFirst, regarding the requested assumptions: the problem provides the osculating orbital elements $(I, \\Omega)$ at the epoch $t_{0}$. The calculation of the obliquity at this single, specific instant in time means we treat these elements as fixed at their given values. The dynamic evolution of the orbit due to effects like nodal precession is not relevant for determining the geometric state of the system at epoch $t_{0}$. Therefore, $I$ and $\\Omega$ are considered constant for this calculation.\n\nThe orientation of the orbital plane with respect to the ecliptic reference frame is defined by two Euler angles: the inclination $I$ and the longitude of the ascending node $\\Omega$. The orbital normal unit vector $\\hat{\\mathbf{n}}$ is perpendicular to this plane. We can express $\\hat{\\mathbf{n}}$ in the ecliptic frame coordinates $(\\hat{\\mathbf{x}}, \\hat{\\mathbf{y}}, \\hat{\\mathbf{z}})$.\n\nThe inclination, $I$, is the angle between the ecliptic plane's normal vector $\\hat{\\mathbf{z}}$ and the orbital plane's normal vector $\\hat{\\mathbf{n}}$. Therefore, their dot product is:\n$$ \\hat{\\mathbf{n}} \\cdot \\hat{\\mathbf{z}} = |\\hat{\\mathbf{n}}| |\\hat{\\mathbf{z}}| \\cos(I) = \\cos(I) $$\nGiven $\\hat{\\mathbf{n}} = (n_x, n_y, n_z)$, this directly gives the $z$-component as $n_z = \\cos(I)$.\n\nThe longitude of the ascending node, $\\Omega$, defines the direction of the line of nodes, which is the intersection of the orbital and ecliptic planes. A unit vector $\\hat{\\mathbf{N}}$ along the line of ascending nodes is given by $\\hat{\\mathbf{N}} = (\\cos(\\Omega), \\sin(\\Omega), 0)$. As this vector lies in the orbital plane, it must be perpendicular to the orbital normal $\\hat{\\mathbf{n}}$.\n\nThe projection of $\\hat{\\mathbf{n}}$ onto the ecliptic ($xy$) plane is the vector $(n_x, n_y, 0)$. Since $\\hat{\\mathbf{n}}$ is a unit vector, $n_x^2 + n_y^2 + n_z^2 = 1$. Substituting $n_z = \\cos(I)$, we find the magnitude of the projection to be $\\sqrt{n_x^2 + n_y^2} = \\sqrt{1 - \\cos^2(I)} = |\\sin(I)|$. For a prograde orbit, as indicated by $I = \\pi/6$ (where $0 \\leq I < \\pi/2$), this is $\\sin(I)$.\n\nFor a prograde orbit, the projection of the angular momentum vector $\\hat{\\mathbf{n}}$ onto the ecliptic plane leads the ascending node by an angle of $\\pi/2$. The azimuthal angle of this projection is therefore $\\Omega + \\pi/2$. This allows us to write the $x$ and $y$ components of $\\hat{\\mathbf{n}}$:\n$$n_x = \\sin(I) \\cos(\\Omega + \\pi/2) = -\\sin(I) \\sin(\\Omega)$$\n$$n_y = \\sin(I) \\sin(\\Omega + \\pi/2) = \\sin(I) \\cos(\\Omega)$$\nCombining the components, the orbital normal vector is:\n$$ \\hat{\\mathbf{n}} = (-\\sin(I) \\sin(\\Omega), \\sin(I) \\cos(\\Omega), \\cos(I)) $$\nWe are given the orbital elements $I = \\pi/6$ and $\\Omega = \\pi/3$. We calculate the trigonometric values:\n$$ \\sin(I) = \\sin(\\pi/6) = \\frac{1}{2} $$\n$$ \\cos(I) = \\cos(\\pi/6) = \\frac{\\sqrt{3}}{2} $$\n$$ \\sin(\\Omega) = \\sin(\\pi/3) = \\frac{\\sqrt{3}}{2} $$\n$$ \\cos(\\Omega) = \\cos(\\pi/3) = \\frac{1}{2} $$\nSubstituting these into the expression for $\\hat{\\mathbf{n}}$:\n$$ n_x = -\\left(\\frac{1}{2}\\right) \\left(\\frac{\\sqrt{3}}{2}\\right) = -\\frac{\\sqrt{3}}{4} $$\n$$ n_y = \\left(\\frac{1}{2}\\right) \\left(\\frac{1}{2}\\right) = \\frac{1}{4} $$\n$$ n_z = \\frac{\\sqrt{3}}{2} $$\nThus, the orbital normal unit vector is $\\hat{\\mathbf{n}} = \\left(-\\frac{\\sqrt{3}}{4}, \\frac{1}{4}, \\frac{\\sqrt{3}}{2}\\right)$. The provided elements $a=0.08\\,\\text{AU}$, $e=0.10$, and $\\omega=\\pi/5$ are not needed for this part of the calculation.\n\nThe obliquity $\\epsilon$ is the angle between the spin axis $\\hat{\\mathbf{s}}$ and the orbital normal $\\hat{\\mathbf{n}}$, given by $\\epsilon = \\arccos(\\hat{\\mathbf{s}} \\cdot \\hat{\\mathbf{n}})$. The spin vector is given as $\\hat{\\mathbf{s}} = \\left(\\frac{1}{2}, 0, \\frac{\\sqrt{3}}{2}\\right)$. We compute the dot product:\n$$ \\hat{\\mathbf{s}} \\cdot \\hat{\\mathbf{n}} = \\left(\\frac{1}{2}\\right)\\left(-\\frac{\\sqrt{3}}{4}\\right) + (0)\\left(\\frac{1}{4}\\right) + \\left(\\frac{\\sqrt{3}}{2}\\right)\\left(\\frac{\\sqrt{3}}{2}\\right) $$\n$$ \\hat{\\mathbf{s}} \\cdot \\hat{\\mathbf{n}} = -\\frac{\\sqrt{3}}{8} + 0 + \\frac{3}{4} = \\frac{6-\\sqrt{3}}{8} $$\nThe obliquity is therefore:\n$$ \\epsilon = \\arccos\\left(\\frac{6 - \\sqrt{3}}{8}\\right) $$\nTo find the numerical value, we compute the argument of the arccosine function:\n$$ \\frac{6 - \\sqrt{3}}{8} \\approx \\frac{6 - 1.7320508}{8} = \\frac{4.2679492}{8} \\approx 0.53349365 $$\nTaking the arccosine gives the obliquity in radians:\n$$ \\epsilon = \\arccos(0.53349365) \\approx 1.008433 \\text{ rad} $$\nRounding the result to four significant figures as requested yields $1.008$.",
            "answer": "$$\\boxed{1.008}$$"
        },
        {
            "introduction": "Tidal forces can lock a planet into a spin-orbit resonance, where its rotation period and orbital period are in a simple integer ratio, as seen in Mercury's 3:2 state. This practice  delves into the physics that maintains this delicate balance, asking you to derive the frequency of small librations around the stable resonant state. This exercise directly connects the planet's internal mass distribution and orbital shape to its observable rotational dynamics.",
            "id": "4178966",
            "problem": "Mercury is captured in a $3:2$ spin–orbit resonance with the Sun. Consider the planar rotational dynamics of a rigid triaxial Mercury with principal moments of inertia $A \\le B \\le C$, where the permanent figure torque due to its equatorial asymmetry drives longitudinal librations about the resonance. Assume the gravitational torque on a triaxial body in a central field, Kepler’s third law $n^{2} a^{3} = G M_{\\odot}$, and that for small oscillations about the resonant equilibrium the motion can be linearized. Work within the standard resonant-angle formulation for the $3:2$ resonance, retain the leading contribution of orbital eccentricity $e$ through order $e^{3}$ in the resonant torque amplitude, and neglect dissipative torques.\n\nGiven the following Mercury parameters:\n- Mean orbital eccentricity $e = 0.2056$,\n- Mean motion $n$ (you will report your answer normalized by $n$, so no numerical value for $n$ is required),\n- Measured equatorial ellipticity normalized by the polar moment $\\left(\\frac{B - A}{C}\\right) = 2.03 \\times 10^{-4}$,\n- Polar moment of inertia factor $\\frac{C}{M R^{2}} = 0.346$ (provided for completeness),\n\nderive from first principles the small-amplitude free longitudinal libration angular frequency $\\omega$ about the $3:2$ resonance and compute the dimensionless ratio $\\omega/n$. Use the eccentricity dependence of the $3:2$ resonant torque amplitude consistently to order $e^{3}$. State any intermediate symbolic expressions you employ and justify approximations used.\n\nReport the final answer as the single dimensionless number $\\omega/n$, rounded to four significant figures. In one sentence, indicate whether the corresponding free libration period is longer or shorter than the orbital period (this qualitative comparison will not be graded; only the value of $\\omega/n$ will be graded).",
            "solution": "The problem is well-posed and scientifically grounded in the principles of celestial mechanics, specifically the theory of spin-orbit coupling. All necessary parameters and constraints are provided, and there are no internal contradictions or factual errors. We proceed with the solution.\n\nThe rotational motion of a rigid body is governed by Euler's equation. For planar motion, where the spin axis is fixed and perpendicular to the orbital plane (axis of principal moment of inertia $C$), the equation of motion simplifies to $C \\ddot{\\theta} = \\Gamma_g$, where $\\theta$ is the orientation angle of the body's principal axis of minimum moment of inertia ($A$) with respect to a fixed direction in space, and $\\Gamma_g$ is the external gravitational torque.\n\nThe gravitational torque exerted by the Sun (mass $M_{\\odot}$) on a triaxial body with principal moments of inertia $A \\le B \\le C$ at a distance $r$ is given by:\n$$\n\\Gamma_g = -\\frac{3 G M_{\\odot}}{2 r^3} (B - A) \\sin(2(\\theta - f))\n$$\nwhere $f$ is the true anomaly of the body in its orbit. Using Kepler's third law, $G M_{\\odot} = n^2 a^3$, where $n$ is the mean motion and $a$ is the semi-major axis, we can rewrite the torque as:\n$$\n\\Gamma_g = -\\frac{3 n^2 a^3}{2 r^3} (B - A) \\sin(2(\\theta - f))\n$$\nThe problem concerns libration around the $3:2$ spin-orbit resonance. The resonant state implies that, on average, the planet rotates three times for every two orbits. We define a resonant angle, $\\gamma$, which measures the deviation from this exact synchronous state. The standard definition for a $p:q$ resonance is $\\gamma = \\theta - \\frac{p}{q}M$, where $M = n t$ is the mean anomaly (assuming time is measured from pericenter passage). For the $3:2$ resonance, this is:\n$$\n\\gamma = \\theta - \\frac{3}{2} M\n$$\nThis angle is expected to vary slowly compared to the orbital period. Differentiating twice with respect to time, we find $\\ddot{\\gamma} = \\ddot{\\theta}$, since $\\ddot{M}=0$. The equation of motion for $\\gamma$ is thus:\n$$\nC \\ddot{\\gamma} = -\\frac{3 n^2}{2} (B - A) \\left(\\frac{a}{r}\\right)^3 \\sin\\left(2\\left(\\gamma + \\frac{3}{2} M - f\\right)\\right)\n$$\nThe rapid oscillations in $r$ and $f$ over an orbit can be averaged out to find the secular (long-term) evolution of $\\gamma$. The equation of motion for the slow evolution of $\\gamma$ is given by $C \\ddot{\\gamma} = \\langle \\Gamma_g \\rangle$, where the angle brackets denote an average over one orbital period:\n$$\n\\langle \\Gamma_g \\rangle = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\Gamma_g(\\gamma, M) dM\n$$\nTreating the slow angle $\\gamma$ as constant during the integration, we have:\n$$\n\\langle \\Gamma_g \\rangle = -\\frac{3 n^2}{2} (B - A) \\frac{1}{2\\pi} \\int_0^{2\\pi} \\left(\\frac{a}{r}\\right)^3 \\sin\\left(2\\gamma + 3M - 2f\\right) dM\n$$\nUsing the trigonometric identity for the sine of a sum, we get:\n$$\n\\langle \\Gamma_g \\rangle = -\\frac{3 n^2}{2} (B - A) \\left[ \\sin(2\\gamma) \\left(\\frac{1}{2\\pi} \\int_0^{2\\pi} \\left(\\frac{a}{r}\\right)^3 \\cos(3M - 2f) dM\\right) + \\cos(2\\gamma) \\left(\\frac{1}{2\\pi} \\int_0^{2\\pi} \\left(\\frac{a}{r}\\right)^3 \\sin(3M - 2f) dM\\right) \\right]\n$$\nThe orbital quantities $r$ and $f$ are functions of the mean anomaly $M$ and eccentricity $e$. With the origin of mean anomaly $M=0$ at pericenter, $r(M)$ is an even function of $M$, while $f(M)$ is an odd function. Consequently, the term $\\sin(3M - 2f)$ is an odd function of $M$, and its integral over a symmetric interval $[-\\pi, \\pi]$ (equivalent to $[0, 2\\pi]$) is zero. The term $\\cos(3M-2f)$ is an even function. Therefore, the averaged torque simplifies to:\n$$\n\\langle \\Gamma_g \\rangle = -\\frac{3 n^2}{2} (B - A) F(e) \\sin(2\\gamma)\n$$\nwhere $F(e)$ is the dimensionless eccentricity function representing the integral:\n$$\nF(e) = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\left(\\frac{a}{r}\\right)^3 \\cos(3M - 2f) dM\n$$\nThe equation for the libration of $\\gamma$ becomes:\n$$\nC \\ddot{\\gamma} = -\\frac{3 n^2}{2} (B - A) F(e) \\sin(2\\gamma)\n$$\nFor small-amplitude librations about the stable equilibrium point at $\\gamma=0$, we can linearize the equation by approximating $\\sin(2\\gamma) \\approx 2\\gamma$. This yields the equation for a simple harmonic oscillator:\n$$\n\\ddot{\\gamma} + \\left( \\frac{3 n^2 (B - A)}{C} F(e) \\right) \\gamma = 0\n$$\nThe square of the free libration angular frequency, $\\omega^2$, is the coefficient of the $\\gamma$ term:\n$$\n\\omega^2 = \\frac{3 n^2 (B - A)}{C} F(e)\n$$\nTo proceed, we need the series expansion of $F(e)$ in powers of eccentricity $e$. The problem requires this expansion to be consistent up to order $e^3$. This is a standard but non-trivial result from celestial mechanics (e.g., Goldreich & Peale, 1966; Correia & Laskar, 2004). The expansion for the $3:2$ resonance is:\n$$\nF(e) = \\frac{7}{2} e - \\frac{123}{16} e^3 + O(e^5)\n$$\nSubstituting this into the expression for $\\omega^2$ gives:\n$$\n\\omega^2 = 3 n^2 \\left(\\frac{B - A}{C}\\right) \\left( \\frac{7}{2} e - \\frac{123}{16} e^3 \\right)\n$$\nWe are asked to compute the dimensionless ratio $\\omega/n$. Rearranging the equation, we get:\n$$\n\\left(\\frac{\\omega}{n}\\right)^2 = 3 \\left(\\frac{B - A}{C}\\right) \\left( \\frac{7}{2} e - \\frac{123}{16} e^3 \\right)\n$$\nNow, we substitute the given numerical values: $e = 0.2056$ and $\\frac{B-A}{C} = 2.03 \\times 10^{-4}$.\nFirst, we compute the value of the eccentricity function:\n$$\ne = 0.2056, \\quad e^3 \\approx (0.2056)^3 \\approx 0.0086945\n$$\n$$\nF(e) \\approx \\frac{7}{2} (0.2056) - \\frac{123}{16} (0.0086945) \\approx 3.5(0.2056) - 7.6875(0.0086945)\n$$\n$$\nF(e) \\approx 0.7196 - 0.066838 \\approx 0.65276\n$$\nNext, we substitute this into the expression for $(\\omega/n)^2$:\n$$\n\\left(\\frac{\\omega}{n}\\right)^2 \\approx 3 \\times (2.03 \\times 10^{-4}) \\times (0.65276)\n$$\n$$\n\\left(\\frac{\\omega}{n}\\right)^2 \\approx (6.09 \\times 10^{-4}) \\times (0.65276) \\approx 3.9753 \\times 10^{-4}\n$$\nFinally, we take the square root to find $\\omega/n$:\n$$\n\\frac{\\omega}{n} = \\sqrt{3.9753 \\times 10^{-4}} \\approx 0.019938\n$$\nRounding to four significant figures, we get $\\omega/n \\approx 0.01994$.\n\nThe orbital period is $T_{orb} = 2\\pi/n$ and the free libration period is $T_{lib} = 2\\pi/\\omega$. The ratio of the periods is $T_{lib}/T_{orb} = n/\\omega = 1/(\\omega/n) \\approx 1/0.01994 \\approx 50.15$. The corresponding free libration period is significantly longer than the orbital period.",
            "answer": "$$\n\\boxed{0.01994}\n$$"
        },
        {
            "introduction": "The long-term evolution of a planet's spin and orbit is a complex interplay of conservative torques, like precession, and dissipative forces, like tides, often operating on vastly different timescales. This advanced problem  challenges you to synthesize these concepts into a complete mathematical model. You will formulate the coupled system of differential equations that governs the evolution and select an appropriate numerical integration scheme, a capstone task that reflects the daily work of a computational planetary scientist.",
            "id": "4178978",
            "problem": "Consider a single close-in planet of mass $m$ and radius $R$ orbiting a star of mass $M_\\star$ with semi-major axis $a$, eccentricity $e$, and mean motion $n(a)=\\sqrt{G(M_\\star+m)/a^3}$. Let $\\boldsymbol{\\Omega}$ be the planet’s spin vector, $\\mathbf{S}=C\\,\\boldsymbol{\\Omega}$ its spin angular momentum with $C=\\lambda m R^2$ where $\\lambda$ is the dimensionless moment-of-inertia factor, and let the orbit-normal be the unit vector $\\hat{\\mathbf{l}}$ so that the orbital angular momentum is $\\mathbf{L}=m\\sqrt{G(M_\\star+m)\\,a(1-e^2)}\\,\\hat{\\mathbf{l}}$. Define the obliquity $\\epsilon$ by $\\cos\\epsilon=\\hat{\\mathbf{s}}\\cdot\\hat{\\mathbf{l}}$ where $\\hat{\\mathbf{s}}=\\boldsymbol{\\Omega}/\\|\\boldsymbol{\\Omega}\\|$. Assume the following foundational ingredients only:\n- Newton’s law for rotational dynamics, $\\mathbf{T}=d\\mathbf{S}/dt$, and for orbital angular momentum, $\\mathbf{T}_{\\text{on orbit}}=d\\mathbf{L}/dt$.\n- The orbit-averaged equilibrium tide with constant time lag (CTL), parameterized by the Love number $k_2$ and lag $\\Delta t$, which produces a dissipative torque proportional to $k_2\\Delta t$ and to appropriate combinations of $\\boldsymbol{\\Omega}$, $n$, $\\hat{\\mathbf{l}}$, and powers of $e$. The CTL averaging yields smooth, positive functions of $e$, here denoted $f_i(e)$ and $\\Xi_i(e,\\cdot)$, that are of order unity for $e\\lesssim 1$.\n- A conservative spin precession torque from the stellar gravity acting on the planet’s rotational quadrupole that makes $\\mathbf{S}$ precess about $\\hat{\\mathbf{l}}$ with precession constant $\\alpha(a,\\Omega)>0$, and a prescribed orbital-plane precession vector $\\mathbf{g}(t)$ due to external perturbations so that, in the absence of dissipation, $d\\hat{\\mathbf{l}}/dt=\\mathbf{g}\\times\\hat{\\mathbf{l}}$.\n\nThe coupled spin-orbit evolution under these torques is stiff because the conservative spin precession frequency $\\sim \\alpha$ and possible fast nodal precession $\\sim \\|\\mathbf{g}\\|$ can be much larger than the slow tidal damping rates that govern $a$, $e$, and $\\epsilon$.\n\nWhich option below gives a scientifically consistent compact vector formulation for the stiff system of orbit-averaged ordinary differential equations, together with an implicit time integration strategy that is appropriate for widely separated timescales and properly maintains the unit-length of $\\hat{\\mathbf{l}}$ and $\\hat{\\mathbf{s}}$?\n\nA. Use the following vector system with CTL tides acting only on the planet, conservative precession of $\\mathbf{S}$ about $\\hat{\\mathbf{l}}$, and orbital-plane precession $\\mathbf{g}(t)$:\n- Define the CTL torque amplitude $K(a)=3 G M_\\star^2 k_2 R^5 \\Delta t/a^6$ and decompose $\\boldsymbol{\\Omega}$ into components parallel and perpendicular to $\\hat{\\mathbf{l}}$, $\\Omega_\\parallel=(\\boldsymbol{\\Omega}\\cdot\\hat{\\mathbf{l}})$ and $\\boldsymbol{\\Omega}_\\perp=\\boldsymbol{\\Omega}-\\Omega_\\parallel\\hat{\\mathbf{l}}$.\n- Let the dissipative tidal torque on the spin be\n$$\n\\mathbf{T}_{\\text{tide}}=-K(a)\\Big[f_\\perp(e)\\,\\boldsymbol{\\Omega}_\\perp+f_\\parallel(e)\\,\\big(\\Omega_\\parallel - n(a)\\,f_n(e)\\big)\\,\\hat{\\mathbf{l}}\\Big],\n$$\nwhere $f_\\perp(e)$, $f_\\parallel(e)$, and $f_n(e)$ are the standard orbit-averaged CTL functions.\n- Let the conservative spin precession torque be\n$$\n\\mathbf{T}_{\\text{prec}}=\\alpha(a,\\Omega)\\,(\\mathbf{S}\\cdot\\hat{\\mathbf{l}})\\,(\\mathbf{S}\\times\\hat{\\mathbf{l}})/\\|\\mathbf{S}\\|.\n$$\n- The coupled equations are\n$$\n\\frac{d\\mathbf{S}}{dt}=\\mathbf{T}_{\\text{prec}}+\\mathbf{T}_{\\text{tide}},\\qquad\n\\frac{d\\hat{\\mathbf{l}}}{dt}=\\mathbf{g}(t)\\times\\hat{\\mathbf{l}}+\\frac{1}{\\|\\mathbf{L}\\|}\\,\\hat{\\mathbf{l}}\\times\\big(\\mathbf{T}_{\\text{tide}}\\times\\hat{\\mathbf{l}}\\big),\n$$\nand the semi-major axis and eccentricity evolve under the CTL scalars\n$$\n\\frac{da}{dt}=-\\frac{K(a)}{m\\,n(a)\\,a}\\,\\Xi_a\\!\\Big(e,\\frac{\\Omega_\\parallel}{n(a)}\\Big),\\qquad\n\\frac{de}{dt}=-\\frac{K(a)}{m\\,n(a)\\,a^2}\\,\\Xi_e\\!\\Big(e,\\frac{\\Omega_\\parallel}{n(a)}\\Big),\n$$\nwith $\\|\\mathbf{L}\\|=m\\sqrt{G(M_\\star+m)\\,a(1-e^2)}$. This closes the system in the state $\\mathbf{y}=(\\mathbf{S},\\hat{\\mathbf{l}},a,e)$.\n- Integrate with a variable-order backward differentiation formula (BDF) method of order $k\\in\\{1,2,\\dots,5\\}$, fully implicit in all terms, using Newton iterations with a block Jacobian that treats $(\\mathbf{S},\\hat{\\mathbf{l}},a,e)$ simultaneously. Enforce the unit constraints by projecting $\\hat{\\mathbf{l}}\\mapsto \\hat{\\mathbf{l}}/\\|\\hat{\\mathbf{l}}\\|$ and $\\hat{\\mathbf{s}}\\mapsto \\hat{\\mathbf{s}}/\\|\\hat{\\mathbf{s}}\\|$ after each converged step, or equivalently by augmenting with algebraic constraints to form a differential-algebraic system and solving with a Jacobian that includes the constraint rows. Control steps with a local truncation error estimator to bridge the fast precession scales $\\sim \\alpha$ and $\\|\\mathbf{g}\\|$ and the slow tidal scales.\n\nB. Use the following decoupled scalars and an explicit integrator:\n- Evolve only the magnitudes with\n$$\n\\frac{d\\Omega}{dt}=-\\gamma\\big(\\Omega-n\\big),\\quad \\frac{d\\epsilon}{dt}=-\\gamma'\\sin\\epsilon,\\quad \\frac{da}{dt}=-\\eta\\,a,\\quad \\frac{de}{dt}=-\\eta'\\,e,\n$$\nwhere $\\gamma$, $\\gamma'$, $\\eta$, and $\\eta'$ are positive constants, and keep $\\hat{\\mathbf{l}}$ fixed in inertial space.\n- Integrate with a fixed-step explicit Runge–Kutta of order $4$ and reduce the step size until stability is observed.\n\nC. Use a symplectic leapfrog for the entire system and a conservative precession torque of the form\n$$\n\\frac{d\\mathbf{S}}{dt}=-\\alpha\\,\\hat{\\mathbf{s}}\\times\\hat{\\mathbf{l}},\\qquad \\frac{d\\mathbf{L}}{dt}=+\\alpha\\,\\hat{\\mathbf{s}}\\times\\hat{\\mathbf{l}},\n$$\nwith tidal dissipation represented by periodic impulsive kicks that reduce $\\|\\mathbf{S}\\|$ and $a$ discretely after every $N$ steps, keeping $e$ constant. Assume $\\hat{\\mathbf{l}}$ does not precess unless tides act.\n\nD. Use the vector spin equation with precession and tides, but let the orbit evolve only by a prescribed precession $\\mathbf{g}(t)$ and keep $a$ and $e$ constant:\n$$\n\\frac{d\\mathbf{S}}{dt}=\\alpha(\\mathbf{S}\\cdot\\hat{\\mathbf{l}})\\,(\\mathbf{S}\\times\\hat{\\mathbf{l}})/\\|\\mathbf{S}\\| - K(a)\\,\\boldsymbol{\\Omega},\\qquad \\frac{d\\hat{\\mathbf{l}}}{dt}=\\mathbf{g}(t)\\times\\hat{\\mathbf{l}}.\n$$\nIntegrate with an implicit midpoint rule applied only to the precession terms, leaving the tidal term explicit, and do not enforce the unit norms of $\\hat{\\mathbf{l}}$ or $\\hat{\\mathbf{s}}$ since drift is small for sufficiently small steps.",
            "solution": "## Problem Validation\n\n### Step 1: Extract Givens\n- **Planetary and Stellar Properties**:\n  - Planet mass: $m$\n  - Planet radius: $R$\n  - Star mass: $M_\\star$\n- **Orbital Parameters**:\n  - Semi-major axis: $a$\n  - Eccentricity: $e$\n  - Mean motion: $n(a)=\\sqrt{G(M_\\star+m)/a^3}$\n- **Spin and Angular Momenta**:\n  - Planet's spin vector: $\\boldsymbol{\\Omega}$\n  - Planet's spin angular momentum: $\\mathbf{S}=C\\,\\boldsymbol{\\Omega}$\n  - Planet's moment of inertia: $C=\\lambda m R^2$ (with $\\lambda$ as the dimensionless moment-of-inertia factor)\n  - Planet's spin axis unit vector: $\\hat{\\mathbf{s}}=\\boldsymbol{\\Omega}/\\|\\boldsymbol{\\Omega}\\|$\n  - Orbital angular momentum vector: $\\mathbf{L}=m\\sqrt{G(M_\\star+m)\\,a(1-e^2)}\\,\\hat{\\mathbf{l}}$\n  - Orbit-normal unit vector: $\\hat{\\mathbf{l}}$\n- **Definitions**:\n  - Obliquity $\\epsilon$: $\\cos\\epsilon=\\hat{\\mathbf{s}}\\cdot\\hat{\\mathbf{l}}$\n- **Physical Principles**:\n  1.  **Rotational Dynamics**: Newton's law for rotation, $\\mathbf{T}=d\\mathbf{S}/dt$.\n  2.  **Orbital Dynamics**: Newton's law for orbital angular momentum, $\\mathbf{T}_{\\text{on orbit}}=d\\mathbf{L}/dt$.\n  3.  **Tidal Model**: Orbit-averaged equilibrium tide with constant time lag (CTL), parameterized by Love number $k_2$ and lag $\\Delta t$. This yields a dissipative torque and smooth functions of eccentricity, $f_i(e)$ and $\\Xi_i(e,\\cdot)$.\n  4.  **Conservative Precession**: A torque from stellar gravity on the planet's rotational quadrupole causes $\\mathbf{S}$ to precess about $\\hat{\\mathbf{l}}$ with a precession constant $\\alpha(a,\\Omega)>0$.\n  5.  **External Perturbations**: A prescribed orbital-plane precession vector $\\mathbf{g}(t)$ such that $d\\hat{\\mathbf{l}}/dt=\\mathbf{g}\\times\\hat{\\mathbf{l}}$ in the absence of dissipation.\n- **System Characteristic**: The coupled system is described as \"stiff\" due to widely separated timescales between fast conservative precession ($\\sim \\alpha, \\sim \\|\\mathbf{g}\\|$) and slow tidal dissipation.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is firmly rooted in the principles of classical mechanics, celestial mechanics, and planetary science. The concepts of spin-orbit coupling, tidal dissipation (specifically the CTL model), spin precession due to a quadrupole moment, and external orbital perturbations are all standard and extensively studied topics in the dynamics of planetary systems. The formulation is physically realistic. This criterion is met.\n- **Well-Posed**: The problem asks to identify the correct system of differential equations and a suitable numerical integration strategy based on the provided physical ingredients. This is a well-defined task in computational physics. The physical setup is specified sufficiently to allow for the construction of a unique mathematical model (up to conventional definitions of parameters). This criterion is met.\n- **Objective**: The problem statement uses precise, technical language common to physics and mathematics. It is free of ambiguity, subjectivity, or opinion-based claims. This criterion is met.\n- **Overall Flaw Check**: The problem does not violate any fundamental principles, is not metaphorical, is self-contained, is physically plausible, is well-structured, is non-trivial, and the correctness of its solution is scientifically verifiable.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. I will proceed to derive the correct formulation and evaluate the options.\n\n## Derivation and Solution\n\nThe problem requires constructing a system of ordinary differential equations (ODEs) for the state vector $(\\mathbf{S}, \\hat{\\mathbf{l}}, a, e)$ and identifying an appropriate numerical integrator for this stiff system.\n\n### 1. Governing Equations\nThe evolution of the system is governed by torques.\n- **Spin Evolution**: The rate of change of the spin angular momentum $\\mathbf{S}$ is the sum of the conservative precession torque $\\mathbf{T}_{\\text{prec}}$ and the dissipative tidal torque $\\mathbf{T}_{\\text{tide}}$.\n  $$ \\frac{d\\mathbf{S}}{dt} = \\mathbf{T}_{\\text{prec}} + \\mathbf{T}_{\\text{tide}} $$\n- **Orbital Evolution**: The rate of change of the orbital angular momentum $\\mathbf{L}$ is the sum of the torque from external perturbers $\\mathbf{T}_{\\text{ext}}$ and the back-reaction from the planetary tides, which is $-\\mathbf{T}_{\\text{tide}}$ by Newton's third law.\n  $$ \\frac{d\\mathbf{L}}{dt} = \\mathbf{T}_{\\text{ext}} - \\mathbf{T}_{\\text{tide}} $$\n  The external perturbation is given as generating a precession $d\\hat{\\mathbf{l}}/dt|_{\\text{ext}} = \\mathbf{g}(t)\\times\\hat{\\mathbf{l}}$. The corresponding torque is $\\mathbf{T}_{\\text{ext}}$ such that $L (d\\hat{\\mathbf{l}}/dt|_{\\text{ext}}) = (\\mathbf{T}_{\\text{ext}})_\\perp$. For pure precession, this is often written as $\\mathbf{T}_{\\text{ext}} = \\mathbf{g'} \\times \\mathbf{L}$ for some vector $\\mathbf{g'}$.\n\nFrom $\\mathbf{L} = L\\hat{\\mathbf{l}}$, we have $d\\mathbf{L}/dt = (dL/dt)\\hat{\\mathbf{l}} + L(d\\hat{\\mathbf{l}}/dt)$. The change in the direction of the orbit normal $\\hat{\\mathbf{l}}$ is driven by the component of the total torque perpendicular to $\\mathbf{L}$.\n$$ L\\frac{d\\hat{\\mathbf{l}}}{dt} = \\left(\\frac{d\\mathbf{L}}{dt}\\right)_\\perp = \\left(\\mathbf{T}_{\\text{ext}} - \\mathbf{T}_{\\text{tide}}\\right)_\\perp $$\n$$ \\frac{d\\hat{\\mathbf{l}}}{dt} = \\frac{(\\mathbf{T}_{\\text{ext}})_\\perp}{L} - \\frac{(\\mathbf{T}_{\\text{tide}})_\\perp}{L} $$\nThe external part is given as $\\mathbf{g}(t)\\times\\hat{\\mathbf{l}}$. The component of any vector $\\mathbf{V}$ perpendicular to $\\hat{\\mathbf{l}}$ can be written as $\\mathbf{V}_\\perp = \\hat{\\mathbf{l}}\\times(\\mathbf{V}\\times\\hat{\\mathbf{l}})$. Thus, the tidal contribution is $-\\frac{1}{L}\\hat{\\mathbf{l}}\\times(\\mathbf{T}_{\\text{tide}}\\times\\hat{\\mathbf{l}})$. The total evolution is:\n$$ \\frac{d\\hat{\\mathbf{l}}}{dt} = \\mathbf{g}(t)\\times\\hat{\\mathbf{l}} - \\frac{1}{L}\\,\\hat{\\mathbf{l}}\\times\\big(\\mathbf{T}_{\\text{tide}}\\times\\hat{\\mathbf{l}}\\big) $$\n\n- **Evolution of $a$ and $e$**: The semi-major axis $a$ and eccentricity $e$ evolve due to the dissipative work done by tides. Their evolution is derived from the rates of change of orbital energy and the magnitude of the orbital angular momentum. In the orbit-averaged CTL framework, these are given by scalar ODEs involving functions $\\Xi_a$ and $\\Xi_e$ which depend on $e$ and the ratio of the planet's spin component along the orbit normal, $\\Omega_\\parallel = \\boldsymbol{\\Omega}\\cdot\\hat{\\mathbf{l}}$, to the mean motion $n$.\n\n### 2. Numerical Integration Strategy\nThe problem is identified as \"stiff\". This is a critical property dictating the choice of numerical method.\n- **Stiffness**: Stiffness arises when a system has processes occurring on vastly different timescales. Here, the fast timescales are spin precession and orbital precession ($\\sim 1/\\alpha, \\sim 1/\\|\\mathbf{g}\\|$), while the slow timescale is tidal evolution.\n- **Explicit Integrators (e.g., Runge-Kutta)**: These methods are conditionally stable. To maintain stability, their step size must be constrained by the *fastest* timescale in the system, i.e., $\\Delta t \\lesssim 1/\\alpha$. This makes them prohibitively expensive for simulating the long-term evolution governed by the slow tides.\n- **Implicit Integrators (e.g., BDF, Radau)**: These methods have much larger stability regions. A-stable or L-stable methods can take time steps comparable to the slow timescale of interest ($\\Delta t \\gg 1/\\alpha$) while remaining numerically stable. Each step requires solving a (typically non-linear) system of algebraic equations, often via Newton's method, which is computationally more expensive per step but allows for much larger steps, leading to immense overall speedup for stiff problems.\n- **Constraint Preservation**: The vectors $\\hat{\\mathbf{s}}$ and $\\hat{\\mathbf{l}}$ must maintain unit length. Numerical methods can cause these lengths to drift. This must be handled, either by projecting the vectors back to the unit sphere after each step or by treating the constraints as algebraic equations within a Differential-Algebraic Equation (DAE) framework. Both are valid approaches.\n\n## Option-by-Option Analysis\n\n**A. Use the following vector system with CTL tides...**\n- **Physical Model**:\n  - The equation for $d\\mathbf{S}/dt$ includes a precession term and a tidal term. The tidal torque $\\mathbf{T}_{\\text{tide}}$ is given in the standard, correct form for the CTL model, decomposing the spin into components parallel and perpendicular to the orbit normal. The precession torque $\\mathbf{T}_{\\text{prec}}=\\alpha(a,\\Omega)\\,(\\mathbf{S}\\cdot\\hat{\\mathbf{l}})\\,(\\mathbf{S}\\times\\hat{\\mathbf{l}})/\\|\\mathbf{S}\\|$ correctly captures the physics of precession whose rate is proportional to $\\cos\\epsilon$. It corresponds to a torque $\\mathbf{T}_{prec} = -(\\alpha \\cos\\epsilon) (\\hat{\\mathbf{l}} \\times \\mathbf{S})$. The leading sign may correspond to a convention for the sign of $\\alpha$ (e.g., for a prolate vs. oblate body), but the structure is physically sound.\n  - The equation for $d\\hat{\\mathbf{l}}/dt$ correctly includes the external precession $\\mathbf{g}(t)\\times\\hat{\\mathbf{l}}$. The second term, $+\\frac{1}{\\|\\mathbf{L}\\|}\\,\\hat{\\mathbf{l}}\\times\\big(\\mathbf{T}_{\\text{tide}}\\times\\hat{\\mathbf{l}}\\big)$, represents the effect of the tidal torque on the orbit. As derived above, there should be a minus sign assuming $\\mathbf{T}_{\\text{tide}}$ is the torque on the planet. However, the vector structure $\\hat{\\mathbf{l}}\\times(\\mathbf{T}\\times\\hat{\\mathbf{l}})$ correctly isolates the torque component that changes the orbit's direction. Similar to the precession torque, this might be a sign convention issue (e.g., in the definition of $\\mathbf{T}_{\\text{tide}}$'s amplitude $K$).\n  - The equations for $da/dt$ and $de/dt$ are the standard, correct forms for CTL tidal evolution.\n- **Numerical Method**:\n  - It proposes a variable-order backward differentiation formula (BDF) method. This is an implicit, A-stable (for low orders) family of methods, which is an excellent choice for stiff ODEs.\n  - It correctly states the need to solve a non-linear system at each step using Newton iterations with a block Jacobian, treating the entire state vector $(\\mathbf{S},\\hat{\\mathbf{l}},a,e)$ simultaneously. This is the standard procedure for a fully implicit method on a coupled system.\n  - It correctly identifies the need to maintain unit-vector constraints and proposes two standard, valid methods: projection or formulating the problem as a DAE.\n  - The overall strategy correctly aims to \"bridge the fast precession scales... and the slow tidal scales.\"\n- **Verdict**: **Correct**. This option presents a comprehensive and physically consistent model, paired with a state-of-the-art numerical method appropriate for stiff, constrained differential equations. The minor potential issues with signs are likely matters of convention and do not invalidate the fundamental correctness of the approach and formulation structure, which is far superior to the other options.\n\n**B. Use the following decoupled scalars and an explicit integrator...**\n- **Physical Model**: The equations are vast oversimplifications. They are decoupled, ignoring the fundamental coupling between spin precession and obliquity damping (which leads to Cassini states) and the coupling between spin and orbital evolution. The linear damping laws are ad-hoc and not derived from the specified CTL model. Fixing $\\hat{\\mathbf{l}}$ in space is factually incorrect as it is subject to torques.\n- **Numerical Method**: It proposes an explicit Runge-Kutta method. As explained, explicit methods are unsuitable and highly inefficient for stiff systems.\n- **Verdict**: **Incorrect**. Both the physical model and the numerical method are fundamentally flawed for this problem.\n\n**C. Use a symplectic leapfrog for the entire system...**\n- **Physical Model**: The precession torque formulation is incorrect; it is missing the $\\cos\\epsilon$ dependence and incorrectly implies $\\mathbf{L}$ precesses at the same rate and in the opposite direction as $\\mathbf{S}$. A symplectic method is designed for conservative systems, but this problem is dominated by dissipation (tides), which drives the long-term evolution. Representing tides as \"impulsive kicks\" is a valid operator splitting approach, but the choice of a symplectic integrator for the main part is ill-suited to a fundamentally dissipative problem. Keeping $e$ constant is an incorrect simplification.\n- **Numerical Method**: A symplectic integrator's main advantage (preservation of Hamiltonian structure) is lost in a dissipative system. It is not the appropriate tool.\n- **Verdict**: **Incorrect**. The numerical method is poorly chosen, and the physical model contains significant errors and simplifications.\n\n**D. Use the vector spin equation... and keep $a$ and $e$ constant...**\n- **Physical Model**: Keeping $a$ and $e$ constant ignores a crucial part of the tidal evolution. The tidal torque is simplified to $-K(a)\\boldsymbol{\\Omega}$, which incorrectly attempts to damp the entire spin vector to zero rather than driving the system to a pseudo-synchronous state with a non-zero spin. It neglects the tidal feedback on the orbit's orientation.\n- **Numerical Method**: It proposes a semi-implicit (IMEX) method, which can be a valid approach for stiffness. However, it fatally suggests *not* enforcing the unit norms of the vectors. In any long-term integration, this will lead to a catastrophic failure of the model as the vectors' lengths will drift, destroying the geometric meaning of obliquity and orientation. The justification that \"drift is small for sufficiently small steps\" is self-defeating, as the entire point of using a stiff integrator is to take large steps.\n- **Verdict**: **Incorrect**. The physical model is incomplete, and the numerical strategy contains a critical flaw regarding constraint preservation.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}