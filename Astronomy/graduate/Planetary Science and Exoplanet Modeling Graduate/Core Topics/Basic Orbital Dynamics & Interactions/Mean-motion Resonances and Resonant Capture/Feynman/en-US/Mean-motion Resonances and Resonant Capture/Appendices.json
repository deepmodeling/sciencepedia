{
    "hands_on_practices": [
        {
            "introduction": "This first practice lays the groundwork for all studies of mean-motion resonance. Before delving into complex dynamics, we must first answer the fundamental question: where are resonances located? This exercise will guide you through a first-principles derivation of the positions of mean-motion resonances, showing how they arise directly from the kinematic relationship described by Kepler's Third Law. ",
            "id": "4167334",
            "problem": "A star of mass $M_{\\odot}$ hosts a single planet on a nearly circular, coplanar orbit with semi-major axis $a_{2}=5\\,\\mathrm{au}$. Consider a massless test particle on an interior, nearly circular, coplanar orbit. A mean-motion resonance of order $p:q$ between the test particle and the planet occurs when the ratio of their mean motions satisfies $n_{1}/n_{2}=p/q$, where $n=\\sqrt{G M_{\\star}/a^{3}}$ for a Keplerian orbit of semi-major axis $a$ around a star of mass $M_{\\star}$ and $G$ is the gravitational constant. \n\nStarting only from the definition of mean motion $n=\\sqrt{G M_{\\star}/a^{3}}$ and the resonance condition $n_{1}/n_{2}=p/q$, derive an expression for the interior resonance location $a_{1}$ in terms of $a_{2}$, $p$, and $q$, and explain why the result is independent of $M_{\\star}$ under the stated assumptions. Then, evaluate this expression for the interior $2:1$ resonance ($p=2$, $q=1$) with the given $a_{2}=5\\,\\mathrm{au}$. \n\nExpress your final result for $a_{1}$ in astronomical units and round your answer to four significant figures.",
            "solution": "The problem is well-posed and scientifically grounded, providing a clear basis for derivation and calculation within the established principles of celestial mechanics.\n\nThe problem asks for an expression for the semi-major axis $a_{1}$ of a massless test particle in a mean-motion resonance with a planet of semi-major axis $a_{2}$. The resonance is of order $p:q$. We are given the definition of mean motion, $n$, for a Keplerian orbit around a star of mass $M_{\\star}$:\n$$n = \\sqrt{\\frac{G M_{\\star}}{a^{3}}}$$\nwhere $a$ is the semi-major axis and $G$ is the gravitational constant.\n\nLet the test particle and the planet be denoted by subscripts $1$ and $2$, respectively. Their mean motions are:\n$$n_{1} = \\sqrt{\\frac{G M_{\\star}}{a_{1}^{3}}}$$\n$$n_{2} = \\sqrt{\\frac{G M_{\\star}}{a_{2}^{3}}}$$\n\nThe condition for a mean-motion resonance is given as the ratio of their mean motions:\n$$\\frac{n_{1}}{n_{2}} = \\frac{p}{q}$$\n\nWe substitute the expressions for $n_{1}$ and $n_{2}$ into the resonance condition:\n$$\\frac{\\sqrt{\\frac{G M_{\\star}}{a_{1}^{3}}}}{\\sqrt{\\frac{G M_{\\star}}{a_{2}^{3}}}} = \\frac{p}{q}$$\n\nThe term $\\sqrt{G M_{\\star}}$ appears in both the numerator and the denominator, allowing it to be canceled out:\n$$\\sqrt{\\frac{1/a_{1}^{3}}{1/a_{2}^{3}}} = \\frac{p}{q}$$\n$$\\sqrt{\\frac{a_{2}^{3}}{a_{1}^{3}}} = \\frac{p}{q}$$\n\nThis step demonstrates why the location of the resonance is independent of the stellar mass $M_{\\star}$ (and the gravitational constant $G$). The ratio of the mean motions depends only on the ratio of the semi-major axes, as the dependency on the central mass is identical for both bodies and thus cancels out in the ratio. This is a direct consequence of Kepler's Third Law, where the ratio of the squares of the orbital periods (and thus the inverse ratio of the squares of mean motions) depends only on the ratio of the cubes of the semi-major axes.\n\nTo solve for $a_{1}$, we continue the algebraic manipulation. First, we can rewrite the left side of the equation:\n$$\\left(\\frac{a_{2}}{a_{1}}\\right)^{3/2} = \\frac{p}{q}$$\n\nTo isolate the ratio $a_{2}/a_{1}$, we raise both sides to the power of $2/3$:\n$$\\left(\\left(\\frac{a_{2}}{a_{1}}\\right)^{3/2}\\right)^{2/3} = \\left(\\frac{p}{q}\\right)^{2/3}$$\n$$\\frac{a_{2}}{a_{1}} = \\left(\\frac{p}{q}\\right)^{2/3}$$\n\nFinally, we solve for $a_{1}$ to obtain the general expression for the resonance location:\n$$a_{1} = a_{2} \\left(\\frac{p}{q}\\right)^{-2/3} = a_{2} \\left(\\frac{q}{p}\\right)^{2/3}$$\n\nNow, we evaluate this expression for the specific case given: an interior $2:1$ resonance with a planet at $a_{2} = 5\\,\\mathrm{au}$.\nFor an interior resonance, the test particle is closer to the star, so $a_{1} < a_{2}$. This implies that the particle's mean motion is greater, $n_{1} > n_{2}$. Therefore, the ratio $p/q$ must be greater than $1$. The $2:1$ resonance corresponds to $n_{1}/n_{2} = 2/1$, so we set $p=2$ and $q=1$. The planet's semi-major axis is $a_{2} = 5\\,\\mathrm{au}$.\n\nSubstituting these values into our derived expression for $a_{1}$:\n$$a_{1} = (5\\,\\mathrm{au}) \\left(\\frac{1}{2}\\right)^{2/3}$$\n\nWe now calculate the numerical value:\n$$a_{1} = 5 \\times (0.5)^{2/3}\\,\\mathrm{au}$$\n$$a_{1} = 5 \\times (0.25)^{1/3}\\,\\mathrm{au}$$\n$$a_{1} = 5 \\times 0.62996052... \\,\\mathrm{au}$$\n$$a_{1} \\approx 3.1498026... \\,\\mathrm{au}$$\n\nThe problem requires rounding the result to four significant figures. The fifth significant figure is $8$, so we round up the fourth digit.\n$$a_{1} \\approx 3.150\\,\\mathrm{au}$$",
            "answer": "$$\n\\boxed{3.150}\n$$"
        },
        {
            "introduction": "Resonances are not merely a theoretical curiosity; they leave powerful, observable imprints on planetary systems. This exercise connects the theory of resonance to one of its most important observational signatures, the Transit Timing Variation (TTV), where mutual gravitational perturbations between near-resonant planets cause their transit times to deviate from a strict schedule. You will use a simplified TTV model to 'weigh' planets and then employ numerical integration to test whether the resulting system is dynamically stable, bridging analytical approximation with computational verification. ",
            "id": "4167343",
            "problem": "A pair of coplanar planets orbiting a star exhibits Transit Timing Variations (TTV) consistent with proximity to a first-order Mean-Motion Resonance (MMR). Starting from Newtonian gravitation and Keplerian dynamics, model the leading-order resonant TTV amplitude scaling for a near-resonant pair and infer the planetary masses. Then, verify short-term dynamical stability of the inferred configuration by integrating the gravitational equations of motion for the three-body system (star plus two planets) and checking for the absence of close approaches within a threshold set by the mutual Hill radius. Use only the assumptions explicitly stated here, and ensure scientific realism by maintaining dimensional consistency and correct unit usage throughout.\n\nFundamental base and modeling assumptions:\n- Newton's law of universal gravitation: point masses interact via a force of magnitude $F = G \\, m_1 m_2 / r^2$, where $G$ is the gravitational constant, $m_1$ and $m_2$ are masses, and $r$ is separation.\n- Kepler's third law for a planet of negligible mass relative to the star: $a^3 = G M_\\star \\left( \\dfrac{P}{2\\pi} \\right)^2$, where $a$ is the semimajor axis, $M_\\star$ is the stellar mass, and $P$ is the orbital period.\n- Mean motion is $n = 2\\pi / P$.\n- For a first-order resonance $j:(j-1)$, the fractional distance to exact resonance is defined as $\\Delta = \\dfrac{P_2 / P_1}{j/(j-1)} - 1$, where $P_1$ and $P_2$ are the orbital periods of the inner and outer planets respectively, and $j$ is an integer greater than $1$.\n- In the leading-order resonant TTV approximation with vanishing free eccentricities and order-unity resonant coefficients, the TTV amplitudes $\\delta t_1$ and $\\delta t_2$ scale linearly with the perturbing planet-to-star mass ratios $\\mu_2 = m_2 / M_\\star$ and $\\mu_1 = m_1 / M_\\star$ respectively, and inversely with $|\\Delta|$. Specifically, adopt the simplified leading-order relations\n$$\n\\delta t_1 \\approx \\frac{P_1}{\\pi} \\frac{\\mu_2}{|\\Delta|}, \\qquad\n\\delta t_2 \\approx \\frac{P_2}{\\pi} \\frac{\\mu_1}{|\\Delta|},\n$$\nwhich imply\n$$\n\\mu_2 \\approx \\frac{\\pi \\, |\\Delta| \\, \\delta t_1}{P_1}, \\qquad\n\\mu_1 \\approx \\frac{\\pi \\, |\\Delta| \\, \\delta t_2}{P_2}.\n$$\nThese relations capture the dominant resonant contribution and are valid when the free eccentricities are small, the system is close to but not exactly at resonance ($\\Delta \\neq 0$), and the masses are low enough that higher-order terms are negligible.\n- For dynamical stability verification, propagate the planetary orbits under Newtonian gravity in the planar three-body problem, treating the star as fixed at the origin due to its dominant mass and including planet-planet interactions. Define the mutual Hill radius as\n$$\nR_{\\mathrm{H}} = \\left( \\frac{m_1 + m_2}{3 M_\\star} \\right)^{1/3} \\left( \\frac{a_1 + a_2}{2} \\right),\n$$\nwhere $a_1$ and $a_2$ are the semimajor axes of the inner and outer planets computed from their periods using Kepler's third law. Over the integration interval, compute the minimum instantaneous separation $d_{\\min}$ between the planets and declare the configuration dynamically stable if $d_{\\min} > 3 \\, R_{\\mathrm{H}}$. Use angles in radians.\n\nTasks:\n1. Using the resonant TTV approximation above, compute the masses $m_1$ and $m_2$ in kilograms and convert them to Earth masses $M_\\oplus$ for each test case.\n2. Compute $a_1$ and $a_2$ from the given $P_1$ and $P_2$.\n3. Integrate the planar Newtonian equations of motion for the star-planet-planet system for a fixed duration and evaluate $d_{\\min}$; then determine the boolean stability flag using the $3 R_{\\mathrm{H}}$ threshold.\n4. Produce the final output as a single line containing a comma-separated list where each test case result is the list $[m_1/M_\\oplus, m_2/M_\\oplus, \\text{stability}]$.\n\nPhysical units and angle units:\n- Periods $P_1$ and $P_2$ are provided in $\\mathrm{days}$ and must be converted to $\\mathrm{s}$ in calculations.\n- TTV amplitudes $\\delta t_1$ and $\\delta t_2$ are provided in $\\mathrm{s}$.\n- Stellar mass $M_\\star$ is provided in $\\mathrm{kg}$.\n- Express the final masses in Earth masses $M_\\oplus$ as floating-point numbers.\n- Use angles in $\\mathrm{radians}$.\n- The gravitational constant is $G = 6.67430 \\times 10^{-11} \\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$.\n- The Solar mass is $M_\\odot = 1.9885 \\times 10^{30} \\,\\mathrm{kg}$.\n- The Earth mass is $M_\\oplus = 5.9722 \\times 10^{24} \\,\\mathrm{kg}$.\n\nNumerical integration specifications:\n- Use a standard ordinary differential equation solver to integrate $\\dot{\\mathbf{r}}_i = \\mathbf{v}_i$, $\\dot{\\mathbf{v}}_i = \\mathbf{a}_i$, with\n$$\n\\mathbf{a}_1 = -\\frac{G M_\\star}{r_1^3} \\mathbf{r}_1 - G m_2 \\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{\\|\\mathbf{r}_1 - \\mathbf{r}_2\\|^3}, \\qquad\n\\mathbf{a}_2 = -\\frac{G M_\\star}{r_2^3} \\mathbf{r}_2 - G m_1 \\frac{\\mathbf{r}_2 - \\mathbf{r}_1}{\\|\\mathbf{r}_2 - \\mathbf{r}_1\\|^3}.\n$$\nInitialize circular orbits in the plane with angular positions $\\lambda_1 = 0$ and $\\lambda_2 = \\pi/3$ and tangential velocities of magnitude $v_i = \\sqrt{G M_\\star / a_i}$. Integrate for a duration of $T = 2000 \\,\\mathrm{days}$, sampling the separation sufficiently to evaluate $d_{\\min}$.\n\nTest suite:\nProvide results for the following three test cases, designed to probe different offsets from resonance and TTV amplitudes:\n- Case A (near $2{:}1$ resonance, moderate $\\Delta$): $M_\\star = 1.9885 \\times 10^{30} \\,\\mathrm{kg}$, $j = 2$, $P_1 = 10 \\,\\mathrm{days}$, $P_2 = 20.6 \\,\\mathrm{days}$, $\\delta t_1 = 150 \\,\\mathrm{s}$, $\\delta t_2 = 100 \\,\\mathrm{s}$.\n- Case B (near $3{:}2$ resonance, moderate $\\Delta$): $M_\\star = 1.9885 \\times 10^{30} \\,\\mathrm{kg}$, $j = 3$, $P_1 = 12 \\,\\mathrm{days}$, $P_2 = 18.3 \\,\\mathrm{days}$, $\\delta t_1 = 200 \\,\\mathrm{s}$, $\\delta t_2 = 180 \\,\\mathrm{s}$.\n- Case C (near $2{:}1$ resonance, small $\\Delta$ and small amplitudes): $M_\\star = 1.9885 \\times 10^{30} \\,\\mathrm{kg}$, $j = 2$, $P_1 = 8 \\,\\mathrm{days}$, $P_2 = 16.05 \\,\\mathrm{days}$, $\\delta t_1 = 60 \\,\\mathrm{s}$, $\\delta t_2 = 45 \\,\\mathrm{s}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of the form $[m_1/M_\\oplus, m_2/M_\\oplus, \\text{stability}]$. For example, an output line with three cases should look like $[[x_1,y_1,\\mathrm{True}],[x_2,y_2,\\mathrm{False}],[x_3,y_3,\\mathrm{True}]]$, where $x_i$ and $y_i$ are floating-point numbers.",
            "solution": "The problem requires a two-part analysis for each test case of a star-planet-planet system. First, we infer the planetary masses from Transit Timing Variation (TTV) data using a provided analytical model. Second, we verify the short-term dynamical stability of the inferred system by performing a direct numerical integration of the Newtonian equations of motion.\n\nThe solution proceeds systematically for each test case:\n1.  **Mass Inference**: Calculation of planetary masses from the given TTV amplitudes and orbital periods.\n2.  **Stability Analysis Setup**: Computation of the semimajor axes and the mutual Hill radius, which defines the stability threshold.\n3.  **Numerical Integration and Stability Check**: Simulation of the system's orbital evolution to find the minimum inter-planet separation and compare it against the stability threshold.\n\nAll calculations are performed using the International System of Units (SI): kilograms for mass, meters for distance, and seconds for time.\n\n**Physical Constants and Unit Conversions**\nThe following constants are used throughout the analysis:\n-   Gravitational constant: $G = 6.67430 \\times 10^{-11} \\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$\n-   Solar mass: $M_\\odot = 1.9885 \\times 10^{30} \\,\\mathrm{kg}$\n-   Earth mass: $M_\\oplus = 5.9722 \\times 10^{24} \\,\\mathrm{kg}$\n-   Conversion from days to seconds: $1 \\,\\mathrm{day} = 86400 \\,\\mathrm{s}$\n\n**Step 1: Mass Inference from TTVs**\n\nThe problem provides a simplified leading-order model for TTV amplitudes for planets near a first-order $j:(j-1)$ mean-motion resonance. The mass ratios of the planets to the star, $\\mu_1 = m_1 / M_\\star$ and $\\mu_2 = m_2 / M_\\star$, are inferred using these relations.\n\nFirst, we calculate the fractional distance from exact resonance, $\\Delta$. For an inner planet with period $P_1$ and an outer planet with period $P_2$, near a $j:(j-1)$ resonance, $\\Delta$ is defined as:\n$$\n\\Delta = \\frac{P_2 / P_1}{j/(j-1)} - 1\n$$\nIt is crucial to use the periods $P_1$ and $P_2$ in consistent units (either days or seconds, as it is a ratio).\n\nNext, we use the provided formulae to find the planet-to-star mass ratios $\\mu_1$ and $\\mu_2$:\n$$\n\\mu_1 \\approx \\frac{\\pi \\, |\\Delta| \\, \\delta t_2}{P_2}\n$$\n$$\n\\mu_2 \\approx \\frac{\\pi \\, |\\Delta| \\, \\delta t_1}{P_1}\n$$\nIn these formulae, the periods $P_1, P_2$ and TTV amplitudes $\\delta t_1, \\delta t_2$ must be in seconds to maintain dimensional consistency.\n\nFrom the mass ratios, the planetary masses $m_1$ and $m_2$ are calculated in kilograms:\n$$\nm_1 = \\mu_1 M_\\star\n$$\n$$\nm_2 = \\mu_2 M_\\star\n$$\nFinally, these masses are converted to Earth masses ($M_\\oplus$) for the output.\n\n**Step 2: Stability Analysis Setup**\n\nFor the stability analysis, we first determine the semimajor axes, $a_1$ and $a_2$, of the planetary orbits. Assuming the planets have negligible mass compared to the star for this calculation, we use Kepler's third law:\n$$\na_i = \\left( G M_\\star \\left( \\frac{P_i}{2\\pi} \\right)^2 \\right)^{1/3}\n$$\nwhere $P_i$ must be in seconds.\n\nThe stability of the system is assessed by checking for close encounters. The critical separation is defined in terms of the mutual Hill radius, $R_\\mathrm{H}$:\n$$\nR_{\\mathrm{H}} = \\left( \\frac{m_1 + m_2}{3 M_\\star} \\right)^{1/3} \\left( \\frac{a_1 + a_2}{2} \\right)\n$$\nA system is considered dynamically stable for the duration of the integration if the minimum separation between the planets, $d_{\\min}$, is greater than $3$ times the mutual Hill radius:\n$$\nd_{\\min} > 3 \\, R_{\\mathrm{H}}\n$$\n\n**Step 3: Numerical Integration and Stability Check**\n\nTo find $d_{\\min}$, we integrate the equations of motion for the planar three-body problem. The star is assumed to be fixed at the origin $(0,0)$. The state of the system is described by the position vectors $\\mathbf{r}_1, \\mathbf{r}_2$ and velocity vectors $\\mathbf{v}_1, \\mathbf{v}_2$ of the two planets. The evolution of the system is governed by Newton's second law, $\\dot{\\mathbf{v}}_i = \\mathbf{a}_i$, where the accelerations are given by:\n$$\n\\mathbf{a}_1 = -\\frac{G M_\\star}{r_1^3} \\mathbf{r}_1 - G m_2 \\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{\\|\\mathbf{r}_1 - \\mathbf{r}_2\\|^3}\n$$\n$$\n\\mathbf{a}_2 = -\\frac{G M_\\star}{r_2^3} \\mathbf{r}_2 - G m_1 \\frac{\\mathbf{r}_2 - \\mathbf{r}_1}{\\|\\mathbf{r}_2 - \\mathbf{r}_1\\|^3}\n$$\nHere, $r_i = \\|\\mathbf{r}_i\\|$ is the distance of planet $i$ from the star.\n\nThe integration is performed over a duration of $T = 2000$ days. The initial conditions are specified as circular orbits in the $xy$-plane with initial angular positions (mean longitudes) $\\lambda_1 = 0$ and $\\lambda_2 = \\pi/3$. The initial position and velocity vectors are:\n-   Planet 1 (at $\\lambda_1 = 0$):\n    -   $\\mathbf{r}_1(0) = (a_1, 0)$\n    -   $\\mathbf{v}_1(0) = (0, v_1)$, where $v_1 = \\sqrt{G M_\\star / a_1}$\n-   Planet 2 (at $\\lambda_2 = \\pi/3$):\n    -   $\\mathbf{r}_2(0) = (a_2 \\cos(\\pi/3), a_2 \\sin(\\pi/3))$\n    -   $\\mathbf{v}_2(0) = (-v_2 \\sin(\\pi/3), v_2 \\cos(\\pi/3))$, where $v_2 = \\sqrt{G M_\\star / a_2}$\n\nA numerical Ordinary Differential Equation (ODE) solver is used to propagate this initial state. The positions of the planets are recorded at regular time intervals. The instantaneous distance between the planets, $d(t) = \\|\\mathbf{r}_2(t) - \\mathbf{r}_1(t)\\|$, is computed at each step, and the minimum value over the entire integration, $d_{\\min}$, is found.\n\nFinally, the stability flag is set to true if $d_{\\min} > 3 \\, R_{\\mathrm{H}}$ and false otherwise. The results for each test case—the two planetary masses in $M_\\oplus$ and the boolean stability flag—are then compiled into the specified output format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It processes each case, infers planetary masses from TTV data,\n    and runs an N-body simulation to check for dynamical stability.\n    \"\"\"\n\n    # Physical Constants in SI units\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n    M_SOLAR = 1.9885e30  # kg\n    M_EARTH = 5.9722e24  # kg\n    DAY_S = 86400  # seconds in a day\n    AU = 1.496e11 # meters in an AU\n\n    # Test suite from the problem statement\n    test_cases = [\n        # Case A (near 2:1 resonance, moderate Delta)\n        {\n            \"M_star\": M_SOLAR, \"j\": 2, \"P1_days\": 10.0, \"P2_days\": 20.6,\n            \"dt1_s\": 150.0, \"dt2_s\": 100.0,\n        },\n        # Case B (near 3:2 resonance, moderate Delta)\n        {\n            \"M_star\": M_SOLAR, \"j\": 3, \"P1_days\": 12.0, \"P2_days\": 18.3,\n            \"dt1_s\": 200.0, \"dt2_s\": 180.0,\n        },\n        # Case C (near 2:1 resonance, small Delta and small amplitudes)\n        {\n            \"M_star\": M_SOLAR, \"j\": 2, \"P1_days\": 8.0, \"P2_days\": 16.05,\n            \"dt1_s\": 60.0, \"dt2_s\": 45.0,\n        },\n    ]\n\n    # This function defines the system of ODEs for the N-body problem.\n    def ode_system(t, y, G, M_star, m1, m2):\n        \"\"\"\n        Defines the differential equations for the planar 2-planet system.\n        The star is at the origin and is stationary.\n        State vector y = [x1, y1, x2, y2, vx1, vy1, vx2, vy2].\n        \"\"\"\n        r1_vec = y[0:2]\n        r2_vec = y[2:4]\n        v1_vec = y[4:6]\n        v2_vec = y[6:8]\n\n        r1_mag = np.linalg.norm(r1_vec)\n        r2_mag = np.linalg.norm(r2_vec)\n        r12_vec = r1_vec - r2_vec\n        r12_mag = np.linalg.norm(r12_vec)\n        \n        # Gravitational accelerations\n        # a_i = -G*M_star/r_i^3 * r_i - G*m_j * (r_i - r_j) / ||r_i - r_j||^3\n        a1_vec = -G * M_star * r1_vec / r1_mag**3 - G * m2 * r12_vec / r12_mag**3\n        a2_vec = -G * M_star * r2_vec / r2_mag**3 + G * m1 * r12_vec / r12_mag**3\n        \n        return np.concatenate((v1_vec, v2_vec, a1_vec, a2_vec))\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current case\n        M_star = case[\"M_star\"]\n        j = case[\"j\"]\n        P1_days, P2_days = case[\"P1_days\"], case[\"P2_days\"]\n        dt1_s, dt2_s = case[\"dt1_s\"], case[\"dt2_s\"]\n        \n        # Convert periods to seconds\n        P1_s = P1_days * DAY_S\n        P2_s = P2_days * DAY_S\n\n        # --- Step 1: Infer Planetary Masses ---\n        \n        # Calculate fractional distance to resonance, Delta\n        j_ratio = j / (j - 1)\n        period_ratio = P2_days / P1_days\n        delta = period_ratio / j_ratio - 1\n        \n        # Calculate planet-to-star mass ratios (mu)\n        mu1 = (np.pi * abs(delta) * dt2_s) / P2_s\n        mu2 = (np.pi * abs(delta) * dt1_s) / P1_s\n        \n        # Calculate planet masses in kg and Earth masses\n        m1_kg = mu1 * M_star\n        m2_kg = mu2 * M_star\n        m1_earth = m1_kg / M_EARTH\n        m2_earth = m2_kg / M_EARTH\n\n        # --- Step 2: Setup for Stability Analysis ---\n\n        # Calculate semimajor axes using Kepler's Third Law\n        a1 = (G * M_star * (P1_s / (2 * np.pi))**2)**(1/3)\n        a2 = (G * M_star * (P2_s / (2 * np.pi))**2)**(1/3)\n        \n        # Calculate mutual Hill radius\n        R_H = ((m1_kg + m2_kg) / (3 * M_star))**(1/3) * ((a1 + a2) / 2)\n        stability_threshold = 3 * R_H\n\n        # --- Step 3: Numerical Integration and Stability Check ---\n        \n        # Set initial conditions for circular orbits\n        v1_mag = np.sqrt(G * M_star / a1)\n        v2_mag = np.sqrt(G * M_star / a2)\n\n        lambda1_0 = 0.0\n        lambda2_0 = np.pi / 3.0\n\n        r1_0 = np.array([a1 * np.cos(lambda1_0), a1 * np.sin(lambda1_0)])\n        v1_0 = np.array([-v1_mag * np.sin(lambda1_0), v1_mag * np.cos(lambda1_0)])\n        \n        r2_0 = np.array([a2 * np.cos(lambda2_0), a2 * np.sin(lambda2_0)])\n        v2_0 = np.array([-v2_mag * np.sin(lambda2_0), v2_mag * np.cos(lambda2_0)])\n        \n        y0 = np.concatenate((r1_0, r2_0, v1_0, v2_0))\n\n        # Integrate the equations of motion\n        integration_duration_s = 2000 * DAY_S\n        t_span = (0, integration_duration_s)\n        # Sample sufficiently to find the minimum distance\n        t_eval = np.linspace(t_span[0], t_span[1], 20001)\n\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=t_span,\n            y0=y0,\n            args=(G, M_star, m1_kg, m2_kg),\n            t_eval=t_eval,\n            method='RK45', # A standard choice\n            rtol=1e-8, atol=1e-8\n        )\n        \n        # Calculate minimum separation\n        r1_sol = sol.y[0:2, :]\n        r2_sol = sol.y[2:4, :]\n        separations = np.linalg.norm(r2_sol - r1_sol, axis=0)\n        d_min = np.min(separations)\n        \n        # Determine stability\n        is_stable = d_min > stability_threshold\n        \n        results.append([m1_earth, m2_earth, is_stable])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    print(results)\n\nsolve()\n```"
        },
        {
            "introduction": "The prevalence of resonant pairs in exoplanet populations points to resonant capture as a key process during planet formation. This advanced exercise delves into the physics of capture, which occurs as planets migrate within their natal protoplanetary disk and interact gravitationally. By constructing a model that balances the inward push of migration against the dissipative effects of eccentricity damping, you will derive an expression for the probability of capture, providing deep insight into how these elegant orbital architectures are established. ",
            "id": "4167309",
            "problem": "Consider a coplanar, two-planet system of super-Earths with masses $m_{1}$ (inner planet) and $m_{2}$ (outer planet) orbiting a star of mass $M_{\\star}$. The planets undergo convergent migration due to interactions with a gaseous disk, modeled by exponential semimajor axis damping and eccentricity damping with timescales $\\tau_{a,1}$, $\\tau_{a,2}$ and $\\tau_{e,1}$, $\\tau_{e,2}$, respectively. Assume small eccentricities and that the system approaches the first-order $3:2$ mean-motion resonance (that is, $j=2$ in the notation for a $(j+1):j$ resonance).\n\nStarting from the standard averaged, planar resonant Hamiltonian for a first-order mean-motion resonance and adiabatic capture theory based on slowly swept pendulum-like dynamics, derive an analytic expression for the expected capture likelihood $P_{\\mathrm{cap}}$ into the $3:2$ resonance in terms of the drift rate of the resonant detuning and the small-amplitude libration frequency at resonance crossing. Adopt the following physically motivated definitions and approximations:\n\n- The resonant detuning is $\\delta \\equiv (j+1)n_{2} - j n_{1}$, with $n_{i}$ the mean motions of the planets, and near exact commensurability $n_{1}/n_{2} \\approx 3/2$.\n- The drift of the detuning driven by migration is $|\\dot{\\delta}| = \\frac{3}{2}\\left((j+1)\\frac{n_{2}}{\\tau_{a,2}} - j\\frac{n_{1}}{\\tau_{a,1}}\\right)$, evaluated at the resonance encounter.\n- The small-amplitude resonant libration frequency has the scaling $\\omega_{\\mathrm{lib}}^{2} = S_{3:2}\\,n^{2}\\,e_{\\ast}$, where $n$ is a reference mean motion at resonance (you may set $n \\equiv n_{2}$), $S_{3:2}$ is a dimensionless strength coefficient for the $3:2$ resonance that depends on $m_{1}$, $m_{2}$, $M_{\\star}$ and Laplace coefficient combinations at $\\alpha \\equiv a_{1}/a_{2}$, and $e_{\\ast}$ is the characteristic eccentricity at the onset of capture.\n- Estimate $e_{\\ast}$ by balancing the angular momentum deficit (AMD) pumped by convergent migration against the AMD removed by eccentricity damping at the moment the resonant separatrix appears: equate $\\dot{D}_{\\mathrm{pump}}$ and $\\dot{D}_{\\mathrm{damp}}$, where $D \\approx \\frac{1}{2}\\left(\\Lambda_{1}e_{1}^{2} + \\Lambda_{2}e_{2}^{2}\\right)$ is the AMD for small eccentricities and $\\Lambda_{i} \\equiv m_{i}\\sqrt{G M_{\\star} a_{i}}$ are the circular angular momenta. Use the leading-order estimates $\\dot{D}_{\\mathrm{pump}} \\approx \\frac{3}{4}\\left((j+1)\\frac{\\Lambda_{2}}{\\tau_{a,2}} - j\\frac{\\Lambda_{1}}{\\tau_{a,1}}\\right)$ and $\\dot{D}_{\\mathrm{damp}} \\approx -\\left(\\frac{\\Lambda_{1}e_{1}^{2}}{\\tau_{e,1}} + \\frac{\\Lambda_{2}e_{2}^{2}}{\\tau_{e,2}}\\right)$, and adopt the approximation $e_{1} \\approx e_{2} \\equiv e_{\\ast}$ appropriate for comparable-mass super-Earths in a first-order resonance.\n- Under adiabatic passage through resonance, the drift-rate capture theory gives the capture likelihood $P_{\\mathrm{cap}}$ in terms of the ratio $\\Lambda \\equiv \\omega_{\\mathrm{lib}}^{2}/|\\dot{\\delta}|$.\n\nExpress your final result for $P_{\\mathrm{cap}}$ as a single closed-form symbolic expression in terms of $G$, $M_{\\star}$, $m_{1}$, $m_{2}$, $a_{1}$, $a_{2}$ (evaluated at the resonance location), $n$ (you may set $n \\equiv n_{2}$), $\\tau_{a,1}$, $\\tau_{a,2}$, $\\tau_{e,1}$, $\\tau_{e,2}$, and the dimensionless resonance strength $S_{3:2}$. Do not numerically evaluate your expression. Angles, when they appear, should be treated in radians. The final answer must be a single analytic expression and must not include any equality or inequality other than the expression itself. No rounding is required.",
            "solution": "The goal is to derive an analytical expression for the probability of capture into a $3:2$ mean-motion resonance, $P_{\\mathrm{cap}}$, for a two-planet system undergoing disk-driven migration. The derivation proceeds by first constructing the adiabaticity parameter, $\\Lambda = \\omega_{\\mathrm{lib}}^{2}/|\\dot{\\delta}|$, and then relating it to the capture probability using the standard result from adiabatic theory, $P_{\\mathrm{cap}} = 1 - \\exp(-\\pi \\Lambda)$.\n\nThe derivation consists of three main steps:\n1.  Derive an expression for the resonant detuning drift rate, $|\\dot{\\delta}|$.\n2.  Derive an expression for the characteristic eccentricity at capture, $e_{\\ast}$, by balancing angular momentum deficit (AMD) pumping and damping.\n3.  Combine these results to construct the adiabaticity parameter $\\Lambda$ and, finally, the capture probability $P_{\\mathrm{cap}}$.\n\n**1. Expression for the Drift Rate $|\\dot{\\delta}|$**\n\nThe drift rate of the resonant detuning, $\\delta = 3n_2 - 2n_1$, is given by:\n$$\n|\\dot{\\delta}| = \\frac{3}{2}\\left(3\\frac{n_{2}}{\\tau_{a,2}} - 2\\frac{n_{1}}{\\tau_{a,1}}\\right)\n$$\nThis expression is evaluated at the resonance location, where $n_{1}/n_{2} \\approx 3/2$. Substituting $n_{1} \\approx \\frac{3}{2} n_{2}$ and using the specified simplification $n \\equiv n_2$:\n$$\n|\\dot{\\delta}| \\approx \\frac{3}{2}\\left(3\\frac{n}{\\tau_{a,2}} - 2\\frac{(3/2)n}{\\tau_{a,1}}\\right) = \\frac{3}{2}\\left(3\\frac{n}{\\tau_{a,2}} - 3\\frac{n}{\\tau_{a,1}}\\right) = \\frac{9}{2}n\\left(\\frac{1}{\\tau_{a,2}} - \\frac{1}{\\tau_{a,1}}\\right)\n$$\nFor convergent migration ($a_1/\\tau_{a,1}  a_2/\\tau_{a,2}$), this rate is positive.\n\n**2. Expression for the Characteristic Eccentricity $e_{\\ast}$**\n\nThe characteristic eccentricity $e_{\\ast}$ is determined by the equilibrium between AMD pumping by convergent migration and AMD removal by eccentricity damping. The equilibrium condition is $\\dot{D}_{\\mathrm{pump}} + \\dot{D}_{\\mathrm{damp}} = 0$, or $\\dot{D}_{\\mathrm{pump}} = -\\dot{D}_{\\mathrm{damp}}$.\n\nThe given expressions are:\n$$\n\\dot{D}_{\\mathrm{pump}} = \\frac{3}{4}\\left(3\\frac{\\Lambda_{2}}{\\tau_{a,2}} - 2\\frac{\\Lambda_{1}}{\\tau_{a,1}}\\right)\n$$\n$$\n\\dot{D}_{\\mathrm{damp}} = -\\left(\\frac{\\Lambda_{1}e_{1}^{2}}{\\tau_{e,1}} + \\frac{\\Lambda_{2}e_{2}^{2}}{\\tau_{e,2}}\\right)\n$$\nUsing the approximation $e_1 \\approx e_2 \\equiv e_{\\ast}$, the damping rate becomes:\n$$\n\\dot{D}_{\\mathrm{damp}} \\approx -e_{\\ast}^{2}\\left(\\frac{\\Lambda_{1}}{\\tau_{e,1}} + \\frac{\\Lambda_{2}}{\\tau_{e,2}}\\right)\n$$\nEquating the rates yields:\n$$\n\\frac{3}{4}\\left(3\\frac{\\Lambda_{2}}{\\tau_{a,2}} - 2\\frac{\\Lambda_{1}}{\\tau_{a,1}}\\right) = e_{\\ast}^{2}\\left(\\frac{\\Lambda_{1}}{\\tau_{e,1}} + \\frac{\\Lambda_{2}}{\\tau_{e,2}}\\right)\n$$\nSolving for $e_{\\ast}$ gives:\n$$\ne_{\\ast} = \\left[ \\frac{3}{4} \\frac{3\\frac{\\Lambda_{2}}{\\tau_{a,2}} - 2\\frac{\\Lambda_{1}}{\\tau_{a,1}}}{\\frac{\\Lambda_{1}}{\\tau_{e,1}} + \\frac{\\Lambda_{2}}{\\tau_{e,2}}} \\right]^{1/2}\n$$\n\n**3. Assembling the Capture Probability Expression**\n\nThe small-amplitude resonant libration frequency is given as $\\omega_{\\mathrm{lib}}^{2} = S_{3:2}\\,n^{2}\\,e_{\\ast}$. Substituting the derived expression for $e_{\\ast}$:\n$$\n\\omega_{\\mathrm{lib}}^{2} = S_{3:2}\\,n^{2} \\left[ \\frac{3}{4} \\frac{3\\frac{\\Lambda_{2}}{\\tau_{a,2}} - 2\\frac{\\Lambda_{1}}{\\tau_{a,1}}}{\\frac{\\Lambda_{1}}{\\tau_{e,1}} + \\frac{\\Lambda_{2}}{\\tau_{e,2}}} \\right]^{1/2}\n$$\nNow, we construct the adiabaticity parameter $\\Lambda = \\omega_{\\mathrm{lib}}^{2}/|\\dot{\\delta}|$:\n$$\n\\Lambda = \\frac{S_{3:2}\\,n^{2} \\left[ \\frac{3}{4} \\frac{3\\frac{\\Lambda_{2}}{\\tau_{a,2}} - 2\\frac{\\Lambda_{1}}{\\tau_{a,1}}}{\\frac{\\Lambda_{1}}{\\tau_{e,1}} + \\frac{\\Lambda_{2}}{\\tau_{e,2}}} \\right]^{1/2}}{\\frac{9}{2}n\\left(\\frac{1}{\\tau_{a,2}} - \\frac{1}{\\tau_{a,1}}\\right)} = \\frac{2 S_{3:2} n}{9\\left(\\frac{1}{\\tau_{a,2}} - \\frac{1}{\\tau_{a,1}}\\right)} \\left[ \\frac{3}{4} \\frac{3\\frac{\\Lambda_{2}}{\\tau_{a,2}} - 2\\frac{\\Lambda_{1}}{\\tau_{a,1}}}{\\frac{\\Lambda_{1}}{\\tau_{e,1}} + \\frac{\\Lambda_{2}}{\\tau_{e,2}}} \\right]^{1/2}\n$$\nFinally, we substitute the full expression for $\\Lambda$ into the capture probability formula $P_{\\mathrm{cap}} = 1 - \\exp(-\\pi \\Lambda)$. To express this in terms of the required fundamental variables, we use the definitions $\\Lambda_{1} = m_{1}\\sqrt{G M_{\\star} a_{1}}$ and $\\Lambda_{2} = m_{2}\\sqrt{G M_{\\star} a_{2}}$, yielding the final expression:\n$$\nP_{\\mathrm{cap}} = 1 - \\exp\\left\\{ -\\pi \\frac{2 S_{3:2} n}{9\\left(\\frac{1}{\\tau_{a,2}} - \\frac{1}{\\tau_{a,1}}\\right)} \\left[ \\frac{3}{4} \\frac{3\\frac{m_{2} \\sqrt{G M_{\\star} a_{2}}}{\\tau_{a,2}} - 2\\frac{m_{1} \\sqrt{G M_{\\star} a_{1}}}{\\tau_{a,1}}}{\\frac{m_{1} \\sqrt{G M_{\\star} a_{1}}}{\\tau_{e,1}} + \\frac{m_{2} \\sqrt{G M_{\\star} a_{2}}}{\\tau_{e,2}}} \\right]^{1/2} \\right\\}\n$$",
            "answer": "$$\n\\boxed{1 - \\exp\\left\\{ -\\pi \\frac{2 S_{3:2} n}{9\\left(\\frac{1}{\\tau_{a,2}} - \\frac{1}{\\tau_{a,1}}\\right)} \\left[ \\frac{3}{4} \\frac{3\\frac{m_{2} \\sqrt{G M_{\\star} a_{2}}}{\\tau_{a,2}} - 2\\frac{m_{1} \\sqrt{G M_{\\star} a_{1}}}{\\tau_{a,1}}}{\\frac{m_{1} \\sqrt{G M_{\\star} a_{1}}}{\\tau_{e,1}} + \\frac{m_{2} \\sqrt{G M_{\\star} a_{2}}}{\\tau_{e,2}}} \\right]^{1/2} \\right\\}}\n$$"
        }
    ]
}