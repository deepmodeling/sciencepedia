{
    "hands_on_practices": [
        {
            "introduction": "这一练习是理解平均运动共振的第一步。它将共振的概念根植于其最基本的起源：开普勒第三定律所描述的轨道周期与距离之间的关系。通过从第一性原理出发推导共振位置 ，您将在探索其复杂的动力学效应之前，巩固对为何这些特定轨道构型在数学上具有重要意义的理解。",
            "id": "4167334",
            "problem": "一颗质量为 $M_{\\odot}$ 的恒星拥有一颗行星，该行星在一个半长轴为 $a_{2}=5\\,\\mathrm{au}$ 的近圆形共面轨道上运行。考虑一个位于内部近圆形共面轨道上的无质量测试粒子。当测试粒子与行星的平均运动之比满足 $n_{1}/n_{2}=p/q$ 时，两者之间发生 $p\\!:\\!q$ 阶的平均运动共振。其中，$n=\\sqrt{G M_{\\star}/a^{3}}$ 是一个半长轴为 $a$ 的开普勒轨道围绕质量为 $M_{\\star}$ 的恒星运动时的平均运动，$G$ 是引力常数。\n\n仅从平均运动的定义 $n=\\sqrt{G M_{\\star}/a^{3}}$ 和共振条件 $n_{1}/n_{2}=p/q$ 出发，推导内部共振位置 $a_{1}$ 关于 $a_{2}$、$p$ 和 $q$ 的表达式，并解释在所述假设下，为何结果与 $M_{\\star}$ 无关。然后，对于给定的 $a_{2}=5\\,\\mathrm{au}$，计算内部 $2\\!:\\!1$ 共振（$p=2$, $q=1$）情况下该表达式的值。\n\n用天文单位表示 $a_{1}$ 的最终结果，并将答案四舍五入到四位有效数字。",
            "solution": "该问题陈述清晰且具有科学依据，为在天体力学的既定原则内进行推导和计算提供了明确的基础。\n\n问题要求推导一个与半长轴为 $a_{2}$ 的行星处于平均运动共振状态的无质量测试粒子的半长轴 $a_{1}$ 的表达式。共振阶数为 $p:q$。我们已知围绕质量为 $M_{\\star}$ 的恒星的开普勒轨道的平均运动 $n$ 的定义：\n$$n = \\sqrt{\\frac{G M_{\\star}}{a^{3}}}$$\n其中 $a$ 是半长轴，$G$ 是引力常数。\n\n分别用下标1和2表示测试粒子和行星。它们的平均运动为：\n$$n_{1} = \\sqrt{\\frac{G M_{\\star}}{a_{1}^{3}}}$$\n$$n_{2} = \\sqrt{\\frac{G M_{\\star}}{a_{2}^{3}}}$$\n\n平均运动共振的条件由它们的平均运动之比给出：\n$$\\frac{n_{1}}{n_{2}} = \\frac{p}{q}$$\n\n我们将 $n_{1}$ 和 $n_{2}$ 的表达式代入共振条件：\n$$\\frac{\\sqrt{\\frac{G M_{\\star}}{a_{1}^{3}}}}{\\sqrt{\\frac{G M_{\\star}}{a_{2}^{3}}}} = \\frac{p}{q}$$\n\n项 $\\sqrt{G M_{\\star}}$ 同时出现在分子和分母中，因此可以消去：\n$$\\sqrt{\\frac{1/a_{1}^{3}}{1/a_{2}^{3}}} = \\frac{p}{q}$$\n$$\\sqrt{\\frac{a_{2}^{3}}{a_{1}^{3}}} = \\frac{p}{q}$$\n\n这一步证明了为什么共振的位置与恒星质量 $M_{\\star}$（以及引力常数 $G$）无关。平均运动之比仅取决于半长轴之比，因为它们对中心天体质量的依赖性是相同的，因此在该比率中被消除了。这是开普勒第三定律的直接结果，即轨道周期的平方之比（也就是平均运动平方的反比）仅取决于半长轴的立方之比。\n\n为了求解 $a_{1}$，我们继续进行代数运算。首先，我们可以重写方程的左边：\n$$\\left(\\frac{a_{2}}{a_{1}}\\right)^{3/2} = \\frac{p}{q}$$\n\n为了分离出比值 $a_{2}/a_{1}$，我们将等式两边同时取 $2/3$ 次方：\n$$\\left(\\left(\\frac{a_{2}}{a_{1}}\\right)^{3/2}\\right)^{2/3} = \\left(\\frac{p}{q}\\right)^{2/3}$$\n$$\\frac{a_{2}}{a_{1}} = \\left(\\frac{p}{q}\\right)^{2/3}$$\n\n最后，我们求解 $a_{1}$，得到共振位置的通用表达式：\n$$a_{1} = a_{2} \\left(\\frac{p}{q}\\right)^{-2/3} = a_{2} \\left(\\frac{q}{p}\\right)^{2/3}$$\n\n现在，我们针对给定的具体情况计算该表达式的值：与位于 $a_{2} = 5\\,\\mathrm{au}$ 的行星发生的内部 $2:1$ 共振。\n对于内部共振，测试粒子更靠近恒星，因此 $a_{1}  a_{2}$。这意味着该粒子的平均运动更大，即 $n_{1} > n_{2}$。因此，比值 $p/q$ 必须大于1。$2:1$ 共振对应于 $n_{1}/n_{2} = 2/1$，所以我们设定 $p=2$ 和 $q=1$。行星的半长轴为 $a_{2} = 5\\,\\mathrm{au}$。\n\n将这些值代入我们推导出的 $a_{1}$ 表达式中：\n$$a_{1} = (5\\,\\mathrm{au}) \\left(\\frac{1}{2}\\right)^{2/3}$$\n\n我们现在计算数值：\n$$a_{1} = 5 \\times (0.5)^{2/3}\\,\\mathrm{au}$$\n$$a_{1} = 5 \\times (0.25)^{1/3}\\,\\mathrm{au}$$\n$$a_{1} = 5 \\times 0.62996052... \\,\\mathrm{au}$$\n$$a_{1} \\approx 3.1498026... \\,\\mathrm{au}$$\n\n问题要求将结果四舍五入到四位有效数字。第五位有效数字是8，所以我们将第四位数字向上取整。\n$$a_{1} \\approx 3.150\\,\\mathrm{au}$$",
            "answer": "$$\n\\boxed{3.150}\n$$"
        },
        {
            "introduction": "在确定共振的运动学位置之后，本实践通过量化共振相互作用的强度来深入研究其动力学。该练习要求您处理天体力学的基石——微扰函数，并了解如何将其展开以分离出驱动共振行为的特定项 。通过此计算，您将更好地理解行星的质量、偏心率和轨道构型如何决定共振驱动力的大小，而这又主导了系统的演化。",
            "id": "4167324",
            "problem": "考虑两颗质量分别为 $m_1$ 和 $m_2$ 的共面行星，在引力常数为 $G$ 的牛顿引力作用下，环绕一颗质量为 $M_\\star$ 的恒星运行。设内行星的半长轴为 $a_1$，偏心率为 $e_1$；外行星的半长轴为 $a_2$。假设该系统接近整数指数 $j=3$ 的一阶（$q=1$ 阶）平均运动共振，因此相关的共振角为 $\\phi = 3 \\lambda_2 - 2 \\lambda_1 - \\varpi_1$，其中 $\\lambda_i$ 是行星 $i$ 的平均经度，$\\varpi_1$ 是内行星的近心点经度。在平面模型下进行计算，并保留到 $e_1$ 的领导阶。\n\n从牛顿引力以及内行星单位质量的摄动函数的定义出发，使用涉及拉普拉斯系数的相互引力势的标准傅里叶谐波展开，来确定 $q=1$ 时内行星偏心率类型贡献的领导阶共振项。拉普拉斯系数 $b_s^{(j)}(\\alpha)$ 定义为\n$$\nb_s^{(j)}(\\alpha) \\equiv \\frac{1}{\\pi} \\int_{0}^{\\pi} \\frac{\\cos(j \\psi) \\, d\\psi}{\\left(1 - 2 \\alpha \\cos \\psi + \\alpha^2\\right)^s},\n$$\n其中 $\\alpha \\equiv a_1/a_2$ 且 $s0$。在给定的比率 $\\alpha = a_1/a_2$ 下，乘以内行星 $q=1$ 共振偏心率项的拉普拉斯系数及其 $\\alpha$-导数的无量纲组合，其数值计算结果为 $c_{\\mathrm{res}} = 0.428$。\n\n推导 $q=1$ 时共振策动力的大小 $|R|$（内行星单位质量摄动函数中共振项的绝对值）的领导阶表达式，然后根据以下参数计算其数值：\n- $M_\\star = 1.0 \\, M_\\odot$（太阳质量），\n- $m_1 = 5.0 \\, M_\\oplus$（地球质量），\n- $m_2 = 10.0 \\, M_\\oplus$（地球质量），\n- $a_1 = 0.80 \\, \\mathrm{AU}$（天文单位），\n- $a_2 = 1.05 \\, \\mathrm{AU}$（天文单位），\n- $e_1 = 0.050$，\n- $c_{\\mathrm{res}} = 0.428$，\n- $G = 6.67430 \\times 10^{-11} \\, \\mathrm{m^3 \\, kg^{-1} \\, s^{-2}}$，\n- $1 \\, \\mathrm{AU} = 1.495978707 \\times 10^{11} \\, \\mathrm{m}$，\n- $M_\\oplus = 5.9722 \\times 10^{24} \\, \\mathrm{kg}$。\n\n将最终数值答案四舍五入至三位有效数字。以 $\\mathrm{m^2 \\, s^{-2}}$ 为单位表示您的最终值。",
            "solution": "该问题经评估在科学上是合理的、提法明确，并包含足够的信息以获得唯一解。这是天体力学中一个关于平均运动共振的标准问题。问题陈述中没有会使其无效的矛盾或含糊之处。\n\n任务是推导记为 $|R|$ 的共振策动力的大小的领导阶表达式，然后计算其值。共振策动力是内行星单位质量摄动函数 $\\mathcal{R}$ 中的共振项。行星2对行星1的摄动函数由下式给出：\n$$\n\\mathcal{R} = G m_2 \\left( \\frac{1}{|\\mathbf{r}_1 - \\mathbf{r}_2|} - \\frac{\\mathbf{r}_1 \\cdot \\mathbf{r}_2}{r_2^3} \\right)\n$$\n其中 $\\mathbf{r}_1$ 和 $\\mathbf{r}_2$ 是行星相对于中心恒星的位置矢量。\n\n这个函数通常用行星的轨道根数展开成傅里叶级数。问题指明了一个整数指数为 $j=3$ 的一阶（$q=1$ 阶）平均运动共振，对应于共振角 $\\phi = 3\\lambda_2 - 2\\lambda_1 - \\varpi_1$。这是一个 $3:2$ 共振，因为平运动之比 $n_1/n_2$ 近似为 $3/2$。轨道周期之比为 $P_2/P_1 \\approx 3/2$。指定的角度涉及内行星的近心点经度 $\\varpi_1$，并且是内行星偏心率 $e_1$ 的一阶项。\n\n根据长期摄动和共振摄动的标准理论（例如，如 Murray  Dermott 的《太阳系动力学》中所述），对于一个 $j:(j-1)$ 共振，摄动函数中作为内行星偏心率 $e_1$ 一阶项的共振项具有以下一般形式：\n$$\nR_{\\text{res}} = \\frac{G m_2}{a_2} C_{\\text{laplace}} e_1 \\cos(j\\lambda_2 - (j-1)\\lambda_1 - \\varpi_1)\n$$\n其中系数 $C_{\\text{laplace}}$ 是半长轴之比 $\\alpha = a_1/a_2$ 的一个无量纲函数，并且涉及拉普拉斯系数及其导数的组合。具体来说，对于受外行星摄动的内行星，自变量为 $j\\lambda_2 - (j-1)\\lambda_1 - \\varpi_1$ 的余弦项的系数是：\n$$\n\\text{Coeff} = -\\frac{G m_2}{a_2} \\frac{e_1}{2} \\left[ (2j-1) b_{1/2}^{(j)}(\\alpha) - 2\\alpha \\frac{d b_{1/2}^{(j)}(\\alpha)}{d\\alpha} \\right]\n$$\n问题给出 $j=3$。因此，共振项为：\n$$\nR_{\\text{res}} = -\\frac{G m_2 e_1}{2 a_2} \\left[ 5 b_{1/2}^{(3)}(\\alpha) - 2\\alpha \\frac{d b_{1/2}^{(3)}(\\alpha)}{d\\alpha} \\right] \\cos(3\\lambda_2 - 2\\lambda_1 - \\varpi_1)\n$$\n“共振策动力的大小” $|R|$ 被解释为此正弦项的振幅，它代表了其最大可能值。\n$$\n|R| = \\left| -\\frac{G m_2 e_1}{2 a_2} \\left[ 5 b_{1/2}^{(3)}(\\alpha) - 2\\alpha \\frac{d b_{1/2}^{(3)}(\\alpha)}{d\\alpha} \\right] \\right|\n$$\n$$\n|R| = \\frac{G m_2 e_1}{a_2} \\left| \\frac{1}{2} \\left[ 5 b_{1/2}^{(3)}(\\alpha) - 2\\alpha \\frac{d b_{1/2}^{(3)}(\\alpha)}{d\\alpha} \\right] \\right|\n$$\n问题为“乘以内行星 $q=1$ 共振偏心率项的拉普拉斯系数及其 $\\alpha$-导数的无量纲组合”提供了一个预先计算好的值 $c_{\\mathrm{res}} = 0.428$。根据我们推导的表达式，我们可以将 $c_{\\mathrm{res}}$ 确定为：\n$$\nc_{\\mathrm{res}} = \\left| \\frac{1}{2} \\left[ 5 b_{1/2}^{(3)}(\\alpha) - 2\\alpha \\frac{d b_{1/2}^{(3)}(\\alpha)}{d\\alpha} \\right] \\right|\n$$\n这使我们可以将共振策动力的大小的表达式简化为：\n$$\n|R| = \\frac{G m_2 e_1}{a_2} c_{\\mathrm{res}}\n$$\n这就是所要求的领导阶表达式。我们现在使用所提供的值进行数值计算，首先将所有量转换为国际单位制（SI）单位。\n引力常数为 $G = 6.67430 \\times 10^{-11} \\, \\mathrm{m^3 \\, kg^{-1} \\, s^{-2}}$。\n外行星的质量 $m_2$ 是地球质量 $M_\\oplus$ 的 $10.0$ 倍：\n$m_2 = 10.0 \\times (5.9722 \\times 10^{24} \\, \\mathrm{kg}) = 5.9722 \\times 10^{25} \\, \\mathrm{kg}$。\n内行星的偏心率为 $e_1 = 0.050$。\n外行星的半长轴 $a_2$ 为 $1.05$ 天文单位（AU）：\n$a_2 = 1.05 \\times (1.495978707 \\times 10^{11} \\, \\mathrm{m}) = 1.57077764235 \\times 10^{11} \\, \\mathrm{m}$。\n无量纲系数为 $c_{\\mathrm{res}} = 0.428$。\n\n将这些值代入我们的 $|R|$ 表达式中：\n$$\n|R| = \\frac{(6.67430 \\times 10^{-11} \\, \\mathrm{m^3 \\, kg^{-1} \\, s^{-2}}) \\times (5.9722 \\times 10^{25} \\, \\mathrm{kg}) \\times (0.050)}{1.57077764235 \\times 10^{11} \\, \\mathrm{m}} \\times 0.428\n$$\n让我们分步计算该值：\n分子中的乘积是：\n$G m_2 e_1 c_{\\mathrm{res}} = (6.67430 \\times 10^{-11}) \\times (5.9722 \\times 10^{25}) \\times (0.050) \\times (0.428)$\n$G m_2 e_1 c_{\\mathrm{res}} = 8.52827 \\times 10^{13} \\, \\mathrm{m^3 \\, kg^{-1} \\, s^{-2} \\cdot kg}$\n\n现在，我们除以 $a_2$：\n$$\n|R| = \\frac{8.52827 \\times 10^{13} \\, \\mathrm{m^3 \\, s^{-2}}}{1.57077764235 \\times 10^{11} \\, \\mathrm{m}}\n$$\n$$\n|R| = 542.924... \\, \\mathrm{m^2 \\, s^{-2}}\n$$\n问题要求将最终答案四舍五入到三位有效数字。\n$$\n|R| \\approx 543 \\, \\mathrm{m^2 \\, s^{-2}}\n$$\n$\\mathrm{m^2 \\, s^{-2}}$ 的单位是比能（单位质量的能量）的单位，这对于单位质量的摄动函数是正确的。",
            "answer": "$$\n\\boxed{543}\n$$"
        },
        {
            "introduction": "最后的这项实践将理论概念与实际应用相结合，模拟了系外行星科学家的工作流程。您将使用一个简化的凌日时间变化（TTV）模型——这是共振相互作用的一个关键观测特征——来推断行星质量 。接着，通过N体积分来检验您推断出的系统的动力学稳定性，您将体验到从模型推断到物理验证的完整循环，这是现代系外行星表征的核心。",
            "id": "4167343",
            "problem": "一对共面行星绕恒星运行时，表现出凌星时间变化（TTV），这与接近一阶平均运动共振（MMR）的情况相符。从牛顿引力和开普勒动力学出发，为近共振行星对建立领头阶共振TTV振幅标度模型，并推断行星质量。然后，通过对三体系统（恒星加两颗行星）的引力运动方程进行积分，并检查在相互希尔半径设定的阈值内没有发生近距离接近，来验证所推断构型的短期动力学稳定性。仅使用此处明确说明的假设，并通过在整个过程中保持量纲一致性和正确使用单位来确保科学真实性。\n\n基本和建模假设：\n- 牛顿万有引力定律：质点间的相互作用力大小为 $F = G \\, m_1 m_2 / r^2$，其中 $G$ 是引力常数，$m_1$ 和 $m_2$ 是质量，$r$ 是距离。\n- 开普勒第三定律（适用于行星质量相对于恒星可忽略不计的情况）：$a^3 = G M_\\star \\left( \\dfrac{P}{2\\pi} \\right)^2$，其中 $a$ 是半长轴，$M_\\star$ 是恒星质量，$P$ 是轨道周期。\n- 平均运动为 $n = 2\\pi / P$。\n- 对于一阶共振 $j:(j-1)$，与精确共振的相对距离定义为 $\\Delta = \\dfrac{P_2 / P_1}{j/(j-1)} - 1$，其中 $P_1$ 和 $P_2$ 分别是内侧和外侧行星的轨道周期，$j$ 是大于1的整数。\n- 在自由偏心率为零且共振系数为1量级的领头阶共振TTV近似中，TTV振幅 $\\delta t_1$ 和 $\\delta t_2$ 分别与扰动行星与恒星的质量比 $\\mu_2 = m_2 / M_\\star$ 和 $\\mu_1 = m_1 / M_\\star$ 成线性关系，并与 $|\\Delta|$ 成反比。具体来说，采用简化的领头阶关系式\n$$\n\\delta t_1 \\approx \\frac{P_1}{\\pi} \\frac{\\mu_2}{|\\Delta|}, \\qquad\n\\delta t_2 \\approx \\frac{P_2}{\\pi} \\frac{\\mu_1}{|\\Delta|},\n$$\n这意味着\n$$\n\\mu_2 \\approx \\frac{\\pi \\, |\\Delta| \\, \\delta t_1}{P_1}, \\qquad\n\\mu_1 \\approx \\frac{\\pi \\, |\\Delta| \\, \\delta t_2}{P_2}.\n$$\n这些关系式捕捉了主要的共振贡献，并且在自由偏心率小、系统接近但未精确处于共振状态（$\\Delta \\neq 0$）以及质量足够小以至于高阶项可以忽略不计的情况下有效。\n- 为了进行动力学稳定性验证，在平面三体问题中，在牛顿引力作用下传播行星轨道，由于恒星质量占主导地位，将其视为固定在原点，并考虑行星间的相互作用。将相互希尔半径定义为\n$$\nR_{\\mathrm{H}} = \\left( \\frac{m_1 + m_2}{3 M_\\star} \\right)^{1/3} \\left( \\frac{a_1 + a_2}{2} \\right),\n$$\n其中 $a_1$ 和 $a_2$ 是内外行星的半长轴，根据其周期使用开普勒第三定律计算得出。在积分区间内，计算行星间的最小瞬时距离 $d_{\\min}$，如果 $d_{\\min}  3 \\, R_{\\mathrm{H}}$，则宣布该构型是动力学稳定的。使用弧度作为角度单位。\n\n任务：\n1. 使用上述共振TTV近似，计算每个测试案例中行星质量 $m_1$ 和 $m_2$（单位为千克），并将其转换为地球质量 $M_\\oplus$。\n2. 根据给定的 $P_1$ 和 $P_2$ 计算 $a_1$ 和 $a_2$。\n3. 对恒星-行星-行星系统的平面牛顿运动方程进行固定时长的积分，并评估 $d_{\\min}$；然后使用 $3 R_{\\mathrm{H}}$ 阈值确定布尔稳定性标志。\n4. 生成最终输出，格式为单行逗号分隔列表，其中每个测试案例的结果是列表 $[m_1/M_\\oplus, m_2/M_\\oplus, \\text{stability}]$。\n\n物理单位和角度单位：\n- 周期 $P_1$ 和 $P_2$ 以 $\\mathrm{days}$ 为单位提供，在计算中必须转换为 $\\mathrm{s}$。\n- TTV振幅 $\\delta t_1$ 和 $\\delta t_2$ 以 $\\mathrm{s}$ 为单位提供。\n- 恒星质量 $M_\\star$ 以 $\\mathrm{kg}$ 为单位提供。\n- 最终质量以地球质量 $M_\\oplus$ 为单位表示为浮点数。\n- 使用 $\\mathrm{radians}$（弧度）作为角度单位。\n- 引力常数是 $G = 6.67430 \\times 10^{-11} \\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$。\n- 太阳质量是 $M_\\odot = 1.9885 \\times 10^{30} \\,\\mathrm{kg}$。\n- 地球质量是 $M_\\oplus = 5.9722 \\times 10^{24} \\,\\mathrm{kg}$。\n\n数值积分规范：\n- 使用标准常微分方程求解器对 $\\dot{\\mathbf{r}}_i = \\mathbf{v}_i$, $\\dot{\\mathbf{v}}_i = \\mathbf{a}_i$ 进行积分，其中\n$$\n\\mathbf{a}_1 = -\\frac{G M_\\star}{r_1^3} \\mathbf{r}_1 - G m_2 \\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{\\|\\mathbf{r}_1 - \\mathbf{r}_2\\|^3}, \\qquad\n\\mathbf{a}_2 = -\\frac{G M_\\star}{r_2^3} \\mathbf{r}_2 - G m_1 \\frac{\\mathbf{r}_2 - \\mathbf{r}_1}{\\|\\mathbf{r}_2 - \\mathbf{r}_1\\|^3}.\n$$\n在平面内初始化圆形轨道，角位置为 $\\lambda_1 = 0$ 和 $\\lambda_2 = \\pi/3$，切向速度大小为 $v_i = \\sqrt{G M_\\star / a_i}$。积分时长为 $T = 2000 \\,\\mathrm{days}$，并对距离进行充分采样以评估 $d_{\\min}$。\n\n测试套件：\n为以下三个测试案例提供结果，这些案例旨在探测不同的共振偏离度和TTV振幅：\n- 案例A（接近 $2{:}1$ 共振，中等 $\\Delta$）：$M_\\star = 1.9885 \\times 10^{30} \\,\\mathrm{kg}$, $j = 2$, $P_1 = 10 \\,\\mathrm{days}$, $P_2 = 20.6 \\,\\mathrm{days}$, $\\delta t_1 = 150 \\,\\mathrm{s}$, $\\delta t_2 = 100 \\,\\mathrm{s}$。\n- 案例B（接近 $3{:}2$ 共振，中等 $\\Delta$）：$M_\\star = 1.9885 \\times 10^{30} \\,\\mathrm{kg}$, $j = 3$, $P_1 = 12 \\,\\mathrm{days}$, $P_2 = 18.3 \\,\\mathrm{days}$, $\\delta t_1 = 200 \\,\\mathrm{s}$, $\\delta t_2 = 180 \\,\\mathrm{s}$。\n- 案例C（接近 $2{:}1$ 共振，小 $\\Delta$ 和小振幅）：$M_\\star = 1.9885 \\times 10^{30} \\,\\mathrm{kg}$, $j = 2$, $P_1 = 8 \\,\\mathrm{days}$, $P_2 = 16.05 \\,\\mathrm{days}$, $\\delta t_1 = 60 \\,\\mathrm{s}$, $\\delta t_2 = 45 \\,\\mathrm{s}$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个元素对应一个测试案例，其本身是一个形式为 $[m_1/M_\\oplus, m_2/M_\\oplus, \\text{stability}]$ 的列表。例如，一个包含三个案例的输出行应如下所示：$[[x_1,y_1,\\mathrm{True}],[x_2,y_2,\\mathrm{False}],[x_3,y_3,\\mathrm{True}]]$，其中 $x_i$ 和 $y_i$ 是浮点数。",
            "solution": "该问题要求对每个恒星-行星-行星系统的测试案例进行两部分分析。首先，我们使用提供的解析模型，根据凌星时间变化（TTV）数据推断行星质量。其次，我们通过对牛顿运动方程进行直接数值积分，来验证所推断系统的短期动力学稳定性。\n\n对于每个测试案例，解题过程系统地按以下步骤进行：\n1.  **质量推断**：根据给定的TTV振幅和轨道周期计算行星质量。\n2.  **稳定性分析设置**：计算半长轴和相互希尔半径，后者定义了稳定性阈值。\n3.  **数值积分与稳定性检查**：模拟系统的轨道演化，以找到行星间的最小距离，并将其与稳定性阈值进行比较。\n\n所有计算均使用国际单位制（SI）：质量单位为千克，距离单位为米，时间单位为秒。\n\n**物理常数和单位换算**\n在整个分析过程中使用以下常数：\n-   引力常数：$G = 6.67430 \\times 10^{-11} \\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$\n-   太阳质量：$M_\\odot = 1.9885 \\times 10^{30} \\,\\mathrm{kg}$\n-   地球质量：$M_\\oplus = 5.9722 \\times 10^{24} \\,\\mathrm{kg}$\n-   从天到秒的换算：$1 \\,\\mathrm{day} = 86400 \\,\\mathrm{s}$\n\n**步骤1：从TTV推断质量**\n\n问题提供了一个简化的领头阶模型，用于描述靠近一阶 $j:(j-1)$ 平均运动共振的行星的TTV振幅。行星与恒星的质量比 $\\mu_1 = m_1 / M_\\star$ 和 $\\mu_2 = m_2 / M_\\star$ 是利用这些关系推断出来的。\n\n首先，我们计算与精确共振的相对距离 $\\Delta$。对于一个周期为 $P_1$ 的内行星和一个周期为 $P_2$ 的外行星，在接近 $j:(j-1)$ 共振时，$\\Delta$ 定义为：\n$$\n\\Delta = \\frac{P_2 / P_1}{j/(j-1)} - 1\n$$\n关键是要以一致的单位（天或秒均可，因为它是一个比率）来使用周期 $P_1$ 和 $P_2$。\n\n接下来，我们使用提供的公式来计算行星与恒星的质量比 $\\mu_1$ 和 $\\mu_2$：\n$$\n\\mu_1 \\approx \\frac{\\pi \\, |\\Delta| \\, \\delta t_2}{P_2}\n$$\n$$\n\\mu_2 \\approx \\frac{\\pi \\, |\\Delta| \\, \\delta t_1}{P_1}\n$$\n在这些公式中，周期 $P_1, P_2$ 和TTV振幅 $\\delta t_1, \\delta t_2$ 必须以秒为单位，以保持量纲一致性。\n\n根据质量比，行星质量 $m_1$ 和 $m_2$ 可计算得出（单位为千克）：\n$$\nm_1 = \\mu_1 M_\\star\n$$\n$$\nm_2 = \\mu_2 M_\\star\n$$\n最后，将这些质量转换为地球质量（$M_\\oplus$）用于输出。\n\n**步骤2：稳定性分析设置**\n\n为了进行稳定性分析，我们首先确定行星轨道的半长轴 $a_1$ 和 $a_2$。在此计算中，假设行星质量与恒星相比可以忽略不计，我们使用开普勒第三定律：\n$$\na_i = \\left( G M_\\star \\left( \\frac{P_i}{2\\pi} \\right)^2 \\right)^{1/3}\n$$\n其中 $P_i$ 必须以秒为单位。\n\n系统的稳定性通过检查是否存在近距离接触来评估。临界距离由相互希尔半径 $R_\\mathrm{H}$ 定义：\n$$\nR_{\\mathrm{H}} = \\left( \\frac{m_1 + m_2}{3 M_\\star} \\right)^{1/3} \\left( \\frac{a_1 + a_2}{2} \\right)\n$$\n如果在积分期间，行星间的最小距离 $d_{\\min}$ 大于3倍的相互希尔半径，则认为系统是动力学稳定的：\n$$\nd_{\\min}  3 \\, R_{\\mathrm{H}}\n$$\n\n**步骤3：数值积分与稳定性检查**\n\n为了找到 $d_{\\min}$，我们对平面三体问题的运动方程进行积分。假设恒星固定在原点 $(0,0)$。系统的状态由两颗行星的位置矢量 $\\mathbf{r}_1, \\mathbf{r}_2$ 和速度矢量 $\\mathbf{v}_1, \\mathbf{v}_2$ 描述。系统的演化遵循牛顿第二定律 $\\dot{\\mathbf{v}}_i = \\mathbf{a}_i$，其中加速度由以下公式给出：\n$$\n\\mathbf{a}_1 = -\\frac{G M_\\star}{r_1^3} \\mathbf{r}_1 + G m_2 \\frac{\\mathbf{r}_2 - \\mathbf{r}_1}{\\|\\mathbf{r}_2 - \\mathbf{r}_1\\|^3}\n$$\n$$\n\\mathbf{a}_2 = -\\frac{G M_\\star}{r_2^3} \\mathbf{r}_2 + G m_1 \\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{\\|\\mathbf{r}_1 - \\mathbf{r}_2\\|^3}\n$$\n此处，$r_i = \\|\\mathbf{r}_i\\|$ 是行星 $i$ 到恒星的距离。\n\n积分时长为 $T = 2000$ 天。初始条件指定为在 $xy$ 平面内的圆形轨道，初始角位置（平近点经）为 $\\lambda_1 = 0$ 和 $\\lambda_2 = \\pi/3$。初始位置和速度矢量为：\n-   行星1（位于 $\\lambda_1 = 0$）：\n    -   $\\mathbf{r}_1(0) = (a_1, 0)$\n    -   $\\mathbf{v}_1(0) = (0, v_1)$，其中 $v_1 = \\sqrt{G M_\\star / a_1}$\n-   行星2（位于 $\\lambda_2 = \\pi/3$）：\n    -   $\\mathbf{r}_2(0) = (a_2 \\cos(\\pi/3), a_2 \\sin(\\pi/3))$\n    -   $\\mathbf{v}_2(0) = (-v_2 \\sin(\\pi/3), v_2 \\cos(\\pi/3))$，其中 $v_2 = \\sqrt{G M_\\star / a_2}$\n\n使用数值常微分方程（ODE）求解器来传播此初始状态。行星的位置会以固定的时间间隔被记录。在每一步计算行星间的瞬时距离 $d(t) = \\|\\mathbf{r}_2(t) - \\mathbf{r}_1(t)\\|$，并找出整个积分过程中的最小值 $d_{\\min}$。\n\n最后，如果 $d_{\\min}  3 \\, R_{\\mathrm{H}}$，则稳定性标志设为true，否则设为false。然后将每个测试案例的结果——两个行星的质量（以 $M_\\oplus$ 为单位）和布尔稳定性标志——编译成指定的输出格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It processes each case, infers planetary masses from TTV data,\n    and runs an N-body simulation to check for dynamical stability.\n    \"\"\"\n\n    # Physical Constants in SI units\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n    M_SOLAR = 1.9885e30  # kg\n    M_EARTH = 5.9722e24  # kg\n    DAY_S = 86400  # seconds in a day\n    AU = 1.496e11 # meters in an AU\n\n    # Test suite from the problem statement\n    test_cases = [\n        # Case A (near 2:1 resonance, moderate Delta)\n        {\n            \"M_star\": M_SOLAR, \"j\": 2, \"P1_days\": 10.0, \"P2_days\": 20.6,\n            \"dt1_s\": 150.0, \"dt2_s\": 100.0,\n        },\n        # Case B (near 3:2 resonance, moderate Delta)\n        {\n            \"M_star\": M_SOLAR, \"j\": 3, \"P1_days\": 12.0, \"P2_days\": 18.3,\n            \"dt1_s\": 200.0, \"dt2_s\": 180.0,\n        },\n        # Case C (near 2:1 resonance, small Delta and small amplitudes)\n        {\n            \"M_star\": M_SOLAR, \"j\": 2, \"P1_days\": 8.0, \"P2_days\": 16.05,\n            \"dt1_s\": 60.0, \"dt2_s\": 45.0,\n        },\n    ]\n\n    # This function defines the system of ODEs for the N-body problem.\n    def ode_system(t, y, G, M_star, m1, m2):\n        \"\"\"\n        Defines the differential equations for the planar 2-planet system.\n        The star is at the origin and is stationary.\n        State vector y = [x1, y1, x2, y2, vx1, vy1, vx2, vy2].\n        \"\"\"\n        r1_vec = y[0:2]\n        r2_vec = y[2:4]\n        v1_vec = y[4:6]\n        v2_vec = y[6:8]\n\n        r1_mag = np.linalg.norm(r1_vec)\n        r2_mag = np.linalg.norm(r2_vec)\n        r12_vec = r1_vec - r2_vec\n        r12_mag = np.linalg.norm(r12_vec)\n        \n        # Gravitational accelerations\n        # a_i = -G*M_star/r_i^3 * r_i + G*m_j * (r_j - r_i) / ||r_j - r_i||^3\n        a1_vec = -G * M_star * r1_vec / r1_mag**3 + G * m2 * (r2_vec - r1_vec) / r12_mag**3\n        a2_vec = -G * M_star * r2_vec / r2_mag**3 + G * m1 * (r1_vec - r2_vec) / r12_mag**3\n        \n        return np.concatenate((v1_vec, v2_vec, a1_vec, a2_vec))\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current case\n        M_star = case[\"M_star\"]\n        j = case[\"j\"]\n        P1_days, P2_days = case[\"P1_days\"], case[\"P2_days\"]\n        dt1_s, dt2_s = case[\"dt1_s\"], case[\"dt2_s\"]\n        \n        # Convert periods to seconds\n        P1_s = P1_days * DAY_S\n        P2_s = P2_days * DAY_S\n\n        # --- Step 1: Infer Planetary Masses ---\n        \n        # Calculate fractional distance to resonance, Delta\n        j_ratio = j / (j - 1)\n        period_ratio = P2_days / P1_days\n        delta = period_ratio / j_ratio - 1\n        \n        # Calculate planet-to-star mass ratios (mu)\n        mu1 = (np.pi * abs(delta) * dt2_s) / P2_s\n        mu2 = (np.pi * abs(delta) * dt1_s) / P1_s\n        \n        # Calculate planet masses in kg and Earth masses\n        m1_kg = mu1 * M_star\n        m2_kg = mu2 * M_star\n        m1_earth = m1_kg / M_EARTH\n        m2_earth = m2_kg / M_EARTH\n\n        # --- Step 2: Setup for Stability Analysis ---\n\n        # Calculate semimajor axes using Kepler's Third Law\n        a1 = (G * M_star * (P1_s / (2 * np.pi))**2)**(1/3)\n        a2 = (G * M_star * (P2_s / (2 * np.pi))**2)**(1/3)\n        \n        # Calculate mutual Hill radius\n        R_H = ((m1_kg + m2_kg) / (3 * M_star))**(1/3) * ((a1 + a2) / 2)\n        stability_threshold = 3 * R_H\n\n        # --- Step 3: Numerical Integration and Stability Check ---\n        \n        # Set initial conditions for circular orbits\n        v1_mag = np.sqrt(G * M_star / a1)\n        v2_mag = np.sqrt(G * M_star / a2)\n\n        lambda1_0 = 0.0\n        lambda2_0 = np.pi / 3.0\n\n        r1_0 = np.array([a1 * np.cos(lambda1_0), a1 * np.sin(lambda1_0)])\n        v1_0 = np.array([-v1_mag * np.sin(lambda1_0), v1_mag * np.cos(lambda1_0)])\n        \n        r2_0 = np.array([a2 * np.cos(lambda2_0), a2 * np.sin(lambda2_0)])\n        v2_0 = np.array([-v2_mag * np.sin(lambda2_0), v2_mag * np.cos(lambda2_0)])\n        \n        y0 = np.concatenate((r1_0, r2_0, v1_0, v2_0))\n\n        # Integrate the equations of motion\n        integration_duration_s = 2000 * DAY_S\n        t_span = (0, integration_duration_s)\n        # Sample sufficiently to find the minimum distance\n        t_eval = np.linspace(t_span[0], t_span[1], 20001)\n\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=t_span,\n            y0=y0,\n            args=(G, M_star, m1_kg, m2_kg),\n            t_eval=t_eval,\n            method='RK45', # A standard choice\n            rtol=1e-8, atol=1e-8\n        )\n        \n        # Calculate minimum separation\n        r1_sol = sol.y[0:2, :]\n        r2_sol = sol.y[2:4, :]\n        separations = np.linalg.norm(r2_sol - r1_sol, axis=0)\n        d_min = np.min(separations)\n        \n        # Determine stability\n        is_stable = d_min > stability_threshold\n        \n        results.append([m1_earth, m2_earth, is_stable])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    print(results)\n\nsolve()\n```"
        }
    ]
}