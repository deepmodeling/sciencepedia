{
    "hands_on_practices": [
        {
            "introduction": "要解读系外行星的光谱，我们必须首先理解光谱线形成的基本过程。本练习将大气简化为一个等温板，让我们能够从第一性原理出发，推导出气体板层的温度与背景光源之间的反差如何决定了我们观测到的是吸收线还是发射线。通过求解辐射转移方程，你将对创造我们所观测到的光谱特征的物理条件建立起核心理解 。",
            "id": "4152756",
            "problem": "考虑一个平行平面的、等温的系外行星大气层，我们在频率为 $\\nu_{0}$ 的单条谱线中心对其进行观测。该大气层的总谱线中心光学深度为 $\\tau_{0}$，这是从上边界（$\\tau=0$）到底边界（$\\tau=\\tau_{0}$）沿向外表面法线方向测量的。假设局域热动平衡 (LTE)，因此谱线源函数在空间上是常数，等于谱线中心的普朗克函数，$S_{0} = B_{\\nu_{0}}(T)$，其中 $T$ 是大气层的均匀温度。在频率 $\\nu_{0}$ 处，忽略大气层内的散射和任何连续谱不透明度；唯一的消光和发射都由该谱线引起。底边界（$\\tau=\\tau_{0}$）被一个背景连续谱源从下方照亮，其在频率 $\\nu_{0}$ 处的向外比辐射强度为 $I_{c}$，且上方没有入射辐射。\n\n从频率 $\\nu_{0}$ 处沿向外法线方向的一维辐射转移方程和适当的边界条件出发，推导出从大气层顶部出射的谱线中心比辐射强度 $I_{\\nu_{0}}(0)$，将其表示为 $\\tau_{0}$、$B_{\\nu_{0}}(T)$ 和 $I_{c}$ 的函数。然后，利用你推导出的表达式，确定当 $\\tau_{0}$ 变化时的吸收区和发射区，并根据 $B_{\\nu_{0}}(T)$ 和 $I_{c}$ 的相对大小，解释在 $\\tau_{0}$ 很小和很大时的极限行为。\n\n将你的最终答案表示为 $I_{\\nu_{0}}(0)$ 关于 $I_{c}$、$B_{\\nu_{0}}(T)$ 和 $\\tau_{0}$ 的单个闭式解析表达式。不要代入数值。",
            "solution": "该问题具有科学依据、是适定的、客观的，并包含了得到唯一解所需的所有信息。在局域热动平衡（LTE）下，关于平行平面、等温大气层的假设是天体物理学中用于辐射转移建模的标准近似方法。因此，该问题是有效的。\n\n一维辐射转移方程（RTE）描述了比辐射强度 $I_{\\nu}$ 沿路径的变化。对于本问题，我们考虑谱线中心频率 $\\nu_0$ 处的辐射。光学深度 $\\tau$ 被定义为在大气层顶部 $\\tau=0$，并向下增加到底部的 $\\tau=\\tau_0$。我们关心的是沿向外法线传播的强度，也就是 $\\tau$ 减小的方向。对于沿法线方向（$\\mu=1$）传播的光线，其辐射转移方程（RTE）为：\n$$ \\frac{dI_{\\nu_0}(\\tau)}{d\\tau} = I_{\\nu_0}(\\tau) - S_0 $$\n其中 $I_{\\nu_0}(\\tau)$ 是在光学深度 $\\tau$ 处的比辐射强度，$S_0$ 是谱线中心的源函数。\n\n问题陈述该大气层处于LTE状态并且是等温的，具有均匀温度 $T$。在LTE下，源函数等于普朗克函数，并且由于温度恒定，源函数在空间上也是常数：\n$$ S_0 = B_{\\nu_0}(T) $$\n其中 $B_{\\nu_0}(T)$ 是在频率 $\\nu_0$ 和温度 $T$ 下计算的普朗克函数。因此，RTE 是一个带常数项的一阶线性常微分方程：\n$$ \\frac{dI_{\\nu_0}(\\tau)}{d\\tau} - I_{\\nu_0}(\\tau) = -B_{\\nu_0}(T) $$\n为了解此方程，我们使用积分因子 $\\rho(\\tau) = \\exp\\left(\\int (-1) d\\tau\\right) = \\exp(-\\tau)$。将RTE乘以积分因子，得到：\n$$ \\exp(-\\tau) \\frac{dI_{\\nu_0}(\\tau)}{d\\tau} - \\exp(-\\tau) I_{\\nu_0}(\\tau) = -B_{\\nu_0}(T) \\exp(-\\tau) $$\n方程左边可以写成一个乘积的导数：\n$$ \\frac{d}{d\\tau} \\left( I_{\\nu_0}(\\tau) \\exp(-\\tau) \\right) = -B_{\\nu_0}(T) \\exp(-\\tau) $$\n我们可以在大气层内任意两点 $\\tau$ 和 $\\tau_0$ 之间对这个方程进行积分：\n$$ \\int_{\\tau}^{\\tau_0} \\frac{d}{d\\tau'} \\left( I_{\\nu_0}(\\tau') \\exp(-\\tau') \\right) d\\tau' = \\int_{\\tau}^{\\tau_0} -B_{\\nu_0}(T) \\exp(-\\tau') d\\tau' $$\n$$ I_{\\nu_0}(\\tau_0) \\exp(-\\tau_0) - I_{\\nu_0}(\\tau) \\exp(-\\tau) = B_{\\nu_0}(T) (\\exp(-\\tau_0) - \\exp(-\\tau)) $$\n现在我们求解 $I_{\\nu_0}(\\tau)$：\n$$ I_{\\nu_0}(\\tau) \\exp(-\\tau) = I_{\\nu_0}(\\tau_0) \\exp(-\\tau_0) - B_{\\nu_0}(T) \\exp(-\\tau_0) + B_{\\nu_0}(T) \\exp(-\\tau) $$\n$$ I_{\\nu_0}(\\tau) = I_{\\nu_0}(\\tau_0) \\exp(-(\\tau_0 - \\tau)) + B_{\\nu_0}(T) (1 - \\exp(-(\\tau_0 - \\tau))) $$\n这是RTE的形式解。代入边界条件 $I_{\\nu_0}(\\tau_0) = I_c$：\n$$ I_{\\nu_0}(\\tau) = I_c \\exp(-(\\tau_0 - \\tau)) + B_{\\nu_0}(T) (1 - \\exp(-(\\tau_0 - \\tau))) $$\n问题要求的是从大气层顶部出射的比辐射强度，即 $I_{\\nu_0}(0)$。我们在 $\\tau = 0$ 处计算该表达式的值：\n$$ I_{\\nu_0}(0) = I_c \\exp(-\\tau_0) + B_{\\nu_0}(T) (1 - \\exp(-\\tau_0)) $$\n这就是出射强度的最终表达式。\n\n接下来，我们分析吸收区和发射区。如果出射强度小于背景连续谱，$I_{\\nu_0}(0)  I_c$，则观测到吸收谱线。如果 $I_{\\nu_0}(0) > I_c$，则观测到发射谱线。我们考察差值 $I_{\\nu_0}(0) - I_c$：\n$$ I_{\\nu_0}(0) - I_c = I_c \\exp(-\\tau_0) + B_{\\nu_0}(T) (1 - \\exp(-\\tau_0)) - I_c $$\n$$ I_{\\nu_0}(0) - I_c = I_c (\\exp(-\\tau_0) - 1) + B_{\\nu_0}(T) (1 - \\exp(-\\tau_0)) $$\n$$ I_{\\nu_0}(0) - I_c = -I_c (1 - \\exp(-\\tau_0)) + B_{\\nu_0}(T) (1 - \\exp(-\\tau_0)) $$\n$$ I_{\\nu_0}(0) - I_c = (B_{\\nu_0}(T) - I_c) (1 - \\exp(-\\tau_0)) $$\n由于光学深度 $\\tau_0$ 必须为非负，项 $(1 - \\exp(-\\tau_0))$ 总是大于或等于 0。假设 $\\tau_0 > 0$，那么 $I_{\\nu_0}(0) - I_c$ 的符号完全由 $(B_{\\nu_0}(T) - I_c)$ 的符号决定。\n- **吸收区：** 当 $B_{\\nu_0}(T) - I_c  0$，即 $B_{\\nu_0}(T)  I_c$ 时，出现吸收线（$I_{\\nu_0}(0)  I_c$）。物理上，这意味着大气层比背景源“更冷”，因此它从背景吸收的辐射多于其自身发射的辐射，造成了强度亏损。\n- **发射区：** 当 $B_{\\nu_0}(T) - I_c > 0$，即 $B_{\\nu_0}(T) > I_c$ 时，出现发射线（$I_{\\nu_0}(0) > I_c$）。物理上，这意味着大气层比背景源“更热”，因此它发射的辐射多于从背景吸收的辐射，造成了强度超出。\n- **无谱线特征：** 如果 $B_{\\nu_0}(T) = I_c$，那么对于任何 $\\tau_0$，$I_{\\nu_0}(0) = I_c$。大气层与背景处于辐射平衡状态，不会产生谱线特征。\n\n最后，我们分析 $\\tau_0$ 很小和很大时的极限行为。\n- **光学薄极限 ($\\tau_0 \\ll 1$)：**\n对于小的 $\\tau_0$，我们可以使用一阶泰勒展开 $\\exp(-\\tau_0) \\approx 1 - \\tau_0$。将此代入 $I_{\\nu_0}(0)$ 的表达式中：\n$$ I_{\\nu_0}(0) \\approx I_c (1 - \\tau_0) + B_{\\nu_0}(T) (1 - (1 - \\tau_0)) $$\n$$ I_{\\nu_0}(0) \\approx I_c - I_c \\tau_0 + B_{\\nu_0}(T) \\tau_0 $$\n$$ I_{\\nu_0}(0) \\approx I_c + (B_{\\nu_0}(T) - I_c) \\tau_0 $$\n在光学薄极限下，谱线强度 $|I_{\\nu_0}(0) - I_c|$ 与光学深度 $\\tau_0$ 成正比。大气层基本上是透明的，其强度与连续谱水平的偏离很小。\n\n- **光学厚极限 ($\\tau_0 \\gg 1$)：**\n对于大的 $\\tau_0$，项 $\\exp(-\\tau_0)$ 趋近于 0。$I_{\\nu_0}(0)$ 的表达式变为：\n$$ \\lim_{\\tau_0 \\to \\infty} I_{\\nu_0}(0) = I_c \\cdot 0 + B_{\\nu_0}(T) (1 - 0) = B_{\\nu_0}(T) $$\n在光学厚极限下，出射强度等于大气层温度下的普朗克函数。大气层是不透明的，因此来自背景源 $I_c$ 的辐射无法穿过。观测者只能看到来自大气层顶层的热辐射，此时谱线被称为饱和。谱线中心的强度下降或上升到普朗克函数 $B_{\\nu_0}(T)$ 的值，而与背景强度无关。",
            "answer": "$$\n\\boxed{I_c \\exp(-\\tau_0) + B_{\\nu_0}(T) (1 - \\exp(-\\tau_0))}\n$$"
        },
        {
            "introduction": "一条光谱线的强度并非静止不变，而是对大气温度高度敏感。本练习超越了简单的“热”与“冷”的图像，深入到微观细节，探讨温度如何通过三种相互竞争的机制影响谱线强度：分子在所有能级间的分配、特定跃迁低能级的布居数，以及受激辐射的修正。通过计算水蒸气谱线强度的变化，你将能定量分析这些效应，并培养出为何不同谱线能成为不同温度范围的良好“温度计”的直觉 。",
            "id": "4152772",
            "problem": "观测到一个在透射光谱中以水蒸气为主的受辐照系外行星大气。考虑水的单个转振跃迁，其谱线中心波数为 $\\tilde{\\nu}_0$，低能态项值为 $E_l$（两者均以反厘米为单位），并假设在所考虑的温度范围内，吸收柱中的水分子总数不随温度变化。忽略谱线线型效应、压力致宽以及跃迁偶极矩的任何温度依赖性；假设系统处于电子基态和热平衡状态。积分谱线强度 $S(T)$（每个分子）取决于低能态的粒子数分数、由分子配分函数 $Q(T)$ 表征的能级分配以及受激发射修正。\n\n使用列表给出的水蒸气配分函数值 $Q(T)$ 和以下光谱常数：\n- $\\tilde{\\nu}_0 = 1595~\\mathrm{cm}^{-1}$，\n- $E_l = 500~\\mathrm{cm}^{-1}$，\n- $Q(500~\\mathrm{K}) = 5.30 \\times 10^{2}$，\n- $Q(1500~\\mathrm{K}) = 5.20 \\times 10^{3}$，\n- $c_2 \\equiv \\dfrac{h c}{k_B} = 1.438777~\\mathrm{cm \\cdot K}$，\n\n从第一性原理推导积分谱线强度之比 $R \\equiv \\dfrac{S(1500~\\mathrm{K})}{S(500~\\mathrm{K})}$ 的表达式，对 $R$进行数值计算，并根据低能态粒子数和受激发射效应简要解释其变化的符号和大小。将最终比值表示为一个四舍五入到四位有效数字的无量纲数。",
            "solution": "该问题是有效的，因为它科学地基于分子光谱学和统计力学的原理，问题陈述清晰且提供了所有必要的数据，并且其表述是客观的。\n\n在温度 $T$ 下，从低能态 $l$到高能态 $u$ 的转振跃迁的积分谱线强度 $S(T)$，与处于低能态的吸收分子数成正比，并经过受激发射校正。从第一性原理出发，$S(T)$ 的表达式（单位为 $\\mathrm{cm}^{-1}/(\\mathrm{molecule \\cdot cm^{-2}})$）可以写为：\n$$\nS(T) = \\frac{C_0}{Q(T)} g_l \\exp\\left(-\\frac{E_l}{k_B T}\\right) \\left[1 - \\exp\\left(-\\frac{h c \\tilde{\\nu}_0}{k_B T}\\right)\\right]\n$$\n此处，$C_0$ 是一个包含基本物理常数和跃迁偶极矩的常数，假设其与温度无关。$Q(T)$ 是分子在温度 $T$ 下的总内配分函数。$g_l$ 是低能态 $l$ 的简并度，$E_l$ 是其能量。根据问题的假设，对于给定的能态，$g_l$ 是一个常数。$\\tilde{\\nu}_0$ 是跃迁谱线中心的波数。项 $\\exp\\left(-\\frac{E_l}{k_B T}\\right)$ 是低能态的玻尔兹曼因子。项 $\\left[1 - \\exp\\left(-\\frac{h c \\tilde{\\nu}_0}{k_B T}\\right)\\right]$ 用于解释受激发射效应，其中 $h c \\tilde{\\nu}_0$ 是高能态和低能态之间的能量差。\n\n问题以 $\\mathrm{cm}^{-1}$ 为单位提供了能量 ($E_l$) 和波数 ($\\tilde{\\nu}_0$)。这是光谱学中的一个常见约定。为了在指数项中直接使用这些值，我们使用第二辐射常数 $c_2 \\equiv \\frac{h c}{k_B}$，其单位为 $\\mathrm{cm \\cdot K}$。指数项因此可以写为 $-\\frac{c_2 E_l}{T}$ 和 $-\\frac{c_2 \\tilde{\\nu}_0}{T}$，其中 $E_l$ 和 $\\tilde{\\nu}_0$ 是以 $\\mathrm{cm}^{-1}$ 为单位的数值。\n\n因此，$S(T)$ 的表达式可以写成一个比例形式，将所有与温度无关的项归为一个常数 $C$：\n$$\nS(T) \\propto \\frac{1}{Q(T)} \\exp\\left(-\\frac{c_2 E_l}{T}\\right) \\left[1 - \\exp\\left(-\\frac{c_2 \\tilde{\\nu}_0}{T}\\right)\\right]\n$$\n我们需要计算比值 $R \\equiv \\frac{S(T_2)}{S(T_1)}$，其中 $T_1 = 500~\\mathrm{K}$，$T_2 = 1500~\\mathrm{K}$。构建这个比值可以消去比例常数 $C$：\n$$\nR = \\frac{\\frac{1}{Q(T_2)} \\exp\\left(-\\frac{c_2 E_l}{T_2}\\right) \\left[1 - \\exp\\left(-\\frac{c_2 \\tilde{\\nu}_0}{T_2}\\right)\\right]}{\\frac{1}{Q(T_1)} \\exp\\left(-\\frac{c_2 E_l}{T_1}\\right) \\left[1 - \\exp\\left(-\\frac{c_2 \\tilde{\\nu}_0}{T_1}\\right)\\right]}\n$$\n重新整理这个表达式得到：\n$$\nR = \\left(\\frac{Q(T_1)}{Q(T_2)}\\right) \\cdot \\left(\\frac{\\exp\\left(-\\frac{c_2 E_l}{T_2}\\right)}{\\exp\\left(-\\frac{c_2 E_l}{T_1}\\right)}\\right) \\cdot \\left(\\frac{1 - \\exp\\left(-\\frac{c_2 \\tilde{\\nu}_0}{T_2}\\right)}{1 - \\exp\\left(-\\frac{c_2 \\tilde{\\nu}_0}{T_1}\\right)}\\right)\n$$\n这个表达式可以进一步简化为：\n$$\nR = \\frac{Q(T_1)}{Q(T_2)} \\cdot \\exp\\left[c_2 E_l \\left(\\frac{1}{T_1} - \\frac{1}{T_2}\\right)\\right] \\cdot \\frac{1 - \\exp\\left(-\\frac{c_2 \\tilde{\\nu}_0}{T_2}\\right)}{1 - \\exp\\left(-\\frac{c_2 \\tilde{\\nu}_0}{T_1}\\right)}\n$$\n现在我们代入给定的值：\n-   $T_1 = 500~\\mathrm{K}$\n-   $T_2 = 1500~\\mathrm{K}$\n-   $\\tilde{\\nu}_0 = 1595~\\mathrm{cm}^{-1}$\n-   $E_l = 500~\\mathrm{cm}^{-1}$\n-   $Q(T_1) = 5.30 \\times 10^{2}$\n-   $Q(T_2) = 5.20 \\times 10^{3}$\n-   $c_2 = 1.438777~\\mathrm{cm \\cdot K}$\n\n首先，我们计算指数函数的自变量：\n对于低能态粒子数项：\n-   $c_2 E_l \\left(\\frac{1}{T_1} - \\frac{1}{T_2}\\right) = (1.438777~\\mathrm{cm \\cdot K}) \\cdot (500~\\mathrm{cm}^{-1}) \\cdot \\left(\\frac{1}{500~\\mathrm{K}} - \\frac{1}{1500~\\mathrm{K}}\\right) = 719.3885 \\cdot \\left(\\frac{2}{1500}\\right) = 0.9591846\\bar{6}$\n\n对于受激发射项：\n-   $\\frac{c_2 \\tilde{\\nu}_0}{T_1} = \\frac{(1.438777~\\mathrm{cm \\cdot K}) \\cdot (1595~\\mathrm{cm}^{-1})}{500~\\mathrm{K}} = 4.58969863$\n-   $\\frac{c_2 \\tilde{\\nu}_0}{T_2} = \\frac{(1.438777~\\mathrm{cm \\cdot K}) \\cdot (1595~\\mathrm{cm}^{-1})}{1500~\\mathrm{K}} = 1.52989954\\bar{3}$\n\n现在，我们计算对 $R$ 有贡献的三个因子：\n1.  配分函数之比：\n    $$ \\frac{Q(T_1)}{Q(T_2)} = \\frac{5.30 \\times 10^{2}}{5.20 \\times 10^{3}} = \\frac{530}{5200} \\approx 0.101923 $$\n2.  玻尔兹曼因子之比（低能态粒子数）：\n    $$ \\exp\\left[c_2 E_l \\left(\\frac{1}{T_1} - \\frac{1}{T_2}\\right)\\right] = \\exp(0.9591846\\bar{6}) \\approx 2.60959 $$\n3.  受激发射修正因子之比：\n    $$ \\frac{1 - \\exp\\left(-\\frac{c_2 \\tilde{\\nu}_0}{T_2}\\right)}{1 - \\exp\\left(-\\frac{c_2 \\tilde{\\nu}_0}{T_1}\\right)} = \\frac{1 - \\exp(-1.52989954\\bar{3})}{1 - \\exp(-4.58969863)} = \\frac{1 - 0.2165538}{1 - 0.0101565} = \\frac{0.7834462}{0.9898435} \\approx 0.791485 $$\n\n将这三个因子相乘得到比值 $R$：\n$$ R \\approx (0.101923) \\cdot (2.60959) \\cdot (0.791485) \\approx 0.210534 $$\n四舍五入到四位有效数字，我们得到 $R = 0.2105$。\n\n结果解释：\n比值 $R$ 远小于 1，表明这条谱线的积分强度在 $1500~\\mathrm{K}$ 的较高温度下比在 $500~\\mathrm{K}$ 时要弱得多。这种变化是三种相互竞争的、与温度相关的效应共同作用的结果：\n1.  **配分函数 ($Q(T)$)**：配分函数从 $530$ 增加到 $5200$，增加了约 $9.8$ 倍。由于 $S(T) \\propto 1/Q(T)$，这种效应通过在较高温度下将分子分布到更多可及的转振动态上，从而极大地稀释了任何单个能态上的粒子数。这是主导效应，导致谱线强度急剧下降，对比值贡献了约 $0.102$ 的因子。\n2.  **低能态粒子数（玻尔兹曼因子）**：对于一个具有非零能量 $E_l = 500~\\mathrm{cm}^{-1}$ 的能态，玻尔兹曼因子 $\\exp(-c_2 E_l/T)$ 随温度升高而增加。更多的热能可用于布居这个激发态。这种效应增加了谱线强度，对比值贡献了约 $2.61$ 的因子。\n3.  **受激发射**：受激发射修正因子 $1 - \\exp(-c_2 \\tilde{\\nu}_0/T)$ 随温度升高而减小，因为高能态的粒子数变得更加显著，增加了与吸收相抗衡的受激发射速率。这种效应降低了净谱线强度，对比值贡献了约 $0.791$ 的因子。\n\n由配分函数增长引起的强烈粒子数稀释效应（因子 $0.102$）远远超过了低能态玻尔兹曼因子带来的增长效应（因子 $2.61$），导致谱线强度的净减少。增强的受激发射进一步降低了强度。$1500~\\mathrm{K}$ 时的最终强度约为其在 $500~\\mathrm{K}$ 时值的 $21\\%$。",
            "answer": "$$\\boxed{0.2105}$$"
        },
        {
            "introduction": "观测光谱的最终目标是反演如温度和分子丰度等物理参数，但这些参数之间可能存在简并性，即不同的参数组合可能产生相似的光谱。这项高级练习介绍了一种强大的统计工具——费雪信息矩阵（Fisher Information Matrix），来量化这种简并性。你将学习如何策略性地选择具有不同温度敏感度的光谱线组合，以最小化参数简并性，从而设计出更稳健、信息量更丰富的观测方案 。",
            "id": "4152748",
            "problem": "您的任务是使用谱线比和互补谱线选择，在来自系外行星大气的、光学薄的局域热力学平衡（LTE）发射中，评估大气温度和分子丰度的可辨识性。设定如下：在局域热力学平衡（LTE）下，对于一个低能态能量以波数 $\\tilde{\\nu}$（单位为 $\\mathrm{cm}^{-1}$）表示的跃迁，其低能级的布居数遵循玻尔兹曼分布，该分子的配分函数为 $Q(T)$。对于光学薄极限下的单一分子种类，谱线 $i$ 的积分谱线强度模型为\n$$\nI_i(A,T) = A \\, K_i \\, T^{-\\beta} \\exp\\left(-\\frac{E_i}{k_B T}\\right),\n$$\n其中，$A$ 是与视线方向上的分子柱密度成正比的（无量纲）丰度因子，$K_i$ 是一个已知的谱线特定常数（无量纲，包含谱线强度和仪器响应），$T$ 是温度（单位为 $\\mathrm{K}$），$\\beta$ 是配分函数指数（对于像水蒸气这样的非线性转子，取 $Q(T) \\propto T^\\beta$ 并使用 $\\beta = 1.5$），$E_i$ 是低能态能量（单位为 $\\mathrm{J}$），由 $E_i = h c \\tilde{\\nu}_i$ 给出，$h$ 是普朗克常数（单位为 $\\mathrm{J}\\,\\mathrm{s}$），$c$ 是光速（单位为 $\\mathrm{cm}/\\mathrm{s}$），$k_B$ 是玻尔兹曼常数（单位为 $\\mathrm{J}/\\mathrm{K}$）。假设每条谱线 $i$ 的测量噪声是独立的，服从高斯分布，其方差为 $\\sigma_i^2$，单位与 $I_i$ 相同。谱线比 $R_{ij} = I_i/I_j$ 消除了 $A$ 但通过能量差 $\\Delta E_{ij} = E_i - E_j$ 保留了对温度的依赖性，如果 $E_i \\approx E_j$，这种依赖性可能很弱，从而导致简并性。\n\n将参数矢量定义为 $\\boldsymbol{\\theta} = [\\ln A,\\, T]^\\top$。在给定的 $(A,T)$ 下，谱线 $i$ 相对于 $\\boldsymbol{\\theta}$ 的雅可比矩阵为\n$$\n\\mathbf{J}_i = \n\\begin{bmatrix}\n\\frac{\\partial I_i}{\\partial \\ln A} \\\\\n\\frac{\\partial I_i}{\\partial T}\n\\end{bmatrix}^\\top\n=\n\\begin{bmatrix}\nI_i(A,T) \\\\\nI_i(A,T)\\left(-\\frac{\\beta}{T} + \\frac{E_i}{k_B T^2}\\right)\n\\end{bmatrix}^\\top.\n$$\n对于一组谱线，将这些行堆叠起来形成 $\\mathbf{J} \\in \\mathbb{R}^{N \\times 2}$，其中 $N$ 是谱线的数量。使用对角权重矩阵 $\\mathbf{W} = \\mathrm{diag}(1/\\sigma_1^2,\\dots,1/\\sigma_N^2)$，费雪信息矩阵为\n$$\n\\mathbf{F} = \\mathbf{J}^\\top \\mathbf{W} \\mathbf{J}.\n$$\n使用 2-范数条件数 $\\kappa(\\mathbf{F})$ 作为可辨识性度量，其定义为 $\\mathbf{F}$ 的最大奇异值与最小奇异值之比。较小的 $\\kappa(\\mathbf{F})$ 表示更好的可辨识性（较低的简并性）。您的任务是计算基准谱线对的 $\\kappa(\\mathbf{F})$，然后从一个候选集中选择一条互补的第三条谱线，使得组合后的三谱线集的 $\\kappa(\\mathbf{F})$ 最小。\n\n在您的计算中使用以下物理常数：\n- $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J}\\,\\mathrm{s}$，\n- $c = 2.99792458 \\times 10^{10}\\ \\mathrm{cm}/\\mathrm{s}$，\n- $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J}/\\mathrm{K}$。\n\n所有能量必须使用 $E = h c \\tilde{\\nu}$ 从波数计算得出，其中 $\\tilde{\\nu}$ 的单位为 $\\mathrm{cm}^{-1}$。所有温度必须以 $\\mathrm{K}$ 为单位。丰度 $A$ 是无量纲的。可辨识性度量 $\\kappa(\\mathbf{F})$ 是无量纲的。\n\n实现一个程序，针对每个测试用例执行以下步骤：\n1. 使用给定的 $(A,T)$、$\\beta$、$\\{K_i\\}$ 和 $\\{\\sigma_i\\}$，计算基准双谱线集的 $\\kappa(\\mathbf{F})$。\n2. 对于每个候选的第三条谱线，计算由基准谱线对加上该候选谱线形成的三谱线集的 $\\kappa(\\mathbf{F})$。选择能产生最小 $\\kappa(\\mathbf{F})$ 的候选谱线，并记录这个最小化的 $\\kappa(\\mathbf{F})$ 和所选候选谱线的索引（从0开始）。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对于每个测试用例，输出一个包含三个值的列表 $[\\kappa_2, \\kappa_3^{\\ast}, i^\\ast]$，其中 $\\kappa_2$ 是基准谱线对的条件数，$\\kappa_3^{\\ast}$ 是最佳三谱线组合的条件数，而 $i^\\ast$ 是所选候选谱线的索引。因此，最终输出应看起来像一个列表的列表，例如 $[[\\kappa_2^{(1)}, \\kappa_3^{\\ast(1)}, i^{\\ast(1)}],[\\kappa_2^{(2)}, \\kappa_3^{\\ast(2)}, i^{\\ast(2)}],\\dots]$。所有条目必须是实数（对于条件数）和整数（对于索引）。\n\n使用以下具有科学上合理参数的测试套件。在所有情况下，分子都是水蒸气，$\\beta = 1.5$。\n\n测试用例 1 (理想情况：能量分离良好):\n- 真实参数：$A = 1.0 \\times 10^{-6}$ (无量纲)，$T = 1000\\ \\mathrm{K}$。\n- 基准谱线：\n  - 谱线 1：$\\tilde{\\nu}_1 = 1000\\ \\mathrm{cm}^{-1}$, $K_1 = 1.0$, $\\sigma_1 = 1.0 \\times 10^{-13}$。\n  - 谱线 2：$\\tilde{\\nu}_2 = 3000\\ \\mathrm{cm}^{-1}$, $K_2 = 0.7$, $\\sigma_2 = 1.0 \\times 10^{-13}$。\n- 候选第三条谱线 (索引 $0,1,2$):\n  - 候选 0：$\\tilde{\\nu} = 500\\ \\mathrm{cm}^{-1}$, $K = 0.5$, $\\sigma = 1.0 \\times 10^{-13}$。\n  - 候选 1：$\\tilde{\\nu} = 4500\\ \\mathrm{cm}^{-1}$, $K = 1.2$, $\\sigma = 1.0 \\times 10^{-13}$。\n  - 候选 2：$\\tilde{\\nu} = 8000\\ \\mathrm{cm}^{-1}$, $K = 0.9$, $\\sigma = 1.0 \\times 10^{-13}$。\n\n测试用例 2 (基准能量近简并；评估互补谱线的必要性):\n- 真实参数：$A = 2.0 \\times 10^{-6}$，$T = 800\\ \\mathrm{K}$。\n- 基准谱线：\n  - 谱线 1：$\\tilde{\\nu}_1 = 2000\\ \\mathrm{cm}^{-1}$, $K_1 = 1.0$, $\\sigma_1 = 1.0 \\times 10^{-13}$。\n  - 谱线 2：$\\tilde{\\nu}_2 = 2005\\ \\mathrm{cm}^{-1}$, $K_2 = 1.0$, $\\sigma_2 = 1.0 \\times 10^{-13}$。\n- 候选第三条谱线 (索引 $0,1,2$):\n  - 候选 0：$\\tilde{\\nu} = 100\\ \\mathrm{cm}^{-1}$, $K = 0.8$, $\\sigma = 1.0 \\times 10^{-13}$。\n  - 候选 1：$\\tilde{\\nu} = 5000\\ \\mathrm{cm}^{-1}$, $K = 1.1$, $\\sigma = 1.0 \\times 10^{-13}$。\n  - 候选 2：$\\tilde{\\nu} = 10000\\ \\mathrm{cm}^{-1}$, $K = 0.7$, $\\sigma = 1.0 \\times 10^{-13}$。\n\n测试用例 3 (低温边界；评估能量杠杆作用):\n- 真实参数：$A = 5.0 \\times 10^{-7}$，$T = 300\\ \\mathrm{K}$。\n- 基准谱线：\n  - 谱线 1：$\\tilde{\\nu}_1 = 300\\ \\mathrm{cm}^{-1}$, $K_1 = 0.6$, $\\sigma_1 = 1.0 \\times 10^{-14}$。\n  - 谱线 2：$\\tilde{\\nu}_2 = 320\\ \\mathrm{cm}^{-1}$, $K_2 = 0.6$, $\\sigma_2 = 1.0 \\times 10^{-14}$。\n- 候选第三条谱线 (索引 $0,1,2$):\n  - 候选 0：$\\tilde{\\nu} = 50\\ \\mathrm{cm}^{-1}$, $K = 0.4$, $\\sigma = 1.0 \\times 10^{-14}$。\n  - 候选 1：$\\tilde{\\nu} = 1500\\ \\mathrm{cm}^{-1}$, $K = 0.9$, $\\sigma = 1.0 \\times 10^{-14}$。\n  - 候选 2：$\\tilde{\\nu} = 6000\\ \\mathrm{cm}^{-1}$, $K = 1.3$, $\\sigma = 1.0 \\times 10^{-14}$。\n\n您的程序必须使用指定的雅可比矩阵构建费雪信息矩阵，为每个测试用例计算基准谱线对和最佳候选三谱线集的 2-范数条件数 $\\kappa(\\mathbf{F})$，并为三个测试用例输出一个包含三元素列表 $[\\kappa_2, \\kappa_3^{\\ast}, i^\\ast]$ 的列表。最终输出必须是包含这些结果的单行，形式为用方括号括起来的逗号分隔列表，不含任何额外文本。",
            "solution": "此问题要求我们量化使用一组谱线来区分丰度（$A$）和温度（$T$）参数的能力。我们使用费雪信息矩阵（FIM）及其条件数作为度量。较低的条件数表示更好的可辨识性（较少的简并性）。解决方案的核心是实现一个程序，为不同的谱线集计算此度量。\n\n**步骤1：理解模型和参数**\n单条谱线$i$的强度由下式给出：\n$$\nI_i(A,T) = A \\, K_i \\, T^{-\\beta} \\exp\\left(-\\frac{E_i}{k_B T}\\right)\n$$\n我们要确定的参数包含在向量 $\\boldsymbol{\\theta} = [\\ln A,\\, T]^\\top$ 中。所有其他量（$K_i, \\beta, \\sigma_i, \\tilde{\\nu}_i$）和物理常数（$h, c, k_B$）都是已知的。能量 $E_i$ 是从给定的波数 $\\tilde{\\nu}_i$ 使用 $E_i = h c \\tilde{\\nu}_i$ 推导出来的。\n\n**步骤2：构建费雪信息矩阵（FIM）**\n对于我们的两个参数，FIM $\\mathbf{F}$ 是一个 $2 \\times 2$ 矩阵。它的计算公式为：\n$$\n\\mathbf{F} = \\mathbf{J}^\\top \\mathbf{W} \\mathbf{J}\n$$\n其中：\n-   $\\mathbf{J}$ 是雅可比矩阵。对于一个包含 $N$ 条谱线的集合，它是一个 $N \\times 2$ 的矩阵，其中每一行 $i$ 包含强度 $I_i$ 相对于参数 $\\ln A$ 和 $T$ 的偏导数。问题中给出了这些导数：\n    $$\n    \\mathbf{J}_i = \\begin{bmatrix} \\frac{\\partial I_i}{\\partial \\ln A}  \\frac{\\partial I_i}{\\partial T} \\end{bmatrix} = \\begin{bmatrix} I_i(A,T)  I_i(A,T)\\left(-\\frac{\\beta}{T} + \\frac{E_i}{k_B T^2}\\right) \\end{bmatrix}\n    $$\n-   $\\mathbf{W}$ 是权重矩阵，一个 $N \\times N$ 的对角矩阵。对角线元素是测量方差的倒数，$W_{ii} = 1/\\sigma_i^2$。这给予了更精确的测量（较小的 $\\sigma_i$）更大的权重。\n\n**步骤3：计算条件数**\n条件数 $\\kappa(\\mathbf{F})$ 是 $\\mathbf{F}$ 的最大奇异值与最小奇异值之比。由于 $\\mathbf{F}$ 是对称半正定矩阵，其奇异值等于其特征值。\n$$\n\\kappa(\\mathbf{F}) = \\frac{\\lambda_{\\max}(\\mathbf{F})}{\\lambda_{\\min}(\\mathbf{F})}\n$$\n一个小的条件数（接近1）意味着FIM是良态的，参数是良好约束且非简并的。一个大的条件数表示简并性，即难以区分改变一个参数与改变另一个参数所带来的影响。\n\n**步骤4：实现与计算**\n我们实现一个程序来为每个测试用例执行以下步骤：\n1.  定义物理常数 $h, c, k_B$ 和模型参数 $\\beta=1.5$。\n2.  对于给定的谱线集、真实参数（$A, T$）和谱线属性（$\\tilde{\\nu}_i, K_i, \\sigma_i$）：\n    a. 对每条谱线 $i$，计算其能量 $E_i$ 和强度 $I_i$。\n    b. 计算雅可比矩阵的行 $\\mathbf{J}_i$ 的两个元素。\n    c. 通过堆叠行来构建完整的雅可比矩阵 $\\mathbf{J}$。\n    d. 构建权重矩阵 $\\mathbf{W}$。\n    e. 计算FIM $\\mathbf{F} = \\mathbf{J}^\\top \\mathbf{W} \\mathbf{J}$。\n    f. 计算 $\\mathbf{F}$ 的特征值并求其比值，得到条件数 $\\kappa(\\mathbf{F})$。\n3.  对每个测试用例：\n    a. 计算两条基准谱线的 $\\kappa_2$。\n    b. 循环遍历三条候选谱线。对于每个候选谱线，形成一个三谱线集并计算其条件数 $\\kappa_3$。\n    c. 找到导致最小 $\\kappa_3$ 的候选谱线。记录这个最小值 $\\kappa_3^{\\ast}$ 和最佳候选谱线的索引 $i^{\\ast}$。\n4.  将每个案例的结果格式化为 $[\\kappa_2, \\kappa_3^{\\ast}, i^\\ast]$，并将它们组合成一个列表的列表。\n\n**物理学解释**\n测试用例的结果展示了实验设计中的一个关键原则。\n- **测试用例2** 显示，如果基准谱线的能量非常相似（$\\tilde{\\nu}_1 = 2000, \\tilde{\\nu}_2 = 2005 \\text{ cm}^{-1}$），它们对温度的依赖性几乎相同。这导致了一个巨大的条件数，表明 $A$ 和 $T$ 之间存在严重的简并性。添加一条能量差异显著的第三条谱线（例如，在 $10000 \\text{ cm}^{-1}$ 的候选谱线2）在能量空间中提供了更长的“杠杆臂”，打破了简并性并显著降低了条件数。\n- **测试用例3** 在低温下展示了这一点。即使基准谱线能量相近，添加一条高能谱线（$6000 \\text{ cm}^{-1}$ 的候选谱线2）也是最有效的。尽管这条谱线在 $T=300 \\text{ K}$ 时很暗，但其强烈的温度依赖性提供了关键信息，这种信息的重要性超过了其低信噪比。FIM形式论正确地权衡了这些效应。最佳选择总是能最大化加权后雅可比矩阵列向量的正交性，这通过选择具有不同温度敏感度（即不同低能态能量 $E_i$）的谱线来实现。",
            "answer": "[[116.8834918737222,59.8143419083391,2],[254181.8213795133,273.6666579603093,2],[11059.390827291147,51.52187640073574,2]]"
        }
    ]
}