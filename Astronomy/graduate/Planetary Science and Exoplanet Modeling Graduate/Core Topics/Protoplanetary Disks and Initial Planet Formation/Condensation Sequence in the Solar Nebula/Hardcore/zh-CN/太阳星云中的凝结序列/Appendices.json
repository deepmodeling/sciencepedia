{
    "hands_on_practices": [
        {
            "introduction": "要准确模拟太阳星云中的凝结序列，首先必须确定关键的物理条件，如压力和温度。本练习将指导你从基本原理出发，推导原行星盘中平面处的压力表达式，这是所有后续化学平衡计算的基础 。通过这个实践，你将掌握如何将天体物理盘结构模型与宇宙化学凝结过程联系起来。",
            "id": "4157114",
            "problem": "考虑一个围绕质量为 $M_{\\star}$ 的类日恒星的、在垂直方向上等温的轴对称原行星盘。该盘处于垂直流体静力学平衡状态，因此其垂直压力梯度与恒星引力相平衡。局域气体压力 $P(z)$ 和质量密度 $\\rho(z)$ 通过理想气体定律相关联，盘的面密度 $\\Sigma(r)$ 定义为在柱坐标半径 $r$ 处 $\\rho(z)$ 的垂直积分。假设温度仅是半径的函数。你正在对太阳星云中的凝聚序列进行建模，需要中平面压力来评估凝聚锋的位置。\n\n从垂直流体静力学平衡、理想气体定律和面密度的定义这些基本关系出发，并假设一个垂直方向上等温的状态方程，推导出一个用 $\\Sigma(r)$、开普勒角频率 $\\Omega_{K}(r)$、玻尔兹曼常数 $k_{B}$、平均分子质量 $\\mu$ 以及中平面温度 $T(r)$ 表示的中平面压力 $P_{0}(r)$ 的表达式。然后，对于以下科学上合理的盘模型和常数，计算在 $r = 2\\,\\mathrm{AU}$ 处的 $P_{0}$。\n\n- 面密度分布：$\\Sigma(r) = \\Sigma_{0} \\left(\\frac{r}{r_{0}}\\right)^{-p}$，其中 $\\Sigma_{0} = 1.7 \\times 10^{4}\\ \\mathrm{kg\\ m^{-2}}$，$r_{0} = 1\\ \\mathrm{AU}$，$p = 1.5$。\n- 温度分布：$T(r) = T_{0} \\left(\\frac{r}{r_{0}}\\right)^{-q}$，其中 $T_{0} = 280\\ \\mathrm{K}$，$q = 0.5$。\n- 恒星质量：$M_{\\star} = 1.9885 \\times 10^{30}\\ \\mathrm{kg}$。\n- 平均分子质量：$\\mu = 2.34\\,m_{p}$，其中 $m_{p} = 1.6726219 \\times 10^{-27}\\ \\mathrm{kg}$ 是质子质量。\n- 开普勒角频率：$\\Omega_{K}(r) = \\sqrt{\\frac{G M_{\\star}}{r^{3}}}$，其中 $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m^{3}\\ kg^{-1}\\ s^{-2}}$。\n- 玻尔兹曼常数：$k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\ K^{-1}}$。\n- 天文单位 (AU)：$1\\ \\mathrm{AU} = 1.495978707 \\times 10^{11}\\ \\mathrm{m}$。\n\n将你计算出的 $P_{0}(2\\,\\mathrm{AU})$ 的数值答案四舍五入到三位有效数字。以 $\\mathrm{Pa}$ 为单位表示最终压力。\n\n最后，基于第一性原理，解释对于一种其饱和蒸气压遵循克劳修斯-克拉佩龙形式 $P_{\\mathrm{sat}}(T) = P_{s}\\,\\exp\\!\\left(-\\frac{A}{T}\\right)$ 的挥发性物质，$P_{0}(r)$ 的大小如何影响其凝聚锋的径向位置。假设该物质在中平面的分压为 $f_{i}\\,P_{0}(r)$，其中 $0  f_{i}  1$ 是其摩尔分数。你的解释应该是定性的，但需基于推导出的 $P_{0}(r)$ 的依赖关系。该解释不需要任何额外计算，也不影响所要求的 $P_{0}(2\\,\\mathrm{AU})$ 的数值答案。",
            "solution": "该问题已根据指定标准进行验证，并被认为是具有科学依据、良定、客观和完整的。所有必需的物理原理、模型参数和常数均已提供，并且与行星科学中已建立的模型一致。该问题是原行星盘研究中的一个标准练习。因此，我们可以开始解答。\n\n问题要求分三部分作答：首先，推导中平面压力 $P_{0}(r)$ 的表达式；其次，计算在特定半径处的该压力值；第三，定性解释压力如何影响凝聚锋。\n\n第1部分：中平面压力 $P_{0}(r)$ 的推导\n\n我们从垂直流体静力学平衡方程开始，该方程表明垂直压力梯度与恒星引力的垂直分量相平衡。\n$$\n\\frac{dP}{dz} = -\\rho g_{z}\n$$\n其中 $P(z)$ 是压力，$\\rho(z)$ 是质量密度，$g_{z}$ 是在柱坐标半径 $r$ 和中平面以上高度 $z$ 处的引力加速度的垂直分量。对于 $z \\ll r$ 的薄盘，由质量为 $M_{\\star}$ 的中心恒星引起的垂直加速度近似为：\n$$\ng_{z} = - \\frac{G M_{\\star}}{r^{2}} \\sin(\\theta) \\approx - \\frac{G M_{\\star}}{r^{2}} \\tan(\\theta) = - \\frac{G M_{\\star}}{r^{2}} \\frac{z}{r} = - \\left(\\frac{G M_{\\star}}{r^{3}}\\right) z\n$$\n括号中的项是开普勒角频率的平方，$\\Omega_{K}(r) = \\sqrt{\\frac{G M_{\\star}}{r^{3}}}$。因此，$g_{z} = -\\Omega_{K}^{2} z$。将此代入流体静力学平衡方程，得到：\n$$\n\\frac{dP}{dz} = -\\rho(z) \\Omega_{K}^{2} z\n$$\n问题指出气体遵循理想气体定律：\n$$\nP(z) = \\frac{\\rho(z) k_{B} T(r)}{\\mu}\n$$\n其中 $k_{B}$ 是玻尔兹曼常数，$\\mu$ 是平均分子质量，$T(r)$ 是温度。一个关键假设是盘在垂直方向上是等温的，意味着 $T$ 只是 $r$ 的函数，不随 $z$ 变化。我们可以重新整理理想气体定律，用压力来表示密度：\n$$\n\\rho(z) = \\frac{\\mu}{k_{B} T(r)} P(z)\n$$\n将这个 $\\rho(z)$ 的表达式代入流体静力学平衡方程，得到一个关于 $P(z)$ 的一阶微分方程：\n$$\n\\frac{dP}{dz} = - \\left(\\frac{\\mu P(z)}{k_{B} T(r)}\\right) \\Omega_{K}^{2} z \\implies \\frac{1}{P} \\frac{dP}{dz} = - \\frac{\\mu \\Omega_{K}^{2}}{k_{B} T(r)} z\n$$\n我们可以对该方程从中平面（此处 $z=0$ 且 $P=P_{0}$）积分到高度 $z$：\n$$\n\\int_{P_{0}}^{P(z)} \\frac{dP'}{P'} = - \\frac{\\mu \\Omega_{K}^{2}}{k_{B} T(r)} \\int_{0}^{z} z' dz'\n$$\n$$\n\\ln\\left(\\frac{P(z)}{P_{0}}\\right) = - \\frac{\\mu \\Omega_{K}^{2}}{2 k_{B} T(r)} z^{2}\n$$\n求解 $P(z)$ 得到一个高斯压力分布：\n$$\nP(z) = P_{0} \\exp\\left(-\\frac{\\mu \\Omega_{K}^{2}}{2 k_{B} T(r)} z^{2}\\right)\n$$\n再次使用理想气体定律，我们得到密度分布：\n$$\n\\rho(z) = \\frac{\\mu P(z)}{k_{B} T(r)} = \\frac{\\mu P_{0}}{k_{B} T(r)} \\exp\\left(-\\frac{\\mu \\Omega_{K}^{2}}{2 k_{B} T(r)} z^{2}\\right) = \\rho_{0} \\exp\\left(-\\frac{z^{2}}{2h^{2}}\\right)\n$$\n其中 $\\rho_{0} = \\frac{\\mu P_{0}}{k_{B} T(r)}$ 是中平面密度，而 $h = \\sqrt{\\frac{k_{B} T(r)}{\\mu \\Omega_{K}^{2}}}$ 是气体压力标高。\n\n面密度 $\\Sigma(r)$ 定义为体密度在整个 $z$ 上的积分：\n$$\n\\Sigma(r) = \\int_{-\\infty}^{\\infty} \\rho(z) dz = \\rho_{0} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{z^{2}}{2h^{2}}\\right) dz\n$$\n这是一个形式为 $\\int_{-\\infty}^{\\infty} \\exp(-ax^{2})dx = \\sqrt{\\pi/a}$ 的标准高斯积分。这里，$a = 1/(2h^{2})$，所以积分结果为 $\\sqrt{2\\pi h^{2}} = h\\sqrt{2\\pi}$。\n$$\n\\Sigma(r) = \\rho_{0} h \\sqrt{2\\pi}\n$$\n我们的目标是求出 $P_{0}$。我们代入 $\\rho_{0}$ 和 $h$ 的表达式：\n$$\n\\Sigma(r) = \\left(\\frac{\\mu P_{0}}{k_{B} T(r)}\\right) \\left(\\sqrt{\\frac{k_{B} T(r)}{\\mu \\Omega_{K}^{2}}}\\right) \\sqrt{2\\pi}\n$$\n简化此表达式：\n$$\n\\Sigma(r) = \\frac{P_{0}}{\\Omega_{K}(r)} \\frac{\\mu}{\\sqrt{\\mu}} \\frac{\\sqrt{k_{B} T(r)}}{k_{B} T(r)} \\sqrt{2\\pi} = \\frac{P_{0} \\sqrt{2\\pi\\mu}}{\\Omega_{K}(r) \\sqrt{k_{B} T(r)}}\n$$\n最后，我们重新整理以求解中平面压力 $P_{0}(r)$：\n$$\nP_{0}(r) = \\frac{\\Sigma(r) \\Omega_{K}(r) \\sqrt{k_{B} T(r)}}{\\sqrt{2\\pi \\mu}}\n$$\n这就是所求的解析表达式。\n\n第2部分：$P_{0}(r=2\\,\\mathrm{AU})$ 的数值计算\n\n我们已知以下常数和函数形式：\n- $r = 2\\,\\mathrm{AU} = 2 \\times 1.495978707 \\times 10^{11}\\,\\mathrm{m} = 2.991957414 \\times 10^{11}\\,\\mathrm{m}$。\n- $\\Sigma(r) = \\Sigma_{0} \\left(\\frac{r}{r_{0}}\\right)^{-p}$，其中 $\\Sigma_{0} = 1.7 \\times 10^{4}\\,\\mathrm{kg\\,m^{-2}}$，$r_{0} = 1\\,\\mathrm{AU}$，$p=1.5$。\n在 $r=2\\,\\mathrm{AU}$ 处，$\\frac{r}{r_{0}} = 2$。所以，$\\Sigma(2\\,\\mathrm{AU}) = (1.7 \\times 10^{4}) \\times (2)^{-1.5}\\,\\mathrm{kg\\,m^{-2}}$。\n- $T(r) = T_{0} \\left(\\frac{r}{r_{0}}\\right)^{-q}$，其中 $T_{0} = 280\\,\\mathrm{K}$，$q=0.5$。\n在 $r=2\\,\\mathrm{AU}$ 处，$T(2\\,\\mathrm{AU}) = 280 \\times (2)^{-0.5}\\,\\mathrm{K}$。\n- $\\Omega_{K}(r) = \\sqrt{\\frac{G M_{\\star}}{r^{3}}}$，其中 $G = 6.67430 \\times 10^{-11}\\,\\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$，$M_{\\star} = 1.9885 \\times 10^{30}\\,\\mathrm{kg}$。\n- $\\mu = 2.34\\,m_{p} = 2.34 \\times 1.6726219 \\times 10^{-27}\\,\\mathrm{kg} = 3.913935246 \\times 10^{-27}\\,\\mathrm{kg}$。\n- $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$。\n\n现在，我们计算在 $r = 2\\,\\mathrm{AU}$ 处各项的值：\n- $\\Sigma(2\\,\\mathrm{AU}) = (1.7 \\times 10^{4}) \\times 2^{-1.5} \\approx 6010.415\\,\\mathrm{kg\\,m^{-2}}$。\n- $T(2\\,\\mathrm{AU}) = 280 \\times 2^{-0.5} \\approx 197.990\\,\\mathrm{K}$。\n- $\\Omega_{K}(2\\,\\mathrm{AU}) = \\sqrt{\\frac{(6.67430 \\times 10^{-11}) \\times (1.9885 \\times 10^{30})}{(2.991957414 \\times 10^{11})^{3}}} \\approx 7.039016 \\times 10^{-8}\\,\\mathrm{s^{-1}}$。\n\n现在我们来计算 $P_0$ 表达式的分子和分母：\n- 分子：$\\Sigma(r) \\Omega_{K}(r) \\sqrt{k_{B} T(r)}$\n$\\sqrt{k_{B} T(2\\,\\mathrm{AU})} = \\sqrt{(1.380649 \\times 10^{-23}) \\times 197.990} \\approx \\sqrt{2.73350 \\times 10^{-21}} \\approx 5.22829 \\times 10^{-11}\\,\\mathrm{J^{1/2}}$。\n分子 $\\approx (6010.415) \\times (7.039016 \\times 10^{-8}) \\times (5.22829 \\times 10^{-11}) \\approx 2.21273 \\times 10^{-14}\\,\\mathrm{kg\\,m^{-1}\\,s^{-2}}$。\n- 分母：$\\sqrt{2\\pi \\mu}$\n$\\sqrt{2\\pi \\times (3.913935 \\times 10^{-27})} \\approx \\sqrt{2.45917 \\times 10^{-26}} \\approx 1.56817 \\times 10^{-13}\\,\\mathrm{kg^{1/2}}$。\n\n最后，我们计算 $P_{0}(2\\,\\mathrm{AU})$：\n$$\nP_{0}(2\\,\\mathrm{AU}) = \\frac{2.21273 \\times 10^{-14}}{1.56817 \\times 10^{-13}} \\approx 0.141103\\,\\mathrm{Pa}\n$$\n四舍五入到三位有效数字，中平面压力为 $0.141\\,\\mathrm{Pa}$。\n\n第3部分：$P_{0}(r)$ 对凝聚锋的影响\n\n摩尔分数为 $f_i$ 的挥发性物质在其分压 $P_{i}(r) = f_{i}P_{0}(r)$ 等于其饱和蒸气压 $P_{\\mathrm{sat}}(T)$ 时，会从气相中凝聚出来。这种情况发生的位置 $r_{\\mathrm{ice}}$，即为凝聚锋或“雪线”。其条件是：\n$$\nf_{i} P_{0}(r_{\\mathrm{ice}}) = P_{\\mathrm{sat}}(T(r_{\\mathrm{ice}}))\n$$\n饱和蒸气压由克劳修斯-克拉佩龙关系式 $P_{\\mathrm{sat}}(T) = P_{s}\\,\\exp(-A/T)$ 给出，它是一个与温度有很强依赖关系的函数。\n\n中平面压力 $P_{0}(r)$ 和温度 $T(r)$ 都是半径 $r$ 的递减函数。因此，分压 $P_{i}(r)$ 和饱和蒸气压 $P_{\\mathrm{sat}}(T(r))$ 都随着半径的增大而减小。雪线位于这两条压力曲线相交的半径处。为了让凝聚发生在大半径处（冷区域）而不发生在小半径处（热区域），在 $r  r_{\\mathrm{ice}}$ 时，分压 $P_i(r)$ 必须小于 $P_{\\mathrm{sat}}(T(r))$，而在 $r > r_{\\mathrm{ice}}$ 时，分压 $P_i(r)$ 必须大于 $P_{\\mathrm{sat}}(T(r))$。\n\n中平面压力 $P_{0}(r)$ 的大小直接决定了分压 $P_{i}(r)$ 的大小。如果我们考虑一个具有更高整体中平面压力的盘（例如，由于有更大的面密度 $\\Sigma_0$），整条 $P_{i}(r)$ 曲线会向上平移。而只依赖于温度分布的 $P_{\\mathrm{sat}}(T(r))$ 曲线则保持不变。\n\n这条新的、更高的分压曲线现在将在一个不同的位置与饱和蒸气压曲线相交。由于 $P_{\\mathrm{sat}}(T(r))$ 曲线向着更小的半径（更高的温度）处急剧增加，向上平移的 $P_{i}(r)$ 曲线必须在 $P_{\\mathrm{sat}}$ 更高的点与之相交。更高的 $P_{\\mathrm{sat}}$ 值对应于更高的温度 $T$。由于温度随半径减小，更高的温度出现在更小的半径 $r$ 处。\n\n因此，更高的中平面压力 $P_{0}(r)$ 允许挥发性物质在更高的温度下凝聚。在原行星盘的径向结构背景下，这意味着凝聚锋 $r_{\\mathrm{ice}}$ 向内移动，更靠近恒星。相反，更低的中平面压力会将凝聚锋向外推到盘中更冷的区域。",
            "answer": "$$\n\\boxed{0.141}\n$$"
        },
        {
            "introduction": "在确定了星云环境的压力和温度后，下一步是计算特定矿物何时开始凝结。本练习将聚焦于镁橄榄石（一种关键的难熔硅酸盐矿物）的凝结温度计算，应用化学热力学平衡原理 。这个核心计算是理解行星物质成分差异的基石，因为它直接决定了在星云的不同区域哪些固体物质可以形成。",
            "id": "4157164",
            "problem": "将在总气体压力 $P=10^{-3}\\ \\mathrm{bar}$ 的条件下，对由太阳成分气体形成镁橄榄石 $\\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrm{s})$ 的过程进行简化平衡凝聚计算。假设在高温下携带相关元素的主要气体组分是 $\\mathrm{Mg}(\\mathrm{g})$、$\\mathrm{SiO}(\\mathrm{g})$ 和 $\\mathrm{O}_{2}(\\mathrm{g})$，并且固态镁橄榄石在出现时具有单位活度。所研究的反应为\n$$2\\,\\mathrm{Mg}(\\mathrm{g})+\\mathrm{SiO}(\\mathrm{g})+\\frac{3}{2}\\,\\mathrm{O}_{2}(\\mathrm{g})\\longrightarrow \\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrm{s})$$\n将气体视为理想气体，因此组分 $i$ 的分压为 $p_{i}=y_{i}\\,P$，其中 $y_{i}$ 是其在气体中的摩尔分数，$P$ 是总压力。取标准态压力为 $p^{\\circ}=1\\ \\mathrm{bar}$，因此气体的无量纲活度为 $p_{i}/p^{\\circ}$，固体的活度为 $1$。在凝聚开始时，对未凝聚气体使用以下太阳成分的摩尔分数：$y_{\\mathrm{Mg}}=3.98\\times 10^{-5}$、$y_{\\mathrm{SiO}}=3.24\\times 10^{-5}$ 和 $y_{\\mathrm{O}_{2}}=1.00\\times 10^{-6}$（假定在所研究的狭窄温度区间内近似恒定）。上述反应的平衡常数由一个经验拟合公式给出，\n$$\\log_{10}K_{p}(T)=-12.0+\\frac{6.45\\times 10^{4}}{T},$$\n其中 $K_{p}(T)$ 是以气体分压表示的平衡常数，$T$ 是以开尔文为单位的温度。\n\n从平衡常数和理想气体定律的定义出发，推导出镁橄榄石开始凝聚的条件，并计算在 $P=10^{-3}\\ \\mathrm{bar}$ 时反应变得热力学上有利的凝聚温度 $T_{c}$。将最终数值答案四舍五入至四位有效数字，并以开尔文表示。",
            "solution": "首先对用户提供的问题进行严格的验证过程。\n\n### 第1步：提取已知条件\n-   系统：太阳成分的气体。\n-   过程：镁橄榄石 $\\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrm{s})$ 的平衡凝聚。\n-   总气体压力：$P=10^{-3}\\ \\mathrm{bar}$。\n-   气体组分：$\\mathrm{Mg}(\\mathrm{g})$、$\\mathrm{SiO}(\\mathrm{g})$、$\\mathrm{O}_{2}(\\mathrm{g})$。\n-   固体活度：$a_{\\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrm{s})} = 1$。\n-   反应：$2\\,\\mathrm{Mg}(\\mathrm{g})+\\mathrm{SiO}(\\mathrm{g})+\\frac{3}{2}\\,\\mathrm{O}_{2}(\\mathrm{g})\\longrightarrow \\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrm{s})$。\n-   气体模型：理想气体，分压 $p_{i}=y_{i}\\,P$。\n-   标准态压力：$p^{\\circ}=1\\ \\mathrm{bar}$。\n-   气体活度：$a_{i} = p_{i}/p^{\\circ}$。\n-   凝聚开始时的摩尔分数：$y_{\\mathrm{Mg}}=3.98\\times 10^{-5}$、$y_{\\mathrm{SiO}}=3.24\\times 10^{-5}$、$y_{\\mathrm{O}_{2}}=1.00\\times 10^{-6}$。\n-   平衡常数拟合：$\\log_{10}K_{p}(T)=-12.0+\\frac{6.45\\times 10^{4}}{T}$，其中 $T$ 的单位是开尔文。\n-   目标：推导凝聚条件并计算凝聚温度 $T_{c}$，保留四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学基础**：该问题很好地基于化学热力学原理及其在行星科学的一个子领域——宇宙化学中的应用。镁橄榄石的凝聚是太阳星云模型的基石之一。反应的化学计量是正确的，并且使用理想气体定律、分压和平衡常数的经验拟合是标准方法。所提供的数据值对于所描述的环境是物理上合理的。\n-   **适定性**：该问题是适定的。它提供了求解单个未知数——凝聚温度 $T_{c}$ 所需的所有数据和关系（总压力、摩尔分数和与温度相关的平衡常数）。预期会有一个唯一、稳定且有意义的解。\n-   **客观性**：该问题以客观、定量的术语陈述，没有歧义、主观性或个人观点。\n\n该问题没有表现出验证清单中列出的任何缺陷（科学或事实不健全、不可形式化或不相关、不完整或矛盾的设置、不切实际或不可行、不适定或结构不良、伪深刻/琐碎、超出科学可验证性）。\n\n### 第3步：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n镁橄榄石 $\\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrm{s})$ 从太阳成分气体中的凝聚过程由以下化学反应描述：\n$$2\\,\\mathrm{Mg}(\\mathrm{g})+\\mathrm{SiO}(\\mathrm{g})+\\frac{3}{2}\\,\\mathrm{O}_{2}(\\mathrm{g})\\rightleftharpoons \\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrm{s})$$\n化学平衡的条件是热力学平衡常数 $K(T)$ 等于反应商 $Q$。当气体冷却时，凝聚在首次满足此条件的温度 $T_c$ 下开始。热力学平衡常数是根据反应物和产物的活度 $a_i$ 来定义的。\n$$K(T) = \\frac{a_{\\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrm{s})}}{a_{\\mathrm{Mg}(\\mathrm{g})}^{2} a_{\\mathrm{SiO}(\\mathrm{g})} a_{\\mathrm{O}_{2}(\\mathrm{g})}^{3/2}}$$\n问题陈述固态镁橄榄石的活度为1，即 $a_{\\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrm{s})} = 1$。理想气体组分的活度由 $a_i = p_i / p^{\\circ}$ 给出，其中 $p_i$ 是组分 $i$ 的分压，$p^{\\circ}=1\\ \\mathrm{bar}$ 是标准态压力。将这些代入 $K(T)$ 的表达式得到：\n$$K(T) = \\frac{1}{\\left(\\frac{p_{\\mathrm{Mg}}}{p^{\\circ}}\\right)^{2} \\left(\\frac{p_{\\mathrm{SiO}}}{p^{\\circ}}\\right) \\left(\\frac{p_{\\mathrm{O}_2}}{p^{\\circ}}\\right)^{3/2}}$$\n每个组分 $i$ 的分压通过理想气体定律 $p_i = y_i P$ 与其摩尔分数 $y_i$ 和总压力 $P$ 相关。当气体分压满足平衡条件时，凝聚在温度 $T_c$ 下开始。将 $p_i = y_i P$ 代入方程：\n$$K(T_c) = \\frac{1}{\\left(\\frac{y_{\\mathrm{Mg}}P}{p^{\\circ}}\\right)^{2} \\left(\\frac{y_{\\mathrm{SiO}}P}{p^{\\circ}}\\right) \\left(\\frac{y_{\\mathrm{O}_2}P}{p^{\\circ}}\\right)^{3/2}}$$\n这个表达式可以重新整理，将摩尔分数项和压力项组合在一起：\n$$K(T_c) = \\frac{1}{y_{\\mathrm{Mg}}^{2} y_{\\mathrm{SiO}} y_{\\mathrm{O}_2}^{3/2} \\left(\\frac{P}{p^{\\circ}}\\right)^{4.5}}$$\n问题提供了一个平衡常数的经验拟合公式，记为 $K_p(T)$。由于对数的参数必须是无量纲的，这个 $K_p(T)$ 就是热力学平衡常数 $K(T)$。我们可以通过令两个平衡常数表达式相等来求解 $T_c$。为了处理大范围的数值，最方便的方法是使用对数。对 $K(T_c)$ 的表达式取以10为底的对数：\n$$\\log_{10} K(T_c) = \\log_{10} \\left( \\frac{1}{y_{\\mathrm{Mg}}^{2} y_{\\mathrm{SiO}} y_{\\mathrm{O}_2}^{3/2} (P/p^{\\circ})^{4.5}} \\right) = - \\log_{10} \\left( y_{\\mathrm{Mg}}^{2} y_{\\mathrm{SiO}} y_{\\mathrm{O}_2}^{3/2} (P/p^{\\circ})^{4.5} \\right)$$\n使用对数的性质，上式变为：\n$$\\log_{10} K(T_c) = - \\left[ 2\\log_{10}(y_{\\mathrm{Mg}}) + \\log_{10}(y_{\\mathrm{SiO}}) + \\frac{3}{2}\\log_{10}(y_{\\mathrm{O}_2}) + 4.5\\log_{10}\\left(\\frac{P}{p^{\\circ}}\\right) \\right]$$\n我们已知数值：$y_{\\mathrm{Mg}}=3.98\\times 10^{-5}$、$y_{\\mathrm{SiO}}=3.24\\times 10^{-5}$、$y_{\\mathrm{O}_2}=1.00\\times 10^{-6}$ 和 $P=10^{-3}\\ \\mathrm{bar}$，其中 $p^{\\circ}=1\\ \\mathrm{bar}$，因此 $P/p^{\\circ} = 10^{-3}$。\n让我们计算方括号中的各项：\n$2\\log_{10}(3.98\\times 10^{-5}) = 2(\\log_{10}(3.98) - 5) \\approx 2(0.59988 - 5) = 2(-4.40012) = -8.80024$\n$\\log_{10}(3.24\\times 10^{-5}) = \\log_{10}(3.24) - 5 \\approx 0.51055 - 5 = -4.48945$\n$\\frac{3}{2}\\log_{10}(1.00\\times 10^{-6}) = 1.5(-6) = -9.0$\n$4.5\\log_{10}(10^{-3}) = 4.5(-3) = -13.5$\n将这些项相加：\n$\\log_{10} K(T_c) = -[-8.80024 - 4.48945 - 9.0 - 13.5] = -[-35.78969] = 35.78969$\n现在，我们将此值与给定的在 $T=T_c$ 时的平衡常数经验拟合公式相等：\n$$\\log_{10}K_{p}(T_c) = -12.0 + \\frac{6.45\\times 10^{4}}{T_c}$$\n$$35.78969 = -12.0 + \\frac{6.45\\times 10^{4}}{T_c}$$\n求解 $T_c$：\n$$35.78969 + 12.0 = \\frac{6.45\\times 10^{4}}{T_c}$$\n$$47.78969 = \\frac{6.45\\times 10^{4}}{T_c}$$\n$$T_c = \\frac{6.45\\times 10^{4}}{47.78969} \\approx 1349.6436\\ \\mathrm{K}$$\n问题要求将答案四舍五入到四位有效数字。\n$$T_c \\approx 1350\\ \\mathrm{K}$$\n这就是在指定条件下镁橄榄石的凝聚温度。",
            "answer": "$$\n\\boxed{1350}\n$$"
        },
        {
            "introduction": "真实的星云化学比单一矿物的凝结更为复杂，它涉及不同固相之间的竞争和转化。本练习通过一个计算模型，模拟了当温度持续下降时，镁元素如何在镁橄榄石和顽火辉石之间进行分配 。通过解决这个约束下的吉布斯自由能最小化问题，你将亲身体验如何预测和量化一个冷却系统中矿物组合的演化，这正是“凝结序列”的核心。",
            "id": "4157161",
            "problem": "考虑一个在太阳星云冷凝序列背景下的简化平衡冷凝模型：镁在正硅酸盐镁橄榄石 $\\mathrm{Mg}_2\\mathrm{SiO}_4$ 和辉石类顽火辉石 $\\mathrm{MgSiO}_3$ 之间分配，并可能与二氧化硅 $\\mathrm{SiO}_2$ 共存。假设以下模型要素，每项都作为基本定律或核心定义陈述，并全程使用国际单位制（SI）。\n\n1. 固相的化学质量平衡约束，分别以镁橄榄石、顽火辉石和二氧化硅（石英）的摩尔数 $n_{\\mathrm{Fo}}$、$n_{\\mathrm{En}}$ 和 $n_{\\mathrm{Q}}$，以及可用的冷凝镁和硅的量 $n_{\\mathrm{Mg},0}$ 和 $n_{\\mathrm{Si},0}$ 表示：\n   - $2\\,n_{\\mathrm{Fo}} + n_{\\mathrm{En}} = n_{\\mathrm{Mg},0}$，\n   - $n_{\\mathrm{Fo}} + n_{\\mathrm{En}} + n_{\\mathrm{Q}} = n_{\\mathrm{Si},0}$，\n   - $n_{\\mathrm{Fo}} \\ge 0$， $n_{\\mathrm{En}} \\ge 0$， $n_{\\mathrm{Q}} \\ge 0$。\n\n   这些约束源于 $\\mathrm{Mg}_2\\mathrm{SiO}_4$、$\\mathrm{MgSiO}_3$ 和 $\\mathrm{SiO}_2$ 理想化学计量比下的原子守恒。\n\n2. 纯固相之间的硅酸盐交换反应的平衡热力学，\n   $$\\mathrm{Mg}_2\\mathrm{SiO}_4 + \\mathrm{SiO}_2 \\rightleftharpoons 2\\,\\mathrm{MgSiO}_3,$$\n   其特征在于标准反应焓 $\\Delta H_r^\\circ$ 和标准反应熵 $\\Delta S_r^\\circ$ 在所关心的温度范围内不随温度变化。标准反应吉布斯自由能为\n   $$\\Delta G_r^\\circ(T) = \\Delta H_r^\\circ - T\\,\\Delta S_r^\\circ,$$\n   其中 $T$ 是以开尔文为单位的温度，$\\Delta G_r^\\circ$ 的单位是焦耳每摩尔。纯固相的活度为1；因此，只有 $\\Delta G_r^\\circ(T)$ 的符号决定了哪种纯固相组合在热力学上更有利。\n\n3. 在上述约束条件下，最小化总固相吉布斯能。相对于顽火辉石加二氧化硅的参考系来衡量总吉布斯能，使得镁橄榄石的每摩尔能量贡献为 $-\\Delta G_r^\\circ(T)$，而顽火辉石和二氧化硅的贡献为零。那么，需要最小化的目标函数是\n   $$G_{\\mathrm{tot}}(T; n_{\\mathrm{Fo}}, n_{\\mathrm{En}}, n_{\\mathrm{Q}}) = -\\Delta G_r^\\circ(T)\\,n_{\\mathrm{Fo}},$$\n   受质量平衡约束。这种表示方法蕴含了这样一个事实：$\\Delta G_r^\\circ(T) = 2\\,G_{\\mathrm{En}} - \\left(G_{\\mathrm{Fo}} + G_{\\mathrm{Q}}\\right)$，因此，正的 $\\Delta G_r^\\circ(T)$ 意味着镁橄榄石加二氧化硅比顽火辉石更稳定，而负的 $\\Delta G_r^\\circ(T)$ 则意味着相反的情况。\n\n你的任务是实现一个程序，给定温度 $T$（单位为开尔文）和初始冷凝丰度 $n_{\\mathrm{Mg},0}$ 和 $n_{\\mathrm{Si},0}$（单位为摩尔），解决该约束下的吉布斯最小化问题，并报告镁如何在镁橄榄石和顽火辉石之间分配。具体而言：\n\n- 使用 $\\Delta H_r^\\circ = -30000\\,\\mathrm{J\\,mol^{-1}}$ 和 $\\Delta S_r^\\circ = -30\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 对于每个输入的 $T$，计算 $\\Delta G_r^\\circ(T)$ 并在线性约束下最小化 $G_{\\mathrm{tot}}(T)$。请注意，由于约束的存在，这是一个具有一维决策的线性规划问题；如果 $\\Delta G_r^\\circ(T) > 0$，最小化 $G_{\\mathrm{tot}}(T)$ 需要在可行域内最大化 $n_{\\mathrm{Fo}}$；如果 $\\Delta G_r^\\circ(T)  0$，最小化 $G_{\\mathrm{tot}}(T)$ 需要最小化 $n_{\\mathrm{Fo}}$；对于边界情况 $\\Delta G_r^\\circ(T) = 0$，你必须选择可行的最小 $n_{\\mathrm{Fo}}$ 以确保确定性的输出。\n- 计算镁的分配分数\n  $$f_{\\mathrm{Mg,Fo}} = \\frac{2\\,n_{\\mathrm{Fo}}}{n_{\\mathrm{Mg},0}}, \\quad f_{\\mathrm{Mg,En}} = \\frac{n_{\\mathrm{En}}}{n_{\\mathrm{Mg},0}},$$\n  并同时报告二氧化硅的量 $n_{\\mathrm{Q}}$。\n\n所有输出中，分数必须表示为无量纲的小数，而 $n_{\\mathrm{Q}}$ 的单位为摩尔。将所有报告的数字四舍五入到 $6$ 位小数。\n\n测试套件：\n为以下七个测试用例提供结果，这些用例共同探究了高温区、低温区、化学计量比下的边界条件以及反应平衡边界。所有用例均使用 $n_{\\mathrm{Si},0} = 1.0$，以便将 $n_{\\mathrm{Mg},0}$ 解释为镁硅原子比。\n\n- 用例 $1$：$T = 1200.0\\,\\mathrm{K}$，$n_{\\mathrm{Mg},0} = 1.07$，$n_{\\mathrm{Si},0} = 1.0$。\n- 用例 $2$：$T = 800.0\\,\\mathrm{K}$，$n_{\\mathrm{Mg},0} = 1.07$，$n_{\\mathrm{Si},0} = 1.0$。\n- 用例 $3$：$T = 1200.0\\,\\mathrm{K}$，$n_{\\mathrm{Mg},0} = 1.0$，$n_{\\mathrm{Si},0} = 1.0$。\n- 用例 $4$：$T = 800.0\\,\\mathrm{K}$，$n_{\\mathrm{Mg},0} = 1.0$，$n_{\\mathrm{Si},0} = 1.0$。\n- 用例 $5$：$T = 1200.0\\,\\mathrm{K}$，$n_{\\mathrm{Mg},0} = 0.8$，$n_{\\mathrm{Si},0} = 1.0$。\n- 用例 $6$：$T = 800.0\\,\\mathrm{K}$，$n_{\\mathrm{Mg},0} = 0.8$，$n_{\\mathrm{Si},0} = 1.0$。\n- 用例 $7$：$T = 1000.0\\,\\mathrm{K}$，$n_{\\mathrm{Mg},0} = 1.07$，$n_{\\mathrm{Si},0} = 1.0$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素本身都是一个形如 $[f_{\\mathrm{Mg,Fo}}, f_{\\mathrm{Mg,En}}, n_{\\mathrm{Q}}]$ 的列表，对应于相应的测试用例，所有数值都四舍五入到 $6$ 位小数。例如：$[[a_1,b_1,c_1],[a_2,b_2,c_2],\\dots]$。",
            "solution": "所述问题为确定简化化学系统中的平衡矿物组合提供了一套完整且自洽的定义、约束和目标准则。这是一个基于化学热力学基本原理的、适定的约束优化问题。数据在物理上和量纲上都是一致的。因此，该问题被视为**有效**。\n\n核心任务是找到镁橄榄石（$n_{\\mathrm{Fo}}$）、顽火辉石（$n_{\\mathrm{En}}$）和二氧化硅（$n_{\\mathrm{Q}}$）的摩尔量，以最小化固相的总吉布斯能，其目标函数为：\n$$G_{\\mathrm{tot}}(T; n_{\\mathrm{Fo}}, n_{\\mathrm{En}}, n_{\\mathrm{Q}}) = -\\Delta G_r^\\circ(T)\\,n_{\\mathrm{Fo}}$$\n该最小化过程受以下由质量平衡和摩尔量非负性推导出的线性约束：\n$1.$ $2\\,n_{\\mathrm{Fo}} + n_{\\mathrm{En}} = n_{\\mathrm{Mg},0}$ (镁原子守恒)\n$2.$ $n_{\\mathrm{Fo}} + n_{\\mathrm{En}} + n_{\\mathrm{Q}} = n_{\\mathrm{Si},0}$ (硅原子守恒)\n$3.$ $n_{\\mathrm{Fo}} \\ge 0$，$n_{\\mathrm{En}} \\ge 0$，$n_{\\mathrm{Q}} \\ge 0$\n\n优化策略取决于目标函数中 $n_{\\mathrm{Fo}}$ 的系数符号，即 $-\\Delta G_r^\\circ(T)$。反应 $\\mathrm{Mg}_2\\mathrm{SiO}_4 + \\mathrm{SiO}_2 \\rightleftharpoons 2\\,\\mathrm{MgSiO}_3$ 的标准吉布斯自由能由 $\\Delta G_r^\\circ(T) = \\Delta H_r^\\circ - T\\,\\Delta S_r^\\circ$ 给出。一个关键步骤是找到平衡温度 $T_{\\mathrm{eq}}$，此时 $\\Delta G_r^\\circ(T) = 0$。\n$$T_{\\mathrm{eq}} = \\frac{\\Delta H_r^\\circ}{\\Delta S_r^\\circ} = \\frac{-30000\\,\\mathrm{J\\,mol^{-1}}}{-30\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}} = 1000\\,\\mathrm{K}$$\n$\\Delta G_r^\\circ(T)$ 的符号，以及由此决定的优化目标，取决于温度 $T$ 相对于 $T_{\\mathrm{eq}}$ 的大小：\n- 如果 $T > 1000\\,\\mathrm{K}$：由于 $\\Delta S_r^\\circ  0$，因此 $\\Delta G_r^\\circ(T) > 0$。目标函数的系数 $-\\Delta G_r^\\circ(T)$ 为负。为最小化 $G_{\\mathrm{tot}}$，我们必须**最大化** $n_{\\mathrm{Fo}}$。\n- 如果 $T  1000\\,\\mathrm{K}$：则 $\\Delta G_r^\\circ(T)  0$。系数 $-\\Delta G_r^\\circ(T)$ 为正。为最小化 $G_{\\mathrm{tot}}$，我们必须**最小化** $n_{\\mathrm{Fo}}$。\n- 如果 $T = 1000\\,\\mathrm{K}$：此时 $\\Delta G_r^\\circ(T) = 0$，使得对于任何可行解，$G_{\\mathrm{tot}}=0$。问题陈述提供了一个确定性规则，即在这种边界情况下**最小化** $n_{\\mathrm{Fo}}$。\n\n为了找到 $n_{\\mathrm{Fo}}$ 的最优值，我们首先定义其可行范围。我们可以使用质量平衡方程，将 $n_{\\mathrm{En}}$ 和 $n_{\\mathrm{Q}}$ 表示为 $n_{\\mathrm{Fo}}$ 和初始丰度的函数：\n根据约束1：\n$$n_{\\mathrm{En}} = n_{\\mathrm{Mg},0} - 2\\,n_{\\mathrm{Fo}}$$\n将其代入约束2：\n$$n_{\\mathrm{Fo}} + (n_{\\mathrm{Mg},0} - 2\\,n_{\\mathrm{Fo}}) + n_{\\mathrm{Q}} = n_{\\mathrm{Si},0}$$\n求解 $n_{\\mathrm{Q}}$：\n$$n_{\\mathrm{Q}} = n_{\\mathrm{Si},0} - n_{\\mathrm{Mg},0} + n_{\\mathrm{Fo}}$$\n非负性约束（$n_{\\mathrm{Fo}} \\ge 0, n_{\\mathrm{En}} \\ge 0, n_{\\mathrm{Q}} \\ge 0$）对 $n_{\\mathrm{Fo}}$ 施加了界限：\n- $n_{\\mathrm{Fo}} \\ge 0$ 是一个直接约束。\n- 根据 $n_{\\mathrm{En}} \\ge 0$: $n_{\\mathrm{Mg},0} - 2\\,n_{\\mathrm{Fo}} \\ge 0 \\implies n_{\\mathrm{Fo}} \\le \\frac{n_{\\mathrm{Mg},0}}{2}$。\n- 根据 $n_{\\mathrm{Q}} \\ge 0$: $n_{\\mathrm{Si},0} - n_{\\mathrm{Mg},0} + n_{\\mathrm{Fo}} \\ge 0 \\implies n_{\\mathrm{Fo}} \\ge n_{\\mathrm{Mg},0} - n_{\\mathrm{Si},0}$。\n\n结合这些条件，定义了 $n_{\\mathrm{Fo}}$ 的可行区间：\n$$\\max(0, n_{\\mathrm{Mg},0} - n_{\\mathrm{Si},0}) \\le n_{\\mathrm{Fo}} \\le \\frac{n_{\\mathrm{Mg},0}}{2}$$\n设下界为 $n_{\\mathrm{Fo,min}} = \\max(0, n_{\\mathrm{Mg},0} - n_{\\mathrm{Si},0})$，上界为 $n_{\\mathrm{Fo,max}} = \\frac{n_{\\mathrm{Mg},0}}{2}$。\n\n因此，$n_{\\mathrm{Fo}}$ 的解由温度决定：\n- 对于 $T > 1000\\,\\mathrm{K}$，我们最大化 $n_{\\mathrm{Fo}}$，因此解为 $n_{\\mathrm{Fo}} = n_{\\mathrm{Fo,max}} = \\frac{n_{\\mathrm{Mg},0}}{2}$。\n- 对于 $T \\le 1000\\,\\mathrm{K}$，我们最小化 $n_{\\mathrm{Fo}}$，因此解为 $n_{\\mathrm{Fo}} = n_{\\mathrm{Fo,min}} = \\max(0, n_{\\mathrm{Mg},0} - n_{\\mathrm{Si},0})$。\n\n在确定了 $n_{\\mathrm{Fo}}$ 的最优值后，其余量的计算如下：\n1. 计算 $n_{\\mathrm{En}} = n_{\\mathrm{Mg},0} - 2\\,n_{\\mathrm{Fo}}$。\n2. 计算 $n_{\\mathrm{Q}} = n_{\\mathrm{Si},0} - n_{\\mathrm{Mg},0} + n_{\\mathrm{Fo}}$。\n3. 计算镁的分配分数：\n   - $f_{\\mathrm{Mg,Fo}} = \\frac{2\\,n_{\\mathrm{Fo}}}{n_{\\mathrm{Mg},0}}$\n   - $f_{\\mathrm{Mg,En}} = \\frac{n_{\\mathrm{En}}}{n_{\\mathrm{Mg},0}}$\n4. 每个测试用例的最终结果是一个三元组 $[f_{\\mathrm{Mg,Fo}}, f_{\\mathrm{Mg,En}}, n_{\\mathrm{Q}}]$，每个值都四舍五入到 $6$ 位小数。此逻辑已为所提供的测试套件实现。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the constrained Gibbs minimization problem for magnesium silicate condensation.\n    \"\"\"\n\n    # Define the equilibrium temperature boundary based on provided thermodynamic data.\n    # T_eq = delta_H / delta_S = (-30000 J/mol) / (-30 J/mol/K) = 1000 K.\n    T_eq = 1000.0\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (T in K, n_Mg,0 in moles, n_Si,0 in moles)\n    test_cases = [\n        (1200.0, 1.07, 1.0),  # Case 1\n        (800.0, 1.07, 1.0),   # Case 2\n        (1200.0, 1.0, 1.0),   # Case 3\n        (800.0, 1.0, 1.0),    # Case 4\n        (1200.0, 0.8, 1.0),   # Case 5\n        (800.0, 0.8, 1.0),    # Case 6\n        (1000.0, 1.07, 1.0),  # Case 7\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        T, n_Mg0, n_Si0 = case\n\n        # Determine the optimal moles of forsterite (n_Fo) based on temperature.\n        # The objective is to minimize G_tot = -dG_r * n_Fo.\n        # If T > T_eq, dG_r > 0, so -dG_r  0. We must MAXIMIZE n_Fo.\n        # If T = T_eq, dG_r = 0. We must MINIMIZE n_Fo.\n\n        # The feasible range for n_Fo is derived from the non-negativity constraints:\n        # max(0, n_Mg0 - n_Si0) = n_Fo = n_Mg0 / 2\n        n_Fo_min = max(0, n_Mg0 - n_Si0)\n        n_Fo_max = n_Mg0 / 2.0\n        \n        n_Fo = 0.0\n        if T > T_eq:\n            # Maximize n_Fo\n            n_Fo = n_Fo_max\n        else: # T = T_eq\n            # Minimize n_Fo\n            n_Fo = n_Fo_min\n            \n        # Calculate moles of enstatite and silica from mass balance.\n        # n_En = n_Mg0 - 2*n_Fo\n        # n_Q  = n_Si0 - n_Mg0 + n_Fo\n        n_En = n_Mg0 - 2.0 * n_Fo\n        n_Q = n_Si0 - n_Mg0 + n_Fo\n        \n        # Calculate magnesium partition fractions.\n        # Handle the case where n_Mg0 might be zero to avoid division by zero,\n        # although test cases have n_Mg0 > 0.\n        if n_Mg0 > 0:\n            f_Mg_Fo = (2.0 * n_Fo) / n_Mg0\n            f_Mg_En = n_En / n_Mg0\n        else:\n            f_Mg_Fo = 0.0\n            f_Mg_En = 0.0\n\n        # Store the rounded results for the current test case.\n        result = [\n            round(f_Mg_Fo, 6),\n            round(f_Mg_En, 6),\n            round(n_Q, 6)\n        ]\n        all_results.append(result)\n\n    # Format the final output string as specified.\n    # Example format: [[a1,b1,c1],[a2,b2,c2],...]\n    output_parts = []\n    for res in all_results:\n        # Format each number to 6 decimal places.\n        formatted_res = f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f}]\"\n        output_parts.append(formatted_res)\n    \n    final_output = f\"[{','.join(output_parts)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}