{
    "hands_on_practices": [
        {
            "introduction": "The foundation of the condensation sequence is determining the precise temperature at which a given mineral becomes thermodynamically stable in the nebular gas. This exercise provides fundamental practice in this calculation by focusing on forsterite ($\\mathrm{Mg_2SiO_4}$), a primary building block of rocky planets. By applying the law of mass action to a gas of known pressure and solar composition, you will calculate its condensation temperature, $T_c$, directly from the equilibrium constant .",
            "id": "4157164",
            "problem": "A simplified equilibrium condensation calculation for the formation of forsterite $\\mathrm{Mg_2SiO_4}(\\mathrm{s})$ from a solar-composition gas is to be carried out at a total gas pressure $P=10^{-3}\\ \\mathrm{bar}$. Assume the dominant gas species carrying the relevant elements at high temperature are $\\mathrm{Mg}(\\mathrm{g})$, $\\mathrm{SiO}(\\mathrm{g})$, and $\\mathrm{O}_{2}(\\mathrm{g})$, and that the solid forsterite has unit activity upon appearance. The reaction of interest is\n$$2\\,\\mathrm{Mg}(\\mathrm{g})+\\mathrm{SiO}(\\mathrm{g})+\\frac{3}{2}\\,\\mathrm{O}_{2}(\\mathrm{g})\\longrightarrow \\mathrm{Mg_2SiO_4}(\\mathrm{s}).$$\nTreat the gas as ideal, so that the partial pressure of species $i$ is $p_{i}=y_{i}\\,P$, where $y_{i}$ is its mole fraction in the gas and $P$ is the total pressure. Take the standard-state pressure to be $p^{\\circ}=1\\ \\mathrm{bar}$, so dimensionless activities of gases are $p_{i}/p^{\\circ}$ and the activity of the solid is $1$. Use the following solar-composition mole fractions for the uncondensed gas at the onset of condensation: $y_{\\mathrm{Mg}}=3.98\\times 10^{-5}$, $y_{\\mathrm{SiO}}=3.24\\times 10^{-5}$, and $y_{\\mathrm{O_2}}=1.00\\times 10^{-6}$ (assumed approximately constant over the narrow temperature interval of interest). The tabulated equilibrium constant for the reaction above is provided as an empirical fit,\n$$\\log_{10}K_{p}(T)=-12.0+\\frac{6.45\\times 10^{4}}{T},$$\nwhere $K_{p}(T)$ is the equilibrium constant in terms of gas partial pressures and $T$ is the temperature in kelvin.\n\nStarting from the definitions of the equilibrium constant and the ideal gas law, derive the condition for the onset of forsterite condensation and compute the condensation temperature $T_{c}$ at which the reaction becomes thermodynamically favorable at $P=10^{-3}\\ \\mathrm{bar}$. Round your final numerical answer to four significant figures and express it in kelvin.",
            "solution": "The user-provided problem is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n-   System: A solar-composition gas.\n-   Process: Equilibrium condensation of forsterite, $\\mathrm{Mg_2SiO_4}(\\mathrm{s})$.\n-   Total gas pressure: $P=10^{-3}\\ \\mathrm{bar}$.\n-   Gas species: $\\mathrm{Mg}(\\mathrm{g})$, $\\mathrm{SiO}(\\mathrm{g})$, $\\mathrm{O}_{2}(\\mathrm{g})$.\n-   Solid activity: $a_{\\mathrm{Mg_2SiO_4}(\\mathrm{s})} = 1$.\n-   Reaction: $2\\,\\mathrm{Mg}(\\mathrm{g})+\\mathrm{SiO}(\\mathrm{g})+\\frac{3}{2}\\,\\mathrm{O}_{2}(\\mathrm{g})\\longrightarrow \\mathrm{Mg_2SiO_4}(\\mathrm{s})$.\n-   Gas model: Ideal gas, partial pressure $p_{i}=y_{i}\\,P$.\n-   Standard-state pressure: $p^{\\circ}=1\\ \\mathrm{bar}$.\n-   Gas activities: $a_{i} = p_{i}/p^{\\circ}$.\n-   Mole fractions at onset of condensation: $y_{\\mathrm{Mg}}=3.98\\times 10^{-5}$, $y_{\\mathrm{SiO}}=3.24\\times 10^{-5}$, $y_{\\mathrm{O_2}}=1.00\\times 10^{-6}$.\n-   Equilibrium constant fit: $\\log_{10}K_{p}(T)=-12.0+\\frac{6.45\\times 10^{4}}{T}$, where $T$ is in kelvin.\n-   Objective: Derive the condensation condition and compute the condensation temperature $T_{c}$ to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is well-grounded in the principles of chemical thermodynamics and their application to cosmochemistry, a subfield of planetary science. The condensation of forsterite is a cornerstone of models of the solar nebula. The reaction is stoichiometrically correct, and the use of the ideal gas law, partial pressures, and an empirical fit for the equilibrium constant are standard methodologies. The provided data values are physically plausible for the environment described.\n-   **Well-Posed**: The problem is well-posed. It provides all necessary data and relationships (total pressure, mole fractions, and the temperature-dependent equilibrium constant) to solve for a single unknown, the condensation temperature $T_{c}$. A unique, stable, and meaningful solution is expected.\n-   **Objective**: The problem is stated in objective, quantitative terms, free from ambiguity, subjectivity, or opinion.\n\nThe problem does not exhibit any of the flaws listed in the validation checklist (Scientific or Factual Unsoundness, Non-Formalizable or Irrelevant, Incomplete or Contradictory Setup, Unrealistic or Infeasible, Ill-Posed or Poorly Structured, Pseudo-Profound/Trivial, Outside Scientific Verifiability).\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\nThe condensation of forsterite, $\\mathrm{Mg_2SiO_4}(\\mathrm{s})$, from a gas of solar composition is described by the chemical reaction:\n$$2\\,\\mathrm{Mg}(\\mathrm{g})+\\mathrm{SiO}(\\mathrm{g})+\\frac{3}{2}\\,\\mathrm{O}_{2}(\\mathrm{g})\\rightleftharpoons \\mathrm{Mg_2SiO_4}(\\mathrm{s})$$\nThe condition for chemical equilibrium is that the thermodynamic equilibrium constant, $K(T)$, is equal to the reaction quotient, $Q$. Condensation begins at the temperature $T_c$ where this condition is first met as the gas cools. The thermodynamic equilibrium constant is defined in terms of the activities, $a_i$, of the reactants and products.\n$$K(T) = \\frac{a_{\\mathrm{Mg_2SiO_4}(\\mathrm{s})}}{a_{\\mathrm{Mg}(\\mathrm{g})}^{2} a_{\\mathrm{SiO}(\\mathrm{g})} a_{\\mathrm{O_2}(\\mathrm{g})}^{3/2}}$$\nThe problem states that the activity of the solid forsterite is unity, $a_{\\mathrm{Mg_2SiO_4}(\\mathrm{s})} = 1$. The activities of the ideal gas species are given by $a_i = p_i / p^{\\circ}$, where $p_i$ is the partial pressure of species $i$ and $p^{\\circ}=1\\ \\mathrm{bar}$ is the standard-state pressure. Substituting these into the expression for $K(T)$ gives:\n$$K(T) = \\frac{1}{\\left(\\frac{p_{\\mathrm{Mg}}}{p^{\\circ}}\\right)^{2} \\left(\\frac{p_{\\mathrm{SiO}}}{p^{\\circ}}\\right) \\left(\\frac{p_{\\mathrm{O_2}}}{p^{\\circ}}\\right)^{3/2}}$$\nThe partial pressure of each species $i$ is related to its mole fraction $y_i$ and the total pressure $P$ by the ideal gas law, $p_i = y_i P$. The onset of condensation occurs at temperature $T_c$ when the gas partial pressures satisfy the equilibrium condition. Substituting $p_i = y_i P$ into the equation:\n$$K(T_c) = \\frac{1}{\\left(\\frac{y_{\\mathrm{Mg}}P}{p^{\\circ}}\\right)^{2} \\left(\\frac{y_{\\mathrm{SiO}}P}{p^{\\circ}}\\right) \\left(\\frac{y_{\\mathrm{O_2}}P}{p^{\\circ}}\\right)^{3/2}}$$\nThis expression can be rearranged to group the mole fractions and the pressure terms:\n$$K(T_c) = \\frac{1}{y_{\\mathrm{Mg}}^{2} y_{\\mathrm{SiO}} y_{\\mathrm{O_2}}^{3/2} \\left(\\frac{P}{p^{\\circ}}\\right)^{4.5}}$$\nThe problem provides an empirical fit for the equilibrium constant, denoted as $K_p(T)$. Since the argument of a logarithm must be dimensionless, this $K_p(T)$ is the thermodynamic equilibrium constant $K(T)$. We can solve for $T_c$ by equating the two expressions for the equilibrium constant. It is most convenient to work with logarithms to handle the wide range of numerical values. Taking the base-$10$ logarithm of the expression for $K(T_c)$:\n$$\\log_{10} K(T_c) = \\log_{10} \\left( \\frac{1}{y_{\\mathrm{Mg}}^{2} y_{\\mathrm{SiO}} y_{\\mathrm{O_2}}^{3/2} (P/p^{\\circ})^{4.5}} \\right) = - \\log_{10} \\left( y_{\\mathrm{Mg}}^{2} y_{\\mathrm{SiO}} y_{\\mathrm{O_2}}^{3/2} (P/p^{\\circ})^{4.5} \\right)$$\nUsing the properties of logarithms, this becomes:\n$$\\log_{10} K(T_c) = - \\left[ 2\\log_{10}(y_{\\mathrm{Mg}}) + \\log_{10}(y_{\\mathrm{SiO}}) + \\frac{3}{2}\\log_{10}(y_{\\mathrm{O_2}}) + 4.5\\log_{10}\\left(\\frac{P}{p^{\\circ}}\\right) \\right]$$\nWe are given the values: $y_{\\mathrm{Mg}}=3.98\\times 10^{-5}$, $y_{\\mathrm{SiO}}=3.24\\times 10^{-5}$, $y_{\\mathrm{O_2}}=1.00\\times 10^{-6}$, and $P=10^{-3}\\ \\mathrm{bar}$, with $p^{\\circ}=1\\ \\mathrm{bar}$, so $P/p^{\\circ} = 10^{-3}$.\nLet's compute the terms in the square brackets:\n$2\\log_{10}(3.98\\times 10^{-5}) = 2(\\log_{10}(3.98) - 5) \\approx 2(0.59988 - 5) = 2(-4.40012) = -8.80024$\n$\\log_{10}(3.24\\times 10^{-5}) = \\log_{10}(3.24) - 5 \\approx 0.51055 - 5 = -4.48945$\n$\\frac{3}{2}\\log_{10}(1.00\\times 10^{-6}) = 1.5(-6) = -9.0$\n$4.5\\log_{10}(10^{-3}) = 4.5(-3) = -13.5$\nSumming these terms:\n$\\log_{10} K(T_c) = -[-8.80024 - 4.48945 - 9.0 - 13.5] = -[-35.78969] = 35.78969$\nNow, we equate this value with the given empirical fit for the equilibrium constant at $T=T_c$:\n$$\\log_{10}K_{p}(T_c) = -12.0 + \\frac{6.45\\times 10^{4}}{T_c}$$\n$$35.78969 = -12.0 + \\frac{6.45\\times 10^{4}}{T_c}$$\nSolving for $T_c$:\n$$35.78969 + 12.0 = \\frac{6.45\\times 10^{4}}{T_c}$$\n$$47.78969 = \\frac{6.45\\times 10^{4}}{T_c}$$\n$$T_c = \\frac{6.45\\times 10^{4}}{47.78969} \\approx 1349.6436\\ \\mathrm{K}$$\nThe problem requires the answer to be rounded to four significant figures.\n$$T_c \\approx 1350\\ \\mathrm{K}$$\nThis is the condensation temperature of forsterite under the specified conditions.",
            "answer": "$$\n\\boxed{1350}\n$$"
        },
        {
            "introduction": "While calculating the condensation of a single pure phase is instructive, a more realistic scenario involves competition between multiple minerals for the same limited pool of elements. This computational exercise explores the classic equilibrium between forsterite ($\\mathrm{Mg}_2\\mathrm{SiO}_4$) and enstatite ($\\mathrm{MgSiO}_3$), which is governed by the system's temperature and overall magnesium-to-silicon ratio. You will implement a Gibbs free energy minimization algorithm to determine the stable mineral assemblage, a core technique in geochemical and planetary modeling .",
            "id": "4157161",
            "problem": "Consider a simplified equilibrium condensation model in the context of the condensation sequence in the solar nebula: magnesium partitions between the orthosilicate forsterite $\\mathrm{Mg}_2\\mathrm{SiO}_4$ and the pyroxene enstatite $\\mathrm{MgSiO}_3$, possibly coexisting with silica $\\mathrm{SiO}_2$. Assume the following model ingredients, each stated as a fundamental law or core definition, and use International System of Units (SI) throughout.\n\n1. Chemical mass balance constraints for the condensed phases, expressed in terms of moles $n_{\\mathrm{Fo}}$, $n_{\\mathrm{En}}$, and $n_{\\mathrm{Q}}$ of forsterite, enstatite, and silica (quartz), respectively, and the available condensed magnesium and silicon $n_{\\mathrm{Mg},0}$ and $n_{\\mathrm{Si},0}$:\n   - $2\\,n_{\\mathrm{Fo}} + n_{\\mathrm{En}} = n_{\\mathrm{Mg},0}$,\n   - $n_{\\mathrm{Fo}} + n_{\\mathrm{En}} + n_{\\mathrm{Q}} = n_{\\mathrm{Si},0}$,\n   - $n_{\\mathrm{Fo}} \\ge 0$, $n_{\\mathrm{En}} \\ge 0$, $n_{\\mathrm{Q}} \\ge 0$.\n\n   These follow from conservation of atoms under ideal stoichiometry for $\\mathrm{Mg}_2\\mathrm{SiO}_4$, $\\mathrm{MgSiO}_3$, and $\\mathrm{SiO}_2$.\n\n2. The equilibrium thermodynamics of the silicate exchange reaction among pure solids,\n   $$\\mathrm{Mg}_2\\mathrm{SiO}_4 + \\mathrm{SiO}_2 \\rightleftharpoons 2\\,\\mathrm{MgSiO}_3,$$\n   characterized by a standard reaction enthalpy $\\Delta H_r^\\circ$ and entropy $\\Delta S_r^\\circ$ that are temperature independent over the range of interest. The standard reaction Gibbs free energy is\n   $$\\Delta G_r^\\circ(T) = \\Delta H_r^\\circ - T\\,\\Delta S_r^\\circ,$$\n   where $T$ is temperature in Kelvin and $\\Delta G_r^\\circ$ is in Joules per mole. Pure condensed phases have activity of unity; therefore, only the sign of $\\Delta G_r^\\circ(T)$ controls which assemblage of pure solids is thermodynamically favored.\n\n3. Total condensed-phase Gibbs energy minimization under the above constraints. Measure the total Gibbs energy relative to the enstatite-plus-silica reference such that the per-mole energy contribution of forsterite is $-\\,\\Delta G_r^\\circ(T)$ and the contributions of enstatite and silica are zero. The objective function to be minimized is then\n   $$G_{\\mathrm{tot}}(T; n_{\\mathrm{Fo}}, n_{\\mathrm{En}}, n_{\\mathrm{Q}}) = -\\,\\Delta G_r^\\circ(T)\\,n_{\\mathrm{Fo}},$$\n   subject to the mass balance constraints. This representation encodes the fact that $\\Delta G_r^\\circ(T) = 2\\,G_{\\mathrm{En}} - \\left(G_{\\mathrm{Fo}} + G_{\\mathrm{Q}}\\right)$, so a positive $\\Delta G_r^\\circ(T)$ implies that forsterite plus silica is more stable than enstatite, and a negative $\\Delta G_r^\\circ(T)$ implies the reverse.\n\nYour task is to implement a program that, given temperature $T$ in Kelvin and initial condensed abundances $n_{\\mathrm{Mg},0}$ and $n_{\\mathrm{Si},0}$ in moles, solves the constrained Gibbs minimization problem and reports how magnesium partitions between forsterite and enstatite. Specifically:\n\n- Use $\\Delta H_r^\\circ = -30000\\,\\mathrm{J\\,mol^{-1}}$ and $\\Delta S_r^\\circ = -30\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- At each input $T$, compute $\\Delta G_r^\\circ(T)$ and minimize $G_{\\mathrm{tot}}(T)$ subject to the linear constraints. Note that this is a linear program with a one-dimensional decision due to the constraints; if $\\Delta G_r^\\circ(T)  0$, minimizing $G_{\\mathrm{tot}}(T)$ requires maximizing $n_{\\mathrm{Fo}}$ within the feasible region; if $\\Delta G_r^\\circ(T)  0$, minimizing $G_{\\mathrm{tot}}(T)$ requires minimizing $n_{\\mathrm{Fo}}$; for the boundary case $\\Delta G_r^\\circ(T) = 0$, you must choose the minimal feasible $n_{\\mathrm{Fo}}$ to ensure deterministic output.\n- Compute the magnesium partition fractions\n  $$f_{\\mathrm{Mg,Fo}} = \\frac{2\\,n_{\\mathrm{Fo}}}{n_{\\mathrm{Mg},0}}, \\quad f_{\\mathrm{Mg,En}} = \\frac{n_{\\mathrm{En}}}{n_{\\mathrm{Mg},0}},$$\n  and also report the silica amount $n_{\\mathrm{Q}}$.\n\nAll outputs must be expressed as dimensionless decimal numbers for the fractions and moles for $n_{\\mathrm{Q}}$. Round all reported numbers to $6$ decimal places.\n\nTest Suite:\nProvide results for the following seven test cases, which together probe the high-temperature regime, the low-temperature regime, boundary conditions at stoichiometric ratios, and the reaction equilibrium boundary. Use $n_{\\mathrm{Si},0} = 1.0$ for all cases to interpret $n_{\\mathrm{Mg},0}$ as the magnesium-to-silicon atomic ratio.\n\n- Case $1$: $T = 1200.0\\,\\mathrm{K}$, $n_{\\mathrm{Mg},0} = 1.07$, $n_{\\mathrm{Si},0} = 1.0$.\n- Case $2$: $T = 800.0\\,\\mathrm{K}$, $n_{\\mathrm{Mg},0} = 1.07$, $n_{\\mathrm{Si},0} = 1.0$.\n- Case $3$: $T = 1200.0\\,\\mathrm{K}$, $n_{\\mathrm{Mg},0} = 1.0$, $n_{\\mathrm{Si},0} = 1.0$.\n- Case $4$: $T = 800.0\\,\\mathrm{K}$, $n_{\\mathrm{Mg},0} = 1.0$, $n_{\\mathrm{Si},0} = 1.0$.\n- Case $5$: $T = 1200.0\\,\\mathrm{K}$, $n_{\\mathrm{Mg},0} = 0.8$, $n_{\\mathrm{Si},0} = 1.0$.\n- Case $6$: $T = 800.0\\,\\mathrm{K}$, $n_{\\mathrm{Mg},0} = 0.8$, $n_{\\mathrm{Si},0} = 1.0$.\n- Case $7$: $T = 1000.0\\,\\mathrm{K}$, $n_{\\mathrm{Mg},0} = 1.07$, $n_{\\mathrm{Si},0} = 1.0$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a list of the form $[f_{\\mathrm{Mg,Fo}}, f_{\\mathrm{Mg,En}}, n_{\\mathrm{Q}}]$ for the corresponding test case, all rounded to $6$ decimal places. For example: $[[a_1,b_1,c_1],[a_2,b_2,c_2],\\dots]$.",
            "solution": "The problem as stated provides a complete and self-contained set of definitions, constraints, and objective criteria for determining the equilibrium mineralogical assemblage in a simplified chemical system. It is a well-posed constrained optimization problem based on fundamental principles of chemical thermodynamics. The data are physically and dimensionally consistent. The problem is therefore deemed **valid**.\n\nThe central task is to find the molar amounts of forsterite ($n_{\\mathrm{Fo}}$), enstatite ($n_{\\mathrm{En}}$), and silica ($n_{\\mathrm{Q}}$) that minimize the total Gibbs energy of the condensed phases, given by the objective function:\n$$G_{\\mathrm{tot}}(T; n_{\\mathrm{Fo}}, n_{\\mathrm{En}}, n_{\\mathrm{Q}}) = -\\,\\Delta G_r^\\circ(T)\\,n_{\\mathrm{Fo}}$$\nThis minimization is subject to the following linear constraints derived from mass balance and non-negativity of molar amounts:\n$1.$ $2\\,n_{\\mathrm{Fo}} + n_{\\mathrm{En}} = n_{\\mathrm{Mg},0}$ (Magnesium atom conservation)\n$2.$ $n_{\\mathrm{Fo}} + n_{\\mathrm{En}} + n_{\\mathrm{Q}} = n_{\\mathrm{Si},0}$ (Silicon atom conservation)\n$3.$ $n_{\\mathrm{Fo}} \\ge 0$, $n_{\\mathrm{En}} \\ge 0$, $n_{\\mathrm{Q}} \\ge 0$\n\nThe optimization strategy depends on the sign of the coefficient of $n_{\\mathrm{Fo}}$ in the objective function, which is $-\\,\\Delta G_r^\\circ(T)$. The standard Gibbs free energy of the reaction $\\mathrm{Mg}_2\\mathrm{SiO}_4 + \\mathrm{SiO}_2 \\rightleftharpoons 2\\,\\mathrm{MgSiO}_3$ is given as $\\Delta G_r^\\circ(T) = \\Delta H_r^\\circ - T\\,\\Delta S_r^\\circ$. A key step is to find the equilibrium temperature, $T_{\\mathrm{eq}}$, where $\\Delta G_r^\\circ(T) = 0$.\n$$T_{\\mathrm{eq}} = \\frac{\\Delta H_r^\\circ}{\\Delta S_r^\\circ} = \\frac{-30000\\,\\mathrm{J\\,mol^{-1}}}{-30\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}} = 1000\\,\\mathrm{K}$$\nThe sign of $\\Delta G_r^\\circ(T)$, and thus the optimization goal, depends on the temperature $T$ relative to $T_{\\mathrm{eq}}$:\n- If $T  1000\\,\\mathrm{K}$: Since $\\Delta S_r^\\circ  0$, it follows that $\\Delta G_r^\\circ(T)  0$. The objective function's coefficient $-\\,\\Delta G_r^\\circ(T)$ is negative. To minimize $G_{\\mathrm{tot}}$, we must **maximize** $n_{\\mathrm{Fo}}$.\n- If $T  1000\\,\\mathrm{K}$: It follows that $\\Delta G_r^\\circ(T)  0$. The coefficient $-\\,\\Delta G_r^\\circ(T)$ is positive. To minimize $G_{\\mathrm{tot}}$, we must **minimize** $n_{\\mathrm{Fo}}$.\n- If $T = 1000\\,\\mathrm{K}$: Here, $\\Delta G_r^\\circ(T) = 0$, making $G_{\\mathrm{tot}}=0$ for any feasible solution. The problem statement provides a deterministic rule to **minimize** $n_{\\mathrm{Fo}}$ in this boundary case.\n\nTo find the optimal value of $n_{\\mathrm{Fo}}$, we first define its feasible range. We can express $n_{\\mathrm{En}}$ and $n_{\\mathrm{Q}}$ in terms of $n_{\\mathrm{Fo}}$ and the initial abundances using the mass balance equations:\nFrom constraint $1$:\n$$n_{\\mathrm{En}} = n_{\\mathrm{Mg},0} - 2\\,n_{\\mathrm{Fo}}$$\nSubstituting this into constraint $2$:\n$$n_{\\mathrm{Fo}} + (n_{\\mathrm{Mg},0} - 2\\,n_{\\mathrm{Fo}}) + n_{\\mathrm{Q}} = n_{\\mathrm{Si},0}$$\nSolving for $n_{\\mathrm{Q}}$:\n$$n_{\\mathrm{Q}} = n_{\\mathrm{Si},0} - n_{\\mathrm{Mg},0} + n_{\\mathrm{Fo}}$$\nThe non-negativity constraints ($n_{\\mathrm{Fo}} \\ge 0, n_{\\mathrm{En}} \\ge 0, n_{\\mathrm{Q}} \\ge 0$) impose bounds on $n_{\\mathrm{Fo}}$:\n- $n_{\\mathrm{Fo}} \\ge 0$ is a direct constraint.\n- From $n_{\\mathrm{En}} \\ge 0$: $n_{\\mathrm{Mg},0} - 2\\,n_{\\mathrm{Fo}} \\ge 0 \\implies n_{\\mathrm{Fo}} \\le \\frac{n_{\\mathrm{Mg},0}}{2}$.\n- From $n_{\\mathrm{Q}} \\ge 0$: $n_{\\mathrm{Si},0} - n_{\\mathrm{Mg},0} + n_{\\mathrm{Fo}} \\ge 0 \\implies n_{\\mathrm{Fo}} \\ge n_{\\mathrm{Mg},0} - n_{\\mathrm{Si},0}$.\n\nCombining these defines the feasible interval for $n_{\\mathrm{Fo}}$:\n$$\\max(0, n_{\\mathrm{Mg},0} - n_{\\mathrm{Si},0}) \\le n_{\\mathrm{Fo}} \\le \\frac{n_{\\mathrm{Mg},0}}{2}$$\nLet the lower bound be $n_{\\mathrm{Fo,min}} = \\max(0, n_{\\mathrm{Mg},0} - n_{\\mathrm{Si},0})$ and the upper bound be $n_{\\mathrm{Fo,max}} = \\frac{n_{\\mathrm{Mg},0}}{2}$.\n\nThe solution for $n_{\\mathrm{Fo}}$ is therefore determined by the temperature:\n- For $T  1000\\,\\mathrm{K}$, we maximize $n_{\\mathrm{Fo}}$, so the solution is $n_{\\mathrm{Fo}} = n_{\\mathrm{Fo,max}} = \\frac{n_{\\mathrm{Mg},0}}{2}$.\n- For $T \\le 1000\\,\\mathrm{K}$, we minimize $n_{\\mathrm{Fo}}$, so the solution is $n_{\\mathrm{Fo}} = n_{\\mathrm{Fo,min}} = \\max(0, n_{\\mathrm{Mg},0} - n_{\\mathrm{Si},0})$.\n\nWith the optimal value of $n_{\\mathrm{Fo}}$ determined, the remaining quantities are calculated as follows:\n$1.$ Calculate $n_{\\mathrm{En}} = n_{\\mathrm{Mg},0} - 2\\,n_{\\mathrm{Fo}}$.\n$2.$ Calculate $n_{\\mathrm{Q}} = n_{\\mathrm{Si},0} - n_{\\mathrm{Mg},0} + n_{\\mathrm{Fo}}$.\n$3.$ Compute the magnesium partition fractions:\n   - $f_{\\mathrm{Mg,Fo}} = \\frac{2\\,n_{\\mathrm{Fo}}}{n_{\\mathrm{Mg},0}}$\n   - $f_{\\mathrm{Mg,En}} = \\frac{n_{\\mathrm{En}}}{n_{\\mathrm{Mg},0}}$\n$4.$ The final result for each test case is the triplet $[f_{\\mathrm{Mg,Fo}}, f_{\\mathrm{Mg,En}}, n_{\\mathrm{Q}}]$, with each value rounded to $6$ decimal places. This logic is implemented for the provided test suite.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the constrained Gibbs minimization problem for magnesium silicate condensation.\n    \"\"\"\n\n    # Define the equilibrium temperature boundary based on provided thermodynamic data.\n    # T_eq = delta_H / delta_S = (-30000 J/mol) / (-30 J/mol/K) = 1000 K.\n    T_eq = 1000.0\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (T in K, n_Mg,0 in moles, n_Si,0 in moles)\n    test_cases = [\n        (1200.0, 1.07, 1.0),  # Case 1\n        (800.0, 1.07, 1.0),   # Case 2\n        (1200.0, 1.0, 1.0),   # Case 3\n        (800.0, 1.0, 1.0),    # Case 4\n        (1200.0, 0.8, 1.0),   # Case 5\n        (800.0, 0.8, 1.0),    # Case 6\n        (1000.0, 1.07, 1.0),  # Case 7\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        T, n_Mg0, n_Si0 = case\n\n        # Determine the optimal moles of forsterite (n_Fo) based on temperature.\n        # The objective is to minimize G_tot = -dG_r * n_Fo.\n        # If T  T_eq, dG_r  0, so -dG_r  0. We must MAXIMIZE n_Fo.\n        # If T = T_eq, dG_r = 0, so -dG_r = 0. We must MINIMIZE n_Fo.\n\n        # The feasible range for n_Fo is derived from the non-negativity constraints:\n        # max(0, n_Mg0 - n_Si0) = n_Fo = n_Mg0 / 2\n        n_Fo_min = max(0, n_Mg0 - n_Si0)\n        n_Fo_max = n_Mg0 / 2.0\n        \n        n_Fo = 0.0\n        if T  T_eq:\n            # Maximize n_Fo\n            n_Fo = n_Fo_max\n        else: # T = T_eq\n            # Minimize n_Fo\n            n_Fo = n_Fo_min\n            \n        # Calculate moles of enstatite and silica from mass balance.\n        # n_En = n_Mg0 - 2*n_Fo\n        # n_Q  = n_Si0 - n_Mg0 + n_Fo\n        n_En = n_Mg0 - 2.0 * n_Fo\n        n_Q = n_Si0 - n_Mg0 + n_Fo\n        \n        # Calculate magnesium partition fractions.\n        # Handle the case where n_Mg0 might be zero to avoid division by zero,\n        # although test cases have n_Mg0  0.\n        if n_Mg0  0:\n            f_Mg_Fo = (2.0 * n_Fo) / n_Mg0\n            f_Mg_En = n_En / n_Mg0\n        else:\n            f_Mg_Fo = 0.0\n            f_Mg_En = 0.0\n\n        # Store the rounded results for the current test case.\n        result = [\n            round(f_Mg_Fo, 6),\n            round(f_Mg_En, 6),\n            round(n_Q, 6)\n        ]\n        all_results.append(result)\n\n    # Format the final output string as specified.\n    # Example format: [[a1,b1,c1],[a2,b2,c2],...]\n    output_parts = []\n    for res in all_results:\n        # Format each number to 6 decimal places.\n        formatted_res = f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f}]\"\n        output_parts.append(formatted_res)\n    \n    final_output = f\"[{','.join(output_parts)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "Equilibrium models assume that condensed solids remain perfectly coupled to the gas, but in a real protoplanetary disk, solids settle and drift, removing them from further interaction. This dynamic process is best described by Rayleigh fractionation, which leads to significant chemical differentiation between the evolving gas and the accumulated solids. In this exercise, you will model this process computationally, tracking how the magnesium content of the gas and condensates changes along a cooling path, providing key insights into the chemical history of planet-forming materials .",
            "id": "4157117",
            "problem": "Consider a well-mixed parcel of protoplanetary disk gas composed primarily of hydrogen with a trace abundance of magnesium. As the disk cools, magnesium-bearing silicate solids condense and are instantaneously removed from the gas (settling and drift), which is well described by the Rayleigh fractionation model for instantaneous removal of an equilibrium solid phase. The goal is to quantify the partitioning of magnesium between the gas and the condensed silicate solids along a prescribed cooling path.\n\nStart from the following fundamental base:\n- The magnesium concentration in the gas phase, denoted by $C_g$, is defined as $C_g = n_g/M_g$, where $n_g$ is the number of moles of magnesium in the gas and $M_g$ is the gas mass.\n- At any temperature $T$, the equilibrium magnesium concentration in the silicate solid that instantaneously condenses and is removed, denoted by $C_s$, is proportional to the gas concentration via a bulk partition coefficient (also called a distribution coefficient) $D(T)$, so that $C_s = D(T)\\,C_g$.\n- The small removal of solid of mass $\\mathrm{d}M_s$ reduces the gas mass by $\\mathrm{d}M_g = -\\mathrm{d}M_s$ and removes magnesium $\\mathrm{d}n_s = C_s\\,\\mathrm{d}M_s$ from the gas.\n\nAssume that the temperature dependence of the bulk partition coefficient $D(T)$ arises from thermodynamic equilibrium of the condensation reaction and can be modeled from the van't Hoff relation using a constant reaction enthalpy $\\Delta H$ and a reference temperature $T_{\\mathrm{ref}}$ at which the coefficient is $D_{\\mathrm{ref}}$. The universal molar gas constant $R$ must be used in joules per mole per kelvin.\n\nYou are provided with a discrete cooling path as a sequence of temperatures and, at each temperature step, the fraction of the remaining gas mass that is converted into solids and instantaneously removed. For a temperature sequence $\\{T_i\\}$ and per-step removal fractions $\\{\\phi_i\\}$ (so the fraction of gas mass remaining after step $i$ is $F_i = 1 - \\phi_i$), the task is to compute:\n1. The final fraction of the initial magnesium that remains in the gas, $f_g^{\\mathrm{Mg}}$, at the end of the sequence.\n2. The final fraction of the initial magnesium that resides in condensed silicate solids, $f_s^{\\mathrm{Mg}} = 1 - f_g^{\\mathrm{Mg}}$.\n3. The final gas-phase magnesium concentration $C_g^{\\mathrm{end}}$ in $\\mathrm{mol/kg}$.\n\nAll magnesium fractions must be reported as decimal numbers (no percentage sign). The final gas-phase concentration must be reported in $\\mathrm{mol/kg}$.\n\nTest suite:\nFor all cases use the universal gas constant $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ and initial gas-phase magnesium concentration $C_0 = 3.8\\times 10^{-5}\\,\\mathrm{mol/kg}$.\n\n- Case A (general cooling with modest removal): temperatures $\\{T_i\\} = [\\,1600,1500,1400,1300,1200\\,]\\,\\mathrm{K}$, removal fractions $\\{\\phi_i\\} = [\\,0.005,0.005,0.008,0.010,0.012\\,]$, with $D_{\\mathrm{ref}} = 1.0$ at $T_{\\mathrm{ref}} = 1400\\,\\mathrm{K}$ and $\\Delta H = -3.0\\times 10^{5}\\,\\mathrm{J/mol}$.\n- Case B (no solids removed): temperatures $\\{T_i\\} = [\\,1600,1500,1400,1300,1200\\,]\\,\\mathrm{K}$, removal fractions $\\{\\phi_i\\} = [\\,0.0,0.0,0.0,0.0,0.0\\,]$, with $D_{\\mathrm{ref}} = 1.0$ at $T_{\\mathrm{ref}} = 1400\\,\\mathrm{K}$ and $\\Delta H = -3.0\\times 10^{5}\\,\\mathrm{J/mol}$.\n- Case C (high-temperature removal where magnesium is relatively incompatible): temperatures $\\{T_i\\} = [\\,1700,1650,1600,1550\\,]\\,\\mathrm{K}$, removal fractions $\\{\\phi_i\\} = [\\,0.020,0.020,0.020,0.020\\,]$, with $D_{\\mathrm{ref}} = 1.0$ at $T_{\\mathrm{ref}} = 1400\\,\\mathrm{K}$ and $\\Delta H = -3.0\\times 10^{5}\\,\\mathrm{J/mol}$.\n- Case D (lower-temperature removal with stronger partitioning into solids): temperatures $\\{T_i\\} = [\\,1400,1350,1300,1250,1200,1150\\,]\\,\\mathrm{K}$, removal fractions $\\{\\phi_i\\} = [\\,0.010,0.015,0.020,0.025,0.030,0.040\\,]$, with $D_{\\mathrm{ref}} = 1.2$ at $T_{\\mathrm{ref}} = 1400\\,\\mathrm{K}$ and $\\Delta H = -4.0\\times 10^{5}\\,\\mathrm{J/mol}$.\n- Case E (boundary with negligible removal): temperatures $\\{T_i\\} = [\\,1400\\,]\\,\\mathrm{K}$, removal fractions $\\{\\phi_i\\} = [\\,10^{-6}\\,]$, with $D_{\\mathrm{ref}} = 1.0$ at $T_{\\mathrm{ref}} = 1400\\,\\mathrm{K}$ and $\\Delta H = -3.0\\times 10^{5}\\,\\mathrm{J/mol}$.\n\nYour program must compute, for each case, the tuple $(f_g^{\\mathrm{Mg}}, f_s^{\\mathrm{Mg}}, C_g^{\\mathrm{end}})$ and output a single line containing the results as a comma-separated list enclosed in square brackets, in the flattened order concatenating the three values for Case A, then Case B, Case C, Case D, and Case E, i.e., $[\\,f_g^{\\mathrm{Mg}}(\\mathrm{A}), f_s^{\\mathrm{Mg}}(\\mathrm{A}), C_g^{\\mathrm{end}}(\\mathrm{A}), f_g^{\\mathrm{Mg}}(\\mathrm{B}), \\dots, f_g^{\\mathrm{Mg}}(\\mathrm{E}), f_s^{\\mathrm{Mg}}(\\mathrm{E}), C_g^{\\mathrm{end}}(\\mathrm{E})\\,]$. Express $C_g^{\\mathrm{end}}$ in $\\mathrm{mol/kg}$.",
            "solution": "The user-provided problem is assessed to be valid. It is scientifically grounded in the principles of geochemical fractionation and thermodynamics, well-posed with a complete set of parameters and clear objectives, and is formulated objectively. We may therefore proceed with a full solution.\n\nThe problem requires the calculation of magnesium partitioning between gas and solid phases during condensation in a protoplanetary disk. The process is modeled as a discrete form of Rayleigh fractionation, where condensed solids are instantaneously removed and do not re-equilibrate with the gas. We will first derive the governing equations from the fundamental principles provided, then construct a step-by-step algorithm to solve for the final state of the system for each specified test case.\n\nFirst, we establish the relationship governing the change in the gas-phase concentration of magnesium, $C_g$. The concentration is defined as $C_g = n_g/M_g$, where $n_g$ is the number of moles of magnesium in the gas phase and $M_g$ is the total mass of the gas parcel. The total differential of $n_g$ is given by the product rule:\n$$ \\mathrm{d}n_g = \\mathrm{d}(C_g M_g) = C_g \\mathrm{d}M_g + M_g \\mathrm{d}C_g $$\nAs a mass $\\mathrm{d}M_s$ of solid condenses, the gas mass decreases by an equal amount, $\\mathrm{d}M_g = -\\mathrm{d}M_s$. The number of moles of magnesium removed from the gas is $\\mathrm{d}n_s = C_s \\mathrm{d}M_s$, where $C_s$ is the magnesium concentration in the condensing solid. This removal depletes the magnesium in the gas, so $\\mathrm{d}n_g = -\\mathrm{d}n_s$. Substituting the given relations:\n$$ \\mathrm{d}n_g = - (C_s \\mathrm{d}M_s) = - (D(T) C_g) (-\\mathrm{d}M_g) = D(T) C_g \\mathrm{d}M_g $$\nHere, $D(T)$ is the temperature-dependent bulk partition coefficient. Equating the two expressions for $\\mathrm{d}n_g$ yields:\n$$ C_g \\mathrm{d}M_g + M_g \\mathrm{d}C_g = D(T) C_g \\mathrm{d}M_g $$\nRearranging this equation to separate variables gives the fundamental differential equation for Rayleigh fractionation:\n$$ \\frac{\\mathrm{d}C_g}{C_g} = (D(T) - 1) \\frac{\\mathrm{d}M_g}{M_g} $$\nFor a discrete step $i$ in the cooling sequence, we assume the temperature $T_i$ and thus the partition coefficient $D_i = D(T_i)$ are constant. We integrate the equation from the state at the beginning of the step ($C_{g,i-1}$, $M_{g,i-1}$) to the end ($C_{g,i}$, $M_{g,i}$).\n$$ \\int_{C_{g,i-1}}^{C_{g,i}} \\frac{\\mathrm{d}C_g}{C_g} = (D_i - 1) \\int_{M_{g,i-1}}^{M_{g,i}} \\frac{\\mathrm{d}M_g}{M_g} $$\n$$ \\ln\\left(\\frac{C_{g,i}}{C_{g,i-1}}\\right) = (D_i - 1) \\ln\\left(\\frac{M_{g,i}}{M_{g,i-1}}\\right) $$\nExponentiating both sides gives the classic Rayleigh fractionation equation for a single step:\n$$ C_{g,i} = C_{g,i-1} \\left(\\frac{M_{g,i}}{M_{g,i-1}}\\right)^{D_i - 1} $$\nThe problem defines $\\phi_i$ as the fraction of the remaining gas mass that is removed at step $i$. Therefore, the fraction of gas mass remaining after step $i$ is $M_{g,i}/M_{g,i-1} = 1 - \\phi_i$. This gives our iterative update rule for the gas-phase concentration:\n$$ C_{g,i} = C_{g,i-1} (1 - \\phi_i)^{D_i - 1} $$\n\nNext, we determine the partition coefficient $D(T)$. Its temperature dependence is described by the integrated van't Hoff equation for a constant reaction enthalpy $\\Delta H$:\n$$ \\ln \\left( \\frac{D(T)}{D_{\\mathrm{ref}}} \\right) = -\\frac{\\Delta H}{R} \\left( \\frac{1}{T} - \\frac{1}{T_{\\mathrm{ref}}} \\right) $$\nwhere $R$ is the universal gas constant, and $(T_{\\mathrm{ref}}, D_{\\mathrm{ref}})$ is a given reference point. The partition coefficient at any temperature $T_i$ is thus:\n$$ D_i = D(T_i) = D_{\\mathrm{ref}} \\exp\\left[ -\\frac{\\Delta H}{R} \\left( \\frac{1}{T_i} - \\frac{1}{T_{\\mathrm{ref}}} \\right) \\right] $$\n\nWe are tasked with finding three quantities after the final step $N$: the final gas concentration $C_g^{\\mathrm{end}}$, the final fraction of initial magnesium in the gas $f_g^{\\mathrm{Mg}}$, and the final fraction in the solids $f_s^{\\mathrm{Mg}}$.\n\n$C_g^{\\mathrm{end}}$ is the result of applying the concentration update rule iteratively starting from $C_{g,0} = C_0$:\n$$ C_g^{\\mathrm{end}} = C_{g,N} = C_0 \\prod_{i=1}^{N} (1 - \\phi_i)^{D_i - 1} $$\n\nThe fraction of initial magnesium remaining in the gas is $f_g^{\\mathrm{Mg}} = n_{g,N} / n_{g,0}$. We derive an iterative update for $n_{g,i} = C_{g,i}M_{g,i}$:\n$$ n_{g,i} = C_{g,i}M_{g,i} = \\left[ C_{g,i-1} (1 - \\phi_i)^{D_i-1} \\right] \\left[ M_{g,i-1} (1 - \\phi_i) \\right] = (C_{g,i-1}M_{g,i-1})(1 - \\phi_i)^{D_i} = n_{g,i-1}(1 - \\phi_i)^{D_i} $$\nDividing by the initial moles $n_{g,0}$, we find the iterative update for the fraction:\n$$ f_{g,i}^{\\mathrm{Mg}} = f_{g,i-1}^{\\mathrm{Mg}} (1 - \\phi_i)^{D_i} $$\nstarting with $f_{g,0}^{\\mathrm{Mg}} = 1$. The final fraction is:\n$$ f_g^{\\mathrm{Mg}} = \\prod_{i=1}^{N} (1 - \\phi_i)^{D_i} $$\n\nFinally, by conservation of mass for magnesium, the fraction that has condensed into solids is simply:\n$$ f_s^{\\mathrm{Mg}} = 1 - f_g^{\\mathrm{Mg}} $$\n\nThe computational procedure for each test case is as follows:\n1. Initialize the state variables: current concentration $C_g = C_0 = 3.8 \\times 10^{-5}\\,\\mathrm{mol/kg}$ and fraction of magnesium in gas $f_g^{\\mathrm{Mg}} = 1.0$.\n2. For each step $i$ in the given sequence of temperatures $\\{T_i\\}$ and removal fractions $\\{\\phi_i\\}$:\n    a. Calculate the partition coefficient $D_i = D(T_i)$ using the van't Hoff equation with the provided $\\Delta H$, $T_{\\mathrm{ref}}$, and $D_{\\mathrm{ref}}$.\n    b. Update the concentration: $C_g \\leftarrow C_g \\cdot (1 - \\phi_i)^{D_i - 1}$.\n    c. Update the fraction of magnesium in the gas: $f_g^{\\mathrm{Mg}} \\leftarrow f_g^{\\mathrm{Mg}} \\cdot (1 - \\phi_i)^{D_i}$.\n3. After iterating through all steps, the final values are $C_g^{\\mathrm{end}} = C_g$ and the final $f_g^{\\mathrm{Mg}}$.\n4. Calculate the fraction in solids $f_s^{\\mathrm{Mg}} = 1 - f_g^{\\mathrm{Mg}}$.\n5. Assemble the tuple $(f_g^{\\mathrm{Mg}}, f_s^{\\mathrm{Mg}}, C_g^{\\mathrm{end}})$.\nThis procedure is implemented for each test case to generate the final results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the condensation sequence problem for all test cases.\n    \"\"\"\n    # Universal Gas Constant in J/mol/K\n    R = 8.314462618\n    # Initial gas-phase magnesium concentration in mol/kg\n    C0 = 3.8e-5\n\n    test_cases = [\n        # Case A: General cooling with modest removal\n        {\n            'T_seq': np.array([1600, 1500, 1400, 1300, 1200]),\n            'phi_seq': np.array([0.005, 0.005, 0.008, 0.010, 0.012]),\n            'T_ref': 1400, 'D_ref': 1.0, 'dH': -3.0e5\n        },\n        # Case B: No solids removed\n        {\n            'T_seq': np.array([1600, 1500, 1400, 1300, 1200]),\n            'phi_seq': np.array([0.0, 0.0, 0.0, 0.0, 0.0]),\n            'T_ref': 1400, 'D_ref': 1.0, 'dH': -3.0e5\n        },\n        # Case C: High-temperature removal (Mg incompatible)\n        {\n            'T_seq': np.array([1700, 1650, 1600, 1550]),\n            'phi_seq': np.array([0.020, 0.020, 0.020, 0.020]),\n            'T_ref': 1400, 'D_ref': 1.0, 'dH': -3.0e5\n        },\n        # Case D: Lower-temperature removal (Mg compatible)\n        {\n            'T_seq': np.array([1400, 1350, 1300, 1250, 1200, 1150]),\n            'phi_seq': np.array([0.010, 0.015, 0.020, 0.025, 0.030, 0.040]),\n            'T_ref': 1400, 'D_ref': 1.2, 'dH': -4.0e5\n        },\n        # Case E: Boundary with negligible removal at D=1\n        {\n            'T_seq': np.array([1400]),\n            'phi_seq': np.array([1e-6]),\n            'T_ref': 1400, 'D_ref': 1.0, 'dH': -3.0e5\n        }\n    ]\n\n    def calculate_condensation(T_seq, phi_seq, T_ref, D_ref, dH):\n        \"\"\"\n        Simulates the Rayleigh fractionation process for a given cooling path.\n        \n        Args:\n            T_seq (np.ndarray): Sequence of temperatures in Kelvin.\n            phi_seq (np.ndarray): Sequence of gas mass removal fractions.\n            T_ref (float): Reference temperature in Kelvin.\n            D_ref (float): Partition coefficient at reference temperature.\n            dH (float): Reaction enthalpy in J/mol.\n            \n        Returns:\n            tuple: (f_g_mg, f_s_mg, cg_end)\n                   f_g_mg: final fraction of Mg in gas\n                   f_s_mg: final fraction of Mg in solids\n                   cg_end: final gas-phase Mg concentration in mol/kg\n        \"\"\"\n        cg_current = C0\n        fg_mg = 1.0\n\n        def get_D(T, T_ref_val, D_ref_val, dH_val):\n            \"\"\"Calculates the partition coefficient D at temperature T.\"\"\"\n            if T == T_ref_val:\n                return D_ref_val\n            # Integrated van't Hoff equation\n            exponent = (-dH_val / R) * (1.0 / T - 1.0 / T_ref_val)\n            return D_ref_val * np.exp(exponent)\n\n        for T, phi in zip(T_seq, phi_seq):\n            if phi == 0.0:\n                continue\n            \n            # Calculate partition coefficient D for the current step\n            D = get_D(T, T_ref, D_ref, dH)\n            \n            # Update gas concentration using Rayleigh fractionation equation\n            cg_current *= (1.0 - phi)**(D - 1.0)\n            \n            # Update fraction of Mg remaining in gas phase\n            fg_mg *= (1.0 - phi)**D\n\n        cg_end = cg_current\n        fs_mg = 1.0 - fg_mg\n        \n        return (fg_mg, fs_mg, cg_end)\n\n    all_results = []\n    for case_params in test_cases:\n        result_tuple = calculate_condensation(**case_params)\n        all_results.extend(result_tuple)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}