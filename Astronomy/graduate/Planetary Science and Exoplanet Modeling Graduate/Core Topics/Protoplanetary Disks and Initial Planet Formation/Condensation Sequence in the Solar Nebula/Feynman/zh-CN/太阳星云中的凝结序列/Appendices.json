{
    "hands_on_practices": [
        {
            "introduction": "在我们确定哪些矿物会凝结之前，我们必须首先描述原行星盘的物理环境。本练习将星盘的宏观结构（其表面密度和温度分布）与关键的局部中平面压力联系起来，后者是控制凝结的关键参数。通过推导和计算这个压力 ，你将为我们的凝结模型建立物理基础。",
            "id": "4157114",
            "problem": "考虑一个围绕质量为 $M_{\\star}$ 的类日恒星的、垂直方向上等温的、轴对称的原行星盘。该星盘处于垂直静力学平衡状态，因此其垂直压力梯度与恒星引力相平衡。局部气体压力 $P(z)$ 和质量密度 $\\rho(z)$ 通过理想气体定律相关联，星盘的表面密度 $\\Sigma(r)$ 定义为在柱坐标半径 $r$ 处对 $\\rho(z)$ 的垂直积分。假设温度仅是半径的函数。您正在模拟太阳星云中的凝结序列，需要中平面压力来评估凝结锋的位置。\n\n从垂直静力学平衡、理想气体定律和表面密度的定义这些基本关系出发，并假设一个垂直方向上等温的状态方程，推导中平面压力 $P_{0}(r)$ 的表达式，用 $\\Sigma(r)$、开普勒角频率 $\\Omega_{K}(r)$、玻尔兹曼常数 $k_{B}$、平均分子质量 $\\mu$ 和中平面温度 $T(r)$ 来表示。然后，对于以下科学上合理的星盘模型和常数，计算在 $r = 2\\,\\mathrm{AU}$ 处的 $P_{0}$：\n\n- 表面密度分布：$\\Sigma(r) = \\Sigma_{0} \\left(\\frac{r}{r_{0}}\\right)^{-p}$，其中 $\\Sigma_{0} = 1.7 \\times 10^{4}\\ \\mathrm{kg\\ m^{-2}}$，$r_{0} = 1\\ \\mathrm{AU}$，$p = 1.5$。\n- 温度分布：$T(r) = T_{0} \\left(\\frac{r}{r_{0}}\\right)^{-q}$，其中 $T_{0} = 280\\ \\mathrm{K}$，$q = 0.5$。\n- 恒星质量：$M_{\\star} = 1.9885 \\times 10^{30}\\ \\mathrm{kg}$。\n- 平均分子质量：$\\mu = 2.34\\,m_{p}$，其中 $m_{p} = 1.6726219 \\times 10^{-27}\\ \\mathrm{kg}$ 是质子质量。\n- 开普勒角频率：$\\Omega_{K}(r) = \\sqrt{\\frac{G M_{\\star}}{r^{3}}}$，其中 $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m^{3}\\ kg^{-1}\\ s^{-2}}$。\n- 玻尔兹曼常数：$k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\ K^{-1}}$。\n- 天文单位 (AU)：$1\\ \\mathrm{AU} = 1.495978707 \\times 10^{11}\\ \\mathrm{m}$。\n\n将您计算出的 $P_{0}(2\\,\\mathrm{AU})$ 数值结果四舍五入到三位有效数字。最终压力以 $\\mathrm{Pa}$ 为单位表示。\n\n最后，基于第一性原理，解释对于一种其饱和蒸气压遵循克劳修斯-克拉佩龙形式 $P_{\\mathrm{sat}}(T) = P_{s}\\,\\exp\\!\\left(-\\frac{A}{T}\\right)$ 的挥发性物质，$P_{0}(r)$ 的大小如何影响其凝结锋的径向位置。假设该物质的中平面分压为 $f_{i}\\,P_{0}(r)$，其中 $0  f_{i}  1$ 是其摩尔分数。您的解释应该是定性的，但需基于推导出的 $P_{0}(r)$ 的依赖关系。该解释不需要任何额外的计算，并且不影响所要求的 $P_{0}(2\\,\\mathrm{AU})$ 的数值答案。",
            "solution": "该问题要求分三个部分作答：首先，推导中平面压力 $P_{0}(r)$ 的表达式；其次，计算在特定半径处的该压力值；第三，定性解释压力如何影响凝结锋。\n\n第一部分：中平面压力 $P_{0}(r)$ 的推导\n\n我们从垂直静力学平衡方程开始，该方程表明垂直压力梯度与恒星引力的垂直分量相平衡。\n$$\n\\frac{dP}{dz} = -\\rho g_{z}\n$$\n其中 $P(z)$ 是压力，$\\rho(z)$ 是质量密度，$g_{z}$ 是在柱坐标半径 $r$ 和中平面上方高度 $z$ 处的引力加速度的垂直分量。对于 $z \\ll r$ 的薄盘，由质量为 $M_{\\star}$ 的中心恒星引起的垂直加速度近似为：\n$$\ng_{z} = - \\frac{G M_{\\star}}{r^{2}} \\sin(\\theta) \\approx - \\frac{G M_{\\star}}{r^{2}} \\tan(\\theta) = - \\frac{G M_{\\star}}{r^{2}} \\frac{z}{r} = - \\left(\\frac{G M_{\\star}}{r^{3}}\\right) z\n$$\n括号中的项是开普勒角频率的平方，即 $\\Omega_{K}(r) = \\sqrt{\\frac{G M_{\\star}}{r^{3}}}$。因此，$g_{z} = -\\Omega_{K}^{2} z$。将此代入静力学平衡方程，得到：\n$$\n\\frac{dP}{dz} = -\\rho(z) \\Omega_{K}^{2} z\n$$\n问题陈述气体满足理想气体定律：\n$$\nP(z) = \\frac{\\rho(z) k_{B} T(r)}{\\mu}\n$$\n其中 $k_{B}$ 是玻尔兹曼常数，$\\mu$ 是平均分子质量，$T(r)$ 是温度。一个关键假设是星盘在垂直方向上是等温的，意味着 $T$ 仅是 $r$ 的函数，不随 $z$ 变化。我们可以重新整理理想气体定律，用压力表示密度：\n$$\n\\rho(z) = \\frac{\\mu}{k_{B} T(r)} P(z)\n$$\n将这个 $\\rho(z)$ 的表达式代入静力学平衡方程，得到一个关于 $P(z)$ 的一阶微分方程：\n$$\n\\frac{dP}{dz} = - \\left(\\frac{\\mu P(z)}{k_{B} T(r)}\\right) \\Omega_{K}^{2} z \\implies \\frac{1}{P} \\frac{dP}{dz} = - \\frac{\\mu \\Omega_{K}^{2}}{k_{B} T(r)} z\n$$\n我们可以将此方程从中平面（此处 $z=0$ 且 $P=P_{0}$）积分到高度 $z$：\n$$\n\\int_{P_{0}}^{P(z)} \\frac{dP'}{P'} = - \\frac{\\mu \\Omega_{K}^{2}}{k_{B} T(r)} \\int_{0}^{z} z' dz'\n$$\n$$\n\\ln\\left(\\frac{P(z)}{P_{0}}\\right) = - \\frac{\\mu \\Omega_{K}^{2}}{2 k_{B} T(r)} z^{2}\n$$\n求解 $P(z)$，得到一个高斯压力分布：\n$$\nP(z) = P_{0} \\exp\\left(-\\frac{\\mu \\Omega_{K}^{2}}{2 k_{B} T(r)} z^{2}\\right)\n$$\n再次使用理想气体定律，我们得到密度分布：\n$$\n\\rho(z) = \\frac{\\mu P(z)}{k_{B} T(r)} = \\frac{\\mu P_{0}}{k_{B} T(r)} \\exp\\left(-\\frac{\\mu \\Omega_{K}^{2}}{2 k_{B} T(r)} z^{2}\\right) = \\rho_{0} \\exp\\left(-\\frac{z^{2}}{2h^{2}}\\right)\n$$\n其中 $\\rho_{0} = \\frac{\\mu P_{0}}{k_{B} T(r)}$ 是中平面密度，而 $h = \\sqrt{\\frac{k_{B} T(r)}{\\mu \\Omega_{K}^{2}}}$ 是气体压力标高。\n\n表面密度 $\\Sigma(r)$ 定义为体密度在整个 $z$ 上的积分：\n$$\n\\Sigma(r) = \\int_{-\\infty}^{\\infty} \\rho(z) dz = \\rho_{0} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{z^{2}}{2h^{2}}\\right) dz\n$$\n这是一个标准的高斯积分，形式为 $\\int_{-\\infty}^{\\infty} \\exp(-ax^{2})dx = \\sqrt{\\pi/a}$。此处，$a = 1/(2h^{2})$，所以积分结果为 $\\sqrt{2\\pi h^{2}} = h\\sqrt{2\\pi}$。\n$$\n\\Sigma(r) = \\rho_{0} h \\sqrt{2\\pi}\n$$\n我们的目标是求出 $P_{0}$。我们代入 $\\rho_{0}$ 和 $h$ 的表达式：\n$$\n\\Sigma(r) = \\left(\\frac{\\mu P_{0}}{k_{B} T(r)}\\right) \\left(\\sqrt{\\frac{k_{B} T(r)}{\\mu \\Omega_{K}^{2}}}\\right) \\sqrt{2\\pi}\n$$\n简化此表达式：\n$$\n\\Sigma(r) = \\frac{P_{0}}{\\Omega_{K}(r)} \\frac{\\mu}{\\sqrt{\\mu}} \\frac{\\sqrt{k_{B} T(r)}}{k_{B} T(r)} \\sqrt{2\\pi} = \\frac{P_{0} \\sqrt{2\\pi\\mu}}{\\Omega_{K}(r) \\sqrt{k_{B} T(r)}}\n$$\n最后，我们重新整理以求解中平面压力 $P_{0}(r)$：\n$$\nP_{0}(r) = \\frac{\\Sigma(r) \\Omega_{K}(r) \\sqrt{k_{B} T(r)}}{\\sqrt{2\\pi \\mu}}\n$$\n这就是所求的解析表达式。\n\n第二部分：$P_{0}(r=2\\,\\mathrm{AU})$ 的数值计算\n\n给定以下常数和函数形式：\n- $r = 2\\,\\mathrm{AU} = 2 \\times 1.495978707 \\times 10^{11}\\,\\mathrm{m} = 2.991957414 \\times 10^{11}\\,\\mathrm{m}$。\n- $\\Sigma(r) = \\Sigma_{0} \\left(\\frac{r}{r_{0}}\\right)^{-p}$，其中 $\\Sigma_{0} = 1.7 \\times 10^{4}\\,\\mathrm{kg\\,m^{-2}}$，$r_{0} = 1\\,\\mathrm{AU}$，$p=1.5$。\n在 $r=2\\,\\mathrm{AU}$ 处，$\\frac{r}{r_{0}} = 2$。所以，$\\Sigma(2\\,\\mathrm{AU}) = (1.7 \\times 10^{4}) \\times (2)^{-1.5}\\,\\mathrm{kg\\,m^{-2}}$。\n- $T(r) = T_{0} \\left(\\frac{r}{r_{0}}\\right)^{-q}$，其中 $T_{0} = 280\\,\\mathrm{K}$，$q=0.5$。\n在 $r=2\\,\\mathrm{AU}$ 处，$T(2\\,\\mathrm{AU}) = 280 \\times (2)^{-0.5}\\,\\mathrm{K}$。\n- $\\Omega_{K}(r) = \\sqrt{\\frac{G M_{\\star}}{r^{3}}}$，其中 $G = 6.67430 \\times 10^{-11}\\,\\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$，$M_{\\star} = 1.9885 \\times 10^{30}\\,\\mathrm{kg}$。\n- $\\mu = 2.34\\,m_{p} = 2.34 \\times 1.6726219 \\times 10^{-27}\\,\\mathrm{kg} = 3.913935246 \\times 10^{-27}\\,\\mathrm{kg}$。\n- $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$。\n\n现在，我们计算在 $r = 2\\,\\mathrm{AU}$ 处各项的值：\n- $\\Sigma(2\\,\\mathrm{AU}) = (1.7 \\times 10^{4}) \\times 2^{-1.5} \\approx 6010.415\\,\\mathrm{kg\\,m^{-2}}$。\n- $T(2\\,\\mathrm{AU}) = 280 \\times 2^{-0.5} \\approx 197.990\\,\\mathrm{K}$。\n- $\\Omega_{K}(2\\,\\mathrm{AU}) = \\sqrt{\\frac{(6.67430 \\times 10^{-11}) \\times (1.9885 \\times 10^{30})}{(2.991957414 \\times 10^{11})^{3}}} \\approx 7.039016 \\times 10^{-8}\\,\\mathrm{s^{-1}}$。\n\n现在我们来计算 $P_0$ 表达式的分子和分母：\n- 分子：$\\Sigma(r) \\Omega_{K}(r) \\sqrt{k_{B} T(r)}$\n$\\sqrt{k_{B} T(2\\,\\mathrm{AU})} = \\sqrt{(1.380649 \\times 10^{-23}) \\times 197.990} \\approx \\sqrt{2.73350 \\times 10^{-21}} \\approx 5.22829 \\times 10^{-11}\\,\\mathrm{J^{1/2}}$。\n分子 $\\approx (6010.415) \\times (7.039016 \\times 10^{-8}) \\times (5.22829 \\times 10^{-11}) \\approx 2.21273 \\times 10^{-14}\\,\\mathrm{kg\\,m^{-1}\\,s^{-2}}$。\n- 分母：$\\sqrt{2\\pi \\mu}$\n$\\sqrt{2\\pi \\times (3.913935 \\times 10^{-27})} \\approx \\sqrt{2.45917 \\times 10^{-26}} \\approx 1.56817 \\times 10^{-13}\\,\\mathrm{kg^{1/2}}$。\n\n最后，我们计算 $P_{0}(2\\,\\mathrm{AU})$：\n$$\nP_{0}(2\\,\\mathrm{AU}) = \\frac{2.21273 \\times 10^{-14}}{1.56817 \\times 10^{-13}} \\approx 0.141103\\,\\mathrm{Pa}\n$$\n四舍五入到三位有效数字，中平面压力为 $0.141\\,\\mathrm{Pa}$。\n\n第三部分：$P_{0}(r)$ 对凝结锋的影响\n\n摩尔分数为 $f_i$ 的挥发性物质，当其分压 $P_{i}(r) = f_{i}P_{0}(r)$ 等于其饱和蒸气压 $P_{\\mathrm{sat}}(T)$ 时，将从气相中凝结出来。这种情况发生的位置 $r_{\\mathrm{ice}}$，即为凝结锋或“雪线”。其条件是：\n$$\nf_{i} P_{0}(r_{\\mathrm{ice}}) = P_{\\mathrm{sat}}(T(r_{\\mathrm{ice}}))\n$$\n饱和蒸气压由克劳修斯-克拉佩龙关系 $P_{\\mathrm{sat}}(T) = P_{s}\\,\\exp(-A/T)$ 给出，它是一个随温度急剧变化的函数。\n\n中平面压力 $P_{0}(r)$ 和温度 $T(r)$ 都是半径 $r$ 的递减函数。因此，分压 $P_{i}(r)$ 和饱和蒸气压 $P_{\\mathrm{sat}}(T(r))$ 都随半径的增加而减小。雪线位于这两条压力曲线相交的半径处。要使凝结发生在较大半径处（冷区域）而不发生在较小半径处（热区域），必须满足在 $r  r_{\\mathrm{ice}}$ 时分压 $P_i(r)$ 小于 $P_{\\mathrm{sat}}(T(r))$，而在 $r > r_{\\mathrm{ice}}$ 时分压大于 $P_{\\mathrm{sat}}(T(r))$。\n\n中平面压力 $P_{0}(r)$ 的大小直接决定了分压 $P_{i}(r)$ 的大小。如果我们考虑一个具有更高整体中平面压力的星盘（例如，由于更大的表面密度 $\\Sigma_0$），整个 $P_{i}(r)$ 曲线会向上平移。而 $P_{\\mathrm{sat}}(T(r))$ 曲线仅取决于温度分布，保持不变。\n\n新的、更高的分压曲线现在将在一个不同的位置与饱和蒸气压曲线相交。由于 $P_{\\mathrm{sat}}(T(r))$ 曲线向着较小半径（更高温度）的方向急剧增加，向上平移的 $P_{i}(r)$ 曲线必须在一个 $P_{\\mathrm{sat}}$ 更高的点与之相交。更高的 $P_{\\mathrm{sat}}$ 值对应更高的温度 $T$。由于温度随半径减小，更高的温度出现在更小的半径 $r$ 处。\n\n因此，更高的中平面压力 $P_{0}(r)$ 使得挥发性物质可以在更高的温度下凝结。在原行星盘的径向结构背景下，这意味着凝结锋 $r_{\\mathrm{ice}}$ 向内移动，更靠近恒星。反之，较低的中平面压力会将凝结锋向外推到星盘更冷的区域。",
            "answer": "$$\n\\boxed{0.141}\n$$"
        },
        {
            "introduction": "建立了星云的物理条件后，我们现在可以解决一个核心问题：特定矿物在什么温度下变得稳定？本练习聚焦于镁橄榄石，一种关键的造岩硅酸盐矿物，并指导你完成一项基本的热力学计算，以找出其凝结温度 $T_c$。这个练习  阐释了如何利用化学平衡常数和元素丰度来预测首批固体的形成。",
            "id": "4157164",
            "problem": "将在总气体压力 $P=10^{-3}\\ \\mathrm{bar}$ 的条件下，对由太阳成分气体形成镁橄榄石 $\\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrm{s})$ 的过程进行一个简化的平衡凝聚计算。假设在高温下携带相关元素的主要气体组分是 $\\mathrm{Mg}(\\mathrm{g})$、$\\mathrm{SiO}(\\mathrm{g})$ 和 $\\mathrm{O}_{2}(\\mathrm{g})$，并且固态镁橄榄石在出现时具有单位活度。所研究的反应为\n$$2\\,\\mathrm{Mg}\\text{(g)}+\\mathrm{SiO}\\text{(g)}+\\frac{3}{2}\\,\\mathrm{O}_{2}\\text{(g)}\\longrightarrow \\mathrm{Mg}_{2}\\mathrm{SiO}_{4}\\text{(s)}.$$\n将气体视为理想气体，因此组分 $i$ 的分压为 $p_{i}=y_{i}\\,P$，其中 $y_{i}$ 是其在气体中的摩尔分数，$P$ 是总压力。取标准态压力为 $p^{\\circ}=1\\ \\mathrm{bar}$，因此气体的无量纲活度为 $p_{i}/p^{\\circ}$，固体的活度为 $1$。使用凝聚开始时未凝聚气体的以下太阳成分摩尔分数：$y_{\\mathrm{Mg}}=3.98\\times 10^{-5}$、$y_{\\mathrm{SiO}}=3.24\\times 10^{-5}$ 和 $y_{\\mathrm{O}_{2}}=1.00\\times 10^{-6}$（假设在所关注的狭窄温度区间内近似恒定）。上述反应的已制表平衡常数由一个经验拟合公式给出，\n$$\\log_{10}K_{p}(T)=-12.0+\\frac{6.45\\times 10^{4}}{T},$$\n其中 $K_{p}(T)$ 是用气体分压表示的平衡常数，$T$ 是以开尔文为单位的温度。\n\n从平衡常数和理想气体定律的定义出发，推导镁橄榄石开始凝聚的条件，并计算在 $P=10^{-3}\\ \\mathrm{bar}$ 时反应变得热力学上有利的凝聚温度 $T_{c}$。将最终数值答案四舍五入到四位有效数字，并以开尔文表示。",
            "solution": "从太阳成分气体中凝聚镁橄榄石 $\\mathrm{Mg}_{2}\\mathrm{SiO}_{4}\\text{(s)}$ 的过程由以下化学反应描述：\n$$2\\,\\mathrm{Mg}\\text{(g)}+\\mathrm{SiO}\\text{(g)}+\\frac{3}{2}\\,\\mathrm{O}_{2}\\text{(g)}\\rightleftharpoons \\mathrm{Mg}_{2}\\mathrm{SiO}_{4}\\text{(s)}$$\n化学平衡的条件是热力学平衡常数 $K(T)$ 等于反应商 $Q$。当气体冷却时，凝聚在首次满足此条件的温度 $T_c$ 开始。热力学平衡常数用反应物和产物的活度 $a_i$ 来定义。\n$$K(T) = \\frac{a_{\\mathrm{Mg}_{2}\\mathrm{SiO}_{4}\\text{(s)}}}{a_{\\mathrm{Mg}\\text{(g)}}^{2} a_{\\mathrm{SiO}\\text{(g)}} a_{\\mathrm{O}_{2}\\text{(g)}}^{3/2}}$$\n问题陈述固态镁橄榄石的活度为1，即 $a_{\\mathrm{Mg}_{2}\\mathrm{SiO}_{4}\\text{(s)}} = 1$。理想气体组分的活度由 $a_i = p_i / p^{\\circ}$ 给出，其中 $p_i$ 是组分 $i$ 的分压，$p^{\\circ}=1\\ \\mathrm{bar}$ 是标准态压力。将这些代入 $K(T)$ 的表达式中，得到：\n$$K(T) = \\frac{1}{\\left(\\frac{p_{\\mathrm{Mg}}}{p^{\\circ}}\\right)^{2} \\left(\\frac{p_{\\mathrm{SiO}}}{p^{\\circ}}\\right) \\left(\\frac{p_{\\mathrm{O}_2}}{p^{\\circ}}\\right)^{3/2}}$$\n根据理想气体定律，各组分 $i$ 的分压 $p_i$ 与其摩尔分数 $y_i$ 和总压 $P$ 的关系为 $p_i = y_i P$。当气体分压满足平衡条件时，凝聚在温度 $T_c$ 开始。将 $p_i = y_i P$ 代入方程：\n$$K(T_c) = \\frac{1}{\\left(\\frac{y_{\\mathrm{Mg}}P}{p^{\\circ}}\\right)^{2} \\left(\\frac{y_{\\mathrm{SiO}}P}{p^{\\circ}}\\right) \\left(\\frac{y_{\\mathrm{O}_2}P}{p^{\\circ}}\\right)^{3/2}}$$\n这个表达式可以重新整理，将摩尔分数项和压力项组合在一起：\n$$K(T_c) = \\frac{1}{y_{\\mathrm{Mg}}^{2} y_{\\mathrm{SiO}} y_{\\mathrm{O}_2}^{3/2} \\left(\\frac{P}{p^{\\circ}}\\right)^{4.5}}$$\n问题为平衡常数提供了一个经验拟合公式，记作 $K_p(T)$。由于对数的自变量必须是无量纲的，这个 $K_p(T)$ 就是热力学平衡常数 $K(T)$。我们可以通过令两个平衡常数的表达式相等来求解 $T_c$。为了处理大范围的数值，使用对数最为方便。对 $K(T_c)$ 的表达式取以10为底的对数：\n$$\\log_{10} K(T_c) = \\log_{10} \\left( \\frac{1}{y_{\\mathrm{Mg}}^{2} y_{\\mathrm{SiO}} y_{\\mathrm{O}_2}^{3/2} (P/p^{\\circ})^{4.5}} \\right) = - \\log_{10} \\left( y_{\\mathrm{Mg}}^{2} y_{\\mathrm{SiO}} y_{\\mathrm{O}_2}^{3/2} (P/p^{\\circ})^{4.5} \\right)$$\n根据对数的性质，上式变为：\n$$\\log_{10} K(T_c) = - \\left[ 2\\log_{10}(y_{\\mathrm{Mg}}) + \\log_{10}(y_{\\mathrm{SiO}}) + \\frac{3}{2}\\log_{10}(y_{\\mathrm{O}_2}) + 4.5\\log_{10}\\left(\\frac{P}{p^{\\circ}}\\right) \\right]$$\n给定数值为：$y_{\\mathrm{Mg}}=3.98\\times 10^{-5}$、$y_{\\mathrm{SiO}}=3.24\\times 10^{-5}$、$y_{\\mathrm{O}_2}=1.00\\times 10^{-6}$，以及 $P=10^{-3}\\ \\mathrm{bar}$，标准态压力 $p^{\\circ}=1\\ \\mathrm{bar}$，所以 $P/p^{\\circ} = 10^{-3}$。\n我们来计算方括号中的各项：\n$2\\log_{10}(3.98\\times 10^{-5}) = 2(\\log_{10}(3.98) - 5) \\approx 2(0.59988 - 5) = 2(-4.40012) = -8.80024$\n$\\log_{10}(3.24\\times 10^{-5}) = \\log_{10}(3.24) - 5 \\approx 0.51055 - 5 = -4.48945$\n$\\frac{3}{2}\\log_{10}(1.00\\times 10^{-6}) = 1.5(-6) = -9.0$\n$4.5\\log_{10}(10^{-3}) = 4.5(-3) = -13.5$\n将这些项相加：\n$\\log_{10} K(T_c) = -[-8.80024 - 4.48945 - 9.0 - 13.5] = -[-35.78969] = 35.78969$\n现在，我们将这个值与给定的在 $T=T_c$ 时的平衡常数经验拟合公式相等：\n$$\\log_{10}K_{p}(T_c) = -12.0 + \\frac{6.45\\times 10^{4}}{T_c}$$\n$$35.78969 = -12.0 + \\frac{6.45\\times 10^{4}}{T_c}$$\n求解 $T_c$：\n$$35.78969 + 12.0 = \\frac{6.45\\times 10^{4}}{T_c}$$\n$$47.78969 = \\frac{6.45\\times 10^{4}}{T_c}$$\n$$T_c = \\frac{6.45\\times 10^{4}}{47.78969} \\approx 1349.6436\\ \\mathrm{K}$$\n问题要求答案四舍五入到四位有效数字。\n$$T_c \\approx 1350\\ \\mathrm{K}$$\n这就是在指定条件下镁橄榄石的凝聚温度。",
            "answer": "$$\n\\boxed{1350}\n$$"
        },
        {
            "introduction": "凝结并非一个静态事件；它是一个动态过程，随着固体的形成并从系统中物理移除，会改变剩余气体的成分。本练习介绍了瑞利分馏模型，这是一个强大的工具，用于追踪经历相变与分离的系统的化学演化。通过实施这个模型 ，你将探索凝结物的逐步移除如何影响元素在气体和固体储库之间的分布。",
            "id": "4157117",
            "problem": "考虑一个混合均匀的原行星盘气体包，其主要成分为氢，并含有痕量丰度的镁。随着星盘冷却，含镁硅酸盐固体会凝聚并立即从气体中移除（通过沉降和漂移）。这一过程可以通过瞬时移除平衡固相的 Rayleigh 分馏模型很好地描述。本题的目标是，沿着一条指定的冷却路径，量化镁在气体和凝聚的硅酸盐固体之间的分配情况。\n\n从以下基本原理出发：\n- 气相中镁的浓度，记为 $C_g$，定义为 $C_g = n_g/M_g$，其中 $n_g$ 是气体中镁的摩尔数，$M_g$ 是气体质量。\n- 在任意温度 $T$ 下，瞬时凝聚并被移除的硅酸盐固体中的平衡镁浓度，记为 $C_s$，通过一个体分配系数（也称为分布系数）$D(T)$ 与气体浓度成正比，即 $C_s = D(T)\\,C_g$。\n- 质量为 $\\mathrm{d}M_s$ 的少量固体的移除会使气体质量减少 $\\mathrm{d}M_g = -\\mathrm{d}M_s$，并从气体中带走 $\\mathrm{d}n_s = C_s\\,\\mathrm{d}M_s$ 摩尔的镁。\n\n假设体分配系数 $D(T)$ 的温度依赖性源于凝聚反应的热力学平衡，并且可以使用一个恒定的反应焓 $\\Delta H$ 和一个参考温度 $T_{\\mathrm{ref}}$（在该温度下系数为 $D_{\\mathrm{ref}}$）通过范特霍夫关系进行建模。普适摩尔气体常数 $R$ 必须使用焦耳/摩尔/开尔文（J/mol/K）作为单位。\n\n给定一个离散的冷却路径，包括一个温度序列，以及在每个温度步骤中，转化为固体并被瞬时移除的剩余气体质量的分数。对于一个温度序列 $\\{T_i\\}$ 和每步的移除分数 $\\{\\phi_i\\}$（因此第 $i$ 步后剩余气体质量的分数为 $F_i = 1 - \\phi_i$），任务是计算：\n1. 在序列结束时，保留在气体中的镁占初始总镁的最终分数 $f_g^{\\mathrm{Mg}}$。\n2. 存在于凝聚的硅酸盐固体中的镁占初始总镁的最终分数 $f_s^{\\mathrm{Mg}} = 1 - f_g^{\\mathrm{Mg}}$。\n3. 最终的气相镁浓度 $C_g^{\\mathrm{end}}$，单位为 $\\mathrm{mol/kg}$。\n\n所有镁的分数必须以小数形式报告（不带百分号）。最终气相浓度必须以 $\\mathrm{mol/kg}$ 为单位报告。\n\n测试套件：\n所有案例均使用普适气体常数 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 和初始气相镁浓度 $C_0 = 3.8\\times 10^{-5}\\,\\mathrm{mol/kg}$。\n\n- 案例 A（适度移除的一般冷却）：温度 $\\{T_i\\} = [\\,1600,1500,1400,1300,1200\\,]\\,\\mathrm{K}$，移除分数 $\\{\\phi_i\\} = [\\,0.005,0.005,0.008,0.010,0.012\\,]$，其中在 $T_{\\mathrm{ref}} = 1400\\,\\mathrm{K}$ 时 $D_{\\mathrm{ref}} = 1.0$，且 $\\Delta H = -3.0\\times 10^{5}\\,\\mathrm{J/mol}$。\n- 案例 B（无固体移除）：温度 $\\{T_i\\} = [\\,1600,1500,1400,1300,1200\\,]\\,\\mathrm{K}$，移除分数 $\\{\\phi_i\\} = [\\,0.0,0.0,0.0,0.0,0.0\\,]$，其中在 $T_{\\mathrm{ref}} = 1400\\,\\mathrm{K}$ 时 $D_{\\mathrm{ref}} = 1.0$，且 $\\Delta H = -3.0\\times 10^{5}\\,\\mathrm{J/mol}$。\n- 案例 C（镁相对不相容的高温移除）：温度 $\\{T_i\\} = [\\,1700,1650,1600,1550\\,]\\,\\mathrm{K}$，移除分数 $\\{\\phi_i\\} = [\\,0.020,0.020,0.020,0.020\\,]$，其中在 $T_{\\mathrm{ref}} = 1400\\,\\mathrm{K}$ 时 $D_{\\mathrm{ref}} = 1.0$，且 $\\Delta H = -3.0\\times 10^{5}\\,\\mathrm{J/mol}$。\n- 案例 D（固相分配更强的低温移除）：温度 $\\{T_i\\} = [\\,1400,1350,1300,1250,1200,1150\\,]\\,\\mathrm{K}$，移除分数 $\\{\\phi_i\\} = [\\,0.010,0.015,0.020,0.025,0.030,0.040\\,]$，其中在 $T_{\\mathrm{ref}} = 1400\\,\\mathrm{K}$ 时 $D_{\\mathrm{ref}} = 1.2$，且 $\\Delta H = -4.0\\times 10^{5}\\,\\mathrm{J/mol}$。\n- 案例 E（可忽略移除的边界情况）：温度 $\\{T_i\\} = [\\,1400\\,]\\,\\mathrm{K}$，移除分数 $\\{\\phi_i\\} = [\\,10^{-6}\\,]$，其中在 $T_{\\mathrm{ref}} = 1400\\,\\mathrm{K}$ 时 $D_{\\mathrm{ref}} = 1.0$，且 $\\Delta H = -3.0\\times 10^{5}\\,\\mathrm{J/mol}$。\n\n您的程序必须为每个案例计算元组 $(f_g^{\\mathrm{Mg}}, f_s^{\\mathrm{Mg}}, C_g^{\\mathrm{end}})$，并输出一行结果。该行结果是一个用方括号括起来的逗号分隔列表，按扁平化顺序连接案例 A、案例 B、案例 C、案例 D 和案例 E 的三个值，即 $[\\,f_g^{\\mathrm{Mg}}(\\mathrm{A}), f_s^{\\mathrm{Mg}}(\\mathrm{A}), C_g^{\\mathrm{end}}(\\mathrm{A}), f_g^{\\mathrm{Mg}}(\\mathrm{B}), \\dots, f_g^{\\mathrm{Mg}}(\\mathrm{E}), f_s^{\\mathrm{Mg}}(\\mathrm{E}), C_g^{\\mathrm{end}}(\\mathrm{E})\\,]$。$C_g^{\\mathrm{end}}$ 以 $\\mathrm{mol/kg}$ 为单位表示。",
            "solution": "该问题要求计算在原行星盘的凝聚过程中，镁在气相和固相之间的分配。该过程被建模为 Rayleigh 分馏的离散形式，其中凝聚的固体被瞬时移除，且不再与气体重新达到平衡。我们将首先从所提供的基本原理中推导出控制方程，然后构建一个分步算法，为每个指定的测试案例求解系统的最终状态。\n\n首先，我们建立控制气相镁浓度 $C_g$ 变化的方程。浓度定义为 $C_g = n_g/M_g$，其中 $n_g$ 是气相中镁的摩尔数，$M_g$ 是气体包的总质量。$n_g$ 的全微分由乘积法则给出：\n$$ \\mathrm{d}n_g = \\mathrm{d}(C_g M_g) = C_g \\mathrm{d}M_g + M_g \\mathrm{d}C_g $$\n当质量为 $\\mathrm{d}M_s$ 的固体凝聚时，气体质量等量减少，即 $\\mathrm{d}M_g = -\\mathrm{d}M_s$。从气体中移除的镁的摩尔数为 $\\mathrm{d}n_s = C_s \\mathrm{d}M_s$，其中 $C_s$ 是凝聚固体中的镁浓度。这种移除消耗了气体中的镁，因此 $\\mathrm{d}n_g = -\\mathrm{d}n_s$。代入给定关系式：\n$$ \\mathrm{d}n_g = - (C_s \\mathrm{d}M_s) = - (D(T) C_g) (-\\mathrm{d}M_g) = D(T) C_g \\mathrm{d}M_g $$\n此处，$D(T)$ 是依赖于温度的体分配系数。令 $\\mathrm{d}n_g$ 的两个表达式相等，得到：\n$$ C_g \\mathrm{d}M_g + M_g \\mathrm{d}C_g = D(T) C_g \\mathrm{d}M_g $$\n整理此方程以分离变量，得到 Rayleigh 分馏的基本微分方程：\n$$ \\frac{\\mathrm{d}C_g}{C_g} = (D(T) - 1) \\frac{\\mathrm{d}M_g}{M_g} $$\n对于冷却序列中的一个离散步骤 $i$，我们假设温度 $T_i$ 以及分配系数 $D_i = D(T_i)$ 是恒定的。我们对该方程从步骤开始时的状态（$C_{g,i-1}$, $M_{g,i-1}$）积分到结束时的状态（$C_{g,i}$, $M_{g,i}$）。\n$$ \\int_{C_{g,i-1}}^{C_{g,i}} \\frac{\\mathrm{d}C_g}{C_g} = (D_i - 1) \\int_{M_{g,i-1}}^{M_{g,i}} \\frac{\\mathrm{d}M_g}{M_g} $$\n$$ \\ln\\left(\\frac{C_{g,i}}{C_{g,i-1}}\\right) = (D_i - 1) \\ln\\left(\\frac{M_{g,i}}{M_{g,i-1}}\\right) $$\n对两边取指数，得到单步的经典 Rayleigh 分馏方程：\n$$ C_{g,i} = C_{g,i-1} \\left(\\frac{M_{g,i}}{M_{g,i-1}}\\right)^{D_i - 1} $$\n问题将 $\\phi_i$ 定义为在步骤 $i$ 中被移除的剩余气体质量的分数。因此，步骤 $i$ 之后剩余气体质量的分数为 $M_{g,i}/M_{g,i-1} = 1 - \\phi_i$。这给出了我们对气相浓度的迭代更新规则：\n$$ C_{g,i} = C_{g,i-1} (1 - \\phi_i)^{D_i - 1} $$\n\n接下来，我们确定分配系数 $D(T)$。其温度依赖性由恒定反应焓 $\\Delta H$ 下的积分形式范特霍夫方程描述：\n$$ \\ln \\left( \\frac{D(T)}{D_{\\mathrm{ref}}} \\right) = -\\frac{\\Delta H}{R} \\left( \\frac{1}{T} - \\frac{1}{T_{\\mathrm{ref}}} \\right) $$\n其中 $R$ 是普适气体常数，$(T_{\\mathrm{ref}}, D_{\\mathrm{ref}})$ 是一个给定的参考点。因此，任意温度 $T_i$ 下的分配系数为：\n$$ D_i = D(T_i) = D_{\\mathrm{ref}} \\exp\\left[ -\\frac{\\Delta H}{R} \\left( \\frac{1}{T_i} - \\frac{1}{T_{\\mathrm{ref}}} \\right) \\right] $$\n\n我们的任务是求出最后一步 $N$ 之后的三个量：最终气体浓度 $C_g^{\\mathrm{end}}$、气体中剩余的镁占初始镁的最终分数 $f_g^{\\mathrm{Mg}}$，以及固相中的最终分数 $f_s^{\\mathrm{Mg}}$。\n\n$C_g^{\\mathrm{end}}$ 是从 $C_{g,0} = C_0$ 开始，迭代应用浓度更新规则的结果：\n$$ C_g^{\\mathrm{end}} = C_{g,N} = C_0 \\prod_{i=1}^{N} (1 - \\phi_i)^{D_i - 1} $$\n\n气体中剩余的镁占初始镁的分数为 $f_g^{\\mathrm{Mg}} = n_{g,N} / n_{g,0}$。我们推导出 $n_{g,i} = C_{g,i}M_{g,i}$ 的迭代更新公式：\n$$ n_{g,i} = C_{g,i}M_{g,i} = \\left[ C_{g,i-1} (1 - \\phi_i)^{D_i-1} \\right] \\left[ M_{g,i-1} (1 - \\phi_i) \\right] = (C_{g,i-1}M_{g,i-1})(1 - \\phi_i)^{D_i} = n_{g,i-1}(1 - \\phi_i)^{D_i} $$\n除以初始摩尔数 $n_{g,0}$，我们得到该分数的迭代更新公式：\n$$ f_{g,i}^{\\mathrm{Mg}} = f_{g,i-1}^{\\mathrm{Mg}} (1 - \\phi_i)^{D_i} $$\n初始条件为 $f_{g,0}^{\\mathrm{Mg}} = 1$。最终分数为：\n$$ f_g^{\\mathrm{Mg}} = \\prod_{i=1}^{N} (1 - \\phi_i)^{D_i} $$\n\n最后，根据镁的质量守恒，凝聚成固体的分数即为：\n$$ f_s^{\\mathrm{Mg}} = 1 - f_g^{\\mathrm{Mg}} $$\n\n每个测试案例的计算步骤如下：\n1. 初始化状态变量：当前浓度 $C_g = C_0 = 3.8 \\times 10^{-5}\\,\\mathrm{mol/kg}$ 和气体中的镁分数 $f_g^{\\mathrm{Mg}} = 1.0$。\n2. 对于给定温度序列 $\\{T_i\\}$ 和移除分数序列 $\\{\\phi_i\\}$ 中的每一步 $i$：\n    a. 使用提供的 $\\Delta H$、$T_{\\mathrm{ref}}$ 和 $D_{\\mathrm{ref}}$，通过范特霍夫方程计算分配系数 $D_i = D(T_i)$。\n    b. 更新浓度：$C_g \\leftarrow C_g \\cdot (1 - \\phi_i)^{D_i - 1}$。\n    c. 更新气体中的镁分数：$f_g^{\\mathrm{Mg}} \\leftarrow f_g^{\\mathrm{Mg}} \\cdot (1 - \\phi_i)^{D_i}$。\n3. 遍历所有步骤后，最终值为 $C_g^{\\mathrm{end}} = C_g$ 和最终的 $f_g^{\\mathrm{Mg}}$。\n4. 计算固相中的分数 $f_s^{\\mathrm{Mg}} = 1 - f_g^{\\mathrm{Mg}}$。\n5. 组合成元组 $(f_g^{\\mathrm{Mg}}, f_s^{\\mathrm{Mg}}, C_g^{\\mathrm{end}})$。\n对每个测试案例实施此程序以生成最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the condensation sequence problem for all test cases.\n    \"\"\"\n    # Universal Gas Constant in J/mol/K\n    R = 8.314462618\n    # Initial gas-phase magnesium concentration in mol/kg\n    C0 = 3.8e-5\n\n    test_cases = [\n        # Case A: General cooling with modest removal\n        {\n            'T_seq': np.array([1600, 1500, 1400, 1300, 1200]),\n            'phi_seq': np.array([0.005, 0.005, 0.008, 0.010, 0.012]),\n            'T_ref': 1400, 'D_ref': 1.0, 'dH': -3.0e5\n        },\n        # Case B: No solids removed\n        {\n            'T_seq': np.array([1600, 1500, 1400, 1300, 1200]),\n            'phi_seq': np.array([0.0, 0.0, 0.0, 0.0, 0.0]),\n            'T_ref': 1400, 'D_ref': 1.0, 'dH': -3.0e5\n        },\n        # Case C: High-temperature removal (Mg incompatible)\n        {\n            'T_seq': np.array([1700, 1650, 1600, 1550]),\n            'phi_seq': np.array([0.020, 0.020, 0.020, 0.020]),\n            'T_ref': 1400, 'D_ref': 1.0, 'dH': -3.0e5\n        },\n        # Case D: Lower-temperature removal (Mg compatible)\n        {\n            'T_seq': np.array([1400, 1350, 1300, 1250, 1200, 1150]),\n            'phi_seq': np.array([0.010, 0.015, 0.020, 0.025, 0.030, 0.040]),\n            'T_ref': 1400, 'D_ref': 1.2, 'dH': -4.0e5\n        },\n        # Case E: Boundary with negligible removal at D=1\n        {\n            'T_seq': np.array([1400]),\n            'phi_seq': np.array([1e-6]),\n            'T_ref': 1400, 'D_ref': 1.0, 'dH': -3.0e5\n        }\n    ]\n\n    def calculate_condensation(T_seq, phi_seq, T_ref, D_ref, dH):\n        \"\"\"\n        Simulates the Rayleigh fractionation process for a given cooling path.\n        \n        Args:\n            T_seq (np.ndarray): Sequence of temperatures in Kelvin.\n            phi_seq (np.ndarray): Sequence of gas mass removal fractions.\n            T_ref (float): Reference temperature in Kelvin.\n            D_ref (float): Partition coefficient at reference temperature.\n            dH (float): Reaction enthalpy in J/mol.\n            \n        Returns:\n            tuple: (f_g_mg, f_s_mg, cg_end)\n                   f_g_mg: final fraction of Mg in gas\n                   f_s_mg: final fraction of Mg in solids\n                   cg_end: final gas-phase Mg concentration in mol/kg\n        \"\"\"\n        cg_current = C0\n        fg_mg = 1.0\n\n        def get_D(T, T_ref_val, D_ref_val, dH_val):\n            \"\"\"Calculates the partition coefficient D at temperature T.\"\"\"\n            if T == T_ref_val:\n                return D_ref_val\n            # Integrated van't Hoff equation\n            exponent = (-dH_val / R) * (1.0 / T - 1.0 / T_ref_val)\n            return D_ref_val * np.exp(exponent)\n\n        for T, phi in zip(T_seq, phi_seq):\n            if phi == 0.0:\n                continue\n            \n            # Calculate partition coefficient D for the current step\n            D = get_D(T, T_ref, D_ref, dH)\n            \n            # Update gas concentration using Rayleigh fractionation equation\n            cg_current *= (1.0 - phi)**(D - 1.0)\n            \n            # Update fraction of Mg remaining in gas phase\n            fg_mg *= (1.0 - phi)**D\n\n        cg_end = cg_current\n        fs_mg = 1.0 - fg_mg\n        \n        return (fg_mg, fs_mg, cg_end)\n\n    all_results = []\n    for case_params in test_cases:\n        result_tuple = calculate_condensation(**case_params)\n        all_results.extend(result_tuple)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}