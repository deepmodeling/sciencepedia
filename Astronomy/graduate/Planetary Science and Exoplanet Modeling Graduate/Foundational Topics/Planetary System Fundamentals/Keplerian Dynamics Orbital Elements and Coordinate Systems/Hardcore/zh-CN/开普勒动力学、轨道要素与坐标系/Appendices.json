{
    "hands_on_practices": [
        {
            "introduction": "掌握轨道动力学的第一步是深刻理解描述天体位置的基本方程。本练习旨在巩固轨道方程的运用，要求你从径向距离$r$反推出真近点角$f$ 。通过这个过程，你不仅能练习代数推导，还能深入思考解的唯一性问题，这对于理解轨道几何形态至关重要。",
            "id": "4166339",
            "problem": "一颗有界系外行星在牛顿引力作用下，在一个固定平面内绕一颗恒星运行。在轨道平面内使用一个惯性极坐标系，其原点位于恒星（焦点），极角 $f$ 从近星点（真近点角）开始测量。轨道是椭圆形的，半长轴为 $a$，偏心率为 $e$，其中 $0 \\le e  1$。从适用于有心力运动的第一性原理和真近点角的定义出发，推导当径向距离等于指定值 $r^{\\ast}$ 时真近点角 $f$ 的表达式，该表达式应以 $a$、$e$ 和 $r^{\\ast}$ 表示。仔细讨论解的多重性与 $r^{\\ast}$ 的函数关系，包括当 $e=0$ 和半径取极值时可能发生的所有退化情况。然后，对于具体情况 $a=1.5\\,\\mathrm{AU}$、$e=0.3$ 和 $r^{\\ast}=1.5\\,\\mathrm{AU}$，计算所有容许的 $f$ 值（以弧度为单位）。将两个 $f$ 值都用弧度表示，并分别四舍五入到5位有效数字。如果存在两个分支，请按 $f$ 的升序排列这两个值。",
            "solution": "本问题要求推导一个在椭圆开普勒轨道上运动的物体，在给定径向距离 $r^{\\ast}$ 处的真近点角 $f$ 的表达式，讨论可能解的数量，并进行具体的数值计算。\n\n这个问题的基础是有心平方反比引力作用下的二体问题的解。从牛顿万有引力定律出发，求解行星相对于恒星的相对位置矢量 $\\vec{r}$ 的运动方程。在以中心恒星（椭圆的焦点之一）为原点、角度 $f$（真近点角）从近星点方向测量的极坐标系 $(r, f)$ 中，轨迹的解由以下圆锥曲线方程给出：\n$$r(f) = \\frac{p}{1 + e \\cos(f)}$$\n其中 $e$ 是轨道的偏心率，$p$ 是半通径。对于有界的椭圆轨道，偏心率的范围是 $0 \\le e  1$。半通径 $p$ 与半长轴 $a$ 和偏心率 $e$ 的关系为 $p = a(1 - e^2)$。将此代入轨道方程，得到椭圆轨道的标准形式：\n$$r(f) = \\frac{a(1 - e^2)}{1 + e \\cos(f)}$$\n\n为了找到径向距离为指定值 $r^{\\ast}$ 时的真近点角 $f$，我们在此方程中令 $r = r^{\\ast}$：\n$$r^{\\ast} = \\frac{a(1 - e^2)}{1 + e \\cos(f)}$$\n我们的目标是解出 $f$。我们首先分离出 $\\cos(f)$ 项：\n$$1 + e \\cos(f) = \\frac{a(1 - e^2)}{r^{\\ast}}$$\n$$e \\cos(f) = \\frac{a(1 - e^2)}{r^{\\ast}} - 1$$\n假设 $e \\neq 0$，我们可以两边除以 $e$ 得到 $\\cos(f)$ 的表达式：\n$$\\cos(f) = \\frac{1}{e} \\left( \\frac{a(1 - e^2)}{r^{\\ast}} - 1 \\right)$$\n然后可以通过取此表达式的反余弦来找到真近点角 $f$。由于余弦函数是偶函数，即 $\\cos(f) = \\cos(-f)$，并且周期为 $2\\pi$，因此对于在 $(-1, 1)$ 范围内的给定 $\\cos(f)$ 值，在区间 $[0, 2\\pi)$ 内有两个解。如果我们令 $C = \\frac{1}{e} \\left( \\frac{a(1-e^2)}{r^{\\ast}} - 1 \\right)$，那么解为：\n$$f = \\pm \\arccos\\left[ \\frac{1}{e} \\left( \\frac{a(1 - e^2)}{r^{\\ast}} - 1 \\right) \\right]$$\n通常，真近点角取值范围为 $[0, 2\\pi)$。如果 $f_1 = \\arccos(C)$ 是主值（位于 $[0, \\pi]$ 内），那么在 $[0, 2\\pi)$ 内的两个唯一解是 $f_1$ 和 $f_2 = 2\\pi - f_1$。\n\n接下来，我们讨论解的多重性。$f$ 是否存在实数解取决于 $C$ 的值，它必须在 $[-1, 1]$ 范围内。椭圆轨道中允许的径向距离范围是从近星点距离 $r_p = a(1-e)$ 到远星点距离 $r_a = a(1+e)$。\n\n1.  **中间半径 ($r_p  r^{\\ast}  r_a$):**\n    对于严格介于最小值和最大值之间的任何半径 $r^{\\ast}$，可以证明 $-1  C  1$。在这种情况下，$\\arccos(C)$ 是良好定义的，并产生一个在 $(0, \\pi)$ 内的值。这给出了在 $[0, 2\\pi)$ 内的**两个不同解**，对应于椭圆上与焦点有相同径向距离的两个点（关于长轴对称）。\n\n2.  **极端半径 ($r^{\\ast} = r_p$ 或 $r^{\\ast} = r_a$):**\n    如果 $r^{\\ast} = r_p = a(1-e)$，则\n    $$C = \\frac{1}{e} \\left( \\frac{a(1 - e^2)}{a(1-e)} - 1 \\right) = \\frac{1}{e} \\left( (1+e) - 1 \\right) = 1$$\n    这得到 $\\cos(f)=1$，所以 $f=0$。在 $[0, 2\\pi)$ 内有**一个唯一解**。这是近星点。\n    如果 $r^{\\ast} = r_a = a(1+e)$，则\n    $$C = \\frac{1}{e} \\left( \\frac{a(1 - e^2)}{a(1+e)} - 1 \\right) = \\frac{1}{e} \\left( (1-e) - 1 \\right) = -1$$\n    这得到 $\\cos(f)=-1$，所以 $f=\\pi$。在 $[0, 2\\pi)$ 内有**一个唯一解**。这是远星点。\n\n3.  **不可达半径 ($r^{\\ast}  r_p$ 或 $r^{\\ast} > r_a$):**\n    如果 $r^{\\ast}$ 超出轨道的物理边界，可以证明 $|C| > 1$。在这种情况下，如预期的那样，$f$ **没有实数解**。\n\n4.  **退化情况：圆形轨道 ($e=0$):**\n    如果轨道是圆形的，$e=0$。我们推导的 $\\cos(f)$ 表达式涉及除以 $e$，因此是奇异的。我们必须回到轨道方程：$r(f) = a(1-0^2)/(1+0) = a$。半径是恒定的。\n    - 如果指定的半径 $r^{\\ast}$ 等于 $a$，那么条件 $r^{\\ast}=a$ 对**所有 $f$ 值**都满足。解是不确定的。应当注意，对于一个完美的圆形轨道，唯一近星点的概念是未明确定义的；任何点都可以被选为 $f=0$ 的参考点。\n    - 如果 $r^{\\ast} \\neq a$，则条件永远不会满足，因此 $f$ **没有解**。\n\n现在，我们对 $a=1.5\\,\\mathrm{AU}$、$e=0.3$ 和 $r^{\\ast}=1.5\\,\\mathrm{AU}$ 的情况进行具体计算。\n首先，我们注意到 $r^{\\ast} = a$。这是一个特殊情况。近星点和远星点距离为：\n$r_p = a(1-e) = 1.5(1-0.3) = 1.5(0.7) = 1.05\\,\\mathrm{AU}$\n$r_a = a(1+e) = 1.5(1+0.3) = 1.5(1.3) = 1.95\\,\\mathrm{AU}$\n因为 $1.05  1.5  1.95$，所以距离 $r^{\\ast}=1.5\\,\\mathrm{AU}$ 是可达的，我们预期 $f$ 有两个不同的解。\n\n我们使用推导出的 $\\cos(f)$ 公式：\n$$\\cos(f) = \\frac{1}{e} \\left( \\frac{a(1 - e^2)}{r^{\\ast}} - 1 \\right)$$\n代入给定值，并注意到 $a/r^{\\ast} = 1$：\n$$\\cos(f) = \\frac{1}{0.3} \\left( \\frac{1.5(1 - 0.3^2)}{1.5} - 1 \\right)$$\n$$\\cos(f) = \\frac{1}{0.3} \\left( (1 - 0.09) - 1 \\right) = \\frac{1}{0.3} (-0.09)$$\n$$\\cos(f) = -0.3$$\n在区间 $[0, 2\\pi)$ 内的两个解由 $f_1 = \\arccos(-0.3)$ 和 $f_2 = 2\\pi - \\arccos(-0.3)$ 给出。\n我们现在计算以弧度为单位的数值。\n$$f_1 = \\arccos(-0.3) \\approx 1.87548898... \\,\\mathrm{rad}$$\n$$f_2 = 2\\pi - f_1 \\approx 6.28318530... - 1.87548898... \\approx 4.40769632... \\,\\mathrm{rad}$$\n将每个值四舍五入到5位有效数字：\n$$f_1 \\approx 1.8755 \\,\\mathrm{rad}$$\n$$f_2 \\approx 4.4077 \\,\\mathrm{rad}$$\n这是真近点角 $f$ 的两个容许值，按升序排列。从几何上看，这些点对应于轨道与半短轴的交点。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.8755  4.4077 \\end{pmatrix}}$$"
        },
        {
            "introduction": "将抽象的轨道根数与实际观测联系起来是行星科学的核心技能。本练习将引导你分析从地球观测者角度看，三维轨道如何投影到二维天球平面和一维视线方向上 。你将发现并解决一个存在于天体测量数据中的关键简并性问题，理解多技术联合观测（如结合视向速度法）在确定真实三维轨道中的强大作用。",
            "id": "4166325",
            "problem": "考虑一个双体开普勒系统中由单颗行星引起的恒星的反射运动。设恒星绕系统质心的轨道由经典轨道根数确定：半长轴 $a$、离心率 $e$、轨道倾角 $i$、升交点经度 $\\Omega$、近心点幅角 $\\omega$、轨道周期 $P$ 和近心点通过时刻 $T_{\\mathrm{p}}$。在天球上测得的视在天体测量运动由天球平面内的两个坐标 $(x,y)$ 构成，这两个坐标是相对于一个右手惯性系定义的，其中 $\\hat{z}$ 轴沿着观测者的视线方向。从近心点坐标系（轨道位于 $z=0$ 平面，真近点角为 $f$）到 $(x,y,z)$ 坐标系的映射是通过由 $(\\Omega,i,\\omega)$ 决定的三次刚体旋转序列得到的，并应用于瞬时位置和速度矢量。\n\n根据刚体旋转的基本原理和近心点基底的定义，分析变换 $(\\Omega,\\omega)\\rightarrow(\\Omega+\\pi,\\omega+\\pi)$ 在所有时刻对天球平面天体测量坐标 $(x,y)$ 以及对视向速度分量 $v_{z}$ 的影响。仅使用旋转矩阵的性质及其对限制在近心点平面内矢量作用的知识，论证天体测量解在此变换下是否表现出简并性，以及 $v_{z}$ 的符号是否改变。然后评估辅助的视向速度（RV）信息（其测量的是相对于质心的 $v_{z}(t)$ 的时间序列）如何打破或不打破这种简并性。\n\n下列陈述中哪些是正确的？\n\nA. 对于任意的 $e$ 和 $i$ 值，天球平面上的纯天体测量位置拟合在 $(\\Omega,\\omega)\\rightarrow(\\Omega+\\pi,\\omega+\\pi)$ 变换下是不变的，因为投影坐标 $(x(t),y(t))$ 在所有时刻都保持不变。\n\nB. 预测的视向速度 $v_{z}(t)$ 在 $(\\Omega,\\omega)\\rightarrow(\\Omega+\\pi,\\omega+\\pi)$ 变换下符号会改变，而其振幅和时序保持不变，因此天体测量与RV的联合拟合可以选择一个唯一的 $(\\Omega,\\omega)$，从而确定升交点的内在标记。\n\nC. 只要有足够长的天体测量时间基线，仅使用天球平面上的自行曲率就可以消除这种简并性，无需RV数据，因为沿视在椭圆的运动方向能唯一确定升交点。\n\nD. 在一个已知的真近点角 $f$（或等效地，在一个与 $T_{\\mathrm{p}}$ 相关的已知时刻）对 $v_{z}$ 的符号进行单次同期测量，就足以区分 $(\\Omega,\\omega)$ 和 $(\\Omega+\\pi,\\omega+\\pi)$。\n\nE. 对于 $e=0$ 的完美圆形轨道，$(\\Omega,\\omega)$ 对是未明确定义的，因此在天体测量拟合中不会出现 $(\\Omega,\\omega)\\leftrightarrow(\\Omega+\\pi,\\omega+\\pi)$ 的简并性。",
            "solution": "首先必须评估问题陈述的有效性。\n\n### 步骤1：提取给定信息\n- **系统：** 一个由一颗恒星和一颗行星组成的双体开普勒系统。\n- **可观测现象：** 恒星围绕系统质心的反射运动。\n- **轨道根数：** 恒星的轨道由经典开普勒根数描述：半长轴 $a$、离心率 $e$、轨道倾角 $i$、升交点经度 $\\Omega$、近心点幅角 $\\omega$、轨道周期 $P$ 和近心点通过时刻 $T_{\\mathrm{p}}$。\n- **坐标系：** 使用一个右手惯性系 $(x,y,z)$，其中天球平面是 $(x,y)$ 平面，$\\hat{z}$ 轴指向观测者的视线方向（正 $z$ 指向观测者）。\n- **变换：** 从近心点坐标系到观测者 $(x,y,z)$ 坐标系的映射是通过由角度 $(\\Omega, i, \\omega)$ 定义的三次刚体旋转序列实现的。\n- **任务：** 分析变换 $(\\Omega, \\omega) \\rightarrow (\\Omega+\\pi, \\omega+\\pi)$ 对视在天体测量坐标 $(x(t), y(t))$ 和视向速度 $v_z(t)$ 的影响。确定此变换是否导致天体测量解出现简并性，以及测量 $v_z(t)$ 的视向速度（RV）数据如何影响这种简并性。\n\n### 步骤2：使用提取的信息进行验证\n- **科学依据：** 该问题牢固地植根于天体力学，特别是开普勒运动和轨道投影的几何学。这些是天体物理学、行星科学和天体测量学中的基本概念。该问题在科学上是合理的。\n- **良定性：** 该问题要求对特定数学变换对可观测量所产生后果进行演绎分析。问题定义清晰，并能根据轨道力学原理得出一组唯一的结论。\n- **客观性：** 问题陈述使用了物理学和天文学的标准、精确术语。它没有歧义、主观性或非科学的主张。\n- **完整性与一致性：** 该问题提供了一个完整的概念框架。它指明了物理系统、参数、坐标系以及待分析的变换。不存在矛盾信息。\n\n### 步骤3：结论与行动\n问题陈述是有效的。这是一个轨道动力学和数据分析中的标准、良定问题。我现在将进行推导和求解。\n\n### 推导\n\n设恒星在其轨道平面上的位置在近心点坐标系中描述。基矢为 $\\hat{P}$（指向近心点）和 $\\hat{Q}$（在轨道平面内，从 $\\hat{P}$ 沿运动方向旋转 $90^\\circ$）。此坐标系中的位置矢量由下式给出：\n$$ \\vec{r}_{\\text{peri}}(t) = r(t) \\cos f(t) \\, \\hat{P} + r(t) \\sin f(t) \\, \\hat{Q} $$\n其中 $r(t)$ 是轨道距离，$f(t)$ 是真近点角，两者都由 $(a, e, P, T_{\\mathrm{p}})$ 确定。以矩阵形式表示，基矢被省略：\n$$ \\vec{r}_{\\text{peri}}(t) = \\begin{pmatrix} r(t) \\cos f(t) \\\\ r(t) \\sin f(t) \\\\ 0 \\end{pmatrix} $$\n从该近心点坐标系到观测者的天球平面坐标系 $(x,y,z)$ 的标准变换由旋转矩阵 $R = R_z(\\Omega)R_x(i)R_z(\\omega)$ 给出，其中 $R_z$ 是绕z轴的旋转，$R_x$ 是绕x轴的旋转。观测者坐标系中的位置矢量是 $\\vec{r}_{\\text{obs}} = R \\vec{r}_{\\text{peri}}$。\n\n我们来分析变换 $(\\Omega, \\omega) \\rightarrow (\\Omega', \\omega') = (\\Omega+\\pi, \\omega+\\pi)$ 对旋转矩阵 $R$ 以及可观测量 $(x, y, v_z)$ 的影响。\n\n新的旋转矩阵 $R'$ 是：\n$$ R' = R_z(\\Omega+\\pi) R_x(i) R_z(\\omega+\\pi) $$\n我们可以使用旋转的复合性质，即 $R_z(\\theta+\\pi) = R_z(\\pi)R_z(\\theta)$ 且 $R_x(\\theta+\\pi) = R_x(\\pi)R_x(\\theta)$。\n$$ R_z(\\pi) = \\begin{pmatrix} -1  0  0 \\\\ 0  -1  0 \\\\ 0  0  1 \\end{pmatrix} $$\n所以，$R' = R_z(\\pi) R_z(\\Omega) R_x(i) R_z(\\omega) R_z(\\pi) = R_z(\\pi) R R_z(\\pi)$。\n\n在观测者坐标系中的位置是 $\\vec{r}_{\\text{obs}} = (x, y, z)^T$。在变换下，新的位置矢量 $\\vec{r}'_{\\text{obs}}$ 是：\n$$ \\vec{r}'_{\\text{obs}} = R' \\vec{r}_{\\text{peri}} = \\left( R_z(\\pi) R R_z(\\pi) \\right) \\vec{r}_{\\text{peri}} $$\n近心点矢量 $\\vec{r}_{\\text{peri}}$ 位于其自身坐标系的 $xy$-平面内。我们来看 $R_z(\\pi)$ 如何作用于它：\n$$ R_z(\\pi) \\vec{r}_{\\text{peri}} = \\begin{pmatrix} -1  0  0 \\\\ 0  -1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} r \\cos f \\\\ r \\sin f \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -r \\cos f \\\\ -r \\sin f \\\\ 0 \\end{pmatrix} = -\\vec{r}_{\\text{peri}} $$\n所以，$\\vec{r}'_{\\text{obs}} = R_z(\\pi) R (-\\vec{r}_{\\text{peri}}) = -R_z(\\pi) (R \\vec{r}_{\\text{peri}}) = -R_z(\\pi) \\vec{r}_{\\text{obs}}$。\n让我们显式地计算它：\n$$ \\vec{r}'_{\\text{obs}} = \\begin{pmatrix} x' \\\\ y' \\\\ z' \\end{pmatrix} = - \\begin{pmatrix} -1  0  0 \\\\ 0  -1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\\\ z \\end{pmatrix} = \\begin{pmatrix} x \\\\ y \\\\ -z \\end{pmatrix} $$\n这个简洁的结果表明，天球平面坐标 $(x,y)$ 在变换 $(\\Omega, \\omega) \\rightarrow (\\Omega+\\pi, \\omega+\\pi)$ 下保持不变，而视线坐标 $z$ 则反转。\n$$ (x'(t), y'(t)) = (x(t), y(t)) $$\n$$ z'(t) = -z(t) $$\n\n现在，我们分析视向速度 $v_z = \\dot{z}$。根据上述结果：\n$$ v'_z(t) = \\frac{d}{dt} z'(t) = \\frac{d}{dt} (-z(t)) = -\\frac{d}{dt} z(t) = -v_z(t) $$\n变换后模型预测的视向速度恰好是原始模型预测速度的负值。\n\n或者，使用视向速度的标准公式：\n$$ v_z(t) = K (e \\cos\\omega + \\cos(\\omega+f)) $$\n其中 $K = \\frac{n a \\sin i}{\\sqrt{1-e^2}}$ 是速度半振幅。参数 $n, a, i, e$ 不受此变换影响。\n让我们代入 $\\omega' = \\omega+\\pi$：\n$$ v'_z(t) = K (e \\cos(\\omega+\\pi) + \\cos((\\omega+\\pi)+f)) = K (-e \\cos\\omega - \\cos(\\omega+f)) = -v_z(t) $$\n两种方法都证实了 $v_z$ 的符号翻转。\n\n### 逐项分析\n\n**A. 对于任意的 $e$ 和 $i$ 值，天球平面上的纯天体测量位置拟合在 $(\\Omega,\\omega)\\rightarrow(\\Omega+\\pi,\\omega+\\pi)$ 变换下是不变的，因为投影坐标 $(x(t),y(t))$ 在所有时刻都保持不变。**\n我们的推导表明 $(x'(t), y'(t)) = (x(t), y(t))$ 在所有时间 $t$ 成立。这意味着对于 $(\\Omega, \\omega)$ 和 $(\\Omega+\\pi, \\omega+\\pi)$ 这两组参数，天球上的投影椭圆是完全相同的。这种不变性对所有离心率 $e$ 和轨道倾角 $i$ 的值都成立。因此，仅基于天体测量位置 $(x,y)$ 的拟合无法区分这两种解，从而表现出完美的简并性。\n**结论：正确。**\n\n**B. 预测的视向速度 $v_{z}(t)$ 在 $(\\Omega,\\omega)\\rightarrow(\\Omega+\\pi,\\omega+\\pi)$ 变换下符号会改变，而其振幅和时序保持不变，因此天体测量与RV的联合拟合可以选择一个唯一的 $(\\Omega,\\omega)$，从而确定升交点的内在标记。**\n我们的推导证实了 $v'_z(t) = -v_z(t)$。这意味着预测的RV曲线在垂直方向上被“翻转”。其振幅 $|v_z|$ 以及零点和极值的时序保持不变，但在每个时间点（除了零点）的符号都相反。当将模型拟合到观测到的RV数据 $v_{z, \\text{obs}}(t)$ 时，两种简并模型中只有一个能正确匹配观测到的速度符号。因此，使用天体测量和RV数据的联合拟合可以打破简并性并选择一个唯一的解。短语“从而确定升交点的内在标记”指的是，解决这种简并性等同于确定两个轨道交点中哪一个是升交点。\n**结论：正确。**\n\n**C. 只要有足够长的天体测量时间基线，仅使用天球平面上的自行曲率就可以消除这种简并性，无需RV数据，因为沿视在椭圆的运动方向能唯一确定升交点。**\n天球平面自行是天空上的速度矢量 $(\\dot{x}(t), \\dot{y}(t))$。由于位置函数 $(x(t), y(t))$ 对两个模型是相同的，它们的时间导数 $(\\dot{x}(t), \\dot{y}(t))$ 也必须相同。同样的道理也适用于加速度或曲率 $(\\ddot{x}(t), \\ddot{y}(t))$。运动方向（顺时针或逆时针）由角动量矢量的z分量符号决定，该分量与 $\\cos i$ 成正比。轨道倾角 $i$ 不受此变换影响。因此，两种解在天球上的运动方向是相同的。无论精度或时间基线如何，天体测量数据观测到的是在同一方向上描绘的相同投影路径。没有深度信息，它无法区分轨道的“前面”和“后面”。\n**结论：错误。**\n\n**D. 在一个已知的真近点角 $f$（或等效地，在一个与 $T_{\\mathrm{p}}$ 相关的已知时刻）对 $v_{z}$ 的符号进行单次同期测量，就足以区分 $(\\Omega,\\omega)$ 和 $(\\Omega+\\pi,\\omega+\\pi)$。**\n天体测量拟合确定了天球投影椭圆的形状和方向，这提供了参数 $(a, e, i, P, T_{\\mathrm{p}})$ 以及简并对 $(\\Omega, \\omega)$ 和 $(\\Omega+\\pi, \\omega+\\pi)$。有了这些参数，我们可以计算任何时刻 $t$ 的真近点角 $f$。在该时刻，我们有两个相互竞争的视向速度预测：$v_{z,1}(t)$ 和 $v_{z,2}(t) = -v_{z,1}(t)$。除非测量恰好在 $v_z(t) = 0$ 的瞬间进行，否则这两个预测将具有相反的符号。对实际视向速度 $v_{z, \\text{obs}}(t)$ 的符号进行单次测量，将与其中一个预测相符而与另一个相悖，从而打破简并性。\n**结论：正确。**\n\n**E. 对于 $e=0$ 的完美圆形轨道，$(\\Omega,\\omega)$ 对是未明确定义的，因此在天体测量拟合中不会出现 $(\\Omega,\\omega)\\leftrightarrow(\\Omega+\\pi,\\omega+\\pi)$ 的简并性。**\n对于圆形轨道（$e=0$），没有物理上的近心点，这使得近心点幅角 $\\omega$ 本身是任意的或“未明确定义的”。然而，轨道的方向通常使用角度的组合来描述，例如纬度幅角 $u(t) = \\omega+f(t)$，其中 $\\omega$ 是按惯例选择的。对坐标 $(x,y)$ 的变换分析与 $e$ 的值无关。特别是，对于 $e=0$ 的情况，通过在坐标方程中用 $\\omega+\\pi$ 替换 $\\omega$ 和用 $\\Omega+\\pi$ 替换 $\\Omega$ 可以看出，$(x,y)$ 的方程在变换 $(\\Omega, \\omega) \\rightarrow (\\Omega+\\pi, \\omega+\\pi)$ 下是不变的。简并性是投影的一个数学属性，即使其中一个参数缺乏唯一的物理定义，它仍然存在。因此，在圆形轨道的拟合中确实会出现这种简并性。\n**结论：错误。**",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "理论的最终检验在于其预测能力，这在天体物理学中通常通过构建数值模型来实现。在前一个练习的基础上，本实践要求你将开普勒运动的完整理论链条转化为一个可运行的计算机程序，用于预测恒星的视向速度 。这项编程任务不仅涵盖了求解开普勒方程等核心算法，还引入了有限曝光时间这一实际观测效应，让你体验从理论到模拟数据的全过程。",
            "id": "4166315",
            "problem": "考虑一个由开普勒动力学建模的、单一、无相互作用的恒星-行星双体系统。轨道为有界椭圆轨道，其轨道周期为 $P$，离心率为 $e$，近星点辐角为 $\\omega$，参考历元的平近点角为 $M_0$。恒星质心的系统视向速度为 $\\gamma$。假设轨道平面固定，且轨道根数按密切开普勒根数的标准方式定义。角度必须以弧度处理。\n\n从开普勒运动和牛顿二体动力学的基本定律和核心定义出发，在程序中实现以下内容：\n\n1. 使用平运动 $n$ 和时刻 $t$ 的平近点角 $M(t)$，其定义为 $n = 2\\pi/P$ 和 $M(t) = M_0 + n\\,t$。对于观测窗口中的每个时刻 $t$，求解开普勒方程 $M(t) = E(t) - e \\sin E(t)$ 以获得偏近点角 $E(t)$。然后，通过偏近点角和真近点角之间的标准关系，将 $E(t)$ 映射到真近点角 $f(t)$。不要做任何小离心率 $e$ 的近似；解必须对 $0 \\le e  1$ 均具有鲁棒性。\n\n2. 通过将轨道运动投影到观测者的视线方向，使用轨道根数构建作为时间函数 $v_r(t)$ 的恒星视向速度。对所有测试用例，采用固定的半振幅 $K = 4.0$ 米/秒，并将系统速度 $\\gamma$ 加性地包含在内。所有速度以米/秒表示，所有时间以天表示。角度必须以弧度为单位。\n\n3. 通过计算每次曝光窗口（时长为 $\\Delta t$）内的时间平均速度来模拟每次曝光的有限积分时间效应，即计算值\n$$\\bar{v}_r = \\frac{1}{\\Delta t}\\int_{t_{\\mathrm{start}}}^{t_{\\mathrm{start}}+\\Delta t} v_r(t)\\,dt.$$\n对于每个测试用例，定义一个覆盖指定观测窗口的曝光开始时间序列，并为每次曝光计算平均速度 $\\bar{v}_r$ 和在曝光中点 $v_r(t_{\\mathrm{start}} + \\Delta t/2)$ 处评估的瞬时速度。对于每个测试用例，报告窗口中所有曝光的这两个值之间的最大绝对差（以米/秒为单位）：\n$$D_{\\max} = \\max_{\\text{exposures}} \\left|\\bar{v}_r - v_r\\!\\left(t_{\\mathrm{start}}+\\frac{\\Delta t}{2}\\right)\\right|.$$\n为每个测试用例返回 $D_{\\max}$，其形式为以米/秒为单位的浮点数。\n\n您必须为开普勒方程实现一个数值稳定的求解器，并为求平均实现一个数值精确的时间积分程序。您不得假设任何针对 $e=0$ 或近抛物线情况的特例简化；实现必须对所有指定的测试用例普遍有效。\n\n物理单位和角度单位：\n- 周期 $P$ 和所有时间均以天为单位。\n- 速度必须以米/秒表示。\n- 所有角度（$\\omega$, $M_0$ 和近点角）必须以弧度为单位。\n\n测试套件：\n为以下四组参数集提供结果。对每一组，构建指定的观测窗口和曝光，计算 $D_{\\max}$，并将其包含在最终输出列表中。\n\n- 用例1（中等离心率，短曝光）：\n  - $P = 7.0$ 天, $e = 0.3$, $\\omega = 1.0$ 弧度, $M_0 = 0.5$ 弧度, $\\gamma = 2.0$ 米/秒。\n  - 观测窗口：总时长 $T = 3.0$ 天。\n  - 曝光节奏：开始时间为 $t = 0, 0.5, 1.0, 1.5, 2.0, 2.5$ 天。\n  - 曝光时长：$\\Delta t = 0.25$ 天。\n\n- 用例2（圆形轨道，相对于节奏的长曝光）：\n  - $P = 3.0$ 天, $e = 0.0$, $\\omega = 2.0$ 弧度, $M_0 = 1.0$ 弧度, $\\gamma = -1.0$ 米/秒。\n  - 观测窗口：总时长 $T = 3.0$ 天。\n  - 曝光节奏：开始时间为 $t = 0, 0.6, 1.2, 1.8, 2.4$ 天。\n  - 曝光时长：$\\Delta t = 0.6$ 天。\n\n- 用例3（高离心率，极短曝光）：\n  - $P = 10.0$ 天, $e = 0.85$, $\\omega = 0.3$ 弧度, $M_0 = 1.4$ 弧度, $\\gamma = 5.0$ 米/秒。\n  - 观测窗口：总时长 $T = 10.0$ 天。\n  - 曝光节奏：开始时间为 $t = 0, 1, 2, \\ldots, 9$ 天（整数天）。\n  - 曝光时长：$\\Delta t = 0.05$ 天。\n\n- 用例4（短周期，长曝光时长）：\n  - $P = 1.0$ 天, $e = 0.5$, $\\omega = 1.2$ 弧度, $M_0 = 0.1$ 弧度, $\\gamma = 0.0$ 米/秒。\n  - 观测窗口：总时长 $T = 1.5$ 天。\n  - 曝光节奏：开始时间为 $t = 0, 0.5, 1.0$ 天。\n  - 曝光时长：$\\Delta t = 0.5$ 天。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含与上述用例相对应的四个 $D_{\\max}$ 值，格式为方括号内以逗号分隔的列表（例如，“[result1,result2,result3,result4]”）。每个值都必须是米/秒为单位的浮点数。所有角度都必须以弧度处理，并且不应打印其他任何文本。",
            "solution": "该问题要求计算在有限曝光时间内恒星视向速度的时间平均值与曝光中点瞬时速度之间的最大差异。这种差异源于曝光时间内视向速度的非线性变化，这种效应通常被称为“速度弥散”。解决方案涉及对开普勒轨道建模，求解恒星的运动，并执行数值积分。整个过程可以分解为源自二体动力学基本原理的一系列步骤。\n\n首先，我们定义行星在其轨道中随时间变化的状态。平运动 $n$ 是平均角速度，定义为 $n = 2\\pi/P$，其中 $P$ 是轨道周期。平近点角 $M(t)$ 代表一个以恒定角速度 $n$ 运动的虚拟天体所具有的角度。它由 $M(t) = M_0 + n \\cdot t$ 给出，其中 $M_0$ 是参考历元 $t=0$ 时的平近点角。\n\n天体在椭圆轨道中的位置由偏近点角 $E(t)$ 描述。平近点角和偏近点角之间的关系由开普勒方程给出：\n$$M(t) = E(t) - e \\sin(E(t))$$\n这里，$e$ 是轨道离心率。这是一个关于 $E(t)$ 的超越方程，没有通用的封闭形式解。我们必须对其进行数值求解。一种鲁棒且高效的方法是牛顿-拉夫逊迭代法。为了找到函数 $g(E) = E - e \\sin(E) - M = 0$ 的根，我们使用迭代方案：\n$$E_{k+1} = E_k - \\frac{g(E_k)}{g'(E_k)} = E_k - \\frac{E_k - e\\sin(E_k) - M}{1 - e\\cos(E_k)}$$\n从一个初始猜测（通常是 $E_0 = M$）开始，对于给定的 $M$ 和 $e \\in [0, 1)$，迭代会迅速收敛到 $E$ 的正确值。\n\n一旦找到偏近点角 $E(t)$，我们就可以确定真近点角 $f(t)$，这是从椭圆焦点看，行星位置与近星点之间的实际角度。$E$ 和 $f$ 之间的关系由下式给出：\n$$\\tan\\left(\\frac{f}{2}\\right) = \\sqrt{\\frac{1+e}{1-e}} \\tan\\left(\\frac{E}{2}\\right)$$\n为了数值稳定性和正确处理所有象限，最好使用双参数反正切函数 $\\operatorname{atan2}(y, x)$ 来计算 $f(t)$：\n$$f(t) = \\operatorname{atan2}\\left(\\sqrt{1-e^2}\\sin(E(t)), \\cos(E(t)) - e\\right)$$\n\n主要的可观测量是恒星的视向速度 $v_r(t)$，即其轨道速度沿观测者视线方向的分量。视向速度作为轨道根数和真近点角的函数，其标准模型是：\n$$v_r(t) = K(\\cos(\\omega + f(t))) + \\gamma$$\n在此表达式中，$K$ 是速度半振幅，$\\omega$ 是近星点辐角（从升交点到近星点的角度），而 $\\gamma$ 是恒星-行星系统质心的系统速度。所有用例均使用固定的半振幅 $K = 4.0 \\, \\text{m/s}$。\n\n接着，问题要求我们模拟有限曝光时间 $\\Delta t$ 的效应。对于从 $t_{\\mathrm{start}}$ 开始的曝光，测量的速度不是一个瞬时值，而是区间 $[t_{\\mathrm{start}}, t_{\\mathrm{start}}+\\Delta t]$ 上的平均值。这个时间平均速度 $\\bar{v}_r$ 由以下积分定义：\n$$\\bar{v}_r = \\frac{1}{\\Delta t}\\int_{t_{\\mathrm{start}}}^{t_{\\mathrm{start}}+\\Delta t} v_r(t)\\,dt$$\n由于 $v_r(t)$ 通过近点角对时间有复杂的依赖关系，该积分必须进行数值计算。高精度的数值求积方法适合此任务。\n\n作为比较，我们还计算曝光中点 $t_{\\mathrm{mid}} = t_{\\mathrm{start}} + \\Delta t/2$ 处的瞬时速度，即 $v_r(t_{\\mathrm{mid}})$。核心任务是找到在一系列指定的曝光中，这两个量之间的最大绝对差 $D_{\\max}$：\n$$D_{\\max} = \\max_{\\text{exposures}} \\left|\\bar{v}_r - v_r\\left(t_{\\mathrm{mid}}\\right)\\right|$$\n\n每个测试用例的总体算法如下：\n1.  给定参数 $P$, $e$, $\\omega$, $M_0$, $\\gamma$ 和观测计划（一组 $t_{\\mathrm{start}}$ 值和一个固定的 $\\Delta t$）。\n2.  初始化最大差异变量 $D_{\\max} = 0$。\n3.  对于计划中的每个曝光开始时间 $t_{\\mathrm{start}}$：\n    a. 定义完整的随时间变化的视向速度函数 $v_r(t)$，这涉及到为任何给定的 $t$ 求解开普勒方程。\n    b. 通过在 $t_{\\mathrm{mid}} = t_{\\mathrm{start}} + \\Delta t/2$ 处评估此函数来计算中点速度 $v_r(t_{\\mathrm{mid}})$。\n    c. 通过从 $t_{\\mathrm{start}}$ 到 $t_{\\mathrm{start}} + \\Delta t$ 对 $v_r(t)$ 进行数值积分，并将结果除以 $\\Delta t$ 来计算平均速度 $\\bar{v}_r$。\n    d. 计算差值 $|\\bar{v}_r - v_r(t_{\\mathrm{mid}})|$。\n    e. 将 $D_{\\max}$ 更新为其当前值与这个新差值中的最大者。\n4.  遍历所有曝光后，$D_{\\max}$ 的最终值即为给定测试用例的结果。对所提供的所有四组参数集重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It calculates the maximum difference between time-averaged and midpoint-instantaneous\n    radial velocity for several exoplanet systems.\n    \"\"\"\n\n    # The semi-amplitude K is fixed for all test cases as per the problem statement.\n    K_ms = 4.0\n\n    # Define the test cases from the problem statement.\n    # Each case is a dictionary containing the orbital parameters and observing schedule.\n    test_cases = [\n        # Case 1: moderate eccentricity, short exposures\n        {\n            \"P_days\": 7.0, \"e\": 0.3, \"omega_rad\": 1.0, \"M0_rad\": 0.5, \"gamma_ms\": 2.0,\n            \"t_starts_days\": [0.0, 0.5, 1.0, 1.5, 2.0, 2.5],\n            \"delta_t_days\": 0.25\n        },\n        # Case 2: circular orbit, long exposures relative to cadence\n        {\n            \"P_days\": 3.0, \"e\": 0.0, \"omega_rad\": 2.0, \"M0_rad\": 1.0, \"gamma_ms\": -1.0,\n            \"t_starts_days\": [0.0, 0.6, 1.2, 1.8, 2.4],\n            \"delta_t_days\": 0.6\n        },\n        # Case 3: high eccentricity, very short exposures\n        {\n            \"P_days\": 10.0, \"e\": 0.85, \"omega_rad\": 0.3, \"M0_rad\": 1.4, \"gamma_ms\": 5.0,\n            \"t_starts_days\": np.arange(0.0, 10.0, 1.0),\n            \"delta_t_days\": 0.05\n        },\n        # Case 4: short period, substantial exposure duration\n        {\n            \"P_days\": 1.0, \"e\": 0.5, \"omega_rad\": 1.2, \"M0_rad\": 0.1, \"gamma_ms\": 0.0,\n            \"t_starts_days\": [0.0, 0.5, 1.0],\n            \"delta_t_days\": 0.5\n        }\n    ]\n\n    def solve_kepler(M, e):\n        \"\"\"\n        Solves Kepler's equation M = E - e*sin(E) for E using Newton-Raphson method.\n        \n        Args:\n            M (float): Mean anomaly in radians.\n            e (float): Eccentricity.\n            \n        Returns:\n            float: Eccentric anomaly E in radians.\n        \"\"\"\n        if e == 0.0:\n            return M\n        \n        # Initial guess for E\n        E = M\n        \n        # Iterate using Newton-Raphson until desired precision is reached.\n        for _ in range(100): # Max 100 iterations is a safe limit\n            f_E = E - e * np.sin(E) - M\n            fp_E = 1 - e * np.cos(E)\n            delta_E = f_E / fp_E\n            E = E - delta_E\n            if np.abs(delta_E)  1e-12:\n                break\n        return E\n\n    def calculate_vr(t, P, e, omega, M0, gamma, K):\n        \"\"\"\n        Calculates the instantaneous radial velocity at a given time t.\n        \n        Args:\n            t (float): Time in days.\n            P (float): Period in days.\n            e (float): Eccentricity.\n            omega (float): Argument of periastron in radians.\n            M0 (float): Mean anomaly at epoch in radians.\n            gamma (float): Systemic velocity in m/s.\n            K (float): Velocity semi-amplitude in m/s.\n            \n        Returns:\n            float: Instantaneous radial velocity in m/s.\n        \"\"\"\n        # Calculate mean motion\n        n = 2 * np.pi / P\n        \n        # Calculate mean anomaly at time t\n        M = M0 + n * t\n        \n        # Solve Kepler's equation for eccentric anomaly E\n        E = solve_kepler(M, e)\n        \n        # Calculate true anomaly f from E\n        # Use atan2 for numerical stability and correct quadrant\n        f = np.arctan2(np.sqrt(1 - e**2) * np.sin(E), np.cos(E) - e)\n        \n        # Calculate radial velocity\n        vr = K * (np.cos(omega + f)) + gamma\n        \n        return vr\n\n    results = []\n    for case in test_cases:\n        P = case[\"P_days\"]\n        e = case[\"e\"]\n        omega = case[\"omega_rad\"]\n        M0 = case[\"M0_rad\"]\n        gamma = case[\"gamma_ms\"]\n        delta_t = case[\"delta_t_days\"]\n        t_starts = case[\"t_starts_days\"]\n        \n        max_diff = 0.0\n        \n        # Define the arguments for the radial velocity function\n        vr_args = (P, e, omega, M0, gamma, K_ms)\n\n        for t_start in t_starts:\n            # Time at the midpoint of the exposure\n            t_mid = t_start + delta_t / 2.0\n            \n            # 1. Calculate instantaneous velocity at the midpoint\n            vr_mid = calculate_vr(t_mid, *vr_args)\n            \n            # 2. Calculate time-averaged velocity over the exposure\n            # Use scipy.integrate.quad for high-precision numerical integration\n            integral_val, _ = quad(calculate_vr, t_start, t_start + delta_t, args=vr_args)\n            vr_avg = integral_val / delta_t\n            \n            # 3. Compute the absolute difference and update the maximum\n            current_diff = np.abs(vr_avg - vr_mid)\n            if current_diff > max_diff:\n                max_diff = current_diff\n                \n        results.append(max_diff)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```[0.0003058866162391218,0.0031548651877965373,8.877864192662054e-05,0.1601053051493032]"
        }
    ]
}