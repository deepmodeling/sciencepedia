{
    "hands_on_practices": [
        {
            "introduction": "Understanding the thermal evolution of planetary bodies is a cornerstone of planetary science. This first practice tackles the fundamental problem of conductive cooling in an idealized, spherically symmetric interior. By deriving and solving the transient heat equation analytically, you will develop a foundational understanding of how a planet loses its primordial heat and gain direct insight into the physical meaning of a geological cooling timescale .",
            "id": "4163049",
            "problem": "Consider a spherically symmetric, homogeneous exoplanetary interior idealized as a solid sphere of radius $R$, constant mass density $\\rho$, constant specific heat at constant pressure $c_{p}$, and constant thermal conductivity $k$. At time $t=0$, the interior temperature is spatially uniform at $T_{0}$. For $t>0$, the surface temperature at $r=R$ is suddenly fixed at a constant value $T_{s}$ due to rapid radiative equilibration with the host star and the surrounding environment. Neglect internal heat sources, phase changes, and any fluid motion so that heat transport occurs only by conduction. Assume material properties are isotropic and do not vary with temperature. Impose regularity at the center $r=0$.\n\nStarting from energy conservation and Fourier’s law of heat conduction, derive the governing partial differential equation (PDE) for the temperature field $T(r,t)$ and solve the transient cooling problem using separation of variables and eigenfunction expansions subject to the boundary condition $T(R,t)=T_{s}$ for all $t>0$ and the initial condition $T(r,0)=T_{0}$. Define the thermal diffusivity $\\alpha$ by $\\alpha = k/(\\rho c_{p})$.\n\nFrom your solution, identify the slowest-decaying radial eigenmode and determine its amplitude decay rate. Using this, define the e-folding timescale $\\tau_{1}$ of the lowest mode as the time at which the amplitude of that mode is reduced by a factor $\\exp(-1)$. Provide $\\tau_{1}$ as a closed-form analytic expression in terms of $R$ and $\\alpha$. Express your final answer for $\\tau_{1}$ in seconds. No numerical evaluation is required.",
            "solution": "The problem asks for the derivation and solution of the transient heat conduction equation for a solid sphere, and from this solution, to determine the cooling timescale of the slowest-decaying thermal mode.\n\nThe validation steps are as follows:\n\n**Step 1: Extract Givens**\n- Geometry: Solid sphere of radius $R$.\n- Material Properties: Constant mass density $\\rho$, constant specific heat at constant pressure $c_{p}$, constant thermal conductivity $k$. Thermal diffusivity is defined as $\\alpha = k/(\\rho c_{p})$. Properties are isotropic and temperature-independent.\n- Initial Condition: At time $t=0$, the temperature is uniform, $T(r,0) = T_0$.\n- Boundary Conditions: For time $t>0$, the surface temperature is fixed at $T(R,t) = T_s$. A regularity condition is imposed at the center, $r=0$.\n- Physical Model: Heat transport is by conduction only. There are no internal heat sources, phase changes, or fluid motion.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is a classical application of Fourier's law of heat conduction in a simple geometry. The governing equation is the heat equation, a fundamental principle of thermal physics. The model is a standard, scientifically sound idealization used in many fields, including planetary science.\n- **Well-Posed:** The problem is a well-posed initial-boundary value problem. It specifies a partial differential equation (PDE), a domain ($0 \\le r \\le R$, $t \\ge 0$), an initial condition for the entire domain, and boundary conditions at the spatial boundaries ($r=0$ and $r=R$) for all subsequent times.\n- **Objective:** The problem is stated in precise mathematical and physical terms, free of any subjective or ambiguous language.\n- **Completeness and Consistency:** The problem provides all necessary parameters ($R, \\rho, c_p, k, T_0, T_s$) and conditions to derive and solve the PDE. There are no contradictions.\n- **Realism:** The assumptions (homogeneity, constant properties) are simplifications, but they do not render the problem physically impossible or implausible. It serves as a valid first-order model for planetary cooling.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We proceed with the solution.\n\n**Derivation of the Governing PDE**\nThe general equation for heat transport based on energy conservation is $\\rho c_{p} \\frac{\\partial T}{\\partial t} = -\\nabla \\cdot \\vec{q} + Q$, where $\\vec{q}$ is the heat flux vector and $Q$ is the volumetric heat generation rate. The problem states $Q=0$. Fourier's law of conduction states that $\\vec{q} = -k \\nabla T$. Substituting this into the energy conservation equation gives the heat equation:\n$$ \\rho c_{p} \\frac{\\partial T}{\\partial t} = \\nabla \\cdot (k \\nabla T) $$\nGiven that $k$ is constant, this simplifies to $\\frac{\\partial T}{\\partial t} = \\frac{k}{\\rho c_{p}} \\nabla^2 T$. Using the definition of thermal diffusivity, $\\alpha = k/(\\rho c_{p})$, we have:\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\nabla^2 T $$\nFor a spherically symmetric system, the temperature $T$ depends only on the radial coordinate $r$ and time $t$, so $T=T(r,t)$. The Laplacian operator $\\nabla^2$ in spherical coordinates simplifies to:\n$$ \\nabla^2 T = \\frac{1}{r^2} \\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial T}{\\partial r} \\right) $$\nThus, the governing PDE for $T(r,t)$ is:\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{1}{r^2} \\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial T}{\\partial r} \\right) $$\n\n**Solution of the PDE**\nThe surface boundary condition $T(R,t) = T_s$ is non-homogeneous. We define a new temperature variable $\\Theta(r,t) = T(r,t) - T_s$ to make the boundary condition homogeneous. The steady-state solution is $T_{ss}(r)=T_s$. The variable $\\Theta(r,t)$ represents the transient deviation from the final steady state.\nThe PDE for $\\Theta$ is the same as for $T$:\n$$ \\frac{\\partial \\Theta}{\\partial t} = \\alpha \\frac{1}{r^2} \\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial \\Theta}{\\partial r} \\right) $$\nThe boundary and initial conditions for $\\Theta(r,t)$ are:\n- Boundary condition at $r=R$: $\\Theta(R,t) = T(R,t) - T_s = T_s - T_s = 0$.\n- Regularity at $r=0$: $T(r,t)$ is finite, so $\\Theta(r,t)$ must also be finite at $r=0$.\n- Initial condition at $t=0$: $\\Theta(r,0) = T(r,0) - T_s = T_0 - T_s$.\n\nTo simplify the spatial operator, we introduce another substitution: $u(r,t) = r \\Theta(r,t)$. The PDE for $u(r,t)$ becomes the one-dimensional heat equation:\n$$ \\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial r^2} $$\nThe boundary and initial conditions for $u(r,t)$ are:\n- At $r=0$: Since $\\Theta(0,t)$ must be finite, $u(0,t) = 0 \\cdot \\Theta(0,t) = 0$.\n- At $r=R$: $u(R,t) = R \\cdot \\Theta(R,t) = R \\cdot 0 = 0$.\n- At $t=0$: $u(r,0) = r \\Theta(r,0) = r(T_0 - T_s)$.\n\nWe solve for $u(r,t)$ using separation of variables, letting $u(r,t) = \\mathcal{R}(r)\\mathcal{T}(t)$. Substituting into the PDE gives:\n$$ \\frac{1}{\\alpha \\mathcal{T}} \\frac{d\\mathcal{T}}{dt} = \\frac{1}{\\mathcal{R}} \\frac{d^2\\mathcal{R}}{dr^2} = -\\lambda^2 $$\nwhere $-\\lambda^2$ is the separation constant. The time-dependent equation is $\\frac{d\\mathcal{T}}{dt} = -\\alpha \\lambda^2 \\mathcal{T}$, with solution $\\mathcal{T}(t) = \\exp(-\\alpha \\lambda^2 t)$.\nThe space-dependent equation is $\\frac{d^2\\mathcal{R}}{dr^2} + \\lambda^2 \\mathcal{R} = 0$, with general solution $\\mathcal{R}(r) = A \\sin(\\lambda r) + B \\cos(\\lambda r)$.\nApplying the boundary conditions for $\\mathcal{R}(r)$:\n- $\\mathcal{R}(0)=0 \\implies A\\sin(0) + B\\cos(0) = B = 0$. So, $\\mathcal{R}(r) = A \\sin(\\lambda r)$.\n- $\\mathcal{R}(R)=0 \\implies A\\sin(\\lambda R) = 0$. For a non-trivial solution ($A \\ne 0$), we must have $\\sin(\\lambda R) = 0$. This yields the eigenvalues $\\lambda_n = \\frac{n\\pi}{R}$ for integer $n=1, 2, 3, \\ldots$.\n\nThe general solution for $u(r,t)$ is a superposition of all possible modes:\n$$ u(r,t) = \\sum_{n=1}^{\\infty} C_n \\sin\\left(\\frac{n\\pi r}{R}\\right) \\exp\\left(-\\alpha \\left(\\frac{n\\pi}{R}\\right)^2 t\\right) $$\nThe coefficients $C_n$ are determined from the initial condition $u(r,0) = r(T_0 - T_s)$ using the orthogonality of sine functions:\n$$ C_n = \\frac{2}{R} \\int_0^R u(r,0) \\sin\\left(\\frac{n\\pi r}{R}\\right) dr = \\frac{2(T_0 - T_s)}{R} \\int_0^R r \\sin\\left(\\frac{n\\pi r}{R}\\right) dr $$\nThe integral can be evaluated using integration by parts:\n$$ \\int_0^R r \\sin\\left(\\frac{n\\pi r}{R}\\right) dr = \\left[-\\frac{Rr}{n\\pi}\\cos\\left(\\frac{n\\pi r}{R}\\right) + \\left(\\frac{R}{n\\pi}\\right)^2 \\sin\\left(\\frac{n\\pi r}{R}\\right)\\right]_0^R = -\\frac{R^2}{n\\pi}\\cos(n\\pi) = -\\frac{R^2}{n\\pi}(-1)^n = \\frac{R^2}{n\\pi}(-1)^{n+1} $$\nSubstituting this back into the expression for $C_n$:\n$$ C_n = \\frac{2(T_0 - T_s)}{R} \\left(\\frac{R^2}{n\\pi}(-1)^{n+1}\\right) = \\frac{2R(T_0 - T_s)}{n\\pi}(-1)^{n+1} $$\nThe complete solution for $u(r,t)$ is:\n$$ u(r,t) = \\sum_{n=1}^{\\infty} \\frac{2R(T_0 - T_s)}{n\\pi}(-1)^{n+1} \\sin\\left(\\frac{n\\pi r}{R}\\right) \\exp\\left(-\\alpha \\left(\\frac{n\\pi}{R}\\right)^2 t\\right) $$\nFinally, we transform back to the original temperature variable $T(r,t) = T_s + \\Theta(r,t) = T_s + u(r,t)/r$:\n$$ T(r,t) = T_s + \\frac{2R(T_0 - T_s)}{r\\pi} \\sum_{n=1}^{\\infty} \\frac{(-1)^{n+1}}{n} \\sin\\left(\\frac{n\\pi r}{R}\\right) \\exp\\left(-\\alpha \\left(\\frac{n\\pi}{R}\\right)^2 t\\right) $$\n\n**Determination of the e-folding Timescale**\nThe solution is an infinite series of eigenmodes. The time evolution of each mode $n$ is governed by the exponential term $\\exp\\left(-\\alpha \\left(\\frac{n\\pi}{R}\\right)^2 t\\right)$. The amplitude decay rate for mode $n$ is therefore $\\gamma_n = \\alpha \\left(\\frac{n\\pi}{R}\\right)^2$.\nThe slowest-decaying mode is the one with the smallest decay rate. This occurs for the smallest value of $n$, which is $n=1$. This is the fundamental or lowest mode.\nThe amplitude decay rate of the slowest-decaying mode is:\n$$ \\gamma_1 = \\alpha \\left(\\frac{\\pi}{R}\\right)^2 = \\frac{\\alpha \\pi^2}{R^2} $$\nThe e-folding timescale, $\\tau_1$, is defined as the time at which the amplitude of this mode is reduced by a factor of $\\exp(-1)$. This is the inverse of the decay rate.\n$$ \\exp(-\\gamma_1 \\tau_1) = \\exp(-1) \\implies \\gamma_1 \\tau_1 = 1 $$\nTherefore, the e-folding timescale is:\n$$ \\tau_1 = \\frac{1}{\\gamma_1} = \\frac{R^2}{\\alpha \\pi^2} $$\nThis expression provides the timescale in terms of the given parameters $R$ and $\\alpha$. If $R$ is in meters and $\\alpha$ is in $\\text{m}^2/\\text{s}$, then $\\tau_1$ will be in seconds.",
            "answer": "$$ \\boxed{\\frac{R^2}{\\alpha \\pi^2}} $$"
        },
        {
            "introduction": "Heat transfer within a planet is critically coupled to how its surface interacts with the external environment, be it space or an atmosphere. The choice of a mathematical boundary condition is a crucial modeling step that must reflect the underlying physics. This exercise challenges you to distinguish between the regimes where Dirichlet (fixed temperature) and Neumann (fixed flux) conditions are appropriate . By applying scaling arguments based on the thermal diffusion length, you will learn to justify your modeling choices for different planetary surfaces, from high-inertia oceans to low-inertia regoliths.",
            "id": "4163077",
            "problem": "Consider an exoplanet with two distinct surface types: a high-conductivity, well-mixed ocean at low latitudes and a low-conductivity, porous regolith at high latitudes. Near-surface heat transport within each substrate is dominated by conduction (augmented by turbulent mixing in the ocean case) and interacts with external forcing through convection to the atmosphere and radiation to space. Assume periodic stellar forcing with period $\\tau$ and amplitude $F_1$, and take the net external flux at the surface to be $F_{\\star}(t) = \\bar{F} + F_1 \\cos(2\\pi t/\\tau)$. The surface also emits thermal radiation approximated by the Stefan–Boltzmann law $F_{\\mathrm{rad}} = \\varepsilon \\sigma T^4$, where $\\varepsilon$ is the emissivity and $\\sigma$ is the Stefan–Boltzmann constant.\n\nInside each substrate, temperature evolution is governed by the heat equation\n$$\n\\rho c \\,\\frac{\\partial T}{\\partial t} = k\\,\\frac{\\partial^2 T}{\\partial z^2},\n$$\nwhere $T$ is temperature, $z$ is depth (positive downward), $k$ is thermal conductivity, $\\rho$ is density, and $c$ is specific heat capacity. The associated conductive heat flux is given by Fourier’s law,\n$$\nq_z = -\\,k\\,\\frac{\\partial T}{\\partial z}.\n$$\n\nThe ocean can be treated as a homogeneous mixed layer of thickness $H_o$ with an effective turbulent diffusivity $\\alpha_{\\mathrm{eff},o}$ that greatly enhances vertical heat transport relative to molecular conduction. The regolith is treated as a semi-infinite half-space with molecular thermal diffusivity $\\alpha_r = k_r/(\\rho_r c_r)$.\n\nFor the ocean mixed layer, let $H_o = 50\\,\\mathrm{m}$ and $\\alpha_{\\mathrm{eff},o} = 0.05\\,\\mathrm{m^2/s}$. For the regolith, take $k_r = 0.10\\,\\mathrm{W/(m\\,K)}$, $\\rho_r = 1500\\,\\mathrm{kg/m^3}$, $c_r = 800\\,\\mathrm{J/(kg\\,K)}$, and thus $\\alpha_r = k_r/(\\rho_r c_r)$. Consider diurnal forcing with $\\tau = 86400\\,\\mathrm{s}$.\n\nStarting from the heat equation and Fourier’s law, use scaling arguments to estimate the diffusion length $d \\sim \\sqrt{\\alpha \\tau}$ relevant to the penetration of the periodic thermal signal into each substrate. Interpret the role of external fluxes using $q_z(0,t) = F_{\\star}(t) - \\varepsilon \\sigma T(0,t)^4$ at the surface, and determine which boundary condition at $z=0$ better represents the upper boundary of the subsurface conduction problem on diurnal timescales for each case:\n\n- Dirichlet boundary condition (fixed temperature): $T(0,t) = T_b$ (approximately constant in time).\n- Neumann boundary condition (fixed flux): $-\\,k\\,\\partial T/\\partial z\\big|_{z=0} = q_b(t)$ (externally imposed flux).\n\nChoose the option that best matches the physical regime implied by the given parameters and timescale.\n\nA. Ocean: Dirichlet; Regolith: Neumann.\n\nB. Ocean: Neumann; Regolith: Dirichlet.\n\nC. Ocean: Dirichlet; Regolith: Dirichlet.\n\nD. Ocean: Neumann; Regolith: Neumann.\n\nE. Neither pair is adequate; both surfaces strictly require a Robin (mixed) boundary and cannot be approximated as Dirichlet or Neumann on diurnal timescales.",
            "solution": "The problem asks to determine the most appropriate idealized boundary condition (Dirichlet or Neumann) for the surface ($z=0$) of two different planetary surface types—an ocean and a regolith—subject to diurnal thermal forcing. The choice depends on the thermal response of each substrate, which can be analyzed using scaling arguments based on the provided physical parameters.\n\nThe fundamental physical principle is that the surface temperature's response to a periodic energy flux is governed by the thermal inertia of the material near the surface.\n- A **Dirichlet boundary condition** ($T(0,t) = T_b$, a fixed temperature) is a good approximation when the surface is coupled to a reservoir with a very large effective heat capacity. The large thermal mass absorbs the periodic energy input with only a negligible change in temperature.\n- A **Neumann boundary condition** ($-\\,k\\,\\partial T/\\partial z\\big|_{z=0} = q_b(t)$, a fixed flux) is a good approximation when the surface has a very low thermal inertia. In this case, the surface cannot effectively store or conduct away the incoming heat flux. Consequently, the surface temperature must fluctuate significantly to re-radiate the energy, and the temperature evolution is driven by the imposed flux.\n\nThe penetration of a periodic thermal signal into a substrate is characterized by the thermal diffusion length, $d$, given by the scaling relation $d \\sim \\sqrt{\\alpha \\tau}$, where $\\alpha$ is the thermal diffusivity and $\\tau$ is the period of the forcing.\n\nLet's analyze each case separately using the given parameters.\n\n**1. Regolith Analysis**\n\nThe regolith is treated as a semi-infinite half-space with the following properties:\n- Thermal conductivity: $k_r = 0.10\\,\\mathrm{W/(m\\,K)}$\n- Density: $\\rho_r = 1500\\,\\mathrm{kg/m^3}$\n- Specific heat capacity: $c_r = 800\\,\\mathrm{J/(kg\\,K)}$\n- Forcing period (diurnal): $\\tau = 86400\\,\\mathrm{s}$\n\nFirst, we calculate the thermal diffusivity of the regolith, $\\alpha_r$:\n$$\n\\alpha_r = \\frac{k_r}{\\rho_r c_r} = \\frac{0.10\\,\\mathrm{W/(m\\,K)}}{(1500\\,\\mathrm{kg/m^3}) \\times (800\\,\\mathrm{J/(kg\\,K)})} = \\frac{0.10}{1.2 \\times 10^6} \\,\\mathrm{m^2/s} \\approx 8.33 \\times 10^{-8}\\,\\mathrm{m^2/s}\n$$\nNext, we calculate the thermal diffusion length, $d_r$, for the diurnal period:\n$$\nd_r = \\sqrt{\\alpha_r \\tau} = \\sqrt{(8.33 \\times 10^{-8}\\,\\mathrm{m^2/s}) \\times (86400\\,\\mathrm{s})} \\approx \\sqrt{0.0072\\,\\mathrm{m^2}} \\approx 0.085\\,\\mathrm{m}\n$$\nThe diurnal thermal wave penetrates only about $8.5\\,\\mathrm{cm}$ into the regolith. This is a very shallow layer. This means that only a small mass of material is thermally engaged on a diurnal timescale. The effective heat capacity is low, and thus the thermal inertia is low. A low thermal inertia surface cannot efficiently transport heat into its interior. To maintain energy balance at the surface, where $q_z(0,t) = F_{\\star}(t) - \\varepsilon \\sigma T(0,t)^4$, the surface temperature $T(0,t)$ must vary significantly to adjust the outgoing radiative flux to match the variations in the incoming solar flux. The subsurface heat conduction problem is therefore driven by an externally imposed flux at its boundary. This physical situation is best represented by a **Neumann boundary condition**.\n\n**2. Ocean Analysis**\n\nThe ocean is modeled as a well-mixed layer with the following properties:\n- Mixed layer thickness: $H_o = 50\\,\\mathrm{m}$\n- Effective turbulent diffusivity: $\\alpha_{\\mathrm{eff},o} = 0.05\\,\\mathrm{m^2/s}$\n- Forcing period (diurnal): $\\tau = 86400\\,\\mathrm{s}$\n\nWe calculate the thermal diffusion length, $d_o$, for the ocean:\n$$\nd_o = \\sqrt{\\alpha_{\\mathrm{eff},o} \\tau} = \\sqrt{(0.05\\,\\mathrm{m^2/s}) \\times (86400\\,\\mathrm{s})} = \\sqrt{4320\\,\\mathrm{m^2}} \\approx 65.7\\,\\mathrm{m}\n$$\nNow, we compare the diffusion length $d_o$ to the mixed layer depth $H_o$:\n$$\nd_o \\approx 65.7\\,\\mathrm{m} > H_o = 50\\,\\mathrm{m}\n$$\nSince the diffusion length is greater than the mixed layer depth, the thermal signal penetrates the entire layer within the diurnal period. The high effective diffusivity ensures that heat is rapidly mixed throughout the $50\\,\\mathrm{m}$ column. This means the entire mixed layer acts as a single, large thermal reservoir. The total heat capacity per unit area of this reservoir is immense. For typical water properties ($\\rho_o \\approx 1000\\,\\mathrm{kg/m^3}$, $c_o \\approx 4200\\,\\mathrm{J/(kg\\,K)}$), the heat capacity per unit area is $(\\rho_o c_o) H_o \\approx (4.2 \\times 10^6\\,\\mathrm{J/(m^3 K)}) \\times (50\\,\\mathrm{m}) = 2.1 \\times 10^8\\,\\mathrm{J/(m^2 K)}$. This enormous thermal mass strongly resists temperature changes. In response to the periodic stellar forcing, the ocean's surface temperature will fluctuate by a very small amount. A boundary where the temperature remains approximately constant is best represented by a **Dirichlet boundary condition**.\n\n**Conclusion**\n\n- The **ocean** has a very high effective thermal inertia on diurnal timescales, leading to a nearly constant surface temperature. This corresponds to a **Dirichlet** boundary condition.\n- The **regolith** has a very low effective thermal inertia on diurnal timescales, leading to large surface temperature swings driven by the external energy flux. This corresponds to a **Neumann** boundary condition.\n\nTherefore, the appropriate pair of boundary conditions is Ocean: Dirichlet; Regolith: Neumann.\n\n**Evaluation of Options**\n\n- **A. Ocean: Dirichlet; Regolith: Neumann.** This matches our derivation. The ocean's high thermal mass (due to deep, rapid mixing) stabilizes its temperature. The regolith's low thermal inertia forces its temperature to follow the imposed flux. **Correct**.\n\n- **B. Ocean: Neumann; Regolith: Dirichlet.** This is the reverse of our finding. It would imply a low-inertia ocean and a high-inertia regolith, which is contrary to the physics dictated by the given parameters. **Incorrect**.\n\n- **C. Ocean: Dirichlet; Regolith: Dirichlet.** While the Dirichlet condition is appropriate for the ocean, it is not for the regolith. The regolith surface temperature is expected to vary significantly over a day. **Incorrect**.\n\n- **D. Ocean: Neumann; Regolith: Neumann.** While the Neumann condition is appropriate for the regolith, it is not for the ocean. The ocean's temperature is stable, not flux-driven, on this timescale. **Incorrect**.\n\n- **E. Neither pair is adequate; both surfaces strictly require a Robin (mixed) boundary and cannot be approximated as Dirichlet or Neumann on diurnal timescales.** The full physical boundary condition is indeed a non-linear variant of a Robin condition. However, the problem asks for the *best approximation* in the physical regime defined by the parameters. The parameters for the ocean (very large effective heat capacity) and the regolith (very small thermal inertia) push the systems into limiting cases where the Dirichlet and Neumann conditions, respectively, become very good approximations. Therefore, it is incorrect to state that these simpler conditions are not adequate representations of the dominant physical behavior. **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Our exploration culminates in modeling a realistic planetary surface, a complex interface where conduction, convection, and radiation all interact. This capstone practice requires you to build and solve a comprehensive surface energy balance equation, accounting for all major energy fluxes. By implementing this model numerically to determine a planet's surface temperature, you will not only synthesize the principles of all three heat transfer modes but also quantify the profound climatic impact of phase transitions like sublimation .",
            "id": "4163092",
            "problem": "Consider a bare icy surface on a terrestrial exoplanet with a nitrogen-dominated atmosphere. At a fixed local time near the diurnal maximum of insolation, assume the surface reaches a quasi-steady temperature, denoted by $T_s$, such that net energy input equals net energy output at the interface between the atmosphere and the surface. The governing principle is conservation of energy applied to the surface control volume. The balance of fluxes is expressed as the equality between absorbed radiation and the sum of emitted radiation plus turbulent sensible heat flux, latent heat flux due to sublimation, and conductive heat flux into the subsurface. The goal is to quantify the impact of sublimation on the equilibrium surface temperature by including a latent heat flux term $L_v E$, where $L_v$ is the latent heat of sublimation of the volatile and $E$ is a mass flux estimated from mass transfer coefficients.\n\nBase the derivation on the following well-tested facts and definitions:\n- Stefan–Boltzmann law: the thermal emission from a surface with emissivity $\\varepsilon$ is $\\varepsilon \\sigma T_s^4$, where $\\sigma$ is the Stefan–Boltzmann constant.\n- Bulk aerodynamic formulas for turbulent transfer in the near-surface layer: the sensible heat flux is $H = \\rho c_p C_H U (T_s - T_a)$ and the sublimation mass flux is $E = \\rho C_E U (q_s(T_s) - q_a)$, where $\\rho$ is air density, $c_p$ is specific heat at constant pressure for the air, $C_H$ and $C_E$ are transfer coefficients, $U$ is wind speed, $T_a$ is air temperature, $q_s(T_s)$ is the saturation specific humidity at the surface temperature, and $q_a$ is the ambient specific humidity.\n- Clausius–Clapeyron relation for saturation vapor pressure of water over ice: $e_s(T) = e_0 \\exp\\!\\left(\\dfrac{L_v}{R_v}\\left(\\dfrac{1}{T_0} - \\dfrac{1}{T}\\right)\\right)$, with $e_0$ and $T_0$ reference constants, $R_v$ the gas constant for water vapor, and $L_v$ the latent heat of sublimation.\n- Specific humidity for a binary mixture of dry air and water vapor: $q = \\dfrac{\\varepsilon_m e}{p - (1 - \\varepsilon_m)e}$, where $e$ is partial pressure of water vapor, $p$ is total air pressure, and $\\varepsilon_m = M_v/M_d$ is the ratio of molecular masses of water vapor to dry air (for a nitrogen-like dry air, take $\\varepsilon_m \\approx 0.622$).\n- Air density from the ideal gas law: $\\rho = \\dfrac{p}{R_d T_a}$, where $R_d$ is the gas constant for dry air.\n\nAssume net shortwave radiation absorbed by the surface is $(1 - \\alpha) S_\\downarrow$, where $\\alpha$ is albedo and $S_\\downarrow$ is the downward shortwave flux at the surface. Let $L_\\downarrow$ be the downward longwave flux from the sky. The conductive heat flux into the subsurface is modeled as $G = \\dfrac{k_g}{d_g} (T_s - T_g)$, where $k_g$ is an effective thermal conductivity, $d_g$ is an effective conduction path length, and $T_g$ is the subsurface temperature representative of the diurnal conduction depth. The steady energy balance is\n$$\n(1 - \\alpha) S_\\downarrow + L_\\downarrow - \\varepsilon \\sigma T_s^4 - \\rho c_p C_H U (T_s - T_a) - L_v E - \\frac{k_g}{d_g} (T_s - T_g) = 0,\n$$\nwith\n$$\nE = \\max\\!\\left(0,\\, \\rho C_E U \\left(q_s(T_s) - q_a\\right)\\right),\n\\quad\nq_s(T_s) = \\frac{\\varepsilon_m e_s(T_s)}{p - (1 - \\varepsilon_m)e_s(T_s)},\n\\quad\nq_a = r_H \\, q_s(T_a),\n$$\nwhere $r_H$ is the ambient relative humidity expressed as a decimal fraction. The operator $\\max(\\cdot)$ enforces that $E$ is taken as zero when the air is supersaturated relative to the surface, so that only the cooling effect of sublimation is quantified.\n\nYour program must, for each specified test case, compute two equilibrium surface temperatures by solving the nonlinear steady energy balance for $T_s$:\n- $T_s^{(\\mathrm{LE}=0)}$: excluding latent heat flux, i.e., setting $E = 0$.\n- $T_s^{(\\mathrm{LE}>0)}$: including latent heat flux $L_v E$ as defined above.\n\nThen, for each test case, report the temperature reduction due to sublimation as the nonnegative difference\n$$\n\\Delta T \\equiv T_s^{(\\mathrm{LE}=0)} - T_s^{(\\mathrm{LE}>0)} \\quad \\text{in} \\quad \\mathrm{K}.\n$$\nUse a physically realistic root-finding approach to solve the energy balance equations for $T_s$.\n\nConstants to use for all test cases:\n- Latent heat of sublimation for water ice: $L_v = 2.834\\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$.\n- Reference saturation constants: $e_0 = 611\\,\\mathrm{Pa}$ and $T_0 = 273.16\\,\\mathrm{K}$.\n- Gas constants: $R_v = 461\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $R_d = 287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$.\n- Stefan–Boltzmann constant: $\\sigma = 5.670374419\\times 10^{-8}\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}$.\n- Specific heat of air at constant pressure: $c_p = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$.\n- Molecular mass ratio: $\\varepsilon_m = 0.622$.\n\nTest suite parameter sets (each line is one independent case):\n- Case $1$ (general, moderate wind and dry air):\n  $\\alpha = 0.30$, $S_\\downarrow = 300\\,\\mathrm{W\\,m^{-2}}$, $L_\\downarrow = 150\\,\\mathrm{W\\,m^{-2}}$, $\\varepsilon = 0.95$, $U = 5\\,\\mathrm{m\\,s^{-1}}$, $C_H = 0.003$, $C_E = 0.003$, $p = 5.0\\times 10^{4}\\,\\mathrm{Pa}$, $T_a = 250\\,\\mathrm{K}$, $r_H = 0.20$, $k_g = 0.20\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $d_g = 0.20\\,\\mathrm{m}$, $T_g = 240\\,\\mathrm{K}$.\n- Case $2$ (boundary, no wind leading to negligible sublimation):\n  same as Case $1$ except $U = 0\\,\\mathrm{m\\,s^{-1}}$.\n- Case $3$ (edge, humid air):\n  same as Case $1$ except $r_H = 0.90$.\n- Case $4$ (low insolation and high albedo):\n  $\\alpha = 0.60$, $S_\\downarrow = 100\\,\\mathrm{W\\,m^{-2}}$, $L_\\downarrow = 120\\,\\mathrm{W\\,m^{-2}}$, $\\varepsilon = 0.95$, $U = 5\\,\\mathrm{m\\,s^{-1}}$, $C_H = 0.003$, $C_E = 0.003$, $p = 5.0\\times 10^{4}\\,\\mathrm{Pa}$, $T_a = 245\\,\\mathrm{K}$, $r_H = 0.30$, $k_g = 0.20\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $d_g = 0.20\\,\\mathrm{m}$, $T_g = 235\\,\\mathrm{K}$.\n\nComputational requirements:\n- For each case, solve the steady energy balance for $T_s$ with and without latent heat flux, using a robust bracketing root finder over a temperature interval $[T_{\\min}, T_{\\max}]$ with $T_{\\min} = 150\\,\\mathrm{K}$ and $T_{\\max} = 350\\,\\mathrm{K}$.\n- Report $\\Delta T$ for each case in $\\mathrm{K}$ as a floating-point number.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $[x_1,x_2,x_3,x_4]$, where each $x_i$ is the $\\Delta T$ value for Case $i$ in $\\mathrm{K}$. No additional text should be printed.",
            "solution": "The problem requires the calculation of the equilibrium surface temperature, $T_s$, of a bare icy surface on an exoplanet by solving the surface energy balance equation. This equation represents the principle of conservation of energy, stating that at steady state, the sum of all energy fluxes to and from the surface is zero. We are asked to compute $T_s$ under two conditions: one excluding the latent heat flux of sublimation and one including it. The difference between these two temperatures, $\\Delta T$, quantifies the cooling effect of sublimation.\n\nThe governing steady-state energy balance equation is given as:\n$$\nF(T_s) = (1 - \\alpha) S_\\downarrow + L_\\downarrow - \\varepsilon \\sigma T_s^4 - H(T_s) - L_v E(T_s) - G(T_s) = 0\n$$\nwhere the terms represent, in order: absorbed shortwave radiation, incoming longwave radiation, emitted longwave radiation, turbulent sensible heat flux, latent heat flux, and conductive heat flux into the ground.\n\nLet us analyze each term as a function of the unknown surface temperature $T_s$:\n1.  **Radiative Fluxes**:\n    -   Incoming radiation: The absorbed shortwave flux, $(1 - \\alpha) S_\\downarrow$, and the downward longwave flux, $L_\\downarrow$, are independent of $T_s$. They constitute the net energy input to the surface.\n    -   Outgoing radiation: The emitted thermal radiation, $\\varepsilon \\sigma T_s^4$, is governed by the Stefan-Boltzmann law and is a strongly increasing function of $T_s$.\n\n2.  **Turbulent Fluxes**: These fluxes model energy exchange with the atmosphere via turbulence in the surface layer.\n    -   **Sensible Heat Flux ($H$)**: This is the heat transfer due to the temperature difference between the surface and the air. It is given by the bulk aerodynamic formula:\n        $$\n        H(T_s) = \\rho c_p C_H U (T_s - T_a)\n        $$\n        This term is a linear function of $T_s$. The air density $\\rho$ is calculated using the ideal gas law for dry air at the given air temperature $T_a$ and pressure $p$:\n        $$\n        \\rho = \\frac{p}{R_d T_a}\n        $$\n\n    -   **Latent Heat Flux ($L_v E$)**: This represents the energy consumed by the phase change of ice into water vapor (sublimation). The flux is the product of the latent heat of sublimation, $L_v$, and the mass flux of water vapor, $E$.\n        $$\n        E(T_s) = \\max\\!\\left(0,\\, \\rho C_E U \\left(q_s(T_s) - q_a\\right)\\right)\n        $$\n        This formulation depends non-linearly on $T_s$ through the saturation specific humidity at the surface, $q_s(T_s)$. The term $q_a$ is the ambient specific humidity in the air above, which is treated as a constant for a given case. The $\\max(0, \\dots)$ function ensures that we only consider sublimation (mass flux away from the surface) and not deposition.\n        The specific humidities are calculated as follows:\n        -   The saturation specific humidity at a given temperature $T$, $q_s(T)$, is derived from the saturation vapor pressure, $e_s(T)$:\n            $$\n            q_s(T) = \\frac{\\varepsilon_m e_s(T)}{p - (1 - \\varepsilon_m) e_s(T)}\n            $$\n        -   The saturation vapor pressure over ice, $e_s(T)$, is given by the Clausius-Clapeyron relation:\n            $$\n            e_s(T) = e_0 \\exp\\!\\left(\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T}\\right)\\right)\n            $$\n            This shows a strong exponential dependence on temperature.\n        -   The ambient specific humidity, $q_a$, is determined from the ambient air temperature $T_a$ and relative humidity $r_H$:\n            $$\n            q_a = r_H \\, q_s(T_a)\n            $$\n            where $q_s(T_a)$ is calculated using the formulas for $q_s(T)$ and $e_s(T)$ evaluated at $T=T_a$.\n\n3.  **Ground Heat Flux ($G$)**: The conductive heat flux into the subsurface is modeled as:\n    $$\n    G(T_s) = \\frac{k_g}{d_g} (T_s - T_g)\n    $$\n    This term is a linear function of $T_s$ and represents heat conduction towards a layer at a fixed temperature $T_g$.\n\nThe total energy balance function $F(T_s)$ is a continuous function of $T_s$. All outgoing flux terms ($\\varepsilon \\sigma T_s^4$, $H(T_s)$, $L_vE(T_s)$, and $G(T_s)$) are monotonically non-decreasing functions of $T_s$ for $T_s > 0$. Consequently, the function $F(T_s)$ is monotonically decreasing. This property ensures that if a solution to $F(T_s)=0$ exists, it is unique. The problem provides a search interval $[150\\,\\mathrm{K}, 350\\,\\mathrm{K}]$, within which a root is guaranteed to exist as the flux balance will be positive at low temperatures and negative at high temperatures.\n\nThe solution requires solving this non-linear equation for $T_s$ in two scenarios:\n1.  **Without Latent Heat ($T_s^{(\\mathrm{LE}=0)}$)**: The latent heat flux term $L_v E(T_s)$ is set to zero. The equation to solve is:\n    $$\n    F_{\\mathrm{LE}=0}(T_s) = (1 - \\alpha) S_\\downarrow + L_\\downarrow - \\varepsilon \\sigma T_s^4 - H(T_s) - G(T_s) = 0\n    $$\n2.  **With Latent Heat ($T_s^{(\\mathrm{LE}>0)}$)**: The full energy balance equation is solved:\n    $$\n    F_{\\mathrm{LE}>0}(T_s) = (1 - \\alpha) S_\\downarrow + L_\\downarrow - \\varepsilon \\sigma T_s^4 - H(T_s) - L_v E(T_s) - G(T_s) = 0\n    $$\n\nSince these are non-linear transcendental equations, a numerical root-finding algorithm is necessary. A robust bracketing method, such as Brent's method, is an excellent choice given the function's monotonicity and the specified search interval.\n\nFor each test case, we implement the following procedure:\n1.  Assign all physical parameters and constants for the case.\n2.  Pre-calculate quantities that do not depend on $T_s$: air density $\\rho$ and ambient specific humidity $q_a$.\n3.  Define the two energy balance functions, $F_{\\mathrm{LE}=0}(T_s)$ and $F_{\\mathrm{LE}>0}(T_s)$.\n4.  Use a numerical root-finder (specifically, `scipy.optimize.brentq`) to solve $F_{\\mathrm{LE}=0}(T_s)=0$ for $T_s^{(\\mathrm{LE}=0)}$ in the interval $[150\\,\\mathrm{K}, 350\\,\\mathrm{K}]$.\n5.  Similarly, solve $F_{\\mathrm{LE}>0}(T_s)=0$ for $T_s^{(\\mathrm{LE}>0)}$ in the same interval.\n6.  Calculate the temperature reduction $\\Delta T = T_s^{(\\mathrm{LE}=0)} - T_s^{(\\mathrm{LE}>0)}$. This value is expected to be non-negative, as the inclusion of sublimation introduces an additional energy sink, which cools the surface.\n\nThis procedure will be repeated for all four test cases provided. The constants used are: $L_v = 2.834 \\times 10^6\\,\\mathrm{J\\,kg^{-1}}$, $e_0 = 611\\,\\mathrm{Pa}$, $T_0 = 273.16\\,\\mathrm{K}$, $R_v = 461\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $R_d = 287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $\\sigma = 5.670374419 \\times 10^{-8}\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}$, $c_p = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$, and $\\varepsilon_m = 0.622$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the surface temperature reduction due to sublimation for a set of test cases.\n    \"\"\"\n\n    # --- Physical Constants ---\n    L_v = 2.834e6  # Latent heat of sublimation for water ice (J/kg)\n    e0 = 611.0     # Reference saturation pressure (Pa)\n    T0 = 273.16    # Reference saturation temperature (K)\n    R_v = 461.0    # Gas constant for water vapor (J/kg/K)\n    R_d = 287.0    # Gas constant for dry air (J/kg/K)\n    sigma = 5.670374419e-8 # Stefan-Boltzmann constant (W/m^2/K^4)\n    c_p = 1004.0   # Specific heat of air at constant pressure (J/kg/K)\n    eps_m = 0.622  # Ratio of molecular masses of water vapor to dry air\n\n    # --- Test Case Parameters ---\n    test_cases = [\n        # Case 1: general, moderate wind and dry air\n        {'name': 'Case 1', 'alpha': 0.30, 'S_down': 300.0, 'L_down': 150.0, 'epsilon': 0.95,\n         'U': 5.0, 'C_H': 0.003, 'C_E': 0.003, 'p': 5.0e4, 'T_a': 250.0, 'r_H': 0.20,\n         'k_g': 0.20, 'd_g': 0.20, 'T_g': 240.0},\n        # Case 2: boundary, no wind\n        {'name': 'Case 2', 'alpha': 0.30, 'S_down': 300.0, 'L_down': 150.0, 'epsilon': 0.95,\n         'U': 0.0, 'C_H': 0.003, 'C_E': 0.003, 'p': 5.0e4, 'T_a': 250.0, 'r_H': 0.20,\n         'k_g': 0.20, 'd_g': 0.20, 'T_g': 240.0},\n        # Case 3: edge, humid air\n        {'name': 'Case 3', 'alpha': 0.30, 'S_down': 300.0, 'L_down': 150.0, 'epsilon': 0.95,\n         'U': 5.0, 'C_H': 0.003, 'C_E': 0.003, 'p': 5.0e4, 'T_a': 250.0, 'r_H': 0.90,\n         'k_g': 0.20, 'd_g': 0.20, 'T_g': 240.0},\n        # Case 4: low insolation and high albedo\n        {'name': 'Case 4', 'alpha': 0.60, 'S_down': 100.0, 'L_down': 120.0, 'epsilon': 0.95,\n         'U': 5.0, 'C_H': 0.003, 'C_E': 0.003, 'p': 5.0e4, 'T_a': 245.0, 'r_H': 0.30,\n         'k_g': 0.20, 'd_g': 0.20, 'T_g': 235.0}\n    ]\n\n    results = []\n    \n    T_min, T_max = 150.0, 350.0 # Search interval for root finding\n\n    def get_es(T):\n        \"\"\"Calculates saturation vapor pressure over ice (Pa) via Clausius-Clapeyron.\"\"\"\n        return e0 * np.exp((L_v / R_v) * ((1.0 / T0) - (1.0 / T)))\n\n    def get_qs(T, p):\n        \"\"\"Calculates saturation specific humidity (kg/kg).\"\"\"\n        es_T = get_es(T)\n        return (eps_m * es_T) / (p - (1.0 - eps_m) * es_T)\n\n    def energy_balance(Ts, params, include_LE):\n        \"\"\"\n        Defines the surface energy balance function F(Ts) = 0.\n        F(Ts) = Net Radiation - Sensible Heat - Latent Heat - Ground Heat\n        \"\"\"\n        # Unpack parameters\n        alpha = params['alpha']\n        S_down = params['S_down']\n        L_down = params['L_down']\n        epsilon = params['epsilon']\n        U = params['U']\n        C_H = params['C_H']\n        C_E = params['C_E']\n        p = params['p']\n        T_a = params['T_a']\n        k_g = params['k_g']\n        d_g = params['d_g']\n        T_g = params['T_g']\n        rho = params['rho']\n        q_a = params['q_a']\n\n        # --- Calculate flux components ---\n        \n        # Radiative fluxes\n        net_rad_in = (1.0 - alpha) * S_down + L_down\n        rad_out = epsilon * sigma * Ts**4\n\n        # Sensible heat flux\n        H = rho * c_p * C_H * U * (Ts - T_a)\n\n        # Latent heat flux\n        LE = 0.0\n        if include_LE:\n            # Saturation specific humidity at the surface\n            qs_Ts = get_qs(Ts, p)\n            # Mass flux\n            E = rho * C_E * U * (qs_Ts - q_a)\n            E = max(0.0, E) # Only sublimation is considered\n            LE = L_v * E\n\n        # Ground heat flux\n        G = (k_g / d_g) * (Ts - T_g)\n        \n        return net_rad_in - rad_out - H - LE - G\n\n\n    for case in test_cases:\n        \n        # --- Pre-calculate constant parameters for the case ---\n        # Air density\n        case['rho'] = case['p'] / (R_d * case['T_a'])\n        # Ambient specific humidity\n        qs_Ta = get_qs(case['T_a'], case['p'])\n        case['q_a'] = case['r_H'] * qs_Ta\n\n        # --- Solve for Ts with LE=0 ---\n        # The lambda function captures the current 'case' and sets include_LE to False\n        f_no_le = lambda Ts: energy_balance(Ts, case, include_LE=False)\n        Ts_no_le = brentq(f_no_le, T_min, T_max)\n\n        # --- Solve for Ts with LE>0 ---\n        # The lambda function captures the current 'case' and sets include_LE to True\n        f_with_le = lambda Ts: energy_balance(Ts, case, include_LE=True)\n        Ts_with_le = brentq(f_with_le, T_min, T_max)\n\n        # --- Calculate and store the temperature difference ---\n        delta_T = Ts_no_le - Ts_with_le\n        results.append(delta_T)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}