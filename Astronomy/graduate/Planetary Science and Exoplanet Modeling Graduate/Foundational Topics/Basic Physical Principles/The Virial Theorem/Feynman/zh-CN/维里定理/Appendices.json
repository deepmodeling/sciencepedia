{
    "hands_on_practices": [
        {
            "introduction": "维里定理最初是在经典天体力学背景下提出的，用于描述稳定、自引力系统的宏观性质。对于像开普勒轨道这样的周期性系统，虽然瞬时动能 $K(t)$ 和势能 $U(t)$ 不断变化，但它们的长时间平均值遵循一个精确的简单关系。这项练习要求我们从牛顿引力定律等第一性原理出发，通过直接计算来验证一个沿椭圆轨道运动的质点，其时间平均动能和势能之间满足 $2\\langle K \\rangle = -\\langle U \\rangle$ 的关系，从而为理解维里定理的统计性质打下坚实的基础 。",
            "id": "4185409",
            "problem": "考虑一个质量为 $m$ 的测试粒子，在质量为 $M$ 的恒星的牛顿引力作用下，沿一个半长轴为 $a$、偏心率为 $e$（其中 $0 < e < 1$）的束缚开普勒椭圆轨道运动。设引力常数为 $G$，并定义引力参数 $\\mu = G M$。瞬时轨道半径为 $r(t)$，真近点角为 $f(t)$，比角动量（单位质量的角动量）为 $h = |\\mathbf{r} \\times \\mathbf{v}|$，且其守恒。瞬时动能和势能分别为 $K(t) = \\tfrac{1}{2} m v(t)^{2}$ 和 $U(t) = - \\mu m / r(t)$。\n\n仅从牛顿万有引力定律、角动量守恒以及牛顿二体运动的标准性质（包括开普勒椭圆的极坐标方程 $r(f) = p/(1 + e \\cos f)$，其中 $p = a(1 - e^{2})$，以及恒定的掠面速度 $dA/dt = h/2$）出发，完成以下任务：\n\n- 通过将 $K$ 和 $U$ 表示为 $f$ 的函数，并利用在一个轨道周期内 $r$ 随 $f$ 变化的特性，证明对于任何 $e \\neq 0$ 的情况，$K(t)$ 和 $U(t)$ 都在随时间振荡。\n- 计算在一个轨道周期 $T$ 内的时间平均值，\n$$\\langle U \\rangle = \\frac{1}{T} \\int_{0}^{T} U(t)\\, dt, \\qquad \\langle K \\rangle = \\frac{1}{T} \\int_{0}^{T} K(t)\\, dt,$$\n且不引用任何形式的维里定理。\n- 使用你的结果，计算维里比\n$$R \\equiv \\frac{2 \\langle K \\rangle}{-\\langle U \\rangle}.$$\n\n将你对 $R$ 的最终答案表示为一个无单位的纯数。无需进行数值四舍五入，请给出精确值。",
            "solution": "该问题经过严格验证，具有科学依据、良定、客观且完整。这是天体力学中的一个标准问题，旨在检验学生在不引用高级定理的情况下，从第一性原理推导基本结果的能力。\n\n该问题要求完成三件事：证明动能和势能的振荡，计算它们在一个轨道周期内的时间平均值，以及计算维里比。\n\n首先，我们证明对于偏心率 $e$ 满足 $0 < e < 1$ 的椭圆轨道，动能 $K(t)$ 和势能 $U(t)$ 都会振荡。势能由 $U(t) = - \\mu m / r(t)$ 给出，其中 $\\mu = GM$，$r(t)$ 是瞬时轨道半径。半径作为真近点角 $f$ 的函数，由椭圆的极坐标方程给出：\n$$r(f) = \\frac{p}{1 + e \\cos f}$$\n其中 $p = a(1-e^2)$ 是半通径。当粒子沿轨道运动时，真近点角 $f$ 在 $2\\pi$ 的范围内变化。由于 $e \\neq 0$，$e \\cos f$ 项会变化，导致 $r(f)$ 变化。最小半径（近拱点）为 $r_{\\text{min}} = p/(1+e)$（在 $f=0$ 处），最大半径（远拱点）为 $r_{\\text{max}} = p/(1-e)$（在 $f=\\pi$ 处）。由于 $r(t)$ 不是恒定的，所以 $U(t) = -\\mu m / r(t)$ 也不是恒定的，并在其最小值 $U_{\\text{min}} = -\\mu m / r_{\\text{min}}$ 和最大值 $U_{\\text{max}} = -\\mu m / r_{\\text{max}}$ 之间振荡。\n在引力场中，系统的总能量 $E = K(t) + U(t)$ 是守恒的。因此，动能可以表示为 $K(t) = E - U(t)$。由于 $E$ 是一个常数而 $U(t)$ 在振荡，为了保持它们的和的恒定性，$K(t)$ 也必须振荡。\n\n接下来，我们计算时间平均值 $\\langle U \\rangle$ 和 $\\langle K \\rangle$。一个量 $Q(t)$ 在一个轨道周期 $T$ 内的时间平均值定义为 $\\langle Q \\rangle = \\frac{1}{T} \\int_0^T Q(t) dt$。直接对时间进行积分是复杂的。我们可以通过将积分变量从时间 $t$ 变为真近点角 $f$ 来简化积分。$dt$ 和 $df$ 之间的关系可以从角动量守恒导出，后者意味着恒定的掠面速度：\n$$\\frac{dA}{dt} = \\frac{h}{2}$$\n在极坐标中，面积微元是 $dA = \\frac{1}{2} r^2 df$。令两个关于 $dA/dt$ 的表达式相等，得到 $\\frac{1}{2} r^2 \\frac{df}{dt} = \\frac{h}{2}$，这意味着 $dt = \\frac{r^2}{h} df$。\n\n现在我们计算势能的时间平均值 $\\langle U \\rangle$：\n$$\\langle U \\rangle = \\frac{1}{T} \\int_0^T U(t) dt = \\frac{1}{T} \\int_0^{2\\pi} U(f) \\frac{r(f)^2}{h} df$$\n代入 $U(f) = -\\mu m / r(f)$：\n$$\\langle U \\rangle = \\frac{1}{T} \\int_0^{2\\pi} \\left(-\\frac{\\mu m}{r(f)}\\right) \\frac{r(f)^2}{h} df = -\\frac{\\mu m}{hT} \\int_0^{2\\pi} r(f) df$$\n我们需要计算的积分是 $\\int_0^{2\\pi} \\frac{p}{1+e \\cos f} df$。这是一个标准定积分，其值为 $\\frac{2\\pi}{\\sqrt{1-e^2}}$。\n$$\\int_0^{2\\pi} r(f) df = p \\int_0^{2\\pi} \\frac{1}{1+e \\cos f} df = p \\left( \\frac{2\\pi}{\\sqrt{1-e^2}} \\right)$$\n使用给定的关系 $p=a(1-e^2)$，我们得到：\n$$\\int_0^{2\\pi} r(f) df = a(1-e^2) \\frac{2\\pi}{\\sqrt{1-e^2}} = 2\\pi a \\sqrt{1-e^2}$$\n现在我们将此结果代回到 $\\langle U \\rangle$ 的表达式中：\n$$\\langle U \\rangle = -\\frac{\\mu m}{hT} \\left( 2\\pi a \\sqrt{1-e^2} \\right)$$\n为了简化这个表达式，我们使用开普勒力学中的两个标准结果。首先，比角动量 $h$ 与半长轴 $a$ 和偏心率 $e$ 的关系为 $h^2 = \\mu p = \\mu a(1-e^2)$，因此 $h = \\sqrt{\\mu a(1-e^2)}$。其次，开普勒第三定律指出，轨道周期 $T$ 由 $T^2 = \\frac{4\\pi^2}{\\mu} a^3$ 给出，因此 $T = 2\\pi \\sqrt{\\frac{a^3}{\\mu}}$。\n代入 $h$ 和 $T$：\n$$\\langle U \\rangle = -\\frac{\\mu m}{\\left(\\sqrt{\\mu a(1-e^2)}\\right) \\left(2\\pi \\sqrt{a^3/\\mu}\\right)} \\left( 2\\pi a \\sqrt{1-e^2} \\right)$$\n$2\\pi$ 和 $\\sqrt{1-e^2}$ 项被消去。\n$$\\langle U \\rangle = -\\frac{\\mu m a}{\\sqrt{\\mu a} \\sqrt{a^3/\\mu}} = -\\frac{\\mu m a}{\\sqrt{\\mu a \\cdot a^3/\\mu}} = -\\frac{\\mu m a}{\\sqrt{a^4}} = -\\frac{\\mu m a}{a^2}$$\n$$\\langle U \\rangle = -\\frac{\\mu m}{a}$$\n为了求出 $\\langle K \\rangle$，我们使用总能量守恒 $E = K(t) + U(t)$。常数的时间平均值就是它本身，所以 $\\langle E \\rangle = E$。和的平均值等于平均值的和，所以 $\\langle E \\rangle = \\langle K \\rangle + \\langle U \\rangle$。束缚开普勒轨道的总能量是一个标准结果，由 $E = -\\frac{\\mu m}{2a}$ 给出。因此：\n$$\\langle K \\rangle + \\langle U \\rangle = E = -\\frac{\\mu m}{2a}$$\n我们现在可以解出 $\\langle K \\rangle$：\n$$\\langle K \\rangle = E - \\langle U \\rangle = \\left(-\\frac{\\mu m}{2a}\\right) - \\left(-\\frac{\\mu m}{a}\\right) = -\\frac{\\mu m}{2a} + \\frac{\\mu m}{a}$$\n$$\\langle K \\rangle = \\frac{\\mu m}{2a}$$\n最后，我们计算维里比 $R$：\n$$R \\equiv \\frac{2 \\langle K \\rangle}{-\\langle U \\rangle}$$\n代入我们推导出的时间平均能量表达式：\n$$R = \\frac{2 \\left(\\frac{\\mu m}{2a}\\right)}{-\\left(-\\frac{\\mu m}{a}\\right)} = \\frac{\\frac{\\mu m}{a}}{\\frac{\\mu m}{a}}$$\n$$R = 1$$\n推导完成，且与问题约束条件一致。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "维里定理的应用远不止于点质量系统，它在理解行星和恒星等流体天体的结构与演化中扮演着核心角色。一个年轻的气态巨行星通过引力收缩来释放能量，这个过程同时改变了它的内部热能和引力势能。此练习旨在应用维里定理，分析在准静态收缩过程中，释放的引力能有多大一部分被辐射掉，又有多少用于加热行星内部，并揭示这一比例如何依赖于气体的状态方程（通过绝热指数 $\\gamma$ 体现）。这项实践将帮助我们理解为何具有不同内部物理性质的行星会以不同的速率演化，这是行星演化理论的一个基石 。",
            "id": "4185394",
            "problem": "一颗质量为 $M$、半径为 $R$ 的自引力、不旋转的系外行星，由单相气体压力支撑。其热力学行为可以用理想气体状态方程 (EOS) 很好地描述，在准静态收缩期间，绝热指数 $\\gamma$ 假定为常数。该天体始终处于流体静力学平衡状态，磁场可忽略不计，没有整体动能，并在收缩时以光度 $L$ 向太空辐射能量。气体的内能密度为 $u$，压力为 $P$，总内能为 $U = \\int u \\, dV$。总引力势能为 $\\Omega$，按照束缚自引力天体的常规定义，$\\Omega < 0$。状态方程将 $P$ 和 $u$ 联系起来，即 $P = (\\gamma - 1) u$，引力势 $\\Phi$ 满足牛顿引力。\n\n在这些条件下，与从初始半径 $R_{\\mathrm{i}}$ 到最终半径 $R_{\\mathrm{f}}$ 的微小准静态收缩相关的总能量 $E = U + \\Omega$ 的变化，一部分被辐射掉，一部分以增加的内能形式储存起来。请仅从牛顿定律、流体静力学平衡和上述理想气体状态方程出发，确定释放的引力束缚能中被辐射出去的部分如何依赖于 $\\gamma$，并推断两个其他方面完全相同的系外行星（一个以 $\\gamma = 5/3$ 的单原子气体为主，另一个以 $\\gamma = 7/5$ 的分子氢为主）的半径演化相对速率。假设它们在收缩的初始阶段光度 $L$ 相等，并且任何结构常数在此小区间内都大致保持不变。\n\n哪个选项最好地概括了辐射部分的正确表达式以及对半径演化的正确定性推论？\n\nA. 辐射部分为 $f_{\\mathrm{rad}} = 1 - \\dfrac{1}{3(\\gamma - 1)}$。因此，当 $\\gamma = 5/3$ 时，$f_{\\mathrm{rad}} = 1/2$；当 $\\gamma = 7/5$ 时，$f_{\\mathrm{rad}} = 1/6$。在光度 $L$ 固定的情况下，$\\gamma = 7/5$ 的行星必须比 $\\gamma = 5/3$ 的行星收缩得更快才能提供相同的光度，这意味着更软的状态方程会导致更快的初始半径收缩。\n\nB. 辐射部分为 $f_{\\mathrm{rad}} = \\dfrac{1}{3(\\gamma - 1)}$。因此，当 $\\gamma = 5/3$ 时，$f_{\\mathrm{rad}} = 1/2$；当 $\\gamma = 7/5$ 时，$f_{\\mathrm{rad}} = 5/6$。在光度 $L$ 固定的情况下，$\\gamma = 7/5$ 的行星比 $\\gamma = 5/3$ 的行星收缩得更慢。\n\nC. 辐射部分为 $f_{\\mathrm{rad}} = \\dfrac{3\\gamma - 4}{3\\gamma}$。由此得出，当 $\\gamma \\rightarrow 4/3$ 时，$f_{\\mathrm{rad}} \\rightarrow 0$，而对于更大的 $\\gamma$，$f_{\\mathrm{rad}}$ 增加并趋近于1。在光度 $L$ 固定的情况下，$\\gamma = 5/3$ 的行星比 $\\gamma = 7/5$ 的行星收缩得更快。\n\nD. 随着状态方程变软，在 $\\gamma \\rightarrow 4/3$ 的极限下，$f_{\\mathrm{rad}} \\rightarrow 1$，因此辐射压主导的天体辐射出几乎所有释放的引力能。在光度 $L$ 固定的情况下，这意味着更软的状态方程会导致更慢的收缩。\n\nE. 辐射部分主要取决于 $M$ 和 $R$，而与 $\\gamma$ 无关。在光度 $L$ 固定的情况下，两颗行星在初始阶段以相同的速率收缩。",
            "solution": "问题陈述是维里定理在气体天体准静态收缩中的一个有效应用。所有提供的信息都有科学依据、适定且客观。我们可以开始求解。\n\n求解过程需要将系外行星辐射的能量与其引力势能的变化联系起来。这种关系由维里定理和热力学第一定律决定。\n\n1.  **维里定理的推导**\n\n对于一个处于流体静力学平衡中的自引力流体球，压力梯度与引力相平衡：\n$$ \\frac{dP}{dr} = -\\rho(r) \\frac{Gm(r)}{r^2} $$\n其中 $P(r)$ 是压力，$\\rho(r)$ 是密度， $m(r)$ 是半径 $r$ 内包含的质量，$G$ 是引力常数。\n\n为了推导维里定理，我们将此方程乘以 $4\\pi r^3$，并对行星的整个体积（从中心 $r=0$ 到表面 $r=R$）进行积分：\n$$ \\int_0^R 4\\pi r^3 \\frac{dP}{dr} dr = -\\int_0^R 4\\pi r^3 \\rho(r) \\frac{Gm(r)}{r^2} dr $$\n左边 (LHS) 可以通过分部积分 $\\int u \\, dv = uv - \\int v \\, du$ 来计算。令 $u = 4\\pi r^3$ 和 $dv = dP$。则 $du = 12\\pi r^2 dr$ 和 $v = P$。\n$$ \\text{LHS} = [4\\pi r^3 P]_0^R - \\int_0^R P(r) (12\\pi r^2) dr $$\n边界项 $[4\\pi r^3 P]_0^R$ 为零，因为在积分下限处 $r=0$，并且对于孤立天体，其表面压力 $P(R)$ 假定为零。该积分变为：\n$$ \\text{LHS} = -3 \\int_0^R P(r) (4\\pi r^2 dr) = -3 \\int_V P \\, dV $$\n原方程的右边 (RHS) 可以用 $dm = 4\\pi r^2 \\rho dr$ 来改写：\n$$ \\text{RHS} = -\\int_0^R \\frac{Gm(r)}{r} (4\\pi r^2 \\rho(r) dr) = \\int_0^M \\left(-\\frac{Gm}{r}\\right) dm $$\n这就是总引力势能 $\\Omega$ 的定义。因此，令 LHS 和 RHS 相等，就得到了压力形式的维里定理：\n$$ -3 \\int_V P \\, dV = \\Omega $$\n\n2.  **状态方程 (EOS) 的应用**\n\n问题陈述了状态方程将压力 $P$ 和内能密度 $u$ 联系起来，即 $P = (\\gamma - 1) u$。我们将此代入维里定理。假设 $\\gamma$ 在整个天体内是常数：\n$$ -3 \\int_V (\\gamma - 1) u \\, dV = \\Omega $$\n$$ -3(\\gamma - 1) \\int_V u \\, dV = \\Omega $$\n总内能为 $U = \\int_V u \\, dV$。这就得到了多方气体球的维里定理：\n$$ -3(\\gamma - 1) U = \\Omega \\quad \\text{或} \\quad U = -\\frac{\\Omega}{3(\\gamma - 1)} $$\n注意，由于 $\\Omega < 0$，并且对于一个稳定构型有 $\\gamma > 4/3$，所以内能 $U$ 是正的，这符合要求。\n\n3.  **收缩过程中的能量守恒**\n\n行星的总能量为 $E = U + \\Omega$。在准静态收缩过程中，总能量的变化为 $dE = dU + d\\Omega$。辐射走的能量 $dE_{\\mathrm{rad}}$ 等于行星总能量的减少量：$dE_{\\mathrm{rad}} = -dE$。\n\n我们可以用引力势能的变化 $d\\Omega$ 来表示总能量的变化 $dE$。对维里关系式 $U = -\\frac{\\Omega}{3(\\gamma - 1)}$ 求微分，得到：\n$$ dU = -\\frac{d\\Omega}{3(\\gamma - 1)} $$\n在收缩过程中，行星束缚得更紧，因此其势能变得更负 ($d\\Omega < 0$)。因此，内能增加 ($dU > 0$)，这意味着行星会升温。\n\n现在，将 $dU$ 代入 $dE$ 的表达式中：\n$$ dE = dU + d\\Omega = -\\frac{d\\Omega}{3(\\gamma - 1)} + d\\Omega = \\left(1 - \\frac{1}{3(\\gamma - 1)}\\right) d\\Omega $$\n$$ dE = \\left(\\frac{3(\\gamma - 1) - 1}{3(\\gamma - 1)}\\right) d\\Omega = \\left(\\frac{3\\gamma - 4}{3(\\gamma - 1)}\\right) d\\Omega $$\n\n4.  **释放的引力能中的辐射部分**\n\n收缩过程中“释放的引力束缚能”为 $-d\\Omega > 0$。辐射的能量为 $dE_{\\mathrm{rad}} = -dE$。问题要求的是释放的引力能中的辐射部分，即：\n$$ f_{\\mathrm{rad}} = \\frac{dE_{\\mathrm{rad}}}{-d\\Omega} = \\frac{-dE}{-d\\Omega} = \\frac{dE}{d\\Omega} $$\n使用我们得到的用 $d\\Omega$ 表示 $dE$ 的表达式：\n$$ f_{\\mathrm{rad}} = \\frac{3\\gamma - 4}{3(\\gamma - 1)} $$\n这也可以写成 $f_{\\mathrm{rad}} = 1 - \\frac{1}{3(\\gamma-1)}$。另一部分 $1 - f_{\\mathrm{rad}} = \\frac{1}{3(\\gamma-1)}$ 代表了释放的引力能中用于增加行星内部热能的部分。\n\n5.  **数值计算**\n\n我们现在为给定的两个 $\\gamma$ 值计算 $f_{\\mathrm{rad}}$：\n-   单原子气体：$\\gamma = 5/3$。\n    $$ f_{\\mathrm{rad}} = \\frac{3(5/3) - 4}{3(5/3 - 1)} = \\frac{5 - 4}{3(2/3)} = \\frac{1}{2} $$\n-   分子氢气体：$\\gamma = 7/5$。\n    $$ f_{\\mathrm{rad}} = \\frac{3(7/5) - 4}{3(7/5 - 1)} = \\frac{21/5 - 20/5}{3(2/5)} = \\frac{1/5}{6/5} = \\frac{1}{6} $$\n\n6.  **半径演化速率**\n\n光度 $L$ 是能量辐射的速率：$L = \\frac{dE_{\\mathrm{rad}}}{dt} = - \\frac{dE}{dt}$。\n从前面的步骤可知，$dE_{\\mathrm{rad}} = f_{\\mathrm{rad}} (-d\\Omega)$。因此：\n$$ L = f_{\\mathrm{rad}} \\left(-\\frac{d\\Omega}{dt}\\right) $$\n引力势能的形式为 $\\Omega = -k \\frac{GM^2}{R}$，其中 $k$ 是一个与内部质量分布相关的常数。对其求时间导数：\n$$ \\frac{d\\Omega}{dt} = \\frac{d\\Omega}{dR} \\frac{dR}{dt} = \\left(k \\frac{GM^2}{R^2}\\right) \\frac{dR}{dt} $$\n将此代入光度方程：\n$$ L = -f_{\\mathrm{rad}} \\left(k \\frac{GM^2}{R^2}\\right) \\frac{dR}{dt} $$\n半径收缩速率为 $|\\frac{dR}{dt}| = -\\frac{dR}{dt}$。解出此速率：\n$$ \\left|\\frac{dR}{dt}\\right| = \\frac{L R^2}{f_{\\mathrm{rad}} k G M^2} $$\n对于两颗以相同光度 $L$ 辐射且其他方面完全相同（相同的 $M$、$R$、$k$）的行星，其收缩速率与辐射部分成反比：\n$$ \\left|\\frac{dR}{dt}\\right| \\propto \\frac{1}{f_{\\mathrm{rad}}} $$\n比较这两种情况：\n-   行星1 ($\\gamma = 5/3$)：$f_{\\mathrm{rad},1} = 1/2$。\n-   行星2 ($\\gamma = 7/5$)：$f_{\\mathrm{rad},2} = 1/6$。\n由于 $f_{\\mathrm{rad},2} < f_{\\mathrm{rad},1}$，行星2的收缩速率必须大于行星1：$|\\frac{dR}{dt}|_2 > |\\frac{dR}{dt}|_1$。\n绝热指数较小（$\\gamma = 7/5$，一个“更软”的状态方程）的行星辐射出较小部分的释放引力能。为了维持相同的光度，它必须以更高的速率释放引力能，这意味着它必须收缩得更快。\n\n**逐项分析**\n\nA. 辐射部分为 $f_{\\mathrm{rad}} = 1 - \\dfrac{1}{3(\\gamma - 1)}$。因此，当 $\\gamma = 5/3$ 时，$f_{\\mathrm{rad}} = 1/2$；当 $\\gamma = 7/5$ 时，$f_{\\mathrm{rad}} = 1/6$。在光度 $L$ 固定的情况下，$\\gamma = 7/5$ 的行星必须比 $\\gamma = 5/3$ 的行星收缩得更快才能提供相同的光度，这意味着更软的状态方程会导致更快的初始半径收缩。\n-   **公式：** $f_{\\mathrm{rad}} = 1 - \\frac{1}{3(\\gamma - 1)} = \\frac{3\\gamma-4}{3(\\gamma - 1)}$。这与我们的推导相符。\n-   **数值：** $f_{\\mathrm{rad}}(5/3) = 1/2$ 和 $f_{\\mathrm{rad}}(7/5) = 1/6$。这些与我们的计算相符。\n-   **推论：** $f_{\\mathrm{rad}}$ 较小（即 $\\gamma=7/5$）的行星必须收缩得更快。这与我们的结论相符。\n-   **判定：** **正确**。\n\nB. 辐射部分为 $f_{\\mathrm{rad}} = \\dfrac{1}{3(\\gamma - 1)}$。因此，当 $\\gamma = 5/3$ 时，$f_{\\mathrm{rad}} = 1/2$；当 $\\gamma = 7/5$ 时，$f_{\\mathrm{rad}} = 5/6$。在光度 $L$ 固定的情况下，$\\gamma = 7/5$ 的行星比 $\\gamma = 5/3$ 的行星收缩得更慢。\n-   **公式：** 不正确。这个公式代表增加内能的能量部分，而不是辐射的部分。\n-   **数值：** 对于辐射部分，$\\gamma=7/5$ 时的值是不正确的。\n-   **推论：** 关于收缩速度的结论与正确结论相反。\n-   **判定：** **不正确**。\n\nC. 辐射部分为 $f_{\\mathrm{rad}} = \\dfrac{3\\gamma - 4}{3\\gamma}$。由此得出，当 $\\gamma \\rightarrow 4/3$ 时，$f_{\\mathrm{rad}} \\rightarrow 0$，而对于更大的 $\\gamma$，$f_{\\mathrm{rad}}$ 增加并趋近于1。在光度 $L$ 固定的情况下，$\\gamma = 5/3$ 的行星比 $\\gamma = 7/5$ 的行星收缩得更快。\n-   **公式：** 不正确。分母是 $3\\gamma$ 而不是正确的 $3(\\gamma-1)$。\n-   **推论：** 关于收缩速度的结论与正确结论相反。\n-   **判定：** **不正确**。\n\nD. 随着状态方程变软，在 $\\gamma \\rightarrow 4/3$ 的极限下，$f_{\\mathrm{rad}} \\rightarrow 1$，因此辐射压主导的天体辐射出几乎所有释放的引力能。在光度 $L$ 固定的情况下，这意味着更软的状态方程会导致更慢的收缩。\n-   **极限：** 不正确。当状态方程变软并趋于稳定性极限 $\\gamma \\to 4/3$ 时，我们的公式 $f_{\\mathrm{rad}} = \\frac{3\\gamma - 4}{3(\\gamma - 1)}$ 表明 $f_{\\mathrm{rad}} \\to 0$，而不是 $1$。这意味着几乎所有释放的能量都转化为内能，只有很少一部分被辐射。\n-   **推论：** 关于收缩速度的结论与正确结论相反。\n-   **判定：** **不正确**。\n\nE. 辐射部分主要取决于 $M$ 和 $R$，而与 $\\gamma$ 无关。在光度 $L$ 固定的情况下，两颗行星在初始阶段以相同的速率收缩。\n-   **依赖关系：** 不正确。我们的推导表明 $f_{\\mathrm{rad}}$ 仅仅是 $\\gamma$ 的函数。\n-   **推论：** 关于收缩速度的结论是第一个错误陈述的直接后果。\n-   **判定：** **不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在现代天体物理学中，维里定理不仅是一个深刻的理论结果，更是一个用于验证和诊断数值模拟的强大工具。当我们通过计算机模拟一个自引力流体系统（如行星的形成过程）时，我们需要确保模拟结果在物理上是自洽的。这项练习模拟了这一过程，要求我们设计一个计算诊断程序，通过离散计算一个模拟天体的总动能 $K$、引力势能 $W$ 以及压力-体积积分 $\\int P dV$ 来检验维里平衡关系。通过这项实践，你将学习如何将一个基础物理定律转化为一个量化的、可操作的计算工具，用以判断模拟系统是否处于平衡状态，这是行星建模领域的一项关键技能 。",
            "id": "4185355",
            "problem": "您的任务是为牛顿引力下的自引力、可压缩流体设计一个球对称的模拟诊断程序。该诊断程序应在给定的时间步长上评估全局量 $D = 2K + W + 3 \\int P\\, dV$，并返回一个归一化的偏离平衡的度量。该诊断基于维里定理，并将为一个代表半径为 $R$、总质量为 $M$ 的球体的一维径向网格实现。您的程序必须使用在球壳上的离散数值积分，从第一性原理计算 $K$、$W$ 和 $\\int P\\, dV$。\n\n使用的基本原理：\n- 牛顿引力：引力常数 $G$。\n- 运动学和流体动力学定义。\n- 球对称和球壳体积。\n\n需要实现的定义：\n- 使用一个均匀密度的球体，其密度为 $\\rho = \\dfrac{3M}{4\\pi R^3}$。\n- 将半径离散化为 $N$ 个厚度为 $\\Delta r = R/N$ 的球壳，壳中心位于 $r_i = \\left(i - \\dfrac{1}{2}\\right)\\Delta r$，其中 $i \\in \\{1,\\dots,N\\}$。球壳体积为 $V_i = 4\\pi r_i^2 \\Delta r$。\n- 径向速度场是均匀的 $u(r) = u_0$（单位：$\\mathrm{m/s}$）。\n- 对于一个在 $r=R$ 处施加了表面压力 $P_s$ 的均匀密度球体，其静水压力分布由 $P(r) = P_s + \\dfrac{2\\pi}{3} G \\rho^2 \\left(R^2 - r^2\\right)$ 给出（单位：$\\mathrm{Pa}$）。这源于径向流体静力学平衡 $dP/dr = -\\rho\\, G M(r)/r^2$，其中球体内部的 $M(r) = \\dfrac{4\\pi}{3}\\rho r^3$ 且 $P(R) = P_s$。\n- 均匀密度球体内部的引力势为 $\\Phi(r) = -2\\pi G \\rho \\left(R^2 - \\dfrac{r^2}{3}\\right)$（单位：$\\mathrm{J/kg}$），该势的选择是为了与表面的外部势相匹配。\n- 动能计算为 $K = \\sum_{i=1}^N \\dfrac{1}{2}\\,\\rho\\, u_0^2\\, V_i$（单位：$\\mathrm{J}$）。\n- 引力势能计算为 $W = \\dfrac{1}{2} \\sum_{i=1}^N \\rho\\, \\Phi(r_i)\\, V_i$（单位：$\\mathrm{J}$）。\n- 压力-体积积分计算为 $\\int P\\, dV \\approx \\sum_{i=1}^N P(r_i)\\, V_i$（单位：$\\mathrm{J}$）。\n- 诊断量为 $D = 2K + W + 3\\int P\\, dV$（单位：$\\mathrm{J}$）。\n- 报告每个测试用例的归一化偏差 $\\epsilon = \\dfrac{D}{|W|}$，它是一个无量纲的浮点数。这种归一化使得不同用例之间的偏差具有可比性。\n\n所有计算必须使用国际单位制（SI）：质量单位为 $\\mathrm{kg}$，长度单位为 $\\mathrm{m}$，时间单位为 $\\mathrm{s}$，压力单位为 $\\mathrm{Pa}$，能量单位为 $\\mathrm{J}$。任何中间计算中使用的角度都是径向的，不需要角度单位。您的程序应输出三个归一化偏差 $\\epsilon$，对应于下面的三个测试用例。将每个结果表示为小数点后保留六位的小数。\n\n测试套件（使用 $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$）：\n- 用例 A（接近平衡，无表面压力）：$M = 3.0 \\times 10^{24}\\ \\mathrm{kg}$，$R = 1.0 \\times 10^{6}\\ \\mathrm{m}$，$N = 800$，$u_0 = 0\\ \\mathrm{m/s}$，$P_s = 0\\ \\mathrm{Pa}$。\n- 用例 B（因整体膨胀而偏离平衡）：$M$、$R$、$N$ 相同，但 $u_0 = 100\\ \\mathrm{m/s}$，$P_s = 0\\ \\mathrm{Pa}$。\n- 用例 C（具有有限表面压力的流体静力学状态）：$M$、$R$、$N$ 相同，但 $u_0 = 0\\ \\mathrm{m/s}$，$P_s = 1.0 \\times 10^{11}\\ \\mathrm{Pa}$。\n\n算法要求：\n- 构建径向网格并计算 $r_i$ 和 $V_i$。\n- 根据 $M$ 和 $R$ 计算 $\\rho$。\n- 使用提供的公式评估 $u(r_i)$、$P(r_i)$ 和 $\\Phi(r_i)$。\n- 使用离散求和计算 $K$、$W$ 和 $\\int P\\, dV$。\n- 计算 $D$ 和 $\\epsilon$。\n- 将每个 $\\epsilon$ 四舍五入到小数点后六位。\n- 按要求格式汇总三个结果。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 \"[xA,xB,xC]\"，其中 $xA$、$xB$ 和 $xC$ 分别是用例 A、B 和 C 的三个四舍五入后的小数（无空格）。\n\n注意：在 $u_0 = 0$ 和 $P_s = 0$ 的精确流体静力学平衡中，我们预期 $W + 3\\int P\\, dV = 0$，因此 $D \\approx 0$。对于非零的 $P_s$，平衡关系包含一个表面项，因此 $D \\approx 3 P_s V$，其中 $V = \\dfrac{4\\pi}{3} R^3$。偏离零的值（经 $|W|$ 归一化后）表示非平衡状态或存在一个不消失的表面项。",
            "solution": "所提出的问题是计算物理学中一个有效且适定的练习，具体涉及自引力流体的动力学。它要求对一个简化的、球对称的天体模型的标量维里定理中的各项进行数值评估。该模型假设一个均匀密度的球体，这使得压力和引力势分布可以有解析表达式，从而为离散数值验证提供了基础。该问题具有科学依据，内部一致，并要求应用力学和引力的基本原理。\n\n该解决方案通过将球体离散化为一系列同心球壳，并为每个球壳评估物理量来展开。然后将这些量相加以近似计算总动能 $K$、总引力势能 $W$ 和压力-体积积分项 $\\int P\\,dV$。\n\n维里定理的一般形式将系统转动惯量的时间演化与其动能和势能联系起来。对于一个在其表面（半径 $R$）处有外部压力 $P_s$ 的自引力流体球，标量维里定理可以表示为：\n$$\n\\frac{1}{2}\\frac{d^2I}{dt^2} = 2K + W + 3\\int_V P\\,dV - 4\\pi R^3 P_s\n$$\n其中 $I$ 是转动惯量，$K$ 是总动能，$W$ 是引力势能。问题中提出的诊断量 $D = 2K + W + 3\\int P\\,dV$ 因此是衡量系统膨胀或收缩趋势的度量，并考虑了表面压力项。流体静力学平衡状态（$K=0$，$\\frac{d^2I}{dt^2}=0$）意味着 $W + 3\\int P\\,dV - 4\\pi R^3 P_s = 0$，或者 $D = 4\\pi R^3 P_s = 3V P_s$，其中 $V$ 是总体积。归一化偏差 $\\epsilon = D/|W|$ 提供了一个无量纲的度量，表示系统偏离此平衡状态的程度。\n\n分步数值实现如下：\n\n1.  **系统参数**：对于每个测试用例，定义了质量 $M$、半径 $R$、球壳数量 $N$、均匀径向速度 $u_0$ 和表面压力 $P_s$。引力常数为 $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$。\n\n2.  **导出常数**：均匀质量密度 $\\rho$ 根据总质量 $M$ 和半径 $R$ 计算得出：\n    $$\n    \\rho = \\frac{M}{V_{total}} = \\frac{3M}{4\\pi R^3}\n    $$\n    每个球壳的厚度 $\\Delta r$ 通过将总半径 $R$ 除以球壳数量 $N$ 来确定：\n    $$\n    \\Delta r = \\frac{R}{N}\n    $$\n\n3.  **离散化网格**：连续球体由 $N$ 个离散的球壳近似。每个壳层 $i$（$i \\in \\{1, \\dots, N\\}$）的中心位于半径 $r_i$ 处。使用中点法则进行数值积分，第 $i$ 个壳层的代表性半径为：\n    $$\n    r_i = \\left(i - \\frac{1}{2}\\right)\\Delta r\n    $$\n    每个壳层的体积 $V_i$ 近似为其中心半径处的表面积乘以其厚度：\n    $$\n    V_i = 4\\pi r_i^2 \\Delta r\n    $$\n\n4.  **物理量评估**：根据提供的解析模型为每个壳层计算以下各项：\n    *   **动能 ($K$)**：模型假设一个均匀的径向速度场 $u(r) = u_0$。总动能是所有壳层动能的总和。\n        $$\n        K = \\sum_{i=1}^{N} \\frac{1}{2} (\\rho V_i) u_0^2 = \\frac{1}{2}\\rho u_0^2 \\sum_{i=1}^{N} V_i\n        $$\n    *   **引力势能 ($W$)**：均匀球体内部的引力势 $\\Phi(r)$ 由 $\\Phi(r) = -2\\pi G \\rho \\left(R^2 - \\frac{r^2}{3}\\right)$ 给出。总势能通过对每个壳层的贡献求和来计算，使用定义 $W = \\frac{1}{2}\\int \\rho \\Phi \\,dV$。\n        $$\n        W = \\frac{1}{2} \\sum_{i=1}^{N} \\rho \\Phi(r_i) V_i\n        $$\n        因子 $\\frac{1}{2}$ 是为了防止重复计算质量元素之间的相互作用能。\n    *   **压力-体积积分 ($\\int P\\,dV$)**：对于一个在表面压力为 $P_s$ 的流体静力学平衡状态下的均匀球体，其压力分布 $P(r)$ 为 $P(r) = P_s + \\frac{2\\pi}{3} G \\rho^2 \\left(R^2 - r^2\\right)$。压力的体积积分通过以下求和来近似：\n        $$\n        \\int P\\,dV \\approx \\sum_{i=1}^{N} P(r_i) V_i\n        $$\n\n5.  **诊断量计算**：诊断量 $D$ 通过组合上述指定项来计算。\n    $$\n    D = 2K + W + 3\\int P\\,dV\n    $$\n\n6.  **归一化偏差 ($\\epsilon$)**：为了提供一个在不同物理情景下可比较的不平衡度量，$D$ 通过引力势能的绝对值 $|W|$ 进行归一化。\n    $$\n    \\epsilon = \\frac{D}{|W|}\n    $$\n\n最后，将此过程应用于三个测试用例中的每一个，并将得到的 $\\epsilon$ 值四舍五入到小数点后六位作为最终输出。该实现使用数值数组来高效地对 $N$ 个壳层进行求和。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a diagnostic quantity based on the virial theorem for a\n    spherically symmetric, self-gravitating fluid model.\n    \"\"\"\n    # Define the gravitational constant in SI units.\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (M, R, N, u0, Ps)\n    test_cases = [\n        # Case A: near equilibrium, no surface pressure\n        (3.0e24, 1.0e6, 800, 0.0, 0.0),\n        # Case B: expanding, no surface pressure\n        (3.0e24, 1.0e6, 800, 100.0, 0.0),\n        # Case C: hydrostatic with finite surface pressure\n        (3.0e24, 1.0e6, 800, 0.0, 1.0e11),\n    ]\n\n    results = []\n    for M, R, N, u0, Ps in test_cases:\n        # M: total mass (kg)\n        # R: total radius (m)\n        # N: number of shells\n        # u0: uniform radial velocity (m/s)\n        # Ps: surface pressure (Pa)\n\n        # Calculate derived quantities\n        rho = (3.0 * M) / (4.0 * np.pi * R**3)  # Density (kg/m^3)\n        dr = R / N  # Shell thickness (m)\n\n        # Construct the radial grid for shell centers\n        # i represents shell indices from 1 to N\n        # We use numpy's arange to create an array of radii for vectorized calculations\n        i = np.arange(1, N + 1)\n        r = (i - 0.5) * dr  # Radii of shell centers (m)\n        \n        # Calculate shell volumes\n        V = 4.0 * np.pi * r**2 * dr  # Shell volumes (m^3)\n\n        # --- Compute energy and pressure terms ---\n\n        # 1. Kinetic Energy (K)\n        # K = sum(1/2 * dm_i * u0^2) = sum(1/2 * rho * V_i * u0^2)\n        # Since u0 and rho are constant, we can simplify:\n        K = 0.5 * rho * u0**2 * np.sum(V)\n\n        # 2. Gravitational Potential Energy (W)\n        # Potential at radius r: Phi(r) = -2*pi*G*rho*(R^2 - r^2/3)\n        # W = 1/2 * sum(rho * Phi(r_i) * V_i)\n        phi_r = -2.0 * np.pi * G * rho * (R**2 - r**2 / 3.0)\n        W = 0.5 * np.sum(rho * phi_r * V)\n\n        # 3. Pressure-Volume Integral (P_int)\n        # Pressure at radius r: P(r) = Ps + (2*pi/3)*G*rho^2*(R^2 - r^2)\n        # P_int = sum(P(r_i) * V_i)\n        P_r = Ps + (2.0 * np.pi / 3.0) * G * rho**2 * (R**2 - r**2)\n        P_int = np.sum(P_r * V)\n\n        # --- Compute the diagnostics ---\n\n        # Diagnostic quantity D\n        D = 2.0 * K + W + 3.0 * P_int\n\n        # Normalized deviation epsilon\n        epsilon = D / np.abs(W)\n\n        # Round the result to six decimal places as required\n        results.append(round(epsilon, 6))\n\n    # Final print statement in the exact required format.\n    # The format is a comma-separated list of results in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}