{
    "hands_on_practices": [
        {
            "introduction": "To build a robust understanding of complex systems, we often begin with simplified models that isolate the core physics at play. The one-layer atmospheric model is the quintessential starting point for quantitatively studying the greenhouse effect. This exercise  walks you through the foundational calculation, treating the atmosphere as a simple layer that is transparent to incoming solar radiation but acts as a blackbody for the thermal radiation emitted by the surface. By comparing a planet with and without this idealized atmosphere, you will derive the fundamental temperature increase that defines the greenhouse effect.",
            "id": "1887175",
            "problem": "To understand the fundamental physics of the greenhouse effect, a planetary scientist develops a simplified \"one-layer atmosphere\" model for an Earth-like exoplanet. The model considers two scenarios.\n\nIn **Model A**, the planet has no atmosphere. It has a globally uniform albedo $A$ (the fraction of incident radiation that is reflected back to space) and is in thermal equilibrium. Its surface behaves as a perfect blackbody.\n\nIn **Model B**, the same planet is covered by a thin, uniform atmospheric layer. This idealized atmosphere is perfectly transparent to the incoming high-frequency stellar radiation but behaves as a perfect blackbody for the lower-frequency thermal radiation emitted by the planet's surface. The atmospheric layer itself reaches a stable, uniform temperature and radiates as a blackbody both upwards into space and downwards back toward the surface. The planetary surface below remains a perfect blackbody.\n\nAssume the planet is in thermal equilibrium in both models. The system is characterized by the following constants:\n- The stellar constant at the planet's orbit, $S_0 = 1361 \\text{ W/m}^2$.\n- The planetary albedo, $A = 0.300$.\n- The Stefan-Boltzmann constant, $\\sigma = 5.670 \\times 10^{-8} \\text{ W m}^{-2} \\text{K}^{-4}$.\n\nCalculate the increase in the planet's surface temperature when moving from Model A to Model B. Express your answer in Kelvin, rounded to three significant figures.",
            "solution": "We use global radiative equilibrium and the Stefan–Boltzmann law. A sphere of radius $R$ intercepts stellar power $\\pi R^{2} S_{0}$ and has area $4 \\pi R^{2}$, so the globally averaged absorbed shortwave flux is $(1-A) S_{0} / 4$.\n\nModel A (no atmosphere): The surface is a blackbody in equilibrium, so absorbed shortwave equals emitted longwave:\n$$\n\\sigma T_{A}^{4}=\\frac{(1-A) S_{0}}{4}\n$$\nHence,\n$$\nT_{A}=\\left(\\frac{(1-A) S_{0}}{4 \\sigma}\\right)^{1/4}.\n$$\n\nModel B (one-layer greenhouse): Let $T_{s}$ be the surface temperature and $T_{a}$ the atmospheric temperature. The atmosphere is transparent to shortwave and a perfect blackbody in longwave. It absorbs all surface longwave $\\sigma T_{s}^{4}$ and emits $\\sigma T_{a}^{4}$ upward and $\\sigma T_{a}^{4}$ downward.\n\n- Atmospheric energy balance (longwave only):\n$$\n\\sigma T_{s}^{4}=2 \\sigma T_{a}^{4} \\;\\;\\Rightarrow\\;\\; T_{s}^{4}=2 T_{a}^{4}.\n$$\n- Top-of-atmosphere balance: Outgoing longwave to space equals absorbed shortwave,\n$$\n\\sigma T_{a}^{4}=\\frac{(1-A) S_{0}}{4} \\;\\;\\Rightarrow\\;\\; T_{a}^{4}=\\frac{(1-A) S_{0}}{4 \\sigma}.\n$$\nCombining,\n$$\nT_{s}^{4}=2\\,\\frac{(1-A) S_{0}}{4 \\sigma}=\\frac{(1-A) S_{0}}{2 \\sigma}\n\\;\\;\\Rightarrow\\;\\;\nT_{B}=\\left(\\frac{(1-A) S_{0}}{2 \\sigma}\\right)^{1/4}=2^{1/4} T_{A}.\n$$\nTherefore, the surface warming from Model A to Model B is\n$$\n\\Delta T=T_{B}-T_{A}=\\left(2^{1/4}-1\\right) T_{A}.\n$$\n\nNow evaluate numerically with $S_{0}=1361$, $A=0.300$, and $\\sigma=5.670 \\times 10^{-8}$ (SI units throughout).\nFirst compute\n$$\n\\frac{(1-A) S_{0}}{4}=\\frac{0.700 \\times 1361}{4}=238.175,\n$$\nso\n$$\nT_{A}=\\left(\\frac{238.175}{5.670 \\times 10^{-8}}\\right)^{1/4}\n=\\left(4.2008172 \\times 10^{9}\\right)^{1/4}\\approx 254.585 \\text{ K}.\n$$\nThen\n$$\n\\Delta T=\\left(2^{1/4}-1\\right) T_{A}\\approx 0.189207 \\times 254.585 \\approx 48.169 \\text{ K}.\n$$\nRounded to three significant figures:\n$$\n\\Delta T \\approx 48.2 \\text{ K}.\n$$",
            "answer": "$$\\boxed{48.2}$$"
        },
        {
            "introduction": "While the one-layer model treats the atmosphere as perfectly opaque in the thermal infrared, a more physical description requires quantifying this opacity. The key parameter for this is the optical depth, $\\tau$, which measures how effectively the atmosphere absorbs radiation along a path. This exercise  moves beyond the idealized blackbody layer and challenges you to calculate the line-center optical depth for carbon dioxide from fundamental atmospheric properties. By connecting macroscopic quantities like pressure and gas concentration to the microscopic absorption properties, you will directly assess the important concept of absorption line saturation, a cornerstone of the greenhouse effect.",
            "id": "4050473",
            "problem": "Consider a dry, plane-parallel Earth atmosphere with a vertical pressure profile $p(z) = p_{s} \\exp\\!\\left(-\\frac{z}{H}\\right)$, where $p_{s} = 1.013 \\times 10^{5}\\,\\mathrm{Pa}$ is the surface pressure and $H = 7.5\\,\\mathrm{km}$ is the scale height. Assume constant gravitational acceleration $g = 9.81\\,\\mathrm{m\\,s^{-2}}$. Carbon dioxide has a uniform mole fraction $x_{\\mathrm{CO_{2}}} = 4.15 \\times 10^{-4}$ throughout the column. The mean molecular mass of dry air is $\\mu_{\\mathrm{air}} = 28.97\\,\\mathrm{g\\,mol^{-1}}$, and the molecular mass of carbon dioxide is $\\mu_{\\mathrm{CO_{2}}} = 44.01\\,\\mathrm{g\\,mol^{-1}}$. At the $15\\,\\mathrm{\\mu m}$ band line center, treat the monochromatic mass absorption coefficient of carbon dioxide as constant with altitude and equal to $\\kappa_{0} = 1.0 \\times 10^{3}\\,\\mathrm{m^{2}\\,kg^{-1}}$ (defined per unit mass of carbon dioxide). Using only fundamental definitions and laws appropriate for radiative transfer and atmospheric dynamics, derive an expression for the vertically integrated, line-center optical depth from the surface to the top of the atmosphere and evaluate it numerically. Then, based solely on the magnitude of the computed line-center optical depth, state whether the line core is saturated. Round your final numerical answer for the line-center column optical depth to three significant figures. Express the optical depth as a dimensionless number in your final answer.",
            "solution": "The problem is to compute the vertically integrated, line-center optical depth of carbon dioxide in a model atmosphere and determine if the line is saturated.\n\nFirst, the validation of the problem statement is performed.\n\n**Step 1: Extract Givens**\n-   Vertical pressure profile: $p(z) = p_{s} \\exp\\!\\left(-\\frac{z}{H}\\right)$\n-   Surface pressure: $p_{s} = 1.013 \\times 10^{5}\\,\\mathrm{Pa}$\n-   Scale height: $H = 7.5\\,\\mathrm{km}$\n-   Gravitational acceleration: $g = 9.81\\,\\mathrm{m\\,s^{-2}}$\n-   Carbon dioxide mole fraction: $x_{\\mathrm{CO_{2}}} = 4.15 \\times 10^{-4}$\n-   Mean molecular mass of dry air: $\\mu_{\\mathrm{air}} = 28.97\\,\\mathrm{g\\,mol^{-1}}$\n-   Molecular mass of carbon dioxide: $\\mu_{\\mathrm{CO_{2}}} = 44.01\\,\\mathrm{g\\,mol^{-1}}$\n-   Monochromatic mass absorption coefficient of $\\mathrm{CO_{2}}$: $\\kappa_{0} = 1.0 \\times 10^{3}\\,\\mathrm{m^{2}\\,kg^{-1}}$\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, using fundamental principles of atmospheric physics, radiative transfer, and chemistry. The given values are realistic for Earth's atmosphere (e.g., surface pressure is approximately $1$ atm, a $\\mathrm{CO_2}$ mole fraction of $415$ ppm is current, and the scale height corresponds to a physically reasonable atmospheric temperature). The problem is well-posed, providing all necessary information to compute a unique, dimensionless quantity. The language is objective and precise. The assumptions, such as a constant mass absorption coefficient and uniform mole fraction, are standard simplifications in introductory atmospheric physics problems. All conditions are internally consistent. For instance, the exponential pressure profile is a direct consequence of the hydrostatic balance and the ideal gas law for an isothermal atmosphere, and the column mass derived from this profile is consistent with the result from hydrostatic balance alone. The problem is therefore deemed valid.\n\n**Step 3: Solution Derivation**\nThe vertical optical depth, $\\tau_0$, from the surface ($z=0$) to the top of the atmosphere ($z \\to \\infty$) is defined as the integral of the volume absorption coefficient, $\\alpha_0(z)$, along the vertical path:\n$$\n\\tau_0 = \\int_0^{\\infty} \\alpha_0(z) \\, dz\n$$\nThe volume absorption coefficient is the product of the mass absorption coefficient of the absorbing gas ($\\kappa_0$) and the density of that gas ($\\rho_{\\mathrm{CO_2}}(z)$). The problem states $\\kappa_0$ is constant with altitude.\n$$\n\\alpha_0(z) = \\kappa_0 \\rho_{\\mathrm{CO_2}}(z)\n$$\nSubstituting this into the integral for optical depth gives:\n$$\n\\tau_0 = \\int_0^{\\infty} \\kappa_0 \\rho_{\\mathrm{CO_2}}(z) \\, dz = \\kappa_0 \\int_0^{\\infty} \\rho_{\\mathrm{CO_2}}(z) \\, dz\n$$\nThe integral $\\int_0^{\\infty} \\rho_{\\mathrm{CO_2}}(z) \\, dz$ represents the total column mass of carbon dioxide per unit area, which we can denote as $M_{\\mathrm{CO_2, col}}$.\n\nTo find $M_{\\mathrm{CO_2, col}}$, we first relate the density of carbon dioxide, $\\rho_{\\mathrm{CO_2}}(z)$, to the total density of air, $\\rho_{\\mathrm{air}}(z)$. This is done through the mass fraction of $\\mathrm{CO_2}$, $m_{\\mathrm{CO_2}}$, which is constant because the mole fraction $x_{\\mathrm{CO_2}}$ is given as uniform.\n$$\n\\rho_{\\mathrm{CO_2}}(z) = m_{\\mathrm{CO_2}} \\, \\rho_{\\mathrm{air}}(z)\n$$\nThe mass fraction is related to the mole fraction by the molecular masses of the components. For a trace gas like $\\mathrm{CO_2}$, the mean molecular mass of the mixture is very close to the mean molecular mass of dry air, $\\mu_{\\mathrm{air}}$. We can approximate the mass fraction as:\n$$\nm_{\\mathrm{CO_2}} = \\frac{\\text{mass of } \\mathrm{CO_2}}{\\text{total mass}} \\approx \\frac{x_{\\mathrm{CO_{2}}} \\mu_{\\mathrm{CO_{2}}}}{\\mu_{\\mathrm{air}}}\n$$\nThis approximation is highly accurate, as $x_{\\mathrm{CO_{2}}} \\ll 1$. Substituting this into the expression for $\\tau_0$:\n$$\n\\tau_0 = \\kappa_0 \\int_0^{\\infty} \\left( x_{\\mathrm{CO_{2}}} \\frac{\\mu_{\\mathrm{CO_{2}}}}{\\mu_{\\mathrm{air}}} \\right) \\rho_{\\mathrm{air}}(z) \\, dz\n$$\nSince $x_{\\mathrm{CO_{2}}}$, $\\mu_{\\mathrm{CO_{2}}}$, and $\\mu_{\\mathrm{air}}$ are constants, they can be moved outside the integral:\n$$\n\\tau_0 = \\kappa_0 x_{\\mathrm{CO_{2}}} \\frac{\\mu_{\\mathrm{CO_{2}}}}{\\mu_{\\mathrm{air}}} \\int_0^{\\infty} \\rho_{\\mathrm{air}}(z) \\, dz\n$$\nThe remaining integral, $\\int_0^{\\infty} \\rho_{\\mathrm{air}}(z) \\, dz$, is the total column mass of air, $M_{\\mathrm{air, col}}$. This quantity can be determined directly from the surface pressure $p_s$ using the equation of hydrostatic equilibrium, which states that the change in pressure with altitude is due to the weight of the air above:\n$$\n\\frac{dp}{dz} = - \\rho_{\\mathrm{air}}(z) g\n$$\nRearranging and integrating from the surface ($z=0$, $p=p_s$) to the top of the atmosphere ($z \\to \\infty$, $p \\to 0$):\n$$\n\\int_{p_s}^{0} dp = \\int_0^{\\infty} -g \\rho_{\\mathrm{air}}(z) \\, dz\n$$\n$$\n0 - p_s = -g \\int_0^{\\infty} \\rho_{\\mathrm{air}}(z) \\, dz\n$$\n$$\nM_{\\mathrm{air, col}} = \\int_0^{\\infty} \\rho_{\\mathrm{air}}(z) \\, dz = \\frac{p_s}{g}\n$$\nThis fundamental result allows us to calculate the total column mass of air without needing to know the specific density or temperature profiles, relying only on surface pressure and gravity. The information about the exponential pressure profile and scale height is consistent with this but not strictly necessary for this step.\n\nSubstituting this result back into the expression for $\\tau_0$, we obtain the final analytical expression for the line-center optical depth:\n$$\n\\tau_0 = \\kappa_0 x_{\\mathrm{CO_{2}}} \\frac{\\mu_{\\mathrm{CO_{2}}}}{\\mu_{\\mathrm{air}}} \\frac{p_s}{g}\n$$\n\nNow, we evaluate this expression numerically. All values must be in SI units.\n- $\\kappa_0 = 1.0 \\times 10^{3}\\,\\mathrm{m^{2}\\,kg^{-1}}$\n- $x_{\\mathrm{CO_{2}}} = 4.15 \\times 10^{-4}$\n- $\\mu_{\\mathrm{CO_{2}}} = 44.01\\,\\mathrm{g\\,mol^{-1}} = 0.04401\\,\\mathrm{kg\\,mol^{-1}}$\n- $\\mu_{\\mathrm{air}} = 28.97\\,\\mathrm{g\\,mol^{-1}} = 0.02897\\,\\mathrm{kg\\,mol^{-1}}$\n- $p_s = 1.013 \\times 10^5\\,\\mathrm{Pa} = 1.013 \\times 10^5\\,\\mathrm{kg\\,m^{-1}\\,s^{-2}}$\n- $g = 9.81\\,\\mathrm{m\\,s^{-2}}$\n\n$$\n\\tau_0 = (1.0 \\times 10^{3}) \\times (4.15 \\times 10^{-4}) \\times \\frac{0.04401}{0.02897} \\times \\frac{1.013 \\times 10^5}{9.81}\n$$\nCalculating the terms:\n$$\n\\frac{\\mu_{\\mathrm{CO_{2}}}}{\\mu_{\\mathrm{air}}} = \\frac{0.04401}{0.02897} \\approx 1.51916\n$$\n$$\n\\frac{p_s}{g} = \\frac{1.013 \\times 10^5}{9.81} \\approx 10326.198\\,\\mathrm{kg\\,m^{-2}}\n$$\n$$\n\\tau_0 = (1.0 \\times 10^{3}) \\times (4.15 \\times 10^{-4}) \\times (1.51916) \\times (10326.198)\n$$\n$$\n\\tau_0 \\approx 6509.43\n$$\nRounding to three significant figures, the line-center column optical depth is $6.51 \\times 10^3$.\n\nThe final part of the problem is to determine if the line core is saturated. An absorption line is considered saturated, or optically thick, if its optical depth is significantly greater than $1$. In this case, $\\tau_0 \\approx 6.51 \\times 10^3 \\gg 1$. The magnitude of the optical depth is very large. This indicates that radiation emitted from the lower atmosphere at the line-center frequency is almost completely absorbed long before it can reach the top of the atmosphere. Therefore, the line core is definitively saturated.",
            "answer": "$$\n\\boxed{6.51 \\times 10^{3}}\n$$"
        },
        {
            "introduction": "Real greenhouse gas absorption is not uniform; it varies dramatically with wavelength, creating a complex spectrum of transparent \"windows\" and highly opaque absorption bands. Averaging this complexity into a single \"gray\" absorption coefficient can introduce significant errors in climate models. This practice  delves into this crucial issue by having you compare the outgoing longwave radiation (OLR) calculated using a simple gray model versus a more realistic correlated-$k$ method. By implementing these two approaches, you will quantify the error introduced by the gray approximation and gain insight into why spectrally resolved techniques are essential for accurate planetary climate modeling.",
            "id": "4182445",
            "problem": "You are tasked with implementing two radiative transfer models to compute the top-of-atmosphere outgoing longwave radiation (OLR) for a humid atmosphere and then quantifying the error introduced by a gray approximation when compared against a simplified correlated-$k$ treatment. The greenhouse effect is to be represented by water vapor absorption in the thermal infrared. The computation must be expressed in terms of physically grounded quantities and laws and adhere to the following specifications.\n\nStart from the plane-parallel, one-dimensional Schwarzschild equation for radiative transfer in the thermal infrared and Beer–Lambert law. Let $F_{\\uparrow}(\\nu, 0)$ denote the upward spectral flux at the top of atmosphere for wavenumber $\\nu$. For an isothermal atmospheric layer at temperature $T_{\\mathrm{atm}}$ over a surface at temperature $T_{\\mathrm{sfc}}$, and using the diffusivity approximation with a constant diffusivity factor $D$, the upward spectral flux at the top-of-atmosphere can be approximated by\n$$\nF_{\\uparrow}(\\nu, 0) \\approx \\pi B_{\\nu}(T_{\\mathrm{atm}})\\left(1 - e^{-D\\tau_{\\nu}}\\right) + \\pi B_{\\nu}(T_{\\mathrm{sfc}})e^{-D\\tau_{\\nu}},\n$$\nwhere $B_{\\nu}(T)$ is the Planck function, $\\tau_{\\nu}$ is the spectral optical depth from the surface to space, and $D$ is a constant chosen to approximate the angular integration. In the hemispheric mean (diffusivity) approximation use $D = 1.66$. Angular units are not needed because the hemispheric flux has already been integrated over angle via the diffusivity approximation.\n\nTo avoid explicit spectral integration of $B_{\\nu}(T)$, you should partition the longwave spectrum into two broad bands with fixed fractional Planck-weighting at the temperatures of interest, and approximate the band-integrated flux by replacing integrals of the Planck function with the Stefan–Boltzmann law and fractional weights. Define the two bands and their Planck-weight fractions as follows:\n- Water vapor window band (approximately $8$–$12\\,\\mu\\mathrm{m}$) with fractional weight $f_{\\mathrm{win}} = 0.3$.\n- Water vapor strong-absorption band (approximately $5$–$8\\,\\mu\\mathrm{m}$ plus $12$–$20\\,\\mu\\mathrm{m}$) with fractional weight $f_{\\mathrm{str}} = 0.7$.\n\nAdopt the Stefan–Boltzmann constant $\\sigma = 5.670374419\\times 10^{-8}\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}$. The total longwave flux from a blackbody at temperature $T$ is then $\\sigma T^{4}$, and the band-integrated flux is approximated by the fractional weight times $\\sigma T^{4}$.\n\nImplement two absorption models for water vapor:\n1. Gray approximation: Use a single, Planck-weighted mean absorption coefficient $k_{\\mathrm{gray}}$ to represent the entire longwave spectrum. The monochromatic optical depth is replaced by a gray optical depth $\\tau = k_{\\mathrm{gray}}\\,u$, where $u$ is the vertically integrated water vapor column mass in $\\mathrm{kg\\,m^{-2}}$. The OLR under the gray approximation is\n$$\nF_{\\mathrm{gray}} = \\sigma T_{\\mathrm{atm}}^{4}\\left(1 - e^{-D\\tau}\\right) + \\sigma T_{\\mathrm{sfc}}^{4}e^{-D\\tau}.\n$$\n\n2. Correlated-$k$ approximation: Represent each band by a cumulative distribution of absorption coefficients $k(g)$ discretized at four quadrature points corresponding to equal partitions of $g\\in[0,1]$ with weights $w_{j} = 0.25$ for $j\\in\\{1,2,3,4\\}$. The optical depth in each quadrature point is $\\tau_{i,j} = k_{i,j}\\,u$ for band $i$ and quadrature $j$. The band-integrated OLR is then the weighted sum across bands and quadrature points:\n$$\nF_{\\mathrm{ck}} = \\sum_{i \\in \\{\\mathrm{win}, \\mathrm{str}\\}} f_{i} \\sum_{j=1}^{4} w_{j}\\left[\\sigma T_{\\mathrm{atm}}^{4}\\left(1 - e^{-D\\tau_{i,j}}\\right) + \\sigma T_{\\mathrm{sfc}}^{4}e^{-D\\tau_{i,j}}\\right].\n$$\n\nUse the following pre-tabulated water vapor correlated-$k$ coefficients $k_{i,j}$ in $\\mathrm{m^{2}\\,kg^{-1}}$ for the two bands, intended to be representative (plausible) for humid terrestrial-like conditions:\n- Window band $k_{\\mathrm{win},j}$: $\\{1\\times 10^{-4},\\,5\\times 10^{-4},\\,2\\times 10^{-3},\\,1\\times 10^{-2}\\}\\,\\mathrm{m^{2}\\,kg^{-1}}$.\n- Strong band $k_{\\mathrm{str},j}$: $\\{5\\times 10^{-2},\\,2\\times 10^{-1},\\,1,\\,5\\}\\,\\mathrm{m^{2}\\,kg^{-1}}$.\n\nDefine the gray absorption coefficient $k_{\\mathrm{gray}}$ as the Planck-weighted mean over bands and the quadrature points:\n$$\nk_{\\mathrm{gray}} = \\sum_{i \\in \\{\\mathrm{win}, \\mathrm{str}\\}} f_{i} \\sum_{j=1}^{4} w_{j}\\,k_{i,j}.\n$$\n\nDefine the signed OLR error as\n$$\n\\Delta F = F_{\\mathrm{gray}} - F_{\\mathrm{ck}},\n$$\nwith units of $\\mathrm{W\\,m^{-2}}$.\n\nImplement a program that, for each test case, computes $\\Delta F$ using the above models and parameters. Express all temperatures in $\\mathrm{K}$, column water vapor $u$ in $\\mathrm{kg\\,m^{-2}}$, and OLR in $\\mathrm{W\\,m^{-2}}$. Your program must output the list of $\\Delta F$ values for all test cases in a single line as a comma-separated Python list, with each element a floating-point number in $\\mathrm{W\\,m^{-2}}$.\n\nTest suite (each test case is a triple $(T_{\\mathrm{sfc}}, T_{\\mathrm{atm}}, u)$):\n- Case $1$ (humid Earth-like): $(300\\,\\mathrm{K},\\,270\\,\\mathrm{K},\\,30\\,\\mathrm{kg\\,m^{-2}})$.\n- Case $2$ (dry atmosphere): $(290\\,\\mathrm{K},\\,260\\,\\mathrm{K},\\,2\\,\\mathrm{kg\\,m^{-2}})$.\n- Case $3$ (very humid, hot exoplanet): $(340\\,\\mathrm{K},\\,320\\,\\mathrm{K},\\,200\\,\\mathrm{kg\\,m^{-2}})$.\n- Case $4$ (cold, humid): $(250\\,\\mathrm{K},\\,230\\,\\mathrm{K},\\,30\\,\\mathrm{kg\\,m^{-2}})$.\n- Case $5$ (optically thin limit): $(300\\,\\mathrm{K},\\,270\\,\\mathrm{K},\\,0\\,\\mathrm{kg\\,m^{-2}})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\text{result1},\\text{result2},\\text{result3}\\right]$), with each element in $\\mathrm{W\\,m^{-2}}$.",
            "solution": "The user-provided problem statement has been analyzed and validated.\n\n### Step 1: Extract Givens\n- **Schwarzschild Equation Approximation**: The upward spectral flux at the top-of-atmosphere, $F_{\\uparrow}(\\nu, 0)$, for an isothermal atmospheric layer at temperature $T_{\\mathrm{atm}}$ over a surface at temperature $T_{\\mathrm{sfc}}$ is given by:\n$$\nF_{\\uparrow}(\\nu, 0) \\approx \\pi B_{\\nu}(T_{\\mathrm{atm}})\\left(1 - e^{-D\\tau_{\\nu}}\\right) + \\pi B_{\\nu}(T_{\\mathrm{sfc}})e^{-D\\tau_{\\nu}}\n$$\nwhere $B_{\\nu}(T)$ is the Planck function, $\\tau_{\\nu}$ is the spectral optical depth, and $D$ is the diffusivity factor.\n- **Diffusivity Factor**: $D = 1.66$.\n- **Stefan-Boltzmann Constant**: $\\sigma = 5.670374419\\times 10^{-8}\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}$.\n- **Band Model**: The longwave spectrum is partitioned into two bands with fractional Planck-weights:\n  - Window band: $f_{\\mathrm{win}} = 0.3$.\n  - Strong-absorption band: $f_{\\mathrm{str}} = 0.7$.\n- **Gray Approximation Model**: The Outgoing Longwave Radiation (OLR) is given by:\n$$\nF_{\\mathrm{gray}} = \\sigma T_{\\mathrm{atm}}^{4}\\left(1 - e^{-D\\tau}\\right) + \\sigma T_{\\mathrm{sfc}}^{4}e^{-D\\tau}\n$$\nwhere the gray optical depth is $\\tau = k_{\\mathrm{gray}}\\,u$, and $u$ is the column water vapor mass in $\\mathrm{kg\\,m^{-2}}$.\n- **Correlated-$k$ Approximation Model**: The OLR is the weighted sum over bands and quadrature points:\n$$\nF_{\\mathrm{ck}} = \\sum_{i \\in \\{\\mathrm{win}, \\mathrm{str}\\}} f_{i} \\sum_{j=1}^{4} w_{j}\\left[\\sigma T_{\\mathrm{atm}}^{4}\\left(1 - e^{-D\\tau_{i,j}}\\right) + \\sigma T_{\\mathrm{sfc}}^{4}e^{-D\\tau_{i,j}}\\right]\n$$\nwith quadrature weights $w_{j} = 0.25$ for $j \\in \\{1,2,3,4\\}$, and optical depth $\\tau_{i,j} = k_{i,j}\\,u$.\n- **Correlated-$k$ Coefficients ($k_{i,j}$ in $\\mathrm{m^{2}\\,kg^{-1}}$)**:\n  - Window band ($k_{\\mathrm{win},j}$): $\\{1\\times 10^{-4},\\,5\\times 10^{-4},\\,2\\times 10^{-3},\\,1\\times 10^{-2}\\}$.\n  - Strong band ($k_{\\mathrm{str},j}$): $\\{5\\times 10^{-2},\\,2\\times 10^{-1},\\,1,\\,5\\}$.\n- **Gray Absorption Coefficient Definition**:\n$$\nk_{\\mathrm{gray}} = \\sum_{i \\in \\{\\mathrm{win}, \\mathrm{str}\\}} f_{i} \\sum_{j=1}^{4} w_{j}\\,k_{i,j}\n$$\n- **Error Definition**: The signed OLR error is $\\Delta F = F_{\\mathrm{gray}} - F_{\\mathrm{ck}}$.\n- **Test Suite**: A set of five test cases $(T_{\\mathrm{sfc}}, T_{\\mathrm{atm}}, u)$:\n  1. $(300\\,\\mathrm{K},\\,270\\,\\mathrm{K},\\,30\\,\\mathrm{kg\\,m^{-2}})$\n  2. $(290\\,\\mathrm{K},\\,260\\,\\mathrm{K},\\,2\\,\\mathrm{kg\\,m^{-2}})$\n  3. $(340\\,\\mathrm{K},\\,320\\,\\mathrm{K},\\,200\\,\\mathrm{kg\\,m^{-2}})$\n  4. $(250\\,\\mathrm{K},\\,230\\,\\mathrm{K},\\,30\\,\\mathrm{kg\\,m^{-2}})$\n  5. $(300\\,\\mathrm{K},\\,270\\,\\mathrm{K},\\,0\\,\\mathrm{kg\\,m^{-2}})$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It is based on standard, albeit simplified, principles of atmospheric radiative transfer, including the Schwarzschild equation, Beer-Lambert law, and Planck's law integrated via the Stefan-Boltzmann law. The use of a gray model versus a correlated-$k$ model is a standard pedagogical and research problem in atmospheric science. All necessary constants, equations, and parameters are provided, ensuring the problem is self-contained and that a unique solution exists for each test case. The language is formal and precise, with no subjectivity. The parameters are physically plausible for the described scenarios.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be developed and presented.\n\n### Solution Derivation and Implementation\nThe task is to compute the error, $\\Delta F$, between two radiative transfer models: a simplified gray approximation and a more physically representative two-band correlated-$k$ model. This error quantifies the inaccuracy introduced by averaging the absorption coefficient over the spectrum before calculating the atmospheric transmission.\n\nThe core of the calculation for both models is the expression for upward flux, which can be compactly written as:\n$$\nF = F_{\\mathrm{atm,BB}} (1 - \\mathcal{T}) + F_{\\mathrm{sfc,BB}} \\mathcal{T}\n$$\nwhere $F_{\\mathrm{sfc,BB}} = \\sigma T_{\\mathrm{sfc}}^4$ and $F_{\\mathrm{atm,BB}} = \\sigma T_{\\mathrm{atm}}^4$ are the blackbody fluxes from the surface and atmosphere, respectively. The term $\\mathcal{T} = e^{-D\\tau}$ represents the flux-transmittance of the atmosphere, with $\\tau$ being the optical depth.\n\nThe solution proceeds in three main steps for each test case $(T_{\\mathrm{sfc}}, T_{\\mathrm{atm}}, u)$.\n\n**Step 1: Compute the Gray Absorption Coefficient, $k_{\\mathrm{gray}}$**\nFirst, we compute the single Planck-weighted mean absorption coefficient $k_{\\mathrm{gray}}$ that will represent the entire spectrum in the gray model. This is a constant value for all test cases. Using the provided definition and parameters:\n$$\nk_{\\mathrm{gray}} = f_{\\mathrm{win}} \\sum_{j=1}^{4} w_{j}\\,k_{\\mathrm{win},j} + f_{\\mathrm{str}} \\sum_{j=1}^{4} w_{j}\\,k_{\\mathrm{str},j}\n$$\nGiven $w_j=0.25$ for all $j$:\n$$\n\\sum_{j=1}^{4} w_{j}\\,k_{\\mathrm{win},j} = 0.25 \\times (10^{-4} + 5 \\times 10^{-4} + 2 \\times 10^{-3} + 10^{-2}) = 0.25 \\times 0.0126 = 0.00315 \\, \\mathrm{m^2\\,kg^{-1}}\n$$\n$$\n\\sum_{j=1}^{4} w_{j}\\,k_{\\mathrm{str},j} = 0.25 \\times (0.05 + 0.2 + 1 + 5) = 0.25 \\times 6.25 = 1.5625 \\, \\mathrm{m^2\\,kg^{-1}}\n$$\nSubstituting these into the equation for $k_{\\mathrm{gray}}$ with $f_{\\mathrm{win}}=0.3$ and $f_{\\mathrm{str}}=0.7$:\n$$\nk_{\\mathrm{gray}} = (0.3 \\times 0.00315) + (0.7 \\times 1.5625) = 0.000945 + 1.09375 = 1.094695 \\, \\mathrm{m^2\\,kg^{-1}}\n$$\n\n**Step 2: Compute OLR for Gray and Correlated-$k$ Models**\nFor a given $(T_{\\mathrm{sfc}}, T_{\\mathrm{atm}}, u)$, we calculate the OLR from both models.\n\n**Gray Model OLR, $F_{\\mathrm{gray}}$:**\nThe gray optical depth is $\\tau = k_{\\mathrm{gray}} \\times u$. The transmittance is $\\mathcal{T}_{\\mathrm{gray}} = e^{-D\\tau}$. The OLR is then:\n$$\nF_{\\mathrm{gray}} = \\sigma T_{\\mathrm{atm}}^{4} (1 - e^{-D k_{\\mathrm{gray}} u}) + \\sigma T_{\\mathrm{sfc}}^{4} e^{-D k_{\\mathrm{gray}} u}\n$$\n\n**Correlated-$k$ Model OLR, $F_{\\mathrm{ck}}$:**\nThe correlated-$k$ model acknowledges that transmission is a non-linear function of the absorption coefficient. Instead of averaging $k$ first, it computes the transmission for a distribution of $k$ values and then averages the resulting fluxes. The total OLR is the sum of contributions from each band, which are themselves weighted sums over the quadrature points:\n$$\nF_{\\mathrm{ck}} = F_{\\mathrm{ck,win}} + F_{\\mathrm{ck,str}}\n$$\nwhere the contribution from each band $i \\in \\{\\mathrm{win}, \\mathrm{str}\\}$ is:\n$$\nF_{\\mathrm{ck},i} = f_i \\sum_{j=1}^{4} w_j \\left[ \\sigma T_{\\mathrm{atm}}^{4} (1 - e^{-D k_{i,j} u}) + \\sigma T_{\\mathrm{sfc}}^{4} e^{-D k_{i,j} u} \\right]\n$$\nThis calculation involves looping through the four $k_{\\mathrm{win},j}$ coefficients and four $k_{\\mathrm{str},j}$ coefficients, calculating the flux for each, and summing the results with the appropriate weights $f_i$ and $w_j$.\n\n**Step 3: Compute the Signed Error, $\\Delta F$**\nFinally, the error is calculated as the difference between the two model outputs:\n$$\n\\Delta F = F_{\\mathrm{gray}} - F_{\\mathrm{ck}}\n$$\nThis procedure is repeated for all five test cases. The physical expectation, based on Jensen's inequality for the convex function $e^{-x}$, is that $\\Delta F \\leq 0$ for $T_{\\mathrm{sfc}} \\geq T_{\\mathrm{atm}}$, because the gray approximation tends to overestimate the atmospheric blocking of radiation, thus underestimating the OLR compared to the more realistic correlated-$k$ method. For the optically thin case ($u=0$), both models should converge to the surface emission $\\sigma T_{\\mathrm{sfc}}^4$, yielding an error $\\Delta F = 0$.\n\nThe algorithm implemented in the final answer follows these steps precisely.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the OLR error between a gray and a correlated-k radiative\n    transfer model for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (T_sfc [K], T_atm [K], u [kg/m^2])\n        (300.0, 270.0, 30.0),   # Case 1: humid Earth-like\n        (290.0, 260.0, 2.0),    # Case 2: dry atmosphere\n        (340.0, 320.0, 200.0),  # Case 3: very humid, hot exoplanet\n        (250.0, 230.0, 30.0),   # Case 4: cold, humid\n        (300.0, 270.0, 0.0),    # Case 5: optically thin limit\n    ]\n\n    # --- Model Constants and Parameters ---\n    SIGMA = 5.670374419e-8  # Stefan-Boltzmann constant (W m^-2 K^-4)\n    D = 1.66  # Diffusivity factor\n\n    # Band fractions\n    f_win = 0.3\n    f_str = 0.7\n\n    # Correlated-k quadrature weight\n    w = 0.25\n\n    # Correlated-k absorption coefficients (m^2 kg^-1)\n    k_win = np.array([1e-4, 5e-4, 2e-3, 1e-2])\n    k_str = np.array([5e-2, 2e-1, 1, 5])\n\n    # --- Pre-calculate Gray Absorption Coefficient (k_gray) ---\n    # This is constant across all test cases.\n    k_gray_win_contrib = f_win * np.sum(w * k_win)\n    k_gray_str_contrib = f_str * np.sum(w * k_str)\n    k_gray = k_gray_win_contrib + k_gray_str_contrib\n\n    results = []\n    for T_sfc, T_atm, u in test_cases:\n        # --- Pre-calculate Blackbody Fluxes for the current case ---\n        F_sfc_bb = SIGMA * T_sfc**4\n        F_atm_bb = SIGMA * T_atm**4\n\n        # --- 1. Gray Model OLR Calculation ---\n        tau_gray = k_gray * u\n        if D * tau_gray > 700: # Avoid overflow in np.exp for large optical depths\n            transmittance_gray = 0.0\n        else:\n            transmittance_gray = np.exp(-D * tau_gray)\n        \n        F_gray = F_atm_bb * (1 - transmittance_gray) + F_sfc_bb * transmittance_gray\n\n        # --- 2. Correlated-k Model OLR Calculation ---\n        F_ck = 0.0\n\n        # Contribution from the window band\n        for k_val in k_win:\n            tau_ij = k_val * u\n            if D * tau_ij > 700: # Avoid overflow\n                transmittance_ij = 0.0\n            else:\n                transmittance_ij = np.exp(-D * tau_ij)\n            \n            flux_ij = F_atm_bb * (1 - transmittance_ij) + F_sfc_bb * transmittance_ij\n            F_ck += f_win * w * flux_ij\n\n        # Contribution from the strong absorption band\n        for k_val in k_str:\n            tau_ij = k_val * u\n            if D * tau_ij > 700: # Avoid overflow\n                transmittance_ij = 0.0\n            else:\n                transmittance_ij = np.exp(-D * tau_ij)\n            \n            flux_ij = F_atm_bb * (1 - transmittance_ij) + F_sfc_bb * transmittance_ij\n            F_ck += f_str * w * flux_ij\n        \n        # --- 3. Compute Signed Error ---\n        delta_F = F_gray - F_ck\n        results.append(delta_F)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}