{
    "hands_on_practices": [
        {
            "introduction": "理解熔岩如何在行星表面流动是火山学研究的基石。这个练习将引导你从第一性原理出发，为引力驱动的牛顿流体在封闭通道（如熔岩管）中的层流建立数学模型。通过从动量平衡方程推导速度剖面并计算体积通量，你将掌握将基本物理定律应用于量化行星火山活动的关键技能 。",
            "id": "4171777",
            "problem": "一颗超级地球系外行星上的玄武岩熔岩流被理想化为一种稳态、层流、充分发展、不可压缩的牛顿流体流动，该流动在两块与水平面成 $\\,\\theta\\,$ 角的刚性平行板之间，仅由重力驱动。两平行板的间距总厚度为 $\\,2h\\,$，中间平面位于 $\\,y=0\\,$，两板位于 $\\,y=\\pm h\\,$。流动沿 $\\,x\\,$ 方向顺坡向下。沿 $\\,x\\,$ 方向没有施加压力梯度。无滑移边界条件在两板上均成立。该平板系统在 $\\,z\\,$ 方向（垂直纸面向内）的宽度为 $\\,b\\,$，且 $\\,b \\gg h\\,$，因此侧壁效应可以忽略不计。该系外行星的表面重力加速度为 $\\,g_{p}\\,$，熔岩具有恒定的密度 $\\,\\rho\\,$ 和动力粘度 $\\,\\eta\\,$。\n\n从包含重力体力的稳态、不可压缩动量平衡方程出发，推导沿下坡方向的速度剖面 $\\,u(y)\\,$。然后，通过将推导出的速度剖面在整个间隙上积分，并乘以宽度 $\\,b\\,$，求得通过通道的体积通量 $\\,Q\\,$。\n\n使用以下数值，这些数值代表了高重力岩石系外行星上浅层熔岩管中的高温玄武岩熔岩的典型值：\n$\\,\\rho = 2.90 \\times 10^{3}\\,\\mathrm{kg\\,m^{-3}}\\,$，$\\,\\eta = 3.00 \\times 10^{1}\\,\\mathrm{Pa\\,s}\\,$，$\\,g_{p} = 12.0\\,\\mathrm{m\\,s^{-2}}\\,$，$\\,\\theta = 4.00\\,\\mathrm{degrees}\\,$，$\\,h = 0.400\\,\\mathrm{m}\\,$，以及 $\\,b = 10.0\\,\\mathrm{m}\\,$。\n\n根据这些参数计算体积通量 $\\,Q\\,$ 的数值。最终答案以 $\\mathrm{m^{3}\\,s^{-1}}$ 为单位，并四舍五入至三位有效数字。仅报告 $\\,Q\\,$ 的数值作为最终答案。",
            "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 流动描述：稳态、层流、充分发展、不可压缩、牛顿流体。\n- 驱动力：仅重力。\n- 几何形状：在两个刚性平行板之间的流动。\n- 倾斜角：与水平面成 $\\theta$ 角。\n- 间隙厚度：$2h$。\n- 坐标系：中间平面位于 $y=0$，平板位于 $y=\\pm h$，流动方向为 $x$ 方向。\n- 压力条件：沿 $x$ 方向无施加的压力梯度。\n- 边界条件：在 $y=\\pm h$ 处无滑移。\n- 通道宽度：$b$，其中 $b \\gg h$（侧壁效应可忽略）。\n- 物理常数：系外行星表面重力加速度 $g_p$，熔岩密度 $\\rho$，熔岩动力粘度 $\\eta$。\n- 数值：\n  - $\\rho = 2.90 \\times 10^{3}\\,\\mathrm{kg\\,m^{-3}}$\n  - $\\eta = 3.00 \\times 10^{1}\\,\\mathrm{Pa\\,s}$\n  - $g_{p} = 12.0\\,\\mathrm{m\\,s^{-2}}$\n  - $\\theta = 4.00\\,\\mathrm{degrees}$\n  - $h = 0.400\\,\\mathrm{m}$\n  - $b = 10.0\\,\\mathrm{m}$\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题是Navier-Stokes方程在重力驱动层流中的经典应用，是流体力学中的一个标准模型。将其应用于超级地球上管状通道中的玄武岩熔岩流，是行星科学中一个科学上合理的场景。给定的物理性质对于玄武岩熔岩是符合实际的。该问题在科学上是合理的。\n- **适定性**：该问题是适定的。它提供了一个清晰的物理情景、必要的控制物理原理（动量平衡）、所有必需的参数以及明确的边界条件，从而可以得到唯一且稳定的解。\n- **客观性**：该问题使用精确、客观且无歧义的科学语言进行陈述。\n\n**步骤3：结论与行动**\n问题有效。将推导解答。\n\n出发点是不可压缩牛顿流体的稳态动量平衡方程，也称为稳态条件下的Navier-Stokes方程：\n$$ \\rho (\\mathbf{v} \\cdot \\nabla) \\mathbf{v} = -\\nabla p + \\eta \\nabla^2 \\mathbf{v} + \\mathbf{f}_b $$\n这里，$\\mathbf{v}$ 是速度矢量，$p$ 是压力，$\\rho$ 是密度，$\\eta$ 是动力粘度，$\\mathbf{f}_b$ 是单位体积的体力。\n\n我们应用问题陈述中给出的条件来简化此方程。\n1.  流动是稳态的，所以时间导数为零。\n2.  流动是充分发展的，并且沿 $x$ 轴单向。这意味着速度矢量为 $\\mathbf{v} = (u(y, z), 0, 0)$。\n3.  通道宽度 $b$ 远大于间隙 $2h$，因此我们可以忽略侧壁效应，并假设流动在 $x$-$y$ 平面内是二维的。因此，速度剖面仅取决于 $y$，所以 $\\mathbf{v} = (u(y), 0, 0)$。\n4.  不可压缩条件 $\\nabla \\cdot \\mathbf{v} = 0$ 给出 $\\frac{\\partial u}{\\partial x} = 0$，这与充分发展的流动（速度剖面不沿流动方向变化）相一致。\n5.  当 $\\mathbf{v} = (u(y), 0, 0)$ 时，平流项 $(\\mathbf{v} \\cdot \\nabla) \\mathbf{v}$ 变为 $u \\frac{\\partial u}{\\partial x}\\mathbf{i} = 0$。\n6.  粘性项简化为：$\\eta \\nabla^2 \\mathbf{v} = \\eta \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} + \\frac{\\partial^2 u}{\\partial z^2} \\right) \\mathbf{i} = \\eta \\frac{d^2 u}{dy^2} \\mathbf{i}$。\n7.  体力是重力，$\\mathbf{f}_b = \\rho \\mathbf{g}_p$。重力加速度矢量 $\\mathbf{g}_p$ 指向垂直向下。在倾斜坐标系中，它在正 $x$ 方向（下坡）的分量为 $g_p \\sin\\theta$，在 $y$ 方向的分量为 $-g_p \\cos\\theta$。因此，$\\mathbf{f}_b = (\\rho g_p \\sin\\theta, -\\rho g_p \\cos\\theta, 0)$。\n\n将这些简化项代入矢量动量方程，得到：\n$$ 0 = -\\nabla p + \\eta \\frac{d^2 u}{dy^2}\\mathbf{i} + (\\rho g_p \\sin\\theta, -\\rho g_p \\cos\\theta, 0) $$\n这个矢量方程可以分解为其标量分量：\n$x$分量: $0 = -\\frac{\\partial p}{\\partial x} + \\eta \\frac{d^2 u}{dy^2} + \\rho g_p \\sin\\theta$\n$y$分量: $0 = -\\frac{\\partial p}{\\partial y} - \\rho g_p \\cos\\theta$\n$z$分量: $0 = -\\frac{\\partial p}{\\partial z}$\n\n“沿 $x$ 方向无施加的压力梯度”的条件意味着流动完全由重力驱动。这意味着沿流动方向的压力梯度 $\\frac{\\partial p}{\\partial x}$ 为零。\n当 $\\frac{\\partial p}{\\partial x} = 0$ 时，$x$ 方向的动量方程变成一个关于 $u(y)$ 的简单常微分方程：\n$$ \\eta \\frac{d^2 u}{dy^2} + \\rho g_p \\sin\\theta = 0 $$\n$$ \\frac{d^2 u}{dy^2} = -\\frac{\\rho g_p \\sin\\theta}{\\eta} $$\n我们将此方程对 $y$ 积分两次。第一次积分得到：\n$$ \\frac{du}{dy} = -\\frac{\\rho g_p \\sin\\theta}{\\eta} y + C_1 $$\n第二次积分给出速度剖面的一般形式：\n$$ u(y) = -\\frac{\\rho g_p \\sin\\theta}{2\\eta} y^2 + C_1 y + C_2 $$\n积分常数 $C_1$ 和 $C_2$ 由边界条件确定。问题陈述了无滑移边界条件适用于位于 $y = h$ 和 $y = -h$ 的两个刚性平板。\n1.  $u(h) = 0$: $0 = -\\frac{\\rho g_p \\sin\\theta}{2\\eta} h^2 + C_1 h + C_2$\n2.  $u(-h) = 0$: $0 = -\\frac{\\rho g_p \\sin\\theta}{2\\eta} (-h)^2 - C_1 h + C_2 = -\\frac{\\rho g_p \\sin\\theta}{2\\eta} h^2 - C_1 h + C_2$\n\n用第一个方程减去第二个方程得到 $0 = 2 C_1 h$，这意味着 $C_1 = 0$。这是预料之中的，因为对称的几何形状和边界条件决定了速度剖面是对称的（偶函数）。将 $C_1 = 0$ 代入第一个方程，得到：\n$$ 0 = -\\frac{\\rho g_p \\sin\\theta}{2\\eta} h^2 + C_2 \\implies C_2 = \\frac{\\rho g_p \\sin\\theta}{2\\eta} h^2 $$\n将 $C_1$ 和 $C_2$ 代回 $u(y)$ 的表达式，我们得到速度剖面：\n$$ u(y) = -\\frac{\\rho g_p \\sin\\theta}{2\\eta} y^2 + \\frac{\\rho g_p \\sin\\theta}{2\\eta} h^2 $$\n$$ u(y) = \\frac{\\rho g_p \\sin\\theta}{2\\eta} (h^2 - y^2) $$\n这是一个抛物线形的速度剖面，其最大值位于通道中心（$y=0$）。\n\n接下来，我们计算体积通量 $Q$。它是速度剖面在通道横截面积上的积分，横截面的范围是从 $y=-h$ 到 $y=h$，宽度为 $b$。\n$$ Q = \\int_{A} u(y) dA = \\int_0^b \\int_{-h}^h u(y) dy dz = b \\int_{-h}^h u(y) dy $$\n代入推导出的 $u(y)$ 表达式：\n$$ Q = b \\int_{-h}^h \\frac{\\rho g_p \\sin\\theta}{2\\eta} (h^2 - y^2) dy $$\n我们可以将常数因子提出：\n$$ Q = \\frac{b \\rho g_p \\sin\\theta}{2\\eta} \\int_{-h}^h (h^2 - y^2) dy $$\n计算积分：\n$$ \\int_{-h}^h (h^2 - y^2) dy = \\left[ h^2y - \\frac{y^3}{3} \\right]_{-h}^h = \\left( h^3 - \\frac{h^3}{3} \\right) - \\left( -h^3 - \\frac{(-h)^3}{3} \\right) = \\left( \\frac{2}{3} h^3 \\right) - \\left( -\\frac{2}{3} h^3 \\right) = \\frac{4}{3} h^3 $$\n将此结果代回 $Q$ 的表达式：\n$$ Q = \\frac{b \\rho g_p \\sin\\theta}{2\\eta} \\left( \\frac{4}{3} h^3 \\right) = \\frac{2 b \\rho g_p h^3 \\sin\\theta}{3 \\eta} $$\n这是体积通量的解析表达式。\n\n最后，我们代入给定的数值来计算 $Q$：\n- $\\rho = 2.90 \\times 10^{3}\\,\\mathrm{kg\\,m^{-3}}$\n- $\\eta = 3.00 \\times 10^{1}\\,\\mathrm{Pa\\,s}$\n- $g_{p} = 12.0\\,\\mathrm{m\\,s^{-2}}$\n- $\\theta = 4.00\\,\\mathrm{degrees}$\n- $h = 0.400\\,\\mathrm{m}$\n- $b = 10.0\\,\\mathrm{m}$\n\n$$ Q = \\frac{2 (10.0\\,\\mathrm{m}) (2.90 \\times 10^{3}\\,\\mathrm{kg\\,m^{-3}}) (12.0\\,\\mathrm{m\\,s^{-2}}) (0.400\\,\\mathrm{m})^3 \\sin(4.00^\\circ)}{3 (3.00 \\times 10^{1}\\,\\mathrm{Pa\\,s})} $$\n角度的正弦值为 $\\sin(4.00^\\circ) \\approx 0.069756$。\n$$ Q = \\frac{2 \\times 10.0 \\times 2900 \\times 12.0 \\times (0.400)^3 \\times 0.069756}{3 \\times 30.0} \\,\\mathrm{m^3\\,s^{-1}} $$\n$$ Q = \\frac{20.0 \\times 2900 \\times 12.0 \\times 0.0640 \\times 0.069756}{90.0} \\,\\mathrm{m^3\\,s^{-1}} $$\n$$ Q = \\frac{44544 \\times 0.069756}{90.0} \\,\\mathrm{m^3\\,s^{-1}} $$\n$$ Q = \\frac{3107.249...}{90.0} \\,\\mathrm{m^3\\,s^{-1}} $$\n$$ Q = 34.5249... \\,\\mathrm{m^3\\,s^{-1}} $$\n输入值均保留三位有效数字。因此，结果必须四舍五入到三位有效数字。\n$$ Q \\approx 34.5 \\,\\mathrm{m^3\\,s^{-1}} $$",
            "answer": "$$\\boxed{34.5}$$"
        },
        {
            "introduction": "火山活动不仅创造流动的熔岩，也塑造了静态的地貌。本练习将探讨一种不同的流体行为：具有屈服强度的材料，它解释了为何某些高粘度熔岩或冰火山物质会堆积成火山穹丘。你将通过建立力学平衡，把材料的内在属性（屈服强度 $\\tau_{y}$）与可观测的宏观地貌（穹丘的最大高度）直接联系起来，从而深入理解流变学如何控制火山地貌的形成 。",
            "id": "4171779",
            "problem": "冥王星上的一个冰火山穹丘被假设由粘塑性冰质熔岩构成，其变形受材料屈服强度的控制。考虑一个沉积在水平基底上的轴对称浅穹丘，其径向自由表面厚度为 $h(r)$。假设冰质熔岩表现为屈服强度受限材料（一种塑性粘度可忽略不计的理想化宾汉塑性体），当底部剪切应力低于材料屈服强度时，它不会变形。设在浅坡度、重力驱动流下的底部剪切应力近似为上覆载荷与自由表面坡度的乘积。\n\n仅从薄的轴对称重力流在准静态条件下的深度积分力平衡和屈服准则出发，推导穹丘最大中心厚度 $H_{\\max}$ 的表达式，该表达式用材料屈服强度 $\\tau_{y}$、重力加速度 $g$、穹丘半径 $R$ 和冰质熔岩密度 $\\rho$ 表示。然后，使用以下科学上合理的冥王星特定参数计算 $H_{\\max}$：屈服强度 $\\tau_{y} = 3.0 \\times 10^{4}\\,\\mathrm{Pa}$，重力加速度 $g = 0.62\\,\\mathrm{m\\,s^{-2}}$，冰质熔岩密度 $\\rho = 920\\,\\mathrm{kg\\,m^{-3}}$，以及观测到的穹丘半径 $R = 18\\,\\mathrm{km}$。最终高度以 $\\mathrm{km}$ 为单位表示，并将答案四舍五入至四位有效数字。",
            "solution": "问题要求推导在水平基底上的一个冰火山穹丘的最大中心厚度 $H_{\\max}$，假设冰质熔岩表现为屈服强度受限材料。我们首先验证问题陈述。\n\n### 第 1 步：提取已知条件\n-   **系统**：一个轴对称的浅冰火山穹丘。\n-   **几何**：位于水平基底上，径向自由表面厚度为 $h(r)$。\n-   **材料模型**：屈服强度受限材料（塑性粘度可忽略不计的理想化宾汉塑性体）。\n-   **变形准则**：当底部剪切应力 $\\tau_b$ 低于材料屈服强度 $\\tau_y$ 时，不发生变形。\n-   **底部剪切应力近似**：$\\tau_b$ 是上覆载荷与自由表面坡度的乘积。\n-   **出发点**：薄的轴对称重力流在准静态条件下的深度积分力平衡和屈服准则。\n-   **目标 1 (推导)**：推导 $H_{\\max}$ 的表达式，用 $\\tau_{y}$、$g$、$R$ 和 $\\rho$ 表示。\n-   **目标 2 (计算)**：使用给定参数计算 $H_{\\max}$。\n-   **参数**：\n    -   屈服强度：$\\tau_{y} = 3.0 \\times 10^{4}\\,\\mathrm{Pa}$\n    -   重力加速度：$g = 0.62\\,\\mathrm{m\\,s^{-2}}$\n    -   冰质熔岩密度：$\\rho = 920\\,\\mathrm{kg\\,m^{-3}}$\n    -   穹丘半径：$R = 18\\,\\mathrm{km}$\n-   **输出格式**：最终高度以 $\\mathrm{km}$ 为单位表示，并四舍五入至四位有效数字。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题具有科学依据，采用了地球物理学和行星科学中的标准模型（用于穹丘形成的屈服强度受限流）。力平衡和材料性质的基本物理原理是合理的。问题是适定的，提供了所有必要信息（$\\tau_y, g, \\rho, R$）和明确的目标。语言客观而精确。所提供的参数对于冥王星是科学上合理的。不存在不一致、歧义或事实错误。\n\n### 第 3 步：结论与行动\n问题是**有效的**。将进行推导求解。\n\n### 推导\n我们建立一个柱坐标系 $(r, z)$，其中 $r$ 是距穹丘中心的径向距离，$z$ 是距基底的垂直高度。穹丘的表面由其厚度 $h(r)$ 描述，因此表面位于 $z=h(r)$。穹丘是轴对称的。\n\n问题陈述穹丘是“浅的”，这意味着可以使用浅坡度近似：$|\\frac{dh}{dr}| \\ll 1$。在此近似下，冰质熔岩内任意点 $(r, z)$ 的压力是静水压，由其上方物质的重量给出：\n$$ P(r, z) = \\rho g (h(r) - z) $$\n因此，驱动流动的水平压力梯度为：\n$$ \\frac{\\partial P}{\\partial r} = \\rho g \\frac{dh}{dr} $$\n注意，在此近似下，$\\frac{\\partial P}{\\partial r}$ 与深度 $z$ 无关。\n\n我们考虑在半径 $r$ 和 $r+dr$ 之间穹丘的一个薄的、垂直的环状单元上的力平衡。由压力梯度产生的水平力在该单元的体积（$dV = 2\\pi r dr h(r)$）上积分，驱动物质向外流动。这个驱动力必须与单元底部的阻滞剪切应力相平衡。\n\n作用在单元上的由压力产生的净径向力是压力梯度力在单元体积上的积分。由于压力梯度不随深度变化，这个力 $dF_p$ 是：\n$$ dF_p = \\left(-\\frac{\\partial P}{\\partial r}\\right) dV = \\left(-\\rho g \\frac{dh}{dr}\\right) (2\\pi r h(r) dr) $$\n这个向外驱动的力被作用在底部面积 $dA = 2\\pi r dr$ 上的向内作用的底部剪切力 $dF_s$ 所平衡，该剪切力由剪切应力 $\\tau_b$ 施加：\n$$ dF_s = \\tau_b dA = \\tau_b (2\\pi r dr) $$\n在准静态平衡下，这些力相互平衡：$dF_p = dF_s$。\n$$ \\left(-\\rho g \\frac{dh}{dr}\\right) (2\\pi r h(r) dr) = \\tau_b (2\\pi r dr) $$\n化简后，我们得到底部剪切应力的表达式，这与问题中描述的“上覆载荷（$\\rho g h$）乘以坡度（$-dh/dr$）”一致：\n$$ \\tau_b = -\\rho g h(r) \\frac{dh}{dr} $$\n负号表示，对于一个高度随半径减小（$dh/dr  0$）的穹丘，剪切应力 $\\tau_b$ 是正的，这符合预期。\n\n当驱动应力不再超过材料的屈服强度时，物质停止流动，穹丘达到其最终的稳定形状。在每一点，底部剪切应力必须小于或等于屈服强度。当底部剪切应力恰好等于屈服强度 $\\tau_b = \\tau_y$ 时，达到最大范围。\n$$ \\tau_y = -\\rho g h \\frac{dh}{dr} $$\n这是一个关于穹丘轮廓 $h(r)$ 的可分离常微分方程。我们可以通过积分来求解它。\n$$ \\tau_y dr = -\\rho g h dh $$\n我们将此方程从穹丘中心（$r=0$）积分到穹丘边缘（$r=R$）。相应的高度从最大中心厚度 $h(0) = H_{\\max}$ 变化到边缘厚度 $h(R) = 0$。\n$$ \\int_{0}^{R} \\tau_y dr = \\int_{H_{\\max}}^{0} -\\rho g h dh $$\n进行积分：\n$$ \\tau_y [r]_{0}^{R} = -\\rho g \\left[\\frac{h^2}{2}\\right]_{H_{\\max}}^{0} $$\n$$ \\tau_y (R - 0) = -\\rho g \\left(\\frac{0^2}{2} - \\frac{H_{\\max}^2}{2}\\right) $$\n$$ \\tau_y R = \\frac{1}{2}\\rho g H_{\\max}^2 $$\n求解最大中心厚度 $H_{\\max}$，我们得到所需的表达式：\n$$ H_{\\max}^2 = \\frac{2 \\tau_y R}{\\rho g} $$\n$$ H_{\\max} = \\sqrt{\\frac{2 \\tau_y R}{\\rho g}} $$\n\n### 计算\n给定以下参数，必须将其转换为标准国际单位制（SI）单位：\n-   $\\tau_y = 3.0 \\times 10^{4}\\,\\mathrm{Pa} = 3.0 \\times 10^{4}\\,\\mathrm{kg\\,m^{-1}\\,s^{-2}}$\n-   $R = 18\\,\\mathrm{km} = 18 \\times 10^{3}\\,\\mathrm{m}$\n-   $\\rho = 920\\,\\mathrm{kg\\,m^{-3}}$\n-   $g = 0.62\\,\\mathrm{m\\,s^{-2}}$\n\n将这些值代入推导出的 $H_{\\max}$ 表达式中：\n$$ H_{\\max} = \\sqrt{\\frac{2 \\times (3.0 \\times 10^{4}) \\times (18 \\times 10^{3})}{920 \\times 0.62}} $$\n$$ H_{\\max} = \\sqrt{\\frac{1.08 \\times 10^{9}}{570.4}}\\,\\mathrm{m} $$\n$$ H_{\\max} = \\sqrt{1893408.1346...}\\,\\mathrm{m} $$\n$$ H_{\\max} \\approx 1375.997\\,\\mathrm{m} $$\n问题要求答案以千米为单位，并四舍五入到四位有效数字。\n$$ H_{\\max} \\approx 1.375997\\,\\mathrm{km} $$\n四舍五入到四位有效数字得到：\n$$ H_{\\max} \\approx 1.376\\,\\mathrm{km} $$",
            "answer": "$$\n\\boxed{1.376}\n$$"
        },
        {
            "introduction": "我们对地外火山活动的认知在很大程度上依赖于遥感数据，但这些数据往往是复杂信号的混合。本练习将带你进入行星科学的数据分析前沿，通过一个计算任务来模拟和反演热辐射信号。你将学习如何利用普朗克定律，从一个混合了高温火山物质和低温背景的像元中，解析出活动区域的真实温度和面积分数，这是解读行星表面活动热点的核心技术 。",
            "id": "4171819",
            "problem": "你的任务是为活跃行星表面的热红外遥感建立一个基于物理的反演模型，这些行星表面可能同时存在高温火山活动和低温冰火山活动。假设这是一个无大气层的天体，并且有一个天底观测仪器，该仪器在两个不同的波长处测量光谱辐亮度。观测场景是一个由高温组分和较冷的背景组分构成的亚像元混合体。仪器记录在波长 $\\lambda_1$ 和 $\\lambda_2$ 处的光谱辐亮度，你的目标是反演出高温组分的面积分数及其温度。\n\n使用的基本原理：\n- 普朗克定律，用于计算真空中单位波长的光谱辐亮度：\n$$\nB_\\lambda(\\lambda, T) = \\frac{2 h c^2}{\\lambda^5} \\cdot \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_\\mathrm{B} T}\\right) - 1}\n$$\n其中 $h$ 是普朗克常数，$c$ 是真空光速，$k_\\mathrm{B}$ 是玻尔兹曼常数，$\\lambda$ 是波长（单位为米），$T$ 是温度（单位为开尔文）。$B_\\lambda$ 的单位是 $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$。\n- 对于未分辨的混合场景，采用辐亮度的线性面积混合模型：\n$$\nL_\\lambda(\\lambda) = f \\, B_\\lambda(\\lambda, T_\\mathrm{hot}) + (1-f) \\, B_\\lambda(\\lambda, T_\\mathrm{cool}),\n$$\n其中 $f \\in [0,1]$ 是高温组分的面积分数，$T_\\mathrm{hot}$ 是高温组分的温度，$T_\\mathrm{cool}$ 是已知的背景温度。\n\n假设：\n- 表面是发射率为 1 的灰体（黑体近似）并符合朗伯发射。\n- 仪器响应是窄带的，并且可以近似为在指定波长处的单色响应。\n- 没有太阳反射的贡献（例如，夜间观测或在所选波长处反射分量可忽略不计）。\n\n你的程序必须：\n1. 实现如上定义的 $B_\\lambda(\\lambda, T)$。\n2. 对于每个测试用例，使用混合方程从真实值 $(f_\\mathrm{true}, T_\\mathrm{hot,true}, T_\\mathrm{cool})$ 生成在 $\\lambda_1$ 和 $\\lambda_2$ 处的合成“测量”光谱辐亮度 $L_1$ 和 $L_2$，然后执行反演，从 $(L_1, L_2, \\lambda_1, \\lambda_2, T_\\mathrm{cool})$ 中恢复出 $(f, T_\\mathrm{hot})$。\n3. 将 $f$ 表示为四舍五入到六位小数的小数（无量纲），将 $T_\\mathrm{hot}$ 表示为以开尔文为单位且四舍五入到一位小数的值。\n\n使用以下国际单位制（SI）中的常数：\n- $h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J}\\,\\mathrm{s}$,\n- $c = 2.99792458 \\times 10^{8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$,\n- $k_\\mathrm{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$.\n\n波长和单位：\n- 使用 $\\lambda_1 = 3.9 \\times 10^{-6}\\,\\mathrm{m}$ 和 $\\lambda_2 = 10.5 \\times 10^{-6}\\,\\mathrm{m}$。\n- 所有光谱辐亮度必须统一以 $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$ 为单位进行处理。\n- 温度必须以开尔文为单位。\n\n测试组：\n- 用例 1（火山活动，小面积分数）：$T_\\mathrm{cool} = 300\\,\\mathrm{K}$，$f_\\mathrm{true} = 0.001$，$T_\\mathrm{hot,true} = 1100\\,\\mathrm{K}$。\n- 用例 2（冰火山活动，中等分数）：$T_\\mathrm{cool} = 70\\,\\mathrm{K}$，$f_\\mathrm{true} = 0.1$，$T_\\mathrm{hot,true} = 190\\,\\mathrm{K}$。\n- 用例 3（接近完全覆盖）：$T_\\mathrm{cool} = 500\\,\\mathrm{K}$，$f_\\mathrm{true} = 0.9$，$T_\\mathrm{hot,true} = 800\\,\\mathrm{K}$。\n- 用例 4（火山活动，极端亚像元分数）：$T_\\mathrm{cool} = 250\\,\\mathrm{K}$，$f_\\mathrm{true} = 10^{-6}$，$T_\\mathrm{hot,true} = 1300\\,\\mathrm{K}$。\n\n算法要求：\n- 完全基于给定的物理定律和线性混合模型来构建反演。不要使用任何经验性捷径或预制表的反演公式。以数学上合理的方式求解非线性系统，该方式需与物理原理以及约束条件 $f \\in [0,1]$ 和 $T_\\mathrm{hot}  T_\\mathrm{cool}$ 相符。\n\n输出规格：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内容是四个测试用例的 $(f, T_\\mathrm{hot})$ 扁平化序列，顺序与上面列出的一致。示例格式（非实际值）：“[0.001000,1100.0,0.100000,190.0,0.900000,800.0,0.000001,1300.0]”。\n\n角度单位不适用于此问题。\n\n最终答案中的所有值都必须符合指定的单位和舍入规则。",
            "solution": "必须使用普朗克定律和辐亮度的线性面积混合模型，从第一性原理推导出反演过程。仪器在两个波长 $\\lambda_1$ 和 $\\lambda_2$ 处测量光谱辐亮度。场景在波长 $\\lambda$ 处的混合辐亮度建模为\n$$\nL_\\lambda(\\lambda) = f \\, B_\\lambda(\\lambda, T_\\mathrm{hot}) + (1-f) \\, B_\\lambda(\\lambda, T_\\mathrm{cool}),\n$$\n其中 $f \\in [0,1]$，$T_\\mathrm{hot}  T_\\mathrm{cool}$，且 $B_\\lambda$ 由普朗克定律给出：\n$$\nB_\\lambda(\\lambda, T) = \\frac{2 h c^2}{\\lambda^5} \\cdot \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_\\mathrm{B} T}\\right) - 1}.\n$$\n对于两个波长 $\\lambda_1$ 和 $\\lambda_2$，将测得的光谱辐亮度分别记为 $L_1$ 和 $L_2$，并写出\n$$\n\\begin{aligned}\nL_1 = f \\, B_\\lambda(\\lambda_1, T_\\mathrm{hot}) + (1-f) \\, B_\\lambda(\\lambda_1, T_\\mathrm{cool}),\\\\\nL_2 = f \\, B_\\lambda(\\lambda_2, T_\\mathrm{hot}) + (1-f) \\, B_\\lambda(\\lambda_2, T_\\mathrm{cool}).\n\\end{aligned}\n$$\n这是一个包含两个未知数 $(f, T_\\mathrm{hot})$ 的二元方程组，因为 $T_\\mathrm{cool}$、$\\lambda_1$ 和 $\\lambda_2$ 是已知的。由于普朗克定律中的指数项，该问题对于 $T_\\mathrm{hot}$ 是非线性的，但对于 $f$ 是线性的。\n\n一种有原则的求解方法是，首先从第一个方程中解出以 $T_\\mathrm{hot}$ 表示的 $f$：\n$$\nf(T_\\mathrm{hot}) = \\frac{L_1 - B_\\lambda(\\lambda_1, T_\\mathrm{cool})}{B_\\lambda(\\lambda_1, T_\\mathrm{hot}) - B_\\lambda(\\lambda_1, T_\\mathrm{cool})}.\n$$\n将这个 $f(T_\\mathrm{hot})$ 代入第二个方程，得到一个关于 $T_\\mathrm{hot}$ 的单变量残差方程：\n$$\nR(T_\\mathrm{hot}) = f(T_\\mathrm{hot}) \\, B_\\lambda(\\lambda_2, T_\\mathrm{hot}) + \\left[1 - f(T_\\mathrm{hot})\\right] B_\\lambda(\\lambda_2, T_\\mathrm{cool}) - L_2 = 0.\n$$\n在物理约束（$T_\\mathrm{hot}  T_\\mathrm{cool}$，$f \\in [0,1]$）下，当数据 $(L_1, L_2)$ 由给定模型生成时，该残差函数有唯一的零点。唯一性可以通过定性分析来理解：对于固定的 $\\lambda$，$B_\\lambda(\\lambda, T)$ 是关于 $T$ 的严格单调递增函数，因此在给定两个不同波长且 $T_\\mathrm{hot}  T_\\mathrm{cool}$ 的情况下，从 $(f, T_\\mathrm{hot})$ 到 $(L_1, L_2)$ 的映射是单射的。具体来说，对于固定的 $T_\\mathrm{cool}$，增加 $T_\\mathrm{hot}$ 会增加每个 $\\lambda_i$ 处的 $B_\\lambda(\\lambda_i, T_\\mathrm{hot})$，而 $f$ 的线性混合保持了单调性，从而确保了在两个波长下的可识别性。\n\n算法：\n1. 使用与定义完全相同的物理常数 $h$、$c$ 和 $k_\\mathrm{B}$ 来实现 $B_\\lambda(\\lambda, T)$。\n2. 为了数值稳定性和一个好的初始猜测值，通过对普朗克定律求逆来计算一个波长（例如 $\\lambda_2$）处的亮温：\n$$\nT_b(\\lambda, L) = \\frac{h c}{\\lambda k_\\mathrm{B}} \\left[ \\ln\\left(1 + \\frac{2 h c^2}{\\lambda^5 L} \\right) \\right]^{-1},\n$$\n该亮温满足 $B_\\lambda(\\lambda, T_b) = L$。对于混合辐亮度，$T_b$ 位于 $T_\\mathrm{cool}$ 和 $T_\\mathrm{hot}$ 之间，从而提供了一个有用的初始猜测值。\n3. 使用约束非线性最小二乘法或带边界 $T_\\mathrm{hot} \\in (T_\\mathrm{cool} + \\delta, T_\\mathrm{max})$ 的求根法来求解 $R(T_\\mathrm{hot}) = 0$，其中 $\\delta  0$ 可以避免除以零，而 $T_\\mathrm{max}$ 是一个物理上合理的上界（例如，对于硅酸盐火山活动为 $2000\\,\\mathrm{K}$，这个值对于冰火山情况也足够）。\n4. 一旦求得 $T_\\mathrm{hot}$，使用上面 $f(T_\\mathrm{hot})$ 的表达式计算 $f$，并将其裁剪到区间 $[0,1]$ 内以强制施加物理边界。\n5. 按照要求，将 $f$ 四舍五入到六位小数（无量纲），将 $T_\\mathrm{hot}$ 四舍五入到一位小数（单位为开尔文）并报告。\n\n测试组覆盖范围说明：\n- 用例 1 检验一个典型的火山活动场景，其中亚像元的热熔岩（$T_\\mathrm{hot} \\approx 1100\\,\\mathrm{K}$）在温暖的背景（$300\\,\\mathrm{K}$）上占据一小部分面积（$f=10^{-3}$），这考验了在 $\\lambda_1=3.9\\,\\mu\\mathrm{m}$ 处的灵敏度。\n- 用例 2 检验冰火山活动，其中一个相对温暖的冰块（$190\\,\\mathrm{K}$）在一个非常寒冷的背景（$70\\,\\mathrm{K}$）上具有中等覆盖率（$f=0.1$），这测试了低温发射机制。\n- 用例 3 是一个接近完全覆盖的场景，其中 $f=0.9$ 且 $T_\\mathrm{hot} - T_\\mathrm{cool}$ 很小（$800\\,\\mathrm{K}$ 对比 $500\\,\\mathrm{K}$），用于检验当组分温度接近时算法的鲁棒性。\n- 用例 4 是一个极端亚像元探测（$f=10^{-6}$），对数值精度和可识别性提出了挑战，但由于 $B_\\lambda$ 在 $\\lambda_1$ 处对温度 $T$ 的强烈依赖性，该问题仍然是可解的。\n\n最终程序会根据每个用例的真实值参数生成合成辐亮度，执行物理反演以恢复 $(f, T_\\mathrm{hot})$，并输出一个包含按指定顺序和格式排列的扁平化结果列表的单行文本。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\n# Physical constants (SI units)\nh = 6.62607015e-34        # Planck constant [J s]\nc = 2.99792458e8          # Speed of light [m s^-1]\nkB = 1.380649e-23         # Boltzmann constant [J K^-1]\n\ndef planck_lambda(lam, T):\n    \"\"\"\n    Planck's law for spectral radiance per unit wavelength.\n    Parameters:\n        lam: wavelength [m]\n        T: temperature [K]\n    Returns:\n        Spectral radiance [W m^-2 sr^-1 m^-1]\n    \"\"\"\n    lam = float(lam)\n    T = float(T)\n    # Avoid division by zero or negative temperatures\n    if T = 0 or lam = 0:\n        return 0.0\n    x = (h * c) / (lam * kB * T)\n    # To avoid overflow in exp, use numpy's exp safely\n    expx = np.exp(x)\n    # Planck spectral radiance\n    return (2.0 * h * c**2) / (lam**5) * 1.0 / (expx - 1.0)\n\ndef invert_planck_lambda(lam, L):\n    \"\"\"\n    Brightness temperature inversion of Planck's law:\n    Solve for T in B_lambda(lam, T) = L.\n    Parameters:\n        lam: wavelength [m]\n        L: spectral radiance [W m^-2 sr^-1 m^-1]\n    Returns:\n        Brightness temperature [K]\n    \"\"\"\n    lam = float(lam)\n    L = float(L)\n    if L = 0 or lam = 0:\n        return 0.0\n    A = (2.0 * h * c**2) / (lam**5)\n    # Guard against numerical issues: argument to ln must be > 1\n    ratio = A / L\n    if ratio = 0:\n        return 0.0\n    denom = np.log(1.0 + ratio)\n    if denom == 0:\n        return 0.0\n    return (h * c) / (lam * kB * denom)\n\ndef retrieve_fraction_and_temperature(L1, L2, lam1, lam2, T_cool, T_max=2000.0):\n    \"\"\"\n    Retrieve hot fraction f and temperature T_hot from two-band radiances.\n    Parameters:\n        L1, L2: measured spectral radiances at lam1 and lam2 [W m^-2 sr^-1 m^-1]\n        lam1, lam2: wavelengths [m]\n        T_cool: known background temperature [K]\n        T_max: upper bound for T_hot [K]\n    Returns:\n        (f, T_hot): areal fraction (unitless), hot temperature [K]\n    \"\"\"\n    # Precompute background radiances\n    B1_c = planck_lambda(lam1, T_cool)\n    B2_c = planck_lambda(lam2, T_cool)\n\n    # Residual function in terms of T_hot only\n    def residual(T_hot_arr):\n        T_hot = float(T_hot_arr[0])\n        # Avoid denominator near zero by small offset\n        B1_h = planck_lambda(lam1, T_hot)\n        denom = (B1_h - B1_c)\n        # If denom ~ 0, set residual large to push solver away\n        if abs(denom)  1e-50:\n            return np.array([1e6])\n        f_est = (L1 - B1_c) / denom\n        # Build modeled L2 and residual\n        B2_h = planck_lambda(lam2, T_hot)\n        L2_model = f_est * B2_h + (1.0 - f_est) * B2_c\n        return np.array([L2_model - L2])\n\n    # Initial guess: brightness temperature at lam2\n    T_b2 = invert_planck_lambda(lam2, L2)\n    # Ensure initial guess above cool temperature\n    T0 = max(T_cool + 1e-6, T_b2)\n\n    # Bounds: enforce T_hot > T_cool\n    lower_bound = T_cool + 1e-6\n    upper_bound = T_max\n\n    sol = least_squares(residual, x0=np.array([T0]), bounds=(np.array([lower_bound]), np.array([upper_bound])))\n\n    T_hot = float(sol.x[0])\n\n    # Compute fraction using L1 equation\n    B1_h = planck_lambda(lam1, T_hot)\n    denom = (B1_h - B1_c)\n    if abs(denom)  1e-50:\n        f_est = 0.0\n    else:\n        f_est = (L1 - B1_c) / denom\n\n    # Clip to [0,1] for physical bounds\n    f_est = float(np.clip(f_est, 0.0, 1.0))\n\n    return f_est, T_hot\n\ndef solve():\n    # Wavelengths [m]\n    lam1 = 3.9e-6\n    lam2 = 10.5e-6\n\n    # Define test cases with ground truth (f_true, T_hot_true, T_cool)\n    test_cases = [\n        # Case 1: volcanism, small areal fraction\n        {\"T_cool\": 300.0, \"f_true\": 0.001, \"T_hot_true\": 1100.0},\n        # Case 2: cryovolcanism, moderate fraction\n        {\"T_cool\": 70.0, \"f_true\": 0.1, \"T_hot_true\": 190.0},\n        # Case 3: near-full coverage\n        {\"T_cool\": 500.0, \"f_true\": 0.9, \"T_hot_true\": 800.0},\n        # Case 4: volcanism, extreme subpixel fraction\n        {\"T_cool\": 250.0, \"f_true\": 1e-6, \"T_hot_true\": 1300.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        T_cool = case[\"T_cool\"]\n        f_true = case[\"f_true\"]\n        T_hot_true = case[\"T_hot_true\"]\n\n        # Generate synthetic measured radiances using the mixing model\n        B1_h_true = planck_lambda(lam1, T_hot_true)\n        B1_c = planck_lambda(lam1, T_cool)\n        L1 = f_true * B1_h_true + (1.0 - f_true) * B1_c\n\n        B2_h_true = planck_lambda(lam2, T_hot_true)\n        B2_c = planck_lambda(lam2, T_cool)\n        L2 = f_true * B2_h_true + (1.0 - f_true) * B2_c\n\n        # Retrieve f and T_hot from L1, L2\n        f_est, T_hot_est = retrieve_fraction_and_temperature(L1, L2, lam1, lam2, T_cool, T_max=2000.0)\n\n        # Round according to specification: f to six decimals, T to one decimal\n        f_out = f\"{round(f_est, 6):.6f}\"\n        T_out = f\"{round(T_hot_est, 1):.1f}\"\n\n        results.append(f_out)\n        results.append(T_out)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}