{
    "hands_on_practices": [
        {
            "introduction": "将行星的质量 $M_p$ 和半径 $R_p$ 等基本物理参数与可观测的光谱特征联系起来，是系外行星表征的基石。本练习将引导你从第一性原理出发，推导大气标高 $H$——一个描述大气垂直尺度的关键参数。更重要的是，通过这个实践，你将学习如何量化行星质量和半径的测量不确定性如何传播到光谱特征的振幅中，这是解释和评估观测数据可信度的核心技能。",
            "id": "4155289",
            "problem": "一个近距气态巨行星（“热木星”）被建模为一个具有平均分子质量的等温大气层，在牛顿引力作用下处于流体静力学平衡。考虑一个典型的热木星，其行星质量为 $M_{p} = 1.00\\,M_{\\mathrm{J}}$，行星半径为 $R_{p} = 1.20\\,R_{\\mathrm{J}}$，其中 $M_{\\mathrm{J}}$ 是木星质量，$R_{\\mathrm{J}}$ 是木星半径。假设大气层主要由分子氢和氦组成，使得平均分子质量为 $\\mu = 2.3\\,m_{\\mathrm{H}}$，其中 $m_{\\mathrm{H}}$ 是一个氢原子的质量。大气温度为 $T = 1500\\,\\mathrm{K}$。取木星质量为 $M_{\\mathrm{J}} = 1.89813 \\times 10^{27}\\,\\mathrm{kg}$，木星半径为 $R_{\\mathrm{J}} = 7.1492 \\times 10^{7}\\,\\mathrm{m}$，牛顿引力常数为 $G = 6.67430 \\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$，玻尔兹曼常数为 $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$，氢原子质量为 $m_{\\mathrm{H}} = 1.6735575 \\times 10^{-27}\\,\\mathrm{kg}$。主恒星的半径为 $R_{\\star} = 1.10\\,R_{\\odot}$，其中太阳半径为 $R_{\\odot} = 6.957 \\times 10^{8}\\,\\mathrm{m}$。假设在透射光谱中，一个光学厚的光谱特征使行星的有效遮蔽半径相对于局部连续谱增加了 $N$ 个大气标高，其中 $N = 5$ 被视为已知且没有不确定性。为了进行不确定性传播，假设恒星半径 $R_{\\star}$ 和 $N$ 是精确已知的。\n\n从牛顿万有引力定律、流体静力学平衡和理想气体状态方程出发，完成以下任务：\n\n- 计算行星的表面引力加速度 $g$，公式为 $g = G M_{p} / R_{p}^{2}$，并以 $\\mathrm{m\\,s^{-2}}$ 为单位报告其数值，四舍五入到四位有效数字。\n\n- 从第一性原理推导大气标高 $H$，并计算其以 $\\mathrm{km}$ 为单位的数值，四舍五入到四位有效数字。\n\n- 在 $N H \\ll R_{p}$ 的极限下，使用凌星深度的小变化近似，将透射光谱特征振幅 $\\Delta D$（谱线和连续谱凌星深度之差）用 $M_{p}$、$R_{p}$、$T$、$\\mu$、$G$、$k_{B}$、$N$ 和 $R_{\\star}$ 表示。然后，假设仅在 $M_{p}$ 和 $R_{p}$ 中存在独立的分数不确定度，分别为 $\\sigma_{M}/M_{p} = 0.05$ 和 $\\sigma_{R}/R_{p} = 0.03$，传播这些不确定度以获得分数不确定度 $\\sigma_{\\Delta D}/\\Delta D$。\n\n将分数不确定度 $\\sigma_{\\Delta D}/\\Delta D$ 的最终答案表示为一个十进制数，四舍五入到三位有效数字。不要使用百分号。所有中间推导都必须使用指定的物理定律和定义；避免使用未从这些基础推导出来的经验性“捷径”公式。",
            "solution": "问题陈述经评估具有科学依据、适定、客观且自洽。这是大气物理学和系外行星表征领域的一个有效问题。我们开始解题。\n\n该问题需要一个分为四部分的解答：计算行星表面引力 $g$，推导和计算大气标高 $H$，推导光谱特征振幅 $\\Delta D$，以及传播不确定性以求出 $\\Delta D$ 的分数不确定度。\n\n首先，我们使用所提供的数据，以国际单位制单位计算行星的质量 $M_p$ 和半径 $R_p$：\n$M_p = 1.00 \\times M_{\\mathrm{J}} = 1.00 \\times (1.89813 \\times 10^{27}\\,\\mathrm{kg}) = 1.89813 \\times 10^{27}\\,\\mathrm{kg}$。\n$R_p = 1.20 \\times R_{\\mathrm{J}} = 1.20 \\times (7.1492 \\times 10^{7}\\,\\mathrm{m}) = 8.57904 \\times 10^{7}\\,\\mathrm{m}$。\n\n表面引力加速度 $g$ 由牛顿万有引力定律给出：\n$$g = \\frac{G M_p}{R_p^2}$$\n代入引力常数 $G$、行星质量 $M_p$ 和行星半径 $R_p$ 的数值：\n$$g = \\frac{(6.67430 \\times 10^{-11}\\,\\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}) (1.89813 \\times 10^{27}\\,\\mathrm{kg})}{(8.57904 \\times 10^{7}\\,\\mathrm{m})^2}$$\n$$g \\approx 17.1950\\,\\mathrm{m\\,s^{-2}}$$\n按要求四舍五入到四位有效数字，我们得到 $g = 17.20\\,\\mathrm{m\\,s^{-2}}$。\n\n第二，我们推导大气标高 $H$。推导从流体静力学平衡方程开始，该方程平衡了作用在流体元上的压力梯度力和引力：\n$$\\frac{dP}{dz} = -\\rho g$$\n其中 $P$ 是压力，$z$ 是高度，$\\rho$ 是密度，$g$ 是引力加速度（假定在所关心的大气区域内为常数）。大气被建模为理想气体，遵循状态方程：\n$$P = \\frac{\\rho k_B T}{\\mu}$$\n其中 $k_B$ 是玻尔兹曼常数，$T$ 是温度（假定为等温），$\\mu$ 是平均分子质量。我们可以将密度 $\\rho$ 表示为：\n$$\\rho = \\frac{P \\mu}{k_B T}$$\n将这个 $\\rho$ 的表达式代入流体静力学平衡方程得到：\n$$\\frac{dP}{dz} = - \\left( \\frac{P \\mu}{k_B T} \\right) g$$\n这是一个关于压力随高度变化的函数的可分离一阶微分方程：\n$$\\frac{1}{P} dP = -\\frac{\\mu g}{k_B T} dz$$\n将此方程从参考高度 $z=0$（此处压力为 $P_0$）积分到高度 $z$（此处压力为 $P(z)$）得出：\n$$\\int_{P_0}^{P(z)} \\frac{dP'}{P'} = -\\int_0^z \\frac{\\mu g}{k_B T} dz'$$\n由于 $\\mu$、$g$、$k_B$ 和 $T$ 都被视为常数，积分变为：\n$$\\ln\\left(\\frac{P(z)}{P_0}\\right) = -\\frac{\\mu g}{k_B T} z$$\n这可以写成指数形式 $P(z) = P_0 \\exp\\left(-\\frac{\\mu g}{k_B T} z\\right)$。根据定义，压力在一个称为标高 $H$ 的特征距离上降低 $1/e$ 倍。因此，我们确定标高为：\n$$H = \\frac{k_B T}{\\mu g}$$\n为了计算 $H$ 的数值，我们首先求出平均分子质量 $\\mu$：\n$\\mu = 2.3 \\times m_{\\mathrm{H}} = 2.3 \\times (1.6735575 \\times 10^{-27}\\,\\mathrm{kg}) = 3.84918225 \\times 10^{-27}\\,\\mathrm{kg}$。\n现在，我们将 $k_B$、$T$、$\\mu$ 以及未经四舍五入的 $g$ 的值代入 $H$ 的表达式中：\n$$H = \\frac{(1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}) (1500\\,\\mathrm{K})}{(3.84918225 \\times 10^{-27}\\,\\mathrm{kg}) (17.1950\\,\\mathrm{m\\,s^{-2}})} \\approx 3.12895 \\times 10^5\\,\\mathrm{m}$$\n转换为千米并四舍五入到四位有效数字，得到 $H = 312.9\\,\\mathrm{km}$。\n\n第三，我们推导透射光谱特征振幅 $\\Delta D$。凌星深度 $D$ 是遮蔽体投影面积与恒星投影面积之比，即 $D = (R_{occ}/R_{\\star})^2$。在连续谱中，遮蔽半径是行星半径 $R_p$，所以 $D_{cont} = (R_p/R_{\\star})^2$。在一条光学厚的光谱线中，大气变得不透明，使有效遮蔽半径增加了 $N$ 个标高，变为 $R_{line} = R_p + NH$。谱线中的深度是 $D_{line} = ((R_p + NH)/R_{\\star})^2$。光谱特征振幅 $\\Delta D$ 是两者之差：\n$$\\Delta D = D_{line} - D_{cont} = \\frac{(R_p + NH)^2}{R_{\\star}^2} - \\frac{R_p^2}{R_{\\star}^2} = \\frac{(R_p^2 + 2 R_p NH + (NH)^2) - R_p^2}{R_{\\star}^2}$$\n$$\\Delta D = \\frac{2 R_p NH + (NH)^2}{R_{\\star}^2}$$\n使用小变化近似 $NH \\ll R_p$，$(NH)^2$ 项与 $2 R_p NH$ 相比可以忽略不计，所以我们有：\n$$\\Delta D \\approx \\frac{2 R_p NH}{R_{\\star}^2}$$\n现在我们代入 $H = k_B T / (\\mu g)$ 和 $g = G M_p / R_p^2$ 的表达式。首先，我们用主要参数表示 $H$：\n$$H = \\frac{k_B T}{\\mu (G M_p / R_p^2)} = \\frac{k_B T R_p^2}{G \\mu M_p}$$\n将此式代入 $\\Delta D$ 的近似表达式中：\n$$\\Delta D \\approx \\frac{2 R_p N}{R_{\\star}^2} \\left( \\frac{k_B T R_p^2}{G \\mu M_p} \\right) = \\frac{2 N k_B T R_p^3}{G \\mu M_p R_{\\star}^2}$$\n这就是用指定变量表示的 $\\Delta D$ 的期望表达式。\n\n最后，我们传播不确定度以求得分数不确定度 $\\sigma_{\\Delta D}/\\Delta D$。$\\Delta D$ 的表达式可以写成 $\\Delta D \\propto M_p^{-1} R_p^3$，因为所有其他变量（$N$、$k_B$、$T$、$G$、$\\mu$、$R_{\\star}$）都被假设没有不确定度。对于一个函数 $f(x, y) = C x^a y^b$，传播独立分数不确定度的标准公式是：\n$$\\left(\\frac{\\sigma_f}{f}\\right)^2 = \\left(a \\frac{\\sigma_x}{x}\\right)^2 + \\left(b \\frac{\\sigma_y}{y}\\right)^2$$\n对于我们的函数 $\\Delta D(M_p, R_p)$，我们有 $x = R_p$，指数 $a=3$，以及 $y=M_p$，指数 $b=-1$。因此，$\\Delta D$ 的分数不确定度由下式给出：\n$$\\left(\\frac{\\sigma_{\\Delta D}}{\\Delta D}\\right)^2 = \\left(3 \\frac{\\sigma_{R}}{R_p}\\right)^2 + \\left(-1 \\frac{\\sigma_{M}}{M_p}\\right)^2 = 9\\left(\\frac{\\sigma_{R}}{R_p}\\right)^2 + \\left(\\frac{\\sigma_{M}}{M_p}\\right)^2$$\n我们已知的分数不确定度为 $\\sigma_{M}/M_{p} = 0.05$ 和 $\\sigma_{R}/R_{p} = 0.03$。代入这些值：\n$$\\left(\\frac{\\sigma_{\\Delta D}}{\\Delta D}\\right)^2 = 9(0.03)^2 + (0.05)^2$$\n$$\\left(\\frac{\\sigma_{\\Delta D}}{\\Delta D}\\right)^2 = 9(0.0009) + 0.0025 = 0.0081 + 0.0025 = 0.0106$$\n开平方根得到分数不确定度：\n$$\\frac{\\sigma_{\\Delta D}}{\\Delta D} = \\sqrt{0.0106} \\approx 0.102956$$\n将此最终结果四舍五入到三位有效数字，我们得到 $0.103$。",
            "answer": "$$\n\\boxed{0.103}\n$$"
        },
        {
            "introduction": "天文学家主要使用两种方法来研究系外行星的大气：分析行星昼面的热辐射（发射光谱）和分析恒星光穿过行星边缘大气时的吸收（透射光谱）。这两种方法探测的是大气不同区域，对不透明度的敏感性也不同。本练习将通过计算不同观测几何构型下的光球层压力，帮助你深入理解这两种技术的根本差异，特别是当大气中存在云层时，它们如何影响我们的观测结果。",
            "id": "4155273",
            "problem": "一个潮汐锁定的热木星被建模为一个垂直方向上等温的、处于流体静力平衡的大气层，其向日侧温度为 $T = 1600\\ \\mathrm{K}$，平均分子量 $\\mu = 2.3$（以原子质量单位计），行星半径 $R_{p} = 1.2$ 木星半径（取木星半径为 $7.1492 \\times 10^{7}\\ \\mathrm{m}$），表面重力 $g = 16.0\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$。氢原子的质量为 $m_{H} = 1.673 \\times 10^{-27}\\ \\mathrm{kg}$，玻尔兹曼常数为 $k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J}\\ \\mathrm{K}^{-1}$。假设气体充分混合，其单位质量气体不透明度与波长相关，适用于两个波长 $\\lambda_{1} = 1\\ \\mu \\mathrm{m}$ 和 $\\lambda_{2} = 5\\ \\mu \\mathrm{m}$ 下的发射和透射几何结构。发射气体不透明度为 $\\kappa_{\\mathrm{gas,em}}(\\lambda_{1}) = 0.05\\ \\mathrm{m}^{2}\\ \\mathrm{kg}^{-1}$ 和 $\\kappa_{\\mathrm{gas,em}}(\\lambda_{2}) = 0.02\\ \\mathrm{m}^{2}\\ \\mathrm{kg}^{-1}$。透射气体不透明度（消光）为 $\\kappa_{\\mathrm{gas,tr}}(\\lambda_{1}) = 0.08\\ \\mathrm{m}^{2}\\ \\mathrm{kg}^{-1}$ 和 $\\kappa_{\\mathrm{gas,tr}}(\\lambda_{2}) = 0.03\\ \\mathrm{m}^{2}\\ \\mathrm{kg}^{-1}$。大气层中还包含云层，其质量不透明度遵循幂律 $\\kappa_{\\mathrm{cl}}(\\lambda) = \\kappa_{0} \\left(\\frac{\\lambda}{\\lambda_{0}}\\right)^{-\\alpha}$，其中在 $\\lambda_{0} = 1\\ \\mu \\mathrm{m}$ 处 $\\kappa_{0} = 0.20\\ \\mathrm{m}^{2}\\ \\mathrm{kg}^{-1}$ 且 $\\alpha = 2$。假设每种几何结构中的总不透明度是相应的气体不透明度和云不透明度之和，即对于发射 $\\kappa_{\\mathrm{em}}(\\lambda) = \\kappa_{\\mathrm{gas,em}}(\\lambda) + \\kappa_{\\mathrm{cl}}(\\lambda)$，对于透射 $\\kappa_{\\mathrm{tr}}(\\lambda) = \\kappa_{\\mathrm{gas,tr}}(\\lambda) + \\kappa_{\\mathrm{cl}}(\\lambda)$。\n\n仅使用基本原理，按以下步骤进行：\n\n1. 从流体静力平衡 $dP/dz = -\\rho g$ 和光学深度定义 $d\\tau = \\kappa \\rho\\, dz$ 出发，推导出发射光球压力 $P_{\\mathrm{em}}(\\lambda)$ 的表达式。在该压力下，平面平行等温大气中的垂直光学深度达到 $2/3$，且质量不透明度 $\\kappa_{\\mathrm{em}}(\\lambda)$ 为常数。\n\n2. 对于透射几何，对等温、流体静力平衡大气中沿切线高度的直线弦的倾斜光学深度进行建模。使用行星边缘的局部抛物线近似，推导倾斜光学深度作为切线压力的函数，并说明如何根据倾斜光学深度等于 $1$ 的标准来定义透射光球压力 $P_{\\mathrm{tr}}(\\lambda)$。\n\n3. 使用给定参数，数值计算大气标高 $H = \\frac{k_{B} T}{\\mu m_{H} g}$ 和几何因子 $\\sqrt{\\frac{2\\pi R_{p}}{H}}$。\n\n4. 使用以上结果，用总不透明度计算 $P_{\\mathrm{em}}(\\lambda_{1})$、 $P_{\\mathrm{em}}(\\lambda_{2})$、 $P_{\\mathrm{tr}}(\\lambda_{1})$ 和 $P_{\\mathrm{tr}}(\\lambda_{2})$。然后计算无量纲比率\n$$\n\\mathcal{R} \\equiv \\frac{P_{\\mathrm{em}}(\\lambda_{2})/P_{\\mathrm{em}}(\\lambda_{1})}{P_{\\mathrm{tr}}(\\lambda_{2})/P_{\\mathrm{tr}}(\\lambda_{1})}.\n$$\n\n将 $\\mathcal{R}$ 的最终结果表示为一个四舍五入到四位有效数字的无量纲数。最终答案中不要提供任何解释性文字。",
            "solution": "该问题要求推导发射和透射几何中光球压力的表达式，对关键大气参数进行数值评估，并计算一个特定的无量纲比率 $\\mathcal{R}$。验证过程确认了该问题在科学上是合理的、提法得当，并包含了所有必要信息。我们按照所提供的结构化步骤进行求解。\n\n**1. 发射光球压力 $P_{\\mathrm{em}}(\\lambda)$ 的推导**\n\n我们从恒定重力 $g$ 下平面平行大气的流体静力平衡方程开始：\n$$ \\frac{dP}{dz} = -\\rho g $$\n其中 $P$ 是压力，$\\rho$ 是密度，$z$ 是垂直坐标。大气被假定为理想气体，因此其状态方程为：\n$$ P = \\frac{\\rho k_B T}{\\bar{m}} $$\n其中 $k_B$ 是玻尔兹曼常数，$T$ 是温度（假定为等温），$\\bar{m}$ 是平均分子质量，由 $\\bar{m} = \\mu m_{H}$ 给出。我们可以用压力表示密度：\n$$ \\rho = \\frac{P \\bar{m}}{k_B T} $$\n将此 $\\rho$ 的表达式代入流体静力平衡方程得到：\n$$ \\frac{dP}{dz} = -P \\frac{g \\bar{m}}{k_B T} $$\n我们将大气标高 $H$ 定义为 $H = \\frac{k_B T}{g \\bar{m}}$。该方程变为：\n$$ \\frac{dP}{P} = -\\frac{1}{H} dz $$\n垂直光学深度 $\\tau$ 是从大气层顶部向下定义的。其微分形式为 $d\\tau = -\\kappa \\rho dz$，其中 $\\kappa$ 是质量不透明度。我们寻求在光学深度（从大气顶部 $P=0$ 处开始积分）达到某个特定值时的压力 $P$。我们可以使用流体静力平衡方程 $dz = -dP/(\\rho g)$ 来关联 $d\\tau$ 和 $dP$：\n$$ d\\tau = -\\kappa \\rho \\left( -\\frac{dP}{\\rho g} \\right) = \\frac{\\kappa}{g} dP $$\n从大气层顶部（$P'=0$，$\\tau'=0$）积分到一个压力为 $P$、光学深度为 $\\tau(P)$ 的层级：\n$$ \\int_0^{\\tau(P)} d\\tau' = \\int_0^P \\frac{\\kappa_{\\mathrm{em}}(\\lambda)}{g} dP' $$\n假设 $\\kappa_{\\mathrm{em}}(\\lambda)$ 和 $g$ 不随压力变化，积分得到：\n$$ \\tau(P) = \\frac{\\kappa_{\\mathrm{em}}(\\lambda) P}{g} $$\n发射光球被定义为从太空算起的垂直光学深度为 $\\tau_{\\mathrm{em}} = 2/3$ 的层级。该层级的压力是 $P_{\\mathrm{em}}(\\lambda)$：\n$$ \\frac{2}{3} = \\frac{\\kappa_{\\mathrm{em}}(\\lambda) P_{\\mathrm{em}}(\\lambda)}{g} $$\n求解 $P_{\\mathrm{em}}(\\lambda)$ 得到所需的表达式：\n$$ P_{\\mathrm{em}}(\\lambda) = \\frac{2g}{3\\kappa_{\\mathrm{em}}(\\lambda)} $$\n\n**2. 透射光球压力 $P_{\\mathrm{tr}}(\\lambda)$ 的推导**\n\n在透射几何中，我们考虑沿一条射线（弦）的倾斜光学深度 $\\tau_{\\mathrm{tr,slant}}$，该射线与一个压力为 $P_0$、半径为 $r_0 = R_p + z_0$ 的层级相切。倾斜光学深度由沿路径 $s$ 的积分给出：\n$$ \\tau_{\\mathrm{tr,slant}} = \\int_{\\text{path}} \\kappa_{\\mathrm{tr}}(\\lambda) \\rho(s) ds $$\n设 $x$ 是沿路径的坐标，切点处 $x=0$。根据勾股定理，点 $x$ 处的径向距离 $r$ 为 $r(x) = \\sqrt{r_0^2 + x^2}$。对于薄大气层，我们使用切点高度 $z_0$ 以上的高度 $z_x$ 的局部抛物线近似：\n$$ r(x) = r_0\\sqrt{1+\\frac{x^2}{r_0^2}} \\approx r_0\\left(1 + \\frac{x^2}{2r_0^2}\\right) = r_0 + \\frac{x^2}{2r_0} $$\n高度差为 $z(x)-z_0 = r(x)-r_0 \\approx \\frac{x^2}{2r_0}$。对于穿过高层大气的路径，近似 $r_0 \\approx R_p$，可得 $z(x)-z_0 \\approx \\frac{x^2}{2R_p}$。\n等温大气中的密度分布为 $\\rho(z) = \\rho_0 \\exp(-(z-z_0)/H)$，其中 $\\rho_0$ 是切点处的密度。沿路径的密度为：\n$$ \\rho(x) \\approx \\rho_0 \\exp\\left(-\\frac{x^2}{2R_p H}\\right) $$\n倾斜光学深度积分变为（近似 $ds \\approx dx$）：\n$$ \\tau_{\\mathrm{tr,slant}}(P_0) = \\int_{-\\infty}^{\\infty} \\kappa_{\\mathrm{tr}}(\\lambda) \\rho_0 \\exp\\left(-\\frac{x^2}{2R_p H}\\right) dx $$\n这是一个标准的高斯积分，形式为 $\\int_{-\\infty}^{\\infty} e^{-ax^2}dx = \\sqrt{\\pi/a}$，其中 $a = 1/(2R_p H)$。\n$$ \\tau_{\\mathrm{tr,slant}}(P_0) = \\kappa_{\\mathrm{tr}}(\\lambda) \\rho_0 \\sqrt{2\\pi R_p H} $$\n我们使用 $\\rho_0 = P_0/(gH)$ 将切点密度 $\\rho_0$ 与切线压力 $P_0$ 联系起来：\n$$ \\tau_{\\mathrm{tr,slant}}(P_0) = \\kappa_{\\mathrm{tr}}(\\lambda) \\frac{P_0}{gH} \\sqrt{2\\pi R_p H} = \\frac{\\kappa_{\\mathrm{tr}}(\\lambda) P_0}{g} \\sqrt{\\frac{2\\pi R_p}{H}} $$\n透射光球由倾斜光学深度为1的标准定义，即 $\\tau_{\\mathrm{tr,slant}} = 1$。该层级的压力是 $P_{\\mathrm{tr}}(\\lambda)$：\n$$ 1 = \\frac{\\kappa_{\\mathrm{tr}}(\\lambda) P_{\\mathrm{tr}}(\\lambda)}{g} \\sqrt{\\frac{2\\pi R_p}{H}} $$\n求解 $P_{\\mathrm{tr}}(\\lambda)$ 得到：\n$$ P_{\\mathrm{tr}}(\\lambda) = \\frac{g}{\\kappa_{\\mathrm{tr}}(\\lambda) \\sqrt{\\frac{2\\pi R_p}{H}}} $$\n\n**3. 大气参数的数值计算**\n给定参数：\n$T = 1600\\ \\mathrm{K}$, $\\mu = 2.3$, $R_{p} = 1.2 \\times (7.1492 \\times 10^{7}\\ \\mathrm{m}) = 8.57904 \\times 10^{7}\\ \\mathrm{m}$, $g = 16.0\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$, $m_{H} = 1.673 \\times 10^{-27}\\ \\mathrm{kg}$，以及 $k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J}\\ \\mathrm{K}^{-1}$。\n\n平均分子质量为 $\\bar{m} = \\mu m_H = 2.3 \\times 1.673 \\times 10^{-27}\\ \\mathrm{kg} = 3.8479 \\times 10^{-27}\\ \\mathrm{kg}$。\n大气标高 $H$ 为：\n$$ H = \\frac{k_{B} T}{\\bar{m} g} = \\frac{(1.380649 \\times 10^{-23}\\ \\mathrm{J}\\ \\mathrm{K}^{-1})(1600\\ \\mathrm{K})}{(3.8479 \\times 10^{-27}\\ \\mathrm{kg})(16.0\\ \\mathrm{m}\\ \\mathrm{s}^{-2})} \\approx 3.588 \\times 10^5\\ \\mathrm{m} $$\n几何因子 $\\sqrt{\\frac{2\\pi R_{p}}{H}}$ 为：\n$$ \\sqrt{\\frac{2\\pi R_{p}}{H}} = \\sqrt{\\frac{2\\pi (8.57904 \\times 10^{7}\\ \\mathrm{m})}{3.58826 \\times 10^5\\ \\mathrm{m}}} \\approx \\sqrt{1502.08} \\approx 38.76 $$\n\n**4. 比率 $\\mathcal{R}$ 的计算**\n首先，我们计算总不透明度。云的不透明度为 $\\kappa_{\\mathrm{cl}}(\\lambda) = \\kappa_{0} (\\lambda/\\lambda_{0})^{-\\alpha} = 0.20 (\\lambda / 1\\ \\mu\\mathrm{m})^{-2}\\ \\mathrm{m}^2\\mathrm{kg}^{-1}$。\n在 $\\lambda_1 = 1\\ \\mu\\mathrm{m}$ 处：$\\kappa_{\\mathrm{cl}}(\\lambda_1) = 0.20 \\times (1)^{-2} = 0.20\\ \\mathrm{m}^2\\mathrm{kg}^{-1}$。\n在 $\\lambda_2 = 5\\ \\mu\\mathrm{m}$ 处：$\\kappa_{\\mathrm{cl}}(\\lambda_2) = 0.20 \\times (5)^{-2} = 0.20/25 = 0.008\\ \\mathrm{m}^2\\mathrm{kg}^{-1}$。\n\n总发射不透明度：\n$\\kappa_{\\mathrm{em}}(\\lambda_1) = \\kappa_{\\mathrm{gas,em}}(\\lambda_1) + \\kappa_{\\mathrm{cl}}(\\lambda_1) = 0.05 + 0.20 = 0.25\\ \\mathrm{m}^2\\mathrm{kg}^{-1}$。\n$\\kappa_{\\mathrm{em}}(\\lambda_2) = \\kappa_{\\mathrm{gas,em}}(\\lambda_2) + \\kappa_{\\mathrm{cl}}(\\lambda_2) = 0.02 + 0.008 = 0.028\\ \\mathrm{m}^2\\mathrm{kg}^{-1}$。\n\n总透射不透明度：\n$\\kappa_{\\mathrm{tr}}(\\lambda_1) = \\kappa_{\\mathrm{gas,tr}}(\\lambda_1) + \\kappa_{\\mathrm{cl}}(\\lambda_1) = 0.08 + 0.20 = 0.28\\ \\mathrm{m}^2\\mathrm{kg}^{-1}$。\n$\\kappa_{\\mathrm{tr}}(\\lambda_2) = \\kappa_{\\mathrm{gas,tr}}(\\lambda_2) + \\kappa_{\\mathrm{cl}}(\\lambda_2) = 0.03 + 0.008 = 0.038\\ \\mathrm{m}^2\\mathrm{kg}^{-1}$。\n\n无量纲比率 $\\mathcal{R}$ 定义为：\n$$ \\mathcal{R} \\equiv \\frac{P_{\\mathrm{em}}(\\lambda_{2})/P_{\\mathrm{em}}(\\lambda_{1})}{P_{\\mathrm{tr}}(\\lambda_{2})/P_{\\mathrm{tr}}(\\lambda_{1})} $$\n让我们代入压力的表达式：\n发射压力之比为：\n$$ \\frac{P_{\\mathrm{em}}(\\lambda_{2})}{P_{\\mathrm{em}}(\\lambda_{1})} = \\frac{2g / (3\\kappa_{\\mathrm{em}}(\\lambda_2))}{2g / (3\\kappa_{\\mathrm{em}}(\\lambda_1))} = \\frac{\\kappa_{\\mathrm{em}}(\\lambda_1)}{\\kappa_{\\mathrm{em}}(\\lambda_2)} $$\n透射压力之比为：\n$$ \\frac{P_{\\mathrm{tr}}(\\lambda_{2})}{P_{\\mathrm{tr}}(\\lambda_{1})} = \\frac{g / (\\kappa_{\\mathrm{tr}}(\\lambda_2) \\sqrt{2\\pi R_p/H})}{g / (\\kappa_{\\mathrm{tr}}(\\lambda_1) \\sqrt{2\\pi R_p/H})} = \\frac{\\kappa_{\\mathrm{tr}}(\\lambda_1)}{\\kappa_{\\mathrm{tr}}(\\lambda_2)} $$\n因此，比率 $\\mathcal{R}$ 简化为不透明度比率之比：\n$$ \\mathcal{R} = \\frac{\\kappa_{\\mathrm{em}}(\\lambda_1)/\\kappa_{\\mathrm{em}}(\\lambda_2)}{\\kappa_{\\mathrm{tr}}(\\lambda_1)/\\kappa_{\\mathrm{tr}}(\\lambda_2)} = \\frac{\\kappa_{\\mathrm{em}}(\\lambda_1)\\kappa_{\\mathrm{tr}}(\\lambda_2)}{\\kappa_{\\mathrm{em}}(\\lambda_2)\\kappa_{\\mathrm{tr}}(\\lambda_1)} $$\n代入不透明度的数值：\n$$ \\mathcal{R} = \\frac{(0.25\\ \\mathrm{m}^2\\mathrm{kg}^{-1})(0.038\\ \\mathrm{m}^2\\mathrm{kg}^{-1})}{(0.028\\ \\mathrm{m}^2\\mathrm{kg}^{-1})(0.28\\ \\mathrm{m}^2\\mathrm{kg}^{-1})} = \\frac{0.0095}{0.00784} \\approx 1.21173469... $$\n四舍五入到四位有效数字，我们得到 $\\mathcal{R} = 1.212$。",
            "answer": "$$\\boxed{1.212}$$"
        },
        {
            "introduction": "超越静态的一维大气模型，理解行星的全球气候是表征工作的下一个关键步骤。对于潮汐锁定的热木星，强烈的昼侧加热与大气环流之间的平衡共同塑造了全球温度分布。本练习要求你构建一个简化的大气动力学模型，用以预测行星赤道上的温度模式。通过这个模型，你将能够解释一个关键的观测现象——热点偏移，即行星最亮点偏离正对恒星点的位置，这是探测大气风速的直接证据。",
            "id": "4155266",
            "problem": "你需要建立一个一维赤道浅水概念模型，用于模拟一颗被潮汐锁定的热木星，以预测其经向温度模式，并与相位曲线偏移和振幅等关键可观测量进行比较。目标是利用守恒原理和辐射弛豫假设，推导、实现并评估一个物理上自洽的模型，然后根据模拟的温度场计算可观测量。\n\n使用的基本原理和假设：\n- 该行星被潮汐锁定，因此星下点固定在经度 $\\lambda = 0$ 处。\n- 考虑一个代表光球层的单一浅层动力学活动层，采用浅水（SW）框架进行描述。运用质量和动量守恒概念，论证温度的稳态纬向平流平衡与辐射弛豫（牛顿冷却）之间的关系。\n- 假设存在一个沿赤道均匀的纬向风速 $u$（如果 $u > 0$ 则为东风，如果 $u < 0$ 则为西风）。\n- 向平衡温度模式 $T_{\\mathrm{eq}}(\\lambda)$ 的辐射弛豫过程由一个辐射时间尺度 $\\tau_{\\mathrm{rad}}$ 来表征。\n- 在赤道上使用正弦形式的昼夜平衡强迫，即 $T_{\\mathrm{eq}}(\\lambda) = T_0 + A \\cos \\lambda$，其中 $T_0$ 是平均温度，$A$ 是赤道上的昼夜平衡振幅；这是与昼侧（$\\lambda \\approx 0$）恒星加热固定的情况相符的标准理想化模型。\n- 对于稳态下的赤道经向温度 $T(\\lambda)$，通过平衡纬向平流与辐射弛豫，使用弧长坐标 $s = R \\lambda$（其中 $R$ 是行星半径）推导出其控制性常微分方程。你必须得到一个与 $\\lambda$ 在 $2\\pi$ 周期域内一致的周期解。\n- 为了与观测结果进行比较，通过在 $T_0$ 附近对热辐射进行线性化来近似热辐射相位曲线，并使用一个与视线角 $x \\in [-\\pi/2,\\pi/2]$ 的 $\\cos x$ 成正比的简单一维可见权重核，对可见半球上的经向亮度进行积分。具体来说，将轨道相位角 $\\psi$（以弧度为单位）处的观测通量定义为\n$$\nF(\\psi) \\propto \\int_{-\\pi/2}^{\\pi/2} T(\\psi + x)\\,\\cos x\\,dx,\n$$\n这对应于侧视几何和经度上的类朗伯条带权重。这里 $\\psi = 0$ 对应于次食（恒星-行星-观测者对齐，且昼侧面向观测者）。\n\n推导和实现要求：\n1. 从浅水框架中的质量和动量守恒出发，论证一个稳态一维赤道平衡，其中温度的纬向平流与牛顿冷却相抗衡，并推导出关于 $T(\\lambda)$ 的线性一阶常微分方程（以经度 $\\lambda$ 为变量）。\n2. 在给定 $T_{\\mathrm{eq}}(\\lambda) = T_0 + A \\cos \\lambda$ 和在 $\\lambda \\in [-\\pi,\\pi]$ 上的周期性边界条件的情况下，求解该微分方程以得到 $T(\\lambda)$。\n3. 使用推导出的 $T(\\lambda)$，计算上述定义的 $F(\\psi)$，并将其表示为一个恒定基线加上一个带相位偏移的单次谐波余弦函数。定义可观测的相位曲线偏离角 $\\varphi$（以弧度为单位），使得 $F(\\psi)$ 可以写作 $F(\\psi) = F_0 + \\mathcal{R}\\cos(\\psi - \\varphi)$，其中 $F_0$ 是平均通量，$\\mathcal{R}$ 是谐波振幅。\n4. 为了在不同案例间进行比较，报告以度为单位的相位曲线偏移和相对于平均通量的无量纲分数值振幅，即为每个测试案例输出 $\\varphi_{\\mathrm{deg}}$ 和 $\\mathcal{R}/F_0$。\n\n单位和输出要求：\n- 方程中出现的角度 $\\lambda$ 和 $\\psi$ 必须以弧度处理。最终报告的偏移必须以度为单位。\n- 温度 $T_0$ 和 $A$ 的单位是开尔文（K）。分数振幅 $\\mathcal{R}/F_0$ 是无量纲的，必须以小数形式输出（而非百分比）。\n- 最终程序必须生成单行输出，包含一个由方括号括起来的逗号分隔列表，其顺序为 $[\\varphi_{\\mathrm{deg}}^{(1)},\\mathcal{R}/F_0^{(1)},\\varphi_{\\mathrm{deg}}^{(2)},\\mathcal{R}/F_0^{(2)},\\dots]$，对应下面定义的完整测试套件。\n\n测试套件：\n为以下参数集计算输出，这些参数集测试了典型情况、辐射主导情况、平流主导情况、一个边界情况以及一个符号反转情况：\n- 案例1（典型的热木星）：$R = 9.4\\times 10^7\\,\\mathrm{m}$，$u = 2.0\\times 10^3\\,\\mathrm{m/s}$，$\\tau_{\\mathrm{rad}} = 1.5\\times 10^5\\,\\mathrm{s}$，$T_0 = 1600\\,\\mathrm{K}$，$A = 600\\,\\mathrm{K}$。\n- 案例2（辐射主导，小偏移）：$R = 9.4\\times 10^7\\,\\mathrm{m}$，$u = 2.0\\times 10^2\\,\\mathrm{m/s}$，$\\tau_{\\mathrm{rad}} = 5.0\\times 10^4\\,\\mathrm{s}$，$T_0 = 1400\\,\\mathrm{K}$，$A = 400\\,\\mathrm{K}$。\n- 案例3（平流主导，大偏移）：$R = 9.4\\times 10^7\\,\\mathrm{m}$，$u = 5.0\\times 10^3\\,\\mathrm{m/s}$，$\\tau_{\\mathrm{rad}} = 2.0\\times 10^5\\,\\mathrm{s}$，$T_0 = 1800\\,\\mathrm{K}$，$A = 300\\,\\mathrm{K}$。\n- 案例4（边界情况，无平流）：$R = 9.4\\times 10^7\\,\\mathrm{m}$，$u = 0\\,\\mathrm{m/s}$，$\\tau_{\\mathrm{rad}} = 1.0\\times 10^4\\,\\mathrm{s}$，$T_0 = 1500\\,\\mathrm{K}$，$A = 500\\,\\mathrm{K}$。\n- 案例5（西向急流）：$R = 9.4\\times 10^7\\,\\mathrm{m}$，$u = -1.0\\times 10^3\\,\\mathrm{m/s}$，$\\tau_{\\mathrm{rad}} = 1.0\\times 10^5\\,\\mathrm{s}$，$T_0 = 1700\\,\\mathrm{K}$，$A = 500\\,\\mathrm{K}$。\n\n你的程序必须实现推导出的公式来计算每个案例的 $\\varphi_{\\mathrm{deg}}$ 和 $\\mathcal{R}/F_0$，一致地处理 $u=0$ 的边界情况，并按上述确切顺序打印最终的单行方括号列表。最终代码必须完全自包含，除了嵌入在程序中的测试套件外，不需要任何输入。",
            "solution": "该问题被评估为有效。它在科学上基于行星大气动力学的既定原理，问题设定良好，具有清晰的数学结构，可导出唯一解，并且完全客观。设定是完整的、一致的，并使用了物理上合理的参数。我们继续进行推导和求解。\n\n### 第1部分：控制性常微分方程（ODE）的推导\n\n我们的任务是模拟一颗潮汐锁定的热木星在纬向平流和辐射弛豫影响下的赤道温度 $T(\\lambda)$。基本原理是稳态下流体元的热能守恒。\n\n随速度 $\\mathbf{v}$ 移动的流体元的温度变化率由物质导数给出：\n$$\n\\frac{DT}{dt} = \\frac{\\partial T}{\\partial t} + \\mathbf{v} \\cdot \\nabla T\n$$\n在此模型中，我们假设为稳态，因此时间偏导数 $\\frac{\\partial T}{\\partial t} = 0$。流动是纯纬向的（沿赤道），速度均匀为 $u$，因此 $\\mathbf{v} = u \\mathbf{\\hat{\\lambda}}$，其中 $\\mathbf{\\hat{\\lambda}}$ 是经度方向的单位矢量。在球坐标系中，沿赤道的梯度算子简化为 $\\nabla = \\frac{1}{R} \\frac{d}{d\\lambda} \\mathbf{\\hat{\\lambda}}$，其中 $R$ 是行星半径，$\\lambda$ 是经度（以弧度为单位）。\n\n因此，代表流体元移动到新位置而引起的温度变化的平流项为：\n$$\n\\mathbf{v} \\cdot \\nabla T = u \\left( \\frac{1}{R} \\frac{dT}{d\\lambda} \\right) = \\frac{u}{R} \\frac{dT}{d\\lambda}\n$$\n\n这种平流变化与辐射弛豫相平衡，辐射弛豫被建模为牛顿冷却。此过程在特征辐射时间尺度 $\\tau_{\\mathrm{rad}}$ 内，将局部温度 $T(\\lambda)$ 推向辐射平衡温度 $T_{\\mathrm{eq}}(\\lambda)$。由辐射引起的温度变化率为：\n$$\n\\left(\\frac{dT}{dt}\\right)_{\\mathrm{rad}} = -\\frac{T(\\lambda) - T_{\\mathrm{eq}}(\\lambda)}{\\tau_{\\mathrm{rad}}}\n$$\n\n在稳态下，平流冷却/加热必须与辐射加热/冷却相平衡：\n$$\n\\frac{DT}{dt} = \\frac{u}{R} \\frac{dT}{d\\lambda} = -\\frac{T(\\lambda) - T_{\\mathrm{eq}}(\\lambda)}{\\tau_{\\mathrm{rad}}}\n$$\n\n重新整理此方程，得到关于 $T(\\lambda)$ 的控制性线性一阶常微分方程：\n$$\n\\frac{u \\tau_{\\mathrm{rad}}}{R} \\frac{dT}{d\\lambda} + T(\\lambda) = T_{\\mathrm{eq}}(\\lambda)\n$$\n我们定义一个无量纲参数 $\\alpha$，它代表了行星周长上的平流输运时间尺度与辐射时间尺度之比。一个更直接的解释是，辐射时间与平流经过一个弧度所需时间之比，即 $\\tau_{\\mathrm{rad}} / (R/u)$。\n$$\n\\alpha = \\frac{u \\tau_{\\mathrm{rad}}}{R}\n$$\n于是，该常微分方程可以更紧凑地写为：\n$$\n\\alpha \\frac{dT}{d\\lambda} + T(\\lambda) = T_{\\mathrm{eq}}(\\lambda)\n$$\n\n### 第2部分：常微分方程的求解\n\n辐射平衡强迫被给定为经度的正弦函数：\n$$\nT_{\\mathrm{eq}}(\\lambda) = T_0 + A \\cos \\lambda\n$$\n其中 $T_0$ 是平均平衡温度，$A$ 是昼夜温差的振幅。将此代入常微分方程：\n$$\n\\alpha \\frac{dT}{d\\lambda} + T(\\lambda) = T_0 + A \\cos \\lambda\n$$\n我们寻求在域 $\\lambda \\in [-\\pi, \\pi]$ 上的周期解。鉴于方程的线性和正弦强迫，我们可以假设一个形式如下的解：\n$$\nT(\\lambda) = T_{\\text{mean}} + C \\cos \\lambda + D \\sin \\lambda\n$$\n其导数为 $\\frac{dT}{d\\lambda} = -C \\sin \\lambda + D \\cos \\lambda$。将解及其导数代入常微分方程：\n$$\n\\alpha(-C \\sin \\lambda + D \\cos \\lambda) + (T_{\\text{mean}} + C \\cos \\lambda + D \\sin \\lambda) = T_0 + A \\cos \\lambda\n$$\n我们根据对 $\\lambda$ 的函数依赖性收集各项：\n$$\nT_{\\text{mean}} + (C + \\alpha D)\\cos \\lambda + (D - \\alpha C)\\sin \\lambda = T_0 + A \\cos \\lambda\n$$\n为使此等式对所有 $\\lambda$ 成立，常数项、$\\cos \\lambda$ 项和 $\\sin \\lambda$ 项的系数必须在两侧匹配：\n1. 常数项：$T_{\\text{mean}} = T_0$\n2. $\\sin \\lambda$ 项：$D - \\alpha C = 0 \\implies D = \\alpha C$\n3. $\\cos \\lambda$ 项：$C + \\alpha D = A$\n\n将 $D = \\alpha C$ 代入第三个方程：\n$$\nC + \\alpha(\\alpha C) = A \\implies C(1 + \\alpha^2) = A \\implies C = \\frac{A}{1+\\alpha^2}\n$$\n因此：\n$$\nD = \\frac{\\alpha A}{1+\\alpha^2}\n$$\n温度分布的完整解为：\n$$\nT(\\lambda) = T_0 + \\left(\\frac{A}{1+\\alpha^2}\\right) \\cos \\lambda + \\left(\\frac{\\alpha A}{1+\\alpha^2}\\right) \\sin \\lambda\n$$\n该解表示一个正弦温度模式，其峰值（“热点”）相对于星下点（$\\lambda=0$）在经度上发生了偏移。东向偏移对应于 $\\alpha > 0$（东风）。\n\n### 第3部分：可观测量的推导\n\n在轨道相位角 $\\psi$ 处的观测通量 $F(\\psi)$ 由可见半球上温度的积分给出，并由 $\\cos x$ 核函数加权：\n$$\nF(\\psi) \\propto \\int_{-\\pi/2}^{\\pi/2} T(\\psi + x)\\,\\cos x\\,dx\n$$\n我们将 $T(\\lambda)$ 的解代入，其中 $\\lambda = \\psi+x$：\n$$\nT(\\psi+x) = T_0 + C \\cos(\\psi+x) + D \\sin(\\psi+x)\n$$\n积分变为：\n$$\nF(\\psi) \\propto \\int_{-\\pi/2}^{\\pi/2} [T_0 + C(\\cos\\psi\\cos x - \\sin\\psi\\sin x) + D(\\sin\\psi\\cos x + \\cos\\psi\\sin x)] \\cos x \\,dx\n$$\n我们逐项计算积分，使用标准定积分：\n- $\\int_{-\\pi/2}^{\\pi/2} \\cos x \\,dx = [\\sin x]_{-\\pi/2}^{\\pi/2} = 2$\n- $\\int_{-\\pi/2}^{\\pi/2} \\cos^2 x \\,dx = [\\frac{x}{2} + \\frac{\\sin(2x)}{4}]_{-\\pi/2}^{\\pi/2} = \\frac{\\pi}{2}$\n- $\\int_{-\\pi/2}^{\\pi/2} \\sin x \\cos x \\,dx = [\\frac{\\sin^2 x}{2}]_{-\\pi/2}^{\\pi/2} = 0$\n\n应用这些结果：\n$$\nF(\\psi) \\propto T_0(2) + C\\cos\\psi(\\frac{\\pi}{2}) - C\\sin\\psi(0) + D\\sin\\psi(\\frac{\\pi}{2}) + D\\cos\\psi(0)\n$$\n$$\nF(\\psi) \\propto 2T_0 + \\frac{\\pi}{2}(C \\cos\\psi + D \\sin\\psi)\n$$\n我们希望将其表示为 $F(\\psi) = F_0 + \\mathcal{R}\\cos(\\psi - \\varphi)$ 的形式。\n设比例常数为 $k$。则 $F(\\psi) = k [2T_0 + \\frac{\\pi}{2}(C \\cos\\psi + D \\sin\\psi)]$。\n平均通量为 $F_0 = 2kT_0$。\n可变部分为 $\\mathcal{R}\\cos(\\psi-\\varphi) = k\\frac{\\pi}{2}(C \\cos\\psi + D \\sin\\psi)$。\n为了找到 $\\varphi$ 和振幅，我们将 $C\\cos\\psi + D\\sin\\psi$ 重写为 $\\sqrt{C^2+D^2}\\cos(\\psi - \\arctan(D/C))$。\n因此，相位曲线偏移 $\\varphi$ 为：\n$$\n\\varphi = \\arctan\\left(\\frac{D}{C}\\right) = \\arctan\\left(\\frac{\\alpha A/(1+\\alpha^2)}{A/(1+\\alpha^2)}\\right) = \\arctan(\\alpha)\n$$\n可变部分的振幅为 $\\mathcal{R} = k\\frac{\\pi}{2}\\sqrt{C^2+D^2}$。\n分数振幅 $\\mathcal{R}/F_0$ 与未知的常数 $k$ 无关：\n$$\n\\frac{\\mathcal{R}}{F_0} = \\frac{k\\frac{\\pi}{2}\\sqrt{C^2+D^2}}{2kT_0} = \\frac{\\pi}{4T_0}\\sqrt{C^2+D^2}\n$$\n我们计算 $\\sqrt{C^2+D^2}$：\n$$\n\\sqrt{C^2+D^2} = \\sqrt{\\left(\\frac{A}{1+\\alpha^2}\\right)^2 + \\left(\\frac{\\alpha A}{1+\\alpha^2}\\right)^2} = \\sqrt{\\frac{A^2(1+\\alpha^2)}{(1+\\alpha^2)^2}} = \\frac{A}{\\sqrt{1+\\alpha^2}}\n$$\n将此代入分数振幅表达式，得到最终结果：\n$$\n\\frac{\\mathcal{R}}{F_0} = \\frac{\\pi A}{4 T_0 \\sqrt{1+\\alpha^2}}\n$$\n\n### 实现用公式总结\n\n对于每个具有参数 $(R, u, \\tau_{\\mathrm{rad}}, T_0, A)$ 的测试案例：\n1.  计算无量纲平流参数：\n    $$\n    \\alpha = \\frac{u \\tau_{\\mathrm{rad}}}{R}\n    $$\n2.  计算以弧度为单位的相位曲线偏移 $\\varphi$ 并将其转换为度：\n    $$\n    \\varphi_{\\mathrm{deg}} = \\arctan(\\alpha) \\times \\frac{180}{\\pi}\n    $$\n3.  计算无量纲分数振幅：\n    $$\n    \\frac{\\mathcal{R}}{F_0} = \\frac{\\pi A}{4 T_0 \\sqrt{1+\\alpha^2}}\n    $$\n这些公式对于所有实数值 $u$ 都是稳健的，包括 $u=0$（此时 $\\alpha=0$）和 $u0$（此时 $\\alpha0$）。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the phase curve offset and fractional amplitude for a simplified\n    1D model of a hot Jupiter's atmosphere.\n    \"\"\"\n    test_cases = [\n        # Case 1 (typical hot Jupiter)\n        # R (m), u (m/s), tau_rad (s), T0 (K), A (K)\n        (9.4e7, 2.0e3, 1.5e5, 1600.0, 600.0),\n        # Case 2 (radiative-dominated, small offset)\n        (9.4e7, 2.0e2, 5.0e4, 1400.0, 400.0),\n        # Case 3 (advective-dominated, large offset)\n        (9.4e7, 5.0e3, 2.0e5, 1800.0, 300.0),\n        # Case 4 (boundary, no advection)\n        (9.4e7, 0.0, 1.0e4, 1500.0, 500.0),\n        # Case 5 (westward jet)\n        (9.4e7, -1.0e3, 1.0e5, 1700.0, 500.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        R, u, tau_rad, T0, A = case\n\n        # 1. Calculate the non-dimensional advection parameter alpha.\n        # This parameter is the ratio of the radiative timescale to the\n        # advective timescale over one radian of the planet's circumference.\n        # It is well-defined even for u = 0.\n        alpha = (u * tau_rad) / R\n\n        # 2. Calculate the phase curve offset phi in degrees.\n        # The offset is the arctangent of alpha. A positive alpha (eastward wind)\n        # gives a positive (eastward) phase offset.\n        # We use np.rad2deg for conversion from radians to degrees.\n        phi_rad = np.arctan(alpha)\n        phi_deg = np.rad2deg(phi_rad)\n\n        # 3. Calculate the dimensionless fractional amplitude R/F0.\n        # This is derived from integrating the temperature profile over the\n        # visible hemisphere.\n        amplitude_denominator = np.sqrt(1 + alpha**2)\n        frac_amp = (np.pi * A) / (4 * T0 * amplitude_denominator)\n\n        results.extend([phi_deg, frac_amp])\n\n    # Format the results into a single comma-separated string enclosed in brackets.\n    # The map(str, ...) converts each numerical result to its string representation.\n    # \",\".join(...) concatenates them with commas.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}