{
    "hands_on_practices": [
        {
            "introduction": "我们的第一个实践将我们带回宜居带概念的基础。我们将使用基本的平方反比定律来计算与临界恒星通量相对应的轨道距离，这里指的是定义宜居带外缘的“最大温室效应”极限 。这项练习建立了基本的定量框架，更复杂的模型都是在此基础上建立的。",
            "id": "4182689",
            "problem": "一个广泛使用的宜居带（HZ）外缘标准由有效恒星通量阈值 $S_{\\mathrm{eff}}$ 指定，其定义为行星轨道上接收到的净恒星辐射通量与地球在1天文单位（AU）处接收到的净恒星辐射通量之无量纲比值。考虑一颗光度为 $L_{\\star}$ 的类日恒星，太阳的光度为 $L_{\\odot}$。假设恒星辐射是各向同性的，且恒星与行星之间没有中间吸收，因此在距离 $a$ 处的恒星通量遵循平方反比定律。\n\n从第一性原理出发，使用辐射通量的平方反比缩放关系和 $S_{\\mathrm{eff}}$ 的定义，推导出一个对应于给定 $S_{\\mathrm{eff}}$ 和 $L_{\\star}/L_{\\odot}$ 的轨道距离 $a$（以AU为单位）的解析表达式。然后，将你的表达式应用于一颗光度为 $L_{\\star}=L_{\\odot}$ 的类日恒星，并使用外缘阈值 $S_{\\mathrm{eff}}=0.36$ 来计算宜居带外缘距离。将你的数值答案四舍五入到三位有效数字，并以天文单位（AU）表示最终距离。简要解释在宜居带概念及其演化的背景下，计算出的距离的物理意义。",
            "solution": "该问题陈述具有科学依据、适定且客观。所有得到唯一解所需的数据和定义均已提供。所援引的物理原理——辐射通量的平方反比定律以及通过有效恒星通量定义宜居带边界——在行星科学和天体物理学中是标准的。因此，该问题是有效的，我们可以继续求解。\n\n推导从第一性原理开始，具体来说是各向同性辐射能量通量的平方反比定律。距离光度为 $L$ 的源 $r$ 处的辐射通量 $F$ 由下式给出：\n$$F = \\frac{L}{4 \\pi r^{2}}$$\n问题指明所讨论的恒星光度为 $L_{\\star}$，行星在距离为 $a$ 的轨道上绕其运行。因此，该行星接收到的通量 $F_{\\mathrm{planet}}$ 为：\n$$F_{\\mathrm{planet}} = \\frac{L_{\\star}}{4 \\pi a^{2}}$$\n问题将有效恒星通量 $S_{\\mathrm{eff}}$ 定义为 $F_{\\mathrm{planet}}$ 与地球从太阳接收到的通量之比。地球在距离太阳（光度为 $L_{\\odot}$）1天文单位（$1~\\mathrm{AU}$）的轨道上运行。地球接收到的通量 $F_{\\mathrm{Earth}}$ 为：\n$$F_{\\mathrm{Earth}} = \\frac{L_{\\odot}}{4 \\pi (1~\\mathrm{AU})^{2}}$$\n根据问题对 $S_{\\mathrm{eff}}$ 的定义：\n$$S_{\\mathrm{eff}} = \\frac{F_{\\mathrm{planet}}}{F_{\\mathrm{Earth}}}$$\n将 $F_{\\mathrm{planet}}$ 和 $F_{\\mathrm{Earth}}$ 的表达式代入此定义，得到：\n$$S_{\\mathrm{eff}} = \\frac{\\frac{L_{\\star}}{4 \\pi a^{2}}}{\\frac{L_{\\odot}}{4 \\pi (1~\\mathrm{AU})^{2}}}$$\n因子 $4 \\pi$ 被约去，我们可以重新排列表达式，将光度和距离项组合在一起：\n$$S_{\\mathrm{eff}} = \\left(\\frac{L_{\\star}}{L_{\\odot}}\\right) \\left(\\frac{(1~\\mathrm{AU})^{2}}{a^{2}}\\right) = \\left(\\frac{L_{\\star}}{L_{\\odot}}\\right) \\left(\\frac{1~\\mathrm{AU}}{a}\\right)^{2}$$\n问题要求一个以AU为单位的轨道距离 $a$ 的表达式。让我们将此量表示为 $a_{\\mathrm{AU}} = a / (1~\\mathrm{AU})$。将此代入方程，得到：\n$$S_{\\mathrm{eff}} = \\left(\\frac{L_{\\star}}{L_{\\odot}}\\right) \\frac{1}{a_{\\mathrm{AU}}^{2}}$$\n我们现在求解 $a_{\\mathrm{AU}}$，这就是所求的以AU为单位的轨道距离的解析表达式。\n$$a_{\\mathrm{AU}}^{2} = \\frac{1}{S_{\\mathrm{eff}}} \\left(\\frac{L_{\\star}}{L_{\\odot}}\\right)$$\n$$a_{\\mathrm{AU}} = \\sqrt{\\frac{L_{\\star}/L_{\\odot}}{S_{\\mathrm{eff}}}}$$\n这就是所求的以AU为单位的轨道距离 $a$ 的解析表达式。\n\n接下来，我们将此表达式应用于问题中给出的具体情况：一颗类日恒星，其光度 $L_{\\star} = L_{\\odot}$（因此光度比 $L_{\\star}/L_{\\odot} = 1$），以及宜居带外缘阈值 $S_{\\mathrm{eff}} = 0.36$。\n将这些值代入我们推导的表达式中：\n$$a_{\\mathrm{AU}} = \\sqrt{\\frac{1}{0.36}}$$\n$$a_{\\mathrm{AU}} = \\frac{1}{\\sqrt{0.36}} = \\frac{1}{0.6} = \\frac{10}{6} = \\frac{5}{3}$$\n其数值为：\n$$a_{\\mathrm{AU}} = 1.666...$$\n问题要求四舍五入到三位有效数字。\n$$a_{\\mathrm{AU}} \\approx 1.67$$\n因此，宜居带外缘距离为 $1.67~\\mathrm{AU}$。\n\n该结果的物理意义是，对于一颗与我们太阳光度相同的恒星，其宜居带的外边界大约位于地球-太阳距离的 $1.67$ 倍处。在此距离的行星仅接收到地球所接收恒星通量的 $36\\%$。这个特定的阈值 $S_{\\mathrm{eff}} = 0.36$ 对应于一维气候模型中常被称为“最大温室效应”极限的气候界限。它代表了拥有浓厚二氧化碳（$\\mathrm{CO_2}$）大气层的类地行星能够维持地表温度在水的冰点（$273.15~\\mathrm{K}$）以上的最大距离。理论上认为，超过这个距离，即使大气中充满了 $\\mathrm{CO_2}$，也无法阻止失控的冰川作用，从而使行星不适合我们所知的生命生存。这个计算代表了一个静态的一阶近似。宜居带的概念已经发展，包含了诸如恒星演化（导致宜居带在数十亿年间向外迁移）、大气成分和云、行星质量以及轨道偏心率等因素，所有这些都在这个简单的基于通量的定义之外引入了显著的复杂性。",
            "answer": "$$\n\\boxed{1.67}\n$$"
        },
        {
            "introduction": "经典的宜居带通常是为圆形轨道设想的。本实践通过探索行星的轨道偏心率如何影响其接收到的时间平均能量，来挑战这一简化假设 。通过推导平均日照量与偏心率之间的关系，我们将看到轨道动力学是评估宜居性的一个关键因素，而不仅仅是半长轴。",
            "id": "4182691",
            "problem": "考虑一颗行星沿一条半长轴为 $a$、偏心率为 $e$（其中 $0 \\le e  1$）的有界开普勒椭圆轨道，环绕一颗光度为 $L_{\\star}$、质量为 $M_{\\star}$ 的恒星运行。在任一时刻，行星接收到的入射恒星通量（日照）由平方反比定律 $S(t) = \\dfrac{L_{\\star}}{4 \\pi r(t)^{2}}$ 给出，其中 $r(t)$ 是恒星与行星之间的瞬时距离。在关于宜居带（HZ）的行星气候模型中，当气候调整时间尺度远大于轨道周期时，$S(t)$ 在整个轨道上的时间平均值是平均能量输入的关键控制参数。\n\n仅使用平方反比辐射定律、开普勒定律以及轨道根数的定义，从第一性原理推导出一个轨道周期内的平均日照 $\\overline{S}$ 的闭合形式表达式，该表达式仅用 $L_{\\star}$、$a$ 和 $e$ 表示。然后计算该平均日照与相同半长轴的圆形轨道日照 $S_{\\mathrm{circ}} = \\dfrac{L_{\\star}}{4 \\pi a^{2}}$ 的比值。\n\n以无量纲比值 $\\overline{S} / S_{\\mathrm{circ}}$ 的单个闭合形式解析表达式给出最终答案。无需进行数值计算或四舍五入。",
            "solution": "问题陈述经评估具有科学依据、提法得当、客观且内部一致。这是一个轨道力学和行星科学领域中的有效问题。\n\n目标是推导在一个完整轨道周期 $P$ 内的时间平均日照 $\\overline{S}$ 的表达式。函数 $f(t)$ 在区间 $[0, P]$ 上的时间平均值 $\\overline{f}$ 定义为：\n$$\n\\overline{f} = \\frac{1}{P} \\int_{0}^{P} f(t) \\, dt\n$$\n在本问题中，该函数是瞬时日照 $S(t)$，由平方反比定律给出：\n$$\nS(t) = \\frac{L_{\\star}}{4 \\pi r(t)^{2}}\n$$\n其中 $L_{\\star}$ 是恒定的恒星光度，$r(t)$ 是恒星与行星之间的瞬时距离。\n\n将 $S(t)$ 的表达式代入时间平均的定义中，我们得到：\n$$\n\\overline{S} = \\frac{1}{P} \\int_{0}^{P} \\frac{L_{\\star}}{4 \\pi r(t)^{2}} \\, dt = \\frac{L_{\\star}}{4 \\pi P} \\int_{0}^{P} \\frac{1}{r(t)^{2}} \\, dt\n$$\n积分 $\\int \\frac{dt}{r(t)^2}$ 并不容易对时间 $t$ 进行计算，因为 $r(t)$ 是一个复杂的函数。一个更有效的方法是将积分变量从时间 $t$ 更换为真近点角 $\\theta$。这个变换可以借助开普勒第二行星运动定律来完成，该定律指出比角动量 $h$ 是一个运动常量。比角动量的大小是矢径 $\\vec{r}$ 扫过面积的速率的两倍：\n$$\nh = |\\vec{r} \\times \\frac{d\\vec{r}}{dt}| = r^{2} \\frac{d\\theta}{dt}\n$$\n由此，我们可以用真近点角微元 $d\\theta$ 来表示时间微元 $dt$：\n$$\ndt = \\frac{r^{2}}{h} d\\theta\n$$\n现在我们可以将此代入 $\\overline{S}$ 的积分中。当时间 $t$ 从 $0$ 增加到整个周期 $P$ 时，真近点角 $\\theta$ 扫过从 $0$ 到 $2\\pi$ 的完整角度。积分上下限也相应改变。\n$$\n\\int_{0}^{P} \\frac{1}{r(t)^{2}} \\, dt = \\int_{0}^{2\\pi} \\frac{1}{r(\\theta)^{2}} \\left( \\frac{r(\\theta)^{2}}{h} d\\theta \\right) = \\int_{0}^{2\\pi} \\frac{1}{h} d\\theta\n$$\n由于 $h$ 是一个常数，该积分的计算结果为：\n$$\n\\int_{0}^{2\\pi} \\frac{1}{h} d\\theta = \\frac{1}{h} [\\theta]_{0}^{2\\pi} = \\frac{2\\pi}{h}\n$$\n将此结果代回 $\\overline{S}$ 的表达式中：\n$$\n\\overline{S} = \\frac{L_{\\star}}{4 \\pi P} \\left( \\frac{2\\pi}{h} \\right) = \\frac{L_{\\star}}{2 P h}\n$$\n为了用轨道根数 $a$（半长轴）和 $e$（偏心率）来表示 $\\overline{S}$，我们必须将 $P$ 和 $h$ 与这些参数联系起来。开普勒第二定律还意味着，椭圆的总面积 $A$ 是在一个周期 $P$ 内以 $\\frac{h}{2}$ 的恒定速率扫过的。因此：\n$$\nP = \\frac{A}{h/2} = \\frac{2A}{h}\n$$\n椭圆的面积由 $A = \\pi a b$ 给出，其中 $b$ 是半短轴。半短轴通过 $b = a\\sqrt{1-e^{2}}$ 与半长轴和偏心率相关。\n将 $A = \\pi a^{2} \\sqrt{1-e^{2}}$ 代入周期的表达式中，得到：\n$$\nP = \\frac{2 \\pi a^{2} \\sqrt{1-e^{2}}}{h}\n$$\n现在我们可以将这个 $P$ 的表达式代回我们关于 $\\overline{S}$ 的方程中：\n$$\n\\overline{S} = \\frac{L_{\\star}}{2 h} \\frac{1}{P} = \\frac{L_{\\star}}{2 h} \\left( \\frac{h}{2 \\pi a^{2} \\sqrt{1-e^{2}}} \\right) = \\frac{L_{\\star}}{4 \\pi a^{2} \\sqrt{1-e^{2}}}\n$$\n这就是用 $L_{\\star}$、$a$ 和 $e$ 表示的时间平均日照的闭合形式表达式。问题提到给出了恒星质量 $M_{\\star}$，但如此推导所示，最终表达式并不需要它。\n\n最后一步是计算该平均日照 $\\overline{S}$ 与半径为 $a$ 的圆形轨道的日照 $S_{\\mathrm{circ}} = \\frac{L_{\\star}}{4 \\pi a^{2}}$ 的比值。\n该比值为：\n$$\n\\frac{\\overline{S}}{S_{\\mathrm{circ}}} = \\frac{\\frac{L_{\\star}}{4 \\pi a^{2} \\sqrt{1-e^{2}}}}{\\frac{L_{\\star}}{4 \\pi a^{2}}}\n$$\n$L_{\\star}$、$4$、$\\pi$ 和 $a^{2}$ 项相互抵消，留下一个仅与偏心率 $e$ 相关的简单表达式：\n$$\n\\frac{\\overline{S}}{S_{\\mathrm{circ}}} = \\frac{1}{\\sqrt{1-e^{2}}}\n$$\n这个结果表明，对于固定的半长轴 $a$，偏心轨道上的行星接收到的时间平均能量通量比圆形轨道上的行星更大。",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{1-e^{2}}}}\n$$"
        },
        {
            "introduction": "即使一颗行星最终位于宜居带内，其宜居性也并非必然，它的历史至关重要。这个高级实践模拟了一个关键过程：由年轻恒星（特别是低质量的M型矮星）的强烈辐射驱动的大气逃逸 。通过建立一个数值模型来追踪行星随时间的水分流失，我们将直接接触到现代、动态的宜居性观点，即行星的最终状态是其与主星共同演化的产物。",
            "id": "4182664",
            "problem": "考虑一颗地球大小或亚地球大小的行星，在其主序前阶段围绕一颗低质量恒星运行。早期的极紫外（XUV）辐射可以驱动由水光解产生的氢的流体动力学逃逸，这可能在恒星到达主序且经典宜居带建立之前使行星完全干涸。从能量守恒和牛顿引力出发，构建一个物理上自洽的能量限制逃逸模型。在该模型中，XUV光球层吸收的功率与入射的极紫外通量、吸收面积和一个效率因子成正比；而将单位质量从行星引力势阱中提升所需的比能量成本由行星的质量和半径以及一个潮汐修正因子决定。通过大气中受扩散限制的向上通量来为质量损失率设置上限，从而引入供应侧的限制。然后，假设光解产生的氢会逃逸而氧气不限制供应，通过对氢逃逸随时间积分来量化累积的水损失量。使用水中氢的化学计量质量分数，将逃逸的氢质量转换为等效的水质量损失。\n\n您的程序必须实现以下功能：\n\n- 将行星轨道处、主序前时间间隔内时间 $t$ 的入射极紫外通量历史 $F_{\\mathrm{XUV}}(t)$ 定义为一个分段函数，包括一个饱和阶段和一个随后的幂律衰减阶段：\n  1. 对于 $t \\le t_{\\mathrm{sat}}$，设置 $F_{\\mathrm{XUV}}(t) = F_{\\mathrm{sat}}$。\n  2. 对于 $t  t_{\\mathrm{sat}}$，设置 $F_{\\mathrm{XUV}}(t) = F_{\\mathrm{sat}}\\left(\\frac{t}{t_{\\mathrm{sat}}}\\right)^{-\\beta}$。\n- 使用以下基于物理的原理推导氢的能量限制质量损失率：\n  1. XUV光球层吸收的功率与入射通量 $F_{\\mathrm{XUV}}(t)$ 乘以与XUV吸收半径 $R_{\\mathrm{XUV}}$ 相关的有效吸收面积成正比，并由效率因子 $\\eta$ 进行缩放。\n  2. 逃逸所需的单位质量引力结合能与 $\\frac{G M_{p}}{R_{p} K_{\\mathrm{tide}}}$ 成正比，其中 $G$ 是引力常数，$M_{p}$ 是行星质量，$R_{p}$ 是行星半径，$K_{\\mathrm{tide}}$ 是一个无量纲的洛希潮汐修正因子。\n  3. 通过将可用于逃逸的吸收功率与将氢从引力势中提升出来所需的功的速率相等，得出能量限制的逃逸率。\n- 通过指定单位面积的向上氢质量通量 $\\Phi_{\\mathrm{diff}}$，并使用与 $R_{\\mathrm{XUV}}$ 相关的适当球体表面积将其转换为总质量损失率，来施加扩散限制的上限。实际的瞬时氢质量损失率是能量限制率和扩散限制上限中的较小值。\n- 通过在区间 $t\\in[0, t_{\\mathrm{end}}]$ 上对瞬时质量损失率进行积分，计算累积的逃逸氢质量，其中 $t=0$ 表示主序前时期的开始。使用水中的氢质量分数\n  $$f_{H}=\\frac{2 m_{H}}{2 m_{H}+m_{O}},$$\n  将累积的逃逸氢质量转换为等效的水质量损失，其中 $m_{H}$ 是一个氢原子的质量，$m_{O}$ 是一个氧原子的质量。以初始海洋存量为上限来限制等效水质量损失。报告是否在 $t_{\\mathrm{end}}$ 之前发生完全干涸（损失全部初始存量），如果发生，报告干涸时间。\n- 单位与数值约定：\n  1. 在问题规范中，使用兆年（Myr）作为 $t$ 的单位；在内部积分时将其转换为秒。一个儒略年为 $365.25$ 天。\n  2. 使用瓦特每平方米（$\\mathrm{W}\\,\\mathrm{m}^{-2}$）作为 $F_{\\mathrm{XUV}}$ 的单位，千克（$\\mathrm{kg}$）作为 $M_{p}$ 的单位，米（$\\mathrm{m}$）作为 $R_{p}$ 和 $R_{\\mathrm{XUV}}$ 的单位，千克每平方米每秒（$\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$）作为 $\\Phi_{\\mathrm{diff}}$ 的单位。\n  3. 使用 $G = 6.67430\\times 10^{-11}\\ \\mathrm{m}^{3}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-2}$，$m_{H} = 1.6735575\\times 10^{-27}\\ \\mathrm{kg}$，以及 $m_{O} = 2.6566962\\times 10^{-26}\\ \\mathrm{kg}$。\n  4. 将最终的干涸时间以兆年（Myr）表示，初始海洋质量损失的分数表示为无单位小数。将该分数四舍五入到 $6$ 位小数，干涸时间四舍五入到 $2$ 位小数。\n- 输出规范：\n  1. 对于每个测试用例，计算一个包含三个值的列表：损失的初始海洋存量的分数（无单位小数），一个布尔值指示是否在 $t_{\\mathrm{end}}$ 之前发生完全干涸（真用 $1$，假用 $0$），以及如果发生干涸，则为干涸时间（单位：兆年，Myr），否则为 $-1.0$。\n  2. 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试结果本身就是一个列表。例如，输出格式为：$[\\,[f_{1},b_{1},\\tau_{1}],\\,[f_{2},b_{2},\\tau_{2}],\\,[f_{3},b_{3},\\tau_{3}]\\,]$。\n\n测试套件（请精确提供这些参数集）：\n\n- 测试用例 1（理想路径，能量限制主导）：\n  - 行星：$M_{p} = 5.972\\times 10^{24}\\ \\mathrm{kg}$，$R_{p} = 6.371\\times 10^{6}\\ \\mathrm{m}$，$R_{\\mathrm{XUV}} = 1.1\\,R_{p}$，$K_{\\mathrm{tide}} = 1.0$，$\\eta = 0.15$。\n  - 初始海洋存量：$M_{\\mathrm{ocean},0} = 1.4\\times 10^{21}\\ \\mathrm{kg}$。\n  - 通量历史：$F_{\\mathrm{sat}} = 100\\ \\mathrm{W}\\,\\mathrm{m}^{-2}$，$t_{\\mathrm{sat}} = 500\\ \\mathrm{Myr}$，$\\beta = 1.2$，$t_{\\mathrm{end}} = 1000\\ \\mathrm{Myr}$。\n  - 扩散限制上限：$\\Phi_{\\mathrm{diff}} = 1.0\\times 10^{-5}\\ \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n\n- 测试用例 2（扩散限制边界情况，亚地球）：\n  - 行星：$M_{p} = 0.6\\times 5.972\\times 10^{24}\\ \\mathrm{kg}$，$R_{p} = 0.6\\times 6.371\\times 10^{6}\\ \\mathrm{m}$，$R_{\\mathrm{XUV}} = 1.2\\,R_{p}$，$K_{\\mathrm{tide}} = 1.0$，$\\eta = 0.30$。\n  - 初始海洋存量：$M_{\\mathrm{ocean},0} = 2.8\\times 10^{21}\\ \\mathrm{kg}$。\n  - 通量历史：$F_{\\mathrm{sat}} = 300\\ \\mathrm{W}\\,\\mathrm{m}^{-2}$，$t_{\\mathrm{sat}} = 1000\\ \\mathrm{Myr}$，$\\beta = 1.0$，$t_{\\mathrm{end}} = 2000\\ \\mathrm{Myr}$。\n  - 扩散限制上限：$\\Phi_{\\mathrm{diff}} = 3.0\\times 10^{-10}\\ \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n\n- 测试用例 3（冷阱边界，部分损失）：\n  - 行星：$M_{p} = 1.0\\times 5.972\\times 10^{24}\\ \\mathrm{kg}$，$R_{p} = 1.0\\times 6.371\\times 10^{6}\\ \\mathrm{m}$，$R_{\\mathrm{XUV}} = 1.0\\,R_{p}$，$K_{\\mathrm{tide}} = 1.0$，$\\eta = 0.05$。\n  - 初始海洋存量：$M_{\\mathrm{ocean},0} = 7.0\\times 10^{19}\\ \\mathrm{kg}$。\n  - 通量历史：$F_{\\mathrm{sat}} = 5\\ \\mathrm{W}\\,\\mathrm{m}^{-2}$，$t_{\\mathrm{sat}} = 50\\ \\mathrm{Myr}$，$\\beta = 1.5$，$t_{\\mathrm{end}} = 100\\ \\mathrm{Myr}$。\n  - 扩散限制上限：$\\Phi_{\\mathrm{diff}} = 1.0\\times 10^{-12}\\ \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n\n您的实现必须以秒为单位对时间进行数值积分，处理 $F_{\\mathrm{XUV}}(t)$ 的分段性质和最小速率上限，并为每个测试用例计算所要求的输出。最终打印的输出必须是与上述描述完全一致的列表的列表格式的单行文本。",
            "solution": "我们从能量守恒原理和牛顿引力出发。能量限制的流体动力学逃逸模型假设，沉积在上层大气中的入射极紫外功率的一部分被转化为机械功，以将气体从行星的引力势中提升出去。沉积功率与入射极紫外通量 $F_{\\mathrm{XUV}}(t)$ 成正比，乘以由XUV吸收半径 $R_{\\mathrm{XUV}}$ 决定的有效吸收面积，并由一个效率因子 $\\eta$ 进行缩放，该因子代表用于逃逸而非辐射冷却和其他损失的吸收能量的分数。逃逸所需的单位质量引力结合能由行星半径处的经典牛顿引力的单位质量势能确定，并由一个因子 $K_{\\mathrm{tide}}$ 进行修正，以解释洛希瓣附近降低的势垒。\n\n在时间 $t$ 可用于逃逸的吸收功率，记为 $P_{\\mathrm{abs}}(t)$，是\n$$\nP_{\\mathrm{abs}}(t) = \\eta\\,A_{\\mathrm{abs}}\\,F_{\\mathrm{XUV}}(t),\n$$\n其中 $A_{\\mathrm{abs}}$ 是一个有效吸收面积。对于球对称行星和准直通量，几何拦截面积与圆盘面积成正比，$A_{\\mathrm{abs}}=\\pi R_{\\mathrm{XUV}}^{2}$。将单位质量提升至逃逸所需的比能是引力势差除以洛希潮汐修正，\n$$\n\\Phi = \\frac{G M_{p}}{R_{p} K_{\\mathrm{tide}}}.\n$$\n将能量输入率与提升逃逸质量 $\\dot{M}(t)$ 所需的机械功的速率相等，得到能量限制的质量损失率，\n$$\n\\dot{M}_{\\mathrm{EL}}(t) = \\frac{P_{\\mathrm{abs}}(t)}{\\Phi} = \\eta\\,\\pi R_{\\mathrm{XUV}}^{2}\\,F_{\\mathrm{XUV}}(t)\\,\\frac{R_{p} K_{\\mathrm{tide}}}{G M_{p}}.\n$$\n该表达式在行星逃逸研究中被广泛使用，并直接源于基本原理。在许多应用中，XUV吸收半径的量级可以与行星半径相当或稍大；我们将其明确表示为 $R_{\\mathrm{XUV}}$。\n\n然而，向上层大气供应氢可能受到通过背景大气扩散的限制。一个扩散限制的单位面积氢质量通量，记为 $\\Phi_{\\mathrm{diff}}$，为向上通量设定了一个上限。相应的总质量损失上限通过乘以球形逃逸表面积得到，\n$$\n\\dot{M}_{\\mathrm{diff}} = 4\\pi R_{\\mathrm{XUV}}^{2}\\,\\Phi_{\\mathrm{diff}}.\n$$\n在时间 $t$ 物理上实现的氢质量损失率是能量限制率和扩散上限中的较小值：\n$$\n\\dot{M}_{H}(t) = \\min\\left(\\dot{M}_{\\mathrm{EL}}(t),\\,\\dot{M}_{\\mathrm{diff}}\\right).\n$$\n\n为了将逃逸的氢质量与水损失联系起来，考虑水分子 $\\mathrm{H_{2}O}$ 的化学计量关系。水中的氢质量分数为\n$$\nf_{H} = \\frac{2 m_{H}}{2 m_{H} + m_{O}},\n$$\n其中 $m_{H} = 1.6735575\\times 10^{-27}\\ \\mathrm{kg}$ 且 $m_{O} = 2.6566962\\times 10^{-26}\\ \\mathrm{kg}$。如果质量为 $\\Delta M_{H}$ 的氢逃逸，则来自光解的等效水质量为 $\\Delta M_{\\mathrm{H_{2}O}} = \\Delta M_{H}/f_{H}$。我们以初始海洋存量 $M_{\\mathrm{ocean},0}$ 作为累积水质量损失的上限。\n\n恒星在其主序前阶段，行星轨道处的极紫外通量历史模型化为：\n$$\nF_{\\mathrm{XUV}}(t) =\n\\begin{cases}\nF_{\\mathrm{sat}},  t \\le t_{\\mathrm{sat}},\\\\\nF_{\\mathrm{sat}}\\,\\left(\\dfrac{t}{t_{\\mathrm{sat}}}\\right)^{-\\beta},  t  t_{\\mathrm{sat}},\n\\end{cases}\n$$\n其中 $F_{\\mathrm{sat}}$ 的单位是 $\\mathrm{W}\\,\\mathrm{m}^{-2}$，$t$ 的单位是兆年（Myr）。我们将时间转换为秒进行积分，使用一个儒略年等于 $365.25$ 天，因此一兆年是 $10^{6}$ 年。\n\n到时间 $t$（秒）为止累积的逃逸氢质量为\n$$\nM_{H}(t) = \\int_{0}^{t} \\dot{M}_{H}(t')\\,dt'.\n$$\n累积的等效水质量损失为 $M_{\\mathrm{H_{2}O}}(t) = \\min\\left(\\dfrac{M_{H}(t)}{f_{H}},\\,M_{\\mathrm{ocean},0}\\right)$。完全干涸（损失全部初始海洋质量）发生在第一个满足 $M_{H}(t) = f_{H}\\,M_{\\mathrm{ocean},0}$ 的时间 $t$；如果在 $t_{\\mathrm{end}}$ 之前不存在这样的时间，则行星在建模区间内未完全干涸。\n\n算法设计：\n\n- 对于每个测试用例，解析参数：$M_{p}$、$R_{p}$、$R_{\\mathrm{XUV}}$、$K_{\\mathrm{tide}}$、$\\eta$、$M_{\\mathrm{ocean},0}$、$F_{\\mathrm{sat}}$、$t_{\\mathrm{sat}}$ (Myr)、$\\beta$、$t_{\\mathrm{end}}$ (Myr) 和 $\\Phi_{\\mathrm{diff}}$。\n- 通过使用 $1$ 年 $= 365.25$ 天将兆年转换为秒，将 $F_{\\mathrm{XUV}}(t)$ 实现为一个以秒为单位的分段函数。\n- 使用能量限制表达式计算 $\\dot{M}_{\\mathrm{EL}}(t)$，使用扩散上限计算 $\\dot{M}_{\\mathrm{diff}}$。取最小值得到 $\\dot{M}_{H}(t)$。\n- 使用稳健的求积法将 $\\dot{M}_{H}(t)$ 从 $t=0$ 积分到 $t=t_{\\mathrm{end}}$，以获得 $M_{H}(t_{\\mathrm{end}})$，然后获得 $M_{\\mathrm{H_{2}O}}(t_{\\mathrm{end}})$。计算损失的分数 $f_{\\mathrm{loss}} = M_{\\mathrm{H_{2}O}}(t_{\\mathrm{end}})/M_{\\mathrm{ocean},0}$。\n- 通过将 $M_{H}(t_{\\mathrm{end}})$ 与 $f_{H}\\,M_{\\mathrm{ocean},0}$ 进行比较来确定是否发生干涸。如果发生干涸，则使用区间求根法求解 $g(t) = M_{H}(t) - f_{H}\\,M_{\\mathrm{ocean},0}$ 的根来找到干涸时间；将其转换为兆年并进行适当的四舍五入。\n- 为三个测试用例准备列表的列表形式的输出：$[\\,[f_{\\mathrm{loss}}, b, \\tau_{\\mathrm{desic}}], \\ldots]$，其中如果发生干涸，$b$ 为 $1$，否则为 $0$，$\\tau_{\\mathrm{desic}}$ 是以兆年为单位的干涸时间，如果未发生干涸则为 $-1.0$。\n\n科学真实性及与宜居带概念的联系：低质量恒星表现出延长的、具有增强XUV通量的主序前阶段。宜居带由允许表面液态水存在的恒星通量范围定义，随着恒星收缩及其全波段光度的变化而演化。由XUV驱动的流体动力学逃逸可以从那些未来将位于经典宜居带内的行星上移除大量水，从而有效地改变它们的潜在宜居性。上述模型量化了累积的水损失，并评估了在宜居带稳定之前是否发生干涸，从而将大气逃逸物理学与宜居性的时间演化相结合。\n\n使用分段通量历史、带扩散上限的能量限制逃逸和稳健积分的数值方法，确保覆盖了能量限制逃逸占主导、扩散供应限制逃逸以及冷阱导致氢供应可忽略不计等情况。因此，该测试套件探究了一个典型的主序前M型矮星情景、一个亚地球的扩散限制边界情况以及一个部分损失的边界情况。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, optimize\n\n# Physical constants\nG = 6.67430e-11  # m^3 kg^-1 s^-2\nm_H = 1.6735575e-27  # kg\nm_O = 2.6566962e-26  # kg\n\n# Time conversions\nseconds_per_year = 365.25 * 24 * 3600.0\nseconds_per_Myr = 1.0e6 * seconds_per_year\n\n# Hydrogen mass fraction in water\nf_H = (2.0 * m_H) / (2.0 * m_H + m_O)\n\ndef F_XUV_piecewise(t_sec, F_sat, t_sat_Myr, beta):\n    \"\"\"\n    Piecewise XUV flux history.\n    t_sec: time in seconds\n    Returns flux in W/m^2\n    \"\"\"\n    t_sat_sec = t_sat_Myr * seconds_per_Myr\n    if t_sec = t_sat_sec:\n        return F_sat\n    else:\n        return F_sat * (t_sec / t_sat_sec) ** (-beta)\n\ndef energy_limited_rate(F, eta, R_xuv, R_p, K_tide, M_p):\n    \"\"\"\n    Energy-limited hydrogen mass loss rate in kg/s.\n    Derived from power balance and gravitational binding energy per unit mass.\n    \"\"\"\n    # Absorbing area: pi R_xuv^2\n    # Specific energy to escape: G M_p / (R_p K_tide)\n    # Rate = eta * (pi R_xuv^2) * F / (G M_p / (R_p K_tide))\n    return eta * np.pi * (R_xuv**2) * F * (R_p * K_tide) / (G * M_p)\n\ndef diffusion_cap_rate(Phi_diff, R_xuv):\n    \"\"\"\n    Diffusion-limited cap on the total hydrogen mass loss rate in kg/s.\n    \"\"\"\n    return 4.0 * np.pi * (R_xuv**2) * Phi_diff\n\ndef dM_H_dt(t_sec, params):\n    \"\"\"\n    Instantaneous hydrogen mass loss rate (kg/s) at time t_sec (seconds),\n    taking the minimum of energy-limited rate and diffusion cap.\n    \"\"\"\n    F = F_XUV_piecewise(t_sec, params['F_sat'], params['t_sat_Myr'], params['beta'])\n    rate_el = energy_limited_rate(F, params['eta'], params['R_xuv'], params['R_p'], params['K_tide'], params['M_p'])\n    rate_diff = params['rate_diff_cap']\n    return min(rate_el, rate_diff)\n\ndef cumulative_H_loss(t_sec, params):\n    \"\"\"\n    Cumulative escaped hydrogen mass up to time t_sec (seconds), in kg.\n    Integrates dM_H_dt from 0 to t_sec using quadrature.\n    \"\"\"\n    # Use adaptive quadrature; integrand is smooth piecewise.\n    result, _ = integrate.quad(lambda tt: dM_H_dt(tt, params), 0.0, t_sec, epsabs=1e-8, epsrel=1e-7, limit=200)\n    return result\n\ndef solve_case(case):\n    \"\"\"\n    Solve one test case; return [fraction_lost, desiccated_boolean, t_desic_Myr (or -1.0)]\n    \"\"\"\n    # Unpack parameters\n    M_p = case['M_p']\n    R_p = case['R_p']\n    R_xuv = case['R_xuv']\n    K_tide = case['K_tide']\n    eta = case['eta']\n    M_ocean0 = case['M_ocean0']\n    F_sat = case['F_sat']\n    t_sat_Myr = case['t_sat_Myr']\n    beta = case['beta']\n    t_end_Myr = case['t_end_Myr']\n    Phi_diff = case['Phi_diff']\n\n    params = {\n        'M_p': M_p,\n        'R_p': R_p,\n        'R_xuv': R_xuv,\n        'K_tide': K_tide,\n        'eta': eta,\n        'F_sat': F_sat,\n        't_sat_Myr': t_sat_Myr,\n        'beta': beta,\n        'rate_diff_cap': diffusion_cap_rate(Phi_diff, R_xuv),\n    }\n\n    t_end_sec = t_end_Myr * seconds_per_Myr\n\n    # Total escaped hydrogen over interval\n    M_H_lost = cumulative_H_loss(t_end_sec, params)\n\n    # Convert to equivalent water loss, capped by initial inventory\n    M_H2O_lost = min(M_H_lost / f_H, M_ocean0)\n    fraction_lost = M_H2O_lost / M_ocean0\n\n    # Determine desiccation (full loss) time if occurs\n    H_required = f_H * M_ocean0\n    desiccated = 1 if M_H_lost >= H_required else 0\n\n    if desiccated == 1:\n        # Find root of cumulative_H_loss(t) - H_required = 0 on [0, t_end_sec]\n        # Ensure monotonicity and bracket\n        def g(t):\n            return cumulative_H_loss(t, params) - H_required\n\n        # Brent's method requires bracket where g has opposite signs\n        # g(0) = -H_required  0; g(t_end_sec) >= 0\n        t_desic_sec = optimize.brentq(g, 0.0, t_end_sec, xtol=1e-10, rtol=1e-10, maxiter=200)\n        t_desic_Myr = t_desic_sec / seconds_per_Myr\n    else:\n        t_desic_Myr = -1.0\n\n    # Round per specification\n    fraction_lost_out = float(f\"{fraction_lost:.6f}\")\n    t_desic_out = float(f\"{t_desic_Myr:.2f}\")\n\n    return [fraction_lost_out, desiccated, t_desic_out]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            # Test case 1\n            'M_p': 5.972e24,\n            'R_p': 6.371e6,\n            'R_xuv': 1.1 * 6.371e6,\n            'K_tide': 1.0,\n            'eta': 0.15,\n            'M_ocean0': 1.4e21,\n            'F_sat': 100.0,\n            't_sat_Myr': 500.0,\n            'beta': 1.2,\n            't_end_Myr': 1000.0,\n            'Phi_diff': 1.0e-5\n        },\n        {\n            # Test case 2\n            'M_p': 0.6 * 5.972e24,\n            'R_p': 0.6 * 6.371e6,\n            'R_xuv': 1.2 * (0.6 * 6.371e6),\n            'K_tide': 1.0,\n            'eta': 0.30,\n            'M_ocean0': 2.8e21,\n            'F_sat': 300.0,\n            't_sat_Myr': 1000.0,\n            'beta': 1.0,\n            't_end_Myr': 2000.0,\n            'Phi_diff': 3.0e-10\n        },\n        {\n            # Test case 3\n            'M_p': 1.0 * 5.972e24,\n            'R_p': 1.0 * 6.371e6,\n            'R_xuv': 1.0 * (1.0 * 6.371e6),\n            'K_tide': 1.0,\n            'eta': 0.05,\n            'M_ocean0': 7.0e19,\n            'F_sat': 5.0,\n            't_sat_Myr': 50.0,\n            'beta': 1.5,\n            't_end_Myr': 100.0,\n            'Phi_diff': 1.0e-12\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_case(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Ensure plain Python list formatting with no extra text.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}