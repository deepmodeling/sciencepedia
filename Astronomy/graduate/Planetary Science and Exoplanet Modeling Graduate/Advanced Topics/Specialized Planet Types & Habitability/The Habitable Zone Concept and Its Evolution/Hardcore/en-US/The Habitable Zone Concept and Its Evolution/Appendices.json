{
    "hands_on_practices": [
        {
            "introduction": "The concept of the Habitable Zone (HZ) begins with a simple question: at what distance from a star can a planet maintain liquid water on its surface? This foundational exercise provides the tools to answer the \"too hot\" part of that question. By applying the inverse-square law for radiation, you will calculate the inner edge of the classical HZ for a Sun-like star, defined by a critical stellar flux threshold derived from one-dimensional climate models . Mastering this calculation is the first step toward understanding how stellar and planetary properties together define the boundaries of potential habitability.",
            "id": "4182684",
            "problem": "A core tool in modeling the Habitable Zone (HZ) is the effective incident stellar flux, denoted by $S$, defined as the ratio of the top-of-atmosphere stellar flux received by a planet to that received by Earth at $1\\,\\mathrm{AU}$ from the present Sun. The inner edge of the HZ for a given stellar spectral energy distribution is commonly approximated by a threshold $S_{\\mathrm{eff}}$ corresponding to the onset of a moist greenhouse state in one-dimensional radiative-convective climate models. \n\nConsider a Sun-like main-sequence star with luminosity $L_{\\star}$ equal to the present solar luminosity $L_{\\odot}$. Using the inverse-square law for radiation and the definition of $S$, determine the orbital distance $a$ (in astronomical units) at which a planet receives an effective flux equal to the moist greenhouse threshold $S_{\\mathrm{eff}}=1.01$ appropriate for a Sun-like spectral energy distribution. Express the final orbital distance in astronomical units (AU), and round your answer to four significant figures.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n**Step 1: Extract Givens**\n-   The effective incident stellar flux is denoted by the symbol $S$.\n-   The definition provided for $S$ is \"the ratio of the top-of-atmosphere stellar flux received by a planet to that received by Earth at $1\\,\\mathrm{AU}$ from the present Sun.\"\n-   The star in question is a \"Sun-like main-sequence star\" with luminosity $L_{\\star}$ equal to the present solar luminosity, $L_{\\odot}$. Thus, $L_{\\star} = L_{\\odot}$.\n-   The planet is at an orbital distance $a$.\n-   The effective flux received is specified as the moist greenhouse threshold, $S_{\\mathrm{eff}} = 1.01$.\n-   The objective is to determine the orbital distance $a$ in astronomical units (AU).\n-   The final numerical result must be rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically sound. It employs the inverse-square law for radiation and the standard definition of effective stellar flux used in planetary and exoplanetary science. The concept of a moist greenhouse anoxic limit for the inner edge of the habitable zone is a cornerstone of modern climate modeling for exoplanets, with the value $S_{\\mathrm{eff}} = 1.01$ being a representative value from published one-dimensional models for a G-type star. The problem is well-posed, as all necessary physical quantities and relationships are either provided or are fundamental principles (like the inverse-square law). The language is objective and free of ambiguity. The problem is therefore deemed valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid and a formal solution can be constructed.\n\nThe flux of electromagnetic radiation, $F$, from an isotropically radiating source with luminosity $L_{\\star}$ at an orbital distance $a$ is described by the inverse-square law:\n$$F(a) = \\frac{L_{\\star}}{4\\pi a^2}$$\nThis equation gives the energy per unit time per unit area at the top of a planet's atmosphere.\n\nThe problem defines the effective incident stellar flux, $S$, as the ratio of the flux received by the planet, $F_{\\mathrm{planet}}$, to the reference flux received by Earth from the Sun, $F_{\\oplus}$:\n$$S = \\frac{F_{\\mathrm{planet}}}{F_{\\oplus}}$$\n\nThe flux received by the planet orbiting its star at a distance $a$ is:\n$$F_{\\mathrm{planet}} = \\frac{L_{\\star}}{4\\pi a^2}$$\n\nThe reference flux, $F_{\\oplus}$, is the flux at Earth's orbital distance, $a_{\\oplus} = 1\\,\\mathrm{AU}$, from the Sun, which has luminosity $L_{\\odot}$.\n$$F_{\\oplus} = \\frac{L_{\\odot}}{4\\pi a_{\\oplus}^2}$$\n\nSubstituting these flux expressions into the definition of $S$:\n$$S = \\frac{\\frac{L_{\\star}}{4\\pi a^2}}{\\frac{L_{\\odot}}{4\\pi a_{\\oplus}^2}}$$\nThe term $4\\pi$ cancels out, leading to:\n$$S = \\left(\\frac{L_{\\star}}{L_{\\odot}}\\right) \\left(\\frac{a_{\\oplus}}{a}\\right)^2$$\n\nAccording to the problem statement, the star is Sun-like, which is specified as $L_{\\star} = L_{\\odot}$. Therefore, the luminosity ratio is unity:\n$$\\frac{L_{\\star}}{L_{\\odot}} = 1$$\nThe expression for $S$ simplifies to:\n$$S = \\left(\\frac{a_{\\oplus}}{a}\\right)^2$$\n\nWe are tasked with finding the distance $a$ at which the planet receives an effective flux equal to the moist greenhouse threshold, $S = S_{\\mathrm{eff}} = 1.01$. We are also given that the Earth's orbital distance is the definition of the astronomical unit, $a_{\\oplus} = 1\\,\\mathrm{AU}$. We substitute these values into the simplified equation:\n$$1.01 = \\left(\\frac{1\\,\\mathrm{AU}}{a}\\right)^2$$\n\nTo solve for $a$, we first rearrange the equation:\n$$a^2 = \\frac{(1\\,\\mathrm{AU})^2}{1.01}$$\nTaking the square root of both sides yields the orbital distance $a$. Since distance must be a positive quantity, we consider only the positive root:\n$$a = \\sqrt{\\frac{(1\\,\\mathrm{AU})^2}{1.01}} = \\frac{1\\,\\mathrm{AU}}{\\sqrt{1.01}}$$\n\nThe result for $a$ will be in astronomical units. We now compute the numerical value:\n$$a = \\frac{1}{\\sqrt{1.01}} \\,\\mathrm{AU} \\approx \\frac{1}{1.00498756} \\,\\mathrm{AU}$$\n$$a \\approx 0.99503719 \\,\\mathrm{AU}$$\n\nThe problem requires the final answer to be rounded to four significant figures.\n$$a \\approx 0.9950 \\,\\mathrm{AU}$$\nThis result is physically consistent; to intercept a slightly higher flux ($S > 1$), the planet must orbit slightly closer to its star than Earth does ($a < 1\\,\\mathrm{AU}$).",
            "answer": "$$\\boxed{0.9950}$$"
        },
        {
            "introduction": "Our initial definition of the Habitable Zone often relies on the simplification of a circular orbit, yet most planets follow elliptical paths. This practice explores the crucial consequences of orbital eccentricity, $e$, on the time-averaged energy a planet receives over its year . By deriving the relationship between mean insolation and eccentricity from first principles, you will uncover a key insight for refining HZ boundaries: for the same semi-major axis, an eccentric orbit results in a higher average stellar flux than a circular one.",
            "id": "4182691",
            "problem": "Consider a planet orbiting a star of luminosity $L_{\\star}$ and mass $M_{\\star}$ on a bound Keplerian ellipse with semi-major axis $a$ and eccentricity $e$, where $0 \\le e < 1$. The incident stellar flux (insolation) at the planet at any instant is given by the inverse-square law $S(t) = \\dfrac{L_{\\star}}{4 \\pi r(t)^{2}}$, where $r(t)$ is the instantaneous star–planet separation. In planetary climate modeling for the Habitable Zone (HZ), when the climate adjustment timescale is long compared to the orbital period, a time average of $S(t)$ over the orbit is the relevant control parameter for the mean energy input.\n\nUsing only the inverse-square radiation law, Kepler’s laws, and the definition of the orbital elements, derive from first principles a closed-form expression for the time-averaged insolation over one orbital period, $\\overline{S}$, expressed in terms of $L_{\\star}$, $a$, and $e$ only. Then compute the ratio of this mean insolation to that of a circular orbit at the same semi-major axis, $S_{\\mathrm{circ}} = \\dfrac{L_{\\star}}{4 \\pi a^{2}}$.\n\nProvide your final answer as a single closed-form analytic expression for the dimensionless ratio $\\overline{S} / S_{\\mathrm{circ}}$. No numerical evaluation or rounding is required.",
            "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and internally consistent. It is a valid problem in orbital mechanics and planetary science.\n\nThe objective is to derive an expression for the time-averaged insolation, $\\overline{S}$, over one full orbital period, $P$. The time average of a function $f(t)$ over an interval $[0, P]$ is defined as:\n$$\n\\overline{f} = \\frac{1}{P} \\int_{0}^{P} f(t) \\, dt\n$$\nIn this problem, the function is the instantaneous insolation $S(t)$, which is given by the inverse-square law:\n$$\nS(t) = \\frac{L_{\\star}}{4 \\pi r(t)^{2}}\n$$\nwhere $L_{\\star}$ is the constant stellar luminosity and $r(t)$ is the instantaneous distance between the star and the planet.\n\nSubstituting the expression for $S(t)$ into the definition of the time average, we get:\n$$\n\\overline{S} = \\frac{1}{P} \\int_{0}^{P} \\frac{L_{\\star}}{4 \\pi r(t)^{2}} \\, dt = \\frac{L_{\\star}}{4 \\pi P} \\int_{0}^{P} \\frac{1}{r(t)^{2}} \\, dt\n$$\nThe integral $\\int \\frac{dt}{r(t)^2}$ is not straightforward to evaluate with respect to time, $t$, because $r(t)$ is a complex function. A more effective approach is to change the variable of integration from time $t$ to the true anomaly $\\theta$. This tranformation is facilitated by Kepler's second law of planetary motion, which states that the specific angular momentum, $h$, is a constant of motion. The magnitude of the specific angular momentum is twice the rate at which area is swept by the radius vector $\\vec{r}$:\n$$\nh = |\\vec{r} \\times \\frac{d\\vec{r}}{dt}| = r^{2} \\frac{d\\theta}{dt}\n$$\nFrom this, we can express the differential element of time $dt$ in terms of the differential element of the true anomaly $d\\theta$:\n$$\ndt = \\frac{r^{2}}{h} d\\theta\n$$\nWe can now substitute this into the integral for $\\overline{S}$. As time $t$ progresses from $0$ to the full period $P$, the true anomaly $\\theta$ sweeps through a full angle from $0$ to $2\\pi$. The limits of integration change accordingly.\n$$\n\\int_{0}^{P} \\frac{1}{r(t)^{2}} \\, dt = \\int_{0}^{2\\pi} \\frac{1}{r(\\theta)^{2}} \\left( \\frac{r(\\theta)^{2}}{h} d\\theta \\right) = \\int_{0}^{2\\pi} \\frac{1}{h} d\\theta\n$$\nSince $h$ is a constant, the integral evaluates to:\n$$\n\\int_{0}^{2\\pi} \\frac{1}{h} d\\theta = \\frac{1}{h} [\\theta]_{0}^{2\\pi} = \\frac{2\\pi}{h}\n$$\nSubstituting this result back into the expression for $\\overline{S}$:\n$$\n\\overline{S} = \\frac{L_{\\star}}{4 \\pi P} \\left( \\frac{2\\pi}{h} \\right) = \\frac{L_{\\star}}{2 P h}\n$$\nTo express $\\overline{S}$ in terms of the orbital elements $a$ (semi-major axis) and $e$ (eccentricity), we must relate $P$ and $h$ to these parameters. Kepler's second law also implies that the total area of the ellipse, $A$, is swept out over one period $P$ at a constant rate of $\\frac{h}{2}$. Therefore:\n$$\nP = \\frac{A}{h/2} = \\frac{2A}{h}\n$$\nThe area of an ellipse is given by $A = \\pi a b$, where $b$ is the semi-minor axis. The semi-minor axis is related to the semi-major axis and eccentricity by $b = a\\sqrt{1-e^{2}}$.\nSubstituting $A = \\pi a^{2} \\sqrt{1-e^{2}}$ into the expression for the period gives:\n$$\nP = \\frac{2 \\pi a^{2} \\sqrt{1-e^{2}}}{h}\n$$\nNow we can substitute this expression for $P$ back into our equation for $\\overline{S}$:\n$$\n\\overline{S} = \\frac{L_{\\star}}{2 h} \\frac{1}{P} = \\frac{L_{\\star}}{2 h} \\left( \\frac{h}{2 \\pi a^{2} \\sqrt{1-e^{2}}} \\right) = \\frac{L_{\\star}}{4 \\pi a^{2} \\sqrt{1-e^{2}}}\n$$\nThis is the closed-form expression for the time-averaged insolation in terms of $L_{\\star}$, $a$, and $e$. The problem notes that the stellar mass $M_{\\star}$ is given, but as shown by this derivation, it is not required for the final expression.\n\nThe final step is to compute the ratio of this mean insolation $\\overline{S}$ to the insolation for a circular orbit of radius $a$, which is given as $S_{\\mathrm{circ}} = \\frac{L_{\\star}}{4 \\pi a^{2}}$.\nThe ratio is:\n$$\n\\frac{\\overlineS}{S_{\\mathrm{circ}}} = \\frac{\\frac{L_{\\star}}{4 \\pi a^{2} \\sqrt{1-e^{2}}}}{\\frac{L_{\\star}}{4 \\pi a^{2}}}\n$$\nThe terms $L_{\\star}$, $4$, $\\pi$, and $a^{2}$ cancel out, leaving a simple expression dependent only on the eccentricity $e$:\n$$\n\\frac{\\overline{S}}{S_{\\mathrm{circ}}} = \\frac{1}{\\sqrt{1-e^{2}}}\n$$\nThis result demonstrates that for a fixed semi-major axis $a$, a planet on an eccentric orbit receives a greater time-averaged energy flux than a planet on a circular orbit.",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{1-e^{2}}}}\n$$"
        },
        {
            "introduction": "The modern Habitable Zone concept has evolved from a static snapshot in space to a dynamic story unfolding over billions of years, where a planet's history is as important as its current location. This advanced practice challenges you to build a numerical model that simulates a critical early chapter in this story: the potential desiccation of a planet by its host star's intense youthful radiation . By integrating atmospheric escape physics with stellar evolution models, you will directly engage with the cutting-edge research that asks not just where a habitable planet might be, but what it has endured to remain so.",
            "id": "4182664",
            "problem": "Consider an Earth-sized or sub-Earth-sized planet orbiting a low-mass star in its pre-main-sequence phase. Early-time extreme-ultraviolet (XUV) irradiation can power hydrodynamic escape of hydrogen produced by photodissociation of water, potentially desiccating the planet before the star reaches the main sequence and the classical habitable zone is established. Starting from conservation of energy and Newtonian gravity, construct a physically consistent model for energy-limited escape in which the power absorbed at the XUV photosphere is proportional to the incident extreme-ultraviolet flux, the absorbing area, and an efficiency factor, and the specific energy cost to lift a unit mass from the planet’s gravitational potential well is set by the planet’s mass and radius with a correction factor for tides. Include a supply-side limitation by capping the mass loss rate by a diffusion-limited upward flux through the atmosphere. Then, integrate the hydrogen escape over time to quantify the cumulative water loss, assuming that photodissociation yields hydrogen that escapes while oxygen does not limit the supply. Use the stoichiometric hydrogen mass fraction in water to convert escaped hydrogen mass to equivalent water mass loss.\n\nYour program must implement the following:\n\n- Define the incident extreme-ultraviolet flux history $F_{\\mathrm{XUV}}(t)$ at the planet’s orbit, for time $t$ during the pre-main-sequence interval, as a piecewise function with a saturated phase followed by a power-law decay:\n  1. For $t \\le t_{\\mathrm{sat}}$, set $F_{\\mathrm{XUV}}(t) = F_{\\mathrm{sat}}$.\n  2. For $t > t_{\\mathrm{sat}}$, set $F_{\\mathrm{XUV}}(t) = F_{\\mathrm{sat}}\\left(\\frac{t}{t_{\\mathrm{sat}}}\\right)^{-\\beta}$.\n- Derive an energy-limited mass loss rate for hydrogen using the following physically grounded principles:\n  1. The absorbed power at the XUV photosphere is proportional to the incident flux $F_{\\mathrm{XUV}}(t)$ times an effective absorbing area tied to an XUV absorption radius $R_{\\mathrm{XUV}}$, scaled by an efficiency factor $\\eta$.\n  2. The gravitational binding energy per unit mass required to escape is proportional to $\\frac{G M_{p}}{R_{p} K_{\\mathrm{tide}}}$, where $G$ is the gravitational constant, $M_{p}$ is the planet mass, $R_{p}$ is the planet radius, and $K_{\\mathrm{tide}}$ is a dimensionless Roche-tide correction factor.\n  3. The energy-limited escape rate emerges by equating absorbed power available to escape with the rate of work needed to lift hydrogen out of the gravitational potential.\n- Apply a diffusion-limited cap by specifying an upward hydrogen mass flux per unit area, $\\Phi_{\\mathrm{diff}}$, and converting it into a total mass loss rate using the appropriate spherical surface area associated with $R_{\\mathrm{XUV}}$. The actual instantaneous hydrogen mass loss rate is the minimum of the energy-limited rate and the diffusion-limited cap.\n- Compute the cumulative escaped hydrogen mass by integrating the instantaneous mass loss rate over the interval $t\\in[0, t_{\\mathrm{end}}]$, with $t=0$ indicating the start of the pre-main-sequence epoch. Convert the cumulative escaped hydrogen mass to an equivalent water mass loss using the hydrogen mass fraction in water,\n  $f_{H}=\\frac{2 m_{H}}{2 m_{H}+m_{O}}$,\n  where $m_{H}$ is the mass of a hydrogen atom and $m_{O}$ is the mass of an oxygen atom. Cap the equivalent water mass loss by the initial ocean inventory. Report whether complete desiccation (loss of the entire initial inventory) occurs before $t_{\\mathrm{end}}$, and if so, the desiccation time.\n- Units and numerical conventions:\n  1. Use $t$ in megayears (Myr) in the problem specification; convert to seconds internally for integration. One Julian year is $365.25$ days.\n  2. Use $F_{\\mathrm{XUV}}$ in watts per square meter ($\\mathrm{W}\\,\\mathrm{m}^{-2}$), $M_{p}$ in kilograms ($\\mathrm{kg}$), $R_{p}$ and $R_{\\mathrm{XUV}}$ in meters ($\\mathrm{m}$), and $\\Phi_{\\mathrm{diff}}$ in kilograms per square meter per second ($\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$).\n  3. Use $G = 6.67430 \\times 10^{-11} \\ \\text{m}^3 \\text{kg}^{-1} \\text{s}^{-2}$, $m_{H} = 1.6735575 \\times 10^{-27} \\ \\text{kg}$, and $m_{O} = 2.6566962 \\times 10^{-26} \\ \\text{kg}$.\n  4. Express the final desiccation time in megayears (Myr) and the fraction of initial ocean mass lost as a unitless decimal. Round the fraction to $6$ decimal places and the desiccation time to $2$ decimal places.\n- Output specification:\n  1. For each test case, compute a list of three values: the fraction of the initial ocean inventory lost (unitless decimal), a boolean indicating whether full desiccation occurred before $t_{\\mathrm{end}}$ (use $1$ for true and $0$ for false), and the desiccation time in megayears (Myr) if desiccation occurred, or $-1.0$ otherwise.\n  2. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For example, output format: `[[f_1, b_1, tau_1], [f_2, b_2, tau_2], [f_3, b_3, tau_3]]`.\n\nTest suite (provide these parameter sets exactly):\n\n- Test case $1$ (happy path, energy-limited dominates):\n  - Planet: $M_{p} = 5.972 \\times 10^{24} \\ \\text{kg}$, $R_{p} = 6.371 \\times 10^{6} \\ \\text{m}$, $R_{\\mathrm{XUV}} = 1.1 R_{p}$, $K_{\\mathrm{tide}} = 1.0$, $\\eta = 0.15$.\n  - Initial ocean inventory: $M_{\\mathrm{ocean},0} = 1.4 \\times 10^{21} \\ \\text{kg}$.\n  - Flux history: $F_{\\mathrm{sat}} = 100 \\ \\text{W m}^{-2}$, $t_{\\mathrm{sat}} = 500 \\ \\text{Myr}$, $\\beta = 1.2$, $t_{\\mathrm{end}} = 1000 \\ \\text{Myr}$.\n  - Diffusion-limited cap: $\\Phi_{\\mathrm{diff}} = 1.0 \\times 10^{-5} \\ \\text{kg m}^{-2} \\text{s}^{-1}$.\n\n- Test case $2$ (diffusion-limited edge case, sub-Earth):\n  - Planet: $M_{p} = 0.6 \\times 5.972 \\times 10^{24} \\ \\text{kg}$, $R_{p} = 0.6 \\times 6.371 \\times 10^{6} \\ \\text{m}$, $R_{\\mathrm{XUV}} = 1.2 R_{p}$, $K_{\\mathrm{tide}} = 1.0$, $\\eta = 0.30$.\n  - Initial ocean inventory: $M_{\\mathrm{ocean},0} = 2.8 \\times 10^{21} \\ \\text{kg}$.\n  - Flux history: $F_{\\mathrm{sat}} = 300 \\ \\text{W m}^{-2}$, $t_{\\mathrm{sat}} = 1000 \\ \\text{Myr}$, $\\beta = 1.0$, $t_{\\mathrm{end}} = 2000 \\ \\text{Myr}$.\n  - Diffusion-limited cap: $\\Phi_{\\mathrm{diff}} = 3.0 \\times 10^{-10} \\ \\text{kg m}^{-2} \\text{s}^{-1}$.\n\n- Test case $3$ (cold-trapped boundary, partial loss):\n  - Planet: $M_{p} = 1.0 \\times 5.972 \\times 10^{24} \\ \\text{kg}$, $R_{p} = 1.0 \\times 6.371 \\times 10^{6} \\ \\text{m}$, $R_{\\mathrm{XUV}} = 1.0 R_{p}$, $K_{\\mathrm{tide}} = 1.0$, $\\eta = 0.05$.\n  - Initial ocean inventory: $M_{\\mathrm{ocean},0} = 7.0 \\times 10^{19} \\ \\text{kg}$.\n  - Flux history: $F_{\\mathrm{sat}} = 5 \\ \\text{W m}^{-2}$, $t_{\\mathrm{sat}} = 50 \\ \\text{Myr}$, $\\beta = 1.5$, $t_{\\mathrm{end}} = 100 \\ \\text{Myr}$.\n  - Diffusion-limited cap: $\\Phi_{\\mathrm{diff}} = 1.0 \\times 10^{-12} \\ \\text{kg m}^{-2} \\text{s}^{-1}$.\n\nYour implementation must numerically integrate over time in seconds, handle the piecewise nature of $F_{\\mathrm{XUV}}(t)$ and the minimum-rate cap, and compute the requested outputs for each test case. The final printed output must be a single line in the exact list-of-lists format described above.",
            "solution": "We begin from the principle of energy conservation and Newtonian gravity. The energy-limited hydrodynamic escape model assumes that a fraction of the incident extreme-ultraviolet power deposited in the upper atmosphere is converted into mechanical work to lift gas out of the planet’s gravitational potential. The deposited power is proportional to the incident extreme-ultraviolet flux $F_{\\mathrm{XUV}}(t)$, multiplied by an effective absorbing area determined by the XUV absorption radius $R_{\\mathrm{XUV}}$, and scaled by an efficiency factor $\\eta$ that represents the fraction of absorbed energy that goes into escape rather than radiative cooling and other losses.\n\nThe absorbed power available for escape at time $t$, denoted $P_{\\mathrm{abs}}(t)$, is\n$$\nP_{\\mathrm{abs}}(t) = \\eta\\,A_{\\mathrm{abs}}\\,F_{\\mathrm{XUV}}(t)\n$$\nwhere $A_{\\mathrm{abs}}$ is an effective absorbing area. For a spherically symmetric planet and a collimated flux, the geometrical intercept area is proportional to the disc area, $A_{\\mathrm{abs}}=\\pi R_{\\mathrm{XUV}}^{2}$. The specific energy required to raise a unit mass to escape is the gravitational potential difference divided by the Roche-tide correction,\n$$\n\\Phi = \\frac{G M_{p}}{R_{p} K_{\\mathrm{tide}}}\n$$\nEquating the rate of energy input to the rate of mechanical work to lift escaping mass $\\dot{M}(t)$ gives the energy-limited mass loss rate,\n$$\n\\dot{M}_{\\mathrm{EL}}(t) = \\frac{P_{\\mathrm{abs}}(t)}{\\Phi} = \\eta\\,\\pi R_{\\mathrm{XUV}}^{2}\\,F_{\\mathrm{XUV}}(t)\\,\\frac{R_{p} K_{\\mathrm{tide}}}{G M_{p}}\n$$\nThis expression is widely used in planetary escape studies and follows directly from fundamental principles. In many applications, the XUV absorption radius can be of order the planetary radius or somewhat larger; we keep it explicit as $R_{\\mathrm{XUV}}$.\n\nHowever, the supply of hydrogen to the upper atmosphere can be limited by diffusion through the background atmosphere. A diffusion-limited hydrogen mass flux per unit area, denoted $\\Phi_{\\mathrm{diff}}$, sets a cap on the upward flux. The corresponding total mass loss cap is obtained by multiplying by the spherical escape surface area,\n$$\n\\dot{M}_{\\mathrm{diff}} = 4\\pi R_{\\mathrm{XUV}}^{2}\\,\\Phi_{\\mathrm{diff}}\n$$\nThe physically realized hydrogen mass loss rate at time $t$ is the minimum of the energy-limited rate and the diffusion cap:\n$$\n\\dot{M}_{H}(t) = \\min\\left(\\dot{M}_{\\mathrm{EL}}(t),\\,\\dot{M}_{\\mathrm{diff}}\\right)\n$$\n\nTo relate escaped hydrogen mass to water loss, consider the stoichiometry of a water molecule $\\mathrm{H_{2}O}$. The hydrogen mass fraction in water is\n$$\nf_{H} = \\frac{2 m_{H}}{2 m_{H} + m_{O}}\n$$\nwith $m_{H} = 1.6735575\\times 10^{-27}\\ \\mathrm{kg}$ and $m_{O} = 2.6566962\\times 10^{-26}\\ \\mathrm{kg}$. If a hydrogen mass $\\Delta M_{H}$ escapes, the equivalent water mass sourced from photodissociation is $\\Delta M_{\\mathrm{H_{2}O}} = \\Delta M_{H}/f_{H}$. We cap the cumulative water mass lost by the initial ocean inventory $M_{\\mathrm{ocean},0}$.\n\nThe star’s pre-main-sequence extreme-ultraviolet flux history at the planet’s orbit is modeled as:\n$$\nF_{\\mathrm{XUV}}(t) =\n\\begin{cases}\nF_{\\mathrm{sat}}, & t \\le t_{\\mathrm{sat}},\\\\\nF_{\\mathrm{sat}}\\,\\left(\\dfrac{t}{t_{\\mathrm{sat}}}\\right)^{-\\beta}, & t > t_{\\mathrm{sat}},\n\\end{cases}\n$$\nwith $F_{\\mathrm{sat}}$ in $\\mathrm{W}\\,\\mathrm{m}^{-2}$ and $t$ in megayears (Myr). We convert time to seconds for integration, using one Julian year equal to $365.25$ days so that one megayear is $10^{6}$ years.\n\nThe cumulative escaped hydrogen mass by time $t$ in seconds is\n$$\nM_{H}(t) = \\int_{0}^{t} \\dot{M}_{H}(t')\\,dt'\n$$\nThe cumulative equivalent water mass lost is $M_{\\mathrm{H_{2}O}}(t) = \\min\\left(\\dfrac{M_{H}(t)}{f_{H}},\\,M_{\\mathrm{ocean},0}\\right)$. Full desiccation (loss of the total initial ocean mass) occurs at the first time $t$ satisfying $M_{H}(t) = f_{H}\\,M_{\\mathrm{ocean},0}$; if no such time exists before $t_{\\mathrm{end}}$, then the planet is not fully desiccated in the modeled interval.\n\nAlgorithmic design:\n\n- For each test case, parse the parameters: $M_{p}$, $R_{p}$, $R_{\\mathrm{XUV}}$, $K_{\\mathrm{tide}}$, $\\eta$, $M_{\\mathrm{ocean},0}$, $F_{\\mathrm{sat}}$, $t_{\\mathrm{sat}}$ (Myr), $\\beta$, $t_{\\mathrm{end}}$ (Myr), and $\\Phi_{\\mathrm{diff}}$.\n- Implement $F_{\\mathrm{XUV}}(t)$ as a piecewise function in seconds by converting Myr to seconds using $1$ year $= 365.25$ days.\n- Compute $\\dot{M}_{\\mathrm{EL}}(t)$ using the energy-limited expression and $\\dot{M}_{\\mathrm{diff}}$ using the diffusion cap. Take the minimum to get $\\dot{M}_{H}(t)$.\n- Numerically integrate $\\dot{M}_{H}(t)$ from $t=0$ to $t=t_{\\mathrm{end}}$ using robust quadrature to obtain $M_{H}(t_{\\mathrm{end}})$ and then $M_{\\mathrm{H_{2}O}}(t_{\\mathrm{end}})$. Compute the fraction lost $f_{\\mathrm{loss}} = M_{\\mathrm{H_{2}O}}(t_{\\mathrm{end}})/M_{\\mathrm{ocean},0}$.\n- Determine desiccation occurrence by comparing $M_{H}(t_{\\mathrm{end}})$ to $f_{H}\\,M_{\\mathrm{ocean},0}$. If desiccation occurs, find the desiccation time by solving for the root of $g(t) = M_{H}(t) - f_{H}\\,M_{\\mathrm{ocean},0}$ using a bracketing root finder; convert to megayears and round appropriately.\n- Prepare the output as a list of lists for the three test cases: `[[f_loss, b, tau_desic], ...]`, where $b$ is $1$ if desiccation occurs and $0$ otherwise, and $\\tau_{\\mathrm{desic}}$ is the desiccation time in megayears or $-1.0$ if no desiccation occurs.\n\nScientific realism and connection to the habitable zone concept: Low-mass stars exhibit extended pre-main-sequence phases with elevated XUV fluxes. The habitable zone, defined by ranges of stellar flux permitting surface liquid water, evolves as the star contracts and its bolometric luminosity changes. Hydrodynamic escape powered by XUV can remove large quantities of water from planets that will later lie within the classical habitable zone, effectively altering their potential habitability. The model above quantifies the cumulative water loss and assesses whether desiccation occurs before the habitable zone stabilizes, thereby integrating atmospheric escape physics with the temporal evolution of habitability.\n\nThe numerical method using piecewise flux history, energy-limited escape with diffusion cap, and robust integration ensures coverage of cases where energy-limited escape dominates, where diffusion supply limits escape, and where cold-trapping yields negligible hydrogen supply. The test suite thus probes a typical pre-main-sequence M-dwarf scenario, a sub-Earth diffusion-limited edge case, and a boundary case with partial loss.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, optimize\n\n# Physical constants\nG = 6.67430e-11  # m^3 kg^-1 s^-2\nm_H = 1.6735575e-27  # kg\nm_O = 2.6566962e-26  # kg\n\n# Time conversions\nseconds_per_year = 365.25 * 24 * 3600.0\nseconds_per_Myr = 1.0e6 * seconds_per_year\n\n# Hydrogen mass fraction in water\nf_H = (2.0 * m_H) / (2.0 * m_H + m_O)\n\ndef F_XUV_piecewise(t_sec, F_sat, t_sat_Myr, beta):\n    \"\"\"\n    Piecewise XUV flux history.\n    t_sec: time in seconds\n    Returns flux in W/m^2\n    \"\"\"\n    t_sat_sec = t_sat_Myr * seconds_per_Myr\n    if t_sec <= t_sat_sec:\n        return F_sat\n    else:\n        return F_sat * (t_sec / t_sat_sec) ** (-beta)\n\ndef energy_limited_rate(F, eta, R_xuv, R_p, K_tide, M_p):\n    \"\"\"\n    Energy-limited hydrogen mass loss rate in kg/s.\n    Derived from power balance and gravitational binding energy per unit mass.\n    \"\"\"\n    # Absorbing area: pi R_xuv^2\n    # Specific energy to escape: G M_p / (R_p K_tide)\n    # Rate = eta * (pi R_xuv^2) * F / (G M_p / (R_p K_tide))\n    return eta * np.pi * (R_xuv**2) * F * (R_p * K_tide) / (G * M_p)\n\ndef diffusion_cap_rate(Phi_diff, R_xuv):\n    \"\"\"\n    Diffusion-limited cap on the total hydrogen mass loss rate in kg/s.\n    \"\"\"\n    return 4.0 * np.pi * (R_xuv**2) * Phi_diff\n\ndef dM_H_dt(t_sec, params):\n    \"\"\"\n    Instantaneous hydrogen mass loss rate (kg/s) at time t_sec (seconds),\n    taking the minimum of energy-limited rate and diffusion cap.\n    \"\"\"\n    F = F_XUV_piecewise(t_sec, params['F_sat'], params['t_sat_Myr'], params['beta'])\n    rate_el = energy_limited_rate(F, params['eta'], params['R_xuv'], params['R_p'], params['K_tide'], params['M_p'])\n    rate_diff = params['rate_diff_cap']\n    return min(rate_el, rate_diff)\n\ndef cumulative_H_loss(t_sec, params):\n    \"\"\"\n    Cumulative escaped hydrogen mass up to time t_sec (seconds), in kg.\n    Integrates dM_H_dt from 0 to t_sec using quadrature.\n    \"\"\"\n    # Use adaptive quadrature; integrand is smooth piecewise.\n    result, _ = integrate.quad(lambda tt: dM_H_dt(tt, params), 0.0, t_sec, epsabs=1e-8, epsrel=1e-7, limit=200)\n    return result\n\ndef solve_case(case):\n    \"\"\"\n    Solve one test case; return [fraction_lost, desiccated_boolean, t_desic_Myr (or -1.0)]\n    \"\"\"\n    # Unpack parameters\n    M_p = case['M_p']\n    R_p = case['R_p']\n    R_xuv = case['R_xuv']\n    K_tide = case['K_tide']\n    eta = case['eta']\n    M_ocean0 = case['M_ocean0']\n    F_sat = case['F_sat']\n    t_sat_Myr = case['t_sat_Myr']\n    beta = case['beta']\n    t_end_Myr = case['t_end_Myr']\n    Phi_diff = case['Phi_diff']\n\n    params = {\n        'M_p': M_p,\n        'R_p': R_p,\n        'R_xuv': R_xuv,\n        'K_tide': K_tide,\n        'eta': eta,\n        'F_sat': F_sat,\n        't_sat_Myr': t_sat_Myr,\n        'beta': beta,\n        'rate_diff_cap': diffusion_cap_rate(Phi_diff, R_xuv),\n    }\n\n    t_end_sec = t_end_Myr * seconds_per_Myr\n\n    # Total escaped hydrogen over interval\n    M_H_lost = cumulative_H_loss(t_end_sec, params)\n\n    # Convert to equivalent water loss, capped by initial inventory\n    M_H2O_lost = min(M_H_lost / f_H, M_ocean0)\n    fraction_lost = M_H2O_lost / M_ocean0\n\n    # Determine desiccation (full loss) time if occurs\n    H_required = f_H * M_ocean0\n    desiccated = 1 if M_H_lost >= H_required else 0\n\n    if desiccated == 1:\n        # Find root of cumulative_H_loss(t) - H_required = 0 on [0, t_end_sec]\n        # Ensure monotonicity and bracket\n        def g(t):\n            return cumulative_H_loss(t, params) - H_required\n\n        # Brent's method requires bracket where g has opposite signs\n        # g(0) = -H_required < 0; g(t_end_sec) >= 0\n        t_desic_sec = optimize.brentq(g, 0.0, t_end_sec, xtol=1e-10, rtol=1e-10, maxiter=200)\n        t_desic_Myr = t_desic_sec / seconds_per_Myr\n    else:\n        t_desic_Myr = -1.0\n\n    # Round per specification\n    fraction_lost_out = float(f\"{fraction_lost:.6f}\")\n    t_desic_out = float(f\"{t_desic_Myr:.2f}\")\n\n    return [fraction_lost_out, desiccated, t_desic_out]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            # Test case 1\n            'M_p': 5.972e24,\n            'R_p': 6.371e6,\n            'R_xuv': 1.1 * 6.371e6,\n            'K_tide': 1.0,\n            'eta': 0.15,\n            'M_ocean0': 1.4e21,\n            'F_sat': 100.0,\n            't_sat_Myr': 500.0,\n            'beta': 1.2,\n            't_end_Myr': 1000.0,\n            'Phi_diff': 1.0e-5\n        },\n        {\n            # Test case 2\n            'M_p': 0.6 * 5.972e24,\n            'R_p': 0.6 * 6.371e6,\n            'R_xuv': 1.2 * (0.6 * 6.371e6),\n            'K_tide': 1.0,\n            'eta': 0.30,\n            'M_ocean0': 2.8e21,\n            'F_sat': 300.0,\n            't_sat_Myr': 1000.0,\n            'beta': 1.0,\n            't_end_Myr': 2000.0,\n            'Phi_diff': 3.0e-10\n        },\n        {\n            # Test case 3\n            'M_p': 1.0 * 5.972e24,\n            'R_p': 1.0 * 6.371e6,\n            'R_xuv': 1.0 * (1.0 * 6.371e6),\n            'K_tide': 1.0,\n            'eta': 0.05,\n            'M_ocean0': 7.0e19,\n            'F_sat': 5.0,\n            't_sat_Myr': 50.0,\n            'beta': 1.5,\n            't_end_Myr': 100.0,\n            'Phi_diff': 1.0e-12\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_case(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Ensure plain Python list formatting with no extra text.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}