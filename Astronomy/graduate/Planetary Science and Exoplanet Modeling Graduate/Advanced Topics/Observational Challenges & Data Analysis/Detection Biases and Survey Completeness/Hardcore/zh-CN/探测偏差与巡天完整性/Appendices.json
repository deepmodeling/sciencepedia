{
    "hands_on_practices": [
        {
            "introduction": "要理解探测偏差，第一步是确定在理想条件下，一个给定的行星是否能被特定的仪器探测到。这个练习将引导你完成径向速度（RV）巡天的一项基础计算。它将行星的物理特性（如质量和周期）与可观测的恒星信号联系起来，并根据噪声评估其可探测性，从而建立信噪比（SNR）阈值的概念。",
            "id": "4158322",
            "problem": "一项对类日恒星的视向速度（RV）巡天观测了 $N=60$ 个历元，其测量不确定度为相同且独立的高斯分布，$\\sigma_{\\mathrm{RV}}=1.5$ $\\mathrm{m\\,s^{-1}}$。考虑一颗质量为 $M_{p}=17\\,M_{\\oplus}$ 的行星，在周期为 $P=30$ 天的圆形轨道上，围绕一颗质量为 $M_{\\star}=M_{\\odot}$ 的恒星运动。假设轨道倾角为侧向，$i=\\pi/2$，因此 $\\sin i=1$。当拟合的视向速度半振幅 $K$ 的信噪比（SNR）满足 $\\mathrm{SNR}_{K}\\geq 5$ 时，该巡天项目宣布探测成功。\n\n从牛顿万有引力定律和双体系统的开普勒第三定律出发，并利用 $M_{p}\\ll M_{\\star}$ 的条件，推导圆形轨道下恒星的响应视向速度半振幅 $K$，将其表示为 $G$、$M_{p}$、$M_{\\star}$ 和 $P$ 的函数。然后，将视向速度时间序列视为 $v(t)=K\\sin(\\omega t+\\phi)+\\epsilon(t)$，其中 $\\omega=2\\pi/P$，相位 $\\phi$ 未知，白噪声 $\\epsilon(t)$ 的方差为 $\\sigma_{\\mathrm{RV}}^{2}$。并假设 $N$ 个观测时间点 $t_{i}$ 在多个周期内均匀地采样了轨道相位，推导估计的半振幅的不确定度，并由此得到 $\\mathrm{SNR}_{K}$ 的表达式。最后，使用以下常数对 $\\mathrm{SNR}_{K}$ 进行数值计算：$G=6.67430\\times 10^{-11}$ $\\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$，$M_{\\odot}=1.98847\\times 10^{30}$ $\\mathrm{kg}$，$M_{\\oplus}=5.9722\\times 10^{24}$ $\\mathrm{kg}$，以及 $1\\,\\mathrm{day}=86400$ $\\mathrm{s}$。将最终答案表示为一个无单位的小数，并四舍五入到三位有效数字。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 问题验证\n\n**第一步：提取已知条件**\n\n*   观测历元数：$N=60$\n*   测量不确定度（高斯、相同、独立）：$\\sigma_{\\mathrm{RV}}=1.5 \\, \\mathrm{m\\,s^{-1}}$\n*   行星质量：$M_{p}=17\\,M_{\\oplus}$\n*   轨道类型：圆形\n*   轨道周期：$P=30$ 天\n*   恒星质量：$M_{\\star}=M_{\\odot}$\n*   轨道倾角：$i=\\pi/2$（意味着 $\\sin i=1$）\n*   探测阈值：$\\mathrm{SNR}_{K}\\geq 5$\n*   视向速度时间序列模型：$v(t)=K\\sin(\\omega t+\\phi)+\\epsilon(t)$，其中 $\\omega=2\\pi/P$，噪声方差为 $\\sigma_{\\mathrm{RV}}^{2}$\n*   采样假设：观测时间 $t_{i}$ 在多个周期内均匀地采样轨道相位。\n*   常数：$G=6.67430\\times 10^{-11}$ $\\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$，$M_{\\odot}=1.98847\\times 10^{30}$ $\\mathrm{kg}$，$M_{\\oplus}=5.9722\\times 10^{24}$ $\\mathrm{kg}$，$1\\,\\mathrm{day}=86400$ $\\mathrm{s}$。\n\n**第二步：使用提取的已知条件进行验证**\n\n该问题具有科学依据，基于牛顿引力理论和系外行星探测中使用的标准统计方法。给出的物理常数和参数值是标准且符合实际的。该问题是适定的，提供了推导所求量所需的所有必要信息。推导视向速度半振幅 $K$ 及其信噪比 $\\mathrm{SNR}_{K}$ 的任务是天体物理学和数据分析中的标准练习。语言客观、精确。诸如圆形轨道、均匀相位采样和 $M_p \\ll M_\\star$ 等假设都已明确说明，并且是此类问题中标准的简化假设。该问题未违反任何无效标准。\n\n**第三步：结论与行动**\n\n该问题被判定为 **有效**。将提供完整解答。\n\n### 解答推导\n\n**1. 视向速度半振幅 $K$ 的推导**\n\n我们从一个由质量为 $M_{\\star}$ 的恒星和质量为 $M_{p}$ 的行星组成的双体系统的开普勒第三定律开始：\n$$P^2 = \\frac{4\\pi^2 a^3}{G(M_{\\star} + M_p)}$$\n其中 $P$ 是轨道周期，$G$ 是引力常数，$a$ 是行星相对于恒星的相对轨道的半长轴。\n\n恒星和行星围绕它们的共同质心（引力中心）运行。对于圆形轨道，恒星和行星轨道的半长轴 $a_{\\star}$ 和 $a_{p}$ 分别由动量守恒关联起来：\n$$M_{\\star}a_{\\star} = M_{p}a_{p}$$\n相对轨道的半长轴是 $a = a_{\\star} + a_{p}$。从这两个关系中，我们可以将恒星轨道的半长轴表示为：\n$$a_{\\star} = \\frac{M_{p}}{M_{\\star} + M_p}a$$\n对于圆形轨道，恒星的轨道速度 $v_{\\star}$ 是一个常数，由下式给出：\n$$v_{\\star} = \\frac{2\\pi a_{\\star}}{P}$$\n观测到的视向速度半振幅 $K$ 是恒星轨道速度在视线方向上的最大分量。对于轨道倾角 $i$，这个值为 $K = v_{\\star} \\sin i$。由于问题指定了侧向轨道，$i=\\pi/2$ 且 $\\sin i = 1$，因此 $K = v_{\\star}$。\n\n代入 $a_{\\star}$ 的表达式：\n$$K = \\frac{2\\pi}{P} \\left( \\frac{M_{p}}{M_{\\star} + M_p}a \\right)$$\n现在，我们对开普勒第三定律求解 $a$：\n$$a = \\left( \\frac{G(M_{\\star} + M_p)P^2}{4\\pi^2} \\right)^{1/3}$$\n将这个 $a$ 的表达式代入 $K$ 的方程：\n$$K = \\frac{2\\pi M_p}{P(M_{\\star} + M_p)} \\left( \\frac{G(M_{\\star} + M_p)P^2}{4\\pi^2} \\right)^{1/3}$$\n化简表达式：\n$$K = \\frac{M_p}{(M_{\\star} + M_p)} \\frac{2\\pi}{P} \\left(\\frac{P^2}{4\\pi^2}\\right)^{1/3} \\left(G(M_{\\star} + M_p)\\right)^{1/3}$$\n$$K = \\frac{M_p}{(M_{\\star} + M_p)^{1 - 1/3}} \\left(\\frac{2\\pi}{P}\\right)^{1 - 2/3} G^{1/3}$$\n$$K = \\frac{M_p}{(M_{\\star} + M_p)^{2/3}} \\left(\\frac{2\\pi G}{P}\\right)^{1/3}$$\n在 $M_p \\ll M_{\\star}$ 的条件下，我们可以近似认为 $M_{\\star} + M_p \\approx M_{\\star}$。$K$ 的表达式简化为：\n$$K \\approx \\frac{M_p}{M_{\\star}^{2/3}} \\left(\\frac{2\\pi G}{P}\\right)^{1/3}$$\n由于 $\\sin i = 1$，这就是可观测半振幅的最终表达式。\n\n**2. 信噪比 $\\mathrm{SNR}_{K}$ 的推导**\n\n视向速度测量的模型是 $v(t_j) = K\\sin(\\omega t_j + \\phi) + \\epsilon_j$，$j=1, ..., N$，其中 $\\epsilon_j$ 是来自均值为 $0$、方差为 $\\sigma_{\\mathrm{RV}}^2$ 的高斯分布的独立同分布随机变量。\n\n为了确定拟合半振幅 $K$ 的不确定度，我们可以使用模型的线性化形式：\n$$v(t) = K(\\sin(\\omega t)\\cos\\phi + \\cos(\\omega t)\\sin\\phi) + \\epsilon(t)$$\n设 $A = K\\cos\\phi$ 和 $B = K\\sin\\phi$。模型在参数 $A$ 和 $B$ 上变为线性：\n$$v(t) = A\\sin(\\omega t) + B\\cos(\\omega t) + \\epsilon(t)$$\n这是一个标准的线性最小二乘问题。估计参数 $\\hat{A}$ 和 $\\hat{B}$ 的方差取决于设计矩阵。关键的假设是 $N$ 次观测均匀地采样了轨道相位。这使我们可以用一个周期内的积分来近似对观测值的求和。\n$\\hat{A}$ 和 $\\hat{B}$ 的方差由下式给出：\n$$\\sigma_A^2 = \\sigma_B^2 = \\frac{\\sigma_{\\mathrm{RV}}^2}{\\sum_{j=1}^N \\sin^2(\\omega t_j)} \\approx \\frac{\\sigma_{\\mathrm{RV}}^2}{N/2} = \\frac{2\\sigma_{\\mathrm{RV}}^2}{N}$$\n均匀采样也使得协方差矩阵的非对角项为零，这意味着 $\\hat{A}$ 和 $\\hat{B}$ 是不相关的。\n半振幅是 $K = \\sqrt{A^2 + B^2}$。我们使用标准误差传播来找到其不确定度 $\\sigma_K$：\n$$\\sigma_K^2 = \\left(\\frac{\\partial K}{\\partial A}\\right)^2 \\sigma_A^2 + \\left(\\frac{\\partial K}{\\partial B}\\right)^2 \\sigma_B^2 = \\left(\\frac{A}{K}\\right)^2 \\sigma_A^2 + \\left(\\frac{B}{K}\\right)^2 \\sigma_B^2$$\n由于 $\\sigma_A^2 = \\sigma_B^2$，上式简化为：\n$$\\sigma_K^2 = \\frac{A^2 + B^2}{K^2} \\sigma_A^2 = \\frac{K^2}{K^2} \\sigma_A^2 = \\sigma_A^2$$\n因此，半振幅的方差是 $\\sigma_K^2 = 2\\sigma_{\\mathrm{RV}}^2/N$，其标准差是：\n$$\\sigma_K = \\sigma_{\\mathrm{RV}}\\sqrt{\\frac{2}{N}}$$\n半振幅 $K$ 的信噪比定义为估计值与其不确定度的比率：\n$$\\mathrm{SNR}_K = \\frac{K}{\\sigma_K} = \\frac{K}{\\sigma_{\\mathrm{RV}}\\sqrt{2/N}} = K \\frac{\\sqrt{N/2}}{\\sigma_{\\mathrm{RV}}}$$\n\n### 数值计算\n\n我们现在将给定的数值代入推导出的表达式中。\n\n**1. 计算 $K$**\n*   $M_p = 17\\,M_{\\oplus} = 17 \\times 5.9722\\times 10^{24}\\,\\mathrm{kg} = 1.015274 \\times 10^{26}\\,\\mathrm{kg}$\n*   $M_{\\star} = M_{\\odot} = 1.98847\\times 10^{30}\\,\\mathrm{kg}$\n*   $P = 30\\,\\mathrm{days} = 30 \\times 86400\\,\\mathrm{s} = 2.592 \\times 10^6\\,\\mathrm{s}$\n*   $G = 6.67430\\times 10^{-11}\\,\\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$\n\n使用推导出的 $K$ 公式：\n$$K \\approx \\frac{1.015274 \\times 10^{26}\\,\\mathrm{kg}}{(1.98847\\times 10^{30}\\,\\mathrm{kg})^{2/3}} \\left(\\frac{2\\pi \\times (6.67430\\times 10^{-11}\\,\\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}})}{2.592 \\times 10^6\\,\\mathrm{s}}\\right)^{1/3}$$\n$$K \\approx \\frac{1.015274 \\times 10^{26}}{1.58115 \\times 10^{20}}\\,\\mathrm{kg^{1/3}} \\left(1.61747 \\times 10^{-16}\\,\\mathrm{m^{3}\\,kg^{-1}\\,s^{-3}}\\right)^{1/3}$$\n$$K \\approx (6.42081 \\times 10^5\\,\\mathrm{kg^{1/3}}) \\times (5.44852 \\times 10^{-6}\\,\\mathrm{m\\,kg^{-1/3}\\,s^{-1}})$$\n$$K \\approx 3.4985\\,\\mathrm{m\\,s^{-1}}$$\n\n**2. 计算 $\\mathrm{SNR}_K$**\n*   $K \\approx 3.4985\\,\\mathrm{m\\,s^{-1}}$\n*   $N=60$\n*   $\\sigma_{\\mathrm{RV}} = 1.5\\,\\mathrm{m\\,s^{-1}}$\n\n使用推导出的 $\\mathrm{SNR}_K$ 公式：\n$$\\mathrm{SNR}_K = \\frac{3.4985\\,\\mathrm{m\\,s^{-1}}}{1.5\\,\\mathrm{m\\,s^{-1}}}\\sqrt{\\frac{60}{2}} = \\frac{3.4985}{1.5}\\sqrt{30}$$\n$$\\mathrm{SNR}_K \\approx 2.3323 \\times 5.4772 \\approx 12.7744$$\n将最终结果四舍五入到三位有效数字，我们得到 $12.8$。",
            "answer": "$$\n\\boxed{12.8}\n$$"
        },
        {
            "introduction": "在单次探测的基础上，我们将视野扩展到整个巡天项目。现实中的巡天观测并非连续不断。这项练习探讨了巡天项目的特性，例如总观测时长（基线）和观测中断（占空比），如何共同决定成功探测的总体概率，即使对于一颗理论上可探测的行星也是如此。它为凌星法等时域方法引入了巡天完备度的概率性概念。",
            "id": "4158301",
            "problem": "一项凌日系外行星巡天在固定的观测基线上分析光变曲线以寻找周期性的亮度下降。假设一项理想化的巡天在 $T=730\\,\\mathrm{days}$ 的基线上持续监视一颗目标恒星，但其中存在随机的观测间隙，使得净覆盖率降低为一个恒定的占空比 $D$。只有在基线内观测到至少 $3$ 次不同的凌日事件时，才算作一次探测成功。考虑一颗轨道周期为 $P=100\\,\\mathrm{days}$、处于圆形轨道上的行星，并假设观测基线开始时的轨道相位在 $[0,P)$ 上均匀分布，凌日时长与观测间隙的时间尺度相比可以忽略不计，且观测到任意一次凌日事件的概率是独立的，均为 $D$。\n\n从占空比的基本定义以及在有限时间间隔内对具有均匀随机相位的离散事件进行计数出发，推导出一个关于 $D$ 的普适表达式，该表达式描述了巡天在观测基线内探测到至少 $3$ 次凌日的概率。然后，计算当 $D=0.9$ 时该概率的值，将最终数值结果四舍五入至七位有效数字，并以不带单位的小数形式表示。最后，利用该解析表达式讨论此探测概率在 $D=0.9$ 附近对 $D$ 的微小变化的敏感程度（无需为灵敏度计算一个单独的数值；讨论应基于导数及其在 $D=0.9$ 处的值）。",
            "solution": "该问题具有科学依据，提问清晰且客观。它提出了一个可解的、理想化的系外行星巡天模型，没有矛盾或含糊之处。我们可以开始求解。\n\n问题要求计算探测到一颗系外行星的概率，这要求在总观测基线 $T=730\\,\\mathrm{days}$ 内观测到至少 $k=3$ 次凌日。该行星的轨道周期为 $P=100\\,\\mathrm{days}$。\n\n首先，我们确定在观测窗口 $[0, T)$ 内可能发生的凌日次数 $N$。凌日发生的时间取决于初始轨道相位 $\\phi_0$，它在 $[0, P)$ 上均匀分布。凌日发生在时间 $t_n = \\phi_0 + (n-1)P$，其中 $n=1, 2, 3, \\dots$。落在区间 $[0, T)$ 内的凌日次数 $N$ 是使得 $t_n  T$ 成立的最大整数 $n$。\n$$ \\phi_0 + (N-1)P  T \\implies N  \\frac{T - \\phi_0}{P} + 1 $$\n由于 $N$ 必须是整数，因此 $N = \\lfloor \\frac{T - \\phi_0}{P} + 1 \\rfloor = \\lfloor \\frac{T}{P} - \\frac{\\phi_0}{P} + 1 \\rfloor$。\n给定 $T=730$ 和 $P=100$，我们有 $T/P = 7.3$。由于 $0 \\le \\phi_0  P$，我们有 $0 \\le \\phi_0/P  1$。\n因此，潜在凌日次数 $N$ 可以取两个值之一：\n1.  如果 $0 \\le \\phi_0/P  0.3$，那么 $7.0  7.3 - \\phi_0/P \\le 7.3$，因此 $8.0  (T - \\phi_0)/P + 1 \\le 8.3$。这得出 $N = \\lfloor 8.0 \\dots 8.3 \\rfloor = 8$。这种情况发生在 $0 \\le \\phi_0  0.3 P = 30\\,\\mathrm{days}$ 时。\n2.  如果 $0.3 \\le \\phi_0/P  1$，那么 $6.3  7.3 - \\phi_0/P \\le 7.0$，因此 $7.3  (T - \\phi_0)/P + 1 \\le 8.0$。这得出 $N = \\lfloor 7.3 \\dots 8.0 \\rfloor = 7$。这种情况发生在 $30 \\le \\phi_0  100\\,\\mathrm{days}$ 时。\n\n令 $N_0 = \\lfloor T/P \\rfloor = \\lfloor 7.3 \\rfloor = 7$。\n令 $\\alpha = T/P - N_0 = 7.3 - 7 = 0.3$。\n潜在凌日次数为 $N = N_0+1 = 8$ 的概率是 $p(N=8) = \\frac{0.3P - 0}{P} = \\alpha = 0.3$。\n潜在凌日次数为 $N = N_0 = 7$ 的概率是 $p(N=7) = \\frac{P - 0.3P}{P} = 1-\\alpha = 0.7$。\n\n探测成功要求观测到这 $N$ 次潜在凌日中的至少 $3$ 次。每次凌日被独立观测到的概率为占空比 $D$。对于给定的 $N$，观测到的凌日次数 $k$ 服从二项分布，$k \\sim B(N, D)$。观测到 $k$ 次凌日的概率由概率质量函数给出：\n$$ \\mathcal{P}(k|N, D) = \\binom{N}{k} D^k (1-D)^{N-k} $$\n探测成功的条件是 $k \\ge 3$。在给定 $N$ 的条件下，发生此事件的概率为：\n$$ \\mathcal{P}_{\\text{det}}(D|N) = \\mathcal{P}(k \\ge 3 | N, D) = \\sum_{k=3}^{N} \\binom{N}{k} D^k (1-D)^{N-k} $$\n计算其补集会更简单：即观测到少于 $3$ 次凌日的概率。\n$$ \\mathcal{P}_{\\text{det}}(D|N) = 1 - \\mathcal{P}(k  3 | N, D) = 1 - [\\mathcal{P}(k=0|N,D) + \\mathcal{P}(k=1|N,D) + \\mathcal{P}(k=2|N,D)] $$\n各项为：\n$$ \\mathcal{P}(k=0|N,D) = \\binom{N}{0} D^0 (1-D)^N = (1-D)^N $$\n$$ \\mathcal{P}(k=1|N,D) = \\binom{N}{1} D^1 (1-D)^{N-1} = N D (1-D)^{N-1} $$\n$$ \\mathcal{P}(k=2|N,D) = \\binom{N}{2} D^2 (1-D)^{N-2} = \\frac{N(N-1)}{2} D^2 (1-D)^{N-2} $$\n令 $F(N,D) = \\mathcal{P}_{\\text{det}}(D|N)$。那么：\n$$ F(N,D) = 1 - \\left[ (1-D)^N + N D (1-D)^{N-1} + \\frac{N(N-1)}{2} D^2 (1-D)^{N-2} \\right] $$\n总探测概率 $\\mathcal{P}_{\\text{det}}(D)$ 通过全概率定律求得，即对 $N$ 的所有可能值进行加权平均：\n$$ \\mathcal{P}_{\\text{det}}(D) = p(N=7) \\cdot F(7,D) + p(N=8) \\cdot F(8,D) $$\n$$ \\mathcal{P}_{\\text{det}}(D) = (1-\\alpha) F(7,D) + \\alpha F(8,D) = 0.7 \\cdot F(7,D) + 0.3 \\cdot F(8,D) $$\n我们有：\n$$ F(7,D) = 1 - \\left[ (1-D)^7 + 7D(1-D)^6 + \\binom{7}{2}D^2(1-D)^5 \\right] = 1 - \\left[ (1-D)^7 + 7D(1-D)^6 + 21D^2(1-D)^5 \\right] $$\n$$ F(8,D) = 1 - \\left[ (1-D)^8 + 8D(1-D)^7 + \\binom{8}{2}D^2(1-D)^6 \\right] = 1 - \\left[ (1-D)^8 + 8D(1-D)^7 + 28D^2(1-D)^6 \\right] $$\n代入这些即可得到探测概率关于 $D$ 的普适表达式：\n$$ \\mathcal{P}_{\\text{det}}(D) = 0.7 \\left( 1 - (1-D)^7 - 7D(1-D)^6 - 21D^2(1-D)^5 \\right) + 0.3 \\left( 1 - (1-D)^8 - 8D(1-D)^7 - 28D^2(1-D)^6 \\right) $$\n该表达式可以简化为：\n$$ \\mathcal{P}_{\\text{det}}(D) = 1 - 0.7 \\left( (1-D)^7 + 7D(1-D)^6 + 21D^2(1-D)^5 \\right) - 0.3 \\left( (1-D)^8 + 8D(1-D)^7 + 28D^2(1-D)^6 \\right) $$\n这就是探测概率的普适表达式。\n\n接下来，我们计算当 $D=0.9$ 时该概率的值。这意味着 $1-D=0.1$。\n我们先计算 $F(7, 0.9)$：\n$$ \\mathcal{P}(k3|N=7, D=0.9) = (0.1)^7 + 7(0.9)(0.1)^6 + 21(0.9)^2(0.1)^5 $$\n$$ = 1 \\times 10^{-7} + 6.3(10^{-6}) + 21(0.81)(10^{-5}) $$\n$$ = 0.1 \\times 10^{-6} + 6.3 \\times 10^{-6} + 17.01 \\times 10^{-5} $$\n$$ = 6.4 \\times 10^{-6} + 170.1 \\times 10^{-6} = 176.5 \\times 10^{-6} = 0.0001765 $$\n所以，$F(7, 0.9) = 1 - 0.0001765 = 0.9998235$。\n\n现在，我们来计算 $F(8, 0.9)$：\n$$ \\mathcal{P}(k3|N=8, D=0.9) = (0.1)^8 + 8(0.9)(0.1)^7 + 28(0.9)^2(0.1)^6 $$\n$$ = 1 \\times 10^{-8} + 7.2(10^{-7}) + 28(0.81)(10^{-6}) $$\n$$ = 0.01 \\times 10^{-6} + 0.72 \\times 10^{-6} + 22.68 \\times 10^{-6} $$\n$$ = (0.01 + 0.72 + 22.68) \\times 10^{-6} = 23.41 \\times 10^{-6} = 0.00002341 $$\n所以，$F(8, 0.9) = 1 - 0.00002341 = 0.99997659$。\n\n现在，我们将这些结果合并以求得总概率：\n$$ \\mathcal{P}_{\\text{det}}(0.9) = 0.7 \\cdot F(7, 0.9) + 0.3 \\cdot F(8, 0.9) $$\n$$ \\mathcal{P}_{\\text{det}}(0.9) = 0.7(0.9998235) + 0.3(0.99997659) $$\n$$ \\mathcal{P}_{\\text{det}}(0.9) = 0.69987645 + 0.299992977 = 0.999869427 $$\n四舍五入到七位有效数字，我们得到 $0.9998694$。\n\n最后，我们讨论在 $D=0.9$ 附近，$\\mathcal{P}_{\\text{det}}(D)$ 对 $D$ 的微小变化的敏感度。该敏感度由导数 $\\frac{d\\mathcal{P}_{\\text{det}}}{dD}$ 来表征。\n首先，我们求 $F(N,D)$ 的导数：\n$$ \\frac{dF(N,D)}{dD} = \\frac{d}{dD} \\left( 1 - \\sum_{k=0}^{2} \\binom{N}{k} D^k (1-D)^{N-k} \\right) $$\n使用二项累积分布函数求导的恒等式，或者直接对多项式求导，我们得到：\n$$ \\frac{dF(N,D)}{dD} = N\\binom{N-1}{2} D^2 (1-D)^{N-3} = \\frac{N(N-1)(N-2)}{2} D^2 (1-D)^{N-3} $$\n总导数为：\n$$ \\frac{d\\mathcal{P}_{\\text{det}}}{dD} = 0.7 \\cdot \\frac{dF(7,D)}{dD} + 0.3 \\cdot \\frac{dF(8,D)}{dD} $$\n$$ \\frac{d\\mathcal{P}_{\\text{det}}}{dD} = 0.7 \\left[ \\frac{7 \\cdot 6 \\cdot 5}{2} D^2 (1-D)^4 \\right] + 0.3 \\left[ \\frac{8 \\cdot 7 \\cdot 6}{2} D^2 (1-D)^5 \\right] $$\n$$ \\frac{d\\mathcal{P}_{\\text{det}}}{dD} = 0.7(105) D^2 (1-D)^4 + 0.3(168) D^2 (1-D)^5 $$\n$$ \\frac{d\\mathcal{P}_{\\text{det}}}{dD} = 73.5 D^2 (1-D)^4 + 50.4 D^2 (1-D)^5 = D^2(1-D)^4 [73.5 + 50.4(1-D)] $$\n在 $D=0.9$ 处求值：\n$$ \\left. \\frac{d\\mathcal{P}_{\\text{det}}}{dD} \\right|_{D=0.9} = (0.9)^2(0.1)^4 [73.5 + 50.4(0.1)] = 0.81 \\times 10^{-4} [73.5 + 5.04] = 0.81 \\times 10^{-4} [78.54] \\approx 0.00636 $$\n这个导数值非常小。这表明当占空比 $D$ 已经很高时（例如 $D=0.9$），探测概率 $\\mathcal{P}_{\\text{det}}$ 对 $D$ 的微小变化高度不敏感。这种低敏感度的原因是探测概率处于饱和状态。在 $D=0.9$ 时，未能探测到至少 $3$ 次凌日的概率已经极低（约为 $1 - 0.9998694 = 1.3 \\times 10^{-4}$）。敏感度由这个微小的失败概率的变化率决定。导数表达式中包含一个因子 $(1-D)^4$，当 $D$ 趋近于 $1$ 时，该因子会强烈抑制函数的斜率。在这种情况下，由于潜在凌日次数较多（7或8次）且占空比较高，探测标准几乎肯定能被满足。对一个已经非常出色的占空比进行微小的改进，只会使已经接近确定的探测概率产生微不足道的增加。",
            "answer": "$$ \\boxed{0.9998694} $$"
        },
        {
            "introduction": "最后，我们将完备性的概念与最终的科学目标——测量系外行星的族群特征——联系起来。这项高级练习探讨了一个关键问题：如果我们对探测完备性的估计本身不准确，会产生什么后果？它演示了一个系统性的完备性误差如何通过贝叶斯统计分析进行传播，最终对推断出的系外行星发生率造成偏差。",
            "id": "4158311",
            "problem": "一次凌星巡天以 $N_{\\star}$ 颗类日恒星为目标，报告在单个周期-半径区间内探测到 $k$ 颗行星。该区间内探测到的真实期望计数服从一个均值为 $\\mu = N_{\\star} E f$ 的泊松过程，其中 $E \\in (0,1]$ 是该区间的平均探测完备度，而 $f \\ge 0$ 是该区间内每颗恒星的发生率（表示为无量纲分数）。巡天分析师采用了一个贝叶斯模型，其中泊松均值 $\\mu$ 具有一个共轭伽马先验 $\\mu \\sim \\mathrm{Gamma}(\\alpha, \\beta)$（采用率参数化，形状参数 $\\alpha  0$，率参数 $\\beta  0$），并使用贝叶斯法则来获得 $\\mu$ 的后验分布，然后通过关系式 $\\mu = N_{\\star} \\widehat{E}\\, f$ 将该后验分布映射到发生率 $f$，其中 $\\widehat{E}$ 是分析师对完备度的估计值。\n\n假设真实的完备度是 $E$，但分析师的估计值系统性地偏高了一个不大的因子，即 $\\widehat{E} = (1+\\delta) E$，其中 $\\delta = 0.1$。从泊松似然和伽马先验的定义出发，推导在这个被错误估计的完备度下 $f$ 的后验均值，并以闭合形式确定，与使用真实完备度 $E$ 时相比，$f$ 的后验均值产生的偏差乘法因子。\n\n现在考虑一个跨越多个区间（由 $i=1,\\dots,m$ 索引）的群体拟合，其中发生率满足对数线性模型 $\\ln f_{i} = \\theta_{0} + \\theta_{1} \\ln P_{i}$，$P_{i}$ 是区间 $i$ 的特征周期，$(\\theta_{0}, \\theta_{1})$ 是模型参数。假设所有区间都存在相同的均匀完备度错误估计 $\\widehat{E}_{i} = (1+\\delta) E_{i}$。使用单区间偏差的结果，推导由完备度错误估计导致的 $\\{f_{i}\\}$ 中的均匀乘法偏差所引起的截距参数 $\\theta_{0}$ 中的加法位移。\n\n以包含以下两个条目的行矩阵形式提供您的最终答案：\n- $f$ 的单区间后验均值上的乘法偏差因子，以及\n- 多区间对数线性拟合中 $\\theta_{0}$ 的加法位移。\n\n无需四舍五入。使用精确形式表达最终答案。发生率和参数是无量纲的，应作为没有单位的纯数字处理。",
            "solution": "在尝试解答之前，将对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 一次凌星巡天以 $N_{\\star}$ 颗恒星为目标。\n- 在单个周期-半径区间内探测到 $k$ 颗行星。\n- 探测数量服从均值为 $\\mu = N_{\\star} E f$ 的泊松过程。\n- $E \\in (0,1]$ 是真实的区间平均探测完备度。\n- $f \\ge 0$ 是真实的每颗恒星发生率。\n- 使用一个贝叶斯模型，其中泊松均值 $\\mu$ 的先验为：$\\mu \\sim \\mathrm{Gamma}(\\alpha, \\beta)$，其中 $\\alpha  0$ 是形状参数，$\\beta  0$ 是率参数。\n- 分析师通过关系式 $\\mu = N_{\\star} \\widehat{E}\\, f$ 将 $\\mu$ 的后验分布映射到发生率 $f$，其中 $\\widehat{E}$ 是分析师对完备度的估计值。\n- 分析师的完备度估计值系统性偏高：$\\widehat{E} = (1+\\delta) E$，其中 $\\delta = 0.1$。\n- 对于多区间情况，给出了一个发生率模型：$\\ln f_{i} = \\theta_{0} + \\theta_{1} \\ln P_{i}$，其中 $i$ 是区间的索引，$P_i$ 是特征周期，$(\\theta_0, \\theta_1)$ 是模型参数。\n- 所有区间的完备度错误估计是均匀的：$\\widehat{E}_{i} = (1+\\delta) E_{i}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准评估问题。\n- **科学上合理：** 该问题设置在系外行星发生率推断的标准框架内。它正确地使用了计数数据的泊松似然，使用伽马分布作为泊松率的共轭先验，并明确地模拟了探测完备度的影响，这是巡天分析的一个关键方面。发生率作为轨道周期函数的对数线性模型也是该领域的常用模型。该设置在科学上和数学上都是合理的。\n- **适定性：** 问题提供了所有必要的定义、关系和数据（以符号形式），以推导所要求的量。目标明确：推导一个乘法偏差因子和一个加法参数位移。其结构允许一个唯一且有意义的解。\n- **客观性：** 问题以精确、正式的语言陈述，没有主观性或歧义。\n\n该问题没有表现出验证清单中列出的任何缺陷（例如，科学上不合理、不完整、矛盾等）。\n\n### 步骤 3：结论和行动\n该问题被判定为**有效**。将提供完整解答。\n\n### 第 1 部分：单区间偏差因子\n\n探测到的行星数量 $k$ 被建模为从均值为 $\\mu$ 的泊松分布中的一次抽样。似然函数为：\n$$p(k|\\mu) = \\frac{\\mu^k \\exp(-\\mu)}{k!}$$\n均值 $\\mu$ 的先验是一个伽马分布，其形状参数为 $\\alpha  0$，率参数为 $\\beta  0$：\n$$p(\\mu|\\alpha, \\beta) = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} \\mu^{\\alpha-1} \\exp(-\\beta\\mu)$$\n根据贝叶斯法则，给定观测值 $k$ 时 $\\mu$ 的后验分布与似然和先验的乘积成正比：\n$$p(\\mu|k, \\alpha, \\beta) \\propto p(k|\\mu) p(\\mu|\\alpha, \\beta)$$\n$$p(\\mu|k, \\alpha, \\beta) \\propto \\left( \\frac{\\mu^k \\exp(-\\mu)}{k!} \\right) \\left( \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} \\mu^{\\alpha-1} \\exp(-\\beta\\mu) \\right)$$\n忽略归一化常数，我们有：\n$$p(\\mu|k, \\alpha, \\beta) \\propto \\mu^k \\exp(-\\mu) \\mu^{\\alpha-1} \\exp(-\\beta\\mu) = \\mu^{(\\alpha+k)-1} \\exp(-(\\beta+1)\\mu)$$\n这是一个伽马分布的核。因此，后验分布也是一个伽马分布，这是共轭性的一种性质：\n$$\\mu|k, \\alpha, \\beta \\sim \\mathrm{Gamma}(\\alpha', \\beta')$$\n其中后验形状参数为 $\\alpha' = \\alpha+k$，后验率参数为 $\\beta' = \\beta+1$。\n\n形状参数为 $a$、率参数为 $b$ 的伽马分布的均值为 $\\frac{a}{b}$。因此，$\\mu$ 的后验均值为：\n$$E[\\mu|k] = \\frac{\\alpha'}{\\beta'} = \\frac{\\alpha+k}{\\beta+1}$$\n分析师使用估计的完备度 $\\widehat{E}$，通过关系式 $f = \\frac{\\mu}{N_{\\star} \\widehat{E}}$ 来推断发生率 $f$。在此假设下，$f$ 的后验均值（我们记为 $\\langle f \\rangle_{\\widehat{E}}$）可以通过对 $\\mu$ 的后验分布求期望得到：\n$$\\langle f \\rangle_{\\widehat{E}} = E\\left[\\frac{\\mu}{N_{\\star} \\widehat{E}} \\Big| k\\right] = \\frac{1}{N_{\\star} \\widehat{E}} E[\\mu|k] = \\frac{\\alpha+k}{N_{\\star} \\widehat{E} (\\beta+1)}$$\n如果使用真实的完备度 $E$，则 $f$ 的后验均值（记为 $\\langle f \\rangle_{E}$）将是：\n$$\\langle f \\rangle_{E} = E\\left[\\frac{\\mu}{N_{\\star} E} \\Big| k\\right] = \\frac{1}{N_{\\star} E} E[\\mu|k] = \\frac{\\alpha+k}{N_{\\star} E (\\beta+1)}$$\n乘法偏差因子是分析师推断的后验均值与真实后验均值的比率：\n$$\\text{偏差因子} = \\frac{\\langle f \\rangle_{\\widehat{E}}}{\\langle f \\rangle_{E}} = \\frac{\\frac{\\alpha+k}{N_{\\star} \\widehat{E} (\\beta+1)}}{\\frac{\\alpha+k}{N_{\\star} E (\\beta+1)}} = \\frac{N_{\\star} E (\\beta+1)}{N_{\\star} \\widehat{E} (\\beta+1)} = \\frac{E}{\\widehat{E}}$$\n问题陈述 $\\widehat{E} = (1+\\delta) E$。将此代入偏差因子的表达式中：\n$$\\text{偏差因子} = \\frac{E}{(1+\\delta)E} = \\frac{1}{1+\\delta}$$\n给定 $\\delta = 0.1$，偏差因子的数值为：\n$$\\text{偏差因子} = \\frac{1}{1+0.1} = \\frac{1}{1.1} = \\frac{10}{11}$$\n\n### 第 2 部分：对数线性模型截距的加法位移\n\n在多区间情况下，一个对数线性模型将发生率 $f_i$ 与周期 $P_i$ 关联起来：\n$$\\ln f_i = \\theta_0 + \\theta_1 \\ln P_i$$\n假设该模型描述了发生率的后验估计。我们用 $f_i$ 表示区间 $i$ 中“真实”的后验均值发生率（即使用真实完备度 $E_i$ 会得到的那个值）。\n\n完备度错误估计是均匀的，即对于所有区间 $i=1, \\dots, m$，有 $\\widehat{E}_i = (1+\\delta) E_i$。根据第 1 部分的结果，分析师估计的后验均值发生率 $\\widehat{f}_i$ 在每个区间都受到相同因子的系统性偏差：\n$$\\widehat{f}_i = \\frac{1}{1+\\delta} f_i$$\n对这个关系式取自然对数得到：\n$$\\ln \\widehat{f}_i = \\ln\\left( \\frac{1}{1+\\delta} f_i \\right) = \\ln f_i - \\ln(1+\\delta)$$\n现在，我们代入 $\\ln f_i$ 的真实对数线性模型：\n$$\\ln \\widehat{f}_i = (\\theta_0 + \\theta_1 \\ln P_i) - \\ln(1+\\delta)$$\n重新整理这个表达式，使其与拟合有偏数据 $\\widehat{f}_i$ 的对数线性模型形式相匹配：\n$$\\ln \\widehat{f}_i = (\\theta_0 - \\ln(1+\\delta)) + \\theta_1 \\ln P_i$$\n分析师将一个形式为 $\\ln \\widehat{f}_i = \\widehat{\\theta}_0 + \\widehat{\\theta}_1 \\ln P_i$ 的模型拟合到有偏的估计值上。通过比较 $\\ln \\widehat{f}_i$ 的两个表达式的系数，我们可以确定有偏的参数：\n$$\\widehat{\\theta}_0 = \\theta_0 - \\ln(1+\\delta)$$\n$$\\widehat{\\theta}_1 = \\theta_1$$\n问题要求的是截距参数 $\\theta_0$ 中引起的加法位移，即 $\\Delta\\theta_0 = \\widehat{\\theta}_0 - \\theta_0$。从上述关系中，我们发现：\n$$\\Delta\\theta_0 = -\\ln(1+\\delta)$$\n给定 $\\delta = 0.1$，加法位移是：\n$$\\Delta\\theta_0 = -\\ln(1+0.1) = -\\ln(1.1)$$\n\n最终答案要求一个包含乘法偏差因子和 $\\theta_0$ 的加法位移的二元行矩阵。\n第一个条目是 $\\frac{10}{11}$。\n第二个条目是 $-\\ln(1.1)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{10}{11}  -\\ln(1.1)\n\\end{pmatrix}\n}\n$$"
        }
    ]
}