{
    "hands_on_practices": [
        {
            "introduction": "任何凌星时间变化（TTV）分析的第一步都是将这些变化本身分离出来。这需要将一个简单的线性模型（假设轨道周期恒定）拟合到观测到的凌星时间数据上，然后计算残差。这项练习提供了数据分析的基础实践，从第一性原理推导加权最小二乘法，以确定最佳拟合的线性星历，并量化数据集中存在的TTV信号。理解这一过程对于正确描述TTV及其不确定性至关重要。",
            "id": "4187379",
            "problem": "对一颗凌日系外行星进行了多个时期的监测。凌日中点时间由线性星历 $t_{n} \\approx T_{0} + n P$ 建模，其中 $n \\in \\{0,1,2,\\dots\\}$ 是整数凌日编号，$T_{0}$ 是 $n=0$ 时的参考凌日中点时间，$P$ 是轨道周期。与严格周期性时间表的偏差被称为凌日时间变化（TTVs）。假设每次测量的凌日中点时间 $t_{n}$ 都有一个独立的高斯不确定度 $\\sigma_{n}$。\n\n从高斯误差的最大似然原理和卡方目标的定义出发，推导 $T_{0}$ 和 $P$ 的加权最小二乘估计量。然后，将您的推导应用于以下包含 $N=5$ 个凌日中点时间（单位为天，相对于任意参考点测量）和不确定度的数据集：\n- $n=0$: $t_{0} = 0.1010$, $\\sigma_{0} = 0.0010$\n- $n=1$: $t_{1} = 1.5990$, $\\sigma_{1} = 0.0010$\n- $n=2$: $t_{2} = 3.1020$, $\\sigma_{2} = 0.0010$\n- $n=3$: $t_{3} = 4.5985$, $\\sigma_{3} = 0.0010$\n- $n=4$: $t_{4} = 6.1010$, $\\sigma_{4} = 0.0010$\n\n计算加权最小二乘估计值 $\\hat{P}$ 和 $\\hat{T}_{0}$，构建凌日时间变化残差 $\\Delta t_{n} = t_{n} - (\\hat{T}_{0} + n \\hat{P})$，最后计算这些残差的加权均方根，\n$$\\sigma_{\\mathrm{TTV}} = \\sqrt{\\frac{\\sum_{n=0}^{N-1} w_{n} \\, (\\Delta t_{n})^{2}}{\\sum_{n=0}^{N-1} w_{n}}},$$\n其中 $w_{n} = 1/\\sigma_{n}^{2}$。\n\n以分钟为单位表示 $\\sigma_{\\mathrm{TTV}}$ 的最终值，并将您的最终答案四舍五入到四位有效数字。使用 $1\\,\\mathrm{day} = 1440\\,\\mathrm{minutes}$。不要报告中间值；仅报告 $\\sigma_{\\mathrm{TTV}}$ 以分钟为单位的单个最终值。",
            "solution": "该问题是有效的，因为它具有科学依据、提法明确且客观。它代表了系外行星科学中一个标准的数据分析任务。我们将首先推导线性星历参数的加权最小二乘估计量的一般表达式，然后将其应用于所提供的数据。\n\n第 $n$ 次凌日中点时间的模型是凌日编号 $n$ 的线性函数：\n$$ t_{\\text{model}, n} = T_{0} + n P $$\n其中 $T_{0}$ 是 $n=0$ 时的参考凌日中点时间，$P$ 是轨道周期。我们给定 $N$ 个测量的凌日中点时间 $t_{n}$，对于 $n \\in \\{0, 1, \\dots, N-1\\}$，每个时间都有一个独立的高斯不确定度 $\\sigma_{n}$。\n\n在给定模型参数 $T_{0}$ 和 $P$ 的情况下，观测到单个数据点 $t_{n}$ 的似然由高斯概率密度函数给出：\n$$ \\mathcal{P}(t_{n} | T_{0}, P) = \\frac{1}{\\sigma_{n} \\sqrt{2\\pi}} \\exp\\left( -\\frac{1}{2} \\left[ \\frac{t_{n} - (T_{0} + nP)}{\\sigma_{n}} \\right]^2 \\right) $$\n假设测量是独立的，整个数据集 $\\{t_{n}\\}$ 的总似然是各个概率的乘积：\n$$ \\mathcal{L}(T_{0}, P) = \\prod_{n=0}^{N-1} \\mathcal{P}(t_{n} | T_{0}, P) = \\left( \\prod_{n=0}^{N-1} \\frac{1}{\\sigma_{n}\\sqrt{2\\pi}} \\right) \\exp\\left( -\\frac{1}{2} \\sum_{n=0}^{N-1} \\left[ \\frac{t_{n} - T_{0} - nP}{\\sigma_{n}} \\right]^2 \\right) $$\n为了找到最大似然估计量（$\\hat{T}_{0}$，$\\hat{P}$），我们最大化 $\\mathcal{L}$。这等同于最大化对数似然 $\\ln\\mathcal{L}$：\n$$ \\ln\\mathcal{L}(T_{0}, P) = C - \\frac{1}{2} \\sum_{n=0}^{N-1} \\left( \\frac{t_{n} - T_{0} - nP}{\\sigma_{n}} \\right)^2 $$\n其中 $C$ 是一个不依赖于参数 $T_{0}$ 和 $P$ 的常数。最大化 $\\ln\\mathcal{L}$ 等同于最小化求和项，该求和项定义为卡方统计量 $\\chi^2$：\n$$ \\chi^2(T_{0}, P) = \\sum_{n=0}^{N-1} \\left( \\frac{t_{n} - T_{0} - nP}{\\sigma_{n}} \\right)^2 = \\sum_{n=0}^{N-1} w_{n} (t_{n} - T_{0} - nP)^2 $$\n其中权重定义为 $w_{n} = 1/\\sigma_{n}^2$。\n\n为了找到使 $\\chi^2$ 最小化的 $T_{0}$ 和 $P$ 的值，我们将 $\\chi^2$ 对每个参数的偏导数设为零。\n$$ \\frac{\\partial\\chi^2}{\\partial T_{0}} = \\sum_{n=0}^{N-1} 2 w_{n} (t_{n} - T_{0} - nP)(-1) = -2 \\left( \\sum w_{n}t_{n} - T_{0}\\sum w_{n} - P\\sum w_{n}n \\right) = 0 $$\n$$ \\frac{\\partial\\chi^2}{\\partial P} = \\sum_{n=0}^{N-1} 2 w_{n} (t_{n} - T_{0} - nP)(-n) = -2 \\left( \\sum w_{n}nt_{n} - T_{0}\\sum w_{n}n - P\\sum w_{n}n^2 \\right) = 0 $$\n这为估计量 $\\hat{T}_{0}$ 和 $\\hat{P}$ 产生了一个由两个线性方程组成的方程组：\n$$\n\\begin{cases}\n    \\hat{T}_{0} (\\sum w_{n}) + \\hat{P} (\\sum w_{n}n) = \\sum w_{n}t_{n} \\\\\n    \\hat{T}_{0} (\\sum w_{n}n) + \\hat{P} (\\sum w_{n}n^2) = \\sum w_{n}nt_{n}\n\\end{cases}\n$$\n使用克莱姆法则或矩阵求逆法求解该方程组，可得到加权最小二乘估计量：\n$$ \\hat{T}_{0} = \\frac{(\\sum w_{n}t_{n})(\\sum w_{n}n^2) - (\\sum w_{n}nt_{n})(\\sum w_{n}n)}{(\\sum w_{n})(\\sum w_{n}n^2) - (\\sum w_{n}n)^2} $$\n$$ \\hat{P} = \\frac{(\\sum w_{n})(\\sum w_{n}nt_{n}) - (\\sum w_{n}t_{n})(\\sum w_{n}n)}{(\\sum w_{n})(\\sum w_{n}n^2) - (\\sum w_{n}n)^2} $$\n至此，一般推导结束。\n\n现在，我们将其应用于给定的数据集。我们有 $n \\in \\{0, 1, 2, 3, 4\\}$ 的 $N=5$ 个数据点。不确定度均相等：对于所有 $n$，$\\sigma_{n} = 0.0010$。这意味着权重 $w_{n} = 1/\\sigma_{n}^2 = w$ 也是恒定的。在这种特殊情况下，权重 $w$ 在估计量表达式的分子和分母中被消去，问题简化为非加权线性最小二乘拟合。简化后的估计量为：\n$$ \\hat{T}_{0} = \\frac{(\\sum t_{n})(\\sum n^2) - (\\sum nt_{n})(\\sum n)}{N(\\sum n^2) - (\\sum n)^2} $$\n$$ \\hat{P} = \\frac{N(\\sum nt_{n}) - (\\sum t_{n})(\\sum n)}{N(\\sum n^2) - (\\sum n)^2} $$\n\n我们根据数据计算必要的总和：\n$t = \\{0.1010, 1.5990, 3.1020, 4.5985, 6.1010\\}$\n$n = \\{0, 1, 2, 3, 4\\}$\n$N = 5$\n$$ \\sum_{n=0}^{4} n = 0+1+2+3+4 = 10 $$\n$$ \\sum_{n=0}^{4} n^2 = 0^2+1^2+2^2+3^2+4^2 = 0+1+4+9+16 = 30 $$\n$$ \\sum_{n=0}^{4} t_{n} = 0.1010 + 1.5990 + 3.1020 + 4.5985 + 6.1010 = 15.5015 $$\n$$ \\sum_{n=0}^{4} nt_{n} = (0)(0.1010) + (1)(1.5990) + (2)(3.1020) + (3)(4.5985) + (4)(6.1010) = 46.0025 $$\n\n估计量的分母为：\n$$ D = N \\sum n^2 - (\\sum n)^2 = 5 \\times 30 - (10)^2 = 150 - 100 = 50 $$\n现在我们计算估计量：\n$$ \\hat{P} = \\frac{5 \\times 46.0025 - 15.5015 \\times 10}{50} = \\frac{230.0125 - 155.015}{50} = \\frac{74.9975}{50} = 1.49995 $$\n$$ \\hat{T}_{0} = \\frac{15.5015 \\times 30 - 46.0025 \\times 10}{50} = \\frac{465.045 - 460.025}{50} = \\frac{5.020}{50} = 0.1004 $$\n最佳拟合的线性星历为 $t_{n, \\text{model}} = 0.1004 + n \\times 1.49995$。\n\n接下来，我们计算凌日时间变化残差 $\\Delta t_{n} = t_{n} - t_{n, \\text{model}}$：\n$$ \\Delta t_{0} = 0.1010 - (0.1004 + 0 \\times 1.49995) = 0.0006 $$\n$$ \\Delta t_{1} = 1.5990 - (0.1004 + 1 \\times 1.49995) = -0.00135 $$\n$$ \\Delta t_{2} = 3.1020 - (0.1004 + 2 \\times 1.49995) = 0.0017 $$\n$$ \\Delta t_{3} = 4.5985 - (0.1004 + 3 \\times 1.49995) = -0.00175 $$\n$$ \\Delta t_{4} = 6.1010 - (0.1004 + 4 \\times 1.49995) = 0.0008 $$\n\n最后，我们计算这些残差的加权均方根：\n$$ \\sigma_{\\mathrm{TTV}} = \\sqrt{\\frac{\\sum_{n=0}^{N-1} w_{n} \\, (\\Delta t_{n})^{2}}{\\sum_{n=0}^{N-1} w_{n}}} $$\n由于所有权重 $w_{n}=w$ 相等，这简化为标准均方根：\n$$ \\sigma_{\\mathrm{TTV}} = \\sqrt{\\frac{w \\sum (\\Delta t_{n})^{2}}{w \\sum 1}} = \\sqrt{\\frac{\\sum (\\Delta t_{n})^{2}}{N}} $$\n我们计算残差的平方和：\n$$ \\sum (\\Delta t_{n})^{2} = (0.0006)^2 + (-0.00135)^2 + (0.0017)^2 + (-0.00175)^2 + (0.0008)^2 $$\n$$ \\sum (\\Delta t_{n})^{2} = 0.00000036 + 0.0000018225 + 0.00000289 + 0.0000030625 + 0.00000064 = 0.000008775 $$\n现在我们计算以天为单位的 $\\sigma_{\\mathrm{TTV}}$：\n$$ \\sigma_{\\mathrm{TTV}} = \\sqrt{\\frac{0.000008775}{5}} = \\sqrt{0.000001755} \\approx 0.0013248 \\, \\text{days} $$\n问题要求答案以分钟为单位，并四舍五入到四位有效数字。我们使用换算关系 $1\\,\\mathrm{day} = 1440\\,\\mathrm{minutes}$：\n$$ \\sigma_{\\mathrm{TTV}}[\\text{min}] = 0.00132480187... \\times 1440 \\approx 1.90771469... \\, \\text{minutes} $$\n四舍五入到四位有效数字得到 $1.908$。",
            "answer": "$$\\boxed{1.908}$$"
        },
        {
            "introduction": "一旦探测到TTV，下一步就是解释其模式。对于接近平均运动共振的行星，TTV通常是周期性的，但其周期并非简单地等于任何一颗行星的轨道周期。这项实践深入探讨了其背后的物理学原理，将观测到的TTV周期性与共振相互作用的“超周期”联系起来。通过推导这种关系，您将更深刻地理解引力扰动如何产生长期模式，而这些模式正是使TTV成为表征行星系统的有力工具的原因。",
            "id": "4187353",
            "problem": "一对共面的凌日行星在一颗恒星周围以近圆形轨道运行，其轨道周期分别为 $P_{1} = 10\\,\\mathrm{d}$（内行星）和 $P_{2} = 15.3\\,\\mathrm{d}$（外行星）。这对行星接近于 $3:2$ 的一阶平均运动共振，因此共振指数为 $j=3$。在小偏心率和弱相互扰动的极限情况下，使用以下基本依据：牛顿二体动力学（意味着开普勒运动）、开普勒平均运动 $n_{i} = 2\\pi/P_{i}$，以及形式为 $\\phi = j\\,\\lambda_{2} - (j-1)\\,\\lambda_{1} - \\varpi_{k}$ 的一阶共振角定义，其中 $\\lambda_{i}$ 是平均经度，$\\varpi_{k}$ 是近心点经度（$k \\in \\{1,2\\}$）。假设在所关注的时间尺度上，与 $\\phi$ 的近共振环流相比，$\\varpi_{k}$ 的长期进动可以忽略不计。\n\n从这些基本依据和定义出发（不引入任何专门的快捷公式），推导共振角的近共振环流频率的表达式，推断出相应的超周期 $P_{\\mathrm{sup}}$（即共振角前进 $2\\pi$ 所需的时间），并解释为什么凌日时间变化（TTVs）的主要长时标分量的周期预计约等于 $P_{\\mathrm{sup}}$。然后，根据给定的周期计算 $P_{\\mathrm{sup}}$，并给出预期的主要TTV周期。请以天为单位表示最终答案，并提供精确值（不进行四舍五入）。",
            "solution": "问题陈述经评估认为具有科学依据、适定、客观且自洽，因此被视为有效。我们继续进行完整解答。\n\n问题要求推导一对近一阶平均运动共振行星的近共振环流周期（通常称为超周期），并将该周期与凌日时间变化（TTVs）的主要时标联系起来。\n\n基本变量是平均经度 $\\lambda_{i}(t)$，它描述了每颗行星的平均轨道角。对于开普勒轨道，平均经度随时间线性演化：\n$$\n\\lambda_{i}(t) = n_{i}t + \\lambda_{i,0}\n$$\n其中 $\\lambda_{i,0}$ 是在时间 $t=0$ 时的平均经度，$n_{i}$ 是平均运动。平均运动通过以下定义与轨道周期 $P_{i}$ 相关联：\n$$\nn_{i} = \\frac{2\\pi}{P_{i}}\n$$\n\n问题涉及一对接近 $j:(j-1)$ 平均运动共振的行星。这种共振的状态由一个共振角 $\\phi$ 来描述。对于一阶共振，存在两个这样的角，分别对应每颗行星的近心点经度 $\\varpi_{1}$ 和 $\\varpi_{2}$。其通用形式为：\n$$\n\\phi = j\\,\\lambda_{2} - (j-1)\\,\\lambda_{1} - \\varpi_{k}\n$$\n其中 $k$ 可以是 $1$ 或 $2$。这个角的物理意义在于，它测量了行星会合位置相对于其中一个轨道的拱线（连接近心点和远心点的线）的位置。\n\n为了求出这个角的环流频率，我们对其取时间导数 $\\dot{\\phi}$：\n$$\n\\dot{\\phi} = \\frac{d\\phi}{dt} = j\\,\\frac{d\\lambda_{2}}{dt} - (j-1)\\,\\frac{d\\lambda_{1}}{dt} - \\frac{d\\varpi_{k}}{dt}\n$$\n根据平均经度的定义，其时间导数是平均运动，即 $\\dot{\\lambda}_{i} = n_{i}$。近心点经度的时间导数 $\\dot{\\varpi}_{k}$ 代表了长期拱线进动的速率。问题陈述中假设，在所关注的时间尺度上，与其他项的环流相比，这种进动可以忽略不计。对于未处于深度共振的系统，这是一个常见且有效的简化，其中共振动力学主导了较慢的长期效应。因此，我们设定 $\\dot{\\varpi}_{k} \\approx 0$。\n\n将这些代入 $\\dot{\\phi}$ 的表达式，得到近共振环流频率：\n$$\n\\dot{\\phi} \\approx j\\,n_{2} - (j-1)\\,n_{1}\n$$\n这个频率表示共振角 $\\phi$ 环流的速度。如果行星恰好处于共振状态，我们会有 $j\\,n_{2} - (j-1)\\,n_{1} = 0$，此时该角将仅因更慢的拱线进动而演化。由于行星是*接近*共振，这个量很小但非零，导致 $\\phi$ 的缓慢环流。\n\n超周期 $P_{\\mathrm{sup}}$ 定义为共振角 $\\phi$ 前进一个完整周期（$2\\pi$ 弧度）所需的时间。它是与频率 $\\dot{\\phi}$ 相关联的周期。\n$$\nP_{\\mathrm{sup}} = \\frac{2\\pi}{|\\dot{\\phi}|} = \\frac{2\\pi}{|j\\,n_{2} - (j-1)\\,n_{1}|}\n$$\n\n与TTVs的联系源于两颗行星之间的相互引力扰动。这些扰动导致每颗行星的轨道偏离完美的开普勒椭圆，从而导致凌日中点时间的变化。一颗行星对另一颗行星施加的引力的大小和方向取决于它们的相对位置。共振角 $\\phi$ 追踪了会合相对于轨道椭圆的重复几何构型。当 $\\phi$ 完成一个完整周期时，行星在其轨道上交换的引力“踢”的模式也完成一个完整周期。因此，这些扰动的累积效应（表现为TTV信号）会以这个长周期进行调制。因此，对于近共振行星对，TTVs的主要长时标分量的周期预计约等于超周期 $P_{\\mathrm{sup}}$。\n\n现在我们可以计算给定系统的 $P_{\\mathrm{sup}}$ 值。\n所提供的数据是：\n- 内行星周期： $P_{1} = 10\\,\\mathrm{d}$\n- 外行星周期： $P_{2} = 15.3\\,\\mathrm{d}$\n- 共振接近 $3:2$，因此共振指数为 $j=3$。\n\n首先，我们计算平均运动 $n_{1}$ 和 $n_{2}$：\n$$\nn_{1} = \\frac{2\\pi}{P_{1}} = \\frac{2\\pi}{10}\\,\\mathrm{rad}\\,\\mathrm{d}^{-1}\n$$\n$$\nn_{2} = \\frac{2\\pi}{P_{2}} = \\frac{2\\pi}{15.3}\\,\\mathrm{rad}\\,\\mathrm{d}^{-1}\n$$\n\n接下来，我们使用 $j=3$ 计算环流频率 $\\dot{\\phi}$：\n$$\n\\dot{\\phi} = 3\\,n_{2} - (3-1)\\,n_{1} = 3\\,n_{2} - 2\\,n_{1}\n$$\n$$\n\\dot{\\phi} = 3\\left(\\frac{2\\pi}{15.3}\\right) - 2\\left(\\frac{2\\pi}{10}\\right) = 2\\pi\\left(\\frac{3}{15.3} - \\frac{2}{10}\\right)\n$$\n为了简化表达式，我们可以将数字写成分数形式：$15.3 = \\frac{153}{10}$ 和 $\\frac{2}{10} = \\frac{1}{5}$。\n$$\n\\dot{\\phi} = 2\\pi\\left(\\frac{3}{153/10} - \\frac{1}{5}\\right) = 2\\pi\\left(\\frac{30}{153} - \\frac{1}{5}\\right)\n$$\n分数 $\\frac{30}{153}$ 可以通过分子分母同除以它们的最大公约数 $3$ 来进行简化。\n$$\n\\frac{30}{153} = \\frac{30 \\div 3}{153 \\div 3} = \\frac{10}{51}\n$$\n现在将此代回 $\\dot{\\phi}$ 的表达式中：\n$$\n\\dot{\\phi} = 2\\pi\\left(\\frac{10}{51} - \\frac{1}{5}\\right)\n$$\n我们找到一个公分母，即 $51 \\times 5 = 255$：\n$$\n\\dot{\\phi} = 2\\pi\\left(\\frac{10 \\times 5}{51 \\times 5} - \\frac{1 \\times 51}{5 \\times 51}\\right) = 2\\pi\\left(\\frac{50 - 51}{255}\\right) = 2\\pi\\left(-\\frac{1}{255}\\right) = -\\frac{2\\pi}{255}\\,\\mathrm{rad}\\,\\mathrm{d}^{-1}\n$$\n\n最后，我们计算超周期，也就是预期的主要TTV周期：\n$$\nP_{\\mathrm{sup}} = \\frac{2\\pi}{|\\dot{\\phi}|} = \\frac{2\\pi}{\\left|-\\frac{2\\pi}{255}\\right|} = \\frac{2\\pi}{\\frac{2\\pi}{255}} = 255\\,\\mathrm{d}\n$$\n因此，凌日时间变化的主要周期预计为 $255$ 天。",
            "answer": "$$\n\\boxed{255}\n$$"
        },
        {
            "introduction": "尽管许多近共振系统表现出可预测的周期性TTV，但有些系统可能会进入混沌状态。在这种情况下，简洁的正弦模式会在长时间尺度上瓦解，使得未来的凌星时间变得内在不确定。这项高级练习通过模拟混沌对长期凌星可预测性的影响，探索了TTV分析的前沿领域。通过实现一个包含指数发散和混沌扩散的模型，您将学习如何量化TTV预测的退化，并理解复杂动力系统中可预测性的极限。",
            "id": "4187381",
            "problem": "考虑一个通过凌星观测到的、处于近平均运动共振的双行星系统。凌星时间变化（TTVs）是由引力相互作用引起的，其由牛顿定律支配的内在动力学可以表现出具有有限李雅普诺夫指数的混沌。在长时间尺度上，共振角中的混沌扩散会降低未来凌星时间的可预测性。目标是量化这种混沌相对于非混沌模型所导致的预报不确定性增长，并为指定的测试用例生成算法输出。\n\n将凌星时间模型定义如下。第 $n$ 次凌星时间为\n$$\nt_n = t_0 + n P + A \\sin(\\phi_n),\n$$\n其中 $t_0$ 是一个参考历元，$P$ 是凌星行星的轨道周期，$A$ 是TTV振幅，而 $\\phi_n$ 是与近共振相互作用相关的相位。假设相位演化近似为一个映射\n$$\n\\phi_{n+1} = \\phi_n + \\omega + \\eta_n,\n$$\n其中 $\\omega$ 是每次凌星的平均相位推进，$\\eta_n$ 是一个零均值随机增量，其方差为 $\\mathrm{Var}(\\eta_n) = 2 D$，用于模拟共振角的混沌扩散。设每次凌星的局部李雅普诺夫指数为 $\\lambda$，因此一个小的初始相位不确定性 $\\delta \\phi_0$ 会按 $\\delta \\phi_n \\approx \\delta \\phi_0 \\mathrm{e}^{\\lambda n}$ 的规律增长。设振幅 $A$ 和轨道周期 $P$ 具有独立的标准差分别为 $\\sigma_A$ 和 $\\sigma_P$ 的不确定性。设初始相位不确定性为 $\\sigma_{\\phi 0}$。角度必须以弧度表示，时间以秒表示，李雅普诺夫指数以每次凌星（per transit）的倒数表示。\n\n从牛顿定律和标准定义出发：\n- 引力 $N$ 体动力学可以产生对初始条件的混沌敏感性，其特征是李雅普诺夫指数所描述的指数性发散。\n- 近共振系统中的TTVs可以在主导阶上近似为凌星时间的正弦调制。\n- 对于小误差，一阶线性化是有效的，并且独立的误差源可以进行正交叠加。\n\n您必须：\n1. 从所提供的模型和假设出发，推导在视界 $n$（以凌星次数计）处凌星时间预报标准差 $\\sigma_t(n)$ 的表达式，明确考虑由指数敏感性和扩散噪声共同导致的相位不确定性增长，并包括来自 $A$ 和 $P$ 不确定性的独立贡献。必要时对三角函数因子使用相位平均。所有中间和最终公式都必须从所述的基础和假设推导得出，不得引入未由此蕴含的快捷公式。\n2. 定义一个无混沌参考，其中 $\\lambda = 0$ 且 $D = 0$，并推导相应的预报标准差 $\\sigma_{t,\\mathrm{nc}}(n)$。\n3. 将退化因子定义为 $F(n) = \\sigma_t(n) / \\sigma_{t,\\mathrm{nc}}(n)$。\n4. 实现一个程序，对于每个测试用例，计算并输出一对 $[\\sigma_t(n), F(n)]$，其中 $\\sigma_t(n)$ 的单位为秒，$F(n)$ 为无量纲。计算必须使用从第1项推导出的表达式。\n\n测试套件参数以元组 $(P, A, \\sigma_{\\phi 0}, \\lambda, D, \\sigma_A, \\sigma_P, n)$ 的形式给出，并指定了单位。对于每个案例，报告 $\\sigma_t(n)$（单位为秒）和 $F(n)$（无量纲）的输出：\n- 案例1（一般近共振混沌，中等扩散）：$(P = 457920\\,\\text{s}, A = 120\\,\\text{s}, \\sigma_{\\phi 0} = 0.02\\,\\text{rad}, \\lambda = 0.01\\,\\text{per transit}, D = 1\\times 10^{-4}\\,\\text{rad}^2/\\text{transit}, \\sigma_A = 5\\,\\text{s}, \\sigma_P = 0.05\\,\\text{s}, n = 200)$。\n- 案例2（无指数敏感性，仅扩散混沌）：$(P = 699840\\,\\text{s}, A = 90\\,\\text{s}, \\sigma_{\\phi 0} = 0.03\\,\\text{rad}, \\lambda = 0\\,\\text{per transit}, D = 1\\times 10^{-3}\\,\\text{rad}^2/\\text{transit}, \\sigma_A = 4\\,\\text{s}, \\sigma_P = 0.02\\,\\text{s}, n = 300)$。\n- 案例3（强混沌，长视界）：$(P = 1036800\\,\\text{s}, A = 300\\,\\text{s}, \\sigma_{\\phi 0} = 0.01\\,\\text{rad}, \\lambda = 0.05\\,\\text{per transit}, D = 5\\times 10^{-4}\\,\\text{rad}^2/\\text{transit}, \\sigma_A = 2\\,\\text{s}, \\sigma_P = 0.01\\,\\text{s}, n = 500)$。\n- 案例4（零TTV振幅边缘情况）：$(P = 276480\\,\\text{s}, A = 0\\,\\text{s}, \\sigma_{\\phi 0} = 0.05\\,\\text{rad}, \\lambda = 0.02\\,\\text{per transit}, D = 2\\times 10^{-4}\\,\\text{rad}^2/\\text{transit}, \\sigma_A = 3\\,\\text{s}, \\sigma_P = 0.03\\,\\text{s}, n = 400)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个案例表示为一个使用十进制浮点数的双元素列表 $[\\sigma_t(n), F(n)]$。例如，输出格式必须类似于 $[[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4]]$，其中每个 $x_i$ 的单位是秒，每个 $y_i$ 是无量纲的。本任务不模拟凌星持续时间变化（TDVs）；仅考虑凌星时间变化（TTVs）。",
            "solution": "该问题要求推导表现出混沌动力学的双行星系统中凌星时间的预报不确定性，并实现一个程序来为特定的测试用例计算此不确定性。对问题陈述的验证确认了其科学基础扎实、问题设定良好，并包含足够的信息以获得唯一解。因此，我们可以进行推导和实现。\n\n主要目标是找到第 $n$ 次凌星时间的标准差 $\\sigma_t(n)$ 的表达式。凌星时间的模型给出如下：\n$$\nt_n = t_0 + n P + A \\sin(\\phi_n)\n$$\n这里，$t_n$ 是第 $n$ 次凌星的时间，$t_0$ 是一个假定精确已知的参考历元，$P$ 是平均轨道周期，$A$ 是凌星时间变化（TTV）的振幅，$\\phi_n$ 是一个相位角。受不确定性影响的参数是 $P$、$A$ 和随时间演化的相位 $\\phi_n$。初始不确定性给出为 $P$ 的 $\\sigma_P$、$A$ 的 $\\sigma_A$ 以及在 $n=0$ 时相位的 $\\sigma_{\\phi 0}$。这些被假定为独立的。\n\n根据独立变量的不确定性传播原理，函数 $f(x_1, x_2, \\dots, x_k)$ 的方差一阶近似为：\n$$\n\\sigma_f^2 \\approx \\sum_{i=1}^{k} \\left( \\frac{\\partial f}{\\partial x_i} \\right)^2 \\sigma_{x_i}^2\n$$\n我们将此应用于函数 $t_n(P, A, \\phi_n)$。所需的偏导数是：\n$$\n\\frac{\\partial t_n}{\\partial P} = n\n$$\n$$\n\\frac{\\partial t_n}{\\partial A} = \\sin(\\phi_n)\n$$\n$$\n\\frac{\\partial t_n}{\\partial \\phi_n} = A \\cos(\\phi_n)\n$$\n假设 $P$、$A$ 和 $\\phi_n$ 中的误差是独立的，$t_n$ 的方差可以表示为由各自方差加权的偏导数平方和：\n$$\n\\sigma_t^2(n) = \\left( \\frac{\\partial t_n}{\\partial P} \\right)^2 \\sigma_P^2 + \\left( \\frac{\\partial t_n}{\\partial A} \\right)^2 \\sigma_A^2 + \\left( \\frac{\\partial t_n}{\\partial \\phi_n} \\right)^2 \\sigma_{\\phi_n}^2\n$$\n$$\n\\sigma_t^2(n) = n^2 \\sigma_P^2 + \\sin^2(\\phi_n) \\sigma_A^2 + A^2 \\cos^2(\\phi_n) \\sigma_{\\phi_n}^2\n$$\n问题指定了对三角函数因子进行相位平均。这在物理上是合理的，因为 $\\phi_n$ 的确切值是未知的；我们感兴趣的是在所有可能相位上的期望不确定性。$\\sin^2(\\phi)$ 和 $\\cos^2(\\phi)$ 在一个完整周期 $[0, 2\\pi]$ 上的平均值均为 $\\frac{1}{2}$。应用此平均法：\n$$\n\\sigma_t^2(n) = n^2 \\sigma_P^2 + \\frac{1}{2} \\sigma_A^2 + \\frac{1}{2} A^2 \\sigma_{\\phi_n}^2\n$$\n下一步是推导在第 $n$ 次凌星时的相位方差 $\\sigma_{\\phi_n}^2$ 的表达式。总相位不确定性源于问题中描述的两个不同物理过程：由混沌引起的初始不确定性的指数增长（李雅普诺夫不稳定性）和随机扰动的累积（混沌扩散）。\n\n首先，考虑李雅普诺夫指数 $\\lambda$ 的效应。一个初始相位不确定性 $\\delta\\phi_0$ 随凌星次数 $n$ 指数增长，即 $\\delta\\phi_n \\approx \\delta\\phi_0 e^{\\lambda n}$。方差与不确定性的平方成比例，因此在第 $n$ 步时由初始不确定性 $\\sigma_{\\phi 0}$ 引起的相位方差分量是：\n$$\n\\sigma_{\\phi_n, \\mathrm{lyap}}^2 = \\left( \\sigma_{\\phi 0} e^{\\lambda n} \\right)^2 = \\sigma_{\\phi 0}^2 e^{2\\lambda n}\n$$\n其次，考虑扩散过程。相位演化被建模为一个映射 $\\phi_{k+1} = \\phi_k + \\omega + \\eta_k$，其中 $\\eta_k$ 是一个方差为 $\\mathrm{Var}(\\eta_k) = 2D$ 的随机零均值增量。通过展开递推关系，相位 $\\phi_n$ 取决于所有先前随机增量的总和：$\\phi_n = \\phi_0 + n\\omega + \\sum_{k=0}^{n-1} \\eta_k$。由于增量 $\\eta_k$ 是独立的，它们的和的方差是它们方差的和。这描述了一个随机游走过程。在第 $n$ 次凌星时，由该扩散引起的相位方差分量是：\n$$\n\\sigma_{\\phi_n, \\mathrm{diff}}^2 = \\mathrm{Var}\\left(\\sum_{k=0}^{n-1} \\eta_k\\right) = \\sum_{k=0}^{n-1} \\mathrm{Var}(\\eta_k) = \\sum_{k=0}^{n-1} (2D) = 2Dn\n$$\n总相位方差 $\\sigma_{\\phi_n}^2$ 是这两个独立贡献之和：\n$$\n\\sigma_{\\phi_n}^2 = \\sigma_{\\phi_n, \\mathrm{lyap}}^2 + \\sigma_{\\phi_n, \\mathrm{diff}}^2 = \\sigma_{\\phi 0}^2 e^{2\\lambda n} + 2Dn\n$$\n将 $\\sigma_{\\phi_n}^2$ 的这个表达式代入我们的 $\\sigma_t^2(n)$ 方程，我们得到预报方差的最终公式：\n$$\n\\sigma_t^2(n) = n^2 \\sigma_P^2 + \\frac{1}{2}\\sigma_A^2 + \\frac{1}{2} A^2 \\left( \\sigma_{\\phi 0}^2 e^{2\\lambda n} + 2Dn \\right)\n$$\n预报标准差 $\\sigma_t(n)$ 是这个量的平方根：\n$$\n\\sigma_t(n) = \\sqrt{n^2 \\sigma_P^2 + \\frac{1}{2}\\sigma_A^2 + \\frac{1}{2} A^2 \\left( \\sigma_{\\phi 0}^2 e^{2\\lambda n} + 2Dn \\right)}\n$$\n这完成了第一个要求的推导。\n\n对于第二个要求，我们推导无混沌参考模型 $\\sigma_{t,\\mathrm{nc}}(n)$ 的预报标准差。该模型通过将混沌参数设置为零来定义：$\\lambda = 0$ 且 $D = 0$。将这些值代入一般方差表达式：\n$$\n\\sigma_{t,\\mathrm{nc}}^2(n) = n^2 \\sigma_P^2 + \\frac{1}{2}\\sigma_A^2 + \\frac{1}{2} A^2 \\left( \\sigma_{\\phi 0}^2 e^{2(0)n} + 2(0)n \\right)\n$$\n$$\n\\sigma_{t,\\mathrm{nc}}^2(n) = n^2 \\sigma_P^2 + \\frac{1}{2}\\sigma_A^2 + \\frac{1}{2} A^2 \\left( \\sigma_{\\phi 0}^2 e^0 \\right)\n$$\n$$\n\\sigma_{t,\\mathrm{nc}}^2(n) = n^2 \\sigma_P^2 + \\frac{1}{2}\\sigma_A^2 + \\frac{1}{2} A^2 \\sigma_{\\phi 0}^2\n$$\n相应的标准差是：\n$$\n\\sigma_{t,\\mathrm{nc}}(n) = \\sqrt{n^2 \\sigma_P^2 + \\frac{1}{2}\\sigma_A^2 + \\frac{1}{2} A^2 \\sigma_{\\phi 0}^2}\n$$\n这表示在一个非混沌系统中，仅由初始参数不确定性引起的预报不确定性增长。\n\n第三个要求是定义退化因子 $F(n)$，即混沌预报标准差与非混沌预报标准差之比：\n$$\nF(n) = \\frac{\\sigma_t(n)}{\\sigma_{t,\\mathrm{nc}}(n)} = \\frac{\\sqrt{n^2 \\sigma_P^2 + \\frac{1}{2}\\sigma_A^2 + \\frac{1}{2} A^2 \\left( \\sigma_{\\phi 0}^2 e^{2\\lambda n} + 2Dn \\right)}}{\\sqrt{n^2 \\sigma_P^2 + \\frac{1}{2}\\sigma_A^2 + \\frac{1}{2} A^2 \\sigma_{\\phi 0}^2}}\n$$\n该因子量化了由混沌动力学引入的额外不可预测性。大于 $1$ 的 $F(n)$ 值表示混沌降低了预报精度。\n\n现在将使用这些推导出的表达式来实现问题的计算部分。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the transit time forecast uncertainty and degradation factor\n    for a set of test cases involving chaotic planetary dynamics.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (P, A, sigma_phi0, lam, D, sigma_A, sigma_P, n)\n    # Units: times in seconds, angles in radians, lam in 1/transit, D in rad^2/transit\n    test_cases = [\n        # Case 1\n        (457920.0, 120.0, 0.02, 0.01, 1e-4, 5.0, 0.05, 200),\n        # Case 2\n        (699840.0, 90.0, 0.03, 0.0, 1e-3, 4.0, 0.02, 300),\n        # Case 3\n        (1036800.0, 300.0, 0.01, 0.05, 5e-4, 2.0, 0.01, 500),\n        # Case 4\n        (276480.0, 0.0, 0.05, 0.02, 2e-4, 3.0, 0.03, 400),\n    ]\n\n    results = []\n    for case in test_cases:\n        P, A, sigma_phi0, lam, D, sigma_A, sigma_P, n = case\n\n        # Calculate the components of the variance\n\n        # Uncertainty from the orbital period P\n        var_P = (n**2) * (sigma_P**2)\n\n        # Uncertainty from the TTV amplitude A\n        var_A = 0.5 * (sigma_A**2)\n\n        # --- Calculate variance for the chaotic model ---\n        \n        # Phase variance growth due to Lyapunov instability\n        phase_var_lyap = (sigma_phi0**2) * np.exp(2.0 * lam * n)\n        \n        # Phase variance growth due to chaotic diffusion\n        phase_var_diff = 2.0 * D * n\n        \n        # Total phase variance\n        total_phase_var = phase_var_lyap + phase_var_diff\n        \n        # Uncertainty from the phase evolution\n        var_phase_chaotic = 0.5 * (A**2) * total_phase_var\n\n        # Total variance for the chaotic model\n        total_var_chaotic = var_P + var_A + var_phase_chaotic\n        \n        # Forecast standard deviation (chaotic)\n        sigma_t = np.sqrt(total_var_chaotic)\n\n        # --- Calculate variance for the non-chaotic reference model ---\n\n        # Phase variance is constant in the non-chaotic case\n        phase_var_nc = sigma_phi0**2\n        \n        # Uncertainty from phase in the non-chaotic case\n        var_phase_nc = 0.5 * (A**2) * phase_var_nc\n\n        # Total variance for the non-chaotic model\n        total_var_nc = var_P + var_A + var_phase_nc\n        \n        # Forecast standard deviation (non-chaotic)\n        sigma_t_nc = np.sqrt(total_var_nc)\n        \n        # --- Calculate the degradation factor ---\n        \n        # The degradation factor F(n) is the ratio of the standard deviations\n        if sigma_t_nc > 0:\n            F_n = sigma_t / sigma_t_nc\n        else:\n            # Handle the case where sigma_t_nc is zero.\n            # If sigma_t is also zero, F_n is 1. If not, it's infinite.\n            # Based on the problem, sigma_t_nc should not be zero for the given test cases.\n            F_n = 1.0 if sigma_t == 0 else np.inf\n\n        results.append([sigma_t, F_n])\n\n    # Format the results into the required single-line string format\n    # Example: [[x1,y1],[x2,y2],[x3,y3],[x4,y4]]\n    result_str = \",\".join([f\"[{res[0]},{res[1]}]\" for res in results])\n    \n    # Final print statement in the exact required format.\n    print(f\"[{result_str}]\")\n\nsolve()\n\n```"
        }
    ]
}