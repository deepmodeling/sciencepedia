## 引言
在系外[行星科学](@entry_id:158926)的宏伟画卷中，凌星法（Transit Method）无疑是描绘我们对遥远世界认知的最重要画笔之一。当一颗行星从其母星前方经过时，会导致恒星亮度发生微弱而短暂的下降，这一现象所产生的光度时间序列，即凌星光变曲线，蕴含着关于该行星系统极为丰富的信息。然而，解读这些曲线背后隐藏的物理密码，远非简单测量光降深度所能及。它要求我们建立并运用一套精密的物理模型，这正是凌星光变曲线建模的核心所在。本文旨在系统性地解决从原始光度数据到精确物理[参数推断](@entry_id:753157)这一知识鸿沟，为研究生和科研人员提供一个全面的理论与实践指南。

本文将通过三个章节的递进式讲解，带领读者全面掌握凌星光变曲线建模的精髓。在“原理与机制”一章中，我们将从最基本的几何学出发，逐步引入[临边昏暗](@entry_id:157740)、轨道[偏心率](@entry_id:266900)乃至[引力昏暗](@entry_id:161776)等复杂的恒星物理效应，构建起一个综合性的理论框架。紧接着，“应用与跨学科联系”一章将展示这些模型如何应用于实际，不仅用于测量行星的半径和质量，更作为一种强大的工具，深入到[行星大气](@entry_id:148668)科学、[轨道动力学](@entry_id:161870)和恒星物理等交叉领域。最后，“动手实践”部分将通过具体的编程练习，引导读者处理[数值稳定性](@entry_id:175146)、观测效应校正等真实科研场景中的挑战。

让我们首先进入第一章，深入探索支撑整个凌星分析领域的基石——光变曲线的物理原理与核心机制。

## 原理与机制

本章旨在深入探讨系外行星凌星光变曲线建模的物理原理与核心机制。我们将从最基础的几何模型出发，逐步引入更复杂的[恒星物理学](@entry_id:190025)效应，最终建立一个能够与实际观测数据相比较的综合性理论框架。我们的目标是不仅理解光变曲线的“形态”，更要洞察其形态背后所蕴含的关于行星、其轨道以及其母星的丰富物理信息。

### 凌星的几何基础

理解凌星现象的第一步是建立一个简化的几何图像。在这个图像中，我们暂时忽略恒星表面亮度的不均匀性，将恒星和行星都视为完美的、不透明的圆盘。

#### 核心几何参数

一个凌星事件的几何形态主要由三个无量纲参数决定：

1.  **半径比 ($k$)**: 定义为行星半径 $R_p$ 与[恒星半径](@entry_id:161955) $R_\star$ 的比值，即 $k = R_p/R_\star$。这个参数直接决定了凌星的深度。

2.  **归一化半长轴 ($a/R_\star$)**: 定义为[行星轨道](@entry_id:179004)的半长轴 $a$ 与[恒星半径](@entry_id:161955) $R_\star$ 的比值。它描述了轨道尺度相对于恒星大小的比例。

3.  **[撞击参数](@entry_id:165532) ($b$)**: 这是描述凌星路径的关键参数。它定义为在凌星中点（即行星中心与恒星中心在[天球](@entry_id:158268)平面上投影距离最近的时刻），两者中心之间的投影距离，并以[恒星半径](@entry_id:161955) $R_\star$ 为单位进行归一化。[撞击参数](@entry_id:165532)的取值范围为 $0 \le b  1+k$。当 $b \ge 1+k$ 时，行星完全错开恒星，不发生凌星。

[撞击参数](@entry_id:165532) $b$ 本身并非一个独立的[轨道根数](@entry_id:1129191)，而是由轨道半长轴 $a$、[恒星半径](@entry_id:161955) $R_\star$ 以及[轨道倾角](@entry_id:1129192) $i$ 共同决定的。轨道倾角 $i$ 是指行星的轨道平[面法向量](@entry_id:749211)与观测者视线方向之间的夹角（$i=90^\circ$ 对应于完全侧向观测的“边缘”轨道）。对于一个[圆形轨道](@entry_id:178728)，我们可以通过简单的几何投影推导出它们之间的关系 ：

$b = \frac{a}{R_\star} \cos i$

这个关系式精确成立的背后，依赖于几个基本假设：行星轨道是严格的开普勒二体[圆形轨道](@entry_id:178728)，恒星是完美的球体，因此其在[天球](@entry_id:158268)上的投影是一个半径为 $R_\star$ 的正圆。在此基础上，凌星中点被精确定义为行星与恒星在[天球](@entry_id:158268)投影距离达到最小的时刻。值得注意的是，恒星的[临边昏暗](@entry_id:157740)、自转-轨道夹角等物理效应并不会改变这个纯粹的几何关系。

#### 均匀亮度模型（“箱型”模型）

最简单的物理模型是假设恒星表面具有均匀的亮度。在这种情况下，凌星期间观测到的[光通量](@entry_id:167624)下降正比于被行星遮挡的恒星表面积。凌星的最大深度 $\delta$（即[光通量](@entry_id:167624)下降的最大比例）就等于行星圆盘面积与恒星圆盘面积之比：

$\delta = \frac{\pi R_p^2}{\pi R_\star^2} = \left(\frac{R_p}{R_\star}\right)^2 = k^2$

在凌星的进入（ingress）和离开（egress）阶段，即行星圆盘部分遮挡恒星时，[光通量](@entry_id:167624)的变化取决于两个圆盘的重叠面积。这个重叠面积 $\mathcal{A}_{\text{overlap}}$ 可以通过几何方法精确计算。设 $z$ 为行星与恒星中心的瞬时投影距离（以 $R_\star$ 为单位），则归一化的[光通量](@entry_id:167624) $F(z, k)$ 可以表示为 ：

$F(z,k) = 1 - \frac{\mathcal{A}_{\text{overlap}}}{\pi R_\star^2}$

在部分重叠区域（$|1-k|  z  1+k$），经过推导，归一化[光通量](@entry_id:167624)的完整解析表达式为：

$F(z,k) = 1 - \frac{1}{\pi} \left[ k^{2}\arccos\left(\frac{z^{2}+k^{2}-1}{2zk}\right) + \arccos\left(\frac{z^{2}+1-k^{2}}{2z}\right) - \frac{1}{2}\sqrt{((1+k)^{2}-z^{2})(z^{2}-(1-k)^{2})} \right]$

这个公式构成了最基础的“箱型”或梯形光变曲线模型。

#### 几何参数的定性效应

基于均匀亮度模型，我们可以直观地理解各个几何参数如何影响光变曲线的形态 。

-   **半径比 $k$ 的影响**:
    -   **深度**: 如前所述，[凌星深度](@entry_id:1133353) $\delta$ 与 $k^2$ 成正比。一个半径大一倍的行星会产生四倍深的凌星。
    -   **时长**: 在 $k \ll 1$ 的小行星近似下，凌星的总时长 $T_{14}$（从第一次接触到第四次接触）对 $k$ 的依赖很弱。然而，进入/离开时长 $\tau$（从第一次接触到第二次接触）近似与 $k$ 成正比。这是因为 $\tau$ 大致对应行星走过自身直径所需的时间。

-   **[撞击参数](@entry_id:165532) $b$ 的影响**:
    -   **时长**: 当 $b$ 增加时，行星穿过恒星的弦长变短，因此总时长 $T_{14}$ 会减小。
    -   **形状**: 随着 $b$ 增加，凌星的进入/离开阶段在总时长中的占比（即 $\tau/T_{14}$）会显著增加，使得光变曲线的底部变窄，整体形状从“U”形向“V”形过渡。在小行星近似下，可以证明 $\tau$ 的绝对时长会随着 $b$ 的增加而增加，因为行星在恒星边缘处（投影）的切向速度分量减小。

-   **归一化半长轴 $a/R_\star$ 的影响**:
    -   **时长**: 凌星的时长反比于行星的轨道速度。根据[开普勒第三定律](@entry_id:157744)，$P^2 \propto a^3/M_\star$，轨道速度 $v_{\text{orb}} = 2\pi a/P$。如果保持[轨道周期](@entry_id:182572) $P$ 和[恒星质量](@entry_id:157648) $M_\star$ 不变（即 $a$ 固定），那么增加 $a/R_\star$ 意味着[恒星半径](@entry_id:161955) $R_\star$ 减小。这会导致行星相对于恒星的运动速度显得更快，从而使总时长 $T_{14}$ 和进入时长 $\tau$ 按比例缩短。
    -   **深度**: 在均匀亮度模型中，[凌星深度](@entry_id:1133353)仅取决于 $k$，因此改变 $a/R_\star$ 不会影响深度。

### 引入[恒星物理学](@entry_id:190025)：[临边昏暗](@entry_id:157740)

真实的恒星并非均匀发光体。从恒星中心到边缘（limb），其表面亮度会逐渐降低，这种现象称为**[临边昏暗](@entry_id:157740) (limb darkening)**。这是因为当我们观测恒星边缘时，我们的视线穿透的是[恒星大气](@entry_id:152088)层中更高、更冷、因而也更暗的层次。

#### [临边昏暗](@entry_id:157740)的数学描述

[临边昏暗](@entry_id:157740)通常用一个依赖于[方向余弦](@entry_id:170591) $\mu$ 的函数来描述。$\mu$ 定义为恒星表面某点法向量与观测者视线方向的夹角 $\gamma$ 的余弦，即 $\mu = \cos\gamma$。在[天球](@entry_id:158268)投影平面上，它与归一化[径向坐标](@entry_id:165186) $r$ 的关系为 $\mu = \sqrt{1 - (r/R_\star)^2}$。$\mu=1$ 对应恒星中心，$\mu=0$ 对应恒星边缘。

常用的[临边昏暗](@entry_id:157740)定律是一些关于 $(1-\mu)$ 的多项式。例如：

-   **线性[临边昏暗](@entry_id:157740)定律**: $I(\mu) = I_c [1 - u(1-\mu)]$
-   **二次[临边昏暗](@entry_id:157740)定律**: $I(\mu) = I_c [1 - u_1(1-\mu) - u_2(1-\mu)^2]$

其中 $I_c$ 是恒星中心的辐射强度，$u$、$u_1$ 和 $u_2$ 是[临边昏暗](@entry_id:157740)系数。

在建模时，通常会将恒星的总[光通量](@entry_id:167624)归一化为1。这意味着我们需要对[临边昏暗](@entry_id:157740)定律进行归一化，以确保盘面平均强度为1。通过对强度在恒星盘面上进行面积加权平均，可以推导出正确的归一化强度表达式 。例如，对于二次[临边昏暗](@entry_id:157740)定律，归一化后的强度为：

$I_{\text{quad}}(\mu) = \frac{1 - u_1(1-\mu) - u_2(1-\mu)^2}{1 - \frac{u_1}{3} - \frac{u_2}{6}}$

这个归一化步骤对于精确计算光变曲线至关重要。

#### [临边昏暗](@entry_id:157740)对光变曲线的影响

[临边昏暗](@entry_id:157740)效应显著地改变了光变曲线的形状：

-   光变曲线的底部不再是平坦的，而是呈现出圆滑的“U”形。这是因为当行星穿过恒星盘面时，它遮挡的区域亮度在不断变化。
-   与均匀亮度模型相比，[临边昏暗](@entry_id:157740)模型在进入和离开阶段会产生最显著的偏差。具体来说，如果我们用均匀亮度模型去拟合一个真实的、存在[临边昏暗](@entry_id:157740)的光变曲线，在[残差图](@entry_id:169585)中会看到明显的“尖角”或“犄角”(horns)结构。这些偏差的最大值出现在进入和离开阶段的中点附近 。其物理原因是，在这些时刻，行星盘面的一半正覆盖在恒星最暗的边缘区域，而另一半则覆盖着相对较亮的区域。这个区域恰好是恒星亮度梯度最陡峭的地方，因此与按面积比例计算的均匀亮度模型相比，实际[光通量](@entry_id:167624)的变化率差异最大。
-   [临边昏暗](@entry_id:157740)使得[凌星深度](@entry_id:1133353)也开始依赖于[撞击参数](@entry_id:165532) $b$。一个高[撞击参数](@entry_id:165532)的凌星（$b$ 值较大）发生在恒星较暗的边缘区域，因此其深度会比一个中心凌星（$b \approx 0$）要浅 。

### 先进的建模框架

将几何学与[恒星物理学](@entry_id:190025)结合起来，我们可以构建更精确的凌星模型。

#### Mandel  Agol (2002) 解析模型

Mandel和Agol在2002年提出的解析模型是现代凌星光变曲线建[模的基](@entry_id:156416)石。该方法的核心思想是将有[临边昏暗](@entry_id:157740)的凌星[光通量](@entry_id:167624)下降表示为一系列纯几何[积分的线性](@entry_id:189393)组合。对于前面提到的二次[临边昏暗](@entry_id:157740)定律，归一化的[光通量](@entry_id:167624)可以写作 ：

$F_{\text{quadratic}}(z,k) = 1 - \frac{(1-\gamma_{1}-\gamma_{2})\lambda_{e}(z,k)+(\gamma_{1}+2\gamma_{2})\lambda_{d}(z,k)-\gamma_{2}\eta_{d}(z,k)}{1-\frac{\gamma_{1}}{3}-\frac{\gamma_{2}}{6}}$

其中，$\lambda_e$, $\lambda_d$, 和 $\eta_d$ 是在行星遮挡区域上对 $1$, $\mu$, 和 $\mu^2$ 进行的归一化面积积分。这些积分函数仅依赖于几何参数 $z$ 和 $k$，并且存在解析表达式。该模型清晰地区分了不同的几何状态：

-   **无重叠**: $z \ge 1+k$
-   **部分重叠 (进入/离开)**: $|1-k|  z  1+k$
-   **完全进入**: 对于 $k \le 1$, 当 $z \le 1-k$ 时，行星完全在恒星盘面上。
-   **环食**: 对于 $k \ge 1$, 当 $z \le k-1$ 时，恒星完全被更大的行星遮挡，[光通量](@entry_id:167624)降为零。

这个框架优雅地将复杂的物理[问题分解](@entry_id:272624)为几何部分（由$z$和$k$决定的积分）和物理部分（由[临边昏暗](@entry_id:157740)系数决定的[线性组合](@entry_id:154743)系数）。

#### 轨道偏心率的影响

[行星轨道](@entry_id:179004)并非总是正圆形。引入**偏心率 (eccentricity, $e$)** 会使模型变得更加复杂。在偏心轨道中，行星的轨道速度和日心距都在不断变化。凌星不再以固定的时间间隔发生。

凌星的发生时刻取决于**近星点幅角 (argument of periastron, $\omega$)**，即从升交点到轨道近星点的角度。对于一个完全侧向 ($i=90^\circ$) 的偏心轨道，凌星中点发生在行星的**真近点角 (true anomaly, $f$)** 满足以下条件时 ：

$f_{\text{tr}} = \frac{\pi}{2} - \omega$

这意味着凌星通常不会发生在轨道的特定几何点上（例如，与食（行星被恒星遮挡）相隔半个周期），其精确相位取决于 $\omega$。对于非侧向轨道，凌星中点的定义变为行星在天空平面上的投影距离达到极小值的时刻，其求解更为复杂。

#### 二阶效应：[引力昏暗](@entry_id:161776)

对于快速自转的恒星（通常是早型星），其形状会因[离心力](@entry_id:173726)而变为赤道凸起的**[扁球体](@entry_id:161771)**。这导致了另一种重要的物理效应：**[引力昏暗](@entry_id:161776) (gravity darkening)**。根据von Zeipel定理，恒星表面的[有效引力](@entry_id:188792)越强，局域温度就越高，辐射也就越强。

快速自转的恒星，其两极的[有效引力](@entry_id:188792)大于赤道，因此**两极比赤道更热、更亮** 。这种表面亮度的非对称分布会对凌星光变曲线产生可观测的影响。如果恒星的自转轴在[天球](@entry_id:158268)上的投影与行星的轨道平面存在一个夹角 $\lambda$（即**自转-轨道夹角**不为零），那么行星在凌星路径上将扫过一个不对称的亮度分布。

这会导致光变曲线本身变得**不对称**，即进入阶段和离开阶段的形状不再是简单的镜像关系。例如，如果行星先穿过较亮的一半，再穿过较暗的一半，那么光变曲线下降的斜率会比上升的斜率更陡。这种不对称性的幅度和符号直接与 $\lambda$、[恒星自转](@entry_id:161595)速度 $\Omega$ 以及[引力昏暗](@entry_id:161776)效应的强度（由指数 $\beta$ 描述， $I \propto g_{\text{eff}}^\beta$）相关 。

### 模型与数据的连接

将理论模型应用于真实数据时，我们会遇到一些实际的挑战和必要的统计工具。

#### 参数简并性问题

在拟合光变曲线时，不同模型参数的效应可能会相互模仿，导致难以唯一确定它们的值，这就是**参数简并性 (degeneracy)**。一个经典的例子是[撞击参数](@entry_id:165532) $b$ 和[临边昏暗](@entry_id:157740)系数之间的简并性 。

如前所述，一个较大的[撞击参数](@entry_id:165532) $b$ 会使凌星发生在恒星较暗的边缘，从而使进入/离开阶段的斜率变缓。另一方面，更强的[临边昏暗](@entry_id:157740)（即更大的[临边昏暗](@entry_id:157740)系数）也会使恒星边缘更暗，同样导致斜率变缓。因此，在[单色光](@entry_id:178750)（single-wavelength）观测中，一个“高[撞击参数](@entry_id:165532) + 弱[临边昏暗](@entry_id:157740)”的模型可能会与一个“低[撞击参数](@entry_id:165532) + 强[临边昏暗](@entry_id:157740)”的模型产生非常相似的光变曲线。

打破这种简并性的关键在于**多色光 (multi-wavelength)** 同时观测。几何参数（如 $b$ 和 $k$）在物理上是**非色散的 (achromatic)**，即它们不随观测波长的改变而改变。然而，[临边昏暗](@entry_id:157740)效应是强烈的**色散的 (chromatic)**：[恒星大气](@entry_id:152088)在短波长（如蓝色）下通常更不透明，导致更强的[临边昏暗](@entry_id:157740)。通过联合拟合多波段的数据，要求所有波段共享同一套几何参数，而[临边昏暗](@entry_id:157740)系数则随波段变化，模型就能够有效地将几何效应与[恒星大气](@entry_id:152088)物理效应分离开来，从而更精确地测定所有参数 。

#### 统计框架：[似然函数](@entry_id:921601)

将模型与充满噪声的观测数据相连接的桥梁是统计学。最常用的方法是构建**[似然函数](@entry_id:921601) (likelihood function)** $\mathcal{L}$，它描述了在给定一组模型参数 $\boldsymbol{\theta}$ 的情况下，观测到当前数据集 $\{y_i\}$ 的概率。

假设观测噪声是**[高斯白噪声](@entry_id:749762)**，即每个数据点 $y_i$ 的误差 $\varepsilon_i = y_i - F(t_i; \boldsymbol{\theta})$ 都独立地服从一个均值为零、方差为 $\sigma_i^2$ 的正态分布（其中 $\sigma_i$ 是第 $i$ 个数据点的[测量不确定度](@entry_id:202473)）。那么，整个数据集的[似然函数](@entry_id:921601)就是每个数据点概率的乘积。在实践中，我们通常使用其对数形式，即**对数似然函数 (log-likelihood)** ：

$\ln \mathcal{L}(\boldsymbol{\theta}) = -\frac{1}{2} \sum_{i}\left[\frac{\left(y_i - F(t_i;\boldsymbol{\theta})\right)^2}{\sigma_i^2} + \ln(2\pi\sigma_i^2)\right]$

这个函数是参数估计的核心。最大化[对数似然函数](@entry_id:168593)可以得到参数的最大似然估计（Maximum Likelihood Estimation, MLE），而它也是更复杂的贝叶斯推断方法（如[马尔可夫链蒙特卡洛](@entry_id:138779)，MCMC）的基础。通过这个统计框架，我们将抽象的物理模型与具体的、充满不确定性的天文观测数据紧密地联系在了一起。