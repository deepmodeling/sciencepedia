{
    "hands_on_practices": [
        {
            "introduction": "The first step in analyzing any planetary climate system is to identify its potential equilibrium states, where energy and mass budgets are in balance. This exercise guides you through finding the steady-state temperature ($T^*$) and CO2 level ($P_{CO_2}^*$) where planetary energy balance and the carbon cycle are simultaneously satisfied. By transforming the governing non-linear equations into a solvable linear system, this practice reveals the elegant mathematical structure underlying the climate's stability and provides a robust method for calculating the equilibrium point .",
            "id": "4180382",
            "problem": "You are modeling a zero-dimensional climate-chemistry steady state for a rocky exoplanet in which the negative feedback from the carbonate-silicate cycle stabilizes the climate. The objective is to compute the equilibrium temperature $T^\\ast$ (in $\\text{K}$) and the equilibrium atmospheric carbon dioxide partial pressure $P_{CO_2}^\\ast$ (in $\\text{bar}$) by solving a coupled steady-state system derived from first principles: planetary energy balance against outgoing longwave radiation and mass balance between volcanic degassing and silicate weathering. The solution must also make clear how the greenhouse radiative forcing balances the weathering sink at steady state.\n\nFundamental base and parameterization:\n\n- The net absorbed stellar flux is $Q = (1-A) S_\\star / 4$ with $A$ the Bond albedo and $S_\\star$ the stellar constant at the planet’s orbit. This is a consequence of conservation of energy for a sphere illuminated by a star and Lambertian reflection.\n\n- Outgoing Longwave Radiation (OLR) is represented by a linearized form $OLR(T, P_{CO_2}) = A_{\\mathrm{OLR}} + B T - \\beta \\ln(P_{CO_2}/P_{\\mathrm{ref}})$, where $A_{\\mathrm{OLR}}$ and $B$ are empirical coefficients that summarize the thermal infrared emission properties of the atmosphere-surface system, $\\beta$ is a radiative forcing coefficient per natural logarithm change in carbon dioxide (CO$_2$), and $P_{\\mathrm{ref}}$ is a reference CO$_2$ partial pressure. This formulation consolidates well-tested climate model behaviors: at fixed composition, $OLR$ increases approximately linearly with $T$, and incremental greenhouse forcing from CO$_2$ is logarithmic in $P_{CO_2}$.\n\n- Carbon dioxide (CO$_2$) mass balance at the surface-atmosphere interface is $d P_{CO_2}/dt = V - W(T, P_{CO_2})$, where $V$ is the volcanic degassing source (assumed constant on multimillion-year timescales), and $W(T, P_{CO_2})$ is the silicate weathering sink. A physically motivated Arrhenius-like parameterization for weathering is $W(T, P_{CO_2}) = W_0 \\exp\\left(\\lambda_T (T - T_{\\mathrm{ref}})\\right) \\left(\\frac{P_{CO_2}}{P_{\\mathrm{ref}}}\\right)^n$, where $W_0$ is the baseline weathering at reference temperature $T_{\\mathrm{ref}}$ and reference pressure $P_{\\mathrm{ref}}$, $\\lambda_T$ captures the effective temperature sensitivity from kinetics and runoff, and $n$ captures the CO$_2$ dependence through acidity and biological effects.\n\nSteady-state conditions require simultaneously:\n- Energy balance: $Q = A_{\\mathrm{OLR}} + B T^\\ast - \\beta \\ln\\left(P_{CO_2}^\\ast / P_{\\mathrm{ref}}\\right)$.\n- Carbon dioxide balance: $V = W_0 \\exp\\left(\\lambda_T (T^\\ast - T_{\\mathrm{ref}})\\right) \\left(\\frac{P_{CO_2}^\\ast}{P_{\\mathrm{ref}}}\\right)^n$.\n\nYour task is to write a program that, for each parameter set in the test suite below, solves this system for $(T^\\ast, P_{CO_2}^\\ast)$, with $T^\\ast$ expressed in $\\text{K}$ and $P_{CO_2}^\\ast$ expressed in $\\text{bar}$, both as floating-point numbers. To enforce positivity and improve numerical stability, solve for the variables $(T, y)$ where $y \\equiv \\ln\\left(P_{CO_2}/P_{\\mathrm{ref}}\\right)$, and then recover $P_{CO_2}$ as $P_{\\mathrm{ref}} e^y$.\n\nTest suite (each test case is a tuple of parameters $(S_\\star, A, A_{\\mathrm{OLR}}, B, \\beta, T_{\\mathrm{ref}}, P_{\\mathrm{ref}}, W_0, \\lambda_T, n, V)$):\n- Case $1$ (Earth-like baseline):\n  - $S_\\star = 1361\\ \\text{W}\\,\\text{m}^{-2}$, $A = 0.3$, $A_{\\mathrm{OLR}} = -337.825\\ \\text{W}\\,\\text{m}^{-2}$, $B = 2.0\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$, $\\beta = 5.35\\ \\text{W}\\,\\text{m}^{-2}$,\n  - $T_{\\mathrm{ref}} = 288\\ \\text{K}$, $P_{\\mathrm{ref}} = 4\\times 10^{-4}\\ \\text{bar}$,\n  - $W_0 = 7\\times 10^{-5}\\ \\text{bar/Myr}$, $\\lambda_T = 0.06\\ \\text{K}^{-1}$, $n = 0.3$,\n  - $V = 7\\times 10^{-5}\\ \\text{bar/Myr}$.\n- Case $2$ (reduced degassing, same insolation and albedo):\n  - $S_\\star = 1361\\ \\text{W}\\,\\text{m}^{-2}$, $A = 0.3$, $A_{\\mathrm{OLR}} = -337.825\\ \\text{W}\\,\\text{m}^{-2}$, $B = 2.0\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$, $\\beta = 5.35\\ \\text{W}\\,\\text{m}^{-2}$,\n  - $T_{\\mathrm{ref}} = 288\\ \\text{K}$, $P_{\\mathrm{ref}} = 4\\times 10^{-4}\\ \\text{bar}$,\n  - $W_0 = 7\\times 10^{-5}\\ \\text{bar/Myr}$, $\\lambda_T = 0.06\\ \\text{K}^{-1}$, $n = 0.3$,\n  - $V = 3.5\\times 10^{-5}\\ \\text{bar/Myr}$.\n- Case $3$ (increased insolation, same degassing):\n  - $S_\\star = 1500\\ \\text{W}\\,\\text{m}^{-2}$, $A = 0.3$, $A_{\\mathrm{OLR}} = -337.825\\ \\text{W}\\,\\text{m}^{-2}$, $B = 2.0\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$, $\\beta = 5.35\\ \\text{W}\\,\\text{m}^{-2}$,\n  - $T_{\\mathrm{ref}} = 288\\ \\text{K}$, $P_{\\mathrm{ref}} = 4\\times 10^{-4}\\ \\text{bar}$,\n  - $W_0 = 7\\times 10^{-5}\\ \\text{bar/Myr}$, $\\lambda_T = 0.06\\ \\text{K}^{-1}$, $n = 0.3$,\n  - $V = 7\\times 10^{-5}\\ \\text{bar/Myr}$.\n- Case $4$ (lower albedo and stronger weathering sensitivity):\n  - $S_\\star = 1361\\ \\text{W}\\,\\text{m}^{-2}$, $A = 0.2$, $A_{\\mathrm{OLR}} = -337.825\\ \\text{W}\\,\\text{m}^{-2}$, $B = 2.0\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$, $\\beta = 5.35\\ \\text{W}\\,\\text{m}^{-2}$,\n  - $T_{\\mathrm{ref}} = 288\\ \\text{K}$, $P_{\\mathrm{ref}} = 4\\times 10^{-4}\\ \\text{bar}$,\n  - $W_0 = 7\\times 10^{-5}\\ \\text{bar/Myr}$, $\\lambda_T = 0.09\\ \\text{K}^{-1}$, $n = 0.7$,\n  - $V = 7\\times 10^{-5}\\ \\text{bar/Myr}$.\n\nAlgorithmic requirements:\n- For each case, compute $Q = (1-A) S_\\star / 4$ and solve the nonlinear system in $(T, y)$:\n  - $f_1(T, y) = Q - \\left(A_{\\mathrm{OLR}} + B T - \\beta y\\right) = 0$,\n  - $f_2(T, y) = V - W_0 \\exp\\left(\\lambda_T (T - T_{\\mathrm{ref}}) + n y\\right) = 0$.\n- Recover $P_{CO_2}^\\ast = P_{\\mathrm{ref}} \\exp(y^\\ast)$.\n- Return the pair $(T^\\ast, P_{CO_2}^\\ast)$ for each case.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a two-element list in the order $[T^\\ast, P_{CO_2}^\\ast]$, for the four test cases, for example: $[[T_1^\\ast,P_{CO_2,1}^\\ast],[T_2^\\ast,P_{CO_2,2}^\\ast],[T_3^\\ast,P_{CO_2,3}^\\ast],[T_4^\\ast,P_{CO_2,4}^\\ast]]$.\n- Ensure $T^\\ast$ is reported in $\\text{K}$ and $P_{CO_2}^\\ast$ is reported in $\\text{bar}$, both as floating-point numbers.",
            "solution": "The problem requires the determination of the steady-state surface temperature, $T^\\ast$, and atmospheric CO$_2$ partial pressure, $P_{CO_2}^\\ast$, for a rocky exoplanet. This state is governed by the coupled feedback between planetary energy balance and the carbonate-silicate cycle. The problem is scientifically well-grounded, mathematically well-posed, and provides all necessary parameters for a unique solution.\n\nThe steady-state condition is defined by two simultaneous equilibrium equations.\n\nFirst, the energy balance equation dictates that the net absorbed stellar flux, $Q$, must equal the outgoing longwave radiation, $OLR$. The absorbed flux is given by $Q = (1-A) S_\\star / 4$, where $S_\\star$ is the stellar constant and $A$ is the Bond albedo. The OLR is parameterized as a linear function of temperature $T$ and a logarithmic function of $P_{CO_2}$: $OLR(T, P_{CO_2}) = A_{\\mathrm{OLR}} + B T - \\beta \\ln(P_{CO_2}/P_{\\mathrm{ref}})$. At equilibrium $(T^\\ast, P_{CO_2}^\\ast)$, this gives our first governing equation:\n$$Q = A_{\\mathrm{OLR}} + B T^\\ast - \\beta \\ln\\left(\\frac{P_{CO_2}^\\ast}{P_{\\mathrm{ref}}}\\right) \\quad (1)$$\n\nSecond, the carbon cycle balance requires that the volcanic degassing source of CO$_2$, $V$, is exactly balanced by the silicate weathering sink, $W$. The weathering rate is parameterized with an Arrhenius-like dependence on temperature and a power-law dependence on CO$_2$ partial pressure: $W(T, P_{CO_2}) = W_0 \\exp\\left(\\lambda_T (T - T_{\\mathrm{ref}})\\right) \\left(\\frac{P_{CO_2}}{P_{\\mathrm{ref}}}\\right)^n$. At equilibrium, this gives our second governing equation:\n$$V = W_0 \\exp\\left(\\lambda_T (T^\\ast - T_{\\mathrm{ref}})\\right) \\left(\\frac{P_{CO_2}^\\ast}{P_{\\mathrm{ref}}}\\right)^n \\quad (2)$$\n\nTo solve this system, we adopt the change of variables suggested in the problem statement, letting $y = \\ln(P_{CO_2}/P_{\\mathrm{ref}})$. This implies $P_{CO_2}/P_{\\mathrm{ref}} = \\exp(y)$. Substituting this into our governing equations transforms the system.\n\nEquation (1) becomes:\n$$Q = A_{\\mathrm{OLR}} + B T^\\ast - \\beta y^\\ast$$\nRearranging for the unknown variables $(T^\\ast, y^\\ast)$ gives a linear equation:\n$$B T^\\ast - \\beta y^\\ast = Q - A_{\\mathrm{OLR}} \\quad (1')$$\n\nEquation (2) becomes:\n$$V = W_0 \\exp\\left(\\lambda_T (T^\\ast - T_{\\mathrm{ref}})\\right) \\left(\\exp(y^\\ast)\\right)^n$$\n$$V = W_0 \\exp\\left(\\lambda_T (T^\\ast - T_{\\mathrm{ref}}) + n y^\\ast\\right)$$\nTaking the natural logarithm of both sides linearizes this equation as well:\n$$\\ln\\left(\\frac{V}{W_0}\\right) = \\lambda_T (T^\\ast - T_{\\mathrm{ref}}) + n y^\\ast$$\nRearranging for the unknown variables yields:\n$$\\lambda_T T^\\ast + n y^\\ast = \\ln\\left(\\frac{V}{W_0}\\right) + \\lambda_T T_{\\mathrm{ref}} \\quad (2')$$\n\nThe problem of finding the equilibrium state $(T^\\ast, y^\\ast)$ is thus reduced to solving a system of two linear equations with two unknowns. We can express this system in matrix form, $M \\mathbf{x} = \\mathbf{c}$:\n$$\n\\begin{pmatrix} B & -\\beta \\\\ \\lambda_T & n \\end{pmatrix}\n\\begin{pmatrix} T^\\ast \\\\ y^\\ast \\end{pmatrix}\n=\n\\begin{pmatrix} Q - A_{\\mathrm{OLR}} \\\\ \\ln(V/W_0) + \\lambda_T T_{\\mathrm{ref}} \\end{pmatrix}\n$$\nA unique solution for $(T^\\ast, y^\\ast)$ exists if the determinant of the coefficient matrix $M$ is non-zero. The determinant is $D = \\det(M) = (B)(n) - (-\\beta)(\\lambda_T) = B n + \\beta \\lambda_T$. Given that the physical parameters $B$, $n$, $\\beta$, and $\\lambda_T$ are all positive constants, the determinant $D$ is strictly positive, guaranteeing a unique and stable solution.\n\nThe solution can be found by inverting the matrix $M$: $\\mathbf{x} = M^{-1} \\mathbf{c}$.\n$$\n\\begin{pmatrix} T^\\ast \\\\ y^\\ast \\end{pmatrix}\n=\n\\frac{1}{B n + \\beta \\lambda_T}\n\\begin{pmatrix} n & \\beta \\\\ -\\lambda_T & B \\end{pmatrix}\n\\begin{pmatrix} Q - A_{\\mathrm{OLR}} \\\\ \\ln(V/W_0) + \\lambda_T T_{\\mathrm{ref}} \\end{pmatrix}\n$$\nThis yields the analytical solutions for $T^\\ast$ and $y^\\ast$:\n$$T^\\ast = \\frac{n(Q - A_{\\mathrm{OLR}}) + \\beta(\\ln(V/W_0) + \\lambda_T T_{\\mathrm{ref}})}{B n + \\beta \\lambda_T}$$\n$$y^\\ast = \\frac{-\\lambda_T(Q - A_{\\mathrm{OLR}}) + B(\\ln(V/W_0) + \\lambda_T T_{\\mathrm{ref}})}{B n + \\beta \\lambda_T}$$\n\nOnce the equilibrium value $y^\\ast$ is computed, the equilibrium CO$_2$ partial pressure $P_{CO_2}^\\ast$ is recovered using the inverse transformation:\n$$P_{CO_2}^\\ast = P_{\\mathrm{ref}} \\exp(y^\\ast)$$\n\nThe algorithmic implementation will proceed by first defining the parameters for each test case. For each case, it will compute the constants $Q$, $C_1 = Q - A_{\\mathrm{OLR}}$, and $C_2 = \\ln(V/W_0) + \\lambda_T T_{\\mathrm{ref}}$. It will then use the analytical formulas derived above to directly\ncalculate $T^\\ast$ and $y^\\ast$. Finally, it will compute $P_{CO_2}^\\ast$ and store the pair $(T^\\ast, P_{CO_2}^\\ast)$ for output. This approach is superior to numerical root-finding algorithms as it is exact, computationally efficient, and not subject to convergence issues.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ... is not needed as an analytical solution exists.\n\ndef solve():\n    \"\"\"\n    Solves for the equilibrium temperature and CO2 partial pressure\n    for a planetary climate model with a carbonate-silicate cycle feedback.\n    \"\"\"\n    \n    # Test suite: (S_star, A, A_OLR, B, beta, T_ref, P_ref, W_0, lambda_T, n, V)\n    test_cases = [\n        # Case 1 (Earth-like baseline)\n        (1361.0, 0.3, -337.825, 2.0, 5.35, 288.0, 4e-4, 7e-5, 0.06, 0.3, 7e-5),\n        # Case 2 (reduced degassing)\n        (1361.0, 0.3, -337.825, 2.0, 5.35, 288.0, 4e-4, 7e-5, 0.06, 0.3, 3.5e-5),\n        # Case 3 (increased insolation)\n        (1500.0, 0.3, -337.825, 2.0, 5.35, 288.0, 4e-4, 7e-5, 0.06, 0.3, 7e-5),\n        # Case 4 (lower albedo, stronger weathering)\n        (1361.0, 0.2, -337.825, 2.0, 5.35, 288.0, 4e-4, 7e-5, 0.09, 0.7, 7e-5)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters\n        S_star, A, A_OLR, B, beta, T_ref, P_ref, W_0, lambda_T, n, V = case\n\n        # 1. Calculate intermediate constants for the linear system\n        # Net absorbed stellar flux\n        Q = (1.0 - A) * S_star / 4.0\n        \n        # Right-hand side of the linear system M*x = C\n        # C1 for the energy balance equation: B*T - beta*y = C1\n        C1 = Q - A_OLR\n        \n        # C2 for the carbon cycle equation: lambda_T*T + n*y = C2\n        # Note: V and W_0 can be equal, so log(1) is handled correctly.\n        C2 = np.log(V / W_0) + lambda_T * T_ref\n\n        # 2. Solve the 2x2 linear system for (T, y) analytically\n        # Determinant of the coefficient matrix\n        # M = [[B, -beta], [lambda_T, n]]\n        determinant = B * n + beta * lambda_T\n\n        # Solve for T_star (equilibrium temperature)\n        # T_star = (n*C1 + beta*C2) / determinant\n        T_star = (n * C1 + beta * C2) / determinant\n\n        # Solve for y_star (log of CO2 pressure ratio)\n        # y_star = (-lambda_T*C1 + B*C2) / determinant\n        y_star = (-lambda_T * C1 + B * C2) / determinant\n\n        # 3. Recover the equilibrium CO2 partial pressure\n        P_CO2_star = P_ref * np.exp(y_star)\n\n        results.append([T_star, P_CO2_star])\n\n    # Final print statement in the exact required format\n    # Format: [[T1,P_CO2_1],[T2,P_CO2_2],...]\n    output_str = '[' + ','.join([f'[{t},{p}]' for t, p in results]) + ']'\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Simply finding an equilibrium point is not enough; we must also determine if it is stable. A stable equilibrium acts as a planetary thermostat, pulling the climate back to the set point after a perturbation. This practice introduces formal linear stability analysis, a cornerstone of dynamical systems theory, by asking you to linearize the coupled climate-carbon model around its steady state to construct the Jacobian matrix.",
            "id": "4180387",
            "problem": "Consider the following minimal two-variable climate–carbon model grounded in planetary energy balance and the carbonate–silicate cycle. The state variables are surface temperature $T$ and atmospheric partial pressure of carbon dioxide $P_{CO_2}$. Time $t$ is measured in years. Let $T$ be in kelvin ($\\text{K}$), $P_{CO_2}$ be in bar ($\\text{bar}$), and all radiative fluxes be in watts per square meter ($\\text{W}\\,\\text{m}^{-2}$).\n\nThe model consists of an energy balance equation and a carbon budget equation:\n- Energy balance:\n$$\nC\\,\\frac{dT}{dt} \\;=\\; \\big(1-\\alpha\\big)\\,\\frac{S}{4} \\;-\\; \\mathrm{OLR}(T,P_{CO_2}),\n$$\nwhere $C$ is an effective heat capacity in $\\text{W}\\,\\text{yr}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$, $\\alpha$ is the planetary albedo (dimensionless), and $S$ is the stellar constant in $\\text{W}\\,\\text{m}^{-2}$. The outgoing longwave radiation $\\mathrm{OLR}$ is modeled as\n$$\n\\mathrm{OLR}(T,P_{CO_2}) \\;=\\; A \\;+\\; B\\,T \\;-\\; \\gamma\\,\\ln\\!\\left(\\frac{P_{CO_2}}{P_{\\mathrm{ref}}}\\right),\n$$\nwith constants $A$ in $\\text{W}\\,\\text{m}^{-2}$, $B$ in $\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$, $\\gamma$ in $\\text{W}\\,\\text{m}^{-2}$, and $P_{\\mathrm{ref}}$ in $\\text{bar}$.\n\n- Carbon budget:\n$$\n\\frac{dP_{CO_2}}{dt} \\;=\\; D \\;-\\; W(T,P_{CO_2}),\n$$\nwhere the silicate weathering sink $W$ is given by\n$$\nW(T,P_{CO_2}) \\;=\\; W_0 \\left(\\frac{P_{CO_2}}{P_{\\mathrm{ref}}}\\right)^{\\beta} \\exp\\!\\big(k\\,(T - T_0)\\big),\n$$\nwith $W_0$ and $D$ in $\\text{bar}\\,\\text{yr}^{-1}$, $\\beta$ dimensionless, $k$ in $\\text{K}^{-1}$, and $T_0$ in $\\text{K}$.\n\nAssume the reference state $(T^\\ast,P_{CO_2}^\\ast)$ satisfies $T^\\ast = T_0$ and $P_{CO_2}^\\ast = P_{\\mathrm{ref}}$, and an equilibrium is enforced by choosing $D = W_0$ and\n$$\nA \\;=\\; \\big(1-\\alpha\\big)\\,\\frac{S}{4} \\;-\\; B\\,T^\\ast \\;+\\; \\gamma \\ln\\!\\left(\\frac{P_{CO_2}^\\ast}{P_{\\mathrm{ref}}}\\right),\n$$\nso that $\\frac{dT}{dt} = 0$ and $\\frac{dP_{CO_2}}{dt} = 0$ at $(T^\\ast,P_{CO_2}^\\ast)$.\n\nTask:\n- Starting from the model definitions above and standard linearization, linearize the coupled system around $(T^\\ast,P_{CO_2}^\\ast)$ and compute the Jacobian matrix $J$ with entries $J_{ij} = \\frac{\\partial f_i}{\\partial x_j}$ evaluated at $(T^\\ast,P_{CO_2}^\\ast)$, where $x_1 = T$, $x_2 = P_{CO_2}$, $f_1 = \\frac{dT}{dt}$, and $f_2 = \\frac{dP_{CO_2}}{dt}$.\n- Use the Jacobian to compute the eigenvalues and assess local stability via their real parts. A stable climate attractor requires that the real parts of both eigenvalues are negative.\n- Your program must compute, for each test case, a boolean indicating stability and the two eigenvalue real parts in units of $\\text{yr}^{-1}$, rounded to six decimal places, ordered from the smaller to the larger real part.\n\nUse the following scientifically plausible parameter test suite. In all cases, set $T^\\ast = T_0$ and $P_{CO_2}^\\ast = P_{\\mathrm{ref}} = 3\\times 10^{-4}\\,\\text{bar}$, $S = 1361\\,\\text{W}\\,\\text{m}^{-2}$, $\\alpha = 0.3$, $B = 3.3\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$, $\\gamma = 5.35\\,\\text{W}\\,\\text{m}^{-2}$, and $T_0 = 288\\,\\text{K}$. Let $C$ be either computed from a $50\\,\\mathrm{m}$ mixed layer ocean or specified directly as noted below. To convert a heat capacity per unit area $C_J$ in $\\text{J}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$ to $C$ in $\\text{W}\\,\\text{yr}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$, use $C = C_J / \\left(3.15576\\times 10^{7}\\right)$.\n\nDefine the five test cases:\n- Case $1$ (Earth-like baseline):\n  - $C_J = 2.1\\times 10^{8}\\,\\text{J}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$,\n  - $W_0 = D = 3.0\\times 10^{-9}\\,\\text{bar}\\,\\text{yr}^{-1}$,\n  - $\\beta = 0.3$,\n  - $k = 0.07\\,\\text{K}^{-1}$.\n- Case $2$ (weak temperature dependence of weathering):\n  - $C_J = 2.1\\times 10^{8}\\,\\text{J}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$,\n  - $W_0 = D = 3.0\\times 10^{-9}\\,\\text{bar}\\,\\text{yr}^{-1}$,\n  - $\\beta = 0.3$,\n  - $k = 1.0\\times 10^{-6}\\,\\text{K}^{-1}$.\n- Case $3$ (reversed weathering–temperature response):\n  - $C_J = 2.1\\times 10^{8}\\,\\text{J}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$,\n  - $W_0 = D = 3.0\\times 10^{-9}\\,\\text{bar}\\,\\text{yr}^{-1}$,\n  - $\\beta = 0.3$,\n  - $k = -0.3\\,\\text{K}^{-1}$.\n- Case $4$ (very weak pressure dependence of weathering):\n  - $C_J = 2.1\\times 10^{8}\\,\\text{J}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$,\n  - $W_0 = D = 3.0\\times 10^{-9}\\,\\text{bar}\\,\\text{yr}^{-1}$,\n  - $\\beta = 0.01$,\n  - $k = 0.07\\,\\text{K}^{-1}$.\n- Case $5$ (small effective heat capacity):\n  - $C = 1.0\\,\\text{W}\\,\\text{yr}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$,\n  - $W_0 = D = 3.0\\times 10^{-9}\\,\\text{bar}\\,\\text{yr}^{-1}$,\n  - $\\beta = 0.3$,\n  - $k = 0.07\\,\\text{K}^{-1}$.\n\nImplementation requirements:\n- For cases where $C_J$ is specified, first compute $C$ in $\\text{W}\\,\\text{yr}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$ using $C = C_J / \\left(3.15576\\times 10^{7}\\right)$; otherwise use the provided $C$ directly.\n- Compute $A$ using the equilibrium condition above. Note that with $P_{CO_2}^\\ast = P_{\\mathrm{ref}}$, the logarithm term is zero.\n- Construct the Jacobian by evaluating the necessary partial derivatives at $(T^\\ast,P_{CO_2}^\\ast)$.\n- Compute the eigenvalues of the Jacobian and assess stability from their real parts.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of five elements, one per test case, each element itself being a list of the form $[\\text{stable}, \\lambda_1, \\lambda_2]$, where $\\text{stable}$ is a boolean, and $\\lambda_1 \\le \\lambda_2$ are the real parts of the eigenvalues in $\\text{yr}^{-1}$, each rounded to six decimal places. Example format (illustrative only): [[True,-0.123456,-0.000001],[False,0.001000,-0.500000],...].",
            "solution": "The problem requires a linear stability analysis of a coupled climate-carbon model around a specified equilibrium point. The analysis hinges on computing the Jacobian matrix of the system and evaluating its eigenvalues.\n\nThe state of the system is described by the vector $x = [T, P_{CO_2}]^T$, where $T$ is the surface temperature and $P_{CO_2}$ is the atmospheric partial pressure of carbon dioxide. The evolution of the system is governed by a pair of coupled ordinary differential equations, $\\frac{d\\vec{x}}{dt} = \\vec{f}(\\vec{x})$:\n$$\n\\frac{dT}{dt} = f_1(T, P_{CO_2}) = \\frac{1}{C} \\left[ (1-\\alpha)\\frac{S}{4} - \\mathrm{OLR}(T,P_{CO_2}) \\right]\n$$\n$$\n\\frac{dP_{CO_2}}{dt} = f_2(T, P_{CO_2}) = D - W(T,P_{CO_2})\n$$\nSubstituting the given expressions for the outgoing longwave radiation, $\\mathrm{OLR}$, and the silicate weathering sink, $W$:\n$$\nf_1(T, P_{CO_2}) = \\frac{1}{C} \\left[ (1-\\alpha)\\frac{S}{4} - \\left( A + BT - \\gamma\\ln\\left(\\frac{P_{CO_2}}{P_{\\mathrm{ref}}}\\right) \\right) \\right]\n$$\n$$\nf_2(T, P_{CO_2}) = D - W_0 \\left(\\frac{P_{CO_2}}{P_{\\mathrm{ref}}}\\right)^{\\beta} \\exp\\big(k(T - T_0)\\big)\n$$\nThe local stability of the system around the equilibrium point $(T^\\ast, P_{CO_2}^\\ast)$ is determined by the eigenvalues of the Jacobian matrix $J$, evaluated at this point. The Jacobian is defined as:\n$$\nJ = \\begin{pmatrix} J_{11} & J_{12} \\\\ J_{21} & J_{22} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial T} & \\frac{\\partial f_1}{\\partial P_{CO_2}} \\\\ \\frac{\\partial f_2}{\\partial T} & \\frac{\\partial f_2}{\\partial P_{CO_2}} \\end{pmatrix}\n$$\nWe compute each partial derivative in turn.\n\nFor $J_{11} = \\frac{\\partial f_1}{\\partial T}$:\n$$\n\\frac{\\partial f_1}{\\partial T} = \\frac{\\partial}{\\partial T} \\left\\{ \\frac{1}{C} \\left[ (1-\\alpha)\\frac{S}{4} - A - BT + \\gamma\\ln\\left(\\frac{P_{CO_2}}{P_{\\mathrm{ref}}}\\right) \\right] \\right\\} = -\\frac{B}{C}\n$$\nThis derivative is constant.\n\nFor $J_{12} = \\frac{\\partial f_1}{\\partial P_{CO_2}}$:\n$$\n\\frac{\\partial f_1}{\\partial P_{CO_2}} = \\frac{\\partial}{\\partial P_{CO_2}} \\left\\{ \\frac{1}{C} \\left[ \\dots + \\gamma\\ln(P_{CO_2}) - \\gamma\\ln(P_{\\mathrm{ref}}) \\right] \\right\\} = \\frac{1}{C} \\left( \\frac{\\gamma}{P_{CO_2}} \\right) = \\frac{\\gamma}{C \\cdot P_{CO_2}}\n$$\n\nFor $J_{21} = \\frac{\\partial f_2}{\\partial T}$:\n$$\n\\frac{\\partial f_2}{\\partial T} = \\frac{\\partial}{\\partial T} \\left\\{ D - W_0 \\left(\\frac{P_{CO_2}}{P_{\\mathrm{ref}}}\\right)^{\\beta} \\exp\\big(k(T - T_0)\\big) \\right\\} = - W_0 \\left(\\frac{P_{CO_2}}{P_{\\mathrm{ref}}}\\right)^{\\beta} \\exp\\big(k(T - T_0)\\big) \\cdot k = -k \\cdot W(T,P_{CO_2})\n$$\n\nFor $J_{22} = \\frac{\\partial f_2}{\\partial P_{CO_2}}$:\n$$\n\\frac{\\partial f_2}{\\partial P_{CO_2}} = \\frac{\\partial}{\\partial P_{CO_2}} \\left\\{ D - W_0 \\frac{P_{CO_2}^{\\beta}}{P_{\\mathrm{ref}}^{\\beta}} \\exp\\big(k(T - T_0)\\big) \\right\\} = -W_0 \\frac{\\beta P_{CO_2}^{\\beta-1}}{P_{\\mathrm{ref}}^{\\beta}} \\exp\\big(k(T - T_0)\\big)\n$$\nThis can be simplified by factoring out $W(T,P_{CO_2})$:\n$$\n\\frac{\\partial f_2}{\\partial P_{CO_2}} = - \\frac{\\beta}{P_{CO_2}} \\left[ W_0 \\left(\\frac{P_{CO_2}}{P_{\\mathrm{ref}}}\\right)^{\\beta} \\exp\\big(k(T - T_0)\\big) \\right] = -\\frac{\\beta \\cdot W(T,P_{CO_2})}{P_{CO_2}}\n$$\nThe equilibrium point is defined by $T^\\ast = T_0$ and $P_{CO_2}^\\ast = P_{\\mathrm{ref}}$. At this point, the weathering function simplifies to $W(T^\\ast, P_{CO_2}^\\ast) = W_0 (P_{\\mathrm{ref}}/P_{\\mathrm{ref}})^{\\beta} \\exp(k(T_0 - T_0)) = W_0 (1)^\\beta e^0 = W_0$.\n\nWe now evaluate the Jacobian elements at $(T^\\ast, P_{CO_2}^\\ast)$:\n$$\nJ_{11} \\Big|_{(T^\\ast, P_{CO_2}^\\ast)} = -\\frac{B}{C}\n$$\n$$\nJ_{12} \\Big|_{(T^\\ast, P_{CO_2}^\\ast)} = \\frac{\\gamma}{C \\cdot P_{CO_2}^\\ast} = \\frac{\\gamma}{C \\cdot P_{\\mathrm{ref}}}\n$$\n$$\nJ_{21} \\Big|_{(T^\\ast, P_{CO_2}^\\ast)} = -k \\cdot W(T^\\ast, P_{CO_2}^\\ast) = -k \\cdot W_0\n$$\n$$\nJ_{22} \\Big|_{(T^\\ast, P_{CO_2}^\\ast)} = -\\frac{\\beta \\cdot W(T^\\ast, P_{CO_2}^\\ast)}{P_{CO_2}^\\ast} = -\\frac{\\beta \\cdot W_0}{P_{\\mathrm{ref}}}\n$$\nThus, the Jacobian matrix to be used for computation is:\n$$\nJ = \\begin{pmatrix}\n-\\frac{B}{C} & \\frac{\\gamma}{C \\cdot P_{\\mathrm{ref}}} \\\\\n-k \\cdot W_0 & -\\frac{\\beta \\cdot W_0}{P_{\\mathrm{ref}}}\n\\end{pmatrix}\n$$\nThe system is locally stable if and only if the real parts of both eigenvalues of $J$ are negative. For each test case, we will substitute the given parameter values, construct this matrix, and compute its eigenvalues.\n\nThe implementation will first convert heat capacity $C_J$ in units of $\\text{J}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$ to $C$ in $\\text{W}\\,\\text{yr}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$ using the conversion factor $1 \\text{ year} = 3.15576 \\times 10^7 \\text{ seconds}$, so $C = C_J / (3.15576 \\times 10^7)$. Note that the parameter $A$ is defined to ensure equilibrium but is not required for the stability analysis, as constant terms vanish upon differentiation. The eigenvalues will be computed numerically, their real parts extracted and sorted, and the stability determined. The final output is formatted as a list of lists, with each inner list containing a boolean for stability and the two rounded real parts of the eigenvalues.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the stability of a climate-carbon model for five test cases.\n\n    This function calculates the Jacobian matrix for a two-variable (temperature and CO2)\n    climate model at its equilibrium point. It then computes the eigenvalues of the\n    Jacobian to assess the local stability for each of five parameter scenarios.\n    The results, including a stability boolean and the real parts of the two eigenvalues\n    (in yr^-1, sorted and rounded), are formatted and printed as a single line.\n    \"\"\"\n    # Define global constants based on the problem statement\n    P_ref = 3e-4          # Reference CO2 pressure in bar\n    B = 3.3               # OLR temperature dependence in W m^-2 K^-1\n    gamma = 5.35          # OLR CO2 dependence in W m^-2\n    seconds_per_year = 3.15576e7  # s/yr for unit conversion\n\n    # Define the five test cases as a list of dictionaries\n    test_cases = [\n        # Case 1: Earth-like baseline\n        {'C_J': 2.1e8, 'W0': 3.0e-9, 'beta': 0.3, 'k': 0.07, 'C_direct': None},\n        # Case 2: Weak temperature dependence of weathering\n        {'C_J': 2.1e8, 'W0': 3.0e-9, 'beta': 0.3, 'k': 1.0e-6, 'C_direct': None},\n        # Case 3: Reversed weathering-temperature response\n        {'C_J': 2.1e8, 'W0': 3.0e-9, 'beta': 0.3, 'k': -0.3, 'C_direct': None},\n        # Case 4: Very weak pressure dependence of weathering\n        {'C_J': 2.1e8, 'W0': 3.0e-9, 'beta': 0.01, 'k': 0.07, 'C_direct': None},\n        # Case 5: Small effective heat capacity\n        {'C_J': None, 'W0': 3.0e-9, 'beta': 0.3, 'k': 0.07, 'C_direct': 1.0},\n    ]\n\n    all_results_formatted = []\n\n    for case in test_cases:\n        C_J = case['C_J']\n        W0 = case['W0']\n        beta = case['beta']\n        k = case['k']\n        C_direct = case['C_direct']\n\n        # Calculate the effective heat capacity C in W yr m^-2 K^-1\n        if C_J is not None:\n            C = C_J / seconds_per_year\n        else:\n            C = C_direct\n\n        # Define elements of the Jacobian matrix, evaluated at the equilibrium point,\n        # using the derived analytical expressions.\n        # J = [[df1/dT, df1/dPco2], [df2/dT, df2/dPco2]]\n        J11 = -B / C\n        J12 = gamma / (C * P_ref)\n        J21 = -k * W0\n        J22 = -beta * W0 / P_ref\n\n        # Construct the Jacobian matrix using a NumPy array\n        J = np.array([[J11, J12], [J21, J22]])\n\n        # Compute the eigenvalues of the Jacobian matrix\n        eigenvalues = np.linalg.eigvals(J)\n\n        # Extract the real parts of the eigenvalues and sort them in ascending order\n        real_parts = np.sort(eigenvalues.real)\n\n        # Determine stability: the system is stable if all real parts are negative\n        is_stable = bool(np.all(real_parts < 0))\n\n        # Format the results for the current case as a string\n        # [stable_boolean, rounded_lambda_1, rounded_lambda_2]\n        lambda1_re = real_parts[0]\n        lambda2_re = real_parts[1]\n        \n        case_result_str = (\n            f\"[{str(is_stable)},\"\n            f\"{lambda1_re:.6f},\"\n            f\"{lambda2_re:.6f}]\"\n        )\n        all_results_formatted.append(case_result_str)\n\n    # Print the final output as a single-line comma-separated list of results\n    print(f\"[{','.join(all_results_formatted)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The true power of the carbonate-silicate cycle lies in its ability to maintain habitable conditions over vast timescales, even as stellar luminosity changes. This exercise applies the modeling framework to one of the most significant topics in astrobiology: defining the habitable zone, where you will model how the geochemical feedback allows a planet to self-regulate its temperature by adjusting its atmospheric $P_{CO_2}$. By numerically solving for the steady state under varying levels of stellar insolation, you will quantify how this feedback mechanism dramatically extends the outer boundary of the liquid water habitable zone, a crucial concept for identifying potentially life-bearing exoplanets .",
            "id": "4180370",
            "problem": "Consider a zero-dimensional energy balance model of an Earth-like exoplanet with a carbonate-silicate cycle. The model couples radiative equilibrium, parameterized greenhouse forcing by carbon dioxide, and silicate weathering kinetics. The objective is to determine steady-state atmospheric carbon dioxide partial pressure and surface temperature at different stellar insolations, and to quantify how the negative feedback mediated by silicate weathering extends the outer edge of the habitable zone.\n\nFundamental base:\n- Radiative equilibrium at the top of the atmosphere is modeled by the Stefan–Boltzmann law and net radiative forcing. Let $\\sigma$ denote the Stefan–Boltzmann constant, $A$ the planetary Bond albedo, $S$ the stellar insolation (star-planet distance and stellar luminosity determine this), $T$ the globally averaged surface temperature, $F_{\\mathrm{base}}$ a baseline non-carbon-dioxide greenhouse forcing (e.g., from water vapor and background atmospheric constituents), and $\\kappa$ the radiative forcing coefficient for carbon dioxide. The equilibrium energy balance is\n$$\n\\sigma T^4 = \\frac{(1 - A) S}{4} + F_{\\mathrm{base}} + \\kappa \\ln\\!\\left(\\frac{P_{\\mathrm{CO_2}}}{P_{\\mathrm{ref}}}\\right),\n$$\nwhere $P_{\\mathrm{CO_2}}$ is the carbon dioxide partial pressure and $P_{\\mathrm{ref}}$ is a fixed reference carbon dioxide partial pressure.\n- The carbonate-silicate cycle provides a negative feedback via temperature- and carbon dioxide-dependent silicate weathering. Let $W(P_{\\mathrm{CO_2}}, T)$ denote the global silicate weathering flux and $F_v$ the volcanic degassing flux. In a long-term steady state for atmospheric carbon dioxide,\n$$\nW(P_{\\mathrm{CO_2}}, T) = F_v.\n$$\nA widely used empirical form for $W$ that captures both the direct concentration effect and thermally activated kinetics is\n$$\nW(P_{\\mathrm{CO_2}}, T) = W_0 \\left(\\frac{P_{\\mathrm{CO_2}}}{P_{\\mathrm{ref}}}\\right)^{\\alpha} \\exp\\!\\big(\\beta (T - T_{\\mathrm{ref}})\\big),\n$$\nwhere $W_0$ and $T_{\\mathrm{ref}}$ are reference values chosen such that $W(P_{\\mathrm{ref}}, T_{\\mathrm{ref}}) = F_v$, and $\\alpha$ and $\\beta$ are dimensionless and inverse-temperature coefficients, respectively, characterizing the sensitivity of weathering to carbon dioxide and temperature. This form implies the negative feedback: lower $S$ tends to lower $T$, which reduces weathering and allows $P_{\\mathrm{CO_2}}$ to increase until $W$ again balances $F_v$.\n\nYou must implement a program that, given the parameters below, solves for the steady-state carbon dioxide and temperature $(P_{\\mathrm{CO_2}}^\\ast, T^\\ast)$ consistent with the energy balance and weathering equilibrium for specified insolations. The solution must be obtained by logically combining the base laws and definitions above. Do not rely on any shortcut formulas beyond these bases.\n\nParameter values and units to be used:\n- $\\sigma = 5.670374419 \\times 10^{-8}$ in $\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-4}$.\n- $A = 0.30$ (dimensionless).\n- $S_0 = 1361$ in $\\text{W}\\,\\text{m}^{-2}$.\n- $T_{\\mathrm{ref}} = 288$ in $\\text{K}$.\n- $P_{\\mathrm{ref}} = 2.8 \\times 10^{-4}$ in $\\text{bar}$.\n- $F_{\\mathrm{base}}$ should be determined so that at $(S_0, P_{\\mathrm{ref}})$, the energy balance yields $T = T_{\\mathrm{ref}}$.\n- $\\kappa = 5.35$ in $\\text{W}\\,\\text{m}^{-2}$ per unit natural logarithm change in carbon dioxide.\n- $F_v = 1.0$ in normalized flux units (set the reference weathering $W_0$ equal to $F_v$ to satisfy $W(P_{\\mathrm{ref}}, T_{\\mathrm{ref}}) = F_v$).\n- $\\alpha = 0.4$ (dimensionless).\n- $\\beta = 0.06$ in $\\text{K}^{-1}$.\n\nDefinitions and tasks:\n1. For each insolation value $S$ in the test suite, the steady state $(P_{\\mathrm{CO_2}}^\\ast, T^\\ast)$ must satisfy both equations above simultaneously. The canonical approach is to reduce the system to a single scalar equation in $P_{\\mathrm{CO_2}}$ by expressing $T$ from the energy balance and substituting into the weathering equation. You must solve for $P_{\\mathrm{CO_2}}^\\ast$ numerically, ensuring a physically meaningful solution with $P_{\\mathrm{CO_2}}^\\ast$ in $\\text{bar}$ and $T^\\ast$ in $\\text{K}$.\n2. Define the liquid-water criterion by $T \\ge T_{\\mathrm{freeze}}$, with $T_{\\mathrm{freeze}} = 273.15$ in $\\text{K}$.\n3. Compute the minimum insolation $S_{\\min}^{\\mathrm{no\\;fb}}$ in $\\text{W}\\,\\text{m}^{-2}$ required to satisfy $T \\ge T_{\\mathrm{freeze}}$ under a case with no carbonate-silicate feedback (i.e., fixed $P_{\\mathrm{CO_2}} = P_{\\mathrm{ref}}$).\n4. Compute the minimum insolation $S_{\\min}^{\\mathrm{fb}}$ in $\\text{W}\\,\\text{m}^{-2}$ required to satisfy $T^\\ast \\ge T_{\\mathrm{freeze}}$ when the carbonate-silicate cycle feedback operates (i.e., $P_{\\mathrm{CO_2}}$ is allowed to adjust to steady state via the weathering equilibrium).\n\nAngle units are not applicable. All physical quantities must be expressed in the units indicated above. All required outputs must be rounded to three decimal places.\n\nTest suite:\n- Case 1 (happy path): $S = 1361$ in $\\text{W}\\,\\text{m}^{-2}$.\n- Case 2 (moderate reduction): $S = 1000$ in $\\text{W}\\,\\text{m}^{-2}$.\n- Case 3 (near outer edge): $S = 850$ in $\\text{W}\\,\\text{m}^{-2}$.\n- Outer-edge thresholds: $S_{\\min}^{\\mathrm{fb}}$ and $S_{\\min}^{\\mathrm{no\\;fb}}$ as defined above.\n\nYour program must produce a single line of output containing a comma-separated list enclosed in square brackets. The list must contain, in order,\n- $T^\\ast$ for Case 1 in $\\text{K}$,\n- $P_{\\mathrm{CO_2}}^\\ast$ for Case 1 in $\\text{bar}$,\n- $T^\\ast$ for Case 2 in $\\text{K}$,\n- $P_{\\mathrm{CO_2}}^\\ast$ for Case 2 in $\\text{bar}$,\n- $T^\\ast$ for Case 3 in $\\text{K}$,\n- $P_{\\mathrm{CO_2}}^\\ast$ for Case 3 in $\\text{bar}$,\n- $S_{\\min}^{\\mathrm{fb}}$ in $\\text{W}\\,\\text{m}^{-2}$,\n- $S_{\\min}^{\\mathrm{no\\;fb}}$ in $\\text{W}\\,\\text{m}^{-2}$.\n\nEach number must be rounded to three decimal places. For example, the output format must be exactly like\n`[T1,P1,T2,P2,T3,P3,Smin_fb,Smin_nofb]`,\nwhere each placeholder is replaced by the computed rounded float. Scientific realism requires that the solutions be physically plausible and that the carbonate-silicate feedback demonstrates an extension of the outer habitable zone, i.e., $S_{\\min}^{\\mathrm{fb}} < S_{\\min}^{\\mathrm{no\\;fb}}$.",
            "solution": "The problem has been assessed and is determined to be valid. It is scientifically grounded in established principles of planetary climate modeling, is well-posed with a complete and consistent set of definitions and constraints, and is expressed in objective, formal language. The problem presents a standard, yet substantive, exercise in solving a coupled non-linear system representative of climate-geochemical feedbacks.\n\nThe solution proceeds in four stages:\n1.  Determination of the baseline greenhouse forcing constant, $F_{\\mathrm{base}}$.\n2.  Derivation of a single, non-linear equation for the steady-state surface temperature, $T^\\ast$, by combining the energy balance and weathering equilibrium equations.\n3.  Numerical solution for the steady-state temperature $T^\\ast$ and subsequent calculation of the steady-state carbon dioxide partial pressure $P_{\\mathrm{CO_2}}^\\ast$ for the three specified insolation cases.\n4.  Analytical calculation of the minimum insolation thresholds for maintaining liquid water ($T \\ge T_{\\mathrm{freeze}}$), both with ($S_{\\min}^{\\mathrm{fb}}$) and without ($S_{\\min}^{\\mathrm{no\\;fb}}$) the carbonate-silicate feedback.\n\n**1. Determination of $F_{\\mathrm{base}}$**\n\nThe problem specifies that the baseline non-CO$_2$ greenhouse forcing, $F_{\\mathrm{base}}$, must be set such that the reference state ($S=S_0 , P_{\\mathrm{CO_2}}=P_{\\mathrm{ref}}$) yields the reference temperature $T=T_{\\mathrm{ref}}$. The energy balance equation is:\n$$\n\\sigma T^4 = \\frac{(1 - A) S}{4} + F_{\\mathrm{base}} + \\kappa \\ln\\!\\left(\\frac{P_{\\mathrm{CO_2}}}{P_{\\mathrm{ref}}}\\right)\n$$\nSubstituting the reference values $S_0 = 1361 \\, \\text{W}\\,\\text{m}^{-2}$, $T_{\\mathrm{ref}} = 288 \\, \\text{K}$, and $P_{\\mathrm{CO_2}} = P_{\\mathrm{ref}}$, the logarithmic term becomes $\\kappa \\ln(1) = 0$. We can then solve for $F_{\\mathrm{base}}$:\n$$\nF_{\\mathrm{base}} = \\sigma T_{\\mathrm{ref}}^4 - \\frac{(1 - A) S_0}{4}\n$$\nUsing the provided constants $\\sigma = 5.670374419 \\times 10^{-8} \\, \\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-4}$, $A = 0.30$, and $T_{\\mathrm{ref}} = 288 \\, \\text{K}$:\n$$\nF_{\\mathrm{base}} = (5.670374419 \\times 10^{-8}) (288^4) - \\frac{(1 - 0.30) (1361)}{4} \\approx 390.071 - 238.175 = 151.896 \\, \\text{W}\\,\\text{m}^{-2}\n$$\nThis value of $F_{\\mathrm{base}}$ will be used for all subsequent calculations.\n\n**2. Derivation of the Steady-State Temperature Equation**\n\nThe system is defined by two simultaneous equations for the steady-state variables $(P_{\\mathrm{CO_2}}^\\ast, T^\\ast)$.\nEquation (I), Energy Balance:\n$$\n\\sigma (T^\\ast)^4 = \\frac{(1 - A) S}{4} + F_{\\mathrm{base}} + \\kappa \\ln\\!\\left(\\frac{P_{\\mathrm{CO_2}}^\\ast}{P_{\\mathrm{ref}}}\\right)\n$$\nEquation (II), Weathering Equilibrium:\n$$\nW_0 \\left(\\frac{P_{\\mathrm{CO_2}}^\\ast}{P_{\\mathrm{ref}}}\\right)^{\\alpha} \\exp\\!\\big(\\beta (T^\\ast - T_{\\mathrm{ref}})\\big) = F_v\n$$\nGiven $W_0 = F_v$, Equation (II) simplifies to:\n$$\n\\left(\\frac{P_{\\mathrm{CO_2}}^\\ast}{P_{\\mathrm{ref}}}\\right)^{\\alpha} \\exp\\!\\big(\\beta (T^\\ast - T_{\\mathrm{ref}})\\big) = 1\n$$\nWe can solve this for the term $\\ln(P_{\\mathrm{CO_2}}^\\ast / P_{\\mathrm{ref}})$ by taking the natural logarithm of both sides:\n$$\n\\alpha \\ln\\left(\\frac{P_{\\mathrm{CO_2}}^\\ast}{P_{\\mathrm{ref}}}\\right) + \\beta (T^\\ast - T_{\\mathrm{ref}}) = 0\n$$\n$$\n\\ln\\left(\\frac{P_{\\mathrm{CO_2}}^\\ast}{P_{\\mathrm{ref}}}\\right) = -\\frac{\\beta}{\\alpha} (T^\\ast - T_{\\mathrm{ref}})\n$$\nThis relationship shows that in steady-state, atmospheric CO$_2$ is a direct function of temperature. We substitute this expression back into the energy balance Equation (I):\n$$\n\\sigma (T^\\ast)^4 = \\frac{(1 - A) S}{4} + F_{\\mathrm{base}} - \\kappa \\frac{\\beta}{\\alpha} (T^\\ast - T_{\\mathrm{ref}})\n$$\nRearranging this into a root-finding form $f(T^\\ast) = 0$, we get:\n$$\nf(T^\\ast) = \\sigma (T^\\ast)^4 + \\frac{\\kappa \\beta}{\\alpha} (T^\\ast - T_{\\mathrm{ref}}) - \\frac{(1 - A) S}{4} - F_{\\mathrm{base}} = 0\n$$\nThis is a non-linear scalar equation for the steady-state temperature $T^\\ast$, which can be solved numerically for a given insolation $S$.\n\n**3. Solution for Test Cases**\n\nFor each $S$ in the test suite ($1361$, $1000$, and $850 \\, \\text{W}\\,\\text{m}^{-2}$), we will solve the equation $f(T^\\ast)=0$ using a numerical root-finding algorithm. Once $T^\\ast$ is found, the corresponding steady-state $P_{\\mathrm{CO_2}}^\\ast$ is calculated using the relationship derived from the weathering equilibrium:\n$$\nP_{\\mathrm{CO_2}}^\\ast = P_{\\mathrm{ref}} \\exp\\left(-\\frac{\\beta}{\\alpha}(T^\\ast - T_{\\mathrm{ref}})\\right)\n$$\nThe provided parameter values are $\\kappa=5.35$, $\\beta=0.06 \\, \\text{K}^{-1}$, $\\alpha=0.4$, $P_{\\mathrm{ref}}=2.8 \\times 10^{-4} \\, \\text{bar}$, and $T_{\\mathrm{ref}}=288 \\, \\text{K}$.\n\n- **Case 1 ($S = 1361 \\, \\text{W}\\,\\text{m}^{-2}$):** By construction, the solution is the reference state, $T^\\ast = T_{\\mathrm{ref}} = 288.000 \\, \\text{K}$ and $P_{\\mathrm{CO_2}}^\\ast = P_{\\mathrm{ref}} = 0.00028 \\, \\text{bar}$. This serves as a validation of our model setup.\n- **Case 2 ($S = 1000 \\, \\text{W}\\,\\text{m}^{-2}$) and Case 3 ($S = 850 \\, \\text{W}\\,\\text{m}^{-2}$):** Numerical solution of $f(T^\\ast)=0$ is required.\n\n**4. Calculation of Minimum Insolation Thresholds**\n\n- **$S_{\\min}^{\\mathrm{no\\;fb}}$ (No Feedback):**\nIn this scenario, $P_{\\mathrm{CO_2}}$ is fixed at $P_{\\mathrm{ref}}$. The energy balance equation simplifies because the logarithmic term is zero:\n$$\n\\sigma T^4 = \\frac{(1 - A) S}{4} + F_{\\mathrm{base}}\n$$\nThe minimum insolation $S_{\\min}^{\\mathrm{no\\;fb}}$ required to maintain a surface temperature of at least $T_{\\mathrm{freeze}} = 273.15 \\, \\text{K}$ is found by setting $T=T_{\\mathrm{freeze}}$ and solving for $S$:\n$$\nS_{\\min}^{\\mathrm{no\\;fb}} = \\frac{4}{1 - A} \\left( \\sigma T_{\\mathrm{freeze}}^4 - F_{\\mathrm{base}} \\right)\n$$\n\n- **$S_{\\min}^{\\mathrm{fb}}$ (With Feedback):**\nIn this scenario, the full feedback system is active. The minimum insolation $S_{\\min}^{\\mathrm{fb}}$ required to maintain a steady-state temperature of at least $T_{\\mathrm{freeze}}$ is found by setting $T^\\ast=T_{\\mathrm{freeze}}$ in the general steady-state temperature equation and solving for $S$:\n$$\n\\sigma T_{\\mathrm{freeze}}^4 = \\frac{(1 - A) S_{\\min}^{\\mathrm{fb}}}{4} + F_{\\mathrm{base}} - \\frac{\\kappa \\beta}{\\alpha} (T_{\\mathrm{freeze}} - T_{\\mathrm{ref}})\n$$\n$$\nS_{\\min}^{\\mathrm{fb}} = \\frac{4}{1 - A} \\left( \\sigma T_{\\mathrm{freeze}}^4 + \\frac{\\kappa \\beta}{\\alpha} (T_{\\mathrm{freeze}} - T_{\\mathrm{ref}}) - F_{\\mathrm{base}} \\right)\n$$\nSince $T_{\\mathrm{freeze}} < T_{\\mathrm{ref}}$, the term $(T_{\\mathrm{freeze}} - T_{\\mathrm{ref}})$ is negative. This makes the term added to the right-hand side, $\\frac{\\kappa \\beta}{\\alpha} (T_{\\mathrm{freeze}} - T_{\\mathrm{ref}})$, negative, thus demonstrating that $S_{\\min}^{\\mathrm{fb}} < S_{\\min}^{\\mathrm{no\\;fb}}$. This quantifies the extension of the outer edge of the habitable zone due to the silicate weathering feedback.\n\nThe implementation will now proceed by coding these derived formulas and the numerical root-finding procedure.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves for steady-state climate on an Earth-like exoplanet with a carbonate-silicate cycle.\n    \"\"\"\n    # Define physical and model constants from the problem statement.\n    SIGMA = 5.670374419e-8  # Stefan-Boltzmann constant (W m^-2 K^-4)\n    A = 0.30  # Planetary Bond albedo\n    S0 = 1361.0  # Reference insolation (W m^-2)\n    T_REF = 288.0  # Reference temperature (K)\n    P_REF = 2.8e-4  # Reference CO2 partial pressure (bar)\n    KAPPA = 5.35  # Radiative forcing coefficient for CO2 (W m^-2 / ln(P/P_ref))\n    FV = 1.0  # Volcanic degassing flux (normalized)\n    W0 = FV  # Reference weathering rate, set equal to FV\n    ALPHA = 0.4  # Weathering sensitivity to P_CO2\n    BETA = 0.06  # Weathering sensitivity to T (K^-1)\n    T_FREEZE = 273.15  # Freezing point of water (K)\n\n    # Step 1: Determine the baseline non-CO2 greenhouse forcing, F_base.\n    # F_base is calculated to ensure T=T_REF at S=S0 and P_CO2=P_REF.\n    f_base = SIGMA * T_REF**4 - (1 - A) * S0 / 4\n\n    # The test suite consists of three insolation values and two threshold calculations.\n    test_insolations = [1361.0, 1000.0, 850.0]\n    results = []\n\n    # Step 2: Define and solve for steady state for each insolation case.\n    for s_val in test_insolations:\n        # Define the function f(T) = 0 for the steady-state temperature.\n        # f(T) = sigma*T^4 + (kappa*beta/alpha)*(T-T_ref) - (1-A)*S/4 - F_base = 0\n        def temp_equation(T):\n            term1 = SIGMA * T**4\n            term2 = (KAPPA * BETA / ALPHA) * (T - T_REF)\n            term3 = (1 - A) * s_val / 4\n            return term1 + term2 - term3 - f_base\n\n        # Numerically solve for T_star using a robust root-finding method.\n        # A bracket is chosen to cover a physically plausible temperature range.\n        try:\n            sol = root_scalar(temp_equation, bracket=[150, 400], method='brentq')\n            t_star = sol.root\n        except ValueError:\n            # Handle cases where no root is found in the bracket\n            t_star = np.nan\n            \n        # Calculate P_CO2_star from the weathering equilibrium relationship.\n        # P_CO2_star = P_ref * exp(-(beta/alpha)*(T_star - T_ref))\n        p_co2_star = P_REF * np.exp(-(BETA / ALPHA) * (t_star - T_REF))\n\n        results.extend([round(t_star, 3), round(p_co2_star, 3)])\n\n    # Step 3: Compute the minimum insolation thresholds.\n    \n    # S_min with no feedback (fixed P_CO2 = P_REF).\n    # S_min_nofb = (4 / (1-A)) * (sigma * T_freeze^4 - F_base)\n    s_min_nofb = (4 / (1 - A)) * (SIGMA * T_FREEZE**4 - f_base)\n\n    # S_min with feedback.\n    # S_min_fb = (4/(1-A)) * (sigma*T_freeze^4 + (kappa*beta/alpha)*(T_freeze-T_ref) - F_base)\n    weathering_feedback_term = (KAPPA * BETA / ALPHA) * (T_FREEZE - T_REF)\n    s_min_fb = (4 / (1 - A)) * (SIGMA * T_FREEZE**4 + weathering_feedback_term - f_base)\n    \n    results.extend([round(s_min_fb, 3), round(s_min_nofb, 3)])\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{x:.3f}\" for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}