{
    "hands_on_practices": [
        {
            "introduction": "The thermal evolution of a rocky planet is largely dictated by convection within its silicate mantle. To understand this process, we must first determine the conditions under which convection begins, which is governed by the Rayleigh number ($Ra$), a dimensionless quantity comparing the driving force of buoyancy to the retarding forces of viscosity and thermal diffusion. This first exercise  guides you through a foundational derivation of the Rayleigh number from first principles and its application to an Earth-like planet, allowing you to assess whether its mantle is in a conductive or convective state.",
            "id": "4185567",
            "problem": "An Earth-like rocky exoplanet has a silicate mantle modeled as a constant-property, incompressible fluid under the Boussinesq approximation. The mantle is idealized as a horizontally extended layer of thickness $d$ heated from below with fixed temperatures at the top and bottom boundaries. The fluid obeys Newtonian rheology with constant dynamic viscosity $\\eta$, thermal diffusivity $\\kappa$, coefficient of thermal expansivity $\\alpha$, and reference density $\\rho$. Gravitational acceleration is $g$. The superadiabatic temperature drop across the mantle is $\\Delta T$. Assume no-slip, isothermal boundaries.\n\nFrom first principles, starting with conservation of mass, momentum, and energy under the Boussinesq approximation, nondimensionalize the governing equations using $d$ as the length scale and the diffusive time scale. Identify the nondimensional group controlling the onset of convection in a viscous layer heated from below and express it in terms of $\\alpha$, $\\rho$, $g$, $\\Delta T$, $d$, $\\eta$, and $\\kappa$. Then evaluate this group for the parameters below and determine, based on the classical linear stability threshold for no-slip, isothermal boundaries, whether the mantle is in the convective regime.\n\nUse the following parameter values (International System of Units):\n- Mantle thickness: $d = 2.8 \\times 10^{6}\\ \\mathrm{m}$\n- Dynamic viscosity: $\\eta = 5.0 \\times 10^{21}\\ \\mathrm{Pa\\,s}$\n- Thermal diffusivity: $\\kappa = 1.0 \\times 10^{-6}\\ \\mathrm{m^{2}\\,s^{-1}}$\n- Thermal expansivity: $\\alpha = 3.0 \\times 10^{-5}\\ \\mathrm{K^{-1}}$\n- Reference density: $\\rho = 4.50 \\times 10^{3}\\ \\mathrm{kg\\,m^{-3}}$\n- Gravitational acceleration: $g = 9.81\\ \\mathrm{m\\,s^{-2}}$\n- Superadiabatic temperature drop: $\\Delta T = 3.00 \\times 10^{2}\\ \\mathrm{K}$\n\nExpress the final value of the nondimensional group as a pure number, and round your answer to three significant figures. Do not include units. In addition, state in your reasoning whether the mantle is expected to be in the convective regime for these conditions.",
            "solution": "The problem is validated against the specified criteria.\n\n### Step 1: Extract Givens\n-   **System:** An Earth-like rocky exoplanet with a silicate mantle.\n-   **Model:** Constant-property, incompressible fluid under the Boussinesq approximation.\n-   **Geometry:** Horizontally extended layer of thickness $d$.\n-   **Thermal conditions:** Heated from below with fixed temperatures at the top and bottom boundaries.\n-   **Rheology:** Newtonian fluid with constant dynamic viscosity $\\eta$.\n-   **Properties:** Constant thermal diffusivity $\\kappa$, coefficient of thermal expansivity $\\alpha$, reference density $\\rho$.\n-   **External field:** Constant gravitational acceleration $g$.\n-   **Temperature difference:** Superadiabatic temperature drop across the mantle is $\\Delta T$.\n-   **Boundary conditions:** No-slip, isothermal boundaries.\n-   **Nondimensionalization scales:** Length scale is $d$, time scale is the diffusive time scale.\n-   **Parameter values:**\n    -   Mantle thickness: $d = 2.8 \\times 10^{6}\\ \\mathrm{m}$\n    -   Dynamic viscosity: $\\eta = 5.0 \\times 10^{21}\\ \\mathrm{Pa\\,s}$\n    -   Thermal diffusivity: $\\kappa = 1.0 \\times 10^{-6}\\ \\mathrm{m^{2}\\,s^{-1}}$\n    -   Thermal expansivity: $\\alpha = 3.0 \\times 10^{-5}\\ \\mathrm{K^{-1}}$\n    -   Reference density: $\\rho = 4.50 \\times 10^{3}\\ \\mathrm{kg\\,m^{-3}}$\n    -   Gravitational acceleration: $g = 9.81\\ \\mathrm{m\\,s^{-2}}$\n    -   Superadiabatic temperature drop: $\\Delta T = 3.00 \\times 10^{2}\\ \\mathrm{K}$\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem describes Rayleigh-Bénard convection, a fundamental and well-established phenomenon in fluid dynamics and geophysics. The Boussinesq approximation is standard for modeling mantle convection. The provided physical parameters are realistic for a terrestrial planet's mantle.\n-   **Well-Posed:** The problem is a classic linear stability analysis problem. It is self-contained, providing all necessary parameters and a clear objective: derive the governing dimensionless number (the Rayleigh number), calculate its value, and compare it to a known critical threshold. A unique and meaningful solution exists.\n-   **Objective:** The problem is stated using precise, standard scientific terminology. There are no subjective or ambiguous statements.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe problem asks for the derivation of the nondimensional group controlling convection, its evaluation, and a stability assessment based on that value. We begin with the governing equations for an incompressible fluid under the Boussinesq approximation.\n\nThe governing equations are:\n1.  **Conservation of Mass (Continuity):** For an incompressible fluid, the velocity field $\\mathbf{u}$ is solenoidal.\n    $$ \\nabla \\cdot \\mathbf{u} = 0 $$\n2.  **Conservation of Momentum (Navier-Stokes):**\n    $$ \\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\mathbf{u} \\right) = -\\nabla P + \\eta \\nabla^2 \\mathbf{u} + \\rho \\mathbf{g} $$\n    Here, $P$ is the pressure, $\\eta$ is the dynamic viscosity, and $\\mathbf{g}$ is the gravitational acceleration vector.\n3.  **Conservation of Energy (Heat Equation):**\n    $$ \\frac{\\partial T}{\\partial t} + \\mathbf{u} \\cdot \\nabla T = \\kappa \\nabla^2 T $$\n    Here, $T$ is the temperature and $\\kappa$ is the thermal diffusivity.\n\nThe Boussinesq approximation assumes that density variations are small and only affect the buoyancy term. The density $\\rho$ is related to a reference density $\\rho_0$ at a reference temperature $T_0$ by:\n$$ \\rho = \\rho_0 (1 - \\alpha (T-T_0)) $$\nwhere $\\alpha$ is the coefficient of thermal expansivity. The momentum equation can be written in terms of perturbations from a hydrostatic reference state. Let $P = P_{hydro} + p$ and $\\rho = \\rho_0 + \\rho'$, where $\\nabla P_{hydro} = \\rho_0 \\mathbf{g}$ and $\\rho' = -\\rho_0 \\alpha (T-T_0)$. For mantle convection, the viscous forces are dominant over inertial forces (infinite Prandtl number limit). The Prandtl number is $Pr = \\frac{\\nu}{\\kappa} = \\frac{\\eta}{\\rho_0 \\kappa}$. Using the given values, $Pr = \\frac{5.0 \\times 10^{21}}{(4.50 \\times 10^3)(1.0 \\times 10^{-6})} \\approx 1.1 \\times 10^{24}$, which is enormous. Thus, the inertial term $\\rho(\\partial_t \\mathbf{u} + \\mathbf{u}\\cdot\\nabla\\mathbf{u})$ is negligible. The momentum equation simplifies to the Stokes equation with a buoyancy term:\n$$ 0 = -\\nabla p + \\eta \\nabla^2 \\mathbf{u} - \\rho_0 \\alpha (T-T_0) \\mathbf{g} $$\nLet's set the coordinate system with the z-axis pointing upwards, so $\\mathbf{g} = -g \\hat{\\mathbf{z}}$. The temperature field is decomposed into a linear conductive profile $T_{cond}(z)$ and a perturbation $\\theta$:\n$$ T(x,y,z,t) = T_b - \\Delta T \\frac{z}{d} + \\theta(x,y,z,t) $$\nwhere $T_b$ is the temperature at the bottom boundary ($z=0$) and $\\Delta T$ is the superadiabatic temperature drop across the layer of thickness $d$. The buoyancy term can now be written in terms of the perturbation $\\theta$. The non-hydrostatic part of the buoyancy term is $-\\rho_0 \\alpha \\theta g$. The momentum equation becomes:\n$$ 0 = -\\nabla p_{dyn} + \\eta \\nabla^2 \\mathbf{u} + \\rho_0 \\alpha g \\theta \\hat{\\mathbf{z}} $$\nwhere $p_{dyn}$ is the dynamic pressure. Substituting the temperature decomposition into the energy equation gives:\n$$ \\frac{\\partial \\theta}{\\partial t} + (\\mathbf{u} \\cdot \\nabla) \\theta - u_z \\frac{\\Delta T}{d} = \\kappa \\nabla^2 \\theta $$\nwhere $u_z$ is the vertical component of velocity.\n\nWe now nondimensionalize these equations using the specified scales:\n-   Length: $\\mathbf{x}' = \\mathbf{x}/d$\n-   Time: $t' = t / (d^2/\\kappa)$\n-   Velocity: $\\mathbf{u}' = \\mathbf{u} / (\\kappa/d)$\n-   Temperature perturbation: $\\theta' = \\theta / \\Delta T$\n-   Dynamic pressure: $p'_{dyn} = p_{dyn} / (\\eta \\kappa / d^2)$\n\nSubstituting these into the Stokes and energy equations and dropping the primes for clarity:\n**Momentum Equation:**\n$$ 0 = -\\nabla \\left(p'_{dyn} \\frac{\\eta \\kappa}{d^2}\\right) + \\eta \\nabla^2 \\left(\\mathbf{u}' \\frac{\\kappa}{d}\\right) + \\rho_0 \\alpha g (\\theta' \\Delta T) \\hat{\\mathbf{z}} $$\n$$ 0 = -\\left(\\frac{\\eta \\kappa}{d^3}\\right) \\nabla' p'_{dyn} + \\left(\\frac{\\eta \\kappa}{d^3}\\right) \\nabla'^2 \\mathbf{u}' + (\\rho_0 \\alpha g \\Delta T) \\theta' \\hat{\\mathbf{z}} $$\nMultiplying the entire equation by $d^3/(\\eta \\kappa)$:\n$$ 0 = -\\nabla' p'_{dyn} + \\nabla'^2 \\mathbf{u}' + \\left(\\frac{\\rho_0 \\alpha g \\Delta T d^3}{\\eta \\kappa}\\right) \\theta' \\hat{\\mathbf{z}} $$\nThe nondimensional group that appears is the **Rayleigh number**, $Ra$:\n$$ Ra = \\frac{\\rho_0 \\alpha g \\Delta T d^3}{\\eta \\kappa} $$\nThis number represents the ratio of buoyant driving forces to viscous and thermal diffusive dissipation.\n\n**Energy Equation:**\n$$ \\frac{\\partial (\\theta' \\Delta T)}{\\partial (t' d^2/\\kappa)} + \\left(\\mathbf{u}' \\frac{\\kappa}{d} \\cdot \\frac{\\nabla'}{d}\\right) (\\theta' \\Delta T) - u'_z \\frac{\\kappa}{d} \\frac{\\Delta T}{d} = \\kappa \\frac{\\nabla'^2}{d^2} (\\theta' \\Delta T) $$\n$$ \\left(\\frac{\\kappa \\Delta T}{d^2}\\right) \\frac{\\partial \\theta'}{\\partial t'} + \\left(\\frac{\\kappa \\Delta T}{d^2}\\right) (\\mathbf{u}' \\cdot \\nabla') \\theta' - \\left(\\frac{\\kappa \\Delta T}{d^2}\\right) u'_z = \\left(\\frac{\\kappa \\Delta T}{d^2}\\right) \\nabla'^2 \\theta' $$\nDividing by $(\\kappa \\Delta T/d^2)$ yields the dimensionless energy equation:\n$$ \\frac{\\partial \\theta'}{\\partial t'} + \\mathbf{u}' \\cdot \\nabla' \\theta' - u'_z = \\nabla'^2 \\theta' $$\n\nThe controlling nondimensional parameter is the Rayleigh number, $Ra$. We now evaluate it using the provided values (using $\\rho$ for $\\rho_0$ as given):\n$$ Ra = \\frac{(3.0 \\times 10^{-5}\\ \\mathrm{K^{-1}}) (4.50 \\times 10^{3}\\ \\mathrm{kg\\,m^{-3}}) (9.81\\ \\mathrm{m\\,s^{-2}}) (3.00 \\times 10^{2}\\ \\mathrm{K}) (2.8 \\times 10^{6}\\ \\mathrm{m})^3}{(5.0 \\times 10^{21}\\ \\mathrm{Pa\\,s}) (1.0 \\times 10^{-6}\\ \\mathrm{m^{2}\\,s^{-1}})} $$\nCalculating the numerator:\n$$ \\text{Numerator} = (3.0 \\times 10^{-5}) (4.50 \\times 10^{3}) (9.81) (3.00 \\times 10^{2}) (2.8^3 \\times 10^{18}) $$\n$$ \\text{Numerator} = (397.305) (21.952 \\times 10^{18}) \\approx 8.7218 \\times 10^{21} $$\nCalculating the denominator:\n$$ \\text{Denominator} = (5.0 \\times 10^{21}) (1.0 \\times 10^{-6}) = 5.0 \\times 10^{15} $$\nThus, the Rayleigh number is:\n$$ Ra = \\frac{8.7218 \\times 10^{21}}{5.0 \\times 10^{15}} = 1.74436 \\times 10^6 $$\nRounding to three significant figures, we get $Ra = 1.74 \\times 10^6$.\n\nTo determine if the mantle is convecting, we compare this value to the critical Rayleigh number, $Ra_c$, for the onset of convection. For no-slip, isothermal boundaries, linear stability analysis shows that convection begins when the Rayleigh number exceeds a critical value of $Ra_c \\approx 1707.76$.\n\nOur calculated Rayleigh number is $Ra \\approx 1.74 \\times 10^6$. Since $1.74 \\times 10^6 \\gg 1708$, the Rayleigh number for this planetary mantle is many orders of magnitude larger than the critical value. Therefore, the mantle is not only in the convective regime, but it is expected to be vigorously convecting.",
            "answer": "$$\\boxed{1.74 \\times 10^6}$$"
        },
        {
            "introduction": "Once we establish that a mantle is vigorously convecting, the next crucial question is how efficiently it transports heat. This is quantified by the Nusselt number ($Nu$), which measures the enhancement of heat flow by convection compared to what would occur via pure conduction. This practice  challenges you to connect the Rayleigh number to a planet's actual heat flux using a well-established empirical scaling law, providing a quantitative look at the power of planetary convection.",
            "id": "4185539",
            "problem": "A single-layer, isoviscous silicate mantle in a small exoplanet transports heat by thermal convection at high Prandtl number. Assume the system is basally heated with negligible internal heating and no-slip mechanical boundary conditions. You are given the following material properties and planetary parameters, all in International System of Units: mantle density $\\rho = 3500$, gravitational acceleration $g = 3.0$, thermal expansivity $\\alpha = 2.5 \\times 10^{-5}$, temperature drop across the convecting layer $\\Delta T = 1200$, layer thickness $d = 1.0 \\times 10^{6}$, thermal diffusivity $\\kappa = 1.0 \\times 10^{-6}$, dynamic viscosity $\\eta = 3.0 \\times 10^{21}$, and thermal conductivity $k = 3.0$. \n\nUse as your fundamental base the definition of the Rayleigh number $Ra = \\dfrac{\\rho g \\alpha \\Delta T d^{3}}{\\kappa \\eta}$, the conductive heat flux across a layer $q_{\\mathrm{cond}} = \\dfrac{k \\Delta T}{d}$, and the definition of the Nusselt number as the ratio of total to conductive heat flux, $Nu \\equiv \\dfrac{q}{q_{\\mathrm{cond}}}$. For isoviscous, basally heated convection at high Rayleigh number with no-slip boundaries, adopt the well-tested empirical scaling $Nu = a\\, Ra^{\\beta}$ with $a = 0.27$ and $\\beta = \\dfrac{1}{3}$.\n\nStarting from these bases, derive the expression for the convective surface heat flux $q$ in terms of the given parameters and compute both $q$ and the conductive flux $q_{\\mathrm{cond}}$ (expressed in $\\mathrm{W\\,m^{-2}}$). Then evaluate the convective efficiency defined by $E \\equiv \\dfrac{q}{q_{\\mathrm{cond}}}$. \n\nReport, as your final answer, the value of $E$ rounded to three significant figures. The final reported answer must be dimensionless. Do not include any units in your final reported answer.",
            "solution": "We begin from the fundamental definitions. The Rayleigh number for a layer of thickness $d$ with dynamic viscosity $\\eta$ is\n$$\nRa = \\frac{\\rho g \\alpha \\Delta T d^{3}}{\\kappa \\eta}.\n$$\nThe conductive heat flux across the same layer is\n$$\nq_{\\mathrm{cond}} = \\frac{k \\Delta T}{d}.\n$$\nThe total convective heat flux $q$ relates to the conductive flux by the Nusselt number $Nu$:\n$$\nNu \\equiv \\frac{q}{q_{\\mathrm{cond}}}.\n$$\nAn empirically validated scaling for isoviscous, basally heated, large-Prandtl-number convection with no-slip boundaries is\n$$\nNu = a\\, Ra^{\\beta},\n$$\nwith $a = 0.27$ and $\\beta = \\frac{1}{3}$. Therefore,\n$$\nq = Nu \\, q_{\\mathrm{cond}} = \\left(a\\, Ra^{\\beta}\\right)\\left(\\frac{k \\Delta T}{d}\\right).\n$$\nThis completes the symbolic derivation of $q$ in terms of the given parameters. The convective efficiency is\n$$\nE \\equiv \\frac{q}{q_{\\mathrm{cond}}} = Nu = a\\, Ra^{\\beta}.\n$$\n\nWe now compute numerically. First, compute the Rayleigh number using the given values:\n- $\\rho = 3500$, $g = 3.0$, $\\alpha = 2.5 \\times 10^{-5}$, $\\Delta T = 1200$, $d = 1.0 \\times 10^{6}$, $\\kappa = 1.0 \\times 10^{-6}$, $\\eta = 3.0 \\times 10^{21}$.\nCompute the numerator $\\rho g \\alpha \\Delta T d^{3}$ in steps:\n$$\n\\rho g \\alpha \\Delta T = 3500 \\times 3.0 \\times \\left(2.5 \\times 10^{-5}\\right) \\times 1200.\n$$\nFirst, $\\left(2.5 \\times 10^{-5}\\right)\\times 1200 = 0.03$. Then $3500 \\times 3.0 = 10500$. Thus\n$$\n\\rho g \\alpha \\Delta T = 10500 \\times 0.03 = 315.\n$$\nNext, $d^{3} = \\left(1.0 \\times 10^{6}\\right)^{3} = 1.0 \\times 10^{18}$. Hence the numerator is\n$$\n315 \\times 1.0 \\times 10^{18} = 3.15 \\times 10^{20}.\n$$\nCompute the denominator $\\kappa \\eta = \\left(1.0 \\times 10^{-6}\\right)\\left(3.0 \\times 10^{21}\\right) = 3.0 \\times 10^{15}$. Therefore,\n$$\nRa = \\frac{3.15 \\times 10^{20}}{3.0 \\times 10^{15}} = 1.05 \\times 10^{5}.\n$$\n\nNext, compute the Nusselt number from the scaling:\n$$\nNu = a\\, Ra^{\\beta} = 0.27 \\left(1.05 \\times 10^{5}\\right)^{1/3}.\n$$\nEvaluate $\\left(1.05 \\times 10^{5}\\right)^{1/3} = \\left(1.05\\right)^{1/3}\\left(10^{5}\\right)^{1/3}$. Since $\\left(10^{5}\\right)^{1/3} \\approx 46.416$ and $\\left(1.05\\right)^{1/3} \\approx 1.016$, their product is approximately $47.1787$. Thus\n$$\nNu \\approx 0.27 \\times 47.1787 \\approx 12.7383.\n$$\n\nNow compute the conductive heat flux:\n$$\nq_{\\mathrm{cond}} = \\frac{k \\Delta T}{d} = \\frac{3.0 \\times 1200}{1.0 \\times 10^{6}} = \\frac{3600}{10^{6}} = 3.6 \\times 10^{-3}\\ \\mathrm{W\\,m^{-2}}.\n$$\nThe total heat flux is\n$$\nq = Nu \\, q_{\\mathrm{cond}} \\approx 12.7383 \\times 3.6 \\times 10^{-3} \\approx 4.5858 \\times 10^{-2}\\ \\mathrm{W\\,m^{-2}}.\n$$\n\nFinally, the convective efficiency is\n$$\nE \\equiv \\frac{q}{q_{\\mathrm{cond}}} = Nu \\approx 12.7383.\n$$\nRounded to three significant figures as required,\n$$\nE \\approx 12.7.\n$$\nThe requested final answer is the dimensionless $E$.",
            "answer": "$$\\boxed{12.7}$$"
        },
        {
            "introduction": "The principles of convective heat transport can be integrated to model the entire thermal history of a planet over billions of years. By formulating a global energy balance as an ordinary differential equation (ODE), we can simulate the cooling of a planet's mantle from an initial hot state. This capstone practice  asks you to develop and solve such a model computationally, exploring concepts of thermal equilibrium, stability, and the long-term evolution driven by the interplay of radiogenic heating and convective cooling.",
            "id": "4185593",
            "problem": "A planet’s interior thermal evolution can be idealized by an energy balance for the well-mixed mantle. Starting from conservation of energy, the mantle temperature as a function of time, denoted by $T_m(t)$, satisfies an Ordinary Differential Equation (ODE) in which the rate of change of internal energy equals prescribed internal heating minus outward heat loss. Use the following modeling assumptions, each rooted in established planetary science practice and heat transfer principles, to formulate, analyze, and solve the model:\n\n1. The total mantle heat capacity is constant and denoted by $C_m$ in $\\mathrm{J/K}$, the mantle temperature is $T_m(t)$ in $\\mathrm{K}$, and the surface temperature is $T_s$ in $\\mathrm{K}$, with $T_m(t) \\ge T_s$.\n\n2. The internal heating rate is prescribed as a function of time by $H(t)$ in $\\mathrm{W}$ and is independent of $T_m$. Use the radiogenic decay form $H(t) = H_0 \\exp(-\\lambda t)$, where $H_0$ is the initial heating in $\\mathrm{W}$ and $\\lambda$ is the decay constant in $\\mathrm{s^{-1}}$.\n\n3. The net outward heat loss from the mantle to the surface is parameterized by a monotonic power-law function $Q(T_m) = \\alpha \\left(T_m - T_s\\right)^\\beta$ in $\\mathrm{W}$, where $\\alpha  0$ and $\\beta  0$ are constants reflecting bulk transport efficiency.\n\n4. By conservation of energy, the governing ODE is $C_m \\,\\dfrac{dT_m}{dt} = H(t) - Q(T_m)$.\n\n5. A thermal equilibrium (fixed point) for constant heating $H(t) \\equiv H_0$ satisfies $H_0 = Q(T_m)$ and its linear stability is determined by the sign of the derivative of the ODE right-hand side with respect to $T_m$ evaluated at the equilibrium. Specifically, let $f(T_m) \\equiv \\dfrac{1}{C_m} \\left( H_0 - Q(T_m) \\right)$, then evaluate $f'(T_\\mathrm{eq})$ at any equilibrium $T_\\mathrm{eq}$.\n\nYour task is to write a complete program that uses the above model to compute, for each test case below:\n- The equilibrium mantle temperature $T_\\mathrm{eq}$ in $\\mathrm{K}$ for constant heating $H(t) \\equiv H_0$ by solving $H_0 = Q(T_\\mathrm{eq})$, expressed in $\\mathrm{K}$, rounded to two decimal places.\n- A boolean indicating whether the equilibrium is linearly stable ($\\text{True}$ if stable, $\\text{False}$ if unstable), determined by the sign of $f'(T_\\mathrm{eq})$.\n- The time-evolved mantle temperature $T_m(t_f)$ in $\\mathrm{K}$ at final time $t_f$ under the decaying heating $H(t) = H_0 \\exp(-\\lambda t)$, obtained by numerically integrating the ODE from $t=0$ to $t=t_f$ with initial condition $T_m(0)=T_0$, expressed in $\\mathrm{K}$, rounded to two decimal places.\n\nPhysical units must be used exactly as specified: temperatures in $\\mathrm{K}$, heat capacities in $\\mathrm{J/K}$, powers in $\\mathrm{W}$, and time in $\\mathrm{s}$. Angles do not appear. All decimal answers must be provided as numeric decimals, not percentages. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a list $[T_\\mathrm{eq}, \\text{is\\_stable}, T_m(t_f)]$. For example, the overall format should be $[[\\dots],[\\dots],[\\dots]]$.\n\nImplement the program to solve the following test suite, designed to probe typical behavior, boundary conditions, and nonlinear heat-loss sensitivity. Use exactly these parameter values:\n\n- Test Case A (Earth-like baseline, monotonic heat loss):\n  - $C_m = 4.8 \\times 10^{27}\\ \\mathrm{J/K}$,\n  - $T_s = 300\\ \\mathrm{K}$,\n  - $\\alpha = 3.6 \\times 10^{10}\\ \\mathrm{W/K}$,\n  - $\\beta = 1.0$,\n  - $H_0 = 2.0 \\times 10^{13}\\ \\mathrm{W}$,\n  - $\\lambda = 1.5 \\times 10^{-17}\\ \\mathrm{s^{-1}}$,\n  - $T_0 = 1600\\ \\mathrm{K}$,\n  - $t_f = 1.0 \\times 10^{17}\\ \\mathrm{s}$.\n\n- Test Case B (boundary case: no internal heating):\n  - $C_m = 4.8 \\times 10^{27}\\ \\mathrm{J/K}$,\n  - $T_s = 300\\ \\mathrm{K}$,\n  - $\\alpha = 3.6 \\times 10^{10}\\ \\mathrm{W/K}$,\n  - $\\beta = 1.0$,\n  - $H_0 = 0.0\\ \\mathrm{W}$,\n  - $\\lambda = 1.5 \\times 10^{-17}\\ \\mathrm{s^{-1}}$,\n  - $T_0 = 1600\\ \\mathrm{K}$,\n  - $t_f = 5.0 \\times 10^{16}\\ \\mathrm{s}$.\n\n- Test Case C (nonlinear heat loss sensitivity):\n  - $C_m = 4.8 \\times 10^{27}\\ \\mathrm{J/K}$,\n  - $T_s = 300\\ \\mathrm{K}$,\n  - $\\alpha = \\dfrac{4.7 \\times 10^{13}}{\\left(1300\\right)^{1.3}}\\ \\mathrm{W/K^{1.3}}$,\n  - $\\beta = 1.3$,\n  - $H_0 = 2.0 \\times 10^{13}\\ \\mathrm{W}$,\n  - $\\lambda = 1.5 \\times 10^{-17}\\ \\mathrm{s^{-1}}$,\n  - $T_0 = 1600\\ \\mathrm{K}$,\n  - $t_f = 1.0 \\times 10^{17}\\ \\mathrm{s}$.\n\nYour program must:\n- Formulate the ODE $C_m \\,\\dfrac{dT_m}{dt} = H_0 \\exp(-\\lambda t) - \\alpha \\left(T_m - T_s\\right)^\\beta$ and implement a robust numerical integrator that respects the physical constraint $T_m(t) \\ge T_s$.\n- For each test case, compute $T_\\mathrm{eq}$, the stability boolean by evaluating the sign of $f'(T_\\mathrm{eq})$, and $T_m(t_f)$.\n- Produce the single-line output in the exact format $[[T_\\mathrm{eq,A}, \\text{is\\_stable,A}, T_m(t_f)\\text{,A}],[T_\\mathrm{eq,B}, \\text{is\\_stable,B}, T_m(t_f)\\text{,B}],[T_\\mathrm{eq,C}, \\text{is\\_stable,C}, T_m(t_f)\\text{,C}]]$, with the temperatures rounded to two decimal places, and booleans as plain $\\text{True}$ or $\\text{False}$.",
            "solution": "The energy balance for a planet’s mantle provides the fundamental base: the rate of change of internal energy equals internal heating minus outward heat loss. Let the mantle temperature be $T_m(t)$, the constant total mantle heat capacity be $C_m$ in $\\mathrm{J/K}$, internal heating be $H(t)$ in $\\mathrm{W}$, and heat loss be $Q(T_m)$ in $\\mathrm{W}$. Conservation of energy yields\n$$\nC_m \\,\\frac{dT_m}{dt} \\;=\\; H(t) \\;-\\; Q(T_m).\n$$\nWith prescribed radiogenic heating $H(t) = H_0 \\exp(-\\lambda t)$, where $H_0$ is the initial heating and $\\lambda$ is the decay constant, and a physically motivated monotonic heat-loss parameterization $Q(T_m) = \\alpha \\left(T_m - T_s\\right)^\\beta$ with $\\alpha  0$ and $\\beta  0$, the governing ODE becomes\n$$\nC_m \\,\\frac{dT_m}{dt} \\;=\\; H_0 \\exp(-\\lambda t) \\;-\\; \\alpha \\left(T_m - T_s\\right)^\\beta,\n$$\nwith the physical constraint $T_m(t) \\ge T_s$.\n\nFixed points (thermal equilibria) under constant heating satisfy\n$$\nH_0 \\;=\\; Q(T_m) \\;=\\; \\alpha \\left(T_m - T_s\\right)^\\beta.\n$$\nDenoting any equilibrium temperature by $T_\\mathrm{eq}$, the equilibrium condition is the root of the function\n$$\ng(T_m) \\;=\\; \\alpha \\left(T_m - T_s\\right)^\\beta \\;-\\; H_0.\n$$\nFor $\\alpha  0$ and $\\beta  0$, the function $g(T_m)$ is strictly increasing on $T_m \\ge T_s$, so there is a unique solution $T_\\mathrm{eq} \\ge T_s$ for each $H_0 \\ge 0$. In particular, $H_0 = 0$ gives $T_\\mathrm{eq} = T_s$, and $H_0  0$ gives $T_\\mathrm{eq}  T_s$.\n\nLinear stability of $T_\\mathrm{eq}$ follows from linearizing the ODE about $T_\\mathrm{eq}$. Define\n$$\nf(T_m) \\;\\equiv\\; \\frac{1}{C_m} \\left( H_0 - Q(T_m) \\right).\n$$\nThe linearized evolution for a small perturbation $\\delta T$ from equilibrium is\n$$\n\\frac{d\\,\\delta T}{dt} \\;=\\; f'(T_\\mathrm{eq}) \\,\\delta T,\n$$\nwhere\n$$\nf'(T_\\mathrm{eq}) \\;=\\; -\\frac{1}{C_m} \\, Q'(T_\\mathrm{eq}).\n$$\nFor the power-law heat loss $Q(T_m) = \\alpha \\left(T_m - T_s\\right)^\\beta$, the derivative is\n$$\nQ'(T_m) \\;=\\; \\alpha \\,\\beta \\left(T_m - T_s\\right)^{\\beta - 1}.\n$$\nEvaluated at equilibrium $T_\\mathrm{eq}$ with $T_\\mathrm{eq} \\ge T_s$, we have $Q'(T_\\mathrm{eq}) \\ge 0$ and strictly $Q'(T_\\mathrm{eq})  0$ for $H_0  0$. Therefore,\n$$\nf'(T_\\mathrm{eq}) \\;=\\; -\\frac{Q'(T_\\mathrm{eq})}{C_m} \\;\\; 0 \\quad \\text{for} \\quad H_0  0,\n$$\nwhich implies exponential decay of perturbations and linear stability. In the boundary case $H_0 = 0$ with $T_\\mathrm{eq} = T_s$, the one-sided derivative $Q'(T)$ for $T  T_s$ remains nonnegative, and the sign of the restoring term for small positive perturbations is negative, confirming stability in the physically relevant domain $T_m \\ge T_s$.\n\nAlgorithmic design:\n\n1. Equilibrium computation: For $H_0 \\ge 0$, solve $H_0 = \\alpha \\left(T_\\mathrm{eq} - T_s\\right)^\\beta$. Because $g(T_m)$ is strictly increasing, the solution is unique. For $H_0 = 0$, $T_\\mathrm{eq} = T_s$. For $H_0  0$, invert the monotonic relation to obtain $T_\\mathrm{eq}$ satisfying the equilibrium condition.\n\n2. Stability classification: Evaluate $Q'(T_\\mathrm{eq}) = \\alpha \\,\\beta \\left(T_\\mathrm{eq} - T_s\\right)^{\\beta - 1}$. The equilibrium is stable if $f'(T_\\mathrm{eq}) = - Q'(T_\\mathrm{eq}) / C_m  0$, which holds whenever $Q'(T_\\mathrm{eq})  0$. In the boundary case $T_\\mathrm{eq} = T_s$, stability is verified by the sign of the restoring term for $T_m  T_s$.\n\n3. Time integration: Numerically integrate\n$$\n\\frac{dT_m}{dt} \\;=\\; \\frac{1}{C_m} \\left( H_0 \\exp(-\\lambda t) - \\alpha \\left(\\max\\{T_m - T_s, 0\\}\\right)^\\beta \\right)\n$$\nfrom $t = 0$ to $t = t_f$ with initial $T_m(0) = T_0$, using an adaptive ODE solver with suitable absolute and relative tolerances. The $\\max\\{T_m - T_s, 0\\}$ enforces the physical constraint $T_m \\ge T_s$ by nullifying heat loss if a numerical trajectory attempts to dip below $T_s$. Extract $T_m(t_f)$ and round to two decimals.\n\nTest suite application:\n\n- Test Case A computes $T_\\mathrm{eq}$ for $H_0 = 2.0 \\times 10^{13}\\ \\mathrm{W}$ and baseline parameters, classifies stability, and integrates to $t_f = 1.0 \\times 10^{17}\\ \\mathrm{s}$. For $\\beta = 1.0$, equilibrium is uniquely determined and stable.\n\n- Test Case B sets $H_0 = 0$ as a boundary case. The only equilibrium is $T_\\mathrm{eq} = T_s$, and stability is ensured by the monotonicity of $Q(T_m)$ for $T_m  T_s$. Integration demonstrates cooling toward $T_s$.\n\n- Test Case C uses nonlinear heat loss with $\\beta = 1.3$ and $\\alpha$ chosen such that $\\alpha \\left(1300\\right)^{1.3} \\approx 4.7 \\times 10^{13}\\ \\mathrm{W}$ to probe sensitivity. Stability follows from the positivity of $Q'(T_\\mathrm{eq})$ and the solution demonstrates the impact of stronger-than-linear heat-loss dependence.\n\nThe program implements these steps, computes the requested quantities for each test case, and prints a single line containing $[[T_\\mathrm{eq,A}, \\text{is\\_stable,A}, T_m(t_f)\\text{,A}],[T_\\mathrm{eq,B}, \\text{is\\_stable,B}, T_m(t_f)\\text{,B}],[T_\\mathrm{eq,C}, \\text{is\\_stable,C}, T_m(t_f)\\text{,C}]]$ with temperatures rounded to two decimal places and booleans indicating stability.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef equilibrium_temperature(H0, alpha, beta, Ts):\n    \"\"\"\n    Compute equilibrium temperature T_eq solving H0 = alpha * (T_eq - Ts)^beta for H0 = 0.\n    If H0 = 0, equilibrium is at Ts.\n    \"\"\"\n    if H0 = 0.0:\n        return Ts\n    # Invert the monotonic power-law relation\n    delta = (H0 / alpha) ** (1.0 / beta)\n    return Ts + delta\n\ndef stability_at_equilibrium(H0, alpha, beta, Ts, Cm):\n    \"\"\"\n    Determine linear stability at equilibrium.\n    Stability criterion: f'(T_eq) = -(Q'(T_eq))/Cm  0  (stable if Q'(T_eq)  0).\n    For boundary case T_eq = Ts (H0=0), classify as stable within physical domain T = Ts.\n    \"\"\"\n    Teq = equilibrium_temperature(H0, alpha, beta, Ts)\n    if Teq = Ts:\n        # Boundary equilibrium at Ts; monotonic Q implies restoring tendency for T  Ts\n        return True\n    # Compute derivative of Q at equilibrium\n    Qprime = alpha * beta * (Teq - Ts) ** (beta - 1.0)\n    return Qprime  0.0\n\ndef integrate_temperature(Cm, Ts, alpha, beta, H0, lam, T0, tf):\n    \"\"\"\n    Integrate the ODE: dT/dt = (H0*exp(-lam*t) - alpha * max(T-Ts,0)^beta) / Cm\n    from t=0 to t=tf with initial temperature T0. Returns T(tf).\n    \"\"\"\n    def rhs(t, T):\n        # Enforce physical constraint in the loss term\n        delta = max(T[0] - Ts, 0.0)\n        Q = alpha * (delta ** beta)\n        Ht = H0 * np.exp(-lam * t)\n        return [(Ht - Q) / Cm]\n\n    # Integrate with adaptive RK method\n    sol = solve_ivp(rhs, (0.0, tf), [T0], method='RK45', rtol=1e-9, atol=1e-9, max_step=tf/1000.0)\n    Tfinal = float(sol.y[0, -1])\n    # Ensure non-negativity relative to Ts (numerical safeguard)\n    if Tfinal  Ts:\n        Tfinal = Ts\n    return Tfinal\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (Cm, Ts, alpha, beta, H0, lam, T0, tf)\n    Cm_A = 4.8e27\n    Ts_A = 300.0\n    alpha_A = 3.6e10\n    beta_A = 1.0\n    H0_A = 2.0e13\n    lam_A = 1.5e-17\n    T0_A = 1600.0\n    tf_A = 1.0e17\n\n    Cm_B = 4.8e27\n    Ts_B = 300.0\n    alpha_B = 3.6e10\n    beta_B = 1.0\n    H0_B = 0.0\n    lam_B = 1.5e-17\n    T0_B = 1600.0\n    tf_B = 5.0e16\n\n    Cm_C = 4.8e27\n    Ts_C = 300.0\n    beta_C = 1.3\n    # alpha chosen so that alpha * (1300)^1.3 = 4.7e13 W\n    alpha_C = 4.7e13 / (1300.0 ** beta_C)\n    H0_C = 2.0e13\n    lam_C = 1.5e-17\n    T0_C = 1600.0\n    tf_C = 1.0e17\n\n    test_cases = [\n        (Cm_A, Ts_A, alpha_A, beta_A, H0_A, lam_A, T0_A, tf_A),\n        (Cm_B, Ts_B, alpha_B, beta_B, H0_B, lam_B, T0_B, tf_B),\n        (Cm_C, Ts_C, alpha_C, beta_C, H0_C, lam_C, T0_C, tf_C),\n    ]\n\n    results = []\n    for Cm, Ts, alpha, beta, H0, lam, T0, tf in test_cases:\n        Teq = equilibrium_temperature(H0, alpha, beta, Ts)\n        is_stable = stability_at_equilibrium(H0, alpha, beta, Ts, Cm)\n        Tfinal = integrate_temperature(Cm, Ts, alpha, beta, H0, lam, T0, tf)\n        # Round temperatures to two decimal places\n        Teq_r = round(Teq, 2)\n        Tfinal_r = round(Tfinal, 2)\n        results.append([Teq_r, is_stable, Tfinal_r])\n\n    # Final print statement in the exact required format.\n    print(str(results))\n\nsolve()\n```"
        }
    ]
}