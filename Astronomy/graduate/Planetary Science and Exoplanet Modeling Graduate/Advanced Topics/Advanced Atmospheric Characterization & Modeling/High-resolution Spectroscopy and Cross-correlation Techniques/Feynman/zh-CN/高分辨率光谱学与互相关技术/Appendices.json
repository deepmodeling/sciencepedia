{
    "hands_on_practices": [
        {
            "introduction": "在天体光谱分析中，获得高信噪比信号的第一步是从探测器图像中精确提取一维光谱。本练习将引导你从基本物理原理出发，构建一个完整的光谱噪声模型。通过该实践，你将学会如何量化并合并来自不同来源的噪声，包括光子散粒噪声、读出噪声和暗电流，从而为每个光谱像素计算出准确的方差。这项技能对于后续交叉相关分析中的优化加权至关重要，是保证最终测量结果精密度的基石。",
            "id": "4163453",
            "problem": "一台高分辨率阶梯光栅摄谱仪记录了一幅二维探测器图像，其中每个波长像素索引 $i$ 都在五个空间像素 $j=1,\\dots,5$ 上进行采样。您使用总和为1的最优权重 $w_j$ 来提取波长像素 $i$ 处的一维光谱。仪器增益为 $g$ 电子数/模拟数字单位 (ADU)，单像素读出噪声服从标准差为 $\\sigma_r$ 电子数的高斯统计，暗电流率为 $d$ 电子数/秒，曝光时间为 $t$。偏置水平从过扫描区估计，并在提取前从每个探测器像素中减去；偏置估计具有标准差为 $\\sigma_b$ 电子数的高斯不确定度，并且对于固定的 $i$，该不确定度对所有 $j$ 都是共同的。您可以假设所有光子计数过程（目标和天空）均服从泊松统计，读出噪声和偏置误差与光子噪声相互独立且彼此也独立，并且像素 $i$ 处的天空背景已被估计并包含在计数中，未进行天空背景扣除。然后，您通过除以一个由平滑拟合得到的局域连续谱估计值 $C_i$（单位为电子数）来对提取的流量 $F_i$ 进行连续谱归一化；连续谱估计的不确定度可以忽略不计。\n\n对于一个特定的波长像素 $i$，数据和参数如下：\n- 最优提取权重 $w_1=w_5=0.06$, $w_2=w_4=0.24$, $w_3=0.40$。\n- 空间像素上的目标计数（ADU）：对于 $j=1,\\dots,5$，$O_{i,j} \\in \\{120,\\,480,\\,800,\\,480,\\,120\\}$。\n- 空间像素上的天空计数（ADU）：对于所有 $j$，$S_{i,j}=20$。\n- 增益：$g=1.7$ 电子数/ADU。\n- 读出噪声标准差：$\\sigma_r=3.5$ 电子数。\n- 暗电流率：$d=0.01$ 电子数/秒；曝光时间：$t=1200$ 秒。\n- 偏置估计标准差：$\\sigma_b=1.2$ 电子数。\n- 连续谱估计：$C_i=1000$ 电子数。\n\n从泊松噪声和高斯噪声的基本原理以及不确定度传播法则出发，推导归一化流量 $f_i=F_i/C_i$ 的单像素方差，该方差将用于互相关函数 (CCF) 的最优加权。计算该波长像素的数值。以无量纲单位表示最终方差，并将您的答案四舍五入到四位有效数字。",
            "solution": "题目要求推导和计算来自高分辨率摄谱仪的连续谱归一化流量测量的方差。该过程涉及识别所有噪声源（包括独立的和相关的），并将它们通过流量提取和归一化步骤进行传播。\n\n设对于给定的波长像素 $i$ 和空间像素 $j$，以模拟数字单位 (ADU) 计量的测量信号表示为目标和天空计数的总和，即 $D_{i,j} = O_{i,j} + S_{i,j}$。从 ADU 到电子数的转换由增益 $g$ 决定。因此，来自光子的信号（以电子数计）为 $g D_{i,j}$。此外，还有来自暗电流的贡献，它在曝光时间 $t$ 内以速率 $d$ 累积。像素中产生的信号电子总数是光生电子和暗电流电子之和。两者都是泊松过程。空间像素 $j$ 中信号电子的平均数由下式给出：\n$$ \\mu_j = g (O_{i,j} + S_{i,j}) + d \\times t $$\n由于光子计数和暗电流都是泊松过程，该信号生成过程的方差等于平均电子数：$\\text{Var}_{\\text{signal}} = \\mu_j$。\n\n测量过程会引入额外的噪声。设 $\\tilde{N}_j$ 为在所有处理步骤（偏置扣除，增益转换）后，空间像素 $j$（在固定波长 $i$）的最终测量电子计数。该测量值可以建模为一个真实信号分量和几个独立噪声分量之和。然而，我们必须正确处理偏置扣除不确定度，这是所有像素的共同误差。\n\n让我们将像素 $j$ 的测量值 $\\tilde{N}_j$ 建模为：\n$$ \\tilde{N}_j = P_j + D_j + \\epsilon_{r,j} + \\epsilon_b $$\n其中：\n- $P_j$ 是服从泊松分布的光电子数，其均值和方差均等于 $g(O_{i,j} + S_{i,j})$。\n- $D_j$ 是服从泊松分布的暗电流电子数，其均值和方差均等于 $d \\times t$。\n- $\\epsilon_{r,j}$ 是像素 $j$ 的服从高斯分布的读出噪声，均值为 0，方差为 $\\sigma_r^2$。每个像素的读出噪声是独立的。\n- $\\epsilon_b$ 是偏置扣除中的服从高斯分布的误差，均值为 0，方差为 $\\sigma_b^2$。对于给定的波长像素 $i$，此误差对所有空间像素 $j=1, \\dots, 5$ 都是共同的。\n\n让我们为每个像素定义一个独立噪声分量 $U_j$ 和一个共同噪声分量 $C$。\n总测量信号为 $\\tilde{N}_j = U_j + C$，其中：\n- $U_j = P_j + D_j + \\epsilon_{r,j}$ 代表了像素间相互独立的各分量。其方差为 $\\text{Var}(U_j) = \\text{Var}(P_j) + \\text{Var}(D_j) + \\text{Var}(\\epsilon_{r,j}) = g(O_{i,j} + S_{i,j}) + d \\times t + \\sigma_r^2 = \\mu_j + \\sigma_r^2$。\n- $C = \\epsilon_b$ 代表了共同误差分量。其方差为 $\\text{Var}(C) = \\sigma_b^2$。\n\n提取的一维流量 $F_i$ 是来自 5 个空间像素信号的最优加权和：\n$$ F_i = \\sum_{j=1}^{5} w_j \\tilde{N}_j = \\sum_{j=1}^{5} w_j (U_j + C) = \\sum_{j=1}^{5} w_j U_j + C \\sum_{j=1}^{5} w_j $$\n提取流量的方差 $\\text{Var}(F_i)$ 通过传播各分量的方差得到。由于 $U_j$ 项彼此独立且与 $C$ 独立，和的方差为：\n$$ \\text{Var}(F_i) = \\text{Var}\\left(\\sum_{j=1}^{5} w_j U_j\\right) + \\text{Var}\\left(C \\sum_{j=1}^{5} w_j\\right) $$\n$$ \\text{Var}(F_i) = \\sum_{j=1}^{5} w_j^2 \\text{Var}(U_j) + \\left(\\sum_{j=1}^{5} w_j\\right)^2 \\text{Var}(C) $$\n代入方差的表达式，并注意到给定的权重总和为1的条件，即 $\\sum_{j=1}^{5} w_j = 1$：\n$$ \\text{Var}(F_i) = \\sum_{j=1}^{5} w_j^2 (\\mu_j + \\sigma_r^2) + (1)^2 \\sigma_b^2 = \\sum_{j=1}^{5} w_j^2 (\\mu_j + \\sigma_r^2) + \\sigma_b^2 $$\n这是提取流量方差的通用表达式，单位为电子数的平方。\n\n然后，通过除以连续谱估计值 $C_i$ 对流量 $F_i$ 进行连续谱归一化。归一化流量为 $f_i = F_i / C_i$。题目说明 $C_i$ 的不确定度可以忽略不计，因此 $C_i$ 可被视为常数。归一化流量的方差因此为：\n$$ \\text{Var}(f_i) = \\text{Var}\\left(\\frac{F_i}{C_i}\\right) = \\frac{1}{C_i^2} \\text{Var}(F_i) $$\n结合这些表达式，我们得到归一化流量方差的最终公式：\n$$ \\text{Var}(f_i) = \\frac{1}{C_i^2} \\left[ \\sum_{j=1}^{5} w_j^2 (\\mu_j + \\sigma_r^2) + \\sigma_b^2 \\right] $$\n\n现在，我们使用给定的数据计算数值。\n给定参数：\n- $g = 1.7 \\, \\text{e}^-/\\text{ADU}$\n- $\\sigma_r = 3.5 \\, \\text{e}^-$\n- $d = 0.01 \\, \\text{e}^-/\\text{s}$\n- $t = 1200 \\, \\text{s}$\n- $\\sigma_b = 1.2 \\, \\text{e}^-$\n- $C_i = 1000 \\, \\text{e}^-$\n- 权重：$w_1=w_5=0.06$, $w_2=w_4=0.24$, $w_3=0.40$\n- 计数 (ADU)：$O_{i,j} \\in \\{120, 480, 800, 480, 120\\}$, 对所有 $j$，$S_{i,j}=20$。\n\n首先，计算恒定的方差项：\n- 读出噪声方差：$\\sigma_r^2 = (3.5)^2 = 12.25 \\, \\text{e}^{-2}$\n- 偏置不确定度方差：$\\sigma_b^2 = (1.2)^2 = 1.44 \\, \\text{e}^{-2}$\n- 暗电流对平均信号的贡献：$d \\times t = 0.01 \\times 1200 = 12 \\, \\text{e}^-$\n\n接下来，计算每个空间像素的平均信号 $\\mu_j$：\n- 对于 $j=1,5$：$O_{i,1} + S_{i,1} = 120 + 20 = 140 \\, \\text{ADU}$。\n  $\\mu_1 = \\mu_5 = g(140) + d \\times t = 1.7 \\times 140 + 12 = 238 + 12 = 250 \\, \\text{e}^-$\n- 对于 $j=2,4$：$O_{i,2} + S_{i,2} = 480 + 20 = 500 \\, \\text{ADU}$。\n  $\\mu_2 = \\mu_4 = g(500) + d \\times t = 1.7 \\times 500 + 12 = 850 + 12 = 862 \\, \\text{e}^-$\n- 对于 $j=3$：$O_{i,3} + S_{i,3} = 800 + 20 = 820 \\, \\text{ADU}$。\n  $\\mu_3 = g(820) + d \\times t = 1.7 \\times 820 + 12 = 1394 + 12 = 1406 \\, \\text{e}^-$\n\n现在，计算总和 $\\sum_{j=1}^{5} w_j^2 (\\mu_j + \\sigma_r^2)$。我们可以按对称性对各项进行分组：\n- $w_1^2=w_5^2 = (0.06)^2 = 0.0036$\n- $w_2^2=w_4^2 = (0.24)^2 = 0.0576$\n- $w_3^2 = (0.40)^2 = 0.1600$\n\n- $j=1,5$ 的项：$w_1^2(\\mu_1+\\sigma_r^2) = 0.0036 \\times (250 + 12.25) = 0.0036 \\times 262.25 = 0.9441$\n- $j=2,4$ 的项：$w_2^2(\\mu_2+\\sigma_r^2) = 0.0576 \\times (862 + 12.25) = 0.0576 \\times 874.25 = 50.3568$\n- $j=3$ 的项：$w_3^2(\\mu_3+\\sigma_r^2) = 0.1600 \\times (1406 + 12.25) = 0.1600 \\times 1418.25 = 226.92$\n\n总和为：\n$$ \\sum_{j=1}^{5} w_j^2(\\mu_j + \\sigma_r^2) = 2 \\times (0.9441) + 2 \\times (50.3568) + 226.92 $$\n$$ = 1.8882 + 100.7136 + 226.92 = 329.5218 \\, \\text{e}^{-2} $$\n\n现在，计算提取流量的总方差 $\\text{Var}(F_i)$：\n$$ \\text{Var}(F_i) = 329.5218 + \\sigma_b^2 = 329.5218 + 1.44 = 330.9618 \\, \\text{e}^{-2} $$\n\n最后，计算归一化流量的方差 $\\text{Var}(f_i)$：\n$$ \\text{Var}(f_i) = \\frac{\\text{Var}(F_i)}{C_i^2} = \\frac{330.9618}{(1000)^2} = \\frac{330.9618}{1000000} = 0.0003309618 $$\n这是一个无量纲量，因为它是归一化流量的方差。四舍五入到四位有效数字得到 $0.0003310$。\n\n用科学记数法表示，即为 $3.310 \\times 10^{-4}$。",
            "answer": "$$ \\boxed{3.310 \\times 10^{-4}} $$"
        },
        {
            "introduction": "高分辨率光谱通常包含数百万个数据点，对海量数据进行高效处理是天文学研究中的一个核心挑战。直接计算交叉相关函数的计算复杂度为 $O(N^2)$，在处理现代光谱数据时会非常耗时。本练习旨在通过对比直接时域计算与基于快速傅里叶变换（FFT）的频域计算，让你亲身体验算法选择对计算效率的巨大影响。掌握利用卷积定理加速交叉相关计算的方法，是处理大规模科学数据的关键实用技能。",
            "id": "4163454",
            "problem": "一台用于探测系外行星大气的高分辨率光谱仪生成一个在均匀波长网格上采样的观测光谱，该光谱经过连续谱归一化和地球大气吸收校正，表示为一个包含 $N$ 个样本的实值序列 $\\{x[n]\\}_{n=0}^{N-1}$。为了探测微弱的行星信号，需要将一个模板光谱 $\\{t[n]\\}_{n=0}^{N-1}$ 与观测数据在所有对应多普勒频移的整数延迟下进行互相关。考虑计算所有输出索引 $k \\in \\{0,1,\\dots,2N-2\\}$ 的完整线性互相关 $\\rho[k]$，其中离散互相关（对于实数序列）定义为\n$$\n\\rho[k] = \\sum_{n=0}^{N-1} x[n]\\,t[n+k]\n$$\n$t[\\cdot]$ 在 $[0,N-1]$ 范围外通过补零进行扩展，因此 $\\rho[k]$ 的长度为 $2N-1$。\n\n考虑两种算法策略：\n\n1. 直接时域计算，通过显式地构建每个求和来评估 $\\rho[k]$，和中的每一项计为一次浮点乘法和一次浮点加法。\n\n2. 使用快速傅里叶变换（FFT）的频域方法，调用卷积定理，并通过将两个输入都补零至长度 $L$，进行两次正向FFT，一次逐点复数乘法 $X(\\omega)\\,\\overline{T(\\omega)}$，以及一次逆向FFT来计算 $\\rho$。假设 $L$ 被选为满足 $L \\ge 2N-1$ 的最小的2的幂。对于长度为 $L$ 的基-2复数FFT，采用以下广泛使用的运算模型：每次变换恰好需要 $5L\\log_{2}L$ 次实数浮点运算（flops），而在 $L$ 个频率上的逐点复数乘法恰好需要 $6L$ 次实数flops。\n\na) 从离散互相关的定义和补零出发，推导直接法作为 $N$ 的函数的总浮点运算次数 $F_{\\mathrm{dir}}(N)$，以及基于FFT的方法作为 $N$ 的函数（通过 $L(N)=2^{\\lceil \\log_{2}(2N-1)\\rceil}$）的总浮点运算次数 $F_{\\mathrm{fft}}(N)$。\n\nb) 指出两种方法的渐近计算复杂度（用 $N$ 表示）。\n\nc) 对于一次系外行星互相关运行，其中样本数为 $N=10^{6}$，取 $L$ 如上定义。假设直接法的持续执行速率为 $r_{\\mathrm{dir}}=8.0\\times 10^{9}$ flops/秒，而基于FFT的流程（包括变换和逐点乘法）的执行速率为 $r_{\\mathrm{fft}}=4.0\\times 10^{10}$ flops/秒。使用您在(a)部分中的运算次数模型，估算每种方法的挂钟运行时间（秒）。\n\n将您的两个运行时间估计值四舍五入到三位有效数字，并将最终的运行时间对表示为一个行矩阵，第一个条目是直接法的运行时间，第二个条目是基于FFT的方法的运行时间。",
            "solution": "a) 浮点运算次数的推导\n\n首先，我们确定直接时域方法的总浮点运算（flop）次数 $F_{\\mathrm{dir}}(N)$。互相关定义为 $\\rho[k] = \\sum_{n=0}^{N-1} x[n]\\,t[n+k]$。要计算两个长度为 $N$ 的序列的完整线性互相关，结果序列的长度为 $2N-1$。延迟范围从 $-(N-1)$ 到 $N-1$。我们假设问题中的输出索引 $k$ 映射到这个范围。对于给定的延迟（我们可以表示为 $k'$，其中 $k' \\in \\{-(N-1), \\dots, N-1\\}$），和中的非零项数量由两个序列重叠的大小给出。这个数量是 $N - |k'|$。\n\n所有求和的总项数是每个延迟的项数之和：\n$$\n\\text{总项数} = \\sum_{k'=-(N-1)}^{N-1} (N - |k'|)\n$$\n这个和可以拆分：\n$$\n\\text{总项数} = (N - |0|) + \\sum_{k'=1}^{N-1} (N - k') + \\sum_{k'=- (N-1)}^{-1} (N - (-k'))\n$$\n$$\n= N + 2 \\sum_{k'=1}^{N-1} (N - k')\n$$\n令 $j = N - k'$。当 $k'$ 从 $1$ 变到 $N-1$ 时，$j$ 从 $N-1$ 递减到 $1$。\n$$\n\\text{总项数} = N + 2 \\sum_{j=1}^{N-1} j = N + 2 \\frac{(N-1)N}{2} = N + N^2 - N = N^2\n$$\n问题规定我们“和中的每一项计为一次浮点乘法和一次浮点加法”。这被解释为计算和累加每个非零乘积 $x[n]t[n+k]$ 的成本为 2 flops。因此，总flop次数是总项数的两倍。\n$$\nF_{\\mathrm{dir}}(N) = 2 \\times (\\text{总项数}) = 2N^2\n$$\n接下来，我们确定基于FFT的方法的flop次数 $F_{\\mathrm{fft}}(N)$。该方法包括以下步骤：\n1.  对补零后的输入序列进行两次长度为 $L$ 的正向快速傅里叶变换（FFT）。\n2.  对得到的光谱进行一次逐点复数乘法 $X(\\omega)\\overline{T(\\omega)}$。\n3.  进行一次长度为 $L$ 的逆向FFT，将结果变换回时域。\n\n长度 $L$ 由 $L = 2^{\\lceil \\log_{2}(2N-1)\\rceil}$ 给出。各部分的flop次数如下：\n-   一次复数FFT（正向或逆向）的成本：$5L\\log_{2}L$ flops。\n-   $L$ 个点的逐点复数乘法的成本：$6L$ flops。\n\n总flop次数是两次正向FFT、一次逆向FFT和逐点乘法成本之和。\n$$\nF_{\\mathrm{fft}}(N) = (\\text{FFT of } x) + (\\text{FFT of } t) + (\\text{pointwise mult}) + (\\text{IFFT of product})\n$$\n$$\nF_{\\mathrm{fft}}(N) = (5L\\log_{2}L) + (5L\\log_{2}L) + 6L + (5L\\log_{2}L)\n$$\n$$\nF_{\\mathrm{fft}}(N) = 15L\\log_{2}L + 6L = L(15\\log_{2}L + 6)\n$$\n代入 $L = L(N)$ 的表达式：\n$$\nF_{\\mathrm{fft}}(N) = 2^{\\lceil \\log_{2}(2N-1)\\rceil} \\left( 15\\log_{2}\\left(2^{\\lceil \\log_{2}(2N-1)\\rceil}\\right) + 6 \\right)\n$$\n由于 $\\log_{2}(2^p) = p$，这可以简化为：\n$$\nF_{\\mathrm{fft}}(N) = 2^{\\lceil \\log_{2}(2N-1)\\rceil} \\left( 15 \\lceil \\log_{2}(2N-1)\\rceil + 6 \\right)\n$$\n\nb) 渐近计算复杂度\n\n对于直接法，flop次数为 $F_{\\mathrm{dir}}(N) = 2N^2$。当 $N \\to \\infty$ 时，复杂度由 $N$ 的最高次幂决定。因此，渐近复杂度为：\n$$\nO(N^2)\n$$\n对于基于FFT的方法，我们分析 $L(N) = 2^{\\lceil \\log_{2}(2N-1)\\rceil}$ 在 $N$ 很大时的行为。向上取整函数确保了 $\\log_{2}(2N-1) \\le \\lceil \\log_{2}(2N-1)\\rceil  \\log_{2}(2N-1) + 1$。这意味着 $2N-1 \\le L  2(2N-1)$。因此，$L$ 与 $N$ 是同阶的，即 $L \\in O(N)$。相应地，$\\log_{2}L \\in O(\\log N)$。\nflop次数为 $F_{\\mathrm{fft}}(N) \\approx 15L\\log_{2}L$。因此，渐近复杂度为：\n$$\nO(N \\log N)\n$$\n\nc) 挂钟运行时间估算\n\n给定 $N = 10^6$，我们计算具体的flop次数和运行时间。\n\n对于直接法：\n总浮点运算次数为：\n$$\nF_{\\mathrm{dir}}(10^6) = 2 \\times (10^6)^2 = 2 \\times 10^{12} \\text{ flops}\n$$\n持续执行速率为 $r_{\\mathrm{dir}} = 8.0 \\times 10^9$ flops/s。估计的运行时间为：\n$$\nT_{\\mathrm{dir}} = \\frac{F_{\\mathrm{dir}}(10^6)}{r_{\\mathrm{dir}}} = \\frac{2 \\times 10^{12}}{8.0 \\times 10^9} \\, \\text{s} = 0.25 \\times 10^3 \\, \\text{s} = 250 \\, \\text{s}\n$$\n保留三位有效数字，结果是 $250$ 秒。\n\n对于基于FFT的方法：\n首先，我们确定FFT长度 $L$。要求的长度至少为 $2N-1 = 2 \\times 10^6 - 1 = 1,999,999$。\n我们需要找到最小的2的幂 $L = 2^k$，使得 $L \\ge 1,999,999$。\n$$\n\\log_{2}(1,999,999) = \\frac{\\ln(1,999,999)}{\\ln(2)} \\approx \\frac{14.50865}{0.69315} \\approx 20.93\n$$\n最小的整数指数 $k$ 必须是 $\\lceil 20.93 \\rceil = 21$。\n所以，$L = 2^{21} = 2,097,152$。\n$\\log_{2}L$ 项恰好是 $21$。\n\n现在，我们计算总浮点运算次数：\n$$\nF_{\\mathrm{fft}}(10^6) = L(15\\log_{2}L + 6) = 2^{21} (15 \\times 21 + 6)\n$$\n$$\nF_{\\mathrm{fft}}(10^6) = 2,097,152 \\times (315 + 6) = 2,097,152 \\times 321 = 673,185,792 \\text{ flops}\n$$\n持续执行速率为 $r_{\\mathrm{fft}} = 4.0 \\times 10^{10}$ flops/s。估计的运行时间为：\n$$\nT_{\\mathrm{fft}} = \\frac{F_{\\mathrm{fft}}(10^6)}{r_{\\mathrm{fft}}} = \\frac{673,185,792}{4.0 \\times 10^{10}} \\, \\text{s} \\approx 0.0168296 \\, \\text{s}\n$$\n四舍五入到三位有效数字，我们得到 $0.0168$ 秒。\n\n运行时间对（直接法，基于FFT的方法）为 $(250 \\, \\text{s}, 0.0168 \\, \\text{s})$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 250  0.0168 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "交叉相关技术的一个核心假设是，我们使用的模板能够精确匹配目标天体的内在光谱特征，但这在现实中几乎无法完美实现。模板与实际谱线在形状上的失配（例如，由恒星自转或仪器分辨率差异引起的谱线增宽不同）是否会导致测得的速度存在系统性偏差？本练习将通过一个理想化的数学模型，解析地探讨这一问题。通过这个思想实验，你将深入理解模型假设对测量精度的影响，并认识到系统误差的来源可能比直觉更为微妙。",
            "id": "4163371",
            "problem": "考虑一个用于通过互相关方法估计视向速度的高分辨率、连续谱归一化的恒星光谱。在对数波长 $x \\equiv \\ln \\lambda$ 下进行分析，这样在非相对论极限下，由速度 $v$ 引起的多普勒频移对应于一个平移 $x \\mapsto x - \\Delta$，其中 $\\Delta \\equiv v/c$。假设内禀恒星吸收线轮廓是一个单一、孤立的高斯函数，其深度和归一化被吸收到常数中，并且恒星自转近似为高斯展宽（这是一种为了解析易处理性而科学上常用的替代方法，尽管真实的自转核函数并非高斯型）。观测光谱则建模为\n$$\nI_{\\mathrm{obs}}(x) \\;=\\; 1 - a \\,\\exp\\!\\left( -\\frac{(x - \\Delta_{0})^{2}}{2 s_{o}^{2}} \\right),\n$$\n其中 $\\Delta_{0} \\equiv v_{0}/c$ 编码了真实的恒星视向速度 $v_{0}$，$a0$ 是一个常数谱线深度因子，$s_{o}0$ 是在 $x$ 坐标下的观测高斯宽度，它已经包含了与自转展宽卷积后的内禀宽度。通过将内禀谱线与一个宽度为 $s_{t}0$ 的高斯函数进行卷积（旨在模拟一个选定的 $v\\sin i$），制备了一个合成模板，其表达式为\n$$\nI_{\\mathrm{tpl}}(x) \\;=\\; 1 - b \\,\\exp\\!\\left( -\\frac{x^{2}}{2 s_{t}^{2}} \\right),\n$$\n其中 $b0$ 是一个（可能不同的）深度参数。假设存在加性、白色的高斯探测器噪声和一个平坦的连续谱。在这些假设下，基于互相关函数（CCF）的最大似然位移估计量等价于使扣除连续谱后的观测光谱与经过平移并扣除连续谱后的模板之间的相关积分最大化的那个位移。使用互相关函数 $C(\\Delta)$ 的定义，\n$$\nC(\\Delta) \\;\\equiv\\; \\int_{-\\infty}^{\\infty}\\!\\big(I_{\\mathrm{obs}}(x)-1\\big)\\,\\big(I_{\\mathrm{tpl}}(x-\\Delta)-1\\big)\\,\\mathrm{d}x,\n$$\n估计位移 $\\widehat{\\Delta}$ 满足 $\\widehat{\\Delta} \\in \\arg\\max_{\\Delta} C(\\Delta)$，相应的估计速度为 $\\widehat{v} \\equiv c\\,\\widehat{\\Delta}$。从上述基本定义出发，并且不使用任何预先制表的互相关恒等式，解析地推导对于高斯展宽核，测量速度中的偏差，\n$$\nb_{v} \\;\\equiv\\; \\widehat{v} - v_{0},\n$$\n作为 $a$、$b$、$s_{o}$ 和 $s_{t}$ 的函数。您必须将最终答案表示为以米每秒为单位的单个数值。如果您的推导得出一个非零常数，请将最终结果四舍五入到四位有效数字。请从给定的建模和互相关的定义开始，清楚地陈述推导过程中使用的任何中间步骤和理由。将最终偏差以米每秒（m/s）为单位表示。",
            "solution": "目标是求出速度偏差 $b_v = \\widehat{v} - v_0$。这需要求出估计速度 $\\widehat{v}$，而估计速度又取决于使互相关函数 $C(\\Delta)$ 最大化的位移 $\\widehat{\\Delta}$。\n\n首先，我们表示出CCF积分所需的扣除连续谱后的项。\n根据观测光谱的定义，我们有：\n$$\nI_{\\mathrm{obs}}(x) - 1 = -a \\exp\\left( -\\frac{(x - \\Delta_{0})^{2}}{2 s_{o}^{2}} \\right)\n$$\n对于模板，我们首先将其平移 $\\Delta$，然后减去连续谱：\n$$\nI_{\\mathrm{tpl}}(x-\\Delta) = 1 - b \\exp\\left( -\\frac{(x-\\Delta)^{2}}{2 s_{t}^{2}} \\right)\n$$\n$$\nI_{\\mathrm{tpl}}(x-\\Delta) - 1 = -b \\exp\\left( -\\frac{(x-\\Delta)^{2}}{2 s_{t}^{2}} \\right)\n$$\n现在，我们将这些代入互相关函数 $C(\\Delta)$ 的定义中：\n$$\nC(\\Delta) = \\int_{-\\infty}^{\\infty} \\left[ -a \\exp\\left( -\\frac{(x - \\Delta_{0})^{2}}{2 s_{o}^{2}} \\right) \\right] \\left[ -b \\exp\\left( -\\frac{(x-\\Delta)^{2}}{2 s_{t}^{2}} \\right) \\right] \\mathrm{d}x\n$$\n常数因子 $a$ 和 $b$ 可以移到积分符号外面：\n$$\nC(\\Delta) = ab \\int_{-\\infty}^{\\infty} \\exp\\left( -\\frac{(x - \\Delta_{0})^{2}}{2 s_{o}^{2}} - \\frac{(x-\\Delta)^{2}}{2 s_{t}^{2}} \\right) \\mathrm{d}x\n$$\n为了找到使 $C(\\Delta)$ 最大化的 $\\Delta$ 值，我们必须分析积分内的指数。设指数的参数为 $E(x, \\Delta)$。\n$$\nE(x, \\Delta) = -\\frac{1}{2} \\left[ \\frac{(x - \\Delta_{0})^{2}}{s_{o}^{2}} + \\frac{(x - \\Delta)^{2}}{s_{t}^{2}} \\right]\n$$\n我们展开括号中的平方项：\n$$\n\\frac{x^2 - 2x\\Delta_0 + \\Delta_0^2}{s_o^2} + \\frac{x^2 - 2x\\Delta + \\Delta^2}{s_t^2}\n$$\n现在，我们按 $x$ 的幂次对各项进行分组，以便对 $x$ 进行配方：\n$$\nx^2 \\left(\\frac{1}{s_o^2} + \\frac{1}{s_t^2}\\right) - 2x \\left(\\frac{\\Delta_0}{s_o^2} + \\frac{\\Delta}{s_t^2}\\right) + \\left(\\frac{\\Delta_0^2}{s_o^2} + \\frac{\\Delta^2}{s_t^2}\\right)\n$$\n我们定义 $A = \\frac{1}{s_o^2} + \\frac{1}{s_t^2}$ 和 $B(\\Delta) = \\frac{\\Delta_0}{s_o^2} + \\frac{\\Delta}{s_t^2}$。表达式变为 $Ax^2 - 2B(\\Delta)x + \\text{常数项}$。\n对依赖于 $x$ 的部分进行配方，得到 $A\\left(x - \\frac{B(\\Delta)}{A}\\right)^2 - \\frac{B(\\Delta)^2}{A}$。\n括号中的完整表达式可以改写为：\n$$\nA\\left(x - \\frac{B(\\Delta)}{A}\\right)^2 + \\left(\\frac{\\Delta_0^2}{s_o^2} + \\frac{\\Delta^2}{s_t^2}\\right) - \\frac{B(\\Delta)^2}{A}\n$$\n第一项，$A\\left(x - \\frac{B(\\Delta)}{A}\\right)^2$，是关于 $x$ 的二次项。其余各项仅依赖于 $\\Delta$ 和常数参数。我们来分析这个依赖于 $\\Delta$ 的部分，我们称之为 $Q(\\Delta)$：\n$$\nQ(\\Delta) = \\left(\\frac{\\Delta_0^2}{s_o^2} + \\frac{\\Delta^2}{s_t^2}\\right) - \\frac{\\left(\\frac{\\Delta_0}{s_o^2} + \\frac{\\Delta}{s_t^2}\\right)^2}{\\frac{1}{s_o^2} + \\frac{1}{s_t^2}}\n$$\n我们通过为分子项找一个共同的分母来简化 $Q(\\Delta)$：\n$$\n\\text{Numerator} = \\frac{\\left(\\frac{\\Delta_0^2}{s_o^2} + \\frac{\\Delta^2}{s_t^2}\\right)\\left(\\frac{1}{s_o^2} + \\frac{1}{s_t^2}\\right) - \\left(\\frac{\\Delta_0^2}{s_o^4} + \\frac{2\\Delta_0\\Delta}{s_o^2 s_t^2} + \\frac{\\Delta^2}{s_t^4}\\right)}{\\frac{1}{s_o^2}+\\frac{1}{s_t^2}}\n$$\n展开分子中的第一个乘积：\n$$\n\\frac{\\Delta_0^2}{s_o^4} + \\frac{\\Delta_0^2}{s_o^2 s_t^2} + \\frac{\\Delta^2}{s_t^2 s_o^2} + \\frac{\\Delta^2}{s_t^4}\n$$\n减去分子的第二部分：\n$$\n\\left(\\frac{\\Delta_0^2}{s_o^4} + \\frac{\\Delta_0^2+\\Delta^2}{s_o^2 s_t^2} + \\frac{\\Delta^2}{s_t^4}\\right) - \\left(\\frac{\\Delta_0^2}{s_o^4} + \\frac{2\\Delta_0\\Delta}{s_o^2 s_t^2} + \\frac{\\Delta^2}{s_t^4}\\right) = \\frac{\\Delta_0^2 - 2\\Delta_0\\Delta + \\Delta^2}{s_o^2 s_t^2} = \\frac{(\\Delta_0-\\Delta)^2}{s_o^2 s_t^2}\n$$\n$Q(\\Delta)$ 的分母是 $\\frac{1}{s_o^2} + \\frac{1}{s_t^2} = \\frac{s_o^2+s_t^2}{s_o^2 s_t^2}$。\n因此，$Q(\\Delta)$ 简化为：\n$$\nQ(\\Delta) = \\frac{\\frac{(\\Delta_0-\\Delta)^2}{s_o^2 s_t^2}}{\\frac{s_o^2+s_t^2}{s_o^2 s_t^2}} = \\frac{(\\Delta - \\Delta_0)^2}{s_o^2 + s_t^2}\n$$\n$C(\\Delta)$ 的积分现在可以表示为：\n$$\nC(\\Delta) = ab \\int_{-\\infty}^{\\infty} \\exp\\left( -\\frac{1}{2} \\left[ A\\left(x - \\frac{B(\\Delta)}{A}\\right)^2 + \\frac{(\\Delta - \\Delta_0)^2}{s_o^2 + s_t^2} \\right] \\right) \\mathrm{d}x\n$$\n我们可以把不依赖于积分变量 $x$ 的项提出来：\n$$\nC(\\Delta) = ab \\exp\\left(-\\frac{(\\Delta - \\Delta_0)^2}{2(s_o^2 + s_t^2)}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left( -\\frac{A}{2} \\left(x - \\frac{B(\\Delta)}{A}\\right)^2 \\right) \\mathrm{d}x\n$$\n这个积分是一个标准的高斯积分，其值 $\\sqrt{2\\pi/A}$ 相对于 $\\Delta$ 是一个常数。设这个常数因子为 $K_c = ab\\sqrt{2\\pi/A}$。\n$$\nC(\\Delta) = K_c \\exp\\left(-\\frac{(\\Delta - \\Delta_0)^2}{2(s_o^2 + s_t^2)}\\right)\n$$\n这个函数 $C(\\Delta)$ 是关于变量 $\\Delta$ 的一个高斯分布。高斯函数的最大值出现在其均值处。当指数中的项最大化时，该表达式取得最大值，这意味着二次项 $(\\Delta - \\Delta_0)^2$ 必须最小化。最小值为 $0$，这在以下情况时发生：\n$$\n\\Delta = \\Delta_0\n$$\n因此，使互相关函数最大化的估计位移 $\\widehat{\\Delta}$ 等于真实的位移 $\\Delta_0$。\n$$\n\\widehat{\\Delta} = \\Delta_0\n$$\n估计的视向速度 $\\widehat{v}$ 定义为 $\\widehat{v} = c\\widehat{\\Delta}$。代入我们关于 $\\widehat{\\Delta}$ 的结果：\n$$\n\\widehat{v} = c\\Delta_0\n$$\n问题陈述了真实的恒星视向速度 $v_0$ 通过 $\\Delta_0 = v_0/c$ 与 $\\Delta_0$ 相关，这意味着 $v_0 = c\\Delta_0$。\n因此，我们发现估计速度等于真实速度：\n$$\n\\widehat{v} = v_0\n$$\n测量速度中的偏差 $b_v$ 定义为估计速度与真实速度之差：\n$$\nb_v \\equiv \\widehat{v} - v_0\n$$\n代入我们的发现，我们得到：\n$$\nb_v = v_0 - v_0 = 0\n$$\n在问题的理想化假设（高斯线轮廓、高斯自转展宽替代模型以及无噪声的CCF最大值确定）下，偏差恒为零。参数 $a$、$b$、$s_o$ 和 $s_t$ 会影响CCF的高度和宽度，这决定了在存在噪声的情况下速度测量的精度，但它们在这个模型中不会引入系统偏差。计算出的偏差为 0 m/s，这是一个符合要求的单一数值。",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}