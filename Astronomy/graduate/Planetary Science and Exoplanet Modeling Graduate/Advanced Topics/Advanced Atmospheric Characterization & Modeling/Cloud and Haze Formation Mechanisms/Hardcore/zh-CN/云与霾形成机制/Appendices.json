{
    "hands_on_practices": [
        {
            "introduction": "光化学雾霾并非在所有高度上均匀形成，其生成依赖于两大关键要素：高能光子和前体气体。本练习将引导你理解，来自上层大气的紫外光通量衰减与随深度增加的气体密度之间的权衡，如何自然地形成一个峰值产率层。通过推导并计算这一峰值所在的高度 ，你将掌握一个决定行星大气中雾霾层位置的基本原理。",
            "id": "4156107",
            "problem": "考虑一个与行星和系外行星建模相关的平面平行等温大气。设垂直坐标 $z$ 从大气层顶（TOA）向下测量，因此在TOA处 $z = 0$，且 $z$ 朝着更深层增加。假设一个静水平衡的等温廓线，其数密度为 $n(z) = n_0 \\exp\\left(z/H\\right)$，其中 $n_0$ 是TOA处的数密度，$H$ 是恒定的标高。紫外（UV）光子从上方进入大气层，在TOA处的通量为 $F_0$（单位：光子/平方米/秒）。光子被单一吸收性物种衰减，其吸收截面为 $\\sigma_a$（单位：平方米）。根据平面平行比尔-朗伯定律，向下的紫外通量 $F(z)$ 满足\n$$\n\\frac{dF}{dz} = - \\sigma_a n(z) F(z),\n$$\n且 $F(0) = F_0$。通过将光解与前体物数密度耦合，定义了一个简单的单位体积霾单体产生率\n$$\nQ(z) = Y \\, \\sigma_p \\, F(z) \\, r \\, n(z),\n$$\n其中 $Y$ 是一个无量纲的量子产率，$\\sigma_p$ 是光解截面（单位：平方米），$r$ 是前体物数密度与吸收物数密度之比的常数。假设所有参数均为正数，并且不随 $z$ 变化。\n\n任务：\n1. 从给定的定律和定义（静水平衡等温廓线和比尔-朗伯衰减）出发，推导 $F(z)$，然后推导 $Q(z)$ 作为 $z$ 的显式函数。\n2. 仅使用所得表达式和第一性原理微积分，确定 $Q(z)$ 达到其最大值时的高度 $z^\\star$（从TOA向下测量）。如果没有内部极大值，则取 $z^\\star = 0$。\n3. 实现一个程序，为几组参数集计算 $z^\\star$。将每个测试用例的最终答案表示为从TOA向下的距离（单位：千米），并四舍五入到三位小数。\n\n使用以下参数值的测试套件，每个都以元组 $(F_0, \\sigma_a, \\sigma_p, n_0, H, Y, r)$ 的形式提供，单位在上方和下方指定：\n- 情况 1：$\\left(10^{15}, \\; 10^{-20}, \\; 10^{-20}, \\; 10^{15}, \\; 2.0 \\times 10^{4}, \\; 0.1, \\; 1.0\\right)$\n- 情况 2：$\\left(10^{15}, \\; 5.0 \\times 10^{-20}, \\; 10^{-20}, \\; 10^{15}, \\; 2.0 \\times 10^{4}, \\; 0.1, \\; 1.0\\right)$\n- 情况 3：$\\left(10^{15}, \\; 2.5 \\times 10^{-19}, \\; 10^{-20}, \\; 10^{15}, \\; 2.0 \\times 10^{4}, \\; 0.1, \\; 1.0\\right)$\n- 情况 4：$\\left(10^{15}, \\; 5.0 \\times 10^{-22}, \\; 10^{-20}, \\; 10^{15}, \\; 2.0 \\times 10^{4}, \\; 0.1, \\; 1.0\\right)$\n\n元组中的所有量使用以下单位：\n- $F_0$ 单位为 光子/平方米/秒，\n- $\\sigma_a$ 和 $\\sigma_p$ 单位为 平方米，\n- $n_0$ 单位为 /立方米，\n- $H$ 单位为 米，\n- $Y$ 和 $r$ 是无量纲的。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如 $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\right]$，其中每个 $\\text{result}_i$ 是以千米表示的 $z^\\star$，四舍五入到三位小数。",
            "solution": "在尝试求解之前，该问题经过了严格的验证过程。\n\n### 问题验证\n\n#### 步骤1：提取已知条件\n该问题提供了以下数据、定义和约束：\n- **坐标系**：一个垂直坐标 $z$，从大气层顶（TOA）向下测量，其中 $z=0$。\n- **大气结构**：一个处于静水平衡状态的平面平行等温大气。\n- **数密度廓线**：$n(z) = n_0 \\exp\\left(z/H\\right)$，其中 $n_0$ 是TOA处的数密度，$H$ 是恒定的标高。\n- **入射辐射**：在TOA处的向下的紫外光子通量，$F(0) = F_0$。\n- **光子衰减**：向下的通量 $F(z)$ 根据平面平行比尔-朗伯定律衰减：$\\frac{dF}{dz} = - \\sigma_a n(z) F(z)$，其中 $\\sigma_a$ 是吸收截面。\n- **霾产生率**：单位体积的单体产生率由 $Q(z) = Y \\, \\sigma_p \\, F(z) \\, r \\, n(z)$ 给出，其中 $Y$ 是量子产率，$\\sigma_p$ 是光解截面，$r$ 是前体物与吸收物数密度之比的常数。\n- **参数约束**：所有参数（$F_0$, $\\sigma_a$, $\\sigma_p$, $n_0$, $H$, $Y$, $r$）均为正数，并且不随高度 $z$ 变化。\n- **任务**：\n    1. 推导 $F(z)$ 和 $Q(z)$ 的表达式。\n    2. 确定使 $Q(z)$ 最大化的高度 $z^\\star$，并设定若不存在内部极大值则 $z^\\star = 0$ 的条件。\n    3. 实现一个程序，为给定的测试用例计算 $z^\\star$。\n- **测试用例**：为参数提供了四组数值，并指定了单位。\n\n#### 步骤2：使用提取的已知条件进行验证\n根据既定标准对问题进行评估：\n- **科学依据**：所呈现的模型是大气光化学的一个标准简化表示，称为查普曼理论框架。静水平衡中等温大气的指数密度廓线和辐射衰减的比尔-朗伯定律是行星科学的基本原理。产生率的公式是光化学建模中的标准构造。该问题在科学上是合理的。\n- **良态的**：该问题是良态的。它为通量 $F(z)$ 指定了一个一阶常微分方程，并带有明确的初始条件 ($F(0) = F_0$)。函数 $Q(z)$ 被明确定义，并且求其最大值是微分学中一个标准的可解问题。所有必要的参数都已提供。\n- **客观的**：问题以精确、定量和无偏见的语言陈述。没有主观或模棱两可的术语。\n\n#### 步骤3：结论和行动\n该问题被视为 **有效**。它是自洽的、科学合理的和良态的。现在将根据所提供的信息来推导解答。\n\n### 解答推导\n\n解答按任务要求分两部分进行：首先，推导 $F(z)$ 和 $Q(z)$ 的显式形式；其次，确定 $Q(z)$ 最大化时的高度 $z^\\star$。\n\n#### 第1部分：推导 $F(z)$ 和 $Q(z)$\n\n我们从光子通量衰减的微分方程，即比尔-朗伯定律开始：\n$$\n\\frac{dF}{dz} = - \\sigma_a n(z) F(z)\n$$\n数密度廓线由 $n(z) = n_0 \\exp(z/H)$ 给出。将其代入微分方程得到：\n$$\n\\frac{dF}{dz} = - \\sigma_a n_0 \\exp(z/H) F(z)\n$$\n这是一个一阶可分离常微分方程。我们可以重新整理它以分离变量 $F$ 和 $z$：\n$$\n\\frac{1}{F(z)} dF = - \\sigma_a n_0 \\exp(z/H) dz\n$$\n为了求 $F(z)$，我们对两边进行积分。积分从大气层顶，即高度 $z' = 0$ 且通量为 $F(0) = F_0$ 的地方，到一个任意深度 $z$：\n$$\n\\int_{F_0}^{F(z)} \\frac{1}{F'} dF' = - \\int_{0}^{z} \\sigma_a n_0 \\exp(z'/H) dz'\n$$\n计算两边的积分：\n$$\n\\left[ \\ln(F') \\right]_{F_0}^{F(z)} = - \\sigma_a n_0 \\left[ H \\exp(z'/H) \\right]_0^z\n$$\n$$\n\\ln(F(z)) - \\ln(F_0) = - \\sigma_a n_0 H \\left( \\exp(z/H) - \\exp(0) \\right)\n$$\n$$\n\\ln\\left(\\frac{F(z)}{F_0}\\right) = - \\sigma_a n_0 H \\left( \\exp(z/H) - 1 \\right)\n$$\n对两边取指数以求解 $F(z)$，得到光子通量的显式函数：\n$$\nF(z) = F_0 \\exp\\left[ - \\sigma_a n_0 H \\left( \\exp\\left(\\frac{z}{H}\\right) - 1 \\right) \\right]\n$$\n该表达式描述了紫外通量如何随着其深入大气层而从其初始值 $F_0$ 开始减小。\n\n接下来，我们推导霾产生率 $Q(z)$ 的表达式。问题将其定义为：\n$$\nQ(z) = Y \\, \\sigma_p \\, r \\, n(z) \\, F(z)\n$$\n代入 $n(z)$ 和 $F(z)$ 的表达式：\n$$\nQ(z) = Y \\sigma_p r \\left( n_0 \\exp\\left(\\frac{z}{H}\\right) \\right) \\left( F_0 \\exp\\left[ - \\sigma_a n_0 H \\left( \\exp\\left(\\frac{z}{H}\\right) - 1 \\right) \\right] \\right)\n$$\n为了简化此表达式以便分析，我们可以合并指数项：\n$$\nQ(z) = Y \\sigma_p r n_0 F_0 \\exp\\left(\\frac{z}{H}\\right) \\exp\\left( - \\sigma_a n_0 H \\exp\\left(\\frac{z}{H}\\right) + \\sigma_a n_0 H \\right)\n$$\n$$\nQ(z) = \\left( Y \\sigma_p r n_0 F_0 \\exp(\\sigma_a n_0 H) \\right) \\exp\\left(\\frac{z}{H}\\right) \\exp\\left( - \\sigma_a n_0 H \\exp\\left(\\frac{z}{H}\\right) \\right)\n$$\n这就是单位体积霾产生率 $Q(z)$ 的显式函数。\n\n#### 第2部分：最大产生率时的高度 $z^\\star$\n\n为了找到 $Q(z)$ 最大时的高度 $z^\\star$，我们必须找到使导数 $\\frac{dQ}{dz}$ 等于零的 $z$ 值。让我们通过定义一组常数和一个新变量来简化 $Q(z)$ 的表达式。\n令 $C_1 = Y \\sigma_p r n_0 F_0 \\exp(\\sigma_a n_0 H)$，它整合了所有相对于 $z$ 是常数的项。\n令 $C_2 = \\sigma_a n_0 H$。该项是无量纲的，并且是一个特征光学深度参数。\n令 $x = \\exp(z/H)$。\n$Q$ 的表达式变成一个关于 $x$ 的函数：\n$$\nQ(x) = C_1 \\, x \\, \\exp(-C_2 \\, x)\n$$\n我们寻求使 $Q$ 相对于 $z$ 最大化。使用链式法则，$\\frac{dQ}{dz} = \\frac{dQ}{dx} \\frac{dx}{dz}$。由于 $\\frac{dx}{dz} = \\frac{1}{H}\\exp(z/H) = \\frac{x}{H}$，对于 $z \\ge 0$ 恒为正，因此 $\\frac{dQ}{dz}$ 的符号由 $\\frac{dQ}{dx}$ 的符号决定。因此，求 $Q(z)$ 的最大值等价于求 $Q(x)$ 的最大值。\n\n我们使用乘积法则对 $Q(x)$ 相对于 $x$ 进行微分：\n$$\n\\frac{dQ}{dx} = C_1 \\left[ (1) \\cdot \\exp(-C_2 x) + x \\cdot (-C_2 \\exp(-C_2 x)) \\right]\n$$\n$$\n\\frac{dQ}{dx} = C_1 \\exp(-C_2 x) (1 - C_2 x)\n$$\n将导数设为零以求临界点：\n$$\nC_1 \\exp(-C_2 x) (1 - C_2 x) = 0\n$$\n由于 $C_1  0$ 且 $\\exp(-C_2 x)  0$，方程仅在以下情况下成立：\n$$\n1 - C_2 x = 0 \\implies x = \\frac{1}{C_2}\n$$\n为了确认这是一个最大值，我们可以检验二阶导数 $\\frac{d^2Q}{dx^2}$。\n$$\n\\frac{d^2Q}{dx^2} = C_1 \\left[ -C_2 \\exp(-C_2 x)(1 - C_2 x) + \\exp(-C_2 x)(-C_2) \\right] = -C_1 C_2 \\exp(-C_2 x) [ (1 - C_2 x) + 1]\n$$\n在临界点 $x=1/C_2$ 处，项 $(1-C_2 x)$ 为零，所以：\n$$\n\\left. \\frac{d^2Q}{dx^2} \\right|_{x=1/C_2} = -C_1 C_2 \\exp(-1) [0 + 1] = - \\frac{C_1 C_2}{e}\n$$\n由于 $C_1  0$ 和 $C_2  0$，二阶导数为负，确认了 $x = 1/C_2$ 对应一个局部极大值。\n\n现在，我们代回原始变量来求高度 $z^\\star$。\n最大值出现在 $x^\\star = \\exp(z^\\star/H) = 1/C_2$。\n$$\n\\exp\\left(\\frac{z^\\star}{H}\\right) = \\frac{1}{\\sigma_a n_0 H}\n$$\n对两边取自然对数：\n$$\n\\frac{z^\\star}{H} = \\ln\\left( \\frac{1}{\\sigma_a n_0 H} \\right) = - \\ln(\\sigma_a n_0 H)\n$$\n$$\nz^\\star = -H \\ln(\\sigma_a n_0 H)\n$$\n这给出了最大产生率的高度，前提是 $z^\\star  0$。由于 $H  0$，这要求 $\\ln(\\sigma_a n_0 H)  0$，而这仅在 $0  \\sigma_a n_0 H  1$ 时成立。\n\n如果 $\\sigma_a n_0 H \\ge 1$，那么 $\\ln(\\sigma_a n_0 H) \\ge 0$，这意味着 $z^\\star \\le 0$。由于 $z$ 是从TOA向下的距离，它必须是非负的 ($z \\ge 0$)。$z^\\star \\le 0$ 的结果意味着在大气内部（对于 $z  0$）没有内部极大值。在这种情况下，函数 $Q(z)$ 从 $z=0$ 开始单调递减，其在定义域 $z \\ge 0$ 内的最大值出现在边界 $z=0$ 处。\n\n这与问题的指令一致：“如果没有内部极大值，则取 $z^\\star = 0$。”\n\n因此，$z^\\star$ 的最终表达式是：\n$$\nz^\\star =\n\\begin{cases}\n-H \\ln(\\sigma_a n_0 H)  \\text{如果 } \\sigma_a n_0 H  1 \\\\\n0  \\text{如果 } \\sigma_a n_0 H \\ge 1\n\\end{cases}\n$$\n这可以简洁地表示为 $z^\\star = \\max(0, -H \\ln(\\sigma_a n_0 H))$。对于程序实现，所需的计算仅依赖于 $\\sigma_a$、$n_0$ 和 $H$。结果以米为单位，必须转换为千米。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the altitude of maximum haze production rate for several atmospheric\n    parameter sets based on a simplified photochemical model.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (F0, sigma_a, sigma_p, n0, H, Y, r)\n    # Units: F0 (photons/m^2/s), sigma_a/sigma_p (m^2), n0 (1/m^3), H (m), Y/r (dimensionless)\n    test_cases = [\n        (1.0e15, 1.0e-20, 1.0e-20, 1.0e15, 2.0e4, 0.1, 1.0),\n        (1.0e15, 5.0e-20, 1.0e-20, 1.0e15, 2.0e4, 0.1, 1.0),\n        (1.0e15, 2.5e-19, 1.0e-20, 1.0e15, 2.0e4, 0.1, 1.0),\n        (1.0e15, 5.0e-22, 1.0e-20, 1.0e15, 2.0e4, 0.1, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters. Only sigma_a, n0, and H are needed for z_star.\n        _F0, sigma_a, _sigma_p, n0, H, _Y, _r = case\n\n        # Calculate the dimensionless parameter that determines the location of the peak.\n        # This parameter is tau_H = sigma_a * n0 * H.\n        tau_H = sigma_a * n0 * H\n\n        z_star_meters = 0.0\n        # An interior maximum exists only if tau_H  1.\n        if tau_H  1.0:\n            # The formula for the peak altitude (in meters) is z_star = -H * ln(tau_H).\n            z_star_meters = -H * np.log(tau_H)\n        else:\n            # If tau_H >= 1, the production rate Q(z) is a monotonically decreasing function\n            # for z >= 0, so the maximum occurs at the boundary z = 0.\n            z_star_meters = 0.0\n\n        # Convert the result from meters to kilometers.\n        z_star_km = z_star_meters / 1000.0\n\n        # Format the result to three decimal places as a string and add to the list.\n        results.append(f\"{z_star_km:.3f}\")\n\n    # Final print statement in the exact required format: [result1,result2,...]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "粒子形成后会继续长大。对于凝结云而言，其增长过程是水汽分子向粒子扩散与潜热从粒子传导出去之间的一场精妙博弈。本练习  要求你从第一性原理出发，推导粒子增长速率，从而揭示潜热和扩散系数等物性参数如何主导这一过程。通过比较水和甲烷的增长速率，你将深入理解在相似的大气条件下，为何不同物质形成云的效率会有所不同。",
            "id": "4156085",
            "problem": "考虑一个系外行星的静止、以氢为主的大气，在该大气中，云颗粒的凝结增长受水汽扩散和热传导限制。可能存在两种纯凝结物：水（$\\mathrm{H_2O}$）和甲烷（$\\mathrm{CH_4}$）。假设两种物质的颗粒均为半径为 $r$ 的球形颗粒，环境温度 $T$ 相同，每种物质在温度 $T$ 下的远场过饱和度 $S$（定义为 $S = n_{\\infty}/n_{s}(T) - 1$）相同，背景气体的热导率 $k_{g}$ 也相同。忽略曲率（开尔文）效应和溶质效应。将水汽视为理想气体，并假设为连续介质输运。令 $D_{v}^{(i)}$ 表示物质 $i$ 在背景气体中的水汽分子扩散系数，$L^{(i)}$ 表示物质 $i$ 的单个分子凝结时释放的潜热，$v_{m}^{(i)}$ 表示物质 $i$ 的凝结相分子体积（单个分子的体积）。令 $n_{s}^{(i)}(T)$ 表示物质 $i$ 在温度 $T$ 下的饱和水汽数密度。玻尔兹曼常数为 $k_{B}$。\n\n从菲克扩散定律和傅里叶热传导定律出发，并使用理想气体的克劳修斯-克拉佩龙关系式来关联 $n_{s}^{(i)}(T)$ 及其温度导数，推导在相同的 $S$、$T$、$r$ 和 $k_{g}$ 条件下，凝结增长速率之比 $\\left(\\frac{dr}{dt}\\right)_{\\mathrm{H_2O}}$ 与 $\\left(\\frac{dr}{dt}\\right)_{\\mathrm{CH_4}}$ 的闭合形式表达式。你的推导必须明确指出控制参数 $D_{v}^{(i)}$、$L^{(i)}$ 和 $v_{m}^{(i)}$ 是如何进入最终结果的。\n\n将最终答案表示为由 $D_{v}^{(i)}$、$L^{(i)}$、$v_{m}^{(i)}$、$n_{s}^{(i)}(T)$、$k_{B}$、$k_{g}$ 和 $T$ 构成的单个解析表达式。无需进行数值计算。最终答案必须是单个闭合形式的表达式；最终表达式中不要包含任何单位。",
            "solution": "该问题是有效的，因为它具有科学依据、问题明确且客观。它描述了一个大气中颗粒通过凝结增长的标准物理模型，这是行星科学中的一个基本过程。所有必要的参数和关系都已提供，或者可以如提示所示从第一性原理推导得出。\n\n球形颗粒的增长速率 $\\frac{dr}{dt}$ 取决于质量附着于颗粒的速率。颗粒体积的变化 $V_p = \\frac{4}{3}\\pi r^3$ 与凝结在其表面的水汽分子净通量 $I$ 以及凝结相的分子体积 $v_m$ 有关。对体积求时间导数可得 $\\frac{dV_p}{dt} = 4\\pi r^2 \\frac{dr}{dt}$。单位时间内增加的体积也等于单位时间内凝结的分子数 $I$ 乘以每个分子的体积 $v_m$。因此，我们得到了第一个关联增长速率和分子通量的关键方程：\n$$4\\pi r^2 \\frac{dr}{dt} = I v_m$$\n$$\\frac{dr}{dt} = \\frac{I v_m}{4\\pi r^2}$$\n对于特定物质 $i$，该方程为 $\\left(\\frac{dr}{dt}\\right)^{(i)} = \\frac{I^{(i)} v_m^{(i)}}{4\\pi r^2}$。\n\n分子通量 $I^{(i)}$ 由两个耦合的输运过程控制：水汽分子向颗粒的扩散和潜热从颗粒传导出去。\n\n首先，我们使用菲克第一定律对质量输运进行建模。对于稳态、球对称系统，到达颗粒的水汽分子扩散通量由下式给出：\n$$I^{(i)} = 4\\pi r D_v^{(i)} (n_{\\infty}^{(i)} - n^{(i)}(r_s))$$\n其中 $D_v^{(i)}$ 是物质 $i$ 的分子扩散系数，$n_{\\infty}^{(i)}$ 是远场的水汽分子数密度，$n^{(i)}(r_s)$ 是颗粒表面（半径为 $r$ 处）的数密度。我们将表面温度表示为 $T_s$。假设表面处的水汽与凝结相处于平衡状态，其密度为表面温度下的饱和水汽密度，即 $n^{(i)}(r_s) = n_s^{(i)}(T_s)$。问题将远场过饱和度定义为 $S = \\frac{n_{\\infty}^{(i)}}{n_s^{(i)}(T)} - 1$，其中 $T$ 是环境温度。由此可得 $n_{\\infty}^{(i)} = (1+S)n_s^{(i)}(T)$。代入这些关系，通量方程变为：\n$$I^{(i)} = 4\\pi r D_v^{(i)} \\left( (1+S)n_s^{(i)}(T) - n_s^{(i)}(T_s) \\right)$$\n\n第二，我们对热输运进行建模。每个分子的凝结会释放潜热 $L^{(i)}$。颗粒表面总的热生成率为 $Q^{(i)} = I^{(i)} L^{(i)}$。这部分热量必须通过传导散发到静止的背景气体中。根据稳态球形热传导的傅里叶定律，该热通量为：\n$$Q^{(i)} = 4\\pi r k_g (T_s - T)$$\n其中 $k_g$ 是背景气体的热导率，$T_s - T$ 是颗粒表面与周围环境之间的温差。将 $Q^{(i)}$ 的两个表达式相等，可得到关于 $I^{(i)}$ 的第二个方程：\n$$I^{(i)} L^{(i)} = 4\\pi r k_g (T_s - T) \\implies I^{(i)} = \\frac{4\\pi r k_g (T_s - T)}{L^{(i)}}$$\n\n现在我们得到了一个包含 $I^{(i)}$ 和未知表面温度 $T_s$ 的方程组。温差 $T_s - T$ 通常很小，这使我们可以在环境温度 $T$ 附近对饱和水汽密度 $n_s^{(i)}(T_s)$ 进行线性化：\n$$n_s^{(i)}(T_s) \\approx n_s^{(i)}(T) + \\left(\\frac{dn_s^{(i)}}{dT}\\right)_T (T_s - T)$$\n将此式代入质量通量方程：\n$$I^{(i)} = 4\\pi r D_v^{(i)} \\left( (1+S)n_s^{(i)}(T) - \\left[n_s^{(i)}(T) + \\left(\\frac{dn_s^{(i)}}{dT}\\right)_T (T_s - T)\\right] \\right)$$\n$$I^{(i)} = 4\\pi r D_v^{(i)} \\left( S n_s^{(i)}(T) - \\left(\\frac{dn_s^{(i)}}{dT}\\right)_T (T_s - T) \\right)$$\n从热通量方程中，我们将温差表示为 $T_s - T = \\frac{I^{(i)} L^{(i)}}{4\\pi r k_g}$。将其代入上述方程以消去 $T_s$：\n$$I^{(i)} = 4\\pi r D_v^{(i)} \\left( S n_s^{(i)}(T) - \\left(\\frac{dn_s^{(i)}}{dT}\\right)_T \\frac{I^{(i)} L^{(i)}}{4\\pi r k_g} \\right)$$\n$$I^{(i)} = 4\\pi r D_v^{(i)} S n_s^{(i)}(T) - I^{(i)} \\frac{D_v^{(i)} L^{(i)}}{k_g} \\left(\\frac{dn_s^{(i)}}{dT}\\right)_T$$\n解出 $I^{(i)}$：\n$$I^{(i)} \\left( 1 + \\frac{D_v^{(i)} L^{(i)}}{k_g} \\frac{dn_s^{(i)}}{dT} \\right) = 4\\pi r D_v^{(i)} S n_s^{(i)}(T)$$\n$$I^{(i)} = \\frac{4\\pi r D_v^{(i)} S n_s^{(i)}(T)}{1 + \\frac{D_v^{(i)} L^{(i)}}{k_g} \\frac{dn_s^{(i)}}{dT}}$$\n\n问题要求我们使用克劳修斯-克拉佩龙关系式。对于理想气体，饱和蒸气压 $P_s^{(i)}$ 与温度的关系为 $\\frac{dP_s^{(i)}}{dT} = \\frac{P_s^{(i)} L^{(i)}}{k_B T^2}$，其中 $L^{(i)}$ 是单个分子的潜热。水汽被视为理想气体，因此 $P_s^{(i)} = n_s^{(i)}(T) k_B T$。对此式求 $T$ 的导数可得 $\\frac{dP_s^{(i)}}{dT} = k_B \\left( n_s^{(i)}(T) + T \\frac{dn_s^{(i)}}{dT} \\right)$。将 $\\frac{dP_s^{(i)}}{dT}$ 的两个表达式相等：\n$$k_B \\left( n_s^{(i)}(T) + T \\frac{dn_s^{(i)}}{dT} \\right) = \\frac{(n_s^{(i)}(T) k_B T) L^{(i)}}{k_B T^2} = \\frac{n_s^{(i)}(T) L^{(i)}}{T}$$\n$$n_s^{(i)}(T) + T \\frac{dn_s^{(i)}}{dT} = \\frac{n_s^{(i)}(T) L^{(i)}}{k_B T}$$\n解出 $\\frac{dn_s^{(i)}}{dT}$：\n$$T \\frac{dn_s^{(i)}}{dT} = n_s^{(i)}(T) \\left( \\frac{L^{(i)}}{k_B T} - 1 \\right) \\implies \\frac{dn_s^{(i)}}{dT} = \\frac{n_s^{(i)}(T)}{T} \\left( \\frac{L^{(i)}}{k_B T} - 1 \\right)$$\n\n现在，将此导数代回 $I^{(i)}$ 的表达式中：\n$$I^{(i)} = \\frac{4\\pi r D_v^{(i)} S n_s^{(i)}(T)}{1 + \\frac{D_v^{(i)} L^{(i)}}{k_g} \\frac{n_s^{(i)}(T)}{T} \\left( \\frac{L^{(i)}}{k_B T} - 1 \\right)}$$\n最后，我们将 $I^{(i)}$ 的这个表达式代入增长速率 $\\left(\\frac{dr}{dt}\\right)^{(i)}$ 的方程中：\n$$\\left(\\frac{dr}{dt}\\right)^{(i)} = \\frac{v_m^{(i)}}{4\\pi r^2} I^{(i)} = \\frac{v_m^{(i)}}{4\\pi r^2} \\frac{4\\pi r D_v^{(i)} S n_s^{(i)}(T)}{1 + \\frac{D_v^{(i)} L^{(i)} n_s^{(i)}(T)}{k_g T} \\left( \\frac{L^{(i)}}{k_B T} - 1 \\right)}$$\n$$\\left(\\frac{dr}{dt}\\right)^{(i)} = \\frac{v_m^{(i)} D_v^{(i)} S n_s^{(i)}(T)}{r \\left[ 1 + \\frac{D_v^{(i)} L^{(i)} n_s^{(i)}(T)}{k_g T} \\left( \\frac{L^{(i)}}{k_B T} - 1 \\right) \\right]}$$\n\n我们要求的是水（$\\mathrm{H_2O}$）和甲烷（$\\mathrm{CH_4}$）的增长速率之比。令上标 $(h)$ 代表 $\\mathrm{H_2O}$，$(c)$ 代表 $\\mathrm{CH_4}$。在两种情况下，参数 $S$、$T$、$r$、$k_g$ 和 $k_B$ 均相同。\n$$\\frac{\\left(\\frac{dr}{dt}\\right)_{\\mathrm{H_2O}}}{\\left(\\frac{dr}{dt}\\right)_{\\mathrm{CH_4}}} = \\frac{\\left(\\frac{dr}{dt}\\right)^{(h)}}{\\left(\\frac{dr}{dt}\\right)^{(c)}} = \\frac{\\frac{v_m^{(h)} D_v^{(h)} S n_s^{(h)}(T)}{r \\left[ 1 + \\frac{D_v^{(h)} L^{(h)} n_s^{(h)}(T)}{k_g T} \\left( \\frac{L^{(h)}}{k_B T} - 1 \\right) \\right]}}{\\frac{v_m^{(c)} D_v^{(c)} S n_s^{(c)}(T)}{r \\left[ 1 + \\frac{D_v^{(c)} L^{(c)} n_s^{(c)}(T)}{k_g T} \\left( \\frac{L^{(c)}}{k_B T} - 1 \\right) \\right]}}$$\n公共项 $\\frac{S}{r}$ 消去，剩下最终表达式：\n$$\\frac{\\left(\\frac{dr}{dt}\\right)_{\\mathrm{H_2O}}}{\\left(\\frac{dr}{dt}\\right)_{\\mathrm{CH_4}}} = \\frac{v_m^{(h)} D_v^{(h)} n_s^{(h)}(T)}{v_m^{(c)} D_v^{(c)} n_s^{(c)}(T)} \\cdot \\frac{1 + \\frac{D_v^{(c)} L^{(c)} n_s^{(c)}(T)}{k_g T} \\left( \\frac{L^{(c)}}{k_B T} - 1 \\right)}{1 + \\frac{D_v^{(h)} L^{(h)} n_s^{(h)}(T)}{k_g T} \\left( \\frac{L^{(h)}}{k_B T} - 1 \\right)}$$\n这就是用指定参数表示的凝结增长速率之比的闭合形式表达式。为与问题陈述中要求的符号保持一致，我们将在上标中使用完整的化学式。",
            "answer": "$$\n\\boxed{\\frac{v_{m}^{(\\mathrm{H_2O})} D_{v}^{(\\mathrm{H_2O})} n_{s}^{(\\mathrm{H_2O})}(T)}{v_{m}^{(\\mathrm{CH_4})} D_{v}^{(\\mathrm{CH_4})} n_{s}^{(\\mathrm{CH_4})}(T)} \\cdot \\frac{1 + \\frac{D_{v}^{(\\mathrm{CH_4})} L^{(\\mathrm{CH_4})} n_{s}^{(\\mathrm{CH_4})}(T)}{k_{g} T} \\left( \\frac{L^{(\\mathrm{CH_4})}}{k_{B} T} - 1 \\right)}{1 + \\frac{D_{v}^{(\\mathrm{H_2O})} L^{(\\mathrm{H_2O})} n_{s}^{(\\mathrm{H_2O})}(T)}{k_{g} T} \\left( \\frac{L^{(\\mathrm{H_2O})}}{k_{B} T} - 1 \\right)}}\n$$"
        },
        {
            "introduction": "云的最终形态和垂直范围不仅取决于其形成和增长，还受到大气动力学的深刻影响。本练习  旨在探究向上湍流混合与向下重力沉降之间的稳态平衡，正是这种平衡决定了云层的垂直标高。你还将应用Cunningham滑移修正，这是在模拟系外行星低压高层大气中粒子行为时的一项关键调整，并定量分析它对预测云顶高度的显著影响。",
            "id": "4156061",
            "problem": "一颗暖海王星系外行星拥有一个以氢为主的大气层。考虑一个水平均匀的等温层，其压强 $p = 1.0 \\times 10^{3} \\, \\mathrm{Pa}$，温度 $T = 7.00 \\times 10^{2} \\, \\mathrm{K}$，重力加速度 $g = 1.10 \\times 10^{1} \\, \\mathrm{m \\, s^{-2}}$，以及垂直方向上恒定的涡流扩散系数 $K_{zz} = 1.00 \\times 10^{3} \\, \\mathrm{m^{2} \\, s^{-1}}$。存在半径为 $a = 5.00 \\times 10^{-6} \\, \\mathrm{m}$、材料密度为 $\\rho_{p} = 1.00 \\times 10^{3} \\, \\mathrm{kg \\, m^{-3}}$ 的球形云粒子。气体的动力粘度为 $\\mu = 1.60 \\times 10^{-5} \\, \\mathrm{Pa \\, s}$。假设在计算浮力时，气体密度与粒子密度相比可以忽略不计（$\\rho_{g} \\ll \\rho_{p}$），并且该气体是一种硬球混合物，其有效分子直径为 $d = 2.90 \\times 10^{-10} \\, \\mathrm{m}$。\n\n设垂直粒子数密度 $n(z)$ 服从净通量为零的稳态一维垂直输运，其中垂直通量是涡流扩散和沉降之和，\n$$\n\\Phi = - K_{zz} \\frac{d n}{d z} - v_{t} \\, n,\n$$\n且稳态要求 $d\\Phi/dz = 0$。此处 $v_{t}$ 是粒子终端速度。在连续介质（无滑移）极限下，斯托克斯终端速度由下式给出\n$$\nv_{t,0} = \\frac{2 (\\rho_{p} - \\rho_{g}) g a^{2}}{9 \\mu},\n$$\n在低压下，滑移修正將此值乘以坎宁安滑移修正因子 $C_{c}$，因此 $v_{t} = C_{c} \\, v_{t,0}$。坎宁安滑移修正因子为\n$$\nC_{c} = 1 + \\mathrm{Kn} \\left[A + B \\, \\exp\\!\\left(-\\frac{C}{\\mathrm{Kn}}\\right)\\right],\n$$\n其中 $\\mathrm{Kn} = \\lambda / a$ 是克努森数，平均自由程为\n$$\n\\lambda = \\frac{k_{B} T}{\\sqrt{2} \\, \\pi \\, d^{2} \\, p},\n$$\n其中 $k_{B}$ 是玻尔兹曼常数。使用 $A = 1.257$，$B = 0.400$，$C = 1.10$ 以及 $k_{B} = 1.380649 \\times 10^{-23} \\, \\mathrm{J \\ K^{-1}}$。\n\n从上述稳态输运方程和基本定义出发，首先得到 $n(z)$ 的指数形式，并用 $K_{zz}$ 和 $v_{t}$ 表示出粒子数密度分布的e折叠高度 $H_{c}$。然后，在所述条件下应用滑移修正，计算e折叠云顶高度的变化，\n$$\n\\Delta z_{\\mathrm{top}} \\equiv H_{c}^{(\\mathrm{slip})} - H_{c}^{(\\mathrm{Stokes})},\n$$\n其中 $H_{c}^{(\\mathrm{Stokes})}$ 使用 $v_{t,0}$，$H_{c}^{(\\mathrm{slip})}$ 使用 $v_{t} = C_{c} v_{t,0}$。将你的答案四舍五入到三位有效数字，并以千米为单位表示。",
            "solution": "该问题已经过验证，被确定为合理、适定且客观。它基于大气和气溶胶物理学的既定原理，并为得出唯一解提供了所有必要信息。\n\n第一步是推导粒子数密度的垂直分布 $n(z)$，并确定e折叠高度 $H_c$。问题陈述，垂直粒子通量 $\\Phi$ 是涡流扩散通量和沉降通量之和，并且在稳态下净通量为零。控制方程为：\n$$\n\\Phi = - K_{zz} \\frac{d n}{d z} - v_{t} \\, n = 0\n$$\n此处，$z$ 是垂直坐标，$K_{zz}$ 是涡流扩散系数，$n(z)$ 是粒子数密度，$v_t$ 是粒子终端速度（定义为向下运动时为正）。这是一个一阶线性常微分方程。我们可以将其整理为：\n$$\nK_{zz} \\frac{d n}{d z} = - v_{t} \\, n\n$$\n分离变量得到：\n$$\n\\frac{d n}{n} = - \\frac{v_t}{K_{zz}} \\, d z\n$$\n对两边积分，假设 $v_t$ 和 $K_{zz}$ 如问题所述随高度保持不变：\n$$\n\\int \\frac{d n}{n} = \\int - \\frac{v_t}{K_{zz}} \\, d z\n$$\n$$\n\\ln(n) = - \\frac{v_t}{K_{zz}} z + C'\n$$\n其中 $C'$ 是积分常数。对两边取指数，得到粒子数密度分布：\n$$\nn(z) = \\exp(C') \\exp\\left(-\\frac{v_t}{K_{zz}} z\\right)\n$$\n令 $n_0 = n(z=0) = \\exp(C')$ 为参考高度 $z=0$ 处的数密度，则分布为：\n$$\nn(z) = n_0 \\exp\\left(-\\frac{z}{K_{zz}/v_t}\\right)\n$$\n这就是所要求的指数形式。通过将其与通用形式 $n(z) = n_0 \\exp(-z/H_c)$ 进行比较，我们确定云粒子分布的e折叠高度，也称为云标高，为：\n$$\nH_c = \\frac{K_{zz}}{v_t}\n$$\n问题要求计算应用滑移修正后这个e折叠高度的变化量，$\\Delta z_{\\mathrm{top}} = H_{c}^{(\\mathrm{slip})} - H_{c}^{(\\mathrm{Stokes})}$。\n斯托克斯情况使用无滑移终端速度 $v_{t,0}$，得到 $H_{c}^{(\\mathrm{Stokes})} = \\frac{K_{zz}}{v_{t,0}}$。\n滑移修正情况使用修正后的终端速度 $v_{t} = C_{c} \\, v_{t,0}$，得到 $H_{c}^{(\\mathrm{slip})} = \\frac{K_{zz}}{v_t} = \\frac{K_{zz}}{C_{c} v_{t,0}}$。\n因此，差值为：\n$$\n\\Delta z_{\\mathrm{top}} = \\frac{K_{zz}}{C_{c} v_{t,0}} - \\frac{K_{zz}}{v_{t,0}} = \\frac{K_{zz}}{v_{t,0}} \\left(\\frac{1}{C_c} - 1\\right)\n$$\n为了计算 $\\Delta z_{\\mathrm{top}}$ 的数值，我们必须根据给定参数计算 $v_{t,0}$ 和 $C_c$。计算将使用国际单位制（SI）基本单位进行。\n\n1.  计算斯托克斯终端速度 $v_{t,0}$。\n    公式为 $v_{t,0} = \\frac{2 (\\rho_{p} - \\rho_{g}) g a^{2}}{9 \\mu}$。在假设 $\\rho_g \\ll \\rho_p$ 的情况下，这简化为 $v_{t,0} = \\frac{2 \\rho_{p} g a^{2}}{9 \\mu}$。\n    使用给定值：$\\rho_{p} = 1.00 \\times 10^{3} \\, \\mathrm{kg \\, m^{-3}}$，$g = 1.10 \\times 10^{1} \\, \\mathrm{m \\, s^{-2}}$，$a = 5.00 \\times 10^{-6} \\, \\mathrm{m}$，以及 $\\mu = 1.60 \\times 10^{-5} \\, \\mathrm{Pa \\, s}$。\n    $$\n    v_{t,0} = \\frac{2 (1.00 \\times 10^3) (1.10 \\times 10^1) (5.00 \\times 10^{-6})^2}{9 (1.60 \\times 10^{-5})} = \\frac{2 \\times 1.00 \\times 10^3 \\times 11.0 \\times 25.0 \\times 10^{-12}}{9 \\times 1.60 \\times 10^{-5}} \\, \\mathrm{m \\, s^{-1}}\n    $$\n    $$\n    v_{t,0} = \\frac{5.50 \\times 10^{-7}}{1.44 \\times 10^{-4}} \\, \\mathrm{m \\, s^{-1}} \\approx 3.81944 \\times 10^{-3} \\, \\mathrm{m \\, s^{-1}}\n    $$\n\n2.  计算坎宁安滑移修正因子 $C_c$。这需要计算平均自由程 $\\lambda$ 和克努森数 $\\mathrm{Kn}$。\n    平均自由程为 $\\lambda = \\frac{k_{B} T}{\\sqrt{2} \\pi d^{2} p}$。\n    使用给定值：$k_B = 1.380649 \\times 10^{-23} \\, \\mathrm{J \\ K^{-1}}$，$T = 7.00 \\times 10^2 \\, \\mathrm{K}$，$d = 2.90 \\times 10^{-10} \\, \\mathrm{m}$，以及 $p = 1.0 \\times 10^3 \\, \\mathrm{Pa}$。\n    $$\n    \\lambda = \\frac{(1.380649 \\times 10^{-23}) (7.00 \\times 10^2)}{\\sqrt{2} \\pi (2.90 \\times 10^{-10})^2 (1.0 \\times 10^3)} \\, \\mathrm{m}\n    $$\n    $$\n    \\lambda = \\frac{9.664543 \\times 10^{-21}}{\\sqrt{2} \\pi (8.41 \\times 10^{-20}) (1.0 \\times 10^3)} \\, \\mathrm{m} \\approx \\frac{9.664543 \\times 10^{-21}}{3.738006 \\times 10^{-16}} \\, \\mathrm{m} \\approx 2.58547 \\times 10^{-5} \\, \\mathrm{m}\n    $$\n    克努森数为 $\\mathrm{Kn} = \\lambda / a$。\n    $$\n    \\mathrm{Kn} = \\frac{2.58547 \\times 10^{-5}}{5.00 \\times 10^{-6}} \\approx 5.17094\n    $$\n    现在，坎宁安滑移修正因子为 $C_{c} = 1 + \\mathrm{Kn} \\left[A + B \\exp\\left(-\\frac{C}{\\mathrm{Kn}}\\right)\\right]$。\n    使用常数 $A = 1.257$，$B = 0.400$ 和 $C = 1.10$。\n    $$\n    C_c = 1 + (5.17094) \\left[1.257 + 0.400 \\exp\\left(-\\frac{1.10}{5.17094}\\right)\\right]\n    $$\n    $$\n    C_c = 1 + (5.17094) [1.257 + 0.400 \\exp(-0.21272)] \\approx 1 + (5.17094) [1.257 + 0.400 \\times 0.80839]\n    $$\n    $$\n    C_c \\approx 1 + (5.17094) [1.257 + 0.32336] \\approx 1 + (5.17094) [1.58036] \\approx 1 + 8.17195 \\approx 9.1720\n    $$\n\n3.  计算e折叠高度的变化量 $\\Delta z_{\\mathrm{top}}$。\n    我们使用推导出的公式 $\\Delta z_{\\mathrm{top}} = \\frac{K_{zz}}{v_{t,0}} \\left(\\frac{1}{C_c} - 1\\right)$。\n    使用 $K_{zz} = 1.00 \\times 10^3 \\, \\mathrm{m^2 \\, s^{-1}}$ 以及 $v_{t,0}$ 和 $C_c$ 的计算值。\n    $$\n    \\Delta z_{\\mathrm{top}} = \\frac{1.00 \\times 10^3}{3.81944 \\times 10^{-3}} \\left(\\frac{1}{9.1720} - 1\\right) \\, \\mathrm{m}\n    $$\n    $$\n    \\Delta z_{\\mathrm{top}} \\approx (2.61821 \\times 10^5) (0.109027 - 1) \\, \\mathrm{m} \\approx (2.61821 \\times 10^5) (-0.890973) \\, \\mathrm{m}\n    $$\n    $$\n    \\Delta z_{\\mathrm{top}} \\approx -233268 \\, \\mathrm{m}\n    $$\n    问题要求答案以千米为单位，并四舍五入到三位有效数字。\n    $$\n    \\Delta z_{\\mathrm{top}} \\approx -233.268 \\, \\mathrm{km}\n    $$\n    四舍五入到三位有效数字得到 $-233 \\, \\mathrm{km}$。负值表示当包含滑移修正时，e折叠高度减小，这在物理上是预期的，因为修正增加了沉降速度。",
            "answer": "$$\\boxed{-233}$$"
        }
    ]
}