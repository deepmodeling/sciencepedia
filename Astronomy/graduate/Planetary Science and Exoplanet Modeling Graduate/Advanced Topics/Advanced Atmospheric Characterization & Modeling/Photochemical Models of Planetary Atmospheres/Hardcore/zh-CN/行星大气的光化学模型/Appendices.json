{
    "hands_on_practices": [
        {
            "introduction": "在行星大气中，许多重要的化学物质是寿命极短的自由基。这些物质的浓度由光解产生的速率和化学反应消耗的速率之间的精细平衡所决定。这个练习 () 将引导你应用光化学稳态（photochemical steady state）的假设，这是一个强大的工具，用于计算这些高活性物种的丰度及其化学寿命。",
            "id": "4169276",
            "problem": "考虑一个绕冷星运行的富氢系外行星的一维、平面平行大气层。一种短寿命的自由基物种 $X$ 仅由前体物种 $A$ 的光解产生，且仅通过与背景反应物 $B$ 的双分子反应而损失。在均匀层中（忽略输运和其他源/汇），物种 $X$ 的连续性方程由数密度 $n_X$ 的时间变化率给出，该变化率等于产生项减去损失项。产生速率定义为 $P_X = J_A n_A$，其中 $J_A$ 是 $A$ 的光解频率，$n_A$ 是 $A$ 的数密度。损失速率定义为 $L_X = k_X n_X n_B$，其中 $k_X$ 是反应 $X + B \\to$ 产物的双分子速率系数，$n_B$ 是 $B$ 的数密度。\n\n假设在特定高度 $z_0$ 处存在以下科学上真实的条件：\n- 该大气层的压强为 $p = 5.00 \\times 10^3$ Pa，温度为 $T = 200$ K，总数密度通过理想气体定律 $n = \\frac{p}{k_B T}$ 与压强和温度相关，其中 $k_B = 1.380649 \\times 10^{-23}$ J K$^{-1}$ 是玻尔兹曼常数。\n- 物种 $A$ 和 $B$ 在该层内具有恒定的混合比 $q_A = 2.00 \\times 10^{-8}$ 和 $q_B = 1.00 \\times 10^{-6}$，因此 $n_A = q_A n$ 且 $n_B = q_B n$。\n- $A$ 的光解频率由波长为 $\\lambda_0$ 的单色紫外（UV）辐射控制，其在层顶的有效光化通量为 $F_0 = 5.00 \\times 10^{12}$ 光子 cm$^{-2}$ s$^{-1}$。在 $z_0$ 处的有效光化通量被柱密度为 $N_C = 1.00 \\times 10^{21}$ cm$^{-2}$、在 $\\lambda_0$ 处的吸收截面为 $\\sigma_C = 1.00 \\times 10^{-21}$ cm$^{2}$ 的上方吸收物 $C$ 所衰减，遵循比尔-朗伯衰减定律 $F(z_0) = F_0 \\exp\\!\\left(-\\sigma_C N_C\\right)$。前体物种 $A$ 在 $\\lambda_0$ 处的吸收截面为 $\\sigma_A = 2.00 \\times 10^{-18}$ cm$^2$，光解量子产额为 $\\phi_A = 1.00$，从而得到 $J_A = \\sigma_A \\phi_A F(z_0)$。\n- 在温度 $T$ 下，反应 $X + B \\to$ 产物的双分子速率系数为 $k_X = 5.00 \\times 10^{-11}$ cm$^3$ s$^{-1}$，并假设在这些条件下与压强无关。\n\n仅使用上述定义和基本定律，推导在 $z_0$ 处物种 $X$ 的稳态数密度 $n_X$ 和化学寿命 $\\tau_X$ 的表达式。计算在这些条件下 $n_X$ 和 $\\tau_X$ 的数值。将 $n_X$ 以分子 cm$^{-3}$ 为单位表示，$\\tau_X$ 以秒为单位表示。将最终数值结果四舍五入至四位有效数字。",
            "solution": "问题陈述具有科学依据，论述严谨且信息完备。它基于大气化学和物理学的基本原理，包括化学物种的连续性方程、光解动力学、双分子反应动力学、理想气体定律以及通过比尔-朗伯定律描述的辐射传输。求解唯一解所需的所有常数和边界条件均已提供，其数值对于所指定的富氢系外行星大气环境是物理上真实的。问题内部没有矛盾或含糊之处。该问题是有效的，可以按所述方式求解。\n\n分析分两部分进行：首先，推导稳态数密度 $n_X$ 和化学寿命 $\\tau_X$ 的符号表达式；其次，计算它们的数值。\n\n**1. 符号表达式的推导**\n\n物种 $X$ 的数密度（记作 $n_X$）的时间演化由连续性方程给出，该方程平衡了产生和损失。\n$$\n\\frac{dn_X}{dt} = P_X - L_X\n$$\n其中 $P_X$ 是产生速率，$L_X$ 是损失速率。问题陈述中指出 $P_X = J_A n_A$ 和 $L_X = k_X n_X n_B$。\n将这些代入连续性方程，得到：\n$$\n\\frac{dn_X}{dt} = J_A n_A - k_X n_X n_B\n$$\n在稳态下，$X$ 的数密度是恒定的，因此 $\\frac{dn_X}{dt} = 0$。这意味着产生速率和损失速率相等：\n$$\nP_X = L_X\n$$\n$$\nJ_A n_A = k_X n_X n_B\n$$\n这个方程可以解出稳态数密度 $n_X$：\n$$\nn_X = \\frac{J_A n_A}{k_X n_B}\n$$\n问题指定物种 $A$ 和 $B$ 的数密度通过恒定混合比 $q_A$ 和 $q_B$ 与总数密度 $n$ 相关：$n_A = q_A n$ 和 $n_B = q_B n$。将这些代入 $n_X$ 的表达式，得到：\n$$\nn_X = \\frac{J_A (q_A n)}{k_X (q_B n)} = \\frac{J_A q_A}{k_X q_B}\n$$\n这就是 $X$ 的稳态数密度的符号表达式。\n\n一个物种的化学寿命 $\\tau_X$ 定义为该物种的总数密度除以其总损失速率，即 $\\tau_X = \\frac{n_X}{L_X}$。对于物种 $X$，损失速率为 $L_X = k_X n_X n_B$。\n$$\n\\tau_X = \\frac{n_X}{k_X n_X n_B} = \\frac{1}{k_X n_B}\n$$\n这也可以通过注意到损失项 $k_X n_X n_B$ 可以写成一个准一级损失过程 $L_X = l_X n_X$ 来理解，其中一级损失频率为 $l_X = k_X n_B$。寿命是该损失频率的倒数，即 $\\tau_X = l_X^{-1}$。\n\n**2. 数值计算**\n\n为了计算 $n_X$ 和 $\\tau_X$ 的数值，我们首先使用给定数据评估中间量。我们将在一致的单位制下进行计算。大多数参数是以厘米-克-秒（cgs）单位或与其兼容的单位提供的，因此我们将采用该单位制。我们必须将压强 $p$ 和玻尔兹曼常数 $k_B$ 转换为cgs单位。\n\n给定参数：\n- 压强：$p = 5.00 \\times 10^3$ Pa\n- 温度：$T = 200$ K\n- 玻尔兹曼常数：$k_B = 1.380649 \\times 10^{-23}$ J K$^{-1}$\n- $A$的混合比：$q_A = 2.00 \\times 10^{-8}$\n- $B$的混合比：$q_B = 1.00 \\times 10^{-6}$\n- 层顶的有效光化通量：$F_0 = 5.00 \\times 10^{12}$ 光子 cm$^{-2}$ s$^{-1}$\n- $C$的柱密度：$N_C = 1.00 \\times 10^{21}$ cm$^{-2}$\n- $C$的吸收截面：$\\sigma_C = 1.00 \\times 10^{-21}$ cm$^{2}$\n- $A$的吸收截面：$\\sigma_A = 2.00 \\times 10^{-18}$ cm$^2$\n- $A$的光解量子产额：$\\phi_A = 1.00$\n- 双分子速率系数：$k_X = 5.00 \\times 10^{-11}$ cm$^3$ s$^{-1}$\n\n单位转换为cgs：\n- $1 \\text{ Pa} = 10 \\text{ 达因 cm}^{-2} \\implies p = 5.00 \\times 10^3 \\times 10 = 5.00 \\times 10^4$ 达因 cm$^{-2}$。\n- $1 \\text{ J} = 10^7 \\text{ 尔格} \\implies k_B = 1.380649 \\times 10^{-23} \\times 10^7 = 1.380649 \\times 10^{-16}$ 尔格 K$^{-1}$。\n\n首先，计算光解频率 $J_A$。这需要高度 $z_0$ 处的衰减后的有效光化通量 $F(z_0)$。\n上方吸收物 $C$ 的光学深度为 $\\tau_C = \\sigma_C N_C$：\n$$\n\\tau_C = (1.00 \\times 10^{-21} \\text{ cm}^2) \\times (1.00 \\times 10^{21} \\text{ cm}^{-2}) = 1.00\n$$\n衰减后的通量 $F(z_0)$ 由比尔-朗伯定律给出：\n$$\nF(z_0) = F_0 \\exp(-\\tau_C) = (5.00 \\times 10^{12} \\text{ photons cm}^{-2} \\text{s}^{-1}) \\exp(-1.00) \\approx 1.839397 \\times 10^{12} \\text{ photons cm}^{-2} \\text{s}^{-1}\n$$\n然后，光解频率 $J_A$ 为：\n$$\nJ_A = \\sigma_A \\phi_A F(z_0) = (2.00 \\times 10^{-18} \\text{ cm}^2) \\times (1.00) \\times (1.839397 \\times 10^{12} \\text{ s}^{-1}) \\approx 3.678794 \\times 10^{-6} \\text{ s}^{-1}\n$$\n现在我们可以使用简化的符号表达式计算 $n_X$：\n$$\nn_X = \\frac{J_A q_A}{k_X q_B} = \\frac{(3.678794 \\times 10^{-6} \\text{ s}^{-1}) \\times (2.00 \\times 10^{-8})}{(5.00 \\times 10^{-11} \\text{ cm}^3 \\text{s}^{-1}) \\times (1.00 \\times 10^{-6})} = \\frac{7.357588 \\times 10^{-14}}{5.00 \\times 10^{-17}} \\text{ cm}^{-3}\n$$\n$$\nn_X \\approx 1471.5176 \\text{ cm}^{-3}\n$$\n四舍五入到四位有效数字，$n_X \\approx 1.472 \\times 10^3$ cm$^{-3}$。\n\n接下来，我们计算化学寿命 $\\tau_X = \\frac{1}{k_X n_B}$。这需要物种 $B$ 的数密度，即 $n_B = q_B n$。我们必须首先根据理想气体定律 $n = \\frac{p}{k_B T}$ 求出总数密度 $n$。\n$$\nn = \\frac{5.00 \\times 10^4 \\text{ dyne cm}^{-2}}{(1.380649 \\times 10^{-16} \\text{ erg K}^{-1}) \\times (200 \\text{ K})} = \\frac{5.00 \\times 10^4}{2.761298 \\times 10^{-14}} \\text{ cm}^{-3}\n$$\n$$\nn \\approx 1.810752 \\times 10^{18} \\text{ cm}^{-3}\n$$\n现在，我们求出 $n_B$：\n$$\nn_B = q_B n = (1.00 \\times 10^{-6}) \\times (1.810752 \\times 10^{18} \\text{ cm}^{-3}) \\approx 1.810752 \\times 10^{12} \\text{ cm}^{-3}\n$$\n最后，我们计算寿命 $\\tau_X$：\n$$\n\\tau_X = \\frac{1}{k_X n_B} = \\frac{1}{(5.00 \\times 10^{-11} \\text{ cm}^3 \\text{s}^{-1}) \\times (1.810752 \\times 10^{12} \\text{ cm}^{-3})} = \\frac{1}{90.5376} \\text{ s}\n$$\n$$\n\\tau_X \\approx 0.0110451 \\text{ s}\n$$\n四舍五入到四位有效数字，$\\tau_X \\approx 1.105 \\times 10^{-2}$ s。\n\n稳态数密度为 $n_X = 1.472 \\times 10^3$ 分子 cm$^{-3}$，化学寿命为 $\\tau_X = 1.105 \\times 10^{-2}$ s。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.472 \\times 10^{3}  1.105 \\times 10^{-2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "真实的大气光化学模型需要同时处理成百上千种化学物质之间复杂的反应网络。为了系统地描述和分析这样的系统，我们使用化学计量矩阵（stoichiometric matrix）这一强大的数学工具。这个练习 () 将教你如何为一组给定的反应构建化学计量矩阵，并利用其代数性质来验证基本物理定律，如元素守恒。",
            "id": "4169143",
            "problem": "考虑一个在稳定紫外通量下，由二氧化碳和水主导、并发生氢-氧-碳光化学反应的类地系外行星大气。设物种向量的顺序为 $\\mathbf{x} = \\big( \\mathrm{H_2O}, \\mathrm{OH}, \\mathrm{H}, \\mathrm{O}, \\mathrm{O_2}, \\mathrm{O_3}, \\mathrm{HO_2}, \\mathrm{H_2O_2}, \\mathrm{CO}, \\mathrm{CO_2} \\big)$，并考虑以下九个反应：\n- $\\mathrm{H_2O} + h\\nu \\rightarrow \\mathrm{H} + \\mathrm{OH}$，\n- $\\mathrm{H} + \\mathrm{OH} \\rightarrow \\mathrm{H_2O}$，\n- $\\mathrm{O} + \\mathrm{O_2} \\rightarrow \\mathrm{O_3}$，\n- $\\mathrm{O_3} + h\\nu \\rightarrow \\mathrm{O_2} + \\mathrm{O}$，\n- $\\mathrm{HO_2} + \\mathrm{HO_2} \\rightarrow \\mathrm{H_2O_2} + \\mathrm{O_2}$，\n- $\\mathrm{H_2O_2} + h\\nu \\rightarrow 2\\,\\mathrm{OH}$，\n- $\\mathrm{H} + \\mathrm{O_2} \\rightarrow \\mathrm{HO_2}$，\n- $\\mathrm{OH} + \\mathrm{CO} \\rightarrow \\mathrm{CO_2} + \\mathrm{H}$，\n- $\\mathrm{CO_2} + h\\nu \\rightarrow \\mathrm{CO} + \\mathrm{O}$。\n\n采用化学计量约定，即化学计量矩阵 $S \\in \\mathbb{R}^{10 \\times 9}$ 的元素 $S_{i,j}$ 等于反应 $j$ 中生成的物种 $i$ 的分子数减去在反应 $j$ 中消耗的分子数。设反应速率向量为 $\\mathbf{r} = \\big( r_1, r_2, \\dots, r_9 \\big)^{\\top}$，并假设质量作用动力学，从而物种的演化满足常微分方程 (ODE) $\\frac{d\\mathbf{n}}{dt} = S\\,\\mathbf{R}(\\mathbf{n})$，其中 $\\mathbf{n}$ 是物种数密度向量，$\\mathbf{R}(\\mathbf{n})$ 是反应速率向量。\n\n任务：\n1. 根据上述反应列表和指定的物种顺序，构建化学计量矩阵 $S$。\n2. 用 $\\mathbf{r}$ 和 $S$ 的元素按分量定义生成向量 $\\mathcal{P}$ 和损失向量 $\\mathcal{L}$，使得净源 $\\dot{\\mathbf{n}}$ 满足 $\\dot{\\mathbf{n}} = \\mathcal{P} - \\mathcal{L} = S\\,\\mathbf{r}$。\n3. 通过确定向量 $\\mathbf{c}_{\\mathrm{H}}$、$\\mathbf{c}_{\\mathrm{O}}$ 和 $\\mathbf{c}_{\\mathrm{C}}$（其分量分别给出每种物种中氢、氧和碳原子的数量），来验证氢、氧和碳元素的守恒，并证明对于 $\\mathbf{c} \\in \\{ \\mathbf{c}_{\\mathrm{H}}, \\mathbf{c}_{\\mathrm{O}}, \\mathbf{c}_{\\mathrm{C}} \\}$，每个向量都满足 $\\mathbf{c}^{\\top} S = \\mathbf{0}$，从而将它们置于 $S$ 的左零空间中。\n4. 确定 $S$ 的左零空间的维数。\n\n将您的最终答案表示为等于 $S$ 左零空间维数的单个整数。无需四舍五入，无需单位。",
            "solution": "该问题要求对行星大气中简化的光化学反应网络进行多步分析。我们需要构建化学计量矩阵，定义生成和损失向量，验证元素守恒，并最终确定化学计量矩阵左零空间的维数。我们将按顺序处理每个任务。\n\n物种向量为 $\\mathbf{x} = \\big( \\mathrm{H_2O}, \\mathrm{OH}, \\mathrm{H}, \\mathrm{O}, \\mathrm{O_2}, \\mathrm{O_3}, \\mathrm{HO_2}, \\mathrm{H_2O_2}, \\mathrm{CO}, \\mathrm{CO_2} \\big)$。这定义了 10 个物种的顺序，它们将对应于化学计量矩阵 $S$ 的行。所提供的 9 个反应将对应于 $S$ 的列。\n\n### 任务1：构建化学计量矩阵 $S$\n\n化学计量矩阵 $S$ 的维数为 $10 \\times 9$。元素 $S_{i,j}$ 表示由于反应 $j$ 引起的物种 $i$ 分子数量的净变化。正值表示生成，负值表示消耗。根据给定的反应列表和物种顺序，我们逐列构建 $S$。\n\n- 反应1: $\\mathrm{H_2O} \\rightarrow \\mathrm{H} + \\mathrm{OH}$。消耗的物种：$\\mathrm{H_2O}$ ($-1$)。生成的物种：$\\mathrm{H}$ ($+1$)，$\\mathrm{OH}$ ($+1$)。\n- 反应2: $\\mathrm{H} + \\mathrm{OH} \\rightarrow \\mathrm{H_2O}$。消耗的物种：$\\mathrm{H}$ ($-1$)，$\\mathrm{OH}$ ($-1$)。生成的物种：$\\mathrm{H_2O}$ ($+1$)。\n- 反应3: $\\mathrm{O} + \\mathrm{O_2} \\rightarrow \\mathrm{O_3}$。消耗的物种：$\\mathrm{O}$ ($-1$)，$\\mathrm{O_2}$ ($-1$)。生成的物种：$\\mathrm{O_3}$ ($+1$)。\n- 反应4: $\\mathrm{O_3} \\rightarrow \\mathrm{O_2} + \\mathrm{O}$。消耗的物种：$\\mathrm{O_3}$ ($-1$)。生成的物种：$\\mathrm{O_2}$ ($+1$)，$\\mathrm{O}$ ($+1$)。\n- 反应5: $2\\,\\mathrm{HO_2} \\rightarrow \\mathrm{H_2O_2} + \\mathrm{O_2}$。消耗的物种：$\\mathrm{HO_2}$ ($-2$)。生成的物种：$\\mathrm{H_2O_2}$ ($+1$)，$\\mathrm{O_2}$ ($+1$)。\n- 反应6: $\\mathrm{H_2O_2} \\rightarrow 2\\,\\mathrm{OH}$。消耗的物种：$\\mathrm{H_2O_2}$ ($-1$)。生成的物种：$\\mathrm{OH}$ ($+2$)。\n- 反应7: $\\mathrm{H} + \\mathrm{O_2} \\rightarrow \\mathrm{HO_2}$。消耗的物种：$\\mathrm{H}$ ($-1$)，$\\mathrm{O_2}$ ($-1$)。生成的物种：$\\mathrm{HO_2}$ ($+1$)。\n- 反应8: $\\mathrm{OH} + \\mathrm{CO} \\rightarrow \\mathrm{CO_2} + \\mathrm{H}$。消耗的物种：$\\mathrm{OH}$ ($-1$)，$\\mathrm{CO}$ ($-1$)。生成的物种：$\\mathrm{CO_2}$ ($+1$)，$\\mathrm{H}$ ($+1$)。\n- 反应9: $\\mathrm{CO_2} \\rightarrow \\mathrm{CO} + \\mathrm{O}$。消耗的物种：$\\mathrm{CO_2}$ ($-1$)。生成的物种：$\\mathrm{CO}$ ($+1$)，$\\mathrm{O}$ ($+1$)。\n\n将这些组合成矩阵 $S$（行由物种 $i=1,\\dots,10$ 索引，列由反应 $j=1,\\dots,9$ 索引）：\n$$\nS =\n\\begin{pmatrix}\n%       j=1  j=2  j=3  j=4  j=5  j=6  j=7  j=8  j=9\n   -1   1   0   0   0   0   0   0    0 \\\\ % i=1 (H2O)\n    1  -1   0   0   0   2   0  -1    0 \\\\ % i=2 (OH)\n    1  -1   0   0   0   0  -1   1    0 \\\\ % i=3 (H)\n    0   0  -1   1   0   0   0   0    1 \\\\ % i=4 (O)\n    0   0  -1   1   1   0  -1   0    0 \\\\ % i=5 (O2)\n    0   0   1  -1   0   0   0   0    0 \\\\ % i=6 (O3)\n    0   0   0   0  -2   0   1   0    0 \\\\ % i=7 (HO2)\n    0   0   0   0   1  -1   0   0    0 \\\\ % i=8 (H2O2)\n    0   0   0   0   0   0   0  -1    1 \\\\ % i=9 (CO)\n    0   0   0   0   0   0   0   1   -1    % i=10 (CO2)\n\\end{pmatrix}\n$$\n\n### 任务2：定义生成向量和损失向量\n\n数密度向量 $\\mathbf{n}$ 的净源由 $\\dot{\\mathbf{n}} = S\\mathbf{r}$ 给出。对于每种物种 $i$，其变化率为 $\\dot{n}_i = \\sum_{j=1}^9 S_{i,j} r_j$。我们被要求将其表示为 $\\dot{\\mathbf{n}} = \\mathcal{P} - \\mathcal{L}$。\n\n我们可以将每个分量 $\\dot{n}_i$ 的和分解为生成项和损失项。设 $S_{i,j}^+ = \\max(S_{i,j}, 0)$ 为生成的化学计量系数，$S_{i,j}^- = \\max(-S_{i,j}, 0)$ 为损失的化学计量系数。那么 $S_{i,j} = S_{i,j}^+ - S_{i,j}^-$.\n\n生成向量 $\\mathcal{P}$ 的第 $i$ 个分量是所有生成物种 $i$ 的反应之和：\n$$\n\\mathcal{P}_i = \\sum_{j=1}^{9} S_{i,j}^+ r_j = \\sum_{j \\,\\mid\\, S_{i,j}>0} S_{i,j} r_j\n$$\n损失向量 $\\mathcal{L}$ 的第 $i$ 个分量是所有消耗物种 $i$ 的反应之和：\n$$\n\\mathcal{L}_i = \\sum_{j=1}^{9} S_{i,j}^- r_j = \\sum_{j \\,\\mid\\, S_{i,j}0} (-S_{i,j}) r_j\n$$\n根据这些定义，我们有 $\\dot{n}_i = \\mathcal{P}_i - \\mathcal{L}_i$，因此 $\\dot{\\mathbf{n}} = \\mathcal{P} - \\mathcal{L}$。\n\n### 任务3：验证元素守恒\n\n元素守恒意味着每种元素（H、O、C）的原子总数随时间保持不变。这对应于 $S$ 的左零向量的存在。设 $\\mathbf{c}$ 是一个向量，其中 $c_i$ 是物种 $i$ 中特定元素的原子数。该元素的原子总数为 $N = \\mathbf{c}^\\top\\mathbf{n}$。其时间导数为 $\\dot{N} = \\mathbf{c}^\\top\\dot{\\mathbf{n}} = \\mathbf{c}^\\top S \\mathbf{r}$。为了使 $N$ 对于任何反应速率 $\\mathbf{r}$ 都守恒，我们必须有 $\\mathbf{c}^\\top S = \\mathbf{0}^\\top$。\n\n我们根据物种列表 $\\mathbf{x} = \\big( \\mathrm{H_2O}, \\mathrm{OH}, \\mathrm{H}, \\mathrm{O}, \\mathrm{O_2}, \\mathrm{O_3}, \\mathrm{HO_2}, \\mathrm{H_2O_2}, \\mathrm{CO}, \\mathrm{CO_2} \\big)$ 定义氢、氧和碳的原子计数向量：\n\n- **氢 (H):** $\\mathbf{c}_{\\mathrm{H}}^\\top = \\begin{pmatrix} 2  1  1  0  0  0  1  2  0  0 \\end{pmatrix}$\n- **氧 (O):** $\\mathbf{c}_{\\mathrm{O}}^\\top = \\begin{pmatrix} 1  1  0  1  2  3  2  2  1  2 \\end{pmatrix}$\n- **碳 (C):** $\\mathbf{c}_{\\mathrm{C}}^\\top = \\begin{pmatrix} 0  0  0  0  0  0  0  0  1  1 \\end{pmatrix}$\n\n条件 $\\mathbf{c}^\\top S = \\mathbf{0}^\\top$ 意味着对于 $S$ 的每一列 $j$，与 $\\mathbf{c}$ 的点积为零：$\\sum_i c_i S_{i,j} = 0$。这是每个反应中给定元素的原子数是平衡的数学表述。我们可以为每种元素和每个反应验证这一点。例如，对于反应 $j=8$ ($\\mathrm{OH} + \\mathrm{CO} \\rightarrow \\mathrm{CO_2} + \\mathrm{H}$) 和氢向量 $\\mathbf{c}_\\mathrm{H}$：\n$(\\mathbf{c}_{\\mathrm{H}}^\\top S)_{8} = c_{\\mathrm{H},2}S_{2,8} + c_{\\mathrm{H},3}S_{3,8} + c_{\\mathrm{H},9}S_{9,8} + c_{\\mathrm{H},10}S_{10,8} = (1)(-1) + (1)(1) + (0)(-1) + (0)(1) = 0$。\n这对所有九个反应和所有三个元素向量都成立，这证实了 $\\mathbf{c}_{\\mathrm{H}}$、$\\mathbf{c}_{\\mathrm{O}}$ 和 $\\mathbf{c}_{\\mathrm{C}}$ 都在 $S$ 的左零空间中。\n\n### 任务4：确定 $S$ 的左零空间的维数\n\n$S$ 的左零空间是其转置 $S^\\top$ 的零空间，即 $\\ker(S^\\top)$。该空间的维数由应用于 $9 \\times 10$ 矩阵 $S^\\top$ 的秩-零度定理给出：\n$$ \\dim(\\ker(S^\\top)) = (\\text{number of columns of } S^\\top) - \\text{rank}(S^\\top) $$\n由于 $\\text{rank}(S^\\top) = \\text{rank}(S)$ 且 $S^\\top$ 有 10 列，我们有：\n$$ \\dim(\\ker(S^\\top)) = 10 - \\text{rank}(S) $$\n因此，我们必须求出 $10 \\times 9$ 矩阵 $S$ 的秩。秩是线性无关的列（或行）的数量。设 $S$ 的列表示为 $\\mathbf{s}_j$，其中 $j=1,\\dots,9$。\n\n通过观察 $S$ 的列：\n- 第2列是第1列的负数：$\\mathbf{s}_2 = -\\mathbf{s}_1$。这对应于反应2是反应1的逆反应。\n- 第4列是第3列的负数：$\\mathbf{s}_4 = -\\mathbf{s}_3$。这对应于反应4是反应3的逆反应。\n\n这两个相关性意味着 $S$ 的秩至多为 $9 - 2 = 7$。为了找到确切的秩，我们检查剩余的 7 个列向量集合 $\\{\\mathbf{s}_1, \\mathbf{s}_3, \\mathbf{s}_5, \\mathbf{s}_6, \\mathbf{s}_7, \\mathbf{s}_8, \\mathbf{s}_9\\}$ 的线性无关性。让我们测试这些向量的线性组合是否可以为零向量：\n$a_1\\mathbf{s}_1 + a_3\\mathbf{s}_3 + a_5\\mathbf{s}_5 + a_6\\mathbf{s}_6 + a_7\\mathbf{s}_7 + a_8\\mathbf{s}_8 + a_9\\mathbf{s}_9 = \\mathbf{0}$。\n\n这个向量方程给出了一个包含 10 个线性方程的方程组，用于求解 7 个系数 $a_j$。\n- 第1行 (H$_2$O) 的方程：$-a_1 = 0 \\implies a_1 = 0$。\n- 第6行 (O$_3$) 的方程：$a_3 = 0$。\n- 第4行 (O) 的方程：$-a_3 + a_9 = 0$。由于 $a_3=0$，这意味着 $a_9 = 0$。\n- 第9行 (CO) 的方程：$-a_8 + a_9 = 0$。由于 $a_9=0$，这意味着 $a_8 = 0$。\n- 到目前为止，我们有 $a_1=a_3=a_8=a_9=0$。方程简化为 $a_5\\mathbf{s}_5 + a_6\\mathbf{s}_6 + a_7\\mathbf{s}_7 = \\mathbf{0}$。\n- 第2行 (OH) 的方程：$2a_6 = 0 \\implies a_6 = 0$。\n- 第7行 (HO$_2$) 的方程：$-2a_5 + a_7 = 0$。\n- 第8行 (H$_2$O$_2$) 的方程：$a_5 - a_6 = 0$。由于 $a_6=0$，这意味着 $a_5 = 0$。\n- 将 $a_5=0$ 代入第7行的方程得到 $a_7=0$。\n\n所有系数都必须为零。因此，集合 $\\{\\mathbf{s}_1, \\mathbf{s}_3, \\mathbf{s}_5, \\mathbf{s}_6, \\mathbf{s}_7, \\mathbf{s}_8, \\mathbf{s}_9\\}$ 是线性无关的。所以 $S$ 的秩恰好为 $7$。\n\n使用秩-零度定理，左零空间的维数为：\n$$ \\dim(\\ker(S^\\top)) = 10 - \\text{rank}(S) = 10 - 7 = 3 $$\n\n这个结果与我们在任务3中的发现一致。我们确定了三个位于 $S$ 左零空间中的向量 $\\mathbf{c}_{\\mathrm{H}}, \\mathbf{c}_{\\mathrm{O}}, \\mathbf{c}_{\\mathrm{C}}$。让我们来验证它们的线性无关性。假设 $k_1\\mathbf{c}_{\\mathrm{H}} + k_2\\mathbf{c}_{\\mathrm{O}} + k_3\\mathbf{c}_{\\mathrm{C}} = \\mathbf{0}$。\n- 从第9个分量 (CO) 得出：$k_2(1) + k_3(1) = 0 \\implies k_3 = -k_2$。\n- 从第10个分量 (CO$_2$) 得出：$k_2(2) + k_3(1) = 0 \\implies 2k_2 - k_2 = 0 \\implies k_2 = 0$。\n- 这也意味着 $k_3 = 0$。\n- 从第1个分量 (H$_2$O) 得出：$k_1(2) + k_2(1) = 0 \\implies 2k_1 = 0 \\implies k_1=0$。\n由于所有系数都必须为零，所以向量 $\\mathbf{c}_{\\mathrm{H}}, \\mathbf{c}_{\\mathrm{O}}, \\mathbf{c}_{\\mathrm{C}}$ 是线性无关的。我们找到了一个3维空间中的3个线性无关向量，这意味着这些向量构成了 $S$ 左零空间的一组基。因此维数为3。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "光解反应是驱动行星大气化学演变的主要引擎，因此，精确计算光解速率（$J$值）是光化学建模的核心任务。这个计算需要整合恒星紫外辐射通量、分子的吸收截面以及光线穿过大气时的衰减效应，即所谓的“屏蔽效应”（shielding effect）。这个最终的实践 () 是一个编程练习，它将理论付诸实践，让你亲手实现一个完整的光解速率计算过程。",
            "id": "4169307",
            "problem": "您必须编写一个完整、可运行的程序，用于在一个平面平行、晴空大气中，根据指定的大气层顶恒星紫外光谱，计算随高度变化的臭氧光解率 $J_{\\mathrm{O_3}}(z)$，同时明确考虑分子氧通过 Schumann–Runge 带的自屏蔽效应。您的推导和实现必须从比尔-朗伯衰减定律和一个静水、等温大气柱开始，其中分子氧混合比为常数。您必须假设恒星位于天顶（太阳天顶角为 $0$），忽略散射，并忽略臭氧本身的衰减，因此唯一控制光化通量的吸收物是分子氧。\n\n请使用以下物理上合理且自洽的设置，所有量均以 cgs 单位表示，波长以纳米表示：\n\n- 波长网格：$\\lambda \\in [175\\,\\mathrm{nm},240\\,\\mathrm{nm}]$，以 $\\Delta \\lambda = 0.5\\,\\mathrm{nm}$ 的步长均匀离散。\n- 大气层顶光化通量，单位为光子/单位面积/单位时间/单位波长：$F_0(\\lambda) = 10^{13}\\,\\left(\\frac{\\lambda}{200\\,\\mathrm{nm}}\\right)^{-3}$，单位为 光子 $\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}\\,\\mathrm{nm}^{-1}$。\n- 贯穿 Hartley 带的臭氧光解截面，由一个平滑包络近似：\n  $$\\sigma_{\\mathrm{O_3}}(\\lambda) = 10^{-17}\\,\\exp\\!\\left(-\\left(\\frac{\\lambda - 255\\,\\mathrm{nm}}{60\\,\\mathrm{nm}}\\right)^2\\right)\\ \\mathrm{cm}^2\\,\\mathrm{molecule}^{-1}。$$\n- 捕捉 Schumann–Runge 带的分子氧吸收截面，表示为一个高斯包络，仅在 $175\\,\\mathrm{nm} \\le \\lambda \\le 205\\,\\mathrm{nm}$ 范围内有效：\n  $$\\sigma_{\\mathrm{O_2}}(\\lambda) = \\begin{cases}\n  10^{-19}\\,\\exp\\!\\left(-\\left(\\frac{\\lambda - 195\\,\\mathrm{nm}}{7\\,\\mathrm{nm}}\\right)^2\\right)  \\text{若 } 175\\,\\mathrm{nm} \\le \\lambda \\le 205\\,\\mathrm{nm},\\\\\n  0  \\text{其他情况},\n  \\end{cases}$$\n  单位为 $\\mathrm{cm}^2\\,\\mathrm{molecule}^{-1}$。\n- 在此范围内，臭氧光解为任何产物的量子产率：$\\Phi_{\\mathrm{O_3}}(\\lambda) = 1$。\n- 静水、等温大气的数密度分布为 $n_{\\mathrm{air}}(z) = n_0 \\exp\\!\\left(-\\frac{z}{H}\\right)$，其中 $n_0 = 2.5\\times 10^{19}\\ \\mathrm{cm}^{-3}$，$H = 7.4\\,\\mathrm{km}$。将分子氧混合比 $X_{\\mathrm{O_2}}$ 视为不随高度变化，因此 $n_{\\mathrm{O_2}}(z) = X_{\\mathrm{O_2}}\\,n_{\\mathrm{air}}(z)$。对于任何使用 $z$ 和 $H$ 的积分，您必须使用 $1\\,\\mathrm{km} = 10^{5}\\,\\mathrm{cm}$ 将公里转换为厘米。\n- 天顶光照且无散射意味着高度 $z$ 处的光化通量为 $F(\\lambda,z) = F_0(\\lambda)\\,\\exp\\!\\left[-\\tau(\\lambda,z)\\right]$，其中垂直光学深度 $\\tau(\\lambda,z) = \\sigma_{\\mathrm{O_2}}(\\lambda)\\,N_{\\mathrm{O_2}}(z)$，$N_{\\mathrm{O_2}}(z)$ 是高度 $z$ 以上的分子氧垂直柱密度。\n\n您的任务是：\n\n1.  从比尔-朗伯衰减定律和指数数密度分布出发，推导出分子氧柱密度 $N_{\\mathrm{O_2}}(z)$ 作为 $z$ 和 $X_{\\mathrm{O_2}}$ 的函数的一个显式表达式。\n2.  使用该结果，实现光解率的数值计算\n   $$J_{\\mathrm{O_3}}(z) = \\int_{\\lambda=175\\,\\mathrm{nm}}^{240\\,\\mathrm{nm}} \\sigma_{\\mathrm{O_3}}(\\lambda)\\,\\Phi_{\\mathrm{O_3}}(\\lambda)\\,F_0(\\lambda)\\,\\exp\\!\\left[-\\sigma_{\\mathrm{O_2}}(\\lambda)\\,N_{\\mathrm{O_2}}(z)\\right]\\ d\\lambda,$$\n   在指定的网格上使用梯形法则近似该积分。\n3.  为了评估分子氧在 Schumann–Runge 带中的自屏蔽效应，定义屏蔽因子\n   $$S(z;X_{\\mathrm{O_2}}) = \\frac{J_{\\mathrm{O_3}}(z; X_{\\mathrm{O_2}})}{J_{\\mathrm{O_3}}(z; 0)},$$\n   其中 $J_{\\mathrm{O_3}}(z; 0)$ 是通过设置 $X_{\\mathrm{O_2}}=0$ 计算得出的，同时保持所有其他参数不变。\n\n您必须实现一个程序，为以下一组测试用例计算 $J_{\\mathrm{O_3}}(z)$（单位为 $\\mathrm{s}^{-1}$）和屏蔽因子 $S(z;X_{\\mathrm{O_2}})$，每个用例由一对 $(X_{\\mathrm{O_2}}, z)$ 定义，其中高度 $z$ 的单位为公里：\n\n- 用例 1：$(0.21,\\ 0)$，作为一个典型的近地表、类地氧气混合比。\n- 用例 2：$(0.21,\\ 40)$，用于探测高海拔处减小的柱密度。\n- 用例 3：$(0.01,\\ 0)$，用于探测近地表的低氧大气。\n- 用例 4：$(0.0,\\ 0)$，作为无分子氧吸收的对照组。\n\n最终输出格式要求：\n\n- 您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，对于每个用例，您需要输出两个数：$J_{\\mathrm{O_3}}(z)$（单位为 $\\mathrm{s}^{-1}$）和 $S(z;X_{\\mathrm{O_2}})$，两者均四舍五入至六位有效数字，并按上述用例的顺序连接。也就是说，您的输出必须是以下形式\n  $$[J_1, S_1, J_2, S_2, J_3, S_3, J_4, S_4],$$\n  其中每个 $J_i$ 的单位为 $\\mathrm{s}^{-1}$，每个 $S_i$ 为无量纲，所有数值根据需要以小数或科学记数法表示。",
            "solution": "该问题在科学上是适定且内部一致的，并提供了计算唯一解所需的所有信息。这是一个标准的大气光化学问题，尽管经过了简化。因此，我们可以着手求解。\n\n核心任务是计算在给定高度 $z$ 和给定分子氧混合比 $X_{\\mathrm{O_2}}$ 下的臭氧光解率 $J_{\\mathrm{O_3}}$。这包括三个主要步骤：推导氧气柱密度、建立光解率积分，以及执行数值积分。\n\n**1. 分子氧柱密度 $N_{\\mathrm{O_2}}(z)$ 的推导**\n\n问题指定了一个静水、等温大气，其中空气分子的总数密度 $n_{\\mathrm{air}}$ 随高度 $z$ 变化如下：\n$$n_{\\mathrm{air}}(z) = n_0 \\exp\\left(-\\frac{z}{H}\\right)$$\n这里，$n_0 = 2.5 \\times 10^{19}\\ \\mathrm{cm}^{-3}$ 是地表（$z=0$）的数密度，$H = 7.4\\,\\mathrm{km}$ 是大气标高。分子氧混合比 $X_{\\mathrm{O_2}}$ 不随高度变化。因此，分子氧的数密度 $n_{\\mathrm{O_2}}(z)$ 为：\n$$n_{\\mathrm{O_2}}(z) = X_{\\mathrm{O_2}} n_{\\mathrm{air}}(z) = X_{\\mathrm{O_2}} n_0 \\exp\\left(-\\frac{z}{H}\\right)$$\n\n在给定高度 $z$ 以上的 $\\mathrm{O_2}$ 垂直柱密度，记为 $N_{\\mathrm{O_2}}(z)$，是数密度从 $z$ 到大气层顶（$z' \\to \\infty$）的积分：\n$$N_{\\mathrm{O_2}}(z) = \\int_{z}^{\\infty} n_{\\mathrm{O_2}}(z') \\, dz'$$\n代入 $n_{\\mathrm{O_2}}(z')$ 的表达式：\n$$N_{\\mathrm{O_2}}(z) = \\int_{z}^{\\infty} X_{\\mathrm{O_2}} n_0 \\exp\\left(-\\frac{z'}{H}\\right) \\, dz'$$\n由于 $X_{\\mathrm{O_2}}$ 和 $n_0$ 是常数，我们可以将它们移出积分：\n$$N_{\\mathrm{O_2}}(z) = X_{\\mathrm{O_2}} n_0 \\int_{z}^{\\infty} \\exp\\left(-\\frac{z'}{H}\\right) \\, dz'$$\n该积分的计算结果为：\n$$\\int_{z}^{\\infty} \\exp\\left(-\\frac{z'}{H}\\right) \\, dz' = \\left[-H \\exp\\left(-\\frac{z'}{H}\\right)\\right]_{z}^{\\infty} = 0 - \\left(-H \\exp\\left(-\\frac{z}{H}\\right)\\right) = H \\exp\\left(-\\frac{z}{H}\\right)$$\n因此，分子氧垂直柱密度的最终表达式为：\n$$N_{\\mathrm{O_2}}(z) = X_{\\mathrm{O_2}} n_0 H \\exp\\left(-\\frac{z}{H}\\right)$$\n这是一个标准结果，表示高度 $z$ 处的数密度乘以标高 $H$。对于所有计算，我们使用一致的 cgs 单位，并使用给定的转换关系 $1\\,\\mathrm{km} = 10^5\\,\\mathrm{cm}$ 将 $z$ 和 $H$ 从公里转换为厘米。\n\n**2. 臭氧光解率 $J_{\\mathrm{O_3}}(z)$ 的计算**\n\n光解率 $J_{\\mathrm{O_3}}(z)$ 定义为臭氧吸收截面 $\\sigma_{\\mathrm{O_3}}(\\lambda)$、量子产率 $\\Phi_{\\mathrm{O_3}}(\\lambda)$ 和光化通量 $F(\\lambda, z)$ 的乘积在相关波长范围内的积分：\n$$J_{\\mathrm{O_3}}(z) = \\int_{\\lambda=175\\,\\mathrm{nm}}^{240\\,\\mathrm{nm}} \\sigma_{\\mathrm{O_3}}(\\lambda)\\,\\Phi_{\\mathrm{O_3}}(\\lambda)\\,F(\\lambda, z)\\ d\\lambda$$\n高度 $z$ 处的光化通量根据比尔-朗伯定律从其大气层顶值 $F_0(\\lambda)$ 衰减而来。对于天顶的恒星并忽略散射，衰减仅由 $z$ 以上的分子氧柱吸收引起。\n$$F(\\lambda, z) = F_0(\\lambda)\\,\\exp\\!\\left[-\\tau(\\lambda,z)\\right]$$\n垂直光学深度 $\\tau(\\lambda,z)$ 由下式给出：\n$$\\tau(\\lambda, z) = \\sigma_{\\mathrm{O_2}}(\\lambda) N_{\\mathrm{O_2}}(z)$$\n将所有分量代入 $J_{\\mathrm{O_3}}(z)$ 的积分中得到：\n$$J_{\\mathrm{O_3}}(z; X_{\\mathrm{O_2}}) = \\int_{175}^{240} \\sigma_{\\mathrm{O_3}}(\\lambda)\\,\\Phi_{\\mathrm{O_3}}(\\lambda)\\,F_0(\\lambda)\\,\\exp\\!\\left[-\\sigma_{\\mathrm{O_2}}(\\lambda)\\,N_{\\mathrm{O_2}}(z)\\right]\\ d\\lambda$$\n我们使用先前推导的 $N_{\\mathrm{O_2}}(z)$ 表达式。该积分在从 $\\lambda = 175\\,\\mathrm{nm}$ 到 $\\lambda = 240\\,\\mathrm{nm}$ 的指定均匀波长网格上，使用步长为 $\\Delta\\lambda = 0.5\\,\\mathrm{nm}$ 的梯形法则进行数值计算。\n\n**3. 屏蔽因子 $S(z; X_{\\mathrm{O_2}})$ 的定义和计算**\n\n屏蔽因子 $S(z; X_{\\mathrm{O_2}})$ 量化了由于分子氧吸收导致的臭氧光解率的降低。它是使用给定 $X_{\\mathrm{O_2}}$ 计算的光解率与没有分子氧（$X_{\\mathrm{O_2}} = 0$）时计算的光解率之比：\n$$S(z;X_{\\mathrm{O_2}}) = \\frac{J_{\\mathrm{O_3}}(z; X_{\\mathrm{O_2}})}{J_{\\mathrm{O_3}}(z; 0)}$$\n未屏蔽率 $J_{\\mathrm{O_3}}(z; 0)$ 对应于 $N_{\\mathrm{O_2}}(z) = 0$ 的情况，意味着在所有波长上光学深度 $\\tau(\\lambda, z)$ 均为零。衰减项 $\\exp(-\\tau)$ 变为 $1$，光化通量在所有高度均未衰减，$F(\\lambda, z) = F_0(\\lambda)$。因此，未屏蔽率与高度 $z$ 无关：\n$$J_{\\mathrm{O_3}}(z; 0) = J_{\\mathrm{O_3, unshielded}} = \\int_{175}^{240} \\sigma_{\\mathrm{O_3}}(\\lambda)\\,\\Phi_{\\mathrm{O_3}}(\\lambda)\\,F_0(\\lambda)\\ d\\lambda$$\n测试用例中的用例 4 对应于这种未屏蔽情景（$X_{\\mathrm{O_2}}=0$），因此其光解率为 $J_{\\mathrm{O_3, unshielded}}$，根据定义，其屏蔽因子恰好为 $S(0; 0) = 1$。\n\n**实现策略**\n\n实现将按以下步骤进行：\n1.  以 cgs 单位定义所有物理常数和参数。\n2.  创建一个从 $175\\,\\mathrm{nm}$ 到 $240\\,\\mathrm{nm}$、步长为 $0.5\\,\\mathrm{nm}$ 的波长 $\\lambda$ 的数值网格。\n3.  按规定实现 $F_0(\\lambda)$、$\\sigma_{\\mathrm{O_3}}(\\lambda)$ 和 $\\sigma_{\\mathrm{O_2}}(\\lambda)$ 的函数。\n4.  根据推导出的公式实现一个计算 $N_{\\mathrm{O_2}}(z, X_{\\mathrm{O_2}})$ 的函数，确保将高度从 $\\mathrm{km}$ 转换为 $\\mathrm{cm}$。\n5.  实现一个主函数 `calculate_J_O3(z, X_O2)`，该函数在波长网格上计算被积函数，并使用 `numpy.trapz` 进行数值积分。\n6.  首先，通过调用 $X_{\\mathrm{O_2}} = 0$ 的 `calculate_J_O3` 来计算参考的未屏蔽率 $J_{\\mathrm{O_3, unshielded}}$。\n7.  遍历提供的四个测试用例。对于每个用例 $(X_{\\mathrm{O_2}}, z)$：\n    a. 计算光解率 $J_{\\mathrm{O_3}}(z; X_{\\mathrm{O_2}})$。\n    b. 计算屏蔽因子 $S(z; X_{\\mathrm{O_2}}) = J_{\\mathrm{O_3}}(z; X_{\\mathrm{O_2}}) / J_{\\mathrm{O_3, unshielded}}$。\n8.  将每个结果数格式化为六位有效数字，并以指定的逗号分隔列表格式打印它们。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the altitude-dependent ozone photolysis rate J_O3(z)\n    and the O2 self-shielding factor S(z; X_O2) for a set of test cases.\n    \"\"\"\n    \n    # --- Physical Constants and Parameters (cgs units and nm) ---\n    # Wavelength grid\n    lambda_min = 175.0  # nm\n    lambda_max = 240.0  # nm\n    delta_lambda = 0.5  # nm\n    # Ensure the endpoint is included in the grid\n    wavelengths = np.arange(lambda_min, lambda_max + delta_lambda, delta_lambda)\n\n    # Atmospheric parameters\n    n0 = 2.5e19  # Surface number density, cm^-3\n    H_km = 7.4   # Scale height, km\n    H_cm = H_km * 1.0e5  # Scale height, cm\n\n    # --- Spectroscopic and Atmospheric Functions ---\n\n    def F0(l_nm):\n        \"\"\"\n        Top-of-atmosphere actinic flux.\n        - l_nm: wavelength in nm\n        - Returns: flux in photons cm^-2 s^-1 nm^-1\n        \"\"\"\n        return 1.0e13 * (l_nm / 200.0)**(-3.0)\n\n    def sigma_O3(l_nm):\n        \"\"\"\n        Ozone photolysis cross section (Hartley band envelope).\n        - l_nm: wavelength in nm\n        - Returns: cross section in cm^2 molecule^-1\n        \"\"\"\n        return 1.0e-17 * np.exp(-((l_nm - 255.0) / 60.0)**2)\n\n    def sigma_O2(l_nm):\n        \"\"\"\n        Molecular oxygen absorption cross section (Schumann-Runge bands envelope).\n        - l_nm: wavelength in nm (can be a numpy array)\n        - Returns: cross section in cm^2 molecule^-1\n        \"\"\"\n        # Calculate the Gaussian envelope\n        s_o2 = 1.0e-19 * np.exp(-((l_nm - 195.0) / 7.0)**2)\n        \n        # Apply the wavelength condition where the absorption is active\n        condition = (l_nm >= 175.0)  (l_nm = 205.0)\n        return np.where(condition, s_o2, 0.0)\n\n    def phi_O3(l_nm):\n        \"\"\"\n        Quantum yield for O3 photolysis.\n        - l_nm: wavelength in nm\n        - Returns: unitless (molecule per photon)\n        \"\"\"\n        # The problem states a constant quantum yield of 1\n        if isinstance(l_nm, np.ndarray):\n            return np.ones_like(l_nm)\n        return 1.0\n\n    def N_O2(z_km, X_O2):\n        \"\"\"\n        Vertical column density of O2 above altitude z.\n        - z_km: altitude in km\n        - X_O2: O2 mixing ratio (unitless)\n        - Returns: column density in molecules cm^-2\n        \"\"\"\n        if X_O2 == 0.0:\n            return 0.0\n        z_cm = z_km * 1.0e5  # Convert altitude to cm\n        return X_O2 * n0 * H_cm * np.exp(-z_cm / H_cm)\n\n    def calculate_J_O3(z_km, X_O2):\n        \"\"\"\n        Calculates the ozone photolysis rate at a given altitude and O2 mixing ratio.\n        - z_km: altitude in km\n        - X_O2: O2 mixing ratio (unitless)\n        - Returns: photolysis rate in s^-1\n        \"\"\"\n        # Calculate O2 column density\n        column_O2 = N_O2(z_km, X_O2)\n\n        # Evaluate functions on the wavelength grid\n        F0_vals = F0(wavelengths)\n        sigma_O3_vals = sigma_O3(wavelengths)\n        sigma_O2_vals = sigma_O2(wavelengths)\n        phi_O3_vals = phi_O3(wavelengths)\n        \n        # Calculate optical depth tau\n        tau_vals = sigma_O2_vals * column_O2\n        \n        # Calculate attenuation factor from Beer-Lambert law\n        attenuation = np.exp(-tau_vals)\n\n        # Form the integrand for the photolysis rate\n        integrand = sigma_O3_vals * phi_O3_vals * F0_vals * attenuation\n        \n        # Numerically integrate using the trapezoidal rule\n        J_val = np.trapz(integrand, wavelengths)\n        return J_val\n\n    # --- Main Calculation for Test Cases ---\n    \n    test_cases = [\n        (0.21, 0.0),    # Case 1: Earth-like surface\n        (0.21, 40.0),   # Case 2: Earth-like high altitude\n        (0.01, 0.0),    # Case 3: Low-oxygen surface\n        (0.0, 0.0)      # Case 4: No oxygen (unshielded)\n    ]\n\n    # Calculate the unshielded photolysis rate, which serves as the denominator for the shielding factor.\n    # This corresponds to X_O2 = 0 and is independent of altitude.\n    J_unshielded = calculate_J_O3(z_km=0.0, X_O2=0.0)\n\n    # Process all test cases and collect results\n    results_list = []\n    for X_O2_case, z_km_case in test_cases:\n        # Calculate the photolysis rate for the current case\n        J_case = calculate_J_O3(z_km_case, X_O2_case)\n        \n        # Calculate the shielding factor\n        # A check for J_unshielded != 0 is good practice, but it's guaranteed to be positive here.\n        S_case = J_case / J_unshielded\n            \n        # Format results to six significant figures\n        J_str = \"{:.6g}\".format(J_case)\n        S_str = \"{:.6g}\".format(S_case)\n        results_list.extend([J_str, S_str])\n\n    # Print the final output in the required format\n    print(f\"[{','.join(results_list)}]\")\n\nsolve()\n\n```"
        }
    ]
}