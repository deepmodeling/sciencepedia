{
    "hands_on_practices": [
        {
            "introduction": "拉普拉斯-拉格朗日理论是研究行星长期轨道演化的基石，而拉普拉斯系数则是其数学核心。在深入研究完整的动力学系统之前，理解这些系数在简单物理极限下的行为至关重要 ()。本练习旨在通过推导当行星轨道间距很大（即半长轴之比 $\\alpha \\ll 1$）时拉普拉斯系数的领头阶表达式，来培养在天体力学中广泛应用级数展开和近似的分析技巧。",
            "id": "4177521",
            "problem": "考虑一个共面的、近圆形的双行星系统，在牛顿引力动力学下绕一颗质量为 $M_{\\star}$ 的恒星运行。在线性长期理论（也称为拉普拉斯-拉格朗日长期理论）中，控制拱线进动的相互作用矩阵元用拉普拉斯系数表示，对于半长轴之比 $\\alpha = a_{1}/a_{2}$（其中 $0  \\alpha  1$），该系数定义为\n$$\nb_{s}^{(j)}(\\alpha) \\equiv \\frac{1}{\\pi}\\int_{0}^{2\\pi}\\frac{\\cos(j\\psi)}{\\left(1 - 2\\alpha\\cos\\psi + \\alpha^{2}\\right)^{s}}\\,\\mathrm{d}\\psi,\n$$\n其中 $s > 0$ 且 $j \\in \\mathbb{Z}_{\\ge 0}$。关注长期相互作用和拱线动力学，当 $s = \\frac{3}{2}$ 且为低阶 $j = 1, 2$ 的情况出现在行星偏心率矢量的领头阶耦合中。\n\n从上述定义出发，仅使用牛顿力学和标准级数理论所支持的第一性原理展开，推导在极限 $\\alpha \\ll 1$ 下 $b_{3/2}^{(1)}(\\alpha)$ 和 $b_{3/2}^{(2)}(\\alpha)$ 关于 $\\alpha$ 的领头阶项。然后，基于被积函数作为复变量 $\\alpha$ 的函数的解析结构，评估对于固定的 $j \\ge 0$，$b_{3/2}^{(j)}(\\alpha)$ 关于 $\\alpha$ 的幂级数的收敛性和收敛半径。\n\n将 $b_{3/2}^{(1)}(\\alpha)$ 和 $b_{3/2}^{(2)}(\\alpha)$ 的领头阶表达式作为最终答案。无需四舍五入。无需单位。",
            "solution": "当牛顿N体动力学中的摄动函数按平经度之差展开成傅里叶级数时，会出现拉普拉斯系数 $b_{s}^{(j)}(\\alpha)$。对于小的半长轴之比 $\\alpha$（内摄动星远在此外轨道内），被积函数可以展开为二项式级数。我们从定义\n$$\nb_{s}^{(j)}(\\alpha) = \\frac{1}{\\pi}\\int_{0}^{2\\pi}\\cos(j\\psi)\\left(1 - 2\\alpha\\cos\\psi + \\alpha^{2}\\right)^{-s}\\,\\mathrm{d}\\psi,\n$$\n开始，并专门研究 $s=\\frac{3}{2}$ 和 $j=1,2$ 的情况。\n\n定义\n$$\nD(\\psi,\\alpha) \\equiv 1 - 2\\alpha\\cos\\psi + \\alpha^{2},\n\\qquad\nx(\\psi,\\alpha) \\equiv 2\\alpha\\cos\\psi - \\alpha^{2},\n$$\n使得 $D(\\psi,\\alpha) = 1 - x(\\psi,\\alpha)$。对于 $|x|1$，二项展开式\n$$\n(1 - x)^{-3/2} = \\sum_{n=0}^{\\infty}\\binom{-\\frac{3}{2}}{n}(-x)^{n} = 1 + \\frac{3}{2}x + \\frac{15}{8}x^{2} + \\cdots\n$$\n绝对收敛。对于 $\\alpha \\ll 1$，我们可以在对 $\\cos(j\\psi)$ 的积分产生非零贡献的最低阶处截断级数。\n\n$b_{3/2}^{(1)}(\\alpha)$ 的领头阶：\n$$\nb_{3/2}^{(1)}(\\alpha) = \\frac{1}{\\pi}\\int_{0}^{2\\pi}\\cos\\psi\\,D(\\psi,\\alpha)^{-3/2}\\,\\mathrm{d}\\psi.\n$$\n使用截断后的展开式，\n$$\nD^{-3/2} \\approx 1 + \\frac{3}{2}(2\\alpha\\cos\\psi - \\alpha^{2}) + \\frac{15}{8}(2\\alpha\\cos\\psi - \\alpha^{2})^{2} + \\cdots,\n$$\n我们注意到：\n- 第零阶项得出 $\\frac{1}{\\pi}\\int_{0}^{2\\pi}\\cos\\psi\\,\\mathrm{d}\\psi = 0$。\n- $\\alpha$ 的一次项给出\n$$\n\\frac{1}{\\pi}\\int_{0}^{2\\pi}\\cos\\psi\\left[\\frac{3}{2}\\cdot 2\\alpha\\cos\\psi\\right]\\,\\mathrm{d}\\psi\n= \\frac{3\\alpha}{\\pi}\\int_{0}^{2\\pi}\\cos^{2}\\psi\\,\\mathrm{d}\\psi.\n$$\n由于 $\\int_{0}^{2\\pi}\\cos^{2}\\psi\\,\\mathrm{d}\\psi = \\pi$，此项贡献为 $3\\alpha$。\n- 此阶的其他贡献项要么因正交性而消失（例如，线性截断中的 $\\propto \\alpha^{2}$ 项），要么是 $\\alpha$ 的更高阶项。\n\n因此，领头项为\n$$\nb_{3/2}^{(1)}(\\alpha) = 3\\alpha + \\mathcal{O}(\\alpha^{3}).\n$$\n\n$b_{3/2}^{(2)}(\\alpha)$ 的领头阶：\n$$\nb_{3/2}^{(2)}(\\alpha) = \\frac{1}{\\pi}\\int_{0}^{2\\pi}\\cos(2\\psi)\\,D(\\psi,\\alpha)^{-3/2}\\,\\mathrm{d}\\psi.\n$$\n类似地，第零阶项和 $\\alpha$ 的一次项由于正交性而消失：\n- $\\frac{1}{\\pi}\\int_{0}^{2\\pi}\\cos(2\\psi)\\,\\mathrm{d}\\psi = 0$。\n- $\\frac{1}{\\pi}\\int_{0}^{2\\pi}\\cos(2\\psi)\\,\\cos\\psi\\,\\mathrm{d}\\psi = 0$ 根据积化和差恒等式。\n\n领头的非零贡献来自于二次项：\n$$\n\\frac{1}{\\pi}\\int_{0}^{2\\pi}\\cos(2\\psi)\\left[\\frac{15}{8}(2\\alpha\\cos\\psi - \\alpha^{2})^{2}\\right]\\,\\mathrm{d}\\psi.\n$$\n展开\n$$\n(2\\alpha\\cos\\psi - \\alpha^{2})^{2} = 4\\alpha^{2}\\cos^{2}\\psi - 4\\alpha^{3}\\cos\\psi + \\alpha^{4}.\n$$\n只有 $4\\alpha^{2}\\cos^{2}\\psi$ 项在乘以 $\\cos(2\\psi)$ 后能在领头阶做出贡献；与 $\\cos\\psi$ 成正比的项和常数项对 $\\cos(2\\psi)$ 积分后为零。使用 $\\cos^{2}\\psi = \\frac{1}{2}\\left(1 + \\cos(2\\psi)\\right)$，我们得到\n$$\n\\frac{1}{\\pi}\\int_{0}^{2\\pi}\\cos(2\\psi)\\left[\\frac{15}{8}\\cdot 4\\alpha^{2}\\cos^{2}\\psi\\right]\\,\\mathrm{d}\\psi\n= \\frac{1}{\\pi}\\cdot\\frac{15}{8}\\cdot 4\\alpha^{2}\\int_{0}^{2\\pi}\\cos(2\\psi)\\cdot\\frac{1}{2}\\left(1 + \\cos(2\\psi)\\right)\\,\\mathrm{d}\\psi.\n$$\n积分简化为\n$$\n\\int_{0}^{2\\pi}\\left[\\frac{1}{2}\\cos(2\\psi) + \\frac{1}{2}\\cos^{2}(2\\psi)\\right]\\,\\mathrm{d}\\psi\n= \\frac{1}{2}\\cdot 0 + \\frac{1}{2}\\int_{0}^{2\\pi}\\cos^{2}(2\\psi)\\,\\mathrm{d}\\psi\n= \\frac{1}{2}\\cdot \\pi,\n$$\n因为对于任何非零整数 $k$，都有 $\\int_{0}^{2\\pi}\\cos^{2}(k\\psi)\\,\\mathrm{d}\\psi = \\pi$。因此，\n$$\nb_{3/2}^{(2)}(\\alpha) = \\frac{1}{\\pi}\\cdot\\frac{15}{8}\\cdot 4\\alpha^{2}\\cdot\\frac{\\pi}{2} + \\mathcal{O}(\\alpha^{4})\n= \\frac{15}{4}\\alpha^{2} + \\mathcal{O}(\\alpha^{4}).\n$$\n\n收敛性与收敛半径：\n将被积函数视为复变量 $\\alpha$ 的函数，\n$$\nf_{s,j}(\\alpha;\\psi) \\equiv \\frac{\\cos(j\\psi)}{\\left(1 - 2\\alpha\\cos\\psi + \\alpha^{2}\\right)^{s}}.\n$$\n注意当 $\\alpha$ 为实数时，有 $1 - 2\\alpha\\cos\\psi + \\alpha^{2} = |1 - \\alpha\\exp(i\\psi)|^{2}$，而更一般地，作为 $\\alpha$ 的多项式，它等于 $(1 - \\alpha\\exp(i\\psi))(1 - \\alpha\\exp(-i\\psi))$。对于固定的 $\\psi$，分母恰好在 $\\alpha = \\exp(i\\psi)$ 或 $\\alpha = \\exp(-i\\psi)$ 时为零，即在 $|\\alpha| = 1$ 时。因为 $s = \\frac{3}{2}$ 是半整数，被积函数在这些点上有支点奇点。一个关于 $\\alpha$ 的解析函数对 $\\psi$ 的积分会得到一个解析函数，因此 $b_{3/2}^{(j)}(\\alpha)$ 在 $|\\alpha|1$ 内是关于 $\\alpha$ 的解析函数，其在 $\\alpha = 0$ 处的泰勒级数的收敛半径由最近的奇点决定，这些奇点位于单位圆 $|\\alpha| = 1$ 上。因此，$b_{3/2}^{(j)}(\\alpha)$ 关于 $\\alpha$ 的幂级数在 $|\\alpha|1$ 时收敛，收敛半径为 $1$。此外，上述使用的二项展开对于 $|\\alpha|1$ 的任何紧子集都是关于 $\\psi$ 一致收敛的，这为逐项积分和提取领头阶项提供了依据。\n\n收集领头阶项，\n$$\nb_{3/2}^{(1)}(\\alpha) = 3\\alpha + \\mathcal{O}(\\alpha^{3}),\n\\qquad\nb_{3/2}^{(2)}(\\alpha) = \\frac{15}{4}\\alpha^{2} + \\mathcal{O}(\\alpha^{4}),\n$$\n其中关于 $\\alpha$ 的级数在 $|\\alpha|1$ 时收敛。",
            "answer": "$$\\boxed{3\\alpha, \\quad \\frac{15}{4}\\alpha^{2}}$$"
        },
        {
            "introduction": "掌握了拉普拉斯系数这一基本构件后，我们便可以将它们整合起来，构建一个完整的多行星系统演化模型。经典的拉普拉斯-拉格朗日理论将行星偏心率的长期演化描述为一个耦合线性振子系统，其解可以通过求解一个相互作用矩阵的本征值问题来获得 ()。这项计算实践要求你将抽象的理论转化为一个可预测的数值模型，这是行星科学建模者的核心技能，并直观展示如何利用本征模来模拟行星系统轨道根数的长期演化。",
            "id": "4177571",
            "problem": "考虑一个在牛顿引力作用下围绕单颗恒星运行的三行星系统，其平面的、非共振的、小偏心率的长期动力学。复偏心率的长期演化可以通过线性的拉普拉斯-拉格朗日理论进行建模。定义行星索引为 $i$ 的复偏心率为 $z_i = e_i \\exp\\left(i \\varpi_i\\right)$，其中 $e_i$ 是偏心率，$\\varpi_i$ 是以弧度为单位的近心点经度。在相互摄动小、平均运动共振可忽略、共面性以及摄动函数在偏心率上截断至二阶、在行星质量上截断至一阶的假设下，长期演化遵循以下形式的线性系统\n$$\n\\frac{d \\mathbf{z}}{dt} = i \\mathbf{A} \\, \\mathbf{z},\n$$\n其中 $\\mathbf{z} = \\left[z_1, z_2, z_3\\right]^\\mathsf{T}$，$\\mathbf{A}$ 是一个实矩阵，其元素取决于行星质量 $m_i$、半长轴 $a_i$、恒星质量 $M_\\star$ 以及拉普拉斯系数。行星 $i$ 的平均运动为\n$$\nn_i = \\sqrt{\\frac{G \\left(M_\\star + m_i\\right)}{a_i^3}},\n$$\n其中引力常数 $G$ 在天文单位制中定义为 $G = 4 \\pi^2 \\, \\mathrm{AU}^3 \\, \\mathrm{yr}^{-2} \\, M_\\odot^{-1}$，因此当 $M_\\star$ 和 $m_i$ 以太阳质量为单位，$a_i$ 以天文单位为单位，时间以年为单位时，$n_i$ 的单位是弧度/年。\n\n对于 $i \\neq j$，定义 $\\alpha_{ij} = \\min\\left(a_i, a_j\\right)/\\max\\left(a_i, a_j\\right)$，以及阶数为 $s$、指数为 $m$ 的拉普拉斯系数的积分表示为\n$$\nb_s^{(m)}\\left(\\alpha\\right) = \\frac{1}{\\pi} \\int_{0}^{2\\pi} \\frac{\\cos\\left(m \\psi\\right)}{\\left(1 - 2 \\alpha \\cos \\psi + \\alpha^2\\right)^s} \\, d\\psi,\n$$\n其中 $0  \\alpha  1$。在拉普拉斯-拉格朗日理论的偏心率子系统中，$\\mathbf{A}$ 的非对角和对角元素由 $b_{3/2}^{(1)}\\left(\\alpha\\right)$ 和 $b_{3/2}^{(2)}\\left(\\alpha\\right)$ 构建如下：\n$$\nA_{ij} = - \\frac{n_i}{4} \\, \\frac{m_j}{M_\\star + m_i} \\, \\alpha_{ij} \\, b_{3/2}^{(2)}\\left(\\alpha_{ij}\\right), \\quad i \\neq j,\n$$\n$$\nA_{ii} = \\frac{n_i}{4} \\sum_{j \\neq i} \\frac{m_j}{M_\\star + m_i} \\, \\alpha_{ij} \\, b_{3/2}^{(1)}\\left(\\alpha_{ij}\\right).\n$$\n$\\mathbf{z}\\left(t\\right)$ 的初值问题的解可以使用 $\\mathbf{A}$ 的特征分解来表示。如果 $\\mathbf{A} \\mathbf{v}_k = g_k \\mathbf{v}_k$，其中 $g_k$ 是实特征频率，$\\mathbf{v}_k$ 是对应的（通常为复数）右特征向量，则将初始条件 $\\mathbf{z}\\left(0\\right)$ 分解为 $\\mathbf{z}\\left(0\\right) = \\sum_k c_k \\mathbf{v}_k$，然后通过以下方式进行演化\n$$\n\\mathbf{z}\\left(t\\right) = \\sum_k c_k \\, \\mathbf{v}_k \\, \\exp\\left(i g_k t\\right).\n$$\n从 $\\mathbf{z}\\left(t\\right)$ 中恢复 $e_i\\left(t\\right) = \\left|z_i\\left(t\\right)\\right|$ 和以弧度为单位的 $\\varpi_i\\left(t\\right) = \\arg\\left(z_i\\left(t\\right)\\right)$。角度必须在区间 $[0, 2\\pi)$ 内报告。\n\n任务：编写一个程序，对于三个指定的行星系统，使用上面拉普拉斯系数的积分定义（数值计算到足够的精度）构建拉普拉斯-拉格朗日矩阵 $\\mathbf{A}$，计算其特征值和右特征向量，用它们将初始复偏心率向前演化到给定的时间 $T$（以年为单位），并输出演化后的偏心率和以弧度为单位的近心点经度。你必须使用上面指定的单位：质量以太阳质量为单位，半长轴以天文单位为单位，时间以年为单位，角度以弧度为单位。最终的角度必须通过需要时加或减 $2\\pi$ 的整数倍来归一化到 $[0, 2\\pi)$。数值结果必须四舍五入到 $6$ 位小数。\n\n测试套件：\n- 案例 1 (普遍的、间隔良好的三行星系统)：\n  - 恒星质量：$M_\\star = 1.0$。\n  - 行星质量：$\\left[m_1, m_2, m_3\\right] = \\left[5 \\times 10^{-5}, 8 \\times 10^{-5}, 3 \\times 10^{-5}\\right]$。\n  - 半长轴 (以天文单位计)：$\\left[a_1, a_2, a_3\\right] = \\left[0.5, 0.8, 1.3\\right]$。\n  - 初始偏心率：$\\left[e_1(0), e_2(0), e_3(0)\\right] = \\left[0.05, 0.02, 0.01\\right]$。\n  - 初始近心点经度 (弧度)：$\\left[\\varpi_1(0), \\varpi_2(0), \\varpi_3(0)\\right] = \\left[0.0, 1.0, 2.0\\right]$。\n  - 演化时间：$T = 10^4$ 年。\n- 案例 2 (近简并进动对)：\n  - 恒星质量：$M_\\star = 1.0$。\n  - 行星质量：$\\left[m_1, m_2, m_3\\right] = \\left[1.0 \\times 10^{-5}, 1.5 \\times 10^{-5}, 3.0 \\times 10^{-5}\\right]$。\n  - 半长轴 (以天文单位计)：$\\left[a_1, a_2, a_3\\right] = \\left[1.0, 1.1, 2.5\\right]$。\n  - 初始偏心率：$\\left[e_1(0), e_2(0), e_3(0)\\right] = \\left[0.01, 0.01, 0.02\\right]$。\n  - 初始近心点经度 (弧度)：$\\left[\\varpi_1(0), \\varpi_2(0), \\varpi_3(0)\\right] = \\left[0.3, 0.32, 1.7\\right]$。\n  - 演化时间：$T = 5 \\times 10^4$ 年。\n- 案例 3 (弱耦合的外部类测试体)：\n  - 恒星质量：$M_\\star = 1.0$。\n  - 行星质量：$\\left[m_1, m_2, m_3\\right] = \\left[2.0 \\times 10^{-5}, 4.0 \\times 10^{-5}, 1.0 \\times 10^{-7}\\right]$。\n  - 半长轴 (以天文单位计)：$\\left[a_1, a_2, a_3\\right] = \\left[0.7, 1.9, 5.0\\right]$。\n  - 初始偏心率：$\\left[e_1(0), e_2(0), e_3(0)\\right] = \\left[0.02, 0.03, 0.0\\right]$。\n  - 初始近心点经度 (弧度)：$\\left[\\varpi_1(0), \\varpi_2(0), \\varpi_3(0)\\right] = \\left[2.8, 0.5, 1.2\\right]$。\n  - 演化时间：$T = 2 \\times 10^5$ 年。\n\n你的程序必须：\n- 为每个唯一的 $\\alpha_{ij}$（其中 $0  \\alpha_{ij}  1$）数值计算 $b_{3/2}^{(1)}\\left(\\alpha\\right)$ 和 $b_{3/2}^{(2)}\\left(\\alpha\\right)$，使用上面的积分定义，计算到足够的精度，以确保稳定的特征值和特征向量（机器精度即可）。\n- 为每个案例构建 $\\mathbf{A}$，计算其特征值和右特征向量，按实特征频率 $g_k$ 升序对模式进行排序，将初始条件 $\\mathbf{z}\\left(0\\right)$ 分解到特征基上，演化到时间 $T$，并恢复 $e_i\\left(T\\right)$ 和 $\\varpi_i\\left(T\\right)$。\n- 报告以弧度为单位的角度 $\\varpi_i\\left(T\\right)$，并归一化到 $[0, 2\\pi)$。\n- 将所有报告的浮点数输出四舍五入到 $6$ 位小数。\n\n最终输出格式：你的程序应该生成单行文本，包含一个由三个列表组成的列表，每个列表对应一个案例，并按上述顺序排列。每个案例列表必须包含演化后的偏心率，后跟演化后的近心点经度，所有数值均为四舍五入到 $6$ 位小数的十进制数，顺序为 $\\left[e_1\\left(T\\right), e_2\\left(T\\right), e_3\\left(T\\right), \\varpi_1\\left(T\\right), \\varpi_2\\left(T\\right), \\varpi_3\\left(T\\right)\\right]$。最终输出必须具有以下确切格式\n$$\n\\left[\\left[e_1,e_2,e_3,\\varpi_1,\\varpi_2,\\varpi_3\\right]_{\\text{case }1},\\left[e_1,e_2,e_3,\\varpi_1,\\varpi_2,\\varpi_3\\right]_{\\text{case }2},\\left[e_1,e_2,e_3,\\varpi_1,\\varpi_2,\\varpi_3\\right]_{\\text{case }3}\\right],\n$$\n使用逗号分隔数值和列表，不含任何额外的空白或文本。",
            "solution": "此问题的解决方案涉及实现平面的、线性的拉普拉斯-拉格朗日长期理论，以模拟三星星系统的长期演化。该方法的核心是求解线性常微分方程组 $\\frac{d\\mathbf{z}}{dt} = i \\mathbf{A} \\mathbf{z}$，其中 $\\mathbf{z}$ 是复偏心率 $z_i = e_i \\exp(i\\varpi_i)$ 的向量，$\\mathbf{A}$ 是一个编码行星间引力相互作用的实 $3 \\times 3$ 矩阵。\n\n首先，我们确定物理和数学常数。在质量单位为太阳质量 ($M_\\odot$)、距离单位为天文单位 (AU)、时间单位为年 (yr) 的单位制中，引力常数设为 $G = 4\\pi^2$。这一选择简化了开普勒第三定律。\n\n该过程从处理每个测试案例的参数开始：恒星质量 $M_\\star$、行星质量 $m_i$ 及其半长轴 $a_i$。基于这些参数，我们计算一组基本量。每个行星的平均运动 $n_i$ 使用公式 $n_i = \\sqrt{G(M_\\star + m_i)/a_i^3}$ 计算。对于 $i \\neq j$，轨道间隔比 $\\alpha_{ij} = \\min(a_i, a_j) / \\max(a_i, a_j)$ 也被计算出来。这些比值总是小于1，并作为拉普拉斯系数的自变量。\n\n相互作用矩阵 $\\mathbf{A}$ 的元素是拉普拉斯系数 $b_{s}^{(m)}(\\alpha)$ 的函数。根据问题描述，这些系数由积分定义，$b_s^{(m)}(\\alpha) = \\frac{1}{\\pi} \\int_0^{2\\pi} \\frac{\\cos(m\\psi)}{(1-2\\alpha\\cos\\psi+\\alpha^2)^s} d\\psi$。我们实现一个函数来对该积分进行数值计算，其中 $s=3/2$ 且 $m \\in \\{1, 2\\}$，这些是偏心率演化问题所需的阶数。这是通过使用高精度自适应求积例程 `scipy.integrate.quad` 来实现的，该例程非常适合处理问题的平滑、周期性被积函数。对于每个唯一的 $\\alpha_{ij}$ 值，计算并存储必要的系数 $b_{3/2}^{(1)}(\\alpha_{ij})$ 和 $b_{3/2}^{(2)}(\\alpha_{ij})$。\n\n在确定了平均运动和拉普拉斯系数后，构建矩阵 $\\mathbf{A}$。对角元素 $A_{ii} = \\frac{n_i}{4} \\sum_{j \\neq i} \\frac{m_j}{M_\\star + m_i} \\alpha_{ij} b_{3/2}^{(1)}(\\alpha_{ij})$，代表了由于所有其他行星的平均影响，行星 $i$ 轨道的进动率。非对角元素 $A_{ij} = -\\frac{n_i}{4} \\frac{m_j}{M_\\star + m_i} \\alpha_{ij} b_{3/2}^{(2)}(\\alpha_{ij})$ (对于 $i \\neq j$) 描述了行星 $i$ 和 $j$ 偏心率之间的耦合。\n\n线性系统的解可以通过对 $\\mathbf{A}$ 进行特征分解来巧妙地求得。`numpy.linalg.eig` 函数被用来计算特征值 $g_k$（长期特征频率）和右特征向量 $\\mathbf{v}_k$（长期特征模式）。问题指定模式应按特征频率升序排序，因此特征值及其对应的特征向量也相应地重新排序。$\\mathbf{A}$ 的特征值保证为实数，这是问题底层哈密顿结构的结果，确保了偏心率的稳定、非失控演化。\n\n系统的初始状态由复偏心率向量 $\\mathbf{z}(0)$ 捕获，该向量由初始偏心率 $e_i(0)$ 和近心点经度 $\\varpi_i(0)$ 构建。解向时间 $T$ 的演化是在特征向量的基上进行的。首先，通过求解线性系统 $\\mathbf{V}\\mathbf{c} = \\mathbf{z}(0)$ 以得到系数向量 $\\mathbf{c}$，将初始状态向量 $\\mathbf{z}(0)$ 分解到特征基上，其中 $\\mathbf{V}$ 是其列为已排序特征向量的矩阵。这在数值上通过使用 `numpy.linalg.solve` 来实现。然后，通过推进每个分量的相位来合成时间演化后的状态：$\\mathbf{z}(T) = \\sum_k c_k \\mathbf{v}_k \\exp(i g_k T)$。这个求和可以通过矩阵-向量乘法高效计算。\n\n最后，从演化后的复向量 $\\mathbf{z}(T)$ 中，我们提取出物理轨道根数。每个行星在时间 $T$ 的偏心率是其对应复偏心率的模，$e_i(T) = |z_i(T)|$。近心点经度是其辐角，$\\varpi_i(T) = \\arg(z_i(T))$。然后使用模运算符将角度归一化到指定的区间 $[0, 2\\pi)$ 内。对于每个案例，得到的六个浮点数 $[e_1(T), e_2(T), e_3(T), \\varpi_1(T), \\varpi_2(T), \\varpi_3(T)]$ 被四舍五入到六位小数，并格式化成与所需输出结构精确匹配的字符串。",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the Laplace-Lagrange secular dynamics for three-planet systems.\n    \"\"\"\n    # Define the gravitational constant in AU, M_sun, year units.\n    G = 4 * np.pi**2\n\n    def laplace_integrand(psi, alpha, s, m):\n        \"\"\"\n        The integrand for the Laplace coefficient integral.\n        \"\"\"\n        denominator = (1 - 2 * alpha * np.cos(psi) + alpha**2)**s\n        numerator = np.cos(m * psi)\n        return numerator / denominator\n\n    def calculate_laplace_coeff(alpha, s, m):\n        \"\"\"\n        Numerically calculates the Laplace coefficient b_s^(m)(alpha).\n        \"\"\"\n        # The full integral is from 0 to 2*pi, divided by pi.\n        result, _ = integrate.quad(laplace_integrand, 0, 2 * np.pi, args=(alpha, s, m))\n        return result / np.pi\n\n    test_cases = [\n        # Case 1: General well-separated three-planet system\n        {\n            \"M_star\": 1.0,\n            \"masses\": np.array([5e-5, 8e-5, 3e-5]),\n            \"semimajor_axes\": np.array([0.5, 0.8, 1.3]),\n            \"initial_e\": np.array([0.05, 0.02, 0.01]),\n            \"initial_w\": np.array([0.0, 1.0, 2.0]),\n            \"T\": 1e4\n        },\n        # Case 2: Near-degenerate precession pair\n        {\n            \"M_star\": 1.0,\n            \"masses\": np.array([1.0e-5, 1.5e-5, 3.0e-5]),\n            \"semimajor_axes\": np.array([1.0, 1.1, 2.5]),\n            \"initial_e\": np.array([0.01, 0.01, 0.02]),\n            \"initial_w\": np.array([0.3, 0.32, 1.7]),\n            \"T\": 5e4\n        },\n        # Case 3: Weakly coupled outer test-like body\n        {\n            \"M_star\": 1.0,\n            \"masses\": np.array([2.0e-5, 4.0e-5, 1.0e-7]),\n            \"semimajor_axes\": np.array([0.7, 1.9, 5.0]),\n            \"initial_e\": np.array([0.02, 0.03, 0.0]),\n            \"initial_w\": np.array([2.8, 0.5, 1.2]),\n            \"T\": 2e5\n        }\n    ]\n\n    all_case_results = []\n\n    for case in test_cases:\n        M_star = case[\"M_star\"]\n        m = case[\"masses\"]\n        a = case[\"semimajor_axes\"]\n        e0 = case[\"initial_e\"]\n        w0 = case[\"initial_w\"]\n        T = case[\"T\"]\n        \n        num_planets = len(m)\n        \n        # Calculate mean motions n_i\n        n = np.sqrt(G * (M_star + m) / a**3)\n        \n        # Pre-calculate alpha_ij and required Laplace coefficients\n        alphas = {}\n        laplace_b1_cache = {}\n        laplace_b2_cache = {}\n        \n        for i in range(num_planets):\n            for j in range(i + 1, num_planets):\n                alpha_val = min(a[i], a[j]) / max(a[i], a[j])\n                alphas[(i, j)] = alphas[(j, i)] = alpha_val\n                \n                # Use a cache to avoid recomputing for the same alpha\n                if alpha_val not in laplace_b1_cache:\n                    laplace_b1_cache[alpha_val] = calculate_laplace_coeff(alpha_val, 1.5, 1)\n                    laplace_b2_cache[alpha_val] = calculate_laplace_coeff(alpha_val, 1.5, 2)\n\n        # Construct the interaction matrix A\n        A = np.zeros((num_planets, num_planets))\n        for i in range(num_planets):\n            # Diagonal elements A_ii\n            Aii_sum = 0\n            for j in range(num_planets):\n                if i == j:\n                    continue\n                alpha_ij = alphas[(i, j)]\n                b1_ij = laplace_b1_cache[alpha_ij]\n                Aii_sum += (m[j] / (M_star + m[i])) * alpha_ij * b1_ij\n            A[i, i] = (n[i] / 4.0) * Aii_sum\n\n            # Off-diagonal elements A_ij\n            for j in range(num_planets):\n                if i == j:\n                    continue\n                alpha_ij = alphas[(i, j)]\n                b2_ij = laplace_b2_cache[alpha_ij]\n                A[i, j] = -(n[i] / 4.0) * (m[j] / (M_star + m[i])) * alpha_ij * b2_ij\n\n        # Solve the eigenproblem for A\n        eigenvalues, eigenvectors = np.linalg.eig(A)\n        \n        # Eigenvalues should be real for this physical problem\n        eigenvalues = np.real(eigenvalues)\n\n        # Sort modes by ascending eigenfrequency\n        sort_indices = np.argsort(eigenvalues)\n        g_sorted = eigenvalues[sort_indices]\n        V_sorted = eigenvectors[:, sort_indices]\n        \n        # Construct initial complex eccentricity vector z(0)\n        z0 = e0 * np.exp(1j * w0)\n        \n        # Decompose z(0) in the eigenbasis: V * c = z0\n        c = np.linalg.solve(V_sorted, z0)\n        \n        # Propagate to time T: z(T) = sum_k c_k * v_k * exp(i*g_k*T)\n        exp_term = np.exp(1j * g_sorted * T)\n        zT = V_sorted @ (c * exp_term)\n        \n        # Recover final eccentricities and longitudes of periapsis\n        eT = np.abs(zT)\n        wT_raw = np.angle(zT)\n        \n        # Normalize angles to [0, 2*pi)\n        wT_normalized = np.mod(wT_raw, 2 * np.pi)\n        \n        # Combine results [e1, e2, e3, w1, w2, w3] and format\n        case_results = np.concatenate((eT, wT_normalized))\n        \n        # Format results to 6 decimal places and store as a string block\n        formatted_results = [f\"{x:.6f}\" for x in case_results]\n        all_case_results.append(f\"[{','.join(formatted_results)}]\")\n\n    # Print the final output string in the exact required format\n    final_output_string = f\"[{','.join(all_case_results)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "线性理论虽然强大，但它终究是一个近似，其有效性有一定范围。当行星偏心率增大时，被线性理论忽略的高阶项会变得不可忽视，导致拱点进动速率依赖于偏心率的大小，这是典型的非线性效应 ()。这个练习将引导你从一个简化的哈密顿量出发，分析并估算首次非线性修正对进动频率的贡献，从而让你学会评估一个理论模型的适用边界，并理解从线性动力学到更复杂非线性现象的过渡。",
            "id": "4177499",
            "problem": "考虑一个共面的双行星系统，其偏心率虽小但非零，围绕一颗质量为 $M_{\\star}$ 的恒星运行，且行星质量 $m_{1}, m_{2} \\ll M_{\\star}$。在对快速变化的平近点经度取平均后，牛顿长期摄动函数可以展开为偏心率的幂级数。经典的拉普拉斯-拉格朗日（LL）线性长期理论保留了最高到 $e^{2}$ 阶的项，从而产生与振幅无关的拱线进动。下一阶的非线性修正来自于 $e^{4}$ 阶的项，并产生与振幅相关的进动。\n\n采用庞加莱正则变量 $h = e \\sin \\varpi$ 和 $k = e \\cos \\varpi$，因此模式振幅和拱线角被编码在复变量 $z = k + \\mathrm{i} h$ 和不变作用量 $J = \\tfrac{1}{2}(h^{2} + k^{2}) = \\tfrac{1}{2} e^{2}$ 中。对于单个孤立的长期本征模，对称性意味着平均哈密顿量只依赖于 $J$，并且在偏心率的四次项内可以写为\n$$\nH(J) = \\alpha J + \\beta J^{2} + O(J^{3}) \\, ,\n$$\n其中 $\\alpha  0$ 设定了线性进动率的尺度，$\\beta$ 的量级与 $\\alpha$ 相当（因此比值 $r \\equiv \\beta/\\alpha$ 的数量级为1）。此处 $O(J^{3})$ 对应于 $O(e^{6})$ 阶的项，并被忽略。\n\n从拱线角的哈密顿方程 $\\dot{\\varpi} = \\partial H/\\partial J$ 出发，且不使用任何超出上述基本结构的公式，推导出由四次项引起的拱线进动率的相对偏移 $\\delta g / g_{0}$，并用 $e$ 和 $r = \\beta/\\alpha$ 来表示。然后，在 $r \\approx 1$ 的数量级假设下，估算当 $e \\approx 0.2$ 时这个相对贡献值。\n\n只需报告估算的相对贡献值，形式为一个无量纲小数。将您的答案四舍五入到4位有效数字。",
            "solution": "题目要求推导拱线进动率的相对偏移 $\\frac{\\delta g}{g_{0}}$，并进行数值估算。我们首先将题目中给出的各项进行形式化处理。\n\n拱线进动率，记为 $g$，是拱线角 $\\varpi$ 的时间导数。题目指出，该速率由与作用量 $J$ 共轭的角度的哈密顿方程决定。这个关系式给出如下：\n$$\ng \\equiv \\dot{\\varpi} = \\frac{\\partial H}{\\partial J}\n$$\n单个孤立长期本征模的哈密顿量 $H$ 被给出为作用量 $J$ 的幂级数展开：\n$$\nH(J) = \\alpha J + \\beta J^{2} + O(J^{3})\n$$\n其中 $\\alpha$ 和 $\\beta$ 是常数，分别代表线性和一阶非线性项的强度。按照指示，我们忽略更高阶的项，因此哈密顿量近似为：\n$$\nH(J) \\approx \\alpha J + \\beta J^{2}\n$$\n完整的、与振幅相关的进动率 $g$ 通过将此哈密顿量对 $J$ 求导得到：\n$$\ng = \\frac{\\partial}{\\partial J} (\\alpha J + \\beta J^{2}) = \\alpha + 2 \\beta J\n$$\n该表达式表明，进动率不是恒定的，而是线性地依赖于作用量 $J$。\n\n题目区分了完整速率和来自经典拉普拉斯-拉格朗日理论的线性速率。线性理论对应于哈密顿量中关于作用量 $J$ 是线性的部分（或关于偏心率 $e$ 是二次的）。这就是 $\\alpha J$ 项。因此，从这个线性理论推导出的进动率，我们记为 $g_{0}$，为：\n$$\ng_{0} = \\frac{\\partial}{\\partial J} (\\alpha J) = \\alpha\n$$\n这个速率 $g_{0}$ 是恒定的，代表了与振幅无关的进动。\n\n由哈密顿量中的非线性项引起的对这个线性速率的偏移（或修正）记为 $\\delta g$。它是完整速率 $g$ 和线性速率 $g_{0}$ 之间的差：\n$$\n\\delta g = g - g_{0} = (\\alpha + 2 \\beta J) - \\alpha = 2 \\beta J\n$$\n相对偏移是这个修正量 $\\delta g$ 与线性速率 $g_{0}$ 的比值：\n$$\n\\frac{\\delta g}{g_{0}} = \\frac{2 \\beta J}{\\alpha}\n$$\n为了用偏心率 $e$ 和无量纲比值 $r = \\frac{\\beta}{\\alpha}$ 来表示这个结果，我们使用题目中给出的作用量 $J$ 和偏心率 $e$ 之间的关系：\n$$\nJ = \\frac{1}{2} e^{2}\n$$\n将这个 $J$ 的表达式代入我们的相对偏移方程中，得到：\n$$\n\\frac{\\delta g}{g_{0}} = \\frac{2 \\beta}{\\alpha} \\left( \\frac{1}{2} e^{2} \\right) = \\frac{\\beta e^{2}}{\\alpha}\n$$\n最后，代入定义 $r = \\frac{\\beta}{\\alpha}$，我们得到了所求的相对偏移的解析表达式：\n$$\n\\frac{\\delta g}{g_{0}} = r e^{2}\n$$\n推导至此完成。任务的第二部分是根据给定参数估算此相对贡献的数值。给定偏心率 $e \\approx 0.2$ 和数量级假设 $r \\approx 1$。\n\n将这些值代入推导出的公式中：\n$$\n\\frac{\\delta g}{g_{0}} \\approx (1) \\times (0.2)^{2} = 1 \\times 0.04 = 0.04\n$$\n题目要求答案以一个无量纲小数的形式给出，并四舍五入到4位有效数字。数字 $0.04$ 有一位有效数字。为了用四位有效数字表示它，我们将其写为 $0.04000$。",
            "answer": "$$\n\\boxed{0.04000}\n$$"
        }
    ]
}