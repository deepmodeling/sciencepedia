{
    "hands_on_practices": [
        {
            "introduction": "The foundation of secular interaction theory rests upon the Laplace coefficients, which quantify the gravitational coupling between planets. This exercise, , provides practice in deriving the analytical, leading-order behavior of these coefficients in the important limit of well-separated orbits, where the semi-major axis ratio $\\alpha$ is small. Mastering this approximation is crucial for building physical intuition and for benchmarking the results of more complex numerical integrations.",
            "id": "4177521",
            "problem": "Consider a coplanar, nearly circular two-planet system orbiting a star of mass $M_{\\star}$ under Newtonian gravitational dynamics. In linear secular theory (also known as Laplace–Lagrange secular theory), the interaction matrix elements governing apsidal precession are written in terms of Laplace coefficients, which for semimajor axis ratio $\\alpha = a_{1}/a_{2}$ (with $0  \\alpha  1$) are defined by\n$$\nb_{s}^{(j)}(\\alpha) \\equiv \\frac{1}{\\pi}\\int_{0}^{2\\pi}\\frac{\\cos(j\\psi)}{\\left(1 - 2\\alpha\\cos\\psi + \\alpha^{2}\\right)^{s}}\\,\\mathrm{d}\\psi,\n$$\nwhere $s  0$ and $j \\in \\mathbb{Z}_{\\ge 0}$. Focusing on secular interactions and apsidal dynamics, the case $s = \\frac{3}{2}$ and low orders $j = 1, 2$ arises in the leading-order coupling of the planets’ eccentricity vectors.\n\nStarting from the above definition and using only first-principles expansions justified by Newtonian mechanics and standard series theory, derive the leading-order terms in $\\alpha$ for $b_{3/2}^{(1)}(\\alpha)$ and $b_{3/2}^{(2)}(\\alpha)$ in the limit $\\alpha \\ll 1$. Then, based on the analytic structure of the integrand as a function of complex $\\alpha$, assess the convergence and radius of convergence of the power series in $\\alpha$ for $b_{3/2}^{(j)}(\\alpha)$ at fixed $j \\ge 0$.\n\nProvide the final answer as the pair of leading-order expressions for $b_{3/2}^{(1)}(\\alpha)$ and $b_{3/2}^{(2)}(\\alpha)$. No rounding is required. No units are required.",
            "solution": "The Laplace coefficients $b_{s}^{(j)}(\\alpha)$ appear when the disturbing function in Newtonian $N$-body dynamics is expanded in a Fourier series of the difference in mean longitudes. For small semimajor axis ratio $\\alpha$ (inner perturber well inside the outer orbit), the integrand can be expanded in a binomial series. We begin from the definition\n$$\nb_{s}^{(j)}(\\alpha) = \\frac{1}{\\pi}\\int_{0}^{2\\pi}\\cos(j\\psi)\\left(1 - 2\\alpha\\cos\\psi + \\alpha^{2}\\right)^{-s}\\,\\mathrm{d}\\psi,\n$$\nand specialize to $s=\\frac{3}{2}$ and $j=1,2$.\n\nDefine\n$$\nD(\\psi,\\alpha) \\equiv 1 - 2\\alpha\\cos\\psi + \\alpha^{2},\n\\qquad\nx(\\psi,\\alpha) \\equiv 2\\alpha\\cos\\psi - \\alpha^{2},\n$$\nso that $D(\\psi,\\alpha) = 1 - x(\\psi,\\alpha)$. For $|x|1$, the binomial expansion\n$$\n(1 - x)^{-3/2} = \\sum_{n=0}^{\\infty}\\binom{-\\frac{3}{2}}{n}(-x)^{n} = 1 + \\frac{3}{2}x + \\frac{15}{8}x^{2} + \\cdots\n$$\nconverges absolutely. For $\\alpha \\ll 1$, we may truncate at the lowest order that produces a nonzero contribution upon integration against $\\cos(j\\psi)$.\n\nLeading order for $b_{3/2}^{(1)}(\\alpha)$:\n$$\nb_{3/2}^{(1)}(\\alpha) = \\frac{1}{\\pi}\\int_{0}^{2\\pi}\\cos\\psi\\,D(\\psi,\\alpha)^{-3/2}\\,\\mathrm{d}\\psi.\n$$\nUsing the truncated expansion,\n$$\nD^{-3/2} \\approx 1 + \\frac{3}{2}(2\\alpha\\cos\\psi - \\alpha^{2}) + \\frac{15}{8}(2\\alpha\\cos\\psi - \\alpha^{2})^{2} + \\cdots,\n$$\nwe note:\n- The zeroth term yields $\\frac{1}{\\pi}\\int_{0}^{2\\pi}\\cos\\psi\\,\\mathrm{d}\\psi = 0$.\n- The linear term in $\\alpha$ gives\n$$\n\\frac{1}{\\pi}\\int_{0}^{2\\pi}\\cos\\psi\\left[\\frac{3}{2}\\cdot 2\\alpha\\cos\\psi\\right]\\,\\mathrm{d}\\psi\n= \\frac{3\\alpha}{\\pi}\\int_{0}^{2\\pi}\\cos^{2}\\psi\\,\\mathrm{d}\\psi.\n$$\nSince $\\int_{0}^{2\\pi}\\cos^{2}\\psi\\,\\mathrm{d}\\psi = \\pi$, this contributes $3\\alpha$.\n- The remaining contributions at this order either vanish by orthogonality (e.g., the $\\propto \\alpha^{2}$ term in the linear truncation) or are higher order in $\\alpha$.\n\nTherefore, the leading term is\n$$\nb_{3/2}^{(1)}(\\alpha) = 3\\alpha + \\mathcal{O}(\\alpha^{3}).\n$$\n\nLeading order for $b_{3/2}^{(2)}(\\alpha)$:\n$$\nb_{3/2}^{(2)}(\\alpha) = \\frac{1}{\\pi}\\int_{0}^{2\\pi}\\cos(2\\psi)\\,D(\\psi,\\alpha)^{-3/2}\\,\\mathrm{d}\\psi.\n$$\nProceeding similarly, the zeroth term and the linear term in $\\alpha$ vanish due to orthogonality:\n- $\\frac{1}{\\pi}\\int_{0}^{2\\pi}\\cos(2\\psi)\\,\\mathrm{d}\\psi = 0$.\n- $\\frac{1}{\\pi}\\int_{0}^{2\\pi}\\cos(2\\psi)\\,\\cos\\psi\\,\\mathrm{d}\\psi = 0$ by product-to-sum identities.\n\nThe leading nonzero contribution arises from the quadratic term:\n$$\n\\frac{1}{\\pi}\\int_{0}^{2\\pi}\\cos(2\\psi)\\left[\\frac{15}{8}(2\\alpha\\cos\\psi - \\alpha^{2})^{2}\\right]\\,\\mathrm{d}\\psi.\n$$\nExpand\n$$\n(2\\alpha\\cos\\psi - \\alpha^{2})^{2} = 4\\alpha^{2}\\cos^{2}\\psi - 4\\alpha^{3}\\cos\\psi + \\alpha^{4}.\n$$\nOnly the $4\\alpha^{2}\\cos^{2}\\psi$ term can contribute at leading order when multiplied by $\\cos(2\\psi)$; the $\\propto \\cos\\psi$ and constant terms integrate to zero against $\\cos(2\\psi)$. Using $\\cos^{2}\\psi = \\frac{1}{2}\\left(1 + \\cos(2\\psi)\\right)$, we get\n$$\n\\frac{1}{\\pi}\\int_{0}^{2\\pi}\\cos(2\\psi)\\left[\\frac{15}{8}\\cdot 4\\alpha^{2}\\cos^{2}\\psi\\right]\\,\\mathrm{d}\\psi\n= \\frac{1}{\\pi}\\cdot\\frac{15}{8}\\cdot 4\\alpha^{2}\\int_{0}^{2\\pi}\\cos(2\\psi)\\cdot\\frac{1}{2}\\left(1 + \\cos(2\\psi)\\right)\\,\\mathrm{d}\\psi.\n$$\nThe integral simplifies to\n$$\n\\int_{0}^{2\\pi}\\left[\\frac{1}{2}\\cos(2\\psi) + \\frac{1}{2}\\cos^{2}(2\\psi)\\right]\\,\\mathrm{d}\\psi\n= \\frac{1}{2}\\cdot 0 + \\frac{1}{2}\\int_{0}^{2\\pi}\\cos^{2}(2\\psi)\\,\\mathrm{d}\\psi\n= \\frac{1}{2}\\cdot \\pi,\n$$\nsince $\\int_{0}^{2\\pi}\\cos^{2}(k\\psi)\\,\\mathrm{d}\\psi = \\pi$ for any nonzero integer $k$. Therefore,\n$$\nb_{3/2}^{(2)}(\\alpha) = \\frac{1}{\\pi}\\cdot\\frac{15}{8}\\cdot 4\\alpha^{2}\\cdot\\frac{\\pi}{2} + \\mathcal{O}(\\alpha^{4})\n= \\frac{15}{4}\\alpha^{2} + \\mathcal{O}(\\alpha^{4}).\n$$\n\nConvergence and radius of convergence:\nConsider the integrand as a function of complex $\\alpha$,\n$$\nf_{s,j}(\\alpha;\\psi) \\equiv \\frac{\\cos(j\\psi)}{\\left(1 - 2\\alpha\\cos\\psi + \\alpha^{2}\\right)^{s}}.\n$$\nNote that $1 - 2\\alpha\\cos\\psi + \\alpha^{2} = |1 - \\alpha\\exp(i\\psi)|^{2}$ when $\\alpha$ is real, and more generally equals $(1 - \\alpha\\exp(i\\psi))(1 - \\alpha\\exp(-i\\psi))$ as a polynomial in $\\alpha$. For fixed $\\psi$, the denominator vanishes exactly when $\\alpha = \\exp(i\\psi)$ or $\\alpha = \\exp(-i\\psi)$, i.e., at $|\\alpha| = 1$. Because $s = \\frac{3}{2}$ is a half-integer, the integrand has branch-point singularities at these points. The integral over $\\psi$ of an analytic function of $\\alpha$ yields an analytic function, so $b_{3/2}^{(j)}(\\alpha)$ is analytic in $\\alpha$ for $|\\alpha|1$, and its Taylor series about $\\alpha = 0$ has a radius of convergence set by the nearest singularities, which lie on the unit circle $|\\alpha| = 1$. Hence, the power series in $\\alpha$ for $b_{3/2}^{(j)}(\\alpha)$ converges for $|\\alpha|1$, with radius of convergence equal to $1$. Moreover, the binomial expansion used above converges uniformly in $\\psi$ for any compact subset of $|\\alpha|1$, justifying termwise integration and the extraction of leading-order terms.\n\nCollecting the leading orders,\n$$\nb_{3/2}^{(1)}(\\alpha) = 3\\alpha + \\mathcal{O}(\\alpha^{3}),\n\\qquad\nb_{3/2}^{(2)}(\\alpha) = \\frac{15}{4}\\alpha^{2} + \\mathcal{O}(\\alpha^{4}),\n$$\nwith the series in $\\alpha$ convergent for $|\\alpha|1$.",
            "answer": "$$\\boxed{\\begin{pmatrix}3\\alpha  \\frac{15}{4}\\alpha^{2}\\end{pmatrix}}$$"
        },
        {
            "introduction": "While linear Laplace-Lagrange theory provides a powerful description of apsidal dynamics, its accuracy is limited to systems with small eccentricities. This practice, , explores the next crucial step: understanding the impact of nonlinearities. By analyzing a simplified Hamiltonian that includes terms quartic in eccentricity, you will derive and quantify the phenomenon of amplitude-dependent precession, gaining essential insight into the limitations of linear models and the conditions under which nonlinear effects become dynamically significant.",
            "id": "4177499",
            "problem": "Consider a coplanar two-planet system with small but nonzero eccentricities orbiting a star of mass $M_{\\star}$, with $m_{1}, m_{2} \\ll M_{\\star}$. After averaging over the fast mean longitudes, the Newtonian secular disturbing function can be expanded in powers of the eccentricities. The classical Laplace–Lagrange (LL) linear secular theory retains terms up to order $e^{2}$, producing amplitude-independent apsidal precession. The next-order nonlinear corrections arise from terms of order $e^{4}$ and generate amplitude-dependent precession.\n\nAdopt canonical Poincaré variables $h = e \\sin \\varpi$ and $k = e \\cos \\varpi$, so that the mode amplitude and apsidal angle are encoded in the complex variable $z = k + \\mathrm{i} h$ and in the invariant action $J = \\tfrac{1}{2}(h^{2} + k^{2}) = \\tfrac{1}{2} e^{2}$. For a single isolated secular eigenmode, symmetry implies that the averaged Hamiltonian depends only on $J$ and can be written, to quartic order in eccentricity, as\n$$\nH(J) = \\alpha J + \\beta J^{2} + O(J^{3}) \\, ,\n$$\nwith $\\alpha  0$ setting the linear precession rate scale and $\\beta$ comparable in magnitude to $\\alpha$ (so that the ratio $r \\equiv \\beta/\\alpha$ is of order unity). Here $O(J^{3})$ corresponds to $O(e^{6})$ terms and is neglected.\n\nStarting from Hamilton’s equation for the apsidal angle, $\\dot{\\varpi} = \\partial H/\\partial J$, and without invoking any formula beyond the fundamental structure given above, derive an expression for the fractional shift in the apsidal precession rate due to the quartic term, $\\delta g / g_{0}$, in terms of $e$ and $r = \\beta/\\alpha$. Then estimate this fractional contribution for $e \\approx 0.2$ under the order-of-magnitude assumption $r \\approx 1$.\n\nReport only the estimated fractional contribution as a single dimensionless decimal. Round your answer to $4$ significant figures.",
            "solution": "The problem requires the derivation of the fractional shift in the apsidal precession rate, $\\frac{\\delta g}{g_{0}}$, and its numerical estimation. We begin by formalizing the terms provided.\n\nThe apsidal precession rate, denoted by $g$, is the time derivative of the apsidal angle, $\\varpi$. The problem states that this rate is governed by Hamilton's equation for the angle conjugate to the action $J$. This relationship is given as:\n$$\ng \\equiv \\dot{\\varpi} = \\frac{\\partial H}{\\partial J}\n$$\nThe Hamiltonian $H$ for a single isolated secular eigenmode is provided as an expansion in powers of the action $J$:\n$$\nH(J) = \\alpha J + \\beta J^{2} + O(J^{3})\n$$\nwhere $\\alpha$ and $\\beta$ are constants representing the strengths of the linear and first-order nonlinear terms, respectively. As instructed, we neglect higher-order terms, so the Hamiltonian is approximated as:\n$$\nH(J) \\approx \\alpha J + \\beta J^{2}\n$$\nThe full, amplitude-dependent precession rate $g$ is found by differentiating this Hamiltonian with respect to $J$:\n$$\ng = \\frac{\\partial}{\\partial J} (\\alpha J + \\beta J^{2}) = \\alpha + 2 \\beta J\n$$\nThis expression demonstrates that the precession rate is not constant but depends linearly on the action $J$.\n\nThe problem distinguishes between the full rate and the linear rate from classical Laplace-Lagrange theory. The linear theory corresponds to the part of the Hamiltonian that is linear in the action $J$ (or quadratic in eccentricity $e$). This is the term $\\alpha J$. The precession rate derived from this linear theory, which we denote as $g_{0}$, is therefore:\n$$\ng_{0} = \\frac{\\partial}{\\partial J} (\\alpha J) = \\alpha\n$$\nThis rate, $g_{0}$, is constant and represents the amplitude-independent precession.\n\nThe shift, or correction, to this linear rate due to the nonlinear term in the Hamiltonian is denoted $\\delta g$. It is the difference between the full rate $g$ and the linear rate $g_{0}$:\n$$\n\\delta g = g - g_{0} = (\\alpha + 2 \\beta J) - \\alpha = 2 \\beta J\n$$\nThe fractional shift is the ratio of this correction $\\delta g$ to the linear rate $g_{0}$:\n$$\n\\frac{\\delta g}{g_{0}} = \\frac{2 \\beta J}{\\alpha}\n$$\nTo express this result in terms of the eccentricity $e$ and the dimensionless ratio $r = \\frac{\\beta}{\\alpha}$, we use the provided relationship between the action $J$ and the eccentricity $e$:\n$$\nJ = \\frac{1}{2} e^{2}\n$$\nSubstituting this expression for $J$ into our equation for the fractional shift yields:\n$$\n\\frac{\\delta g}{g_{0}} = \\frac{2 \\beta}{\\alpha} \\left( \\frac{1}{2} e^{2} \\right) = \\frac{\\beta e^{2}}{\\alpha}\n$$\nFinally, by substituting the definition $r = \\frac{\\beta}{\\alpha}$, we arrive at the desired analytical expression for the fractional shift:\n$$\n\\frac{\\delta g}{g_{0}} = r e^{2}\n$$\nThis completes the derivation. The second part of the task is to estimate the numerical value of this fractional contribution for the given parameters. We are given an eccentricity $e \\approx 0.2$ and the order-of-magnitude assumption $r \\approx 1$.\n\nSubstituting these values into the derived formula:\n$$\n\\frac{\\delta g}{g_{0}} \\approx (1) \\times (0.2)^{2} = 1 \\times 0.04 = 0.04\n$$\nThe problem requires this answer as a single dimensionless decimal rounded to $4$ significant figures. The number $0.04$ has one significant figure. To express it with four significant figures, we write it as $0.04000$.",
            "answer": "$$\n\\boxed{0.04000}\n$$"
        },
        {
            "introduction": "This final hands-on practice, , synthesizes the preceding concepts by guiding you through the construction of a complete computational model for the secular evolution of a multi-planet system. You will translate the abstract equations of Laplace-Lagrange theory into a functional algorithm that numerically evaluates Laplace coefficients, constructs the interaction matrix $\\mathbf{A}$, and solves for the system's time evolution via its fundamental eigenmodes. This exercise bridges the gap between theory and application, yielding a powerful tool for predicting the long-term apsidal dynamics of planetary systems.",
            "id": "4177571",
            "problem": "Consider the planar, non-resonant, small-eccentricity secular dynamics of a three-planet system orbiting a single star under Newtonian gravity. The secular evolution of the complex eccentricities can be modeled by linear Laplace-Lagrange theory. Define the complex eccentricity for planet index $i$ as $z_i = e_i \\exp\\left(i \\varpi_i\\right)$, where $e_i$ is the eccentricity and $\\varpi_i$ is the longitude of periapsis in radians. Under the assumptions of small mutual perturbations, negligible mean-motion resonances, coplanarity, and truncation of the disturbing function to second order in eccentricities and first order in planetary masses, the secular evolution obeys a linear system of the form\n$$\n\\frac{d \\mathbf{z}}{dt} = i \\mathbf{A} \\, \\mathbf{z},\n$$\nwhere $\\mathbf{z} = \\left[z_1, z_2, z_3\\right]^\\mathsf{T}$ and $\\mathbf{A}$ is a real matrix whose entries depend on the planetary masses $m_i$, semi-major axes $a_i$, the stellar mass $M_\\star$, and Laplace coefficients. The mean motion for planet $i$ is\n$$\nn_i = \\sqrt{\\frac{G \\left(M_\\star + m_i\\right)}{a_i^3}},\n$$\nwith gravitational constant $G$ defined in the astronomical units system as $G = 4 \\pi^2 \\, \\mathrm{AU}^3 \\, \\mathrm{yr}^{-2} \\, M_\\odot^{-1}$ so that when $M_\\star$ and $m_i$ are in solar masses, $a_i$ in astronomical units, and time in years, $n_i$ is in radians per year.\n\nFor $i \\neq j$, define $\\alpha_{ij} = \\min\\left(a_i, a_j\\right)/\\max\\left(a_i, a_j\\right)$ and the Laplace coefficients of order $s$ and index $m$ by the integral representation\n$$\nb_s^{(m)}\\left(\\alpha\\right) = \\frac{1}{\\pi} \\int_{0}^{2\\pi} \\frac{\\cos\\left(m \\psi\\right)}{\\left(1 - 2 \\alpha \\cos \\psi + \\alpha^2\\right)^s} \\, d\\psi,\n$$\nwhere $0  \\alpha  1$. In the eccentricity subsystem of Laplace-Lagrange theory, the non-diagonal and diagonal elements of $\\mathbf{A}$ are constructed from $b_{3/2}^{(1)}\\left(\\alpha\\right)$ and $b_{3/2}^{(2)}\\left(\\alpha\\right)$ as follows:\n$$\nA_{ij} = - \\frac{n_i}{4} \\, \\frac{m_j}{M_\\star + m_i} \\, \\alpha_{ij} \\, b_{3/2}^{(2)}\\left(\\alpha_{ij}\\right), \\quad i \\neq j,\n$$\n$$\nA_{ii} = \\frac{n_i}{4} \\sum_{j \\neq i} \\frac{m_j}{M_\\star + m_i} \\, \\alpha_{ij} \\, b_{3/2}^{(1)}\\left(\\alpha_{ij}\\right).\n$$\nThe solution to the initial value problem for $\\mathbf{z}\\left(t\\right)$ can be expressed using the eigendecomposition of $\\mathbf{A}$. If $\\mathbf{A} \\mathbf{v}_k = g_k \\mathbf{v}_k$ with real eigenfrequencies $g_k$ and corresponding (generally complex) right eigenvectors $\\mathbf{v}_k$, decompose the initial condition $\\mathbf{z}\\left(0\\right)$ as $\\mathbf{z}\\left(0\\right) = \\sum_k c_k \\mathbf{v}_k$, then propagate by\n$$\n\\mathbf{z}\\left(t\\right) = \\sum_k c_k \\, \\mathbf{v}_k \\, \\exp\\left(i g_k t\\right).\n$$\nFrom $\\mathbf{z}\\left(t\\right)$, recover $e_i\\left(t\\right) = \\left|z_i\\left(t\\right)\\right|$ and $\\varpi_i\\left(t\\right) = \\arg\\left(z_i\\left(t\\right)\\right)$ in radians. Angles must be reported in the interval $[0, 2\\pi)$.\n\nTask: Write a program that, for three specified planetary systems, constructs the Laplace-Lagrange matrix $\\mathbf{A}$ using the integral definition of the Laplace coefficients above (numerically evaluated to sufficient precision), computes its eigenvalues and right eigenvectors, uses them to propagate the initial complex eccentricities forward to a given time $T$ (in years), and outputs the evolved eccentricities and longitudes of periapsis in radians. You must use the units specified above: masses in solar masses, semi-major axes in astronomical units, time in years, angles in radians. The final angles must be normalized to $[0, 2\\pi)$ by adding or subtracting integer multiples of $2\\pi$ as needed. Numerical results must be rounded to $6$ decimal places.\n\nTest suite:\n- Case $1$ (general well-separated three-planet system):\n  - Stellar mass: $M_\\star = 1.0$.\n  - Planet masses: $\\left[m_1, m_2, m_3\\right] = \\left[5 \\times 10^{-5}, 8 \\times 10^{-5}, 3 \\times 10^{-5}\\right]$.\n  - Semi-major axes (in astronomical units): $\\left[a_1, a_2, a_3\\right] = \\left[0.5, 0.8, 1.3\\right]$.\n  - Initial eccentricities: $\\left[e_1(0), e_2(0), e_3(0)\\right] = \\left[0.05, 0.02, 0.01\\right]$.\n  - Initial longitudes of periapsis (radians): $\\left[\\varpi_1(0), \\varpi_2(0), \\varpi_3(0)\\right] = \\left[0.0, 1.0, 2.0\\right]$.\n  - Propagation time: $T = 10^4$ years.\n- Case $2$ (near-degenerate precession pair):\n  - Stellar mass: $M_\\star = 1.0$.\n  - Planet masses: $\\left[m_1, m_2, m_3\\right] = \\left[1.0 \\times 10^{-5}, 1.5 \\times 10^{-5}, 3.0 \\times 10^{-5}\\right]$.\n  - Semi-major axes (in astronomical units): $\\left[a_1, a_2, a_3\\right] = \\left[1.0, 1.1, 2.5\\right]$.\n  - Initial eccentricities: $\\left[e_1(0), e_2(0), e_3(0)\\right] = \\left[0.01, 0.01, 0.02\\right]$.\n  - Initial longitudes of periapsis (radians): $\\left[\\varpi_1(0), \\varpi_2(0), \\varpi_3(0)\\right] = \\left[0.3, 0.32, 1.7\\right]$.\n  - Propagation time: $T = 5 \\times 10^4$ years.\n- Case $3$ (weakly coupled outer test-like body):\n  - Stellar mass: $M_\\star = 1.0$.\n  - Planet masses: $\\left[m_1, m_2, m_3\\right] = \\left[2.0 \\times 10^{-5}, 4.0 \\times 10^{-5}, 1.0 \\times 10^{-7}\\right]$.\n  - Semi-major axes (in astronomical units): $\\left[a_1, a_2, a_3\\right] = \\left[0.7, 1.9, 5.0\\right]$.\n  - Initial eccentricities: $\\left[e_1(0), e_2(0), e_3(0)\\right] = \\left[0.02, 0.03, 0.0\\right]$.\n  - Initial longitudes of periapsis (radians): $\\left[\\varpi_1(0), \\varpi_2(0), \\varpi_3(0)\\right] = \\left[2.8, 0.5, 1.2\\right]$.\n  - Propagation time: $T = 2 \\times 10^5$ years.\n\nYour program must:\n- Numerically evaluate $b_{3/2}^{(1)}\\left(\\alpha\\right)$ and $b_{3/2}^{(2)}\\left(\\alpha\\right)$ using the integral definition above for each unique $\\alpha_{ij}$ with $0  \\alpha_{ij}  1$, to sufficient accuracy to ensure stable eigenvalues and eigenvectors (machine precision is sufficient).\n- Construct $\\mathbf{A}$ for each case, compute its eigenvalues and right eigenvectors, sort the modes by ascending real eigenfrequency $g_k$, decompose the initial condition $\\mathbf{z}\\left(0\\right)$ into the eigenbasis, propagate to time $T$, and recover $e_i\\left(T\\right)$ and $\\varpi_i\\left(T\\right)$.\n- Report the angles $\\varpi_i\\left(T\\right)$ in radians, normalized to $[0, 2\\pi)$.\n- Round all reported floating point outputs to $6$ decimal places.\n\nFinal output format: Your program should produce a single line containing a list of three lists, one for each case, in the order given above. Each case list must contain the evolved eccentricities followed by the evolved longitudes of periapsis, all as decimal numbers rounded to $6$ decimals, in the order $\\left[e_1\\left(T\\right), e_2\\left(T\\right), e_3\\left(T\\right), \\varpi_1\\left(T\\right), \\varpi_2\\left(T\\right), \\varpi_3\\left(T\\right)\\right]$. The final output must have the exact format\n$$\n\\left[\\left[e_1,e_2,e_3,\\varpi_1,\\varpi_2,\\varpi_3\\right]_{\\text{case }1},\\left[e_1,e_2,e_3,\\varpi_1,\\varpi_2,\\varpi_3\\right]_{\\text{case }2},\\left[e_1,e_2,e_3,\\varpi_1,\\varpi_2,\\varpi_3\\right]_{\\text{case }3}\\right],\n$$\nwith commas separating values and lists, and no additional whitespace or text.",
            "solution": "The solution to this problem involves the implementation of the planar, linear Laplace-Lagrange secular theory to model the long-term evolution of a three-planet system. The core of the methodology is to solve the system of linear ordinary differential equations $\\frac{d\\mathbf{z}}{dt} = i \\mathbf{A} \\mathbf{z}$, where $\\mathbf{z}$ is the vector of complex eccentricities $z_i = e_i \\exp(i\\varpi_i)$ and $\\mathbf{A}$ is a real $3 \\times 3$ matrix encoding the gravitational interactions between the planets.\n\nFirst, we establish the physical and mathematical constants. The gravitational constant is set to $G = 4\\pi^2$ in the system of units where mass is in solar masses ($M_\\odot$), distance is in astronomical units (AU), and time is in years (yr). This choice simplifies Kepler's Third Law.\n\nThe procedure begins by processing each test case's parameters: the stellar mass $M_\\star$, the planet masses $m_i$, and their semi-major axes $a_i$. From these, we calculate a set of fundamental quantities. The mean motion for each planet, $n_i$, is computed using the formula $n_i = \\sqrt{G(M_\\star + m_i)/a_i^3}$. The orbital-separation ratios, $\\alpha_{ij} = \\min(a_i, a_j) / \\max(a_i, a_j)$ for $i \\neq j$, are also calculated. These ratios are always less than $1$ and serve as the arguments for the Laplace coefficients.\n\nThe elements of the interaction matrix $\\mathbf{A}$ are functions of the Laplace coefficients $b_{s}^{(m)}(\\alpha)$. As per the problem, these coefficients are defined by an integral, $b_s^{(m)}(\\alpha) = \\frac{1}{\\pi} \\int_0^{2\\pi} \\frac{\\cos(m\\psi)}{(1-2\\alpha\\cos\\psi+\\alpha^2)^s} d\\psi$. We implement a function to numerically evaluate this integral for $s=3/2$ and $m \\in \\{1, 2\\}$, which are the orders required for the eccentricity evolution problem. This is achieved using a high-precision adaptive quadrature routine, `scipy.integrate.quad`, which is well-suited for the problem's smooth, periodic integrand. The necessary coefficients, $b_{3/2}^{(1)}(\\alpha_{ij})$ and $b_{3/2}^{(2)}(\\alpha_{ij})$, are computed and stored for each unique $\\alpha_{ij}$ value.\n\nWith the mean motions and Laplace coefficients determined, the matrix $\\mathbf{A}$ is constructed. The diagonal elements, $A_{ii} = \\frac{n_i}{4} \\sum_{j \\neq i} \\frac{m_j}{M_\\star + m_i} \\alpha_{ij} b_{3/2}^{(1)}(\\alpha_{ij})$, represent the precession rate of planet $i$'s orbit due to the averaged influence of all other planets. The off-diagonal elements, $A_{ij} = -\\frac{n_i}{4} \\frac{m_j}{M_\\star + m_i} \\alpha_{ij} b_{3/2}^{(2)}(\\alpha_{ij})$ for $i \\neq j$, describe the coupling between the eccentricities of planets $i$ and $j$.\n\nThe solution to the linear system is elegantly found using an eigendecomposition of $\\mathbf{A}$. The `numpy.linalg.eig` function is employed to compute the eigenvalues $g_k$ (the secular eigenfrequencies) and the right eigenvectors $\\mathbf{v}_k$ (the secular eigenmodes). The problem specifies that the modes should be sorted by ascending eigenfrequency, so the eigenvalues and their corresponding eigenvectors are reordered accordingly. The eigenvalues of $\\mathbf{A}$ are guaranteed to be real, a consequence of the underlying Hamiltonian structure of the problem, ensuring a stable, non-runaway evolution of eccentricities.\n\nThe initial state of the system is captured by the complex eccentricity vector $\\mathbf{z}(0)$, constructed from the initial eccentricities $e_i(0)$ and longitudes of periapsis $\\varpi_i(0)$. The propagation of the solution to a time $T$ is performed in the basis of the eigenvectors. First, the initial state vector $\\mathbf{z}(0)$ is decomposed into the eigenbasis by solving the linear system $\\mathbf{V}\\mathbf{c} = \\mathbf{z}(0)$ for the coefficient vector $\\mathbf{c}$, where $\\mathbf{V}$ is the matrix whose columns are the sorted eigenvectors. This is numerically achieved using `numpy.linalg.solve`. The time-evolved state is then synthesized by advancing the phase of each component: $\\mathbf{z}(T) = \\sum_k c_k \\mathbf{v}_k \\exp(i g_k T)$. This summation is efficiently computed using matrix-vector products.\n\nFinally, from the propagated complex vector $\\mathbf{z}(T)$, we extract the physical orbital elements. The eccentricity of each planet at time $T$ is the magnitude of its corresponding complex eccentricity, $e_i(T) = |z_i(T)|$. The longitude of periapsis is its argument, $\\varpi_i(T) = \\arg(z_i(T))$. The angles are then normalized to lie within the specified interval $[0, 2\\pi)$ using the modulo operator. The six resulting floating-point numbers for each case, $[e_1(T), e_2(T), e_3(T), \\varpi_1(T), \\varpi_2(T), \\varpi_3(T)]$, are rounded to six decimal places and formatted into a string that precisely matches the required output structure.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the Laplace-Lagrange secular dynamics for three-planet systems.\n    \"\"\"\n    # Define the gravitational constant in AU, M_sun, year units.\n    G = 4 * np.pi**2\n\n    def laplace_integrand(psi, alpha, s, m):\n        \"\"\"\n        The integrand for the Laplace coefficient integral.\n        \"\"\"\n        denominator = (1 - 2 * alpha * np.cos(psi) + alpha**2)**s\n        numerator = np.cos(m * psi)\n        return numerator / denominator\n\n    def calculate_laplace_coeff(alpha, s, m):\n        \"\"\"\n        Numerically calculates the Laplace coefficient b_s^(m)(alpha).\n        \"\"\"\n        # The full integral is from 0 to 2*pi, divided by pi.\n        result, _ = integrate.quad(laplace_integrand, 0, 2 * np.pi, args=(alpha, s, m))\n        return result / np.pi\n\n    test_cases = [\n        # Case 1: General well-separated three-planet system\n        {\n            \"M_star\": 1.0,\n            \"masses\": np.array([5e-5, 8e-5, 3e-5]),\n            \"semimajor_axes\": np.array([0.5, 0.8, 1.3]),\n            \"initial_e\": np.array([0.05, 0.02, 0.01]),\n            \"initial_w\": np.array([0.0, 1.0, 2.0]),\n            \"T\": 1e4\n        },\n        # Case 2: Near-degenerate precession pair\n        {\n            \"M_star\": 1.0,\n            \"masses\": np.array([1.0e-5, 1.5e-5, 3.0e-5]),\n            \"semimajor_axes\": np.array([1.0, 1.1, 2.5]),\n            \"initial_e\": np.array([0.01, 0.01, 0.02]),\n            \"initial_w\": np.array([0.3, 0.32, 1.7]),\n            \"T\": 5e4\n        },\n        # Case 3: Weakly coupled outer test-like body\n        {\n            \"M_star\": 1.0,\n            \"masses\": np.array([2.0e-5, 4.0e-5, 1.0e-7]),\n            \"semimajor_axes\": np.array([0.7, 1.9, 5.0]),\n            \"initial_e\": np.array([0.02, 0.03, 0.0]),\n            \"initial_w\": np.array([2.8, 0.5, 1.2]),\n            \"T\": 2e5\n        }\n    ]\n\n    all_case_results = []\n\n    for case in test_cases:\n        M_star = case[\"M_star\"]\n        m = case[\"masses\"]\n        a = case[\"semimajor_axes\"]\n        e0 = case[\"initial_e\"]\n        w0 = case[\"initial_w\"]\n        T = case[\"T\"]\n        \n        num_planets = len(m)\n        \n        # Calculate mean motions n_i\n        n = np.sqrt(G * (M_star + m) / a**3)\n        \n        # Pre-calculate alpha_ij and required Laplace coefficients\n        alphas = {}\n        laplace_b1_cache = {}\n        laplace_b2_cache = {}\n        \n        for i in range(num_planets):\n            for j in range(i + 1, num_planets):\n                alpha_val = min(a[i], a[j]) / max(a[i], a[j])\n                alphas[(i, j)] = alphas[(j, i)] = alpha_val\n                \n                # Use a cache to avoid recomputing for the same alpha\n                if alpha_val not in laplace_b1_cache:\n                    laplace_b1_cache[alpha_val] = calculate_laplace_coeff(alpha_val, 1.5, 1)\n                    laplace_b2_cache[alpha_val] = calculate_laplace_coeff(alpha_val, 1.5, 2)\n\n        # Construct the interaction matrix A\n        A = np.zeros((num_planets, num_planets))\n        for i in range(num_planets):\n            # Diagonal elements A_ii\n            Aii_sum = 0\n            for j in range(num_planets):\n                if i == j:\n                    continue\n                alpha_ij = alphas[(i, j)]\n                b1_ij = laplace_b1_cache[alpha_ij]\n                Aii_sum += (m[j] / (M_star + m[i])) * alpha_ij * b1_ij\n            A[i, i] = (n[i] / 4.0) * Aii_sum\n\n            # Off-diagonal elements A_ij\n            for j in range(num_planets):\n                if i == j:\n                    continue\n                alpha_ij = alphas[(i, j)]\n                b2_ij = laplace_b2_cache[alpha_ij]\n                A[i, j] = -(n[i] / 4.0) * (m[j] / (M_star + m[i])) * alpha_ij * b2_ij\n\n        # Solve the eigenproblem for A\n        eigenvalues, eigenvectors = np.linalg.eig(A)\n        \n        # Eigenvalues should be real for this physical problem\n        eigenvalues = np.real(eigenvalues)\n\n        # Sort modes by ascending eigenfrequency\n        sort_indices = np.argsort(eigenvalues)\n        g_sorted = eigenvalues[sort_indices]\n        V_sorted = eigenvectors[:, sort_indices]\n        \n        # Construct initial complex eccentricity vector z(0)\n        z0 = e0 * np.exp(1j * w0)\n        \n        # Decompose z(0) in the eigenbasis: V * c = z0\n        c = np.linalg.solve(V_sorted, z0)\n        \n        # Propagate to time T: z(T) = sum_k c_k * v_k * exp(i*g_k*T)\n        exp_term = np.exp(1j * g_sorted * T)\n        zT = V_sorted @ (c * exp_term)\n        \n        # Recover final eccentricities and longitudes of periapsis\n        eT = np.abs(zT)\n        wT_raw = np.angle(zT)\n        \n        # Normalize angles to [0, 2*pi)\n        wT_normalized = np.mod(wT_raw, 2 * np.pi)\n        \n        # Combine results [e1, e2, e3, w1, w2, w3] and format\n        case_results = np.concatenate((eT, wT_normalized))\n        \n        # Format results to 6 decimal places and store as a string block\n        formatted_results = [f\"{x:.6f}\" for x in case_results]\n        all_case_results.append(f\"[{','.join(formatted_results)}]\")\n\n    # Print the final output string in the exact required format\n    final_output_string = f\"[{','.join(all_case_results)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}