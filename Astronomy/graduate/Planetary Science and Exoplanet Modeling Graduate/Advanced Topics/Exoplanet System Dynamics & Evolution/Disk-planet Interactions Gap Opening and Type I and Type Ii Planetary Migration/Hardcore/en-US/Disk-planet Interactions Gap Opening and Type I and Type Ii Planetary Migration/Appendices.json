{
    "hands_on_practices": [
        {
            "introduction": "Full three-dimensional simulations of disk-planet systems are computationally intensive, making two-dimensional models an indispensable tool for research. However, reducing the dimensionality requires careful approximation of the 3D physics. This practice focuses on a crucial aspect: the planet's gravitational potential. You will explore how a softened potential, characterized by a length scale $\\epsilon$, can be calibrated not merely to avoid a numerical singularity, but to physically represent the averaging of the planet's gravity over the vertical thickness of the disk. By implementing this calibration , you will develop a foundational skill for constructing 2D simulations that yield torques consistent with their 3D counterparts.",
            "id": "4158871",
            "problem": "Consider a planet of mass $M_p$ embedded in a protoplanetary disk orbiting a star of mass $M_\\star$ at orbital radius $r_p$ with Keplerian angular frequency $\\Omega_p = \\sqrt{GM_\\star / r_p^3}$. The disk has a locally isothermal vertical structure with Gaussian density profile $\\rho(z) \\propto \\exp\\left(-z^2/2H^2\\right)$, where $H$ is the disk scale height at $r_p$, and define the disk aspect ratio $h = H/r_p$. In two-dimensional simulations, the planet's gravitational potential is commonly softened to avoid singular behavior and to mimic the effect of the finite vertical thickness, by replacing the Newtonian potential with a softened form characterized by a softening length $\\epsilon$. The physical goal is to choose $\\epsilon$ such that the net torque measured in two-dimensional calculations best reproduces the three-dimensional benchmark torque in the linear, isothermal, Type I regime for a given $h$.\n\nStarting from first principles and well-tested facts:\n\n- Newton's law of gravitation for a softened point mass in two dimensions gives the midplane radial gravitational acceleration induced by the planet at an in-plane separation $x = |r - r_p|$ as $g_{\\mathrm{2D}}(x; \\epsilon) = GM_p\\, x\\, (x^2 + \\epsilon^2)^{-3/2}$.\n- The three-dimensional midplane radial gravitational acceleration induced by the planet, vertically averaged with the Gaussian weight appropriate to an isothermal disk, is $g_{\\mathrm{3D}}(x) = GM_p\\, x \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-z^2/2H^2\\right) \\left(x^2 + z^2\\right)^{-3/2}\\, dz \\right] \\big/ \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-z^2/2H^2\\right)\\, dz \\right]$.\n- In linear perturbation theory of disk-planet interactions, the torque amplitude scales proportionally to the strength of the gravitational forcing that excites spiral density waves near the Lindblad resonances. For an isothermal disk, the resonant response peaks at radial offsets comparable to the scale height, making $x \\sim H$ a physically meaningful matching location.\n- The three-dimensional benchmark torque in the linear, isothermal regime (Type I migration) is a well-established reference quantity that scales as $\\Gamma_{\\mathrm{3D}} \\propto \\Gamma_0$, where $\\Gamma_0 = (q/h)^2 \\Sigma_p r_p^4 \\Omega_p^2$ with $q = M_p/M_\\star$ and $\\Sigma_p$ the surface density at $r_p$.\n\nYour task is to derive an algorithm that calibrates the softening length $\\epsilon$ in two dimensions by matching the vertically averaged three-dimensional gravitational forcing at the physically relevant scale $x = H$, i.e., determine $\\epsilon$ such that $g_{\\mathrm{2D}}(H; \\epsilon) = g_{\\mathrm{3D}}(H)$. Use this calibration to compute $\\epsilon$ for given $h$ and $r_p$. You must work from the definitions above and use mathematically sound transformations. You must not assume any ad hoc proportionality constants that are not justified from these definitions.\n\nImplementation requirements:\n\n1. Express the matching condition at $x = H$ in dimensionless form by introducing $u = z/H$ and $b = \\epsilon/H$. Derive a solvable equation for $b$.\n2. Evaluate any required integrals numerically with adequate accuracy.\n3. Solve for $b$ and compute $\\epsilon = b\\, H = b\\, h\\, r_p$.\n4. For each test case, output $\\epsilon$ in units of $r_p$, rounded to six decimal places.\n\nTest suite:\n\nUse the following parameter sets, each specified as $(r_p, h)$:\n\n- Test 1 (typical case): $(1.0, 0.05)$\n- Test 2 (cooler, thinner disk): $(1.0, 0.03)$\n- Test 3 (warmer, thicker disk): $(1.0, 0.10)$\n- Test 4 (boundary: very thin disk): $(1.0, 0.015)$\n- Test 5 (boundary: relatively thick disk): $(1.0, 0.12)$\n\nFinal output format:\n\nYour program should produce a single line of output containing the calibrated softening lengths for all test cases as a comma-separated list enclosed in square brackets (e.g., \"[value1,value2,value3,value4,value5]\"). Each value must be the calibrated softening length $\\epsilon$ in units of $r_p$, rounded to six decimal places.",
            "solution": "The problem requires the calibration of the gravitational softening length, $\\epsilon$, used in two-dimensional ($2$D) numerical simulations of disk-planet interactions. The calibration criterion is that the resulting $2$D gravitational acceleration should match the vertically-averaged three-dimensional ($3$D) gravitational acceleration at a physically motivated location. This location is chosen as a radial distance from the planet equal to the disk's vertical scale height, $H$.\n\nThe fundamental principle for this calibration is the equality of the magnitudes of the radial gravitational acceleration at the midplane, evaluated at an in-plane separation $x = H$:\n$$g_{\\mathrm{2D}}(H; \\epsilon) = g_{\\mathrm{3D}}(H)$$\nThe problem provides the explicit forms for both terms. The $2$D softened gravitational acceleration is given by:\n$$g_{\\mathrm{2D}}(x; \\epsilon) = GM_p\\, x\\, (x^2 + \\epsilon^2)^{-3/2}$$\nEvaluated at $x=H$, this becomes:\n$$g_{\\mathrm{2D}}(H; \\epsilon) = GM_p\\, H\\, (H^2 + \\epsilon^2)^{-3/2}$$\nThe $3$D gravitational acceleration, averaged over the vertical Gaussian density profile of the disk, is given by:\n$$g_{\\mathrm{3D}}(x) = GM_p\\, x \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{z^2}{2H^2}\\right) \\left(x^2 + z^2\\right)^{-3/2}\\, dz \\right] \\bigg/ \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{z^2}{2H^2}\\right)\\, dz \\right]$$\nEvaluated at $x=H$, this is:\n$$g_{\\mathrm{3D}}(H) = GM_p\\, H \\frac{\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{z^2}{2H^2}\\right) \\left(H^2 + z^2\\right)^{-3/2}\\, dz}{\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{z^2}{2H^2}\\right)\\, dz}$$\nBy equating $g_{\\mathrm{2D}}(H; \\epsilon)$ and $g_{\\mathrm{3D}}(H)$, the common prefactor $GM_p H$ cancels, leaving an equation that determines $\\epsilon$ based on $H$:\n$$(H^2 + \\epsilon^2)^{-3/2} = \\frac{\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{z^2}{2H^2}\\right) \\left(H^2 + z^2\\right)^{-3/2}\\, dz}{\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{z^2}{2H^2}\\right)\\, dz}$$\nTo derive a universal relationship, we non-dimensionalize this equation. Let us introduce dimensionless variables for the softening length, $b = \\epsilon/H$, and the vertical coordinate, $u = z/H$. This implies $\\epsilon=bH$, $z=uH$, and $dz=H du$.\n\nThe left-hand side (LHS) of the equation transforms to:\n$$\\text{LHS} = (H^2 + (bH)^2)^{-3/2} = (H^2(1+b^2))^{-3/2} = H^{-3}(1+b^2)^{-3/2}$$\nFor the right-hand side (RHS), we first evaluate the denominator, which is a standard Gaussian integral:\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{z^2}{2H^2}\\right)\\, dz = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{u^2}{2}\\right)\\, (H du) = H \\int_{-\\infty}^{\\infty} e^{-u^2/2}\\, du = H\\sqrt{2\\pi}$$\nNext, we transform the numerator integral:\n$$ \\int_{-\\infty}^{\\infty} e^{-z^2/2H^2} (H^2 + z^2)^{-3/2}\\, dz = \\int_{-\\infty}^{\\infty} e^{-u^2/2} (H^2 + (uH)^2)^{-3/2}\\, (H du) $$\n$$ = \\int_{-\\infty}^{\\infty} e^{-u^2/2} (H^2(1+u^2))^{-3/2}\\, H du = H^{-2} \\int_{-\\infty}^{\\infty} \\frac{e^{-u^2/2}}{(1+u^2)^{3/2}}\\, du $$\nThe RHS of the matching equation thus becomes:\n$$\\text{RHS} = \\frac{H^{-2} \\int_{-\\infty}^{\\infty} \\frac{e^{-u^2/2}}{(1+u^2)^{3/2}}\\, du}{H\\sqrt{2\\pi}} = H^{-3} \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\frac{e^{-u^2/2}}{(1+u^2)^{3/2}}\\, du$$\nEquating the transformed LHS and RHS, we find that the factor $H^{-3}$ cancels out:\n$$H^{-3}(1+b^2)^{-3/2} = H^{-3} \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\frac{e^{-u^2/2}}{(1+u^2)^{3/2}}\\, du$$\nThis leaves an equation for the dimensionless softening parameter $b$ which is independent of any specific disk parameters, representing a universal constant for this calibration method. Let us define the dimensionless integral $I$ as:\n$$I = \\int_{-\\infty}^{\\infty} \\frac{e^{-u^2/2}}{(1+u^2)^{3/2}} du$$\nThe equation for $b$ simplifies to:\n$$(1+b^2)^{-3/2} = \\frac{I}{\\sqrt{2\\pi}}$$\nWe can now solve for $b$ analytically in terms of $I$:\n$$1+b^2 = \\left(\\frac{I}{\\sqrt{2\\pi}}\\right)^{-2/3} = \\left(\\frac{\\sqrt{2\\pi}}{I}\\right)^{2/3}$$\n$$b^2 = \\left(\\frac{\\sqrt{2\\pi}}{I}\\right)^{2/3} - 1$$\n$$b = \\sqrt{\\left(\\frac{\\sqrt{2\\pi}}{I}\\right)^{2/3} - 1}$$\nA real solution for $b$ requires the argument of the square root to be positive, which means $(\\sqrt{2\\pi}/I)^{2/3}  1$, or $I  \\sqrt{2\\pi}$. This condition is met because for any $u \\neq 0$, $(1+u^2)^{3/2}  1$, making the integrand of $I$ strictly smaller than the integrand of $\\int e^{-u^2/2} du = \\sqrt{2\\pi}$.\n\nThe overall algorithm is as follows:\n1.  Numerically evaluate the definite integral $I$. Since the integrand is an even function of $u$, we can simplify the computation: $I = 2 \\int_{0}^{\\infty} \\frac{e^{-u^2/2}}{(1+u^2)^{3/2}} du$.\n2.  Substitute the numerical value of $I$ into the equation for $b$ to find its constant value.\n3.  For each test case, specified by the disk aspect ratio $h = H/r_p$, calculate the required quantity $\\epsilon/r_p$. Given that $\\epsilon = bH$, we have:\n    $$\\frac{\\epsilon}{r_p} = \\frac{bH}{r_p} = b \\left(\\frac{H}{r_p}\\right) = bh$$\nThe final result for each test case is therefore the product of the universal constant $b$ and the given aspect ratio $h$. This calculation will be implemented in the provided Python script.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Derives and applies the calibration for the 2D gravitational softening length.\n    \n    The calibration is based on matching the 2D softened gravitational acceleration\n    to the vertically-averaged 3D acceleration at a distance equal to the disk\n    scale height H. This leads to a dimensionless softening length b = epsilon/H\n    which is a universal constant for this matching prescription. The code first\n    calculates this constant and then applies it to the given test cases.\n    \"\"\"\n\n    # Step 1: Numerically evaluate the dimensionless integral I.\n    # The integral is I = integral from -inf to inf of [e^(-u^2/2) / (1 + u^2)^(3/2)] du.\n    # As the integrand is an even function, we compute twice the integral from 0 to inf.\n    \n    def integrand(u: float) -> float:\n        \"\"\"The integrand for the dimensionless integral I.\"\"\"\n        return np.exp(-u**2 / 2.0) / (1.0 + u**2)**1.5\n\n    # scipy.integrate.quad returns a tuple (result, absolute_error_estimate).\n    # We only need the result.\n    integral_I, _ = integrate.quad(lambda u: 2.0 * integrand(u), 0, np.inf)\n\n    # Step 2: Compute the constant dimensionless softening length b = epsilon / H.\n    # The analytical derivation yields the formula: b = sqrt((sqrt(2*pi)/I)^(2/3) - 1).\n    sqrt_2pi = np.sqrt(2.0 * np.pi)\n    \n    # The condition integral_I  sqrt_2pi ensures the argument of the square root is positive.\n    # This is physically and mathematically guaranteed as explained in the solution.\n    b_squared = (sqrt_2pi / integral_I)**(2.0 / 3.0) - 1.0\n    b_constant = np.sqrt(b_squared)\n\n    # Step 3: Define the test cases from the problem statement.\n    # Each case is a tuple (orbital_radius r_p, aspect_ratio h = H/r_p).\n    # While r_p is given, the required output epsilon/r_p only depends on h.\n    test_cases = [\n        (1.0, 0.05),   # Test 1: typical case\n        (1.0, 0.03),   # Test 2: cooler, thinner disk\n        (1.0, 0.10),   # Test 3: warmer, thicker disk\n        (1.0, 0.015),  # Test 4: boundary, very thin disk\n        (1.0, 0.12),   # Test 5: boundary, relatively thick disk\n    ]\n\n    results = []\n    # Step 4: For each test case, calculate the required value epsilon / r_p.\n    # From the definitions, we have epsilon/r_p = b * (H/r_p) = b * h.\n    for r_p, h in test_cases:\n        epsilon_over_rp = b_constant * h\n        results.append(epsilon_over_rp)\n\n    # Final print statement in the exact required format.\n    # The results must be rounded to six decimal places.\n    # The f-string format specifier '{value:.6f}' handles standard rounding.\n    print(f\"[{','.join(f'{res:.6f}' for res in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The evolution of a protoplanetary disk is governed by the transport of angular momentum, a process often parameterized by an effective viscosity, $\\nu_{\\mathrm{phys}}$. When simulating these systems, the numerical algorithm itself introduces an artificial or 'numerical' viscosity, $\\nu_{\\mathrm{num}}$. This exercise  provides a hands-on guide to a critical task in simulation setup: ensuring that the physical processes you aim to study are not obscured by numerical artifacts. You will learn to constrain your grid resolution and time step to guarantee that physical viscosity dominates, a fundamental step for achieving a physically meaningful simulation of viscous evolution and gap formation.",
            "id": "4158829",
            "problem": "A Sun-like star of mass $M_{\\star}=M_{\\odot}$ hosts a locally isothermal, Keplerian protoplanetary disk. Consider the neighborhood of a planet embedded at a fiducial radius $r_{0}=5\\,\\mathrm{AU}$, where the disk has aspect ratio $h \\equiv H/r = 0.05$ and turbulent viscosity given by the Shakura–Sunyaev prescription $\\nu_{\\mathrm{phys}}=\\alpha\\,c_{s}\\,H$ with $\\alpha=10^{-3}$. Here $H$ is the vertical scale height and $c_{s}$ is the isothermal sound speed. Assume Newtonian gravity with $G$ the gravitational constant and $M_{\\odot}$ the solar mass. The Keplerian angular frequency is $\\Omega=\\sqrt{GM_{\\star}/r^{3}}$, the Keplerian speed is $v_{K}=\\sqrt{GM_{\\star}/r}$, and $H=c_{s}/\\Omega$ in vertical hydrostatic equilibrium. \n\nYou will numerically evolve the disk with an explicit, second-order, finite-volume hydrodynamics scheme using a Lax–Friedrichs (Rusanov) flux and piecewise-linear reconstruction. In such schemes, the leading-order effective numerical viscosity in shear flows scales linearly with grid spacing and characteristic signal speed: $\\nu_{\\mathrm{num}}\\approx\\kappa\\,a\\,\\Delta r$, where $a$ is the local characteristic signal speed (here, take $a=c_{s}$) and $\\kappa$ is a method-dependent constant; adopt $\\kappa=1/2$ for this solver. The time step must satisfy both an advective Courant–Friedrichs–Lewy (CFL) bound $\\Delta t \\leq C_{\\mathrm{CFL}}\\,\\Delta r/a$ and a viscous stability bound for explicit diffusion $\\Delta t \\leq C_{\\nu}\\,\\Delta r^{2}/\\nu_{\\mathrm{phys}}$. Use $C_{\\mathrm{CFL}}=0.4$ and $C_{\\nu}=0.4$.\n\nStarting from the above physical definitions, compute the physical viscosity $\\nu_{\\mathrm{phys}}$ at $r_{0}$ and impose the requirement that physical viscosity dominates numerical viscosity by at least one order of magnitude locally, i.e., $\\nu_{\\mathrm{num}} \\leq 0.1\\,\\nu_{\\mathrm{phys}}$, to obtain the tightest allowable uniform radial grid spacing $\\Delta r_{\\max}$. Then, using this $\\Delta r_{\\max}$, find the largest time step $\\Delta t_{\\max}$ that simultaneously satisfies both the advective and viscous stability constraints. \n\nRound your final values to three significant figures. Express $\\Delta r_{\\max}$ in Astronomical Units (AU) and $\\Delta t_{\\max}$ in days. Provide your final answer as a two-entry row vector $\\left(\\Delta r_{\\max},\\,\\Delta t_{\\max}\\right)$.",
            "solution": "We begin by deriving the physical viscosity from the Shakura–Sunyaev prescription. The disk is locally isothermal with aspect ratio $h=H/r$, so the isothermal sound speed satisfies\n$$\nc_{s} = h\\,v_{K} \\quad \\text{with} \\quad v_{K} = \\sqrt{\\frac{GM_{\\star}}{r}}.\n$$\nIn vertical hydrostatic equilibrium, $H=c_{s}/\\Omega$ with $\\Omega = v_{K}/r$. Thus $H = c_{s}/(v_{K}/r) = c_{s}\\,r/v_{K} = h\\,r$. Therefore, the Shakura–Sunyaev physical viscosity at $r_{0}$ is\n$$\n\\nu_{\\mathrm{phys}} = \\alpha\\,c_{s}\\,H = \\alpha\\,(h\\,v_{K})\\,(h\\,r) = \\alpha\\,h^{2}\\,r\\,v_{K}.\n$$\n\nWe evaluate $v_{K}$ at $r_{0}=5\\,\\mathrm{AU}$ around a Sun-like star. Using $GM_{\\odot}$ in cgs units,\n$$\nGM_{\\odot} \\approx 1.3271244\\times 10^{26}\\,\\mathrm{cm^{3}\\,s^{-2}}, \\quad r_{0} = 5\\,\\mathrm{AU} = 5\\times 1.495978707\\times 10^{13}\\,\\mathrm{cm} = 7.479893535\\times 10^{13}\\,\\mathrm{cm}.\n$$\nHence,\n$$\nv_{K}(r_{0}) = \\sqrt{\\frac{GM_{\\odot}}{r_{0}}} \\approx \\sqrt{\\frac{1.3271244\\times 10^{26}}{7.479893535\\times 10^{13}}} \\approx \\sqrt{1.7749\\times 10^{12}} \\approx 1.332\\times 10^{6}\\,\\mathrm{cm\\,s^{-1}}.\n$$\nWith $h=0.05$, we have\n$$\nc_{s} = h\\,v_{K} \\approx 0.05\\times 1.332\\times 10^{6} \\approx 6.66\\times 10^{4}\\,\\mathrm{cm\\,s^{-1}},\n$$\nand\n$$\nH = h\\,r_{0} \\approx 0.05\\times 7.479893535\\times 10^{13} \\approx 3.7399467675\\times 10^{12}\\,\\mathrm{cm}.\n$$\nTherefore,\n$$\n\\nu_{\\mathrm{phys}} = \\alpha\\,c_{s}\\,H \\approx 10^{-3}\\times (6.66\\times 10^{4})\\times (3.7399467675\\times 10^{12}) \\approx 2.4889\\times 10^{14}\\,\\mathrm{cm^{2}\\,s^{-1}}.\n$$\n\nNext, we estimate the effective numerical viscosity for the chosen solver,\n$$\n\\nu_{\\mathrm{num}} \\approx \\kappa\\,a\\,\\Delta r, \\quad \\text{with} \\quad a=c_{s}, \\quad \\kappa=\\frac{1}{2}.\n$$\nImposing physical viscosity dominance by a factor of at least $10$, we require\n$$\n\\nu_{\\mathrm{num}} \\leq 0.1\\,\\nu_{\\mathrm{phys}} \\;\\;\\Rightarrow\\;\\; \\kappa\\,c_{s}\\,\\Delta r \\leq 0.1\\,\\nu_{\\mathrm{phys}}.\n$$\nSolving for the maximum allowable grid spacing,\n$$\n\\Delta r_{\\max} = \\frac{0.1\\,\\nu_{\\mathrm{phys}}}{\\kappa\\,c_{s}} = \\frac{0.1\\times 2.4889\\times 10^{14}}{(1/2)\\times 6.66\\times 10^{4}}\\,\\mathrm{cm} \\approx \\frac{2.4889\\times 10^{13}}{3.33\\times 10^{4}}\\,\\mathrm{cm} \\approx 7.475\\times 10^{8}\\,\\mathrm{cm}.\n$$\nConvert to Astronomical Units (AU),\n$$\n\\Delta r_{\\max} \\approx \\frac{7.475\\times 10^{8}\\,\\mathrm{cm}}{1.495978707\\times 10^{13}\\,\\mathrm{cm/AU}} \\approx 4.997\\times 10^{-5}\\,\\mathrm{AU}.\n$$\n\nWe now set the time step constraints. The advective CFL bound is\n$$\n\\Delta t \\leq C_{\\mathrm{CFL}}\\frac{\\Delta r}{a} = C_{\\mathrm{CFL}}\\frac{\\Delta r}{c_{s}},\n$$\nand the viscous stability bound for explicit diffusion is\n$$\n\\Delta t \\leq C_{\\nu}\\frac{\\Delta r^{2}}{\\nu_{\\mathrm{phys}}}.\n$$\nWith $C_{\\mathrm{CFL}}=0.4$, $C_{\\nu}=0.4$, $c_{s}=6.66\\times 10^{4}\\,\\mathrm{cm\\,s^{-1}}$, $\\nu_{\\mathrm{phys}}=2.4889\\times 10^{14}\\,\\mathrm{cm^{2}\\,s^{-1}}$, and $\\Delta r=\\Delta r_{\\max}=7.475\\times 10^{8}\\,\\mathrm{cm}$, we obtain\n$$\n\\Delta t_{\\mathrm{adv}} = 0.4\\,\\frac{7.475\\times 10^{8}}{6.66\\times 10^{4}}\\,\\mathrm{s} \\approx 0.4\\times 1.1228\\times 10^{4}\\,\\mathrm{s} \\approx 4.491\\times 10^{3}\\,\\mathrm{s},\n$$\nand\n$$\n\\Delta t_{\\mathrm{visc}} = 0.4\\,\\frac{(7.475\\times 10^{8})^{2}}{2.4889\\times 10^{14}}\\,\\mathrm{s} = 0.4\\,\\frac{5.589\\times 10^{17}}{2.4889\\times 10^{14}}\\,\\mathrm{s} \\approx 0.4\\times 2.246\\times 10^{3}\\,\\mathrm{s} \\approx 8.99\\times 10^{2}\\,\\mathrm{s}.\n$$\nThe largest stable time step that satisfies both constraints is the minimum of these two,\n$$\n\\Delta t_{\\max} = \\min\\left(\\Delta t_{\\mathrm{adv}},\\,\\Delta t_{\\mathrm{visc}}\\right) \\approx 8.99\\times 10^{2}\\,\\mathrm{s}.\n$$\nConvert $\\Delta t_{\\max}$ to days using $1\\,\\mathrm{day}=86400\\,\\mathrm{s}$,\n$$\n\\Delta t_{\\max} \\approx \\frac{8.99\\times 10^{2}}{86400}\\,\\mathrm{days} \\approx 1.04\\times 10^{-2}\\,\\mathrm{days}.\n$$\n\nFinally, rounding both quantities to three significant figures and expressing in the requested units, we have\n$$\n\\Delta r_{\\max} \\approx 5.00\\times 10^{-5}\\,\\mathrm{AU}, \\quad \\Delta t_{\\max} \\approx 1.04\\times 10^{-2}\\,\\mathrm{days}.\n$$\nThese constraints ensure that the modeled viscous transport controlling gap opening and the transition toward type II migration is not artificially dominated by numerical diffusion from the discretization, while maintaining explicit time-stepping stability under both advective and diffusive processes.",
            "answer": "$$\\boxed{\\begin{pmatrix}5.00 \\times 10^{-5}  1.04 \\times 10^{-2}\\end{pmatrix}}$$"
        },
        {
            "introduction": "A planet embedded in a disk excites spiral density waves that propagate, steepen, and form shocks, which are the primary sites of angular momentum exchange that drives planetary migration. Capturing these thin shock fronts accurately is a significant challenge for any grid-based numerical code. This exercise  delves into the consequences of under-resolving these shocks. By modeling the numerical smearing of a shock as a diffusive process, you will derive an analytical estimate for the resulting error in the calculated planetary torque, providing you with a vital tool for critically assessing the accuracy and limitations of numerical simulation results.",
            "id": "4158850",
            "problem": "A planet of mass $M_p$ embedded at radius $r_p$ in a two-dimensional, locally isothermal protoplanetary disk with surface density $\\Sigma(r)$ and sound speed $c_s(r)$ launches tightly wound spiral density waves that propagate with group velocity approximately $c_s$. The disk scale height is $H \\equiv c_s/\\Omega$, where $\\Omega$ is the local angular frequency. The governing fluid equations are conservation of mass and momentum in the plane:\n$$\n\\frac{\\partial \\Sigma}{\\partial t} + \\nabla \\cdot (\\Sigma \\mathbf{v}) = 0, \\qquad \\frac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v}\\cdot\\nabla)\\mathbf{v} = -\\frac{1}{\\Sigma}\\nabla P - \\nabla \\Phi,\n$$\nwith $P$ the pressure and $\\Phi$ the gravitational potential of the star and planet. As the launched compressive waves steepen, they form shocks that dissipate wave energy and angular momentum, thereby regulating the torque exchange between the disk and the planet. Accurate High-Resolution Shock-Capturing (HRSC) schemes are required to realize the correct Rankine–Hugoniot jump conditions and to prevent unphysical dispersive oscillations and artificial broadening of the shock, both of which can bias the amplitude and phase of the spiral wake and hence the torque.\n\nConsider a numerical model that under-resolves the spiral shock such that the discontinuity is smeared over a width $\\ell_{\\mathrm{num}}$ spanning $m$ grid cells of size $\\Delta x$, i.e., $\\ell_{\\mathrm{num}} = m\\,\\Delta x$. Model the impact of this smearing on the wave by treating the shock layer as a diffusive region of effective numerical viscosity that acts to smooth the density perturbation over the width $\\ell_{\\mathrm{num}}$. Assume the wake is dominated by a mode of radial wavenumber $k \\sim 1/H$, and that in the low-mass (type I) regime the net Lindblad torque scales linearly with the amplitude of the launched wake. Using only the fluid conservation laws above together with the fact that diffusive smoothing of a Fourier mode of wavenumber $k$ over a distance $\\ell_{\\mathrm{num}}$ attenuates its amplitude as if convolved with a Gaussian kernel of width comparable to $\\ell_{\\mathrm{num}}$, derive the leading-order scaling of the fractional torque error $\\epsilon_T$ caused by under-resolving the shock.\n\nThen, evaluate $\\epsilon_T$ for a disk with $H/r_p = 0.05$, a grid spacing $\\Delta x = H/20$, and a smeared shock spanning $m = 6$ cells. Take $k = 1/H$ and $\\ell_{\\mathrm{num}} = m\\,\\Delta x$.\n\nWhich option best represents the fractional torque error under these assumptions, including its numerical value?\n\nA. $\\epsilon_T \\approx 1 - \\exp\\!\\left(-\\tfrac{1}{2}(k\\,\\ell_{\\mathrm{num}})^2\\right) \\approx 0.044$\n\nB. $\\epsilon_T \\approx \\ell_{\\mathrm{num}}/H \\approx 0.30$\n\nC. $\\epsilon_T \\approx (k\\,\\ell_{\\mathrm{num}})^2 \\approx 0.09$\n\nD. $\\epsilon_T \\approx 1 - \\exp\\!\\left(-(k\\,\\ell_{\\mathrm{num}})\\right) \\approx 0.26$",
            "solution": "The fractional torque error, $\\epsilon_T$, is the normalized difference between the exact torque, $\\mathcal{T}_{\\text{exact}}$, and the numerically computed torque, $\\mathcal{T}_{\\text{num}}$:\n$$ \\epsilon_T = \\frac{\\mathcal{T}_{\\text{exact}} - \\mathcal{T}_{\\text{num}}}{\\mathcal{T}_{\\text{exact}}} = 1 - \\frac{\\mathcal{T}_{\\text{num}}}{\\mathcal{T}_{\\text{exact}}} $$\nThe problem states that torque scales linearly with the amplitude of the spiral wake, $A$. Therefore, the fractional torque error is equal to the fractional amplitude error: $\\epsilon_T = 1 - A_{\\text{num}}/A_{\\text{exact}}$.\n\nThe problem models the numerical error as the convolution of the true wave profile with a Gaussian kernel of width $\\sigma = \\ell_{\\mathrm{num}}$. The effect of convolution in real space is equivalent to multiplication in Fourier space. The amplitude of a Fourier mode with wavenumber $k$ is therefore attenuated by a factor equal to the Fourier transform of the Gaussian kernel, which is $\\exp\\left(-\\frac{1}{2}(k\\sigma)^2\\right)$.\nThe ratio of the numerical to the exact amplitude is thus given by:\n$$ \\frac{A_{\\text{num}}}{A_{\\text{exact}}} = \\exp\\left(-\\frac{1}{2}(k\\ell_{\\mathrm{num}})^2\\right) $$\nSubstituting this into the expression for the fractional torque error yields the required scaling relation:\n$$ \\epsilon_T = 1 - \\exp\\left(-\\frac{1}{2}(k\\,\\ell_{\\mathrm{num}})^2\\right) $$\nWe can now evaluate this expression using the parameters provided in the problem:\n- Wavenumber: $k = 1/H$\n- Number of grid cells for smearing: $m = 6$\n- Grid cell size: $\\Delta x = H/20$\n- Numerical smearing width: $\\ell_{\\mathrm{num}} = m\\,\\Delta x = 6 \\cdot (H/20) = 0.3\\,H$\n\nFirst, we compute the dimensionless product $k\\,\\ell_{\\mathrm{num}}$:\n$$ k\\,\\ell_{\\mathrm{num}} = \\left(\\frac{1}{H}\\right) \\cdot (0.3\\,H) = 0.3 $$\nNext, we substitute this value into the derived formula for $\\epsilon_T$:\n$$ \\epsilon_T = 1 - \\exp\\left(-\\frac{1}{2}(0.3)^2\\right) = 1 - \\exp\\left(-\\frac{0.09}{2}\\right) = 1 - \\exp(-0.045) $$\nUsing a calculator, $\\exp(-0.045) \\approx 0.955997$.\n$$ \\epsilon_T \\approx 1 - 0.955997 = 0.044003 $$\nThe fractional torque error is approximately $0.044$. This result matches option A, both in its functional form and its numerical value.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}