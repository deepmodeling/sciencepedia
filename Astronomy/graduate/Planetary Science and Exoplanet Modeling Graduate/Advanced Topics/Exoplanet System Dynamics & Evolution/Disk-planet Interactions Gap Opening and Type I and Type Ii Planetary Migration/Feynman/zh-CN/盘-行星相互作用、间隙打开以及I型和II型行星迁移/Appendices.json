{
    "hands_on_practices": [
        {
            "introduction": "在模拟行星迁移（尤其是II型迁移）和吸积盘演化时，粘性是一个核心物理过程。然而，数值模拟方法自身会引入一种人为的“数值粘性”，它可能掩盖我们想要研究的真实物理粘性（例如由Shakura-Sunyaev $\\alpha$模型描述的湍流粘性）。本练习旨在通过推导网格分辨率和时间步长的约束条件，来确保物理粘性在模拟中占主导地位，从而保证模拟结果的物理保真度。",
            "id": "4158829",
            "problem": "一颗质量为 $M_{\\star}=M_{\\odot}$ 的类日恒星拥有一个局部等温的开普勒原行星盘。考虑嵌入在基准半径 $r_{0}=5\\,\\mathrm{AU}$ 处的一颗行星的邻近区域，此处的星盘高宽比为 $h \\equiv H/r = 0.05$，湍流粘性由 Shakura–Sunyaev 公式 $\\nu_{\\mathrm{phys}}=\\alpha\\,c_{s}\\,H$ 给出，其中 $\\alpha=10^{-3}$。这里 $H$ 是垂直标高，$c_{s}$ 是等温声速。假设牛顿引力，其中 $G$ 为引力常数，$M_{\\odot}$ 为太阳质量。开普勒角频率为 $\\Omega=\\sqrt{GM_{\\star}/r^{3}}$，开普勒速度为 $v_{K}=\\sqrt{GM_{\\star}/r}$，在垂直静流体平衡中 $H=c_{s}/\\Omega$。\n\n你将使用一个显式的二阶有限体积流体动力学方案来数值演化该星盘，该方案使用 Lax–Friedrichs (Rusanov) 通量和分段线性重构。在此类方案中，剪切流中的主导阶有效数值粘性与网格间距和特征信号速度成线性关系：$\\nu_{\\mathrm{num}}\\approx\\kappa\\,a\\,\\Delta r$，其中 $a$ 是局部特征信号速度（此处取 $a=c_{s}$），$\\kappa$ 是一个与方法相关的常数；对于此求解器，采用 $\\kappa=1/2$。时间步长必须同时满足一个平流 Courant–Friedrichs–Lewy (CFL) 界限 $\\Delta t \\leq C_{\\mathrm{CFL}}\\,\\Delta r/a$ 和一个用于显式扩散的粘性稳定性界限 $\\Delta t \\leq C_{\\nu}\\,\\Delta r^{2}/\\nu_{\\mathrm{phys}}$。使用 $C_{\\mathrm{CFL}}=0.4$ 和 $C_{\\nu}=0.4$。\n\n从上述物理定义出发，计算在 $r_{0}$ 处的物理粘性 $\\nu_{\\mathrm{phys}}$，并施加物理粘性在局部至少比数值粘性大一个数量级的要求，即 $\\nu_{\\mathrm{num}} \\leq 0.1\\,\\nu_{\\mathrm{phys}}$，以获得最紧凑的允许均匀径向网格间距 $\\Delta r_{\\max}$。然后，使用这个 $\\Delta r_{\\max}$，找到同时满足平流和粘性稳定性约束的最大时间步长 $\\Delta t_{\\max}$。\n\n将你的最终值四舍五入到三位有效数字。用天文单位 (AU) 表示 $\\Delta r_{\\max}$，用天表示 $\\Delta t_{\\max}$。将你的最终答案以一个二元行向量 $\\left(\\Delta r_{\\max},\\,\\Delta t_{\\max}\\right)$ 的形式给出。",
            "solution": "我们首先从 Shakura–Sunyaev 公式推导物理粘性。星盘是局部等温的，高宽比为 $h=H/r$，因此等温声速满足\n$$\nc_{s} = h\\,v_{K} \\quad \\text{其中} \\quad v_{K} = \\sqrt{\\frac{GM_{\\star}}{r}}。\n$$\n在垂直静流体平衡中，$H=c_{s}/\\Omega$ 且 $\\Omega = v_{K}/r$。因此 $H = c_{s}/(v_{K}/r) = c_{s}\\,r/v_{K} = h\\,r$。因此，在 $r_{0}$ 处的 Shakura–Sunyaev 物理粘性为\n$$\n\\nu_{\\mathrm{phys}} = \\alpha\\,c_{s}\\,H = \\alpha\\,(h\\,v_{K})\\,(h\\,r) = \\alpha\\,h^{2}\\,r\\,v_{K}。\n$$\n\n我们计算一颗类日恒星周围 $r_{0}=5\\,\\mathrm{AU}$ 处的 $v_{K}$。使用 cgs 单位制下的 $GM_{\\odot}$，\n$$\nGM_{\\odot} \\approx 1.3271244\\times 10^{26}\\,\\mathrm{cm^{3}\\,s^{-2}}, \\quad r_{0} = 5\\,\\mathrm{AU} = 5\\times 1.495978707\\times 10^{13}\\,\\mathrm{cm} = 7.479893535\\times 10^{13}\\,\\mathrm{cm}.\n$$\n因此，\n$$\nv_{K}(r_{0}) = \\sqrt{\\frac{GM_{\\odot}}{r_{0}}} \\approx \\sqrt{\\frac{1.3271244\\times 10^{26}}{7.479893535\\times 10^{13}}} \\approx \\sqrt{1.7749\\times 10^{12}} \\approx 1.332\\times 10^{6}\\,\\mathrm{cm\\,s^{-1}}.\n$$\n当 $h=0.05$ 时，我们有\n$$\nc_{s} = h\\,v_{K} \\approx 0.05\\times 1.332\\times 10^{6} \\approx 6.66\\times 10^{4}\\,\\mathrm{cm\\,s^{-1}},\n$$\n并且\n$$\nH = h\\,r_{0} \\approx 0.05\\times 7.479893535\\times 10^{13} \\approx 3.7399467675\\times 10^{12}\\,\\mathrm{cm}.\n$$\n因此，\n$$\n\\nu_{\\mathrm{phys}} = \\alpha\\,c_{s}\\,H \\approx 10^{-3}\\times (6.66\\times 10^{4})\\times (3.7399467675\\times 10^{12}) \\approx 2.4889\\times 10^{14}\\,\\mathrm{cm^{2}\\,s^{-1}}.\n$$\n\n接下来，我们估计所选求解器的有效数值粘性，\n$$\n\\nu_{\\mathrm{num}} \\approx \\kappa\\,a\\,\\Delta r, \\quad \\text{其中} \\quad a=c_{s}, \\quad \\kappa=\\frac{1}{2}.\n$$\n施加物理粘性至少占优 10 倍的条件，我们需要\n$$\n\\nu_{\\mathrm{num}} \\leq 0.1\\,\\nu_{\\mathrm{phys}} \\;\\;\\Rightarrow\\;\\; \\kappa\\,c_{s}\\,\\Delta r \\leq 0.1\\,\\nu_{\\mathrm{phys}}.\n$$\n求解最大允许网格间距，\n$$\n\\Delta r_{\\max} = \\frac{0.1\\,\\nu_{\\mathrm{phys}}}{\\kappa\\,c_{s}} = \\frac{0.1\\times 2.4889\\times 10^{14}}{(1/2)\\times 6.66\\times 10^{4}}\\,\\mathrm{cm} \\approx \\frac{2.4889\\times 10^{13}}{3.33\\times 10^{4}}\\,\\mathrm{cm} \\approx 7.475\\times 10^{8}\\,\\mathrm{cm}.\n$$\n转换为天文单位 (AU)，\n$$\n\\Delta r_{\\max} \\approx \\frac{7.475\\times 10^{8}\\,\\mathrm{cm}}{1.495978707\\times 10^{13}\\,\\mathrm{cm/AU}} \\approx 4.997\\times 10^{-5}\\,\\mathrm{AU}.\n$$\n\n我们现在设定时间步长约束。平流 CFL 界限为\n$$\n\\Delta t \\leq C_{\\mathrm{CFL}}\\frac{\\Delta r}{a} = C_{\\mathrm{CFL}}\\frac{\\Delta r}{c_{s}},\n$$\n显式扩散的粘性稳定性界限为\n$$\n\\Delta t \\leq C_{\\nu}\\frac{\\Delta r^{2}}{\\nu_{\\mathrm{phys}}}.\n$$\n在 $C_{\\mathrm{CFL}}=0.4$，$C_{\\nu}=0.4$，$c_{s}=6.66\\times 10^{4}\\,\\mathrm{cm\\,s^{-1}}$，$\\nu_{\\mathrm{phys}}=2.4889\\times 10^{14}\\,\\mathrm{cm^{2}\\,s^{-1}}$ 和 $\\Delta r=\\Delta r_{\\max}=7.475\\times 10^{8}\\,\\mathrm{cm}$ 的条件下，我们得到\n$$\n\\Delta t_{\\mathrm{adv}} = 0.4\\,\\frac{7.475\\times 10^{8}}{6.66\\times 10^{4}}\\,\\mathrm{s} \\approx 0.4\\times 1.1228\\times 10^{4}\\,\\mathrm{s} \\approx 4.491\\times 10^{3}\\,\\mathrm{s},\n$$\n并且\n$$\n\\Delta t_{\\mathrm{visc}} = 0.4\\,\\frac{(7.475\\times 10^{8})^{2}}{2.4889\\times 10^{14}}\\,\\mathrm{s} = 0.4\\,\\frac{5.589\\times 10^{17}}{2.4889\\times 10^{14}}\\,\\mathrm{s} \\approx 0.4\\times 2.246\\times 10^{3}\\,\\mathrm{s} \\approx 8.99\\times 10^{2}\\,\\mathrm{s}.\n$$\n同时满足这两个约束的最大稳定时间步长是两者中的最小值，\n$$\n\\Delta t_{\\max} = \\min\\left(\\Delta t_{\\mathrm{adv}},\\,\\Delta t_{\\mathrm{visc}}\\right) \\approx 8.99\\times 10^{2}\\,\\mathrm{s}.\n$$\n使用 $1\\,\\mathrm{day}=86400\\,\\mathrm{s}$ 将 $\\Delta t_{\\max}$ 转换为天，\n$$\n\\Delta t_{\\max} \\approx \\frac{8.99\\times 10^{2}}{86400}\\,\\mathrm{days} \\approx 1.04\\times 10^{-2}\\,\\mathrm{days}.\n$$\n\n最后，将两个量四舍五入到三位有效数字并用要求的单位表示，我们得到\n$$\n\\Delta r_{\\max} \\approx 5.00\\times 10^{-5}\\,\\mathrm{AU}, \\quad \\Delta t_{\\max} \\approx 1.04\\times 10^{-2}\\,\\mathrm{days}.\n$$\n这些约束确保了控制间隙打开和向 II 型迁移过渡的粘性输运模型不会被人为的离散化数值扩散所主导，同时在平流和扩散过程中保持显式时间步进的稳定性。",
            "answer": "$$\\boxed{\\begin{pmatrix}5.00 \\times 10^{-5}  1.04 \\times 10^{-2}\\end{pmatrix}}$$"
        },
        {
            "introduction": "对行星-星盘相互作用进行完全三维（$3$D）的流体动力学模拟在计算上是极其昂贵的。因此，二维（$2$D）模拟成为了一种重要且高效的研究工具，但其结果的有效性依赖于仔细的校准，以反映真实的三维物理效应。本实践任务的核心是校准引力软化长度 $\\epsilon$，这是一个关键参数，用于在二维模型中模拟行星引力在星盘垂直厚度上的平均效应，从而确保计算出的力矩能够准确地再现三维情况下的结果。",
            "id": "4158871",
            "problem": "考虑一个质量为 $M_p$ 的行星，嵌入在一个原行星盘中，该行星盘围绕一颗质量为 $M_\\star$ 的恒星在轨道半径 $r_p$ 处运行，其开普勒角频率为 $\\Omega_p = \\sqrt{GM_\\star / r_p^3}$。该盘具有局部等温的垂直结构和高斯密度剖面 $\\rho(z) \\propto \\exp\\left(-z^2/2H^2\\right)$，其中 $H$ 是盘在 $r_p$ 处的标高，并定义盘的高宽比为 $h = H/r_p$。在二维模拟中，为了避免奇异行为并模拟有限垂直厚度的效应，通常会对行星的引力势进行平滑处理，即用一个以平滑长度 $\\epsilon$ 为特征的平滑形式来替代牛顿引力势。其物理目标是选择一个 $\\epsilon$，使得在给定的 $h$ 值下，二维计算中测得的净力矩能最好地再现线性、等温、第一类迁移机制下的三维基准力矩。\n\n从第一性原理和经过充分检验的事实出发：\n\n- 对于二维平滑质点，牛顿引力定律给出了行星在平面内距离 $x = |r - r_p|$ 处引起的中平面径向引力加速度为 $g_{\\mathrm{2D}}(x; \\epsilon) = GM_p\\, x\\, (x^2 + \\epsilon^2)^{-3/2}$。\n- 由行星引起的三维中平面径向引力加速度，在使用适用于等温盘的高斯权重进行垂直平均后，表示为 $g_{\\mathrm{3D}}(x) = GM_p\\, x \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-z^2/2H^2\\right) \\left(x^2 + z^2\\right)^{-3/2}\\, dz \\right] \\big/ \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-z^2/2H^2\\right)\\, dz \\right]$。\n- 在盘-行星相互作用的线性微扰理论中，力矩振幅与在林德布拉德共振点附近激发螺旋密度波的引力驱动强度成正比。对于等温盘，共振响应在与标高相当的径向偏移处达到峰值，这使得 $x \\sim H$ 成为一个物理上有意义的匹配位置。\n- 在线性、等温机制（第一类迁移）中的三维基准力矩是一个公认的参考量，其缩放关系为 $\\Gamma_{\\mathrm{3D}} \\propto \\Gamma_0$，其中 $\\Gamma_0 = (q/h)^2 \\Sigma_p r_p^4 \\Omega_p^2$，并且 $q = M_p/M_\\star$，$\\Sigma_p$ 是 $r_p$ 处的面密度。\n\n你的任务是推导一个算法，通过在物理相关尺度 $x = H$ 处匹配垂直平均的三维引力，来校准二维情况下的平滑长度 $\\epsilon$，即确定 $\\epsilon$ 使得 $g_{\\mathrm{2D}}(H; \\epsilon) = g_{\\mathrm{3D}}(H)$。使用此校准方法为给定的 $h$ 和 $r_p$ 计算 $\\epsilon$。你必须基于上述定义，并使用数学上合理的变换。你不能假设任何未从这些定义中得到证明的临时比例常数。\n\n实现要求：\n\n1. 通过引入 $u = z/H$ 和 $b = \\epsilon/H$，将 $x = H$ 处的匹配条件表示为无量纲形式。推导一个关于 $b$ 的可解方程。\n2. 以足够的精度对任何所需积分进行数值计算。\n3. 求解 $b$ 并计算 $\\epsilon = b\\, H = b\\, h\\, r_p$。\n4. 对于每个测试用例，以 $r_p$ 为单位输出 $\\epsilon$，并四舍五入至六位小数。\n\n测试套件：\n\n使用以下参数集，每个指定为 $(r_p, h)$：\n\n- 测试 1 (典型情况): $(1.0, 0.05)$\n- 测试 2 (更冷、更薄的盘): $(1.0, 0.03)$\n- 测试 3 (更暖、更厚的盘): $(1.0, 0.10)$\n- 测试 4 (边界：非常薄的盘): $(1.0, 0.015)$\n- 测试 5 (边界：相对厚的盘): $(1.0, 0.12)$\n\n最终输出格式：\n\n你的程序应生成单行输出，其中包含所有测试用例的校准平滑长度，形式为一个由方括号括起来的逗号分隔列表（例如，“[value1,value2,value3,value4,value5]”）。每个值都必须是以 $r_p$ 为单位的校准平滑长度 $\\epsilon$，并四舍五入至六位小数。",
            "solution": "该问题要求校准在盘-行星相互作用的二维（$2$D）数值模拟中使用的引力平滑长度 $\\epsilon$。校准标准是，所得到的二维引力加速度应与在某个物理上有明确意义的位置上的垂直平均三维（$3$D）引力加速度相匹配。该位置被选为距行星一个等于盘垂直标高 $H$ 的径向距离处。\n\n此校准的基本原理是，在中平面上、于平面内距离 $x = H$ 处评估的径向引力加速度大小相等：\n$$g_{\\mathrm{2D}}(H; \\epsilon) = g_{\\mathrm{3D}}(H)$$\n问题为这两项提供了显式形式。二维平滑引力加速度由下式给出：\n$$g_{\\mathrm{2D}}(x; \\epsilon) = GM_p\\, x\\, (x^2 + \\epsilon^2)^{-3/2}$$\n在 $x=H$ 处计算，该式变为：\n$$g_{\\mathrm{2D}}(H; \\epsilon) = GM_p\\, H\\, (H^2 + \\epsilon^2)^{-3/2}$$\n三维引力加速度，在盘的垂直高斯密度剖面上进行平均后，由下式给出：\n$$g_{\\mathrm{3D}}(x) = GM_p\\, x \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{z^2}{2H^2}\\right) \\left(x^2 + z^2\\right)^{-3/2}\\, dz \\right] \\bigg/ \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{z^2}{2H^2}\\right)\\, dz \\right]$$\n在 $x=H$ 处计算，该式为：\n$$g_{\\mathrm{3D}}(H) = GM_p\\, H \\frac{\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{z^2}{2H^2}\\right) \\left(H^2 + z^2\\right)^{-3/2}\\, dz}{\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{z^2}{2H^2}\\right)\\, dz}$$\n通过令 $g_{\\mathrm{2D}}(H; \\epsilon)$ 和 $g_{\\mathrm{3D}}(H)$ 相等，公共前置因子 $GM_p H$ 被消掉，留下一个基于 $H$ 决定 $\\epsilon$ 的方程：\n$$(H^2 + \\epsilon^2)^{-3/2} = \\frac{\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{z^2}{2H^2}\\right) \\left(H^2 + z^2\\right)^{-3/2}\\, dz}{\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{z^2}{2H^2}\\right)\\, dz}$$\n为了推导出一个普适关系，我们将此方程无量纲化。我们引入平滑长度的无量纲变量 $b = \\epsilon/H$ 和垂直坐标的无量纲变量 $u = z/H$。这意味着 $\\epsilon=bH$，$z=uH$ 以及 $dz=H du$。\n\n方程的左侧（LHS）变换为：\n$$\\text{LHS} = (H^2 + (bH)^2)^{-3/2} = (H^2(1+b^2))^{-3/2} = H^{-3}(1+b^2)^{-3/2}$$\n对于右侧（RHS），我们首先计算分母，这是一个标准的高斯积分：\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{z^2}{2H^2}\\right)\\, dz = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{u^2}{2}\\right)\\, (H du) = H \\int_{-\\infty}^{\\infty} e^{-u^2/2}\\, du = H\\sqrt{2\\pi}$$\n接着，我们变换分子积分：\n$$ \\int_{-\\infty}^{\\infty} e^{-z^2/2H^2} (H^2 + z^2)^{-3/2}\\, dz = \\int_{-\\infty}^{\\infty} e^{-u^2/2} (H^2 + (uH)^2)^{-3/2}\\, (H du) $$\n$$ = \\int_{-\\infty}^{\\infty} e^{-u^2/2} (H^2(1+u^2))^{-3/2}\\, H du = H^{-2} \\int_{-\\infty}^{\\infty} \\frac{e^{-u^2/2}}{(1+u^2)^{3/2}}\\, du $$\n因此，匹配方程的 RHS 变为：\n$$\\text{RHS} = \\frac{H^{-2} \\int_{-\\infty}^{\\infty} \\frac{e^{-u^2/2}}{(1+u^2)^{3/2}}\\, du}{H\\sqrt{2\\pi}} = H^{-3} \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\frac{e^{-u^2/2}}{(1+u^2)^{3/2}}\\, du$$\n令变换后的 LHS 和 RHS 相等，我们发现因子 $H^{-3}$ 被消掉了：\n$$H^{-3}(1+b^2)^{-3/2} = H^{-3} \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\frac{e^{-u^2/2}}{(1+u^2)^{3/2}}\\, du$$\n这留下了一个关于无量纲平滑参数 $b$ 的方程，该方程不依赖于任何特定的盘参数，代表了此校准方法的一个普适常数。我们定义无量纲积分 $I$ 为：\n$$I = \\int_{-\\infty}^{\\infty} \\frac{e^{-u^2/2}}{(1+u^2)^{3/2}} du$$\n关于 $b$ 的方程简化为：\n$$(1+b^2)^{-3/2} = \\frac{I}{\\sqrt{2\\pi}}$$\n现在我们可以用 $I$ 来解析地求解 $b$：\n$$1+b^2 = \\left(\\frac{I}{\\sqrt{2\\pi}}\\right)^{-2/3} = \\left(\\frac{\\sqrt{2\\pi}}{I}\\right)^{2/3}$$\n$$b^2 = \\left(\\frac{\\sqrt{2\\pi}}{I}\\right)^{2/3} - 1$$\n$$b = \\sqrt{\\left(\\frac{\\sqrt{2\\pi}}{I}\\right)^{2/3} - 1}$$\n$b$ 的实数解要求平方根内的参数为正，即 $(\\sqrt{2\\pi}/I)^{2/3}  1$，或 $I  \\sqrt{2\\pi}$。这个条件是满足的，因为对于任何 $u \\neq 0$，都有 $(1+u^2)^{3/2}  1$，这使得 $I$ 的被积函数严格小于 $\\int e^{-u^2/2} du = \\sqrt{2\\pi}$ 的被积函数。\n\n整体算法如下：\n1.  数值计算定积分 $I$。由于被积函数是 $u$ 的偶函数，我们可以简化计算：$I = 2 \\int_{0}^{\\infty} \\frac{e^{-u^2/2}}{(1+u^2)^{3/2}} du$。\n2.  将 $I$ 的数值代入 $b$ 的方程中，求出其常数值。\n3.  对于每个由盘的高宽比 $h = H/r_p$ 指定的测试用例，计算所需的量 $\\epsilon/r_p$。已知 $\\epsilon = bH$，我们有：\n    $$\\frac{\\epsilon}{r_p} = \\frac{bH}{r_p} = b \\left(\\frac{H}{r_p}\\right) = bh$$\n因此，每个测试用例的最终结果是普适常数 $b$ 与给定的高宽比 $h$ 的乘积。此计算将在提供的 Python 脚本中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Derives and applies the calibration for the 2D gravitational softening length.\n    \n    The calibration is based on matching the 2D softened gravitational acceleration\n    to the vertically-averaged 3D acceleration at a distance equal to the disk\n    scale height H. This leads to a dimensionless softening length b = epsilon/H\n    which is a universal constant for this matching prescription. The code first\n    calculates this constant and then applies it to the given test cases.\n    \"\"\"\n\n    # Step 1: Numerically evaluate the dimensionless integral I.\n    # The integral is I = integral from -inf to inf of [e^(-u^2/2) / (1 + u^2)^(3/2)] du.\n    # As the integrand is an even function, we compute twice the integral from 0 to inf.\n    \n    def integrand(u: float) - float:\n        \"\"\"The integrand for the dimensionless integral I.\"\"\"\n        return np.exp(-u**2 / 2.0) / (1.0 + u**2)**1.5\n\n    # scipy.integrate.quad returns a tuple (result, absolute_error_estimate).\n    # We only need the result.\n    integral_I, _ = integrate.quad(lambda u: 2.0 * integrand(u), 0, np.inf)\n\n    # Step 2: Compute the constant dimensionless softening length b = epsilon / H.\n    # The analytical derivation yields the formula: b = sqrt((sqrt(2*pi)/I)^(2/3) - 1).\n    sqrt_2pi = np.sqrt(2.0 * np.pi)\n    \n    # The condition integral_I  sqrt_2pi ensures the argument of the square root is positive.\n    # This is physically and mathematically guaranteed as explained in the solution.\n    b_squared = (sqrt_2pi / integral_I)**(2.0 / 3.0) - 1.0\n    b_constant = np.sqrt(b_squared)\n\n    # Step 3: Define the test cases from the problem statement.\n    # Each case is a tuple (orbital_radius r_p, aspect_ratio h = H/r_p).\n    # While r_p is given, the required output epsilon/r_p only depends on h.\n    test_cases = [\n        (1.0, 0.05),   # Test 1: typical case\n        (1.0, 0.03),   # Test 2: cooler, thinner disk\n        (1.0, 0.10),   # Test 3: warmer, thicker disk\n        (1.0, 0.015),  # Test 4: boundary, very thin disk\n        (1.0, 0.12),   # Test 5: boundary, relatively thick disk\n    ]\n\n    results = []\n    # Step 4: For each test case, calculate the required value epsilon / r_p.\n    # From the definitions, we have epsilon/r_p = b * (H/r_p) = b * h.\n    for r_p, h in test_cases:\n        epsilon_over_rp = b_constant * h\n        results.append(epsilon_over_rp)\n\n    # Final print statement in the exact required format.\n    # The results must be rounded to six decimal places.\n    # The f-string format specifier '{value:.6f}' handles standard rounding.\n    print(f\"[{','.join(f'{res:.6f}' for res in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "行星迁移的速率由原行星盘施加在其上的引力矩决定，而这个力矩主要通过行星激发的螺旋密度波来传递。这些波在传播过程中会演化成激波，并在激波处耗散角动量。因此，准确计算迁移力矩的关键在于数值模拟能否精确地捕捉这些激波结构。本练习将引导你建立一个理论模型，用以量化因数值分辨率不足导致的激波弥散所引入的力矩计算误差，从而深刻理解数值精度如何直接影响对行星迁移速率的物理预测。",
            "id": "4158850",
            "problem": "一颗质量为 $M_p$ 的行星嵌入在一个二维、局域等温的原行星盘中，其半径为 $r_p$，盘的表面密度为 $\\Sigma(r)$，声速为 $c_s(r)$。该行星激发出紧密缠卷的螺旋密度波，这些波以近似为 $c_s$ 的群速度传播。盘的标高为 $H \\equiv c_s/\\Omega$，其中 $\\Omega$ 是局域角频率。控制流体的方程是平面内的质量守恒和动量守恒：\n$$\n\\frac{\\partial \\Sigma}{\\partial t} + \\nabla \\cdot (\\Sigma \\mathbf{v}) = 0, \n\\qquad\n\\frac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v}\\cdot\\nabla)\\mathbf{v} = -\\frac{1}{\\Sigma}\\nabla P - \\nabla \\Phi,\n$$\n其中 $P$ 是压强，$\\Phi$ 是恒星和行星的引力势。随着被激发的压缩波变陡，它们形成激波，激波会耗散波的能量和角动量，从而调节盘与行星之间的力矩交换。为了实现正确的朗金-雨贡纽跳跃条件，并防止非物理的色散振荡和激波的人为展宽，需要使用精确的高分辨率激波捕捉 (HRSC) 格式，因为这两种效应都会给螺旋尾迹的振幅和相位带来偏差，从而影响力矩。\n\n考虑一个数值模型，该模型对螺旋激波的分辨率不足，导致不连续性被弥散在一个宽度为 $\\ell_{\\mathrm{num}}$ 的区域上，该区域跨越了 $m$ 个大小为 $\\Delta x$ 的网格单元，即 $\\ell_{\\mathrm{num}} = m\\,\\Delta x$。通过将激波层视为一个有效数值粘性造成的扩散区域来模拟这种弥散对波的影响，该数值粘性的作用是在宽度 $\\ell_{\\mathrm{num}}$ 上平滑密度扰动。假设尾迹由径向波数为 $k \\sim 1/H$ 的模式主导，并且在低质量（I型）区域，净林德布拉德力矩与激发尾迹的振幅成线性关系。仅使用上述流体守恒定律，以及一个事实，即对一个波数为 $k$ 的傅里叶模式在距离 $\\ell_{\\mathrm{num}}$ 上的扩散平滑会使其振幅衰减，效果如同与一个宽度与 $\\ell_{\\mathrm{num}}$ 相当的高斯核进行卷积，请推导由激波分辨率不足引起的分数力矩误差 $\\epsilon_T$ 的主导阶标度关系。\n\n然后，对于一个 $H/r_p = 0.05$ 的盘，网格间距 $\\Delta x = H/20$，以及一个跨越 $m = 6$ 个单元的弥散激波，计算 $\\epsilon_T$ 的值。取 $k = 1/H$ 和 $\\ell_{\\mathrm{num}} = m\\,\\Delta x$。\n\n在这些假设下，哪个选项最能代表分数力矩误差，并包含其数值？\n\nA. $\\epsilon_T \\approx 1 - \\exp\\!\\left(-\\tfrac{1}{2}(k\\,\\ell_{\\mathrm{num}})^2\\right) \\approx 0.044$\n\nB. $\\epsilon_T \\approx \\ell_{\\mathrm{num}}/H \\approx 0.30$\n\nC. $\\epsilon_T \\approx (k\\,\\ell_{\\mathrm{num}})^2 \\approx 0.09$\n\nD. $\\epsilon_T \\approx 1 - \\exp\\!\\left(-(k\\,\\ell_{\\mathrm{num}})\\right) \\approx 0.26$",
            "solution": "用户提供了一个关于计算行星迁移力矩中数值误差的问题陈述，在尝试求解之前必须对其进行验证。\n\n### 问题验证\n\n**第一步：提取已知条件**\n- 质量为 $M_p$ 的行星位于一个二维、局域等温原行星盘的半径 $r_p$ 处。\n- 盘的性质：表面密度 $\\Sigma(r)$、声速 $c_s(r)$ 以及标高 $H \\equiv c_s/\\Omega$，其中 $\\Omega$ 是局域角频率。\n- 控制方程是二维流体质量和动量守恒方程：\n  $$ \\frac{\\partial \\Sigma}{\\partial t} + \\nabla \\cdot (\\Sigma \\mathbf{v}) = 0, \\qquad \\frac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v}\\cdot\\nabla)\\mathbf{v} = -\\frac{1}{\\Sigma}\\nabla P - \\nabla \\Phi $$\n- 一个数值模型对螺旋激波的分辨率不足，将不连续性弥散在宽度 $\\ell_{\\mathrm{num}} = m\\,\\Delta x$ 上，其中 $m$ 是网格单元数，$\\Delta x$ 是单元尺寸。\n- 该弥散被建模为一个扩散过程。\n- 波的尾迹由径向波数为 $k \\sim 1/H$ 的模式主导。\n- 在低质量（I型）区域，净林德布拉德力矩 $\\mathcal{T}$ 与激发尾迹的振幅 $A$ 成线性关系。（$\\mathcal{T} \\propto A$）\n- 对波数为 $k$ 的傅里叶模式在距离 $\\ell_{\\mathrm{num}}$ 上的扩散平滑会使其振幅衰减，效果如同与一个宽度与 $\\ell_{\\mathrm{num}}$ 相当的高斯核进行卷积。\n- 任务是推导分数力矩误差 $\\epsilon_T$，并使用特定参数 $H/r_p = 0.05$, $\\Delta x = H/20$, $m = 6$, $k = 1/H$, 和 $\\ell_{\\mathrm{num}} = m\\,\\Delta x$ 对其进行求值。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于行星-盘相互作用的既定理论，这是天体物理学和行星科学的核心课题。螺旋密度波、林德布拉德力矩、I型迁移以及激波捕捉的数值挑战等概念都是标准的，并且描述准确。控制方程是无粘性气体盘的正确欧拉方程。将数值扩散视为激波弥散的模型是计算流体动力学中一个有效且常见的概念。\n- **适定性：** 该问题提供了一个清晰且自洽的物理模型（线性的力矩-振幅标度关系，高斯平滑用于数值误差）和一组特定参数。这种结构允许推导出唯一且有意义的解。问题是明确的。\n- **客观性：** 语言技术性强，精确，并且不含任何主观或非科学内容。\n\n该问题陈述没有违反任何无效性标准。它在科学上是合理的、适定的、客观的，并提出了一个在计算天体物理学中非平凡但可解的问题。\n\n**第三步：结论与行动**\n问题陈述是 **有效的**。现在开始推导解答。\n\n### 解答推导\n\n分数力矩误差 $\\epsilon_T$ 定义为精确力矩 $\\mathcal{T}_{\\text{exact}}$ 与数值计算力矩 $\\mathcal{T}_{\\text{num}}$ 之差，再用精确力矩归一化：\n$$ \\epsilon_T = \\frac{\\mathcal{T}_{\\text{exact}} - \\mathcal{T}_{\\text{num}}}{\\mathcal{T}_{\\text{exact}}} $$\n问题陈述指出，在I型区域，力矩与螺旋尾迹的振幅 $A$ 成线性比例关系。我们可以写成 $\\mathcal{T} = C \\cdot A$，其中 $C$ 是一个比例常数。\n因此，$\\mathcal{T}_{\\text{exact}} = C \\cdot A_{\\text{exact}}$ 且 $\\mathcal{T}_{\\text{num}} = C \\cdot A_{\\text{num}}$。将这些代入 $\\epsilon_T$ 的表达式，得到：\n$$ \\epsilon_T = \\frac{C \\cdot A_{\\text{exact}} - C \\cdot A_{\\text{num}}}{C \\cdot A_{\\text{exact}}} = 1 - \\frac{A_{\\text{num}}}{A_{\\text{exact}}} $$\n问题将激波的数值弥散建模为真实波形 $f(x)$ 与高斯核 $g(x)$ 的卷积。设波的主导傅里叶模式的波数为 $k$。这种卷积对该模式振幅的影响可以在傅里叶空间中分析。根据卷积定理，数值弥散后的波形 $\\hat{f}_{\\text{num}}(k)$ 的傅里叶变换是真实波形和高斯核各自傅里叶变换的乘积：\n$$ \\hat{f}_{\\text{num}}(k) = \\hat{f}(k) \\cdot \\hat{g}(k) $$\n一个归一化的高斯核由 $g(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right)$ 给出，其中 $\\sigma$ 是标准差。其傅里叶变换为 $\\hat{g}(k) = \\exp\\left(-\\frac{k^2\\sigma^2}{2}\\right)$。问题陈述高斯核的“宽度与 $\\ell_{\\mathrm{num}}$ 相当”。最直接和标准的解释是，将核的标准差设为弥散宽度，因此我们假设 $\\sigma = \\ell_{\\mathrm{num}}$。\n\n因此，数值波的振幅 $A_{\\text{num}}$（对应于傅里叶分量 $\\hat{f}_{\\text{num}}(k)$ 的大小）相对于精确振幅 $A_{\\text{exact}}$ 被因子 $\\hat{g}(k)$ 衰减：\n$$ \\frac{A_{\\text{num}}}{A_{\\text{exact}}} = |\\hat{g}(k)| = \\exp\\left(-\\frac{k^2 \\ell_{\\mathrm{num}}^2}{2}\\right) $$\n将此比率代回分数力矩误差的表达式中，我们得到标度关系：\n$$ \\epsilon_T = 1 - \\exp\\left(-\\frac{1}{2}(k\\,\\ell_{\\mathrm{num}})^2\\right) $$\n现在，我们使用给定的数值来评估这个表达式：\n- 波数：$k = 1/H$\n- 用于弥散的网格单元数：$m = 6$\n- 网格单元尺寸：$\\Delta x = H/20$\n- 数值弥散宽度：$\\ell_{\\mathrm{num}} = m\\,\\Delta x = 6 \\cdot (H/20) = 0.3\\,H$\n\n我们首先计算无量纲乘积 $k\\,\\ell_{\\mathrm{num}}$：\n$$ k\\,\\ell_{\\mathrm{num}} = \\left(\\frac{1}{H}\\right) \\cdot (0.3\\,H) = 0.3 $$\n现在，我们将这个值代入 $\\epsilon_T$ 的公式中：\n$$ \\epsilon_T = 1 - \\exp\\left(-\\frac{1}{2}(0.3)^2\\right) = 1 - \\exp\\left(-\\frac{1}{2}(0.09)\\right) = 1 - \\exp(-0.045) $$\n使用计算器，$\\exp(-0.045) \\approx 0.955997$。\n$$ \\epsilon_T \\approx 1 - 0.955997 = 0.044003 \\approx 0.044 $$\n\n### 选项评估\n\n**A. $\\epsilon_T \\approx 1 - \\exp\\!\\left(-\\tfrac{1}{2}(k\\,\\ell_{\\mathrm{num}})^2\\right) \\approx 0.044$**\n此选项提供了一个函数形式和一个数值。\n- 函数形式 $\\epsilon_T = 1 - \\exp\\left(-\\tfrac{1}{2}(k\\,\\ell_{\\mathrm{num}})^2\\right)$ 正是我们基于问题中的高斯平滑模型从第一性原理推导出来的。\n- 基于给定参数 $k\\,\\ell_{\\mathrm{num}} = 0.3$ 的数值计算得出 $\\epsilon_T \\approx 0.044$。\n- 该选项与我们的推导完全一致。\n**结论：正确**\n\n**B. $\\epsilon_T \\approx \\ell_{\\mathrm{num}}/H \\approx 0.30$**\n此选项提出了误差与归一化弥散长度的线性标度关系。\n- 根据给定的参数，$\\ell_{\\mathrm{num}}/H = (0.3\\,H)/H = 0.3$，因此数值与公式一致。\n- 然而，函数形式是错误的。高斯平滑模型导致的主导阶误差标度关系为 $\\epsilon_T \\approx \\frac{1}{2}(k\\ell_{\\mathrm{num}})^2$（对于小的 $k\\ell_{\\mathrm{num}}$），这是二次方关系，而非线性关系。此选项代表了一个物理上不同且没有依据的误差模型。\n**结论：不正确**\n\n**C. $\\epsilon_T \\approx (k\\,\\ell_{\\mathrm{num}})^2 \\approx 0.09$**\n此选项提出了二次方标度关系。\n- 数值与公式一致：$(k\\,\\ell_{\\mathrm{num}})^2 = (0.3)^2 = 0.09$。\n- 对于小的 $k\\ell_{\\mathrm{num}}$，二次方标度关系是正确的主导阶行为，因为我们推导结果的泰勒展开是 $\\epsilon_T = 1 - \\left(1 - \\frac{1}{2}(k\\ell_{\\mathrm{num}})^2 + \\dots\\right) \\approx \\frac{1}{2}(k\\ell_{\\mathrm{num}})^2$。\n- 然而，此选项缺少了因子 $1/2$。正确的主导阶近似值为 $\\epsilon_T \\approx \\frac{1}{2}(0.3)^2 = 0.045$，这与完整结果 $0.044$ 非常接近。此选项的值 $0.09$ 大约有2倍的偏差。\n**结论：不正确**\n\n**D. $\\epsilon_T \\approx 1 - \\exp\\!\\left(-(k\\,\\ell_{\\mathrm{num}})\\right) \\approx 0.26$**\n此选项建议了一种与 $k\\,\\ell_{\\mathrm{num}}$ 的一次方成指数的标度关系。\n- 数值与公式一致：$1 - \\exp(-0.3) \\approx 1 - 0.7408 = 0.2592 \\approx 0.26$。\n- 这种振幅衰减的函数形式 $\\exp(-|k|\\ell_{\\mathrm{num}})$ 是与洛伦兹（柯西）核卷积的结果，而不是问题陈述中指定的高斯核。这是一个根本上不同的平滑模型。\n**结论：不正确**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}