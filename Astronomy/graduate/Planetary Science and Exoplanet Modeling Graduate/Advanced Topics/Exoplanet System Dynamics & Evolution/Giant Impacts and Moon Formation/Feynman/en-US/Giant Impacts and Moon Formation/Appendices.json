{
    "hands_on_practices": [
        {
            "introduction": "The energy of a giant impact is the primary driver of its geological and chemical consequences, from melting and vaporization to the creation of a debris disk. This exercise grounds our understanding in the fundamental principle of energy conservation, one of the most powerful tools in physics. By deriving the impact speed from first principles for a zero-energy (parabolic) encounter, you will establish a crucial baseline velocity that serves as a lower limit for such collisions. This calculation is the first step in quantifying the immense energy released during a moon-forming event and highlights how the key physical parameters of the colliding bodies, their masses ($m_1, m_2$) and radii ($R_1, R_2$), govern the initial dynamics.",
            "id": "4161853",
            "problem": "Consider two self-gravitating, approximately spherical planetary bodies of masses $m_{1}$ and $m_{2}$ and physical radii $R_{1}$ and $R_{2}$ that approach each other on a nearly radial, near-parabolic trajectory prior to a giant impact. Assume the following foundational principles and conditions hold until first contact: (i) Newton's law of universal gravitation, (ii) conservation of total mechanical energy for the isolated two-body system, (iii) the shell theorem implying that the external gravitational field of each spherical body is equivalent to that of a point mass located at its center as long as the separation exceeds the sum of the radii, (iv) negligible dissipative effects (no significant aerodynamic drag, tidal dissipation, or radiative losses) prior to contact, and (v) negligible external perturbations from a third body (for example, a host star), so that a two-body description is valid.\n\nStarting only from these principles, derive a closed-form expression for the relative speed at first contact, $v_{c}$, expressed in terms of $G$, $m_{1}$, $m_{2}$, $R_{1}$, and $R_{2}$, under the near-parabolic approach condition. Treat the relative separation at first contact as $r = R_{1} + R_{2}$ and define near-parabolic as total two-body mechanical energy being approximately zero prior to contact. Provide the expression for $v_{c}$ and explain, based on your derivation, the assumptions and limits under which this expression is applicable in the context of giant impacts and moon formation.\n\nExpress your final derived result symbolically; no numerical evaluation is required.",
            "solution": "The problem statement is found to be valid as it is scientifically grounded in the principles of classical mechanics, is well-posed with a complete and consistent setup, and is directly relevant to the specified field of planetary science.\n\nWe begin by applying the principle of conservation of total mechanical energy to the isolated two-body system, as stipulated by the problem's conditions. The total mechanical energy, $E_{\\text{total}}$, of the system is the sum of its total kinetic energy, $K$, and its gravitational potential energy, $U$.\n$$E_{\\text{total}} = K + U$$\nAccording to condition (ii), this total energy is conserved throughout the approach, up until the moment of first contact.\n\nThe gravitational potential energy, $U$, for two spherical masses $m_{1}$ and $m_{2}$ separated by a distance $r$ between their centers is given by Newton's law of universal gravitation (principle i) and simplified by the shell theorem (principle iii):\n$$U(r) = - \\frac{G m_{1} m_{2}}{r}$$\nwhere $G$ is the gravitational constant.\n\nThe total kinetic energy of the system can be most conveniently expressed in terms of the relative motion. In an inertial frame, such as the center-of-mass frame (valid for an isolated system, per condition v), the total kinetic energy is equivalent to the kinetic energy of the relative motion. This is given by:\n$$K = \\frac{1}{2} \\mu v_{\\text{rel}}^{2}$$\nwhere $v_{\\text{rel}}$ is the relative speed between the two bodies and $\\mu$ is the reduced mass of the system, defined as:\n$$\\mu = \\frac{m_{1} m_{2}}{m_{1} + m_{2}}$$\nTherefore, the total mechanical energy of the system at any point in time before contact is:\n$$E_{\\text{total}} = \\frac{1}{2} \\mu v_{\\text{rel}}^{2} - \\frac{G m_{1} m_{2}}{r}$$\n\nThe problem specifies that the bodies approach on a \"near-parabolic\" trajectory, which is explicitly defined as the total two-body mechanical energy being approximately zero, i.e., $E_{\\text{total}} \\approx 0$. For the purpose of this derivation, we will take this to mean $E_{\\text{total}} = 0$. This condition corresponds to the bodies having zero relative velocity at an infinite initial separation.\n\nWe apply the conservation of energy by equating the energy at infinite separation (which is $0$) to the energy at the moment of first contact. At first contact, the distance between the centers of the two bodies is the sum of their physical radii, $r = R_{1} + R_{2}$. The relative speed at this moment is the contact velocity, $v_{c}$. Substituting these values into the energy equation, we have:\n$$E_{\\text{total}} = \\frac{1}{2} \\mu v_{c}^{2} - \\frac{G m_{1} m_{2}}{R_{1} + R_{2}} = 0$$\nWe can now rearrange this equation to solve for $v_{c}^{2}$:\n$$\\frac{1}{2} \\mu v_{c}^{2} = \\frac{G m_{1} m_{2}}{R_{1} + R_{2}}$$\nNext, we substitute the definition of the reduced mass, $\\mu = \\frac{m_{1} m_{2}}{m_{1} + m_{2}}$:\n$$\\frac{1}{2} \\left( \\frac{m_{1} m_{2}}{m_{1} + m_{2}} \\right) v_{c}^{2} = \\frac{G m_{1} m_{2}}{R_{1} + R_{2}}$$\nAssuming non-zero masses, we can cancel the term $m_{1} m_{2}$ from both sides of the equation:\n$$\\frac{1}{2} \\left( \\frac{1}{m_{1} + m_{2}} \\right) v_{c}^{2} = \\frac{G}{R_{1} + R_{2}}$$\nSolving for $v_{c}^{2}$ yields:\n$$v_{c}^{2} = 2G \\frac{m_{1} + m_{2}}{R_{1} + R_{2}}$$\nFinally, taking the square root gives the closed-form expression for the relative speed at first contact:\n$$v_{c} = \\sqrt{2G \\frac{m_{1} + m_{2}}{R_{1} + R_{2}}}$$\nThis result is equivalent to the escape velocity from a combined mass $M = m_{1} + m_{2}$ at a distance $r = R_{1} + R_{2}$. This is a direct consequence of the parabolic trajectory assumption, where the kinetic energy at any point must exactly balance the gravitational potential energy, resulting in zero total energy.\n\nThe assumptions and limits under which this expression is applicable are as follows:\n1.  **Parabolic Encounter ($E_{\\text{total}} = 0$)**: This assumes the two bodies have zero relative velocity at infinite separation. This condition establishes a lower bound on the impact speed. Any pre-existing relative velocity at infinity (a hyperbolic encounter, $E_{\\text{total}} > 0$) would add to the final kinetic energy, resulting in a higher impact speed. The derived $v_{c}$ is often referred to as the \"mutual escape velocity\" at contact.\n2.  **Perfectly Spherical, Rigid Bodies**: The use of the $1/r$ potential via the shell theorem assumes the bodies are perfect spheres whose mass distributions are spherically symmetric. It also implicitly assumes they are rigid and do not deform under mutual tidal forces during approach. In reality, tidal deformation would occur, storing some energy and slightly modifying the potential from the simple inverse-square law, thus altering the final velocity.\n3.  **No Pre-Impact Dissipation**: The derivation assumes conservation of mechanical energy (condition iv). It neglects energy loss from effects like tidal flexing (which generates heat), atmospheric drag (if atmospheres are present), or any other dissipative process prior to physical contact. Such effects would reduce the kinetic energy and thus lower the impact speed compared to this idealized value.\n4.  **Isolated Two-Body System**: The model (condition v) ignores gravitational perturbations from other bodies, such as a host star. For impacts in a star system, the three-body problem (impactor, target, star) is more accurate. The two-body approximation is valid when the encounter is rapid and occurs over a distance much smaller than the bodies' orbital radii around the star.\n5.  **Impact Parameter**: The derived expression is for the magnitude of the relative velocity vector at contact. It holds true for any impact parameter (the perpendicular distance between the initial velocity vectors) that results in a collision, from a direct head-on impact to a grazing one. The direction of the velocity vector at contact, however, will depend on the impact parameter, which is a critical factor in determining the angular momentum of the resulting debris and the potential for forming a moon.",
            "answer": "$$\\boxed{\\sqrt{2G \\frac{m_{1} + m_{2}}{R_{1} + R_{2}}}}$$"
        },
        {
            "introduction": "For a stable moon to form from a post-impact debris disk, the material must not only enter orbit but must do so beyond a critical distance where the planet's tidal forces would otherwise prevent it from gravitationally coalescing. This practice connects two foundational concepts in moon formation: the specific angular momentum ($l$) delivered by the impactor and the Roche limit ($R_{L}$), which defines this minimum radius for accretion. By comparing the characteristic specific angular momentum of a canonical grazing impact to the minimum required for a stable orbit outside the Roche limit, you will quantitatively assess a key viability constraint of the giant impact hypothesis. This exercise demonstrates how fundamental principles of orbital mechanics provide a powerful, first-order test for theories of planetary system formation.",
            "id": "4161836",
            "problem": "A proto-Earth of mass $M = 5.972 \\times 10^{24}$ and radius $R_{p} = 6.371 \\times 10^{6}$, both in International System of Units (SI), is struck by a differentiated silicate impactor, producing a debris disk. Assume the debris is effectively strengthless and behaves as a fluid aggregate once in orbit. The fluid Roche limit (RL) for a strengthless rubble-pile of bulk density $\\rho_{s}$ orbiting a planet of mean density $\\rho_{p}$ is defined as the orbital distance inside of which tidal forces prevent gravitationally bound aggregation. Take $\\rho_{p} = 5510$ and $\\rho_{s} = 3300$, in kilograms per cubic meter.\n\nUsing only fundamental orbital mechanics and the well-tested fluid Roche limit relation appropriate for this context, do the following:\n\n1. Starting from Newtonian gravity and the condition for circular motion, determine the minimum specific angular momentum $l_{\\min}$ required for a test particle to maintain a stable circular orbit just outside the fluid Roche limit $R_{L}$ of the proto-Earth.\n\n2. For a canonical giant-impact scenario, assume a near-parabolic approach (asymptotic speed $v_{\\infty} \\approx 0$) and a grazing pericenter $r_{p} \\approx R_{p}$. Starting from conservation of energy and angular momentum for a parabolic orbit in a Newtonian gravitational field, determine the characteristic specific angular momentum per unit mass $l_{\\mathrm{can}}$ imparted to material at pericenter under these conditions.\n\n3. Compute the ratio $l_{\\min}/l_{\\mathrm{can}}$ numerically, using the fluid Roche limit appropriate for a strengthless rubble-pile of density $\\rho_{s}$ orbiting a planet of density $\\rho_{p}$, and the proto-Earth parameters given above. Express your final comparison as a single dimensionless number rounded to four significant figures.",
            "solution": "The problem statement is evaluated to be scientifically sound, well-posed, objective, and self-contained. The provided data are consistent and physically realistic within the context of planetary science. The problem is a valid exercise in orbital mechanics and its application to moon formation theories. Therefore, a reasoned solution is provided below.\n\nThe solution is structured in three parts as requested by the problem statement.\n\nFirst, we determine the minimum specific angular momentum, $l_{\\min}$, required for a test particle to maintain a stable circular orbit just outside the fluid Roche limit of the proto-Earth. The condition for a stable circular orbit of a test particle of mass $m$ at a distance $r$ from a central body of mass $M$ is that the gravitational force provides the necessary centripetal force. From Newton's law of universal gravitation, we have:\n$$\n\\frac{G M m}{r^2} = \\frac{m v^2}{r}\n$$\nwhere $G$ is the gravitational constant and $v$ is the orbital velocity. Solving for $v$ yields:\n$$\nv = \\sqrt{\\frac{G M}{r}}\n$$\nThe specific angular momentum, $l$, is the angular momentum per unit mass. For a circular orbit, the position vector $\\vec{r}$ and velocity vector $\\vec{v}$ are orthogonal, so the magnitude of the specific angular momentum is $l = |\\vec{r} \\times \\vec{v}| = r v$. Substituting the expression for $v$:\n$$\nl = r \\sqrt{\\frac{G M}{r}} = \\sqrt{G M r}\n$$\nThe problem states that tidal forces disrupt aggregation inside the Roche limit, $R_{L}$. Therefore, the minimum orbital radius for a stable, self-gravitating body to exist is $r = R_{L}$. The specific angular momentum corresponding to this orbit is the minimum required for material to potentially accrete into a moon, $l_{\\min}$.\n$$\nl_{\\min} = \\sqrt{G M R_{L}}\n$$\nThe problem specifies a fluid, strengthless rubble-pile satellite orbiting a planet. The well-tested fluid Roche limit relation for this scenario is given by:\n$$\nR_{L} \\approx C R_{p} \\left(\\frac{\\rho_{p}}{\\rho_{s}}\\right)^{1/3}\n$$\nwhere $R_{p}$ is the radius of the primary body (the proto-Earth), $\\rho_{p}$ is the mean density of the primary, $\\rho_{s}$ is the bulk density of the satellite material, and $C$ is a constant approximately equal to $2.44$. Substituting this expression for $R_{L}$ into our equation for $l_{\\min}$:\n$$\nl_{\\min} = \\sqrt{G M \\left( 2.44 R_{p} \\left(\\frac{\\rho_{p}}{\\rho_{s}}\\right)^{1/3} \\right)}\n$$\n\nSecond, we determine the characteristic specific angular momentum, $l_{\\mathrm{can}}$, for material in a canonical giant-impact scenario. This scenario is characterized by a near-parabolic approach ($v_{\\infty} \\approx 0$) and a grazing pericenter ($r_{p} \\approx R_{p}$).\nFor an orbit under a central gravitational force, both energy and angular momentum are conserved. The specific orbital energy $\\mathcal{E}$ is given by:\n$$\n\\mathcal{E} = \\frac{1}{2} v^2 - \\frac{G M}{r}\n$$\nA parabolic trajectory is defined by having a total specific energy of zero, $\\mathcal{E}=0$. This is consistent with the condition that the asymptotic speed $v_{\\infty}$ is zero. At pericenter, the closest point of approach, the velocity $v_{p}$ and position vector of magnitude $r_{p}$ are perpendicular. The specific angular momentum is thus $l_{\\mathrm{can}} = r_{p} v_{p}$.\nUsing the conservation of energy at pericenter for a parabolic orbit:\n$$\n\\mathcal{E} = \\frac{1}{2} v_{p}^2 - \\frac{G M}{r_{p}} = 0\n$$\nSolving for the pericenter velocity $v_{p}$:\n$$\nv_{p} = \\sqrt{\\frac{2 G M}{r_{p}}}\n$$\nNow, we can find the specific angular momentum at pericenter:\n$$\nl_{\\mathrm{can}} = r_{p} v_{p} = r_{p} \\sqrt{\\frac{2 G M}{r_{p}}} = \\sqrt{2 G M r_{p}}\n$$\nUsing the given assumption of a grazing impact, we set the pericenter distance equal to the planet's radius, $r_{p} \\approx R_{p}$. This yields the expression for the canonical specific angular momentum:\n$$\nl_{\\mathrm{can}} = \\sqrt{2 G M R_{p}}\n$$\n\nThird, we compute the ratio $l_{\\min}/l_{\\mathrm{can}}$. Using the expressions derived above:\n$$\n\\frac{l_{\\min}}{l_{\\mathrm{can}}} = \\frac{\\sqrt{G M \\left( 2.44 R_{p} \\left(\\frac{\\rho_{p}}{\\rho_{s}}\\right)^{1/3} \\right)}}{\\sqrt{2 G M R_{p}}}\n$$\nWe can simplify this expression by canceling the common terms $\\sqrt{G M R_{p}}$:\n$$\n\\frac{l_{\\min}}{l_{\\mathrm{can}}} = \\sqrt{\\frac{2.44 \\left(\\frac{\\rho_{p}}{\\rho_{s}}\\right)^{1/3}}{2}} = \\sqrt{1.22 \\left(\\frac{\\rho_{p}}{\\rho_{s}}\\right)^{1/3}}\n$$\nThis final expression depends only on the densities of the planet and the satellite material and the constant factor from the Roche limit formula. We now substitute the given numerical values: $\\rho_{p} = 5510 \\, \\text{kg/m}^3$ and $\\rho_{s} = 3300 \\, \\text{kg/m}^3$.\n$$\n\\frac{\\rho_{p}}{\\rho_{s}} = \\frac{5510}{3300} \\approx 1.669697\n$$\nNow we compute the ratio:\n$$\n\\frac{l_{\\min}}{l_{\\mathrm{can}}} = \\sqrt{1.22 \\left( \\frac{5510}{3300} \\right)^{1/3}} \\approx \\sqrt{1.22 \\times (1.669697)^{1/3}}\n$$\n$$\n\\frac{l_{\\min}}{l_{\\mathrm{can}}} \\approx \\sqrt{1.22 \\times 1.186350} \\approx \\sqrt{1.447347} \\approx 1.203057\n$$\nThe problem requires the result to be rounded to four significant figures.\n$$\n\\frac{l_{\\min}}{l_{\\mathrm{can}}} \\approx 1.203\n$$\nThe fact that this ratio is greater than $1$ signifies that a canonical grazing impact imparts sufficient angular momentum to place ejecta into an orbit beyond the Roche limit, which is a necessary condition for that material to coalesce and form a moon.",
            "answer": "$$\n\\boxed{1.203}\n$$"
        },
        {
            "introduction": "The current orbit of the Moon is not its initial orbit; billions of years of tidal evolution, driven by the exchange of angular momentum with the Earth, have profoundly altered its path and inclination. To test and constrain giant impact scenarios, we must be able to work backward from present-day observables to infer the initial post-impact conditions. This hands-on computational problem guides you through building a model that reverses the effects of this long-term tidal evolution, integrating continuous processes like inclination damping with discrete, abrupt changes from orbital resonances. This exercise illustrates a core methodology in modern planetary science: using numerical modeling to connect a theoretical event in the distant past to concrete, present-day astronomical data, thereby placing tangible constraints on the initial geometry of the Moon-forming impact.",
            "id": "4161844",
            "problem": "You are tasked with constructing a simplified, yet physically grounded, back-propagation model for the inclination of a satellite formed by a giant impact, specifically the Moon, in order to infer constraints on its initial orbital inclination and, by extension, the impact geometry. The model should couple outward tidal evolution of the semimajor axis with parametric inclination damping and account for discrete resonance and plane-transition effects. Implement the following:\n\n1. Base the outward tidal evolution on the MacDonald constant time lag model simplified to a power-law calibrated at the present epoch. Let the semimajor axis be $a$, and model its time evolution by\n$$\n\\frac{da}{dt} = K\\,a^{-11/2},\n$$\nwhere $K$ is a constant chosen such that the present-day rate $\\left.\\frac{da}{dt}\\right|_{a=a_{\\mathrm{now}}}$ equals a specified measured value. This scaling reflects that the tidal torque on the primary due to the satellite roughly scales as $a^{-6}$, the orbital mean motion scales as $a^{-3/2}$, and hence the outward rate scales as $a^{-11/2}$. Calibrate $K$ via\n$$\nK = \\left.\\frac{da}{dt}\\right|_{\\mathrm{now}}\\,a_{\\mathrm{now}}^{11/2}.\n$$\n\n2. Model inclination damping as an exponential relaxation governed by a semimajor-axis-dependent timescale $\\tau_i(a)$:\n$$\n\\frac{di}{dt} = -\\frac{i}{\\tau_i(a)},\\quad \\tau_i(a) = T_0\\left(\\frac{a}{a_{\\mathrm{now}}}\\right)^{\\gamma},\n$$\nwhere $T_0$ and $\\gamma$ are parameters. This encodes the expectation that tidal coupling strengths are strong at small $a$ and diminish as $a$ increases, while allowing flexibility in the power-law index $\\gamma$.\n\n3. Back-propagate the present-day inclination $i_{\\mathrm{now}}$ at $a_{\\mathrm{now}}$ to the initial semimajor axis $a_{\\mathrm{initial}}$ by integrating the inclination damping along the outward tidal track. For a backward integration with $a$ decreasing, use the time element $dt = \\frac{da}{|\\frac{da}{dt}|}$ to keep the integral positive. The exponential factor from damping is\n$$\nE = \\int_{a_{\\mathrm{initial}}}^{a_{\\mathrm{now}}} \\frac{1}{\\tau_i(a)}\\,\\frac{1}{\\left|\\frac{da}{dt}\\right|}\\,da\n= \\frac{a_{\\mathrm{now}}^{\\gamma}}{T_0\\,K} \\int_{a_{\\mathrm{initial}}}^{a_{\\mathrm{now}}} a^{11/2 - \\gamma}\\,da.\n$$\nEvaluate the integral in closed form. If $11/2 - \\gamma \\neq -1$, then\n$$\nE = \\frac{a_{\\mathrm{now}}^{\\gamma}}{T_0\\,K}\\,\\frac{a_{\\mathrm{now}}^{13/2-\\gamma} - a_{\\mathrm{initial}}^{13/2-\\gamma}}{13/2-\\gamma}.\n$$\nIf $11/2 - \\gamma = -1$ (i.e., $\\gamma = 13/2$), then\n$$\nE = \\frac{a_{\\mathrm{now}}^{\\gamma}}{T_0\\,K}\\,\\ln\\left(\\frac{a_{\\mathrm{now}}}{a_{\\mathrm{initial}}}\\right).\n$$\n\n4. Include two discrete multiplicative effects on inclination:\n   - Evection resonance: If the outward tidal evolution crosses a specified resonance location $a_{\\mathrm{ev}}$ such that $a_{\\mathrm{initial}} < a_{\\mathrm{ev}} < a_{\\mathrm{now}}$, then the inclination is multiplied by a factor $F_{\\mathrm{ev}}$ during forward evolution (which must be divided out during back-propagation). Otherwise, apply a factor of $1$.\n   - Laplace-plane/Cassini-state transition: If the outward evolution crosses a specified Laplace radius $a_{\\mathrm{L}}$ such that $a_{\\mathrm{initial}} < a_{\\mathrm{L}} < a_{\\mathrm{now}}$, then apply a multiplicative retention factor $F_{\\mathrm{L}}$ during forward evolution (again divided out when inferring the initial condition). Otherwise, apply a factor of $1$.\n\n5. The inferred initial inclination is then\n$$\ni_{\\mathrm{initial}} = \\frac{i_{\\mathrm{now}}\\exp(E)}{F_{\\mathrm{ev}}^{\\star}\\,F_{\\mathrm{L}}^{\\star}},\n$$\nwhere $F_{\\mathrm{ev}}^{\\star} = F_{\\mathrm{ev}}$ if $a_{\\mathrm{initial}} < a_{\\mathrm{ev}} < a_{\\mathrm{now}}$ and $F_{\\mathrm{ev}}^{\\star} = 1$ otherwise, and $F_{\\mathrm{L}}^{\\star} = F_{\\mathrm{L}}$ if $a_{\\mathrm{initial}} < a_{\\mathrm{L}} < a_{\\mathrm{now}}$ and $F_{\\mathrm{L}}^{\\star} = 1$ otherwise.\n\nConstants and units:\n- Use $a_{\\mathrm{now}} = 3.844\\times 10^{8}$ meters and $R_{\\oplus} = 6.371\\times 10^{6}$ meters, where $R_{\\oplus}$ denotes the Earth's radius.\n- Use the present-day outward rate $\\left.\\frac{da}{dt}\\right|_{\\mathrm{now}}$ given per test case in meters per year, and convert to meters per second internally.\n- All lengths must be in meters, all times in seconds, and all angles in degrees.\n- Express the final inferred initial inclinations in degrees, rounded to three decimals.\n\nImplement a program that, for each test case below, computes $i_{\\mathrm{initial}}$ according to the above model.\n\nTest suite (each case is a tuple $(a_{\\mathrm{initial}}, i_{\\mathrm{now}}, (\\frac{da}{dt})_{\\mathrm{now}}, T_0, \\gamma, F_{\\mathrm{ev}}, a_{\\mathrm{ev}}, F_{\\mathrm{L}}, a_{\\mathrm{L}})$):\n- Case $1$ (happy path with resonance and Laplace transition): $(4\\,R_{\\oplus},\\,5.145,\\,3.8\\times 10^{-2},\\,1.0\\times 10^{11}\\ \\text{years},\\,6.0,\\,1.2,\\,60\\,R_{\\oplus},\\,0.85,\\,16\\,R_{\\oplus})$.\n- Case $2$ (no resonance crossing; $a_{\\mathrm{ev}}$ beyond present): $(4\\,R_{\\oplus},\\,5.145,\\,3.8\\times 10^{-2},\\,1.0\\times 10^{11}\\ \\text{years},\\,6.0,\\,1.2,\\,70\\,R_{\\oplus},\\,0.85,\\,16\\,R_{\\oplus})$.\n- Case $3$ (boundary integration index $\\gamma=13/2$): $(4\\,R_{\\oplus},\\,5.145,\\,3.8\\times 10^{-2},\\,1.0\\times 10^{11}\\ \\text{years},\\,6.5,\\,1.2,\\,60\\,R_{\\oplus},\\,0.85,\\,16\\,R_{\\oplus})$.\n- Case $4$ (no tidal evolution; checks multiplicative factors only): $(a_{\\mathrm{now}},\\,5.145,\\,3.8\\times 10^{-2},\\,1.0\\times 10^{11}\\ \\text{years},\\,6.0,\\,1.0,\\,60\\,R_{\\oplus},\\,1.0,\\,16\\,R_{\\oplus})$.\n- Case $5$ (stronger damping timescale and resonance reduces inclination): $(4\\,R_{\\oplus},\\,5.145,\\,3.8\\times 10^{-2},\\,5.0\\times 10^{10}\\ \\text{years},\\,6.0,\\,0.8,\\,60\\,R_{\\oplus},\\,0.9,\\,16\\,R_{\\oplus})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\,\\text{result}_1,\\text{result}_2,\\dots\\,\\right]$). Each $\\text{result}_k$ must be the inferred $i_{\\mathrm{initial}}$ for test case $k$ in degrees, rounded to three decimals.",
            "solution": "The problem requires the implementation of a simplified model to back-propagate the orbital inclination of a satellite, such as the Moon, from its present-day value to an initial value shortly after its formation. This model is designed to infer constraints on the formation process (e.g., a giant impact) from the satellite's current orbital state. The model incorporates continuous tidal evolution and discrete dynamical events. The solution is developed by methodically implementing the provided physical-mathematical framework.\n\nThe core of the task is to compute the initial inclination, $i_{\\mathrm{initial}}$, given the present-day inclination, $i_{\\mathrm{now}}$, and a set of model parameters. The relationship between the initial and final inclinations is given by:\n$$\ni_{\\mathrm{initial}} = \\frac{i_{\\mathrm{now}}\\exp(E)}{F_{\\mathrm{ev}}^{\\star}\\,F_{\\mathrm{L}}^{\\star}}\n$$\nThis calculation involves three main components: a constant tidal evolution rate, a continuous inclination damping factor $E$, and two discrete multiplicative factors, $F_{\\mathrm{ev}}^{\\star}$ and $F_{\\mathrm{L}}^{\\star}$.\n\nFirst, we establish the necessary physical constants and ensure all calculations are performed in a consistent system of units, which will be the SI system (meters, kilograms, seconds). The problem provides some parameters in other units (years, Earth radii), which must be converted.\n- Present-day Moon semimajor axis: $a_{\\mathrm{now}} = 3.844\\times 10^{8}$ meters.\n- Earth's mean radius: $R_{\\oplus} = 6.371\\times 10^{6}$ meters.\n- Seconds per year: $1 \\text{ year} = 365.25 \\times 24 \\times 3600 \\text{ seconds} \\approx 3.15576 \\times 10^7$ seconds.\n\nThe calculation for each test case proceeds in four steps:\n\n1.  **Calibration of the Tidal Evolution Model**\n    The model assumes the rate of change of the semimajor axis, $a$, follows a power law:\n    $$\n    \\frac{da}{dt} = K\\,a^{-11/2}\n    $$\n    The constant $K$ characterizes the strength of the tidal interaction. It is calibrated using the measured present-day rate of the Moon's orbital expansion, $\\left.\\frac{da}{dt}\\right|_{\\mathrm{now}}$, at the known present-day semimajor axis, $a_{\\mathrm{now}}$. By rearranging the equation, we solve for $K$:\n    $$\n    K = \\left.\\frac{da}{dt}\\right|_{\\mathrm{now}}\\,a_{\\mathrm{now}}^{11/2}\n    $$\n    For each test case, the value of $\\left.\\frac{da}{dt}\\right|_{\\mathrm{now}}$ is provided in meters per year and must be converted to meters per second before calculating $K$.\n\n2.  **Calculation of the Integrated Inclination Damping Factor ($E$)**\n    The inclination $i$ is assumed to damp exponentially over time due to tides, with a characteristic timescale $\\tau_i$ that depends on the semimajor axis:\n    $$\n    \\frac{di}{dt} = -\\frac{i}{\\tau_i(a)}, \\quad \\text{where} \\quad \\tau_i(a) = T_0\\left(\\frac{a}{a_{\\mathrm{now}}}\\right)^{\\gamma}\n    $$\n    Here, $T_0$ and $\\gamma$ are model parameters. To find the total damping experienced as the satellite evolves from an initial semimajor axis $a_{\\mathrm{initial}}$ to the present-day axis $a_{\\mathrm{now}}$, we must integrate the damping rate over the evolutionary path. The total exponential factor, $E$, is the time integral of $1/\\tau_i(a)$. We change the variable of integration from time $t$ to semimajor axis $a$ using $dt = \\frac{da}{|da/dt|}$.\n    $$\n    E = \\int_{t_{\\mathrm{initial}}}^{t_{\\mathrm{now}}} \\frac{1}{\\tau_i(a(t))}\\,dt = \\int_{a_{\\mathrm{initial}}}^{a_{\\mathrm{now}}} \\frac{1}{\\tau_i(a)}\\,\\frac{1}{K\\,a^{-11/2}}\\,da\n    $$\n    Substituting the expression for $\\tau_i(a)$ gives the integral specified in the problem:\n    $$\n    E = \\frac{a_{\\mathrm{now}}^{\\gamma}}{T_0\\,K} \\int_{a_{\\mathrm{initial}}}^{a_{\\mathrm{now}}} a^{11/2 - \\gamma}\\,da\n    $$\n    The evaluation of this integral depends on the value of the exponent $11/2 - \\gamma$.\n    - If $11/2 - \\gamma \\neq -1$ (i.e., $\\gamma \\neq 13/2 = 6.5$), the integral is:\n      $$\n      E = \\frac{a_{\\mathrm{now}}^{\\gamma}}{T_0\\,K}\\,\\frac{a_{\\mathrm{now}}^{13/2-\\gamma} - a_{\\mathrm{initial}}^{13/2-\\gamma}}{13/2-\\gamma}\n      $$\n    - If $11/2 - \\gamma = -1$ (i.e., $\\gamma = 13/2 = 6.5$), the integrand is $a^{-1}$, and the integral becomes a natural logarithm:\n      $$\n      E = \\frac{a_{\\mathrm{now}}^{\\gamma}}{T_0\\,K}\\,\\ln\\left(\\frac{a_{\\mathrm{now}}}{a_{\\mathrm{initial}}}\\right)\n      $$\n    In the special circumstance where $a_{\\mathrm{initial}} = a_{\\mathrm{now}}$, the integration interval is zero, so $E=0$. Both formulas correctly yield this result.\n\n3.  **Determination of Discrete Event Factors ($F_{\\mathrm{ev}}^{\\star}, F_{\\mathrm{L}}^{\\star}$)**\n    The model accounts for two discrete events that can abruptly modify the inclination during the satellite's orbital expansion. These are handled as multiplicative factors.\n    - **Evection Resonance**: If the orbit expands across a specific semimajor axis $a_{\\mathrm{ev}}$ associated with the evection resonance, the inclination is modified by a factor $F_{\\mathrm{ev}}$.\n    - **Laplace Plane/Cassini State Transition**: Similarly, crossing a critical Laplace radius $a_{\\mathrm{L}}$ modifies the inclination by a factor $F_{\\mathrm{L}}$.\n\n    When back-propagating, we must divide by these factors if the events occurred. The logic is applied via the terms $F_{\\mathrm{ev}}^{\\star}$ and $F_{\\mathrm{L}}^{\\star}$:\n    - $F_{\\mathrm{ev}}^{\\star}$ is set to $F_{\\mathrm{ev}}$ if the orbital evolution interval $[a_{\\mathrm{initial}}, a_{\\mathrm{now}}]$ contains $a_{\\mathrm{ev}}$ (i.e., $a_{\\mathrm{initial}} < a_{\\mathrm{ev}} < a_{\\mathrm{now}}$). Otherwise, $F_{\\mathrm{ev}}^{\\star} = 1$.\n    - $F_{\\mathrm{L}}^{\\star}$ is set to $F_{\\mathrm{L}}$ if the interval contains $a_{\\mathrm{L}}$ (i.e., $a_{\\mathrm{initial}} < a_{\\mathrm{L}} < a_{\\mathrm{now}}$). Otherwise, $F_{\\mathrm{L}}^{\\star} = 1$.\n\n4.  **Final Calculation of Initial Inclination**\n    Finally, all components are assembled to compute $i_{\\mathrm{initial}}$. The present-day inclination $i_{\\mathrm{now}}$ is multiplied by $\\exp(E)$ to reverse the continuous damping, and then divided by the factors $F_{\\mathrm{ev}}^{\\star}$ and $F_{\\mathrm{L}}^{\\star}$ to reverse the effects of any discrete events that were crossed. The final result for each test case is expressed in degrees and rounded to three decimal places.\n\nThis systematic procedure is implemented for each provided test case to obtain the inferred initial inclination.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the inferred initial inclination of a satellite based on a \n    simplified back-propagation model of its orbital evolution.\n    \"\"\"\n    \n    # Define physical constants and conversion factors\n    A_NOW = 3.844e8  # meters, present-day semimajor axis\n    R_EARTH = 6.371e6  # meters, Earth's radius\n    SEC_PER_YEAR = 365.25 * 24 * 3600  # seconds\n\n    # Define the test cases from the problem statement.\n    # Each tuple: (a_initial_RE, i_now_deg, dadt_now_m_yr, T0_yr, gamma, F_ev, a_ev_RE, F_L, a_L_RE)\n    test_cases = [\n        (4.0, 5.145, 3.8e-2, 1.0e11, 6.0, 1.2, 60.0, 0.85, 16.0),\n        (4.0, 5.145, 3.8e-2, 1.0e11, 6.0, 1.2, 70.0, 0.85, 16.0),\n        (4.0, 5.145, 3.8e-2, 1.0e11, 6.5, 1.2, 60.0, 0.85, 16.0),\n        (A_NOW / R_EARTH, 5.145, 3.8e-2, 1.0e11, 6.0, 1.0, 60.0, 1.0, 16.0),\n        (4.0, 5.145, 3.8e-2, 5.0e10, 6.0, 0.8, 60.0, 0.9, 16.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        a_initial_RE, i_now, dadt_now_m_yr, T0_yr, gamma, F_ev, a_ev_RE, F_L, a_L_RE = case\n\n        # --- Step 1: Unit Conversion and Parameter Setup ---\n        a_initial = a_initial_RE * R_EARTH  # meters\n        dadt_now_m_s = dadt_now_m_yr / SEC_PER_YEAR  # meters/second\n        T0_s = T0_yr * SEC_PER_YEAR  # seconds\n        a_ev = a_ev_RE * R_EARTH  # meters\n        a_L = a_L_RE * R_EARTH  # meters\n\n        # --- Step 2: Calculate Calibration Constant K ---\n        # K = (da/dt)_now * a_now^(11/2)\n        K = dadt_now_m_s * (A_NOW ** 5.5)\n\n        # --- Step 3: Calculate Exponential Damping Factor E ---\n        E = 0.0\n        # If a_initial equals a_now, E is 0 as the integration range is zero.\n        if a_initial < A_NOW:\n            if gamma == 6.5:  # Special case for gamma = 13/2\n                # E = (a_now^gamma / (T0 * K)) * ln(a_now / a_initial)\n                integral_part = np.log(A_NOW / a_initial)\n                E = (A_NOW ** gamma) / (T0_s * K) * integral_part\n            else:  # General case for gamma != 13/2\n                # E = (a_now^gamma / (T0 * K)) * (a_now^(13/2-gamma) - a_initial^(13/2-gamma)) / (13/2 - gamma)\n                exponent = 6.5 - gamma\n                integral_part = (A_NOW ** exponent - a_initial ** exponent) / exponent\n                E = (A_NOW ** gamma) / (T0_s * K) * integral_part\n\n        # --- Step 4: Determine Multiplicative Factors F_ev_star and F_L_star ---\n        F_ev_star = 1.0\n        if a_initial < a_ev < A_NOW:\n            F_ev_star = F_ev\n\n        F_L_star = 1.0\n        if a_initial < a_L < A_NOW:\n            F_L_star = F_L\n\n        # --- Step 5: Calculate Initial Inclination ---\n        # i_initial = i_now * exp(E) / (F_ev_star * F_L_star)\n        i_initial = i_now * np.exp(E) / (F_ev_star * F_L_star)\n\n        results.append(round(i_initial, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}