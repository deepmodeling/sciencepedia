{
    "hands_on_practices": [
        {
            "introduction": "To understand satellite formation, we must first characterize the environment where they form. This exercise guides you through the construction of a foundational model for a circumplanetary disk, applying the principles of mass conservation and viscous angular momentum transport to derive the steady-state surface density profile, $\\Sigma(R)$. Mastering this practice is essential as it reveals the large-scale gas distribution that acts as the primary reservoir of material for growing satellites and governs their orbital migration. ",
            "id": "4155767",
            "problem": "Design and implement a complete, runnable program that models a one-dimensional, axisymmetric, steady-state circumplanetary disk (CPD, Circumplanetary Disk) subject to mass inflow at the outer boundary, and drained by accretion onto the planet and by satellite formation distributed over a finite ring. The model must be derived from fundamental principles: mass conservation and angular momentum transport with an effective viscosity. The program must compute the surface density profile as a function of radius by applying steady-state mass balance and a standard viscous transport closure. All mathematical entities must be expressed using LaTeX.\n\nAssume the disk is geometrically thin, Keplerian, and vertically isothermal. Let $R$ denote cylindrical radius from the planet center. Let $R_{\\rm in}$ and $R_{\\rm out}$ denote the inner and outer boundaries, respectively. Let the inward mass inflow at $R_{\\rm out}$ be $\\dot{M}_{\\rm in}$ (units $\\mathrm{kg\\,s^{-1}}$). Let the satellite formation act as a distributed sink within a ring $[R_1,R_2]$ with a uniform surface sink distribution per unit area and total sink rate $\\dot{M}_s$ (units $\\mathrm{kg\\,s^{-1}}$). The accretion rate onto the planet is $\\dot{M}_p$ (units $\\mathrm{kg\\,s^{-1}}$), equal to the net inward mass flux at $R_{\\rm in}$ in steady state. The disk kinematic viscosity is modeled by an $\\alpha$-prescription with\n$$\n\\nu(R) = \\alpha \\frac{c_s^2(R)}{\\Omega_K(R)},\n$$\nwhere $\\alpha$ is dimensionless, $c_s(R)$ is the isothermal sound speed, and $\\Omega_K(R)$ is the Keplerian angular frequency. Take\n$$\nc_s(R) = \\sqrt{\\frac{k_{\\rm B}\\,T(R)}{\\mu m_{\\rm H}}}, \\quad \\Omega_K(R) = \\sqrt{\\frac{G M_{\\rm pl}}{R^3}},\n$$\nwhere $k_{\\rm B}$ is Boltzmann’s constant, $m_{\\rm H}$ is the mass of the hydrogen atom, $\\mu$ is the mean molecular weight, $G$ is the gravitational constant, and $M_{\\rm pl}$ is the planet mass. Prescribe the temperature profile as a power law\n$$\nT(R) = T_0 \\left(\\frac{R}{R_0}\\right)^{-q}.\n$$\n\nFundamental base and derivation requirements:\n- Start from the steady-state continuity equation in cylindrical symmetry, \n$$\n\\frac{1}{R}\\frac{d}{dR}\\big(R\\,\\Sigma\\,v_R\\big) = S(R),\n$$\nwhere $\\Sigma(R)$ is the surface density (units $\\mathrm{kg\\,m^{-2}}$), $v_R(R)$ is the radial velocity (negative for inward flow), and $S(R)$ is the net source term per unit area (units $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$). Define the inward mass flux as the positive quantity\n$$\n\\dot{M}(R) \\equiv -2\\pi R\\,\\Sigma(R)\\,v_R(R).\n$$\nIntegrate the continuity equation to obtain a relation for $\\dot{M}(R)$ in terms of the distributed sinks. Then, using angular momentum transport in a thin viscous disk under steady inflow and negligible external torques, derive the well-tested closure that relates the local inward mass flux to the viscosity and surface density, and use it to express $\\Sigma(R)$ in terms of $\\dot{M}(R)$ and $\\nu(R)$.\n\nImplementation requirements:\n- Model the satellite formation sink as uniform over $[R_1,R_2]$ by choosing a normalized distribution function $g(R)$ such that \n$$\n\\int_{R_1}^{R_2} 2\\pi R\\,g(R)\\,dR = 1, \\quad g(R) = \\frac{1}{\\pi\\left(R_2^2-R_1^2\\right)} \\ \\text{for}\\ R\\in[R_1,R_2], \\ \\text{and} \\ g(R)=0 \\ \\text{otherwise}.\n$$\nLet $S(R) = -\\dot{M}_s\\,g(R)$, so that the total sink equals $\\dot{M}_s$.\n- From the continuity equation, obtain\n$$\n\\frac{d\\dot{M}}{dR} = -2\\pi R\\,S(R),\n$$\nand integrate from $R$ to $R_{\\rm out}$ to obtain $\\dot{M}(R)$ in terms of $\\dot{M}_{\\rm in}$ and the distributed sink. For the uniform ring sink, this yields a piecewise expression for the fraction of the sink exterior to $R$,\n$$\nf(R) \\equiv \\int_{R}^{R_{\\rm out}} 2\\pi r\\,g(r)\\,dr =\n\\begin{cases}\n1,  R \\le R_1, \\\\[6pt]\n\\dfrac{R_2^2 - R^2}{R_2^2 - R_1^2},  R_1  R  R_2, \\\\[10pt]\n0,  R \\ge R_2\n\\end{cases}\n$$\nand\n$$\n\\dot{M}(R) = \\dot{M}_{\\rm in} - \\dot{M}_s\\,f(R).\n$$\n- Use the standard steady thin-disk angular momentum transport relation to close the system and compute the surface density profile as\n$$\n\\Sigma(R) = \\frac{\\dot{M}(R)}{3\\pi\\,\\nu(R)}.\n$$\n- Compute $\\dot{M}_p = \\dot{M}(R_{\\rm in})$ and verify steady-state mass balance $\\dot{M}_{\\rm in} = \\dot{M}_p + \\dot{M}_s$ within a specified numerical tolerance.\n\nPhysical constants to use:\n- $G = 6.6743\\times 10^{-11}\\ \\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$\n- $k_{\\rm B} = 1.380649\\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$\n- $m_{\\rm H} = 1.6735575\\times 10^{-27}\\ \\mathrm{kg}$\n- $\\mu = 2.34$\n- $R_{\\rm J} = 7.1492\\times 10^7\\ \\mathrm{m}$\n\nUnits and outputs:\n- Radii must be handled in meters. Temperatures in Kelvin. Mass rates in $\\mathrm{kg\\,s^{-1}}$. Surface density must be reported in $\\mathrm{kg\\,m^{-2}}$.\n- For each test case, compute $\\Sigma(R)$ at a specified set of radii and report these values in $\\mathrm{kg\\,m^{-2}}$, each rounded to three significant figures. Also report a boolean indicating whether the mass balance $\\dot{M}_{\\rm in} = \\dot{M}_p + \\dot{M}_s$ holds within relative tolerance $10^{-10}$.\n\nTest suite:\n- Use the following four test cases, each defined by $(R_{\\rm in}, R_{\\rm out}, \\dot{M}_{\\rm in}, \\dot{M}_s, R_1, R_2, \\alpha, T_0, R_0, q, M_{\\rm pl}, \\{R_i\\})$, where $\\{R_i\\}$ is the set of radii at which to compute $\\Sigma$.\n\n1. Happy path CPD:\n    - $R_{\\rm in} = 2\\,R_{\\rm J}$, $R_{\\rm out} = 200\\,R_{\\rm J}$\n    - $\\dot{M}_{\\rm in} = 1.0\\times 10^{14}\\ \\mathrm{kg\\,s^{-1}}$, $\\dot{M}_s = 3.0\\times 10^{13}\\ \\mathrm{kg\\,s^{-1}}$\n    - $R_1 = 20\\,R_{\\rm J}$, $R_2 = 40\\,R_{\\rm J}$\n    - $\\alpha = 1.0\\times 10^{-3}$\n    - $T_0 = 200\\ \\mathrm{K}$, $R_0 = 20\\,R_{\\rm J}$, $q = 0.5$\n    - $M_{\\rm pl} = 1.898\\times 10^{27}\\ \\mathrm{kg}$\n    - $\\{R_i\\} = \\{5\\,R_{\\rm J}, 20\\,R_{\\rm J}, 50\\,R_{\\rm J}, 100\\,R_{\\rm J}\\}$\n\n2. No satellite sink:\n    - $R_{\\rm in} = 2\\,R_{\\rm J}$, $R_{\\rm out} = 200\\,R_{\\rm J}$\n    - $\\dot{M}_{\\rm in} = 2.0\\times 10^{13}\\ \\mathrm{kg\\,s^{-1}}$, $\\dot{M}_s = 0$\n    - $R_1 = 20\\,R_{\\rm J}$, $R_2 = 40\\,R_{\\rm J}$ (irrelevant when $\\dot{M}_s=0$)\n    - $\\alpha = 5.0\\times 10^{-3}$\n    - $T_0 = 300\\ \\mathrm{K}$, $R_0 = 20\\,R_{\\rm J}$, $q = 0.5$\n    - $M_{\\rm pl} = 1.898\\times 10^{27}\\ \\mathrm{kg}$\n    - $\\{R_i\\} = \\{5\\,R_{\\rm J}, 20\\,R_{\\rm J}, 50\\,R_{\\rm J}, 100\\,R_{\\rm J}\\}$\n\n3. Strong inner sink ring:\n    - $R_{\\rm in} = 2\\,R_{\\rm J}$, $R_{\\rm out} = 100\\,R_{\\rm J}$\n    - $\\dot{M}_{\\rm in} = 8.0\\times 10^{13}\\ \\mathrm{kg\\,s^{-1}}$, $\\dot{M}_s = 7.5\\times 10^{13}\\ \\mathrm{kg\\,s^{-1}}$\n    - $R_1 = 5\\,R_{\\rm J}$, $R_2 = 10\\,R_{\\rm J}$\n    - $\\alpha = 1.0\\times 10^{-3}$\n    - $T_0 = 150\\ \\mathrm{K}$, $R_0 = 20\\,R_{\\rm J}$, $q = 0.6$\n    - $M_{\\rm pl} = 1.898\\times 10^{27}\\ \\mathrm{kg}$\n    - $\\{R_i\\} = \\{3\\,R_{\\rm J}, 6\\,R_{\\rm J}, 12\\,R_{\\rm J}, 30\\,R_{\\rm J}\\}$\n\n4. Low viscosity, wide sink ring:\n    - $R_{\\rm in} = 2\\,R_{\\rm J}$, $R_{\\rm out} = 200\\,R_{\\rm J}$\n    - $\\dot{M}_{\\rm in} = 5.0\\times 10^{12}\\ \\mathrm{kg\\,s^{-1}}$, $\\dot{M}_s = 2.0\\times 10^{12}\\ \\mathrm{kg\\,s^{-1}}$\n    - $R_1 = 50\\,R_{\\rm J}$, $R_2 = 150\\,R_{\\rm J}$\n    - $\\alpha = 1.0\\times 10^{-4}$\n    - $T_0 = 120\\ \\mathrm{K}$, $R_0 = 50\\,R_{\\rm J}$, $q = 1.0$\n    - $M_{\\rm pl} = 1.898\\times 10^{27}\\ \\mathrm{kg}$\n    - $\\{R_i\\} = \\{10\\,R_{\\rm J}, 60\\,R_{\\rm J}, 120\\,R_{\\rm J}, 180\\,R_{\\rm J}\\}$\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element corresponds to one test case and is itself a list of the form $[\\,[\\Sigma(R_1),\\Sigma(R_2),\\ldots],\\,\\mathrm{boolean}\\,]$, where the inner list contains surface densities in $\\mathrm{kg\\,m^{-2}}$ rounded to three significant figures, and the boolean indicates whether $\\dot{M}_{\\rm in} = \\dot{M}_p + \\dot{M}_s$ holds within relative tolerance $10^{-10}$. For example: $[[[1.23\\mathrm{e}5,4.56\\mathrm{e}4,7.89\\mathrm{e}3],\\mathrm{True}],\\ldots]$.",
            "solution": "The objective is to compute the steady-state surface density profile $\\Sigma(R)$ of a one-dimensional, axisymmetric circumplanetary disk (CPD) with a specified mass inflow at its outer boundary and mass loss due to accretion onto the central planet and satellite formation within a designated radial zone. The model is based on the fundamental principles of mass and angular momentum conservation in a viscous disk.\n\nFirst, we begin with the equation of mass conservation, also known as the continuity equation. For a steady-state ($\\partial/\\partial t = 0$), axisymmetric ($\\partial/\\partial\\phi = 0$) disk in cylindrical coordinates $(R, \\phi, z)$, after vertical integration, the continuity equation is given by:\n$$\n\\frac{1}{R}\\frac{d}{dR}\\left(R\\,\\Sigma(R)\\,v_R(R)\\right) = S(R)\n$$\nwhere $\\Sigma(R)$ is the surface mass density in $\\mathrm{kg\\,m^{-2}}$, $v_R(R)$ is the vertically-averaged radial velocity in $\\mathrm{m\\,s^{-1}}$ (negative for inward flow), and $S(R)$ is the net mass source or sink per unit area in $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$.\n\nIt is convenient to define the net inward mass flux (accretion rate) at a given radius $R$ as the positive quantity:\n$$\n\\dot{M}(R) \\equiv -2\\pi R\\,\\Sigma(R)\\,v_R(R)\n$$\nwith units of $\\mathrm{kg\\,s^{-1}}$. Differentiating $\\dot{M}(R)$ with respect to $R$ gives:\n$$\n\\frac{d\\dot{M}}{dR} = -2\\pi\\frac{d}{dR}\\left(R\\,\\Sigma\\,v_R\\right)\n$$\nSubstituting the continuity equation into this expression, we find the relation between the change in mass flux and the local source/sink term:\n$$\n\\frac{d\\dot{M}}{dR} = -2\\pi R\\,S(R)\n$$\nThe problem specifies a sink term $S(R)$ representing satellite formation in a ring between radii $R_1$ and $R_2$, with a total sink rate of $\\dot{M}_s$. The source term is thus $S(R) = -\\dot{M}_s g(R)$, where $g(R)$ is a normalized distribution function. For a uniform sink per unit area over the ring $[R_1, R_2]$, $g(R)$ is constant in this interval and zero elsewhere. The normalization condition $\\int_{R_1}^{R_2} 2\\pi R\\,g(R)\\,dR = 1$ gives:\n$$\ng(R) = \\frac{1}{\\pi\\left(R_2^2-R_1^2\\right)} \\quad \\text{for} \\quad R \\in [R_1, R_2]\n$$\nTo find the mass flux profile $\\dot{M}(R)$, we integrate $\\frac{d\\dot{M}}{dR}$ from an arbitrary radius $R$ to the outer boundary of the disk, $R_{\\rm out}$:\n$$\n\\int_R^{R_{\\rm out}} \\frac{d\\dot{M}}{dr} dr = \\dot{M}(R_{\\rm out}) - \\dot{M}(R)\n$$\nThis must equal the integral of the sink term over the same interval:\n$$\n\\dot{M}(R_{\\rm out}) - \\dot{M}(R) = \\int_R^{R_{\\rm out}} -2\\pi r S(r) dr = \\int_R^{R_{\\rm out}} 2\\pi r \\dot{M}_s g(r) dr = \\dot{M}_s \\int_R^{R_{\\rm out}} 2\\pi r g(r) dr\n$$\nWe define the mass inflow rate at the outer boundary as $\\dot{M}_{\\rm in} \\equiv \\dot{M}(R_{\\rm out})$, and the integrated fraction of the sink exterior to $R$ as $f(R) \\equiv \\int_R^{R_{\\rm out}} 2\\pi r g(r) dr$. The mass flux profile is then:\n$$\n\\dot{M}(R) = \\dot{M}_{\\rm in} - \\dot{M}_s f(R)\n$$\nThe function $f(R)$ is piecewise, determined by the location of $R$ relative to the sink region $[R_1, R_2]$. Evaluating the integral for $f(R)$ yields:\n$$\nf(R) =\n\\begin{cases}\n1,  R \\le R_1 \\\\\n\\dfrac{R_2^2 - R^2}{R_2^2 - R_1^2},  R_1  R  R_2 \\\\\n0,  R \\ge R_2\n\\end{cases}\n$$\nNext, we invoke the theory of angular momentum transport in a thin, viscous, Keplerian disk. In steady state, the net viscous torque must balance the advection of angular momentum. Under the simplification that boundary torques are negligible (valid far from the inner disk edge), the local inward mass flux is related to the surface density $\\Sigma(R)$ and the kinematic viscosity $\\nu(R)$ by the standard closure:\n$$\n\\dot{M}(R) = 3\\pi \\nu(R) \\Sigma(R)\n$$\nThis allows us to solve for the surface density:\n$$\n\\Sigma(R) = \\frac{\\dot{M}(R)}{3\\pi \\nu(R)}\n$$\nThe kinematic viscosity $\\nu(R)$ is modeled using the alpha-prescription:\n$$\n\\nu(R) = \\alpha \\frac{c_s^2(R)}{\\Omega_K(R)}\n$$\nwhere $\\alpha$ is a dimensionless parameter, $c_s(R)$ is the local sound speed, and $\\Omega_K(R)$ is the Keplerian angular frequency. These are given by:\n$$\nc_s(R) = \\sqrt{\\frac{k_{\\rm B} T(R)}{\\mu m_{\\rm H}}} \\quad \\text{and} \\quad \\Omega_K(R) = \\sqrt{\\frac{G M_{\\rm pl}}{R^3}}\n$$\nHere, $k_{\\rm B}$ is Boltzmann's constant, $T(R)$ is the disk temperature, $\\mu$ is the mean molecular weight, $m_{\\rm H}$ is the hydrogen atom mass, $G$ is the gravitational constant, and $M_{\\rm pl}$ is the planet's mass. The temperature profile is given as a power law:\n$$\nT(R) = T_0 \\left(\\frac{R}{R_0}\\right)^{-q}\n$$\nSubstituting these expressions into the formula for $\\nu(R)$, we obtain an explicit function of radius:\n$$\n\\nu(R) = \\alpha \\left( \\frac{k_{\\rm B} T_0}{\\mu m_{\\rm H}} \\left(\\frac{R}{R_0}\\right)^{-q} \\right) \\left( \\frac{G M_{\\rm pl}}{R^3} \\right)^{-1/2} = \\alpha \\frac{k_{\\rm B} T_0}{\\mu m_{\\rm H}} \\frac{R_0^q}{\\sqrt{G M_{\\rm pl}}} R^{3/2 - q}\n$$\nBy combining all these elements, we arrive at the final expression for the surface density profile:\n$$\n\\Sigma(R) = \\frac{\\dot{M}_{\\rm in} - \\dot{M}_s f(R)}{3\\pi \\nu(R)}\n$$\nThe accretion rate onto the planet, $\\dot{M}_p$, is the mass flux evaluated at the inner disk boundary, $R_{\\rm in}$:\n$$\n\\dot{M}_p = \\dot{M}(R_{\\rm in}) = \\dot{M}_{\\rm in} - \\dot{M}_s f(R_{\\rm in})\n$$\nSince all test cases are structured such that $R_{\\rm in} \\le R_1$, we have $f(R_{\\rm in}) = 1$. This leads to $\\dot{M}_p = \\dot{M}_{\\rm in} - \\dot{M}_s$, which confirms the overall mass balance equation $\\dot{M}_{\\rm in} = \\dot{M}_p + \\dot{M}_s$. The numerical implementation will verify this identity to within a specified floating-point tolerance.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the surface density profile of a circumplanetary disk for multiple test cases.\n    \"\"\"\n    # Physical constants in SI units\n    G = 6.6743e-11  # m^3 kg^-1 s^-2\n    K_B = 1.380649e-23  # J K^-1\n    M_H = 1.6735575e-27  # kg\n    MU = 2.34\n    R_J = 7.1492e7  # meters, radius of Jupiter\n\n    def round_to_3_sf(x):\n        \"\"\"Rounds a number to three significant figures.\"\"\"\n        if x == 0:\n            return 0.0\n        return float(f'{x:.2e}')\n\n    def process_case(params):\n        \"\"\"\n        Processes a single test case to compute surface densities and verify mass balance.\n        \"\"\"\n        R_in_Rj, R_out_Rj, M_in, M_s, R1_Rj, R2_Rj, alpha, T0, R0_Rj, q, M_pl, R_i_Rj = params\n\n        # Convert radii from R_J to meters\n        R_in = R_in_Rj * R_J\n        R_out = R_out_Rj * R_J\n        R1 = R1_Rj * R_J\n        R2 = R2_Rj * R_J\n        R0 = R0_Rj * R_J\n        R_i = [r * R_J for r in R_i_Rj]\n\n        # Function for the integrated sink fraction f(R)\n        def f_sink(R):\n            if R = R1:\n                return 1.0\n            elif R1  R  R2:\n                # Handle the case R1=R2 to avoid division by zero\n                if R1 == R2:\n                    return 0.0\n                return (R2**2 - R**2) / (R2**2 - R1**2)\n            else:  # R = R2\n                return 0.0\n\n        # Function for mass flux M_dot(R)\n        def M_dot(R):\n            return M_in - M_s * f_sink(R)\n\n        # Function for kinematic viscosity nu(R)\n        def nu(R):\n            T_R = T0 * (R / R0)**(-q)\n            cs2_R = K_B * T_R / (MU * M_H)\n            Omega_K_R = np.sqrt(G * M_pl / R**3)\n            return alpha * cs2_R / Omega_K_R\n\n        # Function for surface density Sigma(R)\n        def Sigma(R):\n            current_nu = nu(R)\n            if current_nu == 0:\n                return np.inf\n            return M_dot(R) / (3 * np.pi * current_nu)\n\n        # Compute surface density at specified radii\n        sigma_values = [round_to_3_sf(Sigma(r)) for r in R_i]\n\n        # Verify mass balance\n        M_p = M_dot(R_in)\n        # Check if M_in is non-zero to avoid division by zero in relative tolerance check\n        if M_in != 0:\n            mass_balance_holds = np.isclose(M_in, M_p + M_s, rtol=1e-10)\n        else: # If M_in is zero, M_p + M_s should also be zero\n            mass_balance_holds = np.isclose(M_p + M_s, 0, atol=1e-12) # Use absolute tol for zero case\n\n        return sigma_values, bool(mass_balance_holds)\n    \n    # Define the test cases from the problem statement\n    test_cases = [\n        # Case 1: Happy path CPD\n        (2.0, 200.0, 1.0e14, 3.0e13, 20.0, 40.0, 1.0e-3, 200.0, 20.0, 0.5, 1.898e27, [5.0, 20.0, 50.0, 100.0]),\n        # Case 2: No satellite sink\n        (2.0, 200.0, 2.0e13, 0.0, 20.0, 40.0, 5.0e-3, 300.0, 20.0, 0.5, 1.898e27, [5.0, 20.0, 50.0, 100.0]),\n        # Case 3: Strong inner sink ring\n        (2.0, 100.0, 8.0e13, 7.5e13, 5.0, 10.0, 1.0e-3, 150.0, 20.0, 0.6, 1.898e27, [3.0, 6.0, 12.0, 30.0]),\n        # Case 4: Low viscosity, wide sink ring\n        (2.0, 200.0, 5.0e12, 2.0e12, 50.0, 150.0, 1.0e-4, 120.0, 50.0, 1.0, 1.898e27, [10.0, 60.0, 120.0, 180.0])\n    ]\n\n    results_str_list = []\n    for case in test_cases:\n        sigma_vals, balance_ok = process_case(case)\n        # Format sigma values to avoid spaces\n        sigma_str = '[' + ','.join(map(str, sigma_vals)) + ']'\n        # Format the whole result for this case\n        case_result_str = '[' + sigma_str + ',' + str(balance_ok) + ']'\n        results_str_list.append(case_result_str)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results_str_list)}]\")\n\n\nsolve()\n```"
        },
        {
            "introduction": "With the gas disk structure established, we now turn to the birth of satellites from embedded dust grains. This computational problem challenges you to identify regions within a circumplanetary disk where the streaming instability—a leading mechanism for the rapid formation of planetesimals and satellitesimals—can be triggered. You will implement a model evaluating the two critical conditions for this instability: optimal aerodynamic coupling of particles (quantified by the Stokes number) and sufficient dust concentration at the disk midplane, bridging the gap between dust dynamics and the formation of large bodies. ",
            "id": "4155782",
            "problem": "You are asked to design and implement a complete, runnable program that evaluates where streaming instability is triggered in a circumplanetary disk (CPD) and returns the set of radii that satisfy the triggering criteria for several test cases. Your solution must proceed from fundamental definitions and well-tested physical relations, and it must explicitly state and use units consistently. The output must be a single line containing the results for all test cases, aggregated as specified below.\n\nThe physical setup is a geometrically thin CPD in Keplerian rotation about a planet of mass $M_p$. Assume a vertically isothermal disk in hydrostatic equilibrium and apply the following foundational bases:\n\n- Newtonian gravity with gravitational constant $G$, Keplerian angular frequency $\\Omega_K(r) = \\sqrt{G M_p / r^3}$, and Keplerian orbital speed $v_K(r) = r \\, \\Omega_K(r)$.\n- Ideal gas with isothermal sound speed $c_s(r) = \\sqrt{k_B T(r) / (\\mu m_p)}$, where $k_B$ is the Boltzmann constant, $m_p$ is the proton mass, and $\\mu$ is the mean molecular weight.\n- Vertical hydrostatic equilibrium yields a Gaussian vertical density profile with scale height $H(r) = c_s(r) / \\Omega_K(r)$ and midplane gas density $\\rho_{g,0}(r) = \\Sigma_g(r) / \\left( \\sqrt{2 \\pi} \\, H(r) \\right)$, where $\\Sigma_g(r)$ is the gas surface density.\n- For small solids in the Epstein drag regime, the stopping time is $t_s(r,s) = \\dfrac{\\rho_s s}{\\rho_{g,0}(r) \\, v_{\\mathrm{th}}(r)}$, where $s$ is the particle radius, $\\rho_s$ is the internal density of solids, and the mean thermal speed is $v_{\\mathrm{th}}(r) = \\sqrt{\\dfrac{8}{\\pi}} \\, c_s(r)$. The Stokes number is $St(r,s) = \\Omega_K(r) \\, t_s(r,s)$.\n- In steady state with vertical turbulent diffusion parameterized by the Shakura–Sunyaev turbulent diffusivity parameter $\\alpha$, the dust scale height is $H_d(r) = H(r) \\, \\sqrt{\\dfrac{\\alpha}{\\alpha + St(r,s)}}$ and the midplane dust-to-gas density ratio is $\\epsilon_{\\mathrm{mid}}(r) = \\dfrac{\\rho_{d,0}(r)}{\\rho_{g,0}(r)} = \\dfrac{\\Sigma_d(r)}{\\Sigma_g(r)} \\, \\dfrac{H(r)}{H_d(r)}$, where $\\Sigma_d(r)$ is the dust surface density. Define the local metallicity as $Z(r) \\equiv \\Sigma_d(r)/\\Sigma_g(r)$.\n\nAdopt the widely used thresholds for triggering streaming instability in protoplanetary and circumplanetary disks:\n\n- The aerodynamic coupling must be within a favorable window: $St_{\\min} \\le St(r,s) \\le St_{\\max}$ with $St_{\\min} = 10^{-2}$ and $St_{\\max} = 1$.\n- The midplane dust enrichment must be sufficient: $\\epsilon_{\\mathrm{mid}}(r) \\ge 1$.\n\nUnder these assumptions, proceed as follows:\n\n- Use a parametric CPD structure:\n  - Gas surface density profile $\\Sigma_g(r) = \\Sigma_0 \\left( \\dfrac{r}{r_0} \\right)^{-p}$.\n  - Temperature profile $T(r) = T_0 \\left( \\dfrac{r}{r_0} \\right)^{-q}$.\n- The dust surface density is parameterized by a baseline metallicity and a ring enhancement:\n  - $\\Sigma_d(r) = Z_0 \\, \\Sigma_g(r) \\left[ 1 + A \\, \\exp \\left( - \\dfrac{(r - r_{\\mathrm{ring}})^2}{2 w^2} \\right) \\right]$,\n  where $A$ is a dimensionless amplitude, $r_{\\mathrm{ring}}$ is the ring center radius, and $w$ is the ring width.\n\nYour program must:\n\n- Use the constants $G = 6.67430 \\times 10^{-11} \\ \\mathrm{m^3 \\, kg^{-1} \\, s^{-2}}$, $k_B = 1.380649 \\times 10^{-23} \\ \\mathrm{J \\, K^{-1}}$, $m_p = 1.67262192369 \\times 10^{-27} \\ \\mathrm{kg}$.\n- Use the planetary and unit constants $M_J = 1.898 \\times 10^{27} \\ \\mathrm{kg}$ and $R_J = 7.1492 \\times 10^{7} \\ \\mathrm{m}$, and set $M_p = M_J$.\n- Use mean molecular weight $\\mu = 2.34$ and solid density $\\rho_s = 1500 \\ \\mathrm{kg \\, m^{-3}}$.\n- Use the CPD parameters $r_0 = 10 R_J$, $\\Sigma_0 = 2 \\times 10^{4} \\ \\mathrm{kg \\, m^{-2}}$, $T_0 = 400 \\ \\mathrm{K}$, $p = 1$, and $q = 0.5$.\n- Evaluate on a uniform radial grid from $r_{\\min} = 5 R_J$ to $r_{\\max} = 100 R_J$ with $N = 50$ points.\n- Apply the Epstein regime formulas consistently as stated.\n- Trigger streaming instability where both $St_{\\min} \\le St(r,s) \\le St_{\\max}$ and $\\epsilon_{\\mathrm{mid}}(r) \\ge 1$ are simultaneously satisfied.\n\nTest suite:\n\nCompute the set of radii $r$ (in meters) that satisfy the triggering criteria for each of the following four cases. In all cases use the shared parameters above and the gas and temperature profiles specified. For each case, the particle size $s$, turbulence parameter $\\alpha$, baseline metallicity $Z_0$, and ring parameters $(A, r_{\\mathrm{ring}}, w)$ are as listed:\n\n- Case $1$: $s = 0.5 \\ \\mathrm{m}$, $\\alpha = 5 \\times 10^{-4}$, $Z_0 = 0.03$, $A = 1.0$, $r_{\\mathrm{ring}} = 50 R_J$, $w = 5 R_J$.\n- Case $2$: $s = 0.01 \\ \\mathrm{m}$, $\\alpha = 10^{-3}$, $Z_0 = 0.05$, $A = 0.0$, $r_{\\mathrm{ring}}$ arbitrary, $w$ arbitrary.\n- Case $3$: $s = 1.0 \\ \\mathrm{m}$, $\\alpha = 10^{-3}$, $Z_0 = 0.04$, $A = 0.0$, $r_{\\mathrm{ring}}$ arbitrary, $w$ arbitrary.\n- Case $4$: $s = 0.3 \\ \\mathrm{m}$, $\\alpha = 5 \\times 10^{-4}$, $Z_0 = 0.04$, $A = 0.0$, $r_{\\mathrm{ring}}$ arbitrary, $w$ arbitrary.\n\nRequired final output format:\n\n- For each case, produce the list of all radii on the grid that meet the triggering criteria. Each list must contain radii expressed in meters and rounded to the nearest $10^{6} \\ \\mathrm{m}$.\n- Aggregate the four lists into a single line in the exact format: a comma-separated list of the four case lists, enclosed in square brackets, for example, $\\left[ [r_{1,1}, r_{1,2}, \\dots], [ \\dots ], [ \\dots ], [ \\dots ] \\right]$, with no additional text.\n- If no radius satisfies the criteria in a given case, output an empty list [] for that case.\n\nAngles do not appear in this problem. All physical quantities must be expressed in SI base units. The final printed radii must be in meters, rounded to the nearest $10^{6} \\ \\mathrm{m}$, as specified.\n\nYour program must implement the physics from the stated base definitions and compute the results for all four cases. The program must not require user input and must print a single line in the exact required format. The answers are lists of floats or integers (the rounded radii), making them directly testable.",
            "solution": "We begin from the fundamental physics of a circumplanetary disk (CPD) in Keplerian rotation. The gravitational parameter is $G$, and the planet mass is $M_p$, so the Keplerian angular frequency at cylindrical radius $r$ is $\\Omega_K(r) = \\sqrt{\\dfrac{G M_p}{r^3}}$. Keplerian speed is $v_K(r) = r \\, \\Omega_K(r)$. Under the ideal gas assumption, the isothermal sound speed is $c_s(r) = \\sqrt{\\dfrac{k_B T(r)}{\\mu m_p}}$, where $k_B$ is the Boltzmann constant, $m_p$ is the proton mass, and $\\mu$ is the mean molecular weight (dimensionless). In vertical hydrostatic equilibrium, the density is Gaussian in $z$ with scale height $H(r) = \\dfrac{c_s(r)}{\\Omega_K(r)}$, and the midplane gas density is $\\rho_{g,0}(r) = \\dfrac{\\Sigma_g(r)}{\\sqrt{2\\pi} \\, H(r)}$.\n\nWe parameterize the gas surface density and temperature as power laws:\n$\\Sigma_g(r) = \\Sigma_0 \\left( \\dfrac{r}{r_0} \\right)^{-p}$ and $T(r) = T_0 \\left( \\dfrac{r}{r_0} \\right)^{-q}$, with given constants $\\Sigma_0$, $T_0$, $p$, $q$, and $r_0$.\n\nFor small solid particles in the Epstein regime, the stopping time is derived from the drag force proportional to the relative velocity and the mean thermal speed of gas molecules. The thermal speed is $v_{\\mathrm{th}}(r) = \\sqrt{\\dfrac{8}{\\pi}} \\, c_s(r)$. The stopping time is\n$t_s(r,s) = \\dfrac{\\rho_s s}{\\rho_{g,0}(r) \\, v_{\\mathrm{th}}(r)}$,\nwhere $\\rho_s$ is the internal density of the solid and $s$ is its radius. The dimensionless Stokes number is the product of orbital frequency and stopping time:\n$St(r,s) = \\Omega_K(r) \\, t_s(r,s)$.\n\nWe next relate midplane dust enrichment to disk turbulence. In steady state with turbulent diffusion characterized by the Shakura–Sunyaev parameter $\\alpha$, the dust scale height is $H_d(r) = H(r) \\, \\sqrt{\\dfrac{\\alpha}{\\alpha + St(r,s)}}$. The midplane dust-to-gas density ratio equals the ratio of surface densities scaled by the ratio of scale heights (for Gaussian vertical distributions):\n$\\epsilon_{\\mathrm{mid}}(r) = \\dfrac{\\rho_{d,0}(r)}{\\rho_{g,0}(r)} = \\dfrac{\\Sigma_d(r)}{\\sqrt{2\\pi} \\, H_d(r)} \\Big/ \\dfrac{\\Sigma_g(r)}{\\sqrt{2\\pi} \\, H(r)} = \\dfrac{\\Sigma_d(r)}{\\Sigma_g(r)} \\, \\dfrac{H(r)}{H_d(r)} = Z(r) \\, \\sqrt{1 + \\dfrac{St(r,s)}{\\alpha}}$,\nwhere we used $H/H_d = \\sqrt{\\dfrac{\\alpha + St}{\\alpha}} = \\sqrt{1 + \\dfrac{St}{\\alpha}}$, and $Z(r) = \\Sigma_d(r)/\\Sigma_g(r)$ is the local metallicity.\n\nThe widely used necessary conditions for triggering the streaming instability include:\n- An aerodynamic coupling within a favorable band, typically $St_{\\min} \\le St(r,s) \\le St_{\\max}$, with $St_{\\min} = 10^{-2}$ and $St_{\\max} = 1$.\n- A sufficiently large midplane dust-to-gas density ratio, $\\epsilon_{\\mathrm{mid}}(r) \\ge 1$.\n\nGiven a parametric metallicity profile for dust that includes an enhancement ring\n$\\Sigma_d(r) = Z_0 \\, \\Sigma_g(r) \\, \\left[ 1 + A \\, \\exp \\left( - \\dfrac{(r - r_{\\mathrm{ring}})^2}{2w^2} \\right) \\right]$,\nwe have $Z(r) = Z_0 \\, \\left[ 1 + A \\, \\exp \\left( - \\dfrac{(r - r_{\\mathrm{ring}})^2}{2w^2} \\right) \\right]$.\n\nAlgorithmic procedure:\n1. Define constants in SI: $G$, $k_B$, $m_p$, $M_J$, $R_J$, and adopt $M_p = M_J$, mean molecular weight $\\mu$, and solid density $\\rho_s$.\n2. Construct the radial grid with $N$ points uniformly spanning $r_{\\min}$ to $r_{\\max}$.\n3. For each radius $r$:\n   - Compute $T(r)$ and $c_s(r)$.\n   - Compute $\\Omega_K(r)$ and $H(r)$.\n   - Compute $\\Sigma_g(r)$ and $\\rho_{g,0}(r)$.\n   - Compute $v_{\\mathrm{th}}(r)$, then $t_s(r,s)$, and $St(r,s)$.\n   - Compute $Z(r)$ from the dust parameterization and then $\\epsilon_{\\mathrm{mid}}(r) = Z(r) \\, \\sqrt{1 + \\dfrac{St(r,s)}{\\alpha}}$.\n4. Apply the streaming instability criteria $St_{\\min} \\le St \\le St_{\\max}$ and $\\epsilon_{\\mathrm{mid}} \\ge 1$. Collect all radii $r$ that satisfy both.\n5. Round each selected radius to the nearest $10^{6} \\ \\mathrm{m}$.\n6. Repeat steps for each test case with its parameters. Return the four lists in a single-line aggregate format.\n\nNotably, by substituting $\\rho_{g,0}(r) = \\dfrac{\\Sigma_g(r)}{\\sqrt{2\\pi}H(r)}$ and $v_{\\mathrm{th}} \\propto c_s$ into $t_s$, one finds $St(r,s) = \\Omega_K \\, \\dfrac{\\rho_s s}{\\rho_{g,0} v_{\\mathrm{th}}} \\propto \\dfrac{\\rho_s s}{\\Sigma_g(r)}$, which shows that, within the Epstein regime for vertically isothermal disks, $St$ primarily depends on $s$ and $\\Sigma_g(r)$ and not explicitly on $T(r)$, reinforcing physical intuition and providing a consistency check for the implementation.\n\nWe now apply this algorithm to the four specified cases with shared CPD parameters $r_0 = 10 R_J$, $\\Sigma_0 = 2 \\times 10^{4} \\ \\mathrm{kg \\, m^{-2}}$, $T_0 = 400 \\ \\mathrm{K}$, $p = 1$, $q = 0.5$, $M_p = M_J$, radial bounds $r_{\\min} = 5 R_J$, $r_{\\max} = 100 R_J$, and $N = 50$. The case parameters are:\n- Case $1$: $s = 0.5 \\ \\mathrm{m}$, $\\alpha = 5 \\times 10^{-4}$, $Z_0 = 0.03$, $A = 1.0$, $r_{\\mathrm{ring}} = 50 R_J$, $w = 5 R_J$.\n- Case $2$: $s = 0.01 \\ \\mathrm{m}$, $\\alpha = 10^{-3}$, $Z_0 = 0.05$, $A = 0.0$.\n- Case $3$: $s = 1.0 \\ \\mathrm{m}$, $\\alpha = 10^{-3}$, $Z_0 = 0.04$, $A = 0.0$.\n- Case $4$: $s = 0.3 \\ \\mathrm{m}$, $\\alpha = 5 \\times 10^{-4}$, $Z_0 = 0.04$, $A = 0.0$.\n\nThe final program computes and prints the lists of rounded radii in meters for each case, aggregated into a single line, for direct evaluation. The units are strictly SI, and radii are reported in meters rounded to the nearest $10^{6} \\ \\mathrm{m}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef cpd_streaming_instability_radii(\n    s, alpha, Z0, A, r_ring, w,\n    Mp, mu, rho_s,\n    Sigma0, T0, p, q, r0,\n    r_min, r_max, N,\n    G, kB, mp, RJ\n):\n    # Radial grid\n    r = np.linspace(r_min, r_max, N)  # meters\n\n    # Gas and temperature profiles\n    Sigma_g = Sigma0 * (r / r0) ** (-p)  # kg/m^2\n    T = T0 * (r / r0) ** (-q)            # K\n\n    # Sound speed and Keplerian frequency\n    cs = np.sqrt(kB * T / (mu * mp))     # m/s\n    OmegaK = np.sqrt(G * Mp / r**3)      # 1/s\n    H = cs / OmegaK                      # m\n\n    # Midplane gas density\n    rho_g0 = Sigma_g / (np.sqrt(2.0 * np.pi) * H)  # kg/m^3\n\n    # Thermal speed\n    v_th = np.sqrt(8.0 / np.pi) * cs     # m/s\n\n    # Epstein stopping time and Stokes number\n    ts = (rho_s * s) / (rho_g0 * v_th)   # s\n    St = OmegaK * ts                     # dimensionless\n\n    # Local metallicity Z(r)\n    if A != 0.0 and r_ring is not None and w is not None:\n        bump = 1.0 + A * np.exp(- (r - r_ring)**2 / (2.0 * w**2))\n    else:\n        bump = 1.0\n    Z = Z0 * bump  # dimensionless\n\n    # Dust scale height and midplane dust-to-gas ratio\n    # H_d = H * sqrt(alpha / (alpha + St)) - epsilon_mid = Z * (H / H_d) = Z * sqrt(1 + St/alpha)\n    eps_mid = Z * np.sqrt(1.0 + St / alpha)\n\n    # Streaming instability criteria\n    St_min = 1e-2\n    St_max = 1.0\n\n    mask = (St = St_min)  (St = St_max)  (eps_mid = 1.0)\n\n    # Select radii that satisfy, rounded to nearest 1e6 m\n    r_sel = r[mask]\n    # Round to nearest 1e6 m\n    r_round = np.rint(r_sel / 1e6) * 1e6\n\n    # Convert to integers for clean output\n    radii_list = [int(x) for x in r_round.tolist()]\n\n    return radii_list\n\ndef solve():\n    # Constants (SI)\n    G = 6.67430e-11           # m^3 kg^-1 s^-2\n    kB = 1.380649e-23         # J K^-1\n    mp = 1.67262192369e-27    # kg\n\n    # Planet and units\n    MJ = 1.898e27             # kg\n    RJ = 7.1492e7             # m\n    Mp = MJ\n\n    # Disk and material parameters (shared)\n    mu = 2.34                 # mean molecular weight\n    rho_s = 1500.0            # kg/m^3 (solids)\n    r0 = 10.0 * RJ            # m\n    Sigma0 = 2.0e4            # kg/m^2 at r0\n    T0 = 400.0                # K at r0\n    p = 1.0\n    q = 0.5\n\n    # Radial grid\n    r_min = 5.0 * RJ\n    r_max = 100.0 * RJ\n    N = 50\n\n    # Test cases: (s, alpha, Z0, A, r_ring, w)\n    cases = [\n        # Case 1\n        (0.5, 5e-4, 0.03, 1.0, 50.0 * RJ, 5.0 * RJ),\n        # Case 2\n        (0.01, 1e-3, 0.05, 0.0, None, None),\n        # Case 3\n        (1.0, 1e-3, 0.04, 0.0, None, None),\n        # Case 4\n        (0.3, 5e-4, 0.04, 0.0, None, None),\n    ]\n\n    results = []\n    for s, alpha, Z0, A, r_ring, w in cases:\n        radii = cpd_streaming_instability_radii(\n            s=s, alpha=alpha, Z0=Z0, A=A, r_ring=r_ring, w=w,\n            Mp=Mp, mu=mu, rho_s=rho_s,\n            Sigma0=Sigma0, T0=T0, p=p, q=q, r0=r0,\n            r_min=r_min, r_max=r_max, N=N,\n            G=G, kB=kB, mp=mp, RJ=RJ\n        )\n        results.append(radii)\n\n    # Final print statement in the exact required format.\n    # Print as a single line JSON-like list of lists without extra spaces.\n    # Convert lists to string with commas and brackets.\n    # Ensure no extra spaces: use join operations.\n    def list_to_str(lst):\n        return \"[\" + \",\".join(str(x) for x in lst) + \"]\"\n\n    print(\"[\" + \",\".join(list_to_str(r) for r in results) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "Our previous models relied on parameters like the viscosity coefficient $\\alpha$ to describe turbulence, but what is the physical origin of this turbulence? This exercise explores the vertical shear instability (VSI), a powerful candidate for driving angular momentum transport in the cool, outer regions of disks where satellites form. By developing a program to test the VSI criterion, you will gain insight into how the disk's thermal structure and cooling properties can generate the very turbulence that shapes its evolution and influences the conditions for satellite formation. ",
            "id": "4155716",
            "problem": "You are modeling the conditions for the operation of the vertical shear instability in a circumplanetary disk and want to determine, from first principles, whether linear instability is possible under prescribed thermodynamic and dynamical conditions, and then estimate the level of turbulence as a Shakura–Sunyaev stress parameter. You must implement a program that evaluates, for a set of test cases, whether the vertical shear instability can operate and, if so, estimates the induced Shakura–Sunyaev parameter. The program must base its decision on the following physically motivated and widely used ingredients without invoking any unvalidated shortcuts:\n\n- Ideal gas relation and definitions for orbital dynamics in a Keplerian disk: sound speed $c_s$, Keplerian speed $v_K$, Keplerian angular frequency $\\Omega$, and disk aspect ratio $h$ defined by $h = H/R = c_s/v_K$.\n- The radial temperature gradient defines the baroclinic driver via $q \\equiv d \\ln T / d \\ln R$, which may be computed from $dT/dR$ as $q = (R/T)\\,(dT/dR)$.\n- A cooling-limited destabilization of vertical buoyancy with a relaxation timescale $\\tau_{\\mathrm{cool}}$ that depends on dust loading via a linear opacity sensitivity model: $\\tau_{\\mathrm{cool}} = \\tau_0\\,(1 + A f_d)$, with $f_d$ the midplane dust-to-gas mass ratio, $\\tau_0$ a baseline cooling time at zero dust, and $A$ a fixed opacity sensitivity factor.\n- A necessary linear criterion for the instability to operate, expressed as a dimensionless inequality $\\Omega\\,\\tau_{\\mathrm{cool}}  \\beta_{\\mathrm{crit}}$, where the critical threshold $\\beta_{\\mathrm{crit}}$ depends only on the local thermodynamics through $\\beta_{\\mathrm{crit}} = h/|q|$. This encodes that stronger temperature gradients and puffier disks admit vertical shear more readily, while slower cooling suppresses it. If $|q| = 0$, the instability is disallowed.\n\nIf the inequality is not satisfied, the instability is deemed inoperable and the turbulent stress parameter must be set to zero. If the inequality is satisfied, you must estimate the fastest linear growth rate and then the saturated stress parameter using the following physically motivated scalings:\n\n- A fastest linear growth rate modeled as $\\sigma = c_g\\,|q|\\,h\\,\\Omega\\,\\sqrt{1 - (\\Omega\\,\\tau_{\\mathrm{cool}})/\\beta_{\\mathrm{crit}}}$, which recovers $\\sigma \\propto |q|\\,h\\,\\Omega$ when cooling is rapid and vanishes continuously at threshold. The positive constant $c_g$ is a growth efficiency factor with value specified below.\n- A mixing-length closure for the Shakura–Sunyaev parameter $\\alpha$ based on $\\alpha \\sim (l/H)\\,(v_t/c_s)$ with turbulent velocity $v_t \\sim \\chi\\,(\\sigma/\\Omega)\\,c_s$ and outer turbulent scale $l \\sim H/(2\\pi)$, giving the estimate $\\alpha = (\\chi/(2\\pi))\\,(\\sigma/\\Omega)$. The dimensionless constant $\\chi$ is a saturation efficiency parameter with value specified below.\n\nUse the following constants and parameters:\n- Gravitational constant $G = 6.6743 \\times 10^{-11}\\ \\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$.\n- Boltzmann constant $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$.\n- Atomic mass unit of hydrogen $m_H = 1.6735575 \\times 10^{-27}\\ \\mathrm{kg}$.\n- Mean molecular weight $\\mu = 2.34$ (dimensionless).\n- Adiabatic index $\\gamma = 1.4$ (dimensionless) to be used when needed.\n- Opacity sensitivity factor $A = 20$ (dimensionless).\n- Growth efficiency factor $c_g = 0.5$ (dimensionless).\n- Saturation efficiency factor $\\chi = 0.5$ (dimensionless).\n\nFor each test case, the inputs are planetary mass $M_p$ in $\\mathrm{kg}$, orbital radius $R$ in $\\mathrm{m}$, local temperature $T$ in $\\mathrm{K}$, radial temperature gradient $dT/dR$ in $\\mathrm{K\\,m^{-1}}$, dust-to-gas ratio $f_d$ (dimensionless), and baseline cooling time $\\tau_0$ in $\\mathrm{s}$. From these, compute:\n- $q = (R/T)\\,(dT/dR)$ (dimensionless).\n- $c_s = \\sqrt{k_B T / (\\mu m_H)}$ in $\\mathrm{m\\,s^{-1}}$.\n- $v_K = \\sqrt{G M_p / R}$ in $\\mathrm{m\\,s^{-1}}$.\n- $\\Omega = v_K / R$ in $\\mathrm{s^{-1}}$.\n- $h = c_s / v_K$ (dimensionless).\n- $\\tau_{\\mathrm{cool}} = \\tau_0\\,(1 + A f_d)$ in $\\mathrm{s}$.\n- $\\beta_{\\mathrm{crit}} = h/|q|$ (dimensionless) if $|q|  0$; if $|q|=0$, the instability is disallowed.\n- Instability check: if $\\Omega\\,\\tau_{\\mathrm{cool}}  \\beta_{\\mathrm{crit}}$, then active; else inactive.\n- If active, $\\sigma = c_g\\,|q|\\,h\\,\\Omega\\,\\sqrt{1 - (\\Omega\\,\\tau_{\\mathrm{cool}})/\\beta_{\\mathrm{crit}}}$ in $\\mathrm{s^{-1}}$ and $\\alpha = (\\chi/(2\\pi))\\,(\\sigma/\\Omega)$ (dimensionless). If inactive, $\\alpha = 0$.\n\nYour program must compute, for the following test suite, a list of results. For each test case, output a two-element list containing:\n- A boolean indicating whether the instability is active (True if active, False otherwise).\n- The value of $\\alpha$ rounded to six significant figures (dimensionless).\n\nThe test suite to implement is:\n- Case $1$: $M_p = 1.898 \\times 10^{27}\\ \\mathrm{kg}$, $R = 2.1 \\times 10^{9}\\ \\mathrm{m}$, $T = 200\\ \\mathrm{K}$, $dT/dR = -1.0 \\times 10^{-7}\\ \\mathrm{K\\,m^{-1}}$, $f_d = 0.01$, $\\tau_0 = 1.0 \\times 10^{4}\\ \\mathrm{s}$.\n- Case $2$ (near-threshold cooling): $M_p = 1.898 \\times 10^{27}\\ \\mathrm{kg}$, $R = 2.1 \\times 10^{9}\\ \\mathrm{m}$, $T = 200\\ \\mathrm{K}$, $dT/dR = -1.0 \\times 10^{-7}\\ \\mathrm{K\\,m^{-1}}$, $f_d = 0.0$, $\\tau_0 = 2.92 \\times 10^{4}\\ \\mathrm{s}$.\n- Case $3$ (no baroclinic driver): $M_p = 1.898 \\times 10^{27}\\ \\mathrm{kg}$, $R = 2.1 \\times 10^{9}\\ \\mathrm{m}$, $T = 200\\ \\mathrm{K}$, $dT/dR = 0.0\\ \\mathrm{K\\,m^{-1}}$, $f_d = 0.10$, $\\tau_0 = 1.0 \\times 10^{4}\\ \\mathrm{s}$.\n- Case $4$ (outer disk, stronger $|q|$): $M_p = 1.898 \\times 10^{27}\\ \\mathrm{kg}$, $R = 4.2 \\times 10^{9}\\ \\mathrm{m}$, $T = 120\\ \\mathrm{K}$, $dT/dR = -5.0 \\times 10^{-8}\\ \\mathrm{K\\,m^{-1}}$, $f_d = 0.02$, $\\tau_0 = 1.0 \\times 10^{4}\\ \\mathrm{s}$.\n- Case $5$ (high dust, long cooling): $M_p = 1.898 \\times 10^{27}\\ \\mathrm{kg}$, $R = 2.1 \\times 10^{9}\\ \\mathrm{m}$, $T = 200\\ \\mathrm{K}$, $dT/dR = -1.0 \\times 10^{-7}\\ \\mathrm{K\\,m^{-1}}$, $f_d = 5.0$, $\\tau_0 = 1.0 \\times 10^{4}\\ \\mathrm{s}$.\n- Case $6$ (lower-mass planet, easier criterion): $M_p = 3.796 \\times 10^{26}\\ \\mathrm{kg}$, $R = 2.1 \\times 10^{9}\\ \\mathrm{m}$, $T = 200\\ \\mathrm{K}$, $dT/dR = -1.0 \\times 10^{-7}\\ \\mathrm{K\\,m^{-1}}$, $f_d = 0.10$, $\\tau_0 = 1.0 \\times 10^{4}\\ \\mathrm{s}$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a two-element list of the form [active_boolean,alpha_value]. For example: \"[[True,0.001234],[False,0.0],...]\". The $\\alpha$ values must be rounded to six significant figures and expressed as decimal floating-point numbers (dimensionless).",
            "solution": "The problem requires an evaluation of the conditions for the vertical shear instability (VSI) in a circumplanetary disk and an estimation of the resulting turbulent stress, quantified by the Shakura–Sunyaev parameter $\\alpha$. The solution follows a deterministic sequence of calculations based on a simplified physical model of the disk's thermodynamics and dynamics.\n\nThe analysis begins with the calculation of fundamental local disk properties from the given input parameters for each test case: planetary mass $M_p$, orbital radius $R$, local temperature $T$, radial temperature gradient $dT/dR$, dust-to-gas ratio $f_d$, and baseline cooling time $\\tau_0$.\n\nFirst, we establish the thermodynamic and kinematic state of the gas. The isothermal sound speed, $c_s$, is determined by the local temperature and gas composition. For an ideal gas, this is given by:\n$$c_s = \\sqrt{\\frac{k_B T}{\\mu m_H}}$$\nwhere $k_B$ is the Boltzmann constant, $\\mu$ is the mean molecular weight, and $m_H$ is the mass of a hydrogen atom.\n\nThe dynamics are governed by the central planet's gravity. The Keplerian orbital velocity, $v_K$, at a radius $R$ from a planet of mass $M_p$ is:\n$$v_K = \\sqrt{\\frac{G M_p}{R}}$$\nwhere $G$ is the gravitational constant. The corresponding Keplerian angular frequency, $\\Omega$, is:\n$$\\Omega = \\frac{v_K}{R} = \\sqrt{\\frac{G M_p}{R^3}}$$\n\nA key structural parameter of the disk is its vertical thickness relative to its radius, known as the disk aspect ratio, $h$. It is defined by the ratio of the gas pressure scale height $H$ to the radius $R$, which is equivalent to the ratio of the sound speed to the Keplerian velocity:\n$$h = \\frac{H}{R} = \\frac{c_s}{v_K}$$\n\nThe driving force for the VSI is baroclinicity, stemming from a radial temperature gradient. This is quantified by the dimensionless parameter $q$:\n$$q \\equiv \\frac{d \\ln T}{d \\ln R} = \\frac{R}{T} \\frac{dT}{dR}$$\nA negative value of $q$ indicates that temperature decreases with radius, which is a common condition in astrophysical disks and is necessary for this instability. If $q=0$, there is no baroclinic driving term, and the instability is inoperable, leading to $\\alpha=0$.\n\nThe VSI is a thermal instability whose operation depends on the gas being able to cool efficiently. The thermal relaxation time, or cooling time $\\tau_{\\mathrm{cool}}$, must be sufficiently short. The problem provides a model where cooling time increases with the dust-to-gas ratio $f_d$ due to increased opacity:\n$$\\tau_{\\mathrm{cool}} = \\tau_0 (1 + A f_d)$$\nwhere $\\tau_0$ is the baseline cooling time in a dust-free gas and $A$ is an opacity sensitivity factor.\n\nThe linear stability criterion for the VSI is given as an inequality involving the dimensionless cooling time, $\\Omega \\tau_{\\mathrm{cool}}$, and a critical threshold, $\\beta_{\\mathrm{crit}}$. The instability can only grow if the cooling is fast enough, i.e., if the dimensionless cooling time is below the critical threshold:\n$$\\Omega \\tau_{\\mathrm{cool}}  \\beta_{\\mathrm{crit}}$$\nThe critical threshold $\\beta_{\\mathrm{crit}}$ itself depends on the local thermodynamic properties of the disk. Disks with stronger baroclinicity (larger $|q|$) and larger relative thickness (larger $h$) are more susceptible to the instability, which is captured by the relation:\n$$\\beta_{\\mathrm{crit}} = \\frac{h}{|q|}$$\nThis is valid for $|q|  0$.\n\nIf the instability criterion is not met, the disk is stable, and the turbulent stress parameter is $\\alpha = 0$. If the criterion is satisfied, the instability is active. The fastest linear growth rate, $\\sigma$, is then estimated using the provided model:\n$$\\sigma = c_g |q| h \\Omega \\sqrt{1 - \\frac{\\Omega \\tau_{\\mathrm{cool}}}{\\beta_{\\mathrm{crit}}}}$$\nHere, $c_g$ is a growth efficiency factor. This formula correctly shows that the growth rate is maximal for very short cooling times ($\\tau_{\\mathrm{cool}} \\to 0$) and vanishes as the cooling time approaches the critical value ($\\Omega \\tau_{\\mathrm{cool}} \\to \\beta_{\\mathrm{crit}}$).\n\nFinally, the saturated turbulent stress, represented by the Shakura–Sunyaev parameter $\\alpha$, is estimated using a mixing-length closure. This relates the stress to the turbulent velocity and the characteristic length scale of the turbulence. The provided scaling is:\n$$\\alpha = \\frac{\\chi}{2\\pi} \\frac{\\sigma}{\\Omega}$$\nwhere $\\chi$ is a saturation efficiency parameter. This estimate connects the linear growth rate of the instability to the eventual nonlinear saturated state of turbulence.\n\nThe computational procedure for each test case is as follows:\n1. Calculate $q$, $c_s$, $v_K$, $\\Omega$, $h$, and $\\tau_{\\mathrm{cool}}$ from the input parameters and physical constants.\n2. Check if $|q| = 0$. If so, the instability is inactive, and $\\alpha = 0.0$.\n3. If $|q|  0$, calculate $\\beta_{\\mathrm{crit}} = h/|q|$.\n4. Evaluate the instability criterion: $\\Omega \\tau_{\\mathrm{cool}}  \\beta_{\\mathrm{crit}}$.\n5. If the criterion is not met, the instability is inactive, and $\\alpha = 0.0$.\n6. If the criterion is met, the instability is active. Calculate the growth rate $\\sigma$ and then the stress parameter $\\alpha$ using the respective formulas.\n7. The final value of $\\alpha$ is rounded to six significant figures.\n8. The output for the case is a list containing a boolean for activity status and the calculated value of $\\alpha$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Evaluates the conditions for vertical shear instability in a circumplanetary disk\n    and estimates the Shakura-Sunyaev stress parameter alpha for a suite of test cases.\n    \"\"\"\n\n    # Physical and model constants\n    G = 6.6743e-11        # Gravitational constant (m^3 kg^-1 s^-2)\n    KB = 1.380649e-23       # Boltzmann constant (J K^-1)\n    MH = 1.6735575e-27      # Atomic mass unit of hydrogen (kg)\n    MU = 2.34               # Mean molecular weight\n    A = 20.0                # Opacity sensitivity factor\n    C_G = 0.5               # Growth efficiency factor\n    CHI = 0.5               # Saturation efficiency factor\n\n    # Test cases\n    test_cases = [\n        # Case 1: Standard case\n        (1.898e27, 2.1e9, 200, -1.0e-7, 0.01, 1.0e4),\n        # Case 2: Near-threshold cooling\n        (1.898e27, 2.1e9, 200, -1.0e-7, 0.0, 2.92e4),\n        # Case 3: No baroclinic driver\n        (1.898e27, 2.1e9, 200, 0.0, 0.10, 1.0e4),\n        # Case 4: Outer disk, stronger |q|\n        (1.898e27, 4.2e9, 120, -5.0e-8, 0.02, 1.0e4),\n        # Case 5: High dust, long cooling\n        (1.898e27, 2.1e9, 200, -1.0e-7, 5.0, 1.0e4),\n        # Case 6: Lower-mass planet\n        (3.796e26, 2.1e9, 200, -1.0e-7, 0.10, 1.0e4),\n    ]\n\n    results = []\n\n    def round_to_sf(x, sf):\n        \"\"\"Rounds a number x to a specified number of significant figures sf.\"\"\"\n        if x == 0:\n            return 0.0\n        # Calculate the number of decimal places needed for rounding\n        # np.floor(np.log10(np.abs(x))) gives the order of magnitude\n        # e.g. for 123 it is 2, for 0.0123 it is -2\n        round_to_dp = sf - 1 - int(np.floor(np.log10(np.abs(x))))\n        return np.round(x, round_to_dp)\n\n    for case in test_cases:\n        m_p, r, t, dt_dr, f_d, tau_0 = case\n\n        # Calculate intermediate parameters\n        q = (r / t) * dt_dr\n        abs_q = np.abs(q)\n\n        # If no baroclinic driver, instability is disallowed\n        if abs_q == 0:\n            is_active = False\n            alpha = 0.0\n            results.append([is_active, alpha])\n            continue\n\n        c_s = np.sqrt(KB * t / (MU * MH))\n        v_k = np.sqrt(G * m_p / r)\n        omega = v_k / r\n        h = c_s / v_k\n        tau_cool = tau_0 * (1.0 + A * f_d)\n        \n        # Calculate instability threshold\n        beta_crit = h / abs_q\n        \n        # Check instability criterion\n        is_active = (omega * tau_cool)  beta_crit\n\n        if is_active:\n            # Calculate growth rate sigma\n            sqrt_term = np.sqrt(1.0 - (omega * tau_cool) / beta_crit)\n            sigma = C_G * abs_q * h * omega * sqrt_term\n            \n            # Calculate alpha\n            alpha_raw = (CHI / (2.0 * np.pi)) * (sigma / omega)\n            alpha = round_to_sf(alpha_raw, 6)\n        else:\n            alpha = 0.0\n            \n        results.append([is_active, alpha])\n\n    # Format the final output string exactly as required, with no spaces\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}