{
    "hands_on_practices": [
        {
            "introduction": "行星周盘的热结构是其演化和卫星形成能力的基础。本练习将引导你掌握一个关键物理量——光学厚度，它衡量了气体和尘埃对辐射的不透明度。通过从基本物理量（如表面密度和不透明度）推导和计算光学厚度，你将能够判断盘在特定位置是“光学厚”还是“光学薄”，这是理解盘内能量输运机制的决定性一步 ()。",
            "id": "4155783",
            "problem": "在一个木星质量行星周围的环行星盘（CPD）中，于某一半径处进行局域建模，该处的垂直结构近似为等温，且气体和尘埃充分混合。请使用辐射转移（RT）的框架，考虑辐射在该位置通过盘柱的垂直输运。在由冰质尘埃主导的温度区间内，罗斯兰平均不透明度（RMO）可用定律 $\\kappa_{\\mathrm{R}}=\\kappa_{0} T^{2}$（cgs单位制）来近似，其中 $\\kappa_{0}=2 \\times 10^{-4}$，不透明度 $\\kappa_{\\mathrm{R}}$ 的单位为 $\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$，温度 $T$ 的单位为 $\\mathrm{K}$。当地的面密度为 $\\Sigma$，且垂直密度剖面关于中平面对称。假设在计算贯穿盘柱的积分时，可以认为RMO在整个垂直柱上与高度无关。\n\n请仅从路径上的光学深度定义 $d \\tau = \\kappa \\rho \\, dz$ 和面密度定义 $\\Sigma = \\int_{-\\infty}^{+\\infty} \\rho \\, dz$ 出发，推导一个用 $\\kappa$ 和 $\\Sigma$ 表示的、从中平面到盘面的垂直光学深度的表达式。然后，使用温度 $T = 120$ K 和面密度 $\\Sigma = 300$ g cm$^{-2}$，对此光学深度进行数值计算。最后，根据 $\\tau \\gg 1$ 或 $\\tau \\ll 1$ 的判断，说明该位置适用于哪种辐射转移机制。\n\n报告的光学深度应为一个无量纲实数，并四舍五入至三位有效数字。最终报告的数值中不应包含任何单位。应对机制的定性评估加以解释，但最终报告的值必须仅为光学深度。",
            "solution": "经评估，问题陈述有效。其科学基础扎根于天体物理盘中的辐射转移原理，问题设置得当，目标明确，数据充分，语言客观。在“近似等温”结构和指定单一温度进行评估的背景下，垂直方向不透明度恒定的简化假设是一种标准的教学简化方法，并不构成矛盾。本题将按陈述进行求解。\n\n本题要求推导一个从中平面到环行星盘表面的垂直光学深度的表达式，随后进行数值计算，并对辐射转移机制进行定性评估。\n\n首先，我们从沿垂直路径 $z$ 的微分光学深度 $d\\tau$ 的定义开始：\n$$\nd\\tau_z = \\kappa \\rho \\, dz\n$$\n其中 $\\kappa$ 是不透明度，$\\rho$ 是质量密度。我们记从中平面（定义为 $z=0$）到盘面（$z \\to \\infty$）的垂直光学深度为 $\\tau$，它是该量的积分：\n$$\n\\tau = \\int_{0}^{\\infty} \\kappa_{\\mathrm{R}}(z) \\rho(z) \\, dz\n$$\n这里，我们使用指定的罗斯兰平均不透明度 $\\kappa_{\\mathrm{R}}$。问题陈述假设在进行此积分时，$\\kappa_{\\mathrm{R}}$ 可被视为与高度 $z$ 无关。这使我们可以将 $\\kappa_{\\mathrm{R}}$ 从积分中提取出来：\n$$\n\\tau = \\kappa_{\\mathrm{R}} \\int_{0}^{\\infty} \\rho(z) \\, dz\n$$\n接下来，我们使用面密度 $\\Sigma$ 的定义，它是沿整个盘高积分的单位面积柱体中的总质量：\n$$\n\\Sigma = \\int_{-\\infty}^{+\\infty} \\rho(z) \\, dz\n$$\n问题指明，垂直密度剖面关于中平面对称，即 $\\rho(z) = \\rho(-z)$。由于这种对称性，密度从 $-\\infty$到 $+\\infty$ 的积分恰好是从 $0$ 到 $+\\infty$ 积分的两倍：\n$$\n\\Sigma = \\int_{-\\infty}^{0} \\rho(z) \\, dz + \\int_{0}^{+\\infty} \\rho(z) \\, dz = 2 \\int_{0}^{+\\infty} \\rho(z) \\, dz\n$$\n根据这个关系，我们可以用面密度表示我们需要的积分：\n$$\n\\int_{0}^{+\\infty} \\rho(z) \\, dz = \\frac{\\Sigma}{2}\n$$\n将此代入我们的光学深度 $\\tau$ 表达式中，我们得到所需的关系：\n$$\n\\tau = \\kappa_{\\mathrm{R}} \\frac{\\Sigma}{2}\n$$\n这就是从中平面到盘面的垂直光学深度的表达式。\n\n现在，我们进行数值计算。给定不透明度定律 $\\kappa_{\\mathrm{R}} = \\kappa_0 T^2$，其中常数 $\\kappa_0 = 2 \\times 10^{-4} \\, \\mathrm{cm}^2 \\, \\mathrm{g}^{-1} \\, \\mathrm{K}^{-2}$，温度 $T = 120 \\, \\mathrm{K}$。首先，我们计算罗斯兰平均不透明度的值：\n$$\n\\kappa_{\\mathrm{R}} = (2 \\times 10^{-4}) \\times (120)^2 = (2 \\times 10^{-4}) \\times 14400 = 2.88 \\, \\mathrm{cm}^2 \\, \\mathrm{g}^{-1}\n$$\n接下来，我们使用导出的 $\\tau$ 公式，并代入计算出的 $\\kappa_{\\mathrm{R}}$ 和给定的面密度 $\\Sigma = 300 \\, \\mathrm{g} \\, \\mathrm{cm}^{-2}$。\n$$\n\\tau = \\frac{(2.88 \\, \\mathrm{cm}^2 \\, \\mathrm{g}^{-1}) \\times (300 \\, \\mathrm{g} \\, \\mathrm{cm}^{-2})}{2}\n$$\n单位相消，得到一个无量纲的光学深度，符合预期。\n$$\n\\tau = \\frac{2.88 \\times 300}{2} = 2.88 \\times 150 = 432\n$$\n问题要求结果四舍五入到三位有效数字。计算值 $432$ 已恰好有三位有效数字。\n\n最后，我们必须确定辐射转移机制。两种主要的机制是光学薄（$\\tau \\ll 1$）和光学厚（$\\tau \\gg 1$）。我们计算出的值为 $\\tau = 432$。因为 $432$ 远大于 $1$，所以该位置的盘被描述为**光学厚**的。在光学厚介质中，光子在传播时会经历多次吸收和再发射，其输运过程可以用扩散过程来描述。",
            "answer": "$$\n\\boxed{432}\n$$"
        },
        {
            "introduction": "在理解了盘的局部热力学性质之后，我们进一步构建其宏观的全局结构。行星周盘的表面密度分布 $\\Sigma(R)$ 是由通过盘的物质流所决定的，该物质流受到外部注入、向行星的吸积以及卫星形成的共同影响。本练习将指导你建立一个一维稳态模型，通过应用质量守恒和粘滞性角动量输运理论，来计算表面密度剖面，从而将微观的粘滞物理与可观测的宏观盘结构联系起来 ()。",
            "id": "4155767",
            "problem": "设计并实现一个完整的、可运行的程序，该程序模拟一个一维、轴对称、稳态的环行星盘（CPD, Circumplanetary Disk）。该环行星盘在外部边界有质量流入，并通过向行星的吸积以及在一个有限环带内分布的卫星形成过程来消耗质量。该模型必须从基本原理推导得出：质量守恒和角动量通过有效粘滞度进行输运。程序必须通过应用稳态质量平衡和标准的粘滞输运闭包来计算面密度随半径变化的剖面。所有数学实体都必须使用 LaTeX 表示。\n\n假设该盘在几何上是薄的、开普勒式的，并且在垂直方向上是等温的。令 $R$ 表示距行星中心的柱坐标半径。令 $R_{\\rm in}$ 和 $R_{\\rm out}$ 分别表示内边界和外边界。令在 $R_{\\rm out}$ 处的向内质量流入为 $\\dot{M}_{\\rm in}$（单位 $\\mathrm{kg\\,s^{-1}}$）。令卫星形成在一个环带 $[R_1,R_2]$ 内充当一个分布式汇，其单位面积的表面汇分布是均匀的，总汇率为 $\\dot{M}_s$（单位 $\\mathrm{kg\\,s^{-1}}$）。向行星的吸积率为 $\\dot{M}_p$（单位 $\\mathrm{kg\\,s^{-1}}$），在稳态下等于在 $R_{\\rm in}$ 处的净向内质量通量。盘的运动粘滞度由 $\\alpha$-模型描述：\n$$\n\\nu(R) = \\alpha \\frac{c_s^2(R)}{\\Omega_K(R)},\n$$\n其中 $\\alpha$ 是无量纲的，$c_s(R)$ 是等温声速，$\\Omega_K(R)$ 是开普勒角频率。取\n$$\nc_s(R) = \\sqrt{\\frac{k_{\\rm B}\\,T(R)}{\\mu m_{\\rm H}}}, \\quad \\Omega_K(R) = \\sqrt{\\frac{G M_{\\rm pl}}{R^3}},\n$$\n其中 $k_{\\rm B}$ 是玻尔兹曼常数，$m_{\\rm H}$ 是氢原子质量，$\\mu$ 是平均分子量，$G$ 是引力常数，$M_{\\rm pl}$ 是行星质量。温度剖面规定为幂律形式\n$$\nT(R) = T_0 \\left(\\frac{R}{R_0}\\right)^{-q}.\n$$\n\n基本原理和推导要求：\n- 从柱对称下的稳态连续性方程开始，\n$$\n\\frac{1}{R}\\frac{d}{dR}\\big(R\\,\\Sigma\\,v_R\\big) = S(R),\n$$\n其中 $\\Sigma(R)$ 是面密度（单位 $\\mathrm{kg\\,m^{-2}}$），$v_R(R)$ 是径向速度（对于向内流动为负），$S(R)$ 是单位面积的净源项（单位 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$）。定义向内质量通量为正量\n$$\n\\dot{M}(R) \\equiv -2\\pi R\\,\\Sigma(R)\\,v_R(R).\n$$\n积分连续性方程以获得 $\\dot{M}(R)$ 与分布式汇的关系。然后，利用薄粘滞盘在稳态流入和可忽略的外部扭矩下的角动量输运，推导出经过充分检验的闭包关系，该关系将局部向内质量通量与粘滞度和面密度联系起来，并用它来表示 $\\Sigma(R)$ 与 $\\dot{M}(R)$ 和 $\\nu(R)$ 的关系。\n\n实现要求：\n- 通过选择一个归一化分布函数 $g(R)$，将卫星形成的汇模拟为在 $[R_1,R_2]$ 上均匀分布，使得\n$$\n\\int_{R_1}^{R_2} 2\\pi R\\,g(R)\\,dR = 1, \\quad g(R) = \\frac{1}{\\pi\\left(R_2^2-R_1^2\\right)} \\ \\text{for}\\ R\\in[R_1,R_2], \\ \\text{and} \\ g(R)=0 \\ \\text{otherwise}.\n$$\n令 $S(R) = -\\dot{M}_s\\,g(R)$，因此总汇等于 $\\dot{M}_s$。\n- 从连续性方程，得到\n$$\n\\frac{d\\dot{M}}{dR} = -2\\pi R\\,S(R),\n$$\n并从 $R$ 积分到 $R_{\\rm out}$ 以获得 $\\dot{M}(R)$ 与 $\\dot{M}_{\\rm in}$ 和分布式汇的关系。对于均匀环形汇，这将产生一个分段表达式，表示在 $R$ 外部的汇的比例，\n$$ f(R) \\equiv \\int_{R}^{R_{\\rm out}} 2\\pi r\\,g(r)\\,dr = \\begin{cases} 1,  R \\le R_1 \\\\ \\frac{R_2^2 - R^2}{R_2^2 - R_1^2},  R_1  R  R_2 \\\\ 0,  R \\ge R_2 \\end{cases} $$\n以及\n$$\n\\dot{M}(R) = \\dot{M}_{\\rm in} - \\dot{M}_s\\,f(R).\n$$\n- 使用标准的稳态薄盘角动量输运关系来闭合系统并计算面密度剖面为\n$$\n\\Sigma(R) = \\frac{\\dot{M}(R)}{3\\pi\\,\\nu(R)}.\n$$\n- 计算 $\\dot{M}_p = \\dot{M}(R_{\\rm in})$ 并验证稳态质量平衡 $\\dot{M}_{\\rm in} = \\dot{M}_p + \\dot{M}_s$ 在指定的数值容差内成立。\n\n使用的物理常数：\n- $G = 6.6743\\times 10^{-11}\\ \\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$\n- $k_{\\rm B} = 1.380649\\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$\n- $m_{\\rm H} = 1.6735575\\times 10^{-27}\\ \\mathrm{kg}$\n- $\\mu = 2.34$\n- $R_{\\rm J} = 7.1492\\times 10^7\\ \\mathrm{m}$\n\n单位和输出：\n- 半径必须以米为单位处理。温度以开尔文为单位。质量速率以 $\\mathrm{kg\\,s^{-1}}$ 为单位。面密度必须以 $\\mathrm{kg\\,m^{-2}}$ 为单位报告。\n- 对于每个测试用例，在一组指定的半径处计算 $\\Sigma(R)$，并以 $\\mathrm{kg\\,m^{-2}}$ 为单位报告这些值，每个值四舍五入到三位有效数字。同时报告一个布尔值，指示质量平衡 $\\dot{M}_{\\rm in} = \\dot{M}_p + \\dot{M}_s$ 是否在相对容差 $10^{-10}$ 内成立。\n\n测试套件：\n- 使用以下四个测试用例，每个用例由 $(R_{\\rm in}, R_{\\rm out}, \\dot{M}_{\\rm in}, \\dot{M}_s, R_1, R_2, \\alpha, T_0, R_0, q, M_{\\rm pl}, \\{R_i\\})$ 定义，其中 $\\{R_i\\}$ 是计算 $\\Sigma$ 的半径集合。\n\n1. 正常路径CPD：\n    - $R_{\\rm in} = 2\\,R_{\\rm J}$, $R_{\\rm out} = 200\\,R_{\\rm J}$\n    - $\\dot{M}_{\\rm in} = 1.0\\times 10^{14}\\ \\mathrm{kg\\,s^{-1}}$, $\\dot{M}_s = 3.0\\times 10^{13}\\ \\mathrm{kg\\,s^{-1}}$\n    - $R_1 = 20\\,R_{\\rm J}$, $R_2 = 40\\,R_{\\rm J}$\n    - $\\alpha = 1.0\\times 10^{-3}$\n    - $T_0 = 200\\ \\mathrm{K}$, $R_0 = 20\\,R_{\\rm J}$, $q = 0.5$\n    - $M_{\\rm pl} = 1.898\\times 10^{27}\\ \\mathrm{kg}$\n    - $\\{R_i\\} = \\{5\\,R_{\\rm J}, 20\\,R_{\\rm J}, 50\\,R_{\\rm J}, 100\\,R_{\\rm J}\\}$\n\n2. 无卫星汇：\n    - $R_{\\rm in} = 2\\,R_{\\rm J}$, $R_{\\rm out} = 200\\,R_{\\rm J}$\n    - $\\dot{M}_{\\rm in} = 2.0\\times 10^{13}\\ \\mathrm{kg\\,s^{-1}}$, $\\dot{M}_s = 0$\n    - $R_1 = 20\\,R_{\\rm J}$, $R_2 = 40\\,R_{\\rm J}$ (当 $\\dot{M}_s=0$ 时无关紧要)\n    - $\\alpha = 5.0\\times 10^{-3}$\n    - $T_0 = 300\\ \\mathrm{K}$, $R_0 = 20\\,R_{\\rm J}$, $q = 0.5$\n    - $M_{\\rm pl} = 1.898\\times 10^{27}\\ \\mathrm{kg}$\n    - $\\{R_i\\} = \\{5\\,R_{\\rm J}, 20\\,R_{\\rm J}, 50\\,R_{\\rm J}, 100\\,R_{\\rm J}\\}$\n\n3. 强内部汇环：\n    - $R_{\\rm in} = 2\\,R_{\\rm J}$, $R_{\\rm out} = 100\\,R_{\\rm J}$\n    - $\\dot{M}_{\\rm in} = 8.0\\times 10^{13}\\ \\mathrm{kg\\,s^{-1}}$, $\\dot{M}_s = 7.5\\times 10^{13}\\ \\mathrm{kg\\,s^{-1}}$\n    - $R_1 = 5\\,R_{\\rm J}$, $R_2 = 10\\,R_{\\rm J}$\n    - $\\alpha = 1.0\\times 10^{-3}$\n    - $T_0 = 150\\ \\mathrm{K}$, $R_0 = 20\\,R_{\\rm J}$, $q = 0.6$\n    - $M_{\\rm pl} = 1.898\\times 10^{27}\\ \\mathrm{kg}$\n    - $\\{R_i\\} = \\{3\\,R_{\\rm J}, 6\\,R_{\\rm J}, 12\\,R_{\\rm J}, 30\\,R_{\\rm J}\\}$\n\n4. 低粘滞度、宽汇环：\n    - $R_{\\rm in} = 2\\,R_{\\rm J}$, $R_{\\rm out} = 200\\,R_{\\rm J}$\n    - $\\dot{M}_{\\rm in} = 5.0\\times 10^{12}\\ \\mathrm{kg\\,s^{-1}}$, $\\dot{M}_s = 2.0\\times 10^{12}\\ \\mathrm{kg\\,s^{-1}}$\n    - $R_1 = 50\\,R_{\\rm J}$, $R_2 = 150\\,R_{\\rm J}$\n    - $\\alpha = 1.0\\times 10^{-4}$\n    - $T_0 = 120\\ \\mathrm{K}$, $R_0 = 50\\,R_{\\rm J}$, $q = 1.0$\n    - $M_{\\rm pl} = 1.898\\times 10^{27}\\ \\mathrm{kg}$\n    - $\\{R_i\\} = \\{10\\,R_{\\rm J}, 60\\,R_{\\rm J}, 120\\,R_{\\rm J}, 180\\,R_{\\rm J}\\}$\n\n最终输出格式：\n- 你的程序应该生成一行输出，包含一个用方括号括起来的逗号分隔列表。每个元素对应一个测试用例，其本身是一个 $[\\,[\\Sigma(R_1),\\Sigma(R_2),\\ldots],\\,\\mathrm{boolean}\\,]$ 形式的列表，其中内部列表包含以 $\\mathrm{kg\\,m^{-2}}$ 为单位且四舍五入到三位有效数字的面密度，布尔值指示 $\\dot{M}_{\\rm in} = \\dot{M}_p + \\dot{M}_s$ 是否在相对容差 $10^{-10}$ 内成立。例如：$[[[1.23\\mathrm{e}5,4.56\\mathrm{e}4,7.89\\mathrm{e}3],\\mathrm{True}],\\ldots]$。",
            "solution": "目标是计算一个一维、轴对称的环行星盘（CPD）的稳态面密度剖面 $\\Sigma(R)$。该盘在其外边界有指定的质量流入，并通过向中心行星的吸积和在指定径向区域内形成卫星而损失质量。该模型基于粘滞盘中质量和角动量守恒的基本原理。\n\n首先，我们从质量守恒方程开始，也称为连续性方程。对于稳态（$\\partial/\\partial t = 0$）、轴对称（$\\partial/\\partial\\phi = 0$）的盘，在柱坐标系 $(R, \\phi, z)$ 中，经过垂直积分后，连续性方程由下式给出：\n$$\n\\frac{1}{R}\\frac{d}{dR}\\left(R\\,\\Sigma(R)\\,v_R(R)\\right) = S(R)\n$$\n其中 $\\Sigma(R)$ 是面质量密度，单位为 $\\mathrm{kg\\,m^{-2}}$；$v_R(R)$ 是垂直平均的径向速度，单位为 $\\mathrm{m\\,s^{-1}}$（向内流动为负）；$S(R)$ 是单位面积的净质量源或汇，单位为 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$。\n\n为了方便，我们将给定半径 $R$ 处的净向内质量通量（吸积率）定义为正值：\n$$\n\\dot{M}(R) \\equiv -2\\pi R\\,\\Sigma(R)\\,v_R(R)\n$$\n单位为 $\\mathrm{kg\\,s^{-1}}$。将 $\\dot{M}(R)$ 对 $R$ 求导，得到：\n$$\n\\frac{d\\dot{M}}{dR} = -2\\pi\\frac{d}{dR}\\left(R\\,\\Sigma\\,v_R\\right)\n$$\n将连续性方程代入此表达式，我们发现质量通量的变化与局部源/汇项之间的关系：\n$$\n\\frac{d\\dot{M}}{dR} = -2\\pi R\\,S(R)\n$$\n问题指定了一个汇项 $S(R)$，表示在半径 $R_1$ 和 $R_2$ 之间的环带中形成卫星，总汇率为 $\\dot{M}_s$。因此源项为 $S(R) = -\\dot{M}_s g(R)$，其中 $g(R)$ 是一个归一化分布函数。对于环带 $[R_1, R_2]$ 上单位面积的均匀汇，$g(R)$ 在此区间内为常数，在其他地方为零。归一化条件 $\\int_{R_1}^{R_2} 2\\pi R\\,g(R)\\,dR = 1$ 给出：\n$$\ng(R) = \\frac{1}{\\pi\\left(R_2^2-R_1^2\\right)} \\quad \\text{for} \\quad R \\in [R_1, R_2]\n$$\n为了找到质量通量剖面 $\\dot{M}(R)$，我们将 $\\frac{d\\dot{M}}{dR}$ 从任意半径 $R$ 积分到盘的外边界 $R_{\\rm out}$：\n$$\n\\int_R^{R_{\\rm out}} \\frac{d\\dot{M}}{dr} dr = \\dot{M}(R_{\\rm out}) - \\dot{M}(R)\n$$\n这必须等于在相同区间上对汇项的积分：\n$$\n\\dot{M}(R_{\\rm out}) - \\dot{M}(R) = \\int_R^{R_{\\rm out}} -2\\pi r S(r) dr = \\int_R^{R_{\\rm out}} 2\\pi r \\dot{M}_s g(r) dr = \\dot{M}_s \\int_R^{R_{\\rm out}} 2\\pi r g(r) dr\n$$\n我们将外边界的质量流入率定义为 $\\dot{M}_{\\rm in} \\equiv \\dot{M}(R_{\\rm out})$，将在 $R$ 外部的汇的积分分数定义为 $f(R) \\equiv \\int_R^{R_{\\rm out}} 2\\pi r g(r) dr$。于是质量通量剖面为：\n$$\n\\dot{M}(R) = \\dot{M}_{\\rm in} - \\dot{M}_s f(R)\n$$\n函数 $f(R)$ 是一个分段函数，由 $R$ 相对于汇区 $[R_1, R_2]$ 的位置决定。计算 $f(R)$ 的积分得出：\n$$ f(R) = \\begin{cases} 1,  R \\le R_1 \\\\ \\frac{R_2^2 - R^2}{R_2^2 - R_1^2},  R_1  R  R_2 \\\\ 0,  R \\ge R_2 \\end{cases} $$\n接下来，我们应用薄粘滞开普勒盘中的角动量输运理论。在稳态下，净粘滞力矩必须平衡角动量的平流。在边界力矩可忽略的简化下（在远离盘内缘处有效），局部向内质量通量与面密度 $\\Sigma(R)$ 和运动粘滞度 $\\nu(R)$ 通过标准闭包关系相关联：\n$$\n\\dot{M}(R) = 3\\pi \\nu(R) \\Sigma(R)\n$$\n这使我们能够求解面密度：\n$$\n\\Sigma(R) = \\frac{\\dot{M}(R)}{3\\pi \\nu(R)}\n$$\n运动粘滞度 $\\nu(R)$ 使用 alpha 模型进行建模：\n$$\n\\nu(R) = \\alpha \\frac{c_s^2(R)}{\\Omega_K(R)}\n$$\n其中 $\\alpha$ 是一个无量纲参数，$c_s(R)$ 是局部声速，$\\Omega_K(R)$ 是开普勒角频率。它们由下式给出：\n$$\nc_s(R) = \\sqrt{\\frac{k_{\\rm B} T(R)}{\\mu m_{\\rm H}}} \\quad \\text{and} \\quad \\Omega_K(R) = \\sqrt{\\frac{G M_{\\rm pl}}{R^3}}\n$$\n这里，$k_{\\rm B}$ 是玻尔兹曼常数，$T(R)$ 是盘的温度，$\\mu$ 是平均分子量，$m_{\\rm H}$ 是氢原子质量，$G$ 是引力常数，$M_{\\rm pl}$ 是行星的质量。温度剖面以幂律形式给出：\n$$\nT(R) = T_0 \\left(\\frac{R}{R_0}\\right)^{-q}\n$$\n将这些表达式代入 $\\nu(R)$ 的公式中，我们得到一个关于半径的显式函数：\n$$\n\\nu(R) = \\alpha \\left( \\frac{k_{\\rm B} T_0}{\\mu m_{\\rm H}} \\left(\\frac{R}{R_0}\\right)^{-q} \\right) \\left( \\frac{G M_{\\rm pl}}{R^3} \\right)^{-1/2} = \\alpha \\frac{k_{\\rm B} T_0}{\\mu m_{\\rm H}} \\frac{R_0^q}{\\sqrt{G M_{\\rm pl}}} R^{3/2 - q}\n$$\n通过组合所有这些元素，我们得到了面密度剖面的最终表达式：\n$$\n\\Sigma(R) = \\frac{\\dot{M}_{\\rm in} - \\dot{M}_s f(R)}{3\\pi \\nu(R)}\n$$\n向行星的吸积率 $\\dot{M}_p$ 是在盘的内边界 $R_{\\rm in}$ 处计算的质量通量：\n$$\n\\dot{M}_p = \\dot{M}(R_{\\rm in}) = \\dot{M}_{\\rm in} - \\dot{M}_s f(R_{\\rm in})\n$$\n由于所有测试用例的结构都使得 $R_{\\rm in} \\le R_1$，我们有 $f(R_{\\rm in}) = 1$。这导致 $\\dot{M}_p = \\dot{M}_{\\rm in} - \\dot{M}_s$，从而证实了总质量平衡方程 $\\dot{M}_{\\rm in} = \\dot{M}_p + \\dot{M}_s$。数值实现将在指定的浮点容差范围内验证此恒等式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the surface density profile of a circumplanetary disk for multiple test cases.\n    \"\"\"\n    # Physical constants in SI units\n    G = 6.6743e-11  # m^3 kg^-1 s^-2\n    K_B = 1.380649e-23  # J K^-1\n    M_H = 1.6735575e-27  # kg\n    MU = 2.34\n    R_J = 7.1492e7  # meters, radius of Jupiter\n\n    def round_to_3_sf(x):\n        \"\"\"Rounds a number to three significant figures.\"\"\"\n        if x == 0:\n            return 0.0\n        return float(f'{x:.2e}')\n\n    def process_case(params):\n        \"\"\"\n        Processes a single test case to compute surface densities and verify mass balance.\n        \"\"\"\n        R_in_Rj, R_out_Rj, M_in, M_s, R1_Rj, R2_Rj, alpha, T0, R0_Rj, q, M_pl, R_i_Rj = params\n\n        # Convert radii from R_J to meters\n        R_in = R_in_Rj * R_J\n        R_out = R_out_Rj * R_J\n        R1 = R1_Rj * R_J\n        R2 = R2_Rj * R_J\n        R0 = R0_Rj * R_J\n        R_i = [r * R_J for r in R_i_Rj]\n\n        # Function for the integrated sink fraction f(R)\n        def f_sink(R):\n            if R = R1:\n                return 1.0\n            elif R1  R  R2:\n                # Handle the case R1=R2 to avoid division by zero\n                if R1 == R2:\n                    return 0.0\n                return (R2**2 - R**2) / (R2**2 - R1**2)\n            else:  # R >= R2\n                return 0.0\n\n        # Function for mass flux M_dot(R)\n        def M_dot(R):\n            return M_in - M_s * f_sink(R)\n\n        # Function for kinematic viscosity nu(R)\n        def nu(R):\n            T_R = T0 * (R / R0)**(-q)\n            cs2_R = K_B * T_R / (MU * M_H)\n            Omega_K_R = np.sqrt(G * M_pl / R**3)\n            return alpha * cs2_R / Omega_K_R\n\n        # Function for surface density Sigma(R)\n        def Sigma(R):\n            current_nu = nu(R)\n            if current_nu == 0:\n                return np.inf\n            return M_dot(R) / (3 * np.pi * current_nu)\n\n        # Compute surface density at specified radii\n        sigma_values = [round_to_3_sf(Sigma(r)) for r in R_i]\n\n        # Verify mass balance\n        M_p = M_dot(R_in)\n        # Check if M_in is non-zero to avoid division by zero in relative tolerance check\n        if M_in != 0:\n            mass_balance_holds = np.isclose(M_in, M_p + M_s, rtol=1e-10)\n        else: # If M_in is zero, M_p + M_s should also be zero\n            mass_balance_holds = np.isclose(M_p + M_s, 0, atol=1e-12) # Use absolute tol for zero case\n\n        return sigma_values, bool(mass_balance_holds)\n    \n    # Define the test cases from the problem statement\n    test_cases = [\n        # Case 1: Happy path CPD\n        (2.0, 200.0, 1.0e14, 3.0e13, 20.0, 40.0, 1.0e-3, 200.0, 20.0, 0.5, 1.898e27, [5.0, 20.0, 50.0, 100.0]),\n        # Case 2: No satellite sink\n        (2.0, 200.0, 2.0e13, 0.0, 20.0, 40.0, 5.0e-3, 300.0, 20.0, 0.5, 1.898e27, [5.0, 20.0, 50.0, 100.0]),\n        # Case 3: Strong inner sink ring\n        (2.0, 100.0, 8.0e13, 7.5e13, 5.0, 10.0, 1.0e-3, 150.0, 20.0, 0.6, 1.898e27, [3.0, 6.0, 12.0, 30.0]),\n        # Case 4: Low viscosity, wide sink ring\n        (2.0, 200.0, 5.0e12, 2.0e12, 50.0, 150.0, 1.0e-4, 120.0, 50.0, 1.0, 1.898e27, [10.0, 60.0, 120.0, 180.0])\n    ]\n\n    results_str_list = []\n    for case in test_cases:\n        sigma_vals, balance_ok = process_case(case)\n        # Format sigma values to avoid spaces\n        sigma_str = '[' + ','.join(map(str, sigma_vals)) + ']'\n        # Format the whole result for this case\n        case_result_str = '[' + sigma_str + ',' + str(balance_ok) + ']'\n        results_str_list.append(case_result_str)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results_str_list)}]\")\n\n\nsolve()\n```"
        },
        {
            "introduction": "掌握了气体盘的结构后，我们现在来探讨核心问题：卫星是如何形成的。本练习将聚焦于“流体不稳定性” (streaming instability) 这一前沿理论，它被认为是将尘埃颗粒聚集形成卫星星子（satellitesimals）的关键机制。你将通过一个计算实践，整合前面所学的气体盘物理（如密度和温度分布）与尘埃颗粒的空气动力学特性，来判断在盘的哪些区域可以触发这种不稳定性，从而定位出潜在的“卫星苗圃” ()。",
            "id": "4155782",
            "problem": "您的任务是设计并实现一个完整的、可运行的程序，用于评估流不稳定性在行星周围盘（CPD）中的触发位置，并针对几个测试案例返回满足触发标准的半径集合。您的解决方案必须从基本定义和经过充分检验的物理关系出发，并且必须明确说明并一致地使用单位。输出必须是单行文本，包含所有测试案例的结果，并按下文规定的方式进行汇总。\n\n物理设置为一个几何薄的CPD，围绕一颗质量为 $M_p$ 的行星进行开普勒旋转。假设盘在垂直方向上是等温的，并处于流体静力学平衡状态，应用以下基本原理：\n\n- 牛顿引力，其中引力常数为 $G$，开普勒角频率为 $\\Omega_K(r) = \\sqrt{G M_p / r^3}$，开普勒轨道速度为 $v_K(r) = r \\, \\Omega_K(r)$。\n- 理想气体，其等温声速为 $c_s(r) = \\sqrt{k_B T(r) / (\\mu m_p)}$，其中 $k_B$ 是玻尔兹曼常数，$m_p$ 是质子质量，$\\mu$ 是平均分子量。\n- 垂直流体静力学平衡产生高斯垂直密度分布，其标高为 $H(r) = c_s(r) / \\Omega_K(r)$，中平面气体密度为 $\\rho_{g,0}(r) = \\Sigma_g(r) / \\left( \\sqrt{2 \\pi} \\, H(r) \\right)$，其中 $\\Sigma_g(r)$ 是气体表面密度。\n- 对于处于 Epstein 阻力区的小固体，其停止时间为 $t_s(r,s) = \\dfrac{\\rho_s s}{\\rho_{g,0}(r) \\, v_{\\mathrm{th}}(r)}$，其中 $s$ 是颗粒半径，$\\rho_s$ 是固体的内部密度，平均热速度为 $v_{\\mathrm{th}}(r) = \\sqrt{\\dfrac{8}{\\pi}} \\, c_s(r)$。斯托克斯数（Stokes number）为 $St(r,s) = \\Omega_K(r) \\, t_s(r,s)$。\n- 在稳态下，垂直湍流扩散由 Shakura–Sunyaev 湍流扩散系数参数 $\\alpha$ 参数化，尘埃标高为 $H_d(r) = H(r) \\, \\sqrt{\\dfrac{\\alpha}{\\alpha + St(r,s)}}$，中平面尘埃与气体密度比为 $\\epsilon_{\\mathrm{mid}}(r) = \\dfrac{\\rho_{d,0}(r)}{\\rho_{g,0}(r)} = \\dfrac{\\Sigma_d(r)}{\\Sigma_g(r)} \\, \\dfrac{H(r)}{H_d(r)}$，其中 $\\Sigma_d(r)$ 是尘埃表面密度。将局部金属丰度定义为 $Z(r) \\equiv \\Sigma_d(r)/\\Sigma_g(r)$。\n\n采用在原行星盘和行星周围盘中触发流不稳定性时广泛使用的阈值：\n\n- 气动耦合必须在一个有利的窗口内：$St_{\\min} \\le St(r,s) \\le St_{\\max}$，其中 $St_{\\min} = 10^{-2}$ 且 $St_{\\max} = 1$。\n- 中平面尘埃富集必须足够：$\\epsilon_{\\mathrm{mid}}(r) \\ge 1$。\n\n在这些假设下，按以下步骤进行：\n\n- 使用参数化的CPD结构：\n  - 气体表面密度分布 $\\Sigma_g(r) = \\Sigma_0 \\left( \\dfrac{r}{r_0} \\right)^{-p}$。\n  - 温度分布 $T(r) = T_0 \\left( \\dfrac{r}{r_0} \\right)^{-q}$。\n- 尘埃表面密度由基准金属丰度和一个环状增强结构参数化：\n  - $\\Sigma_d(r) = Z_0 \\, \\Sigma_g(r) \\left[ 1 + A \\, \\exp \\left( - \\dfrac{(r - r_{\\mathrm{ring}})^2}{2 w^2} \\right) \\right]$,\n  其中 $A$ 是无量纲振幅，$r_{\\mathrm{ring}}$ 是环中心半径，$w$ 是环的宽度。\n\n您的程序必须：\n\n- 使用常数 $G = 6.67430 \\times 10^{-11} \\ \\mathrm{m^3 \\, kg^{-1} \\, s^{-2}}$，$k_B = 1.380649 \\times 10^{-23} \\ \\mathrm{J \\, K^{-1}}$，$m_p = 1.67262192369 \\times 10^{-27} \\ \\mathrm{kg}$。\n- 使用行星和单位常数 $M_J = 1.898 \\times 10^{27} \\ \\mathrm{kg}$ 和 $R_J = 7.1492 \\times 10^{7} \\ \\mathrm{m}$，并设置 $M_p = M_J$。\n- 使用平均分子量 $\\mu = 2.34$ 和固体密度 $\\rho_s = 1500 \\ \\mathrm{kg \\, m^{-3}}$。\n- 使用CPD参数 $r_0 = 10 R_J$，$\\Sigma_0 = 2 \\times 10^{4} \\ \\mathrm{kg \\, m^{-2}}$，$T_0 = 400 \\ \\mathrm{K}$，$p = 1$ 和 $q = 0.5$。\n- 在从 $r_{\\min} = 5 R_J$ 到 $r_{\\max} = 100 R_J$ 的均匀径向网格上进行评估，网格点数为 $N = 50$。\n- 如前所述，一致地应用 Epstein 区域的公式。\n- 当 $St_{\\min} \\le St(r,s) \\le St_{\\max}$ 和 $\\epsilon_{\\mathrm{mid}}(r) \\ge 1$ 同时满足时，触发流不稳定性。\n\n测试套件：\n\n计算满足以下四个案例中每一个触发标准的半径 $r$ 集合（单位为米）。在所有案例中，使用上述共享参数以及指定的气体和温度分布。对于每个案例，颗粒大小 $s$、湍流参数 $\\alpha$、基准金属丰度 $Z_0$ 以及环参数 $(A, r_{\\mathrm{ring}}, w)$ 如下所列：\n\n- 案例 $1$：$s = 0.5 \\ \\mathrm{m}$，$\\alpha = 5 \\times 10^{-4}$，$Z_0 = 0.03$，$A = 1.0$，$r_{\\mathrm{ring}} = 50 R_J$，$w = 5 R_J$。\n- 案例 $2$：$s = 0.01 \\ \\mathrm{m}$，$\\alpha = 10^{-3}$，$Z_0 = 0.05$，$A = 0.0$，$r_{\\mathrm{ring}}$ 任意，$w$ 任意。\n- 案例 $3$：$s = 1.0 \\ \\mathrm{m}$，$\\alpha = 10^{-3}$，$Z_0 = 0.04$，$A = 0.0$，$r_{\\mathrm{ring}}$ 任意，$w$ 任意。\n- 案例 $4$：$s = 0.3 \\ \\mathrm{m}$，$\\alpha = 5 \\times 10^{-4}$，$Z_0 = 0.04$，$A = 0.0$，$r_{\\mathrm{ring}}$ 任意，$w$ 任意。\n\n要求的最终输出格式：\n\n- 对于每个案例，生成网格上所有满足触发标准的半径列表。每个列表必须包含以米为单位表示的半径，并四舍五入到最接近的 $10^{6} \\ \\mathrm{m}$。\n- 将四个列表聚合成单行，格式必须完全如下：一个逗号分隔的四个案例列表的列表，用方括号括起来，例如 $\\left[ [r_{1,1}, r_{1,2}, \\dots], [ \\dots ], [ \\dots ], [ \\dots ] \\right]$，不含任何额外文本。\n- 如果在给定案例中没有半径满足标准，则为该案例输出一个空列表 $[ \\ ]$。\n\n本问题不涉及角度。所有物理量必须以国际单位制（SI）基本单位表示。最终打印的半径必须以米为单位，并按规定四舍五入到最接近的 $10^{6} \\ \\mathrm{m}$。\n\n您的程序必须实现所述的基本定义中的物理原理，并计算所有四个案例的结果。程序不得要求用户输入，并且必须以所要求的确切格式打印单行结果。答案是浮点数或整数（四舍五入后的半径）的列表，使其可以直接进行测试。",
            "solution": "我们从行星周围盘（CPD）在开普勒旋转下的基本物理学开始。引力参数为 $G$，行星质量为 $M_p$，因此在柱面半径 $r$ 处的开普勒角频率为 $\\Omega_K(r) = \\sqrt{\\dfrac{G M_p}{r^3}}$。开普勒速度为 $v_K(r) = r \\, \\Omega_K(r)$。在理想气体假设下，等温声速为 $c_s(r) = \\sqrt{\\dfrac{k_B T(r)}{\\mu m_p}}$，其中 $k_B$ 是玻尔兹曼常数，$m_p$ 是质子质量，$\\mu$ 是平均分子量（无量纲）。在垂直流体静力学平衡中，$z$ 方向的密度呈高斯分布，其标高为 $H(r) = \\dfrac{c_s(r)}{\\Omega_K(r)}$，中平面气体密度为 $\\rho_{g,0}(r) = \\dfrac{\\Sigma_g(r)}{\\sqrt{2\\pi} \\, H(r)}$。\n\n我们将气体表面密度和温度参数化为幂律形式：\n$\\Sigma_g(r) = \\Sigma_0 \\left( \\dfrac{r}{r_0} \\right)^{-p}$ 和 $T(r) = T_0 \\left( \\dfrac{r}{r_0} \\right)^{-q}$，其中 $\\Sigma_0$、$T_0$、$p$、$q$ 和 $r_0$ 为给定常数。\n\n对于 Epstein 区域中的小固体颗粒，停止时间由与相对速度和气体分子平均热速度成正比的阻力导出。热速度为 $v_{\\mathrm{th}}(r) = \\sqrt{\\dfrac{8}{\\pi}} \\, c_s(r)$。停止时间为\n$t_s(r,s) = \\dfrac{\\rho_s s}{\\rho_{g,0}(r) \\, v_{\\mathrm{th}}(r)}$，\n其中 $\\rho_s$ 是固体的内部密度，$s$ 是其半径。无量纲的斯托克斯数（Stokes number）是轨道频率与停止时间的乘积：\n$St(r,s) = \\Omega_K(r) \\, t_s(r,s)$。\n\n接下来，我们将中平面尘埃富集与盘的湍流联系起来。在以 Shakura–Sunyaev 参数 $\\alpha$ 为特征的湍流扩散稳态下，尘埃标高为 $H_d(r) = H(r) \\, \\sqrt{\\dfrac{\\alpha}{\\alpha + St(r,s)}}$。中平面尘埃与气体密度比等于表面密度之比乘以标高之比（对于高斯垂直分布）：\n$\\epsilon_{\\mathrm{mid}}(r) = \\dfrac{\\rho_{d,0}(r)}{\\rho_{g,0}(r)} = \\dfrac{\\Sigma_d(r)}{\\sqrt{2\\pi} \\, H_d(r)} \\Big/ \\dfrac{\\Sigma_g(r)}{\\sqrt{2\\pi} \\, H(r)} = \\dfrac{\\Sigma_d(r)}{\\Sigma_g(r)} \\, \\dfrac{H(r)}{H_d(r)} = Z(r) \\, \\sqrt{1 + \\dfrac{St(r,s)}{\\alpha}}$，\n其中我们使用了 $H/H_d = \\sqrt{\\dfrac{\\alpha + St}{\\alpha}} = \\sqrt{1 + \\dfrac{St}{\\alpha}}$，且 $Z(r) = \\Sigma_d(r)/\\Sigma_g(r)$ 是局部金属丰度。\n\n触发流不稳定性所广泛使用的必要条件包括：\n- 气动耦合在一个有利的区间内，通常为 $St_{\\min} \\le St(r,s) \\le St_{\\max}$，其中 $St_{\\min} = 10^{-2}$ 且 $St_{\\max} = 1$。\n- 足够大的中平面尘埃与气体密度比，$\\epsilon_{\\mathrm{mid}}(r) \\ge 1$。\n\n给定一个包含增强环的尘埃参数化金属丰度分布 $\\Sigma_d(r) = Z_0 \\, \\Sigma_g(r) \\, \\left[ 1 + A \\, \\exp \\left( - \\dfrac{(r - r_{\\mathrm{ring}})^2}{2w^2} \\right) \\right]$，我们有 $Z(r) = Z_0 \\, \\left[ 1 + A \\, \\exp \\left( - \\dfrac{(r - r_{\\mathrm{ring}})^2}{2w^2} \\right) \\right]$。\n\n算法步骤：\n1. 以国际单位制（SI）定义常数：$G$、$k_B$、$m_p$、$M_J$、$R_J$，并采用 $M_p = M_J$、平均分子量 $\\mu$ 和固体密度 $\\rho_s$。\n2. 构建具有 $N$ 个点的径向网格，均匀分布在 $r_{\\min}$ 到 $r_{\\max}$ 之间。\n3. 对于每个半径 $r$：\n   - 计算 $T(r)$ 和 $c_s(r)$。\n   - 计算 $\\Omega_K(r)$ 和 $H(r)$。\n   - 计算 $\\Sigma_g(r)$ 和 $\\rho_{g,0}(r)$。\n   - 计算 $v_{\\mathrm{th}}(r)$，然后是 $t_s(r,s)$ 和 $St(r,s)$。\n   - 根据尘埃参数化计算 $Z(r)$，然后计算 $\\epsilon_{\\mathrm{mid}}(r) = Z(r) \\, \\sqrt{1 + \\dfrac{St(r,s)}{\\alpha}}$。\n4. 应用流不稳定性标准 $St_{\\min} \\le St \\le St_{\\max}$ 和 $\\epsilon_{\\mathrm{mid}} \\ge 1$。收集所有同时满足这两个条件的半径 $r$。\n5. 将每个选定的半径四舍五入到最接近的 $10^{6} \\ \\mathrm{m}$。\n6. 对每个测试案例及其参数重复以上步骤。以单行聚合格式返回四个列表。\n\n值得注意的是，将 $\\rho_{g,0}(r) = \\dfrac{\\Sigma_g(r)}{\\sqrt{2\\pi}H(r)}$ 和 $v_{\\mathrm{th}} \\propto c_s$ 代入 $t_s$，可以发现 $St(r,s) = \\Omega_K \\, \\dfrac{\\rho_s s}{\\rho_{g,0} v_{\\mathrm{th}}} \\propto \\dfrac{\\rho_s s}{\\Sigma_g(r)}$。这表明，在垂直等温盘的 Epstein 区域内，$St$ 主要取决于 $s$ 和 $\\Sigma_g(r)$，而与 $T(r)$ 没有显式关系，这加强了物理直觉，并为实现提供了一致性检查。\n\n我们现在将此算法应用于四个指定的案例，共享的 CPD 参数为 $r_0 = 10 R_J$，$\\Sigma_0 = 2 \\times 10^{4} \\ \\mathrm{kg \\, m^{-2}}$，$T_0 = 400 \\ \\mathrm{K}$，$p = 1$，$q = 0.5$，$M_p = M_J$，径向边界为 $r_{\\min} = 5 R_J$，$r_{\\max} = 100 R_J$，$N = 50$。案例参数为：\n- 案例 $1$：$s = 0.5 \\ \\mathrm{m}$，$\\alpha = 5 \\times 10^{-4}$，$Z_0 = 0.03$，$A = 1.0$，$r_{\\mathrm{ring}} = 50 R_J$，$w = 5 R_J$。\n- 案例 $2$：$s = 0.01 \\ \\mathrm{m}$，$\\alpha = 10^{-3}$，$Z_0 = 0.05$，$A = 0.0$。\n- 案例 $3$：$s = 1.0 \\ \\mathrm{m}$，$\\alpha = 10^{-3}$，$Z_0 = 0.04$，$A = 0.0$。\n- 案例 $4$：$s = 0.3 \\ \\mathrm{m}$，$\\alpha = 5 \\times 10^{-4}$，$Z_0 = 0.04$，$A = 0.0$。\n\n最终程序计算并打印每个案例的四舍五入后的半径列表（以米为单位），并聚合成单行以便直接评估。单位严格采用国际单位制（SI），半径以米报告，并四舍五入到最接近的 $10^{6} \\ \\mathrm{m}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef cpd_streaming_instability_radii(\n    s, alpha, Z0, A, r_ring, w,\n    Mp, mu, rho_s,\n    Sigma0, T0, p, q, r0,\n    r_min, r_max, N,\n    G, kB, mp, RJ\n):\n    # Radial grid\n    r = np.linspace(r_min, r_max, N)  # meters\n\n    # Gas and temperature profiles\n    Sigma_g = Sigma0 * (r / r0) ** (-p)  # kg/m^2\n    T = T0 * (r / r0) ** (-q)            # K\n\n    # Sound speed and Keplerian frequency\n    cs = np.sqrt(kB * T / (mu * mp))     # m/s\n    OmegaK = np.sqrt(G * Mp / r**3)      # 1/s\n    H = cs / OmegaK                      # m\n\n    # Midplane gas density\n    rho_g0 = Sigma_g / (np.sqrt(2.0 * np.pi) * H)  # kg/m^3\n\n    # Thermal speed\n    v_th = np.sqrt(8.0 / np.pi) * cs     # m/s\n\n    # Epstein stopping time and Stokes number\n    ts = (rho_s * s) / (rho_g0 * v_th)   # s\n    St = OmegaK * ts                     # dimensionless\n\n    # Local metallicity Z(r)\n    if A != 0.0 and r_ring is not None and w is not None:\n        bump = 1.0 + A * np.exp(- (r - r_ring)**2 / (2.0 * w**2))\n    else:\n        bump = 1.0\n    Z = Z0 * bump  # dimensionless\n\n    # Dust scale height and midplane dust-to-gas ratio\n    # H_d = H * sqrt(alpha / (alpha + St)) -> epsilon_mid = Z * (H / H_d) = Z * sqrt(1 + St/alpha)\n    eps_mid = Z * np.sqrt(1.0 + St / alpha)\n\n    # Streaming instability criteria\n    St_min = 1e-2\n    St_max = 1.0\n\n    mask = (St >= St_min)  (St = St_max)  (eps_mid >= 1.0)\n\n    # Select radii that satisfy, rounded to nearest 1e6 m\n    r_sel = r[mask]\n    # Round to nearest 1e6 m\n    r_round = np.rint(r_sel / 1e6) * 1e6\n\n    # Convert to integers for clean output\n    radii_list = [int(x) for x in r_round.tolist()]\n\n    return radii_list\n\ndef solve():\n    # Constants (SI)\n    G = 6.67430e-11           # m^3 kg^-1 s^-2\n    kB = 1.380649e-23         # J K^-1\n    mp = 1.67262192369e-27    # kg\n\n    # Planet and units\n    MJ = 1.898e27             # kg\n    RJ = 7.1492e7             # m\n    Mp = MJ\n\n    # Disk and material parameters (shared)\n    mu = 2.34                 # mean molecular weight\n    rho_s = 1500.0            # kg/m^3 (solids)\n    r0 = 10.0 * RJ            # m\n    Sigma0 = 2.0e4            # kg/m^2 at r0\n    T0 = 400.0                # K at r0\n    p = 1.0\n    q = 0.5\n\n    # Radial grid\n    r_min = 5.0 * RJ\n    r_max = 100.0 * RJ\n    N = 50\n\n    # Test cases: (s, alpha, Z0, A, r_ring, w)\n    cases = [\n        # Case 1\n        (0.5, 5e-4, 0.03, 1.0, 50.0 * RJ, 5.0 * RJ),\n        # Case 2\n        (0.01, 1e-3, 0.05, 0.0, None, None),\n        # Case 3\n        (1.0, 1e-3, 0.04, 0.0, None, None),\n        # Case 4\n        (0.3, 5e-4, 0.04, 0.0, None, None),\n    ]\n\n    results = []\n    for s, alpha, Z0, A, r_ring, w in cases:\n        radii = cpd_streaming_instability_radii(\n            s=s, alpha=alpha, Z0=Z0, A=A, r_ring=r_ring, w=w,\n            Mp=Mp, mu=mu, rho_s=rho_s,\n            Sigma0=Sigma0, T0=T0, p=p, q=q, r0=r0,\n            r_min=r_min, r_max=r_max, N=N,\n            G=G, kB=kB, mp=mp, RJ=RJ\n        )\n        results.append(radii)\n\n    # Final print statement in the exact required format.\n    # Print as a single line JSON-like list of lists without extra spaces.\n    # Convert lists to string with commas and brackets.\n    # Ensure no extra spaces: use join operations.\n    def list_to_str(lst):\n        return \"[\" + \",\".join(str(x) for x in lst) + \"]\"\n\n    print(\"[\" + \",\".join(list_to_str(r) for r in results) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}