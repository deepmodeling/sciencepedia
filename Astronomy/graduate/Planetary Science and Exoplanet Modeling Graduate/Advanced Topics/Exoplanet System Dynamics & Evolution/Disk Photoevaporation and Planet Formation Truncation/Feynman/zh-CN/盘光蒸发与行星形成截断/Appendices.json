{
    "hands_on_practices": [
        {
            "introduction": "理解光致蒸发的第一步是确定其生效的区域。本练习  将引导您推导引力半径 $r_g$，这是一个关键尺度，在此处气体分子的热能足以克服恒星的引力束缚。通过这个基础计算，您将对控制原行星盘大气逃逸的物理平衡建立起具体的直觉。",
            "id": "4158615",
            "problem": "一颗质量为 $M_{\\star}$ 的年轻类太阳恒星被一个原行星盘所环绕，其上层被极紫外（EUV）辐射加热至一个接近等温的温度 $T$。考虑沿开放流线由热驱动的气体逃逸：从柱坐标半径 $r$ 处发射的一团气体，如果其单位质量的可用热能足以克服恒星的单位质量引力束缚，则可以逃逸到无穷远处。从牛顿引力和理想气体等温声速出发，推导逃逸判据处于临界状态时的特征半径 $r_{\\mathrm{g}}$，并用 $G$、$M_{\\star}$、$k_{B}$、$T$、$\\mu$ 和 $m_{H}$ 表示。然后，使用以下参数计算该半径：恒星质量 $M_{\\star} = 1.2 \\, M_{\\odot}$，温度 $T = 1.0 \\times 10^{4} \\, \\mathrm{K}$，平均分子量 $\\mu = 0.67$，引力常数 $G = 6.67430 \\times 10^{-11} \\, \\mathrm{m^{3} \\, kg^{-1} \\, s^{-2}}$，玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23} \\, \\mathrm{J \\, K^{-1}}$，氢原子质量 $m_{H} = 1.6735575 \\times 10^{-27} \\, \\mathrm{kg}$，太阳质量 $M_{\\odot} = 1.98847 \\times 10^{30} \\, \\mathrm{kg}$，以及天文单位 $\\mathrm{au} = 1.495978707 \\times 10^{11} \\, \\mathrm{m}$。将 $r_{\\mathrm{g}}$ 的最终结果以天文单位表示，并将答案四舍五入至三位有效数字。",
            "solution": "该问题要求推导和计算原行星盘中热驱动气体逃逸的特征半径 $r_{\\mathrm{g}}$。该半径是引力半径，定义为逃逸判据处于临界状态的位置。注意，这与通常指代声速点的帕克半径（Parker Radius）$r_s = GM_\\star/(2c_s^2)$ 不同。\n\n首先，我们必须将所述的逃逸判据形式化。一团气体要能逃脱恒星的引力，其比热能（单位质量的热能）必须至少等于其比引力束缚能（单位质量的引力势能的绝对值）。当这两个量相等时，即为临界情况。\n\n我们来定义比引力束缚能 $E_{\\mathrm{grav}}$。根据牛顿万有引力定律，一个质量为 $m$ 的物体在距离一颗质量为 $M_{\\star}$ 的中心恒星 $r$ 处时的引力势能 $U$ 为：\n$$U = - \\frac{G M_{\\star} m}{r}$$\n比引力束缚能是克服该势能所需的单位质量能量，即单位质量势能的绝对值：\n$$E_{\\mathrm{grav}} = \\frac{|U|}{m} = \\frac{G M_{\\star}}{r}$$\n\n接下来，我们定义比热能 $E_{\\mathrm{th}}$。问题指明盘的上层处于接近等温的温度 $T$，且我们应从理想气体等温声速 $c_s$ 出发。等温声速的平方由下式给出：\n$$c_s^2 = \\frac{P}{\\rho}$$\n其中 $P$ 是压强，$\\rho$ 是气体密度。对于理想气体，其状态方程为 $P = nk_{B}T$，其中 $n$ 是粒子数密度，$k_B$ 是玻尔兹曼常数。质量密度 $\\rho$ 通过 $\\rho = n m_p$ 与数密度 $n$ 相关，其中 $m_p$ 是每个气体粒子的平均质量。平均粒子质量通过平均分子量 $\\mu$ 和氢原子质量 $m_H$ 给出，即 $m_p = \\mu m_H$。\n\n将这些关系代入声速平方的表达式，我们得到：\n$$c_s^2 = \\frac{n k_{B} T}{n \\mu m_H} = \\frac{k_{B} T}{\\mu m_H}$$\n量 $c_s^2$ 代表了气体的特征比热能，其单位为单位质量的能量（$J/kg$ 或 $m^2/s^2$）。因此，我们设 $E_{\\mathrm{th}} = c_s^2$。\n\n特征半径 $r_{\\mathrm{g}}$ 是逃逸判据处于临界状态时的半径，因此我们令 $r = r_{\\mathrm{g}}$ 时 $E_{\\mathrm{grav}} = E_{\\mathrm{th}}$：\n$$\\frac{G M_{\\star}}{r_{\\mathrm{g}}} = \\frac{k_{B} T}{\\mu m_H}$$\n解出 $r_{\\mathrm{g}}$，我们得到符号表达式：\n$$r_{\\mathrm{g}} = \\frac{G M_{\\star} \\mu m_{H}}{k_{B} T}$$\n\n现在，我们必须使用给定的数值来计算这个表达式。\n给定的值为：\n恒星质量：$M_{\\star} = 1.2 \\, M_{\\odot} = 1.2 \\times (1.98847 \\times 10^{30} \\, \\mathrm{kg}) = 2.386164 \\times 10^{30} \\, \\mathrm{kg}$\n温度：$T = 1.0 \\times 10^{4} \\, \\mathrm{K}$\n平均分子量：$\\mu = 0.67$\n引力常数：$G = 6.67430 \\times 10^{-11} \\, \\mathrm{m^{3} \\, kg^{-1} \\, s^{-2}}$\n玻尔兹曼常数：$k_{B} = 1.380649 \\times 10^{-23} \\, \\mathrm{J \\, K^{-1}}$\n氢原子质量：$m_{H} = 1.6735575 \\times 10^{-27} \\, \\mathrm{kg}$\n太阳质量：$M_{\\odot} = 1.98847 \\times 10^{30} \\, \\mathrm{kg}$\n天文单位：$\\mathrm{au} = 1.495978707 \\times 10^{11} \\, \\mathrm{m}$\n\n首先，我们计算分子 $G M_{\\star} \\mu m_{H}$：\n分子 $= (6.67430 \\times 10^{-11}) \\times (2.386164 \\times 10^{30}) \\times (0.67) \\times (1.6735575 \\times 10^{-27})$\n分子 $\\approx 1.78570 \\times 10^{-7} \\, \\mathrm{J \\cdot m}$\n\n接下来，我们计算分母 $k_{B} T$：\n分母 $= (1.380649 \\times 10^{-23}) \\times (1.0 \\times 10^{4})$\n分母 $= 1.380649 \\times 10^{-19} \\, \\mathrm{J}$\n\n现在，我们计算以米为单位的 $r_{\\mathrm{g}}$：\n$$r_{\\mathrm{g}} = \\frac{1.78570 \\times 10^{-7} \\, \\mathrm{J \\cdot m}}{1.380649 \\times 10^{-19} \\, \\mathrm{J}} \\approx 1.29339 \\times 10^{12} \\, \\mathrm{m}$$\n注意单位是正确的，因为 $1 \\, \\mathrm{J} = 1 \\, \\mathrm{kg \\cdot m^2 \\cdot s^{-2}}$。\n\n最后，我们按照要求将结果转换为天文单位（$\\mathrm{au}$）并四舍五入到三位有效数字。\n$$r_{\\mathrm{g}} \\, (\\mathrm{au}) = \\frac{r_{\\mathrm{g}} \\, (\\mathrm{m})}{\\mathrm{au} \\, (\\mathrm{m/au})} = \\frac{1.29339 \\times 10^{12} \\, \\mathrm{m}}{1.495978707 \\times 10^{11} \\, \\mathrm{m/au}}$$\n$$r_{\\mathrm{g}} \\, (\\mathrm{au}) \\approx 8.64577$$\n四舍五入到三位有效数字，我们得到 $8.65 \\, \\mathrm{au}$。",
            "answer": "$$\\boxed{8.65}$$"
        },
        {
            "introduction": "在热逃逸概念的基础上，下一个练习  将挑战您构建一个更复杂的模型。您将通过结合热平衡方程与流体动力学外流原理，来确定行星形成的截断半径。这个练习展示了分析建模的强大之处，即如何通过恒星辐射、盘密度和气体动力学之间的相互作用，来预测并塑造行星系统的最终结构。",
            "id": "4158610",
            "problem": "考虑一个围绕质量为 $M_*$ 的恒星的原行星盘大气，其受到极紫外（EUV）辐射的照射。假设 EUV 光度为 $L_{\\mathrm{EUV}}$，并且入射 EUV 能量通量的一部分（比例为 $\\eta$）在盘大气中转化为气体加热。为了确定局部能量沉积率，将柱坐标半径 $r$ 处的大气底部视为对 EUV 光子光学薄的，单位体积的加热率可近似为\n$$\n\\Gamma(r) = \\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi r^{2}}\\,n(r),\n$$\n其中 $n(r)$ 是大气底部的局部数密度。假设辐射冷却主要由碰撞线冷却主导，其由一个幂律冷却函数表示\n$$\n\\Lambda(T) = \\Lambda_{0}\\,T^{\\alpha},\n$$\n因此单位体积的冷却率为\n$$\n\\mathcal{C}(r) = \\Lambda_{0}\\,T(r)^{\\alpha}\\,n(r)^{2}.\n$$\n假设大气底部处于热平衡状态，即 $\\Gamma(r) = \\mathcal{C}(r)$，并采用一个幂律径向密度分布\n$$\nn(r) = n_{0}\\left(\\frac{r}{r_{0}}\\right)^{-p},\n$$\n其中常数 $n_{0}0$，$r_{0}0$，且 $p0$。将从大气中发出的外流视为稳态且局部等温的，其声速 $c_{s}(r)$ 由理想气体关系 $c_{s}^{2}(r) = k_{B}T(r)/(\\mu m_{p})$ 确定，其中 $k_{B}$ 是玻尔兹曼常数，$m_{p}$ 是质子质量，$\\mu$ 是以质子质量为单位的平均分子量。忽略风中的磁力和粘性，并将发射点附近的垂直/径向外流模拟为在恒星引力势下球状发散、稳态、等温的流体动力学风。\n\n将行星形成截断半径 $r_{\\mathrm{tr}}$ 定义为等温流体动力学外流达到其声速点的半径，这标志着非束缚热逃逸的开始，该过程有效地移除星盘气体，并阻止了在 $r_{\\mathrm{tr}}$ 外部的巨行星核的生长。利用稳态流体动力学的基本定律和上述热平衡，推导出行星形成截断半径 $r_{\\mathrm{tr}}$ 的封闭形式解析表达式，该表达式用参数 $\\{G, M_{*}, \\mu, m_{p}, k_{B}, \\eta, L_{\\mathrm{EUV}}, \\Lambda_{0}, \\alpha, n_{0}, r_{0}, p\\}$ 表示，并假设 $\\alpha + p - 2 \\neq 0$。\n\n你的最终答案必须是单一的封闭形式解析表达式。不需要进行数值近似。",
            "solution": "该问题要求在受恒星EUV辐射驱动的光致蒸发风影响的原行星盘中，推导行星形成截断半径 $r_{\\mathrm{tr}}$。截断半径定义为外流的声速点。推导过程分为三个主要步骤：首先，根据热平衡确定盘大气的温度分布；其次，建立温度与等温声速之间的关系；第三，应用稳态、等温、球状发散风的声速点条件来求解半径。\n\n首先，我们确定径向温度分布 $T(r)$。问题指出，盘大气处于热平衡状态，即单位体积的加热率 $\\Gamma(r)$ 等于单位体积的冷却率 $\\mathcal{C}(r)$。\n$$\n\\Gamma(r) = \\mathcal{C}(r)\n$$\n这些率的给定表达式为：\n$$\n\\Gamma(r) = \\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi r^{2}}\\,n(r)\n$$\n$$\n\\mathcal{C}(r) = \\Lambda_{0}\\,T(r)^{\\alpha}\\,n(r)^{2}\n$$\n令二者相等得到：\n$$\n\\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi r^{2}}\\,n(r) = \\Lambda_{0}\\,T(r)^{\\alpha}\\,n(r)^{2}\n$$\n由于对于任何有限半径 $r$，数密度 $n(r)$ 都不为零，我们可以将两边同时除以 $n(r)$：\n$$\n\\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi r^{2}} = \\Lambda_{0}\\,T(r)^{\\alpha}\\,n(r)\n$$\n问题提供了一个幂律密度分布：\n$$\nn(r) = n_{0}\\left(\\frac{r}{r_{0}}\\right)^{-p}\n$$\n将这个 $n(r)$ 的表达式代入热平衡方程得到：\n$$\n\\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi r^{2}} = \\Lambda_{0}\\,T(r)^{\\alpha}\\,n_{0}\\left(\\frac{r}{r_{0}}\\right)^{-p}\n$$\n现在我们求解 $T(r)^{\\alpha}$：\n$$\nT(r)^{\\alpha} = \\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi \\Lambda_{0} n_{0}} \\frac{1}{r^{2}} \\left(\\frac{r}{r_{0}}\\right)^{p} = \\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}} r^{p-2}\n$$\n对两边取 $1/\\alpha$ 次方，得到温度分布：\n$$\nT(r) = \\left(\\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}\\right)^{1/\\alpha} r^{(p-2)/\\alpha}\n$$\n其次，我们将这个温度与等温声速 $c_s(r)$ 联系起来。问题指定了理想气体关系：\n$$\nc_{s}^{2}(r) = \\frac{k_{B}T(r)}{\\mu m_{p}}\n$$\n代入我们推导出的 $T(r)$ 表达式：\n$$\nc_{s}^{2}(r) = \\frac{k_{B}}{\\mu m_{p}} \\left(\\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}\\right)^{1/\\alpha} r^{(p-2)/\\alpha}\n$$\n这个表达式可以更紧凑地写成 $c_{s}^{2}(r) = C r^{(p-2)/\\alpha}$，其中 $C$ 是一个包含系数中所有项的常数。\n\n第三，我们求出截断半径 $r_{\\mathrm{tr}}$，它被定义为外流的声速点。问题指定外流应被模拟为稳态、球状发散、等温的流体动力学风。这对应于 Parker 风模型。对于从半径 $r$ 处以声速 $c_s(r)$ 发射的等温风，声速点出现在半径 $r_s$ 处，由下式给出：\n$$\nr_s = \\frac{GM_{*}}{2c_{s}^{2}(r)}\n$$\n截断半径 $r_{\\mathrm{tr}}$ 是盘中的一个特定半径，在此处气体被发射成风，而该风的声速点恰好位于同一半径处。这个自洽条件表示为：\n$$\nr_{\\mathrm{tr}} = \\frac{GM_{*}}{2c_{s}^{2}(r_{\\mathrm{tr}})}\n$$\n现在我们代入在 $r = r_{\\mathrm{tr}}$ 处求值的 $c_{s}^{2}(r)$ 表达式：\n$$\nr_{\\mathrm{tr}} = \\frac{GM_{*}}{2 \\left[ \\frac{k_{B}}{\\mu m_{p}} \\left(\\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}\\right)^{1/\\alpha} r_{\\mathrm{tr}}^{(p-2)/\\alpha} \\right]}\n$$\n为了求解 $r_{\\mathrm{tr}}$，我们重新整理方程，将所有含 $r_{\\mathrm{tr}}$ 的项聚集到一边：\n$$\nr_{\\mathrm{tr}} \\cdot r_{\\mathrm{tr}}^{(p-2)/\\alpha} = \\frac{GM_{*}}{2} \\left[ \\frac{k_{B}}{\\mu m_{p}} \\left(\\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}\\right)^{1/\\alpha} \\right]^{-1}\n$$\n合并 $r_{\\mathrm{tr}}$ 的幂：\n$$\nr_{\\mathrm{tr}}^{1 + (p-2)/\\alpha} = r_{\\mathrm{tr}}^{(\\alpha + p - 2)/\\alpha} = \\frac{GM_{*}\\mu m_{p}}{2 k_{B}} \\left(\\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}\\right)^{-1/\\alpha}\n$$\n$$\nr_{\\mathrm{tr}}^{(\\alpha + p - 2)/\\alpha} = \\frac{GM_{*}\\mu m_{p}}{2 k_{B}} \\left(\\frac{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}{\\eta\\,L_{\\mathrm{EUV}}}\\right)^{1/\\alpha}\n$$\n为了分离出 $r_{\\mathrm{tr}}$，我们将两边同时取 $\\alpha/(\\alpha + p - 2)$ 次方。问题说明 $\\alpha + p - 2 \\neq 0$，确保该指数有明确定义。\n$$\nr_{\\mathrm{tr}} = \\left[ \\frac{GM_{*}\\mu m_{p}}{2 k_{B}} \\left(\\frac{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}{\\eta\\,L_{\\mathrm{EUV}}}\\right)^{1/\\alpha} \\right]^{\\alpha/(\\alpha + p - 2)}\n$$\n这个表达式可以通过分配指数来简化：\n$$\nr_{\\mathrm{tr}} = \\left(\\frac{GM_{*}\\mu m_{p}}{2 k_{B}}\\right)^{\\alpha/(\\alpha + p - 2)} \\left[ \\left(\\frac{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}{\\eta\\,L_{\\mathrm{EUV}}}\\right)^{1/\\alpha} \\right]^{\\alpha/(\\alpha + p - 2)}\n$$\n$$\nr_{\\mathrm{tr}} = \\left(\\frac{GM_{*}\\mu m_{p}}{2 k_{B}}\\right)^{\\alpha/(\\alpha + p - 2)} \\left(\\frac{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}{\\eta\\,L_{\\mathrm{EUV}}}\\right)^{1/(\\alpha + p - 2)}\n$$\n为了得到一个更优雅的最终形式，我们可以利用属性 $a^x b^y = (a^{x/y} b)^{y}$ 并将各项合并到一个指数下：\n$$\nr_{\\mathrm{tr}} = \\left[ \\left(\\frac{GM_{*}\\mu m_{p}}{2 k_{B}}\\right)^{\\alpha} \\left(\\frac{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}{\\eta\\,L_{\\mathrm{EUV}}}\\right) \\right]^{1/(\\alpha + p - 2)}\n$$\n这就是行星形成截断半径 $r_{\\mathrm{tr}}$ 关于给定参数的最终封闭形式解析表达式。",
            "answer": "$$\n\\boxed{\\left[ \\left( \\frac{G M_{*} \\mu m_{p}}{2 k_{B}} \\right)^{\\alpha} \\left( \\frac{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}{\\eta L_{\\mathrm{EUV}}} \\right) \\right]^{1/(\\alpha + p - 2)}}\n$$"
        },
        {
            "introduction": "最后的练习  将带您从分析推导走向计算应用，这是现代天体物理学研究中的关键一步。您将编写一个程序，将光致蒸发理论模型与观测数据直接联系起来——具体来说，是从谱线的光度推断出星盘的质量损失率 $\\dot{M}$。这项编程实践将锻炼您将物理原理转化为实用工具的能力，用以解释天文观测并检验理论预测。",
            "id": "4158612",
            "problem": "构建一个程序，根据观测推断的谱线光度和一个简单的等温光致蒸发盘风模型，计算总盘物质损失率和相应的盘耗散（行星形成截断）时标。该模型必须从适用于行星系统形成和系外行星建模中盘光致蒸发的第一性原理推导得出。\n\n假设一个围绕质量为 $M_\\star$ 的恒星的星周盘受到辐射，形成一个等温、热驱动的风，其气体温度为 $T$。设等温声速为 $c_s$，对于理想气体，其表达式为 $c_s = \\sqrt{k_B T / (\\mu_{\\mathrm{snd}} m_H)}$，其中 $k_B$ 是玻尔兹曼常数，$m_H$ 是氢原子质量，$\\mu_{\\mathrm{snd}}$ 是适用于声速的平均分子量。设引力常数为 $G$。盘风的发射内半径（即声速点）记为 $R_g$，其定义为 $R_g = GM_\\star / (2 c_s^2)$。\n\n假设该盘支撑着一个温暖的发射表面层，其范围从半径 $R_g$ 延伸到外部半径 $R_{\\mathrm{out}}$，垂直标高为 $H(r) = c_s / \\Omega_K(r)$，其中 $\\Omega_K(r) = \\sqrt{GM_\\star / r^3}$。设温暖层的基底数密度参数化为 $n(r) = n_0 \\left( r / R_g \\right)^{-p}$，适用于 $r \\in [R_g, R_{\\mathrm{out}}]$，其中 $n_0$ 是一个未知的归一化常数，$p$ 是一个给定的幂律指数。设电离分数为 $x_e$，因此电子数密度为 $n_e(r) = x_e n(r)$。质量密度为 $\\rho(r) = \\mu_{\\mathrm{gas}} m_H n(r)$，其中 $\\mu_{\\mathrm{gas}}$ 是适用于质量密度的平均分子量，声速点的密度为 $\\rho_s(r) = \\phi \\, \\rho(r)$，其中 $0  \\phi \\leq 1$。\n\n假设观测到的谱线光度 $L_{\\mathrm{line}} = \\epsilon \\int n_e^2 \\, dV$，其中 $\\epsilon$ 是所选谱线的有效辐射系数（在模型中为常数），温暖层中的发射体积为 $dV = 2 \\times (2 \\pi r \\, dr) \\times H(r)$（考虑了盘的两个表面）。进一步假设风在温暖层表面达到声速，因此质量通量为 $F_M(r) = \\rho_s(r) c_s$，从盘的两个表面流失的总物质损失率为 $\\dot{M} = \\int 2 \\times (2 \\pi r \\, dr) \\, F_M(r)$，积分范围从 $R_g$ 到 $R_{\\mathrm{out}}$。\n\n完全从上述定义以及质量守恒和理想气体热力学定律出发，推导一种方法，从 $L_{\\mathrm{line}}$ 推断 $n_0$，然后计算总物质损失率 $\\dot{M}$ 和截断时标 $t_{\\mathrm{trunc}} = M_{\\mathrm{disk}} / \\dot{M}$，其中 $M_{\\mathrm{disk}}$ 是总盘质量。对于对 $r$ 的积分，你必须处理物质损失积分的通用情况 $p \\neq 2$ 和特殊对数情况 $p = 2$，同样地，对于发射度积分，必须处理通用情况 $(7/2 - 2p) \\neq 0$ 和特殊对数情况 $(7/2 - 2p) = 0$。程序必须实现这些情况，且不产生数值奇异点。\n\n你的程序必须计算以下参数集测试套件的结果，并且必须生成单行输出，其中包含一个逗号分隔的列表的列表，不含空格，每个内部列表包含两个浮点数，对应于 $[\\dot{M}, t_{\\mathrm{trunc}}]$。物质损失率必须以 $\\mathrm{kg/s}$ 表示，截断时标必须以 $\\mathrm{Myr}$ 表示，两者都四舍五入到三位有效数字。\n\n使用的常量（国际单位制 (SI)）：\n- $G = 6.674 \\times 10^{-11} \\ \\mathrm{m^3 \\, kg^{-1} \\, s^{-2}}$\n- $k_B = 1.380649 \\times 10^{-23} \\ \\mathrm{J/K}$\n- $m_H = 1.6735575 \\times 10^{-27} \\ \\mathrm{kg}$\n- $M_\\odot = 1.98847 \\times 10^{30} \\ \\mathrm{kg}$\n- $1 \\ \\mathrm{AU} = 1.495978707 \\times 10^{11} \\ \\mathrm{m}$\n- $1 \\ \\mathrm{Myr} = 10^6 \\ \\mathrm{yr} = 3.15576 \\times 10^{13} \\ \\mathrm{s}$\n\n测试套件（所有参数均采用SI单位，除非另有说明）：\n- 情况1（通用“理想”情况）：$M_\\star = 1.0 \\, M_\\odot$，$T = 10000 \\ \\mathrm{K}$，$\\mu_{\\mathrm{snd}} = 0.62$，$\\mu_{\\mathrm{gas}} = 1.35$，$x_e = 0.7$，$\\phi = 0.5$，$p = 2.1$，$R_{\\mathrm{out}} = 50 \\ \\mathrm{AU}$，$L_{\\mathrm{line}} = 1.0 \\times 10^{24} \\ \\mathrm{W}$，$\\epsilon = 1.0 \\times 10^{-27} \\ \\mathrm{W \\, m^3}$，$M_{\\mathrm{disk}} = 0.05 \\, M_\\odot$。\n- 情况2（物质损失积分对数边界）：$M_\\star = 0.8 \\, M_\\odot$，$T = 8000 \\ \\mathrm{K}$，$\\mu_{\\mathrm{snd}} = 0.62$，$\\mu_{\\mathrm{gas}} = 1.35$，$x_e = 0.2$，$\\phi = 0.6$，$p = 2.0$，$R_{\\mathrm{out}} = 100 \\ \\mathrm{AU}$，$L_{\\mathrm{line}} = 5.0 \\times 10^{23} \\ \\mathrm{W}$，$\\epsilon = 2.0 \\times 10^{-27} \\ \\mathrm{W \\, m^3}$，$M_{\\mathrm{disk}} = 0.01 \\, M_\\odot$。\n- 情况3（发射度积分对数边界）：$M_\\star = 1.5 \\, M_\\odot$，$T = 12000 \\ \\mathrm{K}$，$\\mu_{\\mathrm{snd}} = 0.62$，$\\mu_{\\mathrm{gas}} = 1.35$，$x_e = 0.9$，$\\phi = 0.5$，$p = 1.75$，$R_{\\mathrm{out}} = 30 \\ \\mathrm{AU}$，$L_{\\mathrm{line}} = 2.0 \\times 10^{24} \\ \\mathrm{W}$，$\\epsilon = 1.0 \\times 10^{-27} \\ \\mathrm{W \\, m^3}$，$M_{\\mathrm{disk}} = 0.10 \\, M_\\odot$。\n\n最终输出格式规范：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个元素本身是对应每种情况的一个双元素列表，格式完全如下：$[[\\dot{M}_1,t_1],[\\dot{M}_2,t_2],[\\dot{M}_3,t_3]]$。输出行中不得有任何空格。每个 $\\dot{M}_i$ 必须以 $\\mathrm{kg/s}$ 为单位，每个 $t_i$ 必须以 $\\mathrm{Myr}$ 为单位，两者都四舍五入到三位有效数字。",
            "solution": "此问题的目标是构建一个计算模型，以根据观测到的谱线光度 $L_{\\mathrm{line}}$ 来确定总盘物质损失率 $\\dot{M}$ 和随后的盘耗散时标 $t_{\\mathrm{trunc}}$。该模型是一个简化的、等温的、由星周盘热驱动的风。推导将从所提供的第一性原理和定义出发。\n\n首先，我们建立模型的基本物理参数。等温声速 $c_s$ 由下式给出\n$$c_s = \\sqrt{\\frac{k_B T}{\\mu_{\\mathrm{snd}} m_H}}$$\n其中 $T$ 是气体温度，$k_B$ 是玻尔兹曼常数，$m_H$ 是氢原子质量，$\\mu_{\\mathrm{snd}}$ 是用于计算声速的平均分子量。\n\n引力半径 $R_g$ 定义了光致蒸发风的内边界，是热能与引力势能相当的半径。其定义为\n$$R_g = \\frac{GM_\\star}{2 c_s^2}$$\n其中 $G$ 是引力常数，$M_\\star$ 是中心恒星的质量。\n\n推导分为三个主要步骤：\n1.  将可观测量 $L_{\\mathrm{line}}$ 与未知的基底数密度归一化常数 $n_0$ 联系起来。\n2.  将所需的物质损失率 $\\dot{M}$ 表示为 $n_0$ 的函数。\n3.  结合这些结果，得到完全用已知量表示的 $\\dot{M}$，并随后求得 $t_{\\mathrm{trunc}}$。\n\n**步骤 1：谱线光度 $L_{\\mathrm{line}}$ 的推导**\n\n谱线光度由发射率在发射体积 $V$ 上的积分给出：\n$$L_{\\mathrm{line}} = \\int_V \\epsilon n_e^2 \\, dV$$\n其中 $\\epsilon$ 是有效辐射系数，$n_e$ 是电子数密度。电子密度通过电离分数 $x_e$ 与总气体数密度 $n(r)$ 相关：$n_e(r) = x_e n(r)$。气体密度随半径 $r$ 呈幂律分布：\n$$n(r) = n_0 \\left( \\frac{r}{R_g} \\right)^{-p}$$\n其中 $n_0$ 是我们需要确定的归一化常数。\n\n盘的两个表面上薄层的微分发射体积元 $dV$ 由 $dV = 2 \\times (2\\pi r \\, dr) \\times H(r)$ 给出，其中 $H(r)$ 是发射层的垂直标高。标高定义为 $H(r) = c_s / \\Omega_K(r)$，其中开普勒角速度为 $\\Omega_K(r) = \\sqrt{GM_\\star / r^3}$。这给出：\n$$H(r) = \\frac{c_s}{\\sqrt{GM_\\star / r^3}} = c_s (GM_\\star)^{-1/2} r^{3/2}$$\n因此体积元为 $dV = 4\\pi c_s (GM_\\star)^{-1/2} r^{5/2} dr$。\n\n将这些表达式代入光度方程，并从内半径 $R_g$ 积分到外半径 $R_{\\mathrm{out}}$：\n$$L_{\\mathrm{line}} = \\int_{R_g}^{R_{\\mathrm{out}}} \\epsilon \\left( x_e n_0 \\left( \\frac{r}{R_g} \\right)^{-p} \\right)^2 \\left( 4\\pi c_s (GM_\\star)^{-1/2} r^{5/2} \\right) dr$$\n我们可以将常数从积分中分离出来：\n$$L_{\\mathrm{line}} = 4\\pi \\epsilon x_e^2 n_0^2 R_g^{2p} c_s (GM_\\star)^{-1/2} \\int_{R_g}^{R_{\\mathrm{out}}} r^{-2p} r^{5/2} dr$$\n$$L_{\\mathrm{line}} = 4\\pi \\epsilon x_e^2 n_0^2 R_g^{2p} c_s (GM_\\star)^{-1/2} \\int_{R_g}^{R_{\\mathrm{out}}} r^{5/2 - 2p} dr$$\n\n我们定义光度积分 $I_L = \\int_{R_g}^{R_{\\mathrm{out}}} r^{5/2 - 2p} dr$。此积分根据幂律指数 $p$ 有两种情况。\n- 对于 $5/2 - 2p \\neq -1$（即 $p \\neq 7/4 = 1.75$）的通用情况：\n$$I_L = \\left[ \\frac{r^{5/2 - 2p + 1}}{5/2 - 2p + 1} \\right]_{R_g}^{R_{\\mathrm{out}}} = \\frac{R_{\\mathrm{out}}^{7/2 - 2p} - R_g^{7/2 - 2p}}{7/2 - 2p}$$\n- 对于 $p = 1.75$ 的特殊对数情况：\n$$I_L = \\int_{R_g}^{R_{\\mathrm{out}}} r^{-1} dr = \\left[ \\ln(r) \\right]_{R_g}^{R_{\\mathrm{out}}} = \\ln\\left(\\frac{R_{\\mathrm{out}}}{R_g}\\right)$$\n因此，$L_{\\mathrm{line}}$ 可以写成 $L_{\\mathrm{line}} = K_L n_0^2$，其中 $K_L = 4\\pi \\epsilon x_e^2 R_g^{2p} c_s (GM_\\star)^{-1/2} I_L$。\n\n**步骤 2：物质损失率 $\\dot{M}$ 的推导**\n\n总物质损失率 $\\dot{M}$ 是质量通量 $F_M(r)$ 在盘两个表面的风发射区域上的积分：\n$$\\dot{M} = \\int_{R_g}^{R_{\\mathrm{out}}} F_M(r) \\cdot (2 \\times 2\\pi r \\, dr)$$\n声速面上的质量通量为 $F_M(r) = \\rho_s(r) c_s$，其中声速点的密度为 $\\rho_s(r) = \\phi \\rho(r)$。质量密度 $\\rho(r)$ 由 $\\rho(r) = \\mu_{\\mathrm{gas}} m_H n(r)$ 给出，其中 $\\mu_{\\mathrm{gas}}$ 是气体的平均分子量。代入这些关系：\n$$\\dot{M} = \\int_{R_g}^{R_{\\mathrm{out}}} \\left( \\phi (\\mu_{\\mathrm{gas}} m_H n_0 (r/R_g)^{-p}) c_s \\right) 4\\pi r dr$$\n再次，我们将常数从积分中分离出来：\n$$\\dot{M} = 4\\pi \\phi \\mu_{\\mathrm{gas}} m_H c_s n_0 R_g^p \\int_{R_g}^{R_{\\mathrm{out}}} r^{-p} r^1 dr$$\n$$\\dot{M} = 4\\pi \\phi \\mu_{\\mathrm{gas}} m_H c_s n_0 R_g^p \\int_{R_g}^{R_{\\mathrm{out}}} r^{1-p} dr$$\n\n我们定义物质损失积分 $I_M = \\int_{R_g}^{R_{\\mathrm{out}}} r^{1-p} dr$。此积分也有两种情况。\n- 对于 $1-p \\neq -1$（即 $p \\neq 2$）的通用情况：\n$$I_M = \\left[ \\frac{r^{1-p+1}}{1-p+1} \\right]_{R_g}^{R_{\\mathrm{out}}} = \\frac{R_{\\mathrm{out}}^{2-p} - R_g^{2-p}}{2-p}$$\n- 对于 $p = 2$ 的特殊对数情况：\n$$I_M = \\int_{R_g}^{R_{\\mathrm{out}}} r^{-1} dr = \\left[ \\ln(r) \\right]_{R_g}^{R_{\\mathrm{out}}} = \\ln\\left(\\frac{R_{\\mathrm{out}}}{R_g}\\right)$$\n因此，$\\dot{M}$ 可以写成 $\\dot{M} = K_M n_0$，其中 $K_M = 4\\pi \\phi \\mu_{\\mathrm{gas}} m_H c_s R_g^p I_M$。\n\n**步骤 3：$\\dot{M}$ 和 $t_{\\mathrm{trunc}}$ 的最终表达式**\n\n我们有两个方程联系我们的未知数和已知数：\n1.  $L_{\\mathrm{line}} = K_L n_0^2$\n2.  $\\dot{M} = K_M n_0$\n\n从方程 (1) 中，我们可以解出 $n_0$：$n_0 = \\sqrt{L_{\\mathrm{line}}/K_L}$。将此代入方程 (2)：\n$$\\dot{M} = K_M \\sqrt{\\frac{L_{\\mathrm{line}}}{K_L}} = \\frac{K_M}{\\sqrt{K_L}} \\sqrt{L_{\\mathrm{line}}}$$\n现在，我们代入 $K_M$ 和 $\\sqrt{K_L}$ 的完整表达式：\n$$K_M = 4\\pi \\phi \\mu_{\\mathrm{gas}} m_H c_s R_g^p I_M$$\n$$\\sqrt{K_L} = \\sqrt{4\\pi \\epsilon x_e^2 R_g^{2p} c_s (GM_\\star)^{-1/2} I_L} = 2\\sqrt{\\pi} \\sqrt{\\epsilon} x_e R_g^p \\sqrt{c_s} (GM_\\star)^{-1/4} \\sqrt{I_L}$$\n将 $K_M$ 除以 $\\sqrt{K_L}$ 得到：\n$$\\frac{K_M}{\\sqrt{K_L}} = \\frac{4\\pi \\phi \\mu_{\\mathrm{gas}} m_H c_s R_g^p I_M}{2\\sqrt{\\pi} \\sqrt{\\epsilon} x_e R_g^p \\sqrt{c_s} (GM_\\star)^{-1/4} \\sqrt{I_L}} = \\frac{2\\sqrt{\\pi} \\phi \\mu_{\\mathrm{gas}} m_H c_s^{1/2} (GM_\\star)^{1/4} I_M}{\\sqrt{\\epsilon} x_e \\sqrt{I_L}}$$\n物质损失率的最终表达式为：\n$$\\dot{M} = \\left( \\frac{2\\sqrt{\\pi} \\phi \\mu_{\\mathrm{gas}} m_H}{\\sqrt{\\epsilon} x_e} \\right) \\sqrt{c_s} (GM_\\star)^{1/4} \\sqrt{L_{\\mathrm{line}}} \\left( \\frac{I_M}{\\sqrt{I_L}} \\right)$$\n\n最后，盘耗散（截断）时标 $t_{\\mathrm{trunc}}$ 通过将总盘质量 $M_{\\mathrm{disk}}$ 除以物质损失率计算得出：\n$$t_{\\mathrm{trunc}} = \\frac{M_{\\mathrm{disk}}}{\\dot{M}}$$\n\n计算流程如下：\n1.  从输入参数计算 $c_s$ 和 $R_g$。\n2.  计算积分项 $I_L$ 和 $I_M$，正确处理 $p=1.75$ 和 $p=2.0$ 的特殊情况。\n3.  使用上述最终表达式计算 $\\dot{M}$（以 SI 单位 $\\mathrm{kg/s}$ 表示）。\n4.  计算 $t_{\\mathrm{trunc}}$（以秒为单位），并将其转换为百万年（$\\mathrm{Myr}$）。\n5.  按要求将最终结果四舍五入到三位有效数字。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes disk mass-loss rate and depletion timescale based on a photoevaporative wind model.\n    \"\"\"\n\n    # Physical constants in SI units\n    G = 6.674e-11  # Gravitational constant (m^3 kg^-1 s^-2)\n    k_B = 1.380649e-23  # Boltzmann's constant (J/K)\n    m_H = 1.6735575e-27  # Hydrogen mass (kg)\n    M_sol = 1.98847e30  # Solar mass (kg)\n    AU = 1.495978707e11  # Astronomical unit (m)\n    MYR_in_s = 3.15576e13  # Seconds in a Megayear\n\n    test_cases = [\n        {\n            \"M_star_msol\": 1.0, \"T\": 10000.0, \"mu_snd\": 0.62, \"mu_gas\": 1.35, \"x_e\": 0.7,\n            \"phi\": 0.5, \"p\": 2.1, \"R_out_au\": 50.0, \"L_line\": 1.0e24, \"epsilon\": 1.0e-27,\n            \"M_disk_msol\": 0.05\n        },\n        {\n            \"M_star_msol\": 0.8, \"T\": 8000.0, \"mu_snd\": 0.62, \"mu_gas\": 1.35, \"x_e\": 0.2,\n            \"phi\": 0.6, \"p\": 2.0, \"R_out_au\": 100.0, \"L_line\": 5.0e23, \"epsilon\": 2.0e-27,\n            \"M_disk_msol\": 0.01\n        },\n        {\n            \"M_star_msol\": 1.5, \"T\": 12000.0, \"mu_snd\": 0.62, \"mu_gas\": 1.35, \"x_e\": 0.9,\n            \"phi\": 0.5, \"p\": 1.75, \"R_out_au\": 30.0, \"L_line\": 2.0e24, \"epsilon\": 1.0e-27,\n            \"M_disk_msol\": 0.10\n        }\n    ]\n\n    results = []\n\n    # Function to round to a specified number of significant figures\n    def round_to_sf(value, sf):\n        if value == 0:\n            return 0.0\n        # Use format specifier for scientific notation to control significant figures\n        return float(f'{value:.{sf-1}e}')\n\n    for params in test_cases:\n        # Unpack parameters and convert to SI units\n        M_star = params[\"M_star_msol\"] * M_sol\n        T = params[\"T\"]\n        mu_snd = params[\"mu_snd\"]\n        mu_gas = params[\"mu_gas\"]\n        x_e = params[\"x_e\"]\n        phi = params[\"phi\"]\n        p = params[\"p\"]\n        R_out = params[\"R_out_au\"] * AU\n        L_line = params[\"L_line\"]\n        epsilon = params[\"epsilon\"]\n        M_disk = params[\"M_disk_msol\"] * M_sol\n\n        # Step 1: Calculate intermediate physical quantities\n        c_s = np.sqrt(k_B * T / (mu_snd * m_H))\n        R_g = G * M_star / (2 * c_s**2)\n\n        # Step 2: Calculate the integral terms I_L and I_M with special case handling\n        # Luminosity integral I_L\n        if np.isclose(p, 1.75):  # Special case: p = 7/4\n            I_L = np.log(R_out / R_g)\n        else:\n            exponent_L = 7.0/2.0 - 2.0*p\n            I_L = (R_out**exponent_L - R_g**exponent_L) / exponent_L\n\n        # Mass-loss integral I_M\n        if np.isclose(p, 2.0):  # Special case: p = 2\n            I_M = np.log(R_out / R_g)\n        else:\n            exponent_M = 2.0 - p\n            I_M = (R_out**exponent_M - R_g**exponent_M) / exponent_M\n\n        # Step 3: Calculate the total mass-loss rate M_dot\n        prefactor = (2 * np.sqrt(np.pi) * phi * mu_gas * m_H) / (np.sqrt(epsilon) * x_e)\n        dynamics_term = np.sqrt(c_s) * (G * M_star)**0.25\n        luminosity_term = np.sqrt(L_line)\n        integral_ratio = I_M / np.sqrt(I_L)\n\n        M_dot = prefactor * dynamics_term * luminosity_term * integral_ratio\n\n        # Step 4: Calculate the truncation timescale\n        t_trunc_s = M_disk / M_dot\n        t_trunc_myr = t_trunc_s / MYR_in_s\n\n        # Step 5: Round results to three significant figures\n        M_dot_rounded = round_to_sf(M_dot, 3)\n        t_trunc_rounded = round_to_sf(t_trunc_myr, 3)\n\n        results.append([M_dot_rounded, t_trunc_rounded])\n\n    # Format the final output string as specified\n    output_str = \"[\" + \",\".join([f\"[{mdot},{tt}]\" for mdot, tt in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}