{
    "hands_on_practices": [
        {
            "introduction": "在深入研究古在-李多夫机制的详细动力学之前，建立关于其特征时间尺度的物理直觉是非常有价值的。本练习利用物理标度论证和开普勒定律，揭示了古在-李多夫振荡周期如何依赖于外部扰动轨道的属性。这种方法旨在锻炼您在量纲分析和物理推理方面的技能，使您能够快速估算轨道结构如何影响系统的长期演化 。",
            "id": "1918587",
            "problem": "考虑一个层级三星系统。该系统由一个引力束缚的“内双星”和一个遥远的“外伴星”组成，内双星由两颗质量分别为 $m_1$ 和 $m_2$ 的恒星构成，外伴星的质量为 $m_3$。内双星中的两颗恒星以周期 $P_{in}$ 和半长轴 $a_{in}$ 绕着它们的共同质心运行。外伴星以周期 $P_{out}$ 和半长轴 $a_{out}$ 绕着内双星的质心运行。该系统是层级的，意味着 $a_{out} \\gg a_{in}$。\n\n外伴星的轨道相对于内双星的轨道平面是倾斜的。这种构型导致了长期的引力摄动，其中外伴星对内双星施加潮汐力矩。这导致内双星的轨道倾角和偏心率发生缓慢的周期性振荡。这种现象被称为古在-李道夫（Kozai-Lidov, KL）机制，它在一个特征时间尺度 $T_{KL}$ 上演化。\n\n假设时间尺度 $T_{KL}$ 与外伴星的周期存在幂律关系，由 $T_{KL} \\propto P_{out}^{\\alpha}$ 给出，请确定指数 $\\alpha$ 的值。你的分析应基于物理标度律论证和开普勒第三定律。将三颗恒星的质量（$m_1, m_2, m_3$）和内双星的周期（$P_{in}$）视为固定常数。",
            "solution": "我们寻求在保持 $m_{1}$、$m_{2}$、$m_{3}$ 和 $P_{in}$ 固定的情况下，古在-李道夫时间尺度与外轨道周期的标度关系。KL振荡是由外伴星的四极潮汐势驱动的，它引起了内双星轨道根数的长期进动。四极阶摄动的无量纲强度可标度为\n$$\n\\epsilon \\sim \\frac{m_{3}}{M_{tot}}\\left(\\frac{a_{in}}{a_{out}}\\right)^{3},\n$$\n其中 $M_{tot}=m_{1}+m_{2}+m_{3}$。内轨道根数的特征长期（KL）演化率的量级为\n$$\n\\dot{\\omega}_{\\mathrm{sec}} \\sim \\epsilon\\,n_{in},\n$$\n其中 $n_{in}=2\\pi/P_{in}$ 是内轨道的平均运动角速度。因此，KL时间尺度由长期演化率的倒数决定：\n$$\nT_{KL} \\sim \\frac{1}{\\epsilon\\,n_{in}}.\n$$\n为了用周期表示半长轴之比，我们对内轨道和外轨道使用开普勒第三定律：\n$$\nn_{in}^{2}a_{in}^{3}=G M_{in},\\qquad n_{out}^{2}a_{out}^{3}=G M_{tot},\n$$\n其中 $M_{in}=m_{1}+m_{2}$ 且 $n_{out}=2\\pi/P_{out}$。求解该比值可得\n$$\n\\left(\\frac{a_{in}}{a_{out}}\\right)^{3}=\\frac{n_{out}^{2}}{n_{in}^{2}}\\frac{M_{in}}{M_{tot}}.\n$$\n代入 $\\epsilon\\,n_{in}$ 中可得\n$$\n\\epsilon\\,n_{in}=\\frac{m_{3}}{M_{tot}}\\left(\\frac{n_{out}^{2}}{n_{in}^{2}}\\frac{M_{in}}{M_{tot}}\\right)n_{in}\n=\\frac{m_{3}M_{in}}{M_{tot}^{2}}\\frac{n_{out}^{2}}{n_{in}}.\n$$\n因此，\n$$\nT_{KL}\\sim \\frac{1}{\\epsilon\\,n_{in}}\\propto \\frac{n_{in}}{n_{out}^{2}}.\n$$\n用周期替换平均运动角速度，$n_{in}=2\\pi/P_{in}$ 和 $n_{out}=2\\pi/P_{out}$，可得\n$$\n\\frac{n_{in}}{n_{out}^{2}}=\\frac{2\\pi/P_{in}}{(2\\pi)^{2}/P_{out}^{2}}=\\frac{P_{out}^{2}}{2\\pi\\,P_{in}}.\n$$\n因此，当 $P_{in}$ 和各质量固定时，KL时间尺度的标度关系为\n$$\nT_{KL}\\propto P_{out}^{2}.\n$$\n这对应于关系式 $T_{KL}\\propto P_{out}^{\\alpha}$ 中的指数 $\\alpha=2$。任何对外轨道偏心率的依赖，例如标准表达式中存在的因子 $(1-e_{out}^{2})^{3/2}$，都与 $P_{out}$ 无关，因此不影响该指数。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "古在-李多夫机制的一个核心特征是它能将轨道相互倾角转化为内轨道偏心率。本问题将引导您完成一次基础的计算，利用长期动力学中的守恒量——即古在-李多夫积分和双重平均哈密顿量——来确定内轨道可能达到的最大偏心率。掌握这一推导过程，将使您对初始轨道参数如何决定分层三体系统中偏心率振荡的幅度有更具体的理解 。",
            "id": "4177196",
            "problem": "考虑一个等级三体系统，它由一颗质量为 $M_{\\star}$ 的中心恒星、一颗质量为 $m_{1}$ 且在半长轴为 $a_{1}$ 的初始圆形轨道上运行的内行星，以及一颗质量为 $m_{2}$ 且在半长轴为 $a_{2}$ 的宽阔圆形轨道上运行的外部伴星组成。在 $t=0$ 时，内轨道与外轨道之间的互倾角为 $i_{0}$。假设该系统在动力学上是等级的（$a_{1} \\ll a_{2}$），外层轨道是严格圆形的，并且短程力（广义相对论（GR）、潮汐效应、旋转扁率）可以忽略不计。在牛顿点质量引力的双重平均、四极矩阶的长期近似框架内进行计算，并将内行星相对于外层轨道的角动量视为检验粒子极限。\n\n给定以下具体值：\n- $M_{\\star} = 1.0\\,M_{\\odot}$，\n- $m_{1} = 10\\,M_{\\oplus}$，\n- $m_{2} = 1.0\\,M_{\\mathrm{Jup}}$，\n- $a_{1} = 0.7\\,\\mathrm{AU}$，\n- $a_{2} = 30\\,\\mathrm{AU}$，\n- $e_{1}(0) = 0$，\n- $e_{2} = 0$，\n- $i_{0} = 60^{\\circ}$ (角度以度表示)，\n\n从牛顿万有引力定律、轨道角动量的定义以及双重平均四极矩微扰函数出发，推导长期古在-李道夫（KL）动力学的守恒量，并利用它们确定在给定的初始条件下，内行星轨道在KL循环期间所能达到的最大偏心率 $e_{1,\\max}$。将最终答案表示为一个无量纲数，并四舍五入到四位有效数字。在任何出现角度的地方，都应注明所使用的角度单位。",
            "solution": "该问题要求计算在等级三体系统中，经历古在-李道夫（KL）振荡的内行星所能达到的最大偏心率 $e_{1,\\max}$。该问题在长期天体力学框架内是适定的且有科学依据的。\n\n出发点是三体系统（$M_{\\star}$，$m_{1}$，$m_{2}$）中的引力相互作用。内行星（$m_{1}$）相对于中心恒星（$M_{\\star}$）的运动方程包含一个由外部伴星（$m_{2}$）引起的微扰项。这个微扰的势，即所谓的微扰函数 $R$，可以展开为轨道半径之比的勒让德多项式级数。对于 $a_{1} \\ll a_{2}$ 的等级系统，我们可以在四极矩阶（与 $(r_{1}/r_{2})^{2}$ 成正比的项）截断此展开。\n\n通过对内外轨道的平近点角（轨道相位）对微扰函数进行平均，可以研究其长期演化。这个双重平均势 $\\langle R \\rangle$，或等效地，长期哈密顿量 $\\mathcal{H}_{\\mathrm{sec}} = -\\langle R \\rangle$，控制着轨道根数的长期演化，但半长轴除外，它在此近似下保持不变。\n\n对于在圆形轨道（$e_{2}=0$）上的外部伴星，并在内行星的检验粒子极限（$m_{1} \\to 0$）下，双重平均、四极矩阶的长期哈密顿量取决于内轨道的偏心率 $e_{1}$、相对于外层轨道平面的倾角 $i$ 以及近心点辐角 $\\omega_{1}$。该哈密顿量的一个标准形式是：\n$$ \\mathcal{H}_{\\mathrm{sec}} = C \\left[ (2+3e_{1}^{2})(1-3\\cos^{2}i) - 15e_{1}^{2}\\sin^{2}i \\cos(2\\omega_{1}) \\right] $$\n其中 $C$ 是一个取决于质量和半长轴（$M_{\\star}$，$m_{2}$，$a_{1}$，$a_{2}$）的常数。由于我们关心的是形状（$e_1$）和方向（$i, \\omega_1$）的演化，因此 $C$ 的精确值对于求最大偏心率不是必需的。\n\n由此哈密顿量描述的长期动力学有两个关键的守恒量：\n\n1.  **长期哈密顿量本身**：由于 $\\mathcal{H}_{\\mathrm{sec}}$ 不显式地依赖于时间，其值在整个演化过程中是守恒的。\n    $$ (2+3e_{1}^{2})(1-3\\cos^{2}i) - 15e_{1}^{2}\\sin^{2}i \\cos(2\\omega_{1}) = \\mathrm{constant} $$\n\n2.  **古在-李道夫积分**：哈密顿量与升交点黄经 $\\Omega_{1}$ 无关。在典则轨道根数（德洛内变量）中，与 $\\Omega_{1}$ 共轭的作用量是 $H_1 = \\sqrt{G(M_{\\star}+m_1)a_1(1-e_1^2)}\\cos i$。由于 $a_1$ 是常数，其他项是物理常数，这意味着 $\\sqrt{1-e_1^2}\\cos i$ 是守恒的。通常使用该量的平方：\n    $$ C_{KL} = (1-e_{1}^{2})\\cos^{2}i = \\mathrm{constant} $$\n\n我们可以根据 $t=0$ 时的初始条件确定这些常数的值：\n-   内轨道的初始偏心率：$e_{1}(0) = 0$。\n-   初始互倾角：$i(0) = i_{0} = 60^{\\circ}$。\n\n古在-李道夫积分的初始值为：\n$$ C_{KL} = (1 - e_{1}(0)^{2})\\cos^{2}(i_{0}) = (1-0^{2})\\cos^{2}(60^{\\circ}) = (\\frac{1}{2})^{2} = \\frac{1}{4} $$\n因此，对于所有时间 $t$，我们有：\n$$ (1-e_{1}(t)^{2})\\cos^{2}(i(t)) = \\frac{1}{4} $$\n\n守恒哈密顿量的值在 $t=0$ 时计算。注意，当 $e_{1}(0)=0$ 时，含有 $\\cos(2\\omega_{1})$ 的项为零。\n$$ \\mathcal{H}_{\\mathrm{sec}}(0) = C \\left[ (2+3 \\cdot 0^{2})(1-3\\cos^{2}(60^{\\circ})) - 15 \\cdot 0^{2} \\sin^{2}(60^{\\circ}) \\cos(2\\omega_{1}(0)) \\right] $$\n$$ \\mathcal{H}_{\\mathrm{sec}}(0) = C \\left[ 2(1-3(\\frac{1}{2})^{2}) \\right] = C \\left[ 2(1-\\frac{3}{4}) \\right] = C \\left[ 2(\\frac{1}{4}) \\right] = \\frac{C}{2} $$\n除以 $C$，无量纲哈密顿量的守恒值为 $1/2$。\n\n最大偏心率 $e_{1,\\max}$ 在KL循环的转折点达到。对于从 $e_1=0$ 开始且初始倾角 $i_0$ 大于临界角 $i_c = \\arccos(\\sqrt{3/5}) \\approx 39.2^{\\circ}$ 的系统，近心点辐角 $\\omega_1$ 会在 $90^{\\circ}$ 或 $270^{\\circ}$ 附近天平动。当 $\\omega_1 = 90^{\\circ}$ 或 $270^{\\circ}$ 时，偏心率达到最大值，此时 $\\cos(2\\omega_{1}) = \\cos(\\pi) = -1$。\n\n设 $e_{1,\\max}$ 为最大偏心率，$i_{\\min}$ 为对应的倾角。在这一点，两个守恒定律必须成立：\n1.  $(1-e_{1,\\max}^{2})\\cos^{2}(i_{\\min}) = C_{KL} = \\frac{1}{4}$\n2.  $(2+3e_{1,\\max}^{2})(1-3\\cos^{2}i_{\\min}) - 15e_{1,\\max}^{2}\\sin^{2}i_{\\min} \\cos(\\pi) = \\frac{1}{2}$\n\n从方程(1)，我们可以用 $e_{1,\\max}$ 来表示 $\\cos^{2}(i_{\\min})$ 和 $\\sin^{2}(i_{\\min})$：\n$$ \\cos^{2}(i_{\\min}) = \\frac{1}{4(1-e_{1,\\max}^{2})} $$\n$$ \\sin^{2}(i_{\\min}) = 1 - \\cos^{2}(i_{\\min}) = 1 - \\frac{1}{4(1-e_{1,\\max}^{2})} = \\frac{4-4e_{1,\\max}^{2}-1}{4(1-e_{1,\\max}^{2})} = \\frac{3-4e_{1,\\max}^{2}}{4(1-e_{1,\\max}^{2})} $$\n\n现在，将这些代入方程(2)，并记住 $\\cos(2\\omega_1) = -1$：\n$$ (2+3e_{1,\\max}^{2})(1-3\\cos^{2}i_{\\min}) + 15e_{1,\\max}^{2}\\sin^{2}i_{\\min} = \\frac{1}{2} $$\n$$ (2+3e_{1,\\max}^{2})\\left(1 - \\frac{3}{4(1-e_{1,\\max}^{2})}\\right) + 15e_{1,\\max}^{2}\\left(\\frac{3-4e_{1,\\max}^{2}}{4(1-e_{1,\\max}^{2})}\\right) = \\frac{1}{2} $$\n为简单起见，令 $x = e_{1,\\max}^{2}$。\n$$ (2+3x)\\left(\\frac{4(1-x)-3}{4(1-x)}\\right) + \\frac{15x(3-4x)}{4(1-x)} = \\frac{1}{2} $$\n$$ (2+3x)\\left(\\frac{1-4x}{4(1-x)}\\right) + \\frac{15x(3-4x)}{4(1-x)} = \\frac{1}{2} $$\n将整个方程乘以 $4(1-x)$：\n$$ (2+3x)(1-4x) + 15x(3-4x) = 2(1-x) $$\n展开各项：\n$$ (2 - 8x + 3x - 12x^{2}) + (45x - 60x^{2}) = 2 - 2x $$\n$$ 2 - 5x - 12x^{2} + 45x - 60x^{2} = 2 - 2x $$\n$$ 2 + 40x - 72x^{2} = 2 - 2x $$\n两边减去 $2$ 并重新整理：\n$$ 42x - 72x^{2} = 0 $$\n$$ 6x(7 - 12x) = 0 $$\n这个方程给出两个可能的解：$x=0$ 或 $x=7/12$。解 $x=e_{1,\\max}^{2}=0$ 对应于初始状态（即最小偏心率）。另一个解必定对应于最大偏心率。\n$$ e_{1,\\max}^{2} = \\frac{7}{12} $$\n取平方根求得最大偏心率：\n$$ e_{1,\\max} = \\sqrt{\\frac{7}{12}} $$\n题目要求一个四舍五入到四位有效数字的数值答案。\n$$ e_{1,\\max} = \\sqrt{\\frac{7}{12}} \\approx \\sqrt{0.583333...} \\approx 0.76376261... $$\n四舍五入到四位有效数字，我们得到 $0.7638$。提供的其他参数（$M_{\\star}$，$m_{1}$，$m_{2}$，$a_{1}$，$a_{2}$）确认了该系统是等级的，并且检验粒子近似是有效的，但它们只影响振荡的时间尺度，而不影响此处确定的偏心率变化的幅度。",
            "answer": "$$\\boxed{0.7638}$$"
        },
        {
            "introduction": "虽然计算单个系统的演化结果至关重要，但天体物理学研究通常需要理解天体群体的统计特性。这项高级练习将最大偏心率的解析结果与概率论相结合，以确定具有随机轨道朝向的系统发生显著偏心率激发的可能性。通过基于此概率框架  建立一个计算模型，您将把纯粹的动力学理论与其在解释观测数据和群体合成模型中的应用联系起来。",
            "id": "4182895",
            "problem": "考虑一个牛顿引力下的层级式三体系统：一个质量为 $M$ 的中心恒星，一个质量可忽略的内行星，其初始轨道为圆形，半长轴为 $a_{\\mathrm{in}}$，以及一个质量为 $m_{\\mathrm{out}}$ 的遥远外部伴星，其圆形轨道的半长轴为 $a_{\\mathrm{out}}$，并满足 $a_{\\mathrm{out}} \\gg a_{\\mathrm{in}}$。内轨道的偏心率为 $e$，相对于外部固定轨道平面的轨道倾角为 $i$，近心点辐角为 $\\omega$。在长期演化的双重平均四极矩近似下，当初始相互倾角 $i_0$ 满足特定条件时，该系统会表现出 Kozai-Lidov (KL) 机制，导致轨道倾角和偏心率之间发生周期性交换。\n\n从牛顿动力学基本原理和双重平均四极矩层级的长期演化理论出发，利用轴对称平均势内禀的守恒定律，推导当内轨道初始为圆形（$e_0 = 0$）时，发生 KL 振荡对初始相互倾角 $i_0$ 的要求。然后，当 $\\omega$ 达到适当的极值时，推导在 KL 振荡期间达到的最大偏心率 $e_{\\max}(i_0)$ 的表达式。\n\n为了模拟内轨道相对于外轨道平面的随机朝向，假设初始相互倾角 $i_0$ 从区间 $i \\in [0,\\pi]$ 上的参数化概率密度函数 $f(i;\\alpha)$ 中抽取，其定义为\n$$\nf(i;\\alpha) = C(\\alpha)\\,\\sin i\\,\\bigl(1 + \\alpha \\cos^2 i\\bigr),\n$$\n其中 $\\alpha$ 是一个满足 $\\alpha \\ge -1$ 的实数参数（以确保非负性），$C(\\alpha)$ 是一个归一化常数，其选择使得 $\\int_{0}^{\\pi} f(i;\\alpha)\\,di = 1$。角度必须以弧度处理。对于给定的偏心率阈值 $e_{\\mathrm{thr}} \\in [0,1]$，令 $P(\\alpha, e_{\\mathrm{thr}})$ 表示一个具有密度 $f(i;\\alpha)$ 的随机朝向系统其 $e_{\\max}(i_0) \\ge e_{\\mathrm{thr}}$ 的概率。\n\n您的任务是：\n- 从第一性原理出发，推导在四极矩、双重平均近似及外部轨道为圆形的条件下，当 $e_0=0$ 时发生 KL 振荡对 $i_0$ 的要求，并推导 $e_{\\max}(i_0)$ 的公式。\n- 基于这些推导，通过在满足 $e_{\\max}(i_0) \\ge e_{\\mathrm{thr}}$ 的所有轨道倾角集合上对 $f(i;\\alpha)$ 进行积分，用 $\\alpha$ 和 $e_{\\mathrm{thr}}$ 表示 $P(\\alpha, e_{\\mathrm{thr}})$。\n\n实现一个程序，为以下每个测试用例计算 $P(\\alpha, e_{\\mathrm{thr}})$，并将结果输出为四舍五入到六位小数的十进制数：\n1. $\\alpha = 0$, $e_{\\mathrm{thr}} = 0.0$。\n2. $\\alpha = 0$, $e_{\\mathrm{thr}} = 0.5$。\n3. $\\alpha = 0$, $e_{\\mathrm{thr}} = 0.99$。\n4. $\\alpha = -1$, $e_{\\mathrm{thr}} = 0.0$。\n5. $\\alpha = 5$, $e_{\\mathrm{thr}} = 0.5$。\n6. $\\alpha = 0$, $e_{\\mathrm{thr}} = 1.0$。\n\n您的程序应生成一行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，“[result1,result2,result3,result4,result5,result6]”）。每个结果必须是四舍五入到六位小数的浮点数。输出中不出现物理单位，因为概率是无量纲的。",
            "solution": "问题陈述已经过仔细验证，被确定在天体力学的既定框架内是可靠、适定且有科学依据的。它提出了一个基于 Kozai-Lidov 机制的双重平均四极矩近似的形式化、可解问题。因此，我们可以进行完整的解答。\n\n解答分为三部分推导：首先，我们建立平均系统的守恒量，并推导最大偏心率 $e_{\\max}$ 的表达式；其次，从该表达式中，我们推断出发生 Kozai-Lidov (KL) 振荡的条件；第三，我们通过在适当的轨道倾角范围内对给定的概率密度函数进行积分来计算概率 $P(\\alpha, e_{\\mathrm{thr}})$。\n\n### Kozai-Lidov 积分和最大偏心率的推导\n\n问题考虑的是一个在牛顿引力下的层级式三体系统，并在长期（轨道平均）近似下进行分析。外部伴星的轨道是圆形的，并定义了一个固定的参考平面。由于外部天体施加的时间平均势具有轴对称性，内轨道比角动量矢量在垂直于外轨道平面方向上的分量是一个守恒量。\n\n内轨道的比角动量 $\\vec{L}_{\\mathrm{in}}$ 的大小由下式给出：\n$$\n|\\vec{L}_{\\mathrm{in}}| = \\sqrt{G(M+m_{\\mathrm{in}})a_{\\mathrm{in}}(1-e^2)}\n$$\n其中 $G$ 是引力常数，$M$ 是恒星质量，$m_{\\mathrm{in}}$ 是内行星质量，$a_{\\mathrm{in}}$ 是其半长轴，$e$ 是其偏心率。由于行星质量可忽略不计（$m_{\\mathrm{in}} \\approx 0$），该式简化为 $|\\vec{L}_{\\mathrm{in}}| = \\sqrt{GM a_{\\mathrm{in}}(1-e^2)}$。\n\n$\\vec{L}_{\\mathrm{in}}$ 沿对称轴（垂直于外轨道平面）的分量，记为 $L_z$，是：\n$$\nL_z = |\\vec{L}_{\\mathrm{in}}| \\cos i = \\sqrt{GM a_{\\mathrm{in}}(1-e^2)} \\cos i\n$$\n其中 $i$ 是内、外轨道平面之间的相互倾角。在长期近似中，半长轴 $a_{\\mathrm{in}}$ 也是一个运动不变量。因此，量 $(1-e^2)\\cos^2 i$ 必须是守恒的。这就得到了 Kozai-Lidov 运动积分的基础形式，$\\Theta$：\n$$\n\\Theta = (1-e^2)\\cos^2 i = \\text{constant}\n$$\n对于一个初始为圆形（$e_0 = 0$）且初始倾角为 $i_0$ 的内轨道，该常数的值是固定的：\n$$\n\\Theta = (1-0^2)\\cos^2 i_0 = \\cos^2 i_0\n$$\n因此，在系统的整个长期演化过程中，偏心率和轨道倾角必须满足：\n$$\n(1-e^2)\\cos^2 i = \\cos^2 i_0\n$$\nKL 振荡的特征是偏心率的大幅变化，这与近心点辐角 $\\omega$ 的天平动相关。当轨道倾角 $i$ 达到极值时，偏心率 $e$ 达到其最大值 $e_{\\max}$。这发生在 $\\omega = \\pi/2$ 或 $\\omega = 3\\pi/2$ 时。在这些点上，近心点辐角的长期时间导数 $d\\omega/dt$ 瞬时为零。在四极矩近似下，于 $\\omega=\\pi/2$（或 $3\\pi/2$）处 $d\\omega/dt = 0$ 的条件导出一个特定的轨道倾角值，我们记为 $i_{\\min}$：\n$$\n5\\cos^2 i_{\\min} - 3 = 0 \\implies \\cos^2 i_{\\min} = \\frac{3}{5}\n$$\n将此代入最大偏心率点（$e=e_{\\max}, i=i_{\\min}$）的守恒定律中：\n$$\n(1-e_{\\max}^2)\\cos^2 i_{\\min} = \\cos^2 i_0\n$$\n$$\n(1-e_{\\max}^2) \\left(\\frac{3}{5}\\right) = \\cos^2 i_0\n$$\n解出 $e_{\\max}^2$ 得：\n$$\n1-e_{\\max}^2 = \\frac{5}{3}\\cos^2 i_0 \\implies e_{\\max}^2 = 1 - \\frac{5}{3}\\cos^2 i_0\n$$\n因此，最大偏心率为：\n$$\ne_{\\max}(i_0) = \\sqrt{1 - \\frac{5}{3}\\cos^2 i_0}\n$$\n仅当平方根下的项为非负时，此表达式才能为 $e_{\\max}$ 产生一个实数非负值。这直接导出了对于初始圆形轨道发生 KL 振荡的条件：\n$$\n\\cos^2 i_0 \\le \\frac{3}{5}\n$$\n如果不满足此条件（即，如果 $|\\cos i_0| > \\sqrt{3/5}$），近心点辐角会周转，偏心率只经历小幅振荡。在这种情况下，最大偏心率实际上为零，$e_{\\max}=0$。临界倾角为 $i_{crit} = \\arccos(\\sqrt{3/5}) \\approx 39.2^\\circ$ 和 $\\pi - i_{crit} \\approx 140.8^\\circ$。\n\n### 概率 $P(\\alpha, e_{\\mathrm{thr}})$ 的推导\n\n我们已知初始倾角 $i_0$ 在区间 $i_0 \\in [0, \\pi]$ 上的概率密度函数 (PDF)：\n$$\nf(i;\\alpha) = C(\\alpha)\\,\\sin i\\,\\bigl(1 + \\alpha \\cos^2 i\\bigr)\n$$\n首先，我们通过要求 $\\int_{0}^{\\pi} f(i;\\alpha)\\,di = 1$ 来找到归一化常数 $C(\\alpha)$。我们进行变量代换，令 $u = \\cos i$，则 $du = -\\sin i\\,di$。积分限从 $i \\in [0, \\pi]$ 变为 $u \\in [1, -1]$。\n$$\n\\int_{0}^{\\pi} \\sin i\\,\\bigl(1 + \\alpha \\cos^2 i\\bigr) \\,di = \\int_{1}^{-1} (1+\\alpha u^2)(-du) = \\int_{-1}^{1} (1+\\alpha u^2)\\,du\n$$\n$$\n= \\left[ u + \\frac{\\alpha}{3}u^3 \\right]_{-1}^{1} = \\left(1 + \\frac{\\alpha}{3}\\right) - \\left(-1 - \\frac{\\alpha}{3}\\right) = 2 + \\frac{2\\alpha}{3} = \\frac{2(3+\\alpha)}{3}\n$$\n归一化常数是该值的倒数：\n$$\nC(\\alpha) = \\frac{3}{2(3+\\alpha)}\n$$\n接下来，我们确定最大偏心率达到或超过给定阈值的轨道倾角集合，即 $e_{\\max}(i_0) \\ge e_{\\mathrm{thr}}$。\n$$\n\\sqrt{1 - \\frac{5}{3}\\cos^2 i_0} \\ge e_{\\mathrm{thr}}\n$$\n由于当 $e_{\\mathrm{thr}} \\in [0, 1]$ 时，不等式两边均为非负，我们可以对它们进行平方：\n$$\n1 - \\frac{5}{3}\\cos^2 i_0 \\ge e_{\\mathrm{thr}}^2 \\implies 1 - e_{\\mathrm{thr}}^2 \\ge \\frac{5}{3}\\cos^2 i_0 \\implies \\cos^2 i_0 \\le \\frac{3}{5}(1-e_{\\mathrm{thr}}^2)\n$$\n让我们定义一个临界值 $z_{crit} = \\sqrt{\\frac{3}{5}(1-e_{\\mathrm{thr}}^2)}$。条件变为 $|\\cos i_0| \\le z_{crit}$。这对应于轨道倾角范围 $i_0 \\in [\\arccos(z_{crit}), \\pi - \\arccos(z_{crit})]$。\n\n概率 $P(\\alpha, e_{\\mathrm{thr}})$ 是 PDF 在此范围内的积分：\n$$\nP(\\alpha, e_{\\mathrm{thr}}) = \\int_{\\arccos(z_{crit})}^{\\pi-\\arccos(z_{crit})} C(\\alpha)\\,\\sin i\\,\\bigl(1 + \\alpha \\cos^2 i\\bigr)\\,di\n$$\n使用相同的代换 $u=\\cos i$，$u$ 的积分限变为 $[\\cos(\\arccos(z_{crit})), \\cos(\\pi-\\arccos(z_{crit}))] = [z_{crit}, -z_{crit}]$。\n$$\nP(\\alpha, e_{\\mathrm{thr}}) = C(\\alpha) \\int_{z_{crit}}^{-z_{crit}} (1+\\alpha u^2)(-du) = C(\\alpha) \\int_{-z_{crit}}^{z_{crit}} (1+\\alpha u^2)\\,du\n$$\n$$\n= C(\\alpha) \\left[ u + \\frac{\\alpha}{3}u^3 \\right]_{-z_{crit}}^{z_{crit}} = C(\\alpha) \\left( 2z_{crit} + \\frac{2\\alpha}{3}z_{crit}^3 \\right) = 2C(\\alpha)z_{crit}\\left(1 + \\frac{\\alpha}{3}z_{crit}^2\\right)\n$$\n代入 $C(\\alpha)$、$z_{crit}$ 和 $z_{crit}^2$ 的表达式：\n$$\nP(\\alpha, e_{\\mathrm{thr}}) = 2\\left(\\frac{3}{2(3+\\alpha)}\\right) \\sqrt{\\frac{3}{5}(1-e_{\\mathrm{thr}}^2)} \\left(1 + \\frac{\\alpha}{3}\\frac{3}{5}(1-e_{\\mathrm{thr}}^2)\\right)\n$$\n$$\nP(\\alpha, e_{\\mathrm{thr}}) = \\frac{3}{3+\\alpha} \\sqrt{\\frac{3}{5}(1-e_{\\mathrm{thr}}^2)} \\left(1 + \\frac{\\alpha}{5}(1-e_{\\mathrm{thr}}^2)\\right)\n$$\n这就是所求概率的最终解析表达式。它对于 $e_{\\mathrm{thr}} \\in [0, 1)$ 有效。对于 $e_{\\mathrm{thr}} \\ge 1$，我们有 $1-e_{\\mathrm{thr}}^2 \\le 0$，这使得 $z_{crit}=0$（或为虚数），因此 $P(\\alpha, e_{\\mathrm{thr}}) = 0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the probability P(alpha, e_thr) that a system with initial\n    inclination drawn from a given PDF will exceed a threshold eccentricity\n    due to Kozai-Lidov oscillations.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (alpha, e_thr)\n        (0.0, 0.0),\n        (0.0, 0.5),\n        (0.0, 0.99),\n        (-1.0, 0.0),\n        (5.0, 0.5),\n        (0.0, 1.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha, e_thr = case\n\n        # The probability is zero if the threshold eccentricity is 1 or greater,\n        # as reaching e=1 requires a set of initial conditions of measure zero.\n        if e_thr = 1.0:\n            prob = 0.0\n        else:\n            # The analytical formula derived from first principles is:\n            # P(alpha, e_thr) = (3 / (3 + alpha)) * z_crit * (1 + (alpha / 5) * (1-e_thr^2))\n            # where z_crit = sqrt((3/5) * (1 - e_thr^2))\n\n            e_thr_sq = e_thr**2\n            one_minus_e_thr_sq = 1.0 - e_thr_sq\n            \n            z_crit_val = np.sqrt((3.0 / 5.0) * one_minus_e_thr_sq)\n\n            term1 = 3.0 / (3.0 + alpha)\n            term2 = 1.0 + (alpha / 5.0) * one_minus_e_thr_sq\n            \n            prob = term1 * z_crit_val * term2\n\n        results.append(prob)\n\n    # Format the output as a comma-separated list of floats rounded to\n    # six decimal places, enclosed in square brackets.\n    # The format specifier ensures trailing zeros, e.g., 0.0 -> 0.000000\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}