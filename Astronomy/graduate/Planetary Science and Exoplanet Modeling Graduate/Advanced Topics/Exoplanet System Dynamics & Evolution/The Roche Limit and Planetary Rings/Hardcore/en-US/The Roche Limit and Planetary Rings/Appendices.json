{
    "hands_on_practices": [
        {
            "introduction": "The existence and location of planetary rings are fundamentally governed by a gravitational tug-of-war. A body held together by its own gravity, such as a moon or comet, will be torn apart by a planet's tidal forces if it ventures within a critical distance known as the Roche limit. This foundational exercise provides hands-on practice in applying the Roche limit formula, demonstrating how a body's composition, through its mean density $\\rho_s$, plays a crucial role in determining its survival threshold within a planetary system .",
            "id": "4184316",
            "problem": "A synchronously rotating, homogeneous, strengthless fluid satellite on a circular orbit around a spherically symmetric planet experiences tidal forces that can unbind it once its surface passes through the inner Lagrange point of the effective potential in the corotating frame. Starting from Newtonian gravity, the corotating-frame effective potential, and hydrostatic equilibrium, derive the scaling of the critical disruption orbital radius (the fluid Roche limit) $a_{R}$ in terms of the planet’s mean density $\\rho_{p}$, the satellite’s mean density $\\rho_{s}$, and the planet’s radius $R_{p}$. Show that the scaling has the form $a_{R} = k_{f}\\,R_{p}\\,(\\rho_{p}/\\rho_{s})^{1/3}$, where $k_{f}$ is a dimensionless constant determined by solving for the critical Roche equipotential for a fluid body. Use the well-established value $k_{f} = 2.44$ appropriate for a homogeneous, synchronously rotating, strengthless fluid.\n\nThen, for Jupiter with $R_{p} = 7.15\\times 10^{7}\\ \\mathrm{m}$ and $\\rho_{p} = 1326\\ \\mathrm{kg\\,m^{-3}}$, compute the fluid Roche limits $a_{R}$ for two satellite compositions: icy with $\\rho_{s} = 900\\ \\mathrm{kg\\,m^{-3}}$ and rocky with $\\rho_{s} = 3000\\ \\mathrm{kg\\,m^{-3}}$. Perform the calculation in meters and also express each result in units of $R_{p}$.\n\nFinally, report as your single final result the ratio $a_{R,\\mathrm{icy}}/a_{R,\\mathrm{rocky}}$ rounded to four significant figures. Express the final answer as a pure number without units.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of celestial mechanics, specifically the concept of the Roche limit. The problem is well-posed, providing all necessary physical constants and parameters for a unique solution. The language is objective and the values provided for planetary and satellite properties are physically realistic.\n\nThe problem first asks for a derivation of the scaling law for the fluid Roche limit, $a_{R}$. This limit is the orbital distance at which a fluid satellite held together only by its own gravity is disrupted by the tidal forces of a central planet. The derivation proceeds by comparing a satellite's self-gravity with the tidal forces exerted by the planet.\n\nLet the planet have mass $M_{p}$, mean density $\\rho_{p}$, and radius $R_{p}$. Let the satellite have mass $M_{s}$, mean density $\\rho_{s}$, and radius $R_{s}$. The two bodies are in a circular orbit with separation $a$. We assume the satellite is much less massive than the planet, $M_{s} \\ll M_{p}$.\n\nConsider a small mass element $m$ on the surface of the satellite at the sub-planetary point (the point closest to the planet). In a reference frame comoving and co-accelerating with the center of mass of the satellite, this mass element experiences three primary forces along the line connecting the centers of the two bodies:\n$1$. The inward gravitational pull from the satellite, $F_{g,s}$.\n$2$. The outward gravitational pull from the planet, $F_{g,p}$.\n$3$. The outward fictitious force arising from the reference frame's acceleration, which is due to the planet's gravity at the satellite's center of mass. The combination of forces $2$ and $3$ constitutes the tidal force.\n\nThe self-gravitational acceleration of the satellite at its surface, pulling the mass element $m$ inward, is:\n$$\ng_{s} = \\frac{G M_{s}}{R_{s}^{2}}\n$$\nThe tidal acceleration from the planet, pulling the mass element $m$ outward (away from the satellite's center), is the difference between the planet's gravitational acceleration at the satellite's surface ($r = a - R_s$) and its gravitational acceleration at the satellite's center ($r = a$):\n$$\na_{\\text{tidal}} = \\frac{G M_{p}}{(a - R_{s})^{2}} - \\frac{G M_{p}}{a^{2}}\n$$\nWe can factor out $\\frac{G M_{p}}{a^{2}}$ and use the binomial approximation $(1-x)^{-2} \\approx 1+2x$ for small $x = R_{s}/a$, which is valid since the satellite's radius is much smaller than the orbital separation:\n$$\na_{\\text{tidal}} = \\frac{G M_{p}}{a^{2}} \\left[ \\left(1 - \\frac{R_{s}}{a}\\right)^{-2} - 1 \\right] \\approx \\frac{G M_{p}}{a^{2}} \\left[ \\left(1 + 2\\frac{R_{s}}{a}\\right) - 1 \\right] = \\frac{2 G M_{p} R_{s}}{a^{3}}\n$$\nThe Roche limit, $a_R$, is the orbital distance $a$ at which the outward tidal acceleration equals the inward self-gravitational acceleration. Setting $g_{s} = a_{\\text{tidal}}$ at $a = a_{R}$:\n$$\n\\frac{G M_{s}}{R_{s}^{2}} = \\frac{2 G M_{p} R_{s}}{a_{R}^{3}}\n$$\nSolving for $a_{R}^{3}$:\n$$\na_{R}^{3} = 2 \\frac{M_{p}}{M_{s}} R_{s}^{3}\n$$\nThe masses of the planet and satellite can be expressed in terms of their mean densities and radii, assuming spherical shapes:\n$M_{p} = \\frac{4}{3}\\pi R_{p}^{3} \\rho_{p}$ and $M_{s} = \\frac{4}{3}\\pi R_{s}^{3} \\rho_{s}$. Substituting these into the equation for $a_{R}^{3}$:\n$$\na_{R}^{3} = 2 \\frac{\\frac{4}{3}\\pi R_{p}^{3} \\rho_{p}}{\\frac{4}{3}\\pi R_{s}^{3} \\rho_{s}} R_{s}^{3} = 2 \\frac{\\rho_{p}}{\\rho_{s}} R_{p}^{3}\n$$\nTaking the cube root of both sides gives the scaling of the Roche limit:\n$$\na_{R} = (2)^{1/3} R_{p} \\left(\\frac{\\rho_{p}}{\\rho_{s}}\\right)^{1/3}\n$$\nThis derivation confirms the required scaling form, $a_{R} = k\\,R_{p}\\,(\\rho_{p}/\\rho_{s})^{1/3}$. The constant $k = 2^{1/3} \\approx 1.26$ derived here is for a perfectly rigid, spherical satellite. For a strengthless fluid satellite, tidal forces deform the body into an elongated (prolate) shape, which brings its surface closer to the central body and enhances the tidal disruption. A more complete calculation, which involves finding the shape of the Roche equipotential surface, yields a larger constant. The problem provides this established value for a homogeneous fluid satellite, $k_{f} = 2.44$. We use this value for the subsequent calculations. The general formula is:\n$$\na_{R} = k_{f}\\,R_{p}\\,\\left(\\frac{\\rho_{p}}{\\rho_{s}}\\right)^{1/3}\n$$\nNext, we compute the fluid Roche limits for icy and rocky satellites orbiting Jupiter using the given parameters: $k_{f} = 2.44$, $R_{p} = 7.15 \\times 10^{7}\\ \\mathrm{m}$, and $\\rho_{p} = 1326\\ \\mathrm{kg\\,m^{-3}}$.\n\nFor the icy satellite, $\\rho_{s, \\text{icy}} = 900\\ \\mathrm{kg\\,m^{-3}}$:\n$$\na_{R, \\text{icy}} = 2.44 \\times (7.15 \\times 10^{7}\\ \\mathrm{m}) \\times \\left(\\frac{1326}{900}\\right)^{1/3}\n$$\n$$\na_{R, \\text{icy}} \\approx (1.7446 \\times 10^{8}\\ \\mathrm{m}) \\times (1.47333)^{1/3} \\approx (1.7446 \\times 10^{8}\\ \\mathrm{m}) \\times 1.13781 \\approx 1.985 \\times 10^{8}\\ \\mathrm{m}\n$$\nIn units of Jupiter's radius $R_{p}$:\n$$\n\\frac{a_{R, \\text{icy}}}{R_{p}} = 2.44 \\times \\left(\\frac{1326}{900}\\right)^{1/3} \\approx 2.776\\ R_{p}\n$$\nFor the rocky satellite, $\\rho_{s, \\text{rocky}} = 3000\\ \\mathrm{kg\\,m^{-3}}$:\n$$\na_{R, \\text{rocky}} = 2.44 \\times (7.15 \\times 10^{7}\\ \\mathrm{m}) \\times \\left(\\frac{1326}{3000}\\right)^{1/3}\n$$\n$$\na_{R, \\text{rocky}} \\approx (1.7446 \\times 10^{8}\\ \\mathrm{m}) \\times (0.442)^{1/3} \\approx (1.7446 \\times 10^{8}\\ \\mathrm{m}) \\times 0.76170 \\approx 1.329 \\times 10^{8}\\ \\mathrm{m}\n$$\nIn units of Jupiter's radius $R_{p}$:\n$$\n\\frac{a_{R, \\text{rocky}}}{R_{p}} = 2.44 \\times \\left(\\frac{1326}{3000}\\right)^{1/3} \\approx 1.859\\ R_{p}\n$$\nFinally, we compute the ratio $a_{R,\\mathrm{icy}}/a_{R,\\mathrm{rocky}}$. We can use the symbolic expressions to simplify the calculation:\n$$\n\\frac{a_{R,\\mathrm{icy}}}{a_{R,\\mathrm{rocky}}} = \\frac{k_{f}\\,R_{p}\\,(\\rho_{p}/\\rho_{s,\\mathrm{icy}})^{1/3}}{k_{f}\\,R_{p}\\,(\\rho_{p}/\\rho_{s,\\mathrm{rocky}})^{1/3}}\n$$\nThe terms $k_{f}$, $R_{p}$, and $\\rho_{p}^{1/3}$ cancel, leaving:\n$$\n\\frac{a_{R,\\mathrm{icy}}}{a_{R,\\mathrm{rocky}}} = \\frac{(\\rho_{s,\\mathrm{icy}})^{-1/3}}{(\\rho_{s,\\mathrm{rocky}})^{-1/3}} = \\left(\\frac{\\rho_{s,\\mathrm{rocky}}}{\\rho_{s,\\mathrm{icy}}}\\right)^{1/3}\n$$\nSubstituting the given density values:\n$$\n\\frac{a_{R,\\mathrm{icy}}}{a_{R,\\mathrm{rocky}}} = \\left(\\frac{3000\\ \\mathrm{kg\\,m^{-3}}}{900\\ \\mathrm{kg\\,m^{-3}}}\\right)^{1/3} = \\left(\\frac{10}{3}\\right)^{1/3}\n$$\nNumerically, this is:\n$$\n\\left(3.3333...\\right)^{1/3} \\approx 1.49380158\n$$\nRounding to four significant figures, the ratio is $1.494$.",
            "answer": "$$\n\\boxed{1.494}\n$$"
        },
        {
            "introduction": "While the Roche limit explains why rings are confined to regions close to their host planet, it does not describe the intricate structures observed within them. In dense systems like Saturn's rings, the mutual gravity of the ring particles themselves becomes a significant force, leading to clumping and the formation of transient spiral structures called \"self-gravity wakes.\" This practice delves into the collective dynamics of a particulate disk by introducing the Toomre $Q$ stability parameter, which quantifies the balance between this destabilizing self-gravity and the stabilizing effects of velocity dispersion and orbital shear .",
            "id": "4184326",
            "problem": "Consider a dense, self-gravitating planetary ring around a spherically symmetric planet of mass $M_{p}$, at cylindrical radius $r$. Model the ring locally as a razor-thin, particulate disk with surface mass density $\\Sigma$ and an isotropic radial velocity dispersion $c$ that provides an effective pressure response. Assume Newtonian gravity and a near-Keplerian rotation profile. In a co-rotating, local Cartesian patch (the shearing sheet), linearize the continuity and momentum equations for axisymmetric plane-wave perturbations of the form $\\propto \\exp\\!\\left[i\\left(kx - \\omega t\\right)\\right]$, and include the self-gravitational attraction of the sheet via the razor-thin Poisson response. Using the fact that the epicyclic frequency $\\kappa$ characterizes radial oscillations in the background potential and that for a Keplerian potential $\\kappa = \\Omega$, where $\\Omega$ is the orbital angular frequency, derive the condition for marginal axisymmetric stability and identify the associated dimensionless stability parameter $Q$ in terms of $\\Sigma$, $c$, $\\kappa$, and the Newtonian gravitational constant $G$.\n\nThen, for a ring at $r = 1.0 \\times 10^{8}\\ \\mathrm{m}$ orbiting a planet with $M_{p} = 5.68 \\times 10^{26}\\ \\mathrm{kg}$, with $\\Sigma = 500\\ \\mathrm{kg\\,m^{-2}}$, $c = 1\\ \\mathrm{mm\\,s^{-1}}$, and $\\kappa = \\Omega$ at that radius, evaluate $Q$ numerically. Use $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$. Round your final numerical value of $Q$ to three significant figures and report it as a dimensionless number.",
            "solution": "The goal is to obtain the axisymmetric stability criterion for a razor-thin, self-gravitating disk and to identify the dimensionless parameter $Q$ that measures the balance between stabilizing kinematics (velocity dispersion and epicyclic restoration) and destabilizing self-gravity.\n\nWe begin from Newtonian gravity in a differentially rotating disk. In the local, co-rotating shearing sheet, let $(x,y)$ denote the radial and azimuthal directions. For small, axisymmetric perturbations with radial wavenumber $k$ and frequency $\\omega$, we linearize the fluid-like equations appropriate to a particulate ring with isotropic velocity dispersion $c$ that acts as an effective pressure. The continuity equation and the momentum equations (including Coriolis and tidal terms) yield, after standard linearization, a dispersion relation of the form\n$$\n\\omega^{2} \\;=\\; \\kappa^{2} \\;-\\; 2\\pi G \\Sigma\\,|k| \\;+\\; c^{2}k^{2}.\n$$\nThis result follows from the combination of (i) epicyclic restoring dynamics embodied in $\\kappa$, (ii) the self-gravitational response of a razor-thin sheet, for which the perturbed gravitational potential obeys the two-dimensional Poisson relation yielding a force term proportional to $2\\pi G \\Sigma\\,|k|$, and (iii) the effective pressure response $c^{2}k^{2}$ for short-wavelength support due to velocity dispersion.\n\nAxisymmetric stability requires $\\omega^{2} \\geq 0$ for all $k$. To find the most unstable (or least stable) wavenumber, we minimize $\\omega^{2}$ with respect to $|k|$. Define $K \\equiv |k|$ and consider\n$$\n\\omega^{2}(K) \\;=\\; \\kappa^{2} \\;-\\; 2\\pi G \\Sigma\\,K \\;+\\; c^{2}K^{2}.\n$$\nMinimization with respect to $K$ gives\n$$\n\\frac{d\\omega^{2}}{dK} \\;=\\; -2\\pi G \\Sigma \\;+\\; 2c^{2}K \\;=\\; 0\n\\quad\\Rightarrow\\quad\nK_{\\mathrm{crit}} \\;=\\; \\frac{\\pi G \\Sigma}{c^{2}}.\n$$\nEvaluating $\\omega^{2}$ at $K_{\\mathrm{crit}}$,\n$$\n\\omega^{2}_{\\min} \\;=\\; \\kappa^{2} \\;-\\; 2\\pi G \\Sigma\\,\\frac{\\pi G \\Sigma}{c^{2}} \\;+\\; c^{2}\\left(\\frac{\\pi G \\Sigma}{c^{2}}\\right)^{2}\n\\;=\\; \\kappa^{2} \\;-\\; \\frac{(\\pi G \\Sigma)^{2}}{c^{2}}.\n$$\nThe marginal stability condition is $\\omega^{2}_{\\min} = 0$, which implies\n$$\n\\kappa^{2} \\;=\\; \\frac{(\\pi G \\Sigma)^{2}}{c^{2}}\n\\quad\\Rightarrow\\quad\n\\frac{c\\,\\kappa}{\\pi G \\Sigma} \\;=\\; 1.\n$$\nThis motivates the definition of the Toomre stability parameter\n$$\nQ \\;\\equiv\\; \\frac{c\\,\\kappa}{\\pi G \\Sigma},\n$$\nwith the axisymmetric stability criterion $Q \\geq 1$.\n\nFor a Keplerian potential generated by a spherically symmetric mass $M_{p}$, the orbital angular frequency is\n$$\n\\Omega \\;=\\; \\sqrt{\\frac{G M_{p}}{r^{3}}}.\n$$\nIn a strictly Keplerian field, the epicyclic frequency equals the orbital frequency, so $\\kappa = \\Omega$.\n\nWe are given $r = 1.0 \\times 10^{8}\\ \\mathrm{m}$, $M_{p} = 5.68 \\times 10^{26}\\ \\mathrm{kg}$, $\\Sigma = 500\\ \\mathrm{kg\\,m^{-2}}$, $c = 1\\ \\mathrm{mm\\,s^{-1}} = 1.0 \\times 10^{-3}\\ \\mathrm{m\\,s^{-1}}$, and $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$. First compute\n$$\n\\Omega \\;=\\; \\sqrt{\\frac{G M_{p}}{r^{3}}}\n\\;=\\; \\sqrt{\\frac{\\left(6.67430 \\times 10^{-11}\\right)\\left(5.68 \\times 10^{26}\\right)}{\\left(1.0 \\times 10^{8}\\right)^{3}}}\n\\;=\\; \\sqrt{\\frac{6.67430 \\times 5.68 \\times 10^{15}}{1.0 \\times 10^{24}}}\n\\;=\\; \\sqrt{3.7911 \\times 10^{-8}}\n\\;=\\; \\left(\\sqrt{3.7911}\\right)\\times 10^{-4}.\n$$\nNumerically, $\\sqrt{3.7911} \\approx 1.947$, hence\n$$\n\\Omega \\;\\approx\\; 1.947 \\times 10^{-4}\\ \\mathrm{s^{-1}},\n\\quad\\text{and thus}\\quad\n\\kappa = \\Omega \\approx 1.947 \\times 10^{-4}\\ \\mathrm{s^{-1}}.\n$$\nNow evaluate $Q$:\n$$\nQ \\;=\\; \\frac{c\\,\\kappa}{\\pi G \\Sigma}\n\\;=\\; \\frac{\\left(1.0 \\times 10^{-3}\\right)\\left(1.947 \\times 10^{-4}\\right)}{\\pi \\left(6.67430 \\times 10^{-11}\\right)\\left(500\\right)}.\n$$\nCompute the numerator:\n$$\nc\\,\\kappa \\;=\\; 1.947 \\times 10^{-7}.\n$$\nCompute the denominator:\n$$\n\\pi G \\Sigma \\;=\\; \\pi \\times \\left(6.67430 \\times 10^{-11}\\right) \\times 500\n\\;=\\; \\pi \\times \\left(3.33715 \\times 10^{-8}\\right)\n\\;\\approx\\; 3.141592653589793 \\times 3.33715 \\times 10^{-8}\n\\;\\approx\\; 1.0484 \\times 10^{-7}.\n$$\nTherefore,\n$$\nQ \\;\\approx\\; \\frac{1.947 \\times 10^{-7}}{1.0484 \\times 10^{-7}} \\;\\approx\\; 1.856.\n$$\nRounding to three significant figures, we obtain the dimensionless value\n$$\nQ \\;\\approx\\; 1.86.\n$$",
            "answer": "$$\\boxed{1.86}$$"
        },
        {
            "introduction": "Detecting and characterizing rings around distant exoplanets requires the careful interpretation of subtle photometric signals. When a ringed planet transits its star, the ring particles do not simply block starlight; they also scatter it. Light scattered at small angles in the forward direction can still reach the observer's telescope, causing the ring to appear less opaque and altering the measured transit depth in a way that depends on wavelength and particle size. This advanced problem bridges ring theory with observational astronomy, challenging you to model this key observational signature and understand how transit light curves can be used to probe the physical properties of exoplanetary rings .",
            "id": "4184359",
            "problem": "You are tasked with deriving, from first principles of radiative transfer and diffraction-limited scattering, how forward scattering by planetary ring particles modifies the transit depth of a star during an exoplanet transit. Consider a ring segment that covers a fraction $f_{\\mathrm{area}}$ of the stellar disk at mid-transit. The ring is modeled as a plane-parallel slab with normal optical depth $\\tau$, single-scattering albedo $\\omega$ (fraction of extinction that is due to scattering), and particles of characteristic radius $s$ in the Mie scattering regime (size parameter $x = 2\\pi s / \\lambda \\gg 1$), where $\\lambda$ is the observing wavelength. Assume single-scattering (neglect multiple scattering) and energy conservation in the slab.\n\nUse the following physically motivated approximations and definitions:\n- The extinction optical depth for a beam traversing the ring segment is $\\tau$.\n- The unscattered transmitted intensity through the ring is $I_0 e^{-\\tau}$, where $I_0$ is the incident stellar intensity.\n- Scattering redistributes the removed intensity $I_0 (1 - e^{-\\tau})$ into angles according to a normalized phase function $P(\\theta)$, where $\\theta$ is the polar scattering angle relative to the forward direction. The fraction of scattered light that is captured back into the observer’s line of sight during transit is the fraction of the phase function that falls within the stellar angular radius as seen from the ring, $\\alpha = R_\\star / a$, where $R_\\star$ is the stellar radius and $a$ is the star–ring distance (assume small-angle geometry; express $\\alpha$ in radians).\n- Approximate the forward scattering lobe of the phase function by a small-angle Gaussian,\n$$\nP(\\theta) = \\frac{1}{2\\pi \\sigma^2} \\exp\\!\\left(-\\frac{\\theta^2}{2\\sigma^2}\\right),\n$$\nnormalized so that $2\\pi \\int_0^\\infty P(\\theta)\\,\\theta\\,d\\theta = 1$. Here $\\sigma$ is the angular width of the forward scattering lobe, determined by diffraction as\n$$\n\\sigma = \\frac{\\lambda}{2\\pi s},\n$$\nwhich is consistent with the width of the Fraunhofer diffraction lobe for large spheres.\n\nUnder these assumptions:\n1. Derive an expression for the observed intensity $I_{\\mathrm{obs}}$ in the beam behind the ring, including the forward-scattered component that falls within the stellar angular radius $\\alpha$. Your derivation must start from energy conservation and single-scattering radiative transfer, explicitly introducing the captured fraction\n$$\nf_{\\mathrm{cap}}(\\alpha,\\sigma) = \\int_0^{\\alpha} 2\\pi P(\\theta)\\, \\sin\\theta \\, d\\theta,\n$$\nusing the small-angle approximation $\\sin\\theta \\approx \\theta$ where appropriate.\n2. From $I_{\\mathrm{obs}}$, derive the ring-induced transit depth $D_{\\mathrm{ring}} = f_{\\mathrm{area}} \\left(1 - \\frac{I_{\\mathrm{obs}}}{I_0}\\right)$ and compare it to the baseline extinction-only transit depth $D_{\\mathrm{ext}} = f_{\\mathrm{area}} \\left(1 - e^{-\\tau}\\right)$ to obtain a closed-form expression for the forward-scattering modification of the transit depth. Ensure your result is expressed in terms of $\\tau$, $\\omega$, $\\alpha$, $\\lambda$, $s$, and $f_{\\mathrm{area}}$ only.\n\nImplement your derived expression in a program that computes, for each test case below, the change in transit depth due to forward scattering,\n$$\n\\Delta D = D_{\\mathrm{ext}} - D_{\\mathrm{ring}},\n$$\nas a dimensionless decimal number. Angles must be in radians. All physical lengths must be in meters (m). Wavelengths must be in meters (m). The program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,\\dots]$.\n\nUse the Solar radius $R_\\odot = 6.957\\times 10^{8}\\ \\mathrm{m}$ and the Astronomical Unit $\\mathrm{AU} = 1.495978707\\times 10^{11}\\ \\mathrm{m}$.\n\nTest suite (each tuple specifies $(s,\\ \\tau,\\ \\omega,\\ R_\\star,\\ a,\\ \\lambda,\\ f_{\\mathrm{area}})$ in SI units):\n- Case 1 (general Mie forward-scattering): $s = 10\\times 10^{-6}\\ \\mathrm{m}$, $\\tau = 0.5$, $\\omega = 0.95$, $R_\\star = 1.0\\,R_\\odot$, $a = 0.05\\,\\mathrm{AU}$, $\\lambda = 650\\times 10^{-9}\\ \\mathrm{m}$, $f_{\\mathrm{area}} = 0.10$.\n- Case 2 (larger particles, denser ring): $s = 100\\times 10^{-6}\\ \\mathrm{m}$, $\\tau = 1.0$, $\\omega = 0.99$, $R_\\star = 0.5\\,R_\\odot$, $a = 0.10\\,\\mathrm{AU}$, $\\lambda = 550\\times 10^{-9}\\ \\mathrm{m}$, $f_{\\mathrm{area}} = 0.05$.\n- Case 3 (marginally large particles, optically thinner ring, larger star): $s = 2\\times 10^{-6}\\ \\mathrm{m}$, $\\tau = 0.1$, $\\omega = 0.9$, $R_\\star = 1.5\\,R_\\odot$, $a = 0.20\\,\\mathrm{AU}$, $\\lambda = 700\\times 10^{-9}\\ \\mathrm{m}$, $f_{\\mathrm{area}} = 0.30$.\n- Case 4 (millimeter-sized particles, highly scattering, optically thick ring): $s = 1\\times 10^{-3}\\ \\mathrm{m}$, $\\tau = 2.0$, $\\omega = 1.0$, $R_\\star = 1.0\\,R_\\odot$, $a = 0.03\\,\\mathrm{AU}$, $\\lambda = 600\\times 10^{-9}\\ \\mathrm{m}$, $f_{\\mathrm{area}} = 0.02$.\n- Case 5 (boundary check with zero single-scattering albedo): $s = 50\\times 10^{-6}\\ \\mathrm{m}$, $\\tau = 0.8$, $\\omega = 0.0$, $R_\\star = 1.0\\,R_\\odot$, $a = 0.05\\,\\mathrm{AU}$, $\\lambda = 650\\times 10^{-9}\\ \\mathrm{m}$, $f_{\\mathrm{area}} = 0.20$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,r_3,r_4,r_5]$, where each $r_i$ is the computed $\\Delta D$ for the corresponding case, expressed as a decimal number (dimensionless).",
            "solution": "The problem is to derive and quantify the effect of forward-scattered light from exoplanetary ring particles on the observed transit depth. The problem is scientifically grounded, well-posed, and all necessary parameters and physical approximations are provided. It is therefore valid.\n\nThe derivation proceeds in two main parts. First, we derive the observed intensity $I_{\\mathrm{obs}}$ of starlight passing through a ring segment, accounting for both direct transmission and forward scattering. Second, we use this intensity to calculate the modified transit depth, $D_{\\mathrm{ring}}$, and compare it to the simple extinction-only depth, $D_{\\mathrm{ext}}$, to find the depth modification, $\\Delta D$.\n\nThe observed intensity, $I_{\\mathrm{obs}}$, is the sum of the directly transmitted component, $I_{\\mathrm{transmitted}}$, and the component scattered into the line of sight, $I_{\\mathrm{fwd-scatter}}$.\n$$\nI_{\\mathrm{obs}} = I_{\\mathrm{transmitted}} + I_{\\mathrm{fwd-scatter}}\n$$\nThe directly transmitted component follows the Beer-Lambert law, where $I_0$ is the incident stellar intensity and $\\tau$ is the optical depth of the ring segment.\n$$\nI_{\\mathrm{transmitted}} = I_0 e^{-\\tau}\n$$\nThe total intensity removed from the incident beam due to extinction (absorption and scattering) is $I_0(1 - e^{-\\tau})$. The single-scattering albedo, $\\omega$, represents the fraction of this extinction that is due to scattering. Therefore, the total intensity scattered in all directions is:\n$$\nI_{\\mathrm{scattered, total}} = \\omega I_0 (1 - e^{-\\tau})\n$$\nThe problem specifies that a fraction of this scattered light is recaptured by the observer. This fraction, $f_{\\mathrm{cap}}$, corresponds to the light scattered within a cone of half-angle $\\alpha = R_\\star / a$, where $R_\\star$ is the stellar radius and $a$ is the star-ring distance. The forward-scattered intensity reaching the observer is thus:\n$$\nI_{\\mathrm{fwd-scatter}} = f_{\\mathrm{cap}} \\times I_{\\mathrm{scattered, total}} = \\omega I_0 (1 - e^{-\\tau}) f_{\\mathrm{cap}}\n$$\nThe captured fraction, $f_{\\mathrm{cap}}$, is determined by integrating the normalized phase function, $P(\\theta)$, over the solid angle subtended by the star. Using the given definition and the small-angle approximation $\\sin\\theta \\approx \\theta$:\n$$\nf_{\\mathrm{cap}}(\\alpha,\\sigma) = \\int_0^{\\alpha} 2\\pi P(\\theta)\\, \\sin\\theta \\, d\\theta \\approx \\int_0^{\\alpha} 2\\pi P(\\theta)\\, \\theta \\, d\\theta\n$$\nSubstituting the provided Gaussian phase function, $P(\\theta) = \\frac{1}{2\\pi \\sigma^2} \\exp(-\\frac{\\theta^2}{2\\sigma^2})$, where $\\sigma = \\frac{\\lambda}{2\\pi s}$ is the angular width of the forward-scattering lobe:\n$$\nf_{\\mathrm{cap}}(\\alpha,\\sigma) = \\int_0^{\\alpha} 2\\pi \\left( \\frac{1}{2\\pi \\sigma^2} \\exp\\left(-\\frac{\\theta^2}{2\\sigma^2}\\right) \\right) \\theta \\, d\\theta = \\frac{1}{\\sigma^2} \\int_0^{\\alpha} \\theta \\exp\\left(-\\frac{\\theta^2}{2\\sigma^2}\\right) \\, d\\theta\n$$\nThis integral is solved by a substitution $u = \\theta^2 / (2\\sigma^2)$, for which $du = \\theta/\\sigma^2 \\, d\\theta$.\n$$\nf_{\\mathrm{cap}}(\\alpha,\\sigma) = \\int_0^{\\alpha^2/(2\\sigma^2)} e^{-u} \\, du = \\left[-e^{-u}\\right]_0^{\\alpha^2/(2\\sigma^2)} = 1 - \\exp\\left(-\\frac{\\alpha^2}{2\\sigma^2}\\right)\n$$\nNow, we can write the full expression for the observed intensity normalized by the incident intensity, $I_{\\mathrm{obs}}/I_0$:\n$$\n\\frac{I_{\\mathrm{obs}}}{I_0} = e^{-\\tau} + \\omega(1 - e^{-\\tau}) f_{\\mathrm{cap}} = e^{-\\tau} + \\omega(1 - e^{-\\tau}) \\left[1 - \\exp\\left(-\\frac{\\alpha^2}{2\\sigma^2}\\right)\\right]\n$$\nNext, we derive the change in transit depth, $\\Delta D = D_{\\mathrm{ext}} - D_{\\mathrm{ring}}$. The transit depths are defined as $D = f_{\\mathrm{area}} (1 - I_{\\mathrm{obs}}/I_0)$, where $f_{\\mathrm{area}}$ is the fraction of the stellar disk covered by the ring.\nThe extinction-only depth, $D_{\\mathrm{ext}}$, assumes all scattered light is lost, which is equivalent to finding the depth from attenuation alone, $I_{\\mathrm{obs}} = I_{\\mathrm{transmitted}} = I_0 e^{-\\tau}$.\n$$\nD_{\\mathrm{ext}} = f_{\\mathrm{area}} \\left(1 - \\frac{I_0 e^{-\\tau}}{I_0}\\right) = f_{\\mathrm{area}}(1 - e^{-\\tau})\n$$\nThe ring depth including forward scattering, $D_{\\mathrm{ring}}$, uses the full expression for $I_{\\mathrm{obs}}$:\n$$\nD_{\\mathrm{ring}} = f_{\\mathrm{area}} \\left(1 - \\frac{I_{\\mathrm{obs}}}{I_0}\\right) = f_{\\mathrm{area}} \\left(1 - \\left\\{e^{-\\tau} + \\omega(1 - e^{-\\tau}) f_{\\mathrm{cap}}\\right\\}\\right)\n$$\nSimplifying the term in the parenthesis:\n$$\n1 - e^{-\\tau} - \\omega(1 - e^{-\\tau}) f_{\\mathrm{cap}} = (1 - e^{-\\tau}) (1 - \\omega f_{\\mathrm{cap}})\n$$\nSo, $D_{\\mathrm{ring}} = f_{\\mathrm{area}}(1 - e^{-\\tau})(1 - \\omega f_{\\mathrm{cap}})$.\nThe change in depth, $\\Delta D$, is the difference:\n$$\n\\Delta D = D_{\\mathrm{ext}} - D_{\\mathrm{ring}} = f_{\\mathrm{area}}(1 - e^{-\\tau}) - f_{\\mathrm{area}}(1 - e^{-\\tau})(1 - \\omega f_{\\mathrm{cap}})\n$$\nFactoring out the common term $f_{\\mathrm{area}}(1 - e^{-\\tau})$:\n$$\n\\Delta D = f_{\\mathrm{area}}(1 - e^{-\\tau}) \\left[1 - (1 - \\omega f_{\\mathrm{cap}})\\right] = f_{\\mathrm{area}}(1 - e^{-\\tau})(\\omega f_{\\mathrm{cap}})\n$$\nSubstituting the derived expression for $f_{\\mathrm{cap}}$:\n$$\n\\Delta D = f_{\\mathrm{area}} \\, \\omega \\, (1 - e^{-\\tau}) \\left[1 - \\exp\\left(-\\frac{\\alpha^2}{2\\sigma^2}\\right)\\right]\n$$\nFinally, we express $\\Delta D$ in terms of the fundamental parameters provided in the problem. With $\\alpha = R_\\star / a$ and $\\sigma = \\lambda / (2\\pi s)$, the argument of the exponential becomes:\n$$\n\\frac{\\alpha^2}{2\\sigma^2} = \\frac{(R_\\star/a)^2}{2(\\lambda/(2\\pi s))^2} = \\frac{R_\\star^2/a^2}{2\\lambda^2/(4\\pi^2 s^2)} = \\frac{2\\pi^2 R_\\star^2 s^2}{a^2 \\lambda^2}\n$$\nSo the final, closed-form expression for the change in transit depth is:\n$$\n\\Delta D = f_{\\mathrm{area}} \\, \\omega \\, (1 - e^{-\\tau}) \\left[1 - \\exp\\left(- \\frac{2\\pi^2 R_\\star^2 s^2}{a^2 \\lambda^2}\\right)\\right]\n$$\nThis expression will be implemented to solve for the given test cases. It correctly shows that the modification to the transit depth is zero if the single-scattering albedo $\\omega$ is zero (pure absorption) and approaches its maximum value of $f_{\\mathrm{area}}\\omega(1-e^{-\\tau})$ for very large particles or short wavelengths, where the forward-scattering peak is infinitesimally narrow and all scattered light is recaptured.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes the modification of an exoplanet transit depth\n    due to forward scattering by ring particles.\n    \"\"\"\n\n    # Physical constants in SI units (m, kg, s)\n    R_odot = 6.957e8  # Solar radius in meters\n    AU = 1.495978707e11  # Astronomical Unit in meters\n\n    # Test suite: (s, tau, omega, R_star_factor, a_factor, lambda, f_area)\n    # s: particle radius (m)\n    # tau: normal optical depth (dimensionless)\n    # omega: single-scattering albedo (dimensionless)\n    # R_star_factor: stellar radius in units of R_odot\n    # a_factor: star-ring distance in units of AU\n    # lambda: observing wavelength (m)\n    # f_area: fractional area of stellar disk covered by ring (dimensionless)\n    test_cases = [\n        (10e-6, 0.5, 0.95, 1.0, 0.05, 650e-9, 0.10),\n        (100e-6, 1.0, 0.99, 0.5, 0.10, 550e-9, 0.05),\n        (2e-6, 0.1, 0.9, 1.5, 0.20, 700e-9, 0.30),\n        (1e-3, 2.0, 1.0, 1.0, 0.03, 600e-9, 0.02),\n        (50e-6, 0.8, 0.0, 1.0, 0.05, 650e-9, 0.20),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        s, tau, omega, R_star_factor, a_factor, lam, f_area = case\n\n        # Convert stellar and orbital parameters to SI units (meters)\n        R_star = R_star_factor * R_odot\n        a = a_factor * AU\n\n        # The derived formula for the change in transit depth is:\n        # Delta_D = f_area * omega * (1 - exp(-tau)) * (1 - exp(- (2 * pi^2 * R_star^2 * s^2) / (a^2 * lambda^2)))\n\n        # Handle the case of omega = 0 separately to avoid unnecessary computation.\n        if omega == 0.0:\n            delta_D = 0.0\n            results.append(delta_D)\n            continue\n\n        # Calculate the extinction term\n        extinction_term = 1.0 - np.exp(-tau)\n\n        # Calculate the argument of the exponential in the forward-scattering term\n        # This term is derived from alpha^2 / (2 * sigma^2)\n        exp_argument = (2.0 * np.pi**2 * R_star**2 * s**2) / (a**2 * lam**2)\n\n        # Calculate the forward-scattering capture term\n        capture_term = 1.0 - np.exp(-exp_argument)\n\n        # Calculate the final change in transit depth\n        delta_D = f_area * omega * extinction_term * capture_term\n        \n        results.append(delta_D)\n\n    # Format the output as a comma-separated list in square brackets\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n\n```"
        }
    ]
}