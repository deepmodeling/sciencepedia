{
    "hands_on_practices": [
        {
            "introduction": "The first step in understanding tidal heating is to grasp the physical scale of the deformation itself. This exercise guides you through a foundational calculation: determining the height of the static tidal bulge raised on an exoplanet by its host star. By applying the definition of the displacement Love number $h_2$, you will connect the external tide-generating potential to the planet's physical response, providing a tangible estimate for the deformation that ultimately sources tidal dissipation .",
            "id": "4186433",
            "problem": "An exoplanet of mass $M_{p}$ and radius $R_{p}$ orbits a main-sequence star of mass $M_{\\star}$ on a circular, synchronous orbit of semi-major axis $a$. Assume the planet has negligible obliquity and eccentricity, and ignore rotational and centrifugal contributions to the potential, so that the dominant external forcing at the planetary surface is due to the star’s Newtonian gravitational field. The planet’s viscoelastic response at the forcing frequency is characterized by the degree-two displacement Love number $h_{2}$, defined in the standard tidal theory sense.\n\nStarting from Newton’s law of gravitation and the spherical-harmonic expansion of the star’s potential about the planet’s center, identify the leading-order, degree-two component of the tide-generating potential at the planetary surface at the substellar point. Then, using the definition of the displacement Love number $h_{2}$ and the surface gravity $g$, derive an expression for the static radial displacement $\\xi_{r}$ at the substellar point in terms of $G$, $M_{\\star}$, $a$, $R_{p}$, $M_{p}$, and $h_{2}$. Finally, compute the numerical value of $\\xi_{r}$ for the following parameter set:\n- $M_{\\star} = 0.25\\,M_{\\odot}$, with $M_{\\odot} = 1.9885 \\times 10^{30}\\ \\text{kg}$,\n- $a = 0.05\\ \\text{AU}$, with $\\text{AU} = 1.495978707 \\times 10^{11}\\ \\text{m}$,\n- $M_{p} = 6.0\\,M_{\\oplus}$, with $M_{\\oplus} = 5.972 \\times 10^{24}\\ \\text{kg}$,\n- $R_{p} = 1.8\\,R_{\\oplus}$, with $R_{\\oplus} = 6.371 \\times 10^{6}\\ \\text{m}$,\n- $h_{2} = 0.25$,\n- Gravitational constant $G = 6.67430 \\times 10^{-11}\\ \\text{m}^{3}\\ \\text{kg}^{-1}\\ \\text{s}^{-2}$.\n\nExpress the final radial displacement in meters, and round your answer to three significant figures. Angles, where relevant, should be treated in radians.",
            "solution": "The user has provided a problem in planetary science, specifically concerning the calculation of tidal deformation on an exoplanet. I will first validate the problem statement according to the specified criteria.\n\n### Step 1: Extract Givens\n- Mass of the exoplanet: $M_{p}$\n- Radius of the exoplanet: $R_{p}$\n- Mass of the star: $M_{\\star}$\n- Orbit: circular, synchronous, semi-major axis $a$\n- Obliquity: negligible\n- Eccentricity: negligible\n- Contributions to potential: Rotational and centrifugal contributions are ignored. Forcing is from the star's Newtonian gravitational field.\n- Viscoelastic response characterization: Degree-two displacement Love number $h_{2}$.\n- Task 1: Identify the leading-order, degree-two component of the tide-generating potential at the planetary surface at the substellar point.\n- Task 2: Using the definition of $h_{2}$ and surface gravity $g$, derive an expression for the static radial displacement $\\xi_{r}$ at the substellar point in terms of $G$, $M_{\\star}$, $a$, $R_{p}$, $M_{p}$, and $h_{2}$.\n- Task 3: Compute the numerical value of $\\xi_{r}$ for the parameter set:\n  - $M_{\\star} = 0.25\\,M_{\\odot}$, with $M_{\\odot} = 1.9885 \\times 10^{30}\\ \\text{kg}$\n  - $a = 0.05\\ \\text{AU}$, with $\\text{AU} = 1.495978707 \\times 10^{11}\\ \\text{m}$\n  - $M_p = 6.0\\,M_{\\oplus}$, with $M_{\\oplus} = 5.972 \\times 10^{24}\\ \\text{kg}$\n  - $R_p = 1.8\\,R_{\\oplus}$, with $R_{\\oplus} = 6.371 \\times 10^{6}\\ \\text{m}$\n  - $h_2 = 0.25$\n  - Gravitational constant $G = 6.67430 \\times 10^{-11}\\ \\text{m}^{3}\\ \\text{kg}^{-1}\\ \\text{s}^{-2}$\n- Final answer requirements: Express $\\xi_{r}$ in meters, rounded to three significant figures.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is based on fundamental principles of Newtonian gravity and standard tidal theory as applied in planetary science. The concepts of a tide-generating potential, spherical harmonic expansion, and Love numbers are well-established and form the basis of this field.\n2.  **Well-Posed**: The problem is clearly defined with a sequence of tasks that lead to a unique solution. It provides all necessary parameters and constants for the required derivation and numerical calculation.\n3.  **Objective**: The language is technical and precise, with no subjective or ambiguous statements.\n4.  **Completeness and Consistency**: The problem is self-contained. All necessary variables, constants, and simplifying assumptions (circular orbit, synchronous rotation, negligible obliquity) are provided. There are no contradictions. The assumptions are standard for an introductory treatment of static tides.\n5.  **Realism and Feasibility**: The given parameters describe a super-Earth exoplanet orbiting a red dwarf star. The mass of the star ($0.25\\,M_{\\odot}$), the close-in orbit ($0.05\\ \\text{AU}$), and the planet's properties ($M_p \\approx 6.0\\,M_{\\oplus}$, $R_p \\approx 1.8\\,R_{\\oplus}$) are physically realistic and consistent with known exoplanetary systems. A quick calculation shows the planet's bulk density is $\\rho_p \\approx 5.6 \\times 10^3\\ \\text{kg}\\cdot\\text{m}^{-3}$, which is a very reasonable value for a rocky super-Earth. The Love number $h_2=0.25$ is also a plausible value for such a planet.\n6.  **Structure and Triviality**: The problem is well-structured and non-trivial. It requires a correct application of potential theory and the definition of Love numbers, which is a standard but substantive exercise in geophysics and planetary science.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, and all provided data are consistent and physically reasonable. It is a valid problem. I will proceed with the solution.\n\n### Solution Derivation\n\nThe solution is developed in three parts as requested by the problem statement.\n\n**Part 1: Tide-Generating Potential**\nLet the center of the planet be the origin of our coordinate system. The star, of mass $M_{\\star}$, is at a position vector $\\vec{d}$, where $|\\vec{d}| = a$. A point of interest within or on the planet is located at position vector $\\vec{r}$ from the origin, with magnitude $r$. The angle between $\\vec{d}$ and $\\vec{r}$ is the zenith angle $\\theta$. The substellar point corresponds to $\\theta=0$.\n\nThe gravitational potential from the star at the point $\\vec{r}$ is:\n$$U_{\\star}(\\vec{r}) = -\\frac{G M_{\\star}}{|\\vec{d} - \\vec{r}|}$$\nUsing the law of cosines, $|\\vec{d} - \\vec{r}| = \\sqrt{a^2 + r^2 - 2ar\\cos\\theta}$. We can expand the potential in a series of Legendre polynomials, $P_{n}(\\cos\\theta)$, for $r  a$:\n$$U_{\\star}(\\vec{r}) = -\\frac{G M_{\\star}}{a} \\sum_{n=0}^{\\infty} \\left(\\frac{r}{a}\\right)^n P_n(\\cos\\theta)$$\nThe tide-generating potential, $W$, is the differential potential across the planet. It is obtained by removing the $n=0$ term (which is a constant potential) and the $n=1$ term (which corresponds to the uniform acceleration of the planet's center of mass) from the full expansion. The remaining series, starting from $n=2$, produces the tidal distortion.\n$$W(\\vec{r}) = -\\frac{G M_{\\star}}{a} \\sum_{n=2}^{\\infty} \\left(\\frac{r}{a}\\right)^n P_n(\\cos\\theta)$$\nThe leading-order, degree-two component of this potential is the $n=2$ term:\n$$W_2(r, \\theta) = -\\frac{G M_{\\star} r^2}{a^3} P_2(\\cos\\theta)$$\nwhere $P_2(x) = \\frac{1}{2}(3x^2 - 1)$.\nThe problem asks for this potential at the planetary surface, where $r=R_p$.\n$$W_2(R_p, \\theta) = -\\frac{G M_{\\star} R_p^2}{a^3} P_2(\\cos\\theta)$$\nThis is the general expression for the degree-two tide-generating potential at the surface. At the substellar point, $\\theta=0$, so $\\cos\\theta=1$. Since $P_2(1) = \\frac{1}{2}(3 \\cdot 1^2 - 1) = 1$, the potential at this specific point is:\n$$W_2|_{\\text{substellar}} = -\\frac{G M_{\\star} R_p^2}{a^3}$$\n\n**Part 2: Radial Displacement Expression**\nThe static radial displacement of the surface, $\\xi_r$, is related to the tide-generating potential, $W_2$, by the degree-two displacement Love number, $h_2$. The height of the tidal bulge is proportional to the forcing potential and inversely proportional to the planet's own surface gravity, $g$. The potential $W_2$ represents a potential well; the force is given by $-\\nabla W_2$, which points away from the center where the potential is most negative (i.e., at the substellar and anti-stellar points). Thus, the displacement $\\xi_r$ is positive (outward) at these points. The relationship is:\n$$\\xi_r(\\theta) = -\\frac{h_2 W_2(R_p, \\theta)}{g}$$\nSubstituting the expression for $W_2(R_p, \\theta)$:\n$$\\xi_r(\\theta) = -\\frac{h_2}{g} \\left(-\\frac{G M_{\\star} R_p^2}{a^3} P_2(\\cos\\theta)\\right) = \\frac{h_2}{g} \\frac{G M_{\\star} R_p^2}{a^3} P_2(\\cos\\theta)$$\nThe surface gravity of the planet is given by Newton's law of gravitation:\n$$g = \\frac{G M_p}{R_p^2}$$\nSubstituting this expression for $g$ into the equation for $\\xi_r$:\n$$\\xi_r(\\theta) = h_2 \\left(\\frac{R_p^2}{G M_p}\\right) \\left(\\frac{G M_{\\star} R_p^2}{a^3}\\right) P_2(\\cos\\theta)$$\nThe gravitational constant $G$ cancels out, leading to a simplified expression:\n$$\\xi_r(\\theta) = h_2 \\frac{M_{\\star}}{M_p} \\frac{R_p^4}{a^3} P_2(\\cos\\theta)$$\nTo find the displacement at the substellar point, we set $\\theta=0$, which gives $P_2(\\cos 0) = 1$. The final expression for the radial displacement at the substellar point is:\n$$\\xi_r = h_2 \\left(\\frac{M_{\\star}}{M_p}\\right) \\frac{R_p^4}{a^3}$$\n\n**Part 3: Numerical Calculation**\nFirst, we convert all given parameters into base SI units (meters and kilograms).\n- $M_{\\star} = 0.25 \\times (1.9885 \\times 10^{30}\\ \\text{kg}) = 4.97125 \\times 10^{29}\\ \\text{kg}$\n- $a = 0.05 \\times (1.495978707 \\times 10^{11}\\ \\text{m}) = 7.479893535 \\times 10^{9}\\ \\text{m}$\n- $M_p = 6.0 \\times (5.972 \\times 10^{24}\\ \\text{kg}) = 3.5832 \\times 10^{25}\\ \\text{kg}$\n- $R_p = 1.8 \\times (6.371 \\times 10^{6}\\ \\text{m}) = 1.14678 \\times 10^{7}\\ \\text{m}$\n- $h_2 = 0.25$ (dimensionless)\n\nNow, we substitute these values into the derived expression for $\\xi_r$:\n$$\\xi_r = (0.25) \\left(\\frac{4.97125 \\times 10^{29}\\ \\text{kg}}{3.5832 \\times 10^{25}\\ \\text{kg}}\\right) \\frac{(1.14678 \\times 10^{7}\\ \\text{m})^4}{(7.479893535 \\times 10^{9}\\ \\text{m})^3}$$\nLet's calculate the components of the expression:\n- Mass ratio: $\\frac{M_{\\star}}{M_p} = \\frac{4.97125 \\times 10^{29}}{3.5832 \\times 10^{25}} \\approx 13873.33$\n- Planetary radius to the fourth power: $R_p^4 = (1.14678 \\times 10^{7})^4 \\ \\text{m}^4 \\approx 1.73030 \\times 10^{28}\\ \\text{m}^4$\n- Semi-major axis to the third power: $a^3 = (7.479893535 \\times 10^{9})^3 \\ \\text{m}^3 \\approx 4.18593 \\times 10^{29}\\ \\text{m}^3$\n\nCombining these results:\n$$\\xi_r \\approx (0.25) \\times (13873.33) \\times \\frac{1.73030 \\times 10^{28}}{4.18593 \\times 10^{29}}\\ \\text{m}$$\n$$\\xi_r \\approx (0.25) \\times (13873.33) \\times (0.0413364)\\ \\text{m}$$\n$$\\xi_r \\approx 143.374\\ \\text{m}$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\\xi_r \\approx 143\\ \\text{m}$$",
            "answer": "$$\\boxed{143}$$"
        },
        {
            "introduction": "A planet's internal energy budget is a balance between heat production and heat loss. While tidal forces can inject enormous amounts of energy, the planet's mantle has a finite capacity to transport this heat to the surface through convection. This exercise challenges you to determine the maximum sustainable tidal heat flux a rocky planet can handle before its mantle is overwhelmed, a critical threshold that can lead to runaway melting and the formation of a global magma ocean . You will apply principles of convective heat transfer to find this geodynamic 'speed limit'.",
            "id": "4186461",
            "problem": "A rocky exoplanet with a silicate mantle of thickness $d$ is subject to volumetric tidal heating. In steady state, the planet must transport the tidally generated internal energy to space as a surface heat flux $q$. Assume the mantle is vigorously convecting, nearly isothermal in its interior at a potential temperature $T_{p}$, and bounded above by a thin thermal boundary layer beneath a surface at temperature $T_{s}$. Convection is well described by a Nusselt–Rayleigh scaling of the form $\\mathrm{Nu} = C\\,\\mathrm{Ra}^{\\beta}$ with isoviscous rheology, and the Rayleigh number is defined by $\\mathrm{Ra} = \\dfrac{\\alpha \\,\\rho\\, g\\, \\Delta T\\, d^{3}}{\\kappa\\, \\eta}$, where $\\Delta T \\equiv T_{p} - T_{s}$. The conductive thermal flux across the upper boundary layer is $q = \\mathrm{Nu}\\,k\\,\\Delta T/d$.\n\nA global magma ocean forms when the mantle potential temperature equals or exceeds the zero-pressure liquidus of peridotitic mantle, which we approximate with a linearized melting curve $T_{\\mathrm{liq}}(P) = T_{\\mathrm{liq},0} + \\gamma P$ and take the threshold at $P=0$, i.e., $T_{p} = T_{\\mathrm{liq},0}$, corresponding to fully molten conditions at the surface. Assume that avoiding a global magma ocean requires $T_{p}  T_{\\mathrm{liq},0}$, and that the maximum transportable tidal heat flux without forming a global magma ocean is achieved as $T_{p} \\to T_{\\mathrm{liq},0}^{-}$.\n\nGiven the following parameters:\n- Mantle thickness $d = 3.0 \\times 10^{6}\\ \\mathrm{m}$,\n- Gravitational acceleration $g = 15\\ \\mathrm{m\\ s^{-2}}$,\n- Density $\\rho = 4.5 \\times 10^{3}\\ \\mathrm{kg\\ m^{-3}}$,\n- Thermal expansivity $\\alpha = 3.0 \\times 10^{-5}\\ \\mathrm{K^{-1}}$,\n- Thermal diffusivity $\\kappa = 1.0 \\times 10^{-6}\\ \\mathrm{m^{2}\\ s^{-1}}$,\n- Thermal conductivity $k = 4.0\\ \\mathrm{W\\ m^{-1}\\ K^{-1}}$,\n- Dynamic viscosity (isoviscous) $\\eta = 1.0 \\times 10^{20}\\ \\mathrm{Pa\\ s}$,\n- Surface temperature $T_{s} = 300\\ \\mathrm{K}$,\n- Nusselt–Rayleigh scaling constants $C = 0.27$, $\\beta = 1/3$,\n- Zero-pressure liquidus $T_{\\mathrm{liq},0} = 2000\\ \\mathrm{K}$,\n\nderive from first principles an expression for the maximum steady tidal heat flux per unit area, $q_{\\max}$, that the planet can transport convectively without forming a global magma ocean, and then evaluate it numerically. Clearly state the chain of physical reasoning you use, starting from the definitions above and the melting-curve criterion for a global magma ocean. Round your final numerical answer to three significant figures. Express the final heat flux in $\\mathrm{W\\ m^{-2}}$.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, self-contained, and well-posed before a solution is attempted.\n\n### Step 1: Extract Givens\n-   Mantle thickness: $d = 3.0 \\times 10^{6}\\ \\mathrm{m}$\n-   Gravitational acceleration: $g = 15\\ \\mathrm{m\\ s^{-2}}$\n-   Mantle density: $\\rho = 4.5 \\times 10^{3}\\ \\mathrm{kg\\ m^{-3}}$\n-   Thermal expansivity: $\\alpha = 3.0 \\times 10^{-5}\\ \\mathrm{K^{-1}}$\n-   Thermal diffusivity: $\\kappa = 1.0 \\times 10^{-6}\\ \\mathrm{m^{2}\\ s^{-1}}$\n-   Thermal conductivity: $k = 4.0\\ \\mathrm{W\\ m^{-1}\\ K^{-1}}$\n-   Dynamic viscosity: $\\eta = 1.0 \\times 10^{20}\\ \\mathrm{Pa\\ s}$\n-   Surface temperature: $T_{s} = 300\\ \\mathrm{K}$\n-   Nusselt-Rayleigh scaling constant: $C = 0.27$\n-   Nusselt-Rayleigh scaling exponent: $\\beta = 1/3$\n-   Zero-pressure liquidus temperature: $T_{\\mathrm{liq},0} = 2000\\ \\mathrm{K}$\n-   Heat flux equation: $q = \\mathrm{Nu}\\,k\\,\\Delta T/d$\n-   Nusselt number scaling: $\\mathrm{Nu} = C\\,\\mathrm{Ra}^{\\beta}$\n-   Rayleigh number definition: $\\mathrm{Ra} = \\dfrac{\\alpha \\,\\rho\\, g\\, \\Delta T\\, d^{3}}{\\kappa\\, \\eta}$\n-   Temperature difference across the boundary layer: $\\Delta T = T_{p} - T_{s}$\n-   Condition for global magma ocean: $T_{p} \\ge T_{\\mathrm{liq},0}$\n-   Condition for maximum heat flux $q_{\\max}$: $T_{p} \\to T_{\\mathrm{liq},0}^{-}$\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a standard model of thermal convection in a planetary mantle, a core topic in geophysics and planetary science. The physical framework, including the definitions of the Rayleigh number ($\\mathrm{Ra}$), Nusselt number ($\\mathrm{Nu}$), and their relationship to heat flux ($q$), is based on established principles of fluid dynamics and heat transfer. The parameters provided are physically realistic for a large terrestrial exoplanet (a \"super-Earth\"). The condition for the formation of a magma ocean is clearly defined based on the mantle potential temperature reaching the zero-pressure solidus, which is a standard, albeit simplified, criterion used in planetary modeling. The problem is self-contained, providing all necessary equations and constants to derive a unique solution. There are no scientific or logical contradictions, and the objective is clearly stated. The parameter $\\gamma$ mentioned in the context of the melting curve is not needed for the calculation as specified, but its presence does not invalidate the problem structure. Therefore, the problem is deemed valid.\n\n### Step 3: Derivation and Solution\n\nThe goal is to derive an expression for the maximum heat flux, $q_{\\max}$, that can be transported through the planet's mantle without triggering the formation of a global magma ocean.\n\nThe surface heat flux, $q$, is given by the conductive transport across the top thermal boundary layer:\n$$q = \\mathrm{Nu}\\,\\frac{k\\,\\Delta T}{d}$$\nwhere $\\Delta T = T_p - T_s$ is the temperature difference between the mantle potential temperature $T_p$ and the surface temperature $T_s$.\n\nThe Nusselt number, $\\mathrm{Nu}$, is related to the Rayleigh number, $\\mathrm{Ra}$, by the scaling law:\n$$\\mathrm{Nu} = C\\,\\mathrm{Ra}^{\\beta}$$\nThe Rayleigh number is defined as:\n$$\\mathrm{Ra} = \\frac{\\alpha \\,\\rho\\, g\\, \\Delta T\\, d^{3}}{\\kappa\\, \\eta}$$\nFirst, we substitute the expression for the Rayleigh number into the Nusselt number scaling law:\n$$\\mathrm{Nu} = C \\left( \\frac{\\alpha \\,\\rho\\, g\\, \\Delta T\\, d^{3}}{\\kappa\\, \\eta} \\right)^{\\beta}$$\nNext, we substitute this expression for $\\mathrm{Nu}$ into the equation for the heat flux $q$:\n$$q = \\left[ C \\left( \\frac{\\alpha \\,\\rho\\, g\\, \\Delta T\\, d^{3}}{\\kappa\\, \\eta} \\right)^{\\beta} \\right] \\frac{k\\,\\Delta T}{d}$$\nWe can rearrange this expression by grouping terms involving $\\Delta T$ and $d$:\n$$q = C\\,k\\,\\frac{\\Delta T}{d} (\\Delta T)^{\\beta} \\left( \\frac{\\alpha \\,\\rho\\, g}{\\kappa\\, \\eta} \\right)^{\\beta} (d^3)^{\\beta}$$\n$$q = C\\,k\\,d^{3\\beta - 1} (\\Delta T)^{1+\\beta} \\left( \\frac{\\alpha \\,\\rho\\, g}{\\kappa\\, \\eta} \\right)^{\\beta}$$\nThis is the general expression for the heat flux $q$ as a function of the temperature drop $\\Delta T$.\n\nA crucial feature of this relationship arises for the specific case where the scaling exponent is $\\beta = 1/3$, as given in the problem. In this case, the exponent of the mantle thickness $d$ becomes:\n$$3\\beta - 1 = 3\\left(\\frac{1}{3}\\right) - 1 = 1 - 1 = 0$$\nThis means $d^{3\\beta-1} = d^0 = 1$, and the heat flux becomes independent of the mantle thickness $d$:\n$$q = C\\,k\\, (\\Delta T)^{4/3} \\left( \\frac{\\alpha \\,\\rho\\, g}{\\kappa\\, \\eta} \\right)^{1/3}$$\nThis is a classic result for isoviscous, steady-state mantle convection with a $\\beta=1/3$ scaling.\n\nThe problem states that the maximum transportable heat flux, $q_{\\max}$, is achieved at the limit where a global magma ocean is about to form. This occurs when the mantle potential temperature $T_p$ approaches the zero-pressure liquidus temperature, $T_p \\to T_{\\mathrm{liq},0}$. At this limit, the temperature difference across the boundary layer is at its maximum value:\n$$\\Delta T_{\\max} = T_{\\mathrm{liq},0} - T_{s}$$\nSubstituting $\\Delta T_{\\max}$ into our derived expression for $q$ gives the expression for the maximum heat flux, $q_{\\max}$:\n$$q_{\\max} = C\\,k\\,(T_{\\mathrm{liq},0} - T_{s})^{4/3} \\left( \\frac{\\alpha \\,\\rho\\, g}{\\kappa\\, \\eta} \\right)^{1/3}$$\nThis is the desired analytical expression derived from first principles.\n\nNow, we evaluate this expression numerically using the given parameters:\n-   $C = 0.27$\n-   $k = 4.0\\ \\mathrm{W\\ m^{-1}\\ K^{-1}}$\n-   $T_{\\mathrm{liq},0} = 2000\\ \\mathrm{K}$\n-   $T_{s} = 300\\ \\mathrm{K}$\n-   $\\alpha = 3.0 \\times 10^{-5}\\ \\mathrm{K^{-1}}$\n-   $\\rho = 4.5 \\times 10^{3}\\ \\mathrm{kg\\ m^{-3}}$\n-   $g = 15\\ \\mathrm{m\\ s^{-2}}$\n-   $\\kappa = 1.0 \\times 10^{-6}\\ \\mathrm{m^{2}\\ s^{-1}}$\n-   $\\eta = 1.0 \\times 10^{20}\\ \\mathrm{Pa\\ s}$\n\nFirst, calculate the maximum temperature difference:\n$$\\Delta T_{\\max} = 2000\\ \\mathrm{K} - 300\\ \\mathrm{K} = 1700\\ \\mathrm{K}$$\nNext, calculate the term within the parenthesis:\n$$\\frac{\\alpha \\,\\rho\\, g}{\\kappa\\, \\eta} = \\frac{(3.0 \\times 10^{-5}\\ \\mathrm{K^{-1}}) (4.5 \\times 10^{3}\\ \\mathrm{kg\\ m^{-3}}) (15\\ \\mathrm{m\\ s^{-2}})}{(1.0 \\times 10^{-6}\\ \\mathrm{m^{2}\\ s^{-1}}) (1.0 \\times 10^{20}\\ \\mathrm{Pa\\ s})}$$\n$$\\frac{\\alpha \\,\\rho\\, g}{\\kappa\\, \\eta} = \\frac{2.025\\ \\mathrm{kg\\ m^{-2}\\ s^{-2}\\ K^{-1}}}{1.0 \\times 10^{14}\\ \\mathrm{kg\\ m\\ s^{-2}}} = 2.025 \\times 10^{-14}\\ \\mathrm{m^{-3}\\ K^{-1}}$$\nNow, we can compute the components of the $q_{\\max}$ expression:\n$$(T_{\\mathrm{liq},0} - T_{s})^{4/3} = (1700)^{4/3}\\ \\mathrm{K}^{4/3} \\approx 20289.9\\ \\mathrm{K}^{4/3}$$\n$$\\left( \\frac{\\alpha \\,\\rho\\, g}{\\kappa\\, \\eta} \\right)^{1/3} = (2.025 \\times 10^{-14}\\ \\mathrm{m^{-3}\\ K^{-1}})^{1/3} \\approx 2.7255 \\times 10^{-5}\\ \\mathrm{m^{-1}\\ K^{-1/3}}$$\nFinally, combine all terms to calculate $q_{\\max}$:\n$$q_{\\max} = (0.27) \\times (4.0\\ \\mathrm{W\\ m^{-1}\\ K^{-1}}) \\times (20289.9\\ \\mathrm{K}^{4/3}) \\times (2.7255 \\times 10^{-5}\\ \\mathrm{m^{-1}\\ K^{-1/3}})$$\n$$q_{\\max} = 1.08 \\times 20289.9 \\times 2.7255 \\times 10^{-5}\\ \\mathrm{W\\ m^{-2}}$$\n$$q_{\\max} \\approx 0.597184\\ \\mathrm{W\\ m^{-2}}$$\nRounding the final answer to three significant figures gives:\n$$q_{\\max} \\approx 0.597\\ \\mathrm{W\\ m^{-2}}$$",
            "answer": "$$\\boxed{0.597}$$"
        },
        {
            "introduction": "The true behavior of a tidally heated mantle is governed by powerful, non-linear feedbacks, most notably the strong dependence of rock viscosity on temperature. This coupling means that the rate of tidal heating and the efficiency of convective heat loss both change as the planet heats up or cools down. In this practice, you will construct a numerical model to find the steady-state thermal equilibria of a planetary mantle and, crucially, determine their stability . This exercise bridges the gap between analytical theory and computational geodynamics, revealing how these feedback systems can lead to multiple possible climate states for a planet's interior.",
            "id": "4186417",
            "problem": "You are tasked with modeling the steady-state internal energy balance of a tidally heated terrestrial exoplanetary mantle. The mantle temperature is denoted by $T$ in Kelvin. The steady state is defined by the equality of total tidal heating power and the total surface heat loss power. Your program must compute the equilibrium mantle temperature $T^{\\ast}$ that solves the energy balance and assess the linear stability of that equilibrium.\n\nBase the model on the following physically grounded relations and definitions:\n\n- Energy conservation for the mantle: the net rate of change of internal energy equals production minus losses. In steady state,\n$$\nH_{\\mathrm{tid}}(T) \\;=\\; Q_{\\mathrm{loss}}(T),\n$$\nwhere $H_{\\mathrm{tid}}(T)$ is the total tidal heating power (in Watts) and $Q_{\\mathrm{loss}}(T)$ is the total heat loss power to space (in Watts).\n\n- Temperature-dependent mantle viscosity with an Arrhenius form referenced to a finite temperature:\n$$\n\\eta(T) \\;=\\; \\eta_{\\mathrm{ref}} \\,\\exp\\!\\left(\\frac{E_a}{R_g}\\left(\\frac{1}{T} - \\frac{1}{T_{\\mathrm{ref}}}\\right)\\right),\n$$\nwhere $\\eta(T)$ is viscosity in Pascal-seconds, $\\eta_{\\mathrm{ref}}$ is the reference viscosity at $T_{\\mathrm{ref}}$, $E_a$ is the activation energy in Joules per mole, and $R_g$ is the universal gas constant in Joules per mole per Kelvin.\n\n- Viscoelastic Maxwell response for tidal dissipation written in a compact scalar form. Define the Maxwell time\n$$\n\\tau_M(T) \\;=\\; \\frac{\\eta(T)}{\\mu},\n$$\nwhere $\\mu$ is the shear modulus in Pascals, and the tidal forcing angular frequency $\\omega$ in radians per second. The dimensionless dissipation factor is\n$$\nS(T) \\;=\\; \\frac{\\omega\\,\\tau_M(T)}{1 + \\left(\\omega\\,\\tau_M(T)\\right)^2}.\n$$\nLet the total tidal heating power be\n$$\nH_{\\mathrm{tid}}(T) \\;=\\; C_{\\mathrm{tid}} \\, S(T),\n$$\nwhere $C_{\\mathrm{tid}}$ is a positive amplitude parameter (in Watts) that encapsulates orbital and structural factors.\n\n- Mixed convective and conductive surface heat loss. Assume two parallel pathways across the surface: a convective pathway that covers fraction $f$ of the surface area and a conductive pathway that covers fraction $(1-f)$ of the surface area. The convective pathway obeys a Nusselt number scaling, and the conductive pathway is a stagnant-lid conduction across a thickness $d_{\\ell}$. Define the planet radius $R$ (meters), mantle thickness $d_m$ (meters), surface temperature $T_s$ (Kelvin), thermal conductivity $k_m$ (Watts per meter per Kelvin) for the mantle and $k_{\\ell}$ for the lid, density $\\rho$ (kilograms per cubic meter), thermal expansivity $\\alpha$ (inverse Kelvin), thermal diffusivity $\\kappa$ (square meters per second), and gravitational acceleration $g$ (meters per second squared). The gravitational acceleration is\n$$\ng \\;=\\; \\frac{G\\,M}{R^2},\n$$\nwhere $G$ is the gravitational constant in cubic meters per kilogram per second squared and $M$ is the planetary mass in kilograms. The thermal Rayleigh number is\n$$\n\\mathrm{Ra}(T) \\;=\\; \\frac{\\rho\\,g\\,\\alpha\\,(T - T_s)\\,d_m^3}{\\kappa\\,\\eta(T)},\n$$\nthe Nusselt number is\n$$\n\\mathrm{Nu}(T) \\;=\\; a\\,\\mathrm{Ra}(T)^{\\beta},\n$$\nwhere $a$ and $\\beta$ are positive constants, and the convective heat flux over the convective area fraction is\n$$\nq_{\\mathrm{conv}}(T) \\;=\\; \\mathrm{Nu}(T)\\,\\frac{k_m\\,(T - T_s)}{d_m}.\n$$\nThe conductive heat flux over the conductive area fraction is\n$$\nq_{\\mathrm{cond}}(T) \\;=\\; \\frac{k_{\\ell}\\,(T - T_s)}{d_{\\ell}}.\n$$\nThe total heat loss power is\n$$\nQ_{\\mathrm{loss}}(T) \\;=\\; 4\\pi R^2\\left[f\\,q_{\\mathrm{conv}}(T) + (1-f)\\,q_{\\mathrm{cond}}(T)\\right].\n$$\n\n- Linear stability of an equilibrium $T^{\\ast}$ is determined by the sign of the derivative of the net heating function $N(T) = H_{\\mathrm{tid}}(T) - Q_{\\mathrm{loss}}(T)$ at $T^{\\ast}$. The equilibrium is linearly stable if\n$$\n\\left.\\frac{d}{dT}\\big(H_{\\mathrm{tid}}(T) - Q_{\\mathrm{loss}}(T)\\big)\\right|_{T=T^{\\ast}} \\;\\; 0,\n$$\nand unstable if the derivative is positive.\n\nYour program must, for each test case below, numerically find at least one equilibrium $T^{\\ast}  T_s$ in Kelvin satisfying $H_{\\mathrm{tid}}(T^{\\ast}) = Q_{\\mathrm{loss}}(T^{\\ast})$ within a tolerance of $10^{-6}$ relative residual. If multiple equilibria exist, select the stable equilibrium with the largest temperature. For the stability assessment, approximate the derivative using a symmetric finite difference with a step of $1$ Kelvin.\n\nUse the following constants common to all cases: $G = 6.67430\\times 10^{-11}$ in cubic meters per kilogram per second squared, $R_g = 8.314462618$ in Joules per mole per Kelvin, $a = 0.53$ (dimensionless), and $\\beta = 0.30$ (dimensionless).\n\nPhysical units:\n- Temperatures must be in Kelvin.\n- Lengths are in meters.\n- Thermal conductivities are in Watts per meter per Kelvin.\n- Thermal diffusivity is in square meters per second.\n- Viscosity is in Pascal-seconds.\n- Powers are in Watts.\n- Angles are not present; no angle unit is required.\n\nTest suite parameter sets (each line is one test case, with parameters explicitly given; your program must use these numerical values as-is):\n\n1. Case A (mixed pathways):\n   - $R = 1.82\\times 10^{6}$ m, $M = 8.93\\times 10^{22}$ kg, $T_s = 250$ K, $d_m = 1.00\\times 10^{6}$ m, $d_{\\ell} = 5.00\\times 10^{4}$ m,\n   - $k_m = 4.0$ W/m/K, $k_{\\ell} = 3.0$ W/m/K, $\\rho = 3300$ kg/m$^{3}$, $\\alpha = 3.0\\times 10^{-5}$ 1/K, $\\kappa = 1.0\\times 10^{-6}$ m$^{2}$/s,\n   - $\\eta_{\\mathrm{ref}} = 1.0\\times 10^{19}$ Pa·s, $T_{\\mathrm{ref}} = 1600$ K, $E_a = 3.0\\times 10^{5}$ J/mol, $\\mu = 7.0\\times 10^{10}$ Pa,\n   - $\\omega = 2.0\\times 10^{-5}$ rad/s, $C_{\\mathrm{tid}} = 3.0\\times 10^{16}$ W, $f = 0.5$.\n\n2. Case B (conduction-only boundary, $f=0$):\n   - Identical to Case A except $f = 0.0$.\n\n3. Case C (convection-only boundary, $f=1$):\n   - Identical to Case A except $f = 1.0$.\n\n4. Case D (lower tidal frequency and higher activation energy):\n   - $R = 1.82\\times 10^{6}$ m, $M = 8.93\\times 10^{22}$ kg, $T_s = 250$ K, $d_m = 1.00\\times 10^{6}$ m, $d_{\\ell} = 5.00\\times 10^{4}$ m,\n   - $k_m = 4.0$ W/m/K, $k_{\\ell} = 3.0$ W/m/K, $\\rho = 3300$ kg/m$^{3}$, $\\alpha = 3.0\\times 10^{-5}$ 1/K, $\\kappa = 1.0\\times 10^{-6}$ m$^{2}$/s,\n   - $\\eta_{\\mathrm{ref}} = 1.0\\times 10^{19}$ Pa·s, $T_{\\mathrm{ref}} = 1600$ K, $E_a = 4.0\\times 10^{5}$ J/mol, $\\mu = 7.0\\times 10^{10}$ Pa,\n   - $\\omega = 5.0\\times 10^{-6}$ rad/s, $C_{\\mathrm{tid}} = 3.0\\times 10^{16}$ W, $f = 0.5$.\n\nAlgorithmic requirements:\n- Implement a robust root-finding procedure over the interval $[T_{\\min}, T_{\\max}]$ with $T_{\\min} = \\max(800,\\, T_s+1)$ Kelvin and $T_{\\max} = 2400$ Kelvin. Scan this interval to detect sign changes in $N(T) = H_{\\mathrm{tid}}(T) - Q_{\\mathrm{loss}}(T)$, apply bisection over each bracketing interval, and collect all roots found.\n- For each root $T^{\\ast}$, compute the finite-difference derivative of $N(T)$ at $T^{\\ast}$ with a step $h = 1$ Kelvin and classify stability according to the sign rule above.\n- Select the stable equilibrium with the largest temperature for the final report per test case. If no stable equilibrium is found, report the largest-temperature equilibrium (if any) and mark it as unstable. If no equilibrium exists in the search interval, report $\\mathrm{NaN}$ for the temperature and the boolean value $\\mathrm{False}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be a two-element list of the form $[T^{\\ast},\\,\\mathrm{stable}]$ where $T^{\\ast}$ is a floating-point number in Kelvin rounded to three decimals and $\\mathrm{stable}$ is a boolean value. For example, a valid single-case output would look like $[[1600.123,True]]$.",
            "solution": "The user has provided a problem that requires the calculation of the steady-state internal temperature of a tidally heated planetary mantle and an assessment of the equilibrium's stability. The problem is well-defined, scientifically grounded in the principles of planetary geodynamics and heat transfer, and provides all necessary parameters and equations. The validation procedure confirms its validity.\n\nThe core of the problem is to solve the nonlinear algebraic equation for thermal equilibrium, $N(T) = H_{\\mathrm{tid}}(T) - Q_{\\mathrm{loss}}(T) = 0$, for the mantle temperature $T$. The functions for tidal heating, $H_{\\mathrm{tid}}(T)$, and surface heat loss, $Q_{\\mathrm{loss}}(T)$, are complex and non-linear, involving multiple physical sub-models.\n\nFirst, we define all physical quantities as functions of temperature $T$, using the provided parameters for each test case.\n\nThe mantle viscosity, $\\eta(T)$, is given by the Arrhenius relation:\n$$\n\\eta(T) = \\eta_{\\mathrm{ref}} \\exp\\left(\\frac{E_a}{R_g}\\left(\\frac{1}{T} - \\frac{1}{T_{\\mathrm{ref}}}\\right)\\right)\n$$\nThis relationship captures the strong temperature dependence of rock deformation. As temperature increases, viscosity decreases exponentially, allowing for more vigorous convection and more efficient tidal dissipation up to a point.\n\nThe tidal heating power, $H_{\\mathrm{tid}}(T)$, depends on viscosity through the Maxwell time, $\\tau_M = \\eta(T)/\\mu$, and the dimensionless dissipation factor, $S(T)$:\n$$\nS(T) = \\frac{\\omega\\tau_M(T)}{1 + (\\omega\\tau_M(T))^2}\n$$\nThe total heating is then $H_{\\mathrm{tid}}(T) = C_{\\mathrm{tid}} S(T)$. The function $S(T)$ has a characteristic peak where the Maxwell time is comparable to the tidal forcing period, i.e., $\\omega\\tau_M(T) \\approx 1$. This means tidal heating is most efficient at a specific viscosity, and thus a specific temperature, $T_{\\mathrm{peak}}$. For $T  T_{\\mathrm{peak}}$, heating increases with temperature, while for $T  T_{\\mathrm{peak}}$, it decreases.\n\nThe heat loss power, $Q_{\\mathrm{loss}}(T)$, is a combination of stagnant-lid conduction and mantle convection, weighted by the fractional area $f$:\n$$\nQ_{\\mathrm{loss}}(T) = 4\\pi R^2\\left[f\\,q_{\\mathrm{conv}}(T) + (1-f)\\,q_{\\mathrm{cond}}(T)\\right]\n$$\nThe conductive flux is $q_{\\mathrm{cond}}(T) = k_{\\ell}(T - T_s)/d_{\\ell}$. The convective flux, $q_{\\mathrm{conv}}(T)$, is parameterized using a Nusselt-Rayleigh number scaling:\n$$\nq_{\\mathrm{conv}}(T) = \\mathrm{Nu}(T)\\frac{k_m(T - T_s)}{d_m} \\quad \\text{where} \\quad \\mathrm{Nu}(T) = a\\,\\left(\\frac{\\rho g \\alpha (T-T_s) d_m^3}{\\kappa \\eta(T)}\\right)^{\\beta}\n$$\nSince $\\eta(T)$ appears in the denominator of the Rayleigh number, $q_{\\mathrm{conv}}(T)$ is a strongly increasing function of $T$. Consequently, the total heat loss, $Q_{\\mathrm{loss}}(T)$, is a monotonically increasing function of $T$ for $T  T_s$.\n\nSolving $H_{\\mathrm{tid}}(T) = Q_{\\mathrm{loss}}(T)$ is a root-finding problem for the function $N(T)$. The intersection of the peaked $H_{\\mathrm{tid}}(T)$ curve and the monotonic $Q_{\\mathrm{loss}}(T)$ curve can yield zero, one, or multiple equilibrium temperatures. We will systematically search for these roots. The specified algorithm is to scan the temperature interval $[T_{\\min}, T_{\\max}] = [\\max(800, T_s+1), 2400]$ Kelvin for sign changes in $N(T)$ and then use a bisection method to refine the root in each identified bracket.\n\nOnce an equilibrium temperature $T^{\\ast}$ is found, its linear stability is determined by the derivative of the net heating function:\n$$\n\\left.\\frac{dN}{dT}\\right|_{T=T^{\\ast}} = \\left.\\frac{d}{dT}\\left(H_{\\mathrm{tid}}(T) - Q_{\\mathrm{loss}}(T)\\right)\\right|_{T=T^{\\ast}}\n$$\nIf $dN/dT  0$, a small positive temperature perturbation $\\delta T$ leads to $N(T^{\\ast}+\\delta T)  0$ (net cooling), which restores the system to $T^{\\ast}$. This is a stable equilibrium. Conversely, if $dN/dT  0$, the perturbation is amplified, and the equilibrium is unstable. We approximate this derivative using a symmetric finite difference with a step $h=1$ K.\n\nThe final step is to apply the selection criteria: from all found equilibria for a given set of parameters, we select the stable one with the highest temperature. If no stable equilibria exist, we select the unstable one with the highest temperature. If no equilibria are found in the search range, we report this accordingly.\n\nThis entire procedure is encapsulated in a Python script. For each test case, we define the parameters, search for roots, analyze their stability, select the appropriate result, and format it for the final output. The parameters provided allow for exploring different physical regimes, such as conduction-dominated versus convection-dominated heat loss, and different tidal heating characteristics based on activation energy and forcing frequency.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import bisect\n\ndef solve():\n    \"\"\"\n    Calculates the equilibrium mantle temperature and its stability for a tidally\n    heated exoplanet based on a set of physical models and parameters.\n    \"\"\"\n    # Universal and model constants\n    G = 6.67430e-11  # Gravitational constant, m^3 kg^-1 s^-2\n    R_g = 8.314462618  # Universal gas constant, J mol^-1 K^-1\n    a_nu = 0.53  # Nusselt number coefficient\n    beta_nu = 0.30  # Nusselt number exponent\n\n    # Test case parameters\n    test_cases = [\n        # Case A: Mixed pathways\n        {'R': 1.82e6, 'M': 8.93e22, 'Ts': 250, 'dm': 1.00e6, 'dl': 5.00e4,\n         'km': 4.0, 'kl': 3.0, 'rho': 3300, 'alpha': 3.0e-5, 'kappa': 1.0e-6,\n         'eta_ref': 1.0e19, 'T_ref': 1600, 'Ea': 3.0e5, 'mu': 7.0e10,\n         'omega': 2.0e-5, 'C_tid': 3.0e16, 'f': 0.5},\n        # Case B: Conduction-only\n        {'R': 1.82e6, 'M': 8.93e22, 'Ts': 250, 'dm': 1.00e6, 'dl': 5.00e4,\n         'km': 4.0, 'kl': 3.0, 'rho': 3300, 'alpha': 3.0e-5, 'kappa': 1.0e-6,\n         'eta_ref': 1.0e19, 'T_ref': 1600, 'Ea': 3.0e5, 'mu': 7.0e10,\n         'omega': 2.0e-5, 'C_tid': 3.0e16, 'f': 0.0},\n        # Case C: Convection-only\n        {'R': 1.82e6, 'M': 8.93e22, 'Ts': 250, 'dm': 1.00e6, 'dl': 5.00e4,\n         'km': 4.0, 'kl': 3.0, 'rho': 3300, 'alpha': 3.0e-5, 'kappa': 1.0e-6,\n         'eta_ref': 1.0e19, 'T_ref': 1600, 'Ea': 3.0e5, 'mu': 7.0e10,\n         'omega': 2.0e-5, 'C_tid': 3.0e16, 'f': 1.0},\n        # Case D: Lower frequency, higher activation energy\n        {'R': 1.82e6, 'M': 8.93e22, 'Ts': 250, 'dm': 1.00e6, 'dl': 5.00e4,\n         'km': 4.0, 'kl': 3.0, 'rho': 3300, 'alpha': 3.0e-5, 'kappa': 1.0e-6,\n         'eta_ref': 1.0e19, 'T_ref': 1600, 'Ea': 4.0e5, 'mu': 7.0e10,\n         'omega': 5.0e-6, 'C_tid': 3.0e16, 'f': 0.5},\n    ]\n\n    # Pre-calculate derived constants for each case\n    for p in test_cases:\n        p['g'] = G * p['M'] / p['R']**2\n        p['surf_area'] = 4 * np.pi * p['R']**2\n\n    # --- Helper functions for physical calculations ---\n    def eta(T, p):\n        if T = 0: return np.inf\n        # Clip the argument to avoid overflow with large Ea/Rg\n        exponent = (p['Ea'] / R_g) * (1/T - 1/p['T_ref'])\n        return p['eta_ref'] * np.exp(np.clip(exponent, -700, 700))\n\n    def H_tid(T, p):\n        viscosity = eta(T, p)\n        if np.isinf(viscosity): return 0.0\n        tau_M = viscosity / p['mu']\n        omega_tau_M = p['omega'] * tau_M\n        S_T = omega_tau_M / (1 + omega_tau_M**2)\n        return p['C_tid'] * S_T\n\n    def Q_loss(T, p):\n        delta_T = T - p['Ts']\n        if delta_T = 0: return 0.0\n        \n        q_cond = p['kl'] * delta_T / p['dl']\n        \n        if p['f']  0:\n            viscosity = eta(T, p)\n            if np.isinf(viscosity):\n                q_conv = 0.0\n            else:\n                Ra = (p['rho'] * p['g'] * p['alpha'] * delta_T * p['dm']**3) / (p['kappa'] * viscosity)\n                if Ra  0:\n                    Nu = a_nu * Ra**beta_nu\n                    q_conv = Nu * p['km'] * delta_T / p['dm']\n                else:\n                    q_conv = 0.0\n        else:\n            q_conv = 0.0\n            \n        return p['surf_area'] * (p['f'] * q_conv + (1 - p['f']) * q_cond)\n\n    def N_net(T, p):\n        return H_tid(T, p) - Q_loss(T, p)\n\n    all_results = []\n    \n    # --- Main loop over test cases ---\n    for p in test_cases:\n        T_min = max(800.0, p['Ts'] + 1.0)\n        T_max = 2400.0\n        \n        roots = []\n        scan_temps = np.arange(T_min, T_max + 1.0, 1.0)\n        for i in range(len(scan_temps) - 1):\n            t1, t2 = scan_temps[i], scan_temps[i+1]\n            try:\n                n1, n2 = N_net(t1, p), N_net(t2, p)\n                if not (np.isfinite(n1) and np.isfinite(n2)): continue\n                if np.sign(n1) != np.sign(n2):\n                    root = bisect(lambda T: N_net(T, p), t1, t2, xtol=1e-9, rtol=1e-9)\n                    \n                    # Verify relative residual condition\n                    q_val = Q_loss(root, p)\n                    n_val = N_net(root, p)\n                    if q_val == 0 or abs(n_val / q_val)  1e-6:\n                        roots.append(root)\n\n            except (ValueError, RuntimeError):\n                continue\n        \n        equilibria = []\n        unique_roots = sorted(list(set(roots)))\n        for T_star in unique_roots:\n            h = 1.0\n            dN_dT = (N_net(T_star + h, p) - N_net(T_star - h, p)) / (2 * h)\n            if not np.isfinite(dN_dT): continue # Skip if derivative is ill-defined\n            is_stable = dN_dT  0\n            equilibria.append({'T_star': T_star, 'stable': is_stable})\n\n        if not equilibria:\n            result = [np.nan, False]\n        else:\n            stable_equilibria = [eq for eq in equilibria if eq['stable']]\n            if stable_equilibria:\n                best_eq = max(stable_equilibria, key=lambda x: x['T_star'])\n            else:\n                best_eq = max(equilibria, key=lambda x: x['T_star'])\n            result = [best_eq['T_star'], best_eq['stable']]\n        \n        all_results.append(result)\n\n    # --- Format and print final output ---\n    output_parts = []\n    for T_star, is_stable in all_results:\n        if np.isnan(T_star):\n            T_str = 'NaN'\n        else:\n            T_str = f\"{T_star:.3f}\"\n        stable_str = str(is_stable)\n        output_parts.append(f\"[{T_str},{stable_str}]\")\n        \n    print(f\"[{','.join(output_parts)}]\")\n\nsolve()\n```"
        }
    ]
}