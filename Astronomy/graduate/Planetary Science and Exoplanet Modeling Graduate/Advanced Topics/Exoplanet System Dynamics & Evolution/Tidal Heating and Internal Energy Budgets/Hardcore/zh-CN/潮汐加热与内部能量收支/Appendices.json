{
    "hands_on_practices": [
        {
            "introduction": "潮汐力的最直接后果是在行星表面引起物理变形，形成“潮汐隆起”。我们的第一个练习将抽象的潮汐势概念转化为一个可触及的物理量：行星表面的径向位移。通过这个计算，你将掌握如何应用引力势的球谐展开，并理解位移勒夫数 $h_2$ 在连接外部引力场与行星响应中的关键作用。",
            "id": "4186433",
            "problem": "一颗质量为 $M_{p}$、半径为 $R_{p}$ 的系外行星，在一条半长轴为 $a$ 的圆形同步轨道上环绕一颗质量为 $M_{\\star}$ 的主序星运行。假设该行星的转轴倾角和偏心率可忽略不计，并忽略旋转和离心力对势的贡献，因此行星表面的主要外部作用力源于恒星的牛顿引力场。在强迫频率下，行星的黏弹性响应由二阶位移勒夫数 $h_{2}$ 表征，该勒夫数在标准潮汐理论意义下定义。\n\n从牛顿万有引力定律和恒星势能绕行星中心的球谐展开出发，确定在行星表面的星下点处，引潮势的领头阶二阶分量。然后，使用位移勒夫数 $h_{2}$ 的定义和表面重力 $g$，推导在星下点处的静态径向位移 $\\xi_{r}$ 的表达式，该表达式用 $G$、$M_{\\star}$、$a$、$R_{p}$、$M_{p}$ 和 $h_{2}$ 表示。最后，对于以下参数集，计算 $\\xi_{r}$ 的数值：\n- $M_{\\star} = 0.25\\,M_{\\odot}$，其中 $M_{\\odot} = 1.9885 \\times 10^{30}\\ \\text{kg}$，\n- $a = 0.05\\ \\text{AU}$，其中 $\\text{AU} = 1.495978707 \\times 10^{11}\\ \\text{m}$，\n- $M_{p} = 6.0\\,M_{\\oplus}$，其中 $M_{\\oplus} = 5.972 \\times 10^{24}\\ \\text{kg}$，\n- $R_{p} = 1.8\\,R_{\\oplus}$，其中 $R_{\\oplus} = 6.371 \\times 10^{6}\\ \\text{m}$，\n- $h_{2} = 0.25$，\n- 引力常数 $G = 6.67430 \\times 10^{-11}\\ \\text{m}^{3}\\ \\text{kg}^{-1}\\ \\text{s}^{-2}$。\n\n以米为单位表示最终的径向位移，并将答案四舍五入到三位有效数字。相关角度应以弧度处理。",
            "solution": "用户提供了一个行星科学领域的问题，具体涉及系外行星上潮汐形变的计算。我将首先根据指定标准验证该问题陈述。\n\n### 步骤1：提取已知条件\n- 系外行星质量：$M_{p}$\n- 系外行星半径：$R_{p}$\n- 恒星质量：$M_{\\star}$\n- 轨道：圆形、同步，半长轴为 $a$\n- 转轴倾角：可忽略\n- 偏心率：可忽略\n- 对势的贡献：旋转和离心力的贡献被忽略。作用力来自恒星的牛顿引力场。\n- 黏弹性响应表征：二阶位移勒夫数 $h_{2}$。\n- 任务1：确定在行星表面的星下点处，引潮势的领头阶二阶分量。\n- 任务2：使用 $h_{2}$ 和表面重力 $g$ 的定义，推导在星下点处的静态径向位移 $\\xi_{r}$ 的表达式，用 $G$、$M_{\\star}$、$a$、$R_{p}$、$M_{p}$ 和 $h_{2}$ 表示。\n- 任务3：根据给定的参数集计算 $\\xi_{r}$ 的数值：\n  - $M_{\\star} = 0.25\\,M_{\\odot}$，其中 $M_{\\odot} = 1.9885 \\times 10^{30}\\ \\text{kg}$\n  - $a = 0.05\\ \\text{AU}$，其中 $\\text{AU} = 1.495978707 \\times 10^{11}\\ \\text{m}$\n  - $M_{p} = 6.0\\,M_{\\oplus}$，其中 $M_{\\oplus} = 5.972 \\times 10^{24}\\ \\text{kg}$\n  - $R_{p} = 1.8\\,R_{\\oplus}$，其中 $R_{\\oplus} = 6.371 \\times 10^{6}\\ \\text{m}$\n  - $h_{2} = 0.25$\n  - 引力常数 $G = 6.67430 \\times 10^{-11}\\ \\text{m}^{3}\\ \\text{kg}^{-1}\\ \\text{s}^{-2}$\n- 最终答案要求：以米为单位表示 $\\xi_{r}$，并四舍五入到三位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于牛顿引力的基本原理和应用于行星科学的标准潮汐理论。引潮势、球谐展开和勒夫数等概念均已被广泛接受，并构成了该领域的基础。\n2.  **适定性**：该问题定义清晰，包含一系列导向唯一解的任务。它为所需的推导和数值计算提供了所有必要的参数和常数。\n3.  **客观性**：语言专业且精确，没有主观或模糊的陈述。\n4.  **完整性与一致性**：该问题是自洽的。所有必要的变量、常数和简化假设（圆形轨道、同步自转、可忽略的转轴倾角）均已提供。没有矛盾之处。这些假设是静态潮汐入门处理中的标准假设。\n5.  **真实性与可行性**：给定参数描述了一颗环绕红矮星运行的超级地球系外行星。恒星质量（$0.25\\,M_{\\odot}$）、近距离轨道（$0.05\\ \\text{AU}$）以及行星的属性（$M_p \\approx 6.0\\,M_{\\oplus}$，$R_p \\approx 1.8\\,R_{\\oplus}$）在物理上是现实的，并与已知的系外行星系统一致。快速计算表明，该行星的体密度为 $\\rho_p \\approx 5.6 \\times 10^3\\ \\text{kg}\\cdot\\text{m}^{-3}$，这对于一颗岩石质超级地球来说是一个非常合理的值。勒夫数 $h_2=0.25$ 对于这样的行星也是一个合理的数值。\n6.  **结构与非平凡性**：该问题结构良好且非平凡。它要求正确应用势论和勒夫数的定义，这在地球物理学和行星科学中是一项标准但有实质内容的练习。\n\n### 步骤3：结论与行动\n该问题在科学上是合理的、适定的，且所有提供的数据都一致且物理上合理。这是一个有效的问题。我将开始进行解答。\n\n### 解题推导\n\n解答过程按照问题陈述的要求分为三个部分。\n\n**第一部分：引潮势**\n设行星中心为我们坐标系的原点。质量为 $M_{\\star}$ 的恒星位于位置矢量 $\\vec{d}$ 处，其中 $|\\vec{d}| = a$。行星内部或表面的一个关注点距离原点的位置矢量为 $\\vec{r}$，其大小为 $r$。$\\vec{d}$ 和 $\\vec{r}$ 之间的夹角是天顶角 $\\theta$。星下点对应于 $\\theta=0$。\n\n在点 $\\vec{r}$ 处，来自恒星的引力势为：\n$$U_{\\star}(\\vec{r}) = -\\frac{G M_{\\star}}{|\\vec{d} - \\vec{r}|}$$\n根据余弦定理，有 $|\\vec{d} - \\vec{r}| = \\sqrt{a^2 + r^2 - 2ar\\cos\\theta}$。当 $r \\ll a$ 时，我们可以将势展开为勒让德多项式 $P_{n}(\\cos\\theta)$ 的级数：\n$$U_{\\star}(\\vec{r}) = -\\frac{G M_{\\star}}{a} \\sum_{n=0}^{\\infty} \\left(\\frac{r}{a}\\right)^n P_n(\\cos\\theta)$$\n引潮势 $W$ 是行星上的微分势。它是通过从完整展开式中移除 $n=0$ 项（这是一个常数势）和 $n=1$ 项（这对应于行星质心的匀加速运动）得到的。从 $n=2$ 开始的剩余级数产生潮汐形变。\n$$W(\\vec{r}) = -\\frac{G M_{\\star}}{a} \\sum_{n=2}^{\\infty} \\left(\\frac{r}{a}\\right)^n P_n(\\cos\\theta)$$\n该势的领头阶二阶分量是 $n=2$ 项：\n$$W_2(r, \\theta) = -\\frac{G M_{\\star} r^2}{a^3} P_2(\\cos\\theta)$$\n其中 $P_2(x) = \\frac{1}{2}(3x^2 - 1)$。\n问题要求的是在行星表面（$r=R_p$）处的势。\n$$W_2(R_p, \\theta) = -\\frac{G M_{\\star} R_p^2}{a^3} P_2(\\cos\\theta)$$\n这是表面上二阶引潮势的通用表达式。在星下点，$\\theta=0$，所以 $\\cos\\theta=1$。由于 $P_2(1) = \\frac{1}{2}(3 \\cdot 1^2 - 1) = 1$，因此在该特定点上的势为：\n$$W_2|_{\\text{substellar}} = -\\frac{G M_{\\star} R_p^2}{a^3}$$\n\n**第二部分：径向位移表达式**\n表面的静态径向位移 $\\xi_r$ 通过二阶位移勒夫数 $h_2$ 与引潮势 $W_2$ 相关联。潮汐隆起的高度与强迫势成正比，与行星自身的表面重力 $g$ 成反比。势 $W_2$ 代表一个势阱；力由 $-\\nabla W_2$ 给出，它指向远离中心的方向，即势能最负的地方（例如，星下点和背星点）。因此，在这些点上，位移 $\\xi_r$ 是正的（向外）。其关系式为：\n$$\\xi_r(\\theta) = -\\frac{h_2 W_2(R_p, \\theta)}{g}$$\n代入 $W_2(R_p, \\theta)$ 的表达式：\n$$\\xi_r(\\theta) = -\\frac{h_2}{g} \\left(-\\frac{G M_{\\star} R_p^2}{a^3} P_2(\\cos\\theta)\\right) = \\frac{h_2}{g} \\frac{G M_{\\star} R_p^2}{a^3} P_2(\\cos\\theta)$$\n行星的表面重力由牛顿万有引力定律给出：\n$$g = \\frac{G M_p}{R_p^2}$$\n将 $g$ 的这个表达式代入 $\\xi_r$ 的方程中：\n$$\\xi_r(\\theta) = h_2 \\left(\\frac{R_p^2}{G M_p}\\right) \\left(\\frac{G M_{\\star} R_p^2}{a^3}\\right) P_2(\\cos\\theta)$$\n引力常数 $G$ 被消去，得到一个简化的表达式：\n$$\\xi_r(\\theta) = h_2 \\frac{M_{\\star}}{M_p} \\frac{R_p^4}{a^3} P_2(\\cos\\theta)$$\n为了求得星下点的位移，我们令 $\\theta=0$，这使得 $P_2(\\cos 0) = 1$。星下点径向位移的最终表达式是：\n$$\\xi_r = h_2 \\left(\\frac{M_{\\star}}{M_p}\\right) \\frac{R_p^4}{a^3}$$\n\n**第三部分：数值计算**\n首先，我们将所有给定参数转换为国际单位制（SI）基本单位（米和千克）。\n- $M_{\\star} = 0.25 \\times (1.9885 \\times 10^{30}\\ \\text{kg}) = 4.97125 \\times 10^{29}\\ \\text{kg}$\n- $a = 0.05 \\times (1.495978707 \\times 10^{11}\\ \\text{m}) = 7.479893535 \\times 10^{9}\\ \\text{m}$\n- $M_p = 6.0 \\times (5.972 \\times 10^{24}\\ \\text{kg}) = 3.5832 \\times 10^{25}\\ \\text{kg}$\n- $R_p = 1.8 \\times (6.371 \\times 10^{6}\\ \\text{m}) = 1.14678 \\times 10^{7}\\ \\text{m}$\n- $h_2 = 0.25$ (无量纲)\n\n现在，我们将这些值代入推导出的 $\\xi_r$ 表达式中：\n$$\\xi_r = (0.25) \\left(\\frac{4.97125 \\times 10^{29}\\ \\text{kg}}{3.5832 \\times 10^{25}\\ \\text{kg}}\\right) \\frac{(1.14678 \\times 10^{7}\\ \\text{m})^4}{(7.479893535 \\times 10^{9}\\ \\text{m})^3}$$\n让我们计算表达式的各个部分：\n- 质量比：$\\frac{M_{\\star}}{M_p} = \\frac{4.97125 \\times 10^{29}}{3.5832 \\times 10^{25}} \\approx 13873.33$\n- 行星半径的四次方：$R_p^4 = (1.14678 \\times 10^{7})^4 \\ \\text{m}^4 \\approx 1.73030 \\times 10^{28}\\ \\text{m}^4$\n- 半长轴的三次方：$a^3 = (7.479893535 \\times 10^{9})^3 \\ \\text{m}^3 \\approx 4.18593 \\times 10^{29}\\ \\text{m}^3$\n\n综合这些结果：\n$$\\xi_r \\approx (0.25) \\times (13873.33) \\times \\frac{1.73030 \\times 10^{28}}{4.18593 \\times 10^{29}}\\ \\text{m}$$\n$$\\xi_r \\approx (0.25) \\times (13873.33) \\times (0.0413364)\\ \\text{m}$$\n$$\\xi_r \\approx 143.374\\ \\text{m}$$\n问题要求答案四舍五入到三位有效数字。\n$$\\xi_r \\approx 143\\ \\text{m}$$",
            "answer": "$$\\boxed{143}$$"
        },
        {
            "introduction": "量化了潮汐形变之后，一个自然而然的问题是：潮汐耗散产生的巨大热量去向何方？这些热量必须通过行星内部输运至表面并辐射到太空中。本练习将探讨行星地幔热量输运能力的物理极限，引导你计算在不形成全球性岩浆洋的前提下，一颗岩石行星所能散发的最大热流密度。这个过程将潮汐加热与地幔对流、材料熔点等关键地球物理学概念紧密联系起来。",
            "id": "4186461",
            "problem": "一颗具有厚度为 $d$ 的硅酸盐地幔的岩石系外行星受到体潮汐加热的影响。在稳态下，该行星必须以表面热通量 $q$ 的形式将潮汐产生的内部能量输运到太空中。假设地幔剧烈对流，其内部在位温 $T_{p}$ 下近似等温，并在其上方受一个薄热边界层的限制，该边界层位于温度为 $T_{s}$ 的表面之下。对流可以用等粘性流变学下的 Nu-Ra 标度律 $\\mathrm{Nu} = C\\,\\mathrm{Ra}^{\\beta}$ 很好地描述，其中瑞利数定义为 $\\mathrm{Ra} = \\dfrac{\\alpha \\,\\rho\\, g\\, \\Delta T\\, d^{3}}{\\kappa\\, \\eta}$，且 $\\Delta T \\equiv T_{p} - T_{s}$。穿过上边界层的传导热通量为 $q = \\mathrm{Nu}\\,k\\,\\Delta T/d$。\n\n当地幔位温等于或超过橄榄岩地幔的零压液相线时，会形成全球性岩浆海。我们用线性化的熔融曲线 $T_{\\mathrm{liq}}(P) = T_{\\mathrm{liq},0} + \\gamma P$ 来近似这一液相线，并取 $P=0$ 时的阈值，即 $T_{p} = T_{\\mathrm{liq},0}$，这对应于表面完全熔融的条件。假设避免全球性岩浆海需要 $T_{p}  T_{\\mathrm{liq},0}$，并且在不形成全球性岩浆海的情况下，可输运的最大潮汐热通量在 $T_{p} \\to T_{\\mathrm{liq},0}^{-}$ 时达到。\n\n给定以下参数：\n- 地幔厚度 $d = 3.0 \\times 10^{6}\\ \\mathrm{m}$，\n- 重力加速度 $g = 15\\ \\mathrm{m\\ s^{-2}}$，\n- 密度 $\\rho = 4.5 \\times 10^{3}\\ \\mathrm{kg\\ m^{-3}}$，\n- 热膨胀系数 $\\alpha = 3.0 \\times 10^{-5}\\ \\mathrm{K^{-1}}$，\n- 热扩散率 $\\kappa = 1.0 \\times 10^{-6}\\ \\mathrm{m^{2}\\ s^{-1}}$，\n- 热导率 $k = 4.0\\ \\mathrm{W\\ m^{-1}\\ K^{-1}}$，\n- 动力粘度 (等粘性) $\\eta = 1.0 \\times 10^{20}\\ \\mathrm{Pa\\ s}$，\n- 表面温度 $T_{s} = 300\\ \\mathrm{K}$，\n- Nu-Ra 标度律常数 $C = 0.27$，$\\beta = 1/3$，\n- 零压液相线 $T_{\\mathrm{liq},0} = 2000\\ \\mathrm{K}$，\n\n从第一性原理出发，推导该行星在不形成全球性岩浆海的情况下可以通过对流输运的最大单位面积稳态潮汐热通量 $q_{\\max}$ 的表达式，然后进行数值计算。清晰地陈述你使用的物理推理链，从上述定义和全球性岩浆海的熔融曲线判据开始。将最终数值答案四舍五入至三位有效数字。以 $\\mathrm{W\\ m^{-2}}$ 为单位表示最终热通量。",
            "solution": "在尝试求解之前，首先对问题进行验证，以确保其科学基础扎实、内容自洽且提法恰当。\n\n### 第 1 步：提取已知条件\n-   地幔厚度：$d = 3.0 \\times 10^{6}\\ \\mathrm{m}$\n-   重力加速度：$g = 15\\ \\mathrm{m\\ s^{-2}}$\n-   地幔密度：$\\rho = 4.5 \\times 10^{3}\\ \\mathrm{kg\\ m^{-3}}$\n-   热膨胀系数：$\\alpha = 3.0 \\times 10^{-5}\\ \\mathrm{K^{-1}}$\n-   热扩散率：$\\kappa = 1.0 \\times 10^{-6}\\ \\mathrm{m^{2}\\ s^{-1}}$\n-   热导率：$k = 4.0\\ \\mathrm{W\\ m^{-1}\\ K^{-1}}$\n-   动力粘度：$\\eta = 1.0 \\times 10^{20}\\ \\mathrm{Pa\\ s}$\n-   表面温度：$T_{s} = 300\\ \\mathrm{K}$\n-   Nu-Ra 标度律常数：$C = 0.27$\n-   Nu-Ra 标度律指数：$\\beta = 1/3$\n-   零压液相线温度：$T_{\\mathrm{liq},0} = 2000\\ \\mathrm{K}$\n-   热通量方程：$q = \\mathrm{Nu}\\,k\\,\\Delta T/d$\n-   努塞尔数标度律：$\\mathrm{Nu} = C\\,\\mathrm{Ra}^{\\beta}$\n-   瑞利数定义：$\\mathrm{Ra} = \\dfrac{\\alpha \\,\\rho\\, g\\, \\Delta T\\, d^{3}}{\\kappa\\, \\eta}$\n-   跨边界层的温差：$\\Delta T = T_{p} - T_{s}$\n-   全球性岩浆海的条件：$T_{p} \\ge T_{\\mathrm{liq},0}$\n-   最大热通量 $q_{\\max}$ 的条件：$T_{p} \\to T_{\\mathrm{liq},0}^{-}$\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题描述了一个行星地幔热对流的标准模型，这是地球物理学和行星科学的核心课题。其物理框架，包括瑞利数 ($\\mathrm{Ra}$)、努塞尔数 ($\\mathrm{Nu}$) 的定义及其与热通量 ($q$) 的关系，都基于流体动力学和热传导的既定原理。所提供的参数对于一颗大型类地系外行星（“超级地球”）而言是物理上现实的。岩浆海形成的条件被明确定义为地幔位温达到零压固相线，这是行星建模中使用的标准（尽管简化了）判据。问题是自洽的，提供了推导唯一解所需的所有方程和常数。没有科学或逻辑上的矛盾，目标也陈述得很清楚。熔融曲线中提到的参数 $\\gamma$ 对于指定的计算不是必需的，但它的存在并不会使问题结构失效。因此，该问题被认为是有效的。\n\n### 第 3 步：推导与求解\n\n目标是推导出一个表达式，用于计算在不引发全球性岩浆海形成的情况下，可以通过行星地幔输运的最大热通量 $q_{\\max}$。\n\n表面热通量 $q$ 由穿过顶部热边界层的传导输运给出：\n$$q = \\mathrm{Nu}\\,\\frac{k\\,\\Delta T}{d}$$\n其中 $\\Delta T = T_p - T_s$ 是地幔位温 $T_p$ 和表面温度 $T_s$ 之间的温差。\n\n努塞尔数 $\\mathrm{Nu}$ 通过标度律与瑞利数 $\\mathrm{Ra}$ 相关：\n$$\\mathrm{Nu} = C\\,\\mathrm{Ra}^{\\beta}$$\n瑞利数定义为：\n$$\\mathrm{Ra} = \\frac{\\alpha \\,\\rho\\, g\\, \\Delta T\\, d^{3}}{\\kappa\\, \\eta}$$\n首先，我们将瑞利数的表达式代入努塞尔数标度律中：\n$$\\mathrm{Nu} = C \\left( \\frac{\\alpha \\,\\rho\\, g\\, \\Delta T\\, d^{3}}{\\kappa\\, \\eta} \\right)^{\\beta}$$\n接着，我们将这个 $\\mathrm{Nu}$ 的表达式代入热通量 $q$ 的方程中：\n$$q = \\left[ C \\left( \\frac{\\alpha \\,\\rho\\, g\\, \\Delta T\\, d^{3}}{\\kappa\\, \\eta} \\right)^{\\beta} \\right] \\frac{k\\,\\Delta T}{d}$$\n我们可以通过对涉及 $\\Delta T$ 和 $d$ 的项进行分组来重新整理这个表达式：\n$$q = C\\,k\\,\\frac{\\Delta T}{d} (\\Delta T)^{\\beta} \\left( \\frac{\\alpha \\,\\rho\\, g}{\\kappa\\, \\eta} \\right)^{\\beta} (d^3)^{\\beta}$$\n$$q = C\\,k\\,d^{3\\beta - 1} (\\Delta T)^{1+\\beta} \\left( \\frac{\\alpha \\,\\rho\\, g}{\\kappa\\, \\eta} \\right)^{\\beta}$$\n这是热通量 $q$ 作为温降 $\\Delta T$ 函数的一般表达式。\n\n当标度指数为问题中给出的 $\\beta = 1/3$ 时，这种关系出现一个关键特征。在这种情况下，地幔厚度 $d$ 的指数变为：\n$$3\\beta - 1 = 3\\left(\\frac{1}{3}\\right) - 1 = 1 - 1 = 0$$\n这意味着 $d^{3\\beta-1} = d^0 = 1$，热通量变得与地幔厚度 $d$ 无关：\n$$q = C\\,k\\, (\\Delta T)^{4/3} \\left( \\frac{\\alpha \\,\\rho\\, g}{\\kappa\\, \\eta} \\right)^{1/3}$$\n这是等粘性、稳态地幔对流在 $\\beta=1/3$ 标度律下的经典结果。\n\n问题指出，可输运的最大热通量 $q_{\\max}$ 在全球性岩浆海即将形成的极限下达到。这发生在当地幔位温 $T_p$ 接近零压液相线温度时，即 $T_p \\to T_{\\mathrm{liq},0}$。在这个极限下，跨边界层的温差达到其最大值：\n$$\\Delta T_{\\max} = T_{\\mathrm{liq},0} - T_{s}$$\n将 $\\Delta T_{\\max}$ 代入我们推导的 $q$ 表达式中，得到最大热通量 $q_{\\max}$ 的表达式：\n$$q_{\\max} = C\\,k\\,(T_{\\mathrm{liq},0} - T_{s})^{4/3} \\left( \\frac{\\alpha \\,\\rho\\, g}{\\kappa\\, \\eta} \\right)^{1/3}$$\n这就是从第一性原理推导出的所求解析表达式。\n\n现在，我们使用给定的参数对该表达式进行数值计算：\n-   $C = 0.27$\n-   $k = 4.0\\ \\mathrm{W\\ m^{-1}\\ K^{-1}}$\n-   $T_{\\mathrm{liq},0} = 2000\\ \\mathrm{K}$\n-   $T_{s} = 300\\ \\mathrm{K}$\n-   $\\alpha = 3.0 \\times 10^{-5}\\ \\mathrm{K^{-1}}$\n-   $\\rho = 4.5 \\times 10^{3}\\ \\mathrm{kg\\ m^{-3}}$\n-   $g = 15\\ \\mathrm{m\\ s^{-2}}$\n-   $\\kappa = 1.0 \\times 10^{-6}\\ \\mathrm{m^{2}\\ s^{-1}}$\n-   $\\eta = 1.0 \\times 10^{20}\\ \\mathrm{Pa\\ s}$\n\n首先，计算最大温差：\n$$\\Delta T_{\\max} = 2000\\ \\mathrm{K} - 300\\ \\mathrm{K} = 1700\\ \\mathrm{K}$$\n接下来，计算括号内的项：\n$$\\frac{\\alpha \\,\\rho\\, g}{\\kappa\\, \\eta} = \\frac{(3.0 \\times 10^{-5}\\ \\mathrm{K^{-1}}) (4.5 \\times 10^{3}\\ \\mathrm{kg\\ m^{-3}}) (15\\ \\mathrm{m\\ s^{-2}})}{(1.0 \\times 10^{-6}\\ \\mathrm{m^{2}\\ s^{-1}}) (1.0 \\times 10^{20}\\ \\mathrm{Pa\\ s})}$$\n$$\\frac{\\alpha \\,\\rho\\, g}{\\kappa\\, \\eta} = \\frac{2.025\\ \\mathrm{kg\\ m^{-2}\\ s^{-2}\\ K^{-1}}}{1.0 \\times 10^{14}\\ \\mathrm{kg\\ m\\ s^{-2}}} = 2.025 \\times 10^{-14}\\ \\mathrm{m^{-3}\\ K^{-1}}$$\n现在，我们可以计算 $q_{\\max}$ 表达式的各个组成部分：\n$$(T_{\\mathrm{liq},0} - T_{s})^{4/3} = (1700)^{4/3}\\ \\mathrm{K}^{4/3} \\approx 20289.9\\ \\mathrm{K}^{4/3}$$\n$$\\left( \\frac{\\alpha \\,\\rho\\, g}{\\kappa\\, \\eta} \\right)^{1/3} = (2.025 \\times 10^{-14}\\ \\mathrm{m^{-3}\\ K^{-1}})^{1/3} \\approx 2.7255 \\times 10^{-5}\\ \\mathrm{m^{-1}\\ K^{-1/3}}$$\n最后，合并所有项来计算 $q_{\\max}$：\n$$q_{\\max} = (0.27) \\times (4.0\\ \\mathrm{W\\ m^{-1}\\ K^{-1}}) \\times (20289.9\\ \\mathrm{K}^{4/3}) \\times (2.7255 \\times 10^{-5}\\ \\mathrm{m^{-1}\\ K^{-1/3}})$$\n$$q_{\\max} = 1.08 \\times 20289.9 \\times 2.7255 \\times 10^{-5}\\ \\mathrm{W\\ m^{-2}}$$\n$$q_{\\max} \\approx 0.597184\\ \\mathrm{W\\ m^{-2}}$$\n将最终答案四舍五入至三位有效数字，得到：\n$$q_{\\max} \\approx 0.597\\ \\mathrm{W\\ m^{-2}}$$",
            "answer": "$$\\boxed{0.597}$$"
        },
        {
            "introduction": "在分别理解了热量产生和散失之后，最后的实践将二者整合成一个完整的动态系统模型。行星的内部温度最终会达到一个热平衡状态，即潮汐产热功率与表面散热功率相等。本练习要求你建立一个数值模型，以求解这种非线性系统中的平衡温度，并分析其稳定性，从而揭示为何一颗行星可能存在多个稳定或不稳定的热状态。",
            "id": "4186417",
            "problem": "您的任务是为受潮汐加热的类地系外行星的地幔建立稳态内能平衡模型。地幔温度用 $T$ 表示，单位为开尔文。稳态定义为总潮汐加热功率与总表面热损失功率相等。您的程序必须计算出求解能量平衡的平衡地幔温度 $T^{\\ast}$，并评估该平衡的线性稳定性。\n\n将模型建立在以下有物理依据的关系和定义之上：\n\n- 地幔的能量守恒：内能的净变化率等于产热减去损失。在稳态下，\n$$\nH_{\\mathrm{tid}}(T) \\;=\\; Q_{\\mathrm{loss}}(T),\n$$\n其中 $H_{\\mathrm{tid}}(T)$ 是总潮汐加热功率（单位为瓦特），$Q_{\\mathrm{loss}}(T)$ 是向空间的总热损失功率（单位为瓦特）。\n\n- 具有 Arrhenius 形式且参考于某一有限温度的、依赖于温度的地幔粘度：\n$$\n\\eta(T) \\;=\\; \\eta_{\\mathrm{ref}} \\,\\exp\\!\\left(\\frac{E_a}{R_g}\\left(\\frac{1}{T} - \\frac{1}{T_{\\mathrm{ref}}}\\right)\\right),\n$$\n其中 $\\eta(T)$ 是粘度，单位为帕斯卡-秒；$\\eta_{\\mathrm{ref}}$ 是在 $T_{\\mathrm{ref}}$ 时的参考粘度；$E_a$ 是活化能，单位为焦耳/摩尔；$R_g$ 是通用气体常数，单位为焦耳/摩尔·开尔文。\n\n- 以紧凑标量形式表示的潮汐耗散的粘弹性 Maxwell 响应。定义 Maxwell 时间\n$$\n\\tau_M(T) \\;=\\; \\frac{\\eta(T)}{\\mu},\n$$\n其中 $\\mu$ 是剪切模量，单位为帕斯卡；潮汐强迫角频率为 $\\omega$，单位为弧度/秒。无量纲耗散因子为\n$$\nS(T) \\;=\\; \\frac{\\omega\\,\\tau_M(T)}{1 + \\left(\\omega\\,\\tau_M(T)\\right)^2}.\n$$\n设总潮汐加热功率为\n$$\nH_{\\mathrm{tid}}(T) \\;=\\; C_{\\mathrm{tid}} \\, S(T),\n$$\n其中 $C_{\\mathrm{tid}}$ 是一个正的振幅参数（单位为瓦特），它包含了轨道和结构因素。\n\n- 对流和传导混合的表面热损失。假设表面存在两种并行的热损失路径：覆盖表面积比例为 $f$ 的对流路径和覆盖表面积比例为 $(1-f)$ 的传导路径。对流路径遵循 Nusselt 数标度律，传导路径是在厚度为 $d_{\\ell}$ 的停滞盖层中的传导。定义行星半径 $R$（米），地幔厚度 $d_m$（米），表面温度 $T_s$（开尔文），地幔的热导率 $k_m$（瓦特/米·开尔文）和盖层的热导率 $k_{\\ell}$，密度 $\\rho$（千克/立方米），热膨胀系数 $\\alpha$（1/开尔文），热扩散率 $\\kappa$（平方米/秒），以及重力加速度 $g$（米/平方秒）。重力加速度为\n$$\ng \\;=\\; \\frac{G\\,M}{R^2},\n$$\n其中 $G$ 是引力常数，单位为立方米/千克·平方秒；$M$ 是行星质量，单位为千克。热 Rayleigh 数为\n$$\n\\mathrm{Ra}(T) \\;=\\; \\frac{\\rho\\,g\\,\\alpha\\,(T - T_s)\\,d_m^3}{\\kappa\\,\\eta(T)},\n$$\nNusselt 数为\n$$\n\\mathrm{Nu}(T) \\;=\\; a\\,\\mathrm{Ra}(T)^{\\beta},\n$$\n其中 $a$ 和 $\\beta$ 是正常数，在对流面积部分上的对流热通量为\n$$\nq_{\\mathrm{conv}}(T) \\;=\\; \\mathrm{Nu}(T)\\,\\frac{k_m\\,(T - T_s)}{d_m}.\n$$\n在传导面积部分上的传导热通量为\n$$\nq_{\\mathrm{cond}}(T) \\;=\\; \\frac{k_{\\ell}\\,(T - T_s)}{d_{\\ell}}.\n$$\n总热损失功率为\n$$\nQ_{\\mathrm{loss}}(T) \\;=\\; 4\\pi R^2\\left[f\\,q_{\\mathrm{conv}}(T) + (1-f)\\,q_{\\mathrm{cond}}(T)\\right].\n$$\n\n- 平衡点 $T^{\\ast}$ 的线性稳定性由净加热函数 $N(T) = H_{\\mathrm{tid}}(T) - Q_{\\mathrm{loss}}(T)$ 在 $T^{\\ast}$ 处的导数符号决定。如果满足以下条件，则该平衡是线性稳定的：\n$$\n\\left.\\frac{d}{dT}\\big(H_{\\mathrm{tid}}(T) - Q_{\\mathrm{loss}}(T)\\big)\\right|_{T=T^{\\ast}} \\; \\; 0,\n$$\n如果导数为正，则不稳定。\n\n对于下面的每个测试用例，您的程序必须在开尔文温度下数值求解至少一个满足 $H_{\\mathrm{tid}}(T^{\\ast}) = Q_{\\mathrm{loss}}(T^{\\ast})$ 且 $T^{\\ast} > T_s$ 的平衡点 $T^{\\ast}$，相对残差容差在 $10^{-6}$ 以内。如果存在多个平衡点，选择温度最高的稳定平衡点。对于稳定性评估，使用步长为 1 开尔文的对称有限差分来近似导数。\n\n所有用例使用以下通用常量：$G = 6.67430\\times 10^{-11}$（立方米/千克·平方秒），$R_g = 8.314462618$（焦耳/摩尔·开尔文），$a = 0.53$（无量纲），以及 $\\beta = 0.30$（无量纲）。\n\n物理单位：\n- 温度单位必须是开尔文。\n- 长度单位是米。\n- 热导率单位是瓦特/米·开尔文。\n- 热扩散率单位是平方米/秒。\n- 粘度单位是帕斯卡-秒。\n- 功率单位是瓦特。\n- 不涉及角度；无需角度单位。\n\n测试套件参数集（每行是一个测试用例，参数已明确给出；您的程序必须按原样使用这些数值）：\n\n1. 用例 A（混合路径）：\n   - $R = 1.82\\times 10^{6}$ m, $M = 8.93\\times 10^{22}$ kg, $T_s = 250$ K, $d_m = 1.00\\times 10^{6}$ m, $d_{\\ell} = 5.00\\times 10^{4}$ m,\n   - $k_m = 4.0$ W/m/K, $k_{\\ell} = 3.0$ W/m/K, $\\rho = 3300$ kg/m$^{3}$, $\\alpha = 3.0\\times 10^{-5}$ 1/K, $\\kappa = 1.0\\times 10^{-6}$ m$^{2}$/s,\n   - $\\eta_{\\mathrm{ref}} = 1.0\\times 10^{19}$ Pa·s, $T_{\\mathrm{ref}} = 1600$ K, $E_a = 3.0\\times 10^{5}$ J/mol, $\\mu = 7.0\\times 10^{10}$ Pa,\n   - $\\omega = 2.0\\times 10^{-5}$ rad/s, $C_{\\mathrm{tid}} = 3.0\\times 10^{16}$ W, $f = 0.5$.\n\n2. 用例 B（仅传导边界，$f=0$）：\n   - 除 $f = 0.0$ 外，与用例 A 相同。\n\n3. 用例 C（仅对流边界，$f=1$）：\n   - 除 $f = 1.0$ 外，与用例 A 相同。\n\n4. 用例 D（较低潮汐频率和较高活化能）：\n   - $R = 1.82\\times 10^{6}$ m, $M = 8.93\\times 10^{22}$ kg, $T_s = 250$ K, $d_m = 1.00\\times 10^{6}$ m, $d_{\\ell} = 5.00\\times 10^{4}$ m,\n   - $k_m = 4.0$ W/m/K, $k_{\\ell} = 3.0$ W/m/K, $\\rho = 3300$ kg/m$^{3}$, $\\alpha = 3.0\\times 10^{-5}$ 1/K, $\\kappa = 1.0\\times 10^{-6}$ m$^{2}$/s,\n   - $\\eta_{\\mathrm{ref}} = 1.0\\times 10^{19}$ Pa·s, $T_{\\mathrm{ref}} = 1600$ K, $E_a = 4.0\\times 10^{5}$ J/mol, $\\mu = 7.0\\times 10^{10}$ Pa,\n   - $\\omega = 5.0\\times 10^{-6}$ rad/s, $C_{\\mathrm{tid}} = 3.0\\times 10^{16}$ W, $f = 0.5$.\n\n算法要求：\n- 在区间 $[T_{\\min}, T_{\\max}]$（其中 $T_{\\min} = \\max(800,\\, T_s+1)$ 开尔文，$T_{\\max} = 2400$ 开尔文）上实现一个稳健的求根程序。扫描此区间以检测 $N(T) = H_{\\mathrm{tid}}(T) - Q_{\\mathrm{loss}}(T)$ 的符号变化，对每个含根区间应用二分法，并收集所有找到的根。\n- 对于每个根 $T^{\\ast}$，使用步长 $h = 1$ 开尔文计算 $N(T)$ 在 $T^{\\ast}$ 处的有限差分导数，并根据上述符号规则对稳定性进行分类。\n- 每个测试用例的最终报告，请选择温度最高的稳定平衡点。如果没有找到稳定平衡点，则报告温度最高的平衡点（如果存在）并标记为不稳定。如果在搜索区间内不存在平衡点，则温度报告为 $\\mathrm{NaN}$，布尔值报告为 $\\mathrm{False}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果必须是一个 $[T^{\\ast},\\,\\mathrm{stable}]$ 形式的双元素列表，其中 $T^{\\ast}$ 是一个四舍五入到三位小数的开尔文浮点数，$\\mathrm{stable}$ 是一个布尔值。例如，一个有效的单用例输出看起来像 $[[1600.123,True]]$。",
            "solution": "用户提供了一个问题，要求计算受潮汐加热的行星地幔的稳态内部温度，并评估平衡点的稳定性。该问题定义明确，其科学基础是行星地球动力学和热传导原理，并提供了所有必要的参数和方程。验证过程证实了其有效性。\n\n问题的核心是求解关于地幔温度 $T$ 的热平衡非线性代数方程 $N(T) = H_{\\mathrm{tid}}(T) - Q_{\\mathrm{loss}}(T) = 0$。潮汐加热函数 $H_{\\mathrm{tid}}(T)$ 和表面热损失函数 $Q_{\\mathrm{loss}}(T)$ 是复杂且非线性的，涉及多个物理子模型。\n\n首先，我们使用每个测试用例提供的参数，将所有物理量定义为温度 $T$ 的函数。\n\n地幔粘度 $\\eta(T)$ 由 Arrhenius 关系给出：\n$$\n\\eta(T) = \\eta_{\\mathrm{ref}} \\exp\\left(\\frac{E_a}{R_g}\\left(\\frac{1}{T} - \\frac{1}{T_{\\mathrm{ref}}}\\right)\\right)\n$$\n该关系捕捉了岩石形变对温度的强烈依赖性。随着温度升高，粘度呈指数级下降，从而允许更剧烈的对流和在一定程度上更有效的潮汐耗散。\n\n潮汐加热功率 $H_{\\mathrm{tid}}(T)$ 通过 Maxwell 时间 $\\tau_M = \\eta(T)/\\mu$ 和无量纲耗散因子 $S(T)$ 依赖于粘度：\n$$\nS(T) = \\frac{\\omega\\tau_M(T)}{1 + (\\omega\\tau_M(T))^2}\n$$\n总加热量则为 $H_{\\mathrm{tid}}(T) = C_{\\mathrm{tid}} S(T)$。函数 $S(T)$ 在 Maxwell 时间与潮汐强迫周期相当时（即 $\\omega\\tau_M(T) \\approx 1$）有一个特征峰。这意味着潮汐加热在特定的粘度（也就是特定的温度 $T_{\\mathrm{peak}}$）下效率最高。对于 $T \\ll T_{\\mathrm{peak}}$，加热随温度升高而增加；而对于 $T \\gg T_{\\mathrm{peak}}$，加热随温度升高而减少。\n\n热损失功率 $Q_{\\mathrm{loss}}(T)$ 是停滞盖层传导和地幔对流的组合，由面积分数 $f$ 加权：\n$$\nQ_{\\mathrm{loss}}(T) = 4\\pi R^2\\left[f\\,q_{\\mathrm{conv}}(T) + (1-f)\\,q_{\\mathrm{cond}}(T)\\right]\n$$\n传导热通量为 $q_{\\mathrm{cond}}(T) = k_{\\ell}(T - T_s)/d_{\\ell}$。对流热通量 $q_{\\mathrm{conv}}(T)$ 使用 Nusselt-Rayleigh 数标度律进行参数化：\n$$\nq_{\\mathrm{conv}}(T) = \\mathrm{Nu}(T)\\frac{k_m(T - T_s)}{d_m} \\quad \\text{其中} \\quad \\mathrm{Nu}(T) = a\\,\\left(\\frac{\\rho g \\alpha (T-T_s) d_m^3}{\\kappa \\eta(T)}\\right)^{\\beta}\n$$\n由于 $\\eta(T)$ 出现在 Rayleigh 数的分母中，$q_{\\mathrm{conv}}(T)$ 是一个随 $T$ 强劲增长的函数。因此，对于 $T > T_s$，总热损失 $Q_{\\mathrm{loss}}(T)$ 是一个单调递增的函数。\n\n求解 $H_{\\mathrm{tid}}(T) = Q_{\\mathrm{loss}}(T)$ 是一个关于函数 $N(T)$ 的求根问题。峰值状的 $H_{\\mathrm{tid}}(T)$ 曲线和单调的 $Q_{\\mathrm{loss}}(T)$ 曲线的交点可能产生零个、一个或多个平衡温度。我们将系统地搜索这些根。指定的算法是扫描温度区间 $[T_{\\min}, T_{\\max}] = [\\max(800, T_s+1), 2400]$ 开尔文，寻找 $N(T)$ 的符号变化，然后在每个确定的含根区间内使用二分法来精确求解根。\n\n一旦找到一个平衡温度 $T^{\\ast}$，其线性稳定性由净加热函数的导数确定：\n$$\n\\left.\\frac{dN}{dT}\\right|_{T=T^{\\ast}} = \\left.\\frac{d}{dT}\\left(H_{\\mathrm{tid}}(T) - Q_{\\mathrm{loss}}(T)\\right)\\right|_{T=T^{\\ast}}\n$$\n如果 $dN/dT  0$，一个小的正温度扰动 $\\delta T$ 会导致 $N(T^{\\ast}+\\delta T)  0$（净冷却），从而使系统恢复到 $T^{\\ast}$。这是一个稳定平衡。相反，如果 $dN/dT > 0$，扰动会被放大，平衡点是不稳定的。我们使用步长 $h=1$ K 的对称有限差分来近似这个导数。\n\n最后一步是应用选择标准：对于给定的一组参数，从所有找到的平衡点中，我们选择温度最高的稳定平衡点。如果没有稳定的平衡点，我们选择温度最高的不稳定平衡点。如果在搜索范围内没有找到平衡点，我们相应地报告。\n\n整个过程被封装在一个 Python 脚本中。对于每个测试用例，我们定义参数、搜索根、分析其稳定性、选择适当的结果，并将其格式化为最终输出。所提供的参数允许探索不同的物理情景，例如传导主导与对流主导的热损失，以及基于活化能和强迫频率的不同潮汐加热特性。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import bisect\n\ndef solve():\n    \"\"\"\n    Calculates the equilibrium mantle temperature and its stability for a tidally\n    heated exoplanet based on a set of physical models and parameters.\n    \"\"\"\n    # Universal and model constants\n    G = 6.67430e-11  # Gravitational constant, m^3 kg^-1 s^-2\n    R_g = 8.314462618  # Universal gas constant, J mol^-1 K^-1\n    a_nu = 0.53  # Nusselt number coefficient\n    beta_nu = 0.30  # Nusselt number exponent\n\n    # Test case parameters\n    test_cases = [\n        # Case A: Mixed pathways\n        {'R': 1.82e6, 'M': 8.93e22, 'Ts': 250, 'dm': 1.00e6, 'dl': 5.00e4,\n         'km': 4.0, 'kl': 3.0, 'rho': 3300, 'alpha': 3.0e-5, 'kappa': 1.0e-6,\n         'eta_ref': 1.0e19, 'T_ref': 1600, 'Ea': 3.0e5, 'mu': 7.0e10,\n         'omega': 2.0e-5, 'C_tid': 3.0e16, 'f': 0.5},\n        # Case B: Conduction-only\n        {'R': 1.82e6, 'M': 8.93e22, 'Ts': 250, 'dm': 1.00e6, 'dl': 5.00e4,\n         'km': 4.0, 'kl': 3.0, 'rho': 3300, 'alpha': 3.0e-5, 'kappa': 1.0e-6,\n         'eta_ref': 1.0e19, 'T_ref': 1600, 'Ea': 3.0e5, 'mu': 7.0e10,\n         'omega': 2.0e-5, 'C_tid': 3.0e16, 'f': 0.0},\n        # Case C: Convection-only\n        {'R': 1.82e6, 'M': 8.93e22, 'Ts': 250, 'dm': 1.00e6, 'dl': 5.00e4,\n         'km': 4.0, 'kl': 3.0, 'rho': 3300, 'alpha': 3.0e-5, 'kappa': 1.0e-6,\n         'eta_ref': 1.0e19, 'T_ref': 1600, 'Ea': 3.0e5, 'mu': 7.0e10,\n         'omega': 2.0e-5, 'C_tid': 3.0e16, 'f': 1.0},\n        # Case D: Lower frequency, higher activation energy\n        {'R': 1.82e6, 'M': 8.93e22, 'Ts': 250, 'dm': 1.00e6, 'dl': 5.00e4,\n         'km': 4.0, 'kl': 3.0, 'rho': 3300, 'alpha': 3.0e-5, 'kappa': 1.0e-6,\n         'eta_ref': 1.0e19, 'T_ref': 1600, 'Ea': 4.0e5, 'mu': 7.0e10,\n         'omega': 5.0e-6, 'C_tid': 3.0e16, 'f': 0.5},\n    ]\n\n    # Pre-calculate derived constants for each case\n    for p in test_cases:\n        p['g'] = G * p['M'] / p['R']**2\n        p['surf_area'] = 4 * np.pi * p['R']**2\n\n    # --- Helper functions for physical calculations ---\n    def eta(T, p):\n        if T = 0: return np.inf\n        # Clip the argument to avoid overflow with large Ea/Rg\n        exponent = (p['Ea'] / R_g) * (1/T - 1/p['T_ref'])\n        return p['eta_ref'] * np.exp(np.clip(exponent, -700, 700))\n\n    def H_tid(T, p):\n        viscosity = eta(T, p)\n        if np.isinf(viscosity): return 0.0\n        tau_M = viscosity / p['mu']\n        omega_tau_M = p['omega'] * tau_M\n        S_T = omega_tau_M / (1 + omega_tau_M**2)\n        return p['C_tid'] * S_T\n\n    def Q_loss(T, p):\n        delta_T = T - p['Ts']\n        if delta_T = 0: return 0.0\n        \n        q_cond = p['kl'] * delta_T / p['dl']\n        \n        if p['f']  0:\n            viscosity = eta(T, p)\n            if np.isinf(viscosity):\n                q_conv = 0.0\n            else:\n                Ra = (p['rho'] * p['g'] * p['alpha'] * delta_T * p['dm']**3) / (p['kappa'] * viscosity)\n                if Ra  0:\n                    Nu = a_nu * Ra**beta_nu\n                    q_conv = Nu * p['km'] * delta_T / p['dm']\n                else:\n                    q_conv = 0.0\n        else:\n            q_conv = 0.0\n            \n        return p['surf_area'] * (p['f'] * q_conv + (1 - p['f']) * q_cond)\n\n    def N_net(T, p):\n        return H_tid(T, p) - Q_loss(T, p)\n\n    all_results = []\n    \n    # --- Main loop over test cases ---\n    for p in test_cases:\n        T_min = max(800.0, p['Ts'] + 1.0)\n        T_max = 2400.0\n        \n        roots = []\n        scan_temps = np.arange(T_min, T_max + 1.0, 1.0)\n        for i in range(len(scan_temps) - 1):\n            t1, t2 = scan_temps[i], scan_temps[i+1]\n            try:\n                n1, n2 = N_net(t1, p), N_net(t2, p)\n                if not (np.isfinite(n1) and np.isfinite(n2)): continue\n                if np.sign(n1) != np.sign(n2):\n                    root = bisect(lambda T: N_net(T, p), t1, t2, xtol=1e-9, rtol=1e-9)\n                    \n                    # Verify relative residual condition\n                    q_val = Q_loss(root, p)\n                    n_val = N_net(root, p)\n                    if q_val == 0 or abs(n_val / q_val)  1e-6:\n                        roots.append(root)\n\n            except (ValueError, RuntimeError):\n                continue\n        \n        equilibria = []\n        # Use a tolerance to group very close roots found by bisection\n        unique_roots = []\n        if roots:\n            sorted_roots = sorted(roots)\n            unique_roots.append(sorted_roots[0])\n            for r in sorted_roots[1:]:\n                if abs(r - unique_roots[-1])  1e-3:\n                    unique_roots.append(r)\n\n        for T_star in unique_roots:\n            h = 1.0\n            dN_dT = (N_net(T_star + h, p) - N_net(T_star - h, p)) / (2 * h)\n            if not np.isfinite(dN_dT): continue # Skip if derivative is ill-defined\n            is_stable = dN_dT  0\n            equilibria.append({'T_star': T_star, 'stable': is_stable})\n\n        if not equilibria:\n            result = [np.nan, False]\n        else:\n            stable_equilibria = [eq for eq in equilibria if eq['stable']]\n            if stable_equilibria:\n                best_eq = max(stable_equilibria, key=lambda x: x['T_star'])\n            else:\n                best_eq = max(equilibria, key=lambda x: x['T_star'])\n            result = [best_eq['T_star'], best_eq['stable']]\n        \n        all_results.append(result)\n\n    # --- Format and print final output ---\n    output_parts = []\n    for T_star, is_stable in all_results:\n        if np.isnan(T_star):\n            T_str = 'NaN'\n        else:\n            T_str = f\"{T_star:.3f}\"\n        stable_str = str(is_stable).capitalize()\n        output_parts.append(f\"[{T_str},{stable_str}]\")\n        \n    print(f\"[{','.join(output_parts)}]\")\n\nsolve()\n```"
        }
    ]
}