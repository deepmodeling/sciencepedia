{"hands_on_practices": [{"introduction": "To build a robust understanding of gel swelling, we begin with a foundational calculation that directly connects thermodynamic principles to observable behavior. This exercise challenges you to derive the equilibrium swelling ratio from the Flory-Rehner free energy balance in the important high-swelling limit. By relating the abstract Flory-Huggins parameter $\\chi$ to the more tangible concept of solubility parameters, this practice [@problem_id:2930303] provides a powerful tool for predicting how the choice of solvent governs the final state of a swollen gel.", "problem": "A lightly crosslinked, incompressible polymer network is brought to swelling equilibrium in contact separately with two different pure solvents, labeled solvent 1 and solvent 2. The polymer is isotropic, the chain statistics are Gaussian, and finite extensibility can be neglected. The bath pressure is ambient and no external osmotic pressure is applied. Let $T$ denote the absolute temperature and $R$ the universal gas constant. Let $\\nu_{e}$ be the effective number density of elastically active network strands per unit dry polymer volume. The molar volume of both solvents is the same and equal to $v_{s}$. The polymer has solubility parameter $\\delta_{p}$, while the two solvents have solubility parameters $\\delta_{1}$ and $\\delta_{2}$, respectively. Assume the Flory–Huggins interaction parameter for solvent $i$ can be estimated by\n$$\n\\chi_{i} \\approx \\frac{v_{s}}{R T}\\left(\\delta_{p}-\\delta_{i}\\right)^{2}, \\quad i \\in \\{1,2\\}.\n$$\nDefine the polymer volume fraction in the swollen gel as $\\phi$ and the equilibrium volumetric swelling ratio as $Q^{\\ast} \\equiv \\phi^{-1}$ under the assumption of incompressible additivity of volumes.\n\nStarting from the Flory–Huggins free energy of mixing and the Gaussian network elastic free energy, impose the equilibrium condition based on equality of the solvent chemical potential in the gel and in the pure solvent reservoir. In the high-swelling limit where $0\\phi \\ll 1$, systematically derive the leading-order scaling form for the equilibrium polymer volume fraction $\\phi_{i}^{\\ast}$ in solvent $i$ and hence obtain an analytic expression for the ratio of the equilibrium swelling ratios $Q_{1}^{\\ast}/Q_{2}^{\\ast}$ in terms of $\\delta_{p}$, $\\delta_{1}$, $\\delta_{2}$, $v_{s}$, $R$, and $T$.\n\nProvide your final result as a single closed-form expression for $Q_{1}^{\\ast}/Q_{2}^{\\ast}$. Do not plug in any numerical values. Express the final answer without units.", "solution": "The fundamental equilibrium condition for a gel swelling in a pure solvent is the Flory-Rehner equation, which balances the chemical potential contributions from mixing and network elasticity. For a network prepared in the dry state ($\\phi_0=1$), this equation is:\n$$\n\\ln\\left(1-\\phi\\right)+\\phi+\\chi\\,\\phi^{2} + \\nu_{e} v_{s}\\left(\\phi^{1/3}-\\frac{\\phi}{2}\\right) = 0.\n$$\nHere, $\\phi$ is the polymer volume fraction, $\\chi$ is the Flory-Huggins parameter, $\\nu_e$ is the effective chain density per dry volume, and $v_s$ is the solvent molar volume. The elastic term corresponds to the affine network model.\n\nWe are interested in the high-swelling limit, where $\\phi \\ll 1$. In this limit, we can expand the logarithmic term using a Taylor series: $\\ln(1-\\phi) = -\\phi - \\frac{\\phi^{2}}{2} + \\mathcal{O}(\\phi^{3})$. Substituting this into the equilibrium condition gives:\n$$\n\\left(-\\phi - \\frac{\\phi^{2}}{2}\\right) + \\phi + \\chi\\,\\phi^{2} + \\nu_{e} v_{s}\\left(\\phi^{1/3} - \\frac{\\phi}{2}\\right) \\approx 0.\n$$\nThe linear terms in $\\phi$ cancel out. We are left with terms of order $\\phi^2$, $\\phi^{1/3}$, and $\\phi$. Since $\\phi \\ll 1$, the exponent $1/3$ is the smallest, making $\\phi^{1/3}$ the dominant term. The leading-order balance is between the lowest power terms of $\\phi$.\n$$\n\\left(\\chi - \\frac{1}{2}\\right)\\phi^{2} + \\nu_{e} v_{s}\\,\\phi^{1/3} \\approx 0.\n$$\nThis balance is valid for a good solvent, where $\\chi  1/2$, which is required for high swelling. Rearranging the equation to solve for $\\phi$:\n$$\n\\nu_{e} v_{s}\\,\\phi^{1/3} \\approx \\left(\\frac{1}{2} - \\chi\\right)\\phi^{2}\n$$\nDividing by $\\phi^{1/3}$ (since $\\phi \\neq 0$):\n$$\n\\nu_{e} v_{s} \\approx \\left(\\frac{1}{2} - \\chi\\right)\\phi^{5/3}\n$$\nSolving for the equilibrium polymer volume fraction, $\\phi^*$:\n$$\n\\phi^{\\ast} \\approx \\left(\\frac{\\nu_{e} v_{s}}{\\frac{1}{2} - \\chi}\\right)^{3/5}\n$$\nThe equilibrium swelling ratio is $Q^* = 1/\\phi^*$. Therefore:\n$$\nQ^{\\ast} \\approx \\left(\\frac{\\frac{1}{2} - \\chi}{\\nu_{e} v_{s}}\\right)^{3/5}\n$$\nNow, we consider the ratio of swelling ratios for two different solvents, 1 and 2. The network parameters $\\nu_e$ and the solvent molar volume $v_s$ are the same for both cases. The ratio is:\n$$\n\\frac{Q_{1}^{\\ast}}{Q_{2}^{\\ast}} \\approx \\frac{\\left(\\frac{\\frac{1}{2} - \\chi_{1}}{\\nu_{e} v_{s}}\\right)^{3/5}}{\\left(\\frac{\\frac{1}{2} - \\chi_{2}}{\\nu_{e} v_{s}}\\right)^{3/5}} = \\left(\\frac{\\frac{1}{2} - \\chi_{1}}{\\frac{1}{2} - \\chi_{2}}\\right)^{3/5}\n$$\nFinally, we substitute the given expression for the interaction parameters, $\\chi_{i} \\approx \\frac{v_{s}}{R T}\\left(\\delta_{p}-\\delta_{i}\\right)^{2}$:\n$$\n\\frac{Q_{1}^{\\ast}}{Q_{2}^{\\ast}} \\approx \\left[\\frac{\\frac{1}{2} - \\frac{v_{s}}{R T}\\left(\\delta_{p}-\\delta_{1}\\right)^{2}}{\\frac{1}{2} - \\frac{v_{s}}{R T}\\left(\\delta_{p}-\\delta_{2}\\right)^{2}}\\right]^{3/5}\n$$\nThis is the final expression, relating the relative swelling of the gel to the solubility parameters of the polymer and the two solvents.", "answer": "$$\\boxed{\\left[\\dfrac{\\tfrac{1}{2}-\\dfrac{v_{s}}{R T}\\left(\\delta_{p}-\\delta_{1}\\right)^{2}}{\\tfrac{1}{2}-\\dfrac{v_{s}}{R T}\\left(\\delta_{p}-\\delta_{2}\\right)^{2}}\\right]^{\\tfrac{3}{5}}}$$", "id": "2930303"}, {"introduction": "Building on the fundamental theory, we now explore how the Flory-Rehner framework can be extended to model \"smart\" materials that respond to environmental stimuli. This practice [@problem_id:2930238] delves into the behavior of polyelectrolyte gels, whose swelling is sensitively coupled to the pH of the surrounding solution. You will combine principles of Donnan equilibrium, electroneutrality, and chemical dissociation to build a self-consistent computational model, bridging the gap between abstract theory and the predictive design of responsive systems.", "problem": "Consider a chemically crosslinked weak polyelectrolyte gel bearing monoprotic acid groups that can dissociate according to the reaction $\\mathrm{HA} \\rightleftharpoons \\mathrm{H}^+ + \\mathrm{A}^-$. The network is in equilibrium with a large aqueous reservoir containing a symmetric monovalent salt and water, at fixed temperature and pressure. Assume ideal mixing and neglect specific ion effects beyond electrostatics and chemical equilibria. Use the following fundamental bases:\n\n1. Electroneutrality inside the gel: the sum of all charges per unit gel volume must vanish. If $z_i$ and $c_i^{\\mathrm{in}}$ denote the valence and the concentration of mobile ion species $i$ inside the gel, and the fixed charge density due to the network is $-c_f$ (with negative sign because the deprotonated acid groups are anions), then $\\sum_i z_i c_i^{\\mathrm{in}} - c_f = 0$.\n\n2. Donnan partitioning for monovalent ions: equality of electrochemical potentials across the gel boundary implies $c_i^{\\mathrm{in}} = c_i^{\\mathrm{res}} \\exp(-z_i \\psi_D)$, where $\\psi_D \\equiv e \\Delta \\psi/(k_{\\mathrm{B}} T)$ is the dimensionless Donnan potential, $e$ is the elementary charge, $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is temperature, and $c_i^{\\mathrm{res}}$ is the reservoir concentration.\n\n3. Acid dissociation for tethered groups (Henderson-Hasselbalch in terms of activities approximated by concentrations): the degree of ionization $\\alpha$ satisfies $\\alpha/(1-\\alpha) = K_a/[ \\mathrm{H}^+]_{\\mathrm{in}}$, where $K_a$ is the acid dissociation constant and $[\\mathrm{H}^+]_{\\mathrm{in}}$ is the hydrogen ion concentration inside the gel.\n\n4. Water autoprotolysis in the reservoir: $K_w = [\\mathrm{H}^+]_{\\mathrm{res}} [\\mathrm{OH}^-]_{\\mathrm{res}}$, where $K_w$ is the ionic product of water, and the pH in the reservoir is $pH_{\\mathrm{res}} = -\\log_{10} [\\mathrm{H}^+]_{\\mathrm{res}}$.\n\n5. Fixed charge density due to the network: if the molar concentration of titratable acid sites per unit dry polymer volume is $C_A^{\\mathrm{dry}}$ (in $\\mathrm{mol/L_{polymer}}$), and the polymer volume fraction within the gel is $\\phi$ (dimensionless), then the concentration of ionized fixed charges per unit gel volume is $c_f = \\alpha \\, C_A^{\\mathrm{dry}} \\, \\phi$.\n\nAssume a symmetric monovalent salt at reservoir concentration $c_s$ (in $\\mathrm{mol/L}$). Let $[\\mathrm{H}^+]_{\\mathrm{res}} = 10^{-pH_{\\mathrm{res}}}$, $[\\mathrm{OH}^-]_{\\mathrm{res}} = K_w / [\\mathrm{H}^+]_{\\mathrm{res}}$, and use the Donnan relations $[\\mathrm{H}^+]_{\\mathrm{in}} = [\\mathrm{H}^+]_{\\mathrm{res}} \\exp(-\\psi_D)$ and $[\\mathrm{OH}^-]_{\\mathrm{in}} = [\\mathrm{OH}^-]_{\\mathrm{res}} \\exp(+\\psi_D)$. For the salt ions, $c_+^{\\mathrm{in}} = c_s \\exp(-\\psi_D)$ and $c_-^{\\mathrm{in}} = c_s \\exp(+\\psi_D)$. Combine these with electroneutrality and the acid dissociation relation to obtain a single nonlinear scalar equation for $\\psi_D$, coupled to $\\alpha$ via $[\\mathrm{H}^+]_{\\mathrm{in}}$. Solve this equation self-consistently for $\\alpha$ as a function of $pH_{\\mathrm{res}}$ and $\\phi$.\n\nImplement a program that, for each test case below, computes the degree of ionization $\\alpha$ by solving the above equations. Use the following constants and units:\n\n- All concentrations (including $K_a$, $c_s$, $C_A^{\\mathrm{dry}}$) must be expressed in $\\mathrm{mol/L}$.\n- The polymer volume fraction $\\phi$ is dimensionless.\n- The reservoir acidity $pH_{\\mathrm{res}}$ is dimensionless and decadic.\n- Use $K_w = 10^{-14}$ in $\\mathrm{(mol/L)^2}$ (corresponding to standard ambient conditions).\n- The Donnan factor $\\psi_D$ is dimensionless as defined above; your algorithm may work directly with $\\psi_D$ and the exponential Boltzmann factors.\n\nYour program must use a robust bracketing root-finding approach to solve for $\\psi_D$ and then compute $\\alpha = 1/(1 + [\\mathrm{H}^+]_{\\mathrm{in}}/K_a)$, with $[\\mathrm{H}^+]_{\\mathrm{in}} = 10^{-pH_{\\mathrm{res}}} \\exp(-\\psi_D)$. For numerical stability, you should bracket $\\psi_D$ in a finite interval that guarantees a sign change of the electroneutrality function.\n\nTest Suite (each tuple is $(K_a, pH_{\\mathrm{res}}, c_s, \\phi, C_A^{\\mathrm{dry}})$, all in the units specified above):\n- Case A (general case): $(10^{-5}, 7.0, 0.1, 0.05, 10.0)$\n- Case B (no added salt): $(10^{-5}, 7.0, 0.0, 0.05, 10.0)$\n- Case C (acidic reservoir): $(10^{-6}, 3.0, 0.1, 0.05, 10.0)$\n- Case D (basic reservoir, dilute gel): $(10^{-4}, 10.0, 0.01, 0.01, 10.0)$\n- Case E (high polymer fraction, lower site density): $(10^{-5}, 7.0, 0.1, 0.3, 8.0)$\n\nRequired final output:\n- For each test case, output the computed $\\alpha$ as a decimal in the open interval $[0,1]$, rounded to six digits after the decimal point.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test suite above (for example, $[\\alpha_A,\\alpha_B,\\alpha_C,\\alpha_D,\\alpha_E]$).", "solution": "The problem requires finding the equilibrium degree of ionization, $\\alpha$, by solving a system of coupled equations that describe the physicochemical state of a polyelectrolyte gel. The core of the solution lies in formulating and numerically solving a single nonlinear equation for the dimensionless Donnan potential, $\\psi_D$, which enforces electroneutrality inside the gel.\n\nFirst, we write the electroneutrality condition. The total charge density inside the gel must be zero. The charge carriers are mobile ions from the reservoir ($\\mathrm{H}^+$, $\\mathrm{OH}^-$, salt cations $c_+$, and salt anions $c_-$) and the fixed, deprotonated acid groups on the polymer network ($\\mathrm{A}^-$). For monovalent ions, the condition is:\n$$\n[\\mathrm{H}^+]_{\\mathrm{in}} + c_+^{\\mathrm{in}} - [\\mathrm{OH}^-]_{\\mathrm{in}} - c_-^{\\mathrm{in}} - c_f = 0\n$$\nwhere $c_f$ is the molar concentration of fixed charges ($\\mathrm{A}^-$).\n\nNext, we use the Donnan equilibrium relations to express the internal ion concentrations in terms of the external (reservoir) concentrations and the Donnan potential $\\psi_D$:\n$$\nc_i^{\\mathrm{in}} = c_i^{\\mathrm{res}} \\exp(-z_i \\psi_D)\n$$\nThe reservoir concentrations are given by: $[\\mathrm{H}^+]_{\\mathrm{res}} = 10^{-pH_{\\mathrm{res}}}$, $[\\mathrm{OH}^-]_{\\mathrm{res}} = K_w / [\\mathrm{H}^+]_{\\mathrm{res}}$, and $c_+^{\\mathrm{res}} = c_-^{\\mathrm{res}} = c_s$. Applying the Donnan relations:\n$$\n[\\mathrm{H}^+]_{\\mathrm{in}} = [\\mathrm{H}^+]_{\\mathrm{res}} e^{-\\psi_D} \\quad (z=+1) \\\\\nc_+^{\\mathrm{in}} = c_s e^{-\\psi_D} \\quad (z=+1) \\\\\n[\\mathrm{OH}^-]_{\\mathrm{in}} = [\\mathrm{OH}^-]_{\\mathrm{res}} e^{\\psi_D} \\quad (z=-1) \\\\\nc_-^{\\mathrm{in}} = c_s e^{\\psi_D} \\quad (z=-1)\n$$\nSubstituting these into the electroneutrality equation gives:\n$$\n([\\mathrm{H}^+]_{\\mathrm{res}} + c_s) e^{-\\psi_D} - ([\\mathrm{OH}^-]_{\\mathrm{res}} + c_s) e^{\\psi_D} - c_f = 0\n$$\n\nThe fixed charge concentration $c_f$ is not constant; it depends on the degree of ionization $\\alpha$, which in turn depends on the local proton concentration $[\\mathrm{H}^+]_{\\mathrm{in}}$. The relationship is given by the acid dissociation equilibrium:\n$$\n\\alpha = \\frac{K_a}{K_a + [\\mathrm{H}^+]_{\\mathrm{in}}}\n$$\nThe concentration of fixed charges is then $c_f = \\alpha C_A^{\\mathrm{dry}} \\phi$. Since $[\\mathrm{H}^+]_{\\mathrm{in}}$ depends on $\\psi_D$, $\\alpha$ and $c_f$ also become functions of $\\psi_D$:\n$$\nc_f(\\psi_D) = \\frac{K_a C_A^{\\mathrm{dry}} \\phi}{K_a + [\\mathrm{H}^+]_{\\mathrm{res}} e^{-\\psi_D}}\n$$\n\nFinally, we substitute this expression for $c_f(\\psi_D)$ back into the electroneutrality equation to obtain a single nonlinear scalar equation for the unknown $\\psi_D$:\n$$\nf(\\psi_D) = ([\\mathrm{H}^+]_{\\mathrm{res}} + c_s) e^{-\\psi_D} - ([\\mathrm{OH}^-]_{\\mathrm{res}} + c_s) e^{\\psi_D} - \\frac{K_a C_A^{\\mathrm{dry}} \\phi}{K_a + [\\mathrm{H}^+]_{\\mathrm{res}} e^{-\\psi_D}} = 0\n$$\nThis equation must be solved numerically. The function $f(\\psi_D)$ is continuous and monotonically decreasing, ensuring a unique root exists.\n\nThe numerical procedure is:\n1. For each test case, calculate the constant reservoir concentrations $[\\mathrm{H}^+]_{\\mathrm{res}}$ and $[\\mathrm{OH}^-]_{\\mathrm{res}}$.\n2. Define the function $f(\\psi_D)$ using these constants and the case-specific parameters.\n3. Use a numerical root-finding algorithm (e.g., Brent's method) within a suitable bracket (e.g., $[-50, 50]$) to find the unique root $\\psi_D^*$.\n4. With the solved $\\psi_D^*$, calculate the equilibrium degree of ionization $\\alpha$ using the formula:\n$$\n\\alpha = \\frac{K_a}{K_a + [\\mathrm{H}^+]_{\\mathrm{res}} e^{-\\psi_D^*}}\n$$\nThis procedure is followed for each test case to obtain the required results.", "answer": "[0.909091,0.980653,0.088613,0.999001,0.722421]", "id": "2930238"}, {"introduction": "A theoretical model's ultimate value lies in its ability to interpret experimental data. This final practice moves from forward prediction to the crucial skill of inverse analysis: extracting fundamental physical parameters from experimental measurements [@problem_id:2930302]. You will develop a method to determine polymer-solvent interaction parameters ($\\chi_{P1}$, $\\chi_{P2}$) from swelling data in mixed solvents, confronting the real-world challenges of experimental noise and parameter identifiability. This exercise provides essential training in the statistical methods required to validate and parameterize theoretical models against empirical evidence.", "problem": "A crosslinked polymer network (a gel) swells when immersed in a bath of small-molecule solvents due to the balance of mixing thermodynamics and network elasticity. Consider a gel at fixed temperature in a large bath composed of two ideal small-molecule solvents, labeled component 1 and component 2, with bath mole fractions $x_1$ and $x_2 = 1 - x_1$. Let $\\phi$ denote the polymer volume fraction in the swollen gel at equilibrium. Assume the following modeling ingredients.\n\n- The mixing free energy density is described by the Flory-Huggins (FH) theory, and the gel elasticity is described by Gaussian network elasticity. Under these assumptions, the Flory-Rehner (FR) equilibrium condition for swelling against a large bath of small molecules with unit activity can be written in the canonical form\n$$\n\\ln(1 - \\phi) + \\phi + \\chi_{\\mathrm{eff}}\\, \\phi^2 + C \\left(\\phi^{1/3} - \\frac{\\phi}{2}\\right) = 0,\n$$\nwhere $C$ is a known positive constant proportional to the product of solvent reference molar volume and the density of elastically active network chains, and $\\chi_{\\mathrm{eff}}$ is the effective polymer–solvent interaction parameter of the bath as felt by the polymer.\n- The effective interaction parameter is modeled as a linear composition average over components,\n$$\n\\chi_{\\mathrm{eff}} = x_1 \\chi_{P1} + x_2 \\chi_{P2},\n$$\nwhere $\\chi_{P1}$ and $\\chi_{P2}$ are the component-specific Flory-Huggins interaction parameters between the polymer and component 1 and 2, respectively.\n\nYour task is to formulate and solve an inverse problem to estimate $(\\chi_{P1}, \\chi_{P2})$ from multiple swelling measurements $(x_{1,j}, \\phi_j)$ taken at different bath compositions. You must also quantify the identifiability of $(\\chi_{P1}, \\chi_{P2})$ in the presence of experimental noise in $\\phi$.\n\nStarting from the Flory-Rehner equilibrium condition stated above, complete the following steps.\n\n1) Derive an explicit expression that isolates a scalar function $y(\\phi)$ so that for each measurement $j$,\n$$\ny(\\phi_j) \\approx x_{1,j}\\,\\chi_{P1} + x_{2,j}\\,\\chi_{P2},\n$$\nunder the modeling assumptions given. The goal is to transform the inverse problem into a linear regression in the unknowns $(\\chi_{P1}, \\chi_{P2})$.\n\n2) Derive the sensitivity $\\frac{dy}{d\\phi}$ evaluated at $\\phi_j$ and, using first-order (linear) error propagation, express an approximate standard deviation $\\sigma_{y,j}$ in the transformed response,\n$$\n\\sigma_{y,j} \\approx \\left|\\frac{dy}{d\\phi}(\\phi_j)\\right| \\sigma_{\\phi,j},\n$$\ngiven a known measurement standard deviation $\\sigma_{\\phi,j}$ for $\\phi_j$.\n\n3) Propose and implement a weighted least-squares estimator for $(\\chi_{P1}, \\chi_{P2})$ using weights $w_j = 1/\\sigma_{y,j}^2$. Compute the parameter covariance matrix as the inverse of the weighted normal matrix, and extract the standard errors of the estimates as the square roots of its diagonal entries.\n\n4) Define an identifiability criterion that depends on both the geometry of the design and the noise level as follows. Let $\\mathbf{X}$ be the $N \\times 2$ design matrix with columns $[x_{1,j}]$ and $[x_{2,j}]$, and let $\\mathbf{W} = \\mathrm{diag}(w_1,\\dots,w_N)$. Form the weighted design $\\mathbf{X}_w = \\mathbf{W}^{1/2}\\mathbf{X}$ and compute its spectral condition number $\\kappa = \\kappa_2(\\mathbf{X}_w)$. Declare the parameter pair $(\\chi_{P1}, \\chi_{P2})$ identifiable if both of the following hold:\n- $\\kappa \\le 10^4$,\n- each parameter’s estimated standard error is less than $0.05$.\nOtherwise, declare it not identifiable.\n\nAll quantities in this problem are dimensionless.\n\nImplement the above estimator and identifiability test in a program that processes the following test suite. For each test case, you are given the elastic constant $C$, a list of bath mole fractions $x_1$, corresponding measured polymer volume fractions $\\phi$, and a common measurement standard deviation $\\sigma_\\phi$ for all points in that case.\n\nUse the following test suite.\n- Test Case A (well-spread compositions, low noise):\n  - $C = 0.005$,\n  - $x_1 = [0.05, 0.25, 0.50, 0.75, 0.95]$,\n  - $\\phi = [0.220, 0.180, 0.140, 0.110, 0.095]$,\n  - $\\sigma_\\phi = 0.003$.\n- Test Case B (narrow composition spread, moderate noise):\n  - $C = 0.005$,\n  - $x_1 = [0.45, 0.48, 0.52, 0.55]$,\n  - $\\phi = [0.142, 0.141, 0.139, 0.138]$,\n  - $\\sigma_\\phi = 0.004$.\n- Test Case C (minimal data, higher noise):\n  - $C = 0.005$,\n  - $x_1 = [0.20, 0.80]$,\n  - $\\phi = [0.190, 0.100]$,\n  - $\\sigma_\\phi = 0.010$.\n\nYour program must, for each test case, compute:\n- the weighted least-squares estimates $\\widehat{\\chi}_{P1}$ and $\\widehat{\\chi}_{P2}$,\n- the spectral condition number $\\kappa$ of $\\mathbf{X}_w$,\n- the identifiability decision as a boolean.\n\nFinal Output Format:\n- For each test case, return a list of the form $[\\widehat{\\chi}_{P1}, \\widehat{\\chi}_{P2}, \\kappa, \\text{identifiable}]$, where the first three entries are floats rounded to six decimal places and the last entry is a boolean.\n- Aggregate the results across the three test cases into a single list and print exactly one line containing this list in Python list literal form. For example, a valid output shape is\n$[[\\text{float},\\text{float},\\text{float},\\text{bool}],[\\text{float},\\text{float},\\text{float},\\text{bool}],[\\text{float},\\text{float},\\text{float},\\text{bool}]]$.", "solution": "The problem requires developing and implementing a weighted least-squares (WLS) method to estimate Flory-Huggins parameters from experimental swelling data and to assess the identifiability of these parameters.\n\n**1. Linearization of the Model**\nThe starting point is the Flory-Rehner equilibrium condition:\n$$\n\\ln(1 - \\phi) + \\phi + \\chi_{\\mathrm{eff}}\\, \\phi^2 + C \\left(\\phi^{1/3} - \\frac{\\phi}{2}\\right) = 0\n$$\nWe need to isolate $\\chi_{\\mathrm{eff}}$ to create a linear model. Rearranging the equation gives:\n$$\n\\chi_{\\mathrm{eff}}\\, \\phi^2 = -\\left[ \\ln(1 - \\phi) + \\phi + C \\left(\\phi^{1/3} - \\frac{\\phi}{2}\\right) \\right]\n$$\nDividing by $\\phi^2$ (assuming $\\phi \\neq 0$), we define a new response variable $y(\\phi)$:\n$$\ny(\\phi) = \\chi_{\\mathrm{eff}} = -\\frac{1}{\\phi^2} \\left[ \\ln(1 - \\phi) + \\phi + C \\left(\\phi^{1/3} - \\frac{\\phi}{2}\\right) \\right]\n$$\nSubstituting the model for $\\chi_{\\mathrm{eff}} = x_1 \\chi_{P1} + x_2 \\chi_{P2}$, we obtain the desired linear form for each measurement $j$:\n$$\ny(\\phi_j) \\approx x_{1,j}\\,\\chi_{P1} + x_{2,j}\\,\\chi_{P2}\n$$\n\n**2. Error Propagation**\nTo perform WLS, we need to propagate the uncertainty from the measurement $\\phi_j$ to the calculated response $y_j$. The standard deviation $\\sigma_{y,j}$ is found using linear error propagation:\n$$\n\\sigma_{y,j} \\approx \\left|\\frac{dy}{d\\phi}\\bigg|_{\\phi_j}\\right| \\sigma_{\\phi,j}\n$$\nWe compute the derivative of $y(\\phi)$ with respect to $\\phi$:\n$$\n\\frac{dy}{d\\phi} = \\frac{d}{d\\phi} \\left[ -\\frac{\\ln(1 - \\phi)}{\\phi^2} - \\frac{1}{\\phi} - \\frac{C}{\\phi^{5/3}} + \\frac{C}{2\\phi} \\right]\n$$\n$$\n\\frac{dy}{d\\phi} = \\left( \\frac{2\\ln(1 - \\phi)}{\\phi^3} - \\frac{1}{\\phi^2(1-\\phi)} \\right) + \\frac{1}{\\phi^2} + \\frac{5C}{3\\phi^{8/3}} - \\frac{C}{2\\phi^2}\n$$\nSimplifying this expression yields the sensitivity:\n$$\n\\frac{dy}{d\\phi} = \\frac{2\\ln(1 - \\phi)}{\\phi^3} + \\frac{2-\\phi}{\\phi^2(1-\\phi)} + \\frac{5C}{3\\phi^{8/3}} - \\frac{C}{2\\phi^2}\n$$\n\n**3. Weighted Least-Squares (WLS) Estimation**\nThe system of linear equations for all measurements is $\\mathbf{y} \\approx \\mathbf{X}\\boldsymbol{\\beta}$, where $\\mathbf{y}$ is the vector of $y(\\phi_j)$ values, $\\mathbf{X}$ is the $N \\times 2$ design matrix with rows $[x_{1,j}, 1-x_{1,j}]$, and $\\boldsymbol{\\beta} = [\\chi_{P1}, \\chi_{P2}]^T$ is the parameter vector.\nSince the noise in $y_j$ is heteroscedastic, we use WLS with weights $w_j = 1/\\sigma_{y,j}^2$. Let $\\mathbf{W}$ be the diagonal matrix of these weights. The WLS estimate $\\widehat{\\boldsymbol{\\beta}}$ is:\n$$\n\\widehat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\mathbf{y}\n$$\nThe parameter covariance matrix is $\\mathrm{Cov}(\\widehat{\\boldsymbol{\\beta}}) = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1}$. The standard errors of the estimates are the square roots of the diagonal entries of this matrix.\n\n**4. Identifiability Criterion**\nIdentifiability is assessed based on two conditions:\n- **Numerical Stability:** The spectral condition number $\\kappa = \\kappa_2(\\mathbf{X}_w)$ of the weighted design matrix $\\mathbf{X}_w = \\mathbf{W}^{1/2}\\mathbf{X}$ must be $\\le 10^4$. A high condition number indicates multicollinearity, making the parameter estimates unreliable.\n- **Statistical Precision:** The standard error for each estimated parameter, $\\widehat{\\chi}_{P1}$ and $\\widehat{\\chi}_{P2}$, must be less than $0.05$. This ensures the parameters are determined with sufficient precision.\nBoth conditions must be met for the parameter pair to be declared identifiable. The numerical implementation will follow these steps for each test case.", "answer": "[[0.793796, 0.285579, 4.250597, True], [0.81424, 0.239335, 33.398679, False], [0.840787, 0.269784, 1.419036, False]]", "id": "2930302"}]}