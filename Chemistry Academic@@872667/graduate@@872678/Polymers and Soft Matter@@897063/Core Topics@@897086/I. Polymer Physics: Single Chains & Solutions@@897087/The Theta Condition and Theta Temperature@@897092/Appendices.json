{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we first ground our understanding of the theta temperature in the foundational framework of polymer solution thermodynamics: the Flory-Huggins theory. This exercise guides you through the essential derivation that connects a macroscopic observable, the osmotic pressure, to the microscopic polymer-solvent interaction parameter, $\\chi$. By deriving the virial expansion of the osmotic pressure, you will demonstrate for yourself the cornerstone result that the theta condition—the point where ideal chain behavior is recovered in a dilute solution—corresponds precisely to the condition $\\chi(T_{\\theta}) = 1/2$ [@problem_id:2934645]. This practice is fundamental for appreciating how the balance of enthalpic and entropic contributions to mixing governs solvent quality and defines this special thermodynamic state.", "problem": "A long, flexible polymer in a molecular solvent at low polymer volume fraction is described by the Flory–Huggins (FH) free energy of mixing per lattice site,\n$$\n\\frac{f}{k_B T} \\equiv g(\\phi;T) = \\frac{\\phi}{N}\\ln \\phi + (1-\\phi)\\ln(1-\\phi) + \\chi(T)\\,\\phi(1-\\phi),\n$$\nwhere $k_B$ is the Boltzmann constant, $T$ is the absolute temperature, $\\phi$ is the polymer volume fraction, $N$ is the degree of polymerization, and $\\chi(T)$ is the temperature-dependent FH interaction parameter. The osmotic pressure is defined from the free energy density by the standard thermodynamic relation $\\Pi = \\phi\\,(\\partial f/\\partial \\phi)_T - f$. The $\\theta$-condition is defined as the point where the effective two-body excluded-volume interactions vanish in the dilute limit, which coincides with vanishing second virial coefficient of the osmotic equation of state. The empirically well-supported temperature dependence of the interaction parameter is\n$$\n\\chi(T) = \\frac{A}{T} + B,\n$$\nwhere $A$ and $B$ are temperature-independent constants.\n\nStarting from the FH free energy given above and the definition of the osmotic pressure, work in the limit of small $\\phi$ and show how the $\\theta$-condition fixes the value of $\\chi$ at the $\\theta$ temperature $T_{\\theta}$. Then, using only the empirical form for $\\chi(T)$ stated above, derive a closed-form expression for $T_{\\theta}$ in terms of $A$ and $B$. Finally, for a specific polymer–solvent pair with $A = 86.0\\,\\mathrm{K}$ and $B = 0.22$, compute $T_{\\theta}$ and report its value in Kelvin. Round your answer to four significant figures. In your derivation, briefly explain which thermodynamic contributions are encoded in $A$ and $B$ and why their signs matter for solvent quality as $T$ varies.", "solution": "The starting point is the Flory–Huggins (FH) free energy density per lattice site,\n$$\n\\frac{f}{k_B T} = \\frac{\\phi}{N}\\ln \\phi + (1-\\phi)\\ln(1-\\phi) + \\chi(T)\\,\\phi(1-\\phi).\n$$\nFrom standard thermodynamics of mixtures, the osmotic pressure $ \\Pi $ follows from the Legendre transform of the free energy density with respect to volume fraction,\n$$\n\\Pi = \\phi \\left(\\frac{\\partial f}{\\partial \\phi}\\right)_{T} - f.\n$$\nTo connect to virial coefficients, we require the dilute expansion of the osmotic pressure in powers of the polymer volume fraction $\\phi$. We first expand the combinatorial entropy term at small $\\phi$ using the Taylor series of the natural logarithm, $\\ln(1-\\phi) = -\\phi - \\phi^{2}/2 - \\phi^{3}/3 - \\cdots$. Then\n$$\n(1-\\phi)\\ln(1-\\phi) = (1-\\phi)\\left(-\\phi - \\frac{\\phi^{2}}{2} - \\frac{\\phi^{3}}{3} - \\cdots \\right) = -\\phi + \\frac{\\phi^{2}}{2} + \\mathcal{O}(\\phi^{3}).\n$$\nHence, keeping terms up to $\\mathcal{O}(\\phi^{2})$,\n$$\n\\frac{f}{k_B T} = \\frac{\\phi}{N}\\ln \\phi - \\phi + \\frac{\\phi^{2}}{2} + \\chi(T)\\,\\phi - \\chi(T)\\,\\phi^{2} + \\mathcal{O}(\\phi^{3}).\n$$\nCollecting coefficients,\n$$\n\\frac{f}{k_B T} = \\frac{\\phi}{N}\\ln \\phi + \\bigl[\\chi(T) - 1\\bigr]\\phi + \\left[\\frac{1}{2} - \\chi(T)\\right]\\phi^{2} + \\mathcal{O}(\\phi^{3}).\n$$\nWe now compute $\\Pi/(k_B T)$ using $\\Pi = \\phi (\\partial f/\\partial \\phi) - f$. First compute the derivative,\n$$\n\\frac{1}{k_B T}\\left(\\frac{\\partial f}{\\partial \\phi}\\right)_{T} = \\frac{1}{N}\\left(\\ln \\phi + 1\\right) + \\bigl[\\chi(T) - 1\\bigr] + 2\\left[\\frac{1}{2} - \\chi(T)\\right]\\phi + \\mathcal{O}(\\phi^{2}).\n$$\nMultiply by $\\phi$,\n$$\n\\frac{\\phi}{k_B T}\\left(\\frac{\\partial f}{\\partial \\phi}\\right)_{T} = \\frac{\\phi}{N}\\ln \\phi + \\frac{\\phi}{N} + \\bigl[\\chi(T) - 1\\bigr]\\phi + \\left[1 - 2\\chi(T)\\right]\\phi^{2} + \\mathcal{O}(\\phi^{3}).\n$$\nSubtract $f/(k_B T)$ to obtain the osmotic pressure in thermal units,\n\\begin{align*}\n\\frac{\\Pi}{k_B T} = \\left(\\frac{\\phi}{N}\\ln \\phi + \\frac{\\phi}{N} + \\bigl[\\chi(T) - 1\\bigr]\\phi + \\left[1 - 2\\chi(T)\\right]\\phi^{2} + \\cdots \\right) \\\\\n\\quad - \\left(\\frac{\\phi}{N}\\ln \\phi + \\bigl[\\chi(T) - 1\\bigr]\\phi + \\left[\\frac{1}{2} - \\chi(T)\\right]\\phi^{2} + \\cdots \\right) \\\\\n= \\frac{\\phi}{N} + \\left(1 - 2\\chi(T) - \\frac{1}{2} + \\chi(T)\\right)\\phi^{2} + \\mathcal{O}(\\phi^{3}) \\\\\n= \\frac{\\phi}{N} + \\left(\\frac{1}{2} - \\chi(T)\\right)\\phi^{2} + \\mathcal{O}(\\phi^{3}).\n\\end{align*}\nThis is the osmotic equation of state to second order in $\\phi$. The coefficient of $\\phi^{2}$ is the reduced second virial coefficient (up to a choice of microscopic volume unit in the lattice model). The $\\theta$-condition is defined as the point where the effective two-body excluded volume vanishes, i.e., the second virial coefficient is zero. Therefore,\n$$\n\\frac{1}{2} - \\chi\\bigl(T_{\\theta}\\bigr) = 0 \\quad \\Longrightarrow \\quad \\chi\\bigl(T_{\\theta}\\bigr) = \\frac{1}{2}.\n$$\nThis establishes the $\\theta$-condition in terms of the FH interaction parameter.\n\nNow impose the empirical temperature dependence\n$$\n\\chi(T) = \\frac{A}{T} + B,\n$$\nwith temperature-independent constants $A$ and $B$. At $T_{\\theta}$ we have\n$$\n\\frac{A}{T_{\\theta}} + B = \\frac{1}{2}.\n$$\nSolving for $T_{\\theta}$ gives the closed-form expression\n$$\nT_{\\theta} = \\frac{A}{\\frac{1}{2} - B} = \\frac{2A}{1 - 2B}.\n$$\n\nFor the specific polymer–solvent pair with $A = 86.0\\,\\mathrm{K}$ and $B = 0.22$, we compute\n$$\nT_{\\theta} = \\frac{2 \\times 86.0}{1 - 2 \\times 0.22}\\ \\mathrm{K} = \\frac{172.0}{1 - 0.44}\\ \\mathrm{K} = \\frac{172.0}{0.56}\\ \\mathrm{K} \\approx 307.142857\\ \\mathrm{K}.\n$$\nRounded to four significant figures, this yields\n$$\nT_{\\theta} \\approx 307.1\\ \\mathrm{K}.\n$$\n\nFinally, we interpret $A$ and $B$ thermodynamically. In mean-field lattice treatments, the interaction parameter can be decomposed as\n$$\n\\chi(T) \\simeq \\frac{\\Delta H_{\\mathrm{mix}}}{k_B T} - \\frac{\\Delta S_{\\mathrm{mix}}^{\\mathrm{nonideal}}}{k_B},\n$$\nwhere $\\Delta H_{\\mathrm{mix}}$ represents contact enthalpy of mixing per lattice site and $\\Delta S_{\\mathrm{mix}}^{\\mathrm{nonideal}}$ encodes noncombinatorial entropy (e.g., local packing, compressibility, and segmental correlations) beyond the ideal combinatorial term already explicit in the FH free energy. Comparing with $\\chi(T) = A/T + B$, we identify $A \\propto \\Delta H_{\\mathrm{mix}}/k_B$ as an enthalpic contribution and $B \\simeq -\\Delta S_{\\mathrm{mix}}^{\\mathrm{nonideal}}/k_B$ as an entropic (temperature-independent) contribution. A positive $A$ signifies enthalpically unfavorable mixing that diminishes with increasing $T$, improving solvent quality at higher temperatures. The sign and magnitude of $B$ shift the baseline of solvent quality independent of $T$. Together, $A$ and $B$ determine $T_{\\theta}$ through $T_{\\theta} = 2A/(1 - 2B)$: larger $A$ raises $T_{\\theta}$, while larger $B$ (holding $A$ fixed) also raises $T_{\\theta}$ by reducing the denominator $1 - 2B$.", "answer": "$$\\boxed{307.1}$$", "id": "2934645"}, {"introduction": "Having established the thermodynamic definition of $T_{\\theta}$, we now deepen our intuition by examining its consequence for the physical conformation of a single polymer chain. This problem shifts our perspective from the mean-field lattice model to a more detailed continuous chain model described by the Edwards Hamiltonian [@problem_id:2934639]. Using first-order perturbation theory, a powerful tool in theoretical physics, you will calculate how the chain's size, quantified by the expansion factor $\\alpha$, deviates from its ideal random-walk dimension as the temperature moves away from $T_{\\theta}$. This exercise provides a crucial microscopic picture, illustrating that the theta condition is not just an abstract point where a virial coefficient vanishes, but the concrete physical state where attractive and repulsive segmental interactions exactly cancel, causing the chain to adopt its unperturbed, \"ideal\" size.", "problem": "An idealized flexible polymer in a dilute solution is modeled as a continuous Gaussian chain with contour parameter $s \\in [0,N]$ and Kuhn length $a$ in three spatial dimensions. The end-to-end vector is $R = r(N) - r(0)$ and the ideal (Gaussian) mean-squared end-to-end distance is $\\langle R^{2} \\rangle_{0} = a^{2} N$. Solvent-mediated monomer interactions are treated by the Edwards Hamiltonian with an excluded-volume term of strength $v(T)$:\n$$\n\\beta \\mathcal{H}[r(\\cdot)] = \\frac{3}{2 a^{2}} \\int_{0}^{N} \\left| \\frac{d r}{ds} \\right|^{2} ds + \\frac{v(T)}{2} \\int_{0}^{N} \\int_{0}^{N} \\delta\\!\\left( r(s) - r(s') \\right) ds\\, ds',\n$$\nwhere $\\beta = 1/(k_{B} T)$ and $\\delta(\\cdot)$ is the three-dimensional Dirac delta distribution. Define the expansion factor $\\alpha = \\sqrt{ \\langle R^{2} \\rangle / \\langle R^{2} \\rangle_{0} }$. The theta temperature $T_{\\theta}$ is defined by the vanishing of the second virial coefficient, which implies $v(T_{\\theta}) = 0$, and near $T_{\\theta}$ it is empirically well established that the excluded-volume parameter is linear in temperature:\n$$\nv(T) = v_{1} \\left( T - T_{\\theta} \\right) + \\text{higher orders},\n$$\nwith a constant slope $v_{1} = \\left. dv/dT \\right|_{T_{\\theta}}$ independent of $N$ and $a$. Working to first order in $v$ about the Gaussian reference ($v=0$), use perturbation theory based on the above Hamiltonian to derive the leading temperature dependence of the expansion factor $\\alpha$ in the vicinity of $T_{\\theta}$. You may assume that all ultraviolet divergences associated with the local $\\delta$-interaction cancel in the connected (covariance) combination that determines the first-order correction to $\\langle R^{2} \\rangle$, and you may use standard Gaussian functional averages for the ideal chain. Provide your final answer as a single closed-form analytic expression for $\\alpha(T)$ accurate to first order in $\\left( T - T_{\\theta} \\right)$, expressed in terms of $N$, $a$, $v_{1}$, $T$, and $T_{\\theta}$, and fundamental constants. No rounding is required and the final expression should be dimensionless. Do not include any remainder terms in your final answer.", "solution": "The problem requires the derivation of the temperature dependence of the polymer expansion factor, $\\alpha(T)$, near the theta temperature, $T_{\\theta}$, using first-order perturbation theory.\n\nThe system is a continuous Gaussian polymer chain defined by the Edwards Hamiltonian:\n$$\n\\beta \\mathcal{H}[r(\\cdot)] = \\beta \\mathcal{H}_{0} + \\beta \\mathcal{H}_{int}\n$$\nwhere the ideal (unperturbed) part is:\n$$\n\\beta \\mathcal{H}_{0} = \\frac{3}{2 a^{2}} \\int_{0}^{N} \\left| \\frac{d r}{ds} \\right|^{2} ds\n$$\nand the interaction (perturbation) part is:\n$$\n\\beta \\mathcal{H}_{int} = \\frac{v(T)}{2} \\int_{0}^{N} \\int_{0}^{N} \\delta\\!\\left( r(s) - r(s') \\right) ds\\, ds'\n$$\nThe expansion factor is defined as $\\alpha = \\sqrt{ \\langle R^{2} \\rangle / \\langle R^{2} \\rangle_{0} }$, where $R = r(N) - r(0)$ is the end-to-end vector. We seek $\\langle R^2 \\rangle$ calculated with the full Hamiltonian $\\mathcal{H}$. The average of an observable $\\mathcal{O}$ is given by:\n$$\n\\langle \\mathcal{O} \\rangle = \\frac{\\int \\mathcal{D}[r] \\mathcal{O} \\exp(-\\beta\\mathcal{H})}{\\int \\mathcal{D}[r] \\exp(-\\beta\\mathcal{H})}\n$$\nWe treat $\\beta \\mathcal{H}_{int}$ as a small perturbation. Expanding the exponentials to first order in $v(T)$:\n$$\n\\exp(-\\beta\\mathcal{H}) = \\exp(-\\beta\\mathcal{H}_0 - \\beta\\mathcal{H}_{int}) \\approx \\exp(-\\beta\\mathcal{H}_0) (1 - \\beta\\mathcal{H}_{int})\n$$\nThe average of $R^2$ is then:\n$$\n\\langle R^2 \\rangle \\approx \\frac{\\int \\mathcal{D}[r] R^2 (1 - \\beta\\mathcal{H}_{int}) \\exp(-\\beta\\mathcal{H}_0)}{\\int \\mathcal{D}[r] (1 - \\beta\\mathcal{H}_{int}) \\exp(-\\beta\\mathcal{H}_0)} = \\frac{\\langle R^2 (1 - \\beta\\mathcal{H}_{int}) \\rangle_0}{\\langle 1 - \\beta\\mathcal{H}_{int} \\rangle_0}\n$$\nwhere $\\langle \\cdot \\rangle_0$ denotes an average with respect to the unperturbed Hamiltonian $\\mathcal{H}_0$.\nExpanding this expression and keeping terms up to first order in the perturbation yields the cumulant expansion result:\n$$\n\\langle R^2 \\rangle \\approx \\langle R^2 \\rangle_0 - \\left( \\langle R^2 (\\beta\\mathcal{H}_{int}) \\rangle_0 - \\langle R^2 \\rangle_0 \\langle \\beta\\mathcal{H}_{int} \\rangle_0 \\right)\n$$\nSubstituting the expression for $\\beta\\mathcal{H}_{int}$:\n$$\n\\langle R^2 \\rangle \\approx \\langle R^2 \\rangle_0 - \\frac{v(T)}{2} \\int_0^N ds \\int_0^N ds' \\left[ \\langle R^2 \\delta(r(s)-r(s')) \\rangle_0 - \\langle R^2 \\rangle_0 \\langle \\delta(r(s)-r(s')) \\rangle_0 \\right]\n$$\nThe term in the square brackets is the connected correlation function, or covariance, of $R^2$ and the two-point contact density.\nFor a Gaussian chain governed by $\\mathcal{H}_0$, the vectors corresponding to non-overlapping segments are statistically independent. Let us assume $0 \\le s'  s \\le N$. The end-to-end vector can be decomposed as $R = (r(N)-r(s)) + (r(s)-r(s')) + (r(s')-r(0))$. These three vectors are independent Gaussian variables with zero mean. Let us denote them $u_1$, $u_2$, and $u_3$ respectively.\nThe unperturbed mean-squared lengths of these segments are given by the provided problem scaling: $\\langle u_1^2 \\rangle_0 = a^2(N-s)$, $\\langle u_2^2 \\rangle_0 = a^2(s-s')$, and $\\langle u_3^2 \\rangle_0 = a^2(s')$. The total unperturbed mean-squared end-to-end distance is $\\langle R^2 \\rangle_0 = \\langle (u_1+u_2+u_3)^2 \\rangle_0 = \\langle u_1^2 \\rangle_0 + \\langle u_2^2 \\rangle_0 + \\langle u_3^2 \\rangle_0 = a^2N$, which is consistent.\n\nNow we evaluate the first term in the correlator:\n$$\n\\langle R^2 \\delta(r(s)-r(s')) \\rangle_0 = \\langle (u_1+u_2+u_3)^2 \\delta(u_2) \\rangle_0\n$$\nSince the delta function forces $u_2=0$, and $u_1$, $u_2$, $u_3$ are independent, this becomes:\n$$\n= \\langle (u_1+u_3)^2 \\rangle_0 \\langle \\delta(u_2) \\rangle_0 = (\\langle u_1^2 \\rangle_0 + \\langle u_3^2 \\rangle_0) \\langle \\delta(r(s)-r(s')) \\rangle_0\n$$\n$$\n= (a^2(N-s) + a^2s') \\langle \\delta(r(s)-r(s')) \\rangle_0\n$$\nThe connected correlator for $s > s'$ is thus:\n$$\n\\text{Cov}(\\dots) = (a^2(N-s) + a^2s') \\langle \\delta(\\dots) \\rangle_0 - (a^2N) \\langle \\delta(\\dots) \\rangle_0 = -a^2(s-s') \\langle \\delta(r(s)-r(s')) \\rangle_0\n$$\nFor a Gaussian chain in three dimensions, the probability density of the vector connecting two points $s$ and $s'$ is given by:\n$$\nP(r;s,s') = \\left( \\frac{3}{2\\pi \\langle |r(s)-r(s')|^2 \\rangle_0} \\right)^{3/2} \\exp\\left( - \\frac{3 r^2}{2 \\langle |r(s)-r(s')|^2 \\rangle_0} \\right)\n$$\nUsing $\\langle |r(s)-r(s')|^2 \\rangle_0 = a^2|s-s'|$, we get $\\langle \\delta(r(s)-r(s')) \\rangle_0 = P(0;s,s') = \\left(\\frac{3}{2\\pi a^2|s-s'|}\\right)^{3/2}$.\nThe first-order correction to $\\langle R^2 \\rangle$ is $\\delta\\langle R^2 \\rangle = \\langle R^2 \\rangle - \\langle R^2 \\rangle_0$:\n$$\n\\delta \\langle R^2 \\rangle = - \\frac{v(T)}{2} \\int_0^N \\int_0^N ds ds' \\left[ -a^2|s-s'| \\left(\\frac{3}{2\\pi a^2|s-s'|}\\right)^{3/2} \\right]\n$$\nSymmetry of the integrand allows us to write this as:\n$$\n\\delta \\langle R^2 \\rangle = v(T) \\int_0^N ds \\int_0^s ds' \\left[ a^2(s-s') \\left(\\frac{3}{2\\pi a^2(s-s')}\\right)^{3/2} \\right]\n$$\n$$\n\\delta \\langle R^2 \\rangle = v(T) a^2 \\left(\\frac{3}{2\\pi a^2}\\right)^{3/2} \\int_0^N ds \\int_0^s ds' (s-s')^{1 - 3/2} = v(T) a^2 \\left(\\frac{3}{2\\pi a^2}\\right)^{3/2} \\int_0^N ds \\int_0^s (s-s')^{-1/2} ds'\n$$\nThe inner integral evaluates to: $\\int_0^s (s-s')^{-1/2} ds' = [-2(s-s')^{1/2}]_0^s = 2s^{1/2}$.\nThe outer integral becomes: $\\int_0^N 2s^{1/2} ds = 2 \\left[\\frac{s^{3/2}}{3/2}\\right]_0^N = \\frac{4}{3}N^{3/2}$.\nSo, the correction is:\n$$\n\\delta \\langle R^2 \\rangle = v(T) a^2 \\left(\\frac{3}{2\\pi a^2}\\right)^{3/2} \\frac{4}{3} N^{3/2}\n$$\nThe expansion factor squared is $\\alpha^2 = \\langle R^2 \\rangle / \\langle R^2 \\rangle_0 = 1 + \\delta \\langle R^2 \\rangle / \\langle R^2 \\rangle_0$.\nUsing $\\langle R^2 \\rangle_0 = a^2N$:\n$$\n\\alpha^2(T) = 1 + \\frac{v(T) a^2 \\left(\\frac{3}{2\\pi a^2}\\right)^{3/2} \\frac{4}{3} N^{3/2}}{a^2N} = 1 + \\frac{4}{3} v(T) \\left(\\frac{3}{2\\pi a^2}\\right)^{3/2} N^{1/2}\n$$\nNear the theta temperature $T_{\\theta}$, the excluded-volume parameter is given by $v(T) \\approx v_1(T - T_{\\theta})$. Substituting this into the expression for $\\alpha^2(T)$:\n$$\n\\alpha^2(T) \\approx 1 + \\frac{4}{3} v_1(T - T_{\\theta}) \\left(\\frac{3}{2\\pi a^2}\\right)^{3/2} N^{1/2}\n$$\nFor small $x$, $\\sqrt{1+x} \\approx 1 + x/2$. Since $v(T)$ is small near $T_{\\theta}$, we can expand $\\alpha(T) = \\sqrt{\\alpha^2(T)}$ to first order:\n$$\n\\alpha(T) \\approx 1 + \\frac{1}{2}(\\alpha^2(T) - 1) = 1 + \\frac{2}{3} v_1(T - T_{\\theta}) \\left(\\frac{3}{2\\pi a^2}\\right)^{3/2} N^{1/2}\n$$\nNow, we simplify the constant prefactor:\n$$\n\\frac{2}{3} \\left(\\frac{3}{2\\pi}\\right)^{3/2} = \\frac{2}{3} \\frac{3\\sqrt{3}}{(2\\pi)^{3/2}} = \\frac{2\\sqrt{3}}{2\\sqrt{2}\\pi^{3/2}} = \\frac{\\sqrt{3}}{\\sqrt{2}\\pi^{3/2}} = \\frac{\\sqrt{6}}{2\\pi^{3/2}}\n$$\nCombining this with the other parameters, we arrive at the final expression for the expansion factor:\n$$\n\\alpha(T) = 1 + \\left( \\frac{\\sqrt{6}}{2\\pi^{3/2}} \\right) \\frac{v_1 N^{1/2}}{a^3} (T - T_{\\theta})\n$$\nThis expression is dimensionless and shows the linear deviation of the expansion factor from its ideal value of $1$ as the temperature deviates from the theta temperature.", "answer": "$$\n\\boxed{1 + \\frac{\\sqrt{6}}{2\\pi^{\\frac{3}{2}}} \\frac{v_{1} N^{\\frac{1}{2}}}{a^{3}} \\left( T - T_{\\theta} \\right)}\n$$", "id": "2934639"}, {"introduction": "Our final practice bridges the gap between theory and the practical world of simulation and experiment. In a real research scenario, we might determine the effective interaction between polymer coils by measuring or simulating their pair distribution function, $g(r)$. This function contains all the necessary information to calculate macroscopic thermodynamic properties, including the second virial coefficient, $B_2(T)$. This computational exercise [@problem_id:2934617] challenges you to build a numerical pipeline that starts from a model for the potential of mean force between two chains, computes $B_2(T)$ via numerical integration, and then implements a root-finding algorithm to pinpoint the theta temperature. This problem provides invaluable hands-on experience in translating fundamental statistical mechanical relationships into a robust computational tool, mirroring the process used to analyze modern simulation data.", "problem": "You are asked to formalize and implement, from first principles, a procedure to determine the theta temperature, denoted by $T_{\\theta}$, for long polymer chains by computing the second virial coefficient from a pair distribution function. Your derivation must start from core definitions in statistical mechanics and polymer solution thermodynamics and must not assume any specialized formula as given. You will then implement the derived computation as a program.\n\nConsider a dilute solution of very long polymer chains, where the relevant pair correlation for the effective interaction between the centers of mass of two coils is the pair distribution function $g(r \\mid T)$ at temperature $T$. Assume an isotropic effective interaction so that $g(r \\mid T)$ depends only on the scalar separation $r$. The theta temperature $T_{\\theta}$ is defined as the temperature at which the second virial coefficient of the effective two-coil interaction vanishes in the long-chain limit. Equivalently, at $T_{\\theta}$ the net excluded volume effect cancels the attractive contributions so that the leading departure from ideality is zero.\n\nIn simulation practice, $g(r \\mid T)$ can be measured using a Monte Carlo protocol on long chains that combines global and local moves (e.g., pivot moves and configurational-bias regrowth moves) to equilibrate single-chain conformations and two-chain relative positions in the dilute regime. The objective of this problem is not to build the full simulation, but to derive and implement the computation that maps $g(r \\mid T)$ to the second virial coefficient and then to $T_{\\theta}$.\n\nTo make the problem universally computable, suppose that the measured $g(r \\mid T)$ is well represented by the following reduced model, which captures the temperature dependence of solvent quality near $T_{\\theta}$ for long coils:\n- The reduced potential of mean force $u(r;T)$ is defined via $g(r \\mid T) = \\exp[-u(r;T)]$.\n- For all test cases below, take $u(r;T) = a(T) \\exp\\!\\left[-\\left(\\dfrac{r}{R}\\right)^{2}\\right]$, where $R$ is a positive length scale proportional to the coil size and $a(T)$ is a scalar amplitude that varies linearly with $T$ according to $a(T) = a_{0} + a_{1} (T - T_{0})$.\n- The dimensionless reduced second virial coefficient is defined as $A_{2}^{\\ast}(T) \\equiv \\dfrac{B_{2}(T)}{(4\\pi/3) R^{3}}$, where $B_{2}(T)$ is the ordinary second virial coefficient of the effective isotropic interaction. The theta condition is $A_{2}^{\\ast}(T_{\\theta}) = 0$.\n\nTasks:\n1. Starting from the core definitions of the potential of mean force and the Mayer $f$-function for an isotropic pair correlation, derive an explicit expression for $A_{2}^{\\ast}(T)$ in terms of $g(r \\mid T)$ for the model given above. You must justify each step using fundamental definitions and standard statistical mechanics identities, not by quoting the target expression.\n2. Using your derived expression, design a robust numerical algorithm that, given parameters $(R, a_{0}, a_{1}, T_{0})$ and a temperature bracket $[T_{\\min}, T_{\\max}]$ known to contain $T_{\\theta}$, computes $A_{2}^{\\ast}(T)$ by numerical quadrature and then determines $T_{\\theta}$ as the unique root of $A_{2}^{\\ast}(T) = 0$ within the bracket. Your algorithm must:\n   - Evaluate any required integrals to high accuracy with explicit error control.\n   - Use a bracketed root-finding method guaranteed to converge when a sign change is present.\n   - Correctly handle the boundary case when the root coincides with $T_{\\min}$ or $T_{\\max}$.\n3. Implement the algorithm as a program that, for each of the test cases below, outputs $T_{\\theta}$ in Kelvin. Express each numerical answer in $\\mathrm{K}$, rounded to three decimal digits.\n\nTest suite:\nProvide results for the following three independent parameter sets, each with temperatures in Kelvin and lengths in nanometers (you may treat $R$ as an external length scale; ensure dimensional consistency in your derivation by using the reduced, dimensionless $A_{2}^{\\ast}$):\n- Case $1$ (general interior root): $R = 15\\,\\mathrm{nm}$, $a_{0} = 1.2$, $a_{1} = -0.01\\,\\mathrm{K}^{-1}$, $T_{0} = 300\\,\\mathrm{K}$, $T_{\\min} = 350\\,\\mathrm{K}$, $T_{\\max} = 500\\,\\mathrm{K}$.\n- Case $2$ (boundary root at lower bracket): $R = 12\\,\\mathrm{nm}$, $a_{0} = 0.5$, $a_{1} = 0.02\\,\\mathrm{K}^{-1}$, $T_{0} = 300\\,\\mathrm{K}$, $T_{\\min} = 275\\,\\mathrm{K}$, $T_{\\max} = 350\\,\\mathrm{K}$.\n- Case $3$ (shallow crossing): $R = 20\\,\\mathrm{nm}$, $a_{0} = 0.02$, $a_{1} = -1.0\\times 10^{-4}\\,\\mathrm{K}^{-1}$, $T_{0} = 300\\,\\mathrm{K}$, $T_{\\min} = 450\\,\\mathrm{K}$, $T_{\\max} = 550\\,\\mathrm{K}$.\n\nFinal output format:\nYour program should produce a single line of output containing the three computed values of $T_{\\theta}$, in Kelvin, rounded to three decimal digits, as a comma-separated list enclosed in square brackets (e.g., $[420.000,275.000,500.000]$). No other output is permitted.\n\nAngle units are not used. Percentages are not used. All numeric values must be reported as decimal numbers without a percent sign. All physical outputs that carry a unit must be reported in the unit specified above, i.e., $\\mathrm{K}$ for temperatures.", "solution": "The problem is valid as it is scientifically grounded in the principles of polymer solution thermodynamics and statistical mechanics, is well-posed with sufficient information for a unique solution, and is expressed in objective, formal language. We will proceed with a full derivation and solution.\n\nThe task is to determine the theta temperature, $T_{\\theta}$, for a model of interacting polymer coils. The theta temperature is defined as the temperature at which the second virial coefficient, $B_{2}(T)$, of the effective interaction between polymer coils vanishes. We are given a model for the pair distribution function $g(r \\mid T)$ and are required to derive the expression for $B_{2}(T)$, formulate the condition for $T_{\\theta}$, and implement a numerical solution.\n\nFirst, we begin from the fundamental definition of the second virial coefficient in statistical mechanics for a system with a spherically symmetric, pairwise-additive potential of mean force, $W(r)$. The definition is given by the cluster integral:\n$$ B_{2}(T) = -\\frac{1}{2} \\int (\\exp[-\\beta W(r)] - 1) d\\mathbf{r} $$\nwhere $\\beta = (k_{B}T)^{-1}$ with $k_{B}$ being the Boltzmann constant, and the integration is over all space. For a spherically symmetric potential, this simplifies to:\n$$ B_{2}(T) = -\\frac{1}{2} \\int_{0}^{\\infty} (\\exp[-\\beta W(r)] - 1) 4\\pi r^{2} dr = -2\\pi \\int_{0}^{\\infty} (\\exp[-\\beta W(r)] - 1) r^{2} dr $$\n\nThe pair distribution function, $g(r \\mid T)$, is related to the potential of mean force $W(r)$ by the definition $g(r \\mid T) = \\exp[-\\beta W(r)]$. The problem provides a reduced, dimensionless potential of mean force, $u(r;T)$, such that $g(r \\mid T) = \\exp[-u(r;T)]$. By comparison, we see that $u(r;T) = \\beta W(r)$. We can therefore express $B_{2}(T)$ directly in terms of the given $g(r \\mid T)$:\n$$ B_{2}(T) = -2\\pi \\int_{0}^{\\infty} [g(r \\mid T) - 1] r^{2} dr $$\n\nThe problem specifies the functional form for $u(r;T)$:\n$$ u(r;T) = a(T) \\exp\\left[-\\left(\\frac{r}{R}\\right)^{2}\\right] $$\nwhere $R$ is a characteristic length scale of the polymer coil and $a(T)$ is a temperature-dependent amplitude given by $a(T) = a_{0} + a_{1} (T - T_{0})$. Consequently, the pair distribution function is:\n$$ g(r \\mid T) = \\exp\\left[-a(T)\\exp\\left(-\\left(\\frac{r}{R}\\right)^{2}\\right)\\right] $$\nSubstituting this into the expression for $B_{2}(T)$, we obtain:\n$$ B_{2}(T) = -2\\pi \\int_{0}^{\\infty} \\left\\{ \\exp\\left[-a(T)\\exp\\left(-\\left(\\frac{r}{R}\\right)^{2}\\right)\\right] - 1 \\right\\} r^{2} dr $$\n\nThe problem asks for the computation of the reduced, dimensionless second virial coefficient, $A_{2}^{\\ast}(T)$, defined as:\n$$ A_{2}^{\\ast}(T) = \\frac{B_{2}(T)}{\\frac{4\\pi}{3} R^{3}} $$\nThis dimensionless form is convenient as it removes explicit dependence on the coil size $R$. To show this, we perform a change of variables in the integral for $B_{2}(T)$. Let the dimensionless separation be $x = r/R$. Then $r = xR$ and $dr = R\\,dx$.\n$$ B_{2}(T) = -2\\pi \\int_{0}^{\\infty} \\left\\{ \\exp[-a(T)\\exp(-x^{2})] - 1 \\right\\} (xR)^{2} (R\\,dx) $$\n$$ B_{2}(T) = -2\\pi R^{3} \\int_{0}^{\\infty} x^{2} \\left\\{ \\exp[-a(T)\\exp(-x^{2})] - 1 \\right\\} dx $$\nNow, substituting this into the definition of $A_{2}^{\\ast}(T)$:\n$$ A_{2}^{\\ast}(T) = \\frac{-2\\pi R^{3} \\int_{0}^{\\infty} x^{2} \\left\\{ \\exp[-a(T)\\exp(-x^{2})] - 1 \\right\\} dx}{\\frac{4\\pi}{3} R^{3}} $$\nThe term $R^{3}$ cancels, yielding the final expression for the reduced second virial coefficient, which is independent of $R$:\n$$ A_{2}^{\\ast}(T) = -\\frac{3}{2} \\int_{0}^{\\infty} x^{2} \\left\\{ \\exp[-a(T)\\exp(-x^{2})] - 1 \\right\\} dx $$\nThis is the central equation for our numerical procedure. The theta temperature $T_{\\theta}$ is the temperature at which polymer-solvent interactions are such that the effective coil-coil interactions vanish on average. This corresponds to the condition $A_{2}^{\\ast}(T_{\\theta}) = 0$. This implies that the integral itself must be zero:\n$$ \\int_{0}^{\\infty} x^{2} \\left\\{ \\exp[-a(T_{\\theta})\\exp(-x^{2})] - 1 \\right\\} dx = 0 $$\n\nThe numerical algorithm to find $T_{\\theta}$ proceeds as follows:\n$1$. We must implement a function that calculates $A_{2}^{\\ast}(T)$ for any given temperature $T$ using the provided parameters $(a_{0}, a_{1}, T_{0})$.\n$2$. This function will first compute $a(T) = a_{0} + a_{1}(T - T_{0})$.\n$3$. Then, it will evaluate the definite integral numerically. The integrand, $f(x, a) = x^{2} (\\exp[-a\\exp(-x^{2})] - 1)$, decays rapidly to zero as $x \\to \\infty$, making it suitable for high-accuracy numerical quadrature over the interval $[0, \\infty)$. We will use a standard library routine such as `scipy.integrate.quad` for this purpose, which can handle infinite integration limits and provides error estimates.\n$4$. The result of the integration is then multiplied by the prefactor $-\\frac{3}{2}$ to obtain $A_{2}^{\\ast}(T)$.\n\nOnce we have the function $A_{2}^{\\ast}(T)$, we must find the root $T_{\\theta}$ that satisfies $A_{2}^{\\ast}(T_{\\theta}) = 0$ within the given temperature bracket $[T_{\\min}, T_{\\max}]$.\n$1$. A robust, bracketed root-finding method is required. We will use the Brent-Dekker method, available as `scipy.optimize.brentq`. This method is guaranteed to converge provided that the function values at the endpoints of the bracket, $A_{2}^{\\ast}(T_{\\min})$ and $A_{2}^{\\ast}(T_{\\max})$, have opposite signs.\n$2$. The problem requires correct handling of boundary cases. We will first explicitly check if $A_{2}^{\\ast}(T_{\\min}) = 0$ or $A_{2}^{\\ast}(T_{\\max}) = 0$. If so, the root is one of the boundaries. Otherwise, we verify that $A_{2}^{\\ast}(T_{\\min}) \\cdot A_{2}^{\\ast}(T_{\\max})  0$ and proceed with the `brentq` algorithm.\n\nIt is worth noting that for the specific functional form given, the integrand $x^{2} \\left\\{ \\exp[-a(T)\\exp(-x^{2})] - 1 \\right\\}$ is strictly positive if $a(T)  0$, strictly negative if $a(T)  0$, and zero everywhere if $a(T) = 0$. Consequently, the integral is zero if and only if $a(T) = 0$. Thus, $T_{\\theta}$ could be found analytically by solving $a_{0} + a_{1} (T_{\\theta} - T_{0}) = 0$, which gives $T_{\\theta} = T_{0} - a_{0}/a_{1}$. However, the problem explicitly instructs us to design and implement the full numerical procedure involving quadrature and root-finding, which is what we will do. The analytical result serves as a verification of our numerical implementation.\n\nThe implementation will process each test case by defining the function for $A_2^*(T)$ with the corresponding parameters, and then applying the root-finding logic within the specified temperature bracket. The final results will be rounded to three decimal digits as required.", "answer": "```python\nimport numpy as np\nfrom scipy import integrate\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Derives and implements a procedure to find the theta temperature T_theta.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (general interior root)\n        # R is included for completeness but is not used in the calculation of T_theta.\n        {'R': 15.0, 'a0': 1.2, 'a1': -0.01, 'T0': 300.0, 'T_min': 350.0, 'T_max': 500.0},\n        # Case 2 (boundary root at lower bracket)\n        {'R': 12.0, 'a0': 0.5, 'a1': 0.02, 'T0': 300.0, 'T_min': 275.0, 'T_max': 350.0},\n        # Case 3 (shallow crossing)\n        {'R': 20.0, 'a0': 0.02, 'a1': -1.0e-4, 'T0': 300.0, 'T_min': 450.0, 'T_max': 550.0},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        a0 = case['a0']\n        a1 = case['a1']\n        T0 = case['T0']\n        T_min = case['T_min']\n        T_max = case['T_max']\n\n        def integrand(x, a_T):\n            \"\"\"\n            The integrand for calculating the reduced second virial coefficient.\n            The expression is x^2 * (exp[-a(T)*exp(-x^2)] - 1).\n            \"\"\"\n            if x == 0:\n                return 0.0\n            return x**2 * (np.exp(-a_T * np.exp(-x**2)) - 1.0)\n\n        def compute_A2_star(T, a0_p, a1_p, T0_p):\n            \"\"\"\n            Computes the reduced second virial coefficient A2*(T) for a given temperature T.\n            \"\"\"\n            # Calculate the temperature-dependent amplitude a(T)\n            a_T = a0_p + a1_p * (T - T0_p)\n            \n            # Numerically integrate the function from 0 to infinity\n            # an additional argument 'a_T' is passed to the integrand function.\n            integral_val, _ = integrate.quad(integrand, 0, np.inf, args=(a_T,))\n            \n            # A2*(T) = -3/2 * integral\n            return -1.5 * integral_val\n\n        # Create the target function for the root finder.\n        # This function takes only temperature T as input.\n        target_func = lambda T: compute_A2_star(T, a0, a1, T0)\n\n        # Evaluate the function at the boundaries of the bracket\n        val_at_min = target_func(T_min)\n        val_at_max = target_func(T_max)\n\n        # Handle boundary cases and find the root\n        if np.isclose(val_at_min, 0.0):\n            # The root is at the lower boundary\n            T_theta = T_min\n        elif np.isclose(val_at_max, 0.0):\n            # The root is at the upper boundary\n            T_theta = T_max\n        else:\n            # For interior roots, use a bracketed root-finding method.\n            # The problem guarantees a sign change is present in these cases.\n            try:\n                T_theta = optimize.brentq(target_func, T_min, T_max)\n            except ValueError:\n                # This block should not be reached based on the problem description,\n                # but is included for robustness.\n                # It would be triggered if f(a) and f(b) have the same sign.\n                # For this specific problem, the analytical solution T_theta = T0 - a0/a1 could be used\n                # as a fallback, but we adhere to the numerical method instruction.\n                T_theta = np.nan # Indicate failure\n\n        # Append the result, rounded to three decimal places.\n        results.append(f\"{T_theta:.3f}\")\n\n    # Print the final output in the required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2934617"}]}