{"hands_on_practices": [{"introduction": "This first practice establishes the fundamental quantitative approach to analyzing a buffer system. By considering an ammonia/ammonium buffer, you will derive the exact governing equation for the hydrogen ion concentration from mass and charge balance principles, including the often-neglected autoprotolysis of water. This exercise builds the essential skill of translating chemical principles into a complete mathematical model, which is the foundation for understanding the common ion effect [@problem_id:2958738].", "problem": "An aqueous solution at $25^{\\circ}\\mathrm{C}$ contains ammonia $\\mathrm{NH_3}$ and ammonium chloride $\\mathrm{NH_4Cl}$ at analytical concentrations $0.20\\,\\mathrm{M}$ and $0.10\\,\\mathrm{M}$, respectively. Treat the solution as ideally dilute (activity coefficients equal to $1$). The base dissociation constant of ammonia is $K_{b} = 1.8 \\times 10^{-5}$ at $25^{\\circ}\\mathrm{C}$. The water autoprotolysis constant is $K_{w} = 1.0 \\times 10^{-14}$ at $25^{\\circ}\\mathrm{C}$.\n\nStarting only from fundamental statements of mass conservation, charge neutrality, and the definitions of equilibrium constants, formulate and solve the coupled non-linear equilibrium problem for the $\\mathrm{NH_4^+}/\\mathrm{NH_3}$ and water equilibria. Do not assume the autoprotolysis of water is negligible; include it explicitly through $K_{w}$. Compute the solution hydrogen ion concentration and report the pH. Round your final pH to four significant figures. Express the final answer as pH (unitless).", "solution": "The problem is well-posed and scientifically sound, conforming to the fundamental principles of chemical equilibrium. All necessary data are provided, and the constraints are consistent. It is a valid problem.\n\nThe aqueous solution contains the following species: $\\mathrm{NH_3}$, $\\mathrm{NH_4^+}$, $\\mathrm{Cl^-}$, $\\mathrm{H^+}$ (equivalent to $\\mathrm{H_3O^+}$), and $\\mathrm{OH^-}$. The solvent is water, $\\mathrm{H_2O}$.\n\nThe system is governed by two simultaneous equilibria:\n$1$. The base dissociation of ammonia:\n$$\\mathrm{NH_3} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{NH_4^+} + \\mathrm{OH^-}$$\nwith the equilibrium constant $K_b = \\frac{[\\mathrm{NH_4^+}][\\mathrm{OH^-}]}{[\\mathrm{NH_3}]} = 1.8 \\times 10^{-5}$.\n\n$2$. The autoprotolysis of water:\n$$\\mathrm{H_2O} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{OH^-}$$\nwith the equilibrium constant $K_w = [\\mathrm{H^+}][\\mathrm{OH^-}] = 1.0 \\times 10^{-14}$.\n\nFor rigor, it is convenient to work with the acid dissociation of the ammonium ion, $\\mathrm{NH_4^+} \\rightleftharpoons \\mathrm{NH_3} + \\mathrm{H^+}$, whose constant $K_a$ is related to $K_b$ and $K_w$ by the expression $K_a K_b = K_w$.\n$$K_a = \\frac{[\\mathrm{NH_3}][\\mathrm{H^+}]}{[\\mathrm{NH_4^+}]} = \\frac{K_w}{K_b} = \\frac{1.0 \\times 10^{-14}}{1.8 \\times 10^{-5}}$$\n$$K_a = \\frac{5}{9} \\times 10^{-9} \\approx 5.556 \\times 10^{-10}$$\n\nTo determine the equilibrium concentrations, we formulate a system of equations based on fundamental conservation laws.\n\nFirst, the mass balance equations.\nAmmonium chloride, $\\mathrm{NH_4Cl}$, is a strong electrolyte and dissociates completely. The chloride ion, $\\mathrm{Cl^-}$, is a spectator ion, and its concentration is fixed by the initial analytical concentration of $\\mathrm{NH_4Cl}$:\n$$[\\mathrm{Cl^-}] = C_{\\mathrm{NH_4Cl}} = 0.10\\,\\mathrm{M}$$\nThe total concentration of species containing nitrogen (the \"ammonia family\") is conserved. It is the sum of the analytical concentrations of the ammonia and ammonium chloride added to the solution:\n$$C_{T} = [\\mathrm{NH_3}] + [\\mathrm{NH_4^+}] = C_{\\mathrm{NH_3}} + C_{\\mathrm{NH_4Cl}} = 0.20\\,\\mathrm{M} + 0.10\\,\\mathrm{M} = 0.30\\,\\mathrm{M}$$\n\nSecond, the charge balance equation (principle of electroneutrality). The total positive charge concentration must equal the total negative charge concentration:\n$$[\\mathrm{NH_4^+}] + [\\mathrm{H^+}] = [\\mathrm{Cl^-}] + [\\mathrm{OH^-}]$$\n\nWe have a system of five independent equations for the five unknown concentrations ($[\\mathrm{NH_3}]$, $[\\mathrm{NH_4^+}]$, $[\\mathrm{H^+}]$, $[\\mathrm{OH^-}]$, $[\\mathrm{Cl^-}]$):\n$1$. $K_a = \\frac{[\\mathrm{NH_3}][\\mathrm{H^+}]}{[\\mathrm{NH_4^+}]}$\n$2$. $K_w = [\\mathrm{H^+}][\\mathrm{OH^-}]$\n$3$. $[\\mathrm{Cl^-}] = C_{\\mathrm{NH_4Cl}}$\n$4$. $[\\mathrm{NH_3}] + [\\mathrm{NH_4^+}] = C_{T}$\n$5$. $[\\mathrm{NH_4^+}] + [\\mathrm{H^+}] = [\\mathrm{Cl^-}] + [\\mathrm{OH^-}]$\n\nTo solve this system, we express all unknown concentrations in terms of a single master variable, which we choose to be $h=[\\mathrm{H^+}]$.\n\nFrom the $K_a$ definition and the total nitrogen mass balance, we express $[\\mathrm{NH_3}]$ and $[\\mathrm{NH_4^+}]$ as fractions of $C_T$:\nFrom $K_a = \\frac{(C_T - [\\mathrm{NH_4^+}]) h}{[\\mathrm{NH_4^+}]}$, we solve for $[\\mathrm{NH_4^+}]$:\n$$[\\mathrm{NH_4^+}] = C_T \\frac{h}{K_a + h}$$\nAnd for $[\\mathrm{NH_3}]$:\n$$[\\mathrm{NH_3}] = C_T - [\\mathrm{NH_4^+}] = C_T \\left(1 - \\frac{h}{K_a + h}\\right) = C_T \\frac{K_a}{K_a + h}$$\n\nFrom the water autoprotolysis constant, we have:\n$$[\\mathrm{OH^-}] = \\frac{K_w}{h}$$\n\nNow, we substitute these expressions, along with $[\\mathrm{Cl^-}] = C_{\\mathrm{NH_4Cl}}$, into the charge balance equation:\n$$C_T \\frac{h}{K_a + h} + h = C_{\\mathrm{NH_4Cl}} + \\frac{K_w}{h}$$\nThis is the exact equation for $h = [\\mathrm{H^+}]$. To solve it, we rearrange it into a polynomial form. Multiply all terms by $h(K_a + h)$:\n$$C_T h^2 + h^2(K_a + h) = C_{\\mathrm{NH_4Cl}} h(K_a + h) + K_w(K_a + h)$$\n$$C_T h^2 + K_a h^2 + h^3 = C_{\\mathrm{NH_4Cl}} K_a h + C_{\\mathrm{NH_4Cl}} h^2 + K_w K_a + K_w h$$\nGrouping terms by powers of $h$:\n$$h^3 + (C_T + K_a - C_{\\mathrm{NH_4Cl}}) h^2 - (C_{\\mathrm{NH_4Cl}} K_a + K_w) h - K_w K_a = 0$$\nSubstitute $C_T = C_{\\mathrm{NH_3}} + C_{\\mathrm{NH_4Cl}}$ into the coefficient of the $h^2$ term:\n$$h^3 + (C_{\\mathrm{NH_3}} + K_a) h^2 - (C_{\\mathrm{NH_4Cl}} K_a + K_w) h - K_w K_a = 0$$\nThis is the exact cubic polynomial for the hydrogen ion concentration $h$.\n\nWhile this cubic equation can be solved numerically, a highly accurate analytical solution can be obtained by analyzing the magnitudes of the terms. For this buffer system, we expect the pH to be near $\\mathrm{p}K_a \\approx 9.26$, so $h$ will be a small number (on the order of $10^{-10}\\,\\mathrm{M}$).\nLet us examine the coefficients, using $C_{\\mathrm{NH_3}} = 0.20$, $C_{\\mathrm{NH_4Cl}} = 0.10$, $K_a = \\frac{5}{9} \\times 10^{-9}$, and $K_w = 1.0 \\times 10^{-14}$.\nThe coefficient of $h^2$ is $C_{\\mathrm{NH_3}} + K_a \\approx 0.20$.\nThe coefficient of $h$ is $-(C_{\\mathrm{NH_4Cl}} K_a + K_w) \\approx -(0.10 \\times 5.56 \\times 10^{-10}) = -5.56 \\times 10^{-11}$.\nThe constant term is $-K_w K_a \\approx -5.56 \\times 10^{-24}$.\nThe $h^3$ and the constant term are many orders of magnitude smaller than the $h^2$ and $h$ terms. For example, if $h \\approx 10^{-10}$, then $h^3 \\approx 10^{-30}$ and the constant term is $\\approx -5.56 \\times 10^{-24}$. The $h^2$ term is $\\approx 0.2 \\times 10^{-20}$ and the $h$ term is $\\approx -5.56 \\times 10^{-11} \\times 10^{-10} = -5.56 \\times 10^{-21}$.\nNeglecting the $h^3$ and $-K_w K_a$ terms provides an excellent approximation. The cubic equation simplifies to a linear equation in $h$:\n$$(C_{\\mathrm{NH_3}} + K_a) h^2 - (C_{\\mathrm{NH_4Cl}} K_a + K_w) h \\approx 0$$\nSince $h \\neq 0$, we can divide by $h$:\n$$(C_{\\mathrm{NH_3}} + K_a) h \\approx C_{\\mathrm{NH_4Cl}} K_a + K_w$$\n$$h \\approx \\frac{C_{\\mathrm{NH_4Cl}} K_a + K_w}{C_{\\mathrm{NH_3}} + K_a}$$\nThis approximation is equivalent to simplifying the charge balance equation to $[\\mathrm{NH_4^+}] \\approx [\\mathrm{Cl^-}] + [\\mathrm{OH^-}]$ (i.e., $[\\mathrm{H^+}]$ is negligible) but retaining all other species correctly.\n\nNow, we compute the numerical value for $h$:\n$$h = \\frac{(0.10) \\left(\\frac{5}{9} \\times 10^{-9}\\right) + (1.0 \\times 10^{-14})}{0.20 + \\left(\\frac{5}{9} \\times 10^{-9}\\right)}$$\n$$h = \\frac{5.5555... \\times 10^{-11} + 1.0 \\times 10^{-14}}{0.20000000055...}$$\n$$h = \\frac{5.556555... \\times 10^{-11}}{0.20000000055...} \\approx 2.778277... \\times 10^{-10}\\,\\mathrm{M}$$\nFinally, we compute the pH:\n$$\\mathrm{pH} = -\\log_{10}(h) = -\\log_{10}(2.778277... \\times 10^{-10})$$\n$$\\mathrm{pH} \\approx 9.55622...$$\nRounding the result to four significant figures as requested:\n$$\\mathrm{pH} = 9.556$$\nThis result confirms that the solution is basic and the concentration of $\\mathrm{H^+}$ is indeed very small, validating the approximations made to simplify the cubic equation.", "answer": "$$\\boxed{9.556}$$", "id": "2958738"}, {"introduction": "Real chemical systems are rarely ideal, and at the graduate level, it is crucial to move beyond simplified assumptions. This practice challenges you to explore how the presence of inert electrolytes affects buffer pH through non-ideal behavior. By comparing the impact of different salts at the same total ionic strength, you will apply the Debye-Hückel framework to understand the role of activity coefficients and appreciate that the effect is governed by the solution's ionic strength, not the specific identity of the ions [@problem_id:2958720].", "problem": "An aqueous buffer composed of a monoprotic weak acid $\\mathrm{HA}$ and its conjugate base $\\mathrm{A^-}$ is prepared in water at $37^{\\circ}\\mathrm{C}$ on the molality scale. The analytical molalities are $m_{\\mathrm{HA}}=m_{\\mathrm{A^-}}=0.010\\ \\mathrm{mol\\ kg^{-1}}$, and the standard (infinite dilution) acidity constant at $37^{\\circ}\\mathrm{C}$ is $pK_a^{\\circ}=4.750$. An inert supporting electrolyte is added to adjust the total ionic strength to $I=0.200\\ \\mathrm{mol\\ kg^{-1}}$. Consider two cases for the supporting electrolyte: $\\mathrm{NaCl}$ or $\\mathrm{MgCl_2}$. Assume that the contribution of the buffer components to $I$ is negligible relative to the supporting electrolyte, that there is no specific ion association or complexation, and that chloride is not a common ion for the buffer acid-base pair. Use a mean activity model appropriate for single-ion activity coefficients at moderate ionic strengths (for example, the Davies form derived from the Debye–Hückel (DH) theory) to estimate the activity coefficients of $\\mathrm{H^+}$ and $\\mathrm{A^-}$ at the stated $I$.\n\nStarting from the activity-based definition of the acidity constant and taking care to express all quantities in terms of activities, determine the numerical value of the difference in the buffer $\\mathrm{pH}$ between the two cases,\n$$\n\\Delta \\mathrm{pH}=\\mathrm{pH}_{\\mathrm{NaCl}}-\\mathrm{pH}_{\\mathrm{MgCl_2}}.\n$$\nRound your answer to $4$ significant figures. State your final result as a pure number (dimensionless).", "solution": "The problem statement is first subjected to validation.\n\nGivens are extracted verbatim:\n1.  System: An aqueous buffer of a monoprotic weak acid $\\mathrm{HA}$ and its conjugate base $\\mathrm{A^-}$.\n2.  Temperature: $T = 37^{\\circ}\\mathrm{C}$.\n3.  Concentration Scale: Molality ($m$, $\\mathrm{mol\\ kg^{-1}}$).\n4.  Analytical Molalities: $m_{\\mathrm{HA}} = 0.010\\ \\mathrm{mol\\ kg^{-1}}$ and $m_{\\mathrm{A^-}} = 0.010\\ \\mathrm{mol\\ kg^{-1}}$.\n5.  Standard Acidity Constant: $pK_a^{\\circ} = 4.750$ at $37^{\\circ}\\mathrm{C}$.\n6.  Total Ionic Strength: $I = 0.200\\ \\mathrm{mol\\ kg^{-1}}$.\n7.  Supporting Electrolytes: Case 1: $\\mathrm{NaCl}$, Case 2: $\\mathrm{MgCl_2}$.\n8.  Assumptions: Contribution of buffer components to $I$ is negligible; no specific ion association or complexation; chloride is not a common ion.\n9.  Model: Use a mean activity model like the Davies form for single-ion activity coefficients.\n10. Objective: Determine the numerical value of $\\Delta \\mathrm{pH} = \\mathrm{pH}_{\\mathrm{NaCl}} - \\mathrm{pH}_{\\mathrm{MgCl_2}}$, rounded to $4$ significant figures.\n\nValidation Verdict:\nThe problem is valid. It is scientifically grounded in the principles of acid-base equilibria and electrolyte solution theory. It is well-posed, objective, and internally consistent. The parameters are physically realistic. The problem requires a careful application of a specified theoretical model (e.g., Davies equation) under clear constraints (fixed ionic strength, no specific interactions). The apparent complexity involving different electrolytes serves as a rigorous test of the understanding of the model's dependencies, rather than rendering the problem trivial.\n\nA complete, reasoned solution follows.\n\nThe fundamental equilibrium governing the buffer system is the dissociation of the weak acid $\\mathrm{HA}$:\n$$\n\\mathrm{HA}(aq) \\rightleftharpoons \\mathrm{H^+}(aq) + \\mathrm{A^-}(aq)\n$$\nThe thermodynamic acidity constant, $K_a^{\\circ}$, is defined in terms of the activities ($a_i$) of the species at equilibrium:\n$$\nK_a^{\\circ} = \\frac{a_{\\mathrm{H^+}} a_{\\mathrm{A^-}}}{a_{\\mathrm{HA}}}\n$$\nThe activity of a solute species $i$ is related to its molality ($m_i$) and its molal activity coefficient ($\\gamma_i$) by the relation $a_i = m_i \\gamma_i$. The activity of the solvent, water, is taken as unity in dilute solutions. Substituting this into the equilibrium expression gives:\n$$\nK_a^{\\circ} = \\frac{(m_{\\mathrm{H^+}} \\gamma_{\\mathrm{H^+}}) (m_{\\mathrm{A^-}} \\gamma_{\\mathrm{A^-}})}{m_{\\mathrm{HA}} \\gamma_{\\mathrm{HA}}}\n$$\nThe operational definition of $\\mathrm{pH}$ is based on the activity of the hydrogen ion:\n$$\n\\mathrm{pH} = -\\log_{10}(a_{\\mathrm{H^+}}) = -\\log_{10}(m_{\\mathrm{H^+}} \\gamma_{\\mathrm{H^+}})\n$$\nLet the analytical molalities, which are the initial amounts added, be denoted by $m_{\\mathrm{HA}}^0 = 0.010\\ \\mathrm{mol\\ kg^{-1}}$ and $m_{\\mathrm{A^-}}^0 = 0.010\\ \\mathrm{mol\\ kg^{-1}}$. The equilibrium molalities are related to the analytical molalities through the extent of reaction. Let $h = m_{\\mathrm{H^+}}$ be the equilibrium molality of the hydrogen ion. By stoichiometry of the dissociation, the equilibrium molalities of the acid and its base are:\n$$\nm_{\\mathrm{HA}} = m_{\\mathrm{HA}}^0 - h + m_{\\mathrm{OH^-}} \\approx m_{\\mathrm{HA}}^0 - h\n$$\n$$\nm_{\\mathrm{A^-}} = m_{\\mathrm{A^-}}^0 + h - m_{\\mathrm{OH^-}} \\approx m_{\\mathrm{A^-}}^0 + h\n$$\nThe approximations are justified because the solution is acidic, hence $h \\gg m_{\\mathrm{OH^-}}$. Substituting these into the expression for $K_a^{\\circ}$:\n$$\nK_a^{\\circ} = \\frac{h (m_{\\mathrm{A^-}}^0 + h)}{(m_{\\mathrm{HA}}^0 - h)} \\frac{\\gamma_{\\mathrm{H^+}} \\gamma_{\\mathrm{A^-}}}{\\gamma_{\\mathrm{HA}}}\n$$\nThis equation can be rearranged to solve for the equilibrium hydrogen ion molality, $h$:\n$$\nh^2 + (m_{\\mathrm{A^-}}^0 + K_a')h - K_a' m_{\\mathrm{HA}}^0 = 0\n$$\nwhere $K_a'$ is an apparent equilibrium constant defined as:\n$$\nK_a' = K_a^{\\circ} \\frac{\\gamma_{\\mathrm{HA}}}{\\gamma_{\\mathrm{H^+}} \\gamma_{\\mathrm{A^-}}}\n$$\nThe solution for $h$ depends on the initial molalities $m_{\\mathrm{HA}}^0$, $m_{\\mathrm{A^-}}^0$, and the apparent constant $K_a'$.\n\nThe crucial step is to analyze the factors determining the activity coefficients, $\\gamma_i$. The problem specifies using a mean activity model such as the Davies equation, which is derived from Debye-Hückel theory. In such models, the activity coefficient $\\gamma_i$ of an ion $i$ is a function of its charge number $z_i$ and the total ionic strength $I$ of the solution. For instance, the Davies equation has the form:\n$$\n\\log_{10}(\\gamma_i) = -A z_i^2 \\left( \\frac{\\sqrt{I}}{1 + \\sqrt{I}} - bI \\right)\n$$\nwhere $A$ is a constant dependent on the solvent and temperature, and $b$ is an empirical parameter (given as $0.3$ in a typical form). For the neutral species $\\mathrm{HA}$, its activity coefficient $\\gamma_{\\mathrm{HA}}$ is also primarily dependent on the ionic strength $I$ (a phenomenon known as the salting effect), often approximated as $\\gamma_{\\mathrm{HA}} \\approx 1$ or $\\log_{10}(\\gamma_{\\mathrm{HA}}) \\approx k_S I$.\n\nThe problem states that the total ionic strength is adjusted to the *same* value, $I = 0.200\\ \\mathrm{mol\\ kg^{-1}}$, in both solution cases (i.e., with $\\mathrm{NaCl}$ or $\\mathrm{MgCl_2}$ as the supporting electrolyte). The assumption of \"no specific ion association or complexation\" explicitly directs us to use a model like Davies, where the specific nature of the ions constituting the ionic strength does not play a role, only the total value of $I$ matters.\n\nTherefore, for each species $i \\in \\{\\mathrm{H^+}, \\mathrm{A^-}, \\mathrm{HA}\\}$, its activity coefficient $\\gamma_i$ depends only on quantities ($z_i$, $I$) that are identical between the two cases.\n1.  In the $\\mathrm{NaCl}$ case, $I = 0.200\\ \\mathrm{mol\\ kg^{-1}}$. The values of $\\gamma_{\\mathrm{H^+}}$, $\\gamma_{\\mathrm{A^-}}$, and $\\gamma_{\\mathrm{HA}}$ are determined by this ionic strength.\n2.  In the $\\mathrm{MgCl_2}$ case, $I = 0.200\\ \\mathrm{mol\\ kg^{-1}}$. The values of $\\gamma_{\\mathrm{H^+}}$, $\\gamma_{\\mathrm{A^-}}$, and $\\gamma_{\\mathrm{HA}}$ are again determined by this same ionic strength.\n\nConsequently, the activity coefficients for all species involved in the equilibrium are identical in both solutions:\n$$\n(\\gamma_i)_{\\mathrm{NaCl}} = (\\gamma_i)_{\\mathrm{MgCl_2}}\n$$\nThis implies that the apparent equilibrium constant, $K_a'$, is also identical in both cases.\n$$\n(K_a')_{\\mathrm{NaCl}} = (K_a')_{\\mathrm{MgCl_2}}\n$$\nSince the analytical molalities ($m_{\\mathrm{HA}}^0$, $m_{\\mathrm{A^-}}^0$) and the apparent constant ($K_a'$) are the same for both systems, the quadratic equation for the equilibrium hydrogen ion molality $h$ is identical in both cases. This leads to the conclusion that the value of $h$ is the same for both solutions.\n$$\nh_{\\mathrm{NaCl}} = h_{\\mathrm{MgCl_2}}\n$$\nFinally, we examine the $\\mathrm{pH}$. The $\\mathrm{pH}$ in each case is given by:\n$$\n\\mathrm{pH}_{\\mathrm{NaCl}} = -\\log_{10}(h_{\\mathrm{NaCl}} \\cdot (\\gamma_{\\mathrm{H^+}})_{\\mathrm{NaCl}})\n$$\n$$\n\\mathrm{pH}_{\\mathrm{MgCl_2}} = -\\log_{10}(h_{\\mathrm{MgCl_2}} \\cdot (\\gamma_{\\mathrm{H^+}})_{\\mathrm{MgCl_2}})\n$$\nSince we have established that $h_{\\mathrm{NaCl}} = h_{\\mathrm{MgCl_2}}$ and $(\\gamma_{\\mathrm{H^+}})_{\\mathrm{NaCl}} = (\\gamma_{\\mathrm{H^+}})_{\\mathrm{MgCl_2}}$, it must be that the activities of the hydrogen ion are equal, $a_{\\mathrm{H^+, NaCl}} = a_{\\mathrm{H^+, MgCl_2}}$. Taking the negative base-$10$ logarithm of this equality, we find that the $\\mathrm{pH}$ values are identical.\n$$\n\\mathrm{pH}_{\\mathrm{NaCl}} = \\mathrm{pH}_{\\mathrm{MgCl_2}}\n$$\nThe required difference is therefore zero.\n$$\n\\Delta \\mathrm{pH} = \\mathrm{pH}_{\\mathrm{NaCl}} - \\mathrm{pH}_{\\mathrm{MgCl_2}} = 0\n$$\nThe problem requires the answer to be rounded to $4$ significant figures. A result of exactly zero can be expressed as $0.0000$.", "answer": "$$\\boxed{0.0000}$$", "id": "2958720"}, {"introduction": "The ultimate test of a scientific model is its ability to describe experimental data. This final practice bridges the gap between theory and application by guiding you through a complete data analysis workflow. You will construct a forward model to predict pH, use it to estimate an unknown acid dissociation constant $K_a$ from simulated noisy measurements via nonlinear least squares, and quantify the confidence in your estimate, mirroring the process of modern chemical research [@problem_id:2958712].", "problem": "A monoprotic weak acid solution at temperature $25\\,^{\\circ}\\mathrm{C}$ is prepared with a fixed analytical acid concentration and then titrated by adding known analytical amounts of its sodium salt that supplies the conjugate base (common ion). Assume ideal behavior (activity coefficients equal to $1$) and pure water autodissociation with ionic product $K_{\\mathrm{w}} = 1.0\\times 10^{-14}$. The acid dissociation reaction is $\\mathrm{HA} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{A^-}$ with an unknown thermodynamic acid dissociation constant $K_{\\mathrm{a}}$ to be estimated.\n\nFundamental base to use:\n- Mass balance for the acid family: the total concentration of all species carrying the acid’s atom balance is the sum of the analytical acid and the added conjugate base. If $C_{\\mathrm{HA}}$ is the analytical concentration of the weak acid initially present and $C_{\\mathrm{salt}}$ is the analytical concentration of the added sodium salt of the conjugate base, then the total acid-family concentration is $C_{\\mathrm{T}} = C_{\\mathrm{HA}} + C_{\\mathrm{salt}}$, and the species satisfy $[\\mathrm{HA}] + [\\mathrm{A^-}] = C_{\\mathrm{T}}$.\n- Charge balance (electroneutrality): the sum of positive charges equals the sum of negative charges, including contributions from $\\mathrm{H^+}$, $\\mathrm{OH^-}$, the conjugate base $\\mathrm{A^-}$, and the sodium counterion from the salt addition.\n- Law of mass action for dissociation: $K_{\\mathrm{a}} = \\dfrac{[\\mathrm{H^+}][\\mathrm{A^-}]}{[\\mathrm{HA}]}$.\n- Water autodissociation: $K_{\\mathrm{w}} = [\\mathrm{H^+}][\\mathrm{OH^-}]$.\n\nMeasured data consist of $N$ pairs $\\{(C_{\\mathrm{salt},i}, \\mathrm{pH}_i^{\\mathrm{(meas)}})\\}_{i=1}^N$ for fixed $C_{\\mathrm{HA}}$, where each $\\mathrm{pH}_i^{\\mathrm{(meas)}}$ is obtained by adding independent, identically distributed zero-mean Gaussian noise (in $\\mathrm{pH}$ units) with known standard deviation to the true model $\\mathrm{pH}_i^{\\mathrm{(true)}} = -\\log_{10}([\\mathrm{H^+}]_i)$ predicted by the above principles for the given $K_{\\mathrm{a}}$, $C_{\\mathrm{HA}}$, and $C_{\\mathrm{salt},i}$.\n\nTask:\n1) Starting only from the fundamental laws and definitions stated above, build a forward model that, for any given $K_{\\mathrm{a}}$, $C_{\\mathrm{HA}}$, $C_{\\mathrm{salt}}$, and $K_{\\mathrm{w}}$, computes the physically valid positive root for $[\\mathrm{H^+}]$ and returns $\\mathrm{pH} = -\\log_{10}([\\mathrm{H^+}])$.\n2) Given noisy $\\mathrm{pH}$ data generated from known ground-truth parameters, estimate $K_{\\mathrm{a}}$ by minimizing the nonlinear least squares objective\n$$\nS(K_{\\mathrm{a}}) = \\sum_{i=1}^N \\left(\\mathrm{pH}_i^{\\mathrm{(meas)}} - \\mathrm{pH}_i^{\\mathrm{(model)}}(K_{\\mathrm{a}})\\right)^2,\n$$\nsubject to $K_{\\mathrm{a}}  0$. Use a parametrization that guarantees positivity and a bounded one-dimensional search domain.\n3) Using the Fisher information approach for independent, identically distributed Gaussian errors in $\\mathrm{pH}$ with variance $\\sigma^2$, compute the Fisher information for the single parameter in the logarithmic parameterization $\\theta = \\ln K_{\\mathrm{a}}$:\n$$\n\\mathcal{I}(\\theta) = \\frac{1}{\\sigma^2}\\sum_{i=1}^N \\left(\\frac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta}\\right)^2,\n$$\nevaluate it at the estimator $\\hat{\\theta}$, and report the corresponding approximate $95\\%$ confidence interval for $K_{\\mathrm{a}}$ obtained by transforming the normal approximation for $\\theta$ back to the original scale. Use a numerically stable method to compute $\\frac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta}$.\n4) For each test case, output a list of three floating-point numbers in scientific notation: the estimated $K_{\\mathrm{a}}$, the lower bound of the approximate $95\\%$ confidence interval for $K_{\\mathrm{a}}$, and the upper bound of the approximate $95\\%$ confidence interval for $K_{\\mathrm{a}}$, in that order.\n\nData generation protocol (must be followed exactly to ensure testability):\n- Use $K_{\\mathrm{w}} = 1.0\\times 10^{-14}$ and a fixed random seed of $2025$ for all cases.\n- Generate the noisy $\\mathrm{pH}$ measurements by adding independent Gaussian noise with zero mean and specified standard deviation $\\sigma_{\\mathrm{pH}}$ (in $\\mathrm{pH}$ units) to the noise-free model $\\mathrm{pH}$.\n- For each test case, compute the “true” $\\mathrm{pH}$ values using the ground-truth $K_{\\mathrm{a}}^{(\\mathrm{true})}$, the specified $C_{\\mathrm{HA}}$, and the list of $C_{\\mathrm{salt}}$ values, then add noise.\n\nTest suite to implement:\n- Case A (happy path): $K_{\\mathrm{a}}^{(\\mathrm{true})} = 1.8\\times 10^{-5}$, $C_{\\mathrm{HA}} = 1.0\\times 10^{-2}$, $C_{\\mathrm{salt}} \\in \\{0.0, 1.0\\times 10^{-3}, 3.0\\times 10^{-3}, 1.0\\times 10^{-2}, 3.0\\times 10^{-2}\\}$, $\\sigma_{\\mathrm{pH}} = 2.0\\times 10^{-3}$.\n- Case B (very weak acid regime, water important): $K_{\\mathrm{a}}^{(\\mathrm{true})} = 1.0\\times 10^{-8}$, $C_{\\mathrm{HA}} = 1.0\\times 10^{-3}$, $C_{\\mathrm{salt}} \\in \\{0.0, 3.0\\times 10^{-4}, 1.0\\times 10^{-3}, 3.0\\times 10^{-3}\\}$, $\\sigma_{\\mathrm{pH}} = 2.0\\times 10^{-3}$.\n- Case C (strong common ion loading): $K_{\\mathrm{a}}^{(\\mathrm{true})} = 1.0\\times 10^{-6}$, $C_{\\mathrm{HA}} = 5.0\\times 10^{-3}$, $C_{\\mathrm{salt}} \\in \\{0.0, 5.0\\times 10^{-2}, 1.0\\times 10^{-1}, 2.0\\times 10^{-1}\\}$, $\\sigma_{\\mathrm{pH}} = 2.0\\times 10^{-3}$.\n\nComputation and reporting details:\n- Use $N$ equal to the number of listed $C_{\\mathrm{salt}}$ values for each case.\n- For the least-squares fit, parametrize by $\\theta = \\ln K_{\\mathrm{a}}$ and search in the bounded interval $\\theta \\in [\\ln(10^{-12}), \\ln(1)]$.\n- Estimate $\\sigma^2$ by the unbiased residual variance $\\hat{\\sigma}^2 = \\dfrac{\\mathrm{RSS}}{N - 1}$, where $\\mathrm{RSS}$ is the residual sum of squares at the minimizer and there is one fitted parameter.\n- Compute the Fisher information in $\\theta$, $\\mathcal{I}(\\hat{\\theta})$, using a numerically stable central-difference approximation for the sensitivity $\\dfrac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta}$ with a small step in $\\theta$.\n- Construct an approximate $95\\%$ confidence interval for $K_{\\mathrm{a}}$ by first obtaining the normal-based interval for $\\theta$,\n$$\n\\hat{\\theta} \\pm 1.96 \\sqrt{\\mathcal{I}(\\hat{\\theta})^{-1}},\n$$\nand then mapping its endpoints back to $K_{\\mathrm{a}}$ via the exponential function.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sub-list of three values in scientific notation with exactly six significant figures, in the order $[K_{\\mathrm{a}}^{(\\mathrm{est})}, K_{\\mathrm{a}}^{(\\mathrm{lo95})}, K_{\\mathrm{a}}^{(\\mathrm{hi95})}]$. For example: [[1.234567e-05,1.111111e-05,1.358024e-05],[...],[...]].", "solution": "The problem presented is a comprehensive exercise in chemical equilibrium modeling, parameter estimation, and statistical uncertainty quantification. It is scientifically sound, well-posed, and requires a rigorous application of fundamental principles. We shall proceed with the derivation and solution.\n\nThe solution is structured into three parts:\n1.  Derivation of the forward model to calculate the hydrogen ion concentration $[\\mathrm{H^+}]$ and, subsequently, the $\\mathrm{pH}$.\n2.  Formulation of the inverse problem for estimating the acid dissociation constant $K_{\\mathrm{a}}$ via nonlinear least squares.\n3.  Development of the statistical framework for determining the confidence interval for the estimated $K_{\\mathrm{a}}$ using the Fisher information matrix.\n\nFirst, we must construct the forward model, which predicts the $\\mathrm{pH}$ for a given set of parameters $\\{K_{\\mathrm{a}}, C_{\\mathrm{HA}}, C_{\\mathrm{salt}}, K_{\\mathrm{w}}\\}$. We begin with the four fundamental equilibrium relationships provided:\n1.  Mass balance for the acid/base conjugate pair: $[\\mathrm{HA}] + [\\mathrm{A^-}] = C_{\\mathrm{T}}$, where $C_{\\mathrm{T}} = C_{\\mathrm{HA}} + C_{\\mathrm{salt}}$.\n2.  Charge balance (electroneutrality): $[\\mathrm{Na^+}] + [\\mathrm{H^+}] = [\\mathrm{A^-}] + [\\mathrm{OH^-}]$. Since the sodium salt is the source of the common ion $\\mathrm{A^-}$ and the counter-ion $\\mathrm{Na^+}$, we have $[\\mathrm{Na^+}] = C_{\\mathrm{salt}}$.\n3.  Acid dissociation equilibrium: $K_{\\mathrm{a}} = \\dfrac{[\\mathrm{H^+}][\\mathrm{A^-}]}{[\\mathrm{HA}]}$.\n4.  Water autodissociation equilibrium: $K_{\\mathrm{w}} = [\\mathrm{H^+}][\\mathrm{OH^-}]$.\n\nLet us denote the hydrogen ion concentration as $h \\equiv [\\mathrm{H^+}]$. Our objective is to derive a single equation for $h$. From the water autodissociation equilibrium (4), we express the hydroxide concentration as $[\\mathrm{OH^-}] = K_{\\mathrm{w}}/h$. Substituting this and $[\\mathrm{Na^+}] = C_{\\mathrm{salt}}$ into the charge balance equation (2) allows us to express the conjugate base concentration $[\\mathrm{A^-}]$ in terms of $h$:\n$$\nC_{\\mathrm{salt}} + h = [\\mathrm{A^-}] + \\frac{K_{\\mathrm{w}}}{h} \\implies [\\mathrm{A^-}] = C_{\\mathrm{salt}} + h - \\frac{K_{\\mathrm{w}}}{h}\n$$\nNext, we use the acid dissociation (3) and mass balance (1) relations to find an alternative expression for $[\\mathrm{A^-}]$. From (3), $[\\mathrm{HA}] = \\frac{h[\\mathrm{A^-}]}{K_{\\mathrm{a}}}$. Substituting this into (1):\n$$\n\\frac{h[\\mathrm{A^-}]}{K_{\\mathrm{a}}} + [\\mathrm{A^-}] = C_{\\mathrm{T}} \\implies [\\mathrm{A^-}]\\left(\\frac{h}{K_{\\mathrm{a}}}+1\\right) = C_{\\mathrm{T}} \\implies [\\mathrm{A^-}] = C_{\\mathrm{T}}\\left(\\frac{K_{\\mathrm{a}}}{h+K_{\\mathrm{a}}}\\right)\n$$\nEquating the two expressions for $[\\mathrm{A^-}]$ yields the governing equation for $h$:\n$$\nC_{\\mathrm{salt}} + h - \\frac{K_{\\mathrm{w}}}{h} = (C_{\\mathrm{HA}} + C_{\\mathrm{salt}})\\left(\\frac{K_{\\mathrm{a}}}{h+K_{\\mathrm{a}}}\\right)\n$$\nTo solve for $h$, we rearrange this into a polynomial form by multiplying all terms by $h(h+K_{\\mathrm{a}})$:\n$$\n(C_{\\mathrm{salt}} + h)h(h+K_{\\mathrm{a}}) - K_{\\mathrm{w}}(h+K_{\\mathrm{a}}) = (C_{\\mathrm{HA}} + C_{\\mathrm{salt}})K_{\\mathrm{a}}h\n$$\nExpanding and collecting terms of the powers of $h$:\n$$\nh^3 + (K_{\\mathrm{a}} + C_{\\mathrm{salt}})h^2 - (K_{\\mathrm{a}}C_{\\mathrm{HA}} + K_{\\mathrm{w}})h - K_{\\mathrm{a}}K_{\\mathrm{w}} = 0\n$$\nThis is a cubic equation in $h=[\\mathrm{H^+}]$. For any physically realistic set of positive parameters $\\{K_{\\mathrm{a}}, C_{\\mathrm{HA}}, C_{\\mathrm{salt}}, K_{\\mathrm{w}}\\}$, this polynomial has exactly one positive real root. This can be confirmed by Descartes' rule of signs on the coefficients $(1, K_{\\mathrm{a}}+C_{\\mathrm{salt}}, -(K_{\\mathrm{a}}C_{\\mathrm{HA}}+K_{\\mathrm{w}}), -K_{\\mathrm{a}}K_{\\mathrm{w}})$, which have the sign pattern $(+, +, -, -)$, indicating a single sign change and thus a single positive root. This unique positive root is the physically valid concentration $[\\mathrm{H^+}]$. The forward model is completed by calculating $\\mathrm{pH} = -\\log_{10}(h)$.\n\nSecond, we address the inverse problem of estimating $K_{\\mathrm{a}}$. We are given $N$ data pairs $\\{(C_{\\mathrm{salt},i}, \\mathrm{pH}_i^{\\mathrm{(meas)}})\\}_{i=1}^N$. The estimation is performed by minimizing the sum of squared residuals (RSS) between the measured $\\mathrm{pH}$ and the model-predicted $\\mathrm{pH}$:\n$$\nS(K_{\\mathrm{a}}) = \\sum_{i=1}^N \\left(\\mathrm{pH}_i^{\\mathrm{(meas)}} - \\mathrm{pH}_i^{\\mathrm{(model)}}(K_{\\mathrm{a}}, C_{\\mathrm{HA}}, C_{\\mathrm{salt},i})\\right)^2\n$$\nTo enforce the physical constraint $K_{\\mathrm{a}}  0$ and to improve the numerical stability of the optimization, we perform a change of variables to $\\theta = \\ln K_{\\mathrm{a}}$, so that $K_{\\mathrm{a}} = e^{\\theta}$. The optimization problem becomes finding $\\hat{\\theta}$ that minimizes:\n$$\nS(\\theta) = \\sum_{i=1}^N \\left(\\mathrm{pH}_i^{\\mathrm{(meas)}} - \\mathrm{pH}_i^{\\mathrm{(model)}}(e^{\\theta}, C_{\\mathrm{HA}}, C_{\\mathrm{salt},i})\\right)^2\n$$\nThis is a one-dimensional optimization problem over the specified bounded domain $\\theta \\in [\\ln(10^{-12}), \\ln(1)]$, which can be efficiently solved using numerical methods such as Brent's method. The estimate for $K_{\\mathrm{a}}$ is then $\\hat{K}_{\\mathrm{a}} = e^{\\hat{\\theta}}$.\n\nThird, we construct the confidence interval for the estimate $\\hat{K}_{\\mathrm{a}}$. For independent and identically distributed Gaussian errors in the measured variable ($\\mathrm{pH}$), the variance of the parameter estimator $\\hat{\\theta}$ can be approximated using the Cramer-Rao lower bound, which is the inverse of the Fisher information, $\\mathcal{I}(\\theta)$. The Fisher information for a single parameter $\\theta$ is given by:\n$$\n\\mathcal{I}(\\theta) = \\frac{1}{\\sigma^2}\\sum_{i=1}^N \\left(\\frac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta}\\right)^2\n$$\nHere, $\\sigma^2$ is the variance of the measurement noise in $\\mathrm{pH}$ units. Since $\\sigma^2$ is unknown, it is estimated from the residuals of the fit: $\\hat{\\sigma}^2 = \\frac{\\mathrm{RSS}_{\\min}}{N-p}$, where $\\mathrm{RSS}_{\\min} = S(\\hat{\\theta})$ is the minimum residual sum of squares and $p=1$ is the number of fitted parameters. The sensitivity derivatives $\\frac{\\partial \\mathrm{pH}}{\\partial \\theta}$ are computed numerically at the optimal value $\\hat{\\theta}$ using a symmetric central difference formula for stability:\n$$\n\\frac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta} \\approx \\frac{\\mathrm{pH}_i^{\\mathrm{(model)}}(e^{\\hat{\\theta}+\\delta}) - \\mathrm{pH}_i^{\\mathrm{(model)}}(e^{\\hat{\\theta}-\\delta})}{2\\delta}\n$$\nfor a small step size $\\delta$. The Fisher information is then evaluated at the estimate: $\\mathcal{I}(\\hat{\\theta}) = \\frac{1}{\\hat{\\sigma}^2}\\sum_{i=1}^N \\left(\\frac{\\partial \\mathrm{pH}_i}{\\partial \\theta}\\right)^2_{\\theta=\\hat{\\theta}}$. The standard error of the estimator $\\hat{\\theta}$ is $\\mathrm{se}(\\hat{\\theta}) = \\sqrt{\\mathcal{I}(\\hat{\\theta})^{-1}}$. An approximate $95\\%$ confidence interval for $\\theta$ is then $[\\theta_{\\mathrm{lo}}, \\theta_{\\mathrm{hi}}] = [\\hat{\\theta} - 1.96 \\cdot \\mathrm{se}(\\hat{\\theta}), \\hat{\\theta} + 1.96 \\cdot \\mathrm{se}(\\hat{\\theta})]$. By transforming the endpoints of this interval back to the original parameter space, we obtain the $95\\%$ confidence interval for $K_{\\mathrm{a}}$:\n$$\n[K_{\\mathrm{a},\\mathrm{lo95}}, K_{\\mathrm{a},\\mathrm{hi95}}] = [e^{\\theta_{\\mathrm{lo}}}, e^{\\theta_{\\mathrm{hi}}}]\n$$\nThis completes the theoretical framework. The implementation will follow these steps precisely for each test case.", "answer": "[[1.805510e-05,1.782755e-05,1.828604e-05],[1.011036e-08,9.851999e-09,1.037525e-08],[1.002989e-06,9.921359e-07,1.014002e-06]]", "id": "2958712"}]}