{"hands_on_practices": [{"introduction": "The \"ultraviolet catastrophe\" marked a fundamental failure of classical physics to describe black-body radiation. This exercise guides you to confront this failure directly by deriving both the classical Rayleigh–Jeans law and Planck’s revolutionary quantum formula from first principles [@problem_id:2951477]. By calculating the ratio of their predictions, you will gain a quantitative appreciation for the necessity of energy quantization.", "problem": "A perfectly absorbing cavity of volume $V$ is in thermal equilibrium at temperature $T$. Consider the spectral energy density per unit frequency, $u(\\nu,T)$, of the electromagnetic (EM) field in the cavity. Using only the following foundational elements:\n- The classical equipartition theorem for a harmonic mode at temperature $T$.\n- Planck’s quantum hypothesis that the energy of a mode of frequency $\\nu$ is quantized as $E_{n} = n h \\nu$ with $n = 0,1,2,\\dots$ (ignore the zero-point energy when computing the thermally accessible energy).\n- The Boltzmann distribution in the canonical ensemble.\n- The well-tested density of EM modes per unit volume per unit frequency in three dimensions, $g(\\nu) = \\dfrac{8\\pi \\nu^{2}}{c^{3}}$.\n\n(a) Derive the classical Rayleigh–Jeans expression for $u(\\nu,T)$ by combining the equipartition result for the mean energy per mode with $g(\\nu)$.\n\n(b) Derive the quantum (Planck) expression for $u(\\nu,T)$ by combining the canonical ensemble average energy per quantized mode implied by Planck’s hypothesis with $g(\\nu)$.\n\n(c) From your results in (a) and (b), form the ratio $R(T,\\nu)$ of the Rayleigh–Jeans spectral energy density to the Planck spectral energy density at the same temperature $T$ and frequency $\\nu$.\n\n(d) Evaluate $R(T,\\nu)$ at $T = 1800\\ \\mathrm{K}$ and $\\nu = 7.500 \\times 10^{13}\\ \\mathrm{s}^{-1}$. Use $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J}\\cdot\\mathrm{s}$, $k_{\\mathrm B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J}\\cdot\\mathrm{K}^{-1}$, and $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m}\\cdot\\mathrm{s}^{-1}$. Express your final answer as a pure number (dimensionless) and round your answer to five significant figures.", "solution": "The problem statement is scientifically grounded, well-posed, objective, and complete. It is a standard problem in statistical mechanics and quantum theory concerning the historical development of the theory of black-body radiation. The problem is valid and can be solved as stated.\n\nThe analysis will proceed in four parts as delineated in the problem statement. The spectral energy density per unit frequency, $u(\\nu, T)$, is defined as the product of the density of electromagnetic modes per unit volume per unit frequency, $g(\\nu)$, and the average energy per mode, $\\langle E \\rangle$.\n$$u(\\nu, T) = g(\\nu) \\langle E \\rangle$$\nThe given density of modes is $g(\\nu) = \\dfrac{8\\pi \\nu^{2}}{c^{3}}$.\n\n(a) Derivation of the Rayleigh–Jeans Expression\nTo derive the classical Rayleigh–Jeans law, we must determine the classical average energy per mode, $\\langle E \\rangle_{classical}$. The problem instructs to use the equipartition theorem. An electromagnetic mode in a cavity behaves as a classical harmonic oscillator. The energy of a one-dimensional harmonic oscillator has two quadratic terms (one kinetic, one potential). According to the equipartition theorem, each quadratic degree of freedom contributes an average energy of $\\dfrac{1}{2} k_{\\mathrm B} T$ to the system at thermal equilibrium at temperature $T$, where $k_{\\mathrm B}$ is the Boltzmann constant.\nTherefore, the average energy of a single mode is:\n$$\\langle E \\rangle_{classical} = 2 \\times \\frac{1}{2} k_{\\mathrm B} T = k_{\\mathrm B} T$$\nThe Rayleigh–Jeans spectral energy density, $u_{RJ}(\\nu, T)$, is then found by substituting this average energy into the general expression for $u(\\nu, T)$:\n$$u_{RJ}(\\nu, T) = g(\\nu) \\langle E \\rangle_{classical} = \\left( \\frac{8\\pi \\nu^{2}}{c^{3}} \\right) k_{\\mathrm B} T$$\nThis is the Rayleigh–Jeans formula.\n\n(b) Derivation of the Planck Expression\nTo derive the quantum (Planck) expression, we must calculate the quantum mechanical average energy of a mode, $\\langle E \\rangle_{quantum}$. The problem provides Planck's hypothesis, which quantizes the energy of an oscillator of frequency $\\nu$ as $E_{n} = n h \\nu$, where $n$ is a non-negative integer ($n=0, 1, 2, \\dots$) and $h$ is Planck's constant.\nThe average energy is calculated using the canonical ensemble and the Boltzmann distribution. The probability $P(E_n)$ of a mode having energy $E_n$ is proportional to the Boltzmann factor $\\exp(-E_{n} / k_{\\mathrm B} T)$.\nThe average energy is the sum of all possible energies weighted by their respective probabilities:\n$$\\langle E \\rangle_{quantum} = \\frac{\\sum_{n=0}^{\\infty} E_{n} \\exp(-E_{n}/k_{\\mathrm B}T)}{\\sum_{n=0}^{\\infty} \\exp(-E_{n}/k_{\\mathrm B}T)}$$\nThe denominator is the partition function, $Z$. Let us substitute $E_{n} = n h \\nu$ and define $\\beta = 1/(k_{\\mathrm B}T)$.\n$$Z = \\sum_{n=0}^{\\infty} \\exp(-n h \\nu \\beta) = \\sum_{n=0}^{\\infty} (\\exp(-h \\nu \\beta))^{n}$$\nThis is a geometric series with ratio $r = \\exp(-h \\nu \\beta)$, which is less than $1$ for $T > 0$. The sum is $Z = \\dfrac{1}{1 - \\exp(-h \\nu \\beta)}$.\nThe numerator is:\n$$\\sum_{n=0}^{\\infty} (n h \\nu) \\exp(-n h \\nu \\beta) = h \\nu \\sum_{n=0}^{\\infty} n (\\exp(-h \\nu \\beta))^{n}$$\nA convenient method to evaluate this is to note that $\\sum n x^n = x \\frac{d}{dx} \\sum x^n$. Or, one can use the relation $\\langle E \\rangle = -\\dfrac{\\partial \\ln Z}{\\partial \\beta}$.\nUsing the latter approach:\n$$\\ln Z = -\\ln(1 - \\exp(-h \\nu \\beta))$$\n$$\\langle E \\rangle_{quantum} = -\\frac{\\partial}{\\partial \\beta} [-\\ln(1 - \\exp(-h \\nu \\beta))] = \\frac{1}{1 - \\exp(-h \\nu \\beta)} \\cdot \\frac{\\partial}{\\partial \\beta}(1 - \\exp(-h \\nu \\beta))$$\n$$\\langle E \\rangle_{quantum} = \\frac{1}{1 - \\exp(-h \\nu \\beta)} \\cdot (- \\exp(-h \\nu \\beta)) \\cdot (-h \\nu) = \\frac{h \\nu \\exp(-h \\nu \\beta)}{1 - \\exp(-h \\nu \\beta)}$$\nMultiplying the numerator and denominator by $\\exp(h \\nu \\beta)$ gives the final form for the average energy:\n$$\\langle E \\rangle_{quantum} = \\frac{h \\nu}{\\exp(h \\nu \\beta) - 1} = \\frac{h \\nu}{\\exp(h \\nu / k_{\\mathrm B} T) - 1}$$\nThe Planck spectral energy density, $u_{P}(\\nu, T)$, is then found by substituting this quantum average energy:\n$$u_{P}(\\nu, T) = g(\\nu) \\langle E \\rangle_{quantum} = \\left( \\frac{8\\pi \\nu^{2}}{c^{3}} \\right) \\left( \\frac{h \\nu}{\\exp(h \\nu / k_{\\mathrm B} T) - 1} \\right) = \\frac{8\\pi h \\nu^{3}}{c^{3}} \\frac{1}{\\exp(h \\nu / k_{\\mathrm B} T) - 1}$$\nThis is Planck's radiation law.\n\n(c) Ratio of Rayleigh–Jeans to Planck Density\nThe ratio $R(T, \\nu)$ is defined as the Rayleigh–Jeans spectral energy density divided by the Planck spectral energy density:\n$$R(T, \\nu) = \\frac{u_{RJ}(\\nu, T)}{u_{P}(\\nu, T)} = \\frac{\\dfrac{8\\pi \\nu^{2} k_{\\mathrm B} T}{c^{3}}}{\\dfrac{8\\pi h \\nu^{3}}{c^{3}} \\dfrac{1}{\\exp(h \\nu / k_{\\mathrm B} T) - 1}}$$\nThe common factor $\\dfrac{8\\pi \\nu^{2}}{c^{3}}$ cancels from the numerator and denominator.\n$$R(T, \\nu) = \\frac{k_{\\mathrm B} T}{\\dfrac{h \\nu}{\\exp(h \\nu / k_{\\mathrm B} T) - 1}} = \\frac{k_{\\mathrm B} T}{h \\nu} (\\exp(h \\nu / k_{\\mathrm B} T) - 1)$$\nThis is the analytical expression for the ratio.\n\n(d) Numerical Evaluation\nWe must evaluate $R(T, \\nu)$ for the given values:\n$T = 1800\\ \\mathrm{K}$\n$\\nu = 7.500 \\times 10^{13}\\ \\mathrm{s}^{-1}$\n$h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J}\\cdot\\mathrm{s}$\n$k_{\\mathrm B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J}\\cdot\\mathrm{K}^{-1}$\n\nFirst, we compute the dimensionless quantity $x = \\dfrac{h \\nu}{k_{\\mathrm B} T}$:\n$$x = \\frac{(6.62607015 \\times 10^{-34}\\ \\mathrm{J}\\cdot\\mathrm{s}) \\times (7.500 \\times 10^{13}\\ \\mathrm{s}^{-1})}{(1.380649 \\times 10^{-23}\\ \\mathrm{J}\\cdot\\mathrm{K}^{-1}) \\times (1800\\ \\mathrm{K})}$$\n$$x = \\frac{4.9695526125 \\times 10^{-20}\\ \\mathrm{J}}{2.4851682 \\times 10^{-20}\\ \\mathrm{J}} \\approx 1.999683700$$\nThe ratio $R(T, \\nu)$ can be expressed in terms of $x$ as:\n$$R(x) = \\frac{1}{x} (\\exp(x) - 1)$$\nSubstituting the value of $x$:\n$$R \\approx \\frac{1}{1.999683700} (\\exp(1.999683700) - 1)$$\n$$R \\approx \\frac{1}{1.999683700} (7.386766020 - 1)$$\n$$R \\approx \\frac{6.386766020}{1.999683700} \\approx 3.19391090$$\nRounding the result to five significant figures as required gives $3.1939$.", "answer": "$$\\boxed{3.1939}$$", "id": "2951477"}, {"introduction": "While Planck introduced quantization to solve the black-body problem, it was Einstein's explanation of the photoelectric effect that cemented the concept of the photon. This practice allows you to retrace this pivotal argument by applying energy conservation to the interaction between a single photon and an electron in a metal [@problem_id:2951441]. Deriving the expression for the stopping potential reinforces the core idea that a photon's energy is discrete and proportional to its frequency.", "problem": "In a photoemission experiment on a clean metallic surface in vacuum, monochromatic light of frequency $\\nu$ is shone on the surface and electrons are emitted. A variable retarding potential is applied between the emitter and a collector such that at a particular value, called the stopping potential, the photocurrent drops to $0$. Let $h$ denote Planck’s constant, $e$ the magnitude of the elementary charge, and $\\phi$ the work function of the metal. Assume the frequency $\\nu$ is sufficiently high that electrons are emitted and a finite stopping potential exists. Starting only from conservation of energy, the quantization of electromagnetic radiation into photons, and the definition of the stopping potential as the minimal retarding potential that reduces the maximum electron kinetic energy to $0$, derive a simplified symbolic expression for the stopping potential $V_{s}$ in terms of $h$, $\\nu$, $\\phi$, and $e$. In your derivation, clearly define the work function $\\phi$ in physical terms. Express your final result as a single symbolic expression for $V_{s}$. Do not include units in your final boxed answer.", "solution": "The problem statement is critically examined and found to be valid. It presents a standard, well-posed problem in physics concerning the photoelectric effect, which is grounded in established scientific principles—namely, conservation of energy and Planck's quantum hypothesis. The provided variables and conditions are sufficient and consistent for deriving the requested relationship. The language is objective and unambiguous. We may therefore proceed with the derivation.\n\nThe fundamental principle governing the photoemission process is the conservation of energy. According to the quantum hypothesis proposed by Planck and later applied to light by Einstein, electromagnetic radiation of frequency $\\nu$ is composed of discrete energy quanta called photons. The energy of a single photon, $E_{photon}$, is given by the relation:\n$$E_{photon} = h\\nu$$\nwhere $h$ is Planck’s constant.\n\nIn the photoelectric effect, a single photon is absorbed by a single electron within the metallic surface. A portion of the absorbed energy is used by the electron to overcome the electrostatic forces that bind it to the metal. The minimum amount of energy required for an electron to escape from the surface of the material is a characteristic property of the metal known as the work function, denoted by $\\phi$.\n\nAny energy from the photon that remains after overcoming the work function is converted into the kinetic energy, $K$, of the emitted electron, which is called a photoelectron. The energy conservation equation for this process can thus be written as:\n$$E_{photon} = \\phi + K$$\nSubstituting the expression for the photon energy gives:\n$$h\\nu = \\phi + K$$\nThe electrons emitted from the surface do not all have the same kinetic energy. This is because electrons reside at different energy levels within the metal and may lose some energy through collisions before escaping. The maximum kinetic energy, $K_{max}$, is possessed by those electrons that are least tightly bound and escape without energy loss, for which the energy required for liberation is precisely the work function $\\phi$. For these most energetic electrons, the conservation of energy equation is:\n$$h\\nu = \\phi + K_{max}$$\nThe problem defines a retarding potential, $V$, applied between the emitter and the collector. This potential creates an electric field that opposes the motion of the emitted electrons. The stopping potential, $V_s$, is the specific value of this retarding potential that is just sufficient to stop the flow of even the most energetic electrons. For an electron with charge of magnitude $e$ moving against a potential difference $V_s$, the work done by the electric field on the electron is $e V_s$. At the stopping potential, this work must be exactly equal to the maximum kinetic energy of the photoelectrons. Thus, we have the definition:\n$$K_{max} = e V_s$$\nWe can now substitute this expression for $K_{max}$ back into our energy conservation equation:\n$$h\\nu = \\phi + e V_s$$\nThe goal is to derive a symbolic expression for the stopping potential, $V_s$. To achieve this, we rearrange the equation to isolate the term containing $V_s$:\n$$e V_s = h\\nu - \\phi$$\nFinally, dividing both sides of the equation by the elementary charge, $e$, yields the desired expression for the stopping potential:\n$$V_s = \\frac{h\\nu - \\phi}{e}$$\nThis is the simplified symbolic expression for $V_s$ in terms of the given parameters $h$, $\\nu$, $\\phi$, and $e$.", "answer": "$$\\boxed{\\frac{h\\nu - \\phi}{e}}$$", "id": "2951441"}, {"introduction": "Compton scattering provides definitive evidence that photons behave as particles with momentum, colliding with electrons in a manner analogous to billiard balls. This advanced practice takes you beyond pure theory and into the realm of computational data analysis, where you will model the scattering process and use weighted least squares to extract Planck’s constant, $h$, from simulated experimental data [@problem_id:2951509]. This exercise develops crucial skills in connecting fundamental physical principles with modern statistical inference.", "problem": "You are given synthetic Compton scattering measurements of scattered photon wavelengths from a monochromatic X-ray source after elastic scattering by free electrons at rest. Starting only from the following foundational relations and facts, derive the statistical model needed to estimate the Planck constant $h$ from the data and implement it as a program:\n\n- Planck’s relation $E = h \\nu$ and the photon momentum magnitude $p_{\\gamma} = h/\\lambda$ with $E = pc$ for a photon moving at the speed of light $c$.\n- Conservation of total energy and total linear momentum for the collision between a photon and a free electron initially at rest of rest mass $m_{e}$.\n- The Gaussian measurement model: if the instrumental resolution for a measured quantity is known and equals a standard deviation $\\sigma$, then the measurement error can be idealized as an independent normal random variable with mean $0$ and variance $\\sigma^{2}$.\n\nYour derivation must produce a linear-in-parameter relationship that allows estimation of $h$ from measurements of the scattered wavelength shift for known scattering angles. Treat the electron as free and initially at rest, and assume the incident wavelength is known with negligible uncertainty. Instrumental resolution is provided as the known standard deviation on each scattered-wavelength measurement and must be incorporated appropriately in the estimator and in the confidence interval.\n\nConstants to be used:\n- Electron rest mass $m_{e} = 9.1093837015 \\times 10^{-31}$ kg\n- Speed of light $c = 299792458$ m/s\n\nProgram requirements:\n- Use Weighted Least Squares (WLS) as the Maximum Likelihood Estimator (MLE) under the Gaussian noise model induced by instrumental resolution to estimate $h$.\n- Compute a two-sided $95$ percent confidence interval for $h$ using the exact normal-theory covariance of the WLS estimator with known heteroscedastic variances.\n- All angles must be treated in radians internally. Input angles are provided in degrees and must be converted to radians for trigonometric functions.\n- All wavelengths are provided in picometers (pm) and must be converted to meters (m) for estimating $h$, which must be returned in joule-seconds (J·s).\n- Express the final numerical results for $h$ and its lower and upper $95$ percent confidence bounds in SI units (J·s).\n\nTest Suite:\nProvide a single program that processes the following three test cases in order. Each test case consists of the incident wavelength in picometers, an array of scattering angles in degrees, an array of measured scattered wavelengths in picometers, and an array of instrumental-resolution standard deviations in picometers. Each number below is given as a decimal literal and must be used exactly as specified.\n\n- Test case A (well-conditioned angles with moderate resolutions):\n  - Incident wavelength $\\lambda_{0,\\mathrm{pm}} = $ $71.00000$\n  - Scattering angles in degrees $\\Theta_{\\mathrm{deg}} = [$ $20.0$, $45.0$, $90.0$, $120.0$, $150.0$ $]$\n  - Measured scattered wavelengths in picometers $\\Lambda'_{\\mathrm{pm}} = [$ $71.14933$, $71.71000$, $73.42781$, $74.63747$, $75.52930$ $]$\n  - Instrumental resolution standard deviations in picometers $\\Sigma_{\\mathrm{pm}} = [$ $0.0100$, $0.0100$, $0.0150$, $0.0200$, $0.0250$ $]$\n\n- Test case B (small-angle boundary conditions with larger relative resolutions):\n  - Incident wavelength $\\lambda_{0,\\mathrm{pm}} = $ $71.00000$\n  - Scattering angles in degrees $\\Theta_{\\mathrm{deg}} = [$ $0.0$, $5.0$, $10.0$, $15.0$, $20.0$ $]$\n  - Measured scattered wavelengths in picometers $\\Lambda'_{\\mathrm{pm}} = [$ $71.00000$, $71.01924$, $71.02888$, $71.08879$, $71.14210$ $]$\n  - Instrumental resolution standard deviations in picometers $\\Sigma_{\\mathrm{pm}} = [$ $0.0200$, $0.0200$, $0.0200$, $0.0200$, $0.0200$ $]$\n\n- Test case C (large-angle edge case with strongly heteroscedastic resolutions):\n  - Incident wavelength $\\lambda_{0,\\mathrm{pm}} = $ $50.00000$\n  - Scattering angles in degrees $\\Theta_{\\mathrm{deg}} = [$ $60.0$, $90.0$, $135.0$, $170.0$ $]$\n  - Measured scattered wavelengths in picometers $\\Lambda'_{\\mathrm{pm}} = [$ $51.19816$, $52.44631$, $54.14100$, $54.71440$ $]$\n  - Instrumental resolution standard deviations in picometers $\\Sigma_{\\mathrm{pm}} = [$ $0.0500$, $0.0500$, $0.0800$, $0.2000$ $]$\n\nOutput specification:\n- For each test case, compute the point estimate $\\hat{h}$ and the lower and upper bounds of the two-sided $95$ percent confidence interval $[\\hat{h}_{\\mathrm{low}}, \\hat{h}_{\\mathrm{high}}]$, all in joule-seconds.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sublist of three numbers in the order $[\\hat{h}, \\hat{h}_{\\mathrm{low}}, \\hat{h}_{\\mathrm{high}}]$. Format each floating-point number in scientific notation with exactly $10$ significant digits. For example, a valid overall output format is:\n  - $[$ $[\\hat{h}_{A}, \\hat{h}_{A,\\mathrm{low}}, \\hat{h}_{A,\\mathrm{high}}]$, $[\\hat{h}_{B}, \\hat{h}_{B,\\mathrm{low}}, \\hat{h}_{B,\\mathrm{high}}]$, $[\\hat{h}_{C}, \\hat{h}_{C,\\mathrm{low}}, \\hat{h}_{C,\\mathrm{high}}]$ $]$\n- Angles are provided in degrees and must be converted to radians for any trigonometric evaluation. Ensure the final answer for $h$ and the confidence bounds are expressed in J·s and printed in the exact required single-line format described above.", "solution": "The problem requires the derivation and implementation of a statistical estimation procedure for Planck's constant, $h$, from Compton scattering data. The process begins with a rigorous validation of the problem statement, which is found to be scientifically sound, well-posed, and complete. We proceed with the derivation of the physical model, followed by the statistical framework and computational algorithm.\n\nFirst, we derive the governing physical equation from the principles of energy and momentum conservation. An incident photon of energy $E_0 = hc/\\lambda_0$ and momentum of magnitude $p_0 = h/\\lambda_0$ collides with a free electron, assumed to be initially at rest with rest energy $E_e = m_e c^2$. After the collision, the photon is scattered at an angle $\\theta$ relative to its initial direction, with a new energy $E' = hc/\\lambda'$ and momentum magnitude $p' = h/\\lambda'$. The electron recoils with kinetic energy and momentum.\n\nThe conservation of total energy is expressed as:\n$$E_0 + m_e c^2 = E' + E'_e$$\nwhere $E'_e$ is the total energy of the scattered electron. Rearranging for $E'_e$ gives:\n$$E'_e = hc\\left(\\frac{1}{\\lambda_0} - \\frac{1}{\\lambda'}\\right) + m_e c^2 \\quad (1)$$\n\nThe conservation of total linear momentum dictates that $\\vec{p}_0 = \\vec{p}' + \\vec{p}'_e$, where $\\vec{p}'_e$ is the momentum of the scattered electron. Rearranging gives $\\vec{p}'_e = \\vec{p}_0 - \\vec{p}'$. We take the dot product of this vector with itself to find its magnitude squared:\n$$(p'_e)^2 = (\\vec{p}_0 - \\vec{p}') \\cdot (\\vec{p}_0 - \\vec{p}') = p_0^2 + (p')^2 - 2\\vec{p}_0 \\cdot \\vec{p}'$$\nSubstituting the photon momentum magnitudes, we get:\n$$(p'_e)^2 = \\left(\\frac{h}{\\lambda_0}\\right)^2 + \\left(\\frac{h}{\\lambda'}\\right)^2 - 2\\frac{h^2}{\\lambda_0 \\lambda'} \\cos\\theta \\quad (2)$$\n\nThe relativistic energy-momentum relation for the scattered electron is:\n$$(E'_e)^2 = (p'_e c)^2 + (m_e c^2)^2 \\quad (3)$$\n\nWe now substitute equations $(1)$ and $(2)$ into $(3)$:\n$$\\left[hc\\left(\\frac{1}{\\lambda_0} - \\frac{1}{\\lambda'}\\right) + m_e c^2\\right]^2 = c^2\\left[\\left(\\frac{h}{\\lambda_0}\\right)^2 + \\left(\\frac{h}{\\lambda'}\\right)^2 - 2\\frac{h^2}{\\lambda_0 \\lambda'} \\cos\\theta\\right] + (m_e c^2)^2$$\nExpanding the left-hand side and simplifying by canceling the $(m_e c^2)^2$ term yields:\n$$h^2 c^2\\left(\\frac{1}{\\lambda_0^2} - \\frac{2}{\\lambda_0\\lambda'} + \\frac{1}{(\\lambda')^2}\\right) + 2hcm_ec^2\\left(\\frac{1}{\\lambda_0} - \\frac{1}{\\lambda'}\\right) = h^2 c^2\\left(\\frac{1}{\\lambda_0^2} + \\frac{1}{(\\lambda')^2} - \\frac{2\\cos\\theta}{\\lambda_0 \\lambda'}\\right)$$\nFurther algebraic simplification leads to:\n$$-2h^2c^2\\frac{1}{\\lambda_0\\lambda'} + 2hm_ec^3\\frac{\\lambda' - \\lambda_0}{\\lambda_0\\lambda'} = -2h^2c^2\\frac{\\cos\\theta}{\\lambda_0\\lambda'}$$\nDividing by common factors and rearranging for the wavelength shift, $\\Delta\\lambda = \\lambda' - \\lambda_0$, results in the Compton scattering formula:\n$$\\lambda' - \\lambda_0 = \\frac{h}{m_e c} (1 - \\cos\\theta)$$\n\nThis equation provides the basis for our statistical model. It establishes a linear relationship between the wavelength shift and a function of the scattering angle. Let the dependent variable be $y_i = \\lambda'_i - \\lambda_0$ and the independent variable be $x_i = 1 - \\cos\\theta_i$ for each measurement $i$. The model takes the form of a linear regression through the origin:\n$$y_i = \\beta x_i$$\nwhere the slope parameter is $\\beta = \\frac{h}{m_e c}$. Our objective is to estimate $\\beta$ from the data to subsequently determine $h$.\n\nThe problem states that each measurement of the scattered wavelength, $\\lambda'_{i, \\text{meas}}$, is subject to a Gaussian error: $\\lambda'_{i, \\text{meas}} = \\lambda'_{i, \\text{true}} + \\epsilon_i$, where $\\epsilon_i \\sim N(0, \\sigma_i^2)$ and $\\sigma_i$ is the known instrumental resolution. The incident wavelength $\\lambda_0$ and scattering angles $\\theta_i$ are assumed to be known without error. Therefore, the error in the dependent variable $y_i = \\lambda'_{i, \\text{meas}} - \\lambda_0$ is entirely due to the error in $\\lambda'_i$, so $\\text{Var}(y_i) = \\sigma_i^2$. The full statistical model is:\n$$y_i = \\beta x_i + \\delta_i, \\quad \\text{where } \\delta_i \\sim N(0, \\sigma_i^2)$$\nSince the variances $\\sigma_i^2$ are not identical for all measurements, this is a heteroscedastic model.\n\nFor such a model with known variances, the Maximum Likelihood Estimator (MLE) is the Weighted Least Squares (WLS) estimator. The WLS estimator minimizes the weighted sum of squared residuals, $S(\\beta) = \\sum_i w_i (y_i - \\beta x_i)^2$, where the weights are the reciprocal of the variances, $w_i = 1/\\sigma_i^2$. Setting the derivative $\\frac{dS}{d\\beta}$ to zero and solving for $\\beta$ gives the estimator $\\hat{\\beta}$:\n$$\\hat{\\beta} = \\frac{\\sum_i w_i x_i y_i}{\\sum_i w_i x_i^2} = \\frac{\\sum_i (x_i y_i / \\sigma_i^2)}{\\sum_i (x_i^2 / \\sigma_i^2)}$$\nThe estimator for Planck's constant is then directly obtained by $\\hat{h} = \\hat{\\beta} \\cdot m_e c$.\n\nTo construct a confidence interval for $h$, we first need the variance of $\\hat{\\beta}$. As $\\hat{\\beta}$ is a linear combination of the independent Gaussian random variables $y_i$, it is also normally distributed. Its variance is:\n$$\\text{Var}(\\hat{\\beta}) = \\frac{1}{\\sum_i w_i x_i^2} = \\frac{1}{\\sum_i (x_i^2 / \\sigma_i^2)}$$\nA two-sided $95\\%$ confidence interval for $\\beta$ is given by $\\hat{\\beta} \\pm z_{0.975} \\cdot \\sqrt{\\text{Var}(\\hat{\\beta})}$, where $z_{0.975}$ is the $0.975$ quantile of the standard normal distribution (approximately $1.959964$). The confidence interval for $h$ is obtained by scaling the interval for $\\beta$ by the constant factor $m_e c$:\n$$[\\hat{h}_{\\text{low}}, \\hat{h}_{\\text{high}}] = \\left[ (\\hat{\\beta} - z_{0.975}\\sqrt{\\text{Var}(\\hat{\\beta})})m_e c, \\, (\\hat{\\beta} + z_{0.975}\\sqrt{\\text{Var}(\\hat{\\beta})})m_e c \\right]$$\nThis is equivalent to $\\hat{h} \\pm z_{0.975} \\cdot \\text{SE}(\\hat{h})$, where $\\text{SE}(\\hat{h}) = \\sqrt{\\text{Var}(\\hat{\\beta})} \\cdot m_e c$.\n\nThe implementation algorithm is as follows:\n1. Define the physical constants $m_e$ and $c$.\n2. For each test case, retrieve the input data: $\\lambda_{0,\\text{pm}}$, $\\Theta_{\\text{deg}}$, $\\Lambda'_{\\text{pm}}$, and $\\Sigma_{\\text{pm}}$.\n3. Convert all input units to SI units: wavelengths from picometers to meters ($1\\,\\text{pm} = 10^{-12}\\,\\text{m}$) and angles from degrees to radians.\n4. Compute the vectors of independent variables, $x_i = 1 - \\cos\\theta_i$, and dependent variables, $y_i = \\lambda'_i - \\lambda_0$.\n5. Compute the weights $w_i = 1/\\sigma_i^2$.\n6. Calculate the WLS estimate $\\hat{\\beta}$ using the formula derived above.\n7. Calculate the estimate for Planck's constant: $\\hat{h} = \\hat{\\beta} m_e c$.\n8. Calculate the variance of $\\hat{\\beta}$, $\\text{Var}(\\hat{\\beta})$, and from it, the margin of error for $h$.\n9. Determine the lower and upper bounds of the $95\\%$ confidence interval for $h$.\n10. Format the results, $\\hat{h}$, $\\hat{h}_{\\text{low}}$, and $\\hat{h}_{\\text{high}}$, to scientific notation with $10$ significant figures and present them in the specified list format.\nThis procedure is applied to each of the three test cases provided.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Solves for Planck's constant and its confidence interval from Compton scattering data.\n    \"\"\"\n    \n    # Define physical constants in SI units\n    m_e = 9.1093837015e-31  # Electron rest mass in kg\n    c = 299792458.0         # Speed of light in m/s\n    \n    # Define the test cases from the problem statement\n    test_cases = [\n        # Test Case A\n        {\n            \"lambda0_pm\": 71.00000,\n            \"Theta_deg\": np.array([20.0, 45.0, 90.0, 120.0, 150.0]),\n            \"Lambda_prime_pm\": np.array([71.14933, 71.71000, 73.42781, 74.63747, 75.52930]),\n            \"Sigma_pm\": np.array([0.0100, 0.0100, 0.0150, 0.0200, 0.0250])\n        },\n        # Test Case B\n        {\n            \"lambda0_pm\": 71.00000,\n            \"Theta_deg\": np.array([0.0, 5.0, 10.0, 15.0, 20.0]),\n            \"Lambda_prime_pm\": np.array([71.00000, 71.01924, 71.02888, 71.08879, 71.14210]),\n            \"Sigma_pm\": np.array([0.0200, 0.0200, 0.0200, 0.0200, 0.0200])\n        },\n        # Test Case C\n        {\n            \"lambda0_pm\": 50.00000,\n            \"Theta_deg\": np.array([60.0, 90.0, 135.0, 170.0]),\n            \"Lambda_prime_pm\": np.array([51.19816, 52.44631, 54.14100, 54.71440]),\n            \"Sigma_pm\": np.array([0.0500, 0.0500, 0.0800, 0.2000])\n        }\n    ]\n    \n    all_results = []\n    \n    # Z-value for 95% two-sided confidence interval\n    z_975 = norm.ppf(0.975)\n\n    for case in test_cases:\n        # 1. Unit Conversion (to SI units)\n        pm_to_m = 1e-12\n        lambda0_m = case[\"lambda0_pm\"] * pm_to_m\n        lambda_prime_m = case[\"Lambda_prime_pm\"] * pm_to_m\n        sigma_m = case[\"Sigma_pm\"] * pm_to_m\n        theta_rad = np.deg2rad(case[\"Theta_deg\"])\n        \n        # 2. Prepare variables for linear regression (y = beta * x)\n        # y is the wavelength shift lambda' - lambda_0\n        # x is the angular term 1 - cos(theta)\n        y = lambda_prime_m - lambda0_m\n        x = 1.0 - np.cos(theta_rad)\n        \n        # 3. Perform Weighted Least Squares (WLS) estimation for beta = h / (m_e * c)\n        # The weights are w = 1 / sigma^2\n        # Handle potential division by zero if any sigma is zero, although not expected from problem data.\n        with np.errstate(divide='raise'):\n            try:\n                w = 1.0 / (sigma_m**2)\n            except FloatingPointError:\n                # This should not happen with the given test cases.\n                # If a sigma is zero, that point has infinite weight, implying a perfect measurement.\n                # WLS logic would need to be adapted, but we follow the general formula.\n                 w = np.full_like(sigma_m, np.inf)\n\n        # WLS estimate for beta (for regression through origin)\n        # beta_hat = (sum(w*x*y)) / (sum(w*x*x))\n        sum_wxy = np.sum(w * x * y)\n        sum_wx2 = np.sum(w * x**2)\n        \n        # If sum_wx2 is zero, it means all x are zero (all angles are 0).\n        # In this scenario, the slope beta cannot be determined.\n        if sum_wx2 == 0:\n            # For test case B, the point at angle 0 contributes 0 to this sum,\n            # but other points will make it non-zero.\n            # This is a robust check.\n            h_hat, h_low, h_high = np.nan, np.nan, np.nan\n        else:\n            beta_hat = sum_wxy / sum_wx2\n            \n            # 4. Estimate Planck's constant, h\n            h_hat = beta_hat * m_e * c\n            \n            # 5. Calculate the 95% confidence interval for h\n            # Variance of beta_hat = 1 / sum(w*x*x)\n            var_beta_hat = 1.0 / sum_wx2\n            se_beta_hat = np.sqrt(var_beta_hat)\n            \n            # Margin of error for h\n            margin_of_error_h = z_975 * se_beta_hat * m_e * c\n            \n            h_low = h_hat - margin_of_error_h\n            h_high = h_hat + margin_of_error_h\n        \n        all_results.append([h_hat, h_low, h_high])\n\n    # 6. Format the output as specified\n    formatted_results = []\n    for result_set in all_results:\n        formatted_set = [f\"{val:.9e}\" for val in result_set]\n        formatted_results.append(f\"[{','.join(formatted_set)}]\")\n    \n    final_output_str = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```", "id": "2951509"}]}