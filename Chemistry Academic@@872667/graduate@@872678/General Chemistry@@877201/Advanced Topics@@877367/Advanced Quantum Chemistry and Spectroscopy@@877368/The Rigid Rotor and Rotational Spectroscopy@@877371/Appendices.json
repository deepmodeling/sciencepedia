{"hands_on_practices": [{"introduction": "This exercise simulates one of the most fundamental tasks in rotational spectroscopy: determining a molecule's rotational constant, $B$, directly from a set of measured transition frequencies. A common challenge in real experiments is that while line spacings are clear, the absolute rotational quantum number $J$ for each line might be unknown. This problem [@problem_id:2961139] guides you through a powerful technique to bypass this issue by formulating a linear model and applying the method of least squares. By completing this practice, you will develop the essential skill of extracting precise physical constants and their statistical uncertainties from raw, noisy experimental data.", "problem": "A linear, heteronuclear diatomic molecule is well described by the rigid rotor approximation in the absence of centrifugal distortion. Three consecutive rotational absorption lines corresponding to the selection rule $\\Delta J = +1$ have been recorded in wavenumbers as $26.9987\\,\\mathrm{cm}^{-1}$, $30.0021\\,\\mathrm{cm}^{-1}$, and $33.0009\\,\\mathrm{cm}^{-1}$. Assume the following:\n- Each reported line position is the true value plus an independent, identically distributed, zero-mean random error with an unknown variance (that is, homoscedastic Gaussian noise with unknown variance).\n- The three lines are consecutive in $J$, but the absolute $J$ assignments are not known a priori.\n\nStarting only from the rigid rotor energy level structure and the quantum mechanical selection rule $\\Delta J = +1$ for pure rotational spectroscopy, derive a linear model that relates the observed line positions to an integer index for consecutive lines. Using this model:\n- Construct the ordinary least squares estimator for the rotational constant $B$ (in $\\mathrm{cm}^{-1}$).\n- From the regression residuals, construct the unbiased estimator of the variance and use it to obtain the $1\\sigma$ standard uncertainty of the estimate of $B$.\n\nCompute the numerical value of $B$ and its $1\\sigma$ uncertainty using the given three lines. Round your final numerical results to four significant figures. Express $B$ and its uncertainty in $\\mathrm{cm}^{-1}$. Provide your final answer as a row matrix $\\begin{pmatrix} B  u(B) \\end{pmatrix}$, where $u(B)$ denotes the standard uncertainty of $B$.", "solution": "The problem is found to be scientifically grounded, well-posed, objective, and internally consistent. It is a standard problem in rotational spectroscopy and statistical analysis. Therefore, a full solution is provided.\n\nThe energy levels of a rigid diatomic rotor, expressed in units of wavenumber ($\\mathrm{cm}^{-1}$), are given by the formula $F(J) = B J(J+1)$, where $B$ is the rotational constant and $J$ is the rotational quantum number, which can take integer values $J=0, 1, 2, \\dots$. For rotational absorption spectroscopy of a heteronuclear diatomic molecule, the selection rule is $\\Delta J = +1$. The wavenumber, $\\bar{\\nu}$, of a transition from an initial state with quantum number $J$ to a final state with quantum number $J+1$ is the difference in their term values:\n$$ \\bar{\\nu}(J \\to J+1) = F(J+1) - F(J) = B(J+1)(J+2) - B J(J+1) $$\n$$ = B(J+1)[(J+2) - J] = 2B(J+1) $$\nHere, $J$ represents the quantum number of the lower energy state. Since $J$ can be $0, 1, 2, \\dots$, the theoretical positions of the rotational absorption lines are at $2B, 4B, 6B, \\dots$, corresponding to $J=0, 1, 2, \\dots$ respectively.\n\nThe problem states that three *consecutive* rotational lines are observed, but their absolute $J$ assignments are unknown. Let the lower state quantum number for the first of these three lines be $J_0$. Then the three consecutive transitions correspond to lower states $J_0$, $J_0+1$, and $J_0+2$.\nLet us assign an integer index $m=1, 2, 3$ to these observed lines. The lower state quantum number for the $m$-th line is then $J_0 + m - 1$. Substituting this into the transition formula gives the wavenumber of the $m$-th line, $\\bar{\\nu}_m$:\n$$ \\bar{\\nu}_m = 2B((J_0 + m - 1) + 1) = 2B(J_0 + m) $$\nThis equation can be rearranged into a linear form:\n$$ \\bar{\\nu}_m = (2B)m + 2BJ_0 $$\nThis is a linear model of the form $y_m = a x_m + c$, where the dependent variable is the line position $y_m = \\bar{\\nu}_m$, the independent variable is the integer index $x_m = m$, the slope is $a = 2B$, and the y-intercept is $c = 2BJ_0$.\n\nWe are given three data points $(x_m, y_m)$: $(1, 26.9987)$, $(2, 30.0021)$, and $(3, 33.0009)$. We will use the method of ordinary least squares (OLS) to estimate the slope $a$. The OLS estimator for the slope, $\\hat{a}$, is given by:\n$$ \\hat{a} = \\frac{\\sum_{m=1}^{n} (x_m - \\bar{x})(y_m - \\bar{y})}{\\sum_{m=1}^{n} (x_m - \\bar{x})^2} = \\frac{S_{xy}}{S_{xx}} $$\nwhere $n=3$ is the number of data points.\nThe mean values are:\n$$ \\bar{x} = \\frac{1+2+3}{3} = 2 $$\n$$ \\bar{y} = \\frac{26.9987 + 30.0021 + 33.0009}{3} = \\frac{90.0017}{3} \\approx 30.000567 $$\nThe sum of squares for $x$ is:\n$$ S_{xx} = \\sum_{m=1}^{3} (x_m - \\bar{x})^2 = (1-2)^2 + (2-2)^2 + (3-2)^2 = 1+0+1 = 2 $$\nThe sum of cross-products is:\n$$ S_{xy} = \\sum_{m=1}^{3} (x_m - \\bar{x})(y_m - \\bar{y}) = (1-2)(26.9987 - \\bar{y}) + (3-2)(33.0009 - \\bar{y}) $$\n$$ S_{xy} = -y_1 + y_3 = 33.0009 - 26.9987 = 6.0022 $$\nThe OLS estimate of the slope is:\n$$ \\hat{a} = \\frac{S_{xy}}{S_{xx}} = \\frac{6.0022}{2} = 3.0011 $$\nSince the slope $a=2B$, the estimator for the rotational constant $B$ is $\\hat{B} = \\frac{\\hat{a}}{2}$.\n$$ \\hat{B} = \\frac{3.0011}{2} = 1.50055 $$\nTo find the uncertainty of this estimate, we first need the unbiased estimator of the variance of the random errors, $\\sigma^2$. This is given by $s^2 = \\frac{\\mathrm{RSS}}{n-p}$, where $\\mathrm{RSS}$ is the residual sum of squares and $n-p$ is the number of degrees of freedom. Here, $n=3$ and we are estimating $p=2$ parameters (slope and intercept), so $n-p=1$.\n$$ s^2 = \\frac{1}{3-2} \\sum_{m=1}^{3} (y_m - \\hat{y}_m)^2 $$\nThe fitted values $\\hat{y}_m$ are given by the regression line $\\hat{y}_m = \\hat{a} x_m + \\hat{c}$, where $\\hat{c} = \\bar{y} - \\hat{a}\\bar{x}$.\n$$ \\hat{c} = \\frac{90.0017}{3} - (3.0011)(2) = 30.000566... - 6.0022 = 23.998366... $$\nThe residuals $e_m = y_m - \\hat{y}_m$ are:\n$$ e_1 = 26.9987 - (3.0011 \\times 1 + 23.998366...) = 26.9987 - 26.999466... = -0.000766... = -\\frac{2.3}{3000} $$\n$$ e_2 = 30.0021 - (3.0011 \\times 2 + 23.998366...) = 30.0021 - 30.000566... = 0.001533... = \\frac{4.6}{3000} $$\n$$ e_3 = 33.0009 - (3.0011 \\times 3 + 23.998366...) = 33.0009 - 33.001666... = -0.000766... = -\\frac{2.3}{3000} $$\nThe residual sum of squares is:\n$$ \\mathrm{RSS} = \\sum_{m=1}^{3} e_m^2 = \\left(-\\frac{2.3}{3000}\\right)^2 + \\left(\\frac{4.6}{3000}\\right)^2 + \\left(-\\frac{2.3}{3000}\\right)^2 $$\n$$ \\mathrm{RSS} = \\frac{(2.3)^2 + (4.6)^2 + (2.3)^2}{(3000)^2} = \\frac{5.29 + 21.16 + 5.29}{9 \\times 10^6} = \\frac{31.74}{9 \\times 10^6} \\approx 3.5267 \\times 10^{-6} $$\nThe unbiased variance estimate is $s^2 = \\frac{\\mathrm{RSS}}{1} = 3.5266... \\times 10^{-6}$.\nThe variance of the slope estimator $\\hat{a}$ is given by $\\mathrm{Var}(\\hat{a}) = \\frac{\\sigma^2}{S_{xx}}$. Its estimate is $s_{\\hat{a}}^2 = \\frac{s^2}{S_{xx}}$.\n$$ s_{\\hat{a}}^2 = \\frac{3.5266... \\times 10^{-6}}{2} = 1.7633... \\times 10^{-6} $$\nThe standard uncertainty of $\\hat{a}$, denoted $u(\\hat{a})$, is the square root of this value:\n$$ u(\\hat{a}) = \\sqrt{1.7633... \\times 10^{-6}} \\approx 1.3279 \\times 10^{-3} $$\nThe standard uncertainty of our estimator $\\hat{B} = \\hat{a}/2$ is given by propagation of uncertainty:\n$$ u(\\hat{B}) = u\\left(\\frac{\\hat{a}}{2}\\right) = \\frac{1}{2} u(\\hat{a}) = \\frac{1.3279 \\times 10^{-3}}{2} \\approx 0.66395 \\times 10^{-3} = 0.00066395 $$\nThe problem requires the final numerical results to be rounded to four significant figures.\nThe estimate for the rotational constant is:\n$$ B = 1.50055\\,\\mathrm{cm}^{-1} \\approx 1.501\\,\\mathrm{cm}^{-1} $$\nThe standard uncertainty for the rotational constant is:\n$$ u(B) = 0.00066395\\,\\mathrm{cm}^{-1} \\approx 0.0006640\\,\\mathrm{cm}^{-1} $$\nThe final answer is presented as a row matrix $\\begin{pmatrix} B  u(B) \\end{pmatrix}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 1.501  0.0006640 \\end{pmatrix}}\n$$", "id": "2961139"}, {"introduction": "Real molecules are not perfectly rigid; their bonds stretch under the stress of rotation. This practice [@problem_id:2961237] moves beyond the simple rigid rotor model by incorporating the first-order centrifugal distortion constant, $D$. You will use a given set of spectroscopic parameters ($B$ and $D$) to predict the frequencies of unmeasured rotational transitions, a common task in assigning a spectrum. Critically, this exercise emphasizes the correct propagation of experimental uncertainties, including the often-overlooked effects of correlation between fitted parameters, ensuring that your predictions are accompanied by a statistically meaningful error analysis.", "problem": "A linear diatomic molecule is modeled as a quantum rigid rotor with a leading centrifugal distortion correction arising from bond stretching under rotation. The rotational Hamiltonian is based on the classical angular momentum expression and its quantum mechanical eigenvalues, and the lowest-order centrifugal correction may be treated as a perturbation that is quartic in the angular momentum quantum number. A least-squares fit to a high-resolution rotational spectrum yields the rotational constant $B$ and the quartic centrifugal distortion constant $D$ in frequency units, together with their correlated standard uncertainties:\n- $B = 57.63596828\\ \\text{GHz}$ with standard uncertainty $u(B) = 5.0 \\times 10^{-6}\\ \\text{GHz}$,\n- $D = 1.83500 \\times 10^{-4}\\ \\text{GHz}$ with standard uncertainty $u(D) = 3.0 \\times 10^{-7}\\ \\text{GHz}$,\n- correlation coefficient $\\rho\\big(B,D\\big) = -0.95$.\n\nStarting from the quantized rotor energy levels implied by the rigid-rotor Hamiltonian and including the lowest-order centrifugal distortion, derive the transition frequency for a rotational transition $J \\to J-1$ in terms of $B$, $D$, and $J$. Then, using your derived expression, compute the predicted frequency for the $J = 9 \\to 8$ transition. Propagate the standard uncertainties of $B$ and $D$ (taking their correlation into account) to estimate the standard uncertainty of the predicted transition frequency.\n\nAnswer specification:\n- Express the predicted transition frequency in $\\text{GHz}$.\n- Round the predicted transition frequency to nine significant figures for the final boxed answer.\n- Also compute the standard uncertainty in $\\text{GHz}$, rounded to two significant figures, but do not include it in the final boxed answer.\n- Use radians for any angular quantities if they appear in intermediate steps.", "solution": "The problem requires the derivation of the transition frequency for a centrifugally distorted rigid rotor, followed by a numerical calculation and uncertainty propagation for a specific transition. The problem is scientifically grounded and well-posed.\n\nFirst, we establish the energy levels of the quantum system. For a diatomic molecule modeled as a rigid rotor with a first-order centrifugal distortion correction, the rotational energy levels, expressed as term values $F(J)$ in frequency units (e.g., $\\text{GHz}$), are given by the standard expression:\n$$\nF(J) = B J(J+1) - D J^2(J+1)^2\n$$\nHere, $J$ is the rotational quantum number, which can take integer values $J = 0, 1, 2, \\dots$. The parameter $B$ is the rotational constant, and $D$ is the quartic centrifugal distortion constant.\n\nThe frequency of a rotational transition, $\\nu$, from an upper state with quantum number $J$ to a lower state with quantum number $J-1$ is determined by the difference in their term values:\n$$\n\\nu(J \\to J-1) = F(J) - F(J-1)\n$$\nSubstituting the expression for $F(J)$:\n$$\n\\nu(J \\to J-1) = \\left[ B J(J+1) - D J^2(J+1)^2 \\right] - \\left[ B (J-1)((J-1)+1) - D (J-1)^2((J-1)+1)^2 \\right]\n$$\nSimplifying the terms for the state $J-1$:\n$$\n\\nu(J \\to J-1) = \\left[ B J(J+1) - D J^2(J+1)^2 \\right] - \\left[ B J(J-1) - D J^2(J-1)^2 \\right]\n$$\nWe group the terms associated with $B$ and $D$:\n$$\n\\nu(J \\to J-1) = B \\left[ J(J+1) - J(J-1) \\right] - D \\left[ J^2(J+1)^2 - J^2(J-1)^2 \\right]\n$$\nNow, we simplify the algebraic expressions in the brackets. For the term with $B$:\n$$\nJ(J+1) - J(J-1) = (J^2 + J) - (J^2 - J) = 2J\n$$\nFor the term with $D$, we can factor out $J^2$ and use the difference of squares identity, $a^2 - b^2 = (a-b)(a+b)$:\n$$\nJ^2 \\left[ (J+1)^2 - (J-1)^2 \\right] = J^2 \\left[ ((J+1) - (J-1))((J+1) + (J-1)) \\right] = J^2 \\left[ (2)(2J) \\right] = 4J^3\n$$\nSubstituting these simplified expressions back, we obtain the derived formula for the transition frequency:\n$$\n\\nu(J \\to J-1) = 2BJ - 4DJ^3\n$$\n\nNext, we calculate the predicted frequency for the specific transition $J = 9 \\to 8$. In our derived formula, $J$ represents the quantum number of the upper state, so we set $J=9$. We are given the following values:\n$B = 57.63596828\\ \\text{GHz}$\n$D = 1.83500 \\times 10^{-4}\\ \\text{GHz}$\n\nSubstituting these into the formula:\n$$\n\\nu(9 \\to 8) = 2(57.63596828)(9) - 4(1.83500 \\times 10^{-4})(9^3)\n$$\n$$\n\\nu(9 \\to 8) = 18 \\times 57.63596828 - 4 \\times (1.83500 \\times 10^{-4}) \\times 729\n$$\n$$\n\\nu(9 \\to 8) = 1037.44742904 - 0.535086\n$$\n$$\n\\nu(9 \\to 8) = 1036.91234304\\ \\text{GHz}\n$$\nThe problem requires rounding this result to nine significant figures, which gives $1036.91234 \\ \\text{GHz}$.\n\nFinally, we must propagate the uncertainties of $B$ and $D$ to find the standard uncertainty of the predicted frequency, $u(\\nu)$. The function is $\\nu(B,D) = 2JB - 4J^3D$. The general formula for the propagation of uncertainty for a function $f(x,y)$ with correlated variables is:\n$$\nu^2(f) = \\left(\\frac{\\partial f}{\\partial x}\\right)^2 u^2(x) + \\left(\\frac{\\partial f}{\\partial y}\\right)^2 u^2(y) + 2 \\left(\\frac{\\partial f}{\\partial x}\\right) \\left(\\frac{\\partial f}{\\partial y}\\right) \\rho(x,y) u(x) u(y)\n$$\nFor our function $\\nu(B,D)$, the partial derivatives are:\n$$\n\\frac{\\partial \\nu}{\\partial B} = 2J\n$$\n$$\n\\frac{\\partial \\nu}{\\partial D} = -4J^3\n$$\nThe variance of the frequency, $u^2(\\nu)$, is therefore:\n$$\nu^2(\\nu) = (2J)^2 u^2(B) + (-4J^3)^2 u^2(D) + 2(2J)(-4J^3) \\rho(B,D) u(B) u(D)\n$$\nWe substitute the given values for $J=9$:\n$u(B) = 5.0 \\times 10^{-6}\\ \\text{GHz}$\n$u(D) = 3.0 \\times 10^{-7}\\ \\text{GHz}$\n$\\rho(B,D) = -0.95$\n\nLet's calculate the terms:\nThe first term (contribution from $u(B)$):\n$$\n(2 \\times 9)^2 (5.0 \\times 10^{-6})^2 = (18)^2 (25 \\times 10^{-12}) = 324 \\times 2.5 \\times 10^{-11} = 8.1 \\times 10^{-9}\\ \\text{GHz}^2\n$$\nThe second term (contribution from $u(D)$):\n$$\n(-4 \\times 9^3)^2 (3.0 \\times 10^{-7})^2 = (-2916)^2 (9.0 \\times 10^{-14}) = 8503056 \\times 9.0 \\times 10^{-14} \\approx 7.65275 \\times 10^{-7}\\ \\text{GHz}^2\n$$\nThe third term (correlation contribution):\n$$\n2(2 \\times 9)(-4 \\times 9^3) (-0.95) (5.0 \\times 10^{-6}) (3.0 \\times 10^{-7})\n$$\n$$\n= 2(18)(-2916)(-0.95)(1.5 \\times 10^{-12})\n$$\n$$\n= (99727.2)(1.5 \\times 10^{-12}) \\approx 1.49591 \\times 10^{-7}\\ \\text{GHz}^2\n$$\nSumming the terms to get the total variance:\n$$\nu^2(\\nu) \\approx (8.1 \\times 10^{-9}) + (7.65275 \\times 10^{-7}) + (1.49591 \\times 10^{-7})\n$$\n$$\nu^2(\\nu) \\approx (0.081 \\times 10^{-7}) + (7.65275 \\times 10^{-7}) + (1.49591 \\times 10^{-7}) \\approx 9.22966 \\times 10^{-7}\\ \\text{GHz}^2\n$$\nThe standard uncertainty $u(\\nu)$ is the square root of the variance:\n$$\nu(\\nu) = \\sqrt{9.22966 \\times 10^{-7}}\\ \\text{GHz} \\approx 9.607 \\times 10^{-4}\\ \\text{GHz}\n$$\nRounding to two significant figures as requested, the standard uncertainty is $9.6 \\times 10^{-4}\\ \\text{GHz}$. This value is for contextual understanding and is not part of the final answer box. The final answer is the predicted frequency rounded to nine significant figures.", "answer": "$$\n\\boxed{1036.91234}\n$$", "id": "2961237"}, {"introduction": "A central question in scientific modeling is deciding when to add more complexity. Is a new parameter truly necessary, or are you just fitting the noise in your data? This advanced exercise [@problem_id:2961238] introduces a rigorous, quantitative framework based on the Fisher Information Matrix to answer this question for rotational spectroscopy. You will implement an information content analysis to determine whether the quality and range of your spectral data justify extending the standard model to include the sextic centrifugal distortion constant, $H_J$. This practice provides a hands-on introduction to the principles of model selection and experimental design, which are at the forefront of modern data-driven science.", "problem": "You are asked to implement an information content analysis for linear rigid-rotor rotational spectroscopy with centrifugal distortion to determine whether including the sextic centrifugal distortion parameter $H_J$ is justified by the available data, given a specified noise level and line coverage. The analysis must be carried out using fundamental definitions of rotational energy levels, a simple measurement model, and the Fisher Information Matrix (FIM).\n\nConsider a linear molecule whose rotational energy levels (expressed as wavenumbers in $\\mathrm{cm}^{-1}$) are modeled by the truncated power series in $K = J(J+1)$:\n$$\n\\frac{E(J)}{hc} = B\\,K - D_J\\,K^2 + H_J\\,K^3,\n$$\nwhere $J$ is the rotational quantum number, $B$ is the rotational constant, $D_J$ is the quartic centrifugal distortion constant, and $H_J$ is the sextic centrifugal distortion constant. A spectral line in the $R$-branch connects $J \\rightarrow J+1$, with frequency (in wavenumbers) given by the difference\n$$\n\\nu_J = \\frac{E(J+1)}{hc} - \\frac{E(J)}{hc}.\n$$\nAssume that the measured line positions $\\nu_J$ are perturbed by independent, identically distributed Gaussian noise with zero mean and known standard deviation $\\sigma_\\nu$ (in $\\mathrm{cm}^{-1}$). You must treat the unknown parameter vector as $\\boldsymbol{\\theta} = [B,\\;D_J,\\;H_J]^\\top$ and regard the line frequencies as a linear function of $\\boldsymbol{\\theta}$ through sensitivities $g_p(J) = \\partial \\nu_J / \\partial \\theta_p$.\n\nUnder the linear-Gaussian measurement model with identical variance $\\,\\sigma_\\nu^2\\,$, the Fisher Information Matrix (FIM) for $\\boldsymbol{\\theta}$ is\n$$\n\\mathbf{F} = \\frac{1}{\\sigma_\\nu^2}\\,\\mathbf{X}^\\top \\mathbf{X},\n$$\nwhere $\\mathbf{X}$ is the design matrix whose $i$-th row contains the sensitivities $[g_B(J_i),\\,g_{D_J}(J_i),\\,g_{H_J}(J_i)]$ for the observed transition $J_i \\rightarrow J_i+1$. The Cramér–Rao lower bound states that the covariance matrix of any unbiased estimator of $\\boldsymbol{\\theta}$ satisfies\n$$\n\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}}) \\succeq \\mathbf{F}^{-1} = \\sigma_\\nu^2 \\,(\\mathbf{X}^\\top \\mathbf{X})^{-1}.\n$$\nDefine the one-standard-deviation uncertainty for $H_J$ as\n$$\n\\sigma(H_J) = \\sqrt{\\left[\\sigma_\\nu^2 \\,(\\mathbf{X}^\\top \\mathbf{X})^{-1}\\right]_{3,3}}.\n$$\nLet the maximum absolute sensitivity of any measured line to $H_J$ be\n$$\nS_{\\max} = \\max_i \\left|g_{H_J}(J_i)\\right|.\n$$\nLet $\\tau$ (in $\\mathrm{cm}^{-1}$) be a user-specified prediction tolerance for line positions. We will say that including $H_J$ is justified by the information content of the data if and only if the following inequality holds:\n$$\n\\sigma(H_J)\\,S_{\\max} \\le \\tau.\n$$\nThis criterion encodes that, if $H_J$ is included and estimated from the data, then the contribution of its one-standard-deviation uncertainty to the worst-case predicted line position does not exceed the required prediction tolerance.\n\nYour task is to write a complete, runnable program that:\n- Constructs the design matrix $\\mathbf{X}$ for a given set of $J$ values by explicitly deriving and using $g_B(J)$, $g_{D_J}(J)$, and $g_{H_J}(J)$ from the energy level definition.\n- Computes $\\sigma(H_J)$ using the Cramér–Rao bound based on $\\mathbf{X}$ and $\\sigma_\\nu$.\n- Evaluates the decision rule $\\sigma(H_J)\\,S_{\\max} \\le \\tau$ to return a boolean decision for each test case.\n- Handles rank-deficient or ill-conditioned cases robustly. If $\\mathbf{X}^\\top \\mathbf{X}$ is rank deficient (i.e., has rank less than $3$), treat the decision as false. If needed, use the Moore–Penrose pseudoinverse to compute a stable approximation to $(\\mathbf{X}^\\top \\mathbf{X})^{-1}$.\n\nUse the following test suite. For each case, the program must internally generate the list of $J$ values and then return a single boolean indicating whether including $H_J$ is justified.\n\n- Test case $1$: $J \\in \\{0,1,2,\\dots,30\\}$, $\\sigma_\\nu = 1.0\\times 10^{-5}\\,\\mathrm{cm}^{-1}$, $\\tau = 1.0\\times 10^{-4}\\,\\mathrm{cm}^{-1}$.\n- Test case $2$: $J \\in \\{0,1,2,\\dots,10\\}$, $\\sigma_\\nu = 5.0\\times 10^{-5}\\,\\mathrm{cm}^{-1}$, $\\tau = 1.0\\times 10^{-4}\\,\\mathrm{cm}^{-1}$.\n- Test case $3$: $J \\in \\{0,1,2,3,4,5\\}$, $\\sigma_\\nu = 1.0\\times 10^{-4}\\,\\mathrm{cm}^{-1}$, $\\tau = 1.0\\times 10^{-4}\\,\\mathrm{cm}^{-1}$.\n- Test case $4$: $J \\in \\{0\\}$, $\\sigma_\\nu = 1.0\\times 10^{-5}\\,\\mathrm{cm}^{-1}$, $\\tau = 1.0\\times 10^{-5}\\,\\mathrm{cm}^{-1}$.\n- Test case $5$: $J \\in \\{0,5,10,20,40,60\\}$, $\\sigma_\\nu = 2.0\\times 10^{-5}\\,\\mathrm{cm}^{-1}$, $\\tau = 5.0\\times 10^{-5}\\,\\mathrm{cm}^{-1}$.\n\nAngle units are not applicable. All physical quantities must be treated and reported in $\\mathrm{cm}^{-1}$ as specified.\n\nFinal output format: Your program should produce a single line of output containing the boolean decisions for the test cases as a comma-separated list enclosed in square brackets (for example, \"[True,False,True,True,False]\").", "solution": "The problem requires an information content analysis to decide whether the inclusion of the sextic centrifugal distortion constant, $H_J$, in the model for rotational energy levels is justified by a given set of spectroscopic measurements. The decision is based on a criterion involving the statistical uncertainty of the estimated parameter $H_J$ and its maximum influence on the predicted transition frequencies. The verdict is derived from the Fisher Information Matrix (FIM), which quantifies the information content of the data.\n\nThe procedure is as follows: first, we derive the analytical expressions for the sensitivities of the observable transition frequencies to the model parameters. Second, we construct the FIM based on these sensitivities and the given measurement noise. Finally, we use the FIM to calculate the parameter uncertainty and apply the specified decision rule.\n\n**Step 1: Derivation of Sensitivity Coefficients**\n\nThe rotational energy levels, expressed in wavenumbers ($\\mathrm{cm}^{-1}$), are given by the model:\n$$\n\\tilde{E}(J) = \\frac{E(J)}{hc} = B K - D_J K^2 + H_J K^3\n$$\nwhere $K$ is a shorthand for $J(J+1)$. The parameter vector is $\\boldsymbol{\\theta} = [B, D_J, H_J]^\\top$.\n\nThe frequency of an $R$-branch transition ($J \\to J+1$) is the difference in energy levels:\n$$\n\\nu_J = \\tilde{E}(J+1) - \\tilde{E}(J)\n$$\nLet us define $K' = K(J+1) = (J+1)(J+2)$. We can then write $\\nu_J$ as:\n$$\n\\nu_J = (B K' - D_J (K')^2 + H_J (K')^3) - (B K - D_J K^2 + H_J K^3)\n$$\nRearranging terms to group by the parameters reveals that the model is linear in its parameters:\n$$\n\\nu_J = B(K' - K) - D_J((K')^2 - K^2) + H_J((K')^3 - K^3)\n$$\nThe sensitivity functions, $g_p(J) = \\partial \\nu_J / \\partial \\theta_p$, are the coefficients of these parameters.\n\nThe coefficient for $B$, the rotational constant, is:\n$$\ng_B(J) = \\frac{\\partial \\nu_J}{\\partial B} = K' - K = (J+1)(J+2) - J(J+1) = (J+1)(J+2-J) = 2(J+1)\n$$\n\nThe coefficient for $D_J$, the quartic centrifugal distortion constant, is:\n$$\ng_{D_J}(J) = \\frac{\\partial \\nu_J}{\\partial D_J} = -((K')^2 - K^2) = -(K' - K)(K' + K)\n$$\nWe have already found $K'-K = 2(J+1)$. The sum is:\n$$\nK'+K = (J+1)(J+2) + J(J+1) = (J+1)(J+2+J) = (J+1)(2J+2) = 2(J+1)^2\n$$\nTherefore, the sensitivity to $D_J$ is:\n$$\ng_{D_J}(J) = -[2(J+1)] \\cdot [2(J+1)^2] = -4(J+1)^3\n$$\n\nThe coefficient for $H_J$, the sextic centrifugal distortion constant, is:\n$$\ng_{H_J}(J) = \\frac{\\partial \\nu_J}{\\partial H_J} = (K')^3 - K^3 = (K' - K)((K')^2 + K'K + K^2)\n$$\nSubstituting the expressions for $K$ and $K'$:\n$$\ng_{H_J}(J) = 2(J+1) \\left[ ((J+1)(J+2))^2 + (J+1)(J+2)J(J+1) + (J(J+1))^2 \\right]\n$$\n$$\ng_{H_J}(J) = 2(J+1)(J+1)^2 \\left[ (J+2)^2 + J(J+2) + J^2 \\right]\n$$\n$$\ng_{H_J}(J) = 2(J+1)^3 \\left[ (J^2+4J+4) + (J^2+2J) + J^2 \\right]\n$$\n$$\ng_{H_J}(J) = 2(J+1)^3 (3J^2 + 6J + 4)\n$$\nThese three sensitivity functions $g_B(J)$, $g_{D_J}(J)$, and $g_{H_J}(J)$ form the basis for the subsequent analysis.\n\n**Step 2: Construction of the Design and Information Matrices**\n\nFor a set of $m$ observed transitions corresponding to quantum numbers $\\{J_1, J_2, \\dots, J_m\\}$, we form the $m \\times 3$ design matrix $\\mathbf{X}$, where the $i$-th row is the sensitivity vector for the $i$-th measurement:\n$$\n\\mathbf{X}_{i,:} = [g_B(J_i), g_{D_J}(J_i), g_{H_J}(J_i)]\n$$\nThe problem states that the Fisher Information Matrix $\\mathbf{F}$ is given by $\\mathbf{F} = \\frac{1}{\\sigma_\\nu^2}\\,\\mathbf{X}^\\top \\mathbf{X}$. We define the unscaled matrix $\\mathbf{S} = \\mathbf{X}^\\top \\mathbf{X}$, which is a $3 \\times 3$ symmetric matrix.\n\n**Step 3: Uncertainty Calculation**\n\nThe Cramér-Rao Lower Bound (CRLB) provides a lower limit on the variance of any unbiased estimator. The covariance matrix of the estimated parameters $\\hat{\\boldsymbol{\\theta}}$ is bounded by the inverse of the FIM:\n$$\n\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}}) \\succeq \\mathbf{F}^{-1} = \\sigma_\\nu^2 (\\mathbf{X}^\\top \\mathbf{X})^{-1} = \\sigma_\\nu^2 \\mathbf{S}^{-1}\n$$\nThe one-standard-deviation uncertainty in the parameter $H_J$ is the square root of the corresponding diagonal element of this covariance matrix. As $H_J$ is the third element of $\\boldsymbol{\\theta}$, we require the element at index $(3,3)$ of the matrix:\n$$\n\\sigma(H_J) = \\sqrt{[\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}})]_{3,3}} = \\sqrt{\\sigma_\\nu^2 [\\mathbf{S}^{-1}]_{3,3}} = \\sigma_\\nu \\sqrt{[\\mathbf{S}^{-1}]_{3,3}}\n$$\nA critical prerequisite is that the matrix $\\mathbf{S}$ must be invertible, meaning it must have full rank (rank $3$). If the rank of $\\mathbf{S}$ is less than $3$, the parameters are not all independently determinable from the data. In this situation, as specified, the inclusion of $H_J$ is deemed unjustified. This occurs if fewer than $3$ distinct transitions are measured. To handle nearly singular cases robustly, the Moore-Penrose pseudoinverse, $\\mathbf{S}^{+}$, is used in place of the standard inverse.\n\n**Step 4: Application of the Decision Rule**\n\nThe decision to include $H_J$ is predicated on whether its contribution to uncertainty in predicted line positions is acceptable. The criterion is:\n$$\n\\sigma(H_J) \\, S_{\\max} \\le \\tau\n$$\nwhere $\\tau$ is a specified prediction tolerance and $S_{\\max}$ is the maximum absolute sensitivity of any measured line to the parameter $H_J$:\n$$\nS_{\\max} = \\max_{i} |g_{H_J}(J_i)|\n$$\nThis criterion compares the worst-case prediction uncertainty arising from $\\sigma(H_J)$ against the tolerance $\\tau$. If the inequality holds, the data are deemed to contain sufficient information to constrain $H_J$ meaningfully, and its inclusion is justified (result is `True`). Otherwise, it is not (result is `False`).\n\nThe implemented algorithm for each test case is thus:\n$1$. Generate the list of $J$ values for the case.\n$2$. Construct the design matrix $\\mathbf{X}$ by computing the sensitivities $g_B(J)$, $g_{D_J}(J)$, and $g_{H_J}(J)$ for each $J$.\n$3$. Compute $\\mathbf{S} = \\mathbf{X}^\\top \\mathbf{X}$.\n$4$. If the rank of $\\mathbf{S}$ is less than $3$, the decision is `False`.\n$5$. If the rank is $3$, compute $\\mathbf{S}^{-1}$, using the numerically stable pseudoinverse.\n$6$. Extract the third diagonal element, $[\\mathbf{S}^{-1}]_{3,3}$.\n$7$. Calculate $\\sigma(H_J) = \\sigma_\\nu \\sqrt{[\\mathbf{S}^{-1}]_{3,3}}$.\n$8$. Calculate $S_{\\max}$ by finding $\\max |g_{H_J}(J)|$ over the given $J$ values.\n$9$. Evaluate the boolean expression $\\sigma(H_J) \\cdot S_{\\max} \\le \\tau$, which determines the final result for the case.", "answer": "```python\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Performs an information content analysis for linear rigid-rotor rotational\n    spectroscopy to decide if including the H_J parameter is justified.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'J_values': list(range(31)), 'sigma_nu': 1.0e-5, 'tau': 1.0e-4},\n        {'J_values': list(range(11)), 'sigma_nu': 5.0e-5, 'tau': 1.0e-4},\n        {'J_values': list(range(6)), 'sigma_nu': 1.0e-4, 'tau': 1.0e-4},\n        {'J_values': [0], 'sigma_nu': 1.0e-5, 'tau': 1.0e-5},\n        {'J_values': [0, 5, 10, 20, 40, 60], 'sigma_nu': 2.0e-5, 'tau': 5.0e-5}\n    ]\n\n    results = []\n\n    # Define sensitivity functions based on the derived analytical expressions.\n    # J must be treated as a float to avoid potential overflow with large J values.\n    def g_B(J_arr):\n        \"\"\"Sensitivity of transition frequency to rotational constant B.\"\"\"\n        return 2.0 * (J_arr + 1.0)\n    \n    def g_DJ(J_arr):\n        \"\"\"Sensitivity of transition frequency to quartic distortion constant D_J.\"\"\"\n        return -4.0 * (J_arr + 1.0)**3\n    \n    def g_HJ(J_arr):\n        \"\"\"Sensitivity of transition frequency to sextic distortion constant H_J.\"\"\"\n        return 2.0 * (J_arr + 1.0)**3 * (3.0 * J_arr**2 + 6.0 * J_arr + 4.0)\n        \n    for case in test_cases:\n        J_values = np.array(case['J_values'], dtype=float)\n        sigma_nu = case['sigma_nu']\n        tau = case['tau']\n        \n        # The number of parameters to estimate is 3 (B, D_J, H_J).\n        # We need at least 3 independent measurements to determine them.\n        # If fewer than 3 J values are provided, the problem is underdetermined.\n        if len(J_values)  3:\n            results.append(False)\n            continue\n            \n        # Construct the design matrix X, where each row is a sensitivity vector\n        # for a given J value.\n        X = np.vstack([g_B(J_values), g_DJ(J_values), g_HJ(J_values)]).T\n        \n        # Compute the unscaled information matrix S = X^T * X\n        S = X.T @ X\n        \n        # If S is rank-deficient ( 3), parameters are not independently\n        # determinable. Thus, including H_J is not justified.\n        if np.linalg.matrix_rank(S)  3:\n            results.append(False)\n            continue\n            \n        # Use pseudoinverse for robust inversion of S, as per problem spec.\n        try:\n            S_inv = linalg.pinv(S)\n        except np.linalg.LinAlgError:\n            # This case should be caught by rank check, but as a safeguard.\n            results.append(False)\n            continue\n            \n        # The variance for H_J is related to the 3rd diagonal element (index 2)\n        # of the inverse Fisher matrix.\n        # var(H_J) = sigma_nu^2 * (S^-1)_33\n        S_inv_33 = S_inv[2, 2]\n        \n        # Calculate the standard deviation (uncertainty) for H_J.\n        sigma_HJ = sigma_nu * np.sqrt(S_inv_33)\n        \n        # Calculate the maximum absolute sensitivity to H_J over the data set.\n        S_max = np.max(np.abs(g_HJ(J_values)))\n        \n        # Apply the decision rule: sigma(H_J) * S_max = tau\n        is_justified = (sigma_HJ * S_max) = tau\n        results.append(is_justified)\n\n    # Format the final output as a comma-separated list of booleans in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2961238"}]}