{"hands_on_practices": [{"introduction": "Moving from theoretical principles to benchtop practice requires mastering the nuances of real-world materials. This exercise [@problem_id:2949821] tackles two common complexities in synthetic chemistry: handling a reagent supplied as a solution of known concentration and density, and isolating a product as a hydrate. By working through the calculation, you will reinforce the foundational skill of identifying the limiting reagent and learn how to accurately determine the actual yield of your target compound on an anhydrous basis, a critical step for reporting reliable and reproducible results.", "problem": "A batch of crystalline copper(II) sulfate pentahydrate, written as $ \\text{CuSO}_{4}\\cdot 5\\text{H}_{2}\\text{O} $, is prepared by reacting copper(II) oxide $ \\text{CuO} $ with aqueous sulfuric acid $ \\text{H}_{2}\\text{SO}_{4} $ according to the stoichiometric transformation $ \\text{CuO} + \\text{H}_{2}\\text{SO}_{4} \\rightarrow \\text{CuSO}_{4} + \\text{H}_{2}\\text{O} $. The acid is supplied as a stock solution of known molarity $ M $ and density $ \\rho $. A mass of $ 8.500\\,\\text{g} $ of $ \\text{CuO} $ is combined with $ 45.00\\,\\text{g} $ of the $ \\text{H}_{2}\\text{SO}_{4} $ stock solution that is $ 3.000\\,\\text{mol}\\,\\text{L}^{-1} $ and has density $ 1.180\\,\\text{g}\\,\\text{mL}^{-1} $. After complete reaction and crystallization from water, $ 24.850\\,\\text{g} $ of $ \\text{CuSO}_{4}\\cdot 5\\text{H}_{2}\\text{O} $ is isolated. Use the following molar masses: $ M(\\text{CuO}) = 79.545\\,\\text{g}\\,\\text{mol}^{-1} $, $ M(\\text{CuSO}_{4}) = 159.607\\,\\text{g}\\,\\text{mol}^{-1} $, $ M(\\text{H}_{2}\\text{O}) = 18.015\\,\\text{g}\\,\\text{mol}^{-1} $, and $ M(\\text{CuSO}_{4}\\cdot 5\\text{H}_{2}\\text{O}) = 249.682\\,\\text{g}\\,\\text{mol}^{-1} $. \n\nStarting only from core definitions, determine the reaction efficiency (fractional yield) for $ \\text{CuSO}_{4} $ on an anhydrous basis, making the appropriate adjustments for (i) the reagent supplied as a solution of known molarity $ M $ and density $ \\rho $ and (ii) the fact that the isolated product is the pentahydrate $ \\text{CuSO}_{4}\\cdot 5\\text{H}_{2}\\text{O} $. Express your final reaction efficiency as a decimal (fraction of unity), and round your answer to four significant figures. Do not include any units in your final numeric answer.", "solution": "The problem requires the calculation of the reaction efficiency, also known as fractional yield, for the synthesis of copper(II) sulfate. The reaction efficiency, denoted by $\\eta$, is defined as the ratio of the actual yield to the theoretical yield.\n\n$$\n\\eta = \\frac{\\text{Actual Yield}}{\\text{Theoretical Yield}}\n$$\n\nBoth the actual and theoretical yields must be expressed in the same units, typically moles or mass. It is most direct to work with moles.\n\nThe first step is to determine the amount of each reactant in moles. The balanced chemical equation is given as:\n$$\n\\text{CuO} + \\text{H}_{2}\\text{SO}_{4} \\rightarrow \\text{CuSO}_{4} + \\text{H}_{2}\\text{O}\n$$\nThis indicates a $1:1$ stoichiometric molar ratio between the reactants, copper(II) oxide ($\\text{CuO}$) and sulfuric acid ($\\text{H}_{2}\\text{SO}_{4}$).\n\nThe mass of $\\text{CuO}$ is given as $m_{\\text{CuO}} = 8.500\\,\\text{g}$. The molar mass of $\\text{CuO}$ is $M(\\text{CuO}) = 79.545\\,\\text{g}\\,\\text{mol}^{-1}$. The number of moles of $\\text{CuO}$, $n_{\\text{CuO}}$, is calculated as:\n$$\nn_{\\text{CuO}} = \\frac{m_{\\text{CuO}}}{M(\\text{CuO})} = \\frac{8.500\\,\\text{g}}{79.545\\,\\text{g}\\,\\text{mol}^{-1}} \\approx 0.106859\\,\\text{mol}\n$$\n\nNext, we must determine the number of moles of sulfuric acid, $n_{\\text{H}_2\\text{SO}_4}$. We are given the mass of the aqueous solution, $m_{\\text{sol}} = 45.00\\,\\text{g}$, its density, $\\rho_{\\text{sol}} = 1.180\\,\\text{g}\\,\\text{mL}^{-1}$, and its molarity, $M_{\\text{H}_2\\text{SO}_4} = 3.000\\,\\text{mol}\\,\\text{L}^{-1}$. First, we calculate the volume of the solution, $V_{\\text{sol}}$, from its mass and density. We must ensure consistent units.\n$$\n\\rho_{\\text{sol}} = 1.180\\,\\frac{\\text{g}}{\\text{mL}} = 1.180\\,\\frac{\\text{g}}{\\text{mL}} \\times \\frac{1000\\,\\text{mL}}{1\\,\\text{L}} = 1180\\,\\text{g}\\,\\text{L}^{-1}\n$$\n$$\nV_{\\text{sol}} = \\frac{m_{\\text{sol}}}{\\rho_{\\text{sol}}} = \\frac{45.00\\,\\text{g}}{1180\\,\\text{g}\\,\\text{L}^{-1}} \\approx 0.0381356\\,\\text{L}\n$$\nNow, using the molarity, we find the moles of $\\text{H}_2\\text{SO}_4$:\n$$\nn_{\\text{H}_2\\text{SO}_4} = M_{\\text{H}_2\\text{SO}_4} \\times V_{\\text{sol}} = 3.000\\,\\text{mol}\\,\\text{L}^{-1} \\times \\left( \\frac{45.00}{1180} \\right)\\,\\text{L} \\approx 0.114407\\,\\text{mol}\n$$\n\nThe second step is to identify the limiting reagent. We compare the moles of reactants based on the stoichiometry of the reaction. Since the molar ratio is $1:1$, we simply compare the number of moles.\n$$\nn_{\\text{CuO}} \\approx 0.106859\\,\\text{mol}\n$$\n$$\nn_{\\text{H}_2\\text{SO}_4} \\approx 0.114407\\,\\text{mol}\n$$\nBecause $n_{\\text{CuO}}  n_{\\text{H}_2\\text{SO}_4}$, copper(II) oxide is the limiting reagent. The reaction will cease once all the $\\text{CuO}$ is consumed.\n\nThe third step is to calculate the theoretical yield of anhydrous copper(II) sulfate, $\\text{CuSO}_{4}$. The theoretical yield is the maximum amount of product that can be formed, and it is determined by the amount of the limiting reagent. According to the stoichiometry, one mole of $\\text{CuO}$ produces one mole of $\\text{CuSO}_{4}$. Therefore, the theoretical yield in moles, $n_{\\text{CuSO}_4, \\text{theo}}$, is equal to the moles of the limiting reagent.\n$$\nn_{\\text{CuSO}_4, \\text{theo}} = n_{\\text{CuO}} = \\frac{8.500}{79.545}\\,\\text{mol} \\approx 0.106859\\,\\text{mol}\n$$\n\nThe fourth step is to determine the actual yield of anhydrous $\\text{CuSO}_{4}$. The problem states that the isolated product is the pentahydrate, $\\text{CuSO}_{4}\\cdot 5\\text{H}_{2}\\text{O}$, with a mass of $m_{\\text{actual}} = 24.850\\,\\text{g}$. The molar mass of the pentahydrate is given as $M(\\text{CuSO}_{4}\\cdot 5\\text{H}_{2}\\text{O}) = 249.682\\,\\text{g}\\,\\text{mol}^{-1}$. We first calculate the moles of the hydrated salt obtained.\n$$\nn_{\\text{hydrate, actual}} = \\frac{m_{\\text{actual}}}{M(\\text{CuSO}_{4}\\cdot 5\\text{H}_{2}\\text{O})} = \\frac{24.850\\,\\text{g}}{249.682\\,\\text{g}\\,\\text{mol}^{-1}} \\approx 0.099527\\,\\text{mol}\n$$\nBy definition, each mole of $\\text{CuSO}_{4}\\cdot 5\\text{H}_{2}\\text{O}$ contains one mole of anhydrous $\\text{CuSO}_{4}$. Thus, the actual molar yield of anhydrous $\\text{CuSO}_{4}$, $n_{\\text{CuSO}_4, \\text{actual}}$, is equal to the moles of the hydrated salt isolated.\n$$\nn_{\\text{CuSO}_4, \\text{actual}} = n_{\\text{hydrate, actual}} \\approx 0.099527\\,\\text{mol}\n$$\n\nThe final step is to calculate the reaction efficiency, $\\eta$, by dividing the actual yield by the theoretical yield.\n$$\n\\eta = \\frac{n_{\\text{CuSO}_4, \\text{actual}}}{n_{\\text{CuSO}_4, \\text{theo}}} = \\frac{\\frac{24.850}{249.682}}{\\frac{8.500}{79.545}} = \\frac{0.09952659...}{0.10685903...} \\approx 0.931383\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\eta \\approx 0.9314\n$$\nThis is the fractional yield, or reaction efficiency, on an anhydrous basis.", "answer": "$$\\boxed{0.9314}$$", "id": "2949821"}, {"introduction": "Modern synthetic chemistry relies on powerful analytical techniques to rapidly and accurately assess reaction outcomes. This practice introduces the use of quantitative proton nuclear magnetic resonance ($^{1}$H qNMR) spectroscopy, a premier method for determining the yield of a reaction without the need for product isolation and purification [@problem_id:2949813]. You will learn how to use an internal standard of known concentration to quantify the amount of product formed, correcting for instrumental response factors to achieve high precision. This skill is indispensable for high-throughput screening, reaction optimization, and situations where the product is difficult to isolate.", "problem": "A unimolecular cyclization converts a limiting substrate $\\mathrm{A}$ to a single organic product $\\mathrm{P}$ with one-to-one stoichiometry. After quenching and workup, the entire crude material is transferred quantitatively into an NMR tube. An accurately weighed internal standard, dimethyl sulfone, is added to the same tube. A proton quantitative nuclear magnetic resonance (qNMR) spectrum is acquired under conditions where receiver gain, pulse angle, temperature, and acquisition parameters are identical for all resonances; however, the relaxation delay is finite, so resonance-dependent response factors must be applied. Assume baseline correction is ideal, no signals overlap, and there are no other species contributing to the resonances specified below.\n\nThe following are known or measured:\n- Initial moles of $\\mathrm{A}$ charged to the reaction (and limiting): $0.500\\,\\mathrm{mmol}$.\n- Moles of internal standard in the NMR tube: $0.200\\,\\mathrm{mmol}$.\n- The product $\\mathrm{P}$ shows an isolated methyl singlet that arises from $3$ equivalent protons.\n- The internal standard shows an isolated singlet that arises from $6$ equivalent protons.\n- The integrated areas (arbitrary units) of these isolated resonances are $I_{\\mathrm{P}} = 180.0$ for the product methyl singlet and $I_{\\mathrm{IS}} = 200.0$ for the internal standard singlet.\n- The resonance-dependent response factors (dimensionless) for these two resonances, determined independently under the same acquisition conditions, are $r_{\\mathrm{P}} = 0.950$ and $r_{\\mathrm{IS}} = 1.000$.\n\nStarting from first principles—namely, that in proton qNMR the integrated area of a non-overlapping resonance is proportional to the number of absorbing nuclei for that resonance multiplied by the number of moles of the corresponding species, with a resonance-dependent response factor—derive an expression to obtain the moles of $\\mathrm{P}$ present in the tube from the data above. Then use it to compute the reaction’s percent yield as a decimal fraction, defined as the ratio of actual moles of $\\mathrm{P}$ to the theoretical moles of $\\mathrm{P}$ implied by the one-to-one stoichiometry with $\\mathrm{A}$. Express the final yield as a decimal number with no percent sign, and round your final answer to four significant figures.", "solution": "The fundamental starting point for proton quantitative nuclear magnetic resonance (qNMR) is that the integrated area $I_{i}$ of a non-overlapping resonance $i$ is proportional to the total number of absorbing spins contributing to that resonance in the active detection volume. For a molecular species $j$ with a resonance $i$ arising from $n_{H,i}$ equivalent protons per molecule, present in amount $n_{j}$ (in moles), one can write\n$$\nI_{i} = \\kappa\\, r_{i}\\, n_{H,i}\\, n_{j},\n$$\nwhere $\\kappa$ is an instrument/sample constant common to all resonances acquired under identical conditions, and $r_{i}$ is a dimensionless response factor that accounts for deviations from ideal behavior (for example, incomplete relaxation due to finite relaxation delay, pulse imperfections, or frequency-dependent sensitivity).\n\nConsider two resonances acquired in the same experiment: one resonance from the product $\\mathrm{P}$ and one from the internal standard $\\mathrm{IS}$. Denote their integrated areas by $I_{\\mathrm{P}}$ and $I_{\\mathrm{IS}}$, their response factors by $r_{\\mathrm{P}}$ and $r_{\\mathrm{IS}}$, and the numbers of equivalent protons contributing to each resonance by $n_{H,\\mathrm{P}}$ and $n_{H,\\mathrm{IS}}$, respectively. The number of moles of each species in the tube are $n_{\\mathrm{P}}$ and $n_{\\mathrm{IS}}$. Then\n$$\nI_{\\mathrm{P}} = \\kappa\\, r_{\\mathrm{P}}\\, n_{H,\\mathrm{P}}\\, n_{\\mathrm{P}}, \\qquad\nI_{\\mathrm{IS}} = \\kappa\\, r_{\\mathrm{IS}}\\, n_{H,\\mathrm{IS}}\\, n_{\\mathrm{IS}}.\n$$\nTaking the ratio eliminates the common constant $\\kappa$:\n$$\n\\frac{I_{\\mathrm{P}}}{I_{\\mathrm{IS}}} = \\frac{r_{\\mathrm{P}}\\, n_{H,\\mathrm{P}}\\, n_{\\mathrm{P}}}{r_{\\mathrm{IS}}\\, n_{H,\\mathrm{IS}}\\, n_{\\mathrm{IS}}}.\n$$\nSolving this relation for $n_{\\mathrm{P}}$ in terms of known or measured quantities gives\n$$\nn_{\\mathrm{P}} = n_{\\mathrm{IS}} \\,\\frac{I_{\\mathrm{P}}}{I_{\\mathrm{IS}}}\\,\\frac{r_{\\mathrm{IS}}}{r_{\\mathrm{P}}}\\,\\frac{n_{H,\\mathrm{IS}}}{n_{H,\\mathrm{P}}}.\n$$\n\nWe are given:\n- $n_{\\mathrm{IS}} = 0.200\\,\\mathrm{mmol} = 0.000200\\,\\mathrm{mol}$,\n- $I_{\\mathrm{P}} = 180.0$,\n- $I_{\\mathrm{IS}} = 200.0$,\n- $r_{\\mathrm{IS}} = 1.000$,\n- $r_{\\mathrm{P}} = 0.950$,\n- $n_{H,\\mathrm{IS}} = 6$ (internal standard singlet),\n- $n_{H,\\mathrm{P}} = 3$ (product methyl singlet).\n\nInsert these values:\n$$\nn_{\\mathrm{P}} = \\left(0.000200\\right)\\,\\frac{180.0}{200.0}\\,\\frac{1.000}{0.950}\\,\\frac{6}{3}.\n$$\nCompute stepwise. First, the area ratio:\n$$\n\\frac{I_{\\mathrm{P}}}{I_{\\mathrm{IS}}} = \\frac{180.0}{200.0} = 0.900.\n$$\nNext, the response factor ratio:\n$$\n\\frac{r_{\\mathrm{IS}}}{r_{\\mathrm{P}}} = \\frac{1.000}{0.950} \\approx 1.0526315789.\n$$\nNext, the proton-count ratio:\n$$\n\\frac{n_{H,\\mathrm{IS}}}{n_{H,\\mathrm{P}}} = \\frac{6}{3} = 2.\n$$\nMultiply these factors:\n$$\n0.900 \\times 1.0526315789 \\times 2 = 1.8947368421.\n$$\nTherefore,\n$$\nn_{\\mathrm{P}} = 0.000200 \\times 1.8947368421 = 0.0003789473684\\,\\text{mol}.\n$$\n\nThe reaction is one-to-one in moles between $\\mathrm{A}$ and $\\mathrm{P}$, so the theoretical moles of product are equal to the initial moles of $\\mathrm{A}$:\n$$\nn_{\\mathrm{theor}} = n_{\\mathrm{A},0} = 0.500\\,\\mathrm{mmol} = 0.000500\\,\\mathrm{mol}.\n$$\nThe percent yield, expressed as a decimal fraction (actual over theoretical), is\n$$\nY = \\frac{n_{\\mathrm{P}}}{n_{\\mathrm{theor}}} = \\frac{0.0003789473684}{0.000500} = 0.7578947368.\n$$\nRounded to four significant figures as requested:\n$$\nY = 0.7579.\n$$\nThis is the final decimal fraction for the reaction yield, with no percent sign.", "answer": "$$\\boxed{0.7579}$$", "id": "2949813"}, {"introduction": "Beyond simply measuring a final yield, a deeper understanding of reaction efficiency involves analyzing the kinetic factors that govern it. This computational exercise [@problem_id:2949897] delves into the dynamics of a system with competing reactions, a frequent scenario in complex organic synthesis. By numerically solving the kinetic rate equations and performing a sensitivity analysis, you will identify which parameters—such as temperature, rate constants, or reactant ratios—have the most significant impact on the final yield of the desired product. This approach is fundamental to process chemistry and reaction engineering, enabling the rational optimization of reaction conditions to maximize efficiency and minimize waste.", "problem": "A well-mixed, constant-volume, isothermal batch reactor contains species $A$ and $B$ reacting via a desired bimolecular reaction and a competing unimolecular side reaction. The desired reaction is $A + B \\rightarrow D$, and the undesired side reaction is $A \\rightarrow U$. Assume mass-action kinetics, Arrhenius temperature dependence for the rate constants, and negligible volume change. The kinetic model is\n- $\\dfrac{dC_{A}}{dt} = -k_{1}(T) C_{A} C_{B} - k_{2}(T) C_{A}$,\n- $\\dfrac{dC_{B}}{dt} = -k_{1}(T) C_{A} C_{B}$,\n- $\\dfrac{dC_{D}}{dt} = k_{1}(T) C_{A} C_{B}$,\nwith initial conditions at $t=0$: $C_{A}(0) = C_{A,0}$, $C_{B}(0) = R\\, C_{A,0}$, $C_{D}(0)=0$. Here, $C_{i}$ are concentrations in $\\mathrm{mol\\cdot L^{-1}}$, time $t$ is in $\\mathrm{s}$, temperature $T$ is in $\\mathrm{K}$, and $R$ is the initial molar ratio $C_{B,0}/C_{A,0}$ (unitless). The rate constants obey Arrhenius laws:\n- $k_{1}(T) = A_{1} \\exp\\!\\left(-\\dfrac{E_{1}}{R_{g} T}\\right)$ with units $\\mathrm{L\\cdot mol^{-1}\\cdot s^{-1}}$,\n- $k_{2}(T) = A_{2} \\exp\\!\\left(-\\dfrac{E_{2}}{R_{g} T}\\right)$ with units $\\mathrm{s^{-1}}$,\nwhere $A_{1}$ and $A_{2}$ are pre-exponential factors, $E_{1}$ and $E_{2}$ are activation energies in $\\mathrm{J\\cdot mol^{-1}}$, and $R_{g}$ is the universal gas constant. Take $R_{g} = 8.314462618\\ \\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}}$.\n\nDefine the percent yield as the ratio (expressed as a decimal without a percent sign) between the actual moles of $D$ formed at a specified final time $t_{f}$ and the theoretical maximum moles of $D$ for the same initial feed if the desired reaction went to completion without side reaction. With constant volume and the above stoichiometry, this decimal yield is\n$$y = \\frac{C_{D}(t_{f})}{\\min\\!\\left(C_{A,0},\\, C_{B,0}\\right)} = \\frac{C_{D}(t_{f})}{\\min\\!\\left(C_{A,0},\\, R\\,C_{A,0}\\right)}.$$\n\nUncertainties are present in the rate constants, the feed composition ratio, and the temperature. Model these uncertainties via independent normal distributions on the following primary inputs:\n- $u_{1} = \\ln f_{1}$, where $f_{1}$ multiplicatively scales $k_{1}$ at fixed $T$ (so the effective $k_{1}$ is $k_{1}(T)\\, e^{u_{1}}$), with standard deviation $\\sigma_{u_{1}}$.\n- $u_{2} = \\ln f_{2}$, where $f_{2}$ multiplicatively scales $k_{2}$ at fixed $T$ (so the effective $k_{2}$ is $k_{2}(T)\\, e^{u_{2}}$), with standard deviation $\\sigma_{u_{2}}$.\n- $u_{3} = T$ (in $\\mathrm{K}$), with standard deviation $\\sigma_{u_{3}}$.\n- $u_{4} = R$ (unitless), with standard deviation $\\sigma_{u_{4}}$.\n\nAssume these inputs are statistically independent and small-variance so that first-order (linear) uncertainty propagation is applicable. Using a first-order Taylor expansion about the nominal point $(u_{1},u_{2},u_{3},u_{4}) = (0,0,T_{0},R_{0})$, approximate the variance of $y$ by\n$$\\operatorname{var}(y) \\approx \\sum_{i=1}^{4} \\left(\\frac{\\partial y}{\\partial u_{i}}\\right)^{2} \\sigma_{u_{i}}^{2},$$\nand define the contribution of input $i$ to the output variance as\n$$V_{i} = \\left(\\frac{\\partial y}{\\partial u_{i}}\\right)^{2} \\sigma_{u_{i}}^{2}.$$\nThe normalized contribution (a fraction) is $p_{i} = V_{i} \\big/ \\sum_{j=1}^{4} V_{j}$. Identify the dominant contributor by the largest $p_{i}$.\n\nNumerically estimate the partial derivatives with central finite differences around $(0,0,T_{0},R_{0})$, holding the other inputs fixed for each derivative. Use the following perturbation step sizes:\n- For $u_{1}$ and $u_{2}$: $h_{\\ln f} = 1.0\\times 10^{-4}$ (dimensionless).\n- For $u_{3}=T$: $h_{T} = 1.0\\times 10^{-2}\\ \\mathrm{K}$.\n- For $u_{4}=R$: $h_{R} = 1.0\\times 10^{-4}$ (dimensionless).\n\nIntegrate the kinetic ordinary differential equations to $t_{f}$ with a stiff-capable solver and tight tolerances so that numerical error is negligible relative to uncertainty effects. Use absolute tolerance $1.0\\times 10^{-12}$ and relative tolerance $1.0\\times 10^{-9}$.\n\nImplement a program that, for each parameter set in the test suite below, computes the normalized variance contributions $[p_{1},p_{2},p_{3},p_{4}]$ corresponding to the inputs $[u_{1},u_{2},u_{3},u_{4}] = [\\ln f_{1}, \\ln f_{2}, T, R]$ in this exact order.\n\nTest Suite (each line defines one case; all numbers are in the specified SI units):\n- Case $1$: $A_{1} = 5.0\\times 10^{4}$, $E_{1} = 5.5\\times 10^{4}$, $A_{2} = 2.0\\times 10^{3}$, $E_{2} = 8.0\\times 10^{4}$, $T_{0} = 350$, $\\sigma_{u_{3}} = 1.0$, $C_{A,0} = 1.0$, $R_{0} = 1.0$, $\\sigma_{u_{4}} = 2.0\\times 10^{-2}$, $\\sigma_{u_{1}} = 1.0\\times 10^{-1}$, $\\sigma_{u_{2}} = 1.0\\times 10^{-1}$, $t_{f} = 100.0$.\n- Case $2$: $A_{1} = 3.0\\times 10^{4}$, $E_{1} = 6.0\\times 10^{4}$, $A_{2} = 1.0\\times 10^{3}$, $E_{2} = 7.0\\times 10^{4}$, $T_{0} = 330$, $\\sigma_{u_{3}} = 5.0\\times 10^{-1}$, $C_{A,0} = 2.0$, $R_{0} = 4.0\\times 10^{-1}$, $\\sigma_{u_{4}} = 1.0\\times 10^{-2}$, $\\sigma_{u_{1}} = 5.0\\times 10^{-2}$, $\\sigma_{u_{2}} = 5.0\\times 10^{-2}$, $t_{f} = 200.0$.\n- Case $3$: $A_{1} = 1.0\\times 10^{9}$, $E_{1} = 9.0\\times 10^{4}$, $A_{2} = 1.0\\times 10^{8}$, $E_{2} = 1.1\\times 10^{5}$, $T_{0} = 420$, $\\sigma_{u_{3}} = 2.0$, $C_{A,0} = 1.0$, $R_{0} = 1.2$, $\\sigma_{u_{4}} = 2.0\\times 10^{-2}$, $\\sigma_{u_{1}} = 3.0\\times 10^{-2}$, $\\sigma_{u_{2}} = 3.0\\times 10^{-2}$, $t_{f} = 100.0$.\n\nYour program must:\n- Use the above physical model and uncertainty propagation method to compute $[p_{1},p_{2},p_{3},p_{4}]$ for each case.\n- Round each $p_{i}$ to exactly six decimal places in the final output, and ensure they appear in the order $[\\ln f_{1}, \\ln f_{2}, T, R]$.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a list of four floats for one test case (for example, $[[p_{1},p_{2},p_{3},p_{4}],\\,[\\cdots],\\,[\\cdots]]$).\n\nAnswer all quantities in the specified SI units and express yields and contributions as decimals (no percent sign).", "solution": "The problem statement is subjected to validation and is found to be scientifically sound, well-posed, and complete. It presents a standard problem in chemical reaction engineering, specifically concerning the sensitivity analysis of a reactor's yield with respect to uncertain kinetic and operational parameters. The methodology, based on first-order uncertainty propagation and numerical solution of ordinary differential equations (ODEs), is appropriate and clearly specified. We proceed with the solution.\n\nThe system is governed by a set of coupled, nonlinear ODEs describing the rate of change of concentrations for species $A$, $B$, and $D$ in an isothermal, constant-volume batch reactor:\n$$\n\\begin{aligned}\n\\dfrac{dC_{A}}{dt} = -k_{1}(T) C_{A} C_{B} - k_{2}(T) C_{A} \\\\\n\\dfrac{dC_{B}}{dt} = -k_{1}(T) C_{A} C_{B} \\\\\n\\dfrac{dC_{D}}{dt} = k_{1}(T) C_{A} C_{B}\n\\end{aligned}\n$$\nThe initial conditions at time $t=0$ are given as $C_{A}(0) = C_{A,0}$, $C_{B}(0) = R \\cdot C_{A,0}$, and $C_{D}(0) = 0$. The state of the system is the vector of concentrations $[C_{A}(t), C_{B}(t), C_{D}(t)]$.\n\nThe rate constants $k_{1}$ and $k_{2}$ are temperature-dependent according to the Arrhenius law:\n$$\nk_{1}(T) = A_{1} \\exp\\!\\left(-\\dfrac{E_{1}}{R_{g} T}\\right)\n$$\n$$\nk_{2}(T) = A_{2} \\exp\\!\\left(-\\dfrac{E_{2}}{R_{g} T}\\right)\n$$\nwhere $R_{g} = 8.314462618\\ \\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}}$.\n\nThe quantity of interest is the decimal yield, $y$, defined as the ratio of the amount of desired product $D$ formed at a final time $t_{f}$ to the theoretical maximum amount of $D$ that could be formed from the limiting reactant, assuming no side reactions. For a constant volume system, this is:\n$$\ny = \\frac{C_{D}(t_{f})}{\\min(C_{A,0}, C_{B,0})} = \\frac{C_{D}(t_{f})}{C_{A,0} \\min(1, R)}\n$$\nThe yield $y$ is a function of the system parameters and initial conditions. We are concerned with its sensitivity to four uncertain inputs: $u_{1} = \\ln f_{1}$ (a logarithmic factor on $k_{1}$), $u_{2} = \\ln f_{2}$ (a logarithmic factor on $k_{2}$), $u_{3} = T$ (temperature), and $u_{4} = R$ (initial molar ratio). The yield function is thus denoted $y(u_{1}, u_{2}, u_{3}, u_{4})$. The problem specifies that multiplicative factors $f_{1}$ and $f_{2}$ apply to the rate constants, such that the effective rate constants are $k_{1,eff} = k_{1}(T) \\exp(u_{1})$ and $k_{2,eff} = k_{2}(T) \\exp(u_{2})$.\n\nThe analysis employs a first-order Taylor series approximation for the variance of the yield, valid for small uncertainties. The total variance is approximated by a sum of contributions from each independent input:\n$$\n\\operatorname{var}(y) \\approx \\sum_{i=1}^{4} V_{i}, \\quad \\text{where} \\quad V_{i} = \\left(\\frac{\\partial y}{\\partial u_{i}}\\right)^{2} \\sigma_{u_{i}}^{2}\n$$\nThe partial derivatives are evaluated at the nominal point $(u_{1}, u_{2}, u_{3}, u_{4}) = (0, 0, T_{0}, R_{0})$. The normalized contribution from input $i$ is:\n$$\np_{i} = \\frac{V_{i}}{\\sum_{j=1}^{4} V_{j}}\n$$\n\nThe solution strategy is as follows:\n1.  For each test case, define a function that computes the yield $y$ for a given set of inputs $(u_{1}, u_{2}, T, R)$. This function, let us call it `calculate_yield`, will:\n    a. Calculate the effective rate constants $k_{1,eff}$ and $k_{2,eff}$ using the given temperature $T$ and logarithmic factors $u_{1}, u_{2}$.\n    b. Set the initial conditions $[C_{A,0}, R \\cdot C_{A,0}, 0]$. Note that the initial concentration of $B$ depends on the input $R$.\n    c. Numerically integrate the ODE system from $t=0$ to $t=t_{f}$ using a stiff-capable solver (`scipy.integrate.solve_ivp` with `method='BDF'`) and the specified tolerances (`rtol=$10^{-9}$`, `atol=$10^{-12}$`).\n    d. From the solution, extract the final concentration of the product, $C_{D}(t_{f})$.\n    e. Calculate the yield $y$ using its definition. It is critical to note that the denominator, $\\min(C_{A,0}, R \\cdot C_{A,0})$, also depends on the input $R$. This dependency must be correctly handled when evaluating the derivative with respect to $R$.\n\n2.  Numerically estimate the partial derivatives $\\frac{\\partial y}{\\partial u_{i}}$ at the nominal point $(0, 0, T_{0}, R_{0})$ using a second-order central finite difference scheme. For each input $u_{i}$:\n    $$\n    \\frac{\\partial y}{\\partial u_{i}} \\approx \\frac{y(\\dots, u_{i,0} + h_{i}, \\dots) - y(\\dots, u_{i,0} - h_{i}, \\dots)}{2h_{i}}\n    $$\n    where $u_{i,0}$ is the nominal value of the input and $h_i$ is the corresponding specified step size ($h_{\\ln f}$, $h_T$, or $h_R$). For each derivative, only one input is perturbed while the others are held at their nominal values. For example, to find $\\frac{\\partial y}{\\partial T}$:\n    $$\n    \\frac{\\partial y}{\\partial T} \\approx \\frac{\\text{calculate\\_yield}(0, 0, T_{0}+h_{T}, R_{0}) - \\text{calculate\\_yield}(0, 0, T_{0}-h_{T}, R_{0})}{2h_{T}}\n    $$\n\n3.  With the partial derivatives computed, calculate the unscaled variance contributions $V_{i}$ using the provided standard deviations $\\sigma_{u_{i}}$.\n\n4.  Sum the contributions to find the total approximate variance, $\\sum V_{j}$.\n\n5.  Calculate the normalized variance contributions $p_{i} = V_{i} / \\sum V_{j}$.\n\n6.  This procedure is repeated for each test case specified in the problem statement. The final results are formatted as requested. The implementation will use `numpy` for numerical operations and `scipy.integrate` for the ODE solution.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It calculates the normalized variance contributions for the yield of a chemical reaction\n    with respect to uncertainties in kinetic and operational parameters.\n    \"\"\"\n    # Universal gas constant in J/(mol*K)\n    R_g = 8.314462618\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {'A1': 5.0e4, 'E1': 5.5e4, 'A2': 2.0e3, 'E2': 8.0e4, 'T0': 350.0, 'sigma_u3': 1.0, \n         'CA0': 1.0, 'R0': 1.0, 'sigma_u4': 2.0e-2, 'sigma_u1': 1.0e-1, 'sigma_u2': 1.0e-1, 'tf': 100.0},\n        # Case 2\n        {'A1': 3.0e4, 'E1': 6.0e4, 'A2': 1.0e3, 'E2': 7.0e4, 'T0': 330.0, 'sigma_u3': 0.5, \n         'CA0': 2.0, 'R0': 0.4, 'sigma_u4': 1.0e-2, 'sigma_u1': 5.0e-2, 'sigma_u2': 5.0e-2, 'tf': 200.0},\n        # Case 3\n        {'A1': 1.0e9, 'E1': 9.0e4, 'A2': 1.0e8, 'E2': 1.1e5, 'T0': 420.0, 'sigma_u3': 2.0, \n         'CA0': 1.0, 'R0': 1.2, 'sigma_u4': 2.0e-2, 'sigma_u1': 3.0e-2, 'sigma_u2': 3.0e-2, 'tf': 100.0}\n    ]\n\n    # Perturbation step sizes for finite differences\n    h_lnf = 1.0e-4\n    h_T = 1.0e-2\n    h_R = 1.0e-4\n\n    all_results = []\n\n    def ode_system(t, C, k1, k2):\n        \"\"\"Defines the ODE system for the reaction kinetics.\"\"\"\n        CA, CB, CD = C\n        dCA_dt = -k1 * CA * CB - k2 * CA\n        dCB_dt = -k1 * CA * CB\n        dCD_dt = k1 * CA * CB\n        return [dCA_dt, dCB_dt, dCD_dt]\n\n    def calculate_yield(u1, u2, T, R, case_params):\n        \"\"\"\n        Calculates the yield for a given set of inputs (u1, u2, T, R).\n        This function integrates the ODEs and computes the final yield.\n        \"\"\"\n        # Unpack parameters\n        A1, E1, A2, E2 = case_params['A1'], case_params['E1'], case_params['A2'], case_params['E2']\n        CA0, tf = case_params['CA0'], case_params['tf']\n\n        # Calculate effective rate constants\n        k1_base = A1 * np.exp(-E1 / (R_g * T))\n        k2_base = A2 * np.exp(-E2 / (R_g * T))\n        k1_eff = k1_base * np.exp(u1)\n        k2_eff = k2_base * np.exp(u2)\n\n        # Initial conditions\n        CB0 = R * CA0\n        C0 = [CA0, CB0, 0.0]\n\n        # Solve the ODE system\n        sol = solve_ivp(\n            ode_system, \n            [0, tf], \n            C0, \n            method='BDF', \n            args=(k1_eff, k2_eff), \n            rtol=1.0e-9, \n            atol=1.0e-12\n        )\n        \n        # Extract final concentration of desired product\n        CD_final = sol.y[2, -1]\n\n        # Calculate theoretical maximum moles of D\n        # Note: This denominator depends on the input R\n        theo_max_moles_D = CA0 * np.min([1.0, R])\n        \n        # Handle case where denominator is zero\n        if theo_max_moles_D = 0:\n            return 0.0\n\n        yield_val = CD_final / theo_max_moles_D\n        return yield_val\n\n    for case in test_cases:\n        T0, R0 = case['T0'], case['R0']\n\n        # --- Calculate partial derivatives using central finite differences ---\n        \n        # Derivative wrt u1 = ln(f1)\n        y_plus_u1 = calculate_yield(h_lnf, 0, T0, R0, case)\n        y_minus_u1 = calculate_yield(-h_lnf, 0, T0, R0, case)\n        dyd_u1 = (y_plus_u1 - y_minus_u1) / (2 * h_lnf)\n\n        # Derivative wrt u2 = ln(f2)\n        y_plus_u2 = calculate_yield(0, h_lnf, T0, R0, case)\n        y_minus_u2 = calculate_yield(0, -h_lnf, T0, R0, case)\n        dyd_u2 = (y_plus_u2 - y_minus_u2) / (2 * h_lnf)\n\n        # Derivative wrt u3 = T\n        y_plus_u3 = calculate_yield(0, 0, T0 + h_T, R0, case)\n        y_minus_u3 = calculate_yield(0, 0, T0 - h_T, R0, case)\n        dyd_u3 = (y_plus_u3 - y_minus_u3) / (2 * h_T)\n\n        # Derivative wrt u4 = R\n        y_plus_u4 = calculate_yield(0, 0, T0, R0 + h_R, case)\n        y_minus_u4 = calculate_yield(0, 0, T0, R0 - h_R, case)\n        dyd_u4 = (y_plus_u4 - y_minus_u4) / (2 * h_R)\n\n        # --- Calculate variance contributions ---\n        \n        sensitivities = np.array([dyd_u1, dyd_u2, dyd_u3, dyd_u4])\n        sigmas = np.array([case['sigma_u1'], case['sigma_u2'], case['sigma_u3'], case['sigma_u4']])\n        \n        variances_V = (sensitivities**2) * (sigmas**2)\n        \n        total_variance = np.sum(variances_V)\n        \n        if total_variance > 0:\n            normalized_contributions_p = variances_V / total_variance\n        else:\n            normalized_contributions_p = np.array([0.0, 0.0, 0.0, 0.0])\n            \n        # Round results to 6 decimal places\n        p_rounded = [round(p, 6) for p in normalized_contributions_p]\n        all_results.append(p_rounded)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2949897"}]}