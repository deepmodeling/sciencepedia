{"hands_on_practices": [{"introduction": "Before we can use Gaussian-type orbitals (GTOs) as building blocks in quantum calculations, we must ensure they are mathematically well-behaved. This foundational exercise ([@problem_id:2806509]) takes you through the first-principles derivation of the normalization constant for a general Cartesian GTO. Mastering this integral is an essential skill, reinforcing your understanding of multivariate calculus and the mathematical structure of the basis functions that underpin modern computational chemistry.", "problem": "Let $a$, $b$, and $c$ be nonnegative integers and let $\\alpha>0$. Consider the primitive Cartesian Gaussian-type orbital (GTO) defined on $\\mathbb{R}^3$ by\n$$\ng_{a b c}(\\mathbf{r}) \\;=\\; \\mathcal{N}\\, x^{a} y^{b} z^{c} \\exp\\!\\big(-\\alpha\\, r^{2}\\big),\n$$\nwhere $r=\\|\\mathbf{r}\\|$, $\\mathbf{r}=(x,y,z)$, and $\\mathcal{N}$ is a real normalization constant. Starting from the definition of normalization for square-integrable real functions,\n$$\n\\int_{\\mathbb{R}^3} \\big|g_{a b c}(\\mathbf{r})\\big|^{2}\\, d^{3}\\mathbf{r} \\;=\\; 1,\n$$\nand using only fundamental properties of separable integrals together with well-tested facts about Gaussian integrals or the Gamma function, derive a closed-form expression for the unique positive normalization constant $\\mathcal{N}$ in terms of $\\alpha$, $a$, $b$, and $c$. You may use standard special-function identities, but you must show how they enter the derivation from first principles.\n\nExpress your final answer as a single closed-form analytic expression. Do not provide a numerical approximation. No units are required.", "solution": "The solution begins with the normalization condition. Since $g_{a b c}(\\mathbf{r})$ is a real-valued function, the condition $|g_{a b c}(\\mathbf{r})|^{2} = (g_{a b c}(\\mathbf{r}))^{2}$ holds. The normalization integral is:\n$$\n\\int_{\\mathbb{R}^3} \\left( \\mathcal{N}\\, x^{a} y^{b} z^{c} \\exp(-\\alpha\\, r^{2}) \\right)^{2}\\, d^{3}\\mathbf{r} = 1\n$$\nWe extract the constant $\\mathcal{N}$ from the integral and expand the terms:\n$$\n\\mathcal{N}^{2} \\int_{\\mathbb{R}^3} x^{2a} y^{2b} z^{2c} \\exp(-2\\alpha\\, r^{2})\\, d^{3}\\mathbf{r} = 1\n$$\nIn Cartesian coordinates, $r^{2} = x^{2} + y^{2} + z^{2}$ and the volume element is $d^{3}\\mathbf{r} = dx\\,dy\\,dz$. The integral becomes:\n$$\n\\mathcal{N}^{2} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} x^{2a} y^{2b} z^{2c} \\exp\\big(-2\\alpha (x^{2} + y^{2} + z^{2})\\big)\\, dx\\,dy\\,dz = 1\n$$\nThe integrand is a product of functions of $x$, $y$, and $z$ independently. Therefore, the triple integral is separable into a product of three one-dimensional integrals:\n$$\n\\mathcal{N}^{2} \\left( \\int_{-\\infty}^{\\infty} x^{2a} \\exp(-2\\alpha x^{2})\\,dx \\right) \\left( \\int_{-\\infty}^{\\infty} y^{2b} \\exp(-2\\alpha y^{2})\\,dy \\right) \\left( \\int_{-\\infty}^{\\infty} z^{2c} \\exp(-2\\alpha z^{2})\\,dz \\right) = 1\n$$\nAll three integrals are of the same general form. We must evaluate the integral:\n$$\nI_{n} = \\int_{-\\infty}^{\\infty} u^{2n} \\exp(-\\beta u^{2})\\,du\n$$\nwhere $n$ is a nonnegative integer and $\\beta > 0$. In our specific case, $\\beta = 2\\alpha$.\nThe integrand $u^{2n} \\exp(-\\beta u^{2})$ is an even function of $u$. Thus, the integral over $(-\\infty, \\infty)$ is twice the integral over $(0, \\infty)$:\n$$\nI_{n} = 2 \\int_{0}^{\\infty} u^{2n} \\exp(-\\beta u^{2})\\,du\n$$\nTo evaluate this integral, we perform a substitution. Let $t = \\beta u^{2}$. Then $u = \\sqrt{t/\\beta} = t^{1/2}\\beta^{-1/2}$, and the differential is $du = \\frac{1}{2}t^{-1/2}\\beta^{-1/2}\\,dt$. The integration limits remain $(0, \\infty)$. Substituting these into the expression for $I_{n}$:\n$$\nI_{n} = 2 \\int_{0}^{\\infty} (t^{1/2}\\beta^{-1/2})^{2n} \\exp(-t) \\left( \\frac{1}{2}t^{-1/2}\\beta^{-1/2} \\right)\\,dt\n$$\n$$\nI_{n} = \\beta^{-n} \\beta^{-1/2} \\int_{0}^{\\infty} t^{n} t^{-1/2} \\exp(-t)\\,dt = \\beta^{-(n + 1/2)} \\int_{0}^{\\infty} t^{n - 1/2} \\exp(-t)\\,dt\n$$\nThe integral on the right is the definition of the Euler Gamma function, $\\Gamma(z) = \\int_{0}^{\\infty} t^{z-1} \\exp(-t)\\,dt$. Here, the exponent of $t$ is $n - 1/2$, so $z-1 = n-1/2$, which gives $z = n + 1/2$.\nThus, the integral is $I_{n} = \\beta^{-(n + 1/2)} \\Gamma(n + 1/2)$.\n\nFor integer $n$, the half-integer Gamma function has a known closed form involving the double factorial, $(2n-1)!! = (2n-1)(2n-3)\\cdots(3)(1)$, with the convention that $(-1)!!=1$. The identity is:\n$$\n\\Gamma(n + 1/2) = \\frac{(2n-1)!!}{2^{n}} \\sqrt{\\pi}\n$$\nSubstituting this into our expression for $I_n$:\n$$\nI_{n} = \\beta^{-(n + 1/2)} \\frac{(2n-1)!!}{2^{n}} \\sqrt{\\pi}\n$$\nThis expression can be rearranged for clarity:\n$$\nI_{n} = \\frac{1}{\\beta^{n}\\sqrt{\\beta}} \\frac{(2n-1)!!}{2^{n}} \\sqrt{\\pi} = \\sqrt{\\frac{\\pi}{\\beta}} \\frac{(2n-1)!!}{(2\\beta)^{n}}\n$$\nNow, we apply this result to our three integrals with $\\beta = 2\\alpha$:\nThe $x$-integral is $I_{a} = \\sqrt{\\frac{\\pi}{2\\alpha}} \\frac{(2a-1)!!}{(4\\alpha)^{a}}$.\nThe $y$-integral is $I_{b} = \\sqrt{\\frac{\\pi}{2\\alpha}} \\frac{(2b-1)!!}{(4\\alpha)^{b}}$.\nThe $z$-integral is $I_{c} = \\sqrt{\\frac{\\pi}{2\\alpha}} \\frac{(2c-1)!!}{(4\\alpha)^{c}}$.\n\nThe product of these three integrals is equal to $1/\\mathcal{N}^{2}$:\n$$\n\\frac{1}{\\mathcal{N}^{2}} = \\left( \\sqrt{\\frac{\\pi}{2\\alpha}} \\right)^{3} \\frac{(2a-1)!! \\, (2b-1)!! \\, (2c-1)!!}{(4\\alpha)^{a} (4\\alpha)^{b} (4\\alpha)^{c}}\n$$\n$$\n\\frac{1}{\\mathcal{N}^{2}} = \\left( \\frac{\\pi}{2\\alpha} \\right)^{3/2} \\frac{(2a-1)!! \\, (2b-1)!! \\, (2c-1)!!}{(4\\alpha)^{a+b+c}}\n$$\nWe solve for $\\mathcal{N}^{2}$ by taking the reciprocal:\n$$\n\\mathcal{N}^{2} = \\left( \\frac{2\\alpha}{\\pi} \\right)^{3/2} \\frac{(4\\alpha)^{a+b+c}}{(2a-1)!! \\, (2b-1)!! \\, (2c-1)!!}\n$$\nThe problem asks for the unique positive normalization constant $\\mathcal{N}$, which is the principal square root of the expression above:\n$$\n\\mathcal{N} = \\sqrt{ \\left( \\frac{2\\alpha}{\\pi} \\right)^{3/2} \\frac{(4\\alpha)^{a+b+c}}{(2a-1)!! \\, (2b-1)!! \\, (2c-1)!!} }\n$$\nSimplifying the expression by taking the square root of each term gives the final analytical form for $\\mathcal{N}$:\n$$\n\\mathcal{N} = \\left( \\frac{2\\alpha}{\\pi} \\right)^{3/4} \\frac{(4\\alpha)^{(a+b+c)/2}}{\\sqrt{(2a-1)!! \\, (2b-1)!! \\, (2c-1)!!}}\n$$\nThis is the required closed-form expression for the normalization constant.", "answer": "$$\n\\boxed{\\left( \\frac{2\\alpha}{\\pi} \\right)^{3/4} \\frac{(4\\alpha)^{(a+b+c)/2}}{\\sqrt{(2a-1)!! (2b-1)!! (2c-1)!!}}}\n$$", "id": "2806509"}, {"introduction": "With the mathematical form of GTOs established, we now investigate their key physical shortcoming. This practice ([@problem_id:2806517]) guides you to explore the \"electron-nucleus cusp,\" a sharp feature of exact wavefunctions that smooth Gaussian functions struggle to reproduce. By performing a variational calculation and comparing the resulting kinetic energy to the exact value, you will gain a deep, quantitative understanding of why this deficiency is so critical and why simple basis sets yield slow convergence.", "problem": "Consider a one-electron hydrogen-like atom of nuclear charge $Z$ in atomic units (Hartree energy and bohr length). The exact normalized ground-state orbital is the $1s$ Slater-type orbital (STO), $\\psi_{\\text{STO}}(r)=\\left(\\frac{Z^{3}}{\\pi}\\right)^{1/2}\\exp(-Z r)$, which satisfies the electron–nucleus Kato cusp condition $(\\partial \\psi/\\partial r)_{r=0}=-Z\\,\\psi(0)$. In contrast, any finite expansion in $s$-type Gaussian-type orbitals (GTOs) centered at the nucleus is a linear combination of functions of the form $g_{\\alpha}(r)=N_{\\alpha}\\exp(-\\alpha r^{2})$, which are smooth at $r=0$ and have $(\\partial g_{\\alpha}/\\partial r)_{r=0}=0$.\n\nYour tasks are:\n\n- Use the Kato cusp condition and the radial derivative at the origin to argue from first principles why any finite linear combination of $s$-type Gaussian-type orbitals cannot satisfy the nuclear cusp at $r=0$, and explain why this structural deficiency can lead to slow convergence of the kinetic energy when increasing the number of Gaussian functions.\n\n- As a concrete counterexample, approximate the hydrogenic $1s$ state by a single normalized $s$-type Gaussian $g_{\\alpha}(r)=N_{\\alpha}\\exp(-\\alpha r^{2})$ with exponent $\\alpha>0$ and normalization $N_{\\alpha}=(2\\alpha/\\pi)^{3/4}$. Starting from the definitions of the kinetic-energy operator $\\hat{T}=-\\frac{1}{2}\\nabla^{2}$ and the electron–nuclear potential $V(r)=-Z/r$, compute the expectation values $\\langle T\\rangle_{\\alpha}=\\langle g_{\\alpha}|\\hat{T}|g_{\\alpha}\\rangle$ and $\\langle V\\rangle_{\\alpha}=\\langle g_{\\alpha}|V|g_{\\alpha}\\rangle$ explicitly as functions of $\\alpha$ and $Z$. Then perform a variational minimization of the total energy $E(\\alpha)=\\langle T\\rangle_{\\alpha}+\\langle V\\rangle_{\\alpha}$ with respect to $\\alpha$ to obtain the optimal exponent $\\alpha^{\\star}(Z)$ and the corresponding optimized kinetic energy $\\langle T\\rangle_{\\alpha^{\\star}}$.\n\n- Define the ratio $\\rho(Z)=\\langle T\\rangle_{\\alpha^{\\star}}/T_{\\text{exact}}$, where $T_{\\text{exact}}$ is the exact hydrogenic ground-state kinetic energy in atomic units. Provide the closed-form analytic expression for $\\rho(Z)$, simplified as much as possible.\n\n- Briefly propose physically motivated remedies that directly target the nuclear cusp defect while retaining Gaussian-type bases (for example, without replacing the whole basis by Slater-type orbitals), and justify how they address the slow kinetic-energy convergence. No calculation is required for this last item.\n\nFor grading, report only the simplified closed-form expression you found for $\\rho(Z)$. No rounding is required.", "solution": "First, we address the qualitative question regarding the Kato cusp condition.\nThe exact ground-state wavefunction for a hydrogen-like atom, the $1s$ Slater-type orbital $\\psi_{\\text{STO}}(r)=\\left(\\frac{Z^{3}}{\\pi}\\right)^{1/2}\\exp(-Z r)$, exhibits a derivative cusp at the nucleus ($r=0$). The Kato cusp condition quantifies this behavior:\n$$ \\left(\\frac{\\partial \\psi}{\\partial r}\\right)_{r=0} = -Z\\,\\psi(0) $$\nFor the $1s$ STO, $\\psi_{\\text{STO}}(0) = (Z^3/\\pi)^{1/2}$ and $(\\partial \\psi_{\\text{STO}}/\\partial r)_{r=0} = -Z(Z^3/\\pi)^{1/2}$, satisfying the condition. This non-zero derivative at the origin signifies a sharp peak in the wavefunction, which is a point of high curvature.\n\nAn orbital approximation based on a finite linear combination of $s$-type Gaussian-type orbitals (GTOs) is of the form:\n$$ \\psi_{\\text{GTO-LC}}(r) = \\sum_{i=1}^{N} c_i g_{\\alpha_i}(r) = \\sum_{i=1}^{N} c_i N_{\\alpha_i}\\exp(-\\alpha_i r^{2}) $$\nTo evaluate the derivative at the origin, we consider each GTO component, $g_{\\alpha}(r) = N_{\\alpha}\\exp(-\\alpha r^{2})$. Its radial derivative is:\n$$ \\frac{\\partial g_{\\alpha}}{\\partial r} = N_{\\alpha} \\exp(-\\alpha r^{2}) \\cdot (-2\\alpha r) $$\nEvaluating this derivative at $r=0$ yields:\n$$ \\left(\\frac{\\partial g_{\\alpha}}{\\partial r}\\right)_{r=0} = N_{\\alpha} \\exp(0) \\cdot (-2\\alpha \\cdot 0) = 0 $$\nSince the derivative of a sum is the sum of the derivatives, the derivative of the full linear combination at the origin is:\n$$ \\left(\\frac{\\partial \\psi_{\\text{GTO-LC}}}{\\partial r}\\right)_{r=0} = \\sum_{i=1}^{N} c_i \\left(\\frac{\\partial g_{\\alpha_i}}{\\partial r}\\right)_{r=0} = \\sum_{i=1}^{N} c_i \\cdot 0 = 0 $$\nThis result holds for any finite number of GTOs, $N$, and any choice of coefficients $c_i$ and exponents $\\alpha_i$. Therefore, any finite GTO expansion has a zero slope at the nucleus and structurally fails to reproduce the non-zero derivative required by the Kato cusp condition.\n\nThe kinetic energy operator, $\\hat{T} = -\\frac{1}{2}\\nabla^{2}$, is intrinsically linked to the curvature of the wavefunction. The cusp at $r=0$ represents a region of extremely high curvature. Because GTOs are smooth functions at the origin, they are fundamentally ill-suited to describe this feature. To approximate the sharp cusp, one must combine GTOs with very large exponents ($\\alpha_i \\gg 1$). These \"tight\" GTOs are highly peaked and possess large curvature, thus contributing substantially to the kinetic energy. However, even a large number of such functions can only approximate the cusp, not reproduce it exactly. The effort to build this sharp feature using smooth basis functions results in a slow convergence of the total energy, and particularly the kinetic energy, with respect to the size of the basis set.\n\nNext, we perform the variational calculation for a single normalized GTO, $g_{\\alpha}(r)=N_{\\alpha}\\exp(-\\alpha r^{2})$ where $N_{\\alpha}=(2\\alpha/\\pi)^{3/4}$.\n\nThe expectation value of the kinetic energy, $\\langle T\\rangle_{\\alpha} = \\langle g_{\\alpha}|\\hat{T}|g_{\\alpha}\\rangle$, is computed. The operator in spherical coordinates for a spherically symmetric function is $\\hat{T} = -\\frac{1}{2}\\nabla^{2} = -\\frac{1}{2r^2}\\frac{\\partial}{\\partial r}\\left(r^2\\frac{\\partial}{\\partial r}\\right)$.\n$$ \\hat{T} g_{\\alpha}(r) = -\\frac{1}{2}\\nabla^{2} \\left(N_{\\alpha}\\exp(-\\alpha r^2)\\right) = N_{\\alpha} (3\\alpha - 2\\alpha^2 r^2) \\exp(-\\alpha r^2) $$\nThe expectation value is:\n$$ \\langle T\\rangle_{\\alpha} = \\int_{0}^{\\infty} g_{\\alpha}(r) \\left( (3\\alpha - 2\\alpha^2 r^2) g_{\\alpha}(r) \\right) 4\\pi r^2 dr $$\n$$ \\langle T\\rangle_{\\alpha} = 3\\alpha \\int (g_{\\alpha}(r))^2 d\\tau - 2\\alpha^2 \\int r^2 (g_{\\alpha}(r))^2 d\\tau $$\nThe first integral is $1$ by normalization. The second is $2\\alpha^2 \\langle r^2 \\rangle$. The integral for $\\langle r^2 \\rangle$ is:\n$$ \\langle r^2 \\rangle = 4\\pi N_{\\alpha}^2 \\int_{0}^{\\infty} r^4 \\exp(-2\\alpha r^2) dr $$\nUsing the standard integral formula $\\int_0^{\\infty} x^{2n} \\exp(-ax^2) dx = \\frac{(2n-1)!!}{2^{n+1}} \\sqrt{\\frac{\\pi}{a^{2n+1}}}$, with $n=2$ and $a=2\\alpha$:\n$$ \\int_{0}^{\\infty} r^4 \\exp(-2\\alpha r^2) dr = \\frac{3!!}{2^3} \\sqrt{\\frac{\\pi}{(2\\alpha)^5}} = \\frac{3}{8} \\frac{\\sqrt{\\pi}}{4\\sqrt{2}\\alpha^{5/2}} = \\frac{3\\sqrt{\\pi}}{32\\sqrt{2}\\alpha^{5/2}} $$\nSubstituting $N_{\\alpha}^2 = (2\\alpha/\\pi)^{3/2} = \\frac{2\\sqrt{2}\\alpha^{3/2}}{\\pi^{3/2}}$:\n$$ \\langle r^2 \\rangle = 4\\pi \\left(\\frac{2\\sqrt{2}\\alpha^{3/2}}{\\pi^{3/2}}\\right) \\left(\\frac{3\\sqrt{\\pi}}{32\\sqrt{2}\\alpha^{5/2}}\\right) = \\frac{3}{4\\alpha} $$\nThus, the kinetic energy is:\n$$ \\langle T\\rangle_{\\alpha} = 3\\alpha - 2\\alpha^2 \\left(\\frac{3}{4\\alpha}\\right) = 3\\alpha - \\frac{3}{2}\\alpha = \\frac{3}{2}\\alpha $$\n\nThe expectation value of the potential energy, $\\langle V\\rangle_{\\alpha} = \\langle g_{\\alpha}|-Z/r|g_{\\alpha}\\rangle$, is:\n$$ \\langle V\\rangle_{\\alpha} = -Z \\int_{0}^{\\infty} (g_{\\alpha}(r))^2 \\frac{1}{r} 4\\pi r^2 dr = -4\\pi Z N_{\\alpha}^2 \\int_{0}^{\\infty} r \\exp(-2\\alpha r^2) dr $$\nThe integral is elementary: $\\int_{0}^{\\infty} r \\exp(-2\\alpha r^2) dr = \\left[-\\frac{1}{4\\alpha}\\exp(-2\\alpha r^2)\\right]_0^{\\infty} = \\frac{1}{4\\alpha}$.\n$$ \\langle V\\rangle_{\\alpha} = -4\\pi Z N_{\\alpha}^2 \\left(\\frac{1}{4\\alpha}\\right) = -\\frac{\\pi Z N_{\\alpha}^2}{\\alpha} = -\\frac{\\pi Z}{\\alpha} \\left(\\frac{2\\sqrt{2}\\alpha^{3/2}}{\\pi^{3/2}}\\right) = -Z \\frac{2\\sqrt{2\\alpha}}{\\sqrt{\\pi}} = -2Z\\sqrt{\\frac{2\\alpha}{\\pi}} $$\n\nThe total energy is $E(\\alpha) = \\langle T\\rangle_{\\alpha} + \\langle V\\rangle_{\\alpha} = \\frac{3}{2}\\alpha - 2Z\\sqrt{\\frac{2\\alpha}{\\pi}}$.\nTo find the optimal exponent $\\alpha^{\\star}$, we minimize $E(\\alpha)$ by setting its derivative to zero:\n$$ \\frac{dE}{d\\alpha} = \\frac{3}{2} - 2Z\\sqrt{\\frac{2}{\\pi}} \\left(\\frac{1}{2\\sqrt{\\alpha}}\\right) = \\frac{3}{2} - Z\\sqrt{\\frac{2}{\\pi\\alpha}} = 0 $$\n$$ \\frac{3}{2} = Z\\sqrt{\\frac{2}{\\pi\\alpha^{\\star}}} \\implies \\frac{9}{4} = Z^2 \\frac{2}{\\pi\\alpha^{\\star}} \\implies \\alpha^{\\star} = \\frac{8Z^2}{9\\pi} $$\nThe optimized kinetic energy is then:\n$$ \\langle T\\rangle_{\\alpha^{\\star}} = \\frac{3}{2}\\alpha^{\\star} = \\frac{3}{2}\\left(\\frac{8Z^2}{9\\pi}\\right) = \\frac{4Z^2}{3\\pi} $$\n\nNow, to compute the ratio $\\rho(Z) = \\langle T\\rangle_{\\alpha^{\\star}} / T_{\\text{exact}}$, we need the exact kinetic energy $T_{\\text{exact}}$. For any exact eigenstate of a system with a potential $V \\propto r^k$, the Virial Theorem states $2\\langle T \\rangle = k \\langle V \\rangle$. For the hydrogenic atom, $V(r)=-Z/r$, so $k=-1$, and $2T_{\\text{exact}} = -V_{\\text{exact}}$. The exact total energy is $E_{\\text{exact}} = T_{\\text{exact}} + V_{\\text{exact}} = T_{\\text{exact}} - 2T_{\\text{exact}} = -T_{\\text{exact}}$. Since $E_{\\text{exact}} = -Z^2/2$ a.u., the exact kinetic energy is:\n$$ T_{\\text{exact}} = -E_{\\text{exact}} = \\frac{Z^2}{2} $$\nThe ratio is therefore:\n$$ \\rho(Z) = \\frac{\\langle T\\rangle_{\\alpha^{\\star}}}{T_{\\text{exact}}} = \\frac{4Z^2/(3\\pi)}{Z^2/2} = \\frac{4Z^2}{3\\pi} \\cdot \\frac{2}{Z^2} = \\frac{8}{3\\pi} $$\nThe ratio is a constant, independent of the nuclear charge $Z$.\n\nFinally, we propose physically motivated remedies for the cusp deficiency. The most pragmatic and widely used remedy is to construct basis functions as fixed linear combinations of GTOs, known as **contracted Gaussian functions (CGFs)**. Specifically, one creates a basis function $\\chi_{\\text{CGF}}(r) = \\sum_{i} d_i g_{\\alpha_i}(r)$, where the coefficients $d_i$ and exponents $\\alpha_i$ are pre-optimized to make $\\chi_{\\text{CGF}}$ resemble a Slater-type orbital as closely as possible, especially in the core region. By including GTOs with very large exponents in this contraction, a sharp peak can be formed at the nucleus, which provides a much better approximation to the electron-nucleus cusp than any single GTO can. This directly addresses the slow convergence of kinetic energy by providing a more accurate description of the wavefunction's curvature near the nucleus from the outset. This principle is the foundation of basis sets such as the STO-nG series and more sophisticated Pople- or Dunning-type basis sets.", "answer": "$$\n\\boxed{\\frac{8}{3\\pi}}\n$$", "id": "2806517"}, {"introduction": "This final, comprehensive exercise ([@problem_id:2806505]) brings together the previous concepts in a practical computational setting. You will implement a full Restricted Hartree-Fock (RHF) calculation for the dihydrogen molecule, directly comparing the results from a minimal, contracted basis set to those from a more flexible decontracted one. This hands-on implementation demonstrates the variational principle in action and provides concrete evidence of how increasing basis set flexibility allows for a more accurate description of the electronic structure, directly mitigating the issues explored in the previous practice.", "problem": "You will write a complete program that, using first principles of basis function representation and the variational principle, evaluates how decontracting valence functions affects Restricted Hartree-Fock (RHF) total energies and orbital energies for a small molecule. The molecule to study is dihydrogen, with two nuclei of charge $Z=1$ situated along the $x$-axis at positions $\\mathbf{R}_\\mathrm{A}=(-R/2,0,0)$ and $\\mathbf{R}_\\mathrm{B}=(R/2,0,0)$, where $R$ is the internuclear separation. The computation must use atomic units, so distances are in bohr and energies are in hartree. The goal is to compare two basis representations built from Gaussian-type orbitals (GTOs) that approximate a Slater-type orbital (STO): a contracted valence function and its fully decontracted set of primitives.\n\nUse the following well-tested definitions and facts as the fundamental base:\n- The variational principle for the electronic ground state of a fixed-nuclei Hamiltonian states that the best approximation within a chosen finite basis minimizes the RHF energy functional. The RHF energy is a functional of the one-particle density matrix built from orthonormal molecular orbitals that are themselves linear combinations of atomic orbitals.\n- A primitive $s$-type Gaussian-type orbital centered at $\\mathbf{A}$ with exponent $\\alpha$ has the form $\\phi(\\mathbf{r}) = N(\\alpha)\\,\\exp\\!\\left(-\\alpha\\lVert \\mathbf{r}-\\mathbf{A}\\rVert^2\\right)$, where $N(\\alpha)$ is the normalization constant that ensures $\\int \\lvert \\phi \\rvert^2 \\, \\mathrm{d}\\mathbf{r} = 1$.\n- The Gaussian product theorem states that the product of two $s$-type Gaussians centered at $\\mathbf{A}$ and $\\mathbf{B}$ with exponents $\\alpha$ and $\\beta$ is proportional to another Gaussian centered at the Gaussian product center $\\mathbf{P} = (\\alpha \\mathbf{A} + \\beta \\mathbf{B})/(\\alpha+\\beta)$.\n- Boys functions $F_n(T)$ for $n=0$ arise from radial Coulomb integrals and admit closed forms in terms of the error function for $n=0$.\n\nConstruct two basis sets on each hydrogen center using the hydrogen $1s$ STO-3G data. The contracted valence function on a hydrogen center is a fixed linear combination of three normalized primitive $s$-type Gaussians with exponents and contraction coefficients:\n- Exponents $\\{\\alpha_i\\}_{i=1}^3 = \\{3.42525091,\\,0.62391373,\\,0.16885540\\}$.\n- Contraction coefficients $\\{c_i\\}_{i=1}^3 = \\{0.15432897,\\,0.53532814,\\,0.44463454\\}$.\nEach primitive must be individually normalized; the contraction coefficients multiply these normalized primitives. For the contracted basis case, the atomic orbital on each hydrogen is the linear combination $\\chi(\\mathbf{r}) = \\sum_{i=1}^{3} c_i\\,\\phi_i(\\mathbf{r})$. For the decontracted basis case, replace each contracted valence function by its three normalized primitive Gaussians treated as linearly independent basis functions without any additional contraction, i.e., each primitive on each center becomes its own basis function.\n\nAdopt a closed-shell RHF model with $N_\\mathrm{e} = 2$ electrons and use the usual one-electron and two-electron integrals over $s$-type Gaussians derived from the definitions above, including the kinetic energy operator, electron–nuclear attraction to both nuclei at $\\mathbf{R}_\\mathrm{A}$ and $\\mathbf{R}_\\mathrm{B}$ with charges $Z_\\mathrm{A}=Z_\\mathrm{B}=1$, and electron–electron Coulomb repulsion. Form the overlap matrix, the core Hamiltonian matrix, and the two-electron integral tensor in the chosen basis. Perform a standard self-consistent field (SCF) iteration to obtain the canonical RHF molecular orbitals by solving the generalized eigenvalue problem in an orthonormalized basis. Compute the RHF total electronic energy and add the nuclear repulsion energy $E_\\mathrm{nn} = Z_\\mathrm{A} Z_\\mathrm{B} / R$ to obtain the total energy.\n\nYour program must evaluate, for each test case, the difference between decontracted and contracted results for three quantities:\n- The RHF total energy $E_\\mathrm{tot}$ in hartree.\n- The highest occupied molecular orbital (HOMO) energy $\\varepsilon_\\mathrm{HOMO}$ in hartree.\n- The lowest unoccupied molecular orbital (LUMO) energy $\\varepsilon_\\mathrm{LUMO}$ in hartree.\n\nReport, for each test case, the three differences as $(\\Delta E_\\mathrm{tot},\\,\\Delta \\varepsilon_\\mathrm{HOMO},\\,\\Delta \\varepsilon_\\mathrm{LUMO})$, where each difference is computed as the decontracted value minus the contracted value. All energies must be expressed in hartree. Round each reported float to $8$ decimal places.\n\nTest suite:\n- Use the following internuclear separations $R$ (in bohr): $R_1=1.40000000$, $R_2=0.80000000$, $R_3=3.00000000$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of the three rounded floats in the order specified above. For example, the output should look like $[ [x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3] ]$ with no extra whitespace constraints other than being valid Python list syntax.", "solution": "The solution requires the implementation of the full Restricted Hartree-Fock (RHF) Self-Consistent Field (SCF) procedure for a molecular system with a given geometry and basis set. The steps are as follows:\n\n1.  **System and Basis Set Definition**:\n    The system is the dihydrogen molecule, $\\text{H}_2$, with two protons of charge $Z=1$ at positions $\\mathbf{R}_\\mathrm{A}=(-R/2, 0, 0)$ and $\\mathbf{R}_\\mathrm{B}=(R/2, 0, 0)$. There are $N_\\mathrm{e}=2$ electrons. The basis sets are constructed from primitive $s$-type Gaussian-type orbitals (GTOs), $\\phi(\\mathbf{r}) = N(\\alpha)\\,\\exp(-\\alpha\\lVert\\mathbf{r}-\\mathbf{A}\\rVert^2)$, where the normalization constant is $N(\\alpha) = (2\\alpha/\\pi)^{3/4}$. The STO-3G data for hydrogen are given by exponents $\\{\\alpha_i\\} = \\{3.42525091, 0.62391373, 0.16885540\\}$ and contraction coefficients $\\{c_i\\} = \\{0.15432897, 0.53532814, 0.44463454\\}$.\n\n    -   **Contracted Basis**: Two basis functions, one on each nucleus. Each is a fixed linear combination of three normalized primitives: $\\chi_\\mathrm{A}(\\mathbf{r}) = \\sum_{i=1}^3 c_i \\phi_{i,\\mathrm{A}}(\\mathbf{r})$ and $\\chi_\\mathrm{B}(\\mathbf{r}) = \\sum_{i=1}^3 c_i \\phi_{i,\\mathrm{B}}(\\mathbf{r})$. The total basis size is $K=2$.\n    -   **Decontracted Basis**: The three primitive GTOs on each nucleus are treated as independent basis functions. This results in a basis of size $K=6$.\n\n2.  **Calculation of Molecular Integrals**:\n    The RHF method requires one- and two-electron integrals over the basis functions $\\{\\chi_\\mu\\}$. Since the basis functions are linear combinations of primitives, $\\chi_\\mu = \\sum_p d_{p\\mu} \\phi_p$, the integrals are computed by summing over primitive integrals.\n\n    -   **Overlap Matrix ($S$)**: $S_{\\mu\\nu} = \\int \\chi_\\mu^*(\\mathbf{r}) \\chi_\\nu(\\mathbf{r}) \\, d\\mathbf{r}$.\n    -   **Core Hamiltonian Matrix ($H^\\mathrm{core}$)**: $H^\\mathrm{core}_{\\mu\\nu} = T_{\\mu\\nu} + V_{\\mu\\nu}$, where $T_{\\mu\\nu}$ is the kinetic energy integral, $T_{\\mu\\nu} = \\int \\chi_\\mu^*(-\\frac{1}{2}\\nabla^2)\\chi_\\nu \\, d\\mathbf{r}$, and $V_{\\mu\\nu}$ is the nuclear attraction integral, $V_{\\mu\\nu} = \\int \\chi_\\mu^* \\sum_A (-Z_A/|\\mathbf{r}-\\mathbf{R}_A|) \\chi_\\nu \\, d\\mathbf{r}$.\n    -   **Two-Electron Repulsion Integral (ERI) Tensor**: $(\\mu\\nu|\\lambda\\sigma) = \\iint \\chi_\\mu^*(1)\\chi_\\nu(1) \\frac{1}{r_{12}} \\chi_\\lambda^*(2)\\chi_\\sigma(2) \\, d\\mathbf{r}_1 d\\mathbf{r}_2$.\n\n    The integrals over primitive $s$-type GTOs $\\phi_a$ and $\\phi_b$ with exponents $\\alpha, \\beta$ centered at $\\mathbf{A}, \\mathbf{B}$ are given by analytical formulas. Let $p = \\alpha+\\beta$ and $\\mathbf{R}_{AB} = \\mathbf{A}-\\mathbf{B}$.\n    -   Overlap: $S_{ab} = (4\\alpha\\beta/(\\alpha+\\beta)^2)^{3/4} \\exp(-\\frac{\\alpha\\beta}{\\alpha+\\beta} |\\mathbf{R}_{AB}|^2)$.\n    -   Kinetic: $T_{ab} = \\frac{\\alpha\\beta}{\\alpha+\\beta} (3 - \\frac{2\\alpha\\beta}{\\alpha+\\beta} |\\mathbf{R}_{AB}|^2) S_{ab}$.\n    -   Nuclear Attraction to center $\\mathbf{C}$: $V_{ab}^C = N_a N_b \\frac{-2\\pi Z_C}{p} \\exp(-\\frac{\\alpha\\beta}{p}|\\mathbf{R}_{AB}|^2) F_0(p|\\mathbf{R}_P - \\mathbf{R}_C|^2)$, where $\\mathbf{R}_P = (\\alpha\\mathbf{A}+\\beta\\mathbf{B})/p$ and $F_0(t)$ is the Boys function of order zero. $F_0(t) = \\frac{1}{2}\\sqrt{\\pi/t}\\,\\text{erf}(\\sqrt{t})$ for $t>0$ and $F_0(0)=1$.\n    -   ERI: For four primitives $a,b,c,d$, $(\\text{ab}|\\text{cd}) = N_a N_b N_c N_d \\frac{2\\pi^{5/2}}{pq\\sqrt{p+q}} \\exp(-\\frac{\\alpha_a\\alpha_b}{p}|\\mathbf{R}_{AB}|^2 - \\frac{\\alpha_c\\alpha_d}{q}|\\mathbf{R}_{CD}|^2) F_0(\\frac{pq}{p+q}|\\mathbf{R}_P - \\mathbf{R}_Q|^2)$, with analogous definitions for $q, \\mathbf{C}, \\mathbf{D}, \\mathbf{Q}$.\n\n3.  **Self-Consistent Field (SCF) Iteration**:\n    The SCF procedure iteratively solves the Roothaan-Hall equations, $FC = SC\\epsilon$, to find the optimal molecular orbitals (MOs), represented by the coefficient matrix $C$, and their corresponding energies $\\epsilon$.\n    \n    a.  An initial guess for the density matrix $P$ is formed (e.g., a null matrix).\n    b.  The two-electron matrix $G$ is constructed from $P$ and the ERI tensor: $G_{\\mu\\nu} = \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2}(\\mu\\lambda|\\nu\\sigma) \\right]$.\n    c.  The Fock matrix is formed: $F = H^\\mathrm{core} + G$.\n    d.  The generalized eigenvalue problem $FC = SC\\epsilon$ is solved, typically by transforming to an orthonormal basis.\n    e.  A new density matrix is constructed from the MO coefficients of the occupied orbitals. For $\\text{H}_2$, one orbital is occupied, so $P_{\\mu\\nu} = 2 C_{\\mu 1} C_{\\nu 1}$.\n    f.  The electronic energy is computed: $E_\\mathrm{elec} = \\frac{1}{2} \\sum_{\\mu\\nu} P_{\\nu\\mu}(H^\\mathrm{core}_{\\mu\\nu} + F_{\\mu\\nu})$. The total energy is $E_\\mathrm{tot} = E_\\mathrm{elec} + E_\\mathrm{nn}$, where the nuclear repulsion is $E_\\mathrm{nn} = Z_A Z_B/R$.\n    g.  Steps (b) through (f) are repeated until the total energy converges.\n\n4.  **Extraction of Results**:\n    Upon convergence, the total energy $E_\\mathrm{tot}$ is obtained. The eigenvalues $\\epsilon$ of the Fock matrix are the orbital energies. For $\\text{H}_2$, the lowest eigenvalue $\\epsilon_0$ is the HOMO energy, and the second-lowest, $\\epsilon_1$, is the LUMO energy. The program must compute these quantities for both the contracted and decontracted basis sets for each given value of $R$, and then report the differences: $(\\Delta E_\\mathrm{tot}, \\Delta\\varepsilon_\\mathrm{HOMO}, \\Delta\\varepsilon_\\mathrm{LUMO})$ where $\\Delta X = X_\\mathrm{decontracted} - X_\\mathrm{contracted}$.\n\nAccording to the variational principle, the decontracted basis, being more flexible, must yield a total energy that is less than or equal to that of the contracted basis. Thus, $\\Delta E_\\mathrm{tot}$ is expected to be negative.\n\n**Python Implementation**\n```python\nimport numpy as np\nfrom scipy.special import erf\nfrom scipy.linalg import eigh\n\nclass PGF:\n    \"\"\"Represents a primitive Gaussian function.\"\"\"\n    def __init__(self, exponent, center):\n        self.alpha = exponent\n        self.A = np.array(center, dtype=float)\n        self.N = (2 * self.alpha / np.pi)**0.75\n\ndef boys_function(n, T):\n    if n == 0:\n        if T  1e-9:\n            return 1.0\n        return 0.5 * np.sqrt(np.pi / T) * erf(np.sqrt(T))\n    else:\n        raise NotImplementedError(\"Boys function for n > 0 not implemented.\")\n\ndef s_integral(p1, p2):\n    p = p1.alpha + p2.alpha\n    R_AB2 = np.sum((p1.A - p2.A)**2)\n    return ((4 * p1.alpha * p2.alpha) / (p*p))**0.75 * np.exp(-p1.alpha * p2.alpha / p * R_AB2)\n\ndef t_integral(p1, p2):\n    p = p1.alpha + p2.alpha\n    R_AB2 = np.sum((p1.A - p2.A)**2)\n    s_ij = s_integral(p1, p2)\n    return p1.alpha * p2.alpha / p * (3 - 2 * p1.alpha * p2.alpha / p * R_AB2) * s_ij\n\ndef v_integral(p1, p2, R_C, Z_C):\n    p = p1.alpha + p2.alpha\n    R_AB2 = np.sum((p1.A - p2.A)**2)\n    R_P = (p1.alpha * p1.A + p2.alpha * p2.A) / p\n    R_PC2 = np.sum((R_P - R_C)**2)\n    K_ab = np.exp(-p1.alpha * p2.alpha / p * R_AB2)\n    F0 = boys_function(0, p * R_PC2)\n    return p1.N * p2.N * (-2 * np.pi * Z_C / p) * K_ab * F0\n\ndef eri_integral(p1, p2, p3, p4):\n    p = p1.alpha + p2.alpha\n    q = p3.alpha + p4.alpha\n    R_AB2 = np.sum((p1.A - p2.A)**2)\n    R_CD2 = np.sum((p3.A - p4.A)**2)\n    P = (p1.alpha * p1.A + p2.alpha * p2.A) / p\n    Q = (p3.alpha * p3.A + p4.alpha * p4.A) / q\n    R_PQ2 = np.sum((P - Q)**2)\n    term1 = 2 * np.pi**2.5 / (p * q * np.sqrt(p + q))\n    term2 = np.exp(-p1.alpha * p2.alpha / p * R_AB2 - p3.alpha * p4.alpha / q * R_CD2)\n    F0 = boys_function(0, p * q / (p + q) * R_PQ2)\n    return p1.N * p2.N * p3.N * p4.N * term1 * term2 * F0\n\ndef run_rhf(R, basis_type, exponents, coeffs):\n    centers = [np.array([-R/2, 0, 0]), np.array([R/2, 0, 0])]\n    nuclei_pos = centers\n    nuclei_charge = [1, 1]\n    n_elec = 2\n    basis_functions = []\n    if basis_type == 'contracted':\n        for center in centers:\n            prims = []\n            for exp, c in zip(exponents, coeffs):\n                prims.append((PGF(exp, center), c))\n            basis_functions.append(prims)\n    elif basis_type == 'decontracted':\n        for center in centers:\n            for exp in exponents:\n                prims = [(PGF(exp, center), 1.0)]\n                basis_functions.append(prims)\n    \n    num_basis_funcs = len(basis_functions)\n    S = np.zeros((num_basis_funcs, num_basis_funcs))\n    T = np.zeros((num_basis_funcs, num_basis_funcs))\n    V = np.zeros((num_basis_funcs, num_basis_funcs))\n    ERI = np.zeros((num_basis_funcs, num_basis_funcs, num_basis_funcs, num_basis_funcs))\n    for i in range(num_basis_funcs):\n        for j in range(i, num_basis_funcs):\n            sum_S, sum_T, sum_V = 0.0, 0.0, 0.0\n            for p1, c1 in basis_functions[i]:\n                for p2, c2 in basis_functions[j]:\n                    sum_S += c1 * c2 * s_integral(p1, p2)\n                    sum_T += c1 * c2 * t_integral(p1, p2)\n                    v_nuc = sum(v_integral(p1, p2, R_nuc, Z) for Z, R_nuc in zip(nuclei_charge, nuclei_pos))\n                    sum_V += c1 * c2 * v_nuc\n            S[i, j] = S[j, i] = sum_S\n            T[i, j] = T[j, i] = sum_T\n            V[i, j] = V[j, i] = sum_V\n\n    for i in range(num_basis_funcs):\n        for j in range(num_basis_funcs):\n            for k in range(num_basis_funcs):\n                for l in range(num_basis_funcs):\n                    sum_ERI = 0.0\n                    for p1, c1 in basis_functions[i]:\n                        for p2, c2 in basis_functions[j]:\n                            for p3, c3 in basis_functions[k]:\n                                for p4, c4 in basis_functions[l]:\n                                    sum_ERI += c1 * c2 * c3 * c4 * eri_integral(p1, p2, p3, p4)\n                    ERI[i, j, k, l] = sum_ERI\n\n    H_core = T + V\n    E_nuc = nuclei_charge[0] * nuclei_charge[1] / R\n    s_eigvals, s_eigvecs = eigh(S)\n    X = s_eigvecs @ np.diag(s_eigvals**-0.5) @ s_eigvecs.T\n    P = np.zeros((num_basis_funcs, num_basis_funcs))\n    E_total_old = 0.0\n    for iteration in range(100):\n        G = np.einsum('ls,mnls->mn', P, ERI) - 0.5 * np.einsum('ls,mlns->mn', P, ERI)\n        F = H_core + G\n        F_prime = X.T @ F @ X\n        eps, C_prime = eigh(F_prime)\n        C = X @ C_prime\n        num_occ = n_elec // 2\n        C_occ = C[:, :num_occ]\n        P_new = 2 * (C_occ @ C_occ.T)\n        E_elec = np.sum(P_new * (H_core + F)) * 0.5\n        E_total = E_elec + E_nuc\n        if abs(E_total - E_total_old)  1e-10:\n            break\n        P = P_new\n        E_total_old = E_total\n    \n    homo_energy = eps[num_occ - 1]\n    lumo_energy = eps[num_occ]\n    return E_total, homo_energy, lumo_energy\n```", "answer": "[[-0.01594960, -0.01186716, -0.01353139], [-0.01250266, -0.01089901, -0.01037233], [-0.00762699, -0.00418388, -0.00845347]]", "id": "2806505"}]}