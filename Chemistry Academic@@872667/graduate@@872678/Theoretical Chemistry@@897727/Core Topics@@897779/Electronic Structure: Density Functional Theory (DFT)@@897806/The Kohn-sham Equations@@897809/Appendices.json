{"hands_on_practices": [{"introduction": "While the exact Kohn-Sham (KS) functional would provide the exact energy and density, all practical applications rely on approximations. A fundamental failing of most approximate functionals is the self-interaction error (SIE), where an electron unphysically interacts with its own charge density. This exercise provides a direct and quantitative way to explore this error by first verifying that the exact theory is self-interaction-free for a one-electron system, and then calculating the residual SIE for the widely used Local Density Approximation (LDA) and a prototype Generalized Gradient Approximation (GGA) for the simple hydrogen atom [@problem_id:2901403].", "problem": "Consider a one-electron hydrogen atom in its nonrelativistic ground state within Kohn–Sham density functional theory (KS-DFT). The spatial orbital is the normalized hydrogenic $1s$ function and the electron is fully spin-polarized. Work in Hartree atomic units, so that the Bohr radius satisfies $a_0 = 1$, the electronic density is spherically symmetric and equals\n\n$$\nn(r) \\;=\\; \\frac{1}{\\pi}\\,\\exp(-2 r),\n$$\n\nand the system has exactly one electron.\n\nStarting from first principles and standard definitions, do the following:\n\n- Using the definition of the classical Hartree electrostatic energy,\n\n$$\nE_{\\mathrm{H}}[n] \\;=\\; \\frac{1}{2}\\int \\!\\! \\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}',\n$$\n\nand the Hartree–Fock exchange energy for a Slater determinant,\n\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi_i\\}] \\;=\\; -\\frac{1}{2}\\sum_{i,j}\\int \\!\\! \\int \\frac{\\varphi_i(\\mathbf{r})\\,\\varphi_j^{*}(\\mathbf{r})\\,\\varphi_j(\\mathbf{r}')\\,\\varphi_i^{*}(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}',\n$$\n\nverify from these definitions that for a one-electron system $E_{\\mathrm{H}} + E_{x}^{\\mathrm{exact}} = 0$, where $E_{x}^{\\mathrm{exact}}$ denotes the exact exchange energy functional evaluated on the given density.\n\n- Next, quantify the residual self-interaction error defined as $E_{\\mathrm{H}} + E_{x}^{\\mathrm{approx}}$ for two approximate exchange functionals:\n  1. The Local Density Approximation (LDA) exchange for spin-density functional theory,\n  \n$$\n  E_{x}^{\\mathrm{LDA}}[n_{\\uparrow},n_{\\downarrow}] \\;=\\; -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\int \\left(n_{\\uparrow}^{4/3} + n_{\\downarrow}^{4/3}\\right)\\,d\\mathbf{r},\n  $$\n\n  evaluated for the fully spin-polarized hydrogen density $n_{\\uparrow} = n$, $n_{\\downarrow} = 0$.\n  2. The second-order gradient expansion (a Generalized Gradient Approximation (GGA) prototype) for exchange,\n  \n$$\n  E_{x}^{\\mathrm{GEA2}}[n] \\;=\\; -C_{x}\\int n(\\mathbf{r})^{4/3}\\left[1 + \\mu\\,s(\\mathbf{r})^{2}\\right]\\,d\\mathbf{r},\n  $$\n\n  where $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$, $\\mu = \\frac{10}{81}$, the reduced gradient is $s(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|}{2 k_{F}(\\mathbf{r})\\,n(\\mathbf{r})}$, and the local Fermi wavevector is $k_{F}(\\mathbf{r}) = \\left(3\\pi^{2} n(\\mathbf{r})\\right)^{1/3}$.\n\nDerive analytic closed-form expressions for the two residual self-interaction errors,\n\n$$\n\\Delta_{\\mathrm{LDA}} \\;=\\; E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{LDA}}[n_{\\uparrow}=n,n_{\\downarrow}=0], \n\\quad\n\\Delta_{\\mathrm{GEA2}} \\;=\\; E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{GEA2}}[n],\n$$\n\nin terms of rational numbers and powers of $\\pi$ and $3$. Express the final answer as a row matrix $\\bigl[\\Delta_{\\mathrm{LDA}}\\;\\;\\Delta_{\\mathrm{GEA2}}\\bigr]$ and use Hartree ($\\mathrm{E_h}$) as the energy unit. No numerical rounding is required; provide exact expressions.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. All provided definitions, constants, and physical quantities are standard within the framework of density functional theory, or are explicitly defined for the purpose of the problem. The task is a rigorous and verifiable calculation. Therefore, the problem is deemed valid and a full solution will be provided.\n\nThe problem requires a two-part analysis of self-interaction in a one-electron system, specifically the hydrogen atom in its ground state. All calculations are performed in Hartree atomic units ($e=m_e=\\hbar=1$, $a_0=1$).\n\nPart 1: Verification of Exact Self-Interaction Cancellation\n\nFor any one-electron system, the ground-state electron density $n(\\mathbf{r})$ is given by the square of the single occupied orbital $\\varphi_1(\\mathbf{r})$, such that $n(\\mathbf{r}) = |\\varphi_1(\\mathbf{r})|^2$. Since the hydrogen $1s$ orbital is a real function, we have $n(\\mathbf{r}) = \\varphi_1(\\mathbf{r})^2$.\n\nThe Hartree energy is defined as:\n$$\nE_{\\mathrm{H}}[n] = \\frac{1}{2}\\int \\!\\! \\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'\n$$\nSubstituting $n(\\mathbf{r}) = \\varphi_1(\\mathbf{r})^2$, we get:\n$$\nE_{\\mathrm{H}}[n] = \\frac{1}{2}\\int \\!\\! \\int \\frac{\\varphi_1(\\mathbf{r})^2\\,\\varphi_1(\\mathbf{r}')^2}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'\n$$\nThe exact exchange energy, $E_{x}^{\\mathrm{exact}}$, is given by the Hartree-Fock exchange expression evaluated on the exact Kohn-Sham orbitals. For a one-electron system, there is only one orbital, $\\varphi_1$. The summations over $i$ and $j$ in the definition of $E_{x}^{\\mathrm{HF}}$ each have only one term, $i=j=1$.\n$$\nE_{x}^{\\mathrm{exact}} = E_{x}^{\\mathrm{HF}}[\\{\\varphi_1\\}] = -\\frac{1}{2}\\int \\!\\! \\int \\frac{\\varphi_1(\\mathbf{r})\\,\\varphi_1^{*}(\\mathbf{r})\\,\\varphi_1(\\mathbf{r}')\\,\\varphi_1^{*}(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'\n$$\nSince $\\varphi_1$ is real, $\\varphi_1^* = \\varphi_1$. The expression simplifies to:\n$$\nE_{x}^{\\mathrm{exact}} = -\\frac{1}{2}\\int \\!\\! \\int \\frac{\\varphi_1(\\mathbf{r})^2\\,\\varphi_1(\\mathbf{r}')^2}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'\n$$\nComparing this with the expression for the Hartree energy, we see that:\n$$\nE_{x}^{\\mathrm{exact}} = -E_{\\mathrm{H}}[n]\n$$\nTherefore, for any one-electron system, the sum of the Hartree energy and the exact exchange energy is identically zero:\n$$\nE_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{exact}} = 0\n$$\nThis demonstrates the exact cancellation of the self-interaction in the exact theory. Approximate functionals, however, do not typically satisfy this condition, leading to a residual self-interaction error.\n\nPart 2: Calculation of Residual Self-Interaction Errors\n\nWe must compute $\\Delta_{\\mathrm{LDA}} = E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{LDA}}[n]$ and $\\Delta_{\\mathrm{GEA2}} = E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{GEA2}}[n]$. The first step is to compute the Hartree energy $E_{\\mathrm{H}}$ for the given density, $n(r) = \\frac{1}{\\pi}\\exp(-2r)$.\n\nCalculation of the Hartree Energy, $E_{\\mathrm{H}}$\nThe Hartree energy is the electrostatic self-energy of the charge distribution $n(\\mathbf{r})$. It can be expressed as $E_{\\mathrm{H}} = \\frac{1}{2}\\int n(\\mathbf{r}) V_{\\mathrm{H}}(\\mathbf{r}) \\,d\\mathbf{r}$, where $V_{\\mathrm{H}}(\\mathbf{r})$ is the electrostatic potential generated by $n(\\mathbf{r})$. For a spherically symmetric density, the potential is:\n$$\nV_{\\mathrm{H}}(r) = \\frac{1}{r} \\int_0^r n(r') 4\\pi r'^2 dr' + \\int_r^\\infty \\frac{n(r') 4\\pi r'^2}{r'} dr'\n$$\nUsing $n(r) = \\frac{1}{\\pi}\\exp(-2r)$, the integrals yield $V_{\\mathrm{H}}(r) = \\frac{1}{r} - \\left(\\frac{1}{r}+1\\right)\\exp(-2r)$.\nNow we compute $E_{\\mathrm{H}}$:\n$$\nE_{\\mathrm{H}} = \\frac{1}{2} \\int_0^\\infty V_{\\mathrm{H}}(r) n(r) 4\\pi r^2 dr = \\frac{1}{2} \\int_0^\\infty \\left[\\frac{1}{r} - \\left(\\frac{1}{r}+1\\right)\\exp(-2r)\\right] \\left(\\frac{1}{\\pi}\\exp(-2r)\\right) 4\\pi r^2 dr\n$$\n$$\nE_{\\mathrm{H}} = 2 \\int_0^\\infty \\left[ r\\exp(-2r) - (r+r^2)\\exp(-4r) \\right] dr\n$$\nWe use the standard integral $\\int_0^\\infty x^k \\exp(-ax) dx = k!/a^{k+1}$:\n- $\\int_0^\\infty r\\exp(-2r) dr = 1!/2^2 = \\frac{1}{4}$\n- $\\int_0^\\infty r^2\\exp(-4r) dr = 2!/4^3 = \\frac{2}{64} = \\frac{1}{32}$\n- $\\int_0^\\infty r\\exp(-4r) dr = 1!/4^2 = \\frac{1}{16}$\nSubstituting these results:\n$$\nE_{\\mathrm{H}} = 2 \\left[ \\frac{1}{4} - \\left(\\frac{1}{16} + \\frac{1}{32}\\right) \\right] = 2 \\left[ \\frac{8}{32} - \\frac{2}{32} - \\frac{1}{32} \\right] = 2 \\left( \\frac{5}{32} \\right) = \\frac{5}{16}\n$$\n\nCalculation of the LDA Self-Interaction Error, $\\Delta_{\\mathrm{LDA}}$\nThe problem provides the LDA exchange energy functional for a spin-polarized system ($n_{\\uparrow}=n, n_{\\downarrow}=0$) as:\n$$\nE_{x}^{\\mathrm{LDA}}[n] = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\int n(\\mathbf{r})^{4/3}\\,d\\mathbf{r}\n$$\nWe compute the integral $\\int n(\\mathbf{r})^{4/3}\\,d\\mathbf{r}$:\n$$\n\\int n(r)^{4/3} 4\\pi r^2 dr = \\int_0^\\infty \\left(\\frac{1}{\\pi}\\exp(-2r)\\right)^{4/3} 4\\pi r^2 dr = 4\\pi \\pi^{-4/3} \\int_0^\\infty r^2 \\exp\\left(-\\frac{8}{3}r\\right) dr\n$$\n$$\n= 4\\pi^{-1/3} \\left( \\frac{2!}{(8/3)^3} \\right) = 4\\pi^{-1/3} \\left( \\frac{2}{512/27} \\right) = 4\\pi^{-1/3} \\left( \\frac{54}{512} \\right) = \\frac{27}{64}\\pi^{-1/3}\n$$\nNow we substitute this into the expression for $E_{x}^{\\mathrm{LDA}}$:\n$$\nE_{x}^{\\mathrm{LDA}} = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\left(\\frac{27}{64}\\pi^{-1/3}\\right) = -\\frac{3}{4} \\frac{3^{1/3}}{\\pi^{1/3}} \\frac{27}{64 \\pi^{1/3}} = -\\frac{81 \\cdot 3^{1/3}}{256 \\pi^{2/3}} = -\\frac{3^{4} \\cdot 3^{1/3}}{256 \\pi^{2/3}} = -\\frac{3^{13/3}}{256 \\pi^{2/3}}\n$$\nThe residual self-interaction error for LDA is:\n$$\n\\Delta_{\\mathrm{LDA}} = E_{\\mathrm{H}} + E_{x}^{\\mathrm{LDA}} = \\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}}\n$$\n\nCalculation of the GEA2 Self-Interaction Error, $\\Delta_{\\mathrm{GEA2}}$\nThe GEA2 exchange energy is given by:\n$$\nE_{x}^{\\mathrm{GEA2}}[n] = -C_{x}\\int n^{4/3}\\left[1 + \\mu\\,s^{2}\\right]\\,d\\mathbf{r} = E_{x}^{\\mathrm{LDA}} - C_x \\mu \\int n^{4/3}s^2\\,d\\mathbf{r}\n$$\nWe need to evaluate the gradient correction term. First, we find the reduced gradient $s$:\n$s = \\frac{|\\nabla n|}{2 k_F n}$, with $k_F = (3\\pi^2 n)^{1/3}$.\nFor the given density, $\\nabla n = \\frac{dn}{dr}\\hat{\\mathbf{r}} = -2 \\frac{1}{\\pi}\\exp(-2r) \\hat{\\mathbf{r}} = -2n\\hat{\\mathbf{r}}$, so $|\\nabla n| = 2n$.\n$$\ns = \\frac{2n}{2 (3\\pi^2 n)^{1/3} n} = \\frac{1}{(3\\pi^2 n)^{1/3}} \\implies s^2 = \\frac{1}{(3\\pi^2 n)^{2/3}} = \\frac{1}{3^{2/3}\\pi^{4/3}n^{2/3}}\n$$\nThe integrand of the correction term is $n^{4/3}s^2$:\n$$\nn^{4/3}s^2 = n^{4/3} \\frac{1}{3^{2/3}\\pi^{4/3}n^{2/3}} = \\frac{n^{2/3}}{3^{2/3}\\pi^{4/3}}\n$$\nThe gradient correction energy is:\n$$\n\\Delta E_{x}^{\\mathrm{GEA2}} = -C_x \\mu \\int \\frac{n^{2/3}}{3^{2/3}\\pi^{4/3}}\\,d\\mathbf{r} = -\\frac{C_x \\mu}{3^{2/3}\\pi^{4/3}} \\int n^{2/3}\\,d\\mathbf{r}\n$$\nWe compute the integral $\\int n^{2/3}\\,d\\mathbf{r}$:\n$$\n\\int n(r)^{2/3} 4\\pi r^2 dr = \\int_0^\\infty \\left(\\frac{1}{\\pi}\\exp(-2r)\\right)^{2/3} 4\\pi r^2 dr = 4\\pi \\pi^{-2/3} \\int_0^\\infty r^2 \\exp\\left(-\\frac{4}{3}r\\right) dr\n$$\n$$\n= 4\\pi^{1/3} \\left( \\frac{2!}{(4/3)^3} \\right) = 4\\pi^{1/3} \\left( \\frac{2}{64/27} \\right) = 4\\pi^{1/3} \\left( \\frac{54}{64} \\right) = \\frac{27}{8}\\pi^{1/3}\n$$\nSubstituting this back, along with $C_x = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$ and $\\mu = \\frac{10}{81}$:\n$$\n\\Delta E_{x}^{\\mathrm{GEA2}} = -\\left(\\frac{3}{4}\\frac{3^{1/3}}{\\pi^{1/3}}\\right) \\left(\\frac{10}{81}\\right) \\frac{1}{3^{2/3}\\pi^{4/3}} \\left(\\frac{27}{8}\\pi^{1/3}\\right)\n$$\n$$\n= -\\frac{3 \\cdot 10 \\cdot 27}{4 \\cdot 81 \\cdot 8} \\frac{3^{1/3}}{3^{2/3}} \\frac{\\pi^{1/3}}{\\pi^{1/3}\\pi^{4/3}} = -\\frac{810}{2592} \\cdot 3^{-1/3} \\pi^{-4/3} = -\\frac{5}{16} \\cdot 3^{-1/3} \\pi^{-4/3}\n$$\nThe total GEA2 exchange energy is $E_{x}^{\\mathrm{GEA2}} = E_{x}^{\\mathrm{LDA}} + \\Delta E_{x}^{\\mathrm{GEA2}}$. The residual self-interaction error is:\n$$\n\\Delta_{\\mathrm{GEA2}} = E_{\\mathrm{H}} + E_{x}^{\\mathrm{GEA2}} = \\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}} - \\frac{5}{16} 3^{-1/3} \\pi^{-4/3}\n$$\nThe final results are the expressions for $\\Delta_{\\mathrm{LDA}}$ and $\\Delta_{\\mathrm{GEA2}}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}}  \\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}} - \\frac{5 \\cdot 3^{-1/3}}{16 \\pi^{4/3}} \\end{pmatrix}}\n$$", "id": "2901403"}, {"introduction": "Beyond the self-interaction error inherent in many-electron systems, another profound challenge for KS-DFT is describing static (or strong) correlation. This type of correlation becomes dominant in situations where multiple electronic configurations are nearly degenerate, such as during the breaking of a chemical bond. This practice uses the classic case of $\\text{H}_2$ dissociation to conceptually illustrate the catastrophic failure of the restricted KS formalism, which forces both electrons into a single spatial orbital, leading to an unphysical description of the separated atoms [@problem_id:1407868].", "problem": "In the field of computational quantum chemistry, Density Functional Theory (DFT) is a widely used method. Consider a calculation on a hydrogen molecule, $\\text{H}_2$, using the Restricted Kohn-Sham (RKS) formalism. In the RKS method, for a singlet ground state like that of $\\text{H}_2$, both electrons are constrained to occupy the same spatial Kohn-Sham orbital. This approach provides a reasonable description of the molecule near its equilibrium bond length. However, as the internuclear distance $R$ is increased towards dissociation ($R \\to \\infty$), the RKS calculation yields a total energy that is qualitatively incorrect, converging to a value significantly higher than the true energy of two separate, neutral hydrogen atoms. This failure is a classic example of static (or strong) correlation error.\n\nWhich of the following statements provides the most accurate physical explanation for this fundamental failure of the RKS method for $\\text{H}_2$ at large internuclear distances?\n\nA. The RKS wavefunction for the singlet state becomes heavily contaminated by triplet state character as the bond is stretched, leading to an incorrect spin state and artificially high energy.\n\nB. The error is due to the use of a finite atomic orbital basis set. As the atoms move apart, the overlap between basis functions on different centers vanishes, and a minimal basis set becomes incapable of describing the dissociated fragments.\n\nC. The restricted formalism forces both electrons into the same spatial molecular orbital. At large separations, this orbital is an equal combination of atomic orbitals on both centers, leading to an unphysical 50% contribution from ionic states (H⁺H⁻), which have a much higher energy than the correct dissociated state of two neutral H atoms.\n\nD. The error arises because the Born-Oppenheimer approximation, which assumes stationary nuclei, breaks down for large internuclear separations, and the coupling between electronic and nuclear motion becomes the dominant energetic contribution.\n\nE. The failure is exclusively due to the self-interaction error present in most approximate exchange-correlation functionals. This error causes each electron to unphysically repel its own charge density, and this spurious repulsion becomes catastrophically large as the molecule dissociates.", "solution": "We analyze the Restricted Kohn-Sham (RKS) description of the $\\text{H}_{2}$ singlet as the bond is stretched. In the RKS formalism for a closed-shell singlet, both electrons occupy the same spatial Kohn-Sham orbital $\\varphi$, while the spin part is the singlet. The spatial part of the total wavefunction is then $\\varphi(1)\\varphi(2)$, and the total many-electron state is constructed as the single doubly occupied Slater determinant times the singlet spin function.\n\nNear equilibrium, the bonding Kohn-Sham molecular orbital can be written in the minimal picture (and becomes exact in the limit of vanishing overlap) as the gerade combination of atomic $1s$ orbitals on the two hydrogen centers $A$ and $B$:\n$$\n\\varphi_{g}=\\frac{\\phi_{A}+\\phi_{B}}{\\sqrt{2(1+S_{AB})}},\n$$\nwhere $S_{AB}=\\int \\phi_{A}(\\mathbf{r})\\phi_{B}(\\mathbf{r})\\,d\\mathbf{r}$ is the overlap. As $R\\to\\infty$, one has $S_{AB}\\to 0$, and thus\n$$\n\\varphi_{g}\\xrightarrow[R\\to\\infty]{}\\frac{\\phi_{A}+\\phi_{B}}{\\sqrt{2}}.\n$$\nWith restricted double occupation, the spatial part of the RKS wavefunction is\n$$\n\\varphi_{g}(1)\\varphi_{g}(2)=\\frac{1}{2}\\left(\\phi_{A}(1)+\\phi_{B}(1)\\right)\\left(\\phi_{A}(2)+\\phi_{B}(2)\\right),\n$$\nwhich expands to\n$$\n\\varphi_{g}(1)\\varphi_{g}(2)=\\frac{1}{2}\\Big[\\underbrace{\\phi_{A}(1)\\phi_{B}(2)+\\phi_{B}(1)\\phi_{A}(2)}_{\\text{covalent terms}}+\\underbrace{\\phi_{A}(1)\\phi_{A}(2)+\\phi_{B}(1)\\phi_{B}(2)}_{\\text{ionic terms}}\\Big].\n$$\nThus, in the large-$R$ limit, the RKS spatial wavefunction has a fixed $50$-$50$ mixture of covalent and ionic components. The correct dissociation limit for the singlet state is the Heitler-London form with purely covalent character,\n$$\n\\Psi_{\\text{HL}}=\\frac{1}{\\sqrt{2}}\\left[\\phi_{A}(1)\\phi_{B}(2)+\\phi_{B}(1)\\phi_{A}(2)\\right]\\chi_{\\text{singlet}},\n$$\nwhich contains no ionic terms $\\phi_{A}(1)\\phi_{A}(2)$ or $\\phi_{B}(1)\\phi_{B}(2)$. The ionic components in the RKS wavefunction correspond to the unphysical charge-separated configurations $\\text{H}^{+}\\text{H}^{-}$ and $\\text{H}^{-}\\text{H}^{+}$, which lie much higher in energy than two neutral, noninteracting hydrogen atoms at large $R$. Because the restricted formalism enforces double occupation of a single spatial orbital, it cannot remove these ionic components as $R\\to\\infty$, and the energy therefore remains too high, exhibiting the classic static correlation error.\n\nWe now assess the options:\n\n- Option A is incorrect: RKS enforces a pure singlet (eigenfunction of $\\hat{S}^{2}$). There is no triplet contamination by construction; spin symmetry breaking (and any associated spin contamination) would occur only in an unrestricted treatment.\n- Option B is incorrect: Even with a complete basis set, restricted double occupation enforces the ionic admixture shown above; the failure is not due to basis set incompleteness.\n- Option C is correct: The restricted constraint forces both electrons into the same delocalized bonding orbital, yielding an unavoidable $50$ percent ionic contribution at large $R$, which is unphysical for the dissociation limit and raises the energy far above the exact two-atom limit.\n- Option D is incorrect: The Born-Oppenheimer approximation does not break down in a way that explains this error for electronic dissociation curves of $\\text{H}_{2}$; the dominant issue here is electronic static correlation.\n- Option E is incorrect as stated: While self-interaction error in approximate functionals contributes to dissociation problems in DFT, the fundamental failure described occurs even in restricted Hartree-Fock, which has no one-electron self-interaction. Therefore it is not exclusively due to self-interaction error.\n\nHence, the most accurate physical explanation among the given choices is the enforced double occupancy causing unphysical ionic admixture at large separations.", "answer": "$$\\boxed{C}$$", "id": "1407868"}, {"introduction": "To better understand and unify the concepts of self-interaction and static correlation, theoretical chemists often use simplified models that capture the essential physics of functional errors. This exercise introduces a powerful two-site model to analyze the behavior of approximate functionals in scenarios involving fractional charges and fractional spins, which are closely related to delocalization error and static correlation error, respectively [@problem_id:2815502]. By calculating these distinct error types, you will gain deeper insight into how the violation of the exact piecewise linearity condition of the energy functional manifests in practical calculations.", "problem": "Consider a two-site, one-orbital-per-site dissociation-limit model for a stretched diatomic, intended to capture the essential self-interaction and delocalization features of Kohn-Sham density functional theory (Kohn-Sham DFT). You will build a quantitative diagnostic for many-electron self-interaction error by comparing a simplified exact reference (consistent with ensemble density functional theory) to a toy approximate functional that violates the exact flat-plane conditions. Work in atomic units (Hartree), so all energies must be reported in Hartree.\n\nFundamental base and modeling assumptions:\n- The Hohenberg-Kohn theorems and ensemble density functional theory imply exact piecewise linearity of the ground-state energy with respect to the total electron number and constancy of the energy for ensembles of degenerate spin states. In this dissociation-limit model, each site supports at most one electron.\n- For an isolated site with a single electron, the exact site energy is linear in the occupation: if the total on-site occupation is $n \\in [0,1]$, the exact site contribution is $-I \\, n$, where $I$ is the first ionization energy of the corresponding atom. For hydrogen in atomic units, $I \\approx 0.5$.\n- Site asymmetry is modeled by an energy bias $\\Delta$ (in Hartree) so that the one-electron energy on site $A$ is $-I_{A} = -(I + \\Delta/2)$ and on site $B$ is $-I_{B} = -(I - \\Delta/2)$. Positive $\\Delta$ makes site $A$ more favorable.\n- Many-electron self-interaction and delocalization errors of a typical approximate density functional are modeled by two scalar error coefficients:\n  1. A charge-curvature coefficient $c$ (in Hartree) multiplying $n(1-n)$ per site, which vanishes at integer occupations and is maximized at $n = 1/2$. Negative $c$ induces convex deviation below the straight line between integers, favoring delocalized fractional charge.\n  2. A spin-curvature coefficient $s$ (in Hartree) multiplying $n_{\\uparrow} n_{\\downarrow}$ per site, which is zero for pure-spin densities and maximized at equal-spin mixtures. Positive $s$ penalizes fractional spin ensembles, creating an erroneous energy maximum at half-and-half spin mixture.\n- In the dissociation limit, noninteracting kinetic contributions are negligible for localized orbitals, and Hartree plus exact exchange cancel self-interaction exactly for one electron per site in the exact reference. We therefore ignore kinetic and explicit electron-electron terms beyond the above model corrections.\n\nDefinitions and tasks:\n- Let the on-site spin occupations be $n_{A\\uparrow}$, $n_{A\\downarrow}$ and $n_{B\\uparrow}$, $n_{B\\downarrow}$. For each site $i \\in \\{A,B\\}$, the total occupation is $n_i = n_{i\\uparrow} + n_{i\\downarrow}$, with $0 \\le n_i \\le 1$ in the dissociation limit.\n- The exact site energy model is $E_{\\text{exact},i} = -I_i \\, n_i$ and the total exact energy is $E_{\\text{exact}} = \\sum_i E_{\\text{exact},i}$.\n- The toy approximate site energy is $E_{\\text{approx},i} = -I_i \\, n_i + c \\, n_i (1 - n_i) + s \\, n_{i\\uparrow} n_{i\\downarrow}$ and the total approximate energy is $E_{\\text{approx}} = \\sum_i E_{\\text{approx},i}$.\n\nYour program must, for each parameter set $(I, c, s, \\Delta)$ provided in the test suite, compute two diagnostics in Hartree:\n1. Fractional-charge delocalization error for stretched $\\text{H}_2^+$ (one electron in total):\n   - Model the one-electron system with total occupation $n_A + n_B = 1$. To isolate fractional charge effects, assume spin-pure densities at each site, so $n_{i\\downarrow} = 0$ and $n_{i\\uparrow} = n_i$ for both $i \\in \\{A,B\\}$.\n   - Let $\\alpha \\in [0,1]$ denote the fraction of the electron on site $A$ so that $n_A = \\alpha$ and $n_B = 1 - \\alpha$.\n   - The exact minimum energy is the lower of the two site linear energies at integer localization. The approximate minimum energy is obtained by minimizing the approximate total energy over $\\alpha \\in [0,1]$.\n   - Define the delocalization error as $\\Delta E_{\\text{charge}} = E_{\\text{approx}}^{\\min} - E_{\\text{exact}}^{\\min}$ in Hartree. Negative $\\Delta E_{\\text{charge}}$ indicates spurious lowering (delocalization error).\n2. Fractional-spin error for stretched $\\text{H}_2$ (two electrons in total):\n   - Enforce one electron per site in the dissociation limit, $n_A = n_B = 1$.\n   - Consider the ensemble with half-and-half spin mixing on each site but with opposite local polarizations to produce total $S_z = 0$: on site $A$, take $n_{A\\uparrow} = 1/2$ and $n_{A\\downarrow} = 1/2$, while on site $B$, take $n_{B\\uparrow} = 1/2$ and $n_{B\\downarrow} = 1/2$.\n   - The exact energy is independent of fractional spin and equals the sum of linear site energies at $n_A = n_B = 1$. The approximate energy includes the spin-curvature terms.\n   - Define the fractional-spin error as $\\Delta E_{\\text{spin}} = E_{\\text{approx}}(\\text{half-and-half spin}) - E_{\\text{exact}}$ in Hartree. Positive $\\Delta E_{\\text{spin}}$ indicates an erroneous energy elevation at fractional spin.\n\nAngle units are not involved. All outputs are energies in Hartree. Round each reported float to six decimal places.\n\nTest suite:\n- Case 1 (symmetric, clear delocalization and spin errors): $I = 0.5$, $c = -0.20$, $s = 0.30$, $\\Delta = 0.0$.\n- Case 2 (mild asymmetry): $I = 0.5$, $c = -0.10$, $s = 0.20$, $\\Delta = 0.15$.\n- Case 3 (no charge curvature): $I = 0.5$, $c = 0.0$, $s = 0.25$, $\\Delta = 0.0$.\n- Case 4 (strong charge curvature, strong asymmetry, no spin curvature): $I = 0.5$, $c = -0.50$, $s = 0.0$, $\\Delta = 0.60$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results for the test cases as a comma-separated list enclosed in square brackets. Each element of this list corresponds to one test case and must itself be a two-element list in the order $[\\Delta E_{\\text{charge}}, \\Delta E_{\\text{spin}}]$. For example, the printed line must look like: [[x1,y1],[x2,y2],[x3,y3],[x4,y4]], where each $x_i$ and $y_i$ is a float in Hartree rounded to six decimal places.", "solution": "The problem statement is scientifically well-posed, complete, and contains no contradictions. It describes a valid and common toy model used in theoretical chemistry to analyze and understand self-interaction errors in density functional theory. We will therefore proceed with the derivation of the two requested error diagnostics.\n\nFirst, we analyze the fractional-charge delocalization error, $\\Delta E_{\\text{charge}}$, for the one-electron system, which serves as a model for stretched $\\text{H}_2^+$. The total number of electrons is $1$. The electron's distribution is described by a parameter $\\alpha$, where site $A$ has occupation $n_A = \\alpha$ and site $B$ has occupation $n_B = 1-\\alpha$, with $\\alpha \\in [0,1]$. The site ionization energies are defined as $I_A = I + \\Delta/2$ and $I_B = I - \\Delta/2$.\n\nThe total exact energy is a linear function of $\\alpha$:\n$$E_{\\text{exact}}(\\alpha) = -I_A n_A - I_B n_B = -(I + \\Delta/2)\\alpha - (I - \\Delta/2)(1-\\alpha) = -I - \\Delta\\alpha + \\Delta/2$$\nThe minimum of a linear function on the closed interval $[0,1]$ must occur at an endpoint. The minimal exact energy is therefore:\n$$E_{\\text{exact}}^{\\min} = \\min(E_{\\text{exact}}(0), E_{\\text{exact}}(1)) = \\min(-I_B, -I_A) = \\min(-(I-\\Delta/2), -(I+\\Delta/2)) = -(I + |\\Delta|/2)$$\n\nFor this one-electron system, the problem specifies spin-pure densities ($n_{i\\downarrow}=0$), so the approximate energy on site $i$ is $E_{\\text{approx},i} = -I_i n_i + c \\, n_i(1-n_i)$, as the spin-curvature term $s \\, n_{i\\uparrow}n_{i\\downarrow}$ is zero. The total approximate energy is the sum over both sites:\n$$E_{\\text{approx}}(\\alpha) = \\left[-I_A \\alpha + c\\alpha(1-\\alpha)\\right] + \\left[-I_B(1-\\alpha) + c(1-\\alpha)\\alpha\\right]$$\n$$E_{\\text{approx}}(\\alpha) = E_{\\text{exact}}(\\alpha) + 2c\\alpha(1-\\alpha) = -2c\\alpha^2 + (2c-\\Delta)\\alpha - I + \\Delta/2$$\nThis is a quadratic function of $\\alpha$. To find its minimum, $E_{\\text{approx}}^{\\min}$, on the interval $\\alpha \\in [0,1]$, we analyze its derivative with respect to $\\alpha$:\n$$\\frac{dE_{\\text{approx}}}{d\\alpha} = -4c\\alpha + 2c - \\Delta$$\nSetting the derivative to zero yields the extremum at $\\alpha_{ext} = \\frac{2c-\\Delta}{4c} = \\frac{1}{2} - \\frac{\\Delta}{4c}$, for $c \\neq 0$. The nature of this extremum depends on the second derivative, $\\frac{d^2E_{\\text{approx}}}{d\\alpha^2} = -4c$.\n\n- If $c \\geq 0$, the function is concave or linear. The minimum on $[0,1]$ must be at an endpoint, $\\alpha=0$ or $\\alpha=1$. At these integer occupations, the $c \\cdot n_i(1-n_i)$ terms are zero, so $E_{\\text{approx}}^{\\min} = E_{\\text{exact}}^{\\min}$. Thus, for $c \\geq 0$, the delocalization error is $\\Delta E_{\\text{charge}} = 0$.\n- If $c  0$, the function is convex, and $\\alpha_{ext}$ corresponds to a minimum. The minimum value on the interval $[0,1]$ is found by evaluating $E_{\\text{approx}}(\\alpha)$ at $\\alpha^* = \\max(0, \\min(1, \\alpha_{ext}))$. Let this minimum value be $E_{\\text{approx}}^{\\min}$.\n\nThe delocalization error is then calculated as $\\Delta E_{\\text{charge}} = E_{\\text{approx}}^{\\min} - E_{\\text{exact}}^{\\min}$.\n\nSecond, we analyze the fractional-spin error, $\\Delta E_{\\text{spin}}$, for the two-electron system ($\\text{H}_2$ model). The problem specifies a total occupation of one electron per site, $n_A = 1$ and $n_B = 1$. The state under consideration is a non-polarized spin ensemble defined by local occupations $n_{A\\uparrow}=n_{A\\downarrow}=1/2$ and $n_{B\\uparrow}=n_{B\\downarrow}=1/2$.\n\nThe exact energy is independent of the spin distribution for a fixed integer occupation. It is given by the sum of the linear site energies:\n$$E_{\\text{exact}} = -I_A n_A - I_B n_B = -I_A(1) - I_B(1) = -(I + \\Delta/2) - (I - \\Delta/2) = -2I$$\n\nThe approximate energy is calculated using the full site energy expression, $E_{\\text{approx},i} = -I_i n_i + c \\, n_i(1-n_i) + s \\, n_{i\\uparrow}n_{i\\downarrow}$.\nFor each site $i \\in \\{A, B\\}$, since $n_i=1$, the charge-curvature term $c \\, n_i(1-n_i)$ is zero. The spin-curvature term for each site is $s \\, n_{i\\uparrow}n_{i\\downarrow} = s(1/2)(1/2) = s/4$.\nThe total approximate energy is:\n$$E_{\\text{approx}} = \\sum_{i \\in \\{A,B\\}} \\left(-I_i(1) + c(1)(0) + s/4 \\right) = (-I_A + s/4) + (-I_B + s/4) = -2I + s/2$$\n\nThe fractional-spin error is the difference between the approximate and exact energies for this state:\n$$\\Delta E_{\\text{spin}} = E_{\\text{approx}} - E_{\\text{exact}} = (-2I + s/2) - (-2I) = s/2$$\nThis error is determined solely by the spin-curvature parameter $s$, as designed by the model.\n\nThese derived formulae are implemented below to compute the diagnostics for each test case.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates delocalization and fractional-spin errors for a two-site model\n    of a diatomic molecule in the dissociation limit, based on concepts from\n    Kohn-Sham DFT.\n    \"\"\"\n    test_cases = [\n        # (I, c, s, Delta)\n        # Case 1: symmetric, clear delocalization and spin errors\n        (0.5, -0.20, 0.30, 0.0),\n        # Case 2: mild asymmetry\n        (0.5, -0.10, 0.20, 0.15),\n        # Case 3: no charge curvature\n        (0.5, 0.0, 0.25, 0.0),\n        # Case 4: strong charge curvature, strong asymmetry, no spin curvature\n        (0.5, -0.50, 0.0, 0.60),\n    ]\n\n    all_results = []\n    \n    for I, c, s, delta in test_cases:\n        # --- Part 1: Fractional-charge delocalization error (Delta E_charge) ---\n\n        # The exact minimum energy for the one-electron system is determined by\n        # the electron localizing on the more favorable site.\n        E_exact_min = -(I + abs(delta) / 2.0)\n        \n        delta_E_charge = 0.0\n        if c  0:\n            # For c  0, the approximate energy function is convex and may have a\n            # minimum at a fractional charge distribution.\n            # The vertex of the quadratic E_approx(alpha) is at:\n            alpha_ext = 0.5 - delta / (4.0 * c)\n            \n            # The minimum on the interval [0, 1] is at alpha_ext if it falls\n            # within the interval, otherwise it's at the boundary.\n            alpha_star = np.clip(alpha_ext, 0.0, 1.0)\n            \n            # The total approximate energy is E_approx = E_exact + correction.\n            # E_exact(alpha) = -I - delta*alpha + delta/2\n            E_exact_at_alpha_star = -I - delta * alpha_star + delta / 2.0\n            correction_term = 2.0 * c * alpha_star * (1.0 - alpha_star)\n            E_approx_min = E_exact_at_alpha_star + correction_term\n            \n            delta_E_charge = E_approx_min - E_exact_min\n        \n        # --- Part 2: Fractional-spin error (Delta E_spin) ---\n        \n        # This error is calculated for a two-electron system (one per site)\n        # with a half-and-half spin mixture on each site.\n        # The error evaluates to s/2.\n        delta_E_spin = s / 2.0\n        \n        all_results.append([delta_E_charge, delta_E_spin])\n\n    # --- Final Output Formatting ---\n    # The output must be a single line, formatted as a list of lists of floats,\n    -    # with each float rounded to six decimal places.\n    # Ex: [[x1,y1],[x2,y2],[x3,y3],[x4,y4]]\n    \n    formatted_pairs = []\n    for res_pair in all_results:\n        # The :.6f format specifier handles both rounding and padding with zeros.\n        formatted_pairs.append(f\"[{res_pair[0]:.6f},{res_pair[1]:.6f}]\")\n    \n    final_output = f\"[{','.join(formatted_pairs)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2815502"}]}