{"hands_on_practices": [{"introduction": "A deep understanding of the rotational partition function begins with quantifying the energy scale of molecular rotation. This is captured by the characteristic rotational temperature, $\\Theta_{rot}$, which delineates the boundary between quantum behavior at low temperatures and classical behavior at high temperatures. This foundational exercise [@problem_id:1991123] guides you through the calculation of this parameter for carbon monoxide, a molecule of great astrophysical importance, translating its microscopic properties like bond length and atomic masses into a key thermodynamic quantity.", "problem": "In the study of interstellar molecular clouds, carbon monoxide (CO) is a critical tracer molecule used to map the structure and dynamics of these vast regions. To accurately model the thermal properties of CO gas at low temperatures, one must first determine its characteristic rotational temperature, $\\Theta_{rot}$. This temperature defines the scale at which the molecule's rotational energy levels become significantly populated.\n\nConsider a single, isolated carbon monoxide molecule, specifically the most common isotopologue, $^{12}$C$^{16}$O. Treat this molecule as a rigid rotor for this calculation.\n\nGiven the following data:\n- The equilibrium bond length of the molecule, $r = 1.128 \\times 10^{-10}$ m.\n- The mass of a Carbon-12 atom, $m_C = 1.993 \\times 10^{-26}$ kg.\n- The mass of an Oxygen-16 atom, $m_O = 2.657 \\times 10^{-26}$ kg.\n- The reduced Planck constant, $\\hbar = 1.055 \\times 10^{-34}$ J$\\cdot$s.\n- The Boltzmann constant, $k_B = 1.381 \\times 10^{-23}$ J/K.\n\nCalculate the characteristic rotational temperature $\\Theta_{rot}$ for this CO molecule. Express your answer in Kelvin (K), rounded to three significant figures.", "solution": "For a linear rigid rotor, the rotational energy levels are $E_{J} = \\frac{\\hbar^{2}}{2I}J(J+1)$. The characteristic rotational temperature, $\\Theta_{rot}$, is defined from this energy scale by the relation $\\frac{\\hbar^{2}}{2I} = k_B \\Theta_{rot}$, giving\n$$\n\\Theta_{rot} = \\frac{\\hbar^{2}}{2 I k_{B}}.\n$$\nFor a diatomic molecule treated as a rigid rotor, the moment of inertia is $I = \\mu r^{2}$ with reduced mass $\\mu = \\frac{m_{C} m_{O}}{m_{C} + m_{O}}$. Using the given data,\n$$\n\\mu = \\frac{(1.993 \\times 10^{-26})(2.657 \\times 10^{-26})}{(1.993 \\times 10^{-26}) + (2.657 \\times 10^{-26})}\n= \\frac{5.295401 \\times 10^{-52}}{4.650 \\times 10^{-26}}\n= 1.13880731 \\times 10^{-26}\\ \\text{kg}.\n$$\nThen\n$$\nI = \\mu r^{2} = (1.13880731 \\times 10^{-26})(1.128 \\times 10^{-10})^{2}\n= (1.13880731 \\times 1.272384) \\times 10^{-46}\n= 1.44900020 \\times 10^{-46}\\ \\text{kg}\\,\\text{m}^{2}.\n$$\nSubstitute into the expression for $\\Theta_{rot}$:\n$$\n\\Theta_{rot} = \\frac{(1.055 \\times 10^{-34})^{2}}{2 \\cdot (1.44900020 \\times 10^{-46}) \\cdot (1.381 \\times 10^{-23})}.\n$$\nCompute numerator and denominator:\n$$\n\\hbar^{2} = 1.113025 \\times 10^{-68}, \\quad\n2 I k_{B} = (2.89800040 \\times 10^{-46})(1.381 \\times 10^{-23}) = 4.00213855 \\times 10^{-69}.\n$$\nTherefore,\n$$\n\\Theta_{rot} = \\frac{1.113025 \\times 10^{-68}}{4.00213855 \\times 10^{-69}} = \\frac{1.113025}{4.00213855} \\times 10 \\approx 2.781.\n$$\nRounded to three significant figures, the characteristic rotational temperature is $2.78$ K.", "answer": "$$\\boxed{2.78}$$", "id": "1991123"}, {"introduction": "The rigid rotor is a cornerstone model, but its assumptions break down for rapidly rotating molecules. Real chemical bonds stretch under centrifugal force, an effect that must be accounted for in accurate spectroscopic and thermodynamic models. This practice [@problem_id:1991133] challenges you to move beyond the rigid rotor approximation by deriving the first-order correction to the rotational partition function due to centrifugal distortion, illustrating how perturbation methods are used to build more realistic molecular theories.", "problem": "The rotational energy levels of a simple rigid diatomic molecule are often approximated by the expression $E_J^{\\text{rigid}} = hcB J(J+1)$, where $J$ is the rotational quantum number, $h$ is Planck's constant, $c$ is the speed of light, and $B$ is the rotational constant. However, real molecules are not perfectly rigid. As a molecule rotates faster (i.e., at higher $J$), the bond between the atoms stretches due to centrifugal force. This effect, known as centrifugal distortion, lowers the energy levels. A more accurate expression for the rotational energy levels, including the first-order correction for centrifugal distortion, is given by:\n$$E_J = hc[B J(J+1) - D J^2(J+1)^2]$$\nHere, $D$ is the centrifugal distortion constant, which is a small positive constant with $D \\ll B$.\n\nConsider a heteronuclear diatomic molecule at a high absolute temperature $T$, such that $k_B T \\gg hcB$, where $k_B$ is the Boltzmann constant. Derive an approximate expression for the molecular rotational partition function, $q_R$, that incorporates this first-order centrifugal distortion correction. Your final expression should be in terms of $T$, $B$, $D$, and the fundamental constants $h$, $c$, and $k_B$.", "solution": "The rotational partition function for a heteronuclear diatomic rotor with centrifugal distortion is defined by\n$$\nq_{R}=\\sum_{J=0}^{\\infty}(2J+1)\\exp\\!\\left[-\\frac{E_{J}}{k_{B}T}\\right],\n$$\nwith energy levels\n$$\nE_{J}=hc\\left[BJ(J+1)-DJ^{2}(J+1)^{2}\\right],\n$$\nwhere $D\\ll B$ and $T$ is high such that $k_{B}T\\gg hcB$. Define $\\beta=1/(k_{B}T)$ and set\n$$\na=\\beta hcB,\\qquad b=\\beta hcD.\n$$\nThen\n$$\nq_{R}=\\sum_{J=0}^{\\infty}(2J+1)\\exp\\!\\left[-aJ(J+1)+bJ^{2}(J+1)^{2}\\right].\n$$\nFor $D\\ll B$, expand the Boltzmann factor to first order in $D$:\n$$\n\\exp\\!\\left[-aJ(J+1)+bJ^{2}(J+1)^{2}\\right]\\approx \\exp\\!\\left[-aJ(J+1)\\right]\\left[1+bJ^{2}(J+1)^{2}\\right].\n$$\nAt high temperature, many $J$ are populated, and the sum can be approximated by an integral:\n$$\nq_{R}\\approx\\int_{0}^{\\infty}(2J+1)\\exp\\!\\left[-aJ(J+1)\\right]\\left[1+bJ^{2}(J+1)^{2}\\right]\\,dJ.\n$$\nLet $y=J(J+1)$ so that $dy=(2J+1)\\,dJ$. Then\n$$\nq_{R}\\approx \\int_{0}^{\\infty}\\exp(-ay)\\,dy + b\\int_{0}^{\\infty}y^{2}\\exp(-ay)\\,dy.\n$$\nUsing the standard integral $\\int_{0}^{\\infty}y^{n}\\exp(-ay)\\,dy=\\frac{n!}{a^{n+1}}$ for $a>0$, we obtain\n$$\n\\int_{0}^{\\infty}\\exp(-ay)\\,dy=\\frac{1}{a},\\qquad \\int_{0}^{\\infty}y^{2}\\exp(-ay)\\,dy=\\frac{2}{a^{3}}.\n$$\nTherefore,\n$$\nq_{R}\\approx \\frac{1}{a}+\\frac{2b}{a^{3}}.\n$$\nSubstituting back $a=\\frac{hcB}{k_{B}T}$ and $b=\\frac{hcD}{k_{B}T}$ gives\n$$\nq_{R}\\approx \\frac{k_{B}T}{hcB}+\\frac{2D(k_{B}T)^{2}}{(hc)^{2}B^{3}}=\\frac{k_{B}T}{hcB}\\left[1+\\frac{2D}{B^{2}}\\frac{k_{B}T}{hc}\\right].\n$$\nThis result is valid in the joint limit $k_{B}T\\gg hcB$ and $\\frac{D}{B^{2}}\\frac{k_{B}T}{hc}\\ll 1$, ensuring that the first-order expansion in $D$ is adequate.", "answer": "$$\\boxed{\\frac{k_{B}T}{hcB}\\left(1+\\frac{2D}{B^{2}}\\frac{k_{B}T}{hc}\\right)}$$", "id": "1991133"}, {"introduction": "Analytical approximations for the partition function are powerful, but their accuracy is limited to specific temperature regimes. To handle arbitrary conditions and validate our approximations, we turn to numerical computation, a critical skill for any modern theoretical chemist. In this capstone exercise [@problem_id:2821764], you will implement an algorithm for the exact numerical summation of the rotational partition function and compare its results against the classical approximations, gaining a profound, quantitative feel for the convergence of the quantum sum and the validity of its asymptotic limits.", "problem": "You are asked to design a program that computes and analyzes the rotational partition function of a gas-phase linear rigid rotor using numerical summation and asymptotic approximations. Your implementation must rely only on fundamental statistical mechanics definitions and well-tested spectroscopic facts.\n\nThe fundamental base you must use is:\n- The canonical (configurational) partition function definition: for a set of discrete energy levels $\\{E_i\\}$ with degeneracies $\\{g_i\\}$, the single-molecule partition function is $q = \\sum_i g_i \\exp(-\\beta E_i)$, where $\\beta = 1/(k_{\\mathrm{B}} T)$, $T$ is the absolute temperature in kelvin, and $k_{\\mathrm{B}}$ is the Boltzmann constant.\n- For a linear rigid rotor with moment of inertia $I$, the quantum rotational energy levels are $E_J = \\dfrac{\\hbar^2}{2 I} J (J+1)$ for nonnegative integers $J$, with degeneracy $g_J = 2J+1$. Equivalently, using the spectroscopic rotational constant $\\tilde{B}$ in inverse centimeters, $E_J = h c \\tilde{B} J(J+1)$, where $h$ is Planck's constant and $c$ is the speed of light. Define the rotational temperature $\\theta_{\\mathrm{rot}} = \\dfrac{h c \\tilde{B}}{k_{\\mathrm{B}}}$ so that the Boltzmann factor is $\\exp\\!\\big(-\\theta_{\\mathrm{rot}} J(J+1)/T\\big)$.\n- For homonuclear linear rotors, include the symmetry number $\\sigma$ (an integer, e.g., $\\sigma = 2$ for a diatomic with indistinguishable ends) by dividing the rotational partition function by $\\sigma$.\n\nTask requirements:\n1) Implement an adaptive numerical summation for the single-molecule rotational partition function of a linear rigid rotor,\n$$\nq_{\\mathrm{rot}}(T,\\tilde{B},\\sigma) \\;=\\; \\frac{1}{\\sigma} \\sum_{J=0}^{\\infty} (2J+1)\\, \\exp\\!\\left(-\\frac{\\theta_{\\mathrm{rot}}}{T} J(J+1)\\right),\n$$\nby truncating the sum at a data-dependent maximum $J_{\\max}$ chosen to ensure convergence. Use the following stopping criterion: let $S_N$ be the current partial sum through $J=N$ and $t_{N+1}=(2(N+1)+1)\\exp\\!\\left[-(\\theta_{\\mathrm{rot}}/T)(N+1)(N+2)\\right]$ be the next term; stop when $t_{N+1}/S_N < \\varepsilon$, with tolerance $\\varepsilon = 10^{-12}$. To ensure robustness, enforce a hard cap $J_{\\max}^{\\mathrm{cap}} = 10^6$, and if this cap is reached without meeting the tolerance, stop and use the partial sum at the cap. The returned $q_{\\mathrm{rot}}$ must be dimensionless, and you must also report the actual terminal $J_{\\max}$ used (an integer).\n\n2) Derive and implement the leading classical high-temperature approximation by replacing the sum over $J$ with an integral over a continuous variable, thereby obtaining the leading-order expression $q_{\\mathrm{cl,lead}}(T,\\tilde{B},\\sigma)$ in terms of $T$, $\\tilde{B}$, and $\\sigma$. In addition, derive and implement the first correction term obtained from a systematic asymptotic improvement (for example, via the Eulerâ€“Maclaurin formula) to produce an improved approximation $q_{\\mathrm{cl,imp}}(T,\\tilde{B},\\sigma)$.\n\n3) For each test case, compute:\n- the converged numerical value $q_{\\mathrm{rot}}$,\n- the leading classical approximation $q_{\\mathrm{cl,lead}}$,\n- the relative error of the leading approximation, $\\left|q_{\\mathrm{cl,lead}}-q_{\\mathrm{rot}}\\right|/q_{\\mathrm{rot}}$,\n- the relative error of the improved approximation, $\\left|q_{\\mathrm{cl,imp}}-q_{\\mathrm{rot}}\\right|/q_{\\mathrm{rot}}$,\n- the terminal $J_{\\max}$ used by your summation.\n\nPhysical and numerical units and constants:\n- Temperatures $T$ must be in kelvin (K).\n- The spectroscopic rotational constant $\\tilde{B}$ must be in inverse centimeters ($\\mathrm{cm}^{-1}$).\n- Use the exact physical constants $h$ (Planck constant), $c$ (speed of light), and $k_{\\mathrm{B}}$ (Boltzmann constant) from a reliable codata source. When computing $\\theta_{\\mathrm{rot}}=\\dfrac{h c \\tilde{B}}{k_{\\mathrm{B}}}$ with $\\tilde{B}$ in $\\mathrm{cm}^{-1}$, ensure correct unit conversion to obtain $\\theta_{\\mathrm{rot}}$ in kelvin.\n\nTest suite:\nCompute and report results for the following four parameter sets, all using tolerance $\\varepsilon = 10^{-12}$:\n- Case A (heteronuclear, very low temperature): $T = 0.5\\ \\mathrm{K}$, $\\tilde{B} = 2.0\\ \\mathrm{cm}^{-1}$, $\\sigma = 1$.\n- Case B (heteronuclear, moderate temperature): $T = 5.0\\ \\mathrm{K}$, $\\tilde{B} = 2.0\\ \\mathrm{cm}^{-1}$, $\\sigma = 1$.\n- Case C (homonuclear, high temperature): $T = 300.0\\ \\mathrm{K}$, $\\tilde{B} = 2.0\\ \\mathrm{cm}^{-1}$, $\\sigma = 2$.\n- Case D (heteronuclear, high temperature but larger rotational constant): $T = 300.0\\ \\mathrm{K}$, $\\tilde{B} = 10.0\\ \\mathrm{cm}^{-1}$, $\\sigma = 1$.\n\nFinal output format:\nYour program should produce a single line of output containing the results aggregated for the four test cases as a comma-separated list enclosed in square brackets. For each case, append in order the five values\n$[q_{\\mathrm{rot}},\\ q_{\\mathrm{cl,lead}},\\ \\mathrm{relErr}_{\\mathrm{lead}},\\ \\mathrm{relErr}_{\\mathrm{imp}},\\ J_{\\max}]$,\nso the final line will contain $20$ entries total. All $q$ values and relative errors must be reported as dimensionless floating-point numbers, and $J_{\\max}$ as an integer. For example, the output must look like\n$[x_1,x_2,x_3,x_4,x_5,x_6,\\dots,x_{20}]$\nwith no additional text.", "solution": "The problem as stated is rigorously defined, scientifically sound, and self-contained. It is based on fundamental principles of statistical mechanics and quantum mechanics as applied to molecular spectroscopy. All parameters, constants, and objectives are clearly specified. The problem is therefore valid, and we proceed to its solution.\n\nThe solution is structured into two parts: first, the derivation of the necessary formulae, and second, the implementation of these formulae into a computational program.\n\nThe rotational partition function for a linear rigid rotor is given by\n$$\nq_{\\mathrm{rot}}(T, \\tilde{B}, \\sigma) = \\frac{1}{\\sigma} \\sum_{J=0}^{\\infty} g_J \\exp\\left(-\\frac{E_J}{k_{\\mathrm{B}} T}\\right)\n$$\nwhere $T$ is the absolute temperature, $\\sigma$ is the symmetry number, $k_{\\mathrm{B}}$ is the Boltzmann constant, and the energy levels $E_J$ and their degeneracies $g_J$ are given by quantum mechanics. For a linear rigid rotor, the rotational energy levels are $E_J = h c \\tilde{B} J(J+1)$ with degeneracies $g_J = 2J+1$, for rotational quantum numbers $J = 0, 1, 2, \\dots$. Here, $h$ is Planck's constant, $c$ is the speed of light, and $\\tilde{B}$ is the spectroscopic rotational constant.\n\nIt is convenient to define the characteristic rotational temperature, $\\theta_{\\mathrm{rot}} = \\frac{h c \\tilde{B}}{k_{\\mathrm{B}}}$. This parameter has units of temperature and represents the energy spacing between rotational levels. Using this, the partition function becomes:\n$$\nq_{\\mathrm{rot}}(T, \\tilde{B}, \\sigma) = \\frac{1}{\\sigma} \\sum_{J=0}^{\\infty} (2J+1) \\exp\\left(-\\frac{\\theta_{\\mathrm{rot}}}{T} J(J+1)\\right)\n$$\n\n### 1. Numerical Evaluation of the Partition Function\n\nThe infinite sum must be truncated for numerical computation. The summation will be terminated when the next term in the series is sufficiently small compared to the current partial sum. Let $S_N$ be the partial sum up to quantum number $J=N$, and $t_{N+1}$ be the term for $J=N+1$.\n$$\nS_N = \\sum_{J=0}^{N} (2J+1) \\exp\\left(-\\frac{\\theta_{\\mathrm{rot}}}{T} J(J+1)\\right)\n$$\n$$\nt_{N+1} = (2(N+1)+1) \\exp\\left(-\\frac{\\theta_{\\mathrm{rot}}}{T} (N+1)(N+2)\\right)\n$$\nThe summation is terminated at $J_{\\max} = N$ when the condition $t_{N+1}/S_N < \\varepsilon$ is met, for a given tolerance $\\varepsilon = 10^{-12}$. A hard upper limit of $J_{\\max}^{\\mathrm{cap}} = 10^6$ is imposed to prevent excessive computation. The final numerically evaluated partition function is then $q_{\\mathrm{rot}} = S_{J_{\\max}} / \\sigma$.\n\n### 2. High-Temperature Asymptotic Approximations\n\nIn the high-temperature limit, where $T \\gg \\theta_{\\mathrm{rot}}$, the discrete sum can be approximated by an integral.\n\n#### Leading-Order Classical Approximation\n\nThe leading-order term, $q_{\\mathrm{cl,lead}}$, is obtained by replacing the sum over $J$ with an integral from $J=0$ to $J=\\infty$:\n$$\nq_{\\mathrm{cl,lead}} = \\frac{1}{\\sigma} \\int_0^\\infty (2J+1) \\exp\\left(-\\frac{\\theta_{\\mathrm{rot}}}{T} J(J+1)\\right) dJ\n$$\nLet's perform a change of variables. Let $x = J(J+1)$. Then the differential is $dx = (2J+1)dJ$. The limits of integration for $x$ remain $0$ to $\\infty$. The integral simplifies to a standard form:\n$$\nq_{\\mathrm{cl,lead}} = \\frac{1}{\\sigma} \\int_0^\\infty \\exp\\left(-\\frac{\\theta_{\\mathrm{rot}}}{T} x\\right) dx = \\frac{1}{\\sigma} \\left[ -\\frac{T}{\\theta_{\\mathrm{rot}}} \\exp\\left(-\\frac{\\theta_{\\mathrm{rot}}}{T} x\\right) \\right]_0^\\infty\n$$\nEvaluating the integral at the limits gives:\n$$\nq_{\\mathrm{cl,lead}} = \\frac{1}{\\sigma} \\left( 0 - \\left(-\\frac{T}{\\theta_{\\mathrm{rot}}}\\right) \\right) = \\frac{T}{\\sigma \\theta_{\\mathrm{rot}}}\n$$\nThis is the well-known classical approximation for the rotational partition function.\n\n#### Improved Approximation with First-Order Correction\n\nA more accurate approximation, $q_{\\mathrm{cl,imp}}$, can be found by including correction terms from a semi-classical expansion, derivable via the Euler-Maclaurin formula. The formula relates a discrete sum to an integral and its derivatives:\n$$\n\\sum_{J=0}^{\\infty} f(J) \\approx \\int_{0}^{\\infty} f(x) dx + \\frac{1}{2}f(0) - \\frac{1}{12}f'(0) + \\dots\n$$\nLet $y = \\theta_{\\mathrm{rot}}/T$ and $f(J) = (2J+1)\\exp(-y J(J+1))$. We have already found the integral term:\n$$\n\\int_{0}^{\\infty} f(x) dx = \\frac{1}{y} = \\frac{T}{\\theta_{\\mathrm{rot}}}\n$$\nNext, we evaluate the function and its derivative at $J=0$:\n$$\nf(0) = (2(0)+1)\\exp(0) = 1\n$$\n$$\nf'(J) = \\frac{d}{dJ} \\left( (2J+1)e^{-y J(J+1)} \\right) = 2e^{-y J(J+1)} - y(2J+1)^2 e^{-y J(J+1)}\n$$\n$$\nf'(0) = 2e^0 - y(1)^2 e^0 = 2 - y\n$$\nSubstituting these into the Euler-Maclaurin formula gives the sum as:\n$$\n\\sum_{J=0}^{\\infty} f(J) \\approx \\frac{1}{y} + \\frac{1}{2}(1) - \\frac{1}{12}(2-y) = \\frac{1}{y} + \\frac{1}{2} - \\frac{1}{6} + \\frac{y}{12} = \\frac{1}{y} + \\frac{1}{3} + \\frac{y}{12}\n$$\nThe high-temperature limit corresponds to small $y$. The expansion of the sum in terms of $y$ is $\\frac{1}{y} + \\frac{1}{3} + O(y)$. The improved approximation, $q_{\\mathrm{cl,imp}}$, includes the first two terms of this expansion:\n$$\nq_{\\mathrm{cl,imp}} = \\frac{1}{\\sigma} \\left( \\frac{T}{\\theta_{\\mathrm{rot}}} + \\frac{1}{3} \\right) = q_{\\mathrm{cl,lead}} + \\frac{1}{3\\sigma}\n$$\nThis provides the first-order quantum correction to the classical result.\n\n### 3. Implementation and Constants\n\nFor the computation, we use the CODATA 2018 values for the physical constants obtained from the `scipy.constants` library:\n- Planck constant, $h \\approx 6.62607015 \\times 10^{-34}$ J s\n- Speed of light, $c \\approx 2.99792458 \\times 10^{8}$ m/s\n- Boltzmann constant, $k_{\\mathrm{B}} \\approx 1.380649 \\times 10^{-23}$ J/K\n\nThe rotational constant $\\tilde{B}$ is given in units of cm$^{-1}$. To calculate $\\theta_{\\mathrm{rot}}$ in Kelvin, $\\tilde{B}$ must be converted to m$^{-1}$ by multiplying by $100$.\n$$\n\\theta_{\\mathrm{rot}}[\\mathrm{K}] = \\frac{h[\\mathrm{J \\cdot s}] \\cdot c[\\mathrm{m/s}] \\cdot (\\tilde{B}[\\mathrm{cm^{-1}}] \\times 100 [\\mathrm{m/cm}])}{k_{\\mathrm{B}}[\\mathrm{J/K}]}\n$$\nThe relative errors are calculated as specified: $\\mathrm{relErr}_{\\mathrm{lead}} = |q_{\\mathrm{cl,lead}} - q_{\\mathrm{rot}}| / q_{\\mathrm{rot}}$ and $\\mathrm{relErr}_{\\mathrm{imp}} = |q_{\\mathrm{cl,imp}} - q_{\\mathrm{rot}}| / q_{\\mathrm{rot}}$.\nThe program will execute these calculations for each test case and format the output as requested.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.constants import h, c, k\n\ndef solve():\n    \"\"\"\n    Computes and analyzes the rotational partition function for a linear\n    rigid rotor for a defined set of test cases.\n    \"\"\"\n\n    test_cases = [\n        # (T [K], B_tilde [cm^-1], sigma), Case Label\n        (0.5, 2.0, 1),    # Case A\n        (5.0, 2.0, 1),    # Case B\n        (300.0, 2.0, 2),  # Case C\n        (300.0, 10.0, 1)  # Case D\n    ]\n\n    results = []\n    for case in test_cases:\n        T, B_tilde, sigma = case\n        res_tuple = calculate_rotational_properties(T, B_tilde, sigma)\n        results.extend(res_tuple)\n\n    # Final print statement in the exact required format.\n    # We format floats with a general precision specifier for clarity,\n    # and integers as standard integers.\n    print(f\"[{','.join(f'{val:.12g}' if isinstance(val, float) else str(val) for val in results)}]\")\n\ndef calculate_rotational_properties(T, B_tilde, sigma):\n    \"\"\"\n    Calculates q_rot, q_cl,lead, relative errors, and J_max for a single case.\n\n    Args:\n        T (float): Absolute temperature in Kelvin.\n        B_tilde (float): Rotational constant in cm^-1.\n        sigma (int): Symmetry number.\n\n    Returns:\n        tuple: A tuple containing (q_rot, q_cl_lead, relErr_lead, relErr_imp, J_max).\n    \"\"\"\n    epsilon = 1e-12\n    J_max_cap = 1000000\n\n    # Calculate the characteristic rotational temperature, theta_rot.\n    # B_tilde is in cm^-1, so it's converted to m^-1 by multiplying by 100.\n    theta_rot = (h * c * B_tilde * 100.0) / k\n    theta_rot_over_T = theta_rot / T\n\n    # 1. Numerical summation for q_rot\n    # The sum starts with the J=0 term.\n    current_sum = 1.0  # This is S_0\n    J = 0\n    J_max = 0\n\n    while J < J_max_cap:\n        J_next = J + 1\n        exponent_next = -theta_rot_over_T * (J_next * (J_next + 1))\n        \n        # Check for potential underflow to prevent exp() from returning 0\n        # prematurely, which might affect very low-temperature calculations.\n        # np.exp handles large negative exponents gracefully.\n        term_next = (2.0 * J_next + 1.0) * np.exp(exponent_next)\n\n        # Stopping criterion: t_{N+1} / S_N < epsilon\n        # We stop when the next term is negligible compared to the current sum.\n        if term_next == 0.0 or term_next / current_sum < epsilon:\n            J_max = J  # The sum is converged up to J.\n            break\n        \n        current_sum += term_next\n        J += 1\n    else:  # This 'else' belongs to the 'while' loop.\n        J_max = J_max_cap\n\n    q_rot = current_sum / sigma\n\n    # 2. High-temperature approximations\n    q_cl_lead = (T / theta_rot) / sigma\n    q_cl_imp = q_cl_lead + 1.0 / (3.0 * sigma)\n\n    # 3. Relative errors\n    relErr_lead = np.abs(q_cl_lead - q_rot) / q_rot if q_rot != 0 else 0.0\n    relErr_imp = np.abs(q_cl_imp - q_rot) / q_rot if q_rot != 0 else 0.0\n\n    return q_rot, q_cl_lead, relErr_lead, relErr_imp, J_max\n\nsolve()\n```", "id": "2821764"}]}