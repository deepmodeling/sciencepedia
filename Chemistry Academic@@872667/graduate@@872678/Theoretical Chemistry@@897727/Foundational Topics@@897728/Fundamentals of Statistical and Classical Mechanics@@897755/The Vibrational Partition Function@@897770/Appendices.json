{"hands_on_practices": [{"introduction": "The harmonic oscillator model, while a simplification, serves as the cornerstone for understanding the vibrational contributions to molecular thermodynamics. This exercise is a fundamental practice in connecting the microscopic world of quantum mechanical vibrational frequencies to macroscopic thermodynamic properties. By working through this problem, you will derive the expression for vibrational entropy directly from the partition function, a crucial skill for interpreting the results of computational chemistry simulations and predicting thermochemical data [@problem_id:2023555].", "problem": "In computational chemistry, the thermodynamic properties of a molecule can be predicted from its quantum mechanical structure. A key component of this calculation is the vibrational contribution, which is often modeled by treating each vibrational normal mode as an independent quantum harmonic oscillator.\n\nConsider the benzene molecule, $C_6H_6$. As a non-linear molecule with 12 atoms, it has 30 vibrational modes. A computational analysis has determined the frequencies of these modes. Due to the molecule's symmetry, many modes share the same frequency (i.e., they are degenerate). The distinct vibrational wavenumbers, $\\tilde{\\nu}_i$, and their corresponding degeneracies, $g_i$, are provided below:\n- $g_1$ modes with wavenumber $\\tilde{\\nu}_1$\n- $g_2$ modes with wavenumber $\\tilde{\\nu}_2$\n- $g_3$ modes with wavenumber $\\tilde{\\nu}_3$\n- ...and so on for all distinct modes.\n\nAssuming each vibrational mode is an independent quantum harmonic oscillator, derive a symbolic expression for the total vibrational entropy, $S_v$, of a single benzene molecule at a given absolute temperature $T$.\n\nYour final answer should be a single, closed-form analytic expression, expressed as a sum over the index $i$ representing the distinct vibrational modes. The expression must be in terms of the temperature $T$, the degeneracies $\\{g_i\\}$, the wavenumbers $\\{\\tilde{\\nu}_i\\}$, the speed of light $c$, Planck's constant $h$, and the Boltzmann constant $k_B$.", "solution": "We treat each vibrational normal mode as an independent quantum harmonic oscillator. For a single quantum harmonic oscillator of frequency $\\nu$, the energy levels are $E_{n} = h \\nu \\left(n + \\frac{1}{2}\\right)$ with $n \\in \\{0,1,2,\\ldots\\}$. At temperature $T$, with $\\beta \\equiv \\frac{1}{k_{B} T}$, the canonical partition function is\n$$\nZ = \\sum_{n=0}^{\\infty} \\exp\\!\\left(-\\beta h \\nu \\left(n + \\frac{1}{2}\\right)\\right)\n= \\exp\\!\\left(-\\frac{1}{2}\\beta h \\nu\\right) \\sum_{n=0}^{\\infty} \\left(\\exp(-\\beta h \\nu)\\right)^{n}\n= \\frac{\\exp\\!\\left(-\\frac{1}{2}\\beta h \\nu\\right)}{1 - \\exp(-\\beta h \\nu)}.\n$$\nThe Helmholtz free energy is\n$$\nF = -k_{B} T \\ln Z = -k_{B} T \\left[-\\frac{1}{2}\\beta h \\nu - \\ln\\!\\left(1 - \\exp(-\\beta h \\nu)\\right)\\right]\n= \\frac{1}{2}h \\nu + k_{B} T \\ln\\!\\left(1 - \\exp(-\\beta h \\nu)\\right).\n$$\nThe vibrational entropy for this mode is $S = - \\left(\\frac{\\partial F}{\\partial T}\\right)$ at fixed volume. Differentiating the expression for $F$ with respect to $T$ and using $x \\equiv \\beta h \\nu = \\frac{h \\nu}{k_{B} T}$, we obtain\n$$\nS = - \\left[ k_{B} \\ln\\!\\left(1 - \\exp(-x)\\right) + k_{B} T \\frac{\\partial}{\\partial T} \\ln\\!\\left(1 - \\exp(-x)\\right) \\right].\n$$\nSince $x = \\frac{h \\nu}{k_{B} T}$, we have $\\frac{d x}{d T} = -\\frac{x}{T}$ and\n$$\n\\frac{\\partial}{\\partial T} \\ln\\!\\left(1 - \\exp(-x)\\right)\n= \\frac{\\exp(-x)}{1 - \\exp(-x)} \\frac{d x}{d T}\n= -\\frac{x}{T} \\frac{1}{\\exp(x) - 1}.\n$$\nSubstituting this derivative yields\n$$\nS = - k_{B} \\ln\\!\\left(1 - \\exp(-x)\\right) + k_{B} \\frac{x}{\\exp(x) - 1}.\n$$\nFor a vibrational mode specified by a wavenumber $\\tilde{\\nu}$, the frequency is $\\nu = c \\tilde{\\nu}$ and hence $x = \\frac{h c \\tilde{\\nu}}{k_{B} T}$. Therefore, the vibrational entropy contribution of one mode with wavenumber $\\tilde{\\nu}$ is\n$$\nS(\\tilde{\\nu}, T) = k_{B} \\left[ \\frac{\\frac{h c \\tilde{\\nu}}{k_{B} T}}{\\exp\\!\\left(\\frac{h c \\tilde{\\nu}}{k_{B} T}\\right) - 1} - \\ln\\!\\left(1 - \\exp\\!\\left(-\\frac{h c \\tilde{\\nu}}{k_{B} T}\\right)\\right) \\right].\n$$\nFor benzene, the distinct vibrational wavenumbers are $\\{\\tilde{\\nu}_{i}\\}$ with degeneracies $\\{g_{i}\\}$, and the modes are independent. Entropy is additive for independent subsystems at a common temperature, so the total vibrational entropy for a single molecule is the sum over all distinct modes weighted by degeneracy:\n$$\nS_{v}(T) = \\sum_{i} g_{i} \\, S(\\tilde{\\nu}_{i}, T)\n= k_{B} \\sum_{i} g_{i} \\left[ \\frac{\\frac{h c \\tilde{\\nu}_{i}}{k_{B} T}}{\\exp\\!\\left(\\frac{h c \\tilde{\\nu}_{i}}{k_{B} T}\\right) - 1} - \\ln\\!\\left(1 - \\exp\\!\\left(-\\frac{h c \\tilde{\\nu}_{i}}{k_{B} T}\\right)\\right) \\right].\n$$\nThis expression depends only on $T$, $\\{g_{i}\\}$, $\\{\\tilde{\\nu}_{i}\\}$, $c$, $h$, and $k_{B}$, as required. The zero-point energy $\\frac{1}{2} h c \\tilde{\\nu}_{i}$ cancels out of the entropy, as seen in the derivation.", "answer": "$$\\boxed{k_{B} \\sum_{i} g_{i} \\left[ \\frac{\\frac{h c \\tilde{\\nu}_{i}}{k_{B} T}}{\\exp\\!\\left(\\frac{h c \\tilde{\\nu}_{i}}{k_{B} T}\\right) - 1} - \\ln\\!\\left(1 - \\exp\\!\\left(-\\frac{h c \\tilde{\\nu}_{i}}{k_{B} T}\\right)\\right) \\right]}$$", "id": "2023555"}, {"introduction": "The utility of the vibrational partition function extends far beyond the calculation of bulk thermodynamic properties. It also provides a powerful link to the microcanonical ensemble by encoding information about the density of quantum states, a concept that is central to modern theories of chemical reaction dynamics, such as RRKM theory. This practice challenges you to derive a semiclassical approximation for the cumulative number of states and test its accuracy against an exact combinatorial count, thereby illuminating the deep connection between statistical mechanics and chemical kinetics [@problem_id:2824186].", "problem": "Consider a non-linear triatomic molecule whose vibrational motion is modeled as three independent quantum harmonic oscillators with fundamentals $\\tilde{\\nu}_{1} = 1200\\,\\mathrm{cm}^{-1}$, $\\tilde{\\nu}_{2} = 800\\,\\mathrm{cm}^{-1}$, and $\\tilde{\\nu}_{3} = 500\\,\\mathrm{cm}^{-1}$. The vibrational energy levels are $E = \\sum_{i=1}^{3} h c \\tilde{\\nu}_{i}\\left(n_{i} + \\tfrac{1}{2}\\right)$ with nonnegative integers $n_{i}$. Define the excitation energy above the zero-point level by $\\epsilon = E - \\sum_{i=1}^{3} \\tfrac{1}{2} h c \\tilde{\\nu}_{i} = \\sum_{i=1}^{3} h c \\tilde{\\nu}_{i}\\, n_{i}$. Let $N(\\epsilon)$ denote the cumulative number of vibrational quantum states with excitation energy less than or equal to $\\epsilon$.\n\nStarting from the fundamental definitions of the harmonic-oscillator spectrum and the vibrational partition function $q_{\\mathrm{vib}}(\\beta) = \\prod_{i=1}^{3}\\left[1 - \\exp\\!\\left(-\\beta h c \\tilde{\\nu}_{i}\\right)\\right]^{-1}$, and using only general principles that connect the canonical and microcanonical descriptions, derive a leading-order semiclassical estimate (Whitten–Rabinovitch type) for $N(\\epsilon)$ by replacing the discrete sums over quantum numbers by a continuous integral over the accessible region in the nonnegative octant of quantum-number space. Apply your estimate to the energy $\\tilde{\\epsilon} = \\epsilon/(h c) = 2200\\,\\mathrm{cm}^{-1}$, and then compute the exact $N(\\epsilon)$ by explicit combinatorial counting of all triples $(n_{1}, n_{2}, n_{3}) \\in \\mathbb{Z}_{\\ge 0}^{3}$ satisfying $\\sum_{i=1}^{3} \\tilde{\\nu}_{i} n_{i} \\le \\tilde{\\epsilon}$. Finally, report the ratio\n$$\nR \\equiv \\frac{N_{\\mathrm{WR}}(\\epsilon)}{N_{\\mathrm{exact}}(\\epsilon)} \\, .\n$$\nRound your final answer for $R$ to four significant figures. The ratio is dimensionless; do not include units in your final answer.", "solution": "The solution proceeds in two main parts: first, the derivation and calculation of the semiclassical Whitten-Rabinovitch (WR) approximation for the cumulative number of states, $N_{\\mathrm{WR}}(\\epsilon)$; second, the direct combinatorial counting of the exact number of states, $N_{\\mathrm{exact}}(\\epsilon)$. Finally, the ratio of these two quantities is computed.\n\n**Part I: Semiclassical Approximation for $N(\\epsilon)$**\n\nThe fundamental connection between the canonical partition function, $q(\\beta)$, and the microcanonical density of states, $\\rho(\\epsilon)$, is given by the Laplace transform. The partition function for the excitation energy is a sum over all states:\n$$\nq_{\\mathrm{vib}}(\\beta) = \\sum_{\\text{states } j} \\exp(-\\beta \\epsilon_j)\n$$\nIn the continuum limit, this sum can be replaced by an integral over the density of states:\n$$\nq_{\\mathrm{vib}}(\\beta) = \\int_0^\\infty \\rho(\\epsilon) \\exp(-\\beta \\epsilon) \\, d\\epsilon\n$$\nThus, $\\rho(\\epsilon)$ is the inverse Laplace transform of $q_{\\mathrm{vib}}(\\beta)$. The cumulative number of states, $N(\\epsilon)$, is the integral of the density of states:\n$$\nN(\\epsilon) = \\int_0^\\epsilon \\rho(\\epsilon') \\, d\\epsilon'\n$$\nFrom the properties of the Laplace transform, $N(\\epsilon)$ is the inverse Laplace transform of $q_{\\mathrm{vib}}(\\beta)/\\beta$.\n\nThe semiclassical approximation is derived by approximating the discrete sum over quantum numbers in the partition function by a continuous integral. The exact partition function is a product of geometric series:\n$$\nq_{\\mathrm{vib}}(\\beta) = \\sum_{n_1=0}^{\\infty} \\sum_{n_2=0}^{\\infty} \\sum_{n_3=0}^{\\infty} \\exp\\left(-\\beta \\sum_{i=1}^{3} h c \\tilde{\\nu}_i n_i\\right) = \\prod_{i=1}^{3} \\left(\\sum_{n_i=0}^{\\infty} [\\exp(-\\beta h c \\tilde{\\nu}_i)]^{n_i}\\right) = \\prod_{i=1}^{3} \\frac{1}{1 - \\exp(-\\beta h c \\tilde{\\nu}_i)}\n$$\nThe semiclassical (or high-energy) limit corresponds to the replacement of the discrete sums over $n_i$ with integrals over continuous variables $n_i$:\n$$\nq_{\\mathrm{vib}}^{\\mathrm{sc}}(\\beta) \\approx \\int_0^{\\infty}dn_1 \\int_0^{\\infty}dn_2 \\int_0^{\\infty}dn_3 \\, \\exp\\left(-\\beta h c \\sum_{i=1}^{3} \\tilde{\\nu}_i n_i\\right)\n$$\nThis integral is separable:\n$$\nq_{\\mathrm{vib}}^{\\mathrm{sc}}(\\beta) = \\prod_{i=1}^{3} \\int_0^{\\infty} \\exp(-\\beta h c \\tilde{\\nu}_i n_i) \\, dn_i = \\prod_{i=1}^{3} \\left[ \\frac{-\\exp(-\\beta h c \\tilde{\\nu}_i n_i)}{\\beta h c \\tilde{\\nu}_i} \\right]_0^{\\infty} = \\prod_{i=1}^{3} \\frac{1}{\\beta h c \\tilde{\\nu}_i}\n$$\nThis yields the semiclassical partition function:\n$$\nq_{\\mathrm{vib}}^{\\mathrm{sc}}(\\beta) = \\frac{1}{(\\beta h c)^3 \\prod_{i=1}^{3} \\tilde{\\nu}_i} = \\frac{1}{\\beta^3} \\frac{1}{(h c)^3 \\prod_{i=1}^{3} \\tilde{\\nu}_i}\n$$\nTo find the corresponding semiclassical density of states, $\\rho_{\\mathrm{sc}}(\\epsilon)$, we compute the inverse Laplace transform of $q_{\\mathrm{vib}}^{\\mathrm{sc}}(\\beta)$. Using the standard transform pair $\\mathcal{L}^{-1}\\{s^{-k}\\}(t) = \\frac{t^{k-1}}{(k-1)!}$, with $s=\\beta$, $t=\\epsilon$, and $k=3$:\n$$\n\\rho_{\\mathrm{sc}}(\\epsilon) = \\mathcal{L}^{-1}\\left\\{q_{\\mathrm{vib}}^{\\mathrm{sc}}(\\beta)\\right\\}(\\epsilon) = \\frac{1}{(h c)^3 \\prod_{i=1}^{3} \\tilde{\\nu}_i} \\frac{\\epsilon^{3-1}}{(3-1)!} = \\frac{\\epsilon^2}{2 (h c)^3 \\prod_{i=1}^{3} \\tilde{\\nu}_i}\n$$\nThe cumulative number of states in this approximation, $N_{\\mathrm{WR}}(\\epsilon)$, is the integral of this density:\n$$\nN_{\\mathrm{WR}}(\\epsilon) = \\int_0^\\epsilon \\rho_{\\mathrm{sc}}(\\epsilon') \\, d\\epsilon' = \\int_0^\\epsilon \\frac{(\\epsilon')^2}{2 (h c)^3 \\prod \\tilde{\\nu}_i} \\, d\\epsilon' = \\frac{\\epsilon^3}{6 (h c)^3 \\prod_{i=1}^{3} \\tilde{\\nu}_i}\n$$\nThe problem provides the energy in wavenumbers, $\\tilde{\\epsilon} = \\epsilon/(h c)$. Substituting $\\epsilon = h c \\tilde{\\epsilon}$:\n$$\nN_{\\mathrm{WR}}(\\epsilon) = \\frac{(h c \\tilde{\\epsilon})^3}{6 (h c)^3 \\prod \\tilde{\\nu}_i} = \\frac{\\tilde{\\epsilon}^3}{6 \\prod_{i=1}^{3} \\tilde{\\nu}_i}\n$$\nThis is the Whitten-Rabinovitch formula for the cumulative number of states. Now, we apply the given numerical values: $\\tilde{\\epsilon} = 2200\\,\\mathrm{cm}^{-1}$, $\\tilde{\\nu}_{1} = 1200\\,\\mathrm{cm}^{-1}$, $\\tilde{\\nu}_{2} = 800\\,\\mathrm{cm}^{-1}$, and $\\tilde{\\nu}_{3} = 500\\,\\mathrm{cm}^{-1}$.\n$$\nN_{\\mathrm{WR}}(\\epsilon) = \\frac{(2200)^3}{6 \\times 1200 \\times 800 \\times 500} = \\frac{10648000000}{2880000000} = \\frac{10648}{2880} = \\frac{1331}{360}\n$$\n\n**Part II: Exact Combinatorial Counting of $N_{\\mathrm{exact}}(\\epsilon)$**\n\nWe must find the number of integer triples $(n_1, n_2, n_3)$ with $n_i \\ge 0$ that satisfy the condition $\\sum_{i=1}^{3} h c \\tilde{\\nu}_i n_i \\le \\epsilon$. Dividing by $h c$ and substituting values:\n$$\n1200 n_1 + 800 n_2 + 500 n_3 \\le 2200\n$$\nDividing the inequality by $100$ simplifies the problem to counting integer solutions to:\n$$\n12 n_1 + 8 n_2 + 5 n_3 \\le 22\n$$\nWe proceed by systematically enumerating the possibilities for the quantum numbers, starting with the one corresponding to the largest energy quantum, $n_1$.\n\nCase 1: $n_1 = 0$. The inequality becomes $8 n_2 + 5 n_3 \\le 22$.\n- If $n_2 = 0$, then $5 n_3 \\le 22$, which implies $n_3$ can be $0, 1, 2, 3, 4$. This gives $5$ states.\n- If $n_2 = 1$, then $8 + 5 n_3 \\le 22 \\implies 5 n_3 \\le 14$, so $n_3$ can be $0, 1, 2$. This gives $3$ states.\n- If $n_2 = 2$, then $16 + 5 n_3 \\le 22 \\implies 5 n_3 \\le 6$, so $n_3$ can be $0, 1$. This gives $2$ states.\n- If $n_2 \\ge 3$, $8n_2 \\ge 24$, which violates the inequality.\nTotal for $n_1=0$ is $5+3+2 = 10$ states.\n\nCase 2: $n_1 = 1$. The inequality becomes $12 + 8 n_2 + 5 n_3 \\le 22$, which simplifies to $8 n_2 + 5 n_3 \\le 10$.\n- If $n_2 = 0$, then $5 n_3 \\le 10$, so $n_3$ can be $0, 1, 2$. This gives $3$ states.\n- If $n_2 = 1$, then $8 + 5 n_3 \\le 10 \\implies 5 n_3 \\le 2$, so $n_3$ can only be $0$. This gives $1$ state.\n- If $n_2 \\ge 2$, $8n_2 \\ge 16$, which violates the inequality.\nTotal for $n_1=1$ is $3+1 = 4$ states.\n\nCase 3: $n_1 \\ge 2$. The term $12 n_1$ becomes $24$ or greater, which exceeds $22$. Thus, there are no solutions for $n_1 \\ge 2$.\n\nThe total exact number of states is the sum of the counts from all cases:\n$$\nN_{\\mathrm{exact}}(\\epsilon) = 10 + 4 = 14\n$$\n\n**Part III: Calculation of the Ratio $R$**\n\nWe now compute the ratio $R = N_{\\mathrm{WR}}(\\epsilon) / N_{\\mathrm{exact}}(\\epsilon)$.\n$$\nR = \\frac{1331/360}{14} = \\frac{1331}{360 \\times 14} = \\frac{1331}{5040}\n$$\nTo obtain the final numerical answer, we perform the division and round to four significant figures:\n$$\nR \\approx 0.26408729...\n$$\nRounding to four significant figures gives $0.2641$.", "answer": "$$\n\\boxed{0.2641}\n$$", "id": "2824186"}, {"introduction": "While the harmonic oscillator model is invaluable, it often fails to accurately describe large-amplitude motions like the internal rotation of molecular subgroups. This advanced practice moves from analytical theory to computational reality, guiding you to numerically solve the Schrödinger equation for a more realistic hindered rotor potential. By comparing the numerically exact partition function with that of the harmonic approximation, you will gain a quantitative appreciation for the limits of simple models and develop practical skills in computational theoretical chemistry [@problem_id:2824222].", "problem": "You are asked to implement a numerical comparison between a quantum mechanical hindered internal rotor and its harmonic-mode approximation at room temperature. The internal coordinate is an angular torsion described by an angle $\\theta$ in radians with $0 \\le \\theta lt; 2\\pi$. The system has a periodic potential and a rigid moment of inertia. Your task is to compute the dimensionless canonical partition function of the hindered rotor from first principles and compare it to the harmonic-mode partition function obtained by a quadratic expansion of the potential around a minimum.\n\nFundamental base to use:\n- The canonical partition function for a system with discrete quantum energy levels $\\{E_j\\}$ is $q = \\sum_{j=0}^{\\infty} \\exp(-\\beta E_j)$ with $\\beta = 1/(k_\\mathrm{B} T)$, where $k_\\mathrm{B}$ is the Boltzmann constant and $T$ is the absolute temperature.\n- The one-dimensional quantum Hamiltonian in an angular coordinate $\\theta$ for a rigid rotor with moment of inertia $I$ in a potential $V(\\theta)$ is $\\hat{H} = - \\dfrac{\\hbar^2}{2 I} \\dfrac{d^2}{d\\theta^2} + V(\\theta)$, subject to $2\\pi$-periodic boundary conditions in $\\theta$.\n- The harmonic-mode approximation is obtained by expanding the potential to second order around a minimum and modeling the motion as a one-dimensional quantum harmonic oscillator with frequency $\\omega$. For a harmonic oscillator with angular frequency $\\omega$, energy levels are $E_n = \\hbar \\omega \\left(n + \\dfrac{1}{2}\\right)$, $n \\in \\mathbb{N}_0$, which implies the partition function $q_\\mathrm{harm} = \\dfrac{\\exp(-\\beta \\hbar \\omega/2)}{1 - \\exp(-\\beta \\hbar \\omega)}$.\n\nSystem definition:\n- Consider the $n$-fold periodic cosine potential\n$$\nV(\\theta) = \\frac{V_0}{2}\\left[1 - \\cos(n \\theta)\\right],\n$$\nwith period $2\\pi$ and minima at $\\theta = \\dfrac{2\\pi k}{n}$ for integers $k$. The barrier height between adjacent minima is $V_0$.\n- The harmonic angular frequency near a minimum is defined from the curvature $k_\\theta = \\left.\\dfrac{d^2 V}{d\\theta^2}\\right|_{\\theta_\\text{min}}$ and the kinetic term $\\dfrac{1}{2} I \\dot{\\theta}^2$ as\n$$\n\\omega = \\sqrt{\\frac{k_\\theta}{I}} = \\sqrt{\\frac{n^2 V_0}{2 I}}.\n$$\n- To approximate the full torsional mode by harmonic wells when the barrier is large relative to $k_\\mathrm{B} T$, multiply the single-well harmonic partition function by the number of equivalent minima $n$, giving $q_{\\mathrm{harm,\\,total}} = n \\, q_\\mathrm{harm}$.\n\nNumerical method for the hindered rotor:\n- Discretize $\\theta$ on a uniform grid of $N_\\theta$ points on $[0, 2\\pi)$ with $2\\pi$-periodic boundary conditions. Use $N_\\theta = 256$.\n- Approximate the second derivative by the standard second-order central finite difference with periodic wrap-around. If $h = \\dfrac{2\\pi}{N_\\theta}$ is the grid spacing, then the discrete operator for $\\dfrac{d^2}{d\\theta^2}$ is represented by a circulant matrix with diagonal entries $-2/h^2$, nearest off-diagonal entries $1/h^2$, and corner entries $1/h^2$ to enforce periodicity.\n- Construct the Hamiltonian matrix $H = - \\dfrac{\\hbar^2}{2 I} D^{(2)} + \\mathrm{diag}(V(\\theta_i))$, diagonalize it to obtain eigenvalues $\\{E_j\\}$, and evaluate\n$$\nq_\\mathrm{HR} = \\sum_{j=0}^{N_\\theta - 1} \\exp(-\\beta E_j),\n$$\nas an accurate approximation to the exact $q$ at temperature $T$.\n\nConstants and units:\n- Use $T = 298\\,\\mathrm{K}$.\n- Use $k_\\mathrm{B} = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$ and $\\hbar = 1.054\\,571\\,817 \\times 10^{-34}\\,\\mathrm{J\\,s}$.\n- All energies, including $V_0$ and eigenvalues $E_j$, must be in $\\mathrm{J}$ per molecule. The moment of inertia $I$ must be in $\\mathrm{kg\\,m^2}$. The angle $\\theta$ must be in radians.\n\nWhat to compute and compare:\n- For each test case, compute the hindered rotor partition function $q_\\mathrm{HR}$ numerically as described.\n- Compute the harmonic-mode partition function $q_{\\mathrm{harm,\\,total}} = n \\, \\dfrac{\\exp(-\\beta \\hbar \\omega/2)}{1 - \\exp(-\\beta \\hbar \\omega)}$, where $\\omega = \\sqrt{ \\dfrac{n^2 V_0}{2 I} }$.\n- For each test case, output the ratio\n$$\nR = \\frac{q_\\mathrm{HR}}{q_{\\mathrm{harm,\\,total}}}.\n$$\n\nTest suite:\n- Use the following four test cases, each specified as $(V_0, I, n)$:\n  - Case $1$: $V_0 = 1.0 \\times 10^{-22}\\,\\mathrm{J}$, $I = 5.0 \\times 10^{-47}\\,\\mathrm{kg\\,m^2}$, $n = 3$.\n  - Case $2$: $V_0 = 4.0 \\times 10^{-21}\\,\\mathrm{J}$, $I = 5.0 \\times 10^{-47}\\,\\mathrm{kg\\,m^2}$, $n = 3$.\n  - Case $3$: $V_0 = 2.0 \\times 10^{-20}\\,\\mathrm{J}$, $I = 5.0 \\times 10^{-47}\\,\\mathrm{kg\\,m^2}$, $n = 3$.\n  - Case $4$: $V_0 = 2.0 \\times 10^{-20}\\,\\mathrm{J}$, $I = 5.0 \\times 10^{-47}\\,\\mathrm{kg\\,m^2}$, $n = 1$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the four ratios for the test suite as a comma-separated list enclosed in square brackets, with each ratio rounded to exactly six digits after the decimal point. For example, the output format should look like\n$$\n[\\text{r}_1,\\text{r}_2,\\text{r}_3,\\text{r}_4],\n$$\nwhere each $\\text{r}_i$ is a floating-point number with six digits after the decimal point and no spaces anywhere in the line.", "solution": "The objective is to compute the ratio $R = q_\\mathrm{HR} / q_{\\mathrm{harm,\\,total}}$ for several test cases, where $q_\\mathrm{HR}$ is the canonical partition function of a one-dimensional hindered rotor and $q_{\\mathrm{harm,\\,total}}$ is the partition function of its harmonic oscillator approximation.\n\nFirst, we define the thermal energy factor $\\beta = (k_\\mathrm{B} T)^{-1}$, where $k_\\mathrm{B}$ is the Boltzmann constant and $T$ is the absolute temperature. For the given temperature $T = 298\\,\\mathrm{K}$, and using the provided constant $k_\\mathrm{B} = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$, we find $\\beta \\approx 2.431\\,66 \\times 10^{20}\\,\\mathrm{J}^{-1}$.\n\n**1. The Hindered Rotor Partition Function ($q_\\mathrm{HR}$)**\n\nThe quantum mechanical motion of the internal rotor is governed by the one-dimensional Schrödinger equation, $\\hat{H}\\psi(\\theta) = E\\psi(\\theta)$, with the Hamiltonian operator:\n$$\n\\hat{H} = - \\frac{\\hbar^2}{2I} \\frac{d^2}{d\\theta^2} + V(\\theta)\n$$\nHere, $\\hbar$ is the reduced Planck constant, $I$ is the moment of inertia, $\\theta$ is the torsional angle, and $V(\\theta)$ is the periodic potential given by:\n$$\nV(\\theta) = \\frac{V_0}{2}\\left[1 - \\cos(n \\theta)\\right]\n$$\nwhere $V_0$ is the barrier height and $n$ is the periodicity. The wavefunction $\\psi(\\theta)$ must satisfy $2\\pi$-periodic boundary conditions, $\\psi(\\theta) = \\psi(\\theta + 2\\pi)$.\n\nTo solve for the energy eigenvalues $\\{E_j\\}$, we employ a numerical finite difference method. The angular coordinate $\\theta \\in [0, 2\\pi)$ is discretized into a uniform grid of $N_\\theta = 256$ points: $\\theta_i = i \\cdot h$ for $i=0, 1, \\dots, N_\\theta-1$, with grid spacing $h = 2\\pi/N_\\theta$.\n\nThe second derivative operator $\\frac{d^2}{d\\theta^2}$ is approximated by a matrix $\\mathbf{D}^{(2)}$. Using the second-order central difference formula with periodic boundary conditions, the elements of this $N_\\theta \\times N_\\theta$ matrix are:\n$$\n(\\mathbf{D}^{(2)})_{ij} = \\frac{1}{h^2} \\begin{cases} -2  \\text{if } i=j \\\\ 1  \\text{if } |i-j|=1 \\\\ 1  \\text{if } \\{i,j\\} = \\{0, N_\\theta-1\\} \\\\ 0  \\text{otherwise} \\end{cases}\n$$\nThis is a symmetric circulant matrix. The kinetic energy operator becomes the matrix $\\mathbf{T} = -\\frac{\\hbar^2}{2I}\\mathbf{D}^{(2)}$. The potential energy operator becomes a diagonal matrix $\\mathbf{V}$ with elements $(\\mathbf{V})_{ii} = V(\\theta_i)$. The total Hamiltonian is represented by the matrix:\n$$\n\\mathbf{H} = \\mathbf{T} + \\mathbf{V} = -\\frac{\\hbar^2}{2I}\\mathbf{D}^{(2)} + \\mathrm{diag}(V(\\theta_0), V(\\theta_1), \\dots, V(\\theta_{N_\\theta-1}))\n$$\nThe energy eigenvalues $\\{E_j\\}$ are found by numerically diagonalizing the real, symmetric matrix $\\mathbf{H}$. The hindered rotor partition function is then computed by summing over these $N_\\theta$ approximate eigenvalues:\n$$\nq_\\mathrm{HR} = \\sum_{j=0}^{N_\\theta-1} \\exp(-\\beta E_j)\n$$\n\n**2. The Harmonic-Mode Partition Function ($q_{\\mathrm{harm,\\,total}}$)**\n\nThe harmonic approximation models the system as a quantum harmonic oscillator in each of the potential wells. The potential has minima where $\\cos(n\\theta) = 1$, i.e., at $\\theta_\\text{min} = 2\\pi k/n$ for integer $k$. We expand $V(\\theta)$ in a Taylor series around a minimum, for instance $\\theta_\\text{min} = 0$:\n$$\nV(\\theta) \\approx V(0) + V'(0)(\\theta-0) + \\frac{1}{2}V''(0)(\\theta-0)^2\n$$\nWe find $V(0) = 0$, $V'(\\theta) = \\frac{nV_0}{2}\\sin(n\\theta) \\implies V'(0) = 0$, and the force constant (curvature) is $k_\\theta = V''(\\theta) = \\frac{n^2 V_0}{2}\\cos(n\\theta) \\implies k_\\theta = V''(0) = \\frac{n^2 V_0}{2}$. The potential is approximated as $V(\\theta) \\approx \\frac{1}{2}k_\\theta \\theta^2$.\n\nThis corresponds to a harmonic oscillator with angular frequency $\\omega = \\sqrt{k_\\theta/I}$. Substituting the expression for $k_\\theta$:\n$$\n\\omega = \\sqrt{\\frac{n^2 V_0}{2I}}\n$$\nThe energy levels of a quantum harmonic oscillator are $E_m = \\hbar\\omega(m + 1/2)$ for $m=0, 1, 2, \\dots$. The partition function for a single such oscillator is a geometric series:\n$$\nq_\\mathrm{harm} = \\sum_{m=0}^{\\infty} \\exp\\left[-\\beta\\hbar\\omega\\left(m + \\frac{1}{2}\\right)\\right] = \\exp(-\\beta\\hbar\\omega/2) \\sum_{m=0}^{\\infty} (\\exp(-\\beta\\hbar\\omega))^m = \\frac{\\exp(-\\beta\\hbar\\omega/2)}{1 - \\exp(-\\beta\\hbar\\omega)}\n$$\nSince the potential $V(\\theta)$ has $n$ equivalent minima in the interval $[0, 2\\pi)$, we multiply the single-well partition function by $n$ to obtain the total harmonic-mode partition function, assuming the barrier $V_0$ is large enough to consider the wells independent:\n$$\nq_{\\mathrm{harm,\\,total}} = n \\cdot q_\\mathrm{harm}\n$$\n\n**3. The Ratio**\n\nFor each test case specified by $(V_0, I, n)$, we compute both $q_\\mathrm{HR}$ and $q_{\\mathrm{harm,\\,total}}$ using the methods and constants described above. The final result is their ratio:\n$$\nR = \\frac{q_\\mathrm{HR}}{q_{\\mathrm{harm,\\,total}}}\n$$\nThis ratio quantifies the deviation of the true quantum system from its harmonic approximation. A ratio of $R \\approx 1$ indicates the harmonic approximation is accurate, which is expected for high potential barriers ($V_0 \\gg k_\\mathrm{B}T$). For low barriers ($V_0 \\ll k_\\mathrm{B}T$), the system approaches a free rotor, and the harmonic approximation, based on localized wells, is expected to fail, leading to significant deviation from $R=1$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ratio of the hindered rotor and harmonic oscillator\n    partition functions for several test cases.\n    \"\"\"\n    # Define physical constants and temperature\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    HBAR = 1.054571817e-34 # Reduced Planck constant in J.s\n    T = 298.0  # Temperature in K\n    BETA = 1.0 / (K_B * T)  # Inverse thermal energy in 1/J\n\n    # Numerical grid parameters\n    N_THETA = 256\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (V0 in J, I in kg.m^2, n)\n        (1.0e-22, 5.0e-47, 3), # Case 1\n        (4.0e-21, 5.0e-47, 3), # Case 2\n        (2.0e-20, 5.0e-47, 3), # Case 3\n        (2.0e-20, 5.0e-47, 1), # Case 4\n    ]\n\n    results = []\n    for V0, I, n in test_cases:\n        # --- 1. Hindered Rotor Partition Function (q_HR) Computation ---\n\n        # Discretize the angular coordinate\n        h_theta = 2.0 * np.pi / N_THETA\n        theta_grid = np.linspace(0, 2.0 * np.pi, N_THETA, endpoint=False)\n\n        # Construct the potential energy matrix (diagonal)\n        potential_vector = 0.5 * V0 * (1.0 - np.cos(n * theta_grid))\n        V_matrix = np.diag(potential_vector)\n\n        # Construct the kinetic energy matrix (second derivative)\n        D2 = np.zeros((N_THETA, N_THETA))\n        diag_val = -2.0 / h_theta**2\n        offdiag_val = 1.0 / h_theta**2\n        \n        # Fill diagonal and off-diagonals\n        np.fill_diagonal(D2, diag_val)\n        D2 += np.diag(np.full(N_THETA - 1, offdiag_val), k=1)\n        D2 += np.diag(np.full(N_THETA - 1, offdiag_val), k=-1)\n        \n        # Periodic boundary conditions (corner elements)\n        D2[0, N_THETA - 1] = offdiag_val\n        D2[N_THETA - 1, 0] = offdiag_val\n\n        # Kinetic energy matrix\n        T_matrix = - (HBAR**2 / (2.0 * I)) * D2\n\n        # Construct the full Hamiltonian matrix\n        H_matrix = T_matrix + V_matrix\n\n        # Diagonalize the Hamiltonian to find energy eigenvalues\n        # np.linalg.eigh is used as the matrix is real and symmetric\n        eigenvalues = np.linalg.eigh(H_matrix)[0]\n\n        # Compute the partition function from eigenvalues\n        q_hr = np.sum(np.exp(-BETA * eigenvalues))\n\n        # --- 2. Harmonic-Mode Partition Function (q_harm_total) Computation ---\n\n        # If V0 is zero, the harmonic approximation is ill-defined.\n        # This problem has V0 > 0, so no special handling is needed.\n        # Calculate harmonic angular frequency omega\n        omega = np.sqrt((n**2 * V0) / (2.0 * I))\n\n        # Calculate the single-well harmonic partition function\n        x = BETA * HBAR * omega\n        q_harm = np.exp(-x / 2.0) / (1.0 - np.exp(-x))\n\n        # Total partition function is n times the single-well function\n        q_harm_total = n * q_harm\n\n        # --- 3. Compute and store the ratio ---\n        ratio = q_hr / q_harm_total\n        results.append(f\"{ratio:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2824222"}]}