{"hands_on_practices": [{"introduction": "We begin with a foundational application of the microcanonical ensemble: deriving a macroscopic thermodynamic property directly from microscopic state counting. This practice uses the fundamental definition of entropy, $S = k_B \\ln \\Omega$, to calculate the entropy of mixing for two ideal gases [@problem_id:2816785]. By carefully accounting for the available phase-space volume before and after mixing, this exercise provides a concrete demonstration of how macroscopic irreversibility emerges from the statistical principles governing an isolated system.", "problem": "Consider two nonreacting monatomic ideal gases, species $A$ and $B$, initially confined in an isolated, rigid container of total volume $V = V_A + V_B$ by an impermeable partition. The subsystem on the left contains $N_A$ particles of mass $m_A$, volume $V_A$, and total energy $E_A$; the subsystem on the right contains $N_B$ particles of mass $m_B$, volume $V_B$, and total energy $E_B$. The gases do not interact with each other or with any external field, and each subsystem is internally equilibrated. Assume that initially both subsystems are at the same temperature and pressure, and that the removal of the partition occurs quasistatically and adiabatically so that the total energy $E = E_A + E_B$ and total volume $V$ are conserved. After removal, the gases are allowed to mix and equilibrate while remaining ideal and nonreacting.\n\nUsing the microcanonical definition of entropy $S = k_B \\ln \\Omega$, where the accessible phase-space volume for a classical $N$-particle ideal gas with Hamiltonian $H = \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{2m}$ is\n$$\n\\Omega(E,V,N) = \\frac{1}{h^{3N} N!} \\int \\mathrm{d}^{3N}x\\, \\mathrm{d}^{3N}p\\, \\Theta\\!\\big(E - H(\\{\\mathbf{p}_i\\})\\big),\n$$\nwith $\\Theta$ the Heaviside function and $h$ Planck’s constant, compute the entropy change upon mixing,\n$$\n\\Delta S_{\\mathrm{mix}} = S_{\\mathrm{after}} - S_{\\mathrm{before}},\n$$\nby explicit microcanonical state counting. Treat $A$ and $B$ as distinct species throughout the calculation, and include the indistinguishability (Gibbs) correction factors $1/N_A!$ and $1/N_B!$ in the counting. You may assume the thermodynamic limit where Stirling’s approximation is valid and surface-versus-volume microcanonical definitions are equivalent for entropy differences.\n\nThen, show from your expression that if the initial pressure and temperature are equal in the two compartments (so that $V_A/V_B = N_A/N_B$), your result is equivalent to writing the entropy of mixing in terms of the mole fractions $x_A = N_A/(N_A+N_B)$ and $x_B = N_B/(N_A+N_B)$.\n\nExpress the final answer for $\\Delta S_{\\mathrm{mix}}$ as a single closed-form analytic expression in terms of $N_A$, $N_B$, $V_A$, $V_B$, and $k_B$. Express the entropy change in Joules per Kelvin and leave $k_B$ explicit. No numerical evaluation is required.", "solution": "The problem requires the computation of the entropy of mixing for two distinct, nonreacting, monatomic ideal gases, A and B, using the microcanonical ensemble. The system is isolated.\n\nFirst, we establish the initial state of the system. The two gases are in separate compartments of volumes $V_A$ and $V_B$. Gas A has $N_A$ particles, energy $E_A$, and is confined to volume $V_A$. Gas B has $N_B$ particles, energy $E_B$, and is confined to volume $V_B$. As the subsystems are non-interacting, the total number of accessible microstates for the initial configuration is the product of the microstates accessible to each subsystem:\n$$\n\\Omega_{\\mathrm{before}} = \\Omega_A(E_A, V_A, N_A) \\Omega_B(E_B, V_B, N_B)\n$$\nThe initial total entropy is therefore the sum of the entropies of the subsystems:\n$$\nS_{\\mathrm{before}} = k_B \\ln \\Omega_{\\mathrm{before}} = k_B \\ln \\Omega_A(E_A, V_A, N_A) + k_B \\ln \\Omega_B(E_B, V_B, N_B) = S_A + S_B\n$$\nwhere $k_B$ is the Boltzmann constant.\n\nNext, we characterize the final state. The partition is removed, and the gases mix in the total volume $V = V_A + V_B$. The total energy $E = E_A + E_B$ is conserved as the process is adiabatic for the isolated total system. Since the gases are ideal and nonreacting, they do not interact with each other. Therefore, even after mixing, they can be treated as two independent systems coexisting in the same volume $V$. The total number of microstates of the final system is the product of the microstates available to each gas in the total volume $V$, with a partition of the total energy $E$ into $E'_A$ and $E'_B$ such that $E'_A + E'_B = E$.\n$$\n\\Omega_{\\mathrm{after}} = \\Omega_A(E'_A, V, N_A) \\Omega_B(E'_B, V, N_B)\n$$\nThe problem specifies that initially, the two gases are at the same temperature $T$ and pressure $P$. For a monatomic ideal gas, the energy is related to temperature by $E = \\frac{3}{2} N k_B T$. The condition of equal initial temperatures, $T_A = T_B = T$, implies that the energy per particle is the same for both gases:\n$$\n\\frac{E_A}{N_A} = \\frac{E_B}{N_B} = \\frac{3}{2} k_B T\n$$\nAfter mixing, the two components will equilibrate to a common final temperature $T_f$. The final energies will be $E'_A = \\frac{3}{2} N_A k_B T_f$ and $E'_B = \\frac{3}{2} N_B k_B T_f$. The total energy is conserved, $E'_A + E'_B = E_A + E_B$. Thus,\n$$\nT_f = \\frac{E'_A + E'_B}{\\frac{3}{2} (N_A+N_B) k_B} = \\frac{E_A + E_B}{\\frac{3}{2} (N_A+N_B) k_B}\n$$\nSubstituting $E_A = \\frac{3}{2} N_A k_B T$ and $E_B = \\frac{3}{2} N_B k_B T$, we find:\n$$\nT_f = \\frac{\\frac{3}{2} N_A k_B T + \\frac{3}{2} N_B k_B T}{\\frac{3}{2} (N_A+N_B) k_B} = \\frac{(\\frac{3}{2} k_B T)(N_A+N_B)}{(\\frac{3}{2} k_B)(N_A+N_B)} = T\n$$\nThe final temperature is the same as the initial temperature. This means there is no net transfer of energy between the two components upon mixing. The energy of each component is separately conserved: $E'_A = E_A$ and $E'_B = E_B$.\n\nConsequently, the number of microstates in the final state is given by:\n$$\n\\Omega_{\\mathrm{after}} = \\Omega_A(E_A, V, N_A) \\Omega_B(E_B, V, N_B)\n$$\nThe final entropy is:\n$$\nS_{\\mathrm{after}} = k_B \\ln\\Omega_{\\mathrm{after}} = k_B \\ln\\Omega_A(E_A, V, N_A) + k_B \\ln\\Omega_B(E_B, V, N_B)\n$$\nThe change in entropy upon mixing, $\\Delta S_{\\mathrm{mix}}$, is the difference between the final and initial entropies:\n$$\n\\Delta S_{\\mathrm{mix}} = S_{\\mathrm{after}} - S_{\\mathrm{before}} = \\left(k_B \\ln\\Omega_A(E_A, V, N_A) - k_B \\ln\\Omega_A(E_A, V_A, N_A)\\right) + \\left(k_B \\ln\\Omega_B(E_B, V, N_B) - k_B \\ln\\Omega_B(E_B, V_B, N_B)\\right)\n$$\n$$\n\\Delta S_{\\mathrm{mix}} = k_B \\ln\\left(\\frac{\\Omega_A(E_A, V, N_A)}{\\Omega_A(E_A, V_A, N_A)}\\right) + k_B \\ln\\left(\\frac{\\Omega_B(E_B, V, N_B)}{\\Omega_B(E_B, V_B, N_B)}\\right)\n$$\nWe now use the provided expression for the microcanonical phase-space volume:\n$$\n\\Omega(E,V,N) = \\frac{V^N}{h^{3N} N!} \\int \\mathrm{d}^{3N}p\\, \\Theta\\!\\big(E - H(\\{\\mathbf{p}_i\\})\\big) = \\frac{V^N}{h^{3N} N!} \\times (\\text{Momentum-space volume})\n$$\nThe ratio of microstates for gas A, which expands from volume $V_A$ to $V$ while its energy $E_A$ and particle number $N_A$ are constant, is:\n$$\n\\frac{\\Omega_A(E_A, V, N_A)}{\\Omega_A(E_A, V_A, N_A)} = \\frac{\\frac{V^{N_A}}{h^{3N_A} N_A!} \\times (\\text{Momentum-space volume})}{\\frac{V_A^{N_A}}{h^{3N_A} N_A!} \\times (\\text{Momentum-space volume})} = \\left(\\frac{V}{V_A}\\right)^{N_A}\n$$\nThe momentum-dependent part cancels completely. Similarly, for gas B:\n$$\n\\frac{\\Omega_B(E_B, V, N_B)}{\\Omega_B(E_B, V_B, N_B)} = \\left(\\frac{V}{V_B}\\right)^{N_B}\n$$\nSubstituting these ratios into the expression for $\\Delta S_{\\mathrm{mix}}$:\n$$\n\\Delta S_{\\mathrm{mix}} = k_B \\ln\\left(\\left(\\frac{V}{V_A}\\right)^{N_A}\\right) + k_B \\ln\\left(\\left(\\frac{V}{V_B}\\right)^{N_B}\\right) = N_A k_B \\ln\\left(\\frac{V}{V_A}\\right) + N_B k_B \\ln\\left(\\frac{V}{V_B}\\right)\n$$\nReplacing $V$ with $V_A + V_B$, we obtain the expression for the entropy of mixing:\n$$\n\\Delta S_{\\mathrm{mix}} = N_A k_B \\ln\\left(\\frac{V_A+V_B}{V_A}\\right) + N_B k_B \\ln\\left(\\frac{V_A+V_B}{V_B}\\right)\n$$\nThis is the required result, expressed in terms of $N_A$, $N_B$, $V_A$, $V_B$, and $k_B$.\n\nThe second part of the problem requires showing this result is equivalent to the standard expression in terms of mole fractions, given the initial condition of equal pressure and temperature. The ideal gas law is $PV = Nk_BT$. Since $P_A=P_B$ and $T_A=T_B$, it follows that:\n$$\n\\frac{N_A k_B T_A}{V_A} = \\frac{N_B k_B T_B}{V_B} \\implies \\frac{N_A}{V_A} = \\frac{N_B}{V_B}\n$$\nThis implies $\\frac{V_A}{N_A} = \\frac{V_B}{N_B}$. The volume occupied by each gas is proportional to its number of particles.\nThe mole fractions are $x_A = \\frac{N_A}{N_A+N_B}$ and $x_B = \\frac{N_B}{N_A+N_B}$.\nFrom the condition $\\frac{V_A}{N_A} = \\frac{V_B}{N_B}$, we can write $V_A = c N_A$ and $V_B = c N_B$ for some constant $c$. The total volume is $V_A+V_B = c(N_A+N_B)$.\nWe can now evaluate the arguments of the logarithms:\n$$\n\\frac{V_A+V_B}{V_A} = \\frac{c(N_A+N_B)}{c N_A} = \\frac{N_A+N_B}{N_A} = \\frac{1}{x_A}\n$$\n$$\n\\frac{V_A+V_B}{V_B} = \\frac{c(N_A+N_B)}{c N_B} = \\frac{N_A+N_B}{N_B} = \\frac{1}{x_B}\n$$\nSubstituting these into our expression for $\\Delta S_{\\mathrm{mix}}$:\n$$\n\\Delta S_{\\mathrm{mix}} = N_A k_B \\ln\\left(\\frac{1}{x_A}\\right) + N_B k_B \\ln\\left(\\frac{1}{x_B}\\right) = -N_A k_B \\ln(x_A) - N_B k_B \\ln(x_B)\n$$\nLetting $N = N_A+N_B$, so that $N_A=N x_A$ and $N_B=N x_B$, we can write:\n$$\n\\Delta S_{\\mathrm{mix}} = -N x_A k_B \\ln(x_A) - N x_B k_B \\ln(x_B) = -N k_B (x_A \\ln x_A + x_B \\ln x_B)\n$$\nThis confirms that under the specified conditions, our result from the microcanonical calculation is equivalent to the well-known statistical mechanical formula for the entropy of mixing of ideal gases.", "answer": "$$\n\\boxed{N_A k_B \\ln\\left(\\frac{V_A+V_B}{V_A}\\right) + N_B k_B \\ln\\left(\\frac{V_A+V_B}{V_B}\\right)}\n$$", "id": "2816785"}, {"introduction": "Next, we turn our attention to the grand canonical ensemble, which is essential for describing open systems in contact with a heat and particle reservoir. A defining characteristic of such systems is that the number of particles, $N$, is not fixed but fluctuates around an average value. This practice [@problem_id:2816826] guides you through a cornerstone derivation in statistical mechanics: showing that for a classical ideal gas, the particle number probability distribution is Poissonian, and that the variance in particle number is equal to its mean.", "problem": "A monoatomic classical ideal gas of particles of mass $m$ is in contact with a heat and particle reservoir at temperature $T$ and chemical potential $\\mu$, occupying a fixed volume $V$. Treat the system within the grand canonical ensemble (GCE). Starting only from the fundamental definitions\n- the $N$-particle classical canonical partition function as the phase-space integral with the Gibbs correction,\n- the grand partition function as the sum over particle numbers weighted by the activity,\nderive the particle-number distribution and show that the number fluctuations are Poissonian. Then compute the number variance $\\langle(\\Delta N)^{2}\\rangle$ in closed form. You may define the thermal de Broglie wavelength $\\lambda$ symbolically, but do not assume any additional properties beyond those derivable from the stated definitions.\n\nExpress your final answer as a single closed-form analytic expression in terms of $z$, $V$, and $\\lambda$, where $z$ is the activity $z = \\exp(\\beta \\mu)$ and $\\beta = 1/(k_{B}T)$. Do not include units. Do not provide an inequality or an equation. The final answer must be a single expression.", "solution": "The problem as stated is scientifically sound, well-posed, and objective. It represents a standard derivation in statistical mechanics and can be solved by starting from the specified first principles. We shall proceed with the derivation.\n\nThe foundation of this problem is the $N$-particle classical canonical partition function, $Q_N(T,V)$, for a system of $N$ indistinguishable, non-interacting particles of mass $m$ in a volume $V$ at an inverse temperature $\\beta = 1/(k_B T)$. Its definition, incorporating the Gibbs correction for indistinguishability, is given by the integral over the $6N$-dimensional phase space:\n$$\nQ_N(T,V) = \\frac{1}{N! h^{3N}} \\int \\prod_{i=1}^N d^3\\mathbf{q}_i d^3\\mathbf{p}_i \\, \\exp(-\\beta H(\\{\\mathbf{q}_i, \\mathbf{p}_i\\}))\n$$\nFor a monoatomic ideal gas, the Hamiltonian $H$ contains only the kinetic energy of the particles and is independent of their positions $\\{\\mathbf{q}_i\\}$:\n$$\nH(\\{\\mathbf{p}_i\\}) = \\sum_{i=1}^N \\frac{|\\mathbf{p}_i|^2}{2m}\n$$\nDue to the separability of the Hamiltonian, the phase-space integral can be factored into integrals over position and momentum coordinates. The integration over the spatial coordinates of the $N$ particles yields the volume term:\n$$\n\\int \\prod_{i=1}^N d^3\\mathbf{q}_i = \\left(\\int_V d^3\\mathbf{q}\\right)^N = V^N\n$$\nThe integration over the momentum coordinates also separates into a product of $N$ identical single-particle integrals:\n$$\n\\int \\prod_{i=1}^N d^3\\mathbf{p}_i \\, \\exp\\left(-\\beta \\sum_{j=1}^N \\frac{|\\mathbf{p}_j|^2}{2m}\\right) = \\left[ \\int d^3\\mathbf{p} \\, \\exp\\left(-\\frac{\\beta |\\mathbf{p}|^2}{2m}\\right) \\right]^N\n$$\nThe single-particle momentum integral is a standard three-dimensional Gaussian integral:\n$$\n\\int d^3\\mathbf{p} \\, \\exp\\left(-\\frac{\\beta |\\mathbf{p}|^2}{2m}\\right) = \\left[ \\int_{-\\infty}^{\\infty} dp \\, \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) \\right]^3\n$$\nUsing the result for the one-dimensional Gaussian integral, $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)dx = \\sqrt{\\pi/a}$, we obtain:\n$$\n\\int_{-\\infty}^{\\infty} dp \\, \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) = \\sqrt{\\frac{2\\pi m}{\\beta}}\n$$\nThis gives the value of the three-dimensional momentum integral as $(2\\pi m/\\beta)^{3/2}$.\nSubstituting these results back into the expression for $Q_N(T,V)$, we find:\n$$\nQ_N(T,V) = \\frac{1}{N! h^{3N}} V^N \\left(\\frac{2\\pi m}{\\beta}\\right)^{3N/2} = \\frac{1}{N!} \\left[ V \\left(\\frac{2\\pi m}{h^2 \\beta}\\right)^{3/2} \\right]^N\n$$\nWe define the thermal de Broglie wavelength $\\lambda$ as $\\lambda = h\\sqrt{\\beta/(2\\pi m)}$. With this definition, the canonical partition function acquires a compact form:\n$$\nQ_N(T,V) = \\frac{1}{N!} \\left(\\frac{V}{\\lambda^3}\\right)^N\n$$\nThis is the canonical partition function for $N$ classical ideal gas particles. It is related to the single-particle partition function $Q_1 = V/\\lambda^3$ by $Q_N = Q_1^N/N!$.\n\nNow, we move to the grand canonical ensemble (GCE). The grand partition function $\\Xi(T,V,\\mu)$ is defined as a sum over states with all possible particle numbers $N \\in \\{0, 1, 2, ...\\}$, weighted by the chemical potential $\\mu$ through the activity $z = \\exp(\\beta\\mu)$:\n$$\n\\Xi(T,V,\\mu) = \\sum_{N=0}^{\\infty} z^N Q_N(T,V)\n$$\nSubstituting our result for $Q_N$, we get:\n$$\n\\Xi = \\sum_{N=0}^{\\infty} z^N \\frac{1}{N!} \\left(\\frac{V}{\\lambda^3}\\right)^N = \\sum_{N=0}^{\\infty} \\frac{1}{N!} \\left(\\frac{zV}{\\lambda^3}\\right)^N\n$$\nThis sum is the Maclaurin series for the exponential function, $\\exp(x) = \\sum_{k=0}^{\\infty} x^k/k!$. Identifying $x = zV/\\lambda^3$, we find the grand partition function in closed form:\n$$\n\\Xi = \\exp\\left(\\frac{zV}{\\lambda^3}\\right)\n$$\nThe probability $P(N)$ of finding the system with a specific number of particles $N$ is the ratio of the corresponding term in the sum to the total sum $\\Xi$:\n$$\nP(N) = \\frac{z^N Q_N}{\\Xi} = \\frac{\\frac{1}{N!} (zV/\\lambda^3)^N}{\\exp(zV/\\lambda^3)} = \\frac{(zV/\\lambda^3)^N}{N!} \\exp\\left(-\\frac{zV}{\\lambda^3}\\right)\n$$\nThis is the particle-number distribution function. To show it is Poissonian, we compare it to the standard form of a Poisson distribution for a discrete random variable $k$, which is $P(k;\\alpha) = \\frac{\\alpha^k e^{-\\alpha}}{k!}$, where $\\alpha$ is the average value $\\langle k \\rangle$. Our derived $P(N)$ matches this form precisely, with the parameter $\\alpha$ given by:\n$$\n\\alpha = \\frac{zV}{\\lambda^3}\n$$\nThus, the distribution of particle numbers is indeed Poissonian. The mean number of particles in the system is $\\langle N \\rangle = \\alpha = zV/\\lambda^3$.\n\nFinally, we compute the variance of the particle number, $\\langle(\\Delta N)^2\\rangle$. A well-known property of the Poisson distribution is that its variance is equal to its mean:\n$$\n\\langle(\\Delta N)^2\\rangle = \\langle N^2 \\rangle - \\langle N \\rangle^2 = \\langle N \\rangle\n$$\nTherefore, the number variance for the ideal gas in the GCE is:\n$$\n\\langle(\\Delta N)^2\\rangle = \\langle N \\rangle = \\frac{zV}{\\lambda^3}\n$$\nThis is the final closed-form expression for the number variance, derived strictly from the given definitions.", "answer": "$$\\boxed{\\frac{zV}{\\lambda^3}}$$", "id": "2816826"}, {"introduction": "Our final practice bridges the gap between abstract ensemble theory and its application in modern computational chemistry. The grand canonical ensemble provides the theoretical basis for Grand Canonical Monte Carlo (GCMC), a powerful simulation technique for studying systems with variable particle numbers, such as in adsorption or phase equilibria. In this exercise [@problem_id:2816799], you will derive the Metropolis acceptance probabilities for particle insertion and deletion moves from the principle of detailed balance, revealing how the chemical potential, $\\mu$, directly controls the simulation's dynamics.", "problem": "You are asked to derive, implement, and evaluate the expected single-attempt acceptance probabilities for Grand Canonical Monte Carlo (GCMC) insertion and deletion moves for a three-dimensional system of hard spheres in a cubic box with hard walls. Your derivation must start from first principles: the definition of the grand canonical ensemble and the detailed balance condition. You must then specialize the result to hard spheres, explicitly identifying how the acceptance probabilities depend on the chemical potential and the excluded volume. For numerical evaluation, you will work in reduced units so that all outputs are dimensionless probabilities.\n\nBackground and modeling assumptions:\n- Consider a cubic box of side length $L$ containing $N$ non-overlapping hard spheres of diameter $\\sigma$ at positions $\\{\\mathbf{r}_i\\}_{i=1}^N$. Hard walls imply that a sphere center must lie at least a distance $\\sigma/2$ from each box face.\n- A proposed insertion selects a center uniformly at random within the wall-accessible box $V_\\mathrm{w}$ of volume $V_\\mathrm{w} = (L - \\sigma)^3$; a proposed deletion selects one particle uniformly at random from the $N$ present.\n- Use reduced units with Boltzmann constant times temperature set to unity, $k_\\mathrm{B} T = 1$, and thermal de Broglie wavelength set to unity, $\\Lambda = 1$. In these units the activity is $z = \\exp(\\mu)$, where $\\mu$ is the chemical potential.\n- The hard-sphere potential energy $U$ is $0$ for any configuration with no overlaps and $+\\infty$ if any overlap occurs.\n\nYour tasks:\n1) From the grand canonical distribution and detailed balance, derive the single-attempt Metropolis acceptance probabilities for insertion and deletion moves for hard spheres. The derivation must start from the grand canonical weight proportional to $\\exp(\\beta \\mu N) \\exp(-\\beta U) / (\\Lambda^{3N} N!)$ with $\\beta = 1/(k_\\mathrm{B} T)$, and must account for the proposal probabilities appropriate to uniform insertion in $V_\\mathrm{w}$ and uniform deletion among $N$ particles. Then specialize to hard spheres so that the insertion acceptance depends on whether the trial position lies in the excluded region. Define the free (insertion-allowed) volume $V_\\mathrm{free}$ as the subset of $V_\\mathrm{w}$ where inserting a new sphere center does not overlap any existing sphere. Show how the expected acceptance of a single random insertion attempt depends on the ratio $V_\\mathrm{free}/V_\\mathrm{w}$ and on $\\mu$; and how the deletion acceptance depends on $\\mu$ and $N$.\n2) For a configuration in which the exclusion spheres of radius $\\sigma$ around the existing centers are mutually disjoint and fully contained in $V_\\mathrm{w}$, show that $V_\\mathrm{free} = V_\\mathrm{w} - N \\, v_\\mathrm{excl}$ exactly, where $v_\\mathrm{excl} = \\frac{4}{3}\\pi \\sigma^3$. For all test cases below, you may assume this disjoint-and-contained condition holds and use this expression directly.\n3) Implement a program that, for each test case, computes:\n   - The expected acceptance probability of a single insertion attempt, defined as the probability that a uniformly sampled trial position in $V_\\mathrm{w}$ both avoids overlap and is accepted by the Metropolis criterion.\n   - The acceptance probability of a single deletion attempt, defined for a uniformly random choice among the $N$ present particles.\n   Use reduced units $k_\\mathrm{B} T = 1$ and $\\Lambda = 1$ so that $z = \\exp(\\mu)$.\n4) Test suite. For each case below, compute the two probabilities described in item $3$:\n   - Case A: $L = 10$, $\\sigma = 1$, $N = 1$, centers at $(5,5,5)$, $\\mu = \\ln(0.05)$.\n   - Case B: $L = 12$, $\\sigma = 2$, $N = 2$, centers at $(3,3,3)$ and $(9,9,9)$, $\\mu = \\ln(0.001)$.\n   - Case C: $L = 8$, $\\sigma = 1$, $N = 0$, no centers, $\\mu = \\ln(0.001)$.\n   - Case D: $L = 12$, $\\sigma = 2$, $N = 2$, centers at $(3,3,3)$ and $(9,9,9)$, $\\mu = \\ln(0.01)$.\n   For each case, you may assume the exclusion spheres are disjoint and contained, so that $V_\\mathrm{free} = V_\\mathrm{w} - N \\, v_\\mathrm{excl}$ is exact.\n5) Final output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as\n   $[\\mathrm{ins}_A,\\mathrm{del}_A,\\mathrm{ins}_B,\\mathrm{del}_B,\\mathrm{ins}_C,\\mathrm{del}_C,\\mathrm{ins}_D,\\mathrm{del}_D]$,\n   where each entry is a floating-point number. Since these are probabilities, the numbers are dimensionless and must be printed as decimal numerals with default Python formatting. No additional text should be printed.\n\nNotes:\n- Ensure that every intermediate quantity used in your computation is defined from the foundational principles stated above; do not rely on any unproven acceptance formula without derivation.\n- All geometric quantities in your computation must be expressed in the reduced length unit consistent with $\\sigma$, and all probabilities are dimensionless.", "solution": "The problem posed is a standard exercise in the statistical mechanics of fluids and is scientifically well-grounded, objective, and well-posed. All necessary parameters and assumptions for a unique solution are provided. The problem is therefore valid. We shall proceed with the derivation and solution.\n\nThe derivation of the acceptance probabilities for Grand Canonical Monte Carlo (GCMC) moves proceeds from the principle of detailed balance, also known as microscopic reversibility. This principle ensures that a Monte Carlo simulation will correctly sample states from the desired statistical ensemble. For a transition from a state $o$ (old) to a state $n$ (new), detailed balance requires:\n$$ W(o) P(o \\to n) = W(n) P(n \\to o) $$\nwhere $W(x)$ is the equilibrium probability of state $x$, and $P(x \\to y)$ is the transition probability. The transition probability is a product of the proposal probability, $\\alpha(x \\to y)$, and the acceptance probability, $A(x \\to y)$, so that $P(x \\to y) = \\alpha(x \\to y) A(x \\to y)$. This leads to the Metropolis-Hastings acceptance rule:\n$$ A(o \\to n) = \\min\\left(1, \\frac{W(n)}{W(o)} \\frac{\\alpha(n \\to o)}{\\alpha(o \\to n)}\\right) $$\n\nIn the grand canonical ensemble, a microstate is defined by the number of particles $N$ and their positions $\\{\\mathbf{r}_i\\}_{i=1}^N$. The problem asks to start from the grand canonical weight $W \\propto \\exp(\\beta \\mu N) \\exp(-\\beta U) / (\\Lambda^{3N} N!)$. However, a subtle but crucial point in deriving the GCMC acceptance rules is that the $1/N!$ factor arises from correcting for overcounting identical configurations in the partition function integral over distinguishable particle coordinates. The weight of a single, physically distinct microstate (which is an unordered set of particle positions) is proportional to $z^N \\exp(-\\beta U)$, where the activity $z = \\exp(\\beta \\mu) / \\Lambda^3$. The problem specifies reduced units where the Boltzmann constant times temperature is unity, $k_B T = 1$ (so $\\beta=1$), and the thermal de Broglie wavelength is unity, $\\Lambda = 1$. With these units, the activity simplifies to $z = \\exp(\\mu)$.\nThe equilibrium probability of a microstate with $N$ particles is therefore proportional to:\n$$ W(\\{\\mathbf{r}_i\\}, N) \\propto z^N e^{-U(\\{\\mathbf{r}_i\\})} $$\n\nLet us first derive the acceptance probability for an insertion move, which is a transition from an initial state $o$ with $N$ particles to a new state $n$ with $N+1$ particles.\nThe ratio of the equilibrium probabilities is:\n$$ \\frac{W(n)}{W(o)} = \\frac{z^{N+1} e^{-U(N+1)}}{z^N e^{-U(N)}} = z e^{-\\Delta U} $$\nwhere $\\Delta U = U(N+1) - U(N)$ is the change in potential energy upon inserting the new particle.\n\nNext, we consider the ratio of proposal probabilities.\nThe forward move, $o \\to n$ (insertion), involves proposing a trial position for the new particle uniformly at random within the wall-accessible volume $V_\\mathrm{w}$. The probability density for choosing a specific position is $\\alpha(o \\to n) = 1/V_\\mathrm{w}$.\nThe reverse move, $n \\to o$ (deletion), involves selecting one particle uniformly at random from the $N+1$ particles present and removing it. The probability of selecting the specific particle that was just added is $\\alpha(n \\to o) = 1/(N+1)$.\n\nThe ratio of proposal probabilities is:\n$$ \\frac{\\alpha(n \\to o)}{\\alpha(o \\to n)} = \\frac{1/(N+1)}{1/V_\\mathrm{w}} = \\frac{V_\\mathrm{w}}{N+1} $$\nCombining these ratios, the argument for the Metropolis acceptance criterion for an insertion attempt is:\n$$ \\frac{W(n)}{W(o)} \\frac{\\alpha(n \\to o)}{\\alpha(o \\to n)} = \\left(z e^{-\\Delta U}\\right) \\left(\\frac{V_\\mathrm{w}}{N+1}\\right) = \\frac{z V_\\mathrm{w}}{N+1} e^{-\\Delta U} $$\nThe acceptance probability for a specific insertion trial is then:\n$$ A_{\\mathrm{ins}}(N \\to N+1) = \\min\\left(1, \\frac{z V_\\mathrm{w}}{N+1} e^{-\\Delta U}\\right) $$\nFor a hard-sphere system, the potential energy $U$ is either $0$ (no overlaps) or $+\\infty$ (any overlap). If a trial insertion results in an overlap, $\\Delta U = +\\infty$, and $A_{\\mathrm{ins}} = 0$. If the insertion does not cause any overlap, and assuming the initial $N$-particle state was valid ($U(N)=0$), then $U(N+1)=0$, so $\\Delta U = 0$. The acceptance in this non-overlapping case is $\\min\\left(1, \\frac{z V_\\mathrm{w}}{N+1}\\right)$.\n\nThe problem requests the *expected* single-attempt acceptance probability. This requires averaging over all possible trial positions in $V_\\mathrm{w}$. A trial move is successful only if the new particle is placed in the \"free volume\" $V_\\mathrm{free}$, where no overlaps occur, and the subsequent Metropolis check is passed. The probability of choosing a trial position in the free volume is $P(\\text{no overlap}) = V_\\mathrm{free} / V_\\mathrm{w}$.\nThe expected acceptance probability is thus:\n$$ \\langle A_{\\mathrm{ins}} \\rangle = P(\\text{no overlap}) \\times A_{\\mathrm{ins}}(\\Delta U=0) + P(\\text{overlap}) \\times A_{\\mathrm{ins}}(\\Delta U=\\infty) $$\n$$ \\langle A_{\\mathrm{ins}} \\rangle = \\frac{V_\\mathrm{free}}{V_\\mathrm{w}} \\min\\left(1, \\frac{z V_\\mathrm{w}}{N+1}\\right) $$\nUnder the given assumption that the exclusion spheres (of radius $\\sigma$) are disjoint and contained within $V_\\mathrm{w}$, the free volume is simply the wall-accessible volume minus the sum of the volumes of the $N$ exclusion spheres: $V_\\mathrm{free} = V_\\mathrm{w} - N v_\\mathrm{excl}$, where $v_\\mathrm{excl} = \\frac{4}{3}\\pi\\sigma^3$.\n\nNow we derive the acceptance probability for a deletion move, which is a transition from a state with $N$ particles to one with $N-1$. This move is the reverse of an insertion into a system of $N-1$ particles. The acceptance rule for a deletion $A_{\\mathrm{del}}(N \\to N-1)$ can be found from the insertion rule $A_{\\mathrm{ins}}(N-1 \\to N)$ via detailed balance:\n$$ A_{\\mathrm{del}}(N \\to N-1) = \\min\\left(1, \\left[ \\frac{z V_\\mathrm{w}}{N} e^{-\\Delta U_{ins}} \\right]^{-1} \\right) = \\min\\left(1, \\frac{N}{z V_\\mathrm{w}} e^{\\Delta U_{ins}}\\right) $$\nHere $\\Delta U_{ins}$ is the energy change for the reverse move, which is inserting the particle back into the $N-1$ particle system. Since we start from a valid $N$-particle state, the particle being deleted is in a valid position. Thus, re-inserting it at the same position results in no change in energy, $\\Delta U_{ins} = U(N) - U(N-1) = 0$. Therefore, the deletion acceptance probability is:\n$$ A_{\\mathrm{del}} = \\min\\left(1, \\frac{N}{z V_\\mathrm{w}}\\right) $$\nThis probability does not depend on the specific particle chosen for deletion, as long as the initial state is valid. If $N=0$, the probability of deletion is correctly found to be $0$.\n\nWith these derived formulas, we can compute the required probabilities for the given test cases.\n\nCase A: $L = 10$, $\\sigma = 1$, $N = 1$, $\\mu = \\ln(0.05)$.\n$z=0.05$, $V_\\mathrm{w}=(10-1)^3=729$, $v_\\mathrm{excl}=\\frac{4}{3}\\pi(1)^3$, $V_\\mathrm{free}=729-\\frac{4}{3}\\pi$.\n$\\langle A_{\\mathrm{ins}} \\rangle = \\frac{729 - 4\\pi/3}{729} \\min\\left(1, \\frac{0.05 \\times 729}{1+1}\\right) = \\left(1-\\frac{4\\pi}{2187}\\right) \\times \\min(1, 18.225) \\approx 0.99426$.\n$A_{\\mathrm{del}} = \\min\\left(1, \\frac{1}{0.05 \\times 729}\\right) = \\min(1, 0.02743) \\approx 0.02743$.\n\nCase B: $L = 12$, $\\sigma = 2$, $N = 2$, $\\mu = \\ln(0.001)$.\n$z=0.001$, $V_\\mathrm{w}=(12-2)^3=1000$, $v_\\mathrm{excl}=\\frac{4}{3}\\pi(2)^3=\\frac{32\\pi}{3}$, $V_\\mathrm{free}=1000-2\\frac{32\\pi}{3}=1000-\\frac{64\\pi}{3}$.\n$\\langle A_{\\mathrm{ins}} \\rangle = \\frac{1000 - 64\\pi/3}{1000} \\min\\left(1, \\frac{0.001 \\times 1000}{2+1}\\right) = \\left(1-\\frac{64\\pi}{3000}\\right) \\times \\min(1, 1/3) \\approx 0.31099$.\n$A_{\\mathrm{del}} = \\min\\left(1, \\frac{2}{0.001 \\times 1000}\\right) = \\min(1, 2) = 1$.\n\nCase C: $L = 8$, $\\sigma = 1$, $N = 0$, $\\mu = \\ln(0.001)$.\n$z=0.001$, $V_\\mathrm{w}=(8-1)^3=343$, $N=0 \\implies V_\\mathrm{free}=V_\\mathrm{w}$.\n$\\langle A_{\\mathrm{ins}} \\rangle = \\frac{343}{343} \\min\\left(1, \\frac{0.001 \\times 343}{0+1}\\right) = \\min(1, 0.343) = 0.343$.\n$A_{\\mathrm{del}} = \\min\\left(1, \\frac{0}{0.001 \\times 343}\\right) = 0$.\n\nCase D: $L = 12$, $\\sigma = 2$, $N = 2$, $\\mu = \\ln(0.01)$.\n$z=0.01$, $V_\\mathrm{w}=1000$, $V_\\mathrm{free}=1000-\\frac{64\\pi}{3}$.\n$\\langle A_{\\mathrm{ins}} \\rangle = \\frac{1000 - 64\\pi/3}{1000} \\min\\left(1, \\frac{0.01 \\times 1000}{2+1}\\right) = \\left(1-\\frac{64\\pi}{3000}\\right) \\times \\min(1, 10/3) \\approx 0.93298$.\n$A_{\\mathrm{del}} = \\min\\left(1, \\frac{2}{0.01 \\times 1000}\\right) = \\min(1, 0.2) = 0.2$.\nThe following program implements these calculations.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes GCMC acceptance probabilities for hard spheres based on derived formulas.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: L=10, sigma=1, N=1, centers at (5,5,5), mu=ln(0.05)\n        {'L': 10.0, 'sigma': 1.0, 'N': 1, 'mu': np.log(0.05)},\n        # Case B: L=12, sigma=2, N=2, centers at (3,3,3) and (9,9,9), mu=ln(0.001)\n        {'L': 12.0, 'sigma': 2.0, 'N': 2, 'mu': np.log(0.001)},\n        # Case C: L=8, sigma=1, N=0, no centers, mu=ln(0.001)\n        {'L': 8.0, 'sigma': 1.0, 'N': 0, 'mu': np.log(0.001)},\n        # Case D: L=12, sigma=2, N=2, centers at (3,3,3) and (9,9,9), mu=ln(0.01)\n        {'L': 12.0, 'sigma': 2.0, 'N': 2, 'mu': np.log(0.01)},\n    ]\n\n    results = []\n    for case in test_cases:\n        L = case['L']\n        sigma = case['sigma']\n        N = case['N']\n        mu = case['mu']\n\n        # In reduced units k_B*T = 1 and Lambda = 1, the activity z = exp(mu).\n        z = np.exp(mu)\n\n        # The wall-accessible volume for sphere centers.\n        V_w = (L - sigma)**3\n\n        # The excluded volume created by a single sphere for the center of another.\n        # This is the volume of a sphere of radius sigma, not sigma/2.\n        v_excl = (4.0 / 3.0) * np.pi * sigma**3\n\n        # The free volume is the portion of V_w where a new particle center\n        # can be placed without overlapping existing spheres. The problem states\n        # to assume exclusion spheres are disjoint and contained.\n        V_free = V_w - N * v_excl\n        \n        # --- 1. Expected acceptance probability for an insertion attempt (N - N+1) ---\n        \n        # The probability of proposing a valid move (no overlap) by picking a random\n        # position in V_w. If V_free is negative (high density), probability is 0.\n        prob_no_overlap = max(0.0, V_free / V_w)\n        \n        # The Metropolis acceptance probability, given that the trial move causes no overlap (Delta_U = 0).\n        # This is for a transition from N to N+1 particles.\n        arg_ins = (z * V_w) / (N + 1)\n        prob_accept_if_no_overlap = min(1.0, arg_ins)\n        \n        # The total expected acceptance probability is the product of finding a\n        # valid spot and that spot being accepted by the Metropolis criterion.\n        expected_ins_prob = prob_no_overlap * prob_accept_if_no_overlap\n        results.append(expected_ins_prob)\n\n        # --- 2. Acceptance probability for a deletion attempt (N - N-1) ---\n\n        if N == 0:\n            # A deletion move is not possible if there are no particles.\n            del_prob = 0.0\n        else:\n            # The Metropolis acceptance probability for deleting a particle.\n            # This is for a transition from N to N-1 particles.\n            arg_del = N / (z * V_w)\n            del_prob = min(1.0, arg_del)\n        results.append(del_prob)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2816799"}]}