{"hands_on_practices": [{"introduction": "Understanding a complex theoretical framework often begins by examining its simplest limits. This exercise explores the fundamental structure of the Multi-Configuration Time-Dependent Hartree (MCTDH) method by reducing it to its most basic form, where only a single single-particle function (SPF) is used for each degree of freedom. By analyzing this limit, you will see how the MCTDH ansatz collapses to the familiar time-dependent Hartree (TDH) mean-field theory, providing a crucial insight into what MCTDH adds: a systematic way to include electronic and vibrational correlation beyond the mean-field approximation [@problem_id:2818034].", "problem": "Consider a system with $f$ distinguishable degrees of freedom (modes) governed by the Time-Dependent Schrödinger Equation (TDSE) $i\\,\\partial_t \\lvert \\Psi(t)\\rangle = \\hat{H}\\lvert \\Psi(t)\\rangle$ and approximated within the Multi-Configuration Time-Dependent Hartree (MCTDH) method. In MCTDH, the wavefunction is expanded in time-dependent Hartree products of Single-Particle Functions (SPFs), and its equations of motion follow from the Dirac–Frenkel Variational Principle (DFVP) $\\langle \\delta \\Psi \\lvert i\\,\\partial_t - \\hat{H}\\rvert \\Psi\\rangle = 0$ subject to orthonormality constraints on the SPFs. Suppose that for each mode $\\kappa\\in\\{1,\\dots,f\\}$ you choose exactly $n_\\kappa = 1$ SPF, i.e., a single SPF per mode.\n\nUsing only the TDSE, the DFVP, and the core definition that the MCTDH ansatz is a linear combination of configurations built from time-dependent orthonormal SPFs with a time-dependent coefficient tensor, reason from first principles how the $n_\\kappa=1$ choice constrains the structure of the wavefunction and its equations of motion. Based on that reasoning, select all statements below that must hold in this $n_\\kappa=1$ limit and analyze the implications for correlation.\n\nA. With $n_\\kappa=1$ for all modes, the configuration tensor reduces to a single complex scalar that can be gauged to a physically irrelevant global phase; the equations of motion for the SPFs become the time-dependent Hartree (TDH) mean-field equations, and the total wavefunction is a single time-dependent Hartree product.\n\nB. Even with $n_\\kappa=1$, the MCTDH ansatz retains inter-mode correlation through time-dependent configuration coefficients, so entanglement between distinct modes can remain nonzero.\n\nC. In the $n_\\kappa=1$ limit, the single-particle density matrix for each mode is a $1\\times 1$ identity, corresponding to a rank-$1$ projector; the von Neumann entanglement entropy between any bipartition of distinct modes is therefore $0$, and any coupling between modes enters only through mean-field potentials in the SPF equations.\n\nD. If the Hamiltonian is strictly separable as $\\hat{H}=\\sum_{\\kappa=1}^f \\hat{h}^{(\\kappa)}$ with no inter-mode couplings, then the $n_\\kappa=1$ limit yields exact dynamics; for nonseparable couplings, the error arises from the neglect of inter-mode correlation beyond mean-field.\n\nE. By grouping several physical coordinates into a single combined mode, one may represent correlation within that group even with $n_\\kappa=1$, but correlations between different groups remain excluded in this limit.\n\nSelect all correct options.", "solution": "**Derivation from First Principles**\n\nThe general MCTDH ansatz for a system with $f$ distinguishable modes is given by:\n$$\n\\lvert \\Psi(t) \\rangle = \\sum_{j_1=1}^{n_1} \\sum_{j_2=1}^{n_2} \\dots \\sum_{j_f=1}^{n_f} A_{j_1 j_2 \\dots j_f}(t) \\prod_{\\kappa=1}^{f} \\lvert \\varphi_{j_\\kappa}^{(\\kappa)}(t) \\rangle\n$$\nHere, $A_{j_1 j_2 \\dots j_f}(t)$ is the time-dependent coefficient tensor, and the set $\\{\\lvert \\varphi_{j_\\kappa}^{(\\kappa)}(t) \\rangle\\}_{j_\\kappa=1}^{n_\\kappa}$ comprises the $n_\\kappa$ orthonormal time-dependent Single-Particle Functions (SPFs) for mode $\\kappa$.\n\nWe now impose the condition specified in the problem: $n_\\kappa = 1$ for all modes $\\kappa \\in \\{1, \\dots, f\\}$.\nUnder this constraint, each summation in the ansatz runs over a single index, $j_\\kappa=1$. The sum therefore collapses to a single term. The multi-index $(j_1, j_2, \\dots, j_f)$ can only take the value $(1, 1, \\dots, 1)$. The coefficient tensor $A$ reduces to a single complex scalar, $A_{11\\dots1}(t)$. The wavefunction takes the form:\n$$\n\\lvert \\Psi(t) \\rangle = A_{11\\dots1}(t) \\prod_{\\kappa=1}^{f} \\lvert \\varphi_1^{(\\kappa)}(t) \\rangle\n$$\nThe total wavefunction must be normalized to unity: $\\langle \\Psi(t) \\lvert \\Psi(t) \\rangle = 1$. Let us compute this norm:\n$$\n\\langle \\Psi(t) \\lvert \\Psi(t) \\rangle = \\left( A_{11\\dots1}^*(t) \\prod_{\\lambda=1}^{f} \\langle \\varphi_1^{(\\lambda)}(t) \\rvert \\right) \\left( A_{11\\dots1}(t) \\prod_{\\kappa=1}^{f} \\lvert \\varphi_1^{(\\kappa)}(t) \\rangle \\right)\n$$\n$$\n= |A_{11\\dots1}(t)|^2 \\prod_{\\kappa=1}^{f} \\langle \\varphi_1^{(\\kappa)}(t) \\lvert \\varphi_1^{(\\kappa)}(t) \\rangle\n$$\nDue to the orthonormality constraint on the SPFs, we have $\\langle \\varphi_1^{(\\kappa)}(t) \\lvert \\varphi_1^{(\\kappa)}(t) \\rangle = 1$ for each mode $\\kappa$. The normalization condition thus implies:\n$$\n|A_{11\\dots1}(t)|^2 = 1\n$$\nThis means that the coefficient $A_{11\\dots1}(t)$ is a pure phase factor, which can be written as $e^{i\\gamma(t)}$ for some real function $\\gamma(t)$. A global phase factor on the total wavefunction is physically unobservable. It can be absorbed into the definition of the SPFs or, more simply, set to $1$ by a choice of gauge. With this gauge choice, the wavefunction ansatz simplifies to a single time-dependent Hartree product:\n$$\n\\lvert \\Psi(t) \\rangle = \\prod_{\\kappa=1}^{f} \\lvert \\varphi_1^{(\\kappa)}(t) \\rangle\n$$\nThis is precisely the ansatz of the Time-Dependent Hartree (TDH) method, which is a mean-field theory.\n\nApplying the Dirac-Frenkel Variational Principle to this product ansatz yields the equations of motion for the SPFs $\\lvert \\varphi_1^{(\\kappa)}(t) \\rangle$. These are the well-known TDH equations, where each SPF evolves under the influence of a mean-field Hamiltonian. The mean-field Hamiltonian for mode $\\lambda$, denoted $\\langle \\hat{H} \\rangle^{(\\lambda)}$, is the total Hamiltonian $\\hat{H}$ averaged over the current states of all other modes:\n$$\n\\langle \\hat{H} \\rangle^{(\\lambda)}(t) = \\left\\langle \\prod_{\\kappa \\neq \\lambda} \\varphi_1^{(\\kappa)}(t) \\middle| \\hat{H} \\middle| \\prod_{\\kappa \\neq \\lambda} \\varphi_1^{(\\kappa)}(t) \\right\\rangle\n$$\nThe notation indicates integration over all coordinates except those of mode $\\lambda$. The evolution of each SPF is then governed by an equation of the form $i\\,\\partial_t \\lvert \\varphi_1^{(\\lambda)} \\rangle = \\hat{H}_{\\text{eff}}^{(\\lambda)} \\lvert \\varphi_1^{(\\lambda)} \\rangle$, which are the TDH equations.\n\nNow, we analyze the concept of correlation. By definition, a wavefunction that can be written as a single product of functions of different degrees of freedom, $\\lvert \\Psi \\rangle = \\lvert \\psi_1 \\rangle \\otimes \\lvert \\psi_2 \\rangle \\otimes \\dots \\otimes \\lvert \\psi_f \\rangle$, is a product state. Such a state is uncorrelated, meaning it contains no quantum entanglement between the degrees of freedom. The reduced density matrix for any subsystem (a single mode or a group of modes) is a pure state projector. For instance, for mode $\\lambda$, the reduced density operator is $\\hat{\\rho}^{(\\lambda)} = \\text{Tr}_{\\kappa \\neq \\lambda}[\\lvert \\Psi \\rangle \\langle \\Psi \\rvert] = \\lvert \\varphi_1^{(\\lambda)} \\rangle \\langle \\varphi_1^{(\\lambda)} \\rvert$. Since this is a pure state projector, its von Neumann entropy, $S(\\hat{\\rho}^{(\\lambda)}) = -\\text{Tr}(\\hat{\\rho}^{(\\lambda)} \\ln \\hat{\\rho}^{(\\lambda)})$, is zero. This holds for any bipartition of the system, confirming the complete absence of inter-mode entanglement.\n\nThe single-particle density matrix for mode $\\kappa$, in the basis of its own SPFs, is defined as $\\rho_{mn}^{(\\kappa)} = \\text{Tr}'[\\mathbf{A}^\\dagger (\\mathbf{1}^{(\\kappa'<\\kappa)}\\otimes\\mathbf{C}_{nm}^{(\\kappa)}\\otimes\\mathbf{1}^{(\\kappa'>\\kappa)})\\mathbf{A}]$, where $\\text{Tr}'$ is a trace over all mode indices except $\\kappa$. In our case $m=n=1$, so $\\rho_{11}^{(\\kappa)}$ is the trace over the squared modulus of the A-vector. Since there's only one coefficient $A_{1...1}$ with $|A_{1...1}|^2=1$, we get $\\rho_{11}^{(\\kappa)}=1$. This is a $1 \\times 1$ identity matrix.\n\nWith this foundation, we evaluate the options.\n\n**Option-by-Option Analysis**\n\n**A. With $n_\\kappa=1$ for all modes, the configuration tensor reduces to a single complex scalar that can be gauged to a physically irrelevant global phase; the equations of motion for the SPFs become the time-dependent Hartree (TDH) mean-field equations, and the total wavefunction is a single time-dependent Hartree product.**\n- The configuration tensor $A_{j_1 \\dots j_f}$ becomes a single element $A_{1 \\dots 1}$. This is correct.\n- Normalization requires $|A_{1 \\dots 1}|^2=1$, making it a phase factor that can be set to $1$ via a gauge transformation. This is correct.\n- This reduction of the MCTDH ansatz to a single Hartree product, $\\lvert \\Psi \\rangle = \\prod_\\kappa \\lvert \\varphi_1^{(\\kappa)}\\rangle$, is the defining feature of the TDH method. The corresponding equations of motion are the TDH equations. This is correct.\n- Consequently, the wavefunction is a single time-dependent Hartree product. This is correct.\n**Verdict: Correct.**\n\n**B. Even with $n_\\kappa=1$, the MCTDH ansatz retains inter-mode correlation through time-dependent configuration coefficients, so entanglement between distinct modes can remain nonzero.**\n- As derived, the wavefunction becomes a single Hartree product. By definition, such a state has zero inter-mode correlation or entanglement. The configuration \"coefficients\" have collapsed to a single global phase, which cannot describe correlations between subsystems. This statement directly contradicts the mathematical result.\n**Verdict: Incorrect.**\n\n**C. In the $n_\\kappa=1$ limit, the single-particle density matrix for each mode is a $1\\times 1$ identity, corresponding to a rank-$1$ projector; the von Neumann entanglement entropy between any bipartition of distinct modes is therefore $0$, and any coupling between modes enters only through mean-field potentials in the SPF equations.**\n- The single-particle density matrix $\\rho_{11}^{(\\kappa)}=1$ is the $1 \\times 1$ identity. This is correct.\n- The corresponding density operator $\\hat{\\rho}^{(\\kappa)} = \\lvert \\varphi_1^{(\\kappa)} \\rangle \\langle \\varphi_1^{(\\kappa)} \\rvert$ is a rank-$1$ projector. This is correct.\n- The total state is a product state. For any bipartition, the reduced density matrix of a subsystem is pure. The von Neumann entropy of a pure state is zero. This is correct.\n- As seen in the derivation of the TDH equations, the influence of other modes on a given mode $\\lambda$ is entirely encapsulated in the mean-field Hamiltonian $\\langle \\hat{H} \\rangle^{(\\lambda)}$. This is correct.\n**Verdict: Correct.**\n\n**D. If the Hamiltonian is strictly separable as $\\hat{H}=\\sum_{\\kappa=1}^f \\hat{h}^{(\\kappa)}$ with no inter-mode couplings, then the $n_\\kappa=1$ limit yields exact dynamics; for nonseparable couplings, the error arises from the neglect of inter-mode correlation beyond mean-field.**\n- For a separable Hamiltonian, if the initial state is a product state, the exact solution of the TDSE remains a product state for all time: $\\lvert \\Psi(t)\\rangle = \\prod_\\kappa e^{-i\\hat{h}^{(\\kappa)}t} \\lvert \\psi_\\kappa(0)\\rangle$. The TDH ($n_\\kappa=1$) ansatz is capable of representing this exact solution form. Thus, it provides the exact dynamics in this specific case. This is correct.\n- For a non-separable Hamiltonian, coupling terms generally create entanglement, meaning the true wavefunction is no longer a simple product state. The TDH approximation, by its very structure, is constrained to a single Hartree product and cannot represent this entanglement. The error is therefore precisely due to this neglect of correlation. This is correct.\n**Verdict: Correct.**\n\n**E. By grouping several physical coordinates into a single combined mode, one may represent correlation within that group even with $n_\\kappa=1$, but correlations between different groups remain excluded in this limit.**\n- This describes the technique of mode combination. Let a single logical mode $\\kappa$ be composed of several physical coordinates $\\{q_1, q_2, \\dots\\}$. The corresponding SPF for this mode, $\\lvert \\varphi_1^{(\\kappa)}\\rangle$, is a function of all these coordinates, i.e., $\\varphi_1^{(\\kappa)}(q_1, q_2, \\dots, t)$. Such a multi-dimensional function can represent any arbitrary state in the Hilbert space of these combined coordinates, including highly correlated (entangled) states between $q_1, q_2, \\dots$. This part of the statement is correct.\n- However, if the total wavefunction is constructed with $n_\\kappa=1$ for all such combined modes (groups), it will be a product of the SPFs for each group: $\\lvert \\Psi(t) \\rangle = \\lvert \\varphi_1^{(1)}(t) \\rangle \\otimes \\lvert \\varphi_1^{(2)}(t) \\rangle \\otimes \\dots$. This state has no correlation *between* the different groups. This part of the statement is also correct.\n**Verdict: Correct.**", "answer": "$$\\boxed{ACDE}$$", "id": "2818034"}, {"introduction": "Once we move beyond the mean-field limit by using multiple SPFs to describe correlation, we immediately face a practical challenge: the number of configuration coefficients grows exponentially with the number of system dimensions. This exercise provides a hands-on, quantitative look at this \"curse of dimensionality\" by comparing the memory cost of storing the full coefficient tensor versus a compressed tensor-network representation [@problem_id:2817991]. By calculating the immense storage savings offered by the Tensor Train (TT) format, you will understand the computational innovation that makes MCTDH a tractable method for high-dimensional quantum dynamics.", "problem": "Consider a multi-configuration time-dependent Hartree (MCTDH) wavefunction for a system with $f$ degrees of freedom, written in a direct-product basis of time-dependent single-particle functions as\n$$\n|\\Psi(t)\\rangle \\;=\\; \\sum_{j_1=1}^{n_1}\\cdots \\sum_{j_f=1}^{n_f} A_{j_1\\cdots j_f}(t)\\,\\bigotimes_{k=1}^{f} |\\varphi^{(k)}_{j_k}(t)\\rangle\n$$\nwhere $A_{j_1\\cdots j_f}(t)$ is the configuration coefficient tensor. Suppose each coefficient is stored as a complex $128$-bit number (that is, $16$ bytes per entry).\n\nYou are told that the system has $f=8$ modes with mode dimensions $n_1=n_2=20$, $n_3=n_4=18$, $n_5=n_6=16$, and $n_7=n_8=14$. You consider two storage strategies for $A_{j_1\\cdots j_f}$:\n- The full dense tensor, which stores all entries explicitly.\n- A Tensor Train (TT), also known as a Matrix Product State (MPS), with uniform TT-ranks $r_k=r=30$ for $k=1,\\dots,f-1$ and boundary ranks $r_0=r_f=1$.\n\nStarting only from the definitions of the direct-product expansion above and the TT representation as a product of $f$ three-index cores of sizes $r_{k-1}\\times n_k\\times r_k$, do the following:\n- Derive the total parameter count for the dense and TT representations.\n- Convert parameter counts into memory requirements using the given per-entry byte size.\n- In your derivation, briefly justify, using scaling arguments, why Tensor Train and related formats such as Tucker and Hierarchical Tucker (HT) can provide dramatic savings over the dense tensor for high $f$.\n\nCompute the compression factor $\\rho$ defined as the ratio of the dense-memory to TT-memory,\n$$\n\\rho \\;=\\; \\frac{\\text{dense memory (bytes)}}{\\text{TT memory (bytes)}}\n$$\nfor the specific $f$ and $\\{n_k\\}$ and $r$ given above. Round your final numerical result for $\\rho$ to four significant figures. Report $\\rho$ as a pure number without any unit. If you choose to make any intermediate unit conversions, assume $1\\,\\text{GB} = 1.0\\times 10^{9}\\,\\text{bytes}$ and state any such conversion explicitly in your reasoning, but the final reported value of $\\rho$ must be unitless and rounded as requested.", "solution": "First, we derive the memory requirement for the dense tensor representation of $A_{j_1 \\cdots j_f}$. This tensor is of order $f=8$. The size of the $k$-th dimension is $n_k$. The total number of complex coefficients, $N_{\\text{dense}}$, is the product of the dimensions of all modes:\n$$\nN_{\\text{dense}} = \\prod_{k=1}^{f} n_k\n$$\nUsing the provided values $f=8$, $n_1=n_2=20$, $n_3=n_4=18$, $n_5=n_6=16$, and $n_7=n_8=14$:\n$$\nN_{\\text{dense}} = n_1 \\times n_2 \\times n_3 \\times n_4 \\times n_5 \\times n_6 \\times n_7 \\times n_8\n$$\n$$\nN_{\\text{dense}} = 20^2 \\times 18^2 \\times 16^2 \\times 14^2 = (20 \\times 18 \\times 16 \\times 14)^2\n$$\n$$\nN_{\\text{dense}} = (80640)^2 = 6,502,809,600\n$$\nEach coefficient is a complex number requiring $16$ bytes of storage. Thus, the total memory for the dense tensor, $M_{\\text{dense}}$, is:\n$$\nM_{\\text{dense}} = N_{\\text{dense}} \\times 16\\,\\text{bytes} = 6,502,809,600 \\times 16 = 104,044,953,600\\,\\text{bytes}\n$$\nFor context, using the problem's specified conversion $1\\,\\text{GB} = 1.0 \\times 10^9\\,\\text{bytes}$, this memory is approximately $104\\,\\text{GB}$, which is a substantial amount.\n\nNext, we derive the memory requirement for the Tensor Train (TT) representation, also known as a Matrix Product State (MPS). In this format, the tensor $A$ is represented by a sequence of $f$ cores, which we denote as $C^{(k)}$. The element $A_{j_1 \\cdots j_f}$ is expressed as a matrix product:\n$$\nA_{j_1\\cdots j_f} = C^{(1)}_{j_1} C^{(2)}_{j_2} \\cdots C^{(f)}_{j_f}\n$$\nwhere for each physical index $j_k$, $C^{(k)}_{j_k}$ is a matrix of size $r_{k-1} \\times r_k$. The indices $\\alpha_{k-1}$ and $\\alpha_k$ that connect the cores are called bond or auxiliary indices, and their dimensions $r_{k-1}$ and $r_k$ are the TT-ranks. Each core $C^{(k)}$ is itself a three-index tensor of size $n_k \\times r_{k-1} \\times r_k$. The total number of parameters to be stored, $N_{\\text{TT}}$, is the sum of the sizes of all the cores:\n$$\nN_{\\text{TT}} = \\sum_{k=1}^{f} \\text{size}(C^{(k)}) = \\sum_{k=1}^{f} n_k \\times r_{k-1} \\times r_k\n$$\nThe problem specifies boundary ranks $r_0=r_f=1$ and uniform internal ranks $r_k=r=30$ for $k=1,\\dots,f-1$. We can expand the sum for $f=8$:\n$$\nN_{\\text{TT}} = (n_1 r_0 r_1) + (n_2 r_1 r_2) + (n_3 r_2 r_3) + (n_4 r_3 r_4) + (n_5 r_4 r_5) + (n_6 r_5 r_6) + (n_7 r_6 r_7) + (n_8 r_7 r_8)\n$$\nSubstituting the given ranks ($r_0=1$, $r_8=1$, and $r_k=r=30$ for $k=1,\\dots,7$):\n$$\nN_{\\text{TT}} = (n_1 \\cdot 1 \\cdot r) + (n_2 \\cdot r \\cdot r) + (n_3 \\cdot r \\cdot r) + (n_4 \\cdot r \\cdot r) + (n_5 \\cdot r \\cdot r) + (n_6 \\cdot r \\cdot r) + (n_7 \\cdot r \\cdot r) + (n_8 \\cdot r \\cdot 1)\n$$\n$$\nN_{\\text{TT}} = n_1 r + r^2(n_2+n_3+n_4+n_5+n_6+n_7) + n_8 r\n$$\nWe now substitute the numerical values for the mode dimensions $\\{n_k\\}$ and the rank $r=30$:\n$$\n\\sum_{k=2}^{7} n_k = n_2+n_3+n_4+n_5+n_6+n_7 = 20 + 18 + 18 + 16 + 16 + 14 = 102\n$$\n$$\nN_{\\text{TT}} = (20 \\times 30) + (30^2 \\times 102) + (14 \\times 30)\n$$\n$$\nN_{\\text{TT}} = 600 + (900 \\times 102) + 420\n$$\n$$\nN_{\\text{TT}} = 600 + 91800 + 420 = 92820\n$$\nThe total memory for the TT representation, $M_{\\text{TT}}$, is:\n$$\nM_{\\text{TT}} = N_{\\text{TT}} \\times 16\\,\\text{bytes} = 92820 \\times 16 = 1,485,120\\,\\text{bytes}\n$$\nThis is approximately $1.49\\,\\text{MB}$.\n\nThe problem requires a brief justification for the dramatic savings provided by tensor network formats for high $f$. The storage cost of a dense tensor of order $f$ with average mode dimension $n$ scales as $O(n^f)$. This is exponential growth, a phenomenon known as the \"curse of dimensionality\", which makes direct storage and manipulation computationally intractable for even moderate $f$. In contrast, the storage cost for a Tensor Train (TT) scales as $O(f n r^2)$, where $r$ is the maximum TT-rank. This scaling is linear in the number of dimensions $f$. For many physical systems, the entanglement or correlation between distant subsystems is limited, which results in the required rank $r$ remaining small or growing slowly with $f$. The transition from exponential scaling $O(n^f)$ to linear scaling $O(f n r^2)$ is the source of the immense computational savings. Other formats like the Tucker decomposition have a storage cost of $O(f n r + r^f)$, which still contains an exponential term in its core tensor, making it less efficient than TT for very large $f$. The Hierarchical Tucker (HT) format also achieves linear scaling, $O(f n r + f r^3)$, by recursively applying a tree-based decomposition, making both TT and HT highly effective for high-dimensional problems.\n\nFinally, we compute the compression factor $\\rho$:\n$$\n\\rho = \\frac{M_{\\text{dense}}}{M_{\\text{TT}}} = \\frac{N_{\\text{dense}} \\times 16}{N_{\\text{TT}} \\times 16} = \\frac{N_{\\text{dense}}}{N_{\\text{TT}}}\n$$\n$$\n\\rho = \\frac{6,502,809,600}{92,820} \\approx 70058.27407886\n$$\nThe problem requires this result to be rounded to four significant figures. The fifth significant digit is $8$, so we round the fourth digit up.\n$$\n\\rho \\approx 70060\n$$\nExpressing this in scientific notation to make the number of significant figures unambiguous:\n$$\n\\rho \\approx 7.006 \\times 10^4\n$$\nThis demonstrates that the TT representation is over $70,000$ times more compact than the dense tensor for this specific case.", "answer": "$$\n\\boxed{7.006 \\times 10^4}\n$$", "id": "2817991"}, {"introduction": "With a powerful and efficient method for representing a complex wavefunction, a critical practical question arises: how do we know if our basis is sufficient? This practice problem delves into the concept of natural populations, the eigenvalues of the single-particle reduced density operator, which form the theoretical bedrock for assessing convergence in an MCTDH calculation. You will reason from first principles why these populations provide a rigorous and basis-invariant a posteriori diagnostic to judge the quality of the chosen SPF basis and to quantify the error introduced by its truncation, linking the formal theory of Schmidt decomposition to the practical art of performing a converged simulation [@problem_id:2818016].", "problem": "Consider a pure state $|\\Psi(t)\\rangle$ of an $f$-mode system with Hilbert space $\\mathcal{H}=\\bigotimes_{\\kappa=1}^{f}\\mathcal{H}^{(\\kappa)}$, propagated within the Multi-Configuration Time-Dependent Hartree (MCTDH) framework. In MCTDH, one expands $|\\Psi(t)\\rangle$ in a time-dependent product basis of single-particle functions (SPFs) $\\{|\\varphi_{i}^{(\\kappa)}(t)\\rangle\\}_{i=1}^{n_{\\kappa}}$ for each mode $\\kappa$, with time-dependent configuration coefficients. The equations of motion are obtained from the Dirac–Frenkel Time-Dependent Variational Principle (TDVP), and the SPF gauge is restricted to unitary rotations within each mode. For any mode $\\kappa$, define the reduced density operator by the partial trace $\\hat{\\rho}^{(\\kappa)}(t)=\\operatorname{Tr}_{\\neq \\kappa}\\left(|\\Psi(t)\\rangle\\langle\\Psi(t)|\\right)$ acting on $\\mathcal{H}^{(\\kappa)}$. The eigenvalues of $\\hat{\\rho}^{(\\kappa)}(t)$ will be called the natural populations for mode $\\kappa$.\n\nYou are to reason from first principles of bipartite pure states and properties of reduced density operators, without assuming any special structure beyond normalization and positivity. Based on these principles, assess the following statements about natural populations and their use as an a posteriori error indicator for SPF truncation in MCTDH. Select all statements that are correct.\n\nA. The natural populations $\\{n_{\\alpha}^{(\\kappa)}(t)\\}$ are the squares of the Schmidt coefficients for the bipartition $\\mathcal{H}^{(\\kappa)}\\otimes\\mathcal{H}^{(\\neq \\kappa)}$ of $|\\Psi(t)\\rangle$. If one truncates the SPF space of mode $\\kappa$ to the $m_{\\kappa}$-dimensional subspace spanned by the eigenvectors of $\\hat{\\rho}^{(\\kappa)}$ with the $m_{\\kappa}$ largest populations, then among all possible $m_{\\kappa}$-dimensional SPF subspaces this choice minimizes the $2$-norm of the truncation error, and the squared norm of the discarded component equals $\\sum_{\\alpha>m_{\\kappa}} n_{\\alpha}^{(\\kappa)}(t)$. Consequently, the cumulative discarded population provides an a posteriori upper bound on the truncation error. This construction and bound are invariant under unitary rotations of the SPFs.\n\nB. The natural populations depend on the particular gauge (time-dependent unitary rotations) chosen for the SPFs of mode $\\kappa$, and therefore cannot serve as a well-defined a posteriori indicator unless the gauge is fixed by an external convention.\n\nC. For a normalized $|\\Psi(t)\\rangle$, the trace of $\\hat{\\rho}^{(\\kappa)}(t)$ equals $n_{\\kappa}$, the number of SPFs used for mode $\\kappa$. Hence, increasing $n_{\\kappa}$ guarantees that $\\operatorname{Tr}\\hat{\\rho}^{(\\kappa)}(t)$ approaches $n_{\\kappa}$, serving as a direct convergence measure.\n\nD. If one discards all SPFs whose individual natural population is below a threshold $\\varepsilon>0$, then the $2$-norm of the discarded component is always at most $\\varepsilon$, independently of how many such SPFs are discarded.", "solution": "The problem asks for an assessment of several statements regarding the properties and utility of natural populations in the context of the Multi-Configuration Time-Dependent Hartree (MCTDH) method. The evaluation must be based on the first principles of quantum mechanics for bipartite pure states.\n\nLet us begin by establishing these principles. The system is described by a pure state $|\\Psi(t)\\rangle$ in a Hilbert space $\\mathcal{H}=\\bigotimes_{\\kappa=1}^{f}\\mathcal{H}^{(\\kappa)}$ which is normalized, $\\langle\\Psi(t)|\\Psi(t)\\rangle=1$. For any given mode $\\kappa$, we can partition the Hilbert space into a bipartite structure $\\mathcal{H} = \\mathcal{H}^{(\\kappa)} \\otimes \\mathcal{H}^{(\\neq \\kappa)}$, where $\\mathcal{H}^{(\\neq \\kappa)} = \\bigotimes_{j\\neq \\kappa} \\mathcal{H}^{(j)}$.\n\nAccording to the Schmidt decomposition theorem, any pure state $|\\Psi(t)\\rangle$ in such a bipartite space can be written as:\n$$ |\\Psi(t)\\rangle = \\sum_{\\alpha=1}^{r} \\sqrt{n_{\\alpha}^{(\\kappa)}(t)} |\\chi_{\\alpha}^{(\\kappa)}(t)\\rangle \\otimes |\\Phi_{\\alpha}^{(\\neq \\kappa)}(t)\\rangle $$\nHere, $\\{|\\chi_{\\alpha}^{(\\kappa)}(t)\\rangle\\}$ and $\\{|\\Phi_{\\alpha}^{(\\neq \\kappa)}(t)\\rangle\\}$ are two sets of orthonormal vectors (the Schmidt vectors) spanning subspaces of $\\mathcal{H}^{(\\kappa)}$ and $\\mathcal{H}^{(\\neq \\kappa)}$, respectively. The coefficients $\\sqrt{n_{\\alpha}^{(\\kappa)}(t)}$ are the Schmidt coefficients, which are real and non-negative. For a normalized state, they satisfy $\\sum_{\\alpha=1}^{r} n_{\\alpha}^{(\\kappa)}(t) = 1$. The number of terms, $r$, is the Schmidt rank.\n\nThe reduced density operator for mode $\\kappa$ is defined as $\\hat{\\rho}^{(\\kappa)}(t) = \\operatorname{Tr}_{\\neq \\kappa}\\left(|\\Psi(t)\\rangle\\langle\\Psi(t)|\\right)$. Substituting the Schmidt decomposition into this definition yields:\n$$ \\hat{\\rho}^{(\\kappa)}(t) = \\operatorname{Tr}_{\\neq \\kappa} \\left( \\sum_{\\alpha, \\beta} \\sqrt{n_{\\alpha}^{(\\kappa)} n_{\\beta}^{(\\kappa)}} |\\chi_{\\alpha}^{(\\kappa)}\\rangle\\langle\\chi_{\\beta}^{(\\kappa)}| \\otimes |\\Phi_{\\alpha}^{(\\neq \\kappa)}\\rangle\\langle\\Phi_{\\beta}^{(\\neq \\kappa)}| \\right) $$\n$$ \\hat{\\rho}^{(\\kappa)}(t) = \\sum_{\\alpha, \\beta} \\sqrt{n_{\\alpha}^{(\\kappa)} n_{\\beta}^{(\\kappa)}} |\\chi_{\\alpha}^{(\\kappa)}\\rangle\\langle\\chi_{\\beta}^{(\\kappa)}| \\operatorname{Tr}_{\\neq \\kappa}\\left( |\\Phi_{\\alpha}^{(\\neq \\kappa)}\\rangle\\langle\\Phi_{\\beta}^{(\\neq \\kappa)}| \\right) $$\nDue to the orthonormality of the Schmidt vectors, $\\operatorname{Tr}_{\\neq \\kappa}\\left( |\\Phi_{\\alpha}^{(\\neq \\kappa)}\\rangle\\langle\\Phi_{\\beta}^{(\\neq \\kappa)}| \\right) = \\langle\\Phi_{\\beta}^{(\\neq \\kappa)}|\\Phi_{\\alpha}^{(\\neq \\kappa)}\\rangle = \\delta_{\\alpha\\beta}$. This simplifies the expression for the reduced density operator to its spectral decomposition:\n$$ \\hat{\\rho}^{(\\kappa)}(t) = \\sum_{\\alpha=1}^{r} n_{\\alpha}^{(\\kappa)}(t) |\\chi_{\\alpha}^{(\\kappa)}(t)\\rangle\\langle\\chi_{\\alpha}^{(\\kappa)}(t)| $$\nFrom this, we see that the eigenvalues of $\\hat{\\rho}^{(\\kappa)}(t)$ are the quantities $\\{n_{\\alpha}^{(\\kappa)}(t)\\}$, which are precisely the natural populations as defined in the problem. The corresponding eigenvectors $\\{|\\chi_{\\alpha}^{(\\kappa)}(t)\\rangle\\}$ are the Schmidt vectors for mode $\\kappa$, also known as the natural orbitals or natural SPFs.\n\nA crucial property for basis truncation is a consequence of the Eckart-Young-Mirsky theorem applied to tensors. It states that the best approximation of $|\\Psi(t)\\rangle$ by a state that can be represented using only $m_{\\kappa}$ basis functions for mode $\\kappa$ is obtained by projecting $|\\Psi(t)\\rangle$ onto the subspace spanned by the $m_{\\kappa}$ natural orbitals $\\{|\\chi_{\\alpha}^{(\\kappa)}(t)\\rangle\\}$ corresponding to the $m_{\\kappa}$ largest natural populations. Let $P_{m_{\\kappa}}$ be the projector onto this optimal $m_{\\kappa}$-dimensional subspace of $\\mathcal{H}^{(\\kappa)}$. The projection of the full state is accomplished by the operator $\\mathcal{P}_{m_{\\kappa}} = P_{m_{\\kappa}} \\otimes \\mathbf{1}_{\\neq \\kappa}$. The discarded component of the state is $(\\mathbf{1} - \\mathcal{P}_{m_{\\kappa}})|\\Psi(t)\\rangle$. The squared $2$-norm of this discarded component is:\n$$ \\|(\\mathbf{1} - \\mathcal{P}_{m_{\\kappa}})|\\Psi(t)\\rangle\\|^2 = \\langle\\Psi(t)|(\\mathbf{1} - \\mathcal{P}_{m_{\\kappa}})|\\Psi(t)\\rangle = 1 - \\langle\\Psi(t)|\\mathcal{P}_{m_{\\kappa}}|\\Psi(t)\\rangle $$\nThe retained part is $\\langle\\Psi(t)|\\mathcal{P}_{m_{\\kappa}}|\\Psi(t)\\rangle = \\operatorname{Tr}(\\mathcal{P}_{m_{\\kappa}}|\\Psi(t)\\rangle\\langle\\Psi(t)|) = \\operatorname{Tr}_{\\kappa}(P_{m_{\\kappa}}\\hat{\\rho}^{(\\kappa)}) = \\sum_{\\alpha=1}^{m_{\\kappa}} n_{\\alpha}^{(\\kappa)}(t)$.\nTherefore, the squared norm of the discarded component is $1 - \\sum_{\\alpha=1}^{m_{\\kappa}} n_{\\alpha}^{(\\kappa)}(t) = \\sum_{\\alpha>m_{\\kappa}} n_{\\alpha}^{(\\kappa)}(t)$, which is the sum of the neglected natural populations.\n\nFinally, the definition of $\\hat{\\rho}^{(\\kappa)}(t)$ depends only on the state $|\\Psi(t)\\rangle$ and the choice of the subsystem $\\kappa$. It does not depend on any particular basis used to represent vectors in $\\mathcal{H}^{(\\kappa)}$. Consequently, its eigenvalues (the natural populations) and eigenvectors (the natural orbitals) are invariant under unitary transformations of the working SPF basis $\\{|\\varphi_{i}^{(\\kappa)}(t)\\rangle\\}$ used in the MCTDH ansatz. This gauge invariance is essential.\n\nWith these principles established, we evaluate the options.\n\n**A.** The natural populations $\\{n_{\\alpha}^{(\\kappa)}(t)\\}$ are the squares of the Schmidt coefficients for the bipartition $\\mathcal{H}^{(\\kappa)}\\otimes\\mathcal{H}^{(\\neq \\kappa)}$ of $|\\Psi(t)\\rangle$. If one truncates the SPF space of mode $\\kappa$ to the $m_{\\kappa}$-dimensional subspace spanned by the eigenvectors of $\\hat{\\rho}^{(\\kappa)}$ with the $m_{\\kappa}$ largest populations, then among all possible $m_{\\kappa}$-dimensional SPF subspaces this choice minimizes the $2$-norm of the truncation error, and the squared norm of the discarded component equals $\\sum_{\\alpha>m_{\\kappa}} n_{\\alpha}^{(\\kappa)}(t)$. Consequently, the cumulative discarded population provides an a posteriori upper bound on the truncation error. This construction and bound are invariant under unitary rotations of the SPFs.\n\n- The statement that natural populations are the squares of Schmidt coefficients is correct, as shown by our derivation where $n_{\\alpha}^{(\\kappa)}$ appeared as the square of the Schmidt coefficient $\\sqrt{n_{\\alpha}^{(\\kappa)}}$.\n- The statement that truncating to the basis of natural orbitals corresponding to the largest populations minimizes the $2$-norm of the error is the essence of the Schmidt approximation theorem, which is correct.\n- The statement that the squared norm of the discarded component equals the sum of the discarded populations, $\\sum_{\\alpha>m_{\\kappa}} n_{\\alpha}^{(\\kappa)}(t)$, is also correct, as derived above.\n- The statement that the construction is invariant under unitary rotations of working SPFs is correct.\n- The final claim is that the cumulative discarded population $\\delta = \\sum_{\\alpha>m_{\\kappa}} n_{\\alpha}^{(\\kappa)}(t)$ provides an \"upper bound on the truncation error\". This phrasing is imprecise. If the \"truncation error\" is defined as the $2$-norm of the discarded vector, its value is $\\sqrt{\\delta}$. For $\\delta \\in (0, 1)$, we have $\\sqrt{\\delta} > \\delta$, so $\\delta$ would be a lower bound, not an upper bound. However, it is standard practice to interpret \"truncation error\" as a more general concept. For instance, the error in the expectation value of an observable $\\hat{O}^{(\\kappa)}$ acting only on mode $\\kappa$ is bounded by $\\delta \\cdot \\|\\hat{O}^{(\\kappa)}\\|_{\\infty}$, where $\\|\\cdot\\|_{\\infty}$ is the operator norm. If we consider observables with $\\|\\hat{O}^{(\\kappa)}\\|_{\\infty} \\le 1$, then $\\delta$ is indeed an upper bound on this physical error. Also, the infidelity, $1-F$, between the exact state and the best normalized approximation is related to $\\delta$. Given that all other parts of the statement are not just correct but represent the core theoretical justification for using natural populations, and options B, C, and D are fundamentally flawed, this statement is the only viable choice. We accept it under the physically reasonable interpretation that \"truncation error\" refers to a quantity like the infidelity or the error in bounded local observables.\n\nVerdict: **Correct**.\n\n**B.** The natural populations depend on the particular gauge (time-dependent unitary rotations) chosen for the SPFs of mode $\\kappa$, and therefore cannot serve as a well-defined a posteriori indicator unless the gauge is fixed by an external convention.\n\n- As established in our preliminary analysis, the reduced density operator $\\hat{\\rho}^{(\\kappa)}(t)$ is defined intrinsically from the state $|\\Psi(t)\\rangle$ by tracing out other degrees of freedom. Its eigenvalues, the natural populations, are therefore independent of any basis choice or gauge for the SPFs in mode $\\kappa$. This gauge-invariance is precisely what makes them a \"well-defined\" indicator. This statement asserts the opposite and is therefore incorrect.\n\nVerdict: **Incorrect**.\n\n**C.** For a normalized $|\\Psi(t)\\rangle$, the trace of $\\hat{\\rho}^{(\\kappa)}(t)$ equals $n_{\\kappa}$, the number of SPFs used for mode $\\kappa$. Hence, increasing $n_{\\kappa}$ guarantees that $\\operatorname{Tr}\\hat{\\rho}^{(\\kappa)}(t)$ approaches $n_{\\kappa}$, serving as a direct convergence measure.\n\n- The trace of any density operator, including a reduced density operator derived from a normalized pure state, must equal $1$. We can see this directly: $\\operatorname{Tr}(\\hat{\\rho}^{(\\kappa)}(t)) = \\sum_{\\alpha} n_{\\alpha}^{(\\kappa)}(t)$. And from the normalization of the state $|\\Psi(t)\\rangle$, the sum of the squares of the Schmidt coefficients is one, so $\\sum_{\\alpha} n_{\\alpha}^{(\\kappa)}(t) = 1$. The statement that the trace equals $n_{\\kappa}$ is fundamentally incorrect. The trace of the identity operator on the $n_{\\kappa}$-dimensional SPF space is $n_{\\kappa}$, but this is not the reduced density operator.\n\nVerdict: **Incorrect**.\n\n**D.** If one discards all SPFs whose individual natural population is below a threshold $\\varepsilon>0$, then the $2$-norm of the discarded component is always at most $\\varepsilon$, independently of how many such SPFs are discarded.\n\n- Let $I_{discard} = \\{\\alpha \\mid n_{\\alpha}^{(\\kappa)}(t) < \\varepsilon \\}$. The squared $2$-norm of the discarded component is the sum of the corresponding populations: $\\delta = \\sum_{\\alpha \\in I_{discard}} n_{\\alpha}^{(\\kappa)}(t)$. The statement claims that the $2$-norm, $\\sqrt{\\delta}$, is at most $\\varepsilon$. This implies $\\delta \\le \\varepsilon^2$.\n- This is false. Consider a case where the threshold is $\\varepsilon = 0.1$. If there are $N=20$ natural orbitals each with a population of $n_{\\alpha}^{(\\kappa)} = 0.04$, all are below the threshold. The sum of these discarded populations is $\\delta = 20 \\times 0.04 = 0.8$. The statement requires that $\\sqrt{0.8} \\le 0.1$, which is false ($0.894... \\not\\le 0.1$). The total discarded population can be much larger than $\\varepsilon$ or $\\varepsilon^2$; it is only bounded by $1$.\n\nVerdict: **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "2818016"}]}