{"hands_on_practices": [{"introduction": "Before applying complex theoretical models, it is crucial to verify their accuracy in well-understood physical limits. This exercise provides a fundamental test for the Percus-Yevick (PY) and Hypernetted-Chain (HNC) approximations by examining their behavior at low density. By performing a density expansion of the Ornstein-Zernike equation, you will demonstrate that both closures correctly reproduce the exact structure of the fluid to the first order in density, which is a key reason for their widespread use [@problem_id:2645990].", "problem": "Consider a homogeneous, isotropic classical simple fluid at number density $\\rho$ and inverse temperature $\\beta \\equiv 1/(k_{\\mathrm{B}}T)$, with spherically symmetric pair potential $u(r)$. Let $g(r)$ be the radial distribution function, $h(r) \\equiv g(r) - 1$ the total correlation function, and $c(r)$ the direct correlation function. The Ornstein-Zernike (OZ) equation in real space reads\n$$\nh(r_{12}) \\;=\\; c(r_{12}) \\;+\\; \\rho \\int d\\mathbf{r}_{3}\\, c(r_{13})\\,h(r_{32}) \\,,\n$$\nwhere $r_{ij} \\equiv |\\mathbf{r}_{i} - \\mathbf{r}_{j}|$. Define the Mayer function $f(r) \\equiv \\exp[-\\beta u(r)] - 1$ and the convolution $(a*b)(r_{12}) \\equiv \\int d\\mathbf{r}_{3}\\, a(r_{13})\\,b(r_{32})$.\n\nTwo standard closures for the OZ equation are:\n- Hypernetted Chain (HNC): $g(r) = \\exp\\!\\big[-\\beta u(r) + h(r) - c(r)\\big]$.\n- Percus-Yevick (PY): $c(r) = f(r)\\,\\big[1 + \\gamma(r)\\big]$, with $\\gamma(r) \\equiv h(r) - c(r)$.\n\nIt is a fundamental and well-tested result from the theory of classical fluids that in the zero-density limit, the exact radial distribution function satisfies $g(r) \\to \\exp[-\\beta u(r)]$ as $\\rho \\to 0$. Moreover, the exact low-density (virial) expansion yields, to first order in $\\rho$,\n$$\ng_{\\text{exact}}(r_{12}) \\;=\\; \\exp[-\\beta u(r_{12})] \\,\\Big[ 1 \\;+\\; \\rho \\, (f*f)(r_{12}) \\Big] \\;+\\; O(\\rho^{2}) \\,.\n$$\n\nWorking to first order in $\\rho$, use the OZ equation together with each closure separately to derive the corresponding $O(\\rho)$ prediction for $g(r)$, and compare it with the exact expression above. Define the $O(\\rho)$ deviations of the closures as the difference between their predicted $O(\\rho)$ coefficients and the exact coefficient:\n$$\n\\Delta^{(1)}_{\\text{PY}}(r) \\;\\equiv\\; g^{(1)}_{\\text{PY}}(r) \\;-\\; \\exp[-\\beta u(r)]\\, (f*f)(r)\\,,\n\\qquad\n\\Delta^{(1)}_{\\text{HNC}}(r) \\;\\equiv\\; g^{(1)}_{\\text{HNC}}(r) \\;-\\; \\exp[-\\beta u(r)]\\, (f*f)(r)\\,,\n$$\nwhere $g(r) = \\exp[-\\beta u(r)] + \\rho\\, g^{(1)}(r) + O(\\rho^{2})$.\n\nReport your final result as a single row matrix containing the two deviations $\\big(\\Delta^{(1)}_{\\text{PY}}(r),\\,\\Delta^{(1)}_{\\text{HNC}}(r)\\big)$, fully simplified as analytic expressions in terms of $u(r)$ or $f(r)$. No numerical evaluation is required. Express your answer without units.", "solution": "The problem requires the derivation of the first-order density correction to the radial distribution function, $g(r)$, using the Percus-Yevick (PY) and Hypernetted-Chain (HNC) closures, and a comparison with the exact low-density result.\n\nWe begin by performing a density expansion for the correlation functions $h(r)$, $c(r)$, and $g(r)$ to first order in the number density $\\rho$. For a generic function $X(r)$, the expansion is written as:\n$$\nX(r) \\;=\\; X^{(0)}(r) \\;+\\; \\rho X^{(1)}(r) \\;+\\; O(\\rho^2)\n$$\nIn the zero-density limit ($\\rho \\to 0$), the integral term in the Ornstein-Zernike (OZ) equation vanishes, yielding $h(r) = c(r)$. Thus, their zeroth-order components are equal: $h^{(0)}(r) = c^{(0)}(r)$.\nThe problem states that in this limit, the exact radial distribution function is $g(r) \\to \\exp[-\\beta u(r)]$. By definition, $g(r) = h(r) + 1$. The zeroth-order component is therefore:\n$$\ng^{(0)}(r) \\;=\\; h^{(0)}(r) \\;+\\; 1 \\;=\\; \\exp[-\\beta u(r)]\n$$\nFrom this, we identify the zeroth-order total correlation function as the Mayer function, $f(r)$:\n$$\nh^{(0)}(r) \\;=\\; g^{(0)}(r) \\;-\\; 1 \\;=\\; \\exp[-\\beta u(r)] \\;-\\; 1 \\;=\\; f(r)\n$$\nConsequently, the zeroth-order direct correlation function is also the Mayer function:\n$$\nc^{(0)}(r) \\;=\\; h^{(0)}(r) \\;=\\; f(r)\n$$\nThese zeroth-order relations are independent of the closure approximation.\n\nNext, we expand the OZ equation to first order in $\\rho$:\n$$\nh(r) \\;=\\; c(r) \\;+\\; \\rho \\, (c*h)(r)\n$$\nSubstituting the series expansions:\n$$\nh^{(0)}(r) \\;+\\; \\rho h^{(1)}(r) \\;+\\; O(\\rho^2) \\;=\\; [c^{(0)}(r) \\;+\\; \\rho c^{(1)}(r)] \\;+\\; \\rho \\int d\\mathbf{r}_3 [c^{(0)}(r_{13}) \\;+\\; \\dots][h^{(0)}(r_{32}) \\;+\\; \\dots]\n$$\nEquating terms of order $\\rho^1$ gives:\n$$\n\\rho h^{(1)}(r) \\;=\\; \\rho c^{(1)}(r) \\;+\\; \\rho \\int d\\mathbf{r}_3 \\, c^{(0)}(r_{13}) h^{(0)}(r_{32})\n$$\nDividing by $\\rho$ and substituting $c^{(0)}(r) = f(r)$ and $h^{(0)}(r) = f(r)$, we obtain a general relation between the first-order corrections:\n$$\nh^{(1)}(r) \\;=\\; c^{(1)}(r) \\;+\\; (f*f)(r)\n$$\nFurthermore, from the definition $g(r) = h(r) + 1$, we have $g^{(1)}(r) = h^{(1)}(r)$. Therefore:\n$$\ng^{(1)}(r) \\;=\\; c^{(1)}(r) \\;+\\; (f*f)(r)\n$$\nThis equation is the foundation for determining $g^{(1)}(r)$ from any given closure, which provides an expression for $c^{(1)}(r)$.\n\nWe now analyze each closure separately.\n\n**1. Percus-Yevick (PY) Closure**\nThe PY closure is given by $c(r) = f(r) [1 + \\gamma(r)]$, where $\\gamma(r) = h(r) - c(r)$.\nWe expand this relation to first order in $\\rho$:\n$$\nc^{(0)}(r) \\;+\\; \\rho c^{(1)}_{\\text{PY}}(r) \\;=\\; f(r)[1 \\;+\\; (\\gamma^{(0)}(r) \\;+\\; \\rho \\gamma^{(1)}_{\\text{PY}}(r))]\n$$\nAt zeroth order, $\\gamma^{(0)}(r) = h^{(0)}(r) - c^{(0)}(r) = f(r) - f(r) = 0$. Substituting this and $c^{(0)}(r) = f(r)$ into the expanded equation:\n$$\nf(r) \\;+\\; \\rho c^{(1)}_{\\text{PY}}(r) \\;=\\; f(r)[1 \\;+\\; \\rho \\gamma^{(1)}_{\\text{PY}}(r)] \\;=\\; f(r) \\;+\\; \\rho f(r) \\gamma^{(1)}_{\\text{PY}}(r)\n$$\nThis yields the first-order relation for the PY closure: $c^{(1)}_{\\text{PY}}(r) = f(r) \\gamma^{(1)}_{\\text{PY}}(r)$.\nThe first-order term $\\gamma^{(1)}_{\\text{PY}}(r)$ is defined as $h^{(1)}_{\\text{PY}}(r) - c^{(1)}_{\\text{PY}}(r)$. From our general OZ analysis, we know that $h^{(1)}(r) - c^{(1)}(r) = (f*f)(r)$. Thus, $\\gamma^{(1)}_{\\text{PY}}(r) = (f*f)(r)$.\nSubstituting this into the expression for $c^{(1)}_{\\text{PY}}(r)$:\n$$\nc^{(1)}_{\\text{PY}}(r) \\;=\\; f(r) (f*f)(r)\n$$\nNow we can find the first-order correction to the radial distribution function, $g^{(1)}_{\\text{PY}}(r)$, using the general relation $g^{(1)}(r) = h^{(1)}(r) = c^{(1)}(r) + (f*f)(r)$:\n$$\ng^{(1)}_{\\text{PY}}(r) \\;=\\; [f(r)(f*f)(r)] \\;+\\; (f*f)(r) \\;=\\; [1+f(r)](f*f)(r)\n$$\nUsing the definition $f(r) = \\exp[-\\beta u(r)] - 1$, we have $1+f(r) = \\exp[-\\beta u(r)]$. Therefore:\n$$\ng^{(1)}_{\\text{PY}}(r) \\;=\\; \\exp[-\\beta u(r)] (f*f)(r)\n$$\n\n**2. Hypernetted-Chain (HNC) Closure**\nThe HNC closure is given by $g(r) = \\exp[-\\beta u(r) + h(r) - c(r)]$.\nWe can rewrite this as $\\ln g(r) = -\\beta u(r) + h(r) - c(r)$.\nLet us rearrange the terms:\n$$\nh(r) \\;-\\; c(r) \\;=\\; \\ln g(r) \\;+\\; \\beta u(r) \\;=\\; \\ln(g(r)\\exp[\\beta u(r)])\n$$\nRecalling that $1+f(r) = \\exp[-\\beta u(r)]$, we can write $\\exp[\\beta u(r)] = (1+f(r))^{-1}$.\n$$\nh(r) \\;-\\; c(r) \\;=\\; \\ln[g(r)(1+f(r))^{-1}]\n$$\nNow we expand both sides in powers of $\\rho$.\nThe left-hand side is $\\gamma(r) = \\gamma^{(0)}(r) + \\rho \\gamma^{(1)}(r) + \\dots$. As established, $\\gamma^{(0)}(r) = 0$ and $\\gamma^{(1)}(r) = (f*f)(r)$.\nFor the right-hand side, we first expand the argument of the logarithm:\n$$\ng(r)(1+f(r))^{-1} \\;=\\; [g^{(0)}(r) + \\rho g^{(1)}_{\\text{HNC}}(r) + \\dots](1+f(r))^{-1}\n$$\nSubstituting $g^{(0)}(r) = 1+f(r)$:\n$$\n[1+f(r) + \\rho g^{(1)}_{\\text{HNC}}(r)](1+f(r))^{-1} \\;=\\; 1 \\;+\\; \\rho g^{(1)}_{\\text{HNC}}(r)(1+f(r))^{-1}\n$$\nNow, using the expansion $\\ln(1+x) = x - \\frac{1}{2}x^2 + \\dots$ for small $x$:\n$$\n\\ln[1 \\;+\\; \\rho g^{(1)}_{\\text{HNC}}(r)(1+f(r))^{-1}] \\;=\\; \\rho g^{(1)}_{\\text{HNC}}(r)(1+f(r))^{-1} \\;+\\; O(\\rho^2)\n$$\nEquating the first-order terms from both sides of the HNC equation:\n$$\n\\rho \\gamma^{(1)}(r) \\;=\\; \\rho g^{(1)}_{\\text{HNC}}(r)(1+f(r))^{-1}\n$$\nSubstituting $\\gamma^{(1)}(r) = (f*f)(r)$:\n$$\n(f*f)(r) \\;=\\; g^{(1)}_{\\text{HNC}}(r)(1+f(r))^{-1}\n$$\nSolving for $g^{(1)}_{\\text{HNC}}(r)$:\n$$\ng^{(1)}_{\\text{HNC}}(r) \\;=\\; [1+f(r)](f*f)(r) \\;=\\; \\exp[-\\beta u(r)](f*f)(r)\n$$\n\n**Calculation of Deviations**\nThe problem defines the deviations as:\n$$\n\\Delta^{(1)}_{\\text{PY}}(r) \\;\\equiv\\; g^{(1)}_{\\text{PY}}(r) \\;-\\; \\exp[-\\beta u(r)]\\, (f*f)(r)\n$$\n$$\n\\Delta^{(1)}_{\\text{HNC}}(r) \\;\\equiv\\; g^{(1)}_{\\text{HNC}}(r) \\;-\\; \\exp[-\\beta u(r)]\\, (f*f)(r)\n$$\nThe expression for the exact first-order correction, as given in the problem implied by the expansion of $g_{\\text{exact}}(r)$, is $g^{(1)}_{\\text{exact}}(r) = \\exp[-\\beta u(r)](f*f)(r)$.\nOur derivations show that both the PY and HNC closures yield a first-order correction identical to the exact result:\n$$\ng^{(1)}_{\\text{PY}}(r) \\;=\\; g^{(1)}_{\\text{HNC}}(r) \\;=\\; g^{(1)}_{\\text{exact}}(r)\n$$\nTherefore, the deviations are both zero.\n$$\n\\Delta^{(1)}_{\\text{PY}}(r) \\;=\\; \\exp[-\\beta u(r)](f*f)(r) \\;-\\; \\exp[-\\beta u(r)](f*f)(r) \\;=\\; 0\n$$\n$$\n\\Delta^{(1)}_{\\text{HNC}}(r) \\;=\\; \\exp[-\\beta u(r)](f*f)(r) \\;-\\; \\exp[-\\beta u(r)](f*f)(r) \\;=\\; 0\n$$\nThis result is fundamental; it demonstrates that both the PY and HNC approximations are exact to first order in density, and consequently, both theories yield the exact third virial coefficient. The differences between these closures, and their respective inaccuracies, manifest only at the level of the second-order density correction, $g^{(2)}(r)$, and higher.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0\n\\end{pmatrix}\n}\n$$", "id": "2645990"}, {"introduction": "The coupled Ornstein-Zernike and closure equations rarely have analytical solutions and must be solved numerically. The standard approach is a fixed-point iteration that cleverly cycles between real space, where the closure is applied locally, and Fourier space, where the OZ equation's convolution becomes a simple algebraic product. This practice problem challenges you to assemble the correct sequence of operations for a robust Picard iteration scheme, a core skill for implementing any integral equation theory in code [@problem_id:2645948].", "problem": "A homogeneous, isotropic, single-component fluid at number density $\\rho$ and temperature $T$ has radial distribution function $g(r)$, total correlation function $h(r) \\equiv g(r) - 1$, direct correlation function $c(r)$, and indirect correlation function $\\gamma(r) \\equiv h(r) - c(r)$. The Ornstein–Zernike (OZ) equation in real space is an integral equation relating $h(r)$ and $c(r)$ via a convolution, and in wave-vector space (after a Fourier transform) it becomes an algebraic relation between $H(k)$ and $C(k)$. The pair potential is $u(r)$, and $\\beta \\equiv 1/(k_{\\mathrm{B}} T)$. Consider implementing a Picard fixed-point iteration for the coupled OZ-plus-closure problem that uses $\\gamma(r)$ as the primary real-space update. Starting from iterates $h^{(n)}(r)$ and $c^{(n)}(r)$ at step $n$, one wishes to compute $\\gamma^{(n+1)}(r)$ by evaluating the closure in real space, impose the OZ relation in $k$-space through a sequence of Fourier transforms, and return to real space for the next iteration. The closure may be either the Hypernetted Chain (HNC) or the Percus–Yevick (PY) closure, both of which are standard approximations that relate $g(r)$, $h(r)$, $c(r)$, $\\gamma(r)$, and $u(r)$ locally in $r$-space.\n\nWhich option correctly specifies a consistent Picard iteration that (i) updates $\\gamma^{(n+1)}(r)$ from $h^{(n)}(r)$ (and the known $u(r)$) by evaluating the closure in real space, (ii) updates $c^{(n+1)}(r)$ from the definition of $\\gamma(r)$, and then (iii) enforces the OZ equation by the proper sequence of Fourier transform to $k$-space, algebraic update there, and inverse transform back to $r$-space? Select all that apply.\n\nA. Real-space HNC update followed by OZ in $k$-space:\n- Given $h^{(n)}(r)$ and $c^{(n)}(r)$, compute in real space\n  $\\gamma^{(n+1)}(r) = \\ln\\!\\big(1 + h^{(n)}(r)\\big) + \\beta\\, u(r)$.\n- Set $c^{(n+1)}(r) = h^{(n)}(r) - \\gamma^{(n+1)}(r)$.\n- Forward transform $C^{(n+1)}(k) = \\mathcal{F}\\{c^{(n+1)}(r)\\}$.\n- Enforce OZ in $k$-space by $H^{(n+1)}(k) = \\dfrac{C^{(n+1)}(k)}{1 - \\rho\\, C^{(n+1)}(k)}$.\n- Inverse transform $h^{(n+1)}(r) = \\mathcal{F}^{-1}\\{H^{(n+1)}(k)\\}$.\n\nB. $k$-space OZ product and $k$-space closure application:\n- Forward transform $C^{(n)}(k) = \\mathcal{F}\\{c^{(n)}(r)\\}$.\n- Set $H^{(n+1)}(k) = C^{(n)}(k)\\,\\big(1 - \\rho\\, C^{(n)}(k)\\big)$.\n- Inverse transform $h^{(n+1)}(r) = \\mathcal{F}^{-1}\\{H^{(n+1)}(k)\\}$.\n- Update $\\gamma^{(n+1)}(r) = h^{(n+1)}(r) - c^{(n)}(r)$.\n- Apply the closure in $k$-space by $\\Gamma^{(n+1)}(k) = \\rho\\, C^{(n)}(k)\\, H^{(n+1)}(k)$, and set $C^{(n+1)}(k)$ from the closure.\n\nC. Real-space PY update followed by OZ in $k$-space:\n- Given $h^{(n)}(r)$ and $c^{(n)}(r)$, compute in real space\n  $\\gamma^{(n+1)}(r) = \\exp\\!\\big(\\beta\\, u(r)\\big)\\,\\big(1 + h^{(n)}(r)\\big) - 1$.\n- Set $c^{(n+1)}(r) = h^{(n)}(r) - \\gamma^{(n+1)}(r)$.\n- Forward transform $C^{(n+1)}(k) = \\mathcal{F}\\{c^{(n+1)}(r)\\}$.\n- Enforce OZ in $k$-space by $H^{(n+1)}(k) = \\dfrac{C^{(n+1)}(k)}{1 - \\rho\\, C^{(n+1)}(k)}$.\n- Inverse transform $h^{(n+1)}(r) = \\mathcal{F}^{-1}\\{H^{(n+1)}(k)\\}$.\n\nD. Misidentified HNC closure for $c^{(n+1)}(r)$ with correct OZ in $k$-space:\n- Given $h^{(n)}(r)$ and $c^{(n)}(r)$, compute in real space\n  $c^{(n+1)}(r) = \\ln\\!\\big(1 + h^{(n)}(r)\\big) + \\beta\\, u(r)$.\n- Set $\\gamma^{(n+1)}(r) = h^{(n)}(r) - c^{(n+1)}(r)$.\n- Forward transform $C^{(n+1)}(k) = \\mathcal{F}\\{c^{(n+1)}(r)\\}$.\n- Enforce OZ in $k$-space by $H^{(n+1)}(k) = \\dfrac{C^{(n+1)}(k)}{1 - \\rho\\, C^{(n+1)}(k)}$.\n- Inverse transform $h^{(n+1)}(r) = \\mathcal{F}^{-1}\\{H^{(n+1)}(k)\\}$.", "solution": "The problem asks for an evaluation of several proposed numerical iteration schemes for solving the Ornstein-Zernike equation coupled with a closure relation. Before providing a solution, we must first validate the problem statement.\n\nThe problem statement provides the following information:\n- A homogeneous, isotropic, single-component fluid is described by number density $\\rho$ and temperature $T$.\n- The relevant functions are the radial distribution function $g(r)$, total correlation function $h(r) \\equiv g(r) - 1$, direct correlation function $c(r)$, and indirect correlation function $\\gamma(r) \\equiv h(r) - c(r)$.\n- The pair potential is $u(r)$, and $\\beta \\equiv 1/(k_{\\mathrm{B}} T)$.\n- The Ornstein–Zernike (OZ) equation relates $h(r)$ and $c(r)$ via convolution in real space, or algebraically in wave-vector ($k$) space: $H(k) = C(k) + \\rho C(k) H(k)$.\n- The Hypernetted Chain (HNC) and Percus–Yevick (PY) closures are given as approximate relations between the correlation functions and the potential.\n- A specific Picard fixed-point iteration scheme is described:\n    1. Update $\\gamma^{(n+1)}(r)$ from $h^{(n)}(r)$ using a closure in real space.\n    2. Update $c^{(n+1)}(r)$ using the definition $\\gamma(r) \\equiv h(r) - c(r)$.\n    3. Enforce the OZ equation using Fourier transforms to find $h^{(n+1)}(r)$.\n\nThe problem is scientifically grounded in the established principles of statistical mechanics of liquids. The concepts of the OZ equation, HNC and PY closures, and the use of Fourier transforms for numerical solution are standard and correct. The problem is well-posed, with all necessary definitions and constraints provided. The language is precise and objective. There are no logical contradictions, unrealistic conditions, or other flaws. The problem is valid.\n\nWe now proceed to the solution. The objective is to identify which of the proposed schemes correctly implements the prescribed iterative procedure.\n\nFirst, let us establish the fundamental equations.\n1.  The definition of the indirect correlation function is $\\gamma(r) = h(r) - c(r)$.\n2.  The Ornstein-Zernike (OZ) equation in $k$-space is $H(k) = C(k) + \\rho C(k) H(k)$. For an iterative scheme that computes a new $H(k)$ from a known $C(k)$, this must be rearranged to:\n    $$H(k) = \\frac{C(k)}{1 - \\rho C(k)}$$\n3.  The closure relations must be expressed for $\\gamma(r)$ as a function of $h(r)$ and $u(r)$, as required by the problem's iterative structure.\n    -   **Hypernetted Chain (HNC) closure**: The standard form is $c(r) = h(r) - \\ln(g(r)) - \\beta u(r)$. Since $g(r) = 1 + h(r)$, this becomes $c(r) = h(r) - \\ln(1 + h(r)) - \\beta u(r)$. Using the definition $\\gamma(r) = h(r) - c(r)$, we derive the HNC closure for $\\gamma(r)$:\n        $$\\gamma(r) = h(r) - \\left[ h(r) - \\ln\\big(1 + h(r)\\big) - \\beta u(r) \\right] = \\ln\\big(1 + h(r)\\big) + \\beta u(r)$$\n    -   **Percus-Yevick (PY) closure**: The standard form is $c(r) = g(r) \\left(1 - e^{\\beta u(r)}\\right) = \\left(1 + h(r)\\right) \\left(1 - e^{\\beta u(r)}\\right)$. Using $\\gamma(r) = h(r) - c(r)$, we derive the PY closure for $\\gamma(r)$:\n        $$\\gamma(r) = h(r) - \\left(1 + h(r)\\right) \\left(1 - e^{\\beta u(r)}\\right)$$\n        $$\\gamma(r) = h(r) - \\left[ 1 + h(r) - e^{\\beta u(r)} - h(r)e^{\\beta u(r)} \\right]$$\n        $$\\gamma(r) = -1 + e^{\\beta u(r)} + h(r)e^{\\beta u(r)} = e^{\\beta u(r)}\\left(1 + h(r)\\right) - 1$$\n\nThe specified iterative scheme is structured as follows, starting from an iterate $h^{(n)}(r)$:\n(i) Compute $\\gamma^{(n+1)}(r)$ using the closure: $\\gamma^{(n+1)}(r) = \\text{Closure}(h^{(n)}(r), u(r))$.\n(ii) Compute $c^{(n+1)}(r)$ from the definition: $c^{(n+1)}(r) = h^{(n)}(r) - \\gamma^{(n+1)}(r)$. This is a consistent choice for a Picard iteration.\n(iii) Enforce the OZ equation to find the next iterate $h^{(n+1)}(r)$:\n    a. $C^{(n+1)}(k) = \\mathcal{F}\\{c^{(n+1)}(r)\\}$\n    b. $H^{(n+1)}(k) = \\dfrac{C^{(n+1)}(k)}{1 - \\rho C^{(n+1)}(k)}$\n    c. $h^{(n+1)}(r) = \\mathcal{F}^{-1}\\{H^{(n+1)}(k)\\}$\n\nNow we analyze each option.\n\n**Option A:** Real-space HNC update followed by OZ in $k$-space.\n- The first step is $\\gamma^{(n+1)}(r) = \\ln\\!\\big(1 + h^{(n)}(r)\\big) + \\beta\\, u(r)$. This is the correct HNC closure for $\\gamma(r)$, evaluated using the previous iterate $h^{(n)}(r)$. This is correct.\n- The second step is $c^{(n+1)}(r) = h^{(n)}(r) - \\gamma^{(n+1)}(r)$. This follows step (ii) of the prescribed algorithm. This is correct.\n- The subsequent steps, $C^{(n+1)}(k) = \\mathcal{F}\\{c^{(n+1)}(r)\\}$, $H^{(n+1)}(k) = \\frac{C^{(n+1)}(k)}{1 - \\rho\\, C^{(n+1)}(k)}$, and $h^{(n+1)}(r) = \\mathcal{F}^{-1}\\{H^{(n+1)}(k)\\}$, correctly enforce the OZ equation as per step (iii). This is correct.\nThe entire scheme is a consistent implementation of the OZ+HNC problem according to the method described.\nVerdict for Option A: **Correct**.\n\n**Option B:** $k$-space OZ product and $k$-space closure application.\n- The second step is $H^{(n+1)}(k) = C^{(n)}(k)\\,\\big(1 - \\rho\\, C^{(n)}(k)\\big)$. This is a gross misrepresentation of the OZ equation. The correct relation is $H(k) = C(k) / (1 - \\rho C(k))$. This step is fundamentally incorrect.\n- The fifth step attempts to \"Apply the closure in $k$-space\". This contradicts the problem statement which explicitly requires evaluating the closure in real space.\n- Furthermore, the expression given, $\\Gamma^{(n+1)}(k) = \\rho\\, C^{(n)}(k)\\, H^{(n+1)}(k)$, is not a closure relation (which must involve the potential $u(r)$). It is simply the convolution part of the OZ equation itself, i.e., $\\gamma(r) = \\rho (c * h)(r)$, expressed in Fourier space.\nThis option is nonsensical and incorrect on multiple levels.\nVerdict for Option B: **Incorrect**.\n\n**Option C:** Real-space PY update followed by OZ in $k$-space.\n- The first step is $\\gamma^{(n+1)}(r) = \\exp\\!\\big(\\beta\\, u(r)\\big)\\,\\big(1 + h^{(n)}(r)\\big) - 1$. This is the correct PY closure for $\\gamma(r)$, evaluated using the previous iterate $h^{(n)}(r)$. This is correct.\n- The second step is $c^{(n+1)}(r) = h^{(n)}(r) - \\gamma^{(n+1)}(r)$. This is identical in logic to Option A and follows step (ii) of the prescribed algorithm. This is correct.\n- The subsequent steps for enforcing the OZ equation via Fourier space, $C^{(n+1)}(k) = \\mathcal{F}\\{c^{(n+1)}(r)\\}$, $H^{(n+1)}(k) = \\frac{C^{(n+1)}(k)}{1 - \\rho C^{(n+1)}(k)}$, and $h^{(n+1)}(r) = \\mathcal{F}^{-1}\\{H^{(n+1)}(k)\\}$, are correct.\nThis scheme correctly and consistently implements the OZ+PY problem solution as specified.\nVerdict for Option C: **Correct**.\n\n**Option D:** Misidentified HNC closure for $c^{(n+1)}(r)$ with correct OZ in $k$-space.\n- The first step computes $c^{(n+1)}(r) = \\ln\\!\\big(1 + h^{(n)}(r)\\big) + \\beta\\, u(r)$. The expression on the right-hand side is the HNC closure for $\\gamma_{HNC}(r)$, not $c_{HNC}(r)$. This is a misidentification of the closure function, as the option's own title suggests. The correct HNC closure for $c(r)$ is $h(r) - \\ln(1+h(r)) - \\beta u(r)$. This step is incorrect.\n- The second step is $\\gamma^{(n+1)}(r) = h^{(n)}(r) - c^{(n+1)}(r)$. This inverts the logical flow required by the problem statement, which demands computing $\\gamma^{(n+1)}$ from the closure first, then $c^{(n+1)}$ from the definition.\nThe scheme is invalid because it uses an incorrect closure expression and it violates the specified order of operations.\nVerdict for Option D: **Incorrect**.\n\nIn conclusion, options A and C are the only ones that correctly specify a consistent Picard iteration scheme that adheres to the established physical equations and the procedure outlined in the problem statement.", "answer": "$$\\boxed{AC}$$", "id": "2645948"}, {"introduction": "A key challenge in implementing integral equation theories is ensuring that solutions respect fundamental physical constraints, such as the impossibility of interparticle overlap for hard-core potentials. This problem delves into a common numerical artifact of the HNC closure, where particles can unphysically \"leak\" into the core region, and explores the advanced strategies practitioners use to correct this behavior [@problem_id:2645950]. Understanding these techniques, from mixed closures to reference-system corrections, is essential for obtaining physically meaningful results for realistic molecular models.", "problem": "Consider a one-component, isotropic fluid in three spatial dimensions ($3$D) with number density $\\rho$ and a pair potential $u(r)$ that is strongly repulsive for $r\\sigma$. The Ornstein–Zernike (OZ) equation relates the total correlation function $h(r)$ and the direct correlation function $c(r)$, and the radial distribution function is $g(r)=1+h(r)$. In integral equation theories, closures approximate the unknown many-body contributions (the so-called bridge diagrams). The hypernetted-chain (HNC) closure neglects these bridge diagrams. In numerical implementations for steeply repulsive interactions, it is common to regularize or split $u(r)$ inside the nominal core (for example, by replacing an infinite or discontinuous repulsion by a finite but large value on a discrete radial grid, or by using a reference–perturbation split such as Weeks–Chandler–Andersen).\n\nIn this context, select all statements that correctly explain why, in practical HNC calculations, the condition $g(r)=0$ for $r\\sigma$ is not strictly enforced, and identify sound strategies to impose or restore an effective hard-core condition in $g(r)$.\n\nA. In practice, HNC does not strictly impose $g(r)=0$ for $r\\sigma$ because it lacks an explicit algebraic core constraint; only an actually infinite $u(r)$ enforces $g(r)=0$ through the Boltzmann factor, and common regularizations render $u(r)$ finite so that small but nonzero $g(r)$ can appear inside the core.\n\nB. The OZ equation itself is mathematically incompatible with any hard-core condition, so no closure (including Percus–Yevick) can ever satisfy $g(r)=0$ for $r\\sigma$; therefore leakage is unavoidable.\n\nC. A practical strategy is to adopt a mixed closure: enforce $g(r)=0$ for $r\\sigma$ by hand and apply the HNC form only for $r\\ge\\sigma$, iterating the OZ equation until convergence.\n\nD. A practical strategy is to approximate the missing bridge function by that of a reference hard-sphere system (reference hypernetted-chain), thereby inheriting the hard-core condition while retaining HNC-like long-range behavior.\n\nE. Increasing the density $\\rho$ or the radial cutoff $r_{\\max}$ in the numerical grid guarantees that any leakage of $g(r)$ inside $r\\sigma$ disappears in HNC.\n\nF. One can impose a hard-core condition by augmenting the HNC free-energy functional with a constraint or penalty term (e.g., a Lagrange multiplier or quadratic penalty) that drives $g(r)\\to 0$ for $r\\sigma$ during the iterative solution.\n\nSelect all that apply.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Fluid: one-component, isotropic, in three spatial dimensions ($3$D).\n- Number density: $\\rho$.\n- Pair potential: $u(r)$, strongly repulsive for $r  \\sigma$.\n- Ornstein–Zernike (OZ) equation: relates the total correlation function $h(r)$ and the direct correlation function $c(r)$.\n- Radial distribution function: $g(r) = 1 + h(r)$.\n- Hypernetted-chain (HNC) closure: neglects bridge diagrams.\n- Context: Numerical implementations for steeply repulsive interactions regularize or split $u(r)$ inside the core ($r  \\sigma$).\n- Question: Select all statements that correctly explain why practical HNC calculations do not strictly enforce $g(r)=0$ for $r\\sigma$, and identify sound strategies to impose or restore an effective hard-core condition in $g(r)$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is well-defined and scientifically grounded. It addresses a standard topic in the statistical mechanics of liquids: the application and numerical implementation of integral equation theories. The phenomena described, such as the core \"leakage\" in HNC calculations for steep potentials, are well-documented and represent a real challenge in the field. The terminology ($g(r)$, $h(r)$, $c(r)$, Ornstein-Zernike, HNC) is standard. The problem does not violate any fundamental principles, is not ambiguous, and contains sufficient information to evaluate the provided statements based on established theory.\n\n**Step 3: Verdict and Action**\nThe problem statement is **valid**. A solution will be derived.\n\nThe Ornstein-Zernike (OZ) equation is an exact relation for any isotropic fluid, defining the direct correlation function $c(r)$ in terms of the total correlation function $h(r)$:\n$$h(r) = c(r) + \\rho \\int c(|\\mathbf{r}-\\mathbf{r'}|) h(|\\mathbf{r'}|) d\\mathbf{r'}$$\nTo solve this equation, a closure relation is required, which provides a second equation connecting $c(r)$, $h(r)$, and the pair potential $u(r)$. The exact closure is:\n$$c(r) = h(r) - \\ln g(r) - \\beta u(r) + B(r)$$\nwhere $g(r) = 1 + h(r)$, $\\beta = 1/(k_{\\mathrm{B}} T)$, and $B(r)$ is the bridge function, representing an infinite sum of complex diagrams. The hypernetted-chain (HNC) approximation consists of setting the bridge function to zero, $B(r) = 0$. This yields the HNC closure:\n$$c_{HNC}(r) = h(r) - \\ln g(r) - \\beta u(r)$$\nThis can be rearranged to express $g(r)$ as:\n$$g(r) = \\exp(-\\beta u(r) + h(r) - c(r))$$\nThe term $\\gamma(r) = h(r) - c(r)$ is the indirect correlation function. The core condition requires $g(r) = 0$ for $r  \\sigma$. For a true hard-core potential, $u(r) = \\infty$ for $r  \\sigma$. Substituting this into the HNC expression for $g(r)$ gives $g(r) = \\exp(-\\infty + \\gamma(r)) = 0$, provided $\\gamma(r)$ is finite. Thus, mathematically, the HNC equation is perfectly compatible with a true hard-core potential. The issue arises in practical, numerical implementations.\n\nNow, we evaluate each statement.\n\n**A. In practice, HNC does not strictly impose $g(r)=0$ for $r\\sigma$ because it lacks an explicit algebraic core constraint; only an actually infinite $u(r)$ enforces $g(r)=0$ through the Boltzmann factor, and common regularizations render $u(r)$ finite so that small but nonzero $g(r)$ can appear inside the core.**\nThis statement is a precise explanation of the practical difficulty. The HNC equation enforces the core condition through the term $\\exp(-\\beta u(r))$. In a numerical calculation, an infinite potential cannot be represented. Instead, a large but finite value, $U_{repulsive}$, is used for $u(r)$ where $r  \\sigma$. As a result, $g(r) = \\exp(-\\beta U_{repulsive} + \\gamma(r))$ becomes a very small, but non-zero, number. The HNC closure is not an algebraic constraint on $g(r)$ (like setting it to $0$), but a functional relationship involving $\\ln g(r)$. Therefore, the non-zero result is a direct consequence of using a finite potential. This statement correctly identifies the origin of the leakage.\nVerdict: Correct.\n\n**B. The OZ equation itself is mathematically incompatible with any hard-core condition, so no closure (including Percus–Yevick) can ever satisfy $g(r)=0$ for $r\\sigma$; therefore leakage is unavoidable.**\nThis statement is incorrect. The OZ equation is an exact identity and places no restrictions on $g(r)$ by itself. It is the closure that determines the behavior of the solution. The Percus-Yevick (PY) closure for a hard-sphere fluid, $c(r) = [1-e^{\\beta u(r)}]g(r)$, leads to the analytical Wertheim-Thiele solution, which strictly satisfies $g(r)=0$ for $r\\sigma$. This serves as a direct counterexample to the claim that *no* closure can satisfy the hard-core condition. Leakage is a feature of certain approximations under certain numerical conditions, not an unavoidable consequence of the fundamental OZ equation.\nVerdict: Incorrect.\n\n**C. A practical strategy is to adopt a mixed closure: enforce $g(r)=0$ for $r\\sigma$ by hand and apply the HNC form only for $r\\ge\\sigma$, iterating the OZ equation until convergence.**\nThis describes a valid and commonly used class of methods. Such hybrid or mixed integral equation schemes explicitly impose the physical core condition $h(r) = -1$ (since $g(r)=0$) for $r  \\sigma$ at each step of the iterative solution. For $r \\ge \\sigma$, the HNC closure (or a variation) is used to relate $c(r)$ and $h(r)$. The self-consistency of the full set of equations over the entire range of $r$ is then sought through iteration. Methods developed by Gillan, Lado, and others fall into this category. They are known to be effective at correcting the core leakage of HNC and improving its accuracy, especially at high densities. The procedure is numerically sound and physically well-motivated.\nVerdict: Correct.\n\n**D. A practical strategy is to approximate the missing bridge function by that of a reference hard-sphere system (reference hypernetted-chain), thereby inheriting the hard-core condition while retaining HNC-like long-range behavior.**\nThis describes the Reference Hypernetted-Chain (RHNC) method and related approaches. The HNC closure fails partly because it sets the bridge function $B(r)=0$. Since the short-range correlations are dominated by repulsive forces, it is a very effective strategy to approximate $B(r)$ with the bridge function of a hard-sphere fluid, $B_{HS}(r)$, which can be obtained accurately from simulation. The resulting closure, $c(r) = h(r) - \\ln g(r) - \\beta u(r) + B_{HS}(r)$, incorporates the correct hard-core physics via $B_{HS}(r)$. This significantly improves the description of the fluid's structure, especially at short distances, and strongly suppresses the unphysical core leakage. This is a powerful and widely-used strategy.\nVerdict: Correct.\n\n**E. Increasing the density $\\rho$ or the radial cutoff $r_{\\max}$ in the numerical grid guarantees that any leakage of $g(r)$ inside $r\\sigma$ disappears in HNC.**\nThis statement is incorrect. Increasing the radial cutoff $r_{max}$ improves the numerical accuracy of the convolution integral in the OZ equation, addressing finite-size errors, but it does not alter the fundamental reason for the core leakage, which is the use of a finite potential in the HNC closure. Increasing the density $\\rho$ generally makes the problem worse. At higher densities, correlations become stronger, and the HNC approximation is known to become less accurate and can even fail to converge. There is no physical or mathematical reason why increasing $\\rho$ would force $g(r) \\to 0$ for $r\\sigma$. In fact, the structural problems of the HNC closure are exacerbated at high density.\nVerdict: Incorrect.\n\n**F. One can impose a hard-core condition by augmenting the HNC free-energy functional with a constraint or penalty term (e.g., a Lagrange multiplier or quadratic penalty) that drives $g(r)\\to 0$ for $r\\sigma$ during the iterative solution.**\nThis is a valid statement describing a variational approach to the problem. The HNC equation can be derived by minimizing an approximate free-energy functional $\\mathcal{F}_{HNC}[g(r)]$. To enforce the core condition, one can add a penalty term to this functional, such as $\\mathcal{P}[g] = \\frac{1}{2}\\lambda \\int_{0}^{\\sigma} [g(r)]^2 4\\pi r^2 dr$, where $\\lambda$ is a large penalty parameter. Minimizing the new functional $\\mathcal{F}_{HNC} + \\mathcal{P}[g]$ leads to a modified integral equation whose solution is forced to have $g(r) \\approx 0$ for $r  \\sigma$. The use of such penalty functions or, more formally, Lagrange multipliers, is a standard technique in constrained optimization and is a sound conceptual strategy for imposing physical constraints on the solution of integral equations.\nVerdict: Correct.", "answer": "$$\\boxed{ACDF}$$", "id": "2645950"}]}