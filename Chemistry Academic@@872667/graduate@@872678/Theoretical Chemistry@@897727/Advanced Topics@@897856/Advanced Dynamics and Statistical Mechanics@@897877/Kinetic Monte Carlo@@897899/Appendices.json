{"hands_on_practices": [{"introduction": "Kinetic Monte Carlo simulations generate stochastic trajectories that numerically solve an underlying master equation. This exercise provides a foundational link between this theoretical framework and observable dynamics by asking you to derive the time autocorrelation function for a simple two-state system directly from first principles [@problem_id:2782393]. Mastering this connection is key to understanding how macroscopic relaxation behavior emerges from microscopic transition rates.", "problem": "A single adsorption site on a catalytic surface is modeled by a two-state continuous-time Markov chain that underlies a Kinetic Monte Carlo (KMC) trajectory. State $\\mathsf{1}$ denotes that the site is occupied and state $\\mathsf{2}$ denotes that the site is vacant. Transitions $\\mathsf{1} \\to \\mathsf{2}$ occur with rate $k_{12}$ and transitions $\\mathsf{2} \\to \\mathsf{1}$ occur with rate $k_{21}$, with $k_{12} > 0$ and $k_{21} > 0$. The system is prepared and observed in its stationary regime. Define the state indicator $I(t)$ by $I(t) = 1$ if the system is in state $\\mathsf{1}$ at time $t$ and $I(t) = 0$ if it is in state $\\mathsf{2}$ at time $t$. Let $\\langle \\cdot \\rangle$ denote a stationary ensemble average and define the zero-mean fluctuation $\\delta I(t) \\equiv I(t) - \\langle I \\rangle$.\n\nStarting only from the continuous-time master equation for the two-state process and standard properties of stationary continuous-time Markov chains, derive the stationary time autocorrelation function\n$$\nC_I(t) \\equiv \\langle \\delta I(0)\\,\\delta I(t)\\rangle\n$$\nfor $t \\ge 0$ as a closed-form expression in terms of $k_{12}$, $k_{21}$, and $t$. Your derivation should proceed from first principles by solving for conditional probabilities or conditional expectations as needed, without invoking pre-memorized correlation formulas. Then, by analyzing the generator of the process or your derived expression, identify the exponential decay constant of $C_I(t)$ in terms of $k_{12}$ and $k_{21}$.\n\nProvide your final result for $C_I(t)$ as a single analytical expression in terms of $k_{12}$, $k_{21}$, and $t$. No numerical evaluation is required. Express the final answer without units.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It is a standard problem in the theory of stochastic processes applied to theoretical chemistry. All necessary information is provided, and no contradictions are present. The problem is valid, and a solution will be provided.\n\nThe system is a two-state continuous-time Markov chain with states $\\mathsf{1}$ (occupied) and $\\mathsf{2}$ (vacant). The transition rates are $k_{12}$ for $\\mathsf{1} \\to \\mathsf{2}$ and $k_{21}$ for $\\mathsf{2} \\to \\mathsf{1}$. Let $P_1(t)$ and $P_2(t)$ be the probabilities of the system being in state $\\mathsf{1}$ and $\\mathsf{2}$, respectively, at time $t$. The evolution of these probabilities is governed by the continuous-time master equation:\n$$\n\\frac{d}{dt} \\begin{pmatrix} P_1(t) \\\\ P_2(t) \\end{pmatrix} = \\begin{pmatrix} -k_{12} & k_{21} \\\\ k_{12} & -k_{21} \\end{pmatrix} \\begin{pmatrix} P_1(t) \\\\ P_2(t) \\end{pmatrix}\n$$\nThe problem requires the calculation of the stationary time autocorrelation function $C_I(t) = \\langle \\delta I(0)\\,\\delta I(t)\\rangle$ for $t \\ge 0$. The state indicator is $I(t)=1$ for state $\\mathsf{1}$ and $I(t)=0$ for state $\\mathsf{2}$. The fluctuation is $\\delta I(t) = I(t) - \\langle I \\rangle$.\n\nFirst, we expand the definition of $C_I(t)$:\n$$\nC_I(t) = \\langle (I(0) - \\langle I \\rangle)(I(t) - \\langle I \\rangle) \\rangle = \\langle I(0)I(t) \\rangle - \\langle I(0)\\rangle\\langle I(t)\\rangle - \\langle I(t)\\rangle\\langle I(0)\\rangle + \\langle I\\rangle^2\n$$\nSince the system is in its stationary regime, the ensemble averages are time-independent: $\\langle I(t) \\rangle = \\langle I(0) \\rangle = \\langle I \\rangle$. The expression simplifies to:\n$$\nC_I(t) = \\langle I(0)I(t) \\rangle - \\langle I \\rangle^2\n$$\nOur derivation proceeds in three steps:\n$1$. Calculate the stationary average $\\langle I \\rangle$.\n$2$. Calculate the two-time correlation $\\langle I(0)I(t) \\rangle$.\n$3$. Combine the results to find $C_I(t)$.\n\n_Step 1: Stationary Average $\\langle I \\rangle$_\n\nIn the stationary regime, the probabilities are constant, so $\\frac{dP_1}{dt} = \\frac{dP_2}{dt} = 0$. Let the stationary probabilities be $P_1^{ss}$ and $P_2^{ss}$. The master equation yields the detailed balance condition:\n$$\nk_{12} P_1^{ss} = k_{21} P_2^{ss}\n$$\nAlong with the normalization condition $P_1^{ss} + P_2^{ss} = 1$, we can solve for the stationary probabilities. Substituting $P_2^{ss} = 1 - P_1^{ss}$:\n$$\nk_{12} P_1^{ss} = k_{21} (1 - P_1^{ss}) \\implies (k_{12} + k_{21}) P_1^{ss} = k_{21} \\implies P_1^{ss} = \\frac{k_{21}}{k_{12} + k_{21}}\n$$\nAnd consequently, $P_2^{ss} = 1 - P_1^{ss} = \\frac{k_{12}}{k_{12} + k_{21}}$.\n\nThe average value of the state indicator $I(t)$ is given by the expectation:\n$$\n\\langle I \\rangle = (1) \\cdot P_1^{ss} + (0) \\cdot P_2^{ss} = P_1^{ss} = \\frac{k_{21}}{k_{12} + k_{21}}\n$$\n\n_Step 2: Two-Time Correlation $\\langle I(0)I(t) \\rangle$_\n\nThe two-time correlation is calculated by averaging over all possible initial and final states:\n$$\n\\langle I(0)I(t) \\rangle = \\sum_{i,j \\in \\{1,2\\}} I_i I_j P(X(0)=j, X(t)=i)\n$$\nwhere $X(t)$ is the state of the system at time $t$, and $I_j$ is the value of the indicator in state $j$. Since $I_2=0$, the only non-zero term in the sum is for $i=1, j=1$:\n$$\n\\langle I(0)I(t) \\rangle = I_1 \\cdot I_1 \\cdot P(X(0)=1, X(t)=1) = P(X(0)=1, X(t)=1)\n$$\nUsing the definition of conditional probability and the fact that the system is stationary:\n$$\nP(X(0)=1, X(t)=1) = P(X(t)=1 | X(0)=1) \\cdot P(X(0)=1) = P_{11}(t) \\cdot P_1^{ss}\n$$\nHere, $P_{11}(t) \\equiv P(X(t)=1 | X(0)=1)$ is the conditional probability of being in state $\\mathsf{1}$ at time $t$ given that the system was in state $\\mathsf{1}$ at time $t=0$. To find $P_{11}(t)$, we solve the master equation with the initial condition $P_1(0)=1$ and $P_2(0)=0$.\nThe equation for $P_1(t)$ is $\\frac{dP_1}{dt} = k_{21} P_2 - k_{12} P_1$. Using $P_1(t)+P_2(t)=1$, we get $P_2(t)=1-P_1(t)$. Substituting this gives a first-order linear ordinary differential equation for $P_1(t) \\equiv P_{11}(t)$:\n$$\n\\frac{dP_1}{dt} = k_{21} (1 - P_1) - k_{12} P_1 = k_{21} - (k_{12} + k_{21}) P_1\n$$\nLet $\\lambda = k_{12} + k_{21}$. The equation is $\\frac{dP_1}{dt} + \\lambda P_1 = k_{21}$. The general solution is the sum of a homogeneous solution $A\\exp(-\\lambda t)$ and a particular solution. A particular solution is the stationary value $P_1^{ss} = k_{21}/\\lambda$. Thus:\n$$\nP_1(t) = A\\exp(-\\lambda t) + \\frac{k_{21}}{\\lambda}\n$$\nApplying the initial condition $P_1(0)=1$:\n$$\n1 = A\\exp(0) + \\frac{k_{21}}{\\lambda} \\implies A = 1 - \\frac{k_{21}}{\\lambda} = \\frac{\\lambda - k_{21}}{\\lambda} = \\frac{k_{12}}{\\lambda}\n$$\nSo, the conditional probability is:\n$$\nP_{11}(t) = \\frac{k_{12}}{k_{12} + k_{21}} \\exp(-(k_{12} + k_{21})t) + \\frac{k_{21}}{k_{12} + k_{21}}\n$$\nNow we can compute $\\langle I(0)I(t) \\rangle = P_{11}(t) \\cdot P_1^{ss}$:\n$$\n\\langle I(0)I(t) \\rangle = \\left( \\frac{k_{12}}{k_{12} + k_{21}} \\exp(-(k_{12} + k_{21})t) + \\frac{k_{21}}{k_{12} + k_{21}} \\right) \\left( \\frac{k_{21}}{k_{12} + k_{21}} \\right)\n$$\n\n_Step 3: Final Assembly of $C_I(t)$_\n\nWe now subtract $\\langle I \\rangle^2 = (P_1^{ss})^2$ from the expression for $\\langle I(0)I(t) \\rangle$:\n$$\nC_I(t) = \\left( \\frac{k_{12}}{k_{12} + k_{21}} \\exp(-(k_{12} + k_{21})t) + P_1^{ss} \\right) P_1^{ss} - (P_1^{ss})^2\n$$\n$$\nC_I(t) = \\frac{k_{12}}{k_{12} + k_{21}} \\exp(-(k_{12} + k_{21})t) \\cdot P_1^{ss} + (P_1^{ss})^2 - (P_1^{ss})^2\n$$\nSubstituting $P_1^{ss} = \\frac{k_{21}}{k_{12} + k_{21}}$:\n$$\nC_I(t) = \\frac{k_{12}}{k_{12} + k_{21}} \\left( \\frac{k_{21}}{k_{12} + k_{21}} \\right) \\exp(-(k_{12} + k_{21})t)\n$$\nThis simplifies to the final expression for the autocorrelation function:\n$$\nC_I(t) = \\frac{k_{12}k_{21}}{(k_{12} + k_{21})^2} \\exp(-(k_{12} + k_{21})t)\n$$\nThis expression is valid for $t \\ge 0$. The pre-exponential factor is $C_I(0) = \\frac{k_{12}k_{21}}{(k_{12}+k_{21})^2} = P_1^{ss} P_2^{ss}$, which is the variance of the Bernoulli random variable $I$, as expected.\n\nFinally, we identify the exponential decay constant. The function is of the form $A\\exp(-\\gamma t)$, where $\\gamma$ is the decay constant. By direct inspection of the derived expression, the exponential decay constant is the sum of the forward and backward rates:\n$$\n\\gamma = k_{12} + k_{21}\n$$\nThis rate is the absolute value of the non-zero eigenvalue of the transition rate matrix (the generator) of the Markov process, which governs the relaxation of the system to its stationary state.", "answer": "$$\n\\boxed{\\frac{k_{12}k_{21}}{(k_{12} + k_{21})^2} \\exp(-(k_{12} + k_{21})t)}\n$$", "id": "2782393"}, {"introduction": "A critical step in developing any simulation code is validation. For a KMC simulation intended to model systems near thermal equilibrium, verifying that the implementation satisfies the principle of detailed balance is paramount. This problem challenges you to act as a critical scientist, evaluating different statistical protocols for testing detailed balance from raw simulation data and identifying the sound approaches from the flawed ones [@problem_id:2782332].", "problem": "A two-state kinetic Monte Carlo (KMC) simulation is used to model a system with states $A$ and $B$ having energies $E_A$ and $E_B = E_A + \\Delta E$, respectively. The temperature is fixed so that $\\beta \\Delta E = 2.0$, where $\\beta = 1/(k_B T)$ and $k_B$ is the Boltzmann constant. The KMC implementation is supposed to satisfy detailed balance with respect to the canonical (Boltzmann) equilibrium distribution. After discarding an equilibration period, a single long production trajectory is recorded. Over the production run, the total residence times in each state are measured as $\\tau_A = 8810$ and $\\tau_B = 1190$, and the observed numbers of transitions are $n_{A\\to B} = 1220$ and $n_{B\\to A} = 1165$. Assume that the trajectory is stationary and that, conditional on the realized residence times, transition counts from each state arise as independent Poisson processes with intensities equal to the corresponding transition rates.\n\nYou are asked to validate that the implementation satisfies detailed balance by testing whether the empirical rate ratio is statistically consistent with $\\exp(-\\beta \\Delta E)$ at the $\\alpha = 0.05$ significance level. Which of the following testing protocols are statistically sound for this purpose and lead to a correct conclusion given the data?\n\nA. Estimate $k_{A\\to B}$ and $k_{B\\to A}$ by $k_{A\\to B} = n_{A\\to B}/\\tau_A$ and $k_{B\\to A} = n_{B\\to A}/\\tau_B$. Test the null hypothesis $H_0:\\ \\rho = k_{A\\to B}/k_{B\\to A} = \\rho_0 \\equiv \\exp(-\\beta \\Delta E)$ using the conditional binomial formulation: given $n = n_{A\\to B} + n_{B\\to A}$, $X = n_{A\\to B} \\sim \\mathrm{Binomial}(n, p_0)$ with $p_0 = (\\rho_0 \\tau_A)/(\\rho_0 \\tau_A + \\tau_B)$. Use a two-sided test at level $\\alpha = 0.05$ (or equivalently invert to a $95\\%$ confidence interval for $\\rho$ via the mapping $\\rho = (p\\, \\tau_B)/((1-p)\\, \\tau_A)$). Conclude that $H_0$ is not rejected for the given data.\n\nB. Compare the raw count ratio $n_{A\\to B}/n_{B\\to A}$ directly to $\\exp(-\\beta \\Delta E)$. Since $1220/1165 \\gg \\exp(-2)$, reject detailed balance at $\\alpha = 0.05$.\n\nC. Validate detailed balance by checking only that the occupancy ratio $\\tau_B/\\tau_A$ matches $\\exp(-\\beta \\Delta E)$. Since $1190/8810 \\approx \\exp(-2)$, accept that detailed balance holds without analyzing transition counts.\n\nD. Form the log-rate ratio estimator $\\widehat{\\ell} = \\ln(n_{A\\to B}) - \\ln(\\tau_A) - \\ln(n_{B\\to A}) + \\ln(\\tau_B)$ and approximate its sampling distribution by a normal distribution with variance $\\operatorname{Var}(\\widehat{\\ell}) \\approx 1/n_{A\\to B} + 1/n_{B\\to A}$ (treating residence times as fixed). Construct a two-sided $95\\%$ confidence interval for $\\ell = \\ln \\rho$ and check whether $-\\beta \\Delta E$ lies inside. Conclude that $H_0$ is not rejected for the given data.\n\nSelect all that apply.", "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- System states: $A$ and $B$.\n- State energies: $E_A$, $E_B = E_A + \\Delta E$.\n- Thermal energy parameter: $\\beta \\Delta E = 2.0$, where $\\beta = 1/(k_B T)$.\n- Required property of the KMC implementation: Satisfy detailed balance with respect to the canonical distribution.\n- Simulation data from a single long, stationary production trajectory:\n  - Total residence time in state $A$: $\\tau_A = 8810$.\n  - Total residence time in state $B$: $\\tau_B = 1190$.\n  - Number of transitions from $A$ to $B$: $n_{A\\to B} = 1220$.\n  - Number of transitions from $B$ to $A$: $n_{B\\to A} = 1165$.\n- Statistical assumptions:\n  - The trajectory is stationary.\n  - Conditional on $\\tau_A$ and $\\tau_B$, $n_{A\\to B}$ and $n_{B\\to A}$ arise from independent Poisson processes.\n- Task: Validate detailed balance by statistically testing if the empirical rate ratio is consistent with $\\exp(-\\beta \\Delta E)$ at a significance level of $\\alpha = 0.05$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded. It presents a standard scenario in computational statistical mechanics involving a Kinetic Monte Carlo (KMC) simulation of a two-state system. The concepts of detailed balance, the Boltzmann distribution, and the modeling of transition events as Poisson processes are fundamental and correctly applied. The detailed balance condition for microscopic reversibility dictates that in equilibrium, the flux between any two states $i$ and $j$ must be equal in both directions: $p_i^{eq} k_{i\\to j} = p_j^{eq} k_{j\\to i}$, where $p_i^{eq}$ are the equilibrium probabilities and $k_{i\\to j}$ are the transition rates. For a canonical ensemble, $p_i^{eq} \\propto \\exp(-\\beta E_i)$. This leads to the rate ratio condition $k_{A\\to B}/k_{B\\to A} = p_B^{eq}/p_A^{eq} = \\exp(-\\beta(E_B-E_A)) = \\exp(-\\beta \\Delta E)$. The problem is to test this theoretical relationship using simulation data.\n\nThe problem is well-posed. It provides sufficient data and clear statistical assumptions to perform a hypothesis test. The language is precise and objective. There are no contradictions, no missing information, and no reliance on pseudoscience. The data values are physically plausible. The problem is a non-trivial application of statistical inference to simulation data, a common task in the field.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. A solution will be derived.\n\n### Derivation and Option Analysis\nThe null hypothesis to be tested is $H_0: \\rho = \\rho_0$, where $\\rho = k_{A\\to B}/k_{B\\to A}$ is the true ratio of the underlying transition rates, and $\\rho_0 = \\exp(-\\beta \\Delta E) = \\exp(-2.0)$ is the theoretically required ratio for detailed balance. The given data are $\\tau_A = 8810$, $\\tau_B = 1190$, $n_{A\\to B} = 1220$, and $n_{B\\to A} = 1165$. The significance level is $\\alpha = 0.05$.\n\nThe assumption that transition counts are from independent Poisson processes implies $n_{A\\to B} \\sim \\mathrm{Poisson}(k_{A\\to B}\\tau_A)$ and $n_{B\\to A} \\sim \\mathrm{Poisson}(k_{B\\to A}\\tau_B)$.\n\n**Option A Evaluation**\n\nThis option proposes a conditional binomial test. Given two independent Poisson variables, $X_1 \\sim \\mathrm{Poisson}(\\lambda_1)$ and $X_2 \\sim \\mathrm{Poisson}(\\lambda_2)$, the distribution of $X_1$ conditional on their sum $N = X_1+X_2$ is binomial: $X_1 | (X_1+X_2=N) \\sim \\mathrm{Binomial}(N, p)$, where $p = \\lambda_1/(\\lambda_1+\\lambda_2)$. In our case, $X_1 = n_{A\\to B}$ and $X_2 = n_{B\\to A}$. The intensities are $\\lambda_1 = k_{A\\to B}\\tau_A$ and $\\lambda_2 = k_{B\\to A}\\tau_B$. The probability parameter $p$ can be expressed in terms of the rate ratio $\\rho$:\n$$p = \\frac{k_{A\\to B}\\tau_A}{k_{A\\to B}\\tau_A + k_{B\\to A}\\tau_B} = \\frac{\\rho \\tau_A}{\\rho \\tau_A + \\tau_B}$$\nUnder the null hypothesis $H_0: \\rho = \\rho_0$, this probability becomes $p_0 = (\\rho_0 \\tau_A)/(\\rho_0 \\tau_A + \\tau_B)$. We test if the observed count $n_{A\\to B}$ is a plausible outcome from the distribution $\\mathrm{Binomial}(n, p_0)$, where $n = n_{A\\to B} + n_{B\\to A}$.\n\nThis is a statistically exact and sound procedure that correctly uses the conditional distribution to eliminate nuisance parameters (the individual rates).\nLet us perform the test.\n- $\\rho_0 = \\exp(-2.0) \\approx 0.135335$.\n- Total transitions $n = 1220 + 1165 = 2385$.\n- Null probability $p_0 = \\frac{0.135335 \\cdot 8810}{0.135335 \\cdot 8810 + 1190} = \\frac{1192.3}{1192.3 + 1190} \\approx 0.50047$.\n- We test if $n_{A\\to B} = 1220$ is consistent with a draw from $\\mathrm{Binomial}(2385, 0.50047)$.\n- Using the normal approximation to the binomial distribution (valid for large $n$):\n  - Mean: $\\mu = n p_0 = 2385 \\cdot 0.50047 \\approx 1193.62$.\n  - Standard deviation: $\\sigma = \\sqrt{n p_0 (1-p_0)} = \\sqrt{2385 \\cdot 0.50047 \\cdot 0.49953} \\approx \\sqrt{596.25} \\approx 24.42$.\n- The test statistic is $Z = (n_{A\\to B} - \\mu) / \\sigma = (1220 - 1193.62) / 24.42 \\approx 1.08$.\n- The critical value for a two-sided test at $\\alpha = 0.05$ is $Z_{crit} \\approx 1.96$. Since $|Z| = 1.08 < 1.96$, we do not reject the null hypothesis $H_0$. The conclusion stated in the option is correct. The protocol is statistically sound.\n\nVerdict for A: **Correct**.\n\n**Option B Evaluation**\n\nThis option compares the raw ratio of transition counts $n_{A\\to B}/n_{B\\to A}$ to $\\exp(-\\beta \\Delta E)$. This is fundamentally erroneous. The ratio of counts is an estimator for the ratio of the Poisson intensities, not the rates:\n$$ E\\left[\\frac{n_{A\\to B}}{n_{B\\to A}}\\right] \\approx \\frac{E[n_{A\\to B}]}{E[n_{B\\to A}]} = \\frac{k_{A\\to B}\\tau_A}{k_{B\\to A}\\tau_B} = \\rho \\frac{\\tau_A}{\\tau_B} $$\nOne must account for the residence times to estimate the rate ratio $\\rho$. The correct estimator for $\\rho$ is $\\widehat{\\rho} = (n_{A\\to B}/\\tau_A) / (n_{B\\to A}/\\tau_B)$. Comparing $n_{A\\to B}/n_{B\\to A}$ directly to $\\rho_0$ is a severe methodological error.\nNumerically, $n_{A\\to B}/n_{B\\to A} = 1220/1165 \\approx 1.047$, whereas $\\rho_0 = \\exp(-2.0) \\approx 0.135$. The proposed procedure compares two quantities that are not expected to be equal, even if detailed balance holds.\n\nVerdict for B: **Incorrect**.\n\n**Option C Evaluation**\n\nThis option suggests validating detailed balance by checking only the ratio of residence times $\\tau_B/\\tau_A$ against the equilibrium probability ratio $p_B^{eq}/p_A^{eq} = \\exp(-\\beta \\Delta E)$.\nIn the long-time limit of a stationary Markov process, the ratio of residence times estimates the ratio of stationary probabilities: $\\tau_B/\\tau_A \\approx \\pi_B/\\pi_A$. For a two-state system, the stationary distribution satisfies $\\pi_A k_{A\\to B} = \\pi_B k_{B\\to A}$, which implies $\\pi_B/\\pi_A = k_{A\\to B}/k_{B\\to A}$. If detailed balance holds, then $k_{A\\to B}/k_{B\\to A} = p_B^{eq}/p_A^{eq}$, and therefore $\\pi_B/\\pi_A = p_B^{eq}/p_A^{eq}$. So checking populations is equivalent to checking rates in this simple two-state case.\nNumerically, $\\tau_B/\\tau_A = 1190/8810 \\approx 0.13507$, which is indeed very close to $\\exp(-2.0) \\approx 0.13534$.\nHowever, the protocol is described as \"checking *only* that the occupancy ratio... matches... *without analyzing transition counts*\". This is methodologically deficient. The problem explicitly provides transition count data and asks to test the ratio of the underlying *rates*. Ignoring the direct data on transitions (the counts) in favor of an integrated quantity (the residence times) constitutes an incomplete and less direct test. A proper validation of a rate-based model must scrutinize the statistics of the transitions themselves. This protocol fails to use all relevant information and does not directly compute the empirical rate ratio as requested.\n\nVerdict for C: **Incorrect**.\n\n**Option D Evaluation**\n\nThis option proposes a test based on the logarithm of the rate ratio estimator, $\\widehat{\\ell} = \\ln(\\widehat{\\rho})$, where $\\widehat{\\rho} = \\frac{n_{A\\to B}/\\tau_A}{n_{B\\to A}/\\tau_B}$. Thus, $\\widehat{\\ell} = \\ln(n_{A\\to B}) - \\ln(\\tau_A) - \\ln(n_{B\\to A}) + \\ln(\\tau_B)$. This is correct.\nThe method uses the Delta method to approximate the variance, treating residence times as fixed (conditioning). The variance of a function $f(X_1, X_2)$ is approximately $\\sum (\\partial f / \\partial X_i)^2 \\operatorname{Var}(X_i)$. Here, the random variables are $n_{A\\to B}$ and $n_{B\\to A}$, which are Poisson-distributed. We can approximate $\\operatorname{Var}(n) \\approx n$ for large $n$.\nFor $\\widehat{\\ell}$, the partial derivatives are $\\partial\\widehat{\\ell}/\\partial n_{A\\to B} = 1/n_{A\\to B}$ and $\\partial\\widehat{\\ell}/\\partial n_{B\\to A} = -1/n_{B\\to A}$.\nThe variance is then $\\operatorname{Var}(\\widehat{\\ell}) \\approx (1/n_{A\\to B})^2 \\operatorname{Var}(n_{A\\to B}) + (-1/n_{B\\to A})^2 \\operatorname{Var}(n_{B\\to A}) \\approx (1/n_{A\\to B})^2 n_{A\\to B} + (1/n_{B\\to A})^2 n_{B\\to A} = 1/n_{A\\to B} + 1/n_{B\\to A}$. This variance formula is correct under the stated approximations. For large counts, the distribution of $\\widehat{\\ell}$ is well approximated by a normal distribution. This entire protocol is a standard, statistically sound large-sample approach.\nLet us perform the test.\n- The log-ratio estimate is $\\widehat{\\ell} = \\ln\\left( \\frac{1220/8810}{1165/1190} \\right) \\approx \\ln\\left( \\frac{0.13848}{0.97899} \\right) \\approx \\ln(0.14145) \\approx -1.9558$.\n- The null hypothesis value is $\\ell_0 = \\ln(\\rho_0) = -2.0$.\n- The estimated standard error is $SE(\\widehat{\\ell}) = \\sqrt{1/1220 + 1/1165} \\approx \\sqrt{0.0008197 + 0.0008584} = \\sqrt{0.0016781} \\approx 0.04096$.\n- A $95\\%$ confidence interval for $\\ell$ is $\\widehat{\\ell} \\pm 1.96 \\cdot SE(\\widehat{\\ell}) = -1.9558 \\pm 1.96 \\cdot 0.04096 = -1.9558 \\pm 0.0803$.\n- The interval is $[-2.0361, -1.8755]$.\n- The null value $\\ell_0 = -2.0$ is inside this confidence interval. Therefore, we do not reject $H_0$. The conclusion is correct. The protocol is statistically sound.\n\nVerdict for D: **Correct**.", "answer": "$$\\boxed{AD}$$", "id": "2782332"}, {"introduction": "One of the most powerful applications of KMC is the calculation of rate constants for complex processes, often estimated from the mean first-passage time (MFPT) of many independent trajectories. This exercise goes beyond simple averaging, guiding you through the statistical theory of rate estimation from first-passage time data [@problem_id:2782405]. By deriving the maximum likelihood estimator, its bias, and its variance, you will develop the skills needed to not only compute rates but also to rigorously quantify their statistical uncertainty.", "problem": "A chemisorbed species explores a metastable basin $\\mathcal{A}$ on a catalytic surface and eventually reaches a product basin $\\mathcal{B}$. You run Kinetic Monte Carlo (KMC) simulations of the underlying continuous-time Markov chain (CTMC) dynamics, launching independent trajectories from the quasi-stationary ensemble within $\\mathcal{A}$ and stopping each trajectory at the first hitting time of $\\mathcal{B}$. Under the quasi-stationary assumption, the escape from $\\mathcal{A}$ is a renewal process with a constant hazard (memoryless) toward $\\mathcal{B}$; consequently, the first-passage time from $\\mathcal{A}$ to $\\mathcal{B}$ is exponentially distributed with an unknown rate constant $k \\equiv k_{\\mathcal{A}\\to\\mathcal{B}}$.\n\nYou collect $n$ independent and identically distributed first-passage times $\\{T_{i}\\}_{i=1}^{n}$, with $T_{i} \\sim \\text{Exponential}(k)$, and you wish to estimate $k$ by exploiting the definition that a constant hazard implies the rate is the reciprocal of the mean first-passage time (MFPT). Assume $n \\ge 3$.\n\nTasks:\n1. Starting from the likelihood of the $n$-sample $\\{T_{i}\\}$ under an exponential law and without introducing any extraneous modeling assumptions, derive the maximum likelihood estimator $\\hat{k}$ of $k$ in terms of the sample mean $\\bar{T} \\equiv \\frac{1}{n}\\sum_{i=1}^{n} T_{i}$.\n2. Using only the independence of the samples and the renewal/memoryless property stated, compute $\\mathbb{E}[\\hat{k}]$ exactly, identify any bias, and construct an unbiased estimator $\\tilde{k}$ as a linear rescaling of $\\hat{k}$.\n3. Derive the exact closed-form variance $\\mathrm{Var}(\\tilde{k})$ in terms of $n$ and the true $k$.\n\nAnswer specification:\n- Provide your final answer as the exact analytic expression for $\\mathrm{Var}(\\tilde{k})$ in terms of $n$ and $k$ only.\n- No numerical rounding is required.", "solution": "We begin from the fundamental properties of a continuous-time Markov chain (CTMC): exponential waiting times (memoryless property) under a constant hazard and independence across repeated, independently initialized trajectories. Under the quasi-stationary assumption in the basin $\\mathcal{A}$, the first-passage time to $\\mathcal{B}$ is exponentially distributed with unknown rate $k>0$. Thus, the $n$ observed first-passage times are independent and identically distributed (i.i.d.) with $T_{i} \\sim \\text{Exponential}(k)$, so that the joint likelihood as a function of $k$ is\n$$\nL(k; T_{1},\\dots,T_{n}) \\;=\\; \\prod_{i=1}^{n} \\left( k \\exp(-k T_{i}) \\right) \\;=\\; k^{n} \\exp\\!\\left(-k \\sum_{i=1}^{n} T_{i}\\right).\n$$\nTaking the logarithm yields the log-likelihood\n$$\n\\ell(k) \\;=\\; n \\ln k \\;-\\; k \\sum_{i=1}^{n} T_{i}.\n$$\nDifferentiating with respect to $k$ and setting the result to zero gives the likelihood equation\n$$\n\\frac{\\partial \\ell}{\\partial k} \\;=\\; \\frac{n}{k} \\;-\\; \\sum_{i=1}^{n} T_{i} \\;=\\; 0.\n$$\nSolving for $k$ yields the maximum likelihood estimator\n$$\n\\hat{k} \\;=\\; \\frac{n}{\\sum_{i=1}^{n} T_{i}} \\;=\\; \\frac{1}{\\bar{T}}, \\qquad \\text{where} \\quad \\bar{T} \\equiv \\frac{1}{n} \\sum_{i=1}^{n} T_{i}.\n$$\n\nNext, we compute $\\mathbb{E}[\\hat{k}]$ exactly and identify any bias. Let $S \\equiv \\sum_{i=1}^{n} T_{i}$. Since $T_{i}$ are i.i.d. exponential with rate $k$, the sum $S$ has a Gamma distribution with shape $n$ and rate $k$, with density\n$$\nf_{S}(s) \\;=\\; \\frac{k^{n}}{\\Gamma(n)} \\, s^{n-1} \\exp(-k s), \\qquad s>0.\n$$\nBecause $\\bar{T} = S/n$, a change of variables shows that $\\bar{T}$ is Gamma distributed with shape $n$ and rate $k n$:\n$$\nf_{\\bar{T}}(t) \\;=\\; \\frac{(k n)^{n}}{\\Gamma(n)} \\, t^{n-1} \\exp(-k n\\, t), \\qquad t>0.\n$$\nWe require $\\mathbb{E}[1/\\bar{T}]$. Using the density of $\\bar{T}$ and the definition of expectation,\n$$\n\\mathbb{E}\\!\\left[\\frac{1}{\\bar{T}}\\right] \\;=\\; \\int_{0}^{\\infty} \\frac{1}{t} \\, f_{\\bar{T}}(t) \\, dt \\;=\\; \\frac{(k n)^{n}}{\\Gamma(n)} \\int_{0}^{\\infty} t^{n-2} \\exp(-k n\\, t) \\, dt.\n$$\nThe integral is a standard Gamma-function integral:\n$$\n\\int_{0}^{\\infty} t^{n-2} \\exp(-k n\\, t) \\, dt \\;=\\; \\frac{\\Gamma(n-1)}{(k n)^{\\,n-1}}, \\qquad \\text{valid for } n>1.\n$$\nTherefore,\n$$\n\\mathbb{E}\\!\\left[\\frac{1}{\\bar{T}}\\right] \\;=\\; \\frac{(k n)^{n}}{\\Gamma(n)} \\cdot \\frac{\\Gamma(n-1)}{(k n)^{\\,n-1}} \\;=\\; \\frac{k n}{n-1}.\n$$\nHence\n$$\n\\mathbb{E}[\\hat{k}] \\;=\\; \\mathbb{E}\\!\\left[\\frac{1}{\\bar{T}}\\right] \\;=\\; \\frac{k n}{n-1},\n$$\nwhich shows that $\\hat{k}$ is biased upward, with bias\n$$\n\\mathbb{E}[\\hat{k}] - k \\;=\\; \\frac{k}{n-1}.\n$$\nA linear rescaling removes this bias. Define the unbiased estimator\n$$\n\\tilde{k} \\;\\equiv\\; \\frac{n-1}{n} \\, \\hat{k} \\;=\\; \\frac{n-1}{n} \\cdot \\frac{1}{\\bar{T}}.\n$$\nThen\n$$\n\\mathbb{E}[\\tilde{k}] \\;=\\; \\frac{n-1}{n} \\, \\mathbb{E}\\!\\left[\\frac{1}{\\bar{T}}\\right] \\;=\\; \\frac{n-1}{n} \\cdot \\frac{k n}{n-1} \\;=\\; k,\n$$\nas desired.\n\nWe now compute the exact variance $\\mathrm{Var}(\\tilde{k})$. It suffices to find $\\mathrm{Var}(\\hat{k})$ and rescale. We first compute $\\mathbb{E}[\\hat{k}^{2}] = \\mathbb{E}[1/\\bar{T}^{2}]$:\n$$\n\\mathbb{E}\\!\\left[\\frac{1}{\\bar{T}^{2}}\\right] \\;=\\; \\int_{0}^{\\infty} \\frac{1}{t^{2}} \\, f_{\\bar{T}}(t) \\, dt \\;=\\; \\frac{(k n)^{n}}{\\Gamma(n)} \\int_{0}^{\\infty} t^{n-3} \\exp(-k n\\, t) \\, dt.\n$$\nAgain, using the Gamma integral,\n$$\n\\int_{0}^{\\infty} t^{n-3} \\exp(-k n\\, t) \\, dt \\;=\\; \\frac{\\Gamma(n-2)}{(k n)^{\\,n-2}}, \\qquad \\text{valid for } n>2,\n$$\nso\n$$\n\\mathbb{E}\\!\\left[\\frac{1}{\\bar{T}^{2}}\\right] \\;=\\; \\frac{(k n)^{n}}{\\Gamma(n)} \\cdot \\frac{\\Gamma(n-2)}{(k n)^{\\,n-2}} \\;=\\; \\frac{(k n)^{2}}{(n-1)(n-2)}.\n$$\nTherefore,\n$$\n\\mathrm{Var}(\\hat{k}) \\;=\\; \\mathbb{E}[\\hat{k}^{2}] - \\big(\\mathbb{E}[\\hat{k}]\\big)^{2} \\;=\\; \\frac{(k n)^{2}}{(n-1)(n-2)} \\;-\\; \\left(\\frac{k n}{n-1}\\right)^{2} \\;=\\; \\frac{(k n)^{2}}{(n-1)^{2}(n-2)}.\n$$\nFinally, since $\\tilde{k} = \\frac{n-1}{n}\\hat{k}$,\n$$\n\\mathrm{Var}(\\tilde{k}) \\;=\\; \\left(\\frac{n-1}{n}\\right)^{2} \\mathrm{Var}(\\hat{k}) \\;=\\; \\left(\\frac{n-1}{n}\\right)^{2} \\cdot \\frac{(k n)^{2}}{(n-1)^{2}(n-2)} \\;=\\; \\frac{k^{2}}{n-2}.\n$$\nThis exact closed-form variance holds for $n \\ge 3$.", "answer": "$$\\boxed{\\frac{k^{2}}{n-2}}$$", "id": "2782405"}]}