{"hands_on_practices": [{"introduction": "To truly grasp the power and elegance of the EOM-CC framework, it is invaluable to see it perform in a scenario where the exact answer is known. This exercise invites you to explore a minimal two-level system, for which the coupled-cluster equations can be solved analytically [@problem_id:2772662]. By demonstrating that the CCS ground-state energy and the EOM-CCS excitation energy are identical to the Full CI results, you will gain a deep appreciation for the method's correctness in this fundamental limit.", "problem": "Consider a one-electron, two-level model in second quantization with spin-orbitals labeled as $o$ (occupied in the reference) and $v$ (virtual). The Hamiltonian is purely one-body and written as\n$$\n\\hat{H} \\;=\\; h_{oo}\\, a_{o}^{\\dagger} a_{o} \\;+\\; h_{vv}\\, a_{v}^{\\dagger} a_{v} \\;+\\; h_{ov}\\, a_{o}^{\\dagger} a_{v} \\;+\\; h_{vo}\\, a_{v}^{\\dagger} a_{o},\n$$\nwith $h_{vo} = h_{ov}$ and all one-electron integrals real. Work in the orthonormal determinant basis $\\{\\,|\\Phi_{0}\\rangle,\\, |\\Phi_{o}^{v}\\rangle\\,\\}$ where $|\\Phi_{0}\\rangle = a_{o}^{\\dagger}|\\,\\text{vac}\\,\\rangle$ and $|\\Phi_{o}^{v}\\rangle = a_{v}^{\\dagger}|\\,\\text{vac}\\,\\rangle$. The exact Full Configuration Interaction (FCI) energies are the two eigenvalues of the $2 \\times 2$ matrix representation of $\\hat{H}$ in this basis.\n\nUsing the coupled-cluster (CC) ansatz with singles only, define the cluster operator as $T = t_{1}\\, a_{v}^{\\dagger} a_{o}$ and the similarity-transformed Hamiltonian as $\\bar{H} = \\exp(-T)\\,\\hat{H}\\,\\exp(T)$. Start from the coupled-cluster energy and amplitude defining equations\n$$\nE_{\\text{CC}} \\;=\\; \\langle \\Phi_{0}|\\,\\bar{H}\\,| \\Phi_{0}\\rangle,\\qquad 0 \\;=\\; \\langle \\Phi_{o}^{v}|\\,\\bar{H}\\,| \\Phi_{0}\\rangle,\n$$\nand derive analytic, closed-form expressions for the amplitude $t_{1}$ and the ground-state energy $E_{\\text{CC}}$ as functions of $h_{oo}$, $h_{vv}$, and $h_{ov}$. Assume $h_{ov} \\neq 0$ and define $\\Delta = h_{vv} - h_{oo}$. Then show, by explicit comparison to the $2 \\times 2$ diagonalization, that $E_{\\text{CC}}$ equals the lower FCI eigenvalue for this one-electron model.\n\nAs contextual support for the topic of Equation-of-Motion Coupled-Cluster (EOM-CC) for excited states, discuss briefly (no calculation required) whether the singles Equation-of-Motion Coupled-Cluster (EOM-CCS) excitation energy is exact in this model and why.\n\nYour final answer must consist of the ordered pair $\\big(E_{\\text{CC}},\\, t_{1}\\big)$, expressed in closed form in terms of $h_{oo}$, $h_{vv}$, and $h_{ov}$. Do not include units. Do not round.", "solution": "The user has provided a problem in theoretical chemistry concerning the coupled-cluster with singles (CCS) method for a one-electron, two-level system. The task is to validate the problem, derive the CCS ground-state energy and amplitude, show that the energy is identical to the lower Full Configuration Interaction (FCI) eigenvalue, and discuss the exactness of the Equation-of-Motion CCS (EOM-CCS) excitation energy.\n\nFirst, the validation of the problem statement is performed.\n\nStep 1: Extract Givens.\n- System: A one-electron, two-level model.\n- Spin-orbitals: `$o$` (occupied) and `$v$` (virtual).\n- Hamiltonian: `$\\hat{H} = h_{oo}\\, a_{o}^{\\dagger} a_{o} + h_{vv}\\, a_{v}^{\\dagger} a_{v} + h_{ov}\\, a_{o}^{\\dagger} a_{v} + h_{vo}\\, a_{v}^{\\dagger} a_{o}$`.\n- Conditions on integrals: `$h_{vo} = h_{ov}$`, all integrals are real, and `$h_{ov} \\neq 0$`.\n- Basis: Orthonormal determinant basis `$\\{ |\\Phi_{0}\\rangle, |\\Phi_{o}^{v}\\rangle \\}$` where `$|\\Phi_{0}\\rangle = a_{o}^{\\dagger}|\\,\\text{vac}\\,\\rangle$` and `$|\\Phi_{o}^{v}\\rangle = a_{v}^{\\dagger}|\\,\\text{vac}\\,\\rangle$`.\n- Cluster operator: `$T = t_{1}\\, a_{v}^{\\dagger} a_{o}$`.\n- Similarity-transformed Hamiltonian: `$\\bar{H} = \\exp(-T)\\,\\hat{H}\\,\\exp(T)$`.\n- Coupled-cluster equations: `$E_{\\text{CC}} = \\langle \\Phi_{0}|\\,\\bar{H}\\,| \\Phi_{0}\\rangle$` and `$0 = \\langle \\Phi_{o}^{v}|\\,\\bar{H}\\,| \\Phi_{0}\\rangle$`.\n- Definition: `$\\Delta = h_{vv} - h_{oo}$`.\n- Tasks:\n  1. Derive expressions for `$t_{1}$` and `$E_{\\text{CC}}$`.\n  2. Show `$E_{\\text{CC}}$` equals the lower FCI eigenvalue.\n  3. Discuss if EOM-CCS is exact for this model.\n\nStep 2: Validate Using Extracted Givens.\n- The problem is **scientifically grounded**. It describes a standard solvable model used in quantum chemistry to test and illustrate many-body methods. The Hamiltonian, basis states, and coupled-cluster formalism are all standard and correctly formulated.\n- The problem is **well-posed**. It provides all necessary information (Hamiltonian, basis, equations) to derive a unique solution for the requested quantities. The condition `$h_{ov} \\neq 0$` ensures the denominator in the expression for `$t_1$` is non-zero, avoiding a singularity.\n- The problem is **objective**. It uses precise, standard terminology from theoretical chemistry and quantum mechanics, free of ambiguity or subjective claims.\n- The problem does not violate any of the invalidity criteria. It is a textbook-style exercise in quantum chemistry.\n\nStep 3: Verdict and Action.\nThe problem is valid. The solution will now be derived.\n\nFirst, we determine the exact energies by solving the Full Configuration Interaction (FCI) problem, which is equivalent to diagonalizing the Hamiltonian in the given basis `$\\{ |\\Phi_{0}\\rangle, |\\Phi_{o}^{v}\\rangle \\}$`. The matrix elements `$H_{ij} = \\langle \\Phi_i | \\hat{H} | \\Phi_j \\rangle$` are:\n`$H_{11} = \\langle \\Phi_{0}|\\hat{H}|\\Phi_{0}\\rangle = \\langle \\text{vac}|a_{o} \\hat{H} a_{o}^{\\dagger}|\\text{vac}\\rangle = h_{oo}$`.\n`$H_{22} = \\langle \\Phi_{o}^{v}|\\hat{H}|\\Phi_{o}^{v}\\rangle = \\langle \\text{vac}|a_{v} \\hat{H} a_{v}^{\\dagger}|\\text{vac}\\rangle = h_{vv}$`.\n`$H_{12} = \\langle \\Phi_{0}|\\hat{H}|\\Phi_{o}^{v}\\rangle = \\langle \\text{vac}|a_{o} \\hat{H} a_{v}^{\\dagger}|\\text{vac}\\rangle = h_{ov}$`.\n`$H_{21} = \\langle \\Phi_{o}^{v}|\\hat{H}|\\Phi_{0}\\rangle = \\langle \\text{vac}|a_{v} \\hat{H} a_{o}^{\\dagger}|\\text{vac}\\rangle = h_{vo} = h_{ov}$`.\nThe FCI matrix is thus:\n$$\n\\mathbf{H}_{\\text{FCI}} = \\begin{pmatrix} h_{oo} & h_{ov} \\\\ h_{ov} & h_{vv} \\end{pmatrix}\n$$\nThe eigenvalues `$E_{\\text{FCI}}$` are found by solving the characteristic equation `$\\det(\\mathbf{H}_{\\text{FCI}} - E \\mathbf{I}) = 0$`:\n$$\n(h_{oo} - E)(h_{vv} - E) - h_{ov}^{2} = 0\n$$\n$$\nE^{2} - (h_{oo} + h_{vv})E + h_{oo}h_{vv} - h_{ov}^{2} = 0\n$$\nThe solutions for the energy `$E$` are:\n$$\nE_{\\text{FCI}} = \\frac{h_{oo} + h_{vv} \\pm \\sqrt{(h_{oo} + h_{vv})^{2} - 4(h_{oo}h_{vv} - h_{ov}^{2})}}{2}\n$$\n$$\nE_{\\text{FCI}} = \\frac{h_{oo} + h_{vv} \\pm \\sqrt{h_{oo}^{2} - 2h_{oo}h_{vv} + h_{vv}^{2} + 4h_{ov}^{2}}}{2}\n$$\n$$\nE_{\\text{FCI}} = \\frac{h_{oo} + h_{vv}}{2} \\pm \\frac{1}{2}\\sqrt{(h_{vv} - h_{oo})^{2} + 4h_{ov}^{2}}\n$$\nThe lower eigenvalue, corresponding to the FCI ground state energy, is:\n$$\nE_{\\text{FCI, lower}} = \\frac{h_{oo} + h_{vv}}{2} - \\frac{1}{2}\\sqrt{(h_{vv} - h_{oo})^{2} + 4h_{ov}^{2}}\n$$\nNext, we solve the coupled-cluster problem. We need the similarity-transformed Hamiltonian `$\\bar{H} = \\exp(-T)\\hat{H}\\exp(T)$`. We use the Baker-Campbell-Hausdorff (BCH) expansion:\n`$\\bar{H} = \\hat{H} + [\\hat{H}, T] + \\frac{1}{2}[[\\hat{H}, T], T] + \\dots$`\nThe cluster operator is `$T = t_{1}a_{v}^{\\dagger} a_{o}$`. The Hamiltonian `$\\hat{H}$` is a one-body operator. The commutator of two one-body operators is a one-body operator. The BCH series terminates.\nThe first commutator is:\n`$[\\hat{H}, T] = t_{1} \\sum_{p,q} h_{pq} [a_{p}^{\\dagger}a_{q}, a_{v}^{\\dagger}a_{o}] = t_{1} \\sum_{p,q} h_{pq} (\\delta_{qv} a_{p}^{\\dagger}a_{o} - \\delta_{op} a_{v}^{\\dagger}a_{q})`\n`$= t_{1} (\\sum_{p} h_{pv} a_{p}^{\\dagger}a_{o} - \\sum_{q} h_{oq} a_{v}^{\\dagger}a_{q})$`\n`$= t_{1} ( (h_{ov}a_{o}^{\\dagger}a_{o} + h_{vv}a_{v}^{\\dagger}a_{o}) - (h_{oo}a_{v}^{\\dagger}a_{o} + h_{ov}a_{v}^{\\dagger}a_{v}) )$`\n`$= t_{1} [ (h_{vv} - h_{oo})a_{v}^{\\dagger}a_{o} + h_{ov}(a_{o}^{\\dagger}a_{o} - a_{v}^{\\dagger}a_{v}) ]`\n\nThe second commutator is:\n`$[[\\hat{H}, T], T] = [t_{1} ( (h_{vv} - h_{oo})a_{v}^{\\dagger}a_{o} + h_{ov}(a_{o}^{\\dagger}a_{o} - a_{v}^{\\dagger}a_{v}) ), t_{1}a_{v}^{\\dagger}a_{o}]$`\n`$= t_{1}^{2} h_{ov} [a_{o}^{\\dagger}a_{o} - a_{v}^{\\dagger}a_{v}, a_{v}^{\\dagger}a_{o}] = t_{1}^{2} h_{ov} ( [a_{o}^{\\dagger}a_{o}, a_{v}^{\\dagger}a_{o}] - [a_{v}^{\\dagger}a_{v}, a_{v}^{\\dagger}a_{o}] )$`\nUsing `$[a_{p}^{\\dagger}a_{q}, a_{r}^{\\dagger}a_{s}] = \\delta_{qr}a_{p}^{\\dagger}a_{s} - \\delta_{ps}a_{r}^{\\dagger}a_{q}$`, we get:\n`$[a_{o}^{\\dagger}a_{o}, a_{v}^{\\dagger}a_{o}] = -a_{v}^{\\dagger}a_{o}$` and `$[a_{v}^{\\dagger}a_{v}, a_{v}^{\\dagger}a_{o}] = a_{v}^{\\dagger}a_{o}$`.\n`$[[\\hat{H}, T], T] = t_{1}^{2} h_{ov}(-a_{v}^{\\dagger}a_{o} - a_{v}^{\\dagger}a_{o}) = -2t_{1}^{2}h_{ov}a_{v}^{\\dagger}a_{o}$`.\nThe third commutator `$[[[\\hat{H}, T], T], T]$` is zero, so the series terminates here.\n\nNow, we evaluate the CC equations. For this system, `$\\exp(T)|\\Phi_{0}\\rangle = (1+T)|\\Phi_{0}\\rangle = |\\Phi_{0}\\rangle + t_{1}|\\Phi_{o}^{v}\\rangle$`. More simply, we project onto `$\\langle \\Phi_0 |$` and `$\\langle \\Phi_o^v |$` the state `$\\bar{H} | \\Phi_0 \\rangle = \\exp(-T)\\hat{H}\\exp(T)|\\Phi_0\\rangle$`:\n`$\\hat{H}\\exp(T)|\\Phi_0\\rangle = \\hat{H}(|\\Phi_0\\rangle + t_1|\\Phi_o^v\\rangle) = (h_{oo} + t_1 h_{ov})|\\Phi_0\\rangle + (h_{ov} + t_1 h_{vv})|\\Phi_o^v\\rangle$`\n`$\\bar{H}|\\Phi_0\\rangle = \\exp(-T) [ (h_{oo} + t_1 h_{ov})|\\Phi_0\\rangle + (h_{ov} + t_1 h_{vv})|\\Phi_o^v\\rangle ]$`\n`$= (1-T) [ (h_{oo} + t_1 h_{ov})|\\Phi_0\\rangle + (h_{ov} + t_1 h_{vv})|\\Phi_o^v\\rangle ]$`\n`$= (h_{oo} + t_1 h_{ov})|\\Phi_0\\rangle + (h_{ov} + t_1 h_{vv})|\\Phi_o^v\\rangle - (h_{oo} + t_1 h_{ov})T|\\Phi_0\\rangle - (h_{ov} + t_1 h_{vv})T|\\Phi_o^v\\rangle$`\nSince `$T|\\Phi_0\\rangle = t_1|\\Phi_o^v\\rangle$` and `$T|\\Phi_o^v\\rangle = 0$`, we have:\n`$\\bar{H}|\\Phi_0\\rangle = (h_{oo} + t_1 h_{ov})|\\Phi_0\\rangle + [ (h_{ov} + t_1 h_{vv}) - t_1(h_{oo} + t_1 h_{ov}) ]|\\Phi_o^v\\rangle$`\n\nThe CC energy and amplitude equations become:\n`$E_{\\text{CC}} = \\langle \\Phi_0 | \\bar{H} | \\Phi_0 \\rangle = h_{oo} + t_1 h_{ov}$`\n`$0 = \\langle \\Phi_o^v | \\bar{H} | \\Phi_0 \\rangle = h_{ov} + t_1 h_{vv} - t_1 h_{oo} - t_1^2 h_{ov} = h_{ov} + t_1(h_{vv}-h_{oo}) - t_1^2 h_{ov}$`\nRearranging the amplitude equation gives a quadratic equation for `$t_1$`:\n`$h_{ov} t_{1}^{2} - \\Delta t_{1} - h_{ov} = 0$`, where `$\\Delta = h_{vv} - h_{oo}$`.\nThe solution for `$t_1$` is:\n$$\nt_{1} = \\frac{\\Delta \\pm \\sqrt{\\Delta^{2} + 4h_{ov}^{2}}}{2h_{ov}}\n$$\nFor the solution to be physically meaningful, `$t_1$` must vanish as the perturbation `$h_{ov}$` goes to zero. This requires choosing the minus sign in the numerator. If `$\\Delta > 0$`, `$\\sqrt{\\Delta^2 + 4h_{ov}^2} \\approx \\Delta(1 + 2h_{ov}^2/\\Delta^2)$`. The minus sign gives `$t_1 \\approx (\\Delta - \\Delta(1+2h_{ov}^2/\\Delta^2))/(2h_{ov}) = -h_{ov}/\\Delta$`, which correctly goes to `$0$`. The plus sign leads to a divergence. Therefore:\n$$\nt_{1} = \\frac{\\Delta - \\sqrt{\\Delta^{2} + 4h_{ov}^{2}}}{2h_{ov}} = \\frac{(h_{vv} - h_{oo}) - \\sqrt{(h_{vv} - h_{oo})^{2} + 4h_{ov}^{2}}}{2h_{ov}}\n$$\nSubstituting this `$t_1$` into the energy expression:\n`$E_{\\text{CC}} = h_{oo} + h_{ov} \\left( \\frac{(h_{vv} - h_{oo}) - \\sqrt{(h_{vv} - h_{oo})^{2} + 4h_{ov}^{2}}}{2h_{ov}} \\right)`\n`$E_{\\text{CC}} = h_{oo} + \\frac{h_{vv} - h_{oo}}{2} - \\frac{1}{2}\\sqrt{(h_{vv} - h_{oo})^{2} + 4h_{ov}^{2}}$`\n`$E_{\\text{CC}} = \\frac{2h_{oo} + h_{vv} - h_{oo}}{2} - \\frac{1}{2}\\sqrt{(h_{vv} - h_{oo})^{2} + 4h_{ov}^{2}}$`\n$$\nE_{\\text{CC}} = \\frac{h_{oo} + h_{vv}}{2} - \\frac{1}{2}\\sqrt{(h_{vv} - h_{oo})^{2} + 4h_{ov}^{2}}\n$$\nComparing this expression for `$E_{\\text{CC}}$` with `$E_{\\text{FCI, lower}}$` derived previously, we find they are identical. Thus, the CCS ground-state energy is exact for this model.\n\nFinally, regarding the Equation-of-Motion CCS (EOM-CCS) excitation energy. The EOM-CC method finds excited states by diagonalizing the similarity-transformed Hamiltonian `$\\bar{H}$` in the space of excited determinants. For this problem, the excited space is one-dimensional, spanned only by `$|\\Phi_o^v\\rangle$`. The matrix representation of `$\\bar{H}$` in the basis `$\\{|\\Phi_0\\rangle, |\\Phi_o^v\\rangle\\}$` is:\n$$\n\\mathbf{\\bar{H}} = \\begin{pmatrix} \\langle\\Phi_0|\\bar{H}|\\Phi_0\\rangle & \\langle\\Phi_0|\\bar{H}|\\Phi_o^v\\rangle \\\\ \\langle\\Phi_o^v|\\bar{H}|\\Phi_0\\rangle & \\langle\\Phi_o^v|\\bar{H}|\\Phi_o^v\\rangle \\end{pmatrix}\n$$\nFrom the CC equations, we know `$\\langle\\Phi_0|\\bar{H}|\\Phi_0\\rangle = E_{\\text{CC}}$` and `$\\langle\\Phi_o^v|\\bar{H}|\\Phi_0\\rangle = 0$`. The matrix is lower triangular:\n$$\n\\mathbf{\\bar{H}} = \\begin{pmatrix} E_{\\text{CC}} & \\langle\\Phi_0|\\bar{H}|\\Phi_o^v\\rangle \\\\ 0 & \\langle\\Phi_o^v|\\bar{H}|\\Phi_o^v\\rangle \\end{pmatrix}\n$$\nThe eigenvalues of `$\\mathbf{\\bar{H}}$` are its diagonal elements: `$E_{\\text{CC}}$` and `$\\langle\\Phi_o^v|\\bar{H}|\\Phi_o^v\\rangle$`. Because `$\\bar{H}$` is related to `$\\hat{H}$` by a similarity transformation, they share the same set of eigenvalues. We already showed that `$E_{\\text{CC}}$` is the lower FCI eigenvalue. It follows that the other eigenvalue of `$\\mathbf{\\bar{H}}$`, `$\\langle\\Phi_o^v|\\bar{H}|\\Phi_o^v\\rangle$`, must be equal to the upper FCI eigenvalue, `$E_{\\text{FCI, upper}}$`. The EOM-CCS excited state energy is this second eigenvalue, and the excitation energy is `$\\omega_{\\text{EOM}} = E_{\\text{FCI, upper}} - E_{\\text{CC}} = E_{\\text{FCI, upper}} - E_{\\text{FCI, lower}}$`. This is precisely the exact FCI excitation energy. Therefore, the EOM-CCS excitation energy is also exact for this model. This exactness arises because the full Hilbert space of the problem is spanned by the reference and singly excited determinants, which is the space wherein CCS and EOM-CCS operate.", "answer": "$$\n\\boxed{\\left( \\frac{h_{oo} + h_{vv}}{2} - \\frac{1}{2} \\sqrt{(h_{vv} - h_{oo})^{2} + 4 h_{ov}^{2}} , \\frac{(h_{vv} - h_{oo}) - \\sqrt{(h_{vv} - h_{oo})^{2} + 4 h_{ov}^{2}}}{2 h_{ov}} \\right)}\n$$", "id": "2772662"}, {"introduction": "Moving from a minimal model to real chemical systems, the computational cost of EOM-CCSD becomes a primary concern, determined by the size of the excitation vector. This practice problem tasks you with deriving the dimensions of the singles and doubles excitation manifolds, which together define the size of the EOM-EE-CCSD eigenvalue problem [@problem_id:2772697]. This exercise is fundamental to understanding the method's computational scaling and memory requirements, which are critical considerations for practical applications.", "problem": "Consider a closed-shell reference described in a restricted Hartree–Fock (RHF) canonical molecular orbital basis and the Equation-of-Motion Coupled-Cluster for Excitation Energies with Singles and Doubles (EOM-EE-CCSD) ansatz in the spin-orbital (non-spin-adapted) formulation. Let the number of occupied spin-orbitals be $n_{o}$ and the number of virtual spin-orbitals be $n_{v}$. The right-hand excitation operator is written as $R = \\sum_{i,a} r_{i}^{a}\\, a_{a}^{\\dagger} a_{i} + \\frac{1}{4}\\sum_{i,j,a,b} r_{ij}^{ab}\\, a_{a}^{\\dagger} a_{b}^{\\dagger} a_{j} a_{i}$, where $i,j$ index occupied spin-orbitals and $a,b$ index virtual spin-orbitals. For excitation energies, the scalar component is absent, so only the singles ($1h1p$) and doubles ($2h2p$) sectors contribute. Assume that only independent antisymmetric components are stored, i.e., $r_{ij}^{ab} = -r_{ji}^{ab} = -r_{ij}^{ba}$, and arrays are indexed with $i<j$ and $a<b$. \n\nStarting from the definitions of the excitation manifold and fermionic antisymmetry, derive the general expressions for the sizes of the singles and doubles spaces as functions of $n_{o}$ and $n_{v}$, and hence the total dimension $D$ of the EOM-EE-CCSD right-hand vector $r$. Then, for a pedagogical toy system with $n_{o}=2$ occupied spin-orbitals and $n_{v}=3$ virtual spin-orbitals:\n- Compute the exact total dimension $D$.\n- Assuming double-precision real storage requiring $8$ bytes per number, compute the exact number of bytes needed to store one $r$ vector as a dense array.\n\nExpress the final memory as a number in bytes. No rounding is required. The final answer must be a single real number.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n**Step 1: Extract Givens**\n- **Method:** Equation-of-Motion Coupled-Cluster for Excitation Energies with Singles and Doubles (EOM-EE-CCSD).\n- **Reference State:** A closed-shell Restricted Hartree-Fock (RHF) determinant in a canonical molecular spin-orbital basis.\n- **System Size Parameters:** $n_o$ is the number of occupied spin-orbitals; $n_v$ is the number of virtual spin-orbitals.\n- **Excitation Operator ($R$):** $R = \\sum_{i,a} r_{i}^{a}\\, a_{a}^{\\dagger} a_{i} + \\frac{1}{4}\\sum_{i,j,a,b} r_{ij}^{ab}\\, a_{a}^{\\dagger} a_{b}^{\\dagger} a_{j} a_{i}$.\n- **Indices:** $i,j$ denote occupied spin-orbitals; $a,b$ denote virtual spin-orbitals.\n- **Amplitude Vector ($r$):** Composed of singles amplitudes ($r_i^a$) and doubles amplitudes ($r_{ij}^{ab}$). The scalar component is zero.\n- **Amplitude Symmetry:** Doubles amplitudes are antisymmetric: $r_{ij}^{ab} = -r_{ji}^{ab} = -r_{ij}^{ba}$.\n- **Storage Convention:** Only independent components with $i<j$ and $a<b$ are stored.\n- **Toy System:** $n_{o}=2$ and $n_{v}=3$.\n- **Storage Requirement:** $8$ bytes per number (double-precision real).\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding:** The problem is firmly grounded in the established theory of EOM-CCSD, a standard and widely used method in computational quantum chemistry. The definitions of the excitation operator, excitation manifolds, and antisymmetry of amplitudes are all standard and correct.\n- **Well-Posedness:** The problem is well-posed. It asks for the dimensionality of a vector space defined by clear, unambiguous rules and parameters. A unique, stable, and meaningful solution exists.\n- **Objectivity:** The problem is stated in precise, objective, and technical language. It is free from subjective claims.\n\nBased on this analysis, the problem is scientifically sound, complete, and well-posed. It contains no logical contradictions, unrealistic conditions, or ambiguities. Therefore, the problem is deemed **valid**. We may proceed with the solution.\n\n**Solution Derivation**\n\nThe total dimension $D$ of the EOM-EE-CCSD right-hand vector $r$ is the sum of the number of independent singles ($1h1p$) amplitudes and the number of independent doubles ($2h2p$) amplitudes. We denote these dimensions as $D_1$ and $D_2$, respectively. Thus, $D = D_1 + D_2$.\n\n**1. Dimension of the Singles Space ($D_1$)**\nThe singles space is spanned by excited determinants of the form $|\\Phi_i^a\\rangle = a_a^\\dagger a_i |\\Phi_0\\rangle$, where $|\\Phi_0\\rangle$ is the Hartree-Fock reference determinant. The corresponding amplitudes are denoted $r_i^a$. To form a single excitation, one must choose one occupied spin-orbital to annihilate an electron from, and one virtual spin-orbital to create an electron into.\n- The occupied spin-orbital index $i$ can be chosen from $n_o$ available occupied spin-orbitals.\n- The virtual spin-orbital index $a$ can be chosen from $n_v$ available virtual spin-orbitals.\n\nSince the choice of $i$ and $a$ are independent, the total number of unique single excitations is the product of the number of choices.\n$$D_1 = n_o \\times n_v$$\n\n**2. Dimension of the Doubles Space ($D_2$)**\nThe doubles space is spanned by excited determinants of the form $|\\Phi_{ij}^{ab}\\rangle = a_a^\\dagger a_b^\\dagger a_j a_i |\\Phi_0\\rangle$, with corresponding amplitudes $r_{ij}^{ab}$. The problem states the antisymmetry property $r_{ij}^{ab} = -r_{ji}^{ab} = -r_{ij}^{ba}$. This property arises from the fermionic nature of electrons, specifically the anticommutation relations of the creation and annihilation operators, $\\{a_p, a_q\\} = 0$ for $p \\neq q$ and $\\{a_p^\\dagger, a_q^\\dagger\\} = 0$ for $p \\neq q$. Consequently, $a_a^\\dagger a_b^\\dagger = -a_b^\\dagger a_a^\\dagger$ and $a_j a_i = -a_i a_j$.\n\nTo count the number of independent amplitudes, we must choose two distinct occupied spin-orbitals and two distinct virtual spin-orbitals. The problem specifies that amplitudes are stored using the index convention $i<j$ and $a<b$ to ensure uniqueness.\n- The number of ways to choose two distinct occupied spin-orbitals from a set of $n_o$ is given by the binomial coefficient $\\binom{n_o}{2}$. This counts the number of unique pairs $\\{i,j\\}$.\n$$ \\binom{n_o}{2} = \\frac{n_o(n_o - 1)}{2} $$\n- Similarly, the number of ways to choose two distinct virtual spin-orbitals from a set of $n_v$ is given by the binomial coefficient $\\binom{n_v}{2}$. This counts the number of unique pairs $\\{a,b\\}$.\n$$ \\binom{n_v}{2} = \\frac{n_v(n_v - 1)}{2} $$\nThe total number of independent doubles amplitudes is the product of these two quantities.\n$$D_2 = \\binom{n_o}{2} \\binom{n_v}{2} = \\frac{n_o(n_o-1)}{2} \\frac{n_v(n_v-1)}{2}$$\n\n**3. Total Dimension ($D$)**\nThe total dimension of the EOM-EE-CCSD space is the sum of the singles and doubles dimensions.\n$$D = D_1 + D_2 = n_o n_v + \\frac{n_o(n_o-1)}{2} \\frac{n_v(n_v-1)}{2}$$\n\n**4. Calculation for the Toy System**\nWe are given the parameters for a toy system: $n_o=2$ and $n_v=3$. We apply the derived general expressions.\n\n- Dimension of the singles space:\n$$D_1 = n_o n_v = 2 \\times 3 = 6$$\n\n- Dimension of the doubles space:\n$$D_2 = \\binom{2}{2} \\binom{3}{2} = \\left(\\frac{2(2-1)}{2}\\right) \\left(\\frac{3(3-1)}{2}\\right) = \\left(\\frac{2}{2}\\right) \\left(\\frac{6}{2}\\right) = 1 \\times 3 = 3$$\n\n- Total dimension $D$:\n$$D = D_1 + D_2 = 6 + 3 = 9$$\n\n**5. Memory Calculation**\nThe problem states that each element of the vector $r$ is a double-precision real number, which requires $8$ bytes of storage. The total dimension of the vector is $D=9$. Therefore, the total memory required to store one vector $r$ as a dense array is:\n$$ \\text{Memory} = D \\times (\\text{bytes per number}) = 9 \\times 8 = 72 \\text{ bytes} $$\nThe total memory required is $72$ bytes.", "answer": "$$\\boxed{72}$$", "id": "2772697"}, {"introduction": "The large, non-Hermitian EOM-CC eigenvalue problem is almost always solved using iterative subspace methods, with the Davidson algorithm being a popular choice. This hands-on exercise demystifies the process by guiding you through a single iteration for a small, well-defined system [@problem_id:2772714]. By performing the Rayleigh-Ritz projection, calculating the residual, and generating the next trial vector, you will gain tangible insight into the mechanics of the numerical engine that drives modern EOM-CC calculations.", "problem": "You are solving the right-hand excitation-energy eigenproblem of Equation-of-Motion Coupled-Cluster (EOM-CC) theory for the similarity-transformed Hamiltonian, namely the right eigenvalue equation $\\bar{H} r_k = \\omega_k r_k$, where $\\bar{H}$ is a non-Hermitian but real operator, $r_k$ is the excitation operator parametrized as a vector in a chosen basis, and $\\omega_k$ is the target excitation energy. A Krylov subspace method with Davidson expansion will be used. In such methods, given a set of $m$ orthonormal trial vectors collected as columns of $V \\in \\mathbb{R}^{n \\times m}$ and their $\\sigma$-images $\\Sigma := \\bar{H} V \\in \\mathbb{R}^{n \\times m}$, the Rayleigh–Ritz projection determines approximate eigenpairs by solving the reduced eigenproblem in the subspace. The corresponding residual $r := \\Sigma c - \\omega V c$ is preconditioned by a diagonal approximation $D \\approx \\mathrm{diag}(\\bar{H})$ to obtain a correction vector, which is orthogonalized against the current subspace and normalized to expand the basis.\n\nConsider the following concrete data in $\\mathbb{R}^{4}$ for a single Davidson subspace iteration. The current orthonormal trial vectors are\n$$\nv_1=\\begin{pmatrix}1\\\\0\\\\0\\\\0\\end{pmatrix},\\quad\nv_2=\\begin{pmatrix}0\\\\1\\\\0\\\\0\\end{pmatrix},\n$$\nand the corresponding $\\sigma$-images (i.e., $\\sigma_i=\\bar{H} v_i$) are\n$$\n\\sigma_1=\\begin{pmatrix}0.35\\\\0.10\\\\0.05\\\\0.00\\end{pmatrix},\\quad\n\\sigma_2=\\begin{pmatrix}0.10\\\\0.60\\\\0.02\\\\-0.03\\end{pmatrix},\n$$\nall entries in Hartree. Use the diagonal preconditioner\n$$\nD=\\mathrm{diag}(0.34,\\,0.62,\\,0.48,\\,0.70).\n$$\nPerform one Davidson subspace iteration as follows:\n\n1. Form the reduced $2\\times 2$ Rayleigh–Ritz matrix $\\tilde{H}=V^{\\mathsf{T}}\\Sigma$ and solve for its lowest eigenvalue $\\omega$ and corresponding normalized coefficient vector $c\\in\\mathbb{R}^{2}$.\n2. Form the Ritz vector $u=V c$, the residual $r=\\Sigma c-\\omega u$, and the diagonally preconditioned correction $t$ with components $t_i=r_i/(D_{ii}-\\omega)$, $i\\in\\{1,2,3,4\\}$.\n3. Orthonormalize $t$ against the current subspace by subtracting its projections onto $v_1$ and $v_2$, and then normalize the result to unit norm to obtain the improved trial vector $w$.\n\nReport the approximate excitation energy $\\omega$ obtained from the Rayleigh–Ritz step. Express the final energy in Hartree, and round your answer to four significant figures.", "solution": "We start from the right-hand Equation-of-Motion Coupled-Cluster (EOM-CC) eigenproblem $\\bar{H} r=\\omega r$. In a Rayleigh–Ritz step on an orthonormal subspace with basis $V$, the reduced matrix is $\\tilde{H}=V^{\\mathsf{T}}\\Sigma$ with $\\Sigma=\\bar{H}V$. The Ritz pairs solve $\\tilde{H} c=\\omega c$, yielding the approximate excitation energy $\\omega$ and coefficients $c$ of the Ritz vector $u=V c$.\n\nStep $1$: Build $\\tilde{H}$. With $V=[v_1\\;v_2]$ and $\\Sigma=[\\sigma_1\\;\\sigma_2]$, orthonormality of $v_1$ and $v_2$ implies\n$$\n\\tilde{H}\n=\n\\begin{pmatrix}\nv_1^{\\mathsf{T}}\\sigma_1 & v_1^{\\mathsf{T}}\\sigma_2\\\\\nv_2^{\\mathsf{T}}\\sigma_1 & v_2^{\\mathsf{T}}\\sigma_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.35 & 0.10\\\\\n0.10 & 0.60\n\\end{pmatrix}.\n$$\nSolve the $2\\times 2$ symmetric eigenproblem. The eigenvalues of\n$$\n\\begin{pmatrix}\na & b\\\\\nb & c\n\\end{pmatrix}\n$$\nare\n$$\n\\lambda_{\\pm}=\\frac{a+c}{2}\\pm\\sqrt{\\left(\\frac{a-c}{2}\\right)^{2}+b^{2}}.\n$$\nWith $a=0.35$, $b=0.10$, $c=0.60$, we have\n$$\n\\frac{a+c}{2}=\\frac{0.35+0.60}{2}=0.475,\n$$\n$$\n\\sqrt{\\left(\\frac{a-c}{2}\\right)^{2}+b^{2}}=\\sqrt{\\left(\\frac{0.35-0.60}{2}\\right)^{2}+0.10^{2}}=\\sqrt{0.125^{2}+0.10^{2}}=\\sqrt{0.015625+0.01}=\\sqrt{0.025625}=0.160078\\ldots\n$$\nThus\n$$\n\\lambda_{-}=0.475-0.160078\\ldots=0.314922\\ldots,\\quad \\lambda_{+}=0.475+0.160078\\ldots=0.635078\\ldots\n$$\nWe take the lowest Ritz value as the approximate excitation energy, so $\\omega=\\lambda_{-}=0.314922\\ldots$ Hartree.\n\nThe normalized eigenvector $c$ for $\\lambda_{-}$ satisfies\n$$\n\\left(\\begin{array}{cc}\na-\\lambda_{-} & b\\\\\nb & c-\\lambda_{-}\n\\end{array}\\right)\n\\begin{pmatrix}c_1\\\\c_2\\end{pmatrix}\n=\n\\begin{pmatrix}0\\\\0\\end{pmatrix}.\n$$\nA convenient unnormalized solution is $c'\\propto\\begin{pmatrix}b\\\\ \\lambda_{-}-a\\end{pmatrix}=\\begin{pmatrix}0.10\\\\ -0.035078\\ldots\\end{pmatrix}$. Normalizing,\n$$\n\\|c'\\|=\\sqrt{(0.10)^{2}+(-0.035078\\ldots)^{2}}=\\sqrt{0.01+0.00123047\\ldots}=0.105995\\ldots,\n$$\nso one normalized choice is\n$$\nc=\\frac{1}{0.105995\\ldots}\\begin{pmatrix}0.10\\\\ -0.035078\\ldots\\end{pmatrix}=\\begin{pmatrix}0.9434\\ldots\\\\ -0.3317\\ldots\\end{pmatrix}.\n$$\n\nStep $2$: Form $u=V c$ and the residual $r=\\Sigma c-\\omega u$. Using the unnormalized $c'$ is algebraically convenient because it guarantees exact cancellation in the subspace components:\n$$\nu'=V c'=\\begin{pmatrix}0.10\\\\ -0.035078\\ldots\\\\ 0\\\\ 0\\end{pmatrix},\\quad\n\\Sigma c'=0.10\\,\\sigma_1+(\\lambda_{-}-a)\\,\\sigma_2.\n$$\nCompute $\\Sigma c'$ componentwise:\n$$\n\\Sigma c'\n=\n0.10\\begin{pmatrix}0.35\\\\0.10\\\\0.05\\\\0.00\\end{pmatrix}\n+(-0.035078\\ldots)\\begin{pmatrix}0.10\\\\0.60\\\\0.02\\\\-0.03\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.035-0.0035078\\ldots\\\\\n0.010-0.0210468\\ldots\\\\\n0.005-0.00070156\\ldots\\\\\n0+0.00105234\\ldots\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.0314922\\ldots\\\\\n-0.0110468\\ldots\\\\\n0.00429844\\ldots\\\\\n0.00105234\\ldots\n\\end{pmatrix}.\n$$\nAlso,\n$$\n\\omega u'=\\lambda_{-} u'=\\lambda_{-}\\begin{pmatrix}0.10\\\\ -0.035078\\ldots\\\\ 0\\\\ 0\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.0314922\\ldots\\\\\n-0.0110468\\ldots\\\\\n0\\\\\n0\n\\end{pmatrix}.\n$$\nHence the residual is\n$$\nr'=\\Sigma c'-\\omega u'=\\begin{pmatrix}0\\\\0\\\\0.00429844\\ldots\\\\0.00105234\\ldots\\end{pmatrix}.\n$$\nUsing the diagonal preconditioner $D=\\mathrm{diag}(0.34,\\,0.62,\\,0.48,\\,0.70)$, form $t$ with components\n$$\nt_i=\\frac{r'_i}{D_{ii}-\\omega},\\quad i\\in\\{1,2,3,4\\}.\n$$\nSince $r'_1=r'_2=0$, we obtain $t_1=t_2=0$. For the remaining components,\n$$\nD_{33}-\\omega=0.48-0.314922\\ldots=0.165078\\ldots,\\quad\nD_{44}-\\omega=0.70-0.314922\\ldots=0.385078\\ldots,\n$$\nso\n$$\nt_3=\\frac{0.00429844\\ldots}{0.165078\\ldots}=0.026033\\ldots,\\quad\nt_4=\\frac{0.00105234\\ldots}{0.385078\\ldots}=0.002732\\ldots.\n$$\nThus\n$$\nt=\\begin{pmatrix}0\\\\0\\\\0.026033\\ldots\\\\0.002732\\ldots\\end{pmatrix}.\n$$\n\nStep $3$: Orthonormalize $t$ against the current subspace and normalize. Since $v_1$ and $v_2$ are the first two standard basis vectors, $t$ is already orthogonal to them, so orthogonalization leaves $t$ unchanged. Normalize $t$ to obtain the improved trial vector $w$:\n$$\n\\|t\\|=\\sqrt{(0.026033\\ldots)^{2}+(0.002732\\ldots)^{2}}=0.026191\\ldots,\n$$\n$$\nw=\\frac{t}{\\|t\\|}=\\begin{pmatrix}0\\\\0\\\\0.99396\\ldots\\\\0.10430\\ldots\\end{pmatrix}.\n$$\n\nThe requested approximate excitation energy is the Rayleigh–Ritz value $\\omega=\\lambda_{-}=0.314922\\ldots$ Hartree. Rounding to four significant figures gives $0.3149$ Hartree.", "answer": "$$\\boxed{0.3149}$$", "id": "2772714"}]}