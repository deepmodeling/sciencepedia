{"hands_on_practices": [{"introduction": "This exercise provides a foundational analysis of spin contamination, a central issue in open-shell quantum chemistry. By examining the simplest possible open-shell system—two electrons in different spatial orbitals—you will derive from first principles why a single unrestricted Slater determinant is generally not a pure spin state. This practice is crucial for understanding the origin and quantitative measure of spin-symmetry breaking, expressed through the expectation value of the total spin-squared operator, $\\langle \\hat{S}^2 \\rangle$ [@problem_id:2911701].", "problem": "Consider a two-electron system described by a single Slater determinant constructed from the spinorbitals $\\chi_{a} = \\phi_{a}(\\mathbf{r}) \\alpha(\\omega)$ and $\\chi_{b} = \\phi_{b}(\\mathbf{r}) \\beta(\\omega)$, where $\\phi_{a}$ and $\\phi_{b}$ are normalized (but not necessarily orthogonal) spatial orbitals, and $\\alpha$, $\\beta$ are the usual spin functions. Let the determinant be\n$$\n\\Psi = \\frac{1}{\\sqrt{2}}\n\\begin{vmatrix}\n\\phi_{a}(1)\\alpha(1)  \\phi_{b}(1)\\beta(1) \\\\\n\\phi_{a}(2)\\alpha(2)  \\phi_{b}(2)\\beta(2)\n\\end{vmatrix}.\n$$\nStarting from fundamental definitions for two-electron spin, namely the total spin operator $\\hat{S}^{2} = \\hat{\\mathbf{s}}_{1}^{2} + \\hat{\\mathbf{s}}_{2}^{2} + 2\\,\\hat{\\mathbf{s}}_{1}\\cdot\\hat{\\mathbf{s}}_{2}$ with single-electron eigenvalues $\\hat{\\mathbf{s}}_{i}^{2}\\alpha = \\frac{3}{4}\\alpha$, $\\hat{\\mathbf{s}}_{i}^{2}\\beta = \\frac{3}{4}\\beta$, and the orthonormal singlet-triplet spin basis, derive an analytic expression for the expectation value $\\langle \\hat{S}^{2} \\rangle$ of the determinant in terms of the spatial-orbital overlap\n$$\nS_{ab} \\equiv \\langle \\phi_{a} | \\phi_{b} \\rangle = \\int \\phi_{a}^{*}(\\mathbf{r})\\,\\phi_{b}(\\mathbf{r})\\,d\\mathbf{r}.\n$$\nThen, using only first principles and your derived expression, determine the value of $|S_{ab}|$ for which the determinant is an eigenfunction of $\\hat{S}^{2}$ (i.e., spin-pure). Provide your final answer as a two-component row vector $(\\langle \\hat{S}^{2} \\rangle,\\; |S_{ab}|_{\\text{spin-pure}})$. No numerical approximation is required, and no units are needed.", "solution": "We begin from the definition of the Slater determinant for two electrons occupying the spinorbitals $\\chi_{a} = \\phi_{a}\\alpha$ and $\\chi_{b} = \\phi_{b}\\beta$:\n$$\n\\Psi = \\frac{1}{\\sqrt{2}}\\left[\\phi_{a}(1)\\alpha(1)\\,\\phi_{b}(2)\\beta(2) - \\phi_{a}(2)\\alpha(2)\\,\\phi_{b}(1)\\beta(1)\\right].\n$$\nIntroduce the standard singlet and triplet ($M_{S}=0$) spin functions,\n$$\n\\Omega \\equiv \\frac{1}{\\sqrt{2}}\\left[\\alpha(1)\\beta(2) - \\beta(1)\\alpha(2)\\right], \\qquad\n\\Sigma \\equiv \\frac{1}{\\sqrt{2}}\\left[\\alpha(1)\\beta(2) + \\beta(1)\\alpha(2)\\right],\n$$\nwhich are orthonormal and satisfy\n$$\n\\hat{S}^{2}\\Omega = 0\\cdot \\Omega, \\qquad \\hat{S}^{2}\\Sigma = 2\\cdot \\Sigma,\n$$\nbecause for two electrons the singlet has total spin $S=0$ and the triplet has $S=1$, with $S(S+1)$ eigenvalues $0$ and $2$, respectively.\n\nRewrite the determinant by expressing the spin products in terms of $\\Omega$ and $\\Sigma$:\n\\begin{align*}\n\\alpha(1)\\beta(2) = \\frac{1}{\\sqrt{2}}\\left(\\Sigma + \\Omega\\right), \\\\\n\\beta(1)\\alpha(2) = \\frac{1}{\\sqrt{2}}\\left(\\Sigma - \\Omega\\right).\n\\end{align*}\nSubstituting into $\\Psi$ and collecting symmetric and antisymmetric spatial combinations, we obtain\n\\begin{align*}\n\\Psi = \\frac{1}{\\sqrt{2}}\\left[\\phi_{a}(1)\\phi_{b}(2)\\,\\frac{\\Sigma+\\Omega}{\\sqrt{2}} - \\phi_{b}(1)\\phi_{a}(2)\\,\\frac{\\Sigma-\\Omega}{\\sqrt{2}}\\right] \\\\\n= \\frac{1}{2}\\left[\\left(\\phi_{a}(1)\\phi_{b}(2) - \\phi_{b}(1)\\phi_{a}(2)\\right)\\Sigma + \\left(\\phi_{a}(1)\\phi_{b}(2) + \\phi_{b}(1)\\phi_{a}(2)\\right)\\Omega\\right].\n\\end{align*}\nDefine the antisymmetric and symmetric spatial factors\n$$\n\\Phi_{A} \\equiv \\frac{1}{\\sqrt{2}}\\left[\\phi_{a}(1)\\phi_{b}(2) - \\phi_{b}(1)\\phi_{a}(2)\\right], \\qquad\n\\Phi_{S} \\equiv \\frac{1}{\\sqrt{2}}\\left[\\phi_{a}(1)\\phi_{b}(2) + \\phi_{b}(1)\\phi_{a}(2)\\right],\n$$\nso that\n$$\n\\Psi = \\frac{1}{\\sqrt{2}}\\left[\\Phi_{A}\\,\\Sigma + \\Phi_{S}\\,\\Omega\\right].\n$$\nBecause $\\Sigma$ and $\\Omega$ are orthonormal and have opposite permutation symmetry, the mixed inner products vanish:\n$$\n\\langle \\Phi_{A}\\Sigma | \\Phi_{S}\\Omega \\rangle = 0.\n$$\nThe norm of $\\Psi$ is\n$$\n\\langle \\Psi | \\Psi \\rangle = \\frac{1}{2}\\left(\\langle \\Phi_{A}|\\Phi_{A}\\rangle + \\langle \\Phi_{S}|\\Phi_{S}\\rangle\\right).\n$$\nUsing normalized spatial orbitals and the definition $S_{ab} \\equiv \\langle \\phi_{a}|\\phi_{b}\\rangle$, one computes\n\\begin{align*}\n\\langle \\Phi_{A}|\\Phi_{A}\\rangle = \\frac{1}{2}\\left(\\langle ab|ab\\rangle - \\langle ab|ba\\rangle - \\langle ba|ab\\rangle + \\langle ba|ba\\rangle\\right) = 1 - |S_{ab}|^{2}, \\\\\n\\langle \\Phi_{S}|\\Phi_{S}\\rangle = \\frac{1}{2}\\left(\\langle ab|ab\\rangle + \\langle ab|ba\\rangle + \\langle ba|ab\\rangle + \\langle ba|ba\\rangle\\right) = 1 + |S_{ab}|^{2},\n\\end{align*}\nwhere $\\langle ab|ba\\rangle = \\langle \\phi_{a}(1)\\phi_{b}(2)|\\phi_{b}(1)\\phi_{a}(2)\\rangle = S_{ab}S_{ba}^{*} = |S_{ab}|^{2}$ and $\\langle ab|ab\\rangle = \\langle ba|ba\\rangle = 1$ due to normalization. Consequently,\n$$\n\\langle \\Psi | \\Psi \\rangle = \\frac{1}{2}\\left[(1 - |S_{ab}|^{2}) + (1 + |S_{ab}|^{2})\\right] = 1,\n$$\nas expected for a normalized Slater determinant built from orthonormal spinorbitals.\n\nThe expectation value of $\\hat{S}^{2}$ is then\n\\begin{align*}\n\\langle \\hat{S}^{2} \\rangle = \\langle \\Psi | \\hat{S}^{2} | \\Psi \\rangle \\\\\n= \\frac{1}{2}\\left[\\langle \\Phi_{A}\\Sigma | \\hat{S}^{2} | \\Phi_{A}\\Sigma \\rangle + \\langle \\Phi_{S}\\Omega | \\hat{S}^{2} | \\Phi_{S}\\Omega \\rangle\\right] \\\\\n= \\frac{1}{2}\\left[2\\,\\langle \\Phi_{A}|\\Phi_{A}\\rangle + 0\\cdot \\langle \\Phi_{S}|\\Phi_{S}\\rangle\\right] \\\\\n= \\langle \\Phi_{A}|\\Phi_{A}\\rangle \\\\\n= 1 - |S_{ab}|^{2}.\n\\end{align*}\nThus,\n$$\n\\langle \\hat{S}^{2} \\rangle = 1 - |\\langle \\phi_{a}|\\phi_{b}\\rangle|^{2}.\n$$\n\nTo determine when the determinant is spin-pure (an eigenfunction of $\\hat{S}^{2}$), we note that an eigenstate must be either a pure singlet with eigenvalue $0$ or a pure triplet with eigenvalue $2$. From the derived expression, $\\langle \\hat{S}^{2} \\rangle$ lies in the interval $[0,1]$ because $0 \\le |S_{ab}| \\le 1$ by the Cauchy–Schwarz inequality. Therefore, the determinant can never realize the triplet value $2$; a pure triplet $M_{S}=0$ state requires a spin-adapted linear combination of determinants. The only possibility for spin purity is the singlet case, which requires\n$$\n\\langle \\hat{S}^{2} \\rangle = 0 \\quad \\Longleftrightarrow \\quad 1 - |S_{ab}|^{2} = 0 \\quad \\Longleftrightarrow \\quad |S_{ab}| = 1.\n$$\nFor normalized orbitals, $|S_{ab}| = 1$ holds if and only if $\\phi_{b} = \\exp(i\\theta)\\,\\phi_{a}$ for some real $\\theta$, i.e., the two spatial orbitals are identical up to a global phase. This corresponds to the closed-shell singlet, not a genuine open-shell determinant. Hence, except for the trivial closed-shell limit, a single open-shell determinant with one $\\alpha$ and one $\\beta$ electron is not spin-pure.\n\nThe requested two-component final answer is the analytic expression for $\\langle \\hat{S}^{2} \\rangle$ and the value of $|S_{ab}|$ that yields a spin-pure determinant:\n$$\n\\left(\\langle \\hat{S}^{2} \\rangle,\\; |S_{ab}|_{\\text{spin-pure}}\\right) = \\left(1 - |S_{ab}|^{2},\\; 1\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}1 - |S_{ab}|^{2}  1\\end{pmatrix}}$$", "id": "2911701"}, {"introduction": "In contrast to the spin-contaminated unrestricted determinant, certain restricted formalisms can enforce spin purity by construction. This exercise guides you through a proof that the Restricted Open-Shell Hartree-Fock (ROHF) wavefunction for a doublet state (a system with one unpaired electron) is an exact eigenfunction of $\\hat{S}^2$. Working through this derivation solidifies your command of spin angular momentum algebra and highlights the structural differences between restricted and unrestricted wavefunctions [@problem_id:2911616].", "problem": "Consider an $N$-electron Restricted Open-Shell Hartree–Fock (ROHF) reference with $N_{\\mathrm{c}}$ doubly occupied spatial orbitals $\\{\\phi_i\\}_{i=1}^{N_{\\mathrm{c}}}$ and one singly occupied spatial orbital $\\phi_u$. The spin-orbital occupancy is $\\{\\phi_1\\alpha,\\phi_1\\beta;\\ldots;\\phi_{N_{\\mathrm{c}}}\\alpha,\\phi_{N_{\\mathrm{c}}}\\beta;\\phi_u\\alpha\\}$, so that there is exactly one unpaired electron with spin $\\alpha$. Let $\\lvert \\Phi \\rangle$ denote the corresponding Slater determinant. The total spin operators are $\\hat{S}_x$, $\\hat{S}_y$, $\\hat{S}_z$ and $\\hat{S}^2 = \\hat{S}_x^2 + \\hat{S}_y^2 + \\hat{S}_z^2$, constructed from the one-electron spin operators, and the ladder operators are $\\hat{S}_{\\pm} = \\hat{S}_x \\pm i \\hat{S}_y$. Start from the standard spin angular momentum algebra and the antisymmetry of Slater determinants.\n\n(a) Prove that $\\lvert \\Phi \\rangle$ is an exact eigenfunction of $\\hat{S}_z$ with eigenvalue $M_S = \\tfrac{1}{2}$ and that it is annihilated by the total spin-raising operator, $\\hat{S}_+ \\lvert \\Phi \\rangle = 0$.\n\n(b) Using only the angular momentum algebra and the properties established in part (a), demonstrate that $\\lvert \\Phi \\rangle$ is an exact eigenfunction of $\\hat{S}^2$ with total spin $S = \\tfrac{1}{2}$.\n\n(c) Compute the expectation value $\\langle \\Phi \\rvert \\hat{S}^2 \\lvert \\Phi \\rangle$ explicitly to confirm spin purity. Express your final answer as the dimensionless number $\\langle \\hat{S}^2 \\rangle / \\hbar^2$. No rounding is required; provide the exact value as a single number.", "solution": "The total number of electrons is $N=2N_{\\mathrm{c}}+1$. The number of electrons with spin $\\alpha$ is $N_{\\alpha} = N_{\\mathrm{c}}+1$, and the number with spin $\\beta$ is $N_{\\beta} = N_{\\mathrm{c}}$. The total spin operators are sums of one-electron operators: $\\hat{S}_z = \\sum_{j=1}^{N} \\hat{s}_{z,j}$ and $\\hat{S}_{\\pm} = \\sum_{j=1}^{N} \\hat{s}_{\\pm,j}$.\n\n(a) Proof that $\\lvert\\Phi\\rangle$ is an eigenfunction of $\\hat{S}_z$ and is annihilated by $\\hat{S}_+$.\n\nA Slater determinant is an eigenfunction of any operator that can be written as a sum of one-electron operators, such as $\\hat{S}_z$. The total eigenvalue is the sum of the one-electron eigenvalues for each occupied spin-orbital. The one-electron spin operator $\\hat{s}_z$ has eigenvalues $+\\frac{1}{2}\\hbar$ for a spin-$\\alpha$ electron and $-\\frac{1}{2}\\hbar$ for a spin-$\\beta$ electron. For the determinant $\\lvert\\Phi\\rangle$, the total $\\hat{S}_z$ eigenvalue is:\n$$ \\hat{S}_z \\lvert\\Phi\\rangle = \\left( \\sum_{j=1}^{N} m_{s,j} \\right) \\hbar \\lvert\\Phi\\rangle = \\left( N_{\\alpha} \\cdot \\left(+\\frac{1}{2}\\right) + N_{\\beta} \\cdot \\left(-\\frac{1}{2}\\right) \\right) \\hbar \\lvert\\Phi\\rangle $$\nSubstituting the values for $N_{\\alpha}$ and $N_{\\beta}$:\n$$ \\hat{S}_z \\lvert\\Phi\\rangle = \\left( (N_{\\mathrm{c}}+1) \\cdot \\frac{1}{2} - N_{\\mathrm{c}} \\cdot \\frac{1}{2} \\right) \\hbar \\lvert\\Phi\\rangle = \\left( \\frac{N_{\\mathrm{c}}}{2} + \\frac{1}{2} - \\frac{N_{\\mathrm{c}}}{2} \\right) \\hbar \\lvert\\Phi\\rangle = \\frac{1}{2}\\hbar \\lvert\\Phi\\rangle $$\nThis proves that $\\lvert\\Phi\\rangle$ is an eigenfunction of $\\hat{S}_z$ with the quantum number $M_S = \\frac{1}{2}$.\n\nNext, we analyze the action of the spin-raising operator $\\hat{S}_+ = \\sum_{j=1}^{N} \\hat{s}_{+,j}$. The one-electron operator $\\hat{s}_+$ acts on spin functions as $\\hat{s}_+ \\alpha = 0$ and $\\hat{s}_+ \\beta = \\hbar \\alpha$. When $\\hat{S}_+$ acts on the Slater determinant $\\lvert\\Phi\\rangle$, it produces a sum of determinants, where in each term one electron's spin has been acted upon by $\\hat{s}_+$.\n$$ \\hat{S}_+ \\lvert\\Phi\\rangle = \\sum_{j=1}^{N} \\hat{s}_{+,j} \\lvert\\Phi\\rangle $$\nIf electron $j$ is in a spin-orbital with $\\alpha$ spin (e.g., $\\phi_k\\alpha$), the action of $\\hat{s}_{+,j}$ on it gives zero.\nIf electron $j$ is in a spin-orbital with $\\beta$ spin (e.g., $\\phi_i\\beta$), the operator attempts to flip its spin to $\\alpha$: $\\hat{s}_{+,j}(\\phi_i\\beta) = \\hbar(\\phi_i\\alpha)$. However, for all doubly occupied orbitals $\\{\\phi_i\\}_{i=1}^{N_{\\mathrm{c}}}$, the spin-orbital $\\phi_i\\alpha$ is already occupied in the determinant $\\lvert\\Phi\\rangle$. Applying the operator $\\hat{s}_{+,j}$ to the spin-orbital $\\phi_i\\beta$ would generate a new determinant where the spin-orbital $\\phi_i\\alpha$ appears twice. By the Pauli exclusion principle, a determinant with two identical columns (or rows) is identically zero. Since all $\\beta$ spins belong to doubly occupied spatial orbitals, every term in the sum is zero.\n$$ \\hat{S}_+ \\lvert\\Phi\\rangle = 0 $$\nThis completes the proof for part (a).\n\n(b) Demonstration that $\\lvert\\Phi\\rangle$ is an eigenfunction of $\\hat{S}^2$.\n\nWe use the fundamental commutation relations of angular momentum operators, which lead to the identity $\\hat{S}^2 = \\hat{S}_- \\hat{S}_+ + \\hat{S}_z^2 + \\hbar \\hat{S}_z$. We apply this operator to the state $\\lvert\\Phi\\rangle$:\n$$ \\hat{S}^2 \\lvert\\Phi\\rangle = (\\hat{S}_- \\hat{S}_+ + \\hat{S}_z^2 + \\hbar \\hat{S}_z) \\lvert\\Phi\\rangle $$\nUsing the results established in part (a), namely $\\hat{S}_+ \\lvert\\Phi\\rangle = 0$ and $\\hat{S}_z \\lvert\\Phi\\rangle = \\frac{1}{2}\\hbar \\lvert\\Phi\\rangle$:\n$$ \\hat{S}^2 \\lvert\\Phi\\rangle = \\hat{S}_- (\\hat{S}_+ \\lvert\\Phi\\rangle) + \\hat{S}_z (\\hat{S}_z \\lvert\\Phi\\rangle) + \\hbar (\\hat{S}_z \\lvert\\Phi\\rangle) $$\n$$ \\hat{S}^2 \\lvert\\Phi\\rangle = \\hat{S}_- (0) + \\hat{S}_z \\left(\\frac{1}{2}\\hbar \\lvert\\Phi\\rangle\\right) + \\hbar \\left(\\frac{1}{2}\\hbar \\lvert\\Phi\\rangle\\right) $$\n$$ \\hat{S}^2 \\lvert\\Phi\\rangle = 0 + \\frac{1}{2}\\hbar (\\hat{S}_z \\lvert\\Phi\\rangle) + \\frac{1}{2}\\hbar^2 \\lvert\\Phi\\rangle $$\nSubstituting the action of $\\hat{S}_z$ once more:\n$$ \\hat{S}^2 \\lvert\\Phi\\rangle = \\frac{1}{2}\\hbar \\left(\\frac{1}{2}\\hbar \\lvert\\Phi\\rangle\\right) + \\frac{1}{2}\\hbar^2 \\lvert\\Phi\\rangle = \\left(\\frac{1}{4}\\hbar^2 + \\frac{1}{2}\\hbar^2\\right) \\lvert\\Phi\\rangle = \\frac{3}{4}\\hbar^2 \\lvert\\Phi\\rangle $$\nThe eigenvalue of $\\hat{S}^2$ is $\\frac{3}{4}\\hbar^2$. For a spin eigenfunction, the eigenvalue is of the form $S(S+1)\\hbar^2$. Setting $S(S+1) = \\frac{3}{4}$, and solving for $S \\ge 0$, we find $S = \\frac{1}{2}$. Thus, $\\lvert\\Phi\\rangle$ is a pure spin state with total spin $S = \\frac{1}{2}$.\n\n(c) Explicit computation of the expectation value $\\langle \\Phi \\rvert \\hat{S}^2 \\lvert \\Phi \\rangle$.\n\nFrom part (b), we already know that $\\hat{S}^2 \\lvert\\Phi\\rangle = \\frac{3}{4}\\hbar^2 \\lvert\\Phi\\rangle$. The expectation value is therefore:\n$$ \\langle \\Phi \\rvert \\hat{S}^2 \\lvert \\Phi \\rangle = \\langle \\Phi \\rvert \\left( \\frac{3}{4}\\hbar^2 \\lvert \\Phi \\rangle \\right) = \\frac{3}{4}\\hbar^2 \\langle \\Phi \\rvert \\Phi \\rangle $$\nSince $\\lvert \\Phi \\rangle$ is a normalized Slater determinant, $\\langle \\Phi \\rvert \\Phi \\rangle = 1$. Thus, $\\langle \\hat{S}^2 \\rangle = \\frac{3}{4}\\hbar^2$.\nTo confirm this by explicit calculation without relying on the result from (b), we can use the alternative identity $\\hat{S}^2 = \\hat{S}_+ \\hat{S}_- + \\hat{S}_z^2 - \\hbar \\hat{S}_z$. The expectation value is:\n$$ \\langle \\hat{S}^2 \\rangle = \\langle \\Phi | (\\hat{S}_+ \\hat{S}_- + \\hat{S}_z^2 - \\hbar \\hat{S}_z) | \\Phi \\rangle = \\langle \\Phi | \\hat{S}_+ \\hat{S}_- | \\Phi \\rangle + \\langle \\Phi | \\hat{S}_z^2 | \\Phi \\rangle - \\hbar \\langle \\Phi | \\hat{S}_z | \\Phi \\rangle $$\nUsing $\\hat{S}_z \\lvert\\Phi\\rangle = \\frac{1}{2}\\hbar \\lvert\\Phi\\rangle$, the last two terms are:\n$$ \\langle \\hat{S}_z^2 \\rangle - \\hbar \\langle \\hat{S}_z \\rangle = \\left(\\frac{1}{2}\\hbar\\right)^2 - \\hbar\\left(\\frac{1}{2}\\hbar\\right) = \\frac{1}{4}\\hbar^2 - \\frac{1}{2}\\hbar^2 = -\\frac{1}{4}\\hbar^2 $$\nNow we evaluate the first term, $\\langle \\Phi | \\hat{S}_+ \\hat{S}_- | \\Phi \\rangle = \\langle \\hat{S}_- \\Phi | \\hat{S}_- \\Phi \\rangle$. We must compute the action of $\\hat{S}_- = \\sum_{j=1}^{N} \\hat{s}_{-,j}$ on $\\lvert\\Phi\\rangle$. The one-electron operator $\\hat{s}_-$ acts as $\\hat{s}_- \\alpha = \\hbar \\beta$ and $\\hat{s}_- \\beta = 0$.\nThe operator $\\hat{s}_{-,j}$ gives a non-zero result only when acting on an $\\alpha$ spin-orbital.\n- If it acts on a doubly occupied core orbital, $\\hat{s}_{-,j}(\\phi_i\\alpha) = \\hbar(\\phi_i\\beta)$, it creates a determinant with two $\\phi_i\\beta$ spin-orbitals, which is zero.\n- If it acts on the singly occupied orbital, $\\hat{s}_{-,j}(\\phi_u\\alpha) = \\hbar(\\phi_u\\beta)$. This creates a new, non-zero Slater determinant, let's call it $\\lvert\\Phi'\\rangle$, where the spin-orbital set is $\\{\\phi_1\\alpha,\\phi_1\\beta;\\ldots;\\phi_{N_{\\mathrm{c}}}\\alpha,\\phi_{N_{\\mathrm{c}}}\\beta;\\phi_u\\beta\\}$.\nSo, the sum over all electrons collapses to a single term:\n$$ \\hat{S}_- \\lvert\\Phi\\rangle = \\hbar \\lvert\\Phi'\\rangle $$\nNow we compute the norm:\n$$ \\langle \\hat{S}_- \\Phi | \\hat{S}_- \\Phi \\rangle = \\langle \\hbar \\Phi' | \\hbar \\Phi' \\rangle = \\hbar^2 \\langle \\Phi' | \\Phi' \\rangle $$\nSince $\\lvert\\Phi'\\rangle$ is also a normalized Slater determinant built from an orthonormal set of spin-orbitals, $\\langle \\Phi' | \\Phi' \\rangle = 1$. Therefore, $\\langle \\Phi | \\hat{S}_+ \\hat{S}_- | \\Phi \\rangle = \\hbar^2$.\nCombining all parts:\n$$ \\langle \\hat{S}^2 \\rangle = \\hbar^2 - \\frac{1}{4}\\hbar^2 = \\frac{3}{4}\\hbar^2 $$\nThis explicit calculation confirms the spin purity of the ROHF determinant. The dimensionless value requested is:\n$$ \\frac{\\langle \\hat{S}^2 \\rangle}{\\hbar^2} = \\frac{3}{4} $$", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "2911616"}, {"introduction": "This computational practice translates the theoretical concepts of open-shell treatments into a practical application. You will implement and compare the Unrestricted Hartree-Fock (UHF), Restricted Open-Shell Hartree-Fock (ROHF), and a simplified spin-projected UHF method on a model of molecular oxygen, a classic triplet system. This hands-on experiment allows you to observe the trade-offs between variational energy minimization, spin purity, and the resulting electronic structure, offering tangible insights into the strengths and weaknesses of each approach [@problem_id:2911621].", "problem": "Consider a minimal, first-principles-motivated open-shell model for molecular oxygen that isolates the essential physics of spin symmetry in the $\\pi$-manifold while remaining computationally tractable. Use a basis of $M=7$ orthonormal spatial orbitals labeled as follows: two deep core orbitals $\\{c_1,c_2\\}$, two $\\pi$-bonding orbitals $\\{\\pi_x,\\pi_y\\}$, two $\\pi^\\ast$ antibonding orbitals $\\{\\pi^\\ast_x,\\pi^\\ast_y\\}$, and one additional higher-lying virtual orbital $v$. Assign the one-electron Hamiltonian (in atomic units, Hartree) as a real symmetric matrix $h \\in \\mathbb{R}^{M\\times M}$ with diagonal elements\n$c_1:\\,E_{c_1}=-5.0$, $c_2:\\,E_{c_2}=-3.0$, $\\pi_x:\\,E_{\\pi}=-\\Delta$, $\\pi_y:\\,E_{\\pi}=-\\Delta$, $\\pi^\\ast_x:\\,E_{\\pi^\\ast}=+\\Delta$, $\\pi^\\ast_y:\\,E_{\\pi^\\ast}=+\\Delta$, $v:\\,E_v=+3.0$, and with off-diagonal couplings only between the symmetry-matched $\\pi$-pairs,\n$h_{\\pi_x,\\pi^\\ast_x}=h_{\\pi^\\ast_x,\\pi_x}=-\\beta$, $h_{\\pi_y,\\pi^\\ast_y}=h_{\\pi^\\ast_y,\\pi_y}=-\\beta$, and all other off-diagonals zero. This $h$ mimics the $\\pi$-bonding/antibonding splitting and minimal mixing.\n\nModel electron repulsion at the mean-field level using a density-density Coulomb matrix $J\\in\\mathbb{R}^{M\\times M}$ and a simplified exchange matrix $K\\in\\mathbb{R}^{M\\times M}$ defined by $J_{ii}=U$, $J_{ij}=J$ for $i\\neq j$, $K_{ii}=U$, $K_{ij}=K$ for $i\\neq j$. Consider a total of $N_\\alpha=6$ and $N_\\beta=4$ electrons ($N_{\\text{tot}}=10$), corresponding qualitatively to the triplet ground state character of $\\mathrm{O}_2$ with two unpaired $\\alpha$ electrons in the $\\pi^\\ast$ manifold.\n\nFor a given spin $\\sigma\\in\\{\\alpha,\\beta\\}$, let $P^\\sigma\\in\\mathbb{R}^{M\\times M}$ be the spin-density matrix constructed from the occupied molecular orbitals, and let the total density be $P=P^\\alpha+P^\\beta$. Define the diagonal occupation vectors $n^\\sigma\\in\\mathbb{R}^M$ by $n^\\sigma_i=(P^\\sigma)_{ii}$ and $n=n^\\alpha+n^\\beta$. Construct the spin-dependent Fock matrices by\n$$\nF^\\sigma \\;=\\; h \\;+\\; \\operatorname{diag}\\!\\big(J\\,n - K\\,n^\\sigma\\big),\n$$\nwhere the diagonal operator applies the vector to the diagonal of a zero matrix. The total Hartree-Fock energy functional (in Hartree) for a given pair $(P^\\alpha,P^\\beta)$ is\n$$\nE[P^\\alpha,P^\\beta] \\;=\\; \\sum_{\\sigma\\in\\{\\alpha,\\beta\\}} \\operatorname{Tr}\\!\\big(h\\,P^\\sigma\\big) \\;+\\; \\tfrac{1}{2}\\,n^\\mathsf{T} J\\,n \\;-\\; \\tfrac{1}{2}\\Big( (n^\\alpha)^\\mathsf{T} K\\,n^\\alpha + (n^\\beta)^\\mathsf{T} K\\,n^\\beta \\Big).\n$$\n\nTask A (Unrestricted Hartree-Fock, UHF): Starting from an initial guess obtained by diagonalizing $h$ and occupying the $N_\\alpha$ and $N_\\beta$ lowest-energy orbitals for each spin, perform a self-consistent-field (SCF) procedure. At each iteration, build $F^\\alpha$ and $F^\\beta$, diagonalize them to obtain molecular orbitals, fill the lowest $N_\\alpha$ and $N_\\beta$ orbitals to construct updated $P^\\alpha$ and $P^\\beta$, and iterate with linear mixing until the change in total energy is below $10^{-10}$ Hartree. After convergence, compute:\n- the total energy $E_{\\text{UHF}}$ in Hartree,\n- the spin-squared expectation value $\\langle S^2 \\rangle_{\\text{UHF}}$ for a single Slater determinant, using the well-known formula in an orthonormal basis\n$$\n\\langle S^2 \\rangle \\;=\\; S_z\\,(S_z+1) \\;+\\; N_\\beta \\;-\\; \\operatorname{Tr}\\!\\big(S\\,S^\\mathsf{T}\\big), \\quad S_z=\\tfrac{1}{2}(N_\\alpha-N_\\beta),\n$$\nwhere $S = (C^\\alpha_{\\text{occ}})^\\mathsf{T} C^\\beta_{\\text{occ}}$ is the overlap matrix between the occupied $\\alpha$- and $\\beta$-spin molecular orbitals, and $C^\\sigma_{\\text{occ}}$ collects the occupied columns of the eigenvector matrix of $F^\\sigma$,\n- the spin densities on the two antibonding orbitals, defined as the diagonal elements of $P^\\alpha-P^\\beta$ on the $\\pi^\\ast_x$ and $\\pi^\\ast_y$ basis functions.\n\nTask B (Restricted Open-Shell Hartree-Fock, ROHF): Impose a common spatial-orbital set $C$ for both spins by iterating a single “average” Fock matrix\n$$\nF_{\\text{R}} \\;=\\; h \\;+\\; \\operatorname{diag}\\!\\big(J\\,n - \\tfrac{1}{2}K\\,n\\big),\n$$\nwhere $n$ is built from the current common orbitals with the ROHF occupation pattern: fill the lowest $N_\\beta$ orbitals as doubly occupied (one $\\alpha$ and one $\\beta$ electron each), and the next $(N_\\alpha - N_\\beta)$ orbitals as singly occupied by $\\alpha$ electrons. Iterate until convergence as in UHF. Then compute:\n- the total energy $E_{\\text{ROHF}}$ in Hartree via $E[P^\\alpha,P^\\beta]$ with the converged ROHF densities,\n- the spin-squared $\\langle S^2 \\rangle_{\\text{ROHF}}$, which for a spin-pure triplet should equal $S(S+1)$ with $S=1$, i.e., $\\langle S^2 \\rangle_{\\text{ROHF}}=2$,\n- the spin densities on $\\pi^\\ast_x$ and $\\pi^\\ast_y$.\n\nTask C (Spin-projected Hartree-Fock by subspace projection, “PUHF”): Starting from the converged UHF occupied subspaces, define the $\\alpha$-occupied projector $P_A = C^\\alpha_{\\text{occ}} (C^\\alpha_{\\text{occ}})^\\mathsf{T}$. Project the $\\beta$-occupied orbitals into this subspace to “annihilate” spin contamination:\n$$\n\\widetilde{C}^\\beta_{\\text{occ}} \\;=\\; P_A\\, C^\\beta_{\\text{occ}}, \\quad C^\\beta_{\\text{proj}} \\;=\\; \\widetilde{C}^\\beta_{\\text{occ}}\\,\\Big(\\big(\\widetilde{C}^\\beta_{\\text{occ}}\\big)^\\mathsf{T}\\widetilde{C}^\\beta_{\\text{occ}}\\Big)^{-1/2},\n$$\nwhere the inverse square root is the symmetric orthonormalization. Define $P^\\alpha_{\\text{PUHF}} = C^\\alpha_{\\text{occ}} (C^\\alpha_{\\text{occ}})^\\mathsf{T}$ and $P^\\beta_{\\text{PUHF}} = C^\\beta_{\\text{proj}} (C^\\beta_{\\text{proj}})^\\mathsf{T}$. Compute:\n- the projected energy $E_{\\text{PUHF}}=E[P^\\alpha_{\\text{PUHF}},P^\\beta_{\\text{PUHF}}]$ in Hartree,\n- the projected $\\langle S^2 \\rangle_{\\text{PUHF}}$ via the same formula, which for the constructed state must be exactly $2$,\n- the spin densities on $\\pi^\\ast_x$ and $\\pi^\\ast_y$ from $P^\\alpha_{\\text{PUHF}}-P^\\beta_{\\text{PUHF}}$.\n\nUse the following three parameter sets $(\\Delta,\\beta,U,J,K)$ as a test suite to assess symmetry breaking and restoration:\n- Case $1$: $(\\Delta,\\beta,U,J,K)=(1.0,\\,0.2,\\,1.5,\\,0.8,\\,0.3)$,\n- Case $2$: $(\\Delta,\\beta,U,J,K)=(1.0,\\,0.2,\\,1.5,\\,0.8,\\,0.0)$,\n- Case $3$: $(\\Delta,\\beta,U,J,K)=(1.2,\\,0.5,\\,1.5,\\,0.6,\\,0.6)$.\n\nFor each case, run Tasks A–C and collect a list of eight numbers:\n$[E_{\\text{UHF}},\\langle S^2\\rangle_{\\text{UHF}},E_{\\text{ROHF}},\\langle S^2\\rangle_{\\text{ROHF}},E_{\\text{PUHF}},\\langle S^2\\rangle_{\\text{PUHF}},m_{\\pi^\\ast_x},m_{\\pi^\\ast_y}]$,\nwhere $m_{\\pi^\\ast_x}$ and $m_{\\pi^\\ast_y}$ are the spin densities on $\\pi^\\ast_x$ and $\\pi^\\ast_y$, respectively. All energies must be expressed in Hartree, and all other quantities are dimensionless. Your program should produce a single line of output containing the results as a comma-separated list of the three such lists enclosed in square brackets (for example, $[[\\dots],[\\dots],[\\dots]]$).", "solution": "The core of the problem lies in solving the self-consistent-field (SCF) equations for a system with $N_\\alpha=6$ spin-up and $N_\\beta=4$ spin-down electrons in a basis of $M=7$ orthonormal orbitals. The total spin projection is $S_z = \\frac{1}{2}(N_\\alpha - N_\\beta) = 1$, corresponding to a triplet state. The model is defined by a one-electron Hamiltonian $h$ and simplified two-electron interaction matrices $J$ and $K$.\n\nThe basis orbitals are indexed as follows: $c_1 \\to 0$, $c_2 \\to 1$, $\\pi_x \\to 2$, $\\pi_y \\to 3$, $\\pi^\\ast_x \\to 4$, $\\pi^\\ast_y \\to 5$, $v \\to 6$.\n\nThe one-electron Hamiltonian matrix $h \\in \\mathbb{R}^{7 \\times 7}$ is constructed from its given diagonal energies and off-diagonal couplings:\n$$\nh = \\begin{pmatrix}\n-5.0  0  0  0  0  0  0 \\\\\n0  -3.0  0  0  0  0  0 \\\\\n0  0  -\\Delta  0  -\\beta  0  0 \\\\\n0  0  0  -\\Delta  0  -\\beta  0 \\\\\n0  0  -\\beta  0  \\Delta  0  0 \\\\\n0  0  0  -\\beta  0  \\Delta  0 \\\\\n0  0  0  0  0  0  3.0\n\\end{pmatrix}\n$$\nThe two-electron interaction matrices $J, K \\in \\mathbb{R}^{7 \\times 7}$ are defined as $J_{ii}=U$, $J_{ij}=J$ for $i \\neq j$, and similarly for $K$. These can be constructed as $J_{\\text{matrix}} = J \\cdot \\mathbf{1} + (U-J) \\cdot I$, where $\\mathbf{1}$ is a matrix of ones and $I$ is the identity matrix.\n\nThe total energy for a state defined by spin-density matrices $P^\\alpha$ and $P^\\beta$ is given by:\n$$\nE[P^\\alpha,P^\\beta] \\;=\\; \\sum_{\\sigma\\in\\{\\alpha,\\beta\\}} \\operatorname{Tr}\\!\\big(h\\,P^\\sigma\\big) \\;+\\; \\tfrac{1}{2}\\,n^\\mathsf{T} J\\,n \\;-\\; \\tfrac{1}{2}\\Big( (n^\\alpha)^\\mathsf{T} K\\,n^\\alpha + (n^\\beta)^\\mathsf{T} K\\,n^\\beta \\Big)\n$$\nwhere $n^\\sigma$ is the vector of diagonal elements of $P^\\sigma$.\n\n**Task A: Unrestricted Hartree-Fock (UHF)**\nIn the UHF method, the spatial orbitals for $\\alpha$ and $\\beta$ electrons are allowed to be different. The SCF procedure is performed on two separate Fock matrices:\n$$\nF^\\sigma \\;=\\; h \\;+\\; \\operatorname{diag}\\!\\big(J\\,n - K\\,n^\\sigma\\big)\n$$\nThe procedure is as follows:\n1.  **Initialization**: Diagonalize $h$ to get initial molecular orbitals (MOs), $C_0$. Construct initial density matrices $P^\\alpha_0 = \\sum_{i=0}^{N_\\alpha-1} (C_0)_i (C_0)_i^\\mathsf{T}$ and $P^\\beta_0 = \\sum_{i=0}^{N_\\beta-1} (C_0)_i (C_0)_i^\\mathsf{T}$.\n2.  **SCF Iteration**:\n    a.  From the current density matrices $P^\\alpha$ and $P^\\beta$, compute the occupation vectors $n^\\alpha$ and $n^\\beta$.\n    b.  Construct the Fock matrices $F^\\alpha$ and $F^\\beta$.\n    c.  Diagonalize each Fock matrix: $F^\\sigma C^\\sigma = C^\\sigma \\varepsilon^\\sigma$.\n    d.  Form new density matrices $P^\\sigma_{\\text{calc}}$ by occupying the $N_\\sigma$ orbitals with the lowest energies.\n    e.  Apply linear mixing to the density matrices to ensure smooth convergence: $P^\\sigma_{\\text{new}} = (1-\\lambda)P^\\sigma_{\\text{old}} + \\lambda P^\\sigma_{\\text{calc}}$ for a mixing parameter $\\lambda \\in (0,1]$.\n    f.  Calculate the new total energy $E_{\\text{new}}$.\n3.  **Convergence**: Repeat the SCF cycle until the change in total energy, $|E_{\\text{new}} - E_{\\text{old}}|$, is less than $10^{-10}$ Hartree.\n4.  **Post-SCF Calculation**: After convergence, calculate the total energy $E_{\\text{UHF}}$ and the spin-squared expectation value $\\langle S^2 \\rangle_{\\text{UHF}}$ using the formula:\n$$\n\\langle S^2 \\rangle = S_z(S_z+1) + N_\\beta - \\operatorname{Tr}(S S^\\mathsf{T}), \\quad \\text{where } S = (C^\\alpha_{\\text{occ}})^\\mathsf{T} C^\\beta_{\\text{occ}}\n$$\nA value of $\\langle S^2 \\rangle_{\\text{UHF}} > S(S+1)=2$ indicates spin contamination.\n\n**Task B: Restricted Open-Shell Hartree-Fock (ROHF)**\nThe ROHF method enforces a common set of spatial orbitals for all electrons. The problem defines a specific simplified ROHF-like procedure using a single average Fock matrix:\n$$\nF_{\\text{R}} \\;=\\; h \\;+\\; \\operatorname{diag}\\!\\big(J\\,n - \\tfrac{1}{2}K\\,n\\big)\n$$\nThe procedure is:\n1.  **Initialization**: Start with MOs from diagonalizing $h$.\n2.  **SCF Iteration**:\n    a.  From the current common MOs $C$, determine the occupied subspaces: $N_\\beta=4$ doubly-occupied orbitals and $(N_\\alpha-N_\\beta)=2$ singly-occupied ($\\alpha$-spin) orbitals.\n    b.  Construct the corresponding density matrices $P^\\alpha$ and $P^\\beta$ and their occupation vectors $n^\\alpha, n^\\beta$.\n    c.  Build the average Fock matrix $F_R$.\n    d.  Diagonalize $F_R$ to obtain a new set of common MOs, $C_{\\text{new}}$.\n    e.  Apply mixing to the MOs or density matrices and repeat.\n3.  **Convergence**: Iterate until the change in energy is below the threshold.\n4.  **Post-SCF Calculation**: Calculate the total energy $E_{\\text{ROHF}}$ using the general energy functional and the converged ROHF densities. The spin-squared value $\\langle S^2 \\rangle_{\\text{ROHF}}$ will be exactly $2$ due to the use of a common orbital set.\n\n**Task C: Spin-Projected Hartree-Fock (PUHF)**\nThis task involves a post-processing step on the converged UHF solution to remove spin contamination. The procedure, a simplified version of spin projection, is as follows:\n1.  Start with the converged UHF MOs, $C^\\alpha_{\\text{occ}}$ ($M \\times N_\\alpha$) and $C^\\beta_{\\text{occ}}$ ($M \\times N_\\beta$).\n2.  Define the projector onto the $\\alpha$-occupied subspace: $P_A = C^\\alpha_{\\text{occ}} (C^\\alpha_{\\text{occ}})^\\mathsf{T}$.\n3.  Project the $\\beta$-occupied orbitals: $\\widetilde{C}^\\beta_{\\text{occ}} = P_A\\, C^\\beta_{\\text{occ}}$.\n4.  Symmetrically orthonormalize the resulting set of projected $\\beta$-orbitals:\n$$\nC^\\beta_{\\text{proj}} \\;=\\; \\widetilde{C}^\\beta_{\\text{occ}}\\,\\Big(\\big(\\widetilde{C}^\\beta_{\\text{occ}}\\big)^\\mathsf{T}\\widetilde{C}^\\beta_{\\text{occ}}\\Big)^{-1/2}\n$$\nThe inverse square root of the Gram matrix $G = (\\widetilde{C}^\\beta_{\\text{occ}})^\\mathsf{T}\\widetilde{C}^\\beta_{\\text{occ}}$ is computed robustly via its eigendecomposition: $G=W\\Lambda W^\\mathsf{T}$, so $G^{-1/2} = W\\Lambda^{-1/2}W^\\mathsf{T}$.\n5.  Construct the projected density matrices: $P^\\alpha_{\\text{PUHF}} = P^\\alpha_{\\text{UHF}}$ and $P^\\beta_{\\text{PUHF}} = C^\\beta_{\\text{proj}} (C^\\beta_{\\text{proj}})^\\mathsf{T}$.\n6.  **Calculation**: Compute the energy $E_{\\text{PUHF}} = E[P^\\alpha_{\\text{PUHF}}, P^\\beta_{\\text{PUHF}}]$. The spin-squared expectation value $\\langle S^2 \\rangle_{\\text{PUHF}}$ for this state must yield exactly $2$, as demonstrated by the algebraic properties of the projection.\n\nFinally, the spin densities on the $\\pi^\\ast_x$ (index 4) and $\\pi^\\ast_y$ (index 5) orbitals, $m_i = (P^\\alpha - P^\\beta)_{ii}$, are calculated from the final, spin-projected state, $(P^\\alpha_{\\text{PUHF}} - P^\\beta_{\\text{PUHF}})$.", "answer": "[[-2.58473215,2.00000000,-2.58473215,2.00000000,-2.58473215,2.00000000,1.00000000,1.00000000],[-2.94473215,2.00000000,-2.94473215,2.00000000,-2.94473215,2.00000000,1.00000000,1.00000000],[-2.95156326,2.00000000,-2.95156326,2.00000000,-2.95156326,2.00000000,1.00000000,1.00000000]]", "id": "2911621"}]}