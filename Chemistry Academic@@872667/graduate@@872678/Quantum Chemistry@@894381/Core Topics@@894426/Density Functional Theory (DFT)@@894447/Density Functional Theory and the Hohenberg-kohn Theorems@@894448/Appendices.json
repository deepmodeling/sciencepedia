{"hands_on_practices": [{"introduction": "The first Hohenberg-Kohn theorem establishes that the ground-state energy is a unique functional of the electron density, $E[n]$. To find the ground-state density, we must minimize this functional, which is the heart of the variational principle in DFT. This exercise delves into the mathematical machinery required for this minimization: the functional derivative. By working through the formal definitions and applying them to a simple model functional, you will gain a rigorous understanding of how the central Euler-Lagrange equations of DFT are derived. [@problem_id:2634146]", "problem": "In Density Functional Theory (DFT), the Hohenberg-Kohn theorems assert that the ground-state energy is a functional of the electron density, and the Kohn-Sham (KS) equations follow from an Euler-Lagrange stationarity condition that involves functional derivatives with respect to the density. Starting from the foundational definitions of functional differentiability on Banach spaces and the basic variational principle, proceed as follows.\n\n- Define the Gâteaux derivative and the Fréchet derivative of a functional $F$ at a point $n$ in a normed linear space $X$, in a direction $h \\in X$.\n- Consider the functional on $X = L^{2}(\\mathbb{R}^{3})$ given by\n$$\nF[n] = \\int_{\\mathbb{R}^{3}} w(\\mathbf{r})\\, n^{2}(\\mathbf{r})\\, d\\mathbf{r},\n$$\nwhere $n \\in L^{2}(\\mathbb{R}^{3})$ is a real-valued density and $w : \\mathbb{R}^{3} \\to \\mathbb{R}$ is a given weight. Using only these definitions and standard properties of $L^{p}$ spaces, compute the functional derivative $\\delta F/\\delta n(\\mathbf{r})$ in the sense that the Gâteaux derivative can be represented as a dual pairing $\\langle \\delta F/\\delta n, h \\rangle = \\int_{\\mathbb{R}^{3}} \\left(\\delta F/\\delta n(\\mathbf{r})\\right) h(\\mathbf{r})\\, d\\mathbf{r}$ for all $h \\in L^{2}(\\mathbb{R}^{3})$. State minimal sufficient assumptions on $w$ under which:\n  1. the Gâteaux derivative exists for all $n \\in L^{2}(\\mathbb{R}^{3})$ and $h \\in L^{2}(\\mathbb{R}^{3})$;\n  2. the Gâteaux derivative coincides with the Fréchet derivative on $L^{2}(\\mathbb{R}^{3})$;\n  3. the functional derivative $\\delta F/\\delta n(\\mathbf{r})$ is represented by a function in $L^{2}(\\mathbb{R}^{3})$.\n- Briefly articulate the Euler-Lagrange stationarity condition for minimizing an energy of the form $E[n] = F[n] + \\int_{\\mathbb{R}^{3}} v_{\\mathrm{ext}}(\\mathbf{r})\\, n(\\mathbf{r})\\, d\\mathbf{r}$ subject to the constraint $\\int_{\\mathbb{R}^{3}} n(\\mathbf{r})\\, d\\mathbf{r} = N$, identifying the role of the Lagrange multiplier $\\mu$. You do not need to solve for $n$ or $\\mu$.\n\nYour final answer should be the closed-form analytic expression for $\\delta F/\\delta n(\\mathbf{r})$. No numerical evaluation is required and no units are necessary. The final answer must be a single expression, not an equation or an inequality.", "solution": "The problem statement is subjected to validation and is found to be valid. It is scientifically grounded in the principles of functional analysis and its application to density functional theory, is well-posed, and is formulated with objective and precise language. All necessary information is provided. No contradictions or fallacies are present. We may proceed with the solution.\n\nThe problem requires a multistep derivation and analysis concerning a functional in the context of Density Functional Theory. We will proceed methodically through each part.\n\nFirst, we define the required derivatives. Let $F: X \\to \\mathbb{R}$ be a functional on a normed linear space $X$.\n\nThe Gâteaux derivative of $F$ at a point $n \\in X$ in the direction of $h \\in X$ is defined as the limit:\n$$\nDF(n; h) = \\lim_{\\epsilon \\to 0} \\frac{F[n + \\epsilon h] - F[n]}{\\epsilon}\n$$\nprovided this limit exists. This is a directional derivative.\n\nThe Fréchet derivative of $F$ at $n \\in X$ is a bounded linear operator $A_n: X \\to \\mathbb{R}$ such that:\n$$\n\\lim_{\\|h\\|_{X} \\to 0} \\frac{|F[n+h] - F[n] - A_n(h)|}{\\|h\\|_{X}} = 0\n$$\nIf such an operator $A_n$ exists, it is unique and is denoted by $F'(n)$. For the Fréchet derivative to exist, the Gâteaux derivative must exist for all directions $h$ and must be a bounded linear operator in $h$, i.e., $DF(n; h) = A_n(h)$.\n\nNext, we consider the specific functional $F[n] = \\int_{\\mathbb{R}^{3}} w(\\mathbf{r})\\, n^{2}(\\mathbf{r})\\, d\\mathbf{r}$ on the space $X = L^{2}(\\mathbb{R}^{3})$. We compute its Gâteaux derivative.\nLet $n, h \\in L^{2}(\\mathbb{R}^{3})$ and $\\epsilon \\in \\mathbb{R}$. We evaluate the functional at $n + \\epsilon h$:\n$$\nF[n + \\epsilon h] = \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) (n(\\mathbf{r}) + \\epsilon h(\\mathbf{r}))^{2} \\, d\\mathbf{r}\n$$\nExpanding the integrand:\n$$\nw(\\mathbf{r}) (n(\\mathbf{r}) + \\epsilon h(\\mathbf{r}))^{2} = w(\\mathbf{r}) \\left( n^{2}(\\mathbf{r}) + 2\\epsilon n(\\mathbf{r}) h(\\mathbf{r}) + \\epsilon^{2} h^{2}(\\mathbf{r}) \\right)\n$$\nAssuming the integrals of each term exist, we can write:\n$$\nF[n + \\epsilon h] = \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) n^{2}(\\mathbf{r}) \\, d\\mathbf{r} + 2\\epsilon \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) n(\\mathbf{r}) h(\\mathbf{r}) \\, d\\mathbf{r} + \\epsilon^{2} \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) h^{2}(\\mathbf{r}) \\, d\\mathbf{r}\n$$\n$$\nF[n + \\epsilon h] = F[n] + 2\\epsilon \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) n(\\mathbf{r}) h(\\mathbf{r}) \\, d\\mathbf{r} + \\epsilon^{2} \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) h^{2}(\\mathbf{r}) \\, d\\mathbf{r}\n$$\nNow we form the difference quotient for the Gâteaux derivative:\n$$\n\\frac{F[n + \\epsilon h] - F[n]}{\\epsilon} = 2 \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) n(\\mathbf{r}) h(\\mathbf{r}) \\, d\\mathbf{r} + \\epsilon \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) h^{2}(\\mathbf{r}) \\, d\\mathbf{r}\n$$\nTaking the limit as $\\epsilon \\to 0$:\n$$\nDF(n; h) = \\lim_{\\epsilon \\to 0} \\left( 2 \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) n(\\mathbf{r}) h(\\mathbf{r}) \\, d\\mathbf{r} + \\epsilon \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) h^{2}(\\mathbf{r}) \\, d\\mathbf{r} \\right) = 2 \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) n(\\mathbf{r}) h(\\mathbf{r}) \\, d\\mathbf{r}\n$$\nThis is the Gâteaux derivative. The problem defines the functional derivative $\\frac{\\delta F}{\\delta n(\\mathbf{r})}$ as the function that represents the Gâteaux derivative via the inner product on $L^{2}(\\mathbb{R}^{3})$:\n$$\nDF(n; h) = \\int_{\\mathbb{R}^{3}} \\frac{\\delta F}{\\delta n(\\mathbf{r})} h(\\mathbf{r}) \\, d\\mathbf{r}\n$$\nBy comparing this form with our result, we identify the functional derivative:\n$$\n\\frac{\\delta F}{\\delta n(\\mathbf{r})} = 2w(\\mathbf{r})n(\\mathbf{r})\n$$\nNow we must determine the minimal sufficient assumptions on the weight function $w(\\mathbf{r})$.\n1. For the Gâteaux derivative to exist for all $n, h \\in L^{2}(\\mathbb{R}^{3})$, the integrals in its derivation must be finite. Specifically, $\\int w(\\mathbf{r}) n(\\mathbf{r}) h(\\mathbf{r}) \\, d\\mathbf{r}$ and $\\int w(\\mathbf{r}) h^{2}(\\mathbf{r}) \\, d\\mathbf{r}$ must converge. By the Cauchy-Schwarz inequality, the product of two $L^{2}$ functions is in $L^{1}$. Thus $n(\\mathbf{r})h(\\mathbf{r}) \\in L^{1}(\\mathbb{R}^{3})$ and $h^{2}(\\mathbf{r}) \\in L^{1}(\\mathbb{R}^{3})$. For the integrals involving $w(\\mathbf{r})$ to converge for all choices of $n, h \\in L^{2}(\\mathbb{R}^{3})$, a sufficient and necessary condition is that $w(\\mathbf{r})$ is an essentially bounded function, i.e., $w \\in L^{\\infty}(\\mathbb{R}^{3})$. If $w \\in L^{\\infty}(\\mathbb{R}^{3})$, then $|\\int wnh \\, d\\mathbf{r}| \\le \\|w\\|_{\\infty} \\int |nh| \\, d\\mathbf{r} \\le \\|w\\|_{\\infty} \\|n\\|_{2} \\|h\\|_{2} < \\infty$.\n\n2. For the Gâteaux derivative to coincide with the Fréchet derivative, we must check the limit condition. The Gâteaux derivative $DF(n; h)$ defines a linear operator in $h$, which we denote $A_n(h)$. The remainder term is $R(h) = F[n+h] - F[n] - A_n(h)$.\n$$\nR(h) = \\int_{\\mathbb{R}^{3}} w(\\mathbf{r})h^{2}(\\mathbf{r}) \\, d\\mathbf{r}\n$$\nWe must show $\\lim_{\\|h\\|_{2} \\to 0} \\frac{|R(h)|}{\\|h\\|_{2}} = 0$.\nIf we assume $w \\in L^{\\infty}(\\mathbb{R}^{3})$, then $|w(\\mathbf{r})| \\le \\|w\\|_{\\infty}$ almost everywhere.\n$$\n|R(h)| = \\left| \\int w(\\mathbf{r}) h^{2}(\\mathbf{r}) \\, d\\mathbf{r} \\right| \\le \\int |w(\\mathbf{r})| h^{2}(\\mathbf{r}) \\, d\\mathbf{r} \\le \\|w\\|_{\\infty} \\int h^{2}(\\mathbf{r}) \\, d\\mathbf{r} = \\|w\\|_{\\infty} \\|h\\|_{2}^{2}\n$$\nTherefore, the ratio is bounded:\n$$\n\\frac{|R(h)|}{\\|h\\|_{2}} \\le \\frac{\\|w\\|_{\\infty} \\|h\\|_{2}^{2}}{\\|h\\|_{2}} = \\|w\\|_{\\infty} \\|h\\|_{2}\n$$\nAs $\\|h\\|_{2} \\to 0$, it follows that $\\|w\\|_{\\infty} \\|h\\|_{2} \\to 0$. Thus, the limit is $0$, and the Fréchet derivative exists and is equal to the Gâteaux derivative. The condition $w \\in L^{\\infty}(\\mathbb{R}^{3})$ is sufficient.\n\n3. For the functional derivative $\\frac{\\delta F}{\\delta n(\\mathbf{r})} = 2w(\\mathbf{r})n(\\mathbf{r})$ to be in $L^{2}(\\mathbb{R}^{3})$ for any $n \\in L^{2}(\\mathbb{R}^{3})$, we require the map $n \\mapsto wn$ to be a bounded operator from $L^{2}$ to $L^{2}$. This is true if and only if $w \\in L^{\\infty}(\\mathbb{R}^{3})$. If $w \\in L^{\\infty}$, then\n$$\n\\left\\| \\frac{\\delta F}{\\delta n} \\right\\|_{2}^{2} = \\int |2w(\\mathbf{r})n(\\mathbf{r})|^{2} \\, d\\mathbf{r} = 4 \\int |w(\\mathbf{r})|^{2} |n(\\mathbf{r})|^{2} \\, d\\mathbf{r} \\le 4\\|w\\|_{\\infty}^{2} \\int |n(\\mathbf{r})|^{2} \\, d\\mathbf{r} = 4\\|w\\|_{\\infty}^{2} \\|n\\|_{2}^{2} < \\infty\n$$\nThus, the single condition $w \\in L^{\\infty}(\\mathbb{R}^{3})$ is sufficient for all three requirements.\n\nFinally, we articulate the Euler-Lagrange stationarity condition for minimizing the energy functional $E[n] = F[n] + \\int_{\\mathbb{R}^{3}} v_{\\mathrm{ext}}(\\mathbf{r})\\, n(\\mathbf{r})\\, d\\mathbf{r}$ subject to the constraint $\\int_{\\mathbb{R}^{3}} n(\\mathbf{r})\\, d\\mathbf{r} = N$.\nThis is a constrained variational problem. We introduce a Lagrange multiplier $\\mu$ to enforce the constraint. We define an auxiliary functional $\\mathcal{L}[n]$:\n$$\n\\mathcal{L}[n] = E[n] - \\mu \\left( \\int_{\\mathbb{R}^{3}} n(\\mathbf{r}) \\, d\\mathbf{r} - N \\right)\n$$\nThe stationarity condition requires that the functional derivative of $\\mathcal{L}[n]$ with respect to $n(\\mathbf{r})$ vanishes for all $\\mathbf{r}$:\n$$\n\\frac{\\delta \\mathcal{L}}{\\delta n(\\mathbf{r})} = 0\n$$\nWe compute the functional derivatives of each term in $\\mathcal{L}[n]$:\n$$\n\\frac{\\delta F}{\\delta n(\\mathbf{r})} = 2w(\\mathbf{r})n(\\mathbf{r})\n$$\n$$\n\\frac{\\delta}{\\delta n(\\mathbf{r})} \\int_{\\mathbb{R}^{3}} v_{\\mathrm{ext}}(\\mathbf{r}') n(\\mathbf{r}') \\, d\\mathbf{r}' = v_{\\mathrm{ext}}(\\mathbf{r})\n$$\n$$\n\\frac{\\delta}{\\delta n(\\mathbf{r})} \\left( -\\mu \\int_{\\mathbb{R}^{3}} n(\\mathbf{r}') \\, d\\mathbf{r}' \\right) = -\\mu\n$$\nThe derivative of the constant term $-\\mu(-N)$ is zero. Combining these results, the Euler-Lagrange equation is:\n$$\n\\frac{\\delta E}{\\delta n(\\mathbf{r})} - \\mu = 2w(\\mathbf{r})n(\\mathbf{r}) + v_{\\mathrm{ext}}(\\mathbf{r}) - \\mu = 0\n$$\nOr, more commonly written as:\n$$\n2w(\\mathbf{r})n(\\mathbf{r}) + v_{\\mathrm{ext}}(\\mathbf{r}) = \\mu\n$$\nThe Lagrange multiplier $\\mu$ is a constant determined by the condition that the resulting density $n(\\mathbf{r})$ integrates to the total number of particles $N$. In the context of quantum mechanics and DFT, $\\mu$ is identified as the chemical potential of the system. It ensures that the variation of the energy is zero only for those density variations that conserve the total particle number.\nThe question asks for the analytical expression for $\\delta F/\\delta n(\\mathbf{r})$, which we have determined to be $2w(\\mathbf{r})n(\\mathbf{r})$.", "answer": "$$\n\\boxed{2w(\\mathbf{r})n(\\mathbf{r})}\n$$", "id": "2634146"}, {"introduction": "An electron cannot interact with itself, yet the classical Hartree energy term in DFT, $E_H[n]$, erroneously includes this spurious self-repulsion. The exact exchange-correlation functional, $E_{xc}[n]$, must therefore precisely cancel this self-interaction energy. This exercise provides a crucial hands-on demonstration of this principle using the simplest possible case: a single electron in a hydrogen atom. By explicitly calculating each energy component, you will verify how the exact functional achieves this perfect cancellation, a property that serves as a fundamental litmus test for all density functionals. [@problem_id:2634155]", "problem": "Consider a single electron moving in the external Coulomb potential of a point nucleus of charge $Z=1$ at the origin. Work in atomic units, so that the Bohr radius is $a_0=1$ and energies are in Hartree. The exact normalized ground-state electron density is spherically symmetric and given by $n(r)=\\frac{1}{\\pi}\\exp(-2r)$.\n\nStarting from first principles of Density Functional Theory (DFT), namely the Hohenberg–Kohn theorems and the Kohn–Sham (KS) construction, take as your fundamental base the definitions of the Hartree energy functional $E_{\\mathrm{H}}[n]$, the Kohn–Sham kinetic energy $T_{s}[n]$ for a single occupied orbital reproducing $n(r)$, and the external potential contribution $\\int v_{\\mathrm{ext}}(\\mathbf{r})\\,n(\\mathbf{r})\\,d^{3}r$ with $v_{\\mathrm{ext}}(\\mathbf{r})=-1/r$. Proceed as follows:\n\n- Compute the Hartree energy $E_{\\mathrm{H}}[n]=\\frac{1}{2}\\int\\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^{3}r\\,d^{3}r'$ exactly for the given $n(r)$. Your derivation must be explicit and self-contained; you may use either the Poisson equation for spherically symmetric densities or the Fourier representation of the Coulomb kernel, but you must show all intermediate steps.\n- Using the exact-exchange property for a one-electron density, demonstrate analytically how the exchange energy $E_{x}[n]$ cancels the self-interaction embodied in $E_{\\mathrm{H}}[n]$, and argue why the correlation energy $E_{c}[n]$ vanishes in this limit.\n- With that cancellation established, evaluate $T_{s}[n]$ and the external potential energy $\\int v_{\\mathrm{ext}}(\\mathbf{r})\\,n(\\mathbf{r})\\,d^{3}r$ exactly for the given $n(r)$ by using the single normalized KS orbital $\\varphi(\\mathbf{r})$ satisfying $|\\varphi(\\mathbf{r})|^{2}=n(\\mathbf{r})$.\n- Combine all pieces to obtain the exact total ground-state energy $E[n]$.\n\nExpress the final total energy in Hartree. Provide your final answer as a single exact number. Do not include units in the final boxed answer.", "solution": "The problem posed is valid, scientifically sound, and well-posed within the framework of Density Functional Theory (DFT). We shall proceed with the derivation as requested. The system is a single electron in the potential of a nucleus with charge $Z=1$, described in atomic units. The exact ground-state electron density is given as $n(r) = \\frac{1}{\\pi}\\exp(-2r)$.\n\nFirst, we compute the Hartree energy functional, $E_{\\mathrm{H}}[n]$, defined as the classical electrostatic self-repulsion energy of the charge density:\n$$E_{\\mathrm{H}}[n] = \\frac{1}{2}\\iint \\frac{n(\\mathbf{r})n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|} d^{3}r d^{3}r'$$\nFor a spherically symmetric density $n(r)$, this is most efficiently computed by first finding the Hartree potential, $v_{\\mathrm{H}}(r) = \\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|} d^{3}r'$. The potential $v_{\\mathrm{H}}(r)$ is the solution to the Poisson equation $\\nabla^2 v_\\text{H}(r) = -4\\pi n(r)$. Given the spherical symmetry, the Laplacian is $\\nabla^2 = \\frac{1}{r^2}\\frac{d}{dr}\\left(r^2\\frac{d}{dr}\\right)$.\nThus, we solve:\n$$\\frac{1}{r^2}\\frac{d}{dr}\\left(r^2\\frac{d v_{\\mathrm{H}}}{dr}\\right) = -4\\pi \\left(\\frac{1}{\\pi}\\exp(-2r)\\right) = -4\\exp(-2r)$$\nIntegrating with respect to $r$ from $0$ to $r'$ yields the electric field multiplied by $-r'^2$:\n$$r'^2 \\frac{d v_{\\mathrm{H}}}{dr'} = -4 \\int_{0}^{r'} s^2 \\exp(-2s) ds$$\nThe integral is solved using integration by parts: $\\int s^2 \\exp(-as) ds = -\\frac{\\exp(-as)}{a^3}(a^2s^2 + 2as + 2)$.\nFor $a=2$, this gives:\n$$r'^2 \\frac{d v_{\\mathrm{H}}}{dr'} = -4 \\left[ -\\frac{\\exp(-2s)}{8}(4s^2 + 4s + 2) \\right]_0^{r'} = -4 \\left( -\\frac{\\exp(-2r')}{8}(4r'^2 + 4r' + 2) + \\frac{2}{8} \\right) = \\frac{1}{2}\\exp(-2r')(4r'^2 + 4r' + 2) - 1 = (2r'^2+2r'+1)\\exp(-2r') - 1$$\nThe electrostatic potential $v_{\\mathrm{H}}(r)$ is found by integrating the negative of the electric field, $E(r) = -\\frac{d v_{\\mathrm{H}}}{dr}$, from $r$ to $\\infty$ to satisfy the boundary condition $v_{\\mathrm{H}}(\\infty)=0$.\n$$v_{\\mathrm{H}}(r) = \\int_{r}^{\\infty} -\\frac{d v_{\\mathrm{H}}}{dr'} dr' = \\int_{r}^{\\infty} \\frac{1}{r'^2}\\left(1 - (2r'^2+2r'+1)\\exp(-2r')\\right) dr'$$\n$$v_{\\mathrm{H}}(r) = \\int_{r}^{\\infty} \\frac{1}{r'^2} dr' - \\int_{r}^{\\infty} \\left(2+\\frac{2}{r'}+\\frac{1}{r'^2}\\right)\\exp(-2r') dr'$$\nThe first integral is $\\left[-\\frac{1}{r'}\\right]_r^\\infty = \\frac{1}{r}$. The second integral has an antiderivative of $-\\left(1+\\frac{1}{r'}\\right)\\exp(-2r')$.\n$$v_{\\mathrm{H}}(r) = \\frac{1}{r} - \\left[ -\\left(1+\\frac{1}{r'}\\right)\\exp(-2r') \\right]_r^\\infty = \\frac{1}{r} - \\left(0 - \\left(-\\left(1+\\frac{1}{r}\\right)\\exp(-2r)\\right)\\right) = \\frac{1}{r} - \\frac{1+r}{r}\\exp(-2r)$$\nNow, we can compute the Hartree energy:\n$$E_{\\mathrm{H}}[n] = \\frac{1}{2} \\int n(r) v_{\\mathrm{H}}(r) d^3r = \\frac{1}{2} \\int_{0}^{\\infty} \\left(\\frac{1}{\\pi}\\exp(-2r)\\right) \\left(\\frac{1}{r} - \\frac{1+r}{r}\\exp(-2r)\\right) 4\\pi r^2 dr$$\n$$E_{\\mathrm{H}}[n] = 2 \\int_{0}^{\\infty} r^2 \\exp(-2r) \\left(\\frac{1}{r} - \\frac{1+r}{r}\\exp(-2r)\\right) dr = 2 \\int_{0}^{\\infty} (r\\exp(-2r) - (r+r^2)\\exp(-4r)) dr$$\nUsing the standard integral $\\int_0^\\infty x^k \\exp(-ax) dx = k!/a^{k+1}$:\n$$E_{\\mathrm{H}}[n] = 2 \\left( \\int_0^\\infty r\\exp(-2r)dr - \\int_0^\\infty r\\exp(-4r)dr - \\int_0^\\infty r^2\\exp(-4r)dr \\right)$$\n$$E_{\\mathrm{H}}[n] = 2 \\left( \\frac{1!}{2^2} - \\frac{1!}{4^2} - \\frac{2!}{4^3} \\right) = 2 \\left( \\frac{1}{4} - \\frac{1}{16} - \\frac{2}{64} \\right) = 2 \\left( \\frac{4}{16} - \\frac{1}{16} - \\frac{1}{32} \\right) = 2 \\left( \\frac{3}{16} - \\frac{1}{32} \\right) = 2 \\left( \\frac{6-1}{32} \\right) = \\frac{5}{16}$$\n\nNext, we address the exchange-correlation functional $E_{\\mathrm{xc}}[n]$. For a one-electron system, the exact ground-state energy is the expectation value of the one-electron Hamiltonian $\\hat{H} = \\hat{T} + \\hat{V}_{\\mathrm{ext}}$, which has no electron-electron interaction term. In the Kohn-Sham formalism, the total energy is $E[n] = T_s[n] + E_{\\mathrm{ext}}[n] + E_{\\mathrm{H}}[n] + E_{\\mathrm{xc}}[n]$. Since $T_s[n]$ and $E_{\\mathrm{ext}}[n]$ are defined to be the kinetic and external potential energies of the non-interacting KS system that reproduces the density $n$, for this one-electron system they are identical to the true kinetic and potential energies. Therefore, for the DFT energy to equal the exact energy, we must have $E_{\\mathrm{H}}[n] + E_{\\mathrm{xc}}[n] = 0$. The exchange-correlation energy is composed of the exchange energy $E_{x}[n]$ and the correlation energy $E_{c}[n]$. The exact exchange energy for a single occupied orbital $\\varphi(\\mathbf{r})$ is given by $E_x[n] = -\\frac{1}{2}\\iint \\frac{|\\varphi(\\mathbf{r}_1)|^2|\\varphi(\\mathbf{r}_2)|^2}{|\\mathbf{r}_1-\\mathbf{r}_2|}d^3r_1 d^3r_2$. Given that $n(\\mathbf{r})=|\\varphi(\\mathbf{r})|^2$, this becomes $E_x[n] = -E_\\text{H}[n]$. This demonstrates that the exchange energy exactly cancels the spurious self-interaction contained in the Hartree energy. Consequently, for the total sum to be zero, the correlation energy $E_{c}[n]$ must be zero. This is consistent with the definition of correlation energy as the difference between the exact energy and the Hartree-Fock energy, which for a one-electron system are identical.\n\nWith $E_{\\mathrm{H}}[n] + E_{x}[n] + E_{c}[n] = 0$, the total energy simplifies to $E[n] = T_s[n] + E_{\\mathrm{ext}}[n]$. We now evaluate these two terms.\nThe single normalized KS orbital $\\varphi(\\mathbf{r})$ that reproduces the density $n(r) = \\frac{1}{\\pi}\\exp(-2r)$ is $\\varphi(r) = \\sqrt{n(r)} = \\frac{1}{\\sqrt{\\pi}}\\exp(-r)$, as the ground state orbital can be chosen to be real and positive.\nThe external potential energy is:\n$$E_{\\mathrm{ext}}[n] = \\int v_{\\mathrm{ext}}(\\mathbf{r}) n(\\mathbf{r}) d^3r = \\int_{0}^{\\infty} \\left(-\\frac{1}{r}\\right) \\left(\\frac{1}{\\pi}\\exp(-2r)\\right) 4\\pi r^2 dr$$\n$$E_{\\mathrm{ext}}[n] = -4 \\int_{0}^{\\infty} r\\exp(-2r) dr = -4 \\left(\\frac{1!}{2^2}\\right) = -4 \\left(\\frac{1}{4}\\right) = -1 \\text{ Hartree}$$\nThe Kohn-Sham kinetic energy is $T_s[n] = \\int \\varphi^*(\\mathbf{r})(-\\frac{1}{2}\\nabla^2)\\varphi(\\mathbf{r}) d^3r$. Using integration by parts (Green's first identity), this is equivalent to:\n$$T_s[n] = \\frac{1}{2} \\int |\\nabla \\varphi(\\mathbf{r})|^2 d^3r$$\nFor our radial orbital, $\\nabla\\varphi(r) = \\frac{d\\varphi}{dr}\\hat{\\mathbf{r}} = -\\frac{1}{\\sqrt{\\pi}}\\exp(-r)\\hat{\\mathbf{r}} = -\\varphi(r)\\hat{\\mathbf{r}}$.\nThus, $|\\nabla \\varphi(r)|^2 = (\\nabla\\varphi) \\cdot (\\nabla\\varphi) = (-\\varphi\\hat{\\mathbf{r}}) \\cdot (-\\varphi\\hat{\\mathbf{r}}) = \\varphi(r)^2 = n(r)$.\n$$T_s[n] = \\frac{1}{2} \\int n(r) d^3r$$\nSince the density is normalized to one electron, $\\int n(r) d^3r = 1$.\n$$T_s[n] = \\frac{1}{2}(1) = \\frac{1}{2} \\text{ Hartree}$$\n\nFinally, we combine the components to obtain the total ground-state energy:\n$$E[n] = T_s[n] + E_{\\mathrm{ext}}[n] = \\frac{1}{2} + (-1) = -\\frac{1}{2} \\text{ Hartree}$$\nThis result matches the known exact energy of the hydrogen atom, as expected.", "answer": "$$\\boxed{-\\frac{1}{2}}$$", "id": "2634155"}, {"introduction": "While the exact functional is free of self-interaction, the approximate functionals used in nearly all practical DFT calculations are not. This lingering self-interaction error leads to significant physical inaccuracies, including the tendency to overly delocalize electrons. This practice explores a key manifestation of this 'delocalization error' by examining the energy of a hydrogen atom with a fractional number of electrons, $N$. You will discover why the energy curve $E(N)$ for an approximate functional is erroneously convex, departing from the correct piecewise-linear behavior, a concept that is critical for understanding the limitations of DFT in describing charge transfer and chemical bonds. [@problem_id:2634165]", "problem": "A hydrogen atom in an external Coulomb potential has one bound electron with exact ground-state energy $E(1) = -\\tfrac{1}{2}$ in atomic units (Hartree). Consider the hydrogenic ground-state density $n_{1}(\\mathbf{r})$ and the ensemble description of a fractional electron number $N \\in [0,1]$ with density $n_{N}(\\mathbf{r}) = N\\,n_{1}(\\mathbf{r})$. The Density Functional Theory (DFT) total-energy functional is\n$$\nE[n] \\;=\\; T_{s}[n] \\;+\\; E_{H}[n] \\;+\\; E_{xc}[n] \\;+\\; \\int v_{\\mathrm{ne}}(\\mathbf{r})\\,n(\\mathbf{r})\\,d\\mathbf{r},\n$$\nwhere $T_{s}[n]$ is the noninteracting kinetic energy, $E_{H}[n]$ is the Hartree energy, and $E_{xc}[n]$ is the exchange-correlation energy. In the one-electron limit, the exact exchange-correlation energy cancels the Hartree energy for any such density scaling, i.e., $E_{xc}^{\\mathrm{exact}}[n_{N}] = -E_{H}[n_{N}]$, which implies exact piecewise linearity of $E(N)$ between $N=0$ and $N=1$.\n\nNow consider an approximate generalized gradient approximation (GGA) for which, on a one-electron density, the exchange energy scales as\n$$\nE_{x}^{\\mathrm{GGA}}[n_{N}] \\;=\\; -\\lambda\\,U_{1}\\,N^{4/3},\n$$\nwhere $U_{1} \\equiv E_{H}[n_{1}] = \\tfrac{5}{16}$ and correlation is negligible on this one-electron density. The parameter $\\lambda \\in (0,1)$ characterizes the incomplete cancellation of self-interaction; for a Perdew–Burke–Ernzerhof (PBE)-like GGA take $\\lambda = 0.90$. Assume $T_{s}[n_{N}]$ and $\\int v_{\\mathrm{ne}}\\,n_{N}$ scale linearly with $N$ due to the ensemble construction.\n\n1) Starting from the definitions above, derive an analytic expression for the deviation \n$$\n\\delta(N) \\;=\\; E^{\\mathrm{GGA}}(N) \\;-\\; L(N),\n$$\nwhere $L(N)$ is the straight-line interpolation between the approximate GGA energies at the endpoints, $L(N) = (1-N)\\,E^{\\mathrm{GGA}}(0) + N\\,E^{\\mathrm{GGA}}(1)$.\n\n2) Using your expression, evaluate $\\delta\\!\\left(\\tfrac{1}{2}\\right)$ for $\\lambda = 0.90$. Express the final result in Hartree and round your answer to four significant figures.\n\nFinally, explain briefly, using the density-scaling behaviors of $E_{H}[n_{N}]$ and $E_{x}^{\\mathrm{GGA}}[n_{N}]$, why the approximate GGA produces a convex $E(N)$ between $N=0$ and $N=1$ for hydrogen in the one-electron limit.", "solution": "The problem requires an analysis of the energy of a hydrogenic system with a fractional number of electrons, $N$, using an approximate generalized gradient approximation (GGA) functional. The tasks are to derive the deviation from linearity, $\\delta(N)$, calculate its value at $N = \\frac{1}{2}$, and explain the convexity of the energy curve $E^{\\mathrm{GGA}}(N)$.\n\nFirst, we establish the expression for the total energy within this GGA, $E^{\\mathrm{GGA}}(N)$, as a function of the fractional electron number $N \\in [0,1]$. The total energy functional is given as:\n$$\nE[n] = T_{s}[n] + E_{H}[n] + E_{xc}[n] + \\int v_{\\mathrm{ne}}(\\mathbf{r})\\,n(\\mathbf{r})\\,d\\mathbf{r}\n$$\nThe problem specifies that the correlation energy is negligible, so $E_{xc}[n] \\approx E_{x}[n]$. The density for a system with $N$ electrons is $n_{N}(\\mathbf{r}) = N\\,n_{1}(\\mathbf{r})$. We must determine the scaling of each energy component with $N$.\n\nThe kinetic energy of noninteracting electrons, $T_{s}[n_{N}]$, and the nuclear-electron attraction energy, $V_{\\mathrm{ne}}[n_{N}] = \\int v_{\\mathrm{ne}}(\\mathbf{r})\\,n_{N}(\\mathbf{r})\\,d\\mathbf{r}$, are stated to scale linearly with $N$. This is consistent with the ensemble definition of the density. Let $T_{s}[n_{1}]$ and $V_{\\mathrm{ne}}[n_{1}]$ be the values for the one-electron system ($N=1$). Then:\n$$\nT_{s}[n_{N}] = N\\,T_{s}[n_{1}]\n$$\n$$\nV_{\\mathrm{ne}}[n_{N}] = N\\,V_{\\mathrm{ne}}[n_{1}]\n$$\nLet us define a constant $K_{1} = T_{s}[n_{1}] + V_{\\mathrm{ne}}[n_{1}]$, which comprises all terms that scale linearly with $N$.\n\nThe Hartree energy, $E_{H}[n]$, is quadratic in the density. Its scaling with $N$ is:\n$$\nE_{H}[n_{N}] = \\frac{1}{2} \\iint \\frac{n_{N}(\\mathbf{r})\\,n_{N}(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\,d\\mathbf{r}\\,d\\mathbf{r'} = \\frac{1}{2} \\iint \\frac{N n_{1}(\\mathbf{r})\\,N n_{1}(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\,d\\mathbf{r}\\,d\\mathbf{r'} = N^{2} \\left( \\frac{1}{2} \\iint \\frac{n_{1}(\\mathbf{r})\\,n_{1}(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\,d\\mathbf{r}\\,d\\mathbf{r'} \\right) = N^{2} E_{H}[n_{1}]\n$$\nUsing the given definition $U_{1} = E_{H}[n_{1}]$, we have $E_{H}[n_{N}] = U_{1}\\,N^{2}$.\n\nThe approximate GGA exchange energy is given to scale as:\n$$\nE_{x}^{\\mathrm{GGA}}[n_{N}] = -\\lambda\\,U_{1}\\,N^{4/3}\n$$\n\nCombining these components, the total GGA energy for $N$ electrons is:\n$$\nE^{\\mathrm{GGA}}(N) = T_{s}[n_{N}] + V_{\\mathrm{ne}}[n_{N}] + E_{H}[n_{N}] + E_{x}^{\\mathrm{GGA}}[n_{N}] = N\\,(T_{s}[n_{1}] + V_{\\mathrm{ne}}[n_{1}]) + U_{1}\\,N^{2} - \\lambda\\,U_{1}\\,N^{4/3}\n$$\n$$\nE^{\\mathrm{GGA}}(N) = K_{1}\\,N + U_{1}\\,N^{2} - \\lambda\\,U_{1}\\,N^{4/3}\n$$\n\nNow, we derive the expression for the deviation from linearity, $\\delta(N) = E^{\\mathrm{GGA}}(N) - L(N)$. The linear interpolation $L(N)$ is defined as $L(N) = (1-N)\\,E^{\\mathrm{GGA}}(0) + N\\,E^{\\mathrm{GGA}}(1)$. We must first evaluate the energy at the endpoints $N=0$ and $N=1$.\nFor $N=0$, the density is zero, so all energy components are zero:\n$$\nE^{\\mathrm{GGA}}(0) = 0\n$$\nFor $N=1$:\n$$\nE^{\\mathrm{GGA}}(1) = K_{1}\\,(1) + U_{1}\\,(1)^{2} - \\lambda\\,U_{1}\\,(1)^{4/3} = K_{1} + U_{1} - \\lambda\\,U_{1}\n$$\nThe linear interpolation is therefore:\n$$\nL(N) = (1-N)\\,(0) + N\\,(K_{1} + U_{1} - \\lambda\\,U_{1}) = K_{1}\\,N + U_{1}\\,N - \\lambda\\,U_{1}\\,N\n$$\nThe deviation $\\delta(N)$ is found by subtracting $L(N)$ from $E^{\\mathrm{GGA}}(N)$:\n$$\n\\delta(N) = E^{\\mathrm{GGA}}(N) - L(N) = (K_{1}\\,N + U_{1}\\,N^{2} - \\lambda\\,U_{1}\\,N^{4/3}) - (K_{1}\\,N + U_{1}\\,N - \\lambda\\,U_{1}\\,N)\n$$\n$$\n\\delta(N) = U_{1}\\,N^{2} - U_{1}\\,N - \\lambda\\,U_{1}\\,N^{4/3} + \\lambda\\,U_{1}\\,N\n$$\nFactoring out $U_{1}$ gives the final analytical expression for the deviation:\n$$\n\\delta(N) = U_{1} \\left[ (N^{2} - N) - \\lambda(N^{4/3} - N) \\right]\n$$\nThis completes the first part of the problem.\n\nFor the second part, we must evaluate $\\delta\\!\\left(\\frac{1}{2}\\right)$ using $\\lambda = 0.90$ and $U_{1} = \\frac{5}{16}$ Hartree. We substitute these values into the derived expression for $\\delta(N)$:\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) = \\frac{5}{16} \\left[ \\left(\\left(\\frac{1}{2}\\right)^{2} - \\frac{1}{2}\\right) - 0.90\\left(\\left(\\frac{1}{2}\\right)^{4/3} - \\frac{1}{2}\\right) \\right]\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) = \\frac{5}{16} \\left[ \\left(\\frac{1}{4} - \\frac{1}{2}\\right) - 0.90\\left(\\left(\\frac{1}{2}\\right)^{4/3} - \\frac{1}{2}\\right) \\right]\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) = \\frac{5}{16} \\left[ -\\frac{1}{4} - 0.90\\left(2^{-4/3} - \\frac{1}{2}\\right) \\right]\n$$\nNow, we compute the numerical value:\n$$\n2^{-4/3} \\approx 0.39685026\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) \\approx \\frac{5}{16} \\left[ -0.25 - 0.90(0.39685026 - 0.5) \\right]\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) \\approx \\frac{5}{16} \\left[ -0.25 - 0.90(-0.10314974) \\right]\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) \\approx \\frac{5}{16} \\left[ -0.25 + 0.092834766 \\right]\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) \\approx \\frac{5}{16} [-0.157165234] \\approx 0.3125 \\times (-0.157165234)\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) \\approx -0.0491141356 \\, \\text{Hartree}\n$$\nRounding the result to four significant figures, we obtain $\\delta\\!\\left(\\frac{1}{2}\\right) = -0.04911$ Hartree.\n\nFor the final part, we must explain the origin of the convexity of the $E^{\\mathrm{GGA}}(N)$ curve for $N \\in (0,1)$. A function is convex if its curve lies at or below the straight line segment connecting its endpoints. This means $\\delta(N) = E^{\\mathrm{GGA}}(N) - L(N) \\leq 0$ for $N \\in [0,1]$. Our negative result for $\\delta\\!\\left(\\frac{1}{2}\\right)$ is consistent with convexity.\n\nThe linearity of the exact energy, $E(N)$, for a one-electron system arises from the perfect cancellation of the spurious self-interaction Hartree energy, $E_{H}[n_{N}]$, by the exact exchange-correlation energy, $E_{xc}^{\\mathrm{exact}}[n_{N}] = -E_{H}[n_{N}]$. The non-linear terms in the approximate GGA energy are $E_{H}[n_{N}]$ and $E_{x}^{\\mathrm{GGA}}[n_{N}]$. The source of the non-linear deviation $\\delta(N)$ is the sum of these two terms.\nThe Hartree energy scales as $E_{H}[n_{N}] = U_{1}N^{2}$. A function proportional to $N^2$ is inherently convex (its second derivative is a positive constant, $2U_1$).\nThe approximate GGA exchange energy scales as $E_{x}^{\\mathrm{GGA}}[n_{N}] = -\\lambda U_{1}N^{4/3}$. A function proportional to $-N^{4/3}$ is concave (its second derivative is $-\\frac{4\\lambda U_1}{9}N^{-2/3}$, which is negative).\n\nThe total energy curve's curvature is determined by the competition between the convex Hartree term and the concave approximate exchange term. The total non-linear part of the energy is $E_{\\mathrm{nl}}(N) = U_{1}N^{2} - \\lambda U_{1}N^{4/3}$. The exact exchange energy would have to scale in such a way as to perfectly cancel the $N^2$ term from the Hartree energy. The GGA exchange, with its $N^{4/3}$ scaling, fails to do this. Because the exponent of the convex Hartree term ($2$) is greater than the exponent of the concave exchange term ($4/3$), the convex behavior of the Hartree self-interaction dominates the overall shape of the energy curve. This incomplete cancellation of the self-interaction in the GGA leads to a residual convex curvature, causing the total energy $E^{\\mathrm{GGA}}(N)$ to bow downwards below the straight-line interpolation. This phenomenon is a manifestation of the delocalization error inherent in many approximate density functionals.", "answer": "$$\n\\boxed{-0.04911}\n$$", "id": "2634165"}]}