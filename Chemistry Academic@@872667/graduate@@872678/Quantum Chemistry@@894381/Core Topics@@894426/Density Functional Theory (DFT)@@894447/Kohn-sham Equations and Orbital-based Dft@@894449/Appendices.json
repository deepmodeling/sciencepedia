{"hands_on_practices": [{"introduction": "The existence of a unique mapping from the ground-state electron density $n(\\mathbf{r})$ to the effective Kohn-Sham potential $v_s(\\mathbf{r})$ is a cornerstone of density functional theory. This exercise moves beyond abstract theorems by providing a concrete numerical challenge: to explicitly construct the potential that generates a given density [@problem_id:2901327]. By implementing this potential inversion procedure, you will gain a practical understanding of the KS framework and verify its internal consistency.", "problem": "You will implement and test a one-dimensional potential inversion in Kohn–Sham density functional theory for a closed-shell two-electron system. Work entirely in Hartree atomic units, where the electron mass, elementary charge, reduced Planck constant, and Coulomb constant are all equal to $1$. Your program should not read any input and must output a single line as specified below.\n\nStarting point and physical setting: In the Kohn–Sham (KS) non-interacting system for a spin-compensated two-electron ground state in one dimension, there is a single spatial orbital $\\,\\varphi(x)\\,$ that is doubly occupied by opposite spins. The electron density is $\\,n(x) = 2\\,|\\varphi(x)|^2\\,$ and the orbital satisfies the one-dimensional time-independent Schrödinger equation with an effective single-particle KS potential $\\,v_s(x)\\,$,\n$$\n-\\frac{1}{2}\\,\\frac{d^2 \\varphi(x)}{dx^2} + v_s(x)\\,\\varphi(x) = \\varepsilon\\,\\varphi(x),\n$$\nwhere $\\,\\varepsilon\\,$ is the orbital energy. The KS potential $\\,v_s(x)\\,$ is defined up to an additive constant, which does not affect $\\,\\varphi(x)\\,$.\n\nTask: You are given an exact target density profile $\\,n(x)\\,$ on a finite interval $[x_{\\min}, x_{\\max}]$. Your task is to:\n- Derive from first principles how to invert the one-dimensional KS equation in this closed-shell two-electron case to obtain a KS potential $\\,v_s(x)\\,$ that reproduces the given $\\,n(x)\\,$.\n- Implement the inversion numerically on a uniform grid using finite differences and Dirichlet boundary conditions $\\,\\varphi(x_{\\min}) = \\varphi(x_{\\max}) = 0\\,$. You must construct $\\,v_s(x)\\,$ from the density, then solve the resulting one-dimensional Schrödinger eigenproblem for the lowest-energy orbital and reconstruct the density $\\,\\tilde n(x) = 2\\,|\\tilde\\varphi(x)|^2\\,$. Normalize all orbitals with respect to the continuous inner product so that $\\,\\int_{x_{\\min}}^{x_{\\max}} |\\varphi(x)|^2\\,dx = 1\\,$.\n- Verify that the reconstructed density $\\,\\tilde n(x)\\,$ matches the input $\\,n(x)\\,$ within the specified tolerance using the relative $L^2$ error norm\n$$\n\\mathcal{E} = \\frac{\\left(\\int_{x_{\\min}}^{x_{\\max}} \\left[ \\tilde n(x) - n(x) \\right]^2 dx\\right)^{1/2}}{\\left(\\int_{x_{\\min}}^{x_{\\max}} n(x)^2 dx\\right)^{1/2}}.\n$$\n\nNumerical and algorithmic requirements:\n- Use a uniform grid with $\\,N\\,$ points on $[x_{\\min}, x_{\\max}]$ and grid spacing $\\,h = (x_{\\max} - x_{\\min})/(N-1)\\,$.\n- Use the standard second-order central finite-difference approximation for second derivatives on the interior grid points. Impose Dirichlet boundary conditions by excluding the endpoints from the eigenproblem.\n- Construct the Hamiltonian matrix for the interior points as a symmetric tridiagonal matrix representing the operator $-\\frac{1}{2}\\frac{d^2}{dx^2} + v_s(x)$.\n- Any overall additive constant in $\\,v_s(x)\\,$ is arbitrary; you may choose a convenient gauge (for example, set $\\,v_s(0)=0\\,$ if $\\,0 \\in [x_{\\min}, x_{\\max}]$, or subtract the value at the grid midpoint).\n\nTest suite and densities:\nImplement the following four test cases. In all cases, use the exact two-electron density $\\,n(x) = 2\\,|\\varphi(x)|^2\\,$ generated from a smooth, nodeless target orbital $\\,\\varphi(x)\\,$. The continuous normalization $\\,\\int |\\varphi(x)|^2 dx = 1\\,$ must be enforced numerically on the chosen grid before computing $\\,n(x)\\,$. For each case, report whether $\\,\\mathcal{E}\\,$ is less than or equal to the specified tolerance as a boolean.\n\n- Case $1$ (Gaussian, moderate width):\n  - Interval: $[x_{\\min}, x_{\\max}] = [-10, 10]$.\n  - Grid: $N = 1201$.\n  - Target orbital: $\\,\\varphi(x) \\propto \\exp\\!\\left(-\\frac{\\alpha x^2}{2}\\right)\\,$ with $\\,\\alpha = 1.0\\,$.\n  - Tolerance: $\\,1.5\\times 10^{-3}\\,$.\n\n- Case $2$ (Gaussian, narrow):\n  - Interval: $[x_{\\min}, x_{\\max}] = [-6, 6]$.\n  - Grid: $N = 1201$.\n  - Target orbital: $\\,\\varphi(x) \\propto \\exp\\!\\left(-\\frac{\\alpha x^2}{2}\\right)\\,$ with $\\,\\alpha = 2.5\\,$.\n  - Tolerance: $\\,2.0\\times 10^{-3}\\,$.\n\n- Case $3$ (hyperbolic secant, Pöschl–Teller-like):\n  - Interval: $[x_{\\min}, x_{\\max}] = [-15, 15]$.\n  - Grid: $N = 2001$.\n  - Target orbital: $\\,\\varphi(x) \\propto \\operatorname{sech}(b x)\\,$ with $\\,b = 0.8\\,$.\n  - Tolerance: $\\,2.0\\times 10^{-3}\\,$.\n\n- Case $4$ (Gaussian, very broad):\n  - Interval: $[x_{\\min}, x_{\\max}] = [-30, 30]$.\n  - Grid: $N = 2401$.\n  - Target orbital: $\\,\\varphi(x) \\propto \\exp\\!\\left(-\\frac{\\alpha x^2}{2}\\right)\\,$ with $\\,\\alpha = 0.15\\,$.\n  - Tolerance: $\\,3.0\\times 10^{-3}\\,$.\n\nImplementation guidance and constraints:\n- Build the inversion from the foundational Schrödinger equation above without introducing any model-specific shortcuts beyond standard finite differences and linear algebra. You must not hard-code any analytic potential forms.\n- For numerical stability in forming $\\,v_s(x)\\,$ from the given $\\,n(x)\\,$, you may regularize any divisions by very small orbital values by replacing denominators below a small positive threshold with the threshold itself; ensure the chosen threshold is sufficiently small not to corrupt the interior solution.\n- After constructing $\\,v_s(x)\\,$ on the interior grid, solve the tridiagonal eigenproblem to obtain the lowest-energy orbital and reconstruct the density. Normalize using the Riemann sum with spacing $\\,h\\,$ to approximate integrals (for example, $\\,\\sum_i |\\varphi(x_i)|^2 h \\approx 1\\,$).\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for the four cases in order. Each entry must be a boolean indicating whether the verification passed, for example, $[{\\tt True},{\\tt False},{\\tt True},{\\tt True}]$.\n\nAngle units are not involved. All physical quantities are in atomic units. No other outputs are permitted on stdout.", "solution": "The provided problem statement is subject to rigorous validation.\n\n**1. Problem Validation**\n\n- **Givens Extracted:** The system is a one-dimensional, two-electron, closed-shell system described by the Kohn-Sham (KS) equation $-\\frac{1}{2}\\,\\frac{d^2 \\varphi(x)}{dx^2} + v_s(x)\\,\\varphi(x) = \\varepsilon\\,\\varphi(x)$, with electron density $n(x) = 2\\,|\\varphi(x)|^2$. The task is to invert this equation on a finite interval $[x_{\\min}, x_{\\max}]$ with Dirichlet boundary conditions $\\varphi(x_{\\min})=\\varphi(x_{\\max})=0$, given a target density $n(x)$. Numerical implementation must use a finite-difference scheme on a uniform grid. Four test cases are provided with specific parameters and verification tolerances for the relative $L^2$ error norm\n$$\n\\mathcal{E} = \\frac{\\left(\\int_{x_{\\min}}^{x_{\\max}} \\left[ \\tilde n(x) - n(x) \\right]^2 dx\\right)^{1/2}}{\\left(\\int_{x_{\\min}}^{x_{\\max}} n(x)^2 dx\\right)^{1/2}}.\n$$\n- **Validation Verdict:** The problem is deemed **valid**. It is scientifically grounded in the principles of density functional theory, is mathematically well-posed, and is specified with complete objectivity and clarity. It presents a standard, non-trivial problem in computational quantum chemistry, free of contradictions, ambiguities, or factual errors. We may proceed to the solution.\n\n**2. Derivation of the Inversion Formula**\n\nThe objective is to determine the effective Kohn-Sham potential $v_s(x)$ that yields a given ground-state electron density $n(x)$. For a spin-compensated two-electron system, the density is produced by a single, doubly-occupied spatial orbital $\\varphi(x)$, such that $n(x) = 2|\\varphi(x)|^2$. In one dimension, the ground-state orbital of a real potential can be chosen to be real and non-negative, $\\varphi(x) \\ge 0$. Therefore, the orbital is uniquely determined by the density:\n$$\n\\varphi(x) = \\sqrt{\\frac{n(x)}{2}}\n$$\nThe Kohn-Sham equation is a time-independent Schrödinger equation for the single-particle orbital $\\varphi(x)$:\n$$\n-\\frac{1}{2}\\frac{d^2\\varphi(x)}{dx^2} + v_s(x)\\varphi(x) = \\varepsilon\\varphi(x)\n$$\nwhere $\\varepsilon$ is the orbital energy. Assuming $\\varphi(x)  0$ in the interior of the domain, we can rearrange this equation to solve for $v_s(x)$:\n$$\nv_s(x)\\varphi(x) = \\varepsilon\\varphi(x) + \\frac{1}{2}\\frac{d^2\\varphi(x)}{dx^2}\n$$\n$$\nv_s(x) = \\varepsilon + \\frac{1}{2\\varphi(x)}\\frac{d^2\\varphi(x)}{dx^2}\n$$\nThe orbital energy $\\varepsilon$ is a constant. The potential $v_s(x)$ is defined only up to an arbitrary additive constant, as a shift $v_s(x) \\to v_s(x) + C$ merely shifts the energy eigenvalue $\\varepsilon \\to \\varepsilon + C$ without altering the orbital $\\varphi(x)$. Thus, we can disregard the constant $\\varepsilon$ and define the potential relative to a chosen reference. The operational formula for potential inversion is:\n$$\nv_s(x) = \\frac{1}{2\\varphi(x)}\\frac{d^2\\varphi(x)}{dx^2} + C'\n$$\nwhere $C'$ is a constant chosen to fix the gauge, and $\\varphi(x)$ is obtained directly from the target density $n(x)$.\n\n**3. Numerical Procedure**\n\nThe derivation is implemented numerically following a precise algorithmic sequence.\n\n- **Step 1: Grid and Target Data Generation**\nA uniform grid $x_i$ for $i=0, \\dots, N-1$ is established on the interval $[x_{\\min}, x_{\\max}]$ with spacing $h=(x_{\\max}-x_{\\min})/(N-1)$. For each test case, the analytic form of the target orbital, $\\varphi_{\\text{analytic}}(x)$, is evaluated on this grid. This discrete orbital is then normalized numerically to satisfy the continuous normalization condition, approximated by a Riemann sum:\n$$\nA = \\left( \\sum_{i=0}^{N-1} |\\varphi_{\\text{analytic}}(x_i)|^2 h \\right)^{-1/2}\n$$\nThe normalized target orbital on the grid is $\\varphi_{\\text{target}}(x_i) = A \\cdot \\varphi_{\\text{analytic}}(x_i)$, and the target density is $n_{\\text{target}}(x_i) = 2|\\varphi_{\\text{target}}(x_i)|^2$.\n\n- **Step 2: Potential Inversion**\nThe potential $v_s(x)$ is constructed on the interior grid points ($i=1, \\dots, N-2$). The term $\\varphi(x)$ in the inversion formula corresponds to $\\varphi_{\\text{target}}(x_i)$. The second derivative of $\\varphi_{\\text{target}}(x)$ is approximated using the second-order central finite difference formula:\n$$\n\\frac{d^2\\varphi_{\\text{target}}(x_i)}{dx^2} \\approx \\frac{\\varphi_{\\text{target}}(x_{i-1}) - 2\\varphi_{\\text{target}}(x_i) + \\varphi_{\\text{target}}(x_{i+1})}{h^2}\n$$\nThe potential is computed as:\n$$\nv_s(x_i) = \\frac{1}{2\\varphi_{\\text{target}}(x_i)} \\left( \\frac{\\varphi_{\\text{target}}(x_{i-1}) - 2\\varphi_{\\text{target}}(x_i) + \\varphi_{\\text{target}}(x_{i+1})}{h^2} \\right)\n$$\nTo prevent numerical instability where $\\varphi_{\\text{target}}(x_i)$ is close to zero (near the boundaries), the denominator is regularized by replacing values smaller than a threshold $\\delta  0$ with $\\delta$. Finally, the potential is shifted by a constant to set its value at the grid midpoint to zero, fixing the gauge.\n\n- **Step 3: Eigenproblem Solution**\nWith the constructed potential $v_s(x_i)$ for the interior points, the discretized Kohn-Sham Hamiltonian matrix $H$ is formed. $H$ is an $(N-2) \\times (N-2)$ symmetric tridiagonal matrix corresponding to the operator $-\\frac{1}{2}\\frac{d^2}{dx^2} + v_s(x)$ with Dirichlet boundary conditions. Its elements are:\n$$\nH_{ij} = \\begin{cases} \\frac{1}{h^2} + v_s(x_i)  \\text{if } i=j \\\\ -\\frac{1}{2h^2}  \\text{if } |i-j|=1 \\\\ 0  \\text{otherwise} \\end{cases}\n$$\nThe lowest eigenvalue and corresponding eigenvector of this matrix are computed using a specialized numerical linear algebra routine (`scipy.linalg.eigh_tridiagonal`). The resulting eigenvector contains the values of the reconstructed orbital, $\\tilde\\varphi_{\\text{vec}}$, at the interior grid points.\n\n- **Step 4: Verification and Error Calculation**\nThe computed eigenvector $\\tilde\\varphi_{\\text{vec}}$ is normalized to conform to the continuous integral representation:\n$$\n\\tilde\\varphi(x_i) = \\frac{\\tilde\\varphi_{\\text{vec}}[i-1]}{\\sqrt{h}} \\quad \\text{for } i=1, \\dots, N-2\n$$\nA full orbital vector $\\tilde\\varphi$ of size $N$ is formed, with $\\tilde\\varphi(x_0)=0$ and $\\tilde\\varphi(x_{N-1})=0$. Its sign is adjusted to be positive, matching the nodeless ground-state target orbital. The reconstructed density is then $\\tilde n(x_i) = 2|\\tilde\\varphi(x_i)|^2$.\nThe accuracy of the inversion is quantified by the relative $L^2$ error norm $\\mathcal{E}$, computed numerically:\n$$\n\\mathcal{E} = \\frac{\\left(\\sum_{i=0}^{N-1} [\\tilde n(x_i) - n_{\\text{target}}(x_i)]^2 h \\right)^{1/2}}{\\left(\\sum_{i=0}^{N-1} [n_{\\text{target}}(x_i)]^2 h \\right)^{1/2}}\n$$\nFor each test case, this error is compared against the specified tolerance to yield a boolean verification result.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\n\ndef _process_case(xmin, xmax, N, orbital_type, param, tolerance):\n    \"\"\"\n    Performs the potential inversion and verification for a single test case.\n    \"\"\"\n    # Step 1: Grid and Target Data Generation\n    x_grid = np.linspace(xmin, xmax, N)\n    h = x_grid[1] - x_grid[0]\n\n    # Generate unnormalized analytic orbital\n    if orbital_type == 'gaussian':\n        alpha = param\n        phi_unnormalized = np.exp(-alpha * x_grid**2 / 2.0)\n    elif orbital_type == 'sech':\n        b = param\n        # Use np.exp for potentially better performance/stability than a direct cosh call\n        phi_unnormalized = 2.0 / (np.exp(b * x_grid) + np.exp(-b * x_grid))\n    else:\n        # This branch should not be reached with the given valid problem statement.\n        raise ValueError(f\"Unknown orbital type: {orbital_type}\")\n\n    # Numerically normalize the target orbital using Riemann sum\n    # Integral(|phi|^2 dx) approx sum(|phi_i|^2 * h) = 1\n    norm_sq_integral = np.sum(phi_unnormalized**2) * h\n    phi_target = phi_unnormalized / np.sqrt(norm_sq_integral)\n\n    # Calculate target density\n    n_target = 2.0 * phi_target**2\n\n    # Step 2: Potential Inversion\n    # We invert the KS equation to find v_s from phi_target.\n    # The formula is v_s = (1/2) * (d^2(phi)/dx^2) / phi, up to a constant.\n    # We operate on the interior grid points where boundary conditions are not applied.\n    \n    # Second derivative of phi_target on the interior grid (size N-2)\n    d2_phi_target_interior = (phi_target[2:] - 2*phi_target[1:-1] + phi_target[:-2]) / h**2\n    phi_target_interior = phi_target[1:-1]\n    \n    # Regularize the denominator phi_target to avoid division by zero\n    regularization_threshold = 1e-10\n    phi_denom_reg = np.maximum(phi_target_interior, regularization_threshold)\n    \n    # Calculate potential on the interior grid\n    v_s_interior_raw = 0.5 * d2_phi_target_interior / phi_denom_reg\n    \n    # Fix the gauge by setting the potential at the grid midpoint to zero\n    mid_idx_interior = (N - 2) // 2\n    v_s_interior = v_s_interior_raw - v_s_interior_raw[mid_idx_interior]\n\n    # Step 3: Eigenproblem Solution\n    # Construct the tridiagonal Hamiltonian matrix for the interior grid.\n    # H = T + V, where T is kinetic energy and V is potential energy.\n    diag = 1.0 / h**2 + v_s_interior\n    offdiag = -1.0 / (2.0 * h**2) * np.ones(N - 3)\n    \n    # Solve the eigenproblem for the lowest eigenvalue (ground state)\n    eigenvalues, eigenvectors = eigh_tridiagonal(diag, offdiag, select='i', select_range=(0,0))\n    gs_eigenvector = eigenvectors[:, 0]\n    \n    # Step 4: Verification and Error Calculation\n    # Normalize the eigenvector for continuous inner product: integral(|phi|^2) = 1\n    # The solver returns an eigenvector where sum(vec_i^2) = 1.\n    # We must scale by 1/sqrt(h) to match the Riemann sum integral normalization.\n    phi_reconstructed_interior = gs_eigenvector / np.sqrt(h)\n\n    # Ensure the reconstructed orbital has a positive sign, matching the target.\n    if phi_reconstructed_interior[mid_idx_interior]  0:\n        phi_reconstructed_interior *= -1.0\n        \n    # Assemble the full reconstructed orbital with boundaries\n    phi_reconstructed = np.zeros(N)\n    phi_reconstructed[1:-1] = phi_reconstructed_interior\n    \n    # Reconstruct density\n    n_reconstructed = 2.0 * phi_reconstructed**2\n    \n    # Calculate the relative L2 error norm\n    numerator_sq_integral = np.sum((n_reconstructed - n_target)**2 * h)\n    denominator_sq_integral = np.sum(n_target**2 * h)\n    \n    # Handle the unlikely case of a zero-norm target density\n    if denominator_sq_integral  1e-20:\n        error = 0.0 if numerator_sq_integral  1e-20 else np.inf\n    else:\n        error = np.sqrt(numerator_sq_integral / denominator_sq_integral)\n        \n    # Return boolean result of the check\n    return error = tolerance\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (xmin, xmax, N, orbital_type, parameter, tolerance)\n        (-10.0, 10.0, 1201, 'gaussian', 1.0, 1.5e-3),  # Case 1\n        (-6.0, 6.0, 1201, 'gaussian', 2.5, 2.0e-3),   # Case 2\n        (-15.0, 15.0, 2001, 'sech', 0.8, 2.0e-3),      # Case 3\n        (-30.0, 30.0, 2401, 'gaussian', 0.15, 3.0e-3) # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters and process the case\n        xmin, xmax, N, orbital_type, param, tolerance = case\n        passed = _process_case(xmin, xmax, N, orbital_type, param, tolerance)\n        results.append(passed)\n\n    # Final print statement in the exact required format.\n    # Note: str(True) is 'True', str(False) is 'False' in Python.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2901327"}, {"introduction": "While an exact exchange-correlation functional would be free of self-interaction, the approximate functionals used in most DFT calculations are not. This fundamental deficiency, known as self-interaction error (SIE), causes an electron to spuriously interact with its own density. This practice provides a rigorous analytical demonstration of SIE by examining the simplest possible case, a one-electron hydrogen atom, where the exact cancellation of self-interaction can be directly contrasted with the residual errors in local and semi-local approximations [@problem_id:2901403].", "problem": "Consider a one-electron hydrogen atom in its nonrelativistic ground state within Kohn–Sham density functional theory (KS-DFT). The spatial orbital is the normalized hydrogenic $1s$ function and the electron is fully spin-polarized. Work in Hartree atomic units, so that the Bohr radius satisfies $a_0 = 1$, the electronic density is spherically symmetric and equals\n\n$$\nn(r) \\;=\\; \\frac{1}{\\pi}\\,\\exp(-2 r),\n$$\n\nand the system has exactly one electron.\n\nStarting from first principles and standard definitions, do the following:\n\n- Using the definition of the classical Hartree electrostatic energy,\n\n$$\nE_{\\mathrm{H}}[n] \\;=\\; \\frac{1}{2}\\int \\!\\! \\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}',\n$$\n\nand the Hartree–Fock exchange energy for a Slater determinant,\n\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi_i\\}] \\;=\\; -\\frac{1}{2}\\sum_{i,j}\\int \\!\\! \\int \\frac{\\varphi_i(\\mathbf{r})\\,\\varphi_j^{*}(\\mathbf{r})\\,\\varphi_j(\\mathbf{r}')\\,\\varphi_i^{*}(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}',\n$$\n\nverify from these definitions that for a one-electron system $E_{\\mathrm{H}} + E_{x}^{\\mathrm{exact}} = 0$, where $E_{x}^{\\mathrm{exact}}$ denotes the exact exchange energy functional evaluated on the given density.\n\n- Next, quantify the residual self-interaction error defined as $E_{\\mathrm{H}} + E_{x}^{\\mathrm{approx}}$ for two approximate exchange functionals:\n  1. The Local Density Approximation (LDA) exchange for spin-density functional theory,\n  \n$$\n  E_{x}^{\\mathrm{LDA}}[n_{\\uparrow},n_{\\downarrow}] \\;=\\; -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\int \\left(n_{\\uparrow}^{4/3} + n_{\\downarrow}^{4/3}\\right)\\,d\\mathbf{r},\n  $$\n\n  evaluated for the fully spin-polarized hydrogen density $n_{\\uparrow} = n$, $n_{\\downarrow} = 0$.\n  2. The second-order gradient expansion (a Generalized Gradient Approximation (GGA) prototype) for exchange,\n  \n$$\n  E_{x}^{\\mathrm{GEA2}}[n] \\;=\\; -C_{x}\\int n(\\mathbf{r})^{4/3}\\left[1 + \\mu\\,s(\\mathbf{r})^{2}\\right]\\,d\\mathbf{r},\n  $$\n\n  where $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$, $\\mu = \\frac{10}{81}$, the reduced gradient is $s(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|}{2 k_{F}(\\mathbf{r})\\,n(\\mathbf{r})}$, and the local Fermi wavevector is $k_{F}(\\mathbf{r}) = \\left(3\\pi^{2} n(\\mathbf{r})\\right)^{1/3}$.\n\nDerive analytic closed-form expressions for the two residual self-interaction errors,\n\n$$\n\\Delta_{\\mathrm{LDA}} \\;=\\; E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{LDA}}[n_{\\uparrow}=n,n_{\\downarrow}=0], \n\\quad\n\\Delta_{\\mathrm{GEA2}} \\;=\\; E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{GEA2}}[n],\n$$\n\nin terms of rational numbers and powers of $\\pi$ and $3$. Express the final answer as a row matrix $\\bigl[\\Delta_{\\mathrm{LDA}}\\;\\;\\Delta_{\\mathrm{GEA2}}\\bigr]$ and use Hartree ($\\mathrm{E_h}$) as the energy unit. No numerical rounding is required; provide exact expressions.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. All provided definitions, constants, and physical quantities are standard within the framework of density functional theory, or are explicitly defined for the purpose of the problem. The task is a rigorous and verifiable calculation. Therefore, the problem is deemed valid and a full solution will be provided.\n\nThe problem requires a two-part analysis of self-interaction in a one-electron system, specifically the hydrogen atom in its ground state. All calculations are performed in Hartree atomic units ($e=m_e=\\hbar=1$, $a_0=1$).\n\nPart 1: Verification of Exact Self-Interaction Cancellation\n\nFor any one-electron system, the ground-state electron density $n(\\mathbf{r})$ is given by the square of the single occupied orbital $\\varphi_1(\\mathbf{r})$, such that $n(\\mathbf{r}) = |\\varphi_1(\\mathbf{r})|^2$. Since the hydrogen $1s$ orbital is a real function, we have $n(\\mathbf{r}) = \\varphi_1(\\mathbf{r})^2$.\n\nThe Hartree energy is defined as:\n$$\nE_{\\mathrm{H}}[n] = \\frac{1}{2}\\int \\!\\! \\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'\n$$\nSubstituting $n(\\mathbf{r}) = \\varphi_1(\\mathbf{r})^2$, we get:\n$$\nE_{\\mathrm{H}}[n] = \\frac{1}{2}\\int \\!\\! \\int \\frac{\\varphi_1(\\mathbf{r})^2\\,\\varphi_1(\\mathbf{r}')^2}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'\n$$\nThe exact exchange energy, $E_{x}^{\\mathrm{exact}}$, is given by the Hartree-Fock exchange expression evaluated on the exact Kohn-Sham orbitals. For a one-electron system, there is only one orbital, $\\varphi_1$. The summations over $i$ and $j$ in the definition of $E_{x}^{\\mathrm{HF}}$ each have only one term, $i=j=1$.\n$$\nE_{x}^{\\mathrm{exact}} = E_{x}^{\\mathrm{HF}}[\\{\\varphi_1\\}] = -\\frac{1}{2}\\int \\!\\! \\int \\frac{\\varphi_1(\\mathbf{r})\\,\\varphi_1^{*}(\\mathbf{r})\\,\\varphi_1(\\mathbf{r}')\\,\\varphi_1^{*}(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'\n$$\nSince $\\varphi_1$ is real, $\\varphi_1^* = \\varphi_1$. The expression simplifies to:\n$$\nE_{x}^{\\mathrm{exact}} = -\\frac{1}{2}\\int \\!\\! \\int \\frac{\\varphi_1(\\mathbf{r})^2\\,\\varphi_1(\\mathbf{r}')^2}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'\n$$\nComparing this with the expression for the Hartree energy, we see that:\n$$\nE_{x}^{\\mathrm{exact}} = -E_{\\mathrm{H}}[n]\n$$\nTherefore, for any one-electron system, the sum of the Hartree energy and the exact exchange energy is identically zero:\n$$\nE_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{exact}} = 0\n$$\nThis demonstrates the exact cancellation of the self-interaction in the exact theory. Approximate functionals, however, do not typically satisfy this condition, leading to a residual self-interaction error.\n\nPart 2: Calculation of Residual Self-Interaction Errors\n\nWe must compute $\\Delta_{\\mathrm{LDA}} = E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{LDA}}[n]$ and $\\Delta_{\\mathrm{GEA2}} = E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{GEA2}}[n]$. The first step is to compute the Hartree energy $E_{\\mathrm{H}}$ for the given density, $n(r) = \\frac{1}{\\pi}\\exp(-2r)$.\n\nCalculation of the Hartree Energy, $E_{\\mathrm{H}}$\nThe Hartree energy is the electrostatic self-energy of the charge distribution $n(\\mathbf{r})$. It can be expressed as $E_{\\mathrm{H}} = \\frac{1}{2}\\int n(\\mathbf{r}) V_{\\mathrm{H}}(\\mathbf{r}) \\,d\\mathbf{r}$, where $V_{\\mathrm{H}}(\\mathbf{r})$ is the electrostatic potential generated by $n(\\mathbf{r})$. For a spherically symmetric density, the potential is:\n$$\nV_{\\mathrm{H}}(r) = \\frac{1}{r} \\int_0^r n(r') 4\\pi r'^2 dr' + \\int_r^\\infty \\frac{n(r') 4\\pi r'^2}{r'} dr'\n$$\nUsing $n(r) = \\frac{1}{\\pi}\\exp(-2r)$, the integrals yield $V_{\\mathrm{H}}(r) = \\frac{1}{r} - \\left(\\frac{1}{r}+1\\right)\\exp(-2r)$.\nNow we compute $E_{\\mathrm{H}}$:\n$$\nE_{\\mathrm{H}} = \\frac{1}{2} \\int_0^\\infty V_{\\mathrm{H}}(r) n(r) 4\\pi r^2 dr = \\frac{1}{2} \\int_0^\\infty \\left[\\frac{1}{r} - \\left(\\frac{1}{r}+1\\right)\\exp(-2r)\\right] \\left(\\frac{1}{\\pi}\\exp(-2r)\\right) 4\\pi r^2 dr\n$$\n$$\nE_{\\mathrm{H}} = 2 \\int_0^\\infty \\left[ r\\exp(-2r) - (r+r^2)\\exp(-4r) \\right] dr\n$$\nWe use the standard integral $\\int_0^\\infty x^k \\exp(-ax) dx = k!/a^{k+1}$:\n- $\\int_0^\\infty r\\exp(-2r) dr = 1!/2^2 = \\frac{1}{4}$\n- $\\int_0^\\infty r^2\\exp(-4r) dr = 2!/4^3 = \\frac{2}{64} = \\frac{1}{32}$\n- $\\int_0^\\infty r\\exp(-4r) dr = 1!/4^2 = \\frac{1}{16}$\nSubstituting these results:\n$$\nE_{\\mathrm{H}} = 2 \\left[ \\frac{1}{4} - \\left(\\frac{1}{16} + \\frac{1}{32}\\right) \\right] = 2 \\left[ \\frac{8}{32} - \\frac{2}{32} - \\frac{1}{32} \\right] = 2 \\left( \\frac{5}{32} \\right) = \\frac{5}{16}\n$$\n\nCalculation of the LDA Self-Interaction Error, $\\Delta_{\\mathrm{LDA}}$\nThe problem provides the LDA exchange energy functional for a spin-polarized system ($n_{\\uparrow}=n, n_{\\downarrow}=0$) as:\n$$\nE_{x}^{\\mathrm{LDA}}[n] = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\int n(\\mathbf{r})^{4/3}\\,d\\mathbf{r}\n$$\nWe compute the integral $\\int n(\\mathbf{r})^{4/3}\\,d\\mathbf{r}$:\n$$\n\\int n(r)^{4/3} 4\\pi r^2 dr = \\int_0^\\infty \\left(\\frac{1}{\\pi}\\exp(-2r)\\right)^{4/3} 4\\pi r^2 dr = 4\\pi \\pi^{-4/3} \\int_0^\\infty r^2 \\exp\\left(-\\frac{8}{3}r\\right) dr\n$$\n$$\n= 4\\pi^{-1/3} \\left( \\frac{2!}{(8/3)^3} \\right) = 4\\pi^{-1/3} \\left( \\frac{2}{512/27} \\right) = 4\\pi^{-1/3} \\left( \\frac{54}{512} \\right) = \\frac{27}{64}\\pi^{-1/3}\n$$\nNow we substitute this into the expression for $E_{x}^{\\mathrm{LDA}}$:\n$$\nE_{x}^{\\mathrm{LDA}} = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\left(\\frac{27}{64}\\pi^{-1/3}\\right) = -\\frac{3}{4} \\frac{3^{1/3}}{\\pi^{1/3}} \\frac{27}{64\\pi^{1/3}} = -\\frac{81 \\cdot 3^{1/3}}{256 \\pi^{2/3}} = -\\frac{3^{4} \\cdot 3^{1/3}}{256 \\pi^{2/3}} = -\\frac{3^{13/3}}{256 \\pi^{2/3}}\n$$\nThe residual self-interaction error for LDA is:\n$$\n\\Delta_{\\mathrm{LDA}} = E_{\\mathrm{H}} + E_{x}^{\\mathrm{LDA}} = \\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}}\n$$\n\nCalculation of the GEA2 Self-Interaction Error, $\\Delta_{\\mathrm{GEA2}}$\nThe GEA2 exchange energy is given by:\n$$\nE_{x}^{\\mathrm{GEA2}}[n] = -C_{x}\\int n^{4/3}\\left[1 + \\mu\\,s^{2}\\right]\\,d\\mathbf{r} = E_{x}^{\\mathrm{LDA}} - C_x \\mu \\int n^{4/3}s^2\\,d\\mathbf{r}\n$$\nWe need to evaluate the gradient correction term. First, we find the reduced gradient $s$:\n$s = \\frac{|\\nabla n|}{2 k_F n}$, with $k_F = (3\\pi^2 n)^{1/3}$.\nFor the given density, $\\nabla n = \\frac{dn}{dr}\\hat{\\mathbf{r}} = -2 \\frac{1}{\\pi}\\exp(-2r) \\hat{\\mathbf{r}} = -2n\\hat{\\mathbf{r}}$, so $|\\nabla n| = 2n$.\n$$\ns = \\frac{2n}{2 (3\\pi^2 n)^{1/3} n} = \\frac{1}{(3\\pi^2 n)^{1/3}} \\implies s^2 = \\frac{1}{(3\\pi^2 n)^{2/3}} = \\frac{1}{3^{2/3}\\pi^{4/3}n^{2/3}}\n$$\nThe integrand of the correction term is $n^{4/3}s^2$:\n$$\nn^{4/3}s^2 = n^{4/3} \\frac{1}{3^{2/3}\\pi^{4/3}n^{2/3}} = \\frac{n^{2/3}}{3^{2/3}\\pi^{4/3}}\n$$\nThe gradient correction energy is:\n$$\n\\Delta E_{x}^{\\mathrm{GEA2}} = -C_x \\mu \\int \\frac{n^{2/3}}{3^{2/3}\\pi^{4/3}}\\,d\\mathbf{r} = -\\frac{C_x \\mu}{3^{2/3}\\pi^{4/3}} \\int n^{2/3}\\,d\\mathbf{r}\n$$\nWe compute the integral $\\int n^{2/3}\\,d\\mathbf{r}$:\n$$\n\\int n(r)^{2/3} 4\\pi r^2 dr = \\int_0^\\infty \\left(\\frac{1}{\\pi}\\exp(-2r)\\right)^{2/3} 4\\pi r^2 dr = 4\\pi \\pi^{-2/3} \\int_0^\\infty r^2 \\exp\\left(-\\frac{4}{3}r\\right) dr\n$$\n$$\n= 4\\pi^{1/3} \\left( \\frac{2!}{(4/3)^3} \\right) = 4\\pi^{1/3} \\left( \\frac{2}{64/27} \\right) = 4\\pi^{1/3} \\left( \\frac{54}{64} \\right) = \\frac{27}{8}\\pi^{1/3}\n$$\nSubstituting this back, along with $C_x = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$ and $\\mu = \\frac{10}{81}$:\n$$\n\\Delta E_{x}^{\\mathrm{GEA2}} = -\\left(\\frac{3}{4}\\frac{3^{1/3}}{\\pi^{1/3}}\\right) \\left(\\frac{10}{81}\\right) \\frac{1}{3^{2/3}\\pi^{4/3}} \\left(\\frac{27}{8}\\pi^{1/3}\\right)\n$$\n$$\n= -\\frac{3 \\cdot 10 \\cdot 27}{4 \\cdot 81 \\cdot 8} \\frac{3^{1/3}}{3^{2/3}} \\frac{\\pi^{1/3}}{\\pi^{1/3}\\pi^{4/3}} = -\\frac{810}{2592} \\cdot 3^{-1/3} \\pi^{-4/3} = -\\frac{5 \\cdot 162}{16 \\cdot 162} \\cdot 3^{-1/3} \\pi^{-4/3} = -\\frac{5}{16} 3^{-1/3} \\pi^{-4/3}\n$$\nThe total GEA2 exchange energy is $E_{x}^{\\mathrm{GEA2}} = E_{x}^{\\mathrm{LDA}} + \\Delta E_{x}^{\\mathrm{GEA2}}$. The residual self-interaction error is:\n$$\n\\Delta_{\\mathrm{GEA2}} = E_{\\mathrm{H}} + E_{x}^{\\mathrm{GEA2}} = \\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}} - \\frac{5}{16} 3^{-1/3} \\pi^{-4/3}\n$$\nThe final results are the expressions for $\\Delta_{\\mathrm{LDA}}$ and $\\Delta_{\\mathrm{GEA2}}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}}  \\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}} - \\frac{5 \\cdot 3^{-1/3}}{16 \\pi^{4/3}} \\end{pmatrix}}\n$$", "id": "2901403"}, {"introduction": "The failure of local and semi-local functionals to correctly describe the asymptotic behavior of the exchange potential is a direct consequence of self-interaction error. Orbital-dependent functionals, such as those based on the Optimized Effective Potential (OEP) method, offer a systematic solution. In this practice, you will implement the Krieger-Li-Iafrate (KLI) approximation to the exact exchange potential and numerically verify its correct $-1/r$ asymptotic decay, contrasting it with the incorrect exponential decay of the LDA potential [@problem_id:2901394].", "problem": "You are to implement a numerical comparison of the Krieger–Li–Iafrate (KLI) approximation to the Optimized Effective Potential (OEP) exchange potential for a spherically symmetric atom against the Local Density Approximation (LDA) exchange potential. Your implementation must be based on first principles consistent with the Kohn–Sham (KS) approach of orbital-based Density Functional Theory (DFT), within the following constraints and assumptions.\n\nWork entirely in Hartree atomic units, so that lengths are in bohr and potentials and energies are in hartree. Consider a spin-unpolarized, spherically symmetric, single-orbital KS system of either one or two electrons bound to a nucleus of charge $Z$. Use the spherically symmetric hydrogenic $1s$ orbital density\n$$\nn(r) = N \\frac{Z^{3}}{\\pi} e^{-2 Z r},\n$$\nwhere $N \\in \\{1,2\\}$ denotes the number of electrons occupying the single spatial orbital. In nonrelativistic KS theory with exchange only, the electron–electron Hartree potential for a spherically symmetric density is given by the standard electrostatics result\n$$\nv_{\\mathrm{H}}(r) = 4\\pi \\left[ \\frac{1}{r} \\int_{0}^{r} r'^{2} n(r')\\,dr' + \\int_{r}^{\\infty} r' n(r')\\,dr' \\right].\n$$\nThe LDA exchange potential for a spin-unpolarized system is the Dirac uniform-electron-gas result,\n$$\nv_{x}^{\\mathrm{LDA}}(r) = - \\left(\\frac{3}{\\pi}\\right)^{1/3} n(r)^{1/3}.\n$$\nUsing only these base definitions and the definition of the exchange-only OEP for orbital-dependent functionals, derive the KLI exchange potential for the above single-orbital cases and express it in terms of $v_{\\mathrm{H}}(r)$ and $N$. Then implement both $v_{x}^{\\mathrm{KLI}}(r)$ and $v_{x}^{\\mathrm{LDA}}(r)$ numerically on a radial grid using the hydrogenic $n(r)$ and the spherical $v_{\\mathrm{H}}(r)$ integral. You must choose a uniform radial grid $r \\in [r_{\\min}, R_{\\max}]$ with $r_{\\min}  0$ and $R_{\\max}$ sufficiently large so that the density is negligible at $R_{\\max}$ for all specified test cases. Use a numerically stable quadrature scheme to evaluate the integrals that define $v_{\\mathrm{H}}(r)$.\n\nTo compare asymptotics, for each test case define the tail radius\n$$\nr_{\\mathrm{tail}} = \\frac{20}{Z},\n$$\nand compute the following two tail-coefficient estimators:\n$$\nc_{\\mathrm{KLI}}(Z,N) = r_{\\mathrm{tail}}\\, v_{x}^{\\mathrm{KLI}}(r_{\\mathrm{tail}}), \\qquad\nc_{\\mathrm{LDA}}(Z,N) = r_{\\mathrm{tail}}\\, v_{x}^{\\mathrm{LDA}}(r_{\\mathrm{tail}}).\n$$\nThese scalings diagnose whether $v_{x}(r)$ decays as $-A/r$ with a finite coefficient $A$ (the estimator approaches $-A$) or faster than any power of $r$ (the estimator approaches $0$). All potentials and distances must be in Hartree atomic units, and you must output the tail-coefficient estimators as real numbers rounded to six decimal places.\n\nTest suite and required output:\n- Implement your program to evaluate $c_{\\mathrm{KLI}}$ and $c_{\\mathrm{LDA}}$ for the following parameter sets, each specified by $(Z,N)$:\n    - Test $1$: $(Z,N) = (1,1)$.\n    - Test $2$: $(Z,N) = (2,1)$.\n    - Test $3$: $(Z,N) = (2,2)$.\n    - Test $4$: $(Z,N) = (5,2)$.\n- For each test, compute and report the pair $\\left[c_{\\mathrm{KLI}}(Z,N),\\, c_{\\mathrm{LDA}}(Z,N)\\right]$, each rounded to six decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list of the four pairs in the order of the tests, enclosed in square brackets. For example, the output format must be\n$$\n[\\,[c_{\\mathrm{KLI}}^{(1)},c_{\\mathrm{LDA}}^{(1)}],\\,[c_{\\mathrm{KLI}}^{(2)},c_{\\mathrm{LDA}}^{(2)}],\\,[c_{\\mathrm{KLI}}^{(3)},c_{\\mathrm{LDA}}^{(3)}],\\,[c_{\\mathrm{KLI}}^{(4)},c_{\\mathrm{LDA}}^{(4)}]\\,].\n$$\nNo other text may be printed.\n\nYour implementation must be fully self-contained, require no input, and run deterministically. All mathematical steps must be consistent with the above fundamental definitions and with Kohn–Sham orbital-based density functional theory. Use only the allowed runtime and libraries as specified in the final answer block. Ensure that all floating-point outputs are rounded to six decimal places as required. All computations must be performed in Hartree atomic units, and all distances must be in bohr. Angles are not involved. Percentages are not involved. The final outputs are real numbers only, rounded to six decimal places, and organized into a list of lists as described.", "solution": "The supplied problem is assessed to be valid. It is scientifically grounded in established principles of density functional theory, is well-posed with all necessary information provided, and is stated using objective, formal language. The problem is a standard exercise in computational quantum chemistry that requires both analytical derivation and numerical implementation, testing fundamental concepts such as the Optimized Effective Potential (OEP) method, the Krieger–Li–Iafrate (KLI) approximation, and the Local Density Approximation (LDA). We may therefore proceed with the solution.\n\nThe objective is to derive the KLI exchange potential, $v_{x}^{\\mathrm{KLI}}(r)$, for a single-orbital Kohn-Sham (KS) system and compare its asymptotic behavior to that of the LDA exchange potential, $v_{x}^{\\mathrm{LDA}}(r)$. All calculations are performed in Hartree atomic units.\n\nThe system consists of $N$ electrons, where $N \\in \\{1, 2\\}$, occupying a single spherically symmetric spatial orbital. The electron density is given by a hydrogenic $1s$ form:\n$$\nn(r) = N \\frac{Z^{3}}{\\pi} e^{-2 Z r}\n$$\nThis density corresponds to a single spatial orbital $\\psi(r) = \\sqrt{Z^3/\\pi} e^{-Zr}$ with a total occupation of $N$.\n\nFirst, we derive the KLI exchange potential, $v_{x}^{\\mathrm{KLI}}(r)$. The KLI potential is an approximation to the exact orbital-dependent exchange potential of the OEP method. For a system with only one occupied spatial orbital per spin channel, the KLI potential is equivalent to the exact OEP potential, which is given by the so-called Slater potential shifted by a constant.\n\nCase $N=1$: The system contains a single electron. In this case, there is no true electron-electron interaction. The Hartree energy, $E_{\\mathrm{H}}[n]$, represents a spurious self-interaction which must be exactly cancelled by the exchange energy, $E_x[n]$. Therefore, the total electron interaction potential, $v_{\\mathrm{H}}(r) + v_x(r)$, must be zero. This requires that the exchange potential exactly cancels the Hartree potential:\n$$\nv_x(r) = -v_{\\mathrm{H}}(r)\n$$\nFor a one-electron system, this is the exact exchange potential. The OEP formalism, and thus the KLI approximation, must reproduce this exact result. The density is $n(r)$ with $N=1$.\n$$\nv_{x}^{\\mathrm{KLI}}(r) = -v_{\\mathrm{H}}(r) \\quad (\\text{for } N=1)\n$$\n\nCase $N=2$: The system contains two electrons in a single spatial orbital, forming a spin-unpolarized, closed-shell singlet state. We have one spin-up electron and one spin-down electron, with densities $n_{\\uparrow}(r) = n_{\\downarrow}(r) = n(r)/2$. The exchange interaction occurs only between electrons of like spin. Thus, the total exchange energy is the sum of the self-exchange energies for the spin-up and spin-down densities: $E_x = E_x[n_{\\uparrow}] + E_x[n_{\\downarrow}]$. For each spin channel $\\sigma \\in \\{\\uparrow, \\downarrow\\}$, there is only one orbital. The orbital-specific potential required for the OEP equation is $u_{x\\sigma}(r) = \\delta E_x / \\delta n_{\\sigma}(r) = -v_{\\mathrm{H}}[n_{\\sigma}](r)$. The exact exchange potential for spin channel $\\sigma$ is $v_{x\\sigma}(r) = u_{x\\sigma}(r) + C_{\\sigma} = -v_{\\mathrm{H}}[n_{\\sigma}](r) + C_{\\sigma}$, where $C_{\\sigma}$ is a constant. For an unpolarized system, $v_{x\\uparrow} = v_{x\\downarrow} = v_x$, and $n_{\\uparrow} = n_{\\downarrow} = n/2$. The constant $C$ is determined by the condition that the potential vanishes at infinity. The Hartree potential $v_{\\mathrm{H}}[n/2](r)$ decays as $Q/r = (\\int (n(r')/2) 4\\pi r'^2 dr') / r = 1/r$ for large $r$. Thus, to ensure $v_x(r) \\to 0$ as $r \\to \\infty$, we must set the constant $C=0$. The KLI potential is therefore:\n$$\nv_{x}^{\\mathrm{KLI}}(r) = -v_{\\mathrm{H}}[n(r)/2] \\quad (\\text{for } N=2)\n$$\nThe Hartree potential is linear in density, so $v_{\\mathrm{H}}[n/2] = v_{\\mathrm{H}}[n]/2$. This gives $v_{x}^{\\mathrm{KLI}}(r) = -v_{\\mathrm{H}}(r)/2$.\n\nWe can unify both cases into a single expression in terms of the total density $n(r)$ and the total number of electrons $N$:\n$$\nv_{x}^{\\mathrm{KLI}}(r) = -\\frac{1}{N}v_{\\mathrm{H}}(r)\n$$\nThis is the analytical expression for the KLI potential for the specified system.\n\nNext, we analyze the asymptotic behavior. The Hartree potential for a localized charge distribution with total charge $N$ behaves as $v_{\\mathrm{H}}(r) \\to N/r$ as $r \\to \\infty$. Consequently, the KLI potential has the asymptotic form:\n$$\nv_{x}^{\\mathrm{KLI}}(r) \\to -\\frac{1}{N}\\left(\\frac{N}{r}\\right) = -\\frac{1}{r}\n$$\nThis demonstrates the correct $-1/r$ decay of the exact exchange potential. The tail-coefficient estimator $c_{\\mathrm{KLI}} = r_{\\mathrm{tail}} v_{x}^{\\mathrm{KLI}}(r_{\\mathrm{tail}})$ will therefore approach $-1$ for a sufficiently large $r_{\\mathrm{tail}}$.\n\nIn contrast, the LDA exchange potential is given by:\n$$\nv_{x}^{\\mathrm{LDA}}(r) = - \\left(\\frac{3}{\\pi}\\right)^{1/3} n(r)^{1/3}\n$$\nSubstituting the expression for $n(r)$:\n$$\nv_{x}^{\\mathrm{LDA}}(r) = - \\left(\\frac{3}{\\pi}\\right)^{1/3} \\left(N \\frac{Z^{3}}{\\pi} e^{-2 Z r}\\right)^{1/3} = - \\left(\\frac{3N Z^3}{\\pi^2}\\right)^{1/3} e^{-2Zr/3}\n$$\nThis potential decays exponentially, which is qualitatively incorrect. The tail-coefficient estimator $c_{\\mathrm{LDA}} = r_{\\mathrm{tail}} v_{x}^{\\mathrm{LDA}}(r_{\\mathrm{tail}})$ will approach $0$ due to the exponential factor $e^{-2Zr_{\\mathrm{tail}}/3}$.\n\nFor the numerical implementation, we must compute $v_{\\mathrm{H}}(r)$ at the specified tail radius $r_{\\mathrm{tail}} = 20/Z$. The problem mandates using a numerical quadrature scheme. The Hartree potential is defined as:\n$$\nv_{\\mathrm{H}}(r) = 4\\pi \\left[ \\frac{1}{r} \\int_{0}^{r} r'^{2} n(r')\\,dr' + \\int_{r}^{\\infty} r' n(r')\\,dr' \\right]\n$$\nFor each test case $(Z, N)$, we calculate $r_{\\mathrm{tail}}$. The two integrals are computed numerically using the `scipy.integrate.quad` function, which is a robust adaptive quadrature routine. The upper limit of the second integral, $\\infty$, is replaced by a sufficiently large number $R_{\\max}$, chosen such that the density $n(R_{\\max})$ is negligible. A value of $R_{\\max} = 100/Z$ is more than adequate, as the exponential term $e^{-2ZR_{\\max}}$ becomes $e^{-200}$.\nWith $v_{\\mathrm{H}}(r_{\\mathrm{tail}})$ computed, we evaluate:\n$$\nc_{\\mathrm{KLI}}(Z,N) = r_{\\mathrm{tail}} \\left( -\\frac{1}{N}v_{\\mathrm{H}}(r_{\\mathrm{tail}}) \\right)\n$$\n$$\nc_{\\mathrm{LDA}}(Z,N) = r_{\\mathrm{tail}} \\left( - \\left(\\frac{3}{\\pi}\\right)^{1/3} n(r_{\\mathrm{tail}})^{1/3} \\right)\n$$\nThe results are then rounded to six decimal places as required. The implementation is encapsulated in a Python script that systematically processes the test suite and formats the output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes and compares the KLI and LDA exchange potential tail coefficients\n    for a single-orbital KS system.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1, 1),  # Test 1: (Z, N)\n        (2, 1),  # Test 2\n        (2, 2),  # Test 3\n        (5, 2),  # Test 4\n    ]\n\n    results = []\n    for Z, N in test_cases:\n        # Define constants for the current case.\n        # All calculations are in Hartree atomic units.\n\n        # Define the tail radius for asymptotic comparison.\n        r_tail = 20.0 / Z\n\n        # Define an integration upper bound R_max, large enough for the\n        # exponential density to be negligible.\n        R_max = 100.0 / Z\n\n        # Define the spherically symmetric electron density function n(r).\n        def n_func(r):\n            if r  0:\n                return 0.0\n            return N * (Z**3 / np.pi) * np.exp(-2 * Z * r)\n\n        # Define the integrands for the Hartree potential calculation.\n        def integrand1(r):\n            return r**2 * n_func(r)\n\n        def integrand2(r):\n            return r * n_func(r)\n\n        # Use numerical quadrature to compute the integrals for v_H(r).\n        # The quad function returns a tuple (result, error_estimate). We take the result [0].\n        I1, err1 = quad(integrand1, 0, r_tail)\n        I2, err2 = quad(integrand2, r_tail, R_max)\n\n        # Calculate the Hartree potential at r_tail.\n        v_H_tail = 4 * np.pi * (I1 / r_tail + I2)\n\n        # Calculate the KLI exchange potential at r_tail using the derived formula.\n        v_x_KLI_tail = -v_H_tail / N\n\n        # Calculate the KLI tail-coefficient estimator.\n        c_KLI = r_tail * v_x_KLI_tail\n\n        # Calculate the LDA exchange potential at r_tail.\n        n_at_tail = n_func(r_tail)\n        v_x_LDA_tail = -((3 / np.pi)**(1 / 3)) * (n_at_tail**(1 / 3))\n\n        # Calculate the LDA tail-coefficient estimator.\n        c_LDA = r_tail * v_x_LDA_tail\n\n        # Round the results to six decimal places as specified.\n        # We explicitly round the numbers first, then format them to ensure\n        # correct representation of trailing zeros.\n        c_KLI_rounded = round(c_KLI, 6)\n        c_LDA_rounded = round(c_LDA, 6)\n\n        results.append([c_KLI_rounded, c_LDA_rounded])\n\n    # Format the results into the required single-line string format.\n    # e.g., [[-1.000000,-0.000022],[-1.000000,-0.000011],...]\n    formatted_pairs = [f\"[{p[0]:.6f},{p[1]:.6f}]\" for p in results]\n    final_output = f\"[{','.join(formatted_pairs)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "2901394"}]}