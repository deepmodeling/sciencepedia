{"hands_on_practices": [{"introduction": "A robust relativistic calculation begins with a suitable basis set capable of describing both the large and small components of the Dirac spinor. The principle of kinetic balance provides a crucial link between these components. This exercise [@problem_id:2887145] offers a concrete, hands-on calculation to construct a small-component basis function from a large-component Gaussian using the Restricted Kinetic Balance (RKB) prescription, reinforcing the mathematical connection that prevents spurious, unphysical solutions.", "problem": "In relativistic quantum chemistry treatments based on the Douglas–Kroll–Hess (DKH) decoupling, the Restricted Kinetic Balance (RKB) prescription constructs small-component basis functions from given large-component basis functions via the relation $\\chi_{S} \\propto \\left(\\boldsymbol{\\sigma}\\cdot\\mathbf{p}\\right)\\chi_{L}$, where $\\boldsymbol{\\sigma}$ denotes the vector of Pauli matrices and $\\mathbf{p}$ is the momentum operator. Consider a single normalized large-component spinor basis function centered at the origin, with spatial part given by an $s$-type primitive Gaussian and a spin-up two-component spinor,\n$$\n\\chi_{L}(\\mathbf{r}) \\;=\\; g(\\mathbf{r})\\,\\xi,\\quad g(\\mathbf{r}) \\;=\\; N\\,\\exp\\!\\left(-\\alpha\\,r^{2}\\right),\\quad \\xi \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\n$$\nwhere $\\alpha>0$ is the Gaussian exponent and $N$ is the normalization constant. Work in atomic units so that $\\hbar = 1$, $m_{e} = 1$, and the momentum operator is $\\mathbf{p} = -\\,\\mathrm{i}\\,\\boldsymbol{\\nabla}$. Define the RKB small-component basis function by\n$$\n\\chi_{S}(\\mathbf{r}) \\;=\\; \\kappa\\,\\left(\\boldsymbol{\\sigma}\\cdot\\mathbf{p}\\right)\\chi_{L}(\\mathbf{r}),\n$$\nwith a real proportionality constant $\\kappa$. Determine the value of $\\kappa$ such that the small-component basis function is normalized, i.e.,\n$$\n\\int \\chi_{S}^{\\dagger}(\\mathbf{r})\\,\\chi_{S}(\\mathbf{r})\\,\\mathrm{d}^{3}\\mathbf{r} \\;=\\; 1.\n$$\nExpress your final answer as a closed-form analytic expression in terms of $\\alpha$ only. Use atomic units, and do not perform any numerical rounding. The final answer must be a single expression without units.", "solution": "The problem is valid as it is scientifically grounded in relativistic quantum chemistry, well-posed with a clear objective, and self-contained. I will proceed with the solution.\n\nThe objective is to determine the real proportionality constant $\\kappa$ such that the small-component spinor basis function $\\chi_{S}(\\mathbf{r})$ is normalized to unity. The normalization condition is given by:\n$$\n\\int \\chi_{S}^{\\dagger}(\\mathbf{r})\\,\\chi_{S}(\\mathbf{r})\\,\\mathrm{d}^{3}\\mathbf{r} = 1\n$$\nFirst, we must determine the normalization constant $N$ for the large-component basis function $\\chi_{L}(\\mathbf{r})$. The large component is given as $\\chi_{L}(\\mathbf{r}) = g(\\mathbf{r})\\xi$, where $g(\\mathbf{r}) = N\\exp(-\\alpha r^2)$ and $\\xi = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$. The normalization condition for $\\chi_L$ is $\\int \\chi_{L}^{\\dagger}(\\mathbf{r})\\chi_{L}(\\mathbf{r})\\,\\mathrm{d}^{3}\\mathbf{r} = 1$.\nThe integrand is $\\chi_{L}^{\\dagger}\\chi_{L} = (g^{*}(\\mathbf{r})\\xi^{\\dagger})(g(\\mathbf{r})\\xi) = |g(\\mathbf{r})|^2 (\\xi^{\\dagger}\\xi)$. Since $g(\\mathbf{r})$ is real, $|g(\\mathbf{r})|^2 = g(\\mathbf{r})^2 = N^2 \\exp(-2\\alpha r^2)$. The spinor part is $\\xi^{\\dagger}\\xi = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = 1$.\nThus, the normalization condition for $\\chi_L$ becomes:\n$$\n\\int N^2 \\exp(-2\\alpha r^2) \\,\\mathrm{d}^{3}\\mathbf{r} = 1\n$$\nThis is a standard Gaussian integral in three dimensions. The integral of $\\exp(-ar^2)$ over all space is $(\\pi/a)^{3/2}$. With $a = 2\\alpha$, we have:\n$$\nN^2 \\left(\\frac{\\pi}{2\\alpha}\\right)^{3/2} = 1\n$$\nSolving for $N^2$, we find the square of the normalization constant for the large component:\n$$\nN^2 = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2}\n$$\nNext, we construct the small-component function $\\chi_{S}(\\mathbf{r})$:\n$$\n\\chi_{S}(\\mathbf{r}) = \\kappa\\,(\\boldsymbol{\\sigma}\\cdot\\mathbf{p})\\chi_{L}(\\mathbf{r})\n$$\nUsing the momentum operator in atomic units, $\\mathbf{p} = -\\mathrm{i}\\boldsymbol{\\nabla}$, we have:\n$$\n\\chi_{S}(\\mathbf{r}) = \\kappa (-\\mathrm{i}\\boldsymbol{\\sigma}\\cdot\\boldsymbol{\\nabla}) [N \\exp(-\\alpha r^2) \\xi] = -\\mathrm{i} \\kappa N [(\\boldsymbol{\\sigma}\\cdot\\boldsymbol{\\nabla})\\exp(-\\alpha r^2)] \\xi\n$$\nThe gradient of the Gaussian function is $\\boldsymbol{\\nabla}\\exp(-\\alpha r^2) = -2\\alpha\\mathbf{r}\\exp(-\\alpha r^2)$. Substituting this into the expression for $\\chi_S$:\n$$\n\\chi_{S}(\\mathbf{r}) = -\\mathrm{i} \\kappa N [\\boldsymbol{\\sigma}\\cdot(-2\\alpha\\mathbf{r})] \\exp(-\\alpha r^2) \\xi = 2\\mathrm{i}\\alpha N \\kappa (\\boldsymbol{\\sigma}\\cdot\\mathbf{r}) \\exp(-\\alpha r^2) \\xi\n$$\nNow, we set up the normalization integral for $\\chi_S$. First, we compute the integrand $\\chi_{S}^{\\dagger}\\chi_{S}$. The adjoint $\\chi_{S}^{\\dagger}$ is:\n$$\n\\chi_{S}^{\\dagger}(\\mathbf{r}) = [2\\mathrm{i}\\alpha N \\kappa (\\boldsymbol{\\sigma}\\cdot\\mathbf{r}) \\exp(-\\alpha r^2) \\xi]^{\\dagger} = -2\\mathrm{i}\\alpha N \\kappa \\exp(-\\alpha r^2) \\xi^{\\dagger} (\\boldsymbol{\\sigma}\\cdot\\mathbf{r})^{\\dagger}\n$$\nSince the components of $\\mathbf{r}$ are real and the Pauli matrices $\\sigma_i$ are Hermitian, $(\\boldsymbol{\\sigma}\\cdot\\mathbf{r})^{\\dagger} = \\boldsymbol{\\sigma}\\cdot\\mathbf{r}$. Thus:\n$$\n\\chi_{S}^{\\dagger}(\\mathbf{r}) = -2\\mathrm{i}\\alpha N \\kappa \\exp(-\\alpha r^2) \\xi^{\\dagger} (\\boldsymbol{\\sigma}\\cdot\\mathbf{r})\n$$\nThe product $\\chi_{S}^{\\dagger}\\chi_{S}$ is:\n$$\n\\chi_{S}^{\\dagger}\\chi_{S} = (-2\\mathrm{i}\\alpha N \\kappa \\exp(-\\alpha r^2) \\xi^{\\dagger} (\\boldsymbol{\\sigma}\\cdot\\mathbf{r}))(2\\mathrm{i}\\alpha N \\kappa (\\boldsymbol{\\sigma}\\cdot\\mathbf{r}) \\exp(-\\alpha r^2) \\xi)\n$$\n$$\n\\chi_{S}^{\\dagger}\\chi_{S} = 4(\\alpha N \\kappa)^2 \\exp(-2\\alpha r^2) \\xi^{\\dagger} (\\boldsymbol{\\sigma}\\cdot\\mathbf{r})^2 \\xi\n$$\nWe use the identity $(\\boldsymbol{\\sigma}\\cdot\\mathbf{A})(\\boldsymbol{\\sigma}\\cdot\\mathbf{B}) = (\\mathbf{A}\\cdot\\mathbf{B})I_2 + \\mathrm{i}\\boldsymbol{\\sigma}\\cdot(\\mathbf{A}\\times\\mathbf{B})$, where $I_2$ is the $2 \\times 2$ identity matrix. For $\\mathbf{A} = \\mathbf{B} = \\mathbf{r}$, this simplifies to $(\\boldsymbol{\\sigma}\\cdot\\mathbf{r})^2 = (\\mathbf{r}\\cdot\\mathbf{r})I_2 + \\mathrm{i}\\boldsymbol{\\sigma}\\cdot(\\mathbf{r}\\times\\mathbf{r}) = r^2 I_2$, since $\\mathbf{r}\\times\\mathbf{r} = \\mathbf{0}$.\nSubstituting this into the expression for $\\chi_{S}^{\\dagger}\\chi_{S}$:\n$$\n\\chi_{S}^{\\dagger}\\chi_{S} = 4(\\alpha N \\kappa)^2 \\exp(-2\\alpha r^2) \\xi^{\\dagger} (r^2 I_2) \\xi = 4(\\alpha N \\kappa)^2 r^2 \\exp(-2\\alpha r^2) (\\xi^{\\dagger}\\xi)\n$$\nSince $\\xi^{\\dagger}\\xi = 1$, the integrand is the scalar function:\n$$\n\\chi_{S}^{\\dagger}\\chi_{S} = 4\\alpha^2 N^2 \\kappa^2 r^2 \\exp(-2\\alpha r^2)\n$$\nThe normalization condition is therefore:\n$$\n\\int 4\\alpha^2 N^2 \\kappa^2 r^2 \\exp(-2\\alpha r^2) \\,\\mathrm{d}^{3}\\mathbf{r} = 1\n$$\n$$\n4\\alpha^2 N^2 \\kappa^2 \\int r^2 \\exp(-2\\alpha r^2) \\,\\mathrm{d}^{3}\\mathbf{r} = 1\n$$\nTo evaluate the integral $\\int r^2 \\exp(-ar^2) \\,\\mathrm{d}^{3}\\mathbf{r}$ with $a=2\\alpha$, we can differentiate the standard Gaussian integral with respect to the parameter $a$:\n$$\n\\int \\exp(-ar^2)\\,\\mathrm{d}^{3}\\mathbf{r} = \\left(\\frac{\\pi}{a}\\right)^{3/2}\n$$\n$$\n\\int r^2 \\exp(-ar^2) \\,\\mathrm{d}^{3}\\mathbf{r} = -\\frac{\\mathrm{d}}{\\mathrm{d}a} \\int \\exp(-ar^2)\\,\\mathrm{d}^{3}\\mathbf{r} = -\\frac{\\mathrm{d}}{\\mathrm{d}a} \\left(\\pi^{3/2} a^{-3/2}\\right) = -\\pi^{3/2} \\left(-\\frac{3}{2} a^{-5/2}\\right) = \\frac{3\\pi^{3/2}}{2} a^{-5/2}\n$$\nSubstituting $a = 2\\alpha$, the integral becomes $\\frac{3\\pi^{3/2}}{2}(2\\alpha)^{-5/2}$. Now we insert this and the expression for $N^2$ into the normalization equation:\n$$\n4\\alpha^2 \\kappa^2 \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2} \\left(\\frac{3\\pi^{3/2}}{2}(2\\alpha)^{-5/2}\\right) = 1\n$$\nSimplify the expression by combining terms:\n$$\n4\\alpha^2 \\kappa^2 \\frac{(2\\alpha)^{3/2}}{\\pi^{3/2}} \\frac{3\\pi^{3/2}}{2} (2\\alpha)^{-5/2} = 1\n$$\nThe $\\pi^{3/2}$ terms cancel:\n$$\n4\\alpha^2 \\kappa^2 \\frac{3}{2} (2\\alpha)^{3/2 - 5/2} = 1\n$$\n$$\n4\\alpha^2 \\kappa^2 \\frac{3}{2} (2\\alpha)^{-1} = 1\n$$\n$$\n4\\alpha^2 \\kappa^2 \\frac{3}{2} \\frac{1}{2\\alpha} = 1\n$$\n$$\n\\frac{12\\alpha^2 \\kappa^2}{4\\alpha} = 1\n$$\n$$\n3\\alpha\\kappa^2 = 1\n$$\nFinally, solving for $\\kappa$:\n$$\n\\kappa^2 = \\frac{1}{3\\alpha}\n$$\nSince $\\kappa$ is a real constant and $\\alpha>0$, we take the positive real root as is conventional for normalization constants:\n$$\n\\kappa = \\sqrt{\\frac{1}{3\\alpha}} = \\frac{1}{\\sqrt{3\\alpha}}\n$$", "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{3\\alpha}}}\n$$", "id": "2887145"}, {"introduction": "The Douglas-Kroll-Hess transformation changes the representation of the Hamiltonian, an effect known as a 'picture change'. To calculate properties consistently, all operators must be subjected to the same transformation. This practice [@problem_id:2887184] uses a minimal but powerful $2 \\times 2$ model to isolate and quantify the picture-change error, demonstrating why simply using an untransformed property operator with a transformed Hamiltonian leads to incorrect results.", "problem": "Construct a minimal, self-contained computational task that quantifies the picture-change (PC) error for a one-electron property when using the second-order Douglas-Kroll-Hess (DKH2) decoupling transformation. Start from the block structure of the one-electron Dirac Hamiltonian,\n$$\nH \\;=\\; \\beta\\,M \\;+\\; E \\;+\\; O,\n$$\nwhere $M \\equiv m c^2$ is a positive scalar, $\\beta$ is the $2\\times 2$ diagonal matrix with entries $+1$ and $-1$, $E$ is the even part (commutes with $\\beta$) and is therefore diagonal, and $O$ is the odd part (anticommutes with $\\beta$) and is therefore purely off-diagonal. Let $U=\\exp(i S)$ be the unitary decoupling transformation with an odd generator $S$ chosen such that the odd part of $H$ is removed to first order in the small parameter $1/M$ when expanding with the Baker-Campbell-Hausdorff (BCH) series. Work consistently to second order in $1/M$ to define the DKH2 effective even Hamiltonian and the corresponding second-order transformed (picture-changed) property operator. A one-electron property operator $A$ is assumed even (commutes with $\\beta$).\n\nYour program must implement the following, using only linear algebra and commutators as fundamental operations, without relying on any shortcut formulas given here in the problem statement:\n\n- Use the BCH expansion of $U^\\dagger H U$ with the odd generator $S$ selected to cancel the first-order odd contribution of $H$, and retain terms through second order in $1/M$ to obtain the even DKH2 Hamiltonian. Use this to identify the positive-energy projector $P_+ \\equiv (\\mathbf{1}+\\beta)/2$ corresponding to the upper two-spinor component in the decoupled representation.\n\n- Using the same BCH expansion through second order in $1/M$, transform the even property operator $A$ to its picture-changed form and project it onto the positive-energy subspace. Denote the resulting positive-energy property value as $\\langle A\\rangle_{\\mathrm{PC}}$.\n\n- Compute the corresponding untransformed (non-PC) positive-energy property value $\\langle A\\rangle_{\\mathrm{nonPC}}$ by projecting the original $A$ onto the positive-energy subspace in the decoupled representation of the DKH2 Hamiltonian constructed above.\n\n- Quantify the PC error introduced by neglecting picture change as the scalar difference\n$$\n\\Delta \\equiv \\langle A\\rangle_{\\mathrm{nonPC}} - \\langle A\\rangle_{\\mathrm{PC}}.\n$$\n\nRepresent all matrices in a minimal $2\\times 2$ model consistent with the even/odd structure:\n- $\\beta = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$.\n- $E = \\mathrm{diag}(e_u, e_l)$ with real scalars $e_u$ and $e_l$.\n- $O = \\begin{pmatrix} 0 & t \\\\ t & 0 \\end{pmatrix}$ with real scalar coupling $t$.\n- $A = \\mathrm{diag}(a_u, a_l)$ with real scalars $a_u$ and $a_l$.\n- $M > 0$ is a real scalar.\n\nAll quantities are treated as dimensionless for this exercise, so no physical units are required.\n\nYour program must evaluate the scalar error $\\Delta$ for each of the following five test cases, each specified by the tuple $(M, t, e_u, e_l, a_u, a_l)$:\n- Case $1$: $(1000.0, 0.8, 0.2, 0.2, 0.5, 0.5)$.\n- Case $2$: $(100.0, 0.5, 0.0, 0.0, 1.0, 2.0)$.\n- Case $3$: $(50.0, 0.0, 0.3, -0.1, -1.0, 1.0)$.\n- Case $4$: $(10.0, 1.5, 0.0, 0.0, 0.0, 1.0)$.\n- Case $5$: $(20.0, 3.0, 1.0, 1.5, 2.0, 1.0)$.\n\nImplementation requirements and guidance:\n- Treat commutators as $[X,Y] \\equiv XY - YX$.\n- Classify even and odd operators by their (anti)commutation with $\\beta$.\n- Use the BCH series for both the Hamiltonian and the property operator through second order in $1/M$, enforcing that the chosen odd generator $S$ eliminates the first-order odd terms of $H$.\n- Use the positive-energy projector $P_+ \\equiv (\\mathbf{1}+\\beta)/2$ to extract positive-energy values in the decoupled representation.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[x1,x2,x3,x4,x5]\"). Each list entry must be a floating-point number corresponding to $\\Delta$ for the respective test case, with reasonable floating-point formatting. No additional text should be printed.", "solution": "The problem as stated is scientifically grounded, well-posed, and free of contradictions. It presents a standard, albeit simplified, task in relativistic quantum chemistry: the derivation of the picture-change error for a one-electron property within the second-order Douglas-Kroll-Hess (DKH2) framework. We shall proceed with a formal derivation.\n\nThe objective is to compute the picture-change error $\\Delta \\equiv \\langle A\\rangle_{\\mathrm{nonPC}} - \\langle A\\rangle_{\\mathrm{PC}}$. This requires deriving the DKH2 decoupling transformation and its effect on the property operator $A$. The analysis will be performed consistently to second order in the expansion parameter $1/M$.\n\nThe one-electron Dirac Hamiltonian is given by $H = \\beta M + E + O$, where $H_E = \\beta M + E$ is the even part and $H_O = O$ is the odd part. The decoupling transformation is a unitary operator $U = \\exp(W)$, where the generator $W$ is anti-hermitian and odd, i.e., $\\{W, \\beta\\} = 0$ and $W^\\dagger = -W$. The transformed Hamiltonian is $H' = U^\\dagger H U = e^{-W} H e^{W}$. We use the Baker-Campbell-Hausdorff (BCH) expansion:\n$$ H' = H + [H, W] + \\frac{1}{2!} [[H, W], W] + \\dots $$\nThe generator $W$ is chosen to eliminate the odd part of $H$ to the lowest order. The odd part of $H'$ is, to first order, $H'_O \\approx O + [\\beta M + E, W]$. We demand the cancellation of the dominant terms:\n$$ O + [\\beta M, W] = 0 $$\nSince $W$ is odd, it anticommutes with $\\beta$, so $[\\beta, W] = \\beta W - W \\beta = \\beta W - (-\\beta W) = 2\\beta W$. The condition becomes:\n$$ O + 2M\\beta W = 0 \\implies W = -\\frac{1}{2M} \\beta O $$\nThis generator $W$ is of order $O(1/M)$. As $O$ and $\\beta$ are Hermitian, $\\beta O$ is anti-Hermitian, so $W$ is anti-Hermitian as required.\n\nNext, we evaluate the transformed property operator $A' = U^\\dagger A U = e^{-W} A e^{W}$. Since the operator $A$ is even, its BCH expansion is:\n$$ A' = A + [A, W] + \\frac{1}{2!} [[A, W], W] + \\dots $$\nWe must classify the terms by their even/odd character. $A$ is even and $W$ is odd.\n- $A$: even.\n- $[A, W]$: commutator of even and odd is odd.\n- $[[A, W], W]$: commutator of odd and odd is even.\nThus, the even part of $A'$ is $A'_E = A + \\frac{1}{2}[[A, W], W] + \\dots$.\nTo work consistently to order $O(1/M^2)$, we only need to evaluate the second term, as $W$ is $O(1/M)$.\n$$ [[A, W], W] = \\left[ \\left[A, -\\frac{1}{2M} \\beta O\\right], -\\frac{1}{2M} \\beta O \\right] = \\frac{1}{4M^2} [ [A, \\beta O], \\beta O ] $$\nSince $A$ is even, it commutes with $\\beta$, so $[A, \\beta O] = \\beta A O - \\beta O A = \\beta[A,O]$. Substituting this:\n$$ [[A, W], W] = \\frac{1}{4M^2} [\\beta[A,O], \\beta O] $$\nThe second-order picture-changed property operator (even part) is therefore:\n$$ A'_{E} = A + \\frac{1}{8M^2} [\\beta[A,O], \\beta O] $$\nThe picture-changed property value, $\\langle A\\rangle_{\\mathrm{PC}}$, is the positive-energy expectation value, obtained by projecting $A'_{E}$ onto the positive-energy subspace defined by the projector $P_+ = (\\mathbf{1}+\\beta)/2$. For the block-diagonal structure, this corresponds to the upper-left element of the matrix.\n\nThe non-picture-changed value, $\\langle A\\rangle_{\\mathrm{nonPC}}$, is obtained by projecting the original operator $A$ onto the same positive-energy subspace. In this basis, this is simply the upper-left element of $A$. Given the specified matrix forms:\n$A = \\begin{pmatrix} a_u & 0 \\\\ 0 & a_l \\end{pmatrix}$.\nThe projection yields the scalar value:\n$$ \\langle A\\rangle_{\\mathrm{nonPC}} = a_u $$\n\nTo find $\\langle A\\rangle_{\\mathrm{PC}}$, we compute the matrix form of the correction term. The matrices are:\n$\\beta = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$, $O = \\begin{pmatrix} 0 & t \\\\ t & 0 \\end{pmatrix}$.\nFirst, we compute the commutators:\n$$ [A,O] = \\begin{pmatrix} a_u & 0 \\\\ 0 & a_l \\end{pmatrix} \\begin{pmatrix} 0 & t \\\\ t & 0 \\end{pmatrix} - \\begin{pmatrix} 0 & t \\\\ t & 0 \\end{pmatrix} \\begin{pmatrix} a_u & 0 \\\\ 0 & a_l \\end{pmatrix} = \\begin{pmatrix} 0 & (a_u-a_l)t \\\\ -(a_u-a_l)t & 0 \\end{pmatrix} $$\n$$ \\beta[A,O] = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} \\begin{pmatrix} 0 & (a_u-a_l)t \\\\ -(a_u-a_l)t & 0 \\end{pmatrix} = (a_u-a_l) \\begin{pmatrix} 0 & t \\\\ t & 0 \\end{pmatrix} = (a_u-a_l)O $$\n$$ \\beta O = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} \\begin{pmatrix} 0 & t \\\\ t & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & t \\\\ -t & 0 \\end{pmatrix} $$\nNow the outer commutator, $[\\beta[A,O], \\beta O]$:\n$$ [\\beta[A,O], \\beta O] = [(a_u-a_l)O, \\beta O] = (a_u-a_l)[O, \\beta O] $$\n$$ [O, \\beta O] = O(\\beta O) - (\\beta O)O = -\\beta O^2 - \\beta O^2 = -2\\beta O^2 $$\n$O^2 = \\begin{pmatrix} 0 & t \\\\ t & 0 \\end{pmatrix} \\begin{pmatrix} 0 & t \\\\ t & 0 \\end{pmatrix} = \\begin{pmatrix} t^2 & 0 \\\\ 0 & t^2 \\end{pmatrix} = t^2\\mathbf{1}$.\nSo, $[O, \\beta O] = -2\\beta (t^2 \\mathbf{1}) = -2t^2\\beta$.\nThe full commutator is:\n$$ [\\beta[A,O], \\beta O] = (a_u-a_l)(-2t^2\\beta) = -2(a_u-a_l)t^2\\beta $$\nThe correction term in $A'_E$ is:\n$$ \\frac{1}{8M^2} [-2(a_u-a_l)t^2\\beta] = -\\frac{(a_u-a_l)t^2}{4M^2}\\beta $$\nThe picture-changed operator is:\n$$ A'_{E} = A - \\frac{(a_u-a_l)t^2}{4M^2}\\beta = \\begin{pmatrix} a_u & 0 \\\\ 0 & a_l \\end{pmatrix} - \\frac{(a_u-a_l)t^2}{4M^2}\\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} $$\nThe positive-energy projection (upper-left element) is:\n$$ \\langle A\\rangle_{\\mathrm{PC}} = a_u - \\frac{(a_u-a_l)t^2}{4M^2} $$\nFinally, the picture-change error $\\Delta$ is calculated as the difference:\n$$ \\Delta = \\langle A\\rangle_{\\mathrm{nonPC}} - \\langle A\\rangle_{\\mathrm{PC}} = a_u - \\left( a_u - \\frac{(a_u-a_l)t^2}{4M^2} \\right) $$\n$$ \\Delta = \\frac{(a_u-a_l)t^2}{4M^2} $$\nThis is the final analytical expression for the picture-change error to second order in $1/M$ for the given model. The parameters $e_u$ and $e_l$ from the operator $E$ do not appear in this final expression for $\\Delta$, as they only contribute to the DKH2 Hamiltonian, not to the picture change of operator $A$ at this order. We will now use this formula to compute the results for the given test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the picture-change (PC) error for a one-electron property\n    using the second-order Douglas-Kroll-Hess (DKH2) decoupling transformation\n    within a simplified 2x2 model.\n    \"\"\"\n\n    # Test cases are provided as tuples: (M, t, e_u, e_l, a_u, a_l)\n    test_cases = [\n        (1000.0, 0.8, 0.2, 0.2, 0.5, 0.5), # Case 1\n        (100.0, 0.5, 0.0, 0.0, 1.0, 2.0), # Case 2\n        (50.0, 0.0, 0.3, -0.1, -1.0, 1.0), # Case 3\n        (10.0, 1.5, 0.0, 0.0, 0.0, 1.0), # Case 4\n        (20.0, 3.0, 1.0, 1.5, 2.0, 1.0), # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        M, t, e_u, e_l, a_u, a_l = case\n\n        # The picture-change error Delta is derived from first principles using\n        # the Baker-Campbell-Hausdorff expansion for the transformed property\n        # operator A' = U_dagger * A * U, consistent to second order in 1/M.\n        # The untransformed property value is the (1,1) element of A, which is a_u.\n        # The transformed property value is the (1,1) element of the even part\n        # of A', which is a_u - (a_u - a_l) * t**2 / (4 * M**2).\n        # The error Delta is the difference between the two.\n        #\n        # Delta = <A>_nonPC - <A>_PC\n        #       = a_u - (a_u - (a_u - a_l) * t**2 / (4 * M**2))\n        #       = (a_u - a_l) * t**2 / (4 * M**2)\n\n        # M is given as a positive scalar, so no division by zero is expected.\n        delta = (a_u - a_l) * (t ** 2) / (4 * (M ** 2))\n        results.append(delta)\n\n    # Format the output as a comma-separated list in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2887184"}, {"introduction": "The DKH method is a powerful tool, but it is fundamentally an approximation based on a truncated series expansion. It is essential to understand the nature and magnitude of the errors introduced by this truncation. This final exercise [@problem_id:2887177] provides a direct comparison between the second-order DKH2 method and an exact two-component (X2C) solution within a solvable model, allowing you to quantify the error in the calculated molecular gradient and appreciate the trade-offs between computational cost and accuracy.", "problem": "A minimal, exactly solvable model can isolate the decoupling and picture-change content of the Douglas-Kroll-Hess (DKH) and exact two-component (X2C) frameworks for a one-electron, heavy-element diatomic in atomic units. Consider a single symmetry-adapted, one-electron state described by a two-by-two Dirac-like Hamiltonian $H(R)$ depending on the internuclear distance $R$ (in bohr):\n$$\nH(R) \\;=\\; \\begin{pmatrix}\nV(R) + m c^2 & T(R) \\\\\nT(R) & V(R) - m c^2\n\\end{pmatrix},\n$$\nwhere $m$ is the electron mass, $c$ is the speed of light, $V(R)$ is a scalar potential modeling the two-center electron-nucleus attraction, and $T(R)$ is an effective off-diagonal large-small coupling that decays with $R$. Use atomic units with $m = 1$, and define:\n- $V(R) = -\\dfrac{Z}{R}$, where $Z$ is an effective nuclear charge (dimensionless),\n- $T(R) = \\tau_0 \\exp(-\\alpha R)$ with $\\tau_0 > 0$ and $\\alpha > 0$ (both in atomic units).\n\nThe exact two-component (X2C) decoupling corresponds, in this model, to the exact positive-energy eigenvalue branch $E_+(R)$ obtained by diagonalizing $H(R)$. The second-order Douglas-Kroll-Hess (DKH2) approximation corresponds to truncating the one-electron unitary decoupling at order $1/c^2$, which in this model amounts to a second-order-in-$1/c$ expansion of the positive-energy eigenvalue. The Born-Oppenheimer electronic gradient is given, in the Hellmann-Feynman sense (neglecting orbital relaxation, which is consistent with the one-level model), by $g(R) = \\mathrm{d}E/\\mathrm{d}R$.\n\nYour task is to:\n- Derive from first principles, starting from the Hamiltonian $H(R)$ and the definitions above, the X2C gradient $g_{\\mathrm{X2C}}(R)$ and the DKH2 gradient $g_{\\mathrm{DKH2}}(R)$ to the stated orders. The derivation must only assume the Dirac form of $H(R)$, the definition of $V(R)$ and $T(R)$, the exact diagonalization for the X2C branch, and a series expansion in $1/c$ for the DKH2 branch. Use the chain rule and the Hellmann-Feynman theorem to obtain $g(R) = \\mathrm{d}E/\\mathrm{d}R$.\n- Implement both gradients in code and compute, for the test suite below, the differences $\\Delta g(R) = g_{\\mathrm{DKH2}}(R) - g_{\\mathrm{X2C}}(R)$ in Hartree per bohr. Attribute any observed nonzero $\\Delta g(R)$ to specific operator-transformation approximations inherent to DKH2 versus X2C, and verify limiting behavior.\n\nUse the following test suite of parameter sets $(Z,\\tau_0,\\alpha,R,c)$:\n- Case A (heavy-element, near-equilibrium): $(Z,\\tau_0,\\alpha,R,c)=\\left(80,600,1.2,2.5,137.035999084\\right)$.\n- Case B (heavier and shorter bond, stronger coupling): $(Z,\\tau_0,\\alpha,R,c)=\\left(92,800,1.5,1.5,137.035999084\\right)$.\n- Case C (long bond, weak coupling): $(Z,\\tau_0,\\alpha,R,c)=\\left(70,400,1.0,5.0,137.035999084\\right)$.\n- Case D (nonrelativistic limit, same as Case A but very large $c$): $(Z,\\tau_0,\\alpha,R,c)=\\left(80,600,1.2,2.5,10^6\\right)$.\n- Case E (no large-small coupling): $(Z,\\tau_0,\\alpha,R,c)=\\left(80,0,1.2,2.5,137.035999084\\right)$.\n\nAll gradients and differences must be expressed in atomic units, that is, Hartree per bohr. Your program should produce a single line of output containing the five numerical results $\\Delta g(R)$ for Cases A through E, as a comma-separated list enclosed in square brackets (e.g., \"[x1,x2,x3,x4,x5]\").", "solution": "The problem statement presented is a well-posed and scientifically grounded exercise in relativistic quantum chemistry, albeit using a simplified one-electron, two-state model. All definitions, parameters, and objectives are clearly stated, allowing for a rigorous and unique solution. The problem is therefore deemed valid. We proceed with the derivation and computation.\n\nThe one-electron, two-state model Hamiltonian is given as:\n$$\nH(R) = \\begin{pmatrix}\nV(R) + m c^2 & T(R) \\\\\nT(R) & V(R) - m c^2\n\\end{pmatrix}\n$$\nIn atomic units, the electron mass $m=1$. The Hamiltonian matrix is thus:\n$$\nH(R) = \\begin{pmatrix}\nV(R) + c^2 & T(R) \\\\\nT(R) & V(R) - c^2\n\\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ of this matrix are found by solving the characteristic equation $\\det(H(R) - \\lambda I) = 0$:\n$$\n(V(R) + c^2 - \\lambda)(V(R) - c^2 - \\lambda) - T(R)^2 = 0\n$$\n$$\n(V(R) - \\lambda)^2 - c^4 - T(R)^2 = 0\n$$\n$$\n(V(R) - \\lambda)^2 = c^4 + T(R)^2\n$$\nThis yields two eigenvalue branches:\n$$\n\\lambda_{\\pm}(R) = V(R) \\pm \\sqrt{c^4 + T(R)^2}\n$$\nThe problem explicitly defines the exact two-component (X2C) energy as the \"exact positive-energy eigenvalue branch $E_+(R)$\". Given that $c$ is large, $\\sqrt{c^4 + T(R)^2}$ is a large positive number. The scalar potential $V(R) = -Z/R$ is negative but its magnitude is typically much smaller than $c^2$. Therefore, the positive eigenvalue is unambiguously $\\lambda_+(R)$.\n$$\nE_{\\mathrm{X2C}}(R) = \\lambda_+(R) = V(R) + \\sqrt{c^4 + T(R)^2}\n$$\nThe electronic gradient is the derivative of the energy with respect to the internuclear distance $R$, $g(R) = \\mathrm{d}E/\\mathrm{d}R$. The problem statement permits the use of the Hellmann-Feynman theorem, but a direct differentiation of the algebraic eigenvalue expression is equivalent and more direct for this model. We find the X2C gradient, $g_{\\mathrm{X2C}}(R)$, by differentiating $E_{\\mathrm{X2C}}(R)$:\n$$\ng_{\\mathrm{X2C}}(R) = \\frac{\\mathrm{d}E_{\\mathrm{X2C}}}{\\mathrm{d}R} = \\frac{\\mathrm{d}V}{\\mathrm{d}R} + \\frac{\\mathrm{d}}{\\mathrm{d}R}\\left(c^4 + T(R)^2\\right)^{1/2}\n$$\nUsing the chain rule, this becomes:\n$$\ng_{\\mathrm{X2C}}(R) = \\frac{\\mathrm{d}V}{\\mathrm{d}R} + \\frac{1}{2}\\left(c^4 + T(R)^2\\right)^{-1/2} \\cdot \\left(2T(R)\\frac{\\mathrm{d}T}{\\mathrm{d}R}\\right) = \\frac{\\mathrm{d}V}{\\mathrm{d}R} + \\frac{T(R)\\frac{\\mathrm{d}T}{\\mathrm{d}R}}{\\sqrt{c^4 + T(R)^2}}\n$$\nWe compute the derivatives of the given potential and coupling functions:\n$$\nV(R) = -\\frac{Z}{R} \\implies \\frac{\\mathrm{d}V}{\\mathrm{d}R} = \\frac{Z}{R^2}\n$$\n$$\nT(R) = \\tau_0 \\exp(-\\alpha R) \\implies \\frac{\\mathrm{d}T}{\\mathrm{d}R} = -\\alpha \\tau_0 \\exp(-\\alpha R) = -\\alpha T(R)\n$$\nSubstituting these into the expression for $g_{\\mathrm{X2C}}(R)$:\n$$\ng_{\\mathrm{X2C}}(R) = \\frac{Z}{R^2} - \\frac{\\alpha T(R)^2}{\\sqrt{c^4 + T(R)^2}}\n$$\nThis is the exact gradient for the specified energy branch within this model.\n\nNext, we derive the second-order Douglas-Kroll-Hess (DKH2) energy and gradient. The problem states this corresponds to a second-order-in-$1/c$ expansion of the same positive-energy eigenvalue, $E_{\\mathrm{X2C}}(R)$. We expand $E_{\\mathrm{X2C}}(R)$ for large $c$:\n$$\nE_{\\mathrm{X2C}}(R) = V(R) + c^2\\left(1 + \\frac{T(R)^2}{c^4}\\right)^{1/2}\n$$\nUsing the binomial expansion $(1+x)^{1/2} \\approx 1 + \\frac{1}{2}x - \\frac{1}{8}x^2 + \\dots$ with $x = T(R)^2/c^4$:\n$$\nE_{\\mathrm{X2C}}(R) = V(R) + c^2\\left(1 + \\frac{1}{2}\\frac{T(R)^2}{c^4} - \\frac{1}{8}\\frac{T(R)^4}{c^8} + O(c^{-12})\\right)\n$$\n$$\nE_{\\mathrm{X2C}}(R) = V(R) + c^2 + \\frac{T(R)^2}{2c^2} - \\frac{T(R)^4}{8c^6} + \\dots\n$$\nThe DKH formalism constructs an effective electronic Hamiltonian, so the divergent rest-mass term $c^2$ is removed. Truncating the expansion at order $1/c^2$ gives the DKH2 energy:\n$$\nE_{\\mathrm{DKH2}}(R) = V(R) + \\frac{T(R)^2}{2c^2}\n$$\nWe find the DKH2 gradient, $g_{\\mathrm{DKH2}}(R)$, by differentiating this expression:\n$$\ng_{\\mathrm{DKH2}}(R) = \\frac{\\mathrm{d}E_{\\mathrm{DKH2}}}{\\mathrm{d}R} = \\frac{\\mathrm{d}V}{\\mathrm{d}R} + \\frac{1}{2c^2}\\frac{\\mathrm{d}}{\\mathrm{d}R}(T(R)^2) = \\frac{\\mathrm{d}V}{\\mathrm{d}R} + \\frac{T(R)\\frac{\\mathrm{d}T}{\\mathrm{d}R}}{c^2}\n$$\nSubstituting the derivatives $\\mathrm{d}V/\\mathrm{d}R$ and $\\mathrm{d}T/\\mathrm{d}R$:\n$$\ng_{\\mathrm{DKH2}}(R) = \\frac{Z}{R^2} - \\frac{\\alpha T(R)^2}{c^2}\n$$\nThe task is to compute the difference $\\Delta g(R) = g_{\\mathrm{DKH2}}(R) - g_{\\mathrm{X2C}}(R)$:\n$$\n\\Delta g(R) = \\left(\\frac{Z}{R^2} - \\frac{\\alpha T(R)^2}{c^2}\\right) - \\left(\\frac{Z}{R^2} - \\frac{\\alpha T(R)^2}{\\sqrt{c^4 + T(R)^2}}\\right)\n$$\n$$\n\\Delta g(R) = \\alpha T(R)^2 \\left(\\frac{1}{\\sqrt{c^4 + T(R)^2}} - \\frac{1}{c^2}\\right)\n$$\nThis expression can be rewritten for better numerical stability and insight:\n$$\n\\Delta g(R) = \\frac{\\alpha T(R)^2}{c^2} \\left(\\frac{1}{\\sqrt{1 + T(R)^2/c^4}} - 1\\right)\n$$\nThis is the final expression for the difference in gradients. The non-zero value of $\\Delta g(R)$ originates from the fundamental approximation of the DKH2 method: it is a truncated series expansion of the exact decoupling transformation. While X2C is exact within the model, DKH2 neglects terms of order $1/c^4$ and higher in the effective one-electron Hamiltonian. The error in energy is of order $T(R)^4/c^6$, and its derivative with respect to $R$ gives the leading term in the gradient error, $\\Delta g(R) \\approx -\\alpha T(R)^4 / (2c^6)$, which is consistent with our derived formula.\n\nAnalysis of limiting cases confirms the validity of the derivation:\n- For $c \\to \\infty$ (Case D), the term $T(R)^2/c^4 \\to 0$, causing the term in parentheses to approach $0$. Thus, $\\Delta g(R) \\to 0$, correctly showing that DKH2 becomes exact in the non-relativistic limit.\n- For $\\tau_0 \\to 0$ (Case E), $T(R) \\to 0$, which immediately forces $\\Delta g(R) = 0$. In the absence of large-small component coupling, the relativistic corrections modeled by $T(R)$ vanish, and both methods yield the same (non-relativistic) gradient.\n\nWe now implement the final formula for $\\Delta g(R)$ to compute the results for the given test suite.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the difference between DKH2 and X2C electronic gradients for a\n    simplified two-state Dirac-like model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Z, tau0, alpha, R, c)\n    test_cases = [\n        # Case A (heavy-element, near-equilibrium)\n        (80.0, 600.0, 1.2, 2.5, 137.035999084),\n        # Case B (heavier and shorter bond, stronger coupling)\n        (92.0, 800.0, 1.5, 1.5, 137.035999084),\n        # Case C (long bond, weak coupling)\n        (70.0, 400.0, 1.0, 5.0, 137.035999084),\n        # Case D (nonrelativistic limit, same as Case A but very large c)\n        (80.0, 600.0, 1.2, 2.5, 1.0e6),\n        # Case E (no large-small coupling)\n        (80.0, 0.0, 1.2, 2.5, 137.035999084),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        _Z, tau0, alpha, R, c = case\n        \n        # Handle the trivial case of τ₀ = 0, where T(R) is always 0.\n        if tau0 == 0.0:\n            delta_g = 0.0\n            results.append(delta_g)\n            continue\n        \n        # Calculate the coupling term T(R)\n        # T(R) = τ₀ * exp(-α * R)\n        T_R = tau0 * np.exp(-alpha * R)\n\n        # The derived formula for the gradient difference is:\n        # Δg(R) = α * T(R)² * ( 1/√(c⁴ + T(R)²) - 1/c² )\n        # A numerically more stable form is used for implementation:\n        # Δg(R) = (α * T(R)² / c²) * ( 1/√(1 + T(R)²/c⁴) - 1 )\n\n        c2 = c * c\n        \n        # Pre-compute factors for clarity\n        T2 = T_R * T_R\n        \n        # The first part of the expression\n        factor1 = alpha * T2 / c2\n        \n        # The second part of the expression in parentheses\n        # This part is sensitive to precision issues if T² << c⁴\n        x = T2 / (c2 * c2) # x = T(R)²/c⁴\n        \n        # (1 + x)^(-1/2) - 1 is computed. \n        # For small x, this is approx -x/2. Direct computation is fine with double precision.\n        factor2 = (1.0 / np.sqrt(1.0 + x)) - 1.0\n        \n        delta_g = factor1 * factor2\n        results.append(delta_g)\n\n    # Final print statement in the exact required format.\n    # Example format: [x1,x2,x3,x4,x5]\n    # Standard string conversion of floats is sufficient.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2887177"}]}