{"hands_on_practices": [{"introduction": "The foundation of any reliable computational study is a rigorous analysis of potential error sources. When a calculated property, such as a lattice constant, deviates from a known reference, it is crucial to systematically identify the cause. This exercise [@problem_id:2915024] places you in the role of a computational scientist tasked with designing a robust sensitivity analysis. You will learn to devise a protocol that methodically isolates the distinct contributions from plane-wave basis set incompleteness ($E_{\\text{cut}}$), discrete Brillouin zone sampling (the $k$-point mesh), and the core approximation of the pseudopotential itself, a foundational skill for producing reproducible and credible results.", "problem": "You are comparing calculated equilibrium lattice constants for gallium arsenide using a plane-wave basis with pseudopotentials to a trusted all-electron reference. Your calculation yields a value that is larger by approximately $1.5\\%$. You suspect contributions from three sources: plane-wave basis incompleteness (controlled by the kinetic energy cutoff $E_{\\text{cut}}$), Brillouin zone sampling error (controlled by the $k$-point mesh), and pseudopotential transferability (choice among norm-conserving, ultrasoft, and projector augmented-wave types, with the specific treatment of gallium $3d$ states). You must design a sensitivity analysis that attributes the discrepancy to these sources, using only well-established principles: that completeness of a plane-wave basis increases monotonically with the plane-wave kinetic energy cutoff $E_{\\text{cut}}$; that Brillouin zone integrals are approximated by discrete $k$-point meshes and converge as the sampling density increases; and that pseudopotentials approximate the interaction of valence electrons with the ionic core, whose transferability must be validated by cross-checks across potential types and valence partitions. The design should avoid confounding variables by varying one control at a time and should include cross-checks with multiple pseudopotential types.\n\nWhich of the following analysis protocols most reliably isolates the contributions of basis, $k$-point, and pseudopotential errors, and includes necessary cross-checks to attribute the observed $1.5\\%$ discrepancy?\n\nA. Simultaneously scale $E_{\\text{cut}}$ and the linear density of the $k$-mesh together (for example, doubling both at each step), and fully relax the structure at each combined setting until forces are below $10^{-3}$ eV Å$^{-1}$. Use a single projector augmented-wave pseudopotential set throughout. If the discrepancy persists after two or three such scalings, attribute it to the exchange–correlation functional, since both basis and $k$-points were increased in tandem.\n\nB. At fixed experimental volume and cell shape, perform a plane-wave cutoff convergence by increasing $E_{\\text{cut}}$ until total energy changes are below $1$ meV atom$^{-1}$ and all stress tensor components change by less than $0.1$ GPa between successive $E_{\\text{cut}}$ values, using a sufficiently dense $k$-mesh and fixed smearing appropriate for a semiconductor. Fit the total energy versus $E_{\\text{cut}}$ to a smooth asymptotic form to estimate the $E_{\\text{cut}} \\to \\infty$ limit. Next, holding $E_{\\text{cut}}$ at the converged value, converge the $k$-point mesh density (for example, $\\Gamma$-centered Monkhorst–Pack meshes) using a consistent integration scheme (for example, tetrahedron or fixed-width smearing), and, if needed, extrapolate to the infinite-mesh limit. Only after both controls are converged, repeat the calculation with multiple pseudopotentials: norm-conserving and ultrasoft with gallium $3d$ treated as core versus as valence, and projector augmented-wave datasets. For each pseudopotential, reestablish $E_{\\text{cut}}$ and $k$-point convergence at the same numerical tolerances, then re-relax the structure and compare the resulting lattice constants; optionally include a single-point cross-check against an all-electron reference if available. Attribute any residual differences across pseudopotentials, after basis and $k$-point convergence, to pseudopotential transferability.\n\nC. Use a single uniform $E_{\\text{cut}}$ chosen from the pseudopotential generator’s recommended minimum across all pseudopotentials, and a $\\Gamma$-only $k$-point. If the discrepancy remains, increase the electronic smearing width by a factor of $2$ to stabilize the self-consistent field cycle. Attribute any remaining difference to pseudopotential error because both basis and $k$-point settings were held fixed.\n\nD. First converge the $k$-point mesh using a low $E_{\\text{cut}}$ that keeps the calculation inexpensive, then assume that the $E_{\\text{cut}}$ required for energy convergence is similar at the converged $k$-mesh. Compare only norm-conserving pseudopotentials with gallium $3d$ in the core. If these agree within $5$ meV atom$^{-1}$, conclude that the pseudopotential is not the source and attribute the $1.5\\%$ discrepancy to basis-set error.\n\nE. Perform full volume optimizations at three $E_{\\text{cut}}$ values spaced by $10$ Ry, fitting an equation of state each time; choose the smallest $E_{\\text{cut}}$ that yields a lattice constant within $0.2\\%$ of the next larger $E_{\\text{cut}}$. Then test $k$-point meshes until total energies change by less than $10$ meV atom$^{-1}$. If the $1.5\\%$ discrepancy persists, switch to a different norm-conserving pseudopotential library; if the lattice constant shifts by less than $0.1\\%$, declare the pseudopotential acceptable and attribute the remaining error to $k$-points.", "solution": "The problem statement is a valid and well-posed question in the field of computational materials science. It describes a standard scenario encountered when performing Density Functional Theory ($DFT$) calculations with a plane-wave basis set and pseudopotentials. The identified sources of error—plane-wave basis incompleteness ($E_{\\text{cut}}$), Brillouin zone sampling ($k$-points), and pseudopotential choice—are the primary numerical parameters that must be converged to obtain accurate results. The goal is to design a protocol that correctly isolates the contribution of each error source to a $1.5\\%$ discrepancy in the calculated lattice constant of gallium arsenide ($GaAs$).\n\nA scientifically rigorous sensitivity analysis must adhere to the fundamental principle of varying only one parameter at a time. Confounding variables, by changing multiple parameters simultaneously, makes it impossible to attribute observed changes to a specific source. A proper protocol for this problem must sequentially converge the numerical parameters before assessing the physical approximation (the pseudopotential).\n\nThe correct procedure is as follows:\n1.  Select a pseudopotential.\n2.  Choose a very dense $k$-point mesh to minimize its error contribution during basis set convergence. At a fixed geometry (e.g., the experimental lattice constant), calculate the total energy or stress tensor for a sequence of increasing plane-wave kinetic energy cutoffs, $E_{\\text{cut}}$. The cutoff is considered converged when the chosen observable (e.g., total energy per atom) changes by less than a strict tolerance between the last two cutoff values.\n3.  Using the converged value of $E_{\\text{cut}}$, converge the $k$-point mesh. Calculate the total energy for a sequence of increasingly dense $k$-point meshes (e.g., $4 \\times 4 \\times 4$, $6 \\times 6 \\times 6$, etc.). The mesh is considered converged when the total energy changes by less than a strict tolerance.\n4.  With both $E_{\\text{cut}}$ and the $k$-point mesh converged, perform the full structural relaxation (geometry optimization) to find the equilibrium lattice constant. The result of this calculation represents the prediction for the chosen pseudopotential, converged with respect to basis and $k$-points.\n5.  To assess the pseudopotential error, repeat the entire procedure (steps $1-4$) with different pseudopotentials. This must include different types (norm-conserving, ultrasoft, projector-augmented wave) and, critically for gallium, different valence configurations (i.e., treating the Ga $3d$ states as core vs. as valence electrons). The spread in the final, converged lattice constants is a measure of the pseudopotential transferability error. The deviation from a trusted all-electron calculation quantifies the absolute error of each pseudopotential.\n\nBased on this correct methodology, we evaluate each of the proposed options.\n\n**Option A:** This protocol suggests simultaneously scaling $E_{\\text{cut}}$ and the $k$-mesh density. This is fundamentally flawed as it introduces confounding variables. An observed change in the lattice constant cannot be uniquely attributed to either basis set improvement or better Brillouin zone sampling, as both are changing. The conclusion to attribute persistent error to the exchange-correlation functional is a non-sequitur, as the contributions from the primary numerical parameters have not been properly isolated.\n**Verdict: Incorrect.**\n\n**Option B:** This protocol describes a systematic and rigorous procedure that aligns perfectly with the established best practices. It correctly separates the convergence of numerical parameters from the final calculation. First, it converges $E_{\\text{cut}}$ at a fixed, dense $k$-mesh. Second, it converges the $k$-mesh at the determined $E_{\\text{cut}}$. This sequential process correctly isolates the variables. Critically, it stipulates that this entire convergence study must be repeated for multiple pseudopotentials, including different types and valence treatments (Ga $3d$ states), and that the final converged results should be compared. This is the only way to reliably attribute the final error to the choice of pseudopotential. The protocol is methodical, sound, and designed to produce a defensible conclusion.\n**Verdict: Correct.**\n\n**Option C:** This protocol is grossly inadequate. Using a \"recommended minimum\" $E_{\\text{cut}}$ is almost never sufficient for a high-accuracy calculation of a structural property like a lattice constant. Using a $\\Gamma$-only $k$-point for a semiconductor like $GaAs$ will result in a very large, uncontrolled error in the Brillouin zone integration. Increasing electronic smearing is an inappropriate tool for a semiconductor and does not address basis set or $k$-point inadequacies. Attributing the error to the pseudopotential under these uncontrolled conditions is baseless.\n**Verdict: Incorrect.**\n\n**Option D:** This protocol inverts the correct convergence procedure. One should not converge the $k$-point mesh using a low, unconverged $E_{\\text{cut}}$. The level of $k$-point sampling required can depend on the basis set, and performing this test with an inadequate basis can give misleading results. The standard, robust procedure is to use a \"safe\" (over-converged) $k$-mesh to determine the required $E_{\\text{cut}}$, then use that $E_{\\text{cut}}$ to determine the minimal sufficient $k$-mesh. Furthermore, testing only norm-conserving pseudentials with a single valence configuration (Ga $3d$ in core) is an incomplete assessment of pseudopotential error. The largest errors often arise from the choice of valence partition or from differences between pseudopotential types (e.g., norm-conserving vs. projector-augmented wave).\n**Verdict: Incorrect.**\n\n**Option E:** This protocol uses a loose and unreliable method for convergence. Checking the lattice constant convergence at just three $E_{\\text{cut}}$ values is sparse. A convergence tolerance on a final property (lattice constant to $0.2\\%$) is less direct and less reliable than converging the total energy or forces to a tight tolerance (e.g., sub-meV). The logic for assessing the pseudopotential is also flawed. Finding that two different pseudopotentials give similar results (change less than $0.1\\%$) does not prove they are correct; they could both be subject to the same systematic error. Declaring the pseudopotential acceptable and blaming a large remaining $1.5\\%$ error on $k$-points is an unsubstantiated guess.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{B}$$", "id": "2915024"}, {"introduction": "Having established a strategy for isolating errors, we now focus on quantifying and mitigating one of the most significant: the finite plane-wave basis set. This practice [@problem_id:2915094] moves from high-level protocol to concrete data analysis. By analyzing a series of calculations performed at different energy cutoffs, you will derive and apply Richardson extrapolation to estimate the total energy in the complete basis set limit. This powerful technique allows you to not only achieve higher accuracy from a finite set of calculations but also to rigorously assess the convergence of energy differences, which are often the quantities of physical interest.", "problem": "A plane-wave Density Functional Theory (DFT) calculation with norm-conserving pseudopotentials is performed for two closely related configurations, denoted $A$ and $B$, in the same fixed cell and at the same $k$-point sampling. Let $E_{\\text{cut}}$ denote the kinetic energy cutoff. Assume the total energy for each configuration admits an asymptotic expansion in the high-cutoff regime of the form\n$$\nE_X(E_{\\text{cut}}) \\;=\\; E_X^{(\\infty)} \\;+\\; A_X\\,E_{\\text{cut}}^{-p} \\;+\\; B_X\\,E_{\\text{cut}}^{-(p+1)} \\;+\\; \\dots,\n$$\nwith $X \\in \\{A,B\\}$, $p>0$, and coefficients $A_X, B_X$ independent of $E_{\\text{cut}}$.\n\nYou are given three calculations at geometrically spaced cutoffs $E_1$, $E_2$, $E_3$ with a common ratio $r \\equiv E_2/E_1 = E_3/E_2$, namely $E_1 = 20$ Rydberg (Ry), $E_2 = 30$ Ry, $E_3 = 45$ Ry, for both configurations. The reported total energies (in electronvolts, eV) are:\n- Configuration $A$: $E_A(20) = -154.196$, $E_A(30) = -154.26544444444445$, $E_A(45) = -154.2963086419753$.\n- Configuration $B$: $E_B(20) = -154.1125$, $E_B(30) = -154.17777777777778$, $E_B(45) = -154.2067901234568$.\n\nStarting from the asymptotic model above and the variational character of plane-wave expansions, do the following:\n1. Using only the leading term $A_X E_{\\text{cut}}^{-p}$, derive a two-cutoff Richardson extrapolation formula that eliminates $A_X$ to estimate $E_X^{(\\infty)}$ from $E_X(E)$ and $E_X(rE)$ for a known exponent $p$. Then, using three geometrically spaced cutoffs, derive an estimator for $p$ in terms of ratios of successive energy differences.\n2. For the energy difference $\\Delta E(E_{\\text{cut}}) \\equiv E_B(E_{\\text{cut}}) - E_A(E_{\\text{cut}})$, derive the leading-order truncation error and show explicitly the condition under which the leading error cancels. State the resulting residual leading-order error when the exponents for $A$ and $B$ are equal, $p_A = p_B = p$, but the amplitudes differ, $A_B \\neq A_A$.\n3. Using the dataset above, estimate $p$ and the difference $\\Delta A \\equiv A_B - A_A$ from the three-cutoff data. Then, evaluate the magnitude of the leading-order truncation error in $\\Delta E$ at $E_{\\text{cut}} = 45$ Ry, expressed in millielectronvolts (meV). Round your final answer to four significant figures. Provide only a single number as your final answer.", "solution": "We begin by a strict validation of the problem statement.\n\n**Step 1: Extract Givens**\nThe problem provides the following information:\n- An asymptotic expansion for the total energy $E_X$ of configuration $X \\in \\{A, B\\}$ as a function of the kinetic energy cutoff $E_{\\text{cut}}$:\n$$E_X(E_{\\text{cut}}) = E_X^{(\\infty)} + A_X E_{\\text{cut}}^{-p} + B_X E_{\\text{cut}}^{-(p+1)} + \\dots$$\n- The exponent $p$ is positive, $p>0$.\n- The coefficients $A_X, B_X$ are independent of $E_{\\text{cut}}$.\n- Three calculations are performed at geometrically spaced cutoffs: $E_1 = 20$ Rydberg (Ry), $E_2 = 30$ Ry, and $E_3 = 45$ Ry.\n- The common ratio of the cutoffs is $r = E_2/E_1 = E_3/E_2 = 1.5$.\n- The total energies in electronvolts (eV) are:\n  - Configuration $A$: $E_A(20) = -154.196$, $E_A(30) = -154.26544444444445$, $E_A(45) = -154.2963086419753$.\n  - Configuration $B$: $E_B(20) = -154.1125$, $E_B(30) = -154.17777777777778$, $E_B(45) = -154.2067901234568$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem describes the convergence of total energy in a plane-wave basis set calculation, a fundamental topic in computational quantum chemistry and materials science. The asymptotic form provided is a standard model for the convergence of energy with respect to the kinetic energy cutoff, particularly for norm-conserving pseudopotentials. The variational nature of plane-wave calculations implies that the energy should decrease as the cutoff increases, which is consistent with the provided data for both configurations $A$ and $B$. The problem is scientifically sound and based on established principles.\n- **Well-Posed:** The problem provides a clear model, all necessary numerical data, and a sequence of well-defined tasks. It is self-contained and structured to lead to a unique solution.\n- **Objective:** The problem is stated in precise, quantitative terms, free from ambiguity or subjective content.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically valid, self-consistent, and well-posed. We shall proceed to the solution.\n\n**Part 1: Derivation of Extrapolation Formulas**\n\nWe consider the truncated asymptotic model, keeping only the leading error term:\n$E(E_{\\text{cut}}) \\approx E^{(\\infty)} + A E_{\\text{cut}}^{-p}$\nFor two cutoffs, $E$ and $rE$, we have a system of two equations:\n$$\n\\begin{cases}\nE(E) &\\approx E^{(\\infty)} + A E^{-p} \\\\\nE(rE) &\\approx E^{(\\infty)} + A (rE)^{-p} = E^{(\\infty)} + A r^{-p} E^{-p}\n\\end{cases}\n$$\nTo eliminate the term containing $A$, we multiply the second equation by $r^p$ and subtract the first equation:\n$r^p E(rE) - E(E) \\approx r^p E^{(\\infty)} - E^{(\\infty)} = (r^p-1)E^{(\\infty)}$\nSolving for $E^{(\\infty)}$ yields the two-cutoff Richardson extrapolation formula:\n$$E^{(\\infty)} \\approx \\frac{r^p E(rE) - E(E)}{r^p - 1}$$\nNext, to find an estimator for the exponent $p$, we use three geometrically spaced cutoffs: $E_1$, $E_2=rE_1$, and $E_3=rE_2=r^2E_1$. We define the successive energy differences:\n$\\delta_1 \\equiv E(E_2) - E(E_1) \\approx (E^{(\\infty)} + A E_2^{-p}) - (E^{(\\infty)} + A E_1^{-p}) = A(E_2^{-p} - E_1^{-p}) = A E_1^{-p} (r^{-p}-1)$\n$\\delta_2 \\equiv E(E_3) - E(E_2) \\approx (E^{(\\infty)} + A E_3^{-p}) - (E^{(\\infty)} + A E_2^{-p}) = A(E_3^{-p} - E_2^{-p}) = A E_2^{-p} (r^{-p}-1) = A (rE_1)^{-p} (r^{-p}-1)$\nThe ratio of these differences eliminates the unknown amplitude $A$:\n$\\frac{\\delta_2}{\\delta_1} \\approx \\frac{A (rE_1)^{-p} (r^{-p}-1)}{A E_1^{-p} (r^{-p}-1)} = r^{-p}$\nSolving for $p$ gives the estimator:\n$-p \\ln(r) = \\ln(\\frac{\\delta_2}{\\delta_1}) \\implies p = -\\frac{\\ln(\\delta_2/\\delta_1)}{\\ln(r)} = \\frac{\\ln(\\delta_1/\\delta_2)}{\\ln(r)}$\nThus, the estimator is $p \\approx \\frac{\\ln\\left( \\frac{E(E_2)-E(E_1)}{E(E_3)-E(E_2)} \\right)}{\\ln(r)}$.\n\n**Part 2: Analysis of Truncation Error in Energy Difference**\n\nThe energy difference is defined as $\\Delta E(E_{\\text{cut}}) \\equiv E_B(E_{\\text{cut}}) - E_A(E_{\\text{cut}})$. Using the provided expansion:\n$$ \\Delta E(E_{\\text{cut}}) = (E_B^{(\\infty)} - E_A^{(\\infty)}) + (A_B E_{\\text{cut}}^{-p_B} - A_A E_{\\text{cut}}^{-p_A}) + (B_B E_{\\text{cut}}^{-(p_B+1)} - B_A E_{\\text{cut}}^{-(p_A+1)}) + \\dots $$\nThe truncation error is the difference between the calculated value $\\Delta E(E_{\\text{cut}})$ and the converged value $\\Delta E^{(\\infty)} = E_B^{(\\infty)} - E_A^{(\\infty)}$:\n$$ \\text{Error}(\\Delta E) = \\Delta E(E_{\\text{cut}}) - \\Delta E^{(\\infty)} = (A_B E_{\\text{cut}}^{-p_B} - A_A E_{\\text{cut}}^{-p_A}) + \\dots $$\nThe leading-order truncation error is the term that decays most slowly as $E_{\\text{cut}} \\to \\infty$. Assuming without loss of generality that $p_A \\le p_B$, the leading term is $-A_A E_{\\text{cut}}^{-p_A}$ if $p_A < p_B$, and $(A_B-A_A)E_{\\text{cut}}^{-p}$ if $p_A = p_B = p$.\n\nThe leading error term $(A_B E_{\\text{cut}}^{-p_B} - A_A E_{\\text{cut}}^{-p_A})$ is cancelled if and only if the exponents are identical ($p_A = p_B = p$) and the amplitudes are identical ($A_A = A_B$). Under these conditions, the error in the energy difference converges faster than the error in the individual energies.\n\nThe problem asks for the residual leading-order error when $p_A = p_B = p$ and $A_B \\neq A_A$. In this case, the first-order error term does not cancel, and the leading-order truncation error is explicitly:\n$$ \\text{Error}_{\\text{LO}}(\\Delta E) = (A_B - A_A) E_{\\text{cut}}^{-p} $$\n\n**Part 3: Numerical Estimation**\n\nWe first estimate the exponent $p$ using the data for the energy difference $\\Delta E(E_{\\text{cut}})$. Let's denote $E_1=20$ Ry, $E_2=30$ Ry, $E_3=45$ Ry.\n$$ \\Delta E(E_1) = E_B(20) - E_A(20) = -154.1125 - (-154.196) = 0.0835 \\text{ eV} $$\n$$ \\Delta E(E_2) = E_B(30) - E_A(30) = -154.177777... - (-154.265444...) = 0.087666... \\text{ eV} $$\n$$ \\Delta E(E_3) = E_B(45) - E_A(45) = -154.206790... - (-154.296308...) = 0.089518... \\text{ eV} $$\nWe compute the successive differences for $\\Delta E$:\n$$ \\delta_1(\\Delta E) = \\Delta E(E_2) - \\Delta E(E_1) = 0.087666... - 0.0835 = 0.0041666... = \\frac{1}{240} \\text{ eV} $$\n$$ \\delta_2(\\Delta E) = \\Delta E(E_3) - \\Delta E(E_2) = 0.089518... - 0.087666... = 0.0018518... = \\frac{1}{540} \\text{ eV} $$\nThe ratio of these differences is:\n$$ \\frac{\\delta_2(\\Delta E)}{\\delta_1(\\Delta E)} = \\frac{1/540}{1/240} = \\frac{240}{540} = \\frac{4}{9} $$\nThe common ratio of the cutoffs is $r = 1.5 = 3/2$. Using the estimator for $p$:\n$$ p = \\frac{\\ln(\\delta_1/\\delta_2)}{\\ln(r)} = \\frac{\\ln(9/4)}{\\ln(3/2)} = \\frac{\\ln((3/2)^2)}{\\ln(3/2)} = \\frac{2 \\ln(3/2)}{\\ln(3/2)} = 2 $$\nThe exponent for the convergence is $p=2$.\n\nNext, we estimate the difference in amplitudes, $\\Delta A \\equiv A_B - A_A$. From Part 1, we have $\\delta_1(\\Delta E) = \\Delta A \\cdot E_1^{-p} (r^{-p}-1)$. We solve for $\\Delta A$:\n$$ \\Delta A = \\frac{\\delta_1(\\Delta E)}{E_1^{-p} (r^{-p}-1)} $$\nSubstituting the known values: $\\delta_1(\\Delta E) = 1/240$ eV, $E_1 = 20$ Ry, $p=2$, and $r=1.5$.\n$$ \\Delta A = \\frac{1/240 \\text{ eV}}{(20 \\text{ Ry})^{-2} ((1.5)^{-2}-1)} = \\frac{1/240}{(1/400)} \\frac{1}{((2/3)^2-1)} \\text{ eV} \\cdot \\text{Ry}^2 $$\n$$ \\Delta A = \\frac{400}{240} \\frac{1}{(4/9-1)} = \\frac{5}{3} \\frac{1}{(-5/9)} = \\frac{5}{3} \\left(-\\frac{9}{5}\\right) = -3 \\text{ eV} \\cdot \\text{Ry}^2 $$\n\nFinally, we evaluate the magnitude of the leading-order truncation error in $\\Delta E$ at $E_{\\text{cut}} = 45$ Ry.\n$$ \\text{Error}_{\\text{LO}}(\\Delta E) = \\Delta A \\cdot E_{\\text{cut}}^{-p} $$\nAt $E_{\\text{cut}} = 45$ Ry:\n$$ \\text{Error}_{\\text{LO}}(\\Delta E, 45 \\text{ Ry}) = (-3 \\text{ eV} \\cdot \\text{Ry}^2) \\cdot (45 \\text{ Ry})^{-2} = \\frac{-3}{45^2} \\text{ eV} = \\frac{-3}{2025} \\text{ eV} = -\\frac{1}{675} \\text{ eV} $$\nThe magnitude of this error is $|-1/675| = 1/675$ eV. The problem requires the answer in millielectronvolts (meV).\n$$ |\\text{Error}| = \\frac{1}{675} \\text{ eV} \\times \\frac{1000 \\text{ meV}}{1 \\text{ eV}} = \\frac{1000}{675} \\text{ meV} = \\frac{40}{27} \\text{ meV} $$\nNumerically, this value is approximately $1.481481...$ meV. Rounding to four significant figures gives $1.481$ meV.", "answer": "$$\n\\boxed{1.481}\n$$", "id": "2915094"}, {"introduction": "A well-converged total energy does not guarantee that all calculated properties are accurate, especially for properties that are derivatives of the energy, such as pressure and stress. This exercise [@problem_id:2915059] delves into the concept of Pulay stress, a spurious contribution arising because a fixed-energy-cutoff basis set changes during a cell deformation. Understanding and correcting for this effect is essential for accurate predictions of equilibrium geometries and elastic properties. You will investigate the physical origin of this basis set incompleteness error and design a practical extrapolation scheme to obtain the true, zero-Pulay-stress limit.", "problem": "In a periodic Kohn–Sham Density Functional Theory (DFT) calculation using a plane-wave basis with kinetic-energy cutoff $E_{\\text{cut}}$, the stress tensor $\\sigma_{\\alpha\\beta}$ is defined as the derivative of the ground-state total energy $E$ with respect to homogeneous strain $\\epsilon_{\\alpha\\beta}$ at fixed particle number. In a complete basis, the Hellmann–Feynman theorem applies, but in a finite plane-wave basis the basis set depends on the cell metric through $E_{\\text{cut}}$, so that a homogeneous strain modifies the admissible plane-wave set. This leads to a spurious contribution to the computed stress commonly called the “Pulay stress.” Consider a crystalline insulator described by a smooth norm-conserving pseudopotential and assume the high-$G$ tail of the pseudo-wavefunction Fourier coefficients satisfies $|c_{\\mathbf{G}}|^{2} \\sim G^{-p}$ for large $G$ with $p>5$. You wish to (i) identify the origin and sign of the Pulay stress at fixed $E_{\\text{cut}}$, and (ii) design a minimal protocol to extrapolate the pressure (the negative trace of the stress divided by $3$) to the zero-Pulay-stress limit using calculations at two or more values of $E_{\\text{cut}}$.\n\nWhich option correctly states the physical origin and sign of the Pulay stress in this setting and gives a scientifically justified and practical extrapolation protocol using two or more cutoffs?\n\nA. Pulay stress originates because the plane-wave basis depends on the cell metric: at fixed $E_{\\text{cut}}$, a homogeneous strain changes which plane waves satisfy $|\\mathbf{G}+\\mathbf{k}|^{2}/2 \\le E_{\\text{cut}}$, so the variational space changes with strain. Since increasing the volume $V$ at fixed $E_{\\text{cut}}$ increases the number of plane waves, the basis-set incompleteness error decreases with $V$, which makes the computed pressure spuriously too positive (compressive). For smooth pseudopotentials with $|c_{\\mathbf{G}}|^{2}\\sim G^{-p}$, the Pulay contribution decays as a power law in $E_{\\text{cut}}$, $p_{\\text{Pulay}}(E_{\\text{cut}})\\approx a\\,E_{\\text{cut}}^{-\\alpha}$ with $\\alpha=(p-5)/2>0$. A minimal two-point protocol assumes $p_{\\text{Pulay}}\\propto 1/N_{\\text{PW}}\\propto E_{\\text{cut}}^{-3/2}$ and fits $p(E)=p_{\\infty}+a\\,E^{-3/2}$ using two cutoffs $E_{1}<E_{2}$: letting $x_{i}=E_{i}^{-3/2}$ and $p_{i}=p(E_{i})$, estimate the zero-Pulay limit by $p_{\\infty}=(p_{1}x_{2}-p_{2}x_{1})/(x_{2}-x_{1})$. With three or more cutoffs, fit $p(E)=p_{\\infty}+a\\,E^{-\\alpha}$ with $\\alpha$ as a free parameter and verify monotonic decay.\n\nB. Pulay stress arises primarily from Brillouin-zone sampling error because the $k$-point mesh changes under strain; it is negative for finite $E_{\\text{cut}}$. It can be eliminated by converging the $k$-point mesh at fixed $E_{\\text{cut}}$ and then extrapolating the pressure linearly in $1/N_{k}$ using two meshes to obtain the zero-Pulay-stress limit.\n\nC. Pulay stress is caused by the nonlocal projectors of the pseudopotential violating the Hellmann–Feynman theorem, and its sign is negative (tensile). A practical protocol is to compute pressures at two cell volumes $V_{1}$ and $V_{2}$ at the same $E_{\\text{cut}}$ and extrapolate linearly in $1/V$ to $V\\to\\infty$, which removes the Pulay stress without varying $E_{\\text{cut}}$.\n\nD. Pulay stress is due entirely to the Pulay force terms from incomplete self-consistency, but it is absent in stress if the wavefunctions are fully converged. Therefore, no extrapolation in $E_{\\text{cut}}$ is needed; instead, keep the number of plane waves $N_{\\text{PW}}$ fixed by scaling $E_{\\text{cut}}$ with $V$ during strain and take the pressure from a single calculation as the zero-Pulay-stress value.", "solution": "The problem statement is first subjected to validation.\n\n### Step 1: Extract Givens\n- **System**: A crystalline insulator studied via periodic Kohn–Sham Density Functional Theory (DFT).\n- **Basis Set**: Plane-wave basis with a kinetic-energy cutoff $E_{\\text{cut}}$. The basis set includes all plane waves with wavevectors $\\mathbf{G}+\\mathbf{k}$ such that their kinetic energy is less than or equal to the cutoff. In atomic units (where $\\hbar=1$ and the electron mass $m_e=1$), this condition is $\\frac{1}{2}|\\mathbf{G}+\\mathbf{k}|^2 \\le E_{\\text{cut}}$.\n- **Quantity of Interest**: The stress tensor, $\\sigma_{\\alpha\\beta}$, defined as the derivative of the ground-state total energy $E$ with respect to homogeneous strain $\\epsilon_{\\alpha\\beta}$ at fixed particle number. Pressure is the negative trace of the stress divided by $3$, $P = -\\frac{1}{3}\\sum_{\\alpha} \\sigma_{\\alpha\\alpha}$.\n- **Core issue**: In a finite plane-wave basis with a fixed $E_{\\text{cut}}$, the basis set itself depends on the unit cell metric. Applying a strain $\\epsilon_{\\alpha\\beta}$ changes the reciprocal lattice vectors $\\mathbf{G}$, which in turn changes the set of plane waves satisfying the kinetic energy cutoff condition. This breakdown of a fixed variational space leads to a spurious contribution to the calculated stress, known as the \"Pulay stress.\"\n- **System Properties**:\n    1.  The system is described by a smooth norm-conserving pseudopotential.\n    2.  The Fourier coefficients $c_{\\mathbf{G}}$ of the pseudo-wavefunctions exhibit an asymptotic decay for large reciprocal lattice vector magnitudes $G=|\\mathbf{G}|$, such that $|c_{\\mathbf{G}}|^{2} \\sim G^{-p}$ with $p>5$.\n- **Tasks**:\n    1.  Identify the origin and sign of the Pulay stress at a fixed $E_{\\text{cut}}$.\n    2.  Design a minimal protocol to extrapolate the calculated pressure to the zero-Pulay-stress limit using results from two or more values of $E_{\\text{cut}}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is fundamentally sound and addresses a critical, well-established issue in computational materials science. The concept of Pulay stress (or, more generally, basis-set-incompleteness error in force/stress calculations) is a standard topic in advanced DFT literature. The connection between the smoothness of pseudopotentials, the decay rate of wavefunction Fourier coefficients ($|c_{\\mathbf{G}}|^{2} \\sim G^{-p}$), and the convergence of total energy and its derivatives with respect to $E_{\\text{cut}}$ is a cornerstone of the theory of plane-wave methods. The problem is scientifically grounded.\n- **Well-Posedness**: The problem is well-posed. It asks for the origin, sign, and an extrapolation method for a specific, physically defined quantity. The provided information regarding the system (insulator, smooth pseudopotential) and the asymptotic behavior of the wavefunctions is sufficient to derive the required properties and protocol. A unique and meaningful answer can be logically derived.\n- **Objectivity**: The problem is stated in precise, technical language, free from any subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It is a well-posed, scientifically grounded problem in computational quantum mechanics. I will now proceed with the solution derivation and option analysis.\n\n### Derivation and Analysis\n\nLet $E_{\\text{calc}}(V, E_{\\text{cut}})$ be the total energy calculated for a given cell volume $V$ using a plane-wave cutoff $E_{\\text{cut}}$. This calculated energy is an upper bound to the true ground-state energy in the complete basis-set limit, $E_{\\infty}(V)$. The difference is the basis-set incompleteness error, $\\Delta E(V, E_{\\text{cut}}) = E_{\\text{calc}}(V, E_{\\text{cut}}) - E_{\\infty}(V)$. By the variational principle, $\\Delta E \\ge 0$.\n\nThe calculated pressure is $P_{\\text{calc}} = -\\frac{d E_{\\text{calc}}}{d V}$. The true pressure is $P_{\\infty} = -\\frac{d E_{\\infty}}{d V}$.\nThe error in the calculated pressure is the Pulay pressure, $P_{\\text{Pulay}}$:\n$$ P_{\\text{calc}} = -\\frac{d}{dV} (E_{\\infty} + \\Delta E) = P_{\\infty} - \\frac{d(\\Delta E)}{dV} $$\nThus, $P_{\\text{Pulay}} = - \\frac{d(\\Delta E)}{dV}$.\n\n**1. Origin and Sign of Pulay Stress**\n\nThe origin of the Pulay stress is the dependence of the finite basis set on the cell volume (or strain) at a fixed $E_{\\text{cut}}$. The number of plane waves, $N_{\\text{PW}}$, in the basis is approximately proportional to the volume of the sphere in reciprocal space with radius $G_{\\text{cut}} = \\sqrt{2 E_{\\text{cut}}}$, multiplied by the density of G-vectors, which is proportional to the cell volume $V$.\n$$ N_{\\text{PW}} \\approx \\frac{V}{(2\\pi)^3} \\left( \\frac{4}{3}\\pi G_{\\text{cut}}^3 \\right) \\propto V \\cdot E_{\\text{cut}}^{3/2} $$\nFor a fixed $E_{\\text{cut}}$, increasing the volume $V$ increases the number of plane waves $N_{\\text{PW}}$. A larger basis set provides a better variational description of the ground state, so the calculated energy $E_{\\text{calc}}$ decreases, approaching $E_{\\infty}$ from above. Consequently, the basis-set incompleteness error $\\Delta E$ decreases as $V$ increases.\nThis implies that the derivative $\\frac{d(\\Delta E)}{dV}$ is negative.\nThe Pulay pressure is $P_{\\text{Pulay}} = - \\frac{d(\\Delta E)}{dV}$. Since $\\frac{d(\\Delta E)}{dV} < 0$, the Pulay pressure $P_{\\text{Pulay}}$ must be positive.\nA positive pressure is compressive. Therefore, the calculated pressure is spuriously more positive (i.e., more compressive or less tensile) than the true, complete basis-set pressure. This fully determines the origin and sign.\n\n**2. Extrapolation Protocol**\n\nThe protocol requires understanding the dependence of the error on $E_{\\text{cut}}$. The energy error $\\Delta E$ is primarily due to the truncation of the kinetic energy of the wavefunction. This error is approximately the sum of the kinetic energies of the neglected plane-wave components:\n$$ \\Delta E \\approx \\sum_{i}^{\\text{occ}} \\sum_{|\\mathbf{G}+\\mathbf{k}| > G_{\\text{cut}}} \\frac{1}{2}|\\mathbf{G}+\\mathbf{k}|^2 |c_{i,\\mathbf{G}+\\mathbf{k}}|^2 $$\nwhere the sum is over occupied states $i$ and their Fourier coefficients $c_{i,\\mathbf{G}+\\mathbf{k}}$.\nReplacing the sum over $\\mathbf{G}$ with an integral, and using the given asymptotic behavior $|c_{\\mathbf{G}}|^2 \\sim G^{-p}$, we get:\n$$ \\Delta E \\propto \\int_{G_{\\text{cut}}}^{\\infty} (G^2) \\cdot (G^{-p}) \\cdot (4\\pi G^2 dG) \\propto \\int_{G_{\\text{cut}}}^{\\infty} G^{4-p} dG $$\nThe term $G^2$ comes from the kinetic energy operator and the other $G^2$ from the volume element in 3D reciprocal space. The integral converges for $4-p < -1$, or $p>5$, as given.\n$$ \\Delta E \\propto [G^{5-p}]_{G_{\\text{cut}}}^{\\infty} \\propto -(G_{\\text{cut}})^{5-p} \\propto G_{\\text{cut}}^{-(p-5)} $$\nSince $G_{\\text{cut}} \\propto E_{\\text{cut}}^{1/2}$, we have $\\Delta E \\propto E_{\\text{cut}}^{-(p-5)/2}$.\n\nThe Pulay pressure $P_{\\text{Pulay}}$ can be shown to be proportional to the kinetic energy content of the neglected part of the wavefunction (Francis & Payne, 1990), which is approximately $\\Delta E$. Therefore, we expect the Pulay pressure to follow the same power law:\n$$ P_{\\text{Pulay}}(E_{\\text{cut}}) \\approx a \\cdot E_{\\text{cut}}^{-\\alpha} \\quad \\text{with} \\quad \\alpha = \\frac{p-5}{2} $$\nThe full pressure is then $P(E_{\\text{cut}}) = P_{\\infty} + a E_{\\text{cut}}^{-\\alpha}$.\nFor a practical protocol with a minimal number of points (two), a specific value of $\\alpha$ must be assumed. A common and robust assumption for smooth norm-conserving pseudopotentials is that the underlying wavefunctions are sufficiently smooth such that $p \\approx 8$. This gives an exponent $\\alpha = (8-5)/2 = 3/2$.\nThis corresponds to the Pulay pressure decaying as $P_{\\text{Pulay}} \\propto E_{\\text{cut}}^{-3/2}$, or equivalently, as $1/N_{\\text{PW}}$.\nThe extrapolation model becomes $P(E) = P_{\\infty} + a E^{-3/2}$. This is a linear relationship between $P$ and $x = E^{-3/2}$. Given two calculations at $(E_1, P_1)$ and $(E_2, P_2)$, we can solve for $P_{\\infty}$, which is the y-intercept at $x=0$.\nThe two-point linear extrapolation formula is:\n$$ P_{\\infty} = \\frac{P_1 x_2 - P_2 x_1}{x_2 - x_1} $$\nwhere $x_i = E_i^{-3/2}$. If more data points are available, one can perform a linear least-squares fit of $P_i$ versus $x_i$ to obtain a more robust estimate of $P_{\\infty}$. Alternatively, one can fit $P(E) = P_{\\infty} + a E^{-\\alpha}$ with $P_{\\infty}$, $a$, and $\\alpha$ as fitting parameters.\n\n### Evaluation of Options\n\n**A.** This option states that Pulay stress originates from the strain-dependence of the basis set at fixed $E_{\\text{cut}}$. It correctly deduces that this leads to a spuriously positive (compressive) pressure contribution. It correctly identifies the power-law decay of the Pulay pressure as $P_{\\text{Pulay}} \\propto E_{\\text{cut}}^{-\\alpha}$ with $\\alpha=(p-5)/2$, based on the asymptotic behavior of the wavefunction coefficients. It proposes a minimal two-point protocol based on the common approximation $\\alpha=3/2$ (i.e., $P_{\\text{Pulay}} \\propto E_{\\text{cut}}^{-3/2}$), and provides the correct corresponding two-point extrapolation formula. It also correctly suggests a more general protocol for three or more points. This option is entirely consistent with our derivation.\n**Verdict: Correct.**\n\n**B.** This option incorrectly attributes Pulay stress to Brillouin-zone sampling error. While $k$-point sampling also introduces errors in stress calculations, this is a distinct effect. The Pulay stress, by standard definition and as described in the problem, is a basis-set effect. The option also incorrectly states the sign of the stress is negative (tensile). The proposed protocol of extrapolating in $1/N_k$ addresses $k$-point convergence, not the plane-wave basis-set incompleteness error.\n**Verdict: Incorrect.**\n\n**C.** This option incorrectly claims the cause is the nonlocal projectors themselves, rather than the incompleteness of the basis used to represent their action. It incorrectly states the sign is negative (tensile). The proposed protocol of extrapolating in $1/V$ to $V\\to\\infty$ is nonsensical for finding the pressure of a crystal at a specific finite volume. Such an extrapolation does not remove the $E_{\\text{cut}}$-dependent Pulay stress.\n**Verdict: Incorrect.**\n\n**D.** This option incorrectly attributes Pulay stress to incomplete self-consistency (i.e., not reaching the minimum of the energy functional for a given basis). This \"SCF Pulay\" term is a different source of error. The Pulay stress discussed in the problem persists even with perfectly converged wavefunctions, as it arises from the basis set being incomplete. The option then proposes a method where the number of plane waves $N_{\\text{PW}}$ is held constant during a cell deformation. This is a valid technique to *prevent* Pulay stress from appearing in the derivative calculation. However, it is not an *extrapolation protocol* to correct results from standard fixed-$E_{\\text{cut}}$ calculations, which is what the question asks for. The question explicitly demands a protocol \"using calculations at two or more values of $E_{\\text{cut}}$\" to find the \"zero-Pulay-stress limit\". The method described in D is an alternative calculational scheme, not the requested extrapolation protocol.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2915059"}]}