{"hands_on_practices": [{"introduction": "The primary outputs of a linear-response TDDFT calculation are excitation energies and their corresponding oscillator strengths, which together define a theoretical absorption spectrum. However, these quantities also serve as building blocks for other important physical properties. This practice demonstrates how to connect the TDDFT spectrum to the static dipole polarizability, a fundamental measure of a molecule's response to an external electric field, by deriving and applying the sum-over-states expression [@problem_id:2932938].", "problem": "A one-electron model system is described within time-dependent density functional theory (TDDFT) in the linear-response regime under the electric-dipole approximation. The isotropic, frequency-dependent dipole polarizability $\\,\\alpha(\\omega)\\,$ is defined by the linear relation between the induced dipole moment and the applied homogeneous field. Consider the Lehmann representation of the dipole-dipole response function and the standard length-gauge definition of the dipole oscillator strength. Use only fundamental linear-response definitions and conservation laws (such as the Thomas–Reiche–Kuhn sum rule) as your starting point.\n\nYou are given a model TDDFT excitation spectrum consisting of three discrete excited states with transition energies (in Hartree, atomic units) and isotropic oscillator strengths (dimensionless):\n- $\\,\\omega_{10} = 0.25\\,$ with $\\,f_{01} = 0.30\\,$,\n- $\\,\\omega_{20} = 0.40\\,$ with $\\,f_{02} = 0.45\\,$,\n- $\\,\\omega_{30} = 0.80\\,$ with $\\,f_{03} = 0.15\\,$.\n\nAssume that the Thomas–Reiche–Kuhn sum rule holds exactly for this one-electron model, so that $\\,\\sum_{n} f_{0n} = 1.000\\,$. To account for all higher-lying discrete and continuum excitations beyond the three given states, approximate the residual oscillator strength by a single effective transition at an average energy $\\,\\omega_{\\mathrm{eff}} = 1.50\\,$ with $\\,f_{\\mathrm{tail}} = 1.000 - (0.30 + 0.45 + 0.15)\\,$.\n\nTasks:\n1. Starting from the linear-response definition of the dipole polarizability tensor and the length-gauge definition of the oscillator strength, derive a sum-over-states expression for the static, isotropic dipole polarizability $\\,\\alpha(0)\\,$ in terms of excitation energies $\\,\\omega_{n0}\\,$ and isotropic oscillator strengths $\\,f_{0n}\\,$.\n2. Using your derived expression and the model spectrum (including the effective tail), compute the numerical value of $\\,\\alpha(0)\\,$.\n\nExpress the final polarizability in atomic units of volume $\\,a_0^3\\,$, and round your final numerical answer to four significant figures.", "solution": "The problem presented is validated as scientifically grounded, well-posed, and objective. It is a standard exercise in the application of linear-response time-dependent density functional theory (TDDFT). Proceeding to the solution.\n\nThe problem is divided into two parts: first, the derivation of a key formula, and second, its numerical application.\n\nPart 1: Derivation of the static polarizability expression.\n\nThe starting point is the Lehmann representation for the frequency-dependent dipole polarizability tensor $\\alpha_{ij}(\\omega)$, which arises from second-order perturbation theory. In atomic units (where $\\hbar = e = m_e = 4\\pi\\epsilon_0 = 1$), this is given by:\n$$ \\alpha_{ij}(\\omega) = \\sum_{n \\neq 0} \\left( \\frac{\\langle \\Psi_0 | \\hat{d}_i | \\Psi_n \\rangle \\langle \\Psi_n | \\hat{d}_j | \\Psi_0 \\rangle}{\\omega_{n0} - \\omega} + \\frac{\\langle \\Psi_0 | \\hat{d}_j | \\Psi_n \\rangle \\langle \\Psi_n | \\hat{d}_i | \\Psi_0 \\rangle}{\\omega_{n0} + \\omega} \\right) $$\nHere, $\\Psi_0$ and $\\Psi_n$ are the ground and excited electronic states, respectively. The term $\\hat{d}_i$ is the $i$-th Cartesian component of the electric dipole operator. The quantity $\\omega_{n0} = E_n - E_0$ is the excitation energy from the ground state to the $n$-th excited state. For clarity, the infinitesimal term $i\\eta$ associated with the adiabatic switching of the perturbation is omitted, as we are concerned with frequencies $\\omega$ not at a resonance.\n\nThe problem requires the isotropic polarizability, $\\alpha(\\omega)$, which is obtained by averaging the diagonal components of the tensor:\n$$ \\alpha(\\omega) = \\frac{1}{3} \\sum_{i=x,y,z} \\alpha_{ii}(\\omega) $$\nSubstituting the expression for $\\alpha_{ii}(\\omega)$ yields:\n$$ \\alpha(\\omega) = \\frac{1}{3} \\sum_{n \\neq 0} \\sum_{i=x,y,z} |\\langle \\Psi_0 | \\hat{d}_i | \\Psi_n \\rangle|^2 \\left( \\frac{1}{\\omega_{n0} - \\omega} + \\frac{1}{\\omega_{n0} + \\omega} \\right) $$\nCombining the terms in the parenthesis gives:\n$$ \\frac{1}{\\omega_{n0} - \\omega} + \\frac{1}{\\omega_{n0} + \\omega} = \\frac{(\\omega_{n0} + \\omega) + (\\omega_{n0} - \\omega)}{(\\omega_{n0} - \\omega)(\\omega_{n0} + \\omega)} = \\frac{2\\omega_{n0}}{\\omega_{n0}^2 - \\omega^2} $$\nThus, the expression for the dynamic isotropic polarizability becomes:\n$$ \\alpha(\\omega) = \\sum_{n \\neq 0} \\frac{2\\omega_{n0}}{3(\\omega_{n0}^2 - \\omega^2)} \\sum_{i=x,y,z} |\\langle \\Psi_0 | \\hat{d}_i | \\Psi_n \\rangle|^2 $$\nThe next step is to introduce the isotropic oscillator strength, $f_{0n}$. The problem specifies the use of the length-gauge definition, which, in atomic units, is:\n$$ f_{0n} = \\frac{2}{3} \\omega_{n0} \\sum_{i=x,y,z} |\\langle \\Psi_0 | \\hat{d}_i | \\Psi_n \\rangle|^2 $$\nThis definition allows for the substitution of the squared transition dipole moment sum. Rearranging the definition of $f_{0n}$, we obtain:\n$$ \\sum_{i=x,y,z} |\\langle \\Psi_0 | \\hat{d}_i | \\Psi_n \\rangle|^2 = \\frac{3 f_{0n}}{2 \\omega_{n0}} $$\nSubstituting this into the expression for $\\alpha(\\omega)$:\n$$ \\alpha(\\omega) = \\sum_{n \\neq 0} \\frac{2\\omega_{n0}}{3(\\omega_{n0}^2 - \\omega^2)} \\left( \\frac{3 f_{0n}}{2 \\omega_{n0}} \\right) $$\nSimplification leads to the well-known sum-over-states formula for the dynamic isotropic polarizability:\n$$ \\alpha(\\omega) = \\sum_{n \\neq 0} \\frac{f_{0n}}{\\omega_{n0}^2 - \\omega^2} $$\nThe problem asks for the static polarizability, $\\alpha(0)$, which is the limit of $\\alpha(\\omega)$ as the frequency $\\omega$ approaches zero.\n$$ \\alpha(0) = \\lim_{\\omega \\to 0} \\sum_{n \\neq 0} \\frac{f_{0n}}{\\omega_{n0}^2 - \\omega^2} = \\sum_{n \\neq 0} \\frac{f_{0n}}{\\omega_{n0}^2} $$\nThis is the required expression for the static, isotropic dipole polarizability in terms of excitation energies and oscillator strengths. This concludes the first part of the task.\n\nPart 2: Numerical computation of $\\alpha(0)$.\n\nWe use the derived formula $\\alpha(0) = \\sum_{n \\neq 0} \\frac{f_{0n}}{\\omega_{n0}^2}$. The model spectrum consists of three explicit states and a \"tail\" to account for the remaining oscillator strength.\nThe Thomas–Reiche–Kuhn sum rule for a one-electron system states that $\\sum_n f_{0n} = 1$. The sum of the given oscillator strengths is:\n$$ f_{01} + f_{02} + f_{03} = 0.30 + 0.45 + 0.15 = 0.90 $$\nThe residual oscillator strength, which we label $f_{\\text{tail}}$, is therefore:\n$$ f_{\\text{tail}} = 1.000 - 0.90 = 0.10 $$\nThis residual strength is associated with an effective energy $\\omega_{\\text{eff}} = 1.50$ Hartree.\n\nThe total static polarizability is calculated by summing the contributions from the four effective transitions:\n$$ \\alpha(0) = \\frac{f_{01}}{\\omega_{10}^2} + \\frac{f_{02}}{\\omega_{20}^2} + \\frac{f_{03}}{\\omega_{30}^2} + \\frac{f_{\\text{tail}}}{\\omega_{\\text{eff}}^2} $$\nSubstituting the given numerical values:\n$$ \\alpha(0) = \\frac{0.30}{(0.25)^2} + \\frac{0.45}{(0.40)^2} + \\frac{0.15}{(0.80)^2} + \\frac{0.10}{(1.50)^2} $$\nWe compute each term:\n$$ \\frac{0.30}{0.0625} = 4.8 $$\n$$ \\frac{0.45}{0.16} = 2.8125 $$\n$$ \\frac{0.15}{0.64} = 0.234375 $$\n$$ \\frac{0.10}{2.25} = 0.0444... $$\nThe sum is:\n$$ \\alpha(0) = 4.8 + 2.8125 + 0.234375 + 0.0444... = 7.8913194... $$\nThe result is in atomic units of volume ($a_0^3$). The problem requires rounding the final answer to four significant figures.\n$$ \\alpha(0) \\approx 7.891 \\, a_0^3 $$\nThis is the final numerical result.", "answer": "$$\\boxed{7.891}$$", "id": "2932938"}, {"introduction": "Exactly solvable models, while often simplified, provide invaluable benchmarks for testing the formal structure of our more general theories. This exercise uses the \"Hooke's atom\" model to explore a profound constraint on the exact exchange-correlation kernel known as the generalized Kohn's theorem [@problem_id:2932929]. By separating the center-of-mass and relative motions, you will see precisely why the exact TDDFT response must yield the correct dipole excitation energy in a harmonic potential, revealing that the kernel's contribution must vanish for this specific mode.", "problem": "Consider a two-electron system known as Hooke's atom: two electrons, each of mass $1$ and charge $-1$, move in a three-dimensional isotropic harmonic trap with frequency $\\omega$ and interact via the Coulomb repulsion. In atomic units, the Hamiltonian is\n$$\n\\hat{H} = \\sum_{i=1}^{2}\\left(-\\frac{1}{2}\\nabla_{i}^{2} + \\frac{1}{2}\\,\\omega^{2}\\,|\\mathbf{r}_{i}|^{2}\\right) + \\frac{1}{|\\mathbf{r}_{1} - \\mathbf{r}_{2}|}.\n$$\nA weak, spatially uniform, time-dependent electric field polarized along the $x$-axis is applied, with perturbation\n$$\n\\delta \\hat{V}(t) = - \\mathcal{E}\\,\\cos(\\Omega t)\\,\\sum_{i=1}^{2} x_{i},\n$$\nwhere $\\mathcal{E}$ is a small real amplitude and $\\Omega$ is the driving angular frequency. Work within the electric dipole approximation.\n\n1) Starting from the time-dependent Schrödinger equation and the structure of the unperturbed Hamiltonian, use center-of-mass and relative coordinates to argue from first principles that the exact lowest dipole-allowed excitation energy (the first pole in the exact linear density response along $x$) is equal to $\\omega$, independent of the electron-electron interaction strength. Clearly state any commutation or separability property you use in your derivation.\n\n2) Now analyze the same excitation within Time-Dependent Density Functional Theory (TDDFT) in the linear-response regime for a closed-shell ground state, using the exact Kohn-Sham (KS) system. Let $\\Delta \\varepsilon$ denote the KS single-particle energy difference between the first unoccupied and the highest occupied spatial orbital that couples to the $x$-polarized dipole operator. Invoke only well-established constraints for harmonic traps to relate $\\Delta \\varepsilon$ to $\\omega$ for the dipole-allowed response.\n\n3) In the Tamm-Dancoff Approximation (TDA) within TDDFT, consider the single-pole subspace spanned by the dominant KS transition $| \\phi_{0} \\rangle \\to | \\phi_{1} \\rangle$ along $x$. Denote by $K_{d}$ the diagonal matrix element of the Hartree–exchange–correlation kernel (in the transition-density metric) for this subspace. Using the linear-response framework (without assuming any specific approximate functional), express the TDDFT TDA excitation energy $\\omega_{\\mathrm{TDDFT}}$ in terms of $\\Delta \\varepsilon$ and $K_{d}$, and then enforce agreement with the exact result from part 1 to determine $K_{d}$ as a function of $\\omega$.\n\nExpress your final answer for $K_{d}$ in Hartree. No rounding is required.", "solution": "The problem will be validated and, if deemed valid, solved in three parts as requested.\n\nThe first step is a rigorous validation of the problem statement.\n\nGivens are extracted verbatim:\n- System: A two-electron system known as Hooke's atom.\n- Particle properties: Two electrons, each of mass $1$ and charge $-1$.\n- External potential: A three-dimensional isotropic harmonic trap with frequency $\\omega$.\n- Interaction: Coulomb repulsion, potential $1/|\\mathbf{r}_{1} - \\mathbf{r}_{2}|$.\n- Unperturbed Hamiltonian: $\\hat{H} = \\sum_{i=1}^{2}\\left(-\\frac{1}{2}\\nabla_{i}^{2} + \\frac{1}{2}\\,\\omega^{2}\\,|\\mathbf{r}_{i}|^{2}\\right) + \\frac{1}{|\\mathbf{r}_{1} - \\mathbf{r}_{2}|}$.\n- Perturbation: $\\delta \\hat{V}(t) = - \\mathcal{E}\\,\\cos(\\Omega t)\\,\\sum_{i=1}^{2} x_{i}$.\n- Perturbation properties: Small real amplitude $\\mathcal{E}$, driving angular frequency $\\Omega$.\n- Approximation: Electric dipole approximation.\n- Part 1 objective: Argue from first principles that the exact lowest dipole-allowed excitation energy is $\\omega$.\n- Part 2 objective: Within exact Kohn-Sham (KS) theory, relate the relevant KS orbital energy gap $\\Delta \\varepsilon$ to $\\omega$.\n- Part 3 objective: Using the Time-Dependent Density Functional Theory (TDDFT) Tamm-Dancoff Approximation (TDA), express the excitation energy $\\omega_{\\mathrm{TDDFT}}$ in terms of $\\Delta \\varepsilon$ and a kernel matrix element $K_{d}$. Enforce agreement with the exact result to determine $K_{d}(\\omega)$.\n\nValidation Verdict:\nThe problem is scientifically grounded, well-posed, and objective. It is based on established principles of quantum mechanics and TDDFT, utilizing a standard model system (Hooke's atom). The problem is logically structured and contains all necessary information for a rigorous derivation. It is a non-trivial problem in theoretical chemistry that tests fundamental understanding of many-body physics and electronic structure theory. The problem is valid. We proceed to the solution.\n\nPart 1: Exact Dipole Excitation Energy\n\nThe problem is addressed by transforming the Hamiltonian to center-of-mass (COM) and relative coordinates. Let the positions of the two electrons be $\\mathbf{r}_{1}$ and $\\mathbf{r}_{2}$.\nThe COM coordinate is $\\mathbf{R} = \\frac{\\mathbf{r}_{1} + \\mathbf{r}_{2}}{2}$.\nThe relative coordinate is $\\mathbf{r} = \\mathbf{r}_{1} - \\mathbf{r}_{2}$.\nThe masses are $m_{1}=m_{2}=1$ (in atomic units). The total mass is $M = m_{1} + m_{2} = 2$, and the reduced mass is $\\mu = \\frac{m_{1}m_{2}}{m_{1}+m_{2}} = \\frac{1}{2}$.\n\nThe kinetic energy operator transforms as:\n$$\n-\\frac{1}{2}\\nabla_{1}^{2} - \\frac{1}{2}\\nabla_{2}^{2} = -\\frac{1}{2M}\\nabla_{\\mathbf{R}}^{2} - \\frac{1}{2\\mu}\\nabla_{\\mathbf{r}}^{2} = -\\frac{1}{4}\\nabla_{\\mathbf{R}}^{2} - \\nabla_{\\mathbf{r}}^{2}\n$$\nThe harmonic potential term transforms as:\n$$\n\\frac{1}{2}\\omega^{2}|\\mathbf{r}_{1}|^{2} + \\frac{1}{2}\\omega^{2}|\\mathbf{r}_{2}|^{2} = \\frac{1}{2}\\omega^{2}(|\\mathbf{R} + \\frac{1}{2}\\mathbf{r}|^{2} + |\\mathbf{R} - \\frac{1}{2}\\mathbf{r}|^{2}) = \\frac{1}{2}\\omega^{2}(2|\\mathbf{R}|^{2} + \\frac{1}{2}|\\mathbf{r}|^{2}) = \\omega^{2}|\\mathbf{R}|^{2} + \\frac{1}{4}\\omega^{2}|\\mathbf{r}|^{2}\n$$\nThe Coulomb interaction term is, by definition, dependent only on the relative coordinate: $\\frac{1}{|\\mathbf{r}_{1} - \\mathbf{r}_{2}|} = \\frac{1}{|\\mathbf{r}|}$.\n\nThe total Hamiltonian $\\hat{H}$ separates into a COM part and a relative part:\n$$\n\\hat{H} = \\left(-\\frac{1}{4}\\nabla_{\\mathbf{R}}^{2} + \\omega^{2}|\\mathbf{R}|^{2}\\right) + \\left(-\\nabla_{\\mathbf{r}}^{2} + \\frac{1}{4}\\omega^{2}|\\mathbf{r}|^{2} + \\frac{1}{|\\mathbf{r}|}\\right) = \\hat{H}_{\\mathrm{COM}}(\\mathbf{R}) + \\hat{H}_{\\mathrm{rel}}(\\mathbf{r})\n$$\nThe COM Hamiltonian, $\\hat{H}_{\\mathrm{COM}} = -\\frac{1}{2(2)}\\nabla_{\\mathbf{R}}^{2} + \\frac{1}{2}(2)\\omega^{2}|\\mathbf{R}|^{2}$, describes a single particle of mass $M=2$ in a $3$-dimensional isotropic harmonic potential with frequency $\\omega$. The energy eigenvalues of $\\hat{H}_{\\mathrm{COM}}$ are $E_{\\mathrm{COM}} = (N + \\frac{3}{2})\\omega$, where $N=n_{X}+n_{Y}+n_{Z}$ is the total quantum number.\n\nThe perturbation is described by the electric dipole operator along the $x$-axis, $\\hat{D}_{x} = \\sum_{i=1}^{2} x_{i}$. In the new coordinates, $x_{1} = X + \\frac{1}{2}x$ and $x_{2} = X - \\frac{1}{2}x$, so the operator becomes:\n$$\n\\hat{D}_{x} = (X + \\frac{1}{2}x) + (X - \\frac{1}{2}x) = 2X\n$$\nThe dipole operator depends *only* on the COM coordinate $X$. Because the Hamiltonian is separable and the dipole operator acts only on the COM subsystem, transitions induced by this operator can only change the quantum state of the COM motion, leaving the state of the relative motion, described by $\\hat{H}_{\\mathrm{rel}}$, unchanged. This is a manifestation of the generalized Kohn's theorem.\n\nThe ground state of the system is $\\Psi_{0} = \\Phi_{0}(\\mathbf{R})\\psi_{0}(\\mathbf{r})$, where $\\Phi_{0}$ is the ground state of $\\hat{H}_{\\mathrm{COM}}$ and $\\psi_{0}$ is the ground state of $\\hat{H}_{\\mathrm{rel}}$. The state $\\Phi_{0}$ corresponds to $N=0$ (i.e., $n_{X}=n_{Y}=n_{Z}=0$) and has energy $E_{\\mathrm{COM},0} = \\frac{3}{2}\\omega$.\nThe operator $X$ has a selection rule $\\Delta n_{X} = \\pm 1$. Therefore, the lowest-energy dipole-allowed transition from the ground state excites the COM motion from $n_{X}=0$ to $n_{X}=1$, while $n_{Y}$ and $n_{Z}$ remain $0$. The final COM state has quantum numbers $n_{X}=1, n_{Y}=0, n_{Z}=0$, so $N=1$. The energy of this final state is $E_{\\mathrm{COM},1} = (1 + \\frac{3}{2})\\omega = \\frac{5}{2}\\omega$.\nThe exact excitation energy for this transition is the difference in COM energies, as the relative energy is unchanged:\n$$\n\\Delta E = E_{\\mathrm{COM},1} - E_{\\mathrm{COM},0} = \\frac{5}{2}\\omega - \\frac{3}{2}\\omega = \\omega\n$$\nThis result is exact and holds irrespective of the electron-electron interaction strength.\n\nPart 2: Kohn-Sham Orbital Energy Difference\n\nWithin TDDFT, the exact time-dependent density $n(\\mathbf{r}, t)$ of the interacting system is reproduced by a fictitious non-interacting Kohn-Sham (KS) system evolving under an effective time-dependent KS potential. The linear density response of the interacting system must be identical to that of the KS system.\nFor an interacting system in a harmonic external potential, the center-of-mass motion excited by a uniform electric field oscillates at the bare trap frequency $\\omega$. This means the exact density response function has a pole at $\\omega$.\nTo reproduce this, the KS system's response must also have a pole at $\\omega$. The poles of the bare KS response function, $\\chi_{s}(\\Omega)$, occur at the KS orbital energy differences, $\\varepsilon_{a} - \\varepsilon_{i}$, where $\\varepsilon_{i}$ is an occupied orbital energy and $\\varepsilon_{a}$ is an unoccupied orbital energy. The TDDFT linear response equations then shift these poles to the true excitation energies via the Hartree-exchange-correlation (Hxc) kernel.\nHowever, for the specific case of a dipole excitation in a harmonic trap, a powerful constraint, known as the harmonic potential theorem (or KS-Kohn's theorem), requires that the exact Hxc kernel provides no correction to the dipole oscillation frequency. Consequently, the relevant pole of the bare KS response function must already be at the exact frequency.\nThe system is a closed-shell two-electron atom, so the highest occupied molecular orbital (HOMO) is a spherically symmetric $s$-type orbital. The dipole operator $x$ has odd parity and, by selection rules, induces transitions to orbitals of $p$-type symmetry. The first set of unoccupied orbitals (LUMOs) are the degenerate $p$-orbitals. The problem defines $\\Delta \\varepsilon$ as the KS energy difference between the energetically lowest-lying occupied and unoccupied orbitals coupled by the $x$-polarized dipole operator. This corresponds to the HOMO-LUMO gap, $\\Delta \\varepsilon = \\varepsilon_{\\mathrm{LUMO}} - \\varepsilon_{\\mathrm{HOMO}}$.\nTo satisfy the harmonic potential theorem, this gap in the exact KS system must be equal to the trap frequency:\n$$\n\\Delta \\varepsilon = \\omega\n$$\n\nPart 3: TDA Kernel Element\n\nIn the Tamm-Dancoff Approximation (TDA), the excitation energies $\\omega_{\\mathrm{TDDFT}}$ are found by solving the eigenvalue problem $\\mathbf{A} \\mathbf{F} = \\omega_{\\mathrm{TDDFT}} \\mathbf{F}$, where the matrix $\\mathbf{A}$ is given by $A_{ia,jb} = \\delta_{ij}\\delta_{ab}(\\varepsilon_{a} - \\varepsilon_{i}) + K_{ia,jb}$. Here, $K_{ia,jb}$ are the matrix elements of the Hxc kernel.\nThe problem asks to consider a single-pole subspace, meaning we only consider the dominant transition from the HOMO (denoted $i$) to the LUMO (denoted $a$). The matrix $\\mathbf{A}$ becomes a $1 \\times 1$ matrix, i.e., a scalar. The eigenvalue equation is trivial:\n$$\n\\omega_{\\mathrm{TDDFT}} = (\\varepsilon_{a} - \\varepsilon_{i}) + K_{ia,ia}\n$$\nUsing the problem's notation, $\\Delta \\varepsilon = \\varepsilon_{a} - \\varepsilon_{i}$ and $K_{d} = K_{ia,ia}$ is the diagonal kernel element for this transition. The TDA excitation energy is therefore:\n$$\n\\omega_{\\mathrm{TDDFT}} = \\Delta \\varepsilon + K_{d}\n$$\nNow, we enforce the condition that this TDDFT TDA result agrees with the exact excitation energy derived in Part 1, which is $\\omega$.\n$$\n\\omega = \\Delta \\varepsilon + K_{d}\n$$\nFrom the analysis in Part 2, for the exact KS system, we have the constraint $\\Delta \\varepsilon = \\omega$. Substituting this into the equation yields:\n$$\n\\omega = \\omega + K_{d}\n$$\nThis equation implies that the kernel element must be zero.\n$$\nK_{d} = 0\n$$\nThis result, $K_d = 0$, signifies that for the exact Hxc functional, the sum of the Hartree and exchange-correlation contributions to the TDA kernel for the center-of-mass excitation in a harmonic potential is exactly zero. This cancellation is a known property and is crucial for TDDFT to recover the correct dipole response in this class of systems. Any approximate functional for which this cancellation does not occur will yield an incorrect excitation energy for this mode.", "answer": "$$\n\\boxed{0}\n$$", "id": "2932929"}, {"introduction": "One of the most significant challenges for standard TDDFT approximations is the description of charge-transfer (CT) excitations, which are often drastically underestimated. This exercise tackles this critical issue head-on by guiding you through the derivation of a simple analytical model for the CT energy in a donor-acceptor system [@problem_id:2932958]. By implementing this model, you will diagnose why local functionals fail and demonstrate how range-separated hybrid functionals provide a robust physical and mathematical remedy, bridging formal theory with the practical concerns of computational spectroscopy.", "problem": "You are given a two-fragment donor–acceptor system separated by a center-to-center distance $R$ in bohr. The donor has ionization potential $I$ (in Hartree) and the acceptor has electron affinity $A$ (in Hartree). Work within Time-Dependent Density Functional Theory (TDDFT) in the linear response regime using the Tamm–Dancoff approximation (TDA) and a one-pole model dominated by a donor highest-occupied to acceptor lowest-unoccupied transition. Assume non-overlapping fragments and negligible exchange of electrons between fragments in the ground state.\n\nStarting from the fundamental base of linear-response Kohn–Sham theory and the definition of the kernel, proceed as follows:\n- Use the Kohn–Sham (KS) independent-particle transition energy as the fundamental gap, i.e., the difference between the donor ionization potential and the acceptor electron affinity, $I - A$, as the independent-particle contribution. Justify this using well-tested facts about exact Kohn–Sham potentials and the fundamental gap.\n- Incorporate electron–hole interaction through a range-separated hybrid (RSH) exchange–correlation kernel characterized by parameters $\\mu$ (in bohr$^{-1}$) and $f_{\\mathrm{LR}}$ (dimensionless). The parameter $\\mu$ sets a separation length scale between short- and long-range physics, and $f_{\\mathrm{LR}}$ is the fraction of exact exchange applied in the long-range part. Derive the closed-form analytical model for the charge-transfer excitation energy $\\Omega_{\\mathrm{RSH}}(R;\\mu,f_{\\mathrm{LR}})$ in the one-pole, non-overlapping limit by combining the independent-particle term and the long-range kernel contribution. Base your derivation on the standard range-separation identity for the Coulomb interaction and the interpretation of the long-range kernel as generating an electron–hole attraction at separation $R$.\n- Define the exact long-range asymptote for the charge-transfer excitation as $\\Omega_{\\mathrm{exact}}(R) = I - A - 1/R$ in atomic units. Explain why this is the correct asymptote for non-overlapping fragments at large $R$.\n\nImplement a program that, for each test case below, computes:\n1. The range-separated-hybrid model excitation $\\Omega_{\\mathrm{RSH}}$ (in Hartree).\n2. The exact long-range asymptote $\\Omega_{\\mathrm{exact}}$ (in Hartree).\n3. The difference $\\Delta = \\Omega_{\\mathrm{RSH}} - \\Omega_{\\mathrm{exact}}$ (in Hartree).\n\nAll energies must be expressed in Hartree and rounded to six decimal places. The distance $R$ must be in bohr, and angles are not involved. Your program must produce a single line of output containing the results as a comma-separated list of lists, where each inner list is of the form $[\\Omega_{\\mathrm{RSH}}, \\Omega_{\\mathrm{exact}}, \\Delta]$ in the same order as the test suite. For example: \"[[x1,y1,z1],[x2,y2,z2],...]\".\n\nUse the following test suite (each tuple is $(I, A, R, \\mu, f_{\\mathrm{LR}})$, with $I$ and $A$ in Hartree, $R$ in bohr, $\\mu$ in bohr$^{-1}$, and $f_{\\mathrm{LR}}$ dimensionless):\n- Case $1$ (happy path with near-asymptotic separation and full long-range exact exchange): $(I, A, R, \\mu, f_{\\mathrm{LR}}) = (\\,0.5,\\,0.1,\\,10.0,\\,0.3,\\,1.0\\,)$.\n- Case $2$ (same as Case $1$ but no long-range exact exchange to test the known deficiency): $(\\,0.5,\\,0.1,\\,10.0,\\,0.3,\\,0.0\\,)$.\n- Case $3$ (moderate separation with large $\\mu$ yielding effectively full long-range behavior): $(\\,0.6,\\,0.05,\\,3.0,\\,2.0,\\,1.0\\,)$.\n- Case $4$ (short separation to probe breakdown of the asymptotic model): $(\\,0.6,\\,0.05,\\,1.0,\\,0.3,\\,1.0\\,)$.\n- Case $5$ (partial long-range exact exchange): $(\\,0.45,\\,0.2,\\,7.5,\\,0.5,\\,0.7\\,)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[[result11,result12,result13],[result21,result22,result23],...]\"). Each result must be a float rounded to six decimal places.", "solution": "The problem statement is subjected to validation and is found to be valid. It is scientifically grounded in the principles of Time-Dependent Density Functional Theory (TDDFT), is well-posed with all necessary information provided, and is formulated objectively. It requires a non-trivial derivation followed by numerical implementation, constituting a legitimate scientific problem.\n\nWe proceed with the derivation and solution.\n\nThe central task is to model the lowest charge-transfer (CT) excitation energy, $\\Omega$, in a donor-acceptor system. We work within the linear-response TDDFT framework under the Tamm-Dancoff approximation (TDA). For a system dominated by a single transition from an occupied orbital $i$ to a virtual orbital $a$, the TDA equation for the excitation energy $\\Omega$ simplifies to:\n$$\n\\Omega = \\omega_{ia} + K_{ia,ia}\n$$\nHere, $\\omega_{ia} = \\epsilon_a - \\epsilon_i$ is the orbital energy difference from the ground-state Kohn-Sham (KS) calculation, where $\\epsilon_i$ is the energy of the donor's highest occupied molecular orbital (HOMO) and $\\epsilon_a$ is the energy of the acceptor's lowest unoccupied molecular orbital (LUMO). The term $K_{ia,ia}$ is the coupling matrix element that accounts for the electron-hole interaction.\n\nFirst, we address the independent-particle term, $\\omega_{ia}$. The problem states to use the fundamental gap, $I - A$, for this term. This is justified by considering the physical meaning of the quantities involved. The ionization potential, $I$, is the energy required to remove an electron from the donor, $D \\rightarrow D^+ + e^-$. The electron affinity, $A$, is the energy released when an electron attaches to the acceptor, $A + e^- \\rightarrow A^-$. Therefore, the energy required to create a separated ion pair $D^+ \\dots A^-$ from the neutral pair $D \\dots A$ at infinite separation is precisely $I - A$. In the context of exact KS theory, the HOMO energy of a system is equal to the negative of its ionization potential, $\\epsilon_{\\mathrm{HOMO}} = -I$. While the LUMO energy is not generally related to the electron affinity in the same simple way, for a two-fragment system at large separation, the KS orbital energy difference $\\epsilon_a - \\epsilon_i$ approaches $I_D - A_A$. Thus, the approximation $\\omega_{ia} \\approx I - A$ is a physically sound starting point for a model of CT excitations.\n\nSecond, we derive the interaction term, $K_{ia,ia}$. This term arises from the exchange-correlation kernel, $f_{xc}$, and the Hartree potential. Within the TDA, the coupling matrix element is:\n$$\nK_{ia,ia} = \\iint \\phi_i^*(\\mathbf{r}_1)\\phi_a(\\mathbf{r}_1) \\left( \\frac{1}{|\\mathbf{r}_1 - \\mathbf{r}_2|} + f_{xc}(\\mathbf{r}_1, \\mathbf{r}_2) \\right) \\phi_i(\\mathbf{r}_2)\\phi_a^*(\\mathbf{r}_2) \\, d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\nFor a CT excitation between non-overlapping fragments, the transition densities $\\phi_i^*(\\mathbf{r})\\phi_a(\\mathbf{r})$ are essentially zero everywhere. For conventional (semi-)local density functionals, where $f_{xc}$ is a local or semi-local function of the density, this causes the entire coupling term $K_{ia,ia}$ to vanish. This leads to the well-known failure of such functionals, predicting $\\Omega_{\\mathrm{CT}} \\approx I - A$, independent of the separation $R$.\n\nRange-separated hybrid (RSH) functionals correct this deficiency by incorporating a fraction of non-local exact (Hartree-Fock) exchange, particularly at long range. The exchange-correlation kernel for an RSH functional contains a long-range component derived from the exact exchange operator. The contribution to the coupling matrix from exact exchange is given by:\n$$\nK_{ia,ia}^{\\mathrm{x}} = - \\iint \\phi_i^*(\\mathbf{r}_1)\\phi_a(\\mathbf{r}_1) \\left( f_{\\mathrm{LR}} \\frac{\\mathrm{erf}(\\mu|\\mathbf{r}_1 - \\mathbf{r}_2|)}{|\\mathbf{r}_1 - \\mathbf{r}_2|} \\right) \\phi_a^*(\\mathbf{r}_2)\\phi_i(\\mathbf{r}_2) \\, d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\nThis is the exchange integral, often denoted as $-(ia|ai)$. Due to the non-overlapping nature of orbitals $i$ and $a$, this integral evaluates to the Coulomb attraction between the hole density, $|\\phi_i(\\mathbf{r}_1)|^2$, and the electron density, $|\\phi_a(\\mathbf{r}_2)|^2$, mediated by the long-range part of the exchange operator.\n$$\nK_{ia,ia} \\approx - f_{\\mathrm{LR}} \\iint |\\phi_i(\\mathbf{r}_1)|^2 \\left( \\frac{\\mathrm{erf}(\\mu|\\mathbf{r}_1 - \\mathbf{r}_2|)}{|\\mathbf{r}_1 - \\mathbf{r}_2|} \\right) |\\phi_a(\\mathbf{r}_2)|^2 \\, d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\nFor fragments separated by a large center-to-center distance $R$, we can approximate the hole and electron densities as point charges located at their respective fragment centers. Under this approximation, $|\\mathbf{r}_1 - \\mathbf{r}_2| \\approx R$, and the integral simplifies to:\n$$\nK_{ia,ia} \\approx -f_{\\mathrm{LR}} \\frac{\\mathrm{erf}(\\mu R)}{R}\n$$\nCombining the independent-particle and interaction terms, we obtain the closed-form model for the RSH charge-transfer excitation energy:\n$$\n\\Omega_{\\mathrm{RSH}}(R; \\mu, f_{\\mathrm{LR}}) = I - A - f_{\\mathrm{LR}} \\frac{\\mathrm{erf}(\\mu R)}{R}\n$$\n\nThird, we establish the correct asymptotic form for the CT excitation energy. For two non-overlapping fragments at a large separation $R$, the energy to create the CT state $D^+A^-$ from the neutral ground state $DA$ can be determined from basic physical principles. The process involves two steps: first, generating the ion pair at infinite separation, which costs energy $I - A$; second, bringing the point-like ions $D^+$ and $A^-$ from infinity to a separation $R$, which releases the Coulomb attraction energy. In atomic units (Hartree for energy, bohr for distance), this electrostatic energy is $-1/R$. The total energy is therefore:\n$$\n\\Omega_{\\mathrm{exact}}(R) = I - A - \\frac{1}{R}\n$$\nThis is the exact asymptotic limit that a correct theory must recover. Our derived RSH model does this when $f_{\\mathrm{LR}}=1$ and $\\mu R \\gg 1$, since $\\mathrm{erf}(x) \\to 1$ as $x \\to \\infty$.\n\nFinally, the difference $\\Delta$ between the model and the exact asymptote is:\n$$\n\\Delta = \\Omega_{\\mathrm{RSH}} - \\Omega_{\\mathrm{exact}} = \\left( I - A - f_{\\mathrm{LR}} \\frac{\\mathrm{erf}(\\mu R)}{R} \\right) - \\left( I - A - \\frac{1}{R} \\right) = \\frac{1}{R} - f_{\\mathrm{LR}} \\frac{\\mathrm{erf}(\\mu R)}{R}\n$$\n\nThe implementation will compute the following three quantities for each test case:\n1.  $\\Omega_{\\mathrm{RSH}} = I - A - f_{\\mathrm{LR}} \\frac{\\mathrm{erf}(\\mu R)}{R}$\n2.  $\\Omega_{\\mathrm{exact}} = I - A - \\frac{1}{R}$\n3.  $\\Delta = \\frac{1}{R} \\left( 1 - f_{\\mathrm{LR}} \\, \\mathrm{erf}(\\mu R) \\right)$\n\nAll calculations are performed in atomic units (Hartree and bohr).", "answer": "```python\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Computes charge-transfer excitation energies for a donor-acceptor system\n    using a simplified TDDFT model and compares them to the exact asymptote.\n    \"\"\"\n\n    # Test suite: (I, A, R, mu, f_LR)\n    # I: Ionization potential (Hartree)\n    # A: Electron affinity (Hartree)\n    # R: Donor-acceptor distance (bohr)\n    # mu: Range-separation parameter (bohr^-1)\n    # f_LR: Fraction of long-range exact exchange (dimensionless)\n    test_cases = [\n        (0.5, 0.1, 10.0, 0.3, 1.0),\n        (0.5, 0.1, 10.0, 0.3, 0.0),\n        (0.6, 0.05, 3.0, 2.0, 1.0),\n        (0.6, 0.05, 1.0, 0.3, 1.0),\n        (0.45, 0.2, 7.5, 0.5, 0.7),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        I, A, R, mu, f_LR = case\n\n        # Ensure R is not zero to avoid division by zero\n        if R = 0:\n            raise ValueError(\"Distance R must be positive.\")\n\n        # Independent-particle energy (fundamental gap)\n        # This is the energy to create the ion pair at infinite separation.\n        omega_ia = I - A\n\n        # Calculate Omega_RSH using the derived model\n        # Omega_RSH = I - A - f_LR * erf(mu * R) / R\n        interaction_term_rsh = f_LR * erf(mu * R) / R\n        omega_rsh = omega_ia - interaction_term_rsh\n\n        # Calculate the exact long-range asymptotic energy\n        # Omega_exact = I - A - 1/R\n        interaction_term_exact = 1.0 / R\n        omega_exact = omega_ia - interaction_term_exact\n\n        # Calculate the difference Delta\n        # Delta = Omega_RSH - Omega_exact\n        delta = omega_rsh - omega_exact\n\n        # Round all results to six decimal places\n        rounded_omega_rsh = round(omega_rsh, 6)\n        rounded_omega_exact = round(omega_exact, 6)\n        rounded_delta = round(delta, 6)\n\n        results.append([rounded_omega_rsh, rounded_omega_exact, rounded_delta])\n\n    # Format the output string as a list of lists.\n    # e.g., \"[[result11,result12,result13],[result21,result22,result23],...]\"\n    output_str = \"[\" + \",\".join([f\"[{r[0]:.6f},{r[1]:.6f},{r[2]:.6f}]\" for r in results]) + \"]\"\n    \n    print(output_str)\n\nsolve()\n```", "id": "2932958"}]}