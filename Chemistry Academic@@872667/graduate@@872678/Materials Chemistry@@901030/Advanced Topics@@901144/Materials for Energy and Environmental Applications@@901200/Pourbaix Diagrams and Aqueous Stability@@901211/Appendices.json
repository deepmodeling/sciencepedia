{"hands_on_practices": [{"introduction": "The diagonal lines that define the region of water stability on any Pourbaix diagram are its most universal feature. This exercise takes you back to first principles to show that this slope is not an arbitrary convention but a direct consequence of the thermodynamics of water electrolysis. By applying the Nernst equation to the hydrogen and oxygen evolution reactions, you will derive the famous $-0.05916 \\, \\mathrm{V/pH}$ slope and understand its origin in the stoichiometry of protons and electrons. [@problem_id:2515014]", "problem": "A water Pourbaix diagram delineates the potential ($E$) and acidity ($\\mathrm{pH}$) ranges where liquid water is thermodynamically stable against reduction to hydrogen gas and oxidation to oxygen gas. The bounding half-reactions in acidic aqueous solution, written as reductions, are\n- $2\\,\\mathrm{H}^{+} + 2\\,e^{-} \\rightleftharpoons \\mathrm{H}_{2}(g)$,\n- $\\mathrm{O}_{2}(g) + 4\\,\\mathrm{H}^{+} + 4\\,e^{-} \\rightleftharpoons 2\\,\\mathrm{H}_{2}\\mathrm{O}(\\ell)$.\n\nAssume ideal behavior for the aqueous protons such that $a_{\\mathrm{H}^{+}} \\approx 10^{-\\mathrm{pH}}$, unit activity for liquid water, and unit fugacity for the gases at their standard state. Let the electrode potential $E$ be referenced to the Standard Hydrogen Electrode (SHE), and let $\\mathrm{pH} = -\\log_{10} a_{\\mathrm{H}^{+}}$. Use as fundamental input the Nernst equation for a general half-reaction and the definitions of chemical activity and $\\mathrm{pH}$. Take the temperature to be $T = 298.15\\,\\mathrm{K}$, the universal gas constant to be $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, and the Faraday constant to be $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$.\n\n(a) Starting from first principles, derive the $\\mathrm{pH}$-dependence of $E$ for each of the two water stability half-reactions above and show that the slope $\\mathrm{d}E/\\mathrm{d}(\\mathrm{pH})$ is the same for both. Your derivation must explicitly connect the stoichiometric coefficient of $\\mathrm{H}^{+}$ and the electron count $n$ in the Nernst equation to the $\\mathrm{pH}$-slope.\n\n(b) Evaluate this common slope numerically at $T = 298.15\\,\\mathrm{K}$. Express your final result as a single real number in volts per $\\mathrm{pH}$ unit. Round your final answer to four significant figures. Do not write units in your final boxed answer; elsewhere, report the units as volts per $\\mathrm{pH}$ unit.", "solution": "The problem presented is a standard exercise in fundamental electrochemistry and is entirely valid. It requires the derivation of the potential-pH relationship for the stability limits of water from the Nernst equation. We will proceed with a rigorous derivation.\n\n(a) Derivation of the $\\mathrm{pH}$-dependence of $E$ and the common slope.\n\nThe analysis begins with the Nernst equation for a general electrochemical half-reaction at a temperature $T$:\n$$ \\mathrm{Ox} + n e^{-} \\rightleftharpoons \\mathrm{Red} $$\nwhere $\\mathrm{Ox}$ represents the oxidized species, $\\mathrm{Red}$ the reduced species, and $n$ is the number of electrons transferred. The electrode potential $E$ relative to the Standard Hydrogen Electrode (SHE) is given by:\n$$ E = E^{\\circ} - \\frac{RT}{nF} \\ln Q $$\nHere, $E^{\\circ}$ is the standard electrode potential, $R$ is the universal gas constant, $F$ is the Faraday constant, and $Q$ is the reaction quotient, defined by the activities ($a_i$) of the participating species, $Q = \\frac{\\prod a_{\\mathrm{Red}}^{|\\nu_{\\mathrm{Red}}|}}{\\prod a_{\\mathrm{Ox}}^{|\\nu_{\\mathrm{Ox}}|}}$.\n\nMany half-reactions, including those defining the stability of water, involve protons, $\\mathrm{H}^{+}$. We consider a general form for such a reaction written as a reduction:\n$$ \\alpha\\,\\mathrm{Ox} + m\\,\\mathrm{H}^{+} + n\\,e^{-} \\rightleftharpoons \\beta\\,\\mathrm{Red} + w\\,\\mathrm{H}_{2}\\mathrm{O} $$\nThe reaction quotient for this general process is:\n$$ Q = \\frac{a_{\\mathrm{Red}}^{\\beta} \\, a_{\\mathrm{H}_{2}\\mathrm{O}}^{w}}{a_{\\mathrm{Ox}}^{\\alpha} \\, a_{\\mathrm{H}^{+}}^{m}} $$\nSubstituting this into the Nernst equation yields:\n$$ E = E^{\\circ} - \\frac{RT}{nF} \\ln \\left( \\frac{a_{\\mathrm{Red}}^{\\beta} \\, a_{\\mathrm{H}_{2}\\mathrm{O}}^{w}}{a_{\\mathrm{Ox}}^{\\alpha} \\, a_{\\mathrm{H}^{+}}^{m}} \\right) $$\nThis expression can be rearranged using the properties of the logarithm:\n$$ E = E^{\\circ} - \\frac{RT}{nF} \\left( \\ln(a_{\\mathrm{Red}}^{\\beta}) + \\ln(a_{\\mathrm{H}_{2}\\mathrm{O}}^{w}) - \\ln(a_{\\mathrm{Ox}}^{\\alpha}) - \\ln(a_{\\mathrm{H}^{+}}^{m}) \\right) $$\n$$ E = E^{\\circ} - \\frac{RT}{nF} \\ln \\left( \\frac{a_{\\mathrm{Red}}^{\\beta} \\, a_{\\mathrm{H}_{2}\\mathrm{O}}^{w}}{a_{\\mathrm{Ox}}^{\\alpha}} \\right) + \\frac{mRT}{nF} \\ln(a_{\\mathrm{H}^{+}}) $$\nThe problem defines $\\mathrm{pH} = -\\log_{10}(a_{\\mathrm{H}^{+}})$. We must convert the natural logarithm to base-$10$: $\\ln(x) = (\\ln 10) \\log_{10}(x)$. Thus, $\\ln(a_{\\mathrm{H}^{+}}) = (\\ln 10) \\log_{10}(a_{\\mathrm{H}^{+}}) = -(\\ln 10)\\,\\mathrm{pH}$. Substituting this gives the potential as a function of $\\mathrm{pH}$:\n$$ E = E^{\\circ} - \\frac{RT}{nF} \\ln \\left( \\frac{a_{\\mathrm{Red}}^{\\beta} \\, a_{\\mathrm{H}_{2}\\mathrm{O}}^{w}}{a_{\\mathrm{Ox}}^{\\alpha}} \\right) - \\frac{m}{n} \\frac{RT\\ln 10}{F} \\mathrm{pH} $$\nFor the stability lines of a Pourbaix diagram, the activities of all species except $\\mathrm{H}^{+}$ are taken to be unity. That is, $a_{\\mathrm{Ox}} = 1$, $a_{\\mathrm{Red}} = 1$, and $a_{\\mathrm{H}_{2}\\mathrm{O}} = 1$. Under these standard conditions, the equation simplifies to:\n$$ E = E^{\\circ} - \\frac{m}{n} \\frac{RT\\ln 10}{F} \\mathrm{pH} $$\nThe slope of the potential with respect to $\\mathrm{pH}$ is the derivative $\\frac{\\mathrm{d}E}{\\mathrm{d}(\\mathrm{pH})}$. From the equation above, it is immediately clear that:\n$$ \\frac{\\mathrm{d}E}{\\mathrm{d}(\\mathrm{pH})} = -\\frac{m}{n} \\frac{RT\\ln 10}{F} $$\nThis result explicitly connects the slope to the stoichiometric coefficient of protons, $m$, and the number of electrons transferred, $n$.\n\nNow, we apply this general formula to the two specific half-reactions provided.\n\n1.  **Reduction of $\\mathrm{H}^{+}$ to $\\mathrm{H}_{2}(g)$:**\n    $$ 2\\,\\mathrm{H}^{+} + 2\\,e^{-} \\rightleftharpoons \\mathrm{H}_{2}(g) $$\n    For this reaction, the stoichiometric coefficient of $\\mathrm{H}^{+}$ is $m=2$, and the number of electrons is $n=2$. The ratio is $\\frac{m}{n} = \\frac{2}{2} = 1$. The standard potential is $E^{\\circ}_{\\mathrm{H}^{+}/\\mathrm{H}_{2}} = 0\\,\\mathrm{V}$ by definition. The potential for this boundary is:\n    $$ E_{\\mathrm{H}_{2}} = 0 - \\frac{2}{2} \\frac{RT\\ln 10}{F} \\mathrm{pH} = - \\frac{RT\\ln 10}{F} \\mathrm{pH} $$\n    The slope is:\n    $$ \\frac{\\mathrm{d}E_{\\mathrm{H}_{2}}}{\\mathrm{d}(\\mathrm{pH})} = -\\frac{RT\\ln 10}{F} $$\n\n2.  **Reduction of $\\mathrm{O}_{2}(g)$ to $\\mathrm{H}_{2}\\mathrm{O}(\\ell)$:**\n    $$ \\mathrm{O}_{2}(g) + 4\\,\\mathrm{H}^{+} + 4\\,e^{-} \\rightleftharpoons 2\\,\\mathrm{H}_{2}\\mathrm{O}(\\ell) $$\n    For this reaction, the stoichiometric coefficient of $\\mathrm{H}^{+}$ is $m=4$, and the number of electrons is $n=4$. The ratio is $\\frac{m}{n} = \\frac{4}{4} = 1$. Let the standard potential be $E^{\\circ}_{\\mathrm{O}_{2}/\\mathrm{H}_{2}\\mathrm{O}}$. The potential for this boundary is:\n    $$ E_{\\mathrm{O}_{2}} = E^{\\circ}_{\\mathrm{O}_{2}/\\mathrm{H}_{2}\\mathrm{O}} - \\frac{4}{4} \\frac{RT\\ln 10}{F} \\mathrm{pH} = E^{\\circ}_{\\mathrm{O}_{2}/\\mathrm{H}_{2}\\mathrm{O}} - \\frac{RT\\ln 10}{F} \\mathrm{pH} $$\n    The slope is:\n    $$ \\frac{\\mathrm{d}E_{\\mathrm{O}_{2}}}{\\mathrm{d}(\\mathrm{pH})} = -\\frac{RT\\ln 10}{F} $$\n\nBoth slopes are identical, as was to be shown. The reason for this identity is that the ratio of protons consumed to electrons transferred, $\\frac{m}{n}$, is unity for both half-reactions that define the stability window of water. This completes the derivation for part (a).\n\n(b) Numerical evaluation of the common slope.\n\nThe common slope is given by the expression $S = -\\frac{RT\\ln 10}{F}$. We substitute the given physical constants:\n$T = 298.15\\,\\mathrm{K}$\n$R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n$F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$\n\nThe calculation proceeds as follows:\n$$ S = - \\frac{(8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (298.15\\,\\mathrm{K}) \\times \\ln(10)}{96485.33212\\,\\mathrm{C\\,mol^{-1}}} $$\nThe term $\\ln(10) \\approx 2.30258509$.\nThe units of the expression are $\\mathrm{J\\,C^{-1}}$, which is a volt ($\\mathrm{V}$). Thus, the slope has units of volts per $\\mathrm{pH}$ unit.\n$$ S = - \\frac{8.314462618 \\times 298.15 \\times 2.30258509}{96485.33212} \\, \\mathrm{V} $$\n$$ S \\approx - \\frac{5706.059}{96485.33212} \\, \\mathrm{V} $$\n$$ S \\approx -0.05915984... \\, \\mathrm{V} $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ S \\approx -0.05916 \\, \\mathrm{V} $$\nThis value is a fundamental constant in room-temperature electrochemistry, often referred to as the Nernstian slope for a one-proton, one-electron process.", "answer": "$$\n\\boxed{-0.05916}\n$$", "id": "2515014"}, {"introduction": "While foundational, simple Pourbaix diagrams often make a simplifying assumption: that a dissolved metal exists as a single free ion. This practice challenges that assumption by introducing the crucial concept of hydrolysis, where metal aquo-ions act as acids. You will calculate the pH at which a metal ion begins to speciate into its first hydrolysis product, providing a tangible sense of how aqueous complexation impacts a metal's true solubility and shifts stability boundaries. [@problem_id:2515029]", "problem": "A trivalent metal ion in water undergoes stepwise hydrolysis via proton transfer from coordinated water. Consider the first two hydrolysis steps at temperature $T=298.15\\,\\mathrm{K}$ and low ionic strength where activity coefficients can be approximated as unity:\n$$\\mathrm{M(H_2O)_6^{3+}} \\rightleftharpoons \\mathrm{M(H_2O)_5(OH)^{2+}} + \\mathrm{H^+},$$\n$$\\mathrm{M(H_2O)_5(OH)^{2+}} \\rightleftharpoons \\mathrm{M(H_2O)_4(OH)_2^{+}} + \\mathrm{H^+}.$$\nDefine the stepwise acid dissociation constants by the law of mass action as\n$$K_1 \\equiv \\frac{a_{\\mathrm{M(OH)^{2+}}}\\,a_{\\mathrm{H^+}}}{a_{\\mathrm{M^{3+}}}}, \\qquad K_2 \\equiv \\frac{a_{\\mathrm{M(OH)_2^{+}}}\\,a_{\\mathrm{H^+}}}{a_{\\mathrm{M(OH)^{2+}}}},$$\nwhere activities $a_i$ are approximated by molar concentrations. At $T=298.15\\,\\mathrm{K}$, take the numerical values $K_1 = 10^{-5.20}$ and $K_2 = 10^{-8.80}$. Assume that at moderately acidic $\\mathrm{pH}$ the mononuclear species $\\mathrm{M^{3+}}$ and $\\mathrm{M(OH)^{2+}}$ dominate the dissolved speciation.\n\nCompute the $\\mathrm{pH}$ at which exactly one-half of the total dissolved metal is present as $\\mathrm{M^{3+}}$ and one-half as $\\mathrm{M(OH)^{2+}}$. Round your answer to three significant figures.\n\nThen, using only fundamental equilibrium relations and without performing any additional numerical calculation, briefly interpret how, at this $\\mathrm{pH}$, accounting for hydrolysis would shift the precipitation boundary of $\\mathrm{M(OH)_3(s)}$ on a Pourbaix diagram (potential–$\\mathrm{pH}$ diagram) relative to a naïve construction that ignores hydrolysis. Your interpretation should rely on the solubility product concept for $\\mathrm{M(OH)_3(s)}$ and the relationship between free-ion activity and total dissolved metal, but your final reported answer must be only the computed $\\mathrm{pH}$ value.", "solution": "The problem presents a scenario of stepwise hydrolysis for a trivalent metal aquo-ion, $\\mathrm{M(H_2O)_6^{3+}}$, and asks for the computation of the $\\mathrm{pH}$ under a specific condition of species distribution, followed by a conceptual interpretation related to Pourbaix diagrams. I will first address the calculation and then the interpretation.\n\nThe problem is stated with sufficient information and is scientifically sound. The hydrolysis reactions are:\n$$\n\\mathrm{M(H_2O)_6^{3+}} \\rightleftharpoons \\mathrm{M(H_2O)_5(OH)^{2+}} + \\mathrm{H^+}\n$$\n$$\n\\mathrm{M(H_2O)_5(OH)^{2+}} \\rightleftharpoons \\mathrm{M(H_2O)_4(OH)_2^{+}} + \\mathrm{H^+}\n$$\nFor simplicity, we denote $\\mathrm{M(H_2O)_6^{3+}}$ as $\\mathrm{M^{3+}}$, $\\mathrm{M(H_2O)_5(OH)^{2+}}$ as $\\mathrm{M(OH)^{2+}}$, and $\\mathrm{M(H_2O)_4(OH)_2^{+}}$ as $\\mathrm{M(OH)_2^{+}}$. Activities are approximated by molar concentrations, as stated.\n\nThe total concentration of dissolved metal, $C_{tot}$, under the provided assumption that only the first two species, $\\mathrm{M^{3+}}$ and $\\mathrm{M(OH)^{2+}}$, are dominant, is given by the sum of their concentrations:\n$$C_{tot} \\approx [\\mathrm{M^{3+}}] + [\\mathrm{M(OH)^{2+}}]$$\nThe problem requires finding the $\\mathrm{pH}$ where exactly one-half of the total dissolved metal is present as $\\mathrm{M^{3+}}$ and one-half as $\\mathrm{M(OH)^{2+}}$. This condition is expressed mathematically as:\n$$[\\mathrm{M^{3+}}] = \\frac{1}{2} C_{tot}$$\n$$[\\mathrm{M(OH)^{2+}}] = \\frac{1}{2} C_{tot}$$\nFrom these two equations, it immediately follows that the concentrations of the two dominant species are equal:\n$$[\\mathrm{M^{3+}}] = [\\mathrm{M(OH)^{2+}}]$$\nThe equilibrium for the first hydrolysis step is governed by the acid dissociation constant $K_1$:\n$$K_1 = \\frac{[\\mathrm{M(OH)^{2+}}][\\mathrm{H^+}]}{[\\mathrm{M^{3+}}]}$$\nSubstituting the condition of equal concentrations into the equilibrium expression, we find that the terms for the metal species cancel:\n$$K_1 = \\frac{[\\mathrm{M(OH)^{2+}}][\\mathrm{H^+}]}{[\\mathrm{M(OH)^{2+}}]} = [\\mathrm{H^+}]$$\nThis very direct result indicates that the specified condition is met when the hydrogen ion concentration is numerically equal to the first acid dissociation constant. We are given $K_1 = 10^{-5.20}$ at $T = 298.15\\,\\mathrm{K}$.\nTherefore, $[\\mathrm{H^+}] = 10^{-5.20}\\,\\mathrm{M}$.\nThe $\\mathrm{pH}$ is defined as $\\mathrm{pH} = -\\log_{10}([\\mathrm{H^+}])$. We can now calculate the required $\\mathrm{pH}$:\n$$\\mathrm{pH} = -\\log_{10}(K_1) = -\\log_{10}(10^{-5.20}) = 5.20$$\nThe answer must be given to three significant figures. The value $5.20$ satisfies this requirement.\n\nIt is prudent to verify the self-consistency of the assumption that $[\\mathrm{M(OH)_2^{+}}]$ is negligible. The second equilibrium is defined by $K_2$:\n$$K_2 = \\frac{[\\mathrm{M(OH)_2^{+}}][\\mathrm{H^+}]}{[\\mathrm{M(OH)^{2+}}]}$$\nAt the calculated $\\mathrm{pH}$, we have $[\\mathrm{H^+}] = K_1$. We can find the ratio of the third species to the second:\n$$\\frac{[\\mathrm{M(OH)_2^{+}}]}{[\\mathrm{M(OH)^{2+}}]} = \\frac{K_2}{[\\mathrm{H^+}]} = \\frac{K_2}{K_1} = \\frac{10^{-8.80}}{10^{-5.20}} = 10^{-3.60}$$\nSince $10^{-3.60} \\approx 2.5 \\times 10^{-4}$, the concentration of $\\mathrm{M(OH)_2^{+}}$ is less than $0.03\\%$ of the concentration of $\\mathrm{M(OH)^{2+}}$. This is a negligible quantity, thus the simplifying assumption given in the problem is valid and self-consistent.\n\nFor the second part of the problem, an interpretation of the effect of hydrolysis on the precipitation boundary of $\\mathrm{M(OH)_3(s)}$ is required. A Pourbaix diagram plots regions of thermodynamic stability for different species as a function of electrochemical potential and $\\mathrm{pH}$. The boundary between a dissolved species and a solid precipitate like $\\mathrm{M(OH)_3(s)}$ is determined by the solubility product, $K_{sp}$. For $\\mathrm{M(OH)_3(s)}$, the precipitation equilibrium is:\n$$\\mathrm{M^{3+}} + 3\\mathrm{OH^-} \\rightleftharpoons \\mathrm{M(OH)_3(s)}, \\qquad K_{sp} = [\\mathrm{M^{3+}}][\\mathrm{OH^-}]^3$$\nA naive construction of the diagram might ignore hydrolysis, thereby incorrectly equating the total dissolved metal concentration, $C_{tot}$, with the free ion concentration, $[\\mathrm{M^{3+}}]$.\nHowever, hydrolysis leads to the formation of complex ions, so the total dissolved metal is the sum of all species: $C_{tot} = [\\mathrm{M^{3+}}] + [\\mathrm{M(OH)^{2+}}] + [\\mathrm{M(OH)_2^{+}}] + \\dots$.\nThe concentration of the free ion is thus only a fraction of the total: $[\\mathrm{M^{3+}}] = \\alpha_0 C_{tot}$, where $\\alpha_0 = (1 + K_1/[\\mathrm{H^+}] + K_1K_2/[\\mathrm{H^+}]^2 + \\dots)^{-1}$. Since $\\alpha_0 < 1$ for any finite $\\mathrm{pH}$, hydrolysis effectively reduces the concentration of the free ion $[\\mathrm{M^{3+}}]$ available to form the precipitate.\nAt the $\\mathrm{pH}=5.20$ calculated, we found that $[\\mathrm{M^{3+}}]$ is only about half of the total dissolved metal (since $\\alpha_0 \\approx 0.5$). For precipitation to occur, the ion product must exceed $K_{sp}$. Because the actual $[\\mathrm{M^{3+}}]$ is lower than $C_{tot}$, a higher concentration of $[\\mathrm{OH^-}]$ (and thus a higher $\\mathrm{pH}$) is required to reach the saturation point compared to the naive case. This means that the metal is more soluble than one would predict without considering hydrolysis. Consequently, the domain of stability for the dissolved species expands, and the precipitation boundary for $\\mathrm{M(OH)_3(s)}$ on the Pourbaix diagram is shifted to higher $\\mathrm{pH}$ values.", "answer": "$$\\boxed{5.20}$$", "id": "2515029"}, {"introduction": "Moving from schematic diagrams to quantitative prediction requires integrating multiple, interdependent chemical equilibria. This capstone exercise guides you through the design of a computational algorithm to solve for the complete speciation of a metal in water, accounting for redox chemistry, hydrolysis, mass and charge balance, and non-ideal solution effects via activity corrections. This practice mirrors the sophisticated modeling approach used in modern corrosion science and geochemistry to predict material behavior in complex aqueous environments. [@problem_id:2515057]", "problem": "You are tasked with implementing a computational algorithm to compute aqueous speciation for a redox-active metal across a set of points in electric potential–pH space while enforcing electroneutrality and total mass balance with activity corrections. The system is an aqueous solution at temperature $T=298.15\\ \\mathrm{K}$ containing a trivalent metal undergoing one-electron reduction to a divalent state and stepwise hydrolysis in water. The algorithm must be derived and implemented from the following foundational laws and definitions, without relying on any shortcuts beyond these statements:\n\n- Mass action for chemical equilibria with activities: if the reaction is written with water as solvent and pure liquid, the equilibrium constant $K$ uses only solute activities.\n- The Nernst equation: for the reduction half-reaction $\\mathrm{M}^{3+} + e^- \\rightleftharpoons \\mathrm{M}^{2+}$, the potential satisfies $E = E^\\circ - \\dfrac{RT}{F} \\ln Q$ with $Q = \\dfrac{a_{\\mathrm{M}^{2+}}}{a_{\\mathrm{M}^{3+}}}$, where $R$ is the universal gas constant and $F$ is the Faraday constant.\n- Electroneutrality: the sum of charge-weighted molar concentrations of all charged species in solution is zero.\n- Total mass balance on the metal: the sum of molar concentrations of all metal-containing species equals the total analytical metal concentration.\n- Activity–concentration relationship: $a_i = \\gamma_i c_i$, where $a_i$ is activity, $c_i$ is molar concentration, and $\\gamma_i$ is the activity coefficient.\n- Davies equation for activity coefficients at ionic strength $I$: $\\log_{10} \\gamma_i = -A z_i^2\\left(\\dfrac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I \\right)$ for ions of charge $z_i$, with $A=0.509$ for water at $T=298.15\\ \\mathrm{K}$; for neutral species, $\\gamma_i=1$.\n- Ionic strength definition: $I = \\dfrac{1}{2}\\sum_i z_i^2 c_i$ over all charged species.\n- Hydrogen ion definition of pH: $\\mathrm{pH} = -\\log_{10} a_{\\mathrm{H}^+}$.\n- Water autoprotolysis in terms of activities: $K_w = a_{\\mathrm{H}^+} a_{\\mathrm{OH}^-}$.\n\nModel system and parameters:\n- Half-reaction and standard potential: $\\mathrm{M}^{3+} + e^- \\rightleftharpoons \\mathrm{M}^{2+}$ with $E^\\circ = 0.771\\ \\mathrm{V}$ at $T=298.15\\ \\mathrm{K}$.\n- Hydrolysis equilibria at $T=298.15\\ \\mathrm{K}$ (activities):\n  1. $\\mathrm{M}^{3+} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{M(OH)}^{2+} + \\mathrm{H}^+$ with $K_1 = 10^{-2.19}$.\n  2. $\\mathrm{M(OH)}^{2+} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{M(OH)}_2^{+} + \\mathrm{H}^+$ with $K_2 = 10^{-3.50}$.\n  3. $\\mathrm{M(OH)}_2^{+} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{M(OH)}_3^{0} + \\mathrm{H}^+$ with $K_3 = 10^{-6.00}$.\n- Water ion product: $K_w = 10^{-14}$ (in activities).\n- Constants: $R = 8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$, $F = 96485.33212\\ \\mathrm{C\\ mol^{-1}}$, $A=0.509$ (Davies constant at $T=298.15\\ \\mathrm{K}$).\n\nUnknown aqueous species to compute at each $(E,\\mathrm{pH})$:\n- $\\mathrm{M}^{3+}$, $\\mathrm{M}^{2+}$, $\\mathrm{M(OH)}^{2+}$, $\\mathrm{M(OH)}_2^{+}$, $\\mathrm{M(OH)}_3^{0}$, $\\mathrm{H}^+$, $\\mathrm{OH}^-$, and a single non-reactive background counter-ion added as needed to enforce electroneutrality, with charge $z_{\\mathrm{bal}} \\in \\{+1,-1\\}$ and concentration $c_{\\mathrm{bal}} \\ge 0$ chosen such that total charge is exactly zero.\n\nAlgorithmic requirements:\n- Treat $\\mathrm{pH}$ as the negative base-$10$ logarithm of the hydrogen ion activity: $a_{\\mathrm{H}^+} = 10^{-\\mathrm{pH}}$.\n- Use the Davies equation to compute ionic activity coefficients $\\gamma_i$ self-consistently with the ionic strength $I$. Because $I$ depends on all charged species concentrations and those depend on $\\gamma_i$, you must perform a fixed-point iteration on $I$ until convergence.\n- At each iteration, enforce total metal mass balance exactly and electroneutrality exactly by adding the single background counter-ion of appropriate sign. The ionic strength must be recomputed including this background ion before the next iteration of the activity coefficients.\n- For the redox couple, enforce the Nernst relation between activities, not concentrations. For hydrolysis, enforce mass action using activities, assuming the activity of water is unity.\n\nDerivation targets to use in your implementation:\n- From the Nernst equation, derive the activity ratio $r = \\dfrac{a_{\\mathrm{M}^{2+}}}{a_{\\mathrm{M}^{3+}}} = \\exp\\!\\left(-\\dfrac{(E - E^\\circ)F}{RT}\\right)$.\n- From hydrolysis step equilibria, derive $a_{\\mathrm{M(OH)}^{2+}} = \\dfrac{K_1 a_{\\mathrm{M}^{3+}}}{a_{\\mathrm{H}^+}}$, $a_{\\mathrm{M(OH)}_2^{+}} = \\dfrac{K_1 K_2 a_{\\mathrm{M}^{3+}}}{a_{\\mathrm{H}^+}^2}$, and $a_{\\mathrm{M(OH)}_3^{0}} = \\dfrac{K_1 K_2 K_3 a_{\\mathrm{M}^{3+}}}{a_{\\mathrm{H}^+}^3}$.\n- Use $a_i = \\gamma_i c_i$ to convert to concentrations and enforce the total metal balance $C_{\\mathrm{M,tot}} = c_{\\mathrm{M}^{3+}} + c_{\\mathrm{M}^{2+}} + c_{\\mathrm{M(OH)}^{2+}} + c_{\\mathrm{M(OH)}_2^{+}} + c_{\\mathrm{M(OH)}_3^{0}}$ to solve for $a_{\\mathrm{M}^{3+}}$ explicitly.\n- Enforce electroneutrality by setting the background ion concentration to be precisely the magnitude of the net charge of all other species with opposite sign at each iteration.\n- Iterate until the ionic strength $I$ converges within a strict tolerance.\n\nTest suite:\nImplement your algorithm for the following input cases, each specified by a tuple $(\\mathrm{pH}, E\\ \\mathrm{(V)}, C_{\\mathrm{M,tot}}\\ \\mathrm{(mol\\ L^{-1})})$ at $T=298.15\\ \\mathrm{K}$:\n- Case A: $(2.0,\\ 0.30,\\ 10^{-6})$\n- Case B: $(6.0,\\ 0.771,\\ 10^{-6})$\n- Case C: $(9.0,\\ 1.00,\\ 10^{-6})$\n- Case D: $(8.0,\\ 0.20,\\ 10^{-4})$\n- Case E: $(7.0,\\ 0.771,\\ 10^{-8})$\n\nFor each case, your program must compute and return the following four quantities in order:\n1) The fraction of total dissolved metal present as $\\mathrm{M}^{2+}$, i.e., $c_{\\mathrm{M}^{2+}}/C_{\\mathrm{M,tot}}$ (dimensionless).\n2) The fraction of total dissolved metal present as the neutral species $\\mathrm{M(OH)}_3^{0}$, i.e., $c_{\\mathrm{M(OH)}_3^{0}}/C_{\\mathrm{M,tot}}$ (dimensionless).\n3) The final converged ionic strength $I$ in $\\mathrm{mol\\ L^{-1}}$.\n4) The absolute electroneutrality residual, i.e., $\\left|\\sum_i z_i c_i\\right|$ in $\\mathrm{mol\\ L^{-1}}$ after adding the background ion.\n\nFinal output format:\nYour program should produce a single line of output containing a comma-separated Python-style list of floating-point results that aggregates all cases in the order A through E, each case contributing its four results in the order above. For example, the output must look like\n\"[v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14,v15,v16,v17,v18,v19,v20]\"\nwith exactly $20$ entries corresponding to the five cases times four values per case. All ionic strengths and concentrations must be in $\\mathrm{mol\\ L^{-1}}$; all potentials are in $\\mathrm{V}$ by construction; fractions are dimensionless. Angles do not appear in this problem. Express fractional quantities as decimal numbers, not as percentages.", "solution": "The problem requires the computation of aqueous speciation for a redox-active metal system by solving a set of non-linear equations describing chemical equilibria. The solution is subject to constraints of mass balance and electroneutrality, with non-ideal effects accounted for using the Davies equation for activity coefficients. The specified inputs for each calculation are the potential $E$, the pH, and the total analytical concentration of the metal, $C_{\\mathrm{M,tot}}$. The temperature is fixed at $T = 298.15\\ \\mathrm{K}$.\n\nThe system of equations is highly coupled because the concentrations of species, $c_i$, determine the ionic strength, $I$, which in turn determines the activity coefficients, $\\gamma_i$, that are needed to relate activities, $a_i$, back to concentrations via $a_i = \\gamma_i c_i$ in the equilibrium expressions. This circular dependency mandates an iterative numerical approach. A fixed-point iteration on the ionic strength $I$ is specified.\n\nThe chemical system consists of the following species: $\\mathrm{M}^{3+}$, $\\mathrm{M}^{2+}$, the mononuclear hydrolysis products of $\\mathrm{M}^{3+}$ which are $\\mathrm{M(OH)}^{2+}$, $\\mathrm{M(OH)}_2^{+}$, and $\\mathrm{M(OH)}_3^{0}$, as well as $\\mathrm{H}^+$ and $\\mathrm{OH}^-$. An additional non-reactive background ion with concentration $c_{\\mathrm{bal}}$ and charge $z_{\\mathrm{bal}} \\in \\{+1, -1\\}$ is introduced to enforce perfect electroneutrality.\n\nThe iterative algorithm proceeds as follows:\n1.  Initialize the ionic strength, $I$, with a starting guess, for example $I^{(0)} = 0$.\n2.  In each iteration $k$, use the current ionic strength $I^{(k)}$ to compute the activity coefficient $\\gamma_i^{(k)}$ for each charged species $i$ with charge $z_i$ using the Davies equation:\n    $$ \\log_{10} \\gamma_i = -A z_i^2\\left(\\dfrac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I \\right) $$\n    where $A = 0.509$. For neutral species like $\\mathrm{M(OH)}_3^{0}$, the activity coefficient is unity, $\\gamma_i = 1$. The charged species are $\\mathrm{M}^{3+}$ ($z=3$), $\\mathrm{M}^{2+}$ ($z=2$), $\\mathrm{M(OH)}^{2+}$ ($z=2$), $\\mathrm{M(OH)}_2^{+}$ ($z=1$), $\\mathrm{H}^+$ ($z=1$), $\\mathrm{OH}^-$ ($z=-1$), and the background ion ($z=\\pm 1$).\n\n3.  The activities of hydrogen and hydroxide ions are fixed by the input pH:\n    $$ a_{\\mathrm{H}^+} = 10^{-\\mathrm{pH}} $$\n    $$ a_{\\mathrm{OH}^-} = \\frac{K_w}{a_{\\mathrm{H}^+}} = \\frac{10^{-14}}{10^{-\\mathrm{pH}}} $$\n\n4.  All metal species activities are expressed relative to a single master species, $a_{\\mathrm{M}^{3+}}$.\n    The Nernst equation for the reaction $\\mathrm{M}^{3+} + e^- \\rightleftharpoons \\mathrm{M}^{2+}$ gives the activity ratio:\n    $$ r = \\frac{a_{\\mathrm{M}^{2+}}}{a_{\\mathrm{M}^{3+}}} = \\exp\\left(-\\frac{(E - E^\\circ)F}{RT}\\right) $$\n    where $E^\\circ = 0.771\\ \\mathrm{V}$, $R = 8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$, and $F = 96485.33212\\ \\mathrm{C\\ mol^{-1}}$.\n    \n    For the hydrolysis reactions $\\mathrm{M}^{3+} + j\\mathrm{H_2O} \\rightleftharpoons \\mathrm{M(OH)}_j^{(3-j)+} + j\\mathrm{H}^+$, the activities are related via the cumulative equilibrium constants $\\beta_j^*$:\n    - For $j=1$: $\\mathrm{M}^{3+} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{M(OH)}^{2+} + \\mathrm{H}^+$, $\\beta_1^* = K_1 = 10^{-2.19}$.\n    - For $j=2$: $\\mathrm{M}^{3+} + 2\\mathrm{H_2O} \\rightleftharpoons \\mathrm{M(OH)}_2^{+} + 2\\mathrm{H}^+$, $\\beta_2^* = K_1 K_2 = 10^{-5.69}$.\n    - For $j=3$: $\\mathrm{M}^{3+} + 3\\mathrm{H_2O} \\rightleftharpoons \\mathrm{M(OH)}_3^{0} + 3\\mathrm{H}^+$, $\\beta_3^* = K_1 K_2 K_3 = 10^{-11.69}$.\n    The activities are then:\n    $$ a_{\\mathrm{M(OH)_j^{(3-j)+}}} = \\frac{\\beta_j^* a_{\\mathrm{M}^{3+}}}{(a_{\\mathrm{H}^+})^j} \\quad \\text{for } j \\in \\{1, 2, 3\\} $$\n\n5.  The unknown activity $a_{\\mathrm{M}^{3+}}$ is determined by enforcing the total metal mass balance:\n    $$ C_{\\mathrm{M,tot}} = c_{\\mathrm{M}^{3+}} + c_{\\mathrm{M}^{2+}} + c_{\\mathrm{M(OH)}^{2+}} + c_{\\mathrm{M(OH)}_2^{+}} + c_{\\mathrm{M(OH)}_3^{0}} $$\n    Substituting $c_i = a_i/\\gamma_i$ and the expressions from step 4:\n    $$ C_{\\mathrm{M,tot}} = \\frac{a_{\\mathrm{M}^{3+}}}{\\gamma_{\\mathrm{M}^{3+}}} + \\frac{r \\cdot a_{\\mathrm{M}^{3+}}}{\\gamma_{\\mathrm{M}^{2+}}} + \\sum_{j=1}^{3} \\frac{\\beta_j^* a_{\\mathrm{M}^{3+}}}{(a_{\\mathrm{H}^+})^j \\gamma_{\\mathrm{M(OH)_j^{(3-j)+}}}} $$\n    Solving for $a_{\\mathrm{M}^{3+}}$ gives:\n    $$ a_{\\mathrm{M}^{3+}} = C_{\\mathrm{M,tot}} \\left[ \\frac{1}{\\gamma_{\\mathrm{M}^{3+}}} + \\frac{r}{\\gamma_{\\mathrm{M}^{2+}}} + \\sum_{j=1}^{3} \\frac{\\beta_j^*}{(a_{\\mathrm{H}^+})^j \\gamma_{\\mathrm{M(OH)_j^{(3-j)+}}}} \\right]^{-1} $$\n\n6.  With $a_{\\mathrm{M}^{3+}}$ known, the activities of all other metal species are calculated, and subsequently, the concentrations of all species (metal-containing, $\\mathrm{H}^+$, $\\mathrm{OH}^-$) for the current iteration $(k)$ are found using $c_i^{(k+1)} = a_i / \\gamma_i^{(k)}$.\n\n7.  Electroneutrality is enforced by calculating the net charge from all species except the background ion:\n    $$ C_{\\mathrm{net}} = \\sum_{i \\neq \\mathrm{bal}} z_i c_i = 3c_{\\mathrm{M}^{3+}} + 2c_{\\mathrm{M}^{2+}} + 2c_{\\mathrm{M(OH)}^{2+}} + c_{\\mathrm{M(OH)}_2^{+}} + c_{\\mathrm{H}^+} - c_{\\mathrm{OH}^-} $$\n    The concentration and charge of the background ion are set to perfectly balance this charge:\n    $$ c_{\\mathrm{bal}} = |C_{\\mathrm{net}}| $$\n    $$ z_{\\mathrm{bal}} = -\\mathrm{sign}(C_{\\mathrm{net}}) $$\n\n8.  A new ionic strength $I^{(k+1)}$ is calculated using the updated concentrations, including the background ion:\n    $$ I^{(k+1)} = \\frac{1}{2} \\sum_{\\text{all species}} z_i^2 c_i^{(k+1)} = \\frac{1}{2}\\left( \\sum_{i \\neq \\mathrm{bal}} z_i^2 c_i^{(k+1)} + z_{\\mathrm{bal}}^2 c_{\\mathrm{bal}} \\right) $$\n\n9.  The new value $I^{(k+1)}$ is compared to the previous value $I^{(k)}$. If $|I^{(k+1)} - I^{(k)}|$ is smaller than a specified tolerance (e.g., $10^{-15}$), the iteration has converged. Otherwise, set $I^{(k)} \\leftarrow I^{(k+1)}$ and return to step 2.\n\n10. Once convergence is achieved, the final calculated concentrations are used to compute the required output metrics for each test case: the fractional concentrations $c_{\\mathrm{M}^{2+}}/C_{\\mathrm{M,tot}}$ and $c_{\\mathrm{M(OH)}_3^{0}}/C_{\\mathrm{M,tot}}$, the final converged ionic strength $I$, and the absolute electroneutrality residual $|\\sum_i z_i c_i|$, which serves as a numerical verification and is expected to be nearly zero by construction.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes aqueous speciation for a redox-active metal system using a\n    fixed-point iteration on ionic strength to self-consistently solve for\n    concentrations, activity coefficients, and charge balance.\n    \"\"\"\n    # Define constants\n    R = 8.314462618  # J mol^-1 K^-1\n    F = 96485.33212  # C mol^-1\n    T = 298.15        # K\n    A_davies = 0.509  # Davies constant for water at 298.15 K\n\n    # Electrochemical and equilibrium parameters\n    E_circ = 0.771     # V\n    K1 = 10**(-2.19)\n    K2 = 10**(-3.50)\n    K3 = 10**(-6.00)\n    Kw = 10**(-14.0)\n\n    # Cumulative hydrolysis constants for M(3+)\n    # M(3+) + j*H2O <=> M(OH)j^(3-j)+ + j*H+\n    beta_star_1 = K1\n    beta_star_2 = K1 * K2\n    beta_star_3 = K1 * K2 * K3\n\n    def calculate_speciation(pH, E, C_M_tot):\n        \"\"\"\n        Performs the iterative calculation for a single (pH, E, C_M_tot) point.\n        \"\"\"\n        max_iter = 100\n        tolerance = 1e-15\n        \n        # Fixed activities based on inputs\n        a_H = 10**(-pH)\n        a_OH = Kw / a_H\n\n        # Nernst activity ratio for M2+/M3+ couple\n        RT_F = R * T / F\n        r_act = np.exp(-(E - E_circ) / RT_F)\n\n        # Iteration on Ionic Strength I\n        I = 0.0  # Initial guess (ideal solution)\n        concs = {}\n        for _ in range(max_iter):\n            I_old = I\n            \n            # 1. Calculate activity coefficients (gamma) using current I\n            gammas = {}\n            sqrt_I = np.sqrt(I)\n            # The Davies equation term is non-zero only for I > 0\n            if I > 0:\n                davies_term = (sqrt_I / (1 + sqrt_I)) - 0.3 * I\n            else:\n                davies_term = 0\n\n            # Charges for species involved in Davies calculation\n            z_vals = {'M3+': 3, 'M2+': 2, 'MOH_2p': 2, 'MOH2_p': 1, 'H+': 1, 'OH-': -1}\n            \n            for name, z in z_vals.items():\n                log10_gamma = -A_davies * (z**2) * davies_term\n                gammas[name] = 10**log10_gamma\n            gammas['MOH3_0'] = 1.0  # Neutral species\n\n            # 2. Solve for a_M3+ using total metal mass balance\n            sum_term = (1.0 / gammas['M3+'] +\n                        r_act / gammas['M2+'] +\n                        (beta_star_1 / a_H) / gammas['MOH_2p'] +\n                        (beta_star_2 / a_H**2) / gammas['MOH2_p'] +\n                        (beta_star_3 / a_H**3) / gammas['MOH3_0'])\n\n            a_M3plus = C_M_tot / sum_term if sum_term > 0 else 0.0\n\n            # 3. Calculate concentrations of all species for this iteration\n            # Metal species\n            concs['M3+'] = a_M3plus / gammas['M3+']\n            concs['M2+'] = (a_M3plus * r_act) / gammas['M2+']\n            concs['MOH_2p'] = (a_M3plus * beta_star_1 / a_H) / gammas['MOH_2p']\n            concs['MOH2_p'] = (a_M3plus * beta_star_2 / a_H**2) / gammas['MOH2_p']\n            concs['MOH3_0'] = (a_M3plus * beta_star_3 / a_H**3) / gammas['MOH3_0']\n            # H+ and OH-\n            concs['H+'] = a_H / gammas['H+']\n            concs['OH-'] = a_OH / gammas['OH-']\n\n            # 4. Enforce electroneutrality by adding a background ion\n            net_charge = (3 * concs['M3+'] + 2 * concs['M2+'] + 2 * concs['MOH_2p'] + \n                          1 * concs['MOH2_p'] + 1 * concs['H+'] - 1 * concs['OH-'])\n\n            c_bal = abs(net_charge)\n            z_bal = -np.sign(net_charge) if net_charge != 0 else 0\n            \n            # 5. Update ionic strength including the background ion\n            I = 0.5 * (9 * concs['M3+'] + 4 * concs['M2+'] + 4 * concs['MOH_2p'] + \n                       1 * concs['MOH2_p'] + 1 * concs['H+'] + 1 * concs['OH-'] + \n                       (z_bal**2) * c_bal)\n            \n            # 6. Check for convergence\n            if abs(I - I_old)  tolerance:\n                break\n\n        # After convergence, calculate final required quantities\n        frac_M2plus = concs.get('M2+', 0) / C_M_tot if C_M_tot > 0 else 0\n        frac_MOH3_0 = concs.get('MOH3_0', 0) / C_M_tot if C_M_tot > 0 else 0\n        \n        # Recalculate final charge for residual report\n        final_net_charge = (3*concs['M3+'] + 2*concs['M2+'] + 2*concs['MOH_2p'] + \n                           1*concs['MOH2_p'] + 1*concs['H+'] - 1*concs['OH-'])\n        final_c_bal = abs(final_net_charge)\n        final_z_bal = -np.sign(final_net_charge) if final_net_charge != 0 else 0\n        final_residual = abs(final_net_charge + final_z_bal * final_c_bal)\n\n        return [frac_M2plus, frac_MOH3_0, I, final_residual]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (pH, E (V), C_M_tot (mol/L))\n        (2.0, 0.30, 1e-6),    # Case A\n        (6.0, 0.771, 1e-6),   # Case B\n        (9.0, 1.00, 1e-6),    # Case C\n        (8.0, 0.20, 1e-4),    # Case D\n        (7.0, 0.771, 1e-8)    # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        results.extend(calculate_speciation(*case))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{v:.8e}' for v in results)}]\")\n\nsolve()\n```", "id": "2515057"}]}