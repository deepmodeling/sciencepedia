{"hands_on_practices": [{"introduction": "A defining characteristic of a hard magnetic material is its ability to maintain magnetization against opposing fields. This practice provides a foundational understanding of this property by exploring the concept of the anisotropy field, $H_k$. By analyzing the energy landscape of a single-domain particle, you will derive the intrinsic field required to overcome the material's preferred magnetic orientation, establishing a direct link between the microscopic anisotropy constant $K$ and a key macroscopic figure of merit for permanent magnets [@problem_id:2497675].", "problem": "A single-domain uniaxial ferromagnet is described by an anisotropy energy density $E_{\\text{an}}(\\theta) = K \\sin^{2}\\theta$, where $\\theta$ is the angle between the magnetization $\\mathbf{M}$ and the easy axis, and by a Zeeman energy density $E_{Z} = -\\mu_{0}\\mathbf{M}\\cdot\\mathbf{H}$, where $\\mu_{0}$ is the magnetic constant and $\\mathbf{H}$ is an externally applied magnetic field. Consider quasistatic coherent rotation with the external field applied along the hard axis (perpendicular to the easy axis). The anisotropy field $H_{k}$ is defined as the smallest magnitude of applied field along the hard axis required to remove the energy barrier that keeps the magnetization aligned with the easy axis.\n\nStarting from these energy densities and the definition of $H_{k}$, derive an expression for $H_{k}$ in terms of $K$ and the saturation magnetization $M_{s}$. The material has an anisotropy constant $K = 4 \\times 10^{5} \\ \\mathrm{J/m^3}$ and a reported saturation quantity $M_{s} = 1.2$ T, where the value in tesla corresponds to the saturation polarization $J_{s} \\equiv \\mu_{0} M_{s} = 1.2$ T in the International System of Units (SI). Use this identification to express $H_{k}$ in terms of $K$ and $J_{s}$. Compute the numerical value of $H_{k}$ and express your final numerical answer in kiloampere per meter (kA/m), rounded to three significant figures.\n\nThen, using the demagnetizing field estimate $H_{d} \\approx N M_{s}$ with demagnetizing factor $N$ in the range $N \\in [\\frac{1}{3}, 1]$ for common shapes (from approximately spherical to thin plate), and using $J_{s} = \\mu_{0} M_{s}$, discuss whether the material would generally be considered magnetically hard, in the sense that its intrinsic resistance to demagnetization (as bounded above by $H_{k}$) is sufficient to overcome typical demagnetizing effects. Your discussion should be qualitative but must be supported by quantitative comparisons. The final numeric answer you report must be only the value of $H_{k}$ as requested above.", "solution": "The problem statement has been evaluated and is found to be scientifically grounded, well-posed, and free of contradictions or ambiguities. It presents a standard problem in micromagnetism based on the Stoner-Wohlfarth model for coherent magnetization rotation. All necessary data and definitions are provided for a unique solution. The subtle use of \"$M_s = 1.2$ T\" is immediately and correctly clarified as representing the saturation polarization $J_s = \\mu_0 M_s = 1.2$ T, which is a valid physical quantity. The problem is therefore deemed valid and a full solution will be provided.\n\nThe total magnetic energy density $E_{total}$ for a single-domain uniaxial ferromagnet is the sum of the anisotropy energy density $E_{\\text{an}}$ and the Zeeman energy density $E_{Z}$.\nThe anisotropy energy density is given as:\n$$E_{\\text{an}}(\\theta) = K \\sin^{2}\\theta$$\nwhere $K$ is the anisotropy constant and $\\theta$ is the angle between the magnetization vector $\\mathbf{M}$ and the easy axis.\n\nThe Zeeman energy density is given by:\n$$E_{Z} = -\\mu_{0}\\mathbf{M}\\cdot\\mathbf{H}$$\nwhere $\\mathbf{H}$ is the external magnetic field and $\\mu_{0}$ is the magnetic constant. The magnitude of the magnetization is the saturation magnetization, $|\\mathbf{M}| = M_{s}$.\n\nThe problem specifies that the external field $\\mathbf{H}$ is applied along the hard axis, which is perpendicular to the easy axis. We can establish a coordinate system where the easy axis is along the x-axis and the field $\\mathbf{H}$ is applied along the y-axis. The magnetization vector $\\mathbf{M}$ will, by symmetry, be confined to the xy-plane. If $\\theta$ is the angle that $\\mathbf{M}$ makes with the easy (x) axis, then the angle between $\\mathbf{M}$ and $\\mathbf{H}$ is $\\frac{\\pi}{2} - \\theta$.\n\nThe Zeeman energy density becomes:\n$$E_{Z} = -\\mu_{0} |\\mathbf{M}| |\\mathbf{H}| \\cos\\left(\\frac{\\pi}{2} - \\theta\\right) = -\\mu_{0} M_{s} H \\sin\\theta$$\nwhere $H = |\\mathbf{H}|$.\n\nThe total energy density as a function of the magnetization angle $\\theta$ is:\n$$E(\\theta) = E_{\\text{an}}(\\theta) + E_{Z}(\\theta) = K \\sin^{2}\\theta - \\mu_{0} M_{s} H \\sin\\theta$$\nThe equilibrium orientations of the magnetization correspond to the minima of this energy function. To find these, we first find the stationary points by setting the first derivative of $E(\\theta)$ with respect to $\\theta$ to zero:\n$$\\frac{dE}{d\\theta} = 2K \\sin\\theta \\cos\\theta - \\mu_{0} M_{s} H \\cos\\theta = \\cos\\theta (2K \\sin\\theta - \\mu_{0} M_{s} H) = 0$$\nThis equation yields two sets of possible stationary points:\n$1.$ $\\cos\\theta = 0$, which means $\\theta = \\pm\\frac{\\pi}{2}$.\n$2.$ $2K \\sin\\theta - \\mu_{0} M_{s} H = 0$, which implies $\\sin\\theta = \\frac{\\mu_{0} M_{s} H}{2K}$.\n\nTo determine if these stationary points are minima (stable equilibrium) or maxima (unstable equilibrium), we must examine the sign of the second derivative:\n$$\\frac{d^{2}E}{d\\theta^{2}} = 2K(\\cos^{2}\\theta - \\sin^{2}\\theta) + \\mu_{0} M_{s} H \\sin\\theta$$\nA point is a minimum if $\\frac{d^{2}E}{d\\theta^{2}} > 0$ and a maximum if $\\frac{d^{2}E}{d\\theta^{2}} < 0$.\n\nThe anisotropy field $H_{k}$ is defined as the field required to remove the energy barrier that maintains bistability. At zero field ($H=0$), there are two minima at $\\theta=0$ and $\\theta=\\pi$ (the easy axis directions), separated by energy barriers (maxima) at $\\theta=\\pm\\frac{\\pi}{2}$. As $H$ increases, the minimum originally near $\\theta=0$ shifts, while the energy barrier at $\\theta=\\frac{\\pi}{2}$ lowers. The anisotropy field $H_{k}$ is the critical field at which the minimum and the adjacent maximum merge into a single inflection point, thus eliminating the barrier and the bistability. This occurs when both $\\frac{dE}{d\\theta} = 0$ and $\\frac{d^{2}E}{d\\theta^{2}} = 0$ are satisfied simultaneously.\n\nFrom the second stationary condition, we have $\\sin\\theta = \\frac{\\mu_{0} M_{s} H}{2K}$. Let's substitute this into the second derivative:\n$$\\frac{d^{2}E}{d\\theta^{2}} = 2K(1 - 2\\sin^{2}\\theta) + \\mu_{0} M_{s} H \\sin\\theta = 2K\\left(1 - 2\\left(\\frac{\\mu_{0} M_{s} H}{2K}\\right)^{2}\\right) + \\mu_{0} M_{s} H \\left(\\frac{\\mu_{0} M_{s} H}{2K}\\right)$$\n$$\\frac{d^{2}E}{d\\theta^{2}} = 2K - \\frac{(\\mu_{0} M_{s} H)^{2}}{K} + \\frac{(\\mu_{0} M_{s} H)^{2}}{2K} = 2K - \\frac{(\\mu_{0} M_{s} H)^{2}}{2K}$$\nSetting the second derivative to zero to find the critical field $H_{k}$:\n$$2K - \\frac{(\\mu_{0} M_{s} H_{k})^{2}}{2K} = 0 \\implies (\\mu_{0} M_{s} H_{k})^{2} = 4K^{2}$$\nTaking the positive root for the field magnitude, we get $\\mu_{0} M_{s} H_{k} = 2K$.\nSolving for the anisotropy field $H_{k}$ gives the expression in terms of $K$ and $M_{s}$:\n$$H_{k} = \\frac{2K}{\\mu_{0} M_{s}}$$\nThe problem provides the saturation polarization $J_{s} \\equiv \\mu_{0} M_{s}$. Substituting this definition, we obtain the expression for $H_{k}$ in terms of $K$ and $J_{s}$:\n$$H_{k} = \\frac{2K}{J_{s}}$$\nNow we compute the numerical value. We are given $K = 4 \\times 10^5 \\ \\mathrm{J/m^3}$ and $J_{s} = 1.2 \\ \\mathrm{T}$. The units are consistent: $\\frac{\\text{J/m}^3}{\\text{T}} = \\frac{\\text{N/m}^2}{\\text{N/(A}\\cdot\\text{m)}} = \\text{A/m}$.\n$$H_{k} = \\frac{2 \\times (4 \\times 10^5 \\ \\mathrm{J/m^3})}{1.2 \\ \\mathrm{T}} = \\frac{8 \\times 10^{5}}{1.2} \\text{ A/m} = \\frac{20}{3} \\times 10^{5} \\text{ A/m} \\approx 6.666... \\times 10^{5} \\text{ A/m}$$\nThe question asks for the result in kiloampere per meter (kA/m), rounded to three significant figures:\n$$H_{k} \\approx 667 \\text{ kA/m}$$\n\nFinally, we discuss whether the material is magnetically hard. A hard magnetic material is one that resists demagnetization and can serve as a permanent magnet. This property is quantified by a high coercivity, for which $H_{k}$ is an intrinsic upper bound. A magnet must be able to resist its own demagnetizing field, $H_{d}$, which arises from surface magnetic charges. This field is estimated as $H_{d} \\approx N M_{s}$, where $N$ is the geometry-dependent demagnetizing factor, $N \\in [\\frac{1}{3}, 1]$.\nTo compare $H_{k}$ with $H_{d}$, we first calculate $M_{s}$:\n$$M_{s} = \\frac{J_{s}}{\\mu_{0}} = \\frac{1.2 \\text{ T}}{4\\pi \\times 10^{-7} \\text{ T}\\cdot\\text{m/A}} \\approx 9.549 \\times 10^{5} \\text{ A/m}$$\nThe range for the demagnetizing field is therefore:\n$$H_{d} \\approx N M_{s} \\in \\left[\\frac{1}{3} (9.549 \\times 10^{5}), 1 \\cdot (9.549 \\times 10^{5})\\right] \\text{ A/m}$$\n$$H_{d} \\in [3.18 \\times 10^{5}, 9.55 \\times 10^{5}] \\text{ A/m} \\quad \\text{or} \\quad H_{d} \\in [318, 955] \\text{ kA/m}$$\nOur calculated anisotropy field is $H_{k} \\approx 667$ kA/m. Comparing this value to the range of $H_{d}$, we see that $H_{k}$ is greater than $H_{d}$ for objects with small demagnetizing factors (e.g., spheres, where $N=\\frac{1}{3}$, or long needles) but can be smaller than $H_{d}$ for objects with large $N$ (e.g., a thin plate magnetized normal to its surface, where $N \\to 1$).\nHowever, a value of $H_k$ in the several hundreds of kA/m is characteristic of magnetically hard materials. Soft magnetic materials have coercivities orders of magnitude smaller. The condition for a stable permanent magnet is that its coercivity $H_c$ (which is bounded by $H_k$) must be larger than the demagnetizing field $H_d$ for its given shape. Since $H_{k}$ surmounts $H_{d}$ for a significant range of practical shapes ($N < H_{k}/M_{s} \\approx (667)/(955) \\approx 0.7$), the material is robust against self-demagnetization in many configurations. Therefore, based on the large magnitude of its anisotropy field, the material is properly classified as magnetically hard.", "answer": "$$\\boxed{667}$$", "id": "2497675"}, {"introduction": "Building on the concept of intrinsic magnetic hardness, we now investigate its microstructural origin. This exercise explores the energetic competition between the magnetostatic self-energy, which promotes the formation of magnetic domains to reduce external fields, and the domain wall energy, which is the cost of creating boundaries between these domains. By calculating the critical radius below which a single-domain state is energetically favorable, you will uncover the fundamental principle explaining why nanostructuring is a crucial strategy for engineering both hard and soft magnetic materials [@problem_id:2497702].", "problem": "A spherical particle of a very soft ferromagnet (soft magnetic material) can reduce its magnetostatic self-energy by forming two domains separated by a single $180^{\\circ}$ Bloch wall. Starting from fundamental energetic considerations, derive the critical sphere radius $R_{c}$ at which the uniformly magnetized single-domain state and the two-domain state have equal total energy. Your derivation must proceed by:\n- Writing the magnetostatic energy for a uniformly magnetized sphere using the demagnetizing factor for a sphere and the saturation magnetization $M_{s}$.\n- Writing the domain-wall energy cost for introducing a single planar wall through the sphere, using the exchange stiffness $A$ and an effective anisotropy energy density appropriate to a soft magnet.\n- Equating these energies to obtain $R_{c}$ symbolically in terms of $A$, $M_{s}$, and the permeability of free space $\\mu_{0}$.\n\nAssume a two-domain configuration with a single planar wall through the center and use the standard Bloch-wall energy per unit area expression. For a sphere, use the spherical demagnetizing factor. For a very soft ferromagnet, take the effective anisotropy that enters the Bloch-wall energy to be governed by the magnetostatic (shape) energy density.\n\nThen, using your symbolic result, estimate $R_{c}$ for $A = 1.3 \\times 10^{-11} \\ \\mathrm{J\\,m^{-1}}$ and $M_{s} = 1.6 \\times 10^{6} \\ \\mathrm{A\\,m^{-1}}$. Take $\\mu_{0} = 4 \\pi \\times 10^{-7} \\ \\mathrm{H\\,m^{-1}}$. Round your numerical estimate to $3$ significant figures. Express your final result in nanometers.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It represents a standard problem in the field of micromagnetism concerning the stability of magnetic domain structures. All necessary physical quantities and assumptions are provided for a formal derivation. The problem is therefore valid.\n\nThe central principle for this problem is the competition between two primary energy contributions in a magnetic particle: the magnetostatic self-energy, which favors flux closure through domain formation, and the domain-wall energy, which represents the cost of creating interfaces between domains. The critical radius, $R_{c}$, is the size at which the energy of a uniformly magnetized single-domain state becomes equal to the energy of a simple two-domain state. Beyond this radius, the two-domain configuration is energetically favorable.\n\nFirst, we formulate the energy of the single-domain state, $E_{SD}$. For a uniformly magnetized particle, this energy is dominated by the magnetostatic or demagnetizing energy, $E_{demag}$. The expression for this energy is given by:\n$$E_{demag} = \\frac{1}{2} \\mu_{0} N_{d} M_{s}^{2} V$$\nwhere $\\mu_{0}$ is the permeability of free space, $N_{d}$ is the demagnetizing factor, $M_{s}$ is the saturation magnetization, and $V$ is the volume of the particle. For a sphere, the demagnetizing factor is $N_{d} = \\frac{1}{3}$ and the volume is $V = \\frac{4}{3} \\pi R^{3}$. Substituting these into the energy expression yields the energy of the single-domain sphere:\n$$E_{SD} = \\frac{1}{2} \\mu_{0} \\left(\\frac{1}{3}\\right) M_{s}^{2} \\left(\\frac{4}{3} \\pi R^{3}\\right) = \\frac{2}{9} \\pi \\mu_{0} M_{s}^{2} R^{3}$$\n\nNext, we formulate the energy of the two-domain state, $E_{TD}$. In this configuration, a domain wall divides the sphere into two hemispheres with antiparallel magnetization. This structure drastically reduces the external magnetic field and thus the magnetostatic energy. As a first-order approximation, we assume the magnetostatic energy of the two-domain state is negligible compared to that of the single-domain state. The total energy is therefore dominated by the energy required to create the domain wall, $E_{wall}$.\n$$E_{TD} \\approx E_{wall} = \\gamma_{wall} S_{wall}$$\nwhere $\\gamma_{wall}$ is the domain-wall energy per unit area and $S_{wall}$ is the area of the wall. The problem specifies a single planar wall through the center of the sphere, which has the area of a great circle, $S_{wall} = \\pi R^{2}$.\n\nTo determine $\\gamma_{wall}$, we must consider the nature of the material. For a $180^{\\circ}$ Bloch wall, the standard expression for the energy density derived from a one-dimensional variational model is:\n$$\\gamma_{wall} = 4\\sqrt{A K_{eff}}$$\nwhere $A$ is the exchange stiffness constant and $K_{eff}$ is the effective magnetic anisotropy energy density. The problem states that for a very soft ferromagnet, the effective anisotropy is governed by the magnetostatic (shape) energy. Within the Bloch wall, the magnetic moments must rotate out of the easy plane of magnetization. For a domain wall modeled as an infinite thin sheet, the easy plane is the plane of the wall itself. The energy cost to orient magnetization perpendicular to this plane is the magnetostatic penalty. The corresponding anisotropy energy density is:\n$$K_{eff} = \\frac{1}{2} \\mu_{0} M_{s}^{2}$$\nThis arises from the demagnetizing field within the wall, where the demagnetizing factor for a direction normal to an infinite plane is $1$.\n\nSubstituting this expression for $K_{eff}$ into the formula for $\\gamma_{wall}$:\n$$\\gamma_{wall} = 4\\sqrt{A \\left(\\frac{1}{2} \\mu_{0} M_{s}^{2}\\right)} = 4 M_{s} \\sqrt{\\frac{A \\mu_{0}}{2}} = 2\\sqrt{2} M_{s} \\sqrt{A \\mu_{0}}$$\nThe total energy of the domain wall is then:\n$$E_{wall} = \\gamma_{wall} S_{wall} = \\left(2\\sqrt{2} M_{s} \\sqrt{A \\mu_{0}}\\right) \\left(\\pi R^{2}\\right) = 2\\pi\\sqrt{2} M_{s} \\sqrt{A \\mu_{0}} R^{2}$$\n\nThe critical radius $R_{c}$ is found by equating the energies of the two states, $E_{SD}(R_{c}) = E_{TD}(R_{c})$:\n$$\\frac{2}{9} \\pi \\mu_{0} M_{s}^{2} R_{c}^{3} = 2\\pi\\sqrt{2} M_{s} \\sqrt{A \\mu_{0}} R_{c}^{2}$$\nTo solve for $R_{c}$, we cancel common terms (assuming $R_{c} \\neq 0$, $M_{s} \\neq 0$):\n$$\\frac{1}{9} \\mu_{0} M_{s} R_{c} = \\sqrt{2} \\sqrt{A \\mu_{0}}$$\nIsolating $R_{c}$ gives the symbolic expression:\n$$R_{c} = \\frac{9\\sqrt{2} \\sqrt{A \\mu_{0}}}{\\mu_{0} M_{s}} = \\frac{9\\sqrt{2A}}{\\sqrt{\\mu_{0}} M_{s}}$$\n\nFinally, we substitute the provided numerical values to estimate $R_{c}$:\n$A = 1.3 \\times 10^{-11} \\ \\mathrm{J\\,m^{-1}}$\n$M_{s} = 1.6 \\times 10^{6} \\ \\mathrm{A\\,m^{-1}}$\n$\\mu_{0} = 4 \\pi \\times 10^{-7} \\ \\mathrm{H\\,m^{-1}}$\n\n$$R_{c} = \\frac{9\\sqrt{2(1.3 \\times 10^{-11})}}{\\sqrt{4 \\pi \\times 10^{-7}} (1.6 \\times 10^{6})}$$\n$$R_{c} = \\frac{9\\sqrt{2.6 \\times 10^{-11}}}{\\sqrt{4 \\pi \\times 10^{-7}} (1.6 \\times 10^{6})} \\ \\mathrm{m}$$\n$$R_{c} \\approx \\frac{9 \\times (5.0990 \\times 10^{-6})}{(1.1209 \\times 10^{-3}) \\times (1.6 \\times 10^{6})} \\ \\mathrm{m}$$\n$$R_{c} \\approx \\frac{4.5891 \\times 10^{-5}}{1793.45} \\ \\mathrm{m}$$\n$$R_{c} \\approx 2.5588 \\times 10^{-8} \\ \\mathrm{m}$$\nConverting this result to nanometers gives $R_{c} \\approx 25.588 \\ \\mathrm{nm}$. Rounding to $3$ significant figures as instructed, we obtain the final numerical estimate.\n$$R_{c} \\approx 25.6 \\ \\mathrm{nm}$$", "answer": "$$\n\\boxed{25.6}\n$$", "id": "2497702"}, {"introduction": "Our final practice bridges the gap from single-particle physics to the performance of a complete device. Real-world materials, such as those used in magnetic data storage, consist of billions of individual grains with slight variations in their properties. This computational exercise models such a system, treating the material parameters as statistical distributions to predict the collective switching behavior and calculate a critical engineering metric: the bit error rate (BER). This hands-on coding problem demonstrates how fundamental principles of micromagnetism are scaled up to analyze and design high-performance magnetic technologies [@problem_id:2497694].", "problem": "A granular magnetic recording medium can be modeled as an assembly of non-interacting, uniaxial, single-domain grains. Consider the coherent rotation limit at zero temperature under a field applied antiparallel to the easy axis. Assume the anisotropy energy density and the Zeeman energy form the total energy density. Saturation magnetization (SM) (denoted $M_s$) and uniaxial anisotropy constant (denoted $K$) vary from grain to grain due to chemical and microstructural dispersion. Model $K$ and $M_s$ as independent log-normal random variables. Let the probability density function (PDF) of $K$ be characterized by median $\\tilde{K}$ and geometric standard deviation $g_K$, meaning $\\ln K \\sim \\mathcal{N}\\!\\left(\\ln \\tilde{K}, \\left(\\ln g_K\\right)^2\\right)$; similarly, let $\\ln M_s \\sim \\mathcal{N}\\!\\left(\\ln \\tilde{M}_s, \\left(\\ln g_M\\right)^2\\right)$ with median $\\tilde{M}_s$ and geometric standard deviation $g_M$. Here $\\mu_0$ denotes the vacuum permeability, $\\mu_0 = 4\\pi \\times 10^{-7}\\ \\mathrm{H\\,m^{-1}}$.\n\nStarting from the energy-based switching criterion for coherent rotation and the definitions above, derive the distribution of the switching field $H_{\\mathrm{sw}}$ for a grain and express the tail probability $\\mathbb{P}\\!\\left(H_{\\mathrm{sw}} > H_w\\right)$ in terms of the natural logarithm statistics of $K$ and $M_s$, where $H_w$ is a deterministic write field amplitude. Interpret this tail probability as the single-grain write failure probability, i.e., the bit error rate (BER) at write, under the stated assumptions. Your program must implement the resulting expression to compute the BER.\n\nImplement a program that, for each test case below, computes the BER $\\mathbb{P}\\!\\left(H_{\\mathrm{sw}} > H_w\\right)$ as a decimal in the unit interval. All magnetic fields must be handled and computed in $\\mathrm{A\\,m^{-1}}$. All inputs for $K$ are in $\\mathrm{J\\,m^{-3}}$, and all inputs for $M_s$ are in $\\mathrm{A\\,m^{-1}}$. The output must be rounded to six significant figures. Use the natural logarithm for all logarithmic operations.\n\nTest suite (each test case is a tuple $(\\tilde{K}, g_K, \\tilde{M}_s, g_M, H_w)$):\n- Case 1 (boundary check at the median switching field): $(7.0\\times 10^5, 1.2214, 1.0\\times 10^6, 1.1052, 1.11408\\times 10^6)$\n- Case 2 (happy path with moderately stronger write field): $(7.0\\times 10^5, 1.2214, 1.0\\times 10^6, 1.1052, 1.4\\times 10^6)$\n- Case 3 (narrow dispersion, slightly insufficient write field): $(7.0\\times 10^5, 1.01, 1.0\\times 10^6, 1.01, 0.99\\times 1.11408\\times 10^6)$\n- Case 4 (harder medium, weak write field): $(1.0\\times 10^6, 1.2214, 8.0\\times 10^5, 1.2214, 1.0\\times 10^6)$\n- Case 5 (softer medium, strong write field): $(1.0\\times 10^4, 1.2214, 1.6\\times 10^6, 1.1052, 2.0\\times 10^4)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[x_1,x_2,x_3,x_4,x_5]$), where each $x_i$ is the BER for the corresponding test case, rounded to six significant figures, with no additional text. The program must not read any input and must not write any additional output. All computations must use the International System of Units (SI) as specified.", "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically grounded in the principles of micromagnetism (specifically, the Stoner-Wohlfarth model), and is mathematically well-posed. All parameters and conditions are specified, allowing for the derivation of a unique, meaningful solution. The problem provides a rigorous exercise in combining physics and statistics to model a realistic materials science scenario.\n\nThe solution proceeds in three stages: first, the derivation of the switching field for a single grain; second, the statistical analysis of the switching field distribution based on the given distributions of material properties; and third, the formulation of the write failure probability, or bit error rate (BER).\n\n**1. Derivation of the Switching Field ($H_{\\mathrm{sw}}$)**\n\nThe total energy density, $E_T$, of a single-domain uniaxial magnetic grain in an external magnetic field is the sum of the magnetic anisotropy energy density, $E_a$, and the Zeeman energy density, $E_Z$.\nThe uniaxial anisotropy energy density is given by:\n$$\nE_a = K \\sin^2\\theta\n$$\nwhere $K$ is the uniaxial anisotropy constant and $\\theta$ is the angle between the magnetization vector $\\vec{M}$ and the magnetic easy axis.\n\nThe external field, $H$, is applied antiparallel to the easy axis. The Zeeman energy density is:\n$$\nE_Z = -\\mu_0 \\vec{M} \\cdot \\vec{H}\n$$\nWith $\\vec{H}$ antiparallel to the easy axis, the interaction energy is $E_Z = \\mu_0 H M_s \\cos\\theta$, where $M_s$ is the saturation magnetization and $\\mu_0$ is the vacuum permeability.\n\nThe total energy density is therefore:\n$$\nE_T(\\theta) = K \\sin^2\\theta + \\mu_0 H M_s \\cos\\theta\n$$\nAt zero temperature, the magnetization vector aligns with a direction that minimizes $E_T(\\theta)$. The equilibrium positions are found by setting the first derivative of $E_T(\\theta)$ with respect to $\\theta$ to zero:\n$$\n\\frac{dE_T}{d\\theta} = 2K \\sin\\theta \\cos\\theta - \\mu_0 H M_s \\sin\\theta = \\sin\\theta (2K \\cos\\theta - \\mu_0 H M_s) = 0\n$$\nThe states of equilibrium are $\\theta=0$, $\\theta=\\pi$, and $\\cos\\theta = \\frac{\\mu_0 H M_s}{2K}$.\n\nThe stability of these states is determined by the sign of the second derivative:\n$$\n\\frac{d^2E_T}{d\\theta^2} = 2K \\cos(2\\theta) - \\mu_0 H M_s \\cos\\theta\n$$\nInitially, for a small applied field, the magnetization is in the stable state $\\theta=0$ (aligned with the easy axis). The stability condition for this state is $\\frac{d^2E_T}{d\\theta^2}|_{\\theta=0} > 0$.\n$$\n\\frac{d^2E_T}{d\\theta^2}|_{\\theta=0} = 2K - \\mu_0 H M_s > 0\n$$\nMagnetic switching occurs when this energy minimum vanishes and becomes a maximum, i.e., when the stability condition is violated. The critical field for this instability, known as the switching field $H_{\\mathrm{sw}}$, is the field for which the second derivative equals zero:\n$$\n2K - \\mu_0 H_{\\mathrm{sw}} M_s = 0\n$$\nSolving for $H_{\\mathrm{sw}}$ yields the coherent rotation switching field:\n$$\nH_{\\mathrm{sw}} = \\frac{2K}{\\mu_0 M_s}\n$$\n\n**2. Distribution of the Switching Field**\n\nThe anisotropy constant $K$ and saturation magnetization $M_s$ are given as independent log-normal random variables. This means their natural logarithms are normally distributed.\nLet $X = \\ln K$ and $Y = \\ln M_s$. According to the problem statement:\n$$\nX \\sim \\mathcal{N}(\\mu_K, \\sigma_K^2) \\quad \\text{with} \\quad \\mu_K = \\ln \\tilde{K}, \\sigma_K = \\ln g_K\n$$\n$$\nY \\sim \\mathcal{N}(\\mu_M, \\sigma_M^2) \\quad \\text{with} \\quad \\mu_M = \\ln \\tilde{M}_s, \\sigma_M = \\ln g_M\n$$\nWe analyze the distribution of $H_{\\mathrm{sw}}$ by taking its natural logarithm:\n$$\n\\ln H_{\\mathrm{sw}} = \\ln\\left(\\frac{2K}{\\mu_0 M_s}\\right) = \\ln(2) - \\ln(\\mu_0) + \\ln K - \\ln M_s\n$$\nLet $Z = \\ln H_{\\mathrm{sw}}$. Then $Z = \\ln(2/\\mu_0) + X - Y$. Since $X$ and $Y$ are independent normal random variables, $Z$ is also a normal random variable. Its mean ($\\mu_Z$) and variance ($\\sigma_Z^2$) are:\n$$\n\\mu_Z = \\mathbb{E}[Z] = \\mathbb{E}[\\ln(2/\\mu_0) + X - Y] = \\ln(2/\\mu_0) + \\mu_K - \\mu_M\n$$\n$$\n\\mu_Z = \\ln\\left(\\frac{2\\tilde{K}}{\\mu_0 \\tilde{M}_s}\\right)\n$$\n$$\n\\sigma_Z^2 = \\text{Var}(Z) = \\text{Var}(X - Y) = \\text{Var}(X) + \\text{Var}(Y) = \\sigma_K^2 + \\sigma_M^2\n$$\n$$\n\\sigma_Z^2 = (\\ln g_K)^2 + (\\ln g_M)^2\n$$\nThus, $\\ln H_{\\mathrm{sw}}$ follows a normal distribution $\\mathcal{N}(\\mu_Z, \\sigma_Z^2)$.\n\n**3. Bit Error Rate (BER) Calculation**\n\nThe BER is interpreted as the probability that a grain fails to switch when a write field of amplitude $H_w$ is applied. This occurs if the intrinsic switching field $H_{\\mathrm{sw}}$ of the grain is greater than $H_w$.\n$$\n\\text{BER} = \\mathbb{P}(H_{\\mathrm{sw}} > H_w)\n$$\nSince the natural logarithm is a monotonically increasing function, this is equivalent to:\n$$\n\\text{BER} = \\mathbb{P}(\\ln H_{\\mathrm{sw}} > \\ln H_w) = \\mathbb{P}(Z > \\ln H_w)\n$$\nTo compute this probability, we standardize the normal variable $Z$:\n$$\n\\text{standardized variable} = \\frac{Z - \\mu_Z}{\\sigma_Z} \\sim \\mathcal{N}(0, 1)\n$$\nThe probability becomes:\n$$\n\\text{BER} = \\mathbb{P}\\left(\\frac{Z - \\mu_Z}{\\sigma_Z} > \\frac{\\ln H_w - \\mu_Z}{\\sigma_Z}\\right)\n$$\nThis is the tail probability of a standard normal distribution. It can be expressed using the complementary error function, $\\text{erfc}(x)$, which is related to the standard normal CDF $\\Phi(x)$ by $\\mathbb{P}(X > x) = 1 - \\Phi(x) = \\frac{1}{2}\\text{erfc}(x/\\sqrt{2})$ for $X \\sim \\mathcal{N}(0,1)$.\nTherefore, the BER is given by:\n$$\n\\text{BER} = \\frac{1}{2} \\text{erfc}\\left(\\frac{\\ln H_w - \\mu_Z}{\\sigma_Z \\sqrt{2}}\\right)\n$$\nwhere:\n$$\n\\mu_Z = \\ln\\left(\\frac{2\\tilde{K}}{\\mu_0 \\tilde{M}_s}\\right) \\quad \\text{and} \\quad \\sigma_Z = \\sqrt{(\\ln g_K)^2 + (\\ln g_M)^2}\n$$\nThis is the final expression to be implemented. All constants and variables must be in SI units as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erfc\n\ndef solve():\n    \"\"\"\n    Computes the bit error rate (BER) for a granular magnetic medium\n    based on the Stoner-Wohlfarth model with log-normally distributed\n    material properties.\n    \"\"\"\n\n    # Define the constant, vacuum permeability in H/m.\n    MU_0 = 4 * np.pi * 1e-7\n\n    # Test suite: each tuple is (K_tilde, g_K, Ms_tilde, g_M, Hw)\n    # K_tilde: median anisotropy constant [J/m^3]\n    # g_K: geometric standard deviation of K (dimensionless)\n    # Ms_tilde: median saturation magnetization [A/m]\n    # g_M: geometric standard deviation of Ms (dimensionless)\n    # Hw: write field amplitude [A/m]\n    test_cases = [\n        # Case 1 (boundary check at the median switching field)\n        (7.0e5, 1.2214, 1.0e6, 1.1052, 1.11408e6),\n        # Case 2 (happy path with moderately stronger write field)\n        (7.0e5, 1.2214, 1.0e6, 1.1052, 1.4e6),\n        # Case 3 (narrow dispersion, slightly insufficient write field)\n        (7.0e5, 1.01, 1.0e6, 1.01, 0.99 * 1.11408e6),\n        # Case 4 (harder medium, weak write field)\n        (1.0e6, 1.2214, 8.0e5, 1.2214, 1.0e6),\n        # Case 5 (softer medium, strong write field)\n        (1.0e4, 1.2214, 1.6e6, 1.1052, 2.0e4),\n    ]\n\n    results = []\n    for case in test_cases:\n        K_tilde, g_K, Ms_tilde, g_M, Hw = case\n\n        # Step 1: Calculate the mean (mu_Z) and standard deviation (sigma_Z)\n        # of the logarithm of the switching field, ln(H_sw).\n        \n        # Mean of ln(H_sw), derived from the median switching field.\n        # mu_Z = ln(2 * K_tilde / (mu_0 * Ms_tilde))\n        mu_Z = np.log(2 * K_tilde / (MU_0 * Ms_tilde))\n\n        # Standard deviation of ln(H_sw), derived from the geometric standard deviations.\n        # sigma_Z = sqrt((ln(g_K))^2 + (ln(g_M))^2)\n        log_gK = np.log(g_K)\n        log_gM = np.log(g_M)\n        sigma_Z = np.sqrt(log_gK**2 + log_gM**2)\n        \n        # Step 2: Calculate the Bit Error Rate (BER).\n        # BER = P(H_sw > Hw) = P(ln(H_sw) > ln(Hw))\n        # This is a tail probability of a normal distribution, which can be\n        # expressed using the complementary error function (erfc).\n        # BER = 0.5 * erfc((ln(Hw) - mu_Z) / (sigma_Z * sqrt(2)))\n        \n        # Handle the edge case where dispersion is zero (sigma_Z = 0).\n        if sigma_Z == 0:\n            median_H_sw = np.exp(mu_Z)\n            ber = 1.0 if median_H_sw > Hw else 0.0\n        else:\n            arg_erfc = (np.log(Hw) - mu_Z) / (sigma_Z * np.sqrt(2))\n            ber = 0.5 * erfc(arg_erfc)\n\n        # Step 3: Format the result to six significant figures.\n        results.append(f\"{ber:.6g}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2497694"}]}