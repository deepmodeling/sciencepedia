{"hands_on_practices": [{"introduction": "Before delving into the complexities of stochastic fluctuations and entropy production, a solid understanding of a reaction network's underlying structure is essential. This foundational practice focuses on translating a set of chemical reactions into its mathematical representation, the stoichiometric matrix $S$. By analyzing this matrix [@problem_id:2678453], we can uncover fundamental constraints on the system's dynamics, such as conserved quantities, which define the space of all possible states the system can explore.", "problem": "Consider a well-mixed, isothermal, isochoric mesoscopic reactor containing three chemical species $A$, $B$, and $C$ undergoing the following unimolecular reactions: $A \\to B$, $B \\to C$, and $C \\to A$, each occurring as an elementary reaction with finite rate constants. The system is modeled stochastically by the Chemical Master Equation, where the state is the copy-number vector $\\boldsymbol{n} = (n_A, n_B, n_C)^{\\mathsf{T}} \\in \\mathbb{Z}_{\\ge 0}^{3}$. The stoichiometric matrix $S \\in \\mathbb{Z}^{3 \\times 3}$ is defined such that its $j$-th column is the state-change (stoichiometric) vector $\\boldsymbol{\\nu}_j$ for the $j$-th reaction channel, and the stoichiometric subspace is the linear subspace of $\\mathbb{R}^{3}$ spanned by the columns of $S$. A linear conserved quantity is any vector $\\boldsymbol{\\ell} \\in \\mathbb{R}^{3}$ for which $\\boldsymbol{\\ell}^{\\mathsf{T}} S = \\boldsymbol{0}^{\\mathsf{T}}$, implying that $\\boldsymbol{\\ell}^{\\mathsf{T}} \\boldsymbol{n}(t)$ is invariant under the dynamics. Using only these definitions and standard linear algebra, do the following:\n1. Construct the stoichiometric matrix $S$.\n2. Identify one nontrivial linear conserved total count as an explicit linear combination of $n_A$, $n_B$, and $n_C$.\n3. Determine the dimension of the stoichiometric subspace.\nReport your final result as a triplet consisting of $S$, the explicit symbolic expression for the conserved total count, and the dimension of the stoichiometric subspace. No numerical rounding is required, and no units are needed. Your final answer must be a single expression.", "solution": "The problem requires the determination of three quantities for a given chemical reaction network: the stoichiometric matrix $S$, a nontrivial linear conserved quantity, and the dimension of the stoichiometric subspace. The analysis will proceed systematically based on the provided definitions and the principles of linear algebra.\n\nThe state of the system is given by the copy-number vector $\\boldsymbol{n} = (n_A, n_B, n_C)^{\\mathsf{T}}$, where $n_A$, $n_B$, and $n_C$ are the numbers of molecules of species $A$, $B$, and $C$, respectively.\n\nFirst, we construct the stoichiometric matrix $S$. The columns of $S$ are the state-change vectors $\\boldsymbol{\\nu}_j$ for each of the three reactions.\n\n1.  Reaction $R_1$: $A \\to B$. This reaction consumes one molecule of $A$ and produces one molecule of $B$. The change in the state vector is $\\Delta\\boldsymbol{n} = (-1, 1, 0)^{\\mathsf{T}}$. Thus, the first state-change vector is $\\boldsymbol{\\nu}_1 = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}$.\n\n2.  Reaction $R_2$: $B \\to C$. This reaction consumes one molecule of $B$ and produces one molecule of $C$. The change in the state vector is $\\Delta\\boldsymbol{n} = (0, -1, 1)^{\\mathsf{T}}$. Thus, the second state-change vector is $\\boldsymbol{\\nu}_2 = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix}$.\n\n3.  Reaction $R_3$: $C \\to A$. This reaction consumes one molecule of $C$ and produces one molecule of $A$. The change in the state vector is $\\Delta\\boldsymbol{n} = (1, 0, -1)^{\\mathsf{T}}$. Thus, the third state-change vector is $\\boldsymbol{\\nu}_3 = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}$.\n\nThe stoichiometric matrix $S$ is formed by taking these vectors as its columns:\n$$ S = \\begin{bmatrix} \\boldsymbol{\\nu}_1  \\boldsymbol{\\nu}_2  \\boldsymbol{\\nu}_3 \\end{bmatrix} = \\begin{pmatrix} -1  0  1 \\\\ 1  -1  0 \\\\ 0  1  -1 \\end{pmatrix} $$\n\nSecond, we identify a nontrivial linear conserved quantity. According to the definition provided, this corresponds to a quantity $\\boldsymbol{\\ell}^{\\mathsf{T}}\\boldsymbol{n}$ where $\\boldsymbol{\\ell} \\in \\mathbb{R}^{3}$ is a nonzero vector satisfying $\\boldsymbol{\\ell}^{\\mathsf{T}} S = \\boldsymbol{0}^{\\mathsf{T}}$. The vector $\\boldsymbol{\\ell}$ is therefore a basis vector for the left null space of $S$. Let $\\boldsymbol{\\ell} = (\\ell_A, \\ell_B, \\ell_C)^{\\mathsf{T}}$. The condition $\\boldsymbol{\\ell}^{\\mathsf{T}} S = \\boldsymbol{0}^{\\mathsf{T}}$ translates to the following system of linear equations:\n$$ \\begin{pmatrix} \\ell_A  \\ell_B  \\ell_C \\end{pmatrix} \\begin{pmatrix} -1  0  1 \\\\ 1  -1  0 \\\\ 0  1  -1 \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\end{pmatrix} $$\nThis yields:\n1.  $-\\ell_A + \\ell_B = 0 \\implies \\ell_A = \\ell_B$\n2.  $-\\ell_B + \\ell_C = 0 \\implies \\ell_B = \\ell_C$\n3.  $\\ell_A - \\ell_C = 0 \\implies \\ell_A = \\ell_C$\n\nFrom these equations, it is evident that $\\ell_A = \\ell_B = \\ell_C$. To find a nontrivial vector $\\boldsymbol{\\ell}$, we can set $\\ell_A = \\ell_B = \\ell_C = 1$. This gives $\\boldsymbol{\\ell} = (1, 1, 1)^{\\mathsf{T}}$. The corresponding conserved quantity is:\n$$ \\boldsymbol{\\ell}^{\\mathsf{T}}\\boldsymbol{n} = \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\begin{pmatrix} n_A \\\\ n_B \\\\ n_C \\end{pmatrix} = n_A + n_B + n_C $$\nThis quantity represents the total number of molecules in the reactor, which remains constant because the reactions only interconvert the species.\n\nThird, we determine the dimension of the stoichiometric subspace. This subspace is the column space of $S$, and its dimension is equal to the rank of $S$, denoted $\\text{rank}(S)$. The rank of a matrix is the dimension of its column space (and its row space).\n\nWe can observe the linear relationship among the columns of $S$:\n$$ \\boldsymbol{\\nu}_1 + \\boldsymbol{\\nu}_2 + \\boldsymbol{\\nu}_3 = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\nThis indicates that the three column vectors are linearly dependent, so $\\text{rank}(S)  3$.\n\nTo find the precise rank, we can use the rank-nullity theorem, which for a matrix $A \\in \\mathbb{R}^{m \\times n}$ states that $\\text{rank}(A) + \\text{nullity}(A^{\\mathsf{T}}) = m$, where $\\text{nullity}(A^{\\mathsf{T}})$ is the dimension of the left null space. We have already found that the left null space of $S$ is spanned by the single vector $\\boldsymbol{\\ell} = (1, 1, 1)^{\\mathsf{T}}$. Therefore, the dimension of the left null space is $1$. The matrix $S$ has $m=3$ rows. Applying the theorem:\n$$ \\text{rank}(S) + \\text{dim}(\\text{ker}(S^{\\mathsf{T}})) = 3 $$\n$$ \\text{rank}(S) + 1 = 3 $$\n$$ \\text{rank}(S) = 2 $$\nThus, the dimension of the stoichiometric subspace is $2$.\n\nThe three required results are the matrix $S$, the expression for the conserved quantity $n_A + n_B + n_C$, and the dimension of the stoichiometric subspace, which is $2$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\begin{pmatrix}\n-1  0  1 \\\\\n1  -1  0 \\\\\n0  1  -1\n\\end{pmatrix}\n\nn_A + n_B + n_C\n\n2\n\\end{pmatrix}\n}\n$$", "id": "2678453"}, {"introduction": "A cornerstone of stochastic thermodynamics is the deep connection between the kinetic rates of a process and the thermodynamic forces driving it. This exercise illustrates this principle by examining a simple cyclic network where the microscopic transition rates encode a net thermodynamic driving force, or affinity. You will calculate this cycle affinity directly from the rates and verify that it matches the macroscopic thermodynamic potential supplied by external reservoirs, providing a concrete example of local detailed balance in action [@problem_id:2678365].", "problem": "Consider a continuous-time Markov jump process describing a three-state unicyclic reaction network with states $1 \\to 2 \\to 3 \\to 1$ at uniform temperature $T$. The system is coupled to two chemostatted chemical reservoirs that maintain constant chemical potentials $\\mu_{S}$ and $\\mu_{P}$ for a substrate species $S$ and a product species $P$, respectively. Each completed forward cycle $1 \\to 2 \\to 3 \\to 1$ corresponds to the net chemical transformation $S \\to P$. Assume that the coarse-grained internal energies of the states are identical, so that transitions do not change the internal energy of the system, and that there are no mechanical nonconservative forces. The dynamics obey microreversibility and local detailed balance for Markov jump processes.\n\nThe nonzero transition rates are specified as\n$k_{12} = \\exp(2)\\,\\mathrm{s}^{-1}$, $k_{21} = 1\\,\\mathrm{s}^{-1}$, $k_{23} = \\exp(1)\\,\\mathrm{s}^{-1}$, $k_{32} = 1\\,\\mathrm{s}^{-1}$, $k_{31} = \\exp(2)\\,\\mathrm{s}^{-1}$, $k_{13} = 1\\,\\mathrm{s}^{-1}$.\nThe chemical potentials satisfy $\\mu_{S} - \\mu_{P} = 5\\,k_{B} T$, where $k_{B}$ is the Boltzmann constant.\n\nUsing only fundamental principles of stochastic thermodynamics (microreversibility and local detailed balance), determine the steady-state cycle affinity $\\mathcal{A}$ in the forward direction $1 \\to 2 \\to 3 \\to 1$ from the specified transition rates, and verify its consistency with the chemostatted reservoir chemical potentials. Express the final cycle affinity $\\mathcal{A}$ as a dimensionless number. No rounding is required; give the exact value.", "solution": "The problem requires the calculation of the steady-state cycle affinity, $\\mathcal{A}$, for a unicyclic reaction network and verification of its consistency with the stated thermodynamic conditions. Given the instruction to express the affinity as a dimensionless number, we shall define $\\mathcal{A}$ in its dimensionless form, which is a standard convention in stochastic thermodynamics.\n\nThe system is a three-state Markov jump process with states labeled $1$, $2$, and $3$. The network topology is a single cycle, with transitions defined for the forward path $1 \\to 2 \\to 3 \\to 1$. The dynamics are governed by the principle of local detailed balance.\n\nFor any elementary transition between two states $i$ and $j$, local detailed balance relates the forward and backward transition rates, $k_{ij}$ and $k_{ji}$, to the thermodynamic force. The dimensionless cycle affinity $\\mathcal{A}$ for the cycle $C: 1 \\to 2 \\to 3 \\to 1$ is the sum of the dimensionless free energy drops for each step. This can be expressed in terms of the rate constants as:\n$$\n\\mathcal{A} = \\ln\\left(\\frac{k_{12}}{k_{21}}\\right) + \\ln\\left(\\frac{k_{23}}{k_{32}}\\right) + \\ln\\left(\\frac{k_{31}}{k_{13}}\\right)\n$$\nThis expression simplifies to the natural logarithm of the ratio of the product of forward rates to the product of backward rates over the entire cycle:\n$$\n\\mathcal{A} = \\ln\\left(\\frac{k_{12} k_{23} k_{31}}{k_{21} k_{32} k_{13}}\\right)\n$$\nThe problem provides the following nonzero transition rates: $k_{12} = \\exp(2)\\,\\mathrm{s}^{-1}$, $k_{21} = 1\\,\\mathrm{s}^{-1}$, $k_{23} = \\exp(1)\\,\\mathrm{s}^{-1}$, $k_{32} = 1\\,\\mathrm{s}^{-1}$, $k_{31} = \\exp(2)\\,\\mathrm{s}^{-1}$, and $k_{13} = 1\\,\\mathrm{s}^{-1}$.\n\nWe substitute these values into the expression for the affinity $\\mathcal{A}$. First, we compute the product of the forward rates for the cycle $1 \\to 2 \\to 3 \\to 1$:\n$$\nk_{12} k_{23} k_{31} = (\\exp(2)) \\cdot (\\exp(1)) \\cdot (\\exp(2)) = \\exp(2+1+2) = \\exp(5)\n$$\nThe units of this product are $(\\mathrm{s}^{-1})^{3}$. Next, we compute the product of the backward rates for the same cycle:\n$$\nk_{21} k_{32} k_{13} = (1) \\cdot (1) \\cdot (1) = 1\n$$\nThe units are also $(\\mathrm{s}^{-1})^{3}$. The ratio of these products is therefore a dimensionless quantity:\n$$\n\\frac{k_{12} k_{23} k_{31}}{k_{21} k_{32} k_{13}} = \\frac{\\exp(5)}{1} = \\exp(5)\n$$\nThe dimensionless cycle affinity $\\mathcal{A}$ is then found by taking the natural logarithm:\n$$\n\\mathcal{A} = \\ln(\\exp(5)) = 5\n$$\nThe second part of the task is to verify the consistency of this result with the chemostatted reservoir chemical potentials.\nAccording to the principles of nonequilibrium thermodynamics, the dimensional affinity, which is $\\mathcal{A} \\cdot k_B T$, must be equal to the total free energy supplied by the external reservoirs during one cycle. The problem states that each forward cycle corresponds to the net chemical transformation $S \\to P$. The free energy change for this transformation is the difference in chemical potentials, $\\Delta\\mu = \\mu_S - \\mu_P$.\nFor consistency, the following equality must hold:\n$$\n\\mathcal{A} \\cdot k_B T = \\mu_S - \\mu_P\n$$\nWe are given that the chemical potential difference is $\\mu_S - \\mu_P = 5 \\, k_B T$.\nFrom our kinetic calculation, we found the dimensionless affinity to be $\\mathcal{A} = 5$. Substituting this value into the consistency condition gives:\n$$\n5 \\cdot k_B T = 5 \\, k_B T\n$$\nThis equality is satisfied. This confirms that the given kinetic rates are fully consistent with the specified thermodynamic driving force from the chemical reservoirs, as required by the fundamental principles of stochastic thermodynamics. The determined dimensionless cycle affinity is $5$.", "answer": "$$\\boxed{5}$$", "id": "2678365"}, {"introduction": "Theoretical analysis provides crucial insights, but simulating stochastic trajectories allows us to directly observe and quantify thermodynamic phenomena. This practice delves into the computational heart of stochastic chemical kinetics, the Gillespie algorithm, which generates exact sample paths of the system's evolution. Critically, it also demonstrates how to measure the entropy flow to the environment on a per-jump basis, bridging the abstract concept of entropy production with a concrete computational procedure [@problem_id:2678446].", "problem": "Consider a well-mixed isothermal dilute solution at temperature $T$ containing $S$ chemical species interacting through $R$ reaction channels. Let the state be the molecule count vector $x \\in \\mathbb{N}_0^S$ and let the $r$-th reaction have stoichiometric change vector $\\nu_r \\in \\mathbb{Z}^S$ and propensity $w_r(x)$, for $r \\in \\{1,\\dots,R\\}$. Assume the dynamics are governed by the chemical master equation and thus constitute a continuous-time Markov jump process with transition rates $k_{x \\to x+\\nu_r} = w_r(x)$. For each reaction $r$, assume there exists a unique reverse channel $r^\\star$ with stoichiometric change vector $\\nu_{r^\\star} = -\\nu_r$ and propensity $w_{r^\\star}(x')$, where $x' = x + \\nu_r$, such that local detailed balance holds in the sense that the medium entropy flow associated with a single jump $x \\to x'$ via $r$ is given by the log ratio of the forward and backward rates between these microstates. You want to simulate a single stochastic trajectory over a time interval $[0, T_{\\mathrm{end}}]$ using the direct Stochastic Simulation Algorithm (SSA) and to record the running medium entropy production along the trajectory, denoted $S_{\\mathrm{m}}(t)$, as the sum over all jump contributions.\n\nWhich option correctly outlines the steps of the direct Gillespie Stochastic Simulation Algorithm (SSA) for this system and correctly specifies how to record the medium entropy increment at each jump according to local detailed balance?\n\nA. At current state $x$ and time $t$, compute the total propensity $w_0(x) = \\sum_{r=1}^R w_r(x)$. Sample a waiting time $\\tau$ from the exponential distribution with rate $w_0(x)$, i.e., with density $w_0(x)\\,\\exp(-w_0(x)\\,\\tau)$ for $\\tau \\ge 0$. Select the next reaction channel $r$ with probability $w_r(x)/w_0(x)$. Update the state to $x' = x + \\nu_r$ and the time to $t \\leftarrow t + \\tau$. Record the medium entropy increment $\\Delta s_{\\mathrm{m}} = \\ln\\left[\\dfrac{w_r(x)}{w_{r^\\star}(x')}\\right]$, add it to $S_{\\mathrm{m}}(t)$, recompute propensities at $x'$, and iterate until $t \\ge T_{\\mathrm{end}}$.\n\nB. At current state $x$ and time $t$, compute $w_0(x) = \\sum_{r=1}^R w_r(x)$. Set a deterministic waiting time $\\tau = 1/w_0(x)$. Select reaction $r$ with probability $w_r(x)/w_0(x)$. Update to $x' = x + \\nu_r$, set $t \\leftarrow t + \\tau$, and record $\\Delta s_{\\mathrm{m}} = \\ln\\left[\\dfrac{w_r(x)}{w_0(x)}\\right]$. Repeat until $t \\ge T_{\\mathrm{end}}$.\n\nC. At current state $x$ and time $t$, sample a waiting time $\\tau$ from an exponential distribution with rate $w_0(x) = \\sum_{r=1}^R w_r(x)$. Choose reaction $r$ with probability proportional to $w_r(x+\\nu_r)$, i.e., according to the normalized set $\\{w_r(x+\\nu_r)/\\sum_{q=1}^R w_q(x+\\nu_q)\\}$. Update to $x' = x + \\nu_r$, set $t \\leftarrow t + \\tau$, and record $\\Delta s_{\\mathrm{m}} = -\\ln p_t(x') + \\ln p_t(x)$, where $p_t$ is the instantaneous probability distribution over states. Repeat until $t \\ge T_{\\mathrm{end}}$.\n\nD. Evolve the system with a fixed time discretization $\\delta t > 0$. At each step, draw a uniform random reaction channel $r$ from $\\{1,\\dots,R\\}$ and fire it if a uniform random number $u \\in [0,1]$ is less than $w_r(x)\\,\\delta t$, otherwise do nothing; then set $t \\leftarrow t + \\delta t$. If reaction $r$ fires, update to $x' = x + \\nu_r$ and record $\\Delta s_{\\mathrm{m}} = \\ln\\left[\\dfrac{w_r(x)}{w_{r^\\star}(x)}\\right]$. Continue until $t \\ge T_{\\mathrm{end}}$.", "solution": "The governing fundamental base is the chemical master equation (CME), which defines a continuous-time Markov jump process over the state space of molecule counts. For a current state $x$, the total rate to leave $x$ is $w_0(x) = \\sum_{r=1}^R w_r(x)$, where $w_r(x)$ is the propensity of reaction $r$ at $x$. Two key results for continuous-time Markov jump processes follow from the CME and standard hazard-rate arguments:\n\n$1.$ Waiting-time distribution. Let $P(\\tau)$ be the survival probability of no reaction occurring in the interval $[t, t+\\tau)$ given the system is in state $x$ at time $t$. Over an infinitesimal increment $\\mathrm{d}\\tau$, the probability to have no reaction is $1 - w_0(x)\\,\\mathrm{d}\\tau + o(\\mathrm{d}\\tau)$, because the total hazard to leave $x$ is $w_0(x)$. Thus $P(\\tau + \\mathrm{d}\\tau) = P(\\tau)\\left(1 - w_0(x)\\,\\mathrm{d}\\tau\\right) + o(\\mathrm{d}\\tau)$, leading to the differential equation $\\dfrac{\\mathrm{d}P}{\\mathrm{d}\\tau} = -w_0(x)\\,P(\\tau)$ with initial condition $P(0) = 1$. The solution is $P(\\tau) = \\exp\\left(-w_0(x)\\,\\tau\\right)$. Therefore the waiting time $\\tau$ to the next reaction is exponentially distributed with rate $w_0(x)$, having density $f(\\tau) = w_0(x)\\,\\exp\\left(-w_0(x)\\,\\tau\\right)$ for $\\tau \\ge 0$.\n\n$2.$ Channel-selection distribution. Conditional on a reaction occurring at time $t+\\tau$, the probability that the channel is $r$ is given by the ratio of its hazard to the total hazard at the pre-jump state $x$, namely $\\mathbb{P}(r \\mid x) = w_r(x)/w_0(x)$. This follows from the decomposition of the total rate into the contributions of each channel and the memoryless property of the exponential waiting time.\n\nThese two results are the foundation of the direct Stochastic Simulation Algorithm (SSA) of Daniel Gillespie: at each state, one samples an exponential waiting time using the total propensity and then selects a reaction channel according to the normalized propensities at the pre-jump state.\n\nNow consider medium entropy flow in stochastic thermodynamics. For Markov jump processes obeying local detailed balance with well-defined reverse transitions, the increment of medium entropy associated with an elementary jump $x \\to x'$ via reaction $r$ is given by\n$$\n\\Delta s_{\\mathrm{m}}(x \\to x'; r) \\equiv \\ln \\frac{k_{x \\to x'}(r)}{k_{x' \\to x}(r^\\star)} = \\ln \\frac{w_r(x)}{w_{r^\\star}(x')}.\n$$\nThis expression arises from the ratio of the probability densities of the forward and time-reversed path segments over the small time interval surrounding the jump. Under isothermal conditions with ideal dilute solution and chemostatted chemical potentials, local detailed balance further connects this log ratio to the dissipated heat and chemical work via $\\Delta s_{\\mathrm{m}} = \\beta q_{\\mathrm{env}}$ when the appropriate energetic and chemical contributions are accounted for, but the fundamental, implementation-ready expression for recording along a trajectory is the log ratio of the forward propensity at the pre-jump state and the reverse propensity at the post-jump state.\n\nWe now evaluate each option:\n\nOption A: This specifies computing $w_0(x) = \\sum_{r=1}^R w_r(x)$; sampling $\\tau$ from the exponential distribution with rate $w_0(x)$; selecting reaction $r$ with probability $w_r(x)/w_0(x)$; updating the state $x \\to x' = x + \\nu_r$; and recording the medium entropy increment $\\Delta s_{\\mathrm{m}} = \\ln\\left[w_r(x)/w_{r^\\star}(x')\\right]$. These steps exactly match the derivation from the CME for the waiting time and channel selection, and they implement the local-detailed-balance medium entropy increment using the reverse propensity evaluated at the post-jump state. Recomputing the propensities at $x'$ and iterating is the standard direct SSA loop. Therefore Option A is correct.\n\nOption B: This sets a deterministic waiting time $\\tau = 1/w_0(x)$. This contradicts the exponential waiting time distribution derived from the CME; the correct waiting time is a random variable with density $w_0(x)\\,\\exp(-w_0(x)\\,\\tau)$, not a constant. Additionally, it records $\\Delta s_{\\mathrm{m}} = \\ln\\left[w_r(x)/w_0(x)\\right]$, which is not the local-detailed-balance entropy flow for a jump; the medium entropy increment depends on the reverse transition rate from the post-jump state, not on the total pre-jump rate. Therefore Option B is incorrect.\n\nOption C: This uses the correct exponential waiting time with rate $w_0(x)$ but then selects the reaction channel with probability proportional to $w_r(x+\\nu_r)$, i.e., using post-fired propensities to choose the channel. The correct conditional probability uses the pre-jump hazards $w_r(x)/w_0(x)$; using $w_r(x+\\nu_r)$ is inconsistent with the Markov jump process decomposition at the pre-jump state. Moreover, it records $\\Delta s_{\\mathrm{m}} = -\\ln p_t(x') + \\ln p_t(x)$, which is the instantaneous system entropy change contribution $\\Delta s_{\\mathrm{sys}}$, not the medium entropy flow. The medium entropy increment is given by the log ratio of forward and reverse rates, as above. Therefore Option C is incorrect.\n\nOption D: This uses a fixed time step $\\delta t$ and a thinning-like scheme by comparing $u$ to $w_r(x)\\,\\delta t$ for a uniformly chosen $r$. This is not the direct Gillespie SSA; it is a form of rejection-based discrete-time approximation that does not in general produce exact sample paths unless $\\delta t \\to 0$ and one handles multiple channels carefully with total-rate thinning. Furthermore, the recorded medium entropy increment $\\Delta s_{\\mathrm{m}} = \\ln\\left[w_r(x)/w_{r^\\star}(x)\\right]$ uses the reverse propensity evaluated at the pre-jump state $x$ rather than the post-jump state $x'$, whereas local detailed balance requires the ratio $w_r(x)/w_{r^\\star}(x')$ between the two states connected by the jump. Therefore Option D is incorrect.\n\nIn conclusion, only Option A correctly specifies both the exact direct Gillespie SSA and the locally detailed-balanced medium entropy increment to record at each jump.", "answer": "$$\\boxed{A}$$", "id": "2678446"}]}