{"hands_on_practices": [{"introduction": "The first step in analyzing any reaction network is to translate its chemical equations into a mathematical framework. The stoichiometric matrix $N$ serves this purpose, but its construction requires a key convention for handling reversible reactions. This exercise ([@problem_id:2679078]) guides you through building a stoichiometric matrix from first principles and, more importantly, justifying the standard practice of splitting reversible reactions into two irreversible ones to ensure a physically meaningful representation where reaction rates are always non-negative.", "problem": "Consider a well-mixed isothermal reaction network involving $3$ chemical species $\\{A,B,C\\}$ in a constant volume reactor. The network consists of the following reactions at fixed temperature, each following the law of mass-action kinetics:\n\n(i) $A + B \\rightleftharpoons C$,\n\n(ii) $C \\rightleftharpoons B$,\n\n(iii) $B \\rightarrow A$.\n\nTo represent the network using a stoichiometric matrix, adopt the convention that each reversible reaction is represented as two distinct irreversible reactions, one in the forward direction and one in the backward direction. Let the species ordering be $(A,B,C)$ and choose the reaction ordering to be $(R_{1}^{+}: A+B \\rightarrow C,\\ R_{1}^{-}: C \\rightarrow A+B,\\ R_{2}^{+}: C \\rightarrow B,\\ R_{2}^{-}: B \\rightarrow C,\\ R_{3}: B \\rightarrow A)$.\n\nUse only the following fundamental base:\n\n- The stoichiometric matrix $N$ has entries $N_{i j} = \\nu_{i j}^{\\text{prod}} - \\nu_{i j}^{\\text{reac}}$, where $\\nu_{i j}^{\\text{prod}}$ and $\\nu_{i j}^{\\text{reac}}$ are the stoichiometric coefficients of species $i$ as product and reactant in reaction $j$, respectively.\n- Under mass-action kinetics, the reaction rate for an irreversible reaction $j$ is $v_{j}(\\boldsymbol{x}) = k_{j} \\prod_{i} x_{i}^{\\nu_{i j}^{\\text{reac}}}$ with $k_{j} \\ge 0$ and $x_{i} \\ge 0$, and the species dynamics satisfy $\\frac{d\\boldsymbol{x}}{dt} = N \\boldsymbol{v}(\\boldsymbol{x})$.\n- A reversible reaction written as a single net step may be conceived as the difference of two nonnegative one-way rates, which motivates the splitting into two irreversible reactions so that each column of $N$ is paired with a nonnegative scalar flux.\n\nTasks:\n\n(a) Construct the stoichiometric matrix $N \\in \\mathbb{R}^{3 \\times 5}$ for the network under the stated convention and orderings. Show each column as the net stoichiometric change vector for the corresponding irreversible reaction.\n\n(b) Justify, from first principles and the given base, why splitting a reversible reaction into two irreversible reactions is essential for a representation in which the reaction rate vector $\\boldsymbol{v}(\\boldsymbol{x})$ is componentwise nonnegative and the dynamics $\\frac{d\\boldsymbol{x}}{dt} = N \\boldsymbol{v}(\\boldsymbol{x})$ hold with physically interpretable one-way fluxes. Your justification should explain how signs are handled in $N$ and why nonnegativity of $\\boldsymbol{v}(\\boldsymbol{x})$ would be violated if a single net reversible step were used as one column.\n\n(c) Compute the dimension of the right nullspace of $N$, that is, $\\dim(\\ker N)$. Provide this single integer as your final answer. No rounding is needed and no units are required.", "solution": "The problem is scientifically grounded, well-posed, objective, and internally consistent. It presents a standard exercise in chemical reaction network theory, providing all necessary definitions and constraints for a unique and verifiable solution. Therefore, the problem is valid.\n\n(a) Construction of the Stoichiometric Matrix $N$.\nThe system involves $3$ species, ordered as $(A,B,C)$, and $5$ irreversible reactions ordered as $(R_{1}^{+}: A+B \\rightarrow C,\\ R_{1}^{-}: C \\rightarrow A+B,\\ R_{2}^{+}: C \\rightarrow B,\\ R_{2}^{-}: B \\rightarrow C,\\ R_{3}: B \\rightarrow A)$. The stoichiometric matrix $N$ is an element of $\\mathbb{R}^{3 \\times 5}$, where the rows correspond to the species and the columns to the reactions. Each entry $N_{ij}$ is the net change in the amount of species $i$ due to reaction $j$, calculated as $N_{i j} = \\nu_{i j}^{\\text{prod}} - \\nu_{i j}^{\\text{reac}}$.\n\nWe construct the matrix column by column. Each column is a vector representing the net stoichiometric change for its corresponding reaction.\n\nFor a species vector $\\boldsymbol{x} = [x_A, x_B, x_C]^T$, the change vectors are:\n1.  Reaction $R_1^{+}: A + B \\rightarrow C$. The stoichiometric coefficients as reactants are $\\nu_{A,1}^{\\text{reac}} = 1$, $\\nu_{B,1}^{\\text{reac}} = 1$, $\\nu_{C,1}^{\\text{reac}} = 0$. The coefficients as products are $\\nu_{A,1}^{\\text{prod}} = 0$, $\\nu_{B,1}^{\\text{prod}} = 0$, $\\nu_{C,1}^{\\text{prod}} = 1$. The first column of $N$ is therefore $\\boldsymbol{n}_1 = [\\nu_{A,1}^{\\text{prod}}-\\nu_{A,1}^{\\text{reac}}, \\nu_{B,1}^{\\text{prod}}-\\nu_{B,1}^{\\text{reac}}, \\nu_{C,1}^{\\text{prod}}-\\nu_{C,1}^{\\text{reac}}]^T = [0-1, 0-1, 1-0]^T = [-1, -1, 1]^T$.\n\n2.  Reaction $R_1^{-}: C \\rightarrow A + B$. The coefficients are $\\nu_{A,2}^{\\text{reac}}=0$, $\\nu_{B,2}^{\\text{reac}}=0$, $\\nu_{C,2}^{\\text{reac}}=1$ and $\\nu_{A,2}^{\\text{prod}}=1$, $\\nu_{B,2}^{\\text{prod}}=1$, $\\nu_{C,2}^{\\text{prod}}=0$. The second column is $\\boldsymbol{n}_2 = [1-0, 1-0, 0-1]^T = [1, 1, -1]^T$.\n\n3.  Reaction $R_2^{+}: C \\rightarrow B$. The coefficients are $\\nu_{A,3}^{\\text{reac}}=0$, $\\nu_{B,3}^{\\text{reac}}=0$, $\\nu_{C,3}^{\\text{reac}}=1$ and $\\nu_{A,3}^{\\text{prod}}=0$, $\\nu_{B,3}^{\\text{prod}}=1$, $\\nu_{C,3}^{\\text{prod}}=0$. The third column is $\\boldsymbol{n}_3 = [0-0, 1-0, 0-1]^T = [0, 1, -1]^T$.\n\n4.  Reaction $R_2^{-}: B \\rightarrow C$. The coefficients are $\\nu_{A,4}^{\\text{reac}}=0$, $\\nu_{B,4}^{\\text{reac}}=1$, $\\nu_{C,4}^{\\text{reac}}=0$ and $\\nu_{A,4}^{\\text{prod}}=0$, $\\nu_{B,4}^{\\text{prod}}=0$, $\\nu_{C,4}^{\\text{prod}}=1$. The fourth column is $\\boldsymbol{n}_4 = [0-0, 0-1, 1-0]^T = [0, -1, 1]^T$.\n\n5.  Reaction $R_3: B \\rightarrow A$. The coefficients are $\\nu_{A,5}^{\\text{reac}}=0$, $\\nu_{B,5}^{\\text{reac}}=1$, $\\nu_{C,5}^{\\text{reac}}=0$ and $\\nu_{A,5}^{\\text{prod}}=1$, $\\nu_{B,5}^{\\text{prod}}=0$, $\\nu_{C,5}^{\\text{prod}}=0$. The fifth column is $\\boldsymbol{n}_5 = [1-0, 0-1, 0-0]^T = [1, -1, 0]^T$.\n\nCombining these column vectors, we obtain the stoichiometric matrix $N$:\n$$\nN = \\begin{pmatrix}\n-1  1  0  0  1 \\\\\n-1  1  1  -1  -1 \\\\\n1  -1  -1  1  0\n\\end{pmatrix}\n$$\n\n(b) Justification for Splitting Reversible Reactions.\nThe representation of reaction network dynamics as $\\frac{d\\boldsymbol{x}}{dt} = N \\boldsymbol{v}(\\boldsymbol{x})$ is fundamentally based on the principle that each elementary process has a corresponding one-way flux, or rate, that is inherently non-negative. This is reflected in the structure of the rate vector $\\boldsymbol{v}(\\boldsymbol{x})$, where each component $v_j(\\boldsymbol{x})$ must be greater than or equal to zero.\n\nThe law of mass-action kinetics for an irreversible reaction $j$ is given by $v_j(\\boldsymbol{x}) = k_j \\prod_{i} x_i^{\\nu_{ij}^{\\text{reac}}}$. Since the rate constant $k_j$ and species concentrations $x_i$ are non-negative quantities, the resulting rate $v_j(\\boldsymbol{x})$ is also non-negative. Each $v_j(\\boldsymbol{x})$ represents the number of reaction events per unit time per unit volume, a quantity which cannot be negative.\n\nNow, consider a reversible reaction, for example, $A+B \\rightleftharpoons C$. This process is physically the result of two opposing elementary reactions: a forward reaction $A+B \\rightarrow C$ with rate $v^+ = k^+ x_A x_B$, and a backward reaction $C \\rightarrow A+B$ with rate $v^- = k^- x_C$. The *net rate* of conversion is $v_{net} = v^+ - v^- = k^+ x_A x_B - k^- x_C$.\n\nIf we attempted to represent this reversible reaction with a single column in the stoichiometric matrix, say $\\boldsymbol{n}_{net} = [-1, -1, 1]^T$ corresponding to the net consumption of $A$ and $B$ to produce $C$, the corresponding entry in the rate vector would have to be $v_{net}$. However, the sign of $v_{net}$ depends on the relative magnitudes of $v^+$ and $v^-$, which in turn depend on the species concentrations. The value $v_{net}$ can be positive, negative, or zero. A negative value for a component of the rate vector $\\boldsymbol{v}(\\boldsymbol{x})$ would violate the fundamental premise of the model, which interprets $v_j$ as a non-negative one-way flux. The signs, indicating the direction of species change, are meant to be encoded exclusively within the stoichiometric matrix $N$, not in the rate vector $\\boldsymbol{v}(\\boldsymbol{x})$.\n\nSplitting the reversible reaction into two irreversible steps resolves this contradiction. We define two separate reactions, $R_1^+: A+B \\rightarrow C$ and $R_1^-: C \\rightarrow A+B$. Their corresponding rates, $v_1^+(\\boldsymbol{x}) = k_1^+ x_A x_B$ and $v_1^-(\\boldsymbol{x}) = k_1^- x_C$, are both non-negative. The stoichiometric vectors are $\\boldsymbol{n}_{1} = [-1, -1, 1]^T$ and $\\boldsymbol{n}_{2} = [1, 1, -1]^T = -\\boldsymbol{n}_1$. The total contribution of this reaction pair to the system dynamics is $\\boldsymbol{n}_1 v_1^+(\\boldsymbol{x}) + \\boldsymbol{n}_2 v_1^-(\\boldsymbol{x}) = \\boldsymbol{n}_1 v_1^+(\\boldsymbol{x}) - \\boldsymbol{n}_1 v_1^-(\\boldsymbol{x}) = \\boldsymbol{n}_1(v_1^+(\\boldsymbol{x}) - v_1^-(\\boldsymbol{x})) = \\boldsymbol{n}_1 v_{net}(\\boldsymbol{x})$. This formulation correctly captures the net chemical change while preserving the componentwise non-negativity of the rate vector $\\boldsymbol{v}(\\boldsymbol{x}) = [v_1^+, v_1^-, \\dots]^T$. This ensures that the mathematical framework is consistent with the physical interpretation of reaction rates as non-negative fluxes.\n\n(c) Computation of the Dimension of the Right Nullspace of $N$.\nThe dimension of the right nullspace of $N$, denoted $\\dim(\\ker N)$, is also known as the nullity of $N$. According to the rank-nullity theorem, for a matrix with $m$ columns, its rank and nullity sum to $m$: $\\text{rank}(N) + \\dim(\\ker N) = m$.\nIn our case, the matrix $N$ has $m=5$ columns. Thus, $\\dim(\\ker N) = 5 - \\text{rank}(N)$. To find $\\dim(\\ker N)$, we must first compute the rank of $N$. We can do this by reducing $N$ to its row echelon form using Gaussian elimination.\n\nThe matrix is:\n$$\nN = \\begin{pmatrix}\n-1  1  0  0  1 \\\\\n-1  1  1  -1  -1 \\\\\n1  -1  -1  1  0\n\\end{pmatrix}\n$$\nLet the rows be $R_1$, $R_2$, and $R_3$.\nStep 1: Perform the operation $R_2 \\leftarrow R_2 - R_1$.\n$$\n\\begin{pmatrix}\n-1  1  0  0  1 \\\\\n0  0  1  -1  -2 \\\\\n1  -1  -1  1  0\n\\end{pmatrix}\n$$\nStep 2: Perform the operation $R_3 \\leftarrow R_3 + R_1$.\n$$\n\\begin{pmatrix}\n-1  1  0  0  1 \\\\\n0  0  1  -1  -2 \\\\\n0  0  -1  1  1\n\\end{pmatrix}\n$$\nStep 3: Perform the operation $R_3 \\leftarrow R_3 + R_2$.\n$$\n\\begin{pmatrix}\n-1  1  0  0  1 \\\\\n0  0  1  -1  -2 \\\\\n0  0  0  0  -1\n\\end{pmatrix}\n$$\nThe matrix is now in row echelon form. We can identify the number of non-zero rows, which is equal to the rank of the matrix. There are $3$ non-zero rows. Therefore, $\\text{rank}(N) = 3$.\n\nUsing the rank-nullity theorem, we find the dimension of the kernel:\n$$\n\\dim(\\ker N) = 5 - \\text{rank}(N) = 5 - 3 = 2\n$$\nThe dimension of the right nullspace of the stoichiometric matrix $N$ is $2$. These nullspace vectors correspond to steady-state flux vectors $\\boldsymbol{v}_{ss}$ for which $N\\boldsymbol{v}_{ss} = \\boldsymbol{0}$, meaning the net production of all species is zero. The two basis vectors of this nullspace correspond to the two reversible reaction pairs, $R_1$ and $R_2$, operating at a net zero flux (i.e., forward rate equals backward rate).", "answer": "$$\n\\boxed{2}\n$$", "id": "2679078"}, {"introduction": "Real chemical systems often involve species like catalysts that participate in reactions without being consumed overall. Representing these species correctly is crucial for an accurate model. This practice ([@problem_id:2679095]) explores how to incorporate catalysts into the stoichiometric matrix, contrasting a high-level (coarse-grained) view with a detailed mechanistic one, thereby clarifying that stoichiometry captures net change, which is zero for a catalyst in an overall reaction cycle.", "problem": "Consider a Chemical Reaction Network (CRN) in which a single catalyst species $E$ accelerates two transformations without being consumed: a substrate $S_1$ to a product $P_1$, and another substrate $S_2$ to the same product $P_1$. You are asked to represent the catalysis in the stoichiometric matrix and to justify, from first principles, why including the catalyst does not alter certain rows of the stoichiometric matrix.\n\nFundamental base:\n- By definition, the stoichiometric matrix $N$ has entries $N_{ij} = \\nu_{ij}^{\\text{prod}} - \\nu_{ij}^{\\text{reac}}$, where $\\nu_{ij}^{\\text{prod}}$ and $\\nu_{ij}^{\\text{reac}}$ are the stoichiometric coefficients of species $i$ as product and reactant, respectively, in reaction $j$.\n- A catalyst is a species that appears with equal total stoichiometric coefficient on the reactant and product sides of each overall reaction it catalyzes, so that its net change over that overall reaction is zero.\n\nConsider the following two alternative descriptions of the same catalytic chemistry:\n- Coarse-grained (overall) reactions:\n  - $R_1$: $S_1 + E \\to P_1 + E$\n  - $R_2$: $S_2 + E \\to 2\\,P_1 + E$\n- One possible elementary mechanistic expansion introducing enzyme–substrate complexes $C_1$ and $C_2$:\n  - $R_{1a}$: $E + S_1 \\to C_1$\n  - $R_{1b}$: $C_1 \\to E + P_1$\n  - $R_{2a}$: $E + S_2 \\to C_2$\n  - $R_{2b}$: $C_2 \\to E + 2\\,P_1$\n\nUse the species ordering $[S_1,\\; S_2,\\; P_1,\\; E]$ for the coarse-grained description and $[S_1,\\; S_2,\\; P_1,\\; E,\\; C_1,\\; C_2]$ for the mechanistic description, with reaction order $[R_1,\\; R_2]$ and $[R_{1a},\\; R_{1b},\\; R_{2a},\\; R_{2b}]$, respectively.\n\nQuestion: Which option correctly gives both the coarse-grained stoichiometric matrix $N_{\\mathrm{cg}}$ and the mechanistic stoichiometric matrix $N_{\\mathrm{mech}}$, and provides a correct justification for why including the catalyst does not alter the rows of $N_{\\mathrm{cg}}$ corresponding to $\\{S_1,\\; S_2,\\; P_1\\}$?\n\nA. \n- $N_{\\mathrm{cg}} = \\begin{bmatrix}\n-1  0\\\\\n0  -1\\\\\n1  2\\\\\n0  0\n\\end{bmatrix}$.\n- $N_{\\mathrm{mech}} = \\begin{bmatrix}\n-1  0  0  0\\\\\n0  0  -1  0\\\\\n0  1  0  2\\\\\n-1  1  -1  1\\\\\n1  -1  0  0\\\\\n0  0  1  -1\n\\end{bmatrix}$.\n- Justification: In each overall reaction the catalyst appears with equal stoichiometric coefficients on both sides, so its net stoichiometry is $0$ and the catalyst row in $N_{\\mathrm{cg}}$ is identically $0$. In the mechanistic expansion, the catalyst entries cancel across the paired elementary steps ($R_{1a}$ with $R_{1b}$, $R_{2a}$ with $R_{2b}$), so projecting back to $\\{S_1,S_2,P_1\\}$ yields the same rows as in the noncatalytic description.\n\nB.\n- $N_{\\mathrm{cg}} = \\begin{bmatrix}\n-1  0\\\\\n0  -1\\\\\n1  2\\\\\n-1  -1\n\\end{bmatrix}$.\n- $N_{\\mathrm{mech}} = \\begin{bmatrix}\n-1  0  0  0\\\\\n0  0  -1  0\\\\\n0  1  0  2\\\\\n-1  0  -1  0\\\\\n1  -1  0  0\\\\\n0  0  1  -1\n\\end{bmatrix}$.\n- Justification: Because the catalyst binds substrates, it must be consumed in the coarse-grained reactions and replenished dynamically; therefore its coarse-grained row is negative in all catalyzed reactions.\n\nC.\n- $N_{\\mathrm{cg}} = \\begin{bmatrix}\n-1  0\\\\\n0  -1\\\\\n2  4\\\\\n0  0\n\\end{bmatrix}$.\n- $N_{\\mathrm{mech}} = \\begin{bmatrix}\n-1  0  0  0\\\\\n0  0  -1  0\\\\\n0  2  0  4\\\\\n-1  1  -1  1\\\\\n1  -1  0  0\\\\\n0  0  1  -1\n\\end{bmatrix}$.\n- Justification: Catalytic turnover multiplies product formation by an effective factor, so the product stoichiometry in both coarse-grained and mechanistic matrices must be scaled accordingly.\n\nD.\n- $N_{\\mathrm{cg}} = \\begin{bmatrix}\n-1  0\\\\\n0  -1\\\\\n1  2\n\\end{bmatrix}$ with species ordering $[S_1,\\; S_2,\\; P_1]$ (the catalyst is omitted).\n- $N_{\\mathrm{mech}}$ is unnecessary because catalysis is purely kinetic; instead one appends a “conservation-law row” for $E$ directly to $N$ to track $E$ without changing other rows.\n- Justification: Since catalysts affect only rates and not stoichiometry, they should not appear as species in $N$; a conservation constraint can be represented by adding a row to $N$ rather than adding $E$ explicitly as a species.", "solution": "We start from the definition of the stoichiometric matrix $N$: for species index $i$ and reaction index $j$, the entry $N_{ij}$ equals the stoichiometric coefficient of species $i$ on the product side minus that on the reactant side of reaction $j$. This definition is independent of kinetics. By definition of a catalyst, in an overall reaction the catalyst appears with equal total stoichiometric coefficients on reactant and product sides, hence has zero net stoichiometry in that overall reaction.\n\nFirst, construct the coarse-grained stoichiometric matrix $N_{\\mathrm{cg}}$ for the overall reactions $R_1: S_1 + E \\to P_1 + E$ and $R_2: S_2 + E \\to 2\\,P_1 + E$ with species ordering $[S_1,\\; S_2,\\; P_1,\\; E]$:\n- For $R_1$, the net changes are $S_1: -1$, $S_2: 0$, $P_1: +1$, $E: 0$ (because $E$ appears on both sides with coefficient $1$).\n- For $R_2$, the net changes are $S_1: 0$, $S_2: -1$, $P_1: +2$, $E: 0$ (again, $E$ appears on both sides with coefficient $1$).\n\nThus,\n$$\nN_{\\mathrm{cg}} = \n\\begin{bmatrix}\n-1  0\\\\\n0  -1\\\\\n1  2\\\\\n0  0\n\\end{bmatrix}.\n$$\nThis immediately shows that the rows corresponding to $S_1$, $S_2$, and $P_1$ are determined solely by the noncatalytic stoichiometry of the transformations, and the catalyst row is identically zero because the catalyst has zero net stoichiometry in each overall reaction.\n\nSecond, construct a mechanistic expansion with complexes $C_1$ and $C_2$ and elementary reactions $R_{1a}: E+S_1 \\to C_1$, $R_{1b}: C_1 \\to E+P_1$, $R_{2a}: E+S_2 \\to C_2$, $R_{2b}: C_2 \\to E+2P_1$. Using species ordering $[S_1,\\; S_2,\\; P_1,\\; E,\\; C_1,\\; C_2]$ and reaction ordering $[R_{1a},\\; R_{1b},\\; R_{2a},\\; R_{2b}]$, apply the definition of $N$ column by column:\n- $R_{1a}$: $E+S_1 \\to C_1$ gives net changes $S_1: -1$, $S_2: 0$, $P_1: 0$, $E: -1$, $C_1: +1$, $C_2: 0$.\n- $R_{1b}$: $C_1 \\to E+P_1$ gives net changes $S_1: 0$, $S_2: 0$, $P_1: +1$, $E: +1$, $C_1: -1$, $C_2: 0$.\n- $R_{2a}$: $E+S_2 \\to C_2$ gives net changes $S_1: 0$, $S_2: -1$, $P_1: 0$, $E: -1$, $C_1: 0$, $C_2: +1$.\n- $R_{2b}$: $C_2 \\to E+2P_1$ gives net changes $S_1: 0$, $S_2: 0$, $P_1: +2$, $E: +1$, $C_1: 0$, $C_2: -1$.\n\nThus,\n$$\nN_{\\mathrm{mech}} =\n\\begin{bmatrix}\n-1  0  0  0\\\\\n0  0  -1  0\\\\\n0  1  0  2\\\\\n-1  1  -1  1\\\\\n1  -1  0  0\\\\\n0  0  1  -1\n\\end{bmatrix}.\n$$\nFrom first principles, the justification for why catalysts do not alter certain rows of $N$ is twofold:\n- In the coarse-grained representation, the catalyst appears with equal multiplicity on both sides of each overall reaction, hence its net stoichiometry is $0$. Therefore the catalyst row in $N_{\\mathrm{cg}}$ is identically zero. The rows for the noncatalyst species $\\{S_1, S_2, P_1\\}$ are unaffected by the presence of the catalyst because their net stoichiometric changes are determined by conversion stoichiometry alone.\n- In the mechanistic representation, while the catalyst participates in individual elementary steps, summing the corresponding columns that constitute one overall catalyzed transformation yields zero net change for $E$ (e.g., $(-1) + (+1) = 0$ across $R_{1a}$ and $R_{1b}$). When projecting $N_{\\mathrm{mech}}$ back onto the original species subspace $\\{S_1,S_2,P_1\\}$ and aggregating the elementary steps into overall reactions, one recovers $N_{\\mathrm{cg}}$ for these species. Hence, adding the catalyst and its complexes does not alter the rows for $\\{S_1, S_2, P_1\\}$ in the coarse-grained stoichiometric matrix.\n\nOption-by-option analysis:\n- Option A: The given $N_{\\mathrm{cg}}$ matches the coarse-grained net changes computed above. The given $N_{\\mathrm{mech}}$ matches the mechanistic net changes derived from the definition of $N$. The justification correctly invokes the catalyst’s zero net stoichiometry in overall reactions and explains cancellation across paired elementary steps; it correctly states that the rows for $\\{S_1,S_2,P_1\\}$ are unchanged by inclusion of $E$ in $N_{\\mathrm{cg}}$. Verdict — Correct.\n- Option B: In $N_{\\mathrm{cg}}$, the catalyst row is $[-1,\\,-1]$, which contradicts the catalyst definition (equal appearance on both sides implies zero net stoichiometry). The proposed $N_{\\mathrm{mech}}$ also incorrectly omits the $+1$ entries for $E$ in $R_{1b}$ and $R_{2b}$, violating mass balance for $E$. The justification incorrectly asserts consumption of the catalyst in the coarse-grained reactions. Verdict — Incorrect.\n- Option C: The $P_1$ row in $N_{\\mathrm{cg}}$ is $[2,\\;4]$, which incorrectly scales product stoichiometry beyond what is specified by the reactions; stoichiometry cannot be altered by catalytic turnover, which affects rates, not net amounts per reaction event. The mechanistic matrix likewise misstates product stoichiometry in $R_{1b}$ and $R_{2b}$ by an arbitrary scaling. Verdict — Incorrect.\n- Option D: While one may choose to omit $E$ from the species list in a coarse-grained model, it is incorrect to claim that an “added conservation-law row” can be appended to $N$ to represent $E$. Conservation relations belong to the left nullspace of $N$; they are not additional rows of the stoichiometric matrix. Moreover, the prompt requests incorporation of the catalyst into $N$, which this option avoids, and it incorrectly conflates kinetic irrelevance with stoichiometric omission in the matrix representation. Verdict — Incorrect.", "answer": "$$\\boxed{A}$$", "id": "2679095"}, {"introduction": "The stoichiometric matrix is more than just a list of coefficients; its algebraic properties reveal deep insights into the network's dynamics, independent of specific rate laws. A key application is the identification of conservation laws, which correspond to vectors in the left nullspace of $N$. This exercise ([@problem_id:2679141]) demonstrates a direct and powerful method to test if an asserted quantity is conserved and provides a means to certify the violation of conservation if it is not.", "problem": "Consider a closed reaction network with $m$ chemical species and $r$ reactions, with concentration vector $x(t) \\in \\mathbb{R}_{\\ge 0}^{m}$ governed by an ordinary differential equation (ODE) of the form $\\frac{dx}{dt} = N \\, v(x)$, where $N \\in \\mathbb{R}^{m \\times r}$ is the stoichiometric matrix and $v(x) \\in \\mathbb{R}_{\\ge 0}^{r}$ is the vector of reaction rates consistent with the network. A linear conserved total is an asserted invariant of the form $y^{\\top} x(t)$ for a fixed coefficient vector $y \\in \\mathbb{R}^{m}$.\n\nStarting from first principles, explain how to test whether a given asserted conserved total $y^{\\top} x$ is implied by the stoichiometric matrix $N$ (meaning that it is invariant for all permissible reaction rate functions consistent with $N$). If the asserted conserved total is not implied by $N$, provide a certificate demonstrating its failure.\n\nConcretely, analyze the network with $m=4$ species and $r=5$ reactions having stoichiometric matrix\n$$\nN \\;=\\;\n\\begin{pmatrix}\n-1  1  0  0  -2 \\\\\n-2  1  1  -1  0 \\\\\n1  -1  0  0  0 \\\\\n0  0  -1  1  1\n\\end{pmatrix},\n$$\nwhose columns are the stoichiometric change vectors $n_{1},\\dots,n_{5}$, and the asserted conserved total with coefficient vector\n$$\ny \\;=\\; \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\nIf the asserted conserved total is not implied by $N$, use the following notion of certificate: choose the smallest reaction index $j^{\\star} \\in \\{1,2,3,4,5\\}$ such that $y^{\\top} n_{j^{\\star}} \\neq 0$ and report the scalar $y^{\\top} n_{j^{\\star}}$.\n\nExpress the final answer as an exact integer equal to $y^{\\top} n_{j^{\\star}}$.", "solution": "The problem asks for a validation of an asserted conserved total in a chemical reaction network, grounded in the properties of the stoichiometric matrix. This is a fundamental exercise in chemical kinetics and systems theory. We will first establish the general principle and then apply it to the specific case provided.\n\nA quantity is conserved if and only if its rate of change over time is identically zero. The asserted conserved total is the linear combination of concentrations $C(t) = y^{\\top}x(t)$, where $y \\in \\mathbb{R}^{m}$ is a fixed vector of coefficients and $x(t) \\in \\mathbb{R}_{\\ge 0}^{m}$ is the time-varying vector of species concentrations.\n\nThe time evolution of the concentration vector is given by the ordinary differential equation $\\frac{dx}{dt} = N v(x)$, where $N \\in \\mathbb{R}^{m \\times r}$ is the stoichiometric matrix and $v(x) \\in \\mathbb{R}_{\\ge 0}^{r}$ is the vector of reaction rates.\n\nTo test for conservation, we differentiate $C(t)$ with respect to time $t$:\n$$\n\\frac{dC(t)}{dt} = \\frac{d}{dt} \\left( y^{\\top} x(t) \\right)\n$$\nSince $y$ is a constant vector, we can apply the product rule for differentiation of vector quantities:\n$$\n\\frac{dC(t)}{dt} = y^{\\top} \\frac{dx(t)}{dt}\n$$\nNow, we substitute the governing differential equation for the reaction network:\n$$\n\\frac{dC(t)}{dt} = y^{\\top} \\left( N v(x) \\right) = \\left( y^{\\top} N \\right) v(x)\n$$\nThe problem demands that the conserved total be \"implied by the stoichiometric matrix $N$\". This means the conservation must hold for *all* permissible, non-negative reaction rate functions $v(x)$. The expression $(y^{\\top} N) v(x)$ is a scalar product between the row vector $y^{\\top} N$ and the column vector $v(x)$. For this product to be zero for any arbitrary vector $v(x)$ with non-negative components, it is a necessary and sufficient condition that the constant vector multiplying it must be the zero vector.\n\nTherefore, the condition for $y^{\\top} x$ to be a conserved total is:\n$$\ny^{\\top} N = \\mathbf{0}^{\\top}\n$$\nwhere $\\mathbf{0}^{\\top}$ is the zero row vector of dimension $r$. In the language of linear algebra, this means the vector $y$ must lie in the left null space of the matrix $N$, i.e., $y \\in \\ker(N^{\\top})$.\n\nIf $y^{\\top} N \\neq \\mathbf{0}^{\\top}$, then the asserted total is not conserved for all possible kinetics. There must be at least one reaction $j$ such that the $j$-th component of the row vector $y^{\\top}N$ is non-zero. This component is calculated as $y^{\\top}n_j$, where $n_j$ is the $j$-th column of $N$. A non-zero value $y^{\\top}n_j \\neq 0$ serves as a \"certificate of failure,\" because if we imagine a scenario where only reaction $j$ proceeds (i.e., $v_j(x) > 0$ and $v_k(x) = 0$ for all $k \\neq j$), the rate of change of the asserted total would be $\\frac{dC}{dt} = (y^{\\top} n_j) v_j(x) \\neq 0$.\n\nWe now apply this formal test to the given problem. We are provided with:\n$$\nN \\;=\\;\n\\begin{pmatrix}\n-1  1  0  0  -2 \\\\\n-2  1  1  -1  0 \\\\\n1  -1  0  0  0 \\\\\n0  0  -1  1  1\n\\end{pmatrix}\n\\quad \\text{and} \\quad\ny \\;=\\; \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\nWe must compute the product $y^{\\top}N$ and check if it equals the zero vector. The transpose of $y$ is $y^{\\top} = \\begin{pmatrix} 1  2  0  1 \\end{pmatrix}$.\n\nThe columns of $N$ are denoted $n_1, n_2, n_3, n_4, n_5$. We are instructed to find the smallest reaction index $j^{\\star} \\in \\{1,2,3,4,5\\}$ such that $y^{\\top} n_{j^{\\star}} \\neq 0$ and report this non-zero value. We proceed sequentially.\n\nFor $j=1$:\nThe stoichiometric vector for the first reaction is $n_1 = \\begin{pmatrix} -1  -2  1  0 \\end{pmatrix}^{\\top}$. We compute the inner product:\n$$\ny^{\\top} n_1 = \\begin{pmatrix} 1  2  0  1 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ -2 \\\\ 1 \\\\ 0 \\end{pmatrix} = (1)(-1) + (2)(-2) + (0)(1) + (1)(0) = -1 - 4 + 0 + 0 = -5\n$$\nThe result is $-5$, which is not equal to $0$. Thus, the condition for conservation is violated. The asserted conserved total is not an invariant of the system.\n\nAccording to the problem's definition for the certificate of failure, we have found the smallest index $j^{\\star}=1$ where the condition fails. The value to be reported is $y^{\\top} n_{j^{\\star}}$. For $j^{\\star}=1$, this value is $-5$.", "answer": "$$\\boxed{-5}$$", "id": "2679141"}]}