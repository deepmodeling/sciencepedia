{"hands_on_practices": [{"introduction": "A strange attractor is geometrically complex, but its formation relies on a simple, repeated action: stretching and folding. To understand this mechanism, we can zoom in on a single point on the attractor and analyze the local dynamics. This exercise provides fundamental practice in connecting the mathematical properties of a system's Jacobian matrix to the physical behavior of local expansion and contraction that underpins all chaotic motion. By analyzing an autocatalytic reaction in a CSTR, you will see how these competing effects can coexist, leading to the intricate dynamics of a strange attractor. [@problem_id:2679701]", "problem": "A well-mixed Continuous Stirred Tank Reactor (CSTR) processes an isothermal, incompressible liquid phase containing three chemical species $X$, $Y$, and $Z$ under constant volumetric flow. The reaction network is given by the autocatalytic conversion $X + Y \\rightarrow 2Y$ with mass-action rate $r_{1} = k_{1} x y$ and the subsequent decay $Y \\rightarrow Z$ with rate $r_{2} = k_{2} y$, where $x$, $y$, and $z$ denote the molar concentrations of $X$, $Y$, and $Z$, respectively. The feed contains only $X$ at concentration $x_{f}$, while $y_{f} = 0$ and $z_{f} = 0$. The dilution rate is $D$. Under the usual assumptions for a CSTR (perfect mixing, constant volume, constant density), the component balances follow from accumulation equals inflow minus outflow plus net production/consumption due to reaction, and the reaction rates follow mass-action kinetics.\n\nAt the operating parameters $D = 1.2\\,\\mathrm{s}^{-1}$, $k_{1} = 8.0\\,\\mathrm{L}\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1}$, $k_{2} = 0.9\\,\\mathrm{s}^{-1}$, and $x_{f} = 1.5\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}$, numerical simulation of the reactor dynamics indicates a putative strange attractor in the three-dimensional state space $(x,y,z)$. Consider the instantaneous state $x^{\\star} = 0.60\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}$, $y^{\\star} = 0.050\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}$, $z^{\\star} = 0.10\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}$ lying on this putative attractor.\n\nStarting from the balance laws and mass-action kinetics as the fundamental base, perform the following:\n\n1) Derive the dynamical system $\\dot{x} = f_{1}(x,y,z)$, $\\dot{y} = f_{2}(x,y,z)$, $\\dot{z} = f_{3}(x,y,z)$ for this CSTR.\n\n2) Compute the Jacobian matrix $\\mathbf{J}(x,y,z)$ of the vector field at a general point $(x,y,z)$, where the entries are $J_{ij} = \\partial f_{i}/\\partial \\xi_{j}$ with $(\\xi_{1},\\xi_{2},\\xi_{3}) = (x,y,z)$.\n\n3) Evaluate $\\mathbf{J}$ at $(x^{\\star},y^{\\star},z^{\\star})$ with the given parameters. Using only the signs and magnitudes of the trace and determinant of the appropriate subblocks, infer the signs of the eigenvalues and explain what these signs imply about local stretching and contraction of infinitesimal perturbations, and about phase-space volume change at this state, in relation to sensitivity to initial conditions on a strange attractor.\n\n4) Finally, compute the instantaneous rate of change of an infinitesimal phase-space volume element at $(x^{\\star},y^{\\star},z^{\\star})$, which is equal to the trace of the Jacobian at that point. Express your final numerical answer in $\\mathrm{s}^{-1}$ and round your answer to four significant figures.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on established principles of chemical reaction engineering and dynamical systems theory. All necessary data are provided, and the problem is internally consistent and formalizable. Therefore, a solution will be provided.\n\nThe fundamental principle governing the dynamics of a Continuous Stirred Tank Reactor (CSTR) is the component mass balance, which states that the rate of accumulation of a species within the reactor volume is equal to the rate of inflow minus the rate of outflow plus the net rate of formation by chemical reaction. For a generic species $i$ with concentration $C_i$ in a system with constant volume and volumetric flow rate, this is expressed as:\n$$\n\\frac{dC_i}{dt} = D(C_{i,f} - C_i) + \\mathcal{R}_i\n$$\nHere, $D$ is the dilution rate (volumetric flow rate divided by reactor volume), $C_{i,f}$ is the feed concentration of species $i$, and $\\mathcal{R}_i$ is the net rate of production of species $i$ per unit volume.\n\n1) Derivation of the dynamical system.\n\nWe apply the general balance equation to the three species $X$, $Y$, and $Z$, with concentrations $x$, $y$, and $z$. The feed concentrations are given as $x_f$, $y_f=0$, and $z_f=0$. The reactions are $X + Y \\rightarrow 2Y$ with rate $r_1 = k_1 x y$, and $Y \\rightarrow Z$ with rate $r_2 = k_2 y$.\n\nFor species $X$:\nThe net rate of production is $\\mathcal{R}_x = -r_1 = -k_1 x y$. The mass balance is:\n$$\n\\dot{x} = \\frac{dx}{dt} = D(x_f - x) - k_1 x y\n$$\n\nFor species $Y$:\nIn the first reaction, one mole of $Y$ is consumed and two are produced, for a net production of one mole of $Y$. The rate is $+r_1 = k_1 x y$. In the second reaction, one mole of $Y$ is consumed, with rate $-r_2 = -k_2 y$. The net rate of production is $\\mathcal{R}_y = r_1 - r_2 = k_1 x y - k_2 y$. The mass balance is:\n$$\n\\dot{y} = \\frac{dy}{dt} = D(0 - y) + k_1 x y - k_2 y = (k_1 x - k_2 - D)y\n$$\n\nFor species $Z$:\nSpecies $Z$ is produced only in the second reaction. The net rate of production is $\\mathcal{R}_z = +r_2 = k_2 y$. The mass balance is:\n$$\n\\dot{z} = \\frac{dz}{dt} = D(0 - z) + k_2 y = k_2 y - D z\n$$\n\nThe complete dynamical system is therefore:\n$$\n\\dot{x} = f_1(x,y,z) = D(x_f - x) - k_1 x y\n$$\n$$\n\\dot{y} = f_2(x,y,z) = (k_1 x - k_2 - D)y\n$$\n$$\n\\dot{z} = f_3(x,y,z) = k_2 y - D z\n$$\n\n2) Computation of the Jacobian matrix.\n\nThe Jacobian matrix $\\mathbf{J}$ of the vector field $\\mathbf{f} = (f_1, f_2, f_3)^T$ is given by $J_{ij} = \\partial f_i / \\partial \\xi_j$ where $(\\xi_1, \\xi_2, \\xi_3) = (x, y, z)$.\n\nThe partial derivatives are:\n$$\nJ_{11} = \\frac{\\partial f_1}{\\partial x} = -D - k_1 y\n$$\n$$\nJ_{12} = \\frac{\\partial f_1}{\\partial y} = -k_1 x\n$$\n$$\nJ_{13} = \\frac{\\partial f_1}{\\partial z} = 0\n$$\n$$\nJ_{21} = \\frac{\\partial f_2}{\\partial x} = k_1 y\n$$\n$$\nJ_{22} = \\frac{\\partial f_2}{\\partial y} = k_1 x - k_2 - D\n$$\n$$\nJ_{23} = \\frac{\\partial f_2}{\\partial z} = 0\n$$\n$$\nJ_{31} = \\frac{\\partial f_3}{\\partial x} = 0\n$$\n$$\nJ_{32} = \\frac{\\partial f_3}{\\partial y} = k_2\n$$\n$$\nJ_{33} = \\frac{\\partial f_3}{\\partial z} = -D\n$$\n\nAssembling these components yields the Jacobian matrix:\n$$\n\\mathbf{J}(x,y,z) = \\begin{pmatrix} -D - k_1 y & -k_1 x & 0 \\\\ k_1 y & k_1 x - k_2 - D & 0 \\\\ 0 & k_2 & -D \\end{pmatrix}\n$$\n\n3) Evaluation and analysis of the Jacobian at the specific point.\n\nWe evaluate $\\mathbf{J}$ at the state $(x^\\star, y^\\star, z^\\star) = (0.60, 0.050, 0.10)\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}$ with parameters $D = 1.2\\,\\mathrm{s}^{-1}$, $k_1 = 8.0\\,\\mathrm{L}\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1}$, and $k_2 = 0.9\\,\\mathrm{s}^{-1}$.\n\n$$\nJ_{11}^\\star = -1.2 - (8.0)(0.050) = -1.2 - 0.4 = -1.6\n$$\n$$\nJ_{12}^\\star = -(8.0)(0.60) = -4.8\n$$\n$$\nJ_{21}^\\star = (8.0)(0.050) = 0.4\n$$\n$$\nJ_{22}^\\star = (8.0)(0.60) - 0.9 - 1.2 = 4.8 - 2.1 = 2.7\n$$\n$$\nJ_{32}^\\star = 0.9\n$$\n$$\nJ_{33}^\\star = -1.2\n$$\n\nThe evaluated Jacobian matrix $\\mathbf{J}^\\star$ is:\n$$\n\\mathbf{J}^\\star = \\begin{pmatrix} -1.6 & -4.8 & 0 \\\\ 0.4 & 2.7 & 0 \\\\ 0 & 0.9 & -1.2 \\end{pmatrix}\n$$\n\nThis matrix is block lower triangular. The eigenvalues of $\\mathbf{J}^\\star$ are the eigenvalues of the upper-left $2 \\times 2$ subblock, which we denote $\\mathbf{A}$, and the single element $J_{33}^\\star$.\nOne eigenvalue is immediately $\\lambda_3 = J_{33}^\\star = -1.2$. This is a real, negative eigenvalue, implying strong contraction in the direction of its corresponding eigenvector. Since the dynamics of $x$ and $y$ are independent of $z$ (as seen by the zeros in the upper right of $\\mathbf{J}$), the $z$-direction is decoupled from the $(x,y)$-subspace dynamics. Trajectories are exponentially attracted towards the $z=0$ plane if we consider perturbations from it, but here it describes how perturbations in $z$ decay while the system evolves in $x$ and $y$. Specifically, the dynamics of $z$ are slave to the dynamics of $y$, and the term $-Dz$ provides a stable, contracting mode.\n\nThe remaining two eigenvalues, $\\lambda_1$ and $\\lambda_2$, are the eigenvalues of the subblock governing the dynamics in the $(x,y)$-plane:\n$$\n\\mathbf{A} = \\begin{pmatrix} -1.6 & -4.8 \\\\ 0.4 & 2.7 \\end{pmatrix}\n$$\nWe analyze these eigenvalues using the trace and determinant of $\\mathbf{A}$:\n$$\n\\mathrm{tr}(\\mathbf{A}) = \\lambda_1 + \\lambda_2 = -1.6 + 2.7 = 1.1\n$$\n$$\n\\det(\\mathbf{A}) = \\lambda_1 \\lambda_2 = (-1.6)(2.7) - (-4.8)(0.4) = -4.32 + 1.92 = -2.4\n$$\nThe discriminant of the characteristic polynomial is $\\Delta = (\\mathrm{tr}(\\mathbf{A}))^2 - 4\\det(\\mathbf{A}) = (1.1)^2 - 4(-2.4) = 1.21 + 9.6 = 10.81 > 0$. Since $\\Delta > 0$, the eigenvalues $\\lambda_1$ and $\\lambda_2$ are real and distinct.\nSince their product, $\\det(\\mathbf{A})$, is negative ($-2.4$), one eigenvalue must be positive and the other must be negative. Thus, the point $(x^\\star, y^\\star)$ is a saddle point within the $(x,y)$-subspace.\nLet $\\lambda_1 > 0$ and $\\lambda_2 < 0$. We have $\\lambda_1 + \\lambda_2 = 1.1 > 0$, confirming that the magnitude of the positive eigenvalue is greater than that of the negative one.\n\nIn summary, the eigenvalues of $\\mathbf{J}^\\star$ have the signs: one positive ($\\lambda_1 > 0$), two negative ($\\lambda_2 < 0, \\lambda_3 < 0$).\n\nImplications for the dynamics:\n- **Stretching**: The positive eigenvalue $\\lambda_1 > 0$ indicates that an infinitesimal perturbation in the direction of the corresponding eigenvector will grow exponentially at a rate $\\exp(\\lambda_1 t)$. This local instability and rapid divergence of nearby trajectories is the defining characteristic of sensitivity to initial conditions, a necessary ingredient for chaotic dynamics.\n- **Contraction**: The two negative eigenvalues $\\lambda_2 < 0$ and $\\lambda_3 < 0$ indicate contraction along two other directions in phase space. Perturbations along these directions decay exponentially.\n- **Phase-space Volume**: For a strange attractor to exist, the system must be dissipative, meaning that volumes in phase space must contract on average. The instantaneous rate of volume change is given by the trace of the Jacobian. The sum of the eigenvalues is $\\lambda_1 + \\lambda_2 + \\lambda_3 = \\mathrm{tr}(\\mathbf{A}) + \\lambda_3 = 1.1 + (-1.2) = -0.1$. Since the sum is negative, there is local volume contraction at this point. This combination of stretching in one direction while the overall volume contracts is the fundamental mechanism for creating the fractal structure of a strange attractor. Trajectories are stretched apart and then folded back onto the attractor, which occupies a set of zero volume in the three-dimensional phase space.\n\n4) Computation of the instantaneous rate of change of phase-space volume.\n\nThe local rate of change of an infinitesimal phase-space volume element is given by the divergence of the vector field, which is equal to the trace of the Jacobian matrix, $\\mathrm{tr}(\\mathbf{J})$. This quantity is also the sum of the eigenvalues.\n$$\n\\frac{1}{V}\\frac{dV}{dt} = \\nabla \\cdot \\mathbf{f} = \\mathrm{tr}(\\mathbf{J})\n$$\nUsing the evaluated Jacobian $\\mathbf{J}^\\star$:\n$$\n\\mathrm{tr}(\\mathbf{J}^\\star) = J_{11}^\\star + J_{22}^\\star + J_{33}^\\star = -1.6 + 2.7 + (-1.2) = 1.1 - 1.2 = -0.1\n$$\nThe units of the trace are the units of the diagonal elements, which are $\\mathrm{s}^{-1}$. The problem asks for the answer rounded to four significant figures.\n\nThe value is $-0.1000\\,\\mathrm{s}^{-1}$. This negative value confirms that at the point $(x^\\star, y^\\star, z^\\star)$, any infinitesimal volume of initial conditions is contracting, which is consistent with the state belonging to an attractor.", "answer": "$$\n\\boxed{-0.1000}\n$$", "id": "2679701"}, {"introduction": "The most famous characteristic of chaos is the \"butterfly effect,\" or sensitivity to initial conditions. The maximum Lyapunov exponent, $\\lambda_{\\max}$, provides a precise quantitative measure of this phenomenon, representing the average rate of exponential separation of nearby trajectories. This exercise moves from the abstract definition of $\\lambda_{\\max}$ to a critical, practical application: determining the time horizon over which a system's behavior can be meaningfully predicted. You will calculate the finite \"predictability time\" for a chaotic chemical reactor, gaining a concrete appreciation for how chaos imposes fundamental limits on forecasting and control. [@problem_id:2679760]", "problem": "A well-stirred autocatalytic reaction network operated in a Continuous Stirred-Tank Reactor (CSTR) is known to exhibit a strange attractor in its concentration dynamics for species $X$, indicative of sensitivity to initial conditions. The separation between two nearby concentration trajectories in state space, $|\\delta \\mathbf{z}(t)|$, for sufficiently small initial separations $|\\delta \\mathbf{z}(0)|$, follows the linearized dynamics near the attractor and grows approximately exponentially in time with a rate set by the maximum Lyapunov exponent. The maximum Lyapunov exponent $\\lambda_{\\max}$ is defined as the asymptotic exponential growth rate of infinitesimal perturbations,\n$$\n\\lambda_{\\max} = \\lim_{t \\to \\infty} \\frac{1}{t} \\ln \\frac{|\\delta \\mathbf{z}(t)|}{|\\delta \\mathbf{z}(0)|}.\n$$\nYou measure the initial uncertainty in the concentration of $X$ at time $t=0$ to be $\\epsilon_0 = 2.0 \\times 10^{-6} \\ \\mathrm{mol}\\,\\mathrm{L}^{-1}$, and you require that forecasts remain useful only while the forecasted concentration remains within a tolerance $\\Delta = 1.0 \\times 10^{-4} \\ \\mathrm{mol}\\,\\mathrm{L}^{-1}$ of the true trajectory. An independent analysis of the time series on the attractor yields a maximum Lyapunov exponent $\\lambda_{\\max} = 0.12 \\ \\mathrm{s}^{-1}$.\n\nStarting from the above definition of $\\lambda_{\\max}$ and the exponential growth of small perturbations implied by the linearized dynamics near the attractor, derive an expression for the predictability time $t_p$ at which the forecast error first reaches the tolerance $\\Delta$. Then evaluate $t_p$ numerically for the given values. Express your final result in seconds and round to three significant figures.", "solution": "The problem statement is critically validated. All givens are extracted verbatim as follows:\n- System: A well-stirred autocatalytic reaction network in a Continuous Stirred-Tank Reactor (CSTR).\n- Dynamic behavior: Exhibits a strange attractor in its concentration dynamics for species $X$, indicative of sensitivity to initial conditions.\n- Separation growth: The separation between two nearby concentration trajectories, $|\\delta \\mathbf{z}(t)|$, grows approximately exponentially for small $|\\delta \\mathbf{z}(0)|$.\n- Definition of maximum Lyapunov exponent: $\\lambda_{\\max} = \\lim_{t \\to \\infty} \\frac{1}{t} \\ln \\frac{|\\delta \\mathbf{z}(t)|}{|\\delta \\mathbf{z}(0)|}$.\n- Initial uncertainty: $\\epsilon_0 = 2.0 \\times 10^{-6} \\ \\mathrm{mol}\\,\\mathrm{L}^{-1}$ at time $t=0$.\n- Forecast tolerance: $\\Delta = 1.0 \\times 10^{-4} \\ \\mathrm{mol}\\,\\mathrm{L}^{-1}$.\n- Value of maximum Lyapunov exponent: $\\lambda_{\\max} = 0.12 \\ \\mathrm{s}^{-1}$.\n- Task: Derive an expression for the predictability time $t_p$ and evaluate it numerically, rounding to three significant figures.\n\nThe problem is scientifically grounded in the established theory of chaotic dynamical systems and its application to chemical kinetics. It is well-posed, self-contained, and free of contradictions or ambiguities. The provided numerical values are physically plausible. Therefore, the problem is valid, and a solution will be provided.\n\nThe core of the problem lies in the definition of the maximum Lyapunov exponent, $\\lambda_{\\max}$. The given definition,\n$$\n\\lambda_{\\max} = \\lim_{t \\to \\infty} \\frac{1}{t} \\ln \\frac{|\\delta \\mathbf{z}(t)|}{|\\delta \\mathbf{z}(0)|}\n$$\ndescribes the asymptotic average exponential rate of divergence of infinitesimally close trajectories on the attractor. For practical purposes, and as stated in the problem, for small but finite initial separations $|\\delta \\mathbf{z}(0)|$ and for times $t$ that are not excessively long, this relationship can be approximated by removing the limit:\n$$\n\\lambda_{\\max} \\approx \\frac{1}{t} \\ln \\frac{|\\delta \\mathbf{z}(t)|}{|\\delta \\mathbf{z}(0)|}\n$$\nThis assumes that the dynamics are dominated by the most unstable direction, which is a standard procedure in analyzing predictability. Rearranging this approximation gives the law for the exponential growth of small perturbations:\n$$\n\\lambda_{\\max} t \\approx \\ln \\frac{|\\delta \\mathbf{z}(t)|}{|\\delta \\mathbf{z}(0)|}\n$$\n$$\n\\exp(\\lambda_{\\max} t) \\approx \\frac{|\\delta \\mathbf{z}(t)|}{|\\delta \\mathbf{z}(0)|}\n$$\n$$\n|\\delta \\mathbf{z}(t)| \\approx |\\delta \\mathbf{z}(0)| \\exp(\\lambda_{\\max} t)\n$$\nThis equation governs the growth of the error in our forecast. We are given the initial error, which is the uncertainty in the initial concentration. We identify this with the initial separation of trajectories:\n$$\n|\\delta \\mathbf{z}(0)| = \\epsilon_0 = 2.0 \\times 10^{-6} \\ \\mathrm{mol}\\,\\mathrm{L}^{-1}\n$$\nThe predictability is lost when this error grows to the size of the specified tolerance, $\\Delta$. The time at which this occurs is the predictability time, $t_p$. Thus, we set $|\\delta \\mathbf{z}(t_p)| = \\Delta$:\n$$\n\\Delta = 1.0 \\times 10^{-4} \\ \\mathrm{mol}\\,\\mathrm{L}^{-1}\n$$\nSubstituting these quantities into the exponential growth equation at time $t = t_p$, we have:\n$$\n\\Delta \\approx \\epsilon_0 \\exp(\\lambda_{\\max} t_p)\n$$\nWe must now solve this equation for $t_p$. First, we isolate the exponential term:\n$$\n\\frac{\\Delta}{\\epsilon_0} \\approx \\exp(\\lambda_{\\max} t_p)\n$$\nTaking the natural logarithm of both sides yields:\n$$\n\\ln\\left(\\frac{\\Delta}{\\epsilon_0}\\right) \\approx \\lambda_{\\max} t_p\n$$\nFinally, solving for $t_p$, we obtain the general expression for the predictability time:\n$$\nt_p \\approx \\frac{1}{\\lambda_{\\max}} \\ln\\left(\\frac{\\Delta}{\\epsilon_0}\\right)\n$$\nThis is the required derived expression.\n\nNow we evaluate $t_p$ numerically using the provided values:\n$$\n\\lambda_{\\max} = 0.12 \\ \\mathrm{s}^{-1}\n$$\n$$\n\\Delta = 1.0 \\times 10^{-4} \\ \\mathrm{mol}\\,\\mathrm{L}^{-1}\n$$\n$$\n\\epsilon_0 = 2.0 \\times 10^{-6} \\ \\mathrm{mol}\\,\\mathrm{L}^{-1}\n$$\nFirst, we compute the ratio of the tolerance to the initial error:\n$$\n\\frac{\\Delta}{\\epsilon_0} = \\frac{1.0 \\times 10^{-4}}{2.0 \\times 10^{-6}} = \\frac{1.0}{2.0} \\times 10^{(-4 - (-6))} = 0.5 \\times 10^{2} = 50\n$$\nSubstituting this ratio and the value of $\\lambda_{\\max}$ into the expression for $t_p$:\n$$\nt_p \\approx \\frac{1}{0.12} \\ln(50) \\ \\mathrm{s}\n$$\nUsing the value $\\ln(50) \\approx 3.912023$:\n$$\nt_p \\approx \\frac{3.912023}{0.12} \\ \\mathrm{s} \\approx 32.600192 \\ \\mathrm{s}\n$$\nThe problem requires the final result to be rounded to three significant figures.\n$$\nt_p \\approx 32.6 \\ \\mathrm{s}\n$$\nThis is the time horizon over which the forecast remains useful. Beyond this time, the initial small uncertainty has grown to the point where it overwhelms the acceptable tolerance for the forecast.", "answer": "$$\n\\boxed{32.6}\n$$", "id": "2679760"}, {"introduction": "How do we validate a model in a chaotic regime? A direct comparison between a single model simulation and an experimental trajectory is often misleading, as even infinitesimal differences in initial conditions will lead to macroscopic divergence. This challenge calls for a more sophisticated approach based on the concept of \"shadowing.\" This advanced computational problem asks you to design an algorithm to determine if an entire experimental time series can be \"shadowed\" by *some* trajectory of the model, within a given measurement uncertainty. Successfully solving this requires implementing techniques that track the evolution of uncertainty itself, providing a capstone experience in the practical analysis of chaotic systems. [@problem_id:2679751]", "problem": "You are given a deterministic three-species surrogate kinetics model that captures the qualitative features of a chaotic continuous-flow, well-mixed reactor. The state is a vector of concentrations $x(t) \\in \\mathbb{R}^3$ that evolves under a smooth, autonomous ordinary differential equation $dx/dt = f(x;\\theta)$ with parameter vector $\\theta \\in \\mathbb{R}^3$. The flow map $\\varphi_t(x_0;\\theta)$ denotes the unique solution at time $t$ with initial state $x_0$. An experimental time series is a sequence of observations $\\{y_i\\}_{i=0}^{N}$ at sampling times $\\{t_i\\}_{i=0}^{N}$ with uniform step $\\Delta t > 0$, where each $y_i \\in \\mathbb{R}^3$ is a noisy measurement of the true concentration vector. A trajectory $\\varphi_t(x_0;\\theta)$ is said to be shadowed by the experimental trajectory within measurement uncertainty $\\varepsilon > 0$ if there exists an initial condition $x_0 \\in \\mathbb{R}^3$ such that for all sample times $t_i$ one has $\\|\\varphi_{t_i}(x_0;\\theta) - y_i\\|_2 \\le \\varepsilon$.\n\nUse the following phenomenological kinetics (Rössler-type surrogate) for the model:\n- State $x(t) = (x_1(t), x_2(t), x_3(t))$,\n- Parameters $\\theta = (a,b,c)$,\n- Dynamics\n$$\n\\frac{dx_1}{dt} = -x_2 - x_3,\\quad\n\\frac{dx_2}{dt} = x_1 + a\\,x_2,\\quad\n\\frac{dx_3}{dt} = b + x_3\\,(x_1 - c).\n$$\nThis system is a standard surrogate for chaotic oscillations in chemically driven reactors and is sufficiently smooth for linearization-based analysis on compact sets.\n\nYour task is to design and implement a principled numerical test for shadowing that respects sensitivity to initial conditions on chaotic attractors. Starting from core dynamical systems principles (existence and uniqueness of solutions for smooth vector fields, the flow map, and local linearization via the Jacobian and variational equation), construct an algorithm that, for each test case below, decides whether there exists an initial condition $x_0$ such that the model trajectory $\\varphi_{t_i}(x_0;\\theta_{\\text{model}})$ stays within the measurement uncertainty ball of radius $\\varepsilon$ around each observation $y_i$ for all sample indices $i \\in \\{0,\\dots,N\\}$. Your test must return a boolean for each case.\n\nImportant requirements:\n- Treat the decision as an existence problem for some $x_0$ consistent with all observations under the model parameters $\\theta_{\\text{model}}$. Any method you implement must be logically consistent with sensitivity to initial conditions and local linearization on chaotic attractors, and must not rely on stochastic sampling or randomness.\n- Angles do not appear. There are no physical unit conversions required; all quantities are dimensionless in this surrogate model.\n- The sampling times are $t_i = i\\,\\Delta t$ with $i \\in \\{0,\\dots,N\\}$.\n\nTest suite:\n- In all cases, the observation sequence $\\{y_i\\}$ is produced synthetically by integrating the same model with observation parameters $\\theta_{\\text{obs}}$ from a specified initial condition $x_0^{\\text{obs}}$ on the same sampling grid, without any added randomness.\n- For all integrations use absolute and relative tolerances sufficiently small to make numerical errors negligible compared to the smallest $\\varepsilon$ specified.\n\nProvide a single program that, for each of the following four test cases, outputs whether the observed trajectory is shadowed by some model trajectory within the stated measurement uncertainty:\n1) Happy path (exact-parameter match, moderate uncertainty):\n   - $\\theta_{\\text{model}} = (a,b,c) = (\\,0.2,\\,0.2,\\,5.7\\,)$,\n   - $\\theta_{\\text{obs}} = (\\,0.2,\\,0.2,\\,5.7\\,)$,\n   - $x_0^{\\text{obs}} = (\\,1.0,\\,0.0,\\,0.0\\,)$,\n   - $\\Delta t = 0.05$,\n   - $T = 10.0$ so that $N = T/\\Delta t$,\n   - $\\varepsilon = 0.05$.\n2) Boundary-like (exact-parameter match, tight uncertainty):\n   - $\\theta_{\\text{model}} = (\\,0.2,\\,0.2,\\,5.7\\,)$,\n   - $\\theta_{\\text{obs}} = (\\,0.2,\\,0.2,\\,5.7\\,)$,\n   - $x_0^{\\text{obs}} = (\\,1.0,\\,0.0,\\,0.0\\,)$,\n   - $\\Delta t = 0.05$,\n   - $T = 10.0$ so that $N = T/\\Delta t$,\n   - $\\varepsilon = 0.01$.\n3) Parameter mismatch but generous uncertainty and shorter horizon:\n   - $\\theta_{\\text{model}} = (\\,0.2,\\,0.2,\\,5.7\\,)$,\n   - $\\theta_{\\text{obs}} = (\\,0.2,\\,0.2,\\,5.9\\,)$,\n   - $x_0^{\\text{obs}} = (\\,1.0,\\,0.0,\\,0.0\\,)$,\n   - $\\Delta t = 0.05$,\n   - $T = 6.0$ so that $N = T/\\Delta t$,\n   - $\\varepsilon = 0.50$.\n4) Significant parameter mismatch and tight uncertainty:\n   - $\\theta_{\\text{model}} = (\\,0.2,\\,0.2,\\,5.7\\,)$,\n   - $\\theta_{\\text{obs}} = (\\,0.2,\\,0.2,\\,6.2\\,)$,\n   - $x_0^{\\text{obs}} = (\\,1.0,\\,0.0,\\,0.0\\,)$,\n   - $\\Delta t = 0.05$,\n   - $T = 12.0$ so that $N = T/\\Delta t$,\n   - $\\varepsilon = 0.05$.\n\nFinal output format:\n- Your program must compute a boolean for each test case, in order, indicating whether the observation is shadowed by the model within $\\varepsilon$ on the entire sampling grid.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $[\\,\\text{True},\\text{False},\\text{True},\\text{False}\\,]$ with no spaces after commas.\n\nYour code must be a complete, runnable program that takes no input and prints exactly one line in the specified format. The algorithmic details and numerical techniques you use are up to you, provided they are consistent with the above principles and yield logically sound decisions based on the model and data given here.", "solution": "The problem posed is to determine, for a set of test cases, whether a given experimental time series can be shadowed by a trajectory of a specified surrogate chemical kinetics model. This is a question of existence: does there exist an initial condition $x_0$ for the model such that its evolution remains within a specified uncertainty $\\varepsilon$ of the observations at all sampling times? The problem is scientifically grounded, well-posed, and contains all necessary information for a deterministic solution. It is therefore deemed valid.\n\nThe core of the problem lies in navigating the consequences of sensitivity to initial conditions, a hallmark of chaotic systems like the Rössler-type model provided. A naive search for a suitable initial condition $x_0 \\in \\mathbb{R}^3$ is computationally intractable. Instead, a principled approach based on set-based estimation and local linearization is required. The algorithm we construct will track the set of all possible initial conditions that are consistent with the observations up to a given time. If this set becomes empty at any point, we can conclude that no such shadowing trajectory exists.\n\nThe methodology is structured as follows:\n\n1.  **Set Representation**: The set of possible states of the system at any given time will be represented by an ellipsoid. An ellipsoid $E$ is defined by its center $c \\in \\mathbb{R}^3$ and a positive definite shape matrix $P \\in \\mathbb{R}^{3 \\times 3}$ as $E(c, P) = \\{x \\in \\mathbb{R}^3 \\mid (x - c)^T P^{-1} (x - c) \\le 1\\}$. At the initial time $t_0 = 0$, the only information is the first observation $y_0$. Any valid initial state $x_0$ must satisfy $\\|x_0 - y_0\\|_2 \\le \\varepsilon$. This defines the initial set of possible states as a sphere, which is an ellipsoid $E_0$ with center $c_0 = y_0$ and shape matrix $P_0 = \\varepsilon^2 I$, where $I$ is the $3 \\times 3$ identity matrix.\n\n2.  **Propagation (Prediction Step)**: Given the ellipsoid of possible states $E_{k-1}(c_{k-1}, P_{k-1})$ at time $t_{k-1}$, we must determine the set of states at time $t_k = t_{k-1} + \\Delta t$ that could have evolved from $E_{k-1}$. For a nonlinear system, the propagated set $\\varphi_{\\Delta t}(E_{k-1})$ is not an ellipsoid. We approximate it by propagating its center and shape matrix separately.\n    *   The center of the new ellipsoid is propagated using the full nonlinear dynamics: $c_{k|k-1} = \\varphi_{\\Delta t}(c_{k-1}; \\theta_{\\text{model}})$.\n    *   The shape matrix is propagated using the linearized dynamics. The evolution of a small perturbation $\\delta x$ around a trajectory is governed by the variational equation $\\frac{d}{dt}(\\delta x) = J(x(t)) \\delta x$, where $J(x(t))$ is the Jacobian of the vector field evaluated along the trajectory. The shape matrix transforms according to $P_{k|k-1} = \\Phi_k P_{k-1} \\Phi_k^T$, where $\\Phi_k = \\frac{\\partial \\varphi_{\\Delta t}}{\\partial x}|_{c_{k-1}}$ is the state transition matrix over the interval $[t_{k-1}, t_k]$.\n    To compute both $c_{k|k-1}$ and $\\Phi_k$, we integrate an augmented system of $12$ differential equations:\n    $$\n    \\frac{dx}{dt} = f(x; \\theta_{\\text{model}})\n    $$\n    $$\n    \\frac{d\\Phi}{dt} = J(x; \\theta_{\\text{model}}) \\Phi\n    $$\n    The integration is performed from $t=0$ to $t=\\Delta t$ with initial conditions $x(0) = c_{k-1}$ and $\\Phi(0) = I$. The state at $t=\\Delta t$ gives $c_{k|k-1}$ and $\\Phi_k$.\n\n3.  **Validation and Update (Correction Step)**: The propagated ellipsoid $E_{k|k-1}(c_{k|k-1}, P_{k|k-1})$ represents our prediction. The observation $y_k$ provides a new constraint: the true state at time $t_k$ must lie within the sphere $B(y_k, \\varepsilon)$, which is an ellipsoid $E_{\\text{obs}, k}(y_k, \\varepsilon^2 I)$. For a shadowing trajectory to exist, the intersection of these two sets must be non-empty: $E_{k|k-1} \\cap E_{\\text{obs}, k} \\neq \\emptyset$.\n    *   **Validation**: The necessary and sufficient condition for two ellipsoids $E_1(c_1, P_1)$ and $E_2(c_2, P_2)$ to have a non-empty intersection is given by the inequality $(c_1 - c_2)^T (P_1 + P_2)^{-1} (c_1 - c_2) \\le 1$. In our case, this translates to a validation check at each step $k$:\n    $$\n    (y_k - c_{k|k-1})^T (P_{k|k-1} + \\varepsilon^2 I)^{-1} (y_k - c_{k|k-1}) \\le 1\n    $$\n    If this inequality is violated, the set of consistent trajectories has become empty, and we conclude that shadowing is impossible. The algorithm terminates and returns `False`.\n    *   **Update**: If the validation check passes, we update our knowledge about the state. The new set of possible states is the intersection $E_{k|k-1} \\cap E_{\\text{obs}, k}$. This intersection is not, in general, an ellipsoid. We approximate it with the minimum-volume ellipsoid $E_k(c_k, P_k)$ that contains it. The parameters for this new ellipsoid are given by the measurement update equations familiar from the Kalman filter:\n    $$\n    S_k = P_{k|k-1} + \\varepsilon^2 I\n    $$\n    $$\n    K_k = P_{k|k-1} S_k^{-1}\n    $$\n    $$\n    c_k = c_{k|k-1} + K_k (y_k - c_{k|k-1})\n    $$\n    $$\n    P_k = (I - K_k) P_{k|k-1}\n    $$\n    This updated ellipsoid $E_k$ serves as the starting point for the next propagation step.\n\n4.  **Termination**: The procedure is repeated for all observations $k = 1, \\dots, N$. If the validation check passes at every step, it implies the existence of at least one model trajectory that is consistent with all observations within the given uncertainty. Therefore, the observation sequence is shadowed, and the algorithm returns `True`.\n\nThis algorithm is deterministic, relies on local linearization as stipulated, and provides a rigorous test for the existence of a shadowing trajectory by propagating and refining a set of candidate states.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the shadowing problem for the four test cases.\n    \"\"\"\n    \n    # Tolerances for numerical integration to minimize numerical error.\n    RTOL = 1e-10\n    ATOL = 1e-12\n\n    # Define the surrogate model dynamics.\n    def rossler_ode(t, x, a, b, c):\n        x1, x2, x3 = x\n        dx1_dt = -x2 - x3\n        dx2_dt = x1 + a * x2\n        dx3_dt = b + x3 * (x1 - c)\n        return np.array([dx1_dt, dx2_dt, dx3_dt])\n\n    # Define the augmented system including the state and the state transition matrix.\n    def augmented_ode(t, z, a, b, c):\n        x = z[0:3]\n        phi_flat = z[3:12]\n        phi = phi_flat.reshape((3, 3))\n\n        # State dynamics\n        x_dot = rossler_ode(t, x, a, b, c)\n\n        # Jacobian matrix\n        J = np.array([\n            [0.0, -1.0, -1.0],\n            [1.0, a, 0.0],\n            [x[2], 0.0, x[0] - c]\n        ])\n\n        # Variational equation for the state transition matrix\n        phi_dot = J @ phi\n\n        return np.concatenate([x_dot, phi_dot.flatten()])\n\n    test_cases = [\n        # 1) Happy path\n        {'theta_model': (0.2, 0.2, 5.7), 'theta_obs': (0.2, 0.2, 5.7),\n         'x0_obs': (1.0, 0.0, 0.0), 'dt': 0.05, 'T': 10.0, 'eps': 0.05},\n        # 2) Boundary-like (tight uncertainty)\n        {'theta_model': (0.2, 0.2, 5.7), 'theta_obs': (0.2, 0.2, 5.7),\n         'x0_obs': (1.0, 0.0, 0.0), 'dt': 0.05, 'T': 10.0, 'eps': 0.01},\n        # 3) Parameter mismatch, generous uncertainty\n        {'theta_model': (0.2, 0.2, 5.7), 'theta_obs': (0.2, 0.2, 5.9),\n         'x0_obs': (1.0, 0.0, 0.0), 'dt': 0.05, 'T': 6.0, 'eps': 0.50},\n        # 4) Significant parameter mismatch, tight uncertainty\n        {'theta_model': (0.2, 0.2, 5.7), 'theta_obs': (0.2, 0.2, 6.2),\n         'x0_obs': (1.0, 0.0, 0.0), 'dt': 0.05, 'T': 12.0, 'eps': 0.05},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        theta_model = case['theta_model']\n        theta_obs = case['theta_obs']\n        x0_obs = np.array(case['x0_obs'])\n        dt = case['dt']\n        T = case['T']\n        epsilon = case['eps']\n        \n        N = int(T / dt)\n        t_span_obs = [0, T]\n        t_eval_obs = np.linspace(0, T, N + 1)\n\n        # 1. Generate synthetic observation data\n        obs_sol = solve_ivp(\n            rossler_ode, t_span_obs, x0_obs, args=theta_obs,\n            dense_output=True, t_eval=t_eval_obs,\n            rtol=RTOL, atol=ATOL\n        )\n        y_obs = obs_sol.y.T\n\n        # 2. Run the shadowing test algorithm\n        shadowed = True\n        \n        # Initialize the ellipsoid: center c and shape matrix P\n        c_k = y_obs[0]\n        P_k = (epsilon**2) * np.eye(3)\n        R = (epsilon**2) * np.eye(3) # Measurement uncertainty representation\n\n        for i in range(1, N + 1):\n            # A. Propagation (Prediction)\n            z0 = np.concatenate([c_k, np.eye(3).flatten()])\n            t_span_step = [0, dt]\n            \n            prop_sol = solve_ivp(\n                augmented_ode, t_span_step, z0, args=theta_model,\n                dense_output=False, t_eval=[dt],\n                rtol=RTOL, atol=ATOL\n            )\n            \n            z_end = prop_sol.y[:, -1]\n            c_pred = z_end[0:3]\n            phi_dt = z_end[3:12].reshape((3, 3))\n            P_pred = phi_dt @ P_k @ phi_dt.T\n\n            # B. Validation (Check for intersection)\n            y_i = y_obs[i]\n            nu = y_i - c_pred       # Innovation\n            S = P_pred + R          # Innovation covariance\n            \n            try:\n                S_inv = np.linalg.inv(S)\n            except np.linalg.LinAlgError:\n                # If S is singular, something is numerically wrong.\n                # Assume failure as a safe exit.\n                shadowed = False\n                break\n            \n            mahalanobis_sq = nu.T @ S_inv @ nu\n\n            if mahalanobis_sq > 1.0:\n                shadowed = False\n                break\n            \n            # C. Update (Correction)\n            K = P_pred @ S_inv      # Kalman-like gain\n            c_k = c_pred + K @ nu\n            P_k = (np.eye(3) - K) @ P_pred\n            # Ensure P_k remains symmetric\n            P_k = 0.5 * (P_k + P_k.T)\n\n        results.append(shadowed)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2679751"}]}