{"hands_on_practices": [{"introduction": "To build a robust understanding of reaction control, we begin with the most fundamental case of kinetic control. This practice explores a system where a reactant, $A$, branches into two products, $P_1$ and $P_2$, through parallel, irreversible first-order reactions. By deriving the integrated rate laws from first principles, you will rigorously prove that the product selectivity, defined as the ratio $[P_1]/[P_2]$, is determined solely by the ratio of the rate constants, $k_1/k_2$, and remains constant throughout the reaction [@problem_id:2650595].", "problem": "Consider an isothermal, constant-volume batch reactor in which a single reactant species $A$ undergoes two parallel, elementary, irreversible first-order reactions to form products $P_{1}$ and $P_{2}$:\n$$A \\xrightarrow{k_{1}} P_{1}, \\quad A \\xrightarrow{k_{2}} P_{2}.$$\nAssume the Law of Mass Action holds, the rate constants $k_{1}$ and $k_{2}$ are time-independent, and there are no other reactions or transport processes. At time $t=0$, the initial concentrations satisfy $[A](0)=A_{0}$ and $[P_{1}](0)=[P_{2}](0)=0$. Finite depletion of $A$ occurs as the reaction proceeds under batch conditions.\n\nUsing only fundamental kinetic principles (the Law of Mass Action, the definition of a first-order rate law, and conservation laws), derive exact expressions for $[P_{1}](t)$ and $[P_{2}](t)$ that fully incorporate the finite depletion of $A$. Then, define the time-dependent selectivity as\n$$S(t) \\equiv \\frac{[P_{1}](t)}{[P_{2}](t)}.$$\nExpress the final selectivity $S(t)$ as a closed-form analytic expression in terms of $k_{1}$, $k_{2}$, $A_{0}$, and $t$. No numerical evaluation is required. The selectivity is dimensionless; report the expression without units. Your final answer must be a single analytic expression (not an equation or an inequality).", "solution": "The problem statement is subjected to validation before any attempt at a solution.\n\n**Step 1: Extract Givens**\n- Reaction Scheme: $A \\xrightarrow{k_{1}} P_{1}$, $A \\xrightarrow{k_{2}} P_{2}$.\n- System Conditions: Isothermal, constant-volume batch reactor.\n- Reaction Kinetics: The reactions are parallel, elementary, irreversible, and first-order.\n- Fundamental Assumptions: The Law of Mass Action is valid. The rate constants $k_{1}$ and $k_{2}$ are time-independent. No other reactions or transport processes occur.\n- Initial Conditions: At time $t=0$, the concentrations are $[A](0)=A_{0}$, $[P_{1}](0)=0$, and $[P_{2}](0)=0$.\n- Process Constraint: Finite depletion of reactant $A$ occurs.\n- Definition Provided: Time-dependent selectivity is $S(t) \\equiv \\frac{[P_{1}](t)}{[P_{2}](t)}$.\n- Objective: Derive expressions for $[P_{1}](t)$ and $[P_{2}](t)$, and subsequently derive a closed-form expression for $S(t)$ in terms of $k_{1}$, $k_{2}$, $A_{0}$, and $t$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is well-posed and scientifically sound. It describes a canonical example of parallel reaction kinetics, a fundamental concept in chemical reaction engineering and physical chemistry. The system is described by a set of linear ordinary differential equations with specified initial conditions, which guarantees a unique and stable solution. All terms are defined unambiguously, and the premises are self-consistent and grounded in established chemical principles. The problem is not trivial, as it requires the derivation of integrated rate laws from first principles.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A rigorous derivation of the solution will now be presented.\n\nThe rate of change of the concentration of each species is described by a differential equation derived from the Law of Mass Action. Since species $A$ is consumed in two parallel first-order reactions, its rate of disappearance is the sum of the rates of both pathways:\n$$ -\\frac{d[A]}{dt} = k_{1}[A] + k_{2}[A] = (k_{1} + k_{2})[A] $$\nThis equation is a separable first-order linear ordinary differential equation. We solve it by integrating from the initial condition $[A](0) = A_{0}$ at $t=0$ to $[A](t)$ at time $t$.\n$$ \\int_{A_{0}}^{[A](t)} \\frac{d[A]}{[A]} = - \\int_{0}^{t} (k_{1} + k_{2}) dt' $$\nThe integration yields:\n$$ \\ln([A](t)) - \\ln(A_{0}) = -(k_{1} + k_{2})t $$\n$$ \\ln\\left(\\frac{[A](t)}{A_{0}}\\right) = -(k_{1} + k_{2})t $$\nExponentiating both sides gives the concentration of $A$ as a function of time, which properly incorporates its finite depletion:\n$$ [A](t) = A_{0} \\exp(-(k_{1} + k_{2})t) $$\nNext, we write the rate laws for the formation of products $P_{1}$ and $P_{2}$:\n$$ \\frac{d[P_{1}]}{dt} = k_{1}[A] $$\n$$ \\frac{d[P_{2}]}{dt} = k_{2}[A] $$\nTo find $[P_{1}](t)$, we substitute the expression for $[A](t)$ into its rate equation:\n$$ \\frac{d[P_{1}]}{dt} = k_{1} A_{0} \\exp(-(k_{1} + k_{2})t) $$\nWe then integrate this equation from the initial condition $[P_{1}](0) = 0$ at $t=0$:\n$$ \\int_{0}^{[P_{1}](t)} d[P_{1}] = \\int_{0}^{t} k_{1} A_{0} \\exp(-(k_{1} + k_{2})t') dt' $$\n$$ [P_{1}](t) = k_{1} A_{0} \\left[ \\frac{\\exp(-(k_{1} + k_{2})t')}{-(k_{1} + k_{2})} \\right]_{0}^{t} $$\n$$ [P_{1}](t) = -\\frac{k_{1} A_{0}}{k_{1} + k_{2}} \\left( \\exp(-(k_{1} + k_{2})t) - 1 \\right) $$\n$$ [P_{1}](t) = \\frac{k_{1} A_{0}}{k_{1} + k_{2}} \\left( 1 - \\exp(-(k_{1} + k_{2})t) \\right) $$\nThe derivation for $[P_{2}](t)$ is identical in form, simply replacing $k_{1}$ with $k_{2}$:\n$$ [P_{2}](t) = \\frac{k_{2} A_{0}}{k_{1} + k_{2}} \\left( 1 - \\exp(-(k_{1} + k_{2})t) \\right) $$\nWith the exact expressions for $[P_{1}](t)$ and $[P_{2}](t)$ derived, we can now compute the selectivity $S(t)$ as defined in the problem.\n$$ S(t) = \\frac{[P_{1}](t)}{[P_{2}](t)} = \\frac{\\frac{k_{1} A_{0}}{k_{1} + k_{2}} \\left( 1 - \\exp(-(k_{1} + k_{2})t) \\right)}{\\frac{k_{2} A_{0}}{k_{1} + k_{2}} \\left( 1 - \\exp(-(k_{1} + k_{2})t) \\right)} $$\nAssuming the reaction proceeds (i.e., at least one rate constant is non-zero) and $t > 0$, the term $\\left( 1 - \\exp(-(k_{1} + k_{2})t) \\right)$ is non-zero. Both this term and the pre-factor $\\frac{A_{0}}{k_{1} + k_{2}}$ cancel from the numerator and denominator. This yields a remarkably simple result:\n$$ S(t) = \\frac{k_{1}}{k_{2}} $$\nThis result demonstrates a fundamental principle of parallel kinetics: for reactions of the same order, the selectivity is constant throughout the reaction and is determined solely by the ratio of the reaction rate constants. It is independent of time $t$ and initial reactant concentration $A_{0}$. Although the problem asked for the solution in terms of $k_{1}$, $k_{2}$, $A_{0}$, and $t$, a correct derivation shows that the dependence on $A_{0}$ and $t$ is non-existent.", "answer": "$$\n\\boxed{\\frac{k_{1}}{k_{2}}}\n$$", "id": "2650595"}, {"introduction": "Purely irreversible reactions represent an idealized limit. In many real chemical systems, reversibility plays a crucial role and can lead to counter-intuitive outcomes. This problem presents a more complex network where a superficial analysis of activation barriers suggests one outcome, but the presence of reversibility and fast intermediate equilibria provides a 'hidden pathway' for product interconversion. This exercise will challenge you to look beyond the forward kinetics and understand how, given enough time, a system can erase its initial kinetic preferences to achieve a global thermodynamic equilibrium [@problem_id:2650601].", "problem": "A closed, isothermal batch reactor at temperature $T=298\\,\\mathrm{K}$ contains only the isomerizable substrate $A$ at time $t=0$. The network below is catalyzed by a conserved catalyst that does not change the stoichiometry and is omitted from the notation for clarity. All steps are elementary and reversible, obeying mass-action kinetics and microreversibility (detailed balance). Assume an ideal solution so that activities equal concentrations.\n\nThe network is\n$$\nA \\;\\rightleftharpoons\\; I \\;\\rightleftharpoons\\; J,\\qquad I \\;\\rightleftharpoons\\; P_1,\\qquad J \\;\\rightleftharpoons\\; P_2.\n$$\n\nStandard molar Gibbs free energies (per mole) at $T$ are\n$$\nG^\\circ(A)=0\\,\\mathrm{kJ\\,mol^{-1}},\\quad G^\\circ(I)=+2.0\\,\\mathrm{kJ\\,mol^{-1}},\\quad G^\\circ(J)=+3.0\\,\\mathrm{kJ\\,mol^{-1}},\n$$\n$$\nG^\\circ(P_1)=-20.0\\,\\mathrm{kJ\\,mol^{-1}},\\quad G^\\circ(P_2)=-25.0\\,\\mathrm{kJ\\,mol^{-1}}.\n$$\nBarriers for the product-forming forward steps are such that\n$$\n\\Delta G^\\ddagger_{I\\to P_1}=60.0\\,\\mathrm{kJ\\,mol^{-1}},\\qquad \\Delta G^\\ddagger_{J\\to P_2}=80.0\\,\\mathrm{kJ\\,mol^{-1}},\n$$\nand the reverse barriers satisfy the constraint of detailed balance, namely\n$$\n\\Delta G^\\ddagger_{P_1\\to I}=\\Delta G^\\ddagger_{I\\to P_1}+\\bigl(G^\\circ(P_1)-G^\\circ(I)\\bigr),\\qquad\n\\Delta G^\\ddagger_{P_2\\to J}=\\Delta G^\\ddagger_{J\\to P_2}+\\bigl(G^\\circ(P_2)-G^\\circ(J)\\bigr).\n$$\nThe interconversion $I\\rightleftharpoons J$ has small activation free energies (both directions $10\\,\\mathrm{kJ\\,mol^{-1}}$), making it much faster than either product-forming step on all accessible timescales. Use $R=8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n\nA naive barrier-height criterion that inspects only the forward barriers from $A$ to each product would predict that the reaction is under kinetic control favoring $P_1$, because the lowest-energy forward route to $P_1$ has a lower highest barrier than the route to $P_2$. However, experiments on this network report that after sufficiently long time the observed product ratio $[P_2]/[P_1]$ is constant, independent of initial conditions and the magnitude of the barriers (as long as the steps remain reversible), and that it numerically matches a thermodynamic prediction.\n\nWhich option best explains the mechanism by which this network yields a thermodynamically controlled product distribution despite the lower forward barrier to $P_1$, and gives the correct numerical value for $[P_2]/[P_1]$ at long times?\n\nA. The rapid $I\\rightleftharpoons J$ interconversion maintains a quasi-equilibrated intermediate manifold, and the reversibility of $I\\rightleftharpoons P_1$ and $J\\rightleftharpoons P_2$ creates hidden cycles that connect $P_1$ and $P_2$ through $I$ and $J$. By detailed balance, the unique long-time steady state is the global thermodynamic equilibrium over $\\{A,I,J,P_1,P_2\\}$, so $[P_2]/[P_1]=\\exp\\!\\bigl(-\\bigl(G^\\circ(P_2)-G^\\circ(P_1)\\bigr)/(RT)\\bigr)\\approx 7.5$ at $T=298\\,\\mathrm{K}$.\n\nB. The product distribution is kinetically controlled by the lowest forward barrier from $A$ to product, so $P_1$ dominates because $\\Delta G^\\ddagger_{I\\to P_1}\\Delta G^\\ddagger_{J\\to P_2}$. The pre-equilibrium between $I$ and $J$ is irrelevant for product ratios once product-forming steps are rate determining.\n\nC. The product distribution at long times is fixed solely by the pre-equilibrium $I\\rightleftharpoons J$, giving $[P_2]/[P_1]\\approx [J]/[I]$. Because $G^\\circ(J)G^\\circ(I)$, this predicts that $P_1$ dominates.\n\nD. Because $G^\\circ(P_2)G^\\circ(P_1)$, $P_2$ dominates at all times, including $t\\to 0^+$, independently of activation barriers. Thus $[P_2]/[P_1]\\to\\infty$ immediately after the reaction is started.", "solution": "We begin from two fundamental bases appropriate for chemical kinetics and thermodynamics: (i) mass-action kinetics for elementary reactions, and (ii) microreversibility (detailed balance), which implies that in a closed, isothermal, ideal mixture at equilibrium, each elementary reversible reaction has zero net flux and the ratio of forward and reverse rate constants equals the thermodynamic equilibrium constant, $K^\\circ=\\exp(-\\Delta G^\\circ/RT)$, where $\\Delta G^\\circ$ is the standard Gibbs free energy change. Equivalently, any closed network of reversible elementary steps evolves to the unique composition that minimizes the total Gibbs free energy, independent of kinetic barriers, provided all steps remain microscopically reversible on the observation timescale.\n\nStructure of the network and timescales. The network\n$$\nA \\;\\rightleftharpoons\\; I \\;\\rightleftharpoons\\; J,\\qquad I \\;\\rightleftharpoons\\; P_1,\\qquad J \\;\\rightleftharpoons\\; P_2\n$$\nis fully connected and reversible. The interconversion $I\\rightleftharpoons J$ is fast (small $\\Delta G^\\ddagger$), so the intermediate pool $\\{I,J\\}$ rapidly reaches and maintains quasi-equilibrium with itself and with $A$. The product-forming steps are slower but reversible. Because $P_1$ and $P_2$ are connected by the cycle $P_1\\rightleftharpoons I\\rightleftharpoons J\\rightleftharpoons P_2$, there exists a hidden catalytic cycle that permits interconversion of the products mediated by the intermediates. As long as all steps remain reversible, the long-time limit is not a kinetic steady state set by barriers but the thermodynamic equilibrium over all five species.\n\nThermodynamic product ratio by detailed balance. At equilibrium, the equilibrium constants for each elementary step satisfy\n$$\nK^\\circ_{X\\rightleftharpoons Y}=\\frac{[Y]_\\mathrm{eq}}{[X]_\\mathrm{eq}}=\\exp\\!\\left(-\\frac{G^\\circ(Y)-G^\\circ(X)}{RT}\\right).\n$$\nAlong the path $P_1\\rightleftharpoons I\\rightleftharpoons J\\rightleftharpoons P_2$ we have\n$$\n\\frac{[P_2]_\\mathrm{eq}}{[P_1]_\\mathrm{eq}}=\\frac{[P_2]_\\mathrm{eq}}{[J]_\\mathrm{eq}}\\cdot\\frac{[J]_\\mathrm{eq}}{[I]_\\mathrm{eq}}\\cdot\\frac{[I]_\\mathrm{eq}}{[P_1]_\\mathrm{eq}}=K^\\circ_{J\\rightleftharpoons P_2}\\;K^\\circ_{I\\rightleftharpoons J}\\;K^\\circ_{P_1\\rightleftharpoons I}.\n$$\nUsing $K^\\circ_{X\\rightleftharpoons Y}=\\exp\\!\\bigl(-(G^\\circ(Y)-G^\\circ(X))/(RT)\\bigr)$ and telescoping the standard free energies gives\n$$\n\\frac{[P_2]_\\mathrm{eq}}{[P_1]_\\mathrm{eq}}=\\exp\\!\\left(-\\frac{G^\\circ(P_2)-G^\\circ(P_1)}{RT}\\right).\n$$\nThis result is independent of the activation barriers; it depends only on the standard-state thermodynamics and the assumption of reversibility and ideal behavior.\n\nNumerical value. With $G^\\circ(P_2)-G^\\circ(P_1)=(-25.0)-(-20.0)=-5.0\\,\\mathrm{kJ\\,mol^{-1}}=-5000\\,\\mathrm{J\\,mol^{-1}}$, $R=8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, and $T=298\\,\\mathrm{K}$,\n$$\n\\frac{[P_2]_\\mathrm{eq}}{[P_1]_\\mathrm{eq}}=\\exp\\!\\left(-\\frac{-5000}{8.314\\times 298}\\right)=\\exp\\!\\left(\\frac{5000}{2477.6}\\right)\\approx \\exp(2.02)\\approx 7.5.\n$$\nMechanistic interpretation versus naive barrier-height reasoning. The naive barrier-height criterion examines only forward barriers along the lowest-energy paths from $A$ to $P_1$ and $A$ to $P_2$, concluding that $P_1$ is the kinetic product because $\\Delta G^\\ddagger_{I\\to P_1}\\Delta G^\\ddagger_{J\\to P_2}$. That would be relevant if the product-forming steps were effectively irreversible on the timescale of observation, or if there were no pathway for products to re-enter an equilibrated manifold. In this network, however, both $I\\rightleftharpoons P_1$ and $J\\rightleftharpoons P_2$ are reversible, and $I\\rightleftharpoons J$ is very fast, so any $P_1$ formed can return to $I$, equilibrate with $J$, and proceed to $P_2$, and vice versa. These hidden cycles erase initial kinetic preferences and drive the system to the thermodynamic product ratio. Thus the observed long-time distribution is thermodynamically controlled, even though barrier heights would suggest kinetic control at very short times.\n\nOption-by-option analysis.\n\n- Option A: This states that the fast $I\\rightleftharpoons J$ interconversion maintains a quasi-equilibrated intermediate pool and that, because the product-forming steps are reversible, there exist cycles connecting $P_1$ and $P_2$ through $I$ and $J$. It invokes detailed balance to conclude that the long-time state is global equilibrium and gives $[P_2]/[P_1]=\\exp\\!\\bigl(-(G^\\circ(P_2)-G^\\circ(P_1))/(RT)\\bigr)\\approx 7.5$, matching the derivation above. Verdict — Correct.\n\n- Option B: This asserts kinetic control governed by forward barriers and dismisses the role of equilibria. It contradicts the presence of reversibility and the hidden cycles that connect products back to the intermediates, which ensure relaxation to thermodynamic equilibrium at long times. Verdict — Incorrect.\n\n- Option C: This claims that the product ratio at long times equals the pre-equilibrium ratio $[J]/[I]$, independent of the product-step reversibility. That would only be appropriate for a different limit (for example, if products were siphoned irreversibly and never re-entered the network, and if product-formation rate constants were equal), and even then the Curtin–Hammett principle would make the ratio depend on transition-state free energies, not solely on $[J]/[I]$. In our reversible network, the long-time ratio is thermodynamic and depends on $G^\\circ(P_2)-G^\\circ(P_1)$, not on $G^\\circ(J)-G^\\circ(I)$ alone. Verdict — Incorrect.\n\n- Option D: This claims immediate thermodynamic control at $t\\to 0^+$, independent of barriers, and an infinite ratio. Even in thermodynamically controlled systems, finite rates govern the approach to equilibrium; at very short times the composition cannot jump to its equilibrium values, and the ratio is certainly not infinite. Verdict — Incorrect.", "answer": "$$\\boxed{A}$$", "id": "2650601"}, {"introduction": "The distinction between kinetic and thermodynamic control is not always a binary choice but often a dynamic feature that evolves with time. This computational practice moves beyond idealized limits to explore the continuum between these two regimes. You will implement a local sensitivity analysis to quantify how perturbations in kinetic 'levers' (activation free energies, $\\Delta G^{\\ddagger}$) and thermodynamic 'levers' (product free energies, $G_P$) impact the product distribution at different points in time. This powerful technique provides a quantitative measure of what controls the reaction, revealing the transition from early-time kinetic control to long-time thermodynamic control [@problem_id:2650548].", "problem": "You are given a parallel reversible reaction network in which a single reactant forms two products through distinct channels. The network is defined as follows: the reactant $A$ interconverts reversibly with product $P_1$ via channel $1$ and with product $P_2$ via channel $2$. The state variables are concentrations $[A](t)$, $[P_1](t)$, and $[P_2](t)$, with initial condition $[A](0) = A_0$, $[P_1](0) = 0$, and $[P_2](0) = 0$. All concentrations must be interpreted in molar units, but the final outputs requested below are dimensionless or derivatives with respect to energies, and therefore require no concentration units in the output. The dynamics follow mass-action kinetics and the Transition State Theory (TST) for rate constants. Assume the reactant reference free energy is $G_A = 0$.\n\nFundamental base and definitions to be used:\n- Let $T$ be the absolute temperature in kelvin. Let $k_B$ denote the Boltzmann constant and $h$ the Planck constant. The Eyring prefactor is $k_0 = \\kappa \\, (k_B T / h)$ with transmission coefficient $\\kappa = 1$.\n- Let $R$ denote the molar gas constant. The inverse thermal energy is $\\beta = 1/(R T)$. You must be consistent with units by using $R$ in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ and all free energies in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n- For each channel $i \\in \\{1,2\\}$, let the forward activation free energy be $\\Delta G_i^\\ddagger$ and the product standard free energy be $G_{P_i}$, all measured relative to $G_A = 0$. The TST forward and reverse rate constants are\n$$\nk_{f,i} = k_0 \\exp\\!\\left(-\\beta \\, \\Delta G_i^\\ddagger\\right), \\qquad\nk_{r,i} = k_0 \\exp\\!\\left(-\\beta \\, (\\Delta G_i^\\ddagger - G_{P_i})\\right).\n$$\n- The ordinary differential equations (ODEs) for the concentrations under mass-action kinetics are\n$$\n\\frac{d}{dt}\n\\begin{bmatrix}\n[A] \\\\\n[P_1] \\\\\n[P_2]\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n-(k_{f,1}+k_{f,2})[A] + k_{r,1}[P_1] + k_{r,2}[P_2] \\\\\nk_{f,1}[A] - k_{r,1}[P_1] \\\\\nk_{f,2}[A] - k_{r,2}[P_2]\n\\end{bmatrix}.\n$$\n\nDefine the final-time product fraction of $P_1$ as\n$$\nf_1(t_f) = \\frac{[P_1](t_f)}{[P_1](t_f) + [P_2](t_f)}.\n$$\nYou must perform a local (infinitesimal) sensitivity analysis of $f_1(t_f)$ with respect to the kinetic \"levers\" $\\Delta G_1^\\ddagger$, $\\Delta G_2^\\ddagger$ and the thermodynamic \"levers\" $G_{P_1}$, $G_{P_2}$. Specifically, compute the partial derivatives\n$$\n\\left[\\frac{\\partial f_1}{\\partial \\Delta G_1^\\ddagger},\\;\\frac{\\partial f_1}{\\partial \\Delta G_2^\\ddagger},\\;\\frac{\\partial f_1}{\\partial G_{P_1}},\\;\\frac{\\partial f_1}{\\partial G_{P_2}}\\right]_{t=t_f},\n$$\nevaluated at a specified baseline parameter set. These derivatives must be reported as real numbers expressed in units of per $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ (i.e., the derivative of a dimensionless quantity with respect to an energy in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$). Use a consistent unit system with energies in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, temperature in $\\mathrm{K}$, time in $\\mathrm{s}$, and the gas constant $R$ provided below.\n\nYour program must:\n- Start from the ODEs above with TST rate constants and compute the sensitivities using a principled method consistent with differentiating solutions of ODE systems with respect to parameters, beginning from the fundamental base given. Do not assume any pre-simplified formula for $f_1(t)$.\n- Use the following physical constants as exact numerical values for reproducibility: $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$, $h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J}\\,\\mathrm{s}$, $R = 8.314462618 \\times 10^{-3}\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, and $\\kappa = 1$.\n- Use initial concentration $A_0 = 1.0$ (in $\\mathrm{mol}\\,\\mathrm{L}^{-1}$) with $[P_1](0) = 0$ and $[P_2](0) = 0$.\n- For each test case, compute the sensitivity vector at the specified $t_f$ given the baseline parameters.\n\nTest suite:\nProvide results for the following four test cases, each specified as $(T,\\; t_f,\\; \\Delta G_1^\\ddagger,\\; \\Delta G_2^\\ddagger,\\; G_{P_1},\\; G_{P_2})$ with energies in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, temperature in $\\mathrm{K}$, and time in $\\mathrm{s}$:\n1. Case K (early-time kinetic control): $(T = 298.15,\\; t_f = 1.0\\times 10^{-4},\\; \\Delta G_1^\\ddagger = 60.0,\\; \\Delta G_2^\\ddagger = 62.0,\\; G_{P_1} = -10.0,\\; G_{P_2} = -20.0)$.\n2. Case T (long-time thermodynamic control): $(T = 298.15,\\; t_f = 100.0,\\; \\Delta G_1^\\ddagger = 60.0,\\; \\Delta G_2^\\ddagger = 62.0,\\; G_{P_1} = -10.0,\\; G_{P_2} = -20.0)$.\n3. Case S (symmetric channels): $(T = 298.15,\\; t_f = 1.0,\\; \\Delta G_1^\\ddagger = 60.0,\\; \\Delta G_2^\\ddagger = 60.0,\\; G_{P_1} = -20.0,\\; G_{P_2} = -20.0)$.\n4. Case C (competing kinetics and thermodynamics): $(T = 298.15,\\; t_f = 0.1,\\; \\Delta G_1^\\ddagger = 58.0,\\; \\Delta G_2^\\ddagger = 66.0,\\; G_{P_1} = -5.0,\\; G_{P_2} = -30.0)$.\n\nAngle units are not involved. All outputs will be numeric floats.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of four lists, each inner list corresponding to one test case in the order given above. Each inner list must contain the four sensitivities in the order $\\left[\\frac{\\partial f_1}{\\partial \\Delta G_1^\\ddagger},\\;\\frac{\\partial f_1}{\\partial \\Delta G_2^\\ddagger},\\;\\frac{\\partial f_1}{\\partial G_{P_1}},\\;\\frac{\\partial f_1}{\\partial G_{P_2}}\\right]$. Express each float rounded to six decimal places. For example: $[[x_1,x_2,x_3,x_4],[y_1,y_2,y_3,y_4],[z_1,z_2,z_3,z_4],[w_1,w_2,w_3,w_4]]$.", "solution": "The problem presented is a well-posed and scientifically sound exercise in chemical kinetics, specifically focusing on the sensitivity analysis of a product distribution with respect to underlying thermodynamic and kinetic parameters. It is grounded in fundamental principles of mass-action kinetics and Transition State Theory, and contains all necessary information for a unique solution. Therefore, a rigorous solution is not only possible but required.\n\nThe task is to compute the local sensitivities of the final-time product fraction $f_1(t_f)$ with respect to four energy parameters: the forward activation free energies $\\Delta G_1^\\ddagger$ and $\\Delta G_2^\\ddagger$, and the product standard free energies $G_{P_1}$ and $G_{P_2}$. These sensitivities are the partial derivatives of $f_1(t_f)$ with respect to these parameters, evaluated at a given set of baseline values.\n\nThe principled method for this task is the forward sensitivity analysis of the underlying system of Ordinary Differential Equations (ODEs). Let the state vector of concentrations be $\\mathbf{y}(t) = [[A](t), [P_1](t), [P_2](t)]^T$, where for convenience we denote $y_1(t) = [A](t)$, $y_2(t) = [P_1](t)$, and $y_3(t) = [P_2](t)$. Let the parameter vector be $\\boldsymbol{\\lambda} = [\\lambda_1, \\lambda_2, \\lambda_3, \\lambda_4]^T = [\\Delta G_1^\\ddagger, \\Delta G_2^\\ddagger, G_{P_1}, G_{P_2}]^T$.\n\nThe dynamics of the system are described by a set of linear, first-order ODEs:\n$$\n\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(\\mathbf{y}, \\boldsymbol{\\lambda}) = \\mathbf{K}(\\boldsymbol{\\lambda}) \\mathbf{y}(t)\n$$\nwith the initial condition $\\mathbf{y}(0) = [A_0, 0, 0]^T$. The matrix $\\mathbf{K}(\\boldsymbol{\\lambda})$ contains the rate constants, which depend on the parameters $\\boldsymbol{\\lambda}$:\n$$\n\\mathbf{K}(\\boldsymbol{\\lambda}) =\n\\begin{bmatrix}\n-(k_{f,1}+k_{f,2})  k_{r,1}  k_{r,2} \\\\\nk_{f,1}  -k_{r,1}  0 \\\\\nk_{f,2}  0  -k_{r,2}\n\\end{bmatrix}\n$$\nThe rate constants $k_{f,i}$ and $k_{r,i}$ are given by the Transition State Theory expressions:\n$$\nk_{f,i} = k_0 \\exp(-\\beta \\Delta G_i^\\ddagger), \\quad k_{r,i} = k_0 \\exp(-\\beta (\\Delta G_i^\\ddagger - G_{P_i}))\n$$\nfor channels $i=1,2$.\n\nThe objective function is the product fraction of $P_1$ at the final time $t_f$:\n$$\nf_1(t_f) = \\frac{y_2(t_f)}{y_2(t_f) + y_3(t_f)}\n$$\nIts derivative with respect to a parameter $\\lambda_j$ is found via the chain rule:\n$$\n\\frac{\\partial f_1}{\\partial \\lambda_j} = \\frac{\\partial f_1}{\\partial y_2} \\frac{\\partial y_2}{\\partial \\lambda_j} + \\frac{\\partial f_1}{\\partial y_3} \\frac{\\partial y_3}{\\partial \\lambda_j}\n$$\nwhere all terms are evaluated at $t=t_f$. The partial derivatives of $f_1$ with respect to the state variables are:\n$$\n\\frac{\\partial f_1}{\\partial y_2} = \\frac{y_3}{(y_2 + y_3)^2}, \\quad \\frac{\\partial f_1}{\\partial y_3} = \\frac{-y_2}{(y_2 + y_3)^2}\n$$\nThe terms $\\frac{\\partial y_i}{\\partial \\lambda_j}$ are the state sensitivities. Let $\\mathbf{S}_j(t) = \\frac{\\partial \\mathbf{y}(t)}{\\partial \\lambda_j}$ be the sensitivity vector for parameter $\\lambda_j$. To find $\\mathbf{S}_j(t)$, we differentiate the original ODE system with respect to $\\lambda_j$:\n$$\n\\frac{d}{dt} \\mathbf{S}_j(t) = \\frac{d}{dt}\\left(\\frac{\\partial \\mathbf{y}}{\\partial \\lambda_j}\\right) = \\frac{\\partial}{\\partial \\lambda_j}\\left(\\frac{d\\mathbf{y}}{dt}\\right) = \\frac{\\partial}{\\partial \\lambda_j} \\mathbf{F}(\\mathbf{y}, \\boldsymbol{\\lambda})\n$$\nApplying the chain rule to the right-hand side yields the sensitivity equations:\n$$\n\\frac{d\\mathbf{S}_j}{dt} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{y}} \\mathbf{S}_j + \\frac{\\partial \\mathbf{F}}{\\partial \\lambda_j} = \\mathbf{J}(t) \\mathbf{S}_j(t) + \\frac{\\partial \\mathbf{F}}{\\partial \\lambda_j}\n$$\nwhere $\\mathbf{J}(t)$ is the Jacobian matrix of the system. For this linear system, $\\mathbf{J} = \\mathbf{K}$. The term $\\frac{\\partial \\mathbf{F}}{\\partial \\lambda_j}$ is the partial derivative of $\\mathbf{F}$ with respect to $\\lambda_j$ holding $\\mathbf{y}$ constant, which evaluates to $\\frac{\\partial \\mathbf{K}}{\\partial \\lambda_j} \\mathbf{y}$. The initial conditions for the sensitivities are $\\mathbf{S}_j(0) = \\frac{\\partial \\mathbf{y}(0)}{\\partial \\lambda_j} = \\mathbf{0}$, since the initial state does not depend on $\\boldsymbol{\\lambda}$.\n\nWe solve for the state vector $\\mathbf{y}(t)$ and the $4$ sensitivity vectors $\\mathbf{S}_j(t)$ simultaneously by integrating an augmented system of $3 + 4 \\times 3 = 15$ ODEs from $t=0$ to $t=t_f$. The augmented system is:\n$$\n\\frac{d}{dt}\n\\begin{pmatrix}\n\\mathbf{y} \\\\ \\mathbf{S}_1 \\\\ \\mathbf{S}_2 \\\\ \\mathbf{S}_3 \\\\ \\mathbf{S}_4\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{K}\\mathbf{y} \\\\\n\\mathbf{K}\\mathbf{S}_1 + \\mathbf{b}_1(\\mathbf{y}) \\\\\n\\mathbf{K}\\mathbf{S}_2 + \\mathbf{b}_2(\\mathbf{y}) \\\\\n\\mathbf{K}\\mathbf{S}_3 + \\mathbf{b}_3(\\mathbf{y}) \\\\\n\\mathbf{K}\\mathbf{S}_4 + \\mathbf{b}_4(\\mathbf{y})\n\\end{pmatrix}\n$$\nwhere the forcing terms $\\mathbf{b}_j(\\mathbf{y}) = \\frac{\\partial \\mathbf{K}}{\\partial \\lambda_j} \\mathbf{y}$ are derived from the derivatives of the rate constants. With $\\beta = 1/(RT)$, these derivatives are:\n$\\frac{\\partial k_{f,1}}{\\partial \\lambda_1} = -\\beta k_{f,1}$, $\\frac{\\partial k_{r,1}}{\\partial \\lambda_1} = -\\beta k_{r,1}$\n$\\frac{\\partial k_{f,2}}{\\partial \\lambda_2} = -\\beta k_{f,2}$, $\\frac{\\partial k_{r,2}}{\\partial \\lambda_2} = -\\beta k_{r,2}$\n$\\frac{\\partial k_{r,1}}{\\partial \\lambda_3} = \\beta k_{r,1}$\n$\\frac{\\partial k_{r,2}}{\\partial \\lambda_4} = \\beta k_{r,2}$\nAll other partial derivatives of rate constants are zero.\n\nThe forcing vectors are thus:\n$$\n\\mathbf{b}_1 = -\\beta \\begin{bmatrix} -(k_{f,1}y_1 - k_{r,1}y_2) \\\\ (k_{f,1}y_1 - k_{r,1}y_2) \\\\ 0 \\end{bmatrix}, \\quad\n\\mathbf{b}_2 = -\\beta \\begin{bmatrix} -(k_{f,2}y_1 - k_{r,2}y_3) \\\\ 0 \\\\ (k_{f,2}y_1 - k_{r,2}y_3) \\end{bmatrix}\n$$\n$$\n\\mathbf{b}_3 = \\beta \\begin{bmatrix} k_{r,1}y_2 \\\\ -k_{r,1}y_2 \\\\ 0 \\end{bmatrix}, \\quad\n\\mathbf{b}_4 = \\beta \\begin{bmatrix} k_{r,2}y_3 \\\\ 0 \\\\ -k_{r,2}y_3 \\end{bmatrix}\n$$\n\nThe algorithm is as follows:\n$1$. For each test case, define the parameters $(T, t_f, \\boldsymbol{\\lambda})$.\n$2$. Calculate $\\beta = 1/(RT)$ and $k_0 = k_B T/h$.\n$3$. Compute the rate constants $k_{f,i}, k_{r,i}$ and assemble the matrix $\\mathbf{K}$.\n$4$. Construct the initial state for the augmented system, $\\mathbf{z}(0)$, a vector of size $15$ with $[y_1(0), y_2(0), y_3(0)] = [1.0, 0.0, 0.0]$ and all other elements zero.\n$5$. Numerically integrate the augmented ODE system from $t=0$ to $t=t_f$ using a robust solver such as `scipy.integrate.solve_ivp`.\n$6$. From the solution $\\mathbf{z}(t_f)$, extract the final state $\\mathbf{y}(t_f)$ and sensitivity vectors $\\mathbf{S}_j(t_f)$.\n$7$. For each parameter $\\lambda_j$, calculate the final sensitivity of the product fraction using the extracted values:\n$$\n\\frac{\\partial f_1}{\\partial \\lambda_j} \\bigg|_{t=t_f} = \\frac{y_3(t_f) S_{2j}(t_f) - y_2(t_f) S_{3j}(t_f)}{\\left(y_2(t_f) + y_3(t_f)\\right)^2}\n$$\nThis procedure is implemented in the provided Python code, adhering to the specified numerical constants and producing the required output format.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves for the sensitivities of a product fraction in a parallel reversible\n    reaction network using forward sensitivity analysis.\n    \"\"\"\n    # Physical constants\n    K_B = 1.380649e-23  # J K^-1\n    H = 6.62607015e-34   # J s\n    R = 8.314462618e-3   # kJ mol^-1 K^-1\n    KAPPA = 1.0          # Transmission coefficient\n\n    # Initial concentrations\n    A0 = 1.0\n\n    # Test cases: (T, t_f, dG1_ddagger, dG2_ddagger, GP1, GP2)\n    test_cases = [\n        # Case K (Kinetic control)\n        (298.15, 1.0e-4, 60.0, 62.0, -10.0, -20.0),\n        # Case T (Thermodynamic control)\n        (298.15, 100.0, 60.0, 62.0, -10.0, -20.0),\n        # Case S (Symmetric channels)\n        (298.15, 1.0, 60.0, 60.0, -20.0, -20.0),\n        # Case C (Competing kinetics/thermodynamics)\n        (298.15, 0.1, 58.0, 66.0, -5.0, -30.0)\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        T, t_f, dG1_ddagger, dG2_ddagger, GP1, GP2 = case\n        params = np.array([dG1_ddagger, dG2_ddagger, GP1, GP2])\n\n        # Calculate thermodynamic and kinetic constants\n        beta = 1.0 / (R * T)\n        k0 = KAPPA * K_B * T / H\n\n        # Calculate rate constants\n        kf1 = k0 * np.exp(-beta * dG1_ddagger)\n        kf2 = k0 * np.exp(-beta * dG2_ddagger)\n        kr1 = k0 * np.exp(-beta * (dG1_ddagger - GP1))\n        kr2 = k0 * np.exp(-beta * (dG2_ddagger - GP2))\n\n        # Rate matrix K (Jacobian)\n        K = np.array([\n            [-(kf1 + kf2), kr1, kr2],\n            [kf1, -kr1, 0.0],\n            [kf2, 0.0, -kr2]\n        ])\n\n        def augmented_ode_system(t, z):\n            # Unpack state vector y and sensitivity vectors S_j\n            y = z[0:3]\n            S = z[3:].reshape((4, 3))\n\n            # State equation\n            dydt = K @ y\n\n            # Forcing terms for sensitivity equations\n            b1 = -beta * np.array([-(kf1 * y[0] - kr1 * y[1]), kf1 * y[0] - kr1 * y[1], 0.0])\n            b2 = -beta * np.array([-(kf2 * y[0] - kr2 * y[2]), 0.0, kf2 * y[0] - kr2 * y[2]])\n            b3 = beta * np.array([kr1 * y[1], -kr1 * y[1], 0.0])\n            b4 = beta * np.array([kr2 * y[2], 0.0, -kr2 * y[2]])\n            \n            b = [b1, b2, b3, b4]\n            \n            # Sensitivity equations\n            dSdt = np.zeros_like(S)\n            for j in range(4):\n                dSdt[j, :] = K @ S[j, :] + b[j]\n\n            # Combine derivatives into a single vector\n            dzdt = np.concatenate((dydt, dSdt.flatten()))\n            return dzdt\n\n        # Initial conditions for augmented system\n        z0 = np.zeros(15)\n        z0[0] = A0\n\n        # Solve the augmented ODE system\n        sol = solve_ivp(augmented_ode_system, [0, t_f], z0, method='Radau', rtol=1e-9, atol=1e-12)\n        \n        # Extract final state and sensitivities\n        z_final = sol.y[:, -1]\n        y_final = z_final[0:3]\n        S_final = z_final[3:].reshape((4, 3))\n        \n        y2_f, y3_f = y_final[1], y_final[2]\n        \n        # Calculate sensitivities of the product fraction f1\n        sensitivities = []\n        denom = (y2_f + y3_f)**2\n        \n        if abs(denom)  1e-16: # Avoid division by zero at t=0 or if no product forms\n             sensitivities = [0.0, 0.0, 0.0, 0.0]\n        else:\n            for j in range(4):\n                S2j_f, S3j_f = S_final[j, 1], S_final[j, 2]\n                df1_d_lambda_j = (y3_f * S2j_f - y2_f * S3j_f) / denom\n                sensitivities.append(df1_d_lambda_j)\n\n        all_results.append(sensitivities)\n    \n    # Format output string\n    # E.g., [[-0.123456,0.123456,...],[...]]\n    output_str = '[' + ','.join(\n        '[' + ','.join([f'{val:.6f}' for val in res]) + ']'\n        for res in all_results\n    ) + ']'\n    print(output_str)\n\nsolve()\n\n```", "id": "2650548"}]}