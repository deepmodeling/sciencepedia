{"hands_on_practices": [{"introduction": "To begin, let's explore a foundational concept in stochastic kinetics that distinguishes it from deterministic models: how to count reacting pairs. When two identical molecules must collide to react, we must be careful not to double-count the pairs. This exercise in homodimerization [@problem_id:1505768] challenges you to derive the propensity by correctly applying combinatorial principles to find the number of unique reactant pairs.", "problem": "In the study of stochastic chemical kinetics, the propensity function gives the probability per unit time that a specific reaction will occur in a well-mixed system. Consider a system containing a single chemical species, a monomer $M$. These monomers can undergo a homodimerization reaction to form a dimer $M_2$, represented by the chemical equation:\n$$2M \\to M_2$$\nLet $N_M$ be the number of monomer molecules $M$ present in the system at a given time, and let $c$ be the stochastic rate constant for this reaction.\n\nAssuming the system is well-mixed, determine the propensity function, $a(N_M)$, for the homodimerization reaction. Express your answer in terms of $N_M$ and $c$.", "solution": "In the stochastic formulation (Gillespie), the propensity function for a reaction equals the stochastic rate constant multiplied by the number of distinct reactant combinations available in the current state. For the homodimerization reaction $2M \\to M_{2}$ with $N_{M}$ monomers present, each reaction event requires choosing an unordered pair of $M$ molecules.\n\nThe number of unordered pairs that can be formed from $N_{M}$ identical reactants is the binomial coefficient\n$$\n\\binom{N_{M}}{2}=\\frac{N_{M}(N_{M}-1)}{2}.\n$$\nTherefore, the propensity function is\n$$\na(N_{M})=c \\binom{N_{M}}{2}=c\\,\\frac{N_{M}(N_{M}-1)}{2}.\n$$\nThis expression automatically yields zero when $N_{M}<2$, as required physically.", "answer": "$$\\boxed{\\frac{c\\,N_{M}(N_{M}-1)}{2}}$$", "id": "1505768"}, {"introduction": "Next, we consider a more common scenario in cell biology: a bimolecular reaction between two different species, such as an enzyme and its substrate. Unlike the previous case, counting reactant pairs is straightforward. This practice [@problem_id:1505771] focuses on another crucial skill: translating a macroscopic, concentration-based rate constant ($k_{phos}$) into a microscopic, molecule-based propensity function, revealing the fundamental role of system volume.", "problem": "In a simplified model of a cellular signaling network, a substrate protein $S$ is activated through phosphorylation by a kinase enzyme $K$. This activation process is a bimolecular reaction where the kinase acts as a catalyst and is not consumed. The reaction can be represented as:\n$$S + K \\rightarrow S_p + K$$\nwhere $S_p$ is the phosphorylated, active form of the substrate. This phosphorylation reaction is characterized by a second-order rate constant $k_{phos}$.\n\nThe reaction occurs within a cellular compartment that can be considered well-mixed and has a constant volume $V$. At a particular instant, the compartment contains $N_S$ molecules of the substrate $S$ and $N_K$ molecules of the kinase $K$. Concurrently, the substrate $S$ is also subject to degradation through a separate enzymatic process, but our focus is solely on the phosphorylation event.\n\nAssuming the principles of stochastic chemical kinetics, derive an expression for the propensity function, $a_{phos}$, for this specific phosphorylation reaction. Your final expression should be in terms of the parameters $k_{phos}$, $N_S$, $N_K$, and $V$.", "solution": "We model the elementary phosphorylation event as the bimolecular reaction $S + K \\rightarrow S_{p} + K$, where one $S$ molecule and one $K$ molecule must encounter. In stochastic chemical kinetics, the propensity $a_{phos}$ is the probability per unit time that this reaction fires in the next infinitesimal interval, given the current molecule counts. For an elementary reaction between two distinct reactants, mass-action kinetics gives the deterministic reaction rate (number of reaction events per unit time) as\n$$\nr = k_{phos} [S][K] V,\n$$\nwhere $[S] = N_{S}/V$ and $[K] = N_{K}/V$ are the concentrations and $V$ is the compartment volume. Substituting the concentrations yields\n$$\nr = k_{phos} \\left(\\frac{N_{S}}{V}\\right) \\left(\\frac{N_{K}}{V}\\right) V = \\frac{k_{phos}}{V} N_{S} N_{K}.\n$$\nIn the chemical master equation framework, this deterministic event rate equals the propensity for the corresponding stochastic reaction under the well-mixed assumption. Therefore,\n$$\na_{phos} = \\frac{k_{phos}}{V} N_{S} N_{K}.\n$$\nNo combinatorial factor is needed because the reactants are distinct species.", "answer": "$$\\boxed{\\frac{k_{phos}}{V} N_{S} N_{K}}$$", "id": "1505771"}, {"introduction": "Finally, let's synthesize the principles from the previous two exercises to tackle a more complex reaction. Many biological processes involve reactions with higher-order stoichiometry, where multiple copies of one molecule react with another. This problem [@problem_id:1505813] requires you to combine the combinatorial logic for identical reactants with the rules for distinct reactants, providing a robust method for constructing propensities for a wide range of elementary reactions.", "problem": "Inside a simplified model of a cellular compartment with a fixed volume, we are studying the formation of a protein complex. Two molecules of a protein, denoted as $P$, can bind with one molecule of a ligand, denoted as $L$, to form a stable complex, $P_2L$. This is an elementary reaction represented as:\n$$2P + L \\xRightarrow{c} P_2L$$\nThe parameter $c$ is the stochastic rate constant for this reaction. At a specific moment in time, the system contains $n_P$ molecules of protein $P$ and $n_L$ molecules of ligand $L$.\n\nThe propensity function, $a(x)$, for a reaction channel is defined such that $a(x)dt$ gives the probability that this specific reaction will occur in the next infinitesimal time interval $[t, t+dt)$, given the system state $x$.\n\nDetermine the propensity function for the formation of the complex $P_2L$ in terms of the stochastic rate constant $c$ and the molecular counts $n_P$ and $n_L$.", "solution": "We consider the elementary reaction $2P + L \\xRightarrow{c} P_{2}L$ in a well-mixed, fixed-volume compartment. In the stochastic simulation framework, the propensity function for an elementary reaction is given by the product of the stochastic rate constant and the number of distinct reactant combinations available in the current state. Specifically, if the system has $n_{P}$ molecules of $P$ and $n_{L}$ molecules of $L$, then the propensity is\n$$\na(x) = c\\,h(x),\n$$\nwhere $h(x)$ is the number of distinct ordered reactant groupings that can undergo the reaction. For the reaction $2P+L$, this is the number of ways to choose $2$ molecules from the $n_{P}$ identical $P$ molecules and $1$ molecule from the $n_{L}$ identical $L$ molecules:\n$$\nh(x) = \\binom{n_{P}}{2}\\binom{n_{L}}{1}.\n$$\nUsing the binomial coefficient identities $\\binom{n_{P}}{2} = \\frac{n_{P}(n_{P}-1)}{2}$ and $\\binom{n_{L}}{1} = n_{L}$, we obtain\n$$\nh(x) = \\frac{n_{P}(n_{P}-1)}{2}\\,n_{L}.\n$$\nTherefore, the propensity function is\n$$\na(x) = c\\,\\frac{n_{P}(n_{P}-1)}{2}\\,n_{L}.\n$$\nThis expression correctly yields zero when $n_{P}<2$ or $n_{L}<1$, as required by the combinatorial factors.", "answer": "$$\\boxed{\\frac{c}{2}\\,n_{P}\\,(n_{P}-1)\\,n_{L}}$$", "id": "1505813"}]}