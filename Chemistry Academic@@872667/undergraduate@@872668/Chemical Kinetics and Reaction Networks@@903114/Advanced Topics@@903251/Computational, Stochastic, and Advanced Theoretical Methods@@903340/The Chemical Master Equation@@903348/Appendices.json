{"hands_on_practices": [{"introduction": "We begin with the most fundamental stochastic process: the decay of a single particle. This exercise [@problem_id:1517936] strips away the complexity of multi-component systems to focus on the core concept of how a macroscopic rate constant, $k$, governs the probability of an individual reaction event over time. By solving for the probability of decay, you will directly derive the exponential waiting-time distribution that is the cornerstone of first-order stochastic kinetics.", "problem": "The spontaneous decay of a single excited atom into its ground state can be modeled as a stochastic unimolecular reaction, $A \\xrightarrow{k} \\emptyset$. Here, $A$ represents the atom in its excited state, $\\emptyset$ represents the ground state, and $k$ is the constant decay rate. Suppose we prepare a system at time $t=0$ such that it contains exactly one atom, and it is known with certainty to be in the excited state.\n\nDetermine the probability that this atom has decayed to its ground state by time $t$. Your answer should be a closed-form analytic expression in terms of the parameters $k$ and $t$.", "solution": "Let $P_{e}(t)$ be the probability that the atom is still in the excited state at time $t$. For a unimolecular decay $A \\xrightarrow{k} \\emptyset$ with constant rate $k$, the survival probability satisfies the first-order linear differential equation\n$$\n\\frac{dP_{e}(t)}{dt}=-k\\,P_{e}(t),\n$$\nwith initial condition $P_{e}(0)=1$ since the atom is certainly excited at $t=0$. Solve by separation of variables:\n$$\n\\frac{dP_{e}}{P_{e}}=-k\\,dt.\n$$\nIntegrate from $t=0$ to $t$:\n$$\n\\int_{1}^{P_{e}(t)}\\frac{dP_{e}'}{P_{e}'}=-k\\int_{0}^{t}dt',\n$$\nwhich gives\n$$\n\\ln\\left(P_{e}(t)\\right)-\\ln(1)=-k t \\quad \\Rightarrow \\quad \\ln\\left(P_{e}(t)\\right)=-k t.\n$$\nExponentiating yields the survival probability\n$$\nP_{e}(t)=\\exp(-k t).\n$$\nTherefore, the probability that the atom has decayed by time $t$ is the complement of the survival probability:\n$$\nP_{\\text{decay by }t}=1-P_{e}(t)=1-\\exp(-k t).\n$$", "answer": "$$\\boxed{1-\\exp(-k t)}$$", "id": "1517936"}, {"introduction": "Building on the single-event case, we now consider a dynamic population of molecules maintained by constant production and linear degradation. This \"birth-death\" model is a cornerstone for understanding stochasticity in gene expression. In this practice [@problem_id:1517880], you will learn to calculate key statistical properties—the mean and variance—of the molecule count at steady state, providing a quantitative measure of intrinsic noise within the cell.", "problem": "Consider a simplified model for the stochastic production and degradation of a single type of protein, denoted by $X$, within a cell. Molecules of $X$ are produced one at a time through a process that can be modeled with a constant probability rate. The probability of a single production event occurring in an infinitesimal time interval $dt$ is given by $k_1 dt$, where $k_1$ is the production rate constant. Simultaneously, each existing molecule of $X$ has a constant probability of degrading in the same time interval $dt$. This probability is given by $k_2 dt$ for each molecule, where $k_2$ is the degradation rate constant. Therefore, if there are $n$ molecules of $X$ present, the total probability of one degradation event occurring in the interval $dt$ is $n k_2 dt$.\n\nAfter a sufficiently long time, the system reaches a statistical steady state, where the probability distribution of the number of molecules, $P(n)$, no longer changes with time. For this steady-state distribution, determine the variance, defined as $\\text{Var}(n) = \\langle n^2 \\rangle - \\langle n \\rangle^2$.\n\nExpress your answer as a closed-form analytic expression in terms of the constants $k_1$ and $k_2$.", "solution": "We model the system as a birth-death process with constant birth rate $k_{1}$ and per-molecule death rate $k_{2}$. Let $n$ be the number of molecules. For any function $f(n)$, the chemical master equation implies the evolution of its expectation:\n$$\n\\frac{d\\langle f(n)\\rangle}{dt}=\\left\\langle k_{1}\\left[f(n+1)-f(n)\\right]+n k_{2}\\left[f(n-1)-f(n)\\right]\\right\\rangle.\n$$\n\nFirst, choose $f(n)=n$. Using $(n+1)-n=1$ and $(n-1)-n=-1$, we obtain\n$$\n\\frac{d\\langle n\\rangle}{dt}=\\left\\langle k_{1}\\cdot 1+n k_{2}\\cdot(-1)\\right\\rangle=k_{1}-k_{2}\\langle n\\rangle.\n$$\nAt steady state, $d\\langle n\\rangle/dt=0$, so\n$$\n\\langle n\\rangle=\\frac{k_{1}}{k_{2}}.\n$$\n\nNext, choose $f(n)=n^{2}$. Using $(n+1)^{2}-n^{2}=2n+1$ and $(n-1)^{2}-n^{2}=-2n+1$, we get\n$$\n\\frac{d\\langle n^{2}\\rangle}{dt}=\\left\\langle k_{1}(2n+1)+n k_{2}(-2n+1)\\right\\rangle=2k_{1}\\langle n\\rangle+k_{1}-2k_{2}\\langle n^{2}\\rangle+k_{2}\\langle n\\rangle.\n$$\nRearranging,\n$$\n\\frac{d\\langle n^{2}\\rangle}{dt}=-2k_{2}\\langle n^{2}\\rangle+(2k_{1}+k_{2})\\langle n\\rangle+k_{1}.\n$$\nAt steady state, $d\\langle n^{2}\\rangle/dt=0$, so\n$$\n\\langle n^{2}\\rangle=\\frac{(2k_{1}+k_{2})\\langle n\\rangle+k_{1}}{2k_{2}}.\n$$\nSubstituting $\\langle n\\rangle=k_{1}/k_{2}$ gives\n$$\n\\langle n^{2}\\rangle=\\frac{(2k_{1}+k_{2})\\frac{k_{1}}{k_{2}}+k_{1}}{2k_{2}}=\\frac{2k_{1}^{2}}{2k_{2}^{2}}+\\frac{k_1k_2}{2k_2^2} + \\frac{k_1}{2k_2} = \\frac{k_{1}^{2}}{k_{2}^{2}}+\\frac{k_{1}}{2k_{2}}+\\frac{k_{1}}{2k_{2}} = \\frac{k_{1}^{2}}{k_{2}^{2}}+\\frac{k_{1}}{k_{2}}.\n$$\n\nTherefore, the variance is\n$$\n\\text{Var}(n)=\\langle n^{2}\\rangle-\\langle n\\rangle^{2}=\\left(\\frac{k_{1}^{2}}{k_{2}^{2}}+\\frac{k_{1}}{k_{2}}\\right)-\\left(\\frac{k_{1}}{k_{2}}\\right)^{2}=\\frac{k_{1}}{k_{2}}.\n$$", "answer": "$$\\boxed{\\frac{k_{1}}{k_{2}}}$$", "id": "1517880"}, {"introduction": "Finally, we explore a system with non-linear dynamics: autocatalysis, where a species promotes its own production. Such feedback is common in biology but can lead to dramatic outcomes, including the complete disappearance of a population. This problem [@problem_id:1517928] challenges you to calculate the probability of extinction over time, introducing a powerful analytical technique for studying systems with an \"absorbing\" state at zero population.", "problem": "Consider a population of self-replicating agents, $X$. The number of agents, $n$, in a system changes due to two stochastic processes:\n\n1.  **Replication:** An existing agent creates a new one in an autocatalytic process. The propensity (rate) for the total number of agents to increase by one ($n \\to n+1$) is given by $\\lambda(n) = c n$.\n2.  **Removal:** An agent is removed from the system, for instance, due to degradation or death. The propensity for the total number of agents to decrease by one ($n \\to n-1$) is given by $\\mu(n) = \\gamma n$.\n\nHere, $c$ and $\\gamma$ are positive rate constants. Note that when the population size is zero ($n=0$), the propensities for both replication and removal are zero, meaning if the population happens to reach zero agents, it will remain at zero for all future times.\n\nIf the system starts with an initial population of exactly $n_0$ agents at time $t=0$, what is the probability, $P_{ext}(t)$, that the population has gone extinct by time $t$? Express your answer as a function of $n_0, c, \\gamma$, and $t$. Assume $c \\neq \\gamma$.", "solution": "Let $\\lambda=c$ and $\\mu=\\gamma$. Define $q(t)$ as the extinction probability by time $t$ starting from a single agent. Over a small interval $\\Delta t$, using the Markov and branching properties:\n- With probability $\\mu \\Delta t$, the agent is removed immediately and extinction occurs.\n- With probability $\\lambda \\Delta t$, the agent replicates to two independent lineages, so extinction by time $t$ occurs if both lineages go extinct by time $t$, which happens with probability $q(t)^{2}$.\n- With probability $1-(\\lambda+\\mu)\\Delta t$, no event occurs and the extinction probability remains $q(t)$.\n\nTherefore,\n$$\nq(t+\\Delta t)=\\mu \\Delta t \\cdot 1+\\lambda \\Delta t \\cdot q(t)^{2}+\\bigl(1-(\\lambda+\\mu)\\Delta t\\bigr) q(t)+o(\\Delta t).\n$$\nRearranging,\n$$\n\\frac{q(t+\\Delta t)-q(t)}{\\Delta t}=\\lambda\\bigl(q(t)^{2}-q(t)\\bigr)+\\mu\\bigl(1-q(t)\\bigr)+o(1).\n$$\nTaking $\\Delta t\\to 0$ gives the Riccati ordinary differential equation\n$$\n\\frac{dq}{dt}=\\lambda q^{2}-(\\lambda+\\mu)q+\\mu=\\lambda\\bigl(q-1\\bigr)\\bigl(q-\\tfrac{\\mu}{\\lambda}\\bigr),\\quad q(0)=0.\n$$\nSeparate variables and integrate:\n$$\n\\int \\frac{dq}{(q-1)\\left(q-\\frac{\\mu}{\\lambda}\\right)}=\\lambda \\int dt.\n$$\nUsing partial fractions with $\\alpha=\\frac{\\mu}{\\lambda}$, we have\n$$\n\\frac{1}{(q-1)(q-\\alpha)}=\\frac{1}{1-\\alpha}\\left(\\frac{1}{q-1}-\\frac{1}{q-\\alpha}\\right),\n$$\nso\n$$\n\\frac{1}{1-\\alpha}\\ln\\left|\\frac{q-1}{q-\\alpha}\\right|=\\lambda t+C'.\n$$\nThis gives\n$$\n\\ln\\left|\\frac{q-1}{q-\\alpha}\\right| = \\lambda (1-\\alpha) t + C = (\\lambda-\\mu) t + C.\n$$\nApply the initial condition $q(0)=0$, which gives\n$$\n\\left.\\ln\\left|\\frac{q-1}{q-\\alpha}\\right|\\right|_{t=0}=\\ln\\left(\\frac{1}{\\alpha}\\right),\n$$\nhence\n$$\n\\ln\\left(\\frac{1-q}{\\alpha-q}\\right)=(\\lambda-\\mu)t+\\ln\\left(\\frac{1}{\\alpha}\\right).\n$$\nExponentiating and solving for $q$ yields\n$$\n\\frac{1-q}{\\alpha-q}=\\frac{1}{\\alpha}\\exp\\bigl((\\lambda-\\mu)t\\bigr) \\implies q(t) = \\frac{\\alpha\\left(\\exp\\bigl((\\lambda-\\mu)t\\bigr)-1\\right)}{\\exp\\bigl((\\lambda-\\mu)t\\bigr)-\\alpha}.\n$$\nMultiplying numerator and denominator by $\\exp\\bigl(-(\\lambda-\\mu)t\\bigr)$ gives\n$$\nq(t)=\\frac{\\alpha\\bigl(1-\\exp\\bigl(-(\\lambda-\\mu)t\\bigr)\\bigr)}{1-\\alpha\\exp\\bigl(-(\\lambda-\\mu)t\\bigr)} = \\frac{\\frac{\\mu}{\\lambda}\\bigl(1-\\exp\\bigl(-(\\lambda-\\mu)t\\bigr)\\bigr)}{1-\\frac{\\mu}{\\lambda}\\exp\\bigl(-(\\lambda-\\mu)t\\bigr)} = \\frac{\\mu\\bigl(1-\\exp\\bigl(-(\\lambda-\\mu)t\\bigr)\\bigr)}{\\lambda-\\mu\\exp\\bigl(-(\\lambda-\\mu)t\\bigr)}.\n$$\nBy the branching property, starting from $n_{0}$ independent agents, extinction by time $t$ occurs if all lineages are extinct by time $t$, so\n$$\nP_{ext}(t)=\\bigl[q(t)\\bigr]^{n_{0}}=\\left(\\frac{\\mu\\left(1-\\exp\\bigl(-(\\lambda-\\mu)t\\bigr)\\right)}{\\lambda-\\mu\\exp\\bigl(-(\\lambda-\\mu)t\\bigr)}\\right)^{n_{0}}.\n$$\nSubstituting back $\\lambda=c$ and $\\mu=\\gamma$ (with $c\\neq \\gamma$) gives\n$$\nP_{ext}(t)=\\left(\\frac{\\gamma\\left(1-\\exp\\bigl(-(c-\\gamma)t\\bigr)\\right)}{c-\\gamma\\exp\\bigl(-(c-\\gamma)t\\bigr)}\\right)^{n_{0}}.\n$$", "answer": "$$\\boxed{\\left(\\frac{\\gamma\\left(1-\\exp\\left(-(c-\\gamma)t\\right)\\right)}{c-\\gamma\\exp\\left(-(c-\\gamma)t\\right)}\\right)^{n_{0}}}$$", "id": "1517928"}]}