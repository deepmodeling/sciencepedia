{"hands_on_practices": [{"introduction": "The dissociation of the simple hydrogen molecule, $H_2$, serves as a fundamental test for the reliability of any electronic structure method. This exercise explores a classic failure of standard Generalized Gradient Approximation (GGA) functionals known as static correlation error. By comparing the behavior of a pure GGA functional to a hybrid functional in the bond-breaking limit, you will gain a conceptual understanding of why the inclusion of exact exchange is crucial for describing such processes correctly. [@problem_id:1373562]", "problem": "In the context of Density Functional Theory (DFT), the choice of the exchange-correlation functional is critical for accurately modeling chemical systems. Consider the symmetric dissociation of a hydrogen molecule (H$_2$) into two separate, neutral hydrogen atoms (H + H). We can model this process by calculating the system's ground state electronic energy, $E$, as a function of the internuclear distance, $R$.\n\nLet's compare two types of functionals:\n1.  A pure Generalized Gradient Approximation (GGA) functional, where the exchange-correlation energy depends on the electron density and its gradient.\n2.  A hybrid functional, which is constructed by mixing a fraction, $a$, of \"exact\" exchange from Hartree-Fock (HF) theory with a GGA functional. The exchange-correlation energy for a typical hybrid functional can be expressed as:\n    $E_{\\text{xc}}^{\\text{hybrid}} = a E_{\\text{x}}^{\\text{HF}} + (1-a)E_{\\text{x}}^{\\text{GGA}} + E_{\\text{c}}^{\\text{GGA}}$\n    where $E_{\\text{x}}^{\\text{HF}}$ is the HF exchange energy, $E_{\\text{x}}^{\\text{GGA}}$ is the GGA exchange energy, and $E_{\\text{c}}^{\\text{GGA}}$ is the GGA correlation energy. Assume $a$ is a constant between 0 and 1 (e.g., $a=0.25$).\n\nIt is a known issue that pure GGA functionals suffer from a \"static correlation error\" (also related to delocalization or self-interaction error), which becomes particularly severe in bond-breaking scenarios like this one. This error causes the GGA-calculated energy of the two separated atoms ($R \\to \\infty$) to be significantly higher than the true energy, which should simply be the sum of the energies of two isolated hydrogen atoms. The HF method, in contrast, correctly describes the energy of the dissociated H$_2$ molecule.\n\nGiven this information, which of the following statements best describes the relationship between the potential energy predicted by the hybrid functional, $E_{\\text{hybrid}}(R)$, and the one predicted by the pure GGA functional, $E_{\\text{GGA}}(R)$, in the limit of large internuclear separation ($R \\to \\infty$)?\n\nA. $E_{\\text{hybrid}}(R \\to \\infty)$ is lower than $E_{\\text{GGA}}(R \\to \\infty)$.\n\nB. $E_{\\text{hybrid}}(R \\to \\infty)$ is higher than $E_{\\text{GGA}}(R \\to \\infty)$.\n\nC. $E_{\\text{hybrid}}(R \\to \\infty)$ is identical to $E_{\\text{GGA}}(R \\to \\infty)$.\n\nD. The calculation with the hybrid functional fails to converge at large $R$, so its energy cannot be determined.\n\nE. Both functionals predict the correct dissociation energy, but the hybrid functional provides a better description of the bond length near equilibrium.", "solution": "We consider the total ground-state energy written in Kohnâ€“Sham form for a method $M$ (GGA, HF, hybrid) as\n$$\nE_{M}(R)=\\min_{n}\\Big[T_{s}[n]+V_{ne}(n;R)+J[n]+E_{xc}^{M}[n]\\Big].\n$$\nIn the dissociation limit $R\\to\\infty$, the system separates into two noninteracting hydrogen atoms, so the minimizing density factorizes as a sum of two one-electron densities and the total energy decomposes into a sum of two identical one-atom contributions:\n$$\nE_{M}(R\\to\\infty)=2\\,E_{M}^{\\text{atom}}.\n$$\nFor a one-electron density $n_{H}$, two exact identities hold:\n$$\nE_{c}^{\\text{exact}}[n_{H}]=0,\\qquad E_{x}^{\\text{HF}}[n_{H}]=-J[n_{H}],\n$$\ni.e., there is no true correlation and the Hartree self-interaction is exactly canceled by HF exchange.\n\nPure GGA functionals suffer from self-interaction/delocalization error for one-electron densities, which can be summarized as\n$$\nE_{x}^{\\text{GGA}}[n_{H}]+J[n_{H}]>0,\n$$\nand typically $E_{c}^{\\text{GGA}}[n_{H}]$ does not correct this to zero for the one-electron case. Consequently, the atomic energy evaluated with a GGA lies above the exact one, so we can write\n$$\nE_{\\text{GGA}}(R\\to\\infty)=2E_{H}+ \\Delta_{\\text{GGA}},\\qquad \\Delta_{\\text{GGA}}>0,\n$$\nwhere $E_{H}$ is the exact energy of the hydrogen atom and $\\Delta_{\\text{GGA}}$ is the static-correlation/self-interaction error at dissociation.\n\nA hybrid functional mixes a fraction $a\\in(0,1)$ of HF exchange with GGA exchange and retains GGA correlation:\n$$\nE_{xc}^{\\text{hybrid}}=a E_{x}^{\\text{HF}}+(1-a)E_{x}^{\\text{GGA}}+E_{c}^{\\text{GGA}}.\n$$\nFor the one-electron density $n_{H}$, the difference in exchange-correlation energies between the hybrid and the GGA is\n$$\n\\Delta E_{xc}[n_{H}]\\equiv E_{xc}^{\\text{hybrid}}[n_{H}]-E_{xc}^{\\text{GGA}}[n_{H}]\n=a\\big(E_{x}^{\\text{HF}}[n_{H}]-E_{x}^{\\text{GGA}}[n_{H}]\\big).\n$$\nUsing $E_{x}^{\\text{HF}}[n_{H}]=-J[n_{H}]$ and the fact that $E_{x}^{\\text{GGA}}[n_{H}]>-J[n_{H}]$ (GGA does not fully cancel the Hartree self-interaction), we have\n$$\nE_{x}^{\\text{HF}}[n_{H}]-E_{x}^{\\text{GGA}}[n_{H}]<0\n\\quad\\Rightarrow\\quad\n\\Delta E_{xc}[n_{H}]<0\\quad\\text{for any}\\ a>0.\n$$\nTherefore, at fixed one-electron density, the hybrid lowers the exchange-correlation energy relative to the GGA. Since, in the dissociation limit, the total energy is the sum over two one-electron fragments and the other energy terms $T_{s}[n]$, $V_{ne}(n;R)$, and $J[n]$ are identical for a fixed density, the hybrid total energy at $R\\to\\infty$ satisfies\n$$\nE_{\\text{hybrid}}(R\\to\\infty)\\le E_{\\text{GGA}}(R\\to\\infty),\n$$\nwith strict inequality for any $a>0$ because the self-interaction/delocalization error is reduced by the HF exchange component. Moreover, the limit $a\\to 1$ recovers HF, for which $E_{\\text{HF}}(R\\to\\infty)=2E_{H}$ (with spin-symmetry breaking), so the hybrid energy approaches the correct dissociation limit from above as $a$ increases.\n\nCombining these facts,\n$$\nE_{\\text{hybrid}}(R\\to\\infty) < E_{\\text{GGA}}(R\\to\\infty).\n$$\nThis corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "1373562"}, {"introduction": "A key theoretical property of the exact energy functional is that its energy should vary linearly as electrons are fractionally added to or removed from a system between integer values. This exercise provides a quantitative look at how common approximate functionals violate this principle, a shortcoming known as delocalization or self-interaction error. By modeling the energy of a chlorine atom with a fractional number of electrons, you will see how this error leads to a spurious stabilization of delocalized charges and how hybrid functionals mitigate this unphysical behavior. [@problem_id:1373539]", "problem": "In Density Functional Theory (DFT), the total energy of a system as a function of the number of electrons, $E(N)$, should ideally be a piecewise linear function with kinks at integer electron numbers. However, many approximate exchange-correlation functionals, such as those based on the Generalized Gradient Approximation (GGA), exhibit a spurious convexity. This \"delocalization error\" artificially favors fractional electron counts on separated fragments. Hybrid functionals, which incorporate a fraction of exact exchange, typically reduce this error.\n\nConsider a single chlorine atom (Cl). For fractional electron numbers in the range $N \\in [17, 18]$, let the number of electrons be represented as $N = 17 + \\delta$, where $\\delta \\in [0, 1]$. We model the total energy as calculated by a GGA functional and a hybrid functional as:\n$$E_{\\text{GGA}}(17+\\delta) = (1-\\delta)E(17) + \\delta E(18) - C_{\\text{GGA}}\\delta(1-\\delta)$$\n$$E_{\\text{hyb}}(17+\\delta) = (1-\\delta)E(17) + \\delta E(18) - C_{\\text{hyb}}\\delta(1-\\delta)$$\nwhere $E(17)$ and $E(18)$ are the exact total energies of the neutral Cl atom and the Cl$^{-}$ anion, respectively. The positive constants $C_{\\text{GGA}}$ and $C_{\\text{hyb}}$ quantify the convexity, or the severity of the delocalization error, for each functional.\n\nThe values for these parameters are given as:\n- Energy of the neutral chlorine atom, $E(17) = -459.642 \\text{ Hartree}$\n- Energy of the chlorine anion, $E(18) = -459.775 \\text{ Hartree}$\n- GGA convexity parameter, $C_{\\text{GGA}} = 0.210 \\text{ Hartree}$\n- Hybrid functional convexity parameter, $C_{\\text{hyb}} = 0.055 \\text{ Hartree}$\n\nNow, consider a system composed of two identical, non-interacting chlorine atoms. If one electron is added to this two-atom system, the correct ground state corresponds to the electron localizing on one atom, forming a [Cl, Cl$^-$] pair. However, due to delocalization error, an approximate functional might incorrectly predict a lower energy for a state where the electron is delocalized over both atoms, resulting in a [Cl$^{-0.5}$, Cl$^{-0.5}$] system.\n\nCalculate the ratio of the spurious delocalization stabilization energy for the GGA functional to that for the hybrid functional. The spurious delocalization stabilization energy is defined as the energy of the delocalized state [Cl$^{-0.5}$, Cl$^{-0.5}$] minus the energy of the correct localized state [Cl, Cl$^-$]. Round your final answer to three significant figures.", "solution": "For a single atom with $N=17+\\delta$, the approximate energy with a given functional characterized by convexity parameter $C$ is\n$$\nE_{\\text{fun}}(17+\\delta)=(1-\\delta)E(17)+\\delta E(18)-C\\,\\delta(1-\\delta).\n$$\nFor two non-interacting chlorine atoms with one extra electron, the localized state [Cl, Cl$^{-}$] has one atom at $\\delta=0$ and the other at $\\delta=1$, so its total energy is\n$$\nE_{\\text{loc}}=E_{\\text{fun}}(17)+E_{\\text{fun}}(18)=E(17)+E(18).\n$$\nThe delocalized state [Cl$^{-0.5}$, Cl$^{-0.5}$] has each atom at $\\delta=\\frac{1}{2}$, giving per-atom energy\n$$\nE_{\\text{fun}}(17+\\tfrac{1}{2})=\\tfrac{1}{2}E(17)+\\tfrac{1}{2}E(18)-C\\left(\\tfrac{1}{2}\\right)\\left(1-\\tfrac{1}{2}\\right)=\\tfrac{1}{2}E(17)+\\tfrac{1}{2}E(18)-\\tfrac{C}{4}.\n$$\nThus the total energy of the delocalized state is\n$$\nE_{\\text{deloc}}=2E_{\\text{fun}}(17+\\tfrac{1}{2})=E(17)+E(18)-\\tfrac{C}{2}.\n$$\nThe spurious delocalization stabilization energy (delocalized minus localized) is therefore\n$$\n\\Delta E_{\\text{fun}}=E_{\\text{deloc}}-E_{\\text{loc}}=-\\tfrac{C}{2}.\n$$\nHence, the ratio of the GGA to hybrid stabilization energies is\n$$\nR=\\frac{\\Delta E_{\\text{GGA}}}{\\Delta E_{\\text{hyb}}}=\\frac{-\\tfrac{C_{\\text{GGA}}}{2}}{-\\tfrac{C_{\\text{hyb}}}{2}}=\\frac{C_{\\text{GGA}}}{C_{\\text{hyb}}}.\n$$\nInserting the given values,\n$$\nR=\\frac{0.210}{0.055}=\\frac{210}{55}=\\frac{42}{11}\\approx 3.81818\\ldots\n$$\nRounded to three significant figures, this is $3.82$.", "answer": "$$\\boxed{3.82}$$", "id": "1373539"}, {"introduction": "While hybrid functionals offer significant improvements in accuracy, these benefits come with a substantial increase in computational cost, a trade-off central to practical computational chemistry. This problem illustrates the different computational scaling laws that govern GGA and hybrid functional calculations. By analyzing benchmark data, you will see how the relative cost of using a hybrid functional changes dramatically as the size of the molecular system increases, highlighting the practical limits of their application. [@problem_id:1373556]", "problem": "A computational chemistry research group is investigating the electronic properties of a series of newly synthesized polymer chains. Before committing to a large-scale study, they perform benchmark calculations on a small monomer unit to compare the cost of different theoretical methods. The monomer system is described using a basis set consisting of $N_{small} = 400$ basis functions.\n\nThe group performs two single-point energy calculations on this monomer:\n1.  Using a Generalized Gradient Approximation (GGA) functional, the calculation takes $T_{GGA, small} = 5.00$ minutes to complete.\n2.  Using a hybrid functional, which incorporates a fraction of exact Hartree-Fock (HF) exchange, the calculation takes $T_{Hybrid, small} = 24.0$ minutes to complete.\n\nFor the class of molecules and the software being used, it is known that the computational time for a GGA calculation scales approximately with the cube of the number of basis functions ($N^3$), while the time for a hybrid functional calculation is dominated by the exact exchange component and scales with the fourth power of the number of basis functions ($N^4$).\n\nThe group now wishes to study a larger oligomer from the series, which requires a basis set of $N_{large} = 2000$ basis functions. Based on the benchmark results and the known scaling behaviors, calculate the expected ratio of the computational time for the hybrid functional to the GGA functional, i.e., $T_{Hybrid, large} / T_{GGA, large}$, for this larger system.\n\nRound your final answer to three significant figures.", "solution": "Let the GGA time scale as $T_{\\mathrm{GGA}}(N)=A N^{3}$ and the hybrid time as $T_{\\mathrm{Hybrid}}(N)=B N^{4}$, where $A$ and $B$ are method- and code-dependent prefactors.\n\nFrom the small-system benchmarks with $N_{\\mathrm{small}}$,\n$$\nA=\\frac{T_{\\mathrm{GGA,small}}}{N_{\\mathrm{small}}^{3}},\\qquad B=\\frac{T_{\\mathrm{Hybrid,small}}}{N_{\\mathrm{small}}^{4}}.\n$$\nFor the large system with $N_{\\mathrm{large}}$, the ratio is\n$$\n\\frac{T_{\\mathrm{Hybrid,large}}}{T_{\\mathrm{GGA,large}}}\n=\\frac{B N_{\\mathrm{large}}^{4}}{A N_{\\mathrm{large}}^{3}}\n=\\frac{B}{A}N_{\\mathrm{large}}\n=\\left(\\frac{T_{\\mathrm{Hybrid,small}}/N_{\\mathrm{small}}^{4}}{T_{\\mathrm{GGA,small}}/N_{\\mathrm{small}}^{3}}\\right) N_{\\mathrm{large}}\n=\\left(\\frac{T_{\\mathrm{Hybrid,small}}}{T_{\\mathrm{GGA,small}}}\\right)\\left(\\frac{N_{\\mathrm{large}}}{N_{\\mathrm{small}}}\\right).\n$$\nSubstituting the given values $T_{\\mathrm{Hybrid,small}}=24.0$, $T_{\\mathrm{GGA,small}}=5.00$, $N_{\\mathrm{large}}=2000$, and $N_{\\mathrm{small}}=400$,\n$$\n\\frac{T_{\\mathrm{Hybrid,large}}}{T_{\\mathrm{GGA,large}}}\n=\\left(\\frac{24.0}{5.00}\\right)\\left(\\frac{2000}{400}\\right)=4.8\\times 5=24.0.\n$$\nRounded to three significant figures, the result is $24.0$.", "answer": "$$\\boxed{24.0}$$", "id": "1373556"}]}