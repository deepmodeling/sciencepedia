{"hands_on_practices": [{"introduction": "In any quantum calculation for a molecule, we must first define the potential created by the atomic nuclei. This potential, known as the external potential $v_{ext}(\\vec{r})$ in DFT, represents the classical electrostatic attraction between the electrons and the fixed nuclei. This exercise [@problem_id:2088800] solidifies your understanding of this fundamental term, which is the starting point for setting up a DFT calculation for any atom or molecule.", "problem": "In the framework of Density Functional Theory (DFT), the properties of a many-electron system are determined by its ground-state electron density. The theory's practical application, through the Kohn-Sham equations, involves solving a Schrödinger-like equation for non-interacting electrons moving in an effective potential. This effective potential includes a term called the external potential, $v_{ext}(\\vec{r})$, which represents the interaction of the electrons with the fixed atomic nuclei.\n\nConsider a heteronuclear diatomic molecule composed of two nuclei, A and B. Nucleus A has an atomic number $Z_A$ and is located at a fixed position vector $\\vec{R}_A$. Nucleus B has an atomic number $Z_B$ and is located at a fixed position vector $\\vec{R}_B$.\n\nDetermine the mathematical expression for the total external potential, $v_{ext}(\\vec{r})$, experienced by a single electron at an arbitrary position vector $\\vec{r}$. Your answer should be expressed in terms of the elementary charge $e$, the vacuum permittivity $\\epsilon_0$, the atomic numbers $Z_A$ and $Z_B$, and the position vectors $\\vec{r}$, $\\vec{R}_A$, and $\\vec{R}_B$.", "solution": "In Kohn-Sham DFT, the external potential $v_{ext}(\\vec{r})$ is the Coulomb interaction energy between the electron (charge $-e$) at position $\\vec{r}$ and the fixed nuclei. By Coulomb’s law, the potential energy between point charges $q_{1}$ at $\\vec{r}$ and $q_{2}$ at $\\vec{R}$ is\n$$\nV(\\vec{r})=\\frac{1}{4\\pi\\epsilon_{0}}\\frac{q_{1}q_{2}}{|\\vec{r}-\\vec{R}|}.\n$$\nFor nucleus A with charge $q_{A}=Z_{A}e$ at $\\vec{R}_{A}$ and the electron with charge $q_{e}=-e$ at $\\vec{r}$, the contribution is\n$$\nV_{A}(\\vec{r})=\\frac{1}{4\\pi\\epsilon_{0}}\\frac{(-e)(Z_{A}e)}{|\\vec{r}-\\vec{R}_{A}|}=-\\frac{Z_{A}e^{2}}{4\\pi\\epsilon_{0}|\\vec{r}-\\vec{R}_{A}|}.\n$$\nSimilarly, for nucleus B with charge $q_{B}=Z_{B}e$ at $\\vec{R}_{B}$,\n$$\nV_{B}(\\vec{r})=-\\frac{Z_{B}e^{2}}{4\\pi\\epsilon_{0}|\\vec{r}-\\vec{R}_{B}|}.\n$$\nBy the superposition principle, the total external potential is the sum of these contributions:\n$$\nv_{ext}(\\vec{r})=V_{A}(\\vec{r})+V_{B}(\\vec{r})=-\\frac{e^{2}}{4\\pi\\epsilon_{0}}\\left(\\frac{Z_{A}}{|\\vec{r}-\\vec{R}_{A}|}+\\frac{Z_{B}}{|\\vec{r}-\\vec{R}_{B}|}\\right).\n$$", "answer": "$$\\boxed{-\\frac{e^{2}}{4\\pi\\epsilon_{0}}\\left(\\frac{Z_{A}}{|\\vec{r}-\\vec{R}_{A}|}+\\frac{Z_{B}}{|\\vec{r}-\\vec{R}_{B}|}\\right)}$$", "id": "2088800"}, {"introduction": "The core promise of DFT is that the total energy of a system is uniquely determined by its electron density. This principle can be demonstrated explicitly for simple systems, where the energy can be calculated as a \"functional\" of the density. By applying the von Weizsäcker kinetic energy functional to the familiar particle-in-a-box model, this practice [@problem_id:2088771] provides a concrete, hands-on example of how an energy functional works, bridging the gap between abstract theory and practical calculation.", "problem": "An electron of mass $m$ is confined to a one-dimensional region of length $L$, extending from $x=0$ to $x=L$. The potential energy inside this region is zero, while it is infinite outside. This system constitutes a one-dimensional \"particle in a box\".\n\nA central concept in Density Functional Theory (DFT) is that the energy of a quantum system can be determined from its electron density, $n(x)$. For certain simple systems, the kinetic energy can be expressed using the von Weizsäcker functional. In our one-dimensional case, this is given by:\n$$T[n] = \\frac{\\hbar^2}{8m} \\int_0^L \\frac{(n'(x))^2}{n(x)} dx$$\nwhere $n'(x)$ is the derivative of the density with respect to position, $\\frac{dn}{dx}$, and $\\hbar$ is the reduced Planck constant. For the ground state of this specific system, the potential energy is zero everywhere the electron can be found, so the total energy $E$ is purely kinetic, i.e., $E = T[n]$.\n\nThe ground-state electron density for the electron in this box is given by the functional form $n(x) = A \\sin^2\\left(\\frac{\\pi x}{L}\\right)$, where $A$ is a normalization constant.\n\nFirst, determine the value of the constant $A$ by requiring that the integral of the density over the length of the box corresponds to a single electron. Then, using this normalized density, evaluate the von Weizsäcker functional to find the ground-state energy $E$ of the electron.\n\nExpress your final answer for the energy $E$ as a closed-form analytic expression in terms of $m$, $L$, and $\\hbar$.", "solution": "The electron density must integrate to the number of electrons. With $n(x)=A\\sin^{2}\\!\\left(\\frac{\\pi x}{L}\\right)$ and $k=\\frac{\\pi}{L}$,\n$$\n\\int_{0}^{L}n(x)\\,dx \\;=\\; A\\int_{0}^{L}\\sin^{2}(kx)\\,dx \\;=\\; A\\int_{0}^{L}\\frac{1-\\cos(2kx)}{2}\\,dx \\;=\\; A\\left[\\frac{x}{2}-\\frac{\\sin(2kx)}{4k}\\right]_{0}^{L} \\;=\\; A\\frac{L}{2}.\n$$\nRequiring one electron, $\\int_{0}^{L}n(x)\\,dx=1$, gives $A=\\frac{2}{L}$.\n\nThe von Weizsäcker kinetic-energy functional is\n$$\nT[n] \\;=\\; \\frac{\\hbar^{2}}{8m}\\int_{0}^{L}\\frac{\\big(n'(x)\\big)^{2}}{n(x)}\\,dx.\n$$\nWith $n(x)=A\\sin^{2}(kx)$, its derivative is\n$$\nn'(x) \\;=\\; A\\cdot 2\\sin(kx)\\cos(kx)\\cdot k \\;=\\; A k \\sin(2kx).\n$$\nTherefore,\n$$\n\\frac{\\big(n'(x)\\big)^{2}}{n(x)} \\;=\\; \\frac{A^{2}k^{2}\\sin^{2}(2kx)}{A\\sin^{2}(kx)} \\;=\\; A k^{2}\\frac{\\sin^{2}(2kx)}{\\sin^{2}(kx)} \\;=\\; 4A k^{2}\\cos^{2}(kx),\n$$\nusing $\\sin(2kx)=2\\sin(kx)\\cos(kx)$. Substituting into $T[n]$,\n$$\nT[n] \\;=\\; \\frac{\\hbar^{2}}{8m}\\int_{0}^{L}4A k^{2}\\cos^{2}(kx)\\,dx \\;=\\; \\frac{\\hbar^{2}}{8m}\\cdot 4A k^{2}\\int_{0}^{L}\\cos^{2}(kx)\\,dx.\n$$\nSince $\\cos^{2}(kx)=\\frac{1+\\cos(2kx)}{2}$,\n$$\n\\int_{0}^{L}\\cos^{2}(kx)\\,dx \\;=\\; \\frac{L}{2} + \\frac{1}{2}\\int_{0}^{L}\\cos(2kx)\\,dx \\;=\\; \\frac{L}{2},\n$$\nbecause $\\int_{0}^{L}\\cos(2kx)\\,dx=\\frac{\\sin(2kL)}{2k}=0$. Hence,\n$$\nT[n] \\;=\\; \\frac{\\hbar^{2}}{8m}\\cdot 4A k^{2}\\cdot \\frac{L}{2} \\;=\\; \\frac{\\hbar^{2}}{8m}\\cdot 2A k^{2}L.\n$$\nWith $A=\\frac{2}{L}$ and $k=\\frac{\\pi}{L}$,\n$$\nT[n] \\;=\\; \\frac{\\hbar^{2}}{8m}\\cdot 2\\cdot \\frac{2}{L}\\cdot \\frac{\\pi^{2}}{L^{2}} \\cdot L \\;=\\; \\frac{\\hbar^{2}}{2m}\\cdot \\frac{\\pi^{2}}{L^{2}}.\n$$\nBecause the potential energy is zero inside the box and infinite outside (where the electron cannot be found), the total ground-state energy is purely kinetic, $E=T[n]$, yielding\n$$\nE \\;=\\; \\frac{\\pi^{2}\\hbar^{2}}{2mL^{2}}.\n$$", "answer": "$$\\boxed{\\frac{\\pi^{2}\\hbar^{2}}{2 m L^{2}}}$$", "id": "2088771"}, {"introduction": "While exact DFT is powerful, practical applications rely on approximate exchange-correlation functionals, which have known limitations. A primary limitation is the self-interaction error (SIE), an unphysical artifact where an electron interacts with its own charge distribution. This exercise [@problem_id:2088787] allows you to quantify this error for a hydrogen atom, providing a clear illustration of why the exact exchange-correlation energy must precisely cancel the spurious Hartree energy in one-electron systems.", "problem": "In the framework of Density Functional Theory (DFT), the total energy of a many-electron system is expressed as a functional of the electron density $\\rho(\\vec{r})$. A common approximation for the energy functional is given by $E[\\rho] = T_s[\\rho] + E_{ext}[\\rho] + E_H[\\rho] + E_{xc}[\\rho]$, where $T_s$ is the kinetic energy of non-interacting electrons, $E_{ext}$ is the energy from the external potential (e.g., nuclei), $E_H$ is the classical electrostatic self-repulsion energy of the electron cloud (Hartree energy), and $E_{xc}$ is the exchange-correlation energy.\n\nFor a one-electron system, such as a hydrogen atom, there are no true electron-electron interactions. Therefore, an exact functional should yield the exact energy, which requires the exchange functional $E_x[\\rho]$ to precisely cancel the spurious Hartree energy, $E_H[\\rho]$. This spurious term, which represents the electron's unphysical interaction with itself, is known as the Self-Interaction Error (SIE).\n\nConsider a single hydrogen atom in its ground state. The electron density is spherically symmetric and given by $\\rho(r) = \\frac{1}{\\pi a_0^3} \\exp(-\\frac{2r}{a_0})$, where $a_0$ is the Bohr radius. The Hartree energy is defined as:\n$$E_H[\\rho] = \\frac{1}{2} \\iint \\frac{e^2}{4 \\pi \\epsilon_0} \\frac{\\rho(\\vec{r}) \\rho(\\vec{r}')}{|\\vec{r} - \\vec{r}'|} d^3r d^3r'$$\nwhere $e$ is the elementary charge and $\\epsilon_0$ is the permittivity of free space.\n\nCalculate the magnitude of this self-interaction error for the ground state of the hydrogen atom. For your calculation, use the value of the Hartree energy unit, $\\frac{e^2}{4\\pi\\epsilon_0 a_0} = 27.212 \\text{ eV}$.\n\nExpress your answer in electron-volts (eV), rounded to three significant figures.", "solution": "In an exact one-electron theory, the exchange energy cancels the Hartree self-repulsion, so the magnitude of the self-interaction error equals the Hartree energy:\n$$E_{\\text{SIE}}=E_{H}[\\rho].$$\nFor the hydrogen ground state with spherically symmetric density $\\rho(r)=\\frac{1}{\\pi a_{0}^{3}}\\exp\\!\\left(-\\frac{2r}{a_{0}}\\right)$, the Hartree energy is\n$$E_{H}=\\frac{1}{2}\\iint \\frac{e^{2}}{4\\pi\\epsilon_{0}}\\frac{\\rho(\\vec{r})\\rho(\\vec{r}')}{|\\vec{r}-\\vec{r}'|}\\,d^{3}r\\,d^{3}r'.$$\nUsing spherical symmetry and the addition theorem, the angular integration yields\n$$\\int d\\Omega\\int d\\Omega'\\,\\frac{1}{|\\vec{r}-\\vec{r}'|}=\\frac{16\\pi^{2}}{r_{>}},$$\nwhere $r_{>}=\\max(r,r')$. Hence,\n$$E_{H}=\\frac{1}{2}\\frac{e^{2}}{4\\pi\\epsilon_{0}}\\,16\\pi^{2}\\int_{0}^{\\infty}\\!\\!\\int_{0}^{\\infty}\\frac{r^{2}r'^{2}\\rho(r)\\rho(r')}{r_{>}}\\,dr\\,dr'.$$\nSplitting the domain into $r>r'$ and $r<r'$ and using symmetry,\n$$E_{H}=\\frac{e^{2}}{4\\pi\\epsilon_{0}}\\,16\\pi^{2}\\int_{0}^{\\infty}dr\\,\\rho(r)\\,r\\int_{0}^{r}dr'\\,\\rho(r')\\,r'^{2}.$$\nWith $\\rho(r)=\\frac{1}{\\pi a_{0}^{3}}\\exp\\!\\left(-\\frac{2r}{a_{0}}\\right)$, define\n$$A(r)=\\int_{0}^{r}r'^{2}\\rho(r')\\,dr'=\\frac{1}{\\pi a_{0}^{3}}\\int_{0}^{r}r'^{2}\\exp\\!\\left(-\\frac{2r'}{a_{0}}\\right)dr'.$$\nUsing the substitution $t=\\frac{2r'}{a_{0}}$ gives\n$$A(r)=\\frac{1}{8\\pi}\\int_{0}^{2r/a_{0}}t^{2}\\exp(-t)\\,dt=\\frac{1}{8\\pi}\\left[2-\\exp\\!\\left(-\\frac{2r}{a_{0}}\\right)\\left(\\frac{4r^{2}}{a_{0}^{2}}+\\frac{4r}{a_{0}}+2\\right)\\right],$$\nsince $\\int_{0}^{x}t^{2}\\exp(-t)\\,dt=2-\\exp(-x)(x^{2}+2x+2)$. Therefore,\n$$E_{H}=\\frac{e^{2}}{4\\pi\\epsilon_{0}}\\frac{16\\pi^{2}}{\\pi a_{0}^{3}}\\int_{0}^{\\infty}dr\\,r\\exp\\!\\left(-\\frac{2r}{a_{0}}\\right)\\cdot\\frac{1}{8\\pi}\\left[2-\\exp\\!\\left(-\\frac{2r}{a_{0}}\\right)\\left(\\frac{4r^{2}}{a_{0}^{2}}+\\frac{4r}{a_{0}}+2\\right)\\right].$$\nCollecting constants,\n$$E_{H}=\\frac{e^{2}}{4\\pi\\epsilon_{0}}\\frac{2}{a_{0}^{3}}\\left[2\\int_{0}^{\\infty}r\\exp\\!\\left(-\\frac{2r}{a_{0}}\\right)dr-\\int_{0}^{\\infty}r\\exp\\!\\left(-\\frac{4r}{a_{0}}\\right)\\left(\\frac{4r^{2}}{a_{0}^{2}}+\\frac{4r}{a_{0}}+2\\right)dr\\right].$$\nUsing $\\int_{0}^{\\infty}r\\exp(-\\alpha r)\\,dr=\\frac{1}{\\alpha^{2}}$, $\\int_{0}^{\\infty}r^{2}\\exp(-\\alpha r)\\,dr=\\frac{2}{\\alpha^{3}}$, and $\\int_{0}^{\\infty}r^{3}\\exp(-\\alpha r)\\,dr=\\frac{6}{\\alpha^{4}}$, we obtain\n$$2\\int_{0}^{\\infty}r\\exp\\!\\left(-\\frac{2r}{a_{0}}\\right)dr=\\frac{a_{0}^{2}}{2},$$\n$$\\int_{0}^{\\infty}r^{3}\\exp\\!\\left(-\\frac{4r}{a_{0}}\\right)dr=\\frac{6}{(4/a_{0})^{4}}=\\frac{3a_{0}^{4}}{128},\\quad \\int_{0}^{\\infty}r^{2}\\exp\\!\\left(-\\frac{4r}{a_{0}}\\right)dr=\\frac{2}{(4/a_{0})^{3}}=\\frac{a_{0}^{3}}{32},$$\n$$\\int_{0}^{\\infty}r\\exp\\!\\left(-\\frac{4r}{a_{0}}\\right)dr=\\frac{1}{(4/a_{0})^{2}}=\\frac{a_{0}^{2}}{16}.$$\nThus,\n$$\\int_{0}^{\\infty}r\\exp\\!\\left(-\\frac{4r}{a_{0}}\\right)\\left(\\frac{4r^{2}}{a_{0}^{2}}+\\frac{4r}{a_{0}}+2\\right)dr=\\frac{3a_{0}^{2}}{32}+\\frac{a_{0}^{2}}{8}+\\frac{a_{0}^{2}}{8}=\\frac{11a_{0}^{2}}{32}.$$\nTherefore,\n$$E_{H}=\\frac{e^{2}}{4\\pi\\epsilon_{0}}\\frac{2}{a_{0}^{3}}\\left(\\frac{a_{0}^{2}}{2}-\\frac{11a_{0}^{2}}{32}\\right)=\\frac{e^{2}}{4\\pi\\epsilon_{0}}\\frac{2}{a_{0}^{3}}\\cdot\\frac{5a_{0}^{2}}{32}=\\frac{5}{16}\\frac{e^{2}}{4\\pi\\epsilon_{0}a_{0}}.$$\nHence the self-interaction error magnitude for hydrogen is\n$$E_{\\text{SIE}}=\\frac{5}{16}\\frac{e^{2}}{4\\pi\\epsilon_{0}a_{0}}.$$\nUsing $\\frac{e^{2}}{4\\pi\\epsilon_{0}a_{0}}=27.212\\ \\text{eV}$,\n$$E_{\\text{SIE}}=\\frac{5}{16}\\times 27.212\\ \\text{eV}=8.50375\\ \\text{eV}.$$\nRounded to three significant figures, this is $8.50\\ \\text{eV}$.", "answer": "$$\\boxed{8.50}$$", "id": "2088787"}]}