{"hands_on_practices": [{"introduction": "斯特林近似最直接的应用之一是估算包含大阶乘的组合量。这项练习将引导你完成一个经典案例：近似计算一个广义的二项式系数 $\\binom{3n}{n}$。通过这个练习，你将掌握应用斯特林公式所需的核心代数技巧，并体会到它如何将复杂的阶乘计算转化为更易于处理的指数形式。[@problem_id:29074]", "problem": "二项式系数 $\\binom{m}{k}$ 表示从一个包含 $m$ 个元素的集合中选取 $k$ 个元素的方法数，其定义为：\n$$\n\\binom{m}{k} = \\frac{m!}{k!(m-k)!}\n$$\n其中 $m!$ 表示 $m$ 的阶乘。对于较大的整数 $x$ 值，阶乘可以用斯特林公式来近似：\n$$\nx! \\approx \\sqrt{2\\pi x} \\left(\\frac{x}{e}\\right)^x\n$$\n利用这些信息，为二项式系数 $\\binom{3n}{n}$ 推导出一个简化近似式，该近似式对于较大的整数 $n$ 值有效。你的最终表达式应该用 $n$、$\\pi$ 和其他数值常数来表示。", "solution": "我们从精确表达式开始\n$$\n\\binom{3n}{n}=\\frac{(3n)!}{n!\\,(2n)!}\\,.\n$$\n对于大的 $x$，$Stirling$ 公式给出\n$$\nx!\\approx\\sqrt{2\\pi x}\\,\\bigl(\\tfrac{x}{e}\\bigr)^x.\n$$\n因此\n$$\n(3n)!\\approx\\sqrt{2\\pi\\,3n}\\,\\bigl(\\tfrac{3n}{e}\\bigr)^{3n},\\quad\nn!\\approx\\sqrt{2\\pi n}\\,\\bigl(\\tfrac{n}{e}\\bigr)^n,\\quad\n(2n)!\\approx\\sqrt{2\\pi\\,2n}\\,\\bigl(\\tfrac{2n}{e}\\bigr)^{2n}.\n$$\n代入得到\n$$\n\\binom{3n}{n}\\approx\n\\frac{\\sqrt{2\\pi\\,3n}\\,(3n/e)^{3n}}\n{\\bigl[\\sqrt{2\\pi n}\\,(n/e)^n\\bigl]\\,\n\\bigl[\\sqrt{2\\pi\\,2n}\\,(2n/e)^{2n}\\bigr]}\n=\\frac{\\sqrt{2\\pi\\,3n}}{\\sqrt{2\\pi n}\\,\\sqrt{2\\pi\\,2n}}\n\\frac{(3n)^{3n}}{n^n\\,(2n)^{2n}}.\n$$\n计算前置因子：\n$$\n\\frac{\\sqrt{2\\pi\\,3n}}{\\sqrt{2\\pi n}\\,\\sqrt{2\\pi\\,2n}}\n=\\frac{\\sqrt{6\\pi n}}{2\\pi n\\sqrt2}\n=\\frac{\\sqrt3}{2\\sqrt{\\pi n}}.\n$$\n以及幂律比：\n$$\n\\frac{(3n)^{3n}}{n^n\\,(2n)^{2n}}\n=\\frac{3^{3n}n^{3n}}{n^n\\,2^{2n}n^{2n}}\n=\\frac{3^{3n}}{2^{2n}}\n=\\Bigl(\\frac{27}{4}\\Bigr)^n.\n$$\n结合起来得到大 $n$ 近似\n$$\n\\binom{3n}{n}\\sim\\frac{\\sqrt3}{2\\sqrt{\\pi n}}\\Bigl(\\frac{27}{4}\\Bigr)^n.\n$$", "answer": "$$\\boxed{\\frac{\\sqrt{3}}{2\\sqrt{\\pi n}}\\Bigl(\\frac{27}{4}\\Bigr)^n}$$", "id": "29074"}, {"introduction": "学会了基本应用后，一个自然而然的问题是：“这个近似到底有多精确？” 这个练习将带你超越主导项，深入探索完整的渐近级数。通过分析展开式中的下一项，我们可以估算近似的相对误差，并确定对于哪些 $n$ 值，近似对于实际应用足够可靠，这是应用数学和物理学中的一项关键技能。[@problem_id:776750]", "problem": "对于大整数 $n$，阶乘函数的渐近展开由斯特林级数给出：\n$$n! \\sim \\sqrt{2\\pi n} \\left(\\frac{n}{e}\\right)^n \\left(1 + \\frac{1}{12n} + \\frac{1}{288n^2} + O\\left(\\frac{1}{n^3}\\right)\\right)$$\n这个展开式可用于近似计算相关的组合量。考虑中心二项式系数，定义为 $C(n) = \\binom{2n}{n}$。使用斯特林公式的首项对 $C(n)$ 进行的最简单近似是 $A_0(n) = \\frac{4^n}{\\sqrt{\\pi n}}$。\n\n通过包含级数中的下一项，可以构建一个更精确的近似，得到一个形式为 $A_1(n) = A_0(n) \\left(1 + \\frac{k}{n}\\right)$ 的表达式，其中 $k$ 为某个常数。因此，对于较大的 $n$，简单近似 $A_0(n)$ 的主阶相对误差由 $E(n) = \\frac{C(n) - A_0(n)}{A_0(n)} \\sim \\frac{k}{n}$ 给出。\n\n确定最小的正整数 $n$，使得这个主阶相对误差的绝对值 $|k/n|$ 首次低于容差 $\\epsilon = \\frac{1}{900}$。", "solution": "题目要求满足条件 $|k/n| < \\epsilon$ 的最小正整数 $n$，其中 $k$ 是中心二项式系数 $\\binom{2n}{n}$ 精确近似中的一个常数，且 $\\epsilon = 1/900$。\n\n首先，我们必须确定常数 $k$。中心二项式系数由下式给出：\n$$C(n) = \\binom{2n}{n} = \\frac{(2n)!}{(n!)^2}$$\n我们使用已知的 $n!$ 的斯特林级数：\n$$n! \\sim \\sqrt{2\\pi n} \\left(\\frac{n}{e}\\right)^n \\left(1 + \\frac{1}{12n} + \\frac{1}{288n^2} + O(n^{-3})\\right)$$\n我们通过用 $2n$ 替换 $n$ 来求分子 $(2n)!$ 的展开式：\n$$(2n)! \\sim \\sqrt{2\\pi (2n)} \\left(\\frac{2n}{e}\\right)^{2n} \\left(1 + \\frac{1}{12(2n)} + \\frac{1}{288(2n)^2} + O(n^{-3})\\right)$$\n$$(2n)! \\sim \\sqrt{4\\pi n} \\cdot 4^n \\left(\\frac{n}{e}\\right)^{2n} \\left(1 + \\frac{1}{24n} + \\frac{1}{1152n^2} + O(n^{-3})\\right)$$\n\n接下来，我们求分母 $(n!)^2$ 的展开式：\n$$(n!)^2 \\sim \\left[ \\sqrt{2\\pi n} \\left(\\frac{n}{e}\\right)^n \\left(1 + \\frac{1}{12n} + \\frac{1}{288n^2} + O(n^{-3})\\right) \\right]^2$$\n$$(n!)^2 \\sim 2\\pi n \\left(\\frac{n}{e}\\right)^{2n} \\left(1 + \\frac{1}{12n} + \\frac{1}{288n^2} + O(n^{-3})\\right)^2$$\n我们展开平方项，保留到 $1/n^2$ 阶的项：\n$$\\left(1 + \\frac{1}{12n} + \\frac{1}{288n^2} + \\dots\\right)^2 = 1^2 + 2(1)\\left(\\frac{1}{12n}\\right) + \\left[ \\left(\\frac{1}{12n}\\right)^2 + 2(1)\\left(\\frac{1}{288n^2}\\right) \\right] + \\dots$$\n$$= 1 + \\frac{1}{6n} + \\left(\\frac{1}{144n^2} + \\frac{2}{288n^2}\\right) + \\dots = 1 + \\frac{1}{6n} + \\frac{1}{72n^2} + O(n^{-3})$$\n所以，分母是：\n$$(n!)^2 \\sim 2\\pi n \\left(\\frac{n}{e}\\right)^{2n} \\left(1 + \\frac{1}{6n} + \\frac{1}{72n^2} + O(n^{-3})\\right)$$\n\n现在，我们计算 $C(n)$ 的比值：\n$$C(n) \\sim \\frac{\\sqrt{4\\pi n} \\cdot 4^n \\left(\\frac{n}{e}\\right)^{2n} \\left(1 + \\frac{1}{24n} + \\frac{1}{1152n^2} + \\dots\\right)}{2\\pi n \\left(\\frac{n}{e}\\right)^{2n} \\left(1 + \\frac{1}{6n} + \\frac{1}{72n^2} + \\dots\\right)}$$\n前置因子简化为主阶近似 $A_0(n)$：\n$$\\frac{\\sqrt{4\\pi n} \\cdot 4^n}{2\\pi n} = \\frac{2\\sqrt{\\pi n} \\cdot 4^n}{2\\pi n} = \\frac{4^n}{\\sqrt{\\pi n}} = A_0(n)$$\n剩下的部分是修正因子：\n$$C(n) \\sim A_0(n) \\cdot \\frac{1 + \\frac{1}{24n} + O(n^{-2})}{1 + \\frac{1}{6n} + O(n^{-2})}$$\n为了找到大 $n$ 的行为，我们使用几何级数展开 $(1+x)^{-1} \\approx 1 - x + x^2 - \\dots$。令 $x = \\frac{1}{6n} + O(n^{-2})$。\n$$\\frac{1}{1 + \\frac{1}{6n} + O(n^{-2})} \\approx 1 - \\frac{1}{6n} + O(n^{-2})$$\n将此与分子的级数相乘：\n$$\\left(1 + \\frac{1}{24n} + O(n^{-2})\\right) \\left(1 - \\frac{1}{6n} + O(n^{-2})\\right) = 1 + \\frac{1}{24n} - \\frac{1}{6n} + O(n^{-2})$$\n$$= 1 + \\left(\\frac{1}{24} - \\frac{4}{24}\\right)\\frac{1}{n} + O(n^{-2}) = 1 - \\frac{3}{24n} + O(n^{-2}) = 1 - \\frac{1}{8n} + O(n^{-2})$$\n因此，$C(n)$ 的精确近似为：\n$$C(n) \\sim \\frac{4^n}{\\sqrt{\\pi n}} \\left(1 - \\frac{1}{8n}\\right)$$\n将其与指定形式 $A_1(n) = A_0(n) \\left(1 + \\frac{k}{n}\\right)$ 进行比较，我们确定常数 $k = -1/8$。\n\n主阶相对误差为 $E(n) \\sim k/n = -1/(8n)$。我们需要找到使该误差的绝对值小于 $\\epsilon$ 的最小正整数 $n$。\n$$|E(n)| \\approx \\left|-\\frac{1}{8n}\\right| = \\frac{1}{8n}$$\n条件是：\n$$\\frac{1}{8n} < \\epsilon$$\n解出 $n$:\n$$n > \\frac{1}{8\\epsilon}$$\n题目指定容差 $\\epsilon = 1/900$。代入此值：\n$$n > \\frac{1}{8 \\cdot (1/900)} = \\frac{900}{8}$$\n$$n > \\frac{225}{2} = 112.5$$\n由于 $n$ 必须是整数，满足此条件的最小整数 $n$ 是 $n=113$。", "answer": "$$\\boxed{113}$$", "id": "776750"}, {"introduction": "渐近分析的力量远不止于阶乘。由于斯特林公式本身源于伽马函数 $\\Gamma(x)$，同样的方法也可以应用于其他相关函数。最后的这项练习将展示如何利用伽马函数的对数导数——双伽马函数 $\\psi(x)$ 的渐近展开式——来寻找其根的近似值。这个过程将组合数学与超越方程分析联系起来，展示了该工具的广泛适用性。[@problem_id:776769]", "problem": "双伽玛函数，记作 $\\psi(x)$，定义为伽玛函数 $\\Gamma(x)$ 的对数导数：\n$$\n\\psi(x) = \\frac{d}{dx} \\ln \\Gamma(x)\n$$\n对于大的正实数 $x$，双伽玛函数的渐近展开式可由 $\\ln\\Gamma(x)$ 的斯特林级数推导得出，其形式如下：\n$$\n\\psi(x) \\sim \\ln x - \\frac{1}{2x} - \\frac{1}{12x^2} - \\dots\n$$\n双伽玛函数有一个唯一的正实根 $x_0$，使得 $\\psi(x_0)=0$。我们可以通过截断其渐近级数并求解所得方程，来求出这个根的一个近似值，记作 $x_a$。\n\n你的任务是利用其渐近展开式的前两项来求解 $\\psi(x_a) \\approx 0$，从而求出近似根 $x_a$ 的一个闭式解析表达式。\n\n为了求得闭式解，你可以使用兰伯特 W 函数 $W(z)$，该函数定义为满足方程 $z = W(z)e^{W(z)}$ 的函数。", "solution": "1. 从两项渐近展开式开始：\n$$\n\\psi(x)\\approx\\ln x-\\frac{1}{2x}=0.\n$$\n2. 令\n$$\n\\ln x=\\frac{1}{2x}.\n$$\n3. 两边同乘以 $x$：\n$$\nx\\ln x=\\tfrac12.\n$$\n4. 引入 $z=\\ln x$，从而 $x=e^z$，得到\n$$\nz\\,e^z=\\tfrac12.\n$$\n5. 根据兰伯特 W 函数的定义，$z=W(\\tfrac12)$，因此\n$$\nx=e^z=e^{W(\\tfrac12)}.\n$$", "answer": "$$\\boxed{e^{W\\!\\left(\\tfrac12\\right)}}$$", "id": "776769"}]}