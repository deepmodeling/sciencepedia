{"hands_on_practices": [{"introduction": "线性递归关系是差分学中的基石，广泛应用于从信号处理到金融模型的各个领域。本练习将引导你解决一个具有代表性的二阶线性齐次递归关系，其特征方程的根是复数。通过这个实践，你将掌握如何利用复数来推导实数序列的通项公式，这是理解振动等物理现象的数学描述的关键一步。[@problem_id:1077318]", "problem": "考虑一个序列 $\\{x_n\\}_{n=0}^{\\infty}$，它由以下常系数线性齐次递推关系定义：\n$$x_{n+1} - (2 \\cos \\theta) x_n + x_{n-1} = 0, \\quad \\text{for } n \\ge 1$$\n其中 $\\theta$ 是一个实常数。序列的初始值由 $x_0 = 0$ 和 $x_1 = \\sin(2\\theta)$ 给出。\n\n你的任务是确定无穷级数 $S = \\sum_{n=0}^{\\infty} \\frac{x_n}{n!}$ 的值。将你的答案表示为关于 $\\theta$ 的闭式表达式。", "solution": "我们得到齐次递推关系\n$$x_{n+1}-2\\cos\\theta\\,x_n+x_{n-1}=0,\\quad x_0=0,\\;x_1=\\sin(2\\theta)。$$\n1.  特征方程：\n$$r^2-2\\cos\\theta\\,r+1=0\\;\\Longrightarrow\\;r=e^{\\pm i\\theta}。$$\n2.  通解：\n$x_n=Ae^{in\\theta}+Be^{-in\\theta}$。\n3.  应用 $x_0=0\\implies A+B=0\\implies B=-A$，以及\n$x_1=Ae^{i\\theta}-Ae^{-i\\theta}=2iA\\sin\\theta=\\sin(2\\theta)\\;\\Longrightarrow\\;A=\\frac{\\sin(2\\theta)}{2i\\sin\\theta}= -i\\cos\\theta$。\n因此\n$x_n=-i\\cos\\theta\\,e^{in\\theta}+i\\cos\\theta\\,e^{-in\\theta}\n=2\\cos\\theta\\sin(n\\theta)$。\n4.  构造级数\n$S=\\sum_{n=0}^\\infty\\frac{x_n}{n!}\n=2\\cos\\theta\\sum_{n=0}^\\infty\\frac{\\sin(n\\theta)}{n!}$。\n但是\n$\\sum_{n=0}^\\infty\\frac{e^{in\\theta}}{n!}\n=\\exp\\bigl(e^{i\\theta}\\bigr)\n\\;\\Longrightarrow\\;\n\\sum_{n=0}^\\infty\\frac{\\sin(n\\theta)}{n!}\n=\\Im\\bigl(e^{e^{i\\theta}}\\bigr)$。\n5.  因此\n$S=2\\cos\\theta\\,\\Im\\bigl(e^{\\cos\\theta+i\\sin\\theta}\\bigr)\n=2\\cos\\theta\\,e^{\\cos\\theta}\\sin\\bigl(\\sin\\theta\\bigr)$。", "answer": "$$\\boxed{2\\cos\\theta\\,e^{\\cos\\theta}\\sin\\bigl(\\sin\\theta\\bigr)}$$", "id": "1077318"}, {"introduction": "现实世界中的许多系统本质上是非线性的，无法用简单的线性关系来描述。本练习将带你挑战一个经典的非线性递归关系，它常用于模拟受限环境中的种群增长。你将学习通过一个巧妙的变量代换，将这个复杂的非线性问题转化为一个可解的线性问题，深刻体会“化繁为简”的数学思想。[@problem_id:1077165]", "problem": "一个序列 $\\{x_n\\}_{n=0}^{\\infty}$ 由非线性递推关系定义，也称为差分方程：\n$$\nx_{n+1} = \\frac{\\alpha x_n}{1 + \\beta x_n}\n$$\n其中 $x_0$ 是初始值，$\\alpha, \\beta$ 是实常数，满足 $\\alpha > 0$ 且 $\\alpha \\neq 1$。假设初始值 $x_0$ 使得对于任何 $n \\geq 0$，分母永不为零。\n\n通过使用适当的代换将此关系转换为线性递推关系，推导出一个用 $n$、初始值 $x_0$ 以及参数 $\\alpha$ 和 $\\beta$ 表示的 $x_n$ 的闭式表达式。", "solution": "我们令 $y_n = 1/x_n$ 来获得一个线性递推。由\n$x_{n+1} = \\frac{\\alpha x_n}{1+\\beta x_n}$\n我们得到\n$y_{n+1}=\\frac{1+\\beta x_n}{\\alpha x_n}=\\frac{1}{\\alpha}y_n+\\frac{\\beta}{\\alpha}$。\n因此 $y_{n+1}=a\\,y_n+c$，其中 $a=1/\\alpha\\neq1$ 且 $c=\\beta/\\alpha$。通解为\n$y_n=a^n y_0 + c\\sum_{k=0}^{n-1}a^k =a^n\\frac1{x_0}+\\frac{\\beta}{\\alpha}\\frac{a^n-1}{a-1}$。\n代入 $a=1/\\alpha$ 并化简得到\n$y_n=\\alpha^{-n}\\frac1{x_0}+\\frac{\\beta\\bigl(1-\\alpha^{-n}\\bigr)}{\\alpha-1}$。\n因此\n$x_n=\\frac1{y_n}\n=\\frac1{\\displaystyle\\frac{\\alpha^{-n}}{x_0}+\\frac{\\beta}{\\alpha-1}(1-\\alpha^{-n})}\n=\\frac{(\\alpha-1)\\,\\alpha^n x_0}{(\\alpha-1)+\\beta x_0(\\alpha^n-1)}$。", "answer": "$$\\boxed{\\frac{(\\alpha-1)\\,\\alpha^n x_0}{(\\alpha-1)+\\beta x_0(\\alpha^n-1)}}$$", "id": "1077165"}, {"introduction": "计算机模拟如何值得信赖？答案在于其背后数值算法的稳定性。本练习将理论付诸实践，让你分析“蛙跳法”这一广泛用于天体物理学和分子动力学模拟的算法。通过构建差分方程并分析其稳定性，你将亲手揭示保证模拟结果不会无限发散的条件，这是连接连续理论与离散计算的关键一环。[@problem_id:1077325]", "problem": "考虑由以下二阶常微分方程描述的简谐振子：\n$$ \\frac{d^2x}{d t^2} = -\\omega^2 x $$\n其中 $x$ 是位置，$t$ 是时间，$\\omega$ 是恒定的角频率。该方程可以等价地写成一个由两个一阶方程组成的系统：\n$$ \\frac{dx}{dt} = v $$\n$$ \\frac{dv}{dt} = -\\omega^2 x $$\n其中 $v$ 是速度。\n\n积分此类系统的一种常用数值方法是蛙跳（leapfrog）法（或称为踢-漂移-踢法）。给定时间 $t_n$ 的状态 $(x_n, v_n)$，在时间 $t_{n+1} = t_n + \\Delta t$ 时的状态 $(x_{n+1}, v_{n+1})$ 通过以下三步计算：\n1.  **踢（速度的半步）：** $v_{n+1/2} = v_n + a(x_n) \\frac{\\Delta t}{2}$\n2.  **漂移（位置的全步）：** $x_{n+1} = x_n + v_{n+1/2} \\Delta t$\n3.  **踢（速度的半步）：** $v_{n+1} = v_{n+1/2} + a(x_{n+1}) \\frac{\\Delta t}{2}$\n这里，$a(x) = -\\omega^2 x$ 是加速度。\n\n如果数值解的振幅不随时间无界增长，则认为该数值方法是稳定的。这种稳定性由放大矩阵 $\\mathbf{M}$ 的性质决定，该矩阵将状态向量从一个时间步映射到下一个时间步：\n$$ \\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix} = \\mathbf{M} \\begin{pmatrix} x_n \\\\ v_n \\end{pmatrix} $$\n为了保证稳定性，$\\mathbf{M}$ 的特征值的模必须小于或等于1。\n\n确定蛙跳法保持稳定时，无量纲乘积 $\\omega \\Delta t$ 的最大值。", "solution": "为了确定稳定性条件，我们首先需要推导出放大矩阵 $\\mathbf{M}$。我们从写出简谐振子的蛙跳法更新方程开始，其中加速度为 $a(x) = -\\omega^2 x$。\n\n这三个步骤是：\n1.  $v_{n+1/2} = v_n - \\omega^2 x_n \\frac{\\Delta t}{2}$\n2.  $x_{n+1} = x_n + v_{n+1/2} \\Delta t$\n3.  $v_{n+1} = v_{n+1/2} - \\omega^2 x_{n+1} \\frac{\\Delta t}{2}$\n\n我们将第一个方程代入第二个方程以消去 $v_{n+1/2}$：\n$$ x_{n+1} = x_n + \\left(v_n - \\omega^2 x_n \\frac{\\Delta t}{2}\\right) \\Delta t $$\n$$ x_{n+1} = \\left(1 - \\frac{\\omega^2 (\\Delta t)^2}{2}\\right) x_n + (\\Delta t) v_n $$\n该方程给出了矩阵 $\\mathbf{M}$ 的第一行。\n\n接下来，我们寻找 $v_{n+1}$ 关于 $x_n$ 和 $v_n$ 的类似表达式。我们使用第三步，并代入第一步中 $v_{n+1/2}$ 的表达式：\n$$ v_{n+1} = \\left(v_n - \\omega^2 x_n \\frac{\\Delta t}{2}\\right) - \\omega^2 x_{n+1} \\frac{\\Delta t}{2} = v_n - \\frac{\\omega^2 \\Delta t}{2} (x_n + x_{n+1}) $$\n现在，代入我们刚刚推导出的 $x_{n+1}$ 的表达式：\n$$ v_{n+1} = v_n - \\frac{\\omega^2 \\Delta t}{2} \\left[ x_n + \\left( \\left(1 - \\frac{\\omega^2 (\\Delta t)^2}{2}\\right) x_n + (\\Delta t) v_n \\right) \\right] $$\n$$ v_{n+1} = v_n - \\frac{\\omega^2 \\Delta t}{2} \\left[ \\left(1 + 1 - \\frac{\\omega^2 (\\Delta t)^2}{2}\\right) x_n + (\\Delta t) v_n \\right] $$\n$$ v_{n+1} = v_n - \\frac{\\omega^2 \\Delta t}{2} \\left[ \\left(2 - \\frac{\\omega^2 (\\Delta t)^2}{2}\\right) x_n + (\\Delta t) v_n \\right] $$\n展开各项：\n$$ v_{n+1} = v_n - \\omega^2 \\Delta t \\left(1 - \\frac{\\omega^2 (\\Delta t)^2}{4}\\right) x_n - \\frac{\\omega^2 (\\Delta t)^2}{2} v_n $$\n$$ v_{n+1} = \\left[-\\omega^2 \\Delta t \\left(1 - \\frac{\\omega^2 (\\Delta t)^2}{4}\\right)\\right] x_n + \\left(1 - \\frac{\\omega^2 (\\Delta t)^2}{2}\\right) v_n $$\n这是矩阵 $\\mathbf{M}$ 的第二行。\n\n现在，状态更新可以写成矩阵形式：\n$$ \\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{\\omega^2 (\\Delta t)^2}{2} & \\Delta t \\\\ -\\omega^2 \\Delta t \\left(1 - \\frac{\\omega^2 (\\Delta t)^2}{4}\\right) & 1 - \\frac{\\omega^2 (\\Delta t)^2}{2} \\end{pmatrix} \\begin{pmatrix} x_n \\\\ v_n \\end{pmatrix} $$\n因此，放大矩阵为：\n$$ \\mathbf{M} = \\begin{pmatrix} 1 - \\frac{\\omega^2 (\\Delta t)^2}{2} & \\Delta t \\\\ -\\omega^2 \\Delta t \\left(1 - \\frac{\\omega^2 (\\Delta t)^2}{4}\\right) & 1 - \\frac{\\omega^2 (\\Delta t)^2}{2} \\end{pmatrix} $$\n为了保证稳定性，$\\mathbf{M}$ 的特征值 $\\lambda$ 必须满足 $|\\lambda| \\le 1$。特征值通过求解特征方程 $\\det(\\mathbf{M} - \\lambda \\mathbf{I}) = 0$ 找到。令 $\\alpha = \\omega \\Delta t$。\n$$ \\mathbf{M} = \\begin{pmatrix} 1 - \\frac{\\alpha^2}{2} & \\frac{\\alpha}{\\omega} \\\\ -\\omega\\alpha \\left(1 - \\frac{\\alpha^2}{4}\\right) & 1 - \\frac{\\alpha^2}{2} \\end{pmatrix} $$\n特征方程为：\n$$ \\det \\begin{pmatrix} 1 - \\frac{\\alpha^2}{2} - \\lambda & \\frac{\\alpha}{\\omega} \\\\ -\\omega\\alpha \\left(1 - \\frac{\\alpha^2}{4}\\right) & 1 - \\frac{\\alpha^2}{2} - \\lambda \\end{pmatrix} = 0 $$\n$$ \\left(1 - \\frac{\\alpha^2}{2} - \\lambda\\right)^2 + \\omega\\alpha \\left(1 - \\frac{\\alpha^2}{4}\\right) \\frac{\\alpha}{\\omega} = 0 $$\n$$ \\left(1 - \\frac{\\alpha^2}{2} - \\lambda\\right)^2 + \\alpha^2 \\left(1 - \\frac{\\alpha^2}{4}\\right) = 0 $$\n$$ \\left(1 - \\frac{\\alpha^2}{2} - \\lambda\\right)^2 = -\\alpha^2 \\left(1 - \\frac{\\alpha^2}{4}\\right) $$\n我们根据等式右侧的符号来分析这个方程。项 $1 - \\alpha^2/4$ 是关键。\n\n情况1：$1 - \\alpha^2/4 \\ge 0$，这意味着 $\\alpha^2 \\le 4$，或 $|\\alpha| \\le 2$。\n在这种情况下，右侧为负或零。取平方根得到一个虚数：\n$$ 1 - \\frac{\\alpha^2}{2} - \\lambda = \\pm i \\alpha \\sqrt{1 - \\frac{\\alpha^2}{4}} $$\n$$ \\lambda = 1 - \\frac{\\alpha^2}{2} \\mp i \\alpha \\sqrt{1 - \\frac{\\alpha^2}{4}} $$\n特征值是一对共轭复数。我们计算模的平方：\n$$ |\\lambda|^2 = \\left(1 - \\frac{\\alpha^2}{2}\\right)^2 + \\left(\\alpha \\sqrt{1 - \\frac{\\alpha^2}{4}}\\right)^2 $$\n$$ |\\lambda|^2 = \\left(1 - \\alpha^2 + \\frac{\\alpha^4}{4}\\right) + \\alpha^2 \\left(1 - \\frac{\\alpha^2}{4}\\right) $$\n$$ |\\lambda|^2 = 1 - \\alpha^2 + \\frac{\\alpha^4}{4} + \\alpha^2 - \\frac{\\alpha^4}{4} = 1 $$\n所以，$|\\lambda| = 1$。对于任何满足 $|\\alpha| \\le 2$ 的 $\\alpha = \\omega \\Delta t$，特征值位于单位圆上，该方法是稳定的。临界情况 $|\\alpha|=2$ 会产生在 $\\lambda = -1$ 处的重根特征值，这可能导致线性增长，这是一种通常包含在稳定性判据中的临界不稳定性。\n\n情况2：$1 - \\alpha^2/4 < 0$，这意味着 $\\alpha^2 > 4$，或 $|\\alpha| > 2$。\n在这种情况下，特征方程的右侧为正。我们将其重写为：\n$$ \\left(1 - \\frac{\\alpha^2}{2} - \\lambda\\right)^2 = \\alpha^2 \\left(\\frac{\\alpha^2}{4} - 1\\right) $$\n取平方根得到一个实数：\n$$ 1 - \\frac{\\alpha^2}{2} - \\lambda = \\pm \\alpha \\sqrt{\\frac{\\alpha^2}{4} - 1} $$\n$$ \\lambda = 1 - \\frac{\\alpha^2}{2} \\mp \\alpha \\sqrt{\\frac{\\alpha^2}{4} - 1} $$\n两个特征值 $\\lambda_1$ 和 $\\lambda_2$ 是实数且不相等。它们的乘积是 $\\mathbf{M}$ 的行列式：\n$$ \\lambda_1 \\lambda_2 = \\det(\\mathbf{M}) = \\left(1 - \\frac{\\alpha^2}{2}\\right)^2 + \\alpha^2\\left(1 - \\frac{\\alpha^2}{4}\\right) = 1 $$\n由于它们的乘积为1，且它们是实数且不相等（因为 $|\\alpha|>2$），一个特征值的模必须大于1，另一个则小于1。存在模大于1的特征值 ($|\\lambda| > 1$) 会导致数值解的指数增长，这意味着该方法是不稳定的。\n\n综合两种情况，蛙跳法在 $|\\omega \\Delta t| \\le 2$ 时是稳定的。因此，该无量纲乘积的最大值为2。", "answer": "$$\\boxed{2}$$", "id": "1077325"}]}