{"hands_on_practices": [{"introduction": "Theta 函数的魅力不仅在于其优美的数学结构，更在于它与数论等领域的深刻联系。本练习将带你领略这一联系的经典范例：雅可比四平方和定理。该定理为“一个正整数可以表示为四个整数平方和的方式有多少种？”这一古老问题提供了惊人而简洁的解答，而其答案正隐藏在 $\\vartheta_3(0, q)^4$ 的级数展开系数中 [@problem_id:789734]。通过直接应用雅可比的公式，你将亲手计算并验证这一理论的威力。", "problem": "第三雅可比theta函数定义为\n$$ \\vartheta_3(z, q) = \\sum_{k=-\\infty}^{\\infty} q^{k^2} e^{2\\pi ikz} $$\n其中 $|q|<1$。当 $z=0$ 时，我们得到指数为平方的theta函数\n$$ \\vartheta_3(0, q) = \\sum_{k=-\\infty}^{\\infty} q^{k^2} = 1 + 2q + 2q^4 + 2q^9 + \\dots $$\n\n令 $r_k(n)$ 表示将整数 $n$ 写成 $k$ 个整数平方和的方法数，其中不同的顺序和符号均算作不同的表示。例如，$r_2(1)=4$，因为 $1 = (\\pm 1)^2 + 0^2 = 0^2 + (\\pm 1)^2$。$r_4(n)$ 的生成函数恰好是 $\\vartheta_3(0, q)$ 的四次方：\n$$ \\left(\\vartheta_3(0, q)\\right)^4 = \\sum_{n=0}^{\\infty} r_4(n) q^n $$\n\nJacobi 四平方和定理为 $r_4(n)$ 提供了一个优美的算术公式：\n$$ r_4(n) = 8 \\sum_{\\substack{d|n \\\\ 4 \\nmid d}} d $$\n该求和是对 $n$ 的所有不能被 $4$ 整除的正因数 $d$ 进行的。\n\n使用 Jacobi 公式，求将整数 $30$ 写成四个整数平方和的方法数。", "solution": "1. Jacobi 四平方和定理指出\n$$\nr_4(n) \\;=\\; 8 \\sum_{\\substack{d\\mid n \\\\ 4\\nmid d}} d.\n$$\n2. 对于 $n=30$，其正因数为\n$\\{1,2,3,5,6,10,15,30\\}$。\n这些数都不是 4 的倍数，因此都计入求和。\n3. 计算这些因数的和：\n\n$$\n\\sum_{\\substack{d\\mid 30 \\\\ 4\\nmid d}} d\n=1+2+3+5+6+10+15+30=72.\n$$\n\n4. 因此，\n\n$$\nr_4(30)=8\\times 72=576.\n$$", "answer": "$$\\boxed{576}$$", "id": "789734"}, {"introduction": "除了在数论中的应用，Theta 函数本身也因其在复变量 $\\tau$ 变换下的特殊性质而备受关注，这些性质统称为模形式性质。本练习将引导你探索其中最基本的一种——周期性 [@problem_id:785222]。你将首先利用 theta 函数的定义证明其在一个简单变换下的不变性，然后通过计算其快速收敛的级数来近似求值，从而将抽象的理论性质与具体的数值计算结合起来。", "problem": "计算雅可比(Jacobi)theta函数 $\\vartheta_3(0 | i+2)$，使用模变换 τ → τ+2 和 $\\vartheta_3$ 的周期性。将表达式化简为 $\\vartheta_3(0 | i)$，然后计算其数值，精确到10位有效数字。雅可比(Jacobi)theta函数 $\\vartheta_3$ 定义为：\n\n$$  \n\\vartheta_3(z | τ) = \\sum_{n=-\\infty}^{\\infty} \\exp\\left(\\pi i n^{2} \\tau + 2 \\pi i n z\\right)\n$$\n\n其中 τ 是上半复平面中的一个复参数。使用 $\\vartheta_3(0 | i)$ 的级数展开，并进行适当截断以达到所需精度。", "solution": "1. 根据定义\n$$\\vartheta_3(z\\mid\\tau)=\\sum_{n=-\\infty}^{\\infty}\\exp\\bigl(\\pi i n^{2}\\tau+2\\pi i n z\\bigr)\\,. $$\n令 $z=0$ 且 $\\tau\\to\\tau+2$ 可得\n$$\\vartheta_3(0\\mid\\tau+2)\n=\\sum_{n=-\\infty}^{\\infty}\\exp\\bigl(\\pi i n^{2}(\\tau+2)\\bigr)\n=\\sum_{n=-\\infty}^{\\infty}\\exp(\\pi i n^{2}\\tau)\\,\\exp(2\\pi i n^{2})\n=\\vartheta_3(0\\mid\\tau)\\,, $$\n因为对于整数 $n$，$\\exp(2\\pi i n^{2})=1$。因此\n$$\\vartheta_3(0\\mid i+2)=\\vartheta_3(0\\mid i)\\,. $$\n\n2. 对于 $\\tau=i$，\n$$\\vartheta_3(0\\mid i)\n=\\sum_{n=-\\infty}^{\\infty}\\exp(\\pi i n^{2}i)\n=\\sum_{n=-\\infty}^{\\infty}e^{-\\pi n^{2}}\n=1+2\\sum_{n=1}^{\\infty}e^{-\\pi n^{2}}\\,. $$\n\n3. 在 $n=2$ 后截断。令\n$$a_{1}=e^{-\\pi},\\quad a_{2}=e^{-4\\pi},\\quad a_{3}=e^{-9\\pi}\\,. $$\n则\n$$\\vartheta_3(0\\mid i)\\approx1+2\\bigl(a_{1}+a_{2}\\bigr)\n=1+2\\bigl(e^{-\\pi}+e^{-4\\pi}\\bigr)\\,, $$\n误差量级为 $2a_{3}<10^{-12}$。\n\n4. 数值计算：\n$$e^{-\\pi}\\approx0.04321391826377225,\\quad\ne^{-4\\pi}\\approx3.487342940345317\\times10^{-6}\\,. $$\n因此\n$$\\vartheta_3(0\\mid i)\\approx1+2(0.04321391826377225+0.000003487342940345317)\n=1.0864348112134262\\,. $$\n\n5. 四舍五入到10位有效数字，可得\n$$\\vartheta_3(0\\mid i+2)=\\vartheta_3(0\\mid i)\\approx1.086434811\\,. $$", "answer": "$$\\boxed{1.086434811}$$", "id": "785222"}, {"introduction": "在探索了 Theta 函数的周期性之后，我们将更进一步，研究不同宗数 (nome) 对应的 Theta 函数之间的关联。兰登变换 (Landen transformation) 是一个连接宗数 $q$ 与 $q^2$ （即 $\\tau$ 与 $2\\tau$）处函数值的强大工具。在本练习中，你将通过迭代应用兰登变换来精确计算椭圆模数 $k(4i)$ 的值 [@problem_id:1161809]，这不仅能加深你对模变换的理解，也能让你体验到如何利用这些变换进行代数推演。", "problem": "雅可比θ常数 $\\vartheta_j(q)$ 是为诺姆 $q = e^{i\\pi\\tau}$ (其中$\\text{Im}(\\tau)>0$) 定义的。\n椭圆模数 $k(\\tau)$ 和补模数 $k'(\\tau)$ 由这些常数定义如下：\n$$ k(\\tau) = \\left( \\frac{\\vartheta_2(q)}{\\vartheta_3(q)} \\right)^2, \\quad k'(\\tau) = \\left( \\frac{\\vartheta_4(q)}{\\vartheta_3(q)} \\right)^2 $$\n这些模数满足恒等式 $k(\\tau)^2 + k'(\\tau)^2 = 1$。\n\nLanden降阶变换给出了在$\\tau$处的模数与在$2\\tau$处的模数之间的关系。令$k = k(\\tau)$且$k' = k'(\\tau)$。对应于$2\\tau$的模数由下式给出：\n$$ k(2\\tau) = \\frac{1-k'(\\tau)}{1+k'(\\tau)} $$\n模数的一个特殊值，称为奇异值，出现在$\\tau=i$处。其值为$k(i) = 1/\\sqrt{2}$。\n\n您的任务是求出椭圆模数$k(4i)$的精确值。这需要分两步应用Landen降阶变换。首先，从$k(i)$计算$k(2i)$，然后从$k(2i)$计算$k(4i)$。\n\n**问题：**利用所提供的信息，计算$k(4i)$的精确解析表达式。", "solution": "1. Landen降阶变换：\n   $$k(2\\tau)=\\frac{1-k'(\\tau)}{1+k'(\\tau)}.$$\n2. 当 $\\tau=i$ 时，$k(i)=\\tfrac1{\\sqrt2}$，所以\n   $$k'(i)=\\sqrt{1-\\frac1{2}}=\\frac1{\\sqrt2}.$$\n3. 因此\n   $$k(2i)=\\frac{1-\\tfrac1{\\sqrt2}}{1+\\tfrac1{\\sqrt2}}\n            =\\frac{\\sqrt2-1}{\\sqrt2+1}\n            =(\\sqrt2-1)^2=3-2\\sqrt2.$$\n4. 然后\n   $$k'(2i)=\\sqrt{1-(3-2\\sqrt2)^2}\n            =\\sqrt{1-(17-12\\sqrt2)}\n            =\\sqrt{12\\sqrt2-16}\n            =2\\sqrt{3\\sqrt2-4}.$$\n5. 最后\n   $$k(4i)\n     =\\frac{1-k'(2i)}{1+k'(2i)}\n     =\\frac{1-2\\sqrt{3\\sqrt2-4}}{1+2\\sqrt{3\\sqrt2-4}}.$$", "answer": "$$\\boxed{\\frac{1-2\\sqrt{3\\sqrt2-4}}{1+2\\sqrt{3\\sqrt2-4}}}$$", "id": "1161809"}]}