{"hands_on_practices": [{"introduction": "Crank-Nicolson 方法的核心在于将一个偏微分方程转化为在每个时间步长求解一个线性方程组。第一个练习将通过一个非常简单的网格来揭示这一过程，让您亲自构建并分析这个矩阵系统 [@problem_id:1126497]。通过推导逆矩阵的一个元素，您将具体地理解下一时刻的解是如何明确地依赖于无量纲参数 $r$ 的，从而为掌握该方法奠定坚实的基础。", "problem": "考虑一维热传导方程，\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}\n$$\n其中函数为 $u(x,t)$，定义域为 $x \\in [0, L]$ 和 $t \\ge 0$。常数 $\\alpha$ 是热扩散率。该域满足齐次狄利克雷（Dirichlet）边界条件，$u(0,t)=0$ 和 $u(L,t)=0$。\n\n空间域被离散为三个等长的段，形成网格点 $x_j = j \\Delta x$，$j=0, 1, 2, 3$，其中 $\\Delta x = L/3$。这种设置产生了位于 $j=1$ 和 $j=2$ 的两个内部网格点。时间域以均匀的时间步长 $\\Delta t$ 进行离散化。我们将 $u(x_j, t_n)$ 的数值近似记为 $u_j^n$。\n\n使用 Crank-Nicolson 方法对热传导方程进行离散化。该格式使用向前差分近似时间导数，并使用时间层 $n$ 和 $n+1$ 上的中心差分的平均值来近似空间导数：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\frac{\\alpha}{2} \\left( \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2} + \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} \\right)\n$$\n这导出了一个关于下一时间步未知温度的线性方程组，可以写成矩阵形式 $A \\mathbf{u}^{n+1} = \\mathbf{d}^n$，其中 $\\mathbf{u}^{n+1} = [u_{1}^{n+1}, u_{2}^{n+1}]^T$ 是时间步 $n+1$ 时两个内部点的温度向量，$A$ 是一个 $2 \\times 2$ 矩阵。\n\n令 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$ 为无量纲网格比。推导出逆矩阵的左上角元素 $(A^{-1})_{11}$ 作为 $r$ 的函数的表达式。", "solution": "我们在两个内部节点 $j=1,2$ 处应用 Crank-Nicolson 格式，并设 $u_0=u_3=0$ 及 $r=\\frac{\\alpha\\Delta t}{(\\Delta x)^2}$。\n\n对于 $j=1$：\n$$\n\\frac{u_1^{n+1}-u_1^n}{\\Delta t}\n=\\frac{\\alpha}{2(\\Delta x)^2}\\Bigl[(u_2^{n+1}-2u_1^{n+1}+u_0^{n+1})+(u_2^n-2u_1^n+u_0^n)\\Bigr],\n$$\n化简为\n$$\n(1+r)u_1^{n+1}-\\tfrac r2\\,u_2^{n+1}\n=(1-r)u_1^n+\\tfrac r2\\,u_2^n.\n$$\n\n类似地，对于 $j=2$：\n$$\n-\\tfrac r2\\,u_1^{n+1}+(1+r)u_2^{n+1}\n=\\tfrac r2\\,u_1^n+(1-r)u_2^n.\n$$\n\n因此矩阵系统为\n$$\nA=\\begin{pmatrix}1+r&-\\tfrac r2\\\\-\\tfrac r2&1+r\\end{pmatrix},\n\\quad\n\\Delta=\\det A=(1+r)^2-\\tfrac{r^2}{4}=1+2r+\\tfrac{3r^2}{4}.\n$$\n\n其逆矩阵为\n$$\nA^{-1}=\\frac1\\Delta\\begin{pmatrix}1+r&\\tfrac r2\\\\\\tfrac r2&1+r\\end{pmatrix},\n$$\n\n所以 $(1,1)$ 元素是\n$$\n(A^{-1})_{11}=\\frac{1+r}{1+2r+\\tfrac{3r^2}{4}}.\n$$", "answer": "$$\\boxed{\\frac{1+r}{1+2r+\\tfrac{3r^2}{4}}}$$", "id": "1126497"}, {"introduction": "除了实现数值格式，理解其定性性质（如稳定性）也至关重要。离散极值原理是确保数值解具有物理意义、不产生伪振荡的关键特性 [@problem_id:1126299]。这个练习将引导您找出 Crank-Nicolson 方法满足此原理的网格傅里叶数 $r$ 的上限。这为您在选择合适步长以获得物理上有意义且无振荡的解时，提供了重要的理论洞察。", "problem": "一维热传导方程为 $u_t = \\alpha u_{xx}$，其中 $u(x, t)$ 是在位置 $x$ 和时间 $t$ 的温度，$\\alpha > 0$ 是热扩散率。求解该方程的一种常用数值格式是 Crank-Nicolson 方法。使用间距为 $\\Delta x$ 的均匀空间网格和时间步长 $\\Delta t$，我们将解的数值近似表示为 $u_j^n \\approx u(x_j, t_n)$，其中 $x_j = j \\Delta x$ 且 $t_n = n \\Delta t$。\n\nCrank-Nicolson 离散格式由下式给出：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\frac{\\alpha}{2} \\left( \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{\\Delta x^2} + \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2} \\right)\n$$\n\n连续热传导方程满足极值原理，该原理指出，在给定的时空域内，最高温度出现在其边界上（或在初始时刻，或在空间边界上）。一个理想的数值格式应满足该原理的离散版本。满足离散极值原理的一个充分条件是，新时间步的解 $u_j^{n+1}$ 可以表示为前一时间步解 $\\{u_k^n\\}$ 的线性组合，且所有系数都为非负。\n\n定义网格傅里叶数 $r = \\frac{\\alpha \\Delta t}{\\Delta x^2}$。推导使 Crank-Nicolson 格式满足离散极值原理此充分条件并确保解非振荡的 $r$ 的最大值。", "solution": "我们将 Crank-Nicolson 更新写成算子形式。令 $L$ 为二阶差分算子\n$$ (Lu)_j = u_{j-1}-2u_j+u_{j+1},$$\n并设 $r=\\alpha\\Delta t/\\Delta x^2$。于是离散格式\n$$\\frac{u^{n+1}-u^n}{\\Delta t}\n=\\frac{\\alpha}{2\\Delta x^2}\\bigl(Lu^{n+1}+Lu^n\\bigr)$$\n变为\n$$\\Bigl(I-\\frac{r}{2}L\\Bigr)u^{n+1}\n=\\Bigl(I+\\frac{r}{2}L\\Bigr)u^n\\,. $$\n定义三对角矩阵\n$$A=I-\\frac{r}{2}L\n=\\mathrm{tridiag}\\bigl(-\\tfrac r2,\\;1+r,\\;-\\tfrac r2\\bigr)\\,,\\qquad\nB=I+\\frac{r}{2}L\\,. $$\n在等式右侧，$Bu^n$ 的各项为\n$$(Bu^n)_j\n=u_j^n+\\frac r2\\,(u_{j-1}^n-2u_j^n+u_{j+1}^n)\n=(1-r)\\,u_j^n+\\frac r2\\,\\bigl(u_{j-1}^n+u_{j+1}^n\\bigr)\\,. $$\n这些系数为正需要\n$$1-r\\ge0\\quad\\Longrightarrow\\quad r\\le1\\,. $$\n同时，$A$ 是严格对角占优的，\n$$1+r\\ge r\\,, $$\n因此是一个 M-矩阵，且 $A^{-1}\\ge0$。因此对于 $r\\le1$，\n$$u^{n+1}=A^{-1}B\\,u^n$$\n是 $u^n$ 的非负组合，并且离散极值原理成立。\n$r$ 的最大允许值为\n$$r=1\\,. $$", "answer": "$$\\boxed{1}$$", "id": "1126299"}, {"introduction": "真实世界的问题常常涉及复杂的边界条件，而不仅仅是固定的数值。这个练习将我们的分析扩展到包含随时间变化的 Neumann 边界条件，它规定了边界上的热通量 [@problem_id:1126336]。通过使用“虚拟点”法推导边界上的离散方程，您将学到一种将导数边界条件融入有限差分法的标准且强大的技术。这是将数值方法应用于更真实的物理和工程问题的必备技能。", "problem": "考虑一个关于函数 $u(x,t)$ 的一维热传导方程，其形式如下：\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}\n$$\n该方程定义在空间域 $x \\in [0, L]$ 和时间 $t \\ge 0$ 上。边界条件为在 $x=0$ 处的狄利克雷（Dirichlet）条件 $u(0,t) = 0$，以及在 $x=L$ 处的时间依赖的诺伊曼（Neumann）条件：\n$$\n\\frac{\\partial u}{\\partial x}(L,t) = g(t)\n$$\n其中 $g(t)$ 是一个已知函数。\n\n我们希望使用克兰克-尼科尔森（Crank-Nicolson）方法对该问题进行数值求解。将区域在空间上以均匀间距 $\\Delta x$ 离散，在时间上以均匀间距 $\\Delta t$ 离散，使得 $x_j = j\\Delta x$（对于 $j=0, 1, \\dots, N$，且 $N\\Delta x = L$）以及 $t_n = n\\Delta t$。令 $u_j^n$ 表示 $u(x_j, t_n)$ 的数值近似值。\n\n对于内部点，克兰克-尼科尔森格式由下式给出：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\frac{\\alpha}{2} \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} + \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2} \\right)\n$$\n为了处理 $j=N$ 处的诺伊曼边界条件，使用了一个二阶精度的中心差分近似。这需要引入一个位于 $x_{N+1} = L+\\Delta x$ 的“虚拟点”（ghost point）$u_{N+1}$。诺伊曼条件的离散形式在平均时间 $(t_n + t_{n+1})/2$ 处进行计算，这与克兰克-尼科尔森格式的时间中心化相对应。然而，为了简化线性系统的建立，我们将分别在时间层 $n$ 和 $n+1$ 上应用中心差分，并用它们来从主格式中消去虚拟点。\n\n由此得到的关于未知值 $\\mathbf{u}^{n+1} = (u_1^{n+1}, \\dots, u_N^{n+1})^T$ 的线性方程组可以写成矩阵形式 $A\\mathbf{u}^{n+1} = \\mathbf{d}$，其中向量 $\\mathbf{d}$ 包含了所有在已知时间层 $n$ 计算的项，以及来自边界条件的源项。\n\n你的任务是推导边界节点 $j=N$ 处的离散方程的完整右侧项。这对应于向量 $\\mathbf{d}$ 中的最后一个元素。请用 $u_N^n$、$u_{N-1}^n$、$\\Delta x$、$g^n = g(t_n)$、$g^{n+1} = g(t_{n+1})$ 以及无量纲参数 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$ 来表示你的答案。", "solution": "1. 在 $j=N$ 处的离散克兰克-尼科尔森格式：\n\n$$\n\\frac{u_N^{n+1}-u_N^n}{\\Delta t}\n=\\frac{\\alpha}{2(\\Delta x)^2}\\Bigl[(u_{N+1}^n-2u_N^n+u_{N-1}^n)+(u_{N+1}^{n+1}-2u_N^{n+1}+u_{N-1}^{n+1})\\Bigr].\n$$\n\n2. 两边乘以 $\\Delta t$ 并使用 $r=\\frac{\\alpha\\,\\Delta t}{(\\Delta x)^2}$：\n\n$$\nu_N^{n+1}-u_N^n\n=\\frac{r}{2}\\bigl[(u_{N+1}^n-2u_N^n+u_{N-1}^n)+(u_{N+1}^{n+1}-2u_N^{n+1}+u_{N-1}^{n+1})\\bigr].\n$$\n\n3. 通过诺伊曼边界条件处理虚拟点：\n\n$$\nu_{N+1}^n=u_{N-1}^n+2\\Delta x\\,g^n,\\quad\nu_{N+1}^{n+1}=u_{N-1}^{n+1}+2\\Delta x\\,g^{n+1}.\n$$\n\n4. 代入格式中：\n\n$$\n\\begin{aligned}\nu_N^{n+1}-u_N^n\n&=\\tfrac{r}{2}\\bigl[2(u_{N-1}^n-u_N^n+\\Delta x\\,g^n)\n+2(u_{N-1}^{n+1}-u_N^{n+1}+\\Delta x\\,g^{n+1})\\bigr]\\\\\n&=r\\bigl[u_{N-1}^n-u_N^n+u_{N-1}^{n+1}-u_N^{n+1}+\\Delta x\\,(g^n+g^{n+1})\\bigr].\n\\end{aligned}\n$$\n\n5. 将未知数 $u^{n+1}$ 收集到左侧：\n\n$$\nu_N^{n+1}+r\\,u_N^{n+1}-r\\,u_{N-1}^{n+1}\n=(1-r)u_N^n+r\\,u_{N-1}^n +r\\,\\Delta x\\,(g^n+g^{n+1}).\n$$\n\n6. 在矩阵形式 $A\\,\\mathbf u^{n+1}=\\mathbf d$ 中，$\\mathbf d$ 的最后一个元素是\n\n$$\nd_N=(1-r)\\,u_N^n + r\\,u_{N-1}^n + r\\,\\Delta x\\bigl(g^n+g^{n+1}\\bigr).\n$$", "answer": "$$\\boxed{(1-r)\\,u_N^n + r\\,u_{N-1}^n + r\\,\\Delta x\\,(g^n + g^{n+1})}$$", "id": "1126336"}]}