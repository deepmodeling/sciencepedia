{"hands_on_practices": [{"introduction": "本练习深入探讨了用于一维线性平流方程的灵活的$\\theta$-方法的稳定性。通过执行冯·诺依曼稳定性分析，你将推导出最大允许库朗数如何随参数$\\theta$变化。这个练习对于理解计算上更简单但条件稳定的显式方法，与在更高计算成本下提供更强稳定性的隐式方法之间的权衡至关重要。[@problem_id:1128167]", "problem": "考虑一维线性平流方程，该方程描述了标量 $u(x,t)$ 以恒定正速度 $c > 0$ 的输运过程：\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\n\n该偏微分方程可以被离散化并进行数值求解。一种常见的有限差分方法族是 $\\theta$ 方法。由于 $c > 0$，我们将对空间导数使用一阶迎风格式（具体来说是后向差分）。由此得到的关于 $u_j^n \\approx u(j\\Delta x, n\\Delta t)$ 的有限差分方程为：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\left[ (1-\\theta) \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) + \\theta \\left( \\frac{u_j^{n+1} - u_{j-1}^{n+1}}{\\Delta x} \\right) \\right] = 0\n$$\n其中 $\\Delta t$ 是时间步长，$\\Delta x$ 是网格间距，而 $\\theta \\in [0, 1]$ 是一个参数，它融合了显式时间步进格式（$\\theta=0$，前向 Euler 法）与隐式格式（$\\theta=1$，后向 Euler 法）。\n\n该数值格式的稳定性可以通过 von Neumann 稳定性分析来研究。我们寻求形如 $u_j^n = g^n e^{i k j \\Delta x}$ 的解，其中 $k$ 是波数，$g = g(k)$ 是放大因子。当且仅当对于所有可能的波数 $k$，都有 $|g| \\le 1$ 时，该格式是稳定的。\n\n一个已知的结果是，对于 $\\theta \\in [1/2, 1]$，该格式对于任意正的 Courant 数 $\\sigma = \\frac{c \\Delta t}{\\Delta x}$ 都是无条件稳定的。然而，对于 $\\theta \\in [0, 1/2)$，该格式只是条件稳定的。\n\n您的任务是推导，为保证该格式在 $\\theta \\in [0, 1/2)$ 范围内的稳定性，所允许的最大 Courant 数 $\\sigma_{\\text{max}}$ 作为参数 $\\theta$ 的函数表达式。", "solution": "我们对 $\\theta$ 方法迎风格式应用 von Neumann 分析。设 $\\sigma=c\\Delta t/\\Delta x$ 并代入试探解 $u_j^n=g^n e^{i\\xi j}$（其中 $\\xi=k\\Delta x$），整理后可得放大因子 $g$ 的表达式为：\n$$g\\bigl[1+\\theta\\sigma(1-e^{-i\\xi})\\bigr]=1-\\sigma(1-\\theta)(1-e^{-i\\xi}).$$\n稳定性要求对所有 $\\xi$ 都有 $|g|^2 \\le 1$。最严格的条件出现在 $\\xi=\\pi$（即 $e^{-i\\xi}=-1$）时。此时，放大因子为实数：\n$$ g = \\frac{1-2\\sigma(1-\\theta)}{1+2\\sigma\\theta} $$\n稳定性条件 $|g| \\le 1$ 变为 $-1 \\le g \\le 1$。\n右侧不等式 $g \\le 1$ 给出 $1-2\\sigma(1-\\theta) \\le 1+2\\sigma\\theta$，化简得 $-2\\sigma+2\\sigma\\theta \\le 2\\sigma\\theta$，即 $-2\\sigma \\le 0$，这对 $\\sigma>0$ 恒成立。\n左侧不等式 $g \\ge -1$ 给出 $1-2\\sigma(1-\\theta) \\ge -(1+2\\sigma\\theta)$，化简得 $1-2\\sigma+2\\sigma\\theta \\ge -1-2\\sigma\\theta$，即 $2 \\ge 2\\sigma-4\\sigma\\theta = 2\\sigma(1-2\\theta)$。\n因此，我们得到 $\\sigma(1-2\\theta) \\le 1$。\n对于 $\\theta \\in [0, 1/2)$，有 $1-2\\theta > 0$，所以稳定性极限为：\n$$ \\sigma \\le \\frac{1}{1-2\\theta} $$\n因此，对于 $\\theta \\in [0, 1/2)$，最大允许库朗数为\n$$ \\sigma_{\\max}=\\frac{1}{1-2\\theta} $$", "answer": "$$\\boxed{\\frac{1}{1-2\\theta}}$$", "id": "1128167"}, {"introduction": "在一维分析的基础上，本问题挑战你在更真实的二维背景下研究稳定性。你将对二维线性平流方程的一阶迎风格式应用冯·诺依曼分析。其目标是推导出著名的二维Courant-Friedrichs-Lewy (CFL)条件，这是计算流体力学和其他涉及多维输运现象领域中的一个关键稳定性约束。[@problem_id:1128038]", "problem": "考虑标量场 $u(x, y, t)$ 的二维线性平流方程：\n$$\n\\frac{\\partial u}{\\partial t} + c_x \\frac{\\partial u}{\\partial x} + c_y \\frac{\\partial u}{\\partial y} = 0\n$$\n其中 $c_x$ 和 $c_y$ 分别是 $x$ 和 $y$ 方向上的恒定正平流速度。\n\n该方程在一个均匀的方形网格上进行离散化，两个方向上的空间步长均为 $h$（$\\Delta x = \\Delta y = h$），时间步长为 $\\Delta t$。在网格点 $(x_i, y_j)$ 和时间 $t^n$ 处的数值近似解表示为 $u_{i,j}^n$。该格式对时间导数使用前向欧拉法，对空间导数使用一阶迎风格式。给定 $c_x > 0$ 和 $c_y > 0$，该迎风格式由下式给出：\n$$\n\\frac{\\partial u}{\\partial x}\\bigg|_{i,j,n} \\approx \\frac{u_{i,j}^n - u_{i-1,j}^n}{h} \\quad \\text{and} \\quad \\frac{\\partial u}{\\partial y}\\bigg|_{i,j,n} \\approx \\frac{u_{i,j}^n - u_{i,j-1}^n}{h}\n$$\n该数值格式的稳定性由 Courant-Friedrichs-Lewy (CFL) 条件决定，该条件对库朗数 $\\lambda_x = \\frac{c_x \\Delta t}{h}$ 和 $\\lambda_y = \\frac{c_y \\Delta t}{h}$ 施加了一个上限。具体来说，为使格式对所有可能的初始条件都稳定，库朗数之和 $S = \\lambda_x + \\lambda_y$ 必须满足不等式 $S \\le S_{max}$，其中 $S_{max}$ 是一个常数。\n\n使用 Von Neumann 稳定性分析，推导允许的库朗数之和的最大值 $S_{max}$。", "solution": "1. 相关方程：迎风格式的更新方程为\n$$\nu_{i,j}^{n+1}\n= u_{i,j}^n - \\lambda_x\\bigl(u_{i,j}^n - u_{i-1,j}^n\\bigr)\n            - \\lambda_y\\bigl(u_{i,j}^n - u_{i,j-1}^n\\bigr),\n$$\n其中 $\\lambda_x = \\frac{c_x\\Delta t}{h}$，$\\lambda_y = \\frac{c_y\\Delta t}{h}$ 且 $S=\\lambda_x+\\lambda_y$。\nVon Neumann 分析假设一个傅里叶模式 $u_{i,j}^n = G^n e^{i(k_x x_i + k_y y_j)}$。\n\n2. 代入可得放大因子\n$$\nG = 1 - \\lambda_x\\bigl(1 - e^{-i\\theta_x}\\bigr)\n      - \\lambda_y\\bigl(1 - e^{-i\\theta_y}\\bigr),\n\\quad \\theta_x = k_x h,\\ \\theta_y = k_y h.\n$$\n\n3. 为了保证稳定性，我们要求对所有的 $\\theta_x,\\theta_y$ 都有 $|G|\\le1$。$|G|$ 的最大值出现在 $\\theta_x=\\pi$ 和 $\\theta_y=\\pi$ 时，此时 $e^{-i\\pi}=-1$。在这种最坏情况下：\n$$\nG = 1 - \\lambda_x(1-(-1)) - \\lambda_y(1-(-1))\n= 1 - 2\\lambda_x - 2\\lambda_y = 1 - 2S.\n$$\n稳定性条件 $|G|\\le1$ 变为\n$$\n|1 - 2S|\\le1\n\\quad\\Longrightarrow\\quad\n-1 \\le 1-2S \\le 1\n\\quad\\Longrightarrow\\quad\n0 \\le S \\le 1.\n$$\n因此，允许的库朗数之和的最大值为\n$$\nS_{\\max} = 1.\n$$", "answer": "$$\\boxed{1}$$", "id": "1128038"}, {"introduction": "认识到并非所有直观的数值格式都是稳定的是至关重要的。本练习聚焦于证明一维波动方程的前向时间中心空间(FTCS)格式的无条件不稳定性，这是数值分析中的一个经典警示案例。你将使用矩阵方法——一种非常适合处理具有特定边界条件的有限区域问题的冯·诺依曼分析替代方法——来找到放大矩阵的谱半径，并证明它总是大于1。[@problem_id:1128196]", "problem": "一维波动方程由下式给出\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\n对于空间域 $x \\in [0, L]$ 和时间 $t \\ge 0$ 上的函数 $u(x,t)$。参数 $c$ 是恒定的波速。该方程服从狄利克雷（Dirichlet）边界条件，$u(0,t) = u(L,t) = 0$。\n\n为了数值求解该方程，首先通过引入辅助函数 $v(x,t) = \\frac{\\partial u}{\\partial t}$ 将其转化为一个一阶偏微分方程组：\n$$\n\\frac{\\partial u}{\\partial t} = v \\\\\n\\frac{\\partial v}{\\partial t} = c^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\n通过将空间域离散化为 $N$ 个等宽区间 $\\Delta x = L/N$ 来构造数值格式，网格点为 $x_j = j\\Delta x$，$j=0, 1, \\dots, N$。令 $u_j^n \\approx u(x_j, n\\Delta t)$ 和 $v_j^n \\approx v(x_j, n\\Delta t)$，其中 $\\Delta t$ 是时间步长。\n\n“时间向前，空间居中”（FTCS）格式应用于该方程组：对两个方程均使用时间上的向前差分，对空间导数使用二阶中心差分。\n$$\n\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = v_j^n \\\\\n\\frac{v_j^{n+1}-v_j^n}{\\Delta t} = c^2 \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\n已知该格式是无条件不稳定的。你的任务是量化这种不稳定性。通过考虑内部网格点向量 $\\mathbf{W}^n = [\\mathbf{U}^n, \\mathbf{V}^n]^T$ 的演化，其中 $\\mathbf{U}^n = [u_1^n, \\dots, u_{N-1}^n]^T$ 和 $\\mathbf{V}^n = [v_1^n, \\dots, v_{N-1}^n]^T$，该格式可以写成矩阵形式 $\\mathbf{W}^{n+1} = M \\mathbf{W}^n$。\n\n使用稳定性分析的矩阵方法，推导放大矩阵 $M$ 的谱半径 $\\rho(M)$ 的表达式。用库朗数（Courant number） $\\lambda = \\frac{c\\Delta t}{\\Delta x}$ 和空间区间数 $N$ 来表示你的最终答案。", "solution": "给定的数值格式为：\n$$\nu_j^{n+1} = u_j^n + \\Delta t \\, v_j^n\n$$\n$$\nv_j^{n+1} = v_j^n + c^2 \\frac{\\Delta t}{(\\Delta x)^2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n我们使用狄利克雷（Dirichlet）边界条件 $u_0^n = u_N^n = 0$，在内部网格点 $j=1, 2, \\dots, N-1$ 上分析该格式。\n\n令 $\\mathbf{U}^n = [u_1^n, u_2^n, \\dots, u_{N-1}^n]^T$ 和 $\\mathbf{V}^n = [v_1^n, v_2^n, \\dots, v_{N-1}^n]^T$。该方程组可以写成矩阵形式。空间二阶导数由 $(N-1) \\times (N-1)$ 的三对角矩阵 $A$ 表示：\n$$\nA = \\begin{pmatrix}\n-2 & 1 & 0 & \\cdots & 0 \\\\\n1 & -2 & 1 & \\cdots & 0 \\\\\n0 & \\ddots & \\ddots & \\ddots & 0 \\\\\n\\vdots & & 1 & -2 & 1 \\\\\n0 & \\cdots & 0 & 1 & -2\n\\end{pmatrix}\n$$\n令库朗数为 $\\lambda = \\frac{c\\Delta t}{\\Delta x}$。差分方程组变为：\n$$\n\\mathbf{U}^{n+1} = I \\mathbf{U}^n + (\\Delta t) I \\mathbf{V}^n\n$$\n$$\n\\mathbf{V}^{n+1} = \\frac{c^2 \\Delta t}{(\\Delta x)^2} A \\mathbf{U}^n + I \\mathbf{V}^n = \\frac{\\lambda^2}{\\Delta t} A \\mathbf{U}^n + I \\mathbf{V}^n\n$$\n其中 $I$ 是 $(N-1) \\times (N-1)$ 的单位矩阵。\n\n我们构造状态向量 $\\mathbf{W}^n = \\begin{pmatrix} \\mathbf{U}^n \\\\ \\mathbf{V}^n \\end{pmatrix}$。于是格式为 $\\mathbf{W}^{n+1} = M \\mathbf{W}^n$，其中放大矩阵 $M$ 是一个 $2(N-1) \\times 2(N-1)$ 的分块矩阵：\n$$\nM = \\begin{pmatrix}\nI & (\\Delta t) I \\\\\n\\frac{\\lambda^2}{\\Delta t} A & I\n\\end{pmatrix}\n$$\n为了求谱半径 $\\rho(M)$，我们需要求 $M$ 的特征值。设 $\\mu$ 是 $M$ 的一个特征值，$\\mathbf{w} = \\begin{pmatrix} \\mathbf{w}_1 \\\\ \\mathbf{w}_2 \\end{pmatrix}$ 是对应的特征向量。特征值问题 $M\\mathbf{w} = \\mu\\mathbf{w}$ 给出方程组：\n$$\n\\mathbf{w}_1 + (\\Delta t) \\mathbf{w}_2 = \\mu \\mathbf{w}_1\n$$\n$$\n\\frac{\\lambda^2}{\\Delta t} A \\mathbf{w}_1 + \\mathbf{w}_2 = \\mu \\mathbf{w}_2\n$$\n为使该系统对于 $\\mathbf{w}_1, \\mathbf{w}_2$ 有非平凡解，它们必须与 $A$ 的一个特征向量 $\\mathbf{v}_k$ 成比例，其对应的特征值为 $\\alpha_k$。这使得矩阵方程组退化为标量方程组，其系数矩阵的行列式必须为零：\n$$\n\\det \\begin{pmatrix} 1-\\mu & \\Delta t \\\\ \\frac{\\lambda^2\\alpha_k}{\\Delta t} & 1-\\mu \\end{pmatrix} = 0\n$$\n$$\n(1-\\mu)^2 - \\lambda^2 \\alpha_k = 0\n$$\n矩阵 $A$ 的特征值是众所周知的：\n$$\n\\alpha_k = -4 \\sin^2\\left(\\frac{k\\pi}{2N}\\right), \\quad k=1, 2, \\dots, N-1\n$$\n将 $\\alpha_k$ 代入 $\\mu$ 的方程：\n$$\n(1-\\mu)^2 = -4\\lambda^2 \\sin^2\\left(\\frac{k\\pi}{2N}\\right)\n$$\n对两边取平方根：\n$$\n1-\\mu = \\pm \\sqrt{-4\\lambda^2 \\sin^2\\left(\\frac{k\\pi}{2N}\\right)} = \\pm 2i\\lambda \\sin\\left(\\frac{k\\pi}{2N}\\right)\n$$\n因此，放大矩阵 $M$ 的特征值 $\\mu_k$ 为：\n$$\n\\mu_k = 1 \\mp 2i\\lambda \\sin\\left(\\frac{k\\pi}{2N}\\right)\n$$\n这些复特征值的模为：\n$$\n|\\mu_k| = \\sqrt{1^2 + \\left( \\pm 2\\lambda \\sin\\left(\\frac{k\\pi}{2N}\\right) \\right)^2} = \\sqrt{1 + 4\\lambda^2 \\sin^2\\left(\\frac{k\\pi}{2N}\\right)}\n$$\n谱半径 $\\rho(M)$ 是在所有可能的 $k$ 值上这些模的最大值。为了求最大值，我们需要最大化 $\\sin^2\\left(\\frac{k\\pi}{2N}\\right)$。由于参数 $\\frac{k\\pi}{2N}$ 位于区间 $(0, \\pi/2)$ 内，其最大值在 $k$ 取最大值时达到，即 $k=N-1$。\n正弦项的最大值为 $\\sin\\left(\\frac{(N-1)\\pi}{2N}\\right) = \\sin\\left(\\frac{\\pi}{2} - \\frac{\\pi}{2N}\\right) = \\cos\\left(\\frac{\\pi}{2N}\\right)$。\n将此代入谱半径的表达式：\n$$\n\\rho(M) = \\sqrt{1 + 4\\lambda^2 \\cos^2\\left(\\frac{\\pi}{2N}\\right)}\n$$\n对于任何 $\\lambda > 0$ 和任何有限的 $N \\ge 2$，都有 $\\cos(\\frac{\\pi}{2N}) > 0$，因此 $\\rho(M) > 1$。这证实了该格式是无条件不稳定的，因为无论 $\\Delta t$ 和 $\\Delta x$ 如何选择，至少有一个特征值的模总是大于1。", "answer": "$$\n\\boxed{\\sqrt{1 + 4\\lambda^2 \\cos^2\\left(\\frac{\\pi}{2N}\\right)}}\n$$", "id": "1128196"}]}