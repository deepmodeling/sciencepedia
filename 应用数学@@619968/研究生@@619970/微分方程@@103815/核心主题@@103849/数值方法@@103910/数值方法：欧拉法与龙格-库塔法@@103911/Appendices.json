{"hands_on_practices": [{"introduction": "前向欧拉法是数值求解常微分方程最直观的起点。然而，其简洁性的背后也隐藏着一个重要的警示：步长 $h$ 的选择会极大地影响解的有效性。本练习通过将欧拉法应用于经典的逻辑斯谛（logistic）人口模型，来探索数值稳定性的概念。你将发现，过大的步长会导致诸如负人口数之类的非物理解，通过计算临界步长，你将亲身体验如何分析并确保数值模拟的稳定性 [@problem_id:1126852]。", "problem": "逻辑斯谛方程（logistic equation）是描述种群增长的常见模型，其常微分方程为：\n$$\ny'(t) = r y(t) \\left(1 - \\frac{y(t)}{K}\\right)\n$$\n这里，$y(t)$ 是时间 $t$ 时的种群数量，$r$ 是内禀增长率，$K$ 是环境承载能力。$r$ 和 $K$ 均为正实数常量。\n\n考虑初始条件 $y(0) = y_0$，其中初始种群数量大于环境承载能力，即 $y_0 > K$。在这种情况下，其精确解表明种群数量会随时间推移而减少，从上方渐近地趋近于环境承载能力 $K$。\n\n在使用前向欧拉法对此微分方程进行数值求解时，时间步长 $h$ 的选择对于获得具有物理意义的解至关重要。前向欧拉法的更新规则为 $y_{n+1} = y_n + h f(t_n, y_n)$。如果 $h$ 过大，数值解可能会变为负数，而种群数量不可能为负。\n\n请确定临界步长 $h_c$，使得从 $y_0$ 开始的前向欧拉法的第一步恰好产生零值（$y_1 = 0$）。这个值 $h_c$ 标志着第一步的稳定性阈值；任何大于 $h_c$ 的步长 $h$ 都将导致不具物理意义的负种群数量 $y_1 < 0$。您的最终答案应为一个用 $r$、$K$ 和 $y_0$ 表示的表达式。", "solution": "我们将前向欧拉法更新规则应用于逻辑斯谛方程，\n$$\ny_{n+1}=y_n+h\\,r\\,y_n\\Bigl(1-\\frac{y_n}{K}\\Bigr).\n$$\n对于第一步 $n=0$，可得\n$$\ny_1=y_0+h\\,r\\,y_0\\Bigl(1-\\frac{y_0}{K}\\Bigr).\n$$\n我们要求 $y_1=0$，因此\n$$\n0=y_0+h\\,r\\,y_0\\Bigl(1-\\frac{y_0}{K}\\Bigr).\n$$\n两边同除以 $y_0\\neq0$，\n$$\n0=1+h\\,r\\Bigl(1-\\frac{y_0}{K}\\Bigr)\n\\;\\;\\Longrightarrow\\;\\;\nh\\,r\\Bigl(1-\\frac{y_0}{K}\\Bigr)=-1.\n$$\n解出 $h$，\n$$\nh=\\frac{-1}{r\\bigl(1-\\frac{y_0}{K}\\bigr)}\n=\\frac{1}{r\\bigl(\\frac{y_0}{K}-1\\bigr)}\n=\\frac{K}{r\\,(y_0-K)}.\n$$", "answer": "$$\\boxed{\\frac{K}{r\\,(y_0-K)}}$$", "id": "1126852"}, {"introduction": "认识到一阶欧拉法的局限性后，我们自然会寻求构建更精确的高阶方法。龙格-库塔（Runge-Kutta）方法族正是为此而生，但其特征系数是如何确定的呢？本练习将带你深入这些方法的理论核心，引导你推导一个通用的两阶段方法为达到二阶精度所必须满足的代数条件。理解这些“阶条件”，是领会这些强大数值工具背后精巧设计的关键一步 [@problem_id:1126825]。", "problem": "一个求解初值问题 $y'(t) = f(t, y(t))$，$y(t_0) = y_0$ 的通用两阶段显式龙格-库塔 (RK) 方法可写为：\n$$y_{n+1} = y_n + h(b_1 k_1 + b_2 k_2)$$\n其中 $h$ 是步长，阶段 $k_i$ 由下式给出：\n$$k_1 = f(t_n, y_n)$$\n$$k_2 = f(t_n + c_2 h, y_n + a_{21} h k_1)$$\n该方法由常数 $b_1$、$b_2$、$c_2$ 和 $a_{21}$ 表征。为简化阶条件的推导，通常施加条件 $a_{21} = c_2$。\n\n该方法的局部截断误差定义为 $T_{n+1} = y(t_{n+1}) - y_{n+1}$，其中 $y(t)$ 是精确解，并假设 $y_n = y(t_n)$。如果 $T_{n+1} = O(h^{p+1})$，则称该方法的阶为 $p$。\n\n考虑一个满足约束条件 $a_{21} = c_2$ 的此类方法。为使方法达到二阶精度（即 $p=2$），参数 $b_1$、$b_2$ 和 $c_2$ 必须满足一组代数方程。假设参数 $c_2$ 固定为一个非零常数 $\\alpha$。假设该方法是二阶精度的，推导以 $\\alpha$ 表示的量 $b_1 - b_2$ 的表达式。", "solution": "我们要求该方法在 $c_2=\\alpha$ 的情况下满足二阶条件：\n1. 相容性（一阶）：\n$$b_1+b_2=1.$$\n2. 二阶条件：\n$$\\sum_{i}b_i c_i=b_2c_2=\\tfrac12.$$\n代入 $c_2=\\alpha$：\n$$b_2\\alpha=\\tfrac12\\;\\Longrightarrow\\;b_2=\\frac1{2\\alpha}.$$\n则\n$$b_1=1-b_2=1-\\frac1{2\\alpha}.$$\n因此\n$$b_1-b_2=\\Bigl(1-\\frac1{2\\alpha}\\Bigr)-\\frac1{2\\alpha}\n=1-\\frac1\\alpha=\\frac{\\alpha-1}{\\alpha}.$$", "answer": "$$\\boxed{\\frac{\\alpha-1}{\\alpha}}$$", "id": "1126825"}, {"introduction": "上一个练习揭示了，满足二阶精度条件的可以是一整个方法族。这引出了一个自然的问题：在实际应用中，所有二阶龙格-库塔方法的效果都不同吗？本练习通过直接比较两种流行的二阶方案——休恩法（Heun's method）和显式中点法（explicit midpoint method）来回答这个问题。通过将这两种方法应用于一个一般的线性常微分方程，你将发现它们之间一个出人意料却又极为深刻的联系，从而加深你对其内在结构和行为的理解 [@problem_id:1126960]。", "problem": "考虑如下线性常微分方程的初值问题：\n$$\ny'(t) = a y(t) + b\n$$\n其初始条件为 $y(t_0) = y_0$，其中 $a$ 和 $b$ 是实常数。\n我们希望用步长 $h$ 和两种不同的二阶 Runge-Kutta 方法来近似该方程在 $t_1 = t_0 + h$ 处的解。\n\n第一种方法是 **Heun 法**（也称为改进欧拉法或梯形法则），对于一般函数 $f(t,y)$，其迭代格式定义为：\n$$\n\\begin{aligned}\nk_1 &= f(t_n, y_n) \\\\\nk_2 &= f(t_n + h, y_n + h k_1) \\\\\ny_{n+1} &= y_n + \\frac{h}{2}(k_1 + k_2)\n\\end{aligned}\n$$\n\n第二种方法是**显式中点法**，其迭代格式定义为：\n$$\n\\begin{aligned}\nk_1^* &= f(t_n, y_n) \\\\\nk_2^* &= f(t_n + \\frac{h}{2}, y_n + \\frac{h}{2} k_1^*) \\\\\ny_{n+1} &= y_n + h k_2^*\n\\end{aligned}\n$$\n\n令 $y_1^{\\text{Heun}}$ 为从 $(t_0, y_0)$ 开始，使用 Heun 法计算一个步长后得到的 $y(t_1)$ 的近似值，并令 $y_1^{\\text{midpoint}}$ 为使用显式中点法计算一个步长后得到的 $y(t_1)$ 的近似值。\n\n推导差值 $D = y_1^{\\text{Heun}} - y_1^{\\text{midpoint}}$ 用参数 $a, b, y_0$ 和 $h$ 表示的表达式。", "solution": "我们有常微分方程\n$$y'=f(t,y)=a\\,y+b,\\quad y(t_0)=y_0.$$\n\n1. Heun 法：\n$$k_1=f(t_0,y_0)=a y_0+b,$$\n$$k_2=f\\bigl(t_0+h,\\;y_0+h\\,k_1\\bigr)\n   =a\\bigl(y_0+h(a y_0+b)\\bigr)+b\n   =a y_0+a^2y_0h+a b h+b.$$\n因此\n$$y_1^{\\rm Heun}\n=y_0+\\frac{h}{2}(k_1+k_2)\n=y_0+\\frac{h}{2}\\Bigl(2(a y_0+b)+a^2y_0h+a b h\\Bigr)$$\n$$\\quad\n=y_0+h(a y_0+b)+\\frac{a^2y_0h^2}{2}+\\frac{a b h^2}{2}.$$\n\n2. 显式中点法：\n$$k_1^*=a y_0+b,$$\n$$k_2^*=f\\Bigl(t_0+\\frac{h}{2},\\;y_0+\\frac{h}{2}k_1^*\\Bigr)\n=a\\Bigl(y_0+\\frac{h}{2}(a y_0+b)\\Bigr)+b\n=a y_0+\\frac{a^2y_0h}{2}+\\frac{a b h}{2}+b.$$\n从而\n$$y_1^{\\rm midpoint}\n=y_0+h k_2^*\n=y_0+h\\Bigl(a y_0+b+\\tfrac{a^2y_0h}{2}+\\tfrac{a b h}{2}\\Bigr)$$\n$$\\quad\n=y_0+h(a y_0+b)+\\frac{a^2y_0h^2}{2}+\\frac{a b h^2}{2}.$$\n\n由于两个公式的结果相同，它们的差为\n$$D=y_1^{\\rm Heun}-y_1^{\\rm midpoint}=0.$$", "answer": "$$\\boxed{0}$$", "id": "1126960"}]}