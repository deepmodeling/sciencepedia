{"hands_on_practices": [{"introduction": "为了真正掌握打靶法，我们首先从一个线性边值问题开始。对于线性常微分方程，一个美妙的特性是解的叠加原理成立。这意味着我们可以将复杂问题的解分解为几个简单问题的解的线性组合。这个练习将引导你利用叠加原理，通过解析方式精确地求解出满足边界条件的初始斜率，而无需进行数值迭代。通过这个过程，你将深刻理解打靶法中为何需要求解两个独立的初值问题，以及它们是如何组合成最终解的。[@problem_id:1127615]", "problem": "一个物理系统由一个受迫谐振子的非齐次线性常微分方程（ODE）描述：\n$$y''(x) + k^2 y(x) = f(x)$$\n其中 $k$ 是一个代表振子固有频率的正常数。该系统定义在域 $x \\in [0, L]$ 上，并服从边界条件 $y(0) = \\alpha$ 和 $y(L) = \\beta$。外部驱动函数是线性的，由 $f(x) = Cx$ 给出，其中 $C$ 是一个常数。\n\n为求解此边值问题（BVP），可以使用打靶法。这种数值技术通过为初始斜率 $s = y'(0)$ 选择一个试探值，将BVP转换为一个初值问题（IVP）。IVP的解（记为 $y(x; s)$）依赖于 $s$ 的选择。正确的斜率 $s$ 是能使解满足第二个边界条件的斜率，即 $y(L; s) = \\beta$。\n\n对于线性ODE，此过程可以解析地完成。解 $y(x; s)$ 可以表示为两个更简单的IVP的解的线性组合。令 $u(x)$ 为以下IVP的解：\n$$u'' + k^2 u = Cx, \\quad u(0) = \\alpha, \\quad u'(0) = 0$$\n并令 $v(x)$ 为以下齐次IVP的解：\n$$v'' + k^2 v = 0, \\quad v(0) = 0, \\quad v'(0) = 1$$\n那么，初始斜率为 $s$ 的、与 BVP 对应的 IVP 的解由叠加原理 $y(x; s) = u(x) + s \\cdot v(x)$ 给出。\n\n利用打靶法的这种解析形式，推导所需初始斜率 $s = y'(0)$ 关于参数 $k, L, C, \\alpha$ 和 $\\beta$ 的封闭形式表达式。假设对于任何整数 $n$，$kL \\neq n\\pi$ 均成立，这确保了唯一解的存在。", "solution": "目标是求出初始斜率 $s = y'(0)$，使得初值问题的解 $y(x; s)$ 满足在 $x=L$ 处的边界条件。解由线性叠加给出：\n$$y(x; s) = u(x) + s \\cdot v(x)$$\n我们必须施加边界条件 $y(L; s) = \\beta$：\n$$u(L) + s \\cdot v(L) = \\beta$$\n求解未知斜率 $s$ 可得：\n$$s = \\frac{\\beta - u(L)}{v(L)}$$\n为使用此公式，我们首先需要求出两个指定的初值问题对应的解 $u(x)$ 和 $v(x)$。\n\n**1. 求解 $u(x)$**\n\n$u(x)$ 的 IVP 为：\n$$u'' + k^2 u = Cx, \\quad u(0) = \\alpha, \\quad u'(0) = 0$$\n通解是齐次解 $u_h(x)$ 和一个特解 $u_p(x)$ 之和。\n齐次方程 $u_h'' + k^2 u_h = 0$ 的解为：\n$$u_h(x) = A \\cos(kx) + B \\sin(kx)$$\n对于特解，我们使用待定系数法。由于驱动项为 $Cx$，我们尝试形式为 $u_p(x) = D_1 x + D_0$ 的解。\n将其代入ODE：\n$$u_p''(x) + k^2 u_p(x) = 0 + k^2(D_1 x + D_0) = k^2 D_1 x + k^2 D_0$$\n与驱动项 $Cx$ 比较，可得 $k^2 D_1 = C$ 和 $k^2 D_0 = 0$。这给出 $D_1 = C/k^2$ 和 $D_0 = 0$。\n因此，特解为 $u_p(x) = \\frac{C}{k^2}x$。\n$u(x)$ 的通解为：\n$$u(x) = A \\cos(kx) + B \\sin(kx) + \\frac{C}{k^2}x$$\n现在，我们应用 $u(x)$ 的初始条件。\n$u(0) = A \\cos(0) + B \\sin(0) + 0 = A$。由 $u(0)=\\alpha$，可得 $A = \\alpha$。\n导数为 $u'(x) = -kA \\sin(kx) + kB \\cos(kx) + \\frac{C}{k^2}$。\n$u'(0) = -kA \\sin(0) + kB \\cos(0) + \\frac{C}{k^2} = kB + \\frac{C}{k^2}$。由 $u'(0)=0$，可得 $kB + \\frac{C}{k^2} = 0$，这意味着 $B = -\\frac{C}{k^3}$。\n因此，$u(x)$ 的解为：\n$$u(x) = \\alpha \\cos(kx) - \\frac{C}{k^3} \\sin(kx) + \\frac{C}{k^2}x$$\n\n**2. 求解 $v(x)$**\n\n$v(x)$ 的 IVP 为：\n$$v'' + k^2 v = 0, \\quad v(0) = 0, \\quad v'(0) = 1$$\n这是一个齐次ODE。其通解是：\n$$v(x) = F \\cos(kx) + G \\sin(kx)$$\n应用 $v(x)$ 的初始条件：\n$v(0) = F \\cos(0) + G \\sin(0) = F$。由 $v(0)=0$，可得 $F=0$。\n导数为 $v'(x) = -kF \\sin(kx) + kG \\cos(kx)$。\n$v'(0) = -kF \\sin(0) + kG \\cos(0) = kG$。由 $v'(0)=1$，可得 $kG=1$，这意味着 $G = \\frac{1}{k}$。\n因此，$v(x)$ 的解为：\n$$v(x) = \\frac{1}{k} \\sin(kx)$$\n\n**3. 计算初始斜率 $s$**\n\n现在我们在 $x=L$ 处计算 $u(x)$ 和 $v(x)$ 的值：\n$$u(L) = \\alpha \\cos(kL) - \\frac{C}{k^3} \\sin(kL) + \\frac{CL}{k^2}$$\n$$v(L) = \\frac{1}{k} \\sin(kL)$$\n注意，条件 $kL \\neq n\\pi$ 确保了 $\\sin(kL) \\neq 0$，因此 $v(L) \\neq 0$。\n最后，我们将这些值代入 $s$ 的表达式中：\n$$s = \\frac{\\beta - u(L)}{v(L)} = \\frac{\\beta - \\left(\\alpha \\cos(kL) - \\frac{C}{k^3} \\sin(kL) + \\frac{CL}{k^2}\\right)}{\\frac{1}{k} \\sin(kL)}$$\n为进行化简，将分子和分母同乘以 $k$：\n$$s = \\frac{k}{\\sin(kL)} \\left( \\beta - \\alpha \\cos(kL) + \\frac{C}{k^3} \\sin(kL) - \\frac{CL}{k^2} \\right)$$\n将项 $\\frac{k}{\\sin(kL)}$ 展开：\n$$s = \\frac{k\\beta}{\\sin(kL)} - \\frac{k\\alpha \\cos(kL)}{\\sin(kL)} + \\frac{k}{\\sin(kL)}\\frac{C \\sin(kL)}{k^3} - \\frac{k}{\\sin(kL)}\\frac{CL}{k^2}$$\n简化各项：\n$$s = k\\beta \\csc(kL) - k\\alpha \\cot(kL) + \\frac{C}{k^2} - \\frac{CL}{k} \\csc(kL)$$\n此表达式给出了满足边界条件所需的初始斜率 $s=y'(0)$。", "answer": "$$\\boxed{\\frac{C}{k^2} + k\\beta\\csc(kL) - k\\alpha\\cot(kL) - \\frac{CL}{k}\\csc(kL)}$$", "id": "1127615"}, {"introduction": "在上一个练习中，我们解析地应用了叠加原理。现在，让我们将这个原理应用到一个更接近实际数值计算的场景中。在实际操作中，我们通常通过数值积分（如龙格-库塔法）来获得辅助问题的解。这个练习巧妙地将积分步骤与代数组合步骤分开：它直接为你提供了在特定点上两个辅助解的数值结果。你的任务是利用这些给定的值，计算出正确的初始斜率并求得最终解在某一点的数值，从而巩固你对线性打靶法核心代数步骤的理解。[@problem_id:1127848]", "problem": "一个线性非齐次二阶边值问题 (BVP) 在区间 $[a, b]$ 上由以下微分方程定义\n$$y''(x) - p(x) y'(x) - q(x) y(x) = r(x)$$\n边界条件为 $y(a) = \\alpha$ 和 $y(b) = \\beta$。\n\n打靶法是求解此类边值问题的一种数值技术。它依赖于线性叠加原理。解 $y(x)$ 可以由两个辅助初值问题 (IVP) 的解 $u(x)$ 和 $v(x)$ 构造。解由 $y(x) = u(x) + s \\cdot v(x)$ 给出，其中 $s$ 是初始未知的斜率 $y'(a)$，其取值必须满足在 $x=b$ 处的边界条件。\n\n第一个辅助问题，针对函数 $u(x)$，由原始的非齐次方程和特定的初始条件定义：\n$$u''(x) - p(x) u'(x) - q(x) u(x) = r(x), \\quad u(a) = \\alpha, \\quad u'(a) = 0$$\n\n第二个辅助问题，针对函数 $v(x)$，由相应的齐次方程和特定的初始条件定义：\n$$v''(x) - p(x) v'(x) - q(x) v(x) = 0, \\quad v(a) = 0, \\quad v'(a) = 1$$\n\n考虑一个在区间 $[a, b] = [0, 1]$ 上的特定边值问题，其边界条件为 $y(0) = 1$ 和 $y(1) = e+1$，其中 $e$ 是自然对数的底数。对两个相应的辅助初值问题进行高精度数值积分，得到 $u(x)$ 和 $v(x)$ 在中点 $x=0.5$ 和端点 $x=1$ 处的值如下：\n- $u(0.5) = \\sqrt{e} - \\frac{1}{2}$\n- $u(1) = e - 1$\n- $v(0.5) = \\sqrt{e} - 1$\n- $v(1) = e - 1$\n\n使用这些信息，确定该边值问题的解在其中点 $y(0.5)$ 处的值。", "solution": "我们应用打靶法的表达式\n$$y(x)=u(x)+s\\,v(x),\\quad s=\\frac{y(b)-u(b)}{v(b)}.$$\n此处 $b=1$, $y(1)=e+1$, $u(1)=e-1$, $v(1)=e-1$，所以\n$$\ns=\\frac{(e+1)-(e-1)}{\\,e-1\\,}=\\frac{2}{e-1}.\n$$\n因此\n$$\ny(x)=u(x)+\\frac{2}{e-1}\\,v(x).\n$$\n在 $x=\\frac{1}{2}$ 处，我们有 $u(\\frac{1}{2})=\\sqrt{e}-\\frac{1}{2}$，$v(\\frac{1}{2})=\\sqrt{e}-1$，因此\n$$\ny\\bigl(\\frac{1}{2}\\bigr)\n=\\Bigl(\\sqrt{e}-\\frac{1}{2}\\Bigr)\n+\\frac{2}{e-1}\\,\\Bigl(\\sqrt{e}-1\\Bigr).\n$$\n注意到 $e-1=(\\sqrt{e}-1)(\\sqrt{e}+1)$，可得 $\\frac{\\sqrt{e}-1}{e-1}=\\frac{1}{\\sqrt{e}+1}$，因此\n$$\ny\\bigl(\\frac{1}{2}\\bigr)\n=\\sqrt{e}-\\frac{1}{2}+\\frac{2}{\\sqrt{e}+1}.\n$$", "answer": "$$\\boxed{\\sqrt{e} - \\frac12 + \\frac{2}{\\sqrt{e}+1}}$$", "id": "1127848"}, {"introduction": "线性问题的优雅叠加法在非线性世界中不再适用。当微分方程包含如 $y^2$ 这样的非线性项时，我们必须采用迭代方法来寻找正确的“射击”角度。牛顿法是一种强大且高效的求根工具，非常适合这项任务。这个练习将带你进入非线性打靶法的核心，你将需要结合牛顿法来迭代求解初始斜率。为了计算牛顿法所需的导数，你还将推导并求解一个伴随的“变分方程”。通过完成这个单步迭代的练习，你将掌握解决复杂非线性边值问题的关键数值技术。[@problem_id:1127768]", "problem": "考虑区间 $x \\in [0, 1]$ 上的如下非线性两点边值问题 (BVP)：\n$$\ny'' = \\frac{1}{2}y^2\n$$\n其边界条件为 $y(0) = 3$ 和 $y(1) = \\frac{4}{3}$。\n\n我们的目标是找到满足 $x=1$ 处边界条件的合适的初始斜率 $s = y'(0)$。这将通过打靶法来完成。该边值问题被转换为一个初值问题 (IVP)：\n$$\ny'' = \\frac{1}{2}y^2, \\quad y(0)=3, \\quad y'(0)=s\n$$\n此初值问题的解记为 $y(x;s)$，它取决于 $s$ 的选择。我们必须找到 $s$ 的值，使得条件 $y(1;s) = 4/3$ 成立。这可以表述为求函数 $F(s) = y(1;s) - 4/3 = 0$ 的根。\n\n为了求解 $s$，我们将使用牛顿法，其迭代公式如下：\n$$\ns_{k+1} = s_k - \\frac{F(s_k)}{F'(s_k)}\n$$\n导数 $F'(s_k)$ 由 $\\frac{\\partial y(1;s)}{\\partial s}\\Big|_{s=s_k}$ 给出。令 $z(x;s) = \\frac{\\partial y(x;s)}{\\partial s}$。通过对初值问题关于 $s$ 求导，我们发现 $z(x;s)$ 满足一阶变分方程：\n$$\nz'' = y(x;s)z, \\quad z(0)=0, \\quad z'(0)=1\n$$\n为实现一步牛顿法，我们必须同时求解 $y(x;s)$ 的初值问题和 $z(x;s)$ 的初值问题。\n\n**你的任务：**\n从斜率的初始猜测值 $s_0 = -2$ 开始，使用一次牛顿法迭代，求出下一个近似值 $s_1$。为获得所需的值 $y(1;s_0)$ 和 $z(1;s_0)$，你必须使用步长为 $h=1$ 的**显式欧拉法**，通过**单步**积分来求解从 $x=0$ 到 $x=1$ 的耦合初值问题组。", "solution": "我们将该二阶初值问题转换为关于 $y,v,z,w$ 的一阶系统，其中 $y'=v,\\;v'=\\frac{1}{2}y^2,\\;z'=w,\\;w'=yz$，且初始数据为\n$$y(0)=3,\\quad v(0)=s_0=-2,\\quad z(0)=0,\\quad w(0)=1.$$\n使用从 $x=0$ 到 $x=1$、步长为 $h=1$ 的单步显式欧拉法，我们计算可得\n$$y_1=y_0+hv_0=3+1\\cdot(-2)=1,$$\n$$v_1=v_0+h\\frac{1}{2}y_0^2=-2+1\\cdot\\frac{1}{2}\\cdot3^2=-2+\\frac{9}{2}=\\frac{5}{2},$$\n$$z_1=z_0+hw_0=0+1\\cdot1=1,$$\n$$w_1=w_0+h\\,y_0z_0=1+1\\cdot3\\cdot0=1.$$\n因此\n$$F(s_0)=y(1;s_0)-\\frac{4}{3}\\approx y_1-\\frac{4}{3}=1-\\frac{4}{3}=-\\frac{1}{3},\\qquad F'(s_0)=z(1;s_0)\\approx z_1=1.$$\n一次牛顿迭代给出\n$$s_1=s_0-\\frac{F(s_0)}{F'(s_0)}=-2-\\frac{-\\frac{1}{3}}{1}=-2+\\frac{1}{3}=-\\frac{5}{3}.$$", "answer": "$$\\boxed{-\\frac{5}{3}}$$", "id": "1127768"}]}