{"hands_on_practices": [{"introduction": "在流形上定义随机过程时，一个常见陷阱是天真地在局部坐标系中写下伊藤 SDE。本练习将揭示为何这种方法存在根本性缺陷，因为它不满足坐标变换下的不变性，从而无法定义一个几何上一致的过程。通过将这种朴素模型与基于流形度规的真实布朗运动进行比较，您将亲手验证 Stratonovich 积分如何通过与几何结构（正交标架场）的内在联系，自然地给出了与坐标选择无关的正确描述 [@problem_id:2970362]。这个实践对于理解两种积分在几何背景下的本质区别至关重要。", "problem": "令 $S^{2} \\subset \\mathbb{R}^{3}$ 为单位二维球面，其上赋有标准的圆形黎曼度量。在球坐标卡中，余纬为 $\\theta \\in (0,\\pi)$，经度为 $\\phi \\in (0,2\\pi)$，度量为 $g = d\\theta^{2} + \\sin^{2}(\\theta)\\, d\\phi^{2}$。考虑在此坐标卡下描述 $S^{2}$ 上扩散的以下两个随机模型：\n\n1. 一个朴素的 Itô 模型，它在此坐标卡中假设坐标上的噪声是独立、未缩放的，\n$$\nd\\theta_{t} = dW^{1}_{t}, \\qquad d\\phi_{t} = dW^{2}_{t},\n$$\n其中 $W^{1}$ 和 $W^{2}$ 是相互独立的一维标准布朗运动。\n\n2. 一个由黎曼度量的局部标准正交标架 $\\{e_{1}, e_{2}\\}$ 定义的 Stratonovich 模型，其中\n$$\ne_{1} = \\partial_{\\theta}, \\qquad e_{2} = \\frac{1}{\\sin(\\theta)}\\, \\partial_{\\phi},\n$$\n以及 Stratonovich 随机微分方程 (SDE)\n$$\ndX_{t} = e_{1}(X_{t}) \\circ dW^{1}_{t} + e_{2}(X_{t}) \\circ dW^{2}_{t}.\n$$\n\n使用以下基本原理：\n- 黎曼流形上的布朗运动是一种扩散过程，其生成元是拉普拉斯-贝尔特拉米算子的二分之一。\n- 在局部坐标下，一个 Itô SDE $dY_{t} = b(Y_{t})\\, dt + \\sigma(Y_{t})\\, dW_{t}$ 的生成元是 $L f = b \\cdot \\nabla f + \\tfrac{1}{2} \\sum_{i,j} a^{ij} \\partial_{i}\\partial_{j} f$，其中 $a = \\sigma \\sigma^{\\top}$。\n- Stratonovich 微积分在流形上的光滑坐标卡变换下是坐标无关的。\n\n任务：\n(a) 在此坐标卡下计算朴素 Itô 模型的生成元 $L_{\\text{naive}}$，并将其与 $S^{2}$ 上的拉普拉斯-贝尔特拉米算子的二分之一进行比较。解释为什么这个朴素 Itô 模型不满足坐标无关性。\n\n(b) 从 Stratonovich 模型 $dX_{t} = e_{1}(X_{t}) \\circ dW^{1}_{t} + e_{2}(X_{t}) \\circ dW^{2}_{t}$ 出发，将其转换为在 $(\\theta,\\phi)$ 坐标卡下的等价 Itô SDE，并确定必须出现的漂移向量分量 $b^{\\theta}(\\theta)$ 和 $b^{\\phi}(\\theta)$，以使得 Itô 生成元等于拉普拉斯-贝尔特拉米算子的二分之一。将你的最终答案表示为行矩阵 $\\begin{pmatrix}b^{\\theta}(\\theta) & b^{\\phi}(\\theta)\\end{pmatrix}$。\n\n你的最终答案必须是单一的封闭形式解析表达式。无需四舍五入。", "solution": "该问题陈述已经过验证，被认为是随机微分几何中一个适定且有科学依据的练习。\n\n该问题要求分析单位二维球面 $S^2$ 上的两个不同随机模型，以及它们与布朗运动的几何概念之间的关系。布朗运动的特征是其生成元等于拉普拉斯-贝尔特拉米算子的二分之一，即 $\\frac{1}{2}\\Delta_g$。\n\n(a) 朴素 Itô 模型的分析\n\n首先，我们分析在球坐标卡 $(\\theta, \\phi)$ 中由以下 SDE 给出的朴素 Itô 模型：\n$$\nd\\theta_{t} = dW^{1}_{t}, \\qquad d\\phi_{t} = dW^{2}_{t}\n$$\n这可以写成向量形式 $dY_t = b(Y_t) dt + \\sigma(Y_t) dW_t$，其中 $Y_t = (\\theta_t, \\phi_t)^{\\top}$。\n漂移向量为 $b = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n扩散矩阵为 $\\sigma = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$，即单位矩阵 $I$。\n因此，矩阵 $a = \\sigma\\sigma^{\\top}$ 也是单位矩阵，$a=I$，其分量为 $a^{11}=1$，$a^{22}=1$ 和 $a^{12}=a^{21}=0$。\n\n这个 Itô SDE 的生成元由公式 $L f = b \\cdot \\nabla f + \\frac{1}{2} \\sum_{i,j} a^{ij} \\partial_{i}\\partial_{j} f$ 给出。\n代入 $b$ 和 $a$ 的分量，我们得到朴素模型的生成元 $L_{\\text{naive}}$：\n$$\nL_{\\text{naive}}f = (0 \\cdot \\partial_{\\theta}f + 0 \\cdot \\partial_{\\phi}f) + \\frac{1}{2} (1 \\cdot \\partial_{\\theta}^2 f + 0 \\cdot \\partial_\\theta\\partial_\\phi f + 0 \\cdot \\partial_\\phi\\partial_\\theta f + 1 \\cdot \\partial_{\\phi}^2 f)\n$$\n$$\nL_{\\text{naive}}f = \\frac{1}{2}(\\partial_{\\theta}^2 f + \\partial_{\\phi}^2 f)\n$$\n该算子是标准欧几里得拉普拉斯算子在极坐标下的形式，它将 $\\theta$ 和 $\\phi$ 视为笛卡尔坐标。\n\n接下来，我们计算给定度量 $g = d\\theta^2 + \\sin^2(\\theta) d\\phi^2$ 的拉普拉斯-贝尔特拉米算子 $\\Delta_g$。度量张量及其逆矩阵为：\n$$\ng_{ij} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\sin^2(\\theta) \\end{pmatrix}, \\qquad g^{ij} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{\\sin^2(\\theta)} \\end{pmatrix}\n$$\n行列式是 $\\det(g) = \\sin^2(\\theta)$，所以在 $\\theta \\in (0, \\pi)$ 时 $\\sqrt{\\det(g)} = \\sin(\\theta)$。\n在局部坐标下拉普拉斯-贝尔特拉米算子的一般公式是 $\\Delta_g f = \\frac{1}{\\sqrt{\\det(g)}} \\sum_{i,j} \\partial_i (\\sqrt{\\det(g)} g^{ij} \\partial_j f)$。\n对于我们的二维情况 $(x^1, x^2) = (\\theta, \\phi)$，这变为：\n$$\n\\Delta_g f = \\frac{1}{\\sin(\\theta)} \\left[ \\partial_{\\theta}(\\sin(\\theta) g^{11} \\partial_{\\theta}f) + \\partial_{\\phi}(\\sin(\\theta) g^{22} \\partial_{\\phi}f) \\right]\n$$\n$$\n\\Delta_g f = \\frac{1}{\\sin(\\theta)} \\left[ \\partial_{\\theta}(\\sin(\\theta) \\cdot 1 \\cdot \\partial_{\\theta}f) + \\partial_{\\phi}\\left(\\sin(\\theta) \\cdot \\frac{1}{\\sin^2(\\theta)} \\cdot \\partial_{\\phi}f\\right) \\right]\n$$\n$$\n\\Delta_g f = \\frac{1}{\\sin(\\theta)} \\left[ \\partial_{\\theta}(\\sin(\\theta) \\partial_{\\theta}f) + \\partial_{\\phi}\\left(\\frac{1}{\\sin(\\theta)} \\partial_{\\phi}f\\right) \\right]\n$$\n应用乘法法则，并注意到 $\\sin(\\theta)$ 与 $\\phi$ 无关：\n$$\n\\Delta_g f = \\frac{1}{\\sin(\\theta)} \\left[ \\cos(\\theta)\\partial_{\\theta}f + \\sin(\\theta)\\partial_{\\theta}^2 f + \\frac{1}{\\sin(\\theta)}\\partial_{\\phi}^2 f \\right]\n$$\n$$\n\\Delta_g f = \\cot(\\theta)\\partial_{\\theta}f + \\partial_{\\theta}^2 f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f\n$$\n$S^2$ 上布朗运动的生成元是该算子的二分之一：\n$$\n\\frac{1}{2}\\Delta_g f = \\frac{1}{2}\\left( \\partial_{\\theta}^2 f + \\cot(\\theta)\\partial_{\\theta}f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f \\right)\n$$\n将 $L_{\\text{naive}}$ 与 $\\frac{1}{2}\\Delta_g$进行比较，很明显它们不相等。这个朴素 Itô 模型没有描述球面上的布朗运动。\n\n该模型不满足坐标无关性，因为 Itô 微积分不遵循经典的链式法则。在坐标变换下，Itô SDE 的变换方式涉及到变换映射的二阶导数（Itô 引理）。一个在某个坐标卡中具有零漂移和单位扩散的 SDE，在另一个坐标卡中通常不会保持这种简单形式。一个具有几何意义的扩散必须由以张量方式变换的对象来描述。朴素模型只是将流形坐标卡视为平坦的欧几里得空间，忽略了度量中编码的曲率，因此其本质上是依赖于坐标卡的。\n\n(b) Stratonovich 模型分析与 Itô 漂移的确定\n\n问题提供了一个 Stratonovich 模型，并要求确定一个 Itô 漂移 $b(\\theta, \\phi) = (b^{\\theta}, b^{\\phi})$，使得最终的 Itô SDE 的生成元为 $\\frac{1}{2}\\Delta_g$。Stratonovich 模型由标准正交标架 $\\{e_1, e_2\\}$ 给出：\n$$\ne_1 = \\partial_{\\theta} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\qquad e_2 = \\frac{1}{\\sin(\\theta)}\\partial_{\\phi} = \\begin{pmatrix} 0 \\\\ \\frac{1}{\\sin(\\theta)} \\end{pmatrix}\n$$\n所讨论的 Itô SDE 具有形式 $dX_t = b(X_t) dt + \\sigma(X_t) dW_t$。扩散矩阵 $\\sigma$ 由 Stratonovich 模型的向量场指定，其中 $\\sigma$ 的列是 $e_k$ 在坐标基底下的分量：\n$$\n\\sigma = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{\\sin(\\theta)} \\end{pmatrix}\n$$\n那么，Itô 生成元所需的矩阵 $a = \\sigma\\sigma^{\\top}$ 为：\n$$\na = \\sigma\\sigma^{\\top} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{\\sin(\\theta)} \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{\\sin(\\theta)} \\end{pmatrix}^{\\top} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{\\sin^2(\\theta)} \\end{pmatrix}\n$$\n我们观察到 $a^{ij} = g^{ij}$，这是扩散矩阵相对于度量 $g$ 表示各向同性扩散的条件。\n\n这个 Itô 过程的生成元是：\n$$\nL_{\\text{Itô}} f = b^{\\theta}(\\theta,\\phi)\\partial_{\\theta}f + b^{\\phi}(\\theta,\\phi)\\partial_{\\phi}f + \\frac{1}{2}(a^{\\theta\\theta}\\partial_{\\theta}^2 f + 2a^{\\theta\\phi}\\partial_{\\theta}\\partial_{\\phi}f + a^{\\phi\\phi}\\partial_{\\phi}^2 f)\n$$\n$$\nL_{\\text{Itô}} f = b^{\\theta}(\\theta)\\partial_{\\theta}f + b^{\\phi}(\\theta)\\partial_{\\phi}f + \\frac{1}{2}\\left( \\partial_{\\theta}^2 f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f \\right)\n$$\n（根据对称性，我们假设漂移分量仅依赖于 $\\theta$，这一点将由计算证实）。\n\n我们将此生成元 $L_{\\text{Itô}}$ 与布朗运动所需的生成元 $\\frac{1}{2}\\Delta_g$（已在 (a) 部分计算得出）相等：\n$$\nb^{\\theta}\\partial_{\\theta}f + b^{\\phi}\\partial_{\\phi}f + \\frac{1}{2}\\left( \\partial_{\\theta}^2 f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f \\right) = \\frac{1}{2}\\left( \\partial_{\\theta}^2 f + \\cot(\\theta)\\partial_{\\theta}f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f \\right)\n$$\n等式两边的二阶导数项相互抵消，留下一个关于一阶项的方程：\n$$\nb^{\\theta}\\partial_{\\theta}f + b^{\\phi}\\partial_{\\phi}f = \\frac{1}{2} \\cot(\\theta)\\partial_{\\theta}f\n$$\n这个等式必须对任何任意光滑函数 $f(\\theta, \\phi)$ 都成立。通过选择测试函数，我们可以确定漂移向量的分量。\n令 $f(\\theta, \\phi) = \\theta$。则 $\\partial_{\\theta}f = 1$ 且 $\\partial_{\\phi}f = 0$。方程变为：\n$$\nb^{\\theta} \\cdot 1 + b^{\\phi} \\cdot 0 = \\frac{1}{2} \\cot(\\theta) \\cdot 1 \\implies b^{\\theta}(\\theta) = \\frac{1}{2}\\cot(\\theta)\n$$\n令 $f(\\theta, \\phi) = \\phi$。则 $\\partial_{\\theta}f = 0$ 且 $\\partial_{\\phi}f = 1$。方程变为：\n$$\nb^{\\theta} \\cdot 0 + b^{\\phi} \\cdot 1 = \\frac{1}{2} \\cot(\\theta) \\cdot 0 \\implies b^{\\phi}(\\theta) = 0\n$$\n因此，所需的 Itô 漂移向量分量为 $b^{\\theta}(\\theta) = \\frac{1}{2}\\cot(\\theta)$ 和 $b^{\\phi}(\\theta) = 0$。该漂移项通常被称为 Itô 修正项或流形漂移，它源于流形的几何结构，并确保该过程是真正的布朗运动。\n最终答案以行矩阵形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}\\cot(\\theta) & 0\n\\end{pmatrix}\n}\n$$", "id": "2970362"}, {"introduction": "除了在局部坐标中工作，我们还可以通过将流形视为嵌入在高维欧氏空间中的子集来处理其上的 SDE。本练习介绍了一种强大且直观的方法：将环境空间中的布朗运动投影到流形的切空间上。您将计算由此产生的“伪漂移”项（或称伊藤修正项），这个漂移项是维持过程停留在弯曲表面上的关键 [@problem_id:2995674]。对于单位球面 $S^{n-1}$ 这个典型例子，这个计算清晰地展示了 Stratonovich 积分与伊藤积分之间的转换如何体现流形的几何约束。", "problem": "设 $M \\subset \\mathbb{R}^{n}$ 是一个光滑嵌入子流形，定义为一个光滑映射 $F : \\mathbb{R}^{n} \\to \\mathbb{R}^{m}$ 的零水平集，其中 $0 \\in \\mathbb{R}^{m}$ 是一个正则值，且对于所有 $x \\in M$ 都有 $\\operatorname{rank} D F(x) = m$。利用通过可微曲线对切向量的基本刻画，构造在点 $x \\in M$ 处的切空间 $T_{x} M$，并将其表示为微分 $D F(x)$ 的核。然后，对于单位球面 $S^{n-1} = \\{ x \\in \\mathbb{R}^{n} : \\| x \\| = 1 \\}$，将其视为 $F(x) = \\| x \\|^{2} - 1$ 的 $F^{-1}(0)$，显式地验证此构造。\n\n现在考虑黎曼流形 $S^{n-1}$ 上的一个 Stratonovich 意义下的随机微分方程 (SDE)，该方程是通过将标准 $\\mathbb{R}^{n}$ 值布朗运动正交投影到切丛上得到的。设 $W_{t}$ 是 $\\mathbb{R}^{n}$ 中的标准布朗运动，定义 Stratonovich SDE\n$$\nd X_{t} = P(X_{t}) \\circ d W_{t}, \\quad X_{t} \\in S^{n-1},\n$$\n其中 $P(x)$ 是 $\\mathbb{R}^{n}$ 中到 $T_{x} S^{n-1}$ 上的正交投影。仅使用 $T_{x} S^{n-1}$ 作为 $D F(x)$ 的核的刻画，以及对于依赖于状态的扩散系数的 Stratonovich-Itô 转换的基本性质，确定等价的 Itô 形式\n$$\nd X_{t} = b(X_{t}) \\, dt + P(X_{t}) \\, d W_{t}.\n$$\n中的显式 Itô 漂移向量场 $b(x)$。你的最终答案必须是 $b(x)$ 的一个单一闭式解析表达式，不带单位。不需要进行数值四舍五入。", "solution": "该问题分为两个主要部分。第一部分要求构造并验证定义为水平集的子流形的切空间。第二部分要求推导单位球面上特定 Stratonovich SDE 的 Itô 漂移。我们将依次解决这些问题。\n\n### 第一部分：切空间的刻画\n\n设 $M \\subset \\mathbb{R}^{n}$ 是一个光滑子流形，由 $M = F^{-1}(0)$ 定义，其中 $F: \\mathbb{R}^{n} \\to \\mathbb{R}^{m}$ 是一个光滑映射，且 $0$ 是一个正则值。在点 $x \\in M$ 处的切空间 $T_x M$ 是所有经过 $x$ 的 $M$ 中光滑曲线的速度向量的集合。\n\n设 $\\gamma: (-\\epsilon, \\epsilon) \\to M$ 是一条光滑曲线，使得 $\\gamma(0) = x$。一个向量 $v \\in \\mathbb{R}^{n}$ 属于 $T_x M$ 当且仅当存在这样一条曲线 $\\gamma$，使得 $\\gamma'(0) = v$。\n由于该曲线完全位于 $M$ 内，对于 $\\gamma$ 定义域中的所有 $t$，我们有 $F(\\gamma(t)) = 0$。我们可以使用链式法则对这个表达式关于 $t$ 求导：\n$$\n\\frac{d}{dt} F(\\gamma(t)) = D F(\\gamma(t)) \\cdot \\gamma'(t) = 0\n$$\n其中 $DF$ 是 $F$ 的微分（雅可比矩阵）。在 $t=0$ 处对此式求值，我们有 $\\gamma(0)=x$ 和 $\\gamma'(0)=v$。这得到：\n$$\nD F(x) \\cdot v = 0\n$$\n这个方程表明，任何切向量 $v \\in T_x M$ 都必须属于线性映射 $D F(x): \\mathbb{R}^{n} \\to \\mathbb{R}^{m}$ 的核。因此，我们有包含关系 $T_x M \\subseteq \\ker(D F(x))$。\n\n为了证明相等，我们比较这两个向量空间的维数。由于 $0$ 是 $F$ 的正则值，水平集 $M = F^{-1}(0)$ 是 $\\mathbb{R}^{n}$ 的一个光滑子流形，其维数为 $\\dim(M) = n-m$。切空间 $T_x M$ 是一个具有相同维数的向量空间，所以 $\\dim(T_x M) = n-m$。\n微分 $D F(x)$ 是一个从 $\\mathbb{R}^{n}$ 到 $\\mathbb{R}^{m}$ 的线性映射。$0$ 是正则值的条件意味着对于所有 $x \\in M$，$D F(x)$ 的秩是最大的，即 $\\operatorname{rank}(D F(x)) = m$。根据秩-零度定理，$D F(x)$ 的核的维数是：\n$$\n\\dim(\\ker(D F(x))) = \\dim(\\mathbb{R}^{n}) - \\operatorname{rank}(D F(x)) = n - m\n$$\n我们已经确定 $T_x M$ 是 $\\ker(D F(x))$ 的一个子空间，并且两个空间具有相同的维数 $n-m$。这意味着这两个空间必然是相同的：\n$$\nT_x M = \\ker(D F(x))\n$$\n\n### 第二部分：对单位球面 $S^{n-1}$ 的验证\n\n我们现在对单位球面 $S^{n-1} = \\{ x \\in \\mathbb{R}^{n} : \\| x \\| = 1 \\}$ 验证此构造。我们可以将球面定义为函数 $F: \\mathbb{R}^{n} \\to \\mathbb{R}$（由 $F(x) = \\|x\\|^2 - 1$ 给出）的零水平集。这里 $m=1$。\n$x$ 的分量是 $(x_1, \\dots, x_n)$，且 $F(x) = \\sum_{i=1}^n x_i^2 - 1$。\n微分 $D F(x)$ 由 $F$ 的梯度表示为一个 $1 \\times n$ 矩阵（一个行向量）。偏导数为 $\\frac{\\partial F}{\\partial x_i} = 2x_i$。因此，梯度为 $\\nabla F(x) = 2x$。微分作用于向量 $v$ 的形式为 $D F(x)(v) = \\nabla F(x) \\cdot v = 2x \\cdot v$。\n对于任何点 $x \\in S^{n-1}$，我们有 $\\|x\\|=1$，这意味着 $x \\neq 0$。因此，$\\nabla F(x) = 2x$ 是一个非零向量，并且 $1 \\times n$ 矩阵 $D F(x)$ 的秩为 $1$。所以，$\\operatorname{rank}(D F(x)) = 1 = m$，这证实了 $0$ 是一个正则值。\n\n使用第一部分的结果，在 $x \\in S^{n-1}$ 处的切空间是：\n$$\nT_x S^{n-1} = \\ker(D F(x)) = \\{ v \\in \\mathbb{R}^{n} : D F(x)(v) = 0 \\}\n$$\n这个条件是 $2x \\cdot v = 0$，可以化简为 $x \\cdot v = 0$。\n所以，我们已经显式地构造了切空间为：\n$$\nT_x S^{n-1} = \\{ v \\in \\mathbb{R}^{n} : x \\cdot v = 0 \\}\n$$\n这是 $\\mathbb{R}^{n}$ 中所有与位置向量 $x$ 正交的向量的集合，这是球面上点 $x$ 处切空间的标准几何描述。\n\n### 第三部分：Itô 漂移计算\n\n我们被告知 $S^{n-1}$ 上的 Stratonovich SDE 为：\n$$\nd X_{t} = P(X_{t}) \\circ d W_{t}\n$$\n其中 $P(x)$ 是到切空间 $T_x S^{n-1}$ 的正交投影。相应的 Itô SDE 是\n$$\nd X_{t} = b(X_{t}) \\, dt + P(X_{t}) \\, d W_{t}\n$$\n扩散系数是矩阵值函数 $\\sigma(x) = P(x)$。空间 $T_x S^{n-1}$ 是由法向量张成的空间的正交补。对于 $x \\in S^{n-1}$，单位法向量是 $x$ 本身。到法空间的投影由矩阵 $xx^T$ 给出。因此，到切空间的投影是 $P(x) = I - xx^T$，其中 $I$ 是 $n \\times n$ 单位矩阵。\n所以，$\\sigma(x) = I - xx^T$。这个矩阵的分量是 $\\sigma_{ij}(x) = \\delta_{ij} - x_i x_j$。\n\nItô 漂移向量场 $b(x)$ 的分量 $b^i(x)$ 由 Stratonovich-Itô 转换公式给出：\n$$\nb^i(x) = \\frac{1}{2} \\sum_{j=1}^{n} \\sum_{k=1}^{n} \\frac{\\partial \\sigma_{ij}}{\\partial x_k}(x) \\sigma_{kj}(x)\n$$\n首先，我们计算 $\\sigma_{ij}$ 的偏导数：\n$$\n\\frac{\\partial \\sigma_{ij}}{\\partial x_k} = \\frac{\\partial}{\\partial x_k}(\\delta_{ij} - x_i x_j) = - \\left( \\frac{\\partial x_i}{\\partial x_k} x_j + x_i \\frac{\\partial x_j}{\\partial x_k} \\right) = - (\\delta_{ik} x_j + x_i \\delta_{jk})\n$$\n接下来，我们将此式和 $\\sigma_{kj}(x) = \\delta_{kj} - x_k x_j$ 代入 $b^i(x)$ 的公式中：\n$$\nb^i(x) = \\frac{1}{2} \\sum_{j,k=1}^{n} \\left( - (\\delta_{ik} x_j + x_i \\delta_{jk}) \\right) (\\delta_{kj} - x_k x_j)\n$$\n我们展开求和号内的乘积：\n$$\n- (\\delta_{ik} x_j \\delta_{kj} - \\delta_{ik} x_j x_k x_j + x_i \\delta_{jk} \\delta_{kj} - x_i \\delta_{jk} x_k x_j)\n$$\n现在，我们对这四项分别进行关于 $j$ 和 $k$ 的求和。\n1. 第一项：$\\sum_{j,k} (-\\delta_{ik} x_j \\delta_{kj}) = -\\sum_j (\\sum_k \\delta_{ik} \\delta_{kj}) x_j = -\\sum_j \\delta_{ij} x_j = -x_i$。\n2. 第二项：$\\sum_{j,k} (\\delta_{ik} x_j x_k x_j) = \\sum_{j} (\\sum_k \\delta_{ik} x_k) x_j^2 = \\sum_{j} x_i x_j^2 = x_i \\sum_{j} x_j^2 = x_i \\|x\\|^2$。\n3. 第三项：$\\sum_{j,k} (-x_i \\delta_{jk} \\delta_{kj}) = -x_i \\sum_j (\\sum_k \\delta_{jk} \\delta_{kj}) = -x_i \\sum_j \\delta_{jj} = -x_i \\sum_j 1 = -n x_i$。\n4. 第四项：$\\sum_{j,k} (x_i \\delta_{jk} x_k x_j) = x_i \\sum_j (\\sum_k \\delta_{jk} x_k) x_j = x_i \\sum_j x_j x_j = x_i \\sum_j x_j^2 = x_i \\|x\\|^2$。\n\n过程 $X_t$ 在 $S^{n-1}$ 上演化，因此我们在 $\\|x\\|^2=1$ 的条件下对 $x$ 求值。将这四项相加得到：\n$$\n2 b^i(x) = -x_i + x_i - n x_i + x_i = (1 - n) x_i\n$$\n因此，漂移向量的第 $i$ 个分量是 $b^i(x) = \\frac{1-n}{2} x_i$。用向量形式表示，漂移场是：\n$$\nb(x) = \\frac{1-n}{2} x = -\\frac{n-1}{2} x\n$$\n这个漂移是一个径向指向内部的向量场，这是必要的，用以抵消投影布朗运动“脱离”球面的趋势，从而确保过程保持在流形上。这通常被称为 Itô 修正项或伪漂移。\n\n我们可以通过对函数 $f(x) = \\|x\\|^2$ 应用 Itô 引理来验证这个结果。为了使过程 $X_t$ 保持在球面上，我们必须有 $d(\\|X_t\\|^2)=0$。\n$d(\\|X_t\\|^2) = 2X_t \\cdot dX_t + [dX, dX]_t$。更准确地说，$d f(X_t) = \\nabla f(X_t) \\cdot dX_t + \\frac{1}{2} \\operatorname{Tr}(\\nabla^2 f(X_t) (d X_t)(d X_t)^T)$。\n二次协变张量是 $(dX_t)(dX_t)^T = \\sigma(X_t) \\sigma(X_t)^T dt = P(X_t) P(X_t)^T dt$。由于 $P(x)$ 是一个对称投影矩阵，所以 $P(x)^T=P(x)$ 且 $P(x)^2=P(x)$。因此，二次协变是 $P(X_t) dt = (I-X_t X_t^T)dt$。\n$d(\\|X_t\\|^2) = 2X_t \\cdot (b(X_t)dt + P(X_t)dW_t) + \\frac{1}{2} \\operatorname{Tr}(2I \\cdot P(X_t)) dt$。\n由于 $X_t$ 与 $T_{X_t}S^{n-1}$ 中的任何向量都正交，所以 $X_t \\cdot P(X_t)dW_t = 0$。\n$d(\\|X_t\\|^2) = (2X_t \\cdot b(X_t) + \\operatorname{Tr}(P(X_t))) dt$。\n$\\operatorname{Tr}(P(x)) = \\operatorname{Tr}(I - xx^T) = \\operatorname{Tr}(I) - \\operatorname{Tr}(xx^T) = n - \\|x\\|^2$。对于 $x \\in S^{n-1}$，这是 $n-1$。\n所以，$d(\\|X_t\\|^2) = (2X_t \\cdot b(X_t) + n-1) dt$。将其设为 0 要求 $2X_t \\cdot b(X_t) = -(n-1)$。\n我们计算出的漂移是 $b(x) = -\\frac{n-1}{2} x$。我们来验证一下：\n$2x \\cdot (-\\frac{n-1}{2} x) = -(n-1) (x \\cdot x) = -(n-1)\\|x\\|^2 = -(n-1)$。\n条件得到满足，这证实了我们的结果。", "answer": "$$\\boxed{-\\frac{n-1}{2} x}$$", "id": "2995674"}, {"introduction": "将理论应用于实践，数值模拟是研究流形上 SDE 的重要工具。本练习将理论与实践联系起来，通过分析一种常见的投影欧拉格式，带您探索这些方程的数值解法。您将对圆周上的一个简单 SDE 推导其局部误差的主导项，并发现一个基本的几何量——曲率 $\\kappa$——如何直接影响数值模拟的精度 [@problem_id:2995630]。这项实践凸显了流形的几何性质在设计和理解数值算法性能中的核心作用。", "problem": "考虑一个嵌入黎曼流形 $M \\subset \\mathbb{R}^{n}$ 及其上一个 Stratonovich 随机微分方程 (SDE)。解决此类问题的一种常用数值方法是基于投影的欧拉格式：在环境空间 $\\mathbb{R}^{n}$ 中进行一步欧拉迭代，然后通过最近点投影将其投影回流形 $M$。为了使分析明确且与曲率相关，我们特化到半径为 $R>0$ 的圆，\n$$\nM = S^{1}_{R} := \\{ x \\in \\mathbb{R}^{2} : \\|x\\| = R \\},\n$$\n其黎曼度量由环境欧几里得度量诱导。令 $J \\in \\mathbb{R}^{2 \\times 2}$ 表示旋转 $\\pi/2$ 的矩阵 $J = \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}$，并定义单位切场 $T : S^{1}_{R} \\to TS^{1}_{R}$ 为 $T(x) := \\frac{1}{R} J x$。考虑由标准布朗运动 $W_{t}$ 驱动的 $S^{1}_{R}$ 上的一维 Stratonovich SDE，\n$$\n\\mathrm{d}X_{t} = T(X_{t}) \\circ \\mathrm{d}W_{t}, \\quad X_{0} \\in S^{1}_{R}.\n$$\n定义从点 $x \\in S^{1}_{R}$ 出发，在单个时间步长 $h>0$ 内的基于投影的欧拉更新为\n$$\nY_{\\mathrm{e}} := x + T(x)\\,\\Delta W, \\quad \\Delta W := W_{t+h} - W_{t}, \\quad \\widetilde{X}_{t+h} := \\Pi_{R}(Y_{\\mathrm{e}}) := R \\frac{Y_{\\mathrm{e}}}{\\|Y_{\\mathrm{e}}\\|}.\n$$\n令 $d_{g}$ 表示 $S^{1}_{R}$ 上的测地距离。从嵌入流形上的 Stratonovich 微积分和 $S^{1}_{R}$ 的几何学的基本原理出发，推导条件均方局部误差在小步长渐近性下的首项系数 $C$，\n$$\n\\mathbb{E}\\!\\left[\\, d_{g}\\!\\left(X_{t+h}, \\widetilde{X}_{t+h}\\right)^{2} \\,\\big|\\, X_{t}=x \\right] \\;=\\; C\\, h^{3} \\;+\\; o(h^{3}) \\quad \\text{as } h \\to 0,\n$$\n该系数需纯粹用圆的曲率 $\\kappa := \\frac{1}{R}$ 表示。您的最终答案必须是 $C$ 关于 $\\kappa$ 的闭式解析表达式。无需数值近似或四舍五入，且不应提供单位。", "solution": "用户希望找到应用于圆 $S^1_R$ 上的 Stratonovich SDE 的基于投影的欧拉格式的条件均方局部误差在小步长渐近性下的首项系数 $C$。\n\n首先验证问题以确保其是适定的且有科学依据的。\n\n### 步骤 1：提取已知条件\n-   **流形**：$M = S^{1}_{R} := \\{ x \\in \\mathbb{R}^{2} : \\|x\\| = R \\}$，一个半径为 $R>0$ 的圆。\n-   **切场**：$T(x) := \\frac{1}{R} J x$，其中 $J = \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}$。对于 $x \\in S^{1}_{R}$，$\\|T(x)\\| = \\frac{1}{R}\\|Jx\\| = \\frac{1}{R}\\|x\\| = 1$。\n-   **Stratonovich SDE**：$\\mathrm{d}X_{t} = T(X_{t}) \\circ \\mathrm{d}W_{t}$，其中 $X_{0} \\in S^{1}_{R}$ 且 $W_{t}$ 为一维标准布朗运动。\n-   **基于投影的欧拉格式**：从 $X_t=x$ 开始，下一步为 $\\widetilde{X}_{t+h} = \\Pi_{R}(Y_{\\mathrm{e}})$，其中 $Y_{\\mathrm{e}} = x + T(x)\\,\\Delta W$ 且 $\\Delta W = W_{t+h} - W_{t}$。投影为 $\\Pi_{R}(y) = R \\frac{y}{\\|y\\|}$。\n-   **误差量**：我们需要在以下表达式中找到系数 $C$：\n    $$\n    \\mathbb{E}\\!\\left[\\, d_{g}\\!\\left(X_{t+h}, \\widetilde{X}_{t+h}\\right)^{2} \\,\\big|\\, X_{t}=x \\right] \\;=\\; C\\, h^{3} \\;+\\; o(h^{3}) \\quad \\text{as } h \\to 0.\n    $$\n-   **曲率**：$\\kappa := \\frac{1}{R}$。$C$ 的答案必须用 $\\kappa$ 表示。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在流形上的随机数值分析领域内是适定的。所有术语都是标准的且有正式定义。SDE、数值方法和误差度量都得到了明确的规定。该问题具有科学依据，是客观的，并且不违反任何数学或科学原理。它构成了一个数值格式局部误差的非平凡计算。\n\n### 步骤 3：结论与行动\n该问题是有效的。将提供完整解答。\n\n### 解答的推导\n\n问题的核心是将真实解 $X_{t+h}$ 的泰勒展开与数值近似解 $\\widetilde{X}_{t+h}$ 的泰勒展开进行比较。起始点为 $X_t=x$。\n\n**1. 精确解 $X_{t+h}$**\n我们用角度 $\\theta_0$ 来表示圆上的点 $x$：$x = (R\\cos\\theta_0, R\\sin\\theta_0)$。\n切向量为 $T(x) = \\frac{1}{R}J x = \\frac{1}{R}(-R\\sin\\theta_0, R\\cos\\theta_0) = (-\\sin\\theta_0, \\cos\\theta_0)$。\n圆上的点 $X_t$ 可由其角度 $\\Theta_t$ 参数化，即 $X_t = R(\\cos\\Theta_t, \\sin\\Theta_t)$。\n其微分为 $\\mathrm{d}X_t = R(-\\sin\\Theta_t, \\cos\\Theta_t) \\mathrm{d}\\Theta_t = R\\,T(X_t)\\,\\mathrm{d}\\Theta_t$。\nSDE 为 $\\mathrm{d}X_t = T(X_t) \\circ \\mathrm{d}W_t$。\n比较 $\\mathrm{d}X_t$ 的两个表达式，得到关于角度 $\\Theta_t$ 的标量 SDE：\n$R\\,\\mathrm{d}\\Theta_t = \\circ \\mathrm{d}W_t \\implies \\mathrm{d}\\Theta_t = \\frac{1}{R} \\circ \\mathrm{d}W_t$。\n由于系数 $\\frac{1}{R}$ 是常数，Stratonovich 形式和 Itô 形式是相同的。从 $t$ 到 $t+h$ 积分得到：\n$\\Theta_{t+h} - \\Theta_t = \\frac{1}{R} \\int_t^{t+h} \\mathrm{d}W_s = \\frac{\\Delta W}{R}$。\n设 $\\Theta_t = \\theta_0$，则在时间 $t+h$ 的精确解由角度 $\\Theta_{t+h} = \\theta_0 + \\frac{\\Delta W}{R}$ 给出。\n在 $\\mathbb{R}^2$ 中对应的点是：\n$X_{t+h} = R(\\cos(\\theta_0 + \\frac{\\Delta W}{R}), \\sin(\\theta_0 + \\frac{\\Delta W}{R}))$。\n使用三角恒等式，我们可以用 $x$ 和 $T(x)$ 来表示它：\n$X_{t+h} = R(\\cos\\theta_0 \\cos(\\frac{\\Delta W}{R}) - \\sin\\theta_0 \\sin(\\frac{\\Delta W}{R}), \\sin\\theta_0 \\cos(\\frac{\\Delta W}{R}) + \\cos\\theta_0 \\sin(\\frac{\\Delta W}{R}))$\n$X_{t+h} = (R\\cos\\theta_0, R\\sin\\theta_0)\\cos(\\frac{\\Delta W}{R}) + R(-\\sin\\theta_0, \\cos\\theta_0)\\sin(\\frac{\\Delta W}{R})$\n$X_{t+h} = x \\cos(\\frac{\\Delta W}{R}) + R\\,T(x) \\sin(\\frac{\\Delta W}{R})$。\n\n我们对小的 $\\Delta W$ 进行展开。令 $u = \\frac{\\Delta W}{R}$：\n$X_{t+h} = x \\left(1 - \\frac{u^2}{2} + \\frac{u^4}{24} - \\frac{u^6}{720} + \\dots\\right) + R\\,T(x)\\left(u - \\frac{u^3}{6} + \\frac{u^5}{120} - \\frac{u^7}{5040} + \\dots\\right)$\n$X_{t+h} = x\\left(1 - \\frac{(\\Delta W)^2}{2R^2} + \\frac{(\\Delta W)^4}{24R^4} - \\frac{(\\Delta W)^6}{720R^6} + \\dots\\right) + T(x)\\left(\\Delta W - \\frac{(\\Delta W)^3}{6R^2} + \\frac{(\\Delta W)^5}{120R^4} - \\frac{(\\Delta W)^7}{5040R^6} + \\dots\\right)$。\n\n**2. 数值解 $\\widetilde{X}_{t+h}$**\n该数值方法包括在环境空间中进行一步欧拉迭代，然后进行投影。\n$Y_{\\mathrm{e}} = x + T(x)\\Delta W$。\n我们计算 $Y_{\\mathrm{e}}$ 的范数。由于 $x \\cdot T(x) = \\frac{1}{R}(x \\cdot Jx) = 0$，所以 $x$ 和 $T(x)$ 是正交的。\n$\\|Y_{\\mathrm{e}}\\|^2 = \\|x\\|^2 + 2(x \\cdot T(x))\\Delta W + \\|T(x)\\|^2 (\\Delta W)^2 = R^2 + 0 + 1 \\cdot (\\Delta W)^2 = R^2 + (\\Delta W)^2$。\n$\\|Y_{\\mathrm{e}}\\| = \\sqrt{R^2 + (\\Delta W)^2} = R\\sqrt{1 + \\left(\\frac{\\Delta W}{R}\\right)^2}$。\n数值解为 $\\widetilde{X}_{t+h} = R \\frac{Y_{\\mathrm{e}}}{\\|Y_{\\mathrm{e}}\\|} = \\frac{x+T(x)\\Delta W}{\\sqrt{1 + (\\frac{\\Delta W}{R})^2}}$。\n使用泰勒展开 $(1+v)^{-1/2} = 1 - \\frac{1}{2}v + \\frac{3}{8}v^2 - \\frac{5}{16}v^3 + \\dots$ 其中 $v = (\\frac{\\Delta W}{R})^2$：\n$\\widetilde{X}_{t+h} = (x + T(x)\\Delta W) \\left(1 - \\frac{1}{2}\\frac{(\\Delta W)^2}{R^2} + \\frac{3}{8}\\frac{(\\Delta W)^4}{R^4} - \\frac{5}{16}\\frac{(\\Delta W)^6}{R^6} + \\dots\\right)$。\n展开此乘积：\n$\\widetilde{X}_{t+h} = x\\left(1 - \\frac{(\\Delta W)^2}{2R^2} + \\frac{3(\\Delta W)^4}{8R^4} - \\frac{5(\\Delta W)^6}{16R^6} + \\dots\\right) + T(x)\\left(\\Delta W - \\frac{(\\Delta W)^3}{2R^2} + \\frac{3(\\Delta W)^5}{8R^4} - \\frac{5(\\Delta W)^7}{16R^6} + \\dots\\right)$。\n\n**3. 局部误差计算**\n局部误差向量是 $E = X_{t+h} - \\widetilde{X}_{t+h}$。我们从 $X_{t+h}$ 的展开式中减去 $\\widetilde{X}_{t+h}$ 的展开式。\n含有 $(\\Delta W)^0$、$\\Delta W$ 和 $(\\Delta W)^2$ 的项相消。\n首个非零项是：\n$E = T(x) \\left(-\\frac{1}{6R^2} + \\frac{1}{2R^2}\\right)(\\Delta W)^3 + x \\left(\\frac{1}{24R^4} - \\frac{3}{8R^4}\\right)(\\Delta W)^4 + O_p(h^{5/2})$.\n$E = T(x) \\left(\\frac{1}{3R^2}\\right)(\\Delta W)^3 + x \\left(-\\frac{8}{24R^4}\\right)(\\Delta W)^4 + \\dots$\n$E = \\frac{1}{3R^2}T(x)(\\Delta W)^3 - \\frac{1}{3R^4}x(\\Delta W)^4 + O_p(h^{5/2})$.\n误差向量中的首项阶数为 $(\\Delta W)^3 \\sim h^{3/2}$。\n\n我们需要均方测地距离。对于圆上的小距离，测地距离的平方 $d_g^2$ 可以很好地由欧几里得（弦）距离的平方 $\\|X_{t+h} - \\widetilde{X}_{t+h}\\|^2$ 来近似。其差值为更高阶。具体来说，$d_g(A,B)^2 = \\|A-B\\|^2 + O(\\|A-B\\|^4)$。由于 $\\|E\\|^2$ 的阶数为 $h^3$，修正项 $\\mathbb{E}[\\|E\\|^4]$ 的阶数将为 $h^6$。因此，我们只需要计算 $\\mathbb{E}[\\|E\\|^2]$ 的首项。\n$\\|E\\|^2 = \\left\\| \\frac{1}{3R^2}T(x)(\\Delta W)^3 - \\frac{1}{3R^4}x(\\Delta W)^4 + \\dots \\right\\|^2$。\n利用 $x$ 和 $T(x)$ 的正交性以及 $\\|T(x)\\|=1, \\|x\\|=R$：\n$\\|E\\|^2 = \\left\\|\\frac{1}{3R^2}T(x)(\\Delta W)^3\\right\\|^2 + \\left\\|-\\frac{1}{3R^4}x(\\Delta W)^4\\right\\|^2 + O_p(h^{7/2})$.\n$\\|E\\|^2 = \\frac{1}{9R^4}\\|T(x)\\|^2 ((\\Delta W)^3)^2 + \\frac{1}{9R^8}\\|x\\|^2 ((\\Delta W)^4)^2 + \\dots$\n$\\|E\\|^2 = \\frac{1}{9R^4}(\\Delta W)^6 + \\frac{R^2}{9R^8}(\\Delta W)^8 + \\dots = \\frac{1}{9R^4}(\\Delta W)^6 + O_p(h^4)$.\n首项为 $\\frac{1}{9R^4}(\\Delta W)^6$。\n\n**4. 期望与最终结果**\n现在我们取以 $X_t=x$ 为条件的期望。我们使用随机变量 $\\Delta W \\sim N(0,h)$ 的矩。\n$\\mathbb{E}[(\\Delta W)^{2k}] = h^k (2k-1)!!$。\n对于 $k=3$：$\\mathbb{E}[(\\Delta W)^6] = h^3 \\cdot (5 \\cdot 3 \\cdot 1) = 15h^3$。\n那么条件均方误差为：\n$\\mathbb{E}[ d_g(X_{t+h}, \\widetilde{X}_{t+h})^2 | X_t=x ] = \\mathbb{E}[\\|E\\|^2] + o(h^3)$\n$\\mathbb{E}[\\|E\\|^2] = \\mathbb{E}\\left[ \\frac{1}{9R^4}(\\Delta W)^6 + O_p(h^4) \\right] = \\frac{1}{9R^4}\\mathbb{E}[(\\Delta W)^6] + O(h^4)$。\n$\\mathbb{E}[\\|E\\|^2] = \\frac{1}{9R^4}(15h^3) + O(h^4) = \\frac{5}{3R^4}h^3 + O(h^4)$。\n\n将此与所要求的渐近形式 $\\mathbb{E}[\\dots] = C h^3 + o(h^3)$ 进行比较，我们确定系数 $C$：\n$C = \\frac{5}{3R^4}$。\n最后，我们用曲率 $\\kappa = \\frac{1}{R}$ 来表示它：\n$C = \\frac{5}{3}\\left(\\frac{1}{R}\\right)^4 = \\frac{5}{3}\\kappa^4$。", "answer": "$$\\boxed{\\frac{5}{3}\\kappa^{4}}$$", "id": "2995630"}]}