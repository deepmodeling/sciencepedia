{"hands_on_practices": [{"introduction": "“混沌传播”理论的基石在于，当粒子数 $N$ 趋于无穷时，经验测度的随机涨落会消失。本练习旨在通过一个基础但至关重要的计算来具体阐明这一核心思想。通过对经验测度应用 Itô 公式并计算关键的二次变分，你将亲手验证为何系统的宏观行为在极限情况下是确定性的，揭示了从微观随机性到宏观确定性涌现的数学机制 [@problem_id:2991706]。", "problem": "考虑 $\\mathbb{R}^{d}$ 中如下由独立的 $m$ 维布朗运动驱动的相互作用粒子系统，对于 $i \\in \\{1,\\dots, N\\}$，由随机微分方程 (SDE) 指定：\n$$\n\\mathrm{d}X_{t}^{i,N} \\;=\\; b\\!\\left(X_{t}^{i,N}, \\mu_{t}^{N}\\right)\\,\\mathrm{d}t \\;+\\; \\sigma\\!\\left(X_{t}^{i,N}, \\mu_{t}^{N}\\right)\\,\\mathrm{d}W_{t}^{i},\n$$\n其中 $\\mu_{t}^{N} := \\frac{1}{N} \\sum_{j=1}^{N} \\delta_{X_{t}^{j,N}}$ 是经验测度，$(W^{i})_{i=1}^{N}$ 是 $\\mathbb{R}^{m}$ 中独立的标准布朗运动，漂移项 $b:\\mathbb{R}^{d}\\times\\mathcal{P}_{2}(\\mathbb{R}^{d})\\to\\mathbb{R}^{d}$ 和扩散项 $\\sigma:\\mathbb{R}^{d}\\times\\mathcal{P}_{2}(\\mathbb{R}^{d})\\to\\mathbb{R}^{d\\times m}$ 是全局利普希茨且呈线性增长，初始数据 $\\{X_{0}^{i,N}\\}_{i=1}^{N}$ 是独立同分布的，其共同分布 $\\mu_{0}$ 具有有限二阶矩。此外，假设存在一个常数 $\\Sigma \\in (0,\\infty)$，使得 $\\sup_{x,\\mu} \\|\\sigma(x,\\mu)\\|_{\\mathrm{op}} \\le \\Sigma$，其中 $\\|\\cdot\\|_{\\mathrm{op}}$ 表示 $\\mathbb{R}^{d\\times m}$ 上的算子范数。令 $\\varphi \\in C_{b}^{2}(\\mathbb{R}^{d})$ 是一个具有有界导数的二次连续可微检验函数，并令 $\\|\\nabla \\varphi\\|_{\\infty} := \\sup_{x \\in \\mathbb{R}^{d}} \\|\\nabla \\varphi(x)\\|$。\n\n定义经验可观测量 $\\mu_{t}^{N}(\\varphi) := \\frac{1}{N}\\sum_{i=1}^{N} \\varphi(X_{t}^{i,N})$。使用伊藤公式和 Doob–Meyer 分解，将 $\\mu_{t}^{N}(\\varphi)$ 写成一个有限变差项和一个鞅 $M_{t}^{N}(\\varphi)$ 的和。从随机分析的定义和第一性原理出发，显式地计算此鞅的可预测二次变差 $\\langle M^{N}(\\varphi)\\rangle_{t}$，并用 $\\sigma$、$\\nabla \\varphi$ 和经验测度表示。然后，在上述有界性假设下，证明对于每个固定的 $t \\in [0,T]$，当 $N \\to \\infty$ 时 $\\langle M^{N}(\\varphi)\\rangle_{t}$ 消失，从而确定 $\\mu_{t}^{N}(\\varphi)$ 的极限动力学是确定性的。\n\n你的最终答案必须是极限\n$$\n\\lim_{N \\to \\infty} \\langle M^{N}(\\varphi) \\rangle_{t},\n$$\n的精确值，以闭合形式表示。无需单位。请勿对答案进行四舍五入。", "solution": "问题要求计算与一个相互作用粒子系统相关的特定鞅的可预测二次变差，并评估当粒子数 $N$ 趋于无穷大时其极限。\n\n我们首先对一个固定粒子 $i \\in \\{1,\\dots,N\\}$ 的过程 $\\varphi(X_{t}^{i,N})$ 应用伊藤公式。过程 $X_{t}^{i,N}$ 是一个由随机微分方程 (SDE) 控制的 $d$ 维伊藤过程：\n$$ \\mathrm{d}X_{t}^{i,N} = b(X_{t}^{i,N}, \\mu_{t}^{N}) \\mathrm{d}t + \\sigma(X_{t}^{i,N}, \\mu_{t}^{N}) \\mathrm{d}W_{t}^{i} $$\n由于检验函数 $\\varphi \\in C_{b}^{2}(\\mathbb{R}^{d})$ 不显式依赖于时间 $t$，伊藤公式表述为：\n$$ \\mathrm{d}\\varphi(X_{t}^{i,N}) = \\nabla \\varphi(X_{t}^{i,N})^{T} \\mathrm{d}X_{t}^{i,N} + \\frac{1}{2} \\mathrm{Tr}\\left( H_{\\varphi}(X_{t}^{i,N}) (\\mathrm{d}X_{t}^{i,N})(\\mathrm{d}X_{t}^{i,N})^{T} \\right) $$\n其中 $\\nabla \\varphi$ 是 $\\varphi$ 的梯度，而 $H_{\\varphi}$ 是其海森矩阵。$X_{t}^{i,N}$ 的二次变差项是使用伊藤等距法则计算的。由于 $(W^{i})_{t}$ 是一个标准的 $m$ 维布朗运动，我们有 $(\\mathrm{d}W_{t}^{i})(\\mathrm{d}W_{t}^{i})^{T} = I_{m} \\mathrm{d}t$，其中 $I_{m}$ 是 $m \\times m$ 单位矩阵。\n$$ (\\mathrm{d}X_{t}^{i,N})(\\mathrm{d}X_{t}^{i,N})^{T} = \\left(\\sigma(X_{t}^{i,N}, \\mu_{t}^{N}) \\mathrm{d}W_{t}^{i}\\right) \\left(\\sigma(X_{t}^{i,N}, \\mu_{t}^{N}) \\mathrm{d}W_{t}^{i}\\right)^{T} = \\sigma(X_{t}^{i,N}, \\mu_{t}^{N}) \\sigma(X_{t}^{i,N}, \\mu_{t}^{N})^{T} \\mathrm{d}t $$\n将 $X_{t}^{i,N}$ 的 SDE 及其二次变差代入伊藤公式，我们得到：\n$$ \\mathrm{d}\\varphi(X_{t}^{i,N}) = \\left( \\nabla \\varphi(X_{t}^{i,N})^{T} b(X_{t}^{i,N}, \\mu_{t}^{N}) + \\frac{1}{2}\\mathrm{Tr}\\left( \\sigma(X_{t}^{i,N}, \\mu_{t}^{N}) \\sigma(X_{t}^{i,N}, \\mu_{t}^{N})^{T} H_{\\varphi}(X_{t}^{i,N}) \\right) \\right) \\mathrm{d}t + \\nabla \\varphi(X_{t}^{i,N})^{T} \\sigma(X_{t}^{i,N}, \\mu_{t}^{N}) \\mathrm{d}W_{t}^{i} $$\n括号中的项是生成元 $\\mathcal{L}_{\\mu}$ 对 $\\varphi$ 在 $(X_{t}^{i,N}, \\mu_{t}^{N})$ 处求值的作用。我们将其记为 $\\mathcal{L}_{\\mu_{t}^{N}}\\varphi(X_{t}^{i,N})$。\n\n接下来，我们考虑经验可观测量 $\\mu_{t}^{N}(\\varphi) = \\frac{1}{N}\\sum_{i=1}^{N} \\varphi(X_{t}^{i,N})$ 的动力学。根据微分和积分的线性性质：\n$$ \\mathrm{d}\\mu_{t}^{N}(\\varphi) = \\frac{1}{N} \\sum_{i=1}^{N} \\mathrm{d}\\varphi(X_{t}^{i,N}) = \\left(\\frac{1}{N}\\sum_{i=1}^{N} \\mathcal{L}_{\\mu_{t}^{N}}\\varphi(X_{t}^{i,N})\\right)\\mathrm{d}t + \\frac{1}{N}\\sum_{i=1}^{N} \\nabla \\varphi(X_{t}^{i,N})^{T} \\sigma(X_{t}^{i,N}, \\mu_{t}^{N}) \\mathrm{d}W_{t}^{i} $$\n这个方程给出了 $\\mu_{t}^{N}(\\varphi)$ 的 Doob–Meyer 分解。过程 $\\mu_{t}^{N}(\\varphi)$ 表示为一个有限变差项和一个鞅的和。有限变差部分是 $\\int_{0}^{t} \\left(\\frac{1}{N}\\sum_{i=1}^{N} \\mathcal{L}_{\\mu_{s}^{N}}\\varphi(X_{s}^{i,N})\\right)\\mathrm{d}s$，而鞅部分是：\n$$ M_{t}^{N}(\\varphi) = \\frac{1}{N}\\sum_{i=1}^{N} \\int_{0}^{t} \\nabla \\varphi(X_{s}^{i,N})^{T} \\sigma(X_{s}^{i,N}, \\mu_{s}^{N}) \\mathrm{d}W_{s}^{i} $$\n问题要求计算这个鞅的可预测二次变差 $\\langle M^{N}(\\varphi)\\rangle_{t}$。由于布朗运动 $(W^{i})_{i=1}^{N}$ 是独立的，这些随机积分之和的二次变差等于它们各自二次变差的和：\n$$ \\langle M^{N}(\\varphi)\\rangle_{t} = \\left\\langle \\sum_{i=1}^{N} \\int_{0}^{\\cdot} \\frac{1}{N} \\nabla \\varphi(X_{s}^{i,N})^{T} \\sigma(X_{s}^{i,N}, \\mu_{s}^{N}) \\mathrm{d}W_{s}^{i} \\right\\rangle_{t} = \\sum_{i=1}^{N} \\left\\langle \\int_{0}^{\\cdot} \\frac{1}{N} \\nabla \\varphi(X_{s}^{i,N})^{T} \\sigma(X_{s}^{i,N}, \\mu_{s}^{N}) \\mathrm{d}W_{s}^{i} \\right\\rangle_{t} $$\n对于一个向量值被积函数 $H_{s}$ (此处为一个 $1 \\times m$ 的行向量)，$\\int_{0}^{t} H_{s} \\mathrm{d}W_{s}$ 的二次变差是 $\\int_{0}^{t} \\mathrm{Tr}(H_{s}H_{s}^{T}) \\mathrm{d}s$。对于我们的 $1 \\times m$ 被积函数，这等于 $\\int_{0}^{t} \\|H_{s}^{T}\\|_{\\mathbb{R}^{m}}^{2} \\mathrm{d}s$。这里，$H_{s}^{i} = \\frac{1}{N} \\nabla \\varphi(X_{s}^{i,N})^{T} \\sigma(X_{s}^{i,N}, \\mu_{s}^{N})$。\n$$ \\left\\langle \\int_{0}^{\\cdot} H_{s}^{i} \\mathrm{d}W_{s}^{i} \\right\\rangle_{t} = \\int_{0}^{t} \\left\\|\\left(\\frac{1}{N} \\nabla \\varphi(X_{s}^{i,N})^{T} \\sigma(X_{s}^{i,N}, \\mu_{s}^{N})\\right)^{T}\\right\\|_{\\mathbb{R}^{m}}^{2} \\mathrm{d}s = \\frac{1}{N^{2}} \\int_{0}^{t} \\left\\| \\sigma(X_{s}^{i,N}, \\mu_{s}^{N})^{T} \\nabla \\varphi(X_{s}^{i,N}) \\right\\|_{\\mathbb{R}^{m}}^{2} \\mathrm{d}s $$\n将 $i$ 从 $1$ 到 $N$ 求和：\n$$ \\langle M^{N}(\\varphi)\\rangle_{t} = \\sum_{i=1}^{N} \\frac{1}{N^{2}} \\int_{0}^{t} \\left\\| \\sigma(X_{s}^{i,N}, \\mu_{s}^{N})^{T} \\nabla \\varphi(X_{s}^{i,N}) \\right\\|_{\\mathbb{R}^{m}}^{2} \\mathrm{d}s $$\n根据富比尼定理，我们可以交换求和与积分的次序：\n$$ \\langle M^{N}(\\varphi)\\rangle_{t} = \\frac{1}{N} \\int_{0}^{t} \\left( \\frac{1}{N} \\sum_{i=1}^{N} \\left\\| \\sigma(X_{s}^{i,N}, \\mu_{s}^{N})^{T} \\nabla \\varphi(X_{s}^{i,N}) \\right\\|_{\\mathbb{R}^{m}}^{2} \\right) \\mathrm{d}s $$\n括号内的项可以写成关于经验测度 $\\mu_{s}^{N}$ 的积分：\n$$ \\langle M^{N}(\\varphi)\\rangle_{t} = \\frac{1}{N} \\int_{0}^{t} \\int_{\\mathbb{R}^{d}} \\left\\| \\sigma(x, \\mu_{s}^{N})^{T} \\nabla \\varphi(x) \\right\\|_{\\mathbb{R}^{m}}^{2} \\mu_{s}^{N}(\\mathrm{d}x) \\mathrm{d}s $$\n这就是可预测二次变差的显式表达式。\n\n为了求当 $N \\to \\infty$ 时的极限，我们使用有界性假设。给定存在一个常数 $\\Sigma \\in (0, \\infty)$ 使得 $\\sup_{x,\\mu} \\|\\sigma(x,\\mu)\\|_{\\mathrm{op}} \\le \\Sigma$，并且 $\\varphi \\in C_{b}^{2}(\\mathbb{R}^{d})$，这意味着其梯度有界，即 $\\|\\nabla \\varphi\\|_{\\infty} := \\sup_{x \\in \\mathbb{R}^{d}} \\|\\nabla \\varphi(x)\\| < \\infty$。\n我们对被积函数中的平方范数进行放缩：\n$$ \\left\\| \\sigma(x, \\mu_{s}^{N})^{T} \\nabla \\varphi(x) \\right\\|_{\\mathbb{R}^{m}} \\le \\left\\| \\sigma(x, \\mu_{s}^{N})^{T} \\right\\|_{\\mathrm{op}} \\|\\nabla \\varphi(x)\\| $$\n利用性质 $\\|\\sigma^{T}\\|_{\\mathrm{op}} = \\|\\sigma\\|_{\\mathrm{op}}$，我们有：\n$$ \\left\\| \\sigma(x, \\mu_{s}^{N})^{T} \\nabla \\varphi(x) \\right\\|_{\\mathbb{R}^{m}} \\le \\left\\| \\sigma(x, \\mu_{s}^{N}) \\right\\|_{\\mathrm{op}} \\|\\nabla \\varphi(x)\\| \\le \\Sigma \\cdot \\|\\nabla \\varphi\\|_{\\infty} $$\n两边平方，得到被积函数的一个一致上界：\n$$ \\left\\| \\sigma(x, \\mu_{s}^{N})^{T} \\nabla \\varphi(x) \\right\\|_{\\mathbb{R}^{m}}^{2} \\le \\Sigma^{2} \\|\\nabla \\varphi\\|_{\\infty}^{2} $$\n现在我们将这个界应用于二次变差表达式的内层积分：\n$$ \\int_{\\mathbb{R}^{d}} \\left\\| \\sigma(x, \\mu_{s}^{N})^{T} \\nabla \\varphi(x) \\right\\|_{\\mathbb{R}^{m}}^{2} \\mu_{s}^{N}(\\mathrm{d}x) \\le \\int_{\\mathbb{R}^{d}} \\Sigma^{2} \\|\\nabla \\varphi\\|_{\\infty}^{2} \\mu_{s}^{N}(\\mathrm{d}x) $$\n因为 $\\mu_{s}^{N}$ 是一个概率测度，所以 $\\int_{\\mathbb{R}^{d}} \\mu_{s}^{N}(\\mathrm{d}x) = 1$。因此：\n$$ \\int_{\\mathbb{R}^{d}} \\left\\| \\sigma(x, \\mu_{s}^{N})^{T} \\nabla \\varphi(x) \\right\\|_{\\mathbb{R}^{m}}^{2} \\mu_{s}^{N}(\\mathrm{d}x) \\le \\Sigma^{2} \\|\\nabla \\varphi\\|_{\\infty}^{2} $$\n这为时间积分的被积函数提供了一个一致上界。将此代回 $\\langle M^{N}(\\varphi)\\rangle_{t}$ 的表达式：\n$$ 0 \\le \\langle M^{N}(\\varphi)\\rangle_{t} \\le \\frac{1}{N} \\int_{0}^{t} \\Sigma^{2} \\|\\nabla \\varphi\\|_{\\infty}^{2} \\mathrm{d}s = \\frac{t \\Sigma^{2} \\|\\nabla \\varphi\\|_{\\infty}^{2}}{N} $$\n对于任何固定的 $t \\in [0,T]$，上界 $\\frac{t \\Sigma^{2} \\|\\nabla \\varphi\\|_{\\infty}^{2}}{N}$ 是一个有限量除以 $N$。当 $N \\to \\infty$ 时，这个上界趋于 $0$。\n$$ \\lim_{N \\to \\infty} \\frac{t \\Sigma^{2} \\|\\nabla \\varphi\\|_{\\infty}^{2}}{N} = 0 $$\n根据夹逼定理，由于 $\\langle M^{N}(\\varphi)\\rangle_{t}$ 总是非负的，其在 $N \\to \\infty$ 时的极限必定为 $0$。\n$$ \\lim_{N \\to \\infty} \\langle M^{N}(\\varphi) \\rangle_{t} = 0 $$\n这个结果表明，在大粒子极限下，鞅项的方差消失，这是证明混沌传播的关键一步，意味着经验测度的演化收敛到一个由 McKean-Vlasov 方程描述的确定性极限。", "answer": "$$\\boxed{0}$$", "id": "2991706"}, {"introduction": "知道粒子系统会收敛到平均场极限是第一步，但收敛的*速度*有多快？本练习将收敛速度与极限系统本身的性质联系起来，探讨了泛函不等式（特别是 Poincaré 不等式）与粒子近似统计误差之间的深刻联系 [@problem_id:2991714]。通过为一个具体的 Ornstein-Uhlenbeck 类型模型推导 Poincaré 常数，你将学会如何为“混沌误差”提供严格的定量界限，并理解均方误差通常以 $1/N$ 的速率衰减。", "problem": "考虑处于平衡状态的一维平均场粒子系统，其由以下随机微分方程（SDE）支配\n$$\ndX_{t}^{i,N} \\;=\\; -\\frac{1}{\\sigma^{2}}\\,X_{t}^{i,N}\\,dt \\;-\\; \\theta\\bigl(X_{t}^{i,N} - \\bar{X}_{t}^{N}\\bigr)\\,dt \\;+\\; \\sqrt{2}\\,dB_{t}^{i}, \\quad i=1,\\dots,N,\n$$\n其中 $\\sigma>0$，$\\theta\\ge 0$，$\\bar{X}_{t}^{N} := \\frac{1}{N}\\sum_{j=1}^{N} X_{t}^{j,N}$，且 $\\{B_{t}^{i}\\}_{i=1}^{N}$ 是相互独立的标准布朗运动。其 McKean–Vlasov 极限为单粒子 SDE\n$$\ndX_{t} \\;=\\; -\\frac{1}{\\sigma^{2}}\\,X_{t}\\,dt \\;-\\; \\theta\\bigl(X_{t}-m_{t}\\bigr)\\,dt \\;+\\; \\sqrt{2}\\,dB_{t},\n$$\n其中 $m_{t} := \\mathbb{E}[X_{t}]$。在平稳状态下，有 $m_{t}=0$，且 $X_{t}$ 的不变分布 $\\mu$ 是高斯分布，其密度为\n$$\n\\mu(dx) \\;\\propto\\; \\exp\\!\\Bigl(-\\frac{1}{2}\\Bigl(\\frac{1}{\\sigma^{2}}+\\theta\\Bigr)x^{2}\\Bigr)\\,dx,\n$$\n即 $\\mu = \\mathcal{N}\\!\\bigl(0,\\sigma_{\\mathrm{eff}}^{2}\\bigr)$，其中 $\\sigma_{\\mathrm{eff}}^{2} := \\bigl(\\frac{1}{\\sigma^{2}}+\\theta\\bigr)^{-1}$。\n\n要求您将泛函不等式与平衡态下粒子近似的定量“混沌传播”（propagation-of-chaos）误差联系起来。请按以下步骤进行。\n\n1. 从概率测度 $\\mu$ 在 $\\mathbb{R}$ 上的 Poincaré 不等式定义出发，\n$$\n\\mathrm{Var}_{\\mu}(f) \\;\\le\\; C_{P} \\int_{\\mathbb{R}} |f'(x)|^{2}\\,\\mu(dx),\n$$\n推导与上述平稳单粒子动力学相关的高斯不变分布 $\\mu = \\mathcal{N}\\!\\bigl(0,\\sigma_{\\mathrm{eff}}^{2}\\bigr)$ 的精确 Poincaré 常数 $C_{P}$。您的推导必须从第一性原理（例如，Ornstein–Uhlenbeck 半群的生成元和谱性质，或 Rayleigh 商的变分法）开始，并证明您计算出的 $C_{P}$ 是最优的（sharp）。\n\n2. 设 $f:\\mathbb{R}\\to\\mathbb{R}$ 是一个 Lipschitz 测试函数，其 Lipschitz 常数为 $L$，即对所有 $x,y\\in\\mathbb{R}$ 都有 $|f(x)-f(y)| \\le L|x-y|$。考虑从 $\\mu$ 中抽取的 $N$ 个独立同分布样本构建的经验近似，其在均方意义下的平衡态混沌误差为\n$$\n\\mathbb{E}\\Biggl[\\Biggl(\\frac{1}{N}\\sum_{i=1}^{N} f(X^{i}) \\;-\\; \\int_{\\mathbb{R}} f\\,d\\mu\\Biggr)^{2}\\Biggr],\n$$\n其中 $X^{1},\\dots,X^{N}\\stackrel{\\mathrm{iid}}{\\sim}\\mu$。使用第 1 部分得到的 $C_{P}$ 以及关于独立样本均值方差的基本性质，推导一个形式如下的界：\n$$\n\\mathbb{E}\\Biggl[\\Biggl(\\frac{1}{N}\\sum_{i=1}^{N} f(X^{i}) \\;-\\; \\int_{\\mathbb{R}} f\\,d\\mu\\Biggr)^{2}\\Biggr] \\;\\le\\; \\frac{C(\\sigma,\\theta,L)}{N},\n$$\n并计算出仅能用 $\\sigma$、$\\theta$ 和 $L$ 表示的最小可能常数 $C(\\sigma,\\theta,L)$。\n\n请将您的最终结果表示为 $C(\\sigma,\\theta,L)/N$ 的一个单一闭式解析表达式。无需四舍五入，不涉及单位。", "solution": "我们从第一性原理开始。平稳单粒子分布 $\\mu$ 的密度为\n$$\n\\rho(x) \\;=\\; Z^{-1}\\exp\\!\\Bigl(-\\frac{a}{2}x^{2}\\Bigr), \\qquad a \\;:=\\; \\frac{1}{\\sigma^{2}}+\\theta, \\quad Z>0,\n$$\n因此 $\\mu$ 是一个中心化的高斯分布，其方差为 $\\sigma_{\\mathrm{eff}}^{2} = a^{-1}$。作用于足够光滑的函数 $f:\\mathbb{R}\\to\\mathbb{R}$ 上的相应 Ornstein–Uhlenbeck 半群的生成元是\n$$\n\\mathcal{L}f(x) \\;=\\; f''(x) - a\\,x\\,f'(x).\n$$\n该算子在 $L^{2}(\\mu)$ 中是对称的，并具有离散谱，其特征值为 $0, a, 2a, \\dots$，相关的正交本征函数由（适当归一化的）Hermite 多项式给出。特别地，$-\\mathcal{L}$ 的最小非零特征值，称为谱隙，等于 $a$。$\\mu$ 的 Poincaré 不等式等价于谱隙不等式：\n$$\n\\mathrm{Var}_{\\mu}(f) \\;\\le\\; \\frac{1}{\\lambda_{1}} \\int |f'(x)|^{2}\\, \\mu(dx),\n$$\n其中 $\\lambda_{1}$ 是 $-\\mathcal{L}$ 的最小正特征值，这里 $\\lambda_{1} = a$。因此，最优 Poincaré 常数为\n$$\nC_{P} \\;=\\; \\frac{1}{a} \\;=\\; \\frac{1}{\\frac{1}{\\sigma^{2}}+\\theta} \\;=\\; \\sigma_{\\mathrm{eff}}^{2}.\n$$\n另一种推导方法是使用 Rayleigh 商的变分法。对于满足 $\\int g\\,d\\mu=0$ 的函数 $g$，考虑\n$$\n\\mathcal{R}[g] \\;:=\\; \\frac{\\int g(x)^{2}\\,\\mu(dx)}{\\int |g'(x)|^{2}\\,\\mu(dx)}.\n$$\n最优常数 $C_{P}$ 是 $\\mathcal{R}[g]$ 在所有光滑零均值函数 $g$ 上的上确界。极值函数的 Euler–Lagrange 方程导出了 Sturm–Liouville 问题\n$$\n-\\frac{d}{dx}\\Bigl(\\rho(x)\\,g'(x)\\Bigr) \\;=\\; \\lambda \\,\\rho(x)\\,g(x),\n$$\n对于高斯密度 $\\rho$，其解是 Hermite 函数，特征值为 $\\lambda = k a$, $k\\in\\mathbb{N}$。最大的 Rayleigh 商对应于最小的正特征值 $\\lambda_{1}=a$，这证实了 $C_{P} = 1/a$ 并且该常数是最优的。\n\n我们现在通过 Poincaré 不等式来界定 Lipschitz 可观测量下的平衡态混沌误差。设 $f$ 为 Lipschitz 函数，常数为 $L$。根据 Rademacher 定理，$f$ 几乎处处可微，且几乎处处有 $|f'(x)| \\le L$。因此，\n$$\n\\mathrm{Var}_{\\mu}(f) \\;\\le\\; C_{P} \\int |f'(x)|^{2}\\,\\mu(dx) \\;\\le\\; C_{P}\\,L^{2}.\n$$\n如果 $X^{1},\\dots,X^{N}$ 是服从分布 $\\mu$ 的独立同分布随机变量，那么\n$$\n\\mathbb{E}\\Biggl[\\Biggl(\\frac{1}{N}\\sum_{i=1}^{N} f(X^{i}) \\;-\\; \\int f\\,d\\mu\\Biggr)^{2}\\Biggr]\n\\;=\\; \\frac{1}{N}\\,\\mathrm{Var}_{\\mu}(f),\n$$\n根据独立样本均值方差的可加性。将这些结果结合起来，得到\n$$\n\\mathbb{E}\\Biggl[\\Biggl(\\frac{1}{N}\\sum_{i=1}^{N} f(X^{i}) \\;-\\; \\int f\\,d\\mu\\Biggr)^{2}\\Biggr]\n\\;\\le\\; \\frac{C_{P}\\,L^{2}}{N}.\n$$\n由于 $C_{P}$ 对于高斯分布是最优的，通过取 $C_{P} = \\sigma_{\\mathrm{eff}}^{2} = \\bigl(\\frac{1}{\\sigma^{2}}+\\theta\\bigr)^{-1}$，可以使此界最小化。因此，仅依赖于 $\\sigma$、$\\theta$ 和 $L$ 的最小可能常数是\n$$\nC(\\sigma,\\theta,L) \\;=\\; \\frac{L^{2}}{\\frac{1}{\\sigma^{2}}+\\theta}.\n$$\n因此，出现在平衡态混沌误差中的紧致界定常数为\n$$\n\\frac{C(\\sigma,\\theta,L)}{N} \\;=\\; \\frac{L^{2}}{N\\bigl(\\frac{1}{\\sigma^{2}}+\\theta\\bigr)}.\n$$\n这个界通过从强凸有效势导出的高斯不变分布的 Poincaré 常数，量化了 Lipschitz 可观测量在主导阶 $\\frac{1}{N}$ 上的均方混沌误差。", "answer": "$$\\boxed{\\frac{L^{2}}{N\\left(\\frac{1}{\\sigma^{2}}+\\theta\\right)}}$$", "id": "2991714"}, {"introduction": "“混沌传播”并非普适定律，它依赖于粒子之间渐近独立的假设。本练习构建了一个挑战此假设的场景，旨在探索混沌概念的边界。我们将研究与系统守恒量相关的初始相关性是如何随时间持续存在的，从而阻止系统达到真正的混沌状态 [@problem_id:2991746]。通过分析一个具有特殊相关初始态的碰撞模型，你将发现初始协方差可以被动力学过程完整保留，这为分子混沌假设的适用范围提供了一个深刻而清晰的反例。", "problem": "考虑一个由 $N$ 个粒子组成的相互作用系统，其标量速度为 $\\{V_{i}^{N}(t)\\}_{i=1}^{N}$，该系统在连续时间内通过保持总动量守恒的二元碰撞进行演化。碰撞发生过程如下：对于每一个无序对 $(i,j)$，碰撞由一个速率为 $\\beta/N$ 的泊松过程触发，且各对之间的过程相互独立。在索引为 $i$ 和 $j$ 的粒子发生碰撞时，该粒子对的速度更新如下\n$$\nV_{i}^{N}(t^{+}) \\;=\\; \\frac{V_{i}^{N}(t^{-}) + V_{j}^{N}(t^{-})}{2} \\;+\\; \\eta, \n\\qquad\nV_{j}^{N}(t^{+}) \\;=\\; \\frac{V_{i}^{N}(t^{-}) + V_{j}^{N}(t^{-})}{2} \\;-\\; \\eta,\n$$\n其中 $\\eta$ 是从一个均值为 $0$、有限方差为 $\\sigma_{\\eta}^{2}$ 的固定对称分布中抽取的独立样本，与所有先前的随机性及所有其他粒子对都无关。此规则在每次碰撞中都保持总动量 $\\sum_{k=1}^{N} V_{k}^{N}(t)$ 守恒。在碰撞之间，速度保持不变。\n\n为了探究分子混沌和混沌传播的局限性，通过引入一个共同的潜变量，使用一个相关的可交换分布来初始化系统。具体来说，令\n$$\nV_{i}^{N}(0) \\;=\\; U \\;+\\; \\xi_{i}, \\quad i=1,\\dots,N,\n$$\n其中 $U$ 是一个实值随机变量，满足 $\\mathbb{E}[U]=0$ 和 $\\operatorname{Var}(U)=\\sigma_{U}^{2}$，而 $\\{\\xi_{i}\\}_{i=1}^{N}$ 是独立同分布的随机变量，满足 $\\mathbb{E}[\\xi_{i}]=0$ 和 $\\operatorname{Var}(\\xi_{i})=\\sigma_{\\xi}^{2}$，且与 $U$ 相互独立。上述碰撞核只要求动量守恒和可交换性；没有假定其他结构。\n\n从可交换性、协方差和守恒律的基本定义出发，且不援引任何现成的混沌传播定理，确定在任意固定时间 $t\\ge 0$ 时，粒子对协方差在 $N$ 趋于无穷大时的极限的闭式解析表达式，\n$$\n\\lim_{N\\to\\infty} \\operatorname{Cov}\\!\\big(V_{1}^{N}(t),\\, V_{2}^{N}(t)\\big),\n$$\n用上述模型参数表示。你的最终答案必须是一个单一的闭式解析表达式。无需四舍五入，也无单位。", "solution": "该问题要求确定给定相互作用粒子系统中，粒子速度的对协方差在 $N$ 趋于无穷大时的极限，即 $\\lim_{N\\to\\infty} \\operatorname{Cov}(V_{1}^{N}(t), V_{2}^{N}(t))$。本解法将从基本原理推导，而不借助已有的混沌传播定理。\n\n首先，我们为有限 $N$ 系统定义关键的统计量。由于初始条件和碰撞动力学的可交换性，所有粒子的统计性质都是相同的。设 $S_N(t)$ 为单个粒子速度的方差，$C_N(t)$ 为任意两个不同粒子在时间 $t$ 速度的协方差。\n$$\nS_N(t) = \\operatorname{Var}(V_{i}^{N}(t))\n$$\n$$\nC_N(t) = \\operatorname{Cov}(V_{i}^{N}(t), V_{j}^{N}(t)) \\quad \\text{for } i \\neq j\n$$\n初始条件为 $V_{i}^{N}(0) = U + \\xi_{i}$，其中 $U$ 和 $\\{\\xi_i\\}$ 是均值为零的独立随机变量。因此，在时间 $t=0$ 时的平均速度为 $\\mathbb{E}[V_{i}^{N}(0)] = \\mathbb{E}[U] + \\mathbb{E}[\\xi_i] = 0 + 0 = 0$。碰撞规则为\n$$\nV_{i}^{N}(t^{+}) = \\frac{V_{i}^{N}(t^{-}) + V_{j}^{N}(t^{-})}{2} + \\eta\n$$\n$$\nV_{j}^{N}(t^{+}) = \\frac{V_{i}^{N}(t^{-}) + V_{j}^{N}(t^{-})}{2} - \\eta\n$$\n其中 $\\mathbb{E}[\\eta] = 0$。在给定碰撞前状态的条件下，碰撞后速度的期望值为 $\\mathbb{E}[V_{i}^{N}(t^{+}) | \\mathcal{F}_{t^{-}}] = \\frac{1}{2}(V_i^N(t^-) + V_j^N(t^-))$。取全期望，我们发现如果对所有 $k$ 都有 $\\mathbb{E}[V_k^N(t^-)]=0$，那么 $\\mathbb{E}[V_i^N(t^+)]=0$。由于在 $t=0$ 时均值为零，所以在所有 $t \\ge 0$ 时均值都保持为零。\n因此，对于所有 $i$ 和 $t$，$\\mathbb{E}[V_{i}^{N}(t)] = 0$，这简化了方差和协方差的表达式：\n$$\nS_N(t) = \\mathbb{E}[(V_{i}^{N}(t))^2] \\quad \\text{和} \\quad C_N(t) = \\mathbb{E}[V_{i}^{N}(t) V_{j}^{N}(t)] \\text{ for } i \\neq j.\n$$\n我们将为 $S_N(t)$ 和 $C_N(t)$ 推导一个常微分方程组。状态的任意函数 $f$ 的期望的演化由 $\\frac{d}{dt}\\mathbb{E}[f] = \\mathbb{E}[\\mathcal{L}f]$ 决定，其中 $\\mathcal{L}$ 是该马尔可夫过程的生成元。生成元由下式给出\n$$\n\\mathcal{L}f(v_1, \\dots, v_N) = \\sum_{1 \\le i < j \\le N} \\frac{\\beta}{N} \\mathbb{E}_{\\eta}[f(\\dots, v_i', \\dots, v_j', \\dots) - f(\\dots, v_i, \\dots, v_j, \\dots)]\n$$\n其中 $(v_i', v_j')$ 是粒子对 $(i, j)$ 碰撞后的速度。\n\n我们来推导 $S_N(t) = \\mathbb{E}[(V_1^N)^2]$ 的方程。速度 $V_1^N$ 仅在粒子 1 与另一个粒子 $k \\in \\{2, \\dots, N\\}$ 碰撞时才会改变。\n$$\n\\frac{dS_N(t)}{dt} = \\mathbb{E}[\\mathcal{L}(V_1^2)] = \\mathbb{E}\\left[ \\sum_{k=2}^{N} \\frac{\\beta}{N} \\mathbb{E}_{\\eta}[(V_1'(k))^2 - V_1^2] \\right]\n$$\n其中 $V_1'(k)$ 是粒子 1 与粒子 $k$ 碰撞后的速度。\n对于任意一次这样的碰撞，$\\mathbb{E}_{\\eta}[(V_1'(k))^2] = \\mathbb{E}_{\\eta}[(\\frac{V_1+V_k}{2} + \\eta)^2] = (\\frac{V_1+V_k}{2})^2 + \\mathbb{E}[\\eta^2] = \\frac{V_1^2+V_k^2+2V_1V_k}{4} + \\sigma_{\\eta}^2$。\n在给定状态下，期望的变化为 $\\mathbb{E}_{\\eta}[(V_1'(k))^2 - V_1^2] = \\frac{V_1^2+V_k^2+2V_1V_k}{4} + \\sigma_{\\eta}^2 - V_1^2 = \\frac{-3V_1^2+V_k^2+2V_1V_k}{4} + \\sigma_{\\eta}^2$。\n取全期望，并对粒子 1 的 $N-1$ 个可能的碰撞伙伴求和：\n$$\n\\frac{dS_N(t)}{dt} = \\sum_{k=2}^{N} \\frac{\\beta}{N} \\left( \\frac{-3\\mathbb{E}[V_1^2]+\\mathbb{E}[V_k^2]+2\\mathbb{E}[V_1V_k]}{4} + \\sigma_{\\eta}^2 \\right)\n$$\n利用可交换性，当 $k \\ne 1$ 时，有 $\\mathbb{E}[V_k^2] = S_N(t)$ 和 $\\mathbb{E}[V_1V_k] = C_N(t)$。\n$$\n\\frac{dS_N(t)}{dt} = (N-1) \\frac{\\beta}{N} \\left( \\frac{-3S_N(t)+S_N(t)+2C_N(t)}{4} + \\sigma_{\\eta}^2 \\right) = \\frac{(N-1)\\beta}{N} \\left( \\frac{C_N(t)-S_N(t)}{2} + \\sigma_{\\eta}^2 \\right).\n$$\n现在，我们来推导 $C_N(t) = \\mathbb{E}[V_1^N V_2^N]$ 的方程。如果粒子 1 或 2 参与碰撞，则乘积 $V_1^N V_2^N$ 会发生改变。我们将生成元 $\\mathcal{L}$ 应用于函数 $f = V_1V_2$。\n$$\n\\frac{dC_N(t)}{dt} = \\mathbb{E}[\\mathcal{L}(V_1V_2)] = \\mathbb{E}\\left[ \\sum_{1 \\le i < j \\le N} \\frac{\\beta}{N} \\mathbb{E}_{\\eta}[V_1'V_2' - V_1V_2] \\right]\n$$\n仅当 $\\{i,j\\} \\cap \\{1,2\\} \\neq \\emptyset$ 时，和中的项才非零。\n1.  情况 $(i,j)=(1,2)$：变化量为 $\\mathbb{E}_{\\eta}[(\\frac{V_1+V_2}{2}+\\eta)(\\frac{V_1+V_2}{2}-\\eta) - V_1V_2] = (\\frac{V_1+V_2}{2})^2-\\sigma_{\\eta}^2 - V_1V_2 = \\frac{V_1^2+V_2^2-2V_1V_2}{4} - \\sigma_{\\eta}^2$。\n2.  情况 $i=1, j=k>2$：变化量为 $\\mathbb{E}_{\\eta}[(\\frac{V_1+V_k}{2}+\\eta)V_2 - V_1V_2] = \\frac{V_1V_2+V_kV_2}{2} - V_1V_2 = \\frac{V_kV_2-V_1V_2}{2}$。共有 $N-2$ 个这样的项。\n3.  情况 $i=2, j=k>2$：变化量为 $\\mathbb{E}_{\\eta}[V_1(\\frac{V_2+V_k}{2}+\\eta) - V_1V_2] = \\frac{V_1V_2+V_1V_k}{2} - V_1V_2 = \\frac{V_1V_k-V_1V_2}{2}$。共有 $N-2$ 个这样的项。\n\n取全期望：\n$$\n\\frac{dC_N(t)}{dt} = \\frac{\\beta}{N}\\left(\\frac{S_N+S_N-2C_N}{4}-\\sigma_{\\eta}^2\\right) + \\sum_{k=3}^{N} \\frac{\\beta}{N}\\left(\\frac{C_N-C_N}{2}\\right) + \\sum_{k=3}^{N} \\frac{\\beta}{N}\\left(\\frac{C_N-C_N}{2}\\right)\n$$\n这些和为零。因此，\n$$\n\\frac{dC_N(t)}{dt} = \\frac{\\beta}{N} \\left( \\frac{S_N(t)-C_N(t)}{2} - \\sigma_{\\eta}^2 \\right).\n$$\n问题陈述总动量守恒。这意味着系统总动量的方差是恒定的。\n$\\operatorname{Var}\\left(\\sum_i V_i^N(t)\\right) = \\operatorname{Var}\\left(\\sum_i V_i^N(0)\\right)$。\n$\\operatorname{Var}\\left(\\sum_i V_i^N(t)\\right) = \\sum_i \\operatorname{Var}(V_i^N) + \\sum_{i \\neq j} \\operatorname{Cov}(V_i^N, V_j^N) = N S_N(t) + N(N-1)C_N(t)$。\n在 $t=0$ 时，$V_i^N(0) = U+\\xi_i$。\n$\\operatorname{Var}\\left(\\sum_i V_i^N(0)\\right) = \\operatorname{Var}\\left(\\sum_i (U+\\xi_i)\\right) = \\operatorname{Var}(NU + \\sum_i \\xi_i) = N^2\\operatorname{Var}(U) + \\sum_i\\operatorname{Var}(\\xi_i) = N^2\\sigma_U^2 + N\\sigma_\\xi^2$。\n令两式相等，得到不变量：$N S_N(t) + N(N-1)C_N(t) = N^2\\sigma_U^2 + N\\sigma_\\xi^2$，化简为：\n$$\nS_N(t) + (N-1)C_N(t) = N\\sigma_U^2 + \\sigma_\\xi^2.\n$$\n我们可以利用这个代数关系来求解该方程组。根据不变量，$S_N(t) = N\\sigma_U^2 + \\sigma_\\xi^2 - (N-1)C_N(t)$。将此式代入 $C_N(t)$ 的常微分方程中：\n$$\n\\frac{dC_N(t)}{dt} = \\frac{\\beta}{N} \\left( \\frac{(N\\sigma_U^2 + \\sigma_\\xi^2 - (N-1)C_N(t)) - C_N(t)}{2} - \\sigma_{\\eta}^2 \\right)\n$$\n$$\n\\frac{dC_N(t)}{dt} = \\frac{\\beta}{N} \\left( \\frac{N\\sigma_U^2 + \\sigma_\\xi^2 - NC_N(t)}{2} - \\sigma_{\\eta}^2 \\right)\n$$\n$$\n\\frac{dC_N(t)}{dt} = \\frac{\\beta}{2}\\left(\\sigma_U^2 + \\frac{\\sigma_\\xi^2}{N} - C_N(t)\\right) - \\frac{\\beta\\sigma_\\eta^2}{N}\n$$\n这个常微分方程可以整理为：\n$$\n\\frac{dC_N(t)}{dt} + \\frac{\\beta}{2}C_N(t) = \\frac{\\beta}{2}\\sigma_U^2 + \\frac{\\beta}{2N}(\\sigma_\\xi^2 - 2\\sigma_\\eta^2).\n$$\n我们关心的是极限 $C(t) = \\lim_{N\\to\\infty} C_N(t)$。假设该极限及其导数存在，我们可以对常微分方程取极限：\n$$\n\\frac{dC(t)}{dt} + \\frac{\\beta}{2}C(t) = \\lim_{N\\to\\infty} \\left( \\frac{\\beta}{2}\\sigma_U^2 + \\frac{\\beta}{2N}(\\sigma_\\xi^2 - 2\\sigma_\\eta^2) \\right) = \\frac{\\beta}{2}\\sigma_U^2.\n$$\n这个极限常微分方程的初始条件是 $C(0) = \\lim_{N\\to\\infty} C_N(0)$。我们计算 $C_N(0)$：\n$$\nC_N(0) = \\operatorname{Cov}(V_1^N(0), V_2^N(0)) = \\operatorname{Cov}(U+\\xi_1, U+\\xi_2).\n$$\n因为 $U$、$\\xi_1$ 和 $\\xi_2$ 相互独立，\n$$\nC_N(0) = \\operatorname{Cov}(U,U) + \\operatorname{Cov}(U,\\xi_2) + \\operatorname{Cov}(\\xi_1,U) + \\operatorname{Cov}(\\xi_1,\\xi_2) = \\operatorname{Var}(U) + 0 + 0 + 0 = \\sigma_U^2.\n$$\n因此，初始条件 $C(0)$ 是 $\\sigma_U^2$。\n\n我们现在必须求解线性一阶常微分方程 $\\frac{dC(t)}{dt} + \\frac{\\beta}{2}C(t) = \\frac{\\beta}{2}\\sigma_U^2$，其初始条件为 $C(0)=\\sigma_U^2$。\n该方程有一个特解 $C_p(t) = \\sigma_U^2$。验证如下：$0 + \\frac{\\beta}{2}\\sigma_U^2 = \\frac{\\beta}{2}\\sigma_U^2$。通解为 $C(t) = A\\exp(-\\frac{\\beta}{2}t) + \\sigma_U^2$。应用初始条件：\n$C(0) = A + \\sigma_U^2 = \\sigma_U^2$，这意味着 $A=0$。\n因此，唯一解是 $C(t) = \\sigma_U^2$。\n\n在所有时间 $t \\ge 0$ 内，协方差是恒定的。由共同潜变量 $U$ 产生的初始相关性被动力学过程所保持，因为它与系统总动量相关，而总动量是一个守恒量。相互作用仅仅是在粒子间重新分配动量，但不能消除这种全局相关性。", "answer": "$$\n\\boxed{\\sigma_{U}^{2}}\n$$", "id": "2991746"}]}