{"hands_on_practices": [{"introduction": "这个首个练习旨在检验你对维纳混沌展开（Wiener chaos decomposition）核心机制的理解。通过从第一性原理出发，计算布朗泛函 $F = \\int_{0}^{1} W(t)^{2} \\, dt$ 的方差，你将实践如何识别混沌分量并应用关键的伊藤等距定理（Itō isometry）。这项动手计算对于在白噪声分析框架下，为平方可积泛函的结构建立坚实的直观理解至关重要。[@problem_id:3006136]", "problem": "设 $\\{W(t)\\}_{t \\in [0,1]}$ 为在一个带有其典范滤的完备概率空间 $(\\Omega,\\mathcal{F},\\mathbb{P})$ 上的标准一维布朗运动。在白噪声分析中，布朗运动可以通过多重Wiener-Itō积分来表示，并且 $W$ 的每个平方可积泛函都可以唯一地分解为称为Wiener混沌的正交分量。考虑平方可积布朗泛函\n$$\nF \\equiv \\int_{0}^{1} W(t)^{2} \\, dt.\n$$\n从Itō积分和Wiener混沌分解的基本定义出发（不使用任何现成的快捷公式），运用第一性原理，通过识别其第二混沌分量并利用多重Wiener-Itō积分的正交性和等距性质，来确定 $F$ 的方差的精确值。请用精确形式（无四舍五入）表达你的最终答案。", "solution": "该问题是有效的，因为它具有科学依据、是良定的且客观的。它提出了一个随机分析中的标准问题，可以使用指定的第一性原理方法，即Wiener混沌分解来解决。\n\n设 $\\{W(t)\\}_{t \\in [0,1]}$ 为一个标准一维布朗运动。我们需要计算随机变量 $F = \\int_{0}^{1} W(t)^{2} \\, dt$ 的方差。方差定义为 $\\text{Var}(F) = \\mathbb{E}[F^2] - (\\mathbb{E}[F])^2$。我们将使用 $F$ 的Wiener混沌展开来确定这个值。\n\n布朗运动的任何平方可积泛函 $F$ 都有一个唯一的正交分解，称为Wiener混沌展开：\n$$\nF = \\sum_{n=0}^{\\infty} I_n(f_n)\n$$\n其中 $I_n(f_n)$ 是一个对称的、确定性的核 $f_n \\in L^2([0,1]^n)$（即 $[0,1]^n$ 上的平方可积函数空间）的第$n$重Wiener-Itō积分。项 $I_n(f_n)$ 被称为 $F$ 的第$n$混沌分量。\n\n该展开的关键性质是：\n1.  第零混沌分量是 $F$ 的期望：$I_0(f_0) = \\mathbb{E}[F]$。\n2.  混沌分量在 $L^2(\\Omega)$ 中是正交的，即对于 $n \\neq m$, 有 $\\mathbb{E}[I_n(f_n) I_m(g_m)] = 0$。\n3.  Itō等距将 $L^2(\\Omega)$ 中的范数与 $L^2([0,1]^n)$ 中的范数联系起来：\n    $$\n    \\mathbb{E}[I_n(f_n)^2] = n! \\|f_n\\|_{L^2([0,1]^n)}^2 = n! \\int_{[0,1]^n} f_n(t_1, \\dots, t_n)^2 \\, dt_1 \\dots dt_n.\n    $$\n\n根据这些性质，$F$ 的方差可以表示为：\n$$\n\\text{Var}(F) = \\mathbb{E}[(F - \\mathbb{E}[F])^2] = \\mathbb{E}\\left[\\left(\\sum_{n=1}^{\\infty} I_n(f_n)\\right)^2\\right] = \\sum_{n=1}^{\\infty} \\mathbb{E}[I_n(f_n)^2] = \\sum_{n=1}^{\\infty} n! \\|f_n\\|_{L^2([0,1]^n)}^2.\n$$\n\n我们的策略是为特定的泛函 $F = \\int_{0}^{1} W(t)^{2} \\, dt$ 找出其核 $f_n$。\n\n首先，我们将布朗运动 $W(t)$ 本身表示为一阶Wiener-Itō积分。对于一个固定的 $t \\in [0,1]$，$W(t)$ 由下式给出：\n$$\nW(t) = \\int_{0}^{t} 1 \\, dW(s) = \\int_{0}^{1} \\mathbf{1}_{[0,t]}(s) \\, dW(s)\n$$\n其中 $\\mathbf{1}_{[0,t]}(s)$ 是指示函数，当 $s \\in [0,t]$ 时其值为 $1$，否则为 $0$。这表明对于每个 $t$，$W(t)$ 都在第一Wiener混沌中，$W(t) = I_1(g_t)$，其核为 $g_t(s) = \\mathbf{1}_{[0,t]}(s)$。\n\n接下来，我们求 $W(t)^2$ 的混沌展开。两个一阶Wiener积分 $I_1(g)$ 和 $I_1(h)$ 的乘积由乘积公式给出：$I_1(g)I_1(h) = I_2(g \\otimes h) + \\langle g, h \\rangle_{L^2([0,1])}$。对于 $g=h=g_t$，我们有：\n$$\nW(t)^2 = I_1(g_t)^2 = I_2(g_t \\otimes g_t) + \\langle g_t, g_t \\rangle_{L^2([0,1])}\n$$\n内积项为：\n$$\n\\langle g_t, g_t \\rangle_{L^2([0,1])} = \\int_{0}^{1} (\\mathbf{1}_{[0,t]}(s))^2 \\, ds = \\int_{0}^{t} 1 \\, ds = t.\n$$\n二阶积分的核是 $(g_t \\otimes g_t)(s_1, s_2) = g_t(s_1)g_t(s_2) = \\mathbf{1}_{[0,t]}(s_1)\\mathbf{1}_{[0,t]}(s_2)$。这个核已经关于 $s_1$ 和 $s_2$ 是对称的。因此，我们得到 $W(t)^2$ 的混沌分解：\n$$\nW(t)^2 = t + I_2(\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]}).\n$$\n项 $t$ 是第零混沌分量（期望 $\\mathbb{E}[W(t)^2]=t$），而 $I_2(\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]})$ 是第二混沌分量。\n\n现在，我们可以通过将 $W(t)^2$ 的表达式关于 $t$ 从 $0$ 到 $1$ 进行积分来找到 $F$ 的分解：\n$$\nF = \\int_{0}^{1} W(t)^2 \\, dt = \\int_{0}^{1} \\left( t + I_2(\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]}) \\right) \\, dt = \\int_{0}^{1} t \\, dt + \\int_{0}^{1} I_2(\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]}) \\, dt.\n$$\n第一项是一个确定性常数：\n$$\n\\int_{0}^{1} t \\, dt = \\left[\\frac{t^2}{2}\\right]_{0}^{1} = \\frac{1}{2}.\n$$\n这是 $F$ 的第零混沌分量，所以 $I_0(f_0) = \\frac{1}{2}$，这意味着 $\\mathbb{E}[F] = \\frac{1}{2}$。\n\n对于第二项，我们可以交换时间积分和随机积分（根据随机Fubini定理）：\n$$\n\\int_{0}^{1} I_2(\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]}) \\, dt = I_2\\left(\\int_{0}^{1} (\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]}) \\, dt\\right).\n$$\n这就得到了 $F$ 的第二混沌分量，我们将其记作 $F_2 = I_2(f_2)$。其核 $f_2$ 为：\n$$\nf_2(s_1, s_2) = \\int_{0}^{1} (\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]})(s_1, s_2) \\, dt = \\int_{0}^{1} \\mathbf{1}_{[0,t]}(s_1) \\mathbf{1}_{[0,t]}(s_2) \\, dt.\n$$\n指示函数的乘积 $\\mathbf{1}_{[0,t]}(s_1) \\mathbf{1}_{[0,t]}(s_2)$ 为 $1$ 当且仅当 $s_1 \\le t$ 且 $s_2 \\le t$，这等价于 $\\max(s_1, s_2) \\le t$。因此，核为：\n$$\nf_2(s_1, s_2) = \\int_{0}^{1} \\mathbf{1}_{[\\max(s_1, s_2), 1]}(t) \\, dt = \\int_{\\max(s_1, s_2)}^{1} 1 \\, dt = 1 - \\max(s_1, s_2).\n$$\n这个核对于 $(s_1, s_2) \\in [0,1]^2$ 是良定的，并且是对称的。\n\n因此，$F$ 的完整混沌展开为：\n$$\nF = \\frac{1}{2} + I_2(1 - \\max(s_1, s_2)).\n$$\n这表明 $F$ 仅在第零和第二混沌中有分量。第一混沌分量以及所有更高阶的分量（$n \\geq 3$）均为零。$F$ 的第二混沌分量是 $F_2 = I_2(1 - \\max(s_1, s_2))$。\n\n$F$ 的方差是其 $n \\ge 1$ 的混沌分量的方差之和。由于只有第二分量非零，方差就等于这个分量的方差：\n$$\n\\text{Var}(F) = \\text{Var}(F_2) = \\mathbb{E}[(I_2(f_2))^2].\n$$\n使用Itō等距，我们有：\n$$\n\\text{Var}(F) = 2! \\|f_2\\|_{L^2([0,1]^2)}^2 = 2 \\int_{0}^{1}\\int_{0}^{1} (f_2(s_1, s_2))^2 \\, ds_1 ds_2.\n$$\n现在我们必须计算这个积分：\n$$\n\\|f_2\\|^2 = \\int_{0}^{1}\\int_{0}^{1} (1 - \\max(s_1, s_2))^2 \\, ds_1 ds_2.\n$$\n由于被积函数的对称性，我们可以将区域 $[0,1]^2$ 分割成 $s_1 \\le s_2$ 和 $s_2 \\le s_1$ 两个三角形，计算其中一个三角形上的积分，然后乘以 $2$。\n$$\n\\|f_2\\|^2 = 2 \\int_{0}^{1} \\left( \\int_{0}^{s_2} (1 - \\max(s_1, s_2))^2 \\, ds_1 \\right) ds_2.\n$$\n在积分区域 $0 \\le s_1 \\le s_2 \\le 1$ 中，我们有 $\\max(s_1, s_2) = s_2$。积分变为：\n$$\n\\|f_2\\|^2 = 2 \\int_{0}^{1} \\left( \\int_{0}^{s_2} (1 - s_2)^2 \\, ds_1 \\right) ds_2.\n$$\n内层积分为：\n$$\n\\int_{0}^{s_2} (1 - s_2)^2 \\, ds_1 = (1 - s_2)^2 \\int_{0}^{s_2} 1 \\, ds_1 = s_2(1 - s_2)^2.\n$$\n将此代入外层积分：\n$$\n\\|f_2\\|^2 = 2 \\int_{0}^{1} s_2(1 - s_2)^2 \\, ds_2 = 2 \\int_{0}^{1} s_2(1 - 2s_2 + s_2^2) \\, ds_2 = 2 \\int_{0}^{1} (s_2 - 2s_2^2 + s_2^3) \\, ds_2.\n$$\n计算该积分：\n$$\n\\|f_2\\|^2 = 2 \\left[ \\frac{s_2^2}{2} - \\frac{2s_2^3}{3} + \\frac{s_2^4}{4} \\right]_{0}^{1} = 2 \\left( \\frac{1}{2} - \\frac{2}{3} + \\frac{1}{4} \\right) = 2 \\left( \\frac{6 - 8 + 3}{12} \\right) = 2 \\left( \\frac{1}{12} \\right) = \\frac{1}{6}.\n$$\n最后，我们计算 $F$ 的方差：\n$$\n\\text{Var}(F) = 2! \\|f_2\\|^2 = 2 \\times \\frac{1}{6} = \\frac{1}{3}.\n$$\n泛函 $F = \\int_{0}^{1} W(t)^{2} \\, dt$ 的方差是 $\\frac{1}{3}$。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "3006136"}, {"introduction": "在掌握了单个泛函的分解之后，下一个练习将挑战你处理两个随机变量的乘积。你将应用多重维纳-伊东积分的乘积公式，这是一个依赖于核函数缩并（kernel contractions）组合结构的强大工具。这个练习将加深你对混沌展开的代数性质及其在分析随机系统内部非线性相互作用中作用的理解。[@problem_id:3006137]", "problem": "考虑一个完备概率空间上的标准布朗运动 $\\{B_{t}\\}_{t \\geq 0}$ 以及在 $L^{2}(\\mathbb{R}_{+})$ 上相关的等距正态高斯过程 $W$，其定义为 $W(h) = \\int_{0}^{\\infty} h(t) \\,\\mathrm{d}B_{t}$，其中 $h \\in L^{2}(\\mathbb{R}_{+})$。对于一个对称核 $f \\in L^{2}(\\mathbb{R}_{+}^{n})$，定义多重维纳-伊藤积分 $I_{n}(f)$ 为满足等距性质 $\\mathbb{E}[I_{n}(f) I_{m}(g)] = \\delta_{n,m} \\, n! \\, \\langle f, g \\rangle_{L^{2}(\\mathbb{R}_{+}^{n})}$ 的 $n$ 阶齐次混沌元素，其中 $g \\in L^{2}(\\mathbb{R}_{+}^{m})$。在白噪声分析 (WNA) 中，多重积分的乘积具有维纳混沌展开 (WCE)，该展开式通过核的缩并来表述。设 $f \\in L^{2}(\\mathbb{R}_{+}^{p})$ 和 $g \\in L^{2}(\\mathbb{R}_{+}^{q})$ 之间的 $r$ 阶缩并是映射 $f \\otimes_{r} g \\in L^{2}(\\mathbb{R}_{+}^{p+q-2r})$，它是通过对 $r$ 个坐标进行积分得到的，并设 $\\widetilde{\\otimes}$ 表示对称化。\n\n固定参数 $\\alpha > 0$ 和 $\\beta > 0$，并定义 $h(t) = \\exp(-\\alpha t)$ 和 $k(t) = \\exp(-\\beta t)$，其中 $t \\geq 0$。考虑二阶混沌随机变量 $X = I_{2}(h^{\\otimes 2})$ 和 $Y = I_{2}(k^{\\otimes 2})$。从上述核心定义和缩并的组合结构出发，推导乘积 $XY$ 的维纳混沌展开（表示为阶数为 $4, 2, 0$ 的多重维纳-伊藤积分之和，其核由 $h$ 和 $k$ 通过缩并构造）。然后，显式地求出确定性系数（零阶混沌项），作为 $\\alpha$ 和 $\\beta$ 的函数。\n\n你的最终答案必须是 $XY$ 的维纳混沌展开中常数项的、关于 $\\alpha$ 和 $\\beta$ 的单一闭式解析表达式。无需四舍五入。", "solution": "题目要求计算两个二阶混沌随机变量 $X = I_{2}(h^{\\otimes 2})$ 和 $Y = I_{2}(k^{\\otimes 2})$ 乘积的维纳混沌展开中的确定性系数，即零阶项。\n\n解决此问题的基石是多重维纳-伊藤积分的乘积公式。设 $f \\in L^2(\\mathbb{R}_{+}^p)$ 和 $g \\in L^2(\\mathbb{R}_{+}^q)$ 为对称核。相应多重积分 $I_p(f)$ 和 $I_q(g)$ 的乘积可以表示为低阶多重积分的和：\n$$ I_p(f) I_q(g) = \\sum_{r=0}^{\\min(p,q)} r! \\binom{p}{r} \\binom{q}{r} I_{p+q-2r}(f \\widetilde{\\otimes}_r g) $$\n其中 $f \\widetilde{\\otimes}_r g$ 表示核 $f$ 和 $g$ 的 $r$ 阶缩并的对称化。缩并 $f \\otimes_r g$ 是 $L^2(\\mathbb{R}_{+}^{p+q-2r})$ 上的一个函数，通过对 $r$ 个共享变量进行积分得到。\n\n在我们具体的问题中，随机变量为 $X = I_{2}(f)$ 和 $Y = I_{2}(g)$，其中核的阶数分别为 $p=2$ 和 $q=2$。核由函数 $h(t) = \\exp(-\\alpha t)$ 和 $k(t) = \\exp(-\\beta t)$ 的张量积给出：\n$$ f(t_1, t_2) = h(t_1)h(t_2) = \\exp(-\\alpha t_1 - \\alpha t_2) $$\n$$ g(s_1, s_2) = k(s_1)k(s_2) = \\exp(-\\beta s_1 - \\beta s_2) $$\n由于 $\\alpha > 0$ 和 $\\beta > 0$，保证了 $h, k \\in L^2(\\mathbb{R}_{+})$，因此这些核是 $L^2(\\mathbb{R}_{+}^2)$ 中的元素。根据构造，它们也是对称的。\n\n应用 $p=2, q=2$ 的乘积公式，我们有 $\\min(p,q)=2$。$XY$ 的展开式为：\n$$ XY = \\sum_{r=0}^{2} r! \\binom{2}{r} \\binom{2}{r} I_{4-2r}(f \\widetilde{\\otimes}_r g) $$\n让我们逐项展开这个和：\n当 $r=0$ 时：$0! \\binom{2}{0} \\binom{2}{0} I_4(f \\widetilde{\\otimes}_0 g) = I_4(f \\widetilde{\\otimes} g)$。这是四阶混沌分量。\n当 $r=1$ 时：$1! \\binom{2}{1} \\binom{2}{1} I_2(f \\widetilde{\\otimes}_1 g) = 4 I_2(f \\widetilde{\\otimes}_1 g)$。这是二阶混沌分量。\n当 $r=2$ 时：$2! \\binom{2}{2} \\binom{2}{2} I_0(f \\widetilde{\\otimes}_2 g) = 2 I_0(f \\otimes_2 g)$。这是零阶混沌分量。由于缩并 $f \\otimes_2 g$ 的结果是一个标量，其对称化就是其本身。\n\n题目要求我们找到确定性系数，这正是零阶混沌项。0 阶混沌中的随机变量 $I_0(c)$ 就是常数 $c \\in \\mathbb{R}$ 本身。这一项也对应于该随机变量的期望值 $\\mathbb{E}[XY]$。\n\n因此，所求系数为 $2 (f \\otimes_2 g)$。我们必须计算二阶缩并 $f \\otimes_2 g$。对于两个核 $f, g \\in L^2(\\mathbb{R}_{+}^2)$，此缩并定义为它们在 $L^2(\\mathbb{R}_{+}^2)$ 中的内积：\n$$ f \\otimes_2 g = \\langle f, g \\rangle_{L^2(\\mathbb{R}_{+}^2)} = \\int_{\\mathbb{R}_{+}^2} f(t_1, t_2) g(t_1, t_2) \\,\\mathrm{d}t_1 \\,\\mathrm{d}t_2 $$\n代入 $f$ 和 $g$ 的显式形式：\n$$ f \\otimes_2 g = \\int_{0}^{\\infty} \\int_{0}^{\\infty} \\left( \\exp(-\\alpha t_1 - \\alpha t_2) \\right) \\left( \\exp(-\\beta t_1 - \\beta t_2) \\right) \\,\\mathrm{d}t_1 \\,\\mathrm{d}t_2 $$\n我们可以合并指数：\n$$ f \\otimes_2 g = \\int_{0}^{\\infty} \\int_{0}^{\\infty} \\exp(-(\\alpha+\\beta)t_1 - (\\alpha+\\beta)t_2) \\,\\mathrm{d}t_1 \\,\\mathrm{d}t_2 $$\n该积分可分离为两个相同积分的乘积：\n$$ f \\otimes_2 g = \\left( \\int_{0}^{\\infty} \\exp(-(\\alpha+\\beta)t) \\,\\mathrm{d}t \\right) \\left( \\int_{0}^{\\infty} \\exp(-(\\alpha+\\beta)t) \\,\\mathrm{d}t \\right) $$\n让我们计算这个单一积分。由于参数 $\\alpha$ 和 $\\beta$ 严格为正，它们的和 $\\alpha+\\beta$ 也严格为正，这保证了反常积分的收敛性：\n$$ \\int_{0}^{\\infty} \\exp(-(\\alpha+\\beta)t) \\,\\mathrm{d}t = \\left[ -\\frac{1}{\\alpha+\\beta} \\exp(-(\\alpha+\\beta)t) \\right]_{t=0}^{t \\to \\infty} $$\n$$ = \\lim_{T \\to \\infty} \\left( -\\frac{1}{\\alpha+\\beta} \\exp(-(\\alpha+\\beta)T) \\right) - \\left( -\\frac{1}{\\alpha+\\beta} \\exp(0) \\right) $$\n$$ = 0 - \\left( -\\frac{1}{\\alpha+\\beta} \\right) = \\frac{1}{\\alpha+\\beta} $$\n将此结果代回缩并的表达式中：\n$$ f \\otimes_2 g = \\left( \\frac{1}{\\alpha+\\beta} \\right) \\left( \\frac{1}{\\alpha+\\beta} \\right) = \\frac{1}{(\\alpha+\\beta)^2} $$\n最后，零阶混沌项为 $2 (f \\otimes_2 g)$。\n$$ \\text{零阶项} = 2 \\times \\frac{1}{(\\alpha+\\beta)^2} = \\frac{2}{(\\alpha+\\beta)^2} $$\n这个结果可以通过使用维纳-伊藤等距性质直接计算期望 $\\mathbb{E}[XY]$ 来验证：\n$$ \\mathbb{E}[XY] = \\mathbb{E}[I_2(f) I_2(g)] = 2! \\langle f, g \\rangle_{L^2(\\mathbb{R}_{+}^2)} = 2 \\langle f, g \\rangle_{L^2(\\mathbb{R}_{+}^2)} $$\n这证实了我们的计算，因为 $\\mathbb{E}[XY]$ 是 $XY$ 的维纳混沌展开中的零阶项。计算出的值为 $\\frac{2}{(\\alpha+\\beta)^2}$。", "answer": "$$\\boxed{\\frac{2}{(\\alpha+\\beta)^2}}$$", "id": "3006137"}, {"introduction": "最后的这个实践将抽象理论与具体计算联系起来，展示了维纳混沌展开在数值近似中的作用。你将实现维克指数（Wick exponential）$X_t = \\exp(\\lambda W_t - \\frac{1}{2}\\lambda^2 t)$ 的混沌展开——这是随机分析中的一个关键对象，并分析其截断级数的收敛性。通过编写代码来计算近似误差，你将获得关于这些无穷级数如何在实际应用中被使用和评估的实践性见解。[@problem_id:3006134]", "problem": "考虑一个带滤概率空间上的实值标准布朗运动 $W = \\{W_t\\}_{t \\ge 0}$，白噪声分析将其形式导数解释为高斯白噪声。对于固定的时间 $t > 0$ 和参数 $\\lambda \\in \\mathbb{R}$，定义随机变量 $X_t$ 为 $X_t = \\exp\\left(\\lambda W_t - \\tfrac{1}{2}\\lambda^2 t\\right)$。该随机变量是 $\\lambda W_t$ 的Wick指数，并且可以根据概率论学家的Hermite多项式进行Wiener混沌展开。Wiener混沌展开基于 $L^2(\\Omega)$ 到齐次混沌的正交分解，其中第n阶混沌由n重Wiener积分张成，等价地，由 $H_n(Z)$ 张成，其中 $Z$ 为标准正态随机变量，$H_n$ 为概率论学家的Hermite多项式。概率论学家的Hermite多项式在标准正态定律下满足正交性，并刻画了Wiener混沌展开。使用白噪声分析和Wiener混沌展开的这些基本定义，推导 $X_t$ 的N阶部分和近似的截断性质，并计算其导出误差。\n\n您的程序必须为每个给定的测试用例 $(t,\\lambda,N)$ 实现以下计算：\n\n1. 计算 $X_t$ 的N阶截断Wiener混沌近似的二阶矩，记为 $S_N(t,\\lambda)$。该量是混沌系数的平方乘以由正交性导出的相应混沌范数的总和，并且需要使用Wiener混沌基和概率论学家的Hermite多项式性质从第一性原理确定。\n\n2. 计算 $X_t$ 的N阶部分和近似的均方截断误差（$L^2(\\Omega)$ 误差平方）$R_N(t,\\lambda)$。这是被忽略的混沌系数的平方乘以混沌范数的总和，应从正交性导出。\n\n3. 使用高斯矩母函数和 $X_t$ 的定义计算精确二阶矩 $\\mathbb{E}[X_t^2]$。\n\n对于每个测试用例，您的程序必须按 $[S_N(t,\\lambda), R_N(t,\\lambda), \\mathbb{E}[X_t^2]]$ 的顺序生成这三个量。计算中不涉及物理单位。\n\n测试套件：\n- 案例 A: $(t,\\lambda,N) = (1.0, 0.5, 5)$\n- 案例 B: $(t,\\lambda,N) = (0.0, 1.234, 3)$\n- 案例 C: $(t,\\lambda,N) = (2.0, 0.0, 10)$\n- 案例 D: $(t,\\lambda,N) = (1.5, 1.2, 0)$\n- 案例 E: $(t,\\lambda,N) = (3.0, 0.8, 20)$\n\n覆盖性设计：\n- 案例 B 测试边界 $t = 0$，此时 $X_t$ 变为确定性的，截断是精确的。\n- 案例 C 测试边界 $\\lambda = 0$，此时 $X_t$ 变为确定性的，截断是精确的。\n- 案例 D 测试边界情况 $N = 0$，只捕捉零阶混沌。\n- 案例 A 和 E 测试具有中等和较大截断阶数的一般非平凡情况。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。每个测试用例对应一个子列表，其中包含三个浮点数，顺序为 $[S_N, R_N, \\mathbb{E}[X_t^2]]$。例如，输出形式应为 $[[S_N^{(A)}, R_N^{(A)}, E^{(A)}],[S_N^{(B)}, R_N^{(B)}, E^{(B)}],\\dots]$，不含任何额外文本。", "solution": "我们从布朗运动、白噪声分析和Wiener混沌展开的基本定义出发。设 $W = \\{W_t\\}_{t \\ge 0}$ 为标准布朗运动，并考虑对于固定的 $t > 0$ 和 $\\lambda \\in \\mathbb{R}$ 的 $X_t = \\exp\\left(\\lambda W_t - \\tfrac{1}{2}\\lambda^2 t\\right)$。定义 $Z = W_t / \\sqrt{t}$，这是一个标准正态随机变量。概率论学家的Hermite多项式 $H_n$ 为 $Z$ 的 $L^2$ 泛函提供了一个正交基，并生成了Wiener混沌分解。推导过程基于两个关键且经过充分检验的事实：\n\n1. 概率论学家的Hermite多项式满足正交关系 $\\mathbb{E}[H_n(Z)H_m(Z)] = n! \\,\\delta_{nm}$，其中 $\\delta_{nm}$ 是Kronecker delta。\n\n2. 高斯生成函数恒等式成立：对于 $\\theta \\in \\mathbb{R}$ 和标准正态变量 $Z$，有 $\\exp\\left(\\theta Z - \\tfrac{1}{2}\\theta^2\\right) = \\sum_{n=0}^{\\infty} \\frac{\\theta^n}{n!} H_n(Z)$。此恒等式由高斯分布的矩母函数以及通过Rodrigues公式定义的 $H_n$ 导出。这是一个标准的、经过充分检验的公式，用于获得标准化高斯指数的Hermite展开。\n\n将 $\\theta = \\lambda \\sqrt{t}$ 和 $Z = W_t/\\sqrt{t}$ 应用于此，我们得到Wiener混沌展开\n$$\nX_t = \\sum_{n=0}^{\\infty} a_n(t,\\lambda) \\, H_n(Z), \\quad a_n(t,\\lambda) = \\frac{(\\lambda \\sqrt{t})^n}{n!}.\n$$\n这可以通过将 $\\theta = \\lambda \\sqrt{t}$ 直接代入生成函数得到。\n\n设N阶截断Wiener混沌近似为\n$$\nX_t^{(N)} = \\sum_{n=0}^{N} a_n(t,\\lambda) \\, H_n(Z).\n$$\n利用正交性，$X_t^{(N)}$ 的 $L^2(\\Omega)$ 范数的平方等于\n$$\n\\mathbb{E}\\left[(X_t^{(N)})^2\\right] = \\sum_{n=0}^{N} a_n(t,\\lambda)^2 \\, \\mathbb{E}[H_n(Z)^2] = \\sum_{n=0}^{N} \\left(\\frac{(\\lambda \\sqrt{t})^n}{n!}\\right)^2 n! = \\sum_{n=0}^{N} \\frac{(\\lambda^2 t)^n}{n!}.\n$$\n定义 $S_N(t,\\lambda) := \\mathbb{E}\\left[(X_t^{(N)})^2\\right]$；则\n$$\nS_N(t,\\lambda) = \\sum_{n=0}^{N} \\frac{(\\lambda^2 t)^n}{n!}.\n$$\n\n$X_t$ 和 $X_t^{(N)}$ 之间的均方截断误差（$L^2(\\Omega)$ 误差平方）由尾项的范数平方给出：\n$$\nR_N(t,\\lambda) := \\mathbb{E}\\left[\\left(X_t - X_t^{(N)}\\right)^2\\right] = \\sum_{n=N+1}^{\\infty} a_n(t,\\lambda)^2 \\, \\mathbb{E}[H_n(Z)^2] = \\sum_{n=N+1}^{\\infty} \\frac{(\\lambda^2 t)^n}{n!}.\n$$\n这里利用了正交性来消除交叉项，并利用了混沌分量在 $L^2(\\Omega)$ 中是正交的这一事实。\n\n为了确定 $X_t$ 的精确二阶矩，注意到对于任意 $p \\in \\mathbb{R}$，\n$$\nX_t^p = \\exp\\left(p \\lambda W_t - \\tfrac{1}{2} p \\lambda^2 t\\right).\n$$\n使用高斯矩母函数 $\\mathbb{E}[\\exp(\\theta W_t)] = \\exp\\left(\\tfrac{1}{2}\\theta^2 t\\right)$ 并令 $\\theta = p \\lambda$，我们得到\n$$\n\\mathbb{E}[X_t^p] = \\exp\\left(\\tfrac{1}{2} (p \\lambda)^2 t - \\tfrac{1}{2} p \\lambda^2 t\\right) = \\exp\\left(\\tfrac{1}{2}\\lambda^2 t (p^2 - p)\\right).\n$$\n令 $p = 2$ 可得\n$$\n\\mathbb{E}[X_t^2] = \\exp\\left(\\lambda^2 t\\right).\n$$\n结合 $S_N(t,\\lambda)$ 和 $R_N(t,\\lambda)$ 与 $\\mathbb{E}[X_t^2]$ 的表达式，注意到 $\\mathbb{E}[X_t^2] = S_N(t,\\lambda) + R_N(t,\\lambda)$，因此\n$$\nR_N(t,\\lambda) = \\exp\\left(\\lambda^2 t\\right) - \\sum_{n=0}^{N} \\frac{(\\lambda^2 t)^n}{n!}.\n$$\n\n算法设计：\n- 对每个测试用例计算 $\\beta := \\lambda^2 t$。\n- 通过对级数 $\\sum_{n=0}^N \\beta^n / n!$ 进行迭代求和来评估 $S_N(t,\\lambda)$，使用项的递推关系 $T_0 = 1$ 和 $T_{n} = T_{n-1} \\cdot \\beta / n$ 来确保数值稳定性和效率。\n- 计算精确二阶矩 $E_{\\text{exact}} = \\exp(\\beta)$。\n- 计算截断误差 $R_N(t,\\lambda) = E_{\\text{exact}} - S_N(t,\\lambda)$。\n- 对每个测试用例，汇总这三个值 $[S_N, R_N, E_{\\text{exact}}]$。\n\n边界情况与正确性：\n- 如果 $t = 0$，则 $\\beta = 0$ 且 $X_t = 1$ 几乎必然成立。因此，$S_N = 1$，$E_{\\text{exact}} = 1$，$R_N = 0$。\n- 如果 $\\lambda = 0$，则 $\\beta = 0$ 且 $X_t = 1$ 几乎必然成立。所得值与上述情况相同。\n- 如果 $N = 0$，则 $S_0 = 1$，$R_0 = \\exp(\\beta) - 1$，这只匹配了零阶混沌的贡献。\n- 对于一般的 $t > 0$ 和 $\\lambda \\ne 0$，$S_N$ 是指数级数在 $\\beta$ 处求值的第N个部分和，$R_N$ 是对应的尾项；通过稳定的递推关系进行数值评估可确保对所提供案例的精确计算。\n\n最终程序为指定的测试套件计算这些量，并按要求的确切格式打印包含每个案例结果列表的单行输出。", "answer": "```python\nimport numpy as np\n\ndef partial_sum_exp_series(beta: float, N: int) -> float:\n    \"\"\"\n    Compute S_N = sum_{n=0}^N beta^n / n! using a stable recurrence.\n    \"\"\"\n    term = 1.0  # beta^0 / 0! = 1\n    s = term\n    for n in range(1, N + 1):\n        term *= beta / n\n        s += term\n    return s\n\ndef compute_case(t: float, lam: float, N: int):\n    \"\"\"\n    For given (t, lam, N), compute:\n    - S_N: second moment of the truncated chaos approximation\n    - R_N: mean-square truncation error\n    - E_exact: exact second moment E[X_t^2]\n    \"\"\"\n    beta = (lam ** 2) * t\n    S_N = partial_sum_exp_series(beta, N)\n    E_exact = float(np.exp(beta))\n    R_N = E_exact - S_N\n    return [S_N, R_N, E_exact]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 0.5, 5),   # Case A\n        (0.0, 1.234, 3), # Case B: t=0 boundary\n        (2.0, 0.0, 10),  # Case C: lambda=0 boundary\n        (1.5, 1.2, 0),   # Case D: N=0 edge\n        (3.0, 0.8, 20),  # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        t, lam, N = case\n        result = compute_case(t, lam, N)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Single line output: list of per-case lists.\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nsolve()\n```", "id": "3006134"}]}