{"hands_on_practices": [{"introduction": "将抽象概念付诸实践是掌握理论的关键。本练习旨在通过计算标准布朗运动在原点处局部时 $L_t^0$ 的一阶矩和二阶矩，来深化对局部时的理解。这个计算过程不仅能帮助你熟练运用田中公式来求解期望 $\\mathbb{E}[L_t^0]$，还将引导你使用占据时间密度公式来计算二阶矩 $\\mathbb{E}[(L_t^0)^2]$，从而揭示局部时作为随机变量的统计特性 [@problem_id:2973083]。", "problem": "设 $\\{B_{t}\\}_{t \\geq 0}$ 为一维标准布朗运动 (BM)，且 $B_{0}=0$，并设 $L_{t}^{0}$ 表示其在水平 $0$ 处的对称局部时，采用 Tanaka 公式中出现的归一化形式。仅从以下基本要素出发：\n- 布朗运动的定义和基本性质（独立、平稳的高斯增量，连续性），\n- 绝对值过程的 Tanaka 公式及相关的对称局部时概念，\n- 布朗运动的占位密度公式，\n- 以及标准高斯转移密度，\n\n通过一系列第一性原理的论证，推导出 $L_{t}^{0}$ 的一阶矩和二阶矩的闭式表达式。你的推导必须明确使用 Tanaka 公式将 $L_{t}^{0}$ 与一个鞅联系起来，并且必须通过引用布朗运动的标准可积性质来证明任何积分和期望交换的合理性。你可以不加证明地引用高斯转移密度的显式形式以及 Beta 积分 $\\int_{0}^{1} y^{-1/2}(1-y)^{-1/2}\\,dy$ 的值。\n\n提供 $\\mathbb{E}[L_{t}^{0}]$ 和 $\\mathrm{Var}(L_{t}^{0})$ 作为 $t>0$ 的函数的精确闭式表达式。不需要数值近似，也不涉及单位。你的最终答案必须只包含这两个量。", "solution": "问题是推导标准布朗运动在水平 $0$ 处的对称局部时（记为 $L_t^0$）的一阶矩和二阶矩。\n\n### 步骤 1：提取已知条件\n- $\\{B_t\\}_{t \\geq 0}$：一维标准布朗运动。\n- $B_0=0$：布朗运动从 $0$ 开始。\n- $L_t^0$：在水平 $0$ 处的对称局部时。\n- 允许使用的工具：\n    1. 布朗运动的定义和基本性质（独立、平稳的高斯增量，连续性）。\n    2. 关于 $|B_t|$ 的 Tanaka 公式：$|B_t| - |B_0| = \\int_0^t \\mathrm{sgn}(B_s) dB_s + L_t^0$。\n    3. 布朗运动的占位密度公式。形式上，$L_t^0 = \\int_0^t \\delta_0(B_s) ds$。更严谨地，对于一个可测函数 $f$，有 $\\int_0^t f(B_s) ds = \\int_{-\\infty}^\\infty f(a) L_t^a da$。\n    4. 标准高斯转移密度。\n    5. Beta 积分的值 $\\int_{0}^{1} y^{-1/2}(1-y)^{-1/2}\\,dy = \\pi$。\n\n### 步骤 2：使用已知条件进行验证\n该问题具有科学依据，是适定且客观的。这是随机微分方程和布朗运动理论中一个标准的、尽管是高级的问题。所有术语都是标准的，所求的量具有明确、唯一的值。对允许使用的工具的限制是明确的，为求解提供了清晰的路径。因此，该问题是有效的。\n\n### 步骤 3：结论与行动\n该问题有效。我现在开始求解。\n\n### 一阶矩 $\\mathbb{E}[L_t^0]$ 的推导\n\n根据问题陈述的要求，推导将使用 Tanaka 公式。关于过程 $|B_t|$ 的 Tanaka 公式由下式给出：\n$$|B_t| - |B_0| = \\int_0^t \\mathrm{sgn}(B_s) \\, dB_s + L_t^0$$\n鉴于 $B_0=0$，该公式简化为：\n$$|B_t| = \\int_0^t \\mathrm{sgn}(B_s) \\, dB_s + L_t^0$$\n我们可以通过对该方程两边取期望来求 $L_t^0$ 的期望：\n$$\\mathbb{E}[|B_t|] = \\mathbb{E}\\left[\\int_0^t \\mathrm{sgn}(B_s) \\, dB_s\\right] + \\mathbb{E}[L_t^0]$$\n右边的第一项是 Itô 随机积分的期望。我们必须验证该期望为零的条件。被积函数是 $H_s = \\mathrm{sgn}(B_s)$。这个过程是适应于布朗运动生成的信息流的。为了使随机积分为一个鞅（并因此期望为零，因为它从 $0$ 开始），我们必须检查条件 $\\mathbb{E}[\\int_0^t H_s^2 \\, ds] < \\infty$。\n被积函数的平方是 $(\\mathrm{sgn}(B_s))^2$。时间集合 $\\{s \\in [0, t] : B_s = 0\\}$ 几乎必然地具有勒贝格测度零。对于 $B_s \\neq 0$，我们有 $(\\mathrm{sgn}(B_s))^2 = 1$。因此，对于几乎所有的 $s \\in [0, t]$，$(\\mathrm{sgn}(B_s))^2 = 1$。该条件变为：\n$$\\mathbb{E}\\left[\\int_0^t (\\mathrm{sgn}(B_s))^2 \\, ds\\right] = \\mathbb{E}\\left[\\int_0^t 1 \\, ds\\right] = \\mathbb{E}[t] = t$$\n由于 $t < \\infty$，随机积分 $M_t = \\int_0^t \\mathrm{sgn}(B_s) \\, dB_s$ 是一个真鞅，并且由于 $M_0=0$，其期望为零：\n$$\\mathbb{E}\\left[\\int_0^t \\mathrm{sgn}(B_s) \\, dB_s\\right] = 0$$\n因此，期望值方程简化为：\n$$\\mathbb{E}[L_t^0] = \\mathbb{E}[|B_t|]$$\n现在，我们计算 $\\mathbb{E}[|B_t|]$。随机变量 $B_t$ 服从均值为 $0$、方差为 $t$ 的正态分布，即 $B_t \\sim N(0, t)$。其概率密度函数为 $p(x, t) = \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{x^2}{2t}\\right)$。\n$|B_t|$ 的期望是：\n$$\\mathbb{E}[|B_t|] = \\int_{-\\infty}^{\\infty} |x| \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{x^2}{2t}\\right) \\, dx$$\n由于被积函数是 $x$ 的偶函数，我们可以写成：\n$$\\mathbb{E}[|B_t|] = 2 \\int_{0}^{\\infty} x \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{x^2}{2t}\\right) \\, dx$$\n我们进行换元，令 $u = \\frac{x^2}{2t}$，则 $du = \\frac{x}{t} \\, dx$，这意味着 $x \\, dx = t \\, du$。积分上下限仍然是 $0$ 到 $\\infty$。\n$$\\mathbb{E}[|B_t|] = \\frac{2}{\\sqrt{2\\pi t}} \\int_{0}^{\\infty} t \\exp(-u) \\, du = \\frac{2t}{\\sqrt{2\\pi t}} [-\\exp(-u)]_0^\\infty = \\frac{2t}{\\sqrt{2\\pi t}} (0 - (-1)) = \\frac{2t}{\\sqrt{2\\pi t}}$$\n简化此表达式可得一阶矩：\n$$\\mathbb{E}[L_t^0] = \\sqrt{\\frac{4t^2}{2\\pi t}} = \\sqrt{\\frac{2t}{\\pi}}$$\n\n### 二阶矩 $\\mathbb{E}[(L_t^0)^2]$ 的推导\n\n对于二阶矩，我们将使用占位密度公式，这是允许使用的工具之一。形式上，$L_t^0 = \\int_0^t \\delta_0(B_s) \\, ds$，其中 $\\delta_0$ 是在 $0$ 处的狄拉克 delta 函数。将此表达式平方，我们得到：\n$$(L_t^0)^2 = \\left(\\int_0^t \\delta_0(B_s) \\, ds\\right) \\left(\\int_0^t \\delta_0(B_u) \\, du\\right) = \\int_0^t \\int_0^t \\delta_0(B_s) \\delta_0(B_u) \\, ds \\, du$$\n取期望并交换期望和积分的顺序，由于被积函数非负，这可以通过 Fubini 定理证明是合理的：\n$$\\mathbb{E}[(L_t^0)^2] = \\int_0^t \\int_0^t \\mathbb{E}[\\delta_0(B_s) \\delta_0(B_u)] \\, ds \\, du$$\n项 $\\mathbb{E}[\\delta_0(B_s) \\delta_0(B_u)]$ 表示 $(B_s, B_u)$ 在 $(0, 0)$ 处的联合概率密度。不失一般性地，我们假设 $0 \\le s < u \\le t$。向量 $(B_s, B_u)$ 是一个均值为零的高斯向量。其协方差矩阵 $\\Sigma$ 是：\n$$\\Sigma = \\begin{pmatrix} \\mathbb{E}[B_s^2] & \\mathbb{E}[B_s B_u] \\\\ \\mathbb{E}[B_u B_s] & \\mathbb{E}[B_u^2] \\end{pmatrix}$$\n我们有 $\\mathbb{E}[B_s^2] = s$ 和 $\\mathbb{E}[B_u^2] = u$。协方差是 $\\mathbb{E}[B_s B_u] = \\mathbb{E}[B_s (B_s + (B_u - B_s))] = \\mathbb{E}[B_s^2] + \\mathbb{E}[B_s (B_u - B_s)]$。由于增量的独立性，$\\mathbb{E}[B_s (B_u - B_s)] = \\mathbb{E}[B_s] \\mathbb{E}[B_u - B_s] = 0 \\cdot 0 = 0$。因此，$\\mathbb{E}[B_s B_u] = s$。\n协方差矩阵是 $\\Sigma = \\begin{pmatrix} s & s \\\\ s & u \\end{pmatrix}$。\n行列式是 $\\det(\\Sigma) = su - s^2 = s(u-s)$。\n均值为零的二元正态分布在 $(0,0)$ 处的联合密度由 $p_{s,u}(0,0) = \\frac{1}{2\\pi \\sqrt{\\det(\\Sigma)}}$ 给出。\n所以，对于 $s < u$，我们有 $\\mathbb{E}[\\delta_0(B_s) \\delta_0(B_u)] = \\frac{1}{2\\pi \\sqrt{s(u-s)}}$。\n二阶矩的积分变为：\n$$\\mathbb{E}[(L_t^0)^2] = \\int_0^t \\int_0^t \\frac{1}{2\\pi \\sqrt{\\min(s,u)(\\max(s,u)-\\min(s,u))}} \\, ds \\, du$$\n由于被积函数相对于 $s$ 和 $u$ 的对称性，我们可以将其写为：\n$$\\mathbb{E}[(L_t^0)^2] = 2 \\int_0^t \\left( \\int_0^u \\frac{1}{2\\pi \\sqrt{s(u-s)}} \\, ds \\right) \\, du$$\n让我们计算内层积分：\n$$I(u) = \\int_0^u \\frac{1}{\\sqrt{s(u-s)}} \\, ds = \\int_0^u \\frac{1}{\\sqrt{u^2 \\frac{s}{u}(1-\\frac{s}{u})}} \\, ds = \\frac{1}{u} \\int_0^u \\frac{1}{\\sqrt{\\frac{s}{u}(1-\\frac{s}{u})}} \\, ds$$\n令 $y = s/u$，则 $ds = u \\, dy$。当 $s=0$ 时，$y=0$；当 $s=u$ 时，$y=1$。\n$$I(u) = \\frac{1}{u} \\int_0^1 \\frac{u \\, dy}{\\sqrt{y(1-y)}} = \\int_0^1 y^{-1/2} (1-y)^{-1/2} \\, dy$$\n这是 Beta 积分 $B(1/2, 1/2)$，根据题目要求，我们可以取其值为 $\\pi$。所以，$I(u)=\\pi$。\n将此代回，内层积分为 $\\frac{1}{2\\pi} I(u) = \\frac{\\pi}{2\\pi} = \\frac{1}{2}$。\n现在我们计算外层积分：\n$$\\mathbb{E}[(L_t^0)^2] = 2 \\int_0^t \\frac{1}{2} \\, du = \\int_0^t 1 \\, du = t$$\n所以，局部时的二阶矩是 $\\mathbb{E}[(L_t^0)^2] = t$。\n\n### 方差 $\\mathrm{Var}(L_t^0)$ 的计算\n方差由公式 $\\mathrm{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2$ 给出。\n使用我们推导出的矩：\n$$\\mathrm{Var}(L_t^0) = \\mathbb{E}[(L_t^0)^2] - (\\mathbb{E}[L_t^0])^2 = t - \\left(\\sqrt{\\frac{2t}{\\pi}}\\right)^2 = t - \\frac{2t}{\\pi}$$\n提出因子 $t$，我们得到：\n$$\\mathrm{Var}(L_t^0) = t\\left(1 - \\frac{2}{\\pi}\\right)$$\n\n所求的量是 $\\mathbb{E}[L_t^0]$ 和 $\\mathrm{Var}(L_t^0)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sqrt{\\frac{2t}{\\pi}} & t\\left(1 - \\frac{2}{\\pi}\\right)\n\\end{pmatrix}\n}\n$$", "id": "2973083"}, {"introduction": "在掌握了单个过程的局部时之后，一个自然的问题是：当过程本身经过一个平滑变换后，它的局部时会如何变化？本练习将引导你运用伊藤公式和占据时间密度恒等式，推导出一个普适的局部时变量替换法则。这个推导不仅展示了随机微积分工具的威力，也揭示了局部时一个深刻的结构性质，这对于理解和分析更复杂的随机模型至关重要 [@problem_id:2999551]。", "problem": "设 $X=\\{X_t:t\\ge 0\\}$ 是一个一维连续半鞅，其典范分解为 $X=M+A$，其中 $M$ 是一个连续局部鞅，$A$ 是一个有界变差过程。对每个 $a\\in\\mathbb{R}$，对称局部时 $L_t^a(X)$ 通过 Tanaka 公式定义，并满足以下逗留时密度恒等式：对任意有界 Borel 函数 $f:\\mathbb{R}\\to\\mathbb{R}$ 和任意 $t\\ge 0$，\n$$\n\\int_0^t f\\!\\left(X_s\\right)\\,d\\langle X\\rangle_s \\;=\\; \\int_{\\mathbb{R}} f(a)\\,L_t^a(X)\\,da,\n$$\n其中 $\\langle X\\rangle$ 表示 $X$ 的二次变差。设 $\\phi:\\mathbb{R}\\to\\mathbb{R}$ 是一个二次连续可微函数，满足 $\\phi'\\in C^1(\\mathbb{R})$，并假设 $\\phi$ 是 $\\mathbb{R}$ 到 $\\mathbb{R}$ 上的一个 $C^2$-微分同胚，且 $\\inf_{x\\in\\mathbb{R}}|\\phi'(x)|>0$。通过 $Y_t=\\phi(X_t)$ 定义变换后的过程 $Y=\\{Y_t:t\\ge 0\\}$。\n\n仅从作用于连续半鞅与 $C^2$ 函数复合的 Itô 公式以及上述逗留时密度恒等式出发，推导在变量代换 $Y_t=\\phi(X_t)$ 下，$Y$ 的逗留时恒等式与 $X$ 的逗留时恒等式之间的关系。具体来说，请确定在固定空间水平 $b\\in\\mathbb{R}$ 上的局部时 $L_t^b(Y)$，并用 $L_t^{\\phi^{-1}(b)}(X)$ 和 $\\phi'$ 来表示。您的最终答案必须是 $L_t^b(Y)$ 的单个闭式解析表达式，且仅用 $L_t^{\\phi^{-1}(b)}(X)$ 和 $\\phi'$ 表示（不含其他任何量）。", "solution": "该问题是有效的。这是一个在随机分析数学领域内适定且有科学依据的问题。所给信息完整且一致，可以进行严格的推导。\n\n设 $X = \\{X_t : t \\ge 0\\}$ 是一个一维连续半鞅。设 $\\phi: \\mathbb{R} \\to \\mathbb{R}$ 是一个 $C^2$-微分同胚，且 $\\inf_{x\\in\\mathbb{R}}|\\phi'(x)| > 0$。变换后的过程定义为 $Y_t = \\phi(X_t)$。我们的目标是推导 $Y$ 的局部时（记为 $L_t^b(Y)$）与 $X$ 的局部时（记为 $L_t^a(X)$）之间的关系。\n\n推导过程首先将 Itô 公式应用于过程 $Y_t = \\phi(X_t)$。由于 $X$ 是一个连续半鞅且 $\\phi$ 是一个 $C^2$ 函数，Itô 公式表明：\n$$\n\\phi(X_t) = \\phi(X_0) + \\int_0^t \\phi'(X_s) dX_s + \\frac{1}{2} \\int_0^t \\phi''(X_s) d\\langle X \\rangle_s\n$$\n这就给出了 $Y_t$ 的半鞅表示。$Y_t$ 的鞅部分由包含 $dX_s$ 的随机积分项给出，由此我们可以确定 $Y$ 的二次变差。如果 $X = M+A$ 是 $X$ 分解为一个连续局部鞅 $M$ 和一个有界变差过程 $A$ 的典范分解，那么 $dX_s = dM_s + dA_s$。$X$ 的二次变差是 $\\langle X \\rangle_t = \\langle M \\rangle_t$。$Y_t$ 的鞅部分是 $\\int_0^t \\phi'(X_s) dM_s$。因此，$Y$ 的二次变差是其鞅部分的二次变差：\n$$\n\\langle Y \\rangle_t = \\left\\langle \\int_0^\\cdot \\phi'(X_s) dM_s \\right\\rangle_t = \\int_0^t (\\phi'(X_s))^2 d\\langle M \\rangle_s\n$$\n由于 $\\langle M \\rangle_s = \\langle X \\rangle_s$，我们有：\n$$\nd\\langle Y \\rangle_s = (\\phi'(X_s))^2 d\\langle X \\rangle_s\n$$\n问题中给出了逗留时密度恒等式，它对任何连续半鞅都成立。对于过程 $Y$ 和任意有界 Borel 函数 $g:\\mathbb{R} \\to \\mathbb{R}$，该恒等式为：\n$$\n\\int_0^t g(Y_s) d\\langle Y \\rangle_s = \\int_{\\mathbb{R}} g(b) L_t^b(Y) db\n$$\n我们可以将 $d\\langle Y \\rangle_s$ 的表达式代入该等式的左边。我们同时代入 $Y_s = \\phi(X_s)$：\n$$\n\\text{LHS} = \\int_0^t g(\\phi(X_s)) (\\phi'(X_s))^2 d\\langle X \\rangle_s\n$$\n现在这个表达式是关于 $X$ 的二次变差的积分。我们可以将过程 $X$ 的逗留时密度恒等式应用于此积分。$X$ 的恒等式表明，对于任意有界 Borel 函数 $f$：\n$$\n\\int_0^t f(X_s) d\\langle X \\rangle_s = \\int_{\\mathbb{R}} f(a) L_t^a(X) da\n$$\n我们通过令 $f(x) = g(\\phi(x)) (\\phi'(x))^2$ 来应用此恒等式。函数 $f$ 是一个有界 Borel 函数，因为 $g$ 是有界的，且 $\\phi$ 和 $\\phi'$ 是连续的（并且 $\\phi'$ 在任何紧集上是有界的，但该论证更具一般性）。因此，我们有：\n$$\n\\int_0^t g(\\phi(X_s)) (\\phi'(X_s))^2 d\\langle X \\rangle_s = \\int_{\\mathbb{R}} g(\\phi(a)) (\\phi'(a))^2 L_t^a(X) da\n$$\n通过结合这些恒等式，我们建立了以下等式：\n$$\n\\int_{\\mathbb{R}} g(b) L_t^b(Y) db = \\int_{\\mathbb{R}} g(\\phi(a)) (\\phi'(a))^2 L_t^a(X) da\n$$\n为了找到 $L_t^b(Y)$ 和 $L_t^a(X)$ 之间的关系，我们在右边的积分中进行变量代换。令 $b = \\phi(a)$。由于 $\\phi$ 是从 $\\mathbb{R}$ 到 $\\mathbb{R}$ 的一个 $C^2$-微分同胚，其逆映射 $\\phi^{-1}$ 存在，也是一个微分同胚，且其定义域为 $\\mathbb{R}$。变量代换为 $a = \\phi^{-1}(b)$，微分元 $da$ 通过变换 $a = \\phi^{-1}(b)$ 的雅可比行列式的绝对值与 $db$ 相关联。\n导数为 $\\frac{da}{db} = (\\phi^{-1})'(b)$。根据反函数定理，$(\\phi^{-1})'(b) = \\frac{1}{\\phi'(\\phi^{-1}(b))}$。\n积分的变量代换公式表明 $da = \\left|(\\phi^{-1})'(b)\\right| db$。因此：\n$$\nda = \\left| \\frac{1}{\\phi'(\\phi^{-1}(b))} \\right| db = \\frac{1}{|\\phi'(\\phi^{-1}(b))|} db\n$$\n条件 $\\inf_{x\\in\\mathbb{R}}|\\phi'(x)| > 0$ 确保了分母不为零。\n将 $a = \\phi^{-1}(b)$ 和 $da$ 的表达式代入右边的积分中：\n$$\n\\int_{\\mathbb{R}} g(b) \\left(\\phi'(\\phi^{-1}(b))\\right)^2 L_t^{\\phi^{-1}(b)}(X) \\frac{1}{|\\phi'(\\phi^{-1}(b))|} db\n$$\n我们可以简化乘以测试函数 $g(b)$ 的项：\n$$\n\\frac{(\\phi'(\\phi^{-1}(b)))^2}{|\\phi'(\\phi^{-1}(b))|} = \\frac{|\\phi'(\\phi^{-1}(b))|^2}{|\\phi'(\\phi^{-1}(b))|} = |\\phi'(\\phi^{-1}(b))|\n$$\n所以右边变为：\n$$\n\\int_{\\mathbb{R}} g(b) |\\phi'(\\phi^{-1}(b))| L_t^{\\phi^{-1}(b)}(X) db\n$$\n我们现在得到最终的等式：\n$$\n\\int_{\\mathbb{R}} g(b) L_t^b(Y) db = \\int_{\\mathbb{R}} g(b) |\\phi'(\\phi^{-1}(b))| L_t^{\\phi^{-1}(b)}(X) db\n$$\n此恒等式必须对每个有界 Borel 函数 $g$ 成立。根据测度论中的一个标准结果，这意味着对于关于勒贝格测度的几乎所有 $b \\in \\mathbb{R}$，被积函数必须相等。即：\n$$\nL_t^b(Y) = |\\phi'(\\phi^{-1}(b))| L_t^{\\phi^{-1}(b)}(X) \\quad \\text{for a.e. } b \\in \\mathbb{R}\n$$\n对于一个连续半鞅，局部时 $L_t^a(X)$ 是空间变量 $a$ 的一个连续函数。因此，等式右边 $|\\phi'(\\phi^{-1}(b))| L_t^{\\phi^{-1}(b)}(X)$ 是 $b$ 的一个连续函数。这是因为 $\\phi^{-1}$ 是连续的（因为 $\\phi$ 是一个微分同胚），$\\phi'$ 是连续的，且 $L_t^\\cdot(X)$ 是连续的。连续函数的复合、乘积和绝对值运算结果仍然是连续的。等式左边 $L_t^b(Y)$ 也是 $b$ 的连续函数。如果两个连续函数几乎处处相等，那么它们必定处处相等。\n因此，该等式对所有 $b \\in \\mathbb{R}$ 成立。", "answer": "$$\n\\boxed{|\\phi'(\\phi^{-1}(b))| L_t^{\\phi^{-1}(b)}(X)}\n$$", "id": "2999551"}, {"introduction": "局部时不仅是一个描述路径行为的概率工具，它在分析学中也扮演着深刻的角色。本练习通过一个经典的费曼-卡茨 (Feynman-Kac) 问题，探讨局部时的指数泛函 $\\mathbb{E}_x[\\exp(-\\theta L_t^a(B))]$ 所满足的偏微分方程。通过推导该期望值在特定点 $x=a$ 处所满足的界面条件，你将亲身体会到局部时是如何量化一个过程“穿越”某个点的“成本”的，并加深对随机过程与偏微分方程之间内在联系的理解 [@problem_id:2999549]。", "problem": "设 $B=(B_t)_{t \\geq 0}$ 是一个一维标准布朗运动，在概率测度 $\\mathbb{P}_x$ 下从 $x \\in \\mathbb{R}$ 出发，并令 $L_t^a(B)$ 表示其在水平 $a \\in \\mathbb{R}$ 处的半鞅局部时。对于一个固定的参数 $\\theta > 0$，定义\n$$\nu(t,x) := \\mathbb{E}_x\\!\\left[\\exp\\!\\big(-\\theta\\, L_t^a(B)\\big)\\right], \\quad t \\geq 0,\\ x \\in \\mathbb{R}.\n$$\n请建立 $u(t,x)$ 在偏微分方程意义下对于 $t>0$ 和 $x \\in \\mathbb{R}$ 所满足的边值问题，具体说明在 $x=a$ 之外的控制方程、在 $t=0$ 处的初始条件、在 $x=a$ 处的连续性性质，以及在 $x=a$ 处施加的、用以体现局部时指数泛函效应的边界/界面条件。你的公式应从随机分析的第一性原理出发，基于布朗运动、半鞅局部时的定义，以及诸如 Itô 积分和针对凸函数的 Tanaka 公式等标准工具进行推导。\n\n为了使问题能用单个表达式回答，请将 $x=a$ 处的边界/界面条件写成如下形式\n$$\nu_x(t,a^{+}) - u_x(t,a^{-}) \\;=\\; C\\, u(t,a),\n$$\n其中 $C$ 是一个仅依赖于 $\\theta$ 的常数。请给出 $C$ 的解析表达式作为你的最终答案。无需四舍五入，不涉及单位。最终答案必须是单个闭式表达式。", "solution": "用户希望找到函数 $u(t,x) := \\mathbb{E}_x[\\exp(-\\theta L_t^a(B))]$ 的边界/界面条件 $u_x(t,a^{+}) - u_x(t,a^{-}) = C u(t,a)$ 中的常数 $C$。\n\n首先，我们验证问题陈述的有效性。\n该问题在随机分析的数学领域内是良定义的。所有术语都是标准的：$B_t$ 是一维标准布朗运动，$L_t^a(B)$ 是其在水平 $a$ 处的半鞅局部时，而 $\\mathbb{E}_x$ 是过程从 $x$ 出发的期望算子。函数 $u(t,x)$ 是一个 Feynman-Kac 型泛函。任务是推导 $u(t,x)$ 满足的边值问题，这是随机微分方程理论中的一个标准程序。该问题具有科学依据，是适定的、客观的且自洽的。因此，该问题是有效的。\n\n我们从第一性原理开始推导该边值问题。\n\n起点是 $u(t,x)$ 的定义：\n$$\nu(t,x) = \\mathbb{E}_x\\left[\\exp\\big(-\\theta\\, L_t^a(B)\\big)\\right]\n$$\n半鞅局部时 $L_t^a(B)$ 由凸函数 $f(y) = |y-a|$ 的 Tanaka 公式定义：\n$$\n|B_t - a| - |B_0 - a| = \\int_0^t \\text{sgn}(B_s - a) dB_s + L_t^a(B)\n$$\n其中 $\\text{sgn}(y)$ 是符号函数，我们可以定义为：若 $y > 0$ 则为 $1$，若 $y < 0$ 则为 $-1$，若 $y=0$ 则为 $0$。在 $0$ 处的值不影响随机积分，因为布朗运动在任何单一点上花费的时间为零。\n根据 Tanaka 公式，我们可以将局部时表示为：\n$$\nL_t^a(B) = |B_t - a| - |x - a| - \\int_0^t \\text{sgn}(B_s - a) dB_s\n$$\n因为 $B_0=x$。将此代入 $u(t,x)$ 的定义中：\n$$\nu(t,x) = \\mathbb{E}_x\\left[ \\exp\\left(-\\theta \\left( |B_t - a| - |x - a| - \\int_0^t \\text{sgn}(B_s - a) dB_s \\right) \\right) \\right]\n$$\n我们可以重新整理这些项：\n$$\nu(t,x) = \\exp(\\theta|x-a|) \\mathbb{E}_x\\left[ \\exp(-\\theta|B_t - a|) \\exp\\left(\\theta \\int_0^t \\text{sgn}(B_s - a) dB_s\\right) \\right]\n$$\n项 $\\exp(\\theta \\int_0^t \\text{sgn}(B_s - a) dB_s)$ 提示我们使用 Girsanov 定理进行测度变换。设 $M_t = \\theta \\int_0^t \\text{sgn}(B_s - a) dB_s$。此鞅的二次变差为 $\\langle M \\rangle_t = \\int_0^t \\theta^2 \\text{sgn}(B_s - a)^2 ds = \\theta^2 t$，因为对于 $y \\neq 0$ 有 $\\text{sgn}(y)^2 = 1$，并且时间集合 $\\{s: B_s=a\\}$ 几乎必然地具有零勒贝格测度。\n\nDoléans-Dade 指数是 $\\mathcal{E}(M)_t = \\exp(M_t - \\frac{1}{2}\\langle M \\rangle_t) = \\exp(\\theta \\int_0^t \\text{sgn}(B_s - a) dB_s - \\frac{1}{2}\\theta^2 t)$。这是一个 $\\mathbb{P}_x$-鞅。我们通过 Radon-Nikodym 导数 $\\frac{d\\mathbb{Q}_x}{d\\mathbb{P}_x}\\big|_{\\mathcal{F}_t} = \\mathcal{E}(M)_t$ 在 $\\mathcal{F}_t$ 上定义一个新的概率测度 $\\mathbb{Q}_x$。\n\n根据 Girsanov 定理，在新的测度 $\\mathbb{Q}_x$ 下，过程 $\\tilde{B}_t = B_t - \\langle B, M \\rangle_t = B_t - \\theta \\int_0^t \\text{sgn}(B_s - a) ds$ 是一个标准布朗运动。这意味着在 $\\mathbb{Q}_x$ 下，过程 $B_t$ 遵循以下随机微分方程：\n$$\ndB_t = \\theta \\text{sgn}(B_t - a) ds + d\\tilde{B}_s\n$$\n其中 $\\tilde{B}_s$ 是一个 $\\mathbb{Q}_x$-布朗运动。利用测度变换重写 $u(t,x)$ 的期望：\n$$\n\\exp\\left(\\theta \\int_0^t \\text{sgn}(B_s - a) dB_s\\right) = \\mathcal{E}(M)_t \\exp\\left(\\frac{1}{2}\\theta^2 t\\right)\n$$\n$$\nu(t,x) = \\exp(\\theta|x-a| + \\frac{1}{2}\\theta^2 t) \\mathbb{E}_x\\left[ \\exp(-\\theta|B_t - a|) \\mathcal{E}(M)_t \\right]\n$$\n使用测度 $\\mathbb{Q}_x$ 的定义，这变为：\n$$\nu(t,x) = \\exp(\\theta|x-a| + \\frac{1}{2}\\theta^2 t) \\mathbb{E}_{\\mathbb{Q}_x}\\left[ \\exp(-\\theta|B_t - a|) \\right]\n$$\n让我们在这个新的概率空间上定义一个新函数 $v(t,y)$：\n$$\nv(t,y) := \\mathbb{E}_{\\mathbb{Q}_y}\\left[ \\exp(-\\theta|Y_t|) \\right]\n$$\n其中在 $\\mathbb{Q}_y$ 下，过程 $Y_t$ 从 $Y_0=y$ 开始，并根据 $dY_s = \\theta \\text{sgn}(Y_s) ds + d\\tilde{B}_s$ 演化。\n根据这个定义，令 $y=x-a$，我们得到 $u(t,x) = \\exp(\\theta|x-a| + \\frac{1}{2}\\theta^2 t) v(t, x-a)$。\n\n函数 $v(t,y)$ 满足与过程 $Y_t$ 和终端支付函数 $f(y) = \\exp(-\\theta|y|)$ 相关的 Kolmogorov 向后方程。在我们的情况下，这对应于偏微分方程 $v_t = \\mathcal{L}_Y v$，其中 $\\mathcal{L}_Y$ 是过程 $Y_t$ 的生成元。对于 $y \\neq 0$：\n$$\n\\mathcal{L}_Y = \\theta \\text{sgn}(y) \\frac{\\partial}{\\partial y} + \\frac{1}{2} \\frac{\\partial^2}{\\partial y^2}\n$$\n因此，对于 $y \\neq 0$，$v(t,y)$ 满足 $v_t = \\theta \\text{sgn}(y) v_y + \\frac{1}{2} v_{yy}$。\n过程 $Y_t$ 是 $\\mathbb{R}$ 上的一个扩散过程。对于一个函数，要使其在其生成元的定义域内，它必须在 $y=0$ 处满足一定的正则性条件。对于这个特定过程，即一个带分段常数漂移的布朗运动，$\\mathcal{L}_Y$ 定义域中的函数 $f$ 必须使得 $f$ 及其一阶导数 $f'$ 在 $y=0$ 处是连续的。因此，对于 $t>0$，$v(t,\\cdot)$ 和 $v_y(t,\\cdot)$ 是连续的。\n\n现在我们利用 $u(t,x)$ 与 $v(t, y)$ 的关系来分析其性质。令 $y=x-a$。\n对于 $x>a$，我们有 $y>0$，所以 $|x-a|=x-a$ 且 $\\text{sgn}(y)=1$。\n$u(t,x) = \\exp(\\theta(x-a) + \\frac{1}{2}\\theta^2 t) v(t, y)$。\n$u_x = \\theta u + u \\frac{v_y}{v}$。我们直接进行微分。\n$u_x = \\theta \\exp(\\dots) v(t, y) + \\exp(\\dots) v_y(t, y)$。\n$u_{xx} = \\theta^2 \\exp(\\dots) v + 2\\theta \\exp(\\dots) v_y + \\exp(\\dots) v_{yy}$。\n$u_t = \\frac{1}{2}\\theta^2 u + \\exp(\\theta(x-a) + \\frac{1}{2}\\theta^2 t) v_t$。\n使用 $v_t = \\theta v_y + \\frac{1}{2}v_{yy}$ 对于 $y>0$：\n$u_t = \\exp(\\dots)[\\frac{1}{2}\\theta^2 v + \\theta v_y + \\frac{1}{2} v_{yy}]$。\n与 $u_{xx}$ 比较：\n$\\frac{1}{2} u_{xx} = \\exp(\\dots)[\\frac{1}{2}\\theta^2 v + \\theta v_y + \\frac{1}{2} v_{yy}] = u_t$。\n这证实了对于 $x>a$ 有 $u_t = \\frac{1}{2}u_{xx}$。对于 $x<a$（此时 $|x-a|=-(x-a)$ 且 $\\text{sgn}(y)=-1$）的类似计算也得出 $u_t = \\frac{1}{2}u_{xx}$。\n\n接下来，我们求导数 $u_x$ 在 $x=a$ 处的跳跃条件。\n$u_x(t,a^+) = \\lim_{x\\to a^+} u_x(t,x) = \\lim_{y\\to 0^+} \\left[ \\theta \\exp(\\theta y + \\frac{1}{2}\\theta^2 t) v(t, y) + \\exp(\\theta y + \\frac{1}{2}\\theta^2 t) v_y(t, y) \\right]$。\n由于 $v$ 和 $v_y$ 在 $y=0$ 处是连续的：\n$u_x(t,a^+) = \\exp(\\frac{1}{2}\\theta^2 t) \\left( \\theta v(t,0) + v_y(t,0) \\right)$。\n\n对于 $x<a$，我们有 $|x-a| = -(x-a) = a-x$。\n$u(t,x) = \\exp(\\theta(a-x) + \\frac{1}{2}\\theta^2 t) v(t, y)$。\n$u_x = -\\theta \\exp(\\dots) v(t,y) + \\exp(\\dots) v_y(t,y)$。\n$u_x(t,a^-) = \\lim_{x\\to a^-} u_x(t,x) = \\lim_{y\\to 0^-} \\left[ -\\theta \\exp(-\\theta y + \\frac{1}{2}\\theta^2 t) v(t, y) + \\exp(-\\theta y + \\frac{1}{2}\\theta^2 t) v_y(t, y) \\right]$。\n$u_x(t,a^-) = \\exp(\\frac{1}{2}\\theta^2 t) \\left( -\\theta v(t,0) + v_y(t,0) \\right)$。\n\n现在我们计算差值：\n$$\nu_x(t,a^+) - u_x(t,a^-) = \\exp(\\frac{1}{2}\\theta^2 t) \\left[ (\\theta v(t,0) + v_y(t,0)) - (-\\theta v(t,0) + v_y(t,0)) \\right]\n$$\n$$\nu_x(t,a^+) - u_x(t,a^-) = \\exp(\\frac{1}{2}\\theta^2 t) (2\\theta v(t,0))\n$$\n函数 $u(t,x)$ 在 $x=a$ 处是连续的。在 $x=a$ 时（即 $y=0$）：\n$$\nu(t,a) = \\exp(\\theta|a-a| + \\frac{1}{2}\\theta^2 t) v(t, 0) = \\exp(\\frac{1}{2}\\theta^2 t) v(t,0)\n$$\n将此代入我们关于导数跳跃的表达式中：\n$$\nu_x(t,a^+) - u_x(t,a^-) = 2\\theta u(t,a)\n$$\n这与问题中给出的形式 $u_x(t,a^{+}) - u_x(t,a^{-}) = C u(t,a)$ 相匹配。通过比较，我们确定常数 $C$。\n$$\nC = 2\\theta\n$$\n\n$u(t,x)$ 满足的完整边值问题是：\n1.  偏微分方程：$\\frac{\\partial u}{\\partial t} = \\frac{1}{2} \\frac{\\partial^2 u}{\\partial x^2}$ 对于 $x \\in \\mathbb{R} \\setminus \\{a\\}$。\n2.  初始条件：$u(0,x) = 1$ 对于所有 $x \\in \\mathbb{R}$。\n3.  连续性条件：$u(t,a^-) = u(t,a^+)$ 对于 $t > 0$。\n4.  界面条件：$\\frac{\\partial u}{\\partial x}(t,a^+) - \\frac{\\partial u}{\\partial x}(t,a^-) = 2\\theta u(t,a)$ 对于 $t > 0$。\n\n问题要求的是常数 $C$。", "answer": "$$\n\\boxed{2\\theta}\n$$", "id": "2999549"}]}