{"hands_on_practices": [{"introduction": "在研究任何动力系统时，一个基本问题是其长期行为。本练习将引导你计算在突变和遗传漂变共同作用下等位基因频率的稳态分布。通过求解稳态Fokker-Planck方程并应用零通量边界条件，你将推导出一个在群体遗传学中至关重要的著名概率分布。[@problem_id:2981156]", "problem": "考虑一个一维类型空间上相互作用粒子系统的中性 Fleming–Viot 极限，其中经验类型频率收敛于等位基因频率的一维扩散。令 $X_{t} \\in [0,1]$ 表示在时间 $t$ 某一特定类型的频率。假设为中性重抽样（无选择）和亲代无关的线性突变，突变趋向于基准平均类型水平 $\\mu \\in (0,1)$，总突变强度为 $\\theta>0$。其宏观极限是一个一维扩散，其生成元为\n$$\n\\mathcal{L} f(x) \\;=\\; \\frac{1}{2}\\,x(1-x)\\,f''(x) \\;+\\; \\frac{\\theta}{2}\\,(\\mu - x)\\,f'(x),\n$$\n作用于 $[0,1]$ 上二次连续可微的检验函数 $f$。该过程受限于 $x=0$ 和 $x=1$ 处的反射边界，即稳态概率流在端点处为零。\n\n仅使用一维扩散的 Kolmogorov 前向方程（也称为 Fokker–Planck 方程）的基本定义，以及解释为边界处概率通量为零的反射边界条件，计算 $X_{t}$ 在 $[0,1]$ 上的不变概率密度 $\\pi(x)$。请用一个关于 $x$、$\\theta$ 和 $\\mu$ 的单一闭式解析表达式来表示你的最终答案。不需要数值近似。", "solution": "首先将对问题的科学合理性、良构性和客观性进行验证。\n\n### 步骤 1：提取已知条件\n\n-   **过程**：一个相互作用粒子系统的中性 Fleming-Viot 极限。\n-   **类型空间**：一维空间。\n-   **状态变量**：$X_{t} \\in [0,1]$ 是在时间 $t$ 某一特定类型的频率。\n-   **动力学假设**：中性重抽样（无选择）和亲代无关的线性突变。\n-   **突变参数**：基准平均类型水平为 $\\mu \\in (0,1)$，总突变强度为 $\\theta > 0$。\n-   **扩散生成元**：宏观极限是一个一维扩散，其生成元 $\\mathcal{L}$ 作用于 $[0,1]$ 上的二次连续可微检验函数 $f$：\n    $$\n    \\mathcal{L} f(x) \\;=\\; \\frac{1}{2}\\,x(1-x)\\,f''(x) \\;+\\; \\frac{\\theta}{2}\\,(\\mu - x)\\,f'(x)\n    $$\n-   **边界条件**：该过程在 $x=0$ 和 $x=1$ 处有反射边界，这被解释为稳态概率流在端点处为零。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题描述的是带有突变的 Wright-Fisher 扩散模型，这是群体遗传学和概率论中一个被广泛研究的典型过程。生成元 $\\mathcal{L}$ 是该扩散的标准生成元。不变测度、Fokker-Planck 方程和反射边界等概念在随机过程理论中都有基本且严格的定义。该问题牢固地植根于已建立的数学和科学原理。\n-   **良构性**：任务是为一个在紧区间上具有指定边界条件的给定扩散找到唯一的稳态概率密度。生成元定义良好，参数 $\\theta > 0$ 和 $\\mu \\in (0,1)$ 处于其标准有效范围内，确保了解的非退化性。该问题的结构决定了其拥有唯一、稳定且有意义的解。\n-   **客观性**：该问题使用精确、形式化的数学语言陈述。它不包含任何主观论断、歧义或非技术性术语。\n\n### 步骤 3：结论与行动\n\n该问题具有科学合理性、良构性、客观性和自洽性。因此，它被判定为 **有效**。将按要求从第一性原理推导求解。\n\n不变（或稳态）概率密度，记为 $\\pi(x)$，是 Kolmogorov 前向方程（也称为 Fokker-Planck 方程）的时不变解。对于一个漂移系数为 $a(x)$、扩散系数为 $b(x)$ 的一维扩散过程 $X_t$，其概率密度 $p(x,t)$ 的 Fokker-Planck 方程为\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left[ a(x) p(x,t) \\right] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} \\left[ b(x) p(x,t) \\right].\n$$\n扩散的生成元通过 $\\mathcal{L}f(x) = a(x)f'(x) + \\frac{1}{2}b(x)f''(x)$ 与这些系数相关。通过将此一般形式与给定的生成元进行比较，\n$$\n\\mathcal{L} f(x) = \\frac{\\theta}{2}(\\mu - x) f'(x) + \\frac{1}{2}x(1-x) f''(x),\n$$\n我们确定过程 $X_t$ 的漂移系数和扩散系数：\n-   漂移系数：$a(x) = \\frac{\\theta}{2}(\\mu-x)$\n-   扩散系数：$b(x) = x(1-x)$\n\n稳态密度 $\\pi(x)$ 由条件 $\\frac{\\partial \\pi(x)}{\\partial t} = 0$ 定义。因此，稳态 Fokker-Planck 方程为\n$$\n0 = -\\frac{d}{dx} \\left[ a(x) \\pi(x) \\right] + \\frac{1}{2}\\frac{d^2}{dx^2} \\left[ b(x) \\pi(x) \\right].\n$$\n对该方程关于 $x$ 积分，得到\n$$\n\\text{常数} = -a(x) \\pi(x) + \\frac{1}{2}\\frac{d}{dx} \\left[ b(x) \\pi(x) \\right].\n$$\n右侧是概率流（或通量）$J(x) = a(x)\\pi(x) - \\frac{1}{2}\\frac{d}{dx}[b(x)\\pi(x)]$ 的负值。因此，稳态方程意味着概率通量 $J(x)$ 对于所有 $x \\in [0,1]$ 必须是一个常数。\n\n问题指定了反射边界，这意味着没有净概率质量流过边界。这通过在端点处将概率通量设置为零来实现：$J(0) = 0$ 和 $J(1)=0$。由于 $J(x)$ 必须是常数，因此对于所有 $x \\in [0,1]$，必然有 $J(x)=0$。\n\n因此，我们必须求解以下一阶常微分方程：\n$$\na(x)\\pi(x) - \\frac{1}{2}\\frac{d}{dx}[b(x)\\pi(x)] = 0.\n$$\n代入 $a(x)$ 和 $b(x)$ 的表达式：\n$$\n\\frac{\\theta}{2}(\\mu-x)\\pi(x) - \\frac{1}{2}\\frac{d}{dx}[x(1-x)\\pi(x)] = 0.\n$$\n乘以 $2$ 并重新整理得到\n$$\n\\frac{d}{dx}[x(1-x)\\pi(x)] = \\theta(\\mu-x)\\pi(x).\n$$\n对左侧应用乘法法则：\n$$\nx(1-x)\\pi'(x) + (1-2x)\\pi(x) = \\theta(\\mu-x)\\pi(x).\n$$\n这是一个可分离变量的微分方程。我们收集包含 $\\pi(x)$ 的项：\n$$\nx(1-x)\\pi'(x) = [\\theta(\\mu-x) - (1-2x)]\\pi(x)\n$$\n$$\nx(1-x)\\pi'(x) = (\\theta\\mu - 1 + (2-\\theta)x)\\pi(x).\n$$\n分离变量 $\\pi$ 和 $x$：\n$$\n\\frac{\\pi'(x)}{\\pi(x)} = \\frac{\\theta\\mu - 1 + (2-\\theta)x}{x(1-x)}.\n$$\n为对右侧进行积分，我们使用部分分式分解：\n$$\n\\frac{\\theta\\mu - 1 + (2-\\theta)x}{x(1-x)} = \\frac{A}{x} + \\frac{B}{1-x}.\n$$\n求解 $A$ 和 $B$：\n-   $A = \\left.\\frac{\\theta\\mu - 1 + (2-\\theta)x}{1-x}\\right|_{x=0} = \\theta\\mu - 1$.\n-   $B = \\left.\\frac{\\theta\\mu - 1 + (2-\\theta)x}{x}\\right|_{x=1} = \\theta\\mu - 1 + 2 - \\theta = \\theta(1-\\mu) - 1$.\n\n代回并对两边积分：\n$$\n\\int \\frac{d\\pi}{\\pi} = \\int \\left( \\frac{\\theta\\mu - 1}{x} + \\frac{\\theta(1-\\mu) - 1}{1-x} \\right) dx.\n$$\n$$\n\\ln(\\pi(x)) = (\\theta\\mu - 1)\\ln(x) - (\\theta(1-\\mu) - 1)\\ln(1-x) + C_1,\n$$\n其中 $C_1$ 是积分常数。对于 $x \\in (0,1)$，对数的参数为正。\n对两边取指数：\n$$\n\\pi(x) = \\exp(C_1) \\cdot \\exp((\\theta\\mu - 1)\\ln(x)) \\cdot \\exp(-(\\theta(1-\\mu) - 1)\\ln(1-x))\n$$\n$$\n\\pi(x) = C \\cdot x^{\\theta\\mu-1} (1-x)^{\\theta(1-\\mu)-1},\n$$\n其中 $C = \\exp(C_1)$ 是一个归一化常数。\n\n常数 $C$ 由以下条件确定：$\\pi(x)$ 必须是概率密度，因此其在状态空间 $[0,1]$ 上的积分必须等于 $1$：\n$$\n\\int_0^1 \\pi(x) dx = \\int_0^1 C \\cdot x^{\\theta\\mu-1} (1-x)^{\\theta(1-\\mu)-1} dx = 1.\n$$\n该积分是 Beta 函数的定义，$B(\\alpha, \\beta) = \\int_0^1 t^{\\alpha-1}(1-t)^{\\beta-1} dt$，参数为 $\\alpha = \\theta\\mu$ 和 $\\beta = \\theta(1-\\mu)$。\n因此，\n$$\nC \\cdot B(\\theta\\mu, \\theta(1-\\mu)) = 1.\n$$\nBeta 函数通过 $B(\\alpha, \\beta) = \\frac{\\Gamma(\\alpha)\\Gamma(\\beta)}{\\Gamma(\\alpha+\\beta)}$ 与 Gamma 函数 $\\Gamma(z)$ 相关。在我们的例子中，$\\alpha+\\beta = \\theta\\mu + \\theta(1-\\mu) = \\theta$。\n所以，\n$$\nC \\cdot \\frac{\\Gamma(\\theta\\mu)\\Gamma(\\theta(1-\\mu))}{\\Gamma(\\theta)} = 1.\n$$\n求解 $C$：\n$$\nC = \\frac{\\Gamma(\\theta)}{\\Gamma(\\theta\\mu)\\Gamma(\\theta(1-\\mu))}.\n$$\n将此归一化常数代回 $\\pi(x)$ 的表达式，我们得到不变概率密度的最终形式：\n$$\n\\pi(x) = \\frac{\\Gamma(\\theta)}{\\Gamma(\\theta\\mu)\\Gamma(\\theta(1-\\mu))} x^{\\theta\\mu - 1} (1-x)^{\\theta(1-\\mu) - 1}.\n$$\n这是形状参数为 $\\alpha = \\theta\\mu$ 和 $\\beta = \\theta(1-\\mu)$ 的 Beta 分布的概率密度函数。", "answer": "$$\n\\boxed{\\frac{\\Gamma(\\theta)}{\\Gamma(\\theta\\mu)\\Gamma(\\theta(1-\\mu))} x^{\\theta\\mu - 1} (1-x)^{\\theta(1-\\mu) - 1}}\n$$", "id": "2981156"}, {"introduction": "除了系统的最终平衡状态，理解其动态演化过程也同样重要。本练习的核心是从Fleming-Viot过程的生成元出发，推导各阶矩（如均值和方差）随时间演化的微分方程。这项实践将帮助你掌握使用Dynkin公式分析过程统计特性的关键技巧，并将一个复杂的随机过程问题转化为一个可解的常微分方程组。[@problem_id:2981187]", "problem": "考虑一个有限类型空间 $\\mathcal{E}=\\{1,2,\\dots,K\\}$ 以及在 $\\mathcal{E}$ 上的 Fleming–Viot (FV) 测度值扩散 $\\{\\mu_t\\}_{t\\ge 0}$，该过程具有亲代独立突变和重抽样。亲代独立突变以速率 $u>0$ 朝向一个固定的概率向量 $\\pi=(\\pi_1,\\dots,\\pi_K)$ 作用，重抽样（遗传漂变）以速率 $\\gamma>0$ 作用。FV 过程的生成元 $\\mathcal{G}$ 作用于由有界检验函数 $f_r:\\mathcal{E}\\to\\mathbb{R}$ 构成的泛函多项式类 $F(\\mu)=\\prod_{r=1}^{m}\\langle \\mu,f_r\\rangle$，其作用方式如下：\n$$\n\\mathcal{G}F(\\mu)\n=\n\\sum_{r=1}^{m}\\langle \\mu, B f_r\\rangle \\prod_{\\substack{s=1\\\\ s\\neq r}}^{m}\\langle \\mu,f_s\\rangle\n+\n\\gamma \\sum_{1\\le r< s\\le m}\\left(\\langle \\mu,f_r f_s\\rangle-\\langle \\mu,f_r\\rangle\\langle \\mu,f_s\\rangle\\right)\\prod_{\\substack{q=1\\\\ q\\neq r,s}}^{m}\\langle \\mu,f_q\\rangle,\n$$\n其中突变算子 $B$ 由 $Bf(i)=u\\left(\\sum_{j=1}^{K}\\pi_j f(j)-f(i)\\right)$ 给出，对于 $i\\in\\mathcal{E}$。\n\n从生成元和 FV 过程的定义出发，完成以下任务：\n\n1. 推导形式为 $M_{f_1,\\dots,f_m}(t)=\\mathbb{E}\\left[\\prod_{r=1}^{m}\\langle \\mu_t,f_r\\rangle\\right]$ 的混合矩的递推关系。\n\n2. 将您的递推关系特化为单类型混合矩，即针对一个选取单个类型 $i^\\star\\in\\mathcal{E}$ 的固定指示函数 $\\phi:\\mathcal{E}\\to\\{0,1\\}$，即 $\\phi(i)=\\mathbf{1}_{\\{i=i^\\star\\}}$。对于 $k\\in\\mathbb{N}$，定义 $m_k(t)=\\mathbb{E}\\left[\\langle \\mu_t,\\phi\\rangle^k\\right]$ 并推导 $\\{m_k(t)\\}_{k\\ge 1}$ 的闭式递推关系。\n\n3. 在双类型情形 $\\mathcal{E}=\\{1,2\\}$ 下，显式求解该递推关系。其中亲代独立突变朝向 $\\pi=(\\theta,1-\\theta)$（对于某个固定的 $\\theta\\in(0,1)$），重抽样速率为 $\\gamma>0$，初始条件为 $\\langle \\mu_0,\\phi\\rangle=p\\in[0,1]$。提供一个关于 $m_2(t)=\\mathbb{E}\\left[\\langle \\mu_t,\\phi\\rangle^2\\right]$ 的闭式解析表达式，用 $t$、$p$、$\\gamma$、$u$ 和 $\\theta$ 表示。\n\n您的最终答案必须是单个闭式表达式。无需四舍五入。", "solution": "该问题是适定的，并且在随机过程理论，特别是关于 Fleming-Viot 测度值扩散方面，有坚实的科学基础。我们可以按要求进行逐步推导。\n\nFleming-Viot 过程 $\\mu_t$ 的一个泛函 $F$ 的期望值的演化由 Dynkin 公式决定：\n$$\n\\frac{d}{dt}\\mathbb{E}[F(\\mu_t)] = \\mathbb{E}[\\mathcal{G}F(\\mu_t)],\n$$\n其中 $\\mathcal{G}$ 是该过程的生成元。\n\n**1. 混合矩递推关系的推导**\n\n令 $F(\\mu) = \\prod_{r=1}^{m}\\langle \\mu,f_r\\rangle$，其中 $\\langle \\mu, f \\rangle = \\sum_{i \\in \\mathcal{E}} f(i) \\mu(\\{i\\})$。混合矩定义为 $M_{f_1,\\dots,f_m}(t) = \\mathbb{E}[F(\\mu_t)]$。\n应用 Dynkin 公式，我们有：\n$$\n\\frac{d}{dt}M_{f_1,\\dots,f_m}(t) = \\mathbb{E}\\left[\\mathcal{G}\\left(\\prod_{r=1}^{m}\\langle \\mu_t,f_r\\rangle\\right)\\right]。\n$$\n使用所给的生成元 $\\mathcal{G}$：\n$$\n\\mathcal{G}F(\\mu_t) = \\sum_{r=1}^{m}\\langle \\mu_t, B f_r\\rangle \\prod_{\\substack{s=1\\\\ s\\neq r}}^{m}\\langle \\mu_t,f_s\\rangle + \\gamma \\sum_{1\\le r< s\\le m}\\left(\\langle \\mu_t,f_r f_s\\rangle-\\langle \\mu_t,f_r\\rangle\\langle \\mu_t,f_s\\rangle\\right)\\prod_{\\substack{q=1\\\\ q\\neq r,s}}^{m}\\langle \\mu_t,f_q\\rangle.\n$$\n我们对 $\\mathcal{G}F(\\mu_t)$ 取期望。我们来分析每一项。\n\n第一项涉及突变算子 $Bf(i)=u\\left(\\sum_{j=1}^{K}\\pi_j f(j)-f(i)\\right)$。我们可以将 $\\langle \\mu_t, B f_r \\rangle$ 写为：\n$$\n\\langle \\mu_t, B f_r \\rangle = \\sum_{i=1}^K (B f_r)(i) \\mu_t(\\{i\\}) = u \\sum_{i=1}^K \\left( \\langle \\pi, f_r \\rangle - f_r(i) \\right) \\mu_t(\\{i\\}) = u(\\langle \\pi, f_r \\rangle \\langle \\mu_t, \\mathbf{1} \\rangle - \\langle \\mu_t, f_r \\rangle).\n$$\n由于 $\\mu_t$ 是一个概率测度，$\\langle \\mu_t, \\mathbf{1} \\rangle = 1$。因此，$\\langle \\mu_t, B f_r \\rangle = u(\\langle \\pi, f_r \\rangle - \\langle \\mu_t, f_r \\rangle)$。\n生成元突变部分的期望为：\n$$\n\\mathbb{E}\\left[ \\sum_{r=1}^{m} u(\\langle \\pi, f_r \\rangle - \\langle \\mu_t, f_r \\rangle) \\prod_{\\substack{s=1\\\\ s\\neq r}}^{m}\\langle \\mu_t,f_s\\rangle \\right] = \\sum_{r=1}^{m} u \\left( \\langle \\pi, f_r \\rangle \\mathbb{E}\\left[\\prod_{\\substack{s=1\\\\ s\\neq r}}^{m}\\langle \\mu_t,f_s\\rangle\\right] - \\mathbb{E}\\left[\\prod_{s=1}^{m}\\langle \\mu_t,f_s\\rangle\\right] \\right)。\n$$\n用混合矩表示，即为：\n$$\n\\sum_{r=1}^{m} u \\langle \\pi, f_r \\rangle M_{f_1,\\dots,f_{r-1},f_{r+1},\\dots,f_m}(t) - m u M_{f_1,\\dots,f_m}(t).\n$$\n\n第二项是重抽样（漂变）部分。其期望为：\n$$\n\\gamma \\mathbb{E}\\left[ \\sum_{1\\le r< s\\le m}\\left(\\langle \\mu_t,f_r f_s\\rangle-\\langle \\mu_t,f_r\\rangle\\langle \\mu_t,f_s\\rangle\\right)\\prod_{\\substack{q=1\\\\ q\\neq r,s}}^{m}\\langle \\mu_t,f_q\\rangle \\right].\n$$\n这可以分为两部分：\n$$\n\\gamma \\sum_{1\\le r< s\\le m} \\mathbb{E}\\left[\\langle \\mu_t,f_r f_s\\rangle\\prod_{\\substack{q=1\\\\ q\\neq r,s}}^{m}\\langle \\mu_t,f_q\\rangle\\right] - \\gamma \\sum_{1\\le r< s\\le m} \\mathbb{E}\\left[\\prod_{q=1}^{m}\\langle \\mu_t,f_q\\rangle\\right]。\n$$\n用混合矩表示，其中 $(f_r f_s)(i) = f_r(i)f_s(i)$，这变为：\n$$\n\\gamma \\sum_{1\\le r< s\\le m} M_{f_1,\\dots,f_{r-1},f_{r+1},\\dots,f_{s-1},f_{s+1},\\dots,f_m, f_r f_s}(t) - \\gamma \\binom{m}{2} M_{f_1,\\dots,f_m}(t)。\n$$\n合并所有项，我们得到混合矩的递推关系：\n$$\n\\frac{d}{dt}M_{f_1,\\dots,f_m}(t) = \\sum_{r=1}^{m} u \\langle \\pi, f_r \\rangle M_{f_1,\\dots,f_{r-1},f_{r+1},\\dots,f_m}(t) + \\gamma \\sum_{1\\le r< s\\le m} M_{f_1,\\dots,f_{r-1},f_{r+1},\\dots,f_{s-1},f_{s+1},\\dots,f_m, f_r f_s}(t) - \\left(mu + \\gamma\\binom{m}{2}\\right)M_{f_1,\\dots,f_m}(t)。\n$$\n\n**2. 特化为单类型混合矩**\n\n现在我们将此结果特化为 $m_k(t) = \\mathbb{E}[\\langle \\mu_t, \\phi \\rangle^k]$，对于 $k \\in \\mathbb{N}$，其中 $\\phi(i) = \\mathbf{1}_{\\{i=i^\\star\\}}$ 是一个选取单个类型 $i^\\star$ 的指示函数。这对应于在我们的通用公式中令 $f_1=f_2=\\dots=f_k=\\phi$（并用 $k$ 替换 $m$）。\n\n首先，我们计算特殊项：\n- 函数 $\\phi$ 是一个指示函数，因此 $\\phi(i) \\in \\{0, 1\\}$。这意味着 $\\phi^2(i) = (\\phi(i))^2 = \\phi(i)$，所以 $\\phi^2=\\phi$。通常，对于任何 $n \\ge 1$，都有 $\\phi^n=\\phi$。\n- 项 $\\langle \\pi, \\phi \\rangle$ 是 $\\sum_{j=1}^K \\pi_j \\phi(j) = \\sum_{j=1}^K \\pi_j \\mathbf{1}_{\\{j=i^\\star\\}} = \\pi_{i^\\star}$。\n- $M_{f_1,\\dots,f_k}(t)$ 变为 $m_k(t)$。\n- $M_{f_1,\\dots,f_{r-1},f_{r+1},\\dots,f_k}(t)$ 有 $k-1$ 个参数，均等于 $\\phi$。此即为 $m_{k-1}(t)$。\n- 当 $f_i=\\phi$ 时，$M_{f_1,\\dots,\\dots,f_k, f_r f_s}(t)$ 有 $k-2$ 个参数 $\\phi$ 和一个参数 $\\phi^2=\\phi$。因此，它有 $k-1$ 个等于 $\\phi$ 的参数，即为 $m_{k-1}(t)$。\n\n将这些代入 $m=k$ 的通用递推关系中：\n$$\n\\frac{d}{dt}m_k(t) = \\sum_{r=1}^{k} u \\pi_{i^\\star} m_{k-1}(t) + \\gamma \\sum_{1\\le r< s\\le k} m_{k-1}(t) - \\left(ku + \\gamma\\binom{k}{2}\\right)m_k(t)。\n$$\n求和是直接的：\n- $\\sum_{r=1}^{k} u \\pi_{i^\\star} m_{k-1}(t) = k u \\pi_{i^\\star} m_{k-1}(t)$。\n- $\\sum_{1\\le r< s\\le k} m_{k-1}(t) = \\binom{k}{2} m_{k-1}(t)$。\n\n这给出了 $\\{m_k(t)\\}_{k \\ge 1}$ 的闭式递推关系：\n$$\n\\frac{d}{dt}m_k(t) = \\left( k u \\pi_{i^\\star} + \\gamma \\binom{k}{2} \\right) m_{k-1}(t) - \\left( ku + \\gamma \\binom{k}{2} \\right) m_k(t),\n$$\n其中我们定义 $m_0(t) = \\mathbb{E}[\\langle \\mu_t, \\phi \\rangle^0] = \\mathbb{E}[1] = 1$。项 $\\binom{k}{2} = \\frac{k(k-1)}{2}$。\n\n**3. 双类型情形下 $m_2(t)$ 的显式解**\n\n给定 $\\mathcal{E}=\\{1,2\\}$、$\\pi=(\\theta, 1-\\theta)$、$\\gamma>0$、$u>0$ 以及 $\\langle \\mu_0, \\phi \\rangle = p$。我们选择类型 $i^\\star=1$，因此 $\\phi(i)=\\mathbf{1}_{\\{i=1\\}}$。那么 $\\pi_{i^\\star} = \\pi_1 = \\theta$。\n初始条件意味着 $m_k(0) = \\mathbb{E}[\\langle \\mu_0, \\phi \\rangle^k] = p^k$。\n\n我们需要求解 $m_2(t)$，这需要 $m_1(t)$。我们写下 $k=1$ 和 $k=2$ 时的常微分方程。\n当 $k=1$ 时：$\\binom{1}{2}=0$。\n$$\n\\frac{d}{dt}m_1(t) = (1 \\cdot u \\cdot \\theta) m_0(t) - (1 \\cdot u) m_1(t) = u\\theta - u m_1(t)。\n$$\n这是一个一阶线性常微分方程。满足初始条件 $m_1(0)=p$ 的解是：\n$$\nm_1(t) = \\theta + (p-\\theta)\\exp(-ut)。\n$$\n当 $k=2$ 时：$\\binom{2}{2}=1$。\n$$\n\\frac{d}{dt}m_2(t) = (2 u \\theta + \\gamma \\cdot 1) m_1(t) - (2 u + \\gamma \\cdot 1) m_2(t) = (2u\\theta+\\gamma)m_1(t) - (2u+\\gamma)m_2(t)。\n$$\n这是关于 $m_2(t)$ 的另一个一阶线性常微分方程，带有时变强迫项 $m_1(t)$:\n$$\n\\frac{d}{dt}m_2(t) + (2u+\\gamma)m_2(t) = (2u\\theta+\\gamma)\\left(\\theta + (p-\\theta)\\exp(-ut)\\right)。\n$$\n通解是齐次解 $C\\exp(-(2u+\\gamma)t)$ 和一个特解的和。特解具有 $K_1 + K_2\\exp(-ut)$ 的形式。将此形式代入常微分方程并匹配系数得到：\n$$\nK_1 = \\frac{(2u\\theta+\\gamma)\\theta}{2u+\\gamma} = \\frac{2u\\theta^2 + \\gamma\\theta}{2u+\\gamma}。\n$$\n$$\nK_2 = \\frac{(2u\\theta+\\gamma)(p-\\theta)}{(2u+\\gamma)-u} = \\frac{(2u\\theta+\\gamma)(p-\\theta)}{u+\\gamma}。\n$$\n因此 $m_2(t)$ 的通解为：\n$$\nm_2(t) = \\frac{2u\\theta^2 + \\gamma\\theta}{2u+\\gamma} + \\frac{(2u\\theta+\\gamma)(p-\\theta)}{u+\\gamma}\\exp(-ut) + C\\exp(-(2u+\\gamma)t)。\n$$\n我们使用初始条件 $m_2(0)=p^2$ 来求常数 $C$：\n$$\np^2 = \\frac{2u\\theta^2 + \\gamma\\theta}{2u+\\gamma} + \\frac{(2u\\theta+\\gamma)(p-\\theta)}{u+\\gamma} + C。\n$$\n求解 $C$：\n$$\nC = p^2 - \\frac{2u\\theta^2 + \\gamma\\theta}{2u+\\gamma} - \\frac{(2u\\theta+\\gamma)(p-\\theta)}{u+\\gamma}。\n$$\n综合这些结果，得到 $m_2(t)$ 的闭式解析表达式：\n$$\nm_2(t) = \\frac{2u\\theta^2 + \\gamma\\theta}{2u+\\gamma} + \\frac{(2u\\theta+\\gamma)(p-\\theta)}{u+\\gamma}\\exp(-ut) + \\left( p^2 - \\frac{2u\\theta^2 + \\gamma\\theta}{2u+\\gamma} - \\frac{(2u\\theta+\\gamma)(p-\\theta)}{u+\\gamma} \\right)\\exp(-(2u+\\gamma)t)。\n$$\n该表达式在给定初始频率 $p$ 的情况下，提供了在时间 $t$ 类型 1 频率的二阶矩。", "answer": "$$\\boxed{\\frac{2u\\theta^{2} + \\gamma\\theta}{2u+\\gamma} + \\frac{(2u\\theta+\\gamma)(p-\\theta)}{u+\\gamma}\\exp(-ut) + \\left( p^{2} - \\frac{2u\\theta^{2} + \\gamma\\theta}{2u+\\gamma} - \\frac{(2u\\theta+\\gamma)(p-\\theta)}{u+\\gamma} \\right)\\exp(-(2u+\\gamma)t)}$$", "id": "2981187"}, {"introduction": "为了最完整地描述一个随机过程的动力学，我们需要其转移概率密度 $p_t(x,y)$。这个高级练习将引导你运用谱理论这一强大工具，通过求解Wright-Fisher扩散生成元的特征值问题来构建其转移密度。你将学习如何将该生成元与Sturm-Liouville理论联系起来，并发现其特征函数是经典的Jacobi多项式，从而揭示这些过程背后深刻的数学结构。[@problem_id:2981119]", "problem": "考虑双等位基因的Wright–Fisher扩散，它是有限类型空间上Fleming–Viot过程的二维边际。设 $X_{t} \\in [0,1]$ 表示一个具有亲代无关突变的群体中等位基因1的频率，其突变参数为正数 $\\alpha>0$ 和 $\\beta>0$。$X_{t}$ 的无穷小生成元 $\\mathcal{L}$ 作用于二次连续可微函数 $f$ 的形式为\n$$\n\\mathcal{L} f(x) \\;=\\; \\frac{1}{2}\\,x(1-x)\\,f''(x) \\;+\\; \\frac{1}{2}\\,\\big(\\beta(1-x) - \\alpha x\\big)\\,f'(x), \\quad x \\in (0,1).\n$$\n已知该扩散的不变概率密度 $\\pi$ 是参数为 $(\\beta,\\alpha)$ 的贝塔分布，由下式给出\n$$\n\\pi(x) \\;=\\; \\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\,\\Gamma(\\beta)}\\,x^{\\beta-1}\\,(1-x)^{\\alpha-1}, \\quad x \\in (0,1),\n$$\n其中 $\\Gamma$ 表示伽马函数。生成元 $\\mathcal{L}$ 在 $L^{2}(\\pi)$ 上是自伴的，并且拥有一组完备的多项式本征函数正交基。\n\n从自伴生成元的散度形式的基本定义以及关于正交多项式的Sturm–Liouville理论出发，推导Wright–Fisher扩散关于勒贝格测度的转移密度 $p_{t}(x,y)$ 的显式谱表示，并用雅可比多项式 $P_{n}^{(\\alpha-1,\\beta-1)}$ 表示。您的推导必须：\n\n- 建立 $\\mathcal{L}$ 关于 $\\pi$ 的散度形式（自伴）表示，并通过变量替换 $z=2x-1$ 将本征值问题化为 $[-1,1]$ 上的雅可比微分方程。\n- 识别所有的本征值 $\\lambda_{n}$ 和相应的本征函数（用雅可比多项式表示），并确定在 $L^{2}(\\pi)$ 中的精确正交关系。\n- 通过计算雅可比范数并将其在 $\\pi$ 下映射到 $x$ 变量，显式地计算本征函数的归一化常数。\n- 整合谱展开，得到关于 $[0,1]$ 上勒贝格测度的转移密度 $p_{t}(x,y)$ 的显式级数表达式。\n\n验证雅可比多项式在权函数 $\\pi(x)$ 下的正交关系，并确保对于每个固定的 $x$ 和 $t>0$，所得的转移密度对 $y$ 的积分为 $1$。\n\n请用 $\\alpha$、$\\beta$、$t$、$x$、$y$和雅可比多项式，将您的最终答案表示为 $p_{t}(x,y)$ 的单个闭式解析表达式。不需要数值近似。", "solution": "问题陈述已经过严格评估，并被确定为有效。它具有科学依据，问题提法得当，客观且内部一致，为严谨的推导提供了所有必要的信息。因此，我们可以开始求解。\n\n目标是推导在区间 $[0,1]$ 上的双等位基因Wright–Fisher扩散的转移密度 $p_t(x,y)$ 的谱表示。该过程由无穷小生成元 $\\mathcal{L}$ 描述，它作用于一个合适的函数 $f(x)$ 的形式为：\n$$\n\\mathcal{L} f(x) = \\frac{1}{2}x(1-x) f''(x) + \\frac{1}{2}(\\beta(1-x) - \\alpha x) f'(x)\n$$\n对于 $x \\in (0,1)$，突变参数为 $\\alpha > 0$ 和 $\\beta > 0$。不变概率密度是参数为 $(\\beta, \\alpha)$ 的贝塔分布 $\\pi(x)$：\n$$\n\\pi(x) = \\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)} x^{\\beta-1}(1-x)^{\\alpha-1}\n$$\n\n**1. 自伴形式与化为雅可比方程**\n\n生成元 $\\mathcal{L}$ 在关于测度 $\\pi(x)dx$ 平方可积的函数构成的希尔伯特空间 $L^2(\\pi)$ 中是自伴的。一个形式为 $\\mathcal{L}f(x) = a(x)f''(x) + b(x)f'(x)$ 的微分算子，如果可以写成散度形式或Sturm-Liouville形式 $\\mathcal{L}f(x) = \\frac{1}{\\pi(x)} \\frac{d}{dx} \\left( a(x)\\pi(x) \\frac{df}{dx} \\right)$，则它关于权函数 $\\pi(x)$ 是自伴的。这要求 $f'(x)$ 的系数为 $b(x) = \\frac{d}{dx}a(x) + a(x)\\frac{\\pi'(x)}{\\pi(x)}$。\n\n在我们的例子中，$a(x) = \\frac{1}{2}x(1-x)$ 且 $b(x) = \\frac{1}{2}(\\beta(1-x) - \\alpha x)$。$\\pi(x)$ 的对数导数为：\n$$\n\\frac{\\pi'(x)}{\\pi(x)} = \\frac{d}{dx} \\big( (\\beta-1)\\ln(x) + (\\alpha-1)\\ln(1-x) + \\text{const.} \\big) = \\frac{\\beta-1}{x} - \\frac{\\alpha-1}{1-x}\n$$\n因此，$a(x)\\pi'(x)/\\pi(x)$ 是：\n$$\n\\frac{1}{2}x(1-x) \\left( \\frac{\\beta-1}{x} - \\frac{\\alpha-1}{1-x} \\right) = \\frac{1}{2}\\big( (\\beta-1)(1-x) - (\\alpha-1)x \\big) = \\frac{1}{2}\\big( \\beta-1 - (\\alpha+\\beta-2)x \\big)\n$$\n并且，$\\frac{d}{dx}a(x) = \\frac{d}{dx} \\left( \\frac{1}{2}(x-x^2) \\right) = \\frac{1}{2}(1-2x)$。\n将这两项相加，我们得到：\n$$\n\\frac{d}{dx}a(x) + a(x)\\frac{\\pi'(x)}{\\pi(x)} = \\frac{1}{2}(1-2x) + \\frac{1}{2}\\big( \\beta-1 - (\\alpha+\\beta-2)x \\big) = \\frac{1}{2}(\\beta - (\\alpha+\\beta)x) = b(x)\n$$\n这证实了自伴性条件，生成元可以写为：\n$$\n\\mathcal{L}f(x) = \\frac{1}{\\pi(x)} \\frac{d}{dx} \\left(\\frac{1}{2}x(1-x)\\pi(x) f'(x)\\right)\n$$\n本征值问题是 $\\mathcal{L}f_n(x) = \\lambda_n f_n(x)$。我们寻求多项式解。\n为了解决这个Sturm-Liouville问题，我们进行变量替换 $z = 2x-1$，这将 $x \\in (0,1)$ 映射到 $z \\in (-1,1)$。设 $f(x) = g(z)$。导数转换如下：\n$$\n\\frac{df}{dx} = \\frac{dg}{dz}\\frac{dz}{dx} = 2g'(z) \\quad \\text{和} \\quad \\frac{d^2f}{dx^2} = 4g''(z)\n$$\n系数项转换如下：\n$$\nx(1-x) = \\frac{1+z}{2} \\left(1-\\frac{1+z}{2}\\right) = \\frac{1-z^2}{4}\n$$\n$$\n\\beta(1-x) - \\alpha x = \\beta\\left(\\frac{1-z}{2}\\right) - \\alpha\\left(\\frac{1+z}{2}\\right) = \\frac{(\\beta-\\alpha) - (\\alpha+\\beta)z}{2}\n$$\n将这些代入本征值方程 $\\mathcal{L}f = \\lambda f$：\n$$\n\\frac{1}{2}\\left(\\frac{1-z^2}{4}\\right)(4g''(z)) + \\frac{1}{2}\\left(\\frac{(\\beta-\\alpha) - (\\alpha+\\beta)z}{2}\\right)(2g'(z)) = \\lambda g(z)\n$$\n两边乘以 $2$ 可将方程简化为：\n$$\n(1-z^2)g''(z) + \\big((\\beta-\\alpha) - (\\alpha+\\beta)z\\big)g'(z) - 2\\lambda g(z) = 0\n$$\n这是雅可比微分方程：\n$$\n(1-z^2)y'' + \\big(B-A - (A+B+2)z\\big)y' + n(n+A+B+1)y = 0\n$$\n其解是雅可比多项式 $P_n^{(A,B)}(z)$。通过比较系数，我们确定了参数：\n$B-A = \\beta-\\alpha$\n$A+B+2 = \\alpha+\\beta \\implies A+B = \\alpha+\\beta-2$\n解这个方程组得到 $A = \\alpha-1$ 和 $B = \\beta-1$。\n\n通过比较最后一项的系数（对于 $n \\in \\{0, 1, 2, ...\\}$），可以得到本征值 $\\lambda_n$：\n$$\n-2\\lambda_n = n(n+A+B+1) = n(n+(\\alpha-1)+(\\beta-1)+1) = n(n+\\alpha+\\beta-1)\n$$\n$$\n\\lambda_n = -\\frac{1}{2} n(n+\\alpha+\\beta-1)\n$$\n\n**2. 本征函数与正交性**\n\n因此，$\\mathcal{L}$ 的本征函数由具有所确定参数的雅可比多项式给出，并变换回 $x$ 变量：\n$$\n\\phi_n(x) = P_n^{(\\alpha-1, \\beta-1)}(2x-1)\n$$\nSturm-Liouville理论保证了这些本征函数构成空间 $L^2(\\pi)$ 的一个完备正交基。正交关系为：\n$$\n\\langle \\phi_n, \\phi_m \\rangle_{\\pi} = \\int_0^1 \\phi_n(x)\\phi_m(x)\\pi(x)dx = 0 \\quad \\text{对于 } n \\neq m.\n$$\n这可以通过将积分变换到 $z$ 变量来显式验证：\n$dx = dz/2$ 且 $\\pi(x) \\propto x^{\\beta-1}(1-x)^{\\alpha-1} \\propto (1+z)^{\\beta-1}(1-z)^{\\alpha-1}$。该积分与带有权函数 $(1-z)^{\\alpha-1}(1+z)^{\\beta-1}$ 的雅可比多项式 $P_n^{(\\alpha-1, \\beta-1)}(z)$ 的标准正交积分成正比。\n\n**3. 本征函数的归一化**\n\n为了构造谱展开，我们必须计算范数的平方 $||\\phi_n||^2_\\pi = \\langle \\phi_n, \\phi_n \\rangle_{\\pi}$。\n$$\n||\\phi_n||^2_\\pi = \\int_0^1 \\left(P_n^{(\\alpha-1, \\beta-1)}(2x-1)\\right)^2 \\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)} x^{\\beta-1}(1-x)^{\\alpha-1} dx\n$$\n变量替换为 $z=2x-1$：\n$$\n||\\phi_n||^2_\\pi = \\int_{-1}^1 \\left(P_n^{(\\alpha-1, \\beta-1)}(z)\\right)^2 \\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)} \\left(\\frac{1+z}{2}\\right)^{\\beta-1} \\left(\\frac{1-z}{2}\\right)^{\\alpha-1} \\frac{dz}{2}\n$$\n$$\n||\\phi_n||^2_\\pi = \\frac{\\Gamma(\\alpha+\\beta)}{2^{\\alpha+\\beta-1}\\Gamma(\\alpha)\\Gamma(\\beta)} \\int_{-1}^1 \\left(P_n^{(\\alpha-1, \\beta-1)}(z)\\right)^2 (1-z)^{\\alpha-1}(1+z)^{\\beta-1} dz\n$$\n雅可比多项式 $P_n^{(A,B)}(z)$ 的范数标准公式为：\n$$\n\\int_{-1}^1 (P_n^{(A,B)}(z))^2 (1-z)^A (1+z)^B dz = \\frac{2^{A+B+1}}{2n+A+B+1} \\frac{\\Gamma(n+A+1)\\Gamma(n+B+1)}{n! \\Gamma(n+A+B+1)}\n$$\n代入 $A=\\alpha-1$ 和 $B=\\beta-1$：\n$$\n\\int_{-1}^1 \\dots dz = \\frac{2^{\\alpha+\\beta-1}}{2n+\\alpha+\\beta-1} \\frac{\\Gamma(n+\\alpha)\\Gamma(n+\\beta)}{n! \\Gamma(n+\\alpha+\\beta-1)}\n$$\n将此与前面的因子结合，得到在 $L^2(\\pi)$ 中的范数：\n$$\n||\\phi_n||^2_\\pi = \\frac{\\Gamma(\\alpha+\\beta)}{2^{\\alpha+\\beta-1}\\Gamma(\\alpha)\\Gamma(\\beta)} \\cdot \\frac{2^{\\alpha+\\beta-1}}{2n+\\alpha+\\beta-1} \\frac{\\Gamma(n+\\alpha)\\Gamma(n+\\beta)}{n! \\Gamma(n+\\alpha+\\beta-1)}\n$$\n$$\n||\\phi_n||^2_\\pi = \\frac{\\Gamma(\\alpha+\\beta)\\Gamma(n+\\alpha)\\Gamma(n+\\beta)}{n!\\Gamma(\\alpha)\\Gamma(\\beta)\\Gamma(n+\\alpha+\\beta-1)(2n+\\alpha+\\beta-1)}\n$$\n对于 $n=0$，$\\phi_0(x)=1$，$\\lambda_0=0$，且 $||\\phi_0||^2_\\pi = \\int_0^1 \\pi(x)dx=1$。\n\n**4. 转移密度的谱展开**\n\n关于勒贝格测度的转移密度 $p_t(x,y)$ 通过 $p_t(x,y) = k_t(x,y)\\pi(y)$ 与 $L^2(\\pi)$ 中的转移核相关。核的谱展开用标准正交本征函数 $\\psi_n(x) = \\phi_n(x)/||\\phi_n||_{\\pi}$ 表示：\n$$\nk_t(x,y) = \\sum_{n=0}^{\\infty} e^{\\lambda_n t} \\psi_n(x)\\psi_n(y) = \\sum_{n=0}^{\\infty} e^{\\lambda_n t} \\frac{\\phi_n(x)\\phi_n(y)}{||\\phi_n||^2_\\pi}\n$$\n因此，转移密度为：\n$$\np_t(x,y) = \\pi(y) \\sum_{n=0}^{\\infty} e^{\\lambda_n t} \\frac{\\phi_n(x)\\phi_n(y)}{||\\phi_n||^2_\\pi}\n$$\n代入 $\\pi(y)$, $\\lambda_n$, $\\phi_n$ 和 $||\\phi_n||^2_\\pi$ 的表达式：\n$$\np_t(x,y) = \\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)} y^{\\beta-1}(1-y)^{\\alpha-1} \\sum_{n=0}^{\\infty} \\exp\\left(-\\frac{n(n+\\alpha+\\beta-1)}{2}t\\right) \\times\n$$\n$$\n\\frac{n!\\Gamma(\\alpha)\\Gamma(\\beta)\\Gamma(n+\\alpha+\\beta-1)(2n+\\alpha+\\beta-1)}{\\Gamma(\\alpha+\\beta)\\Gamma(n+\\alpha)\\Gamma(n+\\beta)} P_n^{(\\alpha-1, \\beta-1)}(2x-1)P_n^{(\\alpha-1, \\beta-1)}(2y-1)\n$$\n贝塔分布的归一化常数 $\\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)}$ 被消去，得到最终表达式：\n$$\np_t(x,y) = y^{\\beta-1}(1-y)^{\\alpha-1} \\sum_{n=0}^{\\infty} \\frac{n!(2n+\\alpha+\\beta-1)\\Gamma(n+\\alpha+\\beta-1)}{\\Gamma(n+\\alpha)\\Gamma(n+\\beta)} \\times\n$$\n$$\n\\exp\\left(-\\frac{n(n+\\alpha+\\beta-1)}{2}t\\right) P_n^{(\\alpha-1, \\beta-1)}(2x-1)P_n^{(\\alpha-1, \\beta-1)}(2y-1)\n$$\n\n**总概率验证**\n根据要求，我们验证对于所有 $x \\in [0,1]$ 和 $t>0$，都有 $\\int_0^1 p_t(x,y)dy = 1$。\n$$\n\\int_0^1 p_t(x,y) dy = \\int_0^1 \\sum_{n=0}^{\\infty} e^{\\lambda_n t} \\frac{\\phi_n(x)\\phi_n(y)}{||\\phi_n||_\\pi^2} \\pi(y) dy\n$$\n假设一致收敛，可以交换积分和求和的顺序：\n$$\n\\int_0^1 p_t(x,y) dy = \\sum_{n=0}^{\\infty} e^{\\lambda_n t} \\frac{\\phi_n(x)}{||\\phi_n||_\\pi^2} \\int_0^1 \\phi_n(y)\\pi(y) dy\n$$\n由于 $\\phi_0(y) = P_0^{(\\alpha-1,\\beta-1)}(2y-1) = 1$，该积分为 $\\int_0^1 \\phi_n(y)\\phi_0(y)\\pi(y)dy = \\langle \\phi_n, \\phi_0 \\rangle_\\pi$。由于正交性，该内积仅在 $n=0$ 时不为零，此时其值等于 $||\\phi_0||_\\pi^2=1$。\n级数收缩为 $n=0$ 的项：\n$$\n\\int_0^1 p_t(x,y) dy = e^{\\lambda_0 t} \\frac{\\phi_0(x)}{||\\phi_0||_\\pi^2} ||\\phi_0||_\\pi^2 = e^{0 \\cdot t} \\cdot \\phi_0(x) = 1\n$$\n推导过程一致且完整。", "answer": "$$\n\\boxed{y^{\\beta-1}(1-y)^{\\alpha-1} \\sum_{n=0}^{\\infty} \\frac{n!(2n+\\alpha+\\beta-1)\\Gamma(n+\\alpha+\\beta-1)}{\\Gamma(n+\\alpha)\\Gamma(n+\\beta)} \\exp\\left(-\\frac{n(n+\\alpha+\\beta-1)}{2}t\\right) P_{n}^{(\\alpha-1,\\beta-1)}(2x-1)P_{n}^{(\\alpha-1,\\beta-1)}(2y-1)}\n$$", "id": "2981119"}]}