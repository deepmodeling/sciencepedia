{"hands_on_practices": [{"introduction": "本练习旨在通过一个具体的离散随机变量案例，引导您从第一性原理出发，完整地走一遍计算大偏差速率函数的过程。掌握这一基本流程是应用Cramér定理解决更复杂问题的基础。通过计算动差生成函数（MGF）、累积量生成函数（CGF），并执行勒让德-芬切尔变换，您将亲手推导出当经验均值偏离其期望时，其概率的指数衰减率 $I(x)$。[@problem_id:2972660]", "problem": "考虑一个独立同分布的随机变量序列 $\\{X_{i}\\}_{i \\geq 1}$，其取值于 $\\{-1,2\\}$，且满足 $\\mathbb{P}(X_{i}=-1)=\\frac{1}{3}$ 和 $\\mathbb{P}(X_{i}=2)=\\frac{2}{3}$。令 $S_{n}=\\sum_{i=1}^{n} X_{i}$。从矩生成函数 $M_{X}(t)=\\mathbb{E}[\\exp(t X)]$ 和累积量生成函数 $\\Lambda(t)=\\ln \\mathbb{E}[\\exp(t X)]$ 的定义出发，并利用“独立同分布样本的经验均值满足大偏差原理（LDP），其凸速率函数由 $\\Lambda(t)$ 的勒让德变换确定”这一基本原理，确定\n$$\n\\lim_{n \\to \\infty} \\frac{1}{n} \\ln \\mathbb{P}\\!\\left(\\frac{S_{n}}{n} \\geq \\frac{6}{5}\\right).\n$$\n的精确闭式值。\n将您的最终答案表示为单个闭式解析表达式。不需要单位，也不需要取整。", "solution": "用户希望求出以下极限的值：\n$$\n\\lim_{n \\to \\infty} \\frac{1}{n} \\ln \\mathbb{P}\\!\\left(\\frac{S_{n}}{n} \\geq \\frac{6}{5}\\right)\n$$\n其中 $S_{n}=\\sum_{i=1}^{n} X_{i}$，而 $\\{X_{i}\\}_{i \\geq 1}$ 是一个独立同分布（i.i.d.）的随机变量序列，其取值于 $\\{-1, 2\\}$，概率为 $\\mathbb{P}(X_{i}=-1)=\\frac{1}{3}$ 和 $\\mathbb{P}(X_{i}=2)=\\frac{2}{3}$。\n\n本问题是 Cramér 大偏差定理的一个直接应用。该定理指出，对于一个独立同分布的随机变量序列 $X_i$，其经验均值 $\\frac{S_n}{n}$ 满足一个大偏差原理（LDP），其速率函数 $I(x)$ 是一个凸函数。具体来说，对于任何 $a > \\mathbb{E}[X]$，以下极限成立：\n$$\n\\lim_{n \\to \\infty} \\frac{1}{n} \\ln \\mathbb{P}\\left(\\frac{S_n}{n} \\geq a\\right) = -\\inf_{x \\geq a} I(x)\n$$\n速率函数 $I(x)$ 是累积量生成函数（CGF） $\\Lambda(t)$ 的勒让德-芬切尔变换（Legendre-Fenchel transform），定义为：\n$$\nI(x) = \\sup_{t \\in \\mathbb{R}} \\{xt - \\Lambda(t)\\}\n$$\n其中 $\\Lambda(t) = \\ln M_X(t)$，而 $M_X(t) = \\mathbb{E}[\\exp(tX)]$ 是矩生成函数（MGF）。\n\n首先，我们计算 $X$ 的期望值，以验证条件 $a > \\mathbb{E}[X]$。\n$$\n\\mathbb{E}[X] = (-1) \\cdot \\mathbb{P}(X=-1) + (2) \\cdot \\mathbb{P}(X=2) = (-1) \\cdot \\frac{1}{3} + (2) \\cdot \\frac{2}{3} = -\\frac{1}{3} + \\frac{4}{3} = 1\n$$\n在本问题中，$a = \\frac{6}{5}$。由于 $\\frac{6}{5} = 1.2 > 1$，该条件得到满足。\n\n速率函数 $I(x)$ 是凸函数，并在 $I(\\mathbb{E}[X_1])=I(1)=0$ 处取得其最小值。对于 $x > \\mathbb{E}[X]$，$I(x)$ 是严格递增的。因此，$\\inf_{x \\geq a} I(x) = I(a)$。\n所以，我们需要求的极限等于 $-I(\\frac{6}{5})$。\n\n我们分几个步骤进行计算：\n\n1.  **计算矩生成函数 (MGF) $M_X(t)$**：\n    对于一个离散随机变量，其 MGF 由 $M_X(t) = \\sum_{k} \\exp(tk) \\mathbb{P}(X=k)$ 给出。\n    $$\n    M_X(t) = \\exp(t(-1))\\mathbb{P}(X=-1) + \\exp(t(2))\\mathbb{P}(X=2) = \\frac{1}{3}\\exp(-t) + \\frac{2}{3}\\exp(2t)\n    $$\n\n2.  **计算累积量生成函数 (CGF) $\\Lambda(t)$**：\n    CGF 是 MGF 的自然对数。\n    $$\n    \\Lambda(t) = \\ln(M_X(t)) = \\ln\\left(\\frac{1}{3}\\exp(-t) + \\frac{2}{3}\\exp(2t)\\right)\n    $$\n\n3.  **计算速率函数 $I(\\frac{6}{5})$**：\n    $I(x)$ 定义中的上确界在 $t$ 的某个值（记为 $t_0$）处取得，该点处 $xt - \\Lambda(t)$ 关于 $t$ 的导数为零。这给出了关系式 $x = \\Lambda'(t_0)$。\n    首先，我们求 $\\Lambda(t)$ 的导数：\n    $$\n    \\Lambda'(t) = \\frac{M_X'(t)}{M_X(t)} = \\frac{\\frac{d}{dt}\\left(\\frac{1}{3}\\exp(-t) + \\frac{2}{3}\\exp(2t)\\right)}{\\frac{1}{3}\\exp(-t) + \\frac{2}{3}\\exp(2t)} = \\frac{-\\frac{1}{3}\\exp(-t) + \\frac{4}{3}\\exp(2t)}{\\frac{1}{3}\\exp(-t) + \\frac{2}{3}\\exp(2t)}\n    $$\n    分子分母同乘以 $3$ 可简化为：\n    $$\n    \\Lambda'(t) = \\frac{-\\exp(-t) + 4\\exp(2t)}{\\exp(-t) + 2\\exp(2t)}\n    $$\n    我们需要找到 $t_0$ 使得 $\\Lambda'(t_0) = \\frac{6}{5}$。令 $u = \\exp(t_0)$。方程变为：\n    $$\n    \\frac{6}{5} = \\frac{-u^{-1} + 4u^2}{u^{-1} + 2u^2}\n    $$\n    将右侧的分子分母同乘以 $u$：\n    $$\n    \\frac{6}{5} = \\frac{-1 + 4u^3}{1 + 2u^3}\n    $$\n    现在，我们求解 $u^3$：\n    $$\n    6(1 + 2u^3) = 5(-1 + 4u^3) \\\\\n    6 + 12u^3 = -5 + 20u^3 \\\\\n    11 = 8u^3 \\\\\n    u^3 = \\frac{11}{8}\n    $$\n    所以，$u = \\exp(t_0) = \\left(\\frac{11}{8}\\right)^{1/3}$。由此我们得到 $t_0$ 的值：\n    $$\n    t_0 = \\ln\\left(\\left(\\frac{11}{8}\\right)^{1/3}\\right) = \\frac{1}{3}\\ln\\left(\\frac{11}{8}\\right) = \\frac{1}{3}(\\ln(11) - \\ln(8)) = \\frac{1}{3}(\\ln(11) - 3\\ln(2)) = \\frac{1}{3}\\ln(11) - \\ln(2)\n    $$\n    于是速率函数为 $I\\left(\\frac{6}{5}\\right) = \\frac{6}{5}t_0 - \\Lambda(t_0)$。我们需要计算 $\\Lambda(t_0)$。\n    $$\n    \\Lambda(t_0) = \\ln\\left(M_X(t_0)\\right) = \\ln\\left(\\frac{1}{3}\\exp(-t_0) + \\frac{2}{3}\\exp(2t_0)\\right) = \\ln\\left(\\frac{1}{3}u^{-1} + \\frac{2}{3}u^2\\right)\n    $$\n    我们有 $u = \\left(\\frac{11}{8}\\right)^{1/3}$，所以 $u^{-1} = \\left(\\frac{8}{11}\\right)^{1/3} = \\frac{2}{11^{1/3}}$ 且 $u^2 = \\left(\\frac{11}{8}\\right)^{2/3} = \\frac{11^{2/3}}{4}$。\n    $$\n    \\Lambda(t_0) = \\ln\\left(\\frac{1}{3}\\frac{2}{11^{1/3}} + \\frac{2}{3}\\frac{11^{2/3}}{4}\\right) = \\ln\\left(\\frac{2}{3 \\cdot 11^{1/3}} + \\frac{11^{2/3}}{6}\\right)\n    $$\n    通分，公分母为 $6 \\cdot 11^{1/3}$：\n    $$\n    \\Lambda(t_0) = \\ln\\left(\\frac{4 + 11^{1/3} \\cdot 11^{2/3}}{6 \\cdot 11^{1/3}}\\right) = \\ln\\left(\\frac{4+11}{6 \\cdot 11^{1/3}}\\right) = \\ln\\left(\\frac{15}{6 \\cdot 11^{1/3}}\\right) = \\ln\\left(\\frac{5}{2 \\cdot 11^{1/3}}\\right)\n    $$\n    利用对数性质：\n    $$\n    \\Lambda(t_0) = \\ln(5) - \\ln(2) - \\ln(11^{1/3}) = \\ln(5) - \\ln(2) - \\frac{1}{3}\\ln(11)\n    $$\n\n4.  **计算最终极限**：\n    所求极限为 $-I(\\frac{6}{5}) = -(\\frac{6}{5}t_0 - \\Lambda(t_0)) = \\Lambda(t_0) - \\frac{6}{5}t_0$。\n    代入 $\\Lambda(t_0)$ 和 $t_0$ 的表达式：\n    $$\n    \\lim_{n \\to \\infty} \\frac{1}{n} \\ln \\mathbb{P}\\!\\left(\\frac{S_{n}}{n} \\geq \\frac{6}{5}\\right) = \\left(\\ln(5) - \\ln(2) - \\frac{1}{3}\\ln(11)\\right) - \\frac{6}{5}\\left(\\frac{1}{3}\\ln(11) - \\ln(2)\\right)\n    $$\n    $$\n    = \\ln(5) - \\ln(2) - \\frac{1}{3}\\ln(11) - \\frac{6}{15}\\ln(11) + \\frac{6}{5}\\ln(2)\n    $$\n    $$\n    = \\ln(5) - \\ln(2) - \\frac{1}{3}\\ln(11) - \\frac{2}{5}\\ln(11) + \\frac{6}{5}\\ln(2)\n    $$\n    将含有相同对数的项分组：\n    $$\n    = \\ln(5) + \\left(\\frac{6}{5} - 1\\right)\\ln(2) + \\left(-\\frac{1}{3} - \\frac{2}{5}\\right)\\ln(11)\n    $$\n    $$\n    = \\ln(5) + \\frac{1}{5}\\ln(2) + \\left(-\\frac{5}{15} - \\frac{6}{15}\\right)\\ln(11)\n    $$\n    $$\n    = \\ln(5) + \\frac{1}{5}\\ln(2) - \\frac{11}{15}\\ln(11)\n    $$\n此表达式即为极限的精确闭式值。", "answer": "$$\n\\boxed{\\ln(5) + \\frac{1}{5}\\ln(2) - \\frac{11}{15}\\ln(11)}\n$$", "id": "2972660"}, {"introduction": "大偏差理论不仅能量化稀有事件的发生概率，还能深刻揭示在这些稀有事件发生条件下，系统的典型行为。本练习将引导您超越单纯的速率函数计算，去探索一个核心概念：指数倾斜分布 (exponentially tilted distribution)。通过为一个连续分布（指数分布）推导并应用这一概念，您将学会如何计算在经验均值被强制约束在一个非典型值 $a$ 时的条件期望，这展示了该理论在理解和预测系统行为方面的强大能力。[@problem_id:2972671]", "problem": "考虑一个独立同分布 (i.i.d.) 的随机变量序列 $X_1, X_2, \\dots, X_n$，其共同密度函数为 $p(x) = \\exp(-x)\\mathbf{1}_{\\{x \\ge 0\\}}$。令 $S_n = \\sum_{i=1}^{n} X_i$，$M_n = S_n/n$。对于一个固定的 $a > 0$，定义条件事件 $E_{n,\\varepsilon} = \\{|M_n - a| \\le \\varepsilon\\}$，其中 $\\varepsilon > 0$。您将在大偏差原理 (LDP) 的框架下分析独立同分布随机变量之和的约束和条件化，正如 Cramér 定理所描述的那样。\n\n从矩生成函数 $M(\\lambda) = \\mathbb{E}[\\exp(\\lambda X_1)]$、累积量生成函数 $\\Lambda(\\lambda) = \\ln M(\\lambda)$ 以及 Legendre-Fenchel 变换的基本定义出发，推导出典范指数倾斜参数 $\\lambda^{\\ast}(a)$。该参数在一个密度为 $q_{\\lambda}(x) \\propto \\exp(\\lambda x) p(x)$ 的指数倾斜定律下强制执行约束 $\\mathbb{E}_{\\lambda^{\\ast}}[X_1] = a$。利用此参数，确定在条件化下经验二阶矩的渐近典型值，即极限\n$$\\lim_{\\varepsilon \\downarrow 0}\\lim_{n \\to \\infty} \\mathbb{E}\\left[\\frac{1}{n}\\sum_{i=1}^{n} X_i^{2} \\,\\middle|\\, E_{n,\\varepsilon} \\right].$$\n\n为此极限提供一个关于 $a$ 的单一闭式解析表达式。不需要数值近似，也不涉及物理单位。", "solution": "首先将验证问题陈述的科学合理性、一致性和完整性。\n\n### 步骤 1：提取已知条件\n- 一个独立同分布 (i.i.d.) 的随机变量序列 $X_1, X_2, \\dots, X_n$。\n- 共同的概率密度函数 (PDF) 为 $p(x) = \\exp(-x)\\mathbf{1}_{\\{x \\ge 0\\}}$。\n- 和为 $S_n = \\sum_{i=1}^{n} X_i$。\n- 样本均值为 $M_n = S_n/n$。\n- 一个固定常数 $a > 0$。\n- 条件事件为 $E_{n,\\varepsilon} = \\{|M_n - a| \\le \\varepsilon\\}$，其中 $\\varepsilon > 0$。\n- 矩生成函数 (MGF) 定义为 $M(\\lambda) = \\mathbb{E}[\\exp(\\lambda X_1)]$。\n- 累积量生成函数 (CGF) 定义为 $\\Lambda(\\lambda) = \\ln M(\\lambda)$。\n- 指数倾斜定律的密度为 $q_{\\lambda}(x) \\propto \\exp(\\lambda x) p(x)$。\n- 倾斜参数 $\\lambda^{\\ast}(a)$ 由约束 $\\mathbb{E}_{\\lambda^{\\ast}}[X_1] = a$ 定义。\n- 目标是确定极限 $\\lim_{\\varepsilon \\downarrow 0}\\lim_{n \\to \\infty} \\mathbb{E}\\left[\\frac{1}{n}\\sum_{i=1}^{n} X_i^{2} \\,\\middle|\\, E_{n,\\varepsilon} \\right]$。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学基础**：该问题牢固地植根于大偏差这一数学理论，它是概率论中一个成熟的分支领域。所有定义，包括 MGF、CGF 和指数倾斜的定义，都是标准的。所指定的是指数分布，这是统计学中的一个基本概念。\n2.  **适定性**：该问题是适定的。它要求计算一个特定的极限，根据独立同分布随机变量的大偏差理论（Cramér 定理及其扩展），该极限预期存在且唯一。\n3.  **客观性**：该问题以精确、客观的数学语言陈述，没有歧义或主观看法。\n4.  **完整性与一致性**：该问题提供了进行求解所需的所有必要信息。条件 $a > 0$ 与指数分布的支撑集 $[0, \\infty)$ 一致。内部没有矛盾。\n\n### 步骤 3：结论与行动\n该问题是有效的。它是大偏差理论的一个标准应用。将提供完整的解答。\n\n### 解答推导\n\n该问题要求计算独立同分布的指数随机变量的经验二阶矩的典型值，其条件是它们的样本均值约等于 $a$ 这一罕见事件。这是大偏差理论中的一个典范问题。其核心原理是，以罕见事件 $\\{M_n \\approx a\\}$ 为条件，实际上是将单个随机变量 $X_i$ 的基础概率分布更改为一个“指数倾斜”分布。\n\n首先，我们刻画基础分布。PDF 为 $p(x) = \\exp(-x)$ (当 $x \\ge 0$ 时)，这是速率参数为 $1$ 的指数分布。我们将其记为 $X \\sim \\text{Exp}(1)$。\n\n$X_1$ 的矩生成函数 (MGF) 由下式给出\n$$M(\\lambda) = \\mathbb{E}[\\exp(\\lambda X_1)] = \\int_{0}^{\\infty} \\exp(\\lambda x) \\exp(-x) \\,dx = \\int_{0}^{\\infty} \\exp(-(1-\\lambda)x) \\,dx$$\n该积分在 $1-\\lambda > 0$ (即 $\\lambda < 1$) 时收敛。对于这样的 $\\lambda$，MGF 为\n$$M(\\lambda) = \\left[ -\\frac{1}{1-\\lambda} \\exp(-(1-\\lambda)x) \\right]_{0}^{\\infty} = 0 - \\left(-\\frac{1}{1-\\lambda}\\right) = \\frac{1}{1-\\lambda}$$\n累积量生成函数 (CGF) 是 MGF 的自然对数：\n$$\\Lambda(\\lambda) = \\ln M(\\lambda) = \\ln\\left(\\frac{1}{1-\\lambda}\\right) = -\\ln(1-\\lambda), \\quad \\text{for } \\lambda < 1$$\n\n接下来，我们分析指数倾斜分布。倾斜密度 $q_{\\lambda}(x)$ 定义为\n$$q_{\\lambda}(x) = \\frac{\\exp(\\lambda x) p(x)}{\\mathbb{E}[\\exp(\\lambda X_1)]} = \\frac{\\exp(\\lambda x) \\exp(-x)}{M(\\lambda)} = (1-\\lambda)\\exp(-(1-\\lambda)x)$$\n对于 $x \\ge 0$。这是一个新的指数分布的 PDF，其速率参数为 $\\theta_{\\lambda} = 1-\\lambda$。\n\n问题陈述，选择倾斜参数 $\\lambda^{\\ast}(a)$ 以强制执行倾斜分布下的均值为 $a$ 的约束。密度为 $q_{\\lambda}(x)$ 的随机变量 $X_{\\lambda}$ 的期望值可以直接从原始分布的 CGF 计算得出。一个标准结果是 $\\mathbb{E}_{\\lambda}[X_1] = \\Lambda'(\\lambda)$。\n我们来计算 CGF 的导数：\n$$\\Lambda'(\\lambda) = \\frac{d}{d\\lambda}(-\\ln(1-\\lambda)) = - \\frac{-1}{1-\\lambda} = \\frac{1}{1-\\lambda}$$\n我们令其等于 $a$ 来求解 $\\lambda^{\\ast}(a)$：\n$$\\Lambda'(\\lambda^{\\ast}) = \\frac{1}{1-\\lambda^{\\ast}} = a$$\n求解 $\\lambda^{\\ast}$ 可得 $1 = a(1-\\lambda^{\\ast})$，进而得到 $1 = a - a\\lambda^{\\ast}$，因此\n$$\\lambda^{\\ast}(a) = \\frac{a-1}{a} = 1 - \\frac{1}{a}$$\n由于 $a > 0$，我们有 $1/a > 0$，所以 $\\lambda^{\\ast}(a) = 1 - 1/a < 1$。此值在 CGF 的定义域内，因此倾斜是适定的。\n\n大偏差理论的核心结果（通常称为“条件大数定律”或 Sanov 定理的推论）指出，对于一个合适的函数 $f$：\n$$\\lim_{\\varepsilon \\downarrow 0}\\lim_{n \\to \\infty} \\mathbb{E}\\left[\\frac{1}{n}\\sum_{i=1}^{n} f(X_i) \\,\\middle|\\, |M_n - a| \\le \\varepsilon \\right] = \\mathbb{E}_{\\lambda^{\\ast}(a)}[f(X_1)]$$\n其中 $\\mathbb{E}_{\\lambda^{\\ast}(a)}[\\cdot]$ 表示关于倾斜分布 $q_{\\lambda^{\\ast}(a)}(x)$ 的期望。\n\n在这个问题中，函数是 $f(x) = x^2$。我们需要计算倾斜分布的二阶矩 $\\mathbb{E}_{\\lambda^{\\ast}(a)}[X_1^2]$。倾斜分布的矩也可以用原始 CGF $\\Lambda(\\lambda)$ 的导数来表示。倾斜分布的方差由 $\\text{Var}_{\\lambda}(X_1) = \\Lambda''(\\lambda)$ 给出。\nCGF 的二阶导数是：\n$$\\Lambda''(\\lambda) = \\frac{d}{d\\lambda}\\left(\\frac{1}{1-\\lambda}\\right) = \\frac{d}{d\\lambda}(1-\\lambda)^{-1} = (-1)(1-\\lambda)^{-2}(-1) = \\frac{1}{(1-\\lambda)^2}$$\n在倾斜定律下，二阶矩 $\\mathbb{E}_{\\lambda}[X_1^2]$ 与其均值和方差通过标准公式相关联：\n$$\\mathbb{E}_{\\lambda}[X_1^2] = \\text{Var}_{\\lambda}(X_1) + (\\mathbb{E}_{\\lambda}[X_1])^2 = \\Lambda''(\\lambda) + (\\Lambda'(\\lambda))^2$$\n我们需要在 $\\lambda = \\lambda^{\\ast}(a)$ 处计算该表达式的值。根据 $\\lambda^{\\ast}(a)$ 的定义，我们有 $\\Lambda'(\\lambda^{\\ast}(a)) = a$。\n接下来，我们在 $\\lambda^{\\ast}(a)$ 处计算二阶导数：\n$$\\Lambda''(\\lambda^{\\ast}(a)) = \\frac{1}{(1-\\lambda^{\\ast}(a))^2}$$\n根据条件 $\\Lambda'(\\lambda^{\\ast}(a)) = 1/(1-\\lambda^{\\ast}(a)) = a$，我们可以将其代入 $\\Lambda''(\\lambda^{\\ast}(a))$ 的表达式中：\n$$\\Lambda''(\\lambda^{\\ast}(a)) = \\left(\\frac{1}{1-\\lambda^{\\ast}(a)}\\right)^2 = a^2$$\n现在，我们可以整合倾斜测度下二阶矩的最终结果：\n$$\\mathbb{E}_{\\lambda^{\\ast}(a)}[X_1^2] = \\Lambda''(\\lambda^{\\ast}(a)) + (\\Lambda'(\\lambda^{\\ast}(a)))^2 = a^2 + a^2 = 2a^2$$\n因此，所求极限为 $2a^2$。\n作为一致性检验，注意到 $X_1$ 的无条件均值为 $\\mathbb{E}[X_1] = \\Lambda'(0) = 1$。如果我们设 $a=1$，即以其典型行为为条件。该公式给出 $2(1)^2=2$。无条件二阶矩为 $\\mathbb{E}[X_1^2] = \\Lambda''(0) + (\\Lambda'(0))^2 = 1/(1-0)^2 + (1/(1-0))^2 = 1+1=2$。结果是一致的。\n所以，该极限为：\n$$\\lim_{\\varepsilon \\downarrow 0}\\lim_{n \\to \\infty} \\mathbb{E}\\left[\\frac{1}{n}\\sum_{i=1}^{n} X_i^{2} \\,\\middle|\\, E_{n,\\varepsilon} \\right] = 2a^2$$\n该表达式给出了在经验均值被约束为 $a$ 的条件下，经验二阶矩的典型值。", "answer": "$$\n\\boxed{2a^2}\n$$", "id": "2972671"}, {"introduction": "理论的生命力在于应用，将解析公式转化为可计算的工具是科研和工程中的关键一步。本练习要求您将Cramér定理的核心思想——通过勒让德-芬切尔变换从累积量生成函数 $\\Lambda(\\lambda)$ 导出速率函数 $I(x)$——应用于一系列标准概率分布，并编写代码实现这一过程。这个计算实践不仅能加深您对高斯分布、伯努利分布和指数分布速率函数的理解，还能锻炼您将抽象理论具体化和通用化的能力。[@problem_id:2972677]", "problem": "考虑一个独立同分布 (i.i.d.) 的随机变量序列 $X_1, X_2, \\dots$ 及其经验均值 $S_n/n$，其中 $S_n = \\sum_{i=1}^n X_i$。在独立同分布变量之和的大偏差原理 (LDP) 背景下，并受到随机微分方程 (SDE) 的 Euler–Maruyama 离散化的启发，与 SDE $dX_t = a\\,dt + b\\,dW_t$ 相关联的、在固定时间步长 $\\Delta t$ 内的增量是独立同分布的高斯变量，其均值为 $a\\,\\Delta t$，方差为 $b^2\\,\\Delta t$。对于这类以及其他在 $0$ 附近具有良好定义的矩生成函数的参考分布，其经验均值的大偏差率函数存在且在其有效域上是有限的。\n\n任务：仅从基本定义出发，为每个指定分布推导出控制 $S_n/n$ 的大偏差率的数值可计算表达式，并实现该表达式以评估具体实例。从矩生成函数 $M(\\lambda) = \\mathbb{E}[e^{\\lambda X}]$ 及其对数（即累积量生成函数 $\\Lambda(\\lambda) = \\log M(\\lambda)$）的定义开始，结合基本的凸对偶和指数倾斜原理。利用这些工具，获得经验均值大偏差率的一个数值上易于处理的表征。\n\n您必须编写一个完整的程序，为以下测试套件计算大偏差率。每个测试用例指定一个分布以及评估率函数的点 $x$。所有参数都是无量纲的。您的程序必须生成单行输出，其中包含每个测试用例的率函数值，按顺序以逗号分隔，并用方括号括起来。\n\n测试套件：\n- 用例1（来自 SDE Euler 步的高斯增量）：$a = 0.2$, $b = 0.7$, $\\Delta t = 0.05$, $x = 0.11$。\n- 用例2（高斯边界检查）：$a = 0.2$, $b = 0.7$, $\\Delta t = 0.05$, $x = a\\,\\Delta t$。\n- 用例3（伯努利内点）：参数 $p = 0.3$, $x = 0.5$。\n- 用例4（伯努利边界点）：参数 $p = 0.3$, $x = 0$。\n- 用例5（率为 $\\beta$ 的指数分布）：参数 $\\beta = 2.0$, $x = 0.8$。\n\n输出规范：\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，例如“[result1,result2,result3,result4,result5]”。\n- 每个结果都必须是一个实数（浮点数），表示在给定点 $x$ 处为相应测试用例评估出的率函数值。", "solution": "该问题被评估为有效。它在科学上基于大偏差理论的原理，特别是 Cramér's theorem，并且在数学上是适定的。所有参数和分布都已明确定义，从而可以得到唯一且有意义的解。\n\n问题的核心是为独立同分布 (i.i.d.) 随机变量序列的经验均值找到大偏差率函数 $I(x)$。根据 Cramér's theorem，如果矩生成函数 (MGF) $M(\\lambda) = \\mathbb{E}[e^{\\lambda X}]$ 在 $\\lambda=0$ 的一个邻域内是有限的，那么率函数 $I(x)$ 由累积量生成函数 (CGF) $\\Lambda(\\lambda) = \\log M(\\lambda)$ 的 Legendre-Fenchel 变换给出。\n\nLegendre-Fenchel 变换定义为：\n$$\nI(x) = \\sup_{\\lambda \\in \\mathbb{R}} \\{\\lambda x - \\Lambda(\\lambda)\\}\n$$\nCGF 的一个关键性质是其凸性。这使得我们可以通过将表达式关于 $\\lambda$ 的导数设为零来找到上确界：\n$$\n\\frac{d}{d\\lambda} (\\lambda x - \\Lambda(\\lambda)) = x - \\Lambda'(\\lambda) = 0\n$$\n这产生临界方程 $\\Lambda'(\\lambda) = x$。我们求解此方程得到 $\\lambda$，设其解为 $\\lambda_x$。然后将此值代回原始表达式即可获得率函数：\n$$\nI(x) = \\lambda_x x - \\Lambda(\\lambda_x)\n$$\n我们将此过程应用于测试套件中指定的每种分布。\n\n### 用例1和2：高斯分布\n随机变量 $X$ 表示 SDE $dX_t = a\\,dt + b\\,dW_t$ 在一个时间步长 $\\Delta t$ 内的增量。该增量服从高斯分布 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$，其均值为 $\\mu = a\\,\\Delta t$，方差为 $\\sigma^2 = b^2\\,\\Delta t$。\n\n高斯随机变量的MGF是 $M(\\lambda) = e^{\\lambda \\mu + \\frac{1}{2}\\lambda^2 \\sigma^2}$。\nCGF是 $\\Lambda(\\lambda) = \\log M(\\lambda) = \\lambda \\mu + \\frac{1}{2}\\lambda^2 \\sigma^2$。\nCGF的导数是 $\\Lambda'(\\lambda) = \\mu + \\lambda \\sigma^2$。\n\n求解 $\\Lambda'(\\lambda) = x$：\n$$\n\\mu + \\lambda \\sigma^2 = x \\implies \\lambda_x = \\frac{x - \\mu}{\\sigma^2}\n$$\n将 $\\lambda_x$ 代入 $I(x)$ 的表达式：\n$$\nI(x) = \\left(\\frac{x - \\mu}{\\sigma^2}\\right)x - \\left(\\left(\\frac{x - \\mu}{\\sigma^2}\\right)\\mu + \\frac{1}{2}\\left(\\frac{x - \\mu}{\\sigma^2}\\right)^2\\sigma^2\\right)\n$$\n$$\nI(x) = \\frac{x(x - \\mu)}{\\sigma^2} - \\frac{\\mu(x - \\mu)}{\\sigma^2} - \\frac{(x - \\mu)^2}{2\\sigma^2} = \\frac{(x - \\mu)^2}{\\sigma^2} - \\frac{(x - \\mu)^2}{2\\sigma^2}\n$$\n$$\nI(x) = \\frac{(x - \\mu)^2}{2\\sigma^2}\n$$\n对于用例1，参数为 $a = 0.2$, $b = 0.7$, $\\Delta t = 0.05$ 且 $x = 0.11$。因此，$\\mu = 0.2 \\times 0.05 = 0.01$ 且 $\\sigma^2 = 0.7^2 \\times 0.05 = 0.0245$。\n对于用例2，$x = a\\,\\Delta t = \\mu$，这直接意味着 $I(x) = 0$。\n\n### 用例3和4：伯努利分布\n随机变量 $X$ 服从伯努利分布 $X \\sim \\text{Bernoulli}(p)$，其中 $P(X=1) = p$ 且 $P(X=0) = 1-p$。均值 $x$ 的有效域是区间 $[0, 1]$。\n\nMGF是 $M(\\lambda) = \\mathbb{E}[e^{\\lambda X}] = p e^{\\lambda \\cdot 1} + (1-p)e^{\\lambda \\cdot 0} = p e^\\lambda + 1-p$。\nCGF是 $\\Lambda(\\lambda) = \\log(p e^\\lambda + 1-p)$。\n导数是 $\\Lambda'(\\lambda) = \\frac{p e^\\lambda}{p e^\\lambda + 1-p}$。\n\n对于 $x \\in (0, 1)$，我们求解 $\\Lambda'(\\lambda) = x$：\n$$\n\\frac{p e^\\lambda}{p e^\\lambda + 1-p} = x \\implies p e^\\lambda = x(p e^\\lambda + 1-p) \\implies e^\\lambda(p - xp) = x(1-p) \\implies e^\\lambda = \\frac{x(1-p)}{p(1-x)}\n$$\n这得到 $\\lambda_x = \\log\\left(\\frac{x(1-p)}{p(1-x)}\\right)$。代入 $I(x)$ 的表达式：\n$$\nI(x) = x \\log\\left(\\frac{x(1-p)}{p(1-x)}\\right) - \\log\\left(p \\frac{x(1-p)}{p(1-x)} + 1-p\\right)\n$$\n$$\nI(x) = x \\log\\left(\\frac{x}{p}\\right) + x \\log\\left(\\frac{1-p}{1-x}\\right) - \\log\\left(\\frac{x(1-p) + (1-p)(1-x)}{1-x}\\right)\n$$\n$$\nI(x) = x \\log\\left(\\frac{x}{p}\\right) + x \\log\\left(\\frac{1-p}{1-x}\\right) - \\log\\left(\\frac{1-p}{1-x}\\right) = x \\log\\left(\\frac{x}{p}\\right) + (x-1)\\log\\left(\\frac{1-p}{1-x}\\right)\n$$\n$$\nI(x) = x \\log\\left(\\frac{x}{p}\\right) + (1-x)\\log\\left(\\frac{1-x}{1-p}\\right)\n$$\n这是 Kullback-Leibler 散度，记为 $D_{\\text{KL}}(\\text{Bernoulli}(x) || \\text{Bernoulli}(p))$。\n\n对于边界情况的用例4，其中 $x=0$，上述公式不直接适用。我们必须评估 $I(0) = \\sup_{\\lambda} \\{0 \\cdot \\lambda - \\Lambda(\\lambda)\\} = -\\inf_{\\lambda} \\Lambda(\\lambda)$。\n由于 $\\Lambda(\\lambda) = \\log(p e^\\lambda + 1-p)$ 是 $\\lambda$ 的增函数，其下确界在 $\\lambda \\to -\\infty$ 时取到。\n$$\n\\inf_{\\lambda} \\Lambda(\\lambda) = \\lim_{\\lambda \\to -\\infty} \\log(p e^\\lambda + 1-p) = \\log(1-p)\n$$\n因此，对于 $x=0$，率函数为 $I(0) = -\\log(1-p)$。这与通用公式在 $x \\to 0$ 时的极限一致。\n\n### 用例5：指数分布\n随机变量 $X$ 服从率为 $\\beta$ 的指数分布，$X \\sim \\text{Exponential}(\\beta)$。其概率密度函数(PDF)为 $f(x) = \\beta e^{-\\beta x}$（对于 $x \\ge 0$）。均值为 $\\mathbb{E}[X] = 1/\\beta$。\n\nMGF为 $M(\\lambda) = \\mathbb{E}[e^{\\lambda X}] = \\int_0^\\infty e^{\\lambda x} \\beta e^{-\\beta x} dx = \\frac{\\beta}{\\beta-\\lambda}$，当 $\\lambda < \\beta$ 时收敛。\nCGF为 $\\Lambda(\\lambda) = \\log(\\beta) - \\log(\\beta-\\lambda)$。\n导数为 $\\Lambda'(\\lambda) = \\frac{1}{\\beta-\\lambda}$。\n\n对于 $x > 0$，求解 $\\Lambda'(\\lambda) = x$：\n$$\n\\frac{1}{\\beta-\\lambda} = x \\implies 1 = x(\\beta-\\lambda) \\implies \\lambda_x = \\beta - \\frac{1}{x}\n$$\n对于 $x > 0$，条件 $\\lambda_x < \\beta$ 得到满足。将 $\\lambda_x$ 代入求 $I(x)$：\n$$\nI(x) = \\left(\\beta - \\frac{1}{x}\\right)x - \\left(\\log(\\beta) - \\log\\left(\\beta - \\left(\\beta - \\frac{1}{x}\\right)\\right)\\right)\n$$\n$$\nI(x) = \\beta x - 1 - (\\log(\\beta) - \\log(1/x)) = \\beta x - 1 - (\\log(\\beta) - (-\\log x)) = \\beta x - 1 - \\log(\\beta) - \\log(x)\n$$\n$$\nI(x) = \\beta x - \\log(\\beta x) - 1\n$$\n此公式适用于用例5，其中 $\\beta = 2.0$ 且 $x = 0.8$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the large deviations rate function for specified distributions and points.\n    \"\"\"\n\n    def rate_gaussian(params):\n        \"\"\"\n        Computes the rate function I(x) for a Gaussian distribution.\n        I(x) = (x - mu)^2 / (2 * sigma^2)\n        \"\"\"\n        a, b, dt, x = params['a'], params['b'], params['dt'], params['x']\n        mu = a * dt\n        var = b**2 * dt\n        if var == 0:\n            return 0.0 if x == mu else np.inf\n        return (x - mu)**2 / (2 * var)\n\n    def rate_bernoulli(params):\n        \"\"\"\n        Computes the rate function I(x) for a Bernoulli distribution.\n        This is the Kullback-Leibler divergence D_KL(Bernoulli(x) || Bernoulli(p)).\n        I(x) = x*log(x/p) + (1-x)*log((1-x)/(1-p))\n        \"\"\"\n        p, x = params['p'], params['x']\n        \n        # Validate inputs to avoid division by zero or log of non-positive numbers\n        if p <= 0 or p >= 1:\n            raise ValueError(\"Bernoulli parameter p must be in (0, 1).\")\n        if x < 0 or x > 1:\n            # The rate is infinite outside the support of the sample mean.\n            return np.inf\n\n        # Handle boundary cases for x to avoid numerical issues (e.g., 0*log(0))\n        if x == p:\n            return 0.0\n        if x == 0:\n            return -np.log(1 - p)\n        if x == 1:\n            return -np.log(p)\n            \n        # General case for x in (0, 1)\n        term1 = x * np.log(x / p)\n        term2 = (1 - x) * np.log((1 - x) / (1 - p))\n        return term1 + term2\n\n    def rate_exponential(params):\n        \"\"\"\n        Computes the rate function I(x) for an Exponential distribution.\n        I(x) = beta*x - log(beta*x) - 1\n        \"\"\"\n        beta, x = params['beta'], params['x']\n        \n        if beta <= 0:\n            raise ValueError(\"Exponential rate parameter beta must be positive.\")\n        if x <= 0:\n            # The rate is infinite for x outside the support (0, inf).\n            return np.inf\n        \n        if x == 1.0 / beta:\n            return 0.0\n        \n        return beta * x - np.log(beta * x) - 1\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (Gaussian)\n        {'type': 'gaussian', 'params': {'a': 0.2, 'b': 0.7, 'dt': 0.05, 'x': 0.11}},\n        # Case 2 (Gaussian)\n        {'type': 'gaussian', 'params': {'a': 0.2, 'b': 0.7, 'dt': 0.05, 'x': 0.2 * 0.05}},\n        # Case 3 (Bernoulli)\n        {'type': 'bernoulli', 'params': {'p': 0.3, 'x': 0.5}},\n        # Case 4 (Bernoulli)\n        {'type': 'bernoulli', 'params': {'p': 0.3, 'x': 0.0}},\n        # Case 5 (Exponential)\n        {'type': 'exponential', 'params': {'beta': 2.0, 'x': 0.8}},\n    ]\n\n    dispatch = {\n        'gaussian': rate_gaussian,\n        'bernoulli': rate_bernoulli,\n        'exponential': rate_exponential,\n    }\n\n    results = []\n    for case in test_cases:\n        case_type = case['type']\n        case_params = case['params']\n        \n        if case_type in dispatch:\n            result = dispatch[case_type](case_params)\n            results.append(result)\n        else:\n            raise ValueError(f\"Unknown case type: {case_type}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2972677"}]}