{"hands_on_practices": [{"introduction": "本练习旨在揭示随机过程与光滑函数的根本区别。我们将通过分析布朗运动的分段线性近似，亲手计算其二次变差，你会发现，当近似越来越精细时，其二次变差并不会像光滑函数那样趋向于零。这个非零的极限正是随机微积分（包括Wong-Zakai定理）成立的基石，它解释了为什么我们需要一套全新的微积分法则。[@problem_id:3004534]", "problem": "设 $\\{W_{t}\\}_{t \\in [0,T]}$ 为一个带滤概率空间 $(\\Omega,\\mathcal{F},\\{\\mathcal{F}_{t}\\}_{t \\ge 0},\\mathbb{P})$ 上的标准一维布朗运动，且 $W_{0}=0$。对于 $\\delta>0$，考虑均匀划分 $\\mathcal{P}_{\\delta}=\\{t_{k}=k\\delta: k=0,1,\\dots,N_{\\delta}\\}$，其中 $N_{\\delta}=\\lfloor T/\\delta \\rfloor$，并定义多边形（分段线性）插值 $W^{\\delta}$ 为\n$$\nW^{\\delta}_{t} \\;=\\; W_{t_{k}} \\;+\\; \\frac{t-t_{k}}{t_{k+1}-t_{k}}\\Big(W_{t_{k+1}}-W_{t_{k}}\\Big), \\quad t \\in [t_{k},t_{k+1}), \\quad k=0,1,\\dots,N_{\\delta}-1.\n$$\n对于 $t \\in [0,T]$，定义 $W^{\\delta}$ 沿其构造划分的网格二次变差为\n$$\n[W^{\\delta}]_{t} \\;=\\; \\sum_{k=0}^{N_{t}^{\\delta}-1} \\Big(W^{\\delta}_{t_{k+1}}-W^{\\delta}_{t_{k}}\\Big)^{2}, \\quad \\text{其中} \\quad N_{t}^{\\delta}=\\left\\lfloor \\frac{t}{\\delta} \\right\\rfloor.\n$$\n仅从布朗运动的定义性质（具有平稳独立高斯增量，且 $\\mathbb{E}[W_{t}]=0$ 和 $\\operatorname{Var}(W_{t})=t$）以及上述定义出发，完成以下任务：\n\n1) 将 $[W^{\\delta}]_{t}$ 用布朗增量 $\\Delta W_{k}=W_{t_{k+1}}-W_{t_{k}}$ 表示。\n\n2) 证明当 $\\delta \\to 0$ 时，$[W^{\\delta}]_{t}$ 依概率收敛于 $t$，并且沿着二进序列 $\\delta_{n}=2^{-n}$，有几乎必然收敛 $[W^{\\delta_{n}}]_{t} \\to t$。\n\n3) 仅使用基本定义，简要解释在 Wong–Zakai 设定下，当 $\\delta \\to 0$ 时，这个极限如何确定由 $W^{\\delta}$ 驱动的常微分方程解的有效极限微积分。\n\n请给出当 $\\delta \\to 0$ 时 $[W^{\\delta}]_{t}$ 的极限的精确闭式表达式作为最终答案（无单位）。最终答案必须是单一的解析表达式。", "solution": "这个问题是随机分析中一个有效且适定的练习。它要求通过分析布朗运动的多边形近似来证明其一个基本性质——非零的二次变差。所有定义都是标准的，任务在数学上是合理的。\n\n解答按要求分为三个部分进行。\n\n第1部分：$[W^{\\delta}]_{t}$ 的表达式\n\n问题将多边形近似 $W^{\\delta}$ 的网格二次变差定义为\n$$\n[W^{\\delta}]_{t} \\;=\\; \\sum_{k=0}^{N_{t}^{\\delta}-1} \\Big(W^{\\delta}_{t_{k+1}}-W^{\\delta}_{t_{k}}\\Big)^{2}\n$$\n其中 $t_k = k\\delta$ 是划分 $\\mathcal{P}_{\\delta}$ 的点，且 $N_{t}^{\\delta}=\\lfloor t/\\delta \\rfloor$。这部分的核心是计算增量 $W^{\\delta}_{t_{k+1}}-W^{\\delta}_{t_{k}}$。\n\n多边形插值 $W^{\\delta}_{t}$ 在区间 $t \\in [t_{k}, t_{k+1})$ 上定义为\n$$\nW^{\\delta}_{t} \\;=\\; W_{t_{k}} \\;+\\; \\frac{t-t_{k}}{t_{k+1}-t_{k}}\\Big(W_{t_{k+1}}-W_{t_{k}}\\Big)\n$$\n根据构造，该插值在划分点 $t_k$ 处与原始布朗运动 $W_{t}$ 相匹配。为验证这一点，我们计算 $W^{\\delta}_{t}$ 在 $t=t_k$ 处的值：\n$$\nW^{\\delta}_{t_{k}} \\;=\\; W_{t_{k}} \\;+\\; \\frac{t_{k}-t_{k}}{t_{k+1}-t_{k}}\\Big(W_{t_{k+1}}-W_{t_{k}}\\Big) \\;=\\; W_{t_{k}} \\;+\\; 0 \\cdot \\Big(W_{t_{k+1}}-W_{t_{k}}\\Big) \\;=\\; W_{t_{k}}\n$$\n为了找到在 $t_{k+1}$ 处的值，我们考虑划分中的下一个区间，该区间从 $t_{k+1}$ 开始。应用相同的公式，但索引加一。将 $t=t_{k+1}$ 代入区间 $[t_{k+1}, t_{k+2})$ 的定义中可得：\n$$\nW^{\\delta}_{t_{k+1}} \\;=\\; W_{t_{k+1}} \\;+\\; \\frac{t_{k+1}-t_{k+1}}{t_{k+2}-t_{k+1}}\\Big(W_{t_{k+2}}-W_{t_{k+1}}\\Big) \\;=\\; W_{t_{k+1}}\n$$\n因此，在两个连续划分点之间，多边形近似的增量与布朗运动本身的增量相同：\n$$\nW^{\\delta}_{t_{k+1}}-W^{\\delta}_{t_{k}} \\;=\\; W_{t_{k+1}}-W_{t_{k}}\n$$\n问题将此增量记为 $\\Delta W_{k}$。将其代入 $[W^{\\delta}]_{t}$ 的定义，我们得到：\n$$\n[W^{\\delta}]_{t} \\;=\\; \\sum_{k=0}^{N_{t}^{\\delta}-1} (W_{t_{k+1}}-W_{t_{k}})^{2} \\;=\\; \\sum_{k=0}^{N_{t}^{\\delta}-1} (\\Delta W_{k})^{2}\n$$\n\n第2部分：收敛性证明\n\n令 $S_{t}^{\\delta} = [W^{\\delta}]_{t} = \\sum_{k=0}^{N_{t}^{\\delta}-1} (\\Delta W_{k})^{2}$。我们已知布朗运动具有平稳、独立的高斯增量。在时长为 $t_{k+1}-t_k = \\delta$ 的时间区间上的增量 $\\Delta W_{k} = W_{t_{k+1}}-W_{t_{k}}$ 是一个均值为 $0$、方差为 $\\delta$ 的正态随机变量，即 $\\Delta W_k \\sim \\mathcal{N}(0, \\delta)$。\n我们可以将 $\\Delta W_k$ 表示为标准正态变量 $Z_k \\sim \\mathcal{N}(0, 1)$ 的形式，即 $\\Delta W_k = \\sqrt{\\delta}Z_k$，其中 $\\{Z_k\\}$ 是一系列独立同分布（i.i.d.）的随机变量。\n因此，$S_{t}^{\\delta}$ 可以重写为：\n$$\nS_{t}^{\\delta} \\;=\\; \\sum_{k=0}^{N_{t}^{\\delta}-1} (\\sqrt{\\delta} Z_k)^2 \\;=\\; \\delta \\sum_{k=0}^{N_{t}^{\\delta}-1} Z_k^2\n$$\n为证明收敛性，我们首先计算 $S_{t}^{\\delta}$ 的期望。$Z_k^2$ 的期望是 $\\mathbb{E}[Z_k^2] = \\operatorname{Var}(Z_k) + (\\mathbb{E}[Z_k])^2 = 1 + 0^2 = 1$。\n$$\n\\mathbb{E}[S_{t}^{\\delta}] \\;=\\; \\mathbb{E}\\left[\\delta \\sum_{k=0}^{N_{t}^{\\delta}-1} Z_k^2\\right] \\;=\\; \\delta \\sum_{k=0}^{N_{t}^{\\delta}-1} \\mathbb{E}[Z_k^2] \\;=\\; \\delta \\cdot N_{t}^{\\delta} \\cdot 1 \\;=\\; \\delta N_{t}^{\\delta}\n$$\n由于 $N_{t}^{\\delta} = \\lfloor t/\\delta \\rfloor$，我们有不等式 $t/\\delta - 1 < N_{t}^{\\delta} \\le t/\\delta$，这意味着 $t-\\delta < \\delta N_{t}^{\\delta} \\le t$。当 $\\delta \\to 0$ 时，我们得出结论 $\\lim_{\\delta \\to 0} \\mathbb{E}[S_{t}^{\\delta}] = t$。\n\n为了证明依概率收敛，我们证明 $L^2$ 收敛，这是一种更强的收敛模式。这需要证明 $\\mathbb{E}[(S_{t}^{\\delta} - t)^2] \\to 0$。我们分解均方误差：\n$$\n\\mathbb{E}[(S_{t}^{\\delta} - t)^2] = \\operatorname{Var}(S_{t}^{\\delta}) + (\\mathbb{E}[S_{t}^{\\delta}]-t)^2\n$$\n我们已经证明了 $(\\mathbb{E}[S_{t}^{\\delta}]-t)^2 \\to 0$。现在我们计算方差。由于 $Z_k$ 是独立的，所以 $Z_k^2$ 也是独立的。\n$$\n\\operatorname{Var}(S_{t}^{\\delta}) \\;=\\; \\operatorname{Var}\\left(\\delta \\sum_{k=0}^{N_{t}^{\\delta}-1} Z_k^2\\right) \\;=\\; \\delta^2 \\sum_{k=0}^{N_{t}^{\\delta}-1} \\operatorname{Var}(Z_k^2)\n$$\n$Z_k^2$ 的方差是 $\\operatorname{Var}(Z_k^2) = \\mathbb{E}[Z_k^4] - (\\mathbb{E}[Z_k^2])^2$。对于一个标准正态变量，其四阶矩是 $\\mathbb{E}[Z_k^4] = 3$。因此，$\\operatorname{Var}(Z_k^2) = 3 - 1^2 = 2$。\n$$\n\\operatorname{Var}(S_{t}^{\\delta}) \\;=\\; \\delta^2 \\sum_{k=0}^{N_{t}^{\\delta}-1} 2 \\;=\\; 2\\delta^2 N_{t}^{\\delta}\n$$\n使用界 $N_{t}^{\\delta} \\le t/\\delta$，我们得到 $\\operatorname{Var}(S_{t}^{\\delta}) \\le 2\\delta^2 (t/\\delta) = 2t\\delta$。当 $\\delta \\to 0$ 时，$\\operatorname{Var}(S_{t}^{\\delta}) \\to 0$。\n由于均方误差中的两项都趋于零，所以 $\\mathbb{E}[(S_{t}^{\\delta} - t)^2] \\to 0$。这意味着 $S_{t}^{\\delta}$ 在 $L^2$ 中收敛于 $t$，因此依概率收敛于 $t$。\n\n对于沿二进序列 $\\delta_n = 2^{-n}$ 的几乎必然收敛，我们令 $S_n = S_t^{\\delta_n}$。我们应用 Chebyshev 不等式和 Borel-Cantelli 引理。对于任何 $\\epsilon > 0$：\n$$\n\\mathbb{P}(|S_n - \\mathbb{E}[S_n]| > \\epsilon) \\le \\frac{\\operatorname{Var}(S_n)}{\\epsilon^2}\n$$\n方差为 $\\operatorname{Var}(S_n) = 2\\delta_n^2 N_{t}^{\\delta_n} \\le 2t\\delta_n = 2t \\cdot 2^{-n}$。所以，\n$$\n\\sum_{n=1}^{\\infty} \\mathbb{P}(|S_n - \\mathbb{E}[S_n]| > \\epsilon) \\le \\sum_{n=1}^{\\infty} \\frac{2t \\cdot 2^{-n}}{\\epsilon^2} = \\frac{2t}{\\epsilon^2} \\sum_{n=1}^{\\infty} \\left(\\frac{1}{2}\\right)^n\n$$\n这是一个收敛的几何级数。根据第一 Borel-Cantelli 引理，$S_n - \\mathbb{E}[S_n]$ 几乎必然收敛于 $0$。又因为我们已知 $\\mathbb{E}[S_n] \\to t$，所以我们可以得出结论，$S_n$ 几乎必然收敛于 $t$。\n\n第3部分：与 Wong-Zakai 定理的联系\n\nWong-Zakai 定理研究由随机过程（如白噪声）的平滑近似驱动的常微分方程（ODE）解的极限。在我们的问题中，方程为 $dy^{\\delta}_{t} = f(y^{\\delta}_{t}) dW^{\\delta}_{t}$，其中 $W^{\\delta}_{t}$ 是一个分段可微函数。对于任何有限的 $\\delta > 0$，这是一个标准的 ODE，其解遵循普通微积分的法则，包括经典的链式法则：$d(g(y^{\\delta}_{t})) = g'(y^{\\delta}_{t}) dy^{\\delta}_{t}$。\n\n当 $\\delta \\to 0$ 时，近似 $W^{\\delta}_{t}$ 收敛于布朗运动 $W_t$，而解 $y^{\\delta}_{t}$ 收敛于一个随机微分方程（SDE）的解 $Y_t$。核心问题是确定极限 SDE 的正确“微积分”类型（Itō 或 Stratonovich）。\n\n微积分类型的选择取决于二次变差的行为。在普通微积分中，任何平滑函数的二次变差都为零。例如，对于一个 $C^1$ 函数 $\\phi(t)$，其增量平方和为 $\\sum (\\phi(t_{k+1})-\\phi(t_k))^2 \\approx \\sum (\\phi'(t_k)\\delta)^2 = \\delta \\sum (\\phi'(t_k))^2\\delta \\to 0$（当 $\\delta \\to 0$ 时）。普通微积分的法则依赖于此性质。\n\n然而，正如我们在第2部分证明的，布朗运动近似的二次变差在极限下不为零：$[W^{\\delta}]_t \\to t$。极限过程 $W_t$ 具有非零的二次变差，即 $[W]_t = t$。正是这一决定性特征，使得一种特殊的随机分析成为必要。\n\nStratonovich 积分的定义方式保留了经典的链式法则，就像关于 $y^{\\delta}_{t}$ 的 ODE 一样。因此，ODE 解 $y^{\\delta}_{t}$ 收敛于 Stratonovich SDE $dY_t = f(Y_t) \\circ dW_t$ 的解是自然的。近似所遵循的微积分结构在极限中得以保持。\n\n相比之下，Itō 积分使用非预见性被积函数来定义，这导致了不同的链式法则（Itō 引理），其中包含一个二阶项：$d(g(Y_t)) = g'(Y_t)f(Y_t)dW_t + \\frac{1}{2}g''(Y_t)f(Y_t)^2 dt$（对于 Itō SDE $dY_t=f(Y_t)dW_t$）。这个修正项是规则 $(dW_t)^2 = dt$ 的直接结果，即布朗运动的非零二次变差。\n\n总而言之，$[W^{\\delta}]_t \\to t$ 的结果表明，平滑近似 $W^{\\delta}_t$ 将布朗运动的非零二次变差“带入”了极限。由于极限前的 ODE 遵循普通微积分法则，极限 SDE 必须是同样能保留这些法则的类型，而这正是 Stratonovich SDE。", "answer": "$$\\boxed{t}$$", "id": "3004534"}, {"introduction": "在处理随机微分方程时，我们采用的离散化近似方式将直接决定其极限形式的数学解释。本练习通过对比两种不同的布朗运动近似方法——一种是简单的“前向步长”近似，另一种是对称的分段线性插值——来阐明这一点。通过分析，你将理解为何前者自然地导向伊东（Itô）积分，而后者则对应于斯特拉托诺维奇（Stratonovich）积分，从而深刻理解Wong-Zakai定理为何与斯特拉托诺维奇积分紧密相关。[@problem_id:3004504]", "problem": "设 $W = (W_t)_{t \\in [0,T]}$ 为一个一维标准布朗运动，定义在一个满足通常条件的带滤概率空间 $(\\Omega, \\mathcal{F}, (\\mathcal{F}_t)_{t \\in [0,T]}, \\mathbb{P})$ 上。设 $(\\pi^\\delta)_{\\delta > 0}$ 为 $[0,T]$ 上的一列均匀划分，其步长为 $\\delta$，其中 $t_k^\\delta = k \\delta$ 对于 $k = 0, 1, \\dots, \\lfloor T/\\delta \\rfloor$，且 $t_{\\lfloor T/\\delta \\rfloor + 1}^\\delta = T$。考虑一个函数 $f \\in C^2(\\mathbb{R})$，其至多为多项式增长。定义 $W$ 的两种逐路径近似：\n\n- 前向欧拉阶梯近似 $W^\\delta$，定义为 $W^\\delta(t) = W(t_k^\\delta)$ 对于 $t \\in [t_k^\\delta, t_{k+1}^\\delta)$，且 $W^\\delta(T) = W(T)$。\n\n- 对称分段线性插值 $\\widetilde{W}^\\delta$，定义为 $\\widetilde{W}^\\delta(t) = W(t_k^\\delta) + \\frac{t - t_k^\\delta}{t_{k+1}^\\delta - t_k^\\delta}\\bigl(W(t_{k+1}^\\delta) - W(t_k^\\delta)\\bigr)$ 对于 $t \\in [t_k^\\delta, t_{k+1}^\\delta]$。\n\n对于前向阶梯近似 $W^\\delta$，Lebesgue–Stieltjes 积分 $\\int_0^T f(W^\\delta(t)) \\, dW^\\delta(t)$ 化为跳跃和 $\\sum_{k} f(W(t_k^\\delta)) \\bigl(W(t_{k+1}^\\delta) - W(t_k^\\delta)\\bigr)$，因为 $W^\\delta$ 是有界变差的，并且仅在网格点处有跳跃。对于对称插值 $\\widetilde{W}^\\delta$，考虑对称 Riemann 和 $\\sum_k \\frac{f(W(t_k^\\delta)) + f(W(t_{k+1}^\\delta))}{2} \\bigl(W(t_{k+1}^\\delta) - W(t_k^\\delta)\\bigr)$ 作为随机积分的一种近似。\n\n另外，对于由光滑信号驱动的状态过程 $X^\\delta$，考虑确定性常微分方程 (ODE) $dX^\\delta_t = b(X^\\delta_t) \\, dt + \\sigma(X^\\delta_t) \\, \\dot{\\widetilde{W}}^\\delta_t \\, dt$，初值为 $X^\\delta_0 = x_0$，其中 $b, \\sigma \\in C^2(\\mathbb{R})$ 至多为多项式增长，且 $\\dot{\\widetilde{W}}^\\delta_t$ 表示 $\\widetilde{W}^\\delta$ 在每个子区间上的经典时间导数。\n\n仅使用 Itô 积分（作为简单可料过程的随机积分的 $L^2$ 极限）、Stratonovich 积分（作为满足经典链式法则的对称 Riemann 和的极限）以及布朗运动二次变差（离散二次变差的极限等于 $t$）的基本定义，选择所有关于当 $\\delta \\to 0$ 时的极限行为的正确陈述：\n\nA. 对于 $W^\\delta$，积分 $\\int_0^T f(W^\\delta(t)) \\, dW^\\delta(t) = \\sum_k f(W(t_k^\\delta)) \\bigl(W(t_{k+1}^\\delta) - W(t_k^\\delta)\\bigr)$ 在 $L^2$ 中收敛于 Itô 积分 $\\int_0^T f(W_t) \\, dW_t$。\n\nB. 对于 $\\widetilde{W}^\\delta$，对称和 $\\sum_k \\frac{f(W(t_k^\\delta)) + f(W(t_{k+1}^\\delta))}{2} \\bigl(W(t_{k+1}^\\delta) - W(t_k^\\delta)\\bigr)$ 依概率收敛于 Stratonovich 积分 $\\int_0^T f(W_t) \\circ dW_t$，并且有 $\\int_0^T f(W_t) \\circ dW_t = \\int_0^T f(W_t) \\, dW_t + \\frac{1}{2} \\int_0^T f'(W_t) \\, dt$。\n\nC. 对于由 $\\dot{\\widetilde{W}}^\\delta$ 驱动的 ODE，其 Wong–Zakai 极限是 Itô 随机微分方程 (SDE) $dX_t = b(X_t) \\, dt + \\sigma(X_t) \\, dW_t$，且没有任何修正项；必须随后添加一个漂移修正项才能将其重写为 Stratonovich 形式。\n\nD. 对于 $W^\\delta$，极限积分是 Stratonovich 积分，因为对于分段常数近似，二次变差消失，因此经典 Riemann–Stieltjes 理论适用。\n\nE. 在两种近似中，经典链式法则在极限情况下都成立，无需任何修正项，因为近似路径在每个网格区间上要么是有界变差的，要么是光滑的。\n\n选择所有适用项。", "solution": "问题陈述提出了一系列关于随机积分的离散近似的收敛性以及由布朗运动近似驱动的常微分方程解的问题。在继续之前，我们必须验证问题陈述的有效性。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- $W = (W_t)_{t \\in [0,T]}$：一个一维标准布朗运动。\n- 满足通常条件的带滤概率空间 $(\\Omega, \\mathcal{F}, (\\mathcal{F}_t)_{t \\in [0,T]}, \\mathbb{P})$。\n- $(\\pi^\\delta)_{\\delta > 0}$：$[0,T]$ 上的均匀划分序列，步长为 $\\delta$。\n- $t_k^\\delta = k \\delta$ 对于 $k = 0, 1, \\dots, \\lfloor T/\\delta \\rfloor$，且 $t_{\\lfloor T/\\delta \\rfloor + 1}^\\delta = T$。\n- $f \\in C^2(\\mathbb{R})$，至多为多项式增长。\n- 前向欧拉阶梯近似 $W^\\delta$：$W^\\delta(t) = W(t_k^\\delta)$ 对于 $t \\in [t_k^\\delta, t_{k+1}^\\delta)$，且 $W^\\delta(T) = W(T)$。\n- 对称分段线性插值 $\\widetilde{W}^\\delta$：$\\widetilde{W}^\\delta(t) = W(t_k^\\delta) + \\frac{t - t_k^\\delta}{t_{k+1}^\\delta - t_k^\\delta}\\bigl(W(t_{k+1}^\\delta) - W(t_k^\\delta)\\bigr)$ 对于 $t \\in [t_k^\\delta, t_{k+1}^\\delta]$。\n- $W^\\delta$ 的积分：$\\int_0^T f(W^\\delta(t)) \\, dW^\\delta(t) = \\sum_{k} f(W(t_k^\\delta)) \\bigl(W(t_{k+1}^\\delta) - W(t_k^\\delta)\\bigr)$。\n- $\\widetilde{W}^\\delta$ 的对称和：$\\sum_k \\frac{f(W(t_k^\\delta)) + f(W(t_{k+1}^\\delta))}{2} \\bigl(W(t_{k+1}^\\delta) - W(t_k^\\delta)\\bigr)$。\n- ODE: $dX^\\delta_t = b(X^\\delta_t) \\, dt + \\sigma(X^\\delta_t) \\, \\dot{\\widetilde{W}}^\\delta_t \\, dt$，初值为 $X^\\delta_0 = x_0$，其中 $b, \\sigma \\in C^2(\\mathbb{R})$ 至多为多项式增长。\n- $\\dot{\\widetilde{W}}^\\delta_t$ 是 $\\widetilde{W}^\\delta$ 的经典时间导数。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在随机微积分这一数学学科中是良定义的。\n- **科学依据：** 布朗运动、Itô 和 Stratonovich 积分、逐路径近似以及 Wong-Zakai 定理等概念都是随机分析的基石。该问题牢固地建立在已有的数学理论之上。\n- **良态的：** 问题要求评估关于众所周知的极限行为的几个陈述的真伪。对函数 $f, b, \\sigma$ 的假设（$C^2$ 且为多项式增长）是标准的，足以确保所涉及的随机过程和积分的存在性和唯一性。\n- **客观性：** 语言是形式化和数学化的，没有主观性或歧义。\n- **不完整或矛盾的设置：** 问题提供了所有必要的定义和条件。对近似和求和的描述是明确且标准的。没有矛盾之处。\n\n**步骤 3：结论与行动**\n问题陈述是有效的。它代表了对随机积分理论中基本概念的一次标准考察。我们可以继续进行选项分析。\n\n### 解答与选项分析\n\n设 $\\Delta W_k^\\delta = W(t_{k+1}^\\delta) - W(t_k^\\delta)$。问题要求我们分析当 $\\delta \\to 0$ 时，几个和式以及一个微分方程的极限行为。\n\n**选项 A 分析**\n\n该选项涉及和式 $S_A^\\delta = \\sum_k f(W(t_k^\\delta)) \\Delta W_k^\\delta$。这是随机积分 $\\int_0^T f(W_t) \\, dW_t$ 的一种 Riemann 型和。这个和式的关键特征是，被积函数 $f(W(t_k^\\delta))$ 是在时间区间 $[t_k^\\delta, t_{k+1}^\\delta]$ 的左端点处取值的。\n\n一个适应过程 $H_t$ 的 Itô 积分 $\\int_0^T H_t \\, dW_t$ 被定义为和式 $\\sum_k H_{t_k} (W_{t_{k+1}} - W_{t_k})$ 在划分网格趋于零时在 $L^2(\\Omega)$ 中的极限。过程 $H_t = f(W_t)$ 适应于由 $W_t$ 生成的滤子 $(\\mathcal{F}_t)$。选择左端点 $t_k^\\delta$ 确保了被积函数 $f(W(t_k^\\delta))$ 是 $\\mathcal{F}_{t_k^\\delta}$-可测的，这是 Itô 被积函数所要求的非预见性（可料）属性的离散模拟。\n\n鉴于 $f \\in C^2$ 且为多项式增长，过程 $f(W_t)$ 是 Itô 可积的。选项 A 中给出的和式正是构造 Itô 积分时使用的标准近似和。因此，根据 Itô 积分的定义，这个和式在 $L^2$ 中收敛于 $\\int_0^T f(W_t) \\, dW_t$。\n\n因此，选项 A 是 **正确的**。\n\n**选项 B 分析**\n\n该选项涉及对称和 $S_B^\\delta = \\sum_k \\frac{f(W(t_k^\\delta)) + f(W(t_{k+1}^\\delta))}{2} \\Delta W_k^\\delta$。这个和式是一种近似，其中被积函数在泛函意义上是在区间中点取值的，并且它是 Stratonovich 积分的定义性近似。Stratonovich 积分 $\\int_0^T f(W_t) \\circ dW_t$ 被定义为这些对称和依概率收敛的极限。因此，该陈述的第一部分根据定义是正确的。\n\n陈述的第二部分提供了 Stratonovich 积分与 Itô 积分之间的转换公式：\n$$ \\int_0^T f(W_t) \\circ dW_t = \\int_0^T f(W_t) \\, dW_t + \\frac{1}{2} \\int_0^T f'(W_t) \\, dt $$\n这是随机微积分中的一个标准且基本的结果。它源于布朗运动的非零二次变差。我们可以使用 Itô 公式来验证它。设 $F$ 是 $f$ 的一个原函数，即 $F' = f$。\n根据 Itô 公式：\n$$ dF(W_t) = F'(W_t) \\, dW_t + \\frac{1}{2} F''(W_t) \\, dt = f(W_t) \\, dW_t + \\frac{1}{2} f'(W_t) \\, dt $$\n从 $0$ 到 $T$ 积分得到：\n$$ F(W_T) - F(W_0) = \\int_0^T f(W_t) \\, dW_t + \\frac{1}{2} \\int_0^T f'(W_t) \\, dt $$\n相比之下，Stratonovich 积分遵循经典链式法则：\n$$ \\int_0^T f(W_t) \\circ dW_t = \\int_0^T F'(W_t) \\circ dW_t = F(W_T) - F(W_0) $$\n令 $F(W_T) - F(W_0)$ 的两个表达式相等，得到：\n$$ \\int_0^T f(W_t) \\circ dW_t = \\int_0^T f(W_t) \\, dW_t + \\frac{1}{2} \\int_0^T f'(W_t) \\, dt $$\n该公式是正确的。条件 $f \\in C^2$ 足以使其成立。\n\n因此，选项 B 是 **正确的**。\n\n**选项 C 分析**\n\n该选项援引了 Wong-Zakai 定理，该定理描述了由粗糙噪声过程的“光滑”近似驱动的常微分方程解的极限。给定的 ODE 是 $dX^\\delta_t = b(X^\\delta_t) \\, dt + \\sigma(X^\\delta_t) \\, \\dot{\\widetilde{W}}^\\delta_t \\, dt$。驱动噪声近似为 $\\widetilde{W}^\\delta$，即布朗运动的分段线性插值。这是一个 Wong-Zakai 定理适用的标准近似例子。\n\n该定理指出，当 $\\delta \\to 0$ 时，解 $X^\\delta_t$ 收敛于一个 *Stratonovich* 随机微分方程的解 $X_t$：\n$$ dX_t = b(X_t) \\, dt + \\sigma(X_t) \\circ dW_t $$\n选项 C 声称极限是 Itô SDE $dX_t = b(X_t) \\, dt + \\sigma(X_t) \\, dW_t$，“没有任何修正项”。这是不正确的。自然极限是 Stratonovich SDE。\n\n要将此极限表示为 Itô 形式，我们必须应用 SDE 的 Itô-Stratonovich 转换公式。项 $\\sigma(X_t) \\circ dW_t$ 变为 $\\sigma(X_t) \\, dW_t + \\frac{1}{2} \\sigma'(X_t) \\sigma(X_t) \\, dt$。相应的 Itô SDE 是：\n$$ dX_t = \\left( b(X_t) + \\frac{1}{2} \\sigma(X_t) \\sigma'(X_t) \\right) dt + \\sigma(X_t) \\, dW_t $$\n项 $\\frac{1}{2} \\sigma(X_t) \\sigma'(X_t)$ 是关键的“Wong-Zakai 修正项”或“Itô-Stratonovich 漂移修正项”。C 中的陈述明确否认在极限 Itô SDE 中存在此修正项。此外，它错误地暗示需要修正才能*得到* Stratonovich 形式，而实际上需要修正是为了*从*自然的 Stratonovich 极限*转换到* Itô 形式。\n\n因此，选项 C 是 **不正确的**。\n\n**选项 D 分析**\n\n该选项声称选项 A 中的和式 $\\sum_k f(W(t_k^\\delta)) \\Delta W_k^\\delta$ 的极限是 Stratonovich 积分。正如在选项 A 的分析中所确立的，这个极限是 Itô 积分。该结论是错误的。\n\n我们来检查其提供的理由：“因为对于分段常数近似，二次变差消失”。近似过程 $W^\\delta$ 在 $[0,T]$ 上的二次变差由其跳跃的平方和给出：\n$$ [W^\\delta, W^\\delta]_T = \\sum_k (W^\\delta(t_k^\\delta) - W^\\delta(t_{k-1}^\\delta))^2 = \\sum_k (W(t_k^\\delta) - W(t_{k-1}^\\delta))^2 $$\n这正是布朗运动 $W$ 本身的离散二次变差和。布朗运动的一个基本性质是，当 $\\delta \\to 0$ 时，这个和依概率收敛于 $T$。\n$$ \\lim_{\\delta \\to 0} \\sum_k (W(t_k^\\delta) - W(t_{k-1}^\\delta))^2 = [W,W]_T = T $$\n近似序列的二次变差并不消失；它收敛于极限过程的二次变差，而后者是非零的。由于极限过程 $W_t$ 不具有零二次变差（事实上，它处处不可微且为无界变差），经典的 Riemann–Stieltjes 理论不适用。其推理在根本上是有缺陷的，并且基于一个错误的前提。\n\n因此，选项 D 是 **不正确的**。\n\n**选项 E 分析**\n\n该选项陈述，对于*两种*近似，经典链式法则在极限情况下都成立，且无需修正项。对于函数 $F(x)$，经典链式法则将表述为 $dF(W_t) = F'(W_t) \\, dW_t$。\n\n对于第一种近似（左端点和），极限是 Itô 积分。其变量替换公式是 Itô 公式：$dF(W_t) = F'(W_t) \\, dW_t + \\frac{1}{2} F''(W_t) \\, dt$。这包含了修正项 $\\frac{1}{2} F''(W_t) \\, dt$。因此，经典链式法则对于 Itô 微积分*不*成立。\n\n对于第二种近似（对称和），极限是 Stratonovich 积分。Stratonovich 积分的一个关键性质是它*确实*遵循经典链式法则：$dF(W_t) = F'(W_t) \\circ dW_t$。\n\n由于该陈述断言经典链式法则对*两种*近似的极限行为都成立，而它在第一种情况（Itô）下不成立，因此整个陈述是错误的。所提供的理由，即近似路径具有良好性质（有界变差），对于任何固定的 $\\delta > 0$ 都是正确的。然而，当 $\\delta \\to 0$ 时，这些性质在极限中丢失了，因为极限过程 $W_t$ 是无界变差的。这种非平凡的极限行为正是随机微积分的研究对象。该陈述不当地将前极限的性质外推到了极限上。\n\n因此，选项 E 是 **不正确的**。", "answer": "$$\\boxed{AB}$$", "id": "3004504"}, {"introduction": "现在，我们将理论付诸实践，亲手推导著名的伊东-斯特拉托诺维奇修正项。本练习要求你分析一个梯形法则数值格式——这种对称格式的极限被认为是斯特拉托诺维奇积分。通过运用泰勒展开和布朗运动的基本性质，你将精确地计算出将这个极限从斯特拉托诺维奇形式转换为更常见的伊东形式时所必须添加的漂移修正项，从而揭示Wong-Zakai修正项的数学本质。[@problem_id:3004514]", "problem": "考虑一个由标准布朗运动的光滑近似驱动的一维常微分方程（ODE），其定义如下。设 $W$ 是一个标准布朗运动，对于每个 $\\delta>0$，设 $W^{\\delta}$ 是通过将 $W$ 与一个对称的磨光核 $\\rho_{\\delta}$ 进行卷积得到的光滑近似，因此 $W^{\\delta}$ 具有经典的时间导数 $\\dot{W}^{\\delta}$。设 $f:\\mathbb{R}\\to\\mathbb{R}$ 和 $g:\\mathbb{R}\\to\\mathbb{R}$ 是具有有界一阶和二阶导数的二阶连续可微函数。对于一个固定的 $\\delta>0$，考虑逐轨线的常微分方程\n$$\n\\frac{dX_{t}^{\\delta}}{dt} \\;=\\; f\\!\\big(X_{t}^{\\delta}\\big) \\;+\\; g\\!\\big(X_{t}^{\\delta}\\big)\\,\\dot{W}_{t}^{\\delta}, \n\\qquad X_{0}^{\\delta}=x_{0}.\n$$\n设 $0=t_{0}<t_{1}<\\dots<t_{n}=T$ 是 $[0,T]$ 上的一个分割，其网格尺寸为 $h=\\max_{k}(t_{k+1}-t_{k})$，并设 $\\Delta W_{k}^{\\delta}=W_{t_{k+1}}^{\\delta}-W_{t_{k}}^{\\delta}$。对漂移项和噪声项均应用梯形法则，定义如下的隐式时间步进格式\n$$\nX_{k+1}^{\\delta} \\;=\\; X_{k}^{\\delta} \\;+\\; \\frac{1}{2}\\Big(f\\!\\big(X_{k}^{\\delta}\\big)+f\\!\\big(X_{k+1}^{\\delta}\\big)\\Big) h \n\\;+\\; \\frac{1}{2}\\Big(g\\!\\big(X_{k}^{\\delta}\\big)+g\\!\\big(X_{k+1}^{\\delta}\\big)\\Big)\\,\\Delta W_{k}^{\\delta}.\n$$\n假设当 $h\\to 0$ 时，该格式对于固定的光滑驱动 $W^{\\delta}$ 收敛到常微分方程的解；然后当 $\\delta\\to 0$ 时，$W^{\\delta}\\to W$ 在紧集上依概率一致收敛，因此 $X^{\\delta}$ （在适当的意义下）收敛到一个极限过程 $X$。从基本定义出发，仅使用诸如光滑函数的泰勒展开和布朗运动的二次变差性质等公认事实，推导梯形法则应用于噪声项时的极限贡献，并确定当极限以 Itō 意义解释时产生的漂移修正项。\n\n您的目标是计算漂移修正函数 $C(x)$ 的显式闭式解析表达式，该函数在将极限随机微分方程（SDE）从 Stratonovich 解释转换为 Itō 解释时必须加到漂移项 $f(x)$ 上。请用 $g$ 及其导数的单个符号表达式来表示您的最终答案。不需要进行数值近似或舍入。答案必须是一个不带单位的单一解析表达式。", "solution": "首先根据所需准则对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 过程 $X_t^\\delta$ 对于一个固定的 $\\delta > 0$ 由以下常微分方程（ODE）决定：\n$$ \\frac{dX_{t}^{\\delta}}{dt} = f\\big(X_{t}^{\\delta}\\big) + g\\big(X_{t}^{\\delta}\\big)\\dot{W}_{t}^{\\delta}, \\quad X_{0}^{\\delta}=x_{0} $$\n- $W$ 是一个标准布朗运动。$W^\\delta$ 是其光滑近似，拥有经典导数 $\\dot{W}^\\delta$。\n- 函数 $f, g: \\mathbb{R} \\to \\mathbb{R}$ 是二阶连续可微（$C^2$）的，且其一阶和二阶导数有界。\n- 对于分割 $0=t_0 < t_1 < \\dots < t_n = T$ 和网格尺寸 $h$，提供了一个基于梯形法则的隐式时间步进格式：\n$$ X_{k+1}^{\\delta} = X_{k}^{\\delta} + \\frac{h}{2}\\left(f(X_k^\\delta)+f(X_{k+1}^\\delta)\\right) + \\frac{1}{2}\\left(g(X_k^\\delta)+g(X_{k+1}^\\delta)\\right)\\,\\Delta W_{k}^{\\delta} $$\n其中 $X_k^\\delta = X_{t_k}^\\delta$ 且 $\\Delta W_k^\\delta = W_{t_{k+1}}^\\delta - W_{t_k}^\\delta$。\n- 假设当 $h \\to 0$ 时，该格式收敛到 ODE 的解；当 $\\delta \\to 0$ 时，$W^\\delta \\to W$ 且解 $X^\\delta$ 收敛到一个极限过程 $X$。\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题的有效性进行严格审查。\n- **科学依据：** 该问题是随机分析中的一个基石性课题，探讨了由光滑噪声驱动的 ODE 与随机微分方程（SDE）之间的关系，这一概念由 Wong-Zakai 定理形式化。所提出的方法（分析数值格式）是推导 Stratonovich 积分和 Itō 积分之间联系的标准技术。数学对象（布朗运动、磨光核、泰勒展开）和假设（$f$ 和 $g$ 的光滑性及导数有界性）在此背景下是标准且恰当的。该问题在根本上是合理的。\n- **适定性：** 问题陈述清晰，要求一个特定且唯一定义的量：将极限 Stratonovich SDE 表达为 Itō 形式所需的漂移修正项。给定的条件和假设足以确定此项。该问题是适定的。\n- **客观性：** 问题以精确、形式化的数学语言表述，没有任何主观性或歧义。\n\n该问题不具有验证标准中列出的任何缺陷。它是一个形式化、自洽且科学有效​​的数学问题。\n\n### 步骤 3：结论与行动\n问题被判定为 **有效**。将提供一个完整的、有理有据的解答。\n\n### 解答推导\n目标是确定当极限过程由一个 Itō SDE 描述时的漂移修正项。所提供的数值格式是基础过程的离散化。根据 Wong-Zakai 定理，由光滑噪声驱动的 ODE 的极限对应于一个 Stratonovich SDE。梯形法是一种已知会收敛到 Stratonovich 积分的数值方法。我们的方法是分析当 $h \\to 0$ 和 $\\delta \\to 0$ 时该格式的极限行为。在极限情况下，上标 $\\delta$ 可以省略。我们将分析该格式的各项，以确定解 $X$ 所满足的 Itō SDE。\n\n设 $\\Delta X_k = X_{k+1} - X_k$ 和 $\\Delta W_k = W_{t_{k+1}} - W_{t_k}$。该格式为：\n$$ \\Delta X_k = \\frac{h}{2}\\left(f(X_k)+f(X_{k+1})\\right) + \\frac{1}{2}\\left(g(X_k)+g(X_{k+1})\\right)\\,\\Delta W_k $$\n我们分析当 $h \\to 0$ 时，和式 $\\sum_k \\Delta X_k$ 中每一部分的贡献。\n\n首先，考虑格式中的漂移项：\n$$ \\sum_{k=0}^{n-1} \\frac{h}{2}\\left(f(X_k)+f(X_{k+1})\\right) $$\n由于样本路径的连续性，当 $h \\to 0$ 时，$X_{k+1} \\to X_k$。因此，$f(X_{k+1}) \\to f(X_k)$。该和式变成一个黎曼和 (Riemann sum)，收敛到漂移项的标准积分：\n$$ \\lim_{h\\to 0} \\sum_{k=0}^{n-1} \\frac{h}{2}\\left(f(X_k)+f(X_{k+1})\\right) = \\lim_{h\\to 0} \\sum_{k=0}^{n-1} f(X_k)h = \\int_0^T f(X_t) dt $$\n\n接下来，我们分析噪声项，它是一个随机积分的离散近似：\n$$ S_n = \\sum_{k=0}^{n-1} \\frac{1}{2}\\left(g(X_k)+g(X_{k+1})\\right)\\,\\Delta W_k $$\n为理解其极限，我们使用泰勒级数将 $g(X_{k+1})$ 在 $X_k$ 附近展开。因为 $g \\in C^2$，我们有：\n$$ g(X_{k+1}) = g(X_k + \\Delta X_k) = g(X_k) + g'(X_k)\\Delta X_k + O((\\Delta X_k)^2) $$\n其中 $g'(x) = \\frac{dg}{dx}(x)$。\n将此代入 $S_n$ 的表达式中：\n$$ S_n = \\sum_{k=0}^{n-1} \\frac{1}{2}\\left(g(X_k) + g(X_k) + g'(X_k)\\Delta X_k + O((\\Delta X_k)^2)\\right)\\,\\Delta W_k $$\n$$ S_n = \\sum_{k=0}^{n-1} g(X_k)\\Delta W_k + \\sum_{k=0}^{n-1} \\frac{1}{2}g'(X_k)\\Delta X_k \\Delta W_k + \\sum_{k=0}^{n-1} O((\\Delta X_k)^2)\\Delta W_k $$\n第一项 $\\sum g(X_k)\\Delta W_k$ 是在 $h \\to 0$ 极限下定义 Itō 积分的标准离散和：\n$$ \\lim_{h\\to 0} \\sum_{k=0}^{n-1} g(X_k)\\Delta W_k = \\int_0^T g(X_t) dW_t $$\n对于第二项，我们需要 $\\Delta X_k$ 的表达式。对于小的 $h$，$\\Delta X_k$ 的主导部分由欧拉-丸山近似 (Euler-Maruyama approximation) 给出，该近似从 SDE 本身的领头项导出：\n$$ \\Delta X_k = f(X_k)h + g(X_k)\\Delta W_k + O(h) $$\n我们将此代入 $S_n$ 的第二项中：\n$$ \\sum_{k=0}^{n-1} \\frac{1}{2}g'(X_k)\\Delta X_k \\Delta W_k \\approx \\sum_{k=0}^{n-1} \\frac{1}{2}g'(X_k) \\left( f(X_k)h + g(X_k)\\Delta W_k \\right) \\Delta W_k $$\n$$ = \\sum_{k=0}^{n-1} \\frac{1}{2} g(X_k)g'(X_k)(\\Delta W_k)^2 + \\sum_{k=0}^{n-1} \\frac{1}{2}f(X_k)g'(X_k)h \\Delta W_k $$\n我们现在分析这两个和式的极限。\n第一个和式包含 $(\\Delta W_k)^2$。布朗运动的一个基本性质是其二次变差，即 $\\lim_{h \\to 0} \\sum_k (\\Delta W_k)^2 = T$。这是一个黎曼型和 (Riemann-type sum)，它收敛到一个关于时间的标准积分：\n$$ \\lim_{h\\to 0} \\sum_{k=0}^{n-1} \\frac{1}{2} g(X_k)g'(X_k)(\\Delta W_k)^2 = \\int_0^T \\frac{1}{2} g(X_t)g'(X_t) dt $$\n这个积分是漂移修正项的来源。\n第二个和式 $\\sum \\frac{1}{2}f(X_k)g'(X_k)h \\Delta W_k$ 依概率收敛于零。此和式的方差与 $\\sum h^2 (\\Delta W_k)^2 \\approx \\sum h^2 h = h (T)$ 成正比，当 $h \\to 0$ 时趋于 $0$。\n$S_n$ 中的最后一项 $\\sum O((\\Delta X_k)^2)\\Delta W_k$ 也因包含 $h$ 和 $\\Delta W_k$ 的更高次幂而在极限中消失。\n\n结合所有的极限贡献，完整的过程 $X_T - X_0 = \\sum \\Delta X_k$ 满足：\n$$ X_T - X_0 = \\int_0^T f(X_t)dt + \\int_0^T g(X_t)dW_t + \\int_0^T \\frac{1}{2}g(X_t)g'(X_t)dt $$\n将其写成微分形式，得到极限过程 $X_t$ 的 Itō SDE：\n$$ dX_t = f(X_t)dt + g(X_t)dW_t + \\frac{1}{2}g(X_t)g'(X_t)dt $$\n我们可以将 $dt$ 项组合在一起，以确定 Itō 方程的总漂移项：\n$$ dX_t = \\left(f(X_t) + \\frac{1}{2}g(X_t)g'(X_t)\\right)dt + g(X_t)dW_t $$\n问题表述中的原始漂移是 $f(x)$。得到的 Itō SDE 有一个修正后的漂移。问题要求的是加到 $f(x)$ 上的漂移修正函数 $C(x)$。通过比较漂移项，我们确定这个修正。\n修正项是加到原始漂移 $f(x)$ 上的部分。因此，漂移修正函数 $C(x)$ 是：\n$$ C(x) = \\frac{1}{2}g(x)g'(x) $$\n这个结果是著名的 Itō-Stratonovich 修正项（或 Wong-Zakai 修正项）。", "answer": "$$\\boxed{\\frac{1}{2} g(x) g'(x)}$$", "id": "3004514"}]}