{"hands_on_practices": [{"introduction": "我们的实践始于拟势理论最直接的应用：梯度系统。对于这类系统，形式复杂的行动泛函可以被大大简化，将拟势与系统的势能 $U(x)$ 直接联系起来。通过本练习，您将学习如何通过寻找吸引子周围势能“墙”上的“最低点”来计算逃逸时间垒，从而巩固弗雷德林-温策尔（Freidlin-Wentzell）理论背后的核心直觉。", "problem": "考虑$\\mathbb{R}^{2}$中的小噪声随机微分方程（SDE, stochastic differential equation），其形式如下\n$$\n\\mathrm{d}X^{\\varepsilon}_{t} \\;=\\; -\\nabla U\\!\\left(X^{\\varepsilon}_{t}\\right)\\,\\mathrm{d}t \\;+\\; \\sqrt{\\varepsilon}\\,\\mathrm{d}W_{t},\n$$\n其中$W_{t}$是标准的$\\mathbb{R}^{2}$布朗运动，势函数为\n$$\nU(x,y) \\;=\\; \\frac{1}{2}\\big(x^{2}+y^{2}\\big) \\;+\\; \\alpha\\,x,\n$$\n参数$\\alpha>0$。令$D$为以原点为中心、半径为$R>0$的开圆盘，即，\n$$\nD \\;=\\; \\big\\{(x,y)\\in\\mathbb{R}^{2}:\\; x^{2}+y^{2}<R^{2}\\big\\}.\n$$\n记$\\tau_{D}^{\\varepsilon}$为$X^{\\varepsilon}$从$D$的首次出流时间。确定性动力学$\\dot{z}=-\\nabla U(z)$的唯一全局渐近稳定平衡点位于$x_{\\star}=(-\\alpha,0)$。\n\n从Freidlin–Wentzell样本路径作用量的基本定义以及相对于$x_{\\star}$的拟势的Hamilton–Jacobi（HJ, Hamilton–Jacobi）表征出发，确定对数出流时间势垒\n$$\n\\inf_{z\\in\\partial D} W(z),\n$$\n的精确闭式表达式（用$\\alpha$和$R$表示），其中$W$是相对于$x_{\\star}$的拟势。等价地，计算极限\n$$\n\\lim_{\\varepsilon\\to 0}\\,\\varepsilon\\,\\ln \\mathbb{E}_{x_{\\star}}\\!\\left[\\tau_{D}^{\\varepsilon}\\right].\n$$\n您的最终答案必须是关于$\\alpha$和$R$的单个简化解析表达式。不包含单位。不要提供不等式或方程式作为最终答案。", "solution": "该问题被评估为有效。该设定对应于随机微分方程大偏差理论中的一个标准问题，特别是关于从吸引域的出流时间。该系统是一个受小幅度白噪声扰动的梯度流。势函数`U(x,y)`是良定义且凸的，保证了存在唯一的全局稳定平衡点。区域`D`是一个简单的有界集。问题要求计算出流时间势垒，这是Freidlin-Wentzell理论中一个良定义的量。该问题非平凡的一个必要条件是稳定平衡点`x_{\\star}`必须在区域`D`内部。`x_{\\star}`的坐标为`(-\\alpha, 0)`。条件`x_{\\star} \\in D`可转换为`(-\\alpha)^{2} + 0^{2} < R^{2}`，简化后为`\\alpha^{2} < R^{2}`。由于`\\alpha`和`R`都给定为正数，这等价于`\\alpha < R`。假设此条件成立，这对于此类出流问题是标准做法。\n\n根据Freidlin和Wentzell的大偏差理论，对于由随机微分方程（SDE）`\\mathrm{d}X^{\\varepsilon}_{t} = b(X^{\\varepsilon}_{t})\\,\\mathrm{d}t + \\sqrt{\\varepsilon}\\,\\mathrm{d}W_{t}`描述的系统，从稳定平衡点`x_{\\star} \\in D`出发，首次离开区域`D`的期望出流时间`\\tau_{D}^{\\varepsilon}`在小噪声极限`\\varepsilon \\to 0`下满足以下渐近关系：\n$$\n\\lim_{\\varepsilon\\to 0}\\,\\varepsilon\\,\\ln \\mathbb{E}_{x_{\\star}}\\!\\left[\\tau_{D}^{\\varepsilon}\\right] = \\inf_{z\\in\\partial D} W(z),\n$$\n其中`W(z)`是相对于`x_{\\star}`的拟势（或作用泛函最小值）。因此，问题简化为计算这个下确界。\n\n拟势`W(z)`定义为在任意时间`T > 0`内连接`x_{\\star}`到`z`的所有路径`\\phi`上的样本路径作用泛函`S_{T}(\\phi)`的最小值：\n$$\nW(z) = \\inf_{T>0} \\inf_{\\substack{\\phi \\in C([0,T]; \\mathbb{R}^{2}) \\\\ \\phi(0)=x_{\\star}, \\phi(T)=z}} S_{T}(\\phi).\n$$\n对于给定的SDE，其漂移项为`b(z) = -\\nabla U(z)`，作用泛函为\n$$\nS_{T}(\\phi) = \\frac{1}{2} \\int_{0}^{T} \\left|\\dot{\\phi}_{s} - b(\\phi_{s})\\right|^{2}\\,\\mathrm{d}s = \\frac{1}{2} \\int_{0}^{T} \\left|\\dot{\\phi}_{s} + \\nabla U(\\phi_{s})\\right|^{2}\\,\\mathrm{d}s.\n$$\n对于梯度系统，拟势具有一个特别简单的形式。使从`x_{\\star}`到`z`的跃迁的作用泛函最小化的最优路径`\\phi^{*}`是确定性轨道的时间反演。也就是说，`\\phi^{*}`满足常微分方程`\\dot{\\phi}^{*}_s = \\nabla U(\\phi^{*}_s)`。将此代入作用泛函得到：\n$$\nS_{T}(\\phi^{*}) = \\frac{1}{2} \\int_{0}^{T} \\left|\\nabla U(\\phi^{*}_{s}) + \\nabla U(\\phi^{*}_{s})\\right|^{2}\\,\\mathrm{d}s = \\frac{1}{2} \\int_{0}^{T} \\left|2\\nabla U(\\phi^{*}_{s})\\right|^{2}\\,\\mathrm{d}s = 2 \\int_{0}^{T} \\left|\\nabla U(\\phi^{*}_{s})\\right|^{2}\\,\\mathrm{d}s.\n$$\n利用关系式`\\dot{\\phi}^{*}_s = \\nabla U(\\phi^{*}_s)`，我们可以重写被积函数：\n$$\nS_{T}(\\phi^{*}) = 2 \\int_{0}^{T} \\langle \\nabla U(\\phi^{*}_{s}), \\dot{\\phi}^{*}_{s} \\rangle\\,\\mathrm{d}s.\n$$\n这是`2\\nabla U`沿路径`\\phi^{*}`的曲线积分。根据曲线积分基本定理，其值与路径无关，仅取决于端点：\n$$\nW(z) = S_{T}(\\phi^{*}) = 2 \\left( U(\\phi^{*}(T)) - U(\\phi^{*}(0)) \\right) = 2 \\left( U(z) - U(x_{\\star}) \\right).\n$$\n这表明拟势`W(z)`就是点`z`和平衡点`x_{\\star}`之间势函数`U`的差值的两倍。\n\n我们现在的任务是计算`\\inf_{z\\in\\partial D} W(z)`：\n$$\n\\inf_{z\\in\\partial D} W(z) = \\inf_{z\\in\\partial D} \\left[ 2 \\left( U(z) - U(x_{\\star}) \\right) \\right] = 2 \\left( \\left(\\inf_{z\\in\\partial D} U(z)\\right) - U(x_{\\star}) \\right).\n$$\n我们需要计算两个量：`U(x_{\\star})`和`\\inf_{z\\in\\partial D} U(z)`。\n\n首先，我们计算在稳定平衡点`x_{\\star} = (-\\alpha, 0)`处的势函数值：\n势函数为`U(x,y) = \\frac{1}{2}(x^{2}+y^{2}) + \\alpha x`。\n$$\nU(x_{\\star}) = U(-\\alpha, 0) = \\frac{1}{2}((-\\alpha)^{2} + 0^{2}) + \\alpha(-\\alpha) = \\frac{1}{2}\\alpha^{2} - \\alpha^{2} = -\\frac{1}{2}\\alpha^{2}.\n$$\n\n接下来，我们求`U(z)`在圆盘边界`\\partial D`上的下确界。边界是由`x^{2} + y^{2} = R^{2}`定义的圆周。对于这个圆周上的任意点`z=(x,y)`，势函数变为：\n$$\nU(x,y)\\bigr|_{\\partial D} = \\frac{1}{2}(R^{2}) + \\alpha x.\n$$\n为了找到`U`在`\\partial D`上的下确界，我们必须找到该表达式的最小值。由于`R`和`\\alpha`是正常数，我们需要在约束条件`x^{2} + y^{2} = R^{2}`下最小化`\\alpha x`项。这等价于最小化`x`本身。在圆周上，`x`的取值范围是`[-R, R]`。`x`的最小值因此是`-R`，它在点`z = (-R, 0)`处取得。\n因此，势函数在边界上的下确界为：\n$$\n\\inf_{z\\in\\partial D} U(z) = U(-R, 0) = \\frac{1}{2}R^{2} + \\alpha(-R) = \\frac{1}{2}R^{2} - \\alpha R.\n$$\n\n最后，我们将这些结果代回到出流时间势垒的表达式中：\n$$\n\\inf_{z\\in\\partial D} W(z) = 2 \\left[ \\left( \\frac{1}{2}R^{2} - \\alpha R \\right) - \\left( -\\frac{1}{2}\\alpha^{2} \\right) \\right]\n$$\n$$\n= 2 \\left[ \\frac{1}{2}R^{2} - \\alpha R + \\frac{1}{2}\\alpha^{2} \\right]\n$$\n$$\n= R^{2} - 2\\alpha R + \\alpha^{2}.\n$$\n这个表达式可以简化为一个完全平方：\n$$\n\\inf_{z\\in\\partial D} W(z) = (R - \\alpha)^{2}.\n$$\n这就是对数出流时间势垒的值。如前所述，此结果在条件`R > \\alpha`下有效，该条件确保平衡点`x_{\\star}`位于区域`D`内部。", "answer": "$$\n\\boxed{(R-\\alpha)^{2}}\n$$", "id": "2992460"}, {"introduction": "现实世界中的动力学通常涉及非保守力，从而产生非梯度漂移项。在这些情况下，我们不能再依赖于简单的势函数，而必须运用哈密顿形式化的全部威力。这个实践问题要求您为一个经典的非梯度系统推导瞬子（instanton）方程，为您分析更复杂、更真实的随机模型提供必要技能。", "problem": "考虑二维随机微分方程 (SDE)\n$$\n\\mathrm{d}X_{t} \\;=\\; -A\\,X_{t}\\,\\mathrm{d}t \\;+\\; \\sqrt{2\\,\\varepsilon}\\,\\mathrm{d}W_{t},\n$$\n其中 $X_{t} \\in \\mathbb{R}^{2}$，$\\varepsilon>0$ 是一个小噪声参数，$W_{t}$ 是一个标准的二维布朗运动，且\n$$\nA \\;=\\; \\alpha I \\;+\\; \\omega J, \\qquad I \\;=\\; \\begin{pmatrix}1 & 0 \\\\ 0 & 1\\end{pmatrix}, \\qquad J \\;=\\; \\begin{pmatrix}0 & -1 \\\\ 1 & 0\\end{pmatrix},\n$$\n其中常数 $\\alpha>0$ 且 $\\omega \\neq 0$。因此，漂移项 $b(x)=-A x$ 是非梯度的，因为当 $\\omega\\neq 0$ 时 $A$ 不是对称的。令 $D=\\{x\\in\\mathbb{R}^{2}: \\|x\\|< r\\}$ 为以原点为中心、半径为 $r>0$ 的开圆盘，该原点是确定性动力学 $\\dot{x}=-A x$ 的一个全局吸引平衡点。\n\n使用 Freidlin-Wentzell (FW) 理论的大偏差原理，相对于原点吸引子的拟势定义为作用泛函在连接原点与指定终点的所有路径上的最小值。仅从 FW 作用泛函和通过勒让德变换得到的哈密顿表示出发，推导该非梯度系统的瞬子（最优路径）方程，并确定从原点逃离区域 $D$ 所需的最小拟势垒，即\n$$\n\\inf_{y\\in \\partial D} V(y),\n$$\n其中 $V$ 是与上述 SDE 相关的拟势。用一个包含 $\\alpha$ 和 $r$ 的单一闭式符号表达式来表示你的最终答案。所有中间公式都必须经过推导，不得直接引用。不需要进行数值计算。", "solution": "给定的随机微分方程 (SDE) 为：\n$$ \\mathrm{d}X_{t} = b(X_{t})\\,\\mathrm{d}t + \\sqrt{2\\,\\varepsilon}\\,\\mathrm{d}W_{t} $$\n其中漂移项为 $b(x) = -A x$ 且 $X_t \\in \\mathbb{R}^2$。噪声项 $\\sqrt{2\\varepsilon}\\,\\mathrm{d}W_{t}$ 可以通过将扩散矩阵 $\\sigma$ 确定为 $\\sigma = \\sqrt{2}I$，写入标准的 FW 形式 $\\sqrt{\\varepsilon}\\,\\sigma\\,\\mathrm{d}W_{t}$。相应的扩散张量为 $a = \\sigma\\sigma^T = (\\sqrt{2}I)(\\sqrt{2}I)^T = 2I$。\n\n在时间区间 $[0, T]$ 上的路径 $\\phi(t)$ 的 Freidlin-Wentzell 作用泛函（或速率函数）由下式给出：\n$$ S_{T}(\\phi) = \\frac{1}{2} \\int_0^T \\left( \\dot{\\phi}(t) - b(\\phi(t)) \\right)^T a^{-1} \\left( \\dot{\\phi}(t) - b(\\phi(t)) \\right) \\mathrm{d}t $$\n观测到 $\\phi$ 邻域内一条轨迹的概率尺度为 $\\exp(-S_T(\\phi)/\\varepsilon)$。代入 $b(\\phi) = -A\\phi$ 和 $a^{-1} = (2I)^{-1} = \\frac{1}{2}I$，我们得到：\n$$ S_{T}(\\phi) = \\frac{1}{2} \\int_0^T \\left( \\dot{\\phi}(t) + A\\phi(t) \\right)^T \\left(\\frac{1}{2}I\\right) \\left( \\dot{\\phi}(t) + A\\phi(t) \\right) \\mathrm{d}t = \\frac{1}{4} \\int_0^T \\|\\dot{\\phi}(t) + A\\phi(t)\\|^2 \\mathrm{d}t $$\n拟势 $V(y)$ 是该作用在所有从吸引子（原点 $0$）开始并终止于点 $y$ 的路径 $\\phi$ 上的最小值：\n$$ V(y) = \\inf_{T>0} \\inf_{\\phi:\\,\\phi(0)=0, \\phi(T)=y} S_T(\\phi) $$\n这是一个变分法问题。我们可以使用哈密顿形式体系来解决它。令 $q(t)$ 代表路径 $\\phi(t)$。拉格朗日量为：\n$$ L(q, \\dot{q}) = \\frac{1}{4} \\|\\dot{q} + Aq\\|^2 $$\n与位置 $q$ 共轭的动量 $p$ 定义为：\n$$ p = \\frac{\\partial L}{\\partial \\dot{q}} = \\frac{1}{4} \\cdot 2 (\\dot{q} + Aq) = \\frac{1}{2}(\\dot{q} + Aq) $$\n由此，我们用 $p$ 和 $q$ 来表示 $\\dot{q}$：\n$$ \\dot{q} = 2p - Aq $$\n哈密顿量 $H(q, p)$ 通过拉格朗日量的勒让德变换得到：\n$$ H(q, p) = p \\cdot \\dot{q} - L(q, \\dot{q}) = p \\cdot (2p - Aq) - \\frac{1}{4} \\|(2p - Aq) + Aq\\|^2 $$\n$$ H(q, p) = 2\\|p\\|^2 - p \\cdot (Aq) - \\frac{1}{4} \\|2p\\|^2 = 2\\|p\\|^2 - p^T A q - \\|p\\|^2 = \\|p\\|^2 - p^T A q $$\n最小化作用量的最优路径（或瞬子）对应于能量为零（$H(q,p)=0$）的哈密顿系统的轨迹。瞬子方程即哈密顿方程：\n$$ \\dot{q} = \\frac{\\partial H}{\\partial p}, \\qquad \\dot{p} = -\\frac{\\partial H}{\\partial q} $$\n我们来计算这些方程：\n$$ \\frac{\\partial H}{\\partial p} = 2p - A q $$\n这验证了我们关于 $\\dot{q}$ 的表达式。现在计算 $\\dot{p}$：\n$$ p^T A q = p^T (\\alpha I + \\omega J) q = \\alpha p^T q + \\omega p^T J q $$\n关于 $q$ 的梯度给出：\n$$ \\frac{\\partial (p^T A q)}{\\partial q} = A^T p $$\n所以，\n$$ \\dot{p} = - \\left( -\\frac{\\partial (p^T A q)}{\\partial q} \\right) = A^T p $$\n因此，瞬子方程为：\n1.  $\\dot{q} = 2p - Aq$\n2.  $\\dot{p} = A^T p$\n\n求解这些方程，寻找在时间 $t \\to -\\infty$ 时从吸引子 $q=0$ 开始，并在时间 $t=0$ 时终止于点 $y$ 的路径。第二个方程是关于 $p(t)$ 的线性常微分方程，其解为 $p(t) = \\exp(t A^T)p(0)$。将此解代入第一个方程，得到关于 $q(t)$ 的线性常微分方程：\n$$ \\dot{q} + Aq = 2p(t) = 2\\exp(t A^T)p(0) $$\n满足边界条件 $q(-\\infty)=0$ 的 $q(t)$ 的解由下式给出：\n$$ q(t) = \\int_{-\\infty}^t \\exp(-(t-s)A) [2 \\exp(s A^T)p(0)] \\mathrm{d}s = 2 \\exp(-tA) \\int_{-\\infty}^t \\exp(s A) \\exp(s A^T) p(0) \\mathrm{d}s $$\n$$ q(t) = 2 \\exp(-tA) p(0) \\int_{-\\infty}^t \\exp(s(A+A^T)) \\mathrm{d}s $$\n我们计算 $A+A^T$：\n$$ A+A^T = (\\alpha I + \\omega J) + (\\alpha I + \\omega J)^T = (\\alpha I + \\omega J) + (\\alpha I^T + \\omega J^T) = (\\alpha I + \\omega J) + (\\alpha I - \\omega J) = 2\\alpha I $$\n由于 $\\alpha>0$，该积分收敛：\n$$ \\int_{-\\infty}^t \\exp(s(2\\alpha I)) \\mathrm{d}s = I \\int_{-\\infty}^t e^{2\\alpha s} \\mathrm{d}s = I \\left[ \\frac{e^{2\\alpha s}}{2\\alpha} \\right]_{-\\infty}^t = \\frac{e^{2\\alpha t}}{2\\alpha}I $$\n将此结果代回 $q(t)$ 的表达式中：\n$$ q(t) = 2 \\exp(-tA) p(0) \\left( \\frac{e^{2\\alpha t}}{2\\alpha} \\right) = \\frac{1}{\\alpha} \\exp(-tA) e^{2\\alpha t} p(0) = \\frac{1}{\\alpha} \\exp(t(2\\alpha I - A)) p(0) $$\n由于 $2\\alpha I - A = A^T$，我们有：\n$$ q(t) = \\frac{1}{\\alpha} \\exp(t A^T) p(0) = \\frac{1}{\\alpha}p(t) $$\n这建立了一个简单的代数关系 $p(t) = \\alpha q(t)$，它在整个瞬子路径上都成立。我们可以验证这个关系与零能量条件 $H=0$ 是一致的：\n$$ H = \\|p\\|^2 - p^T A q = \\|\\alpha q\\|^2 - (\\alpha q)^T A q = \\alpha^2 \\|q\\|^2 - \\alpha q^T A q = 0 $$\n$$ \\alpha \\|q\\|^2 = q^T A q $$\n我们来检验 $q^T A q$：\n$$ q^T A q = q^T(\\alpha I + \\omega J)q = \\alpha q^T I q + \\omega q^T J q = \\alpha \\|q\\|^2 + \\omega (x, y) \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\alpha \\|q\\|^2 + \\omega(-xy+yx) = \\alpha \\|q\\|^2 $$\n条件 $\\alpha \\|q\\|^2 = \\alpha \\|q\\|^2$ 恒成立。因此，关系式 $p=\\alpha q$ 是正确的。\n\n拟势 $V(y)$ 可以通过计算最优路径上的作用量得到。一个更直接的方法是沿瞬子路径使用公式 $V(y) = \\int_0^y p \\cdot dq$。由于 $p(q) = \\alpha q$ 是一个梯度向量场（其旋度为 $\\nabla \\times (\\alpha q) = 0$），该积分是路径无关的。\n$$ V(y) = \\int_0^y (\\alpha q) \\cdot dq = \\alpha \\int_0^y q \\cdot dq $$\n积分 $\\int q \\cdot dq = \\int (x dx + y dy) = \\int \\frac{1}{2} d(x^2+y^2) = \\frac{1}{2}d(\\|q\\|^2)$。\n$$ V(y) = \\alpha \\int_{q=0}^{q=y} \\frac{1}{2}d(\\|q\\|^2) = \\frac{\\alpha}{2} [\\|q\\|^2]_0^y = \\frac{\\alpha}{2} \\|y\\|^2 $$\n拟势为 $V(y) = \\frac{\\alpha}{2}\\|y\\|^2$。值得注意的是，这个表达式与旋转分量 $\\omega$ 无关。\n\n问题要求计算逃离区域 $D = \\{x\\in\\mathbb{R}^{2}: \\|x\\|< r\\}$ 的最小拟势垒。这个量是拟势在该区域边界 $\\partial D$ 上的最小值。\n$$ \\min_{y \\in \\partial D} V(y) $$\n边界是圆 $\\|y\\|=r$。所以我们需要计算：\n$$ \\min_{\\|y\\|=r} \\left(\\frac{\\alpha}{2} \\|y\\|^2\\right) $$\n由于在边界上 $\\|y\\|$ 是常数等于 $r$，所以最小值就是函数在边界上的值：\n$$ \\frac{\\alpha}{2} r^2 $$\n圆边界上的所有点都是等可能的逃离点，从原点逃离到边界上任意一点的最小能量垒是 $\\frac{\\alpha}{2} r^2$。", "answer": "$$\n\\boxed{\\frac{\\alpha r^2}{2}}\n$$", "id": "2992467"}, {"introduction": "检验理解程度的最终标准往往是将理论转化为具体计算的能力。最后的这个实践是一个编程练习，您将在这里实现拟势的解析公式，用以研究一个经典的双稳态系统。通过数值计算双阱势中的逃逸能垒，您将对亚稳态以及弗雷德林-温策尔（Freidlin-Wentzell）理论的定量分析能力获得切实的理解。", "problem": "考虑一维随机微分方程 (SDE) $dX_t = b(X_t)\\,dt + \\sqrt{\\varepsilon}\\,dW_t$，其中 $b:\\mathbb{R}\\to\\mathbb{R}$ 是一个光滑漂移，$\\varepsilon>0$ 是小噪声振幅。在 Freidlin–Wentzell (FW) 的大偏差理论中，对于绝对连续路径 $x:[0,T]\\to\\mathbb{R}$，其率泛函为\n$$\nS_T[x] \\;=\\; \\frac{1}{2}\\int_0^T \\big(\\dot{x}(t)-b(x(t))\\big)^2\\,dt,\n$$\n从一个稳定平衡点 $a$ 到一个点 $x$ 的拟势 (quasipotential) 定义为\n$$\nV(a,x) \\;=\\; \\inf_{T>0}\\;\\inf_{x(0)=a,\\;x(T)=x} S_T[x].\n$$\n已知最小作用量路径（也称为最小作用路径）满足相关的 Hamilton–Jacobi 方程的特征方程，在一维情况下，拟势满足\n$$\n\\frac{1}{2}\\big(V'(x)\\big)^2 + b(x)\\,V'(x) \\;=\\; 0,\n$$\n且 $V(a)=0$，因此非平凡分支得出 $V'(x)=-2\\,b(x)$，从而\n$$\nV(a,x) \\;=\\; -2\\int_a^x b(s)\\,ds.\n$$\n此外，最小作用路径沿着最优特征线遵循常微分方程 $\\dot{x}(t)= -\\,b(x(t))$，并且沿此路径累积的作用量满足\n$$\nV(a,x) \\;=\\; \\int_0^{T^*}\\frac{1}{2}\\big(\\dot{x}(t)-b(x(t))\\big)^2\\,dt \\;=\\; -2\\int_a^x b(s)\\,ds,\n$$\n其中 $T^*$ 是路径到达 $x$ 的终端时间。\n\n您的任务是实现一个数值程序，为形如 $b_\\delta(x)=x-x^3+\\delta$ 的特定漂移计算最小作用路径和拟势，其中 $\\delta\\in\\mathbb{R}$ 是一个偏置参数。对于双阱族 $b_\\delta$，平衡点是 $x-x^3+\\delta=0$ 的实根，其中最左边的根是稳定平衡点 $a_\\delta$，中间的根是鞍点 $s_\\delta$，最右边的根是稳定平衡点 $r_\\delta$。对于每个测试用例，您必须：\n\n1. 通过求解 $x-x^3+\\delta=0$ 的实根来确定 $a_\\delta$ 和 $s_\\delta$。\n2. 使用积分 $V(a_\\delta,s_\\delta)=-2\\int_{a_\\delta}^{s_\\delta} b_\\delta(s)\\,ds$ 并通过其精确的反导数来计算拟势 $V(a_\\delta,s_\\delta)$\n$$\nF_\\delta(x) \\;=\\; \\frac{1}{2}x^2 - \\frac{1}{4}x^4 + \\delta\\,x,\n$$\n使得 $V(a_\\delta,s_\\delta) = -2\\big(F_\\delta(s_\\delta)-F_\\delta(a_\\delta)\\big)$。\n3. 通过求解常微分方程 $\\dot{x}(t) = -\\,b_\\delta(x(t))$ 来数值重构最小作用路径，该路径从 $x(0)=a_\\delta+\\eta$（其中 $\\eta$ 是一个小的正偏移量）开始，积分直到路径到达 $s_\\delta$。使用这条路径，通过对 $-2\\int_{a_\\delta}^{s_\\delta} b_\\delta(s)\\,ds$ 沿路径的离散近似来估算作用量 $V(a_\\delta,s_\\delta)$。此步骤用于验证基于路径的计算与解析积分一致；但最终输出中只应报告基于积分的值。\n\n您必须为以下测试套件实现上述步骤：\n- 测试用例 1：$\\delta=0$，在对称双阱中，从 $a_0=-1$ 到 $s_0=0$。\n- 测试用例 2：$\\delta=0.05$，从 $a_{0.05}$（最左边的实根）到 $s_{0.05}$（中间的实根）。\n- 测试用例 3：$\\delta=0.05$，在起始平衡点本身处评估拟势，即 $V(a_{0.05},a_{0.05})$，其值必须为 $0$。\n\n所有计算都是纯数学和无量纲的，因此不需要物理单位。您的程序必须生成单行输出，其中包含三个测试用例的拟势值，按上面列出的顺序，用逗号分隔并用方括号括起来，例如：$[v_1,v_2,v_3]$。\n\n您的程序必须是自包含的，并且每个测试用例的最终输出必须是浮点类型。", "solution": "该问题要求计算一维双稳态系统的拟势 $V(a,x)$，该系统由随机微分方程 $dX_t = b_\\delta(X_t)\\,dt + \\sqrt{\\varepsilon}\\,dW_t$ 描述。漂移函数由函数族 $b_\\delta(x) = x-x^3+\\delta$ 给出，其中 $\\delta$ 是一个实参数。该系统表现出两个稳定平衡点，我们将其表示为 $a_\\delta$（最左）和 $r_\\delta$（最右），它们由一个不稳定平衡点（鞍点）$s_\\delta$ 分隔。这些平衡点是方程 $b_\\delta(x) = 0$ 的实根。\n\n根据 Freidlin-Wentzell 的大偏差理论，在小噪声极限 ($\\varepsilon \\to 0$) 下，拟势 $V(a,x)$ 代表系统从稳定平衡点 $a$ 过渡到状态 $x$ 所需的最小“成本”或作用量。对于一维系统，拟势可以通过漂移函数的积分直接计算：\n$$\nV(a,x) = -2 \\int_a^x b(s)\\,ds.\n$$\n问题指定了漂移 $b_\\delta(s) = s-s^3+\\delta$。$b_\\delta(s)$ 的精确反导数被提供为 $F_\\delta(s) = \\frac{1}{2}s^2 - \\frac{1}{4}s^4 + \\delta s$。使用微积分基本定理，从平衡点 $a_\\delta$ 到另一点 $x$ 的拟势可以计算为：\n$$\nV(a_\\delta, x) = -2 \\int_{a_\\delta}^x (s-s^3+\\delta)\\,ds = -2 \\left[ F_\\delta(s) \\right]_{a_\\delta}^x = -2 \\big( F_\\delta(x) - F_\\delta(a_\\delta) \\big).\n$$\n主要任务是为三个不同的测试用例计算该值。一个次要任务，被描述为验证步骤，涉及数值积分离散作用路径的常微分方程 $\\dot{x}(t) = -b_\\delta(x(t))$。由于问题明确指出只应报告从精确积分导出的值，因此实现将仅关注 $V(a_\\delta, x)$ 的解析公式。\n\n我们系统地分析每个测试用例。\n\n**测试用例 1：对称双阱，$\\delta=0$**\n\n在这种情况下，参数 $\\delta=0$，漂移为 $b_0(x) = x-x^3$。我们需要计算从稳定平衡点 $a_0 = -1$ 到鞍点 $s_0=0$ 的拟势 $V(a_0, s_0)$。\n首先，我们确认这些确实是正确的平衡点。$b_0(x) = x-x^3 = x(1-x^2) = 0$ 的根是 $x=-1$, $x=0$ 和 $x=1$。为了检查稳定性，我们考察导数 $b'_0(x) = 1-3x^2$。\n在 $x=-1$ 处，$b'_0(-1) = 1-3(-1)^2 = -2 < 0$，表示一个稳定平衡点。因此，$a_0 = -1$。\n在 $x=0$ 处，$b'_0(0) = 1-3(0)^2 = 1 > 0$，表示一个不稳定平衡点。因此，$s_0 = 0$。\n第三个根是 $x=1$，它也是一个稳定平衡点。\n\n现在，我们计算拟势 $V(-1, 0)$。对于 $\\delta=0$，反导数为 $F_0(x) = \\frac{1}{2}x^2 - \\frac{1}{4}x^4$。\n$$\nV(-1, 0) = -2 \\big( F_0(0) - F_0(-1) \\big).\n$$\n我们计算各项：\n$F_0(0) = \\frac{1}{2}(0)^2 - \\frac{1}{4}(0)^4 = 0$。\n$F_0(-1) = \\frac{1}{2}(-1)^2 - \\frac{1}{4}(-1)^4 = \\frac{1}{2} - \\frac{1}{4} = \\frac{1}{4}$。\n代入这些值：\n$$\nV(-1, 0) = -2 \\left( 0 - \\frac{1}{4} \\right) = \\frac{2}{4} = \\frac{1}{2} = 0.5.\n$$\n\n**测试用例 2：倾斜双阱，$\\delta=0.05$**\n\n这里，参数是 $\\delta=0.05$，漂移是 $b_{0.05}(x) = x-x^3+0.05$。我们需要计算 $V(a_{0.05}, s_{0.05})$，其中 $a_{0.05}$ 是 $b_{0.05}(x)=0$ 的最左边实根（稳定平衡点），$s_{0.05}$ 是中间实根（鞍点）。\n平衡点是三次方程 $-x^3 + x + 0.05 = 0$ 的根。这个方程没有简单的整数或有理数根，所以必须通过数值方法求解。我们解这个多项式方程来找到三个实根。设排序后的根为 $r_1 < r_2 < r_3$。\n稳定性由导数 $b'(x) = 1-3x^2$ 在根处的值的符号确定。对于这种形式的倾斜双阱势，最左边和最右边的根对应于稳定平衡点，而中间的根是鞍点。\n因此，$a_{0.05} = r_1$ 且 $s_{0.05} = r_2$。数值计算得出以下根的近似值：\n$r_1 \\approx -0.975333$\n$r_2 \\approx -0.0500125$\n$r_3 \\approx 1.025345$\n所以，我们有 $a_{0.05} \\approx -0.975333$ 和 $s_{0.05} \\approx -0.0500125$。\n\n拟势使用反导数 $F_{0.05}(x) = \\frac{1}{2}x^2 - \\frac{1}{4}x^4 + 0.05x$ 来计算。\n$$\nV(a_{0.05}, s_{0.05}) = -2 \\big( F_{0.05}(s_{0.05}) - F_{0.05}(a_{0.05}) \\big).\n$$\n代入数值确定的 $a_{0.05}$ 和 $s_{0.05}$ 的值：\n$F_{0.05}(s_{0.05}) = \\frac{1}{2}(-0.0500125)^2 - \\frac{1}{4}(-0.0500125)^4 + 0.05(-0.0500125) \\approx -0.00125031$。\n$F_{0.05}(a_{0.05}) = \\frac{1}{2}(-0.975333)^2 - \\frac{1}{4}(-0.975333)^4 + 0.05(-0.975333) \\approx 0.200155$。\n$$\nV(a_{0.05}, s_{0.05}) \\approx -2 ( -0.00125031 - 0.200155 ) = -2 ( -0.20140531 ) \\approx 0.40281.\n$$\n在实现中将进行更精确的计算。\n\n**测试用例 3：在平衡点处的拟势，$\\delta=0.05$**\n\n这个用例要求计算 $V(a_{0.05}, a_{0.05})$ 的值。\n根据定义，从一个点到其自身的拟势是在所有从该点开始并结束的路径上的作用量泛函的下确界。平凡路径 $x(t) = a_{0.05}$（对于所有 $t$）满足 $\\dot{x}(t)=0$。由于 $a_{0.05}$ 是一个平衡点，所以 $b_{0.05}(a_{0.05})=0$。该路径的作用量是：\n$$\nS_T[x] = \\frac{1}{2}\\int_0^T (\\dot{x}(t)-b(x(t)))^2\\,dt = \\frac{1}{2}\\int_0^T (0-0)^2\\,dt = 0.\n$$\n由于作用量是非负的，这条路径达到了下确界，因此 $V(a_{0.05}, a_{0.05}) = 0$。\n这也通过积分公式得到证实：\n$$\nV(a_{0.05}, a_{0.05}) = -2 \\int_{a_{0.05}}^{a_{0.05}} b_{0.05}(s)\\,ds = 0.\n$$\n此测试用例的值精确为 $0.0$。\n\n总而言之，这三个测试用例需要直接应用所提供的拟势公式，主要的计算挑战在于第二个用例中多项式根的数值求解。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the quasipotential for three test cases based on the\n    Freidlin-Wentzell theory for a one-dimensional bistable system.\n    \"\"\"\n\n    results = []\n\n    def F_delta(x, delta):\n        \"\"\"\n        Computes the antiderivative of the drift b_delta(x) = x - x^3 + delta.\n        The antiderivative is F_delta(x) = 0.5*x^2 - 0.25*x^4 + delta*x.\n        \"\"\"\n        return 0.5 * x**2 - 0.25 * x**4 + delta * x\n\n    def calculate_V(a, s, delta):\n        \"\"\"\n        Calculates the quasipotential V(a, s) = -2 * (F_delta(s) - F_delta(a)).\n        \"\"\"\n        val = -2.0 * (F_delta(s, delta) - F_delta(a, delta))\n        return val\n\n    # --- Test Case 1: delta = 0 ---\n    # The drift is b_0(x) = x - x^3. The equilibria are the roots of x - x^3 = 0,\n    # which are x = -1, 0, 1.\n    # a_0 = -1 (stable equilibrium), s_0 = 0 (saddle).\n    delta_1 = 0.0\n    a_1 = -1.0\n    s_1 = 0.0\n    V_1 = calculate_V(a_1, s_1, delta_1)\n    results.append(V_1)\n\n    # --- Test Case 2: delta = 0.05 ---\n    # The drift is b_0.05(x) = x - x^3 + 0.05.\n    # We need to find the roots of -x^3 + x + 0.05 = 0.\n    delta_2 = 0.05\n    # The polynomial coefficients for p[0]*x^3 + p[1]*x^2 + p[2]*x^1 + p[3]*x^0 = 0\n    # are for -x^3 + 0*x^2 + 1*x + 0.05 = 0.\n    coeffs = [-1.0, 0.0, 1.0, delta_2]\n    roots = np.roots(coeffs)\n    \n    # Sort the roots to identify the leftmost (a_delta) and middle (s_delta) roots.\n    # The discriminant is positive, so there are three distinct real roots.\n    roots.sort()\n    a_2 = roots[0]  # Leftmost root, the stable equilibrium.\n    s_2 = roots[1]  # Middle root, the saddle point.\n    \n    V_2 = calculate_V(a_2, s_2, delta_2)\n    results.append(V_2)\n    \n    # --- Test Case 3: delta = 0.05, V(a, a) ---\n    # The quasipotential from an equilibrium point to itself is always 0.\n    # This can be seen from the integral definition:\n    # V(a, a) = -2 * integral from a to a of b(s)ds = 0.\n    V_3 = 0.0\n    results.append(V_3)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2992469"}]}