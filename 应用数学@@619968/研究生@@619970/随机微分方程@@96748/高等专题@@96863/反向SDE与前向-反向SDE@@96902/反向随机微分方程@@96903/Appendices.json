{"hands_on_practices": [{"introduction": "掌握倒向随机微分方程（BSDEs）的最好方法就是亲手求解它们。我们将从最基础的情形开始：一个驱动项为零的 BSDE。这个练习直接揭示了 BSDE 理论的核心思想，即解的过程 $Y_t$ 是对终值 $\\xi$ 在 $\\mathcal{F}_t$ 信息下的条件期望，即 $Y_t = \\mathbb{E}[\\xi|\\mathcal{F}_t]$。通过为一个二次终值计算其初始值 $Y_0$，你将巩固这一基本联系。[@problem_id:841719]", "problem": "考虑一个完备的带滤概率空间 $(\\Omega, \\mathcal{F}, \\{\\mathcal{F}_t\\}_{t \\geq 0}, P)$，其上定义了一个标准一维布朗运动 $W_t$，且 $W_0=0$。\n\n设随机过程 $X_t$ 是一个算术布朗运动，由以下随机微分方程 (SDE) 控制：\n$$\ndX_t = \\mu dt + \\sigma dW_t\n$$\n其中漂移 $\\mu$ 和波动率 $\\sigma > 0$ 为常数，初始条件 $X_0 = x_0$ 为确定性的。\n\n现在，考虑一对适应随机过程 $(Y_t, Z_t)$，它在时间区间 $[0, T]$ 上解下面的倒向随机微分方程 (BSDE)：\n$$\n-dY_t = -Z_t dW_t\n$$\n这等价于 $dY_t = Z_t dW_t$。该过程满足以下终端条件：\n$$\nY_T = X_T^2\n$$\n请用参数 $x_0, \\mu, \\sigma$ 和 $T$ 推导出 $Y_0$ 的值。", "solution": "对于倒向随机微分方程 \n$$dY_t=Z_t\\,dW_t,\\quad Y_T=X_T^2,$$\n其生成元为零，因此 \n$$Y_t=E\\bigl[X_T^2\\mid\\mathcal{F}_t\\bigr].$$\n特别地，\n$$Y_0=E[X_T^2].$$\n随机微分方程 \n$$dX_t=\\mu\\,dt+\\sigma\\,dW_t$$\n的解为\n$$X_T=x_0+\\mu T+\\sigma W_T.$$\n因此\n$$E[X_T]=x_0+\\mu T,\\quad \\mathrm{Var}(X_T)=\\sigma^2T,$$\n且\n$$E[X_T^2]=\\bigl(E[X_T]\\bigr)^2+\\mathrm{Var}(X_T)\n=(x_0+\\mu T)^2+\\sigma^2T.$$\n所以，\n$$Y_0=(x_0+\\mu T)^2+\\sigma^2T.$$", "answer": "$$\\boxed{(x_0 + \\mu T)^2 + \\sigma^2 T}$$", "id": "841719"}, {"introduction": "在理解了过程 $Y_t$ 之后，我们的下一个重点是分析解的另一个关键部分：控制过程 $Z_t$。此练习引入了一个来自 Malliavin 积分的强大工具——Clark-Ocone 公式，它为 $Z_t$ 提供了一个明确的表达式。通过为终值 $W_T^2$ 计算 $Z_t$，你将对 BSDE 解的精细结构获得更深刻的理解，并看到理论与计算是如何结合的。[@problem_id:2969602]", "problem": "设 $\\left(\\Omega,\\mathcal{F},\\{\\mathcal{F}_t\\}_{t\\in[0,T]},\\mathbb{P}\\right)$ 是一个完备的带滤概率空间，其上定义了一个一维标准布朗运动 $W=\\{W_t\\}_{t\\in[0,T]}$，该空间带有其增广的自然滤子。固定 $T\\in(0,\\infty)$。考虑具确定性驱动项的倒向随机微分方程 (BSDE)\n$$\nY_t \\;=\\; h(W_T) \\;+\\; \\int_t^T g(s)\\,ds \\;-\\; \\int_t^T Z_s\\,dW_s,\\qquad t\\in[0,T],\n$$\n其中 $g\\in L^2([0,T])$ 是确定性的，$h:\\mathbb{R}\\to\\mathbb{R}$ 满足 $h(W_T)\\in L^2(\\Omega)$ 且 $h\\in\\mathbb{D}^{1,2}$，即平方可积、Malliavin 可微泛函的 Malliavin–Sobolev 空间。假设满足标准条件，保证在 $L^2$ 中解 $(Y,Z)$ 的存在性和唯一性。\n\n1) 从 Malliavin 积分学中的 Itô 表示定理和 Clark–Ocone 公式出发，推导被积函数 $Z$ 用终端条件的 Malliavin 导数表示的形式。特别地，证明对于几乎所有的 $t\\in[0,T]$，\n$$\nZ_t \\;=\\; \\mathbb{E}\\!\\left[\\,D_t h(W_T)\\,\\middle|\\,\\mathcal{F}_t\\right].\n$$\n\n2) 当 $h(x)=x^2$ 时，计算 $Z_t$ 的显式闭式表达式，并将答案简化为仅含 $t$ 和 $W_t$ 的函数。提供最终表达式的精确形式，无需四舍五入。", "solution": "该问题分为两部分。第一部分要求使用 Malliavin 积分学中的工具，推导倒向随机微分方程 (BSDE) 中过程 $Z_t$ 的一般表示。第二部分要求针对一个特定的终端条件，显式计算 $Z_t$。\n\n**第一部分：推导 $Z_t$ 的表示**\n\n我们已知 BSDE：\n$$Y_t = h(W_T) + \\int_t^T g(s)\\,ds - \\int_t^T Z_s\\,dW_s, \\quad t\\in[0,T]$$\n其中 $g$ 是 $L^2([0,T])$ 中的一个确定性函数，$h(W_T) \\in L^2(\\Omega)$ 且 $h \\in \\mathbb{D}^{1,2}$。数对 $(Y_t, Z_t)$ 是此方程的适应解。\n\n我们可以将 BSDE 重写为微分形式。对于 $t \\in [0,T]$，$Y_t$ 的动态由下式给出：\n$$dY_t = -g(t)\\,dt + Z_t\\,dW_t$$\n让我们定义一个新过程 $M_t$，通过将确定性漂移项加回到 $Y_t$ 中：\n$$M_t = Y_t + \\int_0^t g(s)\\,ds$$\n$M_t$ 的随机微分是：\n$$dM_t = dY_t + g(t)\\,dt = (-g(t)\\,dt + Z_t\\,dW_t) + g(t)\\,dt = Z_t\\,dW_t$$\n这意味着 $M_t$ 是一个局部鞅。由于假设解 $(Y,Z)$ 存在于通常的 $L^2$ 空间中，这意味着 $\\mathbb{E}[\\int_0^T Z_s^2 ds] < \\infty$，因此过程 $M_t$ 是一个真鞅。\n\n因为 $M_t$ 是关于滤子 $\\{\\mathcal{F}_t\\}_{t \\in [0,T]}$ 的鞅，所以对于所有 $t \\in [0,T]$，它必须满足属性 $M_t = \\mathbb{E}[M_T | \\mathcal{F}_t]$。\n让我们确定终端值 $M_T$。在时间 $t=T$ 时，BSDE 给出 $Y_T = h(W_T)$。因此，\n$$M_T = Y_T + \\int_0^T g(s)\\,ds = h(W_T) + \\int_0^T g(s)\\,ds$$\n由于积分 $\\int_0^T g(s)\\,ds$ 是一个确定性常数，鞅 $M_t$ 可以表示为：\n$$M_t = \\mathbb{E}\\left[h(W_T) + \\int_0^T g(s)\\,ds \\, \\middle| \\, \\mathcal{F}_t\\right] = \\mathbb{E}[h(W_T)|\\mathcal{F}_t] + \\int_0^T g(s)\\,ds$$\n过程 $M_t$ 是一个 $\\mathcal{F}_t$-适应的、平方可积的鞅。滤子 $\\{\\mathcal{F}_t\\}_{t \\in [0,T]}$ 由布朗运动 $W_t$ 生成。鞅表示定理指出，任何这样的鞅都可以写成关于 $W_t$ 的随机积分。我们已经从 $M_t$ 的定义中得到了一个这样的表示：\n$$M_t = M_0 + \\int_0^t Z_s\\,dW_s$$\nClark-Ocone 公式为布朗运动泛函的鞅表示中的被积函数提供了显式表达式。具体来说，对于一个 $\\mathcal{F}_T$-可测的随机变量 $F \\in \\mathbb{D}^{1,2}$，鞅 $N_t = \\mathbb{E}[F|\\mathcal{F}_t]$ 具有以下表示：\n$$N_t = \\mathbb{E}[F] + \\int_0^t \\mathbb{E}[D_s F | \\mathcal{F}_s]\\,dW_s$$\n其中 $D_s$ 是 Malliavin 导数算子。\n\n让我们将此应用于我们的鞅 $M_t = \\mathbb{E}[M_T|\\mathcal{F}_t]$。其表示中的被积函数由 $\\mathbb{E}[D_t M_T | \\mathcal{F}_t]$ 给出。根据鞅表示被积函数的唯一性，我们可以将 $Z_t$ 等同于这个表达式：\n$$Z_t = \\mathbb{E}[D_t M_T | \\mathcal{F}_t]$$\n我们现在计算 $M_T$ 的 Malliavin 导数：\n$$D_t M_T = D_t \\left(h(W_T) + \\int_0^T g(s)\\,ds\\right)$$\nMalliavin 导数是一个线性算子。项 $\\int_0^T g(s)\\,ds$ 是一个确定性常数，任何常数的 Malliavin 导数都是 0。因此：\n$$D_t M_T = D_t h(W_T) + D_t\\left(\\int_0^T g(s)\\,ds\\right) = D_t h(W_T) + 0 = D_t h(W_T)$$\n将此代入我们关于 $Z_t$ 的表达式中，我们得到期望的结果：\n$$Z_t = \\mathbb{E}[D_t h(W_T) | \\mathcal{F}_t]$$\n这对于几乎所有的 $t \\in [0,T]$ 都成立。这个结果表明，BSDE 中的被积函数 $Z_t$ 是终端值泛函 $h(W_T)$ 的 Malliavin 导数的条件期望。涉及 $g(s)$ 的项影响过程 $Y_t$，但不影响鞅分量 $Z_t$。\n\n**第二部分：$h(x)=x^2$ 的显式计算**\n\n我们已知特定的终端条件泛函 $h(x) = x^2$，因此终端条件是 $Y_T = h(W_T) = W_T^2$。为了找到 $Z_t$，我们使用第一部分中推导的公式：\n$$Z_t = \\mathbb{E}[D_t(W_T^2) | \\mathcal{F}_t]$$\n首先，我们计算 Malliavin 导数 $D_t(W_T^2)$。我们使用 Malliavin 导数的链式法则，该法则指出，对于一个可微函数 $f:\\mathbb{R}\\to\\mathbb{R}$ 和一个 Malliavin 可微的随机变量 $F$，有 $D_t(f(F)) = f'(F) D_t(F)$。\n这里，$f(x)=x^2$ 且 $F=W_T$。导数是 $f'(x) = 2x$。所以，\n$$D_t(W_T^2) = 2 W_T \\cdot D_t(W_T)$$\n布朗运动 $W_s$ 在时间 $t$ 的 Malliavin 导数是指示函数 $D_t(W_s) = \\mathbf{1}_{[0,s]}(t)$。对于 $s=T$，我们有 $D_t(W_T) = \\mathbf{1}_{[0,T]}(t)$。由于我们考虑的是 $t \\in [0,T]$，对于此区间内几乎所有的 $t$，$\\mathbf{1}_{[0,T]}(t) = 1$。\n因此，Malliavin 导数是：\n$$D_t(W_T^2) = 2W_T \\cdot 1 = 2W_T$$\n现在，我们将此代入 $Z_t$ 的表达式中：\n$$Z_t = \\mathbb{E}[2W_T | \\mathcal{F}_t]$$\n根据条件期望的线性性，这变为：\n$$Z_t = 2 \\mathbb{E}[W_T | \\mathcal{F}_t]$$\n为了计算条件期望，我们利用布朗运动是鞅的性质。我们可以将 $W_T$ 写成其在时间 $t$ 的值与一个未来增量之和：\n$$W_T = W_t + (W_T - W_t)$$\n取关于 $\\mathcal{F}_t$ 的条件期望：\n$$\\mathbb{E}[W_T | \\mathcal{F}_t] = \\mathbb{E}[W_t + (W_T - W_t) | \\mathcal{F}_t] = \\mathbb{E}[W_t | \\mathcal{F}_t] + \\mathbb{E}[W_T - W_t | \\mathcal{F}_t]$$\n由于 $W_t$ 是 $\\mathcal{F}_t$-可测的，所以 $\\mathbb{E}[W_t | \\mathcal{F}_t] = W_t$。对于 $t < T$，增量 $W_T - W_t$ 独立于滤子 $\\mathcal{F}_t$。因此，它的条件期望等于它的无条件期望：\n$$\\mathbb{E}[W_T - W_t | \\mathcal{F}_t] = \\mathbb{E}[W_T - W_t] = \\mathbb{E}[W_T] - \\mathbb{E}[W_t] = 0 - 0 = 0$$\n结合这些结果，我们得到：\n$$\\mathbb{E}[W_T | \\mathcal{F}_t] = W_t + 0 = W_t$$\n最后，我们将此代回到 $Z_t$ 的表达式中：\n$$Z_t = 2 \\mathbb{E}[W_T | \\mathcal{F}_t] = 2W_t$$\n这就是 $Z_t$ 作为 $t$ 和 $W_t$ 的函数的显式闭式表达式。", "answer": "$$\\boxed{2W_t}$$", "id": "2969602"}, {"introduction": "现在，我们来处理一类更具普遍性和实用性的方程：线性 BSDE，其驱动项 $f$ 非零。这类方程在金融定价和随机控制等应用领域中频繁出现。本练习将引导你使用积分因子和测度变换（Girsanov 定理）的系统方法来求解，这不仅展示了 BSDE 工具箱中的一项关键技术，也加深了你对随机分析中不同概念之间联系的理解。[@problem_id:772846]", "problem": "设 $(\\Omega, \\mathcal{F}, (\\mathcal{F}_t)_{t \\in [0,T]}, P)$ 是一个赋流概率空间，其上支撑一个标准一维布朗运动 $W_t$，且 $W_0 = 0$。\n\n考虑一对适应过程 $(Y_t, Z_t)$，它是以下倒向随机微分方程 (BSDE) 的解：\n$$-dY_t = (\\alpha Y_t + \\beta Z_t + \\gamma) dt - Z_t dW_t$$\n其中 $t \\in [0, T]$，$\\alpha, \\beta, \\gamma$ 为实常数且 $\\alpha \\neq 0$，$T>0$ 是一个固定的终端时刻。\n\n过程 $Y_t$ 必须满足以下终端条件：\n$$Y_T = \\exp(\\lambda W_T)$$\n其中 $\\lambda$ 是一个实常数。\n\n你的任务是求出过程 $Y_t$ 在时刻 $t=0$ 的值。最终答案应为一个用常数 $\\alpha, \\beta, \\gamma, \\lambda$ 和 $T$ 表示的显式闭式表达式。", "solution": "我们考虑线性 BSDE \n$$-dY_t = (\\alpha Y_t + \\beta Z_t + \\gamma)\\,dt - Z_t\\,dW_t,\\quad Y_T=\\exp(\\lambda W_T)。$$\n1.  引入积分因子和 Girsanov 核：\n   $$\n   S_t = e^{\\alpha t}, \n   \\quad\n   \\Lambda_t = \\exp\\Bigl(\\beta W_t - \\tfrac12\\beta^2 t\\Bigr).\n   $$\n2.  线性 BSDE 的一般表示给出\n   $$\n   Y_t\n   =S_t^{-1}\\E\\Bigl[S_T\\,\\Lambda_T\\,Y_T\n            +\\int_t^T S_s\\,\\Lambda_s\\,\\gamma\\,ds\n            \\Bigm|\\F_t\\Bigr]。\n   $$\n3.  在 $t=0$ 时，我们有 $S_0=\\Lambda_0=1$ 且 $W_0=0$，所以\n   $$\n   Y_0\n   =\\E\\Bigl[e^{\\alpha T}\n   \\exp\\bigl(\\beta W_T-\\tfrac12\\beta^2T\\bigr)\n   \\exp(\\lambda W_T)\n   +\\gamma\\int_0^T e^{\\alpha s}\n        \\exp\\bigl(\\beta W_s-\\tfrac12\\beta^2s\\bigr)\\,ds\\Bigr]。\n   $$\n4.  使用 $W_T\\sim N(0,T)$ 计算第一项：\n   $$\n   \\E\\bigl[e^{(\\beta+\\lambda)W_T}\\bigr]\n   =e^{\\tfrac12(\\beta+\\lambda)^2T},\n   $$\n   所以\n   $$\n   e^{\\alpha T- \\tfrac12\\beta^2T}\n   \\E\\bigl[e^{(\\beta+\\lambda)W_T}\\bigr]\n   =\\exp\\Bigl(\\alpha T+\\beta\\lambda T+\\tfrac12\\lambda^2T\\Bigr)。\n   $$\n5.  对于第二项，对每个 $s$，\n   $$\n   \\E\\bigl[e^{\\beta W_s-\\tfrac12\\beta^2s}\\bigr]\n   =1,\n   $$\n   所以\n   $$\n   \\gamma\\int_0^T e^{\\alpha s}\\,ds\n   =\\frac\\gamma\\alpha\\bigl(e^{\\alpha T}-1\\bigr)。\n   $$\n6.  将两者相加得到\n   $$\n   Y_0\n   =\\exp\\Bigl((\\alpha+\\beta\\lambda+\\tfrac12\\lambda^2)T\\Bigr)\n   +\\frac\\gamma\\alpha\\bigl(e^{\\alpha T}-1\\bigr)。\n   $$", "answer": "$$\\boxed{\\exp\\bigl((\\alpha+\\beta\\lambda+\\tfrac12\\lambda^2)T\\bigr)+\\frac{\\gamma}{\\alpha}\\bigl(e^{\\alpha T}-1\\bigr)}$$", "id": "772846"}]}