{"hands_on_practices": [{"introduction": "这第一个练习将向你介绍反射倒向随机微分方程（RBSDE）理论的基石：Snell 包络表示法。通过求解一个看似简单的带有常数障碍的反射 BSDE，你将应用一个强大的思想，即其解可以被看作一个最优停时问题的价值 [@problem_id:841664]。这个动手计算将巩固你对 RBSDE 与最优控制之间深刻联系的理解，并为你的分析工具箱增添一个基础工具。", "problem": "考虑一个概率空间 $(\\Omega, \\mathcal{F}, P)$，其上赋予了一个由一维标准布朗运动 $W_t$（满足 $W_0=0$）生成的滤子 $(\\mathcal{F}_t)_{t \\in [0,T]}$。\n\n我们关注的是一个带常数下反射壁的一维倒向随机微分方程（BSDE）的解。令 $(Y_t, Z_t, K_t)$ 为满足以下反射倒向随机微分方程（RBSDE）的适应过程三元组：\n$$ Y_t = \\xi W_T^2 + K_T - K_t - \\int_t^T Z_s dW_s, \\quad t \\in [0,T] $$\n其中 $\\xi$ 是一个正常数。过程 $Y_t$ 被约束在常数障碍 $L$ 之上，我们假设 $L>0$ 且 $\\xi T > L$。过程 $K_t$ 是一个连续、非减的增过程，满足 $K_0=0$，它强制执行反射，并满足Skorokhod条件 $\\int_0^T (Y_t - L)dK_t = 0$。此条件意味着 $K_t$ 仅在 $Y_t$ 处于障碍 $L$ 处时才增加。\n\n该BSDE的驱动项为零，即 $f(t,y,z)=0$。终端条件由随机变量 $\\eta = \\xi W_T^2$ 给出。\n\n你的任务是求出过程 $Y_t$ 在时间 $t=0$ 处的值，即 $Y_0$。最终答案应为一个以参数 $L$、$\\xi$ 和 $T$ 表示的解析表达式。", "solution": "1. 对于驱动项 $f=0$ 且具有下障碍 $L$ 的反射BSDE，其解具有Snell包络表示\n$$\nY_t = \\operatorname*{ess\\,sup}_{\\tau\\in\\mathcal{T}_{t,T}}\n\\mathbb{E}\\bigl[\\xi W_T^2\\mathbf{1}_{\\{\\tau=T\\}}\n+L\\,\\mathbf{1}_{\\{\\tau<T\\}}\\bigm|\\mathcal{F}_t\\bigr].\n$$\n\n2. 继续值（鞅部分）为\n$$\nX_t = \\mathbb{E}[\\xi W_T^2\\mid\\mathcal{F}_t]\n= \\xi\\,\\mathbb{E}[W_T^2\\mid\\mathcal{F}_t]\n= \\xi\\bigl(W_t^2 + (T-t)\\bigr).\n$$\n\n3. Snell包络于是给出\n$$\nY_t = \\max\\bigl\\{X_t,\\;L\\bigr\\}\n= \\max\\bigl\\{\\xi(W_t^2 + T - t),\\;L\\bigr\\}.\n$$\n\n4. 在时间 $t=0$ 处，由于 $W_0=0$，\n$$\nX_0 = \\xi\\,T,\n$$\n并且在假设 $\\xi T > L$ 下，我们有\n$$\nY_0 = \\xi\\,T.\n$$", "answer": "$$\\boxed{\\xi T}$$", "id": "841664"}, {"introduction": "标准的 BSDE 存在唯一性定理严重依赖于生成元（generator）的 Lipschitz 连续性。本练习邀请你探索当这一假设不成立时会发生什么——这在更高级的模型中是常见情况。通过为一个确定性版本的 RBSDE 显式地构建多个不同的解，你将亲身体会到为何理论条件如此重要，以及违反这些条件如何导致解的唯一性失效 [@problem_id:2993408]。", "problem": "设 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\in[0,T]},\\mathbb{P})$ 是一个带流概率空间，其上支撑着一个一维标准布朗运动 $W$。考虑具有下障碍 $S=(S_t)_{t\\in[0,T]}$、终端条件 $\\xi$ 和生成元 $f$ 的反射倒向随机微分方程 (RBSDE)，即一个循序可测过程三元组 $(Y,Z,K)$，它对所有 $t\\in[0,T]$ 几乎必然满足\n$$\nY_t=\\xi+\\int_t^T f(s,Y_s,Z_s)\\,ds+K_T-K_t-\\int_t^T Z_s\\,dW_s,\n$$\n同时满足对所有 $t$，有 $Y_t\\ge S_t$，$K$ 是非减的且 $K_0=0$，以及 Skorokhod 最小性条件 $\\int_0^T (Y_s-S_s)\\,dK_s=0$。\n\n取确定性数据 $S_t\\equiv 0$，$\\xi\\equiv 0$，以及在 $y\\ge 0$ 上与时间和 $z$ 无关的生成元 $f(t,y,z)=3\\,y^{1/3}$。完全在此确定性设置下进行求解。仅从上述定义性质出发，证明该 RBSDE 至少存在两个形式为 $Z\\equiv 0$ 和 $K\\equiv 0$ 的不同解 $(Y,Z,K)$，并计算你所构造的两个不同解 $Y^{(1)}$ 和 $Y^{(2)}$ 的初始值之差 $Y^{(1)}_0-Y^{(2)}_0$。你的最终答案必须是关于 $T$ 的单个闭式解析表达式。", "solution": "我们在确定性设置下工作，并寻求形式为 $Z_t \\equiv 0$ 和 $K_t \\equiv 0$ 的解。设 $Y_t = y(t)$ 是一个关于时间的确定性函数。\n\n将 $\\xi=0$, $Z_t \\equiv 0$, $K_t \\equiv 0$ 和 $f(s, y(s), 0) = 3(y(s))^{\\frac{1}{3}}$ 代入 RBSDE 定义中，我们得到一个确定性积分方程：\n$$\ny(t) = \\int_t^T 3(y(s))^{\\frac{1}{3}}\\,ds\n$$\n对其关于 $t$ 求导，并结合在 $t=T$ 时的值，我们得到以下终端值问题：\n$$\n\\frac{dy}{dt} = -3y^{\\frac{1}{3}}, \\quad y(T)=0\n$$\nRBSDE 的其余条件（$Y_t \\ge S_t=0$ 和斯科罗霍德条件）也被满足，只要解 $y(t)$ 是非负的。\n\n由于生成元 $f(y) = 3y^{\\frac{1}{3}}$ 在 $y=0$ 处不满足利普希茨连续条件，该常微分方程的解不唯一。\n\n首先，可以立即看出 $Y^{(2)}_t = y(t) \\equiv 0$ 是一个解。\n\n为了寻找其他解，我们假设 $y(t) \\neq 0$ 并使用分离变量法：\n$$\ny^{-\\frac{1}{3}} dy = -3 dt\n$$\n对两边从时间 $t$ 积分到终端时间 $T$：\n$$\n\\int_{y(t)}^{y(T)=0} u^{-\\frac{1}{3}} du = \\int_t^T -3 ds\n$$\n$$\n\\left[ \\frac{3}{2}u^{\\frac{2}{3}} \\right]_{y(t)}^{0} = [-3s]_t^T\n$$\n$$\n-\\frac{3}{2} (y(t))^{\\frac{2}{3}} = -3(T-t)\n$$\n$$\n(y(t))^{\\frac{2}{3}} = 2(T-t)\n$$\n解出 $y(t)$，我们得到另一个解 $Y^{(1)}_t = (2(T-t))^{\\frac{3}{2}}$，它在 $[0, T]$ 上也是非负的。\n\n我们构造了两个不同的解：$Y^{(1)}_t=(2(T-t))^{\\frac{3}{2}}$ 和 $Y^{(2)}_t=0$。它们初始值之差为：\n$$\nY^{(1)}_0 - Y^{(2)}_0 = (2(T-0))^{\\frac{3}{2}} - 0 = (2T)^{\\frac{3}{2}}\n$$", "answer": "$$\\boxed{(2T)^{\\frac{3}{2}}}$$", "id": "2993408"}, {"introduction": "接下来我们进入一个更高级的主题，本问题将处理在 $Z$ 变量上具有二次增长的 BSDE，这类方程在数学金融和随机控制中广泛存在。标准的 BSDE 技术通常不足以解决这些情况，需要在随机分析与偏微分方程（PDE）的世界之间架起一座桥梁 [@problem_id:2993400]。本练习将引导你运用精妙的 Hopf-Cole 变换，这是一种求解相关非线性 PDE 的强大方法，从而为 BSDE 提供显式解，并展示随机分析与确定性分析之间美妙的相互作用。", "problem": "考虑一个带流的概率空间，其上支撑着一个一维布朗运动 $W=(W_{t})_{t \\in [0,T]}$，该流为 $W$ 的自然（完备）流。令 $(Y,Z,K)$ 为反射倒向随机微分方程（RBSDE）的解，其下界障碍为 $S=(S_{t})_{t \\in [0,T]}$ 且从不生效（等价地，$S_{t}$ 取值足够低以至于 $K \\equiv 0$，此时 RBSDE 退化为经典的倒向随机微分方程），其生成元为 $g(t,y,z)=\\frac{1}{2}|z|^{2}$，终端条件为\n$$\n\\xi \\;=\\; \\ln\\!\\big((W_{T}-a)_{+}\\big),\n$$\n其中 $a>0$ 为一固定常数且 $(x)_{+}=\\max\\{x,0\\}$。假设具有二次增长生成元的倒向随机微分方程的常规存在唯一性框架成立。\n\n仅从倒向随机微分方程的定义、Itô 公式以及给定 $\\mathcal{F}_{t}$ 时 $W_{T}$ 的条件分布是均值为 $W_{t}$、方差为 $T-t$ 的高斯分布这一事实出发，推导 $Z_{t}$ 关于 $t$ 和 $W_{t}$ 的精确表达式，并确定在事件 $\\{W_{T}<a\\}$ 上，当 $t \\uparrow T$ 时 $(T-t)\\,Z_{t}$ 的几乎必然极限。你的最终答案必须是单一的闭式解析表达式（不含不等式或方程）。", "solution": "该问题要求解出过程 $Z_t$ 的表达式，以及在事件 $\\{W_T < a\\}$ 上，当 $t \\uparrow T$ 时 $(T-t)Z_t$ 对于一个倒向随机微分方程（BSDE）的几乎必然极限。\n\n问题陈述中提到下界障碍 $S_t$ 从不生效，这意味着反射倒向随机微分方程（RBSDE）中的过程 $K$ 恒等于零。因此，该 RBSDE 退化为关于过程对 $(Y_t, Z_t)_{t \\in [0,T]}$ 的经典 BSDE：\n$$dY_t = -g(t, Y_t, Z_t) dt + Z_t dW_t, \\quad Y_T = \\xi$$\n给定生成元为 $g(t,y,z) = \\frac{1}{2}|z|^2 = \\frac{1}{2}z^2$ （因为 $Z_t$ 是实值过程），终端条件为 $\\xi = \\ln((W_T-a)_+)$, 其中 $(x)_+ = \\max\\{x,0\\}$ 且 $a>0$ 是一个常数。\n因此，该 BSDE 为：\n$$dY_t = -\\frac{1}{2}Z_t^2 dt + Z_t dW_t, \\quad Y_T = \\ln((W_T - a)_+)$$\n\n求解此类 BSDE，特别是像本题这样与马尔可夫设定相关的 BSDE，一个标准方法是寻找形如 $Y_t = u(t, W_t)$ 的解，其中 $u:[0,T] \\times \\mathbb{R} \\to \\mathbb{R}$ 是一个确定性函数。\n对 $Y_t = u(t, W_t)$ 应用 Itô 公式可得：\n$$dY_t = \\left(\\frac{\\partial u}{\\partial t}(t, W_t) + \\frac{1}{2}\\frac{\\partial^2 u}{\\partial x^2}(t, W_t)\\right) dt + \\frac{\\partial u}{\\partial x}(t, W_t) dW_t$$\n通过比较此表达式与 BSDE 中 $dt$ 和 $dW_t$ 的系数，我们发现：\n$$Z_t = \\frac{\\partial u}{\\partial x}(t, W_t)$$\n以及\n$$\\frac{\\partial u}{\\partial t}(t, W_t) + \\frac{1}{2}\\frac{\\partial^2 u}{\\partial x^2}(t, W_t) = -\\frac{1}{2}Z_t^2 = -\\frac{1}{2}\\left(\\frac{\\partial u}{\\partial x}(t, W_t)\\right)^2$$\n这意味着函数 $u(t,x)$ 必须是以下非线性偏微分方程（PDE）的经典解，该方程是 Burgers 方程的一种形式：\n$$\\frac{\\partial u}{\\partial t} + \\frac{1}{2}\\frac{\\partial^2 u}{\\partial x^2} + \\frac{1}{2}\\left(\\frac{\\partial u}{\\partial x}\\right)^2 = 0$$\n该 PDE 的终端条件由 BSDE 的终端条件给出：\n$$u(T,x) = \\ln((x-a)_+)$$\n\n这个非线性 PDE 可以通过 Hopf-Cole 变换进行线性化。令 $v(t,x) = \\exp(u(t,x))$。$u$ 关于 $v$ 的导数是：\n$$\\frac{\\partial u}{\\partial t} = \\frac{1}{v}\\frac{\\partial v}{\\partial t}, \\quad \\frac{\\partial u}{\\partial x} = \\frac{1}{v}\\frac{\\partial v}{\\partial x}, \\quad \\frac{\\partial^2 u}{\\partial x^2} = \\frac{1}{v}\\frac{\\partial^2 v}{\\partial x^2} - \\frac{1}{v^2}\\left(\\frac{\\partial v}{\\partial x}\\right)^2$$\n将这些代入关于 $u$ 的 PDE 中：\n$$\\frac{1}{v}\\frac{\\partial v}{\\partial t} + \\frac{1}{2}\\left(\\frac{1}{v}\\frac{\\partial^2 v}{\\partial x^2} - \\frac{1}{v^2}\\left(\\frac{\\partial v}{\\partial x}\\right)^2\\right) + \\frac{1}{2}\\left(\\frac{1}{v}\\frac{\\partial v}{\\partial x}\\right)^2 = 0$$\n$$\\frac{1}{v}\\frac{\\partial v}{\\partial t} + \\frac{1}{2v}\\frac{\\partial^2 v}{\\partial x^2} - \\frac{1}{2v^2}\\left(\\frac{\\partial v}{\\partial x}\\right)^2 + \\frac{1}{2v^2}\\left(\\frac{\\partial v}{\\partial x}\\right)^2 = 0$$\n假设 $v(t,x)>0$（如果 $u$ 是实值函数，则此假设成立），我们两边乘以 $v$ 得到线性倒向热方程：\n$$\\frac{\\partial v}{\\partial t} + \\frac{1}{2}\\frac{\\partial^2 v}{\\partial x^2} = 0$$\n$v$ 的终端条件是 $v(T,x) = \\exp(u(T,x)) = \\exp(\\ln((x-a)_+)) = (x-a)_+$。\n\n具有终端条件 $v(T,x)$ 的倒向热方程的解由 Feynman-Kac 公式给出，在本例中，该公式简化为求条件期望：\n$$v(t,x) = \\mathbb{E}[v(T,W_T) | W_t=x] = \\mathbb{E}[(W_T-a)_+ | W_t=x]$$\n给定 $W_t=x$，$W_T$ 的分布是均值为 $x$、方差为 $T-t$ 的高斯分布。令 $\\phi_{m,s^2}(y)$ 为 $\\mathcal{N}(m,s^2)$ 分布的概率密度函数（PDF）。\n$$v(t,x) = \\int_{-\\infty}^{\\infty} (y-a)_+ \\frac{1}{\\sqrt{2\\pi(T-t)}} \\exp\\left(-\\frac{(y-x)^2}{2(T-t)}\\right) dy$$\n$$v(t,x) = \\int_{a}^{\\infty} (y-a) \\frac{1}{\\sqrt{2\\pi(T-t)}} \\exp\\left(-\\frac{(y-x)^2}{2(T-t)}\\right) dy$$\n这是 Bachelier 模型中一个欧式看涨期权的价值。其闭式解是众所周知的。令 $\\Phi(\\cdot)$ 和 $\\phi(\\cdot)$ 分别为标准正态分布的累积分布函数（CDF）和概率密度函数（PDF）。令 $d = \\frac{x-a}{\\sqrt{T-t}}$。该积分的计算结果为：\n$$v(t,x) = (x-a)\\Phi\\left(\\frac{x-a}{\\sqrt{T-t}}\\right) + \\sqrt{T-t}\\phi\\left(\\frac{x-a}{\\sqrt{T-t}}\\right)$$\n\n现在我们推导 $Z_t$ 的表达式。我们有 $Z_t = \\frac{\\partial u}{\\partial x}(t,W_t)$。由于 $u = \\ln(v)$，我们有 $\\frac{\\partial u}{\\partial x} = \\frac{1}{v}\\frac{\\partial v}{\\partial x}$。我们需要计算 $\\frac{\\partial v}{\\partial x}$。\n令 $d(x) = \\frac{x-a}{\\sqrt{T-t}}$。则 $\\frac{\\partial d}{\\partial x} = \\frac{1}{\\sqrt{T-t}}$。\n$$\\frac{\\partial v}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[(x-a)\\Phi(d(x)) + \\sqrt{T-t}\\phi(d(x))\\right]$$\n使用乘法法则和链式法则：\n$$\\frac{\\partial v}{\\partial x} = \\left[1 \\cdot \\Phi(d) + (x-a)\\phi(d)\\frac{\\partial d}{\\partial x}\\right] + \\sqrt{T-t}\\left(-d \\phi(d)\\right)\\frac{\\partial d}{\\partial x}$$\n$$\\frac{\\partial v}{\\partial x} = \\Phi(d) + (x-a)\\phi(d)\\frac{1}{\\sqrt{T-t}} - \\sqrt{T-t} \\cdot d \\cdot \\phi(d)\\frac{1}{\\sqrt{T-t}}$$\n由于 $d = \\frac{x-a}{\\sqrt{T-t}}$，项 $(x-a)\\frac{1}{\\sqrt{T-t}}$ 就是 $d$。\n$$\\frac{\\partial v}{\\partial x} = \\Phi(d) + d\\phi(d) - d\\phi(d) = \\Phi(d)$$\n这是一个非常简洁的结果。因此，我们有：\n$$Z_t = \\frac{\\frac{\\partial v}{\\partial x}(t,W_t)}{v(t,W_t)} = \\frac{\\Phi\\left(\\frac{W_t-a}{\\sqrt{T-t}}\\right)}{(W_t-a)\\Phi\\left(\\frac{W_t-a}{\\sqrt{T-t}}\\right) + \\sqrt{T-t}\\phi\\left(\\frac{W_t-a}{\\sqrt{T-t}}\\right)}$$\n这就是 $Z_t$ 关于 $t$ 和 $W_t$ 的精确表达式。\n\n接下来，我们确定在事件 $\\{W_T < a\\}$ 上，当 $t \\uparrow T$ 时 $(T-t)Z_t$ 的几乎必然极限。\n令 $d_t = \\frac{W_t-a}{\\sqrt{T-t}}$。在事件 $\\{W_T < a\\}$ 上，当 $t \\uparrow T$ 时，$W_t \\to W_T < a$。因此，分子 $W_t-a$ 收敛到一个负数 $W_T-a$，而分母 $\\sqrt{T-t}$ 趋向于 $0$。所以，$d_t \\to -\\infty$ 几乎必然。\n\n我们可以通过重写表达式来分析 $(T-t)Z_t$ 的渐近行为：\n$$(T-t)Z_t = \\frac{(T-t)\\Phi(d_t)}{(W_t-a)\\Phi(d_t) + \\sqrt{T-t}\\phi(d_t)} = \\frac{\\sqrt{T-t}\\Phi(d_t)}{d_t\\Phi(d_t) + \\phi(d_t)}$$\n对于大的负自变量 $d$，CDF $\\Phi(d)$ 的以下渐近展开式成立（与 Mill's ratio 相关）：\n$$\\Phi(d) \\sim -\\frac{\\phi(d)}{d} \\quad \\text{as } d \\to -\\infty$$\n我们使用这个展开式来分析分母 $d_t\\Phi(d_t) + \\phi(d_t)$：\n$$d_t\\Phi(d_t) + \\phi(d_t) \\sim d_t\\left(-\\frac{\\phi(d_t)}{d_t}\\right) + \\phi(d_t) = -\\phi(d_t) + \\phi(d_t) = 0$$\n这个一阶近似不足以确定极限。我们使用更精确的展开：$\\Phi(d) \\sim \\phi(d)(-\\frac{1}{d} + \\frac{1}{d^3})$。\n$$d_t\\Phi(d_t) + \\phi(d_t) \\sim d_t\\phi(d_t)\\left(-\\frac{1}{d_t} + \\frac{1}{d_t^3}\\right) + \\phi(d_t) = \\phi(d_t)\\left(-1 + \\frac{1}{d_t^2}\\right) + \\phi(d_t) = \\frac{\\phi(d_t)}{d_t^2}$$\n现在将此代回 $(T-t)Z_t$ 的表达式中：\n$$(T-t)Z_t \\approx \\frac{\\sqrt{T-t}\\Phi(d_t)}{\\frac{\\phi(d_t)}{d_t^2}}$$\n使用一阶近似 $\\Phi(d_t) \\sim -\\frac{\\phi(d_t)}{d_t}$：\n$$(T-t)Z_t \\approx \\frac{\\sqrt{T-t}\\left(-\\frac{\\phi(d_t)}{d_t}\\right)}{\\frac{\\phi(d_t)}{d_t^2}} = \\sqrt{T-t}(-d_t) = -\\sqrt{T-t} \\cdot \\frac{W_t-a}{\\sqrt{T-t}} = -(W_t-a) = a-W_t$$\n这个近似在极限情况下是精确的。因此，当 $t \\uparrow T$ 时：\n$$\\lim_{t \\uparrow T} (T-t)Z_t = \\lim_{t \\uparrow T} (a-W_t) = a-W_T$$\n此极限在事件 $\\{W_T < a\\}$ 上几乎必然成立。", "answer": "$$\\boxed{a-W_T}$$", "id": "2993400"}]}