{"hands_on_practices": [{"introduction": "建立不变测度存在性的一个基石是 Foster-Lyapunov 准则。这个强大的技术使我们能够在不显式求解平稳分布的情况下，证明一个系统是正常返的 (positive recurrent)。本练习 [@problem_id:2974640] 为多维 Ornstein-Uhlenbeck (OU) 过程——随机分析中的一个基本模型——提供了该方法的一个具体应用。通过构造一个简单的二次 Lyapunov 函数 $V(x)$ 并计算无穷小生成元 $\\mathcal{L}$ 在其上的作用，你将推导出一个漂移条件，该条件直观地显示了过程如何被持续地拉回原点，从而保证了紧致性和不变测度的存在性。", "problem": "考虑由随机微分方程 (SDE) 定义的 $d$ 维 Ornstein–Uhlenbeck (OU) 过程\n$$\n\\mathrm{d}X_t=-A X_t\\,\\mathrm{d}t+\\sigma\\,\\mathrm{d}W_t,\n$$\n其中 $A\\in\\mathbb{R}^{d\\times d}$，对称部分 $S=\\frac{1}{2}(A+A^{\\top})$ 满足 $S\\succeq m I$（对于某个 $m>0$），$\\sigma\\in\\mathbb{R}^{d\\times d}$ 是一个可逆的常数矩阵，$W_t$ 是标准的 $d$ 维布朗运动。令 $V:\\mathbb{R}^d\\to\\mathbb{R}$ 由 $V(x)=1+\\|x\\|^2$ 给出。仅从扩散的无穷小生成元及用于紧致性和不变测度存在的 Lyapunov 漂移准则的基本定义出发，完成以下任务：\n\n1. 计算 OU 过程的生成元 $\\mathcal{L}$ 作用于函数 $V$ 的结果，用 $A$、$\\sigma$ 和 $x$ 表示 $\\mathcal{L}V(x)$。\n2. 使用对称部分 $S$ 上的矫顽性条件，推导出一个形如\n$$\n\\mathcal{L}V(x)\\leq -\\alpha\\,V(x)+\\beta,\n$$\n的漂移不等式，该不等式对所有 $x\\in\\mathbb{R}^d$ 成立，其中显式常数 $\\alpha>0$ 和 $\\beta\\geq 0$ 仅依赖于 $m$ 和 $\\operatorname{tr}(\\sigma\\sigma^{\\top})$。\n3. 解释为何该漂移不等式能确保经验测度族的紧致性和至少一个不变概率测度的存在性，以及为何 $\\sigma$ 的非退化性与 OU 动力学的线性结构共同导致了不变测度的唯一性。\n\n你的最终答案必须是显式常数对 $(\\alpha,\\beta)$，以单一解析表达式的形式给出。无需四舍五入，且不包含任何单位。将最终答案表示为一个行矩阵。", "solution": "该问题提法恰当且科学上合理，是应用 Lyapunov 函数技术来确立线性随机微分方程遍历性质的标准范例。我们开始进行解答。\n\nOrnstein-Uhlenbeck (OU) 过程由以下 $d$ 维随机微分方程 (SDE) 描述：\n$$\n\\mathrm{d}X_t = b(X_t)\\,\\mathrm{d}t + \\Sigma(X_t)\\,\\mathrm{d}W_t\n$$\n其中漂移向量为 $b(x) = -A x$，扩散矩阵为常数矩阵 $\\Sigma(x) = \\sigma$。\n\n**1. 计算生成元在 $V(x)$ 上的作用**\n\n扩散过程的无穷小生成元 $\\mathcal{L}$ 作用于一个二次连续可微函数 $f: \\mathbb{R}^d \\to \\mathbb{R}$ 的基本定义由下式给出：\n$$\n\\mathcal{L}f(x) = \\sum_{i=1}^{d} b_i(x) \\frac{\\partial f}{\\partial x_i}(x) + \\frac{1}{2} \\sum_{i,j=1}^{d} \\left(\\Sigma(x)\\Sigma(x)^{\\top}\\right)_{ij} \\frac{\\partial^2 f}{\\partial x_i \\partial x_j}(x)\n$$\n用更紧凑的记法，即为 $\\mathcal{L}f(x) = \\langle b(x), \\nabla f(x) \\rangle + \\frac{1}{2} \\operatorname{tr}\\left(\\Sigma(x)\\Sigma(x)^{\\top} H_f(x)\\right)$，其中 $\\nabla f$ 是梯度，$H_f$ 是 $f$ 的 Hessian 矩阵。\n\n给定的 Lyapunov 函数为 $V(x) = 1 + \\|x\\|^2 = 1 + \\sum_{k=1}^{d} x_k^2$。我们计算它的一阶和二阶偏导数：\n- 梯度向量 $\\nabla V(x)$ 的分量为 $\\frac{\\partial V}{\\partial x_i} = 2x_i$，因此 $\\nabla V(x) = 2x$。\n- Hessian 矩阵 $H_V(x)$ 的分量为 $\\frac{\\partial^2 V}{\\partial x_i \\partial x_j} = 2\\delta_{ij}$，其中 $\\delta_{ij}$ 是 Kronecker delta。因此，$H_V(x) = 2I$，其中 $I$ 是 $d \\times d$ 单位矩阵。\n\n现在我们将这些代入生成元 $\\mathcal{L}$ 的定义中，其中 $b(x)=-Ax$ 且 $\\Sigma(x)=\\sigma$：\n$$\n\\mathcal{L}V(x) = \\langle -Ax, 2x \\rangle + \\frac{1}{2} \\operatorname{tr}\\left(\\sigma\\sigma^{\\top} (2I)\\right)\n$$\n第一项是内积 $-2\\langle Ax, x \\rangle$。第二项简化为 $\\operatorname{tr}(\\sigma\\sigma^{\\top})$。\n因此，生成元在 $V(x)$ 上的作用为：\n$$\n\\mathcal{L}V(x) = -2\\langle Ax, x \\rangle + \\operatorname{tr}(\\sigma\\sigma^{\\top})\n$$\n\n**2. 漂移不等式的推导**\n\n下一步是使用给定的关于 $A$ 的对称部分（记为 $S = \\frac{1}{2}(A+A^{\\top})$）的条件。二次型 $\\langle Ax, x \\rangle$ 可以与 $S$ 关联起来。任何方阵都可以写成一个对称矩阵和一个反对称矩阵之和。对于任意向量 $x \\in \\mathbb{R}^d$ 和任意反对称矩阵 $K$，二次型 $x^\\top Kx$ 为零。由于 $A=S+\\frac{1}{2}(A-A^\\top)$ 且 $\\frac{1}{2}(A-A^\\top)$ 是反对称的，我们有：\n$$\n\\langle Ax, x \\rangle = x^{\\top}Ax = x^{\\top}Sx = \\langle Sx, x \\rangle\n$$\n将此代回 $\\mathcal{L}V(x)$ 的表达式，我们得到：\n$$\n\\mathcal{L}V(x) = -2\\langle Sx, x \\rangle + \\operatorname{tr}(\\sigma\\sigma^{\\top})\n$$\n问题陈述 $S \\succeq mI$ 对于某个常数 $m>0$ 成立。这是一个正定性条件，意味着对于任意 $x \\in \\mathbb{R}^d$：\n$$\n\\langle Sx, x \\rangle \\ge m \\|x\\|^2\n$$\n两边乘以 $-2$ 会使不等号反向：\n$$\n-2\\langle Sx, x \\rangle \\le -2m \\|x\\|^2\n$$\n我们现在可以从上方界定 $\\mathcal{L}V(x)$：\n$$\n\\mathcal{L}V(x) \\le -2m \\|x\\|^2 + \\operatorname{tr}(\\sigma\\sigma^{\\top})\n$$\n为了获得涉及 $V(x)$ 的所需漂移不等式，我们使用定义 $V(x) = 1 + \\|x\\|^2$，这意味着 $\\|x\\|^2 = V(x) - 1$。将此代入我们的不等式中可得：\n$$\n\\mathcal{L}V(x) \\le -2m(V(x) - 1) + \\operatorname{tr}(\\sigma\\sigma^{\\top})\n$$\n$$\n\\mathcal{L}V(x) \\le -2m V(x) + 2m + \\operatorname{tr}(\\sigma\\sigma^{\\top})\n$$\n这个不等式的形式为 $\\mathcal{L}V(x) \\le -\\alpha V(x) + \\beta$。通过比较各项，我们确定常数 $\\alpha$ 和 $\\beta$：\n- $\\alpha = 2m$\n- $\\beta = 2m + \\operatorname{tr}(\\sigma\\sigma^{\\top})$\n由于 $m>0$，显然 $\\alpha>0$。因为半正定矩阵 $\\sigma\\sigma^\\top$ 的迹是非负的，所以我们也有 $\\beta \\ge 0$。这些常数按要求仅依赖于 $m$ 和 $\\operatorname{tr}(\\sigma\\sigma^{\\top})$。\n\n**3. 对不变测度的影响**\n\n不等式 $\\mathcal{L}V(x) \\le -\\alpha V(x) + \\beta$ 是马尔可夫过程理论中的一个基本 Lyapunov 漂移条件。这里，$V(x) = 1+\\|x\\|^2$ 是一个正常函数 (proper function)，即当 $\\|x\\| \\to \\infty$ 时 $V(x) \\to \\infty$。\n\n**存在性：** 漂移条件意味着每当 $V(x)$ 很大时，其期望变化率为负，从而将过程拉回到 $V(x)$ 较小的区域。具体来说，对于任何满足 $V(x) > \\beta/\\alpha$ 的 $x$，我们有 $\\mathcal{L}V(x) < 0$。这确保了过程是正常返的 (positive Harris recurrent) 和随机稳定的。一个关键结果（通常与 Meyn 和 Tweedie 的工作相关，或从用于扩散过程的 Foster-Lyapunov 定理推导而来）指出，在一个正常函数上的这种漂移条件意味着时间平均的转移概率族 $\\mu_T(x, \\cdot) = \\frac{1}{T}\\int_0^T P_t(x, \\cdot)\\,\\mathrm{d}t$ 对于任何起始点 $x$ 都是紧的。根据 Krylov-Bogoliubov 定理，该族的紧致性保证了当 $T \\to \\infty$ 时至少存在一个弱*极限点。任何这样的极限点都是该过程的一个不变概率测度。因此，至少一个不变测度的存在性得以确立。\n\n**唯一性：** 不变测度的唯一性源于 SDE 的一个不同性质：扩散项的非退化性。问题陈述矩阵 $\\sigma$ 是可逆的。这意味着扩散协方差矩阵 $Q = \\sigma\\sigma^{\\top}$ 是对称且正定的。生成元 $\\mathcal{L}$ 是一个二阶偏微分算子，其主部由 $Q$ 决定。由于 $Q$ 在 $\\mathbb{R}^d$ 的任何地方都是正定的，算子 $\\mathcal{L}$ 是椭圆的。对于具有光滑系数的 SDE（此处漂移是线性的，扩散是常数的），扩散矩阵的矫顽性是转移半群 $(P_t)_{t>0}$ 具有强 Feller 性的一个充分条件（比 Hörmander 定理所需条件更强）。也就是说，对于任意 $t>0$，$P_t$ 将有界可测函数映射到连续函数。此外，$\\mathbb{R}^d$ 上的非退化扩散意味着过程是不可约的：从任何起始点 $x$ 出发，过程都可以在有限时间内以正概率到达任何开集。马尔可夫过程理论中一个著名的定理指出，一个强 Feller 且不可约的过程至多只承认一个不变概率测度。\n\n结合由 Lyapunov 漂移条件得到的存在性和由非退化扩散得到的唯一性，我们得出结论：在给定条件下，该 OU 过程拥有一个唯一的不变概率测度。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2m & 2m + \\operatorname{tr}(\\sigma\\sigma^{\\top})\n\\end{pmatrix}\n}\n$$", "id": "2974640"}, {"introduction": "虽然 Lyapunov 函数可以确认不变测度的存在性，但我们常常需要验证一个已知的密度函数是否确实是平稳解。这个实践 [@problem_id:2974612] 从相反的方向解决了这个问题，从而对前面的存在性证明作了补充。从已知的 OU 过程的高斯不变密度出发，你的任务是直接验证它满足平稳 Fokker-Planck 方程 $L^*\\rho=0$。这个核心的计算练习将强化你对生成元的伴随算子 $L^*$ 与平稳性定义之间联系的理解，并需要你细致地将多维微积分应用于矩阵和向量表达式。", "problem": "考虑由随机微分方程 $dX_{t}=-B X_{t}\\,dt+\\Sigma\\,dW_{t}$ 定义的 $d$ 维 Ornstein–Uhlenbeck (OU) 扩散，其中 $W_{t}$ 是一个标准的 $d$ 维布朗运动，$B\\in\\mathbb{R}^{d\\times d}$ 的特征值具有严格为正的实部，且 $a=\\Sigma\\Sigma^{\\top}\\in\\mathbb{R}^{d\\times d}$ 是对称正定的。令 $P\\in\\mathbb{R}^{d\\times d}$ 为连续时间 Lyapunov 方程 $B P+P B^{\\top}=a$ 的唯一对称正定解。定义高斯密度 $\\rho:\\mathbb{R}^{d}\\to(0,\\infty)$ 为\n$$\n\\rho(x)=\\frac{1}{(2\\pi)^{d/2}(\\det P)^{1/2}}\\exp\\!\\left(-\\frac{1}{2}x^{\\top}P^{-1}x\\right).\n$$\n令 $L^{*}$ 表示与该扩散相关联的 Fokker–Planck（也称为前向 Kolmogorov）算子，即 $L^{*}g=-\\nabla\\cdot(b\\,g)+\\frac{1}{2}\\nabla\\cdot(a\\,\\nabla g)$，其中漂移项为 $b(x)=-B x$，扩散矩阵为 $a$。通过直接计算导数并且仅使用 Lyapunov 恒等式 $B P+P B^{\\top}=a$，计算表达式 $L^{*}\\rho(x)$ 作为 $x$ 的函数，将其完全化简，并给出最终的简化表达式。你的最终答案必须是一个实数或一个单一的闭式解析表达式（没有单位）。如果你得到一个常数，请报告该常数。", "solution": "该问题要求计算并化简表达式 $L^{*}\\rho(x)$，其中 $L^{*}$ 是 Fokker–Planck 算子，而 $\\rho(x)$ 是给定的高斯密度。该算子定义为 $L^{*}g=-\\nabla\\cdot(b\\,g)+\\frac{1}{2}\\nabla\\cdot(a\\,\\nabla g)$，其中漂移项为 $b(x)=-B x$，扩散矩阵为 $a=\\Sigma\\Sigma^\\top$。密度 $\\rho(x)$ 由下式给出：\n$$\n\\rho(x)=\\frac{1}{(2\\pi)^{d/2}(\\det P)^{1/2}}\\exp\\!\\left(-\\frac{1}{2}x^{\\top}P^{-1}x\\right)\n$$\n其中 $P$ 是 Lyapunov 方程 $B P+P B^{\\top}=a$ 的对称正定解。为简洁起见，令 $C = \\frac{1}{(2\\pi)^{d/2}(\\det P)^{1/2}}$。\n\n我们必须计算 $L^{*}\\rho(x) = -\\nabla\\cdot(-Bx\\rho(x)) + \\frac{1}{2}\\nabla\\cdot(a\\nabla\\rho(x))$。我们将分别计算这两项。\n\n首先，我们计算 $\\rho(x)$ 的梯度。令 $f(x) = -\\frac{1}{2}x^{\\top}P^{-1}x$。那么 $\\rho(x) = C \\exp(f(x))$。根据链式法则，梯度为：$\\nabla\\rho(x) = C \\exp(f(x)) \\nabla f(x) = \\rho(x)\\nabla f(x)$。\n为了求 $\\nabla f(x)$，我们使用二次型梯度的标准矩阵微积分恒等式 $\\nabla(x^{\\top}A x) = (A+A^{\\top})x$。由于 $P$ 是对称的，其逆矩阵 $P^{-1}$ 也是对称的。因此，$\\nabla(x^{\\top}P^{-1}x) = (P^{-1}+(P^{-1})^{\\top})x = 2P^{-1}x$。\n$f(x)$ 的梯度因此是：\n$$\n\\nabla f(x) = \\nabla\\left(-\\frac{1}{2}x^{\\top}P^{-1}x\\right) = -\\frac{1}{2}(2P^{-1}x) = -P^{-1}x\n$$\n这就给出了密度 $\\rho(x)$ 的梯度：\n$$\n\\nabla\\rho(x) = -\\rho(x)P^{-1}x\n$$\n\n现在我们计算 Fokker-Planck 算子的两项。\n\n第一项是 $-\\nabla\\cdot(b(x)\\rho(x))$：\n由于 $b(x)=-Bx$，这一项是 $-\\nabla\\cdot(-Bx\\rho(x)) = \\nabla\\cdot(Bx\\rho(x))$。\n我们使用散度的乘法法则：$\\nabla\\cdot(\\mathbf{F}\\phi) = (\\nabla\\cdot\\mathbf{F})\\phi + \\mathbf{F}\\cdot(\\nabla\\phi)$。令 $\\mathbf{F} = Bx$ 且 $\\phi=\\rho(x)$。\n线性映射 $x \\mapsto Bx$ 的散度是矩阵 $B$ 的迹，即 $\\nabla\\cdot(Bx) = \\text{Tr}(B)$。\n乘法法则的第二部分是 $\\mathbf{F}\\cdot(\\nabla\\phi) = (Bx)\\cdot(\\nabla\\rho(x))$。这个点积等价于矩阵乘积 $(Bx)^{\\top}\\nabla\\rho(x)$。\n使用我们关于 $\\nabla\\rho(x)$ 的表达式：\n$$\n(Bx)^{\\top}\\nabla\\rho(x) = (x^{\\top}B^{\\top})(-\\rho(x)P^{-1}x) = -\\rho(x) x^{\\top}B^{\\top}P^{-1}x\n$$\n将这些组合起来，第一项变为：\n$$\n-\\nabla\\cdot(b(x)\\rho(x)) = \\nabla\\cdot(Bx\\rho(x)) = (\\text{Tr}(B))\\rho(x) - \\rho(x) x^{\\top}B^{\\top}P^{-1}x = \\rho(x)[\\text{Tr}(B) - x^{\\top}B^{\\top}P^{-1}x]\n$$\n\n第二项是 $\\frac{1}{2}\\nabla\\cdot(a\\nabla\\rho(x))$：\n代入 $\\nabla\\rho(x) = -\\rho(x)P^{-1}x$：\n$$\n\\frac{1}{2}\\nabla\\cdot(a\\nabla\\rho(x)) = \\frac{1}{2}\\nabla\\cdot(a(-\\rho(x)P^{-1}x)) = -\\frac{1}{2}\\nabla\\cdot(\\rho(x)aP^{-1}x)\n$$\n我们再次使用散度的乘法法则，这一次设 $\\mathbf{F} = aP^{-1}x$ 且 $\\phi=\\rho(x)$。\n线性映射 $x \\mapsto (aP^{-1})x$ 的散度是 $\\nabla\\cdot(aP^{-1}x) = \\text{Tr}(aP^{-1})$。\n乘法法则的第二部分是 $(\\nabla\\phi)\\cdot\\mathbf{F} = (\\nabla\\rho(x))\\cdot(aP^{-1}x) = (\\nabla\\rho(x))^{\\top}(aP^{-1}x)$。\n使用我们关于 $\\nabla\\rho(x)$ 的表达式：\n$$\n(\\nabla\\rho(x))^{\\top}(aP^{-1}x) = (-\\rho(x)P^{-1}x)^{\\top}(aP^{-1}x) = -\\rho(x)x^{\\top}(P^{-1})^{\\top}aP^{-1}x\n$$\n由于 $P^{-1}$ 是对称的，$(P^{-1})^{\\top} = P^{-1}$。所以表达式是 $-\\rho(x)x^{\\top}P^{-1}aP^{-1}x$。\n将第二项的这些部分组合起来：\n$$\n\\frac{1}{2}\\nabla\\cdot(a\\nabla\\rho(x)) = -\\frac{1}{2}\\left[\\rho(x)\\text{Tr}(aP^{-1}) - \\rho(x)x^{\\top}P^{-1}aP^{-1}x\\right] = \\rho(x)\\left[-\\frac{1}{2}\\text{Tr}(aP^{-1}) + \\frac{1}{2}x^{\\top}P^{-1}aP^{-1}x\\right]\n$$\n\n现在我们将这两项相加来求 $L^{*}\\rho(x)$：\n$$\nL^{*}\\rho(x) = \\rho(x)\\left[\\text{Tr}(B) - x^{\\top}B^{\\top}P^{-1}x\\right] + \\rho(x)\\left[-\\frac{1}{2}\\text{Tr}(aP^{-1}) + \\frac{1}{2}x^{\\top}P^{-1}aP^{-1}x\\right]\n$$\n将 $\\rho(x)$ 因子提出，我们得到：\n$$\nL^{*}\\rho(x) = \\rho(x)\\left[ \\left(\\text{Tr}(B) - \\frac{1}{2}\\text{Tr}(aP^{-1})\\right) + \\left(-x^{\\top}B^{\\top}P^{-1}x + \\frac{1}{2}x^{\\top}P^{-1}aP^{-1}x\\right) \\right]\n$$\n为了化简这个表达式，我们使用给定的 Lyapunov 恒等式：$a = BP + PB^{\\top}$。\n\n我们先化简标量部分（不含 $x$ 的项）：\n$$\n\\text{Tr}(B) - \\frac{1}{2}\\text{Tr}(aP^{-1}) = \\text{Tr}(B) - \\frac{1}{2}\\text{Tr}((BP+PB^{\\top})P^{-1})\n$$\n利用迹算子的线性性质：\n$$\n= \\text{Tr}(B) - \\frac{1}{2}\\text{Tr}(BPP^{-1} + PB^{\\top}P^{-1}) = \\text{Tr}(B) - \\frac{1}{2}(\\text{Tr}(B) + \\text{Tr}(PB^{\\top}P^{-1}))\n$$\n利用迹的循环性质 $\\text{Tr}(XYZ) = \\text{Tr}(ZXY)$，我们有 $\\text{Tr}(PB^{\\top}P^{-1}) = \\text{Tr}(P^{-1}PB^{\\top}) = \\text{Tr}(B^{\\top})$。由于 $\\text{Tr}(B^{\\top}) = \\text{Tr}(B)$，表达式变为：\n$$\n= \\text{Tr}(B) - \\frac{1}{2}(\\text{Tr}(B) + \\text{Tr}(B)) = \\text{Tr}(B) - \\frac{1}{2}(2\\text{Tr}(B)) = \\text{Tr}(B) - \\text{Tr}(B) = 0\n$$\n括号中标量部分的表达式为零。\n\n接下来，我们化简二次型部分：\n$$\n-x^{\\top}B^{\\top}P^{-1}x + \\frac{1}{2}x^{\\top}P^{-1}aP^{-1}x = x^{\\top}\\left[-B^{\\top}P^{-1} + \\frac{1}{2}P^{-1}aP^{-1}\\right]x\n$$\n我们分析一下括号内的矩阵，令 $M = -B^{\\top}P^{-1} + \\frac{1}{2}P^{-1}aP^{-1}$。代入 $a = BP+PB^{\\top}$：\n$$\nM = -B^{\\top}P^{-1} + \\frac{1}{2}P^{-1}(BP+PB^{\\top})P^{-1} = -B^{\\top}P^{-1} + \\frac{1}{2}(P^{-1}BPP^{-1} + P^{-1}PB^{\\top}P^{-1})\n$$\n$$\nM = -B^{\\top}P^{-1} + \\frac{1}{2}(P^{-1}B + B^{\\top}P^{-1}) = \\frac{1}{2}P^{-1}B - \\frac{1}{2}B^{\\top}P^{-1}\n$$\n现在，我们检查此矩阵是否为反对称矩阵。它的转置是：\n$$\nM^{\\top} = \\left(\\frac{1}{2}P^{-1}B - \\frac{1}{2}B^{\\top}P^{-1}\\right)^{\\top} = \\frac{1}{2}(P^{-1}B)^{\\top} - \\frac{1}{2}(B^{\\top}P^{-1})^{\\top} = \\frac{1}{2}B^{\\top}(P^{-1})^{\\top} - \\frac{1}{2}(P^{-1})^{\\top}(B^{\\top})^{\\top}\n$$\n由于 $P^{-1}$ 是对称的，$(P^{-1})^{\\top}=P^{-1}$。并且 $(B^{\\top})^{\\top}=B$。\n$$\nM^{\\top} = \\frac{1}{2}B^{\\top}P^{-1} - \\frac{1}{2}P^{-1}B = -\\left(\\frac{1}{2}P^{-1}B - \\frac{1}{2}B^{\\top}P^{-1}\\right) = -M\n$$\n矩阵 $M$ 是反对称的。对于任意反对称矩阵 $M$，二次型 $x^{\\top}Mx$ 对于任意向量 $x$ 总是为零。这是因为 $x^{\\top}Mx$ 是一个标量，所以它等于其自身的转置：$x^{\\top}Mx = (x^{\\top}Mx)^{\\top} = x^{\\top}M^{\\top}x = x^{\\top}(-M)x = -x^{\\top}Mx$。这个等式意味着 $2x^{\\top}Mx=0$，因此 $x^{\\top}Mx=0$。\n因此，整个二次型部分为零。\n\n主括号内表达式的标量部分和二次型部分都为零。所以，$L^{*}\\rho(x)$ 的表达式化简为：\n$$\nL^{*}\\rho(x) = \\rho(x)[0 + 0] = 0\n$$\n最终的简化表达式是常数 $0$。", "answer": "$$\\boxed{0}$$", "id": "2974612"}, {"introduction": "现在我们转向一个物理上更真实、数学上更精妙的系统：动力学朗之万方程 (kinetic Langevin dynamics)。该系统 [@problem_id:2974613] 的一个关键特征是其*退化*噪声，即噪声仅直接作用于速度分量，而非位置分量。这种退化性意味着基于一致椭圆性的标准唯一性论证在此处不适用。本练习引入了一个更强大的工具——Hörmander 括号条件，以建立次椭圆性 (hypoellipticity) 并由此证明唯一性。通过计算系统向量场的李括号 (Lie brackets)，你将揭示随机性如何通过系统的动力学进行传播，从而保证不变测度的光滑性及其唯一性。", "problem": "考虑一维动力学朗之万随机微分方程（SDE），这是一个关于位置和速度的耦合SDE系统，由下式给出：\n$$\n\\begin{cases}\ndX_t = V_t\\,dt, \\\\\ndV_t = -\\gamma V_t\\,dt - U'(X_t)\\,dt + \\sigma\\,dW_t,\n\\end{cases}\n$$\n其中 $X_t \\in \\mathbb{R}$ 是位置，$V_t \\in \\mathbb{R}$ 是速度，$\\gamma > 0$ 是摩擦系数，$\\sigma > 0$ 是噪声振幅，$W_t$ 是一维标准布朗运动，$U:\\mathbb{R}\\to\\mathbb{R}$ 是一个二次连续可微的限制势。设势为二次形式，$U(x) = \\frac{k}{2}x^2$ 且 $k>0$。\n\n从核心定义和经过充分检验的事实出发，您的任务是：\n- 识别与上述SDE相关的漂移和扩散向量场，并计算它们的李括号。利用这些计算在$\\mathbb{R}^2$中的每一点验证Hörmander括号条件，从而确定其亚椭圆性以及边缘分布的光滑性。\n- 解释为什么光滑性质和一个合适的Lyapunov函数共同蕴含了该动力学系统不变概率测度的存在性和唯一性。\n- 使用稳态Fokker–Planck方程（向前Kolmogorov方程）和确保细致平衡的涨落-耗散关系，推导出形式为\n$$\np^{\\star}(x,v) = Z^{-1}\\exp\\!\\left(-\\frac{H(x,v)}{T}\\right),\n$$\n的不变密度，其中 $H(x,v)$ 是哈密顿量，$T>0$ 是由 $\\gamma$ 和 $\\sigma$ 决定的有效温度。然后计算归一化常数 $Z$ 关于 $\\gamma$、$\\sigma$ 和 $k$ 的精确解析表达式。将最终答案表示为闭式解析表达式。不包含任何物理单位。无需四舍五入。", "solution": "问题陈述经评估具有科学依据、提法恰当、客观且完整。这是随机微分方程理论和统计物理学中的一个标准问题，所有给定的数据和条件都是一致且足以得到唯一解的。该问题有效。\n\n状态向量 $Y_t = (X_t, V_t)^T$ 的随机微分方程（SDE）系统可以写成一般的Itô形式 $dY_t = F_0(Y_t)dt + F_1(Y_t)dW_t$。当 $Y_t = (x,v)^T$ 时，漂移向量场 $F_0$ 和扩散向量场 $F_1$ 被确定为：\n$$\nF_0(x,v) = \\begin{pmatrix} v \\\\ -\\gamma v - U'(x) \\end{pmatrix}, \\quad F_1(x,v) = \\begin{pmatrix} 0 \\\\ \\sigma \\end{pmatrix}\n$$\n给定势 $U(x) = \\frac{k}{2}x^2$，其导数为 $U'(x) = kx$。因此，漂移向量场为：\n$$\nF_0(x,v) = \\begin{pmatrix} v \\\\ -kx - \\gamma v \\end{pmatrix}\n$$\n\n**第一部分：Hörmander括号条件**\n\n为验证Hörmander条件，我们计算向量场的李括号。两个向量场 $A$ 和 $B$ 的李括号定义为 $[A, B](y) = (\\nabla B)(y) A(y) - (\\nabla A)(y) B(y)$，其中 $\\nabla A$ 是向量场 $A$ 的雅可比矩阵。\n\n对于我们的系统，$F_1$ 是一个常向量，所以它的雅可比矩阵 $\\nabla F_1$ 是零矩阵。$F_0$ 的雅可比矩阵为：\n$$\n\\nabla F_0(x,v) = \\begin{pmatrix} \\frac{\\partial}{\\partial x}(v) & \\frac{\\partial}{\\partial v}(v) \\\\ \\frac{\\partial}{\\partial x}(-kx - \\gamma v) & \\frac{\\partial}{\\partial v}(-kx - \\gamma v) \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -k & -\\gamma \\end{pmatrix}\n$$\n一阶李括号为 $[F_0, F_1]$：\n$$\n[F_0, F_1] = (\\nabla F_1) F_0 - (\\nabla F_0) F_1 = \\mathbf{0} \\cdot F_0 - \\begin{pmatrix} 0 & 1 \\\\ -k & -\\gamma \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\sigma \\end{pmatrix} = - \\begin{pmatrix} \\sigma \\\\ -\\gamma \\sigma \\end{pmatrix} = \\begin{pmatrix} -\\sigma \\\\ \\gamma \\sigma \\end{pmatrix}\n$$\nHörmander条件要求由李代数生成的向量场集合 $\\{F_1, [F_0, F_1], [F_0, [F_0, F_1]], \\ldots\\}$ 在每一点 $(x,v)$ 处都能张成切空间 $\\mathbb{R}^2$。我们只需要检查前几个向量的张成情况。让我们考虑集合 $\\{F_1, [F_0, F_1]\\}$：\n$$\nF_1 = \\begin{pmatrix} 0 \\\\ \\sigma \\end{pmatrix}, \\quad [F_0, F_1] = \\begin{pmatrix} -\\sigma \\\\ \\gamma \\sigma \\end{pmatrix}\n$$\n为了检查这两个向量是否能张成 $\\mathbb{R}^2$，我们可以用这些向量作为列构成一个矩阵，并计算其行列式：\n$$\n\\det\\begin{pmatrix} 0 & -\\sigma \\\\ \\sigma & \\gamma \\sigma \\end{pmatrix} = (0)(\\gamma \\sigma) - (-\\sigma)(\\sigma) = \\sigma^2\n$$\n因为给定 $\\sigma > 0$，所以 $\\sigma^2 > 0$。行列式不为零，这意味着向量 $F_1$ 和 $[F_0, F_1]$ 对所有 $(x,v) \\in \\mathbb{R}^2$ 都是线性无关的。因此，它们构成了 $\\mathbb{R}^2$ 的一组基，Hörmander括号条件在每一点都得到满足。\n\n这个结果意味着该过程的生成元 $\\mathcal{L} = v \\frac{\\partial}{\\partial x} + (-kx - \\gamma v) \\frac{\\partial}{\\partial v} + \\frac{\\sigma^2}{2} \\frac{\\partial^2}{\\partial v^2}$ 是亚椭圆的。亚椭圆性的一个关键推论是相关转移半群的光滑性质：对于任何初始条件，过程在时间 $t>0$ 的概率密度函数 $p(t,x,v)$ 是一个光滑（无穷可微）函数。\n\n**第二部分：不变测度的存在性与唯一性**\n\n该过程不变概率测度的存在性和唯一性可以通过结合两个关键性质来确立：\n1.  **不可约性和强Feller性质：** 通过Hörmander条件确立的亚椭圆性意味着转移半群是强Feller连续的，并且该过程是不可约的（任何开集都可以从任何其他开集到达）。这确保了任何不变测度都必须有一个关于勒贝格测度的光滑密度。\n2.  **Lyapunov函数的存在性：** 我们需要证明该过程是常返的，即它倾向于返回状态空间的中心区域。这可以通过找到一个Lyapunov函数 $W(x,v)$ 来证明，该函数满足当 $|x|+|v| \\to \\infty$ 时 $W(x,v) \\to \\infty$，并且在某个紧集之外，对于某些正常数 $c, C$ 有 $\\mathcal{L}W(x,v) \\le -c W(x,v) + C$。一个标准的Lyapunov函数选择是总能量（哈密顿量）：$H(x,v) = U(x) + \\frac{1}{2}v^2 = \\frac{k}{2}x^2 + \\frac{1}{2}v^2$。让我们计算 $\\mathcal{L}H$：\n    $$\n    \\mathcal{L}H = v \\frac{\\partial H}{\\partial x} + (-kx - \\gamma v) \\frac{\\partial H}{\\partial v} + \\frac{\\sigma^2}{2} \\frac{\\partial^2 H}{\\partial v^2}\n    $$\n    $$\n    \\mathcal{L}H = v(kx) + (-kx - \\gamma v)(v) + \\frac{\\sigma^2}{2}(1) = kxv - kxv - \\gamma v^2 + \\frac{\\sigma^2}{2} = -\\gamma v^2 + \\frac{\\sigma^2}{2}\n    $$\n    这个表达式显示了速度上的耗散，但没有显示位置上的耗散。对于大的 $|x|$和有界的 $|v|$，条件 $\\mathcal{L}H \\le -c H + C$ 不满足。一个更精巧的、对于动力学朗之万方程是标准形式的Lyapunov函数 $W(x,v) = H(x,v) + \\epsilon xv$（其中 $\\epsilon>0$ 很小）可以解决这个问题。对于足够小的 $\\epsilon$，这种选择在 $x$ 和 $v$ 两个方向上都导致一个朝向原点的强制漂移，从而满足Lyapunov条件。\n\n强Feller性质和Lyapunov函数的存在性相结合是马尔可夫过程理论中的一个经典结果（例如，由Meyn和Tweedie证明），它保证了唯一的平稳分布（不变概率测度）的存在性，并且过程会从任何初始条件收敛到该分布。\n\n**第三部分：不变密度与归一化常数**\n\n不变密度 $p^{\\star}(x,v)$ 是Fokker-Planck方程 $\\mathcal{L}^* p = 0$ 的平稳解，其中 $\\mathcal{L}^*$ 是 $\\mathcal{L}$ 的伴随算子：\n$$\n\\mathcal{L}^* p = -\\frac{\\partial}{\\partial x}(v p) + \\frac{\\partial}{\\partial v}((-kx - \\gamma v)p) + \\frac{\\sigma^2}{2} \\frac{\\partial^2 p}{\\partial v^2}\n$$\n我们检验所提出的Gibbs-Boltzmann形式 $p^{\\star}(x,v) = Z^{-1}\\exp(-H(x,v)/T) = Z^{-1}\\exp(-\\beta H(x,v))$，其中 $\\beta=1/T$。令 $p(x,v) = \\exp(-\\beta(\\frac{k}{2}x^2 + \\frac{1}{2}v^2))$。我们暂时省略常数 $Z^{-1}$。我们计算其导数：\n$$\n\\frac{\\partial p}{\\partial x} = -k\\beta x p, \\quad \\frac{\\partial p}{\\partial v} = -\\beta v p, \\quad \\frac{\\partial^2 p}{\\partial v^2} = (-\\beta + \\beta^2 v^2)p\n$$\n代入稳态Fokker-Planck方程 $\\mathcal{L}^*p=0$：\n$$\n-\\frac{\\partial}{\\partial x}(v p) + \\frac{\\partial}{\\partial v}((-kx - \\gamma v)p) + \\frac{\\sigma^2}{2}\\frac{\\partial^2 p}{\\partial v^2} = 0\n$$\n$$\n-v(-k\\beta x p) + (-(\\gamma v + kx))(-\\beta v p) - \\gamma p + \\frac{\\sigma^2}{2}(-\\beta + \\beta^2 v^2)p = 0\n$$\n两边同除以 $p$（$p$ 不为零）：\n$$\nk\\beta xv + \\beta v(\\gamma v + kx) - \\gamma + \\frac{\\sigma^2}{2}(-\\beta + \\beta^2 v^2) = 0\n$$\n$$\nk\\beta xv + \\beta\\gamma v^2 + \\beta kxv - \\gamma - \\frac{\\sigma^2\\beta}{2} + \\frac{\\sigma^2\\beta^2}{2} v^2 = 0\n$$\n展开式中似乎存在计算错误。一个更直接的方法是使用细致平衡的零流条件。不变测度满足 $\\mathcal{L}^*p=0$，这等价于 $\\nabla \\cdot J = 0$，其中 $J=(J_x, J_v)$ 是概率流。对于细致平衡，我们可以寻找一个解，使得流的各个分量为零。概率流的速度分量是 $J_v(x,v) = (-kx - \\gamma v) p(x,v) - \\frac{\\sigma^2}{2}\\frac{\\partial p}{\\partial v}$。令 $J_v=0$：\n$$\n(-kx - \\gamma v) p = \\frac{\\sigma^2}{2}\\frac{\\partial p}{\\partial v} \\implies \\frac{1}{p}\\frac{\\partial p}{\\partial v} = -\\frac{2}{\\sigma^2}(kx+\\gamma v)\n$$\n这个条件无法满足，因为 $\\frac{\\partial}{\\partial x}(\\frac{1}{p}\\frac{\\partial p}{\\partial v}) = -\\frac{2k}{\\sigma^2} \\neq 0$，这意味着 $\\frac{\\partial^2}{\\partial x \\partial v} \\ln p \\neq 0$。\n\n让我们回到完整的稳态Fokker-Planck方程：$\\mathcal{L}^*p = - \\frac{\\partial}{\\partial x}(v p) + \\frac{\\partial}{\\partial v}((\\gamma v + kx)p) + \\frac{\\sigma^2}{2}\\frac{\\partial^2 p}{\\partial v^2} = 0$。当 $p \\propto \\exp(-\\beta H)$ 时，我们有：\n$$\n-v\\frac{\\partial p}{\\partial x} + (\\gamma v + kx)\\frac{\\partial p}{\\partial v} + \\gamma p + \\frac{\\sigma^2}{2}\\frac{\\partial^2 p}{\\partial v^2} = 0\n$$\n$$\n-v(-k\\beta x p) + (\\gamma v + kx)(-\\beta v p) + \\gamma p + \\frac{\\sigma^2}{2}(\\beta^2 v^2-\\beta)p = 0\n$$\n两边同除以 $p$：\n$$\nk\\beta xv - \\beta\\gamma v^2 - k\\beta xv + \\gamma + \\frac{\\sigma^2\\beta^2}{2} v^2 - \\frac{\\sigma^2\\beta}{2} = 0\n$$\n$k\\beta xv$ 和 $-k\\beta xv$ 两项相互抵消。我们剩下：\n$$\n(\\gamma - \\frac{\\sigma^2\\beta}{2}) + v^2(-\\beta\\gamma + \\frac{\\sigma^2\\beta^2}{2}) = 0\n$$\n该方程必须对所有 $v$ 都成立。这要求常数项和 $v^2$ 的系数都为零。\n1) $\\gamma - \\frac{\\sigma^2\\beta}{2} = 0$\n2) $-\\beta\\gamma + \\frac{\\sigma^2\\beta^2}{2} = 0$\n从 (1) 中，我们解出 $\\beta$:\n$$\n\\beta = \\frac{2\\gamma}{\\sigma^2}\n$$\n因为 $\\gamma>0$ 且 $\\sigma>0$，所以 $\\beta>0$。将此代入 (2)：\n$$\n-\\left(\\frac{2\\gamma}{\\sigma^2}\\right)\\gamma + \\frac{\\sigma^2}{2}\\left(\\frac{2\\gamma}{\\sigma^2}\\right)^2 = -\\frac{2\\gamma^2}{\\sigma^2} + \\frac{\\sigma^2}{2}\\frac{4\\gamma^2}{\\sigma^4} = -\\frac{2\\gamma^2}{\\sigma^2} + \\frac{2\\gamma^2}{\\sigma^2} = 0\n$$\n两个方程都得到满足。有效温度是 $T=1/\\beta = \\frac{\\sigma^2}{2\\gamma}$。\n不变密度为 $p^{\\star}(x,v) = Z^{-1}\\exp(-\\beta H(x,v)) = Z^{-1}\\exp\\left(-\\frac{2\\gamma}{\\sigma^2}\\left(\\frac{k}{2}x^2+\\frac{1}{2}v^2\\right)\\right)$：\n$$\np^{\\star}(x,v) = Z^{-1}\\exp\\left(-\\frac{\\gamma k}{\\sigma^2}x^2 - \\frac{\\gamma}{\\sigma^2}v^2\\right)\n$$\n归一化常数 $Z$ 通过在整个状态空间 $\\mathbb{R}^2$ 上对 $p^{\\star}(x,v)$ 积分得到：\n$$\nZ = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\gamma k}{\\sigma^2}x^2 - \\frac{\\gamma}{\\sigma^2}v^2\\right) dx\\,dv\n$$\n该积分是可分离的：\n$$\nZ = \\left(\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\gamma k}{\\sigma^2}x^2\\right)dx\\right) \\left(\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\gamma}{\\sigma^2}v^2\\right)dv\\right)\n$$\n使用高斯积分公式 $\\int_{-\\infty}^{\\infty}\\exp(-ax^2)dx = \\sqrt{\\frac{\\pi}{a}}$：\n对于关于 $x$ 的积分，$a_x = \\frac{\\gamma k}{\\sigma^2}$。所以积分结果为 $\\sqrt{\\frac{\\pi \\sigma^2}{\\gamma k}}$。\n对于关于 $v$ 的积分，$a_v = \\frac{\\gamma}{\\sigma^2}$。所以积分结果为 $\\sqrt{\\frac{\\pi \\sigma^2}{\\gamma}}$。\n将这些结果相乘得到 $Z$：\n$$\nZ = \\sqrt{\\frac{\\pi \\sigma^2}{\\gamma k}} \\cdot \\sqrt{\\frac{\\pi \\sigma^2}{\\gamma}} = \\sqrt{\\frac{\\pi^2 \\sigma^4}{\\gamma^2 k}} = \\frac{\\pi \\sigma^2}{\\gamma\\sqrt{k}}\n$$\n这就是归一化常数的闭式解析表达式。", "answer": "$$ \\boxed{\\frac{\\pi \\sigma^2}{\\gamma \\sqrt{k}}} $$", "id": "2974613"}]}