{"hands_on_practices": [{"introduction": "在统计物理学和贝叶斯推理中，一个核心任务是构建能够从目标概率分布（例如吉布斯分布）中采样的随机过程。本练习将引导您探索系统微观动力学（漂移和扩散）与其宏观平衡态之间的根本联系，并引入细致平衡 (detailed balance) 这一关键概念。通过推导涨落耗散关系 (fluctuation-dissipation relation)，您将亲身体会如何设计随机微分方程，使其具备预期的长期统计特性 [@problem_id:2996786]。", "problem": "考虑在 $\\mathbb{R}^{d}$ 中的过阻尼朗之万随机微分方程 (SDE)，其伊藤形式由下式给出\n$$\n\\mathrm{d}X_{t} \\;=\\; -\\, a\\, \\nabla V\\!\\left(X_{t}\\right)\\,\\mathrm{d}t \\;+\\; \\sigma\\, \\mathrm{d}W_{t},\n$$\n其中 $a>0$ 是一个常数耗散（迁移率）参数，$V:\\mathbb{R}^{d}\\to\\mathbb{R}$ 是一个二次连续可微的限制势，$\\sigma>0$ 是一个未知的常数噪声强度，$W_{t}$ 是一个标准的 $d$ 维维纳过程。假设 $V$ 使得吉布斯测度\n$$\n\\mu(\\mathrm{d}x) \\;=\\; Z^{-1}\\exp\\!\\bigl(-\\beta\\, V(x)\\bigr)\\,\\mathrm{d}x,\n$$\n（其中逆温度 $\\beta>0$，归一化常数 $Z=\\int_{\\mathbb{R}^{d}}\\exp\\!\\bigl(-\\beta\\, V(x)\\bigr)\\,\\mathrm{d}x$）是良定义的（$Z$ 有限）。从柯尔莫哥洛夫前向方程（也称为福克-普朗克方程）的第一性原理和不变测度的定义出发，推导为使 $\\mu$ 成为该SDE的不变测度所必需的、连接 $a$ 和 $\\sigma$ 的涨落-耗散关系。\n\n以 $a$ 和 $\\beta$ 的符号表达式明确给出噪声强度 $\\sigma$。无需四舍五入。", "solution": "该问题经检验具有科学依据、良定义且客观。这是统计物理学和随机过程理论中的一个标准推导。所有需要的信息均已提供且内部一致。\n\n该随机微分方程 (SDE) 的伊藤形式为：\n$$\n\\mathrm{d}X_{t} = -a \\nabla V(X_{t}) \\mathrm{d}t + \\sigma \\mathrm{d}W_{t}\n$$\n这是一个在 $\\mathbb{R}^{d}$ 中的多维SDE。通过将给定方程与一般形式 $\\mathrm{d}X_t = b(X_t)\\mathrm{d}t + D(X_t)\\mathrm{d}W_t$ 进行比较，我们可以确定漂移矢量 $b(x)$ 和扩散矩阵 $D(x)$。\n漂移矢量为 $b(x) = -a \\nabla V(x)$。\n扩散项 $\\sigma \\mathrm{d}W_t$ 对应于扩散矩阵 $D(x) = \\sigma I_{d}$，其中 $I_{d}$ 是 $d \\times d$ 单位矩阵，$\\sigma$ 是一个常数。\n\n过程 $X_t$ 的概率密度函数 $p(x, t)$ 的时间演化由柯尔莫哥洛夫前向方程（也称为福克-普朗克方程）描述。对于一个一般的SDE，该方程为：\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\nabla \\cdot \\bigl(b(x) p(x,t)\\bigr) + \\frac{1}{2} \\sum_{i,j=1}^{d} \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\left[ (D(x)D(x)^T)_{ij} p(x,t) \\right]\n$$\n首先，我们计算矩阵乘积 $D(x)D(x)^T$：\n$$\nD(x)D(x)^T = (\\sigma I_d)(\\sigma I_d)^T = \\sigma^2 I_d\n$$\n该矩阵的分量为 $(\\sigma^2 I_d)_{ij} = \\sigma^2 \\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克δ。\n将漂移 $b(x)$ 和扩散矩阵乘积代入福克-普朗克方程：\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\nabla \\cdot \\bigl(-a \\nabla V(x) p(x,t)\\bigr) + \\frac{1}{2} \\sum_{i,j=1}^{d} \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\left[ \\sigma^2 \\delta_{ij} p(x,t) \\right]\n$$\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = \\nabla \\cdot \\bigl(a \\nabla V(x) p(x,t)\\bigr) + \\frac{1}{2} \\sigma^2 \\sum_{i=1}^{d} \\frac{\\partial^2}{\\partial x_i^2} p(x,t)\n$$\n这可以简化为：\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = \\nabla \\cdot \\bigl(a \\nabla V(x) p(x,t)\\bigr) + \\frac{\\sigma^2}{2} \\Delta p(x,t)\n$$\n其中 $\\Delta = \\nabla \\cdot \\nabla$ 是拉普拉斯算子。\n\n不变测度，或称平稳分布，其特征是具有一个不随时间变化的概率密度函数，我们记为 $p_{ss}(x)$。对于平稳分布，$\\frac{\\partial p_{ss}(x)}{\\partial t} = 0$。在福克-普朗克方程中将时间导数设为零，得到平稳密度的条件：\n$$\n0 = \\nabla \\cdot \\bigl(a \\nabla V(x) p_{ss}(x)\\bigr) + \\frac{\\sigma^2}{2} \\Delta p_{ss}(x)\n$$\n这个方程可以写成连续性方程的形式，$\\nabla \\cdot J(x) = 0$，其中 $J(x)$ 是概率流密度。通过分配散度算子，我们可以确定概率流：\n$$\n\\nabla \\cdot \\left[ a (\\nabla V(x)) p_{ss}(x) + \\frac{\\sigma^2}{2} \\nabla p_{ss}(x) \\right] = 0\n$$\n因此，概率流为：\n$$\nJ(x) = a (\\nabla V(x)) p_{ss}(x) + \\frac{\\sigma^2}{2} \\nabla p_{ss}(x)\n$$\n条件 $\\nabla \\cdot J(x) = 0$ 是概率守恒的表述。对于处于热平衡的系统，必须满足一个更强的条件，即细致平衡，它断言净概率流处处为零，即对于所有 $x \\in \\mathbb{R}^d$，$J(x) = 0$。这确保了任意两个状态之间，双向的跃迁速率相等。将概率流设为零得到：\n$$\na (\\nabla V(x)) p_{ss}(x) + \\frac{\\sigma^2}{2} \\nabla p_{ss}(x) = 0\n$$\n\n问题陈述不变测度是吉布斯测度 $\\mu(\\mathrm{d}x) = Z^{-1}\\exp(-\\beta V(x))\\mathrm{d}x$。对应的平稳概率密度为 $p_{ss}(x) = Z^{-1}\\exp(-\\beta V(x))$。我们现在计算这个密度的梯度：\n$$\n\\nabla p_{ss}(x) = \\nabla \\left( Z^{-1}\\exp(-\\beta V(x)) \\right) = Z^{-1} \\exp(-\\beta V(x)) \\cdot (-\\beta \\nabla V(x))\n$$\n注意到 $Z^{-1}\\exp(-\\beta V(x))$ 就是 $p_{ss}(x)$，我们有：\n$$\n\\nabla p_{ss}(x) = -\\beta p_{ss}(x) \\nabla V(x)\n$$\n将 $\\nabla p_{ss}(x)$ 的这个表达式代入细致平衡方程 ($J(x)=0$)：\n$$\na (\\nabla V(x)) p_{ss}(x) + \\frac{\\sigma^2}{2} \\bigl(-\\beta p_{ss}(x) \\nabla V(x)\\bigr) = 0\n$$\n我们可以提出公因子 $p_{ss}(x)$ 和 $\\nabla V(x)$：\n$$\n\\left( a - \\frac{\\sigma^2 \\beta}{2} \\right) p_{ss}(x) \\nabla V(x) = 0\n$$\n该方程必须对所有 $x \\in \\mathbb{R}^d$ 成立。由于 $p_{ss}(x) = Z^{-1}\\exp(-\\beta V(x))$ 严格为正，并且我们假设 $V(x)$ 不处处为常数（即 $\\nabla V(x)$ 不恒为零），因此括号中的标量系数必须为零：\n$$\na - \\frac{\\sigma^2 \\beta}{2} = 0\n$$\n这就是该系统的涨落-耗散关系。它将耗散参数 $a$ 与涨落（噪声）强度 $\\sigma$ 以及逆温度 $\\beta$ 联系起来。\n\n问题要求以 $a$ 和 $\\beta$ 的形式给出 $\\sigma$ 的显式表达式。求解该关系以得到 $\\sigma^2$：\n$$\n\\sigma^2 = \\frac{2a}{\\beta}\n$$\n由于噪声强度 $\\sigma$ 被设定为正数 ($\\sigma > 0$)，我们取正平方根：\n$$\n\\sigma = \\sqrt{\\frac{2a}{\\beta}}\n$$\n这个结果是爱因斯坦关系的一个特例，它将扩散系数 ($D_{\\text{eff}} = \\sigma^2/2$) 与迁移率 ($a$) 和温度（在物理学背景下，$T = 1/(k_B \\beta)$）联系起来。此处，我们已按要求从福克-普朗克方程推导出它。", "answer": "$$\\boxed{\\sqrt{\\frac{2a}{\\beta}}}$$", "id": "2996786"}, {"introduction": "在建立了平衡态的概念之后，我们现在转向那些能达到稳态但并非处于热平衡的系统，许多现实世界系统，从生物细胞到气候模型，都属于这一类。这个实践问题使用一个带有非梯度（或旋转）漂移分量的二维线性 SDE 来演示非平衡定态 (non-equilibrium stationary state, NESS)。您将发现，尽管存在一个平稳分布，但细致平衡条件却被违反了，这揭示了概率流和熵产生的概念，这些是在现代统计物理学中至关重要的课题 [@problem_id:2996767]。", "problem": "考虑二维伊藤随机微分方程 (SDE)\n$$\n\\mathrm{d}X_t = -K X_t\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t,\n$$\n其中 $X_t \\in \\mathbb{R}^2$，$W_t$ 是一个标准的二维维纳过程，常数矩阵满足 $K = S + R$，其中\n$$\nS = \\begin{pmatrix} \\alpha & 0 \\\\ 0 & \\beta \\end{pmatrix}, \\quad \\alpha > 0, \\ \\beta > 0, \\qquad R = \\omega \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}, \\ \\omega \\neq 0,\n$$\n且扩散矩阵 $a$ 定义为 $a = \\sigma \\sigma^{\\top} = 2 S$。漂移项 $b(x)$ 为 $b(x) = -K x$，扩散矩阵 $a$ 是常数且正定的。\n\n仅从概率密度 $\\rho(x,t)$ 的福克-普朗克方程 (FPE) 出发，\n$$\n\\partial_t \\rho(x,t) = -\\nabla \\cdot \\big(b(x)\\,\\rho(x,t)\\big) + \\tfrac{1}{2}\\,\\nabla \\cdot \\big(a\\,\\nabla \\rho(x,t)\\big),\n$$\n并利用 (i) 稳态分布，(ii) 细致平衡，以及 (iii) 概率流的核心定义，完成以下任务：\n\n1. 确定上述 SDE 存在稳态密度的条件，并显式地求出该稳态密度。\n\n2. 判断在给定条件下是否满足细致平衡。精确陈述细致平衡成立时 $R$ 需满足的条件，并断定此处是否满足该条件。\n\n3. 推导稳态概率流 $j(x)$，并证明在稳态下其散度为零。\n\n4. 定义稳态熵产生率\n$$\nI := \\int_{\\mathbb{R}^2} \\rho(x)^{-1}\\, j(x)^{\\top} a^{-1} j(x)\\,\\mathrm{d}x,\n$$\n并计算 $I$，用 $\\alpha$、$\\beta$ 和 $\\omega$ 表示其闭合形式解。\n\n请用 $\\alpha$、$\\beta$ 和 $\\omega$ 将最终答案表示为单个闭合形式的解析表达式。无需四舍五入。无需物理单位。", "solution": "该问题给出了一个二维线性伊藤随机微分方程 (SDE)，并要求分析其稳态性质。该 SDE 由 $\\mathrm{d}X_t = b(X_t)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t$ 给出，其漂移向量为 $b(x) = -Kx$，扩散矩阵为 $a = \\sigma\\sigma^\\top$。该问题的陈述在科学上是严谨的、适定的且自洽的。矩阵由 $K = S + R$ 给出，其中 $S = \\begin{pmatrix} \\alpha & 0 \\\\ 0 & \\beta \\end{pmatrix}$ 且 $\\alpha > 0, \\beta > 0$，$R = \\omega \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}$ 且 $\\omega \\neq 0$，以及 $a = 2S$。\n\n### 1. 稳态密度的存在性与计算\n\n稳态概率密度 $\\rho(x)$ 是福克-普朗克方程 (FPE) 的一个不随时间变化的解，即 $\\partial_t \\rho(x,t) = 0$。稳态 FPE 为：\n$$\n0 = -\\nabla \\cdot \\big(b(x)\\,\\rho(x)\\big) + \\tfrac{1}{2}\\,\\nabla \\cdot \\big(a\\,\\nabla \\rho(x)\\big)\n$$\n对于形如 $\\mathrm{d}X_t = -KX_t\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t$ 的线性 SDE，存在唯一的、可归一化的稳态分布的充要条件是矩阵 $K$ 的所有特征值都具有正实部。我们来验证这个条件。矩阵 $K$ 为：\n$$\nK = S + R = \\begin{pmatrix} \\alpha & 0 \\\\ 0 & \\beta \\end{pmatrix} + \\omega \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix} = \\begin{pmatrix} \\alpha & -\\omega \\\\ \\omega & \\beta \\end{pmatrix}\n$$\n特征方程为 $\\det(K - \\lambda I) = 0$，即 $(\\alpha - \\lambda)(\\beta - \\lambda) - (-\\omega)(\\omega) = 0$，得到 $\\lambda^2 - (\\alpha + \\beta)\\lambda + (\\alpha\\beta + \\omega^2) = 0$。特征值由二次公式给出：\n$$\n\\lambda_{\\pm} = \\frac{(\\alpha+\\beta) \\pm \\sqrt{(\\alpha+\\beta)^2 - 4(\\alpha\\beta+\\omega^2)}}{2} = \\frac{(\\alpha+\\beta) \\pm \\sqrt{(\\alpha-\\beta)^2 - 4\\omega^2}}{2}\n$$\n两个特征值的实部均为 $\\mathrm{Re}(\\lambda_{\\pm}) = \\frac{\\alpha+\\beta}{2}$。由于问题指定 $\\alpha > 0$ 且 $\\beta > 0$，我们有 $\\mathrm{Re}(\\lambda_{\\pm}) > 0$。因此，存在唯一的稳态分布。\n\n对于线性 SDE，稳态分布是高斯分布，$\\rho(x) = C \\exp(-\\frac{1}{2} x^\\top \\Sigma^{-1} x)$，其中 $\\Sigma$ 是稳态协方差矩阵。矩阵 $\\Sigma$ 是连续时间李雅普诺夫方程的唯一正定解：\n$$\nK\\Sigma + \\Sigma K^\\top = a\n$$\n给定 $K=S+R$ 和 $a=2S$。将这些代入李雅普诺夫方程：\n$$\n(S+R)\\Sigma + \\Sigma(S+R)^\\top = 2S\n$$\n我们来检验 $\\Sigma$ 是单位矩阵的假设，即 $\\Sigma = I_2$。\n$$\n(S+R)I_2 + I_2(S+R)^\\top = (S+R) + (S+R)^\\top = S+R+S^\\top+R^\\top\n$$\n矩阵 $S$ 是对称的，所以 $S^\\top=S$。矩阵 $R$ 是反对称的，所以 $R^\\top = -R$。\n$$\nS+R+S-R = 2S\n$$\n这与给定的扩散矩阵 $a=2S$ 相符。因此，稳态分布的协方差矩阵是 $\\Sigma = I_2 = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$。\n其逆矩阵为 $\\Sigma^{-1} = I_2$。那么稳态概率密度具有 $\\rho(x) = C \\exp(-\\frac{1}{2} x^\\top I_2 x) = C \\exp(-\\frac{1}{2} |x|^2)$ 的形式。记 $x = (x_1, x_2)^\\top$，则为 $\\rho(x_1, x_2) = C \\exp(-\\frac{1}{2}(x_1^2 + x_2^2))$。归一化常数 $C$ 通过要求 $\\int_{\\mathbb{R}^2} \\rho(x) \\mathrm{d}x = 1$ 来确定。\n$$\n\\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} C e^{-x_1^2/2} e^{-x_2^2/2} \\mathrm{d}x_1 \\mathrm{d}x_2 = C (\\sqrt{2\\pi}) (\\sqrt{2\\pi}) = 2\\pi C = 1\n$$\n所以，$C = \\frac{1}{2\\pi}$。稳态密度为：\n$$\n\\rho(x) = \\frac{1}{2\\pi} \\exp\\left(-\\frac{1}{2} |x|^2\\right)\n$$\n\n### 2. 细致平衡\n如果稳态概率流处处为零，则稳态满足细致平衡。概率流定义为 $j(x) = b(x)\\rho(x) - \\frac{1}{2}a\\nabla\\rho(x)$。\n对于 $\\rho(x) = \\frac{1}{2\\pi}\\exp(-\\frac{1}{2}x^\\top x)$，其梯度为 $\\nabla \\rho(x) = -x \\rho(x)$。\n将此代入概率流的表达式：\n$$\nj(x) = (-Kx)\\rho(x) - \\frac{1}{2}a(-x\\rho(x)) = (-Kx + \\frac{1}{2}ax)\\rho(x) = (\\frac{1}{2}a - K)x\\rho(x)\n$$\n细致平衡的条件是对于所有 $x$ 都有 $j(x)=0$。由于 $\\rho(x) \\neq 0$，这要求对于所有 $x$ 都有 $(\\frac{1}{2}a - K)x = 0$，这又意味着矩阵条件 $\\frac{1}{2}a - K = 0$，或 $K = \\frac{1}{2}a$。\n给定 $a = 2S$，所以条件变为 $K=S$。\n问题定义了 $K=S+R$。因此，细致平衡的条件是 $S+R=S$，这意味着 $R=0$。\n给定的矩阵 $R$ 是 $R = \\omega \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}$。该矩阵仅在 $\\omega=0$ 时为零。然而，问题指定 $\\omega \\neq 0$。\n因此，$R \\neq 0$，细致平衡的条件不满足。系统不处于细致平衡状态。\n\n### 3. 稳态概率流\n我们使用上面推导的表达式计算稳态概率流 $j(x)$：\n$$\nj(x) = (\\frac{1}{2}a - K)x\\rho(x)\n$$\n利用 $a=2S$ 和 $K=S+R$，这变为：\n$$\nj(x) = (\\frac{1}{2}(2S) - (S+R))x\\rho(x) = (S - S - R)x\\rho(x) = -Rx\\rho(x)\n$$\n我们用分量形式将其写出，设 $x=(x_1, x_2)^\\top$：\n$$\nj(x) = - \\omega \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} \\rho(x) = - \\omega \\begin{pmatrix} -x_2 \\\\ x_1 \\end{pmatrix} \\rho(x) = \\omega \\begin{pmatrix} x_2 \\\\ -x_1 \\end{pmatrix} \\rho(x)\n$$\n稳态 FPE 为 $\\partial_t \\rho = -\\nabla \\cdot j(x) = 0$。这意味着稳态流必须是无散度的。我们通过直接计算来验证这一点：$\\nabla \\cdot j(x) = \\frac{\\partial j_1}{\\partial x_1} + \\frac{\\partial j_2}{\\partial x_2}$。\n流的分量为 $j_1(x) = \\omega x_2 \\rho(x)$ 和 $j_2(x) = -\\omega x_1 \\rho(x)$。\n我们有 $\\frac{\\partial \\rho}{\\partial x_1} = -x_1 \\rho(x)$ 和 $\\frac{\\partial \\rho}{\\partial x_2} = -x_2 \\rho(x)$。\n流分量的偏导数为：\n$$\n\\frac{\\partial j_1}{\\partial x_1} = \\frac{\\partial}{\\partial x_1}(\\omega x_2 \\rho(x)) = \\omega x_2 \\frac{\\partial \\rho}{\\partial x_1} = \\omega x_2 (-x_1 \\rho(x)) = -\\omega x_1 x_2 \\rho(x)\n$$\n$$\n\\frac{\\partial j_2}{\\partial x_2} = \\frac{\\partial}{\\partial x_2}(-\\omega x_1 \\rho(x)) = -\\omega x_1 \\frac{\\partial \\rho}{\\partial x_2} = -\\omega x_1 (-x_2 \\rho(x)) = \\omega x_1 x_2 \\rho(x)\n$$\n散度是这两项之和：\n$$\n\\nabla \\cdot j(x) = -\\omega x_1 x_2 \\rho(x) + \\omega x_1 x_2 \\rho(x) = 0\n$$\n正如预期的那样，稳态流是无散度的。\n\n### 4. 稳态熵产生率\n稳态熵产生率 $I$ 定义为：\n$$\nI := \\int_{\\mathbb{R}^2} \\rho(x)^{-1}\\, j(x)^{\\top} a^{-1} j(x)\\,\\mathrm{d}x\n$$\n我们有 $j(x) = -Rx\\rho(x)$，所以 $j(x)^\\top = (-Rx\\rho(x))^\\top = -\\rho(x)x^\\top R^\\top$。\n被积函数为 $\\rho(x)^{-1} (-\\rho(x)x^\\top R^\\top) a^{-1} (-Rx\\rho(x)) = \\rho(x) x^\\top R^\\top a^{-1} R x$。\n我们来计算矩阵 $M = R^\\top a^{-1} R$。\n给定 $a=2S = \\begin{pmatrix} 2\\alpha & 0 \\\\ 0 & 2\\beta \\end{pmatrix}$，其逆矩阵为 $a^{-1} = \\begin{pmatrix} 1/(2\\alpha) & 0 \\\\ 0 & 1/(2\\beta) \\end{pmatrix}$。\n$R$ 的转置是 $R^\\top = \\omega \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix}$。\n$$\nR^\\top a^{-1} = \\omega \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix} \\begin{pmatrix} 1/(2\\alpha) & 0 \\\\ 0 & 1/(2\\beta) \\end{pmatrix} = \\omega \\begin{pmatrix} 0 & 1/(2\\beta) \\\\ -1/(2\\alpha) & 0 \\end{pmatrix}\n$$\n$$\nM = R^\\top a^{-1} R = \\left( \\omega \\begin{pmatrix} 0 & 1/(2\\beta) \\\\ -1/(2\\alpha) & 0 \\end{pmatrix} \\right) \\left( \\omega \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix} \\right) = \\omega^2 \\begin{pmatrix} 1/(2\\beta) & 0 \\\\ 0 & 1/(2\\alpha) \\end{pmatrix}\n$$\n$I$ 的积分变为：\n$$\nI = \\int_{\\mathbb{R}^2} \\rho(x) (x^\\top M x) \\,\\mathrm{d}x\n$$\n该积分是二次型 $x^\\top M x$ 关于密度 $\\rho(x)$ 的期望值。\n$$\nI = \\mathbb{E}_\\rho[x^\\top M x] = \\mathbb{E}_\\rho[\\text{Tr}(x^\\top M x)] = \\mathbb{E}_\\rho[\\text{Tr}(M x x^\\top)]\n$$\n根据期望和迹的线性性质，$I = \\text{Tr}(M\\, \\mathbb{E}_\\rho[x x^\\top])$。项 $\\mathbb{E}_\\rho[x x^\\top]$ 是稳态分布的协方差矩阵 $\\Sigma$，我们已经求出其为单位矩阵，即 $\\Sigma = I_2$。\n$$\nI = \\text{Tr}(M I_2) = \\text{Tr}(M)\n$$\n$M$ 的迹为：\n$$\n\\text{Tr}(M) = \\text{Tr}\\left(\\omega^2 \\begin{pmatrix} 1/(2\\beta) & 0 \\\\ 0 & 1/(2\\alpha) \\end{pmatrix}\\right) = \\omega^2 \\left(\\frac{1}{2\\beta} + \\frac{1}{2\\alpha}\\right)\n$$\n$$\nI = \\frac{\\omega^2}{2} \\left(\\frac{1}{\\alpha} + \\frac{1}{\\beta}\\right) = \\frac{\\omega^2}{2} \\frac{\\alpha+\\beta}{\\alpha\\beta}\n$$\n这就是稳态熵产生率的闭合形式表达式。", "answer": "$$\\boxed{\\frac{\\omega^{2} (\\alpha + \\beta)}{2 \\alpha \\beta}}$$", "id": "2996767"}, {"introduction": "随机微分方程的理论性质非常优美，但其应用往往依赖于数值模拟。一个关键问题是：数值格式是否能保持原始连续时间过程的不变测度？这个练习将带您深入研究一个针对含乘性噪声 SDE 的隐式欧拉格式的弱离散化误差。您将看到，与状态相关的扩散系数会引入微妙的偏差，从而破坏模拟的长期统计特性，通过分析离散时间马尔可夫链的生成元并推导必要的修正项，您将掌握一项强大的技术，以设计出更忠实于目标平稳分布的数值积分器 [@problem_id:2996785]。", "problem": "考虑一维伊藤(Itô)随机微分方程(SDE)\n$$\n\\mathrm{d}X_t = b(X_t)\\,\\mathrm{d}t + \\sigma(X_t)\\,\\mathrm{d}W_t,\n$$\n其中 $W_t$ 是标准维纳过程，$b:\\mathbb{R}\\to\\mathbb{R}$ 是漂移项，$\\sigma:\\mathbb{R}\\to(0,\\infty)$ 是扩散系数。令 $a(x) = \\sigma(x)^2$。假设存在一个严格为正的光滑不变密度 $\\pi:\\mathbb{R}\\to(0,\\infty)$，其形式为\n$$\n\\pi(x) \\propto \\exp(-V(x)),\n$$\n其中 $V:\\mathbb{R}\\to\\mathbb{R}$ 是一个二次连续可微的势，并且该 SDE 在细致平衡的意义下关于 $\\pi$ 是可逆的。在伊藤诠释下进行分析，并假设光滑性和增长条件足以保证不变测度的存在以及后续操作的有效性。\n\n使用固定时间步长 $h>0$ 的隐式噪声欧拉方法对该 SDE 进行离散化\n$$\nX_{n+1} = X_n + h\\,b(X_n) + \\sqrt{h}\\,\\sigma(X_{n+1})\\,\\xi_n,\n$$\n其中 $\\{\\xi_n\\}_{n\\ge 0}$ 是独立同分布的标准正态随机变量序列，并定义修正格式\n$$\nX_{n+1} = X_n + h\\big(b(X_n) + \\gamma\\,a'(X_n)\\big) + \\sqrt{h}\\,\\sigma(X_{n+1})\\,\\xi_n,\n$$\n其中 $\\gamma\\in\\mathbb{R}$ 是一个常数。这里 $a'(x)$ 表示 $a$ 的导数。\n\n对于光滑的紧支集检验函数 $f\\in C_c^\\infty(\\mathbb{R})$，使用关于 $h$ 的一阶弱展开，分析乘性噪声项 $\\sigma(X_{n+1})$ 如何影响不变密度中的离散时间偏差。然后，确定常数 $\\gamma$ 的值，使得对于所有此类函数 $f$，修正格式在弱意义下保持不变密度 $\\pi$ 达到一阶精度：\n$$\n\\int_{\\mathbb{R}} \\mathbb{E}\\big[f(X_{n+1})-f(X_n)\\,\\big|\\,X_n=x\\big]\\,\\pi(x)\\,\\mathrm{d}x = \\mathcal{O}(h^2),\n$$\n当 $h\\to 0$ 时。\n\n你的最终答案必须是 $\\gamma$ 的值。无需单位。不要四舍五入。", "solution": "用户要求我找到一个随机微分方程(SDE)修正数值格式中的常数 $\\gamma$ 的值，使得该格式在弱意义下能以一阶精度保持给定的不变密度。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件：**\n-   一维伊藤(Itô) SDE 为 $\\mathrm{d}X_t = b(X_t)\\,\\mathrm{d}t + \\sigma(X_t)\\,\\mathrm{d}W_t$。\n-   $W_t$ 是标准维纳过程。\n-   $b:\\mathbb{R}\\to\\mathbb{R}$ 是漂移函数。\n-   $\\sigma:\\mathbb{R}\\to(0,\\infty)$ 是扩散系数函数。\n-   $a(x) = \\sigma(x)^2$。\n-   该 SDE 存在一个严格为正的光滑不变密度 $\\pi(x) \\propto \\exp(-V(x))$，其中 $V(x)$ 是一个二次连续可微的势。\n-   该 SDE 关于 $\\pi$ 是可逆的。\n-   修正数值格式由 $X_{n+1} = X_n + h\\big(b(X_n) + \\gamma\\,a'(X_n)\\big) + \\sqrt{h}\\,\\sigma(X_{n+1})\\,\\xi_n$ 给出，其中 $\\{\\xi_n\\}$ 是独立同分布的 $N(0,1)$ 随机变量，且 $\\gamma \\in \\mathbb{R}$。\n-   需要满足的条件是，对于任何具有紧支集的光滑检验函数 $f \\in C_c^\\infty(\\mathbb{R})$，都有 $\\int_{\\mathbb{R}} \\mathbb{E}\\big[f(X_{n+1})-f(X_n)\\,\\big|\\,X_n=x\\big]\\,\\pi(x)\\,\\mathrm{d}x = \\mathcal{O}(h^2)$。\n\n**1.2. 使用提取的已知条件进行验证：**\n该问题在随机微分方程的数值分析领域中是良定义的。\n-   **科学基础：** 伊藤 SDE、不变测度、福克-普朗克方程和数值格式（如欧拉方法）等概念是随机分析及其应用中的标准和基本内容。不变密度的形式是吉布斯测度，这是统计力学中可逆系统的特征。\n-   **良定性：** 该问题提供了足够的信息来确定 $\\gamma$ 的值。所施加的条件是保持不变测度的弱精度的一个标准判据。\n-   **客观性：** 该问题使用精确的数学语言陈述，没有主观解释的余地。\n\n该问题不违反任何无效性标准。它是一个应用数学中的标准、形式化问题。\n\n**1.3. 结论与行动：**\n问题是 **有效的**。现在开始求解过程。\n\n### 步骤 2：求解推导\n\n求解过程包括三个主要部分：\n1.  建立 SDE 系数与不变密度之间的关系。\n2.  对数值格式进行弱展开，以找到其有效生成元。\n3.  使用不变测度上的条件来求解 $\\gamma$。\n\n**2.1. 不变密度与连续 SDE**\n\n过程 $X_t$ 的概率密度 $p(x,t)$ 遵循福克-普朗克方程演化：\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = \\mathcal{L}^\\dagger p(x,t) = -\\frac{\\partial}{\\partial x}\\big[b(x)p(x,t)\\big] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}\\big[a(x)p(x,t)\\big]\n$$\n其中 $\\mathcal{L}^\\dagger$ 是福克-普朗克算子，是生成元 $\\mathcal{L} = b(x)\\frac{\\mathrm{d}}{\\mathrm{d}x} + \\frac{1}{2}a(x)\\frac{\\mathrm{d}^2}{\\mathrm{d}x^2}$ 的伴随算子。\n\n不变（或平稳）密度 $\\pi(x)$ 满足 $\\frac{\\partial \\pi}{\\partial t} = 0$，这意味着 $\\mathcal{L}^\\dagger \\pi(x) = 0$。这表示概率流 $J(x)$ 是一个常数：\n$$\nJ(x) = b(x)\\pi(x) - \\frac{1}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x}\\big[a(x)\\pi(x)\\big] = \\text{const}.\n$$\n对于在无穷远处具有自然边界条件的可逆过程，此概率流为零。因此，我们有细致平衡条件：\n$$\nb(x)\\pi(x) = \\frac{1}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x}\\big[a(x)\\pi(x)\\big] = \\frac{1}{2}\\big[a'(x)\\pi(x) + a(x)\\pi'(x)\\big].\n$$\n由于 $\\pi(x) > 0$，我们可以两边同除以它，得到漂移项 $b(x)$ 的表达式：\n$$\nb(x) = \\frac{1}{2}a'(x) + \\frac{1}{2}a(x)\\frac{\\pi'(x)}{\\pi(x)}.\n$$\n此方程建立了漂移项 $b(x)$、扩散函数 $a(x)$ 和不变密度 $\\pi(x)$ 之间的关系，这对于连续时间过程必须成立。\n\n**2.2. 数值格式的弱展开**\n\n我们已知修正格式为：\n$$\nX_{n+1} = X_n + h\\tilde{b}(X_n) + \\sqrt{h}\\,\\sigma(X_{n+1})\\,\\xi_n,\n$$\n其中 $\\tilde{b}(x) = b(x) + \\gamma a'(x)$。令 $x = X_n$。增量为 $\\Delta X = X_{n+1} - x$。\n增量方程是隐式的：\n$$\n\\Delta X = h\\tilde{b}(x) + \\sqrt{h}\\,\\sigma(x + \\Delta X)\\,\\xi_n.\n$$\n为分析弱误差，我们对小 $h$ 进行展开。增量 $\\Delta X$ 的阶为 $\\mathcal{O}(\\sqrt{h})$。我们将 $\\sigma(x + \\Delta X)$ 在 $x$ 附近展开：\n$$\n\\sigma(x+\\Delta X) = \\sigma(x) + \\sigma'(x)\\Delta X + \\mathcal{O}((\\Delta X)^2).\n$$\n将此代入 $\\Delta X$ 的方程中：\n$$\n\\Delta X = h\\tilde{b}(x) + \\sqrt{h}\\,\\xi_n \\big( \\sigma(x) + \\sigma'(x)\\Delta X + \\mathcal{O}((\\Delta X)^2) \\big).\n$$\n我们迭代求解 $\\Delta X$。主导阶为 $\\Delta X \\approx \\sqrt{h}\\,\\sigma(x)\\xi_n$。将此近似代入 $\\sigma'(x)\\Delta X$ 项：\n$$\n\\Delta X \\approx h\\tilde{b}(x) + \\sqrt{h}\\,\\xi_n \\big( \\sigma(x) + \\sigma'(x)(\\sqrt{h}\\,\\sigma(x)\\xi_n) + \\mathcal{O}(h) \\big).\n$$\n$$\n\\Delta X = h\\tilde{b}(x) + \\sqrt{h}\\,\\sigma(x)\\xi_n + h\\,\\sigma(x)\\sigma'(x)\\xi_n^2 + \\mathcal{O}(h^{3/2}).\n$$\n现在，我们通过对 $f$ 在 $x$ 附近进行泰勒展开来计算检验函数 $f(x)$ 变化的期望值 $\\mathbb{E}[f(X_{n+1})-f(x)|X_n=x]$：\n$$\nf(X_{n+1}) - f(x) = f'(x)\\Delta X + \\frac{1}{2}f''(x)(\\Delta X)^2 + \\mathcal{O}((\\Delta X)^3).\n$$\n我们需要 $\\Delta X$ 的前两阶矩，精度到 $h$ 阶。随机变量 $\\xi_n$ 的矩为 $\\mathbb{E}[\\xi_n]=0, \\mathbb{E}[\\xi_n^2]=1, \\mathbb{E}[\\xi_n^3]=0$。\n$$\n\\mathbb{E}[\\Delta X | X_n=x] = \\mathbb{E}[h\\tilde{b}(x) + \\sqrt{h}\\,\\sigma(x)\\xi_n + h\\,\\sigma(x)\\sigma'(x)\\xi_n^2 + \\mathcal{O}(h^{3/2})].\n$$\n$$\n\\mathbb{E}[\\Delta X | X_n=x] = h\\tilde{b}(x) + h\\,\\sigma(x)\\sigma'(x)\\mathbb{E}[\\xi_n^2] + \\mathcal{O}(h^{3/2}) = h\\big(\\tilde{b}(x) + \\sigma(x)\\sigma'(x)\\big) + \\mathcal{O}(h^{3/2}).\n$$\n对于二阶矩，主导项就足够了：\n$$\n\\mathbb{E}[(\\Delta X)^2 | X_n=x] = \\mathbb{E}[(\\sqrt{h}\\,\\sigma(x)\\xi_n)^2] + \\mathcal{O}(h^{3/2}) = h\\,\\sigma(x)^2\\mathbb{E}[\\xi_n^2] + \\mathcal{O}(h^{3/2}) = h\\,a(x) + \\mathcal{O}(h^{3/2}).\n$$\n综合这些结果：\n$$\n\\mathbb{E}[f(X_{n+1})-f(x)|X_n=x] = f'(x) \\left[ h\\big(\\tilde{b}(x) + \\sigma(x)\\sigma'(x)\\big) \\right] + \\frac{1}{2}f''(x) \\left[ h\\,a(x) \\right] + \\mathcal{O}(h^2).\n$$\n利用关系 $a(x) = \\sigma(x)^2$，我们有 $a'(x) = 2\\sigma(x)\\sigma'(x)$，所以 $\\sigma(x)\\sigma'(x) = \\frac{1}{2}a'(x)$。代入此式以及 $\\tilde{b}(x) = b(x) + \\gamma a'(x)$：\n$$\n\\mathbb{E}[f(X_{n+1})-f(x)|X_n=x] = h \\left[ \\left(b(x) + \\gamma a'(x) + \\frac{1}{2}a'(x)\\right)f'(x) + \\frac{1}{2}a(x)f''(x) \\right] + \\mathcal{O}(h^2).\n$$\n方括号中的表达式是有效生成元 $\\mathcal{L}_{\\text{eff}}$ 作用于 $f(x)$ 的结果：\n$$\n\\mathcal{L}_{\\text{eff}}f(x) = \\left(b(x) + \\left(\\gamma+\\frac{1}{2}\\right)a'(x)\\right)f'(x) + \\frac{1}{2}a(x)f''(x).\n$$\n\n**2.3. 保持不变密度**\n\n问题要求对于任意 $f \\in C_c^\\infty(\\mathbb{R})$，\n$$\n\\int_{\\mathbb{R}} \\mathbb{E}\\big[f(X_{n+1})-f(X_n)\\,\\big|\\,X_n=x\\big]\\,\\pi(x)\\,\\mathrm{d}x = \\mathcal{O}(h^2).\n$$\n代入我们的弱展开式：\n$$\n\\int_{\\mathbb{R}} \\left[ h\\,\\mathcal{L}_{\\text{eff}}f(x) + \\mathcal{O}(h^2) \\right] \\pi(x)\\,\\mathrm{d}x = \\mathcal{O}(h^2).\n$$\n两边除以 $h$ 并取 $h \\to 0$ 的极限，此条件意味着：\n$$\n\\int_{\\mathbb{R}} \\mathcal{L}_{\\text{eff}}f(x)\\,\\pi(x)\\,\\mathrm{d}x = 0.\n$$\n这意味着 $\\pi(x)$ 必须是有效生成元 $\\mathcal{L}_{\\text{eff}}$ 的一个不变密度。由 $\\mathcal{L}_{\\text{eff}}$ 控制的过程必须满足其自身的、以 $\\pi$ 为密度的零流条件：\n$$\nb_{\\text{eff}}(x)\\pi(x) - \\frac{1}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x}\\big[a_{\\text{eff}}(x)\\pi(x)\\big] = 0,\n$$\n其中 $b_{\\text{eff}}(x) = b(x) + (\\gamma+\\frac{1}{2})a'(x)$ 是有效漂移项，$a_{\\text{eff}}(x) = a(x)$ 是有效扩散项。\n将它们代入条件中：\n$$\n\\left(b(x) + \\left(\\gamma+\\frac{1}{2}\\right)a'(x)\\right)\\pi(x) - \\frac{1}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x}\\big[a(x)\\pi(x)\\big] = 0.\n$$\n我们可以将其重新排列为：\n$$\n\\left(\\gamma+\\frac{1}{2}\\right)a'(x)\\pi(x) + \\left( b(x)\\pi(x) - \\frac{1}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x}\\big[a(x)\\pi(x)\\big] \\right) = 0.\n$$\n从 2.1 节可知，第二个括号中的项是原始 SDE 的零流条件，其值为 0。因此，方程简化为：\n$$\n\\left(\\gamma+\\frac{1}{2}\\right)a'(x)\\pi(x) = 0.\n$$\n这个等式必须对所有 $x$ 都成立。由于我们已知 $\\pi(x)>0$，并且我们不能假设 $a'(x)=0$（因为 $\\sigma(x)$ 不一定是常数），那么常数因子必须为零：\n$$\n\\gamma + \\frac{1}{2} = 0.\n$$\n解出 $\\gamma$ 得：\n$$\n\\gamma = -\\frac{1}{2}.\n$$\n这个 $\\gamma$ 值在漂移项中引入了一个修正项 $-\\frac{1}{2}a'(x)$，该修正项正好抵消了由乘性噪声项的隐式离散化所引入的伪漂移项 $\\frac{1}{2}a'(x)$。最终得到的有效漂移项是 $b(x)$，与原始 SDE 在弱展开的一阶上相匹配。", "answer": "$$ \\boxed{-\\frac{1}{2}} $$", "id": "2996785"}]}