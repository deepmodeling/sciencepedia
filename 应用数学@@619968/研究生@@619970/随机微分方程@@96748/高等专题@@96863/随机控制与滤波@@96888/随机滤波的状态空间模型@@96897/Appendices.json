{"hands_on_practices": [{"introduction": "我们从一个基本问题开始，它将滤波的抽象概念与条件期望的具体数学联系起来。这个练习通过一个简单的联合高斯分布场景，引导你从第一性原理推导出最优线性估计。这个过程将自然地揭示出所有滤波器的核心结构——“预测器-校正器”或“先验+增益×创新”的形式，为你理解更复杂的滤波算法奠定坚实的基础。[@problem_id:2996462]", "problem": "考虑一个单步离散时间线性高斯估计问题，其中潜状态 $X$ 和测量 $Y$ 服从联合高斯分布。设 $(X,Y)$ 的联合分布为二元正态分布，其均值向量 $m$ 和协方差矩阵 $\\Sigma$ 分别为\n$$\nm = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}, \\qquad \\Sigma = \\begin{pmatrix} 7 & 3 \\\\ 3 & 5 \\end{pmatrix}.\n$$\n仅从多元正态密度的定义和条件期望的定义出发，推导条件期望 $\\mathbb{E}[X \\mid Y]$作为随机变量 $Y$ 的函数的闭式解析表达式。然后，在离散设置下，将此表达式解释为一次单步线性滤波器更新，并在您推导的表达式中指明先验均值、测量新息和滤波器增益。您的最终答案应仅表示为关于 $Y$ 的解析表达式。无需四舍五入，也无单位。", "solution": "该问题要求从第一性原理出发，为两个联合高斯随机变量 $X$ 和 $Y$ 推导条件期望 $\\mathbb{E}[X \\mid Y]$，然后在线性滤波的背景下解释该结果。\n\n随机向量 $\\begin{pmatrix} X \\\\ Y \\end{pmatrix}$ 的联合分布为一个二元正态分布，其均值向量 $m$ 和协方差矩阵 $\\Sigma$ 为：\n$$ m = \\begin{pmatrix} \\mu_X \\\\ \\mu_Y \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix} $$\n$$ \\Sigma = \\begin{pmatrix} \\Sigma_{XX} & \\Sigma_{XY} \\\\ \\Sigma_{YX} & \\Sigma_{YY} \\end{pmatrix} = \\begin{pmatrix} 7 & 3 \\\\ 3 & 5 \\end{pmatrix} $$\n由此，我们确定边缘均值、方差和协方差：\n$\\mu_X = \\mathbb{E}[X] = 2$，$\\mu_Y = \\mathbb{E}[Y] = -1$，$\\Sigma_{XX} = \\text{Var}(X) = 7$，$\\Sigma_{YY} = \\text{Var}(Y) = 5$，以及 $\\Sigma_{XY} = \\Sigma_{YX} = \\text{Cov}(X,Y) = 3$。\n\n条件期望 $\\mathbb{E}[X \\mid Y=y]$ 由以下积分定义：\n$$ \\mathbb{E}[X \\mid Y=y] = \\int_{-\\infty}^{\\infty} x \\cdot p_{X|Y}(x|y) \\, dx $$\n其中 $p_{X|Y}(x|y)$ 是在给定 $Y=y$ 的条件下，$X$ 的条件概率密度函数 (PDF)。该条件 PDF 由联合 PDF 与 $Y$ 的边缘 PDF 之比给出：\n$$ p_{X|Y}(x|y) = \\frac{p_{X,Y}(x,y)}{p_Y(y)} $$\n对于二元正态分布，联合 PDF $p_{X,Y}(x,y)$ 为：\n$$ p_{X,Y}(x,y) = \\frac{1}{2\\pi \\sqrt{\\det(\\Sigma)}} \\exp\\left( -\\frac{1}{2} ( (x,y) - m )^T \\Sigma^{-1} ( (x,y) - m ) \\right) $$\n首先，我们计算 $\\Sigma$ 的行列式和逆矩阵：\n$$ \\det(\\Sigma) = (7)(5) - (3)(3) = 35 - 9 = 26 $$\n$$ \\Sigma^{-1} = \\frac{1}{26} \\begin{pmatrix} 5 & -3 \\\\ -3 & 7 \\end{pmatrix} $$\n指数中的二次型为 $Q(x,y) = ( (x-\\mu_X, y-\\mu_Y) ) \\Sigma^{-1} ( (x-\\mu_X, y-\\mu_Y) )^T$：\n$$ Q(x,y) = \\frac{1}{26} \\left[ 5(x-\\mu_X)^2 - 6(x-\\mu_X)(y-\\mu_Y) + 7(y-\\mu_Y)^2 \\right] $$\n为了求出给定 $Y=y$ 时 $X$ 的条件分布，我们必须通过对 $x$ 进行配方来重新整理这个表达式。我们将 $y$ 视为一个固定参数。\n$$ Q(x,y) = \\frac{1}{26} \\left\\{ 5 \\left[ (x-\\mu_X)^2 - \\frac{6}{5}(x-\\mu_X)(y-\\mu_Y) \\right] + 7(y-\\mu_Y)^2 \\right\\} $$\n对包含 $x$ 的项进行配方：\n$$ (x-\\mu_X)^2 - \\frac{6}{5}(x-\\mu_X)(y-\\mu_Y) = \\left( (x-\\mu_X) - \\frac{3}{5}(y-\\mu_Y) \\right)^2 - \\left( \\frac{3}{5}(y-\\mu_Y) \\right)^2 $$\n$$ = \\left( x - \\left( \\mu_X + \\frac{3}{5}(y-\\mu_Y) \\right) \\right)^2 - \\frac{9}{25}(y-\\mu_Y)^2 $$\n将此代回 $Q(x,y)$ 的表达式中：\n$$ Q(x,y) = \\frac{1}{26} \\left\\{ 5 \\left[ \\left( x - \\left( \\mu_X + \\frac{3}{5}(y-\\mu_Y) \\right) \\right)^2 - \\frac{9}{25}(y-\\mu_Y)^2 \\right] + 7(y-\\mu_Y)^2 \\right\\} $$\n$$ Q(x,y) = \\frac{1}{26} \\left\\{ 5 \\left( x - \\left( \\mu_X + \\frac{3}{5}(y-\\mu_Y) \\right) \\right)^2 - \\frac{9}{5}(y-\\mu_Y)^2 + 7(y-\\mu_Y)^2 \\right\\} $$\n$$ Q(x,y) = \\frac{1}{26} \\left\\{ 5 \\left( x - \\left( \\mu_X + \\frac{3}{5}(y-\\mu_Y) \\right) \\right)^2 + \\left( 7 - \\frac{9}{5} \\right)(y-\\mu_Y)^2 \\right\\} $$\n$$ Q(x,y) = \\frac{1}{26} \\left\\{ 5 \\left( x - \\left( \\mu_X + \\frac{3}{5}(y-\\mu_Y) \\right) \\right)^2 + \\frac{26}{5}(y-\\mu_Y)^2 \\right\\} $$\n分配 $\\frac{1}{26}$ 这一项：\n$$ Q(x,y) = \\frac{5}{26} \\left( x - \\left( \\mu_X + \\frac{3}{5}(y-\\mu_Y) \\right) \\right)^2 + \\frac{1}{5}(y-\\mu_Y)^2 $$\n$$ Q(x,y) = \\frac{\\left( x - \\left( \\mu_X + \\frac{3}{5}(y-\\mu_Y) \\right) \\right)^2}{26/5} + \\frac{(y-\\mu_Y)^2}{5} $$\n联合 PDF 的指数是 $-\\frac{1}{2}Q(x,y)$。现在，联合 PDF 可以写成两项的乘积：\n$$ p_{X,Y}(x,y) = \\frac{1}{2\\pi\\sqrt{26}} \\exp\\left( -\\frac{1}{2} \\left[ \\frac{\\left(x - \\left(\\mu_X + \\frac{3}{5}(y-\\mu_Y)\\right)\\right)^2}{26/5} + \\frac{(y-\\mu_Y)^2}{5} \\right] \\right) $$\n利用 $\\sqrt{26} = \\sqrt{5 \\cdot (26/5)}$，我们可以将表达式分离：\n$$ p_{X,Y}(x,y) = \\left[ \\frac{1}{\\sqrt{2\\pi \\cdot 5}} \\exp\\left(-\\frac{(y-\\mu_Y)^2}{2 \\cdot 5}\\right) \\right] \\cdot \\left[ \\frac{1}{\\sqrt{2\\pi \\cdot (26/5)}} \\exp\\left(-\\frac{\\left(x - \\left(\\mu_X + \\frac{3}{5}(y-\\mu_Y)\\right)\\right)^2}{2 \\cdot (26/5)}\\right) \\right] $$\n第一个方括号中的项是均值为 $\\mu_Y$、方差为 $\\Sigma_{YY}=5$ 的正态分布的 PDF，这恰好是边缘 PDF $p_Y(y)$。因此，第二个方括号中的项必定是条件 PDF $p_{X|Y}(x|y)$。\n通过观察第二项，我们发现给定 $Y=y$ 时 $X$ 的条件分布是一个正态分布，其：\n- 条件均值: $\\mu_{X|Y} = \\mu_X + \\frac{3}{5}(y-\\mu_Y)$\n- 条件方差: $\\sigma^2_{X|Y} = \\frac{26}{5}$\n\n条件期望 $\\mathbb{E}[X \\mid Y=y]$ 是此条件分布的均值。\n$$ \\mathbb{E}[X \\mid Y=y] = \\mu_X + \\frac{3}{5}(y-\\mu_Y) $$\n代入给定的数值 $\\mu_X = 2$ 和 $\\mu_Y=-1$：\n$$ \\mathbb{E}[X \\mid Y=y] = 2 + \\frac{3}{5}(y - (-1)) = 2 + \\frac{3}{5}(y+1) $$\n$$ \\mathbb{E}[X \\mid Y=y] = 2 + \\frac{3}{5}y + \\frac{3}{5} = \\frac{13}{5} + \\frac{3}{5}y $$\n用随机变量 $Y$ 替换特定值 $y$，我们得到条件期望作为 $Y$ 的函数的最终表达式：\n$$ \\mathbb{E}[X \\mid Y] = \\frac{13}{5} + \\frac{3}{5}Y $$\n\n现在，我们将此表达式解释为一次单步线性滤波器更新。这种更新的一般形式是：\n$$ \\text{后验估计} = \\text{先验估计} + \\text{增益} \\times (\\text{新息}) $$\n在此背景下：\n- 观测到测量值 $Y$ 后，状态 $X$ 的后验估计是条件期望 $\\mathbb{E}[X \\mid Y]$。\n- 观测到 $Y$ 之前，状态 $X$ 的先验估计是其无条件均值 $\\mathbb{E}[X] = \\mu_X$。\n- 测量新息是实际测量值 $Y$ 与其期望值（即预测的测量值）之差，即 $Y - \\mathbb{E}[Y] = Y - \\mu_Y$。\n\n让我们将推导出的 $\\mathbb{E}[X \\mid Y]$ 表达式改写成这种形式：\n$$ \\mathbb{E}[X \\mid Y] = \\mu_X + \\frac{3}{5}(Y - \\mu_Y) $$\n将此与滤波器结构进行比较，我们可以识别出各个组成部分：\n- **先验均值:** $\\mathbb{E}[X] = \\mu_X = 2$。这是在没有来自 $Y$ 的信息的情况下对 $X$ 的最佳估计。\n- **测量新息:** $Y - \\mu_Y = Y - (-1) = Y+1$。这一项代表了测量值 $Y$ 提供的新信息。\n- **滤波器增益:** 乘以新息的系数是滤波器增益, $K = \\frac{3}{5}$。一般来说，这个增益是 $K = \\Sigma_{XY}\\Sigma_{YY}^{-1} = 3 \\cdot 5^{-1} = \\frac{3}{5}$。增益决定了在更新先验估计时给予新息的权重。\n\n表达式 $\\mathbb{E}[X \\mid Y] = 2 + \\frac{3}{5}(Y+1)$ 是线性估计中的一个经典结果，它表示在均方误差意义下给定 $Y$ 时对 $X$ 的最优线性估计。", "answer": "$$ \\boxed{\\frac{13}{5} + \\frac{3}{5}Y} $$", "id": "2996462"}, {"introduction": "在掌握了单步更新的基本思想之后，我们处理一个更接近实际应用的场景：对时序数据的递归滤波。这个练习将带你进入离散状态隐马尔可夫模型（HMM）的世界，通过一个具体的计算任务，让你亲手实践滤波算法中至关重要的两阶段循环：“预测”与“更新”。理解这个递归过程是掌握卡尔曼滤波及其众多变体的关键。[@problem_id:2996591]", "problem": "考虑一个定义在两个隐状态 $\\{s_{1}, s_{2}\\}$ 上的离散时间隐马尔可夫模型 (HMM)，用于对一个标量观测过程进行随机滤波。状态过程 $\\{x_{k}\\}_{k \\geq 0}$ 是一个时齐马尔可夫链，其转移概率为 $a_{ij} = \\mathbb{P}(x_{k} = s_{j} \\mid x_{k-1} = s_{i})$，观测似然是高斯的且依赖于状态：$y_{k} \\mid (x_{k} = s_{i}) \\sim \\mathcal{N}(\\mu_{i}, \\sigma_{i}^{2})$。给定时刻 $k-1$ 的先验滤波分布、转移矩阵、时刻 $k$ 的观测模型参数，以及实现的观测值 $y_{k}$：\n- 时刻 $k-1$ 的先验滤波分布：$\\mathbb{P}(x_{k-1} = s_{1} \\mid y_{1:k-1}) = 0.55$ 且 $\\mathbb{P}(x_{k-1} = s_{2} \\mid y_{1:k-1}) = 0.45$。\n- 转移矩阵项（每行之和为一）：$a_{11} = 0.93$, $a_{12} = 0.07$, $a_{21} = 0.20$, $a_{22} = 0.80$，其中 $a_{ij} = \\mathbb{P}(x_{k} = s_{j} \\mid x_{k-1} = s_{i})$。\n- 观测参数：$\\mu_{1} = 0$, $\\sigma_{1} = 0.5$ 且 $\\mu_{2} = 1$, $\\sigma_{2} = 0.3$。\n- 时刻 $k$ 的实现观测值：$y_{k} = 0.6$。\n\n从基本原理（马尔可夫性质、全概率定律和贝叶斯法则）出发，推导单步滤波更新，以获得归一化的后验分布 $\\big(\\mathbb{P}(x_{k} = s_{1} \\mid y_{1:k}), \\mathbb{P}(x_{k} = s_{2} \\mid y_{1:k})\\big)$，并将高斯发射概率视为概率密度。使用标准高斯密度\n$$\n\\phi(y;\\mu,\\sigma^{2}) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\Big(-\\frac{(y-\\mu)^{2}}{2\\sigma^{2}}\\Big).\n$$\n你的最终答案必须是写在 LaTeX $\\mathrm{pmatrix}$ 环境中的单个行向量形式的归一化后验。不要四舍五入；请提供一个精确的闭式解析表达式（可使用指数和 $\\pi$）。", "solution": "目标是计算时刻 $k$ 的后验滤波分布，即概率向量 $\\big(\\mathbb{P}(x_{k} = s_{1} \\mid y_{1:k}), \\mathbb{P}(x_{k} = s_{2} \\mid y_{1:k})\\big)$。该计算是隐马尔可夫模型 (HMM) 前向算法的一个递归步骤，包含两个阶段：预测和更新。我们将按要求从基本原理推导此步骤。\n\n令时刻 $k-1$ 的滤波分布用 $\\alpha_{k-1}(i) = \\mathbb{P}(x_{k-1} = s_{i} \\mid y_{1:k-1})$ 表示。题目给出了这些值：\n$\\alpha_{k-1}(1) = \\mathbb{P}(x_{k-1} = s_{1} \\mid y_{1:k-1}) = 0.55 = \\frac{11}{20}$\n$\\alpha_{k-1}(2) = \\mathbb{P}(x_{k-1} = s_{2} \\mid y_{1:k-1}) = 0.45 = \\frac{9}{20}$\n\n状态转移概率由矩阵 $A = [a_{ij}]$ 给出，其中 $a_{ij} = \\mathbb{P}(x_{k} = s_{j} \\mid x_{k-1} = s_{i})$。给定的值为：\n$a_{11} = 0.93 = \\frac{93}{100}$, $a_{12} = 0.07 = \\frac{7}{100}$\n$a_{21} = 0.20 = \\frac{1}{5}$, $a_{22} = 0.80 = \\frac{4}{5}$\n\n在给定状态 $x_k=s_i$ 的条件下，观测值 $y_k$ 的观测似然是一个高斯密度 $p(y_k | x_k=s_i) = \\phi(y_k; \\mu_i, \\sigma_i^2)$。我们将其表示为 $b_i(y_k)$。\n\n**1. 预测步骤 (时间更新)**\n\n第一步是预测在给定截至时刻 $k-1$ 的观测值的情况下，时刻 $k$ 的状态分布。这个预测概率 $\\mathbb{P}(x_{k} = s_{j} \\mid y_{1:k-1})$，通过应用全概率定律，对时刻 $k-1$ 的状态进行边缘化来求得：\n$$\n\\mathbb{P}(x_{k} = s_{j} \\mid y_{1:k-1}) = \\sum_{i=1}^{2} \\mathbb{P}(x_{k} = s_{j}, x_{k-1} = s_{i} \\mid y_{1:k-1})\n$$\n使用条件概率的定义（链式法则）：\n$$\n\\mathbb{P}(x_{k} = s_{j} \\mid y_{1:k-1}) = \\sum_{i=1}^{2} \\mathbb{P}(x_{k} = s_{j} \\mid x_{k-1} = s_{i}, y_{1:k-1}) \\mathbb{P}(x_{k-1} = s_{i} \\mid y_{1:k-1})\n$$\n根据状态过程的马尔可夫性质，从 $x_{k-1}$ 到 $x_k$ 的转移独立于过去的观测值 $y_{1:k-1}$。因此，$\\mathbb{P}(x_{k} = s_{j} \\mid x_{k-1} = s_{i}, y_{1:k-1}) = \\mathbb{P}(x_{k} = s_{j} \\mid x_{k-1} = s_{i}) = a_{ij}$。方程简化为：\n$$\n\\hat{\\alpha}_k(j) \\equiv \\mathbb{P}(x_{k} = s_{j} \\mid y_{1:k-1}) = \\sum_{i=1}^{2} a_{ij} \\alpha_{k-1}(i)\n$$\n我们现在计算这些预测概率：\n对于 $j=1$：\n$$\n\\hat{\\alpha}_k(1) = a_{11}\\alpha_{k-1}(1) + a_{21}\\alpha_{k-1}(2) = \\left(\\frac{93}{100}\\right)\\left(\\frac{11}{20}\\right) + \\left(\\frac{1}{5}\\right)\\left(\\frac{9}{20}\\right) = \\frac{1023}{2000} + \\frac{180}{2000} = \\frac{1203}{2000}\n$$\n对于 $j=2$：\n$$\n\\hat{\\alpha}_k(2) = a_{12}\\alpha_{k-1}(1) + a_{22}\\alpha_{k-1}(2) = \\left(\\frac{7}{100}\\right)\\left(\\frac{11}{20}\\right) + \\left(\\frac{4}{5}\\right)\\left(\\frac{9}{20}\\right) = \\frac{77}{2000} + \\frac{720}{2000} = \\frac{797}{2000}\n$$\n作为检验，$\\hat{\\alpha}_k(1) + \\hat{\\alpha}_k(2) = \\frac{1203}{2000} + \\frac{797}{2000} = \\frac{2000}{2000} = 1$。\n\n**2. 更新步骤 (测量更新)**\n\n接下来，我们使用贝叶斯法则引入新的观测值 $y_k = 0.6 = \\frac{3}{5}$，将预测分布更新为后验分布 $\\alpha_k(j) = \\mathbb{P}(x_k=s_j|y_{1:k})$。\n$$\n\\alpha_k(j) = \\mathbb{P}(x_{k} = s_{j} \\mid y_k, y_{1:k-1}) = \\frac{p(y_k \\mid x_{k} = s_{j}, y_{1:k-1}) \\mathbb{P}(x_{k} = s_{j} \\mid y_{1:k-1})}{p(y_k \\mid y_{1:k-1})}\n$$\n在给定当前状态 $x_k$ 的条件下，观测值 $y_k$ 条件独立于过去的观测值 $y_{1:k-1}$。因此，$p(y_k \\mid x_{k} = s_{j}, y_{1:k-1}) = p(y_k \\mid x_{k} = s_{j}) = b_j(y_k)$。方程变为：\n$$\n\\alpha_k(j) = \\frac{b_j(y_k) \\hat{\\alpha}_k(j)}{p(y_k \\mid y_{1:k-1})}\n$$\n分母是一个归一化常数，$C = p(y_k \\mid y_{1:k-1})$，它是分子对所有状态求和的结果：$C = \\sum_{i=1}^{2} b_i(y_k) \\hat{\\alpha}_k(i)$。\n\n首先，我们计算 $y_k = \\frac{3}{5}$ 的似然 $b_j(y_k)$：\n-   对于状态 $s_1$：$\\mu_1 = 0$, $\\sigma_1 = 0.5 = \\frac{1}{2}$。\n    指数为 $-\\frac{(y_k-\\mu_1)^2}{2\\sigma_1^2} = -\\frac{(\\frac{3}{5}-0)^2}{2(\\frac{1}{2})^2} = -\\frac{9/25}{1/2} = -\\frac{18}{25}$。\n    $b_1(y_k) = \\frac{1}{\\sqrt{2\\pi}\\sigma_1} \\exp\\left(-\\frac{18}{25}\\right) = \\frac{1}{\\sqrt{2\\pi}(\\frac{1}{2})} \\exp\\left(-\\frac{18}{25}\\right) = \\frac{2}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{18}{25}\\right)$。\n-   对于状态 $s_2$：$\\mu_2 = 1$, $\\sigma_2 = 0.3 = \\frac{3}{10}$。\n    指数为 $-\\frac{(y_k-\\mu_2)^2}{2\\sigma_2^2} = -\\frac{(\\frac{3}{5}-1)^2}{2(\\frac{3}{10})^2} = -\\frac{(-2/5)^2}{2(9/100)} = -\\frac{4/25}{9/50} = -\\frac{4}{25}\\frac{50}{9} = -\\frac{8}{9}$。\n    $b_2(y_k) = \\frac{1}{\\sqrt{2\\pi}\\sigma_2} \\exp\\left(-\\frac{8}{9}\\right) = \\frac{1}{\\sqrt{2\\pi}(\\frac{3}{10})} \\exp\\left(-\\frac{8}{9}\\right) = \\frac{10}{3\\sqrt{2\\pi}} \\exp\\left(-\\frac{8}{9}\\right)$。\n\n现在，我们计算未归一化的后验概率，$\\tilde{\\alpha}_k(j) = b_j(y_k)\\hat{\\alpha}_k(j)$：\n$$\n\\tilde{\\alpha}_k(1) = \\left(\\frac{2}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{18}{25}\\right)\\right) \\left(\\frac{1203}{2000}\\right) = \\frac{1203}{1000\\sqrt{2\\pi}} \\exp\\left(-\\frac{18}{25}\\right)\n$$\n$$\n\\tilde{\\alpha}_k(2) = \\left(\\frac{10}{3\\sqrt{2\\pi}} \\exp\\left(-\\frac{8}{9}\\right)\\right) \\left(\\frac{797}{2000}\\right) = \\frac{797}{600\\sqrt{2\\pi}} \\exp\\left(-\\frac{8}{9}\\right)\n$$\n归一化常数是 $C = \\tilde{\\alpha}_k(1) + \\tilde{\\alpha}_k(2)$。归一化的概率为 $\\alpha_k(j) = \\frac{\\tilde{\\alpha}_k(j)}{C}$。公因子 $\\frac{1}{\\sqrt{2\\pi}}$ 被消去。\n$$\n\\alpha_k(1) = \\frac{\\frac{1203}{1000} \\exp\\left(-\\frac{18}{25}\\right)}{\\frac{1203}{1000} \\exp\\left(-\\frac{18}{25}\\right) + \\frac{797}{600} \\exp\\left(-\\frac{8}{9}\\right)}\n$$\n$$\n\\alpha_k(2) = \\frac{\\frac{797}{600} \\exp\\left(-\\frac{8}{9}\\right)}{\\frac{1203}{1000} \\exp\\left(-\\frac{18}{25}\\right) + \\frac{797}{600} \\exp\\left(-\\frac{8}{9}\\right)}\n$$\n为了简化表达式并消除分数，我们可以将分子和分母同乘以 $1000$ 和 $600$ 的最小公倍数，即 $3000$。\n-   对于 $\\alpha_k(1)$，分子变为 $3000 \\cdot \\frac{1203}{1000} \\exp\\left(-\\frac{18}{25}\\right) = 3 \\cdot 1203 \\exp\\left(-\\frac{18}{25}\\right) = 3609 \\exp\\left(-\\frac{18}{25}\\right)$。\n-   对于 $\\alpha_k(2)$，分子变为 $3000 \\cdot \\frac{797}{600} \\exp\\left(-\\frac{8}{9}\\right) = 5 \\cdot 797 \\exp\\left(-\\frac{8}{9}\\right) = 3985 \\exp\\left(-\\frac{8}{9}\\right)$。\n-   两者的分母是这两项的和。\n\n最终的归一化后验概率为：\n$$\n\\alpha_k(1) = \\mathbb{P}(x_k=s_1 | y_{1:k}) = \\frac{3609 \\exp\\left(-\\frac{18}{25}\\right)}{3609 \\exp\\left(-\\frac{18}{25}\\right) + 3985 \\exp\\left(-\\frac{8}{9}\\right)}\n$$\n$$\n\\alpha_k(2) = \\mathbb{P}(x_k=s_2 | y_{1:k}) = \\frac{3985 \\exp\\left(-\\frac{8}{9}\\right)}{3609 \\exp\\left(-\\frac{18}{25}\\right) + 3985 \\exp\\left(-\\frac{8}{9}\\right)}\n$$\n最终答案是行向量 $(\\alpha_k(1), \\alpha_k(2))$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3609 \\exp\\left(-\\frac{18}{25}\\right)}{3609 \\exp\\left(-\\frac{18}{25}\\right) + 3985 \\exp\\left(-\\frac{8}{9}\\right)} & \\frac{3985 \\exp\\left(-\\frac{8}{9}\\right)}{3609 \\exp\\left(-\\frac{18}{25}\\right) + 3985 \\exp\\left(-\\frac{8}{9}\\right)} \\end{pmatrix}}\n$$", "id": "2996591"}, {"introduction": "最后一个练习将我们的视角从“如何应用”提升到“为何能用以及何时会失效”的分析层面。它提出了一个关键问题：滤波器在什么条件下会失败？通过分析一个不稳定状态不可观测的系统，本练习将阐释“可检测性”这一核心概念，并让你通过推导证明，缺乏可检测性将如何导致估计误差无限增长。这是任何设计或诊断滤波器的实践者都必须掌握的重要一课。[@problem_id:2996460]", "problem": "考虑 $\\mathbb{R}^{2}$ 中的连续时间线性时不变 (LTI) 状态空间模型，由以下随机微分方程 (SDE) 给出\n$$\n\\mathrm{d}X(t) = A\\,X(t)\\,\\mathrm{d}t + G\\,\\mathrm{d}W(t),\n$$\n其中 $X(t) \\in \\mathbb{R}^{2}$，$W(t)$ 是标量标准维纳过程，$A = \\begin{pmatrix} \\alpha & 0 \\\\ 0 & -\\beta \\end{pmatrix}$ 且 $\\alpha > 0$ 和 $\\beta > 0$，$G = \\begin{pmatrix} \\sqrt{q} \\\\ 0 \\end{pmatrix}$ 且 $q > 0$。观测过程为\n$$\n\\mathrm{d}Y(t) = C\\,X(t)\\,\\mathrm{d}t + \\sqrt{r}\\,\\mathrm{d}V(t),\n$$\n其中 $Y(t) \\in \\mathbb{R}$，$V(t)$ 是一个独立于 $W(t)$ 的标量标准维纳过程，$r > 0$，且 $C = \\begin{pmatrix} 0 & 1 \\end{pmatrix}$。假设最优滤波器的初始估计误差协方差为 $P(0) = \\begin{pmatrix} p_{0} & 0 \\\\ 0 & s_{0} \\end{pmatrix}$，其中 $p_{0} > 0$ 且 $s_{0} > 0$。\n\n该模型表现出不可检测性，因为与特征值 $\\alpha$ 相关的不稳定模式是不可观测的。从随机滤波和状态空间建模的基本原理出发，推导估计误差协方差的演化过程，并计算沿不可检测的不稳定方向的估计误差方差的闭式表达式，即对所有 $t \\ge 0$ 的 $(1,1)$ 项 $P_{11}(t)$。解释为什么由于缺乏可检测性，该方差会随时间无界增长的几何直觉。\n\n将 $P_{11}(t)$ 的最终答案表示为包含符号 $\\alpha$、$q$ 和 $p_{0}$ 的闭式解析表达式。无需四舍五入。", "solution": "最优滤波器的估计误差协方差矩阵 $P(t) = \\mathbb{E}[(X(t) - \\hat{X}(t))(X(t) - \\hat{X}(t))^T]$ 的演化由连续时间 Riccati 微分方程决定：\n$$\n\\frac{\\mathrm{d}P(t)}{\\mathrm{d}t} = A P(t) + P(t) A^T + G Q G^T - P(t) C^T R^{-1} C P(t)\n$$\n根据问题描述，系统矩阵为 $A = \\begin{pmatrix} \\alpha & 0 \\\\ 0 & -\\beta \\end{pmatrix}$，$G = \\begin{pmatrix} \\sqrt{q} \\\\ 0 \\end{pmatrix}$，以及 $C = \\begin{pmatrix} 0 & 1 \\end{pmatrix}$。过程噪声 $W(t)$ 是一个标量标准维纳过程，因此其相关的协方差为 $Q=1$。观测噪声方差给定为 $r$，因此 $R=r$。将这些代入 Riccati 方程可得：\n$$\n\\frac{\\mathrm{d}P(t)}{\\mathrm{d}t} = A P(t) + P(t) A^T + G G^T - \\frac{1}{r} P(t) C^T C P(t)\n$$\n我们计算矩阵乘积：\n$$ G G^T = \\begin{pmatrix} \\sqrt{q} \\\\ 0 \\end{pmatrix} \\begin{pmatrix} \\sqrt{q} & 0 \\end{pmatrix} = \\begin{pmatrix} q & 0 \\\\ 0 & 0 \\end{pmatrix} $$\n$$ C^T C = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix} $$\n令 $P(t)$ 由其分量表示：$P(t) = \\begin{pmatrix} P_{11}(t) & P_{12}(t) \\\\ P_{21}(t) & P_{22}(t) \\end{pmatrix}$。由于协方差矩阵的对称性，有 $P_{12}(t) = P_{21}(t)$。\nRiccati 方程中的各项为：\n$$ A P(t) + P(t) A^T = \\begin{pmatrix} \\alpha & 0 \\\\ 0 & -\\beta \\end{pmatrix} \\begin{pmatrix} P_{11} & P_{12} \\\\ P_{12} & P_{22} \\end{pmatrix} + \\begin{pmatrix} P_{11} & P_{12} \\\\ P_{12} & P_{22} \\end{pmatrix} \\begin{pmatrix} \\alpha & 0 \\\\ 0 & -\\beta \\end{pmatrix} = \\begin{pmatrix} 2\\alpha P_{11} & (\\alpha - \\beta) P_{12} \\\\ (\\alpha - \\beta) P_{12} & -2\\beta P_{22} \\end{pmatrix} $$\n$$ P(t) C^T C P(t) = \\begin{pmatrix} P_{11} & P_{12} \\\\ P_{12} & P_{22} \\end{pmatrix} \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} P_{11} & P_{12} \\\\ P_{12} & P_{22} \\end{pmatrix} = \\begin{pmatrix} P_{12}^2 & P_{12}P_{22} \\\\ P_{12}P_{22} & P_{22}^2 \\end{pmatrix} $$\n将这些代入 Riccati 方程，得到关于 $P(t)$ 各分量的常微分方程组 (ODEs)：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\begin{pmatrix} P_{11} & P_{12} \\\\ P_{12} & P_{22} \\end{pmatrix} = \\begin{pmatrix} 2\\alpha P_{11} + q - \\frac{1}{r}P_{12}^2 & (\\alpha - \\beta)P_{12} - \\frac{1}{r}P_{12}P_{22} \\\\ (\\alpha - \\beta)P_{12} - \\frac{1}{r}P_{12}P_{22} & -2\\beta P_{22} - \\frac{1}{r}P_{22}^2 \\end{pmatrix}\n$$\n这得到了三个独特的标量常微分方程：\n1. $\\dot{P}_{11}(t) = 2\\alpha P_{11}(t) + q - \\frac{1}{r} P_{12}(t)^2$\n2. $\\dot{P}_{12}(t) = (\\alpha - \\beta) P_{12}(t) - \\frac{1}{r} P_{12}(t) P_{22}(t) = \\left( \\alpha - \\beta - \\frac{1}{r} P_{22}(t) \\right) P_{12}(t)$\n3. $\\dot{P}_{22}(t) = -2\\beta P_{22}(t) - \\frac{1}{r} P_{22}(t)^2$\n\n初始条件为 $P(0) = \\begin{pmatrix} p_0 & 0 \\\\ 0 & s_0 \\end{pmatrix}$，这意味着 $P_{11}(0) = p_0$，$P_{12}(0) = 0$，以及 $P_{22}(0) = s_0$。\n考虑关于 $P_{12}(t)$ 的常微分方程。这是一个形如 $\\dot{x}(t) = f(t)x(t)$ 的一阶线性齐次方程，初始条件为 $x(0) = 0$。此类初值问题的唯一解是 $x(t) = 0$ 对所有 $t \\ge 0$ 成立。因此，$P_{12}(t) = 0$ 对所有 $t \\ge 0$ 成立。\n\n这通过消除非线性项，极大地简化了 $P_{11}(t)$ 的常微分方程：\n$$ \\dot{P}_{11}(t) = 2\\alpha P_{11}(t) + q $$\n这是一个初始条件为 $P_{11}(0) = p_0$ 的一阶线性非齐次常微分方程。我们可以将其重写为 $\\dot{P}_{11} - 2\\alpha P_{11} = q$。\n我们使用积分因子 $\\mu(t) = \\exp\\left(\\int -2\\alpha \\,\\mathrm{d}t\\right) = \\exp(-2\\alpha t)$ 来求解。\n将该常微分方程乘以 $\\mu(t)$：\n$$ \\exp(-2\\alpha t) \\dot{P}_{11}(t) - 2\\alpha \\exp(-2\\alpha t) P_{11}(t) = q \\exp(-2\\alpha t) $$\n左边是一个乘积的导数：\n$$ \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left( P_{11}(t) \\exp(-2\\alpha t) \\right) = q \\exp(-2\\alpha t) $$\n将两边从 $\\tau=0$ 到 $\\tau=t$ 积分：\n$$ \\int_{0}^{t} \\frac{\\mathrm{d}}{\\mathrm{d}\\tau} \\left( P_{11}(\\tau) \\exp(-2\\alpha \\tau) \\right) \\mathrm{d}\\tau = \\int_{0}^{t} q \\exp(-2\\alpha \\tau) \\mathrm{d}\\tau $$\n$$ P_{11}(t) \\exp(-2\\alpha t) - P_{11}(0) \\exp(0) = q \\left[ \\frac{\\exp(-2\\alpha \\tau)}{-2\\alpha} \\right]_{0}^{t} $$\n代入 $P_{11}(0) = p_0$：\n$$ P_{11}(t) \\exp(-2\\alpha t) - p_0 = q \\left( \\frac{\\exp(-2\\alpha t)}{-2\\alpha} - \\frac{1}{-2\\alpha} \\right) = \\frac{q}{2\\alpha} (1 - \\exp(-2\\alpha t)) $$\n求解 $P_{11}(t)$：\n$$ P_{11}(t) \\exp(-2\\alpha t) = p_0 + \\frac{q}{2\\alpha} - \\frac{q}{2\\alpha}\\exp(-2\\alpha t) $$\n$$ P_{11}(t) = p_0 \\exp(2\\alpha t) + \\frac{q}{2\\alpha} \\exp(2\\alpha t) - \\frac{q}{2\\alpha} $$\n这就是误差协方差矩阵 $(1,1)$ 项的闭式表达式。它可以写为：\n$$ P_{11}(t) = p_0 \\exp(2\\alpha t) + \\frac{q}{2\\alpha} (\\exp(2\\alpha t) - 1) $$\n$P_{11}(t)$ 无界增长的几何直觉在于稳定性和可观测性的概念。状态空间为 $\\mathbb{R}^2$，由标准基向量 $e_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $e_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$ 张成。\n状态动态是解耦的：\n$$ \\mathrm{d}X_1(t) = \\alpha X_1(t) \\mathrm{d}t + \\sqrt{q} \\mathrm{d}W(t) $$\n$$ \\mathrm{d}X_2(t) = -\\beta X_2(t) \\mathrm{d}t $$\n观测为 $\\mathrm{d}Y(t) = X_2(t) \\mathrm{d}t + \\sqrt{r} \\mathrm{d}V(t)$。\n特征向量 $e_1$ 对应于特征值 $\\alpha > 0$，代表一个不稳定模式。特征向量 $e_2$ 对应于特征值 $-\\beta < 0$，代表一个稳定模式。观测矩阵 $C = \\begin{pmatrix} 0 & 1 \\end{pmatrix}$ 的零空间由 $e_1$ 张成。这意味着沿 $X_1$ 轴的不稳定模式是完全不可观测的。\n滤波器只接收关于状态分量 $X_2$ 的测量信息，而没有关于 $X_1$ 的信息。卡尔曼增益为 $K(t) = \\frac{1}{r} P(t) C^T = \\frac{1}{r} \\begin{pmatrix} P_{12}(t) \\\\ P_{22}(t) \\end{pmatrix}$。由于 $P_{12}(t)=0$，增益的第一个分量始终为零。这从数学上证实了滤波器对 $X_1$ 的估计（即 $\\hat{X}_1$）没有从测量中接收到任何校正反馈。\n于是，第一个状态的估计误差 $e_1(t) = X_1(t) - \\hat{X}_1(t)$ 根据其开环动态演化，并由过程噪声驱动：\n$$ \\mathrm{d}e_1(t) = \\alpha e_1(t) \\mathrm{d}t + \\sqrt{q} \\mathrm{d}W(t) $$\n这描述了一个不稳定的过程。该过程的方差 $P_{11}(t) = \\mathbb{E}[e_1(t)^2]$ 必须随时间增长。我们求解的关于 $P_{11}(t)$ 的常微分方程正是这个不稳定误差过程的方差传播方程。由于 $\\alpha > 0$，解中包含项 $\\exp(2\\alpha t)$，导致无界的指数增长。滤波器在不稳定且有噪声的方向上“盲目飞行”，因此其在该方向上的不确定性必须无限增加。这是一个系统不可检测的标志。", "answer": "$$\n\\boxed{p_{0} \\exp(2\\alpha t) + \\frac{q}{2\\alpha} (\\exp(2\\alpha t) - 1)}\n$$", "id": "2996460"}]}