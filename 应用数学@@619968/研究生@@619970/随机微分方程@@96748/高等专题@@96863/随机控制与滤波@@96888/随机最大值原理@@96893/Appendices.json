{"hands_on_practices": [{"introduction": "理解随机最大值原理 (Stochastic Maximum Principle, SMP) 的一个有效方法是探究其与经典的确定性 Pontryagin 最大值原理 (Pontryagin's Maximum Principle, PMP) 之间的联系。本练习将引导你分析一个特殊的线性二次 (LQ) 问题，其中控制项不影响随机动态，从而揭示随机伴随过程 $q_t$ 在何种情况下会消失。通过这个实践，你将巩固对 SMP 结构及其与确定性控制理论渊源的理解。[@problem_id:3003302]", "problem": "考虑在有限时间域 $[0,T]$ 上的一个标量控制系统，由以下随机微分方程给出：\n$$\ndX_t \\;=\\; \\big(a\\,X_t + b\\,u_t\\big)\\,dt \\;+\\; D\\,u_t\\,dW_t,\\qquad X_0 = x_0,\n$$\n其中 $a$、$b$、$D$ 和 $x_0$ 是实常数，$u_t$ 是一个取值于 $\\mathbb{R}$ 的容许控制过程，$W_t$ 是一个标准布朗运动。性能指标为：\n$$\nJ(u) \\;=\\; \\mathbb{E}\\!\\left[\\,\\frac{1}{2}\\,M\\,X_T^2 \\;+\\; \\int_0^T \\frac{1}{2}\\,\\big(Q\\,X_t^2 + R\\,u_t^2\\big)\\,dt \\right],\n$$\n其中 $M>0$、$Q\\ge 0$ 和 $R>0$ 是常数。定义与随机最大值原理 (SMP) 相关的哈密顿量 $H$ 为：\n$$\nH(t,x,u,p,q) \\;=\\; p\\,\\big(a\\,x + b\\,u\\big) \\;+\\; q\\,\\big(D\\,u\\big) \\;-\\; \\frac{1}{2}\\,\\big(Q\\,x^2 + R\\,u^2\\big),\n$$\n其中 $p_t$ 和 $q_t$ 是进入 SMP 的倒向随机微分方程 (BSDE) 中的伴随（协态和鞅）过程。\n\n分析 $D=0$ 的特殊情况，并从 SMP 的变分结构以及 Itô 过程和二次变差的基本性质出发，严格地推导出经典的庞特里亚金最大值原理 (PMP) 结构：一个确定性的伴随常微分方程 (ODE) 和一个对哈密顿量的逐点时间平稳性（最大值）条件。特别地，请识别伴随鞅项 $q_t$ 并解释其作用，然后确定当 $D=0$ 时其显式表达式。\n\n你的最终答案必须是当 $D=0$ 时伴随鞅项 $q_t$ 的显式解析表达式。无需四舍五入。请将你的最终答案表示为单个闭式解析表达式。", "solution": "分析始于回顾给定问题的随机最大值原理 (SMP) 的一般形式。该系统由状态方程\n$$dX_t = f(t, X_t, u_t) dt + \\sigma(t, X_t, u_t) dW_t$$\n和成本泛函\n$$J(u) = \\mathbb{E}\\left[\\Phi(X_T) + \\int_0^T L(t, X_t, u_t) dt\\right]$$\n来描述。对于具体的题目陈述，我们识别出以下组成部分：\n- 漂移项：$f(t,x,u) = a\\,x + b\\,u$\n- 扩散项：$\\sigma(t,x,u) = D\\,u$\n- 终端成本：$\\Phi(x) = \\frac{1}{2}\\,M\\,x^2$\n- 运行成本：$L(t,x,u) = \\frac{1}{2}\\,\\big(Q\\,x^2 + R\\,u^2\\big)$\n\n给定的哈密顿量为 $H(t,x,u,p,q) = p\\,(a\\,x + b\\,u) + q\\,(D\\,u) - \\frac{1}{2}\\,\\big(Q\\,x^2 + R\\,u^2\\big)$，这与标准定义 $H = p f + q \\sigma - L$ 相符。\n\n最优控制 $u_t^*$ 及其对应状态 $X_t^*$ 的必要条件由 SMP 给出。这些条件涉及一对伴随过程，即协态 $p_t$ 和鞅项 $q_t$，它们满足以下倒向随机微分方程 (BSDE)：\n$$-dp_t = H_x(t, X_t^*, u_t^*, p_t, q_t) dt - q_t dW_t, \\qquad p_T = \\Phi_x(X_T^*)$$\n其中 $H_x$ 表示哈密顿量关于状态变量 $x$ 的偏导数。此外，最优控制 $u_t^*$ 必须满足最大值条件：\n$$H(t, X_t^*, u_t^*, p_t, q_t) = \\sup_{v \\in \\mathbb{R}} H(t, X_t^*, v, p_t, q_t)$$\n对于我们的具体问题，哈密顿量关于 $x$ 的偏导数为：\n$$H_x = \\frac{\\partial}{\\partial x} \\left[ p(ax+bu) + q(Du) - \\frac{1}{2}(Qx^2+Ru^2) \\right] = a\\,p_t - Q\\,X_t^*$$\n$p_t$ 的终端条件是：\n$$p_T = \\frac{\\partial}{\\partial x} \\left( \\frac{1}{2} M x^2 \\right) \\bigg|_{x=X_T^*} = M\\,X_T^*$$\n因此，伴随 BSDE 为：\n$$-dp_t = (a\\,p_t - Q\\,X_t^*) dt - q_t dW_t$$\n或等价地，其前向形式为：\n$$dp_t = (Q\\,X_t^* - a\\,p_t) dt + q_t dW_t$$\n由于控制集为 $\\mathbb{R}$ 且哈密顿量在 $u$ 上是严格凹的（因为 $R>0$），最大值条件等价于一阶平稳性条件 $H_u = 0$：\n$$H_u = \\frac{\\partial}{\\partial u} \\left[ p(ax+bu) + q(Du) - \\frac{1}{2}(Qx^2+Ru^2) \\right] = b\\,p_t + D\\,q_t - R\\,u_t = 0$$\n这给出了用伴随过程表示的最优控制：\n$$u_t^* = \\frac{1}{R}(b\\,p_t + D\\,q_t)$$\n\n现在，我们分析 $D=0$ 的特殊情况。\n在这种情况下，系统动力学变为：\n$$dX_t = (a\\,X_t + b\\,u_t)\\,dt, \\qquad X_0 = x_0$$\n对于任何给定的控制函数 $u(t)$，这是一个确定性常微分方程 (ODE)。布朗运动 $W_t$ 不再驱动状态动力学。成本泛函保持不变：\n$$J(u) = \\mathbb{E}\\!\\left[\\,\\frac{1}{2}\\,M\\,X_T^2 \\;+\\; \\int_0^T \\frac{1}{2}\\,\\big(Q\\,X_t^2 + R\\,u_t^2\\big)\\,dt \\right]$$\n问题是在容许控制类中找到最优控制 $u_t$，这些容许控制是适应于由 $W_t$ 生成的滤子流 $\\mathcal{F}_t$ 的过程。\n\n关键步骤是证明最优控制 $u_t^*$ 必须是确定性的。令 $u_t$ 为任意容许的适应控制。我们可以将其分解为其确定性均值和一个零均值的随机部分：\n$$u_t = \\bar{u}_t + \\tilde{u}_t, \\quad \\text{其中} \\quad \\bar{u}_t = \\mathbb{E}[u_t] \\quad \\text{且} \\quad \\mathbb{E}[\\tilde{u}_t] = 0$$\n由于状态方程的线性性质，$X_t$ 可以类似地分解为 $X_t = \\bar{X}_t + \\tilde{X}_t$，其中：\n$$\\frac{d\\bar{X}_t}{dt} = a\\,\\bar{X}_t + b\\,\\bar{u}_t, \\quad \\bar{X}_0 = x_0$$\n$$\\frac{d\\tilde{X}_t}{dt} = a\\,\\tilde{X}_t + b\\,\\tilde{u}_t, \\quad \\tilde{X}_0 = 0$$\n由于 $\\bar{X}_t$ 和 $\\bar{u}_t$ 是确定性的，并且 $\\mathbb{E}[\\tilde{X}_t] = \\mathbb{E}[\\int_0^t e^{a(t-s)}b\\,\\tilde{u}_s ds] = \\int_0^t e^{a(t-s)}b\\,\\mathbb{E}[\\tilde{u}_s] ds = 0$。\n\n让我们展开成本泛函：\n$$J(u) = \\frac{1}{2} \\mathbb{E} \\left[ M(\\bar{X}_T + \\tilde{X}_T)^2 + \\int_0^T \\left( Q(\\bar{X}_t + \\tilde{X}_t)^2 + R(\\bar{u}_t + \\tilde{u}_t)^2 \\right) dt \\right]$$\n展开二次项并利用期望的线性性质：\n$$J(u) = \\frac{1}{2} \\left( M\\bar{X}_T^2 + \\int_0^T (Q\\bar{X}_t^2 + R\\bar{u}_t^2) dt \\right) + \\frac{1}{2} \\mathbb{E}\\left[ M\\tilde{X}_T^2 + \\int_0^T (Q\\tilde{X}_t^2 + R\\tilde{u}_t^2) dt \\right]$$\n所有交叉项都消失了，例如，因为 $\\mathbb{E}[\\bar{X}_t \\tilde{X}_t] = \\bar{X}_t \\mathbb{E}[\\tilde{X}_t] = 0$。第一项正是确定性控制 $\\bar{u}_t$ 的成本泛函，即 $J(\\bar{u})$。由于 $M>0$，$Q\\ge 0$ 和 $R>0$，第二项是一个非负量。\n$$J(u) = J(\\bar{u}) + \\frac{1}{2} \\mathbb{E}\\left[ M\\tilde{X}_T^2 + \\int_0^T (Q\\tilde{X}_t^2 + R\\tilde{u}_t^2) dt \\right]$$\n这个不等式表明 $J(u) \\ge J(\\bar{u})$。当且仅当第二项为零时，才能达到最小值。由于 $R>0$，这要求 $\\mathbb{E}[\\int_0^T R\\tilde{u}_t^2 dt] = 0$，这意味着对于几乎所有的 $t \\in [0,T]$，几乎必然有 $\\tilde{u}_t = 0$。因此，任何最优控制 $u_t^*$ 都必须是确定性的。\n\n现在我们回到 $D=0$ 情况下的 SMP 结果。最优控制由下式给出：\n$$u_t^* = \\frac{1}{R}(b\\,p_t + (0)\\,q_t) = \\frac{b}{R}p_t$$\n由于我们已经严格证明了 $u_t^*$ 必须是时间的确定性函数，并且 $b$ 和 $R$ 是常数，因此伴随过程 $p_t$ 也必须是时间的确定性函数。\n\n过程 $p_t$ 是以下 BSDE 的解：\n$$dp_t = (Q\\,X_t^* - a\\,p_t) dt + q_t dW_t, \\qquad p_T = M\\,X_T^*$$\n一个 Itô 过程是确定性的，当且仅当其随机积分部分恒等于零。一个确定性的、可微的函数 $p(t)$ 的随机微分就是 $dp(t) = \\frac{dp}{dt} dt$。要使 Itô 过程 $p_t$ 是确定性的，其扩散系数必须为零。$dp_t$ 的扩散部分是 $q_t dW_t$。为了使该项为零，系数过程 $q_t$ 对于几乎所有的 $t \\in [0,T]$ 必须几乎必然为零。\n\n因此，我们必须有 $q_t = 0$。\n\n在一般 SMP 中，伴随鞅项 $q_t$ 的作用是模拟不确定性在伴随系统中的传播效应。它捕捉了“影子价格”$p_t$ 必须如何响应影响状态系统的相同随机冲击而进行调整。当状态系统的演化变得与随机冲击无关时（即 $D=0$），伴随过程不再有任何随机信息需要反应，其鞅分量 $q_t$ 必须消失。\n\n当 $q_t=0$ 时，SMP 系统简化为：\n1. 状态 ODE: $\\frac{dX_t}{dt} = a\\,X_t + b\\,u_t$\n2. 伴随 ODE: $\\frac{dp_t}{dt} = Q\\,X_t - a\\,p_t$\n3. 横截性条件: $p_T = M\\,X_T$\n4. 最优性条件: $u_t = \\frac{b}{R} p_t$\n\n这正是在相应的确定性线性二次最优控制问题中构成庞特里亚金最大值原理 (PMP) 的必要条件集合。该分析表明，当从系统动力学中移除随机元素时，更通用的 SMP 如何优雅地退化为经典的 PMP。在这种情况下，伴随鞅项 $q_t$ 的显式表达式为零。", "answer": "$$\\boxed{0}$$", "id": "3003302"}, {"introduction": "随机最大值原理提供的是最优控制的“必要条件”，而非“充分条件”，理解这一点至关重要。本练习通过一个具有非凹哈密顿量的简单例子，向你展示了满足一阶平稳性条件的控制不一定是最优解。这个实践旨在培养你对最优性条件的批判性思维，并强调在应用 SMP 时检验高阶条件或全局属性的重要性。[@problem_id:3003286]", "problem": "考虑以下固定时间域 $T>0$ 上的随机控制问题。设 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\in[0,T]},\\mathbb{P})$ 承载一个一维标准布朗运动 $W=(W_t)_{t\\in[0,T]}$。标量状态 $X=(X_t)_{t\\in[0,T]}$ 的演化遵循以下随机微分方程\n$$\ndX_t \\;=\\; u_t\\,dt \\;+\\; \\sigma\\,dW_t,\\qquad X_0=x_0,\n$$\n其中 $\\sigma\\in\\mathbb{R}$，控制 $u=(u_t)_{t\\in[0,T]}$ 是关于 $(\\mathcal{F}_t)_{t\\in[0,T]}$ 循序可测的，并满足 $\\mathbb{E}\\!\\left[\\int_0^T |u_t|^2\\,dt\\right]<\\infty$。目标是最小化代价泛函\n$\nJ(u)\\;=\\;\\mathbb{E}\\!\\left[\\int_0^T \\ell(u_t)\\,dt\\right],\n$\n其中运行代价为\n$\n\\ell(u)\\;=\\;(u^2-1)^2,\n$\n且没有终端代价。\n\n仅使用随机微分方程的基本定义和由随机最大值原理 (SMP) 给出的一阶必要条件，完成以下任务：\n\n1) 推导哈密顿量、伴随反向随机微分方程，以及刻画此问题中最优控制必要候选者的一阶平稳性条件。不要假设任何凹性或凸性。\n\n2) 找出一个满足平稳性条件但不是 $J(u)$ 的全局最小化子的时不变容许控制 $u^{\\mathrm{stat}}$。\n\n3) 给出一个时不变容许控制 $u^{\\mathrm{opt}}$，其代价严格优于 $u^{\\mathrm{stat}}$。\n\n4) 计算代价差距 $J(u^{\\mathrm{stat}})-J(u^{\\mathrm{opt}})$ 作为 $T$ 的函数的精确解析值。\n\n将您的最终答案表示为仅含 $T$ 的精确解析表达式。无需四舍五入，也不涉及物理单位。", "solution": "首先根据所需准则对问题陈述进行验证。\n\n### 步骤 1: 提取已知条件\n- 时间域: $T>0$。\n- 概率空间: $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\in[0,T]},\\mathbb{P})$。\n- 布朗运动: 一维标准布朗运动 $W=(W_t)_{t\\in[0,T]}$。\n- 状态过程: $X=(X_t)_{t\\in[0,T]}$。\n- 状态 SDE: $dX_t = u_t\\,dt + \\sigma\\,dW_t$。\n- 初始条件: $X_0=x_0$。\n- 参数: $\\sigma\\in\\mathbb{R}$ 是一个常数。\n- 控制过程: $u=(u_t)_{t\\in[0,T]}$ 是关于 $(\\mathcal{F}_t)_{t\\in[0,T]}$ 循序可测的。\n- 容许性条件: $\\mathbb{E}\\!\\left[\\int_0^T |u_t|^2\\,dt\\right]<\\infty$。\n- 待最小化的代价泛函: $J(u) = \\mathbb{E}\\!\\left[\\int_0^T \\ell(u_t)\\,dt\\right]$。\n- 运行代价函数: $\\ell(u) = (u^2-1)^2$。\n- 终端代价: 零。\n\n### 步骤 2: 使用提取的已知条件进行验证\n- **科学依据充分:** 该问题是随机最优控制理论中的一个标准表述。它涉及状态的线性随机微分方程和代价泛函，这是数学及其在工程和金融领域应用的核心课题。对于这类问题，使用随机最大值原理 (SMP) 是恰当的。\n- **适定的:** 该问题是适定的。动力学、控制约束和目标函数都有明确定义。问题要求基于必要条件进行分析，而不是对最优控制的存在性和唯一性进行完整证明，鉴于运行代价 $\\ell(u)$ 的非凸性，这是恰当的。\n- **客观的:** 问题陈述使用了精确、客观的数学语言，没有歧义或主观论断。\n\n### 步骤 3: 结论与行动\n该问题是有效的，因为它科学依据充分、适定且客观。没有矛盾、信息缺失或违反科学原理之处。由于运行代价非凸，该问题是随机最大值原理的一个非平凡应用。我将继续进行解答。\n\n---\n\n按照问题陈述的要求，解答分为四个部分。\n\n### 1) 哈密顿量、伴随方程和平稳性条件\n\n随机控制问题由状态动力学 $dX_t = b(X_t, u_t)\\,dt + \\sigma(X_t, u_t)\\,dW_t$ 和代价 $J(u) = \\mathbb{E}[\\int_0^T \\ell(X_t, u_t)\\,dt + g(X_T)]$ 定义。在这个具体问题中，我们有：\n- 漂移项: $b(x,u) = u$。\n- 扩散项: $\\sigma(x,u) = \\sigma$。\n- 运行代价: $\\ell(x,u) = (u^2-1)^2$。\n- 终端代价: $g(x) = 0$。\n注意函数 $b$、$\\sigma$ 和 $\\ell$ 均不依赖于状态 $x$。\n\n**哈密顿量:**\n哈密顿量 $H$ 定义为 $H(x, u, p, q) = p \\cdot b(x,u) + q \\cdot \\sigma(x,u) - \\ell(x,u)$。代入给定的函数，我们得到：\n$$\nH(x, u, p, q) = p u + q \\sigma - (u^2-1)^2\n$$\n由于这些函数不依赖于 $x$，哈密顿量也与 $x$ 无关。\n\n**伴随反向随机微分方程 (BSDE):**\n伴随过程，即标量过程 $p=(p_t)_{t\\in[0,T]}$ 和标量过程 $q=(q_t)_{t\\in[0,T]}$，由以下 BSDE 的解给出：\n$$\ndp_t = -\\frac{\\partial H}{\\partial x}(X_t, u_t, p_t, q_t)\\,dt + q_t\\,dW_t\n$$\n其终端条件为：\n$$\np_T = \\frac{\\partial g}{\\partial x}(X_T)\n$$\n我们计算偏导数：\n$$\n\\frac{\\partial H}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ p u + q \\sigma - (u^2-1)^2 \\right] = 0\n$$\n$$\n\\frac{\\partial g}{\\partial x} = \\frac{\\partial}{\\partial x} [0] = 0\n$$\n伴随 BSDE 简化为：\n$$\ndp_t = 0 \\cdot dt + q_t\\,dW_t = q_t\\,dW_t, \\quad p_T = 0\n$$\n该 BSDE 的唯一解是对于所有 $t \\in [0,T]$ 都有 $(p_t, q_t) = (0, 0)$。这可以通过从 $t$ 到 $T$ 积分看出：$p_T - p_t = \\int_t^T q_s dW_s$。由于 $p_T=0$，我们有 $p_t = -\\int_t^T q_s dW_s$。过程 $p_t$ 是一个鞅，且 $p_T=0$，这意味着 $p_t = \\mathbb{E}[p_T | \\mathcal{F}_t] = 0$。从 $dp_t=0$ 可得 $q_t dW_t=0$，这意味着对于几乎所有的 $t$，$q_t=0$。\n\n**一阶平稳性条件:**\n随机最大值原理提供了一组最优性的必要条件。一阶平稳性条件指出，对于一个最优控制 $u^*_t$，只要控制集是开集，哈密顿量关于控制变量的导数必须为零。\n$$\n\\frac{\\partial H}{\\partial u}(X_t, u_t, p_t, q_t) = 0\n$$\n我们计算哈密顿量的偏导数：\n$$\n\\frac{\\partial H}{\\partial u} = \\frac{\\partial}{\\partial u} \\left[ p_t u_t + q_t \\sigma - (u_t^2-1)^2 \\right] = p_t - 2(u_t^2-1)(2u_t) = p_t - 4u_t(u_t^2-1)\n$$\n由于我们发现对于所有 $t$ 都有 $p_t=0$，平稳性条件变为：\n$$\n-4u_t(u_t^2-1) = 0\n$$\n该方程给出了在任何时刻 $t$ 的平稳控制的可能取值：\n$$\nu_t(u_t^2-1) = 0 \\implies u_t \\in \\{0, 1, -1\\}\n$$\n因此，对于几乎所有的 $t \\in [0,T]$，任何最优控制都必须在集合 $\\{0, 1, -1\\}$ 中取值。\n\n### 2) 一个非最优的平稳控制 $u^{\\mathrm{stat}}$\n\n问题要求找出一个满足平稳性条件但不是全局最小化子的时不变控制 $u^{\\mathrm{stat}}$。根据平稳性条件，时不变的候选控制是 $u(t) \\equiv 0$、$u(t) \\equiv 1$ 和 $u(t) \\equiv -1$。这三个都是容许的，因为对于任何常数 $c$，$\\mathbb{E}[\\int_0^T |c|^2 dt] = c^2T < \\infty$。\n\n我们来为这些常数控制中的每一个计算代价 $J(u)$。对于一个常数控制 $u_t=c$，代价为：\n$$\nJ(c) = \\mathbb{E}\\left[\\int_0^T (c^2-1)^2 dt\\right] = (c^2-1)^2 \\int_0^T dt = T(c^2-1)^2\n$$\n- 对于 $c=0$: $J(0) = T(0^2-1)^2 = T$。\n- 对于 $c=1$: $J(1) = T(1^2-1)^2 = 0$。\n- 对于 $c=-1$: $J(-1) = T((-1)^2-1)^2 = 0$。\n\n代价泛函总是非负的，即 $J(u) = \\mathbb{E}[\\int_0^T (u_t^2-1)^2 dt] \\ge 0$。可能的最小代价是 $0$。\n控制 $u_t=1$ 和 $u_t=-1$ 达到了这个最小代价，因此它们是全局最小化子。\n控制 $u_t=0$ 产生的代价为 $J(0)=T > 0$。因此，它满足平稳性条件但不是全局最小化子。\n我们确定 $u^{\\mathrm{stat}}$ 为：\n$$\nu^{\\mathrm{stat}}(t) = 0 \\quad \\text{for all } t \\in [0,T]\n$$\n\n### 3) 一个优于 $u^{\\mathrm{stat}}$ 的最优控制 $u^{\\mathrm{opt}}$\n\n我们需要给出一个时不变控制 $u^{\\mathrm{opt}}$，其代价严格优于 $u^{\\mathrm{stat}}$。根据上面的计算，$u_t=1$ 和 $u_t=-1$ 都得到代价 $0$，这严格小于 $u^{\\mathrm{stat}}$ 的代价 $T$。我们可以选择其中任意一个。我们选择：\n$$\nu^{\\mathrm{opt}}(t) = 1 \\quad \\text{for all } t \\in [0,T]\n$$\n此控制的代价是 $J(u^{\\mathrm{opt}}) = J(1) = 0$。$u^{\\mathrm{stat}}$ 的代价是 $J(u^{\\mathrm{stat}}) = J(0) = T$。由于 $T>0$，我们有 $J(u^{\\mathrm{opt}}) < J(u^{\\mathrm{stat}})$，因此改进是严格的。\n\n### 4) 代价差距 $J(u^{\\mathrm{stat}})-J(u^{\\mathrm{opt}})$\n\n我们计算代价差距作为 $T$ 的函数的精确值。\n$$\nJ(u^{\\mathrm{stat}}) = J(0) = T(0^2-1)^2 = T\n$$\n$$\nJ(u^{\\mathrm{opt}}) = J(1) = T(1^2-1)^2 = 0\n$$\n因此，代价差距为：\n$$\nJ(u^{\\mathrm{stat}}) - J(u^{\\mathrm{opt}}) = T - 0 = T\n$$\n最终结果仅取决于时间域 $T$。", "answer": "$$ \\boxed{T} $$", "id": "3003286"}, {"introduction": "在某些控制问题中，尤其是在哈密顿量对控制呈线性关系时，一阶必要条件可能完全失效，这类情况被称为“奇异控制”。本练习探讨的正是这样一个奇异情形，其中一阶 SMP 无法判断一个候选控制是否最优。你将通过执行二阶变分分析，直接计算成本函数的变化，从而学习如何使用更高阶的条件来排除非最优的奇异控制。[@problem_id:3003273]", "problem": "考虑在时间区间 $[0,1]$ 上，由一个标准布朗运动 $W$ 驱动的一维受控随机微分方程，\n$$\ndx_t \\;=\\; u_t\\,dt \\;+\\; \\nu\\,u_t\\,dW_t,\\qquad x_0 \\;=\\; 0,\n$$\n其中 $\\nu\\in\\mathbb{R}$ 是一个给定常数，控制 $u$ 是循序可测的，并且其取值在一个固定的紧区间 $U=[-\\bar{u},\\bar{u}]$ 内，其中 $\\bar{u}>0$。需要最大化的性能泛函是\n$$\nJ(u) \\;=\\; \\mathbb{E}\\!\\left[\\tfrac{1}{2}\\,x_1^2\\right].\n$$\n在随机最大值原理 (SMP) 及其二阶扩展的框架内进行研究。从核心定义开始：对于运行成本为零的控制仿射系统，其哈密顿量 $H(x,u,p,q)$，以及终端条件由终端成本的梯度给出的一阶伴随反向随机微分方程。证明一阶 SMP 对于候选控制 $u_t\\equiv 0$ 是不确定的，即哈密顿量关于 $u$ 的平稳性条件和勒让德 (Legendre) 条件没有提供区分最优性的信息。\n\n然后，在奇异候选控制 $u_t\\equiv 0$ 周围分析一个小的控制扰动 $u^{\\varepsilon}_t=\\varepsilon\\,v_t$，其中 $v_t$ 是一个确定性方向，$\\varepsilon$ 是一个小的标量，满足 $0<|\\varepsilon|\\leq \\varepsilon_0$，其中 $\\varepsilon_0>0$ 足够小以使 $u^{\\varepsilon}$ 保持在 $U$ 内。对于在 $[0,1]$ 上的特定选择 $v_t\\equiv 1$，推导由关系式定义的二阶变分系数 $Q(\\nu)$：\n$$\nJ(u^{\\varepsilon}) - J(0) \\;=\\; \\varepsilon^2\\,Q(\\nu) \\;+\\; o(\\varepsilon^2)\\quad\\text{as }\\varepsilon\\to 0,\n$$\n推导过程仅使用诸如 Itô 等距定理和随机积分的基本性质等已经充分检验过的事实。你的推导必须从受控动态系统开始，构建 $u^{\\varepsilon}$ 下的 $x_1$，并精确计算 $J(u^{\\varepsilon})$ 中的期望。用文字说明，对于一个最大化问题，$Q(\\nu)$ 的符号如何通过二阶条件排除非最优的奇异控制 $u\\equiv 0$。将 $Q(\\nu)$ 的最终答案表示为关于 $\\nu$ 的闭式解析表达式。不需要四舍五入，也不涉及单位。", "solution": "该问题需经过验证。\n\n### 步骤 1：提取已知条件\n- **状态动态方程**：$dx_t = u_t\\,dt + \\nu\\,u_t\\,dW_t$，其中 $W_t$ 是一个标准的一维布朗运动。\n- **初始条件**：$x_0 = 0$。\n- **时间范围**：$t \\in [0, 1]$。\n- **常数参数**：$\\nu \\in \\mathbb{R}$。\n- **控制集**：控制 $u$ 是一个循序可测过程，其值在紧区间 $U = [-\\bar{u}, \\bar{u}]$ 内，其中 $\\bar{u} > 0$。\n- **性能泛函**：最大化 $J(u) = \\mathbb{E}[\\frac{1}{2} x_1^2]$。\n- **任务**：\n    1. 证明一阶随机最大值原理 (SMP) 对候选控制 $u_t \\equiv 0$ 是不确定的。\n    2. 对于 $u_t \\equiv 0$ 周围的扰动 $u_t^{\\varepsilon} = \\varepsilon v_t$（其中 $v_t \\equiv 1$），推导由 $J(u^{\\varepsilon}) - J(0) = \\varepsilon^2\\,Q(\\nu) + o(\\varepsilon^2)$ 定义的二阶变分系数 $Q(\\nu)$。\n    3. 基于 $Q(\\nu)$ 的符号得出结论。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在随机最优控制的数学理论框架内是良定义的。它探讨了奇异控制这一重要情况，在此情况下，一阶最优性条件不足以得出结论，需要进行二阶分析。\n\n- **科学依据**：该问题基于随机微分方程 (SDE) 和随机最大值原理的既定框架，后者是随机控制理论的基石。\n- **适定性**：问题陈述清晰，提供了执行所需分析的所有必要信息（动态方程、成本、约束）。目标是推导一个特定的、良定义的系数 $Q(\\nu)$。\n- **客观性**：该问题使用精确、形式化的数学语言，不含任何主观或基于观点的内容。\n- **完备性与一致性**：问题设定是自洽且内部一致的。\n- **非平凡性**：该问题并非平凡，因为它涉及奇异控制弧，这是一种非标准情况，其中二阶条件变得至关重要。\n\n有效问题的所有标准均已满足。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n***\n\n解答按照问题陈述的要求分三部分进行。\n\n首先，我们使用一阶随机最大值原理 (SMP) 来分析候选控制 $u_t \\equiv 0$。该系统是控制仿射的，其动态方程为 $dx_t = b(u_t) dt + \\sigma(u_t) dW_t$，其中 $b(u) = u$ 和 $\\sigma(u) = \\nu u$。运行成本为 $L(x,u) = 0$，终端成本为 $\\Phi(x) = \\frac{1}{2}x^2$。\n\n该系统的哈密顿量定义为：\n$$\nH(x, u, p, q) = p\\,b(u) + q\\,\\sigma(u) - L(x,u) = p u + q (\\nu u) = (p + \\nu q) u\n$$\n伴随过程 $(p_t, q_t)$ 满足反向随机微分方程 (BSDE)：\n$$\ndp_t = -\\frac{\\partial H}{\\partial x}(x_t, u_t, p_t, q_t) dt + q_t dW_t, \\quad p_1 = \\frac{d\\Phi}{dx}(x_1)\n$$\n由于哈密顿量 $H$ 不依赖于状态 $x$，我们有 $\\frac{\\partial H}{\\partial x} = 0$。终端条件为 $p_1 = \\frac{d}{dx}(\\frac{1}{2}x^2)\\big|_{x=x_1} = x_1$。\n因此，伴随 BSDE 为 $dp_t = q_t dW_t$，其终端条件为 $p_1 = x_1$。\n\n让我们针对奇异候选控制 $u_t \\equiv 0$ 来评估。对于 $u_t = 0$，状态动态方程变为 $dx_t = 0$，且 $x_0 = 0$。这给出了确定性状态轨迹 $x_t \\equiv 0$（对所有 $t \\in [0, 1]$）。因此，终端状态为 $x_1 = 0$。\n伴随过程 $p_t$ 的终端条件变为 $p_1 = x_1 = 0$。BSDE $dp_t = q_t dW_t$ 满足 $p_1 = 0$ 的唯一解是 $p_t \\equiv 0$ 和 $q_t \\equiv 0$（对所有 $t \\in [0, 1]$）。\n\nSMP 的一阶必要条件（Pontryagin 原理）指出，最优控制 $u^*_t$ 必须对几乎所有的 $t \\in [0, 1]$ 满足：\n$$\nH(x^*_t, u^*_t, p_t, q_t) = \\max_{v \\in U} H(x^*_t, v, p_t, q_t)\n$$\n对于我们的候选控制 $u_t \\equiv 0$，我们有 $p_t = 0$ 和 $q_t = 0$。哈密顿量变为 $H(x_t, u, p_t, q_t) = (0 + \\nu \\cdot 0) u = 0$，对任何 $u \\in U$ 的值均成立。最优性条件简化为 $0 = \\max_{v \\in [-\\bar{u}, \\bar{u}]} 0$，这是一个同义反复。它没有提供任何信息来确定最优控制，因为任何 $v \\in U$ 都是最大化者。平稳性条件 $\\frac{\\partial H}{\\partial u} = p_t + \\nu q_t = 0$ 被满足，二阶导数（Legendre-Clebsch）条件 $\\frac{\\partial^2 H}{\\partial u^2} = 0$ 也是无信息的。因此，一阶 SMP 是不确定的。\n\n接下来，我们进行二阶分析。我们考虑在奇异控制 $u_t \\equiv 0$ 周围的指定控制扰动。扰动后的控制是 $u_t^\\varepsilon = \\varepsilon v_t$，其中 $v_t \\equiv 1$，所以 $u_t^\\varepsilon = \\varepsilon$（对 $t \\in [0, 1]$）。我们假设 $\\varepsilon$ 足够小，使得 $\\varepsilon \\in [-\\bar{u}, \\bar{u}]$。\n\n在 $u^\\varepsilon$ 下的状态 SDE 是：\n$$\ndx_t^\\varepsilon = \\varepsilon dt + \\nu \\varepsilon dW_t, \\quad x_0^\\varepsilon = 0\n$$\n这是一个线性 SDE，可以通过直接积分求解：\n$$\nx_t^\\varepsilon = \\int_0^t \\varepsilon ds + \\int_0^t \\nu \\varepsilon dW_s = \\varepsilon t + \\nu \\varepsilon W_t\n$$\n在终端时刻 $t=1$，状态为：\n$$\nx_1^\\varepsilon = \\varepsilon (1) + \\nu \\varepsilon W_1 = \\varepsilon (1 + \\nu W_1)\n$$\n这个扰动控制的性能泛函是：\n$$\nJ(u^\\varepsilon) = \\mathbb{E}\\left[\\frac{1}{2} (x_1^\\varepsilon)^2\\right] = \\mathbb{E}\\left[\\frac{1}{2} \\left(\\varepsilon (1 + \\nu W_1)\\right)^2\\right] = \\frac{1}{2}\\varepsilon^2 \\mathbb{E}\\left[(1 + \\nu W_1)^2\\right]\n$$\n我们展开期望内的项：\n$$\n\\mathbb{E}\\left[(1 + \\nu W_1)^2\\right] = \\mathbb{E}\\left[1 + 2\\nu W_1 + \\nu^2 W_1^2\\right]\n$$\n利用期望的线性性质，我们得到：\n$$\n\\mathbb{E}\\left[1\\right] + 2\\nu \\mathbb{E}\\left[W_1\\right] + \\nu^2 \\mathbb{E}\\left[W_1^2\\right]\n$$\n对于一个标准布朗运动 $W_t$，我们有基本性质 $\\mathbb{E}[W_t] = 0$ 和 $\\text{Var}(W_t) = \\mathbb{E}[W_t^2] - (\\mathbb{E}[W_t])^2 = t$。对于 $t=1$，这给出 $\\mathbb{E}[W_1] = 0$ 和 $\\mathbb{E}[W_1^2] = 1$。代入这些值：\n$$\n\\mathbb{E}\\left[(1 + \\nu W_1)^2\\right] = 1 + 2\\nu(0) + \\nu^2(1) = 1 + \\nu^2\n$$\n回到 $J(u^\\varepsilon)$ 的表达式，我们发现：\n$$\nJ(u^\\varepsilon) = \\frac{1}{2}\\varepsilon^2 (1 + \\nu^2)\n$$\n对应于奇异控制 $u_t \\equiv 0$ 的成本是 $J(0) = \\mathbb{E}[\\frac{1}{2} (0)^2] = 0$。\n因此，成本泛函的变分为：\n$$\nJ(u^\\varepsilon) - J(0) = \\frac{1}{2}\\varepsilon^2 (1 + \\nu^2) - 0 = \\frac{1}{2}\\varepsilon^2 (1 + \\nu^2)\n$$\n问题通过展开式 $J(u^\\varepsilon) - J(0) = \\varepsilon^2 Q(\\nu) + o(\\varepsilon^2)$ 定义了二阶变分系数 $Q(\\nu)$。将我们的精确表达式与此定义进行比较，我们确定：\n$$\nQ(\\nu) = \\frac{1}{2}(1 + \\nu^2)\n$$\n在 $\\varepsilon$ 中没有更高阶的项，所以 $o(\\varepsilon^2)$ 项为零。\n\n最后，我们使用 $Q(\\nu)$ 的符号来得出关于 $u_t \\equiv 0$ 最优性的结论。这是一个最大化问题。$u_t \\equiv 0$ 成为局部最大值的一个必要条件是，对于任何容许的扰动，相应的成本变分必须是非正的，即对于所有足够小的 $\\varepsilon$，$J(u^\\varepsilon) - J(0) \\le 0$。对于给定类型的扰动，这转化为二阶必要条件 $Q(\\nu) \\le 0$。\n然而，我们发现 $Q(\\nu) = \\frac{1}{2}(1 + \\nu^2)$。由于 $\\nu \\in \\mathbb{R}$，$\\nu^2 \\ge 0$，这意味着 $1 + \\nu^2 \\ge 1$。因此，对于参数 $\\nu$ 的任何值：\n$$\nQ(\\nu) = \\frac{1}{2}(1 + \\nu^2) \\ge \\frac{1}{2} > 0\n$$\n由于 $Q(\\nu)$ 是严格为正的，对于任何 $\\varepsilon \\neq 0$，变分 $J(u^\\varepsilon) - J(0) = \\varepsilon^2 Q(\\nu)$ 是严格为正的。这意味着任何偏离零的微小常数扰动都会严格增加成本泛函的值。因此，奇异控制 $u_t \\equiv 0$ 不是一个最大化者。$Q(\\nu)$ 的符号为正，明确地排除了 $u_t \\equiv 0$ 作为最优控制的候选者；事实上，它揭示了相对于此类扰动，它是一个严格的局部最小值。", "answer": "$$\\boxed{\\frac{1}{2}(1+\\nu^2)}$$", "id": "3003273"}]}