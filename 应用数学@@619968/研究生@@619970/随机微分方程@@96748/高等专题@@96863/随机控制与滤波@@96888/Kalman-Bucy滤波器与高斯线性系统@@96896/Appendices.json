{"hands_on_practices": [{"introduction": "要真正掌握卡尔曼-布西滤波器，我们必须超越公式的简单应用，从第一性原理理解其推导过程。本练习将引导你从系统动力学出发，应用伊藤积分 ($Itô$ calculus)，通过最小化均方误差来推导稳态滤波器增益 [@problem_id:2713808]。通过完成这一基础性的推导，你将深刻体会到为什么代数黎卡提方程 (algebraic Riccati equation) 和新息过程 (innovation process) 是实现最优状态估计的核心。", "problem": "考虑由高斯白噪声驱动的连续时间多输入多输出 (MIMO) 线性随机系统\n$$\n\\mathrm{d}x(t) = A\\,x(t)\\,\\mathrm{d}t + G\\,\\mathrm{d}w(t), \\qquad \\mathrm{d}y(t) = C\\,x(t)\\,\\mathrm{d}t + \\mathrm{d}v(t),\n$$\n其中 $x(t) \\in \\mathbb{R}^{2}$ 是状态，$y(t) \\in \\mathbb{R}^{2}$ 是测量值，$A \\in \\mathbb{R}^{2 \\times 2}$，$G \\in \\mathbb{R}^{2 \\times 2}$，$C \\in \\mathbb{R}^{2 \\times 2}$。过程 $w(t)$ 和 $v(t)$ 是独立的标准维纳过程，其增量协方差为 $\\mathbb{E}[\\mathrm{d}w(t)\\,\\mathrm{d}w(t)^{\\top}] = Q\\,\\mathrm{d}t$ 和 $\\mathbb{E}[\\mathrm{d}v(t)\\,\\mathrm{d}v(t)^{\\top}] = R\\,\\mathrm{d}t$，其中 $Q \\in \\mathbb{R}^{2 \\times 2}$ 和 $R \\in \\mathbb{R}^{2 \\times 2}$ 是常数、对称、正定矩阵。假设数据如下：\n$$\nA = \\begin{pmatrix} 1 & 0 \\\\ 0 & -2 \\end{pmatrix}, \\quad G = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\quad Q = \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\quad R = \\begin{pmatrix} 1 & 0 \\\\ 0 & 3 \\end{pmatrix}.\n$$\n从线性高斯状态估计和估计误差协方差的定义出发，并且不直接调用已有的滤波器或 Riccati 公式，执行以下操作：\n\n- 首先推导稳态估计误差协方差满足的代数方程，然后确定最小化稳态均方误差 (MSE) 的最优增益，从而推导出连续时间 Kalman-Bucy (KB) 滤波器的稳态增益。根据 Itô 微分和正交性原理的基本原理，清晰地论证每一步。\n- 使用您的推导，计算给定 $A$、$G$、$C$、$Q$ 和 $R$ 的稳态卡尔曼增益。\n- 定义与此 MIMO 系统的 KB 滤波器相关的新息过程，并利用推导出的结果解释其在稳态下的作用和统计特性。\n\n以精确的闭合形式（无小数近似）提供最终的卡尔曼增益矩阵。不要四舍五入。最终答案必须仅为卡尔曼增益，表示为单个矩阵。", "solution": "该问题要求从基本原理出发，推导稳态 Kalman-Bucy 滤波器增益，对给定系统进行计算，并分析相关的新息过程。此推导的基础是高斯噪声存在下的最优线性估计原理，遵循 Itô 微分和正交性原理。\n\n我们首先假设一个形如下式的状态 $x(t)$ 的线性估计器：\n$$\n\\mathrm{d}\\hat{x}(t) = A\\,\\hat{x}(t)\\,\\mathrm{d}t + K(t)\\,(\\mathrm{d}y(t) - C\\,\\hat{x}(t)\\,\\mathrm{d}t)\n$$\n此处，$\\hat{x}(t)$ 是状态 $x(t)$ 的估计值，$K(t) \\in \\mathbb{R}^{2 \\times 2}$ 是待确定的滤波器增益矩阵。项 $\\mathrm{d}y(t) - C\\,\\hat{x}(t)\\,\\mathrm{d}t$ 表示新息增量，即测量过程提供的新信息。\n\n估计误差定义为 $e(t) = x(t) - \\hat{x}(t)$。其动态特性通过状态方程减去估计器方程得到：\n$$\n\\mathrm{d}e(t) = \\mathrm{d}x(t) - \\mathrm{d}\\hat{x}(t)\n$$\n代入给定的系统动态和假设的滤波器结构：\n$$\n\\mathrm{d}e(t) = (A\\,x(t)\\,\\mathrm{d}t + G\\,\\mathrm{d}w(t)) - (A\\,\\hat{x}(t)\\,\\mathrm{d}t + K(t)\\,(C\\,x(t)\\,\\mathrm{d}t + \\mathrm{d}v(t) - C\\,\\hat{x}(t)\\,\\mathrm{d}t))\n$$\n按 $x(t)$ 和 $\\hat{x}(t)$ 对各项进行分组：\n$$\n\\mathrm{d}e(t) = A\\,(x(t)-\\hat{x}(t))\\,\\mathrm{d}t - K(t)\\,C\\,(x(t)-\\hat{x}(t))\\,\\mathrm{d}t + G\\,\\mathrm{d}w(t) - K(t)\\,\\mathrm{d}v(t)\n$$\n$$\n\\mathrm{d}e(t) = (A - K(t)C)\\,e(t)\\,\\mathrm{d}t + G\\,\\mathrm{d}w(t) - K(t)\\,\\mathrm{d}v(t)\n$$\n这是控制估计误差的随机微分方程 (SDE)。Kalman-Bucy 滤波器的目标是选择增益 $K(t)$ 以最小化均方误差，即误差协方差矩阵 $P(t) = \\mathbb{E}[e(t)e(t)^{\\top}]$ 的迹。\n\n为求得 $P(t)$ 的微分方程，我们对过程 $e(t)e(t)^{\\top}$ 应用 Itô 引理：\n$$\n\\mathrm{d}(e(t)e(t)^{\\top}) = (\\mathrm{d}e(t))e(t)^{\\top} + e(t)(\\mathrm{d}e(t))^{\\top} + (\\mathrm{d}e(t))(\\mathrm{d}e(t))^{\\top}\n$$\n我们计算每一项。二次变分项 $(\\mathrm{d}e(t))(\\mathrm{d}e(t))^{\\top}$ 为：\n$$\n(\\mathrm{d}e)(\\mathrm{d}e)^{\\top} = (G\\,\\mathrm{d}w - K\\,\\mathrm{d}v)(G\\,\\mathrm{d}w - K\\,\\mathrm{d}v)^{\\top}\n$$\n使用 Itô 乘法规则（$\\mathrm{d}t \\cdot \\mathrm{d}t = 0$, $\\mathrm{d}t \\cdot \\mathrm{d}w = 0$, $\\mathrm{d}w_i \\cdot \\mathrm{d}w_j = \\delta_{ij}\\mathrm{d}t$），以及 $w(t)$ 和 $v(t)$ 的独立性（$\\mathrm{d}w \\cdot \\mathrm{d}v^{\\top} = 0$），上式可简化为：\n$$\n(\\mathrm{d}e)(\\mathrm{d}e)^{\\top} = G(\\mathrm{d}w)(\\mathrm{d}w)^{\\top}G^{\\top} + K(\\mathrm{d}v)(\\mathrm{d}v)^{\\top}K^{\\top}\n$$\n取期望，我们得到：\n$$\n\\mathbb{E}[(\\mathrm{d}e)(\\mathrm{d}e)^{\\top}] = G\\,\\mathbb{E}[(\\mathrm{d}w)(\\mathrm{d}w)^{\\top}]\\,G^{\\top} + K\\,\\mathbb{E}[(\\mathrm{d}v)(\\mathrm{d}v)^{\\top}]\\,K^{\\top} = (GQG^{\\top} + KRK^{\\top})\\,\\mathrm{d}t\n$$\n现在，对 $\\mathrm{d}(ee^{\\top})$ 的完整表达式取期望：\n$$\n\\mathrm{d}P(t) = \\mathbb{E}[\\mathrm{d}(ee^{\\top})] = \\mathbb{E}[(\\mathrm{d}e)e^{\\top} + e(\\mathrm{d}e)^{\\top}] + (GQG^{\\top} + KRK^{\\top})\\,\\mathrm{d}t\n$$\n正交性原理指出，对于最优滤波器，估计误差 $e(t)$ 与噪声过程的历史正交。因此，$\\mathbb{E}[e(t)\\,\\mathrm{d}w(t)^{\\top}]=0$ 和 $\\mathbb{E}[e(t)\\,\\mathrm{d}v(t)^{\\top}]=0$。这意味着涉及 $e$ 和噪声增量的交叉项的期望为零。\n$$\n\\mathbb{E}[(\\mathrm{d}e)e^{\\top}] = \\mathbb{E}[((A-KC)e\\,\\mathrm{d}t + G\\,\\mathrm{d}w - K\\,\\mathrm{d}v)e^{\\top}] = (A-KC)P(t)\\,\\mathrm{d}t\n$$\n因此，协方差矩阵的时间演化由微分 Riccati 方程 (DRE) 给出：\n$$\n\\dot{P}(t) = (A-K(t)C)P(t) + P(t)(A-K(t)C)^{\\top} + GQG^{\\top} + K(t)RK(t)^{\\top}\n$$\n$$\n\\dot{P}(t) = AP(t) + P(t)A^{\\top} - K(t)CP(t) - P(t)C^{\\top}K(t)^{\\top} + K(t)RK(t)^{\\top} + GQG^{\\top}\n$$\n为了找到在每个时刻最小化 MSE 的最优增益 $K(t)$，我们最小化 $\\dot{P}(t)$ 关于 $K(t)$ 的迹。我们将涉及 $K(t)$ 的项对 $K(t)$ 求导，并令结果为零：\n$$\n\\frac{\\partial}{\\partial K} \\mathrm{tr}[-KCP - PC^{\\top}K^{\\top} + KRK^{\\top}] = 0\n$$\n使用标准矩阵微积分恒等式 $\\frac{\\partial}{\\partial X} \\mathrm{tr}(AX) = A^{\\top}$ 和 $\\frac{\\partial}{\\partial X} \\mathrm{tr}(XBX^{\\top}) = X(B+B^{\\top})$，可得：\n$$\n-2PC^{\\top} + 2KR = 0\n$$\n假设 $R$ 是可逆的（因为它是正定的），最优增益为：\n$$\nK(t) = P(t)C^{\\top}R^{-1}\n$$\n将此最优增益代回 DRE，得到其最终形式：\n$$\n\\dot{P}(t) = AP(t) + P(t)A^{\\top} - P(t)C^{\\top}R^{-1}C P(t) + GQG^{\\top}\n$$\n对于稳态解，我们假设系统达到平衡，此时 $\\dot{P}(t) = 0$ 且 $P(t) \\to P_{ss}$。这导出了连续时间代数 Riccati 方程 (CARE)：\n$$\n0 = AP_{ss} + P_{ss}A^{\\top} - P_{ss}C^{\\top}R^{-1}C P_{ss} + GQG^{\\top}\n$$\n相应的稳态增益为 $K_{ss} = P_{ss}C^{\\top}R^{-1}$。\n\n现在我们为给定的系统矩阵计算解：\n$$\nA = \\begin{pmatrix} 1 & 0 \\\\ 0 & -2 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\quad G = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\n$$\nQ = \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\quad R = \\begin{pmatrix} 1 & 0 \\\\ 0 & 3 \\end{pmatrix}\n$$\n我们首先计算 CARE 所需的矩阵乘积：\n$GQG^{\\top} = I Q I^{\\top} = Q = \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix}$。\n$C^{\\top}R^{-1}C = I R^{-1} I = R^{-1} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1/3 \\end{pmatrix}$。\nCARE 为：\n$$\n0 = AP_{ss} + P_{ss}A^{\\top} - P_{ss}R^{-1}P_{ss} + Q\n$$\n由于所有矩阵 $A$、$Q$ 和 $R^{-1}$ 都是对角矩阵，解 $P_{ss}$ 也必须是对角矩阵。设 $P_{ss} = \\begin{pmatrix} p_1 & 0 \\\\ 0 & p_2 \\end{pmatrix}$。将其代入 CARE：\n$$\n\\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & -2 \\end{pmatrix}\\begin{pmatrix} p_1 & 0 \\\\ 0 & p_2 \\end{pmatrix} + \\begin{pmatrix} p_1 & 0 \\\\ 0 & p_2 \\end{pmatrix}\\begin{pmatrix} 1 & 0 \\\\ 0 & -2 \\end{pmatrix} - \\begin{pmatrix} p_1 & 0 \\\\ 0 & p_2 \\end{pmatrix}\\begin{pmatrix} 1 & 0 \\\\ 0 & 1/3 \\end{pmatrix}\\begin{pmatrix} p_1 & 0 \\\\ 0 & p_2 \\end{pmatrix} + \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 2p_1 & 0 \\\\ 0 & -4p_2 \\end{pmatrix} - \\begin{pmatrix} p_1^2 & 0 \\\\ 0 & p_2^2/3 \\end{pmatrix} + \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\n这可以解耦为两个标量代数方程：\n1.  $2p_1 - p_1^2 + 2 = 0 \\implies p_1^2 - 2p_1 - 2 = 0$\n2.  $-4p_2 - \\frac{1}{3}p_2^2 + 1 = 0 \\implies p_2^2 + 12p_2 - 3 = 0$\n\n使用二次公式求解 $p_1$：\n$p_1 = \\frac{-(-2) \\pm \\sqrt{(-2)^2 - 4(1)(-2)}}{2} = \\frac{2 \\pm \\sqrt{12}}{2} = 1 \\pm \\sqrt{3}$。\n由于协方差矩阵 $P_{ss}$ 必须是正定的，其对角元素必须为正。因此，我们选择正根：$p_1 = 1 + \\sqrt{3}$。\n\n求解 $p_2$：\n$p_2 = \\frac{-12 \\pm \\sqrt{12^2 - 4(1)(-3)}}{2} = \\frac{-12 \\pm \\sqrt{144+12}}{2} = \\frac{-12 \\pm \\sqrt{156}}{2} = -6 \\pm \\sqrt{39}$。\n为了使 $p_2$ 为正，我们必须选择 $p_2 = -6 + \\sqrt{39}$，因为 $\\sqrt{39} > \\sqrt{36}=6$。\n稳态误差协方差为 $P_{ss} = \\begin{pmatrix} 1+\\sqrt{3} & 0 \\\\ 0 & \\sqrt{39}-6 \\end{pmatrix}$。\n\n最后，我们计算稳态卡尔曼增益 $K_{ss} = P_{ss}C^{\\top}R^{-1}$：\n$$\nK_{ss} = \\begin{pmatrix} 1+\\sqrt{3} & 0 \\\\ 0 & \\sqrt{39}-6 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}^{\\top} \\begin{pmatrix} 1 & 0 \\\\ 0 & 3 \\end{pmatrix}^{-1} = \\begin{pmatrix} 1+\\sqrt{3} & 0 \\\\ 0 & \\sqrt{39}-6 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1/3 \\end{pmatrix}\n$$\n$$\nK_{ss} = \\begin{pmatrix} 1+\\sqrt{3} & 0 \\\\ 0 & \\frac{\\sqrt{39}-6}{3} \\end{pmatrix}\n$$\n\n与滤波器相关的新息过程由其增量 $\\mathrm{d}z(t) = \\mathrm{d}y(t) - C\\hat{x}(t)\\mathrm{d}t$ 定义。它代表了最新测量中包含的、未被模型预测到的新信息。它的作用是根本性的：它驱动滤波器的校正项，根据预测与现实之间的差异更新状态估计。\n新息过程的统计特性对于滤波器的最优性至关重要。我们可以将其动态写为：\n$$\n\\mathrm{d}z(t) = (C x(t)\\mathrm{d}t + \\mathrm{d}v(t)) - C\\hat{x}(t)\\mathrm{d}t = C e(t)\\mathrm{d}t + \\mathrm{d}v(t)\n$$\n在稳态下，误差过程 $e(t)$ 具有零均值和恒定的协方差 $P_{ss}$。新息增量 $\\mathrm{d}z(t)$ 是一个零均值维纳过程的增量。对于最优滤波器，新息过程是一个维纳过程，其增量协方差等于测量噪声的增量协方差，即 $\\mathbb{E}[\\mathrm{d}z(t)\\mathrm{d}z(t)^{\\top}] = R\\,\\mathrm{d}t$。该滤波器充当一个白化滤波器，将有色的测量过程 $y(t)$ 转换为白噪声的新息过程。\n对于给定系统，稳态新息过程的增量协方差为 $R\\,\\mathrm{d}t = \\begin{pmatrix} 1 & 0 \\\\ 0 & 3 \\end{pmatrix}\\mathrm{d}t$。该协方差独立于系统动态（$A, Q$）和滤波器性能（$P_{ss}$）这一事实是连续时间 Kalman-Bucy 滤波器的一个标志性特性。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 + \\sqrt{3} & 0 \\\\\n0 & \\frac{\\sqrt{39}-6}{3}\n\\end{pmatrix}\n}\n$$", "id": "2713808"}, {"introduction": "卡尔曼-布西滤波器的性能并非凭空而来，它从根本上受限于系统的可观测性（observability）。这个实践问题提供了一个具体的场景，让你探索测量矩阵 $C$ 的结构如何决定不同状态分量的估计精度 [@problem_id:2694812]。通过求解稳态误差协方差，你将能定量地看到状态空间中不可观测的方向如何导致估计误差的膨胀，从而加深对控制理论概念与滤波器性能之间内在联系的理解。", "problem": "考虑一个由下式描述的连续时间线性时不变随机系统\n$$\\dot{x}(t) = A x(t) + w(t), \\quad y(t) = C x(t) + v(t),$$\n其中，$x(t) \\in \\mathbb{R}^{2}$，$y(t) \\in \\mathbb{R}$，$w(t)$ 是均值为零、协方差矩阵为 $Q$ 的高斯白过程噪声，$v(t)$ 是均值为零、协方差矩阵为 $R$ 的高斯白测量噪声。矩阵如下：\n$$A = \\begin{pmatrix} -1 & 0 \\\\ 0 & -2 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}, \\quad Q = \\begin{pmatrix} 1 & 0 \\\\ 0 & 4 \\end{pmatrix}, \\quad R = 1.$$\n\n从 Kalman-Bucy 滤波器和可观测性概念的基本定义出发，并仅在需要时使用公认的结果，完成以下任务：\n\n- 推导状态估计误差协方差矩阵 $P \\in \\mathbb{R}^{2 \\times 2}$ 必须满足的稳态方程，并显式求解 $P$。\n- 利用你的解，从基本原理出发，论述由 $C$ 编码的测量结构和测量噪声水平 $R$ 如何影响状态空间中可观测性好或差的方向，并解释为什么相对于过程噪声驱动的基准，较差的可观测性会增大这些方向上的估计误差。\n\n你最终报告的量必须是稳态误差协方差矩阵 $P$ 的迹。请以单一闭式表达式的形式给出。不需要四舍五入，也不需要单位。最终答案仅以单个数学表达式表示。", "solution": "该问题要求推导和求解连续时间 Kalman-Bucy 滤波器的稳态误差协方差，然后分析可观测性与估计误差之间的关系。\n\n对于给定系统，状态估计误差协方差矩阵 $P(t) = E[(x(t) - \\hat{x}(t))(x(t) - \\hat{x}(t))^T]$ 由连续时间微分 Riccati 方程 (DRE) 控制：\n$$ \\dot{P}(t) = A P(t) + P(t) A^T - P(t) C^T R^{-1} C P(t) + Q $$\n通过设置 $\\dot{P}(t) = 0$，可以得到稳态误差协方差矩阵（我们记为 $P$）。这产生了连续时间代数 Riccati 方程 (CARE)：\n$$ A P + P A^T - P C^T R^{-1} C P + Q = 0 $$\n设对称矩阵 $P$ 表示为 $P = \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix}$。给定的矩阵是：\n$$ A = \\begin{pmatrix} -1 & 0 \\\\ 0 & -2 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}, \\quad Q = \\begin{pmatrix} 1 & 0 \\\\ 0 & 4 \\end{pmatrix}, \\quad R = 1 $$\n首先，我们计算项 $C^T R^{-1} C$：\n$$ C^T R^{-1} C = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (1)^{-1} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} $$\n现在，我们将所有矩阵代入 CARE。\n项 $AP + PA^T$ 为：\n$$ \\begin{pmatrix} -1 & 0 \\\\ 0 & -2 \\end{pmatrix} \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} + \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} \\begin{pmatrix} -1 & 0 \\\\ 0 & -2 \\end{pmatrix} = \\begin{pmatrix} -p_{11} & -p_{12} \\\\ -2p_{12} & -2p_{22} \\end{pmatrix} + \\begin{pmatrix} -p_{11} & -2p_{12} \\\\ -p_{12} & -2p_{22} \\end{pmatrix} = \\begin{pmatrix} -2p_{11} & -3p_{12} \\\\ -3p_{12} & -4p_{22} \\end{pmatrix} $$\n项 $P C^T R^{-1} C P$ 为：\n$$ \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} = \\begin{pmatrix} p_{11} & 0 \\\\ p_{12} & 0 \\end{pmatrix} \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} = \\begin{pmatrix} p_{11}^2 & p_{11}p_{12} \\\\ p_{11}p_{12} & p_{12}^2 \\end{pmatrix} $$\n将这些代入 CARE，我们得到：\n$$ \\begin{pmatrix} -2p_{11} & -3p_{12} \\\\ -3p_{12} & -4p_{22} \\end{pmatrix} - \\begin{pmatrix} p_{11}^2 & p_{11}p_{12} \\\\ p_{11}p_{12} & p_{12}^2 \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ 0 & 4 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix} $$\n这为 $P$ 的分量产生了一个包含三个代数方程的方程组：\n1. $ -2p_{11} - p_{11}^2 + 1 = 0 \\implies p_{11}^2 + 2p_{11} - 1 = 0 $\n2. $ -3p_{12} - p_{11}p_{12} = 0 \\implies p_{12}(3+p_{11}) = 0 $\n3. $ -4p_{22} - p_{12}^2 + 4 = 0 \\implies 4p_{22} + p_{12}^2 = 4 $\n\n从方程 (1)，我们使用二次公式求解 $p_{11}$：\n$$ p_{11} = \\frac{-2 \\pm \\sqrt{2^2 - 4(1)(-1)}}{2(1)} = \\frac{-2 \\pm \\sqrt{8}}{2} = -1 \\pm \\sqrt{2} $$\n由于 $P$ 是一个协方差矩阵，它必须是半正定的，这要求其对角线元素为非负，即 $p_{11} \\geq 0$。解 $p_{11} = -1 - \\sqrt{2}$ 是负数，所以我们必须选择唯一的正解：\n$$ p_{11} = \\sqrt{2} - 1 $$\n现在，从方程 (2) 可知，$p_{12}(3+p_{11}) = 0$。由于 $p_{11} = \\sqrt{2} - 1 \\approx 0.414$，项 $(3+p_{11})$ 非零。因此，我们必须有：\n$$ p_{12} = 0 $$\n最后，从方程 (3)，我们求解 $p_{22}$：\n$$ 4p_{22} + 0^2 = 4 \\implies 4p_{22} = 4 \\implies p_{22} = 1 $$\n因此，稳态误差协方差矩阵为：\n$$ P = \\begin{pmatrix} \\sqrt{2} - 1 & 0 \\\\ 0 & 1 \\end{pmatrix} $$\n\n接下来，我们结合可观测性来分析这个结果。\n测量方程为 $y(t) = C x(t) + v(t) = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix} + v(t) = x_1(t) + v(t)$。这表明测量值 $y(t)$ 只提供关于状态分量 $x_1(t)$ 的直接信息。从测量中无法获得关于 $x_2(t)$ 的直接信息。\n\n此外，系统矩阵 $A$ 是对角矩阵，意味着状态动态是解耦的：\n$$ \\dot{x}_1(t) = -x_1(t) + w_1(t) $$\n$$ \\dot{x}_2(t) = -2x_2(t) + w_2(t) $$\n由于 $x_2(t)$ 不影响 $x_1(t)$ 的动态，因此没有间接方法可以从 $x_1(t)$ 的测量中推断出关于 $x_2(t)$ 的信息。因此，状态 $x_2(t)$ 是不可观测的。这对应于由向量 $\\begin{pmatrix} 0 & 1 \\end{pmatrix}^T$ 张成的方向是不可观测的。状态 $x_1(t)$ 是可观测的。\n\n$P$ 的对角线元素 $p_{11}$ 和 $p_{22}$ 分别表示 $x_1(t)$ 和 $x_2(t)$ 估计误差的稳态方差。\n- 对于可观测状态 $x_1(t)$，误差方差为 $p_{11} = \\sqrt{2} - 1$。Kalman 滤波器使用测量值 $y(t)$ 来校正对 $x_1(t)$ 的估计。CARE 中的项 $-P C^T R^{-1} C P$ 代表了由于此校正而导致的误差方差的减小。如果没有测量，估计误差协方差将由 Lyapunov 方程 $AP + PA^T + Q = 0$ 控制。对于第一个状态，纯粹基于模型（“开环”）的估计将具有由 $-2p_{11} + Q_{11} = 0 \\implies -2p_{11} + 1 = 0 \\implies p_{11, \\text{open-loop}} = \\frac{1}{2}$ 给出的稳态误差方差。Kalman 滤波器实现了 $p_{11} = \\sqrt{2} - 1 \\approx 0.414$，这小于 0.5 的开环基准。这证明了从测量中获得的改进。\n\n- 对于不可观测状态 $x_2(t)$，误差方差为 $p_{22} = 1$。由于没有可用于 $x_2(t)$ 的测量信息，Kalman 滤波器无法校正其估计。对 $x_2(t)$ 的估计纯粹基于模型，即它是一个开环估计。该开环估计的稳态误差方差由相应的 Lyapunov 方程给出：$-4p_{22} + Q_{22} = 0 \\implies -4p_{22} + 4 = 0 \\implies p_{22, \\text{open-loop}} = 1$。这恰好是从 CARE 中获得的值。\n\n这说明了一个基本原理：较差的可观测性会增大估计误差。由 $C$ 编码的测量结构决定了状态空间中的哪些方向是可观测的。在这里，$C$ 使得 $x_1$ 方向可观测，而 $x_2$ 方向不可观测。测量噪声水平 $R$ 影响在可观测方向上不确定性减小的程度。较小的 $R$ 会导致较小的 $p_{11}$，但 $p_{22}$ 将不受影响。“过程噪声驱动的基准”对应于在没有测量更新的情况下，通过 Lyapunov 方程计算出的误差方差。对于一个不可观测的状态，Kalman 滤波器无法将误差降低到这个基准之下。\n\n最终要求的量是稳态误差协方差矩阵 $P$ 的迹。\n$$ \\text{tr}(P) = p_{11} + p_{22} = (\\sqrt{2} - 1) + 1 = \\sqrt{2} $$", "answer": "$$ \\boxed{\\sqrt{2}} $$", "id": "2694812"}, {"introduction": "卡尔曼-布西滤波器最强大的应用之一是在线性二次高斯 (Linear-Quadratic-Gaussian, LQG) 控制中，它为最优反馈控制器提供状态估计。本练习综合了最优估计和最优控制的概念，要求你基于著名的分离原理 (separation principle) 来构建一个完整的LQG控制器 [@problem_id:2719606]。通过独立求解调节器和滤波器增益并分析组合后系统的特性，你将亲手实践现代控制理论的基石之一。", "problem": "考虑具有高斯扰动的连续时间线性时不变 (LTI) 系统\n$$\\dot{x}(t) = A\\,x(t) + B\\,u(t) + w(t), \\qquad y(t) = C\\,x(t) + v(t),$$\n其中 $x(t) \\in \\mathbb{R}^{2}$，$u(t) \\in \\mathbb{R}^{2}$，$y(t) \\in \\mathbb{R}^{2}$，并且\n$$\nA = \\begin{pmatrix} 1 & 0 \\\\ 0 & -2 \\end{pmatrix}, \\quad\nB = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\quad\nC = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}.\n$$\n假设 $w(t)$ 和 $v(t)$ 是独立的、零均值的白色高斯过程，其谱密度矩阵为\n$$\nW = \\begin{pmatrix} 1 & 0 \\\\ 0 & 9 \\end{pmatrix}, \\qquad V = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}.\n$$\n性能指标是无限时域二次型代价\n$$\nJ = \\lim_{T \\to \\infty} \\mathbb{E}\\left[\\int_{0}^{T} \\left(x(t)^{\\top} Q\\,x(t) + u(t)^{\\top} R\\,u(t)\\right)\\,dt \\right],\n$$\n其中\n$$\nQ = \\begin{pmatrix} 4 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\qquad R = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}.\n$$\n假设 $(A,B)$ 是可镇定的，$(A,C)$ 是可检测的。\n\n仅使用线性二次高斯 (LQG) 控制的基本原理，即：(i) 线性二次调节器 (LQR) 的最优性原理和二次值函数 ansatz，以及 (ii) 稳态 Kalman-Bucy 滤波器的创新过程和误差协方差动态，执行以下操作：\n\n- 从带有二次值函数的最优性原理出发，推导 LQR 的连续时间代数 Riccati 方程，并根据给定数据求解，以获得最优状态反馈增益 $K$。\n- 从线性高斯估计误差动态出发，推导 Kalman-Bucy 滤波器的稳态协方差代数 Riccati 方程，并根据给定数据求解，以获得稳态滤波器增益 $L$。\n- 调用确定性等价原理来构建 LQG 控制器 $u(t) = -K\\,\\hat{x}(t)$，其中 $\\hat{x}(t)$ 由稳态 Kalman-Bucy 滤波器 $\\dot{\\hat{x}}(t) = A\\,\\hat{x}(t) + B\\,u(t) + L\\,(y(t) - C\\,\\hat{x}(t))$ 生成。\n- 在 $(x,e)$ 坐标系下（其中 $e \\triangleq x - \\hat{x}$）构建确定性闭环矩阵，并使用分离原理确定其特征值。\n\n作为最终答案，请提供由确定性等价 LQG 控制器针对指定的 $(A,B,C,Q,R,W,V)$ 所隐含的闭环确定性 $(x,e)$-动态的四个实特征值组成的有序行矩阵（按升序排列）。不要四舍五入；以根式形式给出精确值。", "solution": "LQG 问题的解基于分离原理，该原理指出最优状态反馈控制器和最优状态估计器的设计可以独立进行。组合闭环系统的特征值是控制器（调节器）和估计器（滤波器）特征值的并集。\n\n**第 1 部分：线性二次调节器 (LQR) 问题**\n\n确定性 LQR 问题旨在为系统 $\\dot{x} = Ax + Bu$ 寻找一个控制律 $u(t) = -Kx(t)$，以最小化代价泛函 $J = \\int_{0}^{\\infty} (x^\\top Q x + u^\\top R u) dt$。该解通过 Hamilton-Jacobi-Bellman (HJB) 方程找到。假设二次值函数为 $V(x) = \\frac{1}{2} x^\\top P x$，其中 $P = P^\\top \\ge 0$，则 HJB 方程为：\n$$\n\\min_{u} \\left\\{ \\frac{1}{2} x^\\top Q x + \\frac{1}{2} u^\\top R u + (\\nabla_x V)^\\top (Ax+Bu) \\right\\} = 0\n$$\n代入 $\\nabla_x V = Px$，我们得到：\n$$\n\\min_{u} \\left\\{ \\frac{1}{2} x^\\top Q x + \\frac{1}{2} u^\\top R u + x^\\top P (Ax+Bu) \\right\\} = 0\n$$\n为了找到最优控制 $u$，我们对 $u$ 求梯度并令其为零：\n$$\nR u + B^\\top P x = 0 \\implies u^*(t) = -R^{-1}B^\\top P x(t)\n$$\n这给出了最优状态反馈增益矩阵 $K = R^{-1}B^\\top P$。将 $u^*$ 代回 HJB 方程，得到控制器的连续时间代数 Riccati 方程 (CARE)：\n$$\nA^\\top P + PA - PBR^{-1}B^\\top P + Q = 0\n$$\n对于给定的问题，矩阵为：\n$A = \\begin{pmatrix} 1 & 0 \\\\ 0 & -2 \\end{pmatrix}$，$B = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$，$Q = \\begin{pmatrix} 4 & 0 \\\\ 0 & 1 \\end{pmatrix}$，$R = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$。\n由于 $B=I_2$ 和 $R=I_2$，CARE 简化为 $A^\\top P + PA - P^2 + Q = 0$。\n鉴于所有系统矩阵都是对角矩阵，我们假设 $P = \\begin{pmatrix} p_1 & 0 \\\\ 0 & p_2 \\end{pmatrix}$ 有一个对角解。该矩阵方程解耦为两个标量代数 Riccati 方程：\n对于 $p_1$：\n$$\n(1)p_1 + p_1(1) - p_1^2 + 4 = 0 \\implies p_1^2 - 2p_1 - 4 = 0\n$$\n对于 $p_2$：\n$$\n(-2)p_2 + p_2(-2) - p_2^2 + 1 = 0 \\implies p_2^2 + 4p_2 - 1 = 0\n$$\n我们求解这两个关于 $p_1$ 和 $p_2$ 的二次方程。我们必须选择正根以确保 $P$ 是正定的，这保证了闭环系统的稳定性。\n对于 $p_1$：$p_1 = \\frac{2 \\pm \\sqrt{(-2)^2 - 4(1)(-4)}}{2} = \\frac{2 \\pm \\sqrt{20}}{2} = 1 \\pm \\sqrt{5}$。我们选择 $p_1 = 1 + \\sqrt{5} > 0$。\n对于 $p_2$：$p_2 = \\frac{-4 \\pm \\sqrt{4^2 - 4(1)(-1)}}{2} = \\frac{-4 \\pm \\sqrt{20}}{2} = -2 \\pm \\sqrt{5}$。我们选择 $p_2 = -2 + \\sqrt{5} > 0$。\n因此，镇定解为 $P = \\begin{pmatrix} 1+\\sqrt{5} & 0 \\\\ 0 & -2+\\sqrt{5} \\end{pmatrix}$。\n最优 LQR 增益为 $K = R^{-1}B^\\top P = I_2 \\cdot I_2 \\cdot P = P$。\nLQR 闭环系统的特征值是矩阵 $A - BK = A - P$ 的特征值。\n$$\nA - P = \\begin{pmatrix} 1 & 0 \\\\ 0 & -2 \\end{pmatrix} - \\begin{pmatrix} 1+\\sqrt{5} & 0 \\\\ 0 & -2+\\sqrt{5} \\end{pmatrix} = \\begin{pmatrix} -\\sqrt{5} & 0 \\\\ 0 & -\\sqrt{5} \\end{pmatrix}\n$$\n因此，调节器的特征值为 $\\lambda_{1,LQR} = -\\sqrt{5}$ 和 $\\lambda_{2,LQR} = -\\sqrt{5}$。\n\n**第 2 部分：Kalman-Bucy 滤波器问题**\n\nKalman-Bucy 滤波器提供状态 $x(t)$ 的最优估计 $\\hat{x}(t)$。滤波器动态为 $\\dot{\\hat{x}} = A\\hat{x} + Bu + L(y - C\\hat{x})$。估计误差定义为 $e(t) = x(t) - \\hat{x}(t)$。其动态由下式给出：\n$$\n\\dot{e} = \\dot{x} - \\dot{\\hat{x}} = (Ax+Bu+w) - (A\\hat{x}+Bu+L(Cx+v-C\\hat{x})) = (A-LC)e + w - Lv\n$$\n稳态误差协方差矩阵 $\\Sigma = \\lim_{t\\to\\infty} \\mathbb{E}[e(t)e(t)^\\top]$ 是滤波器代数 Riccati 方程 (ARE) 的正定解：\n$$\nA\\Sigma + \\Sigma A^\\top - \\Sigma C^\\top V^{-1} C \\Sigma + W = 0\n$$\n最小化误差协方差的最优滤波器增益由 $L = \\Sigma C^\\top V^{-1}$ 给出。滤波器误差动态矩阵 $A-LC$ 的特征值决定了滤波器的稳定性和性能。\n对于给定的问题，矩阵为：\n$A = \\begin{pmatrix} 1 & 0 \\\\ 0 & -2 \\end{pmatrix}$，$C = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$，$W = \\begin{pmatrix} 1 & 0 \\\\ 0 & 9 \\end{pmatrix}$，$V = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$。\n由于 $C=I_2$ 和 $V=I_2$，滤波器 ARE 简化为 $A\\Sigma + \\Sigma A^\\top - \\Sigma^2 + W = 0$。\n同样，我们假设一个对角解 $\\Sigma = \\begin{pmatrix} \\sigma_1 & 0 \\\\ 0 & \\sigma_2 \\end{pmatrix}$。该矩阵方程解耦为：\n对于 $\\sigma_1$：\n$$\n(1)\\sigma_1 + \\sigma_1(1) - \\sigma_1^2 + 1 = 0 \\implies \\sigma_1^2 - 2\\sigma_1 - 1 = 0\n$$\n对于 $\\sigma_2$：\n$$\n(-2)\\sigma_2 + \\sigma_2(-2) - \\sigma_2^2 + 9 = 0 \\implies \\sigma_2^2 + 4\\sigma_2 - 9 = 0\n$$\n我们求解正根以确保 $\\Sigma$ 是正定的。\n对于 $\\sigma_1$：$\\sigma_1 = \\frac{2 \\pm \\sqrt{(-2)^2 - 4(1)(-1)}}{2} = \\frac{2 \\pm \\sqrt{8}}{2} = 1 \\pm \\sqrt{2}$。我们选择 $\\sigma_1 = 1 + \\sqrt{2} > 0$。\n对于 $\\sigma_2$：$\\sigma_2 = \\frac{-4 \\pm \\sqrt{4^2 - 4(1)(-9)}}{2} = \\frac{-4 \\pm \\sqrt{52}}{2} = -2 \\pm \\sqrt{13}$。我们选择 $\\sigma_2 = -2 + \\sqrt{13} > 0$。\n稳态协方差为 $\\Sigma = \\begin{pmatrix} 1+\\sqrt{2} & 0 \\\\ 0 & -2+\\sqrt{13} \\end{pmatrix}$。\n最优滤波器增益为 $L = \\Sigma C^\\top V^{-1} = \\Sigma \\cdot I_2 \\cdot I_2 = \\Sigma$。\n滤波器误差动态的特征值是矩阵 $A - LC = A - \\Sigma$ 的特征值。\n$$\nA - \\Sigma = \\begin{pmatrix} 1 & 0 \\\\ 0 & -2 \\end{pmatrix} - \\begin{pmatrix} 1+\\sqrt{2} & 0 \\\\ 0 & -2+\\sqrt{13} \\end{pmatrix} = \\begin{pmatrix} -\\sqrt{2} & 0 \\\\ 0 & -\\sqrt{13} \\end{pmatrix}\n$$\n因此，滤波器的特征值为 $\\lambda_{1,EST} = -\\sqrt{2}$ 和 $\\lambda_{2,EST} = -\\sqrt{13}$。\n\n**第 3 部分：闭环系统特征值**\n\n通过将 LQR 增益应用于估计状态来构成 LQG 控制器，这是确定性等价原理的应用：$u(t) = -K\\hat{x}(t)$。\n整个系统的动态可以用状态 $x$ 和估计误差 $e = x - \\hat{x}$ 来描述。\n$$\n\\dot{x} = Ax + B(-K\\hat{x}) + w = Ax - BK(x-e) + w = (A-BK)x + BKe + w\n$$\n$$\n\\dot{e} = (A-LC)e + w - Lv\n$$\n以矩阵形式表示，闭环系统的确定性部分是：\n$$\n\\frac{d}{dt}\\begin{pmatrix} x \\\\ e \\end{pmatrix} = \\begin{pmatrix} A-BK & BK \\\\ 0 & A-LC \\end{pmatrix} \\begin{pmatrix} x \\\\ e \\end{pmatrix}\n$$\n该系统矩阵是块上三角矩阵。因此，其特征值是其对角块 $A-BK$ 和 $A-LC$ 的特征值。\n确定性闭环 LQG 系统的四个特征值集合是 LQR 特征值和 Kalman 滤波器特征值的并集：\n$$\n\\{ -\\sqrt{5}, -\\sqrt{5}, -\\sqrt{2}, -\\sqrt{13} \\}\n$$\n问题要求将这些特征值按升序（从最小到最大）排列。我们有 $\\sqrt{2} \\approx 1.414$，$\\sqrt{5} \\approx 2.236$，以及 $\\sqrt{13} \\approx 3.606$。因此，升序为 $-\\sqrt{13}$，$-\\sqrt{5}$，$-\\sqrt{5}$，$-\\sqrt{2}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} -\\sqrt{13} & -\\sqrt{5} & -\\sqrt{5} & -\\sqrt{2} \\end{pmatrix}\n}\n$$", "id": "2719606"}]}