{"hands_on_practices": [{"introduction": "本练习旨在通过解析方法求解一个经典的随机线性二次调节器 (LQR) 问题。这是最优控制理论的基石，因为它为一个非平凡的 HJB 方程提供了完整的闭式解，清晰地展示了动态规划、HJB 方程与代数 Riccati 方程之间的深刻联系。通过这个实践，您将掌握求解一类重要随机控制问题的核心分析技术。[@problem_id:3001633]", "problem": "考虑一维受控奥恩斯坦-乌伦贝克（Ornstein–Uhlenbeck, OU）扩散的无限时域折扣随机控制问题。状态过程 $\\{X_{t}\\}_{t \\ge 0}$ 根据以下受控随机微分方程演化\n$$\n\\mathrm{d}X_{t} = \\big(-\\theta X_{t} + \\beta u_{t}\\big)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t}, \\quad X_{0}=x,\n$$\n其中 $W_{t}$ 是标准布朗运动，$\\theta>0$, $\\beta\\neq 0$, $\\sigma>0$ 是给定的常数。控制过程 $\\{u_{t}\\}_{t \\ge 0}$ 相对于 $W_{t}$ 的 filtration 是循序可测的，并且取值于 $\\mathbb{R}$。目标是在所有容许控制下，最小化折扣成本泛函\n$$\nJ^{u}(x) \\equiv \\mathbb{E}\\!\\left[\\int_{0}^{\\infty} \\exp(-\\rho t)\\big(q X_{t}^{2} + r u_{t}^{2}\\big)\\,\\mathrm{d}t\\right],\n$$\n其中 $\\rho>0$, $q>0$, 和 $r>0$ 是给定的常数。令 $V(x)\\equiv \\inf_{u} J^{u}(x)$ 表示值函数。\n\n从动态规划原理以及扩散生成元和折扣期望成本的定义出发，推导 $V(x)$ 的哈密顿–雅可比–贝尔曼（Hamilton–Jacobi–Bellman, HJB）方程，求解其显式闭式解，并获得最优平稳马尔可夫反馈 $u^{\\ast}(x)$。解释最优反馈如何修正线性漂移项，以及为什么这能实现闭环 OU 动力系统的稳定化。你的最终答案必须以一个单一的解析表达式给出，该表达式包含值函数 $V(x)$ 的闭式解和最优反馈 $u^{\\ast}(x)$，写成一个 $1\\times 2$ 的行矩阵形式，其第一个元素等于 $V(x)$，第二个元素等于 $u^{\\ast}(x)$。不需要进行数值计算，也不需要进行四舍五入。", "solution": "我们从受控扩散开始\n$$\n\\mathrm{d}X_{t} = b(X_{t},u_{t})\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t}, \\quad b(x,u) \\equiv -\\theta x + \\beta u,\n$$\n以及无限时域折扣成本\n$$\nJ^{u}(x) = \\mathbb{E}\\!\\left[\\int_{0}^{\\infty}\\exp(-\\rho t)\\,\\ell(X_{t},u_{t})\\,\\mathrm{d}t\\right], \\quad \\ell(x,u) \\equiv q x^{2} + r u^{2},\n$$\n其中 $\\rho>0$, $\\theta>0$, $q>0$, $r>0$, $\\sigma>0$, 且 $\\beta\\neq 0$。动态规划原理断言，如果 $V$ 是值函数，则在充分的正则性条件下，$V$ 满足哈密顿–雅可比–贝尔曼（HJB）方程。对于一个二次连续可微的 $V$ 和折扣因子 $\\rho>0$，该扩散控制问题的 HJB 方程为\n$$\n\\rho V(x) = \\inf_{u\\in\\mathbb{R}}\\Big\\{\\ell(x,u) + \\mathcal{L}^{u}V(x)\\Big\\},\n$$\n其中 $\\mathcal{L}^{u}$ 是作用于光滑测试函数 $f$ 上的受控生成元，定义为\n$$\n\\mathcal{L}^{u} f(x) \\equiv b(x,u) f'(x) + \\tfrac{1}{2}\\sigma^{2} f''(x) = \\big(-\\theta x + \\beta u\\big) f'(x) + \\tfrac{1}{2}\\sigma^{2} f''(x).\n$$\n因此，HJB 方程的具体形式为\n$$\n\\rho V(x) = \\inf_{u\\in\\mathbb{R}}\\left\\{q x^{2} + r u^{2} + \\big(-\\theta x + \\beta u\\big)V'(x) + \\tfrac{1}{2}\\sigma^{2} V''(x)\\right\\}.\n$$\n\n我们现在求解此方程。该结构在 $(x,u)$ 上是线性二次的，因此很自然地可以寻找以下形式的解\n$$\nV(x) = P x^{2} + C,\n$$\n其中 $P$ 和 $C$ 是待定常数。我们计算其导数 $V'(x) = 2 P x$ 和 $V''(x) = 2 P$。代入 HJB 方程得到\n$$\n\\rho \\big(P x^{2} + C\\big) = \\inf_{u\\in\\mathbb{R}}\\left\\{q x^{2} + r u^{2} + \\big(-\\theta x + \\beta u\\big)\\,2 P x + \\tfrac{1}{2}\\sigma^{2}\\cdot 2 P\\right\\}.\n$$\n关于 $u$ 的最小化涉及二次函数\n$$\n\\Phi(u;x) \\equiv r u^{2} + 2 P \\beta x\\, u + \\big(q x^{2} - 2\\theta P x^{2} + \\sigma^{2} P\\big).\n$$\n对于每个固定的 $x$，最小化子 $u^{\\ast}(x)$ 满足一阶条件\n$$\n\\frac{\\partial \\Phi}{\\partial u}(u;x) = 2 r u + 2 P \\beta x = 0,\n$$\n这给出了平稳反馈\n$$\nu^{\\ast}(x) = -\\frac{\\beta P}{r}\\,x.\n$$\n二阶导数 $\\frac{\\partial^{2}\\Phi}{\\partial u^{2}} = 2 r>0$ 证实了这确实是全局最小化子。将 $u^{\\ast}$ 代回，我们在最小值点进行计算：\n\n$$\n\\begin{aligned}\nr \\big(u^{\\ast}(x)\\big)^{2} &= r \\left(\\frac{\\beta^{2} P^{2}}{r^{2}} x^{2}\\right) = \\frac{\\beta^{2} P^{2}}{r} x^{2},\\\\\n\\big(-\\theta x + \\beta u^{\\ast}(x)\\big) V'(x) &= \\big(-\\theta x - \\beta \\tfrac{\\beta P}{r} x\\big)\\,2 P x = \\big(-2\\theta P - \\tfrac{2\\beta^{2} P^{2}}{r}\\big) x^{2},\\\\\n\\tfrac{1}{2}\\sigma^{2} V''(x) &= \\sigma^{2} P.\n\\end{aligned}\n$$\n\n因此，在最小化之后，HJB 方程变为\n$$\n\\rho P x^{2} + \\rho C = \\left[q - 2\\theta P - \\frac{\\beta^{2}}{r} P^{2}\\right] x^{2} + \\sigma^{2} P.\n$$\n匹配 $x^{2}$ 的系数和常数项，得到以下代数方程组\n\n$$\n\\begin{cases}\n\\rho P = q - 2\\theta P - \\dfrac{\\beta^{2}}{r} P^{2}, \\\\\n\\rho C = \\sigma^{2} P.\n\\end{cases}\n$$\n\n第一个是关于 $P$ 的代数 Riccati 方程：\n$$\n\\frac{\\beta^{2}}{r} P^{2} + (\\rho + 2\\theta) P - q = 0.\n$$\n它的两个根是\n$$\nP_{\\pm} = \\frac{ -(\\rho + 2\\theta) \\pm \\sqrt{(\\rho + 2\\theta)^{2} + \\dfrac{4\\beta^{2}}{r} q} }{ 2 \\dfrac{\\beta^{2}}{r} } = \\frac{r}{2\\beta^{2}}\\left( -(\\rho + 2\\theta) \\pm \\sqrt{(\\rho + 2\\theta)^{2} + \\frac{4\\beta^{2}}{r} q} \\right).\n$$\n因为 $q>0$, $r>0$, 且 $\\beta\\neq 0$，判别式严格大于 $(\\rho + 2\\theta)^{2}$，所以平方根项超过 $\\rho + 2\\theta$。因此 $P_{-}<0$ 且\n$$\nP_{+} = \\frac{r}{2\\beta^{2}}\\left( -(\\rho + 2\\theta) + \\sqrt{(\\rho + 2\\theta)^{2} + \\frac{4\\beta^{2}}{r} q} \\right) > 0.\n$$\n$V$ 的凸性和值函数的有界性要求我们选择正的稳定化解，因此我们取 $P=P_{+}$。常数 $C$ 则为\n$$\nC = \\frac{\\sigma^{2}}{\\rho}\\,P_{+}.\n$$\n\n综上，值函数和最优反馈为\n\n$$\n\\begin{aligned}\nV(x) &= P_{+} x^{2} + \\frac{\\sigma^{2}}{\\rho}\\,P_{+},\\\\\nu^{\\ast}(x) &= -\\frac{\\beta P_{+}}{r}\\,x = \\frac{(\\rho + 2\\theta) - \\sqrt{(\\rho + 2\\theta)^{2} + \\dfrac{4\\beta^{2}}{r} q}}{2\\beta}\\,x.\n\\end{aligned}\n$$\n\n关于 $u^{\\ast}(x)$ 的等式是通过代入 $P_{+}$ 的表达式得到的。为了解释稳定化，我们观察到在 $u^{\\ast}$ 下，闭环漂移项变为\n$$\n-\\theta x + \\beta u^{\\ast}(x) = -\\left(\\theta + \\frac{\\beta^{2}}{r} P_{+}\\right) x,\n$$\n其中 $\\theta + \\dfrac{\\beta^{2}}{r} P_{+} > \\theta > 0$。因此，闭环系统中的线性漂移系数比开环系统中更负，从而得到一个向原点均值回归性更强的 Ornstein–Uhlenbeck 过程。这种负线性反馈正是在存在扩散噪声的情况下，最小化长期折扣二次成本的稳定化作用。", "answer": "$$\\boxed{\\begin{pmatrix}\n\\frac{r}{2\\beta^{2}}\\!\\left(\\! -(\\rho+2\\theta)+\\sqrt{(\\rho+2\\theta)^{2}+\\frac{4\\beta^{2}}{r}q}\\,\\right) x^{2}+\\frac{\\sigma^{2}}{\\rho}\\cdot \\frac{r}{2\\beta^{2}}\\!\\left(\\! -(\\rho+2\\theta)+\\sqrt{(\\rho+2\\theta)^{2}+\\frac{4\\beta^{2}}{r}q}\\,\\right)\n&\n\\frac{(\\rho+2\\theta)-\\sqrt{(\\rho+2\\theta)^{2}+\\frac{4\\beta^{2}}{r}q}}{2\\beta}\\,x\n\\end{pmatrix}}$$", "id": "3001633"}, {"introduction": "这个练习是一个关键的思想实验，旨在检验一个看似合理的候选函数是否为真正的价值函数。它强调了并非任何满足边界条件的函数都可以作为有效的价值函数，从而促使您严格地逐点检验 HJB 方程。此过程将加深您对 HJB 方程作为最优性必要条件的理解，并引出对粘性解等更严格理论框架的需求。[@problem_id:2752646]", "problem": "考虑在域 $\\Omega := (-1,1)$ 上的确定性控制系统，其动力学由 $\\dot{x}(t) = u(t)$ 给出，控制约束为对于所有 $t \\geq 0$，$u(t) \\in [-1,1]$。令退出时间为 $\\tau := \\inf\\{ t \\geq 0 : |x(t)| = 1 \\}$，代价泛函为 $J(x_{0};u(\\cdot)) := \\int_{0}^{\\tau} 1 \\, dt$，其中 $x(0)=x_{0} \\in \\Omega$。将值函数 $V(x_{0})$ 定义为在所有取值于 $[-1,1]$ 内的可测控制 $u(\\cdot)$ 上 $J(x_{0};u(\\cdot))$ 的下确界。\n\n从动态规划原理出发，为任意满足边界条件 $W(x)=0$（对于 $|x|=1$）的足够光滑的候选函数 $W:\\Omega \\to \\mathbb{R}$ 推导逐点一致性条件，并说明在 $\\Omega$ 的内部，Hamilton-Jacobi-Bellman (HJB) 方程如何通过一个适当的残差来约束 $W$。然后，取特定的光滑候选函数 $W(x) := 1 - x^{2}$，该函数满足边界条件 $W(\\pm 1)=0$。使用您推导的 HJB 一致性条件，计算在 $x=0$ 处的逐点残差。\n\n您的最终答案必须是对应于此残差在 $x=0$ 处的值的单个实数。无需四舍五入。", "solution": "问题陈述已经过验证，被认为是有效的。这是一个最优控制理论中的标准问题，具体来说是一个最小时间问题，所有组成部分都定义明确、自洽且科学上合理。我们可以开始求解。\n\n该问题要求从动态规划原理 (DPP) 出发，推导 Hamilton-Jacobi-Bellman (HJB) 一致性条件，然后将其应用于一个特定的候选函数。\n\n系统动力学由 $\\dot{x}(t) = u(t)$ 给出，其中状态 $x(t) \\in \\Omega := (-1,1)$，控制 $u(t) \\in [-1,1]$。代价泛函表示离开域 $\\Omega$ 的时间：\n$$J(x_{0};u(\\cdot)) := \\int_{0}^{\\tau} 1 \\, dt$$\n其中 $\\tau := \\inf\\{t \\geq 0 : |x(t)| = 1\\}$。值函数 $V(x)$ 是在所有容许控制下该代价的下确界：$V(x) = \\inf_{u(\\cdot)} J(x; u(\\cdot))$。运行成本为 $L(x,u) = 1$。边界条件为，对于 $x \\in \\partial\\Omega$ (即 $|x|=1$)，$V(x) = 0$。\n\n动态规划原理指出，对于任意小的时间间隔 $h > 0$，值函数满足：\n$$V(x) = \\inf_{u(\\cdot):[0,h]\\to[-1,1]} \\left\\{ \\int_0^h L(x(t), u(t)) \\, dt + V(x(h)) \\right\\}$$\n对于这个特定问题，这变为：\n$$V(x) = \\inf_{u(\\cdot):[0,h]\\to[-1,1]} \\left\\{ h + V(x(h)) \\right\\}$$\n假设在区间 $[0, h]$ 上，控制 $u(t)$ 是一个恒定值 $u \\in [-1,1]$，那么状态演化为 $x(h) = x(0) + \\int_0^h u \\, ds = x + hu$。\n如果假设值函数 $V$ 是连续可微的 ($C^1$)，我们可以在 $x$ 处将 $V(x(h))$ 展开为泰勒级数：\n$$V(x(h)) = V(x+hu) = V(x) + V'(x)(hu) + O(h^2)$$\n其中 $V'(x)$ 表示 $V$ 对 $x$ 的导数。将此代入DPP方程：\n$$V(x) = \\inf_{u \\in [-1,1]} \\left\\{ h + V(x) + hV'(x)u + O(h^2) \\right\\}$$\n两边减去 $V(x)$ 并除以 $h > 0$：\n$$0 = \\inf_{u \\in [-1,1]} \\left\\{ 1 + V'(x)u + O(h) \\right\\}$$\n当 $h \\to 0$ 时取极限，$O(h)$ 项消失，得到值函数 $V(x)$ 在域 $\\Omega$ 内部必须满足的静态 Hamilton-Jacobi-Bellman 方程：\n$$0 = \\inf_{u \\in [-1,1]} \\left\\{ 1 + V'(x)u \\right\\}$$\n这个方程提供了逐点一致性条件。对于任意足够光滑的候选函数 $W(x)$，我们将 HJB 残差 $R_W(x)$ 定义为 HJB 表达式的值：\n$$R_W(x) := \\inf_{u \\in [-1,1]} \\left\\{ 1 + W'(x)u \\right\\}$$\n对于一个候选函数，要成为真正的值函数，其残差对于所有 $x \\in \\Omega$ 都必须为零，并且它必须满足边界条件。\n\n我们被给定的候选函数是 $W(x) := 1 - x^2$。\n首先，我们验证边界条件：$W(\\pm 1) = 1 - (\\pm 1)^2 = 1 - 1 = 0$。该条件得到满足。\n接下来，我们计算 $W(x)$ 的导数：\n$$W'(x) = \\frac{d}{dx}(1 - x^2) = -2x$$\n现在我们将此导数代入残差的表达式中：\n$$R_W(x) = \\inf_{u \\in [-1,1]} \\left\\{ 1 + (-2x)u \\right\\} = \\inf_{u \\in [-1,1]} \\left\\{ 1 - 2xu \\right\\}$$\n待最小化的表达式 $1 - 2xu$ 是控制变量 $u$ 在紧集 $[-1,1]$ 上的一个线性函数。最小值必在某个端点 $u=-1$ 或 $u=1$ 处取得。选择哪个端点取决于 $u$ 的系数 $-2x$ 的符号。\n具体来说，对于 $x \\neq 0$，使表达式最小化的控制 $u^*(x)$ 是 $u^*(x) = \\text{sgn}(-2x) = -\\text{sgn}(x)$。\n下确界可以写为 $1 - \\sup_{u \\in [-1,1]} \\{2xu\\}$。上确界是 $2|x|$，所以残差为：\n$$R_W(x) = 1 - 2|x|$$\n问题要求计算此逐点残差在点 $x=0$ 处的值。我们计算残差函数在 $x=0$ 处的值：\n$$R_W(0) = 1 - 2|0| = 1$$\n或者，可以直接计算在 $x=0$ 处的下确界表达式：\n$$R_W(0) = \\inf_{u \\in [-1,1]} \\{ 1 - 2(0)u \\} = \\inf_{u \\in [-1,1]} \\{ 1 \\} = 1$$\n在 $x=0$ 处的残差是 $1$。", "answer": "$$\\boxed{1}$$", "id": "2752646"}]}