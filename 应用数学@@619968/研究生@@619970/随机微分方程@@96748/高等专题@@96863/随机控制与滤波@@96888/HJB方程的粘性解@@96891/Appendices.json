{"hands_on_practices": [{"introduction": "理解粘性解理论的一个关键步骤是掌握次解（subsolution）和超解（supersolution）的概念。这些函数如同“栅栏”，为真实解提供了上界和下界，是构建解的存在性证明（如Perron方法）的基石。本练习将通过一个具体的最优控制问题，指导你如何构造最简单的常数次解和超解，从而直观地感受这些核心概念。[@problem_id:3005543]", "problem": "考虑一个一维受控动力系统，其控制过程为 $a_{s} \\in [-1,1]$，随时间 $s \\in [t,T]$ 演化，遵循常微分方程 $dX_{s} = a_{s}\\,ds$，初始条件为 $X_{t} = x$。设目标是最小化终端收益，因此价值函数为 $u(t,x) = \\inf_{a_{\\cdot}} \\mathbb{E}\\left[g\\left(X_{T}^{t,x,a}\\right)\\right]$，其中终端数据是有界连续函数 $g(x) = \\arctan(x)$。有界系数和动态规划原理共同给出了粘性意义下的 Hamilton-Jacobi-Bellman (HJB) 方程\n$$\n- u_{t}(t,x) + \\inf_{a \\in [-1,1]} \\left\\{ a\\,u_{x}(t,x) \\right\\} = 0 \\quad \\text{for } (t,x) \\in [0,T) \\times \\mathbb{R},\n$$\n其终端条件为 $u(T,x) = g(x)$，其中 $T>0$ 是固定的。\n\n仅使用粘性子解和超解的核心定义以及上述 HJB 的结构特性（有界系数，退化椭圆性），构造显式的有界连续函数 $u_{-}(t,x)$ 和 $u_{+}(t,x)$ 使得：\n- $u_{-}$ 是 HJB 在 $[0,T) \\times \\mathbb{R}$ 上的粘性子解，且对于所有 $x \\in \\mathbb{R}$ 都有 $u_{-}(T,x) \\le g(x)$，\n- $u_{+}$ 是 HJB 在 $[0,T) \\times \\mathbb{R}$ 上的粘性超解，且对于所有 $x \\in \\mathbb{R}$ 都有 $u_{+}(T,x) \\ge g(x)$。\n\n你的最终答案必须由 $u_{-}(t,x)$ 和 $u_{+}(t,x)$ 的显式解析表达式组成，这些表达式应为关于 $(t,x)$ 的常数函数，并按 $\\left(u_{-}, u_{+}\\right)$ 的顺序以单行矩阵的形式呈现。无需进行数值四舍五入。", "solution": "我们从动态优化和粘性解的基本设定开始。受控动力学 $dX_{s} = a_{s}\\,ds$（其中 $a_{s} \\in [-1,1]$）具有有界漂移系数 $a_{s}$ 和零扩散，这是随机微分方程的一个退化情形。与终端收益 $g(x) = \\arctan(x)$ 的最小化问题相关的价值函数 $u$ 在粘性意义下由 Hamilton-Jacobi-Bellman (HJB) 方程刻画\n$$\n- u_{t}(t,x) + \\inf_{a \\in [-1,1]} \\left\\{ a\\,u_{x}(t,x) \\right\\} = 0,\n$$\n终端数据为 $u(T,x) = g(x)$。\n\n我们回顾抛物型 HJB 方程的粘性子解和超解的定义。令 $F(t,x,p,q) = -p_{t} + \\inf_{a \\in [-1,1]} \\left\\{ a\\,p_{x} \\right\\}$ 表示作用于测试函数导数的算子。一个有界的上半连续函数 $v$ 是粘性子解，如果对于任何光滑测试函数 $\\varphi \\in C^{1,2}([0,T] \\times \\mathbb{R})$，使得 $v - \\varphi$ 在 $(t_{0},x_{0}) \\in [0,T) \\times \\mathbb{R}$ 处达到局部最大值，我们有\n$$\n- \\varphi_{t}(t_{0},x_{0}) + \\inf_{a \\in [-1,1]} \\left\\{ a\\,\\varphi_{x}(t_{0},x_{0}) \\right\\} \\le 0.\n$$\n类似地，一个有界的下半连续函数 $w$ 是粘性超解，如果对于任何 $\\psi \\in C^{1,2}$，使得 $w - \\psi$ 在 $(t_{0},x_{0})$ 处达到局部最小值，我们有\n$$\n- \\psi_{t}(t_{0},x_{0}) + \\inf_{a \\in [-1,1]} \\left\\{ a\\,\\psi_{x}(t_{0},x_{0}) \\right\\} \\ge 0.\n$$\n\n我们将构造显式的常数子解和超解函数。考虑终端数据 $g(x) = \\arctan(x)$。其值域为 $(-\\pi/2,\\pi/2)$，更精确地说，\n$$\n\\lim_{x \\to -\\infty} \\arctan(x) = -\\frac{\\pi}{2}, \\quad \\lim_{x \\to +\\infty} \\arctan(x) = \\frac{\\pi}{2},\n$$\n且对于所有 $x \\in \\mathbb{R}$ 我们有 $-\\frac{\\pi}{2} < \\arctan(x) < \\frac{\\pi}{2}$。因此，常数 $c_{-} := -\\frac{\\pi}{2}$ 和 $c_{+} := \\frac{\\pi}{2}$ 对于所有 $x \\in \\mathbb{R}$ 都满足 $c_{-} \\le g(x) \\le c_{+}$。定义\n$$\nu_{-}(t,x) := c_{-} = -\\frac{\\pi}{2}, \\quad u_{+}(t,x) := c_{+} = \\frac{\\pi}{2}.\n$$\n这些是有界连续函数。\n\n我们验证 $u_{-}$ 是一个粘性子解。设 $\\varphi \\in C^{1,2}$ 且假设 $u_{-} - \\varphi$ 在 $(t_{0},x_{0})$ 处达到局部最大值。由于 $u_{-}$ 是常数，这意味着 $- \\varphi$ 达到局部最大值，等价于 $\\varphi$ 在 $(t_{0},x_{0})$ 处达到局部最小值。在光滑函数 $(t,x)$ 的这样一个局部最小值点，我们有一阶导数为零且二阶导数非负，具体来说\n$$\n\\varphi_{t}(t_{0},x_{0}) = 0, \\quad \\varphi_{x}(t_{0},x_{0}) = 0, \\quad \\text{and} \\quad \\varphi_{xx}(t_{0},x_{0}) \\ge 0.\n$$\n对于我们的算子，相关的导数只有 $\\varphi_{t}$ 和 $\\varphi_{x}$，因此我们计算\n$$\n- \\varphi_{t}(t_{0},x_{0}) + \\inf_{a \\in [-1,1]} \\left\\{ a\\,\\varphi_{x}(t_{0},x_{0}) \\right\\} = - 0 + \\inf_{a \\in [-1,1]} \\left\\{ a \\cdot 0 \\right\\} = 0 \\le 0,\n$$\n这就验证了子解不等式。终端不等式 $u_{-}(T,x) \\le g(x)$ 成立，因为对于所有 $x \\in \\mathbb{R}$ 都有 $-\\frac{\\pi}{2} \\le \\arctan(x)$。\n\n我们验证 $u_{+}$ 是一个粘性超解。设 $\\psi \\in C^{1,2}$ 且假设 $u_{+} - \\psi$ 在 $(t_{1},x_{1})$ 处达到局部最小值。由于 $u_{+}$ 是常数，这意味着 $\\psi$ 在 $(t_{1},x_{1})$ 处达到局部最大值，或者等价地说，$-\\psi$ 达到局部最小值。对于一个在 $(t,x)$ 的局部最大值点的光滑函数 $\\psi$，其一阶导数为零：\n$$\n\\psi_{t}(t_{1},x_{1}) = 0, \\quad \\psi_{x}(t_{1},x_{1}) = 0.\n$$\n我们再次对算子进行计算\n$$\n- \\psi_{t}(t_{1},x_{1}) + \\inf_{a \\in [-1,1]} \\left\\{ a\\,\\psi_{x}(t_{1},x_{1}) \\right\\} = - 0 + \\inf_{a \\in [-1,1]} \\left\\{ a \\cdot 0 \\right\\} = 0 \\ge 0,\n$$\n这就验证了超解不等式。终端不等式 $u_{+}(T,x) \\ge g(x)$ 成立，因为对于所有 $x \\in \\mathbb{R}$ 都有 $\\arctan(x) \\le \\frac{\\pi}{2}$。\n\n这些显式的有界连续函数 $u_{-}(t,x) = -\\frac{\\pi}{2}$ 和 $u_{+}(t,x) = \\frac{\\pi}{2}$ 分别构成了给定终端条件 $g(x) = \\arctan(x)$ 的 HJB 方程的有效粘性子解和超解。它们为 Perron 方法提供了初始屏障，确保了围绕终端数据排序的非空子解族和超解族的存在。", "answer": "$$\\boxed{\\begin{pmatrix}\n-\\frac{\\pi}{2} & \\frac{\\pi}{2}\n\\end{pmatrix}}$$", "id": "3005543"}, {"introduction": "粘性解理论的强大之处在于它能够处理经典微积分失效的非光滑函数。本练习聚焦于绝对值函数 $u(x)=|x|$ 在原点这一经典“扭折”点，你将直接运用二阶亚流（subjet）的定义来量化函数的局部行为。通过这个计算，你将深刻理解为何即使在二阶导数不存在的情况下，粘性解的框架依然能够清晰地评估HJB算子。[@problem_id:3005560]", "problem": "设 $u:\\mathbb{R}\\to\\mathbb{R}$ 由 $u(x)=|x|$ 给出。考虑哈密顿–雅可比–贝尔曼 (HJB) 算子 $F:\\mathbb{R}\\times\\mathbb{R}\\to\\mathbb{R}$，其对 $p\\in\\mathbb{R}$ 和 $X\\in\\mathbb{R}$ 定义为\n$$\nF(p,X) \\;=\\; \\max\\{ -X,\\; 1 - |p| \\}.\n$$\n在粘性解理论的意义下，该算子是退化椭圆的，并且它仅依赖于一阶和二阶jet。在点 $x=0$ 处进行分析。\n\n仅使用二阶半jet和粘性上解的基本定义，按以下步骤进行：\n\n1) 从导数的定义出发，解释为何 $D^2 u(0)$ 不存在。\n\n2) 从二阶子jet $J^{2,-}u(0)$ 的定义（当 $x\\to 0$ 时，由 $u(x)\\ge u(0)+p(x-0)+\\tfrac{1}{2}X(x-0)^2 + o(|x|^2)$ 定义）出发，刻画出完整的集合 $J^{2,-}u(0)$。\n\n3) 论证为何二阶超jet $J^{2,+}u(0)$ 为空集。\n\n4) 对于方程 $F(Du,D^2u)=0$，在粘性上解的意义下，必须对所有 $(p,X)\\in J^{2,-}u(0)$ 检验 $F(p,X)\\ge 0$。为量化此不等式在 $x=0$ 处的尖锐性，计算下式的精确值\n$$\n\\inf_{(p,X)\\in J^{2,-}u(0)} F(p,X).\n$$\n\n你的最终答案必须是一个实数。无需四舍五入。", "solution": "问题要求在由算子 $F(p,X) = \\max\\{ -X,\\; 1 - |p| \\}$ 控制的哈密顿-雅可比-贝尔曼 (HJB) 方程的粘性解框架下，分析函数 $u(x)=|x|$ 在点 $x=0$ 处的性质。我们将按顺序解决问题的四个部分。\n\n首先，我们讨论 $u(x)$ 在 $x=0$ 处的经典可微性。\n函数 $u$ 在点 $x_0$ 处的一阶导数定义为 $u'(x_0) = \\lim_{h\\to 0} \\frac{u(x_0+h)-u(x_0)}{h}$，前提是此极限存在。对于 $u(x)=|x|$ 在 $x_0=0$ 处，我们考察其单侧极限：\n右极限是：\n$$ \\lim_{h\\to 0^+} \\frac{u(0+h)-u(0)}{h} = \\lim_{h\\to 0^+} \\frac{|h|-|0|}{h} = \\lim_{h\\to 0^+} \\frac{h}{h} = 1 $$\n左极限是：\n$$ \\lim_{h\\to 0^-} \\frac{u(0+h)-u(0)}{h} = \\lim_{h\\to 0^-} \\frac{|h|-|0|}{h} = \\lim_{h\\to 0^-} \\frac{-h}{h} = -1 $$\n由于左极限和右极限不相等，该极限不存在，因此一阶导数 $u'(0)$ 未定义。二阶导数 $D^2u(0)$ 或 $u''(0)$ 定义为一阶导数 $u'(x)$ 在 $x=0$ 处的导数。由于 $u'(0)$ 不存在，经典的二阶导数 $D^2u(0)$ 也不能存在。\n\n其次，我们刻画二阶子jet $J^{2,-}u(0)$。根据定义，$(p,X) \\in \\mathbb{R}\\times\\mathbb{R}$ 是 $J^{2,-}u(0)$ 的一个元素，当且仅当\n$$ u(y) \\ge u(0) + p(y-0) + \\frac{1}{2}X(y-0)^2 + o(|y|^2) \\quad \\text{as } y \\to 0. $$\n将 $u(y)=|y|$ 和 $u(0)=0$ 代入，该不等式变为：\n$$ |y| \\ge py + \\frac{1}{2}Xy^2 + o(y^2). $$\n这等价于检验函数 $\\phi(y) = py + \\frac{1}{2}Xy^2$ 在 $y=0$ 附近，在指定的意义下，位于 $u(y)$ 的下方。更形式化地，这可以表述为：\n$$ \\liminf_{y \\to 0} \\frac{|y| - py - \\frac{1}{2}Xy^2}{y^2} \\ge 0. $$\n为分析这一点，我们必须检查当 $y \\to 0^+$ 和 $y \\to 0^-$ 时的极限。\n对于 $y \\to 0^+$：\n$$ \\liminf_{y \\to 0^+} \\frac{y - py - \\frac{1}{2}Xy^2}{y^2} = \\liminf_{y \\to 0^+} \\left( \\frac{1-p}{y} - \\frac{X}{2} \\right) \\ge 0. $$\n如果 $p < 1$，则 $1-p > 0$，且当 $y \\to 0^+$ 时 $\\frac{1-p}{y} \\to +\\infty$。该不等式对任意 $X \\in \\mathbb{R}$ 成立。\n如果 $p > 1$，则 $1-p < 0$，且 $\\frac{1-p}{y} \\to -\\infty$。该不等式不成立。\n如果 $p = 1$，表达式变为 $\\liminf_{y \\to 0^+} (-\\frac{X}{2}) = -\\frac{X}{2}$。条件是 $-\\frac{X}{2} \\ge 0$，这意味着 $X \\le 0$。\n对于 $y \\to 0^-$：\n$$ \\liminf_{y \\to 0^-} \\frac{-y - py - \\frac{1}{2}Xy^2}{y^2} = \\liminf_{y \\to 0^-} \\left( \\frac{-(1+p)}{y} - \\frac{X}{2} \\right) \\ge 0. $$\n令 $y = -h$，其中 $h \\to 0^+$。表达式为 $\\liminf_{h \\to 0^+} (\\frac{1+p}{h} - \\frac{X}{2}) \\ge 0$。\n如果 $p > -1$，则 $1+p > 0$，且 $\\frac{1+p}{h} \\to +\\infty$。该不等式对任意 $X \\in \\mathbb{R}$ 成立。\n如果 $p < -1$，则 $1+p < 0$，且 $\\frac{1+p}{h} \\to -\\infty$。该不等式不成立。\n如果 $p = -1$，表达式为 $\\liminf_{h \\to 0^+} (-\\frac{X}{2}) = -\\frac{X}{2}$。条件是 $-\\frac{X}{2} \\ge 0$，这意味着 $X \\le 0$。\n综合这些条件：$p$ 必须在区间 $[-1, 1]$ 内。\n- 如果 $-1 < p < 1$，则两个单侧条件对任意 $X \\in \\mathbb{R}$ 都满足。\n- 如果 $p=1$，则必须有 $X \\le 0$。\n- 如果 $p=-1$，则必须有 $X \\le 0$。\n因此，二阶子jet是集合：\n$$ J^{2,-}u(0) = \\{ (p, X) \\in \\mathbb{R} \\times \\mathbb{R} \\mid p \\in (-1, 1), X \\in \\mathbb{R} \\} \\cup \\{ (\\pm 1, X) \\mid X \\le 0 \\}. $$\n\n第三，我们论证二阶超jet $J^{2,+}u(0)$ 为空集。根据定义，$(p,X) \\in J^{2,+}u(0)$ 如果\n$$ u(y) \\le u(0) + py + \\frac{1}{2}Xy^2 + o(|y|^2) \\quad \\text{as } y \\to 0. $$\n对于 $u(x)=|x|$ 在 $x=0$ 处，这表示为 $|y| \\le py + \\frac{1}{2}Xy^2 + o(|y|^2)$。这意味着 $|y| - py \\le O(y^2)$。\n对于 $y \\ne 0$，两边同除以 $|y|$，我们得到 $1 - p \\frac{y}{|y|} \\le O(|y|)$。\n当 $y \\to 0^+$ 时取极限，我们有 $\\frac{y}{|y|}=1$，所以 $1 - p \\le 0$，即 $p \\ge 1$。\n当 $y \\to 0^-$ 时取极限，我们有 $\\frac{y}{|y|}=-1$，所以 $1 - p(-1) \\le 0$，即 $1+p \\le 0$，这意味着 $p \\le -1$。\n一个实数 $p$ 不能同时满足 $p \\ge 1$ 和 $p \\le -1$。这个矛盾表明不存在这样的数对 $(p,X)$。因此，集合 $J^{2,+}u(0)$ 是空集。\n\n第四，我们计算 $F(p,X)$ 在集合 $J^{2,-}u(0)$ 上的下确界。\n函数为 $F(p,X) = \\max\\{ -X,\\; 1 - |p| \\}$。定义域是上面确定的集合 $J^{2,-}u(0)$。我们可以通过考虑定义域的两个不相交的部分来计算下确界。\n\n情况1：$(p,X)$ 满足 $-1 < p < 1$ 且 $X \\in \\mathbb{R}$。\n对于一个固定的 $p \\in (-1,1)$，量 $1-|p|$ 是一个正常数。令 $C = 1-|p| > 0$。我们想要找到 $\\inf_{X \\in \\mathbb{R}} \\max\\{ -X, C \\}$。\n$\\max\\{-X, C\\}$ 的值总是大于或等于 $C$。当下确界在 $-X$ 从下方趋近于 $C$ 时达到。对于任何满足 $-X \\le C$（即 $X \\ge -C$）的 $X$，最大值为 $C$。因此，$\\inf_{X \\in \\mathbb{R}} \\max\\{ -X, C \\} = C = 1-|p|$。\n现在，我们对 $p \\in (-1,1)$ 取下确界：\n$$ \\inf_{p \\in (-1,1)} (1-|p|). $$\n当 $|p|$ 趋近于 $1$ 时，函数 $1-|p|$ 趋近于其最小值。下确界是 $0$，尽管在定义域的这一部分中并未达到。\n\n情况2：$p=\\pm 1$ 且 $X \\le 0$。\n对于这些 $p$ 的值，我们有 $|p|=1$。函数变为：\n$$ F(p,X) = \\max\\{ -X, 1 - 1 \\} = \\max\\{ -X, 0 \\}. $$\n我们已知 $X \\le 0$，这意味着 $-X \\ge 0$。\n因此，对于定义域的这一部分，$\\max\\{ -X, 0 \\} = -X$。\n我们想要计算 $\\inf_{X \\le 0} (-X)$。\n当 $X$ 在区间 $(-\\infty, 0]$ 上变化时，表达式 $-X$ 在 $[0, \\infty)$ 上变化。\n集合 $[0, \\infty)$ 的下确界是 $0$。当 $X=0$ 时达到此值。点 $(1,0)$ 和 $(-1,0)$ 属于定义域的这一部分。\n\n结合两种情况的结果， $F(p,X)$ 在整个集合 $J^{2,-}u(0)$ 上的下确界是为每个部分找到的下确界的最小值：\n$$ \\inf_{(p,X)\\in J^{2,-}u(0)} F(p,X) = \\min\\{ 0, 0 \\} = 0. $$\n这个值证实了 $u(x)=|x|$ 是 $F(Du,D^2u)=0$ 的一个粘性上解，并且不等式 $F(p,X) \\ge 0$ 是尖锐的，因为其下确界恰好是 $0$。", "answer": "$$\\boxed{0}$$", "id": "3005560"}, {"introduction": "HJB方程的结构深刻地反映了其背后随机控制问题的特性，特别是随机噪声的性质。本练习将探讨当扩散矩阵秩亏时，即随机性只存在于部分方向时，HJB算子的二阶项会发生什么变化。通过计算具体例子中的“退化椭圆性”效应，你将建立起随机微分方程（SDE）的扩散项与偏微分方程（PDE）的椭圆性之间的直接联系。[@problem_id:3005553]", "problem": "考虑受控随机微分方程(SDE)\n$$\n\\mathrm{d}X_{t} = b(X_{t},a_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t},\n$$\n其中 $X_{t} \\in \\mathbb{R}^{n}$ 是状态， $a_{t} \\in A$ 是在紧度量集 $A$ 中取值的控制过程，$b:\\mathbb{R}^{n}\\times A \\to \\mathbb{R}^{n}$ 是漂移项，$\\sigma:\\mathbb{R}^{n} \\to \\mathbb{R}^{n \\times m}$ 是扩散矩阵，$W_{t}$ 是一个 $m$ 维布朗运动 (BM)。假设 $b$ 和 $\\sigma$ 有界且一致连续，并满足保证强解存在且唯一的标准增长条件和Lipschitz条件。令 $u:\\mathbb{R}^{n} \\to \\mathbb{R}$ 是一个平稳无限时域折扣控制问题的值函数，其折扣因子为 $\\lambda>0$，运行成本为 $L:\\mathbb{R}^{n}\\times A \\to \\mathbb{R}$，并假设 $u$ 是与上述SDE和控制相关联的平稳Hamilton–Jacobi–Bellman (HJB) 偏微分方程 (PDE) 的一个粘性解。\n\n从动态规划原理(DPP)和Itô公式出发，推导HJB算子中出现的二阶项，并利用此推导研究当扩散协方差矩阵 $\\sigma(x)\\sigma(x)^{\\top}$ 秩亏时的结构性后果。对于一个在 $x$ 点触及 $u$ 的光滑检验函数 $\\varphi$，其Hessian矩阵为 $D^{2}\\varphi(x)=M \\in \\mathbb{S}^{n}$（$n\\times n$ 对称矩阵空间），关注固定点 $x \\in \\mathbb{R}^{n}$ 处的二阶项。\n\n给定两个具体的、秩亏的常数扩散矩阵：\n\n- 示例1（三维状态，二维噪声）：\n$$\n\\sigma_{(1)} \\in \\mathbb{R}^{3\\times 2}, \\quad \\sigma_{(1)} = \\begin{pmatrix}\n1 & 0 \\\\\n0 & 1 \\\\\n0 & 1\n\\end{pmatrix}.\n$$\n\n- 示例2（二维状态，一维噪声）：\n$$\n\\sigma_{(2)} \\in \\mathbb{R}^{2\\times 1}, \\quad \\sigma_{(2)} = \\begin{pmatrix}\n1 \\\\\n0\n\\end{pmatrix}.\n$$\n\n对每个示例，确定在 $x$ 处作用于Hessian矩阵 $M=D^{2}\\varphi(x)$ 的HJB算子的扩散贡献项的显式解析形式，即量\n$$\n\\frac{1}{2}\\,\\mathrm{Tr}\\!\\left(\\sigma_{(i)}\\sigma_{(i)}^{\\top} \\, M\\right),\n$$\n用 $M$ 的元素直接表示，其中 $i\\in\\{1,2\\}$ 且 $M \\in \\mathbb{S}^{n}$ 在对应状态维度下的元素为 $M_{jk}$。\n\n然后，对每个示例，仅使用基本定义和公认事实（Itô公式、动态规划原理和粘性解的定义），推断HJB算子在属于 $\\sigma_{(i)}(x)^{\\top}$ 的核的方向上的结构特性；即解释算子在这些方向上的二阶依赖性发生了什么，以及这如何反映退化椭圆性。\n\n你的最终答案必须是每个示例的扩散贡献项表达式对，使用LaTeX的pmatrix环境排列成一个单行矩阵。无需四舍五入。无需单位。", "solution": "我们首先从动态规划原理(DPP)出发，对平稳HJB方程进行启发式推导，以确定二阶项。令 $u:\\mathbb{R}^{n} \\to \\mathbb{R}$ 为无限时域折扣成本问题的值函数。DPP表明，对于任何时间 $t > 0$ 和任何容许控制过程 $\\{a_s\\}_{s \\ge 0}$，\n$$\nu(x) = \\inf_{a_{\\cdot}} \\mathbb{E}\\left[ \\int_{0}^{t} e^{-\\lambda s} L(X_s, a_s) \\mathrm{d}s + e^{-\\lambda t} u(X_t) \\bigg| X_0=x \\right].\n$$\n这意味着对于一个微小的时间间隔 $h > 0$ 和一个常数控制 $a \\in A$，\n$$\nu(x) \\le \\mathbb{E}\\left[ \\int_{0}^{h} e^{-\\lambda s} L(X_s, a) \\mathrm{d}s + e^{-\\lambda h} u(X_h) \\bigg| X_0=x \\right].\n$$\n假设所涉及的函数足够光滑，我们将积分近似为 $\\int_{0}^{h} e^{-\\lambda s} L(X_s, a) \\mathrm{d}s \\approx L(x,a)h$。为了分析 $e^{-\\lambda h} u(X_h)$ 这一项，我们对过程 $f(t,X_t) = e^{-\\lambda t} u(X_t)$ 应用Itô公式。其随机微分是：\n$$\n\\mathrm{d}(e^{-\\lambda t} u(X_t)) = \\frac{\\partial}{\\partial t}(e^{-\\lambda t} u(X_t)) \\mathrm{d}t + e^{-\\lambda t} Du(X_t)^{\\top} \\mathrm{d}X_t + \\frac{1}{2} e^{-\\lambda t} \\mathrm{Tr}\\left(D^2u(X_t) (\\mathrm{d}X_t)(\\mathrm{d}X_t)^{\\top}\\right).\n$$\n关于时间的偏导数是 $-\\lambda e^{-\\lambda t} u(X_t)$。二次协变差项是 $(\\mathrm{d}X_t)(\\mathrm{d}X_t)^{\\top} = \\sigma(X_t)\\sigma(X_t)^{\\top}\\mathrm{d}t$。将SDE代入 $\\mathrm{d}X_t$ 可得：\n$$\n\\mathrm{d}(e^{-\\lambda t} u(X_t)) = e^{-\\lambda t} \\left[ -\\lambda u(X_t) + Du(X_t)^{\\top}b(X_t,a) + \\frac{1}{2}\\mathrm{Tr}\\left(\\sigma(X_t)\\sigma(X_t)^{\\top}D^2u(X_t)\\right) \\right]\\mathrm{d}t + e^{-\\lambda t}Du(X_t)^{\\top}\\sigma(X_t)\\mathrm{d}W_t.\n$$\n从 $0$ 到 $h$ 积分，并取以 $X_0=x$ 为条件的期望，可以消去鞅项：\n$$\n\\mathbb{E}[e^{-\\lambda h} u(X_h)] - u(x) \\approx \\left[ -\\lambda u(x) + Du(x)^{\\top}b(x,a) + \\frac{1}{2}\\mathrm{Tr}\\left(\\sigma(x)\\sigma(x)^{\\top}D^2u(x)\\right) \\right]h.\n$$\n将此结果和积分近似式代回DPP不等式，得到：\n$$\nu(x) \\le L(x,a)h + u(x) + \\left[ -\\lambda u(x) + Du(x)^{\\top}b(x,a) + \\frac{1}{2}\\mathrm{Tr}\\left(\\sigma(x)\\sigma(x)^{\\top}D^2u(x)\\right) \\right]h + o(h).\n$$\n整理、除以 $h > 0$ 并取 $h \\to 0$ 的极限，可得：\n$$\n0 \\le L(x,a) - \\lambda u(x) + Du(x)^{\\top}b(x,a) + \\frac{1}{2}\\mathrm{Tr}\\left(\\sigma(x)\\sigma(x)^{\\top}D^2u(x)\\right).\n$$\n由于这对任何控制 $a \\in A$ 都成立，并且对于最优控制等号成立，我们对 $a$ 取下确界，从而得到平稳HJB方程：\n$$\n\\lambda u(x) - \\sup_{a \\in A}\\left\\{ -L(x,a) - b(x,a)^{\\top}Du(x) \\right\\} - \\frac{1}{2}\\mathrm{Tr}\\left(\\sigma(x)\\sigma(x)^{\\top}D^2u(x)\\right) = 0.\n$$\n值函数 $u$ 通常不是二次可微的。更稳健的表述是通过粘性解，其中将 $u$ 与光滑的检验函数 $\\varphi$ 进行比较。如果 $u-\\varphi$ 在 $x$ 处有局部极大值（即 $u$ 被 $\\varphi$ 从上方触及），我们有 $Du(x)=D\\varphi(x)$ 并且在矩阵意义下 $D^2u(x) \\le D^2\\varphi(x)$。粘性子解的定义要求：\n$$\n\\lambda\\varphi(x) - \\sup_{a \\in A}\\left\\{ -L(x,a) - b(x,a)^{\\top}D\\varphi(x) \\right\\} - \\frac{1}{2}\\mathrm{Tr}\\left(\\sigma(x)\\sigma(x)^{\\top}D^2\\varphi(x)\\right) \\le 0.\n$$\n对于超解，一个类似的不等式也成立。我们感兴趣的项是HJB算子的扩散贡献项，它作用于检验函数的Hessian矩阵 $M=D^2\\varphi(x)$。该项为 $\\frac{1}{2}\\mathrm{Tr}(\\sigma(x)\\sigma(x)^{\\top}M)$。\n\n我们现在对两个给定的示例分析这一项。\n\n示例1：状态维度 $n=3$，噪声维度 $m=2$。扩散矩阵为\n$$\n\\sigma_{(1)} = \\begin{pmatrix}\n1 & 0 \\\\\n0 & 1 \\\\\n0 & 1\n\\end{pmatrix}.\n$$\n协方差矩阵为 $S_{(1)} = \\sigma_{(1)}\\sigma_{(1)}^{\\top}$：\n$$\nS_{(1)} = \\begin{pmatrix}\n1 & 0 \\\\\n0 & 1 \\\\\n0 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 1\n\\end{pmatrix} = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 1 \\\\\n0 & 1 & 1\n\\end{pmatrix}.\n$$\n令 $M \\in \\mathbb{S}^3$ 为一个元素为 $M_{jk}$ 的 $3 \\times 3$ 对称矩阵。扩散贡献项使用性质 $\\mathrm{Tr}(AB) = \\sum_{j,k} A_{jk} B_{kj}$ 计算。由于 $M$ 是对称的（$M_{kj}=M_{jk}$），这变为 $\\sum_{j,k} (S_{(1)})_{jk} M_{jk}$。\n$$\n\\mathrm{Tr}(S_{(1)}M) = S_{11}M_{11} + S_{22}M_{22} + S_{33}M_{33} + S_{23}M_{32} + S_{32}M_{23}.\n$$\n代入 $S_{(1)}$ 的值并使用 $M_{23}=M_{32}$：\n$$\n\\mathrm{Tr}(S_{(1)}M) = 1 \\cdot M_{11} + 1 \\cdot M_{22} + 1 \\cdot M_{33} + 1 \\cdot M_{32} + 1 \\cdot M_{23} = M_{11} + M_{22} + M_{33} + 2M_{23}.\n$$\n因此，扩散贡献项为：\n$$\n\\frac{1}{2}\\mathrm{Tr}\\left(\\sigma_{(1)}\\sigma_{(1)}^{\\top} M\\right) = \\frac{1}{2}(M_{11} + M_{22} + 2M_{23} + M_{33}).\n$$\n\n示例2：状态维度 $n=2$，噪声维度 $m=1$。扩散矩阵为\n$$\n\\sigma_{(2)} = \\begin{pmatrix}\n1 \\\\\n0\n\\end{pmatrix}.\n$$\n协方差矩阵为 $S_{(2)} = \\sigma_{(2)}\\sigma_{(2)}^{\\top}$：\n$$\nS_{(2)} = \\begin{pmatrix}\n1 \\\\\n0\n\\end{pmatrix}\n\\begin{pmatrix}\n1 & 0\n\\end{pmatrix} = \\begin{pmatrix}\n1 & 0 \\\\\n0 & 0\n\\end{pmatrix}.\n$$\n令 $M \\in \\mathbb{S}^2$ 为一个元素为 $M_{jk}$ 的 $2 \\times 2$ 对称矩阵。\n$$\n\\mathrm{Tr}(S_{(2)}M) = S_{11}M_{11} + S_{22}M_{22} = 1 \\cdot M_{11} + 0 \\cdot M_{22} = M_{11}.\n$$\n扩散贡献项为：\n$$\n\\frac{1}{2}\\mathrm{Tr}\\left(\\sigma_{(2)}\\sigma_{(2)}^{\\top} M\\right) = \\frac{1}{2} M_{11}.\n$$\n\n现在我们研究其结构性后果。HJB方程的椭圆性由矩阵 $\\sigma\\sigma^{\\top}$ 决定。如果此矩阵是正定的，方程是一致椭圆的。如果它是奇异的（秩亏的），方程被称为退化椭圆。这种奇异性意味着扩散仅在状态空间的一个子空间中起作用。$\\sigma^{\\top}$ 的核包含了没有扩散的方向。\n\n对于示例1，$\\mathrm{rank}(S_{(1)}) = 2 < 3$，因此它是奇异的。我们求 $\\sigma_{(1)}^{\\top}$ 的核：\n$$\n\\sigma_{(1)}^{\\top}v = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 1\n\\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\implies\n\\begin{cases}\nv_1 = 0 \\\\\nv_2 + v_3 = 0\n\\end{cases}.\n$$\n核由向量 $v_{\\ker} = (0, 1, -1)^{\\top}$ 张成。HJB算子的二阶项对检验函数 $\\varphi$ 在此方向上的曲率不敏感。要验证这一点，可以考虑一个仅表示该方向曲率的Hessian矩阵 $M = v_{\\ker}v_{\\ker}^{\\top}$：\n$$\nM = \\begin{pmatrix} 0 \\\\ 1 \\\\ -1 \\end{pmatrix}\\begin{pmatrix} 0 & 1 & -1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 1 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix}.\n$$\n这里，$M_{11}=0$，$M_{22}=1$，$M_{33}=1$ 且 $M_{23}=-1$。将此代入我们推导出的扩散贡献项形式中：\n$$\n\\frac{1}{2}(M_{11} + M_{22} + 2M_{23} + M_{33}) = \\frac{1}{2}(0 + 1 + 2(-1) + 1) = 0.\n$$\n这明确表明HJB方程没有与方向 $(0, 1, -1)^{\\top}$ 相关联的二阶导数项。该偏微分方程是退化的；它在此方向上表现得像一个一阶输运方程，而在由 $\\sigma_{(1)}$ 的列（即 $(1,0,0)^{\\top}$ 和 $(0,1,1)^{\\top}$）张成的正交子空间中是二阶的。\n\n对于示例2，$S_{(2)}$ 也是奇异的，其 $\\mathrm{rank}(S_{(2)})=1 < 2$。$\\sigma_{(2)}^{\\top}$ 的核可通过以下方式找到：\n$$\n\\sigma_{(2)}^{\\top}v = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} = 0 \\implies v_1 = 0.\n$$\n核是 $x_2$ 轴，由 $v_{\\ker} = (0, 1)^{\\top}$ 张成。我们推导出的扩散贡献项 $\\frac{1}{2}M_{11}$，即 $\\frac{1}{2}\\frac{\\partial^2\\varphi}{\\partial x_1^2}$，明确地展示了其结构性后果。该项独立于 $M_{22} = \\frac{\\partial^2\\varphi}{\\partial x_2^2}$ 和 $M_{12} = \\frac{\\partial^2\\varphi}{\\partial x_1 \\partial x_2}$。HJB方程在变量 $x_1$ 上是二阶的，但在变量 $x_2$ 上仅为一阶。这反映了底层的SDE仅在第一个分量上有噪声，使得第二个分量的演化完全由漂移项驱动，而这是一个一阶效应。这是退化椭圆性的一个经典案例。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}(M_{11} + M_{22} + 2M_{23} + M_{33}) & \\frac{1}{2}M_{11}\n\\end{pmatrix}\n}\n$$", "id": "3005553"}]}