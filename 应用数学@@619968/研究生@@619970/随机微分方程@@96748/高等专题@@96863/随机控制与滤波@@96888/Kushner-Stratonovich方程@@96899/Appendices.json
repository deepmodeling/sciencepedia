{"hands_on_practices": [{"introduction": "任何概率分布的一个基本性质是其总和（或积分）必须为一。我们将利用Kushner-Stratonovich方程（KSE）来验证演化中的后验分布是否始终保持这一自洽性质。这个练习是熟悉KSE各个组成部分，特别是无穷小生成元 $\\mathcal{L}$ 如何作用于简单函数的一个绝佳方式。[@problem_id:3001883]", "problem": "在一个支持独立维纳过程的概率空间上，考虑一个非线性滤波模型，其中隐状态过程 $X_t \\in \\mathbb{R}^{n}$ 满足随机微分方程 (SDE) $dX_t = a(X_t)\\,dt + \\Sigma(X_t)\\,dW_t$。这里，$a:\\mathbb{R}^{n} \\to \\mathbb{R}^{n}$ 是漂移项，$\\Sigma:\\mathbb{R}^{n} \\to \\mathbb{R}^{n \\times r}$ 是扩散项，$W_t$ 是一个 $\\mathbb{R}^{r}$ 值的标准维纳过程。观测过程 $Y_t \\in \\mathbb{R}^{m}$ 服从 $dY_t = h(X_t)\\,dt + R^{1/2}\\,dV_t$，其中 $h:\\mathbb{R}^{n} \\to \\mathbb{R}^{m}$，$R \\in \\mathbb{R}^{m \\times m}$ 是对称正定矩阵，$V_t$ 是一个与 $W_t$ 独立的 $\\mathbb{R}^{m}$ 值标准维纳过程。令 $\\mathcal{Y}_t$ 表示由 $\\{Y_s: 0 \\le s \\le t\\}$ 生成的 $\\sigma$-代数。对于一个有界的、二次连续可微的测试函数 $\\varphi:\\mathbb{R}^{n} \\to \\mathbb{R}$，定义后验期望为 $\\pi_t(\\varphi) := \\mathbb{E}[\\varphi(X_t)\\mid \\mathcal{Y}_t]$，并令 $\\mathcal{L}$ 表示 $X_t$ 的无穷小生成元，由 $\\mathcal{L}\\varphi(x) := a(x) \\cdot \\nabla \\varphi(x) + \\tfrac{1}{2}\\,\\mathrm{tr}\\!\\left(\\Sigma(x)\\Sigma(x)^{\\top}\\nabla^{2}\\varphi(x)\\right)$ 给出。用于描述 $\\pi_t(\\varphi)$ 演化的 Kushner-Stratonovich 方程 (KSE) 为\n$$\nd\\pi_t(\\varphi) \\;=\\; \\pi_t(\\mathcal{L}\\varphi)\\,dt \\;+\\; \\Big(\\pi_t(\\varphi\\,h^{\\top}) - \\pi_t(\\varphi)\\,\\pi_t(h)^{\\top}\\Big)\\,R^{-1}\\,\\big(dY_t - \\pi_t(h)\\,dt\\big),\n$$\n其中，我们将 $\\pi_t(\\varphi\\,h^{\\top})$ 解释为第 $j$ 个分量为 $\\pi_t(\\varphi\\,h_j)$ 的 $1\\times m$ 行向量，将 $\\pi_t(h)$ 解释为第 $j$ 个分量为 $\\pi_t(h_j)$ 的 $m\\times 1$ 列向量。仅使用上述定义以及条件期望和随机过程生成元的标准性质，通过在 Kushner-Stratonovich 方程中设置测试函数 $\\varphi \\equiv 1$ 来计算随机微分 $d\\pi_t(1)$，并以闭式解析表达式的形式给出最终答案。无需四舍五入，不涉及单位。最终答案必须是单个表达式。", "solution": "目标是通过在给定的 Kushner-Stratonovich 方程 (KSE) 中，将测试函数 $\\varphi$ 设置为常数函数 $\\varphi(x) = 1$，来计算随机微分 $d\\pi_t(1)$。\n\n给定的 KSE 为：\n$$\nd\\pi_t(\\varphi) \\;=\\; \\pi_t(\\mathcal{L}\\varphi)\\,dt \\;+\\; \\Big(\\pi_t(\\varphi\\,h^{\\top}) - \\pi_t(\\varphi)\\,\\pi_t(h)^{\\top}\\Big)\\,R^{-1}\\,\\big(dY_t - \\pi_t(h)\\,dt\\big)\n$$\n我们必须对该方程中的每一项，针对特定的测试函数 $\\varphi(x) = 1$ (对于所有 $x \\in \\mathbb{R}^n$)进行求值。\n\n首先，我们分析包含 $\\pi_t(\\mathcal{L}\\varphi)$ 的漂移项。无穷小生成元 $\\mathcal{L}$ 定义为：\n$$\n\\mathcal{L}\\varphi(x) := a(x) \\cdot \\nabla \\varphi(x) + \\frac{1}{2}\\,\\mathrm{tr}\\!\\left(\\Sigma(x)\\Sigma(x)^{\\top}\\nabla^{2}\\varphi(x)\\right)\n$$\n对于常数函数 $\\varphi(x) = 1$，其梯度（一阶偏导数向量）和其 Hessian 矩阵（二阶偏导数矩阵）均为零。\n具体来说，梯度为：\n$$\n\\nabla\\varphi(x) = \\nabla(1) = 0 \\in \\mathbb{R}^{n}\n$$\nHessian 矩阵为：\n$$\n\\nabla^{2}\\varphi(x) = \\nabla^{2}(1) = \\mathbf{0}_{n \\times n} \\in \\mathbb{R}^{n \\times n}\n$$\n其中 $\\mathbf{0}_{n \\times n}$ 是 $n \\times n$ 零矩阵。\n\n将这些代入作用于 $\\varphi = 1$ 的生成元 $\\mathcal{L}$ 的表达式中，我们得到：\n$$\n\\mathcal{L}1(x) = a(x) \\cdot 0 + \\frac{1}{2}\\,\\mathrm{tr}\\!\\left(\\Sigma(x)\\Sigma(x)^{\\top}\\mathbf{0}_{n \\times n}\\right) = 0 + \\frac{1}{2}\\,\\mathrm{tr}(\\mathbf{0}_{n \\times n}) = 0\n$$\n因此，对于所有的 $x \\in \\mathbb{R}^n$，函数 $\\mathcal{L}1$ 恒等于零。\n\n现在我们可以计算 $\\pi_t(\\mathcal{L}1)$ 项：\n$$\n\\pi_t(\\mathcal{L}1) = \\pi_t(0) = \\mathbb{E}[0 \\mid \\mathcal{Y}_t]\n$$\n根据条件期望的性质，常数的期望值是其本身。因此：\n$$\n\\pi_t(\\mathcal{L}1) = 0\n$$\n这意味着 KSE 的整个漂移部分消失了：\n$$\n\\pi_t(\\mathcal{L}1)\\,dt = 0 \\cdot dt = 0\n$$\n\n接下来，我们分析随机项的系数，它是一个 $1 \\times m$ 行向量：\n$$\n\\mathbf{C}_t(\\varphi) := \\pi_t(\\varphi\\,h^{\\top}) - \\pi_t(\\varphi)\\,\\pi_t(h)^{\\top}\n$$\n我们代入 $\\varphi = 1$：\n$$\n\\mathbf{C}_t(1) = \\pi_t(1 \\cdot h^{\\top}) - \\pi_t(1)\\,\\pi_t(h)^{\\top} = \\pi_t(h^{\\top}) - \\pi_t(1)\\,\\pi_t(h)^{\\top}\n$$\n我们来计算这个表达式中的各项。首先，根据定义，$\\pi_t(1)$ 为：\n$$\n\\pi_t(1) = \\mathbb{E}[1 \\mid \\mathcal{Y}_t] = 1\n$$\n现在，我们考虑向量项。根据题意，$\\pi_t(\\varphi\\,h^{\\top})$ 是一个 $1 \\times m$ 行向量，其第 $j$ 个分量为 $\\pi_t(\\varphi\\,h_j)$。对于 $\\varphi = 1$，$\\pi_t(h^{\\top})$ 的第 $j$ 个分量是 $\\pi_t(1 \\cdot h_j) = \\pi_t(h_j)$。所以，\n$$\n\\pi_t(h^{\\top}) = \\begin{pmatrix} \\pi_t(h_1) & \\pi_t(h_2) & \\cdots & \\pi_t(h_m) \\end{pmatrix}\n$$\n同样根据定义，$\\pi_t(h)$ 是一个 $m \\times 1$ 列向量，其第 $j$ 个分量是 $\\pi_t(h_j)$：\n$$\n\\pi_t(h) = \\begin{pmatrix} \\pi_t(h_1) \\\\ \\pi_t(h_2) \\\\ \\vdots \\\\ \\pi_t(h_m) \\end{pmatrix}\n$$\n对该列向量取转置，得到 $1 \\times m$ 行向量：\n$$\n\\pi_t(h)^{\\top} = \\begin{pmatrix} \\pi_t(h_1) & \\pi_t(h_2) & \\cdots & \\pi_t(h_m) \\end{pmatrix}\n$$\n现在我们可以计算系数向量 $\\mathbf{C}_t(1)$：\n$$\n\\mathbf{C}_t(1) = \\pi_t(h^{\\top}) - \\pi_t(1)\\,\\pi_t(h)^{\\top} = \\pi_t(h^{\\top}) - 1 \\cdot \\pi_t(h)^{\\top} = \\pi_t(h^{\\top}) - \\pi_t(h)^{\\top}\n$$\n由于 $\\pi_t(h^{\\top})$ 和 $\\pi_t(h)^{\\top}$ 是相同的行向量，它们的差是零行向量：\n$$\n\\mathbf{C}_t(1) = \\begin{pmatrix} 0 & 0 & \\cdots & 0 \\end{pmatrix} \\in \\mathbb{R}^{1 \\times m}\n$$\n因此，KSE 中的整个随机项为零：\n$$\n\\mathbf{C}_t(1)\\,R^{-1}\\,\\big(dY_t - \\pi_t(h)\\,dt\\big) = \\begin{pmatrix} 0 & \\cdots & 0 \\end{pmatrix}\\,R^{-1}\\,\\big(dY_t - \\pi_t(h)\\,dt\\big) = 0\n$$\n\n结合漂移项和随机项的结果，我们得到 $\\pi_t(1)$ 的随机微分：\n$$\nd\\pi_t(1) = 0 + 0 = 0\n$$\n这个结果与 $\\pi_t(1)$ 的直接定义是一致的。由于对于所有 $t \\ge 0$，都有 $\\pi_t(1) = \\mathbb{E}[1 \\mid \\mathcal{Y}_t] = 1$，因此过程 $\\pi_t(1)$ 是一个常数过程，其微分必须为零。此计算证实了 KSE 正确地捕捉了这一基本性质。\n因此，$d\\pi_t(1)$ 的闭式解析表达式为 $0$。", "answer": "$$\\boxed{0}$$", "id": "3001883"}, {"introduction": "Kushner-Stratonovich滤波器可以用两种方式来描述：一个是关于条件概率密度的随机偏微分方程（SPDE），另一个是关于测试函数条件期望的随机微分方程（即“弱形式”）。本练习旨在探索这两种表述之间的关键联系。你将直接从密度SPDE推导出弱形式的KSE，这是一个涉及使用伴随算子的关键技巧。[@problem_id:3001901]", "problem": "考虑一个在 $\\mathbb{R}^n$ 上的部分观测扩散，由信号过程 $X_t$ 和观测过程 $Y_t$ 给出：\n$$\n\\mathrm{d}X_t = a(X_t)\\,\\mathrm{d}t + \\Sigma(X_t)\\,\\mathrm{d}B_t,\\qquad \\mathrm{d}Y_t = h(X_t)\\,\\mathrm{d}t + \\mathrm{d}W_t,\n$$\n其中 $B_t$ 和 $W_t$ 是独立的标准布朗运动，$a:\\mathbb{R}^n\\to\\mathbb{R}^n$、$\\Sigma:\\mathbb{R}^n\\to\\mathbb{R}^{n\\times m}$ 和 $h:\\mathbb{R}^n\\to\\mathbb{R}$ 是足够光滑且至多为多项式增长的函数。令 $\\mathcal{L}$ 为 $X_t$ 的无穷小生成元，作用于 $C^2$ 检验函数 $\\varphi$ 上：\n$$\n\\mathcal{L}\\varphi(x) = a(x)\\cdot \\nabla \\varphi(x) + \\tfrac{1}{2}\\,\\mathrm{tr}\\!\\big(\\Sigma(x)\\Sigma(x)^{\\top}\\nabla^2\\varphi(x)\\big),\n$$\n并令 $\\mathcal{L}^*$ 表示其作用于密度上的伴随算子。假设给定观测域流，$X_t$ 的条件分布关于勒贝格测度存在一个密度 $p_t(x)$，且 $p_t$ 满足以下非线性密度随机偏微分方程：\n$$\n\\mathrm{d}p_t(x) = \\mathcal{L}^*p_t(x)\\,\\mathrm{d}t + \\big(h(x)-\\hat h_t\\big)\\,p_t(x)\\,\\big(\\mathrm{d}Y_t - \\hat h_t\\,\\mathrm{d}t\\big),\n$$\n其中 $\\hat h_t := \\int_{\\mathbb{R}^n} h(x)\\,p_t(x)\\,\\mathrm{d}x$。对 $\\varphi\\in C_c^\\infty(\\mathbb{R}^n)$ 定义条件期望算子 $\\pi_t(\\varphi):=\\int_{\\mathbb{R}^n}\\varphi(x)\\,p_t(x)\\,\\mathrm{d}x$，并假设分部积分中的边界项为零，且积分与随机积分的交换由适当的可积性与正则性条件保证。\n\n通过用一个光滑紧支集函数 $\\varphi$ 对该密度随机偏微分方程进行检验，并在 $\\mathbb{R}^n$ 上积分，对于 $\\pi_t(\\varphi)$，以下哪个弱形式演化方程是正确的？\n\nA. $\\mathrm{d}\\pi_t(\\varphi) = \\pi_t(\\mathcal{L}\\varphi)\\,\\mathrm{d}t + \\pi_t(\\varphi h)\\,\\mathrm{d}Y_t - \\pi_t(\\varphi)\\,\\pi_t(h)\\,\\mathrm{d}t.$\n\nB. $\\mathrm{d}\\pi_t(\\varphi) = \\pi_t(\\mathcal{L}\\varphi)\\,\\mathrm{d}t + \\big(\\pi_t(\\varphi h)-\\pi_t(\\varphi)\\pi_t(h)\\big)\\,\\mathrm{d}Y_t.$\n\nC. $\\mathrm{d}\\pi_t(\\varphi) = \\pi_t(\\mathcal{L}\\varphi)\\,\\mathrm{d}t + \\big(\\pi_t(\\varphi h)-\\pi_t(\\varphi)\\pi_t(h)\\big)\\,\\big(\\mathrm{d}Y_t - \\pi_t(h)\\,\\mathrm{d}t\\big).$\n\nD. $\\mathrm{d}\\pi_t(\\varphi) = \\pi_t(\\mathcal{L}^*\\varphi)\\,\\mathrm{d}t + \\big(\\pi_t(\\varphi h)-\\pi_t(h)\\big)\\,\\big(\\mathrm{d}Y_t - \\pi_t(h)\\,\\mathrm{d}t\\big).$\n\nE. $\\mathrm{d}\\pi_t(\\varphi) = \\pi_t(\\mathcal{L}\\varphi)\\,\\mathrm{d}t + \\pi_t(\\varphi h)\\,\\big(\\mathrm{d}Y_t - \\pi_t(h)\\,\\mathrm{d}t\\big).$", "solution": "### 步骤 1：提取已知条件\n\n问题提供了以下信息：\n1.  一个在 $\\mathbb{R}^n$ 上的信号过程 $X_t$，由以下随机微分方程（SDE）控制：\n    $$\n    \\mathrm{d}X_t = a(X_t)\\,\\mathrm{d}t + \\Sigma(X_t)\\,\\mathrm{d}B_t\n    $$\n2.  一个在 $\\mathbb{R}$ 上的观测过程 $Y_t$，由以下 SDE 控制：\n    $$\n    \\mathrm{d}Y_t = h(X_t)\\,\\mathrm{d}t + \\mathrm{d}W_t\n    $$\n3.  $B_t$ 和 $W_t$ 是独立的标准布朗运动。维度指定为 $a:\\mathbb{R}^n\\to\\mathbb{R}^n$、$ \\Sigma:\\mathbb{R}^n\\to\\mathbb{R}^{n\\times m}$ 和 $h:\\mathbb{R}^n\\to\\mathbb{R}$。\n4.  函数 $a$、$\\Sigma$ 和 $h$ 足够光滑，且至多为多项式增长。\n5.  $X_t$ 的无穷小生成元是 $\\mathcal{L}$，对 $C^2$ 函数 $\\varphi$ 定义为：\n    $$\n    \\mathcal{L}\\varphi(x) = a(x)\\cdot \\nabla \\varphi(x) + \\tfrac{1}{2}\\,\\mathrm{tr}\\!\\big(\\Sigma(x)\\Sigma(x)^{\\top}\\nabla^2\\varphi(x)\\big)\n    $$\n6.  给定观测域流，$X_t$ 的条件分布有一个密度 $p_t(x)$，它满足 Kushner-Stratonovich 方程：\n    $$\n    \\mathrm{d}p_t(x) = \\mathcal{L}^*p_t(x)\\,\\mathrm{d}t + \\big(h(x)-\\hat h_t\\big)\\,p_t(x)\\,\\big(\\mathrm{d}Y_t - \\hat h_t\\,\\mathrm{d}t\\big)\n    $$\n    其中 $\\mathcal{L}^*$ 是 $\\mathcal{L}$ 的伴随算子。\n7.  $h(X_t)$ 的条件期望定义为 $\\hat h_t := \\int_{\\mathbb{R}^n} h(x)\\,p_t(x)\\,\\mathrm{d}x$。\n8.  条件期望算子 $\\pi_t$ 对检验函数 $\\varphi\\in C_c^\\infty(\\mathbb{R}^n)$ 定义为 $\\pi_t(\\varphi):=\\int_{\\mathbb{R}^n}\\varphi(x)\\,p_t(x)\\,\\mathrm{d}x$。\n9.  做出了关键假设：分部积分时边界项为零，且允许交换积分与随机积分的顺序。\n\n问题是推导 $\\pi_t(\\varphi)$ 的弱形式演化方程。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n问题陈述描述了非线性滤波理论中的一个标准设置。\n- **科学上合理（关键）**：该问题坚实地植根于随机过程和滤波的数学理论。信号和观测过程的 SDE、生成元 $\\mathcal{L}$ 的定义，以及条件密度 $p_t(x)$ 的 Kushner-Stratonovich SPDE 都是该领域的标准和正确表述。没有违反任何科学或数学定律。\n- **适定的**：该问题要求从一个给定的 SPDE 推导一个特定的 SDE，这是一个明确定义的数学任务。所提供的假设（光滑性、增长条件、边界项为零等）正是确保形式化操作有效并得出唯一结果所必需的。\n- **客观的（关键）**：语言精确、数学化，没有任何主观性或模糊性。所有术语在随机分析文献中都是标准的。\n\n该问题没有表现出任何无效性缺陷：\n1.  **科学或事实上的不健全**：该设置是滤波理论的基石。\n2.  **无法形式化或不相关**：该问题是在指定主题内的直接数学推导。\n3.  **不完整或矛盾的设置**：设置是完整且自洽的。必要的技术假设已明确说明。\n4.  **不切实际或不可行**：该数学模型是一个抽象，但它是一个标准的、广泛用于现实系统的模型。\n5.  **不适定或结构不良**：任务定义明确，并能导出一个唯一答案。\n6.  **伪深刻、平凡或同义反复**：该推导并非平凡，需要正确应用 Itô 积分、伴随算子的性质以及条件期望的定义。\n7.  **超出科学可验证性范围**：该推导是一个数学证明，并且完全可验证。\n\n### 步骤 3：结论与行动\n\n问题陈述是有效的。我将继续进行求解。\n\n### $\\pi_t(\\varphi)$ 的 SDE 推导\n\n我们要寻找微分 $\\mathrm{d}\\pi_t(\\varphi)$。从 $\\pi_t(\\varphi)$ 的定义开始：\n$$\n\\pi_t(\\varphi) = \\int_{\\mathbb{R}^n} \\varphi(x) p_t(x) \\mathrm{d}x\n$$\n我们取随机微分。根据问题中我们可以交换微分与积分顺序的假设，我们有：\n$$\n\\mathrm{d}\\pi_t(\\varphi) = \\mathrm{d} \\left( \\int_{\\mathbb{R}^n} \\varphi(x) p_t(x) \\mathrm{d}x \\right) = \\int_{\\mathbb{R}^n} \\varphi(x) \\mathrm{d}p_t(x) \\mathrm{d}x\n$$\n现在，我们将给定的 Kushner-Stratonovich SPDE 代入 $\\mathrm{d}p_t(x)$：\n$$\n\\mathrm{d}\\pi_t(\\varphi) = \\int_{\\mathbb{R}^n} \\varphi(x) \\left[ \\mathcal{L}^*p_t(x)\\,\\mathrm{d}t + \\big(h(x)-\\hat h_t\\big)\\,p_t(x)\\,\\big(\\mathrm{d}Y_t - \\hat h_t\\,\\mathrm{d}t\\big) \\right] \\mathrm{d}x\n$$\n我们可以将其分为两项：一项涉及 $\\mathrm{d}t$（漂移项），另一项涉及新息过程 $(\\mathrm{d}Y_t - \\hat h_t\\,\\mathrm{d}t)$。\n$$\n\\mathrm{d}\\pi_t(\\varphi) = \\left( \\int_{\\mathbb{R}^n} \\varphi(x) \\mathcal{L}^*p_t(x) \\mathrm{d}x \\right) \\mathrm{d}t + \\left( \\int_{\\mathbb{R}^n} \\varphi(x) \\big(h(x)-\\hat h_t\\big)\\,p_t(x) \\mathrm{d}x \\right) \\big(\\mathrm{d}Y_t - \\hat h_t\\,\\mathrm{d}t\\big)\n$$\n让我们分别分析每个积分。\n\n1.  **漂移项**：第一个积分是 $\\int_{\\mathbb{R}^n} \\varphi(x) \\mathcal{L}^*p_t(x) \\mathrm{d}x$。\n    根据伴随算子 $\\mathcal{L}^*$ 的定义，并利用分部积分的边界项为零的假设（因为 $\\varphi$ 具有紧支集），我们可以将算子从 $p_t$ 移到 $\\varphi$ 上：\n    $$\n    \\int_{\\mathbb{R}^n} \\varphi(x) (\\mathcal{L}^*p_t)(x) \\mathrm{d}x = \\int_{\\mathbb{R}^n} (\\mathcal{L}\\varphi)(x) p_t(x) \\mathrm{d}x\n    $$\n    根据定义，右侧是 $\\mathcal{L}\\varphi(X_t)$ 的条件期望，即 $\\pi_t(\\mathcal{L}\\varphi)$。因此，来自信号动态的漂移项是 $\\pi_t(\\mathcal{L}\\varphi)\\mathrm{d}t$。\n\n2.  **随机项**：随机部分的系数是积分 $\\int_{\\mathbb{R}^n} \\varphi(x) \\big(h(x)-\\hat h_t\\big)\\,p_t(x) \\mathrm{d}x$。我们展开被积函数：\n    $$\n    \\int_{\\mathbb{R}^n} \\left( \\varphi(x)h(x) - \\varphi(x)\\hat h_t \\right) p_t(x) \\mathrm{d}x\n    $$\n    由于 $\\hat h_t$ 是一个不依赖于积分变量 $x$ 的标量，我们可以将其从第二个积分中提出：\n    $$\n    \\int_{\\mathbb{R}^n} \\varphi(x)h(x) p_t(x) \\mathrm{d}x - \\hat h_t \\int_{\\mathbb{R}^n} \\varphi(x) p_t(x) \\mathrm{d}x\n    $$\n    使用算子 $\\pi_t$ 的定义，这变为：\n    $$\n    \\pi_t(\\varphi h) - \\hat h_t \\pi_t(\\varphi)\n    $$\n    问题还给出了定义 $\\hat h_t = \\int_{\\mathbb{R}^n} h(x)\\,p_t(x)\\,\\mathrm{d}x$，这正是 $\\pi_t(h)$。代入此式，随机项的系数为：\n    $$\n    \\pi_t(\\varphi h) - \\pi_t(\\varphi)\\pi_t(h)\n    $$\n    此项是在给定观测历史的情况下，$\\varphi(X_t)$ 和 $h(X_t)$ 的条件协方差。\n\n综合各部分，$\\pi_t(\\varphi)$ 的完整 SDE 为：\n$$\n\\mathrm{d}\\pi_t(\\varphi) = \\pi_t(\\mathcal{L}\\varphi)\\,\\mathrm{d}t + \\big(\\pi_t(\\varphi h)-\\pi_t(\\varphi)\\pi_t(h)\\big)\\,\\big(\\mathrm{d}Y_t - \\pi_t(h)\\,\\mathrm{d}t\\big)\n$$\n这个方程是滤波理论中的一个基本结果，其非归一化形式通常称为 Zakai 方程，但这里呈现的是归一化条件期望的形式。\n\n### 逐项分析选项\n\n现在，我们将每个给定选项与我们推导出的结果进行比较。\n\n- **选项 A**: $\\mathrm{d}\\pi_t(\\varphi) = \\pi_t(\\mathcal{L}\\varphi)\\,\\mathrm{d}t + \\pi_t(\\varphi h)\\,\\mathrm{d}Y_t - \\pi_t(\\varphi)\\,\\pi_t(h)\\,\\mathrm{d}t.$\n  如果我们展开此选项，$\\mathrm{d}Y_t$ 的系数是 $\\pi_t(\\varphi h)$，这是不正确的。正确的系数是 $\\pi_t(\\varphi h) - \\pi_t(\\varphi)\\pi_t(h)$。与我们推导的方程完全展开形式相比，漂移项也是不正确的。**不正确**。\n\n- **选项 B**: $\\mathrm{d}\\pi_t(\\varphi) = \\pi_t(\\mathcal{L}\\varphi)\\,\\mathrm{d}t + \\big(\\pi_t(\\varphi h)-\\pi_t(\\varphi)\\pi_t(h)\\big)\\,\\mathrm{d}Y_t.$\n  此选项的随机项系数正确，但随机积分是关于 $\\mathrm{d}Y_t$ 的，而不是关于新息过程 $\\mathrm{d}Y_t - \\pi_t(h)\\,\\mathrm{d}t$。它缺少了由 $-\\pi_t(h)\\,\\mathrm{d}t$ 产生的漂移修正项。**不正确**。\n\n- **选项 C**: $\\mathrm{d}\\pi_t(\\varphi) = \\pi_t(\\mathcal{L}\\varphi)\\,\\mathrm{d}t + \\big(\\pi_t(\\varphi h)-\\pi_t(\\varphi)\\pi_t(h)\\big)\\,\\big(\\mathrm{d}Y_t - \\pi_t(h)\\,\\mathrm{d}t\\big).$\n  此方程与我们推导的结果完全匹配。它正确地确定了漂移部分 $\\pi_t(\\mathcal{L}\\varphi)$、条件协方差项 $\\pi_t(\\varphi h)-\\pi_t(\\varphi)\\pi_t(h)$ 和新息过程微分 $\\mathrm{d}Y_t - \\pi_t(h)\\,\\mathrm{d}t$。**正确**。\n\n- **选项 D**: $\\mathrm{d}\\pi_t(\\varphi) = \\pi_t(\\mathcal{L}^*\\varphi)\\,\\mathrm{d}t + \\big(\\pi_t(\\varphi h)-\\pi_t(h)\\big)\\,\\big(\\mathrm{d}Y_t - \\pi_t(h)\\,\\mathrm{d}t\\big).$\n  此选项有两个错误。首先，漂移项是 $\\pi_t(\\mathcal{L}^*\\varphi)$，这是由于未能正确使用伴随性质将算子移到 $\\varphi$ 上而导致的。正确的项是 $\\pi_t(\\mathcal{L}\\varphi)$。其次，协方差项写为 $\\pi_t(\\varphi h)-\\pi_t(h)$，这缺少了一个因子 $\\pi_t(\\varphi)$，并且通常是不正确的。**不正确**。\n\n- **选项 E**: $\\mathrm{d}\\pi_t(\\varphi) = \\pi_t(\\mathcal{L}\\varphi)\\,\\mathrm{d}t + \\pi_t(\\varphi h)\\,\\big(\\mathrm{d}Y_t - \\pi_t(h)\\,\\mathrm{d}t\\big).$\n  此选项有正确的漂移项 $\\pi_t(\\mathcal{L}\\varphi)$ 和正确的新息过程微分。然而，随机项的系数被给出为 $\\pi_t(\\varphi h)$，这缺少了减去 $\\pi_t(\\varphi)\\pi_t(h)$ 的部分。如推导所示，正确的系数是条件协方差 $\\pi_t(\\varphi h)-\\pi_t(\\varphi)\\pi_t(h)$。**不正确**。", "answer": "$$\\boxed{C}$$", "id": "3001901"}, {"introduction": "现在，我们将抽象的理论应用于一个具体而至关重要的例子：线性高斯模型，它导出了著名的卡尔曼-布西滤波器。这个练习将展示普适的KSE和Zakai方程如何具体化，从而得出众所周知的条件均值和方差的递归方程。这是将强大的普适理论应用于实际场景，从而加深理解的完美方式。[@problem_id:3001892]", "problem": "考虑以下标量连续时间隐参数模型。设隐藏状态是时不变的，满足 $dX_t = 0$，其中 $X_0 \\sim \\mathcal{N}(m_0, P_0)$，$m_0 \\in \\mathbb{R}$ 且 $P_0 > 0$。观测过程满足\n$$\ndY_t = h X_t \\, dt + \\sigma \\, dV_t, \\quad Y_0 = 0,\n$$\n其中 $h \\in \\mathbb{R}$ 已知，$\\sigma > 0$ 已知，且 $\\{V_t\\}_{t \\ge 0}$ 是一个独立于 $X_0$ 的标准维纳过程。固定一个确定的时间域 $T > 0$，并假设观测到的终端值 $Y_T$ 等于 $y_T \\in \\mathbb{R}$。\n\n从条件期望、新息过程以及在连续时间贝叶斯滤波中使用的 Radon-Nikodym 似然的基本定义出发，完成以下任务：\n\n- 使用 Kushner-Stratonovich 方程（KSE）的观点，对测试函数 $\\varphi(x) = x$ 推导后验均值 $m_T = \\mathbb{E}[X_T \\mid \\mathcal{Y}_T]$，其中 $\\mathcal{Y}_t$ 表示由 $\\{Y_s: 0 \\le s \\le t\\}$ 生成的 $\\sigma$-代数。\n- 独立地，使用 Zakai 方程（通过 Kallianpur-Striebel 似然表示的视角）推导非归一化条件密度，将其归一化以获得后验，并计算后验均值 $m_T$。\n- 简要解释为什么在此模型中，这两种推导方法必然得到相同的结果。\n\n你的最终答案必须是关于 $m_T$ 的一个单一闭式解析表达式，用 $m_0$、$P_0$、$h$、$\\sigma$、$T$ 和 $y_T$ 表示。不要四舍五入。不要包含单位。", "solution": "所提出的问题是连续时间非线性滤波中的一个标准的、适定的问题，具体来说是针对线性高斯系统。它具有科学依据，是自洽且客观的。所有必要的参数和条件都已给出，且没有矛盾。因此，我们可以着手求解。\n\n问题要求用两种不同的方法推导后验均值 $m_T = \\mathbb{E}[X_T \\mid \\mathcal{Y}_T]$，并解释为什么结果会一致。模型由以下公式给出：\n状态过程：$dX_t = 0$，其中 $X_0 \\sim \\mathcal{N}(m_0, P_0)$。这意味着对于所有 $t \\ge 0$，$X_t = X_0$。\n观测过程：$dY_t = h X_t \\, dt + \\sigma \\, dV_t$，其中 $Y_0=0$。\n\n### 1. 通过 Kushner-Stratonovich 方程（KSE）推导\n\nKushner-Stratonovich 方程描述了对于一个合适的测试函数 $\\varphi$，条件期望 $\\pi_t(\\varphi) = \\mathbb{E}[\\varphi(X_t) \\mid \\mathcal{Y}_t]$ 的演化。其一般形式为：\n$$ d\\pi_t(\\varphi) = \\pi_t(\\mathcal{L}\\varphi) dt + \\frac{1}{\\sigma^2} \\left( \\pi_t(\\varphi H) - \\pi_t(\\varphi)\\pi_t(H) \\right) [dY_t - \\pi_t(H) dt] $$\n其中 $\\mathcal{L}$ 是状态过程 $X_t$ 的生成元，$H(x)$ 是观测函数。\n\n对于我们的问题：\n- 状态过程为 $dX_t = 0$，因此生成元 $\\mathcal{L}$ 是零算子，$\\mathcal{L}=0$。\n- 观测函数为 $H(X_t) = h X_t$。\n- 我们关心的是条件均值 $m_t = \\mathbb{E}[X_t \\mid \\mathcal{Y}_t]$，这对应于选择测试函数 $\\varphi(x) = x$。\n\n让我们计算 KSE 中 $\\varphi(x)=x$ 的各项：\n- $\\pi_t(\\varphi) = \\pi_t(x) = \\mathbb{E}[X_t \\mid \\mathcal{Y}_t] = m_t$。\n- $\\pi_t(\\mathcal{L}\\varphi) = \\pi_t(\\mathcal{L}x) = \\pi_t(0) = 0$。\n- $\\pi_t(H) = \\pi_t(hx) = h\\pi_t(x) = h m_t$。\n- $\\pi_t(\\varphi H) = \\pi_t(x \\cdot hx) = h\\pi_t(x^2) = h \\mathbb{E}[X_t^2 \\mid \\mathcal{Y}_t]$。\n\n项 $\\mathbb{E}[X_t^2 \\mid \\mathcal{Y}_t] - (\\mathbb{E}[X_t \\mid \\mathcal{Y}_t])^2$ 是 $X_t$ 的条件方差，我们记为 $P_t = \\text{Var}(X_t \\mid \\mathcal{Y}_t)$。因此，$\\mathbb{E}[X_t^2 \\mid \\mathcal{Y}_t] = P_t + m_t^2$。\n项 $\\pi_t(\\varphi H) - \\pi_t(\\varphi)\\pi_t(H)$ 变为 $h\\mathbb{E}[X_t^2 \\mid \\mathcal{Y}_t] - m_t(h m_t) = h(P_t + m_t^2) - h m_t^2 = h P_t$。\n新息过程为 $dI_t = dY_t - \\pi_t(H)dt = dY_t - h m_t dt$。\n\n将这些代入 KSE，得到条件均值 $m_t$ 的随机微分方程（SDE）：\n$$ dm_t = \\frac{h P_t}{\\sigma^2} (dY_t - h m_t dt) $$\n这是关于均值的 Kalman-Bucy 滤波方程。为了解这个方程，我们需要条件方差 $P_t$ 的演化。对于线性高斯系统，$P_t$ 的方程是确定性的 Riccati 微分方程：\n$$ \\frac{dP_t}{dt} = A P_t + P_t A^T - P_t C^T (D D^T)^{-1} C P_t + B B^T $$\n在我们的标量案例中，状态动态 $dX_t = 0 \\cdot X_t dt + 0 \\cdot dW_t$ 给出 $A=0$ 和 $B=0$。观测动态 $dY_t = h X_t dt + \\sigma dV_t$ 给出 $C=h$ 和 $D=\\sigma$。Riccati 方程简化为：\n$$ \\frac{dP_t}{dt} = -P_t h (\\sigma^2)^{-1} h P_t = -\\frac{h^2}{\\sigma^2} P_t^2 $$\n这是一个初始条件为 $P(0) = P_0$ 的可分离常微分方程。我们求解它：\n$$ \\int_{P_0}^{P_T} \\frac{dP}{P^2} = -\\int_0^T \\frac{h^2}{\\sigma^2} dt \\implies \\left[-\\frac{1}{P}\\right]_{P_0}^{P_T} = -\\frac{h^2 T}{\\sigma^2} \\implies -\\frac{1}{P_T} + \\frac{1}{P_0} = -\\frac{h^2 T}{\\sigma^2} $$\n求解 $P_T$ 得到：\n$$ \\frac{1}{P_T} = \\frac{1}{P_0} + \\frac{h^2 T}{\\sigma^2} = \\frac{\\sigma^2 + P_0 h^2 T}{P_0 \\sigma^2} \\implies P_T = \\frac{P_0 \\sigma^2}{\\sigma^2 + P_0 h^2 T} $$\n现在，我们求解 $m_t$ 的 SDE：\n$$ dm_t + \\frac{h^2 P_t}{\\sigma^2} m_t dt = \\frac{h P_t}{\\sigma^2} dY_t $$\n令 $a(t) = \\frac{h^2 P_t}{\\sigma^2} = \\frac{h^2 P_0}{\\sigma^2 + P_0 h^2 t}$。积分因子为 $\\mu(t) = \\exp\\left(\\int_0^t a(s) ds\\right)$。\n$$ \\int_0^t a(s) ds = \\int_0^t \\frac{h^2 P_0}{\\sigma^2 + P_0 h^2 s} ds = \\left[ \\ln(\\sigma^2 + P_0 h^2 s) \\right]_0^t = \\ln\\left(\\frac{\\sigma^2 + P_0 h^2 t}{\\sigma^2}\\right) $$\n所以，$\\mu(t) = \\frac{\\sigma^2 + P_0 h^2 t}{\\sigma^2}$。使用 Itô 乘积法则，$d(\\mu_t m_t) = \\mu_t dm_t + m_t d\\mu_t = \\mu_t(dm_t + a(t)m_t dt)$。\n$$ d(\\mu_t m_t) = \\mu_t \\left( \\frac{h P_t}{\\sigma^2} dY_t \\right) = \\left(\\frac{\\sigma^2 + P_0 h^2 t}{\\sigma^2}\\right) \\left(\\frac{h}{\\sigma^2}\\frac{P_0 \\sigma^2}{\\sigma^2 + P_0 h^2 t}\\right) dY_t = \\frac{h P_0}{\\sigma^2} dY_t $$\n从 $t=0$ 到 $t=T$ 积分：\n$$ \\mu_T m_T - \\mu_0 m_0 = \\int_0^T \\frac{h P_0}{\\sigma^2} dY_t = \\frac{h P_0}{\\sigma^2} (Y_T - Y_0) $$\n由于 $Y_T = y_T$，$Y_0=0$ 且 $\\mu_0 = 1$，我们得到：\n$$ \\left(\\frac{\\sigma^2 + P_0 h^2 T}{\\sigma^2}\\right) m_T - m_0 = \\frac{h P_0 y_T}{\\sigma^2} $$\n$$ m_T = \\frac{\\sigma^2}{\\sigma^2 + P_0 h^2 T} \\left( m_0 + \\frac{h P_0 y_T}{\\sigma^2} \\right) = \\frac{m_0 \\sigma^2 + P_0 h y_T}{\\sigma^2 + P_0 h^2 T} $$\n\n### 2. 通过 Zakai 方程推导\n\nZakai 方程给出了非归一化条件密度 $\\rho_t(x)$ 的演化。使用它的一种实用方法是通过 Kallianpur-Striebel 公式，该公式将非归一化后验表示为先验密度与通过测度变换得到的似然项的乘积。$T$ 时刻的非归一化后验密度由 $\\rho_T(x) = L_T(x) p_0(x)$ 给出，其中 $p_0(x)$ 是 $X_0$ 的先验密度，$L_T(x)$ 是 Radon-Nikodym 导数（似然）。\n对于我们的系统，这个似然项是：\n$$ L_T(x) = \\exp\\left( \\int_0^T \\frac{H(x)}{\\sigma^2} dY_s - \\frac{1}{2} \\int_0^T \\frac{H(x)^2}{\\sigma^2} ds \\right) $$\n给定 $H(x) = hx$ 且 $x$ 在区间 $[0, T]$ 上为常数，这变为：\n$$ L_T(x) = \\exp\\left( \\frac{hx}{\\sigma^2} \\int_0^T dY_s - \\frac{1}{2}\\frac{h^2x^2}{\\sigma^2} \\int_0^T ds \\right) = \\exp\\left( \\frac{h x Y_T}{\\sigma^2} - \\frac{h^2 x^2 T}{2\\sigma^2} \\right) $$\n先验为 $X_0 \\sim \\mathcal{N}(m_0, P_0)$，因此 $p_0(x) = (\\sqrt{2\\pi P_0})^{-1} \\exp\\left(-\\frac{(x-m_0)^2}{2P_0}\\right)$。\n给定观测值 $Y_T = y_T$，非归一化后验密度为：\n$$ \\rho_T(x) \\propto \\exp\\left( \\frac{h x y_T}{\\sigma^2} - \\frac{h^2 x^2 T}{2\\sigma^2} \\right) \\exp\\left(-\\frac{(x-m_0)^2}{2P_0}\\right) $$\n后验均值 $m_T$ 是此密度归一化后的均值。由于该密度与一个关于 $x$ 的二次式的指数成正比，因此后验是高斯分布，记为 $\\mathcal{N}(m_T, P_T)$。我们可以通过在指数中配方来找到其参数。设指数为 $J(x)$：\n$$ J(x) = \\frac{h x y_T}{\\sigma^2} - \\frac{h^2 x^2 T}{2\\sigma^2} - \\frac{x^2 - 2xm_0 + m_0^2}{2P_0} $$\n$$ J(x) = -\\frac{1}{2} x^2 \\left(\\frac{h^2 T}{\\sigma^2} + \\frac{1}{P_0}\\right) + x \\left(\\frac{h y_T}{\\sigma^2} + \\frac{m_0}{P_0}\\right) - \\frac{m_0^2}{2 P_0} $$\n高斯分布 $\\mathcal{N}(m_T, P_T)$ 的密度正比于 $\\exp\\left(-\\frac{(x-m_T)^2}{2P_T}\\right) = \\exp\\left(-\\frac{1}{2P_T}x^2 + \\frac{m_T}{P_T}x - \\frac{m_T^2}{2P_T}\\right)$。\n通过比较 $x$ 和 $x^2$ 项的系数，我们找到后验精度 $1/P_T$ 和均值 $m_T$：\n- 从 $x^2$ 项得到：$\\frac{1}{P_T} = \\frac{h^2 T}{\\sigma^2} + \\frac{1}{P_0}$。（这与 Riccati 的结果相符）。\n- 从 $x$ 项得到：$\\frac{m_T}{P_T} = \\frac{h y_T}{\\sigma^2} + \\frac{m_0}{P_0}$。\n\n求解 $m_T$：\n$$ m_T = P_T \\left( \\frac{h y_T}{\\sigma^2} + \\frac{m_0}{P_0} \\right) $$\n代入 $P_T = \\left(\\frac{1}{P_0} + \\frac{h^2 T}{\\sigma^2}\\right)^{-1} = \\frac{P_0 \\sigma^2}{\\sigma^2 + P_0 h^2 T}$：\n$$ m_T = \\left( \\frac{P_0 \\sigma^2}{\\sigma^2 + P_0 h^2 T} \\right) \\left( \\frac{h y_T P_0 + m_0 \\sigma^2}{P_0 \\sigma^2} \\right) $$\n$$ m_T = \\frac{m_0 \\sigma^2 + P_0 h y_T}{\\sigma^2 + P_0 h^2 T} $$\n这个结果与通过 Kushner-Stratonovich 方程得到的结果完全相同。\n\n### 3. 推导的一致性\n\nKushner-Stratonovich 方程和 Zakai 方程是描述滤波问题中条件分布演化的两种不同但本质上等价的数学形式。\n- **Zakai 方程** 描述了*非归一化*条件密度 $\\rho_t(x)$ 的演化。其主要优点是它是一个线性（但随机的）偏微分方程，通常更易于分析。这种线性是通过概率测度变换（Girsanov 变换）实现的。\n- **Kushner-Stratonovich 方程** 描述了*归一化*条件期望 $\\pi_t(\\varphi)$ 或密度 $\\pi_t(x)$ 的演化。这才是直接具有物理意义的量。然而，由于条件期望定义中固有的归一化，KSE 是非线性的。\n\n归一化后验是非归一化后验与其总质量之比：$\\pi_t(\\varphi) = \\int \\varphi(x) \\rho_t(x) dx / \\int \\rho_t(x) dx$。通过对此表达式应用随机版本的比率链式法则（Itô 引理的扩展），可以从 Zakai 方程正式推导出 KSE。这表明它们是同一潜在概率对象的数学上一致的描述。由于这个线性高斯模型的滤波问题是适定的，并且其后验分布有唯一解，任何有效的推导方法，包括 KSE 和 Zakai 方法，都必须得出相同的结果。对于线性高斯系统，两种方法最终都得到关于均值和方差的 Kalman-Bucy 滤波方程。", "answer": "$$\\boxed{\\frac{m_0 \\sigma^2 + P_0 h y_T}{\\sigma^2 + P_0 h^2 T}}$$", "id": "3001892"}]}