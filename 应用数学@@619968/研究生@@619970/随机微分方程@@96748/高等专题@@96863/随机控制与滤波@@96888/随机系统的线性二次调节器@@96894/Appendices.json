{"hands_on_practices": [{"introduction": "在设计最优控制器之前，一个基本技能是评估给定控制策略的性能。本练习将引导你完成这一关键分析过程。我们将应用伊藤引理（Itô's lemma）来推导系统状态二阶矩（second moment）$ \\mathbb{E}[x_t^2] $的动态演化方程，这是分析随机系统平均行为的核心技术。通过精确计算有限时间范围内的预期成本，你将深入理解系统参数、噪声强度和控制增益如何共同影响系统的整体性能。[@problem_id:2984737]", "problem": "考虑一个标量线性随机微分方程 (SDE)，该方程为一个在线性二次调节器 (LQR) 状态反馈律下运行的受控对象建模：\n$$\ndx_t = a x_t dt + b u_t dt + \\sigma dW_t,\n$$\n其中 $W_t$ 是一个标准维纳过程（标准布朗运动）。我们应用了由一个预先计算的线性二次调节器 (LQR) 提供的恒定状态反馈控制 $u_t = -k x_t$。初始条件是随机的，服从 $x_0 \\sim \\mathcal{N}(m_0, v_0)$，因此 $x_0$ 的均值为 $m_0$，方差为 $v_0$。有限时域二次状态成本为\n$$\nJ_Q = \\mathbb{E}\\left[\\int_{0}^{T} x_t^\\top Q x_t \\, dt\\right],\n$$\n在标量情况下，$Q = q > 0$，所以 $x_t^\\top Q x_t = q x_t^2$。\n\n从 Itô 积分的基本定义和性质以及线性 SDE 的基本矩出发，对以下具体参数值，解析地推导并计算期望 $J_Q$：\n$$\na = 0.75,\\quad b = 1.2,\\quad k = 1.5,\\quad \\sigma = 0.9,\\quad q = 2.5,\\quad T = 1.8,\n$$\n及\n$$\nm_0 = 0.6,\\quad v_0 = 0.4.\n$$\n您的答案必须是等于 $J_Q$ 的单个实数，并四舍五入到四位有效数字。无需单位。", "solution": "系统动态由以下标量线性随机微分方程 (SDE) 描述：\n$$\ndx_t = a x_t dt + b u_t dt + \\sigma dW_t\n$$\n状态反馈律由 $u_t = -k x_t$ 给出。将其代入 SDE，得到闭环系统动态：\n$$\ndx_t = (a - bk)x_t dt + \\sigma dW_t\n$$\n这是一个 Ornstein-Uhlenbeck 过程。我们定义闭环漂移系数为 $\\alpha = a - bk$。该 SDE 变为：\n$$\ndx_t = \\alpha x_t dt + \\sigma dW_t\n$$\n需要计算的成本泛函为：\n$$\nJ_Q = \\mathbb{E}\\left[\\int_{0}^{T} q x_t^2 \\, dt\\right]\n$$\n其中 $q$ 是一个正数。根据随机过程的 Fubini-Tonelli 定理，由于被积函数是非负的，我们可以交换期望和积分的顺序：\n$$\nJ_Q = q \\int_{0}^{T} \\mathbb{E}[x_t^2] \\, dt\n$$\n问题的核心是确定状态的二阶矩 $\\mathbb{E}[x_t^2]$ 作为时间 $t$ 的函数。我们记 $S_t = \\mathbb{E}[x_t^2]$。我们可以使用 Itô 引理推导出关于 $S_t$ 的常微分方程 (ODE)。\n\n设 $f(x) = x^2$。所需的导数为 $f'(x) = 2x$ 和 $f''(x) = 2$。根据 Itô 引理，$f(x_t)$ 的微分为：\n$$\ndf(x_t) = f'(x_t) dx_t + \\frac{1}{2}f''(x_t) (dx_t)^2\n$$\n代入我们的函数及其导数：\n$$\nd(x_t^2) = 2x_t dx_t + \\frac{1}{2}(2) (dx_t)^2 = 2x_t dx_t + (dx_t)^2\n$$\n现在，代入 $dx_t$ 的 SDE：\n$$\nd(x_t^2) = 2x_t(\\alpha x_t dt + \\sigma dW_t) + (\\alpha x_t dt + \\sigma dW_t)^2\n$$\n二次变差项 $(dx_t)^2$ 使用 Itô 积分法则进行计算：$(dt)^2 = 0$，$dt\\,dW_t = 0$ 以及 $(dW_t)^2 = dt$。\n$$\n(\\alpha x_t dt + \\sigma dW_t)^2 = \\alpha^2 x_t^2 (dt)^2 + 2\\alpha\\sigma x_t dt dW_t + \\sigma^2 (dW_t)^2 = \\sigma^2 dt\n$$\n将此结果代回 $d(x_t^2)$ 的表达式中：\n$$\nd(x_t^2) = (2\\alpha x_t^2 dt + 2\\sigma x_t dW_t) + \\sigma^2 dt = (2\\alpha x_t^2 + \\sigma^2) dt + 2\\sigma x_t dW_t\n$$\n为了找到 $S_t = \\mathbb{E}[x_t^2]$ 的 ODE，我们对该微分的积分形式取期望：\n$$\n\\mathbb{E}[x_t^2] - \\mathbb{E}[x_0^2] = \\mathbb{E}\\left[\\int_0^t (2\\alpha x_s^2 + \\sigma^2) ds + \\int_0^t 2\\sigma x_s dW_s\\right]\n$$\n利用期望的线性性质并交换期望和时间积分的顺序：\n$$\nS_t - S_0 = \\int_0^t (2\\alpha \\mathbb{E}[x_s^2] + \\sigma^2) ds + \\mathbb{E}\\left[\\int_0^t 2\\sigma x_s dW_s\\right]\n$$\n最后一项是零均值 Itô 积分的期望，其值为零。因此：\n$$\nS_t - S_0 = \\int_0^t (2\\alpha S_s + \\sigma^2) ds\n$$\n对 $t$ 求导，得到二阶矩的李雅普诺夫微分方程：\n$$\n\\frac{dS_t}{dt} = 2\\alpha S_t + \\sigma^2\n$$\n初始条件 $S_0 = \\mathbb{E}[x_0^2]$ 由初始分布 $x_0 \\sim \\mathcal{N}(m_0, v_0)$ 的性质导出。我们有 $\\mathbb{E}[x_0] = m_0$ 和 $\\text{Var}(x_0) = v_0$。二阶矩为 $S_0 = \\mathbb{E}[x_0^2] = \\text{Var}(x_0) + (\\mathbb{E}[x_0])^2 = v_0 + m_0^2$。\n\n这个一阶线性常微分方程可以通过使用积分因子或识别其为标准形式来求解。其解为：\n$$\nS_t = S_0 e^{2\\alpha t} + \\frac{\\sigma^2}{2\\alpha}(e^{2\\alpha t} - 1)\n$$\n该解在 $\\alpha \\neq 0$ 时有效。\n\n现在我们将 $S_t$ 从 $0$ 到 $T$ 积分以求得总期望成本：\n$$\n\\int_0^T S_t dt = \\int_0^T \\left(S_0 e^{2\\alpha t} + \\frac{\\sigma^2}{2\\alpha}(e^{2\\alpha t} - 1)\\right) dt\n$$\n$$\n\\int_0^T S_t dt = \\int_0^T \\left( \\left(S_0 + \\frac{\\sigma^2}{2\\alpha}\\right)e^{2\\alpha t} - \\frac{\\sigma^2}{2\\alpha} \\right) dt\n$$\n$$\n= \\left[ \\left(S_0 + \\frac{\\sigma^2}{2\\alpha}\\right)\\frac{e^{2\\alpha t}}{2\\alpha} - \\frac{\\sigma^2}{2\\alpha}t \\right]_0^T\n$$\n$$\n= \\left( \\left(S_0 + \\frac{\\sigma^2}{2\\alpha}\\right)\\frac{e^{2\\alpha T}}{2\\alpha} - \\frac{\\sigma^2 T}{2\\alpha} \\right) - \\left( \\left(S_0 + \\frac{\\sigma^2}{2\\alpha}\\right)\\frac{1}{2\\alpha} - 0 \\right)\n$$\n$$\n= \\left(S_0 + \\frac{\\sigma^2}{2\\alpha}\\right)\\frac{e^{2\\alpha T} - 1}{2\\alpha} - \\frac{\\sigma^2 T}{2\\alpha}\n$$\n最后，我们乘以 $q$ 得到 $J_Q$：\n$$\nJ_Q = q \\left[ \\left(S_0 + \\frac{\\sigma^2}{2\\alpha}\\right)\\frac{e^{2\\alpha T} - 1}{2\\alpha} - \\frac{\\sigma^2 T}{2\\alpha} \\right]\n$$\n现在，代入给定的数值：\n$a = 0.75$，$b = 1.2$，$k = 1.5$，$\\sigma = 0.9$，$q = 2.5$，$T = 1.8$，$m_0 = 0.6$，$v_0 = 0.4$。\n\n首先，我们计算中间常量：\n闭环漂移系数：\n$$\n\\alpha = a - bk = 0.75 - (1.2)(1.5) = 0.75 - 1.8 = -1.05\n$$\n初始二阶矩：\n$$\nS_0 = v_0 + m_0^2 = 0.4 + (0.6)^2 = 0.4 + 0.36 = 0.76\n$$\n噪声方差：\n$$\n\\sigma^2 = (0.9)^2 = 0.81\n$$\n让我们计算 $J_Q$ 表达式的各个组成部分。\n$$\n2\\alpha = 2(-1.05) = -2.1\n$$\n$$\n\\frac{\\sigma^2}{2\\alpha} = \\frac{0.81}{-2.1} \\approx -0.385714\n$$\n$$\nS_0 + \\frac{\\sigma^2}{2\\alpha} = 0.76 + (-0.385714) \\approx 0.374286\n$$\n$$\n2\\alpha T = -2.1 \\times 1.8 = -3.78\n$$\n$$\ne^{2\\alpha T} - 1 = \\exp(-3.78) - 1 \\approx 0.022822 - 1 = -0.977178\n$$\n$$\n\\frac{e^{2\\alpha T} - 1}{2\\alpha} = \\frac{-0.977178}{-2.1} \\approx 0.465323\n$$\n括号内的第一项是：\n$$\n\\left(S_0 + \\frac{\\sigma^2}{2\\alpha}\\right)\\frac{e^{2\\alpha T} - 1}{2\\alpha} \\approx (0.374286)(0.465323) \\approx 0.174160\n$$\n括号内的第二项是：\n$$\n-\\frac{\\sigma^2 T}{2\\alpha} = -\\frac{0.81 \\times 1.8}{-2.1} = \\frac{1.458}{2.1} \\approx 0.694286\n$$\n将括号内的各项相加：\n$$\n\\approx 0.174160 + 0.694286 = 0.868446\n$$\n最后，我们乘以 $q$：\n$$\nJ_Q = q \\times 0.868446 = 2.5 \\times 0.868446 \\approx 2.171115\n$$\n四舍五入到四位有效数字，结果为 $2.171$。", "answer": "$$\n\\boxed{2.171}\n$$", "id": "2984737"}, {"introduction": "在学会评估控制器性能之后，下一步是设计最优控制器。本练习将你带入一个更复杂也更贴近现实的场景：系统受到乘性噪声（multiplicative noise）的干扰，即噪声的强度与系统状态本身相关。你将运用最优控制理论中的核心工具——哈密顿-雅可比-贝尔曼（Hamilton-Jacobi-Bellman, HJB）方程，来推导该系统对应的代数黎卡提方程（Algebraic Riccati Equation, ARE），并找出最优反馈增益。此过程中的一个关键点是揭示乘性噪声所带来的额外稳定性要求——均方稳定性（mean-square stability），它比确定性系统中的稳定性条件更为严苛。[@problem_id:2984771]", "problem": "考虑标量随机微分方程 (SDE)\n$$\n\\mathrm{d}x_t = \\left(a\\,x_t + b\\,u_t\\right)\\mathrm{d}t + \\sigma\\,x_t\\,\\mathrm{d}W_t,\n$$\n其中 $W_t$ 是一个标准维纳过程，$a$、$b$ 和 $\\sigma$ 是常数。性能准则为无限时域期望二次型成本\n$$\nJ(u) = \\mathbb{E}\\left[\\int_{0}^{\\infty} \\left(q\\,x_t^{2} + r\\,u_t^{2}\\right)\\mathrm{d}t\\right],\n$$\n其中 $q>0$ 且 $r>0$。假设控制被限制为 $u_t = -K\\,x_t$ 形式的状态反馈，并求解该随机系统的最优线性二次型调节器 (LQR)。\n\n仅以动态规划原理和 Itô 微积分为基础出发点，推导适用于此问题的稳态 Hamilton–Jacobi–Bellman (HJB) 方程，并论证二次型价值函数拟设 $V(x) = P\\,x^{2}$（其中 $P>0$ 为常数）的合理性。对于具体参数值 $a = 1$、$b = 2$、$\\sigma = 1$、$q = 1$ 和 $r = 1$：\n\n- 推导 $P$ 必须满足的代数 Riccati 方程并显式求解。\n- 计算以 $P$ 表示的最优反馈增益 $K$ 并给出其显式值。\n- 解释由乘性噪声引入的额外均方镇定要求，并验证所获得的最优反馈是否满足此要求。\n\n你的最终答案必须是包含最优反馈增益和 Riccati 解的有序对，写成行矩阵的形式。无需四舍五入。不涉及单位。", "solution": "本题要求推导一个带乘性噪声的标量随机系统的最优线性二次型调节器。解法将从第一性原理出发，使用动态规划原理和 Itô 微积分进行推导。\n\n随机微分方程 (SDE) 如下所示：\n$$\n\\mathrm{d}x_t = (a x_t + b u_t) \\mathrm{d}t + \\sigma x_t \\mathrm{d}W_t\n$$\n要最小化的无限时域成本泛函为：\n$$\nJ(u) = \\mathbb{E}\\left[\\int_{0}^{\\infty} (q x_t^2 + r u_t^2) \\mathrm{d}t\\right]\n$$\n其中 $q > 0$ 且 $r > 0$。价值函数 $V(x)$ 定义为从状态 $x_0 = x$ 出发的最小可能成本：\n$$\nV(x) = \\min_{u} J(u | x_0 = x)\n$$\n对于此连续时间、无限时域问题，动态规划原理导出了稳态 Hamilton-Jacobi-Bellman (HJB) 方程。HJB 方程表明，在任何时间点，最优成本率必须为零。其形式如下：\n$$\n\\min_{u} \\left\\{ L(x, u) + \\mathcal{L}^u V(x) \\right\\} = 0\n$$\n其中 $L(x, u) = q x^2 + r u^2$ 是瞬时成本，而 $\\mathcal{L}^u$ 是在控制 $u_t$ 下随机过程 $x_t$ 的无穷小生成元。对函数 $V(x_t)$ 使用 Itô 引理，可得生成元为：\n$$\n\\mathcal{L}^u V(x) = \\frac{\\mathrm{d}V}{\\mathrm{d}x} (a x + b u) + \\frac{1}{2} \\frac{\\mathrm{d}^2V}{\\mathrm{d}x^2} (\\sigma x)^2\n$$\n将生成元和成本代入 HJB 方程，我们得到：\n$$\n0 = \\min_{u} \\left\\{ q x^2 + r u^2 + (a x + b u) V'(x) + \\frac{1}{2} \\sigma^2 x^2 V''(x) \\right\\}\n$$\n其中 $V'(x)$ 和 $V''(x)$ 分别表示 $V(x)$ 对 $x$ 的一阶和二阶导数。\n\n为了找到使大括号内表达式最小化的最优控制 $u^*(x)$，我们对 $u$ 求导并令结果为零。由于待最小化的项是关于 $u$ 的二次函数，所以最小值是唯一的。\n$$\n\\frac{\\partial}{\\partial u} \\left[ q x^2 + r u^2 + (a x + b u) V'(x) + \\frac{1}{2} \\sigma^2 x^2 V''(x) \\right] = 2 r u + b V'(x) = 0\n$$\n解出 $u$ 可得反馈形式的最优控制策略：\n$$\nu^*(x) = -\\frac{b}{2r} V'(x)\n$$\n关于 $u$ 的二阶导数为 $2r > 0$，这证实了该点为最小值点。\n\n接下来，我们将此最优控制 $u^*(x)$ 代回 HJB 方程，以获得价值函数 $V(x)$ 的偏微分方程：\n$$\n0 = q x^2 + r \\left(-\\frac{b}{2r} V'(x)\\right)^2 + \\left(a x + b \\left(-\\frac{b}{2r} V'(x)\\right)\\right) V'(x) + \\frac{1}{2}\\sigma^2 x^2 V''(x)\n$$\n$$\n0 = q x^2 + \\frac{b^2}{4r} [V'(x)]^2 + a x V'(x) - \\frac{b^2}{2r} [V'(x)]^2 + \\frac{1}{2}\\sigma^2 x^2 V''(x)\n$$\n化简包含 $[V'(x)]^2$ 的项：\n$$\n0 = q x^2 + a x V'(x) - \\frac{b^2}{4r} [V'(x)]^2 + \\frac{1}{2}\\sigma^2 x^2 V''(x)\n$$\n该问题指定了一个在状态 $x$ 和控制 $u$ 上是二次型的成本泛函。这表明价值函数也应为二次型。我们作出拟设 $V(x) = P x^2$，其中 $P>0$ 为某个常数。要求 $P>0$ 是因为成本总是非负的，因此代表总期望成本的价值函数也必须是非负的。\n该拟设的导数为 $V'(x) = 2 P x$ 和 $V''(x) = 2 P$。将它们代入 HJB 方程：\n$$\n0 = q x^2 + a x (2 P x) - \\frac{b^2}{4r} (2 P x)^2 + \\frac{1}{2}\\sigma^2 x^2 (2 P)\n$$\n$$\n0 = q x^2 + 2aP x^2 - \\frac{b^2}{4r} (4 P^2 x^2) + \\sigma^2 P x^2\n$$\n我们可以提出公因子 $x^2$。为使该方程对任意状态 $x$ 都成立，括号内的表达式必须为零。\n$$\n\\left( q + 2aP + \\sigma^2 P - \\frac{b^2}{r} P^2 \\right) x^2 = 0\n$$\n这就得到了关于 $P$ 的代数 Riccati 方程 (ARE)：\n$$\n(2a + \\sigma^2)P - \\frac{b^2}{r}P^2 + q = 0\n$$\n现在，我们代入具体的参数值：$a = 1$，$b = 2$，$\\sigma = 1$，$q = 1$，$r = 1$。\n$$\n(2(1) + 1^2)P - \\frac{2^2}{1}P^2 + 1 = 0\n$$\n$$\n3P - 4P^2 + 1 = 0\n$$\n整理成标准二次型：\n$$\n4P^2 - 3P - 1 = 0\n$$\n我们使用二次公式 $P = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$ 求解这个关于 $P$ 的二次方程，其中 $A=4$，$B=-3$，$C=-1$：\n$$\nP = \\frac{3 \\pm \\sqrt{(-3)^2 - 4(4)(-1)}}{2(4)} = \\frac{3 \\pm \\sqrt{9 + 16}}{8} = \\frac{3 \\pm \\sqrt{25}}{8} = \\frac{3 \\pm 5}{8}\n$$\n两个可能的解是 $P_1 = \\frac{3+5}{8} = 1$ 和 $P_2 = \\frac{3-5}{8} = -\\frac{1}{4}$。\n由于价值函数必须是正定的 ($V(x) = Px^2 \\ge 0$)，我们必须选择正解。因此，$P = 1$。\n\n最优反馈增益 $K$ 从控制律 $u_t = -K x_t$ 导出。将其与我们得到的 $u^*(x)$ 表达式进行比较：\n$$\nu^*(x_t) = -\\frac{b}{2r} V'(x_t) = -\\frac{b}{2r} (2 P x_t) = -\\frac{bP}{r} x_t\n$$\n因此，最优反馈增益为 $K = \\frac{bP}{r}$。代入给定参数和我们解出的 $P$ 值：\n$$\nK = \\frac{2 \\cdot 1}{1} = 2\n$$\n\n最后，我们必须验证该控制律能使闭环系统均方稳定。将 $u_t = -Kx_t$ 代入 SDE，得到闭环动力学：\n$$\n\\mathrm{d}x_t = (a x_t + b(-Kx_t)) \\mathrm{d}t + \\sigma x_t \\mathrm{d}W_t = (a - bK)x_t \\mathrm{d}t + \\sigma x_t \\mathrm{d}W_t\n$$\n为检验均方稳定性，我们分析二阶矩 $\\mathbb{E}[x_t^2]$ 的动态。我们对函数 $f(x) = x^2$ 应用 Itô 引理：\n$$\n\\mathrm{d}(x_t^2) = 2x_t \\mathrm{d}x_t + \\frac{1}{2}(2)(\\mathrm{d}x_t)^2 = 2x_t \\mathrm{d}x_t + (\\mathrm{d}x_t)^2\n$$\n代入 $\\mathrm{d}x_t$ 并使用规则 $(\\mathrm{d}t)^2 = 0$、$(\\mathrm{d}t)(\\mathrm{d}W_t) = 0$、$(\\mathrm{d}W_t)^2 = \\mathrm{d}t$：\n$$\n\\mathrm{d}(x_t^2) = 2x_t((a-bK)x_t \\mathrm{d}t + \\sigma x_t \\mathrm{d}W_t) + (\\sigma x_t \\mathrm{d}W_t)^2\n$$\n$$\n\\mathrm{d}(x_t^2) = (2(a-bK)x_t^2 + \\sigma^2 x_t^2) \\mathrm{d}t + 2\\sigma x_t^2 \\mathrm{d}W_t\n$$\n对两边取期望，注意到随机积分项的期望为零，我们得到关于均方值 $m_2(t) = \\mathbb{E}[x_t^2]$ 的常微分方程(ODE)：\n$$\n\\frac{\\mathrm{d}m_2(t)}{\\mathrm{d}t} = \\mathbb{E}[(2(a-bK) + \\sigma^2)x_t^2] = (2(a-bK) + \\sigma^2)m_2(t)\n$$\n为使 $m_2(t)$ 在 $t \\to \\infty$ 时收敛到 0，其系数必须为负。这就给出了均方稳定性条件：\n$$\n2(a-bK) + \\sigma^2 < 0\n$$\n项 $\\sigma^2$ 是由乘性噪声引入的额外要求。在一个确定性系统（$\\sigma=0$）中，稳定性仅要求闭环极点 $a-bK$ 为负。噪声对二阶矩有去稳定作用，必须通过一个足够大的负漂移项来抵消。\n\n我们用计算出的值 $a = 1$、$b = 2$、$\\sigma = 1$ 和 $K = 2$ 来验证此条件：\n$$\n2(1 - 2 \\cdot 2) + 1^2 = 2(1 - 4) + 1 = 2(-3) + 1 = -6 + 1 = -5\n$$\n由于 $-5 < 0$，均方稳定性的条件得到满足。推导出的最优反馈增益 $K=2$ 确实是镇定的。\n\n要求的答案是最优反馈增益 $K$ 和 Riccati 解 $P$ 的有序对。即 $(K,P) = (2,1)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 2 & 1 \\end{pmatrix}}\n$$", "id": "2984771"}, {"introduction": "标准的线性二次调节器（LQR）理论依赖于对成本函数的特定假设，例如状态权重矩阵$Q$的正定性。当这些假设不成立时，会发生什么？本练习将探讨一个状态权重矩阵$Q$是“不定”（indefinite）的特殊LQR问题。你将使用“配方法”（completing the square）这一基本技巧来重构成本函数，并分析其等效形式的性质。通过这个过程，你将学到一个至关重要的教训：在尝试求解一个问题之前，必须先检验其是否“适定”（well-posed）。这个问题将展示一个不定的成本函数如何可能导致成本的下确界为$ -\\infty $，从而让你学会识别不适定的优化问题，并理解LQR框架的理论边界。[@problem_id:2984739]", "problem": "考虑 $\\mathbb{R}^{2}$ 上的连续时间随机线性系统，\n$$\ndx(t) = A x(t) dt + B u(t) dt + \\Sigma dW(t),\n$$\n其中 $x(t) \\in \\mathbb{R}^{2}$，$u(t) \\in \\mathbb{R}$，$W(t) \\in \\mathbb{R}^{2}$ 是一个各分量相互独立的标准二维布朗运动，且\n$$\nA = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix},\\qquad\nB = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\\qquad\n\\Sigma = \\begin{pmatrix} \\sigma & 0 \\\\ 0 & 0 \\end{pmatrix},\n$$\n其中 $\\sigma \\in (0,\\infty)$ 为一个固定常数。初始条件为 $x(0)=0$。容许控制是所有满足以下条件的循序可测过程 $u$：对任意有限时域 $T>0$，都有 $\\mathbb{E}\\left[\\int_{0}^{T} u(t)^{2} dt\\right] < \\infty$。考虑无限时域二次性能指标\n$$\nJ(u) = \\mathbb{E}\\left[\\int_{0}^{\\infty} \\left( x(t)^{\\top} Q x(t) + 2 x(t)^{\\top} N u(t) + r u(t)^{2} \\right) dt \\right],\n$$\n其中\n$$\nQ = \\begin{pmatrix} -1 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\qquad\nN = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\qquad\nr = 1.\n$$\n注意到 $Q$ 是不定的。仅使用基础工具（二次型的代数配方法恒等式和 Itô 扩散二阶矩的基本性质），完成以下任务：\n\n- 对 $u$ 进行配方以消除交叉项，并用新控制 $\\tilde{u}$ 和有效状态权重矩阵 $Q_{\\mathrm{eff}}$ 来重写瞬时被积函数。请显式地确定 $Q_{\\mathrm{eff}}$。\n\n- 对于由配方法得出的 $K$，推导在控制重参数化 $u(t) = \\tilde{u}(t) - K\\,x(t)$ 下的动力学，并确定状态的漂移矩阵。\n\n- 基于你的重新表述，判断该问题是适定的（最优值有限）还是不适定的（$J$ 的下确界为 $-\\infty$）。通过构造一个容许控制并利用相应 Itô 过程的二阶矩增长来证明你的结论。\n\n$\\inf_{u} J(u)$ 的值是多少？请用单个解析表达式给出最终答案。无需四舍五入。", "solution": "该问题由以下随机微分方程 (SDE) 定义：\n$$\ndx(t) = A x(t) dt + B u(t) dt + \\Sigma dW(t)\n$$\n矩阵为\n$$\nA = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix},\\quad B = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\\quad \\Sigma = \\begin{pmatrix} \\sigma & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\n状态为 $x(t) \\in \\mathbb{R}^2$，控制为 $u(t) \\in \\mathbb{R}$，$W(t) \\in \\mathbb{R}^2$ 是标准布朗运动。初始条件为 $x(0)=0$。需要最小化的代价泛函为：\n$$\nJ(u) = \\mathbb{E}\\left[\\int_{0}^{\\infty} \\left( x(t)^{\\top} Q x(t) + 2 x(t)^{\\top} N u(t) + r u(t)^{2} \\right) dt \\right]\n$$\n代价参数为\n$$\nQ = \\begin{pmatrix} -1 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\quad N = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad r = 1\n$$\n\n### 第1部分：配方法与有效状态权重矩阵\n\n代价泛函 $J(u)$ 中的瞬时被积函数是关于控制 $u(t)$ 的二次函数。我们可以对 $u(t)$ 进行配方来简化表达式。被积函数为：\n$$\nL(x(t), u(t)) = x(t)^{\\top} Q x(t) + 2 x(t)^{\\top} N u(t) + r u(t)^2\n$$\n对于标量控制 $u$ 且 $r=1$，该函数为 $L(x, u) = u^2 + 2(N^{\\top}x)u + x^{\\top}Qx$。对包含 $u$ 的项进行配方：\n$$\nu^2 + 2(N^{\\top}x)u = (u + N^{\\top}x)^2 - (N^{\\top}x)^2\n$$\n由于 $N^{\\top}x$ 是标量，其平方为 $(N^{\\top}x)^2 = (N^{\\top}x)^{\\top}(N^{\\top}x) = x^{\\top}NN^{\\top}x$。\n将其代回被积函数表达式，得到：\n$$\nL(x, u) = (u + N^{\\top}x)^2 - x^{\\top}NN^{\\top}x + x^{\\top}Qx = (u + N^{\\top}x)^2 + x^{\\top}(Q - NN^{\\top})x\n$$\n我们定义新的控制变量 $\\tilde{u}(t)$ 和反馈增益矩阵 $K$ 如下：\n$$\nK = r^{-1}N^{\\top} = 1^{-1} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}^{\\top} = \\begin{pmatrix} 1 & 0 \\end{pmatrix}\n$$\n$$\n\\tilde{u}(t) = u(t) + Kx(t) = u(t) + N^{\\top}x(t)\n$$\n这意味着控制重参数化为 $u(t) = \\tilde{u}(t) - Kx(t)$。\n现在，被积函数可以写成 $\\tilde{u}(t)$ 和有效状态权重矩阵 $Q_{\\mathrm{eff}}$ 的形式：\n$$\nL(x, u) = \\tilde{u}(t)^2 + x(t)^{\\top} Q_{\\mathrm{eff}} x(t)\n$$\n其中\n$$\nQ_{\\mathrm{eff}} = Q - r^{-1}NN^{\\top} = Q - NN^{\\top}\n$$\n我们计算 $NN^{\\top}$：\n$$\nNN^{\\top} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\n因此，有效状态权重矩阵为：\n$$\nQ_{\\mathrm{eff}} = \\begin{pmatrix} -1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} -2 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\n\n### 第2部分：控制重参数化下的动力学\n\n我们将控制重参数化 $u(t) = \\tilde{u}(t) - Kx(t)$ 代入状态動力学 SDE：\n$$\ndx(t) = (A x(t) + B(\\tilde{u}(t) - Kx(t))) dt + \\Sigma dW(t)\n$$\n$$\ndx(t) = ((A - BK)x(t) + B\\tilde{u}(t)) dt + \\Sigma dW(t)\n$$\n状态过程 $x(t)$ 的漂移矩阵是闭环矩阵 $A_{CL} = A - BK$。我们来计算这个矩阵：\n$$\nBK = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\n$$\nA_{CL} = A - BK = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} - \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & -1 \\end{pmatrix}\n$$\n所以，用新控制 $\\tilde{u}(t)$ 表示的动力学由漂移矩阵 $A_{CL} = \\begin{pmatrix} 0 & 0 \\\\ 0 & -1 \\end{pmatrix}$ 决定。\n\n### 第3部分：适定性分析\n\n通过前面部分的变换，问题等价于在动力学约束\n$$\ndx(t) = (A_{CL} x(t) + B\\tilde{u}(t)) dt + \\Sigma dW(t), \\quad x(0)=0.\n$$\n下，最小化\n$$\nJ(\\tilde{u}) = \\mathbb{E}\\left[\\int_{0}^{\\infty} \\left( \\tilde{u}(t)^2 + x(t)^{\\top} Q_{\\mathrm{eff}} x(t) \\right) dt \\right]\n$$\n让我们用 $x(t) = \\begin{pmatrix} x_1(t) & x_2(t) \\end{pmatrix}^{\\top}$ 的分量来写出动力学和代价。\n动力学为：\n$$\nd\\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix} = \\left( \\begin{pmatrix} 0 & 0 \\\\ 0 & -1 \\end{pmatrix} \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\tilde{u}(t) \\right) dt + \\begin{pmatrix} \\sigma & 0 \\\\ 0 & 0 \\end{pmatrix} dW(t)\n$$\n这解耦为两个独立的标量SDE：\n$$\ndx_1(t) = \\tilde{u}(t) dt + \\sigma dW_1(t)\n$$\n$$\ndx_2(t) = -x_2(t) dt\n$$\n代价被积函数为：\n$$\n\\tilde{u}(t)^2 + x(t)^{\\top} \\begin{pmatrix} -2 & 0 \\\\ 0 & 1 \\end{pmatrix} x(t) = \\tilde{u}(t)^2 - 2x_1(t)^2 + x_2(t)^2\n$$\n从 $x_2(t)$ 的SDE以及初始条件 $x_2(0)=0$ 可知，其唯一解为对所有 $t \\geq 0$ 都有 $x_2(t) = 0$。这意味着代价泛函中的 $x_2(t)^2$ 项恒等于零。\n问题简化为最小化：\n$$\nJ(\\tilde{u}) = \\mathbb{E}\\left[\\int_{0}^{\\infty} \\left( \\tilde{u}(t)^2 - 2x_1(t)^2 \\right) dt \\right]\n$$\n约束条件为 $dx_1(t) = \\tilde{u}(t) dt + \\sigma dW_1(t)$ 且 $x_1(0)=0$。\n\n为确定问题是否适定，我们检验 $J(u)$ 的下确界是否可以被驱动至 $-\\infty$。我们可以通过选择一个特定的容许控制并评估其代价来研究这个问题。$x_1(t)^2$ 项上的负号表明，使 $x_1(t)$ 的幅值变大将降低代价。\n\n考虑对新控制最简单的选择：对所有 $t \\geq 0$ 取 $\\tilde{u}(t) = 0$。\n这对应于原始反馈控制律 $u(t) = -Kx(t) = -x_1(t)$。\n首先，我们验证该控制是容许的。$x_1(t)$ 的动力学变为：\n$$\ndx_1(t) = \\sigma dW_1(t), \\quad x_1(0)=0\n$$\n解为 $x_1(t) = \\sigma W_1(t)$。\n控制为 $u(t) = -x_1(t) = -\\sigma W_1(t)$。为满足容许性，我们必须检查对于任意有限 $T>0$ 是否有 $\\mathbb{E}\\left[\\int_{0}^{T} u(t)^2 dt\\right] < \\infty$。\n$$\n\\mathbb{E}\\left[\\int_{0}^{T} u(t)^2 dt\\right] = \\mathbb{E}\\left[\\int_{0}^{T} (-\\sigma W_1(t))^2 dt\\right]\n$$\n根据非负函数的 Fubini 定理，我们可以交换期望和积分的顺序：\n$$\n\\mathbb{E}\\left[\\int_{0}^{T} u(t)^2 dt\\right] = \\int_{0}^{T} \\sigma^2 \\mathbb{E}[W_1(t)^2] dt\n$$\n标准一维维纳过程的二阶矩为 $\\mathbb{E}[W_1(t)^2] = t$。\n$$\n\\int_{0}^{T} \\sigma^2 t\\, dt = \\sigma^2 \\left[\\frac{t^2}{2}\\right]_0^T = \\frac{1}{2}\\sigma^2 T^2\n$$\n由于对于任意有限 $T$，该值都为有限，因此控制 $u(t)=-x_1(t)$（或等价地 $\\tilde{u}(t)=0$）是容许的。\n\n现在，我们计算该控制下的代价 $J$：\n$$\nJ(u) = \\mathbb{E}\\left[\\int_{0}^{\\infty} \\left( \\tilde{u}(t)^2 - 2x_1(t)^2 \\right) dt \\right] = \\mathbb{E}\\left[\\int_{0}^{\\infty} \\left( 0^2 - 2(\\sigma W_1(t))^2 \\right) dt \\right]\n$$\n再次使用 Fubini 定理（因为被积函数的期望是非正的）：\n$$\nJ(u) = \\int_{0}^{\\infty} -2 \\sigma^2 \\mathbb{E}[W_1(t)^2] dt = \\int_{0}^{\\infty} -2 \\sigma^2 t\\, dt\n$$\n该积分是发散的：\n$$\n\\int_{0}^{\\infty} -2 \\sigma^2 t\\, dt = -2\\sigma^2 \\lim_{T \\to \\infty} \\left[\\frac{t^2}{2}\\right]_0^T = -2\\sigma^2 \\lim_{T \\to \\infty} \\frac{T^2}{2} = -\\infty\n$$\n由于我们构造了一个容许控制，使其性能指标 $J(u)$ 为 $-\\infty$，那么 $J(u)$ 在所有容许控制集合上的下确界必定为 $-\\infty$。\n因此，该问题是不适定的。\n\n### 结论\n\n该问题是不适定的，因为代价泛函的下确界为 $-\\infty$。这是因为配方过程产生了一个非正半定的有效状态权重矩阵 $Q_{\\mathrm{eff}}$。$Q_{\\mathrm{eff}}$ 的负特征值对应于一个可控的状态分量，这使得可以通过一个利用这种不稳定性的容许控制策略将代价驱动至 $-\\infty$。因此，下确界的值为 $-\\infty$。", "answer": "$$\n\\boxed{-\\infty}\n$$", "id": "2984739"}]}