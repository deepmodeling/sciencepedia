{"hands_on_practices": [{"introduction": "本练习是随机滤波理论中的一个经典范例，它将一个基本随机过程（布朗运动）的滤波问题与一个核心的微分方程联系起来。通过解决这个问题，您将亲手推导出描述卡尔曼-布奇滤波器估计误差方差如何随时间演变的标量Riccati微分方程 [@problem_id:701789]。这个实践旨在为您建立一个坚实的直觉，理解滤波性能如何从初始状态演化，并最终在特定条件下达到一个稳定的平衡点。", "problem": "设 $X_t$ 为一个标准一维布朗运动，它是一个满足以下条件的连续时间随机过程：\n1.  $X_0 = 0$。\n2.  对于任意 $0 \\le s < t$，增量 $X_t - X_s$ 是一个均值为 $0$、方差为 $t-s$ 的高斯随机变量。\n3.  对于任意不相交的时间区间序列，其对应的增量是相互独立的随机变量。\n\n过程 $X_t$ 无法被直接观测。我们观测一个与之相关的过程 $Y_t$，其定义为：\n$$\nY_t = \\int_0^t X_s ds + B_t\n$$\n其中 $B_t$ 是另一个与 $X_t$ 相互独立的标准一维布朗运动。\n\n设 $\\mathcal{F}_t^Y = \\sigma(\\{Y_s : 0 \\le s \\le t\\})$ 是由观测过程 $Y_t$ 生成的自然信息流。在给定截至时间 $t$ 的观测历史的条件下，$X_t$ 的最优估计是条件期望 $\\hat{X}_t = \\mathbb{E}[X_t | \\mathcal{F}_t^Y]$。\n\n时刻 $t$ 的滤波误差方差定义为 $P(t) = \\mathbb{E}[(X_t - \\hat{X}_t)^2]$。\n\n对于一个固定的时间 $T > 0$，求滤波误差方差 $P(T)$。", "solution": "1.  对于标量情况的 Kalman–Bucy Riccati 方程为：\n$$\\frac{dP}{dt}=Q-C^2\\frac{P^2}{R},$$\n其中 $Q=1$, $C=1$, $R=1$，所以\n$$\\frac{dP}{dt}=1-P^2.$$\n2.  初始条件为 $P(0)=0$。分离变量：\n$$\\int\\frac{dP}{1-P^2}=\\int dt\n\\;\\Rightarrow\\;\n\\operatorname{arctanh}(P)=t+C.$$\n3.  当 $t=0$ 时，由 $\\operatorname{arctanh}(P(0))=0$ 可得 $C=0$。因此\n$$P(t)=\\tanh(t).$$\n4.  所以，在时间 $T$ 时，\n$$P(T)=\\tanh(T).$$", "answer": "$$\\boxed{\\tanh(T)}$$", "id": "701789"}, {"introduction": "在掌握了基本的标量Riccati微分方程之后，我们将进入更具实践意义的多维稳态问题。本练习将引导您使用两种强大的方法来求解连续时间代数Riccati方程（ARE）：一种是利用相关的哈密顿矩阵的结构特性，另一种是运用最优滤波与线性二次调节器（LQR）控制问题之间深刻的对偶性 [@problem_id:2913246]。完成这个练习不仅能让您掌握计算稳态卡尔曼增益的实用技巧，更能让您深刻理解连接系统理论中不同领域的统一数学结构。", "problem": "考虑一个由白过程噪声和测量噪声驱动的连续时间线性时不变随机系统\n$$\n\\dot{x}(t) \\,=\\, A\\,x(t) \\,+\\, G\\,w(t), \\qquad y(t) \\,=\\, C\\,x(t) \\,+\\, v(t),\n$$\n其中 $x(t) \\in \\mathbb{R}^{2}$，$y(t) \\in \\mathbb{R}$，$w(t)$ 和 $v(t)$ 是相互独立的零均值高斯白噪声，其功率谱密度矩阵分别为 $Q_{c}$ 和 $R$。假设\n$$\nA \\,=\\, \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix}, \\quad\nG \\,=\\, \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad\nC \\,=\\, \\begin{pmatrix} 1 & 0 \\end{pmatrix}, \\quad\nQ_{c} \\,=\\, 2, \\quad R \\,=\\, 1.\n$$\n仅从连续时间系统的 Kalman–Bucy 滤波器的定义特性和稳态假设出发，推导稳态误差协方差条件，然后使用相关哈密顿矩阵的哈密顿 Schur 分解计算能使系统稳定的稳态误差协方差。同时，利用连续时间滤波与线性二次调节器（LQR）之间的对偶性，通过求解对偶的 LQR 代数 Riccati 方程（ARE）来获得相同的稳态解。令所得的稳态误差协方差为\n$$\nP \\,=\\, \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix}.\n$$\n将 $p_{11}$ 的值作为一个实数报告。将您的答案四舍五入到四位有效数字。不需要单位。", "solution": "在尝试任何解答之前，首先对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n该连续时间线性时不变系统由以下状态空间方程描述：\n$$\n\\dot{x}(t) \\,=\\, A\\,x(t) \\,+\\, G\\,w(t)\n$$\n$$\ny(t) \\,=\\, C\\,x(t) \\,+\\, v(t)\n$$\n所提供的矩阵和参数如下：\n$$\nA \\,=\\, \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix}, \\quad\nG \\,=\\, \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad\nC \\,=\\, \\begin{pmatrix} 1 & 0 \\end{pmatrix}\n$$\n过程噪声 $w(t)$ 和测量噪声 $v(t)$ 是零均值、相互独立的高斯白噪声，其功率谱密度矩阵分别为 $Q_{c} \\,=\\, 2$ 和 $R \\,=\\, 1$。\n目标是求出稳态误差协方差矩阵 $P$，定义为\n$$\nP \\,=\\, \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix}\n$$\n并报告 $p_{11}$ 的值。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，是使用 Kalman–Bucy 滤波器进行最优状态估计的标准练习。语言客观、精确。该问题是适定的。如果系统对 $(A, G\\sqrt{Q_c})$ 是可镇定的，且系统对 $(C, A)$ 是可检测的，那么保证存在唯一的正定稳态误差协方差解 $P$。\n检验 $(A, G\\sqrt{Q_c})$ 的可镇定性：$G\\sqrt{Q_c} = \\begin{pmatrix} 0 \\\\ \\sqrt{2} \\end{pmatrix}$。能控性矩阵为 $\\begin{pmatrix} G\\sqrt{Q_c} & AG\\sqrt{Q_c} \\end{pmatrix} = \\begin{pmatrix} 0 & \\sqrt{2} \\\\ \\sqrt{2} & -3\\sqrt{2} \\end{pmatrix}$。其行列式为 $-2$，不为零，因此该系统对是能控的，从而也是可镇定的。\n检验 $(C, A)$ 的可检测性：能观性矩阵为 $\\begin{pmatrix} C \\\\ CA \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$。该矩阵满秩，因此该系统对是能观的，从而也是可检测的。\n存在唯一的、能使系统稳定的正定解 $P$ 的所有条件均已满足。该问题是自洽的，没有矛盾或歧义。\n\n**步骤 3：结论与行动**\n该问题有效。将提供解答。\n\n**稳态误差协方差条件的推导**\n\n对于连续时间 Kalman–Bucy 滤波器，估计误差 $e(t) = x(t) - \\hat{x}(t)$ 的动态由 $\\dot{e}(t) = (A-K(t)C)e(t) + Gw(t) - K(t)v(t)$ 给出，其中 $K(t)$ 是 Kalman 增益。误差协方差矩阵 $P(t) = E[e(t)e^T(t)]$ 根据微分 Riccati 方程进行传播：\n$$\n\\dot{P}(t) = A P(t) + P(t) A^T - K(t)C P(t) - P(t) C^T K^T(t) + G Q_c G^T + K(t) R K^T(t)\n$$\n使 $P(t)$ 的迹最小化的最优 Kalman 增益为 $K(t) = P(t) C^T R^{-1}$。将其代入微分 Riccati 方程可得：\n$$\n\\dot{P}(t) = A P(t) + P(t) A^T - P(t) C^T R^{-1} C P(t) + G Q_c G^T\n$$\n在稳态下，$\\dot{P}(t) = 0$，这导出了滤波器的连续时间代数 Riccati 方程（ARE）：\n$$\n0 = AP + PA^T - PC^T R^{-1} CP + GQ_cG^T\n$$\n这就是所要求的稳态误差协方差条件。\n\n**通过哈密顿矩阵特性求解**\n\n滤波器 ARE 的解与相关哈密顿矩阵 $H_f$ 的稳定不变子空间有关：\n$$\nH_f = \\begin{pmatrix} A^T & -C^T R^{-1} C \\\\ -G Q_c G^T & -A \\end{pmatrix}\n$$\n首先，我们计算各分量矩阵：\n$$\nA^T = \\begin{pmatrix} 0 & -2 \\\\ 1 & -3 \\end{pmatrix}, \\quad -A = \\begin{pmatrix} 0 & -1 \\\\ 2 & 3 \\end{pmatrix}\n$$\n$$\n-C^T R^{-1} C = -\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (1)^{-1} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} -1 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\n$$\n-G Q_c G^T = -\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} (2) \\begin{pmatrix} 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & -2 \\end{pmatrix}\n$$\n哈密顿矩阵为：\n$$\nH_f = \\begin{pmatrix} 0 & -2 & -1 & 0 \\\\ 1 & -3 & 0 & 0 \\\\ 0 & 0 & 0 & -1 \\\\ 0 & -2 & 2 & 3 \\end{pmatrix}\n$$\n$H_f$ 的特征多项式为 $\\det(\\lambda I - H_f) = \\lambda^4 - 5\\lambda^2 + 6 = 0$。令 $y = \\lambda^2$，我们有 $y^2 - 5y + 6 = (y-2)(y-3) = 0$。因此特征值为 $\\lambda = \\pm\\sqrt{2}$ 和 $\\lambda = \\pm\\sqrt{3}$。\n$H_f$ 的稳定特征值是那些具有负实部的特征值：$-\\sqrt{2}$ 和 $-\\sqrt{3}$。ARE 的一个基本性质是，最优滤波器的闭环动态矩阵 $A_{cl} = A - KC$ 的特征值必须等于哈密顿矩阵的稳定特征值。稳态 Kalman 增益为 $K = PC^TR^{-1}$。\n$$\nK = \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (1)^{-1} = \\begin{pmatrix} p_{11} \\\\ p_{12} \\end{pmatrix}\n$$\n闭环矩阵为：\n$$\nA_{cl} = A - KC = \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix} - \\begin{pmatrix} p_{11} \\\\ p_{12} \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} -p_{11} & 1 \\\\ -2-p_{12} & -3 \\end{pmatrix}\n$$\n$A_{cl}$ 的特征多项式为：\n$$\n\\det(\\lambda I - A_{cl}) = \\det\\begin{pmatrix} \\lambda+p_{11} & -1 \\\\ 2+p_{12} & \\lambda+3 \\end{pmatrix} = (\\lambda+p_{11})(\\lambda+3) + (2+p_{12}) = \\lambda^2 + (3+p_{11})\\lambda + (3p_{11} + p_{12} + 2)\n$$\n具有特征值 $-\\sqrt{2}$ 和 $-\\sqrt{3}$ 的期望特征多项式为：\n$$\n(\\lambda + \\sqrt{2})(\\lambda + \\sqrt{3}) = \\lambda^2 + (\\sqrt{2}+\\sqrt{3})\\lambda + \\sqrt{6}\n$$\n通过比较这两个多项式的系数，我们得到一个方程组：\n1) $3+p_{11} = \\sqrt{2}+\\sqrt{3}$\n2) $3p_{11} + p_{12} + 2 = \\sqrt{6}$\n\n由方程 (1)，我们求解 $p_{11}$：\n$$\np_{11} = \\sqrt{2} + \\sqrt{3} - 3\n$$\n\n**通过与 LQR 的对偶性求解**\n\n滤波器的连续时间 ARE 与线性二次调节器（LQR）问题的 ARE 是对偶的。标准 LQR 问题旨在为系统 $\\dot{x}=A_{lqr}x+B_{lqr}u$ 找到一个控制律 $u=-K_c x$，以最小化 $\\int_0^\\infty (x^T Q_{lqr} x + u^T R_{lqr} u) dt$。对应的控制器增益矩阵 $S$ 的 ARE 为 $A_{lqr}^T S + S A_{lqr} - S B_{lqr} R_{lqr}^{-1} B_{lqr}^T S + Q_{lqr} = 0$。\n对偶映射为：$A_{lqr} \\leftrightarrow A^T$，$B_{lqr} \\leftrightarrow C^T$，$Q_{lqr} \\leftrightarrow G Q_c G^T$ 以及 $R_{lqr} \\leftrightarrow R$。LQR ARE 的解 $S$ 就是滤波器 ARE 的解 $P$。\n将此映射应用于 LQR ARE：\n$$\n(A^T)^T P + P(A^T) - P(C^T)(R)^{-1}(C^T)^T P + GQ_cG^T = 0\n$$\n$$\nAP + PA^T - PC^TR^{-1}CP + GQ_cG^T = 0\n$$\n这正是滤波器的 ARE，证实了为指定矩阵求解对偶 LQR 问题会得到相同的矩阵 $P$。为了找到解，我们可以求解从矩阵 ARE 推导出的标量方程组。\n从矩阵 ARE 中，我们得到关于 $P$ 的元素的三个标量方程：\ni) $(1,1)$ 元素： $2p_{12} - p_{11}^2 = 0 \\implies 2p_{12} = p_{11}^2$\nii) $(1,2)$ 元素： $p_{22} - 2p_{11} - 3p_{12} - p_{11}p_{12} = 0$\niii) $(2,2)$ 元素： $-4p_{12} - 6p_{22} + 2 - p_{12}^2 = 0$\n通过哈密顿极点配置法得到的结果必须满足该方程组。根据极点配置法的方程(2)，$p_{12} = \\sqrt{6} - 2 - 3p_{11}$。代入 $p_{11} = \\sqrt{2}+\\sqrt{3}-3$：\n$$\np_{12} = \\sqrt{6} - 2 - 3(\\sqrt{2}+\\sqrt{3}-3) = 7 + \\sqrt{6} - 3\\sqrt{2} - 3\\sqrt{3}\n$$\n我们可以验证这些值满足方程 (i)：\n$$\np_{11}^2 = (\\sqrt{2}+\\sqrt{3}-3)^2 = (\\sqrt{2})^2 + (\\sqrt{3})^2 + (-3)^2 + 2\\sqrt{2}\\sqrt{3} - 6\\sqrt{2} - 6\\sqrt{3} = 14 + 2\\sqrt{6} - 6\\sqrt{2} - 6\\sqrt{3}\n$$\n$$\n2p_{12} = 2(7 + \\sqrt{6} - 3\\sqrt{2} - 3\\sqrt{3}) = 14 + 2\\sqrt{6} - 6\\sqrt{2} - 6\\sqrt{3}\n$$\n方程 $p_{11}^2 = 2p_{12}$ 成立，证实了这两种方法的一致性。\n\n**最终计算**\n\n$p_{11}$ 的值由 $p_{11} = \\sqrt{2} + \\sqrt{3} - 3$ 给出。\n使用数值 $\\sqrt{2} \\approx 1.41421356$ 和 $\\sqrt{3} \\approx 1.73205081$：\n$$\np_{11} \\approx 1.41421356 + 1.73205081 - 3 = 3.14626437 - 3 = 0.14626437\n$$\n四舍五入到四位有效数字，我们得到 $p_{11} \\approx 0.1463$。", "answer": "$$\n\\boxed{0.1463}\n$$", "id": "2913246"}, {"introduction": "现实世界中的系统常常表现出跨越多个时间尺度的复杂动态特性，直接求解其Riccati方程可能计算成本高昂或难以解析。这个高级练习引入了奇异摄动理论，作为一种简化复杂模型的强大工具，您将为一个双时间尺度系统推导一个降阶慢变子系统，并为其设计近似的卡尔曼滤波器。本练习通过要求您推导近似解并编程实现，从而将其与精确解进行数值比较，成功地将理论与计算联系起来 [@problem_id:2996509]。这种将解析近似与数值验证相结合的实践，是现代工程与科学研究中处理复杂系统时的一项核心技能。", "problem": "考虑一个由以下随机微分方程 (SDE) 控制的连续时间、双时间尺度、线性高斯状态空间模型\n$$\n\\begin{aligned}\nd x_t &= \\big(a\\, x_t + b\\, y_t\\big)\\,dt + \\sqrt{q_x}\\,dW_t^{(1)}, \\\\\nd y_t &= \\frac{\\gamma\\, x_t - \\lambda\\, y_t}{\\epsilon}\\,dt + 0\\cdot dW_t^{(2)}, \\\\\nd z_t &= c\\, x_t\\,dt + \\sqrt{r}\\,dV_t,\n\\end{aligned}\n$$\n其中 $x_t \\in \\mathbb{R}$ 是慢状态，$y_t \\in \\mathbb{R}$ 是快状态，$z_t \\in \\mathbb{R}$ 是观测过程，$a, b, \\gamma, \\lambda, c \\in \\mathbb{R}$ 满足 $\\lambda > 0$ 和 $c \\neq 0$，$q_x > 0$ 是 $x_t$ 上的过程噪声强度，$r > 0$ 是观测噪声强度，而 $\\epsilon > 0$ 是一个小时间尺度参数。维纳过程 $W_t^{(1)}$ 和 $V_t$ 是独立的标准布朗运动。在此设置中，快过程没有直接的过程噪声，即 $y_t$ 上的强度为零，并且由于因子 $1/\\epsilon$ 的存在，耦合产生了两个时间尺度。\n\n令系统以状态向量 $s_t = \\begin{bmatrix} x_t \\\\ y_t \\end{bmatrix}$ 和矩阵写成紧凑形式\n$$\nA(\\epsilon) = \\begin{bmatrix} a & b \\\\ \\dfrac{\\gamma}{\\epsilon} & -\\dfrac{\\lambda}{\\epsilon} \\end{bmatrix},\\quad\nQ(\\epsilon) = \\begin{bmatrix} q_x & 0 \\\\ 0 & 0 \\end{bmatrix},\\quad\nC = \\begin{bmatrix} c & 0 \\end{bmatrix},\\quad\nR = \\begin{bmatrix} r \\end{bmatrix}.\n$$\n对于完整的二维系统，其精确的稳态 Kalman-Bucy 增益 $K^\\star(\\epsilon) \\in \\mathbb{R}^{2 \\times 1}$ 通过满足连续时间代数 Riccati 方程 (ARE) 的稳态误差协方差 $P(\\epsilon) \\in \\mathbb{R}^{2 \\times 2}$ 来定义\n$$\nA(\\epsilon)\\,P(\\epsilon) + P(\\epsilon)\\,A(\\epsilon)^\\top + Q(\\epsilon) - P(\\epsilon)\\,C^\\top R^{-1}\\,C\\,P(\\epsilon) = 0,\n$$\n其中\n$$\nK^\\star(\\epsilon) = P(\\epsilon)\\,C^\\top R^{-1}.\n$$\n\n当时间尺度参数 $\\epsilon$ 很小时，奇异摄动论证表明快状态 $y_t$ 会迅速趋近于一个相对于慢状态 $x_t$ 的准稳态代数关系。利用这一点，构建一个近似的标量慢子系统，并推导出一个近似的稳态 Kalman-Bucy 增益 $K^{\\text{approx}}(\\epsilon) \\in \\mathbb{R}^{2 \\times 1}$，该增益利用降阶的慢动态和准静态关系来重构快状态增益分量。\n\n你的任务是：\n1. 从线性高斯状态空间模型、Kalman-Bucy 滤波器和双时间尺度系统的奇异摄动的基本定义出发，推导近似的慢子系统动态以及相应的慢误差协方差的稳态标量代数 Riccati 方程。利用该结果获得完整增益 $K^\\star(\\epsilon)$ 的一个近似 $K^{\\text{approx}}(\\epsilon)$。\n2. 实现一个程序，对于下面提供的每个测试用例，计算：\n   - 通过数值求解完整二维系统的稳态 Kalman-Bucy ARE，计算精确的稳态增益 $K^\\star(\\epsilon)$。\n   - 从降阶慢子系统和快分量的准静态重构中，计算近似增益 $K^{\\text{approx}}(\\epsilon)$。\n   - 相对误差\n     $$\n     \\mathrm{RelErr}(\\epsilon) = \\frac{\\left\\|K^\\star(\\epsilon) - K^{\\text{approx}}(\\epsilon)\\right\\|_2}{\\left\\|K^\\star(\\epsilon)\\right\\|_2},\n     $$\n     其中 $\\|\\cdot\\|_2$ 表示 $\\mathbb{R}^2$ 中的欧几里得范数。\n\n程序必须生成单行输出，包含所有测试用例的结果，形式为方括号括起来的逗号分隔列表。列表中的每个条目必须是对应于相关测试用例的相对误差的浮点数。\n\n使用以下参数值测试套件，以确保覆盖典型情况、改进的尺度分离、弱观测和耦合边界条件：\n- 通用参数（除非明确修改）：$a = -0.8$, $b = 1.2$, $\\gamma = 0.5$, $\\lambda = 3.0$, $c = 1.0$, $r = 0.4$, $q_x = 0.75$。\n- 测试用例：\n  1. $\\epsilon = 10^{-1}$。\n  2. $\\epsilon = 10^{-2}$。\n  3. $\\epsilon = 10^{-3}$。\n  4. $\\epsilon = 10^{-2}$，其中 $b = 0.0$。\n  5. $\\epsilon = 5\\times 10^{-3}$，其中 $c = 0.2$。\n  6. $\\epsilon = 2\\times 10^{-2}$，其中 $\\lambda = 8.0$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，“[result1,result2,result3,result4,result5,result6]”）。本问题不涉及物理单位；所有量纲均为无量纲的。", "solution": "我们从连续时间线性高斯状态空间模型和 Kalman-Bucy 滤波器开始。状态满足随机微分方程 (SDE)\n$$\nd s_t = A(\\epsilon)\\,s_t\\,dt + G(\\epsilon)\\,dW_t,\n$$\n且观测满足\n$$\nd z_t = C\\,s_t\\,dt + \\sqrt{R}\\,dV_t,\n$$\n其中 $s_t \\in \\mathbb{R}^2$，$A(\\epsilon) \\in \\mathbb{R}^{2\\times 2}$，$G(\\epsilon) \\in \\mathbb{R}^{2\\times 2}$ 编码了过程噪声通道，$C \\in \\mathbb{R}^{1\\times 2}$，以及 $R \\in \\mathbb{R}^{1\\times 1}$ 是观测噪声强度。在我们的设置中，\n$$\nA(\\epsilon) = \\begin{bmatrix} a & b \\\\ \\dfrac{\\gamma}{\\epsilon} & -\\dfrac{\\lambda}{\\epsilon} \\end{bmatrix},\\qquad\nQ(\\epsilon) = G(\\epsilon)\\,G(\\epsilon)^\\top = \\begin{bmatrix} q_x & 0 \\\\ 0 & 0 \\end{bmatrix},\\qquad\nC = \\begin{bmatrix} c & 0 \\end{bmatrix},\\qquad R = \\begin{bmatrix} r \\end{bmatrix}.\n$$\nKalman-Bucy 滤波器生成一个估计值 $\\hat{s}_t$，其误差协方差 $P(\\epsilon,t) \\in \\mathbb{R}^{2\\times 2}$ 满足 Riccati 微分方程\n$$\n\\dot{P}(\\epsilon,t) = A(\\epsilon)\\,P(\\epsilon,t) + P(\\epsilon,t)\\,A(\\epsilon)^\\top + Q(\\epsilon) - P(\\epsilon,t)\\,C^\\top R^{-1}\\,C\\,P(\\epsilon,t).\n$$\n在标准的可检测性和可镇定性条件下，稳态误差协方差 $P(\\epsilon)$ 求解连续时间代数 Riccati 方程 (ARE)\n$$\nA(\\epsilon)\\,P(\\epsilon) + P(\\epsilon)\\,A(\\epsilon)^\\top + Q(\\epsilon) - P(\\epsilon)\\,C^\\top R^{-1}\\,C\\,P(\\epsilon) = 0,\n$$\n且稳态 Kalman 增益是\n$$\nK^\\star(\\epsilon) = P(\\epsilon)\\,C^\\top R^{-1}.\n$$\n\n我们现在使用奇异摄动来为小 $\\epsilon$ 构建一个合适的近似。快动态为\n$$\n\\frac{d y_t}{dt} = \\frac{\\gamma\\,x_t - \\lambda\\,y_t}{\\epsilon},\n$$\n其中 $\\lambda > 0$，使得 $y_t$ 在快时间尺度 $O(\\epsilon)$ 上演化。对于小 $\\epsilon$，并在 $x_t$ 的慢时间尺度上，快状态迅速松弛到一个代数准稳态关系，该关系通过将快漂移近似设为零而获得：\n$$\n0 \\approx \\gamma\\,x_t - \\lambda\\,y_t \\quad \\Rightarrow \\quad y_t \\approx \\frac{\\gamma}{\\lambda}\\,x_t.\n$$\n将此代入慢动态，得到降阶的慢子系统\n$$\n\\frac{d x_t}{dt} \\approx \\left(a + b\\,\\frac{\\gamma}{\\lambda}\\right) x_t + \\sqrt{q_x}\\,dW_t^{(1)},\n$$\n这是一个标量线性高斯系统。观测为\n$$\nd z_t = c\\,x_t\\,dt + \\sqrt{r}\\,dV_t,\n$$\n因此有效观测仅依赖于 $x_t$。所以，慢误差协方差 $p \\in \\mathbb{R}$ 的标量稳态 Riccati 方程是一维系统的连续时间 Kalman-Bucy 代数 Riccati 方程：\n$$\n2\\,a_{\\mathrm{eff}}\\,p + q_x - \\frac{c^2}{r}\\,p^2 = 0,\\qquad a_{\\mathrm{eff}} := a + b\\,\\frac{\\gamma}{\\lambda}.\n$$\n这是一个关于 $p$ 的二次方程，其判别式为\n$$\n\\Delta = 4\\,a_{\\mathrm{eff}}^2 + 4\\,\\frac{c^2}{r}\\,q_x.\n$$\n满足 $p > 0$ 的镇定稳态解是\n$$\np = \\frac{a_{\\mathrm{eff}} + \\sqrt{a_{\\mathrm{eff}}^2 + \\frac{c^2}{r}\\,q_x}}{\\frac{c^2}{r}}.\n$$\n相应的慢状态 Kalman 增益是标量\n$$\nK_x^{\\text{approx}} = \\frac{p\\,c}{r}.\n$$\n为了重构与准稳态关系 $y_t \\approx (\\gamma/\\lambda)\\,x_t$ 一致的快状态分量，我们在估计器更新中使用相同的比例关系，从而\n$$\nK_y^{\\text{approx}} = \\frac{\\gamma}{\\lambda}\\,K_x^{\\text{approx}}.\n$$\n因此，近似的完整增益为\n$$\nK^{\\text{approx}}(\\epsilon) = \\begin{bmatrix} K_x^{\\text{approx} } \\\\ K_y^{\\text{approx}} \\end{bmatrix} = \\begin{bmatrix} \\dfrac{p\\,c}{r} \\\\ \\dfrac{\\gamma}{\\lambda}\\,\\dfrac{p\\,c}{r} \\end{bmatrix}.\n$$\n\n对于精确增益，我们求解完整二维系统的稳态连续时间代数 Riccati 方程。一种数值上方便的计算 $P(\\epsilon)$ 的方法是通过转置来使用标准的线性二次调节器 (LQR) 的连续时间 ARE 求解器：LQR ARE\n$$\nA^\\top X + X A - X B R^{-1} B^\\top X + Q = 0\n$$\n如果我们设置 $A \\leftarrow A(\\epsilon)^\\top$，$B \\leftarrow C^\\top$，$Q \\leftarrow Q(\\epsilon)$ 和 $R \\leftarrow R$，它就与 Kalman-Bucy ARE 相匹配。求解 $X$ 得到 $P(\\epsilon)$，精确增益为 $K^\\star(\\epsilon) = P(\\epsilon)\\,C^\\top R^{-1}$。\n\n每个测试用例的算法步骤：\n1. 使用指定的参数构建 $A(\\epsilon)$、$Q(\\epsilon)$、$C$ 和 $R$。\n2. 通过使用上述转置方法求解 ARE 来计算 $P(\\epsilon)$，然后计算 $K^\\star(\\epsilon) = P(\\epsilon)\\,C^\\top R^{-1}$。\n3. 计算 $a_{\\mathrm{eff}}$，求解关于 $p$ 的标量二次方程，如上所述计算 $K^{\\text{approx}}(\\epsilon)$。\n4. 计算相对误差\n   $$\n   \\mathrm{RelErr}(\\epsilon) = \\frac{\\left\\|K^\\star(\\epsilon) - K^{\\text{approx}}(\\epsilon)\\right\\|_2}{\\left\\|K^\\star(\\epsilon)\\right\\|_2}.\n   $$\n5. 汇总所有测试用例的相对误差，并以要求的单行格式输出。\n\n覆盖范围讨论：\n- 对于 $\\epsilon = 10^{-1}$，尺度分离适中，用于在不太理想的情况下测试近似。\n- 对于 $\\epsilon = 10^{-2}$ 和 $\\epsilon = 10^{-3}$，尺度分离得到改善，近似应该变得更准确。\n- 设置 $b = 0$ 消除了慢动态对快状态的依赖，而快状态仍然依赖于慢状态，这用于在没有慢-快反馈的情况下测试快分量的重构。\n- 设置 $c = 0.2$ 削弱了观测，减小了 Kalman 增益的幅值，并测试了数值稳定性。\n- 将 $\\lambda$ 增加到 $8.0$ 增强了快动态的收缩性，改善了准静态近似。\n\n最终程序使用代数 Riccati 方程求解精确的 Kalman-Bucy 稳态增益，并通过奇异摄动求解近似增益，然后报告指定测试套件的相对误差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_continuous_are\n\ndef exact_kalman_gain(a, b, gamma, lam, c, r, qx, eps):\n    \"\"\"\n    Compute the exact steady-state Kalman-Bucy gain for the two-dimensional system.\n    Uses the continuous-time Algebraic Riccati Equation (ARE) via the LQR solver trick.\n    \"\"\"\n    # System matrices\n    A = np.array([[a, b],\n                  [gamma/eps, -lam/eps]], dtype=float)\n    Q = np.diag([qx, 0.0])\n    C = np.array([[c, 0.0]], dtype=float)  # 1x2\n    R = np.array([[r]], dtype=float)       # 1x1\n\n    # Solve ARE: A^T X + X A - X B R^{-1} B^T X + Q = 0 with B = C^T\n    P = solve_continuous_are(A.T, C.T, Q, R)\n\n    # Kalman gain K = P C^T R^{-1}; since R is scalar, we can divide by r\n    K = (P @ C.T) / r  # shape (2,1)\n    return K.reshape(2)\n\ndef approx_kalman_gain(a, b, gamma, lam, c, r, qx):\n    \"\"\"\n    Compute the approximate steady-state Kalman-Bucy gain via singular perturbation\n    for small epsilon: reduce to scalar slow subsystem and reconstruct fast component.\n    \"\"\"\n    a_eff = a + b * (gamma / lam)\n    # Solve scalar continuous-time Kalman-Bucy ARE: 2 a_eff p + qx - (c^2/r) p^2 = 0\n    # Stabilizing positive solution:\n    denom = (c**2) / r\n    # Numerical safety: denom > 0 since r > 0 and c != 0\n    p = (a_eff + np.sqrt(a_eff**2 + denom * qx)) / denom\n    Kx = (p * c) / r\n    Ky = (gamma / lam) * Kx\n    return np.array([Kx, Ky], dtype=float)\n\ndef relative_error(K_exact, K_approx):\n    \"\"\"\n    Relative 2-norm error between exact and approximate Kalman gain vectors.\n    \"\"\"\n    num = np.linalg.norm(K_exact - K_approx, 2)\n    den = np.linalg.norm(K_exact, 2)\n    # Guard against zero denominator (unlikely with c != 0 and qx > 0)\n    if den == 0.0:\n        return float('nan')\n    return num / den\n\ndef solve():\n    # Common parameters\n    base = {\n        \"a\": -0.8,\n        \"b\": 1.2,\n        \"gamma\": 0.5,\n        \"lam\": 3.0,\n        \"c\": 1.0,\n        \"r\": 0.4,\n        \"qx\": 0.75\n    }\n\n    # Test cases: list of dictionaries overriding base where needed\n    test_cases = [\n        # 1. epsilon = 1e-1\n        {\"eps\": 1e-1},\n        # 2. epsilon = 1e-2\n        {\"eps\": 1e-2},\n        # 3. epsilon = 1e-3\n        {\"eps\": 1e-3},\n        # 4. epsilon = 1e-2 with b = 0\n        {\"eps\": 1e-2, \"b\": 0.0},\n        # 5. epsilon = 5e-3 with c = 0.2 (weak observation)\n        {\"eps\": 5e-3, \"c\": 0.2},\n        # 6. epsilon = 2e-2 with lambda = 8.0 (strong fast contraction)\n        {\"eps\": 2e-2, \"lam\": 8.0},\n    ]\n\n    results = []\n    for tc in test_cases:\n        # Merge base with overrides\n        params = base.copy()\n        params.update(tc)\n        a = params[\"a\"]\n        b = params[\"b\"]\n        gamma = params[\"gamma\"]\n        lam = params[\"lam\"]\n        c = params[\"c\"]\n        r = params[\"r\"]\n        qx = params[\"qx\"]\n        eps = params[\"eps\"]\n\n        K_exact = exact_kalman_gain(a, b, gamma, lam, c, r, qx, eps)\n        K_approx = approx_kalman_gain(a, b, gamma, lam, c, r, qx)\n        err = relative_error(K_exact, K_approx)\n        results.append(err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2996509"}]}