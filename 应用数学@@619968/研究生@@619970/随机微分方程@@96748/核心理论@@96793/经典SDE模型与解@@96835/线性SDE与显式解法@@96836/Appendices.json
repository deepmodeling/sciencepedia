{"hands_on_practices": [{"introduction": "我们从一个基础但至关重要的问题开始，它将引导你使用伊藤公式来验证一个一般线性随机微分方程的解。这个练习的核心在于通过伊藤乘积法则的严谨应用，揭示在求解过程中一个关键修正项的由来，该修正项源于二次协变。掌握这个过程对于深刻理解“常数变易法”如何适应于随机分析领域至关重要。[@problem_id:2985096]", "problem": "设 $\\{(\\Omega, \\mathcal{F}, (\\mathcal{F}_t)_{t \\in [0,T]}, \\mathbb{P})\\}$ 为一个满足通常条件的过滤概率空间，其上定义了一个一维标准布朗运动 (SBM) $W = (W_t)_{t \\in [0,T]}$。设 $a, \\sigma, f, g : [0,T] \\to \\mathbb{R}$ 是确定性的、连续且有界的函数，并设 $x_0 \\in \\mathbb{R}$ 为一个固定的初始值。考虑以下线性随机微分方程 (SDE)\n$$\ndX_t \\;=\\; a(t)\\,X_t\\,dt \\;+\\; \\sigma(t)\\,X_t\\,dW_t \\;+\\; f(t)\\,dt \\;+\\; g(t)\\,dW_t, \n\\qquad X_0 \\;=\\; x_0.\n$$\n定义与半鞅 $\\int_0^t \\sigma(s)\\,dW_s + \\int_0^t a(s)\\,ds$ 相关的随机指数（也称为 Doléans-Dade 指数）为\n$$\n\\Lambda_t \\;=\\; \\exp\\!\\Bigg(\\int_0^t \\sigma(s)\\,dW_s \\;+\\; \\int_0^t a(s)\\,ds \\;-\\; \\frac{1}{2}\\int_0^t \\sigma(s)^2\\,ds\\Bigg),\n\\qquad t \\in [0,T].\n$$\n考虑以下候选显式解，其中包含一个尚未指定的确定性校正项 $c : [0,T] \\to \\mathbb{R}$：\n$$\nX_t \\;=\\; \\Lambda_t \\left( x_0 \\;+\\; \\int_0^t \\Lambda_s^{-1}\\,\\big(f(s) + c(s)\\big)\\,ds \\;+\\; \\int_0^t \\Lambda_s^{-1}\\,g(s)\\,dW_s \\right).\n$$\n仅使用 Itô 乘积法则和连续半鞅的二次协变差的刻画，验证上述 $X_t$ 满足给定的 SDE 当且仅当 $c$ 被恰当选择。确定 $c(t)$ 关于 $\\sigma(t)$ 和 $g(t)$ 的唯一闭式表达式，使得该验证成立。你的最终答案必须是此表达式，并简化为单个解析公式。无需四舍五入，也不涉及任何单位。", "solution": "该问题要求确定一个确定性函数 $c(t)$，使得给定的候选过程 $X_t$ 是一个指定的线性随机微分方程 (SDE) 的解。验证将使用 Itô 微积分进行，具体来说是半鞅的乘积法则。\n\n该 SDE 由下式给出：\n$$\ndX_t = (a(t)X_t + f(t))\\,dt + (\\sigma(t)X_t + g(t))\\,dW_t, \\quad X_0 = x_0\n$$\n\n候选解的形式为 $X_t = \\Lambda_t Y_t$，其中 $\\Lambda_t$ 是随机指数项，而 $Y_t$ 是括号中的过程。让我们显式地定义这两个过程：\n$$\n\\Lambda_t = \\exp\\left(\\int_0^t \\sigma(s)\\,dW_s + \\int_0^t a(s)\\,ds - \\frac{1}{2}\\int_0^t \\sigma(s)^2\\,ds\\right)\n$$\n$$\nY_t = x_0 + \\int_0^t \\Lambda_s^{-1}\\,(f(s) + c(s))\\,ds + \\int_0^t \\Lambda_s^{-1}\\,g(s)\\,dW_s\n$$\n我们的策略是使用 Itô 乘积法则计算微分 $dX_t$，然后将其得到的漂移系数和扩散系数与给定 SDE 的系数相等。\n\n首先，我们确定微分 $d\\Lambda_t$。设 $Z_t = \\int_0^t \\sigma(s)\\,dW_s + \\int_0^t a(s)\\,ds - \\frac{1}{2}\\int_0^t \\sigma(s)^2\\,ds$。则 $\\Lambda_t = \\exp(Z_t)$。$Z_t$ 的微分是：\n$$\ndZ_t = \\sigma(t)\\,dW_t + a(t)\\,dt - \\frac{1}{2}\\sigma(t)^2\\,dt = \\left(a(t) - \\frac{1}{2}\\sigma(t)^2\\right)dt + \\sigma(t)\\,dW_t\n$$\n对 $\\Lambda_t = F(Z_t)$ 应用 Itô 公式，其中 $F(z) = \\exp(z)$，我们有 $F'(z) = \\exp(z)$ 和 $F''(z) = \\exp(z)$。$Z_t$ 的二次变差为 $d\\langle Z \\rangle_t = (\\sigma(t))^2\\,dt = \\sigma(t)^2\\,dt$。\n$$\nd\\Lambda_t = F'(Z_t)\\,dZ_t + \\frac{1}{2}F''(Z_t)\\,d\\langle Z \\rangle_t\n$$\n$$\nd\\Lambda_t = \\exp(Z_t)\\left[\\left(a(t) - \\frac{1}{2}\\sigma(t)^2\\right)dt + \\sigma(t)\\,dW_t\\right] + \\frac{1}{2}\\exp(Z_t)\\,\\sigma(t)^2\\,dt\n$$\n代入 $\\Lambda_t = \\exp(Z_t)$ 并化简：\n$$\nd\\Lambda_t = \\Lambda_t\\left(a(t) - \\frac{1}{2}\\sigma(t)^2\\right)dt + \\Lambda_t\\sigma(t)\\,dW_t + \\frac{1}{2}\\Lambda_t\\sigma(t)^2\\,dt\n$$\n$$\nd\\Lambda_t = \\Lambda_t a(t)\\,dt + \\Lambda_t \\sigma(t)\\,dW_t\n$$\n这证实了 $\\Lambda_t$ 是 SDE 的齐次乘法部分的解。\n\n接下来，我们求 $Y_t$ 的微分。根据其定义为一个常数、一个 Lebesgue 积分和一个 Itô 积分的和，其微分可直接由下式给出：\n$$\ndY_t = \\Lambda_t^{-1}\\,(f(t) + c(t))\\,dt + \\Lambda_t^{-1}\\,g(t)\\,dW_t\n$$\n\n现在我们对 $X_t = \\Lambda_t Y_t$ 应用 Itô 乘积法则：\n$$\ndX_t = Y_t\\,d\\Lambda_t + \\Lambda_t\\,dY_t + d\\langle \\Lambda, Y \\rangle_t\n$$\n二次协变差项 $d\\langle \\Lambda, Y \\rangle_t$ 由 $d\\Lambda_t$ 和 $dY_t$ 的扩散部分计算得出。$d\\Lambda_t$ 的扩散部分是 $\\Lambda_t \\sigma(t)\\,dW_t$，$dY_t$ 的扩散部分是 $\\Lambda_t^{-1}g(t)\\,dW_t$。\n$$\nd\\langle \\Lambda, Y \\rangle_t = (\\Lambda_t \\sigma(t)) \\cdot (\\Lambda_t^{-1} g(t))\\,dt = \\sigma(t) g(t)\\,dt\n$$\n\n我们将 $d\\Lambda_t$、$dY_t$ 和 $d\\langle \\Lambda, Y \\rangle_t$ 的表达式代入乘积法则：\n$$\ndX_t = Y_t \\left( \\Lambda_t a(t)\\,dt + \\Lambda_t \\sigma(t)\\,dW_t \\right) + \\Lambda_t \\left( \\Lambda_t^{-1}(f(t) + c(t))\\,dt + \\Lambda_t^{-1}g(t)\\,dW_t \\right) + \\sigma(t) g(t)\\,dt\n$$\n化简并分配各项：\n$$\ndX_t = a(t) \\Lambda_t Y_t \\,dt + \\sigma(t) \\Lambda_t Y_t \\,dW_t + (f(t) + c(t))\\,dt + g(t)\\,dW_t + \\sigma(t) g(t)\\,dt\n$$\n代回 $X_t = \\Lambda_t Y_t$：\n$$\ndX_t = a(t) X_t \\,dt + \\sigma(t) X_t \\,dW_t + (f(t) + c(t))\\,dt + g(t)\\,dW_t + \\sigma(t) g(t)\\,dt\n$$\n我们按 $dt$ 和 $dW_t$ 对各项进行分组，以识别漂移系数和扩散系数：\n$$\ndX_t = \\underbrace{\\left( a(t)X_t + f(t) + c(t) + \\sigma(t)g(t) \\right)}_{\\text{漂移}} dt + \\underbrace{\\left( \\sigma(t)X_t + g(t) \\right)}_{\\text{扩散}} dW_t\n$$\n现在，我们将其与原始 SDE进行比较：\n$$\ndX_t = \\left( a(t)X_t + f(t) \\right) dt + \\left( \\sigma(t)X_t + g(t) \\right) dW_t\n$$\n扩散系数是相同的：$\\sigma(t)X_t + g(t)$。要使候选解成为真正的解，漂移系数也必须相同。因此，我们令它们相等：\n$$\na(t)X_t + f(t) + c(t) + \\sigma(t)g(t) = a(t)X_t + f(t)\n$$\n从两边减去 $a(t)X_t + f(t)$ 得到：\n$$\nc(t) + \\sigma(t)g(t) = 0\n$$\n解出 $c(t)$ 得到唯一表达式：\n$$\nc(t) = -\\sigma(t)g(t)\n$$\n对 $c(t)$ 的这一选择确保了推导出的 SDE 的漂移与原始 SDE 的漂移相匹配，从而验证了该候选形式确实是解。函数 $c(t)$ 作为一个校正项，解释了与 $\\sigma(t)$ 成正比的乘性噪声项和与 $g(t)$ 成正比的加性噪声项之间的相互作用，这种相互作用通过 Itô 乘积法则中的二次协变差项体现出来。", "answer": "$$\\boxed{-\\sigma(t)g(t)}$$", "id": "2985096"}, {"introduction": "在掌握了一维线性随机微分方程的求解方法后，我们将挑战一个更高维度的问题，即矩阵值的随机微分方程。本练习要求你推导基本解矩阵行列式的随机微分方程，这会引出著名的随机刘维尔公式（stochastic Liouville formula）。通过这个实践，你将学会如何将标量微积分中的技巧推广到矩阵空间，并发现行列式动态与矩阵迹（trace）之间的深刻联系。[@problem_id:2985117]", "problem": "设 $\\{W^{i}_{t}\\}_{i=1}^{m}$ 为一个定义在带滤概率空间上的标准 $m$ 维布朗运动（BM），该空间支持一个 $d \\times d$ 矩阵值的随机微分方程（SDE）。考虑基本解 $\\Phi_{t} \\in \\mathbb{R}^{d \\times d}$ 的线性矩阵 SDE，\n$$\n\\mathrm{d}\\Phi_{t} \\;=\\; A_{t}\\,\\Phi_{t}\\,\\mathrm{d}t \\;+\\; \\sum_{i=1}^{m} B_{i,t}\\,\\Phi_{t}\\,\\mathrm{d}W^{i}_{t}, \n\\qquad \\Phi_{0} \\;=\\; I_{d},\n$$\n其中 $A_{t}$ 和 $B_{i,t}$ 是循序可测的 $\\mathbb{R}^{d \\times d}$ 值过程，具有适当的可积性和有界性，使得该 SDE 几乎必然对所有 $t \\ge 0$ 存在唯一强解，且 $\\Phi_{t} \\in \\mathrm{GL}(d)$。从 $\\mathbb{R}^{d \\times d}$ 上函数的 Itô 公式和基本矩阵微积分恒等式出发，推导 $\\ln \\det(\\Phi_{t})$ 满足的随机微分方程，并由此获得 $\\det(\\Phi_{t})$ 关于 $\\mathrm{tr}(A_{t})$ 和 $\\mathrm{tr}(B_{i,t}^{2})$ 的显式闭式表达式。你的推导必须从第一性原理出发，包括确定函数 $M \\mapsto \\ln \\det(M)$ 的 Fréchet 导数和 Hessian 矩阵，并且只能使用迹的循环性、乘积法则以及 Itô 引理。将你关于 $\\det(\\Phi_{t})$ 的最终答案表示为单个闭式解析表达式。无需进行数值计算。", "solution": "本题要求推导过程 $Y_{t} = \\ln \\det(\\Phi_{t})$ 的随机微分方程（SDE），其中 $\\Phi_{t}$ 是一个线性矩阵 SDE 的基本解，并随后求出 $\\det(\\Phi_{t})$ 的闭式表达式。\n\n给定的 $\\Phi_{t} \\in \\mathbb{R}^{d \\times d}$ 的 SDE 为：\n$$\n\\mathrm{d}\\Phi_{t} = A_{t}\\,\\Phi_{t}\\,\\mathrm{d}t + \\sum_{i=1}^{m} B_{i,t}\\,\\Phi_{t}\\,\\mathrm{d}W^{i}_{t}\n$$\n初始条件为 $\\Phi_{0} = I_{d}$，即 $d \\times d$ 单位矩阵。过程 $A_{t}$ 和 $B_{i,t}$ 是 $\\mathbb{R}^{d \\times d}$ 值的循序可测过程。我们已知 $\\Phi_{t}$ 几乎必然属于一般线性群 $\\mathrm{GL}(d)$，这意味着对所有 $t \\ge 0$ 都有 $\\det(\\Phi_{t}) \\neq 0$。由于 $\\det(\\Phi_{0}) = \\det(I_{d}) = 1 > 0$ 且 $\\det(\\Phi_t)$ 的路径是连续的，我们必有 $\\det(\\Phi_{t}) > 0$（几乎必然），这保证了 $Y_{t} = \\ln \\det(\\Phi_{t})$ 是一个良定义的实值过程。\n\n我们将多维 Itô 引理应用于由 $f(M) = \\ln \\det(M)$ 定义的函数 $f: \\mathrm{GL}(d) \\to \\mathbb{R}$。过程 $\\Phi_{t}$ 可以被视为 $\\mathbb{R}^{d^2}$ 中的一个向量。设 $\\Phi_{t,jk}$ 表示 $\\Phi_t$ 第 $j$ 行第 $k$ 列的元素。$Y_{t} = f(\\Phi_{t})$ 的 Itô 引理为：\n$$\n\\mathrm{d}Y_{t} = \\sum_{j,k=1}^{d} \\frac{\\partial f}{\\partial M_{jk}}(\\Phi_{t}) \\mathrm{d}\\Phi_{t,jk} + \\frac{1}{2} \\sum_{j,k,p,q=1}^{d} \\frac{\\partial^2 f}{\\partial M_{jk}\\partial M_{pq}}(\\Phi_{t}) \\mathrm{d}\\langle \\Phi_{jk}, \\Phi_{pq} \\rangle_{t}\n$$\n$\\Phi_{t}$ 的微分为：\n$$\n\\mathrm{d}\\Phi_{t,jk} = (A_{t}\\Phi_{t})_{jk} \\mathrm{d}t + \\sum_{i=1}^{m} (B_{i,t}\\Phi_{t})_{jk} \\mathrm{d}W^{i}_{t}\n$$\n二次协变项为：\n$$\n\\mathrm{d}\\langle \\Phi_{jk}, \\Phi_{pq} \\rangle_{t} = \\sum_{i=1}^{m} (B_{i,t}\\Phi_{t})_{jk} (B_{i,t}\\Phi_{t})_{pq} \\mathrm{d}t\n$$\n首先，我们必须计算 $f(M) = \\ln \\det(M)$ 的 Fréchet 导数（梯度）和 Hessian 矩阵。\n\n行列式函数的导数由 Jacobi 公式给出：$\\mathrm{d}(\\det(M)) = \\mathrm{tr}(\\mathrm{adj}(M) \\mathrm{d}M) = \\det(M) \\mathrm{tr}(M^{-1} \\mathrm{d}M)$。由此，$\\det(M)$ 关于其元素 $M_{jk}$ 的偏导数是 $M$ 的 $(j,k)$ 代数余子式，可以写为 $(\\det(M) (M^{-T}))_{jk} = \\det(M) (M^{-1})_{kj}$。\n使用链式法则求出 $f(M) = \\ln \\det(M)$ 的导数：\n$$\n\\frac{\\partial f}{\\partial M_{jk}} = \\frac{1}{\\det(M)} \\frac{\\partial \\det(M)}{\\partial M_{jk}} = \\frac{1}{\\det(M)} \\det(M) (M^{-1})_{kj} = (M^{-1})_{kj}\n$$\n用矩阵表示法， $f(M)$ 的梯度是 $D f(M) = (M^{-1})^{T}$。\n\n接下来，我们计算二阶偏导数（Hessian 矩阵）。我们将 $\\frac{\\partial f}{\\partial M_{jk}} = (M^{-1})_{kj}$ 对 $M_{pq}$ 求导。使用矩阵逆的求导公式 $\\frac{\\partial M^{-1}}{\\partial M_{pq}} = -M^{-1} E_{pq} M^{-1}$，其中 $E_{pq}$ 是在 $(p,q)$ 位置为 1 且其他位置为 0 的矩阵单位。\n$$\n\\frac{\\partial^2 f}{\\partial M_{jk}\\partial M_{pq}} = \\frac{\\partial (M^{-1})_{kj}}{\\partial M_{pq}} = (-M^{-1} E_{pq} M^{-1})_{kj} = -\\sum_{r,s} (M^{-1})_{kr} (E_{pq})_{rs} (M^{-1})_{sj} = -(M^{-1})_{kp} (M^{-1})_{qj}\n$$\n现在我们将这些导数代入 Itô 引理。\n\n第一项（来自一阶导数的漂移和扩散）是：\n$$\n\\sum_{j,k=1}^{d} \\frac{\\partial f}{\\partial M_{jk}}(\\Phi_{t}) \\mathrm{d}\\Phi_{t,jk} = \\sum_{j,k=1}^{d} (\\Phi_{t}^{-1})_{kj} \\mathrm{d}\\Phi_{t,jk} = \\mathrm{tr}(\\Phi_{t}^{-1} \\mathrm{d}\\Phi_{t})\n$$\n代入 $\\mathrm{d}\\Phi_{t}$ 的 SDE：\n$$\n\\mathrm{tr}(\\Phi_{t}^{-1} \\mathrm{d}\\Phi_{t}) = \\mathrm{tr}\\left(\\Phi_{t}^{-1} \\left( A_{t}\\Phi_{t}\\mathrm{d}t + \\sum_{i=1}^{m} B_{i,t}\\Phi_{t}\\mathrm{d}W^{i}_{t} \\right)\\right)\n$$\n利用迹算子（$\\mathrm{tr}(XY) = \\mathrm{tr}(YX)$）的线性和循环性：\n$$\n\\mathrm{tr}(\\Phi_{t}^{-1} A_{t}\\Phi_{t}) = \\mathrm{tr}(A_{t})\n$$\n$$\n\\mathrm{tr}(\\Phi_{t}^{-1} B_{i,t}\\Phi_{t}) = \\mathrm{tr}(B_{i,t})\n$$\n所以，第一部分贡献了：\n$$\n\\mathrm{tr}(A_{t}) \\mathrm{d}t + \\sum_{i=1}^{m} \\mathrm{tr}(B_{i,t}) \\mathrm{d}W^{i}_{t}\n$$\n\n第二项（来自二阶导数的 Itô 修正项）是：\n$$\n\\frac{1}{2} \\sum_{j,k,p,q=1}^{d} \\frac{\\partial^2 f}{\\partial M_{jk}\\partial M_{pq}}(\\Phi_{t}) \\mathrm{d}\\langle \\Phi_{jk}, \\Phi_{pq} \\rangle_{t} = \\frac{1}{2} \\sum_{j,k,p,q=1}^{d} (-(\\Phi_{t}^{-1})_{kp} (\\Phi_{t}^{-1})_{qj}) \\left( \\sum_{i=1}^{m} (B_{i,t}\\Phi_{t})_{jk} (B_{i,t}\\Phi_{t})_{pq} \\right) \\mathrm{d}t\n$$\n我们对每个 $i$ 重新排列求和：\n$$\n-\\frac{1}{2} \\sum_{i=1}^{m} \\sum_{j,k,p,q=1}^{d} (\\Phi_{t}^{-1})_{qj} (B_{i,t}\\Phi_{t})_{jk} (\\Phi_{t}^{-1})_{kp} (B_{i,t}\\Phi_{t})_{pq} \\mathrm{d}t\n$$\n我们识别出求和内部的矩阵乘积：\n$\n\\sum_{j,k} (\\Phi_{t}^{-1})_{qj} (B_{i,t}\\Phi_{t})_{jk} = (\\Phi_{t}^{-1} B_{i,t} \\Phi_{t})_{qk}\n$\n这看起来过于复杂了。让我们换一种方式对各项进行分组：\n$$\n-\\frac{1}{2} \\sum_{i=1}^{m} \\left( \\sum_{j,q} (\\Phi_{t}^{-1})_{qj} \\left( \\sum_{k} (B_{i,t}\\Phi_{t})_{jk} \\left( \\sum_{p} (\\Phi_{t}^{-1})_{kp} (B_{i,t}\\Phi_{t})_{pq} \\right) \\right) \\right) \\mathrm{d}t\n$$\n我们来简化内部的和：\n$$\n\\sum_{p} (\\Phi_{t}^{-1})_{kp} (B_{i,t}\\Phi_{t})_{pq} = (\\Phi_{t}^{-1}B_{i,t}\\Phi_{t})_{kq}\n$$\n表达式变为：\n$$\n-\\frac{1}{2} \\sum_{i=1}^{m} \\left( \\sum_{j,q} (\\Phi_{t}^{-1})_{qj} \\sum_{k} (B_{i,t}\\Phi_{t})_{jk} (\\Phi_{t}^{-1}B_{i,t}\\Phi_{t})_{kq} \\right) \\mathrm{d}t\n$$\n$$\n\\sum_{k} (B_{i,t}\\Phi_{t})_{jk} (\\Phi_{t}^{-1}B_{i,t}\\Phi_{t})_{kq} = (B_{i,t}\\Phi_{t} \\Phi_{t}^{-1}B_{i,t}\\Phi_{t})_{jq} = (B_{i,t}^2 \\Phi_{t})_{jq}\n$$\n表达式简化为：\n$$\n-\\frac{1}{2} \\sum_{i=1}^{m} \\left( \\sum_{j,q} (\\Phi_{t}^{-1})_{qj} (B_{i,t}^2 \\Phi_{t})_{jq} \\right) \\mathrm{d}t\n$$\n和 $ \\sum_{j,q} (\\Phi_{t}^{-1})_{qj} (B_{i,t}^2 \\Phi_{t})_{jq} $ 是乘积 $ \\Phi_{t}^{-1}(B_{i,t}^2 \\Phi_{t}) $ 的迹。\n$$\n\\mathrm{tr}(\\Phi_{t}^{-1} B_{i,t}^2 \\Phi_{t}) = \\mathrm{tr}(B_{i,t}^2)\n$$\n因此，二阶导数项的贡献是：\n$$\n-\\frac{1}{2} \\sum_{i=1}^{m} \\mathrm{tr}(B_{i,t}^2) \\mathrm{d}t\n$$\n结合所有项，我们得到 $Y_{t} = \\ln \\det(\\Phi_{t})$ 的 SDE：\n$$\n\\mathrm{d}(\\ln \\det(\\Phi_{t})) = \\left( \\mathrm{tr}(A_{t}) - \\frac{1}{2} \\sum_{i=1}^{m} \\mathrm{tr}(B_{i,t}^2) \\right) \\mathrm{d}t + \\sum_{i=1}^{m} \\mathrm{tr}(B_{i,t}) \\mathrm{d}W^{i}_{t}\n$$\n这是所需推导的第一部分。\n\n为了得到 $\\det(\\Phi_{t})$ 的表达式，我们将 $Y_{t} = \\ln \\det(\\Phi_{t})$ 的 SDE 从 $0$ 积分到 $t$：\n$$\nY_{t} - Y_{0} = \\int_{0}^{t} \\left( \\mathrm{tr}(A_{s}) - \\frac{1}{2} \\sum_{i=1}^{m} \\mathrm{tr}(B_{i,s}^2) \\right) \\mathrm{d}s + \\sum_{i=1}^{m} \\int_{0}^{t} \\mathrm{tr}(B_{i,s}) \\mathrm{d}W^{i}_{s}\n$$\n给定 $\\Phi_{0} = I_{d}$，我们有 $Y_{0} = \\ln \\det(I_{d}) = \\ln(1) = 0$。\n所以，\n$$\n\\ln \\det(\\Phi_{t}) = \\int_{0}^{t} \\left( \\mathrm{tr}(A_{s}) - \\frac{1}{2} \\sum_{i=1}^{m} \\mathrm{tr}(B_{i,s}^2) \\right) \\mathrm{d}s + \\sum_{i=1}^{m} \\int_{0}^{t} \\mathrm{tr}(B_{i,s}) \\mathrm{d}W^{i}_{s}\n$$\n题目要求一个关于 $\\mathrm{tr}(A_{t})$ 和 $\\mathrm{tr}(B_{i,t}^{2})$ 的 $\\det(\\Phi_{t})$ 的显式闭式表达式。上述通解包含涉及 $\\mathrm{tr}(B_{i,s})$ 的随机积分项。为了使最终表达式符合题目要求，这些随机积分项必须为零。一个随机积分 $\\int_{0}^{t} f(s,\\omega) \\mathrm{d}W_{s}$ 恒等于零的充分必要条件是其被积函数 $f(s,\\omega)$ 几乎处处为零。因此，题目陈述隐含要求对所有 $i=1,\\dots,m$ 和几乎所有 $t \\ge 0$ 都有 $\\mathrm{tr}(B_{i,t}) = 0$。在此条件下，$\\ln\\det(\\Phi_t)$ 的 SDE 简化为一个随机常微分方程：\n$$\n\\mathrm{d}(\\ln \\det(\\Phi_{t})) = \\left( \\mathrm{tr}(A_{t}) - \\frac{1}{2} \\sum_{i=1}^{m} \\mathrm{tr}(B_{i,t}^2) \\right) \\mathrm{d}t\n$$\n将其从 $0$ 积分到 $t$ 可得：\n$$\n\\ln \\det(\\Phi_{t}) = \\int_{0}^{t} \\left( \\mathrm{tr}(A_{s}) - \\frac{1}{2} \\sum_{i=1}^{m} \\mathrm{tr}(B_{i,s}^2) \\right) \\mathrm{d}s\n$$\n对两边取指数，得到 $\\det(\\Phi_{t})$ 的最终表达式：\n$$\n\\det(\\Phi_{t}) = \\exp\\left( \\int_{0}^{t} \\left( \\mathrm{tr}(A_{s}) - \\frac{1}{2} \\sum_{i=1}^{m} \\mathrm{tr}(B_{i,s}^2) \\right) \\mathrm{d}s \\right)\n$$\n这就是所要求的闭式表达式，在扩散向量场是无散的（在此线性情况下对应于矩阵 $B_i$ 是无迹的）条件下，也称为随机 Liouville 公式或 Abel-Jacobi-Liouville 公式。", "answer": "$$\\boxed{\\exp\\left(\\int_{0}^{t} \\left(\\mathrm{tr}(A_{s}) - \\frac{1}{2} \\sum_{i=1}^{m} \\mathrm{tr}(B_{i,s}^{2})\\right) \\mathrm{d}s\\right)}$$", "id": "2985117"}, {"introduction": "理论的深度往往通过探索其边界来展现。这个练习提供了一个精心设计的案例，其中一个随机指数（Doléans-Dade exponential）虽然是局部鞅（local martingale），但由于未能满足诺维科夫条件（Novikov’s condition），它并非一个真鞅（true martingale）。通过显式计算解，验证条件的失效，并确定解在终点的极限行为，你将对局部鞅与真鞅之间的微妙区别有更具体的认识。[@problem_id:2985077]", "problem": "设 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t \\ge 0},\\mathbb{P})$ 定义了一个标准布朗运动 $W=(W_t)_{t \\ge 0}$ 和一个独立的伯努利随机变量 $\\xi$，其中 $\\mathbb{P}(\\xi=1)=p \\in (0,1)$ 且 $\\mathbb{P}(\\xi=0)=1-p$。定义渐进可测过程 $b=(b_t)_{t \\in [0,1)}$ 为 $b_t=\\xi (1-t)^{-1/2}$（对于 $t \\in [0,1)$）且 $b_1:=0$。考虑线性随机微分方程 (SDE)\n$$\ndX_t \\;=\\; X_t\\,b_t\\,dW_t,\\qquad X_0=1,\\qquad t \\in [0,1).\n$$\n任务：\n- 从 Doléans–Dade 指数作为由布朗运动驱动的线性 SDE 的唯一强解的定义出发，推导 $t \\in [0,1)$ 时 $X_t$ 的一个显式表达式。\n- 使用基本原理和关于指数局部鞅的已知事实，验证 Novikov 条件在 $[0,1]$ 上对过程 $b$ 不成立。\n- 证明 $X_t$ 存在一个几乎必然 (a.s.) 的极限 $X_1:=\\lim_{t \\uparrow 1}X_t$，并用 $\\xi$ 显式地表示 $X_1$。\n- 最后，计算期望 $\\mathbb{E}[X_1]$ 作为 $p$ 的函数。将你的最终答案表示为一个闭式解析表达式。无需四舍五入。", "solution": "问题陈述经评估有效。它在科学上基于随机微分方程理论，是适定且客观的。它提供了执行所要求任务所需的所有必要信息。\n\n该问题要求对一个线性随机微分方程 (SDE) 的解进行四部分分析。我们按顺序处理每个部分。\n\nSDE 由下式给出\n$$\ndX_t = X_t b_t dW_t, \\qquad X_0=1, \\qquad t \\in [0,1)\n$$\n其中 $b_t = \\xi (1-t)^{-1/2}$（对于 $t \\in [0,1)$），$\\xi$ 是一个独立于标准布朗运动 $W_t$ 的伯努利随机变量。我们有 $\\mathbb{P}(\\xi=1)=p$ 和 $\\mathbb{P}(\\xi=0)=1-p$（对于 $p \\in (0,1)$）。\n\n**第 1 部分：$t \\in [0,1)$ 时 $X_t$ 的显式表达式**\n\n给定的 SDE 是 Doléans-Dade 指数（也称为随机指数）的标准形式。对于形式为 $dZ_t = Z_t dM_t$ 且 $Z_0=1$ 的 SDE，其中 $M_t$ 是一个连续局部鞅，其唯一强解由 $Z_t = \\mathcal{E}(M)_t$ 给出。\n\n在我们的例子中，驱动过程是 Itô 积分 $M_t = \\int_0^t b_s dW_s$。由于 $b_s$ 是渐进可测的，并且对于每个 $t \\in [0,1)$ 几乎必然满足 $\\int_0^t b_s^2 ds < \\infty$，因此 $M_t$ 是一个连续局部鞅。它的二次变差过程是 $\\langle M \\rangle_t = \\int_0^t b_s^2 ds$。\n\n让我们计算这个二次变差。由于 $\\xi$ 是一个伯努利随机变量，它只取值 $0$ 或 $1$，所以 $\\xi^2 = \\xi$。\n$$\n\\langle M \\rangle_t = \\int_0^t b_s^2 ds = \\int_0^t \\left(\\xi (1-s)^{-1/2}\\right)^2 ds = \\xi^2 \\int_0^t (1-s)^{-1} ds = \\xi \\int_0^t \\frac{1}{1-s} ds\n$$\n积分计算结果为：\n$$\n\\int_0^t \\frac{1}{1-s} ds = [-\\ln(1-s)]_0^t = -\\ln(1-t) - (-\\ln(1-0)) = -\\ln(1-t)\n$$\n因此，二次变差为 $\\langle M \\rangle_t = -\\xi \\ln(1-t)$。\n\n$X_t$ 的显式解由 Doléans-Dade 指数的公式给出：\n$$\nX_t = \\mathcal{E}(M)_t = \\exp\\left( M_t - \\frac{1}{2}\\langle M \\rangle_t \\right)\n$$\n代入 $M_t$ 和 $\\langle M \\rangle_t$ 的表达式，我们得到：\n$$\nX_t = \\exp\\left( \\xi \\int_0^t (1-s)^{-1/2} dW_s + \\frac{1}{2}\\xi \\ln(1-t) \\right)\n$$\n这就是 $t \\in [0,1)$ 时 $X_t$ 的显式表达式。\n\n**第 2 部分：验证 Novikov 条件不成立**\n\nNovikov 条件指出，如果 $\\mathbb{E}\\left[\\exp\\left(\\frac{1}{2}\\langle M \\rangle_T\\right)\\right] < \\infty$，则局部鞅 $X_t=\\mathcal{E}(M)_t$ 在区间 $[0,T]$上是一个真鞅。我们需要检验我们的过程在区间 $[0,1]$ 上是否满足此条件，因此我们令 $T=1$。\n\n首先，我们确定在时间 $t=1$ 时的二次变差：\n$$\n\\langle M \\rangle_1 = \\lim_{t \\uparrow 1} \\langle M \\rangle_t = \\lim_{t \\uparrow 1} (-\\xi \\ln(1-t))\n$$\n当 $t \\uparrow 1$ 时，$(1-t) \\downarrow 0$，所以 $\\ln(1-t) \\to -\\infty$。因此：\n$$\n\\langle M \\rangle_1 = \\begin{cases} \\infty & \\text{若 } \\xi=1 \\\\ 0 & \\text{若 } \\xi=0 \\end{cases}\n$$\n现在，我们使用全期望定律，通过对 $\\xi$ 的值进行条件化来计算 Novikov 条件中的期望：\n$$\n\\mathbb{E}\\left[\\exp\\left(\\frac{1}{2}\\langle M \\rangle_1\\right)\\right] = \\mathbb{E}\\left[\\exp\\left(\\frac{1}{2}\\langle M \\rangle_1\\right) \\Big| \\xi=1\\right]\\mathbb{P}(\\xi=1) + \\mathbb{E}\\left[\\exp\\left(\\frac{1}{2}\\langle M \\rangle_1\\right) \\Big| \\xi=0\\right]\\mathbb{P}(\\xi=0)\n$$\n如果 $\\xi=1$，则 $\\langle M \\rangle_1 = \\infty$，所以 $\\exp\\left(\\frac{1}{2}\\langle M \\rangle_1\\right) = \\exp(\\infty) = \\infty$。\n如果 $\\xi=0$，则 $\\langle M \\rangle_1 = 0$，所以 $\\exp\\left(\\frac{1}{2}\\langle M \\rangle_1\\right) = \\exp(0) = 1$。\n\n将这些代入期望公式，其中 $\\mathbb{P}(\\xi=1)=p$ 和 $\\mathbb{P}(\\xi=0)=1-p$：\n$$\n\\mathbb{E}\\left[\\exp\\left(\\frac{1}{2}\\langle M \\rangle_1\\right)\\right] = (\\infty) \\cdot p + (1) \\cdot (1-p)\n$$\n由于 $p \\in (0,1)$，$p>0$，第一项是无穷大。因此，期望是无穷大：\n$$\n\\mathbb{E}\\left[\\exp\\left(\\frac{1}{2}\\langle M \\rangle_1\\right)\\right] = \\infty\n$$\nNovikov 条件在区间 $[0,1]$ 上不满足。\n\n**第 3 部分：几乎必然极限 $X_1$ 及其确定**\n\n我们需要几乎必然地计算 $X_1 := \\lim_{t \\uparrow 1} X_t$。我们通过对 $\\xi$ 进行条件化来分析这个极限。\n\n情况 1：$\\xi = 0$。\n如果 $\\xi=0$，则对所有 $t$ 都有 $b_t=0$。SDE 变为 $dX_t = 0$ 且 $X_0=1$。解显然是 $X_t=1$（对于所有 $t \\in [0,1)$）。极限是 $\\lim_{t \\uparrow 1} X_t = 1$。\n使用我们对 $X_t$ 的显式公式：\n$$\nX_t = \\exp\\left( 0 \\cdot \\int_0^t (1-s)^{-1/2} dW_s + \\frac{1}{2} \\cdot 0 \\cdot \\ln(1-t) \\right) = \\exp(0) = 1\n$$\n极限确实是 1。\n\n情况 2：$\\xi = 1$。\n如果 $\\xi=1$，$X_t$ 的表达式为：\n$$\nX_t = \\exp\\left( \\int_0^t (1-s)^{-1/2} dW_s + \\frac{1}{2} \\ln(1-t) \\right)\n$$\n让我们分析指数中的项。令 $Y_t = \\int_0^t (1-s)^{-1/2} dW_s$。这是一个连续局部鞅，其二次变差为 $\\langle Y \\rangle_t = \\int_0^t (1-s)^{-1} ds = -\\ln(1-t)$。\n根据 Dambis-Dubins-Schwarz 定理，$Y_t$ 可以表示为一个时间变换的布朗运动：$Y_t = B_{\\langle Y \\rangle_t}$，其中 $B$ 是一个标准布朗运动。\n所以，$Y_t = B_{-\\ln(1-t)}$。\n将此代入 $X_t$ 的表达式：\n$$\nX_t = \\exp\\left( B_{-\\ln(1-t)} - \\frac{1}{2}(-\\ln(1-t)) \\right)\n$$\n令 $u = -\\ln(1-t)$。当 $t \\uparrow 1$ 时，我们有 $u \\to \\infty$。所以我们关心的是极限：\n$$\n\\lim_{u \\to \\infty} \\exp\\left( B_u - \\frac{1}{2}u \\right)\n$$\n这是一个漂移为 $-\\frac{1}{2}$、波动率为 $1$ 的几何布朗运动的极限。根据重对数律，$\\limsup_{u\\to\\infty} \\frac{|B_u|}{\\sqrt{2u \\ln \\ln u}} = 1$，这意味着 $\\lim_{u\\to\\infty} \\frac{B_u}{u}=0$ 几乎必然成立。因此，对于大的 $u$，项 $-\\frac{1}{2}u$ 主导了项 $B_u$。\n$$\n\\lim_{u \\to \\infty} \\left(B_u - \\frac{1}{2}u\\right) = -\\infty \\quad \\text{a.s.}\n$$\n因此，指数的极限是：\n$$\n\\lim_{u \\to \\infty} \\exp\\left( B_u - \\frac{1}{2}u \\right) = \\lim_{z \\to -\\infty} \\exp(z) = 0 \\quad \\text{a.s.}\n$$\n所以，如果 $\\xi=1$，我们有 $\\lim_{t \\uparrow 1} X_t = 0$ 几乎必然成立。\n\n结合两种情况，几乎必然极限 $X_1$ 是：\n$$\nX_1 = \\begin{cases} 0 & \\text{若 } \\xi=1 \\\\ 1 & \\text{若 } \\xi=0 \\end{cases}\n$$\n这可以简洁地用 $\\xi$ 表示为 $X_1 = 1-\\xi$。\n\n**第 4 部分：$\\mathbb{E}[X_1]$ 的计算**\n\n我们已经确定了 $X_1 = 1-\\xi$。现在我们可以直接计算其期望。\n$$\n\\mathbb{E}[X_1] = \\mathbb{E}[1-\\xi]\n$$\n根据期望的线性性：\n$$\n\\mathbb{E}[X_1] = 1 - \\mathbb{E}[\\xi]\n$$\n随机变量 $\\xi$ 服从参数为 $p$ 的伯努利分布。其期望由下式给出：\n$$\n\\mathbb{E}[\\xi] = 1 \\cdot \\mathbb{P}(\\xi=1) + 0 \\cdot \\mathbb{P}(\\xi=0) = 1 \\cdot p + 0 \\cdot (1-p) = p\n$$\n将此代回，我们得到 $X_1$ 的期望：\n$$\n\\mathbb{E}[X_1] = 1-p\n$$\n这是期望的最终解析表达式。请注意，对于任何 $t<1$，$X_t$ 是一个真鞅，所以 $\\mathbb{E}[X_t]=X_0=1$。然而，$\\lim_{t\\uparrow 1}\\mathbb{E}[X_t] = 1 \\neq \\mathbb{E}[X_1]=1-p$。极限和期望的交换是不允许的，这与 Novikov 条件不成立以及 $X_t$ 是 $[0,1]$ 上的严格局部鞅这一事实相符。", "answer": "$$\\boxed{1-p}$$", "id": "2985077"}]}