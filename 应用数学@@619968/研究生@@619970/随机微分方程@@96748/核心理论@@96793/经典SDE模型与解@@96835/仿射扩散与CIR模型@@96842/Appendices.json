{"hands_on_practices": [{"introduction": "本章节的第一个实践将引导您完成仿射扩散研究中的一项基础性推导：获得 Cox-Ingersoll-Ross (CIR) 模型的转移概率密度。通过将 CIR 过程与一个多维 Ornstein-Uhlenbeck 过程的范数平方联系起来，您将利用非中心卡方分布的性质，最终得到其著名的闭式解 [@problem_id:2969020]。这项练习对于理解 CIR 模型的解析易处理性至关重要，并为精确模拟方法提供了坚实的理论基础。", "problem": "考虑由以下随机微分方程定义的 Cox–Ingersoll–Ross (CIR) 扩散过程 $X_t$\n$$\n\\mathrm{d}X_t \\;=\\; \\kappa\\left(\\theta - X_t\\right)\\mathrm{d}t \\;+\\; \\sigma\\sqrt{X_t}\\,\\mathrm{d}W_t,\\qquad X_0=x>0,\n$$\n其中 $\\kappa>0$、$\\theta>0$ 和 $\\sigma>0$ 为常数，$W_t$ 是标准布朗运动。假设 Feller 条件 $2\\kappa\\theta>\\sigma^2$ 成立，因此原点不可及，状态空间为 $(0,\\infty)$。\n\n从仿射扩散过程和平方贝塞尔过程理论的第一性原理出发，使用变换和时间变换的方法，将 $X_t$ 的分布确定为一个经过缩放的非中心卡方随机变量。然后，从已知的非中心卡方分布的概率密度函数 (PDF) 出发，通过适当的变量替换，求出在 $X_0=x$ 条件下，$X_t$ 的转移密度 $p(t,x,y)$，其中 $t>0$ 且 $y>0$。\n\n请用第一类修正贝塞尔函数 $I_{\\alpha}$ 表示最终答案的封闭形式，并将其写成一个包含参数 $\\kappa$、$\\theta$、$\\sigma$、$t$、$x$ 和 $y$ 的单一解析表达式。\n\n不得假定目标密度的任何中间公式；应从平方贝塞尔过程的基本特性推导出其表达式。最终答案必须是单一的封闭形式解析表达式。不要进行四舍五入或近似计算。", "solution": "推导 Cox-Ingersoll-Ross (CIR) 过程的转移密度这一问题是有效的。该问题在科学上基于随机微分方程理论，是适定的、客观的。所有必要的参数和条件均已提供，这个任务是该领域一个标准但较为高级的推导。\n\nCIR 过程 $X_t$ 由以下随机微分方程 (SDE) 描述：\n$$\n\\mathrm{d}X_t = \\kappa(\\theta - X_t)\\mathrm{d}t + \\sigma\\sqrt{X_t}\\,\\mathrm{d}W_t, \\qquad X_0=x>0\n$$\n其中 $\\kappa$、$\\theta$ 和 $\\sigma$ 是正常数，$W_t$ 是一维标准布朗运动。假设 Feller 条件 $2\\kappa\\theta > \\sigma^2$ 成立，这确保了对于所有 $t>0$，$X_t > 0$。我们的目标是推导出在 $t>0$ 和 $y>0$ 时，转移概率密度函数 $p(t,x,y) = \\mathbb{P}(X_t \\in \\mathrm{d}y | X_0=x) / \\mathrm{d}y$。\n\n根据问题陈述的指引，推导过程分为四个主要步骤：\n1.  建立 CIR 过程与一个多维 Ornstein-Uhlenbeck (OU) 过程的平方范数之间的联系。\n2.  通过分析底层 OU 过程的分布，确定该平方范数过程的概率分布。\n3.  确认此分布为一个经过缩放的非中心卡方分布。\n4.  对已知的非中心卡方分布的概率密度函数 (PDF) 进行变量替换，以获得所需的转移密度 $p(t,x,y)$。\n\n**第一步：CIR 过程与平方 OU 过程之间的联系**\n\n令 $V_t$ 为一个 $d$ 维向量 OU 过程，满足以下 SDE：\n$$\n\\mathrm{d}V_t = -\\frac{\\kappa}{2}V_t\\,\\mathrm{d}t + \\frac{\\sigma}{2}\\mathrm{d}W_t\n$$\n其中 $W_t$ 是一个具有独立分量 $W_t^i$ 的 $d$ 维标准布朗运动。设初始条件为 $V_0 = v_0$。\n\n我们定义一个新过程 $Z_t = |V_t|^2 = \\sum_{i=1}^d (V_t^i)^2$。为了找到 $Z_t$ 的 SDE，我们首先对单个分量的平方 $(V_t^i)^2$ 应用 Itô 引理：\n$$\n\\mathrm{d}(V_t^i)^2 = 2V_t^i\\,\\mathrm{d}V_t^i + \\mathrm{d}\\langle V^i, V^i \\rangle_t\n$$\n$$\n\\mathrm{d}(V_t^i)^2 = 2V_t^i\\left(-\\frac{\\kappa}{2}V_t^i\\,\\mathrm{d}t + \\frac{\\sigma}{2}\\mathrm{d}W_t^i\\right) + \\left(\\frac{\\sigma}{2}\\right)^2\\mathrm{d}t\n$$\n$$\n\\mathrm{d}(V_t^i)^2 = \\left(-\\kappa(V_t^i)^2 + \\frac{\\sigma^2}{4}\\right)\\mathrm{d}t + \\sigma V_t^i\\,\\mathrm{d}W_t^i\n$$\n对所有 $d$ 个分量求和：\n$$\n\\mathrm{d}Z_t = \\sum_{i=1}^d \\mathrm{d}(V_t^i)^2 = \\sum_{i=1}^d \\left(-\\kappa(V_t^i)^2 + \\frac{\\sigma^2}{4}\\right)\\mathrm{d}t + \\sigma\\sum_{i=1}^d V_t^i\\,\\mathrm{d}W_t^i\n$$\n$$\n\\mathrm{d}Z_t = \\left(-\\kappa \\sum_{i=1}^d (V_t^i)^2 + d\\frac{\\sigma^2}{4}\\right)\\mathrm{d}t + \\sigma\\sum_{i=1}^d V_t^i\\,\\mathrm{d}W_t^i\n$$\n$$\n\\mathrm{d}Z_t = \\left(d\\frac{\\sigma^2}{4} - \\kappa Z_t\\right)\\mathrm{d}t + \\sigma\\sum_{i=1}^d V_t^i\\,\\mathrm{d}W_t^i\n$$\n鞅项的二次变分为：\n$$\n\\left\\langle \\sigma\\sum_{i=1}^d V_t^i\\,\\mathrm{d}W_t^i \\right\\rangle_t = \\sigma^2 \\sum_{i,j=1}^d V_t^i V_t^j \\mathrm{d}\\langle W^i, W^j \\rangle_t = \\sigma^2 \\sum_{i=1}^d (V_t^i)^2\\,\\mathrm{d}t = \\sigma^2 Z_t\\,\\mathrm{d}t\n$$\n根据 Lévy 的布朗运动特征定理，项 $\\sigma\\sum_{i=1}^d V_t^i\\,\\mathrm{d}W_t^i$ 可以被表示为 $\\sigma\\sqrt{Z_t}\\,\\mathrm{d}\\tilde{W}_t$，其中 $\\tilde{W}_t$ 是某个新的一维标准布朗运动。\n因此，$Z_t$ 的 SDE 为：\n$$\n\\mathrm{d}Z_t = \\left(d\\frac{\\sigma^2}{4} - \\kappa Z_t\\right)\\mathrm{d}t + \\sigma\\sqrt{Z_t}\\,\\mathrm{d}\\tilde{W}_t\n$$\n如果我们将漂移项系数相等，那么这个 SDE 就与 CIR SDE $\\mathrm{d}X_t = \\kappa(\\theta - X_t)\\mathrm{d}t + \\sigma\\sqrt{X_t}\\,\\mathrm{d}W_t$ 的形式相匹配：\n$$\nd\\frac{\\sigma^2}{4} = \\kappa\\theta \\implies d = \\frac{4\\kappa\\theta}{\\sigma^2}\n$$\n这说明 CIR 过程 $X_t$ 与一个 $d$ 维 OU 过程的平方范数具有相同的分布，其中维度 $d$ 由 CIR 参数决定。初始条件 $X_0=x$ 对应于 $Z_0=x$，因此我们设 $|v_0|^2 = x$。注意，$d$ 不一定为整数。Feller 条件 $2\\kappa\\theta > \\sigma^2$ 等价于 $d>2$。\n\n**第二步：OU 过程的分布**\n\n$d$ 维 OU 过程 SDE 的解为：\n$$\nV_t = V_0 \\exp\\left(-\\frac{\\kappa}{2}t\\right) + \\frac{\\sigma}{2}\\int_0^t \\exp\\left(-\\frac{\\kappa}{2}(t-s)\\right)\\mathrm{d}W_s\n$$\n由于 $V_0=v_0$是确定性的，且积分是高斯过程的线性变换，因此 $V_t$ 是一个多元正态分布的随机向量。\n均值向量为：\n$$\n\\mathbb{E}[V_t] = v_0 \\exp\\left(-\\frac{\\kappa}{2}t\\right)\n$$\n协方差矩阵为 $C_t = \\mathbb{E}[(V_t - \\mathbb{E}[V_t])(V_t - \\mathbb{E}[V_t])^T]$。其分量为：\n$$\n(C_t)_{ij} = \\mathbb{E}\\left[\\left(\\frac{\\sigma}{2}\\int_0^t \\exp\\left(-\\frac{\\kappa}{2}(t-s)\\right)\\mathrm{d}W_s^i\\right)\\left(\\frac{\\sigma}{2}\\int_0^t \\exp\\left(-\\frac{\\kappa}{2}(t-u)\\right)\\mathrm{d}W_u^j\\right)\\right]\n$$\n根据 Itô 等距性质，仅当 $i=j$ 时该项非零：\n$$\n(C_t)_{ii} = \\frac{\\sigma^2}{4}\\int_0^t \\exp(-\\kappa(t-s))\\,\\mathrm{d}s = \\frac{\\sigma^2}{4}\\left[\\frac{\\exp(-\\kappa(t-s))}{\\kappa}\\right]_0^t = \\frac{\\sigma^2}{4\\kappa}(1 - \\exp(-\\kappa t))\n$$\n所以，协方差矩阵为 $C_t = \\Sigma^2(t) I_d$，其中 $I_d$ 是 $d \\times d$ 单位矩阵，每个分量的方差为 $\\Sigma^2(t) = \\frac{\\sigma^2}{4\\kappa}(1 - \\exp(-\\kappa t))$。\n因此，$V_t \\sim \\mathcal{N}\\left(v_0 \\exp(-\\frac{\\kappa}{2}t), \\Sigma^2(t)I_d\\right)$。\n\n**第三步：确认为经过缩放的非中心卡方分布**\n\n一个具有 $d$ 个自由度和非中心参数 $\\lambda$ 的非中心卡方随机变量，记作 $\\chi'^2(d, \\lambda)$，其定义为 $d$ 个独立的、方差为 1 的正态随机变量的平方和，这些随机变量的均值为 $\\mu_i$，满足 $\\sum_{i=1}^d \\mu_i^2 = \\lambda$。\n\n考虑标准化随机向量 $Z_t = V_t/\\Sigma(t)$。它服从正态分布，其均值为 $\\mathbb{E}[Z_t] = \\frac{v_0}{\\Sigma(t)}\\exp(-\\frac{\\kappa}{2} t)$，协方差矩阵为 $I_d$。\n平方和 $|Z_t|^2 = |V_t|^2/\\Sigma^2(t) = X_t/\\Sigma^2(t)$ 服从非中心卡方分布，其参数为：\n-   自由度：$d = \\frac{4\\kappa\\theta}{\\sigma^2}$.\n-   非中心参数 $\\lambda_t$：\n    $$\n    \\lambda_t = |\\mathbb{E}[Z_t]|^2 = \\frac{|v_0|^2}{\\Sigma^2(t)}\\exp(-\\kappa t) = \\frac{x \\exp(-\\kappa t)}{\\frac{\\sigma^2}{4\\kappa}(1-\\exp(-\\kappa t))} = \\frac{4\\kappa x \\exp(-\\kappa t)}{\\sigma^2(1-\\exp(-\\kappa t))}\n    $$\n因此，随机变量 $X_t$ 的分布为一个缩放因子乘以一个非中心卡方变量：\n$$\nX_t \\sim \\Sigma^2(t) \\cdot \\chi'^2(d, \\lambda_t) = \\frac{\\sigma^2(1-\\exp(-\\kappa t))}{4\\kappa} \\cdot \\chi'^2\\left(\\frac{4\\kappa\\theta}{\\sigma^2}, \\frac{4\\kappa x \\exp(-\\kappa t)}{\\sigma^2(1-\\exp(-\\kappa t))}\\right)\n$$\n\n**第四步：推导转移密度**\n\n令 $Y \\sim \\chi'^2(d, \\lambda)$。其 PDF 由下式给出：\n$$\nf_Y(y; d, \\lambda) = \\frac{1}{2}\\exp\\left(-\\frac{y+\\lambda}{2}\\right)\\left(\\frac{y}{\\lambda}\\right)^{\\frac{d-2}{4}} I_{\\frac{d}{2}-1}(\\sqrt{\\lambda y})\n$$\n其中 $I_\\alpha$ 是阶数为 $\\alpha$ 的第一类修正贝塞尔函数。\n\n我们有关系式 $X_t = \\Sigma^2(t) Y$，因此 $Y = X_t / \\Sigma^2(t)$。令 $p(t,x,y_{val})$ 表示 $X_t$ 在值 $y_{val}$ 处的 PDF。根据 PDF 的变量替换公式：\n$$\np(t,x,y_{val}) = f_Y\\left(\\frac{y_{val}}{\\Sigma^2(t)}; d, \\lambda_t\\right) \\cdot \\left|\\frac{\\mathrm{d}Y}{\\mathrm{d}X_t}\\right| = f_Y\\left(\\frac{y_{val}}{\\Sigma^2(t)}; d, \\lambda_t\\right) \\cdot \\frac{1}{\\Sigma^2(t)}\n$$\n为方便起见，我们定义以下量：\n$$\nc_t = \\frac{4\\kappa}{\\sigma^2(1-\\exp(-\\kappa t))} = \\frac{1}{\\Sigma^2(t)}\n$$\n$$\nq = \\frac{d}{2}-1 = \\frac{2\\kappa\\theta}{\\sigma^2}-1\n$$\n注意 $\\lambda_t = c_t x \\exp(-\\kappa t)$。\n代入 $p(t,x,y)$ 的公式 (使用 $y$ 代替 $y_{val}$):\n$$\np(t,x,y) = c_t \\cdot \\frac{1}{2}\\exp\\left(-\\frac{c_t y + \\lambda_t}{2}\\right)\\left(\\frac{c_t y}{\\lambda_t}\\right)^{\\frac{q}{2}} I_q\\left(\\sqrt{\\lambda_t c_t y}\\right)\n$$\n代入 $\\lambda_t = c_t x \\exp(-\\kappa t)$：\n$$\np(t,x,y) = \\frac{c_t}{2}\\exp\\left(-\\frac{c_t(y + x\\exp(-\\kappa t))}{2}\\right)\\left(\\frac{c_t y}{c_t x\\exp(-\\kappa t)}\\right)^{\\frac{q}{2}} I_q\\left(\\sqrt{c_t x\\exp(-\\kappa t) \\cdot c_t y}\\right)\n$$\n简化各项：\n-   指数项：$-\\frac{c_t}{2}(y + x\\exp(-\\kappa t))$\n-   比率项：$\\left(\\frac{y}{x\\exp(-\\kappa t)}\\right)^{q/2}$\n-   贝塞尔函数参数：$c_t \\sqrt{xy\\exp(-\\kappa t)}$\n\n代入 $c_t$ 和 $q$ 的完整表达式，得到最终的转移密度：\n$p(t,x,y) = \\frac{2\\kappa}{\\sigma^2(1-\\exp(-\\kappa t))} \\exp\\left(-\\frac{2\\kappa(y+x\\exp(-\\kappa t))}{\\sigma^2(1-\\exp(-\\kappa t))}\\right) \\left(\\frac{y}{x\\exp(-\\kappa t)}\\right)^{\\frac{1}{2}(\\frac{2\\kappa\\theta}{\\sigma^2}-1)} I_{\\frac{2\\kappa\\theta}{\\sigma^2}-1}\\left(\\frac{4\\kappa\\sqrt{xy\\exp(-\\kappa t)}}{\\sigma^2(1-\\exp(-\\kappa t))}\\right)$\n\n这个表达式就是 CIR 过程的转移密度。", "answer": "$$\n\\boxed{\\frac{2\\kappa}{\\sigma^2(1-\\exp(-\\kappa t))} \\exp\\left(-\\frac{2\\kappa(y+x\\exp(-\\kappa t))}{\\sigma^2(1-\\exp(-\\kappa t))}\\right) \\left(\\frac{y}{x\\exp(-\\kappa t)}\\right)^{\\frac{1}{2}\\left(\\frac{2\\kappa\\theta}{\\sigma^2}-1\\right)} I_{\\frac{2\\kappa\\theta}{\\sigma^2}-1}\\left(\\frac{4\\kappa\\sqrt{xy\\exp(-\\kappa t)}}{\\sigma^2(1-\\exp(-\\kappa t))}\\right)}\n$$", "id": "2969020"}, {"introduction": "在了解了仿射扩散的分析特性之后，本实践将重点转向计算验证与分析。您将为 Vasicek 和 CIR 模型实现精确的模拟方案，以通过经验方式测量它们的分布收敛到其理论平稳状态的速度 [@problem_id:2429591]。这项练习对于培养蒙特卡洛模拟的实践技能、理解模型的“混合时间”概念，以及体会使用精确转移律相对于更简单但欠准确的离散化方法的优越性，都具有不可估量的价值。", "problem": "给定两个用于计算经济学和金融学的连续时间短利率模型，每个模型都被定义为风险中性测度下的一个一维 Itô 扩散。这些模型由其随机微分方程 (SDE) 指定，这些方程应被视为模型定义。\n\n模型 A (Vasicek，也称为 Ornstein–Uhlenbeck 短利率模型)：\n$$\ndr_t = \\kappa \\left(\\theta - r_t\\right) \\, dt + \\sigma \\, dW_t.\n$$\n\n模型 B (Cox–Ingersoll–Ross)：\n$$\ndr_t = \\kappa \\left(\\theta - r_t\\right) \\, dt + \\sigma \\sqrt{r_t} \\, dW_t, \\quad r_t \\ge 0.\n$$\n\n这里，$r_t$ 是时间 $t$ 的短利率，$\\kappa > 0$ 是均值回归速度，$\\theta$ 是长期均值水平，$\\sigma > 0$ 是波动率参数，$W_t$ 是一个标准布朗运动。\n\n任务：\n1) 使用一维 Itô 扩散（漂移项为 $a(r)$，扩散系数为 $b(r)$）的平稳（不依赖于时间）Kolmogorov 正向（Fokker–Planck）方程，从第一性原理出发，推导每个模型的平稳概率密度函数 $p(r)$，包括其自然支撑集。您的推导必须从平稳正向方程和自然边界上概率流为零的边界条件开始。以完全归一化的形式表示 $p(r)$，并提供相应的累积分布函数。不要假设任何关于平稳密度的快捷公式；相反，应从模型 SDEs 中明确推导它们。\n\n2) 设计一个蒙特卡罗程序，该程序模拟每个模型，并从不同的初始条件 $r_0$ 开始，经验性地测量模拟的 $r_t$ 边际分布收敛到平稳分布 $p(r)$ 的速度。您的模拟必须：\n- 对两个模型，在具有均匀间距 $\\Delta t$ 的固定监测网格上，均使用精确的单步转移抽样，而不是近似的欧拉方案。\n- 对于模型 A (Vasicek)，使用由线性 SDE 蕴含的精确高斯转移。\n- 对于模型 B (Cox–Ingersoll–Ross)，使用以 $r_t$ 为条件的 $r_{t+\\Delta t}$ 的精确非中心卡方分布转移。\n- 在每个监测时间 $t_k = k \\Delta t$，计算模拟集合的经验分布与在第 1 部分中推导的理论平稳分布 $p(r)$ 之间的 Kolmogorov-Smirnov 统计量 $D_k$。对于一个连续的目标累积分布函数 $F(r)$ 和一个经验样本 $\\{x_i\\}_{i=1}^n$，Kolmogorov-Smirnov 统计量为\n$$\nD = \\sup_{r \\in \\mathbb{R}} \\left| F(r) - \\hat{F}_n(r) \\right|,\n$$\n其中 $\\hat{F}_n$ 是样本的经验累积分布函数。\n- 将估计的混合时间定义为满足 $D_k \\le \\varepsilon$ 的最小监测时间 $t_k$。如果在指定的时间上限 $T_{\\max}$ 内从未满足此条件，则返回 $T_{\\max}$。\n\n3) 实现一个完整、可运行的程序，该程序：\n- 使用从第 1 部分推导出的平稳分布。\n- 根据第 2 部分的规定，使用精确的单步转移来模拟两个模型下的独立路径。\n- 使用 Kolmogorov-Smirnov 统计量和阈值 $\\varepsilon$ 计算下面每个测试用例的混合时间。\n- 按指定格式在单行上输出混合时间。\n\n模拟和报告要求：\n- 对每个测试用例使用 $n = 10000$ 条独立路径。\n- 使用固定监测步长 $\\Delta t = 0.05$ 年和最大时间范围 $T_{\\max} = 10.0$ 年。\n- 使用 Kolmogorov-Smirnov 阈值 $\\varepsilon = 0.02$（以十进制数表示，而非百分比）。\n- 为保证可复现性，将随机数生成器种子固定为 $12345$。\n- 以年为单位报告每个混合时间，并四舍五入到 3 位小数。\n\n测试套件（六个案例）：\n- 案例 1 (Vasicek): $\\kappa = 1.0$, $\\theta = 0.05$, $\\sigma = 0.02$, $r_0 = 0.00$.\n- 案例 2 (Vasicek): $\\kappa = 1.0$, $\\theta = 0.05$, $\\sigma = 0.02$, $r_0 = 0.20$.\n- 案例 3 (Vasicek): $\\kappa = 1.0$, $\\theta = 0.05$, $\\sigma = 0.02$, $r_0 = -0.05$.\n- 案例 4 (Cox–Ingersoll–Ross): $\\kappa = 1.2$, $\\theta = 0.04$, $\\sigma = 0.25$, $r_0 = 0.001$.\n- 案例 5 (Cox–Ingersoll–Ross): $\\kappa = 1.2$, $\\theta = 0.04$, $\\sigma = 0.25$, $r_0 = 0.04$.\n- 案例 6 (Cox–Ingersoll–Ross): $\\kappa = 1.2$, $\\theta = 0.04$, $\\sigma = 0.25$, $r_0 = 0.20$.\n\n最终输出格式：\n- 您的程序应生成单行，其中包含一个 Python 风格的列表，内含 6 个浮点数，代表案例 1 到案例 6 的混合时间，按顺序排列，以年为单位表示并四舍五入到 3 位小数，例如：\n\"[t1,t2,t3,t4,t5,t6]\"。\n\n不应读取任何用户输入；所有常量和测试用例均如上固定，并且必须嵌入到程序中。程序必须仅依赖于标准库以及执行环境中指定的数值库。", "solution": "所提出的问题是计算金融学中关于短利率模型分析的一个标准练习。它具有科学依据，问题提法清晰且完整。我将按要求分三部分进行解答：平稳分布的解析推导、用于收敛性分析的蒙特卡罗模拟设计，以及完整程序的实现。\n\n**第 1 部分：平稳分布的推导**\n\n一个通用的一维 Itô 扩散由以下随机微分方程 (SDE) 描述：\n$$\ndr_t = a(r_t) \\, dt + b(r_t) \\, dW_t\n$$\n其中 $a(r)$ 是漂移函数，$b(r)$ 是扩散函数。不依赖于时间或称平稳的概率密度函数 (PDF)，记为 $p(r)$，必须满足平稳 Kolmogorov 正向 (Fokker-Planck) 方程。此方程表达了概率守恒。将完整的 Fokker-Planck 方程对时间积分，并假定处于平稳状态 ($\\partial p / \\partial t = 0$) 且在状态空间边界处的概率流为零，可得到以下常微分方程：\n$$\na(r) p(r) - \\frac{1}{2} \\frac{d}{dr} \\left[ b(r)^2 p(r) \\right] = 0\n$$\n我们将对每个模型求解此方程以找到其平稳 PDF。\n\n**模型 A: Vasicek**\n该 SDE 为 $dr_t = \\kappa (\\theta - r_t) \\, dt + \\sigma \\, dW_t$。\n漂移项和扩散项为：\n$$\na(r) = \\kappa (\\theta - r)\n$$\n$$\nb(r)^2 = \\sigma^2\n$$\nVasicek 模型的状态空间为 $(-\\infty, \\infty)$。将这些代入平稳方程得：\n$$\n\\kappa(\\theta - r) p(r) - \\frac{1}{2} \\frac{d}{dr} \\left[ \\sigma^2 p(r) \\right] = 0\n$$\n$$\n\\kappa(\\theta - r) p(r) = \\frac{\\sigma^2}{2} \\frac{dp(r)}{dr}\n$$\n这是一个一阶线性可分微分方程。我们可以分离变量：\n$$\n\\frac{dp}{p} = \\frac{2\\kappa}{\\sigma^2} (\\theta - r) \\, dr\n$$\n对两边积分：\n$$\n\\int \\frac{dp}{p} = \\int \\frac{2\\kappa}{\\sigma^2} (\\theta - r) \\, dr \\implies \\ln p(r) = \\frac{2\\kappa}{\\sigma^2} \\left(\\theta r - \\frac{r^2}{2}\\right) + C_0\n$$\n其中 $C_0$ 是积分常数。因此，PDF 为：\n$$\np(r) = C \\exp\\left( \\frac{2\\kappa\\theta r - \\kappa r^2}{\\sigma^2} \\right)\n$$\n为了识别这个分布，我们对指数部分进行配方：\n$$\n-\\frac{\\kappa}{\\sigma^2} (r^2 - 2\\theta r) = -\\frac{\\kappa}{\\sigma^2} \\left[ (r - \\theta)^2 - \\theta^2 \\right] = -\\frac{\\kappa(r - \\theta)^2}{\\sigma^2} + \\frac{\\kappa\\theta^2}{\\sigma^2}\n$$\n$\\exp(\\kappa\\theta^2/\\sigma^2)$ 项是一个常数，可以被吸收到归一化常数 $C$ 中。函数形式是高斯分布：\n$$\np(r) = C' \\exp\\left( -\\frac{(r - \\theta)^2}{\\sigma^2 / \\kappa} \\right)\n$$\n通过与正态 PDF 的标准形式 $f(x) = (\\sqrt{2\\pi \\text{Var}})^{-1} \\exp(-(x-\\mu)^2/(2\\text{Var}))$ 比较，我们确定均值 $\\mu = \\theta$ 和方差 $\\text{Var} = \\sigma^2 / (2\\kappa)$。\nVasicek 模型的完全归一化平稳 PDF 为：\n$$\np(r) = \\sqrt{\\frac{\\kappa}{\\pi\\sigma^2}} \\exp\\left( -\\frac{\\kappa(r-\\theta)^2}{\\sigma^2} \\right)\n$$\n这是正态分布 $\\mathcal{N}(\\theta, \\sigma^2/(2\\kappa))$ 的 PDF。相应的累积分布函数 (CDF) 为：\n$$\nF(r) = \\Phi\\left( \\frac{r - \\theta}{\\sqrt{\\sigma^2/(2\\kappa)}} \\right)\n$$\n其中 $\\Phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^z e^{-x^2/2} dx$ 是标准正态 CDF。\n\n**模型 B: Cox-Ingersoll-Ross (CIR)**\n该 SDE 为 $dr_t = \\kappa (\\theta - r_t) \\, dt + \\sigma \\sqrt{r_t} \\, dW_t$, 对 $r_t \\ge 0$ 成立。\n漂移项和扩散项的平方为：\n$$\na(r) = \\kappa (\\theta - r)\n$$\n$$\nb(r)^2 = \\sigma^2 r\n$$\n状态空间为 $[0, \\infty)$。Feller 条件 $2\\kappa\\theta > \\sigma^2$ 确保原点 $r=0$ 是一个不可达边界。问题参数满足该条件。平稳 Fokker-Planck 方程为：\n$$\n\\kappa(\\theta - r) p(r) - \\frac{1}{2} \\frac{d}{dr} \\left[ \\sigma^2 r p(r) \\right] = 0\n$$\n展开导数并整理得：\n$$\n\\frac{\\sigma^2}{2} r \\frac{dp(r)}{dr} = \\left[ \\kappa(\\theta - r) - \\frac{\\sigma^2}{2} \\right] p(r)\n$$\n分离变量：\n$$\n\\frac{dp}{p} = \\left[ \\frac{\\kappa\\theta - \\sigma^2/2}{(\\sigma^2/2)r} - \\frac{\\kappa r}{(\\sigma^2/2)r} \\right] \\, dr = \\left( \\frac{2\\kappa\\theta/\\sigma^2 - 1}{r} - \\frac{2\\kappa}{\\sigma^2} \\right) \\, dr\n$$\n对两边积分：\n$$\n\\ln p(r) = \\left(\\frac{2\\kappa\\theta}{\\sigma^2} - 1\\right) \\ln r - \\frac{2\\kappa}{\\sigma^2} r + C_0\n$$\n因此，PDF 为：\n$$\np(r) = C \\cdot r^{\\frac{2\\kappa\\theta}{\\sigma^2} - 1} \\exp\\left( -\\frac{2\\kappa}{\\sigma^2} r \\right)\n$$\n这是伽马分布的函数形式。具有形状参数 $\\alpha$ 和速率参数 $\\beta$ 的标准伽马分布 PDF 为 $f(x; \\alpha, \\beta) = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} x^{\\alpha-1} e^{-\\beta x}$。通过比较，我们确定参数：\n$$\n\\text{形状参数 (Shape): } \\alpha = \\frac{2\\kappa\\theta}{\\sigma^2}\n$$\n$$\n\\text{速率参数 (Rate): } \\beta = \\frac{2\\kappa}{\\sigma^2}\n$$\nCIR 模型的归一化平稳 PDF 为：\n$$\np(r) = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} r^{\\alpha - 1} e^{-\\beta r}\n$$\n这是伽马分布 $\\text{Gamma}(\\alpha, \\beta)$ 的 PDF。相应的 CDF 由正则化下不完全伽马函数给出：\n$$\nF(r) = \\frac{\\gamma(\\alpha, \\beta r)}{\\Gamma(\\alpha)}\n$$\n其中 $\\gamma(s, x) = \\int_0^x t^{s-1} e^{-t} dt$ 是下不完全伽马函数。\n\n**第 2 部分：模拟方法**\n\n使用蒙特卡罗模拟来测量向平稳分布的收敛。对于每个模型，从给定的初始条件 $r_0$ 开始，模拟一个包含 $n = 10000$ 条独立路径的集合。我们不使用像 Euler-Maruyama 这样的近似数值方案，而是使用精确的单步转移分布。\n\n在每个监测时间 $t_k = k \\Delta t$，将模拟利率 $\\{r_{t_k}^{(i)}\\}_{i=1}^n$ 的经验分布与第 1 部分中推导的理论平稳分布进行比较。分布之间的距离由 Kolmogorov-Smirnov (KS) 统计量 $D_k$ 来量化：\n$$\nD_k = \\sup_{r} | F(r) - \\hat{F}_{n,k}(r) |\n$$\n其中 $F(r)$ 是理论平稳 CDF，$\\hat{F}_{n,k}(r)$ 是时间 $t_k$ 样本的经验 CDF。对于给定的阈值 $\\varepsilon=0.02$，估计的混合时间是第一个满足 $D_k \\le \\varepsilon$ 的时间 $t_k$。\n\n**Vasicek 模型的精确转移：**\nVasicek SDE 是一个线性 SDE（一个 Ornstein-Uhlenbeck 过程）。其精确解表明，以 $r_t$ 为条件的 $r_{t+\\Delta t}$ 的分布是正态分布：\n$$\nr_{t+\\Delta t} | r_t \\sim \\mathcal{N}\\left( \\theta + (r_t - \\theta)e^{-\\kappa \\Delta t}, \\frac{\\sigma^2}{2\\kappa}(1 - e^{-2\\kappa \\Delta t}) \\right)\n$$\n为了模拟一步，我们从此正态分布中抽样。\n\n**Cox-Ingersoll-Ross 模型的精确转移：**\n以 $r_t$ 为条件的 $r_{t+\\Delta t}$ 的分布遵循一个经过缩放的非中心卡方分布。具体来说，$2c \\cdot r_{t+\\Delta t}$ 遵循一个非中心卡方分布 $\\chi'^2(d, \\lambda)$，其中：\n- 缩放因子：$c = \\frac{2\\kappa}{\\sigma^2(1 - e^{-\\kappa \\Delta t})}$\n- 自由度：$d = \\frac{4\\kappa\\theta}{\\sigma^2}$\n- 非中心化参数：$\\lambda = 2c \\cdot r_t e^{-\\kappa \\Delta t}$\n因此，$r_{t+\\Delta t} = \\frac{1}{2c} Y$，其中 $Y \\sim \\chi'^2(d, \\lambda)$。在每个时间步为每条路径生成一个此分布的样本。\n\n**第 3 部分：实现策略**\n\n该算法在 Python 中使用 `numpy` 库进行高效的矢量化计算，并使用 `scipy` 库进行统计函数计算。\n1.  使用固定的种子初始化随机数生成器以保证可复现性。\n2.  对于每个测试用例，定义模型参数 $(\\kappa, \\theta, \\sigma, r_0)$ 和相应的平稳 CDF，$F(r)$。\n3.  初始化一个包含 $n=10000$ 条路径的数组，其值为 $r_0$。\n4.  在时间步 $t_k = k \\Delta t$ 上迭代，直到 $T_{\\max} = 10.0$。\n5.  在每一步中，通过使用矢量化操作从精确转移分布中抽样，同时更新所有路径。对于 Vasicek，这涉及 `numpy.random.Generator.standard_normal`。对于 CIR，我们使用 `scipy.stats.ncx2.rvs`。\n6.  在每一步结束时，计算 KS 统计量 $D_k$。这包括对模拟的利率进行排序，在这些点上评估平稳 CDF，并找到与经验 CDF 的最大偏差。\n7.  将 $D_k$ 与阈值 $\\varepsilon = 0.02$ 进行比较。如果 $D_k \\le \\varepsilon$，则将混合时间记录为 $t_k$，并终止该案例的模拟。\n8.  如果在 $T_{\\max}$ 之前未满足条件，则将混合时间报告为 $T_{\\max}$。\n9.  收集最终结果，并以指定格式打印。对所有路径使用矢量化操作对于计算效率至关重要。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm, gamma, ncx2\n\ndef solve():\n    \"\"\"\n    Computes the mixing time for Vasicek and CIR short-rate models\n    based on convergence of the empirical distribution to the stationary one.\n    \"\"\"\n    # Define simulation and problem constants\n    N_PATHS = 10000\n    DT = 0.05\n    T_MAX = 10.0\n    EPSILON = 0.02\n    SEED = 12345\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'model': 'vasicek', 'kappa': 1.0, 'theta': 0.05, 'sigma': 0.02, 'r0': 0.00},\n        {'model': 'vasicek', 'kappa': 1.0, 'theta': 0.05, 'sigma': 0.02, 'r0': 0.20},\n        {'model': 'vasicek', 'kappa': 1.0, 'theta': 0.05, 'sigma': 0.02, 'r0': -0.05},\n        {'model': 'cir', 'kappa': 1.2, 'theta': 0.04, 'sigma': 0.25, 'r0': 0.001},\n        {'model': 'cir', 'kappa': 1.2, 'theta': 0.04, 'sigma': 0.25, 'r0': 0.04},\n        {'model': 'cir', 'kappa': 1.2, 'theta': 0.04, 'sigma': 0.25, 'r0': 0.20},\n    ]\n\n    rng = np.random.default_rng(SEED)\n    results = []\n\n    for case in test_cases:\n        kappa = case['kappa']\n        theta = case['theta']\n        sigma = case['sigma']\n        r0 = case['r0']\n\n        # Initialize paths\n        r_paths = np.full(N_PATHS, r0, dtype=np.float64)\n\n        if case['model'] == 'vasicek':\n            # Stationary distribution: Normal(mean, var)\n            stat_mean = theta\n            stat_var = sigma**2 / (2 * kappa)\n            stat_std = np.sqrt(stat_var)\n            stat_cdf = lambda x: norm.cdf(x, loc=stat_mean, scale=stat_std)\n\n            # Precompute transition parameters for exact sampling\n            trans_exp = np.exp(-kappa * DT)\n            trans_mean_term = theta * (1 - trans_exp)\n            trans_std = np.sqrt(sigma**2 / (2 * kappa) * (1 - trans_exp**2))\n\n        elif case['model'] == 'cir':\n            # Stationary distribution: Gamma(shape, scale)\n            # Feller condition 2*kappa*theta > sigma**2 must hold, and does for the test case.\n            alpha_stat = 2 * kappa * theta / sigma**2\n            scale_stat = sigma**2 / (2 * kappa) # scale = 1/rate\n            stat_cdf = lambda x: gamma.cdf(x, a=alpha_stat, scale=scale_stat)\n\n            # Precompute transition parameters for exact sampling (non-central chi-square)\n            c_trans = 2 * kappa / (sigma**2 * (1 - np.exp(-kappa * DT)))\n            df_trans = 4 * kappa * theta / sigma**2\n            exp_term_trans = np.exp(-kappa * DT)\n\n        mixing_time = T_MAX\n        time_grid = np.arange(DT, T_MAX + DT / 2, DT)\n\n        for t in time_grid:\n            # Simulate one step for all paths using the exact transition law\n            if case['model'] == 'vasicek':\n                mean_t = r_paths * trans_exp + trans_mean_term\n                z = rng.standard_normal(N_PATHS)\n                r_paths = mean_t + trans_std * z\n            else: # CIR\n                # Ensure non-negativity for the non-centrality parameter calculation\n                r_non_neg = np.maximum(r_paths, 0)\n                nc_param = 2 * c_trans * r_non_neg * exp_term_trans\n                chi2_samples = ncx2.rvs(df=df_trans, nc=nc_param, size=N_PATHS, random_state=rng)\n                r_paths = chi2_samples / (2 * c_trans)\n            \n            # Compute Kolmogorov-Smirnov statistic\n            r_sorted = np.sort(r_paths)\n            cdf_values = stat_cdf(r_sorted)\n            i_vals = np.arange(1, N_PATHS + 1) / N_PATHS\n            \n            d_plus = np.max(i_vals - cdf_values)\n            d_minus = np.max(cdf_values - (i_vals - 1/N_PATHS))\n            d_k = max(d_plus, d_minus)\n\n            if d_k = EPSILON:\n                mixing_time = t\n                break\n        \n        results.append(round(mixing_time, 3))\n\n    # Final print statement in the exact required format.\n    # The output format for floats is handled by rounding, map to str will preserve it.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2429591"}, {"introduction": "最后的实践将视角从模型实现提升到批判性评估，这对任何从业者来说都是一项至关重要的技能。您将面对现代金融中的一个普遍挑战：当经典模型遭遇新的市场环境时所暴露出的局限性，具体而言，就是将 CIR 模型校准至负利率数据 [@problem_id:2370035]。这个概念性练习将促使您分析 CIR 过程的基本属性并预测校准结果，从而加深您对模型风险以及理论模型与市场数据之间关键对话的理解。", "problem": "考虑在风险中性测度下，将一个单因子 Cox–Ingersoll–Ross (CIR) 模型校准至一组包含负观测值的零息收益率横截面数据。在风险中性测度 $\\mathbb{Q}$ 下，短期利率 $r_t$ 服从\n$$\ndr_t \\;=\\; \\kappa\\,(\\theta - r_t)\\,dt \\;+\\; \\sigma\\,\\sqrt{r_t}\\,dW_t,\n$$\n其参数 $\\kappa0$、$\\sigma0$，且 $\\theta$ 不受优化器先验约束。到期日为 $T$ 的零息债券价格由基本无套利定价关系式给出\n$$\nP(0,T) \\;=\\; \\mathbb{E}^{\\mathbb{Q}}\\!\\left[\\exp\\!\\left(-\\int_{0}^{T} r_s\\,ds\\right)\\right],\n$$\n且连续复利模型收益率为 $y^{\\text{model}}(0,T) \\equiv -\\frac{1}{T}\\ln P(0,T)$。您观测到一组市场收益率 $\\{y^{\\text{mkt}}(0,T_i)\\}_{i=1}^n$，其中对于某些到期日 $T_j$ 有 $y^{\\text{mkt}}(0,T_j)  0$，并且您通过最小化一个加权最小二乘目标函数来估计参数\n$$\n\\min_{\\kappa,\\theta,\\sigma,r_0}\\;\\; \\sum_{i=1}^n w_i\\,\\big(y^{\\text{model}}(0,T_i) - y^{\\text{mkt}}(0,T_i)\\big)^2,\n$$\n其中给定权重为正 $w_i0$。在校准过程中，您不施加 Feller 条件 $2\\kappa\\theta \\ge \\sigma^2$。\n\n哪项陈述最能描述此校准的预期行为以及 Feller 条件在此设定中的作用？\n\nA. 通过选择 $\\theta0$，当 $2\\kappa\\theta\\sigma^2$ 时，校准可以使 $r_t$ 以正概率为负，从而能够精确匹配负的市场收益率并将目标函数驱动至 $0$。\n\nB. 如果优化器不受 Feller 条件的约束，它可能会选择 $2\\kappa\\theta\\sigma^2$ 的参数以获得收益率曲线形状的灵活性，但模型仍然无法产生负的风险中性收益率；因此，对于负收益率的到期日，其残差系统性地为正，并且最小二乘目标函数无法达到 $0$。\n\nC. 强制施加 Feller 条件保证了匹配负市场收益率的能力，因为它确保了严格为正的债券价格，这反过来又允许了负的对数收益率。\n\nD. 由于仿射定价，最小二乘目标函数在 CIR 参数上是凸的，因此即使存在负的市场收益率，优化器也能获得一个唯一的误差为零的全局最小值，除非施加 Feller 条件，在这种情况下会出现非凸性且拟合效果变差。\n\nE. 违反 Feller 条件会使转移密度无定义且债券价格变得不适定，因此只要市场曲线上包含负收益率，校准就必然会在数值上失败。", "solution": "在尝试任何解答之前，必须首先对问题陈述进行严格的验证。\n\n### 步骤 1：提取已知信息\n问题提供了以下信息：\n- 在风险中性测度 $\\mathbb{Q}$ 下，短期利率过程 $r_t$ 由 Cox–Ingersoll–Ross (CIR) 随机微分方程建模：\n$$dr_t = \\kappa(\\theta - r_t)\\,dt + \\sigma\\sqrt{r_t}\\,dW_t$$\n- 初始指定的参数约束：$\\kappa  0$，$\\sigma  0$。参数 $\\theta$ 事先不受约束。\n- 零息债券的价格由风险中性期望给出：\n$$P(0,T) = \\mathbb{E}^{\\mathbb{Q}}\\!\\left[\\exp\\!\\left(-\\int_{0}^{T} r_s\\,ds\\right)\\right]$$\n- 连续复利模型收益率定义为：\n$$y^{\\text{model}}(0,T) \\equiv -\\frac{1}{T}\\ln P(0,T)$$\n- 市场数据包含一组观测收益率 $\\{y^{\\text{mkt}}(0,T_i)\\}_{i=1}^n$，其中至少有一个到期日 $T_j$ 的收益率为负：$y^{\\text{mkt}}(0,T_j)  0$。\n- 校准过程是最小化加权平方误差和：\n$$\\min_{\\kappa,\\theta,\\sigma,r_0}\\;\\; \\sum_{i=1}^n w_i\\,\\big(y^{\\text{model}}(0,T_i) - y^{\\text{mkt}}(0,T_i)\\big)^2$$\n- 权重为正：$w_i  0$。\n- 在优化过程中明确不施加 Feller 条件 $2\\kappa\\theta \\ge \\sigma^2$。\n\n### 步骤 2：使用提取的已知信息进行验证\n对问题陈述的有效性进行分析。\n1.  **科学基础**：CIR 模型是金融数学中用于利率动态的经典模型。债券定价公式是资产定价的基本定理。将模型校准到市场数据，包括负利率带来的挑战，是量化金融中的一个标准且重要的问题。Feller 条件及其含义是公认的理论结果。该问题牢固地植根于已建立的金融理论。\n2.  **适定性**：该问题要求描述一个已定义的优化程序在特定条件下的行为。这是一个关于 CIR 模型的性质及其在面对某些市场数据时的局限性的概念性问题。问题的结构使其能够根据模型的数学性质得到一个可辨别的答案。\n3.  **客观性**：语言是技术性的、精确的，并且没有主观或模糊的术语。\n4.  **一致性与完整性**：问题提供了所有必要的定义（随机微分方程、定价、收益率），并指明了数据特征（负收益率）和校准设置（目标函数、无约束的 Feller 条件）。内部没有矛盾。\n\n### 步骤 3：结论与行动\n问题陈述有效。这是一个关于计算金融中 CIR 模型的性质和实际限制的、表述良好的问题。可以推导出解答。\n\n### 推导与分析\n\n问题的核心在于由 CIR 模型定义的短期利率过程 $r_t$ 的基本性质。随机微分方程是 $dr_t = \\kappa(\\theta - r_t)\\,dt + \\sigma\\sqrt{r_t}\\,dW_t$。该过程的一个关键特征（源于平方根项 $\\sqrt{r_t}$）是其在边界 $r_t = 0$ 处的行为。\n\n对于任何初始状态 $r_0 \\ge 0$，CIR 过程 $r_t$ 对所有 $t  0$ 几乎必然地保持非负。即，对所有 $t \\ge 0$ 都有 $r_t \\ge 0$。$\\sqrt{r_t}$ 项在实数域内仅对非负的 $r_t$ 有定义，且过程的动态特性阻止其变为负值。Feller 条件 $2\\kappa\\theta \\ge \\sigma^2$ 决定了过程是否能达到零边界。如果 $2\\kappa\\theta \\ge \\sigma^2$，则过程是严格为正的，$r_t  0$ 对所有 $t  0$ 成立（假设 $r_0  0$）。如果 $2\\kappa\\theta  \\sigma^2$，过程可以以正概率达到 $r_t=0$，但它不会越界进入负值区域。\n\n鉴于短期利率 $r_s$ 对于 $s \\in [0, T]$ 总是非负的，其积分也必须是非负的：\n$$ \\int_{0}^{T} r_s\\,ds \\ge 0 $$\n因此，其指数的负值是有界的：\n$$ 0  \\exp\\left(-\\int_{0}^{T} r_s\\,ds\\right) \\le 1 $$\n零息债券的价格作为此量的期望，也必须在此区间内（或其子区间内）：\n$$ P(0,T) = \\mathbb{E}^{\\mathbb{Q}}\\!\\left[\\exp\\!\\left(-\\int_{0}^{T} r_s\\,ds\\right)\\right] \\in (0, 1] $$\n在标准 CIR 框架内，债券价格 $P(0,T)  1$ 是不可能的，因为它将意味着可能存在负利率。\n\n模型收益率由 $y^{\\text{model}}(0,T) = -\\frac{1}{T}\\ln P(0,T)$ 给出。由于 $0  P(0,T) \\le 1$，自然对数 $\\ln P(0,T)$ 必须小于或等于零。因此，模型收益率必须是非负的：\n$$ y^{\\text{model}}(0,T) = -\\frac{1}{T}\\ln P(0,T) \\ge 0 $$\n这是 CIR 模型的一个根本限制：它无法产生负收益率。\n\n校准问题试图最小化模型收益率和市场收益率之间的平方误差和。问题陈述市场数据包含负收益率，即对某些 $j$ 有 $y^{\\text{mkt}}(0,T_j)  0$。对于这些到期日，我们有：\n- 模型收益率：$y^{\\text{model}}(0,T_j) \\ge 0$\n- 市场收益率：$y^{\\text{mkt}}(0,T_j)  0$\n这种到期日的残差（误差）是 $y^{\\text{model}}(0,T_j) - y^{\\text{mkt}}(0,T_j)$，它是一个非负数与一个负数之差。这个差值是严格为正的。因此，平方误差 $w_j(y^{\\text{model}}(0,T_j) - y^{\\text{mkt}}(0,T_j))^2$ 也是严格为正的。由于平方和目标函数中至少有一项是严格为正的，总目标函数值永远不可能为零。优化将找到一个误差非零的最小值。\n\nFeller 条件的作用：问题指出优化器不施加 $2\\kappa\\theta \\ge \\sigma^2$。这意味着优化器可以自由选择使得 $2\\kappa\\theta  \\sigma^2$ 的参数。这种情况使得过程 $r_t$ 有更高的倾向接近于零。允许利率触及零点，可以为收益率曲线的形状，尤其是在短端，提供更多的曲率和灵活性。一个无约束的优化器，为了最小化误差，可能会选择违反 Feller 条件的参数，如果这样做能让模型收益率更接近非常低（在本例中为负）的市场收益率，从而降低整体目标函数值。然而，这种灵活性无法克服根本障碍：模型收益率仍然是非负的。\n\n现在我们评估给定的选项。\n\n**A. 通过选择 $\\theta0$，当 $2\\kappa\\theta\\sigma^2$ 时，校准可以使 $r_t$ 以正概率为负，从而能够精确匹配负的市场收益率并将目标函数驱动至 $0$。**\n此陈述从根本上是错误的。CIR 过程 $r_t$ 被构造成非负的。即使 $\\theta  0$（这使得长期均值为负并产生向下的漂移），该过程仍被限制在 $[0, \\infty)$ 区间内。平方根扩散项确保了这一点。因此，$r_t$ 不能变为负值，模型收益率不能为负，目标函数也不能被驱动至 $0$。**错误**。\n\n**B. 如果优化器不受 Feller 条件的约束，它可能会选择 $2\\kappa\\theta\\sigma^2$ 的参数以获得收益率曲线形状的灵活性，但模型仍然无法产生负的风险中性收益率；因此，对于负收益率的到期日，其残差系统性地为正，并且最小二乘目标函数无法达到 $0$。**\n该陈述与上述推导完全一致。\n1. 优化器可能选择违反 Feller 条件（$2\\kappa\\theta\\sigma^2$）的参数以获得更好的拟合，这是 CIR 校准中的一种已知行为。这提供了更大的灵活性。\n2. 模型根本无法产生负收益率（$y^{\\text{model}} \\ge 0$）。\n3. 当 $y^{\\text{mkt}}  0$ 时，残差 $y^{\\text{model}} - y^{\\text{mkt}}$ 系统性地为正。\n4. 至少存在一个这样的到期日，确保了平方和目标函数在其最小值处严格为正。\n这个陈述是对情况的精确和完整的描述。**正确**。\n\n**C. 强制施加 Feller 条件保证了匹配负市场收益率的能力，因为它确保了严格为正的债券价格，这反过来又允许了负的对数收益率。**\n此陈述内部矛盾且事实错误。确保严格为正的债券价格 $P(0,T)  0$ 是模型的固有属性，无论 Feller 条件如何。负收益率 $y^{\\text{model}}(0,T)  0$ 要求 $\\ln P(0,T)  0$，即 $P(0,T)  1$。无论是否施加 Feller 条件，该模型都确保 $P(0,T) \\le 1$。所提出的推理是不合逻辑的。**错误**。\n\n**D. 由于仿射定价，最小二乘目标函数在 CIR 参数上是凸的，因此即使存在负的市场收益率，优化器也能获得一个唯一的误差为零的全局最小值，除非施加 Feller 条件，在这种情况下会出现非凸性且拟合效果变差。**\n此陈述包含多个谬误。\n1. 目标函数相对于 CIR 参数 $(\\kappa, \\theta, \\sigma)$ 是高度非凸的。尽管收益率在状态变量 $r_0$ 上是仿射的，但该仿射函数的系数是参数的复杂非线性函数，这在校准问题中引入了非凸性。\n2. 我们已经确定，如果存在负的市场收益率，误差不可能为零。\n3. 非凸性是问题固有的，并非由 Feller 条件约束“引入”的。\n此陈述显示了对优化理论和仿射模型的严重误解。**错误**。\n\n**E. 违反 Feller 条件会使转移密度无定义且债券价格变得不适定，因此只要市场曲线上包含负收益率，校准就必然会在数值上失败。**\n此陈述不正确。即使在违反 Feller 条件的情况下，CIR 过程的数学理论也是良定义的。转移密度是已知的（它与非中心卡方分布有关），并且债券定价公式仍然有效且适定。校准不会因为数学上的崩溃而“在数值上失败”；它会成功地找到一个最佳拟合，尽管由于模型结构上无法产生负收益率，这是一个不完美的拟合。问题在于模型错配，而非不适定性。**错误**。", "answer": "$$\\boxed{B}$$", "id": "2370035"}]}