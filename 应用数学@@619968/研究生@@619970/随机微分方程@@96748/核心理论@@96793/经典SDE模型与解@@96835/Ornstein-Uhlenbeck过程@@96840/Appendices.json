{"hands_on_practices": [{"introduction": "在着手分析任何随机过程时，第一步都是理解其基本统计特性。对于 Ornstein-Uhlenbeck (OU) 过程，这意味着要计算其随时间演化的均值和方差。本练习将引导你推导 OU 过程的二阶矩，这是一个核心计算，它不仅能加深你对过程动态的理解，还能让你熟练运用求解线性随机微分方程和应用伊藤等距定理等基本工具。[@problem_id:859495]", "problem": "奥恩斯坦-乌伦贝克 (Ornstein-Uhlenbeck, OU) 过程是一个随机过程，它描述了在摩擦力作用下大质量布朗粒子的速度。其特点是具有向一个长期均值回归的趋势。过程 $X_t$ 由以下随机微分方程 (SDE) 描述：\n$$ dX_t = -\\theta (X_t - \\mu) dt + \\sigma dW_t $$\n其中 $t \\geq 0$ 是时间，$X_t$ 是过程的状态，$W_t$ 是一个标准维纳过程。参数均为正常数：$\\theta$ 是均值回归速率，$\\mu$ 是长期均值，$\\sigma$ 是波动率。\n\n假设该过程从一个已知的确定性初始值 $X_0 = x_0$ 开始。\n\n推导该过程随时间变化的二阶矩 $\\mathbb{E}[X_t^2]$，使其成为时间 $t$ 和参数 $x_0$、$\\mu$、$\\theta$ 及 $\\sigma$ 的函数。", "solution": "1. OU-SDE 为\n$$dX_t=-\\theta(X_t-\\mu)\\,dt+\\sigma\\,dW_t.$$\n乘以积分因子 $e^{\\theta t}$ 并从 0 到 $t$ 积分，得到\n$$X_t=e^{-\\theta t}x_0+\\mu\\bigl(1-e^{-\\theta t}\\bigr)+\\sigma\\int_0^t e^{-\\theta(t-s)}\\,dW_s.$$\n2. 根据线性性质，均值为：\n$$\\mathbb{E}[X_t]=e^{-\\theta t}x_0+\\mu\\bigl(1-e^{-\\theta t}\\bigr).$$\n3. 方差使用伊东等距定理 (Itô isometry)：\n$$\\mathrm{Var}[X_t]\n=\\sigma^2\\int_0^t e^{-2\\theta(t-s)}\\,ds\n=\\frac{\\sigma^2}{2\\theta}\\bigl(1-e^{-2\\theta t}\\bigr).$$\n4. 因此，二阶矩为\n$$\\mathbb{E}[X_t^2]\n=\\mathbb{E}[X_t]^2+\\mathrm{Var}[X_t]\n=\\bigl(e^{-\\theta t}x_0+\\mu(1-e^{-\\theta t})\\bigr)^2\n+\\frac{\\sigma^2}{2\\theta}\\bigl(1-e^{-2\\theta t}\\bigr).$$", "answer": "$$\\boxed{\\bigl(e^{-\\theta t}x_0+\\mu(1-e^{-\\theta t})\\bigr)^2+\\frac{\\sigma^2}{2\\theta}(1-e^{-2\\theta t})}$$", "id": "859495"}, {"introduction": "Ornstein-Uhlenbeck 过程的核心特征是其“均值回归”特性，这个特性由参数 $\\theta$ 控制。但是，这个参数在物理上究竟意味着什么？本练习通过引入“持续时间”或特征时间的概念，将抽象的参数 $\\theta$ 与过程的“记忆”直观地联系起来。通过计算自协方差函数并分析其衰减速率，你将定量地理解均值回归速度如何决定一个系统“忘记”其过去状态的快慢。[@problem_id:1343718]", "problem": "一个研究实验室正在研究一个被限制在两种不同类型光阱（阱A和阱B）中的单个纳米粒子的热涨落。该纳米粒子在每个阱中的一维位置，分别用 $X_t^{(A)}$ 和 $X_t^{(B)}$ 表示，围绕平衡位置 $\\mu$ 涨落。这些涨落可以通过两个独立的奥恩斯坦-乌伦贝克 (OU) 过程来建模。\n\n每个阱中位置的动力学由以下随机微分方程描述：\n$$ dX_t^{(A)} = \\theta_A (\\mu - X_t^{(A)}) dt + \\sigma dW_t^{(A)} $$\n$$ dX_t^{(B)} = \\theta_B (\\mu - X_t^{(B)}) dt + \\sigma dW_t^{(B)} $$\n\n此处，$\\theta_A$ 和 $\\theta_B$ 是阱的正“刚度”参数，代表均值回归的速率。平衡位置 $\\mu$ 和热噪声强度（波动率）$\\sigma$ 对于两个阱是相同的。$W_t^{(A)}$ 和 $W_t^{(B)}$ 是独立的标准维纳过程。\n\n假设两个过程都已运行了足够长的时间以达到其稳态。为了表征涨落的“记忆”持续多长时间，我们为每个过程定义一个特征时间 $\\tau$。这个“持续时间” $\\tau$ 是指时间延迟，在该延迟下，粒子在时间 $t$ 的位置与其在时间 $t+\\tau$ 的位置之间的协方差衰减到其在 $\\tau=0$ 时值的 $1/e$，其中 $e$ 是欧拉数。设 $\\tau_A$ 和 $\\tau_B$ 分别为阱A和阱B的持续时间。\n\n阱B被设计成比阱A具有显著更强的约束性，因此其刚度参数是阱A的25倍，即 $\\theta_B = 25 \\, \\theta_A$。\n\n计算持续时间之比 $\\frac{\\tau_A}{\\tau_B}$。", "solution": "对于奥恩斯坦-乌伦贝克过程 $dX_{t}=\\theta(\\mu-X_{t})dt+\\sigma dW_{t}$，其稳态解可以写为\n$$\nX_{t}-\\mu=\\sigma\\int_{-\\infty}^{t}\\exp\\!\\big(-\\theta(t-u)\\big)\\,dW_{u}.\n$$\n延迟为 $s\\geq 0$ 的稳态自协方差是\n$$\n\\operatorname{Cov}(X_{t},X_{t+s})=\\mathbb{E}\\big[(X_{t}-\\mu)(X_{t+s}-\\mu)\\big]\n=\\sigma^{2}\\int_{-\\infty}^{t}\\exp\\!\\big(-\\theta(t-u)\\big)\\exp\\!\\big(-\\theta(t+s-u)\\big)\\,du.\n$$\n分解因子并进行变量替换 $v=t-u$，得到\n$$\n\\operatorname{Cov}(X_{t},X_{t+s})=\\sigma^{2}\\exp(-\\theta s)\\int_{-\\infty}^{t}\\exp\\!\\big(-2\\theta(t-u)\\big)\\,du\n=\\sigma^{2}\\exp(-\\theta s)\\int_{0}^{\\infty}\\exp(-2\\theta v)\\,dv\n=\\frac{\\sigma^{2}}{2\\theta}\\exp(-\\theta s).\n$$\n因此，归一化的自协方差为\n$$\n\\frac{\\operatorname{Cov}(X_{t},X_{t+s})}{\\operatorname{Cov}(X_{t},X_{t})}=\\exp(-\\theta s).\n$$\n根据定义，持续时间 $\\tau$ 满足\n$$\n\\frac{\\operatorname{Cov}(X_{t},X_{t+\\tau})}{\\operatorname{Cov}(X_{t},X_{t})}=\\exp(-1),\n$$\n所以 $\\exp(-\\theta\\tau)=\\exp(-1)$，这意味着\n$$\n\\theta\\,\\tau=1\\quad\\Rightarrow\\quad \\tau=\\frac{1}{\\theta}.\n$$\n因此，对于这两个阱，\n$$\n\\tau_{A}=\\frac{1}{\\theta_{A}},\\qquad \\tau_{B}=\\frac{1}{\\theta_{B}}.\n$$\n已知 $\\theta_{B}=25\\,\\theta_{A}$，我们有\n$$\n\\frac{\\tau_{A}}{\\tau_{B}}=\\frac{\\theta_{B}}{\\theta_{A}}=25.\n$$", "answer": "$$\\boxed{25}$$", "id": "1343718"}, {"introduction": "理论模型只有在能够应用于真实世界数据时才显示出其真正的力量。在许多应用中，我们拥有一系列时间序列数据，并假设它可以用 Ornstein-Uhlenbeck 过程来建模，但模型的参数 $(\\theta, \\mu, \\sigma)$ 是未知的。本练习将带你进入统计推断的核心，通过推导这些参数的最大似然估计量 (MLE)，搭建起从离散观测数据到连续时间模型的桥梁。掌握这项技能对于在金融、物理学和生物学等领域应用 OU 模型进行数据分析至关重要。[@problem_id:1343701]", "problem": "一个随机过程 $X_t$ 被用来为一个表现出均值回归行为的物理量建模。该过程的演化由 Ornstein-Uhlenbeck 随机微分方程描述：\n$$dX_t = \\theta (\\mu - X_t) dt + \\sigma dW_t$$\n其中 $\\theta > 0$ 是均值回归速率，$\\mu$ 是长期均值，$\\sigma > 0$ 是波动率，而 $W_t$ 是一个标准 Wiener 过程。\n\n该过程在 $n+1$ 个离散的、等间隔的时间点 $t_i = i\\Delta t$（$i = 0, 1, \\dots, n$）上被观测。这得到一个观测序列 $\\{x_0, x_1, \\dots, x_n\\}$。已知对于 $s  t$，在给定 $X_s=x_s$ 的条件下，$X_t$ 的条件分布是一个正态分布，其均值和方差由下式给出：\n$$\n\\begin{align*}\nE[X_t | X_s=x_s] = x_s e^{-\\theta(t-s)} + \\mu(1 - e^{-\\theta(t-s)}) \\\\\n\\text{Var}(X_t | X_s=x_s) = \\frac{\\sigma^2}{2\\theta}(1 - e^{-2\\theta(t-s)})\n\\end{align*}\n$$\n你的任务是为参数 $\\theta$、$\\mu$ 和 $\\sigma$ 推导估计量，我们将其记为 $\\hat{\\theta}$、$\\hat{\\mu}$ 和 $\\hat{\\sigma}$。这些估计量应该是使得在给定初始状态 $x_0$ 的条件下，观测到序列 $x_1, \\dots, x_n$ 的联合概率密度函数最大化的参数值。\n\n为了你最终答案的记法便利，你可以使用数据 $\\{x_i\\}_{i=0}^n$ 的以下汇总统计量：\n$$S_0 = \\sum_{i=1}^n x_{i-1}, \\quad S_1 = \\sum_{i=1}^n x_i, \\quad S_{00} = \\sum_{i=1}^n x_{i-1}^2, \\quad S_{11} = \\sum_{i=1}^n x_i^2, \\quad S_{01} = \\sum_{i=1}^n x_i x_{i-1}$$\n将估计量 $\\hat{\\theta}$、$\\hat{\\mu}$ 和 $\\hat{\\sigma}$ 表示为 $n$、$\\Delta t$ 和这些汇总统计量的解析表达式。最终答案应以一组关于 $(\\hat{\\theta}, \\hat{\\mu}, \\hat{\\sigma})$ 的三个表达式的形式呈现。", "solution": "我们从长度为 $\\Delta t$ 的单步 Ornstein-Uhlenbeck 转移开始。对于 $i=1,\\dots,n$，在给定 $X_{i-1}=x_{i-1}$ 的条件下，$X_{i}$ 的条件分布是高斯分布，其\n$$\nE[X_{i}\\mid X_{i-1}=x_{i-1}] \\;=\\; \\mu + (x_{i-1}-\\mu)\\exp(-\\theta \\Delta t)\n\\;=\\; c + \\phi\\, x_{i-1},\n$$\n且\n$$\n\\operatorname{Var}(X_{i}\\mid X_{i-1}) \\;=\\; \\frac{\\sigma^{2}}{2\\theta}\\bigl(1-\\exp(-2\\theta \\Delta t)\\bigr) \\;=\\; v,\n$$\n这里我们设\n$$\n\\phi \\;=\\; \\exp(-\\theta \\Delta t), \\qquad c \\;=\\; \\mu(1-\\phi), \\qquad v \\;=\\; \\frac{\\sigma^{2}}{2\\theta}(1-\\phi^{2}).\n$$\n因此，给定 $x_0$ 时 $\\{x_{i}\\}_{i=1}^{n}$ 的似然是 $n$ 个高斯密度的乘积，这些高斯密度具有共同方差 $v$ 和均值 $c+\\phi x_{i-1}$。对数似然（省略一个加性常数）为\n$$\n\\ell(c,\\phi,v) \\;=\\; -\\frac{n}{2}\\ln v \\;-\\; \\frac{1}{2v}\\sum_{i=1}^{n}\\bigl(x_{i} - c - \\phi x_{i-1}\\bigr)^{2}.\n$$\n对于固定的 $(c,\\phi)$，对 $v$ 进行最大化得到高斯最大似然估计（MLE）\n$$\n\\hat{v} \\;=\\; \\frac{1}{n}\\sum_{i=1}^{n}\\bigl(x_{i} - c - \\phi x_{i-1}\\bigr)^{2}.\n$$\n将此结果代回表明，对 $(c,\\phi)$ 最大化似然等价于最小化残差平方和\n$$\n\\operatorname{RSS}(c,\\phi) \\;=\\; \\sum_{i=1}^{n}\\bigl(x_{i} - c - \\phi x_{i-1}\\bigr)^{2}.\n$$\n这是一个带截距项的 AR(1) 模型的普通最小二乘问题。正规方程为\n$$\nn c + \\phi S_{0} \\;=\\; S_{1}, \\qquad c S_{0} + \\phi S_{00} \\;=\\; S_{01}.\n$$\n求解得到\n$$\n\\hat{\\phi} \\;=\\; \\frac{S_{01} - \\frac{S_{0}S_{1}}{n}}{S_{00} - \\frac{S_{0}^{2}}{n}}, \n\\qquad\n\\hat{c} \\;=\\; \\frac{S_{1} - \\hat{\\phi}\\, S_{0}}{n}.\n$$\n转换回 $(\\theta,\\mu)$ 得到\n$$\n\\hat{\\theta} \\;=\\; -\\frac{1}{\\Delta t}\\,\\ln(\\hat{\\phi}), \n\\qquad\n\\hat{\\mu} \\;=\\; \\frac{\\hat{c}}{1-\\hat{\\phi}} \\;=\\; \\frac{S_{1} - \\hat{\\phi}\\, S_{0}}{n(1-\\hat{\\phi})}.\n$$\n$v$ 的最大似然估计是 $\\hat{v} = \\operatorname{RSS}(\\hat{c},\\hat{\\phi})/n$。由于 $v = \\frac{\\sigma^{2}}{2\\theta}(1-\\phi^{2})$，我们得到\n$$\n\\hat{\\sigma}^{2} \\;=\\; \\frac{2\\hat{\\theta}}{1-\\hat{\\phi}^{2}}\\;\\hat{v} \\;=\\; \\frac{2\\hat{\\theta}}{1-\\hat{\\phi}^{2}}\\;\\frac{1}{n}\\,\\operatorname{RSS}(\\hat{c},\\hat{\\phi}).\n$$\n为了用汇总统计量表示 $\\operatorname{RSS}(\\hat{c},\\hat{\\phi})$，展开并简化可得\n$$\n\\operatorname{RSS}(\\hat{c},\\hat{\\phi}) \\;=\\; S_{11} - \\frac{S_{1}^{2}}{n} - \\frac{\\left(S_{01} - \\frac{S_{0}S_{1}}{n}\\right)^{2}}{S_{00} - \\frac{S_{0}^{2}}{n}}.\n$$\n由此可得\n$$\n\\hat{\\theta} \\;=\\; -\\frac{1}{\\Delta t}\\,\\ln\\!\\left(\\frac{S_{01} - \\frac{S_{0}S_{1}}{n}}{S_{00} - \\frac{S_{0}^{2}}{n}}\\right),\n$$\n$$\n\\hat{\\mu} \\;=\\; \\frac{\\left(S_{00} - \\frac{S_{0}^{2}}{n}\\right)S_{1} - \\left(S_{01} - \\frac{S_{0}S_{1}}{n}\\right)S_{0}}{n\\left[\\left(S_{00} - \\frac{S_{0}^{2}}{n}\\right) - \\left(S_{01} - \\frac{S_{0}S_{1}}{n}\\right)\\right]},\n$$\n$$\n\\hat{\\sigma} \\;=\\; \\sqrt{ \\frac{ - 2 \\ln\\!\\left( \\frac{ S_{01} - \\frac{ S_{0} S_{1} }{ n } }{ S_{00} - \\frac{ S_{0}^{2} }{ n } } \\right ) }{ \\Delta t \\left( 1 - \\left( \\frac{ S_{01} - \\frac{ S_{0} S_{1} }{ n } }{ S_{00} - \\frac{ S_{0}^{2} }{ n } } \\right )^{2} \\right ) } \\cdot \\frac{1}{n} \\left( S_{11} - \\frac{ S_{1}^{2} }{ n } - \\frac{ \\left( S_{01} - \\frac{ S_{0} S_{1} }{ n } \\right )^{2} }{ S_{00} - \\frac{ S_{0}^{2} }{ n } } \\right ) }.\n$$\n这些就是完全用 $n$、$\\Delta t$ 和给定的汇总统计量表示的最大似然估计量。", "answer": "$$\\boxed{\\begin{pmatrix}\n-\\frac{1}{\\Delta t}\\,\\ln\\!\\left(\\frac{S_{01}-\\frac{S_{0}S_{1}}{n}}{S_{00}-\\frac{S_{0}^{2}}{n}}\\right) \n\\frac{\\left(S_{00}-\\frac{S_{0}^{2}}{n}\\right)S_{1}-\\left(S_{01}-\\frac{S_{0}S_{1}}{n}\\right)S_{0}}{n\\left[\\left(S_{00}-\\frac{S_{0}^{2}}{n}\\right)-\\left(S_{01}-\\frac{S_{0}S_{1}}{n}\\right)\\right]} \n\\sqrt{\\frac{-2\\,\\ln\\!\\left(\\frac{S_{01}-\\frac{S_{0}S_{1}}{n}}{S_{00}-\\frac{S_{0}^{2}}{n}}\\right)}{\\Delta t\\left(1-\\left(\\frac{S_{01}-\\frac{S_{0}S_{1}}{n}}{S_{00}-\\frac{S_{0}^{2}}{n}}\\right)^{2}\\right)}\\cdot \\frac{1}{n}\\left(S_{11}-\\frac{S_{1}^{2}}{n}-\\frac{\\left(S_{01}-\\frac{S_{0}S_{1}}{n}\\right)^{2}}{S_{00}-\\frac{S_{0}^{2}}{n}}\\right)}\n\\end{pmatrix}}$$", "id": "1343701"}]}