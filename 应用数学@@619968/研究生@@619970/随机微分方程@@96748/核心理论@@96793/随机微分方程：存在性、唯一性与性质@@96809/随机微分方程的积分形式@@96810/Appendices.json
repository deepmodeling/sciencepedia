{"hands_on_practices": [{"introduction": "随机微分方程（SDE）有两种主要的积分形式：Itô 积分和 Stratonovich 积分。虽然它们都旨在描述随机系统的演化，但其数学构造和相应的微积分法则（例如，链式法则）有所不同，这导致了 SDE 中漂移项的差异。这个练习将引导你推导两者之间的转换关系 [@problem_id:2997347]，这是理解和应用不同随机微积分框架的一项基本技能。", "problem": "考虑一个带滤概率空间 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\ge 0},\\mathbb{P})$，其上定义了一个一维标准布朗运动 $W=(W_t)_{t\\ge 0}$。设 $b:\\mathbb{R}\\to\\mathbb{R}$ 和 $\\sigma:\\mathbb{R}\\to\\mathbb{R}$ 是二阶连续可微且导数有界的函数，并假设 $X=(X_t)_{t\\ge 0}$ 是随机微分方程 (SDE)\n$$\ndX_t \\;=\\; b(X_t)\\,dt \\;+\\; \\sigma(X_t)\\,dW_t,\\quad X_0=x_0\\in\\mathbb{R},\n$$\n的唯一强解，其积分形式为\n$$\nX_t \\;=\\; X_0 \\;+\\; \\int_0^t b(X_s)\\,ds \\;+\\; \\int_0^t \\sigma(X_s)\\,dW_s,\\quad t\\ge 0.\n$$\n定义过程 $H=(H_t)_{t\\ge 0}$ 为 $H_t=\\sigma(X_t)$。使用 Itô 公式和连续半鞅的二次协变差的定义，推导二次协变差的微分 $d\\langle H,W\\rangle_t$ 并用 $X_t$ 表示。然后，从用 Itô 积分和二次协变差表示的 Stratonovich 积分的特征出发，将给定的 Itô SDE 重写为 Stratonovich 形式\n$$\nX_t \\;=\\; X_0 \\;+\\; \\int_0^t b_{\\mathrm{Strat}}(X_s)\\,ds \\;+\\; \\int_0^t \\sigma(X_s)\\,\\circ dW_s,\n$$\n并确定 Stratonovich 漂移函数 $b_{\\mathrm{Strat}}:\\mathbb{R}\\to\\mathbb{R}$ 仅用 $b$ 和 $\\sigma$ 表示的显式解析表达式。将您的最终答案表示为 $b_{\\mathrm{Strat}}(x)$ 的单个简化解析表达式。", "solution": "该问题是适定的，有科学依据，并包含了得到唯一解所需的所有信息。对漂移函数 $b$ 和扩散函数 $\\sigma$ 的假设（二阶连续可微且导数有界）是保证给定随机微分方程（SDE）强解存在且唯一的标准条件。\n\n问题要求进行两个主要推导：首先是二次协变差的微分 $d\\langle H, W\\rangle_t$（其中 $H_t = \\sigma(X_t)$），其次是 Stratonovich 漂移 $b_{\\mathrm{Strat}}(x)$ 的表达式。\n\n首先，我们确定二次协变差的微分 $d\\langle H, W\\rangle_t$。过程 $H_t$ 定义为 $H_t = \\sigma(X_t)$，其中 $X_t$ 是一个 Itô 过程。为了找到 $H_t$ 的 SDE，我们应用 Itô 公式。令 $f(x) = \\sigma(x)$。由于假设 $\\sigma$ 是二阶连续可微的（$C^2$），因此 Itô 公式对 $H_t = f(X_t)$ 适用：\n$$\ndH_t = f'(X_t) dX_t + \\frac{1}{2} f''(X_t) d\\langle X \\rangle_t\n$$\n$X_t$ 的 SDE 由 $dX_t = b(X_t) dt + \\sigma(X_t) dW_t$ 给出。$X_t$ 的二次变差由 $d\\langle X \\rangle_t = (\\sigma(X_t))^2 dt$ 给出。将这些代入 $dH_t$ 的公式中，并使用 $f'(x) = \\sigma'(x)$ 和 $f''(x) = \\sigma''(x)$，我们得到：\n$$\ndH_t = \\sigma'(X_t) \\left( b(X_t) dt + \\sigma(X_t) dW_t \\right) + \\frac{1}{2} \\sigma''(X_t) (\\sigma(X_t))^2 dt\n$$\n我们可以分离漂移（$dt$）项和扩散（$dW_t$）项：\n$$\ndH_t = \\left( b(X_t)\\sigma'(X_t) + \\frac{1}{2} \\sigma''(X_t)\\sigma(X_t)^2 \\right) dt + \\sigma(X_t)\\sigma'(X_t) dW_t\n$$\n两个连续半鞅（例如 $Y_t$ 和 $Z_t$）的二次协变差微分，其 SDE 分别为 $dY_t = \\mu_Y dt + \\sigma_Y dW_t$ 和 $dZ_t = \\mu_Z dt + \\sigma_Z dW_t$，由 $d\\langle Y, Z \\rangle_t = \\sigma_Y \\sigma_Z dt$ 给出。\n在我们的例子中，我们需要 $d\\langle H, W \\rangle_t$。$W_t$ 的 SDE 是 $dW_t = 0 \\cdot dt + 1 \\cdot dW_t$，所以它的扩散系数是 $1$。从上面推导出的 $H_t$ 的 SDE 可知，其扩散系数是 $\\sigma(X_t)\\sigma'(X_t)$。\n因此，二次协变差的微分是：\n$$\nd\\langle H, W \\rangle_t = \\left( \\sigma(X_t)\\sigma'(X_t) \\right) \\cdot (1) \\cdot dt = \\sigma(X_t)\\sigma'(X_t) dt\n$$\n\n其次，我们使用这个结果将 Itô SDE 重写为 Stratonovich 形式。Stratonovich 积分与 Itô 积分之间的关系由下式给出：\n$$\n\\int_0^t \\sigma(X_s) \\circ dW_s = \\int_0^t \\sigma(X_s) dW_s + \\frac{1}{2} \\langle \\sigma(X), W \\rangle_t\n$$\n这里，$\\langle \\sigma(X), W \\rangle_t$ 正是第一部分中的二次协变差过程 $\\langle H, W \\rangle_t$。第一部分结果的积分形式是 $\\langle H, W \\rangle_t = \\int_0^t \\sigma(X_s)\\sigma'(X_s) ds$。\n给定的 Itô SDE 是：\n$$\nX_t = X_0 + \\int_0^t b(X_s) ds + \\int_0^t \\sigma(X_s) dW_s\n$$\n我们希望将其表示为 Stratonovich 形式：\n$$\nX_t = X_0 + \\int_0^t b_{\\mathrm{Strat}}(X_s) ds + \\int_0^t \\sigma(X_s) \\circ dW_s\n$$\n为此，我们重新整理转换公式，以解出 Itô 积分项：\n$$\n\\int_0^t \\sigma(X_s) dW_s = \\int_0^t \\sigma(X_s) \\circ dW_s - \\frac{1}{2} \\langle \\sigma(X), W \\rangle_t\n$$\n现在代入 $\\langle \\sigma(X), W \\rangle_t$ 的表达式：\n$$\n\\int_0^t \\sigma(X_s) dW_s = \\int_0^t \\sigma(X_s) \\circ dW_s - \\frac{1}{2} \\int_0^t \\sigma(X_s)\\sigma'(X_s) ds\n$$\n将此代回原始的 Itô SDE 中：\n$$\nX_t = X_0 + \\int_0^t b(X_s) ds + \\left( \\int_0^t \\sigma(X_s) \\circ dW_s - \\frac{1}{2} \\int_0^t \\sigma(X_s)\\sigma'(X_s) ds \\right)\n$$\n最后，我们合并关于 $ds$ 的积分项：\n$$\nX_t = X_0 + \\int_0^t \\left( b(X_s) - \\frac{1}{2} \\sigma(X_s)\\sigma'(X_s) \\right) ds + \\int_0^t \\sigma(X_s) \\circ dW_s\n$$\n通过将其与目标 Stratonovich 形式进行比较，我们可以确定 Stratonovich 漂移项：\n$$\nb_{\\mathrm{Strat}}(X_s) = b(X_s) - \\frac{1}{2} \\sigma(X_s)\\sigma'(X_s)\n$$\n问题要求函数 $b_{\\mathrm{Strat}}(x)$ 的解析表达式，我们通过将过程变量 $X_s$ 替换为占位符变量 $x$ 来获得该表达式：\n$$\nb_{\\mathrm{Strat}}(x) = b(x) - \\frac{1}{2} \\sigma(x)\\sigma'(x)\n$$\n这个修正项 $-\\frac{1}{2}\\sigma(x)\\sigma'(x)$ 通常被称为 Itô-Stratonovich 修正项。", "answer": "$$\n\\boxed{b(x) - \\frac{1}{2}\\sigma(x)\\sigma'(x)}\n$$", "id": "2997347"}, {"introduction": "在掌握了不同的积分形式之后，我们来探讨解的不同类型。一个给定的 SDE 积分方程可能存在强解（pathwise solution），也可能只存在弱解（solution in law），这取决于其系数（如 $\\sigma(x)$）的光滑性。这个练习通过一个经典的例子 [@problem_id:2997369]，具体展示了在一个系数不满足 Lipschitz 连续性的情况下，为何强解可能不存在，而弱解依然存在，从而深刻揭示这两种解的本质区别。", "problem": "考虑一个满足通常条件的过滤概率空间 $(\\Omega,\\mathcal{F},(\\mathcal{F}_{t})_{t\\geq 0},\\mathbb{P})$，其上定义了一个一维标准布朗运动 (SBM) $W=(W_{t})_{t\\geq 0}$。令 $X=(X_{t})_{t\\geq 0}$ 是一个连续适应过程，且 $X_{0}=0$，该过程应满足以下积分形式的随机微分方程 (SDE)\n$$\nX_{t} \\;=\\; \\int_{0}^{t} \\sigma(X_{s}) \\, dW_{s}, \\qquad t\\geq 0,\n$$\n其中扩散系数为符号函数\n$$\n\\sigma(x) \\;=\\; \\operatorname{sgn}(x) \\;:=\\; \\begin{cases}\n1, & x \\geq 0,\\\\\n-1, & x<0.\n\\end{cases}\n$$\n任务：\n- 使用积分形式SDE的强解和弱解的基本定义，分析系数 $\\sigma$ 并陈述其与经典存在性和唯一性准则相关的正则性性质。你的分析必须包括 $\\sigma$ 是否有界、是否Borel可测、是否连续以及是否Lipschitz连续。\n- 基于关于鞅问题以及有界、Borel可测、一致椭圆扩散系数的弱解的成熟结果，论证此SDE弱解的存在性。\n- 通过证明在承载SBM $W$ 的概率空间上路径唯一性不成立，来表明不存在强解。从基本原理出发，论证路径唯一性的失效如何排除了强解的存在性。\n- 最后，推导任意弱解 $X$ 的二次变差，并用它来计算在固定时刻 $T>0$ 的特征函数\n$$\n\\phi_{X_{T}}(u) \\;=\\; \\mathbb{E}\\big[\\exp(i u X_{T})\\big],\n$$\n将其表示为关于 $u$ 和 $T$ 的闭式解析表达式。将你的最终答案表示为单个解析表达式。不需要数值近似。", "solution": "所述问题是随机微分方程理论中的一个标准、适定的问题。它基于已建立的数学原理，具有科学依据，提供了完整且一致的设定，并使用了精确、客观的语言。该问题是阐明SDE强解与弱解之间区别的经典例子。因此，该问题是有效的，我们可以进行求解。\n\n问题要求对积分形式为\n$$\nX_{t} = \\int_{0}^{t} \\sigma(X_{s}) \\, dW_{s}\n$$\n的随机微分方程(SDE)进行多部分分析，其中 $X_{0}=0$ 且扩散系数为 $\\sigma(x) = \\operatorname{sgn}(x)$。\n\n**第一部分：扩散系数 $\\sigma(x)$ 的分析**\n\n扩散系数定义为\n$$\n\\sigma(x) \\;=\\; \\operatorname{sgn}(x) \\;:=\\; \\begin{cases}\n1, & x \\geq 0,\\\\\n-1, & x<0.\n\\end{cases}\n$$\n我们分析其与经典SDE理论相关的正则性性质。\n\n- **有界性**：函数 $\\sigma(x)$ 的取值仅在集合 $\\{-1, 1\\}$ 中。因此，它是有界的，因为对于任意常数 $M \\geq 1$ 和所有 $x \\in \\mathbb{R}$，都有 $|\\sigma(x)| = 1 \\leq M$。\n\n- **Borel可测性**：如果一个函数的值域中任何开集的原像都是其定义域中的Borel集，则该函数是Borel可测的。考虑任意开集 $A \\subseteq \\mathbb{R}$。原像 $\\sigma^{-1}(A)$ 可能是以下集合之一：$\\emptyset$、$(-\\infty, 0)$、$[0, \\infty)$ 或 $\\mathbb{R}$。这些都是 $\\mathbb{R}$ 中的Borel集。例如，如果 $1 \\in A$ 且 $-1 \\notin A$，则 $\\sigma^{-1}(A) = [0, \\infty)$。如果 $-1 \\in A$ 且 $1 \\notin A$，则 $\\sigma^{-1}(A) = (-\\infty, 0)$。如果 $1$ 和 $-1$ 都在 $A$ 中，则 $\\sigma^{-1}(A) = \\mathbb{R}$。如果两者都不在 $A$ 中，则 $\\sigma^{-1}(A) = \\emptyset$。因此，$\\sigma(x)$ 是一个Borel可测函数。\n\n- **连续性**：函数 $\\sigma(x)$ 在所有 $x \\neq 0$ 处是连续的。然而，在 $x=0$ 处，我们有左极限 $\\lim_{x \\to 0^{-}} \\sigma(x) = -1$ 和右极限 $\\lim_{x \\to 0^{+}} \\sigma(x) = 1$。由于左右极限不相等，该函数在 $x=0$ 处不连续。\n\n- **Lipschitz连续性**：如果存在一个常数 $K > 0$ 使得对于所有 $x, y \\in \\mathbb{R}$ 都有 $|f(x) - f(y)| \\leq K|x-y|$，则函数 $f(x)$ 是全局Lipschitz连续的。由于 $\\sigma(x)$ 不连续，它不可能是全局Lipschitz连续的。它在0的任何邻域内也不是局部Lipschitz连续的。要看这一点，考虑 $x=\\epsilon > 0$ 和 $y=-\\epsilon < 0$。那么 $|\\sigma(x) - \\sigma(y)| = |1 - (-1)| = 2$。Lipschitz条件将要求 $2 \\leq K |x-y| = K|2\\epsilon|$，即 $K \\geq 1/\\epsilon$。当 $\\epsilon \\to 0$ 时，所要求的常数 $K$ 将是无界的，这违反了定义。\n\n强解的经典存在唯一性定理要求扩散系数是局部Lipschitz连续的并且满足线性增长条件。由于 $\\sigma(x)$ 在 $x=0$ 处不是局部Lipschitz连续的，该定理无法用于保证强解的存在。\n\n**第二部分：弱解的存在性**\n\nSDE的弱解由一个过滤概率空间 $(\\tilde{\\Omega},\\tilde{\\mathcal{F}},(\\tilde{\\mathcal{F}}_{t})_{t\\geq 0},\\tilde{\\mathbb{P}})$ 和一对连续适应过程 $(\\tilde{X}, \\tilde{W})$ 组成，使得 $\\tilde{W}$ 是一个 $(\\tilde{\\mathcal{F}}_{t})$-标准布朗运动，$\\tilde{X}_{0}=0$，并且积分方程成立。\n\n对于具有有界、可测系数的SDE，弱解的存在性是一个由 Stroock 和 Varadhan 通过鞅问题建立的经典结果。相关定理指出，对于形式为 $dX_t = b(t, X_t)dt + \\sigma(t, X_t)dW_t$ 的SDE，如果系数 $b$ 和 $\\sigma$ 是有界且可测的，并且矩阵 $a(t,x) = \\sigma(t,x)\\sigma(t,x)^T$ 是一致椭圆的，则弱解存在。\n在我们的例子中，漂移系数 $b(x)=0$，扩散系数为 $\\sigma(x) = \\operatorname{sgn}(x)$。\n- 正如在第一部分中确定的，$\\sigma(x)$ 是有界且Borel可测的。\n- “扩散矩阵”是一个 $1 \\times 1$ 矩阵（一个标量），由 $a(x) = \\sigma(x)\\sigma(x)^T = (\\operatorname{sgn}(x))^2 = 1$ 给出，对所有 $x \\in \\mathbb{R}$ 成立。\n- 一致椭圆性条件要求存在一个常数 $\\lambda > 0$ 使得对所有 $x, \\xi \\in \\mathbb{R}$，都有 $\\xi^T a(x) \\xi \\geq \\lambda |\\xi|^2$。对于我们的一维情况，这简化为 $a(x) \\geq \\lambda > 0$。由于 $a(x)=1$，我们可以选择 $\\lambda=1$。该条件得到满足。\n因此，根据关于有界、可测、一致椭圆扩散系数SDE的弱解存在性定理，SDE $dX_t = \\operatorname{sgn}(X_t) dW_t$ 的弱解存在。\n\n**第三部分：强解的不存在性**\n\n强解是一个适应于给定布朗运动 $W$ 生成的滤子族的过程 $X$，且该过程满足SDE。Yamada-Watanabe 定理指出，对于一个（已证明存在弱解的）SDE，强解的存在性等价于路径唯一性。路径唯一性意味着，对于给定概率空间上的任意布朗运动 $W$，任何两个从相同初始条件出发的解 $X$ 和 $Y$ 都必须是不可区分的，即 $\\mathbb{P}(X_t=Y_t \\text{ for all } t\\geq 0)=1$。\n\n我们将证明此SDE的路径唯一性不成立。\n让我们假设对于一个给定的SBM $W = (W_t)_{t \\ge 0}$ 及其自然滤子族 $(\\mathcal{F}_t^W)_{t \\ge 0}$，存在一个强解 $X = (X_t)_{t \\ge 0}$。因此，$X$ 是 $\\mathcal{F}_t^W$-适应的，并满足\n$$\nX_t = \\int_0^t \\operatorname{sgn}(X_s) dW_s.\n$$\n现在，考虑过程 $Y_t = -X_t$。过程 $Y$ 也是连续的，适应于 $\\mathcal{F}_t^W$，并且从 $Y_0=0$ 开始。我们来检查 $Y$ 是否也解这个SDE。对于 $Y$ 的SDE将是\n$$\nY_t = \\int_0^t \\operatorname{sgn}(Y_s) dW_s.\n$$\n让我们用 $Y_s = -X_s$ 来计算右边：\n$$\n\\int_0^t \\operatorname{sgn}(-X_s) dW_s = \\int_0^t -\\operatorname{sgn}(X_s) dW_s,\n$$\n其中等式 $\\operatorname{sgn}(-x) = -\\operatorname{sgn}(x)$ 对所有 $x\\neq 0$ 成立。如第四部分将要显示的，任意解 $X$ 都是一个SBM，因此时间集合 $\\{s \\ge 0 | X_s=0\\}$ 的勒贝格测度几乎必然为0。伊藤积分在被积函数于一个零测集上改变时保持不变，因此该等式对积分成立。\n积分变为\n$$\n-\\int_0^t \\operatorname{sgn}(X_s) dW_s = -X_t = Y_t.\n$$\n这表明，如果 $X_t$ 是一个强解，那么 $Y_t = -X_t$ 也是对于同一个布朗运动 $W$ 的一个强解。\n\n正如第四部分所示，任何解 $X$ 都必须是一个SBM。一个SBM不恒等于零（以概率1）。因此，$X_t$ 和 $Y_t = -X_t$ 是两个不同的过程。这证明了路径唯一性的失效。\n由于路径唯一性不成立，Yamada-Watanabe定理意味着此SDE不存在强解。\n\n**第四部分：二次变差与特征函数**\n\n令 $X = (X_t)_{t\\geq 0}$ 是该SDE的任意弱解。根据定义，$X$ 是一个连续过程，满足 $X_t = M_t$，其中 $M_t = \\int_0^t \\sigma(X_s) dW_s$。这意味着 $X$ 是一个从 $X_0=0$ 开始的连续局部鞅。\n\n$X$ 的二次变差过程，记为 $\\langle X \\rangle_t$，由伊藤积分的一般公式给出：\n$$\n\\langle X \\rangle_t = \\left\\langle \\int_0^\\cdot \\sigma(X_s) dW_s \\right\\rangle_t = \\int_0^t \\sigma(X_s)^2 ds.\n$$\n使用我们特定的 $\\sigma(x)$ 定义，我们发现对所有 $x \\in \\mathbb{R}$，$\\sigma(x)^2 = (\\operatorname{sgn}(x))^2 = 1$。\n将此代入二次变差的表达式中得到：\n$$\n\\langle X \\rangle_t = \\int_0^t 1^2 ds = t.\n$$\n所以，$X$ 是一个从 $X_0=0$ 开始的连续局部鞅，其二次变差为 $\\langle X \\rangle_t = t$。根据Lévy对布朗运动的刻画，任何这样的过程都必须是一个标准布朗运动(SBM)。因此，此SDE的任何弱解 $X$ 都具有SBM的分布。\n\n我们被要求计算在固定时刻 $T>0$ 时 $X_T$ 的特征函数，其定义为 $\\phi_{X_T}(u) = \\mathbb{E}[\\exp(iuX_T)]$。由于过程 $X$ 的分布是SBM的分布，随机变量 $X_T$ 服从均值为0、方差为T的正态分布。即，$X_T \\sim N(0, T)$。\n\n一个一般正态随机变量 $Z \\sim N(\\mu, \\sigma^2)$ 的特征函数由 $\\phi_Z(u) = \\exp(iu\\mu - \\frac{1}{2}u^2\\sigma^2)$ 给出。\n对于 $X_T$，我们有均值 $\\mu = 0$ 和方差 $\\sigma^2 = T$。代入这些值，我们得到：\n$$\n\\phi_{X_T}(u) = \\mathbb{E}[\\exp(iuX_T)] = \\exp\\left(iu(0) - \\frac{1}{2}u^2T\\right) = \\exp\\left(-\\frac{1}{2}Tu^2\\right).\n$$\n这就是 $X_T$ 的特征函数。", "answer": "$$\\boxed{\\exp\\left(-\\frac{1}{2}Tu^{2}\\right)}$$", "id": "2997369"}, {"introduction": "理论的最终目的是指导实践。由于大多数 SDE 无法求得解析解，数值方法，如 Euler-Maruyama 格式，成为了不可或缺的工具。这个练习将理论与实践相结合 [@problem_id:2997345]，要求你利用 SDE 的精确积分形式和 Itô 等距性质，来严格分析一个数值格式的均方误差。这不仅能加深你对 SDE 积分表示的理解，也为评估更复杂的随机数值方法的收敛性奠定了基础。", "problem": "考虑由标准维纳过程（也称为布朗运动）$W_t$ 驱动的 Ornstein–Uhlenbeck 过程的线性随机微分方程（SDE）：\n$$\ndX_t \\,=\\, -\\alpha X_t \\,dt \\,+\\, \\sigma \\, dW_t,\\quad X_0 \\,=\\, x_0,\n$$\n其中 $\\alpha>0$，$\\sigma \\in \\mathbb{R}$ 和 $x_0 \\in \\mathbb{R}$ 是确定性常数。设时间范围为 $T>0$，并固定一个均匀时间步长 $h \\in (0,T)$，使得 $T/h$ 是一个正整数。定义 Euler–Maruyama 时间网格 $t_k = k h$（对于 $k = 0,1,\\dots, T/h$），以及 Euler–Maruyama 近似 $\\{X_k^{\\mathrm{E}}\\}$ 为\n$$\nX_{k+1}^{\\mathrm{E}} \\,=\\, X_k^{\\mathrm{E}} \\,+\\, \\left(-\\alpha X_k^{\\mathrm{E}}\\right) h \\,+\\, \\sigma \\left(W_{t_{k+1}} - W_{t_k}\\right),\\quad X_0^{\\mathrm{E}} = x_0.\n$$\n仅使用精确解的积分形式、积分因子法和伊藤等距性，计算在终端时间 $T$ 的均方误差（MSE），\n$$\n\\mathbb{E}\\!\\left[\\,\\bigl(X_T - X_{T/h}^{\\mathrm{E}}\\bigr)^2\\,\\right],\n$$\n其形式为关于参数 $\\alpha$、$\\sigma$、$x_0$、$T$ 和 $h$ 的单个闭式解析表达式。将你的最终答案表示为单个解析表达式。不要进行任何数值舍入。", "solution": "该问题是有效的，因为它具有科学依据、良定且客观。它是随机微分方程数值方法分析中的一个标准问题。\n\n目标是计算在时间 $T$ 的均方误差 $\\mathbb{E}[(X_T - X_{T/h}^{\\mathrm{E}})^2]$。设 $N = T/h$ 为时间步数。在时间 $T = t_N$ 的误差为 $e_T = X_T - X_N^{\\mathrm{E}}$。\n\n均方误差可以分解为：\n$$\n\\mathbb{E}[e_T^2] \\,=\\, \\mathbb{E}[(e_T - \\mathbb{E}[e_T])^2] \\,+\\, (\\mathbb{E}[e_T])^2 \\,=\\, \\mathrm{Var}(e_T) \\,+\\, (\\mathbb{E}[e_T])^2\n$$\n\n首先，我们求解 SDE $dX_t = -\\alpha X_t dt + \\sigma dW_t$（其中 $X_0 = x_0$）的精确解 $X_t$。我们使用积分因子法。设积分因子为 $I_t = \\exp(\\alpha t)$。考虑过程 $Y_t = I_t X_t = \\exp(\\alpha t) X_t$。使用伊藤乘积法则：\n$$\ndY_t \\,=\\, d(\\exp(\\alpha t) X_t) \\,=\\, (\\alpha \\exp(\\alpha t) X_t) dt \\,+\\, \\exp(\\alpha t) dX_t\n$$\n代入 $dX_t = -\\alpha X_t dt + \\sigma dW_t$：\n$$\ndY_t \\,=\\, (\\alpha \\exp(\\alpha t) X_t) dt \\,+\\, \\exp(\\alpha t) (-\\alpha X_t dt + \\sigma dW_t) \\,=\\, \\sigma \\exp(\\alpha t) dW_t\n$$\n从 $s=0$ 到 $s=t$ 积分：\n$$\nY_t - Y_0 \\,=\\, \\sigma \\int_0^t \\exp(\\alpha s) dW_s\n$$\n$$\n\\exp(\\alpha t) X_t - \\exp(0) X_0 \\,=\\, \\sigma \\int_0^t \\exp(\\alpha s) dW_s\n$$\n解出 $X_t$，我们得到解的积分形式：\n$$\nX_t \\,=\\, x_0 \\exp(-\\alpha t) \\,+\\, \\sigma \\int_0^t \\exp(-\\alpha(t-s)) dW_s\n$$\n在终端时间 $T$，精确解为：\n$$\nX_T \\,=\\, x_0 \\exp(-\\alpha T) \\,+\\, \\sigma \\int_0^T \\exp(-\\alpha(T-s)) dW_s\n$$\n精确解的期望为 $\\mathbb{E}[X_T] = x_0 \\exp(-\\alpha T)$，因为伊藤积分的均值为零。\n\n接下来，我们求 Euler-Maruyama 近似 $X_k^{\\mathrm{E}}$ 的显式形式。该格式由以下递推关系给出：\n$$\nX_{k+1}^{\\mathrm{E}} \\,=\\, (1-\\alpha h) X_k^{\\mathrm{E}} \\,+\\, \\sigma (W_{t_{k+1}} - W_{t_k})\n$$\n其中 $X_0^{\\mathrm{E}} = x_0$。设 $\\Delta W_k = W_{t_{k+1}} - W_{t_k}$。将递推关系从 $k=N-1$ 向下展开到 $k=0$：\n$$\nX_N^{\\mathrm{E}} \\,=\\, (1-\\alpha h) X_{N-1}^{\\mathrm{E}} + \\sigma \\Delta W_{N-1}\n$$\n$$\nX_N^{\\mathrm{E}} \\,=\\, (1-\\alpha h)((1-\\alpha h)X_{N-2}^{\\mathrm{E}} + \\sigma \\Delta W_{N-2}) + \\sigma \\Delta W_{N-1}\n$$\n$$\n\\vdots\n$$\n$$\nX_N^{\\mathrm{E}} \\,=\\, (1-\\alpha h)^N X_0^{\\mathrm{E}} \\,+\\, \\sigma \\sum_{j=0}^{N-1} (1-\\alpha h)^{N-1-j} \\Delta W_j\n$$\n数值解的期望为 $\\mathbb{E}[X_N^{\\mathrm{E}}] = (1-\\alpha h)^N x_0$，因为 $\\mathbb{E}[\\Delta W_j]=0$。\n\n误差的均值是均值的差：\n$$\n\\mathbb{E}[e_T] \\,=\\, \\mathbb{E}[X_T] - \\mathbb{E}[X_N^{\\mathrm{E}}] \\,=\\, x_0 \\exp(-\\alpha T) - x_0 (1-\\alpha h)^N\n$$\n误差均值的平方为：\n$$\n(\\mathbb{E}[e_T])^2 \\,=\\, x_0^2 (\\exp(-\\alpha T) - (1-\\alpha h)^N)^2\n$$\n\n现在我们计算误差的方差，$\\mathrm{Var}(e_T) = \\mathbb{E}[(e_T - \\mathbb{E}[e_T])^2]$。\n$$\ne_T - \\mathbb{E}[e_T] \\,=\\, (X_T - \\mathbb{E}[X_T]) - (X_N^{\\mathrm{E}} - \\mathbb{E}[X_N^{\\mathrm{E}}])\n$$\n$$\ne_T - \\mathbb{E}[e_T] \\,=\\, \\sigma \\int_0^T \\exp(-\\alpha(T-s)) dW_s - \\sigma \\sum_{j=0}^{N-1} (1-\\alpha h)^{N-1-j} \\Delta W_j\n$$\n我们可以将该和重写为具有常数被积函数的随机积分之和：\n$$\n\\sum_{j=0}^{N-1} (1-\\alpha h)^{N-1-j} \\Delta W_j \\,=\\, \\sum_{j=0}^{N-1} \\int_{t_j}^{t_{j+1}} (1-\\alpha h)^{N-1-j} dW_s\n$$\n结合精确解和数值解的随机部分：\n$$\ne_T - \\mathbb{E}[e_T] \\,=\\, \\sigma \\sum_{j=0}^{N-1} \\int_{t_j}^{t_{j+1}} \\left( \\exp(-\\alpha(T-s)) - (1-\\alpha h)^{N-1-j} \\right) dW_s\n$$\n设 $f_j(s) = \\exp(-\\alpha(T-s)) - (1-\\alpha h)^{N-1-j}$。方差为：\n$$\n\\mathrm{Var}(e_T) \\,=\\, \\mathbb{E}\\left[ \\left( \\sigma \\sum_{j=0}^{N-1} \\int_{t_j}^{t_{j+1}} f_j(s) dW_s \\right)^2 \\right]\n$$\n维纳过程在不相交区间上的增量是独立的，这意味着在这些区间上的伊藤积分是不相关的。因此，交叉项的期望为零：\n$$\n\\mathrm{Var}(e_T) \\,=\\, \\sigma^2 \\sum_{j=0}^{N-1} \\mathbb{E}\\left[ \\left( \\int_{t_j}^{t_{j+1}} f_j(s) dW_s \\right)^2 \\right]\n$$\n根据伊藤等距性，这变为：\n$$\n\\mathrm{Var}(e_T) \\,=\\, \\sigma^2 \\sum_{j=0}^{N-1} \\int_{t_j}^{t_{j+1}} f_j(s)^2 ds \\,=\\, \\sigma^2 \\sum_{j=0}^{N-1} \\int_{t_j}^{t_{j+1}} \\left( \\exp(-\\alpha(T-s)) - (1-\\alpha h)^{N-1-j} \\right)^2 ds\n$$\n我们展开平方并计算积分的和。设 $C_j = (1-\\alpha h)^{N-1-j}$。\n$$\n\\int_{t_j}^{t_{j+1}} ( \\exp(-2\\alpha(T-s)) - 2C_j\\exp(-\\alpha(T-s)) + C_j^2 ) ds\n$$\n将这三项对 $j=0, \\dots, N-1$ 求和：\n1.  第一项的和：\n    $$\n    \\sum_{j=0}^{N-1} \\int_{t_j}^{t_{j+1}} \\exp(-2\\alpha(T-s)) ds \\,=\\, \\int_0^T \\exp(-2\\alpha(T-s)) ds \\,=\\, \\left[\\frac{\\exp(-2\\alpha(T-s))}{2\\alpha}\\right]_0^T \\,=\\, \\frac{1-\\exp(-2\\alpha T)}{2\\alpha}\n    $$\n2.  第三项的和：\n    $$\n    \\sum_{j=0}^{N-1} \\int_{t_j}^{t_{j+1}} C_j^2 ds \\,=\\, \\sum_{j=0}^{N-1} C_j^2 h \\,=\\, h \\sum_{j=0}^{N-1} ((1-\\alpha h)^2)^{N-1-j}\n    $$\n    这是一个几何级数。设 $k = N-1-j$。该和变为 $h \\sum_{k=0}^{N-1} ((1-\\alpha h)^2)^k$。\n    $$\n    h \\frac{1 - ((1-\\alpha h)^2)^N}{1-(1-\\alpha h)^2} \\,=\\, h \\frac{1 - (1-\\alpha h)^{2N}}{1 - (1 - 2\\alpha h + \\alpha^2 h^2)} \\,=\\, h \\frac{1 - (1-\\alpha h)^{2N}}{2\\alpha h - \\alpha^2 h^2} \\,=\\, \\frac{1 - (1-\\alpha h)^{2N}}{\\alpha(2-\\alpha h)}\n    $$\n3.  中间项的和：\n    $$\n    -2 \\sum_{j=0}^{N-1} C_j \\int_{t_j}^{t_{j+1}} \\exp(-\\alpha(T-s)) ds\n    $$\n    积分为 $[\\frac{\\exp(-\\alpha(T-s))}{\\alpha}]_{t_j}^{t_{j+1}} = \\frac{1}{\\alpha}(\\exp(-\\alpha(T-t_{j+1})) - \\exp(-\\alpha(T-t_j)))$。\n    和为 $-\\frac{2}{\\alpha} \\sum_{j=0}^{N-1} (1-\\alpha h)^{N-1-j} (\\exp(-\\alpha(N-j-1)h) - \\exp(-\\alpha(N-j)h))$。\n    设 $u=1-\\alpha h$ 和 $v=\\exp(-\\alpha h)$。项为 $(u^{N-1-j})(v^{N-j-1}-v^{N-j}) = u^{N-1-j} v^{N-j-1}(1-v)$。\n    和为 $-\\frac{2(1-v)}{\\alpha} \\sum_{j=0}^{N-1} (uv)^{N-1-j}$。设 $k=N-1-j$。这是一个几何和 $\\sum_{k=0}^{N-1} (uv)^k = \\frac{1-(uv)^N}{1-uv}$。\n    所以中间项的和是：\n    $$\n    -\\frac{2(1-v)}{\\alpha} \\frac{1-(uv)^N}{1-uv} \\,=\\, -\\frac{2(1-\\exp(-\\alpha h))}{\\alpha} \\frac{1-(1-\\alpha h)^N \\exp(-\\alpha N h)}{1-(1-\\alpha h)\\exp(-\\alpha h)}\n    $$\n\n结合所有部分，均方误差 (MSE) 为 $\\mathbb{E}[e_T^2] = (\\mathbb{E}[e_T])^2 + \\mathrm{Var}(e_T)$。代入 $N=T/h$：\n$$\n\\mathbb{E}[e_T^2] \\,=\\, x_0^2 (\\exp(-\\alpha T) - (1-\\alpha h)^{T/h})^2 \\,+\\, \\sigma^2 \\left( \\frac{1-\\exp(-2\\alpha T)}{2\\alpha} \\,+\\, \\frac{1 - (1-\\alpha h)^{2T/h}}{\\alpha(2-\\alpha h)} \\,-\\, \\frac{2(1-\\exp(-\\alpha h))}{\\alpha} \\frac{1-(1-\\alpha h)^{T/h} \\exp(-\\alpha T)}{1-(1-\\alpha h)\\exp(-\\alpha h)} \\right)\n$$\n这就是均方误差的单个闭式解析表达式。", "answer": "$$\n\\boxed{\nx_0^2 \\left(\\exp(-\\alpha T) - (1-\\alpha h)^{T/h}\\right)^2 + \\sigma^2 \\left( \\frac{1-\\exp(-2\\alpha T)}{2\\alpha} + \\frac{1 - (1-\\alpha h)^{2T/h}}{\\alpha(2-\\alpha h)} - \\frac{2(1-\\exp(-\\alpha h))}{\\alpha} \\frac{1-(1-\\alpha h)^{T/h} \\exp(-\\alpha T)}{1-(1-\\alpha h)\\exp(-\\alpha h)} \\right)\n}\n$$", "id": "2997345"}]}