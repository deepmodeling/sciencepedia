{"hands_on_practices": [{"introduction": "本练习聚焦于 Doléans-Dade 指数鞅，即在 Cameron-Martin-Girsanov 定理中定义 Radon-Nikodym 导数 $Z_t$ 的随机过程。通过验证在特定条件下它是一个真鞅，并应用可选停止定理来计算其在随机时间 $\\tau$ 的期望值，您将巩固对实现测度变换的基本概率机制的理解。这个实践对于深入领会 Girsanov 变换背后的数学引擎至关重要 [@problem_id:3000259]。", "problem": "考虑一个满足通常条件的带滤概率空间 $(\\Omega,\\mathcal{F},(\\mathcal{F}_{t})_{t\\geq 0},\\mathbb{P})$，其上定义了一个一维标准布朗运动 $W=(W_{t})_{t\\geq 0}$。固定一个有限时间域 $T>0$。设 $\\theta=(\\theta_{t})_{t\\in[0,T]}$ 是一个渐进可测过程，满足对于某个常数 $K<\\infty$，在所有 $t\\in[0,T]$ 上几乎必然有 $|\\theta_{t}|\\leq K$，并且几乎必然有 $\\int_{0}^{T}\\theta_{s}^{2}\\,\\mathrm{d}s<\\infty$。定义 Doléans-Dade 指数\n$$\nZ_{t} \\;=\\; \\exp\\!\\Bigg(\\,\\int_{0}^{t}\\theta_{s}\\,\\mathrm{d}W_{s}\\;-\\;\\frac{1}{2}\\int_{0}^{t}\\theta_{s}^{2}\\,\\mathrm{d}s\\,\\Bigg),\\qquad t\\in[0,T].\n$$\n设 $\\tau$ 是一个 $(\\mathcal{F}_{t})$-停时，满足 $0\\leq \\tau\\leq T$ 几乎必然。\n\n仅从布朗运动、随机积分、二次变差和 Itô 微积分（包括 Itô 公式）的定义出发，并使用诸如 Novikov 条件等公认的真鞅充分条件，完成以下任务：\n\n- 证明 $(Z_{t})_{t\\in[0,T]}$ 是一个真鞅，且对所有 $t\\in[0,T]$ 都有 $\\mathbb{E}[Z_{t}]=1$。\n- 论证截停过程 $(Z_{t\\wedge \\tau})_{t\\in[0,T]}$ 是一个鞅。\n- 应用可选停止定理计算 $\\mathbb{E}[Z_{\\tau}]$。\n\n你的最终答案必须是一个实数。无需四舍五入。不涉及物理单位。", "solution": "该问题要求我们首先证明过程 $(Z_t)_{t\\in[0,T]}$ 是一个真鞅，然后利用此性质以及可选停止定理来计算期望 $\\mathbb{E}[Z_{\\tau}]$。\n\n过程 $Z_t$ 是 Doléans-Dade 指数，定义为\n$$\nZ_{t} \\;=\\; \\exp\\!\\Bigg(\\,\\int_{0}^{t}\\theta_{s}\\,\\mathrm{d}W_{s}\\;-\\;\\frac{1}{2}\\int_{0}^{t}\\theta_{s}^{2}\\,\\mathrm{d}s\\,\\Bigg).\n$$\n我们定义过程 $X_t$ 为指数的参数：\n$$\nX_{t} \\;=\\; \\int_{0}^{t}\\theta_{s}\\,\\mathrm{d}W_{s}\\;-\\;\\frac{1}{2}\\int_{0}^{t}\\theta_{s}^{2}\\,\\mathrm{d}s.\n$$\n其微分形式为 $\\mathrm{d}X_t = \\theta_t\\,\\mathrm{d}W_t - \\frac{1}{2}\\theta_t^2\\,\\mathrm{d}t$。过程 $Z_t$ 可以写成 $Z_t = f(X_t)$，其中 $f(x) = \\exp(x)$。我们应用 Itô 公式来求 $Z_t$ 的随机微分。$f(x)$ 的导数是 $f'(x) = \\exp(x)$ 和 $f''(x) = \\exp(x)$。\n\n$X_t$ 的二次变差由下式给出\n$$\n\\mathrm{d}\\langle X \\rangle_{t} = \\left(\\theta_t\\right)^2 \\mathrm{d}\\langle W \\rangle_{t} = \\theta_t^2\\,\\mathrm{d}t.\n$$\n根据 Itô 公式，$Z_t = f(X_t)$ 的微分为：\n$$\n\\mathrm{d}Z_t = f'(X_t)\\,\\mathrm{d}X_t + \\frac{1}{2}f''(X_t)\\,\\mathrm{d}\\langle X \\rangle_t.\n$$\n代入导数和微分的表达式，我们得到\n$$\n\\mathrm{d}Z_t = \\exp(X_t)\\left(\\theta_t\\,\\mathrm{d}W_t - \\frac{1}{2}\\theta_t^2\\,\\mathrm{d}t\\right) + \\frac{1}{2}\\exp(X_t)\\left(\\theta_t^2\\,\\mathrm{d}t\\right).\n$$\n注意到 $\\exp(X_t) = Z_t$，上式可化简为\n$$\n\\mathrm{d}Z_t = Z_t \\theta_t\\,\\mathrm{d}W_t - \\frac{1}{2}Z_t \\theta_t^2\\,\\mathrm{d}t + \\frac{1}{2}Z_t \\theta_t^2\\,\\mathrm{d}t = Z_t \\theta_t\\,\\mathrm{d}W_t.\n$$\n写成积分形式，该方程变为\n$$\nZ_t = Z_0 + \\int_0^t Z_s \\theta_s\\,\\mathrm{d}W_s.\n$$\n初始值为 $Z_0 = \\exp(0-0) = 1$。因此，\n$$\nZ_t = 1 + \\int_0^t Z_s \\theta_s\\,\\mathrm{d}W_s.\n$$\n过程 $\\theta_t$ 是渐进可测且有界的，而 $Z_t$ 是适应的且路径连续。因此，乘积 $Z_t \\theta_t$ 是一个满足 Itô 积分标准可积性条件的渐进可测过程。随机积分 $\\int_0^t Z_s \\theta_s\\,\\mathrm{d}W_s$ 是一个连续局部鞅。由于 $Z_t$ 是一个常数与一个连续局部鞅之和，因此 $(Z_t)_{t\\in[0,T]}$ 本身就是一个连续局部鞅。\n\n为证明 $(Z_t)_{t\\in[0,T]}$ 是一个真鞅，我们验证 Novikov 条件。过程 $Z_t$ 是过程 $M_t = \\int_0^t \\theta_s\\,\\mathrm{d}W_s$ 的随机指数，因此 $Z_t = \\mathcal{E}(M)_t$。Novikov 条件表明，如果 $\\mathbb{E}\\left[\\exp\\left(\\frac{1}{2}\\langle M \\rangle_T\\right)\\right] < \\infty$，则 $\\mathcal{E}(M)_t$ 在 $[0,T]$ 上是一个真鞅。$M_t$ 的二次变差为 $\\langle M \\rangle_t = \\int_0^t \\theta_s^2\\,\\mathrm{d}s$。我们必须检验是否\n$$\n\\mathbb{E}\\left[\\exp\\left(\\frac{1}{2}\\int_0^T \\theta_s^2\\,\\mathrm{d}s\\right)\\right] < \\infty.\n$$\n我们已知过程 $\\theta_t$ 是有界的，即存在常数 $K < \\infty$ 使得对所有 $t\\in[0,T]$ 几乎必然有 $|\\theta_t| \\leq K$。这意味着 $\\theta_t^2 \\leq K^2$ 几乎必然。因此，该积分是有界的：\n$$\n\\int_0^T \\theta_s^2\\,\\mathrm{d}s \\leq \\int_0^T K^2\\,\\mathrm{d}s = K^2T \\quad \\text{几乎必然}\n$$\n这意味着期望内的随机变量是有界的：\n$$\n\\exp\\left(\\frac{1}{2}\\int_0^T \\theta_s^2\\,\\mathrm{d}s\\right) \\leq \\exp\\left(\\frac{1}{2}K^2T\\right) \\quad \\text{几乎必然}\n$$\n由于 $\\exp(\\frac{1}{2}K^2T)$ 是一个有限常数，其期望也为有限：\n$$\n\\mathbb{E}\\left[\\exp\\left(\\frac{1}{2}\\int_0^T \\theta_s^2\\,\\mathrm{d}s\\right)\\right] \\leq \\exp\\left(\\frac{1}{2}K^2T\\right) < \\infty.\n$$\nNovikov 条件成立，这证明了 $(Z_t)_{t\\in[0,T]}$ 是一个真鞅。\n对于任何鞅，其期望不随时间变化。因此，对任意 $t \\in [0,T]$，\n$$\n\\mathbb{E}[Z_t] = \\mathbb{E}[Z_0] = \\mathbb{E}[1] = 1.\n$$\n这完成了任务的第一部分。\n\n接下来，我们必须论证截停过程 $(Z_{t\\wedge \\tau})_{t\\in[0,T]}$ 是一个鞅。这是鞅论中的一个标准结论：如果 $(M_t)$ 是关于域流 $(\\mathcal{F}_t)$ 的一个鞅，且 $\\tau$ 是一个 $(\\mathcal{F}_t)$-停时，那么截停过程 $(M_{t\\wedge \\tau})$ 也是一个鞅。由于我们已经证明了 $(Z_t)_{t\\in[0,T]}$ 是一个真鞅，且 $\\tau$ 是一个 $(\\mathcal{F}_t)$-停时，我们断定 $(Z_{t\\wedge \\tau})_{t\\in[0,T]}$ 是一个鞅。\n\n最后，我们应用可选停止定理来计算 $\\mathbb{E}[Z_{\\tau}]$。该定理指出，如果 $(M_t)$ 是一个鞅且 $\\tau$ 是一个停时，在某些条件下，有 $\\mathbb{E}[M_\\tau] = \\mathbb{E}[M_0]$。其中一个充分条件是停时 $\\tau$ 有界。问题指明 $\\tau$ 是一个 $(\\mathcal{F}_t)$-停时，且满足 $0 \\leq \\tau \\leq T$ 几乎必然。这意味着 $\\tau$ 是一个有界停时。\n将可选停止定理应用于鞅 $(Z_t)_{t\\in[0,T]}$ 和有界停时 $\\tau$，我们有：\n$$\n\\mathbb{E}[Z_\\tau] = \\mathbb{E}[Z_0].\n$$\n如前所算，$Z_0=1$。因此，\n$$\n\\mathbb{E}[Z_\\tau] = 1.\n$$\n这一点也可以通过注意到任何在有限闭区间 $[0,T]$ 上的连续鞅都是一致可积的来证明。可选停止定理对一致可积鞅和任意停时 $\\sigma$ 都成立。因此，对于我们的停时 $\\tau \\le T$，我们有 $\\mathbb{E}[Z_\\tau]=\\mathbb{E}[Z_0]=1$。使用有界停时的论证更为直接。", "answer": "$$\\boxed{1}$$", "id": "3000259"}, {"introduction": "Cameron-Martin-Girsanov 公式可能显得有些抽象。本问题通过考察其在有限维空间中的类似形式，将其与我们熟悉的多维正态分布的性质联系起来，从而搭建了一座具象化的桥梁。通过计算一个在离散时间点上被确定性函数 $h(t)$ 平移的维纳过程向量的概率密度之比 [@problem_id:3000310]，您将对连续时间 Girsanov 密度的结构获得一种强有力的直观认识。", "problem": "设在带滤概率空间 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\ge 0},\\mathbb{P})$ 上定义了标准一维维纳过程 $W=(W_t)_{t\\ge 0}$。固定一组确定性时间点 $0=t_0<t_1<\\dots<t_n$，$n\\in\\mathbb{N}$。设 $h:[0,t_n]\\to\\mathbb{R}$ 是一个绝对连续函数，满足 $h(0)=0$ 且其导数 $h'$ 平方可积，$h'\\in L^2([0,t_n])$，因此 $h$ 属于 Cameron–Martin 空间。考虑有限维向量 $X=(W_{t_1},\\dots,W_{t_n})$ 和 $Y=(W_{t_1}+h(t_1),\\dots,W_{t_n}+h(t_n))$。\n\n请仅使用以下基本事实：标准维纳过程的有限维分布是均值为 $0$、协方差矩阵 $\\Sigma$ 由 $\\Sigma_{ij}=\\min\\{t_i,t_j\\}$ 给出的多元正态分布；以及将一个多元正态向量加上一个确定性均值向量只会改变其均值而协方差保持不变。完成以下任务：\n\n1. 确定 $Y$ 的分布，用其均值向量和协方差矩阵进行描述。\n2. 计算在任意点 $x=(x_1,\\dots,x_n)\\in\\mathbb{R}^n$ 处，$Y$ 的概率律关于 $X$ 的概率律的 Radon–Nikodym 密度比（即勒贝格密度之比）。请用时间增量 $\\Delta_k:=t_k-t_{k-1}$ 和由 $h(t_k)-h(t_{k-1})$ 给出的 $h$ 的离散增量来表达你的答案，并给出闭式解。你的最终答案应为该密度比关于 $x_1,\\dots,x_n$ 的单个解析表达式。\n\n不需要数值近似；请提供精确的符号表达式。最终方框内的答案应仅包含密度比的闭式表达式。", "solution": "**第1部分：Y 的分布**\n\n设 $X = (W_{t_1}, \\dots, W_{t_n})$。根据题目陈述，$X$ 服从多元正态分布。其均值向量为 $\\mathbb{E}[X] = (\\mathbb{E}[W_{t_1}], \\dots, \\mathbb{E}[W_{t_n}]) = (0, \\dots, 0) = \\mathbf{0}$。协方差矩阵 $\\Sigma$ 的元素为 $\\Sigma_{ij} = \\text{Cov}(W_{t_i}, W_{t_j}) = \\min\\{t_i, t_j\\}$。因此，$X$ 的概率律为 $\\mathcal{N}(\\mathbf{0}, \\Sigma)$。\n\n向量 $Y$ 定义为 $Y = (W_{t_1}+h(t_1), \\dots, W_{t_n}+h(t_n))$。这可以写成 $Y = X + \\mathbf{h}$，其中 $\\mathbf{h} = (h(t_1), \\dots, h(t_n))$ 是一个确定性向量。\n\n使用给定的前提，即一个多元正态向量加上一个确定性向量仅会使其均值发生平移，我们可以确定 $Y$ 的分布。\n$Y$ 的均值为 $\\mathbb{E}[Y] = \\mathbb{E}[X + \\mathbf{h}] = \\mathbb{E}[X] + \\mathbf{h} = \\mathbf{0} + \\mathbf{h} = \\mathbf{h}$。\n$Y$ 的协方差矩阵为 $\\text{Cov}(Y) = \\text{Cov}(X + \\mathbf{h}) = \\text{Cov}(X) = \\Sigma$。\n\n因此，$Y$ 的分布是均值向量为 $\\mathbf{h}$、协方差矩阵为 $\\Sigma$ 的多元正态分布。我们记为 $Y \\sim \\mathcal{N}(\\mathbf{h}, \\Sigma)$。\n\n**第2部分：Radon–Nikodym 密度比**\n\n$Y$ 的概率律关于 $X$ 的概率律的 Radon–Nikodym 导数在点 $x \\in \\mathbb{R}^n$ 处的值，是它们的概率密度函数（PDF）之比，即 $\\frac{f_Y(x)}{f_X(x)}$。\n\n一个一般的 $n$ 维正态向量 $Z \\sim \\mathcal{N}(\\mu, C)$ 的 PDF 由下式给出\n$$f_Z(z) = \\frac{1}{\\sqrt{(2\\pi)^n \\det(C)}} \\exp\\left(-\\frac{1}{2}(z-\\mu)^T C^{-1} (z-\\mu)\\right)$$\n对于 $X \\sim \\mathcal{N}(\\mathbf{0}, \\Sigma)$，其 PDF 为\n$$f_X(x) = \\frac{1}{\\sqrt{(2\\pi)^n \\det(\\Sigma)}} \\exp\\left(-\\frac{1}{2}x^T \\Sigma^{-1} x\\right)$$\n对于 $Y \\sim \\mathcal{N}(\\mathbf{h}, \\Sigma)$，其 PDF 为\n$$f_Y(x) = \\frac{1}{\\sqrt{(2\\pi)^n \\det(\\Sigma)}} \\exp\\left(-\\frac{1}{2}(x-\\mathbf{h})^T \\Sigma^{-1} (x-\\mathbf{h})\\right)$$\n该比值为\n$$\\frac{f_Y(x)}{f_X(x)} = \\frac{\\exp\\left(-\\frac{1}{2}(x-\\mathbf{h})^T \\Sigma^{-1} (x-\\mathbf{h})\\right)}{\\exp\\left(-\\frac{1}{2}x^T \\Sigma^{-1} x\\right)} = \\exp\\left(-\\frac{1}{2} \\left[ (x-\\mathbf{h})^T \\Sigma^{-1} (x-\\mathbf{h}) - x^T \\Sigma^{-1} x \\right]\\right)$$\n展开指数中的二次型可得\n$$(x-\\mathbf{h})^T \\Sigma^{-1} (x-\\mathbf{h}) = x^T \\Sigma^{-1} x - 2x^T \\Sigma^{-1} \\mathbf{h} + \\mathbf{h}^T \\Sigma^{-1} \\mathbf{h}$$\n这里我们利用了 $\\Sigma^{-1}$ 的对称性。\n将此代入比值的指数，我们得到\n$$ \\text{exponent} = -\\frac{1}{2} [ (x^T \\Sigma^{-1} x - 2x^T \\Sigma^{-1} \\mathbf{h} + \\mathbf{h}^T \\Sigma^{-1} \\mathbf{h}) - x^T \\Sigma^{-1} x ] = x^T \\Sigma^{-1} \\mathbf{h} - \\frac{1}{2}\\mathbf{h}^T \\Sigma^{-1} \\mathbf{h} $$\n密度比为 $\\exp\\left(x^T \\Sigma^{-1} \\mathbf{h} - \\frac{1}{2}\\mathbf{h}^T \\Sigma^{-1} \\mathbf{h}\\right)$。\n\n为了将其表示为所要求的形式，我们必须分析 $\\Sigma^{-1}$。我们考虑维纳过程的增量向量 $Z = (Z_1, \\dots, Z_n)$，其中 $Z_k = W_{t_k} - W_{t_{k-1}}$，$k=1,\\dots,n$，且 $t_0=0$。这些增量是独立的，且 $Z_k \\sim \\mathcal{N}(0, t_k - t_{k-1})$。令 $\\Delta_k = t_k - t_{k-1}$。$Z$ 的协方差矩阵是一个对角矩阵 $D$，其对角元为 $D_{kk} = \\Delta_k$。\n\n$X$ 的分量可以表示为 $Z$ 的分量的累积和：$W_{t_k} = \\sum_{j=1}^k Z_j$。这是一个线性变换 $X=AZ$，其中 $A$ 是一个 $n \\times n$ 的全1下三角矩阵：\n$$ A = \\begin{pmatrix} 1 & 0 & \\dots & 0 \\\\ 1 & 1 & \\dots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ 1 & 1 & \\dots & 1 \\end{pmatrix} $$\n$X$ 的协方差矩阵是 $\\Sigma = \\text{Cov}(AZ) = A\\,\\text{Cov}(Z)\\,A^T = ADA^T$。\n其逆矩阵为 $\\Sigma^{-1} = (A^T)^{-1} D^{-1} A^{-1}$。矩阵 $A^{-1}$ 表示累积和的逆运算，即作差分：\n$$ A^{-1} = \\begin{pmatrix} 1 & 0 & 0 & \\dots & 0 \\\\ -1 & 1 & 0 & \\dots & 0 \\\\ 0 & -1 & 1 & \\dots & 0 \\\\ \\vdots & \\ddots & \\ddots & \\ddots & \\vdots \\\\ 0 & \\dots & 0 & -1 & 1 \\end{pmatrix} $$\n我们将此结构应用于指数中的各项。第一项是 $x^T \\Sigma^{-1} \\mathbf{h} = x^T (A^T)^{-1} D^{-1} A^{-1} \\mathbf{h}$。这可以重写为 $(A^{-1}x)^T D^{-1} (A^{-1}\\mathbf{h})$。\n\n令 $\\delta x = A^{-1}x$ 和 $\\delta h = A^{-1}\\mathbf{h}$。这些向量的分量是离散增量：\n令 $x_0=0$，则 $(\\delta x)_k = x_k - x_{k-1}$，$k=1,\\dots,n$。\n令 $h(t_0)=h(0)=0$，则 $(\\delta h)_k = h(t_k) - h(t_{k-1})$，$k=1,\\dots,n$。\n矩阵 $D^{-1}$ 是对角矩阵，其元素为 $(D^{-1})_{kk} = 1/\\Delta_k$。\n所以，项 $x^T \\Sigma^{-1} \\mathbf{h}$ 变为\n$$ (\\delta x)^T D^{-1} (\\delta h) = \\sum_{k=1}^n (\\delta x)_k \\frac{1}{\\Delta_k} (\\delta h)_k = \\sum_{k=1}^n \\frac{(x_k-x_{k-1})(h(t_k)-h(t_{k-1}))}{\\Delta_k} $$\n类似地，项 $\\mathbf{h}^T \\Sigma^{-1} \\mathbf{h}$ 变为\n$$ (\\delta h)^T D^{-1} (\\delta h) = \\sum_{k=1}^n (\\delta h)_k \\frac{1}{\\Delta_k} (\\delta h)_k = \\sum_{k=1}^n \\frac{(h(t_k)-h(t_{k-1}))^2}{\\Delta_k} $$\n结合这些结果，密度比由以下表达式的指数函数给出\n$$ \\sum_{k=1}^n \\frac{(x_k-x_{k-1})(h(t_k)-h(t_{k-1}))}{t_k-t_{k-1}} - \\frac{1}{2} \\sum_{k=1}^n \\frac{(h(t_k)-h(t_{k-1}))^2}{t_k-t_{k-1}} $$\n其中我们设定了 $x_0=0$ 并使用了给定条件 $h(t_0)=h(0)=0$。这个表达式是 $x=(x_1,\\dots,x_n)$ 的函数，并用指定的时间增量和函数增量来表示。", "answer": "$$\\boxed{\\exp\\left(\\sum_{k=1}^{n} \\frac{(x_k - x_{k-1})(h(t_k) - h(t_{k-1}))}{t_k - t_{k-1}} - \\frac{1}{2} \\sum_{k=1}^{n} \\frac{(h(t_k) - h(t_{k-1}))^{2}}{t_k - t_{k-1}}\\right)}$$", "id": "3000310"}, {"introduction": "本练习将展示 Cameron-Martin-Girsanov 定理作为一个强大解题工具的实际应用。您将运用一次巧妙的测度变换，将一个关于带漂移布朗运动 $X_t = \\mu t + W_t$ 的复杂问题，转化为一个关于标准布朗运动的更简单问题。这项技术使您能够推导出过程 $X_t$ 首次到达某个水平 $a$ 的时间 $\\tau_a$ 的确切概率密度函数，这一结果在金融期权定价和物理学等领域有着广泛的应用 [@problem_id:3000331]。", "problem": "设 $W = \\{W_{t}\\}_{t \\geq 0}$ 是在满足通常条件的带滤概率空间 $(\\Omega, \\mathcal{F}, \\{\\mathcal{F}_{t}\\}_{t \\geq 0}, \\mathbb{P})$ 上的标准一维布朗运动。固定一个水平 $a > 0$ 和一个漂移参数 $\\mu \\in \\mathbb{R}$。定义带漂移的过程 $X_{t} = \\mu t + W_{t}$ 及其首次到达水平 $a$ 的时间为\n$$\n\\tau_{a} = \\inf\\{t > 0 : X_{t} = a\\}。\n$$\n利用停止的指数鞅和 Cameron-Martin-Girsanov 公式（其中 Radon-Nikodym 导数在 $\\tau_{a}$ 处停止），推导 $\\tau_{a}$ 在 $(0,\\infty)$ 上的显式勒贝格密度 $f_{\\mu,a}(t)$，并将其表达为 $t$、$a$ 和 $\\mu$ 的封闭形式解析函数。你的最终答案必须是单一的解析表达式。无需四舍五入，也不涉及单位。", "solution": "我们的目标是推导首次到达时间 $\\tau_a = \\inf\\{t > 0 : X_{t} = a\\}$ 的概率密度函数 $f_{\\mu,a}(t)$，其中 $X_{t} = \\mu t + W_{t}$ 是在概率测度 $\\mathbb{P}$ 下带漂移 $\\mu$ 的布朗运动。过程 $W = \\{W_t\\}_{t \\ge 0}$ 是在 $\\mathbb{P}$ 下的标准一维布朗运动。\n\n核心策略是运用 Cameron-Martin-Girsanov (CMG) 定理，将概率测度从 $\\mathbb{P}$ 变换到一个新的测度 $\\mathbb{Q}$，在新的测度下，带漂移的过程 $X_t$ 表现为标准（无漂移）布朗运动。标准布朗运动的首次到达时间的密度是一个已知的经典结果。然后，我们可以利用连接 $\\mathbb{P}$ 和 $\\mathbb{Q}$ 的 Radon-Nikodym 导数，将这个已知的密度变换回原始测度 $\\mathbb{P}$ 下，从而得到所求的密度 $f_{\\mu,a}(t)$。\n\n第一步：应用 Cameron-Martin-Girsanov 定理\n\n在测度 $\\mathbb{P}$ 下，$X_t$ 的动态由 $dX_t = \\mu dt + dW_t$ 给出。我们希望找到一个测度 $\\mathbb{Q}$，使得 $X_t$ 在 $\\mathbb{Q}$ 下是一个标准布朗运动，这意味着它在 $\\mathbb{Q}$ 下的动态应为 $dX_t = dB_t$，其中 $B_t$ 是一个 $\\mathbb{Q}$-布朗运动。\n\n根据 CMG 定理，如果我们通过 Radon-Nikodym 导数过程 $Z_t = \\frac{d\\mathbb{Q}}{d\\mathbb{P}}\\big|_{\\mathcal{F}_t}$ 定义一个新的测度 $\\mathbb{Q}$，其中 $Z_t$ 是一个形式如下的 $\\mathbb{P}$-鞅：\n$$\nZ_t = \\exp\\left( \\int_0^t \\theta_s dW_s - \\frac{1}{2} \\int_0^t \\theta_s^2 ds \\right)\n$$\n那么过程 $\\tilde{W}_t = W_t - \\int_0^t \\theta_s ds$ 在 $\\mathbb{Q}$ 下是一个标准布朗运动。\n\n我们需要选择过程 $\\theta_s$ 使得 $X_t$ 成为一个 $\\mathbb{Q}$-布朗运动。我们可以将 $X_t$ 的动态重写为\n$$\ndX_t = (\\mu - \\theta_t)dt + (dW_t + \\theta_t dt)\n$$\n为了使 $X_t$ 在 $\\mathbb{Q}$ 下成为一个鞅，我们必须消除其漂移项。过程 $d\\tilde{W}_t = dW_t + \\theta_t dt$ 是一个 $\\mathbb{Q}$-布朗运动的增量。我们选择 $\\theta_t$ 来移除原始漂移 $\\mu$。我们选择 $\\theta_t = -\\mu$。这个选择是常数。过程 $X_t$ 可以写成 $X_t = W_t + \\mu t$。当 $\\theta_s = -\\mu$ 时，Girsanov 定理指出过程 $B_t = W_t - \\int_0^t (-\\mu) ds = W_t + \\mu t$ 在测度 $\\mathbb{Q}$ 下是一个标准布朗运动。我们看到 $B_t$ 正是我们的过程 $X_t$。因此，在由对应于 $\\theta_t = -\\mu$ 的 Radon-Nikodym 过程所定义的测度 $\\mathbb{Q}$ 下，$X_t$ 是一个标准布朗运动。\n\nRadon-Nikodym 过程 $Z_t$（它是一个指数鞅）是：\n$$\nZ_t = \\exp\\left( \\int_0^t (-\\mu) dW_s - \\frac{1}{2}\\int_0^t (-\\mu)^2 ds \\right) = \\exp\\left( -\\mu W_t - \\frac{1}{2}\\mu^2 t \\right)\n$$\n\n第二步：在新测度 $\\mathbb{Q}$ 下的到达时间密度\n\n在 $\\mathbb{Q}$ 下，$X_t$ 是一个标准布朗运动。对于标准布朗运动，首次到达水平 $a > 0$ 的时间有一个著名的概率密度函数，即莱维分布 (Lévy distribution) 的密度。设此密度为 $g_a(t)$。对于 $t \\in (0, \\infty)$，它由下式给出：\n$$\ng_a(t) = \\frac{a}{\\sqrt{2\\pi t^3}} \\exp\\left(-\\frac{a^2}{2t}\\right)\n$$\n因此，在 $\\mathbb{Q}$ 下，我们的到达时间 $\\tau_a$ 的密度是 $g_a(t)$。用符号表示，$\\mathbb{Q}(\\tau_a \\in dt) = g_a(t)dt$。\n\n第三步：将密度从 $\\mathbb{Q}$ 变换回 $\\mathbb{P}$\n\n测度之间的关系是，在 $\\mathcal{F}_t$ 上有 $d\\mathbb{Q} = Z_t d\\mathbb{P}$，等价地，有 $d\\mathbb{P} = Z_t^{-1} d\\mathbb{Q}$。\n我们关心事件 $\\{\\tau_a \\in [t, t+dt)\\}$ 的概率，这是一个 $\\mathcal{F}_{\\tau_a}$-可测事件。对于相对于停时 $\\tau$ 可测的随机变量的期望值，一般的测度变换公式表明，对于一个 $\\mathcal{F}_\\tau$-可测的随机变量 $Y$，有 $\\mathbb{E}_{\\mathbb{P}}[Y] = \\mathbb{E}_{\\mathbb{Q}}[Y Z_\\tau^{-1}]$。\n\n设 $h$ 是一个有界可测的检验函数。根据定义，$h(\\tau_a)$ 在 $\\mathbb{P}$ 下的期望为：\n$$\n\\mathbb{E}_{\\mathbb{P}}[h(\\tau_a)] = \\int_0^\\infty h(t) f_{\\mu,a}(t) dt\n$$\n使用测度变换公式：\n$$\n\\mathbb{E}_{\\mathbb{P}}[h(\\tau_a)] = \\mathbb{E}_{\\mathbb{Q}}[h(\\tau_a) Z_{\\tau_a}^{-1}]\n$$\n首先，我们求出 $Z_{\\tau_a}^{-1}$ 的显式表达式。过程 $Z_t^{-1}$ 为\n$$\nZ_t^{-1} = \\exp\\left( \\mu W_t + \\frac{1}{2}\\mu^2 t \\right)\n$$\n在停时 $\\tau_a$ 处，根据定义我们知道 $X_{\\tau_a} = a$。我们还有 $X_{\\tau_a} = \\mu \\tau_a + W_{\\tau_a}$，这意味着 $W_{\\tau_a} = a - \\mu \\tau_a$。\n将此代入 $t=\\tau_a$ 时的 $Z_t^{-1}$ 表达式中：\n$$\nZ_{\\tau_a}^{-1} = \\exp\\left( \\mu(a - \\mu \\tau_a) + \\frac{1}{2}\\mu^2 \\tau_a \\right) = \\exp\\left( \\mu a - \\mu^2 \\tau_a + \\frac{1}{2}\\mu^2 \\tau_a \\right) = \\exp\\left( \\mu a - \\frac{1}{2}\\mu^2 \\tau_a \\right)\n$$\n现在，我们将其代回 $\\mathbb{Q}$ 下的期望公式：\n$$\n\\mathbb{E}_{\\mathbb{P}}[h(\\tau_a)] = \\mathbb{E}_{\\mathbb{Q}}\\left[h(\\tau_a) \\exp\\left(\\mu a - \\frac{1}{2}\\mu^2 \\tau_a\\right)\\right]\n$$\n根据关于密度的期望定义，右边是：\n$$\n\\int_0^\\infty h(t) \\exp\\left(\\mu a - \\frac{1}{2}\\mu^2 t\\right) g_a(t) dt\n$$\n令 $\\mathbb{E}_{\\mathbb{P}}[h(\\tau_a)]$ 的两个积分表达式相等：\n$$\n\\int_0^\\infty h(t) f_{\\mu,a}(t) dt = \\int_0^\\infty h(t) \\left[ g_a(t) \\exp\\left(\\mu a - \\frac{1}{2}\\mu^2 t\\right) \\right] dt\n$$\n由于此等式对任何有界可测函数 $h(t)$ 都必须成立，所以被积函数必须几乎处处相等。因此，我们确定密度 $f_{\\mu,a}(t)$ 为：\n$$\nf_{\\mu,a}(t) = g_a(t) \\exp\\left(\\mu a - \\frac{1}{2}\\mu^2 t\\right)\n$$\n\n第四步：密度的最终表达式\n\n代入 $g_a(t)$ 的表达式：\n$$\nf_{\\mu,a}(t) = \\frac{a}{\\sqrt{2\\pi t^3}} \\exp\\left(-\\frac{a^2}{2t}\\right) \\exp\\left(\\mu a - \\frac{1}{2}\\mu^2 t\\right)\n$$\n我们可以合并指数函数的参数：\n$$\nf_{\\mu,a}(t) = \\frac{a}{\\sqrt{2\\pi t^3}} \\exp\\left(-\\frac{a^2}{2t} + \\mu a - \\frac{\\mu^2 t}{2}\\right)\n$$\n为了简化指数部分，我们将所有项通分到分母 $2t$ 上：\n$$\n-\\frac{a^2}{2t} + \\frac{2\\mu a t}{2t} - \\frac{\\mu^2 t^2}{2t} = -\\frac{a^2 - 2\\mu a t + \\mu^2 t^2}{2t} = -\\frac{(a - \\mu t)^2}{2t}\n$$\n因此，$\\tau_a$ 在 $(0, \\infty)$ 上的勒贝格密度的最终表达式为：\n$$\nf_{\\mu,a}(t) = \\frac{a}{\\sqrt{2\\pi t^3}} \\exp\\left(-\\frac{(a-\\mu t)^2}{2t}\\right)\n$$\n这是参数为 $\\lambda = a^2$ 和 $\\nu = a/\\mu > 0$ 的逆高斯分布的概率密度函数。此推导对任何 $\\mu \\in \\mathbb{R}$ 都成立。", "answer": "$$\\boxed{\\frac{a}{\\sqrt{2\\pi t^{3}}} \\exp\\left(-\\frac{(a-\\mu t)^{2}}{2t}\\right)}$$", "id": "3000331"}]}