{"hands_on_practices": [{"introduction": "几何布朗运动（Geometric Brownian Motion, GBM）是金融数学中模拟资产价格（如股票）随时间演变的基础模型。这个练习将指导你解决一个核心问题：计算资产价格首次达到某个预设屏障水平的穿时（hitting time）的拉普拉斯变换。通过这个过程，你将掌握如何应用无穷小生成元（infinitesimal generator）将随机过程问题转化为一个常微分方程（ordinary differential equation, ODE）并求解，这是解决随机微分方程（SDE）相关问题的一项强大而基本的技术。[@problem_id:2978871]", "problem": "考虑一个严格为正的资产价格过程 $\\{S_t\\}_{t \\geq 0}$，其演化为几何布朗运动，随机微分方程为 $dS_t = \\mu S_t \\, dt + \\sigma S_t \\, dW_t$，其中 $\\mu \\in \\mathbb{R}$，$\\sigma > 0$，且 $\\{W_t\\}_{t \\geq 0}$ 是一个标准布朗运动（维纳过程）。固定一个上边界水平 $H > 0$ 和一个初始水平 $S_0 \\in (0,H)$。将首次到达该边界的时间定义为 $\\tau_H = \\inf\\{ t \\geq 0 : S_t = H \\}$，并约定 $\\inf \\emptyset = +\\infty$。对于给定的拉普拉斯参数 $\\lambda \\geq 0$，定义 $L(\\lambda) = \\mathbb{E}\\!\\left[ \\exp(-\\lambda \\tau_H) \\right]$，其中期望是相对于从 $S_0$ 开始的 $\\{S_t\\}_{t \\geq 0}$ 过程的定律计算的。\n\n从扩散过程的第一性原理（包括伊藤引理、扩散过程的无穷小生成元、以及首达时间拉普拉斯变换的边值问题）出发，推导 $L(\\lambda)$ 关于 $S_0$、$H$、$\\mu$、$\\sigma$ 和 $\\lambda$ 的闭式表达式。你的推导必须明确指出适当的边界条件，并根据对数变换下 $S=0$ 处边界的分类来证明这些条件的合理性。请将你的最终答案以单一解析表达式的形式给出。不需要进行数值近似，也没有舍入指令。最终答案必须是一个不带单位的单一表达式。", "solution": "该问题要求计算几何布朗运动（GBM）首次到达上边界 $H$ 的时间的拉普拉斯变换。设资产价格过程为 $\\{S_t\\}_{t \\geq 0}$，从 $S_0 \\in (0, H)$ 开始，遵循以下随机微分方程（SDE）：\n$$ dS_t = \\mu S_t \\, dt + \\sigma S_t \\, dW_t $$\n其中 $\\mu \\in \\mathbb{R}$，$\\sigma > 0$，且 $\\{W_t\\}_{t \\geq 0}$ 是一个标准维纳过程。首次到达边界 $H$ 的时间为 $\\tau_H = \\inf\\{ t \\geq 0 : S_t = H \\}$。我们寻求找到函数 $L(\\lambda) = \\mathbb{E}[\\exp(-\\lambda \\tau_H)]$，其中拉普拉斯参数 $\\lambda \\geq 0$。\n\n我们定义一个函数 $u(s)$ 来表示所求的期望，条件是过程从 $S_0 = s$ 开始：\n$$ u(s) = \\mathbb{E}_s[\\exp(-\\lambda \\tau_H)] $$\n其中 $\\mathbb{E}_s[\\cdot] = \\mathbb{E}[\\cdot | S_0=s]$。我们的目标是确定 $u(S_0)$。\n\n根据扩散过程理论的一个标准结果，函数 $u(s)$ 满足一个二阶常微分方程（ODE）。对于一个一般的一维伊藤扩散 $dX_t = a(X_t) dt + b(X_t) dW_t$，函数 $u(x) = \\mathbb{E}_x[\\exp(-\\lambda \\tau_b)]$（表示到达边界 $b$ 的时间）在感兴趣的定义域上满足方程 $(\\mathcal{A} - \\lambda)u(x) = 0$，其中 $\\mathcal{A}$ 是该过程的无穷小生成元。\n\n作用于一个二阶可微函数 $f(x)$ 上的无穷小生成元 $\\mathcal{A}$ 由下式给出：\n$$ \\mathcal{A}f(x) = a(x)f'(x) + \\frac{1}{2}b(x)^2 f''(x) $$\n对于 GBM 过程 $S_t$，其漂移系数和扩散系数分别为 $a(s) = \\mu s$ 和 $b(s) = \\sigma s$。因此，生成元 $\\mathcal{A}$ 为：\n$$ \\mathcal{A}f(s) = \\mu s f'(s) + \\frac{1}{2}(\\sigma s)^2 f''(s) = \\mu s f'(s) + \\frac{1}{2}\\sigma^2 s^2 f''(s) $$\n函数 $u(s)$ 必须在 $s \\in (0, H)$ 上求解 ODE $(\\mathcal{A} - \\lambda)u(s) = 0$。代入生成元，我们得到：\n$$ \\frac{1}{2}\\sigma^2 s^2 u''(s) + \\mu s u'(s) - \\lambda u(s) = 0 $$\n这是一个二阶线性齐次欧拉-柯西型常微分方程。我们寻求形式为 $u(s) = s^k$ 的解。将其代入 ODE，得到关于指数 $k$ 的特征方程：\n$$ \\frac{1}{2}\\sigma^2 k(k-1)s^k + \\mu k s^k - \\lambda s^k = 0 $$\n$$ s^k \\left( \\frac{1}{2}\\sigma^2 k^2 - \\frac{1}{2}\\sigma^2 k + \\mu k - \\lambda \\right) = 0 $$\n为使此式对所有 $s \\in (0,H)$ 成立，关于 $k$ 的多项式必须为零：\n$$ \\frac{1}{2}\\sigma^2 k^2 + \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) k - \\lambda = 0 $$\n这是一个关于 $k$ 的二次方程。其根由二次方程求根公式给出：\n$$ k = \\frac{-\\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\pm \\sqrt{\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)^2 - 4\\left(\\frac{1}{2}\\sigma^2\\right)(-\\lambda)}}{2\\left(\\frac{1}{2}\\sigma^2\\right)} $$\n$$ k = \\frac{-\\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\pm \\sqrt{\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)^2 + 2\\lambda\\sigma^2}}{\\sigma^2} $$\n我们用 $k_+$ 和 $k_-$ 表示这两个根：\n$$ k_+ = \\frac{-\\left(\\mu - \\frac{1}{2}\\sigma^2\\right) + \\sqrt{\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)^2 + 2\\lambda\\sigma^2}}{\\sigma^2} $$\n$$ k_- = \\frac{-\\left(\\mu - \\frac{1}{2}\\sigma^2\\right) - \\sqrt{\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)^2 + 2\\lambda\\sigma^2}}{\\sigma^2} $$\n对于 $\\lambda > 0$，判别式严格为正，因此根是实数且不相等。此外，由于 $\\sqrt{\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)^2 + 2\\lambda\\sigma^2} > \\left|\\mu - \\frac{1}{2}\\sigma^2\\right|$，显然有 $k_+ > 0$ 和 $k_- < 0$。该 ODE 的通解是两个基本解的线性组合：\n$$ u(s) = C_1 s^{k_+} + C_2 s^{k_-} $$\n为了确定常数 $C_1$ 和 $C_2$，我们必须指定两个边界条件。\n\n第一个边界条件在目标水平 $s=H$ 处。如果过程从 $S_0=H$ 开始，则首达时间为 $\\tau_H=0$。因此，$u(H) = \\mathbb{E}_H[\\exp(-\\lambda \\cdot 0)] = \\exp(0) = 1$。\n$$ C_1 H^{k_+} + C_2 H^{k_-} = 1 $$\n\n第二个边界条件来自过程在 $s=0$ 附近的行为。问题陈述要求我们通过对 $s=0$ 处的边界进行分类来证明此条件的合理性。为此，我们可以分析变换后的过程 $X_t = \\ln(S_t)$。对 $f(s) = \\ln(s)$ 使用伊藤引理，我们得到 $X_t$ 的 SDE：\n$$ dX_t = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)dt + \\sigma dW_t $$\n这是一个漂移为常数 $\\nu = \\mu - \\frac{1}{2}\\sigma^2$、波动率为常数 $\\sigma$ 的算术布朗运动。$S_t$ 的边界 $s=0$ 对应于 $X_t$ 的边界 $x \\to -\\infty$。一维扩散边界的标准分类表明，$s=0$ 处的边界从状态空间 $(0, \\infty)$ 的内部在有限时间内是不可达的。这意味着对于任何起点 $s > 0$，过程在有限时间内到达 $s=0$ 的概率为零。此边界被分类为“出射”边界（若 $\\nu > 0$）或“自然”边界（若 $\\nu \\le 0$）。无论哪种情况，它都不是一个需要施加特定条件（如 $u(0)=0$ 或 $u'(0)=0$）的吸收边界或反射边界。\n\n相反，解 $u(s)$ 受一个一般正则性条件的约束：由于 $u(s)$ 表示 $\\exp(-\\lambda \\tau_H)$ 的期望，而这是一个介于 $0$ 和 $1$ 之间的随机变量，所以函数 $u(s)$ 对于所有 $s \\in (0, H]$ 都必须是有界的。也就是说，我们需要 $\\lim_{s \\to 0^+} |u(s)| < \\infty$。\n我们来考察通解 $u(s) = C_1 s^{k_+} + C_2 s^{k_-}$ 在 $s \\to 0^+$ 时的行为。\n由于 $k_+ > 0$，项 $s^{k_+}$ 趋近于 $0$。\n由于 $k_- < 0$，项 $s^{k_-}$ 趋近于 $+\\infty$。\n为了使 $u(s)$ 在 $s \\to 0^+$ 时保持有界，无界项的系数必须为零。这强制要求条件 $C_2 = 0$。\n\n当 $C_2=0$ 时，解简化为：\n$$ u(s) = C_1 s^{k_+} $$\n现在我们应用第一个边界条件 $u(H)=1$：\n$$ C_1 H^{k_+} = 1 \\implies C_1 = H^{-k_+} $$\n将 $C_1$ 的值代回，我们找到了唯一的有界解：\n$$ u(s) = (H^{-k_+}) s^{k_+} = \\left(\\frac{s}{H}\\right)^{k_+} $$\n最后，我们在初始状态 $S_0$ 处计算此函数的值：\n$$ L(\\lambda) = u(S_0) = \\left(\\frac{S_0}{H}\\right)^{k_+} $$\n代入 $k_+$ 的完整表达式，我们得到闭式解：\n$$ L(\\lambda) = \\left(\\frac{S_0}{H}\\right)^{\\frac{-\\left(\\mu - \\frac{1}{2}\\sigma^2\\right) + \\sqrt{\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)^2 + 2\\lambda\\sigma^2}}{\\sigma^2}} $$\n此表达式即为给定参数下首达时间 $\\tau_H$ 的拉普拉斯变换。", "answer": "$$\\boxed{\\left(\\frac{S_0}{H}\\right)^{\\frac{-\\left(\\mu - \\frac{1}{2}\\sigma^2\\right) + \\sqrt{\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)^2 + 2\\lambda\\sigma^2}}{\\sigma^2}}}$$", "id": "2978871"}, {"introduction": "在许多实际应用中，我们关心的边界并非静止不变，而是随时间移动的。这个练习旨在挑战你处理一个带有线性移动边界的首达时间（first passage time）问题。直接求解看似棘手，但本题将引导你通过一个巧妙的坐标变换，将原问题转化为一个等价的、但更易于处理的固定边界问题，并最终运用鞅（martingale）和可选停止定理（Optional Stopping Theorem）优雅地得出解。这个练习充分展示了在解决随机过程问题时，变换视角和运用鞅工具的威力。[@problem_id:2978878]", "problem": "考虑由随机微分方程 (SDE) 定义的一维伊藤过程\n$$\ndX_t \\;=\\; \\mu\\,dt \\;+\\; \\sigma\\,dW_t,\\qquad X_0 \\;=\\; 0,\n$$\n其中 $W_t$ 是标准布朗运动，$\\mu\\in\\mathbb{R}$ 和 $\\sigma>0$ 是常数。设移动边界为线性函数\n$$\nb(t)\\;=\\; a \\;+\\; c\\,t,\n$$\n参数 $a>0$ 且 $c\\in\\mathbb{R}$。定义首次穿越时间\n$$\n\\tau \\;=\\; \\inf\\{\\, t\\ge 0 \\,:\\, X_t \\;=\\; b(t)\\,\\}.\n$$\n对于一个固定参数 $\\lambda\\ge 0$，从第一性原理推导有瑕首次穿越时间的拉普拉斯变换的一个显式、完全简化的解析表达式，\n$$\n\\Phi(\\lambda) \\;=\\; \\mathbb{E}\\!\\left[\\,\\exp(-\\lambda\\,\\tau)\\,\\mathbf{1}_{\\{\\tau<\\infty\\}}\\,\\right],\n$$\n该表达式仅用参数 $a$、$c$、$\\mu$、$\\sigma$ 和 $\\lambda$ 表示。您的最终答案必须是单一的封闭形式表达式。不需要进行数值舍入。", "solution": "该问题要求解一个带漂移的布朗运动到达一个移动线性边界的首次穿越时间的拉普拉斯变换。设随机过程由伊藤随机微分方程（SDE）定义：\n$$\ndX_t = \\mu\\,dt + \\sigma\\,dW_t, \\quad X_0 = 0\n$$\n其中 $\\mu \\in \\mathbb{R}$、$\\sigma > 0$ 是常数，而 $W_t$ 是标准维纳过程。移动边界由 $b(t) = a + ct$ 给出，其中 $a > 0$ 且 $c \\in \\mathbb{R}$。首次穿越时间 $\\tau$ 定义为：\n$$\n\\tau = \\inf\\{ t \\ge 0 : X_t = b(t) \\}\n$$\n我们寻求找到 $\\Phi(\\lambda) = \\mathbb{E}[\\exp(-\\lambda\\,\\tau)\\,\\mathbf{1}_{\\{\\tau<\\infty\\}}]$，对于 $\\lambda \\ge 0$。\n\n一个过程触及移动边界的问题，可以通过将其转换为一个相关过程触及固定边界的问题来简化。让我们定义一个新过程 $Y_t$，作为原过程 $X_t$ 与边界 $b(t)$ 之差：\n$$\nY_t = X_t - b(t) = X_t - (a + ct)\n$$\n这个新过程的初始条件是 $Y_0 = X_0 - b(0) = 0 - a = -a$。\n首次穿越事件 $X_t = b(t)$ 等价于 $Y_t = 0$。因此，首次穿越时间可以用 $Y_t$ 重新定义：\n$$\n\\tau = \\inf\\{ t \\ge 0 : Y_t = 0 \\}\n$$\n我们使用伊藤引理来推导 $Y_t$ 的 SDE。由于 $b(t)$ 是一个具有连续一阶导数的时间确定性函数，我们可以将其微分写为 $db(t) = c\\,dt$。因此，$Y_t$ 的微分是：\n$$\ndY_t = dX_t - d(a+ct) = (\\mu\\,dt + \\sigma\\,dW_t) - c\\,dt = (\\mu-c)\\,dt + \\sigma\\,dW_t\n$$\n这表明 $Y_t$ 也是一个布朗运动，其常数漂移为 $\\mu' = \\mu-c$，扩散系数与之前相同为 $\\sigma$。问题现在简化为求解过程 $Y_t$ 从 $Y_0 = -a < 0$ 开始首次达到水平 $0$ 的时间的拉普拉斯变换。\n\n我们将使用鞅方法来解决这个问题。让我们构造一个形式为 $M_t = \\exp(\\theta Y_t - f(t))$ 的过程 $M_t$，其中 $\\theta$ 是某个常数，而 $f(t)$ 是一个待定的确定性函数。要使 $M_t$ 成为一个鞅，其漂移项必须为零。设 $g(y,t) = \\exp(\\theta y - f(t))$。我们将伊藤引理应用于 $g(Y_t, t)$：\n$$\ndg(Y_t, t) = \\frac{\\partial g}{\\partial t}dt + \\frac{\\partial g}{\\partial y}dY_t + \\frac{1}{2}\\frac{\\partial^2 g}{\\partial y^2}(dY_t)^2\n$$\n偏导数是：\n$$\n\\frac{\\partial g}{\\partial t} = -f'(t)g(y,t), \\quad \\frac{\\partial g}{\\partial y} = \\theta g(y,t), \\quad \\frac{\\partial^2 g}{\\partial y^2} = \\theta^2 g(y,t)\n$$\n$Y_t$ 的二次变分是 $(dY_t)^2 = ((\\mu-c)dt + \\sigma dW_t)^2 = \\sigma^2 dt$。将这些代入伊藤公式，我们得到：\n$$\ndM_t = \\left(-f'(t) + (\\mu-c)\\theta + \\frac{1}{2}\\sigma^2\\theta^2\\right)M_t\\,dt + \\theta\\sigma M_t\\,dW_t\n$$\n要使 $M_t$ 成为鞅，漂移项（$dt$ 项）必须为零。\n$$\n-f'(t) + (\\mu-c)\\theta + \\frac{1}{2}\\sigma^2\\theta^2 = 0 \\implies f'(t) = (\\mu-c)\\theta + \\frac{1}{2}\\sigma^2\\theta^2\n$$\n我们想要找到拉普拉斯变换，其中包含 $\\exp(-\\lambda \\tau)$。这提示我们选择 $f(t)$ 以获得此项。我们设 $f(t) = \\lambda t$。那么 $f'(t) = \\lambda$。这对参数 $\\theta$ 施加了一个条件：\n$$\n\\lambda = (\\mu-c)\\theta + \\frac{1}{2}\\sigma^2\\theta^2\n$$\n这是一个关于 $\\theta$ 的二次方程：\n$$\n\\frac{1}{2}\\sigma^2\\theta^2 + (\\mu-c)\\theta - \\lambda = 0\n$$\n使用二次公式求解 $\\theta$：\n$$\n\\theta = \\frac{-(\\mu-c) \\pm \\sqrt{(\\mu-c)^2 - 4(\\frac{1}{2}\\sigma^2)(-\\lambda)}}{\\sigma^2} = \\frac{-(\\mu-c) \\pm \\sqrt{(\\mu-c)^2 + 2\\sigma^2\\lambda}}{\\sigma^2}\n$$\n让我们将两个根记为 $\\theta_1$ 和 $\\theta_2$。\n由于 $\\lambda \\ge 0$ 且 $\\sigma > 0$，我们有 $\\sqrt{(\\mu-c)^2 + 2\\sigma^2\\lambda} \\ge \\sqrt{(\\mu-c)^2} = |\\mu-c|$。\n这意味着一个根是正的，另一个是负的（或者如果 $\\lambda=0$ 且 $\\mu-c \\ge 0$，则一个根为零）。我们选择正根，记为 $\\theta_+$：\n$$\n\\theta_+ = \\frac{-(\\mu-c) + \\sqrt{(\\mu-c)^2 + 2\\sigma^2\\lambda}}{\\sigma^2} \\ge 0\n$$\n通过选择 $\\theta = \\theta_+$，过程 $M_t = \\exp(\\theta_+ Y_t - \\lambda t)$ 是一个鞅。\n\n我们现在可以应用任意停止定理 (OST)。该定理指出，对于一个停时 $\\tau$ 和一个鞅 $M_t$，在特定条件下，$\\mathbb{E}[M_{\\tau}] = M_0$。对于我们的目的，一个充分条件是停止过程 $M_{t \\wedge \\tau}$ 是有界的。\n在我们的例子中，对于任何 $t < \\tau$，过程 $Y_t$ 都在边界 $0$ 以下，所以 $Y_t < 0$。由于我们选择了 $\\theta_+ \\ge 0$，项 $\\theta_+ Y_t \\le 0$。同样，由于 $\\lambda \\ge 0$，项 $-\\lambda t \\le 0$。\n我们停止的鞅的值是 $M_{t \\wedge \\tau} = \\exp(\\theta_+ Y_{t \\wedge \\tau} - \\lambda(t \\wedge \\tau))$。\n由于 $Y_{t \\wedge \\tau} \\le 0$ 且 $\\lambda(t \\wedge \\tau) \\ge 0$，我们有 $\\exp(\\theta_+ Y_{t \\wedge \\tau}) \\le 1$ 和 $\\exp(-\\lambda(t \\wedge \\tau)) \\le 1$。因此，$0 < M_{t \\wedge \\tau} \\le 1$。停止的鞅是有界的。\n根据控制收敛定理（作为有界性的一个推论），我们可以应用任意停止定理（OST）得到：\n$$\n\\mathbb{E}[M_\\tau] = M_0\n$$\n初始值为 $M_0 = \\exp(\\theta_+ Y_0 - \\lambda \\cdot 0) = \\exp(\\theta_+ (-a)) = \\exp(-a\\theta_+)$。\n在停时 $\\tau$ 的值需要在集合 $\\{\\tau < \\infty\\}$ 和 $\\{\\tau = \\infty\\}$ 上考虑。\n在集合 $\\{\\tau < \\infty\\}$ 上，我们有 $Y_\\tau = 0$，所以 $M_\\tau = \\exp(\\theta_+ \\cdot 0 - \\lambda \\tau) = \\exp(-\\lambda \\tau)$。\n在集合 $\\{\\tau = \\infty\\}$ 上，过程 $Y_t$ 永远不会达到 $0$。在这种情况下，对所有 $t$ 都有 $Y_t < 0$。该鞅的极限是 $M_\\infty = \\lim_{t\\to\\infty} \\exp(\\theta_+ Y_t - \\lambda t)$。\n如果 $\\lambda > 0$，项 $\\exp(-\\lambda t) \\to 0$。由于 $\\exp(\\theta_+ Y_t) \\le 1$，极限 $M_\\infty = 0$。\n如果 $\\lambda = 0$，情况会更复杂。然而，$M_{t \\wedge \\tau}$ 的有界性允许我们使用一个版本的OST，得到 $\\mathbb{E}[M_\\tau \\mathbf{1}_{\\{\\tau < \\infty\\}}] = M_0 - \\mathbb{E}[M_\\infty \\mathbf{1}_{\\{\\tau = \\infty\\}}]$。由于在 $\\{\\tau=\\infty\\}$ 上几乎必然有 $M_\\infty=0$（要么因为 $\\lambda>0$，要么因为当漂移为非正时 $Y_t \\to -\\infty$），这一项消失了。\n所以我们有：\n$$\n\\mathbb{E}[M_\\tau \\mathbf{1}_{\\{\\tau < \\infty\\}}] = \\mathbb{E}[\\exp(-\\lambda \\tau) \\mathbf{1}_{\\{\\tau < \\infty\\}}] = \\Phi(\\lambda)\n$$\n令期望相等：\n$$\n\\Phi(\\lambda) = M_0 = \\exp(-a\\theta_+)\n$$\n代入 $\\theta_+$ 的表达式：\n$$\n\\Phi(\\lambda) = \\exp\\left(-a \\left(\\frac{-(\\mu-c) + \\sqrt{(\\mu-c)^2 + 2\\sigma^2\\lambda}}{\\sigma^2}\\right)\\right)\n$$\n这可以简化为：\n$$\n\\Phi(\\lambda) = \\exp\\left(\\frac{a(\\mu-c)}{\\sigma^2} - \\frac{a\\sqrt{(\\mu-c)^2 + 2\\sigma^2\\lambda}}{\\sigma^2}\\right)\n$$\n这就是我们所求的首次穿越时间的拉普拉斯变换的显式、完全简化的解析表达式。\n最终表达式可以写成：\n$$\n\\Phi(\\lambda) = \\exp\\left( \\frac{a}{\\sigma^2} \\left( \\mu-c - \\sqrt{(\\mu-c)^2 + 2\\sigma^2\\lambda} \\right) \\right)\n$$", "answer": "$$\\boxed{\\exp\\left( \\frac{a}{\\sigma^2} \\left( \\mu-c - \\sqrt{(\\mu-c)^2 + 2\\sigma^2\\lambda} \\right) \\right)}$$", "id": "2978878"}, {"introduction": "首达时间问题不仅限于一维空间，在物理学、化学和种群生态学等领域，理解多维空间中的随机运动同样至关重要。本练习将先前的讨论从一维推广到 $d$ 维空间，要求你推导一个多维布朗运动首次碰到一个超球面边界的穿时分布的拉普拉斯变换。你将学习如何利用问题的对称性，将一个偏微分方程（partial differential equation, PDE）简化为径向的常微分方程，并最终借助特殊函数——在这种情况下是修正的 Bessel 函数（modified Bessel functions）——来获得精确解。这个过程凸显了从一维到高维的推广思路，以及数学工具在解决复杂物理模型中的普遍适用性。[@problem_id:2978840]", "problem": "考虑一个在 $\\mathbb{R}^{d}$ 上的 $d$ 维标准布朗运动 $B_{t}$（其中 $d \\geq 2$），它从点 $x \\in \\mathbb{R}^{d}$ 出发，满足 $|x| = r$ 且 $0 < r < R$。令 $\\tau_{R} = \\inf\\{ t \\geq 0 : |B_{t}| = R \\}$ 表示首次击中以原点为中心、半径为 $R$ 的球面的时间。对于一个固定的 $\\lambda > 0$，将击中时的拉普拉斯变换定义为\n$$\n\\phi_{\\lambda}(x) = \\mathbb{E}_{x}\\big[\\exp(-\\lambda \\tau_{R})\\big].\n$$\n请仅使用适用于随机微分方程的基本原理——即布朗运动的马尔可夫性质、$B_{t}$ 的无穷小生成元为 $(1/2)\\Delta$ 的生成元刻画，以及 Feynman–Kac 表示或 Dynkin 公式——推导出 $\\phi_{\\lambda}(x)$ 关于 $r$, $R$, $d$ 和 $\\lambda$ 的显式闭式表达式。你的推导必须从这些原理出发，建立相应的边值问题，通过球对称性将其简化为一个径向常微分方程，并使用标准特殊函数精确求解。将最终答案表示为单个解析表达式。不需要进行数值近似。", "solution": "所述问题具有科学依据、是适定且客观的。这是随机微分方程理论中一个关于布朗运动首过时的标准问题。所有提供的信息都是自洽且一致的。因此，该问题是有效的，我们进行完整推导。\n\n设 $B_t$ 为一个从 $B_0 = x$ 出发的 $d$ 维标准布朗运动，其中 $|x|=r$ 且 $0 < r < R$。我们需要求解函数 $\\phi_{\\lambda}(x) = \\mathbb{E}_{x}[\\exp(-\\lambda \\tau_{R})]$，其中 $\\tau_{R} = \\inf\\{ t \\geq 0 : |B_{t}| = R \\}$ 是该过程首次击中以原点为中心、半径为 $R > 0$ 的球面的时间，$\\lambda > 0$ 是一个常数。\n\n推导基于 Feynman–Kac 表示。对于一个由无穷小生成元 $\\mathcal{A}$ 控制的随机过程，函数 $u(x) = \\mathbb{E}_{x}[\\exp(-\\lambda \\tau_D) g(B_{\\tau_D})]$（其中 $\\tau_D$ 是首次离开区域 $D$ 的时间）满足偏微分方程（PDE）\n$$\n(\\mathcal{A} - \\lambda)u(x) = 0 \\quad \\text{for } x \\in D\n$$\n及其边界条件 $u(x) = g(x)$（对于 $x \\in \\partial D$）。\n\n在本问题中，过程是标准布朗运动 $B_t$，其无穷小生成元为 $\\mathcal{A} = \\frac{1}{2}\\Delta$，其中 $\\Delta$ 是拉普拉斯算子。区域是开球 $D = \\{y \\in \\mathbb{R}^d : |y| < R\\}$。离开时间 $\\tau_D$ 正是我们的击中时 $\\tau_R$。我们正在计算形如 $\\mathbb{E}_{x}[\\exp(-\\lambda \\tau_R)]$ 的期望，这对应于将边界 $\\partial D = \\{y \\in \\mathbb{R}^d : |y| = R\\}$ 上的所有 $y$ 的边界函数设为 $g(y) = 1$。\n因此，函数 $\\phi_{\\lambda}(x)$ 必须满足以下边值问题：\n$$\n\\frac{1}{2}\\Delta\\phi_{\\lambda}(x) - \\lambda\\phi_{\\lambda}(x) = 0, \\quad \\text{for } |x| < R\n$$\n$$\n\\phi_{\\lambda}(x) = 1, \\quad \\text{for } |x| = R\n$$\n\n区域、算子 $\\Delta$ 以及边界条件都是球对称的。这意味着解 $\\phi_{\\lambda}(x)$ 也必须是球对称的。也就是说，$\\phi_{\\lambda}(x)$ 仅依赖于径向距离 $s = |x|$。我们用 $f(s)$ 表示这个径向函数，即 $\\phi_{\\lambda}(x) = f(|x|)$。在 $d$ 维空间中，径向函数 $f(s)$ 的拉普拉斯算子由下式给出\n$$\n\\Delta f(s) = f''(s) + \\frac{d-1}{s}f'(s)\n$$\n将此代入我们的偏微分方程，我们得到关于 $f(s)$ 在 $s \\in (0, R)$ 上的一个常微分方程 (ODE)：\n$$\n\\frac{1}{2}\\left(f''(s) + \\frac{d-1}{s}f'(s)\\right) - \\lambda f(s) = 0\n$$\n方程两边乘以 $2s^2$，我们将其重新整理成一个更标准的形式：\n$$\ns^2 f''(s) + (d-1)s f'(s) - 2\\lambda s^2 f(s) = 0\n$$\n这是修正的贝塞尔微分方程的一种形式。其通解可以用修正的贝塞尔函数表示。我们设贝塞尔函数的阶为 $\\nu = \\frac{d}{2} - 1$。由于 $d \\geq 2$，我们有 $\\nu \\geq 0$。此常微分方程的通解形式如下：\n$$\nf(s) = s^{1 - d/2} \\left( C_1 I_{\\nu}(\\sqrt{2\\lambda} s) + C_2 K_{\\nu}(\\sqrt{2\\lambda} s) \\right)\n$$\n其中 $I_{\\nu}$ 和 $K_{\\nu}$ 分别是阶为 $\\nu = \\frac{d-2}{2}$ 的第一类和第二类修正贝塞尔函数，$C_1, C_2$ 是待由边界条件确定的常数。\n\n我们有两个边界条件。首先是在半径为 $R$ 的球面上的边界条件 $f(R)=1$。第二个条件是隐含的：解必须在整个区域内（包括原点 $s=0$）是正则的（有界的）。我们必须分析当 $s \\to 0^{+}$ 时解的行为。\n当宗量 $z \\to 0$ 时，贝塞尔函数的渐进行为如下：\n- 对于 $\\nu > 0$：$I_\\nu(z) \\sim \\frac{1}{\\Gamma(\\nu+1)}\\left(\\frac{z}{2}\\right)^\\nu$ 且 $K_\\nu(z) \\sim \\frac{\\Gamma(\\nu)}{2}\\left(\\frac{2}{z}\\right)^\\nu$。\n- 对于 $\\nu = 0$ (即, $d=2$)：$I_0(z) \\to 1$ 且 $K_0(z) \\sim -\\ln(z)$。\n\n让我们分析当 $s \\to 0^{+}$ 时我们通解 $f(s)$ 中的两项：\n第一项的行为如下：\n$$\ns^{1-d/2} I_{\\frac{d-2}{2}}(\\sqrt{2\\lambda} s) = s^{-\\nu} I_{\\nu}(\\sqrt{2\\lambda} s) \\sim s^{-\\nu} \\cdot \\frac{1}{\\Gamma(\\nu+1)}\\left(\\frac{\\sqrt{2\\lambda}s}{2}\\right)^\\nu \\propto s^{-\\nu} s^\\nu = s^0\n$$\n当 $s \\to 0^{+}$ 时，此项趋于一个有限常数。\n第二项的行为如下：\n$$\ns^{1-d/2} K_{\\frac{d-2}{2}}(\\sqrt{2\\lambda} s) = s^{-\\nu} K_{\\nu}(\\sqrt{2\\lambda} s)\n$$\n如果 $d>2$ (因此 $\\nu>0$)，此项的行为类似于 $s^{-\\nu} \\cdot \\left(\\frac{1}{s}\\right)^\\nu \\propto s^{-2\\nu} = s^{-(d-2)} = s^{2-d}$。由于 $d>2$，指数 $2-d$ 是负的，所以当 $s \\to 0^{+}$ 时此项发散。\n如果 $d=2$ (因此 $\\nu=0$)，此项是 $K_0(\\sqrt{2\\lambda}s)$，它在 $s \\to 0^{+}$ 时对数发散。\n在所有 $d \\geq 2$ 的情况下，包含 $K_{\\nu}$ 的项在原点是奇异的。为了使 $\\phi_{\\lambda}(x)$ 成为一个有效的物理量（一个必须是有限的期望值），解必须处处有界。因此，我们必须设 $C_2 = 0$。\n\n解必须具有以下形式：\n$$\nf(s) = C_1 s^{1-d/2} I_{\\frac{d-2}{2}}(\\sqrt{2\\lambda} s)\n$$\n现在我们应用在 $s=R$ 处的显式边界条件：$f(R)=1$。\n$$\n1 = C_1 R^{1-d/2} I_{\\frac{d-2}{2}}(\\sqrt{2\\lambda} R)\n$$\n解出 $C_1$:\n$$\nC_1 = \\frac{R^{d/2-1}}{I_{\\frac{d-2}{2}}(\\sqrt{2\\lambda} R)}\n$$\n将其代回 $f(s)$ 的表达式，我们得到完整的解：\n$$\nf(s) = \\frac{R^{d/2-1}}{I_{\\frac{d-2}{2}}(\\sqrt{2\\lambda} R)} s^{1-d/2} I_{\\frac{d-2}{2}}(\\sqrt{2\\lambda} s)\n$$\n这可以改写为：\n$$\nf(s) = \\left(\\frac{s}{R}\\right)^{1-d/2} \\frac{I_{\\frac{d-2}{2}}(\\sqrt{2\\lambda} s)}{I_{\\frac{d-2}{2}}(\\sqrt{2\\lambda} R)}\n$$\n问题要求解出在起始点为 $|x|=r$ 的 $x$ 处的 $\\phi_{\\lambda}(x)$。这对应于将我们的解 $f(s)$ 在 $s=r$ 处求值。\n$$\n\\phi_{\\lambda}(x) = f(r) =  \\left(\\frac{r}{R}\\right)^{\\frac{2-d}{2}} \\frac{I_{\\frac{d-2}{2}}(r\\sqrt{2\\lambda})}{I_{\\frac{d-2}{2}}(R\\sqrt{2\\lambda})}\n$$\n这就得到了所要求的击中时拉普拉斯变换的显式闭式表达式。", "answer": "$$\n\\boxed{\\left(\\frac{r}{R}\\right)^{\\frac{2-d}{2}} \\frac{I_{\\frac{d-2}{2}}(r\\sqrt{2\\lambda})}{I_{\\frac{d-2}{2}}(R\\sqrt{2\\lambda})}}\n$$", "id": "2978840"}]}