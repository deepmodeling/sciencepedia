{"hands_on_practices": [{"introduction": "我们从一个基础但极具启发性的例子开始：一维带漂移的布朗运动。这个练习将帮助你巩固一项核心技能：如何通过随机过程的无穷小生成元，将一个关于首出时间和触碰概率的概率论问题，转化为一个可解的常微分方程（ODE）边值问题。通过求解这些方程，我们将得到精确的解析表达式，并在此过程中理解标度函数（scale function）和速度测度（speed measure）在一维扩散过程分析中的关键作用 [@problem_id:2974721]。", "problem": "设 $\\{W_t\\}_{t \\ge 0}$ 为标准一维布朗运动，且设 $\\{X_t\\}_{t \\ge 0}$ 为随机微分方程 $dX_t = \\mu \\, dt + dW_t$ 的解，其中 $\\mu \\in \\mathbb{R}$ 为常数漂移参数。固定实数 $a < x < b$，定义首次到达时间 $\\tau_a := \\inf\\{t \\ge 0 : X_t = a\\}$ 和 $\\tau_b := \\inf\\{t \\ge 0 : X_t = b\\}$，以及从开区间 $(a,b)$ 的首次离开时间 $\\tau_{(a,b)} := \\inf\\{t \\ge 0 : X_t \\notin (a,b)\\}$。用 $\\mathbb{P}_x$ 和 $\\mathbb{E}_x$ 表示该过程从 $X_0 = x$ 开始的概率和期望。\n\n从该扩散过程的生成元和 Dynkin 公式出发，推导刻画边界到达概率 $h(x) := \\mathbb{P}_x(\\tau_b < \\tau_a)$ 和期望离开时间 $u(x) := \\mathbb{E}_x[\\tau_{(a,b)}]$ 的边值问题，并在相应的边界条件下显式地求解这些问题。在推导过程中，使用与此扩散过程相关的标度函数 $s(x) = \\int^{x} \\exp(-2 \\mu y) \\, dy$ 和速度测度 $m(dx) = 2 \\exp(2 \\mu x) \\, dx$，以建立与一维扩散过程的格林函数表示的联系。将你的最终答案表示为 $\\mu$、$a$、$b$ 和 $x$ 的闭合形式函数。\n\n你的最终答案必须是单一的闭合形式解析表达式；不要提供不等式或方程。无需四舍五入，也不涉及物理单位。", "solution": "这是一个基于已建立数学原理的随机微分方程理论中的标准、适定问题，因此是有效的。所有必要信息均已提供，且术语精确无歧义。\n\n设 $\\{X_t\\}_{t \\ge 0}$ 是由 SDE $dX_t = \\mu \\, dt + dW_t$ 定义的随机过程，其中 $X_0 = x$ 且 $a < x < b$。这是一个具有常数漂移 $\\mu(x) = \\mu$ 和常数扩散系数 $\\sigma(x)=1$ 的一维扩散过程。\n\n此扩散过程的无穷小生成元 $\\mathcal{L}$ 作用于一个二次可微函数 $f(x)$ 时，由下式给出：\n$$\n\\mathcal{L}f(x) = \\mu(x) \\frac{df}{dx} + \\frac{1}{2}\\sigma(x)^2 \\frac{d^2f}{dx^2} = \\mu f'(x) + \\frac{1}{2}f''(x)\n$$\n问题要求将解与标度函数 $s(x)$ 和速度测度 $m(dx)$ 联系起来。标度函数 $s(x)$ 由性质 $\\mathcal{L}s(x)=0$ 定义。对于此过程，标度函数导数的一个选择是 $s'(x) = \\exp\\left(-\\int \\frac{2\\mu}{\\sigma^2} dy\\right) = \\exp(-2\\mu x)$，这在相差一个乘法常数的意义上与问题陈述相符。速度测度密度由 $m(x) = \\frac{2}{\\sigma(x)^2 s'(x)} = \\frac{2}{1^2 \\cdot \\exp(-2\\mu x)} = 2\\exp(2\\mu x)$ 给出，这也与问题陈述相符。用 $s(x)$ 和 $m(x)$ 表示，生成元可以写成：\n$$\n\\mathcal{L}f(x) = \\frac{1}{m(x)}\\frac{d}{dx}\\left(\\frac{f'(x)}{s'(x)}\\right)\n$$\n我们将使用这种形式来推导解。\n\n**1. 到达概率 $h(x) = \\mathbb{P}_x(\\tau_b < \\tau_a)$ 的推导**\n\n到达概率 $h(x)$ 是边值问题 (BVP) 的解，该问题由 $x \\in (a,b)$ 上的 $\\mathcal{L}h(x) = 0$ 和边界条件 $h(a)=0$、$h(b)=1$ 定义。边界条件的来源是：如果过程从 $x=a$ 开始，它已经到达了 $a$，因此首先到达 $b$ 的概率为 $0$。如果它从 $x=b$ 开始，它已经到达了 $b$，因此首先到达 $b$ 的概率为 $1$。\n\n使用以标度函数表示的生成元，常微分方程 (ODE) 为：\n$$\n\\frac{1}{m(x)}\\frac{d}{dx}\\left(\\frac{h'(x)}{s'(x)}\\right) = 0 \\implies \\frac{d}{dx}\\left(\\frac{h'(x)}{s'(x)}\\right) = 0\n$$\n对 $x$ 积分一次得到：\n$$\n\\frac{h'(x)}{s'(x)} = C_1 \\implies h'(x) = C_1 s'(x)\n$$\n其中 $C_1$ 是一个积分常数。再次积分得到：\n$$\nh(x) = C_1 s(x) + C_2\n$$\n我们应用边界条件来求解 $C_1$ 和 $C_2$：\n1. $h(a) = C_1 s(a) + C_2 = 0$\n2. $h(b) = C_1 s(b) + C_2 = 1$\n\n用第二个方程减去第一个方程得到 $C_1(s(b)-s(a)) = 1$，所以 $C_1 = \\frac{1}{s(b)-s(a)}$。\n从第一个方程可知，$C_2 = -C_1 s(a) = -\\frac{s(a)}{s(b)-s(a)}$。\n将常数代回 $h(x)$ 的解中：\n$$\nh(x) = \\frac{s(x)}{s(b)-s(a)} - \\frac{s(a)}{s(b)-s(a)} = \\frac{s(x)-s(a)}{s(b)-s(a)}\n$$\n现在，我们从其导数 $s'(x) = \\exp(-2\\mu x)$ 求出 $s(x)$ 的显式形式：\n- 如果 $\\mu \\neq 0$，$s(x) = \\int \\exp(-2\\mu x) dx = -\\frac{1}{2\\mu}\\exp(-2\\mu x)$。我们可以忽略积分常数，因为它在 $h(x)$ 的公式中会被消掉。\n  $$\n  h(x) = \\frac{-\\frac{1}{2\\mu}\\exp(-2\\mu x) - (-\\frac{1}{2\\mu}\\exp(-2\\mu a))}{-\\frac{1}{2\\mu}\\exp(-2\\mu b) - (-\\frac{1}{2\\mu}\\exp(-2\\mu a))} = \\frac{\\exp(-2\\mu x) - \\exp(-2\\mu a)}{\\exp(-2\\mu b) - \\exp(-2\\mu a)}\n  $$\n- 如果 $\\mu = 0$，$s'(x) = 1$，所以 $s(x) = x$。\n  $$\n  h(x) = \\frac{x-a}{b-a}\n  $$\n当 $\\mu \\to 0$ 时，$\\mu \\neq 0$ 的表达式通过洛必达法则收敛于 $\\mu=0$ 的表达式。\n\n**2. 期望离开时间 $u(x) = \\mathbb{E}_x[\\tau_{(a,b)}]$ 的推导**\n\n期望离开时间 $u(x)$ 是泊松型边值问题 (BVP) 的解，该问题由 $x \\in (a,b)$ 上的 $\\mathcal{L}u(x) = -1$ 和边界条件 $u(a)=0$、$u(b)=0$ 定义。边界条件的来源是：如果过程从边界点开始，离开时间为 $0$。\n\n使用以标度测度和速度测度表示的生成元，常微分方程 (ODE) 为：\n$$\n\\frac{1}{m(x)}\\frac{d}{dx}\\left(\\frac{u'(x)}{s'(x)}\\right) = -1 \\implies \\frac{d}{dx}\\left(\\frac{u'(x)}{s'(x)}\\right) = -m(x)\n$$\n代入 $m(x) = 2\\exp(2\\mu x)$ 并对 $x$ 积分得到：\n- 如果 $\\mu \\neq 0$：\n  $$\n  \\frac{u'(x)}{s'(x)} = \\int -2\\exp(2\\mu y) dy = -\\frac{1}{\\mu}\\exp(2\\mu x) + C_1\n  $$\n  $u'(x) = s'(x) \\left(-\\frac{1}{\\mu}\\exp(2\\mu x) + C_1\\right) = \\exp(-2\\mu x) \\left(-\\frac{1}{\\mu}\\exp(2\\mu x) + C_1\\right) = -\\frac{1}{\\mu} + C_1\\exp(-2\\mu x)$。\n  再次积分：\n  $$\n  u(x) = \\int \\left(-\\frac{1}{\\mu} + C_1\\exp(-2\\mu x)\\right) dx = -\\frac{x}{\\mu} - \\frac{C_1}{2\\mu}\\exp(-2\\mu x) + C_2\n  $$\n  令 $K_1 = -\\frac{C_1}{2\\mu}$ 且 $K_2=C_2$。通解为 $u(x) = -\\frac{x}{\\mu} + K_1\\exp(-2\\mu x) + K_2$。\n  我们应用边界条件 $u(a)=0$ 和 $u(b)=0$：\n  1. $-\\frac{a}{\\mu} + K_1\\exp(-2\\mu a) + K_2 = 0 \\implies K_1\\exp(-2\\mu a) + K_2 = \\frac{a}{\\mu}$\n  2. $-\\frac{b}{\\mu} + K_1\\exp(-2\\mu b) + K_2 = 0 \\implies K_1\\exp(-2\\mu b) + K_2 = \\frac{b}{\\mu}$\n  相减得到 $K_1(\\exp(-2\\mu a) - \\exp(-2\\mu b)) = \\frac{a-b}{\\mu}$，因此 $K_1 = \\frac{a-b}{\\mu(\\exp(-2\\mu a) - \\exp(-2\\mu b))}$。\n  $K_2 = \\frac{a}{\\mu} - K_1\\exp(-2\\mu a) = \\frac{a}{\\mu} - \\frac{(a-b)\\exp(-2\\mu a)}{\\mu(\\exp(-2\\mu a) - \\exp(-2\\mu b))} = \\frac{b\\exp(-2\\mu a) - a\\exp(-2\\mu b)}{\\mu(\\exp(-2\\mu a) - \\exp(-2\\mu b))}$。\n  将这些常数代回，我们得到一个复杂的表达式。一个更有条理的形式是：\n  $$\n  u(x) = \\frac{1}{\\mu}\\left( a-x + (b-a)h(x) \\right) = \\frac{1}{\\mu}\\left( a-x + (b-a)\\frac{\\exp(-2\\mu x) - \\exp(-2\\mu a)}{\\exp(-2\\mu b) - \\exp(-2\\mu a)}\\right)\n  $$\n- 如果 $\\mu = 0$，常微分方程为 $\\frac{1}{2}u''(x) = -1$，即 $u''(x) = -2$。\n  积分两次得到 $u(x) = -x^2 + C_1 x + C_2$。\n  应用边界条件 $u(a)=0, u(b)=0$：\n  1. $-a^2 + C_1 a + C_2 = 0$\n  2. $-b^2 + C_1 b + C_2 = 0$\n  解此方程组得到 $C_1 = a+b$ 和 $C_2 = -ab$。\n  解为 $u(x) = -x^2 + (a+b)x - ab = (x-a)(b-x)$。\n同样地，当 $\\mu \\to 0$ 时，$\\mu \\neq 0$ 的表达式收敛于 $\\mu=0$ 的表达式。我们提供对 $\\mu \\neq 0$ 有效的通用表达式，并理解 $\\mu = 0$ 的情况可以通过取极限得到。\n\n最终表达式：\n对于到达概率 $h(x) = \\mathbb{P}_x(\\tau_b < \\tau_a)$：\n$$\nh(x) = \\frac{\\exp(-2\\mu x) - \\exp(-2\\mu a)}{\\exp(-2\\mu b) - \\exp(-2\\mu a)}\n$$\n对于期望离开时间 $u(x) = \\mathbb{E}_x[\\tau_{(a,b)}]$：\n$$\nu(x) = \\frac{1}{\\mu}\\left( a-x + (b-a)\\frac{\\exp(-2\\mu x) - \\exp(-2\\mu a)}{\\exp(-2\\mu b) - \\exp(-2\\mu a)}\\right)\n$$", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\exp(-2\\mu x) - \\exp(-2\\mu a)}{\\exp(-2\\mu b) - \\exp(-2\\mu a)} & \\frac{1}{\\mu}\\left( a-x + (b-a)\\frac{\\exp(-2\\mu x) - \\exp(-2\\mu a)}{\\exp(-2\\mu b) - \\exp(-2\\mu a)}\\right) \\end{pmatrix} } $$", "id": "2974721"}, {"introduction": "接下来，我们将视角从一维扩展到多维空间。这个练习探讨了多维布朗运动在一个环形区域内的行为，这是一个具有几何对称性的典型问题。你将学习如何利用这种对称性，将一个看似复杂的偏微分方程（拉普拉斯方程）简化为一个更易于处理的关于半径的常微分方程，这在物理学和数学中都是一种至关重要的问题简化策略。此外，通过这个过程，我们还会发现二维空间（$d=2$）所独有的对数行为，这揭示了维度在随机过程中扮演的深刻角色 [@problem_id:2974725]。", "problem": "考虑 $\\mathbb{R}^d$ 上标准的 $d$ 维布朗运动 $B_t$（其中 $d \\ge 2$），它从点 $x \\in \\mathbb{R}^d$ 出发，其范数 $r = \\|x\\| \\in (r_1, r_2)$，其中 $0 < r_1 < r_2$。令 $A = \\{ x \\in \\mathbb{R}^d : r_1 < \\|x\\| < r_2 \\}$ 表示该环域，并令 $\\tau = \\inf\\{ t \\ge 0 : B_t \\notin A \\}$ 为首次离开环域 $A$ 的时间。定义事件 $H_{\\text{in}} = \\{ \\|B_\\tau\\| = r_1 \\}$ 为该过程首次触碰内球面，事件 $H_{\\text{out}} = \\{ \\|B_\\tau\\| = r_2 \\}$ 为首次触碰外球面，因此 $H_{\\text{in}} \\cup H_{\\text{out}}$ 几乎必然发生，且 $H_{\\text{in}} \\cap H_{\\text{out}} = \\varnothing$。\n\n仅从布朗运动的生成元刻画（无穷小生成元为 $(1/2)\\Delta$，其中 $\\Delta$ 是拉普拉斯算子）出发，结合强马尔可夫性和在 $\\partial A$ 上设定的边界数据，从第一性原理推导函数 $u(x) = \\mathbb{P}_x(H_{\\text{in}})$ 的边值问题，通过对称性将其简化为关于径向坐标 $r = \\|x\\|$ 的径向常微分方程，并在 $r = r_1$ 和 $r = r_2$ 处的适当边界条件下求解该方程。您的推导必须清楚地说明为什么所得函数在 $A$ 内部是调和的，以及边界条件如何编码事件 $H_{\\text{in}}$。\n\n将内触碰概率 $u(r) = \\mathbb{P}(\\|B_\\tau\\| = r_1 \\mid \\|B_0\\| = r)$ 明确地表示为 $r, r_1, r_2$ 和 $d$ 的闭式函数，展示其对 $d$ 的依赖性，并显示当 $d \\ne 2$（用半径的幂表示）和 $d = 2$（用半径的对数表示）时的不同形式。您可以假设有足够的平滑性和正则性来为您的推导步骤提供依据。外触碰概率由 $1 - u(r)$ 给出，无需报告。\n\n请将您的最终答案表示为 $u(r)$ 的单个闭式表达式，对所有 $d \\ge 2$ 均有效，并分段写出 $d \\ne 2$ 和 $d = 2$ 两种情况。无需进行数值计算，也不涉及任何单位。", "solution": "用户希望找到一个 $d$ 维布朗运动，从环域内出发，在触碰外边界之前先触碰内边界的概率。推导必须从该过程的无穷小生成元开始。\n\n令 $B_t$ 为一个标准的 $d$ 维布朗运动，其中 $d \\ge 2$。起始位置为 $x \\in \\mathbb{R}^d$，其范数 $r = \\|x\\|$ 满足 $r_1 < r < r_2$，其中 $0 < r_1 < r_2$。该过程在环域 $A = \\{ y \\in \\mathbb{R}^d : r_1 < \\|y\\| < r_2 \\}$ 中演化。首次离开此环域的时间为 $\\tau = \\inf\\{ t \\ge 0 : B_t \\notin A \\}$。我们感兴趣的是事件 $H_{\\text{in}} = \\{ \\|B_\\tau\\| = r_1 \\}$ 的概率，即过程首次触碰内球面 $\\partial A_{\\text{in}} = \\{ y \\in \\mathbb{R}^d : \\|y\\| = r_1 \\}$ 的概率。\n\n令 $u(x) = \\mathbb{P}_x(H_{\\text{in}}) = \\mathbb{P}(H_{\\text{in}} \\mid B_0 = x)$。我们的任务是求出 $u(x)$。\n\n一个标准 $d$ 维布朗运动的无穷小生成元是算子 $\\mathcal{L} = \\frac{1}{2}\\Delta$，其中 $\\Delta = \\sum_{i=1}^d \\frac{\\partial^2}{\\partial x_i^2}$ 是拉普拉斯算子。\n\n随机微分方程理论中的一个基本结果，即 Dynkin 公式，将一个过程与其生成元联系起来。对于一个具有足够正则性的函数 $f$ 和一个停时 $T$，过程 $M_t = f(B_{t \\wedge T}) - \\int_0^{t \\wedge T} \\mathcal{L}f(B_s) ds$ 是一个鞅。一个关键性质是，触碰概率函数 $u(x)$ 在定义域的内部对所有 $x$ 都满足 $\\mathcal{L}u(x) = 0$。在我们的例子中，这意味着对所有 $x \\in A$，都有 $\\frac{1}{2}\\Delta u(x) = 0$。这表明 $u(x)$ 是在环域 $A$ 内的一个调和函数。\n\n更形式化地看，考虑过程 $U_t = u(B_{t \\wedge \\tau})$。根据强马尔可夫性，对于任意停时 $S < \\tau$，\n$$ u(B_S) = \\mathbb{P}_{B_S}(H_{\\text{in}}) = \\mathbb{E}[ \\mathbf{1}_{H_{\\text{in}}} \\mid \\mathcal{F}_S ] $$\n其中 $\\mathbf{1}_{H_{\\text{in}}}$ 是该事件的示性函数。过程 $U_t$ 是一个有界鞅。根据 Itô 公式，对于 $C^2$ 函数 $u$，当 $t < \\tau$ 时 $U_t$ 的鞅性质要求漂移项为零。漂移项是 $\\mathcal{L}u(B_t) = \\frac{1}{2}\\Delta u(B_t)$。因此，对于所有 $x \\in A$，我们必须有 $\\Delta u(x) = 0$。\n\n接下来，我们建立 $u(x)$ 在 $\\partial A = \\partial A_{\\text{in}} \\cup \\partial A_{\\text{out}}$ 上的边界条件。\n如果过程从内球面上的一个点 $x$ 开始，即 $\\|x\\|=r_1$，那么它的起点已经位于边界上。首次离开时间为 $\\tau=0$，且 $B_\\tau = B_0 = x$。因此，$\\|B_\\tau\\| = r_1$，这意味着事件 $H_{\\text{in}}$ 以概率 $1$ 发生。因此，边界条件是在 $\\|x\\| = r_1$ 时 $u(x) = 1$。\n\n如果过程从外球面上的一个点 $x$ 开始，即 $\\|x\\|=r_2$，首次离开时间同样为 $\\tau=0$，且 $B_\\tau=x$。因此，$\\|B_\\tau\\| = r_2$。事件 $H_{\\text{in}}$ 不可能发生，所以其概率为 $0$。因此，边界条件是在 $\\|x\\| = r_2$ 时 $u(x) = 0$。\n\n我们现在为函数 $u(x)$ 建立了一个 Dirichlet 问题：\n$$\n\\begin{cases}\n\\Delta u(x) = 0 & \\text{for } x \\in A = \\{x \\in \\mathbb{R}^d : r_1 < \\|x\\| < r_2\\} \\\\\nu(x) = 1 & \\text{for } \\|x\\| = r_1 \\\\\nu(x) = 0 & \\text{for } \\|x\\| = r_2\n\\end{cases}\n$$\n\n拉普拉斯算子 $\\Delta$、定义域 $A$ 以及边界条件都关于 $\\mathbb{R}^d$ 围绕原点的旋转是不变的。这种球面对称性意味着唯一解 $u(x)$ 必须仅依赖于与原点的径向距离 $r = \\|x\\|$。因此，我们可以对某个函数 $v$ 写出 $u(x) = v(r)$。\n\n为了解决这个问题，我们在 $d$ 维球坐标中表示拉普拉斯算子。对于一个只依赖于半径 $r$ 的函数 $v(r)$，拉普拉斯算子由下式给出：\n$$ \\Delta v(r) = \\frac{d^2 v}{dr^2} + \\frac{d-1}{r} \\frac{dv}{dr} $$\n偏微分方程 $\\Delta u = 0$ 简化为常微分方程 (ODE)：\n$$ v''(r) + \\frac{d-1}{r} v'(r) = 0 $$\n边界条件变为 $v(r_1) = 1$ 和 $v(r_2) = 0$。\n\n这是一个二阶线性常微分方程，可以通过先降阶来求解。令 $w(r) = v'(r)$。关于 $w$ 的方程是：\n$$ w'(r) + \\frac{d-1}{r} w(r) = 0 $$\n这是一个可分离的一阶常微分方程：\n$$ \\frac{w'(r)}{w(r)} = -\\frac{d-1}{r} $$\n对 $r$ 积分得到 $\\ln(w(r)) = -(d-1)\\ln(r) + C_0$，这给出 $w(r) = C_1 r^{-(d-1)} = C_1 r^{1-d}$，其中 $C_1$ 是某个常数。\n现在我们有 $v'(r) = C_1 r^{1-d}$。为了求出 $v(r)$，我们对 $v'(r)$ 进行积分。我们必须根据指数 $1-d$ 考虑两种不同的情况。\n\n情况1：$d \\ne 2$。\n在这种情况下，$1-d \\ne -1$。积分为：\n$$ v(r) = \\int C_1 r^{1-d} dr = C_1 \\frac{r^{2-d}}{2-d} + C_2 $$\n通解的形式为 $v(r) = A r^{2-d} + B$，其中 $A$ 和 $B$ 是常数。我们应用边界条件来确定它们：\n$$ v(r_1) = A r_1^{2-d} + B = 1 $$\n$$ v(r_2) = A r_2^{2-d} + B = 0 $$\n从第二个方程，我们得到 $B = -A r_2^{2-d}$。将其代入第一个方程：\n$$ A r_1^{2-d} - A r_2^{2-d} = 1 \\implies A(r_1^{2-d} - r_2^{2-d}) = 1 $$\n$$ A = \\frac{1}{r_1^{2-d} - r_2^{2-d}} $$\n然后，$B$ 由下式给出：\n$$ B = - \\frac{r_2^{2-d}}{r_1^{2-d} - r_2^{2-d}} $$\n将 $A$ 和 $B$ 代回到 $v(r)$ 的解中：\n$$ v(r) = \\frac{r^{2-d}}{r_1^{2-d} - r_2^{2-d}} - \\frac{r_2^{2-d}}{r_1^{2-d} - r_2^{2-d}} = \\frac{r^{2-d} - r_2^{2-d}}{r_1^{2-d} - r_2^{2-d}} $$\n\n情况2：$d=2$。\n在这种情况下，指数为 $1-d = -1$。\n$$ v'(r) = C_1 r^{-1} = \\frac{C_1}{r} $$\n对 $r$ 积分得到：\n$$ v(r) = \\int \\frac{C_1}{r} dr = C_1 \\ln(r) + C_2 $$\n通解的形式为 $v(r) = A \\ln(r) + B$。应用边界条件：\n$$ v(r_1) = A \\ln(r_1) + B = 1 $$\n$$ v(r_2) = A \\ln(r_2) + B = 0 $$\n从第二个方程，得到 $B = -A \\ln(r_2)$。将其代入第一个方程：\n$$ A \\ln(r_1) - A \\ln(r_2) = 1 \\implies A(\\ln(r_1) - \\ln(r_2)) = 1 $$\n$$ A = \\frac{1}{\\ln(r_1) - \\ln(r_2)} = \\frac{1}{\\ln(r_1/r_2)} $$\n然后，$B$ 由下式给出：\n$$ B = - \\frac{\\ln(r_2)}{\\ln(r_1) - \\ln(r_2)} $$\n将 $A$ 和 $B$ 代回到 $v(r)$ 的解中：\n$$ v(r) = \\frac{\\ln(r)}{\\ln(r_1) - \\ln(r_2)} - \\frac{\\ln(r_2)}{\\ln(r_1) - \\ln(r_2)} = \\frac{\\ln(r) - \\ln(r_2)}{\\ln(r_1) - \\ln(r_2)} $$\n这也可以写成 $v(r) = \\frac{\\ln(r/r_2)}{\\ln(r_1/r_2)}$ 或 $v(r) = \\frac{\\ln(r_2/r)}{\\ln(r_2/r_1)}$。\n\n综合这些结果，概率 $u(r) = \\mathbb{P}(\\|B_\\tau\\| = r_1 \\mid \\|B_0\\|=r)$ 由以下关于 $r, r_1, r_2$ 和维度 $d$ 的分段函数给出。", "answer": "$$\n\\boxed{\nu(r) = \\begin{cases} \\frac{r^{2-d} - r_2^{2-d}}{r_1^{2-d} - r_2^{2-d}} & \\text{if } d \\neq 2 \\\\ \\frac{\\ln(r) - \\ln(r_2)}{\\ln(r_1) - \\ln(r_2)} & \\text{if } d = 2 \\end{cases}\n}\n$$", "id": "2974725"}, {"introduction": "最后的练习将引导我们进入一个更复杂的领域，研究贝塞尔过程（Bessel process），它可以看作是多维布朗运动径向部分的模型。本练习的核心是引入一个强大的分析工具：边界分类。我们将运用 Feller 的判据，结合标度函数和速度测度，来判断一个边界点（如此处的原点）的性质，从而预测它是否可以被过程触及。这种先进行定性分析再进行定量计算（如求解平均首出时间）的思路，对于理解具有状态依赖系数和复杂边界行为的扩散过程至关重要 [@problem_id:2974762]。", "problem": "考虑一个维数为 $\\delta>0$ 的贝塞尔扩散，记作 $\\operatorname{BES}(\\delta)$，其状态空间为 $(0,\\infty)$，初始位置为 $X_{0}=x\\in(0,\\infty)$。它被定义为以下随机微分方程的唯一强解：\n$$\ndX_{t} \\;=\\; dB_{t} \\;+\\; \\frac{\\delta-1}{2\\,X_{t}}\\,dt,\n$$\n其中 $B_{t}$ 是一个标准的一维布朗运动。固定一个半径 $R>0$，并将从有界区间 $(0,R)$ 的首次离开时间定义为\n$$\n\\tau_{(0,R)} \\;=\\; \\inf\\{ t\\ge 0 : X_{t}\\notin(0,R)\\}.\n$$\n使用 Feller 基于标度函数和速率测度的边界分类法，分析在 $\\delta>2$、$\\delta=2$ 和 $\\delta\\in(0,2)$ 这三种参数区域下端点 $0$ 的性质。对于每个区域，定性地预测当 $x\\in(0,R)$ 时，平均离开时间 $\\mathbb{E}_{x}[\\tau_{(0,R)}]$ 是有限、无穷还是零。此处的约定是，在 $R$ 处的边界条件是吸收的，而在 $0$ 处的边界行为由其分类决定。然后，对于 $\\delta>2$ 这一特定区域，仅使用基础工具——无穷小生成元、Dynkin 公式以及边界类型的标度-速率刻画——从第一性原理推导 $\\mathbb{E}_{x}[\\tau_{(0,R)}]$ 作为 $x$、$R$ 和 $\\delta$ 的函数的精确表达式。你的最终答案必须是关于 $x$、$R$ 和 $\\delta$ 的单个闭式表达式。无需四舍五入，也不涉及物理单位。", "solution": "此题要求分析贝塞尔过程从区间 $(0,R)$ 的离开时间。该过程 $X_t$ 由以下随机微分方程（SDE）定义：\n$$\ndX_{t} \\;=\\; dB_{t} \\;+\\; \\frac{\\delta-1}{2\\,X_{t}}\\,dt\n$$\n其中 $\\delta > 0$ 是维数，$X_0 = x \\in (0,R)$，且 $B_t$ 是一个标准的一维布朗运动。\n\n解答过程分为三部分。首先，我们使用 Feller 边界分类法对 $0$ 处的边界进行分类。其次，我们使用此分类来定性地判断平均离开时间 $\\mathbb{E}_{x}[\\tau_{(0,R)}]$ 是有限还是无穷。第三，我们推导在 $\\delta>2$ 区域下该平均离开时间的精确表达式。\n\n该 SDE 的形式为 $dX_t = \\mu(X_t)dt + \\sigma(X_t)dB_t$，其漂移系数为 $\\mu(x) = \\frac{\\delta-1}{2x}$，扩散系数为 $\\sigma(x)=1$。\n\n**第 1 部分：Feller 边界分类**\n\nFeller 对边界点的分类取决于标度测度密度和速率测度密度在该点附近的可积性。\n标度函数密度 $s(x)$ 由下式给出：\n$$\ns(x) = \\exp\\left(-\\int \\frac{2\\mu(y)}{\\sigma^2(y)} dy\\right) = \\exp\\left(-\\int \\frac{2(\\delta-1)/(2y)}{1^2} dy\\right) = \\exp\\left(-(\\delta-1)\\ln x\\right) = x^{1-\\delta}\n$$\n速率测度密度 $m(x)$ 由下式给出：\n$$\nm(x) = \\frac{2}{\\sigma^2(x)s(x)} = \\frac{2}{1 \\cdot x^{1-\\delta}} = 2x^{\\delta-1}\n$$\n为了对 $0$ 处的边界进行分类，我们考察 $s(x)$ 和 $m(x)$ 在某个区间 $(0,c]$（其中 $c>0$）上的积分的收敛性。我们取 $c=1$。\n\n标度密度的积分为：\n$$\n\\int_0^1 s(x)\\,dx = \\int_0^1 x^{1-\\delta}\\,dx\n$$\n当指数 $1-\\delta$ 大于 $-1$ 时，即当 $\\delta < 2$ 时，该积分收敛。当 $\\delta \\ge 2$ 时，该积分发散。\n\n速率测度密度的积分为：\n$$\n\\int_0^1 m(x)\\,dx = \\int_0^1 2x^{\\delta-1}\\,dx\n$$\n当指数 $\\delta-1$ 大于 $-1$ 时，即当 $\\delta > 0$ 时，该积分收敛。由于题目说明 $\\delta>0$，该积分始终收敛。\n\n根据标准分类方案（例如 Karatzas 和 Shreve 的方案），边界根据 $s(x)$（记作 $I_s$）和 $m(x)$（记作 $I_m$）的积分收敛性分类如下：\n- 正则边界：$I_s < \\infty$ 且 $I_m < \\infty$。\n- 入口边界：$I_s = \\infty$ 且 $I_m < \\infty$。\n- 出口边界：$I_s < \\infty$ 且 $I_m = \\infty$。\n- 自然边界：$I_s = \\infty$ 且 $I_m = \\infty$。\n\n将此应用于贝塞尔过程在 $0$ 处的边界：\n1.  **区域 $\\delta \\in (0, 2)$**：$I_s = \\int_0^1 x^{1-\\delta}\\,dx < \\infty$ 且 $I_m = \\int_0^1 2x^{\\delta-1}\\,dx < \\infty$。$0$ 处的边界是**正则的**。正则边界是可达的，意味着过程可以在有限时间内以正概率到达该边界。\n2.  **区域 $\\delta = 2$**：$I_s = \\int_0^1 x^{-1}\\,dx = \\infty$ 且 $I_m = \\int_0^1 2x\\,dx < \\infty$。$0$ 处的边界是**入口**。\n3.  **区域 $\\delta > 2$**：$I_s = \\int_0^1 x^{1-\\delta}\\,dx = \\infty$ 且 $I_m = \\int_0^1 2x^{\\delta-1}\\,dx < \\infty$。$0$ 处的边界是**入口**。\n\n入口边界从状态空间的内部是不可达的。这意味着对于 $\\delta \\ge 2$，从 $x>0$ 开始的过程 $X_t$ 几乎必然永远不会到达 $0$。\n\n**第 2 部分：平均离开时间的定性预测**\n\n设 $u(x) = \\mathbb{E}_{x}[\\tau_{(0,R)}]$，其中 $\\tau_{(0,R)} = \\inf\\{ t\\ge 0 : X_{t}\\notin(0,R)\\}$。在 $R$ 处的边界是吸收的。在 $0$ 处的行为“由分类决定”。\n- 对于 $\\delta \\in (0, 2)$，$0$ 处的边界是正则的，因此是可达的。从 $(0,R)$ 离开意味着过程在到达 $0$ 或 $R$ 时停止。这对应于在两端都施加吸收边界条件。对于一个在有限区间上、具有两个可达吸收边界的扩散过程，其平均离开时间是有限的。\n- 对于 $\\delta \\ge 2$，$0$ 处的边界是入口边界，因此是不可达的。过程永远无法在 $0$ 处离开。因此，离开区间 $(0,R)$ 等价于到达边界 $R$。所以，$\\tau_{(0,R)} = \\tau_R = \\inf\\{t \\ge 0 : X_t=R\\}$。\n    - 对于 $\\delta > 2$，漂移 $\\mu(x) = (\\delta-1)/(2x)$ 为正，将过程从 $0$ 推向 $R$。\n    - 对于 $\\delta = 2$，漂移 $\\mu(x)=1/(2x)$ 也为正，将过程从 $0$ 推开。\n在 $\\delta \\ge 2$ 的两个子区域中，过程都被推向 $R$ 处的出口，并且不会在不可达的边界 $0$ 处卡住。这表明到达 $R$ 的平均时间是有限的。\n\n因此，对于所有三个区域，定性预测是平均离开时间 $\\mathbb{E}_{x}[\\tau_{(0,R)}]$ 是**有限的**。由于 $x \\in (0,R)$，其值为 $0$ 是不可能的，并且我们的分析表明“无穷”也是不符合预期的。\n\n**第 3 部分：对 $\\delta > 2$ 的推导**\n\n对于区域 $\\delta > 2$，我们寻求 $u(x) = \\mathbb{E}_{x}[\\tau_{(0,R)}]$ 的精确表达式。如前所述，$0$ 处的边界是不可达的，所以 $\\tau_{(0,R)} = \\tau_R$。函数 $u(x)$ 满足由 Dynkin 公式给出的常微分方程：\n$$\n\\mathcal{L}u(x) = -1\n$$\n其中 $\\mathcal{L}$ 是该过程的无穷小生成元：\n$$\n\\mathcal{L} = \\mu(x)\\frac{d}{dx} + \\frac{1}{2}\\sigma^2(x)\\frac{d^2}{dx^2} = \\frac{\\delta-1}{2x}\\frac{d}{dx} + \\frac{1}{2}\\frac{d^2}{dx^2}\n$$\n所以该常微分方程为：\n$$\n\\frac{1}{2}u''(x) + \\frac{\\delta-1}{2x}u'(x) = -1\n$$\n边界条件是：\n1.  在 $R$ 处的吸收边界：$u(R) = 0$。\n2.  在 $0$ 处的不可达边界：当 $x \\to 0^{+}$ 时，解 $u(x)$ 必须是正则的（例如，有界的）。\n\n我们来解这个常微分方程。令 $v(x) = u'(x)$。方程变为关于 $v(x)$ 的一个一阶线性常微分方程：\n$$\nv'(x) + \\frac{\\delta-1}{x}v(x) = -2\n$$\n积分因子是 $I(x) = \\exp\\left(\\int \\frac{\\delta-1}{x} dx\\right) = \\exp((\\delta-1)\\ln x) = x^{\\delta-1}$。用 $I(x)$ 乘以该常微分方程：\n$$\n\\left(x^{\\delta-1}v(x)\\right)' = -2x^{\\delta-1}\n$$\n对 $x$ 积分：\n$$\nx^{\\delta-1}v(x) = \\int -2x^{\\delta-1} dx = -2\\frac{x^\\delta}{\\delta} + C_1\n$$\n其中 $C_1$ 是一个积分常数。求解 $v(x) = u'(x)$：\n$$\nu'(x) = -\\frac{2x}{\\delta} + C_1 x^{1-\\delta}\n$$\n再次积分以求得 $u(x)$：\n$$\nu(x) = \\int\\left(-\\frac{2x}{\\delta} + C_1 x^{1-\\delta}\\right) dx\n$$\n由于 $\\delta > 2$，我们有 $\\delta \\ne 2$，所以可以对第二项进行积分：\n$$\nu(x) = -\\frac{x^2}{\\delta} + C_1 \\frac{x^{2-\\delta}}{2-\\delta} + C_2\n$$\n其中 $C_2$ 是另一个积分常数。现在我们应用边界条件。\n首先，考虑在 $x=0$ 处的正则性条件。因为 $\\delta > 2$，指数 $2-\\delta$ 是负数。当 $x \\to 0^{+}$ 时，项 $x^{2-\\delta}$ 发散到无穷大。为了使 $u(x)$ 按照不可达边界处的正则性要求保持有界，这个发散项的系数必须为零。因此，我们必须有 $C_1=0$。\n\n当 $C_1=0$ 时，解简化为：\n$$\nu(x) = -\\frac{x^2}{\\delta} + C_2\n$$\n现在，我们应用在 $x=R$ 处的吸收边界条件：\n$$\nu(R) = 0 \\implies -\\frac{R^2}{\\delta} + C_2 = 0 \\implies C_2 = \\frac{R^2}{\\delta}\n$$\n将 $C_2$ 代回到 $u(x)$ 的解中，得到平均离开时间的最终表达式：\n$$\nu(x) = \\frac{R^2}{\\delta} - \\frac{x^2}{\\delta} = \\frac{R^2 - x^2}{\\delta}\n$$\n对于所有的 $x \\in (0,R)$，该函数都是正且有限的，这与我们的定性预测一致。", "answer": "$$\n\\boxed{\\frac{R^2 - x^2}{\\delta}}\n$$", "id": "2974762"}]}