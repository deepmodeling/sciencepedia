{"hands_on_practices": [{"introduction": "构建任何伊东-泰勒 (Itô–Taylor) 格式的基础是能够计算其系数函数。这些函数是通过对随机微分方程 (SDE) 的漂移和扩散项重复应用微分算子 $L^0$ 和 $L^k$ 生成的。本练习将通过一个具体的多维 SDE 实例，让你直接动手实践这些算子的应用，并根据多重积分的“阶”来确定哪些项是构建特定精度格式所必需的，从而将抽象的理论与实际计算联系起来。[@problem_id:2982869]", "problem": "考虑二维 Itô 随机微分方程 (SDE)\n$$\n\\mathrm{d}X_{t} = a(X_{t})\\,\\mathrm{d}t + \\sum_{k=1}^{2} b^{(k)}(X_{t})\\,\\mathrm{d}W_{t}^{(k)},\n$$\n其中 $X_{t} \\in \\mathbb{R}^{2}$，$W^{(1)}$ 和 $W^{(2)}$ 是独立的标准维纳过程（布朗运动），且系数函数为\n$$\na(x) = \\begin{pmatrix} a_{1}(x) \\\\ a_{2}(x) \\end{pmatrix} = \\begin{pmatrix} x_{1} + x_{2}^{2} \\\\ x_{1}x_{2} \\end{pmatrix},\\quad\nb^{(1)}(x) = \\begin{pmatrix} x_{1}^{2} \\\\ \\ln(1 + x_{2}^{2}) \\end{pmatrix},\\quad\nb^{(2)}(x) = \\begin{pmatrix} x_{1}x_{2} \\\\ \\exp(x_{1}) \\end{pmatrix}.\n$$\n此处 $\\ln$ 表示自然对数，$\\exp$ 表示指数函数。使用强格式的 Itô-Taylor 展开框架，计算在一般点 $x = (x_{1}, x_{2}) \\in \\mathbb{R}^{2}$ 处的算子应用 $L^{0}b^{(1)}(x)$、$L^{0}b^{(2)}(x)$、$L^{1}a(x)$ 和 $L^{2}a(x)$。然后，根据强格式中使用的多重 Itô 积分的指标-权重结构，指出这四个算子应用中的每一个是否对强 1.5 阶格式有贡献。\n\n将您的最终答案表示为单个行矩阵\n$$\n\\begin{pmatrix}\n(L^{0}b^{(1)}(x))_{1}  (L^{0}b^{(1)}(x))_{2}  (L^{0}b^{(2)}(x))_{1}  (L^{0}b^{(2)}(x))_{2}  (L^{1}a(x))_{1}  (L^{1}a(x))_{2}  (L^{2}a(x))_{1}  (L^{2}a(x))_{2}  I_{L^{0}b^{(1)}}  I_{L^{0}b^{(2)}}  I_{L^{1}a}  I_{L^{2}a}\n\\end{pmatrix},\n$$\n其中每个 $I_{\\cdot}$ 是一个指示符，如果相应项对强 1.5 阶有贡献，则取值为 $1$，否则为 $0$。不需要进行数值舍入；请提供精确的符号表达式。不涉及物理单位。", "solution": "用户提供了随机微分方程数值分析领域的一个有效问题陈述。任务是在 Itô-Taylor 展开框架内计算几个算子应用，并确定它们与强 1.5 阶格式的相关性。\n\n### 第一步：Itô-Taylor 算子的定义\n\n对于一个具有 $m$ 个独立维纳过程的通用 $d$ 维 Itô SDE，\n$$\n\\mathrm{d}X_t = a(X_t) \\mathrm{d}t + \\sum_{k=1}^m b^{(k)}(X_t) \\mathrm{d}W_t^{(k)}\n$$\nItô-Taylor 展开使用算子 $L^0, L^1, \\dots, L^m$。对于一个足够光滑的标量函数 $f: \\mathbb{R}^d \\to \\mathbb{R}$，这些算子定义为：\n$$\nL^0 f(x) = \\sum_{i=1}^d a_i(x) \\frac{\\partial f}{\\partial x_i}(x) + \\frac{1}{2} \\sum_{i,j=1}^d \\left( \\sum_{k=1}^m b_i^{(k)}(x) b_j^{(k)}(x) \\right) \\frac{\\partial^2 f}{\\partial x_i \\partial x_j}(x)\n$$\n$$\nL^k f(x) = \\sum_{i=1}^d b_i^{(k)}(x) \\frac{\\partial f}{\\partial x_i}(x), \\quad \\text{对于 } k=1, \\dots, m\n$$\n当应用于向量值函数时，该算子作用于函数的每个分量。对于 $k \\ge 1$ 的算子 $L^k$，这可以使用雅可比矩阵简洁地写出。如果 $g(x)$ 是一个向量值函数，其雅可比矩阵为 $(\\nabla g)_{ij} = \\frac{\\partial g_i}{\\partial x_j}$，则有 $L^k g(x) = (\\nabla g(x)) b^{(k)}(x)$。\n\n在此问题中，维度 $d=2$，维纳过程的数量 $m=2$。点为 $x = (x_1, x_2)^T$。系数为：\n$$\na(x) = \\begin{pmatrix} x_{1} + x_{2}^{2} \\\\ x_{1}x_{2} \\end{pmatrix}, \\quad\nb^{(1)}(x) = \\begin{pmatrix} x_{1}^{2} \\\\ \\ln(1 + x_{2}^{2}) \\end{pmatrix}, \\quad\nb^{(2)}(x) = \\begin{pmatrix} x_{1}x_{2} \\\\ \\exp(x_{1}) \\end{pmatrix}\n$$\n\n### 第二步：算子应用的计算\n\n我们计算所需的项：$L^0 b^{(1)}(x)$、$L^0 b^{(2)}(x)$、$L^1 a(x)$ 和 $L^2 a(x)$。\n\n**$L^1 a(x)$ 和 $L^2 a(x)$ 的计算**\n\n首先，我们求 $a(x)$ 的雅可比矩阵：\n$$\n\\nabla a(x) =\n\\begin{pmatrix}\n\\frac{\\partial a_1}{\\partial x_1}  \\frac{\\partial a_1}{\\partial x_2} \\\\\n\\frac{\\partial a_2}{\\partial x_1}  \\frac{\\partial a_2}{\\partial x_2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1  2x_2 \\\\\nx_2  x_1\n\\end{pmatrix}\n$$\n现在我们可以计算 $L^1 a(x)$ 和 $L^2 a(x)$：\n$$\nL^1 a(x) = (\\nabla a(x)) b^{(1)}(x) = \\begin{pmatrix} 1  2x_2 \\\\ x_2  x_1 \\end{pmatrix} \\begin{pmatrix} x_1^2 \\\\ \\ln(1+x_2^2) \\end{pmatrix} = \\begin{pmatrix} x_1^2 + 2x_2 \\ln(1+x_2^2) \\\\ x_1^2 x_2 + x_1 \\ln(1+x_2^2) \\end{pmatrix}\n$$\n$$\nL^2 a(x) = (\\nabla a(x)) b^{(2)}(x) = \\begin{pmatrix} 1  2x_2 \\\\ x_2  x_1 \\end{pmatrix} \\begin{pmatrix} x_1 x_2 \\\\ \\exp(x_1) \\end{pmatrix} = \\begin{pmatrix} x_1 x_2 + 2x_2 \\exp(x_1) \\\\ x_1 x_2^2 + x_1 \\exp(x_1) \\end{pmatrix}\n$$\n\n**$L^0 b^{(1)}(x)$ 的计算**\n\n我们将算子 $L^0$ 应用于 $b^{(1)}(x)$ 的每个分量。\n对于第一个分量，$f(x) = b_1^{(1)}(x) = x_1^2$：\n- 一阶导数：$\\frac{\\partial f}{\\partial x_1} = 2x_1$，$\\frac{\\partial f}{\\partial x_2} = 0$。\n- 二阶导数：$\\frac{\\partial^2 f}{\\partial x_1^2} = 2$，所有其他二阶偏导数均为零。\n应用 $L^0$ 公式：\n$$\n(L^0 b^{(1)})_1 = a_1 \\frac{\\partial f}{\\partial x_1} + a_2 \\frac{\\partial f}{\\partial x_2} + \\frac{1}{2} \\left( (b_1^{(1)})^2 + (b_1^{(2)})^2 \\right) \\frac{\\partial^2 f}{\\partial x_1^2}\n$$\n$$\n(L^0 b^{(1)})_1 = (x_1+x_2^2)(2x_1) + (x_1 x_2)(0) + \\frac{1}{2} \\left( (x_1^2)^2 + (x_1 x_2)^2 \\right)(2)\n$$\n$$\n(L^0 b^{(1)})_1 = 2x_1^2 + 2x_1 x_2^2 + x_1^4 + x_1^2 x_2^2 = x_1^4 + 2x_1^2 + x_1^2 x_2^2 + 2x_1 x_2^2\n$$\n对于第二个分量，$f(x) = b_2^{(1)}(x) = \\ln(1+x_2^2)$：\n- 一阶导数：$\\frac{\\partial f}{\\partial x_1} = 0$，$\\frac{\\partial f}{\\partial x_2} = \\frac{2x_2}{1+x_2^2}$。\n- 二阶导数：$\\frac{\\partial^2 f}{\\partial x_2^2} = \\frac{2(1+x_2^2) - 2x_2(2x_2)}{(1+x_2^2)^2} = \\frac{2-2x_2^2}{(1+x_2^2)^2}$，所有其他二阶偏导数均为零。\n应用 $L^0$ 公式：\n$$\n(L^0 b^{(1)})_2 = a_1 \\frac{\\partial f}{\\partial x_1} + a_2 \\frac{\\partial f}{\\partial x_2} + \\frac{1}{2} \\left( (b_2^{(1)})^2 + (b_2^{(2)})^2 \\right) \\frac{\\partial^2 f}{\\partial x_2^2}\n$$\n$$\n(L^0 b^{(1)})_2 = (x_1+x_2^2)(0) + (x_1 x_2) \\left(\\frac{2x_2}{1+x_2^2}\\right) + \\frac{1}{2} \\left( (\\ln(1+x_2^2))^2 + (\\exp(x_1))^2 \\right) \\left(\\frac{2-2x_2^2}{(1+x_2^2)^2}\\right)\n$$\n$$\n(L^0 b^{(1)})_2 = \\frac{2x_1 x_2^2}{1+x_2^2} + \\frac{(1-x_2^2) \\left( (\\ln(1+x_2^2))^2 + \\exp(2x_1) \\right)}{(1+x_2^2)^2}\n$$\n\n**$L^0 b^{(2)}(x)$ 的计算**\n\n我们将算子 $L^0$ 应用于 $b^{(2)}(x)$ 的每个分量。\n对于第一个分量，$f(x) = b_1^{(2)}(x) = x_1 x_2$：\n- 一阶导数：$\\frac{\\partial f}{\\partial x_1} = x_2$，$\\frac{\\partial f}{\\partial x_2} = x_1$。\n- 二阶导数：$\\frac{\\partial^2 f}{\\partial x_1 \\partial x_2} = 1$，所有其他二阶偏导数均为零。\n对于非零混合偏导数，$L^0$ 的公式为：\n$$\nL^0 f = \\sum_i a_i \\frac{\\partial f}{\\partial x_i} + \\sum_{k=1}^m \\left( b_1^{(k)} b_2^{(k)} \\right) \\frac{\\partial^2 f}{\\partial x_1 \\partial x_2}\n$$\n$$\n(L^0 b^{(2)})_1 = a_1(x_2) + a_2(x_1) + \\left( b_1^{(1)} b_2^{(1)} + b_1^{(2)} b_2^{(2)} \\right)(1)\n$$\n$$\n(L^0 b^{(2)})_1 = (x_1+x_2^2)x_2 + (x_1 x_2)x_1 + x_1^2 \\ln(1+x_2^2) + x_1 x_2 \\exp(x_1)\n$$\n$$\n(L^0 b^{(2)})_1 = x_1 x_2 + x_2^3 + x_1^2 x_2 + x_1^2 \\ln(1+x_2^2) + x_1 x_2 \\exp(x_1)\n$$\n对于第二个分量，$f(x) = b_2^{(2)}(x) = \\exp(x_1)$：\n- 一阶导数：$\\frac{\\partial f}{\\partial x_1} = \\exp(x_1)$，$\\frac{\\partial f}{\\partial x_2} = 0$。\n- 二阶导数：$\\frac{\\partial^2 f}{\\partial x_1^2} = \\exp(x_1)$，所有其他二阶偏导数均为零。\n应用 $L^0$ 公式：\n$$\n(L^0 b^{(2)})_2 = a_1 \\frac{\\partial f}{\\partial x_1} + \\frac{1}{2} \\left( (b_1^{(1)})^2 + (b_1^{(2)})^2 \\right) \\frac{\\partial^2 f}{\\partial x_1^2}\n$$\n$$\n(L^0 b^{(2)})_2 = (x_1+x_2^2)\\exp(x_1) + \\frac{1}{2} \\left( (x_1^2)^2 + (x_1 x_2)^2 \\right) \\exp(x_1)\n$$\n$$\n(L^0 b^{(2)})_2 = \\left( x_1 + x_2^2 + \\frac{1}{2}x_1^4 + \\frac{1}{2}x_1^2 x_2^2 \\right)\\exp(x_1)\n$$\n\n### 第三步：对强 1.5 阶格式的贡献\n\n强 Itô-Taylor 展开将解 $X_t$ 表示为形如 $f_\\alpha(X_0) I_\\alpha$ 的项之和，其中 $I_\\alpha$ 是对应于多重指标 $\\alpha = (j_1, j_2, \\dots, j_\\ell)$（$j_i \\in \\{0, 1, \\dots, m\\}$）的多重 Itô 积分。系数函数 $f_\\alpha$ 是通过算子 $L^j$ 的嵌套应用生成的。一个数值格式要达到强收敛阶 $\\gamma$，它必须正确逼近展开式中所有积分 $I_\\alpha$ 的阶数小于或等于 $\\gamma$ 的项。$I_\\alpha$ 的阶数由 $\\text{ord}(I_\\alpha) = \\frac{\\ell}{2} + \\frac{n_0}{2}$ 给出，其中 $\\ell$ 是多重指标的长度，$n_0$ 是其中包含的零的个数。\n\n我们关心的是强阶 $\\gamma = 1.5$。我们需要确定计算出的算子中哪些对应于阶数 $\\le 1.5$ 的积分。\n我们计算出的项是以下多重积分的系数：\n- 对于 $k \\in \\{1, 2\\}$，$L^0 b^{(k)}(x)$ 是 $I_{(0,k)}$ 的系数。多重指标为 $\\alpha = (0,k)$，因此 $\\ell=2$，$n_0=1$。阶数为 $\\frac{2}{2} + \\frac{1}{2} = 1.5$。由于 $1.5 \\le 1.5$，这些项有贡献。因此，$I_{L^0 b^{(1)}} = 1$ 且 $I_{L^0 b^{(2)}} = 1$。\n- 对于 $k \\in \\{1, 2\\}$，$L^k a(x)$ 是 $I_{(k,0)}$ 的系数。多重指标为 $\\alpha = (k,0)$，因此 $\\ell=2$，$n_0=1$。阶数为 $\\frac{2}{2} + \\frac{1}{2} = 1.5$。由于 $1.5 \\le 1.5$，这些项有贡献。因此，$I_{L^1 a} = 1$ 且 $I_{L^2 a} = 1$。\n\n所有四个计算出的算子应用对于构建强 1.5 阶格式都是必需的。\n\n### 第四步：最终答案组合\n\n我们按照规定将 12 个所需分量组合成一个单行矩阵。\n1. $(L^{0}b^{(1)})_1 = x_1^4 + 2x_1^2 + x_1^2 x_2^2 + 2x_1 x_2^2$\n2. $(L^{0}b^{(1)})_2 = \\frac{2x_1 x_2^2}{1+x_2^2} + \\frac{(1-x_2^2)(\\exp(2x_1) + (\\ln(1+x_2^2))^2)}{(1+x_2^2)^2}$\n3. $(L^{0}b^{(2)})_1 = x_1 x_2 + x_2^3 + x_1^2 x_2 + x_1^2 \\ln(1+x_2^2) + x_1 x_2 \\exp(x_1)$\n4. $(L^{0}b^{(2)})_2 = \\left( x_1 + x_2^2 + \\frac{1}{2}x_1^4 + \\frac{1}{2}x_1^2 x_2^2 \\right)\\exp(x_1)$\n5. $(L^{1}a)_1 = x_1^2 + 2x_2 \\ln(1+x_2^2)$\n6. $(L^{1}a)_2 = x_1^2 x_2 + x_1 \\ln(1+x_2^2)$\n7. $(L^{2}a)_1 = x_1 x_2 + 2x_2 \\exp(x_1)$\n8. $(L^{2}a)_2 = x_1 x_2^2 + x_1 \\exp(x_1)$\n9. $I_{L^{0}b^{(1)}} = 1$\n10. $I_{L^{0}b^{(2)}} = 1$\n11. $I_{L^{1}a} = 1$\n12. $I_{L^{2}a} = 1$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nx_1^4 + 2x_1^2 + x_1^2 x_2^2 + 2x_1 x_2^2  \\frac{2x_1 x_2^2}{1+x_2^2} + \\frac{(1-x_2^2)(\\exp(2x_1) + (\\ln(1+x_2^2))^2)}{(1+x_2^2)^2}  x_1 x_2 + x_2^3 + x_1^2 x_2 + x_1^2 \\ln(1+x_2^2) + x_1 x_2 \\exp(x_1)  \\left( x_1 + x_2^2 + \\frac{1}{2}x_1^4 + \\frac{1}{2}x_1^2 x_2^2 \\right)\\exp(x_1)  x_1^2 + 2x_2 \\ln(1+x_2^2)  x_1^2 x_2 + x_1 \\ln(1+x_2^2)  x_1 x_2 + 2x_2 \\exp(x_1)  x_1 x_2^2 + x_1 \\exp(x_1)  1  1  1  1\n\\end{pmatrix}\n}\n$$", "id": "2982869"}, {"introduction": "在掌握了如何计算系数之后，我们进一步深入理解伊东-泰勒展开中的核心构件——多重随机积分。一个数值格式的强收敛“阶”直接取决于它所包含的随机积分项的“大小”或缩放行为。本练习将引导你运用随机积分的基本性质（如伊东等距定理），来推导一个三重伊东积分的均方值，并揭示其随步长 $h$ 的缩放规律，从而深刻理解为何这些高阶项对于实现高阶强收敛是不可或缺的。[@problem_id:2982843]", "problem": "考虑一个 $d$ 维标准 Wiener 过程 $W_{t} = \\big(W_{t}^{1},\\dots,W_{t}^{d}\\big)$，其分量相互独立，定义在一个满足通常条件的带滤概率空间上。对于固定的指标 $j,k,\\ell \\in \\{1,\\dots,d\\}$ 和步长 $h0$，定义三重迭代 Itô 积分\n$$\nI_{(j,k,\\ell)}(h) \\;=\\; \\int_{0}^{h} \\left( \\int_{0}^{s_{1}} \\left( \\int_{0}^{s_{2}} \\mathrm{d}W^{j}_{s_{3}} \\right) \\mathrm{d}W^{k}_{s_{2}} \\right) \\mathrm{d}W^{\\ell}_{s_{1}}.\n$$\n仅从 Wiener 过程的 Itô 积分的基本性质——即鞅性质和 Itô 等距性——出发，推导 $I_{(j,k,\\ell)}(h)$ 的主阶矩和其在 $h$ 中的标度，并确定这类三重 Wiener 积分是否被用于随机微分方程 (SDE) 的强 1.5 阶 Itô–Taylor 格式的分层指标集所接纳。具体来说：\n- 计算 $\\mathbb{E}\\!\\left[I_{(j,k,\\ell)}(h)\\right]$。\n- 精确计算 $\\mathbb{E}\\!\\left[I_{(j,k,\\ell)}(h)^{2}\\right]$ 作为 $h$ 的函数。\n- 从您的推导中，提取由 $\\mathbb{E}\\!\\left[I_{(j,k,\\ell)}(h)^{2}\\right] = C\\,h^{2\\alpha}$ 定义的均方标度指数 $\\alpha$，其中 $C$ 是一个与 $h$ 无关的常数。\n- 利用强 $p$ 阶格式保留其均方大小标度不快于 $h^{p}$ 的项这一原则，说明当 $p=1.5$ 时，$I_{(j,k,\\ell)}(h)$ 是否被保留。\n\n将您的最终答案表示为一个单行矩阵，其元素为 $\\big(\\mathbb{E}[I_{(j,k,\\ell)}(h)],\\,\\mathbb{E}[I_{(j,k,\\ell)}(h)^{2}],\\,\\alpha,\\,\\chi\\big)$，其中如果该项在强 1.5 阶格式中被保留，则 $\\chi=1$，否则 $\\chi=0$。无需四舍五入。", "solution": "该问题经验证是适定的、有科学依据且内部一致的。我们可以着手求解。\n\n该问题要求分析给定的三重迭代 Itô 积分\n$$\nI_{(j,k,\\ell)}(h) \\;=\\; \\int_{0}^{h} \\left( \\int_{0}^{s_{1}} \\left( \\int_{0}^{s_{2}} \\mathrm{d}W^{j}_{s_{3}} \\right) \\mathrm{d}W^{k}_{s_{2}} \\right) \\mathrm{d}W^{\\ell}_{s_{1}}\n$$\n其中步长为 $h0$，指标为 $j,k,\\ell \\in \\{1,\\dots,d\\}$。过程 $W_t = (W_t^1, \\dots, W_t^d)$ 是一个标准的 $d$ 维 Wiener 过程。我们将使用鞅性质和 Itô 等距性来推导所需的量。\n\n为清晰起见，我们逐步定义嵌套积分。\n设 $X_{s_2} = \\int_{0}^{s_{2}} \\mathrm{d}W^{j}_{s_{3}}$。由于被积函数为 $1$，这可简化为 $X_{s_2} = W^{j}_{s_{2}} - W^{j}_{0} = W^{j}_{s_{2}}$，因为 $W^{j}_{0} = 0$。\n设 $Y_{s_1} = \\int_{0}^{s_{1}} X_{s_2} \\mathrm{d}W^{k}_{s_{2}} = \\int_{0}^{s_{1}} W^{j}_{s_{2}} \\mathrm{d}W^{k}_{s_{2}}$。\n那么，完整的积分为 $I_{(j,k,\\ell)}(h) = \\int_{0}^{h} Y_{s_1} \\mathrm{d}W^{\\ell}_{s_{1}}$。\n\n**第 1 部分：计算 $\\mathbb{E}\\![I_{(j,k,\\ell)}(h)]$。**\n\n形式为 $M_t = \\int_0^t f(s,\\omega) dW_s$ 的 Itô 积分的一个关键性质是，如果被积函数 $f$ 是一个满足平方可积条件 $\\mathbb{E}[\\int_0^t f(s,\\omega)^2 ds]  \\infty$ 的适应过程，那么它就是一个鞅。如果 $M_t$ 是一个鞅，则对所有 $t \\ge 0$ 都有 $\\mathbb{E}[M_t] = \\mathbb{E}[M_0]$。\n\n我们来逐一考察积分的层次结构：\n1.  $X_t = W_t^j = \\int_0^t 1 \\, \\mathrm{d}W^j_s$。被积函数 $f(s)=1$ 是适应的，且 $\\mathbb{E}[\\int_0^t 1^2 ds] = t  \\infty$。$X_0=0$，因此 $\\mathbb{E}[X_t]=0$。\n\n2.  $Y_t = \\int_0^t W_s^j \\mathrm{d}W^k_s$。被积函数 $f(s) = W_s^j$ 是适应的。平方可积条件为 $\\mathbb{E}[\\int_0^t (W_s^j)^2 ds] = \\int_0^t \\mathbb{E}[(W_s^j)^2] ds = \\int_0^t s \\, ds = \\frac{t^2}{2}  \\infty$。因此，$Y_t$ 是一个鞅。由于 $Y_0 = 0$，我们有 $\\mathbb{E}[Y_t] = 0$。\n\n3.  $I_{(j,k,\\ell)}(t) = \\int_0^t Y_s \\mathrm{d}W^\\ell_s$。被积函数 $f(s) = Y_s$ 是适应的。平方可积性可通过对 $Y_s$ 使用 Itô 等距性来检验：\n    $\\mathbb{E}\\left[\\int_0^t Y_s^2 ds\\right] = \\int_0^t \\mathbb{E}[Y_s^2] ds$。\n    根据 Itô 等距性：$\\mathbb{E}[Y_s^2] = \\mathbb{E}[(\\int_0^s W_u^j dW_u^k)^2] = \\mathbb{E}[\\int_0^s (W_u^j)^2 du] = \\int_0^s \\mathbb{E}[(W_u^j)^2] du = \\int_0^s u \\, du = \\frac{s^2}{2}$。\n    所以，$\\mathbb{E}[\\int_0^t Y_s^2 ds] = \\int_0^t \\frac{s^2}{2} ds = \\frac{t^3}{6}  \\infty$。\n    因此，$I_{(j,k,\\ell)}(t)$ 是一个鞅。\n\n由于 $I_{(j,k,\\ell)}(t)$ 是一个鞅且 $I_{(j,k,\\ell)}(0) = 0$，其期望在所有时间都为零。对于 $t=h$：\n$$\n\\mathbb{E}\\![I_{(j,k,\\ell)}(h)] = 0.\n$$\n\n**第 2 部分：计算 $\\mathbb{E}\\![I_{(j,k,\\ell)}(h)^{2}]$。**\n\n由于 $I_{(j,k,\\ell)}(h)$ 是一个零均值随机变量，其二阶矩等于其方差。我们应用 Itô 等距性，该性质表明对于一个合适的适应过程 $f(s)$，有 $\\mathbb{E}[(\\int_0^h f(s) dW_s^\\ell)^2] = \\mathbb{E}[\\int_0^h f(s)^2 ds]$。\n在我们的例子中，被积函数是 $Y_{s_1} = \\int_{0}^{s_{1}} W^{j}_{s_{2}} \\mathrm{d}W^{k}_{s_{2}}$。\n$$\n\\mathbb{E}\\![I_{(j,k,\\ell)}(h)^{2}] = \\mathbb{E}\\left[\\left( \\int_{0}^{h} Y_{s_1} \\mathrm{d}W^{\\ell}_{s_{1}} \\right)^{2}\\right] = \\mathbb{E}\\left[\\int_{0}^{h} Y_{s_1}^{2} \\mathrm{d}s_{1}\\right].\n$$\n根据 Fubini 定理，我们可以交换期望和外层时间积分：\n$$\n\\mathbb{E}\\![I_{(j,k,\\ell)}(h)^{2}] = \\int_{0}^{h} \\mathbb{E}\\![Y_{s_1}^{2}] \\mathrm{d}s_{1}.\n$$\n现在我们必须计算 $\\mathbb{E}[Y_{s_1}^2]$。我们再次对 $Y_{s_1}$ 应用 Itô 等距性：\n$$\n\\mathbb{E}\\![Y_{s_1}^{2}] = \\mathbb{E}\\left[\\left( \\int_{0}^{s_{1}} W^{j}_{s_{2}} \\mathrm{d}W^{k}_{s_{2}} \\right)^{2}\\right] = \\mathbb{E}\\left[\\int_{0}^{s_{1}} (W^{j}_{s_{2}})^{2} \\mathrm{d}s_{2}\\right].\n$$\n再次，我们交换期望和积分：\n$$\n\\mathbb{E}\\![Y_{s_1}^{2}] = \\int_{0}^{s_{1}} \\mathbb{E}\\![(W^{j}_{s_{2}})^{2}] \\mathrm{d}s_{2}.\n$$\n对于标准 Wiener 过程的一个分量 $W^j$，我们有 $\\mathbb{E}[W^j_{s_2}] = 0$ 和 $\\text{Var}(W^j_{s_2}) = s_2$。因此，$\\mathbb{E}[(W^j_{s_2})^2] = s_2$。\n将此代入 $\\mathbb{E}[Y_{s_1}^2]$ 的表达式中：\n$$\n\\mathbb{E}\\![Y_{s_1}^{2}] = \\int_{0}^{s_{1}} s_{2} \\mathrm{d}s_{2} = \\frac{s_{1}^{2}}{2}.\n$$\n最后，我们将此结果代回到 $I_{(j,k,\\ell)}(h)$ 的二阶矩表达式中：\n$$\n\\mathbb{E}\\![I_{(j,k,\\ell)}(h)^{2}] = \\int_{0}^{h} \\frac{s_{1}^{2}}{2} \\mathrm{d}s_{1} = \\left[ \\frac{s_{1}^{3}}{6} \\right]_{0}^{h} = \\frac{h^{3}}{6}.\n$$\n此结果与指标 $j,k,\\ell$ 无关。\n\n**第 3 部分：确定标度指数 $\\alpha$。**\n\n问题通过关系式 $\\mathbb{E}[I_{(j,k,\\ell)}(h)^{2}] = C h^{2\\alpha}$ 定义了均方标度指数 $\\alpha$。\n根据我们的计算，我们有 $\\mathbb{E}[I_{(j,k,\\ell)}(h)^{2}] = \\frac{1}{6} h^{3}$。\n通过比较 $h$ 的指数，我们得到：\n$$\n2\\alpha = 3 \\implies \\alpha = \\frac{3}{2}.\n$$\n\n**第 4 部分：在强 1.5 阶格式中的保留。**\n\n问题为在强 $p$ 阶格式中保留一个项提供了标准：该项的“均方大小的标度不快于 $h^p$”。给定 $p=1.5$。\n我们所求项的均方大小为 $\\mathbb{E}[I_{(j,k,\\ell)}(h)^2] = \\frac{h^3}{6}$，其标度为 $O(h^3)$。\n对于小的 $h$，“标度不快于 $h^p$”这个短语可能存在歧义。让我们在 SDE 数值方法的既定背景下对其进行解释。如果 $\\lim_{h\\to 0} f(h)/g(h) = 0$，则称函数 $f(h)$ 比 $g(h)$ “更快”地趋于零。从这个意义上讲，$h^3$ 比 $h^{1.5}$ 更快地趋于零。如果这条规则被字面解释为“如果标度更快，就舍弃”，那么我们应该舍弃这一项。\n\n然而，这种解释与构建高阶 SDE 格式的基本原则相矛盾。一个格式要达到强收敛阶 $p$，其局部误差（在大小为 $h$ 的一步内的误差）在均方根意义下必须是 $O(h^{p+1/2})$。这意味着 Itô–Taylor 展开中首批被截断项的均方大小之和必须是 $O(h^{2(p+1/2)}) = O(h^{2p+1})$ 阶。\n对于 $p=1.5$，这个阈值是 $O(h^{2(1.5)+1}) = O(h^4)$。任何均方大小的阶数小于 4（即标度为 $h^k$ 且 $k  4$）的项都必须被包括进来。\n我们的项 $I_{(j,k,\\ell)}(h)$ 的均方大小标度为 $O(h^3)$。由于 $3  4$，这一项必须被保留。\n\n或者，一个更直接的方法是使用多重指标的阶数。一个具有多重指标 $\\alpha$ 的积分 $I_\\alpha$ 的（强）阶数是 $(\\ell(\\alpha) + n_0(\\alpha))/2$。对于 $I_{(j,k,\\ell)}$，指标是 $(j,k,\\ell)$，其长度 $\\ell=3$，$n_0=0$。因此，阶数是 $(3+0)/2 = 1.5$。一个强 $p$ 阶的格式需要包含所有阶数 $\\le p$ 的项。由于 $1.5 \\le 1.5$，该项必须被保留。\n因此，项 $I_{(j,k,\\ell)}(h)$ 被保留。我们设 $\\chi=1$。\n\n最终结果如下：\n- $\\mathbb{E}[I_{(j,k,\\ell)}(h)] = 0$\n- $\\mathbb{E}[I_{(j,k,\\ell)}(h)^{2}] = \\frac{h^3}{6}$\n- $\\alpha = \\frac{3}{2}$\n- 该项被保留，所以 $\\chi = 1$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} 0  \\frac{h^{3}}{6}  \\frac{3}{2}  1 \\end{pmatrix}\n}\n$$", "id": "2982843"}, {"introduction": "本节将理论与实践联系起来，探讨一个在实现强阶格式时至关重要的简化技巧。在许多高阶格式中都会出现形如 $I_{(j,j)}$ 的二重积分，但直接模拟它非常复杂。幸运的是，它可以通过布朗运动的增量 $\\Delta W^j$ 精确表示。本练习将挑战你从根本上理解，为什么这种精确替换对于强收敛是有效的，但对于高阶弱收敛格式却可能带来问题，从而阐明两种收敛准则之间的本质区别。[@problem_id:2982893]", "problem": "考虑一个由标准 $m$ 维布朗运动驱动的 $d$ 维随机微分方程，$dX_t = a(X_t)\\,dt + \\sum_{j=1}^m b_j(X_t)\\,dW_t^j$，其中 $a:\\mathbb{R}^d\\to\\mathbb{R}^d$ 和 $b_j:\\mathbb{R}^d\\to\\mathbb{R}^d$ 是足够光滑的，并满足标准生长条件和利普希茨条件，以确保强解的存在性。对于大小为 $h0$ 的时间步长，将布朗增量表示为 $\\Delta W^j = W_{t+h}^j - W_t^j$，并将迭代伊藤积分表示为 $I_{(j,k)}(h) = \\int_t^{t+h}\\int_t^{s_1} dW_{s_2}^k\\,dW_{s_1}^j$。在强阶最高为 $1.5$ 的伊藤-泰勒格式中，会出现形如 $I_{(j,j)}(h)$ 的项。\n\n一种常见的实现是在强伊藤-泰勒积分器中用 $\\tfrac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 替换 $I_{(j,j)}(h)$。相比之下，阶数超过 $1.5$ 的弱格式通常采用矩匹配代理来替代驱动噪声，其中每个 $\\Delta W^j$ 被一个非高斯随机变量替换，该变量具有一组预先设定的有限匹配矩。\n\n仅使用以下基本事实：\n- 伊藤积分和多重伊藤积分的定义，\n- 布朗运动的二次变差和针对 $f(x)=x^2$ 的伊藤公式，\n- 强阶（均方路径精度）和弱阶（对光滑测试函数的期望精度）的定义，\n- 以及弱泰勒展开的矩要求（驱动随机变量的联合矩必须在某个总阶内与布朗运动的联合矩相匹配），\n\n选择所有能正确解释为什么替换 $I_{(j,j)}(h)\\mapsto \\tfrac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 能保持强阶，但除非强制执行额外条件，否则可能无法在超过 $1.5$ 阶时保持弱阶的陈述。\n\nA. 对于真正的高斯布朗增量，连接 $I_{(j,j)}(h)$ 和 $\\Delta W^j$ 的恒等式可由伊藤公式和二次变差导出，因此用 $\\tfrac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 进行替换不会改变逐路径的局部截断误差，从而不会降低伊藤-泰勒格式的强阶。\n\nB. 在用只匹配有限个矩的非高斯代理替换 $\\Delta W^j$ 的弱格式中，将 $I_{(j,j)}(h)$ 定义为 $\\tfrac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 通常无法再现 $\\Delta W^j$ 和 $I_{(j,j)}(h)$ 之间所有总阶最高为 4 的必要联合矩，因此当目标阶数高于 $1.5$ 时，弱阶可能会下降。\n\nC. 该替换是无效的，因为在伊藤微积分中 $I_{(j,j)}(h)$ 与 $\\Delta W^j$ 是独立的；强加二次关系会引入伪相关性，并破坏强阶和弱阶。\n\nD. 弱阶仅取决于匹配 $\\mathbb{E}[\\Delta W^j]$ 和 $\\mathbb{E}[I_{(j,j)}(h)]$; 因此任何保持这些均值的替换都能保证任意弱阶。", "solution": "本题要求解释为什么替换 $I_{(j,j)}(h) \\mapsto \\frac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 对于强伊藤-泰勒格式是有效的，但对于高阶弱格式可能存在问题。我们将使用所提供的基本事实来分析这一点。\n\n首先，让我们为一个标准的一维布朗运动 $W_t$ 建立迭代伊藤积分 $I_{(j,j)}(h)$ 和布朗增量 $\\Delta W^j$ 之间的关系。为简单起见，我们省略索引 $j$。$W_t$ 的随机微分方程是 $dW_t = 0 \\cdot dt + 1 \\cdot dW_t$。\n我们将伊藤公式应用于函数 $f(x) = x^2$ 和过程 $X_t = W_t$。该公式为 $df(X_t) = f'(X_t) dX_t + \\frac{1}{2} f''(X_t) d\\langle X \\rangle_t$。\n对于 $f(x)=x^2$，我们有 $f'(x)=2x$ 和 $f''(x)=2$。布朗运动的二次变差是 $d\\langle W \\rangle_t = dt$。\n将这些代入伊藤公式得到：\n$$d(W_t^2) = 2W_t dW_t + \\frac{1}{2}(2)dt = 2W_t dW_t + dt$$\n将此随机微分从 $t$ 积分到 $t+h$：\n$$W_{t+h}^2 - W_t^2 = 2\\int_t^{t+h} W_s dW_s + \\int_t^{t+h} ds$$\n$$W_{t+h}^2 - W_t^2 = 2\\int_t^{t+h} W_s dW_s + h$$\n$\\int_t^{t+h} W_s dW_s$ 这一项可以使用伊藤积分的分部积分法展开，或者更直接地通过代入 $W_s = W_t + (W_s - W_t)$ 来展开：\n$$ \\int_t^{t+h} W_s dW_s = \\int_t^{t+h} (W_t + (W_s - W_t)) dW_s = W_t \\int_t^{t+h} dW_s + \\int_t^{t+h} (W_s - W_t) dW_s $$\n认识到 $W_s - W_t = \\int_t^s dW_u$ 并使用多重伊藤积分的定义，第二项是 $\\int_t^{t+h} \\int_t^s dW_u dW_s$，这正是第 $j$ 个分量的 $I_{(j,j)}(h)$。所以，对于单个分量：\n$$ \\int_t^{t+h} W_s dW_s = W_t (W_{t+h}-W_t) + \\int_t^{t+h} \\int_t^s dW_u dW_s = W_t \\Delta W + I_{(1,1)}(h) $$\n将此结果代回积分后的伊藤公式中：\n$$W_{t+h}^2 - W_t^2 = 2(W_t \\Delta W + I_{(1,1)}(h)) + h$$\n另一方面，我们可以将 $W_{t+h}^2 - W_t^2$ 在代数上写成：\n$$W_{t+h}^2 - W_t^2 = (W_t + \\Delta W)^2 - W_t^2 = W_t^2 + 2W_t \\Delta W + (\\Delta W)^2 - W_t^2 = 2W_t \\Delta W + (\\Delta W)^2$$\n令 $W_{t+h}^2 - W_t^2$ 的两个表达式相等：\n$$2W_t \\Delta W + (\\Delta W)^2 = 2W_t \\Delta W + 2I_{(1,1)}(h) + h$$\n$$(\\Delta W)^2 = 2I_{(1,1)}(h) + h$$\n解出迭代积分 $I_{(j,j)}(h)$（重新引入索引 $j$）：\n$$I_{(j,j)}(h) = \\frac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$$\n对于真实的布朗运动，这是一个精确的恒等式，而不是一个近似。\n\n现在我们评估每个选项。\n\n**A. 对于真正的高斯布朗增量，连接 $I_{(j,j)}(h)$ 和 $\\Delta W^j$ 的恒等式可由伊藤公式和二次变差导出，因此用 $\\tfrac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 进行替换不会改变逐路径的局部截断误差，从而不会降低伊藤-泰勒格式的强阶。**\n\n该陈述是正确的。我们上面的推导表明 $I_{(j,j)}(h) = \\frac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 是一个恒等式，是伊藤公式和布朗运动二次变差的直接推论。强收敛性关注解的逐路径逼近。由于对于布朗运动的任何给定路径，该替换都是一个精确的恒等式，因此在伊藤-泰勒展开中用 $\\frac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 替换 $I_{(j,j)}(h)$ 不会改变数值格式增量在给定布朗路径实现下的值。因此，该替换不影响格式的局部截断误差。由于强收敛阶数取决于局部截断误差的阶数，强阶得以保持。该陈述准确地描述了强格式的情况。**结论：正确。**\n\n**B. 在用只匹配有限个矩的非高斯代理替换 $\\Delta W^j$ 的弱格式中，将 $I_{(j,j)}(h)$ 定义为 $\\tfrac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 通常无法再现 $\\Delta W^j$ 和 $I_{(j,j)}(h)$ 之间所有 até 总阶为 $4$ 的必要联合矩，因此当目标阶数高于 $1.5$ 时，弱阶可能会下降。**\n\n该陈述是正确的。弱格式逼近期望值，要达到 $p$ 阶弱收敛，数值增量需要匹配真实增量的联合矩，直到总阶为 $2p$。对于超过 $1.5$ 的阶数（例如，弱阶 $p=2.0$），必须匹配总阶最高为 $2p=4$ 的矩。在弱格式中，$\\Delta W^j$ 通常被一个计算上更简便的非高斯随机变量（我们称之为 $\\tilde{W}^j$）所替代。当人们接着 *定义* 迭代积分的代理为 $\\tilde{I}_{(j,j)}(h) = \\frac{1}{2}\\big((\\tilde{W}^j)^2 - h\\big)$ 时，对偶 $(\\tilde{W}^j, \\tilde{I}_{(j,j)}(h))$ 的联合矩就完全由 $\\tilde{W}^j$ 自身的矩决定了。\n为了使这种方法有效，必须选择 $\\tilde{W}^j$ 使得所有由此产生的联合矩都与真实的联合矩相匹配。虽然可以构造一个 $\\tilde{W}^j$ 的代理（例如，一个特定的 3 点分布），使其对于 $2.0$ 阶弱收敛有效（即总阶最高为 $4$ 的矩），但一个适用于较低阶数的更简单、更“通用”的代理将会失败。例如，一个双点随机变量 $\\tilde{W}^j$ 满足 $\\mathbb{P}(\\tilde{W}^j = \\pm\\sqrt{h})=1/2$，它能匹配到 3 阶的矩（奇数阶矩为 $0$，$\\mathbb{E}[(\\tilde{W}^j)^2]=h$），但在四阶矩上失败了：$\\mathbb{E}[(\\tilde{W}^j)^4]=h^2$，而真正的高斯矩是 $3h^2$。这种差异导致更高阶的联合矩，如 $\\mathbb{E}[(\\tilde{I}_{(j,j)}(h))^2]$，变得不正确，从而阻止格式达到 $2.0$ 阶弱收敛。“通常无法”这个措辞准确地捕捉到这种方法不具有鲁棒性，需要特定、谨慎地选择代理变量。此外，即使使用一个对 $2.0$ 阶有效的代理，这种权宜的定义对于更高的阶数（例如 $3.0$ 阶，需要匹配总阶最高为 $6$ 的矩）也将失败，因为这种函数依赖关系过于僵化，无法满足不断扩大的矩条件集合。因此，该陈述正确地指出了高阶弱格式失败的机制。**结论：正确。**\n\n**C. 该替换是无效的，因为在伊藤微积分中 $I_{(j,j)}(h)$ 与 $\\Delta W^j$ 是独立的；强加二次关系会引入伪相关性，并破坏强阶和弱阶。**\n\n该陈述是错误的。其前提“$I_{(j,j)}(h)$ 与 $\\Delta W^j$ 是独立的”是错误的。正如恒等式 $I_{(j,j)}(h) = \\frac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 所示，$I_{(j,j)}(h)$ 是 $\\Delta W^j$ 的一个确定性函数，这是一种非常强的依赖形式。虽然它们是不相关的（$\\text{Cov}(\\Delta W^j, I_{(j,j)}(h)) = 0$），但它们不是独立的。该替换“破坏强阶和弱阶”的结论也是错误的。正如在选项 A 的分析中所解释的，它完美地保持了强阶。**结论：错误。**\n\n**D. 弱阶仅取决于匹配 $\\mathbb{E}[\\Delta W^j]$ 和 $\\mathbb{E}[I_{(j,j)}(h)]$; 因此任何保持这些均值的替换都能保证任意弱阶。**\n\n该陈述是错误的。这个前提是对弱收敛要求的严重简化。保持均值 $\\mathbb{E}[\\Delta W^j]=0$ 和 $\\mathbb{E}[I_{(j,j)}(h)]=0$ 是一个必要条件，但远非充分条件。要达到 $p$ 阶弱收敛，需要匹配数值增量（例如 $\\Delta W^j$, $I_{(j,k)}(h)$ 等）的一整个层次的联合矩，直到总阶为 $2p$。例如，即使是 $1.0$ 阶弱收敛也需要匹配二阶矩，如 $\\mathbb{E}[(\\Delta W^j)^2]=h$。声称仅匹配均值就能“保证任意弱阶”是显然错误的。**结论：错误。**", "answer": "$$\\boxed{AB}$$", "id": "2982893"}]}