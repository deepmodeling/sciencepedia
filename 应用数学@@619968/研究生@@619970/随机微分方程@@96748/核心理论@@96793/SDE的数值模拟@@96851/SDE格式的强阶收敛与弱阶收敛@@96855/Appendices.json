{"hands_on_practices": [{"introduction": "这项练习将为你提供一次基础性的实践体验，你需要在一个可解的多维场景中，为欧拉-丸山（Euler–Maruyama）格式推导显式的误差常数。通过将系统分解为独立的组成部分，你将直接观察到随机微分方程的参数如何影响强收敛和弱收敛误差，从而对这两种收敛准则建立具体的理解。[@problem_id:2998588]", "problem": "考虑$d$维伊藤随机微分方程（SDE）\n$$\n\\mathrm{d}X_t = M\\,X_t\\,\\mathrm{d}t + D\\,X_t\\,\\mathrm{d}W_t,\\qquad X_0 = x_0\\in\\mathbb{R}^d,\n$$\n其中$W_t$是具有独立分量的$d$维标准布朗运动，$M\\in\\mathbb{R}^{d\\times d}$和$D\\in\\mathbb{R}^{d\\times d}$是可交换且可同时对角化的确定性矩阵。在公共特征基中进行计算，因此\n$$\nM = \\mathrm{diag}(\\mu_1,\\dots,\\mu_d),\\qquad D = \\mathrm{diag}(\\sigma_1,\\dots,\\sigma_d),\n$$\n其中对于$i=1,\\dots,d$，有$\\mu_i\\in\\mathbb{R}$和$\\sigma_i\\in\\mathbb{R}$。设$T>0$为固定值，$\\{t_n\\}_{n=0}^N$是区间$[0,T]$上的一个均匀划分，步长为$h = T/N$且$N\\in\\mathbb{N}$。\n\n定义欧拉-丸山（EM）格式如下\n$$\nX_{n+1}^h = X_n^h + M\\,X_n^h\\,h + D\\,X_n^h\\,\\Delta W_n,\\qquad \\Delta W_n := W_{t_{n+1}}-W_{t_n},\n$$\n并用$X_T^h := X_N^h$表示终端EM近似值。对于强误差，通过渐近展开定义首项强均方误差常数$K_{\\mathrm{s}}$\n$$\n\\mathbb{E}\\big[\\,\\|X_T - X_T^h\\|^2\\,\\big] = K_{\\mathrm{s}}\\,h + o(h)\\quad\\text{as}\\quad h\\to 0,\n$$\n其中$\\|\\cdot\\|$是$\\mathbb{R}^d$上的欧几里得范数。对于弱误差，固定一个确定性向量$u\\in\\mathbb{R}^d$和线性泛函$\\varphi(x) = u^{\\top}x$，并定义首项弱误差常数$K_{\\mathrm{w}}$如下\n$$\n\\mathbb{E}\\big[\\,\\varphi(X_T^h)\\,\\big] - \\mathbb{E}\\big[\\,\\varphi(X_T)\\,\\big] = K_{\\mathrm{w}}\\,h + o(h)\\quad\\text{as}\\quad h\\to 0.\n$$\n\n仅从伊藤SDE、欧拉-丸山格式的核心定义以及独立高斯增量（包括其矩生成函数）的基本性质出发，推导$K_{\\mathrm{s}}$和$K_{\\mathrm{w}}$关于$T$、对角元$\\mu_i$、$\\sigma_i$、初始坐标$x_{0,i}$（$x_0$的分量）以及$u$的分量$u_i$的闭式解析表达式。明确验证维度$d$如何影响这些常数。你的最终答案必须是以单个闭式解析表达式形式给出的数对$(K_{\\mathrm{s}},K_{\\mathrm{w}})$。无需取整。", "solution": "该问题是适定的，并且具有科学依据。假设矩阵$M$和$D$可同时对角化，这使我们能够在一个基中工作，在该基下两者都是对角矩阵。这将$d$维随机微分方程（SDE）解耦为$d$个独立的标量SDE。设$X_t = (X_t^{(1)}, \\dots, X_t^{(d)})^{\\top}$和$x_0 = (x_{0,1}, \\dots, x_{0,d})^{\\top}$是在此公共特征基中的向量表示。对于每个分量$i \\in \\{1, \\dots, d\\}$，该SDE是一个几何布朗运动：\n$$\n\\mathrm{d}X_t^{(i)} = \\mu_i X_t^{(i)} \\mathrm{d}t + \\sigma_i X_t^{(i)} \\mathrm{d}W_t^{(i)}, \\qquad X_0^{(i)} = x_{0,i}\n$$\n其中$W_t^{(i)}$是独立的、一维的标准布朗运动。\n\n此标量SDE的精确解可以通过对$f(x) = \\ln(x)$使用伊藤引理求得。这得到：\n$$\nX_t^{(i)} = x_{0,i} \\exp\\left( (\\mu_i - \\frac{1}{2}\\sigma_i^2)t + \\sigma_i W_t^{(i)} \\right)\n$$\n类似地，欧拉-丸山（EM）格式按分量解耦：\n$$\nX_{n+1}^{h,(i)} = X_n^{h,(i)} (1 + \\mu_i h + \\sigma_i \\Delta W_n^{(i)})\n$$\n其中$X_0^{h,(i)} = x_{0,i}$且$\\Delta W_n^{(i)} = W_{t_{n+1}}^{(i)} - W_{t_n}^{(i)} \\sim \\mathcal{N}(0,h)$。EM近似的终端值通过将此关系迭代$N$次得到：\n$$\nX_T^{h,(i)} = X_N^{h,(i)} = x_{0,i} \\prod_{n=0}^{N-1} (1 + \\mu_i h + \\sigma_i \\Delta W_n^{(i)})\n$$\n\n### 强误差常数$K_{\\mathrm{s}}$的推导\n\n均方强误差定义为$\\mathbb{E}\\big[\\,\\|X_T - X_T^h\\|^2\\,\\big]$。由于问题是在一个标准正交特征基中提出的，欧几里得范数的平方是各分量平方的和。根据期望的线性和各分量的独立性：\n$$\n\\mathbb{E}\\big[\\,\\|X_T - X_T^h\\|^2\\,\\big] = \\mathbb{E}\\left[\\,\\sum_{i=1}^d (X_T^{(i)} - X_T^{h,(i)})^2\\,\\right] = \\sum_{i=1}^d \\mathbb{E}\\big[\\,(X_T^{(i)} - X_T^{h,(i)})^2\\,\\big]\n$$\n全局均方误差约等于时间网格上局部均方误差的总和。局部误差在区间$[0,T]$上累积。SDE数值分析的一个标准结果表明，EM格式的全局均方误差为$h$阶，对于区间$[0,T]$，它可以通过对局部误差的贡献进行积分来近似：\n$$\n\\mathbb{E}\\big[\\,(X_T^{(i)} - X_T^{h,(i)})^2\\,\\big] \\approx \\frac{1}{h} \\int_0^T \\mathbb{E}\\left[\\,\\left(X_{t+h}^{(i)} - \\tilde{X}_{t+h}^{(i)}\\right)^2\\,\\right] \\mathrm{d}t\n$$\n其中$\\tilde{X}_{t+h}^{(i)} = X_t^{(i)} (1 + \\mu_i h + \\sigma_i \\Delta W_t^{(i)})$是从精确解$X_t^{(i)}$出发的单步EM近似。项$\\mathbb{E}[\\dots]/h$表示单位时间的局部误差贡献。EM格式的局部强误差中的主导项来自于伊藤-泰勒展开中缺少与$\\int \\int \\mathrm{d}W \\mathrm{d}W$相关的项。对于第$i$个分量，这对应于米尔斯坦项。局部误差为$\\rho_t^{(i)} = X_{t+h}^{(i)} - \\tilde{X}_{t+h}^{(i)}$。使用伊藤-泰勒展开将精确解$X_{t+h}^{(i)}$在$X_t^{(i)}$附近展开得到：\n$$\nX_{t+h}^{(i)} - X_t^{(i)} = \\mu_i X_t^{(i)} h + \\sigma_i X_t^{(i)} \\Delta W_t^{(i)} + \\frac{1}{2}\\sigma_i^2 X_t^{(i)} ((\\Delta W_t^{(i)})^2-h) + \\text{higher order terms}\n$$\n单步EM增量为$\\tilde{X}_{t+h}^{(i)} - X_t^{(i)} = \\mu_i X_t^{(i)} h + \\sigma_i X_t^{(i)} \\Delta W_t^{(i)}$。因此，局部误差的首项是：\n$$\n\\rho_t^{(i)} \\approx \\frac{1}{2}\\sigma_i^2 X_t^{(i)} \\left( (\\Delta W_t^{(i)})^2 - h \\right)\n$$\n其平方的条件期望是：\n$$\n\\mathbb{E}\\big[\\,(\\rho_t^{(i)})^2 \\,|\\, \\mathcal{F}_t\\,\\big] \\approx \\frac{1}{4}\\sigma_i^4 (X_t^{(i)})^2 \\mathbb{E}\\big[\\,((\\Delta W_t^{(i)})^2-h)^2\\,\\big]\n$$\n对于一个随机变量$\\Delta W \\sim \\mathcal{N}(0,h)$，我们有$\\mathbb{E}[(\\Delta W)^2]=h$和$\\mathbb{E}[(\\Delta W)^4]=3h^2$。因此，\n$$\n\\mathbb{E}\\big[\\,((\\Delta W)^2-h)^2\\,\\big] = \\mathbb{E}[(\\Delta W)^4] - 2h\\mathbb{E}[(\\Delta W)^2] + h^2 = 3h^2 - 2h(h) + h^2 = 2h^2\n$$\n所以，$\\mathbb{E}\\big[\\,(\\rho_t^{(i)})^2 \\,|\\, \\mathcal{F}_t\\,\\big] \\approx \\frac{1}{4}\\sigma_i^4 (X_t^{(i)})^2 (2h^2) = \\frac{1}{2}\\sigma_i^4 (X_t^{(i)})^2 h^2$。\n全局误差常数是这些局部误差的累积。对$N=T/h$个步长求和，得到的总误差与$N \\times h^2 = (T/h)h^2 = Th$成正比。常数$K_s$可以通过将首项局部误差系数在$[0,T]$上积分得到：\n$$\nK_{\\mathrm{s}} = \\sum_{i=1}^d \\int_0^T \\frac{1}{2}\\sigma_i^4 \\mathbb{E}\\big[\\,(X_t^{(i)})^2\\,\\big] \\mathrm{d}t\n$$\n我们计算$\\mathbb{E}\\big[\\,(X_t^{(i)})^2\\,\\big]$。令$Z_t = (\\mu_i - \\frac{1}{2}\\sigma_i^2)t + \\sigma_i W_t^{(i)}$，它服从正态分布$Z_t \\sim \\mathcal{N}\\left((\\mu_i - \\frac{1}{2}\\sigma_i^2)t, \\sigma_i^2 t\\right)$。\n$$\n\\mathbb{E}\\big[\\,(X_t^{(i)})^2\\,\\big] = \\mathbb{E}\\big[\\,x_{0,i}^2 \\exp(2Z_t)\\,\\big] = x_{0,i}^2 \\mathbb{E}\\big[\\,\\exp(2Z_t)\\,\\big]\n$$\n这是$x_{0,i}^2$乘以$Z_t$在$2$处取值的矩生成函数。对于一个正态变量$Y \\sim \\mathcal{N}(m, s^2)$，有$\\mathbb{E}[\\exp(kY)] = \\exp(km + \\frac{1}{2}k^2s^2)$。\n$$\n\\mathbb{E}\\big[\\,\\exp(2Z_t)\\,\\big] = \\exp\\left(2(\\mu_i - \\frac{1}{2}\\sigma_i^2)t + \\frac{1}{2}(2^2)(\\sigma_i^2 t)\\right) = \\exp\\left((2\\mu_i - \\sigma_i^2)t + 2\\sigma_i^2 t\\right) = \\exp((2\\mu_i+\\sigma_i^2)t)\n$$\n因此，$\\mathbb{E}\\big[\\,(X_t^{(i)})^2\\,\\big] = x_{0,i}^2 \\exp((2\\mu_i+\\sigma_i^2)t)$。将此代入$K_{\\mathrm{s}}$的积分中：\n$$\nK_{\\mathrm{s}} = \\sum_{i=1}^d \\frac{1}{2}\\sigma_i^4 x_{0,i}^2 \\int_0^T \\exp((2\\mu_i+\\sigma_i^2)t) \\mathrm{d}t\n$$\n如果$2\\mu_i+\\sigma_i^2 \\neq 0$，积分为$\\frac{\\exp((2\\mu_i+\\sigma_i^2)T)-1}{2\\mu_i+\\sigma_i^2}$。如果$2\\mu_i+\\sigma_i^2=0$，积分结果为$T$。当$a \\to 0$时，表达式$\\frac{\\exp(aT)-1}{a} \\to T$，因此该公式是通用的。\n$$\nK_{\\mathrm{s}} = \\sum_{i=1}^d \\frac{1}{2}\\sigma_i^4 x_{0,i}^2 \\frac{\\exp((2\\mu_i+\\sigma_i^2)T) - 1}{2\\mu_i+\\sigma_i^2}\n$$\n\n### 弱误差常数$K_{\\mathrm{w}}$的推导\n\n弱误差是为线性泛函$\\varphi(x) = u^\\top x$定义的。根据期望的线性性：\n$$\n\\mathbb{E}[\\varphi(X_T^h)] - \\mathbb{E}[\\varphi(X_T)] = \\sum_{i=1}^d u_i \\left( \\mathbb{E}[X_T^{h,(i)}] - \\mathbb{E}[X_T^{(i)}] \\right)\n$$\n首先，我们求精确均值$\\mathbb{E}[X_T^{(i)}]$。对SDE取期望得到$\\mathrm{d}\\mathbb{E}[X_t^{(i)}] = \\mu_i \\mathbb{E}[X_t^{(i)}] \\mathrm{d}t$，从而得出$\\mathbb{E}[X_T^{(i)}] = x_{0,i} \\exp(\\mu_i T)$。\n\n接下来，我们求EM近似的均值$\\mathbb{E}[X_T^{h,(i)}]$。对EM格式取条件期望：\n$$\n\\mathbb{E}\\big[\\,X_{n+1}^{h,(i)}\\,\\big|\\,\\mathcal{F}_{t_n}\\big] = \\mathbb{E}\\big[\\,X_n^{h,(i)} (1 + \\mu_i h + \\sigma_i \\Delta W_n^{(i)})\\,\\big|\\,\\mathcal{F}_{t_n}\\big] = X_n^{h,(i)} (1+\\mu_i h)\n$$\n因为$\\mathbb{E}[\\Delta W_n^{(i)}] = 0$。取完全期望并从$n=0$开始迭代：\n$$\n\\mathbb{E}[X_N^{h,(i)}] = (1+\\mu_i h)^N x_{0,i}\n$$\n当$N = T/h$时，我们有$\\mathbb{E}[X_T^{h,(i)}] = x_{0,i} (1+\\mu_i h)^{T/h}$。我们关心当$h \\to 0$时的首项误差项。我们将$(1+\\mu_i h)^{T/h}$按$h$的幂次展开：\n$$\n(1+\\mu_i h)^{T/h} = \\exp\\left(\\frac{T}{h}\\ln(1+\\mu_i h)\\right)\n$$\n使用泰勒级数$\\ln(1+x) = x - \\frac{x^2}{2} + O(x^3)$：\n$$\n\\frac{T}{h} \\ln(1+\\mu_i h) = \\frac{T}{h} \\left(\\mu_i h - \\frac{1}{2}\\mu_i^2 h^2 + O(h^3)\\right) = \\mu_i T - \\frac{1}{2}\\mu_i^2 T h + O(h^2)\n$$\n现在，利用$\\exp(a+b) = \\exp(a)\\exp(b)$和$\\exp(x)=1+x+O(x^2)$，将此代回指数函数中：\n$$\n\\exp\\left(\\mu_i T - \\frac{1}{2}\\mu_i^2 T h + O(h^2)\\right) = \\exp(\\mu_i T) \\exp\\left(-\\frac{1}{2}\\mu_i^2 T h + O(h^2)\\right) = \\exp(\\mu_i T)\\left(1 - \\frac{1}{2}\\mu_i^2 T h + O(h^2)\\right)\n$$\n第$i$个分量的期望之差为：\n$$\n\\mathbb{E}[X_T^{h,(i)}] - \\mathbb{E}[X_T^{(i)}] = x_{0,i} \\left(\\exp(\\mu_i T)\\left(1 - \\frac{1}{2}\\mu_i^2 T h\\right) - \\exp(\\mu_i T) + O(h^2)\\right) = -\\frac{1}{2} x_{0,i} \\mu_i^2 T \\exp(\\mu_i T) h + O(h^2)\n$$\n对所有分量求和以得到总弱误差：\n$$\n\\mathbb{E}[\\varphi(X_T^h)] - \\mathbb{E}[\\varphi(X_T)] = \\sum_{i=1}^d u_i \\left( -\\frac{1}{2} x_{0,i} \\mu_i^2 T \\exp(\\mu_i T) h + O(h^2) \\right)\n$$\n$h$的系数就是弱误差常数$K_{\\mathrm{w}}$：\n$$\nK_{\\mathrm{w}} = -\\frac{T}{2} \\sum_{i=1}^d u_i x_{0,i} \\mu_i^2 \\exp(\\mu_i T)\n$$\n\n### 结论\n\n推导出的常数为：\n$K_{\\mathrm{s}} = \\sum_{i=1}^d \\frac{1}{2}\\sigma_i^4 x_{0,i}^2 \\frac{\\exp((2\\mu_i+\\sigma_i^2)T) - 1}{2\\mu_i+\\sigma_i^2}$\n$K_{\\mathrm{w}} = -\\frac{T}{2} \\sum_{i=1}^d u_i x_{0,i} \\mu_i^2 \\exp(\\mu_i T)$\n\n维度$d$仅作为求和项数出现在两个常数中。这是SDE系统解耦为$d$个独立的标量SDE的直接结果。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\displaystyle\\sum_{i=1}^d \\frac{1}{2}\\sigma_i^4 x_{0,i}^2 \\frac{\\exp((2\\mu_i+\\sigma_i^2)T) - 1}{2\\mu_i+\\sigma_i^2} & -\\frac{T}{2} \\displaystyle\\sum_{i=1}^d u_i x_{0,i} \\mu_i^2 \\exp(\\mu_i T) \\end{pmatrix}}\n$$", "id": "2998588"}, {"introduction": "在弱误差概念的基础上，本练习将挑战你比较经典的欧拉-丸山格式与一个更高阶的弱收敛格式。通过推导两者的弱误差系数，你将精确地看到更高阶格式中的附加项如何抵消了前者的主导误差项，从而实现更快的收敛速度。这个过程揭示了高阶弱收敛格式设计的核心思想。[@problem_id:2998612]", "problem": "考虑标量伊藤随机微分方程 (SDE)\n$$\n\\mathrm{d}X_{t} \\;=\\; \\lambda\\, X_{t}\\,\\mathrm{d}t \\;+\\; \\sigma\\,\\mathrm{d}W_{t}, \\qquad X_{0}=x_{0},\n$$\n其中常数 $\\lambda\\in\\mathbb{R}$，$\\sigma>0$，时间域为 $T>0$。令可观测量为光滑测试函数 $\\varphi:\\mathbb{R}\\to\\mathbb{R}$，定义为 $\\varphi(x)=x$。记 $X_{T}$ 为时间 $T$ 的精确解， $X_{T}^{h,\\mathrm{EM}}$ 和 $X_{T}^{h,\\mathrm{Pl}}$ 分别为单步 Euler–Maruyama 近似和 Platen 弱二阶近似，其计算采用均匀步长 $h=T/N$ 和 $N\\in\\mathbb{N}$ 步。\n\nEuler–Maruyama 步长格式为\n$$\nX_{n+1} \\;=\\; X_{n} \\;+\\; \\lambda\\,X_{n}\\,h \\;+\\; \\sigma\\,\\Delta W_{n},\n$$\n其中 $\\Delta W_{n}=W_{t_{n+1}}-W_{t_{n}}$ 是独立同分布的正态随机变量，均值为 $0$，方差为 $h$，且 $t_{n}=nh$。对于此加性噪声SDE，Platen 弱二阶步长格式为\n$$\nX_{n+1} \\;=\\; X_{n} \\;+\\; \\lambda\\,X_{n}\\,h \\;+\\; \\sigma\\,\\Delta W_{n} \\;+\\; \\tfrac{1}{2}\\lambda^{2}\\,X_{n}\\,h^{2}.\n$$\n\n定义 Talay–Tubaro 弱误差展开系数 $C_{1}^{\\mathrm{EM}}$ 和 $C_{2}^{\\mathrm{Pl}}$ 如下\n$$\n\\mathbb{E}\\big[\\varphi(X_{T}^{h,\\mathrm{EM}})\\big] \\;-\\; \\mathbb{E}\\big[\\varphi(X_{T})\\big] \\;=\\; C_{1}^{\\mathrm{EM}}\\,h \\;+\\; o(h),\n$$\n和\n$$\n\\mathbb{E}\\big[\\varphi(X_{T}^{h,\\mathrm{Pl}})\\big] \\;-\\; \\mathbb{E}\\big[\\varphi(X_{T})\\big] \\;=\\; C_{2}^{\\mathrm{Pl}}\\,h^{2} \\;+\\; o(h^{2}).\n$$\n\n仅从 SDE 的定义、维纳过程的性质以及上述两种数值步长公式出发，推导出 $C_{1}^{\\mathrm{EM}}$ 和 $C_{2}^{\\mathrm{Pl}}$ 作为 $\\lambda$、$\\sigma$、$T$ 和 $x_{0}$ 的函数的显式闭式表达式。你的最终答案必须是包含这两个系数的单一解析表达式，按 $\\big(C_{1}^{\\mathrm{EM}},\\,C_{2}^{\\mathrm{Pl}}\\big)$ 的顺序排列成一个行矩阵。无需四舍五入，也无需包含任何物理单位。", "solution": "目标是计算弱误差系数 $C_{1}^{\\mathrm{EM}}$ 和 $C_{2}^{\\mathrm{Pl}}$。由于可观测量为 $\\varphi(x)=x$，我们必须计算均值误差展开中的主阶项：$\\mathbb{E}[X_{T}^{h}] - \\mathbb{E}[X_{T}]$。\n\n**1. 精确解的期望**\n\n给定的 SDE 是一个形如 $\\mathrm{d}X_{t} = a(t)X_t \\mathrm{d}t + b(t) \\mathrm{d}W_t$ 的线性方程，其中 $a(t)=\\lambda$ 且 $b(t)=\\sigma$。从 $X_0=x_0$ 出发，在时间 $T$ 的精确解由下式给出：\n$$\nX_{T} = x_{0}\\exp(\\lambda T) + \\sigma \\int_{0}^{T} \\exp(\\lambda(T-s))\\,\\mathrm{d}W_{s}\n$$\n我们取期望以求得 $\\mathbb{E}[\\varphi(X_T)] = \\mathbb{E}[X_T]$。伊藤积分的期望为零，即 $\\mathbb{E}[\\int_{0}^{T} \\exp(\\lambda(T-s))\\,\\mathrm{d}W_{s}] = 0$。因此，精确解的期望为：\n$$\n\\mathbb{E}[X_{T}] = x_{0}\\exp(\\lambda T)\n$$\n\n**2. Euler–Maruyama 格式分析**\n\nEuler–Maruyama 格式由以下递推关系给出：\n$$\nX_{n+1} = X_{n} + \\lambda X_{n} h + \\sigma \\Delta W_{n} = (1+\\lambda h)X_{n} + \\sigma \\Delta W_{n}\n$$\n令 $m_{n}^{\\mathrm{EM}} = \\mathbb{E}[X_{n}]$。对递推式取期望，并利用 $\\mathbb{E}[\\Delta W_{n}]=0$，我们得到关于均值的递推关系：\n$$\nm_{n+1}^{\\mathrm{EM}} = (1+\\lambda h) m_{n}^{\\mathrm{EM}}\n$$\n在初始条件 $m_{0}^{\\mathrm{EM}} = \\mathbb{E}[X_{0}] = x_{0}$ 下，这是一个等比级数。经过 $N$ 步后，在时间 $T=Nh$ 处：\n$$\nm_{N}^{\\mathrm{EM}} = x_{0}(1+\\lambda h)^{N} = x_{0}\\left(1 + \\frac{\\lambda T}{N}\\right)^{N}\n$$\n为了找到弱误差，我们对这个表达式针对大的 $N$（即小的 $h=T/N$）进行展开。我们使用展开式 $\\ln(1+u) = u - u^{2}/2 + O(u^{3})$：\n$$\n\\left(1 + \\frac{\\lambda T}{N}\\right)^{N} = \\exp\\left(N \\ln\\left(1 + \\frac{\\lambda T}{N}\\right)\\right) = \\exp\\left(N\\left(\\frac{\\lambda T}{N} - \\frac{1}{2}\\left(\\frac{\\lambda T}{N}\\right)^{2} + O(N^{-3})\\right)\\right)\n$$\n$$\n= \\exp\\left(\\lambda T - \\frac{\\lambda^{2}T^{2}}{2N} + O(N^{-2})\\right) = \\exp(\\lambda T)\\exp\\left(-\\frac{\\lambda^{2}T^{2}}{2N} + O(N^{-2})\\right)\n$$\n使用展开式 $\\exp(v) = 1+v+O(v^{2})$ 并代入 $1/N = h/T$：\n$$\nm_{N}^{\\mathrm{EM}} = x_{0}\\exp(\\lambda T)\\left(1 - \\frac{\\lambda^{2}T^{2}}{2N} + O(N^{-2})\\right) = x_{0}\\exp(\\lambda T)\\left(1 - \\frac{\\lambda^{2}T^{2}}{2}\\frac{h}{T} + O(h^{2})\\right)\n$$\n$$\n\\mathbb{E}[X_{T}^{h,\\mathrm{EM}}] = x_{0}\\exp(\\lambda T) - \\frac{1}{2}x_{0}\\lambda^{2}T\\exp(\\lambda T)h + O(h^{2})\n$$\n因此弱误差为：\n$$\n\\mathbb{E}[X_{T}^{h,\\mathrm{EM}}] - \\mathbb{E}[X_{T}] = -\\frac{1}{2}x_{0}\\lambda^{2}T\\exp(\\lambda T)h + O(h^{2})\n$$\n根据定义，此表达式等于 $C_{1}^{\\mathrm{EM}}h + o(h)$。因此我们可以确定系数：\n$$\nC_{1}^{\\mathrm{EM}} = -\\frac{1}{2}x_{0}\\lambda^{2}T\\exp(\\lambda T)\n$$\n\n**3. Platen 格式分析**\n\n此 SDE 的 Platen 弱二阶格式由下式给出：\n$$\nX_{n+1} = X_{n} + \\lambda X_{n} h + \\sigma \\Delta W_{n} + \\frac{1}{2}\\lambda^{2}X_{n}h^{2} = \\left(1 + \\lambda h + \\frac{1}{2}\\lambda^{2}h^{2}\\right)X_{n} + \\sigma\\Delta W_{n}\n$$\n令 $m_{n}^{\\mathrm{Pl}} = \\mathbb{E}[X_{n}]$。取期望，我们得到递推关系：\n$$\nm_{n+1}^{\\mathrm{Pl}} = \\left(1 + \\lambda h + \\frac{1}{2}\\lambda^{2}h^{2}\\right) m_{n}^{\\mathrm{Pl}}\n$$\n在 $m_{0}^{\\mathrm{Pl}} = x_{0}$ 的条件下，经过 $N=T/h$ 步后的解是：\n$$\nm_{N}^{\\mathrm{Pl}} = x_{0}\\left(1 + \\lambda h + \\frac{1}{2}\\lambda^{2}h^{2}\\right)^{N} = x_{0}\\left(1 + \\frac{\\lambda T}{N} + \\frac{\\lambda^{2}T^{2}}{2N^{2}}\\right)^{N}\n$$\n我们对这个表达式针对大的 $N$ 进行展开。令 $u = \\frac{\\lambda T}{N} + \\frac{\\lambda^{2}T^{2}}{2N^{2}}$。我们使用展开式 $\\ln(1+u) = u - u^{2}/2 + u^{3}/3 - \\dots$ 并在对数内部保留到 $O(N^{-4})$ 的项：\n$$\nu^{2} = \\left(\\frac{\\lambda T}{N}\\right)^{2} + 2\\left(\\frac{\\lambda T}{N}\\right)\\left(\\frac{\\lambda^{2}T^{2}}{2N^{2}}\\right) + \\dots = \\frac{\\lambda^{2}T^{2}}{N^{2}} + \\frac{\\lambda^{3}T^{3}}{N^{3}} + O(N^{-4})\n$$\n$$\nu^{3} = \\left(\\frac{\\lambda T}{N}\\right)^{3} + \\dots = \\frac{\\lambda^{3}T^{3}}{N^{3}} + O(N^{-4})\n$$\n$$\n\\ln(1+u) = \\left(\\frac{\\lambda T}{N} + \\frac{\\lambda^{2}T^{2}}{2N^{2}}\\right) - \\frac{1}{2}\\left(\\frac{\\lambda^{2}T^{2}}{N^{2}} + \\frac{\\lambda^{3}T^{3}}{N^{3}}\\right) + \\frac{1}{3}\\left(\\frac{\\lambda^{3}T^{3}}{N^{3}}\\right) + O(N^{-4})\n$$\n按 $1/N$ 的幂次合并各项：\n$$\n\\ln(1+u) = \\frac{\\lambda T}{N} + \\left(\\frac{\\lambda^{2}T^{2}}{2} - \\frac{\\lambda^{2}T^{2}}{2}\\right)\\frac{1}{N^{2}} + \\left(-\\frac{\\lambda^{3}T^{3}}{2} + \\frac{\\lambda^{3}T^{3}}{3}\\right)\\frac{1}{N^{3}} + O(N^{-4}) = \\frac{\\lambda T}{N} - \\frac{\\lambda^{3}T^{3}}{6N^{3}} + O(N^{-4})\n$$\n现在，我们将此表达式进行 $N$ 次幂的指数运算：\n$$\nm_{N}^{\\mathrm{Pl}} = \\exp\\left(N \\ln(1+u)\\right) = x_{0}\\exp\\left(\\lambda T - \\frac{\\lambda^{3}T^{3}}{6N^{2}} + O(N^{-3})\\right)\n$$\n$$\nm_{N}^{\\mathrm{Pl}} = x_{0}\\exp(\\lambda T)\\exp\\left(-\\frac{\\lambda^{3}T^{3}}{6N^{2}} + O(N^{-3})\\right) = x_{0}\\exp(\\lambda T)\\left(1 - \\frac{\\lambda^{3}T^{3}}{6N^{2}} + O(N^{-3})\\right)\n$$\n代入 $1/N^{2} = h^{2}/T^{2}$：\n$$\n\\mathbb{E}[X_{T}^{h,\\mathrm{Pl}}] = x_{0}\\exp(\\lambda T) - x_{0}\\exp(\\lambda T)\\frac{\\lambda^{3}T^{3}}{6}\\frac{h^{2}}{T^{2}} + O(h^{3}) = x_{0}\\exp(\\lambda T) - \\frac{1}{6}x_{0}\\lambda^{3}T\\exp(\\lambda T)h^{2} + O(h^{3})\n$$\n弱误差为：\n$$\n\\mathbb{E}[X_{T}^{h,\\mathrm{Pl}}] - \\mathbb{E}[X_{T}] = -\\frac{1}{6}x_{0}\\lambda^{3}T\\exp(\\lambda T)h^{2} + O(h^{3})\n$$\n根据定义，这等于 $C_{2}^{\\mathrm{Pl}}h^{2} + o(h^{2})$，从而得到：\n$$\nC_{2}^{\\mathrm{Pl}} = -\\frac{1}{6}x_{0}\\lambda^{3}T\\exp(\\lambda T)\n$$\n\n因此，系数所需的表达式已推导得出。最终答案是数组 $(C_{1}^{\\mathrm{EM}},\\,C_{2}^{\\mathrm{Pl}})$。", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{2} x_{0} \\lambda^{2} T \\exp(\\lambda T) & -\\frac{1}{6} x_{0} \\lambda^{3} T \\exp(\\lambda T) \\end{pmatrix}}\n$$", "id": "2998612"}, {"introduction": "最后一个练习将探讨一个微妙但至关重要的方面：数值解在网格点之间的行为。在一个简单的随机微分方程上（其数值格式在节点上是精确的），你将研究不同的路径插值方法（分段常数与分段线性）如何引入各自的弱误差。这突出表明，对弱收敛的完整理解必须考虑整个模拟路径，而不仅仅是离散的时间点。[@problem_id:2998613]", "problem": "考虑随机微分方程 (SDE) $dX_t = \\sigma\\, dW_t$，其初始条件 $X_0 = x_0$ 是确定性的，其中 $W_t$ 是标准布朗运动，$\\sigma > 0$ 是一个常数扩散系数。设时间区间 $[0,T]$ 被 $t_k = kh$ 均匀划分，步长为 $h = T/N$，其中 $N$ 为某个正整数。由于系数是常数，Euler–Maruyama (EM) 格式生成的网格点值 $\\hat{X}_{t_k}$ 与精确过程值 $X_{t_k}$ 在分布上是一致的。\n\n固定一个网格点外的时间 $t \\in (t_k, t_{k+1})$，并将局部位置记为 $\\theta = (t - t_k)/h \\in (0,1)$。定义离散 EM 解在网格点之间的两种标准路径插值方法：\n- 分段常数插值：$\\hat{X}_t^{\\mathrm{pc}} := \\hat{X}_{t_k}$，\n- 分段线性插值：$\\hat{X}_t^{\\mathrm{lin}} := (1-\\theta)\\,\\hat{X}_{t_k} + \\theta\\,\\hat{X}_{t_{k+1}}$。\n\n对于测试函数 $\\varphi(x) = x^2$，将在时间 $t$ 的弱误差定义为偏差 $E[\\varphi(\\hat{X}_t)] - E[\\varphi(X_t)]$。根据布朗运动 $W_t$ 的定义性质（独立增量，$E[W_t]=0$ 以及 $E[(W_t - W_s)^2] = t-s$），推导当 $h \\to 0$ 且 $\\theta \\in (0,1)$ 固定时，两种插值的弱误差对 $h$ 的主阶依赖关系，并确定它们的主阶弱误差幅值的比率，该比率定义为\n$$\nR(\\theta) := \\frac{\\text{leading-order coefficient in } E[\\varphi(\\hat{X}_t^{\\mathrm{lin}})] - E[\\varphi(X_t)]}{\\text{leading-order coefficient in } E[\\varphi(\\hat{X}_t^{\\mathrm{pc}})] - E[\\varphi(X_t)]}.\n$$\n请以 $\\theta$ 的单一简化解析表达式的形式给出 $R(\\theta)$。最终答案无需四舍五入，也不应包含任何单位。", "solution": "目标是求出随机微分方程 (SDE) $dX_t = \\sigma\\, dW_t$ 数值解的两种不同插值的弱误差主阶系数的比率 $R(\\theta)$。测试函数为 $\\varphi(x) = x^2$。\n\n首先，我们确定精确量 $E[\\varphi(X_t)]$。具有确定性初始条件 $X_0 = x_0$ 的 SDE $dX_t = \\sigma\\, dW_t$ 的精确解为 $X_t = x_0 + \\sigma \\int_0^t dW_s = x_0 + \\sigma W_t$。\n已知 $W_t$ 是标准布朗运动，我们有 $E[W_t] = 0$ 和 $\\text{Var}(W_t) = E[W_t^2] = t$。\n随机变量 $X_t$ 服从正态分布，其均值为 $E[X_t] = E[x_0 + \\sigma W_t] = x_0 + \\sigma E[W_t] = x_0$。\n$X_t$ 的方差为 $\\text{Var}(X_t) = \\text{Var}(x_0 + \\sigma W_t) = \\sigma^2 \\text{Var}(W_t) = \\sigma^2 t$。\n测试函数 $\\varphi(X_t) = X_t^2$ 的期望值是 $X_t$ 的二阶矩，可以计算为 $E[X_t^2] = \\text{Var}(X_t) + (E[X_t])^2$。\n因此，精确值为：\n$$\nE[\\varphi(X_t)] = E[X_t^2] = \\sigma^2 t + x_0^2\n$$\n\n接下来，我们分析分段常数插值 $\\hat{X}_t^{\\mathrm{pc}} := \\hat{X}_{t_k}$，其中 $t \\in [t_k, t_{k+1})$。问题中说明，Euler-Maruyama 网格点值 $\\hat{X}_{t_k}$ 与精确过程值 $X_{t_k}$ 在分布上一致。这意味着 $E[\\varphi(\\hat{X}_t^{\\mathrm{pc}})] = E[(\\hat{X}_{t_k})^2]$ 的值与 $E[X_{t_k}^2]$ 的值相同。使用我们之前得到的在时间 $t_k$ 的精确期望结果：\n$$\nE[\\varphi(\\hat{X}_t^{\\mathrm{pc}})] = E[X_{t_k}^2] = \\sigma^2 t_k + x_0^2\n$$\n分段常数插值的弱误差是插值期望与时间 $t$ 处的精确期望之差：\n$$\nE[\\varphi(\\hat{X}_t^{\\mathrm{pc}})] - E[\\varphi(X_t)] = (\\sigma^2 t_k + x_0^2) - (\\sigma^2 t + x_0^2) = \\sigma^2(t_k - t)\n$$\n根据局部位置 $\\theta = (t-t_k)/h$，我们有 $t = t_k + \\theta h$，这意味着 $t_k - t = -\\theta h$。弱误差为：\n$$\nE[\\varphi(\\hat{X}_t^{\\mathrm{pc}})] - E[\\varphi(X_t)] = -\\sigma^2 \\theta h\n$$\n该误差是 $O(h)$ 阶的。主阶系数为 $-\\sigma^2 \\theta$。\n\n现在，我们分析分段线性插值 $\\hat{X}_t^{\\mathrm{lin}} := (1-\\theta)\\hat{X}_{t_k} + \\theta\\hat{X}_{t_{k+1}}$。\n同样，我们利用 $(\\hat{X}_{t_k}, \\hat{X}_{t_{k+1}})$ 的联合分布与 $(X_{t_k}, X_{t_{k+1}})$ 的联合分布相同的性质。因此，我们可以通过将数值近似替换为精确解变量来计算期望：\n$$\nE[\\varphi(\\hat{X}_t^{\\mathrm{lin}})] = E[((1-\\theta)X_{t_k} + \\theta X_{t_{k+1}})^2]\n$$\n代入 $X_{t} = x_0 + \\sigma W_{t}$：\n$$\nE[\\varphi(\\hat{X}_t^{\\mathrm{lin}})] = E[((1-\\theta)(x_0 + \\sigma W_{t_k}) + \\theta(x_0 + \\sigma W_{t_{k+1}}))^2] = E[(x_0 + \\sigma((1-\\theta)W_{t_k} + \\theta W_{t_{k+1}}))^2]\n$$\n令随机变量 $Y$ 为 $Y = (1-\\theta)W_{t_k} + \\theta W_{t_{k+1}}$。则期望为 $E[(x_0 + \\sigma Y)^2] = x_0^2 + 2x_0\\sigma E[Y] + \\sigma^2 E[Y^2]$。\nY 的均值为 $E[Y] = (1-\\theta)E[W_{t_k}] + \\theta E[W_{t_{k+1}}] = 0$。\n所以，我们需要计算 $E[Y^2]$：\n$$\nE[Y^2] = E[((1-\\theta)W_{t_k} + \\theta W_{t_{k+1}})^2] = (1-\\theta)^2 E[W_{t_k}^2] + \\theta^2 E[W_{t_{k+1}}^2] + 2\\theta(1-\\theta)E[W_{t_k}W_{t_{k+1}}]\n$$\n使用恒等式 $E[W_s^2]=s$ 和 $E[W_s W_u] = \\min(s, u)$，并注意到 $t_k < t_{k+1}$：\n$E[W_{t_k}^2] = t_k$。\n$E[W_{t_{k+1}}^2] = t_{k+1}$。\n$E[W_{t_k}W_{t_{k+1}}] = \\min(t_k, t_{k+1}) = t_k$。\n将这些结果代回：\n$$\nE[Y^2] = (1-\\theta)^2 t_k + \\theta^2 t_{k+1} + 2\\theta(1-\\theta)t_k = ((1-\\theta)^2 + 2\\theta(1-\\theta))t_k + \\theta^2 t_{k+1}\n$$\n化简 $t_k$ 的系数：$(1-2\\theta+\\theta^2) + (2\\theta-2\\theta^2) = 1-\\theta^2$。\n所以，$E[Y^2] = (1-\\theta^2)t_k + \\theta^2 t_{k+1}$。\n这就得到 $E[\\varphi(\\hat{X}_t^{\\mathrm{lin}})] = x_0^2 + \\sigma^2 ((1-\\theta^2)t_k + \\theta^2 t_{k+1})$。\n线性插值的弱误差为：\n$$\nE[\\varphi(\\hat{X}_t^{\\mathrm{lin}})] - E[\\varphi(X_t)] = (x_0^2 + \\sigma^2((1-\\theta^2)t_k + \\theta^2 t_{k+1})) - (x_0^2 + \\sigma^2 t) = \\sigma^2[(1-\\theta^2)t_k + \\theta^2 t_{k+1} - t]\n$$\n使用 $t_{k+1} = t_k+h$ 和 $t = t_k + \\theta h$：\n$$\n\\text{Error} = \\sigma^2[(1-\\theta^2)t_k + \\theta^2(t_k+h) - (t_k+\\theta h)] = \\sigma^2[t_k - \\theta^2 t_k + \\theta^2 t_k + \\theta^2 h - t_k - \\theta h] = \\sigma^2(\\theta^2 - \\theta)h\n$$\n该误差可以写成 $-\\sigma^2\\theta(1-\\theta)h$。这个误差是 $O(h)$ 阶的，主阶系数是 $-\\sigma^2\\theta(1-\\theta)$。\n\n最后，我们计算主阶系数的比率 $R(\\theta)$：\n$$\nR(\\theta) = \\frac{\\text{leading-order coefficient for } \\hat{X}_t^{\\mathrm{lin}}}{\\text{leading-order coefficient for } \\hat{X}_t^{\\mathrm{pc}}} = \\frac{-\\sigma^2\\theta(1-\\theta)}{-\\sigma^2\\theta}\n$$\n因为 $\\theta \\in (0,1)$，所以我们有 $\\theta \\neq 0$。同时，$\\sigma>0$。我们可以从分子和分母中消去项 $-\\sigma^2\\theta$：\n$$\nR(\\theta) = 1-\\theta\n$$", "answer": "$$\\boxed{1-\\theta}$$", "id": "2998613"}]}