{"hands_on_practices": [{"introduction": "理解任何数值方法的关键在于分析其在单步内产生的误差。本练习将引导你深入剖析最基础的欧拉-丸山（Euler-Maruyama, EM）格式的局部截断误差 [@problem_id:2998788]。通过将数值解的单步增量与真实解的伊东-泰勒（Itô-Taylor）展开进行比较，你将能够量化其误差，并识别出限制其收敛阶数的关键随机项。", "problem": "考虑以下 Itô 形式的标量随机微分方程 (SDE)\n$$\n\\mathrm{d}X_{t} \\;=\\; \\mu\\, X_{t}^{3}\\,\\mathrm{d}t \\;+\\; \\sigma\\, X_{t}^{2}\\,\\mathrm{d}W_{t},\n$$\n其中 $\\mu \\in \\mathbb{R}$ 和 $\\sigma \\in \\mathbb{R}$ 是常数，$\\{W_{t}\\}_{t \\ge 0}$ 是一个标准布朗运动。固定一个时间 $t \\ge 0$，并将精确状态表示为 $x := X_{t}$。对于大小为 $h > 0$ 的时间步长，在 $[t, t+h]$ 上的 Euler–Maruyama (EM) 增量为\n$$\nx \\;+\\; \\mu\\, x^{3}\\, h \\;+\\; \\sigma\\, x^{2}\\, \\Delta W,\n$$\n其中 $\\Delta W := W_{t+h} - W_{t}$。\n\n将单步局部截断误差（从精确状态开始的 EM 步的偏差）定义为\n$$\n\\tau_{h}(x) \\;:=\\; \\bigl(X_{t+h} - x\\bigr) \\;-\\; \\bigl(\\mu\\, x^{3}\\, h \\;+\\; \\sigma\\, x^{2}\\, \\Delta W\\bigr).\n$$\n\n从该 SDE 的积分形式出发，并使用第一性原理的 Itô 积分，通过比较精确增量与 EM 增量，在均方意义上识别 $\\tau_{h}(x)$ 的领头项。特别地，分离出 $\\tau_{h}(x)$ 中与 $((\\Delta W)^{2} - h)$ 成正比的贡献项，并确定其系数，该系数应为一个仅依赖于 $x$ 和 $\\sigma$ 的闭式解析表达式。\n\n您的最终答案必须是该系数的单一解析表达式。无需四舍五入，也不涉及任何单位。", "solution": "所述问题在数学上和科学上都是有效的。这是随机微分方程数值分析领域中一个适定问题，特别涉及 Euler-Maruyama 方法的局部截断误差。所有必要的定义和条件都已提供，没有矛盾或含糊之处。我们可以开始求解。\n\n该标量随机微分方程 (SDE) 的 Itô 形式为\n$$\n\\mathrm{d}X_{t} \\;=\\; \\mu\\, X_{t}^{3}\\,\\mathrm{d}t \\;+\\; \\sigma\\, X_{t}^{2}\\,\\mathrm{d}W_{t}.\n$$\n这对应于一般形式 $\\mathrm{d}X_t = a(X_t)\\mathrm{d}t + b(X_t)\\mathrm{d}W_t$，其漂移系数为 $a(x) = \\mu x^{3}$，扩散系数为 $b(x) = \\sigma x^{2}$。我们给定初始状态 $X_{t} = x$。\n\n单步局部截断误差 $\\tau_{h}(x)$ 定义为精确增量 $X_{t+h} - x$ 与时间步长 $h > 0$ 上的 Euler-Maruyama (EM) 增量之差：\n$$\n\\tau_{h}(x) \\;=\\; \\bigl(X_{t+h} - x\\bigr) \\;-\\; \\bigl(\\mu\\, x^{3}\\, h \\;+\\; \\sigma\\, x^{2}\\, \\Delta W\\bigr),\n$$\n其中 $\\Delta W = W_{t+h} - W_t$。\n\n为分析 $\\tau_{h}(x)$，我们首先使用 SDE 的积分形式来表示精确增量：\n$$\nX_{t+h} - x = \\int_{t}^{t+h} \\mu\\, X_{s}^{3}\\,\\mathrm{d}s + \\int_{t}^{t+h} \\sigma\\, X_{s}^{2}\\,\\mathrm{d}W_{s}.\n$$\n将此代入 $\\tau_{h}(x)$ 的定义中，并注意到 $\\mu x^3 = a(x)$ 和 $\\sigma x^2 = b(x)$，我们得到：\n$$\n\\tau_{h}(x) \\;=\\; \\left(\\int_{t}^{t+h} a(X_{s})\\,\\mathrm{d}s + \\int_{t}^{t+h} b(X_{s})\\,\\mathrm{d}W_{s}\\right) \\;-\\; \\bigl(a(x)\\,h \\;+\\; b(x)\\,\\Delta W\\bigr).\n$$\n由于 $h = \\int_t^{t+h} \\mathrm{d}s$ 且 $\\Delta W = \\int_t^{t+h} \\mathrm{d}W_s$，我们可以将误差重写为：\n$$\n\\tau_{h}(x) \\;=\\; \\int_{t}^{t+h} \\bigl(a(X_{s}) - a(x)\\bigr)\\,\\mathrm{d}s \\;+\\; \\int_{t}^{t+h} \\bigl(b(X_{s}) - b(x)\\bigr)\\,\\mathrm{d}W_{s}.\n$$\n为了找到 $\\tau_{h}(x)$ 的领头项，我们必须对 $s \\in [t, t+h]$ 的被积函数 $a(X_{s}) - a(x)$ 和 $b(X_{s}) - b(x)$ 进行展开。我们对函数 $b(X_s)$ 在点 $x = X_t$ 附近进行泰勒展开：\n$$\nb(X_{s}) = b(x) + b'(x)(X_{s}-x) + \\frac{1}{2}b''(x)(X_{s}-x)^{2} + \\dots\n$$\n其中 $b'(x)$ 和 $b''(x)$ 是 $b$ 对其自变量的一阶和二阶导数，在 $x$ 处求值。\n\n对于小的时间增量 $h$，过程 $X_s$ 不会偏离其初始值 $x$ 太远。在区间 $[t, s]$ 上，偏差 $X_s-x$ 的领头阶近似由 EM 增量本身给出：\n$$\nX_{s}-x \\approx a(x)(s-t) + b(x)(W_s - W_t).\n$$\n在均方意义上，此近似中的主导项是随机项 $b(x)(W_s - W_t)$，其阶数为 $(s-t)^{1/2}$，而确定性项的阶数为 $s-t$。\n\n让我们关注 $\\tau_h(x)$ 表达式中的第二个积分，因为指定形式的 Itô 积分源于此。\n$$\n\\int_{t}^{t+h} \\bigl(b(X_{s}) - b(x)\\bigr)\\,\\mathrm{d}W_{s} = \\int_{t}^{t+h} \\left( b'(x)(X_{s}-x) + \\frac{1}{2}b''(x)(X_{s}-x)^{2} + \\dots \\right)\\,\\mathrm{d}W_{s}.\n$$\n将领头阶近似 $X_s - x \\approx b(x)(W_s - W_t)$ 代入此展开的第一项得到：\n$$\n\\int_{t}^{t+h} b'(x)(X_{s}-x)\\,\\mathrm{d}W_{s} \\approx \\int_{t}^{t+h} b'(x) \\bigl( b(x)(W_s - W_t) \\bigr)\\,\\mathrm{d}W_{s} = b(x)b'(x) \\int_{t}^{t+h} (W_s - W_t)\\,\\mathrm{d}W_{s}.\n$$\nItô 积分 $\\int_{t}^{t+h} (W_s - W_t)\\,\\mathrm{d}W_{s}$ 是一个标准结果。它可以通过对函数 $f(w) = \\frac{1}{2}w^2$ 使用 Itô's lemma 来计算。让我们将 Itô's lemma 应用于 $f(W_s-W_t) = \\frac{1}{2}(W_s-W_t)^2$。\n那么 $\\mathrm{d}f = (W_s-W_t)\\mathrm{d}W_s + \\frac{1}{2}(1)\\mathrm{d}s$。从 $t$ 到 $t+h$ 积分得到：\n$$\n\\frac{1}{2}(W_{t+h}-W_t)^2 - \\frac{1}{2}(W_t-W_t)^2 = \\int_{t}^{t+h} (W_s - W_t)\\,\\mathrm{d}W_{s} + \\frac{1}{2}\\int_{t}^{t+h}\\mathrm{d}s.\n$$\n$$\n\\frac{1}{2}(\\Delta W)^2 = \\int_{t}^{t+h} (W_s - W_t)\\,\\mathrm{d}W_{s} + \\frac{1}{2}h.\n$$\n整理后得到恒等式：\n$$\n\\int_{t}^{t+h} (W_s - W_t)\\,\\mathrm{d}W_{s} = \\frac{1}{2}\\bigl( (\\Delta W)^2 - h \\bigr).\n$$\n因此，$\\tau_h(x)$ 展开中的相应项是：\n$$\nb(x)b'(x) \\cdot \\frac{1}{2}\\bigl( (\\Delta W)^2 - h \\bigr) = \\frac{1}{2}b(x)b'(x) \\bigl( (\\Delta W)^2 - h \\bigr).\n$$\n$\\tau_h(x)$ 展开中的其他项具有不同形式或更高阶。例如，积分 $\\int_t^{t+h} (a(X_s)-a(x))\\mathrm{d}s$ 产生与 $h^2$ 和迭代积分 $\\int_t^{t+h}(W_s-W_t)\\mathrm{d}s$ 成比例的项，这些项均不与 $((\\Delta W)^2-h)$ 成比例。$\\int (b(X_s)-b(x))\\mathrm{d}W_s$ 展开中的高阶项涉及不同的随机积分，例如 $\\int (W_s-W_t)^2 \\mathrm{d}W_s$，它们也不是所要求的形式。\n\n因此，$\\tau_{h}(x)$ 中与 $((\\Delta W)^{2} - h)$ 成比例的贡献项被唯一确定，其系数为 $\\frac{1}{2}b(x)b'(x)$。\n\n我们现在为该特定问题计算此系数。扩散系数为 $b(x) = \\sigma x^{2}$。它关于 $x$ 的导数是：\n$$\nb'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} (\\sigma x^{2}) = 2\\sigma x.\n$$\n将它们代入系数的表达式中得到：\n$$\n\\text{系数} = \\frac{1}{2}b(x)b'(x) = \\frac{1}{2}(\\sigma x^{2})(2\\sigma x) = \\sigma^{2}x^{3}.\n$$\n此表达式仅依赖于 $x$ 和 $\\sigma$，符合问题陈述的要求。常数 $\\mu$ 没有出现在局部误差的这个特定项中。", "answer": "$$ \\boxed{\\sigma^{2}x^{3}} $$", "id": "2998788"}, {"introduction": "一个好的数值格式不仅要单步误差小，还必须保证在长时间积分后解的行为是稳定的。本练习聚焦于均方稳定性——这是衡量数值解的二阶矩（方差）是否保持有界的关键概念 [@problem_id:2998813]。你将为米尔斯坦（Milstein）格式推导其稳定性函数，并分析它如何依赖于随机微分方程的参数和所选的时间步长，从而获得对数值方法长期行为的深刻理解。", "problem": "考虑由 $dX_{t} = \\lambda X_{t}\\,dt + \\mu X_{t}\\,dW_{t}$ 给出的带乘性噪声的标量线性随机微分方程 (SDE)，其中 $\\lambda \\in \\mathbb{R}$ 和 $\\mu \\in \\mathbb{R}$ 是常数，而 $W_{t}$ 是一个标准布朗运动 (BM)。令 $h > 0$ 为一个固定的时间步长，并定义离散时间 $t_{n} = n h$。该 SDE 的 Milstein 格式为\n$$\nX_{n+1} = X_{n} + \\lambda X_{n} h + \\mu X_{n} \\Delta W_{n} + \\frac{1}{2}\\mu^{2} X_{n}\\left(\\Delta W_{n}^{2} - h\\right),\n$$\n其中 $\\Delta W_{n} = W_{t_{n+1}} - W_{t_{n}}$ 是独立增量，满足 $\\Delta W_{n} \\sim \\mathcal{N}(0,h)$ 且与 $X_{n}$ 独立。\n\n定义 Milstein 格式在该测试方程上的均方稳定性函数 $R(\\lambda,\\mu,h)$ 为二阶矩在一步内被放大的因子，即\n$$\nR(\\lambda,\\mu,h) := \\frac{\\mathbb{E}\\!\\left[X_{n+1}^{2}\\right]}{\\mathbb{E}\\!\\left[X_{n}^{2}\\right]}。\n$$\n\n仅从 Milstein 格式的基本定义、布朗运动增量的性质（包括 $\\mathbb{E}[\\Delta W_{n}] = 0$、$\\mathbb{E}[\\Delta W_{n}^{2}] = h$、$\\mathbb{E}[\\Delta W_{n}^{3}] = 0$ 和 $\\mathbb{E}[\\Delta W_{n}^{4}] = 3 h^{2}$）以及 $\\Delta W_{n}$ 与 $X_{n}$ 的独立性出发，推导 $R(\\lambda,\\mu,h)$ 关于 $\\lambda$、$\\mu$ 和 $h$ 的闭式表达式。然后，基于你推导出的稳定性函数，解释参数 $\\lambda$ 和 $\\mu$ 如何影响小 $h$ 情况下的主阶均方稳定性，并将你的解释与强收敛的概念联系起来。\n\n请给出 $R(\\lambda,\\mu,h)$ 的最终表达式作为你的答案。不需要进行数值近似。", "solution": "我们从标量线性随机微分方程 $dX_{t} = \\lambda X_{t}\\,dt + \\mu X_{t}\\,dW_{t}$ 及其在步长为 $h > 0$ 的均匀网格上的 Milstein 离散化开始：\n$$\nX_{n+1} = X_{n} + \\lambda X_{n} h + \\mu X_{n} \\Delta W_{n} + \\frac{1}{2}\\mu^{2} X_{n}\\left(\\Delta W_{n}^{2} - h\\right),\n$$\n其中 $\\Delta W_{n} = W_{t_{n+1}} - W_{t_{n}}$ 是布朗运动的独立增量，满足 $\\Delta W_{n} \\sim \\mathcal{N}(0,h)$ 且与 $X_{n}$ 独立。\n\n为方便起见，我们提出因子 $X_{n}$ 并定义一个随机放大因子 $G_{n}$：\n$$\nX_{n+1} = G_{n} X_{n}, \\quad \\text{其中} \\quad G_{n} = 1 + \\lambda h + \\mu \\Delta W_{n} + \\frac{1}{2}\\mu^{2}\\left(\\Delta W_{n}^{2} - h\\right)。\n$$\n我们感兴趣的是均方稳定性函数\n$$\nR(\\lambda,\\mu,h) := \\frac{\\mathbb{E}\\!\\left[X_{n+1}^{2}\\right]}{\\mathbb{E}\\!\\left[X_{n}^{2}\\right]}。\n$$\n由于 $X_{n}$ 关于截至时间 $t_{n}$ 的σ-代数流是可测的，且 $\\Delta W_{n}$ 独立于该σ-代数流，我们有\n$$\n\\mathbb{E}\\!\\left[X_{n+1}^{2}\\right] = \\mathbb{E}\\!\\left[\\mathbb{E}\\!\\left[X_{n}^{2} G_{n}^{2} \\,\\middle|\\, \\mathcal{F}_{t_{n}} \\right]\\right] = \\mathbb{E}\\!\\left[X_{n}^{2}\\right] \\, \\mathbb{E}\\!\\left[G_{n}^{2}\\right]。\n$$\n因此，\n$$\nR(\\lambda,\\mu,h) = \\mathbb{E}\\!\\left[G_{n}^{2}\\right]。\n$$\n\n现在我们利用 $\\Delta W_{n}$ 的已知矩来计算 $\\mathbb{E}\\!\\left[G_{n}^{2}\\right]$。记 $Z := \\Delta W_{n}$，则 $Z \\sim \\mathcal{N}(0,h)$。那么\n$$\nG_{n} = 1 + \\lambda h + \\mu Z + \\frac{1}{2}\\mu^{2}\\left(Z^{2} - h\\right)。\n$$\n引入 $d := \\lambda - \\frac{1}{2}\\mu^{2}$ 并重写为\n$$\nG_{n} = \\left(1 + d h\\right) + \\mu Z + \\frac{1}{2}\\mu^{2} Z^{2}。\n$$\n设 $A := 1 + d h$，$B := \\mu Z$ 且 $C := \\frac{1}{2}\\mu^{2} Z^{2}$，则 $G_{n} = A + B + C$。于是\n$$\nG_{n}^{2} = A^{2} + B^{2} + C^{2} + 2 A B + 2 A C + 2 B C。\n$$\n我们使用对于 $Z \\sim \\mathcal{N}(0,h)$ 的高斯矩恒等式：\n$$\n\\mathbb{E}[Z] = 0, \\quad \\mathbb{E}[Z^{2}] = h, \\quad \\mathbb{E}[Z^{3}] = 0, \\quad \\mathbb{E}[Z^{4}] = 3 h^{2}。\n$$\n逐项取期望，\n- $\\mathbb{E}[A^{2}] = A^{2}$ 因为 $A$ 是确定性的，\n- $\\mathbb{E}[B^{2}] = \\mu^{2} \\mathbb{E}[Z^{2}] = \\mu^{2} h$，\n- $\\mathbb{E}[C^{2}] = \\frac{1}{4}\\mu^{4} \\mathbb{E}[Z^{4}] = \\frac{3}{4}\\mu^{4} h^{2}$，\n- $\\mathbb{E}[2 A B] = 2 A \\mu \\mathbb{E}[Z] = 0$，\n- $\\mathbb{E}[2 A C] = 2 A \\cdot \\frac{1}{2}\\mu^{2} \\mathbb{E}[Z^{2}] = A \\mu^{2} h$，\n- $\\mathbb{E}[2 B C] = \\mu^{3} \\mathbb{E}[Z^{3}] = 0$。\n\n因此，\n$$\n\\mathbb{E}\\!\\left[G_{n}^{2}\\right] = A^{2} + \\mu^{2} h + \\frac{3}{4}\\mu^{4} h^{2} + A \\mu^{2} h。\n$$\n代入 $A = 1 + d h$：\n$$\nA^{2} = \\left(1 + d h\\right)^{2} = 1 + 2 d h + d^{2} h^{2}, \\quad A \\mu^{2} h = \\mu^{2} h + \\mu^{2} d h^{2}。\n$$\n所以，\n$$\n\\mathbb{E}\\!\\left[G_{n}^{2}\\right] = \\left(1 + 2 d h + d^{2} h^{2}\\right) + \\mu^{2} h + \\frac{3}{4}\\mu^{4} h^{2} + \\mu^{2} h + \\mu^{2} d h^{2}。\n$$\n合并同类项得到\n$$\n\\mathbb{E}\\!\\left[G_{n}^{2}\\right] = 1 + \\left(2 d + 2 \\mu^{2}\\right) h + \\left(d^{2} + \\mu^{2} d + \\frac{3}{4}\\mu^{4}\\right) h^{2}。\n$$\n回顾 $d = \\lambda - \\frac{1}{2}\\mu^{2}$。线性项简化为\n$$\n2 d + 2 \\mu^{2} = 2\\lambda - \\mu^{2} + 2 \\mu^{2} = 2 \\lambda + \\mu^{2}。\n$$\n对于二次项，计算\n$$\nd^{2} + \\mu^{2} d = \\left(\\lambda - \\frac{1}{2}\\mu^{2}\\right)^{2} + \\mu^{2}\\left(\\lambda - \\frac{1}{2}\\mu^{2}\\right) = \\lambda^{2} - \\lambda \\mu^{2} + \\frac{1}{4}\\mu^{4} + \\lambda \\mu^{2} - \\frac{1}{2}\\mu^{4} = \\lambda^{2} - \\frac{1}{4}\\mu^{4}。\n$$\n再加上 $\\frac{3}{4}\\mu^{4}$ 得到\n$$\n\\lambda^{2} - \\frac{1}{4}\\mu^{4} + \\frac{3}{4}\\mu^{4} = \\lambda^{2} + \\frac{1}{2}\\mu^{4}。\n$$\n因此，\n$$\nR(\\lambda,\\mu,h) = \\mathbb{E}\\!\\left[G_{n}^{2}\\right] = 1 + \\left(2 \\lambda + \\mu^{2}\\right) h + \\left(\\lambda^{2} + \\frac{1}{2}\\mu^{4}\\right) h^{2}。\n$$\n\n我们现在分析参数依赖性并将其与强收敛联系起来。连续时间解的精确二阶矩增长满足\n$$\n\\mathbb{E}\\!\\left[X_{t+h}^{2} \\,\\middle|\\, X_{t}\\right] = X_{t}^{2} \\exp\\!\\left(\\left(2 \\lambda + \\mu^{2}\\right) h\\right),\n$$\n其对于小 $h$ 的泰勒展开是\n$$\n\\exp\\!\\left(\\left(2 \\lambda + \\mu^{2}\\right) h\\right) = 1 + \\left(2 \\lambda + \\mu^{2}\\right) h + \\frac{1}{2}\\left(2 \\lambda + \\mu^{2}\\right)^{2} h^{2} + \\mathcal{O}\\!\\left(h^{3}\\right)。\n$$\nMilstein 均方放大因子 $R(\\lambda,\\mu,h)$ 与精确展开式在直至线性项 $\\left(2 \\lambda + \\mu^{2}\\right) h$ 的部分相匹配，这反映了其强 1 阶的性质。$h^{2}$ 系数的偏差，也即 $\\lambda^{2} + \\frac{1}{2}\\mu^{4}$ 与 $\\frac{1}{2}\\left(2 \\lambda + \\mu^{2}\\right)^{2} = 2 \\lambda^{2} + 2 \\lambda \\mu^{2} + \\frac{1}{2}\\mu^{4}$ 的差异，刻画了不影响主阶强收敛但确实影响有限 $h$ 的精确均方稳定性边界的高阶差异。特别地，对于小的 $h$，主阶均方稳定性判据 $R(\\lambda,\\mu,h) < 1$ 简化为 $2 \\lambda + \\mu^{2} < 0$，这表明足够负的 $\\lambda$ 可以抵消乘性噪声 $\\mu$ 的不稳定效应，而更大的 $|\\mu|$ 则通过 $h$ 的线性和二次项增大了放大作用。", "answer": "$$\\boxed{1 + \\left(2 \\lambda + \\mu^{2}\\right) h + \\left(\\lambda^{2} + \\frac{1}{2}\\mu^{4}\\right) h^{2}}$$", "id": "2998813"}, {"introduction": "理论和实践的最终目标是评估数值方法在整个时间区间上的全局误差。本练习将展示如何从局部（单步）误差的阶数推断出全局收敛速度，这是随机微分方程（SDE）数值分析中的一个核心环节 [@problem_id:2998798]。你将分析一个更高级的随机龙格-库塔（Stochastic Runge-Kutta, SRK）方法，通过计算其局部强误差，最终确定其全局强收敛阶，从而将局部精度与整体性能联系起来。", "problem": "考虑标量 Itô 随机微分方程 $dX_{t} = \\lambda X_{t}\\,dt + \\mu X_{t}\\,dW_{t}$，其初始条件为 $X_{0} = x_{0}$，其中 $\\lambda \\in \\mathbb{R}$ 和 $\\mu \\in \\mathbb{R}$ 是常数，而 $W_{t}$ 是一个标准维纳过程。设 $h > 0$ 为一个固定的时间步长，$t_{n} = nh$，并记 $\\Delta W_{n} = W_{t_{n+1}} - W_{t_{n}}$。考虑以下由漂移 Butcher 表和扩散系数刻画的两步显式随机 Runge–Kutta (SRK) 方法：\n$$\n\\text{漂移表:}\\quad\n\\begin{array}{c|cc}\n0 & 0 & 0 \\\\\n1 & 1 & 0 \\\\\n\\hline\n & \\frac{1}{2} & \\frac{1}{2}\n\\end{array}\n\\qquad\n\\text{扩散项求值:}\\quad\n\\beta = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix},\\quad \\gamma = \\frac{1}{2}.\n$$\n分步 $Y_{n,1}$ 和 $Y_{n,2}$ 以及更新值 $X_{n+1}$ 定义如下\n$$\nY_{n,1} = X_{n},\\qquad\nY_{n,2} = X_{n} + f(Y_{n,1})\\,h + g(Y_{n,1})\\,\\Delta W_{n},\n$$\n$$\nX_{n+1} = X_{n} + \\frac{1}{2}\\big(f(Y_{n,1}) + f(Y_{n,2})\\big)\\,h + g(Y_{n,1})\\,\\Delta W_{n} + \\frac{1}{2}\\,g(Y_{n,1})\\,g'(Y_{n,1})\\big((\\Delta W_{n})^{2} - h\\big),\n$$\n其中 $f(x) = \\lambda x$ 是漂移项，$g(x) = \\mu x$ 是扩散项。\n\n(a) 使用精确解在 $t_{n}$ 附近的 Itô-Taylor 展开式，计算强单步局部误差，该误差定义为条件均方根误差\n$$\n\\Big(\\mathbb{E}\\big(|X_{t_{n+1}} - X_{n+1}|^{2}\\,\\big|\\,\\mathcal{F}_{t_{n}}\\big)\\Big)^{1/2},\n$$\n计算到当 $h \\to 0$ 时 $h$ 的主阶。将您的结果表示为渐近形式 $C(\\lambda,\\mu,X_{n})\\,h^{3/2} + o(h^{3/2})$，并给出通过计算得到的显式系数 $C(\\lambda,\\mu,X_{n})$。\n\n(b) 在保证矩稳定性的标准全局 Lipschitz 条件和线性增长条件下，根据计算出的局部误差和一个离散 Grönwall 型论证，推导出在固定时间区间 $[0,T]$ 上的全局强收敛阶 $p$。将您的最终答案报告为单个数字 $p$（无单位，无需四舍五入）。", "solution": "该问题被评估为有效的，因为它是随机微分方程数值分析领域中一个适定、自洽且标准的问题。它具有科学依据，并使用清晰、客观的语言。\n\n所考虑的随机微分方程 (SDE) 是几何布朗运动：\n$$dX_{t} = \\lambda X_{t}\\,dt + \\mu X_{t}\\,dW_{t}, \\quad X_{0} = x_{0}$$\n其漂移项为 $f(x) = \\lambda x$，扩散项为 $g(x) = \\mu x$。其导数为 $f'(x) = \\lambda$，$g'(x) = \\mu$，所有更高阶的导数均为零。\n\n给定的随机 Runge-Kutta (SRK) 方法由以下三个方程定义：\n$$Y_{n,1} = X_{n}$$\n$$Y_{n,2} = X_{n} + f(Y_{n,1})\\,h + g(Y_{n,1})\\,\\Delta W_{n}$$\n$$X_{n+1} = X_{n} + \\frac{1}{2}\\big(f(Y_{n,1}) + f(Y_{n,2})\\big)\\,h + g(Y_{n,1})\\,\\Delta W_{n} + \\frac{1}{2}\\,g(Y_{n,1})\\,g'(Y_{n,1})\\big((\\Delta W_{n})^{2} - h\\big)$$\n这是一个预测-校正格式，具体来说是强 1.0 阶的 Platen 格式。\n\n(a) 为了求出强单步局部误差，我们将数值解 $X_{n+1}$ 的Taylor展开与精确解 $X_{t_{n+1}}$ 在 $t_{n}$ 附近的 Itô-Taylor 展开进行比较，假设 $X_{n} = X_{t_{n}}$。\n\n首先，我们展开数值解 $X_{n+1}$。\n将 $Y_{n,1} = X_n$ 代入 $Y_{n,2}$ 的方程中：\n$$Y_{n,2} = X_{n} + f(X_{n})\\,h + g(X_{n})\\,\\Delta W_{n} = X_{n} + \\lambda X_{n}h + \\mu X_{n}\\Delta W_{n}$$\n因为 $f(x) = \\lambda x$ 是一个线性函数，我们有：\n$$f(Y_{n,2}) = \\lambda Y_{n,2} = \\lambda(X_{n} + \\lambda X_{n}h + \\mu X_{n}\\Delta W_{n}) = \\lambda X_{n} + \\lambda^2 X_{n}h + \\lambda\\mu X_{n}\\Delta W_{n}$$\n将此代入 $X_{n+1}$ 的公式中：\n$$X_{n+1} = X_{n} + \\frac{1}{2}\\big(\\lambda X_{n} + (\\lambda X_{n} + \\lambda^2 X_{n}h + \\lambda\\mu X_{n}\\Delta W_{n})\\big)h + \\mu X_{n}\\Delta W_{n} + \\frac{1}{2}(\\mu X_{n})(\\mu)\\big((\\Delta W_{n})^{2} - h\\big)$$\n$$X_{n+1} = X_{n} + \\frac{1}{2}\\big(2\\lambda X_{n} + \\lambda^2 X_{n}h + \\lambda\\mu X_{n}\\Delta W_{n}\\big)h + \\mu X_{n}\\Delta W_{n} + \\frac{1}{2}\\mu^2 X_{n}\\big((\\Delta W_{n})^{2} - h\\big)$$\n展开此表达式得到单步近似：\n$$X_{n+1} = X_{n} + \\lambda X_{n}h + \\frac{1}{2}\\lambda^2 X_{n}h^2 + \\frac{1}{2}\\lambda\\mu X_{n}h\\Delta W_{n} + \\mu X_{n}\\Delta W_{n} + \\frac{1}{2}\\mu^2 X_{n}\\big((\\Delta W_{n})^{2} - h\\big)$$\n为了清晰起见，我们可以重新组合这些项：\n$$X_{n+1} = X_{n} \\left( 1 + \\lambda h + \\frac{1}{2}\\lambda^2 h^2 \\right) + X_{n} \\left( \\mu + \\frac{1}{2}\\lambda\\mu h \\right)\\Delta W_{n} + X_{n} \\frac{1}{2}\\mu^2 \\left((\\Delta W_{n})^2 - h\\right)$$\n\n接下来，我们展开精确解。该 SDE 具有已知的解析解：\n$$X_{t} = X_{0} \\exp\\left(\\left(\\lambda - \\frac{1}{2}\\mu^2\\right)t + \\mu W_{t}\\right)$$\n所以，单步精确解为：\n$$X_{t_{n+1}} = X_{t_{n}} \\exp\\left(\\left(\\lambda - \\frac{1}{2}\\mu^2\\right)h + \\mu \\Delta W_{n}\\right)$$\n令 $X_n = X_{t_n}$ 且 $A = (\\lambda - \\frac{1}{2}\\mu^2)h + \\mu \\Delta W_{n}$。我们将 $\\exp(A)$ 展开，直到那些会对 $h^{3/2}$ 阶误差有贡献的项。\n$$X_{t_{n+1}} = X_{n} e^{A} = X_{n} \\left(1 + A + \\frac{A^2}{2} + \\frac{A^3}{6} + \\dots\\right)$$\n$A^k$ 展开式中的各项为：\n$$A = \\left(\\lambda - \\frac{1}{2}\\mu^2\\right)h + \\mu \\Delta W_{n}$$\n$$A^2 = \\left(\\lambda - \\frac{1}{2}\\mu^2\\right)^2 h^2 + 2\\mu\\left(\\lambda - \\frac{1}{2}\\mu^2\\right)h \\Delta W_{n} + \\mu^2 (\\Delta W_{n})^2$$\n$$A^3 = \\mu^3 (\\Delta W_{n})^3 + 3\\mu^2\\left(\\lambda - \\frac{1}{2}\\mu^2\\right)h (\\Delta W_{n})^2 + \\dots$$\n将这些代入 $X_{t_{n+1}}$ 的展开式，并收集具有相似随机阶的项（$\\Delta W_n \\sim h^{1/2}$）：\n$$X_{t_{n+1}} = X_{n} \\left( 1 + \\left(\\lambda - \\frac{1}{2}\\mu^2\\right)h + \\mu \\Delta W_{n} + \\frac{1}{2}A^2 + \\frac{1}{6}A^3 + \\dots \\right)$$\n该数值格式与 $h$、$\\Delta W_n$ 和 $(\\Delta W_n)^2 - h$ 的项相匹配。让我们用这些项来重新组合精确解的展开式。\n\\begin{align*}\nX_{t_{n+1}} = X_{n} [& 1 + \\lambda h + \\mu \\Delta W_{n} + \\frac{1}{2}\\mu^2\\left((\\Delta W_{n})^2 - h\\right) \\\\\n& + \\frac{1}{2}\\left(\\left(\\lambda - \\frac{1}{2}\\mu^2\\right)^2\\right)h^2 \\\\\n& + \\mu\\left(\\lambda - \\frac{1}{2}\\mu^2\\right)h \\Delta W_{n} \\\\\n& + \\frac{1}{6}\\mu^3 (\\Delta W_{n})^3 + \\text{h.o.t} \\bigg]\n\\end{align*}\n\n单步局部误差为 $E_n = X_{t_{n+1}} - X_{n+1}$。我们从 $X_{t_{n+1}}$ 的展开式中减去 $X_{n+1}$ 的展开式：\n$$E_n/X_{n} = \\left[\\lambda\\mu - \\frac{1}{2}\\mu^3 - \\frac{1}{2}\\lambda\\mu\\right]h\\Delta W_{n} + \\frac{1}{6}\\mu^3 (\\Delta W_{n})^3 + O(h^2)$$\n$$E_n = X_{n} \\left( \\left(\\frac{1}{2}\\lambda\\mu - \\frac{1}{2}\\mu^3\\right)h \\Delta W_n + \\frac{1}{6}\\mu^3 (\\Delta W_n)^3 \\right) + \\text{h.o.t.}$$\n局部误差的主导项的随机阶为 $h^{3/2}$。令 $K_1 = X_n(\\frac{1}{2}\\lambda\\mu - \\frac{1}{2}\\mu^3)$ 和 $K_2 = X_n\\frac{1}{6}\\mu^3$。\n为了求出均方根误差，我们计算 $|E_n|^2$ 的条件期望：\n$$\\mathbb{E}\\big[|E_n|^2 \\,\\big|\\, \\mathcal{F}_{t_n}\\big] \\approx \\mathbb{E}\\left[\\left(K_1 h\\Delta W_n + K_2 (\\Delta W_n)^3\\right)^2 \\,\\bigg|\\, \\mathcal{F}_{t_n}\\right]$$\n由于 $X_n$ 是 $\\mathcal{F}_{t_n}$-可测的，我们可以在期望计算中将 $K_1$ 和 $K_2$ 视为常数。\n$$\\mathbb{E}\\big[|E_n|^2 \\,\\big|\\, \\mathcal{F}_{t_n}\\big] \\approx K_1^2 h^2 \\mathbb{E}[(\\Delta W_n)^2] + K_2^2 \\mathbb{E}[(\\Delta W_n)^6] + 2K_1 K_2 h \\mathbb{E}[(\\Delta W_n)^4]$$\n使用正态随机变量 $\\Delta W_n \\sim N(0,h)$ 的矩：\n$\\mathbb{E}[(\\Delta W_n)^2] = h$\n$\\mathbb{E}[(\\Delta W_n)^4] = 3h^2$\n$\\mathbb{E}[(\\Delta W_n)^6] = 15h^3$\n代入这些值得到：\n$$\\mathbb{E}\\big[|E_n|^2 \\,\\big|\\, \\mathcal{F}_{t_n}\\big] \\approx K_1^2 h^3 + 15 K_2^2 h^3 + 6 K_1 K_2 h^3 = (K_1^2 + 15K_2^2 + 6K_1 K_2)h^3$$\n代入 $K_1$ 和 $K_2$ 的表达式：\n\\begin{align*}\nK_1^2 + 15K_2^2 + 6K_1K_2 &= X_n^2 \\left[ \\left(\\frac{1}{2}\\lambda\\mu - \\frac{1}{2}\\mu^3\\right)^2 + 15\\left(\\frac{1}{6}\\mu^3\\right)^2 + 6\\left(\\frac{1}{2}\\lambda\\mu - \\frac{1}{2}\\mu^3\\right)\\left(\\frac{1}{6}\\mu^3\\right) \\right] \\\\\n&= X_n^2 \\left[ \\left(\\frac{1}{4}\\lambda^2\\mu^2 - \\frac{1}{2}\\lambda\\mu^4 + \\frac{1}{4}\\mu^6\\right) + \\frac{15}{36}\\mu^6 + \\left(\\frac{1}{2}\\lambda\\mu^4 - \\frac{1}{2}\\mu^6\\right) \\right] \\\\\n&= X_n^2 \\left[ \\frac{1}{4}\\lambda^2\\mu^2 + \\left(\\frac{1}{4} + \\frac{5}{12} - \\frac{1}{2}\\right)\\mu^6 \\right] \\\\\n&= X_n^2 \\left[ \\frac{1}{4}\\lambda^2\\mu^2 + \\left(\\frac{3+5-6}{12}\\right)\\mu^6 \\right] \\\\\n&= X_n^2 \\left( \\frac{1}{4}\\lambda^2\\mu^2 + \\frac{1}{6}\\mu^6 \\right)\n\\end{align*}\n条件均方误差为：\n$$\\mathbb{E}\\big[|X_{t_{n+1}} - X_{n+1}|^2 \\,\\big|\\, \\mathcal{F}_{t_n}\\big] = X_n^2 \\left(\\frac{\\lambda^2\\mu^2}{4} + \\frac{\\mu^6}{6}\\right) h^3 + o(h^3)$$\n均方根误差是此表达式的平方根。\n$$ \\left(\\mathbb{E}\\big[|X_{t_{n+1}} - X_{n+1}|^2 \\,\\big|\\, \\mathcal{F}_{t_n}\\big]\\right)^{1/2} = |X_n| \\left(\\frac{\\lambda^2\\mu^2}{4} + \\frac{\\mu^6}{6}\\right)^{1/2} h^{3/2} + o(h^{3/2}) $$\n因此，系数 $C(\\lambda,\\mu,X_{n})$ 为：\n$$C(\\lambda,\\mu,X_{n}) = |X_{n}|\\sqrt{\\frac{\\lambda^2\\mu^2}{4} + \\frac{\\mu^6}{6}}$$\n\n(b) 全局强收敛阶 $p$ 由局部强误差阶决定。单步强局部误差是条件均方根误差，我们发现其阶为 $O(h^{3/2})$。指数为 $\\gamma_{loc} = 3/2 = 1.5$。\n对于单步数值方法，在固定区间 $[0,T]$ 上的全局强收敛阶 $p$ 与局部强误差阶 $\\gamma_{loc}$ 通过公式 $p = \\gamma_{loc} - 0.5$ 相关联。\n这种关系是通过离散 Grönwall 型论证建立的。第 $n+1$ 步的全局误差可以递归地表示为第 $n$ 步的全局误差和第 $n+1$ 步的局部误差。将 $N = T/h$ 个步骤的局部误差相加会导致误差的累积。格式的 Lipschitz 连续性确保了误差传播是受控的。对于阶为 $h^{\\gamma_{loc}}$ 的局部误差，全局误差累积到阶为 $N \\times h^{\\gamma_{loc}} = (T/h) \\times h^{\\gamma_{loc}} = T \\times h^{\\gamma_{loc}-1}$。然后，均方根误差（涉及对均方误差取平方根）的阶将为 $(h^{\\gamma_{loc}-1})^{1/2}$... 这个论证略有不精确。正确的归纳论证是：\n设 $e_n = X(t_n)-X_n$。\n$\\mathbb{E}[|e_{n+1}|^2] \\le (1+Kh)\\mathbb{E}[|e_n|^2] + C h^{2\\gamma_{loc}}$。\n从 $e_0=0$ 开始，对 $N=T/h$ 个步骤递归应用此式，得到 $\\mathbb{E}[|e_N|^2] \\le C' h^{2\\gamma_{loc}-1}$。\n取平方根，全局强误差为 $\\left(\\mathbb{E}[|e_N|^2]\\right)^{1/2} \\le O(h^{\\gamma_{loc}-0.5})$。\n当 $\\gamma_{loc} = 1.5$ 时，全局强收敛阶为 $p = 1.5 - 0.5 = 1$。", "answer": "$$\\boxed{1}$$", "id": "2998798"}]}