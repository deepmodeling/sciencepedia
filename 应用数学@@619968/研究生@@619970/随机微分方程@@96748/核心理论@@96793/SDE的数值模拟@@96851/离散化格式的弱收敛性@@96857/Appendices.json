{"hands_on_practices": [{"introduction": "要真正掌握弱收敛，最好的起点是通过一个基础案例进行直接计算。本练习将引导您分析应用在基本线性随机微分方程上的欧拉-丸山（Euler-Maruyama, EM）格式。通过从第一性原理出发，计算其期望值的精确表达式并进行泰勒展开，您将亲手推导出该格式的弱阶为1，并确定误差的主导项系数 [@problem_id:3005973]。这个过程不仅能巩固您对离散化格式和伊藤微积分的基本计算技巧，也为理解更复杂场景下的误差分析奠定了坚实的基础。", "problem": "考虑标量随机微分方程 (SDE) $$dX_{t}=\\lambda X_{t}\\,dt+\\sigma\\,dW_{t},\\qquad X_{0}\\in\\mathbb{R},$$ 其中 $\\lambda\\in\\mathbb{R}$，$\\sigma\\in\\mathbb{R}$ 是常数，$(W_{t})_{t\\geq 0}$ 是标准布朗运动。固定一个终端时间 $T>0$ 和一个均匀时间步长 $h>0$，其中 $N:=T/h\\in\\mathbb{N}$。定义 Euler–Maruyama (EM) 格式如下：$$X_{n+1}^{h}=X_{n}^{h}+\\lambda X_{n}^{h}\\,h+\\sigma\\,(W_{t_{n+1}}-W_{t_{n}}),\\qquad t_{n}=nh,\\quad n=0,1,\\dots,N-1,$$ 且 $X_{0}^{h}=X_{0}$。仅使用 Itô 积分的基本原理和随机积分期望的性质，完成以下操作：\n1. 推导 SDE 解的 $E[X_{T}]$ 和 EM 格式的 $E[X_{T}^{h}]$。\n2. 以 $\\lambda$、$\\sigma$、$T$、$h$ 和 $X_{0}$ 的函数形式，计算精确弱误差 $$\\left|E[X_{T}^{h}]-E[X_{T}]\\right|$$ 的闭式解。\n3. 通过在 $h\\to 0$ 时的严格渐近展开，证明弱误差为 $\\mathcal{O}(h)$，并找出领头阶常数 $C(\\lambda,T,X_{0})$，使得 $$\\left|E[X_{T}^{h}]-E[X_{T}]\\right|=C(\\lambda,T,X_{0})\\,h+o(h).$$\n\n你最终报告的答案必须是常数 $C(\\lambda,T,X_{0})$ 的单一闭式表达式。", "solution": "该问题陈述是随机微分方程数值方法分析中的一个有效练习。它具有科学依据，问题提法适定且客观。它包含了推导唯一解所需的所有必要信息，没有歧义或矛盾。\n\n分析按问题陈述的要求分三部分进行。\n\n**第1部分：$E[X_{T}]$ 和 $E[X_{T}^{h}]$ 的推导**\n\n首先，我们确定具有初始条件 $X_{0}$ 的 SDE $dX_{t}=\\lambda X_{t}\\,dt+\\sigma\\,dW_{t}$ 解的期望。将 SDE 从 $t=0$ 积分到 $t=T$ 得到其积分形式：\n$$X_{T} = X_{0} + \\int_{0}^{T} \\lambda X_{s}\\,ds + \\int_{0}^{T} \\sigma\\,dW_{s}$$\n取期望并利用期望算子的线性性质，我们得到：\n$$E[X_{T}] = E[X_{0}] + E\\left[\\int_{0}^{T} \\lambda X_{s}\\,ds\\right] + E\\left[\\int_{0}^{T} \\sigma\\,dW_{s}\\right]$$\n初始条件 $X_{0}$ 是一个确定性值（或一个独立于 $W_t$ 未来增量的随机变量，具有给定的均值），因此 $E[X_{0}] = X_{0}$。Itô 积分对于确定性被积函数（或一个适当的适应过程，如此处所是）的期望为零：\n$$E\\left[\\int_{0}^{T} \\sigma\\,dW_{s}\\right] = 0$$\n根据 Fubini 定理，我们可以交换期望和时间积分：\n$$E\\left[\\int_{0}^{T} \\lambda X_{s}\\,ds\\right] = \\int_{0}^{T} \\lambda E[X_{s}]\\,ds$$\n设 $m(t) := E[X_t]$。那么 $m(t)$ 满足以下积分方程：\n$$m(t) = X_{0} + \\int_{0}^{t} \\lambda m(s)\\,ds$$\n对 $t$ 求导得到常微分方程 (ODE)：\n$$\\frac{d}{dt}m(t) = \\lambda m(t)$$\n初始条件为 $m(0) = X_{0}$。该 ODE 的解为 $m(t) = X_{0}\\exp(\\lambda t)$。\n在终端时间 $T$ 时，期望为：\n$$E[X_{T}] = X_{0}\\exp(\\lambda T)$$\n\n接下来，我们分析 Euler–Maruyama (EM) 格式：\n$$X_{n+1}^{h}=X_{n}^{h}+\\lambda X_{n}^{h}\\,h+\\sigma\\,(W_{t_{n+1}}-W_{t_{n}})$$\n设 $m_{n} := E[X_{n}^{h}]$。对递推关系取期望：\n$$E[X_{n+1}^{h}] = E[X_{n}^{h} + \\lambda X_{n}^{h}\\,h] + E[\\sigma\\,(W_{t_{n+1}}-W_{t_{n}})]$$\n$$m_{n+1} = E[X_{n}^{h}] + \\lambda h E[X_{n}^{h}] + \\sigma E[W_{t_{n+1}}-W_{t_{n}}]$$\n标准布朗运动的增量 $W_{t_{n+1}}-W_{t_{n}}$ 均值为零，即 $E[W_{t_{n+1}}-W_{t_{n}}] = 0$。因此，我们得到均值的递推关系：\n$$m_{n+1} = m_{n} + \\lambda h m_{n} = (1+\\lambda h)m_{n}$$\n初始条件为 $m_{0} = E[X_{0}^{h}] = E[X_{0}] = X_{0}$。这个等比数列的解为：\n$$m_{n} = (1+\\lambda h)^{n}m_{0} = (1+\\lambda h)^{n}X_{0}$$\n我们关心的是终端时间 $T$ 时的期望，此时对应 $n=N=T/h$。\n$$E[X_{T}^{h}] = m_{N} = X_{0}(1+\\lambda h)^{N} = X_{0}(1+\\lambda h)^{T/h}$$\n\n**第2部分：精确弱误差**\n\n时间 $T$ 时的弱误差定义为数值解的期望与真实解的期望之间的绝对差。\n使用第1部分的结果，精确弱误差为：\n$$\\left|E[X_{T}^{h}]-E[X_{T}]\\right| = \\left|X_{0}(1+\\lambda h)^{T/h} - X_{0}\\exp(\\lambda T)\\right|$$\n这可以写成：\n$$\\left|E[X_{T}^{h}]-E[X_{T}]\\right| = |X_{0}| \\left| (1+\\lambda h)^{T/h} - \\exp(\\lambda T) \\right|$$\n这就是精确弱误差的闭式表达式。\n\n**第3部分：渐近展开和领头阶常数**\n\n为了分析当 $h \\to 0$ 时误差的行为，我们对项 $(1+\\lambda h)^{T/h}$ 进行渐近展开。我们使用恒等式 $a^b = \\exp(b \\ln a)$：\n$$(1+\\lambda h)^{T/h} = \\exp\\left(\\frac{T}{h}\\ln(1+\\lambda h)\\right)$$\n$\\ln(1+u)$ 在 $u=0$ 附近的泰勒级数展开为 $\\ln(1+u) = u - \\frac{u^{2}}{2} + \\mathcal{O}(u^{3})$。令 $u = \\lambda h$，我们得到：\n$$\\ln(1+\\lambda h) = \\lambda h - \\frac{(\\lambda h)^{2}}{2} + \\mathcal{O}(h^{3}) = \\lambda h - \\frac{\\lambda^{2}h^{2}}{2} + \\mathcal{O}(h^{3})$$\n将其代入指数中：\n$$\\frac{T}{h}\\ln(1+\\lambda h) = \\frac{T}{h}\\left(\\lambda h - \\frac{\\lambda^{2}h^{2}}{2} + \\mathcal{O}(h^{3})\\right) = T\\lambda - \\frac{T\\lambda^{2}h}{2} + \\mathcal{O}(h^{2})$$\n因此，$(1+\\lambda h)^{T/h}$ 的展开式为：\n$$(1+\\lambda h)^{T/h} = \\exp\\left(T\\lambda - \\frac{T\\lambda^{2}h}{2} + \\mathcal{O}(h^{2})\\right) = \\exp(T\\lambda)\\exp\\left(-\\frac{T\\lambda^{2}h}{2} + \\mathcal{O}(h^{2})\\right)$$\n对于小的 $v = -\\frac{T\\lambda^{2}h}{2} + \\mathcal{O}(h^{2})$，使用泰勒展开 $\\exp(v) = 1+v+\\mathcal{O}(v^{2})$：\n$$\\exp\\left(-\\frac{T\\lambda^{2}h}{2} + \\mathcal{O}(h^{2})\\right) = 1 - \\frac{T\\lambda^{2}h}{2} + \\mathcal{O}(h^{2})$$\n将所有部分整合起来，我们得到 $E[X_{T}^{h}]$ 的渐近展开式：\n$$E[X_{T}^{h}] = X_{0}(1+\\lambda h)^{T/h} = X_{0}\\exp(T\\lambda)\\left(1 - \\frac{T\\lambda^{2}h}{2} + \\mathcal{O}(h^{2})\\right) = X_{0}\\exp(T\\lambda) - \\frac{X_{0}T\\lambda^{2}\\exp(T\\lambda)}{2}h + \\mathcal{O}(h^{2})$$\n现在我们计算差值 $E[X_{T}^{h}]-E[X_{T}]$：\n$$E[X_{T}^{h}]-E[X_{T}] = \\left(X_{0}\\exp(T\\lambda) - \\frac{X_{0}T\\lambda^{2}\\exp(T\\lambda)}{2}h + \\mathcal{O}(h^{2})\\right) - X_{0}\\exp(T\\lambda)$$\n$$E[X_{T}^{h}]-E[X_{T}] = -\\frac{X_{0}T\\lambda^{2}\\exp(T\\lambda)}{2}h + \\mathcal{O}(h^{2})$$\n弱误差是这个量的绝对值：\n$$\\left|E[X_{T}^{h}]-E[X_{T}]\\right| = \\left|-\\frac{X_{0}T\\lambda^{2}\\exp(T\\lambda)}{2}h + \\mathcal{O}(h^{2})\\right|$$\n当 $h \\to 0$ 时，领头项占主导地位。因为 $T>0$，$\\lambda^{2}\\ge 0$ 且 $\\exp(T\\lambda)>0$，绝对值可以简化为：\n$$\\left|E[X_{T}^{h}]-E[X_{T}]\\right| = \\left|-\\frac{X_{0}T\\lambda^{2}\\exp(T\\lambda)}{2}\\right|h + o(h) = \\frac{|X_{0}|T\\lambda^{2}\\exp(T\\lambda)}{2}h + o(h)$$\n这表明弱误差的阶为 $\\mathcal{O}(h)$。领头阶常数 $C(\\lambda,T,X_{0})$ 是 $h$ 的系数：\n$$C(\\lambda,T,X_{0}) = \\frac{|X_{0}|T\\lambda^{2}\\exp(T\\lambda)}{2}$$\n如果 $\\lambda=0$，常数为 $0$，这是正确的，因为在这种情况下 EM 格式对于均值是精确的。对于这个线性 SDE，带有系数 $\\sigma$ 的噪声项的存在不影响弱误差，这从 $C(\\lambda,T,X_{0})$ 的最终表达式中可以反映出来。", "answer": "$$\\boxed{\\frac{|X_{0}| T \\lambda^{2} \\exp(\\lambda T)}{2}}$$", "id": "3005973"}, {"introduction": "在实践中，标准数值格式的局限性往往在非线性问题中显现。本练习通过一个带有超线性增长漂移项的典型随机微分方程，揭示了标准欧拉-丸山格式的一个严重缺陷：数值解的矩可能会发生爆炸，从而破坏弱收敛性。您将首先分析该方程平稳态下的性质，然后证明EM格式为何会失效，并最终展示一种称为“驯服欧拉法”（Tamed Euler Scheme）的现代修正技术如何通过控制漂移项的增长来恢复矩的有界性，并确保弱收敛 [@problem_id:3005951]。这个练习深刻地说明了，为保证数值方法的可靠性，必须仔细考虑随机微分方程本身的结构特性。", "problem": "考虑一维随机微分方程 (SDE)\n$$\ndX_{t} = -X_{t}^{3}\\,dt + \\sqrt{2}\\,dW_{t}, \\qquad X_{0} \\sim \\pi,\n$$\n其中 $W_{t}$ 表示标准布朗运动，初始条件 $X_{0}$ 根据该 SDE 的不变概率测度 $\\pi$ 分布。\n\n$\\pi$ 的不变密度 $\\varrho$ 由与该 SDE 相关的 Fokker–Planck 方程 (FPE) 的平稳解定义，在噪声强度为 $\\sqrt{2}$ 的过阻尼 Langevin 设定下，其形式为\n$$\n\\varrho(x) \\propto \\exp\\!\\big(-V(x)\\big), \\qquad V(x) = \\tfrac{1}{4}x^{4}.\n$$\n\n定义常数时间步长为 $h = T/N$ 且 $N \\in \\mathbb{N}$ 的 Euler–Maruyama (EM) 格式和驯服欧拉 (tamed Euler) 离散格式如下\n$$\nY_{n+1}^{\\mathrm{EM}} = Y_{n}^{\\mathrm{EM}} - h\\big(Y_{n}^{\\mathrm{EM}}\\big)^{3} + \\sqrt{2}\\,\\Delta W_{n}, \\qquad \\Delta W_{n} = W_{(n+1)h} - W_{nh},\n$$\n和\n$$\nY_{n+1}^{\\mathrm{tam}} = Y_{n}^{\\mathrm{tam}} + \\frac{-h\\big(Y_{n}^{\\mathrm{tam}}\\big)^{3}}{1 + h\\big|Y_{n}^{\\mathrm{tam}}\\big|^{3}} + \\sqrt{2}\\,\\Delta W_{n}.\n$$\n\n对于一个离散格式，其弱收敛性是指，对于至多具有多项式增长的、足够正则的检验函数 $\\varphi$，其近似满足\n$$\n\\big| \\mathbb{E}\\big[\\varphi\\big(Y_{N}\\big)\\big] - \\mathbb{E}\\big[\\varphi\\big(X_{T}\\big)\\big] \\big| \\to 0 \\quad \\text{as } h \\to 0,\n$$\n收敛速度由该格式的弱阶决定。\n\n任务：\n\n1) 仅使用过阻尼 Langevin 动力学不变测度的 Fokker–Planck 特征，确定此 SDE 的不变密度 $\\varrho(x)$，并写出 $\\varrho$ 的归一化形式。对于特定的检验函数 $\\varphi(x) = x^{2}$，计算精确的平稳期望 $\\mathbb{E}_{\\pi}[X^{2}]$，结果需表示为包含 Gamma 函数的封闭形式解析表达式。\n\n2) 证明当 EM 格式应用于此 SDE 时，其二阶矩在时间网格上当 $h \\to 0$ 时不存在一致界，即证明 $\\limsup_{N\\to\\infty}\\,\\mathbb{E}\\big[|Y_{N}^{\\mathrm{EM}}|^{2}\\big] = +\\infty$。使用基于大状态下 EM 递归的确定性部分和噪声增量的适当稀有事件构造的第一性原理论证，解释为什么会发生矩爆炸，以及为什么这会阻止检验函数 $\\varphi(x) = x^{2}$ 的弱收敛性。\n\n3) 证明对于相同的 SDE，驯服欧拉格式存在关于 $n$ 和 $h$ 的一致矩界，并由此推导出对于足够光滑的检验函数，该驯服格式是弱收敛的。您的推导应从离散时间动力学出发，利用驯服机制控制超线性漂移增量，并以单步局部弱误差论证作结。\n\n最后，给出您在任务1中得到的平稳二阶矩 $\\mathbb{E}_{\\pi}[X^{2}]$ 的精确解析表达式。不需要数值近似；请给出封闭形式的精确表达式。", "solution": "用户提供了一个关于一维随机微分方程 (SDE) 及其两种数值离散格式分析的多部分问题。该问题需要被验证，如果有效，则进行求解。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n*   **SDE**: $dX_{t} = -X_{t}^{3}\\,dt + \\sqrt{2}\\,dW_{t}$\n*   **初始条件**: $X_{0} \\sim \\pi$，其中 $\\pi$ 是不变概率测度。\n*   **不变密度**: $\\varrho(x) \\propto \\exp(-V(x))$，势函数为 $V(x) = \\frac{1}{4}x^{4}$。噪声强度为 $\\sqrt{2}$。这对应于过阻尼 Langevin 动力学 $dX_t = -\\nabla V(X_t) dt + \\sqrt{2\\beta^{-1}} dW_t$，其中 $\\nabla V(x) = x^3$ 且 $\\beta^{-1}=1$。\n*   **Euler–Maruyama (EM) 格式**: $Y_{n+1}^{\\mathrm{EM}} = Y_{n}^{\\mathrm{EM}} - h(Y_{n}^{\\mathrm{EM}})^{3} + \\sqrt{2}\\,\\Delta W_{n}$，其中 $\\Delta W_{n} = W_{(n+1)h} - W_{nh} = \\sqrt{h}Z_n$ 且 $Z_n \\sim \\mathcal{N}(0,1)$。\n*   **驯服欧拉 (Tamed Euler) 格式**: $Y_{n+1}^{\\mathrm{tam}} = Y_{n}^{\\mathrm{tam}} + \\frac{-h(Y_{n}^{\\mathrm{tam}})^{3}}{1 + h|(Y_{n}^{\\mathrm{tam}})|^{3}} + \\sqrt{2}\\,\\Delta W_{n}$。\n*   **弱收敛性定义**: 对于合适的检验函数 $\\varphi$，当 $h \\to 0$ 时，有 $|\\mathbb{E}[\\varphi(Y_N)] - \\mathbb{E}[\\varphi(X_T)]| \\to 0$，其中 $h=T/N$。\n*   **任务**:\n    1.  归一化不变密度 $\\varrho(x)$ 并计算平稳期望 $\\mathbb{E}_{\\pi}[X^{2}]$，结果用 Gamma 函数表示。\n    2.  证明 EM 格式的二阶矩不是一致有界的，即 $\\limsup_{N\\to\\infty}\\,\\mathbb{E}[|Y_{N}^{\\mathrm{EM}}|^{2}] = +\\infty$，并解释为何这对 $\\varphi(x) = x^{2}$ 的弱收敛性是无效的。\n    3.  证明驯服欧拉格式的一致矩界并推导出其弱收敛性。\n    4.  给出 $\\mathbb{E}_{\\pi}[X^{2}]$ 的最终封闭形式表达式。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n*   **科学依据**: 该问题属于随机微分方程及其数值近似的标准数学理论范畴。SDE、Fokker-Planck 方程、不变测度概念以及 Euler-Maruyama 和驯服欧拉格式都是该领域内公认的课题。所选的 SDE 具有超线性增长的漂移系数 $f(x) = -x^3$，是用于说明标准 EM 格式的缺点以及需要像驯服格式这样的改进格式的典型例子。\n*   **适定性**: 该问题清晰地划分为三个逻辑上相互关联的任务。这些任务是具体的，并且要求的输出有明确的定义。所要求的计算和证明是该数学领域的标准练习。\n*   **客观性**: 该问题以精确、客观的数学语言表述，没有歧义或主观内容。\n*   **自洽性与一致性**: 所有必要的定义和方程都已提供。势函数 $V(x)$ 与漂移 $-x^3$ 之间的关系与过阻尼 Langevin 动力学的物理原理相符。该问题内部一致，并包含求解所需的所有信息。\n\n**步骤 3：结论与行动**\n\n该问题是有效的。它是一个在 SDE 数值分析领域中表述清晰的标准问题。我将继续进行完整求解。\n\n### 解\n\n**任务 1：不变密度与平稳期望**\n\n不变概率密度 $\\varrho(x)$ 由题设可知正比于 $\\exp(-V(x))$，其中 $V(x) = \\frac{1}{4}x^4$。\n$$\n\\varrho(x) = \\frac{1}{C} \\exp\\!\\left(-\\frac{1}{4}x^{4}\\right)\n$$\n为了归一化该密度，我们必须计算归一化常数 $C = \\int_{-\\infty}^{\\infty} \\exp(-\\frac{1}{4}x^4) dx$。被积函数是偶函数，因此 $C = 2 \\int_{0}^{\\infty} \\exp(-\\frac{1}{4}x^4) dx$。\n\n我们进行变量替换。令 $u = \\frac{1}{4}x^4$。则 $x = (4u)^{1/4}$ 且 $dx = \\frac{1}{4}(4u)^{-3/4} \\cdot 4\\,du = (4u)^{-3/4}\\,du$。积分变为：\n$$\nC = 2 \\int_{0}^{\\infty} e^{-u} (4u)^{-3/4} du = 2 \\cdot 4^{-3/4} \\int_{0}^{\\infty} u^{-3/4} e^{-u} du\n$$\n剩下的积分是 Gamma 函数的定义，$\\Gamma(z) = \\int_{0}^{\\infty} t^{z-1}e^{-t}dt$。令 $z-1 = -3/4$，我们得到 $z=1/4$。\n$$\nC = 2 \\cdot (2^2)^{-3/4} \\Gamma\\left(\\frac{1}{4}\\right) = 2 \\cdot 2^{-3/2} \\Gamma\\left(\\frac{1}{4}\\right) = 2^{-1/2} \\Gamma\\left(\\frac{1}{4}\\right) = \\frac{\\Gamma(1/4)}{\\sqrt{2}}\n$$\n因此，归一化的不变密度为：\n$$\n\\varrho(x) = \\frac{\\sqrt{2}}{\\Gamma(1/4)} \\exp\\!\\left(-\\frac{1}{4}x^{4}\\right)\n$$\n接下来，我们为检验函数 $\\varphi(x) = x^2$ 计算平稳期望 $\\mathbb{E}_{\\pi}[X^2]$。\n$$\n\\mathbb{E}_{\\pi}[X^2] = \\int_{-\\infty}^{\\infty} x^2 \\varrho(x) dx = \\frac{\\sqrt{2}}{\\Gamma(1/4)} \\int_{-\\infty}^{\\infty} x^2 \\exp\\!\\left(-\\frac{1}{4}x^{4}\\right) dx\n$$\n同样，被积函数是偶函数，所以我们有：\n$$\n\\mathbb{E}_{\\pi}[X^2] = \\frac{2\\sqrt{2}}{\\Gamma(1/4)} \\int_{0}^{\\infty} x^2 \\exp\\!\\left(-\\frac{1}{4}x^{4}\\right) dx\n$$\n使用相同的变量替换 $u = \\frac{1}{4}x^4$，我们有 $x^2 = (4u)^{1/2} = 2u^{1/2}$ 且 $dx = (4u)^{-3/4}du$。积分变为：\n$$\n\\int_{0}^{\\infty} (2u^{1/2}) e^{-u} (4u)^{-3/4} du = 2 \\cdot 4^{-3/4} \\int_{0}^{\\infty} u^{1/2} u^{-3/4} e^{-u} du = 2 \\cdot 2^{-3/2} \\int_{0}^{\\infty} u^{-1/4} e^{-u} du\n$$\n该积分是 $\\Gamma(z)$，其中 $z-1=-1/4$，所以 $z=3/4$。\n$$\n\\int_{0}^{\\infty} x^2 \\exp\\!\\left(-\\frac{1}{4}x^{4}\\right) dx = 2^{-1/2} \\Gamma\\left(\\frac{3}{4}\\right) = \\frac{\\Gamma(3/4)}{\\sqrt{2}}\n$$\n将此结果代回期望的表达式中：\n$$\n\\mathbb{E}_{\\pi}[X^2] = \\frac{2\\sqrt{2}}{\\Gamma(1/4)} \\cdot \\frac{\\Gamma(3/4)}{\\sqrt{2}} = \\frac{2\\Gamma(3/4)}{\\Gamma(1/4)}\n$$\n\n**任务 2：Euler–Maruyama 格式的矩爆炸**\n\nEM 格式为 $Y_{n+1} = Y_n - h Y_n^3 + \\sqrt{2h} Z_n$，其中 $Z_n \\sim \\mathcal{N}(0,1)$。我们分析二阶矩的演化。给定 $Y_n$。\n$$\n\\mathbb{E}[|Y_{n+1}|^2 | Y_n] = \\mathbb{E}[ (Y_n - hY_n^3 + \\sqrt{2h}Z_n)^2 | Y_n ]\n$$\n$$\n= \\mathbb{E}[ (Y_n - hY_n^3)^2 + 2(Y_n - hY_n^3)\\sqrt{2h}Z_n + 2hZ_n^2 | Y_n ]\n$$\n使用 $\\mathbb{E}[Z_n]=0$ 和 $\\mathbb{E}[Z_n^2]=1$：\n$$\n\\mathbb{E}[|Y_{n+1}|^2 | Y_n] = (Y_n - hY_n^3)^2 + 2h = Y_n^2 - 2hY_n^4 + h^2Y_n^6 + 2h\n$$\nEM 映射的确定性部分是 $y \\mapsto y - hy^3 = y(1-hy^2)$。如果 $|y| > \\sqrt{2/h}$，则 $hy^2 > 2$，这意味着 $1-hy^2 < -1$。在这种情况下，下一步的模长 $|y(1-hy^2)| = |y||1-hy^2| > |y|$。对于大状态，确定性映射是不稳定的，导致它以更大的模长越过原点。\n\n这种离散化中的不稳定性导致了矩爆炸。对于任何固定的步长 $h>0$，噪声项 $\\sqrt{2h}Z_n$ 确保过程 $Y_n$ 将以概率 1 最终进入不稳定区域 $|Y_n| > \\sqrt{2/h}$。一旦进入该区域，单步矩展开中的项 $h^2Y_n^6$ 将占主导地位。我们来分析条件期望的增量：\n$$\n\\mathbb{E}[|Y_{n+1}|^2 | Y_n=y] - y^2 = h^2y^6 - 2hy^4 + 2h = h(hy^6 - 2y^4 + 2)\n$$\n对于大的 $|y|$，特别是当 $hy^2>2$ 时，项 $hy^6-2y^4$ 是正的并且会增长。这表明一旦过程达到一个大的模长状态，其二阶矩期望会增加，从而将其推向更大的状态。这种正反馈循环意味着，对于任何固定的 $h>0$，二阶矩序列 $\\mathbb{E}[|Y_n|^2]$ 当 $n \\to \\infty$ 时是无界的。也就是说，对于任何固定的 $h>0$，$\\lim_{n \\to \\infty} \\mathbb{E}[|Y_n|^2] = +\\infty$。由于这对任何 $h>0$ 都成立，其中 $h$ 固定的期望族 $\\{\\mathbb{E}[|Y_N|^2]\\}_{N \\in \\mathbb{N}}$ 是无界的。问题中的表述 $\\limsup_{N\\to\\infty}\\,\\mathbb{E}\\big[|Y_{N}^{\\mathrm{EM}}|^{2}\\big] = +\\infty$ 必须在对于任何固定离散步长 $h$ 其矩随时间发散的意义上进行解释。\n\n这种行为阻碍了像 $\\varphi(x)=x^2$ 这类检验函数的弱收敛性。证明弱收敛性的一个标准要求是矩的一致有界性，即存在一个与 $h$ 无关的常数 $K$，使得对于某个足够大的 $p$，有 $\\sup_{0 \\le n \\le N, h \\in (0,1]} \\mathbb{E}[|Y_n|^p] \\le K$。对于具有超线性漂移系数的 SDE，EM 格式违反了此条件。对于任何固定的 $h$，矩随时间发散的事实正是缺乏一致界的体现。因此，误差估计 $|\\mathbb{E}[\\varphi(Y_N)] - \\mathbb{E}[\\varphi(X_T)]|$ 无法被控制，弱收敛性失效。数值解没有继承真实解的长期稳定性，其二阶矩不会收敛到有限的平稳值 $\\mathbb{E}_{\\pi}[X^2]$。\n\n**任务 3：驯服格式的一致矩界和弱收敛性**\n\n驯服欧拉格式为 $Y_{n+1} = Y_n + g_h(Y_n) + \\sqrt{2h}Z_n$，其中 $g_h(y) = \\frac{-hy^3}{1+h|y|^3}$。驯服函数 $g_h(y)$ 的一个关键特征是其模长是全局有界的：\n$$\n|g_h(y)| = \\frac{h|y|^3}{1+h|y|^3}  \\frac{h|y|^3}{h|y|^3} = 1\n$$\n漂移增量上的这个一致界防止了困扰 EM 格式的大幅度过冲。我们来分析驯服格式的二阶矩演化。\n$$\n\\mathbb{E}[|Y_{n+1}|^2 | Y_n] = |Y_n + g_h(Y_n)|^2 + 2h = |Y_n|^2 + 2\\langle Y_n, g_h(Y_n)\\rangle + |g_h(Y_n)|^2 + 2h\n$$\n标量积提供了关键的耗散性：\n$$\n\\langle y, g_h(y) \\rangle = y \\cdot \\frac{-hy^3}{1+h|y|^3} = -\\frac{h|y|^4}{1+h|y|^3} \\le 0\n$$\n由于 $|g_h(y)|^2  1$，我们可以写出：\n$$\n\\mathbb{E}[|Y_{n+1}|^2 | Y_n=y] \\le y^2 - \\frac{2h|y|^4}{1+h|y|^3} + 1 + 2h\n$$\n当 $|y|$ 足够大时，负项将主导常数项并提供一种收缩效应。例如，如果 $|y|  1+3h$，则 $|y|  1+2h$，且 $\\frac{2h|y|^4}{1+h|y|^3} \\approx 2|y|$，这大于 $1+2h$。更形式化地，在某个足够大的紧集（与 $h \\in (0, 1]$ 无关）之外，$\\mathbb{E}[|Y_{n+1}|^2 | Y_n=y]  y^2$。这是一个 Lyapunov 型条件，它意味着矩是一致有界的。具体来说，可以证明存在常数 $\\gamma0$ 和 $C0$，使得 $\\mathbb{E}[|Y_{n+1}|^2 | Y_n=y] \\le (1-\\gamma h)|y|^2 + Ch$。取期望后，这导致 $\\mathbb{E}[|Y_n|^2] \\le \\max(\\mathbb{E}[|Y_0|^2], C/\\gamma)$，这是一个关于 $n$ 和 $h$ 的一致界。这个论证可以推广到所有 $p \\ge 2$ 的矩。\n\n建立了一致矩界后，就可以证明弱收敛性。论证基于分析单步弱误差：\n$$\nE_h(\\varphi, y) = \\mathbb{E}[\\varphi(Y_1)|Y_0=y] - \\mathbb{E}[\\varphi(X_h)|X_0=y]\n$$\n该 SDE 的生成元是 $\\mathcal{L} = -x^3\\frac{d}{dx} + \\frac{d^2}{dx^2}$。根据 Ito 引理，$\\mathbb{E}[\\varphi(X_h)|X_0=y] = \\varphi(y) + h(\\mathcal{L}\\varphi)(y) + O(h^2)$。对于驯服格式，Taylor 展开给出：\n$$\n\\mathbb{E}[\\varphi(Y_1)|Y_0=y] \\approx \\varphi(y) + \\varphi'(y)\\mathbb{E}[\\delta_y] + \\frac{1}{2}\\varphi''(y)\\mathbb{E}[\\delta_y^2]\n$$\n其中 $\\delta_y = g_h(y) + \\sqrt{2h}Z$。我们有 $\\mathbb{E}[\\delta_y] = g_h(y)$ 和 $\\mathbb{E}[\\delta_y^2] = |g_h(y)|^2 + 2h$。\n$$\n\\mathbb{E}[\\varphi(Y_1)|Y_0=y] \\approx \\varphi(y) + \\varphi'(y)g_h(y) + \\varphi''(y)h + \\frac{1}{2}\\varphi''(y)|g_h(y)|^2\n$$\n驯服漂移 $g_h(y)$ 是放缩后的 SDE 漂移 $-hy^3$ 的一个相合近似：\n$$\ng_h(y) = \\frac{-hy^3}{1+h|y|^3} = -hy^3 \\left(1 - \\frac{h|y|^3}{1+h|y|^3}\\right) = -hy^3 + O(h^2)\n$$\n将此代入展开式中，我们得到：\n$$\n\\mathbb{E}[\\varphi(Y_1)|Y_0=y] = \\varphi(y) + h(-y^3\\varphi'(y)+\\varphi''(y)) + O(h^2) = \\varphi(y) + h(\\mathcal{L}\\varphi)(y) + O(h^2)\n$$\n因此，局部弱误差为 $E_h(\\varphi, y) = O(h^2)$（对于足够光滑的 $\\varphi$）。全局弱误差通过伸缩求和得到：\n$$\n|\\mathbb{E}[\\varphi(Y_N)] - \\mathbb{E}[\\varphi(X_T)]| \\le \\sum_{n=0}^{N-1} |\\mathbb{E}[\\mathbb{E}[\\varphi(Y_{N-n})|Y_n] - \\mathbb{E}[\\varphi(X_{T-nh})|X_0=Y_n]]|\n$$\n一致矩界对于证明累积的局部误差（阶为 $N \\times O(h^2) = (T/h) \\times O(h^2) = O(h)$）导致阶为 $h$ 的全局误差至关重要。因此，驯服格式以 1 阶弱收敛。\n\n**最终答案**\n平稳二阶矩 $\\mathbb{E}_{\\pi}[X^{2}]$ 的精确解析表达式如下所示。", "answer": "$$\n\\boxed{\\frac{2\\Gamma\\left(\\frac{3}{4}\\right)}{\\Gamma\\left(\\frac{1}{4}\\right)}}\n$$", "id": "3005951"}, {"introduction": "除了直接计算误差，我们还可以运用更强大的分析工具来系统地洞察弱误差的结构，其中“修正方程”（Modified Equation）方法尤为重要。本练习将指导您运用这一思想，为欧拉-丸山格式构建一个修正的随机微分方程。这个修正方程的解在弱意义下能以更高精度逼近数值格式的单步演化，通过推导其修正项 $\\alpha(x)$ 与 $\\beta(x)$，您可以从一个全新视角理解数值误差的来源 [@problem_id:3005959]。掌握此方法将使您能够对更广泛的数值格式进行深入的弱收敛分析，是高级随机数值分析的核心技能之一。", "problem": "考虑标量 Itô 随机微分方程 (SDE)\n$$\n\\mathrm{d}X_{t} = a(X_{t})\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t},\n$$\n其中 $a:\\mathbb{R}\\to\\mathbb{R}$ 是一个具有有界导数的四次连续可微函数，$\\sigma0$ 是一个常数，而 $W_{t}$ 是一个标准 Wiener 过程。令 $\\varphi:\\mathbb{R}\\to\\mathbb{R}$ 是一个具有有界导数的六次连续可微函数。定义步长为 $h0$ 的 Euler–Maruyama 时间离散化格式为\n$$\nX_{n+1} = X_{n} + a(X_{n})\\,h + \\sigma\\,\\Delta W_{n},\n$$\n其中 $\\Delta W_{n}\\sim\\mathcal{N}(0,h)$ 是独立同分布的增量。引入一个修正的 SDE\n$$\n\\mathrm{d}\\widetilde{X}_{t} = \\widetilde{a}_{h}(\\widetilde{X}_{t})\\,\\mathrm{d}t + \\widetilde{b}_{h}(\\widetilde{X}_{t})\\,\\mathrm{d}W_{t},\n$$\n其系数依赖于步长 $h$，形式如下\n$$\n\\widetilde{a}_{h}(x) = a(x) + h\\,\\alpha(x), \n\\qquad \n\\widetilde{b}_{h}(x) = \\sigma + h\\,\\beta(x),\n$$\n对于未知的修正函数 $\\alpha,\\beta:\\mathbb{R}\\to\\mathbb{R}$。要求是，对于每一个这样的测试函数 $\\varphi$，修正后 SDE 的条件单步弱展开满足\n$$\n\\mathbb{E}\\big[\\varphi(\\widetilde{X}_{t+h}) \\,\\big|\\, \\widetilde{X}_{t}=x\\big] = \\mathbb{E}\\big[\\varphi(X_{n+1}) \\,\\big|\\, X_{n}=x\\big] + \\mathcal{O}(h^{3}),\n$$\n且展开式在直到并包含 $h^{2}$ 阶的项上相等。从扩散过程的 Kolmogorov 后向算子的定义和 Itô 公式出发，推导修正函数 $\\alpha(x)$ 和 $\\beta(x)$ 的显式解析表达式，以在常数扩散振幅 $\\sigma$ 的情况下实现这种匹配。请用一个解析表达式给出 $\\alpha(x)$ 和 $\\beta(x)$ 作为最终答案。", "solution": "问题要求我们找到修正的 Itô 随机微分方程 (SDE) 的修正函数 $\\alpha(x)$ 和 $\\beta(x)$，使得其单步条件期望与原始 SDE 的 Euler-Maruyama 离散化的期望相匹配，直到并包含 $h^2$ 阶项。\n\n原始 SDE 为：\n$$\n\\mathrm{d}X_{t} = a(X_{t})\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t}\n$$\n从 $X_n=x$ 开始，步长为 $h$ 的 Euler-Maruyama 离散化格式为：\n$$\nX_{n+1} = x + a(x)h + \\sigma \\Delta W_n, \\quad \\text{其中} \\quad \\Delta W_n \\sim \\mathcal{N}(0,h)\n$$\n修正后的 SDE 为：\n$$\n\\mathrm{d}\\widetilde{X}_{t} = \\widetilde{a}_{h}(\\widetilde{X}_{t})\\,\\mathrm{d}t + \\widetilde{b}_{h}(\\widetilde{X}_{t})\\,\\mathrm{d}W_{t}\n$$\n其系数为 $\\widetilde{a}_{h}(x) = a(x) + h\\alpha(x)$ 和 $\\widetilde{b}_{h}(x) = \\sigma + h\\beta(x)$。\n\n匹配条件为：\n$$\n\\mathbb{E}\\big[\\varphi(\\widetilde{X}_{t+h}) \\,\\big|\\, \\widetilde{X}_{t}=x\\big] = \\mathbb{E}\\big[\\varphi(X_{n+1}) \\,\\big|\\, X_{n}=x\\big] + \\mathcal{O}(h^3)\n$$\n为了求解 $\\alpha(x)$ 和 $\\beta(x)$，我们将对此方程两边进行关于 $h$ 的幂的 Taylor 级数展开，并令直至 $h^2$ 阶的系数相等。\n\n**1. Euler-Maruyama 格式的弱展开**\n\n令 $X_n = x$。增量为 $\\Delta X = X_{n+1} - x = a(x)h + \\sigma \\Delta W_n$。我们对 $\\varphi(X_{n+1}) = \\varphi(x + \\Delta X)$ 在 $x$ 附近进行 Taylor 展开，然后取条件期望。\n$$\n\\mathbb{E}[\\varphi(X_{n+1}) | X_n=x] = \\mathbb{E}\\left[ \\sum_{k=0}^{\\infty} \\frac{1}{k!} \\varphi^{(k)}(x) (\\Delta X)^k \\right] = \\sum_{k=0}^{\\infty} \\frac{\\varphi^{(k)}(x)}{k!} \\mathbb{E}[(\\Delta X)^k]\n$$\n我们需要 $\\Delta W_n \\sim \\mathcal{N}(0,h)$ 的矩，它们是 $\\mathbb{E}[\\Delta W_n]=0$, $\\mathbb{E}[(\\Delta W_n)^2]=h$, $\\mathbb{E}[(\\Delta W_n)^3]=0$, $\\mathbb{E}[(\\Delta W_n)^4]=3h^2$, $\\mathbb{E}[(\\Delta W_n)^5]=0$, $\\mathbb{E}[(\\Delta W_n)^6]=15h^3$, 等等。\n\n我们来计算 $\\Delta X = a(x)h + \\sigma \\Delta W_n$ 所需的矩，保留那些在最终期望中会对 $h^2$ 阶项有贡献的项。\n$\\mathbb{E}[\\Delta X] = a(x)h$。\n$\\mathbb{E}[(\\Delta X)^2] = \\mathbb{E}[a(x)^2 h^2 + 2a(x)h\\sigma\\Delta W_n + \\sigma^2(\\Delta W_n)^2] = \\sigma^2h + a(x)^2h^2$。\n$\\mathbb{E}[(\\Delta X)^3] = \\mathbb{E}[a(x)^3h^3 + 3a(x)^2h^2\\sigma\\Delta W_n + 3a(x)h\\sigma^2(\\Delta W_n)^2 + \\sigma^3(\\Delta W_n)^3] = 3a(x)\\sigma^2h^2 + \\mathcal{O}(h^3)$。\n$\\mathbb{E}[(\\Delta X)^4] = \\mathbb{E}[\\dots + 6a(x)^2h^2\\sigma^2(\\Delta W_n)^2 + \\sigma^4(\\Delta W_n)^4] = 3\\sigma^4h^2 + \\mathcal{O}(h^3)$。\n对于 $k \\ge 5$，$\\mathbb{E}[(\\Delta X)^k] = \\mathcal{O}(h^3)$。\n\n将这些矩代入 $\\mathbb{E}[\\varphi(X_{n+1})]$ 的 Taylor 级数中：\n\\begin{align*}\n\\mathbb{E}[\\varphi(X_{n+1})|X_n=x] = \\varphi(x) + \\varphi'(x)\\mathbb{E}[\\Delta X] + \\frac{\\varphi''(x)}{2}\\mathbb{E}[(\\Delta X)^2] + \\frac{\\varphi'''(x)}{6}\\mathbb{E}[(\\Delta X)^3] + \\frac{\\varphi^{(4)}(x)}{24}\\mathbb{E}[(\\Delta X)^4] + \\mathcal{O}(h^3) \\\\\n= \\varphi(x) + \\varphi'(x)(a(x)h) + \\frac{\\varphi''(x)}{2}(\\sigma^2h + a(x)^2h^2) + \\frac{\\varphi'''(x)}{6}(3a(x)\\sigma^2h^2) + \\frac{\\varphi^{(4)}(x)}{24}(3\\sigma^4h^2) + \\mathcal{O}(h^3)\n\\end{align*}\n按 $h$ 的幂次收集各项：\n$$\n\\mathbb{E}[\\varphi(X_{n+1})|X_n=x] = \\varphi(x) + h\\left(a(x)\\varphi'(x) + \\frac{1}{2}\\sigma^2\\varphi''(x)\\right) + h^2\\left(\\frac{1}{2}a(x)^2\\varphi''(x) + \\frac{1}{2}a(x)\\sigma^2\\varphi'''(x) + \\frac{1}{8}\\sigma^4\\varphi^{(4)}(x)\\right) + \\mathcal{O}(h^3) \\quad (*_E)\n$$\n\n**2. 修正后 SDE 的弱展开**\n\n修正后 SDE 的条件期望可以用其无穷小生成元 $\\mathcal{L}_h$ 来展开。\n$$\n\\mathcal{L}_h f(x) = \\widetilde{a}_h(x) f'(x) + \\frac{1}{2}\\widetilde{b}_h(x)^2 f''(x)\n$$\n展开式通过迭代生成元得到：\n$$\n\\mathbb{E}[\\varphi(\\widetilde{X}_{t+h})|\\widetilde{X}_t=x] = \\varphi(x) + h(\\mathcal{L}_h\\varphi)(x) + \\frac{h^2}{2}(\\mathcal{L}_h^2\\varphi)(x) + \\mathcal{O}(h^3)\n$$\n我们将生成元 $\\mathcal{L}_h$ 按 $h$ 的幂次展开：\n$\\widetilde{b}_h(x)^2 = (\\sigma + h\\beta(x))^2 = \\sigma^2 + 2h\\sigma\\beta(x) + h^2\\beta(x)^2$。\n$\\mathcal{L}_h = (a(x)+h\\alpha(x))\\frac{\\mathrm{d}}{\\mathrm{d}x} + \\frac{1}{2}(\\sigma^2+2h\\sigma\\beta(x)+h^2\\beta(x)^2)\\frac{\\mathrm{d}^2}{\\mathrm{d}x^2}$\n我们定义算子：\n$\\mathcal{L}_0 = a(x)\\frac{\\mathrm{d}}{\\mathrm{d}x} + \\frac{1}{2}\\sigma^2\\frac{\\mathrm{d}^2}{\\mathrm{d}x^2}$\n$\\mathcal{L}_1 = \\alpha(x)\\frac{\\mathrm{d}}{\\mathrm{d}x} + \\sigma\\beta(x)\\frac{\\mathrm{d}^2}{\\mathrm{d}x^2}$\n则 $\\mathcal{L}_h = \\mathcal{L}_0 + h\\mathcal{L}_1 + \\mathcal{O}(h^2)$。\n\n将此代入条件期望的展开式中：\n\\begin{align*}\n\\mathbb{E}[\\varphi(\\widetilde{X}_{t+h})|\\widetilde{X}_t=x] = \\varphi(x) + h(\\mathcal{L}_0+h\\mathcal{L}_1+\\dots)\\varphi(x) + \\frac{h^2}{2}(\\mathcal{L}_0+h\\mathcal{L}_1+\\dots)^2\\varphi(x) + \\mathcal{O}(h^3) \\\\\n= \\varphi(x) + h\\mathcal{L}_0\\varphi(x) + h^2\\left(\\mathcal{L}_1\\varphi(x) + \\frac{1}{2}\\mathcal{L}_0^2\\varphi(x)\\right) + \\mathcal{O}(h^3)\n\\end{align*}\n项 $\\mathcal{L}_0\\varphi(x) = a(x)\\varphi'(x) + \\frac{1}{2}\\sigma^2\\varphi''(x)$ 正好与 Euler 展开式 $(*_E)$ 的 $h$ 阶项匹配。\n现在我们计算 $\\mathcal{L}_0^2\\varphi(x) = \\mathcal{L}_0(\\mathcal{L}_0\\varphi)(x)$：\n\\begin{align*}\n\\mathcal{L}_0^2\\varphi(x) = \\left(a(x)\\frac{\\mathrm{d}}{\\mathrm{d}x} + \\frac{1}{2}\\sigma^2\\frac{\\mathrm{d}^2}{\\mathrm{d}x^2}\\right)\\left(a(x)\\varphi'(x) + \\frac{1}{2}\\sigma^2\\varphi''(x)\\right) \\\\\n= a(x)\\left(a'(x)\\varphi'(x)+a(x)\\varphi''(x) + \\frac{1}{2}\\sigma^2\\varphi'''(x)\\right) + \\frac{1}{2}\\sigma^2\\left(a''(x)\\varphi'(x) + 2a'(x)\\varphi''(x) + a(x)\\varphi'''(x) + \\frac{1}{2}\\sigma^2\\varphi^{(4)}(x)\\right) \\\\\n= \\left(a(x)a'(x) + \\frac{1}{2}\\sigma^2a''(x)\\right)\\varphi'(x) + \\left(a(x)^2 + \\sigma^2a'(x)\\right)\\varphi''(x) + a(x)\\sigma^2\\varphi'''(x) + \\frac{1}{4}\\sigma^4\\varphi^{(4)}(x)\n\\end{align*}\n修正后 SDE 展开式中 $h^2$ 的系数是 $\\mathcal{L}_1\\varphi(x) + \\frac{1}{2}\\mathcal{L}_0^2\\varphi(x)$：\n\\begin{align*}\n(\\alpha(x)\\varphi'(x) + \\sigma\\beta(x)\\varphi''(x)) + \\frac{1}{2}\\left[ \\left(a(x)a'(x) + \\frac{1}{2}\\sigma^2a''(x)\\right)\\varphi'(x) + \\left(a(x)^2 + \\sigma^2a'(x)\\right)\\varphi''(x) + a(x)\\sigma^2\\varphi'''(x) + \\frac{1}{4}\\sigma^4\\varphi^{(4)}(x) \\right] \\\\\n= \\left(\\alpha(x) + \\frac{1}{2}a(x)a'(x) + \\frac{1}{4}\\sigma^2a''(x)\\right)\\varphi'(x) + \\left(\\sigma\\beta(x) + \\frac{1}{2}a(x)^2 + \\frac{1}{2}\\sigma^2a'(x)\\right)\\varphi''(x) \\\\\n + \\frac{1}{2}a(x)\\sigma^2\\varphi'''(x) + \\frac{1}{8}\\sigma^4\\varphi^{(4)}(x)\n\\end{align*}\n\n**3. 匹配系数**\n\n我们将 Euler 展开式 $(*_E)$ 中的 $h^2$ 系数与上面推导出的 $h^2$ 系数相等。\n\\begin{align*}\n \\left(\\alpha + \\frac{1}{2}aa' + \\frac{1}{4}\\sigma^2a''\\right)\\varphi' + \\left(\\sigma\\beta + \\frac{1}{2}a^2 + \\frac{1}{2}\\sigma^2a'\\right)\\varphi'' + \\frac{1}{2}a\\sigma^2\\varphi''' + \\frac{1}{8}\\sigma^4\\varphi^{(4)} \\\\\n= \\frac{1}{2}a^2\\varphi'' + \\frac{1}{2}a\\sigma^2\\varphi''' + \\frac{1}{8}\\sigma^4\\varphi^{(4)}\n\\end{align*}\n（为简洁起见，此处省略了参数 $x$。）\n由于该等式必须对任何足够光滑的测试函数 $\\varphi$ 成立，所以 $\\varphi$ 的各阶导数的系数在两边必须匹配。涉及 $\\varphi'''$ 和 $\\varphi^{(4)}$ 的项是相同的。我们剩下：\n$$\n\\left(\\alpha(x) + \\frac{1}{2}a(x)a'(x) + \\frac{1}{4}\\sigma^2a''(x)\\right)\\varphi'(x) + \\left(\\sigma\\beta(x) + \\frac{1}{2}a(x)^2 + \\frac{1}{2}\\sigma^2a'(x)\\right)\\varphi''(x) = \\frac{1}{2}a(x)^2\\varphi''(x)\n$$\n整理后得到：\n$$\n\\left(\\alpha(x) + \\frac{1}{2}a(x)a'(x) + \\frac{1}{4}\\sigma^2a''(x)\\right)\\varphi'(x) + \\left(\\sigma\\beta(x) + \\frac{1}{2}\\sigma^2a'(x)\\right)\\varphi''(x) = 0\n$$\n由于这对任何 $\\varphi$ 都必须成立，所以 $\\varphi'(x)$ 和 $\\varphi''(x)$ 的系数必须独立地为零。\n\n由 $\\varphi'(x)$ 的系数可得：\n$$\n\\alpha(x) + \\frac{1}{2}a(x)a'(x) + \\frac{1}{4}\\sigma^2a''(x) = 0 \\implies \\alpha(x) = -\\frac{1}{2}a(x)a'(x) - \\frac{1}{4}\\sigma^2a''(x)\n$$\n由 $\\varphi''(x)$ 的系数可得：\n$$\n\\sigma\\beta(x) + \\frac{1}{2}\\sigma^2a'(x) = 0 \\implies \\beta(x) = -\\frac{1}{2}\\sigma a'(x) \\quad (\\text{因为 } \\sigma0)\n$$\n这些就是所求的修正函数。", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{2}a(x)a'(x) - \\frac{1}{4}\\sigma^{2}a''(x)  -\\frac{1}{2}\\sigma a'(x) \\end{pmatrix}}\n$$", "id": "3005959"}]}