{"hands_on_practices": [{"introduction": "为了领会隐式方法的强大之处，我们首先需要理解它们旨在解决的问题。本练习将探讨“噪声诱导的刚性”这一概念，在这种情况下，方程的随机部分（而非漂移部分）会迫使我们在显式模拟中使用不切实际的微小时间步长。通过分析一个简单的线性随机微分方程，您将能够量化显式欧拉-丸山法的稳定性限制，并亲身体会为何对于刚性问题，更稳健的数值技术是必不可少的 [@problem_id:2979927]。", "problem": "考虑一个由标准维纳过程 $W_t$ 驱动的标量随机微分方程，\n$$\n\\mathrm{d}X_t = -X_t\\,\\mathrm{d}t + b\\,X_t\\,\\mathrm{d}W_t,\\qquad X_0\\in L^2(\\Omega),\\quad b>0,\n$$\n这是一个线性乘性噪声模型，其稳定化漂移项强度适中，为 $1$，扩散系数为 $g(x)=b\\,x$。这是扩散可能引发数值刚性的一个典型实例。请从第一性原理出发，分析其精确的均方动力学，以及采用均匀时间步长 $\\Delta t>0$ 的显式欧拉-丸山（Euler–Maruyama）离散格式的均方稳定性：\n$$\nX_{n+1} = X_n - X_n\\,\\Delta t + b\\,X_n\\,\\Delta W_n,\n$$\n此处 $\\Delta W_n:=W_{t_{n+1}}-W_{t_n}$ 且 $t_n:=n\\,\\Delta t$。在您的推导中，请仅使用伊藤（Itô）积分和维纳增量的基本性质，即 $\\mathbb{E}[\\Delta W_n]=0$ 和 $\\mathbb{E}[(\\Delta W_n)^2]=\\Delta t$，以及均方稳定性的定义，即要求 $\\mathbb{E}[|X_t|^2]$（对于精确解）或 $\\mathbb{E}[|X_n|^2]$（对于离散解）在 $t\\to\\infty$ 或 $n\\to\\infty$ 时衰减至 $0$。\n\n任务：\n- 推导 $\\mathbb{E}[|X_t|^2]$ 的精确演化方程，并陈述精确解是均方稳定的所需满足的关于 $b$ 的条件。\n- 推导欧拉-丸山（Euler–Maruyama）方法的单步均方放大因子以及相关的均方稳定性条件。\n- 将此情况解释为当漂移项 $-X_t$ 温和但 $b$ 不可忽略时的噪声诱导刚性，确定在精确解是均方稳定的前提下，能使显式欧拉-丸山（Euler–Maruyama）方法保持均方稳定的最大步长 $\\Delta t_{\\max}$（作为 $b$ 的函数）。\n\n以 $b$ 的闭式表达式形式给出 $\\Delta t_{\\max}$ 的最终答案。不需要进行数值取整。", "solution": "该问题要求分析一个标量线性随机微分方程（SDE）及其通过显式欧拉-丸山（Euler–Maruyama）方法离散化后的均方稳定性。我们将首先推导精确解的稳定性条件，然后是数值方法的稳定性条件，最后在精确解稳定的条件下，确定数值方法允许的最大时间步长。\n\n给定的SDE为：\n$$\n\\mathrm{d}X_t = -X_t\\,\\mathrm{d}t + b\\,X_t\\,\\mathrm{d}W_t\n$$\n初始条件为 $X_0 \\in L^2(\\Omega)$，参数为 $b>0$。\n\n**第1部分：精确解的均方稳定性**\n\n为分析均方稳定性，我们需要求解二阶矩 $\\mathbb{E}[|X_t|^2]$ 的演化。由于 $X_t$ 是一个实值过程，因此 $|X_t|^2 = X_t^2$。我们将伊藤（Itô）公式应用于函数 $f(x) = x^2$。其导数为 $f_x(x) = 2x$ 和 $f_{xx}(x) = 2$。\n对于过程 $\\mathrm{d}X_t = a(X_t, t)\\mathrm{d}t + g(X_t, t)\\mathrm{d}W_t$，应用于 $f(X_t)$ 的一般伊藤（Itô）公式为：\n$$\n\\mathrm{d}f(X_t) = \\left( a(X_t, t) f_x(X_t) + \\frac{1}{2} g(X_t, t)^2 f_{xx}(X_t) \\right) \\mathrm{d}t + g(X_t, t) f_x(X_t) \\mathrm{d}W_t\n$$\n在我们的例子中，漂移系数为 $a(x,t) = -x$，扩散系数为 $g(x,t) = b\\,x$。将这些代入使用 $f(x)=x^2$ 的伊藤（Itô）公式中：\n$$\n\\mathrm{d}(X_t^2) = \\left( (-X_t)(2X_t) + \\frac{1}{2} (b X_t)^2 (2) \\right) \\mathrm{d}t + (b X_t)(2X_t) \\mathrm{d}W_t\n$$\n$$\n\\mathrm{d}(X_t^2) = \\left( -2X_t^2 + b^2 X_t^2 \\right) \\mathrm{d}t + 2b X_t^2 \\mathrm{d}W_t\n$$\n$$\n\\mathrm{d}(X_t^2) = (-2 + b^2) X_t^2 \\mathrm{d}t + 2b X_t^2 \\mathrm{d}W_t\n$$\n为了找到均方值 $\\mathbb{E}[X_t^2]$ 的微分方程，我们对上述SDE的积分形式取期望：\n$$\n\\mathbb{E}[X_t^2] - \\mathbb{E}[X_0^2] = \\mathbb{E}\\left[\\int_0^t (-2 + b^2) X_s^2 \\mathrm{d}s\\right] + \\mathbb{E}\\left[\\int_0^t 2b X_s^2 \\mathrm{d}W_s\\right]\n$$\n根据 Fubini 定理，我们可以交换期望和时间积分。只要被积函数是一个合适的过程（此处成立），伊藤（Itô）积分项的期望为零。\n$$\n\\mathbb{E}[X_t^2] - \\mathbb{E}[X_0^2] = \\int_0^t (-2 + b^2) \\mathbb{E}[X_s^2] \\mathrm{d}s\n$$\n对 $t$ 求导，我们得到关于 $m(t) := \\mathbb{E}[X_t^2]$ 的常微分方程（ODE）：\n$$\n\\frac{\\mathrm{d}m(t)}{\\mathrm{d}t} = (-2 + b^2) m(t)\n$$\n这个线性ODE的解为 $m(t) = m(0) \\exp((-2 + b^2)t)$，其中 $m(0)=\\mathbb{E}[X_0^2]$。\n均方稳定性要求当 $t \\to \\infty$ 时 $m(t) \\to 0$。这当且仅当指数中的系数为负时成立：\n$$\n-2 + b^2 < 0 \\implies b^2 < 2\n$$\n由于问题陈述 $b > 0$，因此精确解的均方稳定性条件是 $0 < b < \\sqrt{2}$。\n\n**第2部分：欧拉-丸山（Euler–Maruyama）方法的均方稳定性**\n\n采用时间步长 $\\Delta t$ 的欧拉-丸山（Euler–Maruyama）离散格式由下式给出：\n$$\nX_{n+1} = X_n - X_n\\,\\Delta t + b\\,X_n\\,\\Delta W_n = X_n(1 - \\Delta t + b\\,\\Delta W_n)\n$$\n我们分析均方值 $\\mathbb{E}[X_n^2]$ 的演化。我们将 $X_{n+1}$ 的表达式平方并取期望：\n$$\n\\mathbb{E}[X_{n+1}^2] = \\mathbb{E}\\left[ \\left( X_n(1 - \\Delta t + b\\,\\Delta W_n) \\right)^2 \\right] = \\mathbb{E}\\left[ X_n^2 (1 - \\Delta t + b\\,\\Delta W_n)^2 \\right]\n$$\n使用全期望定律 $\\mathbb{E}[Z] = \\mathbb{E}[\\mathbb{E}[Z|\\mathcal{F}]]$, 我们以截至时间 $t_n = n \\Delta t$ 的维纳过程所生成的σ-代数 $\\mathcal{F}_{t_n}$ 为条件。$X_n$ 是 $\\mathcal{F}_{t_n}$-可测的。\n$$\n\\mathbb{E}[X_{n+1}^2] = \\mathbb{E}\\left[ \\mathbb{E}\\left[ X_n^2 (1 - \\Delta t + b\\,\\Delta W_n)^2 \\big| \\mathcal{F}_{t_n} \\right] \\right] = \\mathbb{E}\\left[ X_n^2 \\mathbb{E}\\left[ (1 - \\Delta t + b\\,\\Delta W_n)^2 \\big| \\mathcal{F}_{t_n} \\right] \\right]\n$$\n维纳增量 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ 独立于 $\\mathcal{F}_{t_n}$。因此，内部的条件期望是一个简单期望：\n$$\n\\mathbb{E}[(1 - \\Delta t + b\\,\\Delta W_n)^2] = \\mathbb{E}[ (1 - \\Delta t)^2 + 2b(1 - \\Delta t)\\Delta W_n + b^2(\\Delta W_n)^2 ]\n$$\n使用性质 $\\mathbb{E}[\\Delta W_n]=0$ 和 $\\mathbb{E}[(\\Delta W_n)^2]=\\Delta t$：\n$$\n= (1 - \\Delta t)^2 + 2b(1 - \\Delta t)\\mathbb{E}[\\Delta W_n] + b^2 \\mathbb{E}[(\\Delta W_n)^2] = (1 - \\Delta t)^2 + b^2 \\Delta t\n$$\n$$\n= 1 - 2\\Delta t + (\\Delta t)^2 + b^2\\Delta t = 1 + (b^2 - 2)\\Delta t + (\\Delta t)^2\n$$\n这个表达式是单步均方放大因子，记为 $R(\\Delta t)$。均方值的递推关系为：\n$$\n\\mathbb{E}[X_{n+1}^2] = R(\\Delta t) \\mathbb{E}[X_n^2] = \\left( 1 + (b^2 - 2)\\Delta t + (\\Delta t)^2 \\right) \\mathbb{E}[X_n^2]\n$$\n为使数值方法是均方稳定的，我们要求当 $n \\to \\infty$ 时 $\\mathbb{E}[X_n^2] \\to 0$，这当且仅当放大因子 $R(\\Delta t)$ 的绝对值小于 $1$ 时成立：\n$$\n|R(\\Delta t)| < 1 \\implies -1 < 1 + (b^2 - 2)\\Delta t + (\\Delta t)^2 < 1\n$$\n这给出了两个条件：\n1. $1 + (b^2 - 2)\\Delta t + (\\Delta t)^2 < 1 \\implies (b^2 - 2)\\Delta t + (\\Delta t)^2 < 0 \\implies \\Delta t (b^2 - 2 + \\Delta t) < 0$。\n由于 $\\Delta t > 0$，我们必须有 $b^2 - 2 + \\Delta t < 0$，这意味着 $\\Delta t < 2 - b^2$。为了存在正的步长 $\\Delta t$，我们必须有 $2 - b^2 > 0$，即 $b^2 < 2$。\n\n2. $1 + (b^2 - 2)\\Delta t + (\\Delta t)^2 > -1 \\implies (\\Delta t)^2 + (b^2 - 2)\\Delta t + 2 > 0$。\n令 $q(\\Delta t) = (\\Delta t)^2 + (b^2 - 2)\\Delta t + 2$。这是一个关于 $\\Delta t$ 的开口向上的二次函数。其顶点位于 $\\Delta t_v = -(b^2 - 2)/2 = (2 - b^2)/2$。\n如果 $b^2 \\ge 2$，则 $\\Delta t_v \\le 0$。对于 $\\Delta t > 0$，$q(\\Delta t)$ 是一个增函数且 $q(0)=2$，所以对于所有 $\\Delta t > 0$ 都有 $q(\\Delta t) > 2$。\n如果 $0 < b^2 < 2$，则 $\\Delta t_v > 0$。对于 $\\Delta t > 0$，$q(\\Delta t)$ 的最小值在顶点处取得：$q(\\Delta t_v) = (\\frac{2-b^2}{2})^2 - (2-b^2)(\\frac{2-b^2}{2}) + 2 = 2 - \\frac{(2-b^2)^2}{4}$。由于 $0 < b^2 < 2$，我们有 $0 < 2-b^2 < 2$，所以 $0 < (2-b^2)^2 < 4$。这得出 $0 < \\frac{(2-b^2)^2}{4} < 1$，因此 $1 < q(\\Delta t_v) < 2$。\n在两种情况下，对于所有 $\\Delta t > 0$ 和 $b > 0$，都有 $q(\\Delta t) > 0$。\n因此，第二个条件总是满足的。\n\n因此，欧拉-丸山（Euler-Maruyama）方法均方稳定的唯一条件是 $\\Delta t < 2 - b^2$，这要求 $b^2 < 2$。\n\n**第3部分：最大步长 $\\Delta t_{\\max}$ 的确定**\n\n问题要求在精确解稳定的假设下，数值方法保持稳定的最大步长 $\\Delta t_{\\max}$。\n根据第1部分，精确解是稳定的当且仅当 $0 < b^2 < 2$。\n根据第2部分，对于给定的满足 $b^2 < 2$ 的 $b$，欧拉-丸山（Euler-Maruyama）方法是稳定的当且仅当步长 $\\Delta t$ 满足 $0 < \\Delta t < 2 - b^2$。\n使该稳定性条件成立的最大步长是该区间的上界。\n因此，允许的最大步长为：\n$$\n\\Delta t_{\\max} = 2 - b^2\n$$\n这个结果凸显了噪声诱导刚性现象。仅看漂移项会得到稳定性极限为 $\\Delta t < 2$。然而，由 $b$ 控制的乘性噪声项施加了一个更严格的约束 $\\Delta t < 2 - b^2$。当 $b$ 趋近于连续时间稳定性边界，即 $b \\to \\sqrt{2}^{-}$ 时，显式方法的最大稳定步长 $\\Delta t_{\\max}$ 趋于零，这要求越来越小的时间步长才能进行稳定的模拟。", "answer": "$$\\boxed{2 - b^2}$$", "id": "2979927"}, {"introduction": "在了解了显式方法的局限性之后，我们现在转向一个常见的解决方案：漂移项隐式欧拉-丸山格式。本练习将引导您通过推导均方放大因子——这是理解数值方法长期行为的关键工具——来对其稳定性进行基础分析。通过将此因子与随机微分方程的精确动态进行比较，您将深入了解该方法的准确性及其稳健处理刚性漂移项的能力 [@problem_id:2980005]。", "problem": "考虑标量线性随机微分方程 (SDE) $$\\mathrm{d}X_{t}=\\lambda X_{t}\\,\\mathrm{d}t+\\mu X_{t}\\,\\mathrm{d}W_{t},$$ 其中 $W_{t}$ 是一个标准维纳过程，$\\lambda\\in\\mathbb{R}$ 模拟一个刚性线性漂移 (其中 $\\lambda<0$)，且 $\\mu\\in\\mathbb{R}$ 是乘性噪声强度。设 $h>0$ 为一个固定的时间步长，并用 $X_{n}\\approx X_{t_{n}}$ 表示在 $t_{n}=nh$ 处由漂移隐式欧拉–丸山法生成的数值近似，此方法对漂移项进行隐式处理，对扩散项进行显式处理。\n\n从伊藤微积分的基本定义以及应用于此 SDE 的漂移隐式欧拉–丸山法的更新规则出发，推导由下式定义的离散单步均方 (MS) 放大因子 $R_{\\text{MS}}(h,\\lambda,\\mu)$：$$R_{\\text{MS}}(h,\\lambda,\\mu)=\\frac{\\mathbb{E}\\!\\left[|X_{n+1}|^{2}\\right]}{\\mathbb{E}\\!\\left[|X_{n}|^{2}\\right]}.$$ 然后，将此离散均方放大因子与从该 SDE 的二阶矩演化方程得到的精确连续时间均方衰减/增长率进行比较，并解释关于 $h$ 的主阶关系。\n\n你的最终答案应该是 $R_{\\text{MS}}(h,\\lambda,\\mu)$ 关于 $h$、$\\lambda$ 和 $\\mu$ 的闭式解析表达式。无需进行数值计算或四舍五入。", "solution": "该问题要求推导漂移隐式欧拉–丸山法应用于一个特定的线性随机微分方程 (SDE) 时的均方 (MS) 放大因子，并将该因子与精确的连续时间结果进行比较。\n\n对于一个SDE $\\mathrm{d}X_t = a(X_t, t)\\,\\mathrm{d}t + b(X_t, t)\\,\\mathrm{d}W_t$，漂移隐式欧拉–丸山格式的一般形式由下式给出：\n$$X_{n+1} = X_n + a(X_{n+1}, t_{n+1})h + b(X_n, t_n)\\Delta W_n$$\n其中 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ 是维纳过程在区间 $[t_n, t_{n+1}]$ 上的增量。\n\n对于给定的 SDE $\\mathrm{d}X_{t}=\\lambda X_{t}\\,\\mathrm{d}t+\\mu X_{t}\\,\\mathrm{d}W_{t}$，漂移项是 $a(X_t) = \\lambda X_t$，扩散项是 $b(X_t) = \\mu X_t$。应用漂移隐式格式可得：\n$$X_{n+1} = X_n + \\lambda X_{n+1} h + \\mu X_n \\Delta W_n$$\n这是一个关于 $X_{n+1}$ 的隐式方程。我们可以通过代数方法解出 $X_{n+1}$：\n$$X_{n+1} - \\lambda X_{n+1} h = X_n + \\mu X_n \\Delta W_n$$\n$$X_{n+1}(1 - \\lambda h) = X_n(1 + \\mu \\Delta W_n)$$\n假设 $1 - \\lambda h \\neq 0$，由于 $\\lambda < 0$ 且 $h > 0$，该假设成立，因此我们有：\n$$X_{n+1} = \\frac{1 + \\mu \\Delta W_n}{1 - \\lambda h} X_n$$\n这就是数值近似的显式单步更新规则。\n\n现在，我们可以计算均方放大因子 $R_{\\text{MS}}(h,\\lambda,\\mu)$。我们首先计算 $X_{n+1}$ 的模的平方：\n$$|X_{n+1}|^2 = \\left| \\frac{1 + \\mu \\Delta W_n}{1 - \\lambda h} X_n \\right|^2 = \\frac{(1 + \\mu \\Delta W_n)^2}{(1 - \\lambda h)^2} |X_n|^2$$\n接下来，我们对该表达式取期望。我们使用全期望定律，以在时间 $t_n$ 可用的信息（由信息流 $\\mathcal{F}_{t_n}$ 表示）为条件。近似值 $X_n$ 是 $\\mathcal{F}_{t_n}$-可测的，而增量 $\\Delta W_n$ 独立于 $\\mathcal{F}_{t_n}$。\n$$\\mathbb{E}[|X_{n+1}|^2] = \\mathbb{E}\\left[ \\mathbb{E}\\left[ \\frac{(1 + \\mu \\Delta W_n)^2}{(1 - \\lambda h)^2} |X_n|^2 \\bigg| \\mathcal{F}_{t_n} \\right] \\right]$$\n由于 $|X_n|^2$ 和分母 $(1 - \\lambda h)^2$ 都是 $\\mathcal{F}_{t_n}$-可测的，它们在内层期望中可以被视为常数：\n$$\\mathbb{E}[|X_{n+1}|^2] = \\mathbb{E}\\left[ \\frac{|X_n|^2}{(1 - \\lambda h)^2} \\mathbb{E}\\left[ (1 + \\mu \\Delta W_n)^2 \\bigg| \\mathcal{F}_{t_n} \\right] \\right]$$\n由于 $\\Delta W_n$ 独立于 $\\mathcal{F}_{t_n}$，条件期望变成了无条件期望：\n$$\\mathbb{E}[|X_{n+1}|^2] = \\frac{1}{(1 - \\lambda h)^2} \\mathbb{E}[|X_n|^2] \\mathbb{E}[(1 + \\mu \\Delta W_n)^2]$$\n增量 $\\Delta W_n$ 是一个均值为 $0$、方差为 $h$ 的正态分布随机变量，即 $\\Delta W_n \\sim \\mathcal{N}(0, h)$。因此，$\\mathbb{E}[\\Delta W_n] = 0$ 且 $\\mathbb{E}[(\\Delta W_n)^2] = h$。我们用这个性质来计算剩余的期望：\n$$\\mathbb{E}[(1 + \\mu \\Delta W_n)^2] = \\mathbb{E}[1 + 2\\mu\\Delta W_n + \\mu^2(\\Delta W_n)^2]$$\n根据期望的线性性质：\n$$\\mathbb{E}[(1 + \\mu \\Delta W_n)^2] = 1 + 2\\mu\\mathbb{E}[\\Delta W_n] + \\mu^2\\mathbb{E}[(\\Delta W_n)^2] = 1 + 2\\mu(0) + \\mu^2(h) = 1 + \\mu^2 h$$\n将此结果代回，我们得到连续时间步上二阶矩之间的关系：\n$$\\mathbb{E}[|X_{n+1}|^2] = \\frac{1 + \\mu^2 h}{(1 - \\lambda h)^2} \\mathbb{E}[|X_n|^2]$$\n因此，离散单步均方放大因子为：\n$$R_{\\text{MS}}(h,\\lambda,\\mu) = \\frac{\\mathbb{E}[|X_{n+1}|^2]}{\\mathbb{E}[|X_n|^2]} = \\frac{1 + \\mu^2 h}{(1 - \\lambda h)^2}$$\n这是所需答案的第一部分。\n\n为了进行比较，我们必须求出精确的连续时间均方衰减/增长率。令 $m_2(t) = \\mathbb{E}[X_t^2]$。我们使用伊藤公式推导控制 $m_2(t)$ 的常微分方程 (ODE)。对于 $f(x) = x^2$，我们有 $f'(x) = 2x$ 和 $f''(x) = 2$。对 $X_t^2$ 应用伊藤公式：\n$$\\mathrm{d}(X_t^2) = \\left( (2X_t)(\\lambda X_t) + \\frac{1}{2}(2)(\\mu X_t)^2 \\right)\\mathrm{d}t + (2X_t)(\\mu X_t)\\mathrm{d}W_t$$\n$$\\mathrm{d}(X_t^2) = (2\\lambda + \\mu^2)X_t^2\\,\\mathrm{d}t + 2\\mu X_t^2\\,\\mathrm{d}W_t$$\n对两边取期望，并注意到伊藤积分项的期望为零（$\\mathbb{E}[\\int_{0}^{t} 2\\mu X_s^2\\,\\mathrm{d}W_s] = 0$）：\n$$\\mathrm{d}(\\mathbb{E}[X_t^2]) = (2\\lambda + \\mu^2)\\mathbb{E}[X_t^2]\\,\\mathrm{d}t$$\n这给出了二阶矩 $m_2(t)$ 的常微分方程：\n$$\\frac{\\mathrm{d}m_2(t)}{\\mathrm{d}t} = (2\\lambda + \\mu^2)m_2(t)$$\n其解为 $m_2(t) = m_2(0)\\exp((2\\lambda + \\mu^2)t)$。在长度为 $h$ 的时间步长上，二阶矩的精确放大率为：\n$$R_{\\text{exact}}(h) = \\frac{m_2(t_n+h)}{m_2(t_n)} = \\exp((2\\lambda + \\mu^2)h)$$\n为了比较 $R_{\\text{MS}}$ 和 $R_{\\text{exact}}$，我们对两个表达式在 $h=0$ 附近按 $h$ 的幂次进行泰勒展开。\n对于精确因子：\n$$R_{\\text{exact}}(h) = 1 + (2\\lambda + \\mu^2)h + \\frac{1}{2}(2\\lambda + \\mu^2)^2 h^2 + O(h^3)$$\n对于数值因子，我们使用几何级数展开 $(1-x)^{-2} = 1 + 2x + 3x^2 + \\dots$：\n$$R_{\\text{MS}}(h) = \\frac{1 + \\mu^2 h}{(1 - \\lambda h)^2} = (1 + \\mu^2 h)(1 - \\lambda h)^{-2}$$\n$$R_{\\text{MS}}(h) = (1 + \\mu^2 h)(1 + 2\\lambda h + 3\\lambda^2 h^2 + O(h^3))$$\n$$R_{\\text{MS}}(h) = 1 + 2\\lambda h + 3\\lambda^2 h^2 + \\mu^2 h + 2\\lambda\\mu^2 h^2 + O(h^3)$$\n$$R_{\\text{MS}}(h) = 1 + (2\\lambda + \\mu^2)h + (3\\lambda^2 + 2\\lambda\\mu^2)h^2 + O(h^3)$$\n比较这两个级数展开式，我们发现 $h^0$ 和 $h^1$ 的系数是相同的。\n$$R_{\\text{MS}}(h) - R_{\\text{exact}}(h) = O(h^2)$$\n这意味着漂移隐式欧拉-丸山法在步长 $h$ 上以一阶精度再现了精确的均方动态。主阶关系是，数值均方放大因子是精确因子的一个一阶近似：$R_{\\text{MS}}(h) = R_{\\text{exact}}(h) + O(h^2)$。", "answer": "$$\\boxed{\\frac{1 + \\mu^{2} h}{(1 - \\lambda h)^{2}}}$$", "id": "2980005"}, {"introduction": "尽管隐式方法提供了更强的稳定性，但它们并非万能药，并且可能引入自身特有的挑战，例如在每一步求解非线性代数方程。这个进阶问题揭示了一个更为微妙的议题：对于某些特定的随机微分方程，尤其是那些具有超线性扩散项的方程，全隐式格式的代数方程在噪声增量较大时可能无解。分析这种失效情况为我们提供了关于谨慎应用数值方法的宝贵一课，并强调了为何选择隐式处理的方式（仅漂移项、仅扩散项或两者皆有）是一个关键的建模决策 [@problem_id:2980034]。", "problem": "考虑一个具有刚性线性漂移项和超线性乘性扩散项的一维随机微分方程 (SDE)：\n$$\n\\mathrm{d}X_{t} \\;=\\; -\\lambda\\,X_{t}\\,\\mathrm{d}t \\;+\\; \\sigma\\,X_{t}^{3/2}\\,\\mathrm{d}W_{t},\n$$\n其中 $\\lambda>0$ 是刚性参数，$\\sigma>0$ 是噪声幅度，而 $W_{t}$ 是标准布朗运动。对于固定的时间步长 $h>0$，考虑同时对漂移项和扩散项进行隐式处理的全隐式欧拉-丸山 (EM) 方法：\n$$\nX_{n+1} \\;=\\; X_{n} \\;+\\; h\\,\\big(-\\lambda\\,X_{n+1}\\big) \\;+\\; \\sigma\\,X_{n+1}^{3/2}\\,\\Delta W_{n},\n$$\n其中 $\\Delta W_{n} := W_{t_{n+1}} - W_{t_{n}}$。\n\n假设给定 $X_{n}>0$。请仅从 SDE 和全隐式 EM 步长的定义出发，推导求解 $X_{n+1}$ 时必须满足的代数方程，并用 $y := \\sqrt{X_{n+1}}$ 对其重新参数化，以得到一个关于 $y$ 的多项式。利用微积分基本原理求解多项式极值，确定最小正阈值 $\\Delta W_{*}$（用 $\\lambda$、$\\sigma$、$h$ 和 $X_{n}$ 的显式闭式表达式表示），使得对于任何满足 $\\Delta W_{n} \\ge \\Delta W_{*}$ 的实现，该隐式 EM 更新对 $X_{n+1}$ 都没有非负实数解。\n\n请从单调性和多项式映射的几何角度解释失效发生的原因。你的最终答案必须是 $\\Delta W_{*}$ 的单一解析表达式。无需四舍五入。", "solution": "我们分析应用于给定随机微分方程 (SDE) 的全隐式欧拉-丸山格式的解的存在性。\n\n### 步骤 1：构建代数方程\n\n问题给出了随机微分方程 (SDE)：\n$$\n\\mathrm{d}X_{t} = -\\lambda\\,X_{t}\\,\\mathrm{d}t + \\sigma\\,X_{t}^{3/2}\\,\\mathrm{d}W_{t}\n$$\n其参数为 $\\lambda > 0$ 和 $\\sigma > 0$。时间步长为 $h > 0$ 的全隐式欧拉-丸山 (EM) 离散格式如下：\n$$\nX_{n+1} = X_{n} + h\\,\\big(-\\lambda\\,X_{n+1}\\big) + \\sigma\\,\\Delta W_{n}\\,X_{n+1}^{3/2}\n$$\n这里，$\\Delta W_{n}$ 是维纳增量 $W_{t_{n+1}} - W_{t_{n}}$，给定当前状态 $X_{n} > 0$。我们需要为下一个状态寻找一个非负实数解 $X_{n+1} \\ge 0$。\n\n为分析此隐式方程，我们首先对其进行整理，以分离出已知项 $X_{n}$：\n$$\nX_{n} = X_{n+1} + h\\lambda\\,X_{n+1} - \\sigma\\,\\Delta W_{n}\\,X_{n+1}^{3/2}\n$$\n$$\nX_{n} = (1+h\\lambda)X_{n+1} - \\sigma\\,\\Delta W_{n}\\,X_{n+1}^{3/2}\n$$\n这就是在给定 $X_{n}$ 和 $\\Delta W_{n}$ 的一个实现的情况下，必须为 $X_{n+1}$ 求解的代数方程。\n\n### 步骤 2：重新参数化与多项式构建\n\n问题要求用 $y := \\sqrt{X_{n+1}}$ 进行重新参数化。由于我们寻找的是一个非负解 $X_{n+1} \\ge 0$，这意味着 $y$ 必须是一个非负实数，即 $y \\ge 0$。通过这个代换，我们得到 $X_{n+1} = y^2$ 和 $X_{n+1}^{3/2} = (y^2)^{3/2} = |y|^3$。由于 $y \\ge 0$，这可以简化为 $y^3$。\n\n将这些代入代数方程得到：\n$$\nX_{n} = (1+h\\lambda)y^2 - \\sigma\\,\\Delta W_{n}\\,y^3\n$$\n该方程定义了已知值 $X_{n}$ 和未知量 $y$ 之间的关系。寻找 $y$ 的解等价于寻找以下关于 $y$ 的三次多项式的一个根：\n$$\n\\sigma\\,\\Delta W_{n}\\,y^3 - (1+h\\lambda)y^2 + X_{n} = 0\n$$\n\n### 步骤 3：使用微积分分析实数解\n\n我们需要确定在什么条件下，该多项式至少有一个关于 $y$ 的非负实根。让我们为 $y \\ge 0$ 定义一个函数 $g(y)$：\n$$\ng(y) = (1+h\\lambda)y^2 - \\sigma\\,\\Delta W_{n}\\,y^3\n$$\n求 $y$ 的解等价于求函数 $g(y)$ 的图像与水平线 $z = X_{n}$ 的交点。\n\n问题关注的是当噪声增量 $\\Delta W_{n}$ 是一个较大的正数时，无法找到解的情况。因此，我们假设 $\\Delta W_{n} > 0$。当 $\\Delta W_{n} \\le 0$ 时，总能得到一个唯一的正解，因为对于 $y>0$，与多项式对应的函数是单调的。\n\n为理解函数 $g(y)$ （对于 $y \\ge 0$）的几何形状，我们通过寻找其临界点来分析其极值。$g(y)$ 的一阶导数是：\n$$\ng'(y) = \\frac{\\mathrm{d}g}{\\mathrm{d}y} = 2(1+h\\lambda)y - 3\\sigma\\,\\Delta W_{n}\\,y^2\n$$\n令 $g'(y) = 0$ 以寻找临界点：\n$$\ny \\left( 2(1+h\\lambda) - 3\\sigma\\,\\Delta W_{n}\\,y \\right) = 0\n$$\n这得到了两个临界点：$y=0$ 和一个正的临界点 $y_c$：\n$$\ny_{c} = \\frac{2(1+h\\lambda)}{3\\sigma\\,\\Delta W_{n}}\n$$\n为确定这些极值的性质，我们考察二阶导数：\n$$\ng''(y) = \\frac{\\mathrm{d}^2g}{\\mathrm{d}y^2} = 2(1+h\\lambda) - 6\\sigma\\,\\Delta W_{n}\\,y\n$$\n在 $y=0$ 处，$g''(0) = 2(1+h\\lambda) > 0$ （因为 $\\lambda>0, h>0$），所以 $y=0$ 是一个局部极小值点，且 $g(0)=0$。\n在 $y=y_c$ 处，\n$$\ng''(y_c) = 2(1+h\\lambda) - 6\\sigma\\,\\Delta W_{n} \\left( \\frac{2(1+h\\lambda)}{3\\sigma\\,\\Delta W_{n}} \\right) = 2(1+h\\lambda) - 4(1+h\\lambda) = -2(1+h\\lambda) < 0\n$$\n因此，$y_c$ 对应一个局部极大值点。函数 $g(y)$ 从 $g(0)=0$ 开始，在 $y_c$ 处增加到最大值，然后对于 $y>y_c$ 开始减小，由于 $-y^3$ 项的存在，当 $y \\to \\infty$ 时趋向于 $-\\infty$。\n\n方程 $g(y) = X_{n}$ 存在非负解 $y$ 的充要条件是，$X_{n}$ 的值小于或等于 $g(y)$ 的局部极大值。我们来计算这个极大值，$g_{\\max} = g(y_c)$：\n$$\ng_{\\max} = (1+h\\lambda)y_c^2 - \\sigma\\,\\Delta W_{n}\\,y_c^3 = y_c^2 \\left( (1+h\\lambda) - \\sigma\\,\\Delta W_{n}\\,y_c \\right)\n$$\n代入 $y_c$ 的表达式：\n$$\ng_{\\max} = y_c^2 \\left( (1+h\\lambda) - \\sigma\\,\\Delta W_{n}\\,\\frac{2(1+h\\lambda)}{3\\sigma\\,\\Delta W_{n}} \\right) = y_c^2 \\left( (1+h\\lambda) - \\frac{2}{3}(1+h\\lambda) \\right) = \\frac{1}{3}(1+h\\lambda)y_c^2\n$$\n现在，再次代入 $y_c$ 的表达式：\n$$\ng_{\\max} = \\frac{1}{3}(1+h\\lambda) \\left( \\frac{2(1+h\\lambda)}{3\\sigma\\,\\Delta W_{n}} \\right)^2 = \\frac{1}{3}(1+h\\lambda) \\frac{4(1+h\\lambda)^2}{9\\sigma^2(\\Delta W_{n})^2} = \\frac{4(1+h\\lambda)^3}{27\\sigma^2(\\Delta W_{n})^2}\n$$\n解存在的充要条件是 $X_{n} \\le g_{\\max}$。反之，如果 $X_{n} > g_{\\max}$，则不存在非负解。\n\n### 步骤 4：确定阈值 $\\Delta W_{*}$\n\n不存在非负实数解的条件是 $X_{n} > g_{\\max}$，这可以转化为：\n$$\nX_{n} > \\frac{4(1+h\\lambda)^3}{27\\sigma^2(\\Delta W_{n})^2}\n$$\n整理这个不等式以求解 $\\Delta W_{n}$：\n$$\n(\\Delta W_{n})^2 > \\frac{4(1+h\\lambda)^3}{27\\sigma^2 X_{n}}\n$$\n由于我们在寻找一个正阈值，我们考虑 $\\Delta W_{n} > 0$ 并取正平方根：\n$$\n\\Delta W_{n} > \\sqrt{\\frac{4(1+h\\lambda)^3}{27\\sigma^2 X_{n}}}\n$$\n问题要求的是最小正阈值 $\\Delta W_{*}$，使得对于任何 $\\Delta W_{n} \\ge \\Delta W_{*}$，解都不存在。该阈值是解开始不存在的边界，即当 $X_n = g_{\\max}$ 时的情况。因此，我们将阈值 $\\Delta W_{*}$ 设为这个边界值。\n$$\n\\Delta W_{*} = \\sqrt{\\frac{4(1+h\\lambda)^3}{27\\sigma^2 X_{n}}}\n$$\n简化这个表达式，我们得到：\n$$\n\\Delta W_{*} = \\frac{2(1+h\\lambda)^{3/2}}{\\sigma\\sqrt{27}\\sqrt{X_n}} = \\frac{2(1+h\\lambda)^{3/2}}{3\\sqrt{3}\\sigma\\sqrt{X_n}}\n$$\n\n### 失效机制解释\n\n隐式方法无法产生解的原因在于从未来状态到当前状态的映射的非单调性。方程 $X_{n} = g(y)$（其中 $y=\\sqrt{X_{n+1}}$）可以解释为这样一个问题：“对于给定的当前状态 $X_n$，在隐式格式的动力学下，什么样的未来状态 $X_{n+1}$ 可能会导致它？”\n\n函数 $g(y)$ 代表了这种反向映射。从几何上看，对于一个正的噪声增量 $\\Delta W_n > 0$，函数 $g(y)$（对于 $y \\ge 0$）的图像从原点上升到一个峰值（局部极大值 $g_{\\max}$），然后下降至 $-\\infty$。这意味着，对于任何非负的 $y$，通过此映射所能得到的 $X_n$ 存在一个最大可能值。\n\n如果给定的 $X_n$ 值大于这个峰值（$X_n > g_{\\max}$），那么水平线 $z=X_n$ 将完全位于 $g(y)$ 图像的上方。因此，不存在交点，这意味着没有实数、非负的 $y$（也即 $X_{n+1}$）能满足该隐式方程。\n\n极大值 $g_{\\max}$ 与 $(\\Delta W_n)^2$ 成反比。一个大的正噪声增量 $\\Delta W_n$ 会急剧降低 $g(y)$ 曲线的峰值。阈值 $\\Delta W_*$ 正是使得这个峰值 $g_{\\max}$ 下降到给定状态 $X_n$ 水平的那个噪声增量值。对于任何更大的噪声增量 $\\Delta W_n > \\Delta W_*$，峰值将低于 $X_n$，因此解将不存在。", "answer": "$$\\boxed{\\frac{2(1+h\\lambda)^{3/2}}{3\\sqrt{3}\\sigma\\sqrt{X_{n}}}}$$", "id": "2980034"}]}