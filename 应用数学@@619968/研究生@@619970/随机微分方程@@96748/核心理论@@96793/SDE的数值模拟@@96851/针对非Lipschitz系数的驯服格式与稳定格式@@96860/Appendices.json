{"hands_on_practices": [{"introduction": "对于具有超线性增长系数的随机微分方程，标准的显式数值方法（如欧拉-丸山法）可能会失效。本练习通过第一性原理，引导你分析显式欧拉法的一个步长更新，从而直观地理解不稳定性是如何产生的。通过识别漂移项在何种条件下会主导并导致数值解的爆炸，你将深刻认识到为何需要为非全局Lipschitz问题设计专门的数值格式 [@problem_id:2999251]。", "problem": "考虑伊藤随机微分方程 $dX_{t}=b(X_{t})\\,dt+\\sigma(X_{t})\\,dW_{t}$，其中 $W_{t}$ 是一个标准布朗运动 (BM)，且 $b(x)=-x^{3}$，$\\sigma(x)=x$。设 $t_{n}$ 为一个固定时间，$X_{t_{n}}=x_{n}$ 为当前状态，$h>0$ 为选定的时间步长。定义布朗增量 $\\Delta W_{n}=W_{t_{n}+h}-W_{t_{n}}$。\n\n请仅使用伊藤随机微分方程的基本定义，并从其积分形式 $X_{t+h}-X_{t}=\\int_{t}^{t+h}b(X_{s})\\,ds+\\int_{t}^{t+h}\\sigma(X_{s})\\,dW_{s}$ 出发，通过将系数冻结在 $X_{t}$ 来构建显式欧拉-丸山 (EM) 方法，然后针对给定的 $b$ 和 $\\sigma$，计算以 $x_{n}$、$h$ 和 $\\Delta W_{n}$ 表示的单步欧拉-丸山增量 $\\Delta X_{n}=X_{t_{n}+h}-X_{t_{n}}$。接着，通过基于基本原理的量级比较，确定漂移项贡献主导扩散项贡献的条件（用 $x_{n}$、$h$ 和 $|\\Delta W_{n}|$ 表示），并解释在仅有漂移项的情况下，这种主导性如何通过 $|X_{t_{n}+h}|$ 相对于 $|X_{t_{n}}|$ 的增长导致显式欧拉更新中的数值不稳定性。\n\n您的最终答案必须是计算出的单步欧拉-丸山增量的单一闭式表达式。无需四舍五入，也不涉及单位。", "solution": "出发点是伊藤随机微分方程的基本积分表示。对于伊藤随机微分方程 $dX_{t}=b(X_{t})\\,dt+\\sigma(X_{t})\\,dW_{t}$，在长度为 $h>0$ 的单个时间步长上的增量由下式给出\n$$\nX_{t_{n}+h}-X_{t_{n}}=\\int_{t_{n}}^{t_{n}+h}b(X_{s})\\,ds+\\int_{t_{n}}^{t_{n}+h}\\sigma(X_{s})\\,dW_{s}.\n$$\n显式欧拉-丸山 (EM) 格式的构建方法是，通过将系数冻结在左端点 $X_{t_{n}}=x_{n}$ 来近似漂移积分和扩散积分中的被积函数，并分别用 $b(x_{n})\\,h$ 和 $\\sigma(x_{n})\\,(W_{t_{n}+h}-W_{t_{n}})$ 来近似这两个积分。因此，\n$$\n\\Delta X_{n}:=X_{t_{n}+h}-X_{t_{n}}\\approx b(x_{n})\\,h+\\sigma(x_{n})\\,\\Delta W_{n}.\n$$\n对于给定的系数 $b(x)=-x^{3}$ 和 $\\sigma(x)=x$，该式变为\n$$\n\\Delta X_{n}=-x_{n}^{3}\\,h+x_{n}\\,\\Delta W_{n}.\n$$\n这就是闭式形式的单步欧拉-丸山增量。\n\n接下来，我们比较漂移项贡献和扩散项贡献的量级，以确定漂移项何时占主导地位。漂移项的量级为\n$$\n|\\text{drift}|=|b(x_{n})|\\,h=|x_{n}|^{3}\\,h,\n$$\n扩散项的量级为\n$$\n|\\text{diffusion}|=|\\sigma(x_{n})|\\,|\\Delta W_{n}|=|x_{n}|\\,|\\Delta W_{n}|.\n$$\n漂移主导的特征是 $|\\text{drift}|>|\\text{diffusion}|$，这得到\n$$\n|x_{n}|^{3}\\,h > |x_{n}|\\,|\\Delta W_{n}|.\n$$\n假设 $x_{n}\\neq 0$，两边同除以 $|x_{n}|$ 得到条件\n$$\nh\\,|x_{n}|^{2} > |\\Delta W_{n}|.\n$$\n由于布朗增量 $\\Delta W_{n}$ 服从均值为 $0$、方差为 $h$ 的正态分布，其典型大小的量级为 $\\sqrt{h}$。因此，从数量级上看，一个高概率的漂移主导区域对应于\n$$\nh\\,|x_{n}|^{2} \\gg \\sqrt{h},\n$$\n等价于，\n$$\n|x_{n}| \\gg h^{-1/4}.\n$$\n这表明，当 $|x_{n}|$ 相对于 $h^{-1/4}$ 较大时，漂移项的贡献会以高概率主导扩散项的贡献。\n\n为了将漂移主导与显式欧拉方法中的数值不稳定性联系起来，我们首先考虑常微分方程 $dX_{t}=-X_{t}^{3}\\,dt$ 的确定性仅漂移更新（将扩散增量设为零）。显式欧拉更新可写作\n$$\nx_{n+1}=x_{n}-h\\,x_{n}^{3}=x_{n}\\left(1-h\\,x_{n}^{2}\\right).\n$$\n其大小根据下式演化\n$$\n|x_{n+1}|=|x_{n}|\\,\\left|1-h\\,x_{n}^{2}\\right|.\n$$\n数值意义上的不稳定性（即 $|x_{n+1}|$ 相对于 $|x_{n}|$ 的增长）发生在 $\\left|1-h\\,x_{n}^{2}\\right|>1$ 时，也就是\n$$\n\\left|1-h\\,x_{n}^{2}\\right|>1 \\quad\\Longleftrightarrow\\quad h\\,x_{n}^{2}>2.\n$$\n因此，如果 $h\\,x_{n}^{2}>2$，尽管连续时间系统是耗散的，但在仅有漂移项的情况下，显式欧拉映射会放大状态的大小并变得数值不稳定。当存在随机项时，漂移主导条件 $h\\,|x_{n}|^{2}>|\\Delta W_{n}|$ 将更新置于一个动力学行为被不稳定的仅漂移映射有效支配的区域，并且步长可能表现出大的偏移，这为针对非李普希茨系数使用驯服格式或稳定化格式提供了动机。\n\n总之，对于给定的系数，计算出的单步欧拉-丸山增量是\n$$\n\\Delta X_{n}=-x_{n}^{3}\\,h+x_{n}\\,\\Delta W_{n},\n$$\n而漂移主导由 $h\\,|x_{n}|^{2}>|\\Delta W_{n}|$ 表明，这个条件在仅有漂移项的情况下，可将显式欧拉更新置于数值不稳定的区域 $h\\,x_{n}^{2}>2$。", "answer": "$$\\boxed{-x_{n}^{3}\\,h+x_{n}\\,\\Delta W_{n}}$$", "id": "2999251"}, {"introduction": "认识到标准方法的局限性后，我们自然会问：这些看似“病态”的方程是否具有某些潜在的良好结构，可以被数值方法所利用？单边Lipschitz条件正是这样的一个关键性质，它保证了系统的耗散性，即便在漂移项非Lipschitz的情况下。本练习将指导你验证一个典型非线性漂移项是否满足此条件，这是理解驯服格式和稳定格式收敛性理论的基石 [@problem_id:2999286]。", "problem": "考虑标量随机微分方程 (SDE) $$\\mathrm{d}X_{t}=b(X_{t})\\,\\mathrm{d}t+\\sigma(X_{t})\\,\\mathrm{d}W_{t},$$ 其中 $W_{t}$ 是标准的一维布朗运动，$b(x)=x-x^{3}$，且 $\\sigma(x)=x^{2}$。在分析具有非Lipschitz系数的SDE的驯服和稳定数值格式时，漂移项的一个关键结构性质是单边Lipschitz条件：存在一个常数 $L\\in\\mathbb{R}$，使得对于所有 $x,y\\in\\mathbb{R}$，都有$$\\langle x-y,\\,b(x)-b(y)\\rangle\\leq L\\|x-y\\|^{2},$$ 其中 $\\langle\\cdot,\\cdot\\rangle$ 是欧几里得内积，$\\|\\cdot\\|$ 是欧几里得范数。从实数分析的第一性原理和单边Lipschitz条件的基本定义出发，判断此条件对给定的 $b(x)$ 是否成立，如果成立，计算使其在 $\\mathbb{R}$ 上有效的最紧的最小常数 $L$。您的最终答案必须是单个实数。无需四舍五入。答案不带单位。", "solution": "问题要求判断单边Lipschitz条件是否对漂移函数 $b(x) = x - x^3$ 成立，如果成立，则求出使该条件对所有 $x, y \\in \\mathbb{R}$ 成立的最小常数 $L$。\n\n该问题设定在一维标量背景下。状态 $X_t$ 是一个实数，因此变量 $x$ 和 $y$ 属于 $\\mathbb{R}$。在这种标量设定下，欧几里得内积 $\\langle u, v \\rangle$ 简化为标准乘积 $uv$，欧几里得范数 $\\|u\\|$ 变为绝对值 $|u|$。\n\n单边Lipschitz条件可写为：\n$$\n\\langle x-y, b(x)-b(y) \\rangle \\leq L \\|x-y\\|^2\n$$\n对于标量变量 $x, y \\in \\mathbb{R}$，该不等式变为：\n$$\n(x-y)(b(x)-b(y)) \\leq L(x-y)^2\n$$\n给定的漂移函数是 $b(x) = x - x^3$。我们将其代入不等式。$b(x) - b(y)$ 项为：\n$$\nb(x) - b(y) = (x - x^3) - (y - y^3) = (x-y) - (x^3 - y^3)\n$$\n将此表达式代回条件中，得到：\n$$\n(x-y) \\left[ (x-y) - (x^3 - y^3) \\right] \\leq L(x-y)^2\n$$\n我们使用立方差的标准代数恒等式：$x^3 - y^3 = (x-y)(x^2 + xy + y^2)$。\n$$\n(x-y) \\left[ (x-y) - (x-y)(x^2 + xy + y^2) \\right] \\leq L(x-y)^2\n$$\n从左侧方括号中提取公因式 $(x-y)$ 得到：\n$$\n(x-y)^2 \\left[ 1 - (x^2 + xy + y^2) \\right] \\leq L(x-y)^2\n$$\n我们需要找到使此不等式对所有 $x, y \\in \\mathbb{R}$ 成立的最小常数 $L \\in \\mathbb{R}$。\n\n我们来分析这个不等式。\n如果 $x = y$，不等式变为 $0 \\leq 0$，这始终成立，并且对 $L$ 没有提供任何约束。\n如果 $x \\neq y$，则 $(x-y)^2 > 0$。我们可以在不等式两边同除以 $(x-y)^2$ 而不改变不等号的方向：\n$$\n1 - (x^2 + xy + y^2) \\leq L\n$$\n这个不等式必须对所有 $x \\neq y$ 的 $x, y \\in \\mathbb{R}$ 成立。寻找这样的最小常数 $L$ 的问题，等价于在定义域 $\\{(x,y) \\in \\mathbb{R}^2 \\mid x \\neq y\\}$ 上寻找函数 $f(x, y) = 1 - (x^2 + xy + y^2)$ 的上确界。\n由于函数 $f(x, y)$ 在整个 $\\mathbb{R}^2$ 上是连续的，其在集合 $x \\neq y$ 上的上确界与在整个 $\\mathbb{R}^2$ 上的上确界相同。\n因此，最紧的最小常数 $L$ 由以下公式给出：\n$$\nL = \\sup_{(x,y) \\in \\mathbb{R}^2} \\left[ 1 - (x^2 + xy + y^2) \\right]\n$$\n这可以重写为：\n$$\nL = 1 - \\inf_{(x,y) \\in \\mathbb{R}^2} (x^2 + xy + y^2)\n$$\n我们来分析二次型 $Q(x,y) = x^2 + xy + y^2$。为了找到其下确界，我们可以使用配方法。我们可以将其视为关于 $x$ 的二次式：\n$$\nQ(x,y) = \\left( x^2 + xy + \\frac{y^2}{4} \\right) - \\frac{y^2}{4} + y^2\n$$\n$$\nQ(x,y) = \\left( x + \\frac{1}{2}y \\right)^2 + \\frac{3}{4}y^2\n$$\n表达式 $\\left( x + \\frac{1}{2}y \\right)^2$ 是一个实数的平方，所以其值总是非负的，即 $\\left( x + \\frac{1}{2}y \\right)^2 \\geq 0$。\n同样，表达式 $\\frac{3}{4}y^2$ 也总是非负的。\n因此，$Q(x,y)$ 是两个非负项的和，这意味着对于所有 $x, y \\in \\mathbb{R}$，$Q(x,y) \\geq 0$。\n$Q(x,y)$ 的最小值在两项同时等于 $0$ 时取得：\n1. $\\frac{3}{4}y^2 = 0 \\implies y = 0$.\n2. $\\left( x + \\frac{1}{2}y \\right)^2 = 0$。代入 $y=0$ 得到 $x^2 = 0 \\implies x = 0$。\n$Q(x,y)$ 的最小值为 $0$，在点 $(x,y) = (0,0)$ 处取得。\n因此，\n$$\n\\inf_{(x,y) \\in \\mathbb{R}^2} (x^2 + xy + y^2) = 0\n$$\n将此结果代回 $L$ 的表达式中：\n$$\nL = 1 - 0 = 1\n$$\n单边Lipschitz条件对漂移函数 $b(x) = x - x^3$ 成立，并且最紧（最小）的常数是 $L=1$。这表明，尽管 $b(x)$ 不是全局Lipschitz的（其导数 $b'(x) = 1 - 3x^2$ 在下方无界），但它满足了更弱但仍然非常有用的单边Lipschitz条件，这是诸如随机Ginzburg-Landau方程等模型中的一个共同特征。", "answer": "$$\\boxed{1}$$", "id": "2999286"}, {"introduction": "在理解了问题并掌握了关键的理论工具后，我们来具体比较两种流行的解决方案：截断欧拉格式和驯服欧拉格式。虽然两者都能控制数值爆炸，但它们的修正机制不同，这会导致在某些关键区域（例如状态变量极大时）产生不同的数值行为。本练习通过计算两种格式在特定渐近状态下的单步弱偏差，让你深入探究这些高级数值格式的设计哲学和性能差异 [@problem_id:2999335]。", "problem": "考虑标量Itô随机微分方程（SDE）\n$$\ndX_t \\;=\\; b(X_t)\\,dt \\;+\\; \\sigma(X_t)\\,dW_t,\\qquad b(x) \\;=\\; -x^3,\\quad \\sigma(x)\\;=\\; x,\n$$\n该方程由标准一维布朗运动 $W_t$ 驱动。为非全局Lipschitz系数设计的两种显式数值格式是截断Euler–Maruyama格式和驯服Euler格式。使用截断映射定义截断Euler–Maruyama格式\n$$\n\\theta_h(x)\\;=\\;\\mathrm{sign}(x)\\,\\min\\{|x|,R(h)\\},\\qquad R(h)\\;=\\;h^{-1/3},\n$$\n使得在大小为 $h>0$ 的一个时间步长内，从当前状态 $x\\in\\mathbb{R}$ 的更新由下式给出\n$$\nX^{\\mathrm{TrE}}_{n+1}\\;=\\;x \\;+\\; b\\!\\left(\\theta_h(x)\\right)\\,h \\;+\\; \\sigma\\!\\left(\\theta_h(x)\\right)\\,\\Delta W_n,\n$$\n其中 $\\Delta W_n\\sim\\mathcal{N}(0,h)$ 且与过去无关。定义驯服Euler格式为\n$$\nX^{\\mathrm{TE}}_{n+1}\\;=\\;x \\;+\\; \\frac{b(x)}{1+h\\,|b(x)|}\\,h \\;+\\; \\sigma(x)\\,\\Delta W_n.\n$$\n\n固定一个常数 $\\kappa>1$ 并考虑状态变量的边界层尺度变换\n$$\nx_h \\;=\\; \\kappa\\,R(h) \\;=\\; \\kappa\\,h^{-1/3}.\n$$\n对于此尺度变换，截断和驯服在主阶上都起作用。定义截断格式相对于驯服格式的单步条件弱偏差为\n$$\n\\delta(h)\\;:=\\;\\mathbb{E}\\!\\left[\\,X^{\\mathrm{TrE}}_{n+1}-X^{\\mathrm{TE}}_{n+1}\\,\\big|\\,X_n=x_h\\,\\right].\n$$\n仅从上述定义和Itô增量的条件期望的基本性质出发，在小时间步长极限的精确意义下，推导由截断引起的主阶偏差\n$$\n\\lim_{h\\to 0}\\,\\delta(h).\n$$\n你的最终答案必须是仅含 $\\kappa$ 的单个闭式表达式。不需要数值近似。将最终结果表示为无单位的单个解析表达式。", "solution": "目标是计算在给定的随机微分方程（SDE）和特定状态空间尺度变换下，截断Euler–Maruyama格式相对于驯服Euler格式的单步条件弱偏差 $\\delta(h)$ 的小时间步长极限。该偏差定义为\n$$\n\\delta(h)\\;:=\\;\\mathbb{E}\\!\\left[\\,X^{\\mathrm{TrE}}_{n+1}-X^{\\mathrm{TE}}_{n+1}\\,\\big|\\,X_n=x_h\\,\\right].\n$$\n首先，在应用特定尺度变换 $x_h$ 之前，我们写出两种格式在一般状态 $x$ 下的差值表达式。更新规则是：\n$$\nX^{\\mathrm{TrE}}_{n+1}\\;=\\;x \\;+\\; b\\!\\left(\\theta_h(x)\\right)\\,h \\;+\\; \\sigma\\!\\left(\\theta_h(x)\\right)\\,\\Delta W_n\n$$\n$$\nX^{\\mathrm{TE}}_{n+1}\\;=\\;x \\;+\\; \\frac{b(x)}{1+h\\,|b(x)|}\\,h \\;+\\; \\sigma(x)\\,\\Delta W_n\n$$\n差值为\n$$\nX^{\\mathrm{TrE}}_{n+1}-X^{\\mathrm{TE}}_{n+1} \\;=\\; \\left( b(\\theta_h(x))h - \\frac{b(x)}{1+h|b(x)|}h \\right) + \\left( \\sigma(\\theta_h(x)) - \\sigma(x) \\right)\\Delta W_n.\n$$\n现在我们取条件期望，给定时间步 $n$ 的状态为 $X_n = x$。由于布朗增量 $\\Delta W_n$ 与截至时间 $t_n$ 的信息无关（因此也与 $X_n=x$ 无关）且均值为零，所以 $\\mathbb{E}[\\Delta W_n | X_n=x] = \\mathbb{E}[\\Delta W_n] = 0$。利用期望的线性性质，我们得到：\n$$\n\\mathbb{E}[X^{\\mathrm{TrE}}_{n+1}-X^{\\mathrm{TE}}_{n+1} | X_n=x] \\;=\\; \\mathbb{E}\\left[\\left( b(\\theta_h(x)) - \\frac{b(x)}{1+h|b(x)|} \\right)h \\Bigg| X_n=x\\right] + \\mathbb{E}\\left[\\left( \\sigma(\\theta_h(x)) - \\sigma(x) \\right)\\Delta W_n \\Bigg| X_n=x\\right]\n$$\n$$\n\\;=\\; \\left( b(\\theta_h(x)) - \\frac{b(x)}{1+h|b(x)|} \\right)h + \\left( \\sigma(\\theta_h(x)) - \\sigma(x) \\right)\\mathbb{E}[\\Delta W_n]\n$$\n$$\n\\;=\\; \\left( b(\\theta_h(x)) - \\frac{b(x)}{1+h|b(x)|} \\right)h.\n$$\n现在，我们在特定状态 $x = x_h = \\kappa h^{-1/3}$ 处计算这个表达式，其中 $\\kappa>1$ 是一个常数。我们必须计算 $\\delta(h)$ 表达式中的每一项：\n$$\n\\delta(h) \\;=\\; \\left( b(\\theta_h(x_h)) - \\frac{b(x_h)}{1+h|b(x_h)|} \\right)h.\n$$\n各分量的计算如下：\n1.  尺度变换后的状态是 $x_h = \\kappa h^{-1/3}$。因为 $\\kappa > 1$ 且 $h > 0$，所以有 $x_h > 0$。\n2.  截断半径是 $R(h) = h^{-1/3}$。\n3.  状态的绝对值为 $|x_h| = |\\kappa h^{-1/3}| = \\kappa h^{-1/3} = \\kappa R(h)$。\n4.  因为 $\\kappa > 1$，所以有 $|x_h| > R(h)$。\n5.  截断映射 $\\theta_h(x_h)$ 定义为 $\\theta_h(x_h) = \\mathrm{sign}(x_h) \\min\\{|x_h|, R(h)\\}$。由于 $x_h > 0$ 且 $|x_h| > R(h)$，此式可简化为 $\\theta_h(x_h) = (1) \\min\\{\\kappa R(h), R(h)\\} = R(h) = h^{-1/3}$。\n6.  漂移函数是 $b(x) = -x^3$。我们对截断状态和原始尺度变换后状态计算该函数值：\n    -   $b(\\theta_h(x_h)) = b(h^{-1/3}) = -(h^{-1/3})^3 = -h^{-1}$。\n    -   $b(x_h) = b(\\kappa h^{-1/3}) = -(\\kappa h^{-1/3})^3 = -\\kappa^3 h^{-1}$。\n7.  尺度变换后状态下漂移项的绝对值为 $|b(x_h)| = |-\\kappa^3 h^{-1}| = \\kappa^3 h^{-1}$。\n8.  驯服格式漂移项分母中的驯服因子是 $1 + h|b(x_h)| = 1 + h(\\kappa^3 h^{-1}) = 1 + \\kappa^3$。\n9.  因此，驯服格式的漂移分量为 $\\frac{b(x_h)}{1+h|b(x_h)|} = \\frac{-\\kappa^3 h^{-1}}{1+\\kappa^3}$。\n\n现在，我们将这些计算出的分量代回到 $\\delta(h)$ 的表达式中：\n$$\n\\delta(h) \\;=\\; \\left( \\left(-h^{-1}\\right) - \\left(\\frac{-\\kappa^3 h^{-1}}{1+\\kappa^3}\\right) \\right)h.\n$$\n首先简化括号内的表达式：\n$$\n-h^{-1} + \\frac{\\kappa^3 h^{-1}}{1+\\kappa^3} \\;=\\; h^{-1} \\left(-1 + \\frac{\\kappa^3}{1+\\kappa^3}\\right) \\;=\\; h^{-1} \\left(\\frac{-(1+\\kappa^3) + \\kappa^3}{1+\\kappa^3}\\right) \\;=\\; h^{-1} \\left(\\frac{-1 - \\kappa^3 + \\kappa^3}{1+\\kappa^3}\\right) \\;=\\; h^{-1} \\left(\\frac{-1}{1+\\kappa^3}\\right).\n$$\n将此简化项代回到 $\\delta(h)$ 的表达式中：\n$$\n\\delta(h) \\;=\\; \\left( h^{-1} \\left(\\frac{-1}{1+\\kappa^3}\\right) \\right) h \\;=\\; \\frac{-1}{1+\\kappa^3}.\n$$\n$\\delta(h)$ 的表达式相对于时间步长 $h$ 是一个常数，这是由于尺度变换 $x_h = \\kappa h^{-1/3}$ 的特定选择创造了一个完美的平衡。\n\n最后一步是计算当 $h\\to 0$ 时的极限：\n$$\n\\lim_{h\\to 0}\\,\\delta(h) \\;=\\; \\lim_{h\\to 0}\\,\\left(-\\frac{1}{1+\\kappa^3}\\right) \\;=\\; -\\frac{1}{1+\\kappa^3}.\n$$\n这就是在指定渐近区域中，由截断相对于驯服所引起的主阶偏差。", "answer": "$$\n\\boxed{-\\frac{1}{1+\\kappa^3}}\n$$", "id": "2999335"}]}