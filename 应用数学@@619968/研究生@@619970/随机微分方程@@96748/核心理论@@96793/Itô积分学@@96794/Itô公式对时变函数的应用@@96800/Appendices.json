{"hands_on_practices": [{"introduction": "这个练习将引导你直接应用含时伊藤公式来处理一个多维度的情形。通过计算一个由线性随机微分方程（SDE）驱动的含时二次型的瞬时漂移率，你将熟练掌握在向量和矩阵设定下应用伊藤公式所需的计算技巧，特别是处理时间相关的系数和进行矩阵求导。这是一个巩固公式力学并将其应用于更复杂系统的核心实践 [@problem_id:2981911]。", "problem": "设 $(\\Omega,\\mathcal{F},(\\mathcal{F}_{t})_{t \\ge 0},\\mathbb{P})$ 为一个带滤概率空间，其上支撑一个标准的 $m$ 维布朗运动 (BM) $W_{t}$。考虑一个 $n$ 维伊藤过程 $X_{t}$，它被定义为如下线性随机微分方程 (SDE) 的唯一强解\n$$\n\\mathrm{d}X_{t} \\;=\\; M(t)\\,X_{t}\\,\\mathrm{d}t \\;+\\; \\Sigma(t)\\,\\mathrm{d}W_{t}, \\quad X_{0} \\in \\mathbb{R}^{n},\n$$\n其中 $M:[0,\\infty)\\to\\mathbb{R}^{n\\times n}$ 和 $\\Sigma:[0,\\infty)\\to\\mathbb{R}^{n\\times m}$ 是连续的矩阵值函数。设 $A:[0,\\infty)\\to\\mathbb{R}^{n\\times n}$ 是连续可微的，且对每个 $t$，$A(t)$ 都是对称的；并设 $b:[0,\\infty)\\to\\mathbb{R}^{n}$ 和 $c:[0,\\infty)\\to\\mathbb{R}$ 是连续可微的。定义时变的二次-双线性泛函 $f:[0,\\infty)\\times\\mathbb{R}^{n}\\to\\mathbb{R}$ 如下\n$$\nf(t,x) \\;=\\; x^{\\top}A(t)\\,x \\;+\\; 2\\,b(t)^{\\top}x \\;+\\; c(t).\n$$\n仅使用随机微积分和矩阵微积分的基本原理，确定标量过程 $f(t,X_{t})$ 的瞬时漂移率，即伊藤微分 $\\mathrm{d}\\big(f(t,X_{t})\\big)$ 中 $\\mathrm{d}t$ 的系数，并将其表示为当前时间 $t$ 和一个泛指状态 $x\\in\\mathbb{R}^{n}$ 的函数。您的最终答案必须是以 $t$、$x$、$A(t)$、$A'(t)$、$b(t)$、$b'(t)$、$c'(t)$、$M(t)$ 和 $\\Sigma(t)$ 表示的单个闭式解析表达式。最终答案中不要提供任何中间步骤或等式。", "solution": "该问题是有效的，因为它代表了随机微积分的一个标准的、适定的应用，具体来说是伊藤引理在一个多元伊藤过程的时变函数上的应用。所有项都得到了明确定义，并且应用该引理所需的条件均已满足。\n\n目标是求出过程 $Y_{t} = f(t, X_{t})$ 的漂移项，其中 $f(t,x) = x^{\\top}A(t)\\,x + 2\\,b(t)^{\\top}x + c(t)$，并且 $X_t$ 是一个由随机微分方程 (SDE) $\\mathrm{d}X_{t} = M(t)\\,X_{t}\\,\\mathrm{d}t + \\Sigma(t)\\,\\mathrm{d}W_{t}$ 控制的伊藤过程。\n\n此推导的基本工具是应用于函数 $f(t,x): [0, \\infty) \\times \\mathbb{R}^n \\to \\mathbb{R}$ 的多元伊藤引理，该函数在时间 $t$ 上是一次连续可微的，在状态变量 $x$ 上是二次连续可微的。对于一个漂移为 $\\mu(t, X_t)$、扩散为 $\\sigma(t, X_t)$ 的过程 $X_t$，$f(t, X_t)$ 的微分由下式给出：\n$$\n\\mathrm{d}f(t, X_{t}) = \\frac{\\partial f}{\\partial t}\\mathrm{d}t + (\\nabla_{x}f)^{\\top}\\mathrm{d}X_{t} + \\frac{1}{2}\\operatorname{Tr}\\left(\\sigma(t, X_t)\\sigma(t, X_t)^{\\top} H_{x}f\\right)\\mathrm{d}t\n$$\n其中 $\\nabla_{x}f$ 是 $f$ 关于 $x$ 的梯度向量，$H_{x}f$ 是 $f$ 关于 $x$ 的 Hessian 矩阵。\n\n过程 $f(t, X_{t})$ 的漂移率是所有与 $\\mathrm{d}t$ 成比例的项的集合。通过将 $\\mathrm{d}X_{t} = \\mu(t, X_{t})\\,\\mathrm{d}t + \\sigma(t, X_{t})\\,\\mathrm{d}W_{t}$ 代入引理，我们可以确定漂移分量：\n$$\n\\text{漂移项} = \\frac{\\partial f}{\\partial t} + (\\nabla_{x}f)^{\\top}\\mu(t, X_t) + \\frac{1}{2}\\operatorname{Tr}\\left(\\sigma(t, X_t)\\sigma(t, X_t)^{\\top} H_{x}f\\right)\n$$\n问题要求将此表达式表示为时间 $t$ 和一个泛指状态 $x \\in \\mathbb{R}^n$ 的函数。\n\n首先，我们从问题陈述中确定各个组成部分：\n- $X_t$ 的漂移为 $\\mu(t, x) = M(t)x$。\n- $X_t$ 的扩散为 $\\sigma(t, x) = \\Sigma(t)$。\n- 函数为 $f(t,x) = x^{\\top}A(t)\\,x + 2\\,b(t)^{\\top}x + c(t)$。\n\n接下来，我们计算 $f(t,x)$ 所需的偏导数：\n1.  **关于时间 $t$ 的偏导数**：\n    对每一项使用乘积法则求导，我们得到：\n    $$\n    \\frac{\\partial f}{\\partial t}(t,x) = x^{\\top}A'(t)x + 2b'(t)^{\\top}x + c'(t)\n    $$\n    其中 $A'(t) = \\frac{\\mathrm{d}A}{\\mathrm{d}t}$，$b'(t) = \\frac{\\mathrm{d}b}{\\mathrm{d}t}$，以及 $c'(t) = \\frac{\\mathrm{d}c}{\\mathrm{d}t}$。\n\n2.  **关于状态 $x$ 的梯度**：\n    我们使用标准矩阵微积分恒等式 $\\nabla_x(x^{\\top}Qx) = (Q+Q^{\\top})x$ 和 $\\nabla_x(v^{\\top}x) = v$。由于已知 $A(t)$ 是对称的（$A(t) = A(t)^{\\top}$），梯度为：\n    $$\n    \\nabla_{x}f(t,x) = \\nabla_{x}(x^{\\top}A(t)x) + \\nabla_{x}(2b(t)^{\\top}x) + \\nabla_{x}(c(t)) = 2A(t)x + 2b(t) + 0 = 2(A(t)x + b(t))\n    $$\n\n3.  **关于状态 $x$ 的 Hessian 矩阵**：\n    Hessian 矩阵是二阶偏导数矩阵，$H_x f = \\nabla_x ((\\nabla_x f)^{\\top})$。将梯度对 $x^{\\top}$ 求导可得：\n    $$\n    H_{x}f(t,x) = \\nabla_{x}\\left( (2A(t)x + 2b(t))^{\\top} \\right) = 2A(t)\n    $$\n    Hessian 矩阵即为 $2A(t)$，它相对于 $x$ 是一个常数。\n\n现在，我们将这些导数和过程系数代入漂移公式：\n$$\n\\text{漂移}(t,x) = \\left(x^{\\top}A'(t)x + 2b'(t)^{\\top}x + c'(t)\\right) + \\left(2(A(t)x + b(t))\\right)^{\\top}(M(t)x) + \\frac{1}{2}\\operatorname{Tr}\\left(\\Sigma(t)\\Sigma(t)^{\\top}(2A(t))\\right)\n$$\n让我们展开并简化此表达式的每个分量：\n- 第一项是时间导数：$x^{\\top}A'(t)x + 2b'(t)^{\\top}x + c'(t)$。\n- 第二项涉及梯度和 $X_t$ 的漂移：\n$$\n(2(A(t)x + b(t)))^{\\top}(M(t)x) = 2(x^{\\top}A(t)^{\\top} + b(t)^{\\top})(M(t)x)\n$$\n由于 $A(t)$ 是对称的，所以 $A(t)^{\\top}=A(t)$。将 $M(t)x$ 分配进去可得：\n$$\n2(x^{\\top}A(t) + b(t)^{\\top})(M(t)x) = 2x^{\\top}A(t)M(t)x + 2b(t)^{\\top}M(t)x\n$$\n- 第三项是伊藤修正项：\n$$\n\\frac{1}{2}\\operatorname{Tr}\\left(\\Sigma(t)\\Sigma(t)^{\\top}(2A(t))\\right) = \\operatorname{Tr}\\left(\\Sigma(t)\\Sigma(t)^{\\top}A(t)\\right)\n$$\n将这三个分量相加，得到总漂移率：\n$$\n\\text{漂移}(t,x) = x^{\\top}A'(t)x + 2b'(t)^{\\top}x + c'(t) + 2x^{\\top}A(t)M(t)x + 2b(t)^{\\top}M(t)x + \\operatorname{Tr}\\left(\\Sigma(t)\\Sigma(t)^{\\top}A(t)\\right)\n$$\n为了以更结构化的形式呈现，我们可以将关于 $x$ 的二次项、关于 $x$ 的线性项以及常数项进行分组。\n- **二次项**：$x^{\\top}A'(t)x + 2x^{\\top}A(t)M(t)x$。一个二次型 $v^{\\top}Qv$ 总可以通过使用 $v^{\\top}(\\frac{Q+Q^{\\top}}{2})v$ 写成带有一个对称矩阵的形式。因此，$2x^{\\top}A(t)M(t)x = x^{\\top}(A(t)M(t) + (A(t)M(t))^{\\top})x = x^{\\top}(A(t)M(t) + M(t)^{\\top}A(t)^{\\top})x$。由于 $A(t)$ 是对称的，这变为 $x^{\\top}(A(t)M(t) + M(t)^{\\top}A(t))x$。总的二次部分是 $x^{\\top}\\left(A'(t) + A(t)M(t) + M(t)^{\\top}A(t)\\right)x$。\n- **线性项**：$2b'(t)^{\\top}x + 2b(t)^{\\top}M(t)x$。这可以写成 $2(b'(t)^{\\top} + b(t)^{\\top}M(t))x = 2(b'(t) + M(t)^{\\top}b(t))^{\\top}x$。\n- **常数项**：$c'(t) + \\operatorname{Tr}\\left(\\Sigma(t)\\Sigma(t)^{\\top}A(t)\\right)$。利用迹的循环性质，这也可以写成 $\\operatorname{Tr}\\left(A(t)\\Sigma(t)\\Sigma(t)^{\\top}\\right)$。\n\n将这些分组后的项组合起来，便得到瞬时漂移率的最终表达式。", "answer": "$$\n\\boxed{x^{\\top}\\left(A'(t) + A(t)M(t) + M(t)^{\\top}A(t)\\right)x + 2\\left(b'(t) + M(t)^{\\top}b(t)\\right)^{\\top}x + c'(t) + \\operatorname{Tr}\\left(A(t)\\Sigma(t)\\Sigma(t)^{\\top}\\right)}\n$$", "id": "2981911"}, {"introduction": "这项实践展示了伊藤公式的一个经典而巧妙的应用，它在随机微分方程（SDE）和偏微分方程（PDE）之间架起了一座桥梁。我们的目标是求解一个布朗运动首次出区时间的拉普拉斯变换，这是一个重要的概率量。通过构造一个特定的鞅过程并运用停时定理，你将学习如何利用伊藤公式将一个随机过程问题转化为一个可以求解的边界值问题 [@problem_id:2981913]。", "problem": "考虑一个完备带滤概率空间 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t \\ge 0},\\mathbb{P})$，其上定义了一个一维标准布朗运动 $W=(W_t)_{t \\ge 0}$。固定实数 $a<b$ 和一个初始点 $x \\in (a,b)$。定义扩散过程 $X=(X_t)_{t \\ge 0}$ 为 $X_t = x + W_t$，并定义首次出时（一个关于 $(\\mathcal{F}_t)_{t \\ge 0}$ 的停时）为\n$$\n\\tau := \\inf\\{t \\ge 0 : X_t \\notin (a,b)\\}.\n$$\n设 $\\lambda>0$ 为固定值。请仅依赖布朗运动的基本定义和性质，且不使用任何预先给出的变换公式，构造一个含时函数，该函数与 $X$ 的复合构成一个直至停时 $\\tau$ 的鞅。请仔细论证 $X$ 在 $\\tau$ 时刻的边界行为以及应用可选停止定理（OST）所需的条件。利用这些要素，推导出一个边值问题并求解，以获得该停时的拉普拉斯变换的闭式解析表达式：\n$$\nL(x) := \\mathbb{E}_x\\!\\left[\\exp(-\\lambda \\tau)\\right],\n$$\n该表达式需用 $a$、$b$、$x$ 和 $\\lambda$ 显式表示。你的最终答案必须是单个闭式表达式。不需要数值取整。", "solution": "该问题陈述是随机微分方程理论中一个适定且标准的问题。它具有科学依据，内容自洽，且所有术语都有正式定义。因此，我们可以开始求解。\n\n我们的目标是找到过程 $X_t = x + W_t$ 首次离开区间 $(a,b)$ 的停时 $\\tau$ 的拉普拉斯变换的闭式表达式。该量定义为 $L(x) := \\mathbb{E}_x[\\exp(-\\lambda \\tau)]$，其中 $\\mathbb{E}_x$ 表示在 $X_0 = x$ 条件下的期望。题目要求我们先构造一个特定的鞅，然后应用可选停止定理（OST）来推导此结果。\n\n我们假设一个形式为 $f(t,z) = \\exp(-\\lambda t)g(z)$ 的含时函数，其中 $g(z)$ 是一个待定的二次可微函数。我们希望找到 $g$ 上的条件，使得过程 $M_t := f(t, X_t) = \\exp(-\\lambda t)g(X_t)$ 是关于滤子流 $(\\mathcal{F}_t)_{t \\ge 0}$ 的一个鞅。\n\n过程 $X_t$ 的动态为 $dX_t = dW_t$。为了找到 $M_t$ 的动态，我们对含时函数 $f(t,z)$ 应用伊藤公式（Itô's formula）。其微分 $df(t, X_t)$ 由下式给出：\n$$\ndf(t,X_t) = \\frac{\\partial f}{\\partial t}(t,X_t) dt + \\frac{\\partial f}{\\partial z}(t,X_t) dX_t + \\frac{1}{2}\\frac{\\partial^2 f}{\\partial z^2}(t,X_t) (dX_t)^2\n$$\n$f(t,z) = \\exp(-\\lambda t)g(z)$ 的偏导数是：\n$$\n\\frac{\\partial f}{\\partial t}(t,z) = -\\lambda \\exp(-\\lambda t)g(z)\n$$\n$$\n\\frac{\\partial f}{\\partial z}(t,z) = \\exp(-\\lambda t)g'(z)\n$$\n$$\n\\frac{\\partial^2 f}{\\partial z^2}(t,z) = \\exp(-\\lambda t)g''(z)\n$$\n使用伊藤积分法则 $(dX_t)^2 = (dW_t)^2 = dt$，我们将这些偏导数代入微分公式中：\n$$\ndM_t = \\left(-\\lambda \\exp(-\\lambda t)g(X_t)\\right)dt + \\left(\\exp(-\\lambda t)g'(X_t)\\right)dW_t + \\frac{1}{2}\\left(\\exp(-\\lambda t)g''(X_t)\\right)dt\n$$\n将 $dt$ 和 $dW_t$ 项合并，我们得到 $M_t$ 的随机微分方程：\n$$\ndM_t = \\exp(-\\lambda t) \\left( \\frac{1}{2}g''(X_t) - \\lambda g(X_t) \\right) dt + \\exp(-\\lambda t)g'(X_t) dW_t\n$$\n为了使 $M_t$ 成为一个（局部）鞅，其漂移项（乘以 $dt$ 的部分）必须为零。由于这个条件必须对所有 $t \\ge 0$ 和 $X_t$ 的所有可能取值都成立，这对函数 $g(z)$ 施加了以下条件：\n$$\n\\frac{1}{2}g''(z) - \\lambda g(z) = 0 \\quad \\text{for } z \\in (a,b)\n$$\n这可以简化为以下二阶常微分方程（ODE）：\n$$\ng''(z) - 2\\lambda g(z) = 0\n$$\n现在，设 $L(x)$ 为我们要求解的函数。我们将证明 $L(x)$ 满足这个常微分方程以及特定的边界条件。我们选择函数 $g$ 为 $L$ 本身，并在 $g$ 上施加边界条件，以便于计算 $L(x)$。具体来说，我们寻求上述常微分方程在 $(a,b)$ 上的解 $g(z)$，且满足边界条件 $g(a) = 1$ 和 $g(b) = 1$。\n\n设 $g(z)$ 是这个边值问题的唯一解。过程 $M_t = \\exp(-\\lambda t)g(X_t)$ 是一个鞅。我们现在对停鞅 $M_{t \\land \\tau}$ 应用可选停止定理。可选停止定理表明，如果满足某些条件，则有 $\\mathbb{E}_x[M_\\tau] = \\mathbb{E}_x[M_0]$。我们来验证这些条件：\n1.  $\\tau$ 必须是一个几乎必然有限的停时。对于从 $x \\in (a,b)$ 出发的一维标准布朗运动，其离开有限区间 $(a,b)$ 的时间是几乎必然有限的。\n2.  停过程必须是一致可积的，或者我们可以使用更简单的条件。例如，如果 $|M_{t \\land \\tau}|$ 被一个可积随机变量所界定，则可选停止定理适用。在停时 $\\tau$，根据布朗路径的连续性，$X_\\tau$ 必须位于边界上，即 $X_\\tau \\in \\{a,b\\}$ 几乎必然成立。我们对 $g$ 的选择是 $g(a)=1$ 和 $g(b)=1$，因此 $g(X_\\tau)=1$ 几乎必然成立。函数 $g$ 在紧区间 $[a,b]$ 上是连续的，因此有界。设 $K = \\sup_{z\\in[a,b]} |g(z)|$。那么对于任意 $t \\ge 0$，有 $|M_{t \\land \\tau}| = |\\exp(-\\lambda(t \\land \\tau)) g(X_{t \\land \\tau})| \\le K$，因为 $\\lambda > 0$ 且 $t \\land \\tau \\ge 0$。由于 $M_{t \\land \\tau}$ 是一致有界的，所以它是一致可积的，因此可选停止定理适用。\n\n应用可选停止定理，我们有：\n$$\n\\mathbb{E}_x[M_\\tau] = \\mathbb{E}_x[M_0]\n$$\n在时间 $t=0$ 时的值为 $M_0 = \\exp(-\\lambda \\cdot 0)g(X_0) = g(x)$。\n在停时 $\\tau$ 的值为 $M_\\tau = \\exp(-\\lambda \\tau)g(X_\\tau)$。\n因此，可选停止定理给出：\n$$\ng(x) = \\mathbb{E}_x[\\exp(-\\lambda \\tau)g(X_\\tau)]\n$$\n如前所述，路径的连续性意味着 $X_\\tau \\in \\{a,b\\}$ 几乎必然成立。根据我们对 $g$ 的构造，$g(a)=1$ 且 $g(b)=1$，这意味着 $g(X_\\tau)=1$ 几乎必然成立。将此代入方程得到：\n$$\ng(x) = \\mathbb{E}_x[\\exp(-\\lambda \\tau) \\cdot 1] = \\mathbb{E}_x[\\exp(-\\lambda \\tau)]\n$$\n这恰好是 $L(x)$ 的定义。因此，我们所求的函数 $L(x)$ 是以下边值问题的解：\n$$\n\\begin{cases}\nL''(x) - 2\\lambda L(x) = 0, & x \\in (a,b) \\\\\nL(a) = 1 \\\\\nL(b) = 1\n\\end{cases}\n$$\n我们现在求解这个边值问题（BVP）。该常微分方程的特征方程是 $r^2 - 2\\lambda = 0$，其根为 $r = \\pm\\sqrt{2\\lambda}$。设 $\\alpha = \\sqrt{2\\lambda}$。该常微分方程的通解为 $L(x) = C_1 \\exp(\\alpha x) + C_2 \\exp(-\\alpha x)$。一个等价且更方便的解空间基底由以边界为中心的双曲正弦函数给出：$L(x) = A \\sinh(\\alpha(b-x)) + B \\sinh(\\alpha(x-a))$。这种形式是解的线性组合，因此它本身也是一个解。\n\n我们应用边界条件来求解常数 $A$ 和 $B$：\n在 $x=a$ 处：\n$$\nL(a) = A \\sinh(\\alpha(b-a)) + B \\sinh(\\alpha(a-a)) = A \\sinh(\\alpha(b-a)) + B \\sinh(0) = 1\n$$\n这得到 $A \\sinh(\\alpha(b-a)) = 1$，所以 $A = \\frac{1}{\\sinh(\\alpha(b-a))}$。\n在 $x=b$ 处：\n$$\nL(b) = A \\sinh(\\alpha(b-b)) + B \\sinh(\\alpha(b-a)) = A \\sinh(0) + B \\sinh(\\alpha(b-a)) = 1\n$$\n这得到 $B \\sinh(\\alpha(b-a)) = 1$，所以 $B = \\frac{1}{\\sinh(\\alpha(b-a))}$。\n因此，我们发现 $A=B$。将这些常数代回解的形式中：\n$$\nL(x) = \\frac{1}{\\sinh(\\alpha(b-a))} \\sinh(\\alpha(b-x)) + \\frac{1}{\\sinh(\\alpha(b-a))} \\sinh(\\alpha(x-a))\n$$\n$$\nL(x) = \\frac{\\sinh(\\alpha(b-x)) + \\sinh(\\alpha(x-a))}{\\sinh(\\alpha(b-a))}\n$$\n最后，我们将 $\\alpha = \\sqrt{2\\lambda}$ 代回，以获得用给定参数表示的表达式：\n$$\nL(x) = \\frac{\\sinh(\\sqrt{2\\lambda}(b-x)) + \\sinh(\\sqrt{2\\lambda}(x-a))}{\\sinh(\\sqrt{2\\lambda}(b-a))}\n$$\n这就是停时 $\\tau$ 的拉普拉斯变换的闭式解析表达式。", "answer": "$$\\boxed{\\frac{\\sinh(\\sqrt{2\\lambda}(b-x)) + \\sinh(\\sqrt{2\\lambda}(x-a))}{\\sinh(\\sqrt{2\\lambda}(b-a))}}$$", "id": "2981913"}, {"introduction": "在掌握了基本应用之后，本次练习将带你探索SDE解的更精细结构及其在数值方法中的应用。通过推导一个解的伊藤-泰勒展开式并识别高阶项的系数，你将理解这些项对于构建比基本欧拉-丸山（Euler-Maruyama）格式更精确的数值模拟方案至关重要。这是一个进阶实践，它揭示了伊藤公式在连接连续时间理论与离散时间近似中的强大作用 [@problem_id:2981909]。", "problem": "考虑标量随机微分方程 (SDE)\n$$\n\\mathrm{d}X_{t} \\;=\\; a(t,X_{t})\\,\\mathrm{d}t \\;+\\; b(t,X_{t})\\,\\mathrm{d}W_{t},\n$$\n该方程由标准一维布朗运动 $W_{t}$ 驱动，其中漂移系数和扩散系数分别为\n$$\na(t,x) \\;=\\; \\sin(t)\\,x^{3} \\;+\\; t^{2}, \n\\qquad \nb(t,x) \\;=\\; \\exp(t)\\,\\cos(x).\n$$\n令 $\\Delta>0$ 是一个小数，并固定时间 $t$ 及其状态 $X_{t}=x$。仅使用针对时变函数 $f(t,X_{t})$ (其中 $f\\in C^{1,2}$) 的伊藤公式作为基本出发点，对 $X_{t+\\Delta}$ 在点 $(t,x)$ 附近进行伊藤-泰勒展开，展开项的均方阶数不超过 $\\Delta$。在此展开式中，会出现一个形如\n$$\n\\int_{t}^{t+\\Delta}\\!\\int_{t}^{s} \\mathrm{d}W_{r}\\,\\mathrm{d}W_{s}\n$$\n的迭代随机积分。请确定乘以该迭代随机积分的系数的解析表达式，该表达式应以 $t$ 和 $x$ 表示。给出以 $t$ 和 $x$ 表示的单一简化闭式表达式作为最终答案（不需要数值近似）。", "solution": "解答首先将增量 $X_{t+\\Delta} - X_t$ 表示为其积分形式：\n$$\nX_{t+\\Delta} - X_{t} = \\int_{t}^{t+\\Delta} a(s, X_s)\\,\\mathrm{d}s + \\int_{t}^{t+\\Delta} b(s, X_s)\\,\\mathrm{d}W_s\n$$\n为了得到伊藤-泰勒展开式，我们必须将被积函数 $a(s, X_s)$ 和 $b(s, X_s)$ 在点 $(t, x)$ 附近展开，其中 $x = X_t$。问题要求该展开式必须使用针对时变函数的伊藤公式推导。让我们关注随机积分项，因为它是所讨论的迭代随机积分的来源。\n\n我们将 $s \\in [t, t+\\Delta]$ 的被积函数 $b(s, X_s)$ 在其于时间 $t$ 的值 $b(t, X_t) = b(t,x)$ 附近展开。对函数 $f(s, y) = b(s, y)$ 应用伊藤公式，我们得到微分 $\\mathrm{d}b(s,X_s)$：\n$$\n\\mathrm{d}b(s,X_s) = \\left(\\frac{\\partial b}{\\partial s} + a(s,X_s)\\frac{\\partial b}{\\partial y} + \\frac{1}{2}b(s,X_s)^2\\frac{\\partial^2 b}{\\partial y^2}\\right)\\bigg|_{(s,X_s)}\\mathrm{d}s + \\left(b(s,X_s)\\frac{\\partial b}{\\partial y}\\right)\\bigg|_{(s,X_s)}\\mathrm{d}W_s\n$$\n让我们定义与过程 $X_t$ 相关的生成元算子 $\\mathcal{L}$ 为\n$$\n\\mathcal{L} = \\frac{\\partial}{\\partial t} + a(t,x)\\frac{\\partial}{\\partial x} + \\frac{1}{2}b(t,x)^2\\frac{\\partial^2}{\\partial x^2}\n$$\n那么，$\\mathrm{d}b(s,X_s) = (\\mathcal{L}b)(s,X_s)\\,\\mathrm{d}s + (b\\frac{\\partial b}{\\partial x})(s,X_s)\\,\\mathrm{d}W_s$。\n\n将此微分从 $t$ 积分到 $s$，得到 $b(s, X_s)$ 的展开式：\n$$\nb(s, X_s) = b(t, x) + \\int_{t}^{s} (\\mathcal{L}b)(r,X_r)\\,\\mathrm{d}r + \\int_{t}^{s} \\left(b\\frac{\\partial b}{\\partial x}\\right)(r,X_r)\\,\\mathrm{d}W_r\n$$\n现在，我们将此展开式代回到 $X_{t+\\Delta}$ 的随机积分中：\n$$\n\\int_{t}^{t+\\Delta} b(s, X_s)\\,\\mathrm{d}W_s = \\int_{t}^{t+\\Delta} \\left[ b(t, x) + \\int_{t}^{s} (\\mathcal{L}b)(r,X_r)\\,\\mathrm{d}r + \\int_{t}^{s} \\left(b\\frac{\\partial b}{\\partial x}\\right)(r,X_r)\\,\\mathrm{d}W_r \\right] \\mathrm{d}W_s\n$$\n将外层积分展开，我们得到三项：\n$$\nb(t, x) \\int_{t}^{t+\\Delta} \\mathrm{d}W_s + \\int_{t}^{t+\\Delta}\\left(\\int_{t}^{s} (\\mathcal{L}b)(r,X_r)\\,\\mathrm{d}r\\right)\\mathrm{d}W_s + \\int_{t}^{t+\\Delta}\\left(\\int_{t}^{s} \\left(b\\frac{\\partial b}{\\partial x}\\right)(r,X_r)\\,\\mathrm{d}W_r\\right)\\mathrm{d}W_s\n$$\n伊藤-泰勒展开是通过用迭代积分中被积函数在起点 $(t, x)$ 的值来近似它们而构造的。第三项是我们要关注的项：\n$$\n\\int_{t}^{t+\\Delta}\\int_{t}^{s} \\left(b\\frac{\\partial b}{\\partial x}\\right)(r,X_r)\\,\\mathrm{d}W_r\\,\\mathrm{d}W_s\n$$\n为了在展开式中找到积分 $\\int_{t}^{t+\\Delta}\\!\\int_{t}^{s} \\mathrm{d}W_{r}\\,\\mathrm{d}W_{s}$ 的系数，我们将被积函数 $(b\\frac{\\partial b}{\\partial x})(r,X_r)$ 用其在点 $(t,x)$ 的值来近似：\n$$\n\\left(b\\frac{\\partial b}{\\partial x}\\right)(r,X_r) \\approx \\left(b\\frac{\\partial b}{\\partial x}\\right)(t,x)\n$$\n这是最低阶的非零近似。于是该项变为：\n$$\n\\left(b(t,x)\\frac{\\partial b}{\\partial x}(t,x)\\right) \\int_{t}^{t+\\Delta}\\!\\int_{t}^{s} \\mathrm{d}W_r\\,\\mathrm{d}W_s\n$$\n因此，乘以指定的迭代随机积分的系数是 $b(t,x)\\frac{\\partial b}{\\partial x}(t,x)$。\n\n我们已知扩散系数：\n$$\nb(t,x) = \\exp(t)\\,\\cos(x)\n$$\n首先，我们计算它关于 $x$ 的偏导数：\n$$\n\\frac{\\partial b}{\\partial x}(t,x) = \\frac{\\partial}{\\partial x} \\left[ \\exp(t)\\,\\cos(x) \\right] = \\exp(t) [-\\sin(x)] = -\\exp(t)\\,\\sin(x)\n$$\n现在，我们计算乘积 $b(t,x)\\frac{\\partial b}{\\partial x}(t,x)$：\n$$\n\\text{系数} = \\left( \\exp(t)\\,\\cos(x) \\right) \\left( -\\exp(t)\\,\\sin(x) \\right)\n$$\n$$\n= -\\exp(t)\\exp(t)\\sin(x)\\cos(x) = -\\exp(2t)\\sin(x)\\cos(x)\n$$\n使用三角倍角公式 $\\sin(2\\theta) = 2\\sin(\\theta)\\cos(\\theta)$，这意味着 $\\sin(\\theta)\\cos(\\theta) = \\frac{1}{2}\\sin(2\\theta)$，我们可以简化表达式：\n$$\n\\text{系数} = -\\exp(2t) \\left(\\frac{1}{2}\\sin(2x)\\right) = -\\frac{1}{2}\\exp(2t)\\sin(2x)\n$$\n这就是所求系数的最终解析表达式。", "answer": "$$\n\\boxed{-\\frac{1}{2}\\exp(2t)\\sin(2x)}\n$$", "id": "2981909"}]}