{"hands_on_practices": [{"introduction": "我们从一个直观的几何场景开始动手实践。这个练习要求我们计算一个在单位圆盘上均匀分布的随机点的坐标平方$X^2$关于其到原点距离$R$的条件期望。通过将问题转换到极坐标系，我们可以利用对称性极大地简化计算，从而清晰地展示条件期望在具体几何情境下的应用。[@problem_id:467048]", "problem": "设 $(X,Y)$ 是一个在单位圆盘 $D = \\{(x,y) \\in \\mathbb{R}^2 : x^2 + y^2 \\le 1\\}$ 上服从均匀概率分布的随机向量。$D$ 的波莱尔子集上的概率测度 $P$ 由 $P(A) = \\frac{\\text{Area}(A)}{\\pi}$ 给出。定义一个新的随机变量 $R$ 为径向坐标，$R = \\sqrt{X^2+Y^2}$。\n\n求在给定随机变量 $R$ 的条件下，随机变量 $X^2$ 的条件期望，记为 $E[X^2 | R]$。最终结果应为一个关于 $R$ 的表达式。", "solution": "我们使用极坐标：$X = R\\cos\\theta$，$Y = R\\sin\\theta$。在 $R=r$ 的条件下，角 $\\theta$ 在 $[0,2\\pi]$ 上均匀分布。\n\n因此\n$$\nE[X^2 \\mid R=r]\n= E[r^2\\cos^2\\theta]\n= r^2\\,E[\\cos^2\\theta].\n$$\n\n我们计算\n$$\nE[\\cos^2\\theta]\n=\\frac{1}{2\\pi}\\int_0^{2\\pi}\\cos^2\\theta\\,d\\theta\n=\\frac{1}{2\\pi}\\cdot\\pi\n=\\tfrac12.\n$$\n\n所以\n$$\nE[X^2 \\mid R=r]\n=\\frac{r^2}{2}.\n$$", "answer": "$$\\boxed{\\frac{R^2}{2}}$$", "id": "467048"}, {"introduction": "这个练习转向了一个离散概率的经典例子：掷骰子。我们将计算一个随机变量$W = E[X|S]$的方差，其中$X$是第一次掷骰子的结果，$S$是两次独立掷骰子结果的总和。这个问题的精妙之处在于利用$X$和$Y$在给定总和$S$时的对称性，它深刻地揭示了如何运用对称性原理来简化复杂的条件期望计算。[@problem_id:1383831]", "problem": "考虑一个标准的、公平的六面骰子的两次独立投掷。令随机变量 $X$ 表示第一次投掷的结果，随机变量 $Y$ 表示第二次投掷的结果。每次投掷的可能结果为 1 到 6 的整数（包含 1 和 6），每个结果的概率相等。定义一个新的随机变量 $S$ 为这两个结果的和，即 $S = X + Y$。\n\n我们关心的是给定 $S$ 时 $X$ 的条件期望的性质。令随机变量 $W$ 定义为这个条件期望，即 $W = E[X | S]$。你的任务是计算 $W$ 的方差。", "solution": "令 $X$ 和 $Y$ 是在 $\\{1,2,3,4,5,6\\}$ 上独立同分布的随机变量，且令 $S=X+Y$。定义 $W=E[X \\mid S]$。\n\n根据条件期望的线性和可测性，\n$$\nE[X \\mid S] + E[Y \\mid S] = E[X+Y \\mid S] = E[S \\mid S] = S.\n$$\n根据给定 $S$ 时 $X$ 和 $Y$ 的对称性，我们有 $E[X \\mid S] = E[Y \\mid S]$，因此\n$$\n2\\,E[X \\mid S] = S \\quad \\Rightarrow \\quad W = E[X \\mid S] = \\frac{S}{2}.\n$$\n使用 $\\operatorname{Var}(aZ) = a^{2}\\operatorname{Var}(Z)$，\n$$\n\\operatorname{Var}(W) = \\operatorname{Var}\\!\\left(\\frac{S}{2}\\right) = \\frac{1}{4}\\operatorname{Var}(S).\n$$\n因为 $X$ 和 $Y$ 是独立的，\n$$\n\\operatorname{Var}(S) = \\operatorname{Var}(X+Y) = \\operatorname{Var}(X) + \\operatorname{Var}(Y) = 2\\,\\operatorname{Var}(X).\n$$\n计算在 $\\{1,2,3,4,5,6\\}$ 上均匀分布的 $X$ 的方差 $\\operatorname{Var}(X)$:\n$$\nE[X] = \\frac{1}{6}\\sum_{k=1}^{6} k = \\frac{7}{2}, \\qquad E[X^{2}] = \\frac{1}{6}\\sum_{k=1}^{6} k^{2} = \\frac{91}{6},\n$$\n$$\n\\operatorname{Var}(X) = E[X^{2}] - (E[X])^{2} = \\frac{91}{6} - \\left(\\frac{7}{2}\\right)^{2} = \\frac{91}{6} - \\frac{49}{4} = \\frac{35}{12}.\n$$\n因此，\n$$\n\\operatorname{Var}(S) = 2 \\cdot \\frac{35}{12} = \\frac{35}{6},\n$$\n所以\n$$\n\\operatorname{Var}(W) = \\frac{1}{4}\\cdot \\frac{35}{6} = \\frac{35}{24}.\n$$", "answer": "$$\\boxed{\\frac{35}{24}}$$", "id": "1383831"}, {"introduction": "最后，我们来处理一个更高级但极为核心的问题，它源于随机微分方程领域。本练习要求我们从第一性原理出发，证明对于由伊藤积分定义的联合高斯随机向量$(X,Y)$，条件期望$E[X|\\sigma(Y)]$是$Y$的线性函数，并推导出其系数矩阵。这个推导过程完美地体现了条件期望作为$L^2$空间中正交投影的几何本质，是理解卡尔曼滤波等现代估计理论的基石。[@problem_id:2971565]", "problem": "设 $(\\Omega,\\mathcal{F},(\\mathcal{F}_{t})_{t\\in[0,T]},\\mathbb{P})$ 是一个支撑着标准一维布朗运动 $W=(W_{t})_{t\\in[0,T]}$ 的带滤概率空间。固定 $m,n\\in\\mathbb{N}$，并设 $a:[0,T]\\to\\mathbb{R}^{m}$ 和 $B:[0,T]\\to\\mathbb{R}^{n}$ 是确定性函数，满足 $a\\in L^{2}([0,T];\\mathbb{R}^{m})$ 和 $B\\in L^{2}([0,T];\\mathbb{R}^{n})$。定义随机向量\n$$\nX \\coloneqq \\int_{0}^{T} a(t)\\,\\mathrm{d}W_{t}\\in\\mathbb{R}^{m},\\qquad\nY \\coloneqq \\int_{0}^{T} B(t)\\,\\mathrm{d}W_{t}\\in\\mathbb{R}^{n}.\n$$\n这些是良定义的伊藤积分，因此 $(X,Y)$ 是均值为零的联合高斯分布。设 $(X,Y)$ 的分块协方差矩阵 $\\Sigma$ 为\n$$\n\\Sigma \\;=\\;\n\\begin{pmatrix}\n\\Sigma_{XX} & \\Sigma_{XY} \\\\\n\\Sigma_{YX} & \\Sigma_{YY}\n\\end{pmatrix},\n$$\n其中 $\\Sigma_{XX}\\in\\mathbb{R}^{m\\times m}$，$\\Sigma_{XY}\\in\\mathbb{R}^{m\\times n}$，$\\Sigma_{YX}=\\Sigma_{XY}^{\\top}$，$\\Sigma_{YY}\\in\\mathbb{R}^{n\\times n}$，其元素由下式给出\n$$\n\\Sigma_{XX}=\\int_{0}^{T} a(t)a(t)^{\\top}\\,\\mathrm{d}t,\\qquad\n\\Sigma_{XY}=\\int_{0}^{T} a(t)B(t)^{\\top}\\,\\mathrm{d}t,\\qquad\n\\Sigma_{YY}=\\int_{0}^{T} B(t)B(t)^{\\top}\\,\\mathrm{d}t.\n$$\n假设 $\\Sigma_{YY}$ 是可逆的。\n\n仅使用适用于随机微分方程（SDE）的基本原理，即：条件期望的定义是到 $\\sigma(Y)$ 上的 $L^{2}$-正交投影，高斯向量的线性变换仍是高斯向量，以及对于联合高斯向量，不相关性意味着独立性，从第一性原理出发，推导 $\\mathbb{E}[X\\mid\\sigma(Y)]$ 是 $Y$ 的线性函数，并用 $\\Sigma$ 显式计算该系数矩阵。你的最终答案必须是 $\\mathbb{E}[X\\mid\\sigma(Y)]$ 的一个单一闭式解析表达式，用 $\\Sigma$ 的分块和 $Y$ 来表示。", "solution": "该问题要求推导由伊藤积分得到的两个联合高斯随机向量 $X$ 和 $Y$ 的条件期望 $\\mathbb{E}[X\\mid\\sigma(Y)]$。推导必须基于指定的第一性原理：将条件期望解释为 $L^{2}$-正交投影，以及高斯向量的性质。\n\n设随机向量 $X$ 是希尔伯特空间 $L^{2}(\\Omega, \\mathcal{F}, \\mathbb{P}; \\mathbb{R}^{m})$ 中的一个元素，该空间由平方可积的 $\\mathbb{R}^{m}$ 值随机变量组成。条件期望 $\\mathbb{E}[X\\mid\\sigma(Y)]$ 是 $X$ 在由 $\\sigma(Y)$-可测随机向量构成的闭子空间 $L^{2}(\\Omega, \\sigma(Y), \\mathbb{P}; \\mathbb{R}^{m})$ 上的正交投影。\n\n我们假设这个投影是 $Y$ 的一个线性函数，即存在一个确定性矩阵 $C \\in \\mathbb{R}^{m \\times n}$ 使得 $\\mathbb{E}[X\\mid\\sigma(Y)] = CY$。让我们记 $\\hat{X} \\coloneqq CY$。根据投影定理，如果 $\\hat{X}$ 确实是正交投影，那么误差向量 $X - \\hat{X}$ 必须与子空间 $L^{2}(\\Omega, \\sigma(Y), \\mathbb{P}; \\mathbb{R}^{m})$ 正交。\n\n对于零均值随机向量，正交性等价于不相关性。因此，条件是 $X - CY$ 必须与每个 $\\sigma(Y)$-可测随机向量不相关。由于 $Y$ 的分量的线性组合在由 $Y$ 生成的高斯空间中是稠密的，因此我们只需要求 $X - CY$ 与 $Y$ 本身不相关即可。这可以通过协方差矩阵表示为：\n$$\n\\mathbb{E}\\left[ (X - CY) Y^{\\top} \\right] = 0_{m \\times n}\n$$\n其中 $0_{m \\times n}$ 是 $m \\times n$ 的零矩阵。\n\n利用期望的线性性质，我们可以展开这个表达式：\n$$\n\\mathbb{E}\\left[ XY^{\\top} \\right] - \\mathbb{E}\\left[ (CY) Y^{\\top} \\right] = 0_{m \\times n}\n$$\n由于 $C$ 是一个确定性矩阵，它可以从期望中提出来：\n$$\n\\mathbb{E}\\left[ XY^{\\top} \\right] - C \\mathbb{E}\\left[ YY^{\\top} \\right] = 0_{m \\times n}\n$$\n根据定义，协方差矩阵为 $\\Sigma_{XY} = \\mathbb{E}[XY^{\\top}]$ 和 $\\Sigma_{YY} = \\mathbb{E}[YY^{\\top}]$。该方程变为：\n$$\n\\Sigma_{XY} - C \\Sigma_{YY} = 0_{m \\times n}\n$$\n题目说明矩阵 $\\Sigma_{YY}$ 是可逆的，这使我们能够解出唯一的矩阵 $C$：\n$$\nC = \\Sigma_{XY} \\Sigma_{YY}^{-1}\n$$\n维度是一致的：$\\Sigma_{XY}$ 是 $m \\times n$ 矩阵，$\\Sigma_{YY}^{-1}$ 是 $n \\times n$ 矩阵，所以 $C$ 是一个 $m \\times n$ 矩阵。\n\n至此，我们已经证明了如果条件期望 $\\mathbb{E}[X\\mid\\sigma(Y)]$ 是 $Y$ 的线性函数，那么它必然是 $\\Sigma_{XY} \\Sigma_{YY}^{-1} Y$。现在我们必须使用指定的原理，严格证明这确实是正确的表达式。\n\n让我们定义一个新的随机向量 $U \\in \\mathbb{R}^{m}$：\n$$\nU \\coloneqq X - \\Sigma_{XY} \\Sigma_{YY}^{-1} Y\n$$\n随机向量 $X$ 和 $Y$ 是联合高斯分布的。向量 $U$ 是向量 $(X,Y)$ 的线性变换，因此增广向量 $(U,Y)$ 也是联合高斯分布的。\n\n让我们计算 $U$ 和 $Y$ 的协方差：\n$$\n\\mathbb{E}[UY^{\\top}] = \\mathbb{E}\\left[ \\left(X - \\Sigma_{XY} \\Sigma_{YY}^{-1} Y\\right) Y^{\\top} \\right]\n$$\n$$\n\\mathbb{E}[UY^{\\top}] = \\mathbb{E}[XY^{\\top}] - \\Sigma_{XY} \\Sigma_{YY}^{-1} \\mathbb{E}[YY^{\\top}]\n$$\n$$\n\\mathbb{E}[UY^{\\top}] = \\Sigma_{XY} - \\Sigma_{XY} \\Sigma_{YY}^{-1} \\Sigma_{YY} = \\Sigma_{XY} - \\Sigma_{XY} = 0_{m \\times n}\n$$\n这表明 $U$ 和 $Y$ 是不相关的。联合高斯随机向量的一个基本性质是，不相关性意味着独立性。因此，$U$ 和 $Y$ 是独立的随机向量。$U$ 与 $Y$ 的独立性意味着 $U$ 与由 $Y$ 生成的 sigma-代数 $\\sigma(Y)$ 的独立性。\n\n现在我们可以计算给定 $\\sigma(Y)$ 下 $X$ 的条件期望：\n$$\n\\mathbb{E}[X\\mid\\sigma(Y)] = \\mathbb{E}[U + \\Sigma_{XY} \\Sigma_{YY}^{-1} Y \\mid \\sigma(Y)]\n$$\n根据条件期望的线性性质：\n$$\n\\mathbb{E}[X\\mid\\sigma(Y)] = \\mathbb{E}[U\\mid\\sigma(Y)] + \\mathbb{E}[\\Sigma_{XY} \\Sigma_{YY}^{-1} Y \\mid \\sigma(Y)]\n$$\n让我们分析每一项：\n1.  对于第一项，由于 $U$ 独立于 $\\sigma(Y)$，其在给定 $\\sigma(Y)$ 下的条件期望就是其无条件期望：$\\mathbb{E}[U\\mid\\sigma(Y)] = \\mathbb{E}[U]$。\n2.  对于第二项，向量 $\\Sigma_{XY} \\Sigma_{YY}^{-1} Y$ 是 $Y$ 的函数，因此是 $\\sigma(Y)$-可测的。对于任何 $\\sigma(Y)$-可测的随机向量 $Z$，都有 $\\mathbb{E}[Z\\mid\\sigma(Y)] = Z$。因此，$\\mathbb{E}[\\Sigma_{XY} \\Sigma_{YY}^{-1} Y \\mid \\sigma(Y)] = \\Sigma_{XY} \\Sigma_{YY}^{-1} Y$。\n\n结合这些结果，我们得到：\n$$\n\\mathbb{E}[X\\mid\\sigma(Y)] = \\mathbb{E}[U] + \\Sigma_{XY} \\Sigma_{YY}^{-1} Y\n$$\n我们现在计算 $U$ 的无条件期望：\n$$\n\\mathbb{E}[U] = \\mathbb{E}[X - \\Sigma_{XY} \\Sigma_{YY}^{-1} Y] = \\mathbb{E}[X] - \\Sigma_{XY} \\Sigma_{YY}^{-1} \\mathbb{E}[Y]\n$$\n题目说明 $X$ 和 $Y$ 是零均值的伊藤积分，所以 $\\mathbb{E}[X] = 0$ 且 $\\mathbb{E}[Y] = 0$。因此，$\\mathbb{E}[U] = 0$。\n\n将此代回，我们得到条件期望的最终表达式：\n$$\n\\mathbb{E}[X\\mid\\sigma(Y)] = 0 + \\Sigma_{XY} \\Sigma_{YY}^{-1} Y = \\Sigma_{XY} \\Sigma_{YY}^{-1} Y\n$$\n这个推导证实了，对于联合高斯向量，条件期望 $\\mathbb{E}[X\\mid\\sigma(Y)]$ 是 $Y$ 的一个线性函数，并且它用分块协方差矩阵的形式给出了系数矩阵的显式表达。该推导仅依赖于指定的第一性原理。", "answer": "$$\n\\boxed{\\Sigma_{XY} \\Sigma_{YY}^{-1} Y}\n$$", "id": "2971565"}]}