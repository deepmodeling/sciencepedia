{"hands_on_practices": [{"introduction": "我们从可选停止定理的最直接应用开始。这个练习旨在验证两个基本的布朗运动鞅 $B_t$ 和 $B_t^2 - t$ 在一个有界停时下的期望值。这是一个基础性的检验，确保您能正确识别鞅，并在最简单的条件下应用该定理，为更复杂的应用打下坚实基础。[@problem_id:2986591]", "problem": "令 $\\{B_{t}\\}_{t \\geq 0}$ 是一个在带滤概率空间 $(\\Omega, \\mathcal{F}, \\{\\mathcal{F}_{t}\\}_{t \\geq 0}, \\mathbb{P})$ 上的标准布朗运动，该空间满足通常条件，并装备有由 $\\{B_{t}\\}_{t \\geq 0}$ 生成的自然滤。回顾一下，布朗运动具有马尔可夫性和强马尔可夫性 (SMP)，并且 $\\{B_{t}\\}_{t \\geq 0}$ 具有独立平稳增量，其中 $B_{0} = 0$，$\\mathbb{E}[B_{t}] = 0$，$\\mathrm{Var}(B_{t}) = t$。一个停时 $\\tau$ 被称为有界的，如果存在一个确定的常数 $T$ 使得 $\\tau \\leq T$ 几乎必然成立。\n\n从这些基本定义和经过充分检验的事实出发，并引用鞅的可选停止定理 (OST) 以及强马尔可夫性，计算对于关于 $\\{\\mathcal{F}_{t}\\}_{t \\geq 0}$ 的任意有界停时 $\\tau$，期望 $\\mathbb{E}[B_{\\tau}]$ 和 $\\mathbb{E}[B_{\\tau}^{2} - \\tau]$ 的精确值。将你的最终答案表示为一个单行矩阵，其中按顺序包含 $\\mathbb{E}[B_{\\tau}]$ 和 $\\mathbb{E}[B_{\\tau}^{2} - \\tau]$ 这两个量。", "solution": "该问题要求计算对于标准布朗运动 $\\{B_{t}\\}_{t \\geq 0}$ 和任意有界停时 $\\tau$ 的期望 $\\mathbb{E}[B_{\\tau}]$ 和 $\\mathbb{E}[B_{\\tau}^{2} - \\tau]$。这将通过确定适当的鞅并应用可选停止定理 (OST) 来完成。\n\n首先，我们来验证问题的陈述。\n该问题是在随机微积分的标准数学框架内陈述的。\n**已知条件：**\n*   $\\{B_{t}\\}_{t \\geq 0}$ 是一个标准布朗运动。\n*   滤 $\\{\\mathcal{F}_{t}\\}_{t \\geq 0}$ 是由 $\\{B_{t}\\}_{t \\geq 0}$ 生成并满足通常条件的自然滤。\n*   $\\{B_{t}\\}_{t \\geq 0}$ 的性质：\n    *   $B_{0} = 0$。\n    *   独立平稳增量。\n    *   $\\mathbb{E}[B_{t}] = 0$。\n    *   $\\mathrm{Var}(B_{t}) = t$，这意味着 $\\mathbb{E}[B_{t}^2] = \\mathrm{Var}(B_{t}) + (\\mathbb{E}[B_{t}])^2 = t + 0^2 = t$。\n*   $\\tau$ 是一个关于 $\\{\\mathcal{F}_{t}\\}_{t \\geq 0}$ 的停时。\n*   $\\tau$ 是有界的，即存在一个确定的常数 $T > 0$ 使得 $\\mathbb{P}(\\tau \\leq T) = 1$。\n\n该问题具有科学依据，提法恰当，客观，并包含唯一解所需的所有必要信息。其定义和前提在概率论中是标准的。因此，该问题是有效的。我们着手求解。\n\n**第一部分：计算 $\\mathbb{E}[B_{\\tau}]$**\n\n我们考虑过程 $\\{B_{t}\\}_{t \\geq 0}$ 本身。我们首先证明它是一个关于滤 $\\{\\mathcal{F}_{t}\\}_{t \\geq 0}$ 的鞅。一个过程 $\\{X_t\\}_{t \\geq 0}$ 是鞅，如果：\n1.  对于所有 $t \\ge 0$，$X_t$ 对于滤 $\\{\\mathcal{F}_t\\}_{t \\geq 0}$ 是适应的。\n2.  对于所有 $t \\ge 0$，$\\mathbb{E}[|X_t|] < \\infty$。\n3.  对于所有 $s < t$，$\\mathbb{E}[X_t | \\mathcal{F}_s] = X_s$。\n\n对于过程 $\\{B_t\\}_{t \\geq 0}$：\n1.  根据自然滤的定义，对于所有 $t \\geq 0$，$B_t$ 都是 $\\mathcal{F}_t$-可测的，因此它是适应的。\n2.  对于所有 $t \\geq 0$，$\\mathbb{E}[|B_t|] \\leq \\sqrt{\\mathbb{E}[B_t^2]} = \\sqrt{t} < \\infty$。\n3.  对于 $s < t$，我们使用独立增量的性质：\n    $$ \\mathbb{E}[B_t | \\mathcal{F}_s] = \\mathbb{E}[B_s + (B_t - B_s) | \\mathcal{F}_s] $$\n    因为 $B_s$ 是 $\\mathcal{F}_s$-可测的，所以在条件期望中它可以被视为常数：\n    $$ \\mathbb{E}[B_t | \\mathcal{F}_s] = B_s + \\mathbb{E}[B_t - B_s | \\mathcal{F}_s] $$\n    增量 $B_t - B_s$ 独立于 sigma-代数 $\\mathcal{F}_s = \\sigma(B_u : u \\leq s)$。因此，条件期望等于无条件期望：\n    $$ \\mathbb{E}[B_t - B_s | \\mathcal{F}_s] = \\mathbb{E}[B_t - B_s] $$\n    使用平稳增量的性质以及 $\\mathbb{E}[B_t] = 0$：\n    $$ \\mathbb{E}[B_t - B_s] = \\mathbb{E}[B_{t-s}] = 0 $$\n    代入回去，我们得到：\n    $$ \\mathbb{E}[B_t | \\mathcal{F}_s] = B_s + 0 = B_s $$\n所有三个条件都满足，因此 $\\{B_t\\}_{t \\geq 0}$ 是一个鞅。这个结果本身是布朗运动马尔可夫性的直接推论。\n\n现在我们应用可选停止定理。该定理的一个版本指出，如果 $\\{X_t\\}$ 是一个鞅并且 $\\tau$ 是一个停时，那么在 $\\tau$ 是有界的条件下，$\\mathbb{E}[X_{\\tau}] = \\mathbb{E}[X_0]$。\n在我们的例子中，过程是 $\\{B_t\\}_{t \\geq 0}$，并且问题明确指出 $\\tau$ 是一个有界停时。因此，OST 的条件得到满足。\n应用 OST：\n$$ \\mathbb{E}[B_{\\tau}] = \\mathbb{E}[B_0] $$\n由于标准布朗运动从原点开始，$B_0 = 0$。因此：\n$$ \\mathbb{E}[B_{\\tau}] = \\mathbb{E}[0] = 0 $$\n\n**第二部分：计算 $\\mathbb{E}[B_{\\tau}^{2} - \\tau]$**\n\n我们考虑由 $M_t = B_t^2 - t$ 定义的过程 $\\{M_t\\}_{t \\geq 0}$。我们将证明它也是一个关于 $\\{\\mathcal{F}_t\\}_{t \\geq 0}$ 的鞅。\n1.  $B_t$ 是 $\\mathcal{F}_t$-适应的，所以 $B_t^2$ 也是 $\\mathcal{F}_t$-适应的。项 $t$ 是确定的。因此，$M_t = B_t^2 - t$ 是一个适应过程。\n2.  $\\mathbb{E}[|M_t|] = \\mathbb{E}[|B_t^2 - t|] \\leq \\mathbb{E}[B_t^2] + |t| = t + t = 2t < \\infty$。\n3.  对于 $s < t$，我们计算条件期望 $\\mathbb{E}[M_t | \\mathcal{F}_s]$：\n    $$ \\mathbb{E}[M_t | \\mathcal{F}_s] = \\mathbb{E}[B_t^2 - t | \\mathcal{F}_s] = \\mathbb{E}[B_t^2 | \\mathcal{F}_s] - t $$\n    我们将 $B_t$ 重写为 $B_s + (B_t - B_s)$：\n    $$ B_t^2 = (B_s + (B_t - B_s))^2 = B_s^2 + 2 B_s (B_t - B_s) + (B_t - B_s)^2 $$\n    取关于 $\\mathcal{F}_s$ 的条件期望：\n    $$ \\mathbb{E}[B_t^2 | \\mathcal{F}_s] = \\mathbb{E}[B_s^2 | \\mathcal{F}_s] + \\mathbb{E}[2 B_s (B_t - B_s) | \\mathcal{F}_s] + \\mathbb{E}[(B_t - B_s)^2 | \\mathcal{F}_s] $$\n    *   由于 $B_s$ 是 $\\mathcal{F}_s$-可测的，$\\mathbb{E}[B_s^2 | \\mathcal{F}_s] = B_s^2$ 且 $\\mathbb{E}[2 B_s (B_t - B_s) | \\mathcal{F}_s] = 2 B_s \\mathbb{E}[B_t - B_s | \\mathcal{F}_s]$。\n    *   增量 $B_t - B_s$ 独立于 $\\mathcal{F}_s$，因此 $\\mathbb{E}[B_t - B_s | \\mathcal{F}_s] = \\mathbb{E}[B_t - B_s] = 0$。\n    *   同样，由于独立性，$\\mathbb{E}[(B_t - B_s)^2 | \\mathcal{F}_s] = \\mathbb{E}[(B_t-B_s)^2]$。\n    *   增量 $B_t - B_s$ 服从均值为 $0$、方差为 $t-s$ 的正态分布。所以，$\\mathbb{E}[(B_t - B_s)^2] = \\mathrm{Var}(B_t - B_s) = t - s$。\n    将这些部分组合起来：\n    $$ \\mathbb{E}[B_t^2 | \\mathcal{F}_s] = B_s^2 + 2 B_s(0) + (t-s) = B_s^2 + t - s $$\n    现在，将此结果代回到 $\\mathbb{E}[M_t | \\mathcal{F}_s]$ 的表达式中：\n    $$ \\mathbb{E}[M_t | \\mathcal{F}_s] = (B_s^2 + t - s) - t = B_s^2 - s = M_s $$\n所有三个条件都满足，因此 $\\{M_t = B_t^2 - t\\}_{t \\geq 0}$ 是一个鞅。\n\n再次，由于 $\\tau$ 是一个有界停时，我们可以对鞅 $\\{M_t\\}_{t \\geq 0}$ 应用可选停止定理。\n$$ \\mathbb{E}[M_{\\tau}] = \\mathbb{E}[M_0] $$\n我们计算 $M_0$：\n$$ M_0 = B_0^2 - 0 $$\n给定 $B_0 = 0$，我们有 $M_0 = 0^2 - 0 = 0$。\n因此：\n$$ \\mathbb{E}[M_{\\tau}] = \\mathbb{E}[0] = 0 $$\n代入 $M_{\\tau}$ 的定义：\n$$ \\mathbb{E}[B_{\\tau}^2 - \\tau] = 0 $$\n\n这两个精确值是 $\\mathbb{E}[B_{\\tau}] = 0$ 和 $\\mathbb{E}[B_{\\tau}^{2} - \\tau] = 0$。最终答案应表示为一个行矩阵。", "answer": "$$ \\boxed{\\begin{pmatrix} 0 & 0 \\end{pmatrix}} $$", "id": "2986591"}, {"introduction": "在掌握了有界停时的情形后，我们将挑战扩展到无界停时。这个练习处理一个经典问题：计算布朗运动在撞击一个边界之前先到达另一个边界的概率。这要求更审慎地应用可选停止定理，促使您深入思考在无界停时下使用该定理的条件，从而加深对该定理威力与局限的理解。[@problem_id:2986583]", "problem": "设 $\\{W_{t}\\}_{t \\geq 0}$ 是一个一维标准布朗运动，起始于 $W_{0} = x$，其中 $x \\in (a,b)$，$a < b$ 是固定的实数。定义首次击中时间 $\\tau_{a} := \\inf\\{t \\geq 0 : W_{t} = a\\}$ 和 $\\tau_{b} := \\inf\\{t \\geq 0 : W_{t} = b\\}$，并令 $\\tau := \\tau_{a} \\wedge \\tau_{b}$。当 $W_{0} = x$ 时，用 $\\mathbb{P}_{x}$ 表示该过程的概率测度。仅使用布朗运动的定义性质、强马尔可夫性质以及关于布朗运动的基本鞅事实，推导概率 $\\mathbb{P}_{x}(\\tau_{a} < \\tau_{b})$ 的解析表达式。在您的推导中，通过引用可选停止定理成立的标准条件，来证明任何停时的使用以及涉及停时的极限论证的合理性。最后，证明这个概率是 $x$ 的一个线性函数。将您的最终答案表示为关于 $a$、$b$ 和 $x$ 的单个简化的封闭形式表达式。无需四舍五入。", "solution": "设 $\\{W_{t}\\}_{t \\geq 0}$ 是一个一维标准布朗运动，起始于 $W_{0} = x$，其中 $x \\in (a,b)$，$a < b$ 是固定的实数。由该过程生成的信息流记为 $\\{\\mathcal{F}_{t}\\}_{t \\geq 0}$，其中 $\\mathcal{F}_{t} = \\sigma(W_{s} : s \\leq t)$。其控制概率测度为 $\\mathbb{P}_{x}$。我们希望求出概率 $p(x) := \\mathbb{P}_{x}(\\tau_{a} < \\tau_{b})$，其中 $\\tau_{a} := \\inf\\{t \\geq 0 : W_{t} = a\\}$ 和 $\\tau_{b} := \\inf\\{t \\geq 0 : W_{t} = b\\}$ 分别是首次击中 $a$ 和 $b$ 的时间。\n\n推导过程将通过对鞅 $M_{t} = W_{t}$ 和停时 $\\tau = \\tau_{a} \\wedge \\tau_{b}$ 应用可选停止定理来进行。\n\n首先，我们证明在测度 $\\mathbb{P}_x$ 下，$\\{W_t\\}_{t \\ge 0}$ 是关于信息流 $\\{\\mathcal{F}_t\\}_{t \\ge 0}$ 的一个鞅。对于任意 $s < t$，我们必须证明 $\\mathbb{E}_{x}[W_{t} | \\mathcal{F}_{s}] = W_{s}$。\n根据条件期望的性质和布朗运动的定义，我们有：\n$$\n\\mathbb{E}_{x}[W_{t} | \\mathcal{F}_{s}] = \\mathbb{E}_{x}[W_{s} + (W_{t} - W_{s}) | \\mathcal{F}_{s}] = W_{s} + \\mathbb{E}_{x}[W_{t} - W_{s} | \\mathcal{F}_{s}]\n$$\n增量 $W_{t} - W_{s}$ 与包含在 $\\mathcal{F}_{s}$ 中的过去信息是独立的。因此，条件期望等于无条件期望：\n$$\n\\mathbb{E}_{x}[W_{t} - W_{s} | \\mathcal{F}_{s}] = \\mathbb{E}_{x}[W_{t} - W_{s}]\n$$\n标准布朗运动的增量均值为零，所以 $\\mathbb{E}_{x}[W_{t} - W_{s}] = 0$。因此，我们有：\n$$\n\\mathbb{E}_{x}[W_{t} | \\mathcal{F}_{s}] = W_{s} + 0 = W_{s}\n$$\n这证实了 $\\{W_{t}\\}_{t \\geq 0}$ 在 $\\mathbb{P}_{x}$ 下是一个鞅。\n\n接下来，我们定义停时 $\\tau = \\tau_{a} \\wedge \\tau_{b}$。这是过程 $W_{t}$ 首次离开开区间 $(a,b)$ 的时刻。要验证 $\\tau$ 是一个停时，我们必须证明对于所有 $t \\geq 0$，事件 $\\{\\tau \\leq t\\}$ 都在 $\\mathcal{F}_{t}$ 中。事件 $\\{\\tau \\leq t\\}$ 可以写为：\n$$\n\\{\\tau \\leq t\\} = \\{ \\inf_{0 \\leq s \\leq t} W_{s} \\leq a \\} \\cup \\{ \\sup_{0 \\leq s \\leq t} W_{s} \\geq b \\}\n$$\n由于布朗运动的路径是连续函数，因此在闭区间 $[0,t]$ 上的下确界和上确界是 $\\mathcal{F}_{t}$-可测的随机变量。两个 $\\mathcal{F}_{t}$-可测集的并集也是 $\\mathcal{F}_{t}$-可测的。因此，$\\tau$ 是关于 $\\{\\mathcal{F}_{t}\\}$ 的一个停时。\n\n我们现在应用可选停止定理。该定理指出，对于一个鞅 $M_{t}$ 和一个停时 $T$，在某些条件下，有 $\\mathbb{E}[M_{T}] = \\mathbb{E}[M_{0}]$。我们必须证明这些条件对于 $M_{t} = W_{t}$ 和 $T = \\tau$ 是成立的。\n一组充分条件是 $\\mathbb{P}_{x}(\\tau < \\infty) = 1$ 以及停止过程 $W_{t \\wedge \\tau}$ 是一致可积的。\n\n一维布朗运动在所有时间内都停留在一个有限区间内的概率为零。也就是说，$\\mathbb{P}_{x}(\\tau = \\infty) = 0$，这意味着 $\\mathbb{P}_{x}(\\tau < \\infty) = 1$。\n\n现在，我们考察停止过程 $\\{W_{t \\wedge \\tau}\\}_{t \\geq 0}$。对于任何时间 $s < \\tau$，根据 $\\tau$ 的定义，过程值 $W_{s}$ 严格介于 $a$ 和 $b$ 之间。由于布朗路径的连续性，在停止的瞬间，$W_{\\tau}$ 必须等于 $a$ 或 $b$。因此，对于任意 $t \\geq 0$，停止过程 $W_{t \\wedge \\tau}$ 的值始终包含在闭区间 $[a,b]$ 内。这意味着随机变量 $W_{t \\wedge \\tau}$ 是一致有界的：\n$$\na \\leq W_{t \\wedge \\tau} \\leq b \\quad \\forall t \\geq 0\n$$\n这意味着 $|W_{t \\wedge \\tau}| \\leq \\max(|a|,|b|)$。一个一致有界的随机变量族也是一致可积的。Doob 的可选停止定理的一种常见形式指出，对于一个一致可积的鞅，其期望在停时处保持不变。\n或者，更直接地，我们可以使用极限论证。对于任何固定的时间 $T_{0} > 0$，停止过程 $W_{t \\wedge T_{0}}$ 是一个有界鞅，所以 $\\mathbb{E}_{x}[W_{T_{0} \\wedge \\tau}] = \\mathbb{E}_{x}[W_{0}] = x$。我们希望让 $T_{0} \\to \\infty$。我们已经证明 $\\tau < \\infty$ 几乎必然成立，因此当 $T_{0} \\to \\infty$ 时，$T_{0} \\wedge \\tau \\to \\tau$ 几乎必然成立。根据布朗运动的路径连续性，$W_{T_{0} \\wedge \\tau} \\to W_{\\tau}$ 几乎必然成立。\n由于随机变量族 $\\{W_{T_{0} \\wedge \\tau}\\}_{T_{0} \\geq 0}$ 被 $\\max(|a|,|b|)$ 一致有界，我们可以应用有界收敛定理来交换极限和期望：\n$$\n\\mathbb{E}_{x}[W_{\\tau}] = \\mathbb{E}_{x}[\\lim_{T_{0} \\to \\infty} W_{T_{0} \\wedge \\tau}] = \\lim_{T_{0} \\to \\infty} \\mathbb{E}_{x}[W_{T_{0} \\wedge \\tau}]\n$$\n因为对于所有 $T_{0}$，都有 $\\mathbb{E}_{x}[W_{T_{0} \\wedge \\tau}] = x$，所以极限也是 $x$。因此，我们已经证明：\n$$\n\\mathbb{E}_{x}[W_{\\tau}] = x\n$$\n现在，我们用另一种方法计算这个期望。随机变量 $W_{\\tau}$ 只能取值 $a$ 或 $b$ (事件 $\\tau_{a} = \\tau_{b}$ 的概率为 $0$ )。它的分布由以下给出：\n$\\mathbb{P}_{x}(W_{\\tau} = a) = \\mathbb{P}_{x}(\\tau_{a} < \\tau_{b}) = p(x)$\n$\\mathbb{P}_{x}(W_{\\tau} = b) = \\mathbb{P}_{x}(\\tau_{b} \\leq \\tau_{a}) = 1 - p(x)$\n$W_{\\tau}$ 的期望因此是：\n$$\n\\mathbb{E}_{x}[W_{\\tau}] = a \\cdot \\mathbb{P}_{x}(W_{\\tau} = a) + b \\cdot \\mathbb{P}_{x}(W_{\\tau} = b) = a \\cdot p(x) + b \\cdot (1 - p(x))\n$$\n令 $\\mathbb{E}_{x}[W_{\\tau}]$ 的两个表达式相等：\n$$\nx = a \\cdot p(x) + b - b \\cdot p(x)\n$$\n我们现在求解 $p(x)$：\n$$\nx - b = p(x) (a - b)\n$$\n$$\np(x) = \\frac{x-b}{a-b}\n$$\n这个表达式可以通过分子分母同乘以 $-1$ 来简化：\n$$\np(x) = \\frac{-(b-x)}{-(b-a)} = \\frac{b-x}{b-a}\n$$\n这就是概率 $\\mathbb{P}_{x}(\\tau_{a} < \\tau_{b})$ 的解析表达式。我们可以将此表达式重写为：\n$$\np(x) = \\left(\\frac{-1}{b-a}\\right)x + \\frac{b}{b-a}\n$$\n这表明 $p(x)$ 是起始位置 $x$ 的一个线性函数。斜率为 $\\frac{-1}{b-a}$，截距为 $\\frac{b}{b-a}$。该推导过程遵循了要求，使用了鞅的性质和可选停止定理。", "answer": "$$\\boxed{\\frac{b-x}{b-a}}$$", "id": "2986583"}, {"introduction": "最后，我们介绍一种连接随机过程与分析学的强大替代方法。这个练习使用丁金公式 (Dynkin's formula) 为布朗运动的期望首出时间推导出一个常微分方程。通过解决这个边值问题，您将看到随机分析与偏微分方程理论之间深刻联系的一个具体实例，并体会到无穷小生成元在其中的关键作用。[@problem_id:2986589]", "problem": "设 $\\{B_{t}\\}_{t \\geq 0}$ 是一个标准一维布朗运动，从 $x \\in (a,b)$ 出发，其中 $a < b$ 是固定的实数。定义从开区间 $(a,b)$ 的首次出时为\n$$\n\\tau_{(a,b)} \\;=\\; \\inf\\{\\, t \\geq 0 \\,:\\, B_{t} \\notin (a,b) \\,\\}.\n$$\n用 $\\mathcal{L}$ 表示布朗运动的无穷小生成元，它作用于二次连续可微函数 $f \\in C^{2}(\\mathbb{R})$ 的方式为\n$$\n\\mathcal{L} f(y) \\;=\\; \\frac{1}{2}\\, f''(y).\n$$\n使用布朗运动的强马尔可夫性和关于停时的 Dynkin 公式，推导函数\n$$\nu(y) \\;=\\; \\mathbb{E}_{y}\\!\\left[\\, \\tau_{(a,b)} \\,\\right], \\quad y \\in (a,b),\n$$\n所满足的边值问题，并求解该边值问题，以获得用 $a$、$b$ 和 $x$ 表示的 $u(x)$ 的显式表达式。你的最终答案必须是单一的闭式解析表达式。无需四舍五入。", "solution": "该问题要求计算从点 $x \\in (a,b)$ 出发的标准一维布朗运动，离开开区间 $(a,b)$ 的期望首次出时。设 $\\{B_t\\}_{t \\geq 0}$ 为布朗运动，且 $B_0 = y$。我们关心的函数是 $u(y) = \\mathbb{E}_y[\\tau_{(a,b)}]$，其中 $\\tau_{(a,b)} = \\inf\\{ t \\geq 0 : B_t \\notin (a,b) \\}$。我们需要推导 $u(y)$ 满足的边值问题 (BVP)，求解它，并给出特定的值 $u(x)$。\n\n首先，我们推导 $u(y)$ 的边值问题。这包括一个在区间 $(a,b)$ 上的微分方程以及在边界 $a$ 和 $b$ 上的条件。\n\n边界条件由停时 $\\tau_{(a,b)}$ 的定义确定。如果过程从边界点（例如 $y=a$）开始，它已经处于开区间 $(a,b)$ 之外。因此，使得 $B_t \\notin (a,b)$ 的首次 $t \\geq 0$ 是 $t=0$。所以，如果出发点是 $a$ 或 $b$，则 $\\tau_{(a,b)} = 0$。根据布朗运动路径和期望算子的连续性，我们可以推断出 $u(y)$ 的边界条件：\n$$ \\lim_{y \\to a^+} u(y) = \\mathbb{E}_a[\\tau_{(a,b)}] = 0 $$\n$$ \\lim_{y \\to b^-} u(y) = \\mathbb{E}_b[\\tau_{(a,b)}] = 0 $$\n所以，边界条件是 $u(a)=0$ 和 $u(b)=0$。\n\n接下来，我们推导 $y \\in (a,b)$ 时的微分方程。我们使用强马尔可夫性。设 $\\tau_h = \\inf\\{t \\geq 0 : |B_t - y| \\geq \\epsilon\\}$ 为从区间 $(y-\\epsilon, y+\\epsilon)$ 的首次出时，其中 $\\epsilon > 0$ 很小，使得 $(y-\\epsilon, y+\\epsilon) \\subset (a,b)$。根据全期望定律以及在停时 $\\tau_h$ 应用强马尔可夫性：\n$$ u(y) = \\mathbb{E}_y[\\tau_{(a,b)}] = \\mathbb{E}_y[\\tau_h + (\\tau_{(a,b)} - \\tau_h)] = \\mathbb{E}_y[\\tau_h] + \\mathbb{E}_y[\\mathbb{E}_y[\\tau_{(a,b)} - \\tau_h | \\mathcal{F}_{\\tau_h}]] $$\n项 $\\tau_{(a,b)} - \\tau_h$ 是在时间 $\\tau_h$ 之后离开 $(a,b)$ 所需的剩余时间。根据强马尔可夫性，这等价于一个新的从 $B_{\\tau_h}$ 开始的布朗运动离开 $(a,b)$ 的出时。\n$$ \\mathbb{E}_y[\\tau_{(a,b)} - \\tau_h | \\mathcal{F}_{\\tau_h}] = \\mathbb{E}_{B_{\\tau_h}}[\\tau_{(a,b)}] = u(B_{\\tau_h}) $$\n将此代回，我们得到：\n$$ u(y) = \\mathbb{E}_y[\\tau_h] + \\mathbb{E}_y[u(B_{\\tau_h})] $$\n对于一维标准布朗运动，从区间 $(y-\\epsilon, y+\\epsilon)$ 的期望出时已知为 $\\mathbb{E}_y[\\tau_h] = \\epsilon^2$。此外，根据对称性，过程在 $y-\\epsilon$ 或 $y+\\epsilon$ 处离开的概率是相等的，所以 $\\mathbb{P}_y(B_{\\tau_h} = y+\\epsilon) = \\mathbb{P}_y(B_{\\tau_h} = y-\\epsilon) = \\frac{1}{2}$。因此：\n$$ \\mathbb{E}_y[u(B_{\\tau_h})] = \\frac{1}{2}u(y+\\epsilon) + \\frac{1}{2}u(y-\\epsilon) $$\n假设 $u$ 是二次连续可微的（$u \\in C^2(a,b)$），我们对 $u$ 在 $y$ 附近进行泰勒展开：\n$$ u(y \\pm \\epsilon) = u(y) \\pm \\epsilon u'(y) + \\frac{\\epsilon^2}{2} u''(y) \\pm \\frac{\\epsilon^3}{6} u'''(y) + O(\\epsilon^4) $$\n$$ \\mathbb{E}_y[u(B_{\\tau_h})] = \\frac{1}{2} \\left[ (u(y) + \\epsilon u'(y) + \\frac{\\epsilon^2}{2} u''(y) + O(\\epsilon^3)) + (u(y) - \\epsilon u'(y) + \\frac{\\epsilon^2}{2} u''(y) - O(\\epsilon^3)) \\right] = u(y) + \\frac{\\epsilon^2}{2} u''(y) + O(\\epsilon^4) $$\n将这些结果代入 $u(y)$ 的方程中：\n$$ u(y) = \\epsilon^2 + \\left( u(y) + \\frac{\\epsilon^2}{2} u''(y) + O(\\epsilon^4) \\right) $$\n两边减去 $u(y)$：\n$$ 0 = \\epsilon^2 + \\frac{\\epsilon^2}{2} u''(y) + O(\\epsilon^4) $$\n两边除以 $\\epsilon^2$（当 $\\epsilon \\neq 0$ 时）并取 $\\epsilon \\to 0$ 的极限：\n$$ 0 = 1 + \\frac{1}{2} u''(y) $$\n这给出了微分方程 $u''(y) = -2$，也可以使用生成元写作 $\\mathcal{L}u(y) = -1$。\n\n完整的边值问题是：\n$$ \\begin{cases} u''(y) = -2, & y \\in (a,b) \\\\ u(a) = 0 \\\\ u(b) = 0 \\end{cases} $$\n我们现在求解这个 BVP。对微分方程 $u''(y) = -2$ 关于 $y$ 积分，得到：\n$$ u'(y) = -2y + C_1 $$\n再次积分：\n$$ u(y) = -y^2 + C_1 y + C_2 $$\n其中 $C_1$ 和 $C_2$ 是积分常数。我们使用边界条件来确定它们：\n$$ u(a) = -a^2 + C_1 a + C_2 = 0 $$\n$$ u(b) = -b^2 + C_1 b + C_2 = 0 $$\n用第二个方程减去第一个方程，得到：\n$$ (-b^2 + a^2) + C_1(b-a) = 0 $$\n$$ -(b-a)(b+a) + C_1(b-a) = 0 $$\n因为 $a < b$，所以 $b-a \\neq 0$，我们可以两边除以 $(b-a)$：\n$$ -(b+a) + C_1 = 0 \\implies C_1 = a+b $$\n将 $C_1$ 代入第一个边界条件方程：\n$$ -a^2 + (a+b)a + C_2 = 0 \\implies -a^2 + a^2 + ab + C_2 = 0 \\implies C_2 = -ab $$\nBVP 的解是：\n$$ u(y) = -y^2 + (a+b)y - ab $$\n这可以因式分解为：\n$$ u(y) = -(y^2 - (a+b)y + ab) = -(y-a)(y-b) = (y-a)(b-y) $$\n让我们将这个候选解表示为 $v(y) = (y-a)(b-y)$。\n\n为了使用 Dynkin 公式严格地验证这个结果，我们证明 $v(y)$ 确实等于 $\\mathbb{E}_y[\\tau_{(a,b)}]$。函数 $v(y)$ 属于 $C^2(\\mathbb{R})$ 并满足该 BVP。作用于 $v$ 的无穷小生成元是 $\\mathcal{L}v(y) = \\frac{1}{2}v''(y) = \\frac{1}{2}(-2) = -1$。设 $\\tau = \\tau_{(a,b)}$ 并考虑有界停时 $\\tau_t = \\min(t, \\tau)$。将 Dynkin 公式应用于 $v(y)$：\n$$ \\mathbb{E}_y[v(B_{\\tau_t})] = v(y) + \\mathbb{E}_y\\left[ \\int_0^{\\tau_t} (\\mathcal{L}v)(B_s) ds \\right] $$\n代入 $\\mathcal{L}v = -1$：\n$$ \\mathbb{E}_y[v(B_{\\tau_t})] = v(y) + \\mathbb{E}_y\\left[ \\int_0^{\\tau_t} (-1) ds \\right] = v(y) - \\mathbb{E}_y[\\tau_t] $$\n整理后，我们得到期望停时的表达式：\n$$ \\mathbb{E}_y[\\tau_t] = v(y) - \\mathbb{E}_y[v(B_{\\tau_t})] $$\n现在，我们取 $t \\to \\infty$ 的极限。在左侧，当 $t \\to \\infty$ 时，$\\tau_t \\uparrow \\tau$。根据单调收敛定理，$\\lim_{t\\to\\infty} \\mathbb{E}_y[\\tau_t] = \\mathbb{E}_y[\\tau] = u(y)$。\n在右侧，当 $t \\to \\infty$ 时，$B_{\\tau_t} \\to B_\\tau$ 几乎必然成立。由于 $v$ 是连续的，$v(B_{\\tau_t}) \\to v(B_\\tau)$ 几乎必然成立。在离开时，$B_\\tau \\in \\{a,b\\}$。函数 $v(y)$ 被构造成在边界处为零：$v(a)=0$ 和 $v(b)=0$。因此，$v(B_\\tau) = 0$ 几乎必然成立。函数 $v(y)$ 在 $[a,b]$ 上是有界的，因此我们可以应用控制收敛定理：\n$$ \\lim_{t\\to\\infty} \\mathbb{E}_y[v(B_{\\tau_t})] = \\mathbb{E}_y[\\lim_{t\\to\\infty} v(B_{\\tau_t})] = \\mathbb{E}_y[v(B_\\tau)] = \\mathbb{E}_y[0] = 0 $$\n对整个方程取极限，得到：\n$$ u(y) = v(y) - 0 = v(y) $$\n这证实了我们对 BVP 的解 $v(y)=(y-a)(b-y)$ 确实是所求的期望出时 $u(y)$。\n\n问题指定出发点为 $x \\in (a,b)$。所以我们将 $y=x$ 代入我们推导出的 $u(y)$ 的表达式中：\n$$ u(x) = (x-a)(b-x) $$\n这就是期望首次出时的显式表达式。", "answer": "$$\n\\boxed{(x-a)(b-x)}\n$$", "id": "2986589"}]}