{"hands_on_practices": [{"introduction": "第一个实践鼓励我们回归第一性原理。通过将鞅的可选停止定理与反射原理相结合，我们可以严格地建立起首次到达时间 $T_a$ 和布朗运动在固定时间 $t$ 处的取值之间的关键关系。这个练习的目的不仅仅是找到正确答案，更重要的是理解随机过程理论的这两大基石是如何协同作用，揭示布朗运动的内在结构的。[@problem_id:2993858]", "problem": "设 $\\{B_t\\}_{t\\ge 0}$ 是一个标准布朗运动（也称为维纳过程），且 $B_0=0$。固定 $a>0$，定义首次到达时间 $T_a:=\\inf\\{s\\ge 0:\\, B_s=a\\}$ 和游程最大值 $M_t:=\\sup_{0\\le s\\le t} B_s$。对给定的 $t>0$，考虑有界停时 $\\tau:=T_a\\wedge t$。利用 $\\{B_t\\}_{t\\ge 0}$ 是一个鞅和在 $\\tau$ 处的任意停时定理（OST），结合 (i) 将 $B_{\\tau}$ 分解到不交事件 $\\{T_a\\le t\\}$ 和 $\\{T_a>t\\}$ 上，以及 (ii) 将事件 $\\{M_t\\ge a\\}$ 与 $B_t$ 的一维高斯尾部联系起来的布朗运动反射原理。基于这些要素，以下哪个命题必然成立？此处 $\\Phi$ 表示标准正态随机变量的累积分布函数。\n\nA. $\\mathbb{E}\\big[B_t\\,\\mathbf{1}_{\\{T_a>t\\}}\\big]\\,=\\,-a\\,\\mathbb{P}(T_a\\le t)$。\n\nB. $\\mathbb{P}(T_a\\le t)\\,=\\,\\mathbb{P}(B_t\\ge a)$。\n\nC. $\\mathbb{P}(T_a\\le t)\\,=\\,2\\big(1-\\Phi(a/\\sqrt{t})\\big)$。\n\nD. $\\mathbb{E}\\big[B_t\\,\\mathbf{1}_{\\{T_a>t\\}}\\big]\\,=\\,-\\,\\mathbb{E}\\big[B_t\\,\\mathbf{1}_{\\{B_t\\ge a\\}}\\big]$。\n\nE. $\\mathbb{E}\\big[B_t\\,\\mathbf{1}_{\\{T_a>t\\}}\\big]\\,=\\,-\\,2a\\,\\mathbb{P}(B_t\\ge a)$。\n\nF. $\\mathbb{E}\\big[B_{T_a\\wedge t}\\big]\\,=\\,a\\,\\mathbb{P}(T_a\\le t)$。\n\n选择所有适用选项，并从基本原理出发证明你的选择，不得引用任何未经证明的简化公式。", "solution": "问题陈述在科学上是合理的，且提法是恰当的。我们将首先推导给定原理的结论，然后评估每个命题。\n\n设 $\\{B_t\\}_{t \\ge 0}$ 是一个从 $B_0 = 0$ 开始的一维标准布朗运动。对于一个固定的常数 $a > 0$，首次到达时间为 $T_a = \\inf\\{s \\ge 0: B_s = a\\}$。我们考虑一个停时 $\\tau = T_a \\wedge t = \\min(T_a, t)$，其中 $t > 0$ 是给定的。\n\n首先，我们应用任意停时定理（OST）。过程 $\\{B_t\\}_{t \\ge 0}$ 是关于其自然信息流的一个鞅。停时 $\\tau$ 受固定时间 $t$ 的上界约束，因此 $\\tau \\le t$。所以，OST 的条件得到满足，我们有：\n$$\n\\mathbb{E}[B_{\\tau}] = \\mathbb{E}[B_0]\n$$\n因为 $B_0 = 0$，这意味着：\n$$\n\\mathbb{E}[B_{T_a \\wedge t}] = 0\n$$\n\n接下来，我们将这个期望分解到不交事件 $\\{T_a \\le t\\}$ 和 $\\{T_a > t\\}$ 上。这两个事件的并集是整个样本空间。\n$$\n\\mathbb{E}[B_{T_a \\wedge t}] = \\mathbb{E}[B_{T_a \\wedge t} \\cdot \\mathbf{1}_{\\{T_a \\le t\\}}] + \\mathbb{E}[B_{T_a \\wedge t} \\cdot \\mathbf{1}_{\\{T_a > t\\}}] = 0\n$$\n我们来分析每一项：\n1.  在事件 $\\{T_a \\le t\\}$ 上，停时为 $\\tau = T_a$。根据 $T_a$ 的定义和布朗运动路径的连续性，有 $B_{\\tau} = B_{T_a} = a$。因此，第一项是：\n    $$\n    \\mathbb{E}[B_{T_a} \\cdot \\mathbf{1}_{\\{T_a \\le t\\}}] = \\mathbb{E}[a \\cdot \\mathbf{1}_{\\{T_a \\le t\\}}] = a\\,\\mathbb{P}(T_a \\le t)\n    $$\n2.  在事件 $\\{T_a > t\\}$ 上，停时为 $\\tau = t$。因此，有 $B_{\\tau} = B_t$。第二项是：\n    $$\n    \\mathbb{E}[B_t \\cdot \\mathbf{1}_{\\{T_a > t\\}}]\n    $$\n\n将这些代回分解后的期望方程，得到：\n$$\na\\,\\mathbb{P}(T_a \\le t) + \\mathbb{E}[B_t\\,\\mathbf{1}_{\\{T_a > t\\}}] = 0\n$$\n这直接导出了如下关系：\n$$\n\\mathbb{E}[B_t\\,\\mathbf{1}_{\\{T_a > t\\}}] = -a\\,\\mathbb{P}(T_a \\le t)\n$$\n\n现在，我们引入反射原理。游程最大值 $M_t = \\sup_{0 \\le s \\le t} B_s$ 大于或等于 $a$ 的事件，等同于在时间 $t$ 或之前达到水平 $a$ 的事件。即 $\\{M_t \\ge a\\} = \\{T_a \\le t\\}$。反射原理指出，对于任何 $a > 0$：\n$$\n\\mathbb{P}(M_t \\ge a) = 2\\,\\mathbb{P}(B_t \\ge a)\n$$\n因此，我们有：\n$$\n\\mathbb{P}(T_a \\le t) = 2\\,\\mathbb{P}(B_t \\ge a)\n$$\n我们知道 $B_t$ 是一个均值为 $0$、方差为 $t$ 的正态分布随机变量，即 $B_t \\sim \\mathcal{N}(0, t)$。令 $Z = B_t/\\sqrt{t}$ 为一个标准正态随机变量，$Z \\sim \\mathcal{N}(0, 1)$。$Z$ 的累积分布函数（CDF）用 $\\Phi$ 表示。\n$$\n\\mathbb{P}(B_t \\ge a) = \\mathbb{P}\\left(\\frac{B_t}{\\sqrt{t}} \\ge \\frac{a}{\\sqrt{t}}\\right) = \\mathbb{P}\\left(Z \\ge \\frac{a}{\\sqrt{t}}\\right) = 1 - \\Phi\\left(\\frac{a}{\\sqrt{t}}\\right)\n$$\n将此与反射原理结合，得到：\n$$\n\\mathbb{P}(T_a \\le t) = 2\\left(1 - \\Phi\\left(\\frac{a}{\\sqrt{t}}\\right)\\right)\n$$\n\n在建立了这些基本结果之后，我们现在可以评估每个选项。\n\n**A. $\\mathbb{E}\\big[B_t\\,\\mathbf{1}_{\\{T_a>t\\}}\\big]\\,=\\,-a\\,\\mathbb{P}(T_a\\le t)$**\n如上文通过对 $B_{T_a \\wedge t}$ 应用任意停时定理推导出的，$a\\,\\mathbb{P}(T_a \\le t) + \\mathbb{E}[B_t\\,\\mathbf{1}_{\\{T_a > t\\}}] = 0$。整理此式，便精确得到该选项中的命题。\n结论：**正确**。\n\n**B. $\\mathbb{P}(T_a\\le t)\\,=\\,\\mathbb{P}(B_t\\ge a)$**\n反射原理表明 $\\mathbb{P}(T_a \\le t) = 2\\,\\mathbb{P}(B_t \\ge a)$。由于 $a > 0$ 且 $t > 0$，我们有 $\\mathbb{P}(B_t \\ge a) > 0$。因此，缺少了一个因子 2。\n结论：**错误**。\n\n**C. $\\mathbb{P}(T_a\\le t)\\,=\\,2\\big(1-\\Phi(a/\\sqrt{t})\\big)$**\n这是将反射原理与 $B_t$ 的分布相结合的直接结果。如我们初步推导所示：$\\mathbb{P}(T_a \\le t) = 2\\,\\mathbb{P}(B_t \\ge a) = 2\\left(1 - \\Phi\\left(\\frac{a}{\\sqrt{t}}\\right)\\right)$。\n结论：**正确**。\n\n**D. $\\mathbb{E}\\big[B_t\\,\\mathbf{1}_{\\{T_a>t\\}}\\big]\\,=\\,-\\,\\mathbb{E}\\big[B_t\\,\\mathbf{1}_{\\{B_t\\ge a\\}}\\big]$**\n从选项 A 可知，$\\mathbb{E}[B_t\\,\\mathbf{1}_{\\{T_a>t\\}}] = -a\\,\\mathbb{P}(T_a \\le t)$。利用反射原理，这变为 $\\mathbb{E}[B_t\\,\\mathbf{1}_{\\{T_a>t\\}}] = -2a\\,\\mathbb{P}(B_t \\ge a)$。因此，该命题等价于询问是否 $2a\\,\\mathbb{P}(B_t \\ge a) = \\mathbb{E}[B_t\\,\\mathbf{1}_{\\{B_t \\ge a\\}}]$。\n让我们计算右侧。$B_t$ 的概率密度函数是 $f(x) = \\frac{1}{\\sqrt{2\\pi t}} e^{-x^2/(2t)}$。\n$$\n\\mathbb{E}[B_t\\,\\mathbf{1}_{\\{B_t \\ge a\\}}] = \\int_a^\\infty x \\frac{1}{\\sqrt{2\\pi t}} e^{-x^2/(2t)} dx\n$$\n使用换元法 $u = x^2/(2t)$，我们得到 $du = (x/t)dx$，所以 $xdx=tdu$。\n$$\n\\int_a^\\infty x f(x) dx = \\frac{1}{\\sqrt{2\\pi t}} \\int_{a^2/(2t)}^\\infty e^{-u} (t\\,du) = \\frac{t}{\\sqrt{2\\pi t}} \\left[-e^{-u}\\right]_{a^2/(2t)}^\\infty = \\sqrt{\\frac{t}{2\\pi}} e^{-a^2/(2t)}\n$$\n因此，所讨论的恒等式为 $2a\\,\\mathbb{P}(B_t \\ge a) = \\sqrt{\\frac{t}{2\\pi}} e^{-a^2/(2t)}$。令 $z=a/\\sqrt{t}$。该恒等式为 $2z\\sqrt{t}\\,(1-\\Phi(z)) = \\sqrt{\\frac{t}{2\\pi}} e^{-z^2/2}$。\n这可以简化为 $2z(1-\\Phi(z)) = \\frac{1}{\\sqrt{2\\pi}} e^{-z^2/2} = \\phi(z)$，其中 $\\phi$ 是标准正态概率密度函数 (PDF)。这个等式通常不成立。\n结论：**错误**。\n\n**E. $\\mathbb{E}\\big[B_t\\,\\mathbf{1}_{\\{T_a>t\\}}\\big]\\,=\\,-\\,2a\\,\\mathbb{P}(B_t\\ge a)$**\n这是结合我们之前结果得出的。从选项 A，我们知道 $\\mathbb{E}[B_t\\,\\mathbf{1}_{\\{T_a > t\\}}] = -a\\,\\mathbb{P}(T_a \\le t)$。从反射原理，我们知道 $\\mathbb{P}(T_a \\le t) = 2\\,\\mathbb{P}(B_t \\ge a)$。将第二个等式代入第一个，即可得到所求的命题。\n结论：**正确**。\n\n**F. $\\mathbb{E}\\big[B_{T_a\\wedge t}\\big]\\,=\\,a\\,\\mathbb{P}(T_a\\le t)$**\n根据任意停时定理，我们已经确定 $\\mathbb{E}[B_{T_a \\wedge t}] = \\mathbb{E}[B_0] = 0$。而右侧 $a\\,\\mathbb{P}(T_a \\le t)$ 是严格为正的，因为 $a > 0$ 且对于 $t > 0$ 有 $\\mathbb{P}(T_a \\le t) > 0$。因此 $0 \\ne a\\,\\mathbb{P}(T_a \\le t)$。量 $a\\,\\mathbb{P}(T_a \\le t)$ 是 $B_{T_a \\wedge t}$ 期望分解中的一项，而不是期望本身。\n结论：**错误**。", "answer": "$$\\boxed{ACE}$$", "id": "2993858"}, {"introduction": "在基本反射原理的基础上，下一个练习将对布朗运动路径的定量分析更进一步。在这里，你将推导游程最大值 $M_t$ 和终点值 $B_t$ 的联合概率密度函数，这本身就是一个基石性的结果。通过进一步计算在给定 $M_t$ 条件下 $B_t$ 的条件密度，你将对路径的历史如何塑造其最终状态获得更深刻、更精细的理解。[@problem_id:2993824]", "problem": "设 $\\{B_{s}\\}_{0 \\leq s \\leq t}$ 是从 $B_{0}=0$ 开始的标准布朗运动，并令 $M_{t} := \\sup_{0 \\leq s \\leq t} B_{s}$ 表示其在时间 $t>0$ 之前的游走最大值。仅使用布朗运动的定义性质（独立、平稳增量和高斯转移核）以及布朗路径的反射原理，推导出 $(M_{t}, B_{t})$ 的联合概率密度函数（PDF）。然后，通过计算联合 PDF 与 $M_{t}$ 的边际 PDF 的适当比率，证明在给定 $M_{t}=m$ 的条件下，$B_{t}$ 的条件分布的支撑集为 $(-\\infty, m]$，并由一个可以解释为高斯分布的简单指数倾斜的显式表达式给出。你的最终答案应该是条件密度 $f_{B_{t}\\,|\\,M_{t}=m}(x)$ 作为 $x$、$m$ 和 $t$ 的函数的闭式表达式，并写成其最简形式。不需要数值近似；请提供精确的解析表达式。请确保支撑集限制直接编码在你的表达式中（例如，使用示性函数）。", "solution": "该问题要求推导在给定时间 $t$ 之前的游走最大值 $M_t = \\sup_{0 \\leq s \\leq t} B_s$ 等于某个值 $m$ 的条件下，标准布朗运动 $B_t$ 在时间 $t$ 的位置的条件概率密度函数（PDF）。\n\n设 $\\{B_s\\}_{s \\ge 0}$ 是从 $B_0=0$ 开始的一维标准布朗运动。其定义性质包括具有平稳和独立的增量，并且 $B_t \\sim N(0, t)$，意味着它在时间 $t$ 的位置服从均值为 $0$、方差为 $t$ 的正态分布。$B_t$ 的 PDF 由 $f_{B_t}(x) = \\frac{1}{\\sqrt{2\\pi t}} \\exp(-\\frac{x^2}{2t})$ 给出。\n\n游走最大值为 $M_t = \\sup_{0 \\leq s \\leq t} B_s$。我们被要求求出条件 PDF $f_{B_t | M_t=m}(x)$。求条件密度的标准方法是通过公式 $f_{Y|X=x}(y) = \\frac{f_{X,Y}(x,y)}{f_X(x)}$。因此，我们将首先推导 $(M_t, B_t)$ 的联合 PDF，记为 $f_{M_t, B_t}(m,x)$，以及 $M_t$ 的边际 PDF，记为 $f_{M_t}(m)$。\n\n此推导的关键工具是布朗运动的反射原理。对于任意水平 $a>0$，反射原理指出，布朗路径在时间 $t$ 之前达到水平 $a$ 并在值 $x \\le a$ 处结束的概率，等于该路径在反射值 $2a-x$ 处结束的概率。形式上，对于 $a>0$ 和 $x \\le a$：\n$$P(M_t \\ge a, B_t \\le x) = P(B_t \\ge 2a-x)$$\n注意，由于布朗路径是连续的，事件 $\\{M_t > a\\}$ 与 $\\{M_t \\ge a\\}$ 在一个概率为零的集合上是相同的。\n\n首先，我们求联合累积分布函数（CDF）$F_{M_t, B_t}(m,x) = P(M_t \\le m, B_t \\le x)$。根据定义，$B_t \\le M_t$，因此如果 $x > m$，该概率为零。因此我们考虑 $x \\le m$ 和 $m \\ge 0$ 的情况。\n使用全概率定律，我们可以写出：\n$$P(B_t \\le x) = P(M_t \\le m, B_t \\le x) + P(M_t > m, B_t \\le x)$$\n整理可得：\n$$P(M_t \\le m, B_t \\le x) = P(B_t \\le x) - P(M_t > m, B_t \\le x)$$\n对第二项应用反射原理（令 $a=m$）：\n$$P(M_t \\le m, B_t \\le x) = P(B_t \\le x) - P(B_t \\ge 2m-x)$$\n设 $\\Phi$ 为标准正态分布 $N(0,1)$ 的 CDF。由于 $B_t/\\sqrt{t} \\sim N(0,1)$，我们有 $P(B_t \\le z) = \\Phi(z/\\sqrt{t})$。对于 $x \\le m$，联合 CDF 为：\n$$F_{M_t, B_t}(m,x) = \\Phi\\left(\\frac{x}{\\sqrt{t}}\\right) - \\left(1 - \\Phi\\left(\\frac{2m-x}{\\sqrt{t}}\\right)\\right)$$\n\n为了求出联合 PDF $f_{M_t, B_t}(m,x)$，我们对 CDF 先关于 $x$ 求导，然后关于 $m$ 求导。\n$$f_{M_t, B_t}(m,x) = \\frac{\\partial^2}{\\partial m \\partial x} F_{M_t, B_t}(m,x)$$\n首先，关于 $x$ 求导，并令 $\\phi(z) = \\Phi'(z)$ 为标准正态 PDF：\n\\begin{align*}\n\\frac{\\partial}{\\partial x} F_{M_t, B_t}(m,x) &= \\frac{\\partial}{\\partial x} \\left[ \\Phi\\left(\\frac{x}{\\sqrt{t}}\\right) - 1 + \\Phi\\left(\\frac{2m-x}{\\sqrt{t}}\\right) \\right] \\\\\n&= \\frac{1}{\\sqrt{t}}\\phi\\left(\\frac{x}{\\sqrt{t}}\\right) + \\frac{1}{\\sqrt{t}}\\phi\\left(\\frac{2m-x}{\\sqrt{t}}\\right) \\cdot (-1) \\\\\n&= f_{B_t}(x) - f_{B_t}(2m-x)\n\\end{align*}\n现在，我们对这个表达式关于 $m$ 求导：\n\\begin{align*}\nf_{M_t, B_t}(m,x) &= \\frac{\\partial}{\\partial m} \\left( f_{B_t}(x) - f_{B_t}(2m-x) \\right) \\\\\n&= 0 - \\frac{d}{du}f_{B_t}(u)\\bigg|_{u=2m-x} \\cdot \\frac{\\partial(2m-x)}{\\partial m} \\\\\n&= -f'_{B_t}(2m-x) \\cdot 2\n\\end{align*}\n高斯 PDF $f_{B_t}(u) = \\frac{1}{\\sqrt{2\\pi t}} \\exp(-u^2/2t)$ 的导数是 $f'_{B_t}(u) = -\\frac{u}{t} f_{B_t}(u)$。\n代入此式，我们得到：\n$$f_{M_t, B_t}(m,x) = -2 \\left(-\\frac{2m-x}{t} f_{B_t}(2m-x)\\right) = \\frac{2(2m-x)}{t} f_{B_t}(2m-x)$$\n代入 $f_{B_t}$ 的表达式：\n$$f_{M_t, B_t}(m,x) = \\frac{2(2m-x)}{t} \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{(2m-x)^2}{2t}\\right) = \\frac{2(2m-x)}{\\sqrt{2\\pi t^3}} \\exp\\left(-\\frac{(2m-x)^2}{2t}\\right)$$\n该密度适用于 $m \\ge 0$ 和 $x \\le m$ 的情况。否则为零。\n\n接下来，我们通过将联合 PDF 对所有可能的 $x$ 值（即 $x \\in (-\\infty, m]$）进行积分，来求出最大值的边际 PDF $f_{M_t}(m)$。对于 $m \\ge 0$：\n$$f_{M_t}(m) = \\int_{-\\infty}^{m} f_{M_t, B_t}(m,x) \\,dx = \\int_{-\\infty}^{m} \\frac{2(2m-x)}{t\\sqrt{2\\pi t}} \\exp\\left(-\\frac{(2m-x)^2}{2t}\\right) \\,dx$$\n令 $u = \\frac{(2m-x)^2}{2t}$。则 $du = \\frac{2(2m-x)(-1)}{2t} \\,dx = -\\frac{2m-x}{t} \\,dx$。\n积分限从 $x \\to -\\infty$ 变为 $u \\to \\infty$，从 $x=m$ 变为 $u = \\frac{(2m-m)^2}{2t} = \\frac{m^2}{2t}$。\n$$f_{M_t}(m) = \\frac{2}{\\sqrt{2\\pi t}} \\int_{\\infty}^{m^2/(2t)} \\exp(-u) (-du) = \\frac{2}{\\sqrt{2\\pi t}} \\int_{m^2/(2t)}^{\\infty} \\exp(-u) \\,du$$\n$$f_{M_t}(m) = \\frac{2}{\\sqrt{2\\pi t}} [-\\exp(-u)]_{m^2/(2t)}^{\\infty} = \\frac{2}{\\sqrt{2\\pi t}} \\left(0 - \\left(-\\exp\\left(-\\frac{m^2}{2t}\\right)\\right)\\right)$$\n$$f_{M_t}(m) = \\frac{2}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{m^2}{2t}\\right) = \\sqrt{\\frac{2}{\\pi t}} \\exp\\left(-\\frac{m^2}{2t}\\right)$$\n这是布朗运动游走最大值的著名 PDF，对 $m \\ge 0$ 有效。\n\n最后，我们计算 $m>0$ 和 $x \\le m$ 时的条件 PDF $f_{B_t|M_t=m}(x)$：\n$$f_{B_{t}\\,|\\,M_{t}=m}(x) = \\frac{f_{M_t, B_t}(m,x)}{f_{M_t}(m)} = \\frac{\\frac{2(2m-x)}{t\\sqrt{2\\pi t}} \\exp\\left(-\\frac{(2m-x)^2}{2t}\\right)}{\\frac{2}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{m^2}{2t}\\right)}$$\n$$f_{B_{t}\\,|\\,M_{t}=m}(x) = \\frac{2m-x}{t} \\exp\\left(-\\frac{(2m-x)^2}{2t} + \\frac{m^2}{2t}\\right)$$\n我们来简化指数项：\n$$\\frac{m^2 - (2m-x)^2}{2t} = \\frac{m^2 - (4m^2 - 4mx + x^2)}{2t} = \\frac{-x^2 + 4mx - 3m^2}{2t}$$\n分子中的二次式可以因式分解：$-x^2+4mx-3m^2 = -(x^2-4mx+3m^2) = -(x-m)(x-3m)$。\n所以条件密度为：\n$$f_{B_{t}\\,|\\,M_{t}=m}(x) = \\frac{2m-x}{t} \\exp\\left(-\\frac{(x-m)(x-3m)}{2t}\\right)$$\n此表达式在 $x \\le m$ 时有效。对于 $x>m$，密度为 $0$。我们使用示性函数 $\\mathbf{1}_{x \\le m}$ 来编码这一点。问题中关于“高斯分布的指数倾斜”的提示，可以通过将指数重写为 $\\frac{-(x-m)^2+2m(x-m)}{2t}$ 来理解，它可以分解为一个以 $m$ 为中心的高斯项和一个指数倾斜项。前置因子 $(2m-x)/t$ 是归一化所必需的。此表达式是完整且精确的条件密度。", "answer": "$$\n\\boxed{\\frac{2m-x}{t} \\exp\\left(-\\frac{(x-m)(x-3m)}{2t}\\right) \\mathbf{1}_{x \\le m}}\n$$", "id": "2993824"}, {"introduction": "我们的最后一个实践将反射原理的应用扩展到一个更复杂、也更具实际意义的场景：布朗运动从一个对称区间中退出的问题。这个问题要求你思考触及两个边界的情况，这涉及到通过容斥原理多次应用反射原理。这个练习将帮助你掌握使用镜像法来近似计算边界穿越概率，并量化过程的上极限和下极限之间的相互作用。[@problem_id:2993859]", "problem": "设 $\\{B_{s}\\}_{s \\ge 0}$ 为标准布朗运动，即一个连续时间随机过程，满足 $B_{0}=0$、独立增量，且对每个 $t>0$ 有 $B_{t} \\sim \\mathcal{N}(0,t)$。定义过程最大值 $M_{t} := \\sup_{0 \\le s \\le t} B_{s}$，过程最小值 $m_{t} := \\inf_{0 \\le s \\le t} B_{s}$，以及过程绝对最大值 $A_{t} := \\sup_{0 \\le s \\le t} |B_{s}|$。固定 $t>0$ 和 $a>0$。仅使用布朗运动的基本性质和反射原理，完成以下任务：\n\n1. 以 $\\mathbb{P}(M_{t} \\ge a)$ 的形式，推导离出概率 $\\mathbb{P}(A_{t} \\ge a)$ 的上界和下界。\n\n2. 构造在时间 $t$ 前触及两侧边界事件的首次反射项近似，并用它来收紧 $\\mathbb{P}(A_{t} \\ge a)$ 的下界。\n\n3. 将平凡并集上界估计与首次反射下界估计之间的差距，量化为关于 $a$ 和 $t$ 的单个闭式表达式，并使用标准正态累积分布函数 $\\Phi$ 表示。\n\n你的最终答案必须是该差距的显式解析表达式。若使用任何近似，需从第一性原理出发严格证明修正项的符号。无需进行数值计算。", "solution": "本题是随机微积分中的一个有效练习，具体涉及布朗运动的极值问题。它要求应用反射原理来推导与布朗路径移出对称区间相关的概率。该问题具有科学依据、良定且客观。\n\n设 $\\{B_{s}\\}_{s \\ge 0}$ 为从 $B_0=0$ 出发的标准一维布朗运动。过程最大值、最小值和绝对最大值分别定义为 $M_{t} := \\sup_{0 \\le s \\le t} B_{s}$、$m_{t} := \\inf_{0 \\le s \\le t} B_{s}$ 和 $A_{t} := \\sup_{0 \\le s \\le t} |B_{s}|$。给定 $t>0$ 和 $a>0$。\n\n事件 $\\{A_t \\ge a\\}$ 意味着布朗运动路径在时间 $t$ 或之前移出区间 $(-a, a)$。这是过程达到或超过水平 $a$ 的事件与达到或低于水平 $-a$ 的事件的并集。形式上，\n$$ \\{A_t \\ge a\\} = \\{M_t \\ge a\\} \\cup \\{m_t \\le -a\\} $$\n\n根据容斥原理，该事件的概率为\n$$ \\mathbb{P}(A_t \\ge a) = \\mathbb{P}(M_t \\ge a) + \\mathbb{P}(m_t \\le -a) - \\mathbb{P}(M_t \\ge a, m_t \\le -a) $$\n\n我们将在问题三个部分的背景下分析每一项。\n\n### 第一部分：$\\mathbb{P}(A_t \\ge a)$ 的上界和下界\n\n通过注意到事件 $\\{M_t \\ge a\\}$ 是 $\\{A_t \\ge a\\}$ 的子集，可以得到一个下界。如果一条路径达到 $a$，其绝对值也达到了 $a$。因此，\n$$ \\mathbb{P}(A_t \\ge a) \\ge \\mathbb{P}(M_t \\ge a) $$\n\n一个上界由布尔不等式（并集界）应用于事件的并集给出：\n$$ \\mathbb{P}(A_t \\ge a) \\le \\mathbb{P}(M_t \\ge a) + \\mathbb{P}(m_t \\le -a) $$\n根据标准布朗运动的对称性，过程 $\\{-B_s\\}_{s \\ge 0}$ 也是一个标准布朗运动。$B_s$ 的过程最小值是 $-B_s$ 过程最大值的负值：\n$$ m_t = \\inf_{0 \\le s \\le t} B_s = - \\sup_{0 \\le s \\le t} (-B_s) $$\n由于 $-B_s$ 与 $B_s$ 同分布，$\\sup_{0 \\le s \\le t} (-B_s)$ 的分布与 $M_t$ 的分布相同。因此，\n$$ \\mathbb{P}(m_t \\le -a) = \\mathbb{P}\\left(-\\sup_{0 \\le s \\le t}(-B_s) \\le -a\\right) = \\mathbb{P}\\left(\\sup_{0 \\le s \\le t}(-B_s) \\ge a\\right) = \\mathbb{P}(M_t \\ge a) $$\n将此代入并集界，得到上界：\n$$ \\mathbb{P}(A_t \\ge a) \\le 2\\mathbb{P}(M_t \\ge a) $$\n\n### 第二和第三部分：收紧界与计算差距\n\n为进一步分析，我们需要所涉及概率的显式表达式。标准布朗运动的反射原理指出，对于任何水平 $a>0$，\n$$ \\mathbb{P}(M_t \\ge a) = 2 \\mathbb{P}(B_t \\ge a) $$\n由于 $B_t \\sim \\mathcal{N}(0, t)$，变量 $Z = B_t/\\sqrt{t}$ 服从标准正态分布 $\\mathcal{N}(0, 1)$。设 $\\Phi(z) = \\mathbb{P}(Z \\le z)$ 为标准正态累积分布函数 (CDF)。那么，\n$$ \\mathbb{P}(B_t \\ge a) = \\mathbb{P}\\left(\\frac{B_t}{\\sqrt{t}} \\ge \\frac{a}{\\sqrt{t}}\\right) = 1 - \\Phi\\left(\\frac{a}{\\sqrt{t}}\\right) = \\Phi\\left(-\\frac{a}{\\sqrt{t}}\\right) $$\n所以，我们有：\n$$ \\mathbb{P}(M_t \\ge a) = 2 \\Phi\\left(-\\frac{a}{\\sqrt{t}}\\right) $$\n\n问题要求计算“平凡并集上界估计”与“首次反射下界估计”之间的差距。\n\n**平凡并集上界估计**，记为 $U$，是第一部分中推导出的上界：\n$$ U = \\mathbb{P}(M_t \\ge a) + \\mathbb{P}(m_t \\le -a) = 2 \\mathbb{P}(M_t \\ge a) = 4 \\Phi\\left(-\\frac{a}{\\sqrt{t}}\\right) $$\n\n为了找到下界估计，我们需要一个更精确的 $\\mathbb{P}(A_t \\ge a)$ 表达式。这通常通过计算生存概率 $\\mathbb{P}(A_t < a) = \\mathbb{P}(\\forall s \\in [0,t], -a < B_s < a)$ 来找到，这涉及求解带有吸收边界条件的热方程。该解由镜像法（反射原理的推广）导出，给出了路径在时间 $t$ 位于位置 $x \\in (-a, a)$ 且未曾移出该区间的概率密度：\n$$ p_t(x) = \\frac{1}{\\sqrt{2\\pi t}} \\sum_{k=-\\infty}^{\\infty} (-1)^k \\exp\\left(-\\frac{(x-2ka)^2}{2t}\\right) $$\n生存概率是该密度在 $(-a, a)$ 上的积分：\n$$ \\mathbb{P}(A_t < a) = \\int_{-a}^a p_t(x) dx = \\sum_{k=-\\infty}^{\\infty} (-1)^k \\int_{-a}^a \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{(x-2ka)^2}{2t}\\right) dx $$\n通过换元 $z = (x-2ka)/\\sqrt{t}$，每个积分都变成一个涉及 $\\Phi$ 的表达式：\n$$ \\int_{-a}^a \\dots dx = \\Phi\\left(\\frac{a-2ka}{\\sqrt{t}}\\right) - \\Phi\\left(\\frac{-a-2ka}{\\sqrt{t}}\\right) $$\n因此，离出概率 $\\mathbb{P}(A_t \\ge a) = 1 - \\mathbb{P}(A_t < a)$ 可以写成一个无穷级数。令 $c = a/\\sqrt{t}$。$\\mathbb{P}(A_t \\ge a)$ 的级数为：\n$$ \\mathbb{P}(A_t \\ge a) = 4\\Phi(-c) - 2\\Phi(-3c) + 2\\Phi(-5c) - 2\\Phi(-7c) + \\dots $$\n我们可以将其与我们最初的公式联系起来：\n$$ \\mathbb{P}(A_t \\ge a) = 2\\mathbb{P}(M_t \\ge a) - \\mathbb{P}(M_t \\ge a, m_t \\le -a) $$\n这表明，代表触及两侧边界事件的交集概率由以下级数给出：\n$$ \\mathbb{P}(M_t \\ge a, m_t \\le -a) = 2\\Phi\\left(-\\frac{3a}{\\sqrt{t}}\\right) - 2\\Phi\\left(-\\frac{5a}{\\sqrt{t}}\\right) + \\dots $$\n问题中的“触及两侧边界事件的首次反射项近似”指的是该级数展开中的第一项。该项 $2\\Phi(-3a/\\sqrt{t})$ 对应于在每个边界上被反射一次的路径。\n\n**首次反射下界估计**，记为 $L$，是通过从并集界估计 $U$ 中减去交集概率的这个首项近似得到的：\n$$ L = U - 2\\Phi\\left(-\\frac{3a}{\\sqrt{t}}\\right) = 4\\Phi\\left(-\\frac{a}{\\sqrt{t}}\\right) - 2\\Phi\\left(-\\frac{3a}{\\sqrt{t}}\\right) $$\n这是一个下界估计，因为 $\\mathbb{P}(M_t \\ge a, m_t \\le -a)$ 的级数是一个各项为正的递减交错级数。截断至第一项会得到交集概率的一个上界，从 $U$ 中减去这个上界，会得到总概率 $\\mathbb{P}(A_t \\ge a)$ 的一个下界。\n\n最后，我们计算平凡并集上界估计 $U$ 和首次反射下界估计 $L$ 之间的差距：\n$$ \\text{Gap} = U - L = 4\\Phi\\left(-\\frac{a}{\\sqrt{t}}\\right) - \\left[4\\Phi\\left(-\\frac{a}{\\sqrt{t}}\\right) - 2\\Phi\\left(-\\frac{3a}{\\sqrt{t}}\\right)\\right] $$\n$$ \\text{Gap} = 2\\Phi\\left(-\\frac{3a}{\\sqrt{t}}\\right) $$\n该表达式按照要求，使用标准正态CDF以闭式形式量化了此差距。它代表了对并集界的领头阶修正，考虑了那些触及两个边界的路径。", "answer": "$$\\boxed{2\\Phi\\left(-\\frac{3a}{\\sqrt{t}}\\right)}$$", "id": "2993859"}]}