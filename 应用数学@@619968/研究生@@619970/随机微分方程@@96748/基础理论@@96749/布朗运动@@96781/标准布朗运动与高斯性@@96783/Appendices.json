{"hands_on_practices": [{"introduction": "本节的第一个练习将多维布朗运动的抽象定义与具体且广泛应用的卡方分布联系起来。通过推导一个粒子在 $t$ 时刻与其原点距离的平方的分布，您将巩固对布朗运动基本高斯性质的理解。这个练习是掌握布朗运动作为一种高斯过程的核心特征的基石 [@problem_id:2996356]。", "problem": "设 $\\{W_{t}\\}_{t \\geq 0}$ 是一个 $d$ 维标准布朗运动，意味着 $W_{0} = 0$，它具有独立且平稳的增量，并且对于每个固定的 $t > 0$，随机向量 $W_{t}$ 是均值为 $0$、协方差矩阵为 $t I_{d}$ 的高斯向量，其中 $I_{d}$ 是 $d \\times d$ 单位矩阵。定义在时间 $t$ 的欧几里得范数的平方为 $R_{t}^{2} := \\|W_{t}\\|^{2} = \\sum_{i=1}^{d} \\left(W_{t}^{(i)}\\right)^{2}$，其中 $W_{t}^{(i)}$ 表示 $W_{t}$ 的第 $i$ 个坐标。仅使用布朗运动和高斯向量的基本性质，推导 $R_{t}^{2}$ 的概率分布，并证明它在分布上等于一个自由度为 $d$ 的卡方随机变量的 $t$ 倍。作为最终答案，请提供矩生成函数 (MGF) $M_{R_{t}^{2}}(s) := \\mathbb{E}[\\exp(s R_{t}^{2})]$ 的单一闭式解析表达式，该表达式是关于 $s$、$t$ 和 $d$ 的函数，并在其有限性定义域内有效。无需进行数值近似。", "solution": "问题陈述经核实具有科学依据、提法明确且客观。这是随机过程理论中的一个标准问题。所有提供的信息都是自洽和一致的。\n\n设 $\\{W_{t}\\}_{t \\geq 0}$ 是一个 $d$ 维标准布朗运动。根据问题定义，对于任意固定的时间 $t > 0$，向量 $W_{t}$ 是一个高斯随机向量，其均值向量为 $\\mathbb{E}[W_{t}] = 0$，协方差矩阵为 $\\text{Cov}(W_{t}) = t I_{d}$，其中 $I_{d}$ 是 $d \\times d$ 单位矩阵。\n\n向量 $W_{t}$ 的分量表示为 $W_{t} = (W_{t}^{(1)}, W_{t}^{(2)}, \\ldots, W_{t}^{(d)})$。协方差矩阵为 $t I_{d}$ 意味着对于任意 $i, j \\in \\{1, \\ldots, d\\}$：\n$$\n\\text{Cov}(W_{t}^{(i)}, W_{t}^{(j)}) = (t I_{d})_{ij} = \\begin{cases} t & \\text{if } i=j \\\\ 0 & \\text{if } i \\neq j \\end{cases}\n$$\n由于高斯向量的分量不相关当且仅当它们是独立的，所以随机变量 $W_{t}^{(1)}, W_{t}^{(2)}, \\ldots, W_{t}^{(d)}$ 是相互独立的。\n\n对于每个分量 $W_{t}^{(i)}$，其分布是正态的。均值是均值向量的第 $i$ 个分量，即 $\\mathbb{E}[W_{t}^{(i)}] = 0$。方差是协方差矩阵的第 $i$ 个对角元素，即 $\\text{Var}(W_{t}^{(i)}) = t$。因此，对于每个 $i \\in \\{1, \\ldots, d\\}$，随机变量 $W_{t}^{(i)}$ 服从正态分布 $N(0, t)$。\n\n为了将其与卡方分布联系起来，我们首先需要将这些正态随机变量标准化。一个标准正态随机变量 $Z$ 的均值为 $0$，方差为 $1$，即 $Z \\sim N(0, 1)$。让我们为 $i=1, \\ldots, d$ 定义一组新的随机变量 $Z_{i}$：\n$$\nZ_{i} = \\frac{W_{t}^{(i)}}{\\sqrt{t}}\n$$\n$Z_{i}$ 的均值为 $\\mathbb{E}[Z_{i}] = \\frac{1}{\\sqrt{t}}\\mathbb{E}[W_{t}^{(i)}] = 0$。$Z_{i}$ 的方差为 $\\text{Var}(Z_{i}) = \\frac{1}{(\\sqrt{t})^{2}}\\text{Var}(W_{t}^{(i)}) = \\frac{1}{t} \\cdot t = 1$。由于正态随机变量的线性变换仍然是正态的，所以每个 $Z_{i}$ 都是一个标准正态随机变量，即 $Z_{i} \\sim N(0, 1)$。此外，因为 $W_{t}^{(i)}$ 是相互独立的，所以 $Z_{i}$ 也是相互独立的。\n\n自由度为 $d$ 的卡方分布（记作 $\\chi^{2}(d)$）定义为 $d$ 个独立标准正态随机变量的平方和的分布。设 $Y = \\sum_{i=1}^{d} Z_{i}^{2}$。根据定义，$Y \\sim \\chi^{2}(d)$。\n\n现在，我们将 $Z_{i}$ 的定义代入该和式中：\n$$\nY = \\sum_{i=1}^{d} Z_{i}^{2} = \\sum_{i=1}^{d} \\left(\\frac{W_{t}^{(i)}}{\\sqrt{t}}\\right)^{2} = \\frac{1}{t} \\sum_{i=1}^{d} \\left(W_{t}^{(i)}\\right)^{2}\n$$\n最终表达式中的和式正是 $W_{t}$ 的欧几里得范数平方的定义，即 $R_{t}^{2} := \\|W_{t}\\|^{2} = \\sum_{i=1}^{d} (W_{t}^{(i)})^{2}$。\n因此，我们建立了如下关系：\n$$\nY = \\frac{R_{t}^{2}}{t}\n$$\n由于 $Y \\sim \\chi^{2}(d)$，可得 $\\frac{R_{t}^{2}}{t} \\sim \\chi^{2}(d)$。这证明了随机变量 $R_{t}^{2}$ 在分布上等于一个自由度为 $d$ 的卡方随机变量的 $t$ 倍。\n\n接下来，我们推导 $R_{t}^{2}$ 的矩生成函数 (MGF)，定义为 $M_{R_{t}^{2}}(s) := \\mathbb{E}[\\exp(s R_{t}^{2})]$。我们将直接进行推导。\n$$\nM_{R_{t}^{2}}(s) = \\mathbb{E}\\left[\\exp\\left(s R_{t}^{2}\\right)\\right] = \\mathbb{E}\\left[\\exp\\left(s \\sum_{i=1}^{d} \\left(W_{t}^{(i)}\\right)^{2}\\right)\\right]\n$$\n使用性质 $\\exp(a+b) = \\exp(a)\\exp(b)$，我们可以将和的指数写成指数的乘积：\n$$\nM_{R_{t}^{2}}(s) = \\mathbb{E}\\left[\\prod_{i=1}^{d} \\exp\\left(s \\left(W_{t}^{(i)}\\right)^{2}\\right)\\right]\n$$\n由于随机变量 $W_{t}^{(1)}, \\ldots, W_{t}^{(d)}$ 是相互独立的，它们乘积的期望等于它们期望的乘积：\n$$\nM_{R_{t}^{2}}(s) = \\prod_{i=1}^{d} \\mathbb{E}\\left[\\exp\\left(s \\left(W_{t}^{(i)}\\right)^{2}\\right)\\right]\n$$\n如前所述，每个 $W_{t}^{(i)}$ 都服从相同的分布 $N(0, t)$。因此，乘积中的所有项都是相同的。设 $X$ 是一个服从分布 $N(0, t)$ 的随机变量。该表达式简化为：\n$$\nM_{R_{t}^{2}}(s) = \\left( \\mathbb{E}\\left[\\exp\\left(s X^{2}\\right)\\right] \\right)^{d}\n$$\n我们使用 $X \\sim N(0, t)$ 的概率密度函数 (PDF) $f_{X}(x) = \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{x^{2}}{2t}\\right)$ 来计算期望 $\\mathbb{E}[\\exp(s X^{2})]$。\n$$\n\\mathbb{E}[\\exp(s X^{2})] = \\int_{-\\infty}^{\\infty} \\exp(sx^{2}) f_{X}(x) dx = \\int_{-\\infty}^{\\infty} \\exp(sx^{2}) \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{x^{2}}{2t}\\right) dx\n$$\n$$\n= \\frac{1}{\\sqrt{2\\pi t}} \\int_{-\\infty}^{\\infty} \\exp\\left(sx^{2} - \\frac{x^{2}}{2t}\\right) dx = \\frac{1}{\\sqrt{2\\pi t}} \\int_{-\\infty}^{\\infty} \\exp\\left(-x^{2} \\left(\\frac{1}{2t} - s\\right)\\right) dx\n$$\n这个积分是形式为 $\\int_{-\\infty}^{\\infty} \\exp(-ax^{2})dx = \\sqrt{\\frac{\\pi}{a}}$ 的高斯积分。为了使积分收敛，$-x^{2}$ 的系数必须为正。这就要求条件 $\\frac{1}{2t} - s > 0$，简化后为 $s < \\frac{1}{2t}$。\n令 $a = \\frac{1}{2t} - s = \\frac{1-2st}{2t}$。积分的值为 $\\sqrt{\\frac{\\pi}{a}} = \\sqrt{\\frac{2\\pi t}{1-2st}}$。\n将此结果代回期望的表达式中：\n$$\n\\mathbb{E}[\\exp(s X^{2})] = \\frac{1}{\\sqrt{2\\pi t}} \\sqrt{\\frac{2\\pi t}{1-2st}} = \\frac{1}{\\sqrt{1-2st}} = (1-2st)^{-1/2}\n$$\n最后，我们将此结果取 $d$ 次方，以求得 $R_{t}^{2}$ 的矩生成函数：\n$$\nM_{R_{t}^{2}}(s) = \\left((1-2st)^{-1/2}\\right)^{d} = (1-2st)^{-d/2}\n$$\n这个表达式在 $s < \\frac{1}{2t}$ 时有效，这是矩生成函数的有限性定义域。这个结果与伽马分布随机变量的矩生成函数一致，具体来说是一个缩放后的卡方变量。一个 $\\chi^{2}(d)$ 变量的矩生成函数为 $(1-2u)^{-d/2}$。对于 $R_{t}^{2} \\sim t \\cdot \\chi^{2}(d)$，其矩生成函数为 $M_{R_{t}^{2}}(s) = \\mathbb{E}[\\exp(s(tY))] = \\mathbb{E}[\\exp((st)Y)] = M_{Y}(st) = (1-2st)^{-d/2}$，其中 $Y \\sim \\chi^{2}(d)$，这证实了我们的直接计算。\n\n因此，矩生成函数的最终闭式解析表达式为 $(1-2st)^{-d/2}$。", "answer": "$$\n\\boxed{(1 - 2st)^{-d/2}}\n$$", "id": "2996356"}, {"introduction": "布朗运动除了其静态的分布特性外，还表现出一个至关重要的动态特性：它是一个鞅。这个练习将挑战您运用可选停止定理来探索该性质的深刻内涵，这是现代概率论的基石，在金融数学等领域具有深远影响。您将研究在何种条件下，一个被随机停止的布朗运动的期望值仍然为零 [@problem_id:2996340]。", "problem": "设 $\\{B_{t}\\}_{t \\geq 0}$ 是在满足常规条件的带滤概率空间 $(\\Omega,\\mathcal{F},\\{\\mathcal{F}_{t}\\}_{t \\geq 0},\\mathbb{P})$ 上的标准布朗运动，且 $B_{0}=0$。回顾可知，$B_{t}$ 是一个二次变差为 $\\langle B\\rangle_{t}=t$ 的连续 $\\{\\mathcal{F}_{t}\\}$-鞅，并且 $M_{t}=B_{t}^{2}-t$ 也是一个 $\\{\\mathcal{F}_{t}\\}$-鞅。设 $\\tau$ 是一个 $\\{\\mathcal{F}_{t}\\}$-停时。\n\n1. 假设 $\\tau$ 几乎必然被一个确定的常数 $T \\in (0,\\infty)$ 所界定。从鞅理论的基本原理出发，仅使用关于停鞅的广为接受的结果，确定 $\\mathbb{E}[B_{\\tau}]$ 的值。\n\n2. 现在去掉有界性假设，转而假设 $\\mathbb{E}[\\tau] < \\infty$。分析族 $\\{B_{t \\wedge \\tau}\\}_{t \\geq 0}$ 并导出一个仅用 $\\tau$ 表示的充分可积性条件，该条件能确保此族是一致可积的。利用此条件，沿一个递增的确定性序列取极限 $t \\to \\infty$，并在此情况下也确定 $\\mathbb{E}[B_{\\tau}]$ 的值。\n\n请将 $\\mathbb{E}[B_{\\tau}]$ 的最终值以单个精确数或闭式表达式的形式给出。无需四舍五入，不涉及单位。", "solution": "我们利用标准布朗运动的基本性质以及关于鞅和停止过程的经典事实进行求解。\n\n对于第1项，我们假设对某个有限的 $T$，有 $\\tau \\leq T$ 几乎必然成立。过程 $\\{B_{t}\\}_{t \\geq 0}$ 是一个关于 $\\{\\mathcal{F}_{t}\\}$ 的鞅。对于任意有界停时 $\\tau$，停止过程 $\\{B_{t \\wedge \\tau}\\}_{t \\geq 0}$ 是一个一致可积的鞅。特别地，对于任意 $t \\geq 0$，有\n$$\n\\mathbb{E}[B_{t \\wedge \\tau}] = \\mathbb{E}[B_{0}] = 0.\n$$\n令 $t$ 沿任意递增序列趋于 $T$。由于 $\\tau \\leq T$ 几乎必然成立，且 $B_{t}$ 具有连续的样本路径，当 $t \\uparrow T$ 时，我们有 $B_{t \\wedge \\tau} \\to B_{\\tau}$ 几乎必然成立。此外，$\\{B_{t \\wedge \\tau}\\}_{t \\in [0,T]}$ 的一致可积性保证了 $L^{1}$ 收敛，因此在期望上取极限可得\n$$\n\\mathbb{E}[B_{\\tau}] = \\lim_{t \\uparrow T} \\mathbb{E}[B_{t \\wedge \\tau}] = 0.\n$$\n\n对于第2项，我们不再假设 $\\tau$ 是有界的，但我们假设 $\\mathbb{E}[\\tau] < \\infty$。考虑族 $\\{B_{t \\wedge \\tau}\\}_{t \\geq 0}$。为了获得一个用 $\\tau$ 表示的一致可积性准则，我们使用平方可积鞅 $M_{t} = B_{t}^{2} - t$。对于任意固定的 $t \\geq 0$，随机时间 $t \\wedge \\tau$ 被 $t$ 所界定，因此我们可以对鞅 $\\{M_{s}\\}_{s \\geq 0}$ 在有界停时 $t \\wedge \\tau$ 上应用可选停止定理：\n$$\n\\mathbb{E}[M_{t \\wedge \\tau}] = \\mathbb{E}[M_{0}] = 0.\n$$\n因此，\n$$\n\\mathbb{E}[B_{t \\wedge \\tau}^{2}] = \\mathbb{E}[t \\wedge \\tau] \\leq \\mathbb{E}[\\tau] < \\infty.\n$$\n对 $t$ 取上确界，得到\n$$\n\\sup_{t \\geq 0} \\mathbb{E}\\big[|B_{t \\wedge \\tau}|^{2}\\big] \\leq \\mathbb{E}[\\tau] < \\infty.\n$$\n这表明族 $\\{B_{t \\wedge \\tau}\\}_{t \\geq 0}$ 在 $L^{2}$ 中是有界的。根据 de la Vallée Poussin 准则（或者根据一个基本事实，即对于某个 $p>1$ 的 $L^{p}$有界性意味着一致可积性），族 $\\{B_{t \\wedge \\tau}\\}_{t \\geq 0}$ 是一致可积的。\n\n现在定义有界停时的递增序列 $\\tau_{n} := \\tau \\wedge n$, $n \\in \\mathbb{N}$。对于每个 $n$，通过应用第1项中 $T=n$ 的论证，我们有\n$$\n\\mathbb{E}[B_{\\tau_{n}}] = 0.\n$$\n由于 $B$ 有连续路径且 $\\tau_{n} \\uparrow \\tau$，当 $n \\to \\infty$ 时，我们也有 $B_{\\tau_{n}} \\to B_{\\tau}$ 几乎必然成立。$\\{B_{t \\wedge \\tau}\\}_{t \\geq 0}$ 的一致可积性特别地意味着 $\\{B_{\\tau_{n}}\\}_{n \\in \\mathbb{N}}$ 是一致可积的。因此 $B_{\\tau_{n}} \\to B_{\\tau}$ 在 $L^{1}$ 中收敛，我们可以在期望上取极限：\n$$\n\\mathbb{E}[B_{\\tau}] = \\lim_{n \\to \\infty} \\mathbb{E}[B_{\\tau_{n}}] = 0.\n$$\n\n总结如下：\n- 如果 $\\tau$ 是有界的，则 $\\mathbb{E}[B_{\\tau}] = 0$。\n- 如果 $\\mathbb{E}[\\tau] < \\infty$，则 $\\{B_{t \\wedge \\tau}\\}_{t \\geq 0}$ 是一致可积的，通过使用 $\\tau_{n} = \\tau \\wedge n$ 进行逼近，同样可得 $\\mathbb{E}[B_{\\tau}] = 0$。\n\n因此，在所考虑的两种情况下，$\\mathbb{E}[B_{\\tau}]$ 的精确值都为零。", "answer": "$$\\boxed{0}$$", "id": "2996340"}, {"introduction": "最后的这个练习通过解决一个涉及 Ornstein-Uhlenbeck 过程的更复杂问题，展示了理论知识的强大威力，该过程是建模拟合均值回归系统的主要模型。您将学习一种强大的技巧：将原问题转化为一个关于标准布朗运动的等价问题，从而计算出到达一个移动边界的首达时间。这项练习综合了随机微积分的多个核心概念 [@problem_id:2996358]。", "problem": "考虑定义在带有标准布朗运动 (BM) $\\{W_{t}\\}_{t \\geq 0}$ 的滤波概率空间上的 Ornstein–Uhlenbeck (OU) 过程 $\\{X_{t}\\}_{t \\geq 0}$，其由以下随机微分方程定义\n$$\ndX_{t} \\;=\\; -\\,\\theta\\,X_{t}\\,dt \\;+\\; \\sigma\\,dW_{t},\\qquad X_{0}=x,\n$$\n其中 $\\theta>0$，$\\sigma>0$ 且 $x\\in\\mathbb{R}$。设边界为指数衰减曲线\n$$\nb(t)\\;=\\;\\alpha\\,\\exp(-\\theta t),\n$$\n其中 $\\alpha \\in \\mathbb{R}$ 是一个满足 $x<\\alpha$ 的固定水平。定义首次穿越时间\n$$\n\\tau \\;=\\; \\inf\\{\\,t>0:\\,X_{t}=b(t)\\,\\}.\n$$\n从第一性原理（Ornstein–Uhlenbeck 动力学、布朗运动、高斯鞅和连续鞅的时间变换的定义）出发，推导 $\\tau$ 的概率密度函数，其形式为 $t$、$\\theta$、$\\sigma$、$x$ 和 $\\alpha$ 的闭式函数。将您的最终结果表示为对 $t>0$ 有效的密度函数 $f_{\\tau}(t)$ 的单一解析表达式。最终答案必须是单一的闭式表达式。无需进行数值四舍五入。", "solution": "所述问题是随机过程理论中一个适定且有科学依据的问题。所有参数、条件和定义都已给出，并且它们是相互一致的。问题陈述没有歧义、主观论断或事实错误。这是一个关于 Ornstein-Uhlenbeck 过程首次穿越指数衰减边界时间的标准（尽管不平凡）的随机微积分问题。因此，该问题是有效的，并将提供完整的推导过程。\n\nOrnstein-Uhlenbeck (OU) 过程由以下随机微分方程 (SDE) 描述：\n$$dX_{t} = -\\theta X_{t} dt + \\sigma dW_{t}, \\quad X_{0}=x$$\n其中 $\\theta > 0$、$\\sigma > 0$、$x \\in \\mathbb{R}$，且 $\\{W_t\\}_{t \\geq 0}$ 是一个标准布朗运动。目标是求出首次穿越时间 $\\tau = \\inf\\{t>0 : X_{t}=b(t)\\}$ 的概率密度函数 (PDF)，其中边界为 $b(t) = \\alpha \\exp(-\\theta t)$ 且 $x < \\alpha$。\n\n核心策略是将 OU 过程触及移动边界的问题转化为一个等价的标准布朗运动触及常数边界的问题。这可以通过变量变换和时间变换来实现。\n\n首先，我们通过设置 $Y_{t} = \\exp(\\theta t) X_{t}$ 来定义一个新过程 $Y_{t}$。对 $dY_t = d(\\exp(\\theta t) X_t)$ 使用 Itô 乘积法则：\n$$dY_{t} = (\\theta \\exp(\\theta t) dt) X_{t} + \\exp(\\theta t) dX_{t} + d\\langle \\exp(\\theta \\cdot), X \\rangle_{t}$$\n由于 $\\exp(\\theta t)$ 是时间的确定性函数，其与 Itô 过程 $X_t$ 的二次协变差为零。代入 $dX_t$ 的随机微分方程：\n$$dY_{t} = \\theta \\exp(\\theta t) X_{t} dt + \\exp(\\theta t) (-\\theta X_{t} dt + \\sigma dW_{t})$$\n$$dY_{t} = \\theta \\exp(\\theta t) X_{t} dt - \\theta \\exp(\\theta t) X_{t} dt + \\sigma \\exp(\\theta t) dW_{t}$$\n$$dY_{t} = \\sigma \\exp(\\theta t) dW_{t}$$\n将此式从 $0$ 积分到 $t$ 得：\n$$Y_{t} - Y_{0} = \\int_{0}^{t} \\sigma \\exp(\\theta s) dW_{s}$$\n初始条件为 $Y_{0} = \\exp(0) X_{0} = x$。因此，过程 $Y_t$ 由下式给出：\n$$Y_{t} = x + \\sigma \\int_{0}^{t} \\exp(\\theta s) dW_{s}$$\n现在，我们变换首次穿越条件 $X_t = b(t)$：\n$$X_{t} = \\alpha \\exp(-\\theta t)$$\n两边乘以 $\\exp(\\theta t)$ 得：\n$$\\exp(\\theta t) X_{t} = \\alpha$$\n用我们的新过程 $Y_t$ 表示，这个条件就是简单的 $Y_t = \\alpha$。\n因此，首次穿越时间 $\\tau$ 可以重新定义为：\n$$\\tau = \\inf\\{t>0 : Y_{t}=\\alpha\\}$$\n代入 $Y_t$ 的表达式，我们得到时间 $\\tau$ 的条件：\n$$x + \\sigma \\int_{0}^{\\tau} \\exp(\\theta s) dW_{s} = \\alpha$$\n$$\\sigma \\int_{0}^{\\tau} \\exp(\\theta s) dW_{s} = \\alpha - x$$\n我们定义过程 $M_t = \\sigma \\int_{0}^{t} \\exp(\\theta s) dW_s$。$M_t$ 是一个从 $M_0=0$ 开始的连续鞅。问题现在变为求出鞅 $M_t$ 首次达到常数水平 $a = \\alpha - x$ 的时间 $\\tau$。因为 $x < \\alpha$，所以我们有 $a > 0$。\n\n根据 Dambis-Dubins-Schwarz 定理，任何从零开始的连续局部鞅都可以表示为一个时间变换的布朗运动。具体来说，$M_t = B_{\\langle M \\rangle_t}$，其中 $B$ 是一个标准布朗运动，$\\langle M \\rangle_t$ 是 $M_t$ 的二次变差。$M_t$ 的二次变差由下式给出：\n$$\\langle M \\rangle_t = \\int_{0}^{t} \\left(\\frac{dM_s}{dW_s}\\right)^2 ds = \\int_{0}^{t} (\\sigma \\exp(\\theta s))^2 ds = \\sigma^2 \\int_{0}^{t} \\exp(2\\theta s) ds$$\n计算该积分，我们得到时间变换函数，我们称之为 $S(t)$：\n$$S(t) = \\langle M \\rangle_t = \\sigma^2 \\left[ \\frac{\\exp(2\\theta s)}{2\\theta} \\right]_0^t = \\frac{\\sigma^2}{2\\theta} (\\exp(2\\theta t) - 1)$$\n首次穿越问题 $M_{\\tau} = a$ 变为 $B_{S(\\tau)} = a$。\n设 $\\tau_B$ 为标准布朗运动 $B_u$ 首次达到水平 $a$ 的时间：\n$$\\tau_B = \\inf\\{u > 0 : B_u = a\\}$$\n那么，在时间 $\\tau$ 处，我们必须有 $S(\\tau) = \\tau_B$。由于 $S(t)$ 对于 $t>0$ 是一个严格递增函数，其逆函数 $S^{-1}$ 是良定义的。我们有 $\\tau = S^{-1}(\\tau_B)$。\n\n已知标准布朗运动首次达到水平 $a>0$ 的时间 $\\tau_B$ 的概率密度函数服从 Lévy 分布。其 PDF，$g_{\\tau_B}(u)$，为：\n$$g_{\\tau_B}(u) = \\frac{a}{\\sqrt{2\\pi u^3}} \\exp\\left(-\\frac{a^2}{2u}\\right), \\quad u > 0$$\n现在我们可以使用变量变换公式来求出 $\\tau$ 的 PDF，记为 $f_{\\tau}(t)$。$\\tau$ 的累积分布函数 (CDF) 是：\n$$F_{\\tau}(t) = P(\\tau \\leq t) = P(S^{-1}(\\tau_B) \\leq t) = P(\\tau_B \\leq S(t)) = G_{\\tau_B}(S(t))$$\n其中 $G_{\\tau_B}$ 是 $\\tau_B$ 的 CDF。\n使用链式法则对 $t$ 求导，得到 $\\tau$ 的 PDF：\n$$f_{\\tau}(t) = \\frac{d}{dt}F_{\\tau}(t) = g_{\\tau_B}(S(t)) \\cdot S'(t)$$\n我们需要 $S'(t)$：\n$$S'(t) = \\frac{d}{dt} \\left[ \\frac{\\sigma^2}{2\\theta} (\\exp(2\\theta t) - 1) \\right] = \\frac{\\sigma^2}{2\\theta} (2\\theta \\exp(2\\theta t)) = \\sigma^2 \\exp(2\\theta t)$$\n现在我们将 $a = \\alpha - x$、$S(t)$ 和 $S'(t)$ 代入 $f_{\\tau}(t)$ 的表达式中：\n$$f_{\\tau}(t) = \\frac{\\alpha - x}{\\sqrt{2\\pi (S(t))^3}} \\exp\\left(-\\frac{(\\alpha-x)^2}{2S(t)}\\right) \\cdot S'(t)$$\n$$f_{\\tau}(t) = \\frac{\\alpha - x}{\\sqrt{2\\pi \\left(\\frac{\\sigma^2}{2\\theta}(\\exp(2\\theta t) - 1)\\right)^3}} \\exp\\left(-\\frac{(\\alpha-x)^2}{2\\frac{\\sigma^2}{2\\theta}(\\exp(2\\theta t) - 1)}\\right) \\cdot \\sigma^2 \\exp(2\\theta t)$$\n让我们简化这个表达式。指数部分的参数变为：\n$$-\\frac{\\theta(\\alpha-x)^2}{\\sigma^2(\\exp(2\\theta t) - 1)}$$\n指数前因子是：\n$$\\frac{(\\alpha - x) \\sigma^2 \\exp(2\\theta t)}{\\sqrt{2\\pi} \\left(\\frac{\\sigma^2}{2\\theta}\\right)^{3/2} (\\exp(2\\theta t) - 1)^{3/2}} = \\frac{(\\alpha - x) \\sigma^2 \\exp(2\\theta t)}{\\sqrt{2\\pi} \\frac{\\sigma^3}{(2\\theta)^{3/2}} (\\exp(2\\theta t) - 1)^{3/2}}$$\n$$= \\frac{(\\alpha - x) \\exp(2\\theta t) (2\\theta)^{3/2}}{\\sigma \\sqrt{2\\pi} (\\exp(2\\theta t) - 1)^{3/2}} = \\frac{(\\alpha - x) 2\\theta\\sqrt{2\\theta} \\exp(2\\theta t)}{\\sigma \\sqrt{2\\pi} (\\exp(2\\theta t) - 1)^{3/2}}$$\n$$= \\frac{2\\theta\\sqrt{\\theta}(\\alpha - x) \\exp(2\\theta t)}{\\sqrt{\\pi}\\sigma (\\exp(2\\theta t) - 1)^{3/2}}$$\n结合各部分，我们得到对 $t>0$ 的 $\\tau$ 的概率密度函数的最终表达式：\n$$f_{\\tau}(t) = \\frac{2\\theta\\sqrt{\\theta}(\\alpha-x)\\exp(2\\theta t)}{\\sqrt{\\pi}\\sigma(\\exp(2\\theta t) - 1)^{3/2}} \\exp\\left(-\\frac{\\theta(\\alpha-x)^2}{\\sigma^2(\\exp(2\\theta t)-1)}\\right)$$\n此表达式即为所求的闭式解析解。", "answer": "$$\n\\boxed{\\frac{2\\theta\\sqrt{\\theta}(\\alpha-x)\\exp(2\\theta t)}{\\sqrt{\\pi}\\sigma(\\exp(2\\theta t) - 1)^{3/2}} \\exp\\left(-\\frac{\\theta(\\alpha-x)^2}{\\sigma^2(\\exp(2\\theta t)-1)}\\right)}\n$$", "id": "2996358"}]}