{"hands_on_practices": [{"introduction": "维纳过程的许多基本性质都可以直接从其公理中推导出来。这个练习将引导你运用独立增量和高斯增量这两个核心公理来推导一个基本但至关重要的结果：给定过去某个时刻的状态，维纳过程在未来时刻的条件分布。掌握这一推导不仅能加深你对公理化定义的理解，还能揭示维纳过程的马尔可夫性质，即过程的未来只依赖于现在，而与过去无关，这是随机建模中的一个基石。[@problem_id:3006300]", "problem": "设 $\\left(\\Omega,\\mathcal{F},(\\mathcal{F}_{t})_{t\\ge 0},\\mathbb{P}\\right)$ 是一个过滤概率空间，其上承载一个标准维纳过程（也称为标准布朗运动）$W=\\{W_{t}:t\\ge 0\\}$，由以下公理定义：(i) $W_{0}=0$ 几乎必然；(ii) 样本路径 $t\\mapsto W_{t}$ 几乎必然连续；(iii) 对任意 $0\\le r<s<t$，增量 $W_{t}-W_{s}$ 独立于 $\\mathcal{F}_{r}$，其中 $\\mathcal{F}_{r}=\\sigma(W_{u}:0\\le u\\le r)$；以及 (iv) 对任意 $0\\le s<t$，增量 $W_{t}-W_{s}$ 服从均值为 $0$、方差为 $t-s$ 的高斯分布。仅从这些公理以及高斯随机变量和特征函数的标准性质出发，推导在 $0\\le s<t$ 的条件下，$W_{t}$ 给定 $W_{s}$ 时的条件分布。你的最终答案必须是关于 $W_{t}$ 给定 $W_{s}$ 时的条件定律的一个单一闭式解析表达式。", "solution": "问题陈述已经过验证，被认为是可靠、适定且基于随机过程的既定原理。我们可以开始推导。\n\n我们的目标是，对于一个标准维纳过程 $W$ 和时间 $0 \\le s < t$，确定随机变量 $W_{t}$ 在给定随机变量 $W_{s}$ 的值时的条件分布。这被记为 $W_{t} | W_{s}$ 的定律。\n\n我们首先用 $W_{s}$ 和一个增量来表示随机变量 $W_{t}$。对任意 $s < t$，我们可以写出恒等式：\n$$\nW_{t} = W_{s} + (W_{t} - W_{s})\n$$\n当我们以 $W_{s}$ 为条件时，$W_{s}$ 的值被视为已知。因此，$W_{t}$ 的条件分布取决于增量 $W_{t} - W_{s}$ 的分布及其与 $W_{s}$ 的关系。\n\n此推导的基石在于证明增量 $W_{t} - W_{s}$ 独立于σ-代数 $\\mathcal{F}_{s} = \\sigma(W_{u} : 0 \\le u \\le s)$。根据定义，随机变量 $W_{s}$ 是关于 $\\mathcal{F}_{s}$ 可测的。因此，证明 $W_{t} - W_{s}$ 独立于 $\\mathcal{F}_{s}$ 就意味着它独立于 $W_{s}$。\n\n公理(iii)指出，对任意 $0 \\le r < s < t$，增量 $W_{t} - W_{s}$ 独立于σ-代数 $\\mathcal{F}_{r}$。我们必须将其推广，以证明其独立于 $\\mathcal{F}_{s}$。让我们定义集合族 $\\mathcal{A} = \\bigcup_{r<s} \\mathcal{F}_{r}$。\n1.  $\\mathcal{A}$ 是一个π-系：如果 $A_{1} \\in \\mathcal{F}_{r_{1}}$ 且 $A_{2} \\in \\mathcal{F}_{r_{2}}$，其中 $r_{1} < s$ 且 $r_{2} < s$，那么 $A_{1} \\cap A_{2} \\in \\mathcal{F}_{\\max(r_{1}, r_{2})}$。由于 $\\max(r_{1}, r_{2}) < s$，因此有 $A_{1} \\cap A_{2} \\in \\mathcal{A}$。\n2.  由 $\\mathcal{A}$ 生成的σ-代数是 $\\mathcal{F}_{s}$。这是因为 $\\sigma(\\mathcal{A}) = \\sigma(\\bigcup_{r<s} \\mathcal{F}_{r}) = \\mathcal{F}_{s}$。后一个等式对于由右连续过程（如维纳过程，根据公理(ii)其路径几乎必然连续）生成的过滤是成立的。\n3.  根据公理(iii)，对任意集合 $A \\in \\mathcal{A}$，存在一个 $r < s$ 使得 $A \\in \\mathcal{F}_{r}$。对于此 $r$，增量 $W_{t}-W_{s}$ 独立于 $A$。\n4.  所有使 $W_{t} - W_{s}$ 与之独立的事件 $B \\in \\mathcal{F}$ 的集合构成一个λ-系。由于这个λ-系包含π-系 $\\mathcal{A}$，应用 Dynkin 的 π-λ 定理，我们可以得出结论，它也包含 $\\sigma(\\mathcal{A}) = \\mathcal{F}_{s}$。\n\n因此，增量 $W_{t} - W_{s}$ 独立于σ-代数 $\\mathcal{F}_{s}$，从而也独立于随机变量 $W_{s}$。\n\n在确立了独立性之后，我们可以使用特征函数来正式推导条件定律。令 $\\phi_{X}(k) = \\mathbb{E}[\\exp(ikX)]$ 表示随机变量 $X$ 的特征函数。我们寻求 $W_{t}$ 在给定 $W_{s}=w_{s}$ 时的条件特征函数，记作 $\\phi_{W_{t}|W_{s}}(k|w_{s})$：\n$$\n\\phi_{W_{t}|W_{s}}(k|w_{s}) = \\mathbb{E}[\\exp(ikW_{t}) | W_{s}=w_{s}]\n$$\n代入分解式 $W_{t} = W_{s} + (W_{t}-W_{s})$：\n$$\n\\phi_{W_{t}|W_{s}}(k|w_{s}) = \\mathbb{E}[\\exp(ik(W_{s} + (W_{t}-W_{s}))) | W_{s}=w_{s}] = \\mathbb{E}[\\exp(ikW_{s})\\exp(ik(W_{t}-W_{s})) | W_{s}=w_{s}]\n$$\n根据条件期望的性质，因为我们是在 $W_{s}=w_{s}$ 的条件下，项 $\\exp(ikW_{s})$ 变为常数 $\\exp(ikw_{s})$，可以被提出来：\n$$\n\\phi_{W_{t}|W_{s}}(k|w_{s}) = \\exp(ikw_{s}) \\mathbb{E}[\\exp(ik(W_{t}-W_{s})) | W_{s}=w_{s}]\n$$\n因为增量 $W_{t}-W_{s}$ 独立于 $W_{s}$，所以条件期望等于无条件期望：\n$$\n\\mathbb{E}[\\exp(ik(W_{t}-W_{s})) | W_{s}=w_{s}] = \\mathbb{E}[\\exp(ik(W_{t}-W_{s}))]\n$$\n这一项就是随机变量 $W_{t}-W_{s}$ 的特征函数。根据公理(iv)，对于 $s < t$，增量 $W_{t}-W_{s}$ 服从均值为 $0$、方差为 $t-s$ 的高斯（正态）分布，即 $W_{t}-W_{s} \\sim \\mathcal{N}(0, t-s)$。\n\n一个一般的高斯随机变量 $X \\sim \\mathcal{N}(\\mu, \\sigma^{2})$ 的特征函数由 $\\phi_{X}(k) = \\exp(ik\\mu - \\frac{1}{2}k^{2}\\sigma^{2})$ 给出。对于增量 $W_{t}-W_{s}$，我们有 $\\mu=0$ 和 $\\sigma^{2}=t-s$。因此，其特征函数是：\n$$\n\\mathbb{E}[\\exp(ik(W_{t}-W_{s}))] = \\exp\\left(ik(0) - \\frac{1}{2}k^{2}(t-s)\\right) = \\exp\\left(-\\frac{1}{2}k^{2}(t-s)\\right)\n$$\n将此结果代回我们关于 $W_{t}$ 的条件特征函数的表达式中：\n$$\n\\phi_{W_{t}|W_{s}}(k|w_{s}) = \\exp(ikw_{s}) \\exp\\left(-\\frac{1}{2}k^{2}(t-s)\\right) = \\exp\\left(ikw_{s} - \\frac{1}{2}k^{2}(t-s)\\right)\n$$\n我们现在来识别这个结果函数。它的形式是 $\\exp(ik\\mu_{cond} - \\frac{1}{2}k^{2}\\sigma_{cond}^{2})$，这是一个高斯分布的特征函数。通过比较各项，我们找到了这个条件分布的参数：\n-   条件均值为 $\\mu_{cond} = w_{s}$。\n-   条件方差为 $\\sigma_{cond}^{2} = t-s$。\n\n这表明，$W_{t}$ 在给定 $W_{s}=w_{s}$ 时的条件分布是一个均值为 $w_{s}$、方差为 $t-s$ 的正态分布。用随机变量 $W_{s}$ 表示，$W_{t}$ 给定 $W_{s}$ 时的条件定律是一个均值为 $W_{s}$、方差为 $t-s$ 的正态分布。这是对该条件定律的完整描述。", "answer": "$$\n\\boxed{\\mathcal{N}(W_s, t-s)}\n$$", "id": "3006300"}, {"introduction": "维纳过程的路径虽然处处连续，但却处处不可微，这使其与经典微积分中的函数截然不同。这个练习旨在通过计算维纳过程路径的 $p$-变差来量化其“粗糙度”。你将发现，当 $p=2$ 时，其变差（即二次变差）收敛于一个非零的确定性值，而当 $p>2$ 时则收敛于零。这一惊人的结果是整个随机微积分理论的基石，它直观地展示了为什么我们需要为维纳过程这样的随机过程建立一套全新的微积分法则。[@problem_id:3006312]", "problem": "设 $\\{W_{t}\\}_{t \\geq 0}$ 是一个在概率空间 $(\\Omega,\\mathcal{F},\\mathbb{P})$ 上，关于一个 filtration (或称“信息流”) $\\{\\mathcal{F}_{t}\\}_{t \\geq 0}$ 的标准维纳过程（也称为标准布朗运动），由以下公理定义：$W_{0}=0$ 几乎必然，$W$ 具有独立增量，对于 $0 \\leq s < t$ 有 $W_{t}-W_{s} \\sim \\mathcal{N}(0,t-s)$（均值为零，方差为 $t-s$），以及 $W$ 具有几乎必然连续的样本路径。固定一个时间域 $t>0$，并且对每个整数 $n \\geq 1$，考虑 $[0,t]$ 上的均匀二分划分 $\\mathcal{P}_{n}$，该划分由点 $t_{k}^{(n)} = k t / 2^{n}$ 给出，其中 $k=0,1,\\dots,2^{n}$。\n\n对于一个实数 $p \\geq 2$，定义沿 $\\mathcal{P}_{n}$ 的 $p$-变差为\n$$\nV^{(p)}_{t}(W;\\mathcal{P}_{n}) \\;=\\; \\sum_{k=1}^{2^{n}} \\big|W_{t_{k}^{(n)}} - W_{t_{k-1}^{(n)}}\\big|^{p}.\n$$\n假设极限 $V^{(p)}_{t}(W) = \\lim_{n \\to \\infty} V^{(p)}_{t}(W;\\mathcal{P}_{n})$ 几乎必然存在。仅使用维纳过程公理、正态分布的基本性质以及标准的概率极限工具，确定当 $p>2$ 和 $p=2$ 时 $V^{(p)}_{t}(W)$ 的值。您的推导必须从上述基本定义出发，且不应引用任何超出这些定义和正态分布基本矩的现成结果。将您的最终答案表示为一个关于 $p$ 和 $t$ 的单一闭式分段解析表达式。不需要数值近似。", "solution": "问题要求我们求标准维纳过程 $\\{W_t\\}_{t \\geq 0}$ 沿区间 $[0,t]$ 上的一个二分划分序列 $\\mathcal{P}_n$ 的 $p$-变差 $V^{(p)}_{t}(W;\\mathcal{P}_{n})$ 的几乎必然极限 $V^{(p)}_{t}(W)$。需要对 $p>2$ 和 $p=2$ 的情况求解。\n\n设 $[0,t]$ 上的均匀二分划分 $\\mathcal{P}_{n}$ 由点 $t_{k}^{(n)} = \\frac{kt}{2^n}$ 定义，其中 $k=0, 1, \\dots, 2^n$。每个子区间的长度是恒定的：\n$$\n\\Delta t^{(n)} = t_{k}^{(n)} - t_{k-1}^{(n)} = \\frac{t}{2^n}.\n$$\n令 $\\Delta W_{k}^{(n)} = W_{t_{k}^{(n)}} - W_{t_{k-1}^{(n)}}$ 为维纳过程在第 $k$ 个子区间上的增量。根据维纳过程的公理，这些增量是独立的，并且每个增量都服从均值为 0、方差等于时间区间长度的正态分布。即，对每个 $k \\in \\{1, \\dots, 2^n\\}$，\n$$\n\\Delta W_{k}^{(n)} \\sim \\mathcal{N}\\left(0, \\Delta t^{(n)}\\right).\n$$\n这个分布性质允许我们将每个增量表示为 $\\Delta W_{k}^{(n)} = \\sqrt{\\Delta t^{(n)}} Z_k$，其中 $\\{Z_k\\}_{k=1}^{2^n}$ 是一个独立同分布 (i.i.d.) 的标准正态随机变量序列，$Z_k \\sim \\mathcal{N}(0,1)$。\n\n沿划分 $\\mathcal{P}_{n}$ 的 $p$-变差由下式给出\n$$\nV^{(p)}_{t}(W;\\mathcal{P}_{n}) = \\sum_{k=1}^{2^{n}} \\left|\\Delta W_{k}^{(n)}\\right|^{p}.\n$$\n将以 $Z_k$ 表示的增量代入，我们得到\n$$\nV^{(p)}_{t}(W;\\mathcal{P}_{n}) = \\sum_{k=1}^{2^{n}} \\left|\\sqrt{\\Delta t^{(n)}} Z_k\\right|^{p} = \\sum_{k=1}^{2^{n}} \\left(\\Delta t^{(n)}\\right)^{p/2} |Z_k|^p = \\left(\\Delta t^{(n)}\\right)^{p/2} \\sum_{k=1}^{2^{n}} |Z_k|^p.\n$$\n将 $\\Delta t^{(n)}$ 替换为 $\\frac{t}{2^n}$，表达式变为\n$$\nV^{(p)}_{t}(W;\\mathcal{P}_{n}) = \\left(\\frac{t}{2^n}\\right)^{p/2} \\sum_{k=1}^{2^{n}} |Z_k|^p.\n$$\n为了确定当 $n \\to \\infty$ 时此表达式的极限，我们将通过研究其矩来分析其行为。令 $m_r = \\mathbb{E}[|Z|^r]$ 表示一个标准正态随机变量的 $r$ 阶绝对矩。由于正态分布的所有矩都是有限的，对于任何 $r \\geq 0$，$m_r$ 都是一个有限常数。\n\n让我们计算 $V^{(p)}_{t}(W;\\mathcal{P}_{n})$ 的期望值。根据期望的线性性质以及 $Z_k$ 是独立同分布的这一事实，\n$$\n\\mathbb{E}\\left[V^{(p)}_{t}(W;\\mathcal{P}_{n})\\right] = \\mathbb{E}\\left[\\left(\\frac{t}{2^n}\\right)^{p/2} \\sum_{k=1}^{2^{n}} |Z_k|^p\\right] = \\left(\\frac{t}{2^n}\\right)^{p/2} \\sum_{k=1}^{2^{n}} \\mathbb{E}[|Z_k|^p] = \\left(\\frac{t}{2^n}\\right)^{p/2} (2^n) m_p.\n$$\n简化期望值的表达式可得\n$$\n\\mathbb{E}\\left[V^{(p)}_{t}(W;\\mathcal{P}_{n})\\right] = t^{p/2} \\frac{1}{(2^n)^{p/2-1}} m_p = t^{p/2} (2^n)^{1-p/2} m_p.\n$$\n我们现在分析此期望在问题指定的两种情况下的极限。\n\n情况1：$p > 2$\n对于 $p > 2$，指数 $1 - \\frac{p}{2}$ 严格为负。因此，当 $n \\to \\infty$ 时，项 $(2^n)^{1-p/2}$ 收敛于 $0$。\n$$\n\\lim_{n \\to \\infty} \\mathbb{E}\\left[V^{(p)}_{t}(W;\\mathcal{P}_{n})\\right] = \\lim_{n \\to \\infty} t^{p/2} (2^n)^{1-p/2} m_p = 0.\n$$\n随机变量 $V^{(p)}_{t}(W;\\mathcal{P}_{n})$ 是非负项之和，因此它本身是非负的。对于任何非负随机变量序列 $X_n$，如果 $\\mathbb{E}[X_n] \\to 0$，则 $X_n$ 依概率收敛于 $0$。这可由马尔可夫不等式 (Markov's inequality) 得出，该不等式表明对于任何 $\\epsilon > 0$，\n$$\n\\mathbb{P}\\left(V^{(p)}_{t}(W;\\mathcal{P}_{n}) \\geq \\epsilon\\right) \\leq \\frac{\\mathbb{E}\\left[V^{(p)}_{t}(W;\\mathcal{P}_{n})\\right]}{\\epsilon}.\n$$\n由于当 $n \\to \\infty$ 时右侧趋于 $0$，我们得出结论：$V^{(p)}_{t}(W;\\mathcal{P}_{n})$ 依概率收敛于 $0$。问题陈述了极限 $V^{(p)}_{t}(W) = \\lim_{n \\to \\infty} V^{(p)}_{t}(W;\\mathcal{P}_{n})$ 几乎必然存在。几乎必然收敛蕴含着依概率收敛于同一极限。由于依概率收敛的极限是唯一的，所以几乎必然极限必须是 $0$。因此，\n$$\nV^{(p)}_{t}(W) = 0 \\quad \\text{对于 } p > 2.\n$$\n\n情况2：$p=2$\n对于 $p=2$，指数 $1 - \\frac{p}{2}$ 为 $1 - \\frac{2}{2} = 0$。期望值变为\n$$\n\\mathbb{E}\\left[V^{(2)}_{t}(W;\\mathcal{P}_{n})\\right] = t^{2/2} (2^n)^{1-1} m_2 = t \\cdot m_2.\n$$\n矩 $m_2 = \\mathbb{E}[|Z|^2] = \\mathbb{E}[Z^2]$，其中 $Z \\sim \\mathcal{N}(0,1)$。标准正态随机变量的方差为 $\\mathrm{Var}(Z) = \\mathbb{E}[Z^2] - (\\mathbb{E}[Z])^2 = 1$。由于 $\\mathbb{E}[Z]=0$，我们有 $\\mathbb{E}[Z^2] = 1$。因此，$m_2=1$。\n对所有 $n$，二次变差的期望值都是常数：\n$$\n\\mathbb{E}\\left[V^{(2)}_{t}(W;\\mathcal{P}_{n})\\right] = t.\n$$\n为了证明 $V^{(2)}_{t}(W;\\mathcal{P}_{n})$ 收敛于常数 $t$，我们分析其方差。均方收敛于一个常数意味着依概率收敛于该常数。\n$$\n\\mathrm{Var}\\left(V^{(2)}_{t}(W;\\mathcal{P}_{n})\\right) = \\mathrm{Var}\\left(\\sum_{k=1}^{2^{n}} \\left(\\Delta W_{k}^{(n)}\\right)^2\\right).\n$$\n由于增量 $\\Delta W_{k}^{(n)}$ 是独立的，其平方增量 $\\left(\\Delta W_{k}^{(n)}\\right)^2$ 也是独立的。因此，和的方差是方差的和：\n$$\n\\mathrm{Var}\\left(V^{(2)}_{t}(W;\\mathcal{P}_{n})\\right) = \\sum_{k=1}^{2^{n}} \\mathrm{Var}\\left(\\left(\\Delta W_{k}^{(n)}\\right)^2\\right).\n$$\n对于每一项，$\\mathrm{Var}\\left(\\left(\\Delta W_{k}^{(n)}\\right)^2\\right) = \\mathbb{E}\\left[\\left(\\Delta W_{k}^{(n)}\\right)^4\\right] - \\left(\\mathbb{E}\\left[\\left(\\Delta W_{k}^{(n)}\\right)^2\\right]\\right)^2$。\n我们知道 $\\mathbb{E}\\left[\\left(\\Delta W_{k}^{(n)}\\right)^2\\right] = \\mathrm{Var}(\\Delta W_{k}^{(n)}) = \\Delta t^{(n)}$。\n正态分布 $\\mathcal{N}(0,\\sigma^2)$ 的四阶矩是 $3\\sigma^4$。此处，$\\sigma^2 = \\Delta t^{(n)}$，因此 $\\mathbb{E}\\left[\\left(\\Delta W_{k}^{(n)}\\right)^4\\right] = 3\\left(\\Delta t^{(n)}\\right)^2$。\n将这些矩代入单个项的方差表达式中：\n$$\n\\mathrm{Var}\\left(\\left(\\Delta W_{k}^{(n)}\\right)^2\\right) = 3\\left(\\Delta t^{(n)}\\right)^2 - \\left(\\Delta t^{(n)}\\right)^2 = 2\\left(\\Delta t^{(n)}\\right)^2.\n$$\n现在，对所有 $k=1, \\dots, 2^n$ 求和：\n$$\n\\mathrm{Var}\\left(V^{(2)}_{t}(W;\\mathcal{P}_{n})\\right) = \\sum_{k=1}^{2^{n}} 2\\left(\\Delta t^{(n)}\\right)^2 = 2^n \\cdot 2\\left(\\frac{t}{2^n}\\right)^2 = 2^{n+1} \\frac{t^2}{(2^n)^2} = \\frac{2t^2}{2^n}.\n$$\n当 $n \\to \\infty$ 时，方差收敛于零：$\\lim_{n \\to \\infty} \\mathrm{Var}\\left(V^{(2)}_{t}(W;\\mathcal{P}_{n})\\right) = 0$。\n随机变量序列 $V^{(2)}_{t}(W;\\mathcal{P}_{n})$ 的均值为常数 $t$，方差趋于 $0$。这意味着它在 $L^2$ 中收敛，因此依概率收敛于均值 $t$。与情况1中的逻辑相同，所假设的几乎必然极限必须等于此极限。因此，\n$$\nV^{(2)}_{t}(W) = t.\n$$\n结合这两种情况，我们可以将 p-变差 $V^{(p)}_{t}(W)$ 表示为关于 $p$ 的分段函数。", "answer": "$$\n\\boxed{\n\\begin{cases}\nt & \\text{当 } p=2 \\text{ 时} \\\\\n0 & \\text{当 } p>2 \\text{ 时}\n\\end{cases}\n}\n$$", "id": "3006312"}, {"introduction": "在许多应用中，我们不仅关心一个随机过程在特定时刻的取值，还关心它在一段时间内的极端行为，例如其达到的最大值。这个练习要求你推导维纳过程在给定时间区间内运行上确界的分布。解决这个问题需要运用一个非常巧妙且强大的工具——反射原理，它通过一个优美的对称性论证，将一个看似复杂的路径概率问题转化为一个更易于处理的问题。通过这个练习，你不仅能掌握一个重要的计算结果，还能体会到概率论中方法的多样性与深刻性，并了解维纳过程与偏微分方程（热方程）之间的内在联系。[@problem_id:3006291]", "problem": "设 $\\{B_{t}\\}_{t \\ge 0}$ 是一个标准的维纳过程（布朗运动），它由高斯热核构造而成，并满足以下公理：$B_{0}=0$ 几乎必然成立，样本路径连续，增量独立且平稳，并且是高斯增量，对于 $0 \\le s < t$ 有 $\\mathbb{P}(B_{t}-B_{s} \\in \\mathrm{d}x)=\\frac{1}{\\sqrt{2\\pi (t-s)}}\\exp\\!\\left(-\\frac{x^{2}}{2(t-s)}\\right)\\mathrm{d}x$。设 $T>0$ 为一固定值，并定义游走上确界 $M_{T}:=\\sup_{0 \\le t \\le T} B_{t}$。\n\n仅使用维纳过程的公理及其通过热核的构造方法，按如下步骤进行：\n\n1. 对于一个水平 $m \\ge 0$ 和一个端点 $y<m$，考虑一个在时间 $t=0$ 时固定于 $0$ 且在时间 $t=T$ 时固定于 $y$ 的布朗桥，即以 $B_{T}=y$ 为条件的布朗过程 $\\{B_{t}\\}_{0 \\le t \\le T}$。通过高斯热核和在 $m$ 处设置吸收壁的镜像法，将此布朗桥的表示与越界事件 $\\{M_{T} < m\\}$ 联系起来，推导出该固定桥的越界概率 $\\mathbb{P}(M_{T}<m \\mid B_{T}=y)$。除了高斯热核和路径反射所蕴含的公式外，不得使用任何其他公式。\n\n2. 使用步骤 1 的结果，通过对端点 $y<m$ 上的相应密度进行积分，并通过首次到达时间的反射映射来确定穿过壁垒的路径的贡献，计算 $M_{T}$ 在 $m \\ge 0$ 处的累积分布函数，即 $\\mathbb{P}(M_{T} \\le m)$。\n\n将最终答案表示为以标准正态累积分布函数 $\\Phi$ 表示的单个闭式解析表达式。不需要进行数值近似或四舍五入。", "solution": "该问题是有效的，因为它是随机微积分中一个标准的、适定的问题，涉及标准维纳过程上确界的分布。它具有科学依据，是客观的，并包含了进行严格推导所需的所有信息。\n\n设 $\\{B_{t}\\}_{t \\ge 0}$ 是一个从 $B_{0}=0$ 开始的标准维纳过程。$B_{t}$ 在位置 $x$ 处的概率密度函数由高斯热核 $p(t, x)$ 给出，它是一维热方程 $\\frac{\\partial u}{\\partial t} = \\frac{1}{2} \\frac{\\partial^2 u}{\\partial x^2}$ 的基本解。对于在时间 $0$ 从 $0$ 开始的过程，该密度为：\n$$\np(t, x) = \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{x^2}{2t}\\right)\n$$\n该问题要求进行两步推导：第一，在给定终点的情况下，过程保持在水平 $m \\ge 0$ 以下的概率；第二，无条件地保持在该水平以下的概率。\n\n**第 1 部分：固定桥概率的推导**\n\n我们要求解对于 $y<m$ 的 $\\mathbb{P}(M_{T}<m \\mid B_{T}=y)$，其中 $M_{T} = \\sup_{0 \\le t \\le T} B_{t}$。这个条件概率可以从事件 $\\{M_{T} < m\\}$ 和终点 $\\{B_{T} = y\\}$ 的联合概率密度中确定。\n\n事件 $\\{M_{T} < m\\}$ 意味着维纳过程的路径在任何时间 $t \\in [0, T]$ 内都没有穿过水平 $m$。这等价于求解在 $x=m$ 处带有吸收边界条件的热方程。我们记在时间 $T$ 结束于 $y$ 且*没有*触及或穿过 $m$ 处壁垒的路径的联合概率密度为 $q(T, y)$，它是以下方程的解：\n$$\n\\frac{\\partial q}{\\partial t} = \\frac{1}{2} \\frac{\\partial^2 q}{\\partial x^2}, \\quad \\text{for } x < m\n$$\n其中初始条件为 $q(0, x) = \\delta(x)$（代表从 $x=0$ 开始的狄拉克δ函数），边界条件为对所有 $t>0$ 都有 $q(t, m) = 0$。\n\n这个问题可以用镜像法解决。我们在 $x=2m$ 处引入一个负的“镜像”源，以抵消原始源（在 $x=0$ 处）在边界 $x=m$ 上的影响。其解是来自 $x=0$ 处原始源的热核与来自 $x=2m$ 处镜像源的负热核的叠加。\n\n来自 $0$ 处源的密度是 $p(T, y)$。来自 $2m$ 处镜像汇的密度是 $-p(T, y-2m)$。因此，$\\{M_T < m, B_T = y\\}$ 的联合概率密度为：\n$$\nq(T, y) = p(T, y) - p(T, y-2m)\n$$\n我们来验证边界条件。在 $y=m$ 处：\n$$\nq(T, m) = p(T, m) - p(T, m-2m) = p(T, m) - p(T, -m)\n$$\n由于高斯核 $p(T,x)$ 是其空间变量 $x$ 的偶函数，我们有 $p(T, m) = p(T, -m)$，这意味着 $q(T, m) = 0$。该方法是一致的。\n\n其概率解释是，在时间 $T$ 内所有从 $0$ 到 $y$ 的路径（密度为 $p(T, y)$）的集合，可以被划分为保持在 $m$ 以下的路径和触及或穿过 $m$ 的路径。根据反射原理，从 $0$ 开始，触及 $m$，并在 $y<m$ 处结束的路径，其测度与从 $0$ 开始并在反射点 $2m-y$ 处结束的路径相同。这些反射路径的密度是 $p(T, 2m-y) = p(T, y-2m)$。因此，未触及 $m$ 的路径的密度是总密度减去触及 $m$ 的路径的密度，这恰好是 $p(T, y) - p(T, y-2m)$。\n\n条件概率 $\\mathbb{P}(M_{T}<m \\mid B_{T}=y)$ 是联合概率密度与条件事件的边缘概率密度之比。\n$$\n\\mathbb{P}(M_{T}<m \\mid B_{T}=y) = \\frac{\\mathbb{P}(M_{T}<m, B_T \\in \\mathrm{d}y)}{\\mathbb{P}(B_T \\in \\mathrm{d}y)} = \\frac{q(T,y)\\mathrm{d}y}{p(T,y)\\mathrm{d}y} = \\frac{p(T, y) - p(T, y-2m)}{p(T, y)}\n$$\n代入热核的显式形式：\n$$\n\\mathbb{P}(M_{T}<m \\mid B_{T}=y) = \\frac{\\frac{1}{\\sqrt{2\\pi T}}\\exp\\left(-\\frac{y^2}{2T}\\right) - \\frac{1}{\\sqrt{2\\pi T}}\\exp\\left(-\\frac{(y-2m)^2}{2T}\\right)}{\\frac{1}{\\sqrt{2\\pi T}}\\exp\\left(-\\frac{y^2}{2T}\\right)}\n$$\n$$\n= 1 - \\frac{\\exp\\left(-\\frac{(y-2m)^2}{2T}\\right)}{\\exp\\left(-\\frac{y^2}{2T}\\right)} = 1 - \\exp\\left(-\\frac{(y-2m)^2 - y^2}{2T}\\right)\n$$\n$$\n= 1 - \\exp\\left(-\\frac{y^2 - 4my + 4m^2 - y^2}{2T}\\right) = 1 - \\exp\\left(-\\frac{4m^2 - 4my}{2T}\\right) = 1 - \\exp\\left(-\\frac{2m(m-y)}{T}\\right)\n$$\n这就是所求的固定桥的越界概率。\n\n**第 2 部分：$M_T$ 的累积分布函数**\n\n为计算累积分布函数 (CDF) $\\mathbb{P}(M_{T} \\le m)$，我们将联合概率密度 $q(T, y)$ 对所有可能的终点位置 $y$ 进行积分。由于条件 $M_{T} \\le m$ 意味着终点必须满足 $B_{T} \\le m$，因此 $y$ 的积分范围是 $(-\\infty, m]$。由于 $M_T$ 是一个连续随机变量，$\\mathbb{P}(M_T \\le m) = \\mathbb{P}(M_T < m)$。\n$$\n\\mathbb{P}(M_{T} \\le m) = \\int_{-\\infty}^{m} q(T, y) \\mathrm{d}y = \\int_{-\\infty}^{m} \\left[p(T, y) - p(T, y-2m)\\right] \\mathrm{d}y\n$$\n我们将该积分作为两个积分之差来计算：\n$$\n\\mathbb{P}(M_{T} \\le m) = \\int_{-\\infty}^{m} p(T, y) \\mathrm{d}y - \\int_{-\\infty}^{m} p(T, y-2m) \\mathrm{d}y\n$$\n第一个积分是一个无约束的维纳过程在 $m$ 或以下结束的概率：\n$$\n\\int_{-\\infty}^{m} p(T, y) \\mathrm{d}y = \\int_{-\\infty}^{m} \\frac{1}{\\sqrt{2\\pi T}} \\exp\\left(-\\frac{y^2}{2T}\\right) \\mathrm{d}y\n$$\n令 $z = y/\\sqrt{T}$，则 $\\mathrm{d}z = \\mathrm{d}y/\\sqrt{T}$。该积分变为：\n$$\n\\int_{-\\infty}^{m/\\sqrt{T}} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right) \\mathrm{d}z = \\Phi\\left(\\frac{m}{\\sqrt{T}}\\right)\n$$\n其中 $\\Phi(\\cdot)$ 是标准正态分布的累积分布函数。\n\n对于第二个积分，它代表反射路径的概率质量，我们有：\n$$\n\\int_{-\\infty}^{m} p(T, y-2m) \\mathrm{d}y = \\int_{-\\infty}^{m} \\frac{1}{\\sqrt{2\\pi T}} \\exp\\left(-\\frac{(y-2m)^2}{2T}\\right) \\mathrm{d}y\n$$\n令 $w = (y-2m)/\\sqrt{T}$，则 $\\mathrm{d}w = \\mathrm{d}y/\\sqrt{T}$。积分限发生变化：当 $y \\to -\\infty$ 时，$w \\to -\\infty$；当 $y=m$ 时，$w = (m-2m)/\\sqrt{T} = -m/\\sqrt{T}$。该积分变为：\n$$\n\\int_{-\\infty}^{-m/\\sqrt{T}} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{w^2}{2}\\right) \\mathrm{d}w = \\Phi\\left(-\\frac{m}{\\sqrt{T}}\\right)\n$$\n结合这两个结果：\n$$\n\\mathbb{P}(M_{T} \\le m) = \\Phi\\left(\\frac{m}{\\sqrt{T}}\\right) - \\Phi\\left(-\\frac{m}{\\sqrt{T}}\\right)\n$$\n使用标准正态累积分布函数的对称性 $\\Phi(-x) = 1 - \\Phi(x)$：\n$$\n\\mathbb{P}(M_{T} \\le m) = \\Phi\\left(\\frac{m}{\\sqrt{T}}\\right) - \\left[1 - \\Phi\\left(\\frac{m}{\\sqrt{T}}\\right)\\right] = 2\\Phi\\left(\\frac{m}{\\sqrt{T}}\\right) - 1\n$$\n这就是当 $m \\ge 0$ 时，游走上确界 $M_{T}$ 的累积分布函数。", "answer": "$$\\boxed{2\\Phi\\left(\\frac{m}{\\sqrt{T}}\\right) - 1}$$", "id": "3006291"}]}