{"hands_on_practices": [{"introduction": "二次型常用于模拟物理系统中的能量或成本。因此，理解其最大值和最小值对于稳定性分析和优化至关重要。本练习将引导你探索一个核心原理：在单位长度的约束下，二次型的极值由其关联对称矩阵的特征值决定。通过一个晶体稳定性的假设情景，你将亲自验证为何仅在单个方向上测试稳定性是不足的，并学会如何通过寻找最小特征值来做出全面的稳定性判断。[@problem_id:1355864]", "problem": "在材料科学中，晶体结构在微小形变下的稳定性可以通过一个二次能量泛函来分析。设形变由向量 $\\mathbf{x} \\in \\mathbb{R}^2$ 表示。势能的变化近似为一个二次型 $U(\\mathbf{x}) = \\mathbf{x}^T A \\mathbf{x}$，其中 $A$ 是一个对称矩阵，称为势能的海森矩阵。仅当对于*任何*可能的非零形变，能量都增加时，该系统才被认为是稳定的，这在数学上意味着矩阵 $A$ 必须是正定的（即，对于所有非零 $\\mathbf{x}$，都有 $\\mathbf{x}^T A \\mathbf{x} > 0$）。\n\n考虑一个简化的二维晶格模型，其稳定性由以下矩阵决定：\n$$A = \\begin{pmatrix} -0.6 & 2.8 \\\\ 2.8 & 3.6 \\end{pmatrix}$$\n可以验证，对于某些特定的形变，例如 $\\mathbf{v} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$，能量变化 $U(\\mathbf{v})$ 是正的。然而，为了评估整体稳定性，必须考虑所有可能的形变方向。线性代数中的一个基本结果表明，对于单位向量 $\\mathbf{x}$（即 $\\|\\mathbf{x}\\|=1$），二次型 $\\mathbf{x}^T A \\mathbf{x}$ 的极值是矩阵 $A$ 的特征值。\n\n为了确定该晶格是否真正稳定，求对于任何模为1的形变向量 $\\mathbf{x}$，能量变化函数 $U(\\mathbf{x})$ 的最小可能值。", "solution": "根据瑞利-里兹原理，与实对称矩阵 $A$ 相关的二次型在单位圆 $\\{ \\mathbf{x} \\in \\mathbb{R}^{2} : \\|\\mathbf{x}\\|=1 \\}$ 上取得的极值就是 $A$ 的特征值。因此，对于 $\\|\\mathbf{x}\\|=1$，$U(\\mathbf{x})=\\mathbf{x}^{T}A\\mathbf{x}$ 的最小可能值是 $A$ 的最小特征值。\n\n将 $A$ 的元素重写为精确分数：\n$$\nA=\\begin{pmatrix} -\\frac{3}{5} & \\frac{14}{5} \\\\ \\frac{14}{5} & \\frac{18}{5} \\end{pmatrix}.\n$$\n特征值 $\\lambda$ 满足特征方程 $\\det(A-\\lambda I)=0$。计算：\n$$\n\\det\\!\\begin{pmatrix} -\\frac{3}{5}-\\lambda & \\frac{14}{5} \\\\ \\frac{14}{5} & \\frac{18}{5}-\\lambda \\end{pmatrix}\n=\\left(-\\frac{3}{5}-\\lambda\\right)\\left(\\frac{18}{5}-\\lambda\\right)-\\left(\\frac{14}{5}\\right)^{2}.\n$$\n展开并化简：\n$$\n\\left(-\\frac{3}{5}-\\lambda\\right)\\left(\\frac{18}{5}-\\lambda\\right)=-\\frac{54}{25}+\\frac{3}{5}\\lambda-\\frac{18}{5}\\lambda+\\lambda^{2}\n=\\lambda^{2}-3\\lambda-\\frac{54}{25},\n$$\n和\n$$\n\\left(\\frac{14}{5}\\right)^{2}=\\frac{196}{25}.\n$$\n因此，\n$$\n\\det(A-\\lambda I)=\\lambda^{2}-3\\lambda-\\frac{54}{25}-\\frac{196}{25}\n=\\lambda^{2}-3\\lambda-10.\n$$\n解方程 $\\lambda^{2}-3\\lambda-10=0$ 可得\n$$\n\\lambda=\\frac{3\\pm\\sqrt{9+40}}{2}=\\frac{3\\pm 7}{2},\n$$\n所以特征值为 $5$ 和 $-2$。因此，$U(\\mathbf{x})$ 在所有单位向量上的最小值是最小的特征值，即 $-2$。这个负的最小值表明，该系统在任意微小形变下是不稳定的。", "answer": "$$\\boxed{-2}$$", "id": "1355864"}, {"introduction": "在掌握了二次型在整个空间中的极值与特征值的关系后，一个自然的问题是：如果我们的搜索范围被限制在一个特定的子空间内，该如何寻找极值？这在实际应用中非常普遍，例如当物理或几何约束排除了某些可能性时。本练习将这一原理深化，要求你在单位球面上寻找一个二次型的最大值，但附加了一个正交性约束，这实际上是将优化问题限制在了一个二维平面上。[@problem_id:1355855]", "problem": "考虑一个二次型 $q(\\mathbf{x}) = \\mathbf{x}^T A \\mathbf{x}$，其中向量 $\\mathbf{x} = [x_1, x_2, x_3]^T$ 位于 $\\mathbb{R}^3$ 中，$A$ 是由下式给出的实对称矩阵：\n$$\nA = \\begin{pmatrix} 5 & 1 & 4 \\\\ 1 & 5 & 4 \\\\ 4 & 4 & 2 \\end{pmatrix}\n$$\n你的任务是求出该二次型 $q(\\mathbf{x})$ 的最大值，需同时满足以下两个约束条件：\n1. 向量 $\\mathbf{x}$ 必须是单位向量，即其范数 $\\|\\mathbf{x}\\|$ 必须为 1。\n2. 向量 $\\mathbf{x}$ 必须与向量 $\\mathbf{v} = [1, 1, 1]^T$ 正交。\n\n请以单个数字的形式给出确切的最大值。", "solution": "我们寻求在约束 $\\|\\mathbf{x}\\|=1$ 和 $\\mathbf{x}\\perp\\mathbf{v}$（其中 $\\mathbf{v}=[1,1,1]^{T}$）下 $\\max q(\\mathbf{x})=\\mathbf{x}^{T}A\\mathbf{x}$ 的值。对于一个实对称矩阵 $A$，瑞利商在其子空间上的极值，是在 $A$ 限制在该子空间上的特征向量处取得的，且最大值等于该限制的最大特征值。\n\n约束子空间为 $\\mathbf{v}^{\\perp}=\\{\\mathbf{x}\\in\\mathbb{R}^{3}:\\mathbf{x}\\cdot\\mathbf{v}=0\\}$。$\\mathbf{v}^{\\perp}$ 的一个方便的标准正交基可从以下向量得到\n$$\n\\mathbf{w}_{1}=\\begin{pmatrix}1\\\\-1\\\\0\\end{pmatrix},\\qquad \\mathbf{w}_{2}=\\begin{pmatrix}1\\\\1\\\\-2\\end{pmatrix},\n$$\n它们满足 $\\mathbf{w}_{i}\\cdot\\mathbf{v}=0$ 和 $\\mathbf{w}_{1}\\cdot\\mathbf{w}_{2}=0$。将其标准化为\n$$\n\\mathbf{e}_{1}=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}1\\\\-1\\\\0\\end{pmatrix},\\qquad \\mathbf{e}_{2}=\\frac{1}{\\sqrt{6}}\\begin{pmatrix}1\\\\1\\\\-2\\end{pmatrix}.\n$$\n计算 $A$ 在这些基向量上的作用。首先，\n$$\nA\\begin{pmatrix}1\\\\-1\\\\0\\end{pmatrix}\n=\n\\begin{pmatrix}\n5\\cdot 1+1\\cdot(-1)+4\\cdot 0\\\\\n1\\cdot 1+5\\cdot(-1)+4\\cdot 0\\\\\n4\\cdot 1+4\\cdot(-1)+2\\cdot 0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n4\\\\\n-4\\\\\n0\n\\end{pmatrix}\n=4\\begin{pmatrix}1\\\\-1\\\\0\\end{pmatrix},\n$$\n所以 $A\\mathbf{e}_{1}=4\\mathbf{e}_{1}$，$\\mathbf{e}_{1}$ 是特征值为 $4$ 的特征向量。其次，\n$$\nA\\begin{pmatrix}1\\\\1\\\\-2\\end{pmatrix}\n=\n\\begin{pmatrix}\n5\\cdot 1+1\\cdot 1+4\\cdot(-2)\\\\\n1\\cdot 1+5\\cdot 1+4\\cdot(-2)\\\\\n4\\cdot 1+4\\cdot 1+2\\cdot(-2)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-2\\\\\n-2\\\\\n4\n\\end{pmatrix}\n=-2\\begin{pmatrix}1\\\\1\\\\-2\\end{pmatrix},\n$$\n所以 $A\\mathbf{e}_{2}=-2\\mathbf{e}_{2}$，$\\mathbf{e}_{2}$ 是特征值为 $-2$ 的特征向量。\n\n因此，在具有标准正交基 $\\{\\mathbf{e}_{1},\\mathbf{e}_{2}\\}$ 的子空间 $\\mathbf{v}^{\\perp}$ 上，$A$ 的限制是（在此基下）对角的，其特征值为 $4$ 和 $-2$。根据瑞利商的性质，对于单位向量 $\\mathbf{x}\\in\\mathbf{v}^{\\perp}$，\n$$\n\\min_{\\substack{\\|\\mathbf{x}\\|=1\\\\ \\mathbf{x}\\perp\\mathbf{v}}}\\mathbf{x}^{T}A\\mathbf{x}=-2,\\qquad\n\\max_{\\substack{\\|\\mathbf{x}\\|=1\\\\ \\mathbf{x}\\perp\\mathbf{v}}}\\mathbf{x}^{T}A\\mathbf{x}=4.\n$$\n因此，在给定约束条件下，确切的最大值为 $4$。", "answer": "$$\\boxed{4}$$", "id": "1355855"}, {"introduction": "前面的练习集中于基于向量范数（长度）的约束，其解法与特征值紧密相关。然而，许多现实世界中的优化问题涉及不同类型的约束，例如总预算或总量的固定。本练习将为你介绍一种更具普适性的强大工具——拉格朗日乘数法，用以解决这类带有线性等式约束的优化问题。你将把这个方法应用于一个化学反应过程中的能量最小化问题，从而拓宽你的优化问题解决工具箱。[@problem_id:1355899]", "problem": "一家科技初创公司正在开发一个涉及三种化学前驱物的流程，其用量（以升为单位）分别由$x$、$y$和$z$表示。由于复杂的相互作用，该过程的总能耗（以千焦（kJ）为单位）由以下二次函数建模：\n$$E(x, y, z) = x^2 + 2y^2 + 3z^2 + 2xy - 2xz - 4yz$$\n为了使反应成功，前驱物的总体积必须正好是12升，这就施加了约束条件 $x+y+z=12$。\n\n你的任务是确定成功反应所需的最小可能能耗（以千焦为单位）。请将你的答案表示为精确分数。", "solution": "我们使用拉格朗日乘数法来求解线性约束条件下的二次能量最小值。定义\n$$\nE(x,y,z)=x^{2}+2y^{2}+3z^{2}+2xy-2xz-4yz,\\quad \\text{和}\\quad g(x,y,z)=x+y+z-12=0.\n$$\n构造拉格朗日函数\n$$\n\\mathcal{L}(x,y,z,\\lambda)=E(x,y,z)+\\lambda(x+y+z-12).\n$$\n通过将偏导数设为零，我们得到一阶（平稳性）条件：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial x}=2x+2y-2z+\\lambda=0,\\qquad\n\\frac{\\partial \\mathcal{L}}{\\partial y}=2x+4y-4z+\\lambda=0,\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial z}=-2x-4y+6z+\\lambda=0,\\qquad\n\\frac{\\partial \\mathcal{L}}{\\partial \\lambda}=x+y+z-12=0.\n$$\n将第一个方程从第二个方程中减去，得到\n$$\n(2x+4y-4z+\\lambda)-(2x+2y-2z+\\lambda)=2y-2z=0 \\;\\Rightarrow\\; y=z.\n$$\n将第一个方程从第三个方程中减去，得到\n$$\n(-2x-4y+6z+\\lambda)-(2x+2y-2z+\\lambda)=-4x-6y+8z=0,\n$$\n简化为\n$$\n2x+3y-4z=0.\n$$\n在此关系式中使用 $y=z$ 可得 $2x+3y-4y=0 \\Rightarrow 2x-y=0$，因此\n$$\ny=z=2x.\n$$\n约束条件 $x+y+z=12$ 则变为 $x+2x+2x=5x=12$，所以\n$$\nx=\\frac{12}{5},\\qquad y=z=2x=\\frac{24}{5}.\n$$\n为了确认这个临界点是全局最小值，注意到 $E$ 是一个严格凸的二次型，因为其关联的对称矩阵\n$$\nM=\\begin{pmatrix}\n1 & 1 & -1\\\\\n1 & 2 & -2\\\\\n-1 & -2 & 3\n\\end{pmatrix}\n$$\n的所有顺序主子式都为正：$\\det([1])=1>0$，$\\det\\begin{pmatrix}1&1\\\\1&2\\end{pmatrix}=1>0$ 和 $\\det(M)=1>0$，所以 $M$ 是正定的。因此，在线性约束条件下，KKT条件是充分的，上述解是唯一的全局极小值点。\n\n通过代入 $x=\\frac{12}{5}$ 和 $y=z=\\frac{24}{5}$ 来计算最小能量。令 $a=\\frac{12}{5}$，从而 $y=z=2a$。那么\n$$\nE=a^{2}+2(2a)^{2}+3(2a)^{2}+2a(2a)-2a(2a)-4(2a)(2a)\n= a^{2}+8a^{2}+12a^{2}+4a^{2}-4a^{2}-16a^{2}=5a^{2}.\n$$\n由于 $a^{2}=\\frac{144}{25}$，我们得到\n$$\nE_{\\min}=5\\cdot \\frac{144}{25}=\\frac{144}{5}.\n$$\n因此，最小可能能耗为精确分数 $\\frac{144}{5}$。", "answer": "$$\\boxed{\\frac{144}{5}}$$", "id": "1355899"}]}