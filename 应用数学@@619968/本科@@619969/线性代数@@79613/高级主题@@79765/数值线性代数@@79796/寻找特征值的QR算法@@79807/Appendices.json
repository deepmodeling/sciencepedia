{"hands_on_practices": [{"introduction": "理论学习之后，最佳的深化理解方式便是动手实践。这项练习将引导你完整地走一遍基础QR算法的核心流程，从一个给定的初始矩阵 $A_0$ 计算出下一个迭代矩阵 $A_1$。此外，通过验证迹和行列式在迭代前后保持不变，你将亲手证实QR算法的每次迭代都是一次相似变换，这正是算法能够保持特征值不变的根本原因。[@problem_id:1397703]", "problem": "QR算法是数值线性代数中用于求解矩阵特征值的一种迭代方法。“非移位”版本的算法从一个初始矩阵$A$开始，生成一个矩阵序列$A_0, A_1, A_2, \\dots$。从当前矩阵$A_k$生成序列中的下一个矩阵$A_{k+1}$的过程如下：\n1. 求当前矩阵的QR分解：$A_k = Q_k R_k$，其中$Q_k$是一个正交矩阵，$R_k$是一个上三角矩阵。\n2. 通过颠倒乘法顺序来计算下一个矩阵：$A_{k+1} = R_k Q_k$。\n\n考虑初始矩阵 $A_0 = \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}$。\n\n执行一轮完整的QR算法来计算矩阵$A_1$。然后，计算矩阵$A_0$和$A_1$的迹和行列式。\n\n请将你的答案以一个$1 \\times 4$行矩阵的形式给出，按顺序包含以下四个值：$A_0$的迹，$A_0$的行列式，$A_1$的迹，以及$A_1$的行列式。", "solution": "我们对 $A_{0} = \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}$ 应用一次非移位 QR 迭代。\n\n首先通过对$A_0$的列向量$a_1$和$a_2$进行Gram–Schmidt正交化来计算QR分解$A_{0} = Q R$：\n$$\na_{1} = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}, \\quad \\|a_{1}\\| = \\sqrt{2^{2} + (-1)^{2}} = \\sqrt{5}, \\quad q_{1} = \\frac{a_{1}}{\\|a_{1}\\|} = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}, \\quad r_{11} = \\sqrt{5}.\n$$\n令$a_{2} = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}$。则\n$$\nr_{12} = q_{1}^{T} a_{2} = \\frac{1}{\\sqrt{5}}(2\\cdot(-1) + (-1)\\cdot 2) = -\\frac{4}{\\sqrt{5}}.\n$$\n计算\n$$\nu_{2} = a_{2} - r_{12} q_{1} = a_{2} + \\frac{4}{\\sqrt{5}} q_{1} = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix} + \\frac{4}{\\sqrt{5}} \\cdot \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix} + \\frac{4}{5} \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{5} \\\\ \\frac{6}{5} \\end{pmatrix}.\n$$\n因此\n$$\nr_{22} = \\|u_{2}\\| = \\sqrt{\\left(\\frac{3}{5}\\right)^{2} + \\left(\\frac{6}{5}\\right)^{2}} = \\sqrt{\\frac{45}{25}} = \\frac{3}{\\sqrt{5}}, \\quad q_{2} = \\frac{u_{2}}{r_{22}} = \\begin{pmatrix} \\frac{1}{\\sqrt{5}} \\\\ \\frac{2}{\\sqrt{5}} \\end{pmatrix}.\n$$\n于是\n$$\nQ = \\begin{pmatrix} \\frac{2}{\\sqrt{5}} & \\frac{1}{\\sqrt{5}} \\\\ -\\frac{1}{\\sqrt{5}} & \\frac{2}{\\sqrt{5}} \\end{pmatrix}, \\quad\nR = \\begin{pmatrix} \\sqrt{5} & -\\frac{4}{\\sqrt{5}} \\\\ 0 & \\frac{3}{\\sqrt{5}} \\end{pmatrix}.\n$$\n\n计算 $A_{1} = R Q$：\n$$\nR Q = \\begin{pmatrix} \\sqrt{5} & -\\frac{4}{\\sqrt{5}} \\\\ 0 & \\frac{3}{\\sqrt{5}} \\end{pmatrix}\n\\begin{pmatrix} \\frac{2}{\\sqrt{5}} & \\frac{1}{\\sqrt{5}} \\\\ -\\frac{1}{\\sqrt{5}} & \\frac{2}{\\sqrt{5}} \\end{pmatrix}\n= \\begin{pmatrix}\n\\frac{14}{5} & -\\frac{3}{5} \\\\\n-\\frac{3}{5} & \\frac{6}{5}\n\\end{pmatrix}.\n$$\n\n现在计算迹和行列式。\n对于$A_0$：\n$$\n\\operatorname{tr}(A_{0}) = 2 + 2 = 4, \\quad \\det(A_{0}) = 2\\cdot 2 - (-1)\\cdot(-1) = 4 - 1 = 3.\n$$\n对于$A_1$：\n$$\n\\operatorname{tr}(A_{1}) = \\frac{14}{5} + \\frac{6}{5} = \\frac{20}{5} = 4, \\quad\n\\det(A_{1}) = \\frac{14}{5}\\cdot \\frac{6}{5} - \\left(-\\frac{3}{5}\\right)^{2} = \\frac{84}{25} - \\frac{9}{25} = \\frac{75}{25} = 3.\n$$\n作为一致性检验，由于对于正交矩阵$Q$有$A_{1} = Q^{T} A_{0} Q$，迹和行列式都是不变量，必须与$A_{0}$的相匹配，事实也确实如此。因此，所求的$1 \\times 4$行矩阵为 $\\begin{pmatrix} 4 & 3 & 4 & 3 \\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix} 4 & 3 & 4 & 3 \\end{pmatrix}}$$", "id": "1397703"}, {"introduction": "掌握了基本步骤后，探索算法的边界和局限性同样重要。这个练习是一个特殊的思想实验，研究对象是一个无法对角化的矩阵——若尔当块 (Jordan block)。通过对这个特殊矩阵应用基础QR算法，你会发现算法序列并不会如预期那样收敛到上三角形式，从而揭示了基础算法的局限性，并为理解更高级的“位移”技巧的必要性打下基础。[@problem_id:1397702]", "problem": "基本QR算法是一种用于求解矩阵特征值的迭代方法。从一个初始矩阵 $A_0$ 开始，该算法生成一个矩阵序列 $\\{A_k\\}_{k=0}^\\infty$。每一步都包含两个操作：首先，对当前矩阵 $A_k$ 进行QR分解，得到乘积 $A_k = Q_k R_k$；其次，反转乘法顺序以获得序列中的下一个矩阵 $A_{k+1} = R_k Q_k$。对于本问题，QR分解的定义为：$Q_k$ 是一个正交矩阵，$R_k$ 是一个对角元非负的上三角矩阵。\n\n设初始矩阵 $A_0$ 为以下代表一个Jordan块的2x2实矩阵：\n$$\nA_0 = \\begin{pmatrix} \\lambda & \\alpha \\\\ 0 & \\lambda \\end{pmatrix}\n$$\n此处，$\\lambda$ 和 $\\alpha$ 是非零实常数，并附带条件 $\\lambda > 0$。\n\n已知由基本QR算法生成的矩阵序列 $\\{A_k\\}$ 收敛到一个极限矩阵，我们记作 $A_\\infty = \\lim_{k\\to\\infty} A_k$。\n\n确定矩阵 $(A_\\infty)_{1,2}$ 元素的值。您的答案应为用给定参数表示的解析表达式。", "solution": "我们对给定的初始矩阵进行QR分解\n$$\nA_{0}=\\begin{pmatrix}\\lambda & \\alpha \\\\ 0 & \\lambda\\end{pmatrix},\n$$\n按照约定，在QR分解 $A_{0}=Q_{0}R_{0}$ 中，矩阵 $Q_{0}$ 是正交矩阵，矩阵 $R_{0}$ 是对角元非负的上三角矩阵。\n\n将 $A_{0}$ 的列向量记为 $a_{1}$ 和 $a_{2}$：\n$$\na_{1}=\\begin{pmatrix}\\lambda \\\\ 0\\end{pmatrix},\\quad a_{2}=\\begin{pmatrix}\\alpha \\\\ \\lambda\\end{pmatrix}.\n$$\n根据Gram–Schmidt过程，$Q_{0}$ 的第一列为\n$$\nq_{1}=\\frac{a_{1}}{\\|a_{1}\\|}=\\frac{1}{\\sqrt{\\lambda^{2}}}\\begin{pmatrix}\\lambda \\\\ 0\\end{pmatrix}=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix},\n$$\n因为 $\\lambda>0$ 意味着 $\\|a_{1}\\|=\\lambda$。那么\n$$\nr_{11}=\\|a_{1}\\|=\\lambda,\\qquad r_{12}=q_{1}^{T}a_{2}=\\alpha.\n$$\n定义\n$$\nu_{2}=a_{2}-r_{12}q_{1}=\\begin{pmatrix}\\alpha \\\\ \\lambda\\end{pmatrix}-\\alpha\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}=\\begin{pmatrix}0 \\\\ \\lambda\\end{pmatrix},\n$$\n所以\n$$\nr_{22}=\\|u_{2}\\|=\\sqrt{0^{2}+\\lambda^{2}}=\\lambda,\\qquad q_{2}=\\frac{u_{2}}{r_{22}}=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}.\n$$\n因此\n$$\nQ_{0}=\\begin{pmatrix}1 & 0 \\\\ 0 & 1\\end{pmatrix},\\qquad R_{0}=\\begin{pmatrix}\\lambda & \\alpha \\\\ 0 & \\lambda\\end{pmatrix}=A_{0}.\n$$\n由于基本算法的QR步骤将 $A_{1}$ 设置为 $R_{0}Q_{0}$，我们得到\n$$\nA_{1}=R_{0}Q_{0}=A_{0}.\n$$\n通过归纳法，对于所有 $k\\geq 0$ 都有 $A_{k}=A_{0}$，因此该序列是平稳的，且极限存在并且为\n$$\nA_{\\infty}=\\lim_{k\\to\\infty}A_{k}=A_{0}.\n$$\n因此，元素 $(A_{\\infty})_{1,2}$ 等于元素 $(A_{0})_{1,2}$，即 $\\alpha$。", "answer": "$$\\boxed{\\alpha}$$", "id": "1397702"}, {"introduction": "针对基础QR算法在某些情况下收敛缓慢甚至失效的问题，引入“位移”策略是一种至关重要的改进。这项练习将向你展示如何运用带位移的QR算法，这是一种能显著加速收敛的强大技术。你将通过计算一个完整的位移QR迭代步骤，具体地理解如何选择位移量，并如何将它融入分解与重组的过程中，从而体会这一改进在实践中的威力。[@problem_id:1397701]", "problem": "带位移的 QR 算法是一种用于计算矩阵特征值的迭代方法。从矩阵 $A_k$ 开始的单次迭代，由以下一系列操作定义：\n1. 根据 $A_k$ 的元素选择一个位移量 $\\sigma_k$。\n2. 对位移后的矩阵 $A_k - \\sigma_k I$ 进行 QR 分解，得到 $A_k - \\sigma_k I = Q_k R_k$。其中，$I$ 是单位矩阵，$Q_k$ 是一个正交矩阵，$R_k$ 是一个对角线元素为非负的上三角矩阵。\n3. 然后计算序列中的下一个矩阵 $A_{k+1}$，其计算公式为 $A_{k+1} = R_k Q_k + \\sigma_k I$。\n\n这个过程生成一个与 $A_0$ 相似的矩阵序列 $A_0, A_1, A_2, \\dots$，在特定条件下，该序列会收敛为一个上三角矩阵，其对角线上的元素即为特征值。\n\n考虑初始矩阵：\n$$\nA_0 = \\begin{pmatrix} 5 & -2 \\\\ 4 & -1 \\end{pmatrix}\n$$\n对于算法的第一步，我们将使用简单的 Rayleigh 商位移，它被定义为当前矩阵的右下角元素。因此，位移量为 $\\sigma_0 = (A_0)_{22}$。\n\n遵循上述步骤，求出第一个位移迭代矩阵 $A_1$。", "solution": "问题要求我们求出将带位移的 QR 算法应用于矩阵 $A_0 = \\begin{pmatrix} 5 & -2 \\\\ 4 & -1 \\end{pmatrix}$ 后的第一个迭代结果 $A_1$。\n\n步骤 1：确定位移量 $\\sigma_0$。\n位移量被指定为 $A_0$ 的右下角元素。\n$$\n\\sigma_0 = (A_0)_{22} = -1\n$$\n\n步骤 2：构造位移矩阵 $A_0 - \\sigma_0 I$。\n$$\nA_0 - \\sigma_0 I = \\begin{pmatrix} 5 & -2 \\\\ 4 & -1 \\end{pmatrix} - (-1)\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 5 & -2 \\\\ 4 & -1 \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 6 & -2 \\\\ 4 & 0 \\end{pmatrix}\n$$\n\n步骤 3：求位移矩阵的 QR 分解，$A_0 - \\sigma_0 I = Q_0 R_0$。\n令 $B = A_0 - \\sigma_0 I = \\begin{pmatrix} 6 & -2 \\\\ 4 & 0 \\end{pmatrix}$。我们将使用 Gram-Schmidt 过程对其列向量 $b_1 = \\begin{pmatrix} 6 \\\\ 4 \\end{pmatrix}$ 和 $b_2 = \\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix}$ 进行 QR 分解。$Q_0$ 的列将构成一个标准正交基 $\\{q_1, q_2\\}$。\n\n首先，我们求 $q_1$。正交基的第一个向量是 $u_1 = b_1 = \\begin{pmatrix} 6 \\\\ 4 \\end{pmatrix}$。\n其范数为 $\\|u_1\\| = \\sqrt{6^2 + 4^2} = \\sqrt{36 + 16} = \\sqrt{52} = 2\\sqrt{13}$。\n第一个标准正交向量是 $q_1$：\n$$\nq_1 = \\frac{u_1}{\\|u_1\\|} = \\frac{1}{2\\sqrt{13}}\\begin{pmatrix} 6 \\\\ 4 \\end{pmatrix} = \\frac{1}{\\sqrt{13}}\\begin{pmatrix} 3 \\\\ 2 \\end{pmatrix}\n$$\n\n接下来，我们求 $q_2$。我们首先通过减去 $b_2$ 在 $q_1$ 上的投影来找到一个与 $q_1$ 正交的向量 $u_2$：\n$$\nu_2 = b_2 - (q_1^T b_2)q_1\n$$\n投影项为：\n$$\nq_1^T b_2 = \\frac{1}{\\sqrt{13}}\\begin{pmatrix} 3 & 2 \\end{pmatrix} \\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix} = \\frac{-6}{\\sqrt{13}}\n$$\n所以，$u_2$ 是：\n$$\nu_2 = \\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix} - \\left(\\frac{-6}{\\sqrt{13}}\\right) \\frac{1}{\\sqrt{13}}\\begin{pmatrix} 3 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix} + \\frac{6}{13}\\begin{pmatrix} 3 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -2 + \\frac{18}{13} \\\\ \\frac{12}{13} \\end{pmatrix} = \\begin{pmatrix} -\\frac{8}{13} \\\\ \\frac{12}{13} \\end{pmatrix}\n$$\n$u_2$ 的范数是 $\\|u_2\\| = \\sqrt{\\left(-\\frac{8}{13}\\right)^2 + \\left(\\frac{12}{13}\\right)^2} = \\frac{1}{13}\\sqrt{64 + 144} = \\frac{\\sqrt{208}}{13} = \\frac{\\sqrt{16 \\times 13}}{13} = \\frac{4\\sqrt{13}}{13}$。\n第二个标准正交向量是 $q_2$：\n$$\nq_2 = \\frac{u_2}{\\|u_2\\|} = \\frac{13}{4\\sqrt{13}}\\begin{pmatrix} -\\frac{8}{13} \\\\ \\frac{12}{13} \\end{pmatrix} = \\frac{1}{4\\sqrt{13}}\\begin{pmatrix} -8 \\\\ 12 \\end{pmatrix} = \\frac{1}{\\sqrt{13}}\\begin{pmatrix} -2 \\\\ 3 \\end{pmatrix}\n$$\n正交矩阵 $Q_0$ 由列向量 $q_1$ 和 $q_2$ 构成：\n$$\nQ_0 = \\begin{pmatrix} q_1 & q_2 \\end{pmatrix} = \\frac{1}{\\sqrt{13}}\\begin{pmatrix} 3 & -2 \\\\ 2 & 3 \\end{pmatrix}\n$$\n上三角矩阵 $R_0$ 可以通过 $R_0 = Q_0^T (A_0 - \\sigma_0 I)$ 求得：\n$$\nQ_0^T = \\frac{1}{\\sqrt{13}}\\begin{pmatrix} 3 & 2 \\\\ -2 & 3 \\end{pmatrix}\n$$\n$$\nR_0 = \\frac{1}{\\sqrt{13}}\\begin{pmatrix} 3 & 2 \\\\ -2 & 3 \\end{pmatrix} \\begin{pmatrix} 6 & -2 \\\\ 4 & 0 \\end{pmatrix} = \\frac{1}{\\sqrt{13}}\\begin{pmatrix} 3(6)+2(4) & 3(-2)+2(0) \\\\ -2(6)+3(4) & -2(-2)+3(0) \\end{pmatrix} = \\frac{1}{\\sqrt{13}}\\begin{pmatrix} 26 & -6 \\\\ 0 & 4 \\end{pmatrix}\n$$\n对角线元素 $26/\\sqrt{13}$ 和 $4/\\sqrt{13}$ 均为非负，符合要求。\n\n步骤 4：计算下一个迭代矩阵 $A_1 = R_0 Q_0 + \\sigma_0 I$。\n首先，我们计算乘积 $R_0 Q_0$：\n$$\nR_0 Q_0 = \\left(\\frac{1}{\\sqrt{13}}\\begin{pmatrix} 26 & -6 \\\\ 0 & 4 \\end{pmatrix}\\right) \\left(\\frac{1}{\\sqrt{13}}\\begin{pmatrix} 3 & -2 \\\\ 2 & 3 \\end{pmatrix}\\right) = \\frac{1}{13}\\begin{pmatrix} 26(3)+(-6)(2) & 26(-2)+(-6)(3) \\\\ 0(3)+4(2) & 0(-2)+4(3) \\end{pmatrix}\n$$\n$$\nR_0 Q_0 = \\frac{1}{13}\\begin{pmatrix} 78-12 & -52-18 \\\\ 8 & 12 \\end{pmatrix} = \\frac{1}{13}\\begin{pmatrix} 66 & -70 \\\\ 8 & 12 \\end{pmatrix}\n$$\n现在，我们将位移项 $\\sigma_0 I$ 加回去：\n$$\nA_1 = R_0 Q_0 + \\sigma_0 I = \\frac{1}{13}\\begin{pmatrix} 66 & -70 \\\\ 8 & 12 \\end{pmatrix} + (-1)\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\n$$\nA_1 = \\begin{pmatrix} \\frac{66}{13} & -\\frac{70}{13} \\\\ \\frac{8}{13} & \\frac{12}{13} \\end{pmatrix} - \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{66}{13} - 1 & -\\frac{70}{13} \\\\ \\frac{8}{13} & \\frac{12}{13} - 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{53}{13} & -\\frac{70}{13} \\\\ \\frac{8}{13} & -\\frac{1}{13} \\end{pmatrix}\n$$\n因此，第一个位移迭代矩阵是 $A_1$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{53}{13} & -\\frac{70}{13} \\\\ \\frac{8}{13} & -\\frac{1}{13} \\end{pmatrix}}\n$$", "id": "1397701"}]}