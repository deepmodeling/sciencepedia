{"hands_on_practices": [{"introduction": "要真正掌握条件数，我们首先从最简单的情形入手。本练习将引导你计算一个对角矩阵的条件数[@problem_id:2210796]，让你清晰地看到条件数是如何直接与其奇异值（在这里即对角元素的绝对值）的极值比相关联的，为理解更复杂的情况奠定坚实基础。", "problem": "在数值分析中，矩阵的条件数衡量了线性系统 $A\\mathbf{x} = \\mathbf{b}$ 的解对于向量 $\\mathbf{b}$ 的微小变化的敏感程度。考虑一个特定的线性系统，其系统矩阵 $D$ 是一个由下式给出的 $3 \\times 3$ 实对角矩阵：\n$$\nD = \\begin{pmatrix} \\alpha & 0 & 0 \\\\ 0 & -\\beta & 0 \\\\ 0 & 0 & \\gamma \\end{pmatrix}\n$$\n参数 $\\alpha$、$\\beta$ 和 $\\gamma$ 是满足排序 $0 < \\alpha < \\beta < \\gamma$ 的正实数常量。\n\n一个可逆矩阵 $A$ 的 2-范数条件数记作 $\\kappa_2(A)$，由公式 $\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2$ 定义，其中 $\\| \\cdot \\|_2$ 是矩阵 2-范数，也称为谱范数。\n\n求解给定矩阵 $D$ 的 2-范数条件数 $\\kappa_2(D)$。请用 $\\alpha$、$\\beta$ 和 $\\gamma$ 将您的最终答案表示为一个闭式解析表达式。", "solution": "给定对角矩阵 $D = \\operatorname{diag}(\\alpha,-\\beta,\\gamma)$，其中 $0<\\alpha<\\beta<\\gamma$。2-范数条件数由 $\\kappa_{2}(D) = \\|D\\|_{2}\\,\\|D^{-1}\\|_{2}$ 定义，其中矩阵 2-范数是谱范数（最大奇异值）。\n\n矩阵 $A$ 的奇异值是 $A^{T}A$ 的特征值的平方根。对于对角矩阵 $D$，我们计算\n$$\nD^{T}D = \\operatorname{diag}(\\alpha,-\\beta,\\gamma)^{T}\\operatorname{diag}(\\alpha,-\\beta,\\gamma) = \\operatorname{diag}(\\alpha^{2},\\beta^{2},\\gamma^{2}).\n$$\n因此，$D$ 的奇异值为 $\\sigma_{1}=\\alpha$、$\\sigma_{2}=\\beta$ 和 $\\sigma_{3}=\\gamma$。所以，\n$$\n\\|D\\|_{2} = \\max\\{\\alpha,\\beta,\\gamma\\} = \\gamma.\n$$\n\n因为 $D$ 是对角元素非零的对角矩阵，所以它是可逆的，且\n$$\nD^{-1} = \\operatorname{diag}\\left(\\frac{1}{\\alpha},-\\frac{1}{\\beta},\\frac{1}{\\gamma}\\right).\n$$\n同理可得，$D^{-1}$ 的奇异值为 $\\frac{1}{\\alpha}$、$\\frac{1}{\\beta}$ 和 $\\frac{1}{\\gamma}$，所以\n$$\n\\|D^{-1}\\|_{2} = \\max\\left\\{\\frac{1}{\\alpha},\\frac{1}{\\beta},\\frac{1}{\\gamma}\\right\\} = \\frac{1}{\\alpha},\n$$\n因为 $0<\\alpha<\\beta<\\gamma$。\n\n因此，2-范数条件数为\n$$\n\\kappa_{2}(D) = \\|D\\|_{2}\\,\\|D^{-1}\\|_{2} = \\gamma \\cdot \\frac{1}{\\alpha} = \\frac{\\gamma}{\\alpha}.\n$$", "answer": "$$\\boxed{\\frac{\\gamma}{\\alpha}}$$", "id": "2210796"}, {"introduction": "条件数不仅仅是一个抽象的数字，它还蕴含着深刻的几何意义。本练习 [@problem_id:1393630] 通过对比一个理想的旋转变换和一个带有拉伸的变换，生动地展示了良态矩阵（如正交矩阵）如何保持几何结构的稳定性，而病态矩阵又是如何可能扭曲空间并放大误差的。", "problem": "在机器人学领域，线性变换被用于为组件的运动和姿态建模。这些变换的数值稳定性至关重要，因为传感器读数或计算中的微小误差可能会被放大，导致不准确的运动。矩阵 $A$ 的 2-范数条件数 $\\kappa_2(A)$ 是这种误差放大的一个度量。它被定义为矩阵最大奇异值与最小奇异值的比值，即 $\\kappa_2(A) = \\frac{\\sigma_{max}}{\\sigma_{min}}$。接近 1 的条件数表明这是一个良态、稳定的变换，它能在不产生显著扭曲的情况下保持空间的几何形状。\n\n考虑两种不同的线性变换 A 和 B，它们被提出来用于为机器人末端执行器定向。它们分别由矩阵 $M_A$ 和 $M_B$ 表示：\n\n$$M_A = \\begin{pmatrix} \\frac{\\sqrt{3}}{2} & -\\frac{1}{2} \\\\[0.5em] \\frac{1}{2} & \\frac{\\sqrt{3}}{2} \\end{pmatrix}$$\n\n$$M_B = \\begin{pmatrix} 2 & 1 \\\\[0.5em] 0 & \\frac{1}{2} \\end{pmatrix}$$\n\n计算变换 B 的条件数与变换 A 的条件数之比，即 $\\frac{\\kappa_2(M_B)}{\\kappa_2(M_A)}$。将您的答案表示为单个封闭形式的解析表达式。", "solution": "一个矩阵 $A$ 的 2-范数条件数定义为 $\\kappa_{2}(A) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}}$，其中 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$ 分别是 $A$ 的最大和最小奇异值。\n\n首先，考虑 $M_{A}$。矩阵\n$$\nM_{A} = \\begin{pmatrix} \\frac{\\sqrt{3}}{2} & -\\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{\\sqrt{3}}{2} \\end{pmatrix}\n$$\n是一个旋转矩阵（旋转角度的余弦值为 $\\frac{\\sqrt{3}}{2}$，正弦值为 $\\frac{1}{2}$），因此是正交的：$M_{A}^{T}M_{A} = I$。因此，$M_{A}$ 的所有奇异值都等于 $1$，且\n$$\n\\kappa_{2}(M_{A}) = 1.\n$$\n\n接下来，考虑 $M_{B}$：\n$$\nM_{B} = \\begin{pmatrix} 2 & 1 \\\\ 0 & \\frac{1}{2} \\end{pmatrix}.\n$$\n$M_{B}$ 的奇异值是 $M_{B}^{T}M_{B}$ 特征值的平方根。计算\n$$\nM_{B}^{T} = \\begin{pmatrix} 2 & 0 \\\\ 1 & \\frac{1}{2} \\end{pmatrix}, \\quad\nM_{B}^{T}M_{B} = \\begin{pmatrix} 2 & 0 \\\\ 1 & \\frac{1}{2} \\end{pmatrix}\\begin{pmatrix} 2 & 1 \\\\ 0 & \\frac{1}{2} \\end{pmatrix}\n= \\begin{pmatrix} 4 & 2 \\\\ 2 & \\frac{5}{4} \\end{pmatrix}.\n$$\n对于对称矩阵 $M_{B}^{T}M_{B}$，其特征值 $\\lambda_{\\pm}$ 由以下公式给出\n$$\n\\lambda_{\\pm} = \\frac{\\operatorname{tr}(M_{B}^{T}M_{B}) \\pm \\sqrt{\\operatorname{tr}(M_{B}^{T}M_{B})^{2} - 4\\det(M_{B}^{T}M_{B})}}{2}.\n$$\n计算迹和行列式：\n$$\n\\operatorname{tr}(M_{B}^{T}M_{B}) = 4 + \\frac{5}{4} = \\frac{21}{4}, \\quad \\det(M_{B}^{T}M_{B}) = 4 \\cdot \\frac{5}{4} - 2 \\cdot 2 = 1.\n$$\n因此，\n$$\n\\lambda_{\\pm} = \\frac{\\frac{21}{4} \\pm \\sqrt{\\left(\\frac{21}{4}\\right)^{2} - 4}}{2}\n= \\frac{\\frac{21}{4} \\pm \\sqrt{\\frac{441}{16} - \\frac{64}{16}}}{2}\n= \\frac{\\frac{21}{4} \\pm \\frac{\\sqrt{377}}{4}}{2}\n= \\frac{21 \\pm \\sqrt{377}}{8}.\n$$\n令 $\\lambda_{\\max} = \\frac{21 + \\sqrt{377}}{8}$ 且 $\\lambda_{\\min} = \\frac{21 - \\sqrt{377}}{8}$。奇异值为 $\\sigma_{\\max} = \\sqrt{\\lambda_{\\max}}$ 和 $\\sigma_{\\min} = \\sqrt{\\lambda_{\\min}}$。因为 $\\det(M_{B}) = 1$，所以 $\\det(M_{B}^{T}M_{B}) = 1$，从而 $\\lambda_{\\max}\\lambda_{\\min} = 1$。因此\n$$\n\\kappa_{2}(M_{B}) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}} = \\sqrt{\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}} = \\sqrt{\\lambda_{\\max}^{2}} = \\lambda_{\\max} = \\frac{21 + \\sqrt{377}}{8}.\n$$\n\n最后，所求的比值为\n$$\n\\frac{\\kappa_{2}(M_{B})}{\\kappa_{2}(M_{A})} = \\frac{\\frac{21 + \\sqrt{377}}{8}}{1} = \\frac{21 + \\sqrt{377}}{8}.\n$$", "answer": "$$\\boxed{\\frac{21+\\sqrt{377}}{8}}$$", "id": "1393630"}, {"introduction": "一个矩阵的行列式为1，是否就意味着它在数值计算中表现良好？本练习 [@problem_id:1393610] 将通过一个经典的剪切矩阵例子，让你亲手揭示一个看似“无害”的保面积变换如何可以变得高度“病态”。这个反直觉的例子将加深你对条件数重要性的理解，并让你明白为何不能单凭行列式来判断一个矩阵的数值稳定性。", "problem": "在数值线性代数中，矩阵的条件数衡量了线性方程组的解对输入数据微小变化的敏感程度。条件数高的矩阵被认为是“病态的”(ill-conditioned)。\n\n考虑以下由实数 $k$ 参数化的 $2 \\times 2$ 矩阵族：\n$$\nM(k) = \\begin{pmatrix} 1 & k \\\\ 0 & 1 \\end{pmatrix}\n$$\n这些矩阵表示一个水平剪切变换。对于任意 $k$ 值，$M(k)$ 的行列式都恰好为 1。这可能会让人天真地认为该矩阵总是表现良好的。然而，它的条件数可能变得非常大。\n\n一个可逆矩阵 $A$ 关于矩阵 2-范数（也称为谱范数）的条件数定义为 $\\kappa_2(A) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}}$，其中 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$ 分别是 $A$ 的最大和最小奇异值。$A$ 的奇异值是矩阵 $A^T A$ 的特征值的平方根。\n\n确定使条件数 $\\kappa_2(M(k))$ 等于 50 的 $k$ 的精确正值。请以单个封闭形式的解析表达式给出您的答案。", "solution": "我们已知 $M(k)=\\begin{pmatrix}1 & k \\\\ 0 & 1\\end{pmatrix}$，并希望其 2-范数条件数 $\\kappa_{2}(M(k))=\\sigma_{\\max}/\\sigma_{\\min}$ 等于 $50$，其中奇异值是矩阵 $M(k)^{T}M(k)$ 的特征值的平方根。\n\n首先计算\n$$\nM(k)^{T}M(k)=\\begin{pmatrix}1 & 0 \\\\ k & 1\\end{pmatrix}\\begin{pmatrix}1 & k \\\\ 0 & 1\\end{pmatrix}\n=\\begin{pmatrix}1 & k \\\\ k & k^{2}+1\\end{pmatrix}.\n$$\n对于一个对称 $2\\times 2$ 矩阵 $\\begin{pmatrix}a & b \\\\ b & d\\end{pmatrix}$，其特征值为\n$$\n\\lambda_{\\pm}=\\frac{a+d\\pm\\sqrt{(a-d)^{2}+4b^{2}}}{2}.\n$$\n这里 $a=1$，$b=k$，$d=k^{2}+1$，所以\n$$\n\\lambda_{\\pm}=\\frac{k^{2}+2\\pm\\sqrt{k^{4}+4k^{2}}}{2}\n=\\frac{k^{2}+2\\pm |k|\\sqrt{k^{2}+4}}{2}.\n$$\n对于 $k>0$，这变为\n$$\n\\lambda_{\\max}=\\frac{k^{2}+2+k\\sqrt{k^{2}+4}}{2},\\quad\n\\lambda_{\\min}=\\frac{k^{2}+2-k\\sqrt{k^{2}+4}}{2}.\n$$\n因此条件数为\n$$\n\\kappa_{2}(M(k))=\\sqrt{\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}}\n=\\sqrt{\\frac{k^{2}+2+k\\sqrt{k^{2}+4}}{k^{2}+2-k\\sqrt{k^{2}+4}}}.\n$$\n令其等于 $50$ 并将两边平方：\n$$\n2500=\\frac{k^{2}+2+k\\sqrt{k^{2}+4}}{k^{2}+2-k\\sqrt{k^{2}+4}}.\n$$\n引入 $X=k^{2}+2$ 和 $Y=k\\sqrt{k^{2}+4}$ （其中 $k>0$ 故 $Y>0$）。那么\n$$\n2500=\\frac{X+Y}{X-Y}\\quad\\Longrightarrow\\quad X+Y=2500(X-Y).\n$$\n求解比率 $r=\\frac{Y}{X}$ 得\n$$\n\\frac{Y}{X}=\\frac{2500-1}{2500+1}=\\frac{2499}{2501}.\n$$\n因此\n$$\nk\\sqrt{k^{2}+4}=\\frac{2499}{2501}\\,(k^{2}+2).\n$$\n令 $t=k^{2}\\ge 0$。将两边平方得到\n$$\nt(t+4)=\\left(\\frac{2499}{2501}\\right)^{2}(t+2)^{2}.\n$$\n记 $c=\\left(\\frac{2499}{2501}\\right)^{2}$。展开并合并同类项，\n$$\nt^{2}+4t=c(t^{2}+4t+4)\n\\;\\Longrightarrow\\;\n(1-c)t^{2}+4(1-c)t-4c=0.\n$$\n因为 $c<1$，除以 $(1-c)$：\n$$\nt^{2}+4t-\\frac{4c}{1-c}=0.\n$$\n计算 $\\frac{4c}{1-c}$，使用 $1-c=\\frac{2501^{2}-2499^{2}}{2501^{2}}=\\frac{10000}{2501^{2}}$，所以\n$$\n\\frac{4c}{1-c}=\\frac{4\\cdot \\frac{2499^{2}}{2501^{2}}}{\\frac{10000}{2501^{2}}}=\\frac{2499^{2}}{2500}.\n$$\n因此\n$$\nt^{2}+4t-\\frac{2499^{2}}{2500}=0.\n$$\n判别式为\n$$\n\\Delta=16+4\\cdot\\frac{2499^{2}}{2500}=16+\\frac{2499^{2}}{625}\n=\\frac{10000+2499^{2}}{625}=\\frac{2501^{2}}{625},\n$$\n所以 $\\sqrt{\\Delta}=\\frac{2501}{25}$。因此\n$$\nt=\\frac{-4+\\frac{2501}{25}}{2}=\\frac{\\frac{-100+2501}{25}}{2}=\\frac{2401}{50}.\n$$\n因为 $t=k^{2}$ 且 $k>0$，我们得到\n$$\nk=\\sqrt{\\frac{2401}{50}}=\\frac{49}{\\sqrt{50}}=\\frac{49\\sqrt{2}}{10}.\n$$\n根据构造，这个 $k$ 值使得 $\\kappa_{2}(M(k))=50$。", "answer": "$$\\boxed{\\frac{49\\sqrt{2}}{10}}$$", "id": "1393610"}]}