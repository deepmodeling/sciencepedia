{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。本节的第一个练习将带你掌握一项基本技能：构建一个二维吉文斯旋转矩阵，用以将向量的特定分量清零。通过完成这个练习 [@problem_id:2176490]，你将亲手实践定义吉文斯旋转的核心公式，为理解更复杂的应用打下坚实的基础。", "problem": "在数值线性代数中，吉文斯旋转是一种在二维平面中旋转向量的操作，常用于在诸如QR分解等算法中将向量或矩阵中的元素置零。一个 2x2 的吉文斯矩阵是一个形如下式的正交矩阵\n$$\nG = \\begin{pmatrix} c & s \\\\ -s & c \\end{pmatrix}\n$$\n其中 $c$ 和 $s$ 是满足条件 $c^2 + s^2 = 1$ 的实数。\n\n考虑向量 $x = \\begin{pmatrix} 7 \\\\ -4 \\end{pmatrix}$。求一个特定的吉文斯矩阵 $G$，它能将此向量 $x$ 变换为一个新向量 $y = Gx$，其形式为 $\\begin{pmatrix} r \\\\ 0 \\end{pmatrix}$，并满足附加约束条件，即所得分量 $r$ 必须为正。\n\n请以包含精确数值的 2x2 矩阵形式给出您的答案。", "solution": "设 $G=\\begin{pmatrix} c & s \\\\ -s & c \\end{pmatrix}$ 且 $c^{2}+s^{2}=1$，并设 $x=\\begin{pmatrix} a \\\\ b \\end{pmatrix}$。那么\n$$\nGx=\\begin{pmatrix} ca+sb \\\\ -sa+cb \\end{pmatrix}.\n$$\n为了得到 $Gx=\\begin{pmatrix} r \\\\ 0 \\end{pmatrix}$，需要令第二个分量为零：\n$$\n-sa+cb=0 \\quad \\Longleftrightarrow \\quad cb=sa.\n$$\n一个满足此条件和 $c^{2}+s^{2}=1$ 的标准选择是\n$$\nr=\\sqrt{a^{2}+b^{2}}, \\quad c=\\frac{a}{r}, \\quad s=\\frac{b}{r}.\n$$\n根据这个选择，\n$$\n-sa+cb=-\\frac{b}{r}a+\\frac{a}{r}b=0, \\quad ca+sb=\\frac{a^{2}+b^{2}}{r}=r,\n$$\n并且由于 $r=\\sqrt{a^{2}+b^{2}}$ 是正数，因此满足 $r>0$ 的要求。\n\n对于 $x=\\begin{pmatrix} 7 \\\\ -4 \\end{pmatrix}$，我们有 $a=7$，$b=-4$，因此\n$$\nr=\\sqrt{7^{2}+(-4)^{2}}=\\sqrt{65}, \\quad c=\\frac{7}{\\sqrt{65}}, \\quad s=\\frac{-4}{\\sqrt{65}}.\n$$\n所以，\n$$\nG=\\begin{pmatrix} \\frac{7}{\\sqrt{65}} & \\frac{-4}{\\sqrt{65}} \\\\ \\frac{4}{\\sqrt{65}} & \\frac{7}{\\sqrt{65}} \\end{pmatrix}.\n$$\n此矩阵 $G$ 产生 $Gx=\\begin{pmatrix} \\sqrt{65} \\\\ 0 \\end{pmatrix}$，其第一个分量为正，符合要求。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{7}{\\sqrt{65}} & \\frac{-4}{\\sqrt{65}} \\\\ \\frac{4}{\\sqrt{65}} & \\frac{7}{\\sqrt{65}} \\end{pmatrix}}$$", "id": "2176490"}, {"introduction": "在掌握了单步清零操作后，让我们将视野扩展到更高维度。这个问题 [@problem_id:1365884] 挑战你设计一个策略，通过一系列吉文斯旋转将一个任意的 $n$ 维向量变换为标准基向量的倍数。这要求你从算法层面思考所需旋转的次序与最少次数，从而揭示吉文斯旋转在高维空间中的效率与威力。", "problem": "设 $x$ 是 $\\mathbb{R}^n$中的一个非零向量，其中 $n \\ge 2$ 是一个整数。我们希望将 $x$ 变换为一个向量 $y$，该向量是第一个标准基向量 $e_1 = (1, 0, \\dots, 0)^T$ 的标量倍。这个变换将通过应用一系列 Givens 旋转来完成。\n\n在 $\\mathbb{R}^n$ 中，一个 Givens 旋转由一个矩阵 $G(i, j, \\theta)$ 定义，其中 $1 \\le i < j \\le n$。这个矩阵与 $n \\times n$ 的单位矩阵相同，除了四个元素之外：\n$G_{ii} = \\cos(\\theta)$\n$G_{jj} = \\cos(\\theta)$\n$G_{ij} = \\sin(\\theta)$\n$G_{ji} = -\\sin(\\theta)$\n对于某个角度 $\\theta \\in [0, 2\\pi)$。将这个矩阵应用于一个向量，相当于在由基向量 $e_i$ 和 $e_j$ 张成的平面中进行旋转。\n\n一个包含 $k$ 次旋转的序列将 $x$ 变换为 $y$，如下所示：\n$$y = G_k G_{k-1} \\cdots G_1 x$$\n其中每个 $G_m$ 都是一个形如 $G(i_m, j_m, \\theta_m)$ 的 Givens 旋转矩阵。\n\n考虑一个任意的非零向量 $x \\in \\mathbb{R}^n$，要保证最终得到的向量 $y$ 与 $e_1$ 平行，所需的最少 Givens 旋转次数是多少？在每一步中，旋转平面和旋转角度的选择都可以由你决定。请用 $n$ 的函数来表示你的答案。", "solution": "问题要求将任意非零向量 $x \\in \\mathbb{R}^n$ 变换为与 $e_1$ 平行的向量所需的最少 Givens 旋转次数。一个与 $e_1$ 平行的向量必须具有 $(\\alpha, 0, 0, \\dots, 0)^T$ 的形式，其中 $\\alpha$ 是某个标量。这意味着我们需要将向量的最后 $n-1$ 个分量置为零。\n\n解答包含两部分：首先，证明这个变换可以通过一定次数的旋转实现（给出最小次数的一个上界），其次，论证用更少的旋转次数是无法实现的（给出一个下界）。\n\n**第一部分：构造性方法（上界）**\n\n设初始向量为 $x = (x_1, x_2, \\dots, x_n)^T$。我们希望应用一系列 Givens 旋转，使分量 $x_2, x_3, \\dots, x_n$ 等于零。我们可以通过每次消除一个分量来系统地完成这个任务。一个策略性的方法是，从后往前（即 $x_n, x_{n-1}, \\dots, x_2$）依次将分量置零，使用的旋转是在包含第一个分量的平面中进行的。\n\n1.  **将第 $n$ 个分量置零：**\n    我们使用 $(1, n)$-平面上的一个 Givens 旋转, $G_1 = G(1, n, \\theta_1)$。令 $x^{(1)} = G_1 x$。这次旋转只影响 $x$ 的第 1 个和第 $n$ 个分量。其他分量保持不变。新的第 1 个和第 $n$ 个分量与旧分量的关系如下：\n    $$\n    \\begin{pmatrix} x^{(1)}_1 \\\\ x^{(1)}_n \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta_1 & \\sin\\theta_1 \\\\ -\\sin\\theta_1 & \\cos\\theta_1 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_n \\end{pmatrix}\n    $$\n    我们希望选择 $\\theta_1$ 使得 $x^{(1)}_n = 0$。这要求 $-x_1 \\sin\\theta_1 + x_n \\cos\\theta_1 = 0$。\n    如果 $x_1$ 和 $x_n$ 不全为零，我们总能找到这样的 $\\theta_1$。例如，我们可以设 $\\cos\\theta_1 = \\frac{x_1}{r}$ 和 $\\sin\\theta_1 = \\frac{x_n}{r}$，其中 $r = \\sqrt{x_1^2 + x_n^2}$。如果 $r=0$，则 $x_1=x_n=0$，此时第 $n$ 个分量已经为零，所以不需要旋转（或者我们可以使用 $\\theta_1=0$）。通过这样选择 $\\theta_1$，我们得到 $x^{(1)}_n = 0$。\n    因此，经过一次旋转后，我们得到向量 $x^{(1)} = (x_1', x_2, x_3, \\dots, x_{n-1}, 0)^T$。\n\n2.  **将第 $(n-1)$ 个分量置零：**\n    现在，我们对向量 $x^{(1)}$ 应用第二次 Givens 旋转， $G_2 = G(1, n-1, \\theta_2)$。令 $x^{(2)} = G_2 x^{(1)}$。这次旋转只影响 $x^{(1)}$ 的第 1 个和第 $(n-1)$ 个分量。关键是，它不影响第 $n$ 个分量，因为该分量已经为零。我们选择 $\\theta_2$ 以使 $x^{(2)}$ 的新第 $(n-1)$ 个分量为零。\n    经过这第二次旋转后，向量的形式变为 $x^{(2)} = (x_1'', x_2, \\dots, x_{n-2}, 0, 0)^T$。\n\n3.  **一般步骤：**\n    我们继续这个过程。为了将第 $j$ 个分量置零（对于 $j = n, n-1, \\dots, 2$），我们对当前向量应用一个 Givens 旋转 $G(1, j, \\theta)$。每次这样的旋转都被选择用来将第 $j$ 个分量置零，并且它只修改第 1 个和第 $j$ 个分量，而保持所有其他分量（包括那些已经被置为零的分量）不变。\n\n要将索引从 2 到 $n$ 的分量置零，我们需要对 $j = n, n-1, \\dots, 2$ 执行此操作。这总共有 $n-1$ 个分量。因此，一个包含 $n-1$ 次 Givens 旋转的序列足以将任何向量 $x$ 变换成所需形式。这证明了最小次数至多为 $n-1$。\n\n**第二部分：最小性论证（下界）**\n\n现在我们必须论证，用少于 $n-1$ 次的旋转是无法保证完成这一变换的。我们来考虑一个泛型向量 $x \\in \\mathbb{R}^n$，其所有分量 $x_i$ 都是非零的。目标向量 $y = (\\alpha, 0, \\dots, 0)^T$ 有 $n-1$ 个零分量。我们的起始向量没有零分量。所以我们需要引入 $n-1$ 个零。\n\n我们来分析单次 Givens 旋转 $G(i, j, \\theta)$ 对一个向量 $v$ 的影响。令 $w = G(i, j, \\theta)v$。\n$w$ 的分量对于 $k \\notin \\{i, j\\}$ 满足 $w_k = v_k$。这意味着如果对于这样的 $k$ 有 $v_k \\neq 0$，那么 $w_k$ 也非零。除了位置 $i$ 和 $j$ 之外，无法在其他位置产生新的零。\n\n$w_i$ 和 $w_j$ 分量由下式给出：\n$$\nw_i = v_i \\cos\\theta + v_j \\sin\\theta\n$$\n$$\nw_j = -v_i \\sin\\theta + v_j \\cos\\theta\n$$\n我们能一次性产生两个零吗，即是否可能 $w_i = w_j = 0$？用矩阵形式表示，这是 $\\begin{pmatrix} \\cos\\theta & \\sin\\theta \\\\ -\\sin\\theta & \\cos\\theta \\end{pmatrix} \\begin{pmatrix} v_i \\\\ v_j \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。由于旋转矩阵是可逆的（其行列式为 1），这个方程成立当且仅当 $v_i = 0$ 且 $v_j = 0$。然而，我们考虑的是从非零分量开始的情况。因此，如果 $v_i, v_j$ 中至少有一个非零，我们就不可能使 $w_i$ 和 $w_j$ 同时为零。\n\n这意味着一次 Givens 旋转最多能使向量中零分量的数量增加一个。\n要将一个没有零分量的泛型向量变换为一个有 $n-1$ 个零分量的向量，我们需要将零的数量从 0 增加到 $n-1$。既然每次旋转最多能使这个计数增加一，我们至少需要 $n-1$ 次旋转。\n\n这个下界适用于“最坏情况”的场景，即一个在位置 $2, \\dots, n$ 上没有预先存在的零分量的向量。由于问题要求的是为*任意*向量*保证*完成变换的最少旋转次数，我们必须为这种最坏情况做准备。\n\n**结论**\n\n我们已经证明了 $n-1$ 次旋转是足够的（第一部分），并且对于一个一般向量，至少需要 $n-1$ 次旋转（第二部分）。因此，所需的最少 Givens 旋转次数恰好是 $n-1$。", "answer": "$$\\boxed{n-1}$$", "id": "1365884"}, {"introduction": "最后一个练习是一个概念性检验，旨在确保你不仅掌握了计算方法，更理解了其背后的原理。通过分析一个特定的计算结果（即给定的吉文斯参数），你需要反推出原始向量所具备的特性 [@problem_id:2176468]。这种“逆向工程”式的思考方式，有助于加深你对向量几何形态与相应旋转矩阵之间内在联系的直观理解。", "problem": "在数值线性代数领域，吉文斯旋转（Givens rotations）用于选择性地在向量和矩阵中引入零元素。一名学生正在分析一个数值例程，该例程接受一个非零的二维列向量 $\\mathbf{v} = \\begin{pmatrix} a \\\\ b \\end{pmatrix}$，并为一个由下式给出的吉文斯旋转矩阵 $G$ 计算参数 $c$ 和 $s$：\n$$\nG = \\begin{pmatrix} c & s \\\\ -s & c \\end{pmatrix}\n$$\n该旋转的目的是将 $\\mathbf{v}$ 变换为一个第二个分量为零的向量。也就是说，选择参数 $c$ 和 $s$ 以满足以下条件：\n$$\nG \\mathbf{v} = \\begin{pmatrix} r \\\\ 0 \\end{pmatrix}\n$$\n其中 $r = \\sqrt{a^2 + b^2}$，并且参数还必须满足 $c^2 + s^2 = 1$。\n\n在用一个特定的非零输入向量 $\\mathbf{v}$ 测试该例程时，该学生观察到计算出的参数恰好是 $c=1$ 和 $s=0$。\n\n以下哪个陈述完全且准确地描述了会导致这个特定结果的原始向量 $\\mathbf{v} = \\begin{pmatrix} a \\\\ b \\end{pmatrix}$？\n\nA. 向量必须形如 $\\begin{pmatrix} a \\\\ 0 \\end{pmatrix}$，其中 $a$ 为任意非零实数。\n\nB. 向量必须形如 $\\begin{pmatrix} a \\\\ 0 \\end{pmatrix}$，其中 $a$ 为任意正实数。\n\nC. 向量必须是零向量 $\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\nD. 向量必须形如 $\\begin{pmatrix} 0 \\\\ b \\end{pmatrix}$，其中 $b$ 为任意非零实数。\n\nE. 向量可以是任何满足 $a=-b$ 的向量。", "solution": "给定一个非零向量 $\\mathbf{v} = \\begin{pmatrix} a \\\\ b \\end{pmatrix}$，一个吉文斯矩阵 $G = \\begin{pmatrix} c & s \\\\ -s & c \\end{pmatrix}$（其中 $c^{2} + s^{2} = 1$），以及条件\n$$\nG \\mathbf{v} = \\begin{pmatrix} r \\\\ 0 \\end{pmatrix}, \\quad r = \\sqrt{a^{2} + b^{2}}.\n$$\n观察到的参数是 $c = 1$ 和 $s = 0$。将这些值代入 $G$ 得到\n$$\nG = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}.\n$$\n因此，\n$$\nG \\mathbf{v} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} a \\\\ b \\end{pmatrix} = \\begin{pmatrix} a \\\\ b \\end{pmatrix}.\n$$\n由于这必须等于 $\\begin{pmatrix} r \\\\ 0 \\end{pmatrix}$，我们得到方程组\n$$\na = r, \\quad b = 0.\n$$\n当 $b = 0$ 时，$r$ 的定义简化为\n$$\nr = \\sqrt{a^{2} + 0} = |a|.\n$$\n从 $a = r$ 和 $r = |a|$，可得\n$$\na = |a| \\quad \\Rightarrow \\quad a \\geq 0.\n$$\n因为输入向量是非零的，所以当 $b = 0$ 时，我们不能有 $a = 0$。因此\n$$\na > 0, \\quad b = 0.\n$$\n因此，原始向量必须形如 $\\begin{pmatrix} a \\\\ 0 \\end{pmatrix}$，且 $a > 0$。这与选项 B 完全对应。选项 A、C、D 和 E 在 $c = 1$、$s = 0$、$r = \\sqrt{a^{2} + b^{2}}$ 和输入向量为非零的条件下，并不满足所有推导出的条件。", "answer": "$$\\boxed{B}$$", "id": "2176468"}]}