{"hands_on_practices": [{"introduction": "条件数是量化线性系统解对输入误差敏感性的关键概念。第一个动手实践将引导你完成计算给定矩阵条件数的基本过程，我们将使用两种常见的矩阵范数：$L_1$范数和$L_\\infty$范数。掌握这一计算是理解和诊断问题数值健康状况的第一步。[@problem_id:1379501]", "problem": "在数值线性代数中，矩阵的条件数用于衡量线性系统 $Ax=b$ 的解对输入数据 $A$ 和 $b$ 中存在的扰动的敏感程度。高条件数表示问题是病态的，意味着输入中的小相对误差可能导致输出解中的大相对误差。\n\n对于给定的矩阵范数 $\\|\\cdot\\|$，一个非奇异方阵 $A$ 的条件数定义为 $\\kappa(A) = \\|A\\| \\|A^{-1}\\|$。\n\n对于一个元素为 $m_{ij}$ 的矩阵 $M$，其 $L_1$-范数和 $L_\\infty$-范数定义如下：\n- a) $L_1$-范数，或称最大绝对列和范数：$\\|M\\|_1 = \\max_{j} \\sum_{i} |m_{ij}|$\n- b) $L_\\infty$-范数，或称最大绝对行和范数：$\\|M\\|_\\infty = \\max_{i} \\sum_{j} |m_{ij}|$\n\n考虑如下给出的非对称 $2 \\times 2$ 矩阵 $A$：\n$$\nA = \\begin{pmatrix} -2 & 1 \\\\ 5 & -10 \\end{pmatrix}\n$$\n\n计算 $A$ 关于 $L_1$-范数的条件数，记为 $\\kappa_1(A)$，以及关于 $L_\\infty$-范数的条件数，记为 $\\kappa_\\infty(A)$。\n\n将您的最终答案表示为一个有序对 $(\\kappa_1(A), \\kappa_\\infty(A))$，其中每个值都四舍五入到三位有效数字。", "solution": "我们使用关于范数 $\\|\\cdot\\|$ 的条件数定义：$\\kappa(A)=\\|A\\|\\,\\|A^{-1}\\|$。该矩阵为 $A=\\begin{pmatrix}-2 & 1 \\\\ 5 & -10\\end{pmatrix}$。\n\n首先，计算 $A$ 的 $L_{1}$-范数，即最大绝对列和：\n$$\n\\|A\\|_{1}=\\max\\left\\{|-2|+|5|,\\;|1|+|-10|\\right\\}=\\max\\{7,11\\}=11.\n$$\n\n接下来，计算 $A$ 的 $L_{\\infty}$-范数，即最大绝对行和：\n$$\n\\|A\\|_{\\infty}=\\max\\left\\{|-2|+|1|,\\;|5|+|-10|\\right\\}=\\max\\{3,15\\}=15.\n$$\n\n计算 $A^{-1}$。对于一个 $2\\times 2$ 矩阵 $A=\\begin{pmatrix}a & b \\\\ c & d\\end{pmatrix}$，$A^{-1}=\\frac{1}{ad-bc}\\begin{pmatrix}d & -b \\\\ -c & a\\end{pmatrix}$。此处 $a=-2, b=1, c=5, d=-10$，所以\n$$\n\\det(A)=ad-bc=(-2)(-10)-(1)(5)=20-5=15,\n$$\n并且\n$$\nA^{-1}=\\frac{1}{15}\\begin{pmatrix}-10 & -1 \\\\ -5 & -2\\end{pmatrix}.\n$$\n\n计算 $A^{-1}$ 的 $L_{1}$-范数：\n$$\n\\|A^{-1}\\|_{1}=\\max\\left\\{\\left|\\frac{-10}{15}\\right|+\\left|\\frac{-5}{15}\\right|,\\;\\left|\\frac{-1}{15}\\right|+\\left|\\frac{-2}{15}\\right|\\right\\}\n=\\max\\left\\{\\frac{10+5}{15},\\;\\frac{1+2}{15}\\right\\}=\\max\\left\\{1,\\;\\frac{1}{5}\\right\\}=1.\n$$\n因此，\n$$\n\\kappa_{1}(A)=\\|A\\|_{1}\\,\\|A^{-1}\\|_{1}=11\\cdot 1=11.\n$$\n\n计算 $A^{-1}$ 的 $L_{\\infty}$-范数：\n$$\n\\|A^{-1}\\|_{\\infty}=\\max\\left\\{\\left|\\frac{-10}{15}\\right|+\\left|\\frac{-1}{15}\\right|,\\;\\left|\\frac{-5}{15}\\right|+\\left|\\frac{-2}{15}\\right|\\right\\}\n=\\max\\left\\{\\frac{10+1}{15},\\;\\frac{5+2}{15}\\right\\}=\\max\\left\\{\\frac{11}{15},\\;\\frac{7}{15}\\right\\}=\\frac{11}{15}.\n$$\n因此，\n$$\n\\kappa_{\\infty}(A)=\\|A\\|_{\\infty}\\,\\|A^{-1}\\|_{\\infty}=15\\cdot \\frac{11}{15}=11.\n$$\n\n四舍五入到三位有效数字，两个值均为 $11.0$。因此，有序对 $(\\kappa_{1}(A),\\kappa_{\\infty}(A))$ 为 $(11.0,11.0)$。", "answer": "$$\\boxed{(11.0, 11.0)}$$", "id": "1379501"}, {"introduction": "学习了如何计算条件数之后，我们现在来探究一个问题是如何变得病态的。本练习提出了一个假设情景：一个微小的测量缩放误差极大地增加了系统矩阵的条件数。通过这个例子，你将直观地理解病态问题，并看到看似微不足道的变化如何使一个问题在数值上变得非常棘手。[@problem_id:1379479]", "problem": "在计算线性代数中，系统解对输入数据微小变化的敏感性是一个关键问题。这种敏感性通过条件数进行量化。考虑一个场景，其中一个线性方程组由矩阵 $A$ 建模，如下所示：\n$$ A = \\begin{pmatrix} 1 & 2 \\\\ 3 & 4 \\end{pmatrix} $$\n由于测量中的一个尺度误差，第二个方程中的系数（对应于矩阵的第二行）被无意中乘以一个非常小的因子。这导致了一个新的扰动矩阵 $A_{\\epsilon}$，其中 $A$ 的第二行被乘以常数 $\\epsilon = 1.0 \\times 10^{-6}$。\n\n一个非奇异方阵 $M$ 关于无穷范数的条件数，记作 $\\text{cond}_{\\infty}(M)$，定义为 $\\text{cond}_{\\infty}(M) = \\|M\\|_{\\infty} \\|M^{-1}\\|_{\\infty}$，其中 $\\|M\\|_{\\infty}$ 是 $M$ 的最大绝对行和。\n\n计算条件数 $\\text{cond}_{\\infty}(A_{\\epsilon})$。将最终答案四舍五入到四位有效数字。", "solution": "我们有 $A=\\begin{pmatrix}1 & 2 \\\\ 3 & 4\\end{pmatrix}$，扰动矩阵 $A_{\\epsilon}$ 是通过将第二行乘以 $\\epsilon=1.0 \\times 10^{-6}$ 得到的：\n$$\nA_{\\epsilon}=\\begin{pmatrix}1 & 2 \\\\ 3\\epsilon & 4\\epsilon\\end{pmatrix}.\n$$\n无穷范数条件数由 $\\text{cond}_{\\infty}(M)=\\|M\\|_{\\infty}\\|M^{-1}\\|_{\\infty}$ 定义，其中 $\\|M\\|_{\\infty}$ 是最大绝对行和。\n\n首先，计算 $\\|A_{\\epsilon}\\|_{\\infty}$。绝对行和为\n$$\n|1|+|2|=3,\\qquad |3\\epsilon|+|4\\epsilon|=7\\epsilon.\n$$\n因此，\n$$\n\\|A_{\\epsilon}\\|_{\\infty}=\\max\\{3,7\\epsilon\\}.\n$$\n由于 $\\epsilon=1.0\\times 10^{-6}$ 且 $7\\epsilon \\ll 3$，我们有 $\\|A_{\\epsilon}\\|_{\\infty}=3$。\n\n接下来，计算 $A_{\\epsilon}^{-1}$。对于 $2\\times 2$ 矩阵 $\\begin{pmatrix}a & b \\\\ c & d\\end{pmatrix}$，其逆为 $\\frac{1}{ad-bc}\\begin{pmatrix}d & -b \\\\ -c & a\\end{pmatrix}$。这里，$a=1$，$b=2$，$c=3\\epsilon$，$d=4\\epsilon$，所以\n$$\n\\det(A_{\\epsilon})=ad-bc=4\\epsilon-6\\epsilon=-2\\epsilon,\n$$\n且\n$$\nA_{\\epsilon}^{-1}=\\frac{1}{-2\\epsilon}\\begin{pmatrix}4\\epsilon & -2 \\\\ -3\\epsilon & 1\\end{pmatrix}\n=\\begin{pmatrix}-2 & \\frac{1}{\\epsilon} \\\\ \\frac{3}{2} & -\\frac{1}{2\\epsilon}\\end{pmatrix}.\n$$\n通过行和计算 $\\|A_{\\epsilon}^{-1}\\|_{\\infty}$：\n$$\n|-2|+\\left|\\frac{1}{\\epsilon}\\right|=2+\\frac{1}{\\epsilon},\\qquad \\left|\\frac{3}{2}\\right|+\\left|-\\frac{1}{2\\epsilon}\\right|=\\frac{3}{2}+\\frac{1}{2\\epsilon}.\n$$\n对于 $\\epsilon>0$，$2+\\frac{1}{\\epsilon}\\geq \\frac{3}{2}+\\frac{1}{2\\epsilon}$，因此\n$$\n\\|A_{\\epsilon}^{-1}\\|_{\\infty}=2+\\frac{1}{\\epsilon}.\n$$\n于是，\n$$\n\\text{cond}_{\\infty}(A_{\\epsilon})=\\|A_{\\epsilon}\\|_{\\infty}\\,\\|A_{\\epsilon}^{-1}\\|_{\\infty}=3\\left(2+\\frac{1}{\\epsilon}\\right).\n$$\n代入 $\\epsilon=1.0\\times 10^{-6}$ 得\n$$\n\\text{cond}_{\\infty}(A_{\\epsilon})=3\\left(2+1.0\\times 10^{6}\\right)=3{,}000{,}006.\n$$\n四舍五入到四位有效数字，得到 $3.000\\times 10^{6}$。", "answer": "$$\\boxed{3.000 \\times 10^{6}}$$", "id": "1379479"}, {"introduction": "算法的稳定性与问题本身的条件数同等重要。最后一个实践通过模拟在有限精度算术下求解一个病态系统，展示了算法选择的关键作用。你将比较使用和不使用部分主元法的高斯消元法，亲眼见证一个数值稳定的方法如何能够得出一个可靠的答案，而一个不稳定的方法却会失败，从而凸显出诸如主元法这类技术的实际威力。[@problem_id:1379519]", "problem": "一位数值分析师正在研究有限精度算术对求解线性方程组的影响。该分析师考虑如下系统 $A\\mathbf{x} = \\mathbf{b}$：\n$$\nA = \\begin{pmatrix} \\epsilon & 1.00 \\\\ 1.00 & 1.00 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 1.01 \\\\ 3.00 \\end{pmatrix}\n$$\n其中参数 $\\epsilon$ 是一个小数字，给定为 $\\epsilon = 1.00 \\times 10^{-4}$。\n\n该分析师使用一个简化的计算机模型，该模型使用**带四舍五入的三位有效数字浮点运算**来执行所有算术运算（加法、减法、乘法和除法）。这意味着每次运算后，结果都会四舍五入到三位有效数字。例如，计算结果为 $2.458$ 将被存储为 $2.46$，而结果为 $0.07891$ 将被存储为 $0.0789$。\n\n您的任务是在这些算术约束下，比较求解该系统的两种方法。\n\n首先，使用高斯消去法**不带部分主元法**求解该系统。设计算出的解向量为 $\\mathbf{x}_{\\text{no-pivot}} = (x_{1, \\text{np}}, x_{2, \\text{np}})^T$。\n\n其次，使用高斯消去法**带部分主元法**求解同一系统。在此方法中，每次消元步骤之前，都会交换行以确保主元（用于消元的对角元素）在其所在列中尚未处理的行中具有最大绝对值。设此计算出的解向量为 $\\mathbf{x}_{\\text{pivot}} = (x_{1, \\text{p}}, x_{2, \\text{p}})^T$。\n\n最后，计算两个计算解之间差值的欧几里得范数（$L_2$ 范数）：$\\|\\mathbf{x}_{\\text{pivot}} - \\mathbf{x}_{\\text{no-pivot}}\\|_2$。\n\n将您的最终答案四舍五入到三位有效数字。", "solution": "我们需要使用三位有效数字浮点运算以两种方式求解线性系统 $A\\mathbf{x} = \\mathbf{b}$，然后求出两个解之间差值的欧几里得范数。该系统由 $\\epsilon = 1.00 \\times 10^{-4}$ 定义：\n$$\n\\begin{pmatrix} 1.00 \\times 10^{-4} & 1.00 \\\\ 1.00 & 1.00 \\end{pmatrix}\n\\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}\n=\n\\begin{pmatrix} 1.01 \\\\ 3.00 \\end{pmatrix}\n$$\n\n**第一部分：使用不带部分主元法的高斯消去法求解**\n\n我们从增广矩阵 $[A|\\mathbf{b}]$ 开始：\n$$\n\\left[\n\\begin{array}{cc|c}\n1.00 \\times 10^{-4} & 1.00 & 1.01 \\\\\n1.00 & 1.00 & 3.00\n\\end{array}\n\\right]\n$$\n目标是消去第二行第一列的元素。主元是 $a_{11} = 1.00 \\times 10^{-4}$。我们计算第二行的乘数：\n$$\nm_{21} = \\frac{a_{21}}{a_{11}} = \\frac{1.00}{1.00 \\times 10^{-4}} = 1.00 \\times 10^{4}\n$$\n在我们的三位有效数字算术中，这个计算是精确的。现在我们执行行变换 $R_2 \\leftarrow R_2 - m_{21} R_1$。我们必须将第二行中的每个新元素四舍五入到三位有效数字。\n\n新元素 $a'_{22}$ 是：\n$$\na'_{22} = a_{22} - m_{21} \\times a_{12} = 1.00 - (1.00 \\times 10^{4}) \\times 1.00 = 1.00 - 10000 = -9999\n$$\n四舍五入到三位有效数字，我们得到 $a'_{22} = -1.00 \\times 10^{4}$。\n\n新元素 $b'_{2}$ 是：\n$$\nb'_{2} = b_2 - m_{21} \\times b_1 = 3.00 - (1.00 \\times 10^{4}) \\times 1.01 = 3.00 - 10100 = -10097\n$$\n四舍五入到三位有效数字，我们得到 $b'_{2} = -1.01 \\times 10^{4}$。\n\n增广矩阵变为：\n$$\n\\left[\n\\begin{array}{cc|c}\n1.00 \\times 10^{-4} & 1.00 & 1.01 \\\\\n0 & -1.00 \\times 10^{4} & -1.01 \\times 10^{4}\n\\end{array}\n\\right]\n$$\n现在我们执行回代。从第二行得到：\n$$\n(-1.00 \\times 10^{4}) x_{2, \\text{np}} = -1.01 \\times 10^{4}\n$$\n$$\nx_{2, \\text{np}} = \\frac{-1.01 \\times 10^{4}}{-1.00 \\times 10^{4}} = 1.01\n$$\n在三位有效数字算术中，这是精确的。现在，使用第一行：\n$$\n(1.00 \\times 10^{-4}) x_{1, \\text{np}} + 1.00 \\times x_{2, \\text{np}} = 1.01\n$$\n$$\n(1.00 \\times 10^{-4}) x_{1, \\text{np}} + 1.00 \\times 1.01 = 1.01\n$$\n项 $1.00 \\times 1.01$ 的结果是 $1.01$（在三位有效数字算术中是精确的）。\n$$\n(1.00 \\times 10^{-4}) x_{1, \\text{np}} + 1.01 = 1.01\n$$\n$$\n(1.00 \\times 10^{-4}) x_{1, \\text{np}} = 1.01 - 1.01 = 0\n$$\n因此，$x_{1, \\text{np}} = 0$。不带主元法的解是 $\\mathbf{x}_{\\text{no-pivot}} = \\begin{pmatrix} 0 \\\\ 1.01 \\end{pmatrix}$。\n\n**第二部分：使用带部分主元法的高斯消去法求解**\n\n我们再次从增广矩阵开始：\n$$\n\\left[\n\\begin{array}{cc|c}\n1.00 \\times 10^{-4} & 1.00 & 1.01 \\\\\n1.00 & 1.00 & 3.00\n\\end{array}\n\\right]\n$$\n对于部分主元法，我们比较第一列中元素的绝对值：$|a_{11}| = 1.00 \\times 10^{-4}$ 和 $|a_{21}| = 1.00$。由于 $|a_{21}| > |a_{11}|$，我们交换第1行和第2行。\n$$\n\\left[\n\\begin{array}{cc|c}\n1.00 & 1.00 & 3.00 \\\\\n1.00 \\times 10^{-4} & 1.00 & 1.01\n\\end{array}\n\\right]\n$$\n现在主元是 $a_{11} = 1.00$。我们计算乘数：\n$$\nm_{21} = \\frac{a_{21}}{a_{11}} = \\frac{1.00 \\times 10^{-4}}{1.00} = 1.00 \\times 10^{-4}\n$$\n我们执行行变换 $R_2 \\leftarrow R_2 - m_{21} R_1$。\n新元素 $a'_{22}$ 是：\n$$\na'_{22} = a_{22} - m_{21} \\times a_{12} = 1.00 - (1.00 \\times 10^{-4}) \\times 1.00 = 1.00 - 0.0001 = 0.9999\n$$\n四舍五入到三位有效数字，我们得到 $a'_{22} = 1.00$。\n\n新元素 $b'_{2}$ 是：\n$$\nb'_{2} = b_2 - m_{21} \\times b_1 = 1.01 - (1.00 \\times 10^{-4}) \\times 3.00 = 1.01 - 0.0003 = 1.0097\n$$\n四舍五入到三位有效数字，我们得到 $b'_{2} = 1.01$。\n\n增广矩阵变为：\n$$\n\\left[\n\\begin{array}{cc|c}\n1.00 & 1.00 & 3.00 \\\\\n0 & 1.00 & 1.01\n\\end{array}\n\\right]\n$$\n现在我们执行回代。从第二行得到：\n$$\n1.00 \\times x_{2, \\text{p}} = 1.01 \\implies x_{2, \\text{p}} = 1.01\n$$\n从第一行得到：\n$$\n1.00 \\times x_{1, \\text{p}} + 1.00 \\times x_{2, \\text{p}} = 3.00\n$$\n$$\n1.00 \\times x_{1, \\text{p}} + 1.00 \\times 1.01 = 3.00\n$$\n$$\n1.00 \\times x_{1, \\text{p}} + 1.01 = 3.00\n$$\n$$\n1.00 \\times x_{1, \\text{p}} = 3.00 - 1.01 = 1.99\n$$\n因此，$x_{1, \\text{p}} = 1.99$。带主元法的解是 $\\mathbf{x}_{\\text{pivot}} = \\begin{pmatrix} 1.99 \\\\ 1.01 \\end{pmatrix}$。\n\n**第三部分：差值的欧几里得范数**\n\n我们需要计算 $\\|\\mathbf{x}_{\\text{pivot}} - \\mathbf{x}_{\\text{no-pivot}}\\|_2$。\n首先，求出差向量：\n$$\n\\mathbf{d} = \\mathbf{x}_{\\text{pivot}} - \\mathbf{x}_{\\text{no-pivot}} = \\begin{pmatrix} 1.99 \\\\ 1.01 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1.01 \\end{pmatrix} = \\begin{pmatrix} 1.99 - 0 \\\\ 1.01 - 1.01 \\end{pmatrix} = \\begin{pmatrix} 1.99 \\\\ 0 \\end{pmatrix}\n$$\n现在，计算 $\\mathbf{d}$ 的欧几里得范数：\n$$\n\\|\\mathbf{d}\\|_2 = \\sqrt{(1.99)^2 + (0)^2} = \\sqrt{(1.99)^2} = 1.99\n$$\n结果 $1.99$ 已经是三位有效数字。", "answer": "$$\\boxed{1.99}$$", "id": "1379519"}]}