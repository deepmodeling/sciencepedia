{"hands_on_practices": [{"introduction": "理解一个算法最好的方式就是亲手计算一遍。这个练习将引导您完整地执行 Lanczos 算法的前两步迭代，通过这个过程，您将熟悉其核心机制：向量归一化、矩阵向量乘积、正交化以及三对角矩阵 $T_k$ 的构建。通过手动计算，您可以更直观地感受 Lanczos 向量和三对角矩阵是如何一步步生成的，从而为理解更复杂的理论知识打下坚实的基础。[@problem_id:1371132]", "problem": "兰佐斯算法是数值线性代数中一种强大的迭代方法，尤其用于寻找大型对称矩阵的特征值。当应用于一个 $n \\times n$ 的对称矩阵 $A$ 和一个起始向量 $b$ 时，该算法会构建一系列构成克雷洛夫子空间基的标准正交向量，并同时建立一个对称三对角矩阵 $T$，该矩阵的特征值近似于 $A$ 的特征值。\n\n考虑如下所示的 $3 \\times 3$ 实对称矩阵 $A$ 和起始向量 $b$：\n$$ A = \\begin{pmatrix} 4 & 1 & 1 \\\\ 1 & 2 & 3 \\\\ 1 & 3 & 5 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n令 $T_2$ 为对矩阵 $A$ 和起始向量 $b$ 应用兰佐斯算法，经过两次完整迭代后生成的 $2 \\times 2$ 对称三对角矩阵。你的任务是计算矩阵 $T_2$。", "solution": "我们对一个实对称矩阵应用标准的兰佐斯迭代法，初始向量需归一化为单位长度。令 $v_{1} = \\frac{b}{\\|b\\|}$，$\\beta_{0} = 0$，且对于 $j \\geq 1$：\n$$\nw_{j} = A v_{j} - \\beta_{j-1} v_{j-1}, \\quad \\alpha_{j} = v_{j}^{T} w_{j}, \\quad w_{j} \\leftarrow w_{j} - \\alpha_{j} v_{j}, \\quad \\beta_{j} = \\|w_{j}\\|, \\quad v_{j+1} = \\frac{w_{j}}{\\beta_{j}}.\n$$\n经过两次迭代后得到的 $2 \\times 2$ 三对角矩阵为\n$$\nT_{2} = \\begin{pmatrix} \\alpha_{1} & \\beta_{1} \\\\ \\beta_{1} & \\alpha_{2} \\end{pmatrix}.\n$$\n\n给定 $b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$，我们有 $\\|b\\| = 1$，因此\n$$\nv_{1} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}.\n$$\n第一次迭代：\n$$\nw_{1} = A v_{1} = \\begin{pmatrix} 4 \\\\ 1 \\\\ 1 \\end{pmatrix}, \\quad \\alpha_{1} = v_{1}^{T} w_{1} = 4,\n$$\n$$\nw_{1} \\leftarrow w_{1} - \\alpha_{1} v_{1} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}, \\quad \\beta_{1} = \\|w_{1}\\| = \\sqrt{0^{2} + 1^{2} + 1^{2}} = \\sqrt{2},\n$$\n$$\nv_{2} = \\frac{w_{1}}{\\beta_{1}} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}.\n$$\n\n第二次迭代：\n$$\nA v_{2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 2 \\\\ 5 \\\\ 8 \\end{pmatrix}, \\quad w_{2} = A v_{2} - \\beta_{1} v_{1} = \\begin{pmatrix} 0 \\\\ \\frac{5}{\\sqrt{2}} \\\\ \\frac{8}{\\sqrt{2}} \\end{pmatrix},\n$$\n$$\n\\alpha_{2} = v_{2}^{T} w_{2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 0 & 1 & 1 \\end{pmatrix} \\cdot \\begin{pmatrix} 0 \\\\ \\frac{5}{\\sqrt{2}} \\\\ \\frac{8}{\\sqrt{2}} \\end{pmatrix} = \\frac{13}{2}.\n$$\n\n因此，\n$$\nT_{2} = \\begin{pmatrix} \\alpha_{1} & \\beta_{1} \\\\ \\beta_{1} & \\alpha_{2} \\end{pmatrix} = \\begin{pmatrix} 4 & \\sqrt{2} \\\\ \\sqrt{2} & \\frac{13}{2} \\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} 4 & \\sqrt{2} \\\\ \\sqrt{2} & \\frac{13}{2} \\end{pmatrix}}$$", "id": "1371132"}, {"introduction": "在掌握了基本计算之后，探索算法在特殊情况下的行为可以带来深刻的洞见。本练习探讨了一个重要的思想实验：如果 Lanczos 算法的初始向量恰好是矩阵的一个特征向量，会发生什么？分析这个特殊情况将揭示 Lanczos 算法、Krylov 子空间和不变子空间之间的根本联系，并阐明算法提前终止的条件。[@problem_id:1371167]", "problem": "设 $A$ 是一个实对称 $n \\times n$ 矩阵，设 $b$ 是 $\\mathbb{R}^n$ 中的一个非零向量。已知 $b$ 是 $A$ 的一个特征向量，对应于实特征值 $\\lambda$。将 Lanczos 算法应用于矩阵 $A$，初始向量为 $b$。该算法流程如下：\n\n1.  初始化：令 $q_1 = b / \\|b\\|_2$，$\\beta_0 = 0$ 且 $q_0 = \\vec{0}$ (零向量)。\n2.  对于 $j = 1, 2, \\dots$：\n    a. 计算 $v_j = A q_j$。\n    b. 计算对角元素 $\\alpha_j = q_j^T v_j$。\n    c. 计算残差向量 $w_j = v_j - \\alpha_j q_j - \\beta_{j-1} q_{j-1}$。\n    d. 计算非对角元素 $\\beta_j = \\|w_j\\|_2$。\n    e. 如果 $\\beta_j = 0$，算法终止。令 $m=j$。\n    f. 否则，计算下一个向量 $q_{j+1} = w_j / \\beta_j$。\n\n该算法生成一个 $m \\times m$ 的对称三对角矩阵 $T_m$，其对角线元素为 $\\alpha_1, \\dots, \\alpha_m$，非对角线元素为 $\\beta_1, \\dots, \\beta_{m-1}$。\n\n下列哪个陈述正确描述了此过程的结果？\n\nA. 算法会运行 $m=n$ 次迭代，因为 Krylov 子空间的维数总是 $n$。\nB. 算法在一次迭代后终止 ($m=1$)，并且生成的矩阵是 $1 \\times 1$ 矩阵 $T_1 = [\\lambda]$。\nC. 算法在一次迭代后终止 ($m=1$)，并且生成的矩阵是 $1 \\times 1$ 矩阵 $T_1 = [1]$。\nD. 算法在第一步就失败了，因为计算 $q_1$ 涉及除以零。\nE. 算法会无限运行，因为使用特征向量作为初始向量会产生一个循环。", "solution": "问题要求确定当初始向量是矩阵的特征向量时，Lanczos 算法的行为。让我们根据给定信息追踪算法的步骤。\n\n我们给定一个对称矩阵 $A$，一个非零向量 $b$ 和一个标量 $\\lambda$，使得 $A b = \\lambda b$。\n\n**第1步：初始化**\n算法开始时初始化第一个向量 $q_1$。\n$$q_1 = \\frac{b}{\\|b\\|_2}$$\n由于 $b$ 是一个非零向量，$\\|b\\|_2 \\neq 0$，因此 $q_1$ 是良定义的。$q_1$ 是一个与 $b$ 平行的单位向量。\n我们还有 $\\beta_0 = 0$ 和 $q_0 = \\vec{0}$。\n\n**第2步：第一次迭代 ($j=1$)**\n现在我们进行循环的第一次迭代。\n\na. 计算 $v_1 = A q_1$。\n由于 $q_1$ 是特征向量 $b$ 的标量倍数，所以 $q_1$ 也是 $A$ 的一个特征向量，对应于相同的特征值 $\\lambda$。\n$$A q_1 = A \\left(\\frac{b}{\\|b\\|_2}\\right) = \\frac{1}{\\|b\\|_2} (A b) = \\frac{1}{\\|b\\|_2} (\\lambda b) = \\lambda \\left(\\frac{b}{\\|b\\|_2}\\right) = \\lambda q_1$$\n所以，$v_1 = \\lambda q_1$。\n\nb. 计算 $\\alpha_1 = q_1^T v_1$。\n代入 $v_1$ 的表达式：\n$$\\alpha_1 = q_1^T (\\lambda q_1) = \\lambda (q_1^T q_1)$$\n因为 $q_1$ 是一个单位向量，所以 $q_1^T q_1 = \\|q_1\\|_2^2 = 1$。\n因此，$\\alpha_1 = \\lambda$。\n\nc. 计算残差向量 $w_1 = v_1 - \\alpha_1 q_1 - \\beta_0 q_0$。\n使用我们已经求得的值：\n$$w_1 = (\\lambda q_1) - (\\lambda) q_1 - (0) \\vec{0} = \\lambda q_1 - \\lambda q_1 - \\vec{0} = \\vec{0}$$\n残差向量是零向量。\n\nd. 计算 $\\beta_1 = \\|w_1\\|_2$。\n$$\\beta_1 = \\|\\vec{0}\\|_2 = 0$$\n\ne. 检查终止条件。\n终止条件是 $\\beta_j = 0$。由于我们发现 $\\beta_1 = 0$，算法在这一步终止。迭代次数为 $m=1$。\n\n算法的输出是 $m \\times m$ 的三对角矩阵 $T_m$。在这种情况下，$m=1$，所以我们得到一个 $1 \\times 1$ 的矩阵 $T_1$。$T_m$ 的一般形式在对角线上有 $\\alpha_j$ 值。对于 $m=1$，矩阵就是：\n$$T_1 = [\\alpha_1]$$\n我们发现 $\\alpha_1 = \\lambda$。因此，结果矩阵是 $T_1 = [\\lambda]$。\n\n现在，我们来评估给定的选项：\nA. 算法会运行 $m=n$ 次迭代，因为 Krylov 子空间的维数总是 $n$。这是错误的。算法在 $m=1$ 次迭代后就终止了。Krylov 子空间 $\\mathcal{K}_1(A, b) = \\text{span}\\{b\\}$ 是一维的。\nB. 算法在一次迭代后终止 ($m=1$)，并且生成的矩阵是 $1 \\times 1$ 矩阵 $T_1 = [\\lambda]$。这正是我们所发现的。\nC. 算法在一次迭代后终止 ($m=1$)，并且生成的矩阵是 $1 \\times 1$ 矩阵 $T_1 = [1]$。这是错误的；矩阵元素是特征值 $\\lambda$，它不一定是 1。\nD. 算法在第一步就失败了，因为计算 $q_1$ 涉及除以零。这是错误的。问题说明 $b$ 是一个非零向量，所以其范数 $\\|b\\|_2$ 非零。\nE. 算法会无限运行，因为使用特征向量作为初始向量会产生一个循环。这是错误的。Lanczos 算法保证在至多 $n$ 步内终止。我们已经证明，在这种情况下，它在一步后就终止了。\n\n因此，唯一正确的陈述是 B。", "answer": "$$\\boxed{B}$$", "id": "1371167"}, {"introduction": "除了基本应用，我们还需要了解如何巧妙地运用算法来解决特定问题。在实际应用中，我们常常更关心矩阵谱中特定区域的特征值，而不是最大的那几个。这个练习将探讨一种被称为“谱平移”的简单变换如何影响 Lanczos 算法的输出。理解平移后的矩阵 $A - \\sigma I$ 所产生的三对角矩阵与原矩阵 $A$ 的三对角矩阵之间的关系，是掌握如“位移求逆 Lanczos 方法”等高级技巧的关键一步。[@problem_id:1371119]", "problem": "Lanczos算法是一种迭代方法，用于求解大型对称矩阵的特征值和特征向量。对于给定的实对称 $n \\times n$ 矩阵 $A$ 和满足 $\\|v_1\\|_2 = 1$ 的初始向量 $v_1$，该算法生成一系列标准正交向量 $q_1, q_2, \\dots, q_k$（其中 $q_1 = v_1$），这些向量构成了Krylov子空间的一个基。这些向量满足以下三项递推关系：\n$$A q_j = \\beta_{j-1} q_{j-1} + \\alpha_j q_j + \\beta_j q_{j+1}$$\n其中 $j=1, \\dots, k$，且 $q_0 = 0$ 和 $\\beta_0 = 0$。系数 $\\alpha_j = q_j^T A q_j$ 构成一个 $k \\times k$ 对称三对角矩阵 $T_k$ 的对角线元素，而 $\\beta_j = \\| A q_j - \\alpha_j q_j - \\beta_{j-1} q_{j-1} \\|_2$ 构成其非对角线元素。\n\n现在，考虑对矩阵 $A$ 进行一个实常数位移 $\\sigma$ 的谱变换，得到一个新矩阵 $A' = A - \\sigma I_n$，其中 $I_n$ 是 $n \\times n$ 的单位矩阵。假设我们对矩阵 $A'$ 应用相同的Lanczos算法进行 $k$ 步迭代，使用完全相同的初始向量 $v_1$。这个新过程会生成一个新的 $k \\times k$ 对称三对角矩阵，我们称之为 $T'_k$。\n\n确定 $T'_k$ 和 $T_k$ 之间的关系。用 $T_k$、位移 $\\sigma$ 和 $k \\times k$ 单位矩阵 $I_k$ 来表示 $T'_k$。", "solution": "给定一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$，以及从 $q_{1}=v_{1}$（其中 $\\|v_{1}\\|_{2}=1$）开始的Lanczos过程，该过程生成满足以下三项递推关系的标准正交向量 $q_{j}$：\n$$\nA q_{j}=\\beta_{j-1} q_{j-1}+\\alpha_{j} q_{j}+\\beta_{j} q_{j+1}, \\quad j=1,\\dots,k,\n$$\n其中 $q_{0}=0$ 且 $\\beta_{0}=0$。三对角矩阵 $T_{k}$ 的对角线元素为 $\\alpha_{j}=q_{j}^{T} A q_{j}$，非对角线元素为 $\\beta_{j}=\\|A q_{j}-\\alpha_{j} q_{j}-\\beta_{j-1} q_{j-1}\\|_{2}$。\n\n考虑使用相同初始向量 $v_{1}$ 的位移矩阵 $A'=A-\\sigma I_{n}$。首先，Krylov子空间是相同的：\n$$\n\\mathcal{K}_{m}(A,v_{1})=\\operatorname{span}\\{v_{1},A v_{1},\\dots,A^{m-1} v_{1}\\}=\\mathcal{K}_{m}(A',v_{1}),\n$$\n因为对于每个 $m \\in \\mathbb{N}$，\n$$\n(A-\\sigma I_{n})^{m} v_{1}=\\sum_{r=0}^{m} \\binom{m}{r} (-\\sigma)^{m-r} A^{r} v_{1},\n$$\n这表明每个 $(A')^{m} v_{1}$ 都位于 $\\mathcal{K}_{m+1}(A,v_{1})$ 中，反之，根据同样的论证，$A^{m} v_{1}$ 是 $\\{(A')^{r} v_{1}\\}_{r=0}^{m}$ 的线性组合。因此，对 $A'$ 和 $v_1$ 应用Lanczos算法会产生一个标准正交基，该基在每一步都必须位于相同的子空间中。\n\n我们现在通过归纳法证明，Lanczos向量和非对角线系数保持不变，而对角线系数位移了 $-\\sigma$。\n\n为 $A$ 定义残差 $r_{j}=A q_{j}-\\alpha_{j} q_{j}-\\beta_{j-1} q_{j-1}$，因此 $\\beta_{j}=\\|r_{j}\\|_{2}$ 且 $q_{j+1}=r_{j}/\\beta_{j}$。为 $A'$ 定义 $\\alpha'_{j}=q_{j}^{T} A' q_{j}$，$\\beta'_{j}=\\|A' q_{j}-\\alpha'_{j} q_{j}-\\beta'_{j-1} q_{j-1}\\|_{2}$ 和 $r'_{j}=A' q_{j}-\\alpha'_{j} q_{j}-\\beta'_{j-1} q_{j-1}$。\n\n基础步骤 $j=1$：由于 $q_{1}$ 是单位范数，\n$$\n\\alpha'_{1}=q_{1}^{T} A' q_{1}=q_{1}^{T} (A-\\sigma I_{n}) q_{1}=q_{1}^{T} A q_{1}-\\sigma=\\alpha_{1}-\\sigma.\n$$\n并且，\n$$\nr'_{1}=A' q_{1}-\\alpha'_{1} q_{1}=A q_{1}-\\sigma q_{1}-(\\alpha_{1}-\\sigma) q_{1}=A q_{1}-\\alpha_{1} q_{1}=r_{1},\n$$\n所以 $\\beta'_{1}=\\|r'_{1}\\|_{2}=\\|r_{1}\\|_{2}=\\beta_{1}$ 且 $q_{2}'=r'_{1}/\\beta'_{1}=r_{1}/\\beta_{1}=q_{2}$。\n\n归纳步骤：假设对于某个 $j \\geq 2$，$q_{j-1}$ 和 $q_{j}$ 对于 $A$ 和 $A'$ 是相同的，并且 $\\beta'_{j-1}=\\beta_{j-1}$。那么\n$$\n\\alpha'_{j}=q_{j}^{T} A' q_{j}=q_{j}^{T} (A-\\sigma I_{n}) q_{j}=q_{j}^{T} A q_{j}-\\sigma=\\alpha_{j}-\\sigma,\n$$\n并且\n$$\n\\begin{aligned}\nr'_{j}&=A' q_{j}-\\alpha'_{j} q_{j}-\\beta'_{j-1} q_{j-1}\\\\\n&=(A-\\sigma I_{n}) q_{j}-(\\alpha_{j}-\\sigma) q_{j}-\\beta_{j-1} q_{j-1}\\\\\n&=A q_{j}-\\alpha_{j} q_{j}-\\beta_{j-1} q_{j-1}=r_{j}.\n\\end{aligned}\n$$\n因此 $\\beta'_{j}=\\|r'_{j}\\|_{2}=\\|r_{j}\\|_{2}=\\beta_{j}$ 且 $q'_{j+1}=r'_{j}/\\beta'_{j}=r_{j}/\\beta_{j}=q_{j+1}$。归纳完毕。\n\n因此，Lanczos基 $q_{1},\\dots,q_{k}$ 和非对角线元素 $\\beta_{j}$ 保持不变，而对角线元素发生位移：$\\alpha'_{j}=\\alpha_{j}-\\sigma$。因此，三对角矩阵满足\n$$\nT'_{k}=T_{k}-\\sigma I_{k}.\n$$\n\n一个等价的紧凑推导使用Lanczos分解 $A Q_{k}=Q_{k} T_{k}+\\beta_{k} q_{k+1} e_{k}^{T}$，其中 $Q_{k}=[q_{1}\\ \\dots\\ q_{k}]$。那么\n$$\nA' Q_{k}=(A-\\sigma I_{n}) Q_{k}=A Q_{k}-\\sigma Q_{k}=Q_{k} (T_{k}-\\sigma I_{k})+\\beta_{k} q_{k+1} e_{k}^{T}.\n$$\n根据 $A'$ 的Lanczos关系中三对角投影的唯一性，这证实了 $T'_{k}=T_{k}-\\sigma I_{k}$。", "answer": "$$\\boxed{T'_{k}=T_{k}-\\sigma I_{k}}$$", "id": "1371119"}]}