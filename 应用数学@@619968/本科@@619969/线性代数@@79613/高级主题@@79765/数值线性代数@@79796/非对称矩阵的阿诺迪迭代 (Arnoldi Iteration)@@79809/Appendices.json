{"hands_on_practices": [{"introduction": "掌握任何算法的第一步都是理解其核心机制。本练习旨在引导您完成 Arnoldi 迭代中最基本的一步，即从一个给定的向量开始，计算出下一个正交基向量以及相应的 Hessenberg 矩阵元素。通过这个具体的计算，您将熟悉向量投影和正交化等关键操作，为理解更复杂的应用奠定坚实的基础 [@problem_id:1349109]。", "problem": "阿诺尔迪迭代（Arnoldi iteration）是一种算法，用于构建由矩阵 $A$ 和向量 $b$ 生成的克雷洛夫子空间（Krylov subspace）的一个标准正交基。这一过程在数值线性代数中是基础性的，尤其适用于逼近大型非对称矩阵的特征值。\n\n考虑由下式给出的非对称矩阵 $A$ 和向量 $b$：\n$$\nA = \\begin{pmatrix} 1 & 4 \\\\ 2 & 3 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}\n$$\n阿诺尔迪迭代的第一步始于归一化向量 $q_1 = \\frac{b}{\\|b\\|_2}$，其中 $\\| \\cdot \\|_2$ 表示欧几里得范数。\n\n您的任务是执行一步完整的阿诺尔迪迭代，以计算第二个阿诺尔迪向量 $q_2$，以及相关的上海森堡矩阵 $H$ 的第一列。此列的元素记为 $h_{11}$ 和 $h_{21}$。\n\n令所得向量的分量为 $q_2 = \\begin{pmatrix} q_{2,1} \\\\ q_{2,2} \\end{pmatrix}$。请将您的答案表示为一个包含这四个值 $[q_{2,1}, q_{2,2}, h_{11}, h_{21}]$ 的单行矩阵，并严格遵守此顺序。所有元素都需表示为最简精确分数形式。", "solution": "阿诺尔迪迭代从 $q_{1}=\\dfrac{b}{\\|b\\|_{2}}$ 开始。对于 $b=\\begin{pmatrix}3 \\\\ 4\\end{pmatrix}$，其欧几里得范数为 $\\|b\\|_{2}=\\sqrt{3^{2}+4^{2}}=5$，因此\n$$\nq_{1}=\\begin{pmatrix}\\dfrac{3}{5} \\\\ \\dfrac{4}{5}\\end{pmatrix}.\n$$\n计算 $v=Aq_{1}$：\n$$\nv=\\begin{pmatrix}1 & 4 \\\\ 2 & 3\\end{pmatrix}\\begin{pmatrix}\\dfrac{3}{5} \\\\ \\dfrac{4}{5}\\end{pmatrix}\n=\\begin{pmatrix}\\dfrac{3}{5}+ \\dfrac{16}{5} \\\\ \\dfrac{6}{5}+ \\dfrac{12}{5}\\end{pmatrix}\n=\\begin{pmatrix}\\dfrac{19}{5} \\\\ \\dfrac{18}{5}\\end{pmatrix}.\n$$\n第一个海森堡矩阵元素为 $h_{11}=q_{1}^{\\top}v$：\n$$\nh_{11}=\\begin{pmatrix}\\dfrac{3}{5} & \\dfrac{4}{5}\\end{pmatrix}\\begin{pmatrix}\\dfrac{19}{5} \\\\ \\dfrac{18}{5}\\end{pmatrix}\n=\\dfrac{57}{25}+\\dfrac{72}{25}\n=\\dfrac{129}{25}.\n$$\n构建残差 $r=v-h_{11}q_{1}$：\n$$\nh_{11}q_{1}=\\dfrac{129}{25}\\begin{pmatrix}\\dfrac{3}{5} \\\\ \\dfrac{4}{5}\\end{pmatrix}\n=\\begin{pmatrix}\\dfrac{387}{125} \\\\ \\dfrac{516}{125}\\end{pmatrix},\\quad\nr=\\begin{pmatrix}\\dfrac{19}{5} \\\\ \\dfrac{18}{5}\\end{pmatrix}-\\begin{pmatrix}\\dfrac{387}{125} \\\\ \\dfrac{516}{125}\\end{pmatrix}\n=\\begin{pmatrix}\\dfrac{88}{125} \\\\ -\\dfrac{66}{125}\\end{pmatrix}.\n$$\n次对角线上的海森堡矩阵元素为 $h_{21}=\\|r\\|_{2}$：\n$$\nh_{21}=\\sqrt{\\left(\\dfrac{88}{125}\\right)^{2}+\\left(-\\dfrac{66}{125}\\right)^{2}}\n=\\dfrac{1}{125}\\sqrt{7744+4356}\n=\\dfrac{1}{125}\\sqrt{12100}\n=\\dfrac{110}{125}\n=\\dfrac{22}{25}.\n$$\n进行归一化以得到 $q_{2}=r/h_{21}$：\n$$\nq_{2}=\\dfrac{1}{\\frac{22}{25}}\\begin{pmatrix}\\dfrac{88}{125} \\\\ -\\dfrac{66}{125}\\end{pmatrix}\n=\\begin{pmatrix}\\dfrac{88}{125}\\cdot \\dfrac{25}{22} \\\\ -\\dfrac{66}{125}\\cdot \\dfrac{25}{22}\\end{pmatrix}\n=\\begin{pmatrix}\\dfrac{4}{5} \\\\ -\\dfrac{3}{5}\\end{pmatrix}.\n$$\n因此，所求的元素为 $q_{2,1}=\\dfrac{4}{5}$，$q_{2,2}=-\\dfrac{3}{5}$，$h_{11}=\\dfrac{129}{25}$，以及 $h_{21}=\\dfrac{22}{25}$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{4}{5} & -\\frac{3}{5} & \\frac{129}{25} & \\frac{22}{25}\\end{pmatrix}}$$", "id": "1349109"}, {"introduction": "理论的美妙之处往往体现在其特殊情况中。Arnoldi 迭代在何种情况下会提前终止？这个问题将引导我们探索这一被称为“幸运”分解（lucky breakdown）的现象，它揭示了 Arnoldi 过程与矩阵特征向量之间的深刻联系。理解这种提前终止的条件，将帮助您从单纯的计算者转变为能够洞察算法背后数学原理的思考者 [@problem_id:1349095]。", "problem": "Arnoldi迭代是为Krylov子空间 $\\mathcal{K}_m(A, q_1) = \\text{span}\\{q_1, Aq_1, \\ldots, A^{m-1}q_1\\}$ 构建一个标准正交基 $\\{q_1, q_2, \\ldots, q_m\\}$ 的算法，其中 $A$ 是一个 $n \\times n$ 矩阵，而 $q_1$ 是一个单位范数的初始向量，即 $\\|q_1\\|_2 = 1$。\n\n该过程按如下步骤进行。对于 $k=1, 2, \\ldots$：\n1. 计算一个新的候选向量 $v = A q_k$。\n2. 将 $v$ 与先前已找到的基向量 $\\{q_1, \\ldots, q_k\\}$ 进行正交化，得到向量 $w$：\n   $$w = v - \\sum_{j=1}^{k} (q_j^T v) q_j$$\n3. 如果 $w$ 是零向量，则算法在第 $k$ 步终止。否则，通过将 $w$ 单位化得到下一个基向量：$q_{k+1} = w / \\|w\\|_2$。\n\n考虑一个 $2 \\times 2$ 非对称矩阵 $A$ 的情况。Arnoldi迭代从一个特定的向量 $q_1$ 开始。对于下列哪一对矩阵 $A$ 和初始向量 $q_1$，Arnoldi迭代会恰好在一步之后（即在 $k=1$ 时）终止？\n\nA. $A = \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}$, $q_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$\n\nB. $A = \\begin{pmatrix} 5 & -3 \\\\ 2 & 0 \\end{pmatrix}$, $q_1 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$\n\nC. $A = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix}$, $q_1 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$\n\nD. $A = \\begin{pmatrix} 1 & 3 \\\\ 1 & -1 \\end{pmatrix}$, $q_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$", "solution": "在Arnoldi迭代的第 $k=1$ 步，我们只有一个单位范数的基向量 $q_{1}$，我们构造 $v=Aq_{1}$ 并与 $q_{1}$ 进行正交化：\n$$\nw \\;=\\; v - (q_{1}^{T}v)\\,q_{1} \\;=\\; Aq_{1} - \\big(q_{1}^{T}Aq_{1}\\big)\\,q_{1}.\n$$\n迭代在 $k=1$ 时终止，当且仅当 $w=0$，而这当且仅当 $Aq_{1}$ 位于 $q_{1}$ 的生成空间中，即存在一个标量 $\\lambda$ 使得 $Aq_{1}=\\lambda q_{1}$。这等价于，$q_{1}$ 必须是 $A$ 的一个特征向量。\n\n我们通过计算 $Aq_{1}$ 并检查其与 $q_{1}$ 的共线性来测试每个选项。\n\nA. $A=\\begin{pmatrix}0 & -1 \\\\ 1 & 0\\end{pmatrix}$, $q_{1}=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$。那么\n$$\nv=Aq_{1}=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix},\\quad q_{1}^{T}v=\\begin{pmatrix}1 & 0\\end{pmatrix}\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}=0,\n$$\n所以\n$$\nw=v-(q_{1}^{T}v)q_{1}=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}\\neq 0.\n$$\n不终止。\n\nB. $A=\\begin{pmatrix}5 & -3 \\\\ 2 & 0\\end{pmatrix}$, $q_{1}=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$。那么\n$$\nv=Aq_{1}=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}5-3 \\\\ 2+0\\end{pmatrix}=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}2 \\\\ 2\\end{pmatrix}=2\\,\\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}=2q_{1},\n$$\n因此\n$$\nq_{1}^{T}v=2\\,q_{1}^{T}q_{1}=2,\\quad w=v-(q_{1}^{T}v)q_{1}=2q_{1}-2q_{1}=0.\n$$\n在 $k=1$ 时终止。\n\nC. $A=\\begin{pmatrix}1 & 1 \\\\ 0 & 1\\end{pmatrix}$, $q_{1}=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$。那么\n$$\nv=Aq_{1}=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix},\\quad q_{1}^{T}v=\\begin{pmatrix}0 & 1\\end{pmatrix}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}=1,\n$$\n所以\n$$\nw=v-(q_{1}^{T}v)q_{1}=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}-\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}\\neq 0.\n$$\n不终止。\n\nD. $A=\\begin{pmatrix}1 & 3 \\\\ 1 & -1\\end{pmatrix}$, $q_{1}=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$。那么\n$$\nv=Aq_{1}=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix},\\quad q_{1}^{T}v=\\begin{pmatrix}1 & 0\\end{pmatrix}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}=1,\n$$\n所以\n$$\nw=v-(q_{1}^{T}v)q_{1}=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}-\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}\\neq 0.\n$$\n不终止。\n\n因此，Arnoldi迭代仅在选项B的情况下会恰好在一步后终止。", "answer": "$$\\boxed{B}$$", "id": "1349095"}, {"introduction": "在掌握了 Arnoldi 迭代的执行步骤和特殊情况后，让我们从一个全新的视角来审视它。本练习将任务“反转”过来：给定迭代的最终产物——正交基矩阵 $Q$ 和 Hessenberg 矩阵 $H$，要求您重建出原始矩阵 $A$。这个过程不仅能巩固您对 Arnoldi 分解 $A = QHQ^T$ 的理解，更让您深刻体会到，这个迭代过程如何将一个复杂矩阵的本质信息浓缩于其生成的更简单的结构之中 [@problem_id:1349130]。", "problem": "阿诺尔迪迭代是数值线性代数中一种用于求解大型矩阵特征值近似值的算法。对于一个给定的 $n \\times n$ 矩阵 $A$ 和一个单位范数（$\\|q_1\\|=1$）的初始向量 $q_1$，该迭代过程为第 $k$ 个克雷洛夫子空间构建一个标准正交基 $\\{q_1, q_2, \\dots, q_k\\}$。当迭代运行一个完整的 $n$ 步循环时，会得到矩阵 $A$ 的阿诺尔迪分解，由方程 $A = Q_n H_n Q_n^T$ 给出。在此分解中，$Q_n = [q_1, q_2, \\dots, q_n]$ 是一个 $n \\times n$ 的正交矩阵，其列向量是生成的标准正交向量，而 $H_n$ 是一个 $n \\times n$ 的上海森伯格矩阵。根据标准算法的约定，$H_n$ 的次对角线元素（记为 $h_{j+1, j}$）被构造成实数且为正，这一条件使得对于给定的 $q_1$，基 $\\{q_1, ..., q_n\\}$ 是唯一的。\n\n假设将此过程应用于一个 $2 \\times 2$ 的实、非对称矩阵 $A$。迭代从初始向量 $q_1 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$ 开始。经过两步后，过程终止并产生 $2 \\times 2$ 的上海森伯格矩阵 $H_2 = \\begin{pmatrix} 2 & 5 \\\\ 3 & 4 \\end{pmatrix}$。\n\n确定矩阵 $A$。", "solution": "在一个二阶实矩阵的完整阿诺尔迪循环中，阿诺尔迪分解为\n$$\nA = Q_{2} H_{2} Q_{2}^{T},\n$$\n其中 $Q_{2} = [q_{1}, q_{2}]$ 是正交的，$H_{2}$ 是上海森伯格矩阵。这里有\n$$\nq_{1} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ -1\\end{pmatrix}, \\qquad\nH_{2} = \\begin{pmatrix}2 & 5 \\\\ 3 & 4\\end{pmatrix}.\n$$\n因为 $q_{2}$ 必须是与 $q_{1}$ 正交的单位向量，并且标准的阿诺尔迪约定要求 $h_{2,1}>0$，在 $\\mathbb{R}^{2}$ 中，与 $q_{1}$ 正交的单位向量只有 $\\pm \\frac{1}{\\sqrt{2}}(1,1)^{T}$ 两种可能。符号由阿诺尔迪约定固定，所以我们取\n$$\nq_{2} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}.\n$$\n因此\n$$\nQ_{2} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 & 1 \\\\ -1 & 1\\end{pmatrix}, \\qquad\nQ_{2}^{T} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 & -1 \\\\ 1 & 1\\end{pmatrix}.\n$$\n计算 $Q_{2}H_{2}$：\n$$\nQ_{2}H_{2}\n= \\frac{1}{\\sqrt{2}}\n\\begin{pmatrix}\n1 & 1 \\\\ -1 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n2 & 5 \\\\ 3 & 4\n\\end{pmatrix}\n= \\frac{1}{\\sqrt{2}}\n\\begin{pmatrix}\n1\\cdot 2 + 1\\cdot 3 & 1\\cdot 5 + 1\\cdot 4 \\\\\n-1\\cdot 2 + 1\\cdot 3 & -1\\cdot 5 + 1\\cdot 4\n\\end{pmatrix}\n= \\frac{1}{\\sqrt{2}}\n\\begin{pmatrix}\n5 & 9 \\\\ 1 & -1\n\\end{pmatrix}.\n$$\n然后\n$$\nA = (Q_{2}H_{2})Q_{2}^{T}\n= \\frac{1}{2}\n\\begin{pmatrix}\n5 & 9 \\\\ 1 & -1\n\\end{pmatrix}\n\\begin{pmatrix}\n1 & -1 \\\\ 1 & 1\n\\end{pmatrix}\n= \\frac{1}{2}\n\\begin{pmatrix}\n5\\cdot 1 + 9\\cdot 1 & 5\\cdot (-1) + 9\\cdot 1 \\\\\n1\\cdot 1 + (-1)\\cdot 1 & 1\\cdot (-1) + (-1)\\cdot 1\n\\end{pmatrix}\n= \\frac{1}{2}\n\\begin{pmatrix}\n14 & 4 \\\\ 0 & -2\n\\end{pmatrix}\n= \\begin{pmatrix}\n7 & 2 \\\\ 0 & -1\n\\end{pmatrix}.\n$$\n直接验证可得 $Q_{2}^{T}AQ_{2} = H_{2}$，从而证实了结果。", "answer": "$$\\boxed{\\begin{pmatrix}7 & 2 \\\\ 0 & -1\\end{pmatrix}}$$", "id": "1349130"}]}