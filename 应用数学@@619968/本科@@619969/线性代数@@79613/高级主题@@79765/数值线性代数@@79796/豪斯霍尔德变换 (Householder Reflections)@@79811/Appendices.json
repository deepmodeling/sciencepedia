{"hands_on_practices": [{"introduction": "我们的探索始于一个基本但至关重要的问题，它揭示了 Householder 变换的几何本质。Householder 矩阵通过一个超平面（在三维空间中是一个平面，在二维空间中是一条直线）反射向量。那么，如果一个向量本身就位于这个反射超平面内，变换会对它做什么呢？这个练习将帮助你通过简单的推导，深入理解反射超平面作为变换不动点集的关键特性。[@problem_id:18015]", "problem": "豪斯霍尔德变换（Householder transformation）是一种描述关于一个超平面的反射的线性变换。对于一个给定的非零向量 $v \\in \\mathbb{R}^n$，豪斯霍尔德矩阵 $H_v$ 定义为：\n$$H_v = I - 2 \\frac{v v^T}{v^T v}$$\n其中 $I$ 是 $n \\times n$ 的单位矩阵，$v^T$ 是列向量 $v$ 的转置，乘积 $v v^T$ 是一个外积，其结果为一个 $n \\times n$ 矩阵。项 $v^T v$ 是 $v$ 与自身的点积，它是一个标量。\n\n考虑另一个与 $v$ 正交的向量 $u \\in \\mathbb{R}^n$。正交的条件是它们的点积为零，即 $v^T u = 0$。\n\n你的任务是推导将豪斯霍尔德变换 $H_v$ 应用于向量 $u$ 所得到的向量 $w$ 的简化表达式。", "solution": "我们有豪斯霍尔德变换定义为\n$$H_v = I - 2\\,\\frac{v\\,v^T}{v^T v}\\,. $$\n将 $H_v$ 应用于向量 $u$ 得到\n$$w = H_v\\,u = \\Bigl(I - 2\\,\\frac{v\\,v^T}{v^T v}\\Bigr)\\,u = u - 2\\,\\frac{v\\,(v^T u)}{v^T v}\\,. $$\n由于 $u$ 与 $v$ 正交，我们有 $v^T u = 0$。因此\n$$w = u - 2\\,\\frac{v\\cdot 0}{v^T v} = u\\,. $$", "answer": "$$\\boxed{u}$$", "id": "18015"}, {"introduction": "在理解了反射平面上向量的行为之后，我们来处理一个更普遍的情景：反射一个不一定在反射平面内的任意向量。这个练习模拟了计算机图形学中的一个常见任务——计算一个点经过镜面反射后的位置。通过这个具体的二维空间示例，你将亲手实践如何将一个向量分解为平行和垂直于反射平面的分量，并看到 Householder 反射如何“翻转”其垂直分量。[@problem_id:1366953]", "problem": "在三维计算机图形学模拟中，一个平坦的无限大镜子由一个通过原点的平面表示。该镜子的方向由其法向量定义，法向量为 $n = [2, -1, 2]^T$。一个点状物体位于位置 $P$，其位置向量为 $p = [3, 6, 9]^T$。\n\n对点 $P$ 应用关于该镜面的反射变换，得到新点 $P'$，其位置向量为 $p'$。确定向量 $p'$ 的分量 $(p'_x, p'_y, p'_z)$。", "solution": "一个向量关于一个通过原点且法向量为 $n$ 的平面的反射，是通过将其沿 $n$ 方向的分量反向，同时保持其平行于该平面的分量不变来得到的。对于任意向量 $p$，将其分解为 $p = p_{\\parallel} + p_{\\perp}$，其中 $p_{\\perp} = \\dfrac{p \\cdot n}{n \\cdot n}\\,n$。反射会翻转 $p_{\\perp}$，得到\n$$\np' = p - 2 p_{\\perp} = p - 2 \\frac{p \\cdot n}{n \\cdot n}\\,n.\n$$\n已知 $n = \\begin{pmatrix}2\\\\-1\\\\2\\end{pmatrix}$ 和 $p = \\begin{pmatrix}3\\\\6\\\\9\\end{pmatrix}$，计算点积：\n$$\np \\cdot n = 3\\cdot 2 + 6\\cdot(-1) + 9\\cdot 2 = 6 - 6 + 18 = 18,\\qquad n \\cdot n = 2^{2} + (-1)^{2} + 2^{2} = 4 + 1 + 4 = 9.\n$$\n因此，\n$$\np' = p - 2 \\frac{18}{9} n = p - 4 n.\n$$\n计算 $p - 4n$：\n$$\np - 4n = \\begin{pmatrix}3\\\\6\\\\9\\end{pmatrix} - \\begin{pmatrix}8\\\\-4\\\\8\\end{pmatrix} = \\begin{pmatrix}-5\\\\10\\\\1\\end{pmatrix}.\n$$\n因此，$p'$ 的分量为 $(-5, 10, 1)$。", "answer": "$$\\boxed{\\begin{pmatrix}-5 & 10 & 1\\end{pmatrix}}$$", "id": "1366953"}, {"introduction": "掌握了 Householder 反射的几何直觉后，我们现在可以将其应用于其最重要的领域之一：数值线性代数。Householder 变换是实现矩阵 $QR$ 分解的强大工具，而 $QR$ 分解是许多高级算法的基石。这个练习将带你完成 $QR$ 分解过程中的关键第一步，即构造并应用一个 Householder 矩阵，将矩阵的第一列变换为只有一个非零元素的形式，从而为后续计算铺平道路。[@problem_id:17992]", "problem": "### 问题描述\n\n矩阵 $A$ 的QR分解是一种将矩阵分解为 $A=QR$ 的形式，其中 $Q$ 是一个正交矩阵，$R$ 是一个上三角矩阵。实现这种分解的一种方法是使用一系列豪斯霍尔德反射（Householder reflection）。\n\n豪斯霍尔德反射是一种线性变换，其变换矩阵定义为 $H = I - 2 \\frac{\\mathbf{v}\\mathbf{v}^T}{\\mathbf{v}^T\\mathbf{v}}$，其中 $\\mathbf{v}$ 是某个非零向量，$I$ 是单位矩阵。该变换将任意向量关于与 $\\mathbf{v}$ 正交的超平面进行反射。\n\n对于一个 $m \\times n$ 的矩阵 $A$ ，其QR分解的第一步是应用一个豪斯霍尔德变换 $H_1$，该变换将 $A$ 的第一列（记为 $\\mathbf{a}_1$）映射到一个与标准基向量 $\\mathbf{e}_1 = (1, 0, \\dots, 0)^T$ 成比例的向量上。这会将第一列中第一个元素下方的所有元素都变为零。\n\n所需的豪斯霍尔德矩阵为 $H_1 = I - 2 \\frac{\\mathbf{v}_1\\mathbf{v}_1^T}{\\mathbf{v}_1^T\\mathbf{v}_1}$，其中豪斯霍尔德向量 $\\mathbf{v}_1$ 的构造如下：\n$$\n\\mathbf{v}_1 = \\mathbf{a}_1 - \\alpha \\mathbf{e}_1\n$$\n标量 $\\alpha$ 由下式给出：\n$$\n\\alpha = -\\text{sgn}(a_{11})\\|\\mathbf{a}_1\\|_2\n$$\n这里，$a_{11}$是 $\\mathbf{a}_1$ 的第一个元素，$\\|\\cdot\\|_2$ 表示欧几里得范数，符号函数 $\\text{sgn}(x)$ 在 $x \\ge 0$ 时为 $1$，在 $x < 0$ 时为 $-1$。完成这第一步后，变换后的矩阵为 $A' = H_1 A$。\n\n给定矩阵：\n$$\nA = \\begin{pmatrix} 1 & 1 & 1 \\\\ 1 & 2 & 4 \\\\ 1 & 3 & 9 \\end{pmatrix}\n$$\n计算矩阵 $A' = H_1 A$ 的元素 $(A')_{2,2}$。", "solution": "我们有 $A\\in\\mathbb{R}^{3\\times3}$，其第一列为 $\\mathbf a_1=(1,1,1)^T$。我们要求解 $H_1=I-2\\frac{\\mathbf v\\mathbf v^T}{\\mathbf v^T\\mathbf v}$，其中\n$$\n\\alpha=-\\sgn(a_{11})\\|\\mathbf a_1\\|_2=-1\\cdot\\sqrt{1^2+1^2+1^2}=-\\sqrt3,\n$$\n$$\n\\mathbf v=\\mathbf a_1-\\alpha\\mathbf e_1\n=\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix}-(-\\sqrt3)\\begin{pmatrix}1\\\\0\\\\0\\end{pmatrix}\n=\\begin{pmatrix}1+\\sqrt3\\\\1\\\\1\\end{pmatrix}.\n$$\n\n接下来，设 $\\mathbf a_2=(1,2,3)^T$ 为 $A$ 的第二列。则\n$$\n\\mathbf v^T\\mathbf v=(1+\\sqrt3)^2+1^2+1^2\n=1+2\\sqrt3+3+1+1=6+2\\sqrt3,\n$$\n$$\n\\mathbf v^T\\mathbf a_2=(1+\\sqrt3)\\cdot1+1\\cdot2+1\\cdot3\n=6+\\sqrt3.\n$$\n因此\n$$\nH_1\\mathbf a_2\n=\\mathbf a_2-2\\,\\frac{\\mathbf v(\\mathbf v^T\\mathbf a_2)}{\\mathbf v^T\\mathbf v}\n=\\begin{pmatrix}1\\\\2\\\\3\\end{pmatrix}\n-2\\,\\frac{6+\\sqrt3}{6+2\\sqrt3}\\begin{pmatrix}1+\\sqrt3\\\\1\\\\1\\end{pmatrix}.\n$$\n简化标量：\n$$\n2\\,\\frac{6+\\sqrt3}{6+2\\sqrt3}\n=\\frac{12+2\\sqrt3}{6+2\\sqrt3}\n=\\frac{6+\\sqrt3}{3+\\sqrt3}\n=\\frac{(6+\\sqrt3)(3-\\sqrt3)}{6}\n=\\frac{15-3\\sqrt3}{6}\n=\\frac{5-\\sqrt3}{2}.\n$$\n因此\n$$\n(H_1\\mathbf a_2)_2\n=2-\\frac{5-\\sqrt3}{2}\\cdot1\n=\\frac{4-(5-\\sqrt3)}{2}\n=\\frac{\\sqrt3-1}{2}.\n$$\n所以，矩阵 $A'=H_1A$ 的 $(2,2)$ 元素是 $\\displaystyle\\frac{\\sqrt3-1}{2}$。", "answer": "$$\\boxed{\\frac{\\sqrt3-1}{2}}$$", "id": "17992"}]}