{"hands_on_practices": [{"introduction": "奇异值分解 (SVD) 的一个深刻见解是，任何矩阵都可以表示为一系列秩一矩阵的和，每个矩阵由奇异值加权。这个练习将带你回到最基本的构建模块：单个秩一矩阵。通过为一个由两个向量的外积构成的矩阵构建 SVD [@problem_id:1399063]，你将亲手操作并理解 SVD 的核心成分（奇异值、左奇异向量和右奇异向量）是如何从原始数据中直接产生的。", "problem": "考虑一个由外积 $A = \\vec{u}\\vec{v}^T$ 定义的矩阵 $A \\in \\mathbb{R}^{3 \\times 2}$，其中列向量 $\\vec{u}$ 和 $\\vec{v}$ 为\n$$\n\\vec{u} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix} \\quad \\text{和} \\quad \\vec{v} = \\begin{pmatrix} 4 \\\\ 3 \\end{pmatrix}.\n$$\n矩阵 $A$ 的奇异值分解 (SVD) 是一种形如 $A = U\\Sigma V^T$ 的分解，其中 $U$ 是一个 $3 \\times 3$ 的正交矩阵，$V$ 是一个 $2 \\times 2$ 的正交矩阵，而 $\\Sigma$ 是一个 $3 \\times 2$ 的矩形对角矩阵，其对角线上的元素为非负实数（即奇异值），并按降序排列。\n\n令 $\\vec{u}_1$ 为 $U$ 的第一列，$\\vec{v}_1$ 为 $V$ 的第一列。下列哪个选项正确地给出了矩阵 $\\Sigma$ 以及向量 $\\vec{u}_1$ 和 $\\vec{v}_1$？\n\nA. $\\Sigma = \\begin{pmatrix} 15 & 0 \\\\ 0 & 0 \\\\ 0 & 0 \\end{pmatrix}, \\quad \\vec{u}_1 = \\begin{pmatrix} 1/3 \\\\ 2/3 \\\\ 2/3 \\end{pmatrix}, \\quad \\vec{v}_1 = \\begin{pmatrix} 4/5 \\\\ 3/5 \\end{pmatrix}$\n\nB. $\\Sigma = \\begin{pmatrix} 9 & 0 \\\\ 0 & 0 \\\\ 0 & 0 \\end{pmatrix}, \\quad \\vec{u}_1 = \\begin{pmatrix} 1/3 \\\\ 2/3 \\\\ 2/3 \\end{pmatrix}, \\quad \\vec{v}_1 = \\begin{pmatrix} 4/5 \\\\ 3/5 \\end{pmatrix}$\n\nC. $\\Sigma = \\begin{pmatrix} 15 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}, \\quad \\vec{u}_1 = \\begin{pmatrix} 4/5 \\\\ 3/5 \\\\ 0 \\end{pmatrix}, \\quad \\vec{v}_1 = \\begin{pmatrix} 1/3 \\\\ 2/3 \\end{pmatrix}$\n\nD. $\\Sigma = \\begin{pmatrix} 225 & 0 \\\\ 0 & 0 \\\\ 0 & 0 \\end{pmatrix}, \\quad \\vec{u}_1 = \\begin{pmatrix} 1/3 \\\\ 2/3 \\\\ 2/3 \\end{pmatrix}, \\quad \\vec{v}_1 = \\begin{pmatrix} 4/5 \\\\ 3/5 \\end{pmatrix}$", "solution": "给定由 $A=\\vec{u}\\vec{v}^{T}$ 定义的矩阵 $A \\in \\mathbb{R}^{3 \\times 2}$，其中 $\\vec{u}=\\begin{pmatrix}1\\\\2\\\\2\\end{pmatrix}$ 且 $\\vec{v}=\\begin{pmatrix}4\\\\3\\end{pmatrix}$。由于 $A$ 是两个非零向量的外积，因此其秩为 $1$。对于一个形如 $\\vec{u}\\vec{v}^{T}$ 的秩为 $1$ 的矩阵，其奇异值分解恰好只有一个非零奇异值。\n\n一个标准的推导过程如下：\n$$\nA A^{T} = (\\vec{u}\\vec{v}^{T})(\\vec{u}\\vec{v}^{T})^{T} = \\vec{u}\\vec{v}^{T}\\vec{v}\\vec{u}^{T} = (\\vec{v}^{T}\\vec{v})\\,\\vec{u}\\vec{u}^{T}.\n$$\n矩阵 $\\vec{u}\\vec{u}^{T}$ 有一个非零特征值 $\\vec{u}^{T}\\vec{u}$，其对应的特征向量为 $\\vec{u}$。因此 $A A^{T}$ 有一个非零特征值\n$$\n\\lambda_{1} = (\\vec{v}^{T}\\vec{v})(\\vec{u}^{T}\\vec{u}) = \\|\\vec{v}\\|^{2}\\,\\|\\vec{u}\\|^{2},\n$$\n且对应的单位特征向量是 $\\vec{u}/\\|\\vec{u}\\|$。唯一的非零奇异值是 $\\sigma_{1} = \\sqrt{\\lambda_{1}} = \\|\\vec{u}\\|\\,\\|\\vec{v}\\|$，第一个左奇异向量是\n$$\n\\vec{u}_{1} = \\frac{\\vec{u}}{\\|\\vec{u}\\|}.\n$$\n类似地，从 $A^{T}A = (\\vec{u}^{T}\\vec{u})\\,\\vec{v}\\vec{v}^{T}$ 可知，第一个右奇异向量是\n$$\n\\vec{v}_{1} = \\frac{\\vec{v}}{\\|\\vec{v}\\|}.\n$$\n\n计算范数：\n$$\n\\|\\vec{u}\\| = \\sqrt{1^{2}+2^{2}+2^{2}} = \\sqrt{9} = 3, \\quad \\|\\vec{v}\\| = \\sqrt{4^{2}+3^{2}} = \\sqrt{25} = 5.\n$$\n因此，唯一的非零奇异值为\n$$\n\\sigma_{1} = \\|\\vec{u}\\|\\,\\|\\vec{v}\\| = 3 \\cdot 5 = 15.\n$$\n对应的奇异向量为\n$$\n\\vec{u}_{1} = \\frac{1}{3}\\begin{pmatrix}1\\\\2\\\\2\\end{pmatrix} = \\begin{pmatrix}\\frac{1}{3}\\\\\\frac{2}{3}\\\\\\frac{2}{3}\\end{pmatrix}, \n\\quad\n\\vec{v}_{1} = \\frac{1}{5}\\begin{pmatrix}4\\\\3\\end{pmatrix} = \\begin{pmatrix}\\frac{4}{5}\\\\\\frac{3}{5}\\end{pmatrix}.\n$$\n因此，SVD 分解中的 $\\Sigma$ 是一个 $3 \\times 2$ 的矩形对角矩阵，其第一个对角元素等于 $15$，其余元素为零：\n$$\n\\Sigma = \\begin{pmatrix} 15 & 0 \\\\ 0 & 0 \\\\ 0 & 0 \\end{pmatrix}.\n$$\n与所给选项比较，这与选项 A 匹配。", "answer": "$$\\boxed{A}$$", "id": "1399063"}, {"introduction": "矩阵的转置操作在 SVD 中有着优雅而直观的体现。这个练习探讨了矩阵 $A$ 的 SVD 与其转置 $A^T$ 的 SVD 之间的根本联系 [@problem_id:1399057]。通过推导转置矩阵的 SVD，你将加深对左奇异向量 ($U$) 和右奇异向量 ($V$) 角色的理解，并揭示它们之间内在的对偶关系。", "problem": "设 $A$ 是一个大小为 $m \\times n$ 的实矩阵。$A$ 的奇异值分解 (SVD) 是一种形如 $A = U \\Sigma V^T$ 的因式分解，其中：\n- $U$ 是一个 $m \\times m$ 的正交矩阵，其列向量是 $A$ 的左奇异向量。\n- $\\Sigma$ 是一个 $m \\times n$ 的矩形对角矩阵，其对角线上的值为 $A$ 的非负奇异值。\n- $V$ 是一个 $n \\times n$ 的正交矩阵，其列向量是 $A$ 的右奇异向量。\n\n现在，考虑矩阵 $A$ 的转置，记为 $A^T$。其 SVD 也必须能表示为标准形式，我们将其写作 $A^T = U' \\Sigma' (V')^T$。矩阵 $U'$ 必须是一个 $n \\times n$ 的正交矩阵，$\\Sigma'$ 必须是一个 $n \\times m$ 的矩形对角矩阵，而 $V'$ 必须是一个 $m \\times m$ 的正交矩阵。\n\n下列哪个选项正确地用原始矩阵 $U, \\Sigma, V$ 表示了矩阵 $U', \\Sigma', V'$？\n\nA. $U'=U, \\quad \\Sigma'=\\Sigma, \\quad V'=V$\n\nB. $U'=V, \\quad \\Sigma'=\\Sigma, \\quad V'=U$\n\nC. $U'=V, \\quad \\Sigma'=\\Sigma^T, \\quad V'=U$\n\nD. $U'=U, \\quad \\Sigma'=\\Sigma^T, \\quad V'=V$\n\nE. $U'=U^T, \\quad \\Sigma'=\\Sigma^T, \\quad V'=V^T$", "solution": "从给定的 $A$ 的奇异值分解开始：\n$$\nA = U \\Sigma V^{T},\n$$\n其中 $U$ 是 $m \\times m$ 正交矩阵，$V$ 是 $n \\times n$ 正交矩阵，而 $\\Sigma$ 是 $m \\times n$ 矩形对角矩阵，其对角项为非负的奇异值。\n\n对等式两边取转置，并使用恒等式 $(XYZ)^{T} = Z^{T} Y^{T} X^{T}$ 以及 $(V^{T})^{T} = V$：\n$$\nA^{T} = (U \\Sigma V^{T})^{T} = V \\Sigma^{T} U^{T}.\n$$\n我们希望将 $A^{T}$ 表示为 SVD 形式 $A^{T} = U' \\Sigma' (V')^{T}$，其中 $U'$ 是 $n \\times n$ 正交矩阵，$\\Sigma'$ 是 $n \\times m$ 矩形对角矩阵且其对角项非负，而 $V'$ 是 $m \\times m$ 正交矩阵。\n\n将 $A^{T} = V \\Sigma^{T} U^{T}$ 与目标形式 $U' \\Sigma' (V')^{T}$ 比较，我们可以令\n$$\nU' = V, \\quad \\Sigma' = \\Sigma^{T}, \\quad V' = U.\n$$\n这些选择满足所有要求：\n- $U' = V$ 是 $n \\times n$ 正交矩阵，而 $V' = U$ 是 $m \\times m$ 正交矩阵，因为 $U$ 和 $V$ 是正交矩阵。\n- $\\Sigma' = \\Sigma^{T}$ 是一个 $n \\times m$ 的矩形对角矩阵，其非负对角项与 $\\Sigma$ 相同。\n\n作为内部一致性检查，定义关系 $U'^{T} A^{T} V' = \\Sigma'$ 成立：\n$$\nU'^{T} A^{T} V' = V^{T} (V \\Sigma^{T} U^{T}) U = (V^{T} V) \\Sigma^{T} (U^{T} U) = \\Sigma^{T} = \\Sigma'.\n$$\n因此，正确的表示是 $U' = V$，$\\Sigma' = \\Sigma^{T}$ 和 $V' = U$，这对应于选项 C。", "answer": "$$\\boxed{C}$$", "id": "1399057"}, {"introduction": "奇异值分解不仅是一种理论分解，更在数值分析和数据科学中有着广泛应用。本练习将探讨一个经典应用：对于一个可逆矩阵，如何通过最小的扰动使其变为奇异（不可逆）矩阵 [@problem_id:1399073]。这个问题的答案直接与最小的奇异值相关，凸显了 SVD 在矩阵近似、数值稳定性和理解矩阵“接近”奇异程度方面的强大能力。", "problem": "设 $A$ 是一个实数可逆 $n \\times n$ 矩阵。$A$ 的奇异值分解 (Singular Value Decomposition, SVD) 为 $A = U\\Sigma V^T$，其中 $U$ 和 $V$ 是 $n \\times n$ 的正交矩阵，$\\Sigma$ 是一个对角矩阵。$U$ 的列是左奇异向量，记为 $\\{u_1, u_2, \\dots, u_n\\}$，$V$ 的列是右奇异向量，记为 $\\{v_1, v_2, \\dots, v_n\\}$。$\\Sigma$ 的对角元是 $A$ 的奇异值，按 $\\sigma_1 \\ge \\sigma_2 \\ge \\dots \\ge \\sigma_n > 0$ 的顺序排列。\n\n考虑一个秩为1的矩阵 $E$，当它与 $A$ 相加时，得到的矩阵 $A+E$ 是奇异的（即不可逆）。你的任务是找到一个特定的秩为1的矩阵 $E$，使得其弗罗贝尼乌斯范数 (Frobenius norm) $\\|E\\|_F$ 最小。矩阵 $M$ 的弗罗贝尼乌斯范数定义为 $\\|M\\|_F = \\sqrt{\\sum_{i=1}^n \\sum_{j=1}^n M_{ij}^2}$。\n\n用 $A$ 的奇异值和奇异向量表示满足这些条件的矩阵 $E$。", "solution": "设 $A = U \\Sigma V^{T}$ 是 $A$ 的 SVD，其中 $\\Sigma = \\operatorname{diag}(\\sigma_{1},\\dots,\\sigma_{n})$，且 $\\sigma_{1} \\ge \\cdots \\ge \\sigma_{n} > 0$，$U = [u_{1}\\ \\cdots\\ u_{n}]$ 和 $V = [v_{1}\\ \\cdots\\ v_{n}]$ 是正交矩阵。\n\n我们寻找一个秩为1的矩阵 $E$，使得 $A+E$ 是奇异的，且 $\\|E\\|_{F}$ 最小。利用弗罗贝尼乌斯范数和秩的正交不变性：对于 $\\tilde{E} \\coloneqq U^{T} E V$，我们有 $\\|E\\|_{F} = \\|\\tilde{E}\\|_{F}$ 且\n$$\nA + E \\text{ 是奇异的 } \\Longleftrightarrow \\Sigma + \\tilde{E} \\text{ 是奇异的}，\n$$\n因为 $A+E = U(\\Sigma + \\tilde{E})V^{T}$ 且 $U,V$ 是正交的。\n\n为了用最小弗罗贝尼乌斯范数的秩一扰动产生奇异性，令\n$$\n\\tilde{E} = - \\sigma_{n} e_{n} e_{n}^{T},\n$$\n其中 $e_{n}$ 是第 $n$ 个标准基向量。那么 $\\Sigma + \\tilde{E} = \\operatorname{diag}(\\sigma_{1},\\dots,\\sigma_{n-1},0)$ 是奇异的，并且 $\\tilde{E}$ 是秩为1的，其范数为\n$$\n\\|\\tilde{E}\\|_{F} = \\sigma_{n}\\|e_{n} e_{n}^{T}\\|_{F} = \\sigma_{n}.\n$$\n映射回去得到\n$$\nE = U \\tilde{E} V^{T} = -\\sigma_{n} U e_{n} e_{n}^{T} V^{T} = -\\sigma_{n} u_{n} v_{n}^{T}.\n$$\n这个 $E$ 确实使 $A+E$ 奇异，因为\n$$\n(A+E) v_{n} = A v_{n} + E v_{n} = \\sigma_{n} u_{n} - \\sigma_{n} u_{n} = 0.\n$$\n\n为了证明其最小性，设 $s_{1} \\ge \\cdots \\ge s_{n} \\ge 0$ 是 $A+E$ 的奇异值。由于 $A+E$ 是奇异的，所以 $s_{n} = 0$。根据 Hoffman–Wielandt 不等式，\n$$\n\\sum_{i=1}^{n} (\\sigma_{i} - s_{i})^{2} \\le \\|E\\|_{F}^{2}.\n$$\n因此\n$$\n\\|E\\|_{F}^{2} \\ge (\\sigma_{n} - 0)^{2} = \\sigma_{n}^{2},\n$$\n所以 $\\|E\\|_{F} \\ge \\sigma_{n}$。我们的构造达到了 $\\|E\\|_{F} = \\sigma_{n}$，因此是最优的。所以，一个最小化的秩一扰动是\n$$\nE = -\\sigma_{n} u_{n} v_{n}^{T}.\n$$\n如果 $\\sigma_{n}$ 的重数大于1，那么从相应的奇异子空间中任取单位左、右奇异向量，都能得到形式相同的最优 $E$。", "answer": "$$\\boxed{-\\sigma_{n} u_{n} v_{n}^{T}}$$", "id": "1399073"}]}