{"hands_on_practices": [{"introduction": "LU 分解的核心应用之一是高效地求解线性方程组。这个练习将带你完整地走一遍标准流程：首先将系数矩阵 $A$ 分解为一个下三角矩阵 $L$ 和一个上三角矩阵 $U$，然后通过求解两个更简单的三角系统来得到最终解。这个基础实践是掌握 LU 分解计算技巧的基石。", "problem": "一个线性方程组可以表示为矩阵形式 $A\\mathbf{x} = \\mathbf{b}$。求解此类系统的一个有效方法是 LU 分解，即将矩阵 $A$ 分解为一个下三角矩阵 $L$ 和一个上三角矩阵 $U$ 的乘积，使得 $A = LU$。\n\n原始方程组 $A\\mathbf{x} = \\mathbf{b}$ 于是可以重写为 $LU\\mathbf{x} = \\mathbf{b}$。该方程可以通过以下两个步骤求解：\n1.  定义一个中间向量 $\\mathbf{y} = U\\mathbf{x}$。\n2.  首先，使用前向代入法求解方程组 $L\\mathbf{y} = \\mathbf{b}$ 以得到 $\\mathbf{y}$。\n3.  然后，使用回代法求解方程组 $U\\mathbf{x} = \\mathbf{y}$ 以得到 $\\mathbf{x}$。\n\n考虑以下线性方程组：\n$$\n\\begin{align*}\n2x_1 + x_2 + x_3 &= 5 \\\\\n4x_1 - 6x_2 &= -2 \\\\\n-2x_1 + 7x_2 + 2x_3 &= 9\n\\end{align*}\n$$\n该方程组可以写作 $A\\mathbf{x} = \\mathbf{b}$，其中：\n$$\nA = \\begin{pmatrix} 2 & 1 & 1 \\\\ 4 & -6 & 0 \\\\ -2 & 7 & 2 \\end{pmatrix}, \\quad \\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 5 \\\\ -2 \\\\ 9 \\end{pmatrix}\n$$\n首先，求出矩阵 $A$ 的 LU 分解，其中 $L$ 是一个对角线元素为1的下三角矩阵（Doolittle 分解），$U$ 是一个上三角矩阵。然后，利用此分解求解向量 $\\mathbf{x}$。\n\n你的任务是推导出表达式 $x_1 + 2x_2 + 3x_3$ 的值。", "solution": "我们寻求满足 $A=LU$ 的 $L,U$，其中 \n$$L=\\begin{pmatrix}1&0&0\\\\l_{21}&1&0\\\\l_{31}&l_{32}&1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_{11}&u_{12}&u_{13}\\\\0&u_{22}&u_{23}\\\\0&0&u_{33}\\end{pmatrix}.$$\n\n匹配 $A=\\begin{pmatrix}2&1&1\\\\4&-6&0\\\\-2&7&2\\end{pmatrix}$：\n\n1. $U$ 的第一行：\n$$u_{11}=2,\\quad u_{12}=1,\\quad u_{13}=1.$$\n\n2. $L$ 的第一列：\n$$l_{21}=\\frac{a_{21}}{u_{11}}=\\frac{4}{2}=2,\\quad\nl_{31}=\\frac{a_{31}}{u_{11}}=\\frac{-2}{2}=-1.$$\n\n3. 第二行/列：\n$$u_{22}=a_{22}-l_{21}u_{12}=-6-2\\cdot1=-8,\\quad\nu_{23}=a_{23}-l_{21}u_{13}=0-2\\cdot1=-2.$$\n$$l_{32}=\\frac{a_{32}-l_{31}u_{12}}{u_{22}}=\\frac{7-(-1)\\cdot1}{-8}=\\frac{8}{-8}=-1.$$\n\n4. 最后一个对角线元素：\n$$u_{33}=a_{33}-l_{31}u_{13}-l_{32}u_{23}\n=2-(-1)\\cdot1-(-1)\\cdot(-2)=2+1-2=1.$$\n\n因此\n$$L=\\begin{pmatrix}1&0&0\\\\2&1&0\\\\-1&-1&1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}2&1&1\\\\0&-8&-2\\\\0&0&1\\end{pmatrix}.$$\n\n接下来，通过前向代入法求解 $L\\mathbf y=\\mathbf b$，其中 $\\mathbf b=(5,-2,9)^T$：\n$$y_1=5,\\quad\ny_2=-2-2\\,y_1=-2-10=-12,\\quad\ny_3=9-(-1)\\,y_1-(-1)\\,y_2=9+5-12=2.$$\n\n然后通过回代法求解 $U\\mathbf x=\\mathbf y$：\n$$x_3=2,\\quad\n-8x_2-2x_3=-12\\implies-8x_2-4=-12\\implies x_2=1,$$\n$$2x_1+x_2+x_3=5\\implies2x_1+1+2=5\\implies x_1=1.$$\n\n最后，\n$$x_1+2x_2+3x_3=1+2\\cdot1+3\\cdot2=9.$$", "answer": "$$\\boxed{9}$$", "id": "12944"}, {"introduction": "LU 分解不仅是一种计算工具，它还能揭示矩阵的内在属性。本练习将探讨当一个矩阵是奇异（不可逆）矩阵时，其 LU 分解会呈现出什么特征。通过处理一个奇异矩阵，你将亲眼观察到上三角矩阵 $U$ 中如何出现零主元，从而加深对矩阵奇异性与 LU 分解之间联系的理解。", "problem": "在数值线性代数中，一个常见的任务是将一个方阵 $A$ 分解为一个下三角矩阵 $L$ 和一个上三角矩阵 $U$ 的乘积。这被称为LU分解（Lower-Upper factorization），或记为 $A = LU$。这种分解是高效求解线性方程组和计算行列式的关键步骤。\n\n考虑如下给定的矩阵 $A$：\n$$A = \\begin{pmatrix} 1 & 2 & 3 \\\\ 2 & 5 & 8 \\\\ 4 & 9 & 14 \\end{pmatrix}$$\n求矩阵 $A$ 的LU分解，其中 $L$ 是一个单位下三角矩阵（即主对角线上的元素均为1），$U$ 是一个上三角矩阵。\n\n请给出矩阵 $U$ 作为你的答案。", "solution": "我们寻求 $A = LU$ 的分解，其中 $L$ 是单位下三角矩阵，$U$ 是上三角矩阵。使用Doolittle方法，该方法对应于不进行主元选取的高斯消元法，并将乘子记录在 $L$ 中。\n\n开始时\n$$\nA=\\begin{pmatrix}\n1 & 2 & 3 \\\\\n2 & 5 & 8 \\\\\n4 & 9 & 14\n\\end{pmatrix}, \\quad U^{(0)}=A, \\quad L=I.\n$$\n位于 $(1,1)$ 的主元是 $U^{(0)}_{11}=1\\neq 0$。消去第1列中该主元下方的元素：\n$$\nm_{21}=\\frac{U^{(0)}_{21}}{U^{(0)}_{11}}=\\frac{2}{1}=2,\\quad\nm_{31}=\\frac{U^{(0)}_{31}}{U^{(0)}_{11}}=\\frac{4}{1}=4.\n$$\n更新行：\n$$\n\\text{行}_{2}\\leftarrow \\text{行}_{2}-m_{21}\\text{行}_{1}:\\quad (2,5,8)-2(1,2,3)=(0,1,2),\n$$\n$$\n\\text{行}_{3}\\leftarrow \\text{行}_{3}-m_{31}\\text{行}_{1}:\\quad (4,9,14)-4(1,2,3)=(0,1,2).\n$$\n记录 $L_{21}=m_{21}=2$，$L_{31}=m_{31}=4$。此步骤后，\n$$\nU^{(1)}=\\begin{pmatrix}\n1 & 2 & 3 \\\\\n0 & 1 & 2 \\\\\n0 & 1 & 2\n\\end{pmatrix}, \\quad\nL=\\begin{pmatrix}\n1 & 0 & 0 \\\\\n2 & 1 & 0 \\\\\n4 & 0 & 1\n\\end{pmatrix}.\n$$\n位于 $(2,2)$ 的主元是 $U^{(1)}_{22}=1\\neq 0$。消去第2列中该主元下方的元素：\n$$\nm_{32}=\\frac{U^{(1)}_{32}}{U^{(1)}_{22}}=\\frac{1}{1}=1.\n$$\n更新行：\n$$\n\\text{行}_{3}\\leftarrow \\text{行}_{3}-m_{32}\\text{行}_{2}:\\quad (0,1,2)-1(0,1,2)=(0,0,0).\n$$\n记录 $L_{32}=m_{32}=1$。最终的分解因子为\n$$\nU=\\begin{pmatrix}\n1 & 2 & 3 \\\\\n0 & 1 & 2 \\\\\n0 & 0 & 0\n\\end{pmatrix}, \\quad\nL=\\begin{pmatrix}\n1 & 0 & 0 \\\\\n2 & 1 & 0 \\\\\n4 & 1 & 1\n\\end{pmatrix}.\n$$\n快速检验可确认 $LU=A$：\n$$\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n2 & 1 & 0 \\\\\n4 & 1 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n1 & 2 & 3 \\\\\n0 & 1 & 2 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & 2 & 3 \\\\\n2 & 5 & 8 \\\\\n4 & 9 & 14\n\\end{pmatrix}=A.\n$$\n因此，所求的上三角因子即为上面的矩阵 $U$。", "answer": "$$\\boxed{\\begin{pmatrix}1&2&3\\\\0&1&2\\\\0&0&0\\end{pmatrix}}$$", "id": "1375043"}, {"introduction": "在实际应用中，标准的 LU 分解算法可能会因为主元为零或过小而失败，或导致数值不稳定。为了解决这个问题，我们引入了部分选主元（partial pivoting）的策略。这个练习模拟了在计算机中带有部分选主元的 LU 分解是如何“就地”执行的，你将学习如何通过交换行来保证数值稳定性，并使用一个排列向量来追踪这些交换。", "problem": "在许多数值模拟中，求解形如 $Ax = b$ 的大型线性方程组是一个关键且计算成本高昂的步骤。求解此类方程组的一种标准且有效的方法是首先对矩阵 $A$ 进行下上三角（LU）分解。为了处理在分解过程中对角线上可能出现零的矩阵并提高数值稳定性，通常会采用部分主元法来完成。\n\n考虑对一个大小为 $n \\times n$ 的非奇异方阵 $A$ 进行带部分主元法的“原地”LU 分解算法。该算法计算出一个分解 $PA = LU$，其中 $P$ 是一个置换矩阵，$L$ 是一个单位下三角矩阵（对角线上为1），而 $U$ 是一个上三角矩阵。“原地”策略将计算出的 $L$ 和 $U$ 的元素存储在最初为 $A$ 分配的同一内存块中。具体来说，最终矩阵的上三角部分（包括对角线）包含 $U$，而严格下三角部分包含 $L$ 的相应元素。$L$ 的单位对角线不被存储。\n\n置换矩阵 $P$ 不会被显式地构建。取而代之的是，行交换的序列被记录在一个大小为 $n$ 的一维整数数组 $p$ 中，我们称之为主元向量。该数组的索引从 $0$ 到 $n-1$，并初始化为 $p = [0, 1, 2, \\dots, n-1]$。在算法的第 $k$ 步（对于 $k = 0, 1, \\dots, n-2$），如果在第 $k$ 列中（对角线或其下方）绝对值最大的元素所在的行是第 $j$ 行（其中 $j \\ge k$），则交换矩阵的第 $k$ 行和第 $j$ 行。相应地，主元向量的元素 $p_k$ 和 $p_j$ 也进行交换。\n\n给定以下初始矩阵 $A$，请执行上述的原地 LU 部分主元分解。\n\n$$\nA = \\begin{pmatrix} 1 & 1 & 1 \\\\ 4 & 3 & -1 \\\\ 3 & 5 & 3 \\end{pmatrix}\n$$\n\n主元向量 $p$ 的最终状态是什么？请使用 `pmatrix` 环境将您的答案表示为行向量。", "solution": "我们对以下矩阵和主元向量执行带部分主元法的原地 LU 分解：\n$$\nA=\\begin{pmatrix}1&1&1\\\\4&3&-1\\\\3&5&3\\end{pmatrix}, \\quad p=\\begin{pmatrix}0&1&2\\end{pmatrix}.\n$$\n步骤 k=0: 在第 0 列，绝对值为\n$$\n|A_{00}|=|1|, \\quad |A_{10}|=|4|, \\quad |A_{20}|=|3|.\n$$\n最大值在第 $j=1$ 行。交换 $A$ 的第 0 行和第 1 行，并交换 $p_{0}$ 和 $p_{1}$：\n$$\nA\\leftarrow\\begin{pmatrix}4&3&-1\\\\1&1&1\\\\3&5&3\\end{pmatrix}, \\quad p\\leftarrow\\begin{pmatrix}1&0&2\\end{pmatrix}.\n$$\n计算主元 $A_{00}=4$ 下方消元所需的乘子：\n$$\nL_{10}=\\frac{A_{10}}{A_{00}}=\\frac{1}{4}, \\quad L_{20}=\\frac{A_{20}}{A_{00}}=\\frac{3}{4}.\n$$\n将它们存储在严格下三角部分，并更新第 1 行和第 2 行的第 1 列到第 2 列：\n$$\n\\text{第 1 行: } \\ (1,1)-\\frac{1}{4}(3,-1)=\\left(\\frac{1}{4},\\frac{5}{4}\\right), \\quad\n\\text{第 2 行: } \\ (5,3)-\\frac{3}{4}(3,-1)=\\left(\\frac{11}{4},\\frac{15}{4}\\right).\n$$\n因此在 k=0 消元后，\n$$\nA=\\begin{pmatrix}\n4 & 3 & -1\\\\\n\\frac{1}{4} & \\frac{1}{4} & \\frac{5}{4}\\\\\n\\frac{3}{4} & \\frac{11}{4} & \\frac{15}{4}\n\\end{pmatrix}.\n$$\n步骤 k=1: 在第 1 列的第 1 行和第 2 行中，绝对值为\n$$\n\\left|A_{11}\\right|=\\left|\\frac{1}{4}\\right|, \\quad \\left|A_{21}\\right|=\\left|\\frac{11}{4}\\right|.\n$$\n最大值在第 $j=2$ 行。交换 $A$ 的第 1 行和第 2 行，并交换 $p_{1}$ 和 $p_{2}$：\n$$\nA\\leftarrow\\begin{pmatrix}\n4 & 3 & -1\\\\\n\\frac{3}{4} & \\frac{11}{4} & \\frac{15}{4}\\\\\n\\frac{1}{4} & \\frac{1}{4} & \\frac{5}{4}\n\\end{pmatrix}, \\quad\np\\leftarrow\\begin{pmatrix}1&2&0\\end{pmatrix}.\n$$\n计算乘子\n$$\nL_{21}=\\frac{A_{21}}{A_{11}}=\\frac{\\frac{1}{4}}{\\frac{11}{4}}=\\frac{1}{11},\n$$\n并更新 $A_{22}$：\n$$\nA_{22}\\leftarrow A_{22}-L_{21}A_{12}=\\frac{5}{4}-\\frac{1}{11}\\cdot\\frac{15}{4}=\\frac{10}{11}.\n$$\n对于 $n=3$，算法在 $k=1$ 处停止。最终的主元向量是\n$$\np=\\begin{pmatrix}1&2&0\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} 1 & 2 & 0 \\end{pmatrix}}$$", "id": "2186356"}]}