{"hands_on_practices": [{"introduction": "让我们从一个结合了几何直观与代数计算的基础练习开始。这个练习将伪逆与一个简单的线性变换（投影和缩放）联系起来，要求你直接使用摩尔-彭罗斯四个条件来求解。通过这个练习，你将为理解伪逆在处理奇异矩阵时的作用打下坚实的基础。[@problem_id:1397327]", "problem": "考虑一个线性变换 $T: \\mathbb{R}^2 \\to \\mathbb{R}^2$。该变换对任意向量 $\\mathbf{v} = \\begin{pmatrix} x \\\\ y \\end{pmatrix}$ 按顺序执行以下两个操作：\n1. 将向量 $\\mathbf{v}$ 正交投影到 $x$ 轴上。\n2. 将得到的投影向量乘以一个非零实常数 $\\alpha$。\n\n设 $A$ 是此线性变换 $T$ 关于 $\\mathbb{R}^2$ 中标准基的表示矩阵。\n\n在线性代数中，一个矩阵 $M$ 的 Moore-Penrose 伪逆（记作 $M^+$）是矩阵逆的一种推广。它在求解没有唯一解的线性方程组的“最佳拟合”（最小二乘）解时特别有用。\n\n你的任务是求矩阵 $A$ 的 Moore-Penrose 伪逆 $A^+$。你的答案应以常数 $\\alpha$ 表示。", "solution": "到 $x$ 轴上的正交投影将 $\\begin{pmatrix} x \\\\ y \\end{pmatrix}$ 映射到 $\\begin{pmatrix} x \\\\ 0 \\end{pmatrix}$。它在标准基下的矩阵是\n$$\nP=\\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}.\n$$\n乘以一个非零实常数 $\\alpha$ 得到线性变换的矩阵\n$$\nA=\\alpha P=\\begin{pmatrix} \\alpha & 0 \\\\ 0 & 0 \\end{pmatrix}.\n$$\n为了求 Moore-Penrose 伪逆 $A^{+}$，设\n$$\nX=\\begin{pmatrix} x_{11} & x_{12} \\\\ x_{21} & x_{22} \\end{pmatrix}\n$$\n并施加 Moore-Penrose 条件：\n$$\n\\text{(i) } A X A = A, \\quad \\text{(ii) } X A X = X, \\quad \\text{(iii) } (A X)^{T} = A X, \\quad \\text{(iv) } (X A)^{T} = X A.\n$$\n计算\n$$\nA X = \\begin{pmatrix} \\alpha x_{11} & \\alpha x_{12} \\\\ 0 & 0 \\end{pmatrix}, \\quad\nA X A = \\begin{pmatrix} \\alpha^{2} x_{11} & 0 \\\\ 0 & 0 \\end{pmatrix}.\n$$\n条件 (i) 给出 $\\alpha^{2} x_{11} = \\alpha$，因此 $x_{11} = \\frac{1}{\\alpha}$。\n\n接下来，\n$$\nX A = \\begin{pmatrix} x_{11} \\alpha & 0 \\\\ x_{21} \\alpha & 0 \\end{pmatrix}, \\quad\nX A X = \\begin{pmatrix} \\alpha x_{11}^{2} & \\alpha x_{11} x_{12} \\\\ \\alpha x_{21} x_{11} & \\alpha x_{21} x_{12} \\end{pmatrix}.\n$$\n条件 (ii) 给出 $\\alpha x_{11}^{2} = x_{11}$ (由 $x_{11}=\\frac{1}{\\alpha}$ 满足)，$\\alpha x_{11} x_{12} = x_{12}$，$\\alpha x_{21} x_{11} = x_{21}$，以及 $x_{22} = \\alpha x_{21} x_{12}$。\n\n条件 (iii) 要求 $A X$ 是对称的：\n$$\nA X = \\begin{pmatrix} \\alpha x_{11} & \\alpha x_{12} \\\\ 0 & 0 \\end{pmatrix} \\quad \\Rightarrow \\quad \\alpha x_{12} = 0 \\ \\Rightarrow \\ x_{12} = 0\n$$\n因为 $\\alpha \\neq 0$。\n\n条件 (iv) 要求 $X A$ 是对称的：\n$$\nX A = \\begin{pmatrix} x_{11} \\alpha & 0 \\\\ x_{21} \\alpha & 0 \\end{pmatrix} \\quad \\Rightarrow \\quad x_{21} \\alpha = 0 \\ \\Rightarrow \\ x_{21} = 0.\n$$\n由于 $x_{12}=x_{21}=0$，关系式 $x_{22}=\\alpha x_{21} x_{12}$ 给出 $x_{22}=0$。因此，\n$$\nA^{+}=X=\\begin{pmatrix} \\frac{1}{\\alpha} & 0 \\\\ 0 & 0 \\end{pmatrix}.\n$$\n等价地，由于 $A=\\alpha P$，其中 $P$ 是一个满足 $P^{+}=P$ 的正交投影，我们有 $(\\alpha P)^{+}=\\frac{1}{\\alpha} P$，从而得到相同的结果。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{\\alpha} & 0 \\\\ 0 & 0\\end{pmatrix}}$$", "id": "1397327"}, {"introduction": "在掌握了基础之后，我们来处理一类更具普遍性的矩阵：秩一矩阵。这类矩阵可以表示为两个向量的外积 $uv^T$，并且是许多复杂矩阵的构建基石。这个练习将引导你使用奇异值分解（SVD）这一强大工具，推导秩一矩阵伪逆的通用公式。[@problem_id:1397317]", "problem": "设 $u$ 为 $\\mathbb{R}^m$ 中的一个非零列向量，$v$ 为 $\\mathbb{R}^n$ 中的一个非零列向量。考虑由这些向量的外积形成的 $m \\times n$ 矩阵 $A$，给定为 $A = uv^T$。\n\n矩阵 $A$ 的 Moore-Penrose 伪逆，记作 $A^+$，是满足以下四个准则的唯一矩阵：\n1. $A A^+ A = A$\n2. $A^+ A A^+ = A^+$\n3. $(A A^+)^T = A A^+$\n4. $(A^+ A)^T = A^+ A$\n\n您的任务是找到伪逆 $A^+$ 的一个闭式表达式。请用向量 $u$ 和 $v$ 及其转置来表示您的答案。向量 $x$ 的欧几里得范数的平方定义为 $\\|x\\|^2 = x^T x$，并可以在您的最终表达式中使用。", "solution": "问题要求解秩为一的矩阵 $A = uv^T$ 的 Moore-Penrose 伪逆 $A^+$。计算伪逆的一个系统性方法是首先找到矩阵 $A$ 的奇异值分解（SVD）。\n\n如果一个 $m \\times n$ 矩阵 $A$ 的 SVD 由 $A = U\\Sigma V^T$ 给出，其中 $U$ 是一个 $m \\times m$ 的正交矩阵，$V$ 是一个 $n \\times n$ 的正交矩阵，$\\Sigma$ 是一个包含奇异值的 $m \\times n$ 对角矩阵，那么伪逆 $A^+$ 由 $A^+ = V\\Sigma^+ U^T$ 给出。这里，$\\Sigma^+$ 是一个 $n \\times m$ 矩阵，通过对 $\\Sigma$ 进行转置，然后取每个非零元素的倒数得到。\n\n我们来求 $A = uv^T$ 的 SVD。首先，我们对向量 $u$ 和 $v$ 进行归一化。令 $\\hat{u} = \\frac{u}{\\|u\\|}$ 和 $\\hat{v} = \\frac{v}{\\|v\\|}$。注意 $\\hat{u}$ 和 $\\hat{v}$ 是单位向量，其范数分别为 $\\|u\\| = \\sqrt{u^T u}$ 和 $\\|v\\| = \\sqrt{v^T v}$。\n\n我们可以用这些单位向量重写矩阵 $A$：\n$A = uv^T = (\\|u\\|\\hat{u})(\\|v\\|\\hat{v})^T = (\\|u\\| \\|v\\|) \\hat{u} \\hat{v}^T$\n\n这个表达式已经是奇异值分解的形式了。对于一个秩为一的矩阵，只有一个非零的奇异值 $\\sigma_1$。与秩为一矩阵的一般 SVD 形式 $A = \\sigma_1 u_1 v_1^T$ 相比，我们可以确定：\n- 单个非零奇异值：$\\sigma_1 = \\|u\\| \\|v\\|$。\n- $U$ 的第一列：$u_1 = \\hat{u}$。\n- $V$ 的第一列：$v_1 = \\hat{v}$。\n\n矩阵 $\\Sigma$ 是一个 $m \\times n$ 矩阵，其左上角元素为 $\\sigma_1$，其他位置均为零：\n$$\n\\Sigma = \\begin{pmatrix}\n\\sigma_1 & 0 & \\dots & 0 \\\\\n0 & 0 & \\dots & 0 \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & \\dots & 0\n\\end{pmatrix}\n$$\n为了构造 $A^+$，我们首先需要 $\\Sigma^+$。这是一个 $n \\times m$ 矩阵，其中唯一的非零元素位于左上角，其值为 $\\sigma_1$ 的倒数：\n$$\n\\Sigma^+ = \\begin{pmatrix}\n1/\\sigma_1 & 0 & \\dots & 0 \\\\\n0 & 0 & \\dots & 0 \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & \\dots & 0\n\\end{pmatrix}\n$$\n完整的矩阵 $U$ 和 $V$ 可以通过补全标准正交基来形成。设 $U = [u_1 \\ u_2 \\dots u_m]$ 和 $V = [v_1 \\ v_2 \\dots v_n]$。然后伪逆计算为 $A^+ = V\\Sigma^+ U^T$。\n\n$A^+ = V \\Sigma^+ U^T = \\begin{pmatrix} v_1 & v_2 & \\dots & v_n \\end{pmatrix} \\begin{pmatrix}\n1/\\sigma_1 & 0 & \\dots \\\\\n0 & 0 & \\dots \\\\\n\\vdots & \\vdots & \\ddots\n\\end{pmatrix} \\begin{pmatrix} u_1^T \\\\ u_2^T \\\\ \\vdots \\\\ u_m^T \\end{pmatrix}$\n\n执行矩阵乘法，乘积 $\\Sigma^+ U^T$ 产生一个 $n \\times m$ 矩阵，其中第一行为 $(1/\\sigma_1)u_1^T$，所有其他行都为零。然后，从左侧乘以 $V$ 会选出 $V$ 的第一列 $v_1$，并用 $\\Sigma^+ U^T$ 的第一行对其进行缩放。结果为：\n$A^+ = v_1 \\left( \\frac{1}{\\sigma_1} u_1^T \\right) = \\frac{1}{\\sigma_1} v_1 u_1^T$。\n\n现在，我们将 $\\sigma_1$、$u_1$ 和 $v_1$ 的表达式代回：\n$\\sigma_1 = \\|u\\| \\|v\\|$\n$u_1 = \\hat{u} = \\frac{u}{\\|u\\|}$\n$v_1 = \\hat{v} = \\frac{v}{\\|v\\|}$\n\n因此，\n$A^+ = \\frac{1}{\\|u\\| \\|v\\|} \\left( \\frac{v}{\\|v\\|} \\right) \\left( \\frac{u}{\\|u\\|} \\right)^T = \\frac{1}{\\|u\\|^2 \\|v\\|^2} v u^T$。\n\n最后，使用所提供的范数平方的定义 $\\|x\\|^2 = x^T x$，我们可以将最终表达式写为：\n$A^+ = \\frac{1}{(u^T u)(v^T v)} v u^T$。", "answer": "$$\\boxed{\\frac{1}{(u^T u)(v^T v)} v u^T}$$", "id": "1397317"}, {"introduction": "最后，让我们探索伪逆在动态系统中的一个高级应用，例如在线机器学习。在这些场景中，数据是持续输入的，每次都从头计算伪逆会非常低效。这个练习将挑战你推导伪逆的递归更新公式的一部分，展示线性代数在构建自适应算法中的核心作用。[@problem_id:1397278]", "problem": "在许多实时应用中，如自适应信号处理或在线机器学习，有必要随着新数据的到来更新线性模型。一个常见的任务是求解线性最小二乘问题，这通常涉及计算数据矩阵的 Moore-Penrose 伪逆。当通过添加新特征来更新模型时，这对应于在数据矩阵后附加一个新列。\n\n考虑一个大小为 $m \\times (k-1)$ 的数据矩阵 $A_{k-1}$。添加一个新特征，得到一个新的 $m \\times k$ 矩阵 $A_k = [A_{k-1} \\,|\\, v]$，其中 $v$ 是对应于新特征数据的 $m \\times 1$ 列向量。为了降低计算成本，可以采用递归更新公式，而不是从头重新计算 $A_k$ 的伪逆。可以证明，$A_k$ 的伪逆可以分块表示为：\n$$A_k^+ = \\begin{pmatrix} A_{k-1}^+ - d b^T \\\\ b^T \\end{pmatrix}$$\n其中 $d = A_{k-1}^+ v$，$b$ 是一个大小为 $m \\times 1$ 的向量。\n\n向量 $b$ 取决于新列 $v$ 的性质。令 $c = (I - A_{k-1}A_{k-1}^+)v$，它表示 $v$ 正交于 $A_{k-1}$ 列空间的分量。假设新特征是真正新的，而不是现有特征的线性组合，这在数学上意味着 $v$ 不在 $A_{k-1}$ 的列空间中，因此 $c \\neq 0$。\n\n你的任务是在此条件下确定向量 $b$。请用向量 $c$ 的符号表达式来表示你的答案。", "solution": "我们记 $A := A_{k-1}\\in \\mathbb{R}^{m\\times (k-1)}$，并考虑增广矩阵 $A_{k} = [A \\,|\\, v] \\in \\mathbb{R}^{m\\times k}$。伪逆的更新公式为\n$$\nA_k^{+} = \\begin{pmatrix} A^{+} - d b^{T} \\\\ b^{T} \\end{pmatrix}, \\quad d := A^{+} v,\n$$\n其中 $b \\in \\mathbb{R}^{m\\times 1}$ 待确定。定义到 $A$ 的列空间上的正交投影为 $P := A A^{+}$。$v$ 正交于 $A$ 的列空间的分量是\n$$\nc := (I - P) v = v - A A^{+} v = v - A d.\n$$\n在新特征不属于 $A$ 的列空间的假设下，我们有 $c \\neq 0$。\n\n我们通过乘积 $A_k A_k^{+}$ 来施加 Moore-Penrose 条件。计算\n$$\nA_k A_k^{+} = [A, v] \\begin{pmatrix} A^{+} - d b^{T} \\\\ b^{T} \\end{pmatrix} = A(A^{+} - d b^{T}) + v b^{T} = A A^{+} - A d b^{T} + v b^{T}.\n$$\n使用 $A d = A A^{+} v = P v$ 和 $v - A d = c$，我们得到\n$$\nA_k A_k^{+} = P + c b^{T}.\n$$\n矩阵 $A_k A_k^{+}$ 必须是到 $A_k$ 列空间上的正交投影，其列空间为 $\\operatorname{col}(A_k) = \\operatorname{col}(A) \\oplus \\operatorname{span}\\{c\\}$，并且 $c \\perp \\operatorname{col}(A)$。因此 $P + c b^{T}$ 必须是满足以下条件的正交投影：\n- 它在 $c$ 上的作用是恒等变换：$(P + c b^{T}) c = c$。由于 $P c = 0$，这得到 $c (b^{T} c) = c$，因此\n$$\nb^{T} c = 1.\n$$\n- 它保持 $\\operatorname{col}(A)$ 不变：$(P + c b^{T}) A = P A + c b^{T} A = A + c (b^{T} A)$。$c$ 与 $\\operatorname{col}(A)$ 的正交性意味着 $c^{T} A = 0^{T}$，因此为了对称性（见下文），我们将要求 $b$ 与 $c$ 平行，这会得到 $b^{T} A = 0^{T}$，从而 $(P + c b^{T}) A = A$。\n- 它是对称的：$(P + c b^{T})^{T} = P + b c^{T}$。要使 $P + c b^{T}$ 对称，我们需要 $c b^{T} = b c^{T}$，这当且仅当 $b$ 与 $c$ 成比例时成立，即对于某个标量 $\\alpha$，有 $b = \\alpha c$。\n\n将 $b = \\alpha c$ 与 $b^{T} c = 1$ 结合可得\n$$\n\\alpha \\, c^{T} c = 1 \\quad \\Rightarrow \\quad \\alpha = \\frac{1}{c^{T} c}.\n$$\n因此\n$$\nb = \\frac{c}{c^{T} c}.\n$$\n\n为了完整性，我们验证 $A_k^{+} A_k$ 具有所需的性质。计算\n$$\nA_k^{+} A_k = \\begin{pmatrix} A^{+} - d b^{T} \\\\ b^{T} \\end{pmatrix} [A, v]\n= \\begin{pmatrix}\nA^{+} A - d b^{T} A & A^{+} v - d b^{T} v \\\\\nb^{T} A & b^{T} v\n\\end{pmatrix}.\n$$\n当 $b = \\frac{c}{c^{T} c}$ 且 $c \\perp \\operatorname{col}(A)$ 时，我们有 $b^{T} A = \\frac{c^{T} A}{c^{T} c} = 0^{T}$。因此左上角的分块简化为 $A^{+} A$。此外，\n$$\nb^{T} v = \\frac{c^{T} v}{c^{T} c} = \\frac{c^{T} (A A^{+} v + c)}{c^{T} c} = \\frac{c^{T} c}{c^{T} c} = 1,\n$$\n所以右上角的分块变为 $A^{+} v - d \\cdot 1 = d - d = 0$。因此\n$$\nA_k^{+} A_k = \\begin{pmatrix} A^{+} A & 0 \\\\ 0 & 1 \\end{pmatrix},\n$$\n该矩阵是对称且幂等的，满足 Moore-Penrose 条件。因此，在 $c \\neq 0$ 的条件下，所求的向量是\n$$\nb = \\frac{c}{c^{T} c}.\n$$", "answer": "$$\\boxed{\\frac{c}{c^{T} c}}$$", "id": "1397278"}]}