{"hands_on_practices": [{"introduction": "这个练习是掌握基于奇异值分解（SVD）的低秩近似的基石。通过为一个具体的 $3 \\times 3$ 矩阵计算其最佳秩-1近似，你将亲手实践埃卡特-杨-米尔斯基（Eckart-Young-Mirsky）定理的核心流程。这个过程 [@problem_id:1374759] 不仅能巩固你计算奇异值和奇异向量的技能，还能让你直观地理解如何从一个复杂矩阵中提取其最关键的“主干”信息。", "problem": "在许多应用中，例如图像压缩和数据分析，用另一个秩更低的矩阵来近似一个给定矩阵是很有用的。对于一个给定的矩阵 $A$，其“最佳”秩-$k$ 近似是一个秩为 $k$ 的矩阵 $A_k$，它使得误差的弗罗贝尼乌斯范数 $\\|A - A_k\\|_F$ 最小。其中，一个矩阵 $M$（其元素为 $m_{ij}$）的弗罗贝尼乌斯范数定义为 $\\|M\\|_F = \\sqrt{\\sum_{i,j} |m_{ij}|^2}$。\n\n考虑如下给定的矩阵 $A$：\n$$A = \\begin{pmatrix} 1 & 1 & 2 \\\\ 1 & 1 & 2 \\\\ 1 & -1 & 0 \\end{pmatrix}$$\n该矩阵的秩为 2。你的任务是找到矩阵 $A$ 的最佳秩-1 近似矩阵 $A_1$。", "solution": "为了找到弗罗贝尼乌斯范数下的最佳秩-1 近似，我们使用截断奇异值分解：如果 $A = \\sum_{i=1}^{r} \\sigma_{i} u_{i} v_{i}^{T}$，其中奇异值为 $\\sigma_{1} \\geq \\sigma_{2} \\geq \\cdots$，那么最佳秩-1 近似为 $A_{1} = \\sigma_{1} u_{1} v_{1}^{T}$。\n\n计算 $A A^{T}$ 以获得奇异值的平方：\n$$\nA = \\begin{pmatrix} 1 & 1 & 2 \\\\ 1 & 1 & 2 \\\\ 1 & -1 & 0 \\end{pmatrix}, \\quad\nA A^{T} = \\begin{pmatrix} 6 & 6 & 0 \\\\ 6 & 6 & 0 \\\\ 0 & 0 & 2 \\end{pmatrix}.\n$$\n$A A^{T}$ 的特征值为 $12$、$2$ 和 $0$。因此，奇异值为 $\\sigma_{1} = 2\\sqrt{3}$、$\\sigma_{2} = \\sqrt{2}$ 和 $\\sigma_{3} = 0$。\n\n$A A^{T}$ 对应于特征值 $12$ 的一个特征向量与 $\\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$ 成比例。进行归一化可得\n$$\nu_{1} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\n通过以下公式计算相应的右奇异向量：\n$$\nv_{1} = \\frac{1}{\\sigma_{1}} A^{T} u_{1}.\n$$\n首先得到\n$$\nA^{T} u_{1} = \\begin{pmatrix} 1 & 1 & 1 \\\\ 1 & 1 & -1 \\\\ 2 & 2 & 0 \\end{pmatrix} \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}\n= \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 2 \\\\ 2 \\\\ 4 \\end{pmatrix} = \\sqrt{2} \\begin{pmatrix} 1 \\\\ 1 \\\\ 2 \\end{pmatrix},\n$$\n所以\n$$\nv_{1} = \\frac{1}{2\\sqrt{3}} \\sqrt{2} \\begin{pmatrix} 1 \\\\ 1 \\\\ 2 \\end{pmatrix} = \\frac{1}{\\sqrt{6}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 2 \\end{pmatrix}.\n$$\n因此，\n$$\nA_{1} = \\sigma_{1} u_{1} v_{1}^{T}\n= \\left(2\\sqrt{3}\\right) \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{6}} \\begin{pmatrix} 1 & 1 & 2 \\end{pmatrix} \\right)\n= \\begin{pmatrix} 1 & 1 & 2 \\\\ 1 & 1 & 2 \\\\ 0 & 0 & 0 \\end{pmatrix}.\n$$\n该矩阵的秩为 $1$，并且是 $A$ 在弗罗贝尼乌斯范数下的最佳秩-1 近似。", "answer": "$$\\boxed{\\begin{pmatrix} 1 & 1 & 2 \\\\ 1 & 1 & 2 \\\\ 0 & 0 & 0 \\end{pmatrix}}$$", "id": "1374759"}, {"introduction": "在掌握了基本流程之后，我们来挑战一个代数上更复杂的情景。这个问题的特殊之处在于，其奇异值的计算会引导我们进入无理数领域，这种情况在现实世界的数据分析中屡见不鲜。解决这个问题 [@problem_id:1374797] 将证明SVD方法的普适性，并锻炼你在面对非理想化的数字时，依然能够精准、系统地运用理论知识解决问题的能力。", "problem": "在数据压缩和机器学习等多个领域中，将一个复杂矩阵近似为一个更简单的低秩矩阵是一项常见任务。根据 Eckart-Young-Mirsky 定理，一个矩阵的最佳秩-$k$近似可以通过其奇异值分解（SVD）得到。\n\n考虑如下定义的 $3 \\times 3$ 幂零矩阵 $A$：\n$$\nA = \\begin{pmatrix}\n0 & 1 & 1 \\\\\n0 & 0 & 1 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\n您的任务是找到一个秩为 1 且与 $A$ 最接近的矩阵 $B$。这里，矩阵之间的“接近程度”是使用 Frobenius 范数来衡量的。对于两个维度相同的矩阵 $M$ 和 $N$，其 Frobenius 距离的平方为 $\\|M-N\\|_F^2 = \\sum_{i,j} |M_{ij} - N_{ij}|^2$。找到使此距离最小化的矩阵 $B$ 等价于找到最佳秩-1 近似。\n\n请给出结果矩阵 $B$。矩阵的元素应以精确值表示，而不是小数近似值。", "solution": "根据 Eckart-Young-Mirsky 定理，在 Frobenius 范数下，矩阵 $A$ 的最佳秩-1 近似由 $B=\\sigma_{1}u_{1}v_{1}^{T}$ 给出，其中 $\\sigma_{1}$ 是 $A$ 的最大奇异值，而 $u_{1},v_{1}$ 是对应的左奇异向量和右奇异向量。奇异值是 $A^{T}A$ 的特征值的平方根。\n\n计算 $A^{T}A$：\n$$\nA^{T}A=\\begin{pmatrix}\n0 & 0 & 0 \\\\\n0 & 1 & 1 \\\\\n0 & 1 & 2\n\\end{pmatrix}.\n$$\n其非零部分是 $2\\times 2$ 的子矩阵 $\\begin{pmatrix}1 & 1 \\\\ 1 & 2\\end{pmatrix}$，其特征多项式为\n$$\n\\det\\begin{pmatrix}1-\\lambda & 1 \\\\ 1 & 2-\\lambda\\end{pmatrix}=(1-\\lambda)(2-\\lambda)-1=\\lambda^{2}-3\\lambda+1.\n$$\n因此，$A^{T}A$ 的特征值是 $\\lambda_{1}=\\frac{3+\\sqrt{5}}{2}$，$\\lambda_{2}=\\frac{3-\\sqrt{5}}{2}$ 和 $0$。最大奇异值是 $\\sigma_{1}=\\sqrt{\\lambda_{1}}$。\n\n对于 $\\lambda_{1}$，$A^{T}A$ 的一个特征向量 $v$ 的第一个分量为零（因为 $\\lambda_{1}\\neq 0$ 且 $A^{T}A$ 的第一行为零），因此设 $v=[0,x,y]^{T}$，并求解\n$$\n\\begin{pmatrix}1 & 1 \\\\ 1 & 2\\end{pmatrix}\\begin{pmatrix}x \\\\ y\\end{pmatrix}=\\lambda_{1}\\begin{pmatrix}x \\\\ y\\end{pmatrix}.\n$$\n由 $(1-\\lambda_{1})x+y=0$ 可得 $y=(\\lambda_{1}-1)x$。取 $x=1$ 得到一个特征向量 $v_{1,\\text{unnorm}}=[0,1,\\lambda_{1}-1]^{T}$。其范数的平方为\n$$\n\\|v_{1,\\text{unnorm}}\\|^{2}=1+(\\lambda_{1}-1)^{2}.\n$$\n利用 $\\lambda_{1}^{2}-3\\lambda_{1}+1=0$，我们有 $(\\lambda_{1}-1)^{2}=\\lambda_{1}$，因此 $\\|v_{1,\\text{unnorm}}\\|^{2}=\\lambda_{1}+1$。所以，单位右奇异向量为\n$$\nv_{1}=\\frac{1}{\\sqrt{\\lambda_{1}+1}}\\begin{pmatrix}0 \\\\ 1 \\\\ \\lambda_{1}-1\\end{pmatrix}.\n$$\n接下来计算 $A v_{1}$：\n$$\nA\\begin{pmatrix}0 \\\\ 1 \\\\ \\lambda_{1}-1\\end{pmatrix}=\\begin{pmatrix}1+(\\lambda_{1}-1) \\\\ \\lambda_{1}-1 \\\\ 0\\end{pmatrix}=\\begin{pmatrix}\\lambda_{1} \\\\ \\lambda_{1}-1 \\\\ 0\\end{pmatrix},\n$$\n所以\n$$\nA v_{1}=\\frac{1}{\\sqrt{\\lambda_{1}+1}}\\begin{pmatrix}\\lambda_{1} \\\\ \\lambda_{1}-1 \\\\ 0\\end{pmatrix}.\n$$\n因为 $\\|A v_{1}\\|=\\sigma_{1}$，所以左奇异向量是 $u_{1}=(A v_{1})/\\sigma_{1}$。最佳秩-1 近似是 $B=\\sigma_{1}u_{1}v_{1}^{T}=(A v_{1})v_{1}^{T}$。因此\n$$\nB=\\frac{1}{\\lambda_{1}+1}\\begin{pmatrix}\\lambda_{1} \\\\ \\lambda_{1}-1 \\\\ 0\\end{pmatrix}\\begin{pmatrix}0 & 1 & \\lambda_{1}-1\\end{pmatrix}.\n$$\n进行外积运算得到\n$$\nB=\\frac{1}{\\lambda_{1}+1}\\begin{pmatrix}\n0 & \\lambda_{1} & \\lambda_{1}(\\lambda_{1}-1) \\\\\n0 & \\lambda_{1}-1 & (\\lambda_{1}-1)^{2} \\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$\n利用 $\\lambda_{1}^{2}=3\\lambda_{1}-1$ 和 $(\\lambda_{1}-1)^{2}=\\lambda_{1}$，我们简化矩阵的元素：\n$$\nB=\\frac{1}{\\lambda_{1}+1}\\begin{pmatrix}\n0 & \\lambda_{1} & 2\\lambda_{1}-1 \\\\\n0 & \\lambda_{1}-1 & \\lambda_{1} \\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$\n代入 $\\lambda_{1}=\\frac{3+\\sqrt{5}}{2}$ 并将每个分式有理化：\n- $\\frac{\\lambda_{1}}{\\lambda_{1}+1}=\\frac{\\frac{3+\\sqrt{5}}{2}}{\\frac{5+\\sqrt{5}}{2}}=\\frac{3+\\sqrt{5}}{5+\\sqrt{5}}=\\frac{5+\\sqrt{5}}{10}$，\n- $\\frac{\\lambda_{1}-1}{\\lambda_{1}+1}=\\frac{\\frac{1+\\sqrt{5}}{2}}{\\frac{5+\\sqrt{5}}{2}}=\\frac{1+\\sqrt{5}}{5+\\sqrt{5}}=\\frac{\\sqrt{5}}{5}$，\n- $\\frac{2\\lambda_{1}-1}{\\lambda_{1}+1}=\\frac{2+\\sqrt{5}}{\\frac{5+\\sqrt{5}}{2}}=\\frac{5+3\\sqrt{5}}{10}$。\n\n因此，最佳秩-1 近似是\n$$\nB=\\begin{pmatrix}\n0 & \\frac{5+\\sqrt{5}}{10} & \\frac{5+3\\sqrt{5}}{10} \\\\\n0 & \\frac{\\sqrt{5}}{5} & \\frac{5+\\sqrt{5}}{10} \\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\n0 & \\frac{5+\\sqrt{5}}{10} & \\frac{5+3\\sqrt{5}}{10} \\\\\n0 & \\frac{\\sqrt{5}}{5} & \\frac{5+\\sqrt{5}}{10} \\\\\n0 & 0 & 0\n\\end{pmatrix}}$$", "id": "1374797"}, {"introduction": "本练习旨在将你的理解从计算层面提升到概念层面。问题 [@problem_id:1374757] 巧妙地设置了一个关于“近似的近似”的场景，看似需要进行繁琐的二次计算。然而，这实际上是一道考验你对SVD结构和低秩近似内在逻辑理解的“思考题”。通过解决它，你将深刻领会到，最佳低秩近似是分层的，并且始终由原始矩阵最重要的奇异分量决定，这是一个非常优雅且强大的性质。", "problem": "考虑一个大小为 $3 \\times 4$ 的实矩阵 $A$。$A$ 的奇异值分解 (Singular Value Decomposition, SVD) 由乘积 $A = U\\Sigma V^T$ 给出，其中各分量矩阵为：\n$$\nU = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n$$\n\\Sigma = \\begin{pmatrix} 10 & 0 & 0 & 0 \\\\ 0 & 5 & 0 & 0 \\\\ 0 & 0 & 2 & 0 \\end{pmatrix}\n$$\n$$\nV^T = \\begin{pmatrix} 1/2 & 1/2 & 1/2 & 1/2 \\\\ 1/2 & -1/2 & 1/2 & -1/2 \\\\ 1/2 & 1/2 & -1/2 & -1/2 \\\\ 1/2 & -1/2 & -1/2 & 1/2 \\end{pmatrix}\n$$\n令 $A_2$ 为矩阵 $A$ 的最佳秩-2 近似。随后，令 $B$ 为矩阵 $A_2$ 的最佳秩-1 近似。“最佳”近似定义为在目标秩的矩阵中，与原矩阵之差的弗罗贝尼乌斯范数 (Frobenius norm) 最小的那个矩阵。\n\n求矩阵 $B$ 第一行第三列元素的值。", "solution": "我们使用奇异值分解 $A=U\\Sigma V^{T}$，其中 $U\\in\\mathbb{R}^{3\\times 3}$ 是正交矩阵，$V\\in\\mathbb{R}^{4\\times 4}$ 是正交矩阵，而 $\\Sigma\\in\\mathbb{R}^{3\\times 4}$ 的主对角线上有奇异值 $\\sigma_{1}\\geq\\sigma_{2}\\geq\\sigma_{3}\\geq 0$。在弗罗贝尼乌斯范数下，最佳秩-$k$ 近似由截断 SVD (Eckart–Young 定理) 给出：\n$$\nA_{k}=\\sum_{i=1}^{k}\\sigma_{i}u_{i}v_{i}^{T},\n$$\n其中 $u_{i}$ 和 $v_{i}$ 分别是 $U$ 和 $V$ 的第 $i$ 列。\n\n根据所给数据，$U=I_{3}$，因此 $u_{1}=\\begin{pmatrix}1\\\\0\\\\0\\end{pmatrix}$，$u_{2}=\\begin{pmatrix}0\\\\1\\\\0\\end{pmatrix}$，$u_{3}=\\begin{pmatrix}0\\\\0\\\\1\\end{pmatrix}$。从 $\\Sigma$ 中可以读出奇异值为 $\\sigma_{1}=10$，$\\sigma_{2}=5$，$\\sigma_{3}=2$。矩阵 $V^{T}$ 已知，因此 $v_{1}$ 是 $V$ 的第一列，它等于 $V^{T}$ 第一行的转置：\n$$\nv_{1}=\\begin{pmatrix}\\frac{1}{2}\\\\ \\frac{1}{2}\\\\ \\frac{1}{2}\\\\ \\frac{1}{2}\\end{pmatrix}.\n$$\n\n首先，$A$ 的最佳秩-2 近似 $A_{2}$ 是\n$$\nA_{2}=\\sigma_{1}u_{1}v_{1}^{T}+\\sigma_{2}u_{2}v_{2}^{T}.\n$$\n它的奇异值是 $\\sigma_{1}$ 和 $\\sigma_{2}$，对应的奇异向量仍然是 $u_{1},v_{1}$ 和 $u_{2},v_{2}$。\n\n接下来，$B$ 是 $A_{2}$ 的最佳秩-1 近似。根据同样的截断 SVD 原理，这只保留了最大的奇异值三元组：\n$$\nB=\\sigma_{1}u_{1}v_{1}^{T}.\n$$\n\n为了提取 $B$ 的第一行第三列的元素，我们使用外积形式。对于 $B=\\sigma_{1}u_{1}v_{1}^{T}$，其 $(i,j)$ 元素为\n$B_{ij}=\\sigma_{1}\\,u_{1,i}\\,v_{1,j}$。\n具体来说，$u_{1,1}=1$ 以及 $v_{1,3}=\\frac{1}{2}$。因此，\n$B_{1,3}=\\sigma_{1}\\cdot 1\\cdot \\frac{1}{2}=10\\cdot\\frac{1}{2}=5$。", "answer": "$$\\boxed{5}$$", "id": "1374757"}]}