{"hands_on_practices": [{"introduction": "要开始我们的动手实践，首先需要掌握部分主元法的一个基本规则：何时需要进行行交换？这个练习 [@problem_id:1383208] 要求你为一个 $2 \\times 2$ 矩阵确定触发换行的精确条件。通过解决这个问题，你将对主元选择算法中的核心决策步骤有一个清晰的理解。", "problem": "在数值线性代数中，当执行高斯消元法来求矩阵的下上三角（LU）分解时，采用主元选择策略来增强数值稳定性并避免除以零通常是至关重要的。一种常见的方法是部分主元法。在此策略中，对于每一列 k（从 k=1 开始），我们在该列的对角线上或其下方（即，行 i ≥ k）寻找绝对值最大的元素。如果这个元素不是对角元 $a_{kk}$，则执行行交换，将绝对值最大的元素移动到主元位置。\n\n考虑矩阵 $A$：\n$$\nA = \\begin{pmatrix} x & 5 \\\\ 10 & 2 \\end{pmatrix}\n$$\n其中 $x$ 是一个实数。\n\n当使用部分主元法时，下列哪个选项描述了在高斯消元法的第一步中需要进行行交换的 $x$ 的完整取值范围？\n\nA. $x > 10$\n\nB. $x  -10$\n\nC. $-10  x  10$\n\nD. $x  -10$ 或 $x > 10$\n\nE. $x = 10$ 或 $x = -10$", "solution": "在步骤 $k=1$ 的部分主元法中，主元被选为第1列中行 $i \\geq 1$ 之间绝对值最大的元素。对于\n$$\nA=\\begin{pmatrix} x  5 \\\\ 10  2 \\end{pmatrix},\n$$\n候选者是 $|a_{11}|=|x|$ 和 $|a_{21}|=|10|=10$。当且仅当最大绝对值出现在非当前主元行时，即当 $|x|10$ 时，需要进行行交换。如果 $|x|10$，对角元已经是最大的，不需要交换。如果 $|x|=10$，则存在相等的情况；由于对角元是最大值之一，因此不强制要求交换。因此，恰好当 $-10x10$ 时，必须进行行交换，这对应于选项 C。", "answer": "$$\\boxed{C}$$", "id": "1383208"}, {"introduction": "理解了主元选择的条件后，让我们把这个规则应用到一个多步场景中。这个练习 [@problem_id:1383199] 要求你跟踪一个 $3 \\times 3$ 矩阵的部分主元分解过程，并找出在每一步消元中都需要进行换行的矩阵。这将锻炼你的程序化计算能力，并帮助你直观地理解在 LU 分解过程中矩阵是如何被变换的。", "problem": "在数值线性代数中，矩阵 $A$ 的LU（Lower-Upper）分解通常使用高斯消去法来执行。为了增强数值稳定性，会采用一种主元策略。一种常见的方法是部分主元法。\n\n部分主元策略在消元过程的第 $k$ 步（目标是在第 $k$ 列主对角线下方制造零）涉及以下步骤：\n1.  在第 $k$ 列中，从第 $k$ 行到最后一行，找出绝对值最大的元素。\n2.  如果该元素不在主元位置（第 $k$ 行，第 $k$ 列），则执行行交换，将包含该元素的行移动到第 $k$ 行。\n\n对于一个 $3 \\times 3$ 矩阵，这个过程涉及两个消元步骤：首先，在第1列的主元下方制造零；其次，在第2列的主元下方制造零。\n\n在使用部分主元策略执行LU分解时，下列哪个非奇异 $3 \\times 3$ 矩阵在**每**个消元步骤（即第1列和第2列）都需要进行行交换？\n\nA. $A = \\begin{pmatrix} 4  1  1 \\\\ 2  3  1 \\\\ 1  1  2 \\end{pmatrix}$\n\nB. $B = \\begin{pmatrix} 1  1  1 \\\\ 2  3  1 \\\\ 4  4  1 \\end{pmatrix}$\n\nC. $C = \\begin{pmatrix} 1  3  1 \\\\ 2  2  1 \\\\ 4  4  1 \\end{pmatrix}$\n\nD. $D = \\begin{pmatrix} 4  4  1 \\\\ 2  2  1 \\\\ 1  3  1 \\end{pmatrix}$", "solution": "在部分主元法中，第 $k$ 步的主元选为第 $k$ 列中，在第 $k$ 行至第 $n$ 行之间绝对值最大的元素。如果最大值元素不位于第 $k$ 行，则执行行交换。对于一个 $3\\times 3$ 的系统，我们检查第 $k=1$ 步和第 $k=2$ 步。\n\n矩阵 A：$A=\\begin{pmatrix}411\\\\231\\\\112\\end{pmatrix}$。在第1列，绝对值为 $|4|,|2|,|1|$，最大值 $4$ 已经在第1行，所以在第1步不需要交换。因此，A不需要在每一步都进行行交换。\n\n矩阵 B：$B=\\begin{pmatrix}111\\\\231\\\\441\\end{pmatrix}$。第1步：第1列的绝对值为 $|1|,|2|,|4|$；最大值 $4$ 在第3行，所以交换第1行和第3行得到\n$$\n\\begin{pmatrix}\n441\\\\\n231\\\\\n111\n\\end{pmatrix}.\n$$\n使用乘数 $m_{21}=\\frac{2}{4}=\\frac{1}{2}$ 和 $m_{31}=\\frac{1}{4}$ 在主元下方进行消元：\n$$\n\\text{Row}_{2}\\leftarrow \\text{Row}_{2}-\\tfrac{1}{2}\\text{Row}_{1}:\\ (0,\\ 1,\\ \\tfrac{1}{2}),\n\\quad\n\\text{Row}_{3}\\leftarrow \\text{Row}_{3}-\\tfrac{1}{4}\\text{Row}_{1}:\\ (0,\\ 0,\\ \\tfrac{3}{4}),\n$$\n所以第1步之后矩阵变为\n$$\n\\begin{pmatrix}\n441\\\\\n01\\tfrac{1}{2}\\\\\n00\\tfrac{3}{4}\n\\end{pmatrix}.\n$$\n第2步：在第2列（第2行和第3行）中，绝对值为 $|1|$ 和 $|0|$，所以最大值已经在第2行；在第2步不需要交换。因此，B不需要在每一步都进行行交换。\n\n矩阵 C：$C=\\begin{pmatrix}131\\\\221\\\\441\\end{pmatrix}$。第1步：第1列的绝对值为 $|1|,|2|,|4|$；最大值 $4$ 在第3行，所以交换第1行和第3行：\n$$\n\\begin{pmatrix}\n441\\\\\n221\\\\\n131\n\\end{pmatrix}.\n$$\n使用 $m_{21}=\\frac{2}{4}=\\frac{1}{2}$ 和 $m_{31}=\\frac{1}{4}$ 在下方进行消元：\n$$\n\\text{Row}_{2}\\leftarrow \\text{Row}_{2}-\\tfrac{1}{2}\\text{Row}_{1}:\\ (0,\\ 0,\\ \\tfrac{1}{2}),\n\\quad\n\\text{Row}_{3}\\leftarrow \\text{Row}_{3}-\\tfrac{1}{4}\\text{Row}_{1}:\\ (0,\\ 2,\\ \\tfrac{3}{4}),\n$$\n所以第1步之后矩阵变为\n$$\n\\begin{pmatrix}\n441\\\\\n00\\tfrac{1}{2}\\\\\n02\\tfrac{3}{4}\n\\end{pmatrix}.\n$$\n第2步：在第2列（第2行和第3行）中，绝对值为 $|0|$ 和 $|2|$；最大值在第3行，而不是第2行，所以在第2步需要进行交换。因此，C在两个步骤中都需要进行行交换。\n\n矩阵 D：$D=\\begin{pmatrix}441\\\\221\\\\131\\end{pmatrix}$。在第1列，绝对值为 $|4|,|2|,|1|$，最大值 $4$ 已经在第1行，所以在第1步不需要交换。因此，D不需要在每一步都进行行交换。\n\n因此，只有矩阵C在使用部分主元法时，在两个消元步骤中都需要进行行交换。", "answer": "$$\\boxed{C}$$", "id": "1383199"}, {"introduction": "最后，我们来解决最关键的问题：我们为什么要不厌其烦地使用主元策略？这个问题 [@problem_id:1383205] 为主元法对数值稳定性的重要性提供了一个强有力的数值证明。通过对一个主元元素非常小的矩阵，比较使用和不使用主元法的 LU 分解结果，你将亲眼见证主元法是如何防止灾难性的计算错误的。", "problem": "考虑矩阵 $A$ 定义如下：\n$$\nA = \\begin{pmatrix} \\epsilon  2 \\\\ 1  3 \\end{pmatrix}\n$$\n其中 $\\epsilon = 10^{-8}$ 是一个很小的正常数。\n\n我们将对矩阵 $A$ 进行两种类型的 LU 分解。\n\n首先，求 $A$ 的标准 LU 分解，使得 $A=LU$。在此分解中，$L$ 是一个单位下三角矩阵（主对角线元素为 1），$U$ 是一个上三角矩阵。设矩阵 $U$ 的第二行第二列的元素记为 $u_{22}$。\n\n其次，使用部分主元法求 $A$ 的 LU 分解。该策略得到形式为 $PA = L'U'$ 的分解，其中 $P$ 是为使每列的主元绝对值最大而选择的置换矩阵，$L'$ 是一个单位下三角矩阵，$U'$ 是一个上三角矩阵。设矩阵 $U'$ 的第二行第二列的元素记为 $u'_{22}$。\n\n计算和 $u_{22} + u'_{22}$ 的数值。", "solution": "我们使用 Doolittle LU 分解法，先不进行主元选择，然后采用部分主元法。\n\n不进行主元选择，记 $A=LU$，其中\n$$\nL=\\begin{pmatrix}10\\\\ \\ell_{21}1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_{11}u_{12}\\\\ 0u_{22}\\end{pmatrix}.\n$$\n与 $A=\\begin{pmatrix}\\epsilon2\\\\ 13\\end{pmatrix}$ 对比，可得标准关系式：\n$$\nu_{11}=a_{11}=\\epsilon,\\quad u_{12}=a_{12}=2,\\quad \\ell_{21}=\\frac{a_{21}}{u_{11}}=\\frac{1}{\\epsilon},\n$$\n以及\n$$\nu_{22}=a_{22}-\\ell_{21}u_{12}=3-\\frac{1}{\\epsilon}\\cdot 2=3-\\frac{2}{\\epsilon}.\n$$\n\n采用部分主元法，由于 $|1||\\,\\epsilon\\,|$，我们首先交换行，得到\n$$\nPA=\\begin{pmatrix}13\\\\ \\epsilon2\\end{pmatrix}.\n$$\n对 $PA$ 进行分解，记 $PA=L'U'$，其中\n$$\nL'=\\begin{pmatrix}10\\\\ \\ell'_{21}1\\end{pmatrix},\\quad\nU'=\\begin{pmatrix}u'_{11}u'_{12}\\\\ 0u'_{22}\\end{pmatrix}.\n$$\n则\n$$\nu'_{11}=1,\\quad u'_{12}=3,\\quad \\ell'_{21}=\\frac{\\epsilon}{u'_{11}}=\\epsilon,\n$$\n以及\n$$\nu'_{22}=2-\\ell'_{21}u'_{12}=2-3\\epsilon.\n$$\n\n因此，\n$$\nu_{22}+u'_{22}=\\left(3-\\frac{2}{\\epsilon}\\right)+(2-3\\epsilon)=5-\\frac{2}{\\epsilon}-3\\epsilon.\n$$\n代入 $\\epsilon=10^{-8}$：\n$$\n\\frac{2}{\\epsilon}=2\\times 10^{8},\\qquad 3\\epsilon=3\\times 10^{-8},\n$$\n所以\n$$\nu_{22}+u'_{22}=5-2\\times 10^{8}-3\\times 10^{-8}=-199999995.00000003.\n$$", "answer": "$$\\boxed{-199999995.00000003}$$", "id": "1383205"}]}