{"hands_on_practices": [{"introduction": "在密码学中，某些加密方案的设计使其加密和解密过程完全相同，这类密码被称为对合密码。这种设计简化了密钥管理，因为收发双方可以使用同一个密钥进行双向通信。这个练习 [@problem_id:1348683] 将带你探索这种密码的数学基础，要求你构建一个满足对合条件的希尔密码密钥矩阵 $K$，即满足 $K^2 \\equiv I \\pmod{m}$。通过求解这个问题，你将能够实践矩阵乘法和模算术下的方程求解，直观感受密码学属性如何转化为具体的线性代数约束。", "problem": "在密码学中，希尔密码（Hill cipher）是一种基于线性代数的表多字母替换密码。一条消息被分成大小为 $n$ 的块，每个块表示为一个列向量 $P$。相应的密文向量 $C$ 通过变换 $C \\equiv KP \\pmod m$ 得到，其中 $K$ 是一个可逆的 $n \\times n$ 密钥矩阵，$m$ 是字母表的大小。\n\n一类特殊的密码是“对合密码”，其加密过程是其自身的逆过程。这意味着对任意明文向量应用两次加密变换会返回原始的明文向量。\n\n考虑一个这样的对合希尔密码，它作用于由 $m=26$ 个字母组成的英文字母表（映射为 $A=0, B=1, \\dots, Z=25$），其密钥矩阵 $K$ 是一个 $2 \\times 2$ 矩阵。该密钥矩阵部分已知，形式如下：\n$$\nK = \\begin{pmatrix} 5 & 3 \\\\ 18 & d \\end{pmatrix}\n$$\n其中 $d$ 是一个整数。\n\n请确定在 $0 \\le d < 26$ 范围内的唯一 $d$ 值，使得该密码是对合的。", "solution": "一个对合希尔密码满足 $K^{2} \\equiv I \\pmod{26}$，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。对于 $K=\\begin{pmatrix} 5 & 3 \\\\ 18 & d \\end{pmatrix}$，计算\n$$\nK^{2}\n=\n\\begin{pmatrix}\n5^{2}+3\\cdot 18 & 5\\cdot 3+3d \\\\\n18\\cdot 5 + d\\cdot 18 & 18\\cdot 3 + d^{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n79 & 15+3d \\\\\n90+18d & 54+d^{2}\n\\end{pmatrix}.\n$$\n施加条件 $K^{2} \\equiv I \\pmod{26}$ 会得到四个同余方程：\n$$79 \\equiv 1 \\pmod{26},$$\n$$15+3d \\equiv 0 \\pmod{26},$$\n$$90+18d \\equiv 0 \\pmod{26},$$\n$$54+d^{2} \\equiv 1 \\pmod{26}.$$\n第一个方程是满足的，因为 $79-1=78=3\\cdot 26$。对于右上角的元素，$15+3d \\equiv 0 \\pmod{26}$ 等价于 $3(5+d) \\equiv 0 \\pmod{26}$。由于 $\\gcd(3,26)=1$，两边乘以 $3$ 模 $26$ 的逆元，得到 $5+d \\equiv 0 \\pmod{26}$，因此\n$$d \\equiv -5 \\equiv 21 \\pmod{26}.$$\n对于左下角的元素，$90+18d \\equiv 0 \\pmod{26}$ 即 $18(5+d) \\equiv 0 \\pmod{26}$。当 $d \\equiv 21 \\pmod{26}$ 时，我们有 $5+d \\equiv 0 \\pmod{26}$，所以此式成立。最后，右下角的元素给出 $d^{2} \\equiv 1-54 \\equiv -53 \\equiv 25 \\pmod{26}$，其模 $26$ 的解为 $d \\equiv 5$ 和 $d \\equiv 21$。非对角线元素的条件 $3(5+d) \\equiv 0 \\pmod{26}$ 排除了 $d \\equiv 5$ 的情况，因此在 $0 \\le d < 26$ 范围内留下唯一解：\n$$d=21.$$\n作为验证，当 $d=21$ 时，\n$$K^{2}=\\begin{pmatrix}79 & 78 \\\\ 468 & 495\\end{pmatrix} \\equiv \\begin{pmatrix}1 & 0 \\\\ 0 & 1\\end{pmatrix} \\pmod{26},$$\n并且 $\\det K = 5\\cdot 21 - 54 = 51 \\equiv 25 \\pmod{26}$ 且 $\\gcd(25,26)=1$，所以 $K$ 模 $26$ 可逆，该密码是对合的。", "answer": "$$\\boxed{21}$$", "id": "1348683"}, {"introduction": "接下来，我们将从密码设计转向密码分析。在现实世界中，截获的数据往往并非完美无瑕，可能受到信道噪声的干扰。这个练习 [@problem_id:1348664] 模拟了一个经典的“已知明文攻击”场景，但增加了数据被噪声轻微破坏的复杂性。你的任务是运用最小二乘法，从一组不精确的明文-密文对中恢复出最可能的加密密钥 $K$。这个过程不仅能加深你对最小二乘法作为一种强大拟合工具的理解，还能让你体会到如何将线性代数的理论应用于解决充满不确定性的实际问题。", "problem": "一位密码分析员正在分析一种简化的线性加密方案。该方案将英文字母映射为整数 (A=0, B=1, ..., Z=25)。一条明文消息被分成字母对，表示为2元列向量 $\\vec{p}$。每个明文向量 $\\vec{p}$ 通过矩阵-向量乘积 $\\vec{c} = K \\vec{p}$，使用一个保密的 $2 \\times 2$ 矩阵 $K$ 加密成一个密文向量 $\\vec{c}$。生成的向量通过一个有噪声的信道进行传输。\n\n该分析员截获了三对明文-密文对。由于噪声的影响，接收到的向量（记为 $\\vec{c'}_i$）与原始向量 $\\vec{c}_i$ 并不完全相同。然而，已知原始密钥矩阵 $K$ 的元素均为整数。截获的明文向量和对应的带噪声的接收密文向量如下：\n\n明文向量：\n$$ \\vec{p}_1 = \\begin{pmatrix} 7 \\\\ 8 \\end{pmatrix}, \\quad \\vec{p}_2 = \\begin{pmatrix} 0 \\\\ 19 \\end{pmatrix}, \\quad \\vec{p}_3 = \\begin{pmatrix} 14 \\\\ 13 \\end{pmatrix} $$\n\n带噪声的接收密文向量：\n$$ \\vec{c'}_1 = \\begin{pmatrix} 61.3 \\\\ 22.8 \\end{pmatrix}, \\quad \\vec{c'}_2 = \\begin{pmatrix} 94.5 \\\\ 38.1 \\end{pmatrix}, \\quad \\vec{c'}_3 = \\begin{pmatrix} 107.1 \\\\ 40.4 \\end{pmatrix} $$\n\n你的任务是确定最可能的加密矩阵 $K$。为此，你首先需要找到在最小二乘意义下最佳拟合数据的实值 $2 \\times 2$ 矩阵，我们称之为 $K_{ls}$。这意味着需要找到矩阵 $K_{ls}$，以最小化误差向量的欧几里得范数平方和，该和由表达式 $\\sum_{i=1}^{3} \\|\\vec{c'}_i - K_{ls} \\vec{p}_i\\|^2$ 给出。然后，通过将 $K_{ls}$ 的每个元素四舍五入到最近的整数来找到所求的整数矩阵 $K$。\n\n将最终整数矩阵 $K = \\begin{pmatrix} k_{11} & k_{12} \\\\ k_{21} & k_{22} \\end{pmatrix}$ 的四个元素以单行矩阵 $\\begin{pmatrix} k_{11} & k_{12} & k_{21} & k_{22} \\end{pmatrix}$ 的形式给出。", "solution": "我们以矩阵形式对数据进行建模。令 $P \\in \\mathbb{R}^{2 \\times 3}$ 的列为 $\\vec{p}_{1},\\vec{p}_{2},\\vec{p}_{3}$，令 $C' \\in \\mathbb{R}^{2 \\times 3}$ 的列为 $\\vec{c'}_{1},\\vec{c'}_{2},\\vec{c'}_{3}$。最小二乘估计 $K_{ls}$ 最小化弗罗贝尼乌斯范数 $\\|C' - K_{ls}P\\|_{F}^{2}$。此线性最小二乘问题的正规方程组为\n$$\nK_{ls}PP^{T} = C'P^{T},\n$$\n因此，如果 $PP^{T}$ 是可逆的，\n$$\nK_{ls} = C'P^{T}(PP^{T})^{-1}.\n$$\n构造矩阵\n$$\nP = \\begin{pmatrix} 7 & 0 & 14 \\\\ 8 & 19 & 13 \\end{pmatrix}, \\quad\nC' = \\begin{pmatrix} 61.3 & 94.5 & 107.1 \\\\ 22.8 & 38.1 & 40.4 \\end{pmatrix}.\n$$\n计算\n$$\nPP^{T} = \\sum_{i=1}^{3} \\vec{p}_{i}\\vec{p}_{i}^{T}\n= \\begin{pmatrix} 245 & 238 \\\\ 238 & 594 \\end{pmatrix},\n$$\n其行列式为\n$$\n\\det(PP^{T}) = 245 \\cdot 594 - 238 \\cdot 238 = 88886 \\neq 0,\n$$\n所以\n$$\n(PP^{T})^{-1} = \\frac{1}{88886}\\begin{pmatrix} 594 & -238 \\\\ -238 & 245 \\end{pmatrix}.\n$$\n接下来，\n$$\nC'P^{T} = \\sum_{i=1}^{3} \\vec{c'}_{i}\\vec{p}_{i}^{T}\n= \\begin{pmatrix} 1928.5 & 3678.2 \\\\ 725.2 & 1431.5 \\end{pmatrix}.\n$$\n因此\n$$\nK_{ls} = \\left(\\begin{pmatrix} 1928.5 & 3678.2 \\\\ 725.2 & 1431.5 \\end{pmatrix}\n\\begin{pmatrix} 594 & -238 \\\\ -238 & 245 \\end{pmatrix}\\right)\\frac{1}{88886}.\n$$\n计算分子中的乘积：\n$$\n\\begin{pmatrix}\n1928.5 \\cdot 594 + 3678.2 \\cdot (-238) & 1928.5 \\cdot (-238) + 3678.2 \\cdot 245 \\\\\n725.2 \\cdot 594 + 1431.5 \\cdot (-238) & 725.2 \\cdot (-238) + 1431.5 \\cdot 245\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n270217.3 & 442156 \\\\\n90071.8 & 178109.9\n\\end{pmatrix}.\n$$\n因此\n$$\nK_{ls} = \\frac{1}{88886}\\begin{pmatrix}\n270217.3 & 442156 \\\\\n90071.8 & 178109.9\n\\end{pmatrix}\n\\approx\n\\begin{pmatrix}\n3.0400 & 4.9744 \\\\\n1.0133 & 2.0038\n\\end{pmatrix}.\n$$\n将每个元素四舍五入到最近的整数，得到最可能的整数密钥矩阵\n$$\nK = \\begin{pmatrix} 3 & 5 \\\\ 1 & 2 \\end{pmatrix}.\n$$\n作为一个快速的一致性检查，$K\\vec{p}_{1} = \\begin{pmatrix} 61 \\\\ 23 \\end{pmatrix}$, $K\\vec{p}_{2} = \\begin{pmatrix} 95 \\\\ 38 \\end{pmatrix}$，以及 $K\\vec{p}_{3} = \\begin{pmatrix} 107 \\\\ 40 \\end{pmatrix}$，这些结果与接收到的 $\\vec{c'}_{i}$ 很接近，这与存在小噪声的预期相符。", "answer": "$$\\boxed{\\begin{pmatrix} 3 & 5 & 1 & 2 \\end{pmatrix}}$$", "id": "1348664"}, {"introduction": "一个密码系统的强度往往取决于其密钥的随机性和不可预测性。然而，如果密钥的生成过程存在某种结构性缺陷，就可能为密码分析者提供可乘之机。本练习 [@problem_id:1348678] 探讨了一种高级密码分析情景，其中一个大型加密密钥 $K$ 被怀疑是由两个较小的矩阵通过克罗内克积（Kronecker product）构造而成。你将利用克罗内克积的代数性质，特别是 $(A \\otimes B)^{-1} = A^{-1} \\otimes B^{-1}$ 这一重要恒等式，来高效地计算解密密钥 $K^{-1}$。这个问题揭示了抽象的代数结构如何在密码分析中发挥巨大作用，将一个看似复杂的求逆问题分解为几个更简单的子问题。", "problem": "在一次密码分析操作中，您的团队恢复了希尔密码一个变体的 $4 \\times 4$ 加密密钥矩阵 $K$。该密码在一个包含29个字符的字母表上进行操作，将字符映射到 $\\mathbb{Z}_{29}$ 中的整数，其中所有矩阵运算都在模29下进行。一个4字符明文块（表示为 $4 \\times 1$ 的列向量 $P$）的加密由方程 $C = KP$ 给出。\n\n一条情报来源表明，对手的密钥生成协议可能存在缺陷，会产生具有克罗内克积结构的密钥。具体来说，我们怀疑密钥 $K$ 可以分解为 $K = A \\otimes B$，其中 $A$ 和 $B$ 是未知的 $2 \\times 2$ 可逆矩阵，其元素在 $\\mathbb{Z}_{29}$ 中。\n\n恢复的加密密钥为：\n$$ K = \\begin{pmatrix}\n10 & 4 & 15 & 6 \\\\\n4 & 2 & 6 & 3 \\\\\n5 & 2 & 10 & 4 \\\\\n2 & 1 & 4 & 2\n\\end{pmatrix} $$\n\n为开始解密捕获的消息，您的团队需要解密密钥，即逆矩阵 $K^{-1}$。利用关于该密钥潜在结构的信息，确定解密矩阵 $K^{-1}$。", "solution": "我们在域 $\\mathbb{Z}_{29}$ 上进行运算，因为 $29$ 是素数。为了利用可疑的克罗内克积结构，我们将给定的 $4 \\times 4$ 密钥矩阵 $K$ 写成 $2 \\times 2$ 的分块形式：\n$$\nK=\\begin{pmatrix}\nK_{11} & K_{12} \\\\\nK_{21} & K_{22}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\begin{pmatrix}10 & 4 \\\\ 4 & 2\\end{pmatrix} & \\begin{pmatrix}15 & 6 \\\\ 6 & 3\\end{pmatrix} \\\\\n\\begin{pmatrix}5 & 2 \\\\ 2 & 1\\end{pmatrix} & \\begin{pmatrix}10 & 4 \\\\ 4 & 2\\end{pmatrix}\n\\end{pmatrix}.\n$$\n如果 $K=A \\otimes B$ 且 $A,B \\in \\mathrm{GL}_{2}(\\mathbb{Z}_{29})$，则\n$$\nA \\otimes B=\\begin{pmatrix}\na_{11}B & a_{12}B \\\\\na_{21}B & a_{22}B\n\\end{pmatrix}.\n$$\n选择 $B:=K_{21}=\\begin{pmatrix}5 & 2 \\\\ 2 & 1\\end{pmatrix}$。然后确定标量 $a_{ij} \\in \\mathbb{Z}_{29}$ 使得 $K_{ij}=a_{ij}B$：\n$$\nK_{11}=2B,\\quad K_{12}=3B,\\quad K_{21}=1 \\cdot B,\\quad K_{22}=2B.\n$$\n因此\n$$\nA=\\begin{pmatrix}2 & 3 \\\\ 1 & 2\\end{pmatrix},\\qquad B=\\begin{pmatrix}5 & 2 \\\\ 2 & 1\\end{pmatrix},\\qquad K=A \\otimes B.\n$$\n\n因为在 $\\mathbb{Z}_{29}$ 中，$\\det(A)=2\\cdot 2-3\\cdot 1=1$ 且 $\\det(B)=5\\cdot 1-2\\cdot 2=1$，所以 $A$ 和 $B$ 都是可逆的，并且\n$$\n(A \\otimes B)^{-1}=A^{-1} \\otimes B^{-1}.\n$$\n对于域上的一个 $2 \\times 2$ 矩阵 $\\begin{pmatrix}a & b \\\\ c & d\\end{pmatrix}$，其逆矩阵为 $(ad-bc)^{-1}\\begin{pmatrix}d & -b \\\\ -c & a\\end{pmatrix}$。由于行列式等于 $1$，我们有\n$$\nA^{-1}=\\begin{pmatrix}2 & -3 \\\\ -1 & 2\\end{pmatrix}\\equiv \\begin{pmatrix}2 & 26 \\\\ 28 & 2\\end{pmatrix}\\pmod{29},\n$$\n$$\nB^{-1}=\\begin{pmatrix}1 & -2 \\\\ -2 & 5\\end{pmatrix}\\equiv \\begin{pmatrix}1 & 27 \\\\ 27 & 5\\end{pmatrix}\\pmod{29}.\n$$\n因此\n$$\nK^{-1}=A^{-1} \\otimes B^{-1}=\n\\begin{pmatrix}\n2B^{-1} & 26B^{-1} \\\\\n28B^{-1} & 2B^{-1}\n\\end{pmatrix}.\n$$\n在 $\\mathbb{Z}_{29}$ 中计算标量倍数：\n$$\n2B^{-1}=\\begin{pmatrix}2 & 54 \\\\ 54 & 10\\end{pmatrix}\\equiv \\begin{pmatrix}2 & 25 \\\\ 25 & 10\\end{pmatrix},\n$$\n$$\n26B^{-1}=\\begin{pmatrix}26 & 26\\cdot 27 \\\\ 26\\cdot 27 & 26\\cdot 5\\end{pmatrix}\\equiv \\begin{pmatrix}26 & 6 \\\\ 6 & 14\\end{pmatrix},\n$$\n$$\n28B^{-1}=\\begin{pmatrix}28 & 28\\cdot 27 \\\\ 28\\cdot 27 & 28\\cdot 5\\end{pmatrix}\\equiv \\begin{pmatrix}28 & 2 \\\\ 2 & 24\\end{pmatrix}.\n$$\n将这些分块组合起来得到\n$$\nK^{-1}\\equiv\n\\begin{pmatrix}\n2 & 25 & 26 & 6 \\\\\n25 & 10 & 6 & 14 \\\\\n28 & 2 & 2 & 25 \\\\\n2 & 24 & 25 & 10\n\\end{pmatrix}\\pmod{29}.\n$$\n直接乘法检验确认在 $\\mathbb{Z}_{29}$ 中 $K K^{-1}\\equiv I_{4}$，因此这就是解密密钥。", "answer": "$$\\boxed{\\begin{pmatrix}\n2 & 25 & 26 & 6 \\\\\n25 & 10 & 6 & 14 \\\\\n28 & 2 & 2 & 25 \\\\\n2 & 24 & 25 & 10\n\\end{pmatrix}}$$", "id": "1348678"}]}