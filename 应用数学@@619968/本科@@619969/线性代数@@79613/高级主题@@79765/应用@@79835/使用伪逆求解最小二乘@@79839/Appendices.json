{"hands_on_practices": [{"introduction": "在将数学模型应用于现实世界的数据时，我们常常会遇到超定线性系统——即方程的数量多于未知数的数量。计算设计矩阵 $A$ 的伪逆 $A^+$ 是求解这类问题的关键第一步。这个练习将指导你基于一个假设的物理实验场景来构建设计矩阵，并计算其伪逆，让你熟练掌握在矩阵具有满列秩时计算伪逆的核心方法。[@problem_id:1400691]", "problem": "一位实验物理学家正在研究一个新发现的电子元件。他们假设施加的电压 $V$ 与产生的电流 $I$ 之间的关系遵循 $V = c_1 + c_2 I^2$ 形式的模型，其中 $c_1$ 和 $c_2$ 是未知的器件特定参数。为了确定这些参数，该物理学家在三种不同的电流下进行了三次电压测量。测量的电流分别为 $I_1=1$、$I_2=2$ 和 $I_3=3$（单位一致）。\n\n这组测量导出了一个形如 $A\\mathbf{x} = \\mathbf{b}$ 的超定线性方程组，其中 $\\mathbf{x} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$ 包含未知参数，而 $A$ 是根据电流值导出的设计矩阵。参数的最小二乘解可以通过矩阵 $A$ 的摩尔-彭若斯伪逆 $A^+$ 求得。\n\n给定模型和所用的电流值，求设计矩阵 $A$ 的摩尔-彭若斯伪逆 $A^+$。", "solution": "问题要求解与模型 $V = c_1 + c_2 I^2$ 以及在电流 $I=1, 2, 3$ 下进行的测量相关的设计矩阵 $A$ 的摩尔-彭若斯伪逆。\n\n首先，我们构建线性方程组。每次测量 $(I_i, V_i)$ 给出一个方程：\n对于 $I_1=1$：$c_1 \\cdot 1 + c_2 \\cdot 1^2 = V_1 \\implies c_1 + c_2 = V_1$\n对于 $I_2=2$：$c_1 \\cdot 1 + c_2 \\cdot 2^2 = V_2 \\implies c_1 + 4c_2 = V_2$\n对于 $I_3=3$：$c_1 \\cdot 1 + c_2 \\cdot 3^2 = V_3 \\implies c_1 + 9c_2 = V_3$\n\n这个方程组可以写成矩阵形式 $A\\mathbf{x} = \\mathbf{b}$：\n$$\n\\begin{pmatrix} 1 & 1 \\\\ 1 & 4 \\\\ 1 & 9 \\end{pmatrix}\n\\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}\n=\n\\begin{pmatrix} V_1 \\\\ V_2 \\\\ V_3 \\end{pmatrix}\n$$\n因此，设计矩阵 $A$ 是：\n$$\nA = \\begin{pmatrix} 1 & 1 \\\\ 1 & 4 \\\\ 1 & 9 \\end{pmatrix}\n$$\n矩阵 $A$ 是一个 $3 \\times 2$ 矩阵。它的列是线性无关的，所以它具有满列秩。对于一个满列秩的矩阵 $A$，其摩尔-彭若斯伪逆 $A^+$ 由以下公式给出：\n$$\nA^+ = (A^T A)^{-1} A^T\n$$\n我们将分步计算。\n\n步骤1：计算 $A$ 的转置矩阵 $A^T$。\n$$\nA^T = \\begin{pmatrix} 1 & 1 & 1 \\\\ 1 & 4 & 9 \\end{pmatrix}\n$$\n\n步骤2：计算乘积 $A^T A$。\n$$\nA^T A = \\begin{pmatrix} 1 & 1 & 1 \\\\ 1 & 4 & 9 \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\\\ 1 & 4 \\\\ 1 & 9 \\end{pmatrix} = \\begin{pmatrix} (1)(1)+(1)(1)+(1)(1) & (1)(1)+(1)(4)+(1)(9) \\\\ (1)(1)+(4)(1)+(9)(1) & (1)(1)+(4)(4)+(9)(9) \\end{pmatrix}\n$$\n$$\nA^T A = \\begin{pmatrix} 1+1+1 & 1+4+9 \\\\ 1+4+9 & 1+16+81 \\end{pmatrix} = \\begin{pmatrix} 3 & 14 \\\\ 14 & 98 \\end{pmatrix}\n$$\n\n步骤3：计算 $A^T A$ 的逆矩阵。对于一个 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$，其逆矩阵是 $\\frac{1}{ad-bc} \\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$。\n$A^T A$ 的行列式是：\n$$\n\\det(A^T A) = (3)(98) - (14)(14) = 294 - 196 = 98\n$$\n逆矩阵是：\n$$\n(A^T A)^{-1} = \\frac{1}{98} \\begin{pmatrix} 98 & -14 \\\\ -14 & 3 \\end{pmatrix} = \\begin{pmatrix} \\frac{98}{98} & -\\frac{14}{98} \\\\ -\\frac{14}{98} & \\frac{3}{98} \\end{pmatrix} = \\begin{pmatrix} 1 & -\\frac{1}{7} \\\\ -\\frac{1}{7} & \\frac{3}{98} \\end{pmatrix}\n$$\n\n步骤4：计算最终乘积 $A^+ = (A^T A)^{-1} A^T$。\n$$\nA^+ = \\begin{pmatrix} 1 & -\\frac{1}{7} \\\\ -\\frac{1}{7} & \\frac{3}{98} \\end{pmatrix} \\begin{pmatrix} 1 & 1 & 1 \\\\ 1 & 4 & 9 \\end{pmatrix}\n$$\n我们逐个元素进行矩阵乘法：\n元素 (1,1)：$(1)(1) + (-\\frac{1}{7})(1) = 1 - \\frac{1}{7} = \\frac{6}{7}$\n元素 (1,2)：$(1)(1) + (-\\frac{1}{7})(4) = 1 - \\frac{4}{7} = \\frac{3}{7}$\n元素 (1,3)：$(1)(1) + (-\\frac{1}{7})(9) = 1 - \\frac{9}{7} = -\\frac{2}{7}$\n\n元素 (2,1)：$(-\\frac{1}{7})(1) + (\\frac{3}{98})(1) = -\\frac{14}{98} + \\frac{3}{98} = -\\frac{11}{98}$\n元素 (2,2)：$(-\\frac{1}{7})(1) + (\\frac{3}{98})(4) = -\\frac{14}{98} + \\frac{12}{98} = -\\frac{2}{98} = -\\frac{1}{49}$\n元素 (2,3)：$(-\\frac{1}{7})(1) + (\\frac{3}{98})(9) = -\\frac{14}{98} + \\frac{27}{98} = \\frac{13}{98}$\n\n将这些元素组合成矩阵 $A^+$，得到最终结果。\n$$\nA^+ = \\begin{pmatrix} \\frac{6}{7} & \\frac{3}{7} & -\\frac{2}{7} \\\\ -\\frac{11}{98} & -\\frac{1}{49} & \\frac{13}{98} \\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\frac{6}{7} & \\frac{3}{7} & -\\frac{2}{7} \\\\ -\\frac{11}{98} & -\\frac{1}{49} & \\frac{13}{98} \\end{pmatrix}\n}\n$$", "id": "1400691"}, {"introduction": "计算出伪逆矩阵后，它的主要用途是寻找超定系统的“最佳”解，即最小二乘解。这个解能够最小化模型预测与实际观测数据之间的误差平方和。本练习 [@problem_id:1400693] 提供了一个因测量噪声而导致不自洽的线性方程组，让你通过求解正规方程（这等价于使用伪逆）来确定最佳校准常数，从而将理论与实践紧密结合。", "problem": "一位工程师正在校准一种新型传感器，其输出 $S$ 被建模为两个可调输入参数 $p_1$ 和 $p_2$ 的线性函数。理论模型由方程 $S = x_1 p_1 + x_2 p_2$ 给出，其中 $x_1$ 和 $x_2$ 是需要确定的未知校准常数。为了求出这些常数，进行了一系列三次实验，得到以下测量结果：\n\n1.  当 $(p_1, p_2) = (1, 0)$ 时，传感器输出为 $S=1$。\n2.  当 $(p_1, p_2) = (0, 1)$ 时，传感器输出为 $S=2$。\n3.  当 $(p_1, p_2) = (1, 1)$ 时，传感器输出为 $S=2$。\n\n由于测量噪声，这组观测数据为常数 $x_1$ 和 $x_2$ 形成了一个超定且不相容的线性方程组。确定构成该系统最小二乘解的 $x_1$ 和 $x_2$ 的值。\n\n将您的答案表示为列向量 $\\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$。向量中的项必须以精确分数的形式给出。", "solution": "模型为 $S = x_{1} p_{1} + x_{2} p_{2}$。将三次实验结果整理成矩阵形式，可得\n$$\nA = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{pmatrix},\\quad\n\\boldsymbol{x} = \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix},\\quad\n\\boldsymbol{b} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix},\n$$\n因此系统为 $A \\boldsymbol{x} = \\boldsymbol{b}$，这是一个超定系统。最小二乘解使 $\\|A \\boldsymbol{x} - \\boldsymbol{b}\\|^{2}$ 最小化，并满足正规方程\n$$\nA^{\\top} A \\boldsymbol{x} = A^{\\top} \\boldsymbol{b}.\n$$\n计算\n$$\nA^{\\top} A = \\begin{pmatrix} 1 & 0 & 1 \\\\ 0 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{pmatrix} = \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix},\n\\quad\nA^{\\top} \\boldsymbol{b} = \\begin{pmatrix} 1 & 0 & 1 \\\\ 0 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}.\n$$\n因此，正规方程为\n$$\n\\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix},\n$$\n即，\n$$\n\\begin{cases}\n2 x_{1} + x_{2} = 3, \\\\\nx_{1} + 2 x_{2} = 4.\n\\end{cases}\n$$\n由第一个方程可得，$x_{2} = 3 - 2 x_{1}$。代入第二个方程：\n$$\nx_{1} + 2(3 - 2 x_{1}) = 4 \\;\\Rightarrow\\; x_{1} + 6 - 4 x_{1} = 4 \\;\\Rightarrow\\; -3 x_{1} = -2 \\;\\Rightarrow\\; x_{1} = \\frac{2}{3}.\n$$\n则\n$$\nx_{2} = 3 - 2 \\cdot \\frac{2}{3} = 3 - \\frac{4}{3} = \\frac{5}{3}.\n$$\n因此，最小二乘解为\n$$\n\\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{5}{3} \\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{5}{3} \\end{pmatrix}}$$", "id": "1400693"}, {"introduction": "伪逆是矩阵逆的一种强大推广，但我们必须谨慎，不能理所当然地认为逆矩阵的所有代数性质都适用于伪逆。这个练习通过一个具体的反例，探讨了著名的“反序律”——即 $(AB)^{-1} = B^{-1}A^{-1}$——是否适用于伪逆。通过亲自计算并验证 $(AB)^+ \\ne B^+A^+$ [@problem_id:1400678]，你将对伪逆的独特性质有更深刻的理解，并学会以批判性的眼光审视数学概念的推广。", "problem": "在线性代数中，对于任意一对同阶可逆方阵 $X$ 和 $Y$，其乘积的逆矩阵遵循逆序定律：$(XY)^{-1} = Y^{-1}X^{-1}$。对于任意矩阵（不一定是方阵或可逆矩阵），矩阵求逆的一个推广是 Moore-Penrose 伪逆，用上标“+”表示。一个自然的问题是：逆序定律对伪逆也成立吗？也就是说，对于任意一对乘积 $AB$ 有定义的矩阵 $A$ 和 $B$，等式 $(AB)^+ = B^+A^+$ 是否成立？\n\n本题要求您通过一对特定的奇异矩阵来研究这个问题。考虑以下给出的实 $2 \\times 2$ 矩阵：\n$$A = \\begin{pmatrix} 1 & 1 \\\\ 0 & 0 \\end{pmatrix} \\quad \\text{和} \\quad B = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}$$\n\n为了进行计算，您可以不加证明地使用 Moore-Penrose 伪逆的以下性质：\n1. 对于一个可以写成两个非零列向量 $u$ 和 $v$ 的外积（即 $M=uv^T$）的秩为 1 的矩阵 $M$，其伪逆由 $M^+ = \\frac{1}{\\|u\\|_2^2 \\|v\\|_2^2} v u^T$ 给出，其中 $\\| \\cdot \\|_2$ 表示标准的欧几里得范数。\n2. 对于一个对称（$M^T = M$）且幂等（$M^2 = M$）的实矩阵 $M$，其伪逆就是它本身，即 $M^+ = M$。\n\n计算差分矩阵 $D = (AB)^+ - B^+A^+$。$D$ 的所有元素之和是多少？", "solution": "问题要求计算差分矩阵 $D = (AB)^+ - B^+A^+$ 的所有元素之和。我们需要分别计算 $(AB)^+$ 和 $B^+A^+$ 这两项。这涉及到求 $A$ 和 $B$ 的伪逆，以及它们的乘积 $AB$。\n\n首先，我们求矩阵 $A = \\begin{pmatrix} 1 & 1 \\\\ 0 & 0 \\end{pmatrix}$ 的伪逆。\n矩阵 $A$ 是一个秩为 1 的矩阵。我们可以将其表示为外积 $uv^T$。我们可以看到，第一行是 $\\begin{pmatrix} 1 & 1 \\end{pmatrix}$，第二行全是零。各列都是 $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 的倍数。我们选择 $u = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。那么我们需要一个向量 $v$ 使得 $uv^T = A$。\n设 $v = \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix}$。那么 $uv^T = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} v_1 & v_2 \\end{pmatrix} = \\begin{pmatrix} v_1 & v_2 \\\\ 0 & 0 \\end{pmatrix}$。\n将其与 $A$ 比较，我们看到必须有 $v_1=1$ 和 $v_2=1$。所以，我们可以将 $A$ 写成 $A = uv^T$ 的形式，其中 $u = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，$v = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n现在我们使用给定的秩为 1 矩阵的伪逆公式：$A^+ = \\frac{1}{\\|u\\|_2^2 \\|v\\|_2^2} v u^T$。\n首先，我们计算范数的平方：\n$\\|u\\|_2^2 = 1^2 + 0^2 = 1$。\n$\\|v\\|_2^2 = 1^2 + 1^2 = 2$。\n现在，我们可以计算 $A^+$：\n$$A^+ = \\frac{1}{1 \\cdot 2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1 \\cdot 1 & 1 \\cdot 0 \\\\ 1 \\cdot 1 & 1 \\cdot 0 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1 & 0 \\\\ 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1/2 & 0 \\\\ 1/2 & 0 \\end{pmatrix}$$\n\n接下来，我们求矩阵 $B = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}$ 的伪逆。\n我们可以使用提供的第二个性质。我们来检查 $B$ 是否是对称和幂等的。\n对称性：$B^T = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}^T = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} = B$。所以，$B$ 是对称的。\n幂等性：$B^2 = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + 0 \\cdot 0 & 1 \\cdot 0 + 0 \\cdot 0 \\\\ 0 \\cdot 1 + 0 \\cdot 0 & 0 \\cdot 0 + 0 \\cdot 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} = B$。所以，$B$ 是幂等的。\n由于 $B$ 既是对称的又是幂等的，它的伪逆就是它本身：\n$$B^+ = B = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}$$\n\n现在我们可以计算乘积 $B^+A^+$：\n$$B^+A^+ = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1/2 & 0 \\\\ 1/2 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot (1/2) + 0 \\cdot (1/2) & 1 \\cdot 0 + 0 \\cdot 0 \\\\ 0 \\cdot (1/2) + 0 \\cdot (1/2) & 0 \\cdot 0 + 0 \\cdot 0 \\end{pmatrix} = \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 0 \\end{pmatrix}$$\n\n下一步是计算 $(AB)^+$。首先，我们必须求出乘积 $AB$：\n$$AB = \\begin{pmatrix} 1 & 1 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + 1 \\cdot 0 & 1 \\cdot 0 + 1 \\cdot 0 \\\\ 0 \\cdot 1 + 0 \\cdot 0 & 0 \\cdot 0 + 0 \\cdot 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}$$\n我们看到乘积 $AB$ 等于矩阵 $B$。因此，该乘积的伪逆就是 $B$ 的伪逆：\n$$(AB)^+ = B^+ = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}$$\n\n最后，我们计算差分矩阵 $D = (AB)^+ - B^+A^+$：\n$$D = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} - \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 - 1/2 & 0 - 0 \\\\ 0 - 0 & 0 - 0 \\end{pmatrix} = \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 0 \\end{pmatrix}$$\n附带说明，由于 $D$ 不是零矩阵，我们已经证明了对于我们所选的 $A$ 和 $B$，$(AB)^+ \\ne B^+A^+$。\n\n问题要求的是 $D$ 的所有元素之和。\n元素之和 = $\\frac{1}{2} + 0 + 0 + 0 = \\frac{1}{2}$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1400678"}]}