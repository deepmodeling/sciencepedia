{"hands_on_practices": [{"introduction": "在科学和工程领域，我们经常需要用一个理论模型来拟合充满噪声的实验数据。这个问题将引导你完成一个典型的数据拟合任务，这是最小二乘法最直接和最常见的应用之一。通过解决这个练习 [@problem_id:1378919]，你将学习如何将一组数据点和一个理论模型转化为矩阵方程 $A\\mathbf{x} = \\mathbf{b}$，并求解相应的法方程来找到最佳拟合参数。", "problem": "一位实验物理学家正在研究一个亚原子粒子在对称势场影响下的行为。一个理论模型表明，该粒子的能量 $E$ 与一个可调的实验参数 $q$ 之间应满足方程 $E(q) = c_1 + c_2 q^2$，其中 $c_1$ 和 $c_2$ 是与粒子内禀属性及其与场的相互作用相关的常数。为了确定这些常数，这位物理学家进行了一项实验，并记录了四对数据 $(q, E)$：\n$(-2, 5)$、$(-1, 2)$、$(1, 1)$ 和 $(2, 4)$。\n\n由于不可避免的实验噪声，这些数据点并不完全位于形式为 $E(q) = c_1 + c_2 q^2$ 的单条曲线上。你的任务是为该模型找到最能代表所收集数据的参数值。“最佳”模型的定义是使测量能量值与模型预测能量值之间纵轴差异的平方和最小化的模型。\n\n确定定义此最佳拟合模型的系数有序对 $(c_1, c_2)$。", "solution": "问题要求我们找到模型 $E(q) = c_1 + c_2 q^2$ 的系数 $c_1$ 和 $c_2$，使其在最小二乘意义上最佳拟合给定的数据点。这等价于求解一个超定线性方程组的最小二乘解。\n\n首先，我们将每个数据点 $(q_i, E_i)$ 代入模型方程，建立线性方程组。对于未知系数向量 $\\mathbf{x} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$，我们希望求解方程组 $A\\mathbf{x} = \\mathbf{b}$，其中 $\\mathbf{b}$ 是观测到的能量值向量。\n\n对于点 $(-2, 5)$：$c_1 + c_2(-2)^2 = c_1 + 4c_2 = 5$\n对于点 $(-1, 2)$：$c_1 + c_2(-1)^2 = c_1 + c_2 = 2$\n对于点 $(1, 1)$：$c_1 + c_2(1)^2 = c_1 + c_2 = 1$\n对于点 $(2, 4)$：$c_1 + c_2(2)^2 = c_1 + 4c_2 = 4$\n\n这个方程组可以写成矩阵形式 $A\\mathbf{x} = \\mathbf{b}$：\n$$\n\\begin{pmatrix}\n1 & 4 \\\\\n1 & 1 \\\\\n1 & 1 \\\\\n1 & 4\n\\end{pmatrix}\n\\begin{pmatrix}\nc_1 \\\\\nc_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n5 \\\\\n2 \\\\\n1 \\\\\n4\n\\end{pmatrix}\n$$\n这里，矩阵 $A$ 是设计矩阵，$\\mathbf{x} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$ 是参数向量，$\\mathbf{b}$ 是观测向量。\n$$\nA = \\begin{pmatrix}\n1 & 4 \\\\\n1 & 1 \\\\\n1 & 1 \\\\\n1 & 4\n\\end{pmatrix}, \\quad \\mathbf{x} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 5 \\\\ 2 \\\\ 1 \\\\ 4 \\end{pmatrix}\n$$\n正如问题所述，这个方程组是不相容的。最小化误差平方和 $\\|A\\hat{\\mathbf{x}} - \\mathbf{b}\\|^2$ 的最小二乘解 $\\hat{\\mathbf{x}}$ 可以通过求解正规方程组得到：\n$$ A^T A \\hat{\\mathbf{x}} = A^T \\mathbf{b} $$\n首先，我们计算矩阵 $A^T A$：\n$$\nA^T A = \\begin{pmatrix}\n1 & 1 & 1 & 1 \\\\\n4 & 1 & 1 & 4\n\\end{pmatrix}\n\\begin{pmatrix}\n1 & 4 \\\\\n1 & 1 \\\\\n1 & 1 \\\\\n1 & 4\n\\end{pmatrix}\n= \\begin{pmatrix}\n1 \\cdot 1 + 1 \\cdot 1 + 1 \\cdot 1 + 1 \\cdot 1 & 1 \\cdot 4 + 1 \\cdot 1 + 1 \\cdot 1 + 1 \\cdot 4 \\\\\n4 \\cdot 1 + 1 \\cdot 1 + 1 \\cdot 1 + 4 \\cdot 1 & 4 \\cdot 4 + 1 \\cdot 1 + 1 \\cdot 1 + 4 \\cdot 4\n\\end{pmatrix}\n= \\begin{pmatrix}\n4 & 10 \\\\\n10 & 34\n\\end{pmatrix}\n$$\n接下来，我们计算向量 $A^T \\mathbf{b}$：\n$$\nA^T \\mathbf{b} = \\begin{pmatrix}\n1 & 1 & 1 & 1 \\\\\n4 & 1 & 1 & 4\n\\end{pmatrix}\n\\begin{pmatrix}\n5 \\\\\n2 \\\\\n1 \\\\\n4\n\\end{pmatrix}\n= \\begin{pmatrix}\n1 \\cdot 5 + 1 \\cdot 2 + 1 \\cdot 1 + 1 \\cdot 4 \\\\\n4 \\cdot 5 + 1 \\cdot 2 + 1 \\cdot 1 + 4 \\cdot 4\n\\end{pmatrix}\n= \\begin{pmatrix}\n12 \\\\\n39\n\\end{pmatrix}\n$$\n现在我们求解方程组 $A^T A \\hat{\\mathbf{x}} = A^T \\mathbf{b}$：\n$$\n\\begin{pmatrix}\n4 & 10 \\\\\n10 & 34\n\\end{pmatrix}\n\\begin{pmatrix}\nc_1 \\\\\nc_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n12 \\\\\n39\n\\end{pmatrix}\n$$\n这对应于以下两个线性方程组成的方程组：\n1) $4c_1 + 10c_2 = 12$\n2) $10c_1 + 34c_2 = 39$\n\n我们可以将第一个方程两边除以 2 来简化：\n$2c_1 + 5c_2 = 6$\n由此，我们可以用 $c_2$ 表示 $c_1$：\n$2c_1 = 6 - 5c_2 \\implies c_1 = 3 - \\frac{5}{2}c_2$\n\n将这个 $c_1$ 的表达式代入第二个方程：\n$10(3 - \\frac{5}{2}c_2) + 34c_2 = 39$\n$30 - 25c_2 + 34c_2 = 39$\n$9c_2 = 9$\n$c_2 = 1$\n\n现在，将 $c_2$ 的值代回 $c_1$ 的表达式中：\n$c_1 = 3 - \\frac{5}{2}(1) = 3 - \\frac{5}{2} = \\frac{6}{2} - \\frac{5}{2} = \\frac{1}{2}$\n\n或者，我们可以对增广矩阵使用高斯消元法：\n$$\n\\left[ \\begin{array}{cc|c} 4 & 10 & 12 \\\\ 10 & 34 & 39 \\end{array} \\right]\n$$\n将第一行除以 2：\n$$\n\\left[ \\begin{array}{cc|c} 2 & 5 & 6 \\\\ 10 & 34 & 39 \\end{array} \\right]\n$$\n将第二行替换为 $R_2 - 5R_1$：\n$$\n\\left[ \\begin{array}{cc|c} 2 & 5 & 6 \\\\ 10 - 5(2) & 34 - 5(5) & 39 - 5(6) \\end{array} \\right] = \\left[ \\begin{array}{cc|c} 2 & 5 & 6 \\\\ 0 & 9 & 9 \\end{array} \\right]\n$$\n从第二行，我们得到 $9c_2 = 9$，即 $c_2 = 1$。\n将 $c_2 = 1$ 代入第一行方程 $2c_1 + 5c_2 = 6$：\n$2c_1 + 5(1) = 6 \\implies 2c_1 = 1 \\implies c_1 = \\frac{1}{2}$。\n\n最佳拟合模型的系数是 $c_1 = 1/2$ 和 $c_2 = 1$。有序对是 $(1/2, 1)$。", "answer": "$$\\boxed{(\\frac{1}{2}, 1)}$$", "id": "1378919"}, {"introduction": "在第一个练习中，我们经历了求解法方程的完整计算过程。现在，让我们来探讨一个理论上更简洁的特殊情况。这个练习 [@problem_id:1378910] 揭示了当设计矩阵 $A$ 的列向量构成一个标准正交集时，最小二乘问题会变得异常简单。这个推导将加深你对正交性威力的理解，并让你从几何角度更深刻地领悟最小二乘解的投影本质。", "problem": "考虑一个标准的最小二乘问题，其目标是求不相容线性方程组 $A\\mathbf{x} = \\mathbf{b}$ 的一个近似解。设 $A$ 是一个 $m \\times n$ ($m > n$) 的实矩阵，$\\mathbf{b}$ 是 $\\mathbb{R}^m$ 中的一个向量。矩阵 $A$ 的列向量，我们记为 $\\mathbf{u}_1, \\mathbf{u}_2, \\dots, \\mathbf{u}_n$，已知它们构成一个标准正交集。最小二乘解（记为 $\\hat{\\mathbf{x}}$）是 $\\mathbb{R}^n$ 中使欧几里得范数 $\\|A\\mathbf{x} - \\mathbf{b}\\|$ 最小化的向量。向量 $\\hat{\\mathbf{b}} = A\\hat{\\mathbf{x}}$ 表示 $\\mathbf{b}$ 在 $A$ 的列空间上的正交投影。\n\n你的任务是在 $A$ 的列向量是标准正交的特定条件下，推导投影向量 $\\hat{\\mathbf{b}}$ 关于矩阵 $A$ 和向量 $\\mathbf{b}$ 的简化闭式表达式。", "solution": "我们考虑一个不相容方程组 $A\\mathbf{x}=\\mathbf{b}$ 的最小二乘问题，其中 $A\\in\\mathbb{R}^{m\\times n}$，$m>n$，且其列向量 $\\mathbf{u}_{1},\\dots,\\mathbf{u}_{n}$ 是标准正交的。标准正交性意味着\n$$\nA^{T}A=I_{n}.\n$$\n最小二乘解 $\\hat{\\mathbf{x}}$ 满足正规方程组\n$$\nA^{T}A\\,\\hat{\\mathbf{x}}=A^{T}\\mathbf{b}.\n$$\n利用 $A^{T}A=I_{n}$，我们得到\n$$\n\\hat{\\mathbf{x}}=(A^{T}A)^{-1}A^{T}\\mathbf{b}=I_{n}^{-1}A^{T}\\mathbf{b}=A^{T}\\mathbf{b}.\n$$\n$\\mathbf{b}$ 在 $A$ 的列空间上的投影是\n$$\n\\hat{\\mathbf{b}}=A\\hat{\\mathbf{x}}=A\\left(A^{T}\\mathbf{b}\\right)=AA^{T}\\mathbf{b}.\n$$\n等价地，由于 $A$ 的列向量构成一个标准正交集，到 $\\operatorname{col}(A)$ 上的投影矩阵是 $P=AA^{T}$，这会得到相同的表达式。", "answer": "$$\\boxed{AA^{T}\\mathbf{b}}$$", "id": "1378910"}, {"introduction": "最小二乘解总是唯一的吗？这个思想实验将引导我们探讨这个关键问题。当设计矩阵 $A$ 的列向量线性相关时，我们会得到无穷多个最小二乘解向量 $\\hat{\\mathbf{x}}$。这个练习 [@problem_id:14459] 旨在阐明一个微妙但至关重要的概念：即使解向量 $\\hat{\\mathbf{x}}$ 不唯一，其在 $A$ 的列空间上的投影 $A\\hat{\\mathbf{x}}$ 却是唯一的。", "problem": "考虑一个线性方程组 $A\\mathbf{x} = \\mathbf{b}$，其中 $A$ 是一个 $m \\times n$ 的实矩阵，$\\mathbf{x}$ 是 $\\mathbb{R}^n$ 中的一个向量，$\\mathbf{b}$ 是 $\\mathbb{R}^m$ 中的一个向量。一般而言，该方程组可能没有精确解。最小二乘法旨在寻找一个向量 $\\hat{\\mathbf{x}}$，以最小化残差的欧几里得范数的平方 $\\|A\\mathbf{x} - \\mathbf{b}\\|^2$。\n\n一个向量 $\\hat{\\mathbf{x}}$ 是最小二乘解，当且仅当它满足**正规方程**：\n$$\nA^T A \\hat{\\mathbf{x}} = A^T \\mathbf{b}\n$$\n最小二乘解的集合可能包含单个向量或无穷多个向量。\n\n假设给定一个特定的系统 $A\\mathbf{x} = \\mathbf{b}$ 至少有两个不同的最小二乘解。设 $\\hat{\\mathbf{x}}_1$ 和 $\\hat{\\mathbf{x}}_2$ 是两个这样的不同解，即 $\\hat{\\mathbf{x}}_1 \\neq \\hat{\\mathbf{x}}_2$。\n\n你的任务是推导向量差 $A\\hat{\\mathbf{x}}_1 - A\\hat{\\mathbf{x}}_2$ 的范数值。也就是说，计算 $\\|A(\\hat{\\mathbfx}_1 - \\hat{\\mathbf{x}}_2)\\|$。", "solution": "设 $\\hat{\\mathbf{x}}_1$ 和 $\\hat{\\mathbf{x}}_2$ 是系统 $A\\mathbf{x} = \\mathbf{b}$ 的两个不同最小二乘解。\n\n根据定义，任何最小二乘解都必须满足正规方程：\n$$\nA^T A \\hat{\\mathbf{x}} = A^T \\mathbf{b}\n$$\n由于 $\\hat{\\mathbf{x}}_1$ 和 $\\hat{\\mathbf{x}}_2$ 都是最小二乘解，它们都必须满足此方程。\n\n对于 $\\hat{\\mathbf{x}}_1$，我们有：\n$$\nA^T A \\hat{\\mathbf{x}}_1 = A^T \\mathbf{b} \\quad (*)\n$$\n对于 $\\hat{\\mathbf{x}}_2$，我们有：\n$$\nA^T A \\hat{\\mathbf{x}}_2 = A^T \\mathbf{b} \\quad (**)\n$$\n现在，我们将方程 $(**)$ 从方程 $(*)$ 中减去：\n$$\nA^T A \\hat{\\mathbf{x}}_1 - A^T A \\hat{\\mathbf{x}}_2 = A^T \\mathbf{b} - A^T \\mathbf{b}\n$$\n使用矩阵乘法的分配律，我们可以从左侧提取公因式 $A^T A$：\n$$\nA^T A (\\hat{\\mathbf{x}}_1 - \\hat{\\mathbf{x}}_2) = \\mathbf{0}\n$$\n其中 $\\mathbf{0}$ 是 $\\mathbb{R}^n$ 中的零向量。\n\n我们要求解 $\\|A(\\hat{\\mathbf{x}}_1 - \\hat{\\mathbf{x}}_2)\\|$ 的值。让我们定义一个新向量 $\\mathbf{v} = \\hat{\\mathbf{x}}_1 - \\hat{\\mathbf{x}}_2$。由于 $\\hat{\\mathbf{x}}_1$ 和 $\\hat{\\mathbf{x}}_2$ 是不同的，所以 $\\mathbf{v} \\neq \\mathbf{0}$。上述方程变为：\n$$\nA^T A \\mathbf{v} = \\mathbf{0}\n$$\n我们希望计算的范数是 $\\|A\\mathbf{v}\\|$。让我们考虑该范数的平方，它由向量与自身的点积给出：\n$$\n\\|A\\mathbf{v}\\|^2 = (A\\mathbf{v})^T (A\\mathbf{v})\n$$\n使用转置的性质 $(XY)^T = Y^T X^T$，我们得到：\n$$\n\\|A\\mathbf{v}\\|^2 = (\\mathbf{v}^T A^T) (A\\mathbf{v})\n$$\n根据矩阵乘法的结合律，我们可以重新组合各项：\n$$\n\\|A\\mathbf{v}\\|^2 = \\mathbf{v}^T (A^T A \\mathbf{v})\n$$\n从我们由正规方程推导出的结果可知，$A^T A \\mathbf{v} = \\mathbf{0}$。将此代入范数平方的表达式中：\n$$\n\\|A\\mathbf{v}\\|^2 = \\mathbf{v}^T (\\mathbf{0})\n$$\n任何向量与零向量的点积为零：\n$$\n\\|A\\mathbf{v}\\|^2 = 0\n$$\n一个向量的范数为零，当且仅当该向量本身是零向量。因此，对两边取平方根可得：\n$$\n\\|A\\mathbf{v}\\| = 0\n$$\n将 $\\mathbf{v} = \\hat{\\mathbf{x}}_1 - \\hat{\\mathbf{x}}_2$ 代回表达式，我们得到最终结果：\n$$\n\\|A(\\hat{\\mathbf{x}}_1 - \\hat{\\mathbf{x}}_2)\\| = 0\n$$", "answer": "$$\\boxed{0}$$", "id": "14459"}]}