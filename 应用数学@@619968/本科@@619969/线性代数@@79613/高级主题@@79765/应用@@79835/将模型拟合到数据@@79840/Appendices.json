{"hands_on_practices": [{"introduction": "在数据科学和工程领域，我们经常需要构建模型来拟合观测数据。最小二乘法是实现这一目标的核心工具。此练习将引导你实践一项重要的数据预处理技术——中心化，即减去自变量的均值，这不仅能简化计算，还能揭示模型参数之间更清晰的关系。[@problem_id:1362186]", "problem": "一名工程专业的学生正在校准一个定制的温度传感器。该传感器产生的电压预期与温度呈线性相关。为了简化拟合的统计分析，该学生决定使用一个中心化的自变量。他们收集了以下四个数据点，其中 $T$ 是以摄氏度为单位的温度，$V$ 是以伏特为单位的相应电压输出：\n\n- $(T_1, V_1) = (10, 2)$\n- $(T_2, V_2) = (20, 3)$\n- $(T_3, V_3) = (30, 4)$\n- $(T_4, V_4) = (40, 5)$\n\n首先，该学生根据给定数据计算平均温度 $\\bar{T}$。然后，他们定义了一个新的中心化温度变量 $x = T - \\bar{T}$。该学生提出了一个形式如下的线性模型：\n\n$$V = c_0 + c_1 x$$\n\n您的任务是找到系数 $c_0$ 和 $c_1$，这些系数在最小二乘意义下定义了电压 $V$ 和中心化温度 $x$ 之间关系的最佳拟合直线。\n\n确定数对 $(c_0, c_1)$ 的值。在本分析中，系数 $c_0$ 和 $c_1$ 被视为无量纲。请用精确分数表示您的答案。将您的最终答案表示为 $(c_0, c_1)$ 的行矩阵。", "solution": "使用 $\\bar{T} = \\frac{1}{n}\\sum_{i=1}^{n}T_{i}$ 计算平均温度，其中 $n=4$：\n$$\n\\bar{T} = \\frac{10+20+30+40}{4} = 25.\n$$\n定义中心化变量 $x_{i} = T_{i} - \\bar{T}$，得到\n$$\nx_{1} = -15,\\quad x_{2} = -5,\\quad x_{3} = 5,\\quad x_{4} = 15.\n$$\n我们通过最小二乘法拟合线性模型 $V = c_{0} + c_{1}x$，即最小化\n$$\nS(c_{0},c_{1}) = \\sum_{i=1}^{4}\\left(V_{i} - c_{0} - c_{1}x_{i}\\right)^{2}.\n$$\n将偏导数设为零，得到正规方程：\n$$\n\\sum_{i=1}^{4}\\left(V_{i} - c_{0} - c_{1}x_{i}\\right) = 0,\\qquad \\sum_{i=1}^{4}x_{i}\\left(V_{i} - c_{0} - c_{1}x_{i}\\right) = 0.\n$$\n由于 $x$ 是中心化的，所以 $\\sum_{i=1}^{4}x_{i} = 0$。第一个正规方程简化为\n$$\n\\sum_{i=1}^{4}V_{i} - 4c_{0} = 0 \\;\\;\\Rightarrow\\;\\; c_{0} = \\bar{V},\n$$\n其中 $\\bar{V} = \\frac{1}{4}\\sum_{i=1}^{4}V_{i}$。计算 $\\bar{V}$：\n$$\n\\bar{V} = \\frac{2+3+4+5}{4} = \\frac{14}{4} = \\frac{7}{2}.\n$$\n第二个正规方程变为\n$$\n\\sum_{i=1}^{4}x_{i}\\left(V_{i} - \\bar{V}\\right) - c_{1}\\sum_{i=1}^{4}x_{i}^{2} = 0 \\;\\;\\Rightarrow\\;\\; c_{1} = \\frac{\\sum_{i=1}^{4}x_{i}\\left(V_{i} - \\bar{V}\\right)}{\\sum_{i=1}^{4}x_{i}^{2}}.\n$$\n精确计算分子和分母：\n$$\nV_{i} - \\bar{V} \\in \\left\\{-\\frac{3}{2}, -\\frac{1}{2}, \\frac{1}{2}, \\frac{3}{2}\\right\\},\\quad \\sum_{i=1}^{4}x_{i}\\left(V_{i} - \\bar{V}\\right) = (-15)\\left(-\\frac{3}{2}\\right) + (-5)\\left(-\\frac{1}{2}\\right) + 5\\left(\\frac{1}{2}\\right) + 15\\left(\\frac{3}{2}\\right) = 50,\n$$\n$$\n\\sum_{i=1}^{4}x_{i}^{2} = (-15)^{2} + (-5)^{2} + 5^{2} + 15^{2} = 225 + 25 + 25 + 225 = 500.\n$$\n因此，\n$$\nc_{1} = \\frac{50}{500} = \\frac{1}{10},\\qquad c_{0} = \\frac{7}{2}.\n$$\n因此，最小二乘系数为 $(c_{0}, c_{1}) = \\left(\\frac{7}{2}, \\frac{1}{10}\\right)$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{7}{2} & \\frac{1}{10}\\end{pmatrix}}$$", "id": "1362186"}, {"introduction": "最小二乘拟合的精髓并不仅仅在于代数计算，更在于其深刻的几何意义。最佳拟合模型可以被看作是数据向量在模型所定义的子空间上的一个投影，而误差向量正是原始数据与该投影之间的差。通过本练习，你将亲手计算这个关键的误差向量，并体会其与模型列空间的正交性——这是“最佳”一词的几何本质。[@problem_id:1362224]", "problem": "一位工程师正在对施加于一个部件的应力 $x$ 与其产生的形变 $y$ 之间的关系进行建模。根据理论考虑，预期的关系形式为 $y = c_0 + c_1 x^2$，其中 $c_0$ 和 $c_1$ 是模型参数。为确定这些参数，进行了四次实验测量，得到数据点 $(x_i, y_i)$:\n$$(0, 1), (1, 2), (2, 6), (3, 10)$$\n该工程师决定使用最小二乘法来寻找最佳拟合参数 $c_0$ 和 $c_1$。误差向量 $\\mathbf{e}$ 定义为观测值向量 $\\mathbf{y}$ 与最小二乘模型预测值向量 $\\mathbf{y}_{\\text{pred}}$ 之间的差。\n\n计算误差向量 $\\mathbf{e}$ 的四个分量，这些分量按给定数据点的顺序对应。将每个分量表示为最简形式的精确分数。", "solution": "模型为 $y=c_{0}+c_{1}x^{2}$。对于数据点 $(x_{i},y_{i})$ 为 $(0,1)$、$(1,2)$、$(2,6)$、$(3,10)$，定义 $z_{i}=x_{i}^{2}$ 和设计矩阵\n$$\nA=\\begin{pmatrix}\n1 & 0\\\\\n1 & 1\\\\\n1 & 4\\\\\n1 & 9\n\\end{pmatrix},\\qquad\n\\mathbf{y}=\\begin{pmatrix}\n1\\\\\n2\\\\\n6\\\\\n10\n\\end{pmatrix}.\n$$\n最小二乘估计 $\\hat{\\mathbf{c}}=(c_{0},c_{1})^{T}$ 满足正规方程 $(A^{T}A)\\hat{\\mathbf{c}}=A^{T}\\mathbf{y}$。计算各组成部分：\n$$\nA^{T}A=\\begin{pmatrix}\n\\sum 1 & \\sum z_{i}\\\\\n\\sum z_{i} & \\sum z_{i}^{2}\n\\end{pmatrix}\n=\\begin{pmatrix}\n4 & 14\\\\\n14 & 98\n\\end{pmatrix},\\qquad\nA^{T}\\mathbf{y}=\\begin{pmatrix}\n\\sum y_{i}\\\\\n\\sum z_{i}y_{i}\n\\end{pmatrix}\n=\\begin{pmatrix}\n19\\\\\n116\n\\end{pmatrix}.\n$$\n对于一个对称 $2\\times 2$ 矩阵 $\\begin{pmatrix}a & b\\\\ b & d\\end{pmatrix}$，其逆矩阵为 $\\frac{1}{ad-b^{2}}\\begin{pmatrix}d & -b\\\\ -b & a\\end{pmatrix}$。此处，行列式为\n$$\n\\det(A^{T}A)=4\\cdot 98-14^{2}=196.\n$$\n因此\n$$\n\\hat{\\mathbf{c}}=(A^{T}A)^{-1}A^{T}\\mathbf{y}\n=\\frac{1}{196}\\begin{pmatrix}\n98 & -14\\\\\n-14 & 4\n\\end{pmatrix}\\begin{pmatrix}\n19\\\\\n116\n\\end{pmatrix}\n=\\frac{1}{196}\\begin{pmatrix}\n98\\cdot 19-14\\cdot 116\\\\\n-14\\cdot 19+4\\cdot 116\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\frac{17}{14} \\\\\n\\frac{99}{98}\n\\end{pmatrix}.\n$$\n因此，拟合模型为 $y_{\\text{pred}}= \\frac{17}{14}+\\frac{99}{98}x^{2}$。误差向量为 $\\mathbf{e}=\\mathbf{y}-\\mathbf{y}_{\\text{pred}}$，其对于 $x=0,1,2,3$ 的分量为\n$$\ne_{1}=1-\\frac{17}{14}=-\\frac{3}{14},\\qquad\ne_{2}=2-\\left(\\frac{17}{14}+\\frac{99}{98}\\right)=-\\frac{11}{49},\n$$\n$$\ne_{3}=6-\\left(\\frac{17}{14}+4\\cdot\\frac{99}{98}\\right)=\\frac{73}{98},\\qquad\ne_{4}=10-\\left(\\frac{17}{14}+9\\cdot\\frac{99}{98}\\right)=-\\frac{15}{49}.\n$$\n这些结果满足正规方程的正交性检验 $\\sum e_{i}=0$ 和 $\\sum z_{i}e_{i}=0$，从而证实了一致性。", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{3}{14} & -\\frac{11}{49} & \\frac{73}{98} & -\\frac{15}{49}\\end{pmatrix}}$$", "id": "1362224"}, {"introduction": "理论模型常常需要满足特定的物理或设计约束，这在实际应用中非常普遍。一个强大的建模方法必须能够灵活地将这些先验知识融入其中。这个练习模拟了一个带有约束条件的校准问题，即拟合曲线必须精确通过一个已知点，它将向你展示如何调整标准的最小二乘法框架来解决这类实际问题。[@problem_id:1362173]", "problem": "一位工程师正在校准一个新型温度传感器。该传感器的输出电压 $V$（单位为伏特）在理论上被建模为温度 $T$（单位为摄氏度）的二次函数。该关系由方程 $V(T) = aT^2 + bT + c$ 给出，其中 $a$、$b$ 和 $c$ 是待确定的常数系数。\n\n根据传感器的设计规格，已知在温度 $T=0^\\circ\\text{C}$ 时，传感器产生 $V=5$ 伏特的基准输出。为了确定其他系数，该工程师进行了以下四次精确测量：\n\n- 在 $T=1^\\circ\\text{C}$ 时，$V=8.5$ 伏特。\n- 在 $T=2^\\circ\\text{C}$ 时，$V=15.0$ 伏特。\n- 在 $T=3^\\circ\\text{C}$ 时，$V=24.5$ 伏特。\n- 在 $T=4^\\circ\\text{C}$ 时，$V=37.0$ 伏特。\n\n使用最小二乘法，求出系数 $a$ 和 $b$ 的最佳拟合值。", "solution": "给定二次模型 $V(T) = aT^{2} + bT + c$ 以及精确的基准规格 $V(0) = 5$，这确定了 $c = 5$。使用在 $T = 1,2,3,4$ 处的四次测量数据，我们在模型\n$$\nV(T) = aT^{2} + bT + 5.\n$$\n中拟合 $a$ 和 $b$。\n定义在测量点 $\\{(T_{i},V_{i})\\}_{i=1}^{4}$ 处的残差为\n$$\nr_{i} = aT_{i}^{2} + bT_{i} + 5 - V_{i},\n$$\n并最小化残差平方和\n$$\nS(a,b) = \\sum_{i=1}^{4} r_{i}^{2}。\n$$\n最小二乘法正规方程组由 $\\frac{\\partial S}{\\partial a} = 0$ 和 $\\frac{\\partial S}{\\partial b} = 0$ 导出：\n$$\n\\sum_{i=1}^{4} T_{i}^{2}\\,r_{i} = 0, \\qquad \\sum_{i=1}^{4} T_{i}\\,r_{i} = 0.\n$$\n令 $y_{i} = V_{i} - 5$，从而 $r_{i} = aT_{i}^{2} + bT_{i} - y_{i}$。代入后得到线性方程组\n$$\n\\left(\\sum_{i=1}^{4} T_{i}^{4}\\right)a + \\left(\\sum_{i=1}^{4} T_{i}^{3}\\right)b = \\sum_{i=1}^{4} T_{i}^{2} y_{i},\n$$\n$$\n\\left(\\sum_{i=1}^{4} T_{i}^{3}\\right)a + \\left(\\sum_{i=1}^{4} T_{i}^{2}\\right)b = \\sum_{i=1}^{4} T_{i} y_{i}.\n$$\n当 $T_{i} \\in \\{1,2,3,4\\}$ 且 $V_{i} \\in \\{8.5,15.0,24.5,37.0\\}$ 时，我们有 $y_{i} = V_{i} - 5 \\in \\{3.5,10.0,19.5,32.0\\}$。计算各项和：\n$$\n\\sum_{i=1}^{4} T_{i} = 10,\\quad \\sum_{i=1}^{4} T_{i}^{2} = 30,\\quad \\sum_{i=1}^{4} T_{i}^{3} = 100,\\quad \\sum_{i=1}^{4} T_{i}^{4} = 354,\n$$\n$$\n\\sum_{i=1}^{4} T_{i}^{2} y_{i} = 1\\cdot 3.5 + 4\\cdot 10.0 + 9\\cdot 19.5 + 16\\cdot 32.0 = 731,\n$$\n$$\n\\sum_{i=1}^{4} T_{i} y_{i} = 1\\cdot 3.5 + 2\\cdot 10.0 + 3\\cdot 19.5 + 4\\cdot 32.0 = 210.\n$$\n因此，正规方程组变为\n$$\n354\\,a + 100\\,b = 731,\\qquad 100\\,a + 30\\,b = 210.\n$$\n从第二个方程中解出 $a$：$a = \\frac{210 - 30b}{100} = 2.1 - 0.3b$。将其代入第一个方程：\n$$\n354\\,(2.1 - 0.3b) + 100\\,b = 731 \\;\\;\\Rightarrow\\;\\; 743.4 - 106.2\\,b + 100\\,b = 731,\n$$\n$$\n-6.2\\,b = -12.4 \\;\\;\\Rightarrow\\;\\; b = 2.\n$$\n于是\n$$\na = 2.1 - 0.3\\cdot 2 = 1.5 = \\frac{3}{2}.\n$$\n因此，最小二乘法最佳拟合系数为 $a = \\frac{3}{2}$ 和 $b = 2$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{3}{2} & 2\\end{pmatrix}}$$", "id": "1362173"}]}