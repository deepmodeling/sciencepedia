{"hands_on_practices": [{"introduction": "第一个实践将最小二乘法的抽象理论置于一个常见的现实世界应用中：信号处理。你将扮演一名工程师，尝试将一个数学模型拟合到一组数据点上。本练习将指导你完成任何最小二乘问题的关键第一步：将问题从一组观测数据转化为线性方程组，然后构建相应的正规方程 $A^T A\\hat{\\mathbf{x}} = A^T\\mathbf{b}$。掌握此构建过程对于在其他领域应用最小二乘法至关重要。[@problem_id:1371660]", "problem": "一位信号处理工程师正在分析一个含噪信号。他们假设信号的一段 $y(t)$ 可以用一个二次多项式 $p(t) = c_0 + c_1 t + c_2 t^2$ 来近似，其中 $t$ 是以秒为单位的时间。为了确定未知系数 $c_0, c_1, c_2$，该工程师收集了四个数据样本 $(t_i, y_i)$:\n$$(0, 1.0), (1, 0.5), (2, 2.0), (3, 4.5)$$\n将这些数据点代入模型，会产生一个超定线性方程组 $A\\mathbf{x} = \\mathbf{b}$，其中 $\\mathbf{x} = \\begin{pmatrix} c_0 \\\\ c_1 \\\\ c_2 \\end{pmatrix}$。矩阵 $A$ 是通过在采样时间点上对多项式的基函数求值而构建的，向量 $\\mathbf{b}$ 包含观测到的信号值。\n\n最小二乘法原理指出，当误差向量 $\\mathbf{e} = \\mathbf{b} - A\\mathbf{x}$ 与 $A$ 的列空间正交时，可以找到最佳近似。这个正交条件可以转化为一个形如 $M\\mathbf{x} = \\mathbf{v}$ 的可解线性方程组。\n\n你的任务是确定这个系统的矩阵 $M$ 和向量 $\\mathbf{v}$。以下哪个选项代表了正确的 $(M, \\mathbf{v})$ 对？\n\nA. $M = \\begin{pmatrix} 4 & 6 & 14 \\\\ 6 & 14 & 36 \\\\ 14 & 36 & 98 \\end{pmatrix}, \\mathbf{v} = \\begin{pmatrix} 8 \\\\ 18 \\\\ 49 \\end{pmatrix}$\n\nB. $M = \\begin{pmatrix} 14 & 36 & 98 \\\\ 36 & 98 & 258 \\\\ 98 & 258 & 794 \\end{pmatrix}, \\mathbf{v} = \\begin{pmatrix} 18 \\\\ 49 \\\\ 138.5 \\end{pmatrix}$\n\nC. $M = \\begin{pmatrix} 4 & 6 & 14 \\\\ 6 & 14 & 36 \\\\ 14 & 36 & 98 \\end{pmatrix}, \\mathbf{v} = \\begin{pmatrix} 8.0 \\\\ 18.0 \\\\ 45.0 \\end{pmatrix}$\n\nD. $M = \\begin{pmatrix} 4 & 6 & 14 \\\\ 6 & 14 & 36 \\\\ 14 & 36 & 98 \\end{pmatrix}, \\mathbf{v} = \\begin{pmatrix} 6 \\\\ 14 \\\\ 36 \\end{pmatrix}$\n\nE. $M = \\begin{pmatrix} 4 & 6 & 14 \\\\ 6 & 14 & 36 \\\\ 14 & 36 & 108 \\end{pmatrix}, \\mathbf{v} = \\begin{pmatrix} 8 \\\\ 18 \\\\ 49 \\end{pmatrix}$", "solution": "我们用 $p(t)=c_{0}+c_{1}t+c_{2}t^{2}$ 来对数据进行建模。使用采样时间 $t\\in\\{0,1,2,3\\}$，设计矩阵 $A$ 的行是 $[1,\\ t,\\ t^{2}]$ 在每个 $t$ 处的求值，而 $\\mathbf{b}$ 汇集了相应的 $y$ 值：\n$$\nA=\\begin{pmatrix}\n1 & 0 & 0\\\\\n1 & 1 & 1\\\\\n1 & 2 & 4\\\\\n1 & 3 & 9\n\\end{pmatrix},\\qquad\n\\mathbf{b}=\\begin{pmatrix}\n1.0\\\\\n0.5\\\\\n2.0\\\\\n4.5\n\\end{pmatrix}.\n$$\n最小二乘解满足正规方程组\n$$\nA^{\\top}A\\,\\mathbf{x}=A^{\\top}\\mathbf{b},\n$$\n因此 $M=A^{\\top}A$ 且 $\\mathbf{v}=A^{\\top}\\mathbf{b}$。\n\n计算在采样时间 $t_{i}\\in\\{0,1,2,3\\}$ 上的总和：\n$$\nS_{0}=\\sum 1=4,\\quad S_{1}=\\sum t_{i}=0+1+2+3=6,\\quad S_{2}=\\sum t_{i}^{2}=0+1+4+9=14,\n$$\n$$\nS_{3}=\\sum t_{i}^{3}=0+1+8+27=36,\\quad S_{4}=\\sum t_{i}^{4}=0+1+16+81=98.\n$$\n因此\n$$\nM=A^{\\top}A=\\begin{pmatrix}\nS_{0} & S_{1} & S_{2}\\\\\nS_{1} & S_{2} & S_{3}\\\\\nS_{2} & S_{3} & S_{4}\n\\end{pmatrix}\n=\\begin{pmatrix}\n4 & 6 & 14\\\\\n6 & 14 & 36\\\\\n14 & 36 & 98\n\\end{pmatrix}.\n$$\n\n现在按分量计算 $\\mathbf{v}=A^{\\top}\\mathbf{b}$：\n$$\nv_{0}=\\sum y_{i}=1.0+0.5+2.0+4.5=8.0,\n$$\n$$\nv_{1}=\\sum t_{i}y_{i}=0\\cdot 1.0+1\\cdot 0.5+2\\cdot 2.0+3\\cdot 4.5=0.5+4.0+13.5=18.0,\n$$\n$$\nv_{2}=\\sum t_{i}^{2}y_{i}=0^{2}\\cdot 1.0+1^{2}\\cdot 0.5+2^{2}\\cdot 2.0+3^{2}\\cdot 4.5=0+0.5+8.0+40.5=49.0.\n$$\n所以，\n$$\n\\mathbf{v}=\\begin{pmatrix}8.0 \\\\ 18.0 \\\\ 49.0\\end{pmatrix}.\n$$\n与选项比较，这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1371660"}, {"introduction": "学习了如何构建正规方程之后，我们现在转向其几何意义。本练习将最小二乘问题描述为在给定模型的能力范围内寻找“最接近”的信号。你将计算观测信号与模型生成信号子空间之间的最短距离（即误差），这对应于寻找残差向量的长度。这提供了一个强大的直觉：最小二乘解就是你的数据在解空间上的正交投影。[@problem_id:1371618]", "problem": "在一个简化的信号处理模型中，信号被表示为 $\\mathbb{R}^4$ 中的向量。一个特定的测量信号由向量 $b = (1, 0, 2, -1)^T$ 给出。该模型只能生成由两个基信号 $v_1 = (1, 1, 0, 1)^T$ 和 $v_2 = (2, 0, 1, 1)^T$ 构成的线性组合。令 $W$ 为由这两个基信号张成的 $\\mathbb{R}^4$ 的子空间，它代表了该模型可以生成的所有可能信号。\n\n模型近似信号 $b$ 的误差定义为向量 $b$ 与子空间 $W$ 中任意向量之间的最短欧几里得距离。计算这个最小误差。将您的最终答案四舍五入到四位有效数字。", "solution": "我们要求 $b$ 到子空间 $W=\\operatorname{span}\\{v_{1},v_{2}\\}$ 的最小欧几里得距离，这个距离是正交投影后残差的范数：如果 $A=[v_{1}\\ v_{2}]$ 且 $c$ 是法方程 $(A^{T}A)c=A^{T}b$ 的解，那么投影是 $p=Ac$，最小误差是 $\\|b-p\\|$。\n\n计算格拉姆矩阵和等式右边：\n$$\nv_{1}\\cdot v_{1}=3,\\quad v_{1}\\cdot v_{2}=3,\\quad v_{2}\\cdot v_{2}=6,\n$$\n所以\n$$\nA^{T}A=\\begin{pmatrix}3 & 3 \\\\ 3 & 6\\end{pmatrix}.\n$$\n此外，\n$$\nv_{1}\\cdot b=0,\\quad v_{2}\\cdot b=3,\\quad A^{T}b=\\begin{pmatrix}0 \\\\ 3\\end{pmatrix}.\n$$\n求解\n$$\n\\begin{pmatrix}3 & 3 \\\\ 3 & 6\\end{pmatrix}\\begin{pmatrix}c_{1} \\\\ c_{2}\\end{pmatrix}=\\begin{pmatrix}0 \\\\ 3\\end{pmatrix}.\n$$\n从 $3c_{1}+3c_{2}=0$ 和 $3c_{1}+6c_{2}=3$，两式相减得到 $3c_{2}=3$，因此 $c_{2}=1$，然后 $c_{1}=-1$。\n\n因此投影是\n$$\np=c_{1}v_{1}+c_{2}v_{2}=-v_{1}+v_{2}=(1,-1,1,0).\n$$\n残差是\n$$\nr=b-p=(1,0,2,-1)-(1,-1,1,0)=(0,1,1,-1).\n$$\n最小误差是 $r$ 的欧几里得范数：\n$$\n\\|r\\|=\\sqrt{0^{2}+1^{2}+1^{2}+(-1)^{2}}=\\sqrt{3}.\n$$\n四舍五入到四位有效数字得到 $1.732$。", "answer": "$$\\boxed{1.732}$$", "id": "1371618"}, {"introduction": "虽然正规方程提供了一个通用的解法，但求解它们可能很繁琐。最后一个实践介绍了一种在特殊但非常重要的情况下出现的显著计算捷径：当模型的基向量（矩阵$A$的列）正交时。你将发现正交性如何使矩阵 $A^TA$ 变为对角矩阵，从而使正规方程的求解变得异常简单。这个练习展示了使用正交基的巨大实用价值，并为傅里叶分析等更高级的主题奠定了基础。[@problem_id:1371641]", "problem": "一个实验室仪器在四个连续且等间隔的时间点处记录了一个信号。得到的测量值汇集成一个向量 $b \\in \\mathbb{R}^4$。根据理论，一个没有噪声的“纯”信号必须是三个特定基信号的线性组合。这些基信号由矩阵 $A$ 的列向量给出。具体的矩阵是：\n$$\nA = \\begin{pmatrix} 1 & 1 & 1 \\\\ 1 & -1 & 1 \\\\ 1 & 1 & -1 \\\\ 1 & -1 & -1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\\\ 4 \\end{pmatrix}\n$$\n观测到的向量 $b$ 被认为是受到噪声污染的纯信号，因此它不位于由 $A$ 的列向量张成的子空间中。为了恢复最可能的纯信号，我们必须找到 $A$ 的列空间中距离 $b$ 最近的向量。这被称为 $b$ 在 $A$ 的列空间上的正交投影。\n\n求这个投影相对于由 $A$ 的列向量给出的基的坐标向量 $\\hat{x} \\in \\mathbb{R}^3$。请用精确的列向量表示你的答案。", "solution": "我们寻求 $b$ 在 $A$ 的列空间上的正交投影，也就是 $A \\hat{x} \\approx b$ 的最小二乘解 $\\hat{x}$。这满足正规方程组\n$$\nA^{T}A\\,\\hat{x} \\;=\\; A^{T}b.\n$$\n设 $A$ 的列向量为 $c_{1},c_{2},c_{3}$，其中\n$$\nc_{1}=\\begin{pmatrix}1\\\\1\\\\1\\\\1\\end{pmatrix},\\quad\nc_{2}=\\begin{pmatrix}1\\\\-1\\\\1\\\\-1\\end{pmatrix},\\quad\nc_{3}=\\begin{pmatrix}1\\\\1\\\\-1\\\\-1\\end{pmatrix}.\n$$\n计算格拉姆矩阵的元素 $c_{i}\\cdot c_{j}$：\n$$\nc_{1}\\cdot c_{1}=4,\\quad c_{2}\\cdot c_{2}=4,\\quad c_{3}\\cdot c_{3}=4,\n$$\n$$\nc_{1}\\cdot c_{2}=0,\\quad c_{1}\\cdot c_{3}=0,\\quad c_{2}\\cdot c_{3}=0.\n$$\n因此，\n$$\nA^{T}A \\;=\\; \\begin{pmatrix}4&0&0\\\\0&4&0\\\\0&0&4\\end{pmatrix} \\;=\\; 4I_{3}.\n$$\n接着计算 $A^{T}b$，它的元素是 $c_{i}\\cdot b$，其中 $b=\\begin{pmatrix}1\\\\2\\\\3\\\\4\\end{pmatrix}$：\n$$\nc_{1}\\cdot b = 1+2+3+4=10,\\quad\nc_{2}\\cdot b = 1-2+3-4=-2,\\quad\nc_{3}\\cdot b = 1+2-3-4=-4,\n$$\n所以\n$$\nA^{T}b \\;=\\; \\begin{pmatrix}10\\\\-2\\\\-4\\end{pmatrix}.\n$$\n解正规方程组得到\n$$\n4I_{3}\\,\\hat{x} \\;=\\; \\begin{pmatrix}10\\\\-2\\\\-4\\end{pmatrix}\n\\;\\;\\Longrightarrow\\;\\;\n\\hat{x} \\;=\\; \\frac{1}{4}\\begin{pmatrix}10\\\\-2\\\\-4\\end{pmatrix}\n\\;=\\; \\begin{pmatrix}\\frac{5}{2}\\\\-\\frac{1}{2}\\\\-1\\end{pmatrix}.\n$$\n因此， $b$ 在 $A$ 的列空间上的正交投影（相对于给定的基）的坐标向量是 $\\hat{x}=\\begin{pmatrix}\\frac{5}{2}\\\\ -\\frac{1}{2}\\\\ -1\\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{5}{2}\\\\ -\\frac{1}{2}\\\\ -1\\end{pmatrix}}$$", "id": "1371641"}]}