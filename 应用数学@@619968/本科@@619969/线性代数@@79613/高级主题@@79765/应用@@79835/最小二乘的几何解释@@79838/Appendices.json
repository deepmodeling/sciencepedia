{"hands_on_practices": [{"introduction": "我们从一个理想化的场景开始探索最小二乘法的几何意义。如果我们要近似的向量 $\\mathbf{b}$ 本身已经位于我们用来近似的子空间（即矩阵 $A$ 的列空间 $\\text{Col}(A)$）之内，会发生什么？这个练习 ([@problem_id:1363836]) 探讨了这种基本情况。通过分析这个场景，你会发现最小二乘解在这种情况下不再是“近似解”，而是变成了精确解，其误差为零。理解这一点有助于巩固最小二乘法的核心思想：在子空间中寻找“最近”的向量，如果向量已经在其中，那么它本身就是答案。", "problem": "设 $A$ 是一个 $m \\times n$ 的实矩阵，设 $b$ 是 $\\mathbb{R}^m$ 中的一个向量。$A$ 的列向量的所有线性组合构成 $\\mathbb{R}^m$ 的一个子空间，称为 $A$ 的列空间，记为 $\\text{Col}(A)$。线性系统 $Ax = b$ 的一个最小二乘解是 $\\mathbb{R}^n$ 中的一个向量 $\\hat{x}$，它使得欧几里得范数 $\\|Ax - b\\|$ 最小。从几何上看，向量 $A\\hat{x}$ 是 $b$ 在 $\\text{Col}(A)$ 上的正交投影。值 $\\|A\\hat{x} - b\\|$ 是最小二乘误差。\n\n考虑一个特殊情况，其中向量 $b$ 已知位于 $A$ 的列空间内，即 $b \\in \\text{Col}(A)$。\n\n对于这一特定场景，下列哪个陈述对最小二乘解及其相关误差提供了最准确的几何和代数描述？\n\nA. 最小二乘误差为零，且所有最小二乘解的集合与 $Ax = b$ 的所有精确解的集合相同。\n\nB. 存在唯一的最小二乘解 $\\hat{x}$，它由 $b$ 在 $A^T$ 的零空间上的投影给出。最小二乘误差为零。\n\nC. 最小二乘误差非零，因为最小二乘法总是找到一个近似值。误差向量 $b - A\\hat{x}$ 是 $b$ 在 $A$ 的零空间上的投影。\n\nD. 任何最小二乘解向量 $\\hat{x}$ 都必须与 $A$ 的零空间正交，但误差 $\\|A\\hat{x} - b\\|$ 可能非零。\n\nE. 向量 $A\\hat{x}$ 与向量 $b$ 正交，导致一个最小范数但非零的误差。", "solution": "根据定义，最小二乘解 $\\hat{x}$ 使得 $\\|Ax - b\\|$ 最小。投影定理指出，对于任意 $b \\in \\mathbb{R}^{m}$，有\n$$\nb = p + r, \\quad p \\in \\text{Col}(A), \\quad r \\in \\text{Col}(A)^{\\perp},\n$$\n且对于任意 $x$，有\n$$\n\\|Ax - b\\|^{2} = \\|Ax - p - r\\|^{2} = \\|(Ax - p)\\|^{2} + \\|r\\|^{2},\n$$\n其中当 $Ax = p$ 时，即当 $Ax$ 是 $b$ 在 $\\text{Col}(A)$ 上的正交投影时，达到最小值。\n\n在最小二乘法中，$A\\hat{x}$ 是 $b$ 在 $\\text{Col}(A)$ 上的正交投影，并且 $\\hat{x}$ 满足正规方程组\n$$\nA^{T}(A\\hat{x} - b) = 0.\n$$\n等价地，残差 $r = b - A\\hat{x}$ 位于 $\\text{Col}(A)^{\\perp}$ 中。\n\n现在假设 $b \\in \\text{Col}(A)$。那么 $b$ 在 $\\text{Col}(A)$ 上的正交投影就是 $b$ 本身。因此，存在一个 $x_{0}$ 使得\n$$\nAx_{0} = b,\n$$\n并且最小二乘残差达到\n$$\n\\|A x_{0} - b\\| = 0,\n$$\n这是最小值。因此，最小二乘误差为零。\n\n此外，任何满足 $Ax = b$ 的 $x$ 都产生相同的最小残差零，所以每个精确解都是一个最小二乘解。反之，任何最小二乘解 $\\hat{x}$ 都必须满足 $A\\hat{x}$ 等于 $b$ 在 $\\text{Col}(A)$ 上的投影，这里该投影等于 $b$，所以 $A\\hat{x} = b$。因此，最小二乘解的集合与 $Ax = b$ 的解集完全一致：\n$$\n\\{\\hat{x} : \\hat{x} \\text{ is LS for } Ax=b\\} = \\{x : Ax=b\\}.\n$$\n从代数上讲，这也源于正规方程组：如果 $Ax=b$ 是相容的，那么 $Ax=b$ 的任何解都满足 $A^{T}(A x - b)=0$，且残差的最小范数为 $0$。\n\n因此：\n- 最小二乘误差为零。\n- 最小二乘解的集合等于 $Ax = b$ 的精确解的集合。\n- 除非 $\\text{Null}(A) = \\{0\\}$，否则不保证唯一性。\n\n选项 A 精确地陈述了这些事实。选项 B、C、D 和 E 以不同方式与这些结论相矛盾（B 错误地断言了唯一性并错误地描述了解；C 和 E 断言误差非零；D 在这种情况下允许非零误差）。", "answer": "$$\\boxed{A}$$", "id": "1363836"}, {"introduction": "在研究了“完美拟合”的理想情况后，让我们来探讨另一个极端。当向量 $\\mathbf{b}$ 与列空间“尽可能远”，即与整个子空间正交时，最小二乘近似会是什么样子？这个练习 ([@problem_id:1363842]) 揭示了正交投影定理的一个关键推论。它将引导你从几何上理解，在这种情况下，子空间内最好的近似就是零向量，这深刻地展示了正交性在最小二乘问题中的核心作用。", "problem": "设 $A$ 是一个 $m \\times n$ 的实矩阵，$\\mathbf{b}$ 是 $\\mathbb{R}^m$ 中的一个向量。考虑线性方程组 $A\\mathbf{x} = \\mathbf{b}$，其中 $\\mathbf{x}$ 是 $\\mathbb{R}^n$ 中的一个向量。最小二乘问题旨在找到一个向量 $\\hat{\\mathbf{x}}$，以最小化残差的欧几里得范数 $\\|A\\mathbf{x} - \\mathbf{b}\\|$。向量 $\\mathbf{p} = A\\hat{\\mathbf{x}}$ 被定义为向量 $\\mathbf{b}$ 在 $A$ 的列空间（记作 $C(A)$）上的正交投影。\n\n假设对于一个特定的矩阵 $A$ 和一个非零向量 $\\mathbf{b}$，其正交投影 $\\mathbf{p}$ 为零向量，即 $\\mathbf{p} = \\mathbf{0}$。以下哪个陈述提供了向量 $\\mathbf{b}$ 与列空间 $C(A)$ 之间关系的最准确和最普适的几何描述？\n\nA. 向量 $\\mathbf{b}$ 必须是 $A$ 的某一列的标量倍。\n\nB. 向量 $\\mathbf{b}$ 位于 $A$ 的零空间中。\n\nC. 向量 $\\mathbf{b}$ 是 $A$ 的列的线性组合。\n\nD. 向量 $\\mathbf{b}$ 与 $A$ 的列空间中的每个向量都正交。\n\nE. 矩阵 $A$ 必须是零矩阵。", "solution": "我们考虑 $\\mathbf{b} \\in \\mathbb{R}^{m}$ 到列空间 $C(A) \\subseteq \\mathbb{R}^{m}$ 上的最小二乘投影。根据投影定理，$\\mathbf{b}$ 在 $C(A)$ 上的正交投影 $\\mathbf{p}$ 的特征是 $\\mathbf{p} \\in C(A)$ 以及正交性条件\n$$\n\\mathbf{b} - \\mathbf{p} \\perp C(A).\n$$\n等价地，由于 $C(A)$ 是由 $A$ 的列向量张成的，这个正交性条件可以写成\n$$\nA^{T}(\\mathbf{b} - \\mathbf{p}) = \\mathbf{0}.\n$$\n在最小二乘法中，投影满足 $\\mathbf{p} = A\\hat{\\mathbf{x}}$（对于某个 $\\hat{\\mathbf{x}} \\in \\mathbb{R}^{n}$），其正规方程组为\n$$\nA^{T}A\\hat{\\mathbf{x}} = A^{T}\\mathbf{b}, \\quad \\text{其中} \\quad \\mathbf{p} = A\\hat{\\mathbf{x}}.\n$$\n现在假设 $\\mathbf{p} = \\mathbf{0}$。那么正交性条件化简为\n$$\nA^{T}\\mathbf{b} = \\mathbf{0}.\n$$\n这意味着对于 $A$ 的每一列 $\\mathbf{a}_{j}$，都有 $\\mathbf{a}_{j}^{T}\\mathbf{b} = 0$。因此 $\\mathbf{b}$ 与 $A$ 的每一列都正交，从而与 $A$ 的列的任意线性组合都正交，也就是说，与 $C(A)$ 中的所有向量都正交。因此，正确的几何描述是 $\\mathbf{b}$ 与整个列空间 $C(A)$ 正交。\n\n我们简要地排除其他选项：\n- A 是错误的，因为 $\\mathbf{p} = \\mathbf{0}$ 意味着与每一列都正交，而不是与某一列对齐（除非该列是零向量）。\n- B 在维度上是不正确的：$A$ 的零空间是 $\\mathbb{R}^{n}$ 的一个子空间，而 $\\mathbf{b} \\in \\mathbb{R}^{m}$。\n- C 是错误的，因为如果 $\\mathbf{b} \\in C(A)$ 且 $\\mathbf{b} \\neq \\mathbf{0}$，那么投影将是 $\\mathbf{p} = \\mathbf{b} \\neq \\mathbf{0}$。\n- E 是错误的，因为我们可以有一个非零矩阵 $A$ 和一个非平凡的 $C(A)$，并选择一个与 $C(A)$ 正交的 $\\mathbf{b}$；此时 $\\mathbf{p} = \\mathbf{0}$，但 $A$ 不必是零矩阵。\n\n因此，最准确和最普适的陈述是 $\\mathbf{b}$ 与 $C(A)$ 中的每个向量都正交。", "answer": "$$\\boxed{D}$$", "id": "1363842"}, {"introduction": "我们已经考察了两个极端情况，现在来研究一下最小二乘解在向量变换下的行为。如果我们将目标向量 $\\mathbf{b}$ 沿着一个已经存在于近似子空间内的向量 $\\mathbf{w}$ 进行平移，结果会如何？这个练习 ([@problem_id:1363790]) 巧妙地阐释了正交分解的原理。通过这个思想实验，你会发现投影向量会相应地移动，而误差向量却保持不变，这有力地证明了误差向量是 $\\mathbf{b}$ 中与子空间完全“垂直”的分量。", "problem": "设 $A$ 为一个 $m \\times n$ 的实矩阵，其各列线性无关，并设 $b$ 为 $\\mathbb{R}^m$ 中的一个向量。在最小二乘问题中，向量 $\\hat{x}$ 是 $\\mathbb{R}^n$ 中能使欧几里得范数平方 $\\|A\\mathbf{x} - b\\|^2$ 最小化的唯一向量。向量 $p = A\\hat{x}$ 是 $b$ 在 $A$ 的列空间上的分量，而向量 $e = b - p$ 是误差分量。\n\n现在，假设我们定义一个新的目标向量 $b' = b + w$，其中 $w$ 是一个也位于 $A$ 的列空间中的非零向量。设 $\\hat{x}'$ 是能使新的范数平方 $\\|A\\mathbf{x} - b'\\|^2$ 最小化的唯一向量。新的对应向量为 $p' = A\\hat{x}'$ 和 $e' = b' - p'$。\n\n下列哪个陈述正确地描述了新向量 $p'$ 和 $e'$ 与原向量的关系？\n\nA. $p' = p$ 且 $e' = e + w$\n\nB. $p' = p + w$ 且 $e' = e$\n\nC. $p' = p + w$ 且 $e' = e + w$\n\nD. $p' = p$ 且 $e' = e$\n\nE. 若不清楚矩阵 $A$ 的具体形式，则无法确定此关系。", "solution": "问题要求解在目标向量 $b'$ 被修改后的最小二乘问题中，新的投影向量 $p'$ 和新的误差向量 $e'$。\n\n设 $C(A)$ 表示矩阵 $A$ 的列空间。根据定义，最小二乘解 $A\\hat{x}$ 是向量 $b$ 到子空间 $C(A)$ 上的正交投影。我们将到 $C(A)$ 上的投影算子记为 $\\text{proj}_{C(A)}$。\n\n原始投影向量为 $p = A\\hat{x} = \\text{proj}_{C(A)}(b)$。\n原始误差向量为 $e = b - p = b - \\text{proj}_{C(A)}(b)$。这种分解的一个关键性质是，误差向量 $e$ 与子空间 $C(A)$ 正交。\n\n我们给定一个新的目标向量 $b' = b + w$。我们还知道向量 $w$ 位于 $A$ 的列空间中，即 $w \\in C(A)$。\n\n新的投影向量 $p'$ 是 $b'$ 到列空间 $C(A)$ 上的正交投影。\n$$p' = \\text{proj}_{C(A)}(b')$$\n代入 $b'$ 的表达式，我们得到：\n$$p' = \\text{proj}_{C(A)}(b + w)$$\n投影算子是一个线性变换。因此，我们可以将其分配到和式中：\n$$p' = \\text{proj}_{C(A)}(b) + \\text{proj}_{C(A)}(w)$$\n我们知道 $\\text{proj}_{C(A)}(b)$ 就是原始的投影向量 $p$。\n现在考虑 $\\text{proj}_{C(A)}(w)$。由于向量 $w$ 已经位于子空间 $C(A)$ 中，其到 $C(A)$ 的投影就是向量 $w$ 本身。\n$$\\text{proj}_{C(A)}(w) = w$$\n将这些代回到 $p'$ 的表达式中，我们得到：\n$$p' = p + w$$\n所以，新的投影向量是原始投影向量与扰动向量 $w$ 的和。\n\n接下来，我们求新的误差向量 $e'$。根据定义，$e'$ 是新的目标向量 $b'$ 与新的投影向量 $p'$ 之差。\n$$e' = b' - p'$$\n我们可以代入 $b'$ 和 $p'$ 的表达式：\n$$e' = (b + w) - (p + w)$$\n化简该表达式，我们得到：\n$$e' = b + w - p - w = b - p$$\n表达式 $b - p$ 是原始误差向量 $e$ 的定义。\n因此，我们有：\n$$e' = e$$\n这意味着当目标向量 $b$ 被一个已在 $A$ 列空间内的向量 $w$ 平移时，误差向量并不会改变。从几何角度看，加上一个来自子空间的向量只会使目标向量沿着平行于该子空间的方向移动，因此其到该子空间的正交距离保持不变。\n\n综上所述，新的向量是 $p' = p + w$ 和 $e' = e$。这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "1363790"}]}