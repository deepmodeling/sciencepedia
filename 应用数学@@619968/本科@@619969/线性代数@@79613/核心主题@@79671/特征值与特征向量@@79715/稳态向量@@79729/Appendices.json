{"hands_on_practices": [{"introduction": "理解稳态向量的第一步是掌握其计算方法。本练习提供了一个关于用户网页浏览行为的简化模型。通过将这个动态过程转化为一个马尔可夫链，你将亲手构建转移矩阵并求解相应的稳态向量，这是分析任何动态系统长期趋势的核心技能。[@problem_id:1382127]", "problem": "一个用户网页浏览行为的简化模型追踪其在三种网页类型间的状态：主页 (H)、内容页 (C) 和购买页 (P)。用户从一种网页类型转换到另一种的概率仅取决于其当前的网页类型。观察到的转移概率如下：\n\n- 在主页 (H) 上的用户有 50% 的概率停留在主页，30% 的概率移动到内容页 (C)，20% 的概率移动到购买页 (P)。\n- 在内容页 (C) 上的用户有 20% 的概率移动到主页 (H)，60% 的概率停留在内容页 (C)，20% 的概率移动到购买页 (P)。\n- 在购买页 (P) 上的用户有 10% 的概率移动到主页 (H)，40% 的概率移动到内容页 (C)，50% 的概率停留在购买页 (P)。\n\n状态向量 $\\mathbf{x} = \\begin{pmatrix} x_H \\\\ x_C \\\\ x_P \\end{pmatrix}$ 分别表示用户在 H、C 或 P 类型页面上的概率。一个稳态概率向量，记作 $\\mathbf{q}$，是一个概率向量（即其分量非负且和为 1），在一次转移后保持不变。因此它满足矩阵方程 $P\\mathbf{q} = \\mathbf{q}$，其中 $P$ 是系统的转移矩阵。\n\n确定该系统的唯一稳态概率向量 $\\mathbf{q}$。将你的答案表示为一个包含最简分数的列向量。", "solution": "我们将其建模为一个具有状态 $H,C,P$ 的马尔可夫链，其列随机转移矩阵 $P$ 定义为 $P_{ij}$ 是从状态 $j$ 转移到状态 $i$ 的概率。根据给定的转移：\n- 从 $H$：到 $H$ 的概率为 $\\frac{1}{2}$，到 $C$ 的概率为 $\\frac{3}{10}$，到 $P$ 的概率为 $\\frac{1}{5}$。\n- 从 $C$：到 $H$ 的概率为 $\\frac{1}{5}$，到 $C$ 的概率为 $\\frac{3}{5}$，到 $P$ 的概率为 $\\frac{1}{5}$。\n- 从 $P$：到 $H$ 的概率为 $\\frac{1}{10}$，到 $C$ 的概率为 $\\frac{2}{5}$，到 $P$ 的概率为 $\\frac{1}{2}$。\n\n因此\n$$\nP=\\begin{pmatrix}\n\\frac{1}{2} & \\frac{1}{5} & \\frac{1}{10} \\\\\n\\frac{3}{10} & \\frac{3}{5} & \\frac{2}{5} \\\\\n\\frac{1}{5} & \\frac{1}{5} & \\frac{1}{2}\n\\end{pmatrix},\n$$\n该矩阵的各项均为严格正数，因此根据 Perron–Frobenius 定理，存在一个唯一的稳态概率向量 $\\mathbf{q}$ 满足 $P\\mathbf{q}=\\mathbf{q}$ 和 $q_{H}+q_{C}+q_{P}=1$。\n\n设 $\\mathbf{q}=\\begin{pmatrix}h\\\\c\\\\p\\end{pmatrix}$。根据 $P\\mathbf{q}=\\mathbf{q}$，我们有分量形式的方程\n$$\n\\frac{1}{2}h+\\frac{1}{5}c+\\frac{1}{10}p=h,\\quad\n\\frac{3}{10}h+\\frac{3}{5}c+\\frac{2}{5}p=c,\\quad\n\\frac{1}{5}h+\\frac{1}{5}c+\\frac{1}{2}p=p.\n$$\n将每个方程乘以 $10$ 并重新整理，得到\n$$\n-5h+2c+p=0,\\quad 3h-4c+4p=0,\\quad 2h+2c-5p=0.\n$$\n从 $2h+2c-5p=0$ 我们得到 $p=\\frac{2}{5}(h+c)$。从 $-5h+2c+p=0$ 我们得到 $p=5h-2c$。令这两个关于 $p$ 的表达式相等，\n$$\n\\frac{2}{5}(h+c)=5h-2c \\;\\;\\Longrightarrow\\;\\; 2(h+c)=25h-10c \\;\\;\\Longrightarrow\\;\\; 23h=12c \\;\\;\\Longrightarrow\\;\\; c=\\frac{23}{12}h.\n$$\n那么\n$$\np=5h-2c=5h-2\\left(\\frac{23}{12}h\\right)=5h-\\frac{23}{6}h=\\left(\\frac{30-23}{6}\\right)h=\\frac{7}{6}h.\n$$\n利用 $h+c+p=1$ 的条件，\n$$\nh+\\frac{23}{12}h+\\frac{7}{6}h=\\left(1+\\frac{23}{12}+\\frac{14}{12}\\right)h=\\frac{49}{12}h=1 \\;\\;\\Longrightarrow\\;\\; h=\\frac{12}{49}.\n$$\n因此\n$$\nc=\\frac{23}{12}\\cdot\\frac{12}{49}=\\frac{23}{49},\\qquad p=\\frac{7}{6}\\cdot\\frac{12}{49}=\\frac{14}{49}=\\frac{2}{7}.\n$$\n因此，唯一的稳态概率向量是\n$$\n\\begin{pmatrix}\n\\frac{12}{49} \\\\\n\\frac{23}{49} \\\\\n\\frac{2}{7}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{12}{49}\\\\ \\frac{23}{49}\\\\ \\frac{2}{7}\\end{pmatrix}}$$", "id": "1382127"}, {"introduction": "在掌握了基础计算之后，我们可以探索更复杂的场景。本练习将稳态向量的概念应用于一个市场份额模型，其中转移矩阵依赖于一个可调参数 $t$。你的任务不再仅仅是求解稳态，而是要找到一个特定的参数值，使得最终的市场份额分布满足一个额外的代数条件。这个过程模拟了如何在满足特定设计目标的前提下，对系统进行优化和控制。[@problem_id:1390750]", "problem": "考虑一个动态市场模型，其中有三个相互竞争的公司：Alpha、Beta 和 Gamma。这些公司在某个月的市场份额由列向量 $\\vec{x} = \\begin{pmatrix} x_A \\\\ x_B \\\\ x_G \\end{pmatrix}$ 表示，其中 $x_A + x_B + x_G = 1$。市场份额从一个月到下一个月的转变由随机矩阵 $P(t)$ 控制，使得 $\\vec{x}_{k+1} = P(t) \\vec{x}_k$。矩阵 $P(t)$ 依赖于一个与广告活动相关的策略参数 $t$，该参数被限制在区间 $0 \\le t \\le \\frac{1}{2}$ 内。该矩阵由下式给出：\n$$\nP(t) = \\begin{pmatrix} 1-t & \\frac{1}{3} & t \\\\ t & \\frac{1}{2} & 1-2t \\\\ 0 & \\frac{1}{6} & t \\end{pmatrix}\n$$\n随着时间的推移，市场份额预计将达到一个稳态分布向量 $\\vec{q} = \\begin{pmatrix} q_A \\\\ q_B \\\\ q_G \\end{pmatrix}$，该向量是此变换的一个不动点，即 $P(t)\\vec{q} = \\vec{q}$。\n\n求参数 $t$ 的具体值，使得稳态市场份额 $q_A$、$q_B$ 和 $q_G$ 按此顺序构成一个等差数列。", "solution": "设 $\\vec{q} = \\begin{pmatrix} q_{A} \\\\ q_{B} \\\\ q_{G} \\end{pmatrix}$ 满足 $P(t)\\vec{q}=\\vec{q}$ 和 $q_{A}+q_{B}+q_{G}=1$。$P(t)\\vec{q}=\\vec{q}$ 的分量方程为\n$$\n\\begin{aligned}\nq_{A} &= (1 - t)q_{A} + \\frac{1}{3}q_{B} + t q_{G}, \\\\\nq_{B} &= t q_{A} + \\frac{1}{2}q_{B} + (1 - 2 t) q_{G}, \\\\\nq_{G} &= \\frac{1}{6}q_{B} + t q_{G}.\n\\end{aligned}\n$$\n$q_{A}, q_{B}, q_{G}$ 按此顺序构成等差数列的要求意味着 $2 q_{B} = q_{A} + q_{G}$。使用 $q_{A}+q_{B}+q_{G}=1$，我们得到 $3 q_{B} = 1$，因此\n$$\nq_{B} = \\frac{1}{3}.\n$$\n根据第三个稳态方程，\n$$\n(1 - t) q_{G} = \\frac{1}{6} q_{B} \\quad \\Longrightarrow \\quad q_{G} = \\frac{q_{B}}{6(1 - t)} = \\frac{1}{18(1 - t)}.\n$$\n因此\n$$\nq_{A} = 1 - q_{B} - q_{G} = \\frac{2}{3} - \\frac{1}{18(1 - t)}.\n$$\n将 $q_{B}=\\frac{1}{3}$ 和 $q_{A}=\\frac{2}{3}-q_{G}$ 代入第二个稳态方程：\n$$\n\\frac{1}{3} = t\\left(\\frac{2}{3} - q_{G}\\right) + \\frac{1}{6} + (1 - 2 t) q_{G} = \\frac{2 t}{3} + \\frac{1}{6} + (1 - 3 t) q_{G}.\n$$\n当 $q_{G} = \\frac{1}{18(1 - t)}$ 时，上式变为\n$$\n\\frac{1}{6} = \\frac{2 t}{3} + \\frac{1 - 3 t}{18(1 - t)}.\n$$\n两边乘以 $18(1 - t)$ 得\n$$\n3(1 - t) = 12 t(1 - t) + (1 - 3 t).\n$$\n展开并化简得\n$$\n12 t^{2} - 12 t + 2 = 0 \\quad \\Longrightarrow \\quad 6 t^{2} - 6 t + 1 = 0.\n$$\n因此\n$$\nt = \\frac{6 \\pm \\sqrt{36 - 24}}{12} = \\frac{3 \\pm \\sqrt{3}}{6}.\n$$\n由于给定条件 $0 \\le t \\le \\frac{1}{2}$，只有 $t = \\frac{3 - \\sqrt{3}}{6}$ 符合要求。这个值确保了稳态市场份额按指定顺序构成一个等差数列。", "answer": "$$\\boxed{\\frac{3 - \\sqrt{3}}{6}}$$", "id": "1390750"}, {"introduction": "线性代数的魅力在于它能通过揭示问题的底层结构来简化计算。在这个练习中，你将分析一个在圆形图上的随机游走模型，其转移矩阵是一个特殊的循环矩阵。你不需要直接求解线性方程组，而是利用循环矩阵的谱性质（即其特征向量的通用形式）来直接推导出系统的稳态分布。这个方法展示了理论知识如何为解决具体问题提供捷径和更深刻的洞见。[@problem_id:1390757]", "problem": "考虑一个离散时间马尔可夫链，它模拟了一个在具有$N$个顶点的循环图上的随机游走，这些顶点被标记为$v_0, v_1, \\dots, v_{N-1}$。在任何时刻，系统的状态是粒子所在的顶点。\n\n在每个时间步，从任意顶点$v_i$出发，粒子有$p$的概率移动到顺时针方向的下一个顶点$v_{(i+1) \\pmod N}$。它有$r$的概率移动到逆时针方向的前一个顶点$v_{(i-1) \\pmod N}$。粒子以$s = 1 - p - r$的概率停留在当前顶点$v_i$。概率$p$和$r$是正常数，满足$p+r \\le 1$。\n\n该马尔可夫链的转移矩阵$P$是一个$N \\times N$的随机循环矩阵。根据线性代数的一个已知结果，对于任意$N \\times N$循环矩阵，分量为$(\\mathbf{u}_k)_j = \\exp\\left(\\frac{2\\pi i k j}{N}\\right)$（其中$j \\in \\{0, 1, \\dots, N-1\\}$）的向量$\\mathbf{u}_k$（其中$k \\in \\{0, 1, \\dots, N-1\\}$）构成一个特征向量的完备集。\n\n利用这一事实，确定唯一稳态向量$\\mathbf{q}$中对应于任意顶点$v_j$的分量。将你的答案表示为$N$的函数。", "solution": "设$P$为$N \\times N$的循环转移矩阵，其元素由$p$、$r$和$s=1-p-r$决定，使得从$v_{i}$出发，游走以概率$p$移动到$v_{(i+1) \\bmod N}$，以概率$r$移动到$v_{(i-1) \\bmod N}$，并以概率$s$停留在原地。对于一个循环矩阵，分量为$(\\mathbf{u}_{k})_{j}=\\exp\\!\\left(\\frac{2\\pi \\mathrm{i} k j}{N}\\right)$（其中$k\\in\\{0,\\dots,N-1\\}$）的向量$\\mathbf{u}_k$构成一个完备的特征基。\n\n定义$\\omega_{k}=\\exp\\!\\left(\\frac{2\\pi \\mathrm{i} k}{N}\\right)$，因此$(\\mathbf{u}_{k})_{j}=\\omega_{k}^{j}$。利用循环结构和模$N$的索引，我们有\n$$\n(P\\mathbf{u}_{k})_{j}\n= s(\\mathbf{u}_{k})_{j} + p(\\mathbf{u}_{k})_{j-1} + r(\\mathbf{u}_{k})_{j+1}\n= \\left(s + p\\omega_{k}^{-1} + r\\omega_{k}\\right)\\omega_{k}^{j}.\n$$\n等价地，\n$$\nP\\mathbf{u}_{k}=\\lambda_{k}\\mathbf{u}_{k}, \\quad \\lambda_{k}=s+p\\omega_{k}^{-1}+r\\omega_{k}.\n$$\n由于$s=1-p-r$，我们有\n$$\n\\lambda_{k}=1 - p - r + p\\omega_{k}^{-1} + r\\omega_{k}.\n$$\n对于$k=0$，我们有$\\omega_{0}=1$，因此$\\lambda_{0}=1 - p - r + p + r=1$。所以$\\mathbf{u}_{0}$（全1向量）是对应于特征值$1$的右特征向量。对于$k\\neq 0$，要使$\\lambda_{k}=1$成立，则需要\n$$\np(\\omega_{k}^{-1}-1)+r(\\omega_{k}-1)=0.\n$$\n两边乘以$\\omega_{k}$得到\n$$\n(\\omega_{k}-1)(r\\omega_{k}-p)=0.\n$$\n由于当$k \\in \\{1, \\dots, N-1\\}$时$\\omega_k \\neq 1$，因此必须有$r\\omega_k - p = 0$，即$\\omega_k = p/r$。取等式两边的模，我们得到$|\\omega_k|=1$和$|p/r|=p/r$（因为$p,r>0$）。因此，必须有$p/r=1$，即$p=r$。如果$p=r$，则方程变为$\\omega_k=1$，但这与$k \\neq 0$的假设相矛盾。因此，对于所有$k\\neq 0$，$\\lambda_{k}\\neq 1$。因此，对应于特征值$1$的特征空间是一维的，由$\\mathbf{u}_{0}$张成。\n\n稳态向量$\\mathbf{q}$满足$P\\mathbf{q}=\\mathbf{q}$，并且对于这个不可约的有限链是唯一的。由于对应于特征值$1$的特征空间由$\\mathbf{u}_{0}$张成，$\\mathbf{q}$必须与$\\mathbf{u}_{0}$成比例；因此对于所有的$j$都有$q_{j}=c$。归一化条件$\\sum_{j=0}^{N-1}q_{j}=1$给出$Nc=1$，所以$c=\\frac{1}{N}$。因此，对于任意顶点$v_{j}$，我们有\n$$\nq_{j}=\\frac{1}{N}.\n$$", "answer": "$$\\boxed{\\frac{1}{N}}$$", "id": "1390757"}]}