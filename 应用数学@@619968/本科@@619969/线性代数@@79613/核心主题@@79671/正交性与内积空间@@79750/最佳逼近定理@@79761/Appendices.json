{"hands_on_practices": [{"introduction": "最佳逼近定理的核心思想是几何的：在子空间中找到一个点，使其与子空间外一个给定点的距离最短。然而，我们如何定义“距离”和“垂直”呢？这个练习 [@problem_id:1350609] 将挑战你对标准欧几里得几何的直觉，通过引入一个加权内积。你将亲手计算在这种非标准几何下，一个向量在给定子空间上的最佳逼近，从而深刻理解最佳逼近的普适性，以及它如何依赖于内积的定义。", "problem": "考虑实向量空间 $\\mathbb{R}^3$，其上的一个非标准内积定义为 $\\langle \\mathbf{x}, \\mathbf{y} \\rangle = 3x_1y_1 + 2x_2y_2 + x_3y_3$，对于 $\\mathbb{R}^3$ 中的任意向量 $\\mathbf{x} = (x_1, x_2, x_3)$ 和 $\\mathbf{y} = (y_1, y_2, y_3)$。设 $W$ 是由向量集合 $\\{\\mathbf{v}_1, \\mathbf{v}_2\\}$ 张成的 $\\mathbb{R}^3$ 的一个子空间，其中 $\\mathbf{v}_1 = (1, 1, 1)$，$\\mathbf{v}_2 = (0, 1, 2)$。\n\n给定向量 $\\mathbf{u} = (1, 1, 0)$，求 $\\mathbf{u}$ 与子空间 $W$ 之间的最短距离。该距离由给定内积诱导的范数定义，即 $d(\\mathbf{x}, \\mathbf{y}) = \\|\\mathbf{x} - \\mathbf{y}\\| = \\sqrt{\\langle \\mathbf{x} - \\mathbf{y}, \\mathbf{x} - \\mathbf{y} \\rangle}$。\n\n将答案表示为一个实数，四舍五入到三位有效数字。", "solution": "我们在 $\\mathbb{R}^{3}$ 中进行计算，其内积为 $\\langle \\mathbf{x}, \\mathbf{y} \\rangle = 3x_{1}y_{1} + 2x_{2}y_{2} + x_{3}y_{3}$，诱导出的范数为 $\\|\\mathbf{x}\\| = \\sqrt{\\langle \\mathbf{x}, \\mathbf{x} \\rangle}$。从 $\\mathbf{u}$ 到 $W$ 的最短距离是 $\\|\\mathbf{u} - \\mathbf{p}\\|$，其中 $\\mathbf{p}$ 是 $\\mathbf{u}$ 在子空间 $W = \\operatorname{span}\\{\\mathbf{v}_{1}, \\mathbf{v}_{2}\\}$ 上关于此内积的正交投影。投影 $\\mathbf{p}$ 满足对于 $i=1,2$ 都有 $\\langle \\mathbf{u} - \\mathbf{p}, \\mathbf{v}_{i} \\rangle = 0$。设 $\\mathbf{p} = a_{1}\\mathbf{v}_{1} + a_{2}\\mathbf{v}_{2}$，则系数满足正规方程 $G\\mathbf{a} = \\mathbf{b}$，其中 $G_{ij} = \\langle \\mathbf{v}_{i}, \\mathbf{v}_{j} \\rangle$ 且 $b_{i} = \\langle \\mathbf{u}, \\mathbf{v}_{i} \\rangle$。\n\n已知 $\\mathbf{v}_{1} = (1,1,1)$，$\\mathbf{v}_{2} = (0,1,2)$ 和 $\\mathbf{u} = (1,1,0)$，我们计算：\n$$\ng_{11} = \\langle \\mathbf{v}_{1}, \\mathbf{v}_{1} \\rangle = 3+2+1 = 6,\\quad\ng_{12} = \\langle \\mathbf{v}_{1}, \\mathbf{v}_{2} \\rangle = 0+2+2 = 4,\\quad\ng_{22} = \\langle \\mathbf{v}_{2}, \\mathbf{v}_{2} \\rangle = 0+2+4 = 6,\n$$\n所以 $G = \\begin{pmatrix}6 & 4 \\\\ 4 & 6\\end{pmatrix}$。同样地，\n$$\nb_{1} = \\langle \\mathbf{u}, \\mathbf{v}_{1} \\rangle = 3+2+0 = 5,\\quad\nb_{2} = \\langle \\mathbf{u}, \\mathbf{v}_{2} \\rangle = 0+2+0 = 2,\n$$\n所以 $\\mathbf{b} = \\begin{pmatrix}5 \\\\ 2\\end{pmatrix}$。解方程组：\n$$\n\\begin{pmatrix}6 & 4 \\\\ 4 & 6\\end{pmatrix}\\begin{pmatrix}a_{1} \\\\ a_{2}\\end{pmatrix} = \\begin{pmatrix}5 \\\\ 2\\end{pmatrix}.\n$$\n由 $6a_{1}+4a_{2}=5$ 和 $4a_{1}+6a_{2}=2$，两式相减得到 $2a_{1}-2a_{2}=3$，因此 $a_{1}=a_{2}+\\frac{3}{2}$。将其代入 $4a_{1}+6a_{2}=2$ 得到 $10a_{2}+6=2$，所以 $a_{2}=-\\frac{2}{5}$ 且 $a_{1}=\\frac{11}{10}$。\n\n因此\n$$\n\\mathbf{p} = a_{1}\\mathbf{v}_{1}+a_{2}\\mathbf{v}_{2} = \\left(\\frac{11}{10},\\, \\frac{7}{10},\\, \\frac{3}{10}\\right),\n\\quad\n\\mathbf{r} = \\mathbf{u} - \\mathbf{p} = \\left(-\\frac{1}{10},\\, \\frac{3}{10},\\, -\\frac{3}{10}\\right).\n$$\n距离的平方为\n$$\n\\|\\mathbf{r}\\|^{2} = \\langle \\mathbf{r}, \\mathbf{r} \\rangle = 3\\left(\\frac{1}{10}\\right)^{2} + 2\\left(\\frac{3}{10}\\right)^{2} + \\left(\\frac{3}{10}\\right)^{2} = \\frac{3}{100} + \\frac{18}{100} + \\frac{9}{100} = \\frac{30}{100} = \\frac{3}{10}.\n$$\n因此，最短距离为\n$$\n\\|\\mathbf{r}\\| = \\sqrt{\\frac{3}{10}}.\n$$\n数值上，$\\sqrt{\\frac{3}{10}} \\approx 0.5477225575$，四舍五入到三位有效数字是 $0.548$。", "answer": "$$\\boxed{0.548}$$", "id": "1350609"}, {"introduction": "线性代数的强大之处在于其概念可以从我们熟悉的 $\\mathbb{R}^n$ 空间推广到更抽象的向量空间，例如函数空间。在这个练习 [@problem_id:1350611] 中，你将不再处理离散的向量，而是要为连续函数 $f(t) = \\exp(t)$ 寻找一个最佳的多项式“替身”。通过使用积分定义的内积，你将应用最佳逼近定理来解决一个实际的函数近似问题，这是信号处理和数值分析等领域的基础。", "problem": "设 $V$ 是定义在区间 $[-1, 1]$ 上的连续实值函数构成的向量空间。该空间上定义了内积 $\\langle f, g \\rangle = \\int_{-1}^{1} f(t)g(t) dt$。\n\n考虑 $V$ 的一个子空间 $W$，它由所有满足条件 $p(0) = 0$ 的二次多项式 $p(t)$ 构成。\n\n你的任务是求出子空间 $W$ 中的一个特定多项式 $p(t)$，它是在区间 $[-1, 1]$ 上对函数 $f(t) = \\exp(t)$ 的最佳逼近。这里的“最佳逼近”是指能够最小化平方距离 $\\| f - p \\|^2$ 的多项式 $p(t) \\in W$，其中范数 $\\| \\cdot \\|$ 由给定的内积导出。\n\n请将你的答案表示为关于变量 $t$ 的多项式。", "solution": "我们要求解函数 $f(t)=\\exp(t)$ 在子空间 $W=\\{p(t)=a t + b t^{2}\\}$ 上的正交投影，其内积为 $\\langle f,g\\rangle=\\int_{-1}^{1} f(t)g(t)\\,dt$。根据内积空间中最佳逼近的正交性原理，误差 $f-p$ 必须与 $W$ 正交。使用 $W$ 的基 $\\{t,t^{2}\\}$，可得到以下正规方程组\n$$\n\\langle \\exp(t) - (a t + b t^{2}),\\, t\\rangle=0,\\qquad \\langle \\exp(t) - (a t + b t^{2}),\\, t^{2}\\rangle=0.\n$$\n等价地，\n$$\n\\langle \\exp(t), t\\rangle = a \\langle t,t\\rangle + b \\langle t^{2},t\\rangle,\\qquad\n\\langle \\exp(t), t^{2}\\rangle = a \\langle t,t^{2}\\rangle + b \\langle t^{2},t^{2}\\rangle.\n$$\n计算 Gram 矩阵的元素：\n$$\n\\langle t,t\\rangle=\\int_{-1}^{1} t^{2}\\,dt=\\frac{2}{3},\\quad\n\\langle t^{2},t\\rangle=\\int_{-1}^{1} t^{3}\\,dt=0,\\quad\n\\langle t^{2},t^{2}\\rangle=\\int_{-1}^{1} t^{4}\\,dt=\\frac{2}{5}.\n$$\n因此，方程组解耦为：\n$$\na=\\frac{\\langle \\exp(t), t\\rangle}{\\langle t,t\\rangle},\\qquad b=\\frac{\\langle \\exp(t), t^{2}\\rangle}{\\langle t^{2},t^{2}\\rangle}.\n$$\n现在计算所需的内积。首先，\n$$\n\\langle \\exp(t), t\\rangle=\\int_{-1}^{1} t \\exp(t)\\,dt.\n$$\n使用分部积分法，令 $u=t$，$dv=\\exp(t)\\,dt$（因此 $du=dt$，$v=\\exp(t)$），我们发现\n$$\n\\int t \\exp(t)\\,dt = t \\exp(t) - \\int \\exp(t)\\,dt = (t-1)\\exp(t) + C,\n$$\n因此\n$$\n\\langle \\exp(t), t\\rangle = \\left[(t-1)\\exp(t)\\right]_{-1}^{1} = 0 - \\left[(-2)\\exp(-1)\\right] = 2 \\exp(-1).\n$$\n接下来，\n$$\n\\langle \\exp(t), t^{2}\\rangle=\\int_{-1}^{1} t^{2} \\exp(t)\\,dt.\n$$\n使用分部积分，令 $u=t^{2}$，$dv=\\exp(t)\\,dt$（因此 $du=2t\\,dt$，$v=\\exp(t)$），我们得到\n$$\n\\int t^{2} \\exp(t)\\,dt = t^{2} \\exp(t) - \\int 2 t \\exp(t)\\,dt.\n$$\n使用前面 $\\int t \\exp(t)\\,dt = (t-1)\\exp(t)$ 的结果，我们得到\n$$\n\\int t^{2} \\exp(t)\\,dt = t^{2} \\exp(t) - 2 (t-1)\\exp(t) = \\exp(t)\\,(t^{2} - 2 t + 2) + C,\n$$\n所以\n$$\n\\langle \\exp(t), t^{2}\\rangle = \\left[\\exp(t)\\,(t^{2} - 2 t + 2)\\right]_{-1}^{1} = \\exp(1)\\cdot 1 - \\exp(-1)\\cdot 5 = \\exp(1) - 5 \\exp(-1).\n$$\n将结果代回，\n$$\na=\\frac{2 \\exp(-1)}{2/3}=3 \\exp(-1),\\qquad b=\\frac{\\exp(1) - 5 \\exp(-1)}{2/5}=\\frac{5}{2}\\bigl(\\exp(1) - 5 \\exp(-1)\\bigr).\n$$\n因此，$W$ 中的最佳逼近多项式是\n$$\np(t)=a t + b t^{2} = 3 \\exp(-1)\\, t + \\frac{5}{2}\\bigl(\\exp(1) - 5 \\exp(-1)\\bigr) t^{2}.\n$$\n该多项式满足 $p(0)=0$ 并且在 $W$ 上最小化了 $\\| \\exp(t) - p \\|^{2}$。", "answer": "$$\\boxed{3 \\exp(-1)\\, t + \\frac{5}{2}\\bigl(\\exp(1) - 5 \\exp(-1)\\bigr) t^{2}}$$", "id": "1350611"}, {"introduction": "在函数空间中寻找最佳逼近有时并不需要复杂的积分计算。如果能巧妙地利用空间的结构，问题可能会变得异常简单。这个练习 [@problem_id:1350590] 展示了这样一个优雅的例子，它利用了函数的奇偶对称性。你将发现，任何一个函数都可以被唯一地分解为一个偶函数和一个奇函数之和，而这种分解恰好是一种正交分解，这使得寻找在偶函数子空间中的最佳逼近变得轻而易举。", "problem": "考虑向量空间 $V = C[-\\pi, \\pi]$，它由区间 $[-\\pi, \\pi]$ 上的所有连续实值函数组成。该空间上定义了内积 $\\langle f, g \\rangle = \\int_{-\\pi}^{\\pi} f(t)g(t) \\, dt$。令 $W_e$ 为 $V$ 中包含所有偶函数的子空间，即满足对所有 $t \\in [-\\pi, \\pi]$ 都有 $h(-t) = h(t)$ 的函数 $h(t)$。\n\n考虑 $V$ 中的具体函数 $f(t)$，其分段定义如下：\n$$\nf(t) = \\begin{cases}\n\\pi t - t^2 & \\text{若 } 0 \\le t \\le \\pi \\\\\n0 & \\text{若 } -\\pi \\le t < 0\n\\end{cases}\n$$\n求函数 $g(t) \\in W_e$，使其成为 $f(t)$ 的最佳逼近。最佳逼近是使距离 $\\|f-g\\| = \\sqrt{\\langle f-g, f-g \\rangle}$ 最小化的函数 $g(t)$。\n\n给出 $g(t)$ 在 $t \\in [-\\pi, \\pi]$ 上的显式函数形式。", "solution": "我们在实内积空间 $V=C[-\\pi,\\pi]$ 中进行计算，其内积为 $\\langle f,g\\rangle=\\int_{-\\pi}^{\\pi}f(t)g(t)\\,dt$。令 $W_{e}$ 为偶函数子空间。$W_{e}$ 的正交补是奇函数子空间 $W_{o}$，因为如果 $u$ 是偶函数，$v$ 是奇函数，那么 $uv$ 是奇函数，且\n$$\n\\langle u,v\\rangle=\\int_{-\\pi}^{\\pi}u(t)v(t)\\,dt=0\n$$\n根据对称区间上积分的对称性。因此 $V=W_{e}\\oplus W_{o}$ 是一个正交直和。\n\n对于任意 $f\\in V$，$f$ 到 $W_{e}$ 上的正交投影是其偶部\n$$\nP_{e}f(t)=\\frac{f(t)+f(-t)}{2},\n$$\n因为 $f=P_{e}f+P_{o}f$，其中 $P_{o}f(t)=\\frac{f(t)-f(-t)}{2}$ 是奇函数，且 $P_{e}f\\in W_{e}$ 而 $P_{o}f\\in W_{o}$。\n\n因此，在给定范数下，$f$ 在 $W_{e}$ 中的最佳逼近 $g$ 是\n$$\ng(t)=\\frac{f(t)+f(-t)}{2}.\n$$\n已知\n$$\nf(t)=\\begin{cases}\n\\pi t - t^{2} & \\text{若 } 0\\le t\\le \\pi,\\\\\n0 & \\text{若 } -\\pi\\le t<0,\n\\end{cases}\n$$\n我们分段计算 $f(-t)$。当 $t\\in[0,\\pi]$ 时，有 $-t\\in[-\\pi,0]$，所以 $f(-t)=0$。当 $t\\in[-\\pi,0]$ 时，有 $-t\\in[0,\\pi]$，所以\n$$\nf(-t)=\\pi(-t)-(-t)^{2}=-\\pi t - t^{2}.\n$$\n因此\n- 当 $t\\in[0,\\pi]$ 时，\n$$\ng(t)=\\frac{(\\pi t - t^{2})+0}{2}=\\frac{\\pi t - t^{2}}{2},\n$$\n- 当 $t\\in[-\\pi,0]$ 时，\n$$\ng(t)=\\frac{0+(-\\pi t - t^{2})}{2}=\\frac{-\\pi t - t^{2}}{2}.\n$$\n等价地，将这些结果合并成一个偶函数表达式，\n$$\ng(t)=\\frac{\\pi|t| - t^{2}}{2},\\quad t\\in[-\\pi,\\pi].\n$$\n这个函数 $g$ 是偶函数，且满足 $f-g$ 是奇函数，因此对于所有偶函数 $h$，都有 $\\langle f-g,h\\rangle=0$，这证实了 $g$ 是正交投影，因而是 $W_{e}$ 中的最佳逼近。", "answer": "$$\\boxed{\\frac{\\pi|t|-t^{2}}{2}}$$", "id": "1350590"}]}