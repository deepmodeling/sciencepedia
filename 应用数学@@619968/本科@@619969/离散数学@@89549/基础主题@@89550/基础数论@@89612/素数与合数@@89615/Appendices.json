{"hands_on_practices": [{"introduction": "判断一个数是素数还是合数是数论中的一个基本问题。本练习通过一个名为“有限素性筛法”的假设算法，引导我们探索最基础的素性测试方法——试除法——的有效性及其边界。通过找出该算法会“误判”的最小合数，我们将亲自验证并深刻理解一个关键定理：任何大于1的合数 $n$ 必有一个不超过 $\\sqrt{n}$ 的素因子，这是所有素性测试算法的理论基石。[@problem_id:1392441]", "problem": "在一个密码密钥生成过程的初步步骤中，一种名为有限素性筛选（LPS）的算法被用来快速排除合数。LPS算法接收一个整数 $n > 1$ 和一个固定的整数测试上限 $L$ 作为输入。其过程是测试 $n$ 是否能被任何满足 $p \\le L$ 的素数 $p$ 整除。如果找到了这样的素因子，算法会终止并正确地将 $n$ 识别为合数。然而，如果 $n$ 不能被任何小于或等于 $L$ 的素数整除，算法会将 $n$ 分类为“可能素数”。\n\n这种分类并不总是正确的，因为一些合数也可能被指定为“可能素数”。这些数被称为“LPS-欺骗数”。你的任务是找出一个给定测试上限下的最小的此类欺骗数。\n\n给定测试上限 $L = 40$，LPS算法会错误地分类为“可能素数”的最小合数是什么？", "solution": "具有测试上限 $L$ 的有限素性筛选（LPS）算法将一个整数 $n>1$ 分类为“可能素数”，当且仅当没有素数 $p \\leq L$ 能整除 $n$。根据算术基本定理，这等价于说 $n$ 的所有素因子都严格大于 $L$。\n\n我们要寻找没有小于或等于 $L=40$ 的素因子的最小合数 $n$。设 $p$ 是严格大于 $L$ 的最小素数。那么，任何这样的合数 $n$ 的所有素因子都必须至少为 $p$，因此最小的可能性（计算重数）是通过取两个最小的此类素因子的乘积得到的，即\n$$\nn_{\\min} = p^{2}.\n$$\n这是因为任何合数都至少有两个（计入重数）素因子，而使用任何更大的素数只会增加其乘积。\n\n现在我们来确定 $L=40$ 时对应的 $p$。我们通过测试其是否能被小于或等于 $\\sqrt{41}$ 的素数整除来检验 $41$ 的素性。因为\n$$\n\\sqrt{41} < 7,\n$$\n我们只需要测试其是否能被 $2$、$3$ 和 $5$ 整除。我们有\n$$\n41 \\bmod 2 = 1, \\quad 41 \\bmod 3 = 2, \\quad 41 \\bmod 5 = 1,\n$$\n所以 $41$ 是素数。因此 $p=41$，并且所有素因子都大于 $40$ 的最小合数是\n$$\nn_{\\min} = 41^{2}.\n$$\n使用二项式恒等式 $(a+b)^{2}=a^{2}+2ab+b^{2}$，令 $a=40$ 和 $b=1$ 进行计算：\n$$\n41^{2} = (40+1)^{2} = 40^{2} + 2 \\cdot 40 \\cdot 1 + 1^{2} = 1600 + 80 + 1 = 1681.\n$$\n最后，由于 $1681$ 的唯一素因子是 $41$ 且 $41>40$，测试上限为 $L=40$ 的LPS算法不会测试其是否能被 $41$ 整除，因此会错误地将 $1681$ 分类为“可能素数”。根据上述的最小性论证，没有更小的合数可以避开所有小于或等于 $40$ 的素因子。\n\n因此，对于 $L=40$，最小的LPS-欺骗数是 $1681$。", "answer": "$$\\boxed{1681}$$", "id": "1392441"}, {"introduction": "在掌握了如何区分素数与合数之后，我们可以进一步探索素数自身的优美结构。本练习以“孪生素数”这一迷人的现象为切入点，要求我们从计算转向逻辑推理，通过分析大于3的孪生素数对 $(p, p+2)$ 与其邻近整数的关系，来证明一个必然存在的整除性质。这个练习将帮助我们体会，如何仅用简单的数论属性进行严谨的数学论证。[@problem_id:1392473]", "problem": "如果两个素数相差为2，则称它们为孪生素数。例如，(3, 5)，(5, 7) 和 (11, 13) 都是孪生素数对。\n\n考虑任意一对孪生素数 $(p, p+2)$，其中较小的素数 $p$ 大于 3。对于每一对这样的孪生素数，能够保证整除这两个素数之和 $p + (p+2)$ 的最大正整数是什么？\n\nA. 2\n\nB. 3\n\nC. 4\n\nD. 6\n\nE. 12\n\nF. 24", "solution": "设 $(p, p+2)$ 为一对孪生素数，其中 $p>3$。定义其和为\n$$S = p + (p+2) = 2p + 2 = 2(p+1).$$\n我们证明 12 总是整除 $S$。\n\n首先，因为 $p>3$ 是一个素数，它不可能是偶数（唯一的偶素数是2），所以 $p$ 是奇数。因此 $p+1$ 是偶数，所以\n$$2 \\mid (p+1).$$\n\n其次，在三个连续整数 $p, p+1, p+2$ 中，恰好有一个能被 3 整除。因为 $p$ 和 $p+2$ 是大于 3 的素数，所以它们都不能被 3 整除。因此，\n$$3 \\mid (p+1).$$\n\n综合以上两点，$2 \\mid (p+1)$ 和 $3 \\mid (p+1)$ 意味着\n$$6 \\mid (p+1).$$\n两边乘以 2 可得\n$$12 \\mid 2(p+1) = S.$$\n因此，对于每一对这样的孪生素数，12 都能整除其和。\n\n为检验在所给选项中 12 是否为最大值，取孪生素数对 $(5,7)$，其中 $p=5>3$。那么\n$$S = 5 + 7 = 12,$$\n该和不能被 24 整除。因此，不能保证 24 是除数，所以在选项中 12 是能被保证的最大除数。\n\n因此，正确选项是 E。", "answer": "$$\\boxed{E}$$", "id": "1392473"}, {"introduction": "素数分解不仅仅是理论概念，更是解决其他数学分支中复杂计算问题的强大工具。本练习将素数理论与组合数学相结合，挑战我们去确定一个巨大的二项式系数 $\\binom{200}{75}$ 中包含特定素因子的数量。要解决这个问题，我们需要应用勒让德公式来分析阶乘的素数构成，这让我们能够亲手实践素数分解在算法和计算科学中的强大威力。[@problem_id:1392437]", "problem": "二项式系数，记作 $\\binom{n}{k}$，表示从一个包含 $n$ 个元素的集合中选取 $k$ 个元素的方法数。对于非负整数 $n$ 和 $k$ 且满足 $n \\ge k$ 的情况，其定义为 $\\binom{n}{k} = \\frac{n!}{k!(n-k)!}$。\n\n考虑二项式系数 $N = \\binom{200}{75}$ 的整数值。请确定最大的整数 $x$，使得 $390^x$ 是 $N$ 的一个因数。", "solution": "该问题要求解最大的整数 $x$，使得 $390^x$ 能整除 $N = \\binom{200}{75}$。这是一个关于二项式系数素因数分解的问题。\n\n首先，我们对底数 390 进行素因数分解。\n$390 = 10 \\times 39 = (2 \\times 5) \\times (3 \\times 13) = 2 \\times 3 \\times 5 \\times 13$。\n要使 $390^x = (2 \\cdot 3 \\cdot 5 \\cdot 13)^x = 2^x \\cdot 3^x \\cdot 5^x \\cdot 13^x$ 能整除 $N$，则 $N$ 的素因数分解中，每个素数（2、3、5 和 13）的指数必须至少为 $x$。\n设 $e_p(m)$ 表示素数 $p$ 在整数 $m$ 的素因数分解中的指数。我们需要求出 $p \\in \\{2, 3, 5, 13\\}$ 时 $e_p(N)$ 的值。最大的整数 $x$ 即为这些指数的最小值：\n$x = \\min(e_2(N), e_3(N), e_5(N), e_{13}(N))$。\n\n为了求出素数 $p$ 在 $n!$ 的素因数分解中的指数，我们使用勒让德公式：\n$E_p(n!) = \\sum_{i=1}^{\\infty} \\left\\lfloor \\frac{n}{p^i} \\right\\rfloor$。\n当 $p^i > n$ 时，$\\lfloor \\frac{n}{p^i} \\rfloor$ 项变为零，因此该求和是有限的。\n\n素数 $p$ 在 $N = \\binom{n}{k} = \\frac{n!}{k!(n-k)!}$ 的素因数分解中的指数由以下公式给出：\n$e_p(N) = E_p(n!) - E_p(k!) - E_p((n-k)!)$。\n在本题中，$n=200$，$k=75$，所以 $n-k = 125$。\n\n现在我们计算 390 的每个素因子的指数。\n\n**1. 素数 $p=2$ 的指数：**\n$E_2(200!) = \\lfloor\\frac{200}{2}\\rfloor + \\lfloor\\frac{200}{4}\\rfloor + \\lfloor\\frac{200}{8}\\rfloor + \\lfloor\\frac{200}{16}\\rfloor + \\lfloor\\frac{200}{32}\\rfloor + \\lfloor\\frac{200}{64}\\rfloor + \\lfloor\\frac{200}{128}\\rfloor = 100 + 50 + 25 + 12 + 6 + 3 + 1 = 197$。\n$E_2(75!) = \\lfloor\\frac{75}{2}\\rfloor + \\lfloor\\frac{75}{4}\\rfloor + \\lfloor\\frac{75}{8}\\rfloor + \\lfloor\\frac{75}{16}\\rfloor + \\lfloor\\frac{75}{32}\\rfloor + \\lfloor\\frac{75}{64}\\rfloor = 37 + 18 + 9 + 4 + 2 + 1 = 71$。\n$E_2(125!) = \\lfloor\\frac{125}{2}\\rfloor + \\lfloor\\frac{125}{4}\\rfloor + \\lfloor\\frac{125}{8}\\rfloor + \\lfloor\\frac{125}{16}\\rfloor + \\lfloor\\frac{125}{32}\\rfloor + \\lfloor\\frac{125}{64}\\rfloor = 62 + 31 + 15 + 7 + 3 + 1 = 119$。\n所以，$e_2(N) = E_2(200!) - E_2(75!) - E_2(125!) = 197 - 71 - 119 = 7$。\n\n**2. 素数 $p=3$ 的指数：**\n$E_3(200!) = \\lfloor\\frac{200}{3}\\rfloor + \\lfloor\\frac{200}{9}\\rfloor + \\lfloor\\frac{200}{27}\\rfloor + \\lfloor\\frac{200}{81}\\rfloor = 66 + 22 + 7 + 2 = 97$。\n$E_3(75!) = \\lfloor\\frac{75}{3}\\rfloor + \\lfloor\\frac{75}{9}\\rfloor + \\lfloor\\frac{75}{27}\\rfloor = 25 + 8 + 2 = 35$。\n$E_3(125!) = \\lfloor\\frac{125}{3}\\rfloor + \\lfloor\\frac{125}{9}\\rfloor + \\lfloor\\frac{125}{27}\\rfloor + \\lfloor\\frac{125}{81}\\rfloor = 41 + 13 + 4 + 1 = 59$。\n所以，$e_3(N) = E_3(200!) - E_3(75!) - E_3(125!) = 97 - 35 - 59 = 3$。\n\n**3. 素数 $p=5$ 的指数：**\n$E_5(200!) = \\lfloor\\frac{200}{5}\\rfloor + \\lfloor\\frac{200}{25}\\rfloor + \\lfloor\\frac{200}{125}\\rfloor = 40 + 8 + 1 = 49$。\n$E_5(75!) = \\lfloor\\frac{75}{5}\\rfloor + \\lfloor\\frac{75}{25}\\rfloor = 15 + 3 = 18$。\n$E_5(125!) = \\lfloor\\frac{125}{5}\\rfloor + \\lfloor\\frac{125}{25}\\rfloor + \\lfloor\\frac{125}{125}\\rfloor = 25 + 5 + 1 = 31$。\n所以，$e_5(N) = E_5(200!) - E_5(75!) - E_5(125!) = 49 - 18 - 31 = 0$。\n\n**4. 素数 $p=13$ 的指数：**\n$E_{13}(200!) = \\lfloor\\frac{200}{13}\\rfloor + \\lfloor\\frac{200}{169}\\rfloor = 15 + 1 = 16$。\n$E_{13}(75!) = \\lfloor\\frac{75}{13}\\rfloor = 5$。\n$E_{13}(125!) = \\lfloor\\frac{125}{13}\\rfloor = 9$。\n所以，$e_{13}(N) = E_{13}(200!) - E_{13}(75!) - E_{13}(125!) = 16 - 5 - 9 = 2$。\n\n$N = \\binom{200}{75}$ 的素因数分解形式为 $2^7 \\cdot 3^3 \\cdot 5^0 \\cdot 13^2 \\cdot \\dots$。\n要使 $390^x = 2^x \\cdot 3^x \\cdot 5^x \\cdot 13^x$ 能整除 $N$，整数 $x$ 必须满足以下条件：\n$x \\le e_2(N) \\implies x \\le 7$\n$x \\le e_3(N) \\implies x \\le 3$\n$x \\le e_5(N) \\implies x \\le 0$\n$x \\le e_{13}(N) \\implies x \\le 2$\n\n为了同时满足所有这些条件，$x$ 必须小于或等于这些指数中的最小值。\n$x \\le \\min(7, 3, 0, 2) = 0$。\n满足此条件的最大整数 $x$ 是 $x=0$。\n这意味着 $N$ 不能被 5 整除，因此也不能被 390 整除。最高次幂是 $390^0=1$。", "answer": "$$\\boxed{0}$$", "id": "1392437"}]}