{"hands_on_practices": [{"introduction": "在我们深入研究计算收集所有优惠券所需期望时间的复杂性之前，我们可以通过一个简单的对称性论证来获得深刻的见解。这个问题提出了一个看似棘手但答案却异常简洁的问题：任何一张特定的“传奇”优惠券，成为你集齐整套的最后一张的概率是多少？通过解决这个问题 [@problem_id:1405927]，你将发现收集过程的一个基本而优美的特性，这为理解更复杂的情景奠定了基础。", "problem": "在热门在线游戏“Chronos Convergence”中，玩家可以收集一套共 $n$ 种不同的数字收藏品。这些收藏品通过开启“时间胶囊”获得。每次开启一个胶囊，会随机揭示 $n$ 种收藏品中的一种，该选择是均匀随机的，并且与之前所有开启的结果相互独立。这意味着玩家可能会获得他们已经拥有的重复收藏品。\n\n在这 $n$ 种收藏品中，有一种被指定为“传奇基石”。只有当玩家集齐了全部 $n$ 种独特的收藏品（每种至少一个）时，其收藏才被视为完整。\n\n假设一个玩家开始时没有任何收藏品。求传奇基石是玩家获得的最后一个*新*收藏品的概率，该收藏品的获得使得全套收藏得以完成。请用关于 $n$ 的封闭形式解析表达式来表示你的答案。", "solution": "设这 $n$ 种不同的收藏品被标记为 $\\{1,2,\\dots,n\\}$，并用 $L$ 表示传奇基石。考虑发现新收藏品的顺序（即，首次获得每一种不同收藏品的次序）。令 $Y_{1},Y_{2},\\dots,Y_{n}$ 为首次获得新收藏品时该收藏品的标识；因此 $\\{Y_{1},\\dots,Y_{n}\\}$ 是这 $n$ 个标签的一个排列。\n\n固定任意 $k\\in\\{1,\\dots,n\\}$。假设已经收集了 $k-1$ 种不同的收藏品。在下一次获得新收藏品时，该收藏品是尚未见过的 $n-(k-1)$ 种中的任何特定一种的条件概率计算如下。在任何单次抽取中，获得一个特定的未见收藏品的概率是 $\\frac{1}{n}$，而获得任何一个未见收藏品的概率是 $\\frac{n-(k-1)}{n}$。根据条件概率的定义，\n$$\n\\Pr(\\text{下个新收藏品是给定的一种}\\mid \\text{下次抽取是新的})\n=\\frac{\\frac{1}{n}}{\\frac{n-(k-1)}{n}}=\\frac{1}{n-(k-1)}.\n$$\n因此，对于这 $n$ 种收藏品的任意一个固定排列 $(y_{1},y_{2},\\dots,y_{n})$，其作为首次出现顺序的概率为\n$$\n\\Pr(Y_{1}=y_{1},\\dots,Y_{n}=y_{n})\n=\\prod_{k=1}^{n}\\frac{1}{n-(k-1)}=\\frac{1}{n!}.\n$$\n因此，首次出现的顺序在所有 $n!$ 种排列上是均匀分布的。传奇基石 $L$ 是最后一个新收藏品这一事件，对应于所有 $L$ 在第 $n$ 个位置的排列，这样的排列有 $(n-1)!$ 种。因此\n$$\n\\Pr(Y_{n}=L)=\\frac{(n-1)!}{n!}=\\frac{1}{n}.\n$$\n这就是所求的概率。", "answer": "$$\\boxed{\\frac{1}{n}}$$", "id": "1405927"}, {"introduction": "现在，让我们从另一个角度审视这个问题。我们不再问集齐所有优惠券需要多长时间，而是问需要多长时间才会遇到第一个*重复*的优惠券。这个问题 [@problem_id:1405975] 是著名的“生日问题”的一个变体，它有助于我们建立关于重复项出现速度的直觉。理解了这一点，你就能更好地体会到为什么完成整个收藏的后期阶段会变得越来越困难。", "problem": "一家名为“The Quirky Quokka”的人气咖啡店推出了一项数字忠诚度计划，以提升顾客参与度。顾客每购买一杯咖啡，就会获得一枚数字徽章。徽章共有四种不同的类型，每次购买时，顾客会以相等的概率获得四种徽章中的任意一种，且每次获得徽章的事件与之前获得的徽章相互独立。\n\n一位新顾客开始收集这些徽章。该顾客直到收到第一枚重复徽章时，需要购买咖啡的期望数量是多少？请将答案表示为最简分数形式。", "solution": "设 $T$ 为直到出现第一枚重复徽章所需的购买次数。根据非负整数值随机变量的尾和公式，\n$$\n\\mathbb{E}[T]=\\sum_{k=0}^{\\infty}\\mathbb{P}(T>k),\n$$\n其中 $\\mathbb{P}(T>k)$ 是指在前 $k$ 次购买中没有出现重复徽章的概率。\n\n共有 $4$ 种等概率且独立授予的徽章类型。事件 $T>k$ 意味着所获得的所有 $k$ 枚徽章都各不相同。这仅在 $k\\leq 4$ 时才有可能，因此对于 $k\\geq 5$，有 $\\mathbb{P}(T>k)=0$。计算 $k=0,1,2,3,4$ 时的情况：\n- 对于 $k=0$，显然 $\\mathbb{P}(T>0)=1$。\n- 对于 $k=1$，由于只有一枚徽章，不可能出现重复，所以 $\\mathbb{P}(T>1)=1$。\n- 对于 $k=2$，第二枚徽章必须与第一枚不同，其概率为 $\\frac{3}{4}$；因此 $\\mathbb{P}(T>2)=\\frac{3}{4}$。\n- 对于 $k=3$，第二枚必须与第一枚不同（概率为 $\\frac{3}{4}$），且第三枚必须与前两枚不同（概率为 $\\frac{2}{4}$），所以\n$$\n\\mathbb{P}(T>3)=\\frac{3}{4}\\cdot\\frac{2}{4}=\\frac{3}{8}.\n$$\n- 对于 $k=4$，以此类推，第四枚徽章必须与前三枚都不同，其概率为 $\\frac{1}{4}$，因此\n$$\n\\mathbb{P}(T>4)=\\frac{3}{4}\\cdot\\frac{2}{4}\\cdot\\frac{1}{4}=\\frac{3}{32}.\n$$\n\n因此，\n$$\n\\mathbb{E}[T]=1+1+\\frac{3}{4}+\\frac{3}{8}+\\frac{3}{32}\n=\\frac{32}{32}+\\frac{32}{32}+\\frac{24}{32}+\\frac{12}{32}+\\frac{3}{32}\n=\\frac{103}{32}.\n$$\n因此，直到获得第一枚重复徽章所需的期望购买次数为 $\\frac{103}{32}$。", "answer": "$$\\boxed{\\frac{103}{32}}$$", "id": "1405975"}, {"introduction": "我们已经从对称性和“重复”的视角探讨了收集过程，现在是时候处理一个更贴近现实的应用场景了。在许多游戏中或现实世界的促销活动中，收藏品通常被分为不同稀有度和获取成本的类别。这个练习 [@problem_id:1405952] 要求你将一个大的收藏问题分解为几个独立的子问题，并利用期望的线性性质来计算总成本。这是一个极好的实践，可以锻炼你将复杂问题分解为可管理部分的核心解题能力。", "problem": "一款电子游戏有一个系统，玩家可以在其中获取装饰性物品。总共有 $n$ 种不同的可用物品。这些物品分为两个等级：一个包含 $n-k$ 种独特物品的“标准”等级和一个包含 $k$ 种独特物品的“神话”等级，其中 $1 \\le k < n$。\n\n物品可以从两种不同类型的游戏内宝箱中获得：\n1.  一个“标准宝箱”需要花费 $C$ 单位的游戏内货币来开启，并会给予玩家一个从 $n-k$ 种标准物品中均匀随机选择的物品。\n2.  一个“神话宝箱”需要花费 $2C$ 单位的货币来开启，并会给予玩家一个从 $k$ 种神话物品中均匀随机选择的物品。\n\n玩家可以随时选择开启任一类型的宝箱。一位专注的收藏家想要获得所有 $n$ 种物品的完整集合。为此，他们将购买标准宝箱，直到收集完所有标准物品，并购买神话宝箱，直到收集完所有神话物品。\n\n为了获得每一种（共 $n$ 种）不同物品至少一个，收藏家必须花费的货币总期望金额是多少？请用一个关于 $n$、$k$ 和 $C$ 的闭式解析表达式给出你的答案。", "solution": "标准物品收藏和神话物品收藏是两个独立的子问题，因为开启一种类型的宝箱不会影响另一种类型宝箱中物品的分布。根据期望的线性性，花费的货币总期望值是完成标准物品集和神话物品集所需期望金额的总和。\n\n首先考虑包含 $m_{s}=n-k$ 种不同物品的标准物品集。每个标准宝箱会从这 $m_{s}$ 种物品中均匀地随机产出一个物品。这是经典的优惠券收集问题。如果已经收集了 $j$ 种不同的物品，那么下一个标准宝箱开出新物品的概率是 $(m_{s}-j)/m_{s}$。因此，为了获得下一个新物品，需要额外开启的标准宝箱的期望数量为\n$$\n\\frac{1}{(m_{s}-j)/m_{s}}=\\frac{m_{s}}{m_{s}-j}.\n$$\n对 $j=0,1,\\ldots,m_{s}-1$ 求和，得到集齐标准物品集所需的标准宝箱的期望数量：\n$$\n\\sum_{j=0}^{m_{s}-1}\\frac{m_{s}}{m_{s}-j}\n=m_{s}\\sum_{i=1}^{m_{s}}\\frac{1}{i}.\n$$\n由于每个标准宝箱的花费为 $C$，因此在标准宝箱上花费的期望货币为\n$$\nC\\,m_{s}\\sum_{i=1}^{m_{s}}\\frac{1}{i}\n= C\\,(n-k)\\sum_{i=1}^{n-k}\\frac{1}{i}.\n$$\n\n现在考虑包含 $m_{m}=k$ 种不同物品的神话物品集。根据同样的优惠券收集问题推理，所需的神话宝箱的期望数量为\n$$\n\\sum_{j=0}^{k-1}\\frac{k}{k-j}\n= k\\sum_{i=1}^{k}\\frac{1}{i}.\n$$\n每个神话宝箱的花费为 $2C$，因此在神话宝箱上花费的期望货币为\n$$\n2C\\,k\\sum_{i=1}^{k}\\frac{1}{i}.\n$$\n\n将两部分的贡献相加，获得每一种（共 $n$ 种）物品至少一个所需的总期望货币金额为\n$$\nC\\,(n-k)\\sum_{i=1}^{n-k}\\frac{1}{i} \\;+\\; 2C\\,k\\sum_{i=1}^{k}\\frac{1}{i}.\n$$\n等价地，用调和数 $H_{m}=\\sum_{i=1}^{m}\\frac{1}{i}$ 来表示，结果为 $C\\left((n-k)H_{n-k}+2kH_{k}\\right)$。", "answer": "$$\\boxed{C\\,(n-k)\\sum_{i=1}^{n-k}\\frac{1}{i}\\;+\\;2C\\,k\\sum_{i=1}^{k}\\frac{1}{i}}$$", "id": "1405952"}]}