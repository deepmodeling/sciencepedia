{"hands_on_practices": [{"introduction": "我们经常依赖天气预报来计划活动，但预报“会下雨”究竟意味着下雨的概率有多大？这个练习将贝叶斯定理应用于一个实际场景，教我们如何结合预报模型的准确率和下雨本身的基础概率，来计算出当预报下雨时，实际真的会下雨的后验概率。通过这个练习，你将学会区分预报的准确性与事件发生的真实条件概率，这是评估任何预测或诊断测试的核心技能 [@problem_id:357]。", "problem": "一家本地气象站正在评估其新预报模型的准确性。设 $R$ 为某一天下雨的事件，设 $F$ 为模型预报当天有雨的事件。\n\n该气象站收集了历史数据并确定了以下概率：\n1.  在任意一天下雨的无条件概率为 $P(R) = p_r$。\n2.  在实际下雨的情况下，模型正确预报下雨的概率为 $P(F|R) = p_t$。这代表真阳性率。\n3.  在实际不下雨的情况下，模型错误预报下雨的概率为 $P(F|R^c) = p_f$，其中 $R^c$ 是不下雨的事件。这代表假阳性率。\n\n使用这些概率，推导在模型预报有雨的情况下，实际会下雨的概率的表达式，即 $P(R|F)$。请用 $p_r$、$p_t$ 和 $p_f$ 表示您的答案。", "solution": "我们要求解 $P(R\\mid F)$。根据贝叶斯定理，\n$$\nP(R\\mid F)=\\frac{P(F\\mid R)\\,P(R)}{P(F)}.\n$$\n预报有雨的总概率为\n$$\nP(F)=P(F\\mid R)\\,P(R)+P(F\\mid R^c)\\,P(R^c).\n$$\n代入 $P(R)=p_r$、$P(F\\mid R)=p_t$、$P(F\\mid R^c)=p_f$ 和 $P(R^c)=1-p_r$ 可得\n$$\nP(F)=p_t\\,p_r+p_f\\,(1-p_r).\n$$\n因此\n$$\nP(R\\mid F)\n=\\frac{p_t\\,p_r}{p_t\\,p_r+p_f\\,(1-p_r)}.\n$$", "answer": "$$\\boxed{\\frac{p_t\\,p_r}{p_t\\,p_r+p_f\\,(1-p_r)}}$$", "id": "357"}, {"introduction": "概率论中充满了看似违反直觉的谜题，贝特朗盒子悖论就是其中一个经典的例子。这个问题通过一个巧妙的变体，挑战我们对条件概率的直观理解。通过系统地应用贝叶斯定理，我们可以清晰地剖析问题结构，从而避免直觉陷阱，得出正确的结论，这能极大地锻炼我们精确定义事件和应用条件概率的能力 [@problem_id:691205]。", "problem": "考虑经典的Bertrand箱子悖论的一个变体。现有三个盒子，从外部看无法区分。\n- 盒子1装有两枚金币 (GG)。\n- 盒子2装有两枚银币 (SS)。\n- 盒子3装有一枚金币和一枚银币 (GS)。\n\n与经典悖论不同，这些盒子不是以相等的概率被选择的。选择GG盒子的先验概率是 $p_G$，选择SS盒子的先验概率是 $p_S$，选择GS盒子的先验概率是 $p_M$。这些概率是已知的常数，大于零，且总和为一：$p_G + p_S + p_M = 1$。\n\n进行一个实验：根据这些先验概率选择一个盒子，然后从所选盒子中随机均匀地抽取一枚硬币。经检查，抽出的硬币是金币。\n\n在观察到抽出的第一枚硬币是金币的情况下，推导一个封闭形式的解析表达式，用于计算所选盒子中*另一枚*硬币也是金币的后验概率。用先验概率 $p_G$ 和 $p_M$ 来表示你的答案。", "solution": "我们用事件 $B_{GG},B_{GS},B_{SS}$ 分别表示选择相应盒子的事件，用 $D$ 表示抽到金币的事件。先验概率和条件概率如下：\n$$P(B_{GG})=p_G,\\quad P(B_{GS})=p_M,\\quad P(B_{SS})=p_S,$$\n$$P(D\\mid B_{GG})=1,\\quad P(D\\mid B_{GS})=\\frac{1}{2},\\quad P(D\\mid B_{SS})=0.$$\n\n抽到金币的总概率是\n$$P(D)=p_G\\cdot1 + p_M\\cdot\\frac{1}{2} + p_S\\cdot0 = p_G + \\frac{1}{2}p_M.$$\n\n根据贝叶斯定理，\n$$P(B_{GG}\\mid D)=\\frac{P(D\\mid B_{GG})\\,P(B_{GG})}{P(D)} = \\frac{p_G}{p_G + \\frac{1}{2}p_M}.$$\n\n因为只有GG盒子能确保另一枚硬币是金币，所以我们所求的后验概率是\n$$P(\\text{other coin is gold}\\mid D)=P(B_{GG}\\mid D)=\\frac{p_G}{p_G + \\frac{1}{2}p_M}.$$", "answer": "$$\\boxed{\\frac{p_G}{p_G + \\frac{1}{2}p_M}}$$", "id": "691205"}, {"introduction": "“太阳明天会升起吗？”这个问题听起来更像是哲学思辨，但贝叶斯定理为我们提供了一个量化的分析框架。这个练习将我们带入贝叶斯推断的核心，在这里我们不再是计算孤立事件的概率，而是更新我们对一个未知参数（太阳升起的固有概率 $p$）的信念。通过这个练习，你将了解到如何利用先验分布和观测数据来推导后验分布，这是现代贝叶斯统计学和机器学习的基石 [@problem_id:691480]。", "problem": "一位天文学家正试图确定在任意给定的一天太阳升起的概率。设 $p$ 为这个未知的、恒定的概率。出于一种哲学信念，该天文学家没有使用均匀分布来为其对 $p$ 的先验信念建模，而是使用了形状参数为 $\\alpha$ 和 $1$ 的贝塔分布。$\\text{Beta}(a, b)$ 分布的概率密度函数为 $f(x; a, b) = \\frac{x^{a-1}(1-x)^{b-1}}{B(a,b)}$，其中 $x \\in [0, 1]$，$B(a,b)$ 是贝塔函数。\n\n然后，该天文学家查阅了历史记录，发现已观测到太阳连续 $N$ 天无一例外地升起。假设任意一天观测到日出是一次独立的伯努利试验，其成功概率为 $p$。\n\n使用贝叶斯推断，根据连续 $N$ 次日出的证据，推导在第 $(N+1)$ 天太阳会升起的后验概率。请用 $N$ 和 $\\alpha$ 来表示你的答案。", "solution": "我们有先验 $p\\sim\\mathrm{Beta}(\\alpha,1)$，其密度为\n$$f(p)=\\frac{p^{\\alpha-1}(1-p)^{1-1}}{B(\\alpha,1)}\\,. $$\n给定 $N$ 次独立的日出（全部成功），似然函数为\n$$L(p)=p^N\\,. $$\n根据贝叶斯定理，后验分布为\n$$f(p\\mid\\text{data})\\propto p^{\\alpha-1}(1-p)^{0}\\,p^N\n= p^{(\\alpha+N)-1}(1-p)^{1-1}，$$\n此为 $\\mathrm{Beta}(\\alpha+N,1)$ 分布。第 $N+1$ 天日出的预测概率是后验均值：\n$$\\Pr(\\text{sunrise}_{N+1}\\mid\\text{data})\n=\\int_0^1 p\\,f(p\\mid\\text{data})\\,dp\n=\\frac{\\alpha+N}{(\\alpha+N)+1}\\,. $$", "answer": "$$\\boxed{\\frac{\\alpha+N}{\\alpha+N+1}}$$", "id": "691480"}]}