{"hands_on_practices": [{"introduction": "寻找两点之间的最短路径是图论中的一个基本问题。在许多实际应用中，例如物流网络，某些路径可能因为回程货运或特殊协议而产生负成本（即利润）。这个问题提供了一个在有向无环图（DAG）中计算最短路径的实践机会，特别是在存在负权重边的情况下 [@problem_id:1414557]。通过这个练习，你将应用拓扑排序和动态规划的思想，来高效地解决这类问题，并理解为何DAG的结构特性使其能优雅地处理负权重。", "problem": "一家专业的物流公司为六个数据中心（标记为 A、B、C、D、E 和 F）之间的高价值货物设计了一个运输网络。该网络由几条单向直达路线组成，每条路线都有一个相关的成本。由于特殊协议和回程运输机会，一些路线的成本为负，代表净利润。该网络保证是无环的，这意味着没有路线会回到先前访问过的数据中心。\n\n可用的路线及其成本如下：\n- 从 A 到 B，成本为 4 个单位。\n- 从 A 到 C，成本为 2 个单位。\n- 从 B 到 C，成本为 5 个单位。\n- 从 B 到 D，成本为 10 个单位。\n- 从 C 到 E，成本为 3 个单位。\n- 从 D 到 F，成本为 11 个单位。\n- 从 E 到 D，成本为 4 个单位。\n- 从 E 到 F，成本为 -5 个单位。\n\n您的任务是确定将单个包裹从起始数据中心 A 运输到最终目的地 F 的最小可能总成本。", "solution": "设该有向无环图的顶点为 $V=\\{A,B,C,D,E,F\\}$，带权边为 $(u,v)$，其成本为 $w(u,v)$。我们寻求从 A 到 F 的最小总成本，即找到一条路径 $A \\to \\cdots \\to F$ ，使得沿途的边成本之和最小。\n\n由于该图是无环的，我们可以通过动态规划沿着拓扑顺序计算最短路径距离。与给定边一致的一个有效拓扑顺序是 $A,B,C,E,D,F$，因为在此顺序中，所有边都从较早的顶点指向较晚的顶点：\n- $A \\to B$, $A \\to C$,\n- $B \\to C$, $B \\to D$,\n- $C \\to E$,\n- $E \\to D$, $E \\to F$,\n- $D \\to F$.\n\n初始化距离，$d(A)=0$，对于 $v \\in \\{B,C,D,E,F\\}$，设 $d(v)=+\\infty$。对拓扑顺序中的每个顶点，使用以下公式对其出边进行松弛操作\n$$\nd(v) \\leftarrow \\min\\{d(v),\\, d(u)+w(u,v)\\} \\quad \\text{for each edge } (u,v).\n$$\n\n处理 $A$：\n$$\nd(B)=\\min\\{+\\infty,\\, d(A)+w(A,B)\\}=\\min\\{+\\infty,\\, 0+4\\}=4,\n$$\n$$\nd(C)=\\min\\{+\\infty,\\, d(A)+w(A,C)\\}=\\min\\{+\\infty,\\, 0+2\\}=2.\n$$\n\n处理 $B$：\n$$\nd(C)=\\min\\{2,\\, d(B)+w(B,C)\\}=\\min\\{2,\\, 4+5\\}=\\min\\{2,9\\}=2,\n$$\n$$\nd(D)=\\min\\{+\\infty,\\, d(B)+w(B,D)\\}=\\min\\{+\\infty,\\, 4+10\\}=14.\n$$\n\n处理 $C$：\n$$\nd(E)=\\min\\{+\\infty,\\, d(C)+w(C,E)\\}=\\min\\{+\\infty,\\, 2+3\\}=5.\n$$\n\n处理 $E$：\n$$\nd(D)=\\min\\{14,\\, d(E)+w(E,D)\\}=\\min\\{14,\\, 5+4\\}=\\min\\{14,9\\}=9,\n$$\n$$\nd(F)=\\min\\{+\\infty,\\, d(E)+w(E,F)\\}=\\min\\{+\\infty,\\, 5+(-5)\\}=0.\n$$\n\n处理 $D$：\n$$\nd(F)=\\min\\{0,\\, d(D)+w(D,F)\\}=\\min\\{0,\\, 9+11\\}=\\min{0,20}=0.\n$$\n\n终止时，从 A 到 F 的最小总成本为 $d(F)=0$。最小化路径可以从松弛操作中读出：$A \\to C \\to E \\to F$，其总成本为\n$$\nw(A,C)+w(C,E)+w(E,F)=2+3+(-5)=0.\n$$\n\n因此，最小可能总成本为 $0$。", "answer": "$$\\boxed{0}$$", "id": "1414557"}, {"introduction": "与寻找单点间最短路径不同，网络设计的另一个核心任务是如何以最低总成本连接所有节点，这正是最小生成树（MST）算法要解决的问题。这个练习模拟了一个电信网络铺设的场景，要求你使用Kruskal或Prim等经典算法来找出成本最低的连接方案 [@problem_id:1414573]。更进一步，本题还探讨了当某条线路的成本因技术进步而降低时，整个网络的最优成本会如何变化，这让你能够练习分析网络优化中的动态调整问题。", "problem": "一家电信公司负责用高速数据电缆网络连接五个远程研究站，分别命名为 Alpha、Bravo、Charlie、Delta 和 Echo。目标是确保所有站点都相互连接（直接或间接），同时最小化所用电缆的总长度，从而最小化成本。可能的直接连接及其相关成本（单位：千美元）如下：\n\n- Alpha 到 Bravo: 10\n- Alpha 到 Charlie: 25\n- Alpha 到 Delta: 30\n- Bravo 到 Charlie: 12\n- Bravo 到 Echo: 18\n- Charlie 到 Delta: 8\n- Charlie 到 Echo: 20\n- Delta 到 Echo: 15\n\n最近，定向钻井技术的突破使得 Alpha 和 Charlie 之间的路线铺设变得容易得多。因此，Alpha 到 Charlie 的连接成本从 25 千美元降至 9 千美元。所有其他成本保持不变。\n\n计算由于这项技术改进，最低网络成本总共降低了多少（单位：千美元）。", "solution": "我们需要连接所有五个站点的最低总成本，即一个最小生成树（MST）的成本。我们使用 Kruskal 算法：按权重递增的顺序对边进行排序，然后添加不会形成环的边，直到所有顶点都连接起来。\n\n改进前，各边的权重为：\n- $AB: 10$, $AC: 25$, $AD: 30$, $BC: 12$, $BE: 18$, $CD: 8$, $CE: 20$, $DE: 15$。\n排序后：$CD: 8$, $AB: 10$, $BC: 12$, $DE: 15$, $BE: 18$, $CE: 20$, $AC: 25$, $AD: 30$。\n应用 Kruskal 算法：\n- 添加 $CD: 8$。\n- 添加 $AB: 10$。\n- 添加 $BC: 12$ (连接组件，无环)。\n- 添加 $DE: 15$ (连接 $E$，无环)。\n最小生成树由边 $CD, AB, BC, DE$ 构成，总成本为\n$$8+10+12+15=45.$$\n\n改进后，$AC$ 的成本降至 $9$；所有其他边保持不变。排序后的列表为 $CD: 8$, $AC: 9$, $AB: 10$, $BC: 12$, $DE: 15$, $BE: 18$, $CE: 20$, $AD: 30$。\n应用 Kruskal 算法：\n- 添加 $CD: 8$。\n- 添加 $AC: 9$ (将 $A$ 与 $\\{C,D\\}$ 合并)。\n- 添加 $AB: 10$ (加入 $B$，不形成环)。\n- 添加 $DE: 15$ (连接 $E$)。\n最小生成树由边 $CD, AC, AB, DE$ 构成，总成本为\n$$8+9+10+15=42.$$\n\n因此，最低网络成本的总降低额为\n$$45-42=3.$$", "answer": "$$\\boxed{3}$$", "id": "1414573"}, {"introduction": "现实世界中的优化问题往往比标准的教科书模型更复杂，常常带有额外的约束条件。这个问题提出了一个独特的挑战：寻找最短路径，但要求路径必须包含偶数条边 [@problem_id:1414596]。直接应用Dijkstra等标准算法是行不通的，这促使我们必须跳出常规思维。这个练习的核心是学习一种强大的建模技巧——状态空间扩展，通过构建一个辅助图来将“路径长度的奇偶性”这一约束编码为图的一部分，从而将复杂问题转化为标准的最短路径问题。", "problem": "在一个先进的时序动力学实验室中，建立了一系列共 $N=5$ 个稳定的时间“锚点”，编号为1到5。这些锚点由一个单向“相位隧道”网络互连。一个名为“Pathfinder”的特制探针被设计用于在此网络中导航。\n\nPathfinder拥有一个名为“奇偶荷”的内在属性，该属性可以处于'偶'或'奇'两种状态之一。探针从锚点1出发，此时其奇偶荷为'偶'态。每当Pathfinder穿过一个相位隧道，其奇偶荷状态就会翻转（从'偶'到'奇'，或从'奇'到'偶'）。为了使任务成功，探针必须在到达其目标锚点时具有'偶'态的奇偶荷。\n\n从锚点$u$到锚点$v$穿越隧道的能量成本不是恒定的；它取决于Pathfinder在锚点$u$*进入*隧道时的奇偶荷。具体的能量成本如下：\n\n**以'偶'态奇偶荷进入时的成本 ($E_{\\text{even}}$):**\n- 隧道 1 到 2: 10 单位\n- 隧道 1 到 3: 100 单位\n- 隧道 2 到 3: 10 单位\n- 隧道 2 到 4: 50 单位\n- 隧道 3 到 5: 100 单位\n- 隧道 4 到 3: 10 单位\n- 隧道 4 到 5: 20 单位\n\n**以'奇'态奇偶荷进入时的成本 ($E_{\\text{odd}}$):**\n- 隧道 1 到 2: 10 单位\n- 隧道 1 到 3: 5 单位\n- 隧道 2 到 3: 10 单位\n- 隧道 2 到 4: 10 单位\n- 隧道 3 到 5: 10 单位\n- 隧道 4 到 3: 10 单位\n- 隧道 4 到 5: 20 单位\n\n任何未列出的隧道连接都具有无限的能量成本。探针的任务是从起始锚点1行进到目标锚点5。\n\n确定Pathfinder成功完成其任务所需的最小总能量成本。请用一个整数表示你的答案。", "solution": "我们通过一个双层有向图来对这种依赖于奇偶性的成本进行建模，图中的状态为 $(i,p)$，其中 $i \\in \\{1,2,3,4,5\\}$ 是锚点，而 $p \\in \\{\\text{E}, \\text{O}\\}$ 是在穿越一条传出隧道前的奇偶荷。穿越任何隧道都会翻转奇偶性，所用的成本由源点的奇偶性决定。因此：\n- 从 $(u,\\text{E})$ 到 $(v,\\text{O})$ 的成本是 $E_{\\text{even}}(u \\to v)$。\n- 从 $(u,\\text{O})$ 到 $(v,\\text{E})$ 的成本是 $E_{\\text{odd}}(u \\to v)$。\n\n我们需要寻找从 $(1,\\text{E})$ 到 $(5,\\text{E})$ 的最小成本路径。令 $d(i,p)$ 表示从 $(1,\\text{E})$ 到 $(i,p)$ 的最小能量成本。初始化 $d(1,\\text{E})=0$，所有其他的 $d=\\infty$。\n\n使用给定的隧道成本，我们执行类似Dijkstra算法中的松弛操作。\n\n从 $(1,\\text{E})$ 开始初始化：\n- $(1,\\text{E}) \\to (2,\\text{O})$，成本为 $10$：设置 $d(2,\\text{O})=10$。\n- $(1,\\text{E}) \\to (3,\\text{O})$，成本为 $100$：设置 $d(3,\\text{O})=100$。\n\n接下来处理 $(2,\\text{O})$，因为 $10$ 是最小的临时距离：\n- 从 $(2,\\text{O})$ 出发，使用奇数成本：$2 \\to 3$ 成本为 $10$，得到 $(3,\\text{E})$ 的距离为\n$$\nd(3,\\text{E}) = d(2,\\text{O}) + 10 = 20.\n$$\n- 从 $(2,\\text{O})$ 出发：$2 \\to 4$ 成本为 $10$，得到 $(4,\\text{E})$ 的距离为\n$$\nd(4,\\text{E}) = d(2,\\text{O}) + 10 = 20.\n$$\n\n处理 $(3,\\text{E})$，距离为 $20$：\n- 从 $(3,\\text{E})$ 出发，使用偶数成本：$3 \\to 5$ 成本为 $100$，得到 $(5,\\text{O})$ 的距离为\n$$\nd(5,\\text{O}) = d(3,\\text{E}) + 100 = 120.\n$$\n\n处理 $(4,\\text{E})$，距离为 $20$：\n- 从 $(4,\\text{E})$ 出发，使用偶数成本：$4 \\to 3$ 成本为 $10$，可将 $(3,\\text{O})$ 的距离更新为\n$$\nd(3,\\text{O}) = \\min\\{100,\\, d(4,\\text{E}) + 10\\} = 30.\n$$\n- 从 $(4,\\text{E})$ 出发：$4 \\to 5$ 成本为 $20$，可将 $(5,\\text{O})$ 的距离更新为\n$$\nd(5,\\text{O}) = \\min\\{120,\\, d(4,\\text{E}) + 20\\} = 40.\n$$\n\n处理 $(3,\\text{O})$，距离为 $30$：\n- 从 $(3,\\text{O})$ 出发，使用奇数成本：$3 \\to 5$ 成本为 $10$，得到 $(5,\\text{E})$ 的距离为\n$$\nd(5,\\text{E}) = d(3,\\text{O}) + 10 = 40.\n$$\n\n所有剩余未处理节点的距离都至少为 $40$，因此 $d(5,\\text{E})=40$ 是最优解。\n\n一条达到此值的显式最优路径是\n$$\n1 \\xrightarrow[\\text{偶}]{10} 2 \\xrightarrow[\\text{奇}]{10} 4 \\xrightarrow[\\text{偶}]{10} 3 \\xrightarrow[\\text{奇}]{10} 5,\n$$\n该路径包含四次穿越（偶数次，因此到达时的奇偶性为偶），总成本为 $10+10+10+10=40$。不可能有更小的成本：任何有效的任务都必须包含偶数次穿越；唯一的两段路径 $1 \\to 3 \\to 5$ 成本为 $100+10=110$，而唯一一条所有单段成本都为其最小值 $10$ 的四段路径就是上面那条，成本为 $40$。$1 \\to 3$ 的 $5$ 单位成本仅在以奇数奇偶性进入时可用，但由于锚点1缺少入向隧道，因此从起点出发无法满足此条件。", "answer": "$$\\boxed{40}$$", "id": "1414596"}]}