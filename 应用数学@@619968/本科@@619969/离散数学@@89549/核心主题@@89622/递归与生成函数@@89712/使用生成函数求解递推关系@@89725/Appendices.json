{"hands_on_practices": [{"introduction": "这个练习将引导我们解决一个类似于斐波那契数列的非齐次递推关系。通过这个例子，我们将学习如何运用生成函数这一强大工具，将一个递推问题转化为一个代数方程求解问题。这不仅提供了一种系统性的方法来替代寻找特解和齐次解的传统技巧，也为我们处理更复杂的序列问题打下了坚实的基础。[@problem_id:1413583]", "problem": "一位计算机科学家正在分析一种新型自组织数据结构的计算成本。在每一步 $n \\geq 0$ 中，会添加一个新元素。在添加第 $n$ 个元素后重组该结构所需的总基本操作数（记为 $a_n$）遵循一个特定的递推关系。该过程从一个空结构（需要 $a_0 = 0$ 次操作）的基准情形开始。第一次插入需要 $a_1 = 1$ 次操作。对于所有后续步骤（$n \\geq 2$），操作数由前两步的操作数之和再加上一次用于整合新元素的额外操作给出。该关系由递推式 $a_n = a_{n-1} + a_{n-2} + 1$ 描述。\n\n求出 $a_n$（对于 $n \\geq 0$）的闭式表达式。", "solution": "我们得到线性非齐次递推关系 $a_{n} = a_{n-1} + a_{n-2} + 1$（对于 $n \\geq 2$），且有 $a_{0} = 0$ 和 $a_{1} = 1$。为了找到闭式解，首先确定一个常数特解。假设对所有 $n$ 都有 $a_{n} = A$。代入递推关系可得\n$$\nA = A + A + 1 \\quad \\Longrightarrow \\quad A = -1.\n$$\n定义 $b_{n} = a_{n} + 1$，因此有 $a_{n} = b_{n} - 1$。则\n$$\nb_{n} - 1 = (b_{n-1} - 1) + (b_{n-2} - 1) + 1 \\quad \\Longrightarrow \\quad b_{n} = b_{n-1} + b_{n-2}.\n$$\n初始条件变换为 $b_{0} = a_{0} + 1 = 1$ 和 $b_{1} = a_{1} + 1 = 2$。因此，$b_{n}$ 满足齐次斐波那契型递推关系，其特征方程为\n$$\nr^{2} - r - 1 = 0,\n$$\n其根为\n$$\nr_{1} = \\frac{1 + \\sqrt{5}}{2}, \\qquad r_{2} = \\frac{1 - \\sqrt{5}}{2}.\n$$\n因此通解为\n$$\nb_{n} = C_{1} r_{1}^{n} + C_{2} r_{2}^{n}.\n$$\n代入 $b_{0} = 1$ 和 $b_{1} = 2$ 可得\n$$\nC_{1} + C_{2} = 1, \\qquad C_{1} r_{1} + C_{2} r_{2} = 2.\n$$\n解得\n$$\nC_{1} = \\frac{2 - r_{2}}{r_{1} - r_{2}}, \\qquad C_{2} = \\frac{r_{1} - 2}{r_{1} - r_{2}}.\n$$\n使用 $r_{1} - r_{2} = \\sqrt{5}$ 和以下恒等式\n$$\n2 - r_{2} = \\frac{3 + \\sqrt{5}}{2} = r_{1}^{2}, \\qquad r_{1} - 2 = \\frac{\\sqrt{5} - 3}{2} = - r_{2}^{2},\n$$\n我们得到\n$$\nC_{1} = \\frac{r_{1}^{2}}{\\sqrt{5}}, \\qquad C_{2} = - \\frac{r_{2}^{2}}{\\sqrt{5}}.\n$$\n因此\n$$\nb_{n} = \\frac{r_{1}^{2} r_{1}^{n} - r_{2}^{2} r_{2}^{n}}{\\sqrt{5}} = \\frac{r_{1}^{n+2} - r_{2}^{n+2}}{\\sqrt{5}}.\n$$\n回顾 $a_{n} = b_{n} - 1$，我们得出结论\n$$\na_{n} = \\frac{1}{\\sqrt{5}}\\left[\\left(\\frac{1 + \\sqrt{5}}{2}\\right)^{n+2} - \\left(\\frac{1 - \\sqrt{5}}{2}\\right)^{n+2}\\right] - 1, \\quad n \\geq 0.\n$$", "answer": "$$\\boxed{\\frac{1}{\\sqrt{5}}\\left(\\left(\\frac{1+\\sqrt{5}}{2}\\right)^{n+2}-\\left(\\frac{1-\\sqrt{5}}{2}\\right)^{n+2}\\right)-1}$$", "id": "1413583"}, {"introduction": "这个练习展示了生成函数的一个核心优势：优雅地处理包含求和项的递推关系。形如 $\\sum_{k=0}^{n-1} a_k$ 的求和项在其他方法中可能非常棘手，但在生成函数的世界里，它对应着一个简单的代数乘法。通过这个实践，你将掌握如何利用卷积性质，将复杂的递推关系转化为代数问题并求得其封闭形式解，深刻体会生成函数的威力。[@problem_id:1413554]", "problem": "在一个数字生命的模拟中，研究了一种新型的自我复制有机体。设 $a_n$ 表示该有机体在第 $n$ 代时的不同变体的数量。在模拟开始时（第 $n=0$ 代），只有一个始祖变体，因此我们有 $a_0 = 1$。\n\n对于任何后续的代 $n \\ge 1$，新的变体通过两种不同的过程形成：\n1.  来自紧邻前一代（第 $n-1$ 代）的每个变体，都会产生一个新的、唯一的变体。\n2.  从第 $k=0$ 代到第 $k=n-1$ 代（含）曾经存在过的每个变体，都会促成一个额外的新变体的产生。\n\n在第 $n$ 代的总变体数量，记为 $a_n$，是这两种过程产生的变体数量之和。请找出 $a_n$ 在 $n \\ge 1$ 时关于 $n$ 的一个闭式表达式。", "solution": "根据问题中描述的过程，可得到以下递推关系。在第 $n \\ge 1$ 代，变体的数量 $a_n$ 是来自过程1的变体（$a_{n-1}$）和来自过程2的变体（$\\sum_{k=0}^{n-1} a_k$）的总和。\n因此，我们得到递推关系：\n$$a_n = a_{n-1} + \\sum_{k=0}^{n-1} a_k, \\quad \\text{对于 } n \\ge 1$$\n初始条件为 $a_0 = 1$。\n\n我们将使用生成函数来解这个递推关系。设 $A(x)$ 是序列 $\\{a_n\\}$ 的普通生成函数，定义为：\n$$A(x) = \\sum_{n=0}^{\\infty} a_n x^n = a_0 + a_1 x + a_2 x^2 + \\dots$$\n\n我们的目标是求出 $A(x)$ 的一个代数表达式，然后提取出系数 $a_n$。我们将递推关系两边同乘以 $x^n$ 并对所有有效的 $n$ 值（即 $n \\ge 1$）求和。\n$$ \\sum_{n=1}^{\\infty} a_n x^n = \\sum_{n=1}^{\\infty} a_{n-1} x^n + \\sum_{n=1}^{\\infty} \\left( \\sum_{k=0}^{n-1} a_k \\right) x^n $$\n\n我们来分析这个方程中的每一项。\n等式左边是 $\\sum_{n=1}^{\\infty} a_n x^n = A(x) - a_0 = A(x) - 1$。\n\n等式右边的第一项是 $\\sum_{n=1}^{\\infty} a_{n-1} x^n$。提出因子 $x$，我们得到 $x \\sum_{n=1}^{\\infty} a_{n-1} x^{n-1}$。令 $m = n-1$，此项变为 $x \\sum_{m=0}^{\\infty} a_m x^m = x A(x)$。\n\n等式右边的第二项是 $\\sum_{n=1}^{\\infty} \\left( \\sum_{k=0}^{n-1} a_k \\right) x^n$。设 $s_m = \\sum_{k=0}^{m} a_k$。则该项为 $\\sum_{n=1}^{\\infty} s_{n-1} x^n = x \\sum_{n=1}^{\\infty} s_{n-1} x^{n-1} = x \\sum_{m=0}^{\\infty} s_m x^m$。\n序列 $\\{s_m\\}$ 是序列 $\\{a_n\\}$ 的部分和序列。$\\{s_m\\}$ 的生成函数（我们称之为 $S(x)$）与 $A(x)$ 相关。序列 $\\{s_m\\}$ 是序列 $\\{a_n\\}$ 与常数序列 $\\{1, 1, 1, \\dots\\}$ 的卷积。常数序列的生成函数是 $\\frac{1}{1-x}$。因此，$S(x) = A(x) \\cdot \\frac{1}{1-x}$。\n所以，等式右边的第二项变为 $x S(x) = \\frac{x A(x)}{1-x}$。\n\n将这些表达式代回主方程中：\n$$ A(x) - 1 = x A(x) + \\frac{x A(x)}{1-x} $$\n\n现在，我们求解 $A(x)$。\n$$ A(x) - 1 = A(x) \\left( x + \\frac{x}{1-x} \\right) $$\n$$ A(x) - 1 = A(x) \\left( \\frac{x(1-x)+x}{1-x} \\right) = A(x) \\left( \\frac{x-x^2+x}{1-x} \\right) = A(x) \\left( \\frac{2x-x^2}{1-x} \\right) $$\n$$ A(x) \\left( 1 - \\frac{2x-x^2}{1-x} \\right) = 1 $$\n$$ A(x) \\left( \\frac{1-x - (2x-x^2)}{1-x} \\right) = 1 $$\n$$ A(x) \\left( \\frac{1-3x+x^2}{1-x} \\right) = 1 $$\n$$ A(x) = \\frac{1-x}{1-3x+x^2} $$\n\n为了求出 $a_n$，我们使用部分分式分解将 $A(x)$ 展开为幂级数。二次多项式 $t^2 - 3t + 1 = 0$ 的根是 $t = \\frac{3 \\pm \\sqrt{9-4}}{2} = \\frac{3 \\pm \\sqrt{5}}{2}$。\n我们定义黄金比例 $\\phi = \\frac{1+\\sqrt{5}}{2}$ 及其共轭 $\\psi = \\frac{1-\\sqrt{5}}{2}$。$x^2-3x+1=0$ 的根不是 $\\phi, \\psi$。设其根为 $r_1, r_2$。倒数多项式 $1-3x+x^2=0$ 的根是 $1/r_1$ 和 $1/r_2$。我们将 $t^2-3t+1=0$ 的根称为 $r_1$ 和 $r_2$。所以 $r_1 = \\frac{3+\\sqrt{5}}{2}$ 且 $r_2 = \\frac{3-\\sqrt{5}}{2}$。注意到 $r_1 = \\phi^2$ 且 $r_2 = \\psi^2$。\n所以，分母可以因式分解为 $1-3x+x^2 = (1-r_1 x)(1-r_2 x)$。\n我们想要分解 $A(x)$：\n$$ \\frac{1-x}{(1-r_1 x)(1-r_2 x)} = \\frac{C_1}{1-r_1 x} + \\frac{C_2}{1-r_2 x} $$\n使用Heaviside覆盖法：\n$$ C_1 = \\left. \\frac{1-x}{1-r_2 x} \\right|_{x=1/r_1} = \\frac{1 - 1/r_1}{1 - r_2/r_1} = \\frac{(r_1-1)/r_1}{(r_1-r_2)/r_1} = \\frac{r_1-1}{r_1-r_2} $$\n我们有 $r_1 - 1 = \\frac{3+\\sqrt{5}}{2} - 1 = \\frac{1+\\sqrt{5}}{2} = \\phi$，以及 $r_1 - r_2 = \\sqrt{5}$。\n所以，$C_1 = \\frac{\\phi}{\\sqrt{5}}$。\n$$ C_2 = \\left. \\frac{1-x}{1-r_1 x} \\right|_{x=1/r_2} = \\frac{1 - 1/r_2}{1 - r_1/r_2} = \\frac{(r_2-1)/r_2}{(r_2-r_1)/r_2} = \\frac{r_2-1}{r_2-r_1} $$\n我们有 $r_2 - 1 = \\frac{3-\\sqrt{5}}{2} - 1 = \\frac{1-\\sqrt{5}}{2} = \\psi$，以及 $r_2 - r_1 = -\\sqrt{5}$。\n所以，$C_2 = \\frac{\\psi}{-\\sqrt{5}}$。\n\n因此，生成函数是：\n$$ A(x) = \\frac{\\phi/\\sqrt{5}}{1-r_1 x} - \\frac{\\psi/\\sqrt{5}}{1-r_2 x} $$\n我们使用几何级数公式 $\\frac{1}{1-u} = \\sum_{n=0}^{\\infty} u^n$ 来展开每一项：\n$$ A(x) = \\frac{\\phi}{\\sqrt{5}} \\sum_{n=0}^{\\infty} (r_1 x)^n - \\frac{\\psi}{\\sqrt{5}} \\sum_{n=0}^{\\infty} (r_2 x)^n = \\sum_{n=0}^{\\infty} \\frac{1}{\\sqrt{5}} (\\phi r_1^n - \\psi r_2^n) x^n $$\n$x^n$ 的系数即为 $a_n$：\n$$ a_n = \\frac{1}{\\sqrt{5}} (\\phi r_1^n - \\psi r_2^n) $$\n代入 $r_1 = \\phi^2$ 和 $r_2 = \\psi^2$：\n$$ a_n = \\frac{1}{\\sqrt{5}} (\\phi (\\phi^2)^n - \\psi (\\psi^2)^n) = \\frac{1}{\\sqrt{5}} (\\phi^{2n+1} - \\psi^{2n+1}) $$\n这个公式是斐波那契数的比内公式（Binet's formula），特别是 $F_{2n+1}$ 的表达式。\n代入 $\\phi$ 和 $\\psi$ 的值：\n$$ a_n = \\frac{1}{\\sqrt{5}} \\left[ \\left(\\frac{1+\\sqrt{5}}{2}\\right)^{2n+1} - \\left(\\frac{1-\\sqrt{5}}{2}\\right)^{2n+1} \\right] $$\n这个闭式表达式对所有 $n \\ge 0$ 都成立，因此也对题目要求的 $n \\ge 1$ 成立。", "answer": "$$\\boxed{\\frac{1}{\\sqrt{5}} \\left[ \\left(\\frac{1+\\sqrt{5}}{2}\\right)^{2n+1} - \\left(\\frac{1-\\sqrt{5}}{2}\\right)^{2n+1} \\right]}$$", "id": "1413554"}, {"introduction": "当递推关系中出现与项的索引 $n$ 相关的系数（如 $n a_{n-1}$）或涉及耦合系统时，普通生成函数的使用可能变得复杂。这个练习将我们带入指数生成函数（EGFs）的领域，这是一种为解决此类问题量身定制的强大工具。我们将学习如何将递推关系系统转化为一个微分方程系统来求解，这不仅能解决眼前的问题，也为你理解指数生成函数在处理带标记结构计数问题中的关键作用打开了大门。[@problem_id:1413591]", "problem": "考虑两个数列 $\\{a_n\\}_{n \\ge 0}$ 和 $\\{b_n\\}_{n \\ge 0}$，它们通过一个递归关系系统耦合在一起。这两个数列由初始值 $a_0 = 1$ 和 $b_0 = 1$ 定义。对于所有整数 $n \\ge 1$，数列的项由以下相互递归关系生成：\n$$a_n = a_{n-1} + n b_{n-1}$$\n$$b_n = n a_{n-1} + b_{n-1}$$\n求通项 $a_n$ 关于 $n$ 的封闭形式表达式。", "solution": "为了解决这个递归关系系统，我们使用指数生成函数（EGFs）的方法。设数列 $\\{a_n\\}$ 和 $\\{b_n\\}$ 的指数生成函数分别为 $A(x)$ 和 $B(x)$，定义如下：\n$$A(x) = \\sum_{n=0}^{\\infty} a_n \\frac{x^n}{n!}$$\n$$B(x) = \\sum_{n=0}^{\\infty} b_n \\frac{x^n}{n!}$$\n我们的目标是将给定的递归关系转化为包含 $A(x)$ 和 $B(x)$ 的方程。我们将处理递归关系中的每一项。首先，我们对 $A(x)$ 和 $B(x)$ 关于 $x$ 求导：\n$$A'(x) = \\frac{d}{dx} \\sum_{n=0}^{\\infty} a_n \\frac{x^n}{n!} = \\sum_{n=1}^{\\infty} a_n \\frac{nx^{n-1}}{n!} = \\sum_{n=1}^{\\infty} a_n \\frac{x^{n-1}}{(n-1)!}$$\n$$B'(x) = \\frac{d}{dx} \\sum_{n=0}^{\\infty} b_n \\frac{x^n}{n!} = \\sum_{n=1}^{\\infty} b_n \\frac{x^{n-1}}{(n-1)!}$$\n现在，我们将递归关系两边乘以 $\\frac{x^{n-1}}{(n-1)!}$ 并从 $n=1$ 到 $\\infty$ 求和。\n\n对于第一个递归关系 $a_n = a_{n-1} + n b_{n-1}$：\n$$\\sum_{n=1}^{\\infty} a_n \\frac{x^{n-1}}{(n-1)!} = \\sum_{n=1}^{\\infty} a_{n-1} \\frac{x^{n-1}}{(n-1)!} + \\sum_{n=1}^{\\infty} n b_{n-1} \\frac{x^{n-1}}{(n-1)!}$$\n左边正好是 $A'(x)$。\n右边的第一项是 $\\sum_{k=0}^{\\infty} a_k \\frac{x^k}{k!} = A(x)$。\n对于右边的第二项，我们识别出项 $n f_{n-1}$ 的指数生成函数操作。这对应于 $x F'(x)$。具体来说：\n$$\\sum_{n=1}^{\\infty} n b_{n-1} \\frac{x^{n-1}}{(n-1)!} = \\sum_{n=1}^{\\infty} \\frac{b_{n-1}}{(n-2)!} x^{n-1} \\text{ (错误的路径)}$$\n让我们使用已知的指数生成函数恒等式：数列 $\\{n f_{n-1}\\}_{n\\ge 1}$ 对应于函数 $x F(x)$。一个更直接的看法是：\n$$x B(x) = x \\sum_{n=0}^{\\infty} b_n \\frac{x^n}{n!} = \\sum_{n=0}^{\\infty} b_n \\frac{x^{n+1}}{n!} = \\sum_{k=1}^{\\infty} b_{k-1} \\frac{x^k}{(k-1)!} = \\sum_{k=1}^{\\infty} k b_{k-1} \\frac{x^k}{k!}$$\n这表明 $x B(x)$ 是数列 $\\{n b_{n-1}\\}_{n \\ge 1}$ 的指数生成函数。项 $\\sum_{n=1}^{\\infty} n b_{n-1} \\frac{x^{n-1}}{(n-1)!}$ 是它的导数。让我们尝试另一种方法来避免这种复杂情况。\n\n让我们将递归关系转化为一个积分-微分方程组。我们两边乘以 $x^n/n!$ 并从 $n=1$ 开始求和。\n$$ \\sum_{n=1}^{\\infty} a_n \\frac{x^n}{n!} = \\sum_{n=1}^{\\infty} a_{n-1} \\frac{x^n}{n!} + \\sum_{n=1}^{\\infty} n b_{n-1} \\frac{x^n}{n!} $$\n左边是 $A(x) - a_0$。\n右边的第一项是 $\\sum_{k=0}^{\\infty} a_k \\frac{x^{k+1}}{(k+1)!} = \\int_0^x A(t) dt$。\n右边的第二项是 $x B(x)$，如前所示。\n因此，我们得到方程组：\n1) $A(x) - a_0 = \\int_0^x A(t) dt + x B(x)$\n2) $B(x) - b_0 = \\int_0^x B(t) dt + x A(x)$\n\n将两个方程对 $x$ 求导，得到一个常微分方程组：\n1') $A'(x) = A(x) + \\frac{d}{dx}(x B(x)) = A(x) + B(x) + x B'(x)$\n2') $B'(x) = B(x) + \\frac{d}{dx}(x A(x)) = B(x) + A(x) + x A'(x)$\n\n现在，我们来解这个方程组。让我们将两个方程相减：\n$A'(x) - B'(x) = (A(x) - B(x)) + (x B'(x) - x A'(x))$\n$(A'(x) - B'(x)) = (A(x) - B(x)) - x (A'(x) - B'(x))$\n$(1+x)(A'(x) - B'(x)) = (A(x) - B(x))$\n设 $S(x) = A(x) - B(x)$。方程变为 $(1+x)S'(x) = S(x)$。\n这是一个可分离的微分方程：$\\frac{S'(x)}{S(x)} = \\frac{1}{1+x}$。\n两边积分，得到 $\\ln|S(x)| = \\ln|1+x| + C$，这意味着 $S(x) = K(1+x)$。\n为了求出常数 $K$，我们使用初始条件：$a_0 = 1$ 和 $b_0 = 1$。\n$A(0) = a_0 = 1$ 且 $B(0) = b_0 = 1$。\n所以，$S(0) = A(0) - B(0) = 1 - 1 = 0$。\n将其代入 $S(x)$ 的解中：$S(0) = K(1+0) \\implies 0 = K$。\n因此，$K=0$，这意味着对所有 $x$ 都有 $S(x) = 0$。这表明 $A(x) = B(x)$。\n\n既然我们知道这两个生成函数是相同的，我们可以将 $B(x) = A(x)$ 和 $B'(x) = A'(x)$ 代入任一个微分方程中。让我们使用方程 (1')：\n$A'(x) = A(x) + A(x) + x A'(x)$\n$A'(x) = 2A(x) + x A'(x)$\n$A'(x) (1-x) = 2A(x)$\n这又是另一个可分离的常微分方程：\n$$\\frac{A'(x)}{A(x)} = \\frac{2}{1-x}$$\n两边对 $x$ 积分：\n$$\\int \\frac{dA}{A} = \\int \\frac{2}{1-x} dx$$\n$$\\ln|A(x)| = -2 \\ln|1-x| + C_0$$\n$$A(x) = e^{C_0} (1-x)^{-2} = C_1 (1-x)^{-2}$$\n为了求出常数 $C_1$，我们使用初始条件 $A(0) = a_0 = 1$。\n$$A(0) = C_1 (1-0)^{-2} \\implies 1 = C_1$$\n所以，$\\{a_n\\}$ 的指数生成函数是：\n$$A(x) = \\frac{1}{(1-x)^2}$$\n我们的最后一步是从这个函数中提取系数 $a_n$。我们可以求出 $A(x)$ 在 $x=0$ 附近的泰勒级数展开。使用广义二项式定理：\n$$A(x) = (1-x)^{-2} = \\sum_{n=0}^{\\infty} \\binom{-2}{n} (-x)^n$$\n二项式系数可以简化为：\n$$\\binom{-2}{n} = \\frac{(-2)(-3)\\dots(-2-n+1)}{n!} = \\frac{(-1)^n (2)(3)\\dots(n+1)}{n!} = (-1)^n \\frac{(n+1)!}{n!} = (-1)^n (n+1)$$\n将其代回级数展开式：\n$$A(x) = \\sum_{n=0}^{\\infty} (-1)^n (n+1) (-x)^n = \\sum_{n=0}^{\\infty} (n+1) x^n$$\n我们现在已经找到了 $A(x)$ 的幂级数。根据定义，$A(x)$ 是一个指数生成函数，所以我们必须将幂级数的系数与指数生成函数定义中的项相等同：\n$$A(x) = \\sum_{n=0}^{\\infty} a_n \\frac{x^n}{n!} = \\sum_{n=0}^{\\infty} (n+1) x^n$$\n通过比较两边 $x^n$ 的系数，我们得到：\n$$\\frac{a_n}{n!} = n+1$$\n解出 $a_n$ 就得到了所需的封闭形式表达式：\n$$a_n = (n+1) \\cdot n!$$\n这可以简化为：\n$$a_n = (n+1)!$$\n因为我们发现 $A(x)=B(x)$，所以相同的公式也适用于 $b_n$，即 $b_n = (n+1)!$。", "answer": "$$\\boxed{(n+1)!}$$", "id": "1413591"}]}