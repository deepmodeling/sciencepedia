{"hands_on_practices": [{"introduction": "我们以一个基础练习开始，这个练习将引导你完成求解非齐次线性递推关系的标准方法。我们将解决一个非齐次部分是简单线性函数（$f(n)=n$）的递推关系，这种情况在许多增长模型中很常见。通过这个例子，你将掌握求解的核心两步法：先求解对应的齐次关系，再为非齐次部分寻找一个特解。[@problem_id:1401319]", "problem": "在热门网络游戏“Recursive Ascent”中，玩家要完成第 $n$ 关所需的总分数记为 $S_n$。该游戏的规则是，要通过第 $n$ 关（对于 $n \\ge 1$），玩家必须先获得等于前一关所需分数 $S_{n-1}$ 两倍的分数，然后再额外获得 $n$ 分的本关奖励。\n\n新玩家从第 0 关开始，完成此关需要 $S_0 = 3$ 分。\n\n求完成第 $n$ 关所需分数 $S_n$ 的闭式表达式，该表达式对所有整数 $n \\ge 0$ 成立。", "solution": "我们得到如下线性非齐次递推关系：\n$$\nS_{n}=2S_{n-1}+n \\quad \\text{对于 } n\\geq 1, \\quad S_{0}=3.\n$$\n为求解该关系，我们使用齐次解与特解相加的标准方法。\n\n首先，求解齐次递推关系 $S_{n}^{(h)}=2S_{n-1}^{(h)}$。其通解为：\n$$\nS_{n}^{(h)}=C\\,2^{n},\n$$\n其中 $C$ 为一常数。\n\n其次，求非齐次递推关系的一个特解。由于非齐次项是关于 $n$ 的一次多项式，且齐次部分的因子不会与多项式拟设产生共振，我们设特解的形式为：\n$$\nS_{n}^{(p)}=\\alpha n+\\beta.\n$$\n将其代入原递推关系：\n$$\n\\alpha n+\\beta=2\\big(\\alpha(n-1)+\\beta\\big)+n=2\\alpha n-2\\alpha+2\\beta+n.\n$$\n比较等式两边 $n$ 的同次幂的系数：\n$$\n\\text{$n$ 的系数：} \\quad \\alpha=2\\alpha+1 \\;\\Rightarrow\\; -\\alpha=1 \\;\\Rightarrow\\; \\alpha=-1,\n$$\n$$\n\\text{常数项：} \\quad \\beta=-2\\alpha+2\\beta \\;\\Rightarrow\\; \\beta=2+2\\beta \\;\\Rightarrow\\; -\\beta=2 \\;\\Rightarrow\\; \\beta=-2.\n$$\n因此，一个特解是：\n$$\nS_{n}^{(p)}=-n-2.\n$$\n通解是齐次解与特解的和：\n$$\nS_{n}=C\\,2^{n}-n-2.\n$$\n利用初始条件 $S_{0}=3$ 来确定 $C$：\n$$\n3=C\\,2^{0}-0-2 \\;\\Rightarrow\\; 3=C-2 \\;\\Rightarrow\\; C=5.\n$$\n因此，对所有整数 $n\\geq 0$ 均成立的闭式表达式为：\n$$\nS_{n}=5\\cdot 2^{n}-n-2.\n$$", "answer": "$$\\boxed{5\\cdot 2^{n}-n-2}$$", "id": "1401319"}, {"introduction": "当非齐次项与齐次解“共振”时会发生什么？这个问题探讨了这种关键的特殊情况，在这种情况下，对特解的标准猜测会失效。你将学到一种强大的技巧来修正你的方法，并在当外部函数的增长形式与系统的自然增长相匹配时找到正确的解。[@problem_id:1401346]", "problem": "一个名为“NetWeave”的新社交媒体平台，追踪其用户之间的活跃连接数。在第0天平台上线时，有 $C_0$ 个活跃连接。该平台的设计鼓励指数级增长。每天，活跃连接数都会在前一天的基础上翻倍。然而，为了维持网络质量，在每天 $n$（对于 $n \\ge 1$）结束时，会运行一个自动化的日常清理程序。该程序会识别并移除一定数量的虚假或不活跃连接，其数量恰好等于 $k \\cdot n \\cdot 2^n$，其中 $k$ 是一个常数。\n\n设 $a_n$ 表示在第 $n$ 天结束时（清理程序运行后）平台上的活跃连接数。初始连接数为 $a_0 = C_0 = 500$，清理常数为 $k=40$。\n\n确定 $a_n$ 对所有整数 $n \\ge 0$ 的闭式表达式。", "solution": "在第 $n$ 天开始时，连接数是前一天结束时值的两倍，而在第 $n$ 天结束时（对于 $n \\geq 1$），会移除 $k n 2^{n}$ 个连接。这产生以下线性非齐次递推关系：\n$$\na_{n} = 2 a_{n-1} - k n 2^{n} \\quad \\text{对于 } n \\geq 1, \\quad a_{0} = C_{0}.\n$$\n为了消除齐次增长因子 $2^{n}$，定义 $b_{n} = \\frac{a_{n}}{2^{n}}$。那么\n$$\nb_{n} = \\frac{a_{n}}{2^{n}} = \\frac{2 a_{n-1}}{2^{n}} - \\frac{k n 2^{n}}{2^{n}} = \\frac{a_{n-1}}{2^{n-1}} - k n = b_{n-1} - k n.\n$$\n这个一阶差分方程给出\n$$\nb_{n} - b_{0} = -k \\sum_{j=1}^{n} j = -k \\frac{n(n+1)}{2},\n$$\n因此\n$$\nb_{n} = C_{0} - \\frac{k}{2} n(n+1).\n$$\n使用 $a_{n} = 2^{n} b_{n}$ 返回到 $a_{n}$，\n$$\na_{n} = 2^{n} \\left(C_{0} - \\frac{k}{2} n(n+1)\\right).\n$$\n代入 $C_{0} = 500$ 和 $k = 40$，\n$$\na_{n} = 2^{n} \\left(500 - 20\\, n(n+1)\\right),\n$$\n此式对所有整数 $n \\geq 0$ 成立，并满足 $a_{0} = 500$。", "answer": "$$\\boxed{2^{n}\\left(500 - 20\\,n(n+1)\\right)}$$", "id": "1401346"}, {"introduction": "最后的这个练习将我们的工具箱扩展到处理带有交替模式的非齐次项。通过研究一个假设的“时序聚合物”，你将看到如何调整待定系数法以适应包含像 $(-1)^n$ 这类因子的函数。这个练习旨在增强我们求解方法的灵活 性，并锻炼你为特解选择正确形式的能力。[@problem_id:1401306]", "problem": "在一个合成生物学实验室中，研究人员正在创造一种“时序聚合物”(chronopolymer)，这是一种聚合物链，其质量随离散的时间步长演化，步长由 $n=0, 1, 2, \\dots$ 索引。\n\n在实验开始时（即第 $n=0$ 步），该聚合物具有一个已知的初始质量，我们将其表示为 $M_{init}$。\n\n对于之后的每一步 $n \\ge 1$，聚合物的质量会通过一个两阶段过程发生改变。首先，一个自然的自我复制过程将其前一步的质量 $M_{n-1}$ 乘以一个恒定的生长因子 $\\alpha  1$。其次，一个外部催化剂系统会改变链的质量。该系统在每一步的功能都交替变化：在第 $n$ 步，它会引起一个质量变化，变化量为 $k \\cdot n \\cdot (-1)^n$，其中 $k$ 是一个衡量催化剂效能的正数。质量 $M_n$ 是这两种效应共同作用的结果。\n\n参数 $\\alpha$、$k$ 和 $M_{init}$ 应被视为给定的符号常量。\n\n求出对于任意整数步长 $n \\ge 0$，时序聚合物质量 $M_n$ 的封闭形式表达式。", "solution": "设 $M_{0}=M_{init}$，对于 $n\\geq 1$，质量的演化是在乘法增长之后进行加法变化，因此递推关系为\n$$\nM_{n}=\\alpha M_{n-1}+k\\,n\\,(-1)^{n}.\n$$\n这是一个系数为常数 $\\alpha$ 的线性非齐次递推关系。其对应的齐次方程 $M_{n}^{(h)}=\\alpha M_{n-1}^{(h)}$ 的解为\n$$\nM_{n}^{(h)}=C\\,\\alpha^{n},\n$$\n其中 $C$ 是一个任意常数。\n\n为了求出强制项 $k\\,n\\,(-1)^{n}$ 的一个特解，注意到该项是 $n$ 的一个多项式乘以 $(-1)^{n}$，并且 $\\alpha\\neq-1$（因为 $\\alpha1$），所以我们尝试一个形式如下的待定解(ansatz)\n$$\nM_{n}^{(p)}=(-1)^{n}\\left(A n+B\\right),\n$$\n其中常数 $A$ 和 $B$ 有待确定。那么\n$$\nM_{n-1}^{(p)}=(-1)^{n-1}\\left(A(n-1)+B\\right)=-(-1)^{n}\\left(A(n-1)+B\\right).\n$$\n将 $M_{n}^{(p)}$ 和 $M_{n-1}^{(p)}$ 代入递推关系，得到\n$$\nM_{n}^{(p)}-\\alpha M_{n-1}^{(p)}=(-1)^{n}\\left(A n+B\\right)-\\alpha\\left[-(-1)^{n}\\left(A(n-1)+B\\right)\\right]\n=(-1)^{n}\\left[A(1+\\alpha)n+B(1+\\alpha)-\\alpha A\\right].\n$$\n我们要求此式对所有 $n$ 都等于强制项 $k\\,n\\,(-1)^{n}$，因此我们令 $n$ 的系数和常数项相等：\n$$\nA(1+\\alpha)=k,\\qquad B(1+\\alpha)-\\alpha A=0.\n$$\n解得，\n$$\nA=\\frac{k}{1+\\alpha},\\qquad B=\\frac{\\alpha A}{1+\\alpha}=\\frac{\\alpha k}{(1+\\alpha)^{2}}.\n$$\n因此，\n$$\nM_{n}^{(p)}=(-1)^{n}\\left(\\frac{k}{1+\\alpha}\\,n+\\frac{\\alpha k}{(1+\\alpha)^{2}}\\right).\n$$\n\n通解是齐次解与特解之和：\n$$\nM_{n}=C\\,\\alpha^{n}+(-1)^{n}\\left(\\frac{k}{1+\\alpha}\\,n+\\frac{\\alpha k}{(1+\\alpha)^{2}}\\right).\n$$\n使用初始条件 $M_{0}=M_{init}$ 来确定 $C$：\n$$\nM_{0}=C+(-1)^{0}\\left(\\frac{k}{1+\\alpha}\\cdot 0+\\frac{\\alpha k}{(1+\\alpha)^{2}}\\right)=C+\\frac{\\alpha k}{(1+\\alpha)^{2}},\n$$\n所以\n$$\nC=M_{init}-\\frac{\\alpha k}{(1+\\alpha)^{2}}.\n$$\n代入回去，得到封闭形式的表达式\n$$\nM_{n}=\\alpha^{n}\\left(M_{init}-\\frac{\\alpha k}{(1+\\alpha)^{2}}\\right)+(-1)^{n}\\left(\\frac{k}{1+\\alpha}\\,n+\\frac{\\alpha k}{(1+\\alpha)^{2}}\\right),\n$$\n此式对所有整数 $n\\geq 0$ 和参数 $\\alpha1, k0$ 均成立。", "answer": "$$\\boxed{\\alpha^{n}\\left(M_{init}-\\frac{\\alpha k}{(1+\\alpha)^{2}}\\right)+(-1)^{n}\\left(\\frac{k n}{1+\\alpha}+\\frac{\\alpha k}{(1+\\alpha)^{2}}\\right)}$$", "id": "1401306"}]}