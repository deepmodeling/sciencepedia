{"hands_on_practices": [{"introduction": "让我们从一个基础练习开始，这个练习直接应用了处理不可区分对象的排列的核心公式。该问题借助生物信息学中的一个场景——排列RNA序列中的核苷酸——来帮助你掌握计算多重集排列的基本方法。通过解决这个问题，你将巩固对当元素相同时如何修正重复计数的理解 [@problem_id:1390984]。", "problem": "一位生物信息学家正在研究病毒核糖核酸 (RNA) 链的一个特定短片段。通过测序分析，确定了该片段由正好 14 个核苷酸组成。已知其构成为：5 个腺嘌呤 (A) 核苷酸、3 个胞嘧啶 (C) 核苷酸、4 个鸟嘌呤 (G) 核苷酸和 2 个尿嘧啶 (U) 核苷酸。假设所有相同类型的核苷酸彼此不可区分，使用这组确切的 14 个核苷酸可以形成多少种独特的线性序列（排列）？", "solution": "我们需要排列一个包含 $14$ 个元素的多重集，该多重集由 5 个 A、3 个 C、4 个 G 和 2 个 U 组成，其中相同类型的元素不可区分。不同线性序列的数量由对应这些数量的多项式系数给出：\n$$\nN=\\frac{14!}{5!\\,3!\\,4!\\,2!}.\n$$\n这也可以通过依次选择位置来推导：从 14 个位置中为 A 选择 5 个，然后从剩下的 9 个位置中为 C 选择 3 个，再从剩下的 6 个位置中为 G 选择 4 个，最后从剩下的 2 个位置中为 U 选择 2 个：\n$$\nN=\\binom{14}{5}\\binom{9}{3}\\binom{6}{4}\\binom{2}{2}\n=\\frac{14!}{5!\\,9!}\\cdot\\frac{9!}{3!\\,6!}\\cdot\\frac{6!}{4!\\,2!}\\cdot\\frac{2!}{2!\\,0!}\n=\\frac{14!}{5!\\,3!\\,4!\\,2!},\n$$\n使用 $0!=1$。\n\n计算确切的整数值：\n$$\n14!=87178291200,\\quad 5!=120,\\quad 3!=6,\\quad 4!=24,\\quad 2!=2,\n$$\n所以分母是\n$$\n5!\\,3!\\,4!\\,2!=120\\cdot 6\\cdot 24\\cdot 2=34560,\n$$\n且\n$$\nN=\\frac{87178291200}{34560}.\n$$\n分步相除：首先除以 $64$ 得到 $\\frac{1362160800}{540}$，然后除以 $10$ 得到 $\\frac{136216080}{54}$，再除以 $6$ 得到 $\\frac{22702680}{9}$，最后除以 $9$ 得到\n$$\nN=2522520.\n$$\n因此，独特的线性序列数量为 $2522520$。", "answer": "$$\\boxed{2522520}$$", "id": "1390984"}, {"introduction": "现实世界中的问题常常带有特定的约束条件。下一个练习将通过引入一个相对顺序的要求，挑战你超越简单的公式应用。你将学到一种强大的技巧，通过巧妙地将元素分组来简化此类问题，从而将一个复杂的排列问题转化为一个更易于处理的组合问题 [@problem_id:1391271]。", "problem": "在一个自动化物流设施中，正在编程一个排序算法，用于在最终的调度传送带上排列包裹。有三种类型的包裹需要排序：\n- 5个相同的“优先”包裹。\n- 3个相同的“标准”包裹。\n- 4个相同的“区域”包裹。\n\n这总共有12个包裹需要排成一个线性序列。该排序系统受一个关键操作约束的限制：所有“优先”包裹必须在序列中出现在任何“标准”包裹之前。“区域”包裹可以放置在序列中的任何位置，不受相对于其他类型包裹的限制。\n\n计算满足给定约束条件的这12个包裹的不同的线性排列总数。请提供确切的整数值。", "solution": "设$n_P=5$为“优先”包裹的数量，$n_S=3$为“标准”包裹的数量，$n_R=4$为“区域”包裹的数量。需要排列在一个序列中的包裹总数为$N = n_P + n_S + n_R = 5 + 3 + 4 = 12$。\n\n问题要求计算在这个多重集中，满足所有优先包裹必须出现在任何标准包裹之前的约束条件下的不同排列数。\n\n我们来考虑这个线性序列中的12个位置。问题的核心在于如何处理对优先（P）和标准（S）包裹的约束。该约束固定了P和S包裹的相对顺序。对于P和S包裹所占据的任何位置选择，它们的排列方式是唯一确定的：这些位置中的前$n_P$个必须填充P，剩下的$n_S$个位置必须填充S。\n\n为了简化计数过程，我们可以将优先包裹和标准包裹视为一组暂时不可区分的物品。我们将这种新的物品类型称为“组合”（C）。这样的“组合”包裹有$n_C' = n_P + n_S = 5 + 3 = 8$个。\n\n现在问题转化为求一个新的多重集的不同排列数，该多重集包含：\n- $n_C' = 8$个“组合”包裹。\n- $n_R = 4$个“区域”包裹。\n\n这个新排列中的物品总数仍然是$N = n_C' + n_R = 8 + 4 = 12$。\n\n一个多重集的不同排列数由以下公式给出：\n$$ \\frac{N!}{k_1! k_2! \\dots k_m!} $$\n其中$N$是物品的总数，$k_1, k_2, \\dots, k_m$是每种不同物品类型的重复数。\n\n在我们简化的问题中，我们有 $N=12$，$k_1 = n_C' = 8$，以及 $k_2 = n_R = 4$。因此，不同的排列数为：\n$$ \\frac{12!}{8! \\cdot 4!} $$\n\n这个表达式也是二项式系数$\\binom{12}{8}$或$\\binom{12}{4}$的定义。我们来计算它的值：\n$$ \\binom{12}{4} = \\frac{12 \\cdot 11 \\cdot 10 \\cdot 9}{4 \\cdot 3 \\cdot 2 \\cdot 1} $$\n\n我们可以通过约分来简化表达式：\n$$ \\binom{12}{4} = \\frac{12}{4 \\cdot 3} \\cdot \\frac{10}{2} \\cdot 11 \\cdot 9 $$\n$$ \\binom{12}{4} = 1 \\cdot 5 \\cdot 11 \\cdot 9 $$\n$$ \\binom{12}{4} = 55 \\cdot 9 $$\n$$ \\binom{12}{4} = 495 $$\n\n这495种排列中的每一种都由一个包含8个“组合”包裹和4个“区域”包裹的序列组成。对于任意给定的排列，我们可以通过替换“组合”包裹来形成一个唯一的、有效的原始包裹序列。由于所有优先包裹必须在所有标准包裹之前，我们将序列中的前5个“组合”包裹替换为优先包裹，将其余3个“组合”包裹替换为标准包裹。对于每种排列，这种替换是唯一的。\n\n因此，简化集合的排列数等于原始集合的有效排列数。不同的线性排列总数为495。", "answer": "$$\\boxed{495}$$", "id": "1391271"}, {"introduction": "我们最后的练习引入了另一层复杂性，需要一种更通用和系统化的方法。这次你面对的不是一个固定的组合，而是一个组合必须遵循的规则，这迫使你考虑多种情况。这个练习将教你如何将一个问题分解为不同的情景，对每种情况使用多重集排列公式求解，然后将所有结果相加以获得最终答案 [@problem_id:1391001]。", "problem": "在制造先进光纤的质量控制过程中，需要扫描一根长光纤，并在每个单位长度上将其传输特性分为三类之一：“最优”（O）、“增益误差”（G）或“损耗误差”（L）。对一个长度为 $N$ 的片段进行测量，得到一个任意的测量序列。\n\n如果一个片段的测量序列中‘增益误差’（G）读数的总数与‘损耗误差’（L）读数的总数完全相等，则该序列被定义为“频谱平衡”的。\n\n假设用于构成序列的每种类型的测量结果供应实际上是无限的，请确定长度为 $N$ 的不同频谱平衡测量序列的总数。你的答案应该是一个以 $N$ 表示的闭式解析表达式。", "solution": "我们将每个单位长度的测量建模为三个符号之一：O、G或L。如果一个长度为 $N$ 的序列中 G 符号的数量等于 L 符号的数量，那么该序列就是频谱平衡的。\n\n设序列中 G 和 L 读数的共同数量为 $k$。那么我们必须有 $2k \\leq N$，所以 $k$ 的取值范围是从 $0$ 到 $\\lfloor N/2 \\rfloor$。对于一个固定的 $k$，恰好包含 $k$ 个 G、 $k$ 个 L 和 $N-2k$ 个 O 的序列数量由多项式系数给出：\n$$\n\\frac{N!}{k!\\,k!\\,(N-2k)!}.\n$$\n等价地，我们可以分两步计数：首先，从 $N$ 个位置中选择 $2k$ 个非 O 的位置，有 $\\binom{N}{2k}$ 种方法；然后，在这 $2k$ 个位置中选择哪 $k$ 个是 G（剩下的 $k$ 个将是 L），有 $\\binom{2k}{k}$ 种方法。这会得到相同的计数值：\n$$\n\\binom{N}{2k}\\binom{2k}{k}=\\frac{N!}{k!\\,k!\\,(N-2k)!}.\n$$\n对所有可能的 $k$ 值求和，即可得到频谱平衡序列的总数：\n$$\n\\sum_{k=0}^{\\lfloor N/2 \\rfloor} \\binom{N}{2k}\\binom{2k}{k}.\n$$\n这就是中心三项式系数，它也等于在对应关系 $G \\mapsto 1$，$L \\mapsto -1$，$O \\mapsto 0$ 下，由 $\\{-1,0,1\\}$ 构成的长度为 $N$ 且总和为零的序列的数量。", "answer": "$$\\boxed{\\sum_{k=0}^{\\lfloor N/2 \\rfloor} \\binom{N}{2k}\\binom{2k}{k}}$$", "id": "1391001"}]}