{"hands_on_practices": [{"introduction": "第二类斯特林数的核心在于其递推关系，它为我们提供了一种系统性的计算方法。通过解决这个基础问题[@problem_id:491243]，你将练习如何运用递推公式 $S(n,k) = kS(n-1,k) + S(n-1,k-1)$，从已知的基础值出发，逐步构建出更复杂的斯特林数值。这是掌握该主题计算方面的关键第一步。", "problem": "计算第二类斯特林数 $S(5,3)$。\n第二类斯特林数 $S(n,k)$ 表示将一个包含 $n$ 个不同对象的集合划分为 $k$ 个非空、无标记子集的方案数。", "solution": "我们使用对于 $n,k \\ge 1$ 的斯特林数递推公式，\n$$ S(n,k) = k\\,S(n-1,k) + S(n-1,k-1), $$\n其中 $S(0,0)=1$，$S(n,0)=0$ 对于 $n>0$，$S(n,k)=0$ 对于 $k>n$。\n\n基础值的计算得出\n$$ S(1,1)=1,\\quad S(2,1)=1\\cdot S(1,1)+S(1,0)=1,\\quad S(2,2)=2\\cdot S(1,2)+S(1,1)=1. $$\n\n然后\n$$ S(3,2)=2\\,S(2,2)+S(2,1)=2\\cdot1+1=3,\\quad S(3,3)=3\\,S(2,3)+S(2,2)=1. $$\n\n接下来\n$$ S(4,2)=2\\,S(3,2)+S(3,1)=2\\cdot3+1=7,\\quad S(4,3)=3\\,S(3,3)+S(3,2)=3\\cdot1+3=6. $$\n\n最后\n$$ S(5,3)=3\\,S(4,3)+S(4,2)=3\\cdot6+7=25. $$", "answer": "$$\\boxed{25}$$", "id": "491243"}, {"introduction": "理论知识的价值在于解决实际问题，而这些问题往往带有各种约束。本练习[@problem_id:1402123]将带你超越纯粹的计算，进入组合建模的世界，你将学习如何处理“某些元素必须在同一组”的常见约束。通过一个巧妙的“融合”思想，一个看似复杂的问题可以被转化为一个我们已经熟悉的基本问题，这充分展示了组合推理的优雅与力量。", "problem": "一位软件架构师正计划将 $n$ 个不同的软件模块部署到 $k$ 个相同且不可区分的数据中心。该部署计划必须满足两个条件：\n1. 每个数据中心必须托管至少一个模块。\n2. 由于紧密耦合，两个特定模块（我们称之为模块 $M_1$ 和模块 $M_2$）必须放置在同一个数据中心。\n\n设 $S(p, q)$ 表示第二类斯特林数，它代表了将一个包含 $p$ 个不同项目的集合划分为 $q$ 个非空、不可区分子集的方法数。\n\n请找出一个用 $n$、$k$ 和函数 $S$ 表示的不同部署配置总数的表达式。假设 $n \\ge 3$ 且 $2 \\le k  n$。", "solution": "我们将一个部署配置解释为对 $n$ 个不同模块的集合的一个划分，将其分为 $k$ 个非空、不可区分的块（即数据中心）。根据第二类斯特林数的定义，若无任何约束，这样的划分数量为 $S(n,k)$。\n\n现在施加约束条件：模块 $M_{1}$ 和 $M_{2}$ 必须在同一个块中。我们在以下两者之间构造一个双射：\n- 将 $n$ 个模块划分为 $k$ 个非空、不可区分的块，其中 $M_{1}$ 和 $M_{2}$ 在同一个块内的划分集合。\n- 将 $n-1$ 个对象划分为 $k$ 个非空、不可区分的块的划分集合。\n\n定义一个融合对象 $X=\\{M_{1},M_{2}\\}$。设 $U=\\{M_1, M_2, M_3, \\dots, M_n\\}$ 且 $U'=\\{X, M_3, \\dots, M_n\\}$，于是 $|U'|=n-1$。对于任何一个将 $U$ 划分为 $k$ 个非空、不可区分块，且 $M_1$ 和 $M_2$ 在同一块中的划分，我们将该块中的 $\\{M_1, M_2\\}$ 替换为 $X$；其他所有块保持不变。这便生成了一个将 $U'$ 划分为 $k$ 个非空、不可区分块的划分。\n\n反之，对于任何一个将 $U'$ 划分为 $k$ 个非空、不可区分块的划分，我们将包含 $X$ 的块中的 $X$ 展开回 $M_1$ 和 $M_2$，即可得到一个对 $U$ 的划分，其中 $M_1$ 和 $M_2$ 在同一块中。\n\n这两个映射互为逆映射，因此这两个集合之间存在双射。所以，有效部署配置的数量等于将 $n-1$ 个不同对象划分为 $k$ 个非空、不可区分块的方法数，此数即为 $S(n-1,k)$。给定条件 $2 \\le k  n$ 确保了 $k \\le n-1$，故在此条件下 $S(n-1,k)$ 是良定义且非零的。\n\n因此，不同部署配置的总数是 $S(n-1,k)$。", "answer": "$$\\boxed{S(n-1,k)}$$", "id": "1402123"}, {"introduction": "当我们面对的约束从“必须在一起”变为“必须分开”时，问题的复杂度会显著增加。这个高级练习[@problem_id:1402109]将挑战你综合运用多种组合工具的能力。你将学习如何利用容斥原理，将一个关于“禁止”的难题，转化为一系列我们更容易计算的“允许”的情形，并最终得到答案。这个过程不仅能让你掌握处理复杂约束的强大方法，还能加深你对斯特林数与其他组合原理之间联系的理解。", "problem": "在组合数学中，集合 $S$ 的一个划分（partition）是将其分解为若干非空、两两不交的子集（称为块，block）的一种方式，且这些块的并集为集合 $S$。例如，$\\{\\{1, 3\\}, \\{2\\}, \\{4, 5\\}\\}$ 是将集合 $\\{1, 2, 3, 4, 5\\}$ 划分成三个块的一个例子。\n\n考虑一个包含 $n=7$ 个不同元素的集合 $S$。我们希望将这个集合划分为恰好 $k=5$ 个非空块。然而，这个划分过程有一个特定的约束条件：一个预先选定的、包含 $m=3$ 个元素的子集 $M \\subset S$，其所有成员必须被放置在不同的块中。也就是说，子集 $M$ 中的任意两个元素都不能出现在划分的同一个块中。\n\n你的任务是计算所有这种有效划分的总数。", "solution": "设 $S$ 为一个大小为 $n=7$ 的集合，并设 $M \\subset S$ 为一个大小为 $m=3$ 的固定子集。我们要求的是将 $S$ 划分为恰好 $k=5$ 个非空块，且 $M$ 中所有元素都位于不同块的划分总数。\n\n令 $\\left\\{ {n \\atop k} \\right\\}$ 表示第二类斯特林数，即把一个 $n$ 元集划分为 $k$ 个非空块的划分数。令 $U$ 为将 $S$ 划分为 5 个块的所有划分的集合，则 $|U|=\\left\\{ {7 \\atop 5} \\right\\}$。\n\n对于 $M$ 中的每个无序对 $\\{a,b\\}$，定义事件 $E_{ab}$ 为 $a$ 和 $b$ 位于同一个块中。我们要求的是避免所有这类事件的划分数。根据容斥原理，\n$$\n|U \\setminus (E_{12} \\cup E_{13} \\cup E_{23})|\n= |U| - \\sum |E_{ab}| + \\sum |E_{ab} \\cap E_{a'b'}| - |E_{12} \\cap E_{13} \\cap E_{23}|.\n$$\n如果来自 $M$ 的特定一对元素必须在一起，我们可以将这对元素视为一个超元素；这使得有效元素的数量减少到 $7-1=6$，而块的数量仍为 5。因此 $|E_{ab}|=\\left\\{ {6 \\atop 5} \\right\\}$。共有 3 对这样的元素对。\n\n在 $\\{E_{12},E_{13},E_{23}\\}$ 中任意两个不同对事件的交集，都会迫使 $M$ 的所有三个元素都在同一个块中，这对应于将这三个元素视为一个超元素，使有效元素数量减少到 $7-(3-1)=5$，而块的数量仍为 5。因此 $|E_{ab} \\cap E_{a'b'}|=\\left\\{ {5 \\atop 5} \\right\\}$。有 3 个这样的双重交集。同样，三重交集也对应于所有三个元素都在一起的情况，所以 $|E_{12} \\cap E_{13} \\cap E_{23}|=\\left\\{ {5 \\atop 5} \\right\\}$。\n\n因此，\n$$\n\\text{所求数量}\n= \\left\\{ {7 \\atop 5} \\right\\} - 3 \\left\\{ {6 \\atop 5} \\right\\} + 3 \\left\\{ {5 \\atop 5} \\right\\} - \\left\\{ {5 \\atop 5} \\right\\}\n= \\left\\{ {7 \\atop 5} \\right\\} - 3 \\left\\{ {6 \\atop 5} \\right\\} + 2 \\left\\{ {5 \\atop 5} \\right\\}.\n$$\n\n我们现在使用递推关系 $\\left\\{ {n \\atop k} \\right\\} = k \\left\\{ {n-1 \\atop k} \\right\\} + \\left\\{ {n-1 \\atop k-1} \\right\\}$ 以及基础值 $\\left\\{ {n \\atop 1} \\right\\} = 1$ 和 $\\left\\{ {n \\atop n} \\right\\} = 1$ 来计算斯特林数：\n- $\\left\\{ {5 \\atop 5} \\right\\} = 1$。\n- $\\left\\{ {5 \\atop 4} \\right\\} = \\binom{5}{2} = 10$。\n- $\\left\\{ {6 \\atop 5} \\right\\} = \\binom{6}{2} = 15$。\n- $\\left\\{ {5 \\atop 3} \\right\\} = 25$。\n- $\\left\\{ {6 \\atop 4} \\right\\} = \\left\\{ {5 \\atop 3} \\right\\} + 4 \\left\\{ {5 \\atop 4} \\right\\} = 25 + 4 \\cdot 10 = 65$。\n- $\\left\\{ {7 \\atop 5} \\right\\} = \\left\\{ {6 \\atop 4} \\right\\} + 5 \\left\\{ {6 \\atop 5} \\right\\} = 65 + 5 \\cdot 15 = 140$。\n\n为了清晰起见，这里是部分斯特林数的计算细节：\n- $\\left\\{ {5 \\atop 5} \\right\\} = 1$\n- $\\left\\{ {5 \\atop 4} \\right\\} = 4 \\left\\{ {4 \\atop 4} \\right\\} + \\left\\{ {4 \\atop 3} \\right\\} = 4 \\cdot 1 + 6 = 10$\n- $\\left\\{ {5 \\atop 3} \\right\\} = 3 \\left\\{ {4 \\atop 3} \\right\\} + \\left\\{ {4 \\atop 2} \\right\\} = 3 \\cdot 6 + 7 = 25$\n- $\\left\\{ {6 \\atop 5} \\right\\} = 5 \\left\\{ {5 \\atop 5} \\right\\} + \\left\\{ {5 \\atop 4} \\right\\} = 5 \\cdot 1 + 10 = 15$\n- $\\left\\{ {6 \\atop 4} \\right\\} = 4 \\left\\{ {5 \\atop 4} \\right\\} + \\left\\{ {5 \\atop 3} \\right\\} = 4 \\cdot 10 + 25 = 65$\n- $\\left\\{ {7 \\atop 5} \\right\\} = 5 \\left\\{ {6 \\atop 5} \\right\\} + \\left\\{ {6 \\atop 4} \\right\\} = 5 \\cdot 15 + 65 = 75 + 65 = 140$\n\n代入得，\n$$\n\\text{所求数量} = 140 - 3 \\cdot 15 + 2 \\cdot 1 = 140 - 45 + 2 = 97.\n$$\n因此，有 $97$ 种有效的划分。", "answer": "$$\\boxed{97}$$", "id": "1402109"}]}