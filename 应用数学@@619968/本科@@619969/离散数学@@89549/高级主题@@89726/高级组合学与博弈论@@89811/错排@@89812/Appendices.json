{"hands_on_practices": [{"introduction": "这第一个练习是进入错排世界的绝佳切入点。通过一个重排单词中字母的具体任务，你将把错排的正式定义应用到一个实际场景中。这个练习将巩固你对错排概念的理解，并让你亲手实践如何使用容斥原理来计算错排数 [@problem_id:1362380]。", "problem": "一个变位词是由另一个单词或短语的字母重新排列而形成的单词或短语。考虑单词`COMPUTER`。我们感兴趣的是从这个单词创建特殊的变位词，使得每个字母都移动到一个新的位置。也就是说，对于任何得到的排列，第一个字母不是'C'，第二个字母不是'O'，第三个字母不是'M'，依此类推，直到最后一个字母不是'R'。有多少个这样的唯一变位词存在？", "solution": "单词 COMPUTER 中的所有字母都是不同的，因此所要求的排列正是8个不同对象的错排。令 $A_i$ 为第 $i$ 个位置固定的排列所构成的集合（即，原始的第 $i$ 个字母仍在第 $i$ 个位置）。根据容斥原理，没有不动点（即错排）的排列数是\n$$\nD_{8}=\\left|\\overline{A_{1}\\cup \\cdots \\cup A_{8}}\\right|=\\sum_{k=0}^{8}(-1)^{k}\\binom{8}{k}(8-k)!.\n$$\n等价地，\n$$\nD_{8}=8!\\sum_{k=0}^{8}\\frac{(-1)^{k}}{k!}.\n$$\n逐项计算这个容斥和，\n$$\nD_{8}=8!-\\binom{8}{1}7!+\\binom{8}{2}6!-\\binom{8}{3}5!+\\binom{8}{4}4!-\\binom{8}{5}3!+\\binom{8}{6}2!-\\binom{8}{7}1!+\\binom{8}{8}0!.\n$$\n计算每一项：\n$$\n8!=40320,\\quad \\binom{8}{1}7!=8\\cdot 5040=40320,\\quad \\binom{8}{2}6!=28\\cdot 720=20160,\n$$\n$$\n\\binom{8}{3}5!=56\\cdot 120=6720,\\quad \\binom{8}{4}4!=70\\cdot 24=1680,\\quad \\binom{8}{5}3!=56\\cdot 6=336,\n$$\n$$\n\\binom{8}{6}2!=28\\cdot 2=56,\\quad \\binom{8}{7}1!=8\\cdot 1=8,\\quad \\binom{8}{8}0!=1\\cdot 1=1.\n$$\n将各项按正负交替求和：\n$$\n40320-40320+20160-6720+1680-336+56-8+1=14833.\n$$\n因此，单词 COMPUTER 中没有字母停留在其原始位置的变位词数量为 $D_{8}=14833$。", "answer": "$$\\boxed{14833}$$", "id": "1362380"}, {"introduction": "虽然容斥原理是基础，但对于较大的数 $n$，其计算可能相当繁琐。本练习介绍了一种更优雅、通常也更快捷的方法：递推关系。通过利用已知的小集合的错排数，你可以高效地计算出更大集合的错排数，这突显了该组合问题内含的优美递推结构 [@problem_id:1362405]。", "problem": "一位咖啡师为6位特定的顾客准备了6份不同且个性化的咖啡订单。在一时糊涂中，他将这6份订单随机分配给了这6位顾客。当且仅当每位顾客都收到了不属于自己的订单时，就发生了一次完全的错配。根据以往小规模的失误得知，对于4位顾客，有9种可能的完全错配方式；对于5位顾客，有44种可能的方式。基于此信息，计算这6位顾客发生完全错配的总方式数。", "solution": "设 $D_{n}$ 表示 $n$ 个不同项目的错排（完全错配）数。通过对项目1的位置进行条件分析，可以得到错排的标准递推关系式为\n$$\nD_{n}=(n-1)\\big(D_{n-1}+D_{n-2}\\big).\n$$\n证明：项目1必须被分配到某个不为1的位置 $j$ 上，这有 $(n-1)$ 种选择。如果原本应在位置 $j$ 的项目被分配到了位置1，那么剩下的 $n-2$ 个项目必须完全错排，这贡献了 $D_{n-2}$ 种情况。如果它没有被分配到位置1，那么问题就等价于对剩下的 $n-1$ 个项目进行错排，这贡献了 $D_{n-1}$ 种情况。将这两种情况相加，即可得到该递推关系。\n\n我们已知 $D_{4}=9$ 和 $D_{5}=44$。应用该递推关系式，令 $n=6$，则\n$$\nD_{6}=(6-1)\\big(D_{5}+D_{4}\\big)=5\\big(44+9\\big)=5\\times 53=265.\n$$\n因此，6位顾客发生完全错配的总方式数为265。", "answer": "$$\\boxed{265}$$", "id": "1362405"}, {"introduction": "这最后一个练习将挑战你从简单地计算所有可能的错排，转向关注具有特定结构属性的子集。你需要从置换的轮换分解（cycle decomposition）角度来思考，这是抽象代数和组合学中的一个强大概念。本练习旨在培养你通过将复杂计数问题分解为独立的、可管理的子问题来解决问题的能力 [@problem_id:1362414]。", "problem": "在一个秘密组织中，一支由 $N=8$ 名特工组成的团队，其编号为1到8的整数，需要为一项任务分配新的秘密呼号。新的呼号也是1到8的整数。该分配方案由集合 $\\{1, 2, \\dots, 8\\}$ 的一个排列 $\\pi$ 给出，其中 $\\pi(i)$ 是特工 $i$ 的新呼号。为保证安全，该分配方案必须是一个错排，即没有特工会被分配自己的编号作为呼号（也就是说，对于所有从1到8的 $i$，都有 $\\pi(i) \\neq i$）。此外，出于行动上的原因，特工1必须是三人通信循环的一部分。这意味着存在另外两名不同的特工 $j$ 和 $k$，使得特工1被分配特工 $j$ 的编号，特工 $j$ 被分配特工 $k$ 的编号，而特工 $k$ 被分配特工1的编号。\n\n有多少种这样有效的分配方案是可能的？", "solution": "一个有限集合的排列可以唯一地分解为不相交的循环。特工1处于一个3-循环中的要求意味着，存在不同的 $j,k \\in \\{2,3,\\dots,8\\}$，使得在 $\\{1,j,k\\}$ 上的循环是一个3-循环。在一个错排中，没有不动点，因此在指定了包含1的3-循环之后，剩下的5名特工必须构成这5个元素的错排。\n\n首先，计算包含1的3-循环的数量。从 $\\{2,3,\\dots,8\\}$ 中选择一个由不同元素组成的有序对 $(j,k)$，这将产生3-循环 $(1\\,j\\,k)$。不同的有序对会产生不同的循环，并且有 $7 \\cdot 6 = 42$ 个这样的有序对。因此，包含1的3-循环的数量是42。\n\n接下来，计算剩下5个元素的错排数量。根据容斥原理， $n$ 个元素的错排数量 $D_n$ 是\n$$\nD_n = n!\\sum_{m=0}^{n}\\frac{(-1)^{m}}{m!}.\n$$\n对于 $n=5$，\n$$\nD_5 = 5!\\left(1 - 1 + \\frac{1}{2!} - \\frac{1}{3!} + \\frac{1}{4!} - \\frac{1}{5!}\\right)\n= 120\\left(0 + \\frac{1}{2} - \\frac{1}{6} + \\frac{1}{24} - \\frac{1}{120}\\right).\n$$\n使用公分母 $120$，括号内的和等于\n$$\n\\frac{120 - 120 + 60 - 20 + 5 - 1}{120} = \\frac{44}{120},\n$$\n所以\n$$\nD_5 = 120 \\cdot \\frac{44}{120} = 44.\n$$\n\n因为在 $\\{1,j,k\\}$ 上的循环与剩下5个元素上的排列是不相交的，所以选择数相乘。因此，有效分配方案的总数是\n$$\n42 \\times 44 = 1848.\n$$", "answer": "$$\\boxed{1848}$$", "id": "1362414"}]}