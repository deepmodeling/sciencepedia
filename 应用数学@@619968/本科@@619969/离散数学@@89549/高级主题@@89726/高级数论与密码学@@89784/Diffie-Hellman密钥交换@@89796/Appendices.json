{"hands_on_practices": [{"introduction": "这个练习将让你扮演爱丽丝（Alice）的角色，亲手完成一次完整的迪菲-赫尔曼密钥交换。通过手动计算找出秘密整数，并最终算出共享密钥，你将亲身体验该协议的核心运作流程。这项实践有助于你巩固对模幂运算以及离散对数问题在实际应用中的理解 [@problem_id:1363105]。", "problem": "两个名为 Alice 和 Bob 的自治数据中心需要为安全通信建立一个共享密钥。他们决定使用 Diffie-Hellman 密钥交换协议。他们公开约定了一个素数模 $p=23$ 和一个原根（生成元）$g=5$。\n\nAlice 选择一个秘密整数 $a$，并计算她的公钥 $A = g^a \\pmod{p}$。\nBob 选择一个秘密整数 $b$，并计算他的公钥 $B = g^b \\pmod{p}$。\n\n他们通过一个不安全的信道交换了公钥。一个窃听者 Eve 截获了这些公钥，并得知 Alice 的公钥是 $A=17$，Bob 的公钥是 $B=11$。然而，Eve 无法轻易确定他们的秘密整数 $a$ 和 $b$。\n\nAlice 计算共享密钥为 $s = B^a \\pmod{p}$。Bob 计算共享密钥为 $s = A^b \\pmod{p}$。根据协议设计，他们的结果将是相同的。\n\n你的任务是扮演 Alice。首先，通过测试整数值来确定你的秘密整数 $a$。然后，使用你的秘密整数 $a$ 计算最终的共享密钥 $s$。已知秘密整数 $a$ 和 $b$ 均为正整数。共享密钥 $s$ 的值是多少？", "solution": "在给定的 Diffie-Hellman 设置中，模数为 $p=23$，生成元为 $g=5$，Alice 的公钥为 $A=17$，Bob 的公钥为 $B=11$。我们必须找到 Alice 的秘密整数 $a$，使得 $A \\equiv g^{a} \\pmod{p}$，然后计算共享密钥 $s \\equiv B^{a} \\pmod{p}$。\n\n为了确定 $a$，我们通过测试连续的指数来求解 $5^{a} \\equiv 17 \\pmod{23}$：\n$$\n\\begin{aligned}\n5^{1} &\\equiv 5 \\pmod{23},\\\\\n5^{2} &\\equiv 25 \\equiv 2 \\pmod{23},\\\\\n5^{3} &\\equiv 2\\cdot 5=10 \\pmod{23},\\\\\n5^{4} &\\equiv 10\\cdot 5=50 \\equiv 4 \\pmod{23},\\\\\n5^{5} &\\equiv 4\\cdot 5=20 \\pmod{23},\\\\\n5^{6} &\\equiv 20\\cdot 5=100 \\equiv 8 \\pmod{23},\\\\\n5^{7} &\\equiv 8\\cdot 5=40 \\equiv 17 \\pmod{23}.\n\\end{aligned}\n$$\n因此 $a=7$。\n\n使用平方求幂法计算共享密钥 $s \\equiv B^{a} \\equiv 11^{7} \\pmod{23}$：\n$$\n11^{2} \\equiv 121 \\equiv 6 \\pmod{23},\\quad\n11^{4} \\equiv 6^{2}=36 \\equiv 13 \\pmod{23},\n$$\n并且\n$$\n11^{7}=11^{4}\\cdot 11^{2}\\cdot 11 \\equiv 13\\cdot 6\\cdot 11 \\pmod{23}.\n$$\n计算乘积模 $23$ 的值：\n$$\n13\\cdot 6=78 \\equiv 9 \\pmod{23},\\quad 9\\cdot 11=99 \\equiv 7 \\pmod{23}.\n$$\n因此，$s \\equiv 7 \\pmod{23}$，所以共享密钥是 $s=7$。\n\n（可选验证，通过群结构：因为 $5$ 是模 $23$ 的一个原根，所以存在一个 $b$ 使得 $5^{b}\\equiv 11$。继续计算上表可得 $b=9$，因此 $s\\equiv 5^{ab}=5^{63}\\equiv 5^{19}\\equiv 7 \\pmod{23}$，与结果相符。）", "answer": "$$\\boxed{7}$$", "id": "1363105"}, {"introduction": "真正理解一个协议，也意味着能识别出其错误的用法。本练习展示了一个常见的概念性错误：在计算共享密钥时，错误地使用了模乘法而非模幂运算。通过找出这个错误，你将加深对“为什么模幂运算是迪菲-赫尔曼交换中不可或缺的加密操作”这一核心概念的理解 [@problem_id:1363053]。", "problem": "两名学生，Alice 和 Bob，正在使用迪菲-赫尔曼密钥交换协议来建立一个共享密钥。他们公开约定了一个素数模数 $p = 23$ 和一个生成元 $g = 5$。\n\nAlice选择了一个秘密私钥 $a = 4$。\nBob选择了一个秘密私钥 $b = 7$。\n\n第三名学生 Charlie 观察了公开信息，并试图遵循协议步骤，从 Alice 的角度来确定最终的共享秘密。Charlie 将过程记录如下：\n\n**步骤 1：** Alice 使用公式 $A \\equiv g^a \\pmod p$ 计算她的公钥 $A$。\n计算：$A \\equiv 5^4 \\pmod{23}$。因为 $5^4 = 625$ 且 $625 = 27 \\times 23 + 4$，所以 Alice 的公钥是 $A=4$。\n\n**步骤 2：** Bob 使用公式 $B \\equiv g^b \\pmod p$ 计算他的公钥 $B$。\n计算：$B \\equiv 5^7 \\pmod{23}$。因为 $5^7 = 78125$ 且 $78125 = 3396 \\times 23 + 17$，所以 Bob 的公钥是 $B=17$。\n\n**步骤 3：** Alice 和 Bob 交换他们的公钥。Alice 现在知道了 $B=17$，Bob 也知道了 $A=4$。\n\n**步骤 4：** 为了计算共享秘密 $s$，Alice 使用她的私钥 $a$ 和 Bob 的公钥 $B$。Charlie 假设这种组合的公式是 $s \\equiv a \\cdot B \\pmod p$。\n\n**步骤 5：** Charlie 基于步骤 4 中的公式执行计算。\n计算：$s \\equiv 4 \\cdot 17 \\pmod{23}$。因为 $4 \\cdot 17 = 68$ 且 $68 = 2 \\times 23 + 22$，所以共享秘密是 $s=22$。\n\n在应用迪菲-赫尔曼协议的过程中，第一个概念性错误出现在哪一步？\n\nA. 步骤 1：Alice 公钥 $A$ 的计算。\n\nB. 步骤 2：Bob 公钥 $B$ 的计算。\n\nC. 步骤 3：公钥的交换。\n\nD. 步骤 4：用于计算共享秘密 $s$ 的公式。\n\nE. 步骤 5：共享秘密 $s$ 的数值计算。", "solution": "在迪菲-赫尔曼密钥交换中，公开参数是一个素数模数 $p$ 和模 $p$ 乘法子群的一个生成元 $g$。每一方选择一个私钥（Alice: $a$，Bob: $b$），使用模 $p$ 幂运算计算公钥，交换公钥，然后通过用自己的私有指数对收到的公钥进行模 $p$ 幂运算来计算共享秘密：\n$$\nA \\equiv g^{a} \\pmod{p}, \\quad B \\equiv g^{b} \\pmod{p}, \\quad s \\equiv B^{a} \\pmod{p} \\equiv A^{b} \\pmod{p}.\n$$\n\n验证步骤 1：\nAlice 在 $g=5$，$a=4$，$p=23$ 的条件下计算 $A \\equiv g^{a} \\pmod{p}$。\n计算 $5^{4} \\pmod{23}$。注意 $5^{2}=25 \\equiv 2 \\pmod{23}$，因此 $5^{4} \\equiv (5^{2})^{2} \\equiv 2^{2} \\equiv 4 \\pmod{23}$。所以 $A=4$，步骤 1 是正确的。\n\n验证步骤 2：\nBob 在 $g=5$，$b=7$，$p=23$ 的条件下计算 $B \\equiv g^{b} \\pmod{p}$。\n计算 $5^{7} \\pmod{23}$。将 $5^{7}$ 写成 $5^{4}\\cdot 5^{3}$。根据上面，我们有 $5^{4} \\equiv 4 \\pmod{23}$ 且 $5^{3}=125 \\equiv 125-5\\cdot 23 \\equiv 10 \\pmod{23}$。因此，$5^{7} \\equiv 4 \\cdot 10 \\equiv 40 \\equiv 17 \\pmod{23}$。所以 $B=17$，步骤 2 是正确的。\n\n验证步骤 3：\n交换公钥是一个正确的程序步骤；交换 $A$ 和 $B$ 没有概念性错误。\n\n检查步骤 4：\n正确的迪菲-赫尔曼共享秘密计算，从 Alice 的角度看是 $s \\equiv B^{a} \\pmod{p}$（或等价地，从 Bob 的角度看是 $s \\equiv A^{b} \\pmod{p}$）。公式 $s \\equiv a \\cdot B \\pmod{p}$ 用模乘法替换了模幂运算，而不是迪菲-赫尔曼协议规定的操作。因此，第一个概念性错误是步骤 4 中使用的公式。\n\n为了完整起见，正确的共享秘密应该是 $s \\equiv 17^{4} \\pmod{23}$。因为 $17 \\equiv -6 \\pmod{23}$，所以 $17^{2} \\equiv 36 \\equiv 13 \\pmod{23}$ 且 $17^{4} \\equiv 13^{2} \\equiv 169 \\equiv 8 \\pmod{23}$。这证实了步骤 5 中的计算是基于错误的步骤 4，但第一个错误发生在步骤 4。", "answer": "$$\\boxed{D}$$", "id": "1363053"}, {"introduction": "迪菲-赫尔曼协议的安全性完全依赖于私钥的保密性。这项实践模拟了一次安全事故，其中一方的私钥被意外泄露，而你将扮演窃听者夏娃（Eve）的角色。通过这个练习，你将看到一个简单的失误如何让攻击者轻而易举地计算出共享密钥，从而深刻体会到在任何密码学体系中保护私有信息的极端重要性 [@problem_id:1363064]。", "problem": "两方（Alice和Bob）希望使用Diffie-Hellman密钥交换协议建立一个共享密钥，以进行安全通信。他们公开约定了一个素数模数 $p=107$ 和一个底数 $g=2$，$g$ 是模 $p$ 的一个原根。\n\nAlice选择一个秘密整数 $a$，计算她的公钥 $A = g^a \\pmod p$，并通过一个公共信道发送 $A$。\n\nBob选择一个秘密整数 $b$。他打算计算他的公钥 $B = g^b \\pmod p$ 并将其发送给Alice。然而，由于一个软件故障，Bob的系统发生故障，在公共信道上广播了他的秘密整数 $b$ 本身，而不是他的公钥 $B$。\n\n一个窃听者Eve正在监听该信道，并截获了所有传输的信息。Eve截获了Alice的公钥，其值为 $A=34$。她还截获了Bob错误发送的值，即 $b=25$。\n\n根据这些信息，确定Eve现在可以计算出的共享密钥的值。", "solution": "在Diffie-Hellman协议中，共享密钥是 $K = g^{ab} \\bmod p$。如果Eve知道 $b$ 和Alice的公钥 $A = g^{a} \\bmod p$，她可以如下计算共享密钥：\n$$\nK \\equiv A^{b} \\pmod p.\n$$\n给定 $p=107$，$A=34$ 和 $b=25$，共享密钥为：\n$$\nK \\equiv 34^{25} \\pmod{107}.\n$$\n使用重复平方和二进制分解 $25=16+8+1$：\n$$\n34^{2} \\equiv 1156 \\equiv 86 \\pmod{107},\n$$\n$$\n34^{4} \\equiv 86^{2} = 7396 \\equiv 13 \\pmod{107},\n$$\n$$\n34^{8} \\equiv 13^{2} = 169 \\equiv 62 \\pmod{107},\n$$\n$$\n34^{16} \\equiv 62^{2} = 3844 \\equiv 99 \\pmod{107}.\n$$\n因此，\n$$\n34^{25} \\equiv 34^{16}\\cdot 34^{8}\\cdot 34 \\equiv 99 \\cdot 62 \\cdot 34 \\pmod{107}.\n$$\n计算模 $107$ 的乘积：\n$$\n99 \\cdot 62 = 6138 \\equiv 39 \\pmod{107},\n$$\n$$\n39 \\cdot 34 = 1326 \\equiv 42 \\pmod{107}.\n$$\n所以，\n$$\nK \\equiv 42 \\pmod{107}.\n$$\nEve可以计算出的共享密钥是 $42$。", "answer": "$$\\boxed{42}$$", "id": "1363064"}]}