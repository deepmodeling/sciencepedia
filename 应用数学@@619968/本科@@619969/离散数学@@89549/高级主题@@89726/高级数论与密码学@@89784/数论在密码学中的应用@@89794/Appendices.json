{"hands_on_practices": [{"introduction": "RSA 算法的安全性与功能性取决于密钥生成过程中遵循的精确数学规则。一个关键步骤是选择与 $\\phi(n)$ 互质的公钥指数 $e$。本练习将展示一个违反此规则导致无法生成有效私钥的场景，并要求您找出其根本原因。[@problem_id:1349562]", "problem": "一名本科生正在学习 Rivest-Shamir-Adleman (RSA) 公钥密码系统。在一个动手练习中，他们选择了两个小的素数，$p=5$ 和 $q=11$。他们正确地计算了模数 $n = pq$ 和欧拉函数 $\\phi(n) = (p-1)(q-1)$。\n\n按照 RSA 密钥生成过程，该学生必须选择一个公钥指数 $e$。他们选择了 $e=20$。然而，当他们尝试计算相应的私钥指数 $d$（它应该是 $e$ 模 $\\phi(n)$ 的乘法逆元）时，他们发现不存在这样的整数 $d$。\n\n下列哪个陈述正确地指出了导致此失败的根本数学原因？\n\nA. 所选的素数 $q=11$ 不够大，无法保证生成有效的密钥对。\n\nB. 公钥指数 $e$ 必须是素数，但所选的值 $e=20$ 是合数。\n\nC. 公钥指数 $e$ 和 $\\phi(n)$ 必须互素，但它们共享一个大于1的公因数。\n\nD. 公钥指数 $e$ 必须小于模数 $n$。\n\nE. 初始数字之一 $p=5$ 太小，导致 $\\phi(n)$ 成为一个偶数。", "solution": "给定素数 $p=5$ 和 $q=11$，RSA 模数和欧拉函数为\n$$n=pq=5\\cdot 11=55,$$\n$$\\phi(n)=(p-1)(q-1)=(5-1)(11-1)=4\\cdot 10=40.$$\n在 RSA 中，私钥指数 $d$ 被定义为满足以下同余式\n$$ed\\equiv 1 \\pmod{\\phi(n)}.$$\n一个基本的数论事实是：整数 $a$ 存在模 $m$ 的乘法逆元的充要条件是 $\\gcd(a,m)=1$。因此，$d$ 存在的充分必要条件是\n$$\\gcd(e,\\phi(n))=1.$$\n对于所选的 $e=20$ 和 $\\phi(n)=40$，我们计算\n$$\\gcd(20,40)=20>1.$$\n等价地，$20$ 整除 $40$，所以 $20$ 模 $40$ 不可逆。因此，不存在整数 $d$ 满足 $20d\\equiv 1 \\pmod{40}$，这就解释了失败的原因。\n\n评估各个选项：\n- A 是错误的：$q$ 的大小不决定可逆性；只有 $\\gcd(e,\\phi(n))$ 才重要。\n- B 是错误的：$e$ 不必是素数；它只需要与 $\\phi(n)$ 互素（例如，当 $\\gcd(9,40)=1$ 时，$e=9$ 是有效的）。\n- C 是正确的：此处 $e$ 和 $\\phi(n)$ 共享公因数 $20$，所以逆元不存在。\n- D 在此情境下是错误的：$e<n$ 成立（$20<55$），而关键条件是与 $\\phi(n)$ 互素。\n- E 是错误的：对于奇素数 $p$ 和 $q$，$\\phi(n)$ 总是偶数；这本身不是问题——问题在于 $e$ 和 $\\phi(n)$ 之间共享的因数。\n\n因此，正确的陈述是 C。", "answer": "$$\\boxed{C}$$", "id": "1349562"}, {"introduction": "尽管 RSA 功能强大，但选择不当的公钥可能导致安全漏洞。其中一个漏洞是“不动点”的存在——即经过加密后保持不变的消息。本练习要求您在给定的简化 RSA 系统中找出这些特殊消息，从而深入了解该系统的结构以及参数选择的重要性。[@problem_id:1349536]", "problem": "在 Rivest-Shamir-Adleman (RSA) 公钥密码系统中，使用公钥 $(n, e)$ 将消息 $M$ 加密为密文 $C$ 的关系式为 $C \\equiv M^e \\pmod{n}$。如果一条消息是加密函数的“不动点”，即加密过程返回原始消息（亦即 $C = M$），就会出现一个显著的密码学弱点。\n\n考虑一个公钥为 $(n, e) = (33, 3)$ 的简化 RSA 系统。你的任务是找出在范围 $1 < M < 32$ 内，作为此加密函数不动点的所有消息值 $M$。\n\n下列哪个集合包含了所有这样的不动点 $M$？\n\nA. $\\{10, 11, 22, 23\\}$\n\nB. $\\{10, 11, 12, 21, 22, 23\\}$\n\nC. $\\{11, 22\\}$\n\nD. $\\{1, 32\\}$\n\nE. $\\{3, 11\\}$\n\nF. $\\{16, 25\\}$", "solution": "一个不动点满足 $M^{e} \\equiv M \\pmod{n}$。当 $(n,e)=(33,3)$ 时，该条件为\n$$\nM^{3} \\equiv M \\pmod{33}.\n$$\n这等价于\n$$\nM^{3}-M \\equiv 0 \\pmod{33} \\quad \\Longleftrightarrow \\quad M(M-1)(M+1) \\equiv 0 \\pmod{33}.\n$$\n我们将 $33$ 分解为 $33=3 \\cdot 11$，其中 $\\gcd(3,11)=1$。根据中国剩余定理，同余式 $M^{3} \\equiv M \\pmod{33}$ 成立，当且仅当它同时对模 $3$ 和模 $11$ 成立。\n\n1) 模 $3$：根据费马小定理，对于任意质数 $p$ 的任何余数 $a$，都有 $a^{p} \\equiv a \\pmod{p}$。当 $p=3$ 时，每个 $M$ 都满足 $M^{3} \\equiv M \\pmod{3}$。因此，对模 $3$ 没有限制。\n\n2) 模 $11$：在模 $11$ 的域上，对 $M^{3}-M = M(M-1)(M+1)$ 进行因式分解。要使该表达式模 $11$ 等于零，其因子之一必须为零。因此解满足\n$$\nM \\equiv 0, \\; 1, \\; -1 \\pmod{11},\n$$\n即，\n$$\nM \\equiv 0, \\; 1, \\; 10 \\pmod{11}.\n$$\n\n结合模 $3$ 没有限制的条件，模 $33$ 的解恰好是那些满足模 $11$ 同余于 $0,1,10$ 的 $M$。在 $1 < M < 32$ 的范围内列出这些解：\n- $M \\equiv 0 \\pmod{11}$ 给出 $M \\in \\{11,22\\}$,\n- $M \\equiv 1 \\pmod{11}$ 给出 $M \\in \\{12,23\\}$ (不包括 $M=1$)，\n- $M \\equiv 10 \\pmod{11}$ 给出 $M \\in \\{10,21\\}$ (不包括 $M=32$) 。\n\n因此，该集合为 $\\{10,11,12,21,22,23\\}$，这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "1349536"}, {"introduction": "ElGamal 密码系统是公钥密码学的另一块基石，但它依赖的是离散对数问题的难度，而非因数分解。在这个动手练习中，您将扮演接收者的角色，解密一条被截获的消息。这将考验您应用模运算（包括求解模逆元）来恢复原始明文的能力。[@problem_id:1349529]", "problem": "在一个简化的ElGamal公钥密码系统中，公共参数为一个素数模 $p=29$ 和模29整数乘法群（记为 $\\mathbb{Z}_{29}^*$）的一个生成元 $g=2$。\n\nAlice希望向Bob发送一条秘密消息。Bob选择了一个私钥，并公布了他对应的公钥，即 $h=3$。\n\nAlice加密她的明文消息 $m$，并发送得到的密文，该密文是一个有序整数对 $(c_1, c_2)$。一个窃听者截获了这次通信，发现密文为 $(c_1, c_2) = (16, 27)$。\n\n假设明文消息 $m$ 是一个满足 $1 \\le m < 29$ 的整数，请确定 $m$ 的值。", "solution": "在ElGamal系统中，对于公共参数 $p$ 和 $g$，Bob的公钥为 $h \\equiv g^{x} \\pmod{p}$，其中 $x$ 是私钥。对明文 $m$ 的加密使用一个随机数 $k$ 来构成\n$$\nc_{1} \\equiv g^{k} \\pmod{p}, \\qquad c_{2} \\equiv m \\cdot h^{k} \\pmod{p}.\n$$\n给定 $p=29$, $g=2$, $h=3$ 以及密文 $(c_{1},c_{2})=(16,27)$，首先根据 $c_{1}$ 确定 $k$：\n$$\nc_{1} \\equiv g^{k} \\pmod{29} \\;\\Longrightarrow\\; 16 \\equiv 2^{k} \\pmod{29}.\n$$\n计算 $2$ 在模 $29$ 下的低次幂：\n$$\n2^{1}=2,\\; 2^{2}=4,\\; 2^{3}=8,\\; 2^{4}=16 \\pmod{29},\n$$\n所以 $k=4$。然后\n$$\nc_{2} \\equiv m \\cdot h^{k} \\pmod{29} \\;\\Longrightarrow\\; m \\equiv c_{2} \\cdot \\left(h^{k}\\right)^{-1} \\pmod{29}.\n$$\n计算 $h^{k} \\equiv 3^{4} \\pmod{29}$。利用 $3^{2}=9$ 和 $3^{4}=(3^{2})^{2}=9^{2}=81$，\n$$\n3^{4} \\equiv 81 \\equiv 81 - 58 = 23 \\pmod{29}.\n$$\n因此\n$$\nm \\equiv 27 \\cdot 23^{-1} \\pmod{29}.\n$$\n通过扩展欧几里得算法求 $23^{-1} \\pmod{29}$：\n$$\n29 = 23 \\cdot 1 + 6,\\quad 23 = 6 \\cdot 3 + 5,\\quad 6 = 5 \\cdot 1 + 1,\\quad 5 = 1 \\cdot 5 + 0.\n$$\n回代以将 $1$ 表示为 $29$ 和 $23$ 的线性组合：\n$$\n1 = 6 - 5,\\quad 5 = 23 - 6 \\cdot 3 \\;\\Rightarrow\\; 1 = 6 - (23 - 6 \\cdot 3) = 4 \\cdot 6 - 23,\n$$\n并且利用 $6 = 29 - 23$，\n$$\n1 = 4(29 - 23) - 23 = 4 \\cdot 29 - 5 \\cdot 23.\n$$\n因此 $-5 \\cdot 23 \\equiv 1 \\pmod{29}$，所以 $23^{-1} \\equiv 24 \\pmod{29}$。于是，\n$$\nm \\equiv 27 \\cdot 24 \\pmod{29}.\n$$\n计算 $27 \\cdot 24 = 648$，并注意到 $29 \\cdot 22 = 638$，所以\n$$\n648 \\equiv 648 - 638 = 10 \\pmod{29}.\n$$\n因此 $m=10$，满足所要求的 $1 \\le m < 29$。", "answer": "$$\\boxed{10}$$", "id": "1349529"}]}