{"hands_on_practices": [{"introduction": "椭圆曲线上的点在加法运算下构成一个有限阿贝尔群，理解其结构是掌握椭圆曲线密码学的第一步。一个关键概念是点的“阶”，即一个点自身重复相加多少次后会回到无穷远点 $\\mathcal{O}$。通过这个练习 [@problem_id:1366834]，你将亲手计算一个点的阶，从而掌握点加倍和点相加的基本运算，并直观地感受椭圆曲线群的循环特性。", "problem": "在关于有限域上椭圆曲线的研究中，一个基本概念是点的“阶”。点 $P$ 的阶是使得 $P$ 与自身相加 $n$ 次的和等于无穷远点（记作 $\\mathcal{O}$）的最小正整数 $n$。这个和写作 $nP = \\mathcal{O}$。\n\n对于形如 $y^2 \\equiv x^3 + ax + b \\pmod{p}$（其中 $p > 3$ 为素数）的椭圆曲线，其点加法规则如下。设 $P_1 = (x_1, y_1)$ 和 $P_2 = (x_2, y_2)$ 是曲线上的两个点。无穷远点 $\\mathcal{O}$ 作为单位元。\n\n1.  **单位元：** 对于任意点 $P$，有 $P + \\mathcal{O} = P$。\n2.  **负元：** 点 $P=(x,y)$ 的负元是 $-P=(x, -y \\pmod p)$。如果点 $P_1$ 是 $P_2$ 的负元，则它们的和为 $P_1 + P_2 = \\mathcal{O}$。这在 $x_1=x_2$ 且 $y_1 = -y_2 \\pmod p$ 时发生。\n3.  **点的加法 ($P_1 \\neq P_2$)：** 和 $P_3 = P_1 + P_2 = (x_3, y_3)$ 按如下方式计算：\n    - $\\lambda = (y_2 - y_1) (x_2 - x_1)^{-1} \\pmod{p}$\n    - $x_3 = (\\lambda^2 - x_1 - x_2) \\pmod{p}$\n    - $y_3 = (\\lambda(x_1 - x_3) - y_1) \\pmod{p}$\n    如果 $x_1=x_2$，此规则不适用。在该情况下，请参见规则2。\n4.  **点的倍加 ($P_1 = P_2$)：** 如果 $y_1 \\neq 0$，和 $P_3 = 2P_1 = (x_3, y_3)$ 按如下方式计算：\n    - $\\lambda = (3x_1^2 + a) (2y_1)^{-1} \\pmod{p}$\n    - $x_3 = (\\lambda^2 - 2x_1) \\pmod{p}$\n    - $y_3 = (\\lambda(x_1 - x_3) - y_1) \\pmod{p}$\n    如果 $y_1 = 0$，则 $2P_1 = \\mathcal{O}$。\n\n考虑由方程 $y^2 \\equiv x^3 + 4 \\pmod 5$ 定义的椭圆曲线。设 $G$ 是此曲线上的点 $(0, 2)$。\n\n确定点 $G$ 的阶。你的最终答案应该是一个整数。", "solution": "我们在素数 $p=5$ 的模有限域上，对曲线 $y^{2} \\equiv x^{3} + 4 \\pmod{5}$（其中 $a=0$）进行运算。首先，验证点 $G=(0,2)$ 在曲线上：\n$$\ny^{2} \\equiv 2^{2} \\equiv 4 \\pmod{5}, \\quad x^{3} + 4 \\equiv 0^{3} + 4 \\equiv 4 \\pmod{5},\n$$\n所以 $4 \\equiv 4 \\pmod{5}$，点 $G$ 在曲线上。\n\n使用点的倍加规则计算 $2G$（因为 $y_{1}=2 \\not\\equiv 0 \\pmod{5}$）。设 $P_{1}=G=(x_{1},y_{1})=(0,2)$。则\n$$\n\\lambda \\equiv (3x_{1}^{2}+a)(2y_{1})^{-1} \\equiv (3\\cdot 0^{2}+0)\\,(2\\cdot 2)^{-1} \\equiv 0 \\cdot 4^{-1} \\pmod{5}.\n$$\n我们发现 $(4)^{-1} \\equiv 4 \\pmod{5}$，因为 $4\\cdot 4 \\equiv 16 \\equiv 1 \\pmod{5}$。因此\n$$\n\\lambda \\equiv 0 \\cdot 4 \\equiv 0 \\pmod{5}.\n$$\n现在计算坐标：\n$$\nx_{3} \\equiv \\lambda^{2} - 2x_{1} \\equiv 0^{2} - 2\\cdot 0 \\equiv 0 \\pmod{5},\n$$\n$$\ny_{3} \\equiv \\lambda(x_{1} - x_{3}) - y_{1} \\equiv 0\\cdot (0 - 0) - 2 \\equiv -2 \\equiv 3 \\pmod{5}.\n$$\n因此，\n$$\n2G = (0,3).\n$$\n\n使用负元规则来计算 $3G = 2G + G$。点 $G=(0,2)$ 的负元是 $-G=(0,-2) \\equiv (0,3) \\pmod{5}$。由于 $2G=(0,3)=-G$，并且它们的 $x$ 坐标相同，$y$ 坐标在模5下互为相反数，根据加法规则可得\n$$\n3G = 2G + G = (-G) + G = \\mathcal{O}.\n$$\n此外，$2G \\neq \\mathcal{O}$，所以满足 $nG=\\mathcal{O}$ 的最小正整数 $n$ 是 $n=3$。\n\n因此，$G$ 的阶为 $3$。", "answer": "$$\\boxed{3}$$", "id": "1366834"}, {"introduction": "在掌握了点加法和点阶的概念后，我们来实践椭圆曲线密码学中的核心操作：标量乘法。这个操作，记作 $kP$，是密码体制安全性的基础，因为它易于计算但难以逆转。这个练习 [@problem_id:1366844] 模拟了从私钥 $k$ 和基点 $P$ 生成公钥的过程，通过计算 $4P$，你将熟练运用点加法和点倍增法则来完成这一关键的密码学步骤。", "problem": "在椭圆曲线密码学中，公钥是通过对给定椭圆曲线上的一个基点 $P$ 进行标量乘法生成的。该运算记作 $kP$，是将点 $P$ 与自身相加 $k-1$ 次，其中 $k$ 是一个整数密钥。椭圆曲线上的点加法遵循特定的代数规则。\n\n考虑一个由方程 $y^2 \\equiv x^3 + ax + b \\pmod{p}$ 定义在有限域 $\\mathbb{F}_p$ 上的椭圆曲线，其中 $p$ 是一个素数。\n\n将两个不同的点 $P=(x_1, y_1)$ 和 $Q=(x_2, y_2)$ 相加得到点 $R=P+Q=(x_3, y_3)$ 的规则是：\n$$ \\lambda = (y_2 - y_1)(x_2-x_1)^{-1} \\pmod{p} $$\n$$ x_3 = \\lambda^2 - x_1 - x_2 \\pmod{p} $$\n$$ y_3 = \\lambda(x_1 - x_3) - y_1 \\pmod{p} $$\n此处，$(x_2-x_1)^{-1}$ 表示 $(x_2-x_1)$ 模 $p$ 的模乘法逆元。\n\n将一个点 $P=(x_1, y_1)$ 倍乘得到点 $R=2P=(x_3, y_3)$ 的规则是：\n$$ \\lambda = (3x_1^2 + a)(2y_1)^{-1} \\pmod{p} $$\n$$ x_3 = \\lambda^2 - 2x_1 \\pmod{p} $$\n$$ y_3 = \\lambda(x_1 - x_3) - y_1 \\pmod{p} $$\n此处，$(2y_1)^{-1}$ 表示 $(2y_1)$ 模 $p$ 的模乘法逆元。\n\n给定椭圆曲线 $y^2 \\equiv x^3 + x + 1 \\pmod{5}$ 和该曲线上的一个基点 $P = (0, 1)$。一个用户选择了密钥 $k=4$。\n\n计算结果点 $Q = 4P$ 的坐标。将你的答案表示为行矩阵 $\\begin{pmatrix} x & y \\end{pmatrix}$ 的形式，其中 $x$ 和 $y$ 是结果点的坐标，其值在集合 $\\{0, 1, 2, 3, 4\\}$ 中。", "solution": "我们在有限域 $\\mathbb{F}_{5}$ 上，对曲线 $y^{2} \\equiv x^{3} + x + 1 \\pmod{5}$（其中 $a=1$）进行运算。基点是 $P=(0,1)$，我们要求解 $Q=4P$。\n\n首先，验证点 $P$ 在曲线上：\n$$\ny^{2} \\equiv 1^{2} \\equiv 1,\\quad x^{3}+x+1 \\equiv 0^{3}+0+1 \\equiv 1 \\pmod{5}.\n$$\n因此 $P$ 在曲线上。\n\n使用倍乘规则计算 $2P$，其中 $x_{1}=0$，$y_{1}=1$：\n$$\n\\lambda = (3x_{1}^{2}+a)(2y_{1})^{-1} \\equiv (0+1)\\cdot(2)^{-1} \\equiv 1\\cdot 3 \\equiv 3 \\pmod{5},\n$$\n因为 $2^{-1} \\equiv 3 \\pmod{5}$。\n然后\n$$\nx_{3} \\equiv \\lambda^{2} - 2x_{1} \\equiv 3^{2} - 0 \\equiv 9 \\equiv 4 \\pmod{5},\n$$\n$$\ny_{3} \\equiv \\lambda(x_{1}-x_{3}) - y_{1} \\equiv 3(0-4) - 1 \\equiv 3\\cdot 1 - 1 \\equiv 2 \\pmod{5},\n$$\n由于 $0-4 \\equiv 1 \\pmod{5}$。因此 $2P=(4,2)$。\n\n使用加法规则计算 $3P = 2P + P$，其中 $(x_{1},y_{1})=(4,2)$ 和 $(x_{2},y_{2})=(0,1)$：\n$$\n\\lambda = (y_{2}-y_{1})(x_{2}-x_{1})^{-1} \\equiv (1-2)(0-4)^{-1} \\equiv (-1)(-4)^{-1} \\equiv 4\\cdot 1 \\equiv 4 \\pmod{5},\n$$\n因为 $-1 \\equiv 4$ 且 $-4 \\equiv 1$，所以 $(0-4)^{-1} \\equiv 1^{-1} \\equiv 1$。然后\n$$\nx_{3} \\equiv \\lambda^{2} - x_{1} - x_{2} \\equiv 4^{2} - 4 - 0 \\equiv 16 - 4 \\equiv 12 \\equiv 2 \\pmod{5},\n$$\n$$\ny_{3} \\equiv \\lambda(x_{1}-x_{3}) - y_{1} \\equiv 4(4-2) - 2 \\equiv 4\\cdot 2 - 2 \\equiv 8 - 2 \\equiv 6 \\equiv 1 \\pmod{5}.\n$$\n因此 $3P=(2,1)$。\n\n计算 $4P = 3P + P$，其中 $(x_{1},y_{1})=(2,1)$ 和 $(x_{2},y_{2})=(0,1)$：\n$$\n\\lambda = (y_{2}-y_{1})(x_{2}-x_{1})^{-1} \\equiv (1-1)(0-2)^{-1} \\equiv 0\\cdot(-2)^{-1} \\equiv 0 \\pmod{5},\n$$\n因为 $(0-2) \\equiv -2 \\equiv 3$ 且 $3^{-1} \\equiv 2$，但 $0\\cdot 2 \\equiv 0$。然后\n$$\nx_{3} \\equiv \\lambda^{2} - x_{1} - x_{2} \\equiv 0 - 2 - 0 \\equiv -2 \\equiv 3 \\pmod{5},\n$$\n$$\ny_{3} \\equiv \\lambda(x_{1}-x_{3}) - y_{1} \\equiv 0\\cdot(2-3) - 1 \\equiv -1 \\equiv 4 \\pmod{5}.\n$$\n因此 $4P=(3,4)$。\n\n作为检验，$(3,4)$ 满足模 $5$ 的曲线方程：\n$$\ny^{2} \\equiv 4^{2} \\equiv 16 \\equiv 1,\\quad x^{3}+x+1 \\equiv 27+3+1 \\equiv 31 \\equiv 1 \\pmod{5}.\n$$\n因此结果是正确的。", "answer": "$$\\boxed{\\begin{pmatrix} 3 & 4 \\end{pmatrix}}$$", "id": "1366844"}, {"introduction": "从单个点的运算，我们进阶到分析整个群的结构。一个重要的概念是 $n$-挠点子群，即所有满足 $nP = \\mathcal{O}$ 的点的集合，它揭示了群的内部结构。在这个综合练习 [@problem_id:1366842] 中，你将需要找出一条曲线上所有的点，并确定其 3-挠点子群。这项挑战性的任务将全面检验你对点枚举和点运算的掌握程度，并加深你对椭圆曲线群结构的理解。", "problem": "考虑一个定义在模7整数的有限域 $\\mathbb{F}_7$ 上的椭圆曲线 $E$，其方程为：\n$$y^2 \\equiv x^3 + 2 \\pmod{7}$$\n此曲线上所有的点 $(x,y)$，以及一个称为“无穷远点”并记为 $O$ 的特殊点，在一个特定的点加法运算下构成一个阿贝尔群。点 $O$ 是该群的单位元。\n\n群加法规则如下，所有算术运算均在 $\\mathbb{F}_7$ 中进行：\n1.  对任意点 $P$，$P + O = P$。\n2.  对任意非单位元点 $P=(x,y)$，其逆元为 $-P=(x, -y)$，并且 $P + (-P) = O$。\n3.  要将两个 $x$ 坐标不相等的不同点 $P_1 = (x_1, y_1)$ 和 $P_2 = (x_2, y_2)$ 相加，其和 $P_3 = (x_3, y_3)$ 由以下公式给出：\n    $$\\lambda = (y_2 - y_1)(x_2 - x_1)^{-1}$$\n    $$x_3 = \\lambda^2 - x_1 - x_2$$\n    $$y_3 = \\lambda(x_1 - x_3) - y_1$$\n4.  要将一个 $y_1 \\neq 0$ 的点 $P_1 = (x_1, y_1)$ 倍点（即计算 $2P_1 = P_1 + P_1$），其和 $P_3 = (x_3, y_3)$ 由以下公式给出：\n    $$\\lambda = (3x_1^2)(2y_1)^{-1}$$\n    $$x_3 = \\lambda^2 - 2x_1$$\n    $$y_3 = \\lambda(x_1 - x_3) - y_1$$\n\n$E$ 的3-挠子群，记作 $E[3]$，是曲线上所有满足 $3P = P+P+P = O$ 的点 $P$（包括 $O$）的集合。\n\n下列哪个集合代表了给定曲线的完整3-挠子群 $E[3]$？\n\nA. $\\{O\\}$\n\nB. $\\{O, (0, 3), (0, 4)\\}$\n\nC. $\\{O, (0, 3), (0, 4), (3, 1), (3, 6), (5, 1), (5, 6), (6, 1), (6, 6)\\}$\n\nD. $\\{(0, 3), (0, 4), (3, 1), (3, 6), (5, 1), (5, 6), (6, 1), (6, 6)\\}$\n\nE. $\\{O, (3, 1), (3, 6), (5, 1), (5, 6)\\}$\n\nF. 该集合为空，因为没有点满足条件。", "solution": "我们在 $\\mathbb{F}_{7}$ 上研究曲线 $E: y^{2} \\equiv x^{3} + 2 \\pmod{7}$。首先，我们枚举 $E(\\mathbb{F}_{7})$ 的所有点。\n\n计算模7的立方：对于 $x \\in \\{0,1,2,3,4,5,6\\}$，\n$0^{3} \\equiv 0$, $1^{3} \\equiv 1$, $2^{3} \\equiv 1$, $3^{3} \\equiv 6$, $4^{3} \\equiv 1$, $5^{3} \\equiv 6$, $6^{3} \\equiv 6$。\n因此 $x^{3} \\in \\{0,1,6\\}$。于是 $x^{3} + 2 \\in \\{2,3,1\\}$，具体来说：\n- 当 $x=0$ 时：$x^{3} + 2 \\equiv 2$，\n- 当 $x=1,2,4$ 时：$x^{3} + 2 \\equiv 3$，\n- 当 $x=3,5,6$ 时：$x^{3} + 2 \\equiv 1$。\n\n模7的二次剩余是 $0,1,2,4$，其平方根为：\n- $1$ 的根为 $y \\equiv 1,6$，\n- $2$ 的根为 $y \\equiv 3,4$，\n- $4$ 的根为 $y \\equiv 2,5$，\n而 $3,5,6$ 是二次非剩余。\n\n因此，仿射点为：\n- 对于 $x=0$：$y^{2} \\equiv 2 \\Rightarrow y \\equiv 3,4$，得到点 $(0,3),(0,4)$。\n- 对于 $x=1,2,4$：$y^{2} \\equiv 3$ 无解。\n- 对于 $x=3,5,6$：$y^{2} \\equiv 1 \\Rightarrow y \\equiv 1,6$，得到点 $(3,1),(3,6),(5,1),(5,6),(6,1),(6,6)$。\n加上无穷远点 $O$，总共有9个点：$|E(\\mathbb{F}_{7})|=9$。\n\n现在确定 $E[3] = \\{P \\in E(\\mathbb{F}_{7}) : 3P = O\\}$。由于 $|E(\\mathbb{F}_{7})| = 9 = 3^{2}$，每个点的阶都是3的幂。因此 $E[3]$ 要么是整个群（所有9个点），要么是唯一的3阶子群。我们通过使用给定的加法公式计算一些代表点的 $3P$ 来确定是哪种情况。\n\n取点 $P=(0,3)$。由于 $y_{1} \\neq 0$，适用倍点公式：\n$$\\lambda = (3x_{1}^{2})(2y_{1})^{-1} = (3\\cdot 0^{2})(2\\cdot 3)^{-1} \\equiv 0 \\cdot 6^{-1} \\equiv 0 \\pmod{7}.$$\n然后\n$$x_{3} = \\lambda^{2} - 2x_{1} \\equiv 0 - 0 \\equiv 0,\\quad y_{3} = \\lambda(x_{1} - x_{3}) - y_{1} \\equiv 0 - 3 \\equiv 4,$$\n所以 $2P = (0,4) = -P$。因此 $3P = 2P + P = -P + P = O$。\n\n接着取点 $Q=(3,1)$。计算\n$$\\lambda = (3x_{1}^{2})(2y_{1})^{-1} = (3\\cdot 3^{2})(2\\cdot 1)^{-1} \\equiv (3\\cdot 2)\\cdot 2^{-1} \\equiv 6 \\cdot 4 \\equiv 24 \\equiv 3 \\pmod{7}.$$\n然后\n$$x_{3} \\equiv \\lambda^{2} - 2x_{1} \\equiv 3^{2} - 6 \\equiv 2 - 6 \\equiv 3,\\quad y_{3} \\equiv \\lambda(x_{1} - x_{3}) - y_{1} \\equiv 3\\cdot 0 - 1 \\equiv 6,$$\n所以 $2Q = (3,6) = -Q$，因此 $3Q=O$。\n\n类似地，对于 $R=(5,1)$，\n$$\\lambda \\equiv (3\\cdot 5^{2})\\cdot (2\\cdot 1)^{-1} \\equiv (3\\cdot 4)\\cdot 4 \\equiv 12\\cdot 4 \\equiv 5\\cdot 4 \\equiv 6,$$\n$$x_{3} \\equiv 6^{2} - 10 \\equiv 1 - 3 \\equiv 5,\\quad y_{3} \\equiv 6\\cdot 0 - 1 \\equiv 6,$$\n所以 $2R=(5,6)=-R$，并且 $3R=O$。\n\n对于 $S=(6,1)$，\n$$\\lambda \\equiv (3\\cdot 6^{2})\\cdot (2\\cdot 1)^{-1} \\equiv (3\\cdot 1)\\cdot 4 \\equiv 3\\cdot 4 \\equiv 5,$$\n$$x_{3} \\equiv 5^{2} - 12 \\equiv 4 - 5 \\equiv 6,\\quad y_{3} \\equiv 5\\cdot 0 - 1 \\equiv 6,$$\n所以 $2S=(6,6)=-S$，并且 $3S=O$。\n\n对于这些点的负元 $-P$，根据群律有 $2(-P) = -(2P)$，所以如果 $2P=-P$，那么 $2(-P)=P$，因此 $3(-P)=O$ 也成立。所以，对于找到的每个仿射点，都有 $3P=O$。\n显然，$3O=O$。\n\n因此，$E(\\mathbb{F}_{7})$ 中的每个点都是3-挠点，所以 $E[3]=E(\\mathbb{F}_{7})$ 由所有9个点组成：$O$, $(0,3)$, $(0,4)$, $(3,1)$, $(3,6)$, $(5,1)$, $(5,6)$, $(6,1)$, $(6,6)$。这与选项C相符。", "answer": "$$\\boxed{C}$$", "id": "1366842"}]}