{"hands_on_practices": [{"introduction": "RSA 加密的核心在于模幂运算。通过这个基础练习，你将亲手执行一次 RSA 加密计算，将明文消息转换为密文。这个过程不仅能帮助你熟悉 $C \\equiv M^e \\pmod{n}$ 这一基本公式，还能揭示一个重要特性：重复加密通常不会恢复原始消息 [@problem_id:1397826]。这个练习是理解 RSA 运作机制的第一步。", "problem": "在 Rivest-Shamir-Adleman (RSA) 公钥密码系统中，一条消息使用由一个模数 $n$ 和一个公钥指数 $e$ 组成的公钥进行加密。用于将消息 $M$ 生成密文 $C$ 的加密函数由模幂运算 $C \\equiv M^{e} \\pmod{n}$ 给出。\n\n考虑一个公钥为 $(n=55, e=3)$ 的 RSA 系统。一条明文消息 $M=5$ 首先被加密以生成密文 $C$。然后，这个密文 $C$ 被当作一条新消息，并使用相同的公钥 $(n=55, e=3)$ *再次*加密，以产生最终值 $C'$。\n\n$C'$ 的数值是多少？\n\nA. 5\n\nB. 15\n\nC. 20\n\nD. 25\n\nE. 50", "solution": "RSA 加密使用模幂运算。对于公钥 $(n=55, e=3)$ 和消息 $M=5$，第一个密文 $C$ 是\n$$\nC \\equiv M^{e} \\pmod{n} \\equiv 5^{3} \\pmod{55}.\n$$\n计算 $5^{3}=125$ 并对 $55$ 取模：\n$$\n125 = 55 \\cdot 2 + 15 \\;\\Rightarrow\\; 125 \\equiv 15 \\pmod{55},\n$$\n因此 $C \\equiv 15 \\pmod{55}$。\n\n再次加密，新的密文 $C'$ 是\n$$\nC' \\equiv C^{e} \\pmod{n} \\equiv 15^{3} \\pmod{55}.\n$$\n首先计算 $15^{2}$ 模 $55$ 的值：\n$$\n15^{2} = 225 = 55 \\cdot 4 + 5 \\;\\Rightarrow\\; 15^{2} \\equiv 5 \\pmod{55}.\n$$\n然后\n$$\n15^{3} \\equiv (15^{2})\\cdot 15 \\equiv 5 \\cdot 15 = 75 \\pmod{55},\n$$\n并且\n$$\n75 = 55 \\cdot 1 + 20 \\;\\Rightarrow\\; 75 \\equiv 20 \\pmod{55}.\n$$\n因此 $C' \\equiv 20 \\pmod{55}$，这对应于选项 C。", "answer": "$$\\boxed{C}$$", "id": "1397826"}, {"introduction": "RSA 算法的安全性基石是质因数分解的计算难度。在这个练习中，你将扮演一个密码分析者的角色，通过分解一个较小的模数 $n$ 来破解一个 RSA 系统 [@problem_id:1397836]。这个过程会引导你走过从公钥到私钥的完整逆向工程：分解 $n$ 得到 $p$ 和 $q$，计算欧拉函数 $\\phi(n)$，并最终求解模逆元以找到私钥 $d$。完成这个练习将让你深刻理解 RSA 密钥对之间密不可分的数学联系。", "problem": "在 RSA (Rivest–Shamir–Adleman) 公钥密码系统中，公钥由一对整数 $(n, e)$ 组成，对应的私钥是一个整数 $d$。整数 $n$ 是两个不同的质数 $p$ 和 $q$ 的乘积，即 $n = pq$。整数 $e$ 是公钥指数，$d$ 是私钥指数。它们通过同余关系 $ed \\equiv 1 \\pmod{\\phi(n)}$ 相互关联，其中 $\\phi(n)$ 是欧拉函数，对于 $n=pq$ 的情况，其计算公式为 $\\phi(n) = (p-1)(q-1)$。\n\n攻击者 Eve 截获了一个用户的公钥，为 $(n, e) = (91, 5)$。为了破解该系统，Eve 必须确定对应的私钥 $d$。\n\n假设你是 Eve，请计算私钥 $d$ 的值。", "solution": "我们要求解满足 RSA 关系 $ed \\equiv 1 \\pmod{\\phi(n)}$ 的私钥指数 $d$，给定的公钥为 $(n,e)=(91,5)$。对于 $n=pq$（其中 $p$ 和 $q$ 是不同的质数），欧拉函数为 $\\phi(n)=(p-1)(q-1)$。\n\n首先，对 $n$ 进行因式分解：\n$$\n91=7\\cdot 13,\n$$\n所以 $p=7$ 且 $q=13$。那么\n$$\n\\phi(n)=(p-1)(q-1)=(7-1)(13-1)=6\\cdot 12=72.\n$$\n我们必须在以下同余式中求解 $d$：\n$$\n5d \\equiv 1 \\pmod{72},\n$$\n即求出 $5$ 模 $72$ 的乘法逆元。使用扩展欧几里得算法求整数 $x$ 和 $y$，使得\n$$\n5x+72y=1.\n$$\n计算：\n$$\n72=14\\cdot 5+2,\\quad 5=2\\cdot 2+1.\n$$\n将 $2=72-14\\cdot 5$ 回代入 $1=5-2\\cdot 2$：\n$$\n1=5-2(72-14\\cdot 5)=5-2\\cdot 72+28\\cdot 5=29\\cdot 5-2\\cdot 72.\n$$\n因此 $x=29$ 得到 $5\\cdot 29\\equiv 1 \\pmod{72}$，所以 $5$ 模 $72$ 的乘法逆元是 $29$。因此，\n$$\nd \\equiv 29 \\pmod{72}.\n$$\n选择最小正代表元可得 $d=29$。", "answer": "$$\\boxed{29}$$", "id": "1397836"}, {"introduction": "在计算出私钥 $d$ 之后，一个自然的问题是：这个私钥是唯一的吗？本练习将引导你探索私钥的本质 [@problem_id:1397848]。通过处理一个给定的公钥和 $\\phi(n)$ 值，你将发现私钥 $d$ 并非一个孤立的数值，而是满足同余方程 $ed \\equiv 1 \\pmod{\\phi(n)}$ 的一组成员。这揭示了私钥的等价类特性，加深了你对 RSA 数学结构的理解。", "problem": "在一个基于 Rivest-Shamir-Adleman (RSA) 算法的公钥密码体制中，选择模数 $n$ 使得欧拉函数的值为 $\\phi(n) = 40$。公钥指数选择为 $e=7$。一台计算机正确地计算出一个可能的对应私钥指数为 $d_1 = 23$。然而，任何与该私钥模 $\\phi(n)$ 同余的整数也都是一个有效的私钥。求最小的正整数 $d_2$，其中 $d_2 \\neq d_1$，它也可以作为该体制的一个有效私钥。", "solution": "在RSA中，私钥指数 $d$ 满足同余式\n$$\ne d \\equiv 1 \\pmod{\\phi(n)}.\n$$\n这里 $\\phi(n)=40$ 且 $e=7$。给定的 $d_{1}=23$ 是一个解，因为\n$$\n7 \\cdot 23 = 161 \\equiv 1 \\pmod{40},\n$$\n因为 $161 - 4 \\cdot 40 = 1$。\n\n对于一个线性同余方程，如果 $d_{1}$ 是一个解，那么所有的解都由下式给出\n$$\nd \\equiv d_{1} \\pmod{\\phi(n)} \\quad \\Longleftrightarrow \\quad d = d_{1} + k\\,\\phi(n), \\quad k \\in \\mathbb{Z}.\n$$\n因此，\n$$\nd = 23 + 40k.\n$$\n为了找到不等于 $d_1$ 的最小正整数 $d_2$，我们选择能得到一个不同的正值的最小整数 $k$，即 $k=1$：\n$$\nd_{2} = 23 + 40 = 63.\n$$\n验证：\n$$\n7 \\cdot 63 = 441 \\equiv 1 \\pmod{40},\n$$\n因为 $441 - 11 \\cdot 40 = 1$。因此，$d_{2}=63$ 是不同于 $23$ 且也是有效私钥的最小正整数。", "answer": "$$\\boxed{63}$$", "id": "1397848"}]}