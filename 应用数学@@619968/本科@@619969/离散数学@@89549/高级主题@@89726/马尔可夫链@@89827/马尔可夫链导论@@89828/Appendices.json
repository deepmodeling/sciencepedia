{"hands_on_practices": [{"introduction": "马尔可夫链不仅能描述随机过程，也能为确定性系统提供清晰的数学模型。这个练习 [@problem_id:1378024] 探讨了一个在两个状态间严格交替的简单CPU模型。通过计算其平稳分布，你将直观地理解平稳分布的本质含义：即使系统永不“静止”，它也代表了长期来看系统在每个状态上花费的时间比例。", "problem": "一个专用的中央处理器（CPU）的简化模型被设计为在称为时钟周期的离散时间步中运行。该 CPU 只有两种运行状态：状态 0（指令提取）和状态 1（指令执行）。状态转换是确定性的，并遵循一个严格的序列。\n- 如果 CPU 在一个给定的时钟周期处于状态 0，它将在下一个时钟周期以概率 1 转换到状态 1。\n- 如果 CPU 在一个给定的时钟周期处于状态 1，它将在下一个时钟周期以概率 1 转换到状态 0。\n\n这个过程可以被建模为一个离散时间马尔可夫链，其状态空间为 $S = \\{0, 1\\}$。\n\n设 $\\pi = (\\pi_0, \\pi_1)$ 为该马尔可夫链的平稳分布，其中 $\\pi_0$ 是处于状态 0 的长期概率，而 $\\pi_1$ 是处于状态 1 的长期概率。请确定 $\\pi_0$ 和 $\\pi_1$ 的值。", "solution": "将 CPU 建模为一个状态空间为 $S=\\{0,1\\}$ 的双状态离散时间马尔可夫链。转移概率为：\n$$\nP_{0,1}=1,\\quad P_{0,0}=0,\\quad P_{1,0}=1,\\quad P_{1,1}=0.\n$$\n因此，当状态按 $(0,1)$ 排序时，转移矩阵为\n$$\nP=\\begin{pmatrix}\n0 & 1 \\\\\n1 & 0\n\\end{pmatrix}.\n$$\n一个平稳分布 $\\pi=(\\pi_{0},\\pi_{1})$ 满足平稳性和归一化的定义方程：\n$$\n\\pi=\\pi P,\\qquad \\pi_{0}+\\pi_{1}=1,\\qquad \\pi_{0}\\geq 0,\\ \\pi_{1}\\geq 0.\n$$\n计算 $\\pi P$：\n$$\n\\pi P=(\\pi_{0},\\pi_{1})\\begin{pmatrix}\n0 & 1 \\\\\n1 & 0\n\\end{pmatrix}=(\\pi_{1},\\pi_{0}).\n$$\n平稳性条件 $\\pi=\\pi P$ 给出方程组\n$$\n\\pi_{0}=\\pi_{1},\\qquad \\pi_{1}=\\pi_{0},\n$$\n化简为 $\\pi_{0}=\\pi_{1}$。与 $\\pi_{0}+\\pi_{1}=1$ 结合可得\n$$\n\\pi_{0}=\\pi_{1}=\\frac{1}{2}.\n$$\n这些值是非负的，并满足所有必要条件，因此平稳分布是唯一的，由 $(\\frac{1}{2},\\frac{1}{2})$ 给出。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2} & \\frac{1}{2}\\end{pmatrix}}$$", "id": "1378024"}, {"introduction": "在许多现实应用中，我们常常能观察到系统的长期行为，但其内部的转换机制却是未知的。这个练习 [@problem_id:1378050] 模拟了这样一个场景：你将扮演一位数据科学家，利用已知的长期行为数据（即平稳分布）来反向推导描述员工工作状态转换的马尔可夫链的完整转移矩阵。这个过程让你能够熟练运用平稳分布的核心方程 $\\pi P = \\pi$ 来解决实际问题。", "problem": "一位数据科学家正在使用一个简单的双状态马尔可夫链来建模一名远程员工的日常工作习惯。这两个状态是“专注”（状态1）和“分心”（状态2）。该模型假设员工在任何给定小时的状态仅取决于其前一个小时的状态。\n\n在收集了大量数据后，该科学家观察到，从长远来看，该员工有三分之一的时间处于“专注”状态，三分之二的时间处于“分心”状态。这对应于一个平稳分布向量 $\\pi = \\begin{pmatrix} 1/3 & 2/3 \\end{pmatrix}$。\n\n此外，数据揭示了一个特定的转移概率：如果员工当前处于“分心”状态，那么他们在下一个小时将处于“专注”状态的概率是 $1/4$。\n\n设 $P$ 为此马尔可夫链的 $2 \\times 2$ 右随机转移矩阵，其中元素 $P_{ij}$ 表示从状态 $i$ 转移到状态 $j$ 的概率。确定完整的转移矩阵 $P$。将你的答案表示为一个包含分数元素的 $2 \\times 2$ 矩阵。", "solution": "设状态1为专注，状态2为分心。对于一个右随机转移矩阵 $P$，每行之和为 $1$，且 $P_{ij}$ 是从状态 $i$ 转移到状态 $j$ 的概率。给定的平稳分布 $\\pi = \\begin{pmatrix} \\frac{1}{3} & \\frac{2}{3} \\end{pmatrix}$ 满足行向量的平稳性条件：\n$$\n\\pi P = \\pi.\n$$\n\n我们已知 $P_{21} = \\frac{1}{4}$。根据行随机性，$P_{22} = 1 - P_{21} = \\frac{3}{4}$。设 $P_{11} = x$，则 $P_{12} = 1 - x$。因此\n$$\nP = \\begin{pmatrix}\nx & 1 - x \\\\\n\\frac{1}{4} & \\frac{3}{4}\n\\end{pmatrix}.\n$$\n\n应用平稳性条件：\n$$\n\\begin{pmatrix} \\frac{1}{3} & \\frac{2}{3} \\end{pmatrix}\n\\begin{pmatrix}\nx & 1 - x \\\\\n\\frac{1}{4} & \\frac{3}{4}\n\\end{pmatrix}\n=\n\\begin{pmatrix} \\frac{1}{3} & \\frac{2}{3} \\end{pmatrix}.\n$$\n令第一个分量相等，可得\n$$\n\\frac{1}{3} x + \\frac{2}{3} \\cdot \\frac{1}{4} = \\frac{1}{3}\n\\;\\;\\Longrightarrow\\;\\;\n\\frac{1}{3} x + \\frac{1}{6} = \\frac{1}{3}\n\\;\\;\\Longrightarrow\\;\\;\n\\frac{1}{3} x = \\frac{1}{6}\n\\;\\;\\Longrightarrow\\;\\;\nx = \\frac{1}{2}.\n$$\n因此 $P_{11} = \\frac{1}{2}$ 且 $P_{12} = \\frac{1}{2}$，得到\n$$\nP = \\begin{pmatrix}\n\\frac{1}{2} & \\frac{1}{2} \\\\\n\\frac{1}{4} & \\frac{3}{4}\n\\end{pmatrix}.\n$$\n直接检验表明 $\\begin{pmatrix} \\frac{1}{3} & \\frac{2}{3} \\end{pmatrix} P = \\begin{pmatrix} \\frac{1}{3} & \\frac{2}{3} \\end{pmatrix}$，符合要求。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} \\\\ \\frac{1}{4} & \\frac{3}{4} \\end{pmatrix}}$$", "id": "1378050"}, {"introduction": "马尔可夫链的强大之处在于它能处理复杂的、甚至是抽象的状态空间。这个洗牌问题 [@problem_id:1378035] 就是一个绝佳的例子，它将状态定义为一副牌的所有可能排列。直接构建并求解完整的转移矩阵将非常繁琐，但本练习旨在引导你发现系统背后隐藏的对称性，从而巧妙地推导出其平稳分布，深刻体会理论洞察力在解决复杂问题中的威力。", "problem": "一副由三张独特标记为1、2、3的牌组成的小牌组，按照一个特定的、重复的程序进行洗牌。牌组的一个状态由牌从上到下的排列来定义。例如，状态 (1, 2, 3) 表示牌1在最上面，牌2在中间，牌3在最下面。因此，状态空间由这三张牌所有可能的 $3! = 6$ 种排列组成。\n\n每一步的洗牌程序如下：取出当前在牌组顶部的牌，并将其重新插入到三个可能的位置（顶部、中间或底部）之一，每个位置被选中的概率相等，均为 $1/3$。\n\n这个洗牌过程可以被建模为排列空间上的一个离散时间马尔可夫链。当这个洗牌过程重复很长时间后，牌组将趋近于一个平稳分布，该分布描述了其处于任何给定状态的概率。\n\n确定牌组处于特定状态 (3, 2, 1) 的长期概率。请将你的答案表示为分数。", "solution": "设状态空间为 $\\{1,2,3\\}$ 的六种排列。从一个通用状态 $(a,b,c)$ 出发，“取出顶牌并均匀地重新插入到三个位置之一”的洗牌操作会产生恰好三种可能的下一状态，每种状态的概率为 $\\frac{1}{3}$：\n$$\n(a,b,c)\\xrightarrow[\\text{prob}=\\frac{1}{3}]{}(a,b,c),\\quad\n(a,b,c)\\xrightarrow[\\text{prob}=\\frac{1}{3}]{}(b,a,c),\\quad\n(a,b,c)\\xrightarrow[\\text{prob}=\\frac{1}{3}]{}(b,c,a).\n$$\n因此，转移矩阵 $P$ 定义如下：\n$$\nP\\big((a,b,c)\\to(a,b,c)\\big)=\\frac{1}{3},\\quad\nP\\big((a,b,c)\\to(b,a,c)\\big)=\\frac{1}{3},\\quad\nP\\big((a,b,c)\\to(b,c,a)\\big)=\\frac{1}{3},\n$$\n其他情况下为零。\n\n固定任意一个状态 $s=(x,y,z)$。满足 $P(t\\to s)>0$ 的前驱状态 $t$ 仅有：\n$$\nt_{1}=(x,y,z),\\quad t_{2}=(y,x,z),\\quad t_{3}=(z,x,y),\n$$\n因为：\n- 从 $t_{1}=(x,y,z)$ 出发，将 $x$ 重新插入到顶部（位置1），状态保持为 $(x,y,z)$。\n- 从 $t_{2}=(y,x,z)$ 出发，将 $y$ 重新插入到中间（位置2），得到状态 $(x,y,z)$。\n- 从 $t_{3}=(z,x,y)$ 出发，将 $z$ 重新插入到底部（位置3），得到状态 $(x,y,z)$。\n\n这些转移中的每一个都有 $\\frac{1}{3}$ 的概率，因此对于状态 $s$ 的列和为：\n$$\n\\sum_{t}P(t\\to s)=\\frac{1}{3}+\\frac{1}{3}+\\frac{1}{3}=1.\n$$\n因为这对每个状态 $s$ 都成立，所以转移矩阵 $P$ 是双随机的。\n\n考虑六个状态上的均匀分布 $\\pi$，即对所有状态 $s$，有 $\\pi(s)=\\frac{1}{6}$。那么对于任何状态 $s$：\n$$\n\\sum_{t}\\pi(t)P(t\\to s)=\\frac{1}{6}\\sum_{t}P(t\\to s)=\\frac{1}{6}\\cdot 1=\\frac{1}{6}=\\pi(s),\n$$\n所以 $\\pi$ 是一个平稳分布。该链是不可约的（从任何排列出发，通过一系列允许的插入操作可以到达任何其他排列）并且是非周期的（每个状态都有一个概率为 $\\frac{1}{3}$ 的自循环）。因此，根据标准的马尔可夫链理论，平稳分布是唯一的，并且该链从任何初始状态开始都会收敛到这个平稳分布。\n\n因此，从长远来看，每个状态的概率都是 $\\frac{1}{6}$。特别地，状态 $(3,2,1)$ 的概率是 $\\frac{1}{6}$。", "answer": "$$\\boxed{\\frac{1}{6}}$$", "id": "1378035"}]}