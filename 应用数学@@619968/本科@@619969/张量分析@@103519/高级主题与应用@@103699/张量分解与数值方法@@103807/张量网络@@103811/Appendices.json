{"hands_on_practices": [{"introduction": "张量网络不仅仅是一套代数规则，它更是一种强大的图形语言。本练习旨在帮助你熟练地在代数表达式和直观的张量网络图之间进行转换。掌握这种“翻译”技巧，是利用图形化方法思考并解决复杂多线性代数问题的第一步。[@problem_id:1543550]", "problem": "在张量网络的表述中，一个张量表示为一个节点，其指标表示为连接到该节点的线（或称“腿”）。张量的阶决定了其腿的数量。两个张量之间对一个共同指标的缩并，通过连接相应的腿来表示。未连接的腿代表了结果张量的自由指标。\n\n考虑一个三阶张量，记作 $A_{ijk}$。在图中，这个张量是一个有三条腿的节点，其中第一条腿对应指标 $i$，第二条腿对应指标 $j$，第三条腿对应指标 $k$。\n\n该张量 $A$ 的两个相同副本按照以下方程进行缩并，形成一个二阶张量 $M$：\n$$M_{ac} = \\sum_{b,d} A_{abd} A_{cbd}$$\n下列哪个描述准确地表示了此次缩并的张量网络图？\n\nA. 两个 $A$ 的节点。第一个节点的首条腿与第二个节点的首条腿相连。第一个节点的第二条腿与第二个节点的第二条腿相连。两个节点的第三条腿都保持开放。\n\nB. 两个 $A$ 的节点。第一个节点的第二条腿与第二个节点的第三条腿相连。第一个节点的第三条腿与第二个节点的第二条腿相连。两个节点的首条腿都保持开放。\n\nC. 两个 $A$ 的节点。只有第一个节点的第二条腿与第二个节点的第二条腿相连。两个节点的首条腿和第三条腿都保持开放，导致有四个自由指标。\n\nD. 两个 $A$ 的节点。第一个节点的第二条腿与第二个节点的第二条腿相连。第一个节点的第三条腿与第二个节点的第三条腿相连。两个节点的首条腿都保持开放。", "solution": "一个三阶张量 $A_{ijk}$ 表示为一个有三条腿的节点，分别对应指标 $i$（首条腿）、$j$（第二条腿）和 $k$（第三条腿）。对于 $A$ 的两个副本，缩并\n$$M_{ac} = \\sum_{b,d} A_{abd} A_{cbd}$$\n指定了哪些指标被求和，哪些指标保持自由。\n\n确定每个副本的腿与指标的对应关系：\n- 对于第一个张量 $A_{abd}$：首条腿 $\\to a$，第二条腿 $\\to b$，第三条腿 $\\to d$。\n- 对于第二个张量 $A_{cbd}$：首条腿 $\\to c$，第二条腿 $\\to b$，第三条腿 $\\to d$。\n\n对 $b$ 和 $d$ 的求和意味着这两个指标在两个张量之间被缩并。在图上，这对应于连接两个节点上带有相同缩并指标的腿：\n- 连接第一个节点的第二条腿（指标 $b$）和第二个节点的第二条腿（指标 $b$）。\n- 连接第一个节点的第三条腿（指标 $d$）和第二个节点的第三条腿（指标 $d$）。\n\n剩下的自由指标是 $a$ 和 $c$，它们分别对应第一个节点的首条腿和第二个节点的首条腿。因此，结果张量 $M_{ac}$ 是二阶的，它的两条开放的腿恰好就是那两条首腿。\n\n这个描述与选项D相符。选项A会错误地缩并首条腿（缩并 $a$），选项B将 $b$ 与 $d$ 交叉连接，$d$ 与 $b$ 交叉连接，而选项C会留下四条自由的腿，产生一个四阶张量，这与 $M_{ac}$ 是二阶张量相矛盾。", "answer": "$$\\boxed{D}$$", "id": "1543550"}, {"introduction": "在学会如何绘制张量网络图之后，下一步是理解其计算规则。这个练习将通过一个具体的例子，揭示张量缩并的一个关键特性：对于非对称张量，与不同向量的缩并顺序至关重要。通过亲手计算张量 $T_{ijk}$ 与向量 $u$ 和 $v$ 的不同缩并方式，你将体会到交换索引的缩并顺序会如何根本性地改变最终结果，这是处理张量运算时必须牢记的核心要点。[@problem_id:1543530]", "problem": "考虑一个3阶张量 $T$，其分量为 $T_{ijk}$，以及两个向量 $u$ 和 $v$，其分量分别为 $u_i$ 和 $v_j$，它们都定义在一个二维空间中。指标 $i, j, k$ 可以在 $\\{1, 2\\}$ 中取值。张量 $T$ 的分量如下所示：\n$T_{111}=1, T_{112}=2$\n$T_{121}=0, T_{122}=-1$\n$T_{211}=3, T_{212}=-2$\n$T_{221}=1, T_{222}=4$\n\n向量的分量由下式给出：\n$u_i: (u_1, u_2) = (1, -2)$\n$v_j: (v_1, v_2) = (3, 1)$\n\n我们将使用爱因斯坦求和约定，即对任何重复的指标都进行求和。使用这些定义，我们可以通过张量与向量的缩并来构成标量。\n\n让我们根据两种不同的缩并过程，定义两个不同的标量 $\\alpha$ 和 $\\beta$：\n1.  标量 $\\alpha$ 是通过将 $T_{ijk}$ 的第一个指标与 $u_i$ 缩并，第二个指标与 $u_j$ 缩并，第三个指标与 $v_k$ 缩并得到的。\n2.  标量 $\\beta$ 是通过将 $T_{ijk}$ 的第一个指标与 $u_i$ 缩并，第二个指标与 $v_j$ 缩并，第三个指标与 $u_k$ 缩并得到的。\n\n计算差值 $\\alpha - \\beta$ 的值。", "solution": "问题要求计算 $\\alpha - \\beta$ 的值，其中 $\\alpha$ 和 $\\beta$ 是通过不同的张量缩并得到的标量。我们将分别计算每个标量，然后求出它们的差值。我们使用爱因斯坦求和约定，因此重复的指标将从1到2进行求和。\n\n**第一步：计算标量 $\\alpha$**\n\n标量 $\\alpha$ 由缩并 $\\alpha = T_{ijk} u_i u_j v_k$ 定义。这可以写成完整的求和形式：\n$$ \\alpha = \\sum_{i=1}^2 \\sum_{j=1}^2 \\sum_{k=1}^2 T_{ijk} u_i u_j v_k $$\n为了系统地计算它，我们可以首先将 $T_{ijk}$ 与 $v_k$ 缩并，形成一个2阶张量（一个矩阵）$M_{ij} = T_{ijk} v_k = \\sum_{k=1}^2 T_{ijk} v_k$。\n\n我们来计算 $M$ 的分量：\n$M_{11} = T_{11k} v_k = T_{111}v_1 + T_{112}v_2 = (1)(3) + (2)(1) = 3 + 2 = 5$\n$M_{12} = T_{12k} v_k = T_{121}v_1 + T_{122}v_2 = (0)(3) + (-1)(1) = 0 - 1 = -1$\n$M_{21} = T_{21k} v_k = T_{211}v_1 + T_{212}v_2 = (3)(3) + (-2)(1) = 9 - 2 = 7$\n$M_{22} = T_{22k} v_k = T_{221}v_1 + T_{222}v_2 = (1)(3) + (4)(1) = 3 + 4 = 7$\n\n所以，矩阵 $M_{ij}$ 是：\n$$ M = \\begin{pmatrix} 5 & -1 \\\\ 7 & 7 \\end{pmatrix} $$\n现在，我们可以通过将 $M_{ij}$ 与 $u_i$ 和 $u_j$ 缩并来求得 $\\alpha$：$\\alpha = M_{ij} u_i u_j = \\sum_{i=1}^2 \\sum_{j=1}^2 M_{ij} u_i u_j$。\n$$ \\alpha = M_{11}u_1 u_1 + M_{12}u_1 u_2 + M_{21}u_2 u_1 + M_{22}u_2 u_2 $$\n代入 $u_1=1$ 和 $u_2=-2$ 的值：\n$$ \\alpha = (5)(1)(1) + (-1)(1)(-2) + (7)(-2)(1) + (7)(-2)(-2) $$\n$$ \\alpha = 5 + 2 - 14 + 28 = 21 $$\n\n**第二步：计算标量 $\\beta$**\n\n标量 $\\beta$ 由缩并 $\\beta = T_{ijk} u_i v_j u_k$ 定义。这是一个不同的缩并组合。\n$$ \\beta = \\sum_{i=1}^2 \\sum_{j=1}^2 \\sum_{k=1}^2 T_{ijk} u_i v_j u_k $$\n为了计算它，我们可以首先将 $T_{ijk}$ 与 $v_j$ 缩并，形成一个不同的2阶张量 $N_{ik} = T_{ijk} v_j = \\sum_{j=1}^2 T_{ijk} v_j$。\n\n我们来计算 $N$ 的分量：\n$N_{11} = T_{1j1} v_j = T_{111}v_1 + T_{121}v_2 = (1)(3) + (0)(1) = 3$\n$N_{12} = T_{1j2} v_j = T_{112}v_1 + T_{122}v_2 = (2)(3) + (-1)(1) = 6 - 1 = 5$\n$N_{21} = T_{2j1} v_j = T_{211}v_1 + T_{221}v_2 = (3)(3) + (1)(1) = 9 + 1 = 10$\n$N_{22} = T_{2j2} v_j = T_{212}v_1 + T_{222}v_2 = (-2)(3) + (4)(1) = -6 + 4 = -2$\n\n所以，矩阵 $N_{ik}$ 是：\n$$ N = \\begin{pmatrix} 3 & 5 \\\\ 10 & -2 \\end{pmatrix} $$\n现在，我们通过将 $N_{ik}$ 与 $u_i$ 和 $u_k$ 缩并来求得 $\\beta$：$\\beta = N_{ik} u_i u_k = \\sum_{i=1}^2 \\sum_{k=1}^2 N_{ik} u_i u_k$。\n$$ \\beta = N_{11}u_1 u_1 + N_{12}u_1 u_2 + N_{21}u_2 u_1 + N_{22}u_2 u_2 $$\n代入 $u_1=1$ 和 $u_2=-2$ 的值：\n$$ \\beta = (3)(1)(1) + (5)(1)(-2) + (10)(-2)(1) + (-2)(-2)(-2) $$\n$$ \\beta = 3 - 10 - 20 - 8 $$\n$$ \\beta = -35 $$\n\n**第三步：计算差值 $\\alpha - \\beta$**\n\n最后，我们计算 $\\alpha$ 和 $\\beta$ 之间的差值。\n$$ \\alpha - \\beta = 21 - (-35) = 21 + 35 = 56 $$\n这个计算表明，对于非对称张量，向量与其指标的缩并顺序会显著影响最终结果。", "answer": "$$\\boxed{56}$$", "id": "1543530"}, {"introduction": "我们已经知道缩并顺序会影响计算结果，而本练习将进一步探讨其对计算效率的实际影响。在处理大型张量网络时，不同的缩并路径所带来的计算量差异可能是巨大的。通过这个动手实践，你将量化比较两种不同顺序的计算成本，从而深刻理解为何寻找最优缩并路径是使张量网络算法在实际应用中变得可行的关键一步。[@problem_id:1543555]", "problem": "在许多计算科学领域，计算复杂的张量网络是一项常见任务。此类计算的效率关键地取决于张量收缩的顺序。考虑一个由一个中心的5阶张量 $C_{ijklm}$ 和五个向量 $v_i$、$w_j$、$x_k$、$y_l$ 和 $z_m$ 组成的网络。目标是计算由该网络的完全收缩给出的标量值 $S$：\n$$S = \\sum_{i,j,k,l,m} C_{ijklm} v_i w_j x_k y_l z_m$$\n各指标的维度如下所示：$d_i = 5$，$d_j = 7$，$d_k = 11$，$d_l = 13$ 和 $d_m = 17$。\n\n张量与向量在一个指标上进行单次收缩的计算成本定义为所需的乘法运算次数。这等于该步骤中涉及的更高阶张量中的元素总数。例如，计算中间张量 $T_{jklm} = \\sum_{i} C_{ijklm} v_i$ 需要 $d_i \\times d_j \\times d_k \\times d_l \\times d_m$ 次乘法。\n\n提出了两种计算标量 $S$ 的不同序列：\n\n**序列 A**：标量 $S$ 的计算方法是，首先将张量 $C$ 与向量 $v$ 收缩，然后将得到的4阶张量与 $w$ 收缩，以此类推，遵循向量的顺序 $(v, w, x, y, z)$。\n\n**序列 B**：标量 $S$ 的计算方法类似，但是以相反的顺序与向量收缩，即 $(z, y, x, w, v)$。\n\n计算较昂贵序列的总计算成本与较便宜序列的总计算成本的比率。将最终答案四舍五入到四位有效数字。", "solution": "给定一个5阶张量 $C_{ijklm}$，其指标维度为 $d_{i}=5$、$d_{j}=7$、$d_{k}=11$、$d_{l}=13$、$d_{m}=17$，以及向量 $v_{i}$、$w_{j}$、$x_{k}$、$y_{l}$、$z_{m}$。标量为\n$$\nS=\\sum_{i,j,k,l,m} C_{ijklm} v_{i} w_{j} x_{k} y_{l} z_{m}.\n$$\n张量与向量在一个指标上收缩的成本等于收缩前更高阶张量中的元素数量。\n\n对于序列 A（顺序为 $(v,w,x,y,z)$），每一步的成本如下：\n- 首先将 $C$ 与 $v$ 在指标 $i$ 上收缩：成本为 $d_{i} d_{j} d_{k} d_{l} d_{m}$；结果的大小为 $d_{j} d_{k} d_{l} d_{m}$。\n- 然后与 $w$ 在指标 $j$ 上收缩：成本为 $d_{j} d_{k} d_{l} d_{m}$；结果的大小为 $d_{k} d_{l} d_{m}$。\n- 然后与 $x$ 在指标 $k$ 上收缩：成本为 $d_{k} d_{l} d_{m}$；结果的大小为 $d_{l} d_{m}$。\n- 然后与 $y$ 在指标 $l$ 上收缩：成本为 $d_{l} d_{m}$；结果的大小为 $d_{m}$。\n- 最后与 $z$ 在指标 $m$ 上收缩：成本为 $d_{m}$；结果为标量。\n\n因此总成本为\n$$\n\\text{Cost}_{A}=d_{i} d_{j} d_{k} d_{l} d_{m}+d_{j} d_{k} d_{l} d_{m}+d_{k} d_{l} d_{m}+d_{l} d_{m}+d_{m}.\n$$\n代入给定的维度，\n$$\n\\text{Cost}_{A}=5\\cdot 7\\cdot 11\\cdot 13\\cdot 17+7\\cdot 11\\cdot 13\\cdot 17+11\\cdot 13\\cdot 17+13\\cdot 17+17.\n$$\n计算每个乘积：\n$$\n5\\cdot 7\\cdot 11\\cdot 13\\cdot 17=85085,\\quad 7\\cdot 11\\cdot 13\\cdot 17=17017,\\quad 11\\cdot 13\\cdot 17=2431,\\quad 13\\cdot 17=221,\\quad 17=17,\n$$\n所以\n$$\n\\text{Cost}_{A}=85085+17017+2431+221+17=104771.\n$$\n\n对于序列 B（顺序为 $(z,y,x,w,v)$），每一步的成本如下：\n- 首先将 $C$ 与 $z$ 在指标 $m$ 上收缩：成本为 $d_{i} d_{j} d_{k} d_{l} d_{m}$；结果的大小为 $d_{i} d_{j} d_{k} d_{l}$。\n- 然后与 $y$ 在指标 $l$ 上收缩：成本为 $d_{i} d_{j} d_{k} d_{l}$；结果的大小为 $d_{i} d_{j} d_{k}$。\n- 然后与 $x$ 在指标 $k$ 上收缩：成本为 $d_{i} d_{j} d_{k}$；结果的大小为 $d_{i} d_{j}$。\n- 然后与 $w$ 在指标 $j$ 上收缩：成本为 $d_{i} d_{j}$；结果的大小为 $d_{i}$。\n- 最后与 $v$ 在指标 $i$ 上收缩：成本为 $d_{i}$；结果为标量。\n\n因此总成本为\n$$\n\\text{Cost}_{B}=d_{i} d_{j} d_{k} d_{l} d_{m}+d_{i} d_{j} d_{k} d_{l}+d_{i} d_{j} d_{k}+d_{i} d_{j}+d_{i}.\n$$\n代入给定的维度，\n$$\n\\text{Cost}_{B}=5\\cdot 7\\cdot 11\\cdot 13\\cdot 17+5\\cdot 7\\cdot 11\\cdot 13+5\\cdot 7\\cdot 11+5\\cdot 7+5.\n$$\n计算每个乘积：\n$$\n5\\cdot 7\\cdot 11\\cdot 13\\cdot 17=85085,\\quad 5\\cdot 7\\cdot 11\\cdot 13=5005,\\quad 5\\cdot 7\\cdot 11=385,\\quad 5\\cdot 7=35,\\quad 5=5,\n$$\n所以\n$$\n\\text{Cost}_{B}=85085+5005+385+35+5=90515.\n$$\n\n较昂贵的序列是序列 A，因为 $104771>90515$。所求的比率为\n$$\nR=\\frac{\\text{Cost}_{\\text{more}}}{\\text{Cost}_{\\text{less}}}=\\frac{104771}{90515}\\approx 1.15749877\\ldots\n$$\n四舍五入到四位有效数字，结果是 $1.157$。", "answer": "$$\\boxed{1.157}$$", "id": "1543555"}]}