{"hands_on_practices": [{"introduction": "要真正理解规范多元分解（Canonical Polyadic Decomposition, CPD），最好的方法是从其最基本的构成单元——秩-1张量开始。本练习将挑战你进行一次“逆向工程”：给定一个已知的秩-1张量，你需要找出构成它的因子向量。通过直接操作张量元素，你将亲身体会到基本关系 $T_{ijk} = a_i b_j c_k$ 的内涵，这就像从一道成品菜肴中推断出其独特的配料一样。[@problem_id:1491551]", "problem": "一个三阶张量 $\\mathcal{T} \\in \\mathbb{R}^{I \\times J \\times K}$ 是秩一张量，如果它可以表示为三个向量的外积：$\\mathbf{a} \\in \\mathbb{R}^{I}$，$\\mathbf{b} \\in \\mathbb{R}^{J}$ 和 $\\mathbf{c} \\in \\mathbb{R}^{K}$。这种分解被称为规范多元分解（Canonical Polyadic (CP) decomposition），写作 $\\mathcal{T} = \\mathbf{a} \\circ \\mathbf{b} \\circ \\mathbf{c}$，其对应的逐元素方程为 $T_{ijk} = a_i b_j c_k$，适用于所有有效的索引 $i, j, k$。\n\n考虑一个秩一张量 $\\mathcal{T} \\in \\mathbb{R}^{2 \\times 2 \\times 2}$，其元素由其两个锋面切片 $T_{::1}$（对于 $k=1$）和 $T_{::2}$（对于 $k=2$）指定：\n$$\nT_{::1} = \\begin{pmatrix} T_{111} & T_{121} \\\\ T_{211} & T_{221} \\end{pmatrix} = \\begin{pmatrix} 2 & 8 \\\\ -6 & -24 \\end{pmatrix}\n$$\n$$\nT_{::2} = \\begin{pmatrix} T_{112} & T_{122} \\\\ T_{212} & T_{222} \\end{pmatrix} = \\begin{pmatrix} -5 & -20 \\\\ 15 & 60 \\end{pmatrix}\n$$\n\n因子向量 $\\mathbf{a} = \\begin{pmatrix} a_1 \\\\ a_2 \\end{pmatrix}$，$\\mathbf{b} = \\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$ 和 $\\mathbf{c} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$ 因缩放自由度而不唯一。为获得唯一解，该分解通过约定向量 $\\mathbf{a}$ 和 $\\mathbf{b}$ 的第一个元素为1来进行归一化，即 $a_1 = 1$ 且 $b_1 = 1$。\n\n根据这些信息，确定向量 $\\mathbf{b}$ 的第二个元素（记作 $b_2$）的值。", "solution": "问题要求解给定三阶张量 $\\mathcal{T} \\in \\mathbb{R}^{2 \\times 2 \\times 2}$ 的秩一规范多元分解（CP分解）中 $b_2$ 的值。\n\n秩一CP分解的定义关系由以下逐元素方程给出：\n$$\nT_{ijk} = a_i b_j c_k\n$$\n其中 $\\mathbf{a} = \\begin{pmatrix} a_1 \\\\ a_2 \\end{pmatrix}$，$\\mathbf{b} = \\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$ 和 $\\mathbf{c} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$ 是因子向量。\n\n问题提供了一个归一化约束以确保因子向量的唯一解：\n$$\na_1 = 1\n$$\n$$\nb_1 = 1\n$$\n\n我们已知张量 $\\mathcal{T}$ 的元素以两个锋面切片的形式给出。让我们利用分解公式和归一化约束，写出张量中几个元素的方程。\n\n考虑第一个锋面切片（$k=1$）中的元素：\n元素 $T_{111}$ 由下式给出：\n$$\nT_{111} = a_1 b_1 c_1\n$$\n代入已知值 $T_{111} = 2$、$a_1 = 1$ 和 $b_1 = 1$：\n$$\n2 = (1)(1)c_1 \\implies c_1 = 2\n$$\n\n现在，考虑元素 $T_{121}$，它也属于第一个锋面切片（$k=1$）：\n$$\nT_{121} = a_1 b_2 c_1\n$$\n我们已知 $T_{121} = 8$。我们还有 $a_1 = 1$，并且刚刚求得 $c_1 = 2$。将这些值代入 $T_{121}$ 的方程中：\n$$\n8 = (1) b_2 (2)\n$$\n$$\n8 = 2 b_2\n$$\n求解 $b_2$，这正是我们要求解的量：\n$$\nb_2 = \\frac{8}{2} = 4\n$$\n\n向量 $\\mathbf{b}$ 的第二个元素的值是4。\n\n为完整起见，我们可以求出所有其他分量，并验证它们与整个张量是一致的。\n由 $T_{211} = a_2 b_1 c_1$ 可得：\n$$\n-6 = a_2 (1) (2) \\implies a_2 = -3\n$$\n由 $T_{112} = a_1 b_1 c_2$ 可得：\n$$\n-5 = (1) (1) c_2 \\implies c_2 = -5\n$$\n\n因此，因子向量为：\n$$\n\\mathbf{a} = \\begin{pmatrix} 1 \\\\ -3 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 1 \\\\ 4 \\end{pmatrix}, \\quad \\mathbf{c} = \\begin{pmatrix} 2 \\\\ -5 \\end{pmatrix}\n$$\n\n让我们检查这些向量是否能正确重构整个张量 $\\mathcal{T}$。\n$T_{221} = a_2 b_2 c_1 = (-3)(4)(2) = -24$。这与给定的张量匹配。\n$T_{122} = a_1 b_2 c_2 = (1)(4)(-5) = -20$。这与给定的张量匹配。\n$T_{212} = a_2 b_1 c_2 = (-3)(1)(-5) = 15$。这与给定的张量匹配。\n$T_{222} = a_2 b_2 c_2 = (-3)(4)(-5) = 60$。这与给定的张量匹配。\n\n所有元素均匹配，证实了我们的计算是正确的。我们被要求求解的值是 $b_2$。", "answer": "$$\\boxed{4}$$", "id": "1491551"}, {"introduction": "在分解张量时，一个重要的问题是解的唯一性。对于任意一个秩-1张量 $\\mathbf{u} \\circ \\mathbf{v} \\circ \\mathbf{w}$，我们可以通过缩放因子向量（例如，用 $2\\mathbf{u}$ 和 $0.5\\mathbf{v}$ 替换）得到无穷多组不同的因子，但它们描述的却是同一个张量。为了解决这个问题，我们引入了标准化形式。本练习将指导你如何将一个秩-1张量转换为其标准CP分解形式，即将大小（权重 $\\lambda_1$）与方向（单位范数向量）分离开来。[@problem_id:1491573]", "problem": "规范多元分解（Canonical Polyadic (CP) decomposition），也称为 PARAFAC 或 CANDECOMP，是一种将张量表示为一系列秩一张量之和的方法。对于一个三阶张量 $\\mathcal{T}$，其 CP 分解的一种常见约定形式是：\n$$ \\mathcal{T} = \\sum_{r=1}^{R} \\lambda_r (\\mathbf{a}_r \\circ \\mathbf{b}_r \\circ \\mathbf{c}_r) $$\n其中 $R$ 是张量的秩，$\\lambda_r > 0$ 是标量权重，并且向量 $\\mathbf{a}_r, \\mathbf{b}_r, \\mathbf{c}_r$ 被要求具有单位欧几里得范数（即，对于任意向量 $\\mathbf{v}$，其范数为 $\\|\\mathbf{v}\\|_2 = 1$）。三个向量的外积按元素定义为 $(\\mathbf{a} \\circ \\mathbf{b} \\circ \\mathbf{c})_{ijk} = a_i b_j c_k$。\n\n考虑一个三阶张量 $\\mathcal{A} \\in \\mathbb{R}^{2 \\times 2 \\times 2}$，已知其为秩一（$R=1$）。它由三个向量 $\\mathbf{u}, \\mathbf{v}, \\mathbf{w} \\in \\mathbb{R}^2$ 的外积构造而成，即 $\\mathcal{A} = \\mathbf{u} \\circ \\mathbf{v} \\circ \\mathbf{w}$。这些向量由下式给出：\n$$ \\mathbf{u} = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}, \\quad \\mathbf{v} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{w} = \\begin{pmatrix} 5 \\\\ 12 \\end{pmatrix} $$\n确定张量 $\\mathcal{A}$ 的 CP 分解，并写成上述的归一化形式。作为最终答案，请给出权重 $\\lambda_1$ 的数值。", "solution": "对于一个秩一的三阶张量，其归一化的 CP 形式为\n$$\n\\mathcal{A}=\\lambda_{1}\\left(\\mathbf{a}_{1}\\circ\\mathbf{b}_{1}\\circ\\mathbf{c}_{1}\\right),\n$$\n其中 $\\|\\mathbf{a}_{1}\\|_{2}=\\|\\mathbf{b}_{1}\\|_{2}=\\|\\mathbf{c}_{1}\\|_{2}=1$ 且 $\\lambda_{1}>0$。给定 $\\mathcal{A}=\\mathbf{u}\\circ\\mathbf{v}\\circ\\mathbf{w}$，我们将每个向量写成其范数与一个单位向量的乘积：\n$$\n\\mathbf{u}=\\|\\mathbf{u}\\|_{2}\\,\\mathbf{a}_{1},\\quad \\mathbf{v}=\\|\\mathbf{v}\\|_{2}\\,\\mathbf{b}_{1},\\quad \\mathbf{w}=\\|\\mathbf{w}\\|_{2}\\,\\mathbf{c}_{1},\n$$\n其中 $\\mathbf{a}_{1}=\\mathbf{u}/\\|\\mathbf{u}\\|_{2}$，$\\mathbf{b}_{1}=\\mathbf{v}/\\|\\mathbf{v}\\|_{2}$ 和 $\\mathbf{c}_{1}=\\mathbf{w}/\\|\\mathbf{w}\\|_{2}$ 根据构造是单位向量。利用外积的标量结合律，\n$$\n(\\alpha\\mathbf{a})\\circ(\\beta\\mathbf{b})\\circ(\\gamma\\mathbf{c})=(\\alpha\\beta\\gamma)\\,(\\mathbf{a}\\circ\\mathbf{b}\\circ\\mathbf{c}),\n$$\n我们得到\n$$\n\\mathcal{A}=(\\|\\mathbf{u}\\|_{2}\\,\\|\\mathbf{v}\\|_{2}\\,\\|\\mathbf{w}\\|_{2})\\,(\\mathbf{a}_{1}\\circ\\mathbf{b}_{1}\\circ\\mathbf{c}_{1}),\n$$\n所以权重为\n$$\n\\lambda_{1}=\\|\\mathbf{u}\\|_{2}\\,\\|\\mathbf{v}\\|_{2}\\,\\|\\mathbf{w}\\|_{2}.\n$$\n使用 $\\|\\mathbf{x}\\|_{2}=\\sqrt{\\sum_{i} x_{i}^{2}}$ 计算范数：\n$$\n\\|\\mathbf{u}\\|_{2}=\\sqrt{3^{2}+4^{2}}=5,\\quad \\|\\mathbf{v}\\|_{2}=\\sqrt{1^{2}+0^{2}}=1,\\quad \\|\\mathbf{w}\\|_{2}=\\sqrt{5^{2}+12^{2}}=13.\n$$\n因此，\n$$\n\\lambda_{1}=5\\cdot 1\\cdot 13=65.\n$$\n这就得到了归一化的因子向量 $\\mathbf{a}_{1}=\\begin{pmatrix}\\frac{3}{5}\\\\\\frac{4}{5}\\end{pmatrix}$，$\\mathbf{b}_{1}=\\begin{pmatrix}1\\\\0\\end{pmatrix}$，$\\mathbf{c}_{1}=\\begin{pmatrix}\\frac{5}{13}\\\\\\frac{12}{13}\\end{pmatrix}$，它们都具有单位范数，并且 $\\lambda_{1}>0$，符合要求。", "answer": "$$\\boxed{65}$$", "id": "1491573"}, {"introduction": "理解了秩-1张量后，我们自然会想知道如何表示更复杂的结构。现实世界中的数据很少能用单个秩-1张量完美表示。CPD的核心思想正是将一个高阶张量表示为多个秩-1张量的和，即 $\\mathcal{T} = \\sum_{r=1}^{R} \\mathbf{a}^{(r)} \\circ \\mathbf{b}^{(r)} \\circ \\mathbf{c}^{(r)}$。本练习让你从“无”到“有”地构建一个秩-3张量，通过亲手将三个不同的秩-1分量相加，你将深刻理解CPD中求和符号的物理意义，并体会到“积少成多”的分解哲学。[@problem_id:1491540]", "problem": "在张量分析中，一个三阶张量 $\\mathcal{T} \\in \\mathbb{R}^{I \\times J \\times K}$ 可以通过规范多元 (CP) 分解（也称为平行因子分析 (PARAFAC)）表示为若干秩-1张量的和。一个秩-1张量是由三个向量的外积构成的，记作 $\\mathbf{a} \\circ \\mathbf{b} \\circ \\mathbf{c}$，其中 $\\mathbf{a} \\in \\mathbb{R}^{I}$，$\\mathbf{b} \\in \\mathbb{R}^{J}$，并且 $\\mathbf{c} \\in \\mathbb{R}^{K}$。\n\n考虑一个大小为 $2 \\times 2 \\times 2$ 的张量 $\\mathcal{T}$，它是由三个不同的秩-1张量求和构造的。因此，该张量的秩为3。这三个秩-1张量由以下几组向量的外积定义：\n\n第1组：$\\mathbf{a}^{(1)} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$，$\\mathbf{b}^{(1)} = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}$，$\\mathbf{c}^{(1)} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$\n\n第2组：$\\mathbf{a}^{(2)} = \\begin{pmatrix} 0 \\\\ -2 \\end{pmatrix}$，$\\mathbf{b}^{(2)} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，$\\mathbf{c}^{(2)} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}$\n\n第3组：$\\mathbf{a}^{(3)} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$，$\\mathbf{b}^{(3)} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$，$\\mathbf{c}^{(3)} = \\begin{pmatrix} 0 \\\\ 2 \\end{pmatrix}$\n\n所得张量 $\\mathcal{T}$ 的元素记为 $\\mathcal{T}_{ijk}$，其中索引 $i, j, k$ 的取值范围为1到2。计算元素 $\\mathcal{T}_{212}$ 的值。", "solution": "一个经过 CP 分解 $\\mathcal{T}=\\sum_{r=1}^{R}\\mathbf{a}^{(r)}\\circ\\mathbf{b}^{(r)}\\circ\\mathbf{c}^{(r)}$ 的三阶张量，其元素由下式给出\n$$\n\\mathcal{T}_{ijk}=\\sum_{r=1}^{R}a_{i}^{(r)}b_{j}^{(r)}c_{k}^{(r)}.\n$$\n这里 $R=3$。对于所求的索引为 $(i,j,k)=(2,1,2)$ 的元素，\n$$\n\\mathcal{T}_{212}=\\sum_{r=1}^{3}a_{2}^{(r)}b_{1}^{(r)}c_{2}^{(r)}.\n$$\n计算每一项：\n- 对于 $r=1$：$a_{2}^{(1)}=2$，$b_{1}^{(1)}=3$，$c_{2}^{(1)}=1$，所以乘积为 $2\\cdot 3\\cdot 1=6$。\n- 对于 $r=2$：$a_{2}^{(2)}=-2$，$b_{1}^{(2)}=1$，$c_{2}^{(2)}=1$，所以乘积为 $-2\\cdot 1\\cdot 1=-2$。\n- 对于 $r=3$：$a_{2}^{(3)}=-1$，$b_{1}^{(3)}=1$，$c_{2}^{(3)}=2$，所以乘积为 $-1\\cdot 1\\cdot 2=-2$。\n\n将这些贡献相加，\n$$\n\\mathcal{T}_{212}=6+(-2)+(-2)=2.\n$$", "answer": "$$\\boxed{2}$$", "id": "1491540"}]}