{"hands_on_practices": [{"introduction": "在我们使用广义傅里叶级数之前，我们常常需要先 *构造* 出所需要的正交函数系。Gram-Schmidt 正交化过程就是一种从简单的基（如单项式）出发，系统地构建正交多项式集的强大方法。通过这个练习 [@problem_id:2106894]，你将亲手实践这一基本算法，并理解权函数 $w(x)$ 如何影响最终得到的正交多项式。", "problem": "在物理系统的数学建模中，广义傅里叶级数展开为近似函数提供了强大的工具。这些展开的基通常是针对特定问题，根据特定权重函数导出的正交多项式集合。\n\n考虑在区间 $[-1, 1]$ 上定义的实多项式向量空间。该空间中任意两个多项式 $f(x)$ 和 $g(x)$ 的内积由以下公式给出：\n$$ \\langle f, g \\rangle = \\int_{-1}^{1} f(x) g(x) w(x) \\, dx $$\n其中权重函数为 $w(x) = 1 - x^2$。这种加权方案使得多项式在区间中心附近的行为更为重要。\n\n从标准单项式基 $\\{u_0(x)=1, u_1(x)=x, u_2(x)=x^2\\}$ 出发，可以构造一组正交多项式 $\\{P_0(x), P_1(x), P_2(x), \\dots\\}$，使得当 $i \\neq j$ 时，$\\langle P_i, P_j \\rangle = 0$。为确保这组多项式的唯一性，它们被定义为首一多项式，即每个 $P_n(x)$ 中 $x$ 的最高次幂的系数为1。\n\n你的任务是确定此序列中的第三个多项式 $P_2(x)$。", "solution": "我们在 $[-1,1]$ 上的实多项式空间中进行计算，其内积为 $\\langle f,g\\rangle=\\int_{-1}^{1} f(x)g(x)w(x)\\,dx$，权重函数为 $w(x)=1-x^{2}$。从单项式基 $\\{1,x,x^{2}\\}$ 出发，我们通过格拉姆-施密特（Gram–Schmidt）方法构造首一正交多项式。前两个首一多项式是 $P_{0}(x)=1$ 和 $P_{1}(x)=x$；它们已经正交，因为权重函数是偶函数且积分区间是对称的。\n\n我们寻求首一形式的 $P_{2}(x)=x^{2}+\\alpha x+\\beta$，其正交性条件为\n$$\n\\langle P_{2},P_{0}\\rangle=\\int_{-1}^{1}(x^{2}+\\alpha x+\\beta)(1-x^{2})\\,dx=0,\n$$\n$$\n\\langle P_{2},P_{1}\\rangle=\\int_{-1}^{1}(x^{2}+\\alpha x+\\beta)x(1-x^{2})\\,dx=0.\n$$\n我们利用对称性以及对于 $n\\in\\mathbb{N}$ 的以下事实：\n$$\n\\int_{-1}^{1}x^{n}\\,dx=\\begin{cases}\n0,& n\\ \\text{为奇数},\\\\\n\\frac{2}{n+1},& n\\ \\text{为偶数}。\n\\end{cases}\n$$\n\n第一个条件：\n$$\n\\int_{-1}^{1}(x^{2}+\\alpha x+\\beta)(1-x^{2})\\,dx=\\int_{-1}^{1}\\bigl[x^{2}-x^{4}+\\alpha(x-x^{3})+\\beta-\\beta x^{2}\\bigr]\\,dx.\n$$\n项 $\\alpha(x-x^{3})$ 是奇函数，积分为 $0$，所以\n$$\n\\int_{-1}^{1}\\bigl[\\beta+(1-\\beta)x^{2}-x^{4}\\bigr]\\,dx\n=2\\beta+(1-\\beta)\\frac{2}{3}-\\frac{2}{5}=0.\n$$\n这得到\n$$\n2\\beta+\\frac{2}{3}-\\frac{2}{3}\\beta-\\frac{2}{5}=0\n\\;\\Longrightarrow\\;\n\\frac{4}{3}\\beta+\\frac{4}{15}=0\n\\;\\Longrightarrow\\;\n\\beta=-\\frac{1}{5}.\n$$\n\n第二个条件：\n$$\n\\int_{-1}^{1}(x^{2}+\\alpha x+\\beta)x(1-x^{2})\\,dx\n=\\int_{-1}^{1}\\bigl[x^{3}+\\alpha x^{2}+\\beta x-x^{5}-\\alpha x^{4}-\\beta x^{3}\\bigr]\\,dx.\n$$\n所有奇次幂项的积分为 $0$，剩下\n$$\n\\int_{-1}^{1}\\alpha(x^{2}-x^{4})\\,dx=\\alpha\\left(\\frac{2}{3}-\\frac{2}{5}\\right)=\\alpha\\cdot\\frac{4}{15}=0\n\\;\\Longrightarrow\\;\n\\alpha=0.\n$$\n\n因此，与 $1$ 和 $x$ 正交的首一二次多项式是\n$$\nP_{2}(x)=x^{2}-\\frac{1}{5}.\n$$", "answer": "$$\\boxed{x^{2}-\\frac{1}{5}}$$", "id": "2106894"}, {"introduction": "一旦我们拥有了一组正交函数（例如勒让德多项式），下一步就是应用它们。其主要用途之一是将其他复杂函数表示为这些正交函数的级数和。这个练习 [@problem_id:2106858] 将指导你如何利用正交性来计算一个给定分段函数其傅里叶-勒让德级数展开的系数，这是将理论付诸实践的关键一步。", "problem": "一个函数 $f(x)$ 在区间 $[-1, 1]$ 上定义为一个阶梯函数：\n$$\nf(x) = \\begin{cases} 0 & \\text{当 } -1 \\le x < 1/2 \\\\ 1 & \\text{当 } 1/2 \\le x \\le 1 \\end{cases}\n$$\n该函数可以通过其傅里叶-勒让德级数展开来近似，其形式为 $f(x) = \\sum_{n=0}^{\\infty} c_n P_n(x)$，其中 $P_n(x)$ 是勒让德多项式。该展开式的系数 $c_n$ 可以通过勒让德多项式的正交关系求得，由以下公式给出：\n$$\nc_n = \\frac{2n+1}{2} \\int_{-1}^{1} f(x) P_n(x) \\,dx\n$$\n已知三阶勒让德多项式为 $P_3(x) = \\frac{1}{2}(5x^3 - 3x)$。\n\n计算给定函数 $f(x)$ 的傅里叶-勒让德级数展开中系数 $c_3$ 的精确值。请将你的答案表示为分数。", "solution": "我们使用给定的傅里叶-勒让德级数系数公式：\n$$\nc_{n}=\\frac{2n+1}{2}\\int_{-1}^{1}f(x)P_{n}(x)\\,dx.\n$$\n由于当 $-1\\leq x<\\frac{1}{2}$ 时 $f(x)=0$ 且当 $\\frac{1}{2}\\leq x\\leq 1$ 时 $f(x)=1$，积分简化为\n$$\nc_{3}=\\frac{7}{2}\\int_{\\frac{1}{2}}^{1}P_{3}(x)\\,dx.\n$$\n利用 $P_{3}(x)=\\frac{1}{2}(5x^{3}-3x)$，我们计算\n$$\n\\int_{\\frac{1}{2}}^{1}P_{3}(x)\\,dx=\\int_{\\frac{1}{2}}^{1}\\frac{1}{2}(5x^{3}-3x)\\,dx=\\left[\\frac{5}{8}x^{4}-\\frac{3}{4}x^{2}\\right]_{\\frac{1}{2}}^{1}.\n$$\n计算在边界处的反导数值得到\n$$\n\\left(\\frac{5}{8}\\cdot 1-\\frac{3}{4}\\cdot 1\\right)-\\left(\\frac{5}{8}\\cdot \\frac{1}{16}-\\frac{3}{4}\\cdot \\frac{1}{4}\\right)=-\\frac{1}{8}-\\left(\\frac{5}{128}-\\frac{3}{16}\\right)=-\\frac{1}{8}+\\frac{19}{128}=\\frac{3}{128}.\n$$\n因此，\n$$\nc_{3}=\\frac{7}{2}\\cdot \\frac{3}{128}=\\frac{21}{256}.\n$$", "answer": "$$\\boxed{\\frac{21}{256}}$$", "id": "2106858"}, {"introduction": "仅仅拥有一组正交函数是不够的，我们还需要确保这组函数“足够完备”，能够表示其所在函数空间中的任何函数。这个具有挑战性的练习 [@problem_id:2106919] 将引导你探索“完备性”这一核心概念。你将通过寻找一个被给定函数集“遗漏”的特定函数，来证明一个正交函数集是不完备的，从而将正交性与Sturm-Liouville理论深刻地联系起来。", "problem": "在偏微分方程（PDE）的分析中，完备正交基的概念对于将解表示为级数展开至关重要。考虑实希尔伯特空间 $L^2([0, \\pi])$，它由区间 $[0, \\pi]$ 上的所有平方可积函数组成。该空间赋有由 $\\langle f, g \\rangle = \\int_0^\\pi f(x)g(x)dx$ 定义的内积。\n\n为此空间提出的一个基是无穷函数集 $S = \\{\\sin(nx) \\mid n \\in \\mathbb{Z}, n \\ge 2\\}$。如果空间中唯一与每个基元正交的函数是零函数 $f(x)=0$，则称该基是完备的。\n\n你的任务是通过找到一个与 $S$ 中每个函数都正交的特定非零函数 $f(x)$，来证明集合 $S$ 是不完备的。已知该函数 $f(x)$ 满足以下性质：\n1. 它是区间 $[0, \\pi]$ 上由微分方程 $f''(x) + \\lambda f(x) = 0$ 和边界条件 $f(0) = 0$ 及 $f(\\pi) = 0$ 定义的斯图姆-刘维尔问题的非平凡解。\n2. 该函数被归一化，使其在区间 $[0, \\pi]$ 上的最大值等于 $\\sqrt{\\frac{2}{\\pi}}$。\n\n使用这个唯一确定的函数 $f(x)$，计算积分 $I = \\int_0^\\pi x^2 f(x) dx$ 的精确值。将你的答案表示为单个闭式解析表达式。", "solution": "该问题要求我们找到一个特定的函数 $f(x)$，然后用它来计算一个积分。我们将遵循一个多步骤过程来确定 $f(x)$，然后计算该积分。\n\n首先，我们根据给定的性质来确定函数 $f(x)$。\n函数 $f(x)$ 必须是斯图姆-刘维尔问题 $f''(x) + \\lambda f(x) = 0$（边界条件为 $f(0)=0$ 和 $f(\\pi)=0$）的一个解。这个常微分方程的通解取决于 $\\lambda$ 的符号。假设 $\\lambda > 0$，令 $\\lambda = k^2$（对于某个 $k>0$）。通解为 $f(x) = A \\cos(kx) + B \\sin(kx)$。\n\n应用边界条件：\n1. $f(0) = 0 \\implies A \\cos(0) + B \\sin(0) = A \\cdot 1 + B \\cdot 0 = A = 0$。\n所以解必须是 $f(x) = B \\sin(kx)$ 的形式。\n\n2. $f(\\pi) = 0 \\implies B \\sin(k\\pi) = 0$。为了得到非平凡解，我们必须有 $B \\neq 0$，这意味着 $\\sin(k\\pi) = 0$。当 $k\\pi = m\\pi$（对于任意整数 $m$）时，此条件成立。由于 $k>0$，$m$ 必须是正整数，$m \\in \\{1, 2, 3, \\dots\\}$。因此，$k=m$。\n\n斯图姆-刘维尔问题的特征函数形式为 $f_m(x) = B_m \\sin(mx)$，其中 $m=1, 2, 3, \\dots$。\n\n接下来，我们使用正交性条件。函数 $f(x)$ 必须与集合 $S = \\{\\sin(nx) \\mid n \\in \\mathbb{Z}, n \\ge 2\\}$ 中的每个函数正交。这意味着对于所有整数 $n \\ge 2$，都有 $\\langle f(x), \\sin(nx) \\rangle = 0$。\n设我们的函数为 $f(x) = B_m \\sin(mx)$，其中 $m$ 是某个正整数。正交性条件是：\n$$\n\\langle B_m \\sin(mx), \\sin(nx) \\rangle = B_m \\int_0^\\pi \\sin(mx) \\sin(nx) dx = 0 \\quad \\text{对于所有 } n \\ge 2.\n$$\n函数集 $\\{\\sin(jx)\\}_{j=1}^\\infty$ 在 $[0, \\pi]$ 上是一个正交集。积分 $\\int_0^\\pi \\sin(mx) \\sin(nx) dx$ 的值仅在 $m=n$ 时非零。由于该条件必须对所有 $n \\in \\{2, 3, 4, \\dots\\}$ 成立，我们选择的整数 $m$ 不能是这些值中的任何一个。不在集合 $\\{2, 3, 4, \\dots\\}$ 中的唯一正整数是 $m=1$。\n因此，函数 $f(x)$ 的形式必须为 $f(x) = B_1 \\sin(x)$。\n\n现在，我们使用归一化条件来求常数 $B_1$。在 $[0, \\pi]$ 上 $f(x)$ 的最大值被给定为 $\\sqrt{\\frac{2}{\\pi}}$。\n函数为 $f(x) = B_1 \\sin(x)$。在区间 $[0, \\pi]$ 上，$\\sin(x)$ 是非负的，其最大值为 $\\sin(\\pi/2) = 1$。因此，$f(x)$ 的最大值是 $|B_1|$。假设 $B_1$ 为正以匹配区间上 $\\sin(x)$ 的正值，则最大值为 $B_1$。\n我们已知这个最大值是 $\\sqrt{\\frac{2}{\\pi}}$，所以 $B_1 = \\sqrt{\\frac{2}{\\pi}}$。\n唯一确定的函数是 $f(x) = \\sqrt{\\frac{2}{\\pi}} \\sin(x)$。\n\n最后，我们计算积分 $I = \\int_0^\\pi x^2 f(x) dx$。\n$$\nI = \\int_0^\\pi x^2 \\left(\\sqrt{\\frac{2}{\\pi}} \\sin(x)\\right) dx = \\sqrt{\\frac{2}{\\pi}} \\int_0^\\pi x^2 \\sin(x) dx\n$$\n我们使用两次分部积分法来计算定积分 $\\int_0^\\pi x^2 \\sin(x) dx$。\n令 $u = x^2$ 且 $dv = \\sin(x)dx$。则 $du = 2x dx$ 且 $v = -\\cos(x)$。\n$$\n\\int x^2 \\sin(x) dx = -x^2 \\cos(x) - \\int (-\\cos(x))(2x dx) = -x^2 \\cos(x) + 2 \\int x \\cos(x) dx\n$$\n对于剩下的积分，令 $u' = x$ 且 $dv' = \\cos(x)dx$。则 $du' = dx$ 且 $v' = \\sin(x)$。\n$$\n\\int x \\cos(x) dx = x \\sin(x) - \\int \\sin(x) dx = x \\sin(x) + \\cos(x)\n$$\n将此代回，不定积分为：\n$$\n\\int x^2 \\sin(x) dx = -x^2 \\cos(x) + 2(x \\sin(x) + \\cos(x)) = -x^2 \\cos(x) + 2x \\sin(x) + 2 \\cos(x)\n$$\n现在我们计算从 $0$ 到 $\\pi$ 的定积分：\n$$\n\\int_0^\\pi x^2 \\sin(x) dx = \\left[ -x^2 \\cos(x) + 2x \\sin(x) + 2 \\cos(x) \\right]_0^\\pi\n$$\n在上限 $x=\\pi$ 处求值：\n$$\n-\\pi^2 \\cos(\\pi) + 2\\pi \\sin(\\pi) + 2 \\cos(\\pi) = -\\pi^2(-1) + 2\\pi(0) + 2(-1) = \\pi^2 - 2\n$$\n在下限 $x=0$ 处求值：\n$$\n-0^2 \\cos(0) + 2(0) \\sin(0) + 2 \\cos(0) = 0 + 0 + 2(1) = 2\n$$\n定积分的值为 $(\\pi^2 - 2) - 2 = \\pi^2 - 4$。\n\n将此结果代回 $I$ 的表达式中：\n$$\nI = \\sqrt{\\frac{2}{\\pi}} (\\pi^2 - 4)\n$$\n这就是最终的闭式解析表达式。", "answer": "$$\\boxed{\\sqrt{\\frac{2}{\\pi}}(\\pi^2 - 4)}$$", "id": "2106919"}]}