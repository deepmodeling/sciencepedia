{"hands_on_practices": [{"introduction": "我们从一个理想化的情形开始，来掌握特征函数展开法的核心思想。当非齐次项（即热源或外力）的空间分布恰好与系统的一个固有振动模式（即一个特征函数）相匹配时，求解过程会大大简化。\n\n这个练习 [@problem_id:2119361] 正是为了展示这种“共振”情形，你会发现解的结构异常简洁，只有一个模态被激发。通过这个例子，你可以直观地理解为何将源项投影到特征函数基上是如此有效。", "problem": "考虑一根长度为 $L$ 的细均匀杆，沿 $x$ 轴从 $x=0$ 放置到 $x=L$。杆内的温度分布记为 $u(x,t)$，由一维热传导方程控制。杆的热扩散系数为常数 $k$。\n\n对于所有时间 $t > 0$，杆的两端保持在零度恒温。初始时，在 $t=0$ 时刻，整根杆的温度为零。\n\n此外，杆内存在一个内部热源，该热源不随时间变化，但随空间位置变化，其函数形式为 $Q(x) = A_0 \\sin\\left(\\frac{3\\pi x}{L}\\right)$，其中 $A_0$ 是一个常数，单位为温度/单位时间。\n\n该物理场景的完整数学模型由以下非齐次偏微分方程及其相关的边界和初始条件给出：\n- **偏微分方程(PDE):** $u_t = k u_{xx} + A_0 \\sin\\left(\\frac{3\\pi x}{L}\\right)$，对于 $0 < x < L$ 和 $t > 0$。\n- **边界条件(BCs):** $u(0,t) = 0$ 和 $u(L,t) = 0$，对于 $t > 0$。\n- **初始条件(IC):** $u(x,0) = 0$，对于 $0 \\le x \\le L$。\n\n求当 $t>0$ 时的温度分布 $u(x,t)$。您的答案应为包含 $x, t, L, k,$ 和 $A_0$ 的单个闭式解析表达式。", "solution": "为求解此非齐次热传导方程，我们将使用特征函数展开法。问题定义如下：\nPDE: $u_t = k u_{xx} + A_0 \\sin\\left(\\frac{3\\pi x}{L}\\right)$\nBCs: $u(0,t) = 0$, $u(L,t) = 0$\nIC: $u(x,0) = 0$\n\n首先，我们考虑相应的齐次问题的空间部分，该问题由分离变量法产生。Sturm-Liouville 问题为 $X''(x) + \\lambda X(x) = 0$，边界条件为 $X(0)=0$ 和 $X(L)=0$。该问题的特征值和特征函数是已知的：\n特征值: $\\lambda_n = \\left(\\frac{n\\pi}{L}\\right)^2$，对于 $n=1, 2, 3, \\ldots$\n特征函数: $\\phi_n(x) = \\sin\\left(\\frac{n\\pi x}{L}\\right)$，对于 $n=1, 2, 3, \\ldots$\n\n我们假设解 $u(x,t)$ 可以展开为这些特征函数的级数形式，其系数 $T_n(t)$ 随时间变化：\n$$ u(x,t) = \\sum_{n=1}^{\\infty} T_n(t) \\phi_n(x) = \\sum_{n=1}^{\\infty} T_n(t) \\sin\\left(\\frac{n\\pi x}{L}\\right) $$\n接下来，我们将此级数代入非齐次偏微分方程中。我们计算 $u(x,t)$ 的偏导数：\n$$ u_t = \\sum_{n=1}^{\\infty} \\frac{dT_n}{dt} \\sin\\left(\\frac{n\\pi x}{L}\\right) $$\n$$ u_{xx} = \\sum_{n=1}^{\\infty} T_n(t) \\left(-\\left(\\frac{n\\pi}{L}\\right)^2 \\sin\\left(\\frac{n\\pi x}{L}\\right)\\right) = -\\sum_{n=1}^{\\infty} T_n(t) \\lambda_n \\sin\\left(\\frac{n\\pi x}{L}\\right) $$\n将这些代入偏微分方程得到：\n$$ \\sum_{n=1}^{\\infty} \\frac{dT_n}{dt} \\sin\\left(\\frac{n\\pi x}{L}\\right) = -k \\sum_{n=1}^{\\infty} \\lambda_n T_n(t) \\sin\\left(\\frac{n\\pi x}{L}\\right) + A_0 \\sin\\left(\\frac{3\\pi x}{L}\\right) $$\n整理各项，我们得到：\n$$ \\sum_{n=1}^{\\infty} \\left( \\frac{dT_n}{dt} + k \\lambda_n T_n(t) \\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) = A_0 \\sin\\left(\\frac{3\\pi x}{L}\\right) $$\n热源项 $Q(x) = A_0 \\sin\\left(\\frac{3\\pi x}{L}\\right)$ 已经是一个特征函数的形式，特别是第三个特征函数（$n=3$）。我们可以将热源项写成级数展开式：\n$$ Q(x) = \\sum_{n=1}^{\\infty} q_n \\sin\\left(\\frac{n\\pi x}{L}\\right) $$\n其中，当 $n \\neq 3$ 时，$q_n = 0$；当 $n=3$ 时，$q_3 = A_0$。\n\n根据正弦函数的正交性，我们可以对每一个 $n$ 令其系数相等：\n$$ \\frac{dT_n}{dt} + k \\lambda_n T_n(t) = q_n $$\n现在我们分两种情况求解关于 $T_n(t)$ 的这个常微分方程。\n\n情况1：$n \\neq 3$\n在这种情况下，$q_n = 0$。该常微分方程是齐次的：\n$$ \\frac{dT_n}{dt} + k \\lambda_n T_n(t) = 0 $$\n其解为 $T_n(t) = C_n \\exp(-k \\lambda_n t)$。\n\n情况2：$n = 3$\n在这种情况下，$q_3 = A_0$ 且 $\\lambda_3 = (3\\pi/L)^2$。该常微分方程是非齐次的：\n$$ \\frac{dT_3}{dt} + k \\lambda_3 T_3(t) = A_0 $$\n这是一个一阶线性常微分方程。其解是齐次解与一个特解之和。齐次解为 $T_{3,h}(t) = C_3 \\exp(-k \\lambda_3 t)$。对于特解，我们可以尝试一个常数解 $T_{3,p}(t) = P$。将其代入常微分方程得到 $0 + k \\lambda_3 P = A_0$，所以 $P = \\frac{A_0}{k \\lambda_3}$。\n$T_3(t)$ 的通解为：\n$$ T_3(t) = C_3 \\exp(-k \\lambda_3 t) + \\frac{A_0}{k \\lambda_3} $$\n现在我们应用初始条件 $u(x,0)=0$。\n$$ u(x,0) = \\sum_{n=1}^{\\infty} T_n(0) \\sin\\left(\\frac{n\\pi x}{L}\\right) = 0 $$\n这意味着对于所有的 $n$，$T_n(0) = 0$。\n\n对于 $n \\neq 3$，$T_n(0) = C_n \\exp(0) = C_n$。因此，$C_n = 0$，这意味着对于所有 $n \\neq 3$，$T_n(t) = 0$。\n\n对于 $n=3$，我们有：\n$$ T_3(0) = C_3 \\exp(0) + \\frac{A_0}{k \\lambda_3} = C_3 + \\frac{A_0}{k \\lambda_3} = 0 $$\n这得到 $C_3 = -\\frac{A_0}{k \\lambda_3}$。\n将 $C_3$ 代回到 $T_3(t)$ 的解中：\n$$ T_3(t) = -\\frac{A_0}{k \\lambda_3} \\exp(-k \\lambda_3 t) + \\frac{A_0}{k \\lambda_3} = \\frac{A_0}{k \\lambda_3} (1 - \\exp(-k \\lambda_3 t)) $$\n现在，我们代入 $\\lambda_3 = \\left(\\frac{3\\pi}{L}\\right)^2$ 的值：\n$$ T_3(t) = \\frac{A_0}{k \\left(\\frac{3\\pi}{L}\\right)^2} \\left(1 - \\exp\\left(-k \\left(\\frac{3\\pi}{L}\\right)^2 t\\right)\\right) = \\frac{A_0 L^2}{9 \\pi^2 k} \\left(1 - \\exp\\left(-\\frac{9 \\pi^2 k t}{L^2}\\right)\\right) $$\n由于对于所有 $n \\neq 3$，$T_n(t)=0$，因此 $u(x,t)$ 的级数解坍缩为只有 $n=3$ 这一项：\n$$ u(x,t) = T_3(t) \\sin\\left(\\frac{3\\pi x}{L}\\right) $$\n最后，代入 $T_3(t)$ 的表达式，我们得到最终解：\n$$ u(x,t) = \\frac{A_0 L^2}{9 \\pi^2 k} \\left(1 - \\exp\\left(-\\frac{9 \\pi^2 k t}{L^2}\\right)\\right) \\sin\\left(\\frac{3\\pi x}{L}\\right) $$", "answer": "$$\\boxed{\\frac{A_0 L^{2}}{9 \\pi^{2} k} \\left(1 - \\exp\\left(-\\frac{9 \\pi^{2} k t}{L^{2}}\\right)\\right) \\sin\\left(\\frac{3 \\pi x}{L}\\right)}$$", "id": "2119361"}, {"introduction": "在现实世界中，热源或外力的形式很少会恰好是单个纯粹的特征函数。更常见的情况是，它们是需要被分解的更复杂的函数。\n\n这个练习 [@problem_id:2119353] 将我们带入一个更实际的场景：在一个具有周期性边界条件的环形杆上，求解一个由函数 $A \\sin^2(x)$ 描述的热源引起的稳态温度分布。你需要做的关键一步，就是将这个源函数表示为特征函数（在这里是傅里叶级数）的线性组合。", "problem": "一根周长为 $2\\pi$ 的均匀细圆环受到外部热源加热。该圆环同时向周围环境散热。系统已达到稳态，其温度分布 $u(x)$ 可以在区间 $x \\in [-\\pi, \\pi]$ 上描述，其中 $x$ 表示沿圆环的角位置。\n\n稳态温度满足以下一维非齐次微分方程：\n$$ -u''(x) + \\beta u(x) = F(x) $$\n其中 $u''(x)$ 是温度 $u$ 关于位置 $x$ 的二阶导数。项 $\\beta u(x)$ 描述了牛顿冷却，其中 $\\beta$ 是一个代表散热率的正常数。函数 $F(x) = A \\sin^2(x)$ 描述了与位置相关的热源，其中 $A$ 是一个代表热源强度的正常数。\n\n由于圆环的环形特性，温度分布必须满足周期性边界条件：\n$$ u(-\\pi) = u(\\pi) \\quad \\text{和} \\quad u'(-\\pi) = u'(\\pi) $$\n确定稳态温度分布 $u(x)$，并将其表示为关于 $x$、$A$ 和 $\\beta$ 的函数。", "solution": "我们寻求线性常微分方程\n$$ -u''(x)+\\beta u(x)=F(x), \\quad F(x)=A\\sin^{2}(x) $$\n的一个稳态、周期为 $2\\pi$ 的解 $u(x)$。该方程满足周期性边界条件 $u(-\\pi)=u(\\pi)$ 和 $u'(-\\pi)=u'(\\pi)$，其中 $\\beta>0$。\n\n首先，使用三角恒等式来表示强迫项：\n$$ \\sin^{2}(x)=\\frac{1-\\cos(2x)}{2} \\quad \\Rightarrow \\quad F(x)=\\frac{A}{2}-\\frac{A}{2}\\cos(2x) $$\n根据 $F(x)$ 的谐波形式，我们寻找一个形如\n$$ u_{p}(x)=c_{0}+c_{2}\\cos(2x) $$\n的特解。\n\n计算其导数：\n$$ u'_{p}(x)=-2c_{2}\\sin(2x), \\quad u''_{p}(x)=-4c_{2}\\cos(2x) $$\n将其代入常微分方程：\n$$ -(-4c_{2}\\cos(2x))+\\beta(c_{0}+c_{2}\\cos(2x))=\\frac{A}{2}-\\frac{A}{2}\\cos(2x) $$\n匹配常数项和 $\\cos(2x)$ 项的系数：\n$$ \\beta c_{0}=\\frac{A}{2} \\quad \\Rightarrow \\quad c_{0}=\\frac{A}{2\\beta} $$\n$$ (4+\\beta)c_{2}=-\\frac{A}{2} \\quad \\Rightarrow \\quad c_{2}=-\\frac{A}{2(4+\\beta)} $$\n因此，一个特解是\n$$ u_{p}(x)=\\frac{A}{2\\beta}-\\frac{A}{2(4+\\beta)}\\cos(2x) $$\n齐次方程 $-u''+\\beta u=0$ 的解为\n$$ u_{h}(x)=C_{1}\\exp(\\sqrt{\\beta}\\,x)+C_{2}\\exp(-\\sqrt{\\beta}\\,x) $$\n应用周期性条件 $u_{h}(\\pi)=u_{h}(-\\pi)$，可得 $C_{1}=C_{2}$。应用条件 $u'_{h}(\\pi)=u'_{h}(-\\pi)$，可得 $C_{1}=-C_{2}$。由于 $\\beta>0$ 意味着 $\\exp(\\sqrt{\\beta}\\,\\pi)\\neq \\exp(-\\sqrt{\\beta}\\,\\pi)$，这些条件迫使 $C_{1}=C_{2}=0$。因此，存在唯一的周期为 $2\\pi$ 的解，即为上述的特解。\n\n因此，稳态温度分布为\n$$ u(x)=\\frac{A}{2\\beta}-\\frac{A}{2(4+\\beta)}\\cos(2x) $$\n此函数是周期为 $2\\pi$ 的，并且同时满足该常微分方程和周期性边界条件。", "answer": "$$\\boxed{\\frac{A}{2\\beta}-\\frac{A}{2(4+\\beta)}\\cos(2x)}$$", "id": "2119353"}, {"introduction": "我们已经学习了如何运用“正确”的特征函数基来解题，但一个自然的问题是：如果我们选用一个“不正确”但看似方便的基，会发生什么？例如，为一个具有混合边界条件的问题选用傅里叶正弦级数（它对应于两端都为狄利克雷边界条件的情形）。\n\n这个富有挑战性的练习 [@problem_id:2119366] 将引导你探索这个“假设”情景的后果。你将推导出，这种不匹配的选择会导致一个无限耦合的常微分方程组，从而揭示了为什么选择与边界条件相适应的特征函数基是如此关键——它能将空间算子对角化，从而使问题解耦。", "problem": "考虑一根长度为 $L$ 的细杆中的一维热传导。温度分布 $u(x,t)$ 由以下热方程描述：\n$$ \\frac{\\partial u}{\\partial t} = \\frac{\\partial^2 u}{\\partial x^2} + Q_0 $$\n其中 $x \\in (0, L)$ 且 $t > 0$。此处，$Q_0$ 是一个表示均匀热源的正常数。杆的初始温度为零，即 $u(x,0)=0$。\n\n边界条件是混合类型的。$x=0$ 处的一端保持零温：\n$$ u(0,t) = 0 $$\n$x=L$ 处的一端受到向零温环境的对流冷却，由一个罗宾边界条件描述：\n$$ \\frac{\\partial u}{\\partial x}(L,t) + h u(L,t) = 0 $$\n其中 $h$ 是一个正的传热系数。\n\n解决此问题的标准方法涉及特征函数展开。然而，我们不使用与给定边界条件下的空间算子相对应的特征函数，而是选择使用傅里叶正弦级数来表示解，这些正弦级数是两端均为狄利克雷条件的问题的特征函数：\n$$ u(x,t) = \\sum_{n=1}^{\\infty} c_n(t) \\sin\\left(\\frac{n\\pi x}{L}\\right) $$\n使用这种非标准基应用特征函数展开法，将偏微分方程转换为关于系数 $c_m(t)$ 的一个无穷常微分方程组。对于每个 $m=1, 2, 3, \\ldots$，该方程组可以写为：\n$$ \\frac{d c_m}{dt} = -\\left(\\frac{m\\pi}{L}\\right)^2 c_m(t) + S_m + C_m(t) $$\n在此方程中，$S_m$ 是来自恒定源项 $Q_0$ 的贡献，而 $C_m(t)$ 是一个耦合项，其产生的原因是所选的正弦基函数不满足 $x=L$ 处的罗宾边界条件。该项将 $c_m(t)$ 的方程与所有其他系数 $c_n(t)$ 耦合起来。\n\n您的任务是推导这个耦合项 $C_m(t)$ 的表达式。最终表达式应以 $h$、$L$ 和系数 $c_n(t)$ 表示。为简洁起见，您可以使用记号 $k_n = \\frac{n\\pi}{L}$。", "solution": "令 $s_{n}(x)=\\sin(k_{n}x)$，其中 $k_{n}=\\frac{n\\pi}{L}$，并记 $u(x,t)=\\sum_{n=1}^{\\infty}c_{n}(t)s_{n}(x)$。将偏微分方程乘以 $s_{m}(x)$ 并在 $(0,L)$ 上积分：\n$$ \\int_{0}^{L}u_{t}s_{m}\\,dx=\\int_{0}^{L}u_{xx}s_{m}\\,dx+\\int_{0}^{L}Q_{0}s_{m}\\,dx $$\n利用正交性 $\\int_{0}^{L}s_{n}s_{m}\\,dx=\\frac{L}{2}\\delta_{mn}$，左侧为\n$$ \\int_{0}^{L}u_{t}s_{m}\\,dx=\\frac{L}{2}\\frac{dc_{m}}{dt} $$\n对于拉普拉斯项，进行两次分部积分：\n$$ \\int_{0}^{L}u_{xx}s_{m}\\,dx=\\big[u_{x}s_{m}\\big]_{0}^{L}-\\int_{0}^{L}u_{x}s_{m}'\\,dx = \\big[u_{x}s_{m}\\big]_{0}^{L}-\\big[us_{m}'\\big]_{0}^{L}+\\int_{0}^{L}us_{m}''\\,dx $$\n由于 $s_{m}(0)=s_{m}(L)=0$ 且 $u(0,t)=0$，边界项简化为\n$$ \\big[u_{x}s_{m}\\big]_{0}^{L}-\\big[us_{m}'\\big]_{0}^{L}=-u(L,t)s_{m}'(L) $$\n且 $s_{m}''=-k_{m}^{2}s_{m}$ 给出\n$$ \\int_{0}^{L}u_{xx}s_{m}\\,dx=-u(L,t)s_{m}'(L)-k_{m}^{2}\\int_{0}^{L}us_{m}\\,dx = -u(L,t)k_{m}(-1)^{m}-k_{m}^{2}\\frac{L}{2}c_{m}(t) $$\n因为 $s_{m}'(L)=k_{m}\\cos(k_{m}L)=k_{m}(-1)^{m}$。因此，\n$$ \\frac{L}{2}\\frac{dc_{m}}{dt}=-k_{m}^{2}\\frac{L}{2}c_{m}(t)-k_{m}(-1)^{m}u(L,t)+\\int_{0}^{L}Q_{0}s_{m}\\,dx $$\n所以\n$$ \\frac{dc_{m}}{dt}=-k_{m}^{2}c_{m}(t)-\\frac{2k_{m}}{L}(-1)^{m}u(L,t)+\\frac{2}{L}\\int_{0}^{L}Q_{0}s_{m}\\,dx $$\n因此耦合项为\n$$ C_{m}(t)=-\\frac{2k_{m}}{L}(-1)^{m}u(L,t) $$\n使用罗宾边界条件 $u_{x}(L,t)+h\\,u(L,t)=0$ 来消去 $u(L,t)$。从展开式可知，\n$$ u_{x}(x,t)=\\sum_{n=1}^{\\infty}c_{n}(t)k_{n}\\cos(k_{n}x) \\quad \\Rightarrow \\quad u_{x}(L,t)=\\sum_{n=1}^{\\infty}c_{n}(t)k_{n}\\cos(n\\pi)=\\sum_{n=1}^{\\infty}c_{n}(t)k_{n}(-1)^{n} $$\n因此\n$$ \\sum_{n=1}^{\\infty}c_{n}(t)k_{n}(-1)^{n}+h\\,u(L,t)=0 \\quad \\Rightarrow \\quad u(L,t)=-\\frac{1}{h}\\sum_{n=1}^{\\infty}k_{n}(-1)^{n}c_{n}(t) $$\n代入 $C_{m}(t)$ 得\n$$ C_{m}(t)=\\frac{2k_{m}}{hL}\\sum_{n=1}^{\\infty}(-1)^{m+n}k_{n}\\,c_{n}(t) $$\n这就是所求的以 $h$、$L$ 和系数 $c_{n}(t)$ 表示的耦合项。", "answer": "$$\\boxed{C_{m}(t)=\\frac{2k_{m}}{hL}\\sum_{n=1}^{\\infty}(-1)^{m+n}k_{n}\\,c_{n}(t)}$$", "id": "2119366"}]}