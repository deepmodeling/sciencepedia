{"hands_on_practices": [{"introduction": "我们从一个基本问题开始，来掌握特征线法的核心步骤。这个练习求解一个一阶线性齐次偏微分方程，它描述了一个量在没有外部源或汇的情况下如何被输运。通过解决这个问题 [@problem_id:12413]，你将学会如何将偏微分方程转化为一组常微分方程，从而找到所谓的特征曲线，并利用初始条件来确定最终的解。", "problem": "设 $a$ 和 $b$ 为非零实常数。一个标量场 $u(x, y)$ 由以下一阶、线性、齐次偏微分方程 (PDE) 描述：\n$$a \\frac{\\partial u}{\\partial x} + b \\frac{\\partial u}{\\partial y} = 0$$\n此方程意味着函数 $u$ 在 $xy$ 平面中的某些直线上是常数，这些直线被称为特征曲线。\n\n给定沿 $y$ 轴的辅助条件：\n$$u(0, y) = \\sin(y)$$\n使用特征线法，求出同时满足该偏微分方程和给定初始条件的特解 $u(x, y)$。", "solution": "我们寻求满足以下条件的 $u(x,y)$\n$$a\\,u_x+b\\,u_y=0$$\n及其辅助条件\n$$u(0,y)=\\sin(y)\\,. $$\n\n1. 特征常微分方程。沿着曲线 $(x(s),y(s))$，我们要求\n$$\\frac{dx}{ds}=a,\\quad \\frac{dy}{ds}=b,\\quad \\frac{du}{ds}=a\\,u_x+b\\,u_y=0.$$\n因此 $u$ 沿着这些曲线是常数。\n\n2. 对前两个方程积分：\n$$x(s)=a\\,s+x_0,\\quad y(s)=b\\,s+y_0.$$\n消去 $s$ 以找到不变量。解出 $s=(x-x_0)/a$ 并代入 $y$ 中：\n$$y-y_0=b\\frac{x-x_0}{a}\\quad\\Longrightarrow\\quad b x-a y=\\bigl(b x_0-a y_0\\bigr)\\equiv C.$$\n因此，通解为\n$$u(x,y)=f\\bigl(bx-ay\\bigr)$$\n其中 $f$ 是某个函数。\n\n3. 应用初始条件。沿 $x=0$，我们有 $u(0,y)=f(-a y)=\\sin(y)$。因此\n$$f(z)=\\sin\\!\\bigl(-z/a\\bigr)=-\\sin\\!\\bigl(z/a\\bigr).$$\n所以\n$$u(x,y)=f\\bigl(bx-ay\\bigr)\n=-\\sin\\!\\Bigl(\\frac{bx-ay}{a}\\Bigr)\n=\\sin\\!\\Bigl(y-\\frac{b}{a}x\\Bigr)\\,. $$\n\n这同时满足了偏微分方程和 $u(0,y)=\\sin(y)$。", "answer": "$$\\boxed{\\sin\\!\\bigl(y-\\tfrac{b}{a}x\\bigr)}$$", "id": "12413"}, {"introduction": "在掌握了基本情况后，我们现在来处理一个更复杂的场景：一个具有可变系数和衰减项的线性输运方程。这意味着特征线不再是直线，并且被输运的量 $f$ 的值会沿着其路径发生变化。这个问题 [@problem_id:1144919] 精彩地展示了特征线法的灵活性，因为它需要结合使用积分因子法来求解沿特征线的常微分方程。", "problem": "考虑一个标量 $f(x,t)$ 在一维空间 $x$ 和时间 $t$ 中的输运。该量的演化由以下一阶线性偏微分方程（PDE）描述：\n$$\n\\partial_t f + (t^2+1) \\partial_x f = -t f\n$$\n在时间 $t=0$ 时，该量的初始分布由以下条件给出：\n$$\nf(x,0) = x^2\n$$\n该偏微分方程可以使用特征线法求解，该方法将 PDE 转化为一个常微分方程组（ODEs）。其中一个描述 $f$ 沿特征曲线演化的常微分方程是一个线性一阶常微分方程，可以使用积分因子法求解。\n\n你的任务是求出解 $f(x,t)$ 在特定时空点 $(x,t) = (2,1)$ 处的值。", "solution": "我们要求解以下一阶偏微分方程（PDE）\n$$\n\\partial_t f + (t^2+1) \\partial_x f = -t f\n$$\n其初始条件为 $f(x,0) = x^2$，然后在点 $(x,t)=(2,1)$ 处计算解的值。我们将使用特征线法。\n\n由参数 $s$ 参数化的特征曲线 $(x(s), t(s))$ 由以下常微分方程组（ODEs）定义：\n$$\n\\frac{dt}{ds} = 1\n$$\n$$\n\\frac{dx}{ds} = t^2+1\n$$\n沿着这些曲线，解 $f$ 的值（记为 $z(s) = f(x(s), t(s))$）根据以下方式演化：\n$$\n\\frac{dz}{ds} = \\frac{\\partial f}{\\partial t}\\frac{dt}{ds} + \\frac{\\partial f}{\\partial x}\\frac{dx}{ds} = \\partial_t f + (t^2+1) \\partial_x f\n$$\n根据给定的 PDE，右侧等于 $-tf$。因此，$z(s)$ 的常微分方程为：\n$$\n\\frac{dz}{ds} = -t f = -t(s) z(s)\n$$\n\n首先，我们求解特征曲线。\n由 $\\frac{dt}{ds} = 1$，通过设定初始条件 $t(s=0) = 0$，我们可以选择参数化 $s=t$。所以，$t(s)=s$。\n\n现在，将 $t=s$ 代入 $x(s)$ 的常微分方程中：\n$$\n\\frac{dx}{ds} = s^2+1\n$$\n我们对这个方程关于 $s$ 进行积分。设特征曲线在 $s=0$ 时通过点 $(x_0, 0)$。这意味着 $x(0) = x_0$。\n$$\n\\int_{x_0}^{x(s)} dx' = \\int_0^s (\\sigma^2+1) d\\sigma\n$$\n$$\nx(s) - x_0 = \\left[\\frac{\\sigma^3}{3} + \\sigma\\right]_0^s = \\frac{s^3}{3} + s\n$$\n所以，从 $(x_0, 0)$ 出发的特征曲线由以下方程描述：\n$$\nx(s) = x_0 + \\frac{s^3}{3} + s\n$$\n\n接下来，我们求解沿这些曲线的 $z(s)$ 的常微分方程。当 $t(s)=s$ 时，该常微分方程变为：\n$$\n\\frac{dz}{ds} = -s z(s)\n$$\n这是一个一阶线性常微分方程。我们可以将其重写为标准形式：\n$$\n\\frac{dz}{ds} + s z(s) = 0\n$$\n为了求解该方程，我们使用积分因子 $I(s)$，其由下式给出：\n$$\nI(s) = \\exp\\left(\\int s \\, ds\\right) = \\exp\\left(\\frac{s^2}{2}\\right)\n$$\n将常微分方程乘以积分因子，我们得到：\n$$\n\\exp\\left(\\frac{s^2}{2}\\right) \\frac{dz}{ds} + s \\exp\\left(\\frac{s^2}{2}\\right) z(s) = 0\n$$\n左边是乘积 $z(s)I(s)$ 的导数：\n$$\n\\frac{d}{ds}\\left(z(s) \\exp\\left(\\frac{s^2}{2}\\right)\\right) = 0\n$$\n关于 $s$ 积分，得到：\n$$\nz(s) \\exp\\left(\\frac{s^2}{2}\\right) = C\n$$\n其中 $C$ 是积分常数。因此，$z(s)$ 的解为：\n$$\nz(s) = C \\exp\\left(-\\frac{s^2}{2}\\right)\n$$\n常数 $C$ 由初始条件确定。在 $s=0$ 时，我们有 $t=0$ 和 $x=x_0$。$z$ 的值为：\n$$\nz(0) = f(x(0), t(0)) = f(x_0, 0)\n$$\n使用给定的初始条件 $f(x,0) = x^2$，我们有：\n$$\nz(0) = x_0^2\n$$\n另一方面，从我们得到的 $z(s)$ 的解中：\n$$\nz(0) = C \\exp(0) = C\n$$\n因此，常数 $C = x_0^2$。沿特征线的 $f$ 的解为：\n$$\nz(s) = x_0^2 \\exp\\left(-\\frac{s^2}{2}\\right)\n$$\n为了找到解 $f(x,t)$，我们将 $x_0$ 用 $x$ 和 $t$ 表示。我们有以下关系：\n$$\nt = s\n$$\n$$\nx = x_0 + \\frac{s^3}{3} + s = x_0 + \\frac{t^3}{3} + t\n$$\n求解 $x_0$：\n$$\nx_0 = x - t - \\frac{t^3}{3}\n$$\n将 $x_0$ 的表达式和 $s=t$ 代入 $z(s)$ 的解中，我们得到解 $f(x,t)$：\n$$\nf(x,t) = \\left(x - t - \\frac{t^3}{3}\\right)^2 \\exp\\left(-\\frac{t^2}{2}\\right)\n$$\n最后，我们在点 $(x,t)=(2,1)$ 处计算该解的值：\n$$\nf(2,1) = \\left(2 - 1 - \\frac{1^3}{3}\\right)^2 \\exp\\left(-\\frac{1^2}{2}\\right)\n$$\n$$\nf(2,1) = \\left(1 - \\frac{1}{3}\\right)^2 \\exp\\left(-\\frac{1}{2}\\right)\n$$\n$$\nf(2,1) = \\left(\\frac{2}{3}\\right)^2 e^{-1/2}\n$$\n$$\nf(2,1) = \\frac{4}{9} e^{-1/2}\n$$", "answer": "$$\n\\boxed{\\frac{4}{9}e^{-1/2}}\n$$", "id": "1144919"}, {"introduction": "前面的练习处理的是线性方程，其特征线永不相交。现在，我们将注意力转向非线性方程，这是理解许多物理系统的关键一步。对于非线性守恒律 [@problem_id:2092003]，特征线的速度取决于解 $u$ 本身，这可能导致特征线发生碰撞，形成不连续的解，即“激波”。这个练习的目标不仅是求解，更是要预测平滑解何时会失效以及激波何时形成，从而将数学方法与重要的物理现象联系起来。", "problem": "考虑一个一维系统，其中一个表示物理密度的标量 $u(x,t)$ 由非线性输运方程 $u_t + (u^2 - u)_x = 0$ 所支配。该方程是一条守恒律，描述了密度 $u$ 如何在时间 $t$ 和空间 $x$ 中演化。\n\n在时间 $t=0$ 时，系统具有一个由初始条件 $u(x,0) = -mx$ 给出的线性密度分布，该条件对所有实数 $x$ 成立。其中 $m$ 是一个正常数，表示初始密度梯度的大小。\n\n由于输运方程的非线性，密度分布会随时间变陡，最终导致形成一个间断，或称“激波”，在此处密度梯度变为无穷大。确定该激波首次形成的时间 $t_b$。请用含常数 $m$ 的符号表达式来表示你的答案。", "solution": "我们考虑标量守恒律 $u_{t} + \\left(u^{2} - u\\right)_{x} = 0$，其初始数据为 $u(x,0) = - m x$（其中 $m > 0$）。令通量为 $f(u) = u^{2} - u$。对于光滑解，该守恒律等价于拟线性方程\n$$\nu_{t} + f'(u)\\,u_{x} = 0, \\quad \\text{其中} \\quad f'(u) = 2u - 1.\n$$\n使用特征线法，沿着一条由其在 $t=0$ 处的基点 $x_{0}$ 参数化的特征曲线，我们有\n$$\n\\frac{d}{dt} u(x(t),t) = 0 \\quad \\Rightarrow \\quad u(x(t),t) = u_{0}(x_{0}) = - m x_{0},\n$$\n且特征速度满足\n$$\n\\frac{dx}{dt} = f'(u) = 2u - 1 = 2(- m x_{0}) - 1 = - 2 m x_{0} - 1,\n$$\n该速度沿特征线为常数。对时间积分，并利用 $x(0) = x_{0}$，得到\n$$\nx(t) = x_{0} + \\left(- 2 m x_{0} - 1\\right) t = x_{0} \\left(1 - 2 m t\\right) - t.\n$$\n因此，在时间 $t$ 的拉格朗日-欧拉映射 $x_{0} \\mapsto x$ 为\n$$\nx = x_{0} \\left(1 - 2 m t\\right) - t.\n$$\n当特征线相交时，激波首次形成，这发生在该映射不再是一对一的时候。最早的发生时间由其对 $x_{0}$ 的导数为零来确定：\n$$\n\\frac{\\partial x}{\\partial x_{0}} = 1 - 2 m t = 0 \\quad \\Rightarrow \\quad t_{b} = \\frac{1}{2 m}.\n$$\n对于 $m > 0$，此值为正，因此是首次激波时间。（等价地，使用 $u_{t} + a(u) u_{x} = 0$ 的一般公式，其中 $a(u) = f'(u)$，可得 $\\partial x/\\partial x_{0} = 1 + a'(u_{0}) u_{0}' t$。此处 $a'(u) = f''(u) = 2$ 且 $u_{0}' = - m$，代入即得 $\\partial x/\\partial x_{0} = 1 - 2 m t$ 和相同的 $t_{b}$。）", "answer": "$$\\boxed{\\frac{1}{2 m}}$$", "id": "2092003"}]}