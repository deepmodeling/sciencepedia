{"hands_on_practices": [{"introduction": "程函方程的威力不仅在于描述波前，还在于它能推导出描述光线路径的特征方程。本练习将引导你运用一种强大的射线方程形式，解决一个在光学中至关重要的经典问题：光在梯度折射率（GRIN）介质中的传播。通过这个实践，你将亲手揭示抛物线形的折射率分布如何导致光线呈现优美的正弦轨迹，这是光纤通信等领域的一项核心原理。[@problem_id:1031275]", "problem": "在非均匀介质中，光线的传播可以用程函方程 $(\\nabla S)^2 = n^2(\\mathbf{r})$ 来描述，其中 $S(\\mathbf{r})$ 是光程（程函），$n(\\mathbf{r})$ 是与位置相关的折射率。光线的轨迹 $\\mathbf{r}(\\tau)$ 可以通过求解与程函方程相关的特征方程得到。这些方程可以写成类似于经典力学中 Hamilton 方程的形式。射线方程的一个便捷形式是\n$$\n\\frac{d^2\\mathbf{r}}{d\\tau^2} = \\frac{1}{2}\\nabla(n^2(\\mathbf{r}))\n$$\n其中 $\\tau$ 是沿射线路径的一个参数，通过 $ds = n(\\mathbf{r}) d\\tau$ 与弧长 $s$ 相关联。定义为 $\\mathbf{p} = d\\mathbf{r}/d\\tau$ 的射线动量，其大小的平方等于局域折射率的平方，即 $|\\mathbf{p}|^2 = n^2(\\mathbf{r})$。\n\n考虑一束光线在二维介质（$y-z$ 平面）中传播，其中折射率与 $z$ 无关。折射率的平方由一个抛物线分布给出：\n$$\nn(y)^2 = n_0^2(1 - \\alpha^2 y^2)\n$$\n其中 $n_0$ 和 $\\alpha$ 是正常数。\n\n一条光线从原点 $(y=0, z=0)$ 射入介质。其初始方向与 $z$ 轴正方向成 $\\theta_0$ 角，其中 $0 \\le \\theta_0 < \\pi/2$。\n\n使用上面给出的射线方程，确定该光线在介质中传播时的轨迹 $y(z)$。", "solution": "我们需要求解在给定折射率分布 $n(y)^2 = n_0^2(1 - \\alpha^2 y^2)$ 下的射线路径 $y(z)$。光线从 $(y,z) = (0,0)$ 点出发，与 $z$ 轴的初始夹角为 $\\theta_0$。\n\n射线路径 $\\mathbf{r}(\\tau) = (y(\\tau), z(\\tau))$ 的控制方程是\n$$\n\\frac{d^2\\mathbf{r}}{d\\tau^2} = \\frac{1}{2}\\nabla(n^2(\\mathbf{r}))\n$$\n\n首先，我们计算 $n^2$ 的梯度。由于 $n^2$ 仅依赖于 $y$，其梯度只有 $y$ 分量：\n$$\n\\nabla(n^2(y)) = \\left(\\frac{\\partial(n^2)}{\\partial y}, \\frac{\\partial(n^2)}{\\partial z}\\right) = \\left(\\frac{d}{dy}[n_0^2(1 - \\alpha^2 y^2)], 0\\right) = (-2n_0^2\\alpha^2 y, 0)\n$$\n\n矢量射线方程可以分解为分量形式：\n对于 $y$ 分量：\n$$\n\\frac{d^2y}{d\\tau^2} = \\frac{1}{2}(-2n_0^2\\alpha^2 y) = -n_0^2\\alpha^2 y\n$$\n这可以被改写为标准的简谐振动方程：\n$$\n\\frac{d^2y}{d\\tau^2} + (n_0\\alpha)^2 y = 0\n$$\n对于 $z$ 分量：\n$$\n\\frac{d^2z}{d\\tau^2} = 0\n$$\n\n这些常微分方程的通解为：\n$$\ny(\\tau) = A \\cos(n_0\\alpha\\tau) + B \\sin(n_0\\alpha\\tau)\n$$\n$$\nz(\\tau) = C\\tau + D\n$$\n其中 $A, B, C, D$ 是由初始条件确定的积分常数。\n\n初始条件在出发点给出，我们可以设定此刻 $\\tau=0$。\n$\\tau=0$ 时的位置：$y(0)=0$ 且 $z(0)=0$。\n$$\ny(0) = A \\cos(0) + B \\sin(0) = A = 0\n$$\n$$\nz(0) = C(0) + D = D = 0\n$$\n因此解简化为：\n$$\ny(\\tau) = B \\sin(n_0\\alpha\\tau)\n$$\n$$\nz(\\tau) = C\\tau\n$$\n\n接下来，我们使用初始速度/动量条件。射线动量为 $\\mathbf{p} = d\\mathbf{r}/d\\tau = (dy/d\\tau, dz/d\\tau)$。其大小的平方为 $p^2 = n^2$。在出发点 $(y=0, z=0)$，折射率为 $n(0) = \\sqrt{n_0^2(1-0)} = n_0$。因此，初始动量的大小为 $|\\mathbf{p}_0| = n_0$。\n\n光线以与 $z$ 轴成 $\\theta_0$ 角的方向发射。初始动量矢量 $\\mathbf{p}_0 = (p_{y0}, p_{z0})$ 的分量为：\n$$\np_{y0} = \\frac{dy}{d\\tau}\\Big|_{\\tau=0} = |\\mathbf{p}_0| \\sin\\theta_0 = n_0 \\sin\\theta_0\n$$\n$$\np_{z0} = \\frac{dz}{d\\tau}\\Big|_{\\tau=0} = |\\mathbf{p}_0| \\cos\\theta_0 = n_0 \\cos\\theta_0\n$$\n\n我们可以用这些条件来求出剩下的常数 $B$ 和 $C$。\n根据我们关于 $y(\\tau)$ 的解：\n$$\n\\frac{dy}{d\\tau} = B n_0\\alpha \\cos(n_0\\alpha\\tau)\n$$\n在 $\\tau=0$ 时：\n$$\n\\frac{dy}{d\\tau}\\Big|_{\\tau=0} = B n_0\\alpha = n_0 \\sin\\theta_0 \\implies B = \\frac{\\sin\\theta_0}{\\alpha}\n$$\n根据我们关于 $z(\\tau)$ 的解：\n$$\n\\frac{dz}{d\\tau} = C\n$$\n在 $\\tau=0$ 时：\n$$\n\\frac{dz}{d\\tau}\\Big|_{\\tau=0} = C = n_0 \\cos\\theta_0\n$$\n\n将常数代回轨迹的参数方程，得到：\n$$\ny(\\tau) = \\frac{\\sin\\theta_0}{\\alpha} \\sin(n_0\\alpha\\tau)\n$$\n$$\nz(\\tau) = (n_0\\cos\\theta_0)\\tau\n$$\n\n问题要求的是路径 $y$ 作为 $z$ 的函数。我们可以消去参数 $\\tau$。从关于 $z(\\tau)$ 的方程中，我们解出 $\\tau$：\n$$\n\\tau = \\frac{z}{n_0\\cos\\theta_0}\n$$\n现在，将这个 $\\tau$ 的表达式代入 $y(\\tau)$ 的方程中：\n$$\ny(z) = \\frac{\\sin\\theta_0}{\\alpha} \\sin\\left(n_0\\alpha \\left(\\frac{z}{n_0\\cos\\theta_0}\\right)\\right)\n$$\n简化正弦函数的自变量，得到最终结果：\n$$\ny(z) = \\frac{\\sin\\theta_0}{\\alpha} \\sin\\left(\\frac{\\alpha z}{\\cos\\theta_0}\\right)\n$$", "answer": "$$\n\\boxed{y(z) = \\frac{\\sin\\theta_0}{\\alpha} \\sin\\left(\\frac{\\alpha z}{\\cos\\theta_0}\\right)}\n$$", "id": "1031275"}, {"introduction": "直接求解射线方程并非总是最便捷的途径，尤其是在处理具有对称性的系统时，守恒定律往往能提供更巧妙的解法。本练习将带你探索一个具有旋转对称性的介质，其中光线的传播遵循布格定律（Bouguer's law），这是连续介质中斯涅尔定律的一种形式。你将学会如何利用这一守恒量来简化问题，并最终推导出一个双曲线形状的独特光线路径。[@problem_id:2140976]", "problem": "一条光线在二维非均匀介质中传播。介质在任意点 $(x,y)$ 的折射率 $n$ 由其到原点的距离 $r = \\sqrt{x^2+y^2}$ 决定，遵循关系式 $n(r) = k r$，其中 $k$ 是一个正常数。该光线从初始点 $(x_0, 0)$ 发射，其中 $x_0 > 0$。其初始速度矢量平行于 y 轴正方向。求该光线轨迹的笛卡尔方程，将坐标 $y$ 表示为坐标 $x$ 的函数。最终表达式应只包含 $x$ 和 $x_0$。", "solution": "设 $r=\\sqrt{x^{2}+y^{2}}$ 且 $n(r)=k r$，其中 $k>0$。因为 $n$ 仅依赖于 $r$，所以该介质是旋转对称的，适用布格定律（Bouguer’s law，即旋转对称下的诺特不变量）：对于任意光线，物理量\n$$\nn(r)\\,r\\,\\sin\\chi\n$$\n沿轨迹守恒，其中 $\\chi$ 是光线方向（单位切向量）与径向之间的夹角。\n\n在发射点 $(x_{0},0)$ 处，我们有 $r_{0}=x_{0}$。此处的径向是 $+x$ 方向，而光线沿 $+y$ 方向发射，因此光线与径向之间的夹角为 $\\chi_{0}=\\frac{\\pi}{2}$，于是 $\\sin\\chi_{0}=1$。因此，守恒量为\n$$\nn(r_{0})\\,r_{0}\\,\\sin\\chi_{0} = k x_{0}\\cdot x_{0}\\cdot 1 = k x_{0}^{2}.\n$$\n因此，沿着光线，\n$$\nn(r)\\,r\\,\\sin\\chi = k x_{0}^{2}.\n$$\n代入 $n(r)=k r$，上式可简化为\n$$\nk r^{2}\\sin\\chi = k x_{0}^{2} \\quad\\Longrightarrow\\quad \\sin\\chi = \\frac{x_{0}^{2}}{r^{2}}.\n$$\n\n为位置矢量引入极角 $\\varphi=\\arctan\\!\\left(\\frac{y}{x}\\right)$。极坐标下的运动学给出\n$$\n\\frac{dr}{ds}=\\cos\\chi,\\qquad \\frac{d\\varphi}{ds}=\\frac{\\sin\\chi}{r},\n$$\n其中 $s$ 是弧长。因此\n$$\n\\frac{d\\varphi}{dr}=\\frac{\\frac{d\\varphi}{ds}}{\\frac{dr}{ds}}=\\frac{\\sin\\chi/r}{\\cos\\chi}\n=\\frac{1}{r}\\tan\\chi\n=\\frac{1}{r}\\,\\frac{\\sin\\chi}{\\sqrt{1-\\sin^{2}\\chi}}\n=\\frac{1}{r}\\,\\frac{\\frac{x_{0}^{2}}{r^{2}}}{\\sqrt{1-\\frac{x_{0}^{4}}{r^{4}}}}\n=\\frac{x_{0}^{2}}{r^{3}\\sqrt{1-\\frac{x_{0}^{4}}{r^{4}}}}.\n$$\n令 $u=\\frac{x_{0}^{2}}{r^{2}}$，则 $\\sqrt{1-\\frac{x_{0}^{4}}{r^{4}}}=\\sqrt{1-u^{2}}$，计算得\n$$\n\\frac{d\\varphi}{dr}=\\frac{u}{r\\sqrt{1-u^{2}}},\\qquad dr=-\\frac{r}{2}\\frac{du}{u}.\n$$\n因此\n$$\nd\\varphi=\\frac{u}{r\\sqrt{1-u^{2}}}\\,dr\n=\\frac{u}{r\\sqrt{1-u^{2}}}\\left(-\\frac{r}{2}\\frac{du}{u}\\right)\n=-\\frac{1}{2}\\frac{du}{\\sqrt{1-u^{2}}}.\n$$\n积分得，\n$$\n\\varphi=-\\frac{1}{2}\\arcsin(u)+C=-\\frac{1}{2}\\arcsin\\!\\left(\\frac{x_{0}^{2}}{r^{2}}\\right)+C.\n$$\n应用在 $(x_{0},0)$ 处的初始条件：此处 $r=x_{0}$，所以 $u=1$，且 $\\varphi=0$。因此\n$$\n0=-\\frac{1}{2}\\arcsin(1)+C=-\\frac{\\pi}{4}+C \\quad\\Longrightarrow\\quad C=\\frac{\\pi}{4}.\n$$\n于是\n$$\n\\varphi=\\frac{\\pi}{4}-\\frac{1}{2}\\arcsin\\!\\left(\\frac{x_{0}^{2}}{r^{2}}\\right).\n$$\n整理得，\n$$\n\\arcsin\\!\\left(\\frac{x_{0}^{2}}{r^{2}}\\right)=\\frac{\\pi}{2}-2\\varphi\n\\quad\\Longrightarrow\\quad\n\\frac{x_{0}^{2}}{r^{2}}=\\sin\\!\\left(\\frac{\\pi}{2}-2\\varphi\\right)=\\cos(2\\varphi).\n$$\n因此，\n$$\nr^{2}\\cos(2\\varphi)=x_{0}^{2}.\n$$\n使用 $x=r\\cos\\varphi$ 和 $y=r\\sin\\varphi$，注意到 $r^{2}\\cos(2\\varphi)=r^{2}(\\cos^{2}\\varphi-\\sin^{2}\\varphi)=x^{2}-y^{2}$。因此光线的笛卡尔方程为\n$$\nx^{2}-y^{2}=x_{0}^{2}.\n$$\n解出 $y$ 并选择与初始向上发射（对于 $x\\ge x_{0}$ 有 $y\\ge 0$）相符的分支，\n$$\ny(x)=\\sqrt{x^{2}-x_{0}^{2}}.\n$$\n此表达式仅依赖于 $x$ 和 $x_{0}$，符合要求。", "answer": "$$\\boxed{\\sqrt{x^{2}-x_{0}^{2}}}$$", "id": "2140976"}, {"introduction": "理解了单条光线的轨迹后，我们可以将目光投向更复杂的现象：当大量光线汇集时会发生什么？本练习将我们的视角从单条光线提升到光线族，并引入“焦散”这一迷人的概念——它是由光线族包络形成的亮线。你将通过具体的几何和微积分计算，确定一个特定光源发出的光线族所形成的焦散线的位置，亲身体验程函方程的原理如何催生出深刻而优美的几何结构。[@problem_id:2140999]", "problem": "一个理论上的光学设备由一个位于二维笛卡尔平面原点、半径为 $R$ 的薄圆形环构成。该环作为光源，从其圆周上的每一点向由 $x^2+y^2 < R^2$ 定义的内部区域发射光线。在环上的任意给定点，会有一束光线向内投射。这束光线的方向并不垂直于环；相反，它与发射点的内向法向量偏离一个恒定的锐角 $\\alpha$（其中 $0 < \\alpha < \\pi/2$）。所有光线的方向都使得其速度的切向分量方向相同（例如，所有光线相对于其对应的法线都“顺时针”弯曲）。\n\n所有这些发射光线的集合形成一条焦散线，它是这些光线的包络线，并呈现为一条明亮的曲线。可以证明，这条焦散线是一个以原点为中心的圆。你的任务是确定这个焦散圆的半径。\n\n你的答案需要用给定的参数 $R$ 和 $\\alpha$ 的符号表达式来表示。", "solution": "设发射环上的一个点由极角 $\\theta$ 参数化，其位置向量为 $r_{0}(\\theta)=R(\\cos\\theta,\\sin\\theta)$。该点的内向单位法向量为 $n_{\\text{in}}(\\theta)=-(\\cos\\theta,\\sin\\theta)$，并选择顺时针方向的单位切向量为 $t(\\theta)=(\\sin\\theta,-\\cos\\theta)$。发射的光线与 $n_{\\text{in}}$ 成锐角 $\\alpha$ 并偏向 $t$ 方向，因此其单位方向向量为\n$$\nu(\\theta)=\\cos\\alpha\\,n_{\\text{in}}(\\theta)+\\sin\\alpha\\,t(\\theta).\n$$\n具体表达式为：\n$$\nu(\\theta)=-\\cos\\alpha\\,(\\cos\\theta,\\sin\\theta)+\\sin\\alpha\\,(\\sin\\theta,-\\cos\\theta)\n= \\bigl(-\\cos(\\theta+\\alpha),\\,-\\sin(\\theta+\\alpha)\\bigr).\n$$\n与光线方向垂直的单位法向量可以通过将 $u$ 旋转 $+90^{\\circ}$ 得到，即\n$$\nw(\\theta)=(-u_{y}(\\theta),\\,u_{x}(\\theta))=\\bigl(\\sin(\\theta+\\alpha),\\,-\\cos(\\theta+\\alpha)\\bigr),\n$$\n该向量满足 $|w(\\theta)|=1$ 和 $w(\\theta)\\cdot u(\\theta)=0$。\n\n经过点 $r_{0}(\\theta)$ 且方向为 $u(\\theta)$ 的光线（直线）的隐式方程为\n$$\nw(\\theta)\\cdot\\bigl(r-r_{0}(\\theta)\\bigr)=0,\n$$\n即，\n$$\nw(\\theta)\\cdot r=c(\\theta),\\qquad c(\\theta):=w(\\theta)\\cdot r_{0}(\\theta).\n$$\n计算 $c(\\theta)$：\n$$\nc(\\theta)=R\\bigl[\\sin(\\theta+\\alpha)\\cos\\theta-\\cos(\\theta+\\alpha)\\sin\\theta\\bigr]\n=R\\sin\\bigl((\\theta+\\alpha)-\\theta\\bigr)=R\\sin\\alpha,\n$$\n该结果与 $\\theta$ 无关。\n\n因此，该直线族为 $w(\\theta)\\cdot r=R\\sin\\alpha$，其中 $|w(\\theta)|=1$。单参数曲线族的包络线可以通过求解以下方程组得到：\n$$\nF(r,\\theta)=0,\\qquad \\frac{\\partial F}{\\partial\\theta}(r,\\theta)=0.\n$$\n此处 $F(r,\\theta)=w(\\theta)\\cdot r - R\\sin\\alpha$，所以\n$$\n\\frac{\\partial F}{\\partial\\theta}(r,\\theta)=w'(\\theta)\\cdot r=0.\n$$\n对 $w(\\theta)$ 求导：\n$$\nw'(\\theta)=\\bigl(\\cos(\\theta+\\alpha),\\,\\sin(\\theta+\\alpha)\\bigr)=:v(\\theta),\n$$\n该向量满足 $|v(\\theta)|=1$ 和 $v(\\theta)\\cdot w(\\theta)=0$。因此，包络线条件为\n$$\nw(\\theta)\\cdot r=R\\sin\\alpha,\\qquad v(\\theta)\\cdot r=0.\n$$\n因为 $\\{v(\\theta),w(\\theta)\\}$ 是一组标准正交基，第二个条件意味着 $r$ 必须与 $w(\\theta)$ 平行，因此 $r=\\lambda\\,w(\\theta)$。将其代入第一个条件得到 $\\lambda|w(\\theta)|^{2}=\\lambda=R\\sin\\alpha$，因此 $r=R\\sin\\alpha\\,w(\\theta)$。当 $\\theta$ 变化时，$w(\\theta)$ 会旋转并遍历所有方向，因此包络线是一个以原点为中心，半径为\n$$\n|r|=R\\sin\\alpha.\n$$\n的圆。因此，焦散线是一个以原点为中心、半径为 $R\\sin\\alpha$ 的圆。", "answer": "$$\\boxed{R\\sin\\alpha}$$", "id": "2140999"}]}