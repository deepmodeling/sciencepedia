{"hands_on_practices": [{"introduction": "理论学习之后，最好的消化方式就是亲手实践。这个练习将引导你通过直接计算来验证一个给定的函数是否满足泊松方程的弱形式（或称变分形式）。通过分别计算变分方程等号两边的积分，你将具体地体会“弱解”的含义，并巩固对通过分部积分从强形式推导到弱形式过程的理解。[@problem_id:2154690]", "problem": "微分方程的变分形式或“弱”形式是现代分析与数值方法的基石。考虑在区间 $x \\in (0, 1)$ 上的一维泊松方程 $-u''(x) = f(x)$，其满足齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。\n\n如果对于所有同样满足 $v(0)=0$ 和 $v(1)=0$ 的合适检验函数 $v(x)$，以下积分恒等式都成立，那么满足这些边界条件的函数 $u(x)$ 就被称为该问题的弱解：\n$$\n\\int_0^1 u'(x) v'(x) dx = \\int_0^1 f(x) v(x) dx\n$$\n其中 $u'(x)$ 和 $v'(x)$ 分别表示 $u(x)$ 和 $v(x)$ 的一阶导数。\n\n你的任务是针对一个特定情况检验此公式。设源项为 $f(x)=1$。一个提议的解是函数 $u(x) = \\frac{1}{2}x(1-x)$。我们将用特定的检验函数 $v(x) = x(1-x)$ 来检验这个候选解。\n\n为此，你必须计算弱形式中的两个积分：\n1.  左侧积分，$I_{LHS} = \\int_0^1 u'(x) v'(x) dx$。\n2.  右侧积分，$I_{RHS} = \\int_0^1 f(x) v(x) dx$。\n\n若要使提议的函数 $u(x)$ 对给定的检验函数 $v(x)$ 满足弱形式，这两个积分的值必须相等。计算这个值。将你的答案表示为最简精确分数形式。", "solution": "给定 $f(x)=1$，$u(x)=\\frac{1}{2}x(1-x)$ 和 $v(x)=x(1-x)$。需要检验的弱形式是\n$$\n\\int_{0}^{1} u'(x)v'(x)\\,dx=\\int_{0}^{1} f(x)v(x)\\,dx.\n$$\n首先计算导数：\n$$\nu'(x)=\\frac{d}{dx}\\left(\\frac{1}{2}x(1-x)\\right)=\\frac{1}{2}(1-2x)=\\frac{1}{2}-x,\\qquad v'(x)=\\frac{d}{dx}\\left(x(1-x)\\right)=1-2x.\n$$\n计算左侧积分：\n$$\nI_{LHS}=\\int_{0}^{1}\\left(\\frac{1}{2}-x\\right)\\left(1-2x\\right)\\,dx.\n$$\n展开被积函数：\n$$\n\\left(\\frac{1}{2}-x\\right)\\left(1-2x\\right)=\\frac{1}{2}-2x+2x^{2}.\n$$\n在 $[0,1]$ 上逐项积分：\n$$\nI_{LHS}=\\int_{0}^{1}\\frac{1}{2}\\,dx+\\int_{0}^{1}(-2x)\\,dx+\\int_{0}^{1}2x^{2}\\,dx=\\left[\\frac{1}{2}x-x^2+\\frac{2}{3}x^3\\right]_0^1=\\frac{1}{2}-1+\\frac{2}{3}=\\frac{1}{6}.\n$$\n计算右侧积分：\n$$\nI_{RHS}=\\int_{0}^{1} f(x)v(x)\\,dx=\\int_{0}^{1}1\\cdot\\left(x-x^{2}\\right)\\,dx=\\left[\\frac{x^{2}}{2}-\\frac{x^{3}}{3}\\right]_{0}^{1}=\\frac{1}{2}-\\frac{1}{3}=\\frac{1}{6}.\n$$\n因此 $I_{LHS}=I_{RHS}=\\frac{1}{6}$，所以提议的解 $u(x)$ 对给定的检验函数 $v(x)$ 满足弱形式，并且积分的共同值为 $\\frac{1}{6}$。", "answer": "$$\\boxed{\\frac{1}{6}}$$", "id": "2154690"}, {"introduction": "在验证了一个已知的弱解之后，我们自然会想：如何去寻找一个未知的解？这个练习介绍了伽辽金法（Galerkin method），这是一种从变分形式出发寻找近似解的强大系统性方法。你将使用一个分片线性的“帽子函数”作为基函数来构建近似解，这是有限元方法（FEM）中最核心和基础的构件之一。通过求解近似解的系数，你将初步体验到现代工程计算软件背后的基本原理。[@problem_id:2154695]", "problem": "考虑由以下微分方程给出的一维边值问题：\n$$-\\frac{d^2u}{dx^2} = f(x) \\quad \\text{for } x \\in (0, 4)$$\n其齐次狄利克雷边界条件为 $u(0)=0$ 和 $u(4)=0$。源项 $f(x)$ 是一个分段函数，定义如下：\n$$f(x) = \\begin{cases} x & \\text{if } 0 < x \\le 2 \\\\ 0 & \\text{if } 2 < x < 4 \\end{cases}$$\n我们使用伽辽金方法寻求一个近似解 $u_h(x)$。近似空间 $V_h$ 是一个由单个基函数 $\\phi(x)$ 张成的一维空间。这个函数是标准的分段线性“帽”函数，它在 $x=2$ 处等于1，在区域边界 $x=0$ 和 $x=4$ 处为零。近似解因而可写作 $u_h(x) = c \\phi(x)$。确定系数 $c$ 的值。", "solution": "求解在 $[0,4]$ 上，满足 $u(0)=u(4)=0$ 的微分方程 $-u''(x) = f(x)$ 的伽辽金方法是基于其弱（或变分）形式。首先，我们将方程乘以一个满足相同齐次边界条件（即 $v(0)=v(4)=0$）的试探函数 $v(x)$，并在整个定义域上进行积分：\n$$-\\int_0^4 u''(x) v(x) dx = \\int_0^4 f(x) v(x) dx$$\n我们对左侧应用分部积分：\n$$-\\left[ u'(x)v(x) \\right]_0^4 + \\int_0^4 u'(x) v'(x) dx = \\int_0^4 f(x) v(x) dx$$\n由于 $v(0)=v(4)=0$，边界项 $[u'(x)v(x)]_0^4$ 为零。弱形式旨在找到一个函数 $u$（来自一个合适的空间），使得对于所有有效的试探函数 $v$：\n$$\\int_0^4 u'(x) v'(x) dx = \\int_0^4 f(x) v(x) dx$$\n这通常写作 $a(u,v) = L(v)$，其中 $a(u,v)=\\int u'v' dx$ 是一个双线性形式，而 $L(v)=\\int f v dx$ 是一个线性泛函。\n\n在伽辽金方法中，我们在一个有限维子空间 $V_h$ 中寻求近似解 $u_h(x)$。在这里，$V_h$ 由单个基函数 $\\phi(x)$ 张成，所以 $u_h(x) = c \\phi(x)$。我们要求弱形式对于该同一子空间 $V_h$ 中的所有试探函数 $v_h(x)$ 都成立。由于 $V_h$ 是一维的，只需用基函数 $\\phi(x)$ 本身进行测试就足够了。\n将 $u_h(x) = c\\phi(x)$ 代替 $u$ 并将 $\\phi(x)$ 代替 $v$，我们得到：\n$$\\int_0^4 (c\\phi(x))' \\phi'(x) dx = \\int_0^4 f(x) \\phi(x) dx$$\n由于 $c$ 是一个常数，我们可以将其从积分中提出：\n$$c \\int_0^4 (\\phi'(x))^2 dx = \\int_0^4 f(x) \\phi(x) dx$$\n这是一个关于未知系数 $c$ 的 $1 \\times 1$ 线性系统。为了解出 $c$，我们必须计算这两个积分。\n\n首先，我们来定义基函数 $\\phi(x)$ 及其导数。它是一个连接点 $(0,0)$、$(2,1)$ 和 $(4,0)$ 的分段线性函数。\n对于 $x \\in [0, 2]$，该函数是一条从 $(0,0)$ 到 $(2,1)$ 的直线，因此 $\\phi(x) = \\frac{x}{2}$。\n对于 $x \\in [2, 4]$，该函数是一条从 $(2,1)$ 到 $(4,0)$ 的直线，因此 $\\phi(x) = \\frac{4-x}{2}$。\n其导数 $\\phi'(x)$ 是分段常数：\n$$\\phi'(x) = \\begin{cases} 1/2 & \\text{if } 0 < x < 2 \\\\ -1/2 & \\text{if } 2 < x < 4 \\end{cases}$$\n\n现在，我们计算左侧的积分（$c$ 的系数）：\n$$\\int_0^4 (\\phi'(x))^2 dx = \\int_0^2 \\left(\\frac{1}{2}\\right)^2 dx + \\int_2^4 \\left(-\\frac{1}{2}\\right)^2 dx$$\n$$= \\int_0^2 \\frac{1}{4} dx + \\int_2^4 \\frac{1}{4} dx = \\frac{1}{4} [x]_0^2 + \\frac{1}{4} [x]_2^4 = \\frac{1}{4}(2) + \\frac{1}{4}(4-2) = \\frac{1}{2} + \\frac{1}{2} = 1$$\n\n接下来，我们使用给定的源项 $f(x)$ 计算右侧的积分：\n$$\\int_0^4 f(x) \\phi(x) dx = \\int_0^2 x \\cdot \\phi(x) dx + \\int_2^4 0 \\cdot \\phi(x) dx$$\n$$= \\int_0^2 x \\left(\\frac{x}{2}\\right) dx = \\int_0^2 \\frac{x^2}{2} dx$$\n$$= \\left[ \\frac{x^3}{6} \\right]_0^2 = \\frac{2^3}{6} - \\frac{0^3}{6} = \\frac{8}{6} = \\frac{4}{3}$$\n\n最后，我们将这些值代回到关于 $c$ 的线性方程中：\n$$c \\cdot (1) = \\frac{4}{3}$$\n因此，系数的值为 $c = \\frac{4}{3}$。", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "2154695"}, {"introduction": "变分形式的一个巨大优势在于能够优雅地处理经典微分方程难以应对的复杂情况，例如点热源或点作用力。本练习将探讨如何在一个包含狄拉克$\\delta$函数的源项的物理问题中构建变分提法。理解如何处理这类奇异源项，不仅能加深你对变分形式的认识，更能让你体会到它在模拟真实世界物理现象时的强大功能和普适性。[@problem_id:2154735]", "problem": "考虑在一块薄的方形导热板中的稳态温度分布 $T(\\mathbf{x})$，该板占据二维域 $\\Omega = (0, L) \\times (0, L)$。板的边缘保持恒定的零温度，因此在边界 $\\partial\\Omega$ 上有 $T(\\mathbf{x})=0$。板内的温度分布由泊松方程决定：\n$$-\\nabla^2 T = \\frac{S(\\mathbf{x})}{k}$$\n其中，$k$ 是板材料的均匀热导率，$S(\\mathbf{x})$ 是单位面积的热源密度。\n\n该板由两种不同的热源加热：一个密度为 $S_{bg}(\\mathbf{x})$ 的平滑分布的背景热源，以及一个位于内部点 $\\mathbf{x}_0 = (x_0, y_0) \\in \\Omega$、总功率为 $Q$ 的高度集中的点状热源。总热源密度模型为 $S(\\mathbf{x}) = S_{bg}(\\mathbf{x}) + Q \\delta(\\mathbf{x} - \\mathbf{x}_0)$，其中 $\\delta(\\cdot)$ 是二维狄拉克 delta 函数。\n\n此边值问题的变分（或弱）形式旨在从一个合适的函数空间中寻找一个函数 $T(\\mathbf{x})$，使得对于每一个在边界 $\\partial\\Omega$ 上也为零的足够光滑的“检验函数” $v(\\mathbf{x})$，以下积分方程都成立：\n$$ \\int_{\\Omega} \\nabla T \\cdot \\nabla v \\, d\\mathbf{x} = \\int_{\\Omega} \\frac{S(\\mathbf{x})}{k} v(\\mathbf{x}) \\, d\\mathbf{x} $$\n此方程的右侧是检验函数 $v$ 的一个线性泛函，通常表示为 $L(v)$。对于给定的热源分布，以下哪个表达式正确地表示了这个泛函？\n\nA. $L(v) = \\frac{1}{k} \\int_{\\Omega} S_{bg}(\\mathbf{x}) v(\\mathbf{x}) \\, d\\mathbf{x} + \\frac{Q}{k}$\n\nB. $L(v) = \\frac{1}{k} \\int_{\\Omega} S_{bg}(\\mathbf{x}) v(\\mathbf{x}_0) \\, d\\mathbf{x} + \\frac{Q}{k} v(\\mathbf{x}_0)$\n\nC. $L(v) = \\frac{1}{k} S_{bg}(\\mathbf{x}_0) v(\\mathbf{x}_0) + \\frac{Q}{k} v(\\mathbf{x}_0)$\n\nD. $L(v) = \\frac{1}{k} \\int_{\\Omega} S_{bg}(\\mathbf{x}) v(\\mathbf{x}) \\, d\\mathbf{x} + \\frac{Q}{k} v(\\mathbf{x}_0)$\n\nE. $L(v) = \\frac{1}{k} \\left( \\int_{\\Omega} S_{bg}(\\mathbf{x}) \\, d\\mathbf{x} \\right) v(\\mathbf{x}) + \\frac{Q}{k} v(\\mathbf{x}_0)$", "solution": "我们从已知的弱形式开始：\n$$\\int_{\\Omega} \\nabla T \\cdot \\nabla v \\, d\\mathbf{x} = \\int_{\\Omega} \\frac{S(\\mathbf{x})}{k} \\, v(\\mathbf{x}) \\, d\\mathbf{x}。$$\n根据定义，右侧是线性泛函\n$$L(v) = \\int_{\\Omega} \\frac{S(\\mathbf{x})}{k} \\, v(\\mathbf{x}) \\, d\\mathbf{x}。$$\n总热源由下式给出\n$$S(\\mathbf{x}) = S_{bg}(\\mathbf{x}) + Q \\, \\delta(\\mathbf{x} - \\mathbf{x}_0)。$$\n利用积分的线性和常数缩放，我们写出\n$$L(v) = \\frac{1}{k} \\int_{\\Omega} \\left[ S_{bg}(\\mathbf{x}) + Q \\, \\delta(\\mathbf{x} - \\mathbf{x}_0) \\right] v(\\mathbf{x}) \\, d\\mathbf{x}。$$\n展开积分：\n$$L(v) = \\frac{1}{k} \\int_{\\Omega} S_{bg}(\\mathbf{x}) \\, v(\\mathbf{x}) \\, d\\mathbf{x} + \\frac{Q}{k} \\int_{\\Omega} \\delta(\\mathbf{x} - \\mathbf{x}_0) \\, v(\\mathbf{x}) \\, d\\mathbf{x}。$$\n使用二维狄拉克 delta 分布的定义属性，即\n$$\\int_{\\Omega} \\delta(\\mathbf{x} - \\mathbf{x}_0) \\, v(\\mathbf{x}) \\, d\\mathbf{x} = v(\\mathbf{x}_0) \\quad \\text{for } \\mathbf{x}_0 \\in \\Omega。$$\n因此，\n$$L(v) = \\frac{1}{k} \\int_{\\Omega} S_{bg}(\\mathbf{x}) \\, v(\\mathbf{x}) \\, d\\mathbf{x} + \\frac{Q}{k} \\, v(\\mathbf{x}_0)。$$\n与所列选项比较，这与选项 D 一致。其他选项不正确，因为：\n- A 忽略了点源对 $v$ 的依赖关系，得出了常数项 $\\frac{Q}{k}$ 而不是 $\\frac{Q}{k} v(\\mathbf{x}_0)$。\n- B 在背景积分内错误地将 $v(\\mathbf{x})$ 替换为 $v(\\mathbf{x}_0)$。\n- C 将背景积分简化为 $S_{bg}(\\mathbf{x}_0) v(\\mathbf{x}_0)$，这不是背景热源的正确作用。\n- E 将 $v(\\mathbf{x})$ 从背景积分中提出，这是无效的，因为 $v$ 依赖于 $\\mathbf{x}$。\n因此，正确的表达式是选项 D。", "answer": "$$\\boxed{D}$$", "id": "2154735"}]}