{"hands_on_practices": [{"introduction": "我们从一个基本构件开始：弱导数。虽然像 $f(x)=|x|$ 这样的函数在某些点上没有经典意义上的导数，但弱导数的概念使我们能够以一种有意义的方式扩展微分的定义。本练习将通过应用定义弱导数的积分公式，指导你找到这个经典函数的弱导数。[@problem_id:2225014]", "problem": "在偏微分方程和泛函分析的研究中，导数的概念被推广到了非经典可微的函数上。这引出了弱导数的概念。\n\n设 $\\Omega$ 为实数线上的一个开区间。如果函数 $f$ 在 $\\Omega$ 的每个紧子区间上都可积，则称其属于空间 $L^1_{\\text{loc}}(\\Omega)$。函数 $f \\in L^1_{\\text{loc}}(\\Omega)$ 的弱导数是一个函数 $g \\in L^1_{\\text{loc}}(\\Omega)$，它对所有检验函数 $\\phi \\in C_c^{\\infty}(\\Omega)$ 满足以下方程：\n$$ \\int_{\\Omega} f(x) \\phi'(x) \\,dx = - \\int_{\\Omega} g(x) \\phi(x) \\,dx $$\n此处，$C_c^{\\infty}(\\Omega)$ 是所有在 $\\Omega$ 上具有紧支集的无穷次可微函数 $\\phi: \\Omega \\to \\mathbb{R}$ 构成的空间，这意味着这些函数在 $\\Omega$ 内某个闭合有界区间之外取值为零。\n\n考虑开区间 $\\Omega = (-1, 1)$ 上的函数 $f(x) = |x|$。下列哪个函数 $g(x)$ 是 $f(x)$ 在 $\\Omega$ 上的弱导数？\n\nA. 对于所有 $x \\in (-1, 1)$，$g(x) = 1$\n\nB. $g(x) = \\begin{cases} -1 & \\text{若 } -1 < x < 0 \\\\ 1 & \\text{若 } 0 < x < 1 \\end{cases}$\n\nC. $g(x) = \\begin{cases} 1 & \\text{若 } -1 < x < 0 \\\\ -1 & \\text{若 } 0 < x < 1 \\end{cases}$\n\nD. 对于所有 $x \\in (-1, 1)$，$g(x) = 0$\n\nE. $f(x) = |x|$ 在 $\\Omega = (-1, 1)$ 上的弱导数不存在。", "solution": "我们必须找到一个函数 $g \\in L^{1}_{\\text{loc}}((-1,1))$，使得对于所有 $\\phi \\in C_{c}^{\\infty}((-1,1))$，\n$$\n\\int_{-1}^{1} |x|\\,\\phi'(x)\\,dx = -\\int_{-1}^{1} g(x)\\,\\phi(x)\\,dx.\n$$\n一个自然的人选是符号函数\n$$\ng(x)=\\begin{cases}\n-1 & \\text{若 } -1<x<0,\\\\\n1 & \\text{若 } 0<x<1,\n\\end{cases}\n$$\n其在 $x=0$ 处可取任意值（这无关紧要，因为在一个测度为零的集合上改变 $g$ 的值不影响弱导数）。\n\n为了验证这一点，设 $\\phi \\in C_{c}^{\\infty}((-1,1))$。由于 $\\phi$ 在 $(-1,1)$ 内具有紧支集，因此在 $x=\\pm 1$ 处没有边界项的贡献。在 $0$ 处拆分积分，并对每个区间使用分部积分法：\n$$\n\\int_{-1}^{1} |x|\\,\\phi'(x)\\,dx\n=\\int_{-1}^{0} (-x)\\,\\phi'(x)\\,dx+\\int_{0}^{1} x\\,\\phi'(x)\\,dx.\n$$\n在 $(-1,0)$ 上，\n$$\n\\int_{-1}^{0} (-x)\\,\\phi'(x)\\,dx = \\left[(-x)\\phi(x)\\right]_{-1}^{0} - \\int_{-1}^{0}(-1)\\,\\phi(x)\\,dx\n= 0 + \\int_{-1}^{0}\\phi(x)\\,dx,\n$$\n因为 $\\phi$ 在 $x=-1$ 附近为零，并且 $(-0)\\phi(0)=0$。在 $(0,1)$ 上，\n$$\n\\int_{0}^{1} x\\,\\phi'(x)\\,dx = \\left[x\\phi(x)\\right]_{0}^{1} - \\int_{0}^{1} 1\\cdot \\phi(x)\\,dx\n= 0 - \\int_{0}^{1}\\phi(x)\\,dx,\n$$\n因为 $\\phi$ 在 $x=1$ 附近为零，并且 $0\\cdot \\phi(0)=0$。因此，\n$$\n\\int_{-1}^{1} |x|\\,\\phi'(x)\\,dx\n= \\int_{-1}^{0}\\phi(x)\\,dx - \\int_{0}^{1}\\phi(x)\\,dx\n= -\\int_{-1}^{0}(-1)\\phi(x)\\,dx - \\int_{0}^{1} (1)\\phi(x)\\,dx\n= -\\int_{-1}^{1} g(x)\\,\\phi(x)\\,dx,\n$$\n其中 $g$ 如上文所定义。这表明 $g$ 是 $|x|$ 在 $(-1,1)$ 上的一个弱导数。因此，正确的选项是在 $(-1,0)$ 上为 $-1$，在 $(0,1)$ 上为 $1$ 的分段函数，即选项 B。对于弱导数而言，$x=0$ 处的值无关紧要。", "answer": "$$\\boxed{B}$$", "id": "2225014"}, {"introduction": "理解了弱导数之后，我们可以将其应用于求解微分方程。本练习将探讨一个深刻的思想：一个非光滑函数可以是一个偏微分方程的有效“弱解”，且该解对应于一个非常规的源项。你将从一个给定的不可微解出发，反向推导出其对应的源项，从而揭示弱解与点力或点电荷等物理概念之间的联系。[@problem_id:2157269]", "problem": "考虑开区间 $I = (0, 1)$ 上的一维泊松方程 $-u''(x) = f(x)$。其弱形式由以下积分方程给出：\n$$\n\\int_0^1 u'(x)\\phi'(x) \\,dx = \\int_0^1 f(x)\\phi(x) \\,dx\n$$\n该方程必须对从空间 $C_c^\\infty((0,1))$ 中任选的“测试函数” $\\phi(x)$ 成立，该空间是所有在 $(0,1)$ 的某个闭子区间外为零的无穷次可微函数的集合。\n\n假设由 $u(x) = |x - 1/3|$ 给出的函数是该问题的一个弱解。确定相应的源项 $f(x)$。用狄拉克 delta 函数表示你的答案，对于位于 $x_0$ 的点源，该函数记作 $\\delta(x-x_0)$。", "solution": "我们设 $a=\\frac{1}{3}$ 并考虑 $u(x)=|x-a|$。那么 $u$ 是分段线性的，其导数为\n$$\nu'(x)=\\begin{cases}\n-1, & x<a,\\\\\n1, & x>a,\n\\end{cases}\n$$\n对于 $x\\neq a$，这可以写成 $u'(x)=\\operatorname{sgn}(x-a)$。弱形式要求对于每一个 $\\phi\\in C_{c}^{\\infty}((0,1))$，\n$$\n\\int_{0}^{1}u'(x)\\,\\phi'(x)\\,dx=\\int_{0}^{1}f(x)\\,\\phi(x)\\,dx.\n$$\n通过在 $a$ 处分割积分并利用 $\\phi$ 在 $(0,1)$ 内具有紧支撑（因此 $\\phi(0)=\\phi(1)=0$）来计算左侧：\n$$\n\\int_{0}^{1}u'(x)\\,\\phi'(x)\\,dx=\\int_{0}^{a}(-1)\\,\\phi'(x)\\,dx+\\int_{a}^{1}(1)\\,\\phi'(x)\\,dx.\n$$\n计算每个积分：\n$$\n\\int_{0}^{a}(-1)\\,\\phi'(x)\\,dx=-\\big[\\phi(x)\\big]_{0}^{a}=-(\\phi(a^{-})-\\phi(0))=-\\phi(a),\n$$\n$$\n\\int_{a}^{1}(1)\\,\\phi'(x)\\,dx=\\big[\\phi(x)\\big]_{a}^{1}=\\phi(1)-\\phi(a^{+})=-\\phi(a),\n$$\n其中由 $\\phi$ 的连续性可得 $\\phi(a^{-})=\\phi(a^{+})=\\phi(a)$ 且 $\\phi(0)=\\phi(1)=0$。因此\n$$\n\\int_{0}^{1}u'(x)\\,\\phi'(x)\\,dx=-2\\,\\phi(a).\n$$\n根据狄拉克 delta 分布的定义，这等于\n$$\n-2\\,\\phi(a)=\\int_{0}^{1}\\big(-2\\,\\delta(x-a)\\big)\\,\\phi(x)\\,dx.\n$$\n与弱形式进行比较，我们得出结论：\n$$\nf(x)=-2\\,\\delta\\big(x-\\tfrac{1}{3}\\big).\n$$\n等价地，在分布的意义上，$u''=2\\,\\delta(x-a)$，所以 $-u''=f=-2\\,\\delta(x-a)$，这与上面的计算结果相符。", "answer": "$$\\boxed{-2\\delta\\!\\left(x-\\frac{1}{3}\\right)}$$", "id": "2157269"}, {"introduction": "弱解的真正威力从理论延伸到了实际计算中。作为现代数值分析的基石，伽辽金法（Galerkin method）利用弱形式来寻找复杂微分方程的高精度近似解。在最后的这个实践中，你将把伽辽金法应用于一个简单问题，将一个微分方程转化为一个可解的线性方程组，这项技术在工程和物理软件中得到了广泛应用。[@problem_id:2157325]", "problem": "考虑在区间 $x \\in (0, 1)$ 上的一维泊松方程 $-u''(x) = f(x)$，其满足齐次狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$。源项由函数 $f(x) = x$ 给出。\n\n我们希望使用伽辽金方法求此边值问题的一个近似解。该近似解记为 $u_h(x)$，在一个由满足边界条件的基函数集合所张成的有限维空间中寻找。具体来说，我们把近似解定义为两个基函数的线性组合：\n$$u_h(x) = c_1 \\phi_1(x) + c_2 \\phi_2(x)$$\n其中系数 $c_1$ 和 $c_2$ 是待定的未知常数。所选的基函数为：\n$$ \\phi_1(x) = x(1-x) $$\n$$ \\phi_2(x) = x^2(1-x) $$\n伽辽金方法将原微分方程转化为一个关于系数 $c_1$ 和 $c_2$ 的线性方程组。\n\n求这些系数之和 $c_1 + c_2$ 的值。请将答案表示为最简分数。", "solution": "我们在满足齐次狄利克雷边界条件的给定基函数所张成的空间中，用伽辽金方法求解该边值问题。对于 $-u''=f$ 且 $u(0)=u(1)=0$ 这个问题的弱形式是：找到 $u \\in V$，使得\n$$\n\\int_{0}^{1} u'(x)\\,v'(x)\\,dx=\\int_{0}^{1} f(x)\\,v(x)\\,dx \\quad \\text{对所有 } v \\in V,\n$$\n其中 $V$ 是 $H^{1}(0,1)$ 的子空间，满足 $v(0)=v(1)=0$。在伽辽金近似中，我们设 $u_{h}(x)=c_{1}\\phi_{1}(x)+c_{2}\\phi_{2}(x)$，其中 $\\phi_{1}(x)=x(1-x)$ 和 $\\phi_{2}(x)=x^{2}(1-x)$，并对 $v=\\phi_{i}$ ($i=1,2$) 强制应用弱形式。这就得到线性系统\n$$\n\\sum_{j=1}^{2} K_{ij} c_{j}=F_{i}, \\quad i=1,2,\n$$\n其中刚度矩阵项为 $K_{ij}=\\int_{0}^{1} \\phi_{i}'(x)\\,\\phi_{j}'(x)\\,dx$，载荷向量项为 $F_{i}=\\int_{0}^{1} f(x)\\,\\phi_{i}(x)\\,dx$。\n\n计算导数：\n$$\n\\phi_{1}(x)=x-x^{2}, \\quad \\phi_{1}'(x)=1-2x, \\qquad \\phi_{2}(x)=x^{2}-x^{3}, \\quad \\phi_{2}'(x)=2x-3x^{2}.\n$$\n计算刚度矩阵项：\n$$\nK_{11}=\\int_{0}^{1} (1-2x)^{2}\\,dx=\\int_{0}^{1} (1-4x+4x^{2})\\,dx=\\left[x-2x^{2}+\\frac{4}{3}x^{3}\\right]_{0}^{1}=\\frac{1}{3},\n$$\n$$\nK_{12}=\\int_{0}^{1} (1-2x)(2x-3x^{2})\\,dx=\\int_{0}^{1} (2x-7x^{2}+6x^{3})\\,dx=\\left[x^{2}-\\frac{7}{3}x^{3}+\\frac{3}{2}x^{4}\\right]_{0}^{1}=\\frac{1}{6},\n$$\n根据对称性 $K_{21}=K_{12}=\\frac{1}{6}$，以及\n$$\nK_{22}=\\int_{0}^{1} (2x-3x^{2})^{2}\\,dx=\\int_{0}^{1} (4x^{2}-12x^{3}+9x^{4})\\,dx=\\left[\\frac{4}{3}x^{3}-3x^{4}+\\frac{9}{5}x^{5}\\right]_{0}^{1}=\\frac{2}{15}.\n$$\n对 $f(x)=x$ 计算载荷向量项：\n$$\nF_{1}=\\int_{0}^{1} x\\,\\phi_{1}(x)\\,dx=\\int_{0}^{1} (x^{2}-x^{3})\\,dx=\\left[\\frac{x^{3}}{3}-\\frac{x^{4}}{4}\\right]_{0}^{1}=\\frac{1}{12},\n$$\n$$\nF_{2}=\\int_{0}^{1} x\\,\\phi_{2}(x)\\,dx=\\int_{0}^{1} (x^{3}-x^{4})\\,dx=\\left[\\frac{x^{4}}{4}-\\frac{x^{5}}{5}\\right]_{0}^{1}=\\frac{1}{20}.\n$$\n因此，线性系统为\n$$\n\\begin{pmatrix}\n\\frac{1}{3} & \\frac{1}{6} \\\\\n\\frac{1}{6} & \\frac{2}{15}\n\\end{pmatrix}\n\\begin{pmatrix}\nc_{1} \\\\ c_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{1}{12} \\\\ \\frac{1}{20}\n\\end{pmatrix}.\n$$\n刚度矩阵的行列式为\n$$\n\\det K=\\frac{1}{3}\\cdot \\frac{2}{15}-\\left(\\frac{1}{6}\\right)^{2}=\\frac{2}{45}-\\frac{1}{36}=\\frac{1}{60}.\n$$\n根据克莱姆法则，\n$$\nc_{1}=\\frac{K_{22}F_{1}-K_{12}F_{2}}{\\det K}\n=\\frac{\\frac{2}{15}\\cdot \\frac{1}{12}-\\frac{1}{6}\\cdot \\frac{1}{20}}{\\frac{1}{60}}\n=\\frac{\\frac{1}{90}-\\frac{1}{120}}{\\frac{1}{60}}\n=\\frac{\\frac{1}{360}}{\\frac{1}{60}}\n=\\frac{1}{6},\n$$\n$$\nc_{2}=\\frac{K_{11}F_{2}-K_{21}F_{1}}{\\det K}\n=\\frac{\\frac{1}{3}\\cdot \\frac{1}{20}-\\frac{1}{6}\\cdot \\frac{1}{12}}{\\frac{1}{60}}\n=\\frac{\\frac{1}{60}-\\frac{1}{72}}{\\frac{1}{60}}\n=\\frac{\\frac{1}{360}}{\\frac{1}{60}}\n=\\frac{1}{6}.\n$$\n因此，\n$$\nc_{1}+c_{2}=\\frac{1}{6}+\\frac{1}{6}=\\frac{1}{3}.\n$$", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "2157325"}]}