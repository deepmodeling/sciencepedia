{"hands_on_practices": [{"introduction": "我们从一项基本技能开始：将一个微分方程从其“强形式”转换为“弱形式”。第一个练习提供了一个标准的一维边值问题，要求你识别出其正确的弱形式。掌握这个乘以测试函数 $v$ 并应用分部积分以将导数从未知函数 $u$ 转移到测试函数 $v$ 上的过程，是运用此方法强大功能的关键第一步。[@problem_id:2156992]", "problem": "考虑由以下微分方程定义的一维边值问题 (BVP)：\n$$\n-(e^x u'(x))' = \\sin(x)\n$$\n此问题定义在开区间 $x \\in (a, b)$ 上，并满足齐次 Dirichlet 边界条件 $u(a) = 0$ 和 $u(b) = 0$。\n\n该边值问题的弱（或变分）形式要求从一个合适的函数空间 $V$ 中找到一个解函数 $u$，使得对于来自同一空间 $V$ 的所有“检验函数” $v$，某个积分方程都成立。对于本问题，空间 $V$ 定义为在区间 $(a, b)$ 上连续、一阶导数平方可积，并满足边界条件 $f(a) = 0$ 和 $f(b) = 0$ 的函数集合。\n\n下列哪个积分方程正确地表示了给定边值问题的弱形式？任务是找到 $u \\in V$，使得所选方程对于所有 $v \\in V$ 都成立。\n\nA. $\\int_{a}^{b} e^x u'(x) v'(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$\n\nB. $\\int_{a}^{b} u'(x) v'(x) \\,dx = \\int_{a}^{b} e^{-x}\\sin(x) v(x) \\,dx$\n\nC. $-\\int_{a}^{b} e^x u'(x) v'(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$\n\nD. $\\int_{a}^{b} e^x u(x) v(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$\n\nE. $\\int_{a}^{b} e^x u'(x) v(x) \\,dx = -\\int_{a}^{b} \\cos(x) v'(x) \\,dx$\n\nF. $-\\int_{a}^{b} e^x u'(x) v(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$", "solution": "我们从该边值问题的强形式开始：\n$$\n-(\\exp(x)\\,u'(x))'=\\sin(x)\\quad\\text{for }x\\in(a,b),\\qquad u(a)=0,\\;u(b)=0.\n$$\n令 $V=\\{v\\in H^{1}(a,b):v(a)=v(b)=0\\}$。为推导弱形式，将微分方程乘以一个任意的检验函数 $v\\in V$，并在区间 $(a,b)$ 上积分：\n$$\n\\int_{a}^{b}-(\\exp(x)\\,u'(x))'\\,v(x)\\,dx=\\int_{a}^{b}\\sin(x)\\,v(x)\\,dx.\n$$\n对左侧应用分部积分法，使用以下恒等式\n$$\n\\int_{a}^{b}-\\left(p(x)w'(x)\\right)'\\,v(x)\\,dx=\\int_{a}^{b}p(x)\\,w'(x)\\,v'(x)\\,dx-\\left[p(x)\\,w'(x)\\,v(x)\\right]_{x=a}^{x=b},\n$$\n其中 $p(x)=\\exp(x)$ 且 $w(x)=u(x)$。这得到\n$$\n\\int_{a}^{b}\\exp(x)\\,u'(x)\\,v'(x)\\,dx-\\left[\\exp(x)\\,u'(x)\\,v(x)\\right]_{x=a}^{x=b}=\\int_{a}^{b}\\sin(x)\\,v(x)\\,dx.\n$$\n由于对于所有 $v\\in V$ 都有 $v(a)=v(b)=0$，边界项为零，从而得到弱（变分）形式：\n$$\n\\int_{a}^{b}\\exp(x)\\,u'(x)\\,v'(x)\\,dx=\\int_{a}^{b}\\sin(x)\\,v(x)\\,dx\\quad\\text{for all }v\\in V.\n$$\n与选项比较，这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "2156992"}, {"introduction": "弱形式的真正优雅之处在于它能处理经典方法难以应对的概念，例如集中的点源。本练习探讨了如何自然地处理由狄拉克-德尔塔函数 $F_0 \\delta(x-x_0)$ 建模的源项。你将确定这个奇异源在弱形式的线性泛函 $L(v)$ 中是如何表示的，这项技术对于模拟力学中的点载荷或电磁学中的点电荷至关重要。[@problem_id:2157010]", "problem": "考虑一根长度为 $L$ 的细杆上的一维稳态热传导问题。杆上的温度分布 $u(x)$（其中 $x \\in (0, L)$）由以下二阶微分方程所描述：\n$$-\\frac{d}{dx}\\left(p(x) \\frac{du}{dx}\\right) = f(x)$$\n其中 $p(x)$ 是与位置相关的热导率，它是一个已知的正值连续可微函数。杆的两端保持在固定的零温度，从而得到边界条件 $u(0)=0$ 和 $u(L)=0$。\n\n源项 $f(x)$ 表示在单点 $x_0$（其中 $0 < x_0 < L$）处施加的总功率为 $F_0$ 的高度集中的热源。这可以用狄拉克-德尔塔函数 $\\delta(\\cdot)$ 来建模，使得 $f(x) = F_0 \\delta(x-x_0)$。\n\n该边值问题的弱形式旨在从一个合适的函数空间 $V$（其中 $V$ 中的函数满足边界条件）中寻找一个函数 $u$，使得方程 $a(u,v) = L(v)$ 对 $V$ 中所有的“测试函数”$v$ 都成立。双线性形式 $a(u,v)$ 由下式给出：\n$$a(u,v) = \\int_{0}^{L} p(x) \\frac{du}{dx} \\frac{dv}{dx} \\, dx$$\n确定相应的线性泛函 $L(v)$ 的表达式。你的答案应该是一个用 $F_0$、$x_0$ 和测试函数 $v$ 表示的符号表达式。", "solution": "我们考虑由容许函数和测试函数组成的空间 $V=H_{0}^{1}(0,L)$，这些函数在 $x=0$ 和 $x=L$ 处满足齐次狄利克雷边界条件。为了推导弱形式，我们将微分方程乘以任意一个 $v \\in V$ 并在 $(0,L)$ 上积分：\n$$\n\\int_{0}^{L} -\\frac{d}{dx}\\left(p(x)\\frac{du}{dx}\\right) v(x)\\,dx = \\int_{0}^{L} f(x)\\,v(x)\\,dx.\n$$\n对左侧应用分部积分（一维中的格林恒等式）可得\n$$\n\\int_{0}^{L} p(x)\\frac{du}{dx}\\frac{dv}{dx}\\,dx - \\left[p(x)\\frac{du}{dx}v(x)\\right]_{x=0}^{x=L} = \\int_{0}^{L} f(x)\\,v(x)\\,dx.\n$$\n因为 $v(0)=v(L)=0$，所以边界项为零，我们得到弱形式\n$$\na(u,v) = \\int_{0}^{L} f(x)\\,v(x)\\,dx,\n$$\n其中 $a(u,v)=\\int_{0}^{L} p(x)\\,u'(x)\\,v'(x)\\,dx$ 已给出。代入 $f(x)=F_{0}\\delta(x-x_{0})$ 并使用狄拉克-德尔塔分布的定义性质，可得\n$$\n\\int_{0}^{L} F_{0}\\delta(x-x_{0})\\,v(x)\\,dx = F_{0}v(x_{0}),\n$$\n其中，在一维情况下，对于 $v \\in H_{0}^{1}(0,L)$，点取值 $v(x_{0})$ 是良定义的。因此，相应的线性泛函是\n$$\nL(v)=F_{0}v(x_{0}).\n$$", "answer": "$$\\boxed{F_{0}\\,v(x_{0})}$$", "id": "2157010"}, {"introduction": "弱形式的适用性远远超出了标准的源问题。这最后一个练习通过解决一个偏微分方程特征值问题，展示了其多功能性，这是寻找振动频率或量子能态的数学基础。通过推导亥姆霍兹方程 $-\\nabla^{2} u = \\lambda u$ 的弱形式，你将看到它如何直接导向广义矩阵特征值问题 $\\mathbf{K}\\mathbf{c} = \\lambda\\mathbf{M}\\mathbf{c}$，而这正是许多计算物理模拟的基础。[@problem_id:2450442]", "problem": "考虑标量偏微分方程 (PDE) 特征值问题：寻找特征对 $\\left(\\lambda, u\\right)$，其中 $u \\not\\equiv 0$，使得\n$$\n-\\nabla^{2} u = \\lambda\\, u \\quad \\text{in } \\Omega,\n$$\n带有齐次 Dirichlet 边界条件\n$$\nu = 0 \\quad \\text{on } \\partial \\Omega,\n$$\n其中 $\\Omega \\subset \\mathbb{R}^{d}$ 是一个具有 Lipschitz 边界 $\\partial \\Omega$ 的有界域，且 $d \\in \\{1,2,3\\}$。使用有限元法 (FEM) 的协调 Galerkin 离散化在由基函数 $\\{\\phi_{i}\\}_{i=1}^{N}$ 张成的有限维子空间 $V_{h} \\subset H^{1}_{0}(\\Omega)$ 中寻找 $u$。\n\n对于这种协调 Galerkin 有限元法，哪个选项同时正确地陈述了其弱形式和所得到的离散矩阵特征值问题的结构？\n\nA. 弱形式：寻找 $\\left(\\lambda, u\\right)$，其中 $u \\in H^{1}_{0}(\\Omega)\\setminus\\{0\\}$，使得\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x \\quad \\forall v \\in H^{1}_{0}(\\Omega).\n$$\n离散问题：对于 $u_{h} = \\sum_{i=1}^{N} c_{i} \\phi_{i}$，\n$$\n\\mathbf{K}\\,\\mathbf{c} = \\lambda\\, \\mathbf{M}\\,\\mathbf{c},\n$$\n其中 $\\mathbf{K}_{ij} = \\int_{\\Omega} \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j}\\, \\mathrm{d}x$ 且 $\\mathbf{M}_{ij} = \\int_{\\Omega} \\phi_{i}\\, \\phi_{j}\\, \\mathrm{d}x$。\n\nB. 弱形式：寻找 $\\left(\\lambda, u\\right)$，其中 $u \\in H^{1}(\\Omega)\\setminus\\{0\\}$，使得\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x - \\int_{\\partial \\Omega} \\frac{\\partial u}{\\partial n}\\, v \\, \\mathrm{d}s = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x \\quad \\forall v \\in H^{1}(\\Omega).\n$$\n离散问题：对于 $u_{h} = \\sum_{i=1}^{N} c_{i} \\phi_{i}$，其中 $\\{\\phi_{i}\\}$ 不必在 $\\partial \\Omega$ 上为零，\n$$\n\\mathbf{K}\\,\\mathbf{c} = \\lambda\\, \\mathbf{M}\\,\\mathbf{c},\n$$\n其中 $\\mathbf{K}$ 和 $\\mathbf{M}$ 的定义与选项 A 中相同。\n\nC. 弱形式：寻找 $\\left(\\lambda, u\\right)$，其中 $u \\in H^{2}(\\Omega)\\setminus\\{0\\}$，使得\n$$\n\\int_{\\Omega} (\\nabla^{2} u)\\, v \\, \\mathrm{d}x = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x \\quad \\forall v \\in H^{1}_{0}(\\Omega),\n$$\n因此离散系统为\n$$\n\\tilde{\\mathbf{K}}\\,\\mathbf{c} = \\lambda\\, \\mathbf{M}\\,\\mathbf{c}, \\quad \\tilde{\\mathbf{K}}_{ij} = \\int_{\\Omega} (\\nabla^{2} \\phi_{i})\\, \\phi_{j}\\, \\mathrm{d}x.\n$$\n\nD. 弱形式：寻找 $\\left(\\lambda, u\\right)$，其中 $u \\in H^{1}_{0}(\\Omega)\\setminus\\{0\\}$，使得\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x \\quad \\forall v \\in H^{1}_{0}(\\Omega).\n$$\n离散问题：在选择任意协调有限元基 $\\{\\phi_{i}\\}_{i=1}^{N}$ 后，该特征值问题总是可以简化为标准形式\n$$\n\\mathbf{K}\\,\\mathbf{c} = \\lambda\\, \\mathbf{c},\n$$\n其中 $\\mathbf{K}_{ij} = \\int_{\\Omega} \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j}\\, \\mathrm{d}x$。", "solution": "控制偏微分方程 (PDE) 为\n$$\n-\\nabla^{2} u = \\lambda\\, u \\quad \\text{in } \\Omega, \\quad u = 0 \\quad \\text{on } \\partial \\Omega.\n$$\n为了从第一性原理推导弱形式，将 PDE 乘以一个容许的测试函数 $v$ 并在 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} \\left(-\\nabla^{2} u\\right) v \\, \\mathrm{d}x = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x.\n$$\n对左侧应用 Green 恒等式（分部积分）：\n$$\n\\int_{\\Omega} \\left(-\\nabla^{2} u\\right) v \\, \\mathrm{d}x = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x - \\int_{\\partial \\Omega} \\frac{\\partial u}{\\partial n} v \\, \\mathrm{d}s.\n$$\n对于齐次 Dirichlet 边界条件，试探空间和测试空间的自然协调选择是 Sobolev 空间 $H^{1}_{0}(\\Omega)$，它被定义为 $C^{\\infty}_{c}(\\Omega)$ 在 $H^{1}$ 范数下的闭包，因此 $v \\in H^{1}_{0}(\\Omega)$ 意味着在迹的意义上 $v = 0$ on $\\partial \\Omega$。因此，由于在 $\\partial \\Omega$ 上 $v=0$，边界积分为零，从而得到对称的弱形式：\n$$\n\\text{寻找 } \\left(\\lambda, u\\right) \\text{ 其中 } u \\in H^{1}_{0}(\\Omega)\\setminus\\{0\\} \\text{ 使得 } \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x \\quad \\forall v \\in H^{1}_{0}(\\Omega).\n$$\n该形式仅需要 $u$ 和 $v$ 的一阶导数，因此 $H^{1}_{0}(\\Omega)$ 是足够的，并且对于左侧，相关的双线性形式在 $H^{1}_{0}(\\Omega)$ 上是连续、对称且强制的。\n\n对于协调有限元法 (FEM) 离散化，选择一个具有基 $\\{\\phi_{i}\\}_{i=1}^{N}$ 的有限维子空间 $V_{h} \\subset H^{1}_{0}(\\Omega)$。用 $u_{h} = \\sum_{i=1}^{N} c_{i} \\phi_{i}$ 来近似 $u$，并用每个基函数 $\\phi_{j}$（$j \\in \\{1,\\dots,N\\}$）进行测试。弱形式变为\n$$\n\\sum_{i=1}^{N} c_{i} \\int_{\\Omega} \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j}\\, \\mathrm{d}x = \\lambda \\sum_{i=1}^{N} c_{i} \\int_{\\Omega} \\phi_{i}\\, \\phi_{j}\\, \\mathrm{d}x \\quad \\text{对每个 } j.\n$$\n收集系数后得到广义矩阵特征值问题\n$$\n\\mathbf{K}\\, \\mathbf{c} = \\lambda\\, \\mathbf{M}\\, \\mathbf{c},\n$$\n其中刚度矩阵项为 $\\mathbf{K}_{ij} = \\int_{\\Omega} \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j}\\, \\mathrm{d}x$ 且质量矩阵项为 $\\mathbf{M}_{ij} = \\int_{\\Omega} \\phi_{i}\\, \\phi_{j}\\, \\mathrm{d}x$。对于标准协调有限元空间，$\\mathbf{K}$ 和 $\\mathbf{M}$ 是对称的，其中 $\\mathbf{K}$ 在与零空间正交的子空间上是正定的（此处 Dirichlet 约束消除了常数零空间），而 $\\mathbf{M}$ 是对称正定的。\n\n逐项分析：\n\nA. 弱形式用试探和测试空间 $H^{1}_{0}(\\Omega)$ 陈述，这强加了齐次 Dirichlet 边界条件。由于在 $\\partial \\Omega$ 上 $v=0$，边界积分为零，得到\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x \\quad \\forall v \\in H^{1}_{0}(\\Omega).\n$$\n离散 Galerkin 系统被正确地识别为具有标准刚度矩阵和质量矩阵的广义特征值问题 $\\mathbf{K}\\mathbf{c} = \\lambda \\mathbf{M}\\mathbf{c}$。结论 — 正确。\n\nB. 该选项使用 $H^{1}(\\Omega)$ 作为测试和试探函数，并保留了边界项。对于齐次 Dirichlet 条件，适当的协调空间是 $H^{1}_{0}(\\Omega)$，以使迹为零且边界积分消失；在没有额外边界强制的情况下使用 $H^{1}(\\Omega)$ 与本质边界条件不一致。因此，对于所述的边界条件，空间的选择和所示的弱形式陈述都是不正确的。结论 — 错误。\n\nC. 该选项将拉普拉斯算子 $\\nabla^2 u$ 保留在域积分内，并要求 $u \\in H^{2}(\\Omega)$，这是不必要的，且与弱形式的目的相悖。标准的弱形式将导数转移到 $v$ 上，以将正则性要求降低到 $H^{1}(\\Omega)$。此外，所示的离散矩阵使用了基函数的二阶导数，这对于此问题不是协调 $H^{1}$ 有限元法的方法。结论 — 错误。\n\nD. 此选项中的弱形式是正确的，但声称对于“任何”协调基，离散问题“总是简化”为标准特征值问题 $\\mathbf{K}\\mathbf{c} = \\lambda \\mathbf{c}$ 的说法通常是错误的。若无诸如对基进行显式 $\\mathbf{M}$-正交归一化或变量变换等额外步骤，Galerkin 离散化会产生广义特征值问题 $\\mathbf{K}\\mathbf{c} = \\lambda \\mathbf{M}\\mathbf{c}$，而非标准特征值问题。结论 — 错误。", "answer": "$$\\boxed{A}$$", "id": "2450442"}]}