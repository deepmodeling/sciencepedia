{"hands_on_practices": [{"introduction": "要真正掌握数值方法，理论学习必须与实践相结合。第一个练习将引导你分析热方程的一个基本数值格式——前向时间中心空间（FTCS）显式格式。虽然这种格式实现起来最直观，但它的稳定性是有条件的。通过这个练习 [@problem_id:2114210]，你将探索这一稳定性条件的一个重要推论：离散最大值原理。这个原理确保了数值解的行为与热量扩散的物理直觉相符（即热点不会凭空在物体内部产生），是连接数值稳定性与物理真实性的桥梁。", "problem": "一根长度为 $L=1.0$ m 的一维金属杆，其热扩散系数为 $\\alpha = 0.01$ m$^2$/s。杆内的温度分布 $u(x,t)$ 由热方程 $u_t = \\alpha u_{xx}$ 控制。\n\n我们希望使用显式向前时间中心空间 (FTCS) 数值方法来模拟温度的演化过程。将杆离散化为 $J=5$ 个相等的子区间，从而得到空间步长 $\\Delta x = L/J$。该模拟使用的时间步长为 $\\Delta t=1.6$ s。对于内部空间节点 $j$，其 FTCS 格式由下式给出：\n$$u_j^{n+1} = u_j^n + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n)$$\n其中 $u_j^n$ 是在空间网格点 $x_j = j \\Delta x$ 和时间 $t_n = n \\Delta t$ 处温度的数值近似值。\n\n在 $t=0$ 时，整个杆上的初始温度分布由以下函数给出：\n$$ u(x, 0) = \\begin{cases} 300 + 100x & \\text{对于 } 0 \\le x \\le 0.6 \\\\ 360 & \\text{对于 } 0.6 < x \\le 1.0 \\end{cases} $$\n其中温度单位为开尔文， $x$ 的单位为米。\n\n在所有时间 $t > 0$，杆的两端都保持恒定温度，从而施加了以下边界条件：\n- $u(0, t) = 300$ K\n- $u(1.0, t) = 375$ K\n\n数值解 $u_j^n$ 被设定为在相应的网格点上与这些初始条件和边界条件相匹配。具体来说，$u_j^0$ 由 $u(x_j, 0)$ 确定，并且对于所有时间步 $n \\ge 0$，有 $u_0^n = 300$ K 和 $u_J^n = 375$ K。\n\n假设模拟运行了很长时间，在杆上的任何网格点上所能达到的最高温度是多少？答案以开尔文为单位表示，并四舍五入到四位有效数字。", "solution": "我们将长度为 $L$ 的杆离散化为 $J=5$ 个相等的子区间，因此空间步长为\n$$\n\\Delta x=\\frac{L}{J}=\\frac{1.0}{5}=0.2.\n$$\n当时间步长为 $\\Delta t=1.6$ 且热扩散系数为 $\\alpha=0.01$ 时，内部节点的 FTCS 格式可以写成\n$$\nu_{j}^{n+1}=u_{j}^{n}+\\frac{\\alpha\\Delta t}{(\\Delta x)^{2}}\\left(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}\\right)\n=(1-2r)u_{j}^{n}+r\\,u_{j-1}^{n}+r\\,u_{j+1}^{n},\n$$\n其中\n$$\nr=\\frac{\\alpha\\Delta t}{(\\Delta x)^{2}}=\\frac{0.01\\times 1.6}{(0.2)^{2}}=\\frac{0.016}{0.04}=0.4.\n$$\n由于 $r\\leq \\frac{1}{2}$，系数 $(1-2r), r, r$ 均为非负数且它们的和为 1，这使得 $u_{j}^{n+1}$ 成为 $u_{j-1}^{n}$、$u_{j}^{n}$ 和 $u_{j+1}^{n}$ 的一个凸组合。这保证了离散极值原理的成立：内部不会产生新的极大值，并且在时间 $t_{n+1}$ 时所有网格点上的最大值（包括边界值）不会超过在时间 $t_{n}$ 时的最大值。\n\n对于所有 $n\\geq 0$，边界条件被施加为 $u_{0}^{n}=300$ 和 $u_{J}^{n}=375$。因此，对于每个时间层 $n$，所有网格点上的全局最大值至多为 $375$，并且实际上是在右边界节点 $j=J$ 处达到的，因为对于所有 $n$ 都有 $u_{J}^{n}=375$。因此，在任何网格点上所能达到的最高温度是 $375$。\n\n当 $t\\to\\infty$ 时，数值解收敛于满足 $u_{xx}=0$ 及 $u(0)=300$ 和 $u(1)=375$ 的稳态线性分布，该分布在内部的取值严格小于 $375$，且仅在 $x=1$ 处达到 $375$。因此，在任何时候，内部都不会出现超过 $375$ 的超调。\n\n因此，杆上任何网格点所能达到的最高温度是 $375$ K。四舍五入到四位有效数字，结果是 $375.0$。", "answer": "$$\\boxed{375.0}$$", "id": "2114210"}, {"introduction": "显式格式的稳定性限制常常导致计算成本过高，而隐式格式则能很好地规避这一问题，允许我们使用更大的时间步长。然而，这种优势的代价是在每个时间步都必须求解一个线性方程组。这个练习 [@problem_id:2114199] 将带你亲手构建一个用于波动方程的全隐式格式，并推导出其对应的线性系统。理解如何将一个偏微分方程转化为一个形如 $A\\mathbf{u}^{n+1} = \\mathbf{b}$ 的矩阵问题，是掌握隐式方法的核心技能，而你将会发现，对于许多标准偏微分方程，这个矩阵 $A$ 具有高效求解的稀疏结构（如三对角结构）。", "problem": "考虑一维波动方程 $u_{tt} = c^2 u_{xx}$，该方程模拟了振动弦在位置 $x$ 和时间 $t$ 的位移 $u(x,t)$。波速为常数 $c > 0$。弦的长度为 $L$，两端固定，这对应于对所有时间 $t \\ge 0$ 的齐次狄利克雷边界条件 $u(0, t) = 0$ 和 $u(L, t) = 0$。\n\n为了对此方程进行数值求解，使用间距为 $\\Delta x$ 的均匀空间网格和间距为 $\\Delta t$ 的均匀时间网格对时空域进行离散化。网格点表示为 $(x_i, t_n) = (i\\Delta x, n\\Delta t)$，在这些点上解的数值近似为 $u_i^n \\approx u(x_i, t_n)$。内部空间点的索引从 $i=1$ 到 $N_x-1$，其中 $L = N_x \\Delta x$。\n\n构建一个全隐式有限差分格式来近似该解。在此格式中，关于时间的二阶偏导数 $u_{tt}$ 通过以时间 $t_n$ 为中心的二阶精度中心差分进行近似。关于空间的二阶偏导数 $u_{xx}$ 通过完全在未来时间层 $t_{n+1}$ 上计算的二阶精度中心差分进行近似。\n\n在每个时间步长，该数值格式都会产生一个关于未知位移 $\\mathbf{u}^{n+1} = [u_1^{n+1}, u_2^{n+1}, \\dots, u_{N_x-1}^{n+1}]^T$ 的线性方程组。该方程组可以写成矩阵形式 $A \\mathbf{u}^{n+1} = \\mathbf{b}$，其中 $A$ 是一个 $(N_x-1) \\times (N_x-1)$ 的矩阵，其元素取决于离散化参数，而 $\\mathbf{b}$ 是一个由先前时间层上的已知值组成的向量。所得矩阵 $A$ 是一个常系数三对角矩阵。\n\n令 $\\lambda = \\frac{c \\Delta t}{\\Delta x}$ 为关联网格间距和波速的无量纲参数。矩阵 $A$ 的三个非零对角线具有恒定值。确定这些值。最终答案由对应于次对角线元素 ($a$)、主对角线元素 ($d$) 和超对角线元素 ($c$) 的三个表达式组成。将这三个表达式以行矩阵的形式给出。", "solution": "我们从 $x\\in[0,L]$ 上的一维波动方程 $u_{tt}=c^{2}u_{xx}$ 开始，其齐次狄利克雷边界条件为 $u(0,t)=0$ 和 $u(L,t)=0$。在均匀网格 $(x_{i},t_{n})=(i\\Delta x,n\\Delta t)$ 上，我们近似\n$$\nu_{tt}(x_{i},t_{n})\\approx \\frac{u_{i}^{n+1}-2u_{i}^{n}+u_{i}^{n-1}}{\\Delta t^{2}},\n\\qquad\nu_{xx}(x_{i},t_{n+1})\\approx \\frac{u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1}}{\\Delta x^{2}}.\n$$\n指定的全隐式格式为\n$$\n\\frac{u_{i}^{n+1}-2u_{i}^{n}+u_{i}^{n-1}}{\\Delta t^{2}}=c^{2}\\frac{u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1}}{\\Delta x^{2}}.\n$$\n将时间层 $n+1$ 的未知数收集到左侧重写，得到\n$$\n\\left(\\frac{1}{\\Delta t^{2}}+\\frac{2c^{2}}{\\Delta x^{2}}\\right)u_{i}^{n+1}\n-\\frac{c^{2}}{\\Delta x^{2}}u_{i-1}^{n+1}\n-\\frac{c^{2}}{\\Delta x^{2}}u_{i+1}^{n+1}\n=\\frac{2}{\\Delta t^{2}}u_{i}^{n}-\\frac{1}{\\Delta t^{2}}u_{i}^{n-1}.\n$$\n引入无量纲参数 $\\lambda=\\frac{c\\Delta t}{\\Delta x}$ 并将两边乘以 $\\Delta t^{2}$，我们得到\n$$\n(1+2\\lambda^{2})u_{i}^{n+1}-\\lambda^{2}u_{i-1}^{n+1}-\\lambda^{2}u_{i+1}^{n+1}\n=2u_{i}^{n}-u_{i}^{n-1}.\n$$\n因此，$A\\mathbf{u}^{n+1}=\\mathbf{b}$ 中的三对角矩阵 $A$ 具有常数元素：\n- 次对角线元素 $a=-\\lambda^{2}$，\n- 主对角线元素 $d=1+2\\lambda^{2}$，\n- 超对角线元素 $c=-\\lambda^{2}$。\n因为边界条件是齐次狄利克雷条件，所以在这些系数中没有出现额外的与边界相关的贡献项。", "answer": "$$\\boxed{\\begin{pmatrix}-\\lambda^{2} & 1+2\\lambda^{2} & -\\lambda^{2}\\end{pmatrix}}$$", "id": "2114199"}, {"introduction": "真实世界的物理系统往往比标准模型更为复杂。此练习挑战你分析一个包含非局域项的扩散方程，这类方程在生物学和材料科学中很常见，其中某一点的变化会受到整个系统状态的影响。当你应用隐式方法离散这个非局域方程时 [@problem_id:2114206]，你会发现标准的三对角矩阵结构被彻底改变了。这个练习旨在揭示一个深刻的道理：偏微分方程的数学结构直接决定了其数值求解方案的计算结构。通过分析这个非局域项如何将一个稀疏线性系统转变为一个稠密但具有特殊结构的系统，你将对数值建模的复杂性有更深入的认识。", "problem": "考虑一个一维系统，其状态 $u(x,t)$ 根据以下非局域扩散方程演化：\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} + \\alpha \\int_0^L u(x,t) \\,dx\n$$\n该系统定义在空间域 $x \\in [0, L]$ 和时间 $t > 0$ 上。物理参数 $D$、$\\alpha$ 和 $L$ 均为正常数。系统满足齐次狄利克雷（Dirichlet）边界条件，即对于所有 $t > 0$，有 $u(0, t) = 0$ 和 $u(L, t) = 0$，并从给定的初始状态 $u(x, 0) = f(x)$ 开始演化。\n\n为了数值求解此问题，我们对区域进行离散化。我们使用均匀空间网格 $x_j = j \\Delta x$，$j = 0, 1, \\dots, N$，其中 $N \\Delta x = L$。时间被离散化为 $t^n = n \\Delta t$。$u(x_j, t^n)$ 的数值近似值记为 $u_j^n$。\n\n我们采用一种称为后向时间、中心空间（Backward-Time, Centered-Space, BTCS）方法的隐式有限差分格式。具体来说：\n- 时间导数 $\\frac{\\partial u}{\\partial t}$ 在点 $(x_j, t^{n+1})$ 处使用一阶后向差分进行近似。\n- 空间导数 $\\frac{\\partial^2 u}{\\partial x^2}$ 在点 $(x_j, t^{n+1})$ 处使用二阶中心差分进行近似。\n- 积分项 $\\int_0^L u(x,t) \\,dx$ 在时间 $t^{n+1}$ 处使用梯形法则，对所有空间网格点 $x_0, x_1, \\dots, x_N$ 进行近似。\n\n该格式会产生一个线性方程组，需要在每个时间步进行求解，以得到内部点的未知值，这些值由向量 $\\mathbf{u}^{n+1} = (u_1^{n+1}, u_2^{n+1}, \\dots, u_{N-1}^{n+1})^T$ 表示。该系统可写为矩阵形式 $A \\mathbf{u}^{n+1} = \\mathbf{b}^n$，其中矩阵 $A$ 是一个 $(N-1) \\times (N-1)$ 的矩阵，向量 $\\mathbf{b}^n$ 依赖于前一时间步的已知值 $\\mathbf{u}^n$。\n\n假设 $\\alpha \\neq 0$，以下哪个选项最能描述矩阵 $A$ 的结构？\n\nA. 严格三对角矩阵。\nB. 稠密的非对称矩阵。\nC. 稠密的对称矩阵，且不能表示为稀疏矩阵的低秩更新。\nD. 三对角矩阵的秩一修正。\nE. 对角矩阵。", "solution": "该问题要求我们确定由给定非局域偏微分方程的隐式有限差分离散化所产生的线性系统 $A \\mathbf{u}^{n+1} = \\mathbf{b}^n$ 中矩阵 $A$ 的结构。\n\n该偏微分方程为：\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} + \\alpha \\int_0^L u(x,t) \\,dx\n$$\n\n我们在一个通用内部网格点 $(x_j, t^{n+1})$（其中 $j = 1, 2, \\dots, N-1$）处应用指定的数值近似。\n\n1.  **时间导数近似（后向差分）：**\n    $$\n    \\frac{\\partial u}{\\partial t} \\bigg|_{(x_j, t^{n+1})} \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}\n    $$\n\n2.  **空间导数近似（中心差分）：** 由于该格式是隐式的，我们在时间层 $n+1$ 处计算此项。\n    $$\n    \\frac{\\partial^2 u}{\\partial x^2} \\bigg|_{(x_j, t^{n+1})} \\approx \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2}\n    $$\n\n3.  **积分项近似（梯形法则）：** 在时间 $t^{n+1}$ 处的积分近似为：\n    $$\n    \\int_0^L u(x, t^{n+1}) \\,dx \\approx \\Delta x \\left( \\frac{1}{2}u_0^{n+1} + \\sum_{k=1}^{N-1} u_k^{n+1} + \\frac{1}{2}u_N^{n+1} \\right)\n    $$\n    问题陈述了齐次狄利克雷（Dirichlet）边界条件，$u(0,t)=0$ 和 $u(L,t)=0$。在我们的离散记法中，这意味着对于所有 $n$，$u_0^n = 0$ 和 $u_N^n = 0$。因此，积分近似简化为：\n    $$\n    \\int_0^L u(x, t^{n+1}) \\,dx \\approx \\Delta x \\sum_{k=1}^{N-1} u_k^{n+1}\n    $$\n\n现在，我们将这些近似代入原偏微分方程：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = D \\left( \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2} \\right) + \\alpha \\left( \\Delta x \\sum_{k=1}^{N-1} u_k^{n+1} \\right)\n$$\n我们的目标是将其整理为 $A \\mathbf{u}^{n+1} = \\mathbf{b}^n$ 的形式。这意味着我们必须将所有包含 $u^{n+1}$ 的项移到左侧（LHS），将所有包含 $u^n$ 的项移到右侧（RHS）。\n\n将整个方程乘以 $\\Delta t$：\n$$\nu_j^{n+1} - u_j^n = \\frac{D \\Delta t}{(\\Delta x)^2} (u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}) + \\alpha \\Delta t \\Delta x \\sum_{k=1}^{N-1} u_k^{n+1}\n$$\n我们定义扩散数 $r = \\frac{D \\Delta t}{(\\Delta x)^2}$ 和一个用于积分部分的常数 $C = \\alpha \\Delta t \\Delta x$。方程变为：\n$$\nu_j^{n+1} - u_j^n = r (u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}) + C \\sum_{k=1}^{N-1} u_k^{n+1}\n$$\n重新整理，将 $u^{n+1}$ 的项归到左侧：\n$$\n-r u_{j-1}^{n+1} + (1+2r) u_j^{n+1} - r u_{j+1}^{n+1} - C \\sum_{k=1}^{N-1} u_k^{n+1} = u_j^n\n$$\n此方程对每个 $j = 1, 2, \\dots, N-1$ 均成立。这是我们线性系统 $A \\mathbf{u}^{n+1} = \\mathbf{b}^n$ 的第 $j$ 行。向量 $\\mathbf{b}^n$ 就是 $\\mathbf{u}^n$。我们需要确定矩阵 $A$ 的元素 $A_{jk}$。元素 $A_{jk}$ 是第 $j$ 个方程中 $u_k^{n+1}$ 的系数。\n\n我们来分析这些系数：\n前三项 $-r u_{j-1}^{n+1} + (1+2r) u_j^{n+1} - r u_{j+1}^{n+1}$ 构成了标准的三对角结构。我们称这部分的矩阵为 $T$。其元素为：\n$T_{j,j-1} = -r$\n$T_{j,j} = 1+2r$\n$T_{j,j+1} = -r$\n对于 $|j-k|>1$，$T_{jk} = 0$。\n\n积分项 $- C \\sum_{k=1}^{N-1} u_k^{n+1}$ 对矩阵 $A$ 的第 $j$ 行中每个元素都有贡献。对于第 $j$ 个方程，任何 $u_k^{n+1}$（对于 $k=1, \\dots, N-1$）的系数都减少了 $C$。\n这一贡献可以表示为一个矩阵 $M$，其中每个元素 $M_{jk} = C$。\n\n因此，总矩阵 $A$ 是这两部分之和：$A = T - M$。\n矩阵 $A$ 的元素为：\n$A_{jk} = T_{jk} - M_{jk} = T_{jk} - C$。\n具体地：\n-   如果 $k = j-1$：$A_{j, j-1} = -r - C$\n-   如果 $k = j$：$A_{j,j} = 1+2r - C$\n-   如果 $k = j+1$：$A_{j, j+1} = -r - C$\n-   如果 $|j-k| > 1$：$A_{jk} = 0 - C = -C$\n\n由于 $\\alpha \\neq 0$ 且其他常数均为正，所以 $C \\neq 0$。因此，矩阵 $A$ （通常）处处都有非零元素。这意味着矩阵 $A$ 是**稠密**的。这排除了选项 A（三对角）和 E（对角）。\n\n现在我们来更仔细地研究其结构。所有元素均为 $C$ 的矩阵 $M$ 可以写成外积形式：$M = C (\\mathbf{1} \\cdot \\mathbf{1}^T)$，其中 $\\mathbf{1}$ 是一个 $(N-1) \\times 1$ 的全一列向量。可以表示为两个向量外积的矩阵是一个秩一矩阵。\n因此，矩阵 $A = T - C(\\mathbf{1} \\cdot \\mathbf{1}^T)$ 是**一个三对角矩阵（$T$）的秩一修正**。这与选项 D 相符。\n\n我们检查其他选项以确认 D 是最佳描述。\n-   **对称性（选项 B）：** 三对角矩阵 $T$ 是对称的。秩一矩阵 $M = C(\\mathbf{1} \\cdot \\mathbf{1}^T)$ 也是对称的。两个对称矩阵的差是对称矩阵。因此，$A$ 是一个对称矩阵。这排除了选项 B（非对称）。\n-   **秩一更新（选项 C）：** 我们刚才已经证明 $A$ *可以* 表示为稀疏（三对角）矩阵的秩一更新。因此，选项 C 是不正确的。\n\n将剩下的正确陈述“A 是一个稠密的对称矩阵”与选项 D 进行比较，我们发现选项 D 更具体，信息量更大。它解释了矩阵为何是稠密和对称的。它是一个著名稀疏矩阵的秩一更新这一事实是一个更强大的描述，因为它允许使用专门的高效线性求解器（如 Sherman-Morrison 公式），而不是通用的稠密求解器。因此，选项 D 是对该矩阵结构最好、最精确的描述。", "answer": "$$\\boxed{D}$$", "id": "2114206"}]}