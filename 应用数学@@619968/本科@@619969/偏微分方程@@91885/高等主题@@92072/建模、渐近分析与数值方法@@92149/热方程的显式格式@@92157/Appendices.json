{"hands_on_practices": [{"introduction": "理解显式格式的最好方法就是亲手使用它。这个练习将让你对前向时间中心空间 (FTCS) 格式如何模拟扩散过程有一个具体的感觉。通过模拟一个施加在单点的瞬时热脉冲，你将直接观察到该格式如何在单个时间步内将热量分配给相邻点，从而揭示其核心的更新机制 [@problem_id:2101730]。", "problem": "一根长导热棒的热学性质正在被研究。棒上的温度分布 $u(x, t)$ 遵循一维热传导方程 $u_t = \\alpha u_{xx}$，其中 $\\alpha$ 是常数热扩散系数。为了数值模拟温度的演化，将该棒离散化为一系列间距均匀（为 $\\Delta x$）的节点，时间以 $\\Delta t$ 的步长推进。节点 $j$ 在时间步 $n$ 的温度记为 $U_j^n$。该模拟采用前向时间中心空间（FTCS）显式有限差分格式：\n$$U_j^{n+1} = U_j^n + s \\left( U_{j+1}^n - 2U_j^n + U_{j-1}^n \\right)$$\n其中 $s = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$ 是网格傅里叶数。\n\n该棒初始处于均匀的零温度状态。在时间 $t=0$ 时，一个瞬时热脉冲被施加在索引为 $i$ 的单个节点上。这将初始条件设定为：\n$$U_j^0 = \\begin{cases} T_0 & \\text{if } j=i \\\\ 0 & \\text{if } j \\neq i \\end{cases}$$\n假设该棒足够长，使得在第一个时间步内，边界条件不影响所关心的区域。模拟使用特定的网格傅里叶数 $s = 1/3$ 运行。\n\n确定经过一个时间步后（在 $n=1$ 时），节点 $i-1$、$i$ 和 $i+1$ 处的温度。请以一个有序集合 $\\{U_{i-1}^1, U_i^1, U_{i+1}^1\\}$ 的形式给出你的答案，并用初始峰值温度 $T_0$ 表示。", "solution": "我们使用热传导方程的FTCS显式格式，该格式由下式给出：\n$$\nU_{j}^{n+1} = U_{j}^{n} + s\\left(U_{j+1}^{n} - 2U_{j}^{n} + U_{j-1}^{n}\\right),\n$$\n其中网格傅里叶数为 $s = \\frac{\\alpha \\Delta t}{(\\Delta x)^{2}}$。初始条件为：\n$$\nU_{j}^{0} = \n\\begin{cases}\nT_0 & \\text{if } j=i, \\\\\n0 & \\text{if } j \\neq i.\n\\end{cases}\n$$\n我们计算一个时间步之后的值。\n\n对于中心节点 $j=i$，使用 $U_{i}^{0} = T_0$ 和 $U_{i\\pm 1}^{0} = 0$，\n$$\nU_{i}^{1} = U_{i}^{0} + s\\left(U_{i+1}^{0} - 2U_{i}^{0} + U_{i-1}^{0}\\right)\n= T_0 + s\\left(0 - 2T_0 + 0\\right)\n= T_0\\left(1 - 2s\\right).\n$$\n\n对于左侧相邻节点 $j=i-1$，使用 $U_{i-1}^{0} = 0$、$U_{i}^{0} = T_0$ 和 $U_{i-2}^{0} = 0$，\n$$\nU_{i-1}^{1} = U_{i-1}^{0} + s\\left(U_{i}^{0} - 2U_{i-1}^{0} + U_{i-2}^{0}\\right)\n= 0 + s\\left(T_0 - 0 + 0\\right)\n= s T_0.\n$$\n\n对于右侧相邻节点 $j=i+1$，使用 $U_{i+1}^{0} = 0$、$U_{i}^{0} = T_0$ 和 $U_{i+2}^{0} = 0$，\n$$\nU_{i+1}^{1} = U_{i+1}^{0} + s\\left(U_{i+2}^{0} - 2U_{i+1}^{0} + U_{i}^{0}\\right)\n= 0 + s\\left(0 - 0 + T_0\\right)\n= s T_0.\n$$\n\n代入指定值 $s = \\frac{1}{3}$，可得\n$$\nU_{i-1}^{1} = \\frac{T_0}{3}, \\quad\nU_{i}^{1} = T_0\\left(1 - \\frac{2}{3}\\right) = \\frac{T_0}{3}, \\quad\nU_{i+1}^{1} = \\frac{T_0}{3}.\n$$\n因此，有序集合 $\\{U_{i-1}^{1}, U_{i}^{1}, U_{i+1}^{1}\\}$ 是 $\\left\\{\\frac{T_0}{3}, \\frac{T_0}{3}, \\frac{T_0}{3}\\right\\}$。", "answer": "$$\\boxed{\\left\\{\\frac{T_0}{3}, \\frac{T_0}{3}, \\frac{T_0}{3}\\right\\}}$$", "id": "2101730"}, {"introduction": "一个简单的更新法则并不能保证得到物理上有意义的结果；时间步长 $\\Delta t$ 与空间步长 $\\Delta x$ 的选择至关重要。这个练习将带你探讨数值稳定性的概念，指导你计算出最大的允许时间步长，以确保你的模拟保持稳定并产生真实的结果 [@problem_id:2101770]。这是任何使用显式方法的计算科学家都必须掌握的基本技能。", "problem": "一个工程师团队正在开发一个数值模型，用于模拟一根细长的、侧向绝热的碳化硅棒的冷却过程。棒上的温度分布 $T(x, t)$，其中 $x$ 是以米为单位的位置，$t$ 是以秒为单位的时间，该分布遵循一维热方程：\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} $$\n碳化硅的热扩散率 $\\alpha = 0.0400 \\, \\text{m}^2/\\text{s}$。\n\n为了进行模拟，工程师们将棒的长度离散化为一个网格，其均匀空间步长为 $\\Delta x = 0.0500$ 米。他们采用一种显式有限差分格式，其中下一个时间步的网格点温度仅根据当前时间步该点及其左右两个相邻点的温度来计算。\n\n为了防止导致不符合物理规律的、无界的温度振荡的数值误差累积，模拟所用的时间步长 $\\Delta t$ 不得超过某个最大值。\n\n确定这个最大允许时间步长 $\\Delta t_{\\text{max}}$。您的答案应以秒为单位，并四舍五入到三位有效数字。", "solution": "一维热方程使用空间步长 $\\Delta x$ 和时间步长 $\\Delta t$，通过显式前向时间中心空间 (FTCS) 差分格式进行离散化。将网格点 $x_{i}$ 和时间 $t_{n}$ 处 $T(x_{i}, t_{n})$ 的数值近似记为 $T_{i}^{n}$，则显式更新方程为\n$$\nT_{i}^{n+1} = T_{i}^{n} + s \\left(T_{i+1}^{n} - 2T_{i}^{n} + T_{i-1}^{n}\\right),\n$$\n其中\n$$\ns = \\frac{\\alpha \\Delta t}{\\Delta x^{2}}.\n$$\n为保证稳定性并避免无界振荡，我们应用 von Neumann 稳定性分析。假设误差存在一个形式为\n$$\n\\epsilon_{i}^{n} = G^{n} \\exp\\!\\left(\\mathrm{i} k i \\Delta x\\right)\n$$\n的傅里叶模式，其中 $G$ 是放大因子。代入更新方程可得\n$$\nG = 1 + s \\left(\\exp\\!\\left(\\mathrm{i} k \\Delta x\\right) - 2 + \\exp\\!\\left(-\\mathrm{i} k \\Delta x\\right)\\right).\n$$\n使用恒等式 $\\exp\\!\\left(\\mathrm{i}\\theta\\right) + \\exp\\!\\left(-\\mathrm{i}\\theta\\right) = 2\\cos(\\theta)$，我们得到\n$$\nG = 1 + s \\left(2\\cos(k \\Delta x) - 2\\right) = 1 - 4s \\sin^{2}\\!\\left(\\frac{k \\Delta x}{2}\\right).\n$$\n稳定性要求对所有波数 $k$ 都有 $|G| \\leq 1$。当 $\\sin^{2}(k \\Delta x/2) = 1$ 时，$G$ 达到最小值，此时 $G_{\\min} = 1 - 4s$。最严格的条件是\n$$\n-1 \\leq 1 - 4s \\leq 1 \\quad \\Longrightarrow \\quad s \\leq \\frac{1}{2}.\n$$\n因此，最大允许时间步长为\n$$\n\\Delta t_{\\max} = \\frac{1}{2} \\frac{\\Delta x^{2}}{\\alpha}.\n$$\n根据给定的 $\\alpha = 0.0400$ 和 $\\Delta x = 0.0500$，我们计算\n$$\n\\Delta x^{2} = (0.0500)^{2} = 0.002500,\n$$\n$$\n\\Delta t_{\\max} = \\frac{1}{2} \\frac{0.002500}{0.0400} = \\frac{0.002500}{0.0800} = 0.03125.\n$$\n四舍五入到三位有效数字，结果为 $0.0313$。", "answer": "$$\\boxed{0.0313}$$", "id": "2101770"}, {"introduction": "在学习了如何确保稳定性之后，观察当稳定性条件被违反时会发生什么同样重要。这个练习将使用一组会导致不稳定的参数，让你亲手计算出非物理的、振荡的结果 [@problem_id:2101701]。亲眼目睹这种行为将巩固遵守稳定性准则 [@problem_id:2101770] 的重要性。", "problem": "考虑一维热方程 $\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}$，该方程定义在空间域 $x \\in [0, 1]$ 上，并具有狄利克雷边界条件 $u(0, t) = u(1, t) = 0$（对于所有时间 $t \\ge 0$）。\n\n该方程在均匀网格上进行离散化。空间域被划分为宽度为 $\\Delta x = 0.25$ 的段，网格点记为 $x_j = j \\Delta x$，其中 $j=0, 1, 2, 3, 4$。时间被离散为大小为 $\\Delta t$ 的步长，记为 $t_n = n \\Delta t$。解 $u(x_j, t_n)$ 的数值近似值记为 $u_j^n$。\n\n我们使用时间前向中心差分 (FTCS) 格式来近似求解。内部网格点的更新规则如下：\n$$\nu_j^{n+1} = u_j^n + s(u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n对于本问题，无量纲参数 $s = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$ 被设为 $s=0.6$。\n\n在时间 $t=0$ 时的初始条件由一个离散脉冲给出。中心内部网格点的值为 $u_2^0 = 1$，而所有其他内部网格点的值为零（$u_1^0 = 0$ 和 $u_3^0 = 0$）。\n\n计算经过两个时间步后（即在 $n=2$ 时），空间点 $x_2 = 0.5$ 处的数值解 $u_2^2$ 的值。请将您的答案以保留两位有效数字的小数形式给出。", "solution": "我们使用 FTCS 更新公式\n$$\nu_{j}^{n+1}=u_{j}^{n}+s\\left(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}\\right),\n$$\n其中 $s=0.6$，内部索引为 $j=1,2,3$，狄利克雷边界条件为 $u_{0}^{n}=0$ 和 $u_{4}^{n}=0$（对于所有 $n$）。初始数据为 $u_{2}^{0}=1$ 和 $u_{1}^{0}=u_{3}^{0}=0$。\n\n第一个时间步 $n=0\\to 1$：\n$$\nu_{1}^{1}=u_{1}^{0}+s\\left(u_{2}^{0}-2u_{1}^{0}+u_{0}^{0}\\right)=0+0.6(1-0+0)=0.6,\n$$\n$$\nu_{2}^{1}=u_{2}^{0}+s\\left(u_{3}^{0}-2u_{2}^{0}+u_{1}^{0}\\right)=1+0.6\\left(0-2\\cdot 1+0\\right)=1-1.2=-0.2,\n$$\n$$\nu_{3}^{1}=u_{3}^{0}+s\\left(u_{4}^{0}-2u_{3}^{0}+u_{2}^{0}\\right)=0+0.6(0-0+1)=0.6.\n$$\n\n第二个时间步 $n=1\\to 2$：\n$$\nu_{2}^{2}=u_{2}^{1}+s\\left(u_{3}^{1}-2u_{2}^{1}+u_{1}^{1}\\right)=-0.2+0.6\\left(0.6-2(-0.2)+0.6\\right)\n=-0.2+0.6(1.6)=0.76.\n$$\n\n因此，在经过两个时间步后，在 $x_{2}=0.5$ 处，$u_{2}^{2}=0.76$，这个结果已经有两位有效数字。", "answer": "$$\\boxed{0.76}$$", "id": "2101701"}]}