{"hands_on_practices": [{"introduction": "当一个数据驱动算法提出一个偏微分方程作为潜在的物理定律时，我们的首要任务是验证这个模型的优劣。一个核心的量化指标是“残差”，它衡量了所提议方程在给定数据上的不匹配程度。本练习将指导你通过一个具体案例，学习如何使用有限差分法来近似导数，并计算一个知名偏微分方程（无粘性伯格斯方程）的残差，这是评估任何数据驱动发现模型有效性的基本功。", "problem": "在数据驱动的科学发现领域，算法被用来从实验数据中寻找控制律。假设您正在测试一种算法，该算法提出了无粘性Burgers方程，一个基本的偏微分方程（PDE），作为代表一维波动现象的数据集的模型。所提出的方程是：\n$$u_t + u u_x = 0$$\n其中 $u(x, t)$ 是在位置 $x$ 和时间 $t$ 上的波幅， $u_t = \\frac{\\partial u}{\\partial t}$，以及 $u_x = \\frac{\\partial u}{\\partial x}$。\n\n您的任务是定量评估这个所提出模型的质量。给定 $u(x,t)$ 在均匀网格上的离散数据如下，网格间距为 $\\Delta x = 0.1$ 和 $\\Delta t = 0.1$：\n\n| | $x=0.0$ | $x=0.1$ | $x=0.2$ | $x=0.3$ |\n| :--- | :---: | :---: | :---: | :---: |\n| **$t=0.0$** | 1.00 | 1.10 | 1.30 | 1.60 |\n| **$t=0.1$** | 0.90 | 1.00 | 1.20 | 1.50 |\n| **$t=0.2$** | 0.80 | 0.90 | 1.10 | 1.40 |\n\n为了衡量误差，您将计算均方残差。在点 $(x, t)$ 处偏微分方程的残差是将数据代入方程得到的值：$R(x, t) = u_t + u u_x$。\n\n使用二阶中心差分近似来计算导数，计算所有可以进行这种近似的内部网格点上的残差 $R(x, t)$。然后，计算残差平方的均值。\n\n将您的最终答案四舍五入到三位有效数字。", "solution": "目标是根据所提供的数据，计算所提出的偏微分方程（PDE）$u_t + u u_x = 0$ 的均方残差。在任意点 $(x, t)$ 的残差定义为 $R(x,t) = u_t + u u_x$。\n\n首先，我们必须确定可以使用二阶中心差分格式来近似导数的网格点。这种格式需要来自求导方向上相邻点的数据。\n在 $(x_i, t_j)$ 处 $u_t$ 的中心差分近似为 $u_t \\approx \\frac{u(x_i, t_{j+1}) - u(x_i, t_{j-1})}{2\\Delta t}$。\n在 $(x_i, t_j)$ 处 $u_x$ 的中心差分近似为 $u_x \\approx \\frac{u(x_{i+1}, t_j) - u(x_{i-1}, t_j)}{2\\Delta x}$。\n\n为了计算一个点的两个导数，我们需要它在 $x$ 和 $t$ 方向上的邻近点。给定 4x3 网格，一个点 $(x_i, t_j)$ 必须有邻近点 $(x_{i \\pm 1}, t_j)$ 和 $(x_i, t_{j \\pm 1})$。网格边界上的点不具备所有必需的邻近点。满足此条件的唯一点是“内部”点：\n1.  $P_1 = (x=0.1, t=0.1)$\n2.  $P_2 = (x=0.2, t=0.1)$\n\n有两个这样的内部点。我们将在每个点上计算残差。\n\n**步骤 1：计算在 $P_1 = (x=0.1, t=0.1)$ 处的残差**\n\n从数据表中，该点的函数值为 $u(0.1, 0.1) = 1.00$。给定的网格间距为 $\\Delta x = 0.1$ 和 $\\Delta t = 0.1$。\n\n近似计算在 $P_1$ 处的偏导数：\n对于 $u_t$：\n$u_t(0.1, 0.1) \\approx \\frac{u(0.1, 0.2) - u(0.1, 0.0)}{2 \\Delta t} = \\frac{0.90 - 1.10}{2 \\times 0.1} = \\frac{-0.20}{0.2} = -1.0$\n\n对于 $u_x$：\n$u_x(0.1, 0.1) \\approx \\frac{u(0.2, 0.1) - u(0.0, 0.1)}{2 \\Delta x} = \\frac{1.20 - 0.90}{2 \\times 0.1} = \\frac{0.30}{0.2} = 1.5$\n\n现在，计算残差 $R(P_1)$：\n$R(P_1) = u_t(0.1, 0.1) + u(0.1, 0.1) \\times u_x(0.1, 0.1)$\n$R(P_1) \\approx -1.0 + (1.00) \\times (1.5) = -1.0 + 1.5 = 0.5$\n\n**步骤 2：计算在 $P_2 = (x=0.2, t=0.1)$ 处的残差**\n\n从数据表中，该点的函数值为 $u(0.2, 0.1) = 1.20$。\n\n近似计算在 $P_2$ 处的偏导数：\n对于 $u_t$：\n$u_t(0.2, 0.1) \\approx \\frac{u(0.2, 0.2) - u(0.2, 0.0)}{2 \\Delta t} = \\frac{1.10 - 1.30}{2 \\times 0.1} = \\frac{-0.20}{0.2} = -1.0$\n\n对于 $u_x$：\n$u_x(0.2, 0.1) \\approx \\frac{u(0.3, 0.1) - u(0.1, 0.1)}{2 \\Delta x} = \\frac{1.50 - 1.00}{2 \\times 0.1} = \\frac{0.50}{0.2} = 2.5$\n\n现在，计算残差 $R(P_2)$：\n$R(P_2) = u_t(0.2, 0.1) + u(0.2, 0.1) \\times u_x(0.2, 0.1)$\n$R(P_2) \\approx -1.0 + (1.20) \\times (2.5) = -1.0 + 3.0 = 2.0$\n\n**步骤 3：计算均方残差**\n\n均方残差是在 $N=2$ 个内部点上计算的残差平方的平均值。\n均方残差 $= \\frac{R(P_1)^2 + R(P_2)^2}{N}$\n均方残差 $= \\frac{(0.5)^2 + (2.0)^2}{2} = \\frac{0.25 + 4.0}{2} = \\frac{4.25}{2} = 2.125$\n\n**步骤 4：对最终答案进行四舍五入**\n\n问题要求将最终答案四舍五入到三位有效数字。\n计算出的值为 $2.125$。四舍五入到三位有效数字得到 $2.13$。", "answer": "$$\\boxed{2.13}$$", "id": "2094881"}, {"introduction": "虽然数值方法是利用数据提取信息的强大工具，但它们并非完美无缺，其固有的近似误差有时会误导我们的科学判断。这个思想实验将揭示一个在数据驱动发现中至关重要的问题：数值离散化误差如何被错误地解读为真实的物理现象。通过分析一个由于传感器布局稀疏而导致纯扩散过程被误判为更复杂的反应-扩散过程的假想场景，你将深刻理解审慎评估数值方案对模型辨识结果影响的重要性。", "problem": "一位工程师正在研究一根细长杆中的热输运，其温度分布 $u(x, t)$ 由一维热方程控制，这是一个纯扩散过程：\n$$ \\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} $$\n已知热扩散系数为 $D = 0.01 \\text{ m}^2/\\text{s}$。该杆经过特殊处理，使其温度分布由以下特解描述：\n$$ u(x, t) = U_0 \\sin(kx) \\exp(-D k^2 t) $$\n其中振幅 $U_0 = 100 \\text{ K}$，波数 $k = \\pi \\text{ rad/m}$。\n\n然而，该工程师并不知道其真实的物理原理，而是提出了一个更普适的反应-扩散模型来描述该系统：\n$$ \\frac{\\partial u}{\\partial t} = \\nu \\frac{\\partial^2 u}{\\partial x^2} + c u $$\n其中 $\\nu$ 是扩散系数，$c$ 是线性反应系数。\n\n为了确定其模型的参数，该工程师部署了一个稀疏传感器阵列。他们将三个温度传感器分别放置在 $x_1 = x_0 - \\Delta x$、$x_2 = x_0$ 和 $x_3 = x_0 + \\Delta x$ 的位置，中心传感器位于 $x_0 = 0.25 \\text{ m}$，传感器间距为 $\\Delta x = 0.2 \\text{ m}$。\n\n在某个特定时刻（为简单起见，我们设为 $t=0$），该工程师执行以下步骤：\n1.  他们假设其模型中的扩散系数是正确的，设 $\\nu = D = 0.01 \\text{ m}^2/\\text{s}$。\n2.  他们测量中心传感器位置 $x_0$ 处的温度随时间的变化率 $\\frac{\\partial u}{\\partial t}$。您可以假设该测量值是完全准确的，并与从真实解中导出的解析值相对应。\n3.  他们使用基于三个传感器温度读数的标准二阶中心差分公式，来估计中心传感器位置 $x_0$ 处的空间二阶导数 $\\frac{\\partial^2 u}{\\partial x^2}$。\n4.  他们将这些值代入所提出的模型中，求解未知的反应系数 $c$。\n\n计算该工程师从此过程中错误推断出的反应系数 $c$ 的值。请用单位 $\\text{s}^{-1}$ 表示您的答案，并四舍五入到四位有效数字。", "solution": "真实的温度场为 $u(x,t)=U_{0}\\sin(kx)\\exp(-Dk^{2}t)$。在 $t=0$ 时，有 $u(x,0)=U_{0}\\sin(kx)$，而根据真实物理过程得到的精确时间导数，可以通过对解求导或使用热方程得到：\n$$\n\\left.\\frac{\\partial u}{\\partial t}\\right|_{t=0}=-Dk^{2}U_{0}\\sin(kx)=-Dk^{2}u(x,0).\n$$\n工程师假设反应-扩散模型为 $\\frac{\\partial u}{\\partial t}=\\nu\\frac{\\partial^{2}u}{\\partial x^{2}}+cu$，并设 $\\nu=D$。在 $x=x_{0}$ 和 $t=0$ 时，他们使用位于 $x_{0}\\pm\\Delta x$ 的传感器，通过二阶中心差分计算二阶导数：\n$$\n\\left.\\frac{\\partial^{2}u}{\\partial x^{2}}\\right|_{x_{0},\\,\\text{FD}}=\\frac{u(x_{0}+\\Delta x,0)-2u(x_{0},0)+u(x_{0}-\\Delta x,0)}{\\Delta x^{2}}.\n$$\n利用 $u(x,0)=U_{0}\\sin(kx)$ 以及和角公式，\n$$\nu(x_{0}\\pm\\Delta x,0)=U_{0}\\sin(kx_{0}\\pm k\\Delta x)=U_{0}\\left[\\sin(kx_{0})\\cos(k\\Delta x)\\pm\\cos(kx_{0})\\sin(k\\Delta x)\\right],\n$$\n所以\n$$\nu(x_{0}+\\Delta x,0)+u(x_{0}-\\Delta x,0)=2U_{0}\\sin(kx_{0})\\cos(k\\Delta x)=2u(x_{0},0)\\cos(k\\Delta x).\n$$\n因此，\n$$\n\\left.\\frac{\\partial^{2}u}{\\partial x^{2}}\\right|_{x_{0},\\,\\text{FD}}=\\frac{2u(x_{0},0)\\left[\\cos(k\\Delta x)-1\\right]}{\\Delta x^{2}}.\n$$\n工程师将精确的 $\\left.\\frac{\\partial u}{\\partial t}\\right|_{t=0}=-Dk^{2}u(x_{0},0)$、假设的 $\\nu=D$ 以及有限差分估计值代入模型以求解 $c$：\n$$\n-Dk^{2}u(x_{0},0)=D\\left.\\frac{\\partial^{2}u}{\\partial x^{2}}\\right|_{x_{0},\\,\\text{FD}}+c\\,u(x_{0},0),\n$$\n$$\nc=\\frac{-Dk^{2}u(x_{0},0)-D\\left.\\frac{\\partial^{2}u}{\\partial x^{2}}\\right|_{x_{0},\\,\\text{FD}}}{u(x_{0},0)}=-D\\left[k^{2}+\\frac{2\\left(\\cos(k\\Delta x)-1\\right)}{\\Delta x^{2}}\\right].\n$$\n现在代入给定的数值 $D=0.01\\,\\text{m}^{2}\\,\\text{s}^{-1}$、$k=\\pi\\,\\text{rad}\\,\\text{m}^{-1}$ 和 $\\Delta x=0.2\\,\\text{m}$：\n$$\n\\cos(k\\Delta x)=\\cos(0.2\\pi)=\\cos\\!\\left(\\frac{\\pi}{5}\\right)\\approx 0.809016994,\n$$\n$$\n\\frac{2\\left(\\cos(k\\Delta x)-1\\right)}{\\Delta x^{2}}=\\frac{2(0.809016994-1)}{0.2^{2}}\\approx\\frac{-0.381966011}{0.04}\\approx -9.549150281,\n$$\n$$\nk^{2}=\\pi^{2}\\approx 9.869604401,\\quad k^{2}+\\frac{2\\left(\\cos(k\\Delta x)-1\\right)}{\\Delta x^{2}}\\approx 9.869604401-9.549150281=0.320454120,\n$$\n$$\nc=-D\\left(\\cdots\\right)\\approx -0.01\\times 0.320454120=-0.00320454120\\ \\text{s}^{-1}.\n$$\n四舍五入到四位有效数字，推断出的反应系数为 $-0.003205\\ \\text{s}^{-1}$。", "answer": "$$\\boxed{-0.003205}$$", "id": "2094867"}, {"introduction": "鉴于有限差分法在处理稀疏或复杂数据时可能存在的陷阱，探索更精确的数值技术变得至关重要。谱方法，尤其适用于平滑的周期性数据，提供了一种计算导数的高精度替代方案。本练习将带你深入了解如何应用谱微分来计算一个非线性平流项——这是为稀疏回归算法构建候选 PDE 项库的关键一步，从而让你掌握从数据中精确构建方程“积木”的核心技能。", "problem": "在数据驱动的科学发现领域，一个常见的任务是从测量数据中推断出系统的控制偏微分方程(PDE)。对此，一种强大的技术是基于一个候选项偏微分方程项库，构建一个大型的、超定的线性系统，然后使用稀疏回归来找出构成真实方程的少数几个项。\n\n考虑一个定义在长度为 $L$ 的一维周期性域上的标量场 $u(x, t)$。该场在离散空间网格 $x_j = j \\frac{L}{N}$（其中 $j=0, 1, \\dots, N-1$）上进行测量。在特定的时刻 $t_0$，测量数据可以由以下函数完美描述：\n$$\nu(x, t_0) = \\alpha \\cos\\left(\\frac{2\\pi m_1}{L} x\\right) + \\beta \\sin\\left(\\frac{2\\pi m_2}{L} x\\right)\n$$\n此处，$\\alpha$ 和 $\\beta$ 是实值振幅，$m_1$ 和 $m_2$ 是代表空间波数的不同的正整数。\n\n你的任务是帮助为该发现算法构建线性系统。该库中一个提出的候选项是非线性平流项 $u \\frac{\\partial u}{\\partial x}$。为计算该项，你必须使用谱方法微分，从给定的离散数据中计算空间导数 $\\frac{\\partial u}{\\partial x}$。你可以假设网格点数 $N$ 足够大，以至于 $m_1, m_2 \\ll N/2$，这意味着可以忽略混叠效应，并且可以使用连续傅里叶变换的性质。\n\n计算候选项 $u \\frac{\\partial u}{\\partial x}$ 在空间网格点 $x_j$ 处的值。你的最终答案应该是一个用给定参数 $\\alpha, \\beta, L, m_1, m_2,$ 和网格索引 $j$ 表示的符号表达式。为清晰起见，将所有给定的符号参数视为无量纲的。", "solution": "我们已知在时刻 $t_{0}$ 的标量场为：\n$$\nu(x,t_{0})=\\alpha \\cos\\left(\\frac{2\\pi m_{1}}{L}x\\right)+\\beta \\sin\\left(\\frac{2\\pi m_{2}}{L}x\\right).\n$$\n在周期性域上，谱方法微分通过将每个傅里叶模式乘以其对应的波数来进行精确微分。令\n$$\nk_{1}=\\frac{2\\pi m_{1}}{L},\\qquad k_{2}=\\frac{2\\pi m_{2}}{L}.\n$$\n那么空间导数为\n$$\n\\frac{\\partial u}{\\partial x}(x,t_{0})=-\\alpha k_{1}\\sin(k_{1}x)+\\beta k_{2}\\cos(k_{2}x).\n$$\n非线性平流候选项为 $u\\,\\partial u/\\partial x$，所以\n$$\nu\\frac{\\partial u}{\\partial x}=\\left[\\alpha \\cos(k_{1}x)+\\beta \\sin(k_{2}x)\\right]\\left[-\\alpha k_{1}\\sin(k_{1}x)+\\beta k_{2}\\cos(k_{2}x)\\right].\n$$\n展开并使用积化和差恒等式\n$\\cos\\theta\\sin\\theta=\\tfrac{1}{2}\\sin(2\\theta)$,\n$\\cos A\\cos B=\\tfrac{1}{2}\\left[\\cos(A-B)+\\cos(A+B)\\right]$,\n$\\sin A\\sin B=\\tfrac{1}{2}\\left[\\cos(A-B)-\\cos(A+B)\\right]$,\n我们得到\n$$\nu\\frac{\\partial u}{\\partial x}\n=-\\frac{\\alpha^{2}k_{1}}{2}\\sin(2k_{1}x)\n+\\frac{\\alpha\\beta}{2}\\left[(k_{2}-k_{1})\\cos\\big((k_{1}-k_{2})x\\big)+(k_{2}+k_{1})\\cos\\big((k_{1}+k_{2})x\\big)\\right]\n+\\frac{\\beta^{2}k_{2}}{2}\\sin(2k_{2}x).\n$$\n在网格点 $x_{j}=j\\frac{L}{N}$ 处求值，我们有 $k_{1}x_{j}=\\frac{2\\pi m_{1}j}{N}$ 和 $k_{2}x_{j}=\\frac{2\\pi m_{2}j}{N}$。代入 $k_{1}=\\frac{2\\pi m_{1}}{L}$ 和 $k_{2}=\\frac{2\\pi m_{2}}{L}$ 可得\n$$\nu(x_{j},t_{0})\\frac{\\partial u}{\\partial x}(x_{j},t_{0})\n=\\frac{1}{2}\\frac{2\\pi}{L}\\Big[\n-\\alpha^{2}m_{1}\\sin\\!\\left(\\frac{4\\pi m_{1}j}{N}\\right)\n+\\alpha\\beta(m_{2}-m_{1})\\cos\\!\\left(\\frac{2\\pi (m_{1}-m_{2})j}{N}\\right)\n+\\alpha\\beta(m_{2}+m_{1})\\cos\\!\\left(\\frac{2\\pi (m_{1}+m_{2})j}{N}\\right)\n+\\beta^{2}m_{2}\\sin\\!\\left(\\frac{4\\pi m_{2}j}{N}\\right)\n\\Big].\n$$\n等价地，\n$$\nu(x_{j},t_{0})\\frac{\\partial u}{\\partial x}(x_{j},t_{0})\n=\\frac{\\pi}{L}\\Big[\n-\\alpha^{2}m_{1}\\sin\\!\\left(\\frac{4\\pi m_{1}j}{N}\\right)\n+\\alpha\\beta(m_{2}-m_{1})\\cos\\!\\left(\\frac{2\\pi (m_{1}-m_{2})j}{N}\\right)\n+\\alpha\\beta(m_{2}+m_{1})\\cos\\!\\left(\\frac{2\\pi (m_{1}+m_{2})j}{N}\\right)\n+\\beta^{2}m_{2}\\sin\\!\\left(\\frac{4\\pi m_{2}j}{N}\\right)\n\\Big].\n$$\n这就是候选项在网格点 $x_{j}$ 处，用给定参数和网格索引 $j$ 表示的所求符号表达式。", "answer": "$$\\boxed{\\frac{\\pi}{L}\\left[-\\alpha^{2}m_{1}\\sin\\!\\left(\\frac{4\\pi m_{1}j}{N}\\right)+\\alpha\\beta(m_{2}-m_{1})\\cos\\!\\left(\\frac{2\\pi (m_{1}-m_{2})j}{N}\\right)+\\alpha\\beta(m_{2}+m_{1})\\cos\\!\\left(\\frac{2\\pi (m_{1}+m_{2})j}{N}\\right)+\\beta^{2}m_{2}\\sin\\!\\left(\\frac{4\\pi m_{2}j}{N}\\right)\\right]}$$", "id": "2204924"}]}