{"hands_on_practices": [{"introduction": "有限元方法的核心思想是将一个复杂问题分解成更简单的部分，即“单元”。在每个单元内部，我们使用简单的多项式来近似未知函数。第一个练习就聚焦于这项基本技能：在单个一维单元上创建已知函数的线性近似，这是所有后续步骤的基础。[@problem_id:2115140]", "problem": "在有限元方法（FEM）中，一个复杂函数通常在一个大域上被一组更简单的分段多项式函数所近似。这些更简单的函数中的每一个都在一个称为有限元的、不重叠的小子域上定义。\n\n考虑一个表示空间区间 $[0, 2]$ 的一维线性有限元。一个连续函数 $f(x)$ 在此区间上定义为：\n$$f(x) = (x+1)\\exp(-x)$$\n您的任务是确定函数 $f(x)$ 在此单元上的线性有限元插值，我们将其表示为 $u_h(x)$。插值函数是一个线性函数，其在单元端点（节点）处的值与 $f(x)$ 的值相同。\n\n请用 $x$ 的函数表示您的答案。", "solution": "我们寻求在区间 $[0,2]$ 上的线性有限元插值 $u_{h}(x)$，它在端点处与 $f(x)=(x+1)\\exp(-x)$ 相匹配。对于节点在 $x_{1}=0$ 和 $x_{2}=2$ 的单个线性单元，拉格朗日形函数为\n$$\nN_{1}(x)=\\frac{x_{2}-x}{x_{2}-x_{1}}, \\qquad N_{2}(x)=\\frac{x-x_{1}}{x_{2}-x_{1}}.\n$$\n插值函数是\n$$\nu_{h}(x)=f(x_{1})\\,N_{1}(x)+f(x_{2})\\,N_{2}(x).\n$$\n计算节点值：\n$$\nf(0)=(0+1)\\exp(0)=1, \\qquad f(2)=(2+1)\\exp(-2)=3\\exp(-2).\n$$\n当 $x_{1}=0$ 和 $x_{2}=2$ 时，形函数变为\n$$\nN_{1}(x)=\\frac{2-x}{2}, \\qquad N_{2}(x)=\\frac{x}{2}.\n$$\n因此，\n$$\nu_{h}(x)=1\\cdot\\frac{2-x}{2}+\\left(3\\exp(-2)\\right)\\cdot\\frac{x}{2}\n=\\frac{2-x}{2}+\\frac{3\\exp(-2)\\,x}{2}\n=1+\\frac{x}{2}\\left(3\\exp(-2)-1\\right).\n$$\n这就是所求的线性插值函数。", "answer": "$$\\boxed{1+\\frac{x}{2}\\left(3\\exp(-2)-1\\right)}$$", "id": "2115140"}, {"introduction": "一旦我们近似了像温度这样的主要变量，我们常常需要计算由它衍生的物理量，例如热通量，这涉及到空间导数。本练习建立在插值的基础上，展示了如何在单元内计算这些衍生量。你将发现线性单元的一个关键特性：虽然场本身是线性变化的，但其梯度（以及因此产生的通量）在整个单元上是恒定的。[@problem_id:2115129]", "problem": "在使用有限元法 (FEM) 分析非均匀一维杆中的稳态热传导时，该杆被划分为一个由称为单元的较小段组成的网格。温度分布 $T(x)$ 由一个分段多项式函数 $T_h(x)$ 近似。\n\n考虑一种“P1”近似，其中近似温度分布 $T_h(x)$ 在每个单元上是线性的。让我们关注网格中的单个单元，该单元由空间区间 $[x_j, x_{j+1}]$ 定义。该单元的长度用 $h_j = x_{j+1} - x_j$ 表示。在此特定单元内，材料的热导率假定为常数 $k_j$。\n\n一个数值求解器已经计算出了单元端点（称为节点）处的近似温度。节点 $x_j$ 处的温度为 $T_j$，节点 $x_{j+1}$ 处的温度为 $T_{j+1}$。\n\n根据 Fourier 热传导定律，热通量由 $q(x) = -k(x) \\frac{dT}{dx}$ 给出。对于我们的有限元模型，单元内的近似热通量计算为 $q_h = -k_j \\frac{dT_h}{dx}$。由于温度近似 $T_h(x)$ 在单元上是线性的，其导数是常数，因此热通量 $q_h$ 在单元内也是常数。\n\n确定单元 $[x_j, x_{j+1}]$ 内此常数热通量 $q_h$ 的解析表达式。您的表达式应使用参数 $k_j$、$h_j$、$T_j$ 和 $T_{j+1}$ 来表示。", "solution": "我们在长度为 $h_{j}=x_{j+1}-x_{j}$ 的单元 $[x_{j},x_{j+1}]$ 上使用 P1（线性）有限元近似。节点值 $T_{j}$ 和 $T_{j+1}$ 之间的温度线性插值为\n$$\nT_{h}(x)=T_{j}\\,\\frac{x_{j+1}-x}{h_{j}}+T_{j+1}\\,\\frac{x-x_{j}}{h_{j}}.\n$$\n对 $x$ 求导，得到单元内的恒定梯度：\n$$\n\\frac{dT_{h}}{dx}=-\\frac{T_{j}}{h_{j}}+\\frac{T_{j+1}}{h_{j}}=\\frac{T_{j+1}-T_{j}}{h_{j}}.\n$$\n根据 Fourier 定律，热通量为 $q(x)=-k(x)\\,\\frac{dT}{dx}$。在单元上热导率为常数 $k_{j}$ 并使用有限元近似的情况下，单元上的常数通量为\n$$\nq_{h}=-k_{j}\\,\\frac{dT_{h}}{dx}=-k_{j}\\,\\frac{T_{j+1}-T_{j}}{h_{j}}=\\frac{k_{j}}{h_{j}}\\left(T_{j}-T_{j+1}\\right).\n$$\n因此，单元内常数热通量的解析表达式如上所述。", "answer": "$$\\boxed{\\frac{k_{j}}{h_{j}}\\left(T_{j}-T_{j+1}\\right)}$$", "id": "2115129"}, {"introduction": "本练习将所有概念整合在一起，引导你从头到尾完成一个完整但简单的结构分析问题。你将推导单元刚度矩阵，将它们组装成一个代表两单元杆的全局系统，施加边界条件，并求解节点位移。这个练习展示了有限元法在解决具体工程问题时的全部能力和完整流程。[@problem_id:2405079]", "problem": "一根笔直、均质的棱柱形杆，沿其轴线占据从 $x=0$ 到 $x=L_1+L_2$ 的区间，并发生微小的轴向变形。该杆具有恒定的横截面积 $A$ 和杨氏模量 $E$。左端 $x=0$ 处被固定，右端 $x=L_1+L_2$ 处施加了一个集中的轴向载荷 $P$。该杆使用有限元法（FEM）被离散为 $2$ 个不等长的线性两节点单元：单元 $1$ 跨越 $[0,L_1]$，节点为 $1$ 和 $2$；单元 $2$ 跨越 $[L_1,L_1+L_2]$，节点为 $2$ 和 $3$。杆上没有体力作用。\n\n从一维线弹性力学的第一性原理和平衡的变分（弱）形式出发，为该离散化组装全局刚度矩阵，在固定端施加本质边界条件，并求解得到的线性系统，以确定在施加载荷 $P$ 下节点 $3$ 的轴向位移。\n\n请以 $P$, $E$, $A$, $L_1$ 和 $L_2$ 的单个简化符号表达式形式提供您的最终答案。位移以米为单位表示。如果您进行任何中间近似，您的最终表达式必须是精确的（无舍入）。", "solution": "所述问题是在一维线弹性有限元法入门中一个有效、适定的问题。所有必要的信息，包括几何形状、材料属性、边界条件和具体的离散化方案，都已提供。该问题具有科学依据且客观。我们将继续进行求解。\n\n对于无体力作用下承受轴向载荷的棱柱形杆，其控制微分方程是平衡的强形式，由下式给出：\n$$\n- \\frac{d}{dx} \\left( EA \\frac{du}{dx} \\right) = 0 \\quad \\text{for } x \\in (0, L_1 + L_2)\n$$\n其中 $u(x)$ 是位置 $x$ 处的轴向位移，$E$ 是杨氏模量，$A$ 是横截面积。边界条件为固定端的本质（Dirichlet）条件 $u(0) = 0$，和加载端的自然（Neumann）条件 $EA \\frac{du}{dx}|_{x=L_1+L_2} = P$。\n\n为了推导变分形式或弱形式，我们将强形式乘以一个满足齐次本质边界条件（即 $v(0) = 0$）的足够光滑的检验函数 $v(x)$，并在域 $\\Omega = [0, L_1+L_2]$ 上积分：\n$$\n\\int_{0}^{L_1+L_2} v \\left( - \\frac{d}{dx} \\left( EA \\frac{du}{dx} \\right) \\right) dx = 0\n$$\n应用分部积分法 $\\int w \\, dz = wz - \\int z \\, dw$，令 $w=v$ 且 $dz = - \\frac{d}{dx} (EA \\frac{du}{dx}) dx$，得到：\n$$\n\\int_{0}^{L_1+L_2} EA \\frac{dv}{dx} \\frac{du}{dx} dx - \\left[ v \\left( EA \\frac{du}{dx} \\right) \\right]_{0}^{L_1+L_2} = 0\n$$\n计算边界项，我们有 $v(L_1+L_2) \\left( EA \\frac{du}{dx}|_{x=L_1+L_2} \\right) - v(0) \\left( EA \\frac{du}{dx}|_{x=0} \\right)$。由于 $v(0)=0$ 并且自然边界条件是 $EA \\frac{du}{dx}|_{x=L_1+L_2} = P$，弱形式变为：求 $u(x)$ 使得 $u(0)=0$ 且对于所有容许的检验函数 $v(x)$：\n$$\n\\int_{0}^{L_1+L_2} EA \\frac{dv}{dx} \\frac{du}{dx} dx = v(L_1+L_2) P\n$$\n在有限元法中，域被离散为单元。对于连接节点 $i$ 和 $j$ 的长度为 $L_e$ 的一般线性两节点杆单元，位移场 $u^{(e)}(x)$ 是通过线性形函数 $N_i(x)$ 和 $N_j(x)$ 从节点位移 $d_i$ 和 $d_j$ 插值得到的：$u^{(e)}(x) = N_i(x) d_i + N_j(x) d_j$。应变-位移矩阵 $\\mathbf{B}^{(e)}$ 将应变 $\\epsilon_x = \\frac{du}{dx}$ 与节点位移向量 $\\mathbf{d}^{(e)} = \\begin{pmatrix} d_i & d_j \\end{pmatrix}^T$ 联系起来。对于线性单元，$\\mathbf{B}^{(e)} = \\begin{pmatrix} \\frac{dN_i}{dx} & \\frac{dN_j}{dx} \\end{pmatrix} = \\frac{1}{L_e} \\begin{pmatrix} -1 & 1 \\end{pmatrix}$。\n单元刚度矩阵 $\\mathbf{k}^{(e)}$ 是从弱形式的左侧推导出来的，并在单元域 $\\Omega_e$ 上积分：\n$$\n\\mathbf{k}^{(e)} = \\int_{\\Omega_e} (\\mathbf{B}^{(e)})^T (EA) \\mathbf{B}^{(e)} dx = \\int_{0}^{L_e} \\frac{1}{L_e} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} (EA) \\frac{1}{L_e} \\begin{pmatrix} -1 & 1 \\end{pmatrix} dx\n$$\n由于 $E$、$A$ 和 $L_e$ 在单元上是常数，因此简化为：\n$$\n\\mathbf{k}^{(e)} = \\frac{EA}{L_e^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\int_{0}^{L_e} dx = \\frac{EA}{L_e} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n对于我们有 $2$ 个单元的特定问题：\n单元 $1$ 跨越 $[0, L_1]$，节点为 $1$ 和 $2$。其长度为 $L_e = L_1$。刚度矩阵为：\n$$\n\\mathbf{k}^{(1)} = \\frac{EA}{L_1} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\quad \\text{对应于自由度 } d_1, d_2\n$$\n单元 $2$ 跨越 $[L_1, L_1+L_2]$，节点为 $2$ 和 $3$。其长度为 $L_e = L_2$。刚度矩阵为：\n$$\n\\mathbf{k}^{(2)} = \\frac{EA}{L_2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\quad \\text{对应于自由度 } d_2, d_3\n$$\n这个 $3$ 节点系统的全局刚度矩阵 $\\mathbf{K}$ 是通过对每个单元的贡献求和来组装的：\n$$\n\\mathbf{K} = \\begin{pmatrix}\n\\frac{EA}{L_1} & -\\frac{EA}{L_1} & 0 \\\\\n-\\frac{EA}{L_1} & \\frac{EA}{L_1} + \\frac{EA}{L_2} & -\\frac{EA}{L_2} \\\\\n0 & -\\frac{EA}{L_2} & \\frac{EA}{L_2}\n\\end{pmatrix} = EA \\begin{pmatrix}\n\\frac{1}{L_1} & -\\frac{1}{L_1} & 0 \\\\\n-\\frac{1}{L_1} & \\frac{1}{L_1} + \\frac{1}{L_2} & -\\frac{1}{L_2} \\\\\n0 & -\\frac{1}{L_2} & \\frac{1}{L_2}\n\\end{pmatrix}\n$$\n全局线性方程组为 $\\mathbf{K}\\mathbf{d} = \\mathbf{F}$，其中 $\\mathbf{d} = \\begin{pmatrix} d_1 & d_2 & d_3 \\end{pmatrix}^T$ 是全局位移向量，$\\mathbf{F} = \\begin{pmatrix} F_1 & F_2 & F_3 \\end{pmatrix}^T$ 是全局力向量。在这里，$F_1$ 是节点 $1$ 处的未知反力，$F_2=0$ 因为在节点 $2$ 没有施加载荷，$F_3=P$ 是在节点 $3$ 施加的载荷。该系统为：\n$$\nEA \\begin{pmatrix}\n\\frac{1}{L_1} & -\\frac{1}{L_1} & 0 \\\\\n-\\frac{1}{L_1} & \\frac{1}{L_1} + \\frac{1}{L_2} & -\\frac{1}{L_2} \\\\\n0 & -\\frac{1}{L_2} & \\frac{1}{L_2}\n\\end{pmatrix}\n\\begin{pmatrix} d_1 \\\\ d_2 \\\\ d_3 \\end{pmatrix} =\n\\begin{pmatrix} F_1 \\\\ 0 \\\\ P \\end{pmatrix}\n$$\n我们施加本质边界条件 $d_1 = 0$。这使我们能够使用一个简化的系统来求解未知位移 $d_2$ 和 $d_3$。通过消除第一行和第一列（因为它们与已知位移 $d_1$ 相关），并在剩余方程中设置 $d_1=0$，我们得到：\n$$\nEA \\begin{pmatrix}\n\\frac{1}{L_1} + \\frac{1}{L_2} & -\\frac{1}{L_2} \\\\\n-\\frac{1}{L_2} & \\frac{1}{L_2}\n\\end{pmatrix}\n\\begin{pmatrix} d_2 \\\\ d_3 \\end{pmatrix} =\n\\begin{pmatrix} 0 \\\\ P \\end{pmatrix}\n$$\n这给出了两个代数方程：\n$$\n(1) \\quad EA \\left( \\left(\\frac{1}{L_1} + \\frac{1}{L_2}\\right) d_2 - \\frac{1}{L_2} d_3 \\right) = 0\n$$\n$$\n(2) \\quad EA \\left( -\\frac{1}{L_2} d_2 + \\frac{1}{L_2} d_3 \\right) = P\n$$\n从方程 $(2)$，我们可以写出：\n$$\n\\frac{EA}{L_2} (d_3 - d_2) = P \\implies d_3 - d_2 = \\frac{PL_2}{EA}\n$$\n这在物理上是正确的：单元 $2$ 的伸长量是 $d_3-d_2$，它等于 $\\frac{F_{int} L_2}{EA}$，其中单元 $2$ 的内力是 $P$。\n从方程 $(1)$，我们有：\n$$\n\\left(\\frac{L_1 + L_2}{L_1 L_2}\\right) d_2 = \\frac{1}{L_2} d_3 \\implies d_2 = \\frac{L_1}{L_1+L_2} d_3\n$$\n现在我们将 $d_2$ 的这个表达式代入重新整理的方程 $(2)$：\n$$\nd_3 - \\left(\\frac{L_1}{L_1+L_2}\\right) d_3 = \\frac{PL_2}{EA}\n$$\n$$\nd_3 \\left( 1 - \\frac{L_1}{L_1+L_2} \\right) = \\frac{PL_2}{EA}\n$$\n$$\nd_3 \\left( \\frac{L_1+L_2-L_1}{L_1+L_2} \\right) = \\frac{PL_2}{EA}\n$$\n$$\nd_3 \\left( \\frac{L_2}{L_1+L_2} \\right) = \\frac{PL_2}{EA}\n$$\n求解节点 $3$ 的位移 $d_3$，我们发现：\n$$\nd_3 = \\frac{PL_2}{EA} \\left( \\frac{L_1+L_2}{L_2} \\right) = \\frac{P(L_1+L_2)}{EA}\n$$\n该结果与长度为 $L_1+L_2$ 的杆的总伸长量的精确解析解相同，这对于此问题是预期的，因为对于点载荷下的一维杆，使用线性单元的有限元解对于节点位移是精确的。单位是 $\\frac{[N][m]}{[N/m^2][m^2]} = [m]$，这对于位移是正确的。", "answer": "$$\n\\boxed{\\frac{P(L_1+L_2)}{EA}}\n$$", "id": "2405079"}]}