{"hands_on_practices": [{"introduction": "在进行数值模拟时，首要任务之一是设定合适的参数。这个练习模拟沿传输线传播的信号，要求您根据给定的物理速度、空间步长和目标 Courant 数来计算所需的时间步长。这个实践旨在让您熟练运用 Courant-Friedrichs-Lewy (CFL) 条件的基本公式 $C = |v| \\frac{\\Delta t}{\\Delta x}$。掌握这种直接计算对于任何使用显式格式的模拟的初始设置都至关重要，它可以确保从一开始就选择稳定的参数组合。[@problem_id:2139558]", "problem": "一个计算科学家团队正在模拟信号沿一维传输线的传播。信号电压 $u(x, t)$ 的行为由线性平流方程建模：\n$$ \\frac{\\partial u}{\\partial t} + v \\frac{\\partial u}{\\partial x} = 0 $$\n其中 $v$ 是信号的恒定传播速度。\n\n该模拟在具有均匀空间步长 $\\Delta x$ 的网格上使用有限差分格式。所选的数值方法已知仅在满足 Courant-Friedrichs-Lewy (CFL) 条件时才稳定。库朗数 $C$ 定义为 $C = |v| \\frac{\\Delta t}{\\Delta x}$，其中 $\\Delta t$ 是时间步长。\n\n对于此特定模拟，传播速度为 $v = 2.5 \\times 10^8$ m/s，空间步长为 $\\Delta x = 1.25$ cm。为确保高精度并避免数值振荡，该团队决定在库朗数恰好为 $C = 0.75$ 的条件下运行。\n\n此次模拟所需的时间步长 $\\Delta t$ 是多少？请用纳秒 (ns) 表示答案，并四舍五入到两位有效数字。", "solution": "我们使用线性平流方程离散化的库朗数定义：\n$$\nC=\\frac{|v|\\,\\Delta t}{\\Delta x}.\n$$\n求解时间步长可得\n$$\n\\Delta t=\\frac{C\\,\\Delta x}{|v|}.\n$$\n代入给定值，并将空间步长转换为米：$\\Delta x=1.25\\times 10^{-2}\\ \\text{m}$， $|v|=2.5\\times 10^{8}\\ \\text{m s}^{-1}$，以及 $C=0.75$：\n$$\n\\Delta t=\\frac{0.75\\,(1.25\\times 10^{-2})}{2.5\\times 10^{8}}\\ \\text{s}.\n$$\n计算数值因子：\n$$\n\\Delta t=\\frac{0.9375\\times 10^{-2}}{2.5\\times 10^{8}}\\ \\text{s}\n=\\left(\\frac{0.9375}{2.5}\\right)\\times 10^{-10}\\ \\text{s}\n=0.375\\times 10^{-10}\\ \\text{s}\n=3.75\\times 10^{-11}\\ \\text{s}.\n$$\n使用 $1\\ \\text{ns}=10^{-9}\\ \\text{s}$ 转换为纳秒：\n$$\n\\Delta t=3.75\\times 10^{-11}\\ \\text{s}=3.75\\times 10^{-2}\\ \\text{ns}=0.0375\\ \\text{ns}.\n$$\n四舍五入到两位有效数字，得到 $0.038\\ \\text{ns}$。", "answer": "$$\\boxed{0.038}$$", "id": "2139558"}, {"introduction": "从一阶平流方程到二阶波动方程是常见的进阶。本练习模拟同轴电缆中的电压脉冲，该过程由波动方程 $u_{tt} = c^2 u_{xx}$ 描述。您需要确定在保证数值解稳定的前提下，所能使用的最大时间步长 $\\Delta t$。这个练习让您掌握如何从偏微分方程中识别波速 $c$，并应用 CFL 条件来寻找稳定性的边界，这在平衡计算效率与稳定性方面是一项关键的实用技能。[@problem_id:2139541]", "problem": "一位工程师正在为一种特殊同轴电缆上的电压脉冲传播开发数值模拟。在一个简化的一维模型中，位置 $x$ 和时间 $t$ 处的电压 $u(x, t)$ 由波动方程决定：\n$$ \\frac{\\partial^2 u}{\\partial t^2} = 16 \\frac{\\partial^2 u}{\\partial x^2} $$\n其中 $x$ 的单位是米，$t$ 的单位是秒。\n\n该工程师决定使用标准的显式有限差分格式来数值求解此方程。用于模拟的空间网格设置为均匀间距 $\\Delta x = 0.05$ 米。为了确保数值解的稳定性，必须仔细选择时间步长 $\\Delta t$。\n\n在满足此格式的 Courant-Friedrichs-Lewy (CFL) 稳定条件的情况下，可以使用的最大时间步长 $\\Delta t$ 是多少？答案以秒为单位，并四舍五入到三位有效数字。", "solution": "我们从以标准形式写出的一维波动方程开始\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}}=c^{2}\\frac{\\partial^{2} u}{\\partial x^{2}},\n$$\n通过与给定方程 $\\frac{\\partial^{2} u}{\\partial t^{2}}=16\\,\\frac{\\partial^{2} u}{\\partial x^{2}}$ 比较，可知波速为 $c=4$。\n\n在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，一个标准的显式二阶有限差分（时间和空间中心）离散格式为\n$$\n\\frac{u_{j}^{n+1}-2u_{j}^{n}+u_{j}^{n-1}}{(\\Delta t)^{2}}=c^{2}\\frac{u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}}{(\\Delta x)^{2}}。\n$$\n重新整理得到更新公式\n$$\nu_{j}^{n+1}=2u_{j}^{n}-u_{j}^{n-1}+r^{2}\\left(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}\\right),\n$$\n其中 Courant 数定义为\n$$\nr=\\frac{c\\,\\Delta t}{\\Delta x}。\n$$\n\n为了确定稳定性约束，我们进行 von Neumann 分析，寻找形式为 $u_{j}^{n}=G^{n}\\exp(\\mathrm{i}\\kappa j\\Delta x)$ 的傅里叶模态解，其中 $G$ 是放大因子，$\\kappa$ 是波数。代入更新公式可得\n$$\nG-2+G^{-1}=r^{2}\\left(e^{\\mathrm{i}\\kappa\\Delta x}-2+e^{-\\mathrm{i}\\kappa\\Delta x}\\right)=-4r^{2}\\sin^{2}\\left(\\frac{\\kappa\\Delta x}{2}\\right)。\n$$\n等价地，\n$$\nG+G^{-1}=2\\left[1-2r^{2}\\sin^{2}\\left(\\frac{\\kappa\\Delta x}{2}\\right)\\right]。\n$$\n这意味着色散关系\n$$\n\\cos(\\omega\\Delta t)=1-2r^{2}\\sin^{2}\\left(\\frac{\\kappa\\Delta x}{2}\\right),\n$$\n因此，稳定性要求所有模态的 $|G|=1$，这成立的条件是对于所有 $\\kappa$，上式右侧都在区间 $[-1,1]$ 内。由于 $\\sin^{2}(\\cdot)\\in[0,1]$，对于所有 $\\kappa$，右侧的最小值为 $1-2r^{2}$。要求 $1-2r^{2}\\geq -1$ 可得\n$$\nr^{2}\\leq 1 \\quad\\Longleftrightarrow\\quad r\\leq 1。\n$$\n因此，该显式格式的 Courant-Friedrichs-Lewy 稳定条件是\n$$\n\\frac{c\\,\\Delta t}{\\Delta x}\\leq 1 \\quad\\Longrightarrow\\quad \\Delta t\\leq \\frac{\\Delta x}{c}。\n$$\n\n对于给定的数据，$\\Delta x=0.05$ 且 $c=4$，因此最大稳定时间步长为\n$$\n\\Delta t_{\\max}=\\frac{0.05}{4}=0.0125。\n$$\n四舍五入到三位有效数字，该值为 $0.0125$ 秒。", "answer": "$$\\boxed{0.0125}$$", "id": "2139541"}, {"introduction": "CFL 条件不仅仅是一个数学公式，它背后蕴含着深刻的物理原理。这个思想实验探讨了当波的传播方向反转（即速度 $c<0$）时，我们应如何调整数值格式。这迫使我们思考“迎风”格式的真正含义：数值格式必须从信息传来的方向获取信息。通过选择正确的离散化方案，您将深入理解 CFL 条件的物理本质——即数值依赖域必须包含物理依赖域——这是为双曲型偏微分方程设计稳定数值方法的基石。[@problem_id:2139542]", "problem": "考虑一维线性平流方程 $u_t + c u_x = 0$，它描述了一个以恒定速度 $c$ 传播的波。我们希望在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上数值求解此方程。令 $u_j^n$ 表示解 $u(x, t)$ 在网格点 $x_j = j \\Delta x$ 和时间 $t_n = n \\Delta t$ 处的数值近似解。\n\n对于正波速 $c > 0$，一种常用且稳定的数值方法是一阶迎风格式，它对时间导数使用向前差分，对空间导数使用向后差分。该格式由下式给出：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0\n$$\n只要满足 Courant-Friedrichs-Lewy (CFL) 条件 $0 \\le \\frac{c \\Delta t}{\\Delta x} \\le 1$，该格式就是稳定的。\n\n现在，考虑波速为负常数 $c < 0$ 的情况。物理波现在从右向左传播（沿 $x$ 减小的方向）。为了保持稳定性，必须修改有限差分格式以适应信息流动方向的这种变化。\n\n在适当的 CFL 条件下，以下哪种离散格式为 $c < 0$ 的平流方程提供了稳定的近似？\n\nA. $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0$\n\nB. $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_j^n}{\\Delta x} = 0$\n\nC. $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0$\n\nD. $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^{n+1} - u_j^{n+1}}{\\Delta x} = 0$\n\nE. $\\frac{u_j^{n+1} - u_j^{n-1}}{2\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0$", "solution": "我们考虑具有恒定速度 $c$ 的线性平流方程 $u_{t} + c u_{x} = 0$。对于 $c < 0$，特征线从右向左传播，因此数值格式必须使用来自迎风（右）侧的信息以保持稳定。这导致在当前时间层 $n$ 选择向前空间差分（$x$ 增加的方向）。\n\n引入 Courant 数 $\\nu = \\dfrac{c \\Delta t}{\\Delta x}$。对于备选格式\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + c \\frac{u_{j+1}^{n} - u_{j}^{n}}{\\Delta x} = 0,\n$$\n即选项 B，我们进行 von Neumann 分析。假设一个傅里叶模式 $u_{j}^{n} = \\hat{u}^{n} \\exp(i \\theta j)$，其中 $\\theta \\in \\mathbb{R}$。代入格式可得\n$$\n\\hat{u}^{n+1} e^{i \\theta j} = \\hat{u}^{n} e^{i \\theta j} - \\nu \\left(\\hat{u}^{n} e^{i \\theta (j+1)} - \\hat{u}^{n} e^{i \\theta j}\\right),\n$$\n所以由 $\\hat{u}^{n+1} = G \\hat{u}^{n}$ 定义的增长因子 $G$ 是\n$$\nG = 1 - \\nu \\left(e^{i \\theta} - 1\\right) = (1 + \\nu) - \\nu e^{i \\theta}.\n$$\n然后\n$$\n|G|^{2} = \\left((1+\\nu) - \\nu \\cos \\theta\\right)^{2} + \\left(\\nu \\sin \\theta\\right)^{2}\n= (1+\\nu)^{2} - 2 \\nu (1+\\nu) \\cos \\theta + \\nu^{2}.\n$$\n对于 $c < 0$，我们有 $\\nu \\leq 0$。如果 $-1 \\leq \\nu \\leq 0$，系数 $-2 \\nu (1+\\nu) \\geq 0$，因此 $|G|^{2}$ 关于 $\\theta$ 的最大值在 $\\cos \\theta = -1$ 处取得，得到\n$$\n\\max_{\\theta} |G|^{2} = (1+\\nu)^{2} + 2 \\nu (1+\\nu) + \\nu^{2} = (1 + 2 \\nu)^{2} \\leq 1,\n$$\n这恰好在 $-1 \\leq \\nu \\leq 0$ 时成立。因此，选项 B 在 CFL 条件 $-1 \\leq \\dfrac{c \\Delta t}{\\Delta x} \\leq 0$ 下是稳定的。\n\n为了排除其他选项：\n\n- 选项 A（空间后向差分）：该格式为\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + c \\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x} = 0.\n$$\n傅里叶分析得到 $G = (1 - \\nu) + \\nu e^{-i \\theta}$ 以及\n$$\n|G|^{2} = (1 - \\nu)^{2} - 2 \\nu (1 - \\nu) \\cos \\theta + \\nu^{2}.\n$$\n对于 $\\nu < 0$，系数 $-2 \\nu (1 - \\nu) > 0$，所以最大值在 $\\cos \\theta = -1$ 处取得，得到\n$$\n\\max_{\\theta} |G|^{2} = (1 - \\nu)^{2} + 2 \\nu (1 - \\nu) + \\nu^{2} = (1 - 2 \\nu)^{2} > 1,\n$$\n因此对于 $c < 0$ 是不稳定的。\n\n- 选项 C（FTCS 格式，空间中心差分）：该格式为\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + c \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2 \\Delta x} = 0,\n$$\n得到 $G = 1 - i \\nu \\sin \\theta$ 以及\n$$\n|G|^{2} = 1 + \\nu^{2} \\sin^{2} \\theta > 1\n$$\n对于任何非零的 $\\nu$ 和 $\\theta \\not\\in \\pi \\mathbb{Z}$；因此是无条件不稳定的。\n\n- 选项 D（在时间层 $n+1$ 的隐式向前差分）：该格式为\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + c \\frac{u_{j+1}^{n+1} - u_{j}^{n+1}}{\\Delta x} = 0,\n$$\n这导致\n$$\nG = \\frac{1}{1 + \\nu \\left(e^{i \\theta} - 1\\right)}.\n$$\n对于 $\\nu < 0$，可以发现\n$$\n\\min_{\\theta} \\left|1 + \\nu \\left(e^{i \\theta} - 1\\right)\\right|^{2} = 1,\n$$\n所以 $|G| \\leq 1$，没有 CFL 限制。虽然这是稳定的，但它是隐式格式，不符合题目在强调 CFL 条件时所要求的标准显式迎风格式。\n\n- 选项 E（时间上蛙跳格式，空间上单边差分）：递推关系变为\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - 2 \\nu \\left(u_{j}^{n} - u_{j-1}^{n}\\right),\n$$\n这得到增长多项式\n$$\nG^{2} + 2 \\nu \\left(1 - e^{-i \\theta}\\right) G - 1 = 0.\n$$\n根的乘积为 $-1$，所以除非在退化情况下，两个根的模不可能都小于等于 $1$；因此这是不稳定的。\n\n因此，在适当的 CFL 条件下，对于 $c < 0$ 稳定的显式迎风格式是选项 B。", "answer": "$$\\boxed{B}$$", "id": "2139542"}]}