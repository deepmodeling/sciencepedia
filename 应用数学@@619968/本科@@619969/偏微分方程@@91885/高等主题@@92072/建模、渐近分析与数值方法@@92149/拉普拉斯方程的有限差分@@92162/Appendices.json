{"hands_on_practices": [{"introduction": "将一个物理问题转化为可解的数学形式是数值方法的核心。这个练习将带你完成至关重要的第一步：为拉普拉斯方程建立线性方程组 $AU = b$。你将专注于处理狄利克雷边界条件——即边界上温度值为已知的最简单情况——并学习如何将这些已知的边界值构建成方程组右侧的向量 $b$ [@problem_id:2102015]。这个过程是连接连续偏微分方程和离散线性代数问题的关键桥梁。", "problem": "考虑一个方形板上的稳态热分布，由二维拉普拉斯方程 $\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0$ 描述。该板由单位正方形区域 $\\Omega = [0, 1] \\times [0, 1]$ 表示。区域边界上的温度 $u(x,y)$ 由以下狄利克雷条件指定：\n- 对于 $0 \\le x \\le 1$，$u(x, 0) = x$ (底边)\n- 对于 $0 \\le x \\le 1$，$u(x, 1) = 1$ (顶边)\n- 对于 $0 \\le y \\le 1$，$u(0, y) = y$ (左边)\n- 对于 $0 \\le y \\le 1$，$u(1, y) = 0$ (右边)\n\n为了找到区域内部 $u(x,y)$ 的近似解，我们采用有限差分法。该区域使用均匀网格进行离散化，在 $x$ 和 $y$ 方向上的步长均为 $h = 1/3$。这种离散化产生了一个包含四个内部点的 $2 \\times 2$ 网格。\n\n设网格点 $(x_i, y_j) = (ih, jh)$ 处温度 $u(x_i, y_j)$ 的近似值表示为 $u_{i,j}$。对四个内部网格点中的每一个应用拉普拉斯算子的标准五点差分格式，会得到一个形式为 $AU = b$ 的线性方程组。未知数向量 $U$ 包含四个内部点的温度近似值。未知数按字典序排列（从底行开始，逐行排列）。如果网格点由 $(i,j)$ 索引，其中 $i \\in \\{0, 1, 2, 3\\}$ 是列索引，$j \\in \\{0, 1, 2, 3\\}$ 是行索引，则内部点对应 $i,j \\in \\{1, 2\\}$。未知数向量的顺序为 $U = [u_{11}, u_{21}, u_{12}, u_{22}]^T$。\n\n确定该线性系统的右端向量 $b$。请将您的答案表示为列向量。", "solution": "我们使用标准的五点差分格式求解内部节点上的离散拉普拉斯方程。对于每个内部点 $(i,j)$，其中 $i,j \\in \\{1,2\\}$，离散化方程为\n$$\n\\frac{u_{i-1,j} + u_{i+1,j} + u_{i,j-1} + u_{i,j+1} - 4u_{i,j}}{h^{2}} = 0.\n$$\n两边乘以 $h^{2}$（这不会改变右端项，因为它为零），并重新整理，将已知边界值的贡献分离到右端，\n$$\n4u_{i,j} - \\sum_{\\text{内部邻点}} u - \\sum_{\\text{边界邻点}} u = 0\n\\quad \\Longrightarrow \\quad\n4u_{i,j} - \\sum_{\\text{内部邻点}} u = \\sum_{\\text{边界邻点}} u.\n$$\n因此，对于线性系统 $AU=b$，每个内部节点的右端项 $b$ 等于其相邻边界值的总和。\n\n当 $h=1/3$ 时，网格点为 $x,y \\in \\{0, \\frac{1}{3}, \\frac{2}{3}, 1\\}$。内部节点及其邻点如下：\n\n1) 对于位于 $(x,y)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 的 $u_{11}$，其邻点为：\n- 左边界点 $(0,\\frac{1}{3})$：$u(0,\\frac{1}{3}) = \\frac{1}{3}$，\n- 右侧内部点 $u_{21}$，\n- 底部边界点 $(\\frac{1}{3},0)$：$u(\\frac{1}{3},0) = \\frac{1}{3}$，\n- 顶部内部点 $u_{12}$。\n因此，\n$$\nb_{1} = u\\!\\left(0,\\tfrac{1}{3}\\right) + u\\!\\left(\\tfrac{1}{3},0\\right) = \\frac{1}{3} + \\frac{1}{3} = \\frac{2}{3}.\n$$\n\n2) 对于位于 $(x,y)=\\left(\\frac{2}{3},\\frac{1}{3}\\right)$ 的 $u_{21}$，其邻点为：\n- 左侧内部点 $u_{11}$，\n- 右边界点 $(1,\\frac{1}{3})$：$u(1,\\frac{1}{3}) = 0$，\n- 底部边界点 $(\\frac{2}{3},0)$：$u(\\frac{2}{3},0) = \\frac{2}{3}$，\n- 顶部内部点 $u_{22}$。\n因此，\n$$\nb_{2} = u\\!\\left(1,\\tfrac{1}{3}\\right) + u\\!\\left(\\tfrac{2}{3},0\\right) = 0 + \\frac{2}{3} = \\frac{2}{3}.\n$$\n\n3) 对于位于 $(x,y)=\\left(\\frac{1}{3},\\frac{2}{3}\\right)$ 的 $u_{12}$，其邻点为：\n- 左边界点 $(0,\\frac{2}{3})$：$u(0,\\frac{2}{3}) = \\frac{2}{3}$，\n- 右侧内部点 $u_{22}$，\n- 底部内部点 $u_{11}$，\n- 顶部边界点 $(\\frac{1}{3},1)$：$u(\\frac{1}{3},1) = 1$。\n因此，\n$$\nb_{3} = u\\!\\left(0,\\tfrac{2}{3}\\right) + u\\!\\left(\\tfrac{1}{3},1\\right) = \\frac{2}{3} + 1 = \\frac{5}{3}.\n$$\n\n4) 对于位于 $(x,y)=\\left(\\frac{2}{3},\\frac{2}{3}\\right)$ 的 $u_{22}$，其邻点为：\n- 左侧内部点 $u_{12}$，\n- 右边界点 $(1,\\frac{2}{3})$：$u(1,\\frac{2}{3}) = 0$，\n- 底部内部点 $u_{21}$，\n- 顶部边界点 $(\\frac{2}{3},1)$：$u(\\frac{2}{3},1) = 1$。\n因此，\n$$\nb_{4} = u\\!\\left(1,\\tfrac{2}{3}\\right) + u\\!\\left(\\tfrac{2}{3},1\\right) = 0 + 1 = 1.\n$$\n\n将未知数按 $U = [u_{11}, u_{21}, u_{12}, u_{22}]^{T}$ 的顺序排列，右端向量为\n$$\nb = \\begin{pmatrix}\n\\frac{2}{3} \\\\\n\\frac{2}{3} \\\\\n\\frac{5}{3} \\\\\n1\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{2}{3}\\\\\\frac{2}{3}\\\\\\frac{5}{3}\\\\1\\end{pmatrix}}$$", "id": "2102015"}, {"introduction": "一旦我们建立了线性方程组 $AU=b$，接下来的问题就是如何求解它。对于由偏微分方程离散化而来的大型稀疏矩阵，直接求逆（如计算 $A^{-1}$）的计算成本非常高，因此迭代法成为了更实用的选择。这个练习让你亲手体验雅可比法——一种经典迭代求解器——的第一步计算 [@problem_id:2102023]，从而直观地理解如何从一个初始猜测值开始，逐步逼近最终的解。", "problem": "考虑一个寻找薄方形金属板上稳态温度分布的问题。温度 $u$ 由拉普拉斯方程决定。该板由一个方形区域表示，该区域被离散化为一个均匀网格，整数索引为 $(i, j)$，其中 $i, j \\in \\{0, 1, 2, 3\\}$。其中 $i, j \\in \\{1, 2\\}$ 的点是网格的内部点，而边界上的点是那些 $i \\in \\{0, 3\\}$ 或 $j \\in \\{0, 3\\}$ 的点。\n\n每个内部点 $(i, j)$ 的温度使用五点有限差分公式进行近似，该公式表明该点的温度是其四个最近邻点的温度的平均值。这将该偏微分方程离散化为一个线性方程组。\n\n边界点的温度（单位为摄氏度，尽管单位与计算无关）被固定如下（狄利克雷边界条件）：\n- 底边：$u_{i,0} = 20$，对于 $i = 1, 2$。\n- 顶边：$u_{i,3} = 60$，对于 $i = 1, 2$。\n- 左边：$u_{0,j} = 40$，对于 $j = 1, 2$。\n- 右边：$u_{3,j} = 0$，对于 $j = 1, 2$。\n\n你的任务是近似四个内部点 $u_{1,1}, u_{1,2}, u_{2,1}, u_{2,2}$ 的温度。你将使用雅可比方法来求解该线性方程组。从所有内部点的初始猜测为零开始，即 $u_{i,j}^{(0)} = 0$ (对于 $i,j \\in \\{1, 2\\}$)，执行单次迭代来找到温度的第一次近似值。\n\n计算 $u_{1,1}^{(1)}, u_{1,2}^{(1)}, u_{2,1}^{(1)}$ 和 $u_{2,2}^{(1)}$ 的值。以这个特定顺序，将你的最终答案呈现为一组四个数字。", "solution": "在均匀网格上，内部节点 $(i,j)$ 处的离散拉普拉斯方程（使用五点格式）为\n$$\nu_{i,j}=\\frac{1}{4}\\left(u_{i+1,j}+u_{i-1,j}+u_{i,j+1}+u_{i,j-1}\\right).\n$$\n使用雅可比方法，所有内部点的初始猜测为 $u_{i,j}^{(0)}=0$，并使用固定的狄利克雷边界值，雅可比更新公式为\n$$\nu_{i,j}^{(k+1)}=\\frac{1}{4}\\left(u_{i+1,j}^{(k)}+u_{i-1,j}^{(k)}+u_{i,j+1}^{(k)}+u_{i,j-1}^{(k)}\\right),\n$$\n其中边界值按给定值代入。\n\n计算一次迭代后每个内部点的值：\n\n对于 $(1,1)$:\n$$\nu_{1,1}^{(1)}=\\frac{1}{4}\\left(u_{2,1}^{(0)}+u_{0,1}+u_{1,2}^{(0)}+u_{1,0}\\right)=\\frac{1}{4}\\left(0+40+0+20\\right)=15.\n$$\n\n对于 $(1,2)$:\n$$\nu_{1,2}^{(1)}=\\frac{1}{4}\\left(u_{2,2}^{(0)}+u_{0,2}+u_{1,3}+u_{1,1}^{(0)}\\right)=\\frac{1}{4}\\left(0+40+60+0\\right)=25.\n$$\n\n对于 $(2,1)$:\n$$\nu_{2,1}^{(1)}=\\frac{1}{4}\\left(u_{3,1}+u_{1,1}^{(0)}+u_{2,2}^{(0)}+u_{2,0}\\right)=\\frac{1}{4}\\left(0+0+0+20\\right)=5.\n$$\n\n对于 $(2,2)$:\n$$\nu_{2,2}^{(1)}=\\frac{1}{4}\\left(u_{3,2}+u_{1,2}^{(0)}+u_{2,3}+u_{2,1}^{(0)}\\right)=\\frac{1}{4}\\left(0+0+60+0\\right)=15.\n$$\n\n因此，按 $(u_{1,1}^{(1)},u_{1,2}^{(1)},u_{2,1}^{(1)},u_{2,2}^{(1)})$ 的顺序，这些值为 $(15,25,5,15)$。", "answer": "$$\\boxed{\\begin{pmatrix} 15 & 25 & 5 & 15 \\end{pmatrix}}$$", "id": "2102023"}, {"introduction": "真实世界的物理问题常常涉及比固定边界值更复杂的边界条件，例如绝热边界或恒定热流。本练习将你的技能提升到一个新的水平，教你如何处理诺伊曼边界条件 [@problem_id:2102030]。通过引入“虚拟点”的概念，你将学习如何修改位于边界（特别是角点）上的节点的差分格式，从而准确地模拟导数边界条件。掌握这项技术将使你能够解决更广泛、更贴近实际的工程和物理问题。", "problem": "一块薄的方形金属板被建模为一个热管理系统中的组件。对于稳态热分析，板上的温度分布 $T(x, y)$ 由二维拉普拉斯方程 $\\nabla^2 T = 0$ 控制。\n\n为了进行数值求解，该板被离散化为一个在 $x$ 和 $y$ 方向上间距均为 $h$ 的均匀网格。网格点 $(x_i, y_j) = (ih, jh)$ 处的温度记为 $T_{i,j}$。我们关心的是 $i \\ge 0$ 和 $j \\ge 0$ 的区域。\n\n板的边界条件如下：\n- 左边界，对应于直线 $x=0$ (或网格索引 $i=0$)，是绝热的。这意味着垂直于该边界的温度梯度为零。\n- 下边界，对应于直线 $y=0$ (或网格索引 $j=0$)，是均匀加热的。这导致一个垂直于该边界的、恒定的非零温度梯度，由关系式 $\\frac{\\partial T}{\\partial y} = -G$ 给出，其中 $G$ 是一个表示加热强度的正常数。\n\n您的任务是分析位于 $(i,j)=(0,0)$ 处的角节点。使用拉普拉斯算子的标准五点有限差分近似和边界导数的中心差分，推导温度 $T_{0,0}$ 的表达式。用域内相邻节点 $T_{1,0}$ 和 $T_{0,1}$ 的温度、网格间距 $h$ 以及加热常数 $G$ 来表示您的答案。", "solution": "该问题要求在给定边界条件下，推导板角点处温度 $T_{0,0}$ 的表达式。我们将使用有限差分法。\n\n稳态温度分布由拉普拉斯方程控制：\n$$ \\nabla^2 T = \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} = 0 $$\n\n我们在节点 $(i,j)=(0,0)$ 处使用五点中心差分格式来近似这个偏微分方程。其近似形式为：\n$$ \\frac{T_{i+1,j} - 2T_{i,j} + T_{i-1,j}}{h^2} + \\frac{T_{i,j+1} - 2T_{i,j} + T_{i,j-1}}{h^2} = 0 $$\n在节点 $(0,0)$ 处，该式变为：\n$$ \\frac{T_{1,0} - 2T_{0,0} + T_{-1,0}}{h^2} + \\frac{T_{0,1} - 2T_{0,0} + T_{0,-1}}{h^2} = 0 $$\n两边乘以 $h^2$，我们得到差分格式方程：\n$$ T_{1,0} + T_{-1,0} + T_{0,1} + T_{0,-1} - 4T_{0,0} = 0 $$\n这个方程涉及两个“虚拟”节点，$T_{-1,0}$ 和 $T_{0,-1}$，它们位于物理域之外。我们必须利用边界条件来消除它们。\n\n首先，考虑位于 $x=0$ (或 $i=0$) 处的绝热左边界。边界条件为 $\\frac{\\partial T}{\\partial x} = 0$。我们在节点 $(0,0)$ 处使用中心差分来近似这个导数：\n$$ \\frac{\\partial T}{\\partial x}\\bigg|_{(0,0)} \\approx \\frac{T(h, 0) - T(-h, 0)}{2h} = \\frac{T_{1,0} - T_{-1,0}}{2h} = 0 $$\n这意味着 $T_{-1,0} = T_{1,0}$。\n\n接下来，考虑位于 $y=0$ (或 $j=0$) 处的受热下边界。边界条件为 $\\frac{\\partial T}{\\partial y} = -G$。我们在节点 $(0,0)$ 处使用中心差分来近似这个导数：\n$$ \\frac{\\partial T}{\\partial y}\\bigg|_{(0,0)} \\approx \\frac{T(0, h) - T(0, -h)}{2h} = \\frac{T_{0,1} - T_{0,-1}}{2h} = -G $$\n求解虚拟节点 $T_{0,-1}$，我们得到：\n$$ T_{0,1} - T_{0,-1} = -2hG $$\n$$ T_{0,-1} = T_{0,1} + 2hG $$\n\n现在，我们将虚拟节点 $T_{-1,0}$ 和 $T_{0,-1}$ 的表达式代回到差分格式方程中：\n$$ T_{1,0} + (T_{1,0}) + T_{0,1} + (T_{0,1} + 2hG) - 4T_{0,0} = 0 $$\n\n合并同类项以简化表达式：\n$$ 2T_{1,0} + 2T_{0,1} + 2hG - 4T_{0,0} = 0 $$\n\n问题要求 $T_{0,0}$ 的表达式。我们整理该方程以求解 $T_{0,0}$：\n$$ 4T_{0,0} = 2T_{1,0} + 2T_{0,1} + 2hG $$\n\n最后，两边除以 4，我们得到所求的 $T_{0,0}$ 的表达式：\n$$ T_{0,0} = \\frac{2T_{1,0} + 2T_{0,1} + 2hG}{4} $$\n$$ T_{0,0} = \\frac{1}{2}(T_{1,0} + T_{0,1} + hG) $$\n该表达式给出了角节点的温度，用其在域内的相邻节点、网格间距和加热常数表示。", "answer": "$$\\boxed{\\frac{1}{2}(T_{1,0} + T_{0,1} + hG)}$$", "id": "2102030"}]}