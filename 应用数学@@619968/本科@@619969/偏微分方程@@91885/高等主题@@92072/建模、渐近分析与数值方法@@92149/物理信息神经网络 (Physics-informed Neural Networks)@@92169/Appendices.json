{"hands_on_practices": [{"introduction": "物理信息神经网络（PINN）的核心在于其损失函数，它如同“教师”一般，引导神经网络学习并遵守物理定律。在第一个实践中，我们将从一个基本的稳态问题——泊松方程入手，该方程描述了静电学、热传导等多种物理现象。你将亲手构建完整的损失函数，学习如何将区域内的控制方程和其边界上的条件进行数学编码，这是掌握 PINN 的第一步。[@problem_id:2126324]", "problem": "一位研究人员正在构建一个物理信息神经网络 (PINN)，以寻找二维方形区域内静电势 $V(x,y)$ 的近似解。该电势的物理行为由泊松方程描述：\n$$\n\\nabla^2 V(x,y) = -f(x,y)\n$$\n其中 $f(x,y)$ 代表给定的电荷分布密度，而 $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ 是拉普拉斯算子。该电势定义在域 $D = \\{(x,y) \\mid -L \\le x \\le L, -L \\le y \\le L\\}$ 上。该域的边界 $\\partial D$ 保持零电势（接地），这施加了边界条件 $V(x,y) = 0$ 对所有 $(x,y) \\in \\partial D$ 成立。\n\nPINN 模型（记为 $\\hat{V}(x,y; \\theta)$）通过最小化一个包含了该问题物理信息的损失函数 $L(\\theta)$ 来学习近似 $V(x,y)$。在这里，$\\theta$ 代表神经网络的所有可训练参数。该损失函数使用两组离散点进行计算：\n1.  一组 $N_{pde}$ 个配置点，$S_{pde} = \\{(x_i, y_i) \\mid i=1, \\dots, N_{pde}\\}$，位于域 $D$ 的内部。\n2.  一组 $N_{bc}$ 个边界点，$S_{bc} = \\{(x_j, y_j) \\mid j=1, \\dots, N_{bc}\\}$，位于边界 $\\partial D$ 上。\n\n总损失函数 $L(\\theta)$ 是两个均方误差项之和：一项用于控制偏微分方程 ($L_{pde}$)，另一项用于边界条件 ($L_{bc}$)。\n\n构建总损失函数 $L(\\theta) = L_{pde} + L_{bc}$ 的数学表达式。您的表达式应使用网络输出 $\\hat{V}$、其二阶偏导数、函数 $f$、给定的点集及其各自的大小 $N_{pde}$ 和 $N_{bc}$ 来表示。", "solution": "我们从控制泊松方程和边界条件开始：\n$$\n\\nabla^{2}V(x,y)=-f(x,y), \\quad V(x,y)=0 \\text{ for } (x,y)\\in \\partial D.\n$$\n物理信息神经网络通过 $\\hat{V}(x,y;\\theta)$ 来近似 $V$。在内部配置点 $(x_{i},y_{i})\\in S_{pde}$ 处的偏微分方程 (PDE) 残差，通过将泊松方程施加于 $\\hat{V}$ 来定义：\n$$\nr_{i}(\\theta)=\\nabla^{2}\\hat{V}(x_{i},y_{i};\\theta)+f(x_{i},y_{i}).\n$$\n根据拉普拉斯算子在二维中的定义，这等价于\n$$\nr_{i}(\\theta)=\\frac{\\partial^{2}\\hat{V}}{\\partial x^{2}}(x_{i},y_{i};\\theta)+\\frac{\\partial^{2}\\hat{V}}{\\partial y^{2}}(x_{i},y_{i};\\theta)+f(x_{i},y_{i}).\n$$\n在 $S_{pde}$ 上强制执行偏微分方程的均方误差则为\n$$\nL_{pde}(\\theta)=\\frac{1}{N_{pde}}\\sum_{i=1}^{N_{pde}}\\left(r_{i}(\\theta)\\right)^{2}=\\frac{1}{N_{pde}}\\sum_{i=1}^{N_{pde}}\\left(\\frac{\\partial^{2}\\hat{V}}{\\partial x^{2}}(x_{i},y_{i};\\theta)+\\frac{\\partial^{2}\\hat{V}}{\\partial y^{2}}(x_{i},y_{i};\\theta)+f(x_{i},y_{i})\\right)^{2}.\n$$\n在边界 $\\partial D$ 上的边界条件 $V=0$ 是通过在边界点 $(x_{j},y_{j})\\in S_{bc}$ 处惩罚 $\\hat{V}$ 与零的偏差来强制执行的：\n$$\nL_{bc}(\\theta)=\\frac{1}{N_{bc}}\\sum_{j=1}^{N_{bc}}\\left(\\hat{V}(x_{j},y_{j};\\theta)-0\\right)^{2}=\\frac{1}{N_{bc}}\\sum_{j=1}^{N_{bc}}\\left(\\hat{V}(x_{j},y_{j};\\theta)\\right)^{2}.\n$$\n因此，总损失是这两个均方误差项的和：\n$$\nL(\\theta)=L_{pde}(\\theta)+L_{bc}(\\theta)=\\frac{1}{N_{pde}}\\sum_{i=1}^{N_{pde}}\\left(\\frac{\\partial^{2}\\hat{V}}{\\partial x^{2}}(x_{i},y_{i};\\theta)+\\frac{\\partial^{2}\\hat{V}}{\\partial y^{2}}(x_{i},y_{i};\\theta)+f(x_{i},y_{i})\\right)^{2}+\\frac{1}{N_{bc}}\\sum_{j=1}^{N_{bc}}\\left(\\hat{V}(x_{j},y_{j};\\theta)\\right)^{2}.\n$$", "answer": "$$\\boxed{\\frac{1}{N_{pde}}\\sum_{i=1}^{N_{pde}}\\left(\\frac{\\partial^{2}\\hat{V}}{\\partial x^{2}}(x_{i},y_{i};\\theta)+\\frac{\\partial^{2}\\hat{V}}{\\partial y^{2}}(x_{i},y_{i};\\theta)+f(x_{i},y_{i})\\right)^{2}+\\frac{1}{N_{bc}}\\sum_{j=1}^{N_{bc}}\\left(\\hat{V}(x_{j},y_{j};\\theta)\\right)^{2}}$$", "id": "2126324"}, {"introduction": "掌握了稳态问题后，让我们引入时间维度。这个练习将处理经典的热方程，这是一个描述温度如何随时间演化的瞬态偏微分方程。你的任务是正确地组合总损失函数，它现在不仅必须包含对偏微分方程和边界条件的约束，还必须考虑系统在初始时刻的关键状态。[@problem_id:2126339]", "problem": "物理信息神经网络 (Physics-Informed Neural Network, PINN) 是一种机器学习模型，旨在寻找偏微分方程的近似解 $\\hat{u}(x, t; \\theta)$，其中 $\\theta$ 表示神经网络的可训练参数（权重和偏置）。其训练过程涉及最小化一个损失函数 $L(\\theta)$，该函数衡量网络输出在多大程度上满足整个问题，包括控制方程及其相关条件。\n\n考虑定义在空间域 $x \\in [-L, L]$ 和时间域 $t \\in [0, T]$ 上的函数 $u(x,t)$ 的一维热方程：\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}\n$$\n该方程满足一个不连续的初始条件和固定的边界条件：\n1.  **初始条件 (IC)：** 对于 $x \\in [-L, L]$，$u(x, 0) = H(x)$，其中 $H(x)$ 是亥维赛阶跃函数，定义为当 $x \\geq 0$ 时 $H(x) = 1$，当 $x < 0$ 时 $H(x) = 0$。\n2.  **边界条件 (BC)：** 对于 $t \\in [0, T]$，$u(-L, t) = 0$ 且 $u(L, t) = 1$。\n\n为了训练 PINN，我们基于在不同样本点集上计算的均方误差 (MSE) 定义了三个独立的损失分量：\n-   $L_{PDE}$：偏微分方程残差 $\\left(\\frac{\\partial \\hat{u}}{\\partial t} - \\alpha \\frac{\\partial^2 \\hat{u}}{\\partial x^2}\\right)$ 的均方误差，在从时空域内部 $(x, t) \\in (-L, L) \\times (0, T]$ 采样的 $N_f$ 个配置点集上计算。\n-   $L_{IC}$：网络预测值 $\\hat{u}(x, 0)$ 与真实初始条件 $H(x)$ 之间的均方误差，在从初始时间线 $(x, 0)$（其中 $x \\in [-L, L]$）采样的 $N_i$ 个点集上计算。\n-   $L_{BC}$：网络在空间边界上的预测值与真实值之间的均方误差，在从边界线 $(-L, t)$ 和 $(L, t)$（其中 $t \\in [0, T]$）采样的 $N_b$ 个点集上计算。\n\n下列哪个表达式代表了为训练 PINN 以找到此热传导问题的特定解而必须最小化的正确总损失函数 $L(\\theta)$？\n\nA. $L(\\theta) = L_{PDE} + L_{IC} + L_{BC}$\n\nB. $L(\\theta) = L_{IC} + L_{BC}$\n\nC. $L(\\theta) = L_{PDE}$\n\nD. $L(\\theta) = L_{PDE} + L_{BC}$\n\nE. $L(\\theta) = L_{PDE} + L_{IC}$", "solution": "我们寻求一个网络 $\\hat{u}(x,t;\\theta)$，它通过最小化一个强制执行以下条件的损失函数来满足热方程的初边值问题：\n- 在内部域 $(x,t)\\in(-L,L)\\times(0,T]$ 上的控制偏微分方程。\n- 在 $t=0$ 时，对于 $x\\in[-L,L]$ 的初始条件。\n- 在 $x=\\pm L$ 处，对于 $t\\in[0,T]$ 的边界条件。\n\n定义偏微分方程残差\n$$\nr(x,t;\\theta)=\\frac{\\partial \\hat{u}}{\\partial t}(x,t;\\theta)-\\alpha\\frac{\\partial^{2}\\hat{u}}{\\partial x^{2}}(x,t;\\theta).\n$$\n在各自的样本集上使用均方误差，三个损失函数分别为\n$$\nL_{PDE}(\\theta)=\\frac{1}{N_{f}}\\sum_{j=1}^{N_{f}}\\left[r\\!\\left(x^{f}_{j},t^{f}_{j};\\theta\\right)\\right]^{2},\n$$\n$$\nL_{IC}(\\theta)=\\frac{1}{N_{i}}\\sum_{j=1}^{N_{i}}\\left[\\hat{u}\\!\\left(x^{i}_{j},0;\\theta\\right)-H\\!\\left(x^{i}_{j}\\right)\\right]^{2},\n$$\n$$\nL_{BC}(\\theta)=\\frac{1}{N_{b}}\\sum_{j=1}^{N_{b}}\\left\\{\\left[\\hat{u}\\!\\left(-L,t^{b}_{j};\\theta\\right)-0\\right]^{2}+\\left[\\hat{u}\\!\\left(L,t^{b}_{j};\\theta\\right)-1\\right]^{2}\\right\\}.\n$$\n为了确定该初边值问题的特定解，最小化过程必须同时强制执行所有三个约束。没有初始条件 (IC) 和边界条件 (BC)，仅凭偏微分方程本身无法确定唯一的解；忽略 IC 或 BC 中的任何一个都会导致解不唯一或与所提问题不一致。因此，正确的总损失是所有三个分量的总和：\n$$\nL(\\theta)=L_{PDE}+L_{IC}+L_{BC}.\n$$\n在给定的选项中，这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "2126339"}, {"introduction": "PINN 的一个真正强大之处在于，它不仅能强制执行局部的微分方程，还能融入全局的物理原理。在这个进阶实践中，我们将探索波动方程及其最重要的特性之一：能量守恒。你将学习如何通过增加一个新项来增强标准损失函数，这个新项专门用来惩罚任何违反此基本守恒定律的行为，这项技术能显著提升所学解答的物理真实性和准确性。[@problem_id:2126322]", "problem": "物理信息神经网络（PINN）是一种机器学习模型，用于求解偏微分方程（PDE）的近似解 $\\hat{u}(x,t; \\theta)$，其中 $\\theta$ 表示网络的可训练参数。训练过程通过最小化一个损失函数来进行，该损失函数惩罚对已知物理定律、初始条件和边界条件的偏离。\n\n考虑在时空域 $(x,t) \\in [x_L, x_R] \\times [0, T]$ 上的一维线性波动方程：\n$$ \\frac{\\partial^2 u}{\\partial t^2} - c^2 \\frac{\\partial^2 u}{\\partial x^2} = 0 $$\n其中波速 $c$ 为常数。该系统满足初始条件 $u(x,0) = g(x)$ 和 $\\frac{\\partial u}{\\partial t}(x,0) = h(x)$，以及边界条件 $u(x_L, t) = u_L(t)$ 和 $u(x_R, t) = u_R(t)$。\n\n波动方程的一个已知性质是总能量守恒，其定义为：\n$$ E(t) = \\frac{1}{2} \\int_{x_L}^{x_R} \\left( \\left(\\frac{\\partial u}{\\partial t}\\right)^2 + c^2 \\left(\\frac{\\partial u}{\\partial x}\\right)^2 \\right) dx $$\n对于任何有效解，在所有 $t \\in [0,T]$ 时， $E(t)$ 必须保持恒定并等于其初始值 $E(0)$。\n\n您的任务是构建一个修正后的总损失函数 $\\mathcal{L}_{\\text{total}}$，该函数明确包含对任何违反此能量守恒定律的惩罚。总损失是四个分量的加权和：\n$$ \\mathcal{L}_{\\text{total}} = \\lambda_{\\text{PDE}}\\mathcal{L}_{\\text{PDE}} + \\lambda_{\\text{IC}}\\mathcal{L}_{\\text{IC}} + \\lambda_{\\text{BC}}\\mathcal{L}_{\\text{BC}} + \\lambda_{\\text{E}}\\mathcal{L}_{\\text{E}} $$\n其中 $\\lambda$ 项是正的权重超参数。\n\n请基于以下几组配置点来定义损失函数的各个分量，并将每个分量表示为均方误差（MSE）：\n- **PDE损失 $\\mathcal{L}_{\\text{PDE}}$**：在一组位于域内部的 $N_{\\text{PDE}}$ 个点 $\\mathcal{S}_{\\text{PDE}} = \\{(x_i, t_i)\\}_{i=1}^{N_{\\text{PDE}}}$ 上进行评估。\n- **初始条件损失 $\\mathcal{L}_{\\text{IC}}$**：在一组位于初始时间线上的 $N_{\\text{IC}}$ 个点 $\\mathcal{S}_{\\text{IC}} = \\{(x_j, 0)\\}_{j=1}^{N_{\\text{IC}}}$ 上进行评估。均方误差应同时考虑 $u$ 及其时间导数 $u_t$ 的误差。\n- **边界条件损失 $\\mathcal{L}_{\\text{BC}}$**：在一组位于空间边界 $x \\in \\{x_L, x_R\\}$ 上的 $N_{\\text{BC}}$ 个点 $\\mathcal{S}_{\\text{BC}} = \\{(x_k, t_k)\\}_{k=1}^{N_{\\text{BC}}}$ 上进行评估。对于一个点 $(x_k, t_k) \\in \\mathcal{S}_{\\text{BC}}$，其目标边界值为 $u_{\\text{BC}}(x_k, t_k)$，如果 $x_k=x_L$，则该值等于 $u_L(t_k)$；如果 $x_k=x_R$，则该值等于 $u_R(t_k)$。\n- **能量守恒损失 $\\mathcal{L}_{\\text{E}}$**：该损失惩罚网络在不同时刻预测的能量与真实初始能量之间的偏差。能量积分将使用中点黎曼和进行近似，在 $[x_L, x_R]$ 的 $N_E$ 个均匀子区间上求和，每个子区间的宽度为 $\\Delta x = (x_R - x_L)/N_E$。此求和的空间求值点为 $\\{x_m = x_L + (m - 1/2)\\Delta x\\}_{m=1}^{N_E}$。守恒性在一组 $N_T$ 个时间实例 $\\mathcal{T}_E = \\{t_l\\}_{l=1}^{N_T}$（其中 $t_l > 0$）上强制执行。\n\n设神经网络对解的近似为 $\\hat{u}(x,t; \\theta)$，其关于 $x$ 和 $t$ 的偏导数分别表示为 $\\hat{u}_x$、$\\hat{u}_t$、$\\hat{u}_{xx}$ 和 $\\hat{u}_{tt}$。假设函数 $g(x)$、$h(x)$ 以及空间导数 $g'(x)$ 是已知的，并且可以在所需点上求值。请构建 $\\mathcal{L}_{\\text{total}}$ 的完整表达式。您的最终答案应该是一个单一的解析表达式，用网络输出（例如 $\\hat{u}(x,t)$）、其导数、给定函数、指定点和权重因子来表示。", "solution": "我们寻求一个总损失，该损失惩罚对PDE、初始条件、边界条件以及能量守恒的违反。对于一个PINN近似 $\\hat{u}(x,t;\\theta)$，根据波动方程在内部配置点 $(x_{i},t_{i}) \\in \\mathcal{S}_{\\text{PDE}}$ 上定义PDE残差：\n$$\nr(x_{i},t_{i};\\theta) = \\hat{u}_{tt}(x_{i},t_{i};\\theta) - c^{2}\\hat{u}_{xx}(x_{i},t_{i};\\theta).\n$$\nPDE损失是均方残差：\n$$\n\\mathcal{L}_{\\text{PDE}} = \\frac{1}{N_{\\text{PDE}}}\\sum_{i=1}^{N_{\\text{PDE}}} \\left(r(x_{i},t_{i};\\theta)\\right)^{2} = \\frac{1}{N_{\\text{PDE}}}\\sum_{i=1}^{N_{\\text{PDE}}} \\left(\\hat{u}_{tt}(x_{i},t_{i};\\theta) - c^{2}\\hat{u}_{xx}(x_{i},t_{i};\\theta)\\right)^{2}.\n$$\n对于初始条件点 $(x_{j},0) \\in \\mathcal{S}_{\\text{IC}}$，目标值为 $u(x_{j},0)=g(x_{j})$ 和 $u_{t}(x_{j},0)=h(x_{j})$。初始条件损失是关于 $u$ 和 $u_{t}$ 的均方误差：\n$$\n\\mathcal{L}_{\\text{IC}} = \\frac{1}{2N_{\\text{IC}}}\\sum_{j=1}^{N_{\\text{IC}}} \\left[\\left(\\hat{u}(x_{j},0;\\theta)-g(x_{j})\\right)^{2} + \\left(\\hat{u}_{t}(x_{j},0;\\theta)-h(x_{j})\\right)^{2}\\right].\n$$\n对于边界条件点 $(x_{k},t_{k}) \\in \\mathcal{S}_{\\text{BC}}$（其中 $x_{k}\\in\\{x_{L},x_{R}\\}$），目标边界值为 $u_{\\text{BC}}(x_{k},t_{k})$（如果 $x_{k}=x_{L}$ 则等于 $u_{L}(t_{k})$，如果 $x_{k}=x_{R}$ 则等于 $u_{R}(t_{k})$）。边界损失为均方差：\n$$\n\\mathcal{L}_{\\text{BC}} = \\frac{1}{N_{\\text{BC}}}\\sum_{k=1}^{N_{\\text{BC}}} \\left(\\hat{u}(x_{k},t_{k};\\theta) - u_{\\text{BC}}(x_{k},t_{k})\\right)^{2}.\n$$\n能量守恒要求对于所有 $t$ 都有 $E(t)=E(0)$。我们通过在 $[x_{L},x_{R}]$ 的 $N_{E}$ 个均匀子区间上使用中点黎曼和来近似能量积分，子区间的空间中点为 $x_{m}=x_{L}+\\left(m-\\frac{1}{2}\\right)\\frac{x_{R}-x_{L}}{N_{E}}$，宽度为 $\\Delta x=\\frac{x_{R}-x_{L}}{N_{E}}$。网络在时刻 $t_{l}\\in\\mathcal{T}_{E}$ 预测的能量为：\n$$\n\\widehat{E}(t_{l}) = \\frac{1}{2}\\frac{x_{R}-x_{L}}{N_{E}} \\sum_{m=1}^{N_{E}}\\left(\\hat{u}_{t}\\!\\left(x_{L}+\\left(m-\\frac{1}{2}\\right)\\frac{x_{R}-x_{L}}{N_{E}},t_{l};\\theta\\right)^{2} + c^{2}\\hat{u}_{x}\\!\\left(x_{L}+\\left(m-\\frac{1}{2}\\right)\\frac{x_{R}-x_{L}}{N_{E}},t_{l};\\theta\\right)^{2}\\right).\n$$\n使用相同的求积点，根据已知的初始数据计算出的真实初始能量为：\n$$\nE_{0} = \\frac{1}{2}\\frac{x_{R}-x_{L}}{N_{E}} \\sum_{m=1}^{N_{E}}\\left(h\\!\\left(x_{L}+\\left(m-\\frac{1}{2}\\right)\\frac{x_{R}-x_{L}}{N_{E}}\\right)^{2} + c^{2}\\left(g'\\!\\left(x_{L}+\\left(m-\\frac{1}{2}\\right)\\frac{x_{R}-x_{L}}{N_{E}}\\right)\\right)^{2}\\right).\n$$\n能量守恒损失是在选定的时间实例上 $\\widehat{E}(t_{l})$ 相对于 $E_{0}$ 的均方偏差：\n$$\n\\mathcal{L}_{\\text{E}} = \\frac{1}{N_{T}}\\sum_{l=1}^{N_{T}}\\left(\\widehat{E}(t_{l}) - E_{0}\\right)^{2}.\n$$\n将所有四个分量与正常数权重 $\\lambda_{\\text{PDE}},\\lambda_{\\text{IC}},\\lambda_{\\text{BC}},\\lambda_{\\text{E}}$ 结合，得到总损失：\n$$\n\\mathcal{L}_{\\text{total}} = \\lambda_{\\text{PDE}}\\mathcal{L}_{\\text{PDE}} + \\lambda_{\\text{IC}}\\mathcal{L}_{\\text{IC}} + \\lambda_{\\text{BC}}\\mathcal{L}_{\\text{BC}} + \\lambda_{\\text{E}}\\mathcal{L}_{\\text{E}}.\n$$\n代入所有分量的显式形式，即可得到一个按要求表示的、由 $\\hat{u}$、其导数、给定数据、配置点和权重组成的单一解析表达式。", "answer": "$$\\boxed{\\lambda_{\\text{PDE}} \\frac{1}{N_{\\text{PDE}}}\\sum_{i=1}^{N_{\\text{PDE}}}\\left(\\hat{u}_{tt}(x_{i},t_{i};\\theta)-c^{2}\\hat{u}_{xx}(x_{i},t_{i};\\theta)\\right)^{2}+\\lambda_{\\text{IC}}\\frac{1}{2N_{\\text{IC}}}\\sum_{j=1}^{N_{\\text{IC}}}\\left[\\left(\\hat{u}(x_{j},0;\\theta)-g(x_{j})\\right)^{2}+\\left(\\hat{u}_{t}(x_{j},0;\\theta)-h(x_{j})\\right)^{2}\\right]+\\lambda_{\\text{BC}}\\frac{1}{N_{\\text{BC}}}\\sum_{k=1}^{N_{\\text{BC}}}\\left(\\hat{u}(x_{k},t_{k};\\theta)-u_{\\text{BC}}(x_{k},t_{k})\\right)^{2}+\\lambda_{\\text{E}}\\frac{1}{N_{T}}\\sum_{l=1}^{N_{T}}\\left(\\frac{1}{2}\\frac{x_{R}-x_{L}}{N_{E}}\\sum_{m=1}^{N_{E}}\\left[\\hat{u}_{t}\\!\\left(x_{L}+\\left(m-\\frac{1}{2}\\right)\\frac{x_{R}-x_{L}}{N_{E}},t_{l};\\theta\\right)^{2}+c^{2}\\hat{u}_{x}\\!\\left(x_{L}+\\left(m-\\frac{1}{2}\\right)\\frac{x_{R}-x_{L}}{N_{E}},t_{l};\\theta\\right)^{2}\\right]-\\frac{1}{2}\\frac{x_{R}-x_{L}}{N_{E}}\\sum_{m=1}^{N_{E}}\\left[h\\!\\left(x_{L}+\\left(m-\\frac{1}{2}\\right)\\frac{x_{R}-x_{L}}{N_{E}}\\right)^{2}+c^{2}\\left(g'\\!\\left(x_{L}+\\left(m-\\frac{1}{2}\\right)\\frac{x_{R}-x_{L}}{N_{E}}\\right)\\right)^{2}\\right]\\right)^{2}}$$", "id": "2126322"}]}