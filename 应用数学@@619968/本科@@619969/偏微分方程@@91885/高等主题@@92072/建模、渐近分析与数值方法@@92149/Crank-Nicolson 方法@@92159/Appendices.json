{"hands_on_practices": [{"introduction": "实施任何有限差分法的第一步，是将离散化公式转化为计算机可以求解的矩阵系统。本练习将引导你完成 Crank-Nicolson 方法的这一基本过程。通过在仅有两个内部网格点的最小网格上构建矩阵，你将具体理解未来时间步之间的隐式关系是如何在线性代数方程中被捕捉的。[@problem_id:2139867]", "problem": "考虑一维热扩散方程 $\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}$，该方程模拟了长度为 $L$、热扩散系数为 $\\alpha$ 的细杆中的温度 $u(x,t)$。空间域为 $x \\in [0, L]$，时间 $t \\ge 0$。该细杆服从齐次狄利克雷边界条件，即杆两端的温度在所有时间内都保持为零：$u(0, t) = 0$ 且 $u(L, t) = 0$。\n\n为了数值求解该方程，需要对区域进行离散化。空间域 $[0, L]$ 被划分为三段等长的线段，每段长度为 $\\Delta x = L/3$，从而得到四个网格点：$x_0=0$、$x_1=\\Delta x$、$x_2=2\\Delta x$ 和 $x_3=3\\Delta x=L$。时间以 $\\Delta t$ 为步长进行离散化。令 $u_j^n$ 表示在位置 $x_j$ 和时间 $t_n = n\\Delta t$ 时温度的数值近似值。\n\n采用克兰克-尼科尔森方法进行时间演化。该方法是隐式的，在每个时间步都会产生一个必须求解的线性方程组。对于两个内部网格点 $x_1$ 和 $x_2$，该方程组可以表示为如下矩阵形式：\n$$ A \\begin{pmatrix} u_1^{n+1} \\\\ u_2^{n+1} \\end{pmatrix} = \\text{含 } u_j^n \\text{ 的项} $$\n令无量纲参数 $r$ 定义为 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$。矩阵 $A$ 的所有元素都将是 $r$ 的函数。\n\n下列哪个矩阵是该方程组的正确矩阵 $A$？\n\nA. $\\begin{pmatrix} 1+r & -r/2 \\\\ -r/2 & 1+r \\end{pmatrix}$\n\nB. $\\begin{pmatrix} 1-r & r/2 \\\\ r/2 & 1-r \\end{pmatrix}$\n\nC. $\\begin{pmatrix} 1-r & 2r \\\\ 2r & 1-r \\end{pmatrix}$\n\nD. $\\begin{pmatrix} 1+2r & -2r \\\\ -2r & 1+2r \\end{pmatrix}$", "solution": "我们从一维热方程 $u_{t}=\\alpha u_{xx}$（定义在 $x\\in[0,L]$ 上）和齐次狄利克雷边界条件 $u(0,t)=0$ 及 $u(L,t)=0$ 出发。用网格点 $x_{0}=0$、$x_{1}=\\Delta x$、$x_{2}=2\\Delta x$、$x_{3}=3\\Delta x=L$ 对空间进行离散化，并用 $t_{n}=n\\Delta t$ 对时间进行离散化。令 $u_{j}^{n}$ 为 $u(x_{j},t_{n})$ 的近似值。\n\nCrank-Nicolson方法将时间上的梯形法则应用于扩散算子。对于每个内部节点 $j$（这里 $j=1,2$），其差分格式为：\n$$\n\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}\n=\\alpha \\cdot \\frac{1}{2}\\left(\\frac{u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}}{(\\Delta x)^{2}}+\\frac{u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1}}{(\\Delta x)^{2}}\\right)\n$$\n定义无量纲参数 $r=\\frac{\\alpha \\Delta t}{(\\Delta x)^{2}}$。将该格式两边同乘以 $\\Delta t$ 并使用 $r$ 可得：\n$$\nu_{j}^{n+1}-u_{j}^{n}\n=\\frac{r}{2}\\left[(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n})+(u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1})\\right]\n$$\n将时间层 $n+1$ 的项收集到左侧：\n$$\n-\\frac{r}{2} u_{j-1}^{n+1}+(1+r) u_{j}^{n+1}-\\frac{r}{2} u_{j+1}^{n+1}\n= \\frac{r}{2} u_{j-1}^{n}+(1-r) u_{j}^{n}+\\frac{r}{2} u_{j+1}^{n}\n$$\n对于两个内部节点 $j=1$ 和 $j=2$，根据齐次狄利克雷边界条件，有 $u_{0}^{n}=u_{3}^{n}=0$ 和 $u_{0}^{n+1}=u_{3}^{n+1}=0$。未知向量为 $(u_{1}^{n+1},u_{2}^{n+1})^{T}$。$j=1$ 和 $j=2$ 时方程的左侧分别变为：\n$$\n(1+r)u_{1}^{n+1}-\\frac{r}{2} u_{2}^{n+1} \\quad\\text{和}\\quad -\\frac{r}{2} u_{1}^{n+1}+(1+r)u_{2}^{n+1}\n$$\n因此，乘以 $(u_{1}^{n+1},u_{2}^{n+1})^{T}$ 的系数矩阵 $A$ 是：\n$$\nA=\\begin{pmatrix} 1+r & -r/2 \\\\ -r/2 & 1+r \\end{pmatrix}\n$$\n这与选项A相符。", "answer": "$$\\boxed{A}$$", "id": "2139867"}, {"introduction": "现实世界的物理模型通常不仅仅包含扩散过程；它们还可能涉及代表反应、衰变或外部影响的源项或汇项。本练习要求你将一个线性热损失项整合到离散格式中，从而展示 Crank-Nicolson 方法的适应性。对于将数值方法应用于更复杂、更真实的偏微分方程，这项技能至关重要。[@problem_id:2139830]", "problem": "考虑如下的一维反应扩散方程：\n$$ \\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} - \\beta u $$\n该方程模拟了诸如杆中的热扩散过程，其中 $u(x,t)$ 是温度，$D$ 是热扩散系数，而项 $-\\beta u$（其中 $\\beta > 0$ 是一个常数）表示与局部温度成正比的向周围环境的热量损失。\n\n我们希望在空间域 $x \\in [0, L]$ 和时间 $t > 0$ 上数值求解此方程，其狄利克雷边界条件为 $u(0, t) = u(L, t) = 0$。该区域使用均匀的空间步长 $\\Delta x$ 进行离散化，因此有 $M$ 个内部网格点 $x_j = j \\Delta x$，其中 $j = 1, 2, \\ldots, M$。时间使用均匀的步长 $\\Delta t$ 进行离散化，其中 $t_n = n \\Delta t$。在网格点 $j$ 和时间步 $n$ 处温度的数值近似值记为 $u_j^n$。\n\n我们采用 Crank-Nicolson 方法来求解此方程。这种隐式时间步进格式是通过将有限差分近似中心化在半时间步 $t_{n+1/2} = t_n + \\Delta t / 2$ 上来构建的。为求解下一个时间步的未知温度 $\\mathbf{u}^{n+1} = [u_1^{n+1}, u_2^{n+1}, \\ldots, u_M^{n+1}]^T$ 所得到的线性方程组可以写成矩阵形式：\n$$ A \\mathbf{u}^{n+1} = B \\mathbf{u}^{n} $$\n其中 $A$ 和 $B$ 是依赖于离散化参数的 $M \\times M$ 矩阵。\n\n设无量纲扩散数定义为 $r = \\frac{D \\Delta t}{(\\Delta x)^2}$。确定矩阵 $A$ 对于一个内部网格点 $j$（其中 $1 < j < M$）的对角元素 $A_{j,j}$ 的值。请用 $r$ 和乘积 $\\beta \\Delta t$ 的解析表达式表示你的答案。", "solution": "我们从反应扩散方程 $u_{t} = D u_{xx} - \\beta u$ 开始，并在内部网格点 $j$ 应用 Crank-Nicolson 方法：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t}\n= \\frac{D}{2}\\left(\\frac{u_{j-1}^{n+1} - 2 u_{j}^{n+1} + u_{j+1}^{n+1}}{(\\Delta x)^{2}} + \\frac{u_{j-1}^{n} - 2 u_{j}^{n} + u_{j+1}^{n}}{(\\Delta x)^{2}}\\right) - \\frac{\\beta}{2}\\left(u_{j}^{n+1} + u_{j}^{n}\\right).\n$$\n两边乘以 $\\Delta t$ 并引入 $r = \\frac{D \\Delta t}{(\\Delta x)^{2}}$ 可得\n$$\nu_{j}^{n+1} - u_{j}^{n}\n= \\frac{r}{2}\\left(u_{j-1}^{n+1} - 2 u_{j}^{n+1} + u_{j+1}^{n+1} + u_{j-1}^{n} - 2 u_{j}^{n} + u_{j+1}^{n}\\right) - \\frac{\\beta \\Delta t}{2}\\left(u_{j}^{n+1} + u_{j}^{n}\\right).\n$$\n将所有含 $n+1$ 的项收集到左边可得\n$$\n-\\frac{r}{2} u_{j-1}^{n+1} + \\left[1 + r + \\frac{\\beta \\Delta t}{2}\\right] u_{j}^{n+1} - \\frac{r}{2} u_{j+1}^{n+1}\n= \\left(1 - \\frac{\\beta \\Delta t}{2}\\right) u_{j}^{n} + \\frac{r}{2}\\left(u_{j-1}^{n} - 2 u_{j}^{n} + u_{j+1}^{n}\\right).\n$$\n在矩阵形式 $A \\mathbf{u}^{n+1} = B \\mathbf{u}^{n}$ 中，系数 $A_{j,j}$ 是左侧乘以 $u_{j}^{n+1}$ 的系数。因此，对于一个内部点 $j$，\n$$\nA_{j,j} = 1 + r + \\frac{\\beta \\Delta t}{2}.\n$$\n这完全由 $r$ 和 $\\beta \\Delta t$ 表示，符合要求。", "answer": "$$\\boxed{1 + r + \\frac{\\beta \\Delta t}{2}}$$", "id": "2139830"}, {"introduction": "尽管 Crank-Nicolson 方法因其无条件稳定性而备受赞誉，但它并非“万能灵药”。在模拟具有尖锐梯度或不连续性的问题时，一个常见的陷阱是出现非物理振荡。这个概念性问题深入探讨了这种行为的根本原因，促使你分析该方法对解的不同频率分量的影响，并理解为什么它对最高频率分量的阻尼效果很差。[@problem_id:2211533]", "problem": "一名工程专业的学生正在模拟一根长绝热棒内的一维传热过程。该过程由热方程 $\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2}$ 控制，其中 $u(x,t)$ 是位置 $x$ 和时间 $t$ 处的温度，而 $D$ 是材料的热扩散系数。棒的长度为 $L$。初始温度分布是一个急剧的阶跃函数：在 $t=0$ 时，棒的左半部分（$0 \\le x \\le L/2$）的温度为 $u(x,0) = U_0$，右半部分（$L/2 < x \\le L$）的温度为 $u(x,0) = 0$。边界保持恒定温度：对于所有 $t > 0$，$u(0,t) = U_0$ 且 $u(L,t) = 0$。\n\n为了数值求解该方程，该学生采用了广泛使用的 Crank-Nicolson 方法，用空间步长 $\\Delta x$ 对区域进行离散，并以时间步长 $\\Delta t$ 向前推进。在运行了几个时间步长的模拟后，该学生观察到温度分布的数值解在初始不连续点 $x=L/2$ 附近的区域表现出非物理的振荡或“摆动”。\n\n当应用于具有急剧不连续性的初始条件时，下列哪个陈述为 Crank-Nicolson 方法产生这些伪振荡提供了最准确和最根本的解释？\n\nA. Crank-Nicolson 方法只是条件稳定的，急剧的初始条件与所选参数 $\\Delta t$ 和 $\\Delta x$ 的组合违反了 Courant-Friedrichs-Lewy (CFL) 条件，导致了不稳定的振荡解。\n\nB. 这种振荡是 Gibbs 现象的直接数值体现。任何基于有限网格点表示的数值方法在逼近不连续函数时，都不可避免地会产生这种过冲，无论使用何种特定的时间步进格式。\n\nC. Crank-Nicolson 格式的隐式性质要求在每个时间步求解一个三对角线性方程组。初始数据向量中的急剧不连续性导致了一个病态矩阵，而线性求解器产生的数值误差是振荡行为的来源。\n\nD. 该方法存在显著的数值色散误差，这意味着数值解的不同 Fourier 分量以不正确的、依赖于频率的相速度传播。对于表示不连续性至关重要的高频分量会散开并相互干涉，从而产生观察到的“摆动”。\n\nE. 精确表示一个急剧的不连续性需要一个广谱的空间 Fourier 模态。对于数值网格所支持的最高频率模态，Crank-Nicolson 方法的放大因子趋近于 -1。因此，这些高频分量阻尼很差，并且在每个时间步都会反转其相位，导致它们以振荡的形式持续存在。", "solution": "我们使用 von Neumann Fourier 模态分析法来分析热方程 $u_{t} = D u_{xx}$ 的 Crank-Nicolson (CN) 格式，以确定在不连续初始数据下产生振荡的机理。设空间网格为 $x_{j} = j \\Delta x$，时间层为 $t^{n} = n \\Delta t$。在内部点 $j$ 的 CN 离散格式为\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t}\n= \\frac{D}{2} \\left( \\frac{u_{j+1}^{n+1} - 2 u_{j}^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^{2}}\n+ \\frac{u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}}{(\\Delta x)^{2}} \\right).\n$$\n引入无量纲参数 $r = \\frac{D \\Delta t}{(\\Delta x)^{2}}$。重新整理得到线性系统\n$$\n-\\frac{r}{2} u_{j-1}^{n+1} + (1 + r) u_{j}^{n+1} - \\frac{r}{2} u_{j+1}^{n+1}\n= \\frac{r}{2} u_{j-1}^{n} + (1 - r) u_{j}^{n} + \\frac{r}{2} u_{j+1}^{n}.\n$$\n为了进行 von Neumann 分析，假设一个 Fourier 模态为 $u_{j}^{n} = G^{n} \\exp(i j \\theta)$，其中 $\\theta \\in [0,\\pi]$。代入 $u_{j\\pm 1}^{n} = G^{n} \\exp(i (j \\pm 1)\\theta)$ 以及类似的 $n+1$ 项，我们得到\n$$\nG \\left( -\\frac{r}{2} \\exp(-i \\theta) + (1 + r) - \\frac{r}{2} \\exp(i \\theta) \\right)\n= \\frac{r}{2} \\exp(-i \\theta) + (1 - r) + \\frac{r}{2} \\exp(i \\theta).\n$$\n使用 $\\exp(i \\theta) + \\exp(-i \\theta) = 2 \\cos \\theta$，上式可简化为\n$$\nG \\left( 1 + r - r \\cos \\theta \\right) = 1 - r + r \\cos \\theta,\n$$\n因此，CN 放大因子为\n$$\nG(\\theta) = \\frac{1 - r + r \\cos \\theta}{1 + r - r \\cos \\theta}.\n$$\n等价地，使用 $1 - \\cos \\theta = 2 \\sin^{2}(\\theta/2)$，\n$$\nG(\\theta) = \\frac{1 - 2 r \\sin^{2}(\\theta/2)}{1 + 2 r \\sin^{2}(\\theta/2)}.\n$$\n网格上支持的最高频率模态是 Nyquist 模态，其 $\\theta = \\pi$，此时 $\\sin^{2}(\\pi/2) = 1$，得到\n$$\nG(\\pi) = \\frac{1 - 2 r}{1 + 2 r}.\n$$\n由此可以得出两个关键性质：\n- 幅值：$\\left| G(\\pi) \\right| = \\left| \\frac{1 - 2 r}{1 + 2 r} \\right| < 1$，因此 CN 格式是无条件稳定的（排除了陈述 A）。然而，随着 $r$ 的增大，$\\left| G(\\pi) \\right| \\to 1$，这意味着最高频率分量的阻尼非常差（CN 格式是 A-稳定的，但不是 L-稳定的）。\n- 符号：对于 $r > \\frac{1}{2}$，$G(\\pi) < 0$，因此 Nyquist 分量在每个时间步都会改变符号，即发生相位反转。即使对于 $\\theta$ 接近 $\\pi$ 的模态，当 $r$ 不很小时，$G(\\theta)$ 也接近 -1，因此这些高频分量表现出弱阻尼和时间上的符号交替。\n\n物理上，一个急剧的不连续性需要一个广谱的高空间频率。精确的热方程在一个时间步内以因子 $\\exp(-D k^{2} \\Delta t)$ 强烈地阻尼这些模态。相比之下，CN 格式对离散的最高频率的放大因子趋近于 -1 而不是 0，因此这些分量没有被强烈衰减，并可能在步与步之间反转相位。这导致在不连续点附近出现持续的、衰减非常缓慢的非物理振荡（空间“摆动”）。\n\n这个机理本身不是 Gibbs 现象（陈述 B），Gibbs 现象涉及与时间步进无关的 Fourier 级数截断过冲。它也不是由于三对角系统的病态性（陈述 C），该系统对于 $r > 0$ 保持良态和对角占优。它也不是数值色散（陈述 D），数值色散与具有相速度误差的波传播有关；热方程是扩散性的，而这里的问题是高频模态的阻尼不足和符号反转。\n\n因此，最准确和最根本的解释是，对于最高频率模态，CN 放大因子趋近于 -1，导致表示不连续性所必需的关键高频内容阻尼不良和相位反转，从而产生了观察到的振荡。这与陈述 E 相对应。", "answer": "$$\\boxed{E}$$", "id": "2211533"}]}