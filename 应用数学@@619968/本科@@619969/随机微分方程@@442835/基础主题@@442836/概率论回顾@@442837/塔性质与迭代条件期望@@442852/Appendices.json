{"hands_on_practices": [{"introduction": "本练习是理解布朗运动结构的基础第一步。通过应用塔性质（tower property），我们将计算维纳过程（Wiener process）的协方差函数，这是支撑大量随机分析理论的核心结果。该实践巩固了对过去信息进行条件化以及未来增量独立性等关键概念。[@problem_id:3082759]", "problem": "考虑一个满足通常条件的带流概率空间 $(\\Omega,\\mathcal{F},(\\mathcal{F}_{t})_{t \\ge 0},\\mathbb{P})$，其上定义了一个适应于 $(\\mathcal{F}_{t})_{t \\ge 0}$ 的标准布朗运动 $W=(W_{t})_{t \\ge 0}$。回顾标准布朗运动的定义：几乎必然有 $W_{0}=0$，其路径是连续的，具有独立增量，并且对于 $0 \\le s  t$，增量 $W_{t}-W_{s}$ 服从均值为 $0$、方差为 $t-s$ 的高斯分布。设 $0 \\le u \\le t$，并令 $\\mathcal{F}_{u}$ 表示直到时间 $u$ 的可用信息。仅使用条件期望的定义、布朗增量的独立性和平稳性以及条件期望的塔性质，通过对 $\\mathcal{F}_{u}$ 取条件来计算量 $\\mathbb{E}[W_{u} W_{t}]$。请给出一个完整的推导过程，并根据这些原理解释每一步的合理性。最终答案应为关于 $u$ 和 $t$ 的精确表达式，不含任何近似。", "solution": "我们的任务是计算 $\\mathbb{E}[W_{u} W_{t}]$，其中 $W = (W_{t})_{t \\ge 0}$ 是定义在带流概率空间 $(\\Omega,\\mathcal{F},(\\mathcal{F}_{t})_{t \\ge 0},\\mathbb{P})$ 上的标准一维布朗运动，且满足时间顺序 $0 \\le u \\le t$。计算必须基于基本原理：条件期望的定义、布朗运动的性质以及条件期望的塔性质。\n\n塔性质（或全期望定律）指出，对于任意可积随机变量 $X$ 和任意子$\\sigma$-代数 $\\mathcal{G} \\subseteq \\mathcal{F}$，我们有 $\\mathbb{E}[X] = \\mathbb{E}[\\mathbb{E}[X \\mid \\mathcal{G}]]$。我们将通过对时刻 $u$ 的自然流 $\\mathcal{F}_{u}$ 取条件来应用此性质。我们感兴趣的随机变量是 $X = W_{u} W_{t}$。因此，我们可以写出：\n$$\n\\mathbb{E}[W_{u} W_{t}] = \\mathbb{E}\\left[\\mathbb{E}[W_{u} W_{t} \\mid \\mathcal{F}_{u}]\\right]\n$$\n我们的第一步是计算内层的条件期望 $\\mathbb{E}[W_{u} W_{t} \\mid \\mathcal{F}_{u}]$。条件期望的一个关键性质是，任何相对于条件$\\sigma$-代数可测的随机变量都可以被当作常数提出来。根据定义，随机变量 $W_{u}$ 是 $\\mathcal{F}_{u}$-可测的。因此，我们可以写出：\n$$\n\\mathbb{E}[W_{u} W_{t} \\mid \\mathcal{F}_{u}] = W_{u} \\mathbb{E}[W_{t} \\mid \\mathcal{F}_{u}]\n$$\n接下来，我们必须计算 $\\mathbb{E}[W_{t} \\mid \\mathcal{F}_{u}]$。由于给定 $u \\le t$，我们可以将随机变量 $W_{t}$ 分解为一个在时刻 $u$ 已知的部分和一个独立的未来增量。我们将 $W_{t}$ 写成 $W_{u}$ 与从 $u$ 到 $t$ 的增量之和：\n$$\nW_{t} = W_{u} + (W_{t} - W_{u})\n$$\n根据条件期望的线性性，我们有：\n$$\n\\mathbb{E}[W_{t} \\mid \\mathcal{F}_{u}] = \\mathbb{E}[W_{u} + (W_{t} - W_{u}) \\mid \\mathcal{F}_{u}] = \\mathbb{E}[W_{u} \\mid \\mathcal{F}_{u}] + \\mathbb{E}[W_{t} - W_{u} \\mid \\mathcal{F}_{u}]\n$$\n让我们分别计算右侧的每一项。\n对于第一项 $\\mathbb{E}[W_{u} \\mid \\mathcal{F}_{u}]$，由于 $W_{u}$ 是 $\\mathcal{F}_{u}$-可测的，其在给定 $\\mathcal{F}_{u}$ 下的条件期望就是它本身：\n$$\n\\mathbb{E}[W_{u} \\mid \\mathcal{F}_{u}] = W_{u}\n$$\n对于第二项 $\\mathbb{E}[W_{t} - W_{u} \\mid \\mathcal{F}_{u}]$，我们使用布朗运动的一个基本性质：其增量独立于过去。具体来说，对于 $u  t$，增量 $W_{t} - W_{u}$ 独立于$\\sigma$-代数 $\\mathcal{F}_{u}$。条件期望的一个性质指出，如果一个随机变量 $Y$ 独立于一个$\\sigma$-代数 $\\mathcal{G}$，那么 $\\mathbb{E}[Y \\mid \\mathcal{G}] = \\mathbb{E}[Y]$。应用此性质，我们得到：\n$$\n\\mathbb{E}[W_{t} - W_{u} \\mid \\mathcal{F}_{u}] = \\mathbb{E}[W_{t} - W_{u}]\n$$\n根据标准布朗运动的定义，对于 $s  t$，增量 $W_{t}-W_{s}$ 服从均值为 $0$、方差为 $t-s$ 的高斯分布。在我们的例子中，$s=u$，所以增量 $W_{t}-W_{u}$ 的均值为 $0$：\n$$\n\\mathbb{E}[W_{t} - W_{u}] = 0\n$$\n将这些结果代回到 $\\mathbb{E}[W_{t} \\mid \\mathcal{F}_{u}]$ 的表达式中：\n$$\n\\mathbb{E}[W_{t} \\mid \\mathcal{F}_{u}] = W_{u} + 0 = W_{u}\n$$\n这个结果展示了布朗运动关于其自然流的鞅性质。现在，我们用它来简化我们原问题中的内层期望：\n$$\n\\mathbb{E}[W_{u} W_{t} \\mid \\mathcal{F}_{u}] = W_{u} \\mathbb{E}[W_{t} \\mid \\mathcal{F}_{u}] = W_{u} \\cdot W_{u} = W_{u}^{2}\n$$\n最后，我们把这个结果代回到塔性质的方程中：\n$$\n\\mathbb{E}[W_{u} W_{t}] = \\mathbb{E}[\\mathbb{E}[W_{u} W_{t} \\mid \\mathcal{F}_{u}]] = \\mathbb{E}[W_{u}^{2}]\n$$\n问题现在简化为求 $W_{u}$ 的二阶矩。随机变量 $X$ 的方差定义为 $\\operatorname{Var}(X) = \\mathbb{E}[X^{2}] - (\\mathbb{E}[X])^{2}$。对于标准布朗运动 $W_{u}$，我们有：\n$$\n\\mathbb{E}[W_{u}] = \\mathbb{E}[W_{u} - W_{0}] = 0\n$$\n$$\n\\operatorname{Var}(W_{u}) = \\operatorname{Var}(W_{u} - W_{0}) = u - 0 = u\n$$\n重新整理方差公式，我们求得二阶矩：\n$$\n\\mathbb{E}[W_{u}^{2}] = \\operatorname{Var}(W_{u}) + (\\mathbb{E}[W_{u}])^{2} = u + 0^{2} = u\n$$\n因此，所求的量为：\n$$\n\\mathbb{E}[W_{u} W_{t}] = u\n$$\n这个结果在 $0 \\le u \\le t$ 时有效。它表明标准布朗运动的协方差函数是 $\\operatorname{Cov}(W_{u}, W_{t}) = \\mathbb{E}[W_{u} W_{t}] - \\mathbb{E}[W_{u}]\\mathbb{E}[W_{t}] = u - 0 \\cdot 0 = u$。根据对称性，如果 $t \\le u$，结果将是 $t$。一般而言，$\\mathbb{E}[W_{s} W_{t}] = \\min(s,t)$。", "answer": "$$\\boxed{u}$$", "id": "3082759"}, {"introduction": "在基础条件化技术之上，本问题要求您计算布朗运动的条件矩母函数（conditional moment-generating function）。这个强大的结果不仅是一个理论上的练习，它更是通往吉尔萨诺夫定理（Girsanov theorem）和期权定价模型等更高级理论的重要基石。本练习将加深您在处理条件期望中随机过程指数函数（例如 $\\exp(\\lambda W_{t})$）时的熟练度。[@problem_id:3082694]", "problem": "设 $\\{W_{u}\\}_{u \\geq 0}$ 为一个定义在概率空间 $(\\Omega,\\mathcal{F},\\mathbb{P})$ 上的标准布朗运动（也称为维纳过程），其自然滤子为 $\\{\\mathcal{F}_{u}\\}_{u \\geq 0}$，其中 $\\mathcal{F}_{u}=\\sigma(W_{r}:0 \\leq r \\leq u)$。对于固定的时间 $s$ 和 $t$（满足 $0 \\leq s \\leq t$）以及一个实数参数 $\\lambda \\in \\mathbb{R}$，请仅使用以下基本事实来计算条件期望 $\\mathbb{E}[\\exp(\\lambda W_{t}) \\mid \\mathcal{F}_{s}]$：\n- 增量 $W_{t}-W_{s}$ 独立于 $\\mathcal{F}_{s}$。\n- 增量 $W_{t}-W_{s}$ 服从均值为 $0$、方差为 $t-s$ 的高斯分布。\n- 重期望定律（塔性质）以及条件期望的定义。\n你的最终答案必须是一个用 $\\lambda$、$W_{s}$、$t$ 和 $s$ 表示的闭式解析表达式。无需四舍五入。", "solution": "该问题要求对于一个标准布朗运动 $\\{W_{u}\\}_{u \\geq 0}$，在给定固定时间 $0 \\leq s \\leq t$ 和实数参数 $\\lambda \\in \\mathbb{R}$ 的情况下，计算条件期望 $\\mathbb{E}[\\exp(\\lambda W_{t}) \\mid \\mathcal{F}_{s}]$。其自然滤子为 $\\mathcal{F}_{u} = \\sigma(W_{r}: 0 \\leq r \\leq u)$。推导过程必须仅使用指定的基本事实。\n\n让我们从处理期望内的项开始。时间顺序为 $0 \\leq s \\leq t$。我们可以将随机变量 $W_{t}$ 分解为其在时间 $s$ 的值与后续增量之和：\n$$W_{t} = W_{s} + (W_{t} - W_{s})$$\n将此分解代入条件期望内的表达式，我们得到：\n$$\\mathbb{E}[\\exp(\\lambda W_{t}) \\mid \\mathcal{F}_{s}] = \\mathbb{E}[\\exp(\\lambda (W_{s} + W_{t} - W_{s})) \\mid \\mathcal{F}_{s}]$$\n利用指数函数的性质 $\\exp(a+b) = \\exp(a)\\exp(b)$，我们可以将表达式重写为：\n$$\\mathbb{E}[\\exp(\\lambda W_{s}) \\exp(\\lambda(W_{t} - W_{s})) \\mid \\mathcal{F}_{s}]$$\n现在，我们必须应用条件期望的性质，这些性质是其基本定义的结果。首先，我们确定表达式的哪些部分是关于信息集 $\\mathcal{F}_{s}$ 已知的。根据自然滤子的定义，随机变量 $W_{s}$ 是 $\\mathcal{F}_{s}$-可测的。因此，$W_{s}$ 的任何波莱尔可测函数，例如 $\\exp(\\lambda W_{s})$，也是 $\\mathcal{F}_{s}$-可测的。条件期望的一个基本性质是，任何 $\\mathcal{F}_{s}$-可测的因子都可以从以 $\\mathcal{F}_{s}$ 为条件的期望中提出来。这个性质通常被称为“提出已知项”。应用此性质可得：\n$$\\exp(\\lambda W_{s}) \\mathbb{E}[\\exp(\\lambda(W_{t} - W_{s})) \\mid \\mathcal{F}_{s}]$$\n接下来，我们关注余下的条件期望项 $\\mathbb{E}[\\exp(\\lambda(W_{t} - W_{s})) \\mid \\mathcal{F}_{s}]$。我们已知一个基本事实，即增量 $W_{t} - W_{s}$ 独立于$\\sigma$-代数 $\\mathcal{F}_{s}$。由于 $\\exp(\\lambda(W_{t} - W_{s}))$ 是随机变量 $W_{t} - W_{s}$ 的波莱尔可测函数，因此 $\\exp(\\lambda(W_{t} - W_{s}))$ 也独立于 $\\mathcal{F}_{s}$。由条件期望定义推导出的另一个基本性质是：如果一个随机变量 $Y$ 独立于一个$\\sigma$-代数 $\\mathcal{G}$，那么它关于 $\\mathcal{G}$ 的条件期望就是它的无条件期望：$\\mathbb{E}[Y \\mid \\mathcal{G}] = \\mathbb{E}[Y]$。将此应用于我们的表达式可得：\n$$\\mathbb{E}[\\exp(\\lambda(W_{t} - W_{s})) \\mid \\mathcal{F}_{s}] = \\mathbb{E}[\\exp(\\lambda(W_{t} - W_{s}))]$$\n问题现在简化为计算这个无条件期望。设随机变量 $X = W_{t} - W_{s}$。表达式 $\\mathbb{E}[\\exp(\\lambda X)]$ 是 $X$ 在 $\\lambda$ 处的矩生成函数（MGF）。\n\n我们已知第二个基本事实：增量 $W_{t}-W_{s}$ 是一个均值为 $0$、方差为 $t-s$ 的高斯随机变量。我们将其记为 $X \\sim \\mathcal{N}(0, t-s)$。一个服从一般正态分布的随机变量 $Z \\sim \\mathcal{N}(\\mu, \\sigma^2)$ 的矩生成函数由标准公式 $M_{Z}(k) = \\mathbb{E}[\\exp(kZ)] = \\exp(\\mu k + \\frac{1}{2}\\sigma^2 k^2)$ 给出。\n对于我们的随机变量 $X = W_{t} - W_{s}$，其参数为均值 $\\mu = 0$ 和方差 $\\sigma^2 = t-s$。矩生成函数的参数是 $\\lambda$。因此，我们有：\n$$\\mathbb{E}[\\exp(\\lambda(W_{t} - W_{s}))] = \\exp\\left(0 \\cdot \\lambda + \\frac{1}{2}(t-s)\\lambda^2\\right) = \\exp\\left(\\frac{1}{2}\\lambda^2(t-s)\\right)$$\n最后，我们将此结果代回我们的主表达式中。合并这些因子，我们得到：\n$$\\mathbb{E}[\\exp(\\lambda W_{t}) \\mid \\mathcal{F}_{s}] = \\exp(\\lambda W_{s}) \\cdot \\exp\\left(\\frac{1}{2}\\lambda^2(t-s)\\right)$$\n合并指数，得到最终的闭式表达式：\n$$\\mathbb{E}[\\exp(\\lambda W_{t}) \\mid \\mathcal{F}_{s}] = \\exp\\left(\\lambda W_{s} + \\frac{1}{2}\\lambda^2(t-s)\\right)$$\n这个表达式是一个随机变量，因为它依赖于 $W_{s}$，并且它是 $\\mathcal{F}_{s}$-可测的，这与条件期望的性质一致。", "answer": "$$\\boxed{\\exp\\left(\\lambda W_{s} + \\frac{1}{2}\\lambda^{2}(t-s)\\right)}$$", "id": "3082694"}, {"introduction": "本实践通过考察求解随机微分方程（SDEs）的常用数值方法——欧拉-丸山（Euler-Maruyama）格式，在抽象理论与实际应用之间架起了一座桥梁。您将使用迭代条件期望来分析过程二阶矩的单步演化，揭示布朗增量的随机性如何确定性地贡献于过程的方差。这种动手计算有助于深入理解随机微分方程求解器的数值稳定性与收敛性质。[@problem_id:3082682]", "problem": "设在概率空间 $\\left(\\Omega,\\mathcal{F},(\\mathcal{F}_{t})_{t\\geq 0},\\mathbb{P}\\right)$ 上有一个标准布朗运动 $W=(W_{t})_{t\\geq 0}$ 及其通常的增广自然滤子。固定一个时间步长 $\\Delta t>0$，并定义 $t_{n}=n\\,\\Delta t$ 以及布朗增量 $\\Delta W_{n}:=W_{t_{n+1}}-W_{t_{n}}$。考虑随机微分方程 $dX_{t}=a(X_{t})\\,dt+b(X_{t})\\,dW_{t}$ 的 Euler–Maruyama 时间离散化，其中 $a:\\mathbb{R}\\to\\mathbb{R}$ 和 $b:\\mathbb{R}\\to\\mathbb{R}$ 是全局利普希茨且呈线性增长的，其形式为\n$$\nX_{n+1}=X_{n}+a(X_{n})\\,\\Delta t+b(X_{n})\\,\\Delta W_{n},\n$$\n其中 $X_{0}$ 是 $\\mathcal{F}_{0}$-可测且平方可积的。\n\n仅使用标准布朗运动的定义性质（具有高斯分布的独立平稳增量）和条件期望的定义，完成以下任务：\n\n1) 证明 $\\mathbb{E}\\!\\left[(\\Delta W_{n})^{2}\\mid \\mathcal{F}_{t_{n}}\\right]=\\Delta t$ 几乎必然成立。\n\n2) 使用条件期望的塔性质和迭代条件法，推导 $\\mathbb{E}\\!\\left[X_{n+1}^{2}\\mid \\mathcal{F}_{t_{n}}\\right]$ 的一个闭式表达式，用 $X_{n}$、$a(X_{n})$、$b(X_{n})$ 和 $\\Delta t$ 表示。\n\n你的最终答案必须是 $\\mathbb{E}\\!\\left[X_{n+1}^{2}\\mid \\mathcal{F}_{t_{n}}\\right]$ 的单一解析表达式。无需四舍五入，不涉及单位。", "solution": "该问题分为两部分。首先，我们必须证明布朗增量平方的条件期望的一个性质。其次，利用这个结果，我们必须为 Euler–Maruyama 离散化推导下一个时间步的状态变量平方的条件期望 $\\mathbb{E}\\!\\left[X_{n+1}^{2}\\mid \\mathcal{F}_{t_{n}}\\right]$。\n\n第一部分：证明 $\\mathbb{E}\\!\\left[(\\Delta W_{n})^{2}\\mid \\mathcal{F}_{t_{n}}\\right]=\\Delta t$ 几乎必然成立。\n\n根据定义，一个适应于滤子 $(\\mathcal{F}_{t})_{t\\geq 0}$ 的标准一维布朗运动 $W=(W_{t})_{t\\geq 0}$ 的增量具有两个定义性质：\n1.  **独立增量**：对于任意 $0 \\leq s  t$，增量 $W_t - W_s$ 独立于 $\\sigma$-代数 $\\mathcal{F}_s$，该 $\\sigma$-代数代表了过程直到时间 $s$ 的历史。\n2.  **平稳高斯增量**：增量 $W_t - W_s$ 服从均值为 $0$、方差为 $t-s$ 的正态分布。我们记为 $W_t - W_s \\sim \\mathcal{N}(0, t-s)$。\n\n问题定义了时间点 $t_n = n \\Delta t$ 和布朗增量 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$。\n将布朗运动的性质应用于 $\\Delta W_n$：\n1.  增量 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ 独立于滤子 $\\mathcal{F}_{t_n}$。\n2.  $\\Delta W_n$ 的分布是 $\\mathcal{N}(0, t_{n+1} - t_n) = \\mathcal{N}(0, \\Delta t)$。\n\n我们需要计算条件期望 $\\mathbb{E}\\!\\left[(\\Delta W_{n})^{2}\\mid \\mathcal{F}_{t_{n}}\\right]$。我们使用条件期望的以下性质：如果一个随机变量 $Y$ 独立于一个$\\sigma$-代数 $\\mathcal{G}$，且 $f$ 是一个可测函数使得 $\\mathbb{E}[|f(Y)|]  \\infty$，那么 $\\mathbb{E}[f(Y) \\mid \\mathcal{G}] = \\mathbb{E}[f(Y)]$ 几乎必然成立。\n\n在我们的例子中，随机变量是 $\\Delta W_n$，$\\sigma$-代数是 $\\mathcal{F}_{t_{n}}$。由于 $\\Delta W_n$ 独立于 $\\mathcal{F}_{t_{n}}$，我们可以应用此性质，函数为 $f(x) = x^2$：\n$$\n\\mathbb{E}\\!\\left[(\\Delta W_{n})^{2}\\mid \\mathcal{F}_{t_{n}}\\right] = \\mathbb{E}\\!\\left[(\\Delta W_{n})^{2}\\right] \\quad (\\text{a.s.})\n$$\n右边是 $\\Delta W_n$ 的无条件二阶矩。对于任何随机变量 $Y$，其二阶矩与其方差和均值的关系为 $\\mathbb{E}[Y^2] = \\text{Var}(Y) + (\\mathbb{E}[Y])^2$。\n从布朗增量的分布可知：\n-   均值为 $\\mathbb{E}[\\Delta W_n] = 0$。\n-   方差为 $\\text{Var}(\\Delta W_n) = \\Delta t$。\n\n代入这些值，我们得到：\n$$\n\\mathbb{E}\\!\\left[(\\Delta W_{n})^{2}\\right] = \\text{Var}(\\Delta W_n) + (\\mathbb{E}[\\Delta W_n])^2 = \\Delta t + 0^2 = \\Delta t\n$$\n因此，我们证明了\n$$\n\\mathbb{E}\\!\\left[(\\Delta W_{n})^{2}\\mid \\mathcal{F}_{t_{n}}\\right] = \\Delta t \\quad (\\text{a.s.})\n$$\n\n第二部分：推导 $\\mathbb{E}\\!\\left[X_{n+1}^{2}\\mid \\mathcal{F}_{t_{n}}\\right]$ 的一个闭式表达式。\n\nEuler–Maruyama 离散化由下式给出：\n$$\nX_{n+1} = X_{n} + a(X_{n})\\,\\Delta t + b(X_{n})\\,\\Delta W_{n}\n$$\n我们需要计算给定时间 $t_n$ 信息（即 $\\sigma$-代数 $\\mathcal{F}_{t_n}$）下 $X_{n+1}^2$ 的条件期望。我们首先对 $X_{n+1}$ 的表达式进行平方：\n$$\nX_{n+1}^2 = \\left( (X_n + a(X_n)\\Delta t) + (b(X_n)\\Delta W_n) \\right)^2\n$$\n展开这个平方得到：\n$$\nX_{n+1}^2 = (X_n + a(X_n)\\Delta t)^2 + 2(X_n + a(X_n)\\Delta t)(b(X_n)\\Delta W_n) + (b(X_n)\\Delta W_n)^2\n$$\n让我们完全展开所有项：\n$$\nX_{n+1}^2 = X_n^2 + 2X_n a(X_n)\\Delta t + (a(X_n))^2(\\Delta t)^2 + 2X_n b(X_n)\\Delta W_n + 2a(X_n)b(X_n)\\Delta t \\Delta W_n + (b(X_n))^2 (\\Delta W_n)^2\n$$\n现在，我们对两边取关于 $\\mathcal{F}_{t_n}$ 的条件期望。利用条件期望的线性性，我们可以分别计算每一项：\n$$\n\\mathbb{E}[X_{n+1}^2 \\mid \\mathcal{F}_{t_n}] = \\mathbb{E}[X_n^2 \\mid \\mathcal{F}_{t_n}] + \\mathbb{E}[2X_n a(X_n)\\Delta t \\mid \\mathcal{F}_{t_n}] + \\mathbb{E}[(a(X_n))^2(\\Delta t)^2 \\mid \\mathcal{F}_{t_n}] + \\mathbb{E}[2X_n b(X_n)\\Delta W_n \\mid \\mathcal{F}_{t_n}] + \\mathbb{E}[2a(X_n)b(X_n)\\Delta t \\Delta W_n \\mid \\mathcal{F}_{t_n}] + \\mathbb{E}[(b(X_n))^2 (\\Delta W_n)^2 \\mid \\mathcal{F}_{t_n}]\n$$\n为了简化这个表达式，我们利用 $X_n$ 是由直到时间 $t_n$ 的增量构造而来的，因此 $X_n$ 是一个 $\\mathcal{F}_{t_n}$-可测随机变量。因此，$X_n$ 的任何函数，如 $a(X_n)$ 和 $b(X_n)$，也都是 $\\mathcal{F}_{t_n}$-可测的。我们使用条件期望的“提取已知因子”性质：如果 $Z$ 是 $\\mathcal{G}$-可测的，则 $\\mathbb{E}[ZY \\mid \\mathcal{G}] = Z \\mathbb{E}[Y \\mid \\mathcal{G}]$ 几乎必然成立。\n\n我们来计算每一项：\n-   项 $X_n^2$、$2X_n a(X_n)\\Delta t$ 和 $(a(X_n))^2(\\Delta t)^2$ 都是 $\\mathcal{F}_{t_n}$-可测的。对于任何 $\\mathcal{F}_{t_n}$-可测变量 $Z$，$\\mathbb{E}[Z \\mid \\mathcal{F}_{t_n}] = Z$。所以，\n    $$\n    \\mathbb{E}[X_n^2 + 2X_n a(X_n)\\Delta t + (a(X_n))^2(\\Delta t)^2 \\mid \\mathcal{F}_{t_n}] = X_n^2 + 2X_n a(X_n)\\Delta t + (a(X_n))^2(\\Delta t)^2\n    $$\n-   对于包含 $\\Delta W_n$ 的项：\n    $$\n    \\mathbb{E}[2X_n b(X_n)\\Delta W_n \\mid \\mathcal{F}_{t_n}] = 2X_n b(X_n) \\mathbb{E}[\\Delta W_n \\mid \\mathcal{F}_{t_n}]\n    $$\n    $$\n    \\mathbb{E}[2a(X_n)b(X_n)\\Delta t \\Delta W_n \\mid \\mathcal{F}_{t_n}] = 2a(X_n)b(X_n)\\Delta t \\mathbb{E}[\\Delta W_n \\mid \\mathcal{F}_{t_n}]\n    $$\n    由于 $\\Delta W_n$ 独立于 $\\mathcal{F}_{t_n}$ 且均值为 $0$，我们有 $\\mathbb{E}[\\Delta W_n \\mid \\mathcal{F}_{t_n}] = \\mathbb{E}[\\Delta W_n] = 0$。因此，这两项都为 $0$。\n-   对于包含 $(\\Delta W_n)^2$ 的最后一项：\n    $$\n    \\mathbb{E}[(b(X_n))^2 (\\Delta W_n)^2 \\mid \\mathcal{F}_{t_n}] = (b(X_n))^2 \\mathbb{E}[(\\Delta W_n)^2 \\mid \\mathcal{F}_{t_n}]\n    $$\n    使用第一部分的结果，$\\mathbb{E}[(\\Delta W_n)^2 \\mid \\mathcal{F}_{t_n}] = \\Delta t$。所以该项变为 $(b(X_n))^2 \\Delta t$。\n\n合并所有简化后的项，我们得到最终表达式：\n$$\n\\mathbb{E}[X_{n+1}^2 \\mid \\mathcal{F}_{t_n}] = X_n^2 + 2X_n a(X_n)\\Delta t + (a(X_n))^2(\\Delta t)^2 + 0 + 0 + (b(X_n))^2 \\Delta t\n$$\n整理各项，我们得到条件二阶矩的闭式表达式：\n$$\n\\mathbb{E}[X_{n+1}^2 \\mid \\mathcal{F}_{t_n}] = X_{n}^2 + 2X_{n} a(X_{n}) \\Delta t + (a(X_{n}))^2 (\\Delta t)^2 + (b(X_{n}))^2 \\Delta t\n$$\n这个表达式是问题第二部分的最终答案。", "answer": "$$\n\\boxed{X_{n}^2 + 2X_{n} a(X_{n}) \\Delta t + (a(X_{n}))^2 (\\Delta t)^2 + (b(X_{n}))^2 \\Delta t}\n$$", "id": "3082682"}]}