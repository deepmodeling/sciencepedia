{"hands_on_practices": [{"introduction": "在模拟包含跳跃的随机微分方程时，能够从泊松分布中生成随机数是一项基本技能。本练习介绍了一种经典的算法，它巧妙地将均匀分布的随机数与泊松过程的基本结构联系起来。通过这个实践，你将不仅学会一个实用的抽样方法，还能深化对泊松过程与指数分布之间内在关系的理解。[@problem_id:3044321]", "problem": "在模拟由随机微分方程中的泊松过程驱动的随机模型的跳跃项时，一个常见的任务是抽样一个参数为 $\\lambda0$ 的泊松分布随机变量。一种经典方法仅使用独立的 Uniform$(0,1)$ 随机变量。考虑以下输出非负整数的算法：\n- 初始化 $k \\leftarrow 0$ 和 $p \\leftarrow 1$。\n- 重复：\n  - 生成一个与之前所有随机变量独立的 $U \\sim \\text{Uniform}(0,1)$。\n  - 更新 $p \\leftarrow p \\cdot U$ 和 $k \\leftarrow k+1$。\n- 直到 $p \\leq \\exp(-\\lambda)$。\n- 返回 $k-1$。\n\n仅使用可以从第一性原理证明的基本事实，即：(i) 如果 $U \\sim \\text{Uniform}(0,1)$，那么 $-\\ln U$ 服从 Exponential$(1)$ 分布，(ii) n个独立 Exponential$(1)$ 随机变量的和服从 Gamma$(n,1)$ 分布，其密度为 $f_{S_{n}}(t)=\\frac{t^{n-1}\\exp(-t)}{(n-1)!}$ (当 $t0$ 时)，以及 (iii) 积分和期望的标准性质，完成以下任务：\n1) 清晰地说明为什么上述算法是对参数为 $\\lambda$ 的泊松分布随机变量进行抽样的有效方法。\n2) 令 $L$ 表示循环的总迭代次数（即实际生成的独立 Uniform$(0,1)$ 随机变量的数量）。根据所列事实，推导出 $\\mathbb{E}[L]$ 作为 $\\lambda$ 函数的闭式表达式。\n以单一解析表达式的形式给出你的最终答案。不需要数值近似。", "solution": "该问题将按要求分两部分进行解答：首先，证明该算法的有效性；其次，推导期望迭代次数。\n\n第1部分：算法有效性证明\n\n该算法旨在生成一个我们称之为 $K$ 的随机变量，我们必须证明它服从参数为 $\\lambda$ 的泊松分布。算法流程如下：\n1.  生成一系列独立的随机变量 $U_1, U_2, \\dots, U_L$，其中每个 $U_i \\sim \\text{Uniform}(0,1)$。生成的此类变量总数为 $L$。\n2.  当乘积 $p_L = \\prod_{i=1}^{L} U_i$ 首次满足条件 $p_L \\leq \\exp(-\\lambda)$ 时，过程在对应的整数 $L \\ge 1$ 处终止。\n3.  算法返回的值是 $K = L-1$。\n\n为了分析这个过程，我们对停止条件进行对数变换。只要 $\\prod_{i=1}^{k} U_i  \\exp(-\\lambda)$，循环就继续；并在第一次满足 $\\prod_{i=1}^{L} U_i \\leq \\exp(-\\lambda)$ 的迭代 $L$ 处停止。这意味着，要使 $L$ 成为停止迭代的次数，必须满足两个条件：\n-   在第 $L-1$ 次迭代时（对于 $L1$）：$\\prod_{i=1}^{L-1} U_i  \\exp(-\\lambda)$。\n-   在第 $L$ 次迭代时：$\\prod_{i=1}^{L} U_i \\leq \\exp(-\\lambda)$。\n\n对这些不等式取自然对数得到：\n-   $\\sum_{i=1}^{L-1} \\ln(U_i)  -\\lambda$\n-   $\\sum_{i=1}^{L} \\ln(U_i) \\leq -\\lambda$\n\n两边乘以 $-1$ 反转不等号：\n-   $\\sum_{i=1}^{L-1} (-\\ln U_i)  \\lambda$\n-   $\\sum_{i=1}^{L} (-\\ln U_i) \\geq \\lambda$\n\n让我们定义一个新的随机变量序列 $X_i = -\\ln U_i$。根据所给定的事实 (i)，由于 $U_i \\sim \\text{Uniform}(0,1)$，每个 $X_i$ 都是一个独立的随机变量，服从速率参数为 $1$ 的指数分布，即 $X_i \\sim \\text{Exponential}(1)$。\n\n令 $S_k = \\sum_{i=1}^{k} X_i$ 为这些指数变量中前 $k$ 个的和。按照惯例，我们设 $S_0 = 0$。现在，算法的停止条件可以用部分和序列 $\\{S_k\\}$ 来表示：算法在第一个满足 $S_L \\geq \\lambda$ 的整数 $L$ 处终止。这意味着 $S_{L-1}  \\lambda$。因此，停止迭代次数 $L$ 的特征在于事件 $\\{S_{L-1}  \\lambda \\leq S_L\\}$。\n\n算法返回的值为 $K = L-1$。让我们来确定 $K$ 的概率分布。对于任何非负整数 $n \\in \\{0, 1, 2, \\dots\\}$，事件 $\\{K=n\\}$ 等价于事件 $\\{L-1=n\\}$，即 $\\{L=n+1\\}$。这意味着算法在第 $(n+1)$ 次迭代时终止。这当且仅当 $S_n  \\lambda \\leq S_{n+1}$ 时发生。\n\n现在我们将此与泊松过程的定义联系起来。一个速率为 $1$ 的齐次泊松过程，我们记为 $N(t)$，它计算在时间区间 $[0, t]$ 内发生的事件数量。从第一性原理可知，这种过程的特征性质是：连续事件之间的到达间隔时间是服从 Exponential(1) 分布的独立同分布随机变量。在我们的构建中，变量 $X_i$ 正好代表了这些到达间隔时间，而 $S_k$ 代表了第 $k$ 个事件发生的时间。\n\n在区间 $[0, \\lambda]$ 内到达次数恰好为 $n$ 的事件，记为 $\\{N(\\lambda)=n\\}$，等价于第 $n$ 个事件在时间 $\\lambda$ 或之前发生，而第 $(n+1)$ 个事件在时间 $\\lambda$ 之后发生的条件。形式上，这表示为 $\\{S_n \\leq \\lambda  S_{n+1}\\}$。\n\n因此，我们得到事件的等价关系：\n$$\n\\{K=n\\} \\iff \\{S_n  \\lambda \\leq S_{n+1}\\}\n$$\n由于 $S_n$ 和 $S_{n+1}$ 是连续随机变量（指数变量的和），$S_n=\\lambda$ 或 $S_{n+1}=\\lambda$ 的概率为零。因此，$P(S_n  \\lambda \\leq S_{n+1}) = P(S_n \\leq \\lambda  S_{n+1})$。\n\n这就证明了 $P(K=n) = P(N(\\lambda)=n)$。根据泊松过程的定义，对于一个速率为 $1$ 的过程，在长度为 $\\lambda$ 的区间内的事件数 $N(\\lambda)$ 服从参数（均值）为 $\\lambda$ 的泊松分布。\n因此，算法返回的随机变量 $K$ 服从 Poisson($\\lambda$) 分布。这证明了该算法的有效性。\n\n第2部分：$\\mathbb{E}[L]$ 的推导\n\n令 $L$ 为循环的总迭代次数，也就是生成的 Uniform$(0,1)$ 随机变量的数量。$L$ 是一个取值于 $\\{1, 2, 3, \\dots\\}$ 的随机变量。为了求其期望 $\\mathbb{E}[L]$，我们可以使用非负整值随机变量的标准性质：\n$$\n\\mathbb{E}[L] = \\sum_{k=1}^{\\infty} P(L \\geq k)\n$$\n事件 $\\{L \\geq k\\}$ 表示循环在第 $(k-1)$ 次迭代或之前没有终止。这等价于经过 $k-1$ 步后停止准则未被满足的条件，即 $\\prod_{i=1}^{k-1} U_i  \\exp(-\\lambda)$。\n用指数变量的和 $S_j = \\sum_{i=1}^{j} X_i$ 来表示，这等价于事件 $\\{S_{k-1}  \\lambda\\}$。\n因此，我们可以将期望写为：\n$$\n\\mathbb{E}[L] = \\sum_{k=1}^{\\infty} P(S_{k-1}  \\lambda)\n$$\n令 $j=k-1$ 来改变求和索引。则该和变为：\n$$\n\\mathbb{E}[L] = \\sum_{j=0}^{\\infty} P(S_j  \\lambda) = P(S_0  \\lambda) + \\sum_{j=1}^{\\infty} P(S_j  \\lambda)\n$$\n按照惯例，$S_0=0$。由于题目陈述中指定 $\\lambda  0$，事件 $\\{S_0  \\lambda\\}$ 即为 $\\{0  \\lambda\\}$，这是一个必然事件。所以 $P(S_0  \\lambda) = 1$。\n\n对于 $j \\ge 1$，$S_j$ 是 $j$ 个独立的 Exponential(1) 随机变量的和。根据所给定的事实 (ii)，$S_j$ 服从 Gamma($j,1$) 分布，其概率密度函数为 $f_{S_j}(t) = \\frac{t^{j-1}\\exp(-t)}{(j-1)!}$ (当 $t0$ 时)。\n概率 $P(S_j  \\lambda)$ 是在 $\\lambda$ 处求值的累积分布函数：\n$$\nP(S_j  \\lambda) = \\int_0^{\\lambda} f_{S_j}(t) dt = \\int_0^{\\lambda} \\frac{t^{j-1}\\exp(-t)}{(j-1)!} dt\n$$\n将此代入 $\\mathbb{E}[L]$ 的表达式中：\n$$\n\\mathbb{E}[L] = 1 + \\sum_{j=1}^{\\infty} \\int_0^{\\lambda} \\frac{t^{j-1}\\exp(-t)}{(j-1)!} dt\n$$\n由于被积函数 $\\frac{t^{j-1}\\exp(-t)}{(j-1)!}$ 在 $t \\in [0, \\lambda]$ 上是非负的，我们可以交换求和与积分的顺序（根据富比尼-托内利定理）：\n$$\n\\mathbb{E}[L] = 1 + \\int_0^{\\lambda} \\sum_{j=1}^{\\infty} \\frac{t^{j-1}\\exp(-t)}{(j-1)!} dt\n$$\n我们可以从和式中提出 $\\exp(-t)$ 项：\n$$\n\\mathbb{E}[L] = 1 + \\int_0^{\\lambda} \\exp(-t) \\left( \\sum_{j=1}^{\\infty} \\frac{t^{j-1}}{(j-1)!} \\right) dt\n$$\n我们分析括号内的和式。通过设索引 $m=j-1$，该和式变为：\n$$\n\\sum_{m=0}^{\\infty} \\frac{t^m}{m!}\n$$\n这是指数函数 $\\exp(t)$ 的麦克劳林级数展开。将其代回积分：\n$$\n\\mathbb{E}[L] = 1 + \\int_0^{\\lambda} \\exp(-t) \\exp(t) dt = 1 + \\int_0^{\\lambda} 1 \\cdot dt\n$$\n计算这个简单的积分得到：\n$$\n\\mathbb{E}[L] = 1 + [t]_0^{\\lambda} = 1 + (\\lambda - 0) = 1 + \\lambda\n$$\n因此，期望的迭代次数，也就是生成的均匀随机变量的期望数量，为 $1 + \\lambda$。", "answer": "$$\\boxed{1+\\lambda}$$", "id": "3044321"}, {"introduction": "知道如何生成泊松随机数后，一个自然而然的问题是：我们如何从观测数据中确定其关键参数——泊松率 $\\lambda$？本练习将指导你推导泊松率的最大似然估计量 (MLE)，并使用克拉默-拉奥下界 (CRLB) 来评估其效率。这个过程展示了从实验数据中为我们的随机模型确定最佳参数的严谨统计方法。[@problem_id:3044313]", "problem": "一个速率参数为 $\\lambda \\in (0,\\infty)$ 的齐次泊松过程，用于对随机微分方程中驱动跳跃-扩散部分的跳跃事件计数进行建模，这些事件发生在不相交的单位长度时间窗口内。你观察到 $n$ 个独立计数 $X_{1}, X_{2}, \\dots, X_{n}$，每个计数对应于单个单位长度窗口内的跳跃次数。假设对于 $i \\in \\{1,2,\\dots,n\\}$，$X_{i} \\sim \\text{Poisson}(\\lambda)$ 且相互独立。\n\n从统计估计的核心定义出发，包括泊松模型的似然函数、作为对数似然导数的得分函数，以及作为对数似然负二阶导数期望的费雪信息，推导基于 $X_{1},\\dots,X_{n}$ 的任何 $\\lambda$ 的无偏估计量的方差的克拉默-拉奥下界 (CRLB)。然后，推导 $\\lambda$ 的最大似然估计量 (MLE)，确定其期望和方差，并评估它是否达到 CRLB。\n\n你的最终答案必须是 CRLB 作为 $\\lambda$ 和 $n$ 的函数的单个闭式解析表达式。无需四舍五入。", "solution": "该问题要求在给定 $n$ 个独立同分布 (i.i.d.) 观测样本的情况下，推导泊松分布速率参数 $\\lambda$ 的任何无偏估计量的方差的克拉默-拉奥下界 (CRLB)。它还要求推导 $\\lambda$ 的最大似然估计量 (MLE) 并评估其有效性。\n\n设 $X_{1}, X_{2}, \\dots, X_{n}$ 为 $n$ 个独立的随机变量，其中每个 $X_{i}$ 服从参数为 $\\lambda  0$ 的泊松分布，记为 $X_{i} \\sim \\text{Poisson}(\\lambda)$。单个观测值 $X_{i}$ 的概率质量函数 (PMF) 由下式给出：\n$$P(X_{i} = k) = \\frac{\\lambda^{k} \\exp(-\\lambda)}{k!}$$\n对于 $k \\in \\{0, 1, 2, \\dots\\}$。\n\n首先，我们构建似然函数 $L(\\lambda)$，它是观测到样本 $x_{1}, x_{2}, \\dots, x_{n}$ 的联合概率。由于观测值的独立性，似然函数是各个 PMF 的乘积：\n$$L(\\lambda; x_{1}, \\dots, x_{n}) = \\prod_{i=1}^{n} P(X_{i} = x_{i}) = \\prod_{i=1}^{n} \\frac{\\lambda^{x_{i}} \\exp(-\\lambda)}{x_{i}!}$$\n\n在计算上，使用对数似然函数 $\\ell(\\lambda) = \\ln(L(\\lambda))$ 更为方便：\n$$ \\ell(\\lambda) = \\ln\\left(\\prod_{i=1}^{n} \\frac{\\lambda^{x_{i}} \\exp(-\\lambda)}{x_{i}!}\\right) = \\sum_{i=1}^{n} \\ln\\left(\\frac{\\lambda^{x_{i}} \\exp(-\\lambda)}{x_{i}!}\\right) $$\n$$ \\ell(\\lambda) = \\sum_{i=1}^{n} (x_{i}\\ln(\\lambda) - \\lambda - \\ln(x_{i}!)) $$\n$$ \\ell(\\lambda) = \\ln(\\lambda)\\left(\\sum_{i=1}^{n} x_{i}\\right) - n\\lambda - \\sum_{i=1}^{n} \\ln(x_{i}!) $$\n\n得分函数 $S(\\lambda)$ 是对数似然函数关于参数 $\\lambda$ 的一阶导数：\n$$ S(\\lambda) = \\frac{\\partial \\ell(\\lambda)}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} \\left[ \\ln(\\lambda)\\left(\\sum_{i=1}^{n} x_{i}\\right) - n\\lambda - \\sum_{i=1}^{n} \\ln(x_{i}!) \\right] $$\n$$ S(\\lambda) = \\frac{1}{\\lambda}\\left(\\sum_{i=1}^{n} x_{i}\\right) - n $$\n\n接下来，我们计算费雪信息 $I(\\lambda)$。费雪信息定义为对数似然函数二阶导数的期望值的负数。首先，我们计算二阶导数：\n$$ \\frac{\\partial^2 \\ell(\\lambda)}{\\partial \\lambda^2} = \\frac{\\partial S(\\lambda)}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} \\left[ \\frac{1}{\\lambda}\\left(\\sum_{i=1}^{n} x_{i}\\right) - n \\right] = -\\frac{1}{\\lambda^2}\\left(\\sum_{i=1}^{n} x_{i}\\right) $$\n\n现在，我们取该量的期望。为此，我们将观测值 $x_{i}$ 视为随机变量 $X_{i}$。我们利用一个事实，即对于服从泊松分布的随机变量 $X_{i}$，其期望为 $\\mathbb{E}[X_{i}] = \\lambda$。\n$$ I(\\lambda) = -\\mathbb{E}\\left[\\frac{\\partial^2 \\ell(\\lambda)}{\\partial \\lambda^2}\\right] = -\\mathbb{E}\\left[-\\frac{1}{\\lambda^2}\\left(\\sum_{i=1}^{n} X_{i}\\right)\\right] $$\n$$ I(\\lambda) = \\frac{1}{\\lambda^2} \\mathbb{E}\\left[\\sum_{i=1}^{n} X_{i}\\right] $$\n根据期望的线性性，$\\mathbb{E}\\left[\\sum_{i=1}^{n} X_{i}\\right] = \\sum_{i=1}^{n} \\mathbb{E}[X_{i}] = \\sum_{i=1}^{n} \\lambda = n\\lambda$。\n将此结果代回费雪信息的表达式中：\n$$ I(\\lambda) = \\frac{1}{\\lambda^2} (n\\lambda) = \\frac{n}{\\lambda} $$\n\n克拉默-拉奥下界 (CRLB) 给出了 $\\lambda$ 的任何无偏估计量 $\\hat{\\lambda}$ 的方差的下界。该下界是费雪信息的倒数：\n$$ \\text{Var}(\\hat{\\lambda}) \\ge \\frac{1}{I(\\lambda)} $$\n因此，$\\lambda$ 的 CRLB 为：\n$$ \\text{CRLB} = \\frac{1}{I(\\lambda)} = \\frac{1}{n/\\lambda} = \\frac{\\lambda}{n} $$\n\n现在，我们来推导 $\\lambda$ 的最大似然估计量 (MLE)，记为 $\\hat{\\lambda}_{\\text{MLE}}$。我们通过将得分函数设为零并求解 $\\lambda$ 来找到 MLE：\n$$ S(\\lambda) = \\frac{1}{\\lambda}\\left(\\sum_{i=1}^{n} x_{i}\\right) - n = 0 $$\n$$ \\frac{1}{\\lambda}\\sum_{i=1}^{n} x_{i} = n $$\n$$ \\hat{\\lambda}_{\\text{MLE}} = \\frac{1}{n} \\sum_{i=1}^{n} x_{i} = \\bar{x} $$\n$\\lambda$ 的 MLE 是观测值的样本均值。对数似然的二阶导数 $-\\frac{1}{\\lambda^2}\\sum_{i=1}^{n} x_{i}$，在 $\\lambda0$ 和计数非零时为负，这证实了这是一个最大值。\n\n为了评估 MLE 是否达到 CRLB，我们必须首先检查它是否为无偏估计量，然后计算其方差。\nMLE 的期望为：\n$$ \\mathbb{E}[\\hat{\\lambda}_{\\text{MLE}}] = \\mathbb{E}\\left[\\frac{1}{n} \\sum_{i=1}^{n} X_{i}\\right] = \\frac{1}{n} \\sum_{i=1}^{n} \\mathbb{E}[X_{i}] = \\frac{1}{n} \\sum_{i=1}^{n} \\lambda = \\frac{n\\lambda}{n} = \\lambda $$\n由于 $\\mathbb{E}[\\hat{\\lambda}_{\\text{MLE}}] = \\lambda$，MLE 是 $\\lambda$ 的无偏估计量。\n\nMLE 的方差为：\n$$ \\text{Var}(\\hat{\\lambda}_{\\text{MLE}}) = \\text{Var}\\left(\\frac{1}{n} \\sum_{i=1}^{n} X_{i}\\right) $$\n由于 $X_i$ 是独立的，和的方差是方差的和：\n$$ \\text{Var}(\\hat{\\lambda}_{\\text{MLE}}) = \\frac{1}{n^2} \\sum_{i=1}^{n} \\text{Var}(X_{i}) $$\n对于泊松分布，我们有 $\\text{Var}(X_i) = \\lambda$。\n$$ \\text{Var}(\\hat{\\lambda}_{\\text{MLE}}) = \\frac{1}{n^2} \\sum_{i=1}^{n} \\lambda = \\frac{n\\lambda}{n^2} = \\frac{\\lambda}{n} $$\n\n将 MLE 的方差与 CRLB 进行比较：\n$$ \\text{Var}(\\hat{\\lambda}_{\\text{MLE}}) = \\frac{\\lambda}{n} = \\text{CRLB} $$\n由于无偏 MLE 的方差等于克拉默-拉奥下界，因此 MLE $\\hat{\\lambda}_{\\text{MLE}} = \\bar{X}$ 是 $\\lambda$ 的有效估计量。\n\n问题要求 CRLB 的闭式解析表达式。如上推导，其结果为 $\\frac{\\lambda}{n}$。", "answer": "$$\\boxed{\\frac{\\lambda}{n}}$$", "id": "3044313"}, {"introduction": "在随机微分方程的数值求解中，时间步长的选择是效率与准确性之间权衡的关键。对于跳跃-扩散过程，一个过大的步长可能会忽略在单个时间步内发生的多次跳跃，从而引入显著误差。本练习将展示如何利用泊松分布的性质，来设计一种自适应步长策略，从而在控制模拟误差的同时保证计算效率。[@problem_id:3044306]", "problem": "考虑一个一维随机微分方程 (SDE)，其包含一个纯跳跃部分，跳跃强度依赖于状态，记为 $\\lambda(x) \\ge 0$。您正在一个单步 $[t, t + h]$ 上实现一个跳跃自适应欧拉格式。令 $N_h$ 表示此区间内发生的跳跃次数。假设基于 $t$ 时刻的局部信息，您已计算出一个上界 $\\overline{\\lambda}  0$，对于您考虑要进行的步长，该上界满足对所有 $s \\in [t, t+h]$ 都有 $\\lambda(X_s) \\le \\overline{\\lambda}$。您的目标是选择一个自适应步长 $h$，使得在该步长内观察到超过一次跳跃的概率由用户指定的容差 $\\varepsilon \\in (0,1)$ 控制。\n\n从计数过程和经典离散分布的第一性原理出发，使用以下基本事实：\n\n- 如果在长度为 $h$ 的区间上，跳跃强度的上界为常数 $\\overline{\\lambda}$，则该区间上的跳跃次数被一个均值为 $\\mu = \\overline{\\lambda} h$ 的泊松随机变量随机占优。\n\n- 仅使用泊松分布的定义和指数函数的标准不等式，推导出一个关于 $\\mathbb{P}(N_h \\ge 2)$ 的界限（用 $\\mu$ 表示），该界限对所有 $\\mu \\ge 0$ 都成立。\n\n使用此界限得出一个保守的自适应步长准则 $h_{\\max}(\\varepsilon, \\overline{\\lambda})$，以保证 $\\mathbb{P}(N_h \\ge 2) \\le \\varepsilon$。\n\n请以一个关于 $\\varepsilon$ 和 $\\overline{\\lambda}$ 的单一闭式符号表达式形式提供 $h_{\\max}(\\varepsilon, \\overline{\\lambda})$ 的最终答案。不要进行任何数值舍入。请以符号形式表达您的最终答案；最终表达式中不需要物理单位。", "solution": "所述问题具有科学依据、提法恰当且客观。它基于随机微分方程的随机微积分和数值分析的标准原理。问题的前提在数学上是合理的，目标定义清晰，并提供了足够的信息来推导出唯一解。因此，该问题被认为是有效的。我们可以继续进行求解。\n\n目标是推导出一个保守的自适应步长准则，记为 $h_{\\max}(\\varepsilon, \\overline{\\lambda})$，该准则保证在长度为 $h$ 的时间区间内观察到两次或更多次跳跃的概率不大于指定的容差 $\\varepsilon$。需要满足的条件是 $\\mathbb{P}(N_h \\ge 2) \\le \\varepsilon$，其中 $N_h$ 是区间 $[t, t+h]$ 内的跳跃次数。\n\n问题提供了一个基本事实：如果对于 $s \\in [t, t+h]$，依赖状态的跳跃强度 $\\lambda(X_s)$ 的上界为常数 $\\overline{\\lambda}$，那么该区间内的跳跃次数 $N_h$ 被一个均值参数为 $\\mu = \\overline{\\lambda} h$ 的泊松随机变量（我们称之为 $M$）随机占优。随机占优意味着对于任何整数 $k \\ge 0$，累积分布函数满足 $\\mathbb{P}(N_h \\le k) \\ge \\mathbb{P}(M \\le k)$，这等价于 $\\mathbb{P}(N_h  k) \\le \\mathbb{P}(M  k)$ 或 $\\mathbb{P}(N_h \\ge k) \\le \\mathbb{P}(M \\ge k)$。\n\n因此，为了满足目标条件 $\\mathbb{P}(N_h \\ge 2) \\le \\varepsilon$，对占优变量 $M$ 施加一个更严格的条件就足够了：\n$$\n\\mathbb{P}(M \\ge 2) \\le \\varepsilon\n$$\n\n接下来，我们必须推导出一个关于 $\\mathbb{P}(M \\ge 2)$ 的可用界限（用 $\\mu$ 表示）。均值为 $\\mu$ 的泊松随机变量 $M$ 的概率质量函数由 $P(M=k) = \\frac{e^{-\\mu} \\mu^k}{k!}$ 给出，其中 $k \\in \\{0, 1, 2, \\dots\\}$。观察到两次或更多次事件的概率是观察到零次或一次事件的补集：\n$$\n\\mathbb{P}(M \\ge 2) = 1 - \\mathbb{P}(M  2) = 1 - (\\mathbb{P}(M=0) + \\mathbb{P}(M=1))\n$$\n代入泊松概率：\n$$\n\\mathbb{P}(M \\ge 2) = 1 - \\left( \\frac{e^{-\\mu} \\mu^0}{0!} + \\frac{e^{-\\mu} \\mu^1}{1!} \\right) = 1 - e^{-\\mu}(1+\\mu)\n$$\n这个表达式是精确的。然而，问题要求我们推导一个更简单的界限。我们可以将 $\\mathbb{P}(M \\ge 2)$ 表示为一个无穷级数：\n$$\n\\mathbb{P}(M \\ge 2) = \\sum_{k=2}^{\\infty} \\frac{e^{-\\mu} \\mu^k}{k!} = e^{-\\mu} \\left( \\frac{\\mu^2}{2!} + \\frac{\\mu^3}{3!} + \\frac{\\mu^4}{4!} + \\dots \\right)\n$$\n我们可以为这个级数建立一个上界。提出公因子 $\\frac{\\mu^2}{2}$：\n$$\n\\mathbb{P}(M \\ge 2) = e^{-\\mu} \\frac{\\mu^2}{2} \\left( 1 + \\frac{\\mu}{3} + \\frac{\\mu^2}{3 \\cdot 4} + \\frac{\\mu^3}{3 \\cdot 4 \\cdot 5} + \\dots \\right) = e^{-\\mu} \\frac{\\mu^2}{2} \\sum_{j=0}^{\\infty} \\frac{2 \\mu^j}{(j+2)!}\n$$\n对于任何整数 $j \\ge 0$，我们有不等式 $(j+2)! = (j+2)(j+1)j! \\ge 2 \\cdot j!$。因此，$\\frac{1}{(j+2)!} \\le \\frac{1}{2 \\cdot j!}$。利用这个不等式，我们可以对求和进行放缩：\n$$\n\\sum_{j=0}^{\\infty} \\frac{2 \\mu^j}{(j+2)!} \\le \\sum_{j=0}^{\\infty} \\frac{2 \\mu^j}{2 j!} = \\sum_{j=0}^{\\infty} \\frac{\\mu^j}{j!}\n$$\n右侧的求和结果是指数函数的泰勒级数展开式，$\\sum_{j=0}^{\\infty} \\frac{\\mu^j}{j!} = e^{\\mu}$。\n将此不等式代回到我们关于 $\\mathbb{P}(M \\ge 2)$ 的表达式中，我们得到界限：\n$$\n\\mathbb{P}(M \\ge 2) \\le e^{-\\mu} \\frac{\\mu^2}{2} (e^{\\mu}) = \\frac{\\mu^2}{2}\n$$\n这个不等式 $\\mathbb{P}(M \\ge 2) \\le \\frac{\\mu^2}{2}$ 对所有 $\\mu \\ge 0$ 都成立。为了正式验证这一点，令 $f(\\mu) = \\frac{\\mu^2}{2} - \\mathbb{P}(M \\ge 2) = \\frac{\\mu^2}{2} - (1 - (1+\\mu)e^{-\\mu})$。在 $\\mu=0$ 时，$f(0) = 0 - (1 - (1)e^0) = 0$。关于 $\\mu$ 的导数是：\n$$\nf'(\\mu) = \\frac{d}{d\\mu} \\left( \\frac{\\mu^2}{2} - 1 + e^{-\\mu} + \\mu e^{-\\mu} \\right) = \\mu - e^{-\\mu} + (e^{-\\mu} - \\mu e^{-\\mu}) = \\mu - \\mu e^{-\\mu} = \\mu(1 - e^{-\\mu})\n$$\n对于所有 $\\mu  0$，我们有 $\\mu  0$ 且 $e^{-\\mu}  1$，这意味着 $(1 - e^{-\\mu})  0$。因此，当 $\\mu  0$ 时 $f'(\\mu)  0$。由于 $f(0)=0$ 且该函数在 $\\mu \\ge 0$ 上是单调递增的，我们得出结论：对于所有 $\\mu \\ge 0$，$f(\\mu) \\ge 0$，这证实了 $\\mathbb{P}(M \\ge 2) \\le \\frac{\\mu^2}{2}$ 对于所有非负 $\\mu$ 是一个有效的上界。\n\n利用这个保守的界限，我们可以通过施加更严格的条件来满足控制目标 $\\mathbb{P}(M \\ge 2) \\le \\varepsilon$：\n$$\n\\frac{\\mu^2}{2} \\le \\varepsilon\n$$\n现在，代入均值的定义 $\\mu = \\overline{\\lambda} h$：\n$$\n\\frac{(\\overline{\\lambda} h)^2}{2} \\le \\varepsilon\n$$\n我们对步长 $h$ 求解这个不等式。鉴于 $\\overline{\\lambda}  0$ 且 $h \\ge 0$：\n$$\n(\\overline{\\lambda} h)^2 \\le 2\\varepsilon\n$$\n$$\n\\overline{\\lambda} h \\le \\sqrt{2\\varepsilon}\n$$\n$$\nh \\le \\frac{\\sqrt{2\\varepsilon}}{\\overline{\\lambda}}\n$$\n这个不等式给出了步长 $h$ 的一个上限，保证我们的概率约束得以满足。问题要求的是满足条件的最大步长 $h_{\\max}(\\varepsilon, \\overline{\\lambda})$，即该区间的上边界。\n$$\nh_{\\max}(\\varepsilon, \\overline{\\lambda}) = \\frac{\\sqrt{2\\varepsilon}}{\\overline{\\lambda}}\n$$\n这就是所求的保守的自适应步长准则。", "answer": "$$\\boxed{\\frac{\\sqrt{2\\varepsilon}}{\\overline{\\lambda}}}$$", "id": "3044306"}]}