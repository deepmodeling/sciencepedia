{"hands_on_practices": [{"introduction": "我们将从对称随机游走（即“公平赌局”）中的一个最基本问题开始：从一个初始状态 $i$ 出发，在到达破产状态 $0$ 之前先达到目标状态 $N$ 的概率是多少？这个问题引导我们使用一步分析法（first-step analysis），通过利用马尔可夫性质建立一个描述命中概率的差分方程。求解这个方程将为我们揭示对称情况下命中概率的简洁线性关系，这是理解更复杂随机过程模型的基础。[@problem_id:3056065]", "problem": "考虑一个在状态空间 $\\{0,1,\\dots,N\\}$ 上的简单对称随机游走 (SSRW) $\\{X_n\\}_{n \\ge 0}$，其中 $N \\in \\mathbb{N}$ 且 $N \\ge 2$。该过程从 $X_0=i$ 开始，其中 $i \\in \\{1,\\dots,N-1\\}$。在每一步，它以概率 $1/2$ 移动到 $X_{n+1}=X_n+1$，并以概率 $1/2$ 移动到 $X_{n+1}=X_n-1$，且每一步都与过去无关。边界状态 $0$ 和 $N$ 是吸收态。定义到达时间 $T_0=\\inf\\{n \\ge 0: X_n=0\\}$ 和 $T_N=\\inf\\{n \\ge 0: X_n=N\\}$，以及到达概率\n$$\nh(i) = \\mathbb{P}_i\\left(T_N  T_0\\right),\n$$\n其中 $\\mathbb{P}_i$ 表示在 $X_0=i$ 条件下的概率。\n\n仅使用马尔可夫性质和对第一步进行条件化的方法，按以下步骤进行：\n1. 推导 $h(i)$ 对内部状态 $i \\in \\{1,\\dots,N-1\\}$ 满足的线性差分方程，以及在 $i=0$ 和 $i=N$ 处的边界条件。\n2. 求解所得的边值问题，以获得 $h(i)$ 关于 $i$ 和 $N$ 的显式表达式。\n3. 使用适用于有限图上调和函数的离散最大值原理，证明在所有满足相同差分方程和边界条件的函数 $u:\\{0,1,\\dots,N\\}\\to\\mathbb{R}$ 中，解是唯一的。\n\n请以 $h(i)$ 关于 $i$ 和 $N$ 的单个闭式表达式的形式提供您的最终答案。", "solution": "该问题是有效的，因为它是随机过程理论中一个适定、有科学依据且客观的问题。这是一个关于有限区间上简单对称随机游走到达概率的经典问题。我们按照问题陈述中指定的三个步骤进行求解。\n\n待求的量是概率 $h(i) = \\mathbb{P}_i(T_N  T_0)$，即从状态 $i$ 开始的随机游走在到达状态 $0$ 之前先到达状态 $N$ 的概率。在这里，状态空间是 $\\{0, 1, \\dots, N\\}$，$0$ 和 $N$ 是吸收边界，起始状态 $i$ 在内部，即 $i \\in \\{1, \\dots, N-1\\}$。\n\n1. 线性差分方程和边界条件的推导。\n\n我们利用全概率定律和马尔可夫性质，通过对随机游走的第一步进行条件化来推导 $h(i)$ 的方程。从状态 $i \\in \\{1, \\dots, N-1\\}$ 开始，过程以概率 $1/2$ 移动到状态 $i+1$，或以概率 $1/2$ 移动到状态 $i-1$。令 $X_n$ 表示在时间 $n$ 的位置。\n$$h(i) = \\mathbb{P}(T_N  T_0 | X_0=i)$$\n对 $X_1$ 进行条件化：\n$$h(i) = \\mathbb{P}(T_N  T_0 | X_1=i+1)\\mathbb{P}(X_1=i+1|X_0=i) + \\mathbb{P}(T_N  T_0 | X_1=i-1)\\mathbb{P}(X_1=i-1|X_0=i)$$\n根据马尔可夫性质，从 $X_1=j$ 开始的过程在到达 $0$ 之前先到达 $N$ 的概率，与过程从 $X_0=j$ 开始的概率相同。因此，$\\mathbb{P}(T_N  T_0 | X_1=j) = h(j)$。转移概率为 $1/2$。将这些代入方程可得：\n$$h(i) = h(i+1) \\cdot \\frac{1}{2} + h(i-1) \\cdot \\frac{1}{2}$$\n此方程对所有内部状态 $i \\in \\{1, \\dots, N-1\\}$ 均成立。整理后，我们得到二阶线性齐次差分方程：\n$$h(i+1) - 2h(i) + h(i-1) = 0$$\n接下来，我们建立 $h(i)$ 在 $i=0$ 和 $i=N$ 处的边界条件。\n如果游走从 $i=0$ 开始，则 $X_0=0$。由于 $0$ 是吸收态，过程将永远停留在 $0$。到达 $0$ 的时间是 $T_0 = \\inf\\{n \\ge 0: X_n=0\\} = 0$。因为 $N \\ge 2$，所以 $N \\ne 0$，过程在时间 $0$ 时不在 $N$ 处，这意味着 $T_N > 0$。因此，事件 $T_N  T_0$ 是不可能的。其概率为零：\n$$h(0) = 0$$\n如果游走从 $i=N$ 开始，则 $X_0=N$。由于 $N$ 是吸收态，过程将停留在 $N$。到达 $N$ 的时间是 $T_N=0$。由于 $i=N \\ne 0$，到达 $0$ 的时间必然是 $T_0 > 0$。事件 $T_N  T_0$ 是必然的。其概率为一：\n$$h(N) = 1$$\n因此，我们得到了一个边值问题，它由针对 $i \\in \\{1, \\dots, N-1\\}$ 的差分方程和两个边界条件组成。\n\n2. 求解边值问题。\n\n差分方程 $h(i+1) - 2h(i) + h(i-1) = 0$ 可以改写为 $h(i+1) - h(i) = h(i) - h(i-1)$。这表明 $h(i)$ 的连续值之差是一个常数。这是等差数列的定义性质。因此，$h(i)$ 的通解必定是 $i$ 的一个线性函数：\n$$h(i) = Ai + B$$\n其中 $A$ 和 $B$ 是待由边界条件确定的常数。\n使用 $i=0$ 处的条件：\n$$h(0) = A \\cdot 0 + B = 0 \\implies B=0$$\n使用 $i=N$ 处的条件：\n$$h(N) = A \\cdot N + B = 1$$\n将 $B=0$ 代入第二个方程得到：\n$$A \\cdot N = 1 \\implies A = \\frac{1}{N}$$\n因此，$h(i)$ 的显式表达式为：\n$$h(i) = \\frac{i}{N}$$\n\n3. 唯一性的证明。\n\n为证明 $h(i) = i/N$ 是该边值问题的唯一解，我们采用离散最大值原理进行论证。方程 $h(i) = \\frac{1}{2}h(i+1) + \\frac{1}{2}h(i-1)$ 意味着 $h$ 在内部点集 $\\{1, \\dots, N-1\\}$ 上是一个离散调和函数。\n令 $u(i)$ 为在 $\\{0, 1, \\dots, N\\}$ 上满足相同边值问题的任意函数：\n$$u(i) = \\frac{1}{2}u(i+1) + \\frac{1}{2}u(i-1) \\quad \\text{for } i \\in \\{1, \\dots, N-1\\}$$\n$$u(0) = 0, \\quad u(N) = 1$$\n定义差函数 $v(i) = h(i) - u(i) = \\frac{i}{N} - u(i)$。我们将证明对所有 $i$，$v(i) = 0$。\n函数 $v(i)$ 在内部点上也是调和的，因为它是两个调和函数的线性组合：\n$$v(i) = h(i) - u(i) = \\frac{1}{2}(h(i+1)+h(i-1)) - \\frac{1}{2}(u(i+1)+u(i-1)) = \\frac{1}{2}(v(i+1)+v(i-1))$$\n$v(i)$ 的边界值为：\n$$v(0) = h(0) - u(0) = 0 - 0 = 0$$\n$$v(N) = h(N) - u(N) = 1 - 1 = 0$$\n根据有限定义域上调和函数的离散最大值原理，$v(i)$ 的最大值必须在定义域的边界，即集合 $\\{0, N\\}$ 上达到。令 $M = \\max_{i \\in \\{0, \\dots, N\\}} v(i)$。那么：\n$$M = \\max\\{v(0), v(N)\\} = \\max\\{0, 0\\} = 0$$\n这意味着对所有 $i \\in \\{0, \\dots, N\\}$，$v(i) \\le 0$。\n类似地，离散最小值原理指出 $v(i)$ 的最小值也必须在边界上达到。令 $m = \\min_{i \\in \\{0, \\dots, N\\}} v(i)$。那么：\n$$m = \\min\\{v(0), v(N)\\} = \\min\\{0, 0\\} = 0$$\n这意味着对所有 $i \\in \\{0, \\dots, N\\}$，$v(i) \\ge 0$。\n既然对所有 $i$ 都有 $v(i) \\le 0$ 和 $v(i) \\ge 0$，那么必然对所有 $i$ 都有 $v(i)=0$。因此，$h(i) - u(i) = 0$，这意味着对所有 $i \\in \\{0, \\dots, N\\}$，$u(i)=h(i)$。这证明了解 $h(i) = i/N$ 是唯一的。", "answer": "$$\\boxed{\\frac{i}{N}}$$", "id": "3056065"}, {"introduction": "在知道了获胜的概率后，一个自然而然的问题是：这场“赌局”预期会持续多久？本练习将探讨如何计算随机游走首次到达任一边界（$0$ 或 $N$）的期望时间 $\\mathbb{E}_{i}[\\tau]$。我们再次运用一步分析法，但这次它将导出一个非齐次差分方程，其求解过程与之前的齐次情况有所不同，你将发现其解是一个与初始位置相关的优美二次函数。[@problem_id:3056089]", "problem": "考虑一个在有限状态空间 $\\{0,1,\\dots,N\\}$ 上的简单对称随机游走，其在 $0$ 和 $N$ 处有吸收边界。令 $\\{X_{n}\\}_{n\\geq 0}$ 表示赌徒在第 $n$ 步时的资本，初始资本为 $X_{0}=i$，其中 $i\\in\\{1,2,\\dots,N-1\\}$。在每一步，赌徒的资本以相等的概率 $1/2$ 增加 $+1$ 或减少 $-1$，且每一步都与过去独立。定义停时 $\\tau=\\inf\\{n\\geq 0: X_{n}\\in\\{0,N\\}\\}$，即首次到达吸收集 $\\{0,N\\}$ 的时间。\n\n仅使用离散时间马尔可夫链的基本原理和第一步分析法，推导函数 $u(i)=\\mathbb{E}_{i}[\\tau]$（其中 $i\\in\\{0,1,\\dots,N\\}$）所满足的边值问题，并求解以获得 $u(i)$ 关于 $i$ 和 $N$ 的闭式表达式。将你的最终答案表示为单个无单位的解析表达式。无需四舍五入。", "solution": "所述问题是有效的。这是一个来自随机过程领域，特别是关于离散时间马尔可夫链的适定的、有科学依据的问题。所有必要信息均已提供，不存在矛盾或歧义。我们可以开始求解。\n\n令 $u(i) = \\mathbb{E}_{i}[\\tau]$ 为从状态 $i \\in \\{0, 1, \\dots, N\\}$ 出发，到达吸收态的期望时间。过程从 $X_0 = i$ 开始。停时为 $\\tau = \\inf\\{n \\geq 0: X_n \\in \\{0, N\\}\\}$。\n\n首先，我们建立函数 $u(i)$ 的边界条件。\n如果过程从 $i=0$ 开始，它已经处于一个吸收态。吸收时间为 $\\tau=0$。因此，期望时间为 $u(0) = \\mathbb{E}_{0}[\\tau] = 0$。\n类似地，如果过程从 $i=N$ 开始，它也处于一个吸收态，所以吸收时间为 $\\tau=0$。期望时间为 $u(N) = \\mathbb{E}_{N}[\\tau] = 0$。\n\n接下来，对于任意内部状态 $i \\in \\{1, 2, \\dots, N-1\\}$，我们应用第一步分析法，也称为基于第一步的条件分析。期望时间 $u(i)$ 可以表示为一步的时间加上从该步之后达到的状态开始的未来期望时间。\n经过一步（耗时 $1$ 个单位），过程从状态 $i$ 以概率 $p=1/2$ 移动到状态 $i+1$，或以概率 $q=1/2$ 移动到状态 $i-1$。\n根据全期望定律，我们可以写出：\n$$u(i) = 1 + \\mathbb{E}[\\text{time from next state } | X_0=i]$$\n$$u(i) = 1 + \\frac{1}{2} u(i+1) + \\frac{1}{2} u(i-1)$$\n此方程对所有 $i \\in \\{1, 2, \\dots, N-1\\}$ 成立。\n\n我们现在已经构建了一个边值问题，它由一个二阶线性非齐次差分方程及其相关的边界条件组成：\n$$u(i+1) + u(i-1) - 2u(i) = -2, \\quad \\text{for } i \\in \\{1, 2, \\dots, N-1\\}$$\n$$u(0) = 0$$\n$$u(N) = 0$$\n通解 $u(i)$ 是齐次方程的解 $u_h(i)$ 和一个特解 $u_p(i)$ 的和。\n\n齐次方程为：\n$$u_h(i+1) - 2u_h(i) + u_h(i-1) = 0$$\n我们寻求形如 $u_h(i) = r^i$ 的解。将其代入方程得到特征方程：\n$$r^{i+1} - 2r^i + r^{i-1} = 0$$\n假设 $r \\neq 0$，我们可以两边同除以 $r^{i-1}$ 得到：\n$$r^2 - 2r + 1 = 0$$\n$$(r-1)^2 = 0$$\n该方程有一个重根 $r_1 = r_2 = 1$。对于重根，两个线性无关的解是 $r^i = 1^i = 1$ 和 $i \\cdot r^i = i \\cdot 1^i = i$。因此，齐次方程的通解是这两个解的线性组合：\n$$u_h(i) = A \\cdot 1 + B \\cdot i = A + Bi$$\n其中 $A$ 和 $B$ 是常数。\n\n接下来，我们求非齐次方程 $u(i+1) - 2u(i) + u(i-1) = -2$ 的一个特解 $u_p(i)$。由于非齐次项是常数，我们通常会猜测一个关于 $i$ 的多项式。因为常数项和线性项（$A$ 和 $Bi$）是齐次方程的解，我们必须尝试一个更高次的多项式。我们假设一个二次形式 $u_p(i) = Ci^2$。\n将其代入非齐次方程：\n$$C(i+1)^2 - 2C(i)^2 + C(i-1)^2 = -2$$\n$$C(i^2 + 2i + 1) - 2Ci^2 + C(i^2 - 2i + 1) = -2$$\n$$C(i^2 + 2i + 1 - 2i^2 + i^2 - 2i + 1) = -2$$\n合并同类项：\n$$C[(i^2 - 2i^2 + i^2) + (2i - 2i) + (1 + 1)] = -2$$\n$$C[0 + 0 + 2] = -2$$\n$$2C = -2 \\implies C = -1$$\n因此，一个特解是 $u_p(i) = -i^2$。\n\n通解是齐次解与特解之和：\n$$u(i) = u_h(i) + u_p(i) = A + Bi - i^2$$\n\n最后，我们利用边界条件来确定常数 $A$ 和 $B$。\n使用 $u(0) = 0$：\n$$u(0) = A + B(0) - (0)^2 = 0 \\implies A = 0$$\n解简化为 $u(i) = Bi - i^2$。\n现在，使用 $u(N) = 0$：\n$$u(N) = BN - N^2 = 0$$\n假设 $N \\neq 0$（这是非平凡状态空间的要求），我们有：\n$$BN = N^2 \\implies B = N$$\n\n将 $A=0$ 和 $B=N$ 的值代入通解，得到期望到达时间的唯一解：\n$$u(i) = Ni - i^2$$\n这可以因式分解为：\n$$u(i) = i(N-i)$$\n该表达式给出了从状态 $i$ 出发，到达状态 $0$ 或状态 $N$ 所需的期望步数。", "answer": "$$\n\\boxed{i(N-i)}\n$$", "id": "3056089"}, {"introduction": "现实世界中的过程很少是完全“公平”的。如果随机游走存在偏向性（即每一步向上或向下的概率 $p$ 不等于 $1/2$），情况会发生怎样的变化？本练习将此前的分析推广到有偏随机游走的情形，要求你推导并求解期望吸收时间的方程。你将发现，概率的微小偏离会从根本上改变解的数学形式，从多项式解变为指数形式，从而让你深刻理解偏见对系统长期行为的巨大影响。[@problem_id:3056064]", "problem": "考虑一个在有限状态空间 $\\{0,1,2,\\dots,N\\}$ 上的离散时间有偏简单随机游走，其在 $0$ 和 $N$ 处有吸收壁。在每个时间步，游走从任意内部状态 $i \\in \\{1,2,\\dots,N-1\\}$ 以概率 $p \\in (0,1)$ 移动到 $i+1$，以概率 $q = 1-p$ 移动到 $i-1$。令 $T$ 表示首次到达集合 $\\{0,N\\}$ 的时间，对于每个内部状态 $i$，定义期望吸收时间 $u(i) = \\mathbb{E}_{i}[T]$，其中 $\\mathbb{E}_{i}$ 表示游走从 $i$ 开始的期望。\n\n仅使用期望的定义、全期望定律以及随机游走的马尔可夫性质，推导 $u(i)$ 满足的线性递推关系和边界条件。然后，对于 $p \\neq \\frac{1}{2}$ 的情况，显式地解此递推关系，以得到 $u(i)$ 关于 $i$、$N$ 和 $p$ 的闭式表达式。\n\n请提供 $u(i)$ 的单一闭式解析表达式作为最终答案，无需数值近似，也无需单位。", "solution": "所述问题是随机过程理论中一个定义明确的标准问题。它自成体系，在概率论中有坚实的科学基础，并且在数学上是一致的。因此，该问题是有效的，并且可以推导出完整的解。\n\n该问题要求两部分：首先，推导期望吸收时间 $u(i)$ 的线性递推关系；其次，对于有偏随机游走（$p \\neq \\frac{1}{2}$）的情况，显式地解这个递推关系。\n\n**第一部分：递推关系和边界条件的推导**\n\n令离散时间随机游走由随机变量序列 $\\{X_n\\}_{n \\ge 0}$ 表示，其中 $X_n$ 是在时间 $n$ 的位置。状态空间为 $S = \\{0, 1, 2, \\dots, N\\}$。状态 $0$ 和 $N$ 是吸收壁。\n\n对于任意内部状态 $i \\in \\{1, 2, \\dots, N-1\\}$，转移概率为：\n$P(X_{n+1} = i+1 | X_n = i) = p$\n$P(X_{n+1} = i-1 | X_n = i) = q = 1-p$\n\n吸收时间 $T$ 是游走首次到达任一边界的时刻：$T = \\min\\{n \\ge 0 : X_n \\in \\{0, N\\}\\}$。我们需要求解 $u(i) = \\mathbb{E}_i[T]$，即给定起始状态为 $X_0 = i$ 时 $T$ 的期望值。\n\n我们可以通过对随机游走的第一步进行条件化，利用全期望定律来建立 $u(i)$ 的递推关系。令 $X_0 = i$，其中 $i \\in \\{1, 2, \\dots, N-1\\}$。经过一个时间步后，游走将处于状态 $X_1$，其值为 $i+1$ 或 $i-1$。\n\n总吸收时间 $T$ 可以写成 $1$ 加上从新状态 $X_1$ 开始的剩余时间。\n根据全期望定律，对第一步的结果 $X_1$ 进行条件化：\n$$ u(i) = \\mathbb{E}_i[T] = \\sum_{j \\in S} \\mathbb{E}_i[T | X_1 = j] P(X_1 = j | X_0 = i) $$\n给定 $X_0 = i$， $X_1$ 唯一可能的值是 $i+1$（概率为 $p$）和 $i-1$（概率为 $q$）。所以上式简化为：\n$$ u(i) = \\mathbb{E}_i[T | X_1 = i+1] \\cdot p + \\mathbb{E}_i[T | X_1 = i-1] \\cdot q $$\n给定第一步之后的状态，吸收时间是 $1$ 加上从那个新状态开始的期望时间。关键在于，根据随机游走的马尔可夫性质，过程的未来演化只依赖于当前状态，而与到达该状态的路径无关。因此：\n$\\mathbb{E}_i[T | X_1 = i+1] = 1 + \\mathbb{E}_{i+1}[T] = 1 + u(i+1)$\n$\\mathbb{E}_i[T | X_1 = i-1] = 1 + \\mathbb{E}_{i-1}[T] = 1 + u(i-1)$\n\n将这些代入 $u(i)$ 的方程中：\n$$ u(i) = (1 + u(i+1)) \\cdot p + (1 + u(i-1)) \\cdot q $$\n$$ u(i) = p + p \\cdot u(i+1) + q + q \\cdot u(i-1) $$\n由于 $p+q=1$，我们得到线性递推关系：\n$$ u(i) = 1 + p \\cdot u(i+1) + q \\cdot u(i-1) \\quad \\text{for } i \\in \\{1, 2, \\dots, N-1\\} $$\n\n边界条件由吸收的定义确定。如果游走从吸收壁开始，那么被吸收的时间为 $0$。\n如果 $X_0 = 0$，则 $T=0$，所以 $u(0) = \\mathbb{E}_0[T] = 0$。\n如果 $X_0 = N$，则 $T=0$，所以 $u(N) = \\mathbb{E}_N[T] = 0$。\n\n因此，期望吸收时间 $u(i)$ 满足二阶线性非齐次差分方程\n$$ p \\cdot u(i+1) - u(i) + q \\cdot u(i-1) = -1 $$\n以及边界条件 $u(0) = 0$ 和 $u(N) = 0$。\n\n**第二部分：当 $p \\neq \\frac{1}{2}$ 时递推关系的解**\n\n解 $u(i)$ 是齐次方程的通解 $u_h(i)$ 和非齐次方程的一个特解 $u_p(i)$ 之和。\n\n1.  **齐次解：**\n    齐次方程为 $p \\cdot u_h(i+1) - u_h(i) + q \\cdot u_h(i-1) = 0$。我们假设解的形式为 $u_h(i) = r^i$。将其代入方程得到特征方程：\n    $$ p \\cdot r^{i+1} - r^i + q \\cdot r^{i-1} = 0 $$\n    两边同除以 $r^{i-1}$（对于 $r \\neq 0$），我们得到：\n    $$ p r^2 - r + q = 0 $$\n    这是一个关于 $r$ 的二次方程。我们可以将其因式分解为 $(pr-q)(r-1)=0$。\n    根是 $r_1 = 1$ 和 $r_2 = \\frac{q}{p}$。\n    因为问题说明 $p \\neq \\frac{1}{2}$，所以 $p \\neq q$，因此两个根是不同的（$r_1 \\neq r_2$）。\n    齐次方程的通解是对应于这些根的解的线性组合：\n    $$ u_h(i) = A \\cdot (r_1)^i + B \\cdot (r_2)^i = A + B \\left(\\frac{q}{p}\\right)^i $$\n    其中 $A$ 和 $B$ 是待定常数。\n\n2.  **特解：**\n    非齐次方程为 $p \\cdot u(i+1) - u(i) + q \\cdot u(i-1) = -1$。\n    由于非齐次项是一个常数，人们可能会猜测一个常数特解。然而，由于 $r_1=1$ 是特征方程的一个根，常数解是齐次解的一部分。因此，我们必须尝试形式为 $u_p(i) = C \\cdot i$ 的特解。\n    将其代入非齐次方程：\n    $$ p C(i+1) - Ci + q C(i-1) = -1 $$\n    $$ C [p(i+1) - i + q(i-1)] = -1 $$\n    $$ C [pi + p - i + qi - q] = -1 $$\n    $$ C [(p+q-1)i + (p-q)] = -1 $$\n    由于 $p+q = 1$，乘以 $i$ 的项为零。剩下：\n    $$ C(p-q) = -1 $$\n    因此，$C = \\frac{-1}{p-q} = \\frac{1}{q-p}$。\n    一个特解是 $u_p(i) = \\frac{i}{q-p}$。\n\n3.  **通解与边界条件：**\n    通解是 $u(i) = u_h(i) + u_p(i)$：\n    $$ u(i) = A + B \\left(\\frac{q}{p}\\right)^i + \\frac{i}{q-p} $$\n    现在我们应用边界条件 $u(0)=0$ 和 $u(N)=0$ 来求解 $A$ 和 $B$。\n    对于 $i=0$：\n    $$ u(0) = A + B \\left(\\frac{q}{p}\\right)^0 + \\frac{0}{q-p} = A + B = 0 \\implies A = -B $$\n    对于 $i=N$：\n    $$ u(N) = A + B \\left(\\frac{q}{p}\\right)^N + \\frac{N}{q-p} = 0 $$\n    将 $A = -B$ 代入第二个方程：\n    $$ -B + B \\left(\\frac{q}{p}\\right)^N + \\frac{N}{q-p} = 0 $$\n    $$ B \\left[ \\left(\\frac{q}{p}\\right)^N - 1 \\right] = -\\frac{N}{q-p} $$\n    $$ B = \\frac{-N}{(q-p)\\left[\\left(\\frac{q}{p}\\right)^N - 1\\right]} = \\frac{N}{(q-p)\\left[1 - \\left(\\frac{q}{p}\\right)^N\\right]} $$\n    并且 $A = -B = -\\frac{N}{(q-p)\\left[1 - \\left(\\frac{q}{p}\\right)^N\\right]}$。\n\n4.  **最终表达式：**\n    将 $A$ 和 $B$ 的表达式代回 $u(i)$ 的通解中：\n    $$ u(i) = -\\frac{N}{(q-p)\\left[1 - \\left(\\frac{q}{p}\\right)^N\\right]} + \\frac{N}{(q-p)\\left[1 - \\left(\\frac{q}{p}\\right)^N\\right]} \\left(\\frac{q}{p}\\right)^i + \\frac{i}{q-p} $$\n    我们可以提出因子 $\\frac{1}{q-p}$：\n    $$ u(i) = \\frac{1}{q-p} \\left[ i + \\frac{N\\left(\\frac{q}{p}\\right)^i - N}{1 - \\left(\\frac{q}{p}\\right)^N} \\right] $$\n    $$ u(i) = \\frac{1}{q-p} \\left[ i - \\frac{N\\left(1 - \\left(\\frac{q}{p}\\right)^i\\right)}{1 - \\left(\\frac{q}{p}\\right)^N} \\right] $$\n    这就是当 $p \\neq \\frac{1}{2}$ 时期望吸收时间 $u(i)$ 的闭式表达式。注意 $q-p = (1-p)-p = 1-2p$。", "answer": "$$ \\boxed{ \\frac{1}{q-p} \\left(i - N \\frac{1 - \\left(\\frac{q}{p}\\right)^i}{1 - \\left(\\frac{q}{p}\\right)^N}\\right) } $$", "id": "3056064"}]}