{"hands_on_practices": [{"introduction": "要真正理解随机游走，我们必须能够描述其在不同时间点的位置。第一个练习 [@problem_id:1313996] 是计算联合概率的一项基本实践。它将引导您应用独立增量这一核心性质，这是分析随机游走轨迹并简化复杂概率问题的关键技能。", "problem": "设 $X_i$ (其中 $i \\ge 1$) 为一串独立同分布的随机变量，其每个结果的概率为 $P(X_i = 1) = p$ 和 $P(X_i = -1) = 1-p$。一个普遍的一维整数随机游走过程定义为 $S_n = \\sum_{i=1}^{n} X_i$ (其中 $n \\ge 1$)，且起始位置固定为 $S_0 = 0$。\n\n对于简单对称随机游走的特殊情况，其中 $p = 1/2$，考虑在时间 $n=2$ 和时间 $n=4$ 时游走的位置。计算在时间 $n=2$ 时游走位于位置 0，且在时间 $n=4$ 时位于位置 2 的联合概率，记为 $P(S_2 = 0, S_4 = 2)$。\n\n将你的答案表示为精确分数。", "solution": "我们利用简单对称随机游走增量的独立性。根据马尔可夫性质和独立增量，\n$$\nP(S_{2}=0,\\,S_{4}=2)=P(S_{2}=0)\\,P(S_{4}=2\\,|\\,S_{2}=0)=P(S_{2}=0)\\,P(S_{4}-S_{2}=2).\n$$\n首先，计算 $P(S_{2}=0)$：\n$$\nS_{2}=X_{1}+X_{2},\\quad P(S_{2}=0)=P((X_{1},X_{2})=(1,-1)) + P((X_{1},X_{2})=(-1,1)).\n$$\n由于 $P(X_{i}=1)=P(X_{i}=-1)=\\frac{1}{2}$ 且 $X_{i}$ 是独立的，\n$$\nP(S_{2}=0)=2\\left(\\frac{1}{2}\\right)^{2}=\\frac{1}{2}.\n$$\n接下来，计算 $P(S_{4}-S_{2}=2)$：\n$$\nS_{4}-S_{2}=X_{3}+X_{4},\\quad P(S_{4}-S_{2}=2)=P(X_{3}=1,\\,X_{4}=1)=\\left(\\frac{1}{2}\\right)^{2}=\\frac{1}{4}.\n$$\n因此，\n$$\nP(S_{2}=0,\\,S_{4}=2)=\\frac{1}{2}\\cdot\\frac{1}{4}=\\frac{1}{8}.\n$$", "answer": "$$\\boxed{\\frac{1}{8}}$$", "id": "1313996"}, {"introduction": "随机游走不仅与概率有关，它还具有深刻的组合结构。这个问题 [@problem_id:3079276] 邀请您通过计算一个条件概率来探索这种结构，即在给定终点的情况下，路径始终不为正的概率。为了解决它，您将使用优美的“反射原理”(reflection principle)，这是一种在概率论中应用广泛且功能强大的路径计数技巧，它将随机游走与著名的卡特兰数 (Catalan number) 联系起来。", "problem": "考虑一个定义在整数上的简单对称随机游走 $\\{S_{k}\\}_{k \\ge 0}$，其定义为 $S_{0}=0$ 且当 $k \\ge 1$ 时 $S_{k}=\\sum_{i=1}^{k}X_{i}$，其中增量 $\\{X_{i}\\}_{i \\ge 1}$ 是独立同分布的，满足 $\\mathbb{P}(X_{i}=1)=\\mathbb{P}(X_{i}=-1)=\\tfrac{1}{2}$。对于一个固定的正整数 $n$，定义事件 $A_{n}=\\{S_{2n}=0\\}$ 和 $B_{n}=\\{S_{k}\\le 0 \\text{ 对所有 } 1 \\le k \\le 2n\\}$。仅使用关于对称随机游走的基本定义、公认事实以及初等计数方法，确定条件概率 $\\mathbb{P}(B_{n}\\mid A_{n})$，并将答案表示为 $n$ 的闭式表达式。然后，用卡特兰数 $C_{n}$（定义为 $C_{n}=\\dfrac{1}{n+1}\\binom{2n}{n}$）来表示该概率。最终答案必须是关于 $n$ 的单一精确解析表达式，不带单位。", "solution": "问题是要求出条件概率 $\\mathbb{P}(B_{n}\\mid A_{n})$，其中 $A_{n}=\\{S_{2n}=0\\}$ 和 $B_{n}=\\{S_{k}\\le 0 \\text{ 对所有 } 1 \\le k \\le 2n\\}$，对于一个从 $S_0=0$ 开始的简单对称随机游走 $\\{S_k\\}$。\n\n条件概率的定义为：\n$$ \\mathbb{P}(B_{n}\\mid A_{n}) = \\frac{\\mathbb{P}(B_{n} \\cap A_{n})}{\\mathbb{P}(A_{n})} $$\n随机游走的路径是一个长度为 $2n$ 的序列，其中每一步为 $+1$ 或 $-1$。由于增量 $X_i$ 是独立的，且 $\\mathbb{P}(X_{i}=1)=\\mathbb{P}(X_{i}=-1)=\\frac{1}{2}$，因此每条长度为 $2n$ 的特定路径的概率为 $(\\frac{1}{2})^{2n}$。因此，一个事件的概率可以通过计算与该事件对应的路径数量，再乘以 $(\\frac{1}{2})^{2n}$ 来得到。令 $N(E)$ 表示与事件 $E$ 对应的路径数。那么，\n$$ \\mathbb{P}(E) = N(E) \\left(\\frac{1}{2}\\right)^{2n} $$\n条件概率可以表示为路径数量之比：\n$$ \\mathbb{P}(B_{n}\\mid A_{n}) = \\frac{N(B_{n} \\cap A_{n}) \\left(\\frac{1}{2}\\right)^{2n}}{N(A_{n}) \\left(\\frac{1}{2}\\right)^{2n}} = \\frac{N(B_{n} \\cap A_{n})}{N(A_{n})} $$\n我们假设 $n$ 是一个正整数，这保证了 $N(A_n)  0$。\n\n首先，我们计算 $N(A_n)$，即满足 $S_{2n}=0$ 的路径数量。一条从 $S_0=0$ 开始的长度为 $2n$ 的路径将在 $S_{2n}=0$ 结束，当且仅当它包含相同数量的 $+1$ 步和 $-1$ 步。令 $n_{+}$ 为 $+1$ 步的数量，$n_{-}$ 为 $-1$ 步的数量。我们必须有：\n$$ n_{+} + n_{-} = 2n \\quad \\text{且} \\quad n_{+} - n_{-} = 0 $$\n解这个方程组得到 $n_{+} = n_{-} = n$。将这 $n$ 次向上步和 $n$ 次向下步排列成一个长度为 $2n$ 的序列的总方式数由二项式系数给出：\n$$ N(A_{n}) = \\binom{2n}{n} $$\n\n接下来，我们计算 $N(B_{n} \\cap A_{n})$。这是指长度为 $2n$ 的路径中，从 $S_0=0$ 开始，到 $S_{2n}=0$ 结束，并且对所有 $k \\in \\{1, 2, \\dots, 2n\\}$ 都满足 $S_k \\le 0$ 的路径数量。这样的路径通常被称为非正路径或桥。因为 $S_0=0$ 和 $S_{2n}=0$，该条件意味着从 $(0,0)$ 到 $(2n,0)$ 的路径绝不能越过时间轴（即直线 $y=0$）。\n\n我们可以使用反射原理来计算这些路径的数量，这是随机游走的一种基础计数技巧。我们在 $A_n$ 的路径集合中计算“坏”路径的数量：即那些从 $(0,0)$ 到 $(2n,0)$ 但违反了条件 $S_k \\le 0$ 的路径。如果对于某个 $k$ 有 $S_k > 0$，那么一条路径就违反了这个条件。由于步长为 1，这等价于路径触及或穿过直线 $y=1$。\n\n令 $A=(0,0)$ 为起点，$B=(2n,0)$ 为终点。根据反射原理，从 $A$ 到 $B$ 且触及或穿过直线 $y=L$ 的路径数量，等于从 $A$ 到点 $B'$（$B$ 关于直线 $y=L$ 的反射点）的路径数量。在我们的情况中，$L=1$。反射后的终点是 $B'=(2n, 2L - 0) = (2n, 2)$。\n\n所以，“坏”路径的数量就是从 $(0,0)$ 到 $(2n,2)$ 的总路径数。对于一条从 $(0,0)$到 $(2n,2)$ 的路径，我们有：\n$$ n_{+} + n_{-} = 2n \\quad \\text{且} \\quad n_{+} - n_{-} = 2 $$\n解这个方程组得到 $2n_{+} = 2n+2$，所以 $n_{+} = n+1$，以及 $2n_{-} = 2n-2$，所以 $n_{-} = n-1$。这类路径的数量是：\n$$ N(\\text{坏路径}) = \\binom{2n}{n+1} $$\n从 $(0,0)$ 到 $(2n,0)$ 的总路径数是 $N(A_n) = \\binom{2n}{n}$。根据反射原理，违反 $S_k \\le 0$ 条件的从 $(0,0)$ 到 $(2n,0)$ 的路径数量等于从 $(0,0)$ 到 $(2n,2)$ 的路径总数，即 $\\binom{2n}{n+1}$。然而，满足 $S_k \\le 0$ for $k \\in [1, 2n]$ 且 $S_{2n}=0$ 的路径数量是一个经典结果，即第 $n$ 个卡特兰数 $C_n$ 的一半。更直接地，通过对称性，满足 $S_k \\le 0$ 的路径数等于满足 $S_k \\ge 0$ 的路径数。而后者（从 $(0,0)$ 到 $(2n,0)$ 且 $S_k \\ge 0$）的数量由著名的 Dyck path 计数给出，即 $C_n = \\frac{1}{n+1}\\binom{2n}{n}$。\n因此，$N(B_{n} \\cap A_{n}) = \\frac{1}{n+1} \\binom{2n}{n}$。\n\n现在我们可以计算条件概率：\n$$ \\mathbb{P}(B_{n}\\mid A_{n}) = \\frac{N(B_{n} \\cap A_{n})}{N(A_{n})} = \\frac{\\frac{1}{n+1}\\binom{2n}{n}}{\\binom{2n}{n}} $$\n因为 $n$ 是一个正整数，所以 $\\binom{2n}{n} \\ne 0$，因此我们可以从分子和分母中约去这一项。\n$$ \\mathbb{P}(B_{n}\\mid A_{n}) = \\frac{1}{n+1} $$\n这就是以 $n$ 为函数的概率的闭式表达式。\n\n问题还要求用卡特兰数 $C_n = \\frac{1}{n+1}\\binom{2n}{n}$ 来表示这个概率。使用我们推导出的路径计数：\n$$ \\mathbb{P}(B_{n}\\mid A_{n}) = \\frac{C_n}{\\binom{2n}{n}} $$\n将 $C_n$ 的定义代入此表达式，可简化为先前得到的结果 $\\frac{1}{n+1}$。最终答案应为以 $n$ 表示的简化表达式。\n（注：原解答中 $N(B_n \\cap A_n)$ 的推导步骤被简化了，其结果 $\\binom{2n}{n} - \\binom{2n}{n+1} = \\frac{1}{n+1}\\binom{2n}{n}$ 确实是正确的，但该公式通常用于计算非负路径。由于对称性，非正路径的数量是相同的。）", "answer": "$$\\boxed{\\frac{1}{n+1}}$$", "id": "3079276"}, {"introduction": "随机游走需要多长时间才能到达某个边界？这是一个基本问题，在金融学、物理学和博弈论中都有重要应用。这个高级练习 [@problem_id:3079267] 介绍了一种回答此类问题的最强大工具：鞅论 (martingale theory)。通过构造一个巧妙的鞅并应用可选停止定理 (Optional Stopping Theorem)，您可以优雅地推导出期望吸收时间，而无需诉诸复杂的组合计数。", "problem": "考虑一个在整数上的离散时间简单对称随机游走。设 $N \\in \\mathbb{N}$ 为一固定值，并设 $S_{0} = i$，其中 $i \\in \\{0, 1, \\dots, N\\}$。对于 $n \\geq 1$，定义 $S_{n} = S_{n-1} + X_{n}$，其中 $(X_{n})_{n \\geq 1}$ 是独立同分布的随机变量，满足 $\\mathbb{P}(X_{n} = 1) = \\mathbb{P}(X_{n} = -1) = \\tfrac{1}{2}$。定义到达时间\n$$\n\\tau_{0} = \\inf\\{n \\geq 0 : S_{n} = 0\\}, \\qquad \\tau_{N} = \\inf\\{n \\geq 0 : S_{n} = N\\},\n$$\n以及吸收时间 $\\tau = \\tau_{0} \\wedge \\tau_{N}$。仅使用鞅的基本定义和有界停时的可选停止定理（OST），推导期望吸收时间 $E_{i}[\\tau]$ 作为 $i$ 和 $N$ 的函数的闭式表达式。你的最终答案必须是单一的解析表达式。不要提供直接揭示最终表达式的中间公式；相反，应从第一性原理出发证明每一步。无需四舍五入。", "solution": "问题要求计算一个在整数上的简单对称随机游走的期望吸收时间，记为 $E_{i}[\\tau]$。该随机游走从 $S_{0} = i$ 开始，在 $0$ 和 $N$ 处有吸收壁。吸收时间为 $\\tau = \\inf\\{n \\geq 0 : S_{n} \\in \\{0, N\\}\\}$。解法将使用鞅论和可选停止定理（OST）推导得出。\n\n首先，我们将此过程形式化。该随机游走定义为 $S_{n} = S_{n-1} + X_{n}$（对于 $n \\geq 1$），其中 $S_{0}=i$。步长 $(X_{n})_{n \\geq 1}$ 是独立同分布的随机变量，满足 $\\mathbb{P}(X_{n} = 1) = \\mathbb{P}(X_{n} = -1) = 1/2$。设 $\\mathcal{F}_{n} = \\sigma(X_{1}, \\dots, X_{n})$ 为该过程的自然 filtration，其中 $\\mathcal{F}_{0} = \\{\\emptyset, \\Omega\\}$。在从 $S_0=i$ 开始的条件下，期望记为 $E_i[\\cdot]$。\n\n可选停止定理（OST）指出，对于一个鞅 $(M_{n})_{n \\geq 0}$ 和一个停时 $T$，在特定条件下，有 $E[M_{T}] = E[M_{0}]$。问题指定使用针对有界停时的可选停止定理。停时 $\\tau$ 并非确定性有界的。然而，对于有限区间上的一维随机游走，已知 $\\tau$ 几乎必然是有限的，且 $E_i[\\tau]  \\infty$。可选停止定理的严格应用涉及考虑有界停时 $\\tau_{k} = \\tau \\wedge k = \\min(\\tau, k)$，其中 $k \\in \\mathbb{N}$。将可选停止定理应用于 $\\tau_k$ 可得 $E[M_{\\tau_k}] = E[M_0]$。然后我们可以取 $k \\to \\infty$ 的极限，只要满足适当的收敛条件（如控制收敛定理或单调收敛定理），我们就可以推断出 $E[M_{\\tau}] = E[M_0]$。我们将基于这一理解继续进行。\n\n我们的推导需要两个不同的鞅。\n\n首先，我们确定在每个边界上的吸收概率。设 $p_{i} = \\mathbb{P}_{i}(S_{\\tau} = N)$ 为随机游走从 $i$ 开始，在 $N$ 处被吸收的概率。因此，$\\mathbb{P}_{i}(S_{\\tau} = 0) = 1 - p_{i}$。为了求 $p_{i}$，我们考虑过程 $(S_{n})_{n \\geq 0}$ 本身。我们验证它关于 filtration $(\\mathcal{F}_{n})_{n \\geq 0}$ 是一个鞅。对于任意 $n \\geq 1$：\n$$\nE[S_{n} | \\mathcal{F}_{n-1}] = E[S_{n-1} + X_{n} | \\mathcal{F}_{n-1}]\n$$\n由于 $S_{n-1}$ 是 $\\mathcal{F}_{n-1}$-可测的，且 $X_{n}$ 独立于 $\\mathcal{F}_{n-1}$：\n$$\nE[S_{n} | \\mathcal{F}_{n-1}] = S_{n-1} + E[X_{n}]\n$$\n单步的期望为 $E[X_{n}] = (1) \\cdot \\mathbb{P}(X_{n}=1) + (-1) \\cdot \\mathbb{P}(X_{n}=-1) = 1 \\cdot \\frac{1}{2} - 1 \\cdot \\frac{1}{2} = 0$。\n因此，$E[S_{n} | \\mathcal{F}_{n-1}] = S_{n-1}$，这证实了 $(S_{n})_{n \\geq 0}$ 是一个鞅。\n\n该鞅的增量是有界的，即 $|S_{n} - S_{n-1}| = |X_{n}| = 1$。停时 $\\tau$ 的期望是有限的。这些是可选停止定理适用于鞅 $S_n$ 和停时 $\\tau$ 的充分条件。应用可选停止定理：\n$$\nE_{i}[S_{\\tau}] = E_{i}[S_{0}] = i\n$$\n在吸收时间 $\\tau$ 时的位置的期望值由下式给出：\n$$\nE_{i}[S_{\\tau}] = N \\cdot \\mathbb{P}_{i}(S_{\\tau} = N) + 0 \\cdot \\mathbb{P}_{i}(S_{\\tau} = 0) = N \\cdot p_{i}\n$$\n将 $E_{i}[S_{\\tau}]$ 的两个表达式相等，我们得到 $N \\cdot p_{i} = i$，从而得出吸收概率：\n$$\np_{i} = \\frac{i}{N}\n$$\n\n其次，为了求期望时间 $E_{i}[\\tau]$，我们需要一个包含时间指数 $n$ 的鞅。我们考虑过程 $M_{n} = S_{n}^2 - n$。我们来验证它是否是一个鞅。对于任意 $n \\geq 1$：\n$$\nE[M_{n} | \\mathcal{F}_{n-1}] = E[S_{n}^2 - n | \\mathcal{F}_{n-1}] = E[S_{n}^2 | \\mathcal{F}_{n-1}] - n\n$$\n我们展开 $S_{n}^2 = (S_{n-1} + X_{n})^2 = S_{n-1}^2 + 2S_{n-1}X_{n} + X_{n}^2$。\n$$\nE[S_{n}^2 | \\mathcal{F}_{n-1}] = E[S_{n-1}^2 + 2S_{n-1}X_{n} + X_{n}^2 | \\mathcal{F}_{n-1}]\n$$\n利用条件期望的线性和 $S_{n-1}$ 是 $\\mathcal{F}_{n-1}$-可测的事实：\n$$\nE[S_{n}^2 | \\mathcal{F}_{n-1}] = S_{n-1}^2 + 2S_{n-1}E[X_{n} | \\mathcal{F}_{n-1}] + E[X_{n}^2 | \\mathcal{F}_{n-1}]\n$$\n和之前一样，$E[X_{n} | \\mathcal{F}_{n-1}] = E[X_{n}] = 0$。对于项 $E[X_{n}^2 | \\mathcal{F}_{n-1}]$，我们有 $E[X_{n}^2] = (1)^2 \\cdot \\frac{1}{2} + (-1)^2 \\cdot \\frac{1}{2} = 1$。\n将这些结果代回：\n$$\nE[S_{n}^2 | \\mathcal{F}_{n-1}] = S_{n-1}^2 + 2S_{n-1}(0) + 1 = S_{n-1}^2 + 1\n$$\n现在我们可以完成对 $E[M_{n} | \\mathcal{F}_{n-1}]$ 的计算：\n$$\nE[M_{n} | \\mathcal{F}_{n-1}] = (S_{n-1}^2 + 1) - n = S_{n-1}^2 - (n-1) = M_{n-1}\n$$\n这证明了 $(M_{n})_{n \\geq 0} = (S_{n}^2 - n)_{n \\geq 0}$ 确实是一个鞅。\n\n现在我们将可选停止定理应用于鞅 $M_{n}$ 和停时 $\\tau$。可选停止定理的条件是满足的，因为 $E_i[\\tau]  \\infty$ 并且在有限时间区间内，鞅的增量是有界的。\n$$\nE_{i}[M_{\\tau}] = E_{i}[M_{0}]\n$$\n初始值为 $M_{0} = S_{0}^2 - 0 = i^2$。\n在停时处的值为 $M_{\\tau} = S_{\\tau}^2 - \\tau$。其期望为：\n$$\nE_{i}[M_{\\tau}] = E_{i}[S_{\\tau}^2 - \\tau] = E_{i}[S_{\\tau}^2] - E_{i}[\\tau]\n$$\n将期望的两个表达式相等，可得：\n$$\nE_{i}[S_{\\tau}^2] - E_{i}[\\tau] = i^2\n$$\n我们可以重新整理这个等式来表示期望吸收时间：\n$$\nE_{i}[\\tau] = E_{i}[S_{\\tau}^2] - i^2\n$$\n为了完成解答，我们必须计算 $E_{i}[S_{\\tau}^2]$。在吸收时的位置 $S_{\\tau}$ 只能是 $0$ 或 $N$。\n$$\nE_{i}[S_{\\tau}^2] = (N^2) \\cdot \\mathbb{P}_{i}(S_{\\tau} = N) + (0^2) \\cdot \\mathbb{P}_{i}(S_{\\tau} = 0) = N^2 \\cdot p_{i}\n$$\n使用我们之前推导出的吸收概率结果 $p_{i} = i/N$：\n$$\nE_{i}[S_{\\tau}^2] = N^2 \\cdot \\left(\\frac{i}{N}\\right) = Ni\n$$\n最后，将此结果代回我们关于 $E_{i}[\\tau]$ 的表达式中：\n$$\nE_{i}[\\tau] = Ni - i^2\n$$\n这可以被因式分解，从而给出期望吸收时间作为起始位置 $i$ 和边界 $N$ 的函数的最终闭式表达式。\n$$\nE_{i}[\\tau] = i(N-i)\n$$\n这个结果对任何起始位置 $i \\in \\{0, 1, \\dots, N\\}$ 都有效。如果 $i=0$ 或 $i=N$，起始位置已经在一个吸收壁上，所以 $\\tau=0$，该公式也正确地分别得出 $0(N-0)=0$ 和 $N(N-N)=0$。", "answer": "$$\n\\boxed{i(N-i)}\n$$", "id": "3079267"}]}