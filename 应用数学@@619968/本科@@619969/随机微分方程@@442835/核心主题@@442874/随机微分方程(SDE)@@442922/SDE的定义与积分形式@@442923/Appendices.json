{"hands_on_practices": [{"introduction": "在我们着手求解随机微分方程（SDE）之前，我们必须首先精确地理解什么是“解”。这个练习旨在挑战你批判性地思考SDE的积分形式，以及一个候选过程必须满足的严格条件才能成为一个有效的解。通过这个过程，你将学会区分严谨的定义与那些不够严格或不正确的标准。[@problem_id:3048330]", "problem": "设 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\in[0,T]},\\mathbb{P})$ 是一个满足通常条件的滤过概率空间，其上定义了一个标准一维维纳过程 $W=(W_t)_{t\\in[0,T]}$。考虑如下 (Itô 意义下的) 随机微分方程\n$$\ndX_t = b(t,X_t)\\,dt + \\sigma(t,X_t)\\,dW_t,\\quad t\\in[0,T],\\qquad X_0=\\xi,\n$$\n其中 $b:[0,T]\\times\\mathbb{R}\\to\\mathbb{R}$ 和 $\\sigma:[0,T]\\times\\mathbb{R}\\to\\mathbb{R}$ 是Borel可测函数，且 $\\xi$ 是 $\\mathcal{F}_0$-可测的。给定一个取值于 $\\mathbb{R}$ 的候选过程 $X=(X_t)_{t\\in[0,T]}$。\n\n你的任务是仅使用积分形式，找出哪些验证方法能正确地证明 $X$ 是上述随机微分方程的解。请选择所有有效且充分的方法，这些方法需要基于 Itô 解的定义以及相关积分的适定性。\n\nA. 验证 $X$是 $(\\mathcal{F}_t)$-适应的且其样本轨道几乎必然连续，$b(\\cdot,X_{\\cdot})$ 在 $[0,T]$ 上几乎必然Lebesgue可积，并且 $\\sigma(\\cdot,X_{\\cdot})$ 是循序可测的且在 $[0,T]$ 上几乎必然平方可积，从而积分\n$$\n\\int_0^t b(s,X_s)\\,ds \\quad\\text{和}\\quad \\int_0^t \\sigma(s,X_s)\\,dW_s\n$$\n对所有 $t\\in[0,T]$ 都是良定义的。此外，存在一个零测集 $N\\in\\mathcal{F}$，$\\mathbb{P}(N)=0$，使得对于所有 $\\omega\\in N^{c}$ 和所有 $t\\in[0,T]$，\n$$\nX_t(\\omega) = X_0(\\omega) + \\int_0^t b(s,X_s(\\omega))\\,ds + \\int_0^t \\sigma(s,X_s(\\omega))\\,dW_s(\\omega).\n$$\n成立。\n\nB. 对每个固定的 $t\\in[0,T]$，验证存在一个零测集 $N_t$ (可能依赖于 $t$)，使得\n$$\nX_t = X_0 + \\int_0^t b(s,X_s)\\,ds + \\int_0^t \\sigma(s,X_s)\\,dW_s\n$$\n几乎必然成立 (即在 $N_t$ 之外成立)。不必保证对不同的时间 $t$ 例外集是相同的，也不必验证被积函数的可测性或可積性。\n\nC. 将随机积分 $\\int_0^t \\sigma(s,X_s)\\,dW_s$ 替换为逐轨道的 Riemann–Stieltjes 积分 $\\int_0^t \\sigma(s,X_s)\\,dW_s$，该积分定义为沿加细的确定性划分的 Riemann 和的极限，并对所有 $\\omega\\in\\Omega$ 逐轨道地检验该积分方程。\n\nD. 在可数稠密子集 $\\mathbb{Q}\\cap[0,T]$ 上按如下方式验证积分方程：证明存在一个零测集 $N\\in\\mathcal{F}$，$\\mathbb{P}(N)=0$，使得对于所有 $\\omega\\in N^{c}$ 和所有 $q\\in\\mathbb{Q}\\cap[0,T]$，\n$$\nX_q(\\omega) = X_0(\\omega) + \\int_0^q b(s,X_s(\\omega))\\,ds + \\int_0^q \\sigma(s,X_s(\\omega))\\,dW_s(\\omega),\n$$\n成立。此外，还需验证 $X$ 具有几乎必然连续的样本轨道，并且两个积分定义了关于 $t$ 的几乎必然连续的过程。由连续性可断定，对于 $\\omega\\in N^{c}$，该等式对所有 $t\\in[0,T]$ 都成立。\n\nE. 只需验证对每个 $t\\in[0,T]$，\n$$\n\\mathbb{E}[X_t] = \\mathbb{E}[X_0] + \\int_0^t \\mathbb{E}[b(s,X_s)]\\,ds,\n$$\n和\n$$\n\\operatorname{Var}(X_t) = \\int_0^t \\mathbb{E}[\\sigma(s,X_s)^2]\\,ds,\n$$\n成立即可，因为这些条件蕴含了积分方程几乎必然成立。", "solution": "该问题要求找到有效且充分的方法，以验证给定过程 $X = (X_t)_{t\\in[0,T]}$ 是否为 Itô 随机微分方程 (SDE)\n$$\ndX_t = b(t,X_t)\\,dt + \\sigma(t,X_t)\\,dW_t, \\quad t\\in[0,T], \\quad X_0=\\xi.\n$$\n的解。此分析的出发点是该 SDE 强解的正式定义，该定义以其积分形式给出。\n\n如果过程 $X = (X_t)_{t\\in[0,T]}$ 满足以下三个条件，则它是该 SDE 的一个强解：\n1.  $X$ 是 $(\\mathcal{F}_t)$-适应的，且其样本轨道几乎必然连续。\n2.  系数过程满足可积性条件：\n    $$\n    \\mathbb{P}\\left(\\int_0^T |b(s,X_s)|\\,ds  \\infty\\right) = 1\n    $$\n    和\n    $$\n    \\mathbb{P}\\left(\\int_0^T \\sigma(s,X_s)^2\\,ds  \\infty\\right) = 1.\n    $$\n    这些条件分别确保了 Lebesgue 积分和 Itô 积分是良定义的。\n3.  积分方程\n    $$\n    X_t = X_0 + \\int_0^t b(s,X_s)\\,ds + \\int_0^t \\sigma(s,X_s)\\,dW_s\n    $$\n    对所有 $t\\in[0,T]$ 几乎必然成立。这意味着存在一个单一的零测集 $N \\subset \\Omega$，使得对每个 $\\omega \\in N^c$，该等式对所有 $t \\in [0,T]$ 都成立。\n\n以此定义为基准，我们评估每个选项。\n\n**A. 验证 $X$ 是 $(\\mathcal{F}_t)$-适应的且其样本轨道几乎必然连续，$b(\\cdot,X_{\\cdot})$ 在 $[0,T]$ 上几乎必然 Lebesgue 可积，并且 $\\sigma(\\cdot,X_{\\cdot})$ 是循序可测的且在 $[0,T]$ 上几乎必然平方可积，从而积分是良定义的。此外，存在一个零测集 $N\\in\\mathcal{F}$，$\\mathbb{P}(N)=0$，使得对于所有 $\\omega\\in N^{c}$ 和所有 $t\\in[0,T]$，积分方程成立。**\n\n这个选项是对强解正式定义的精确重述。\n- 它正确地要求 $X$ 是适应的且具有几乎必然连续的轨道。\n- 它正确地要求系数 $b$ 和 $\\sigma$ 满足可积性条件以确保积分是良定义的。要求 $\\sigma(\\cdot, X_\\cdot)$ 是循序可测的是 Itô 积分良定义的一个标准充分条件。\n- 关键在于，它抓住了积分方程必须在一个单一零测集 $N$ 之外对所有 $t \\in [0,T]$ 同时成立这一强要求。这就是“作为过程几乎必然”成立的含义。\n\n此方法有效且充分。\n结论：**正确**。\n\n**B. 对每个固定的 $t\\in[0,T]$，验证存在一个零测集 $N_t$ (可能依赖于 $t$)，使得积分方程几乎必然成立 (即在 $N_t$ 之外成立)。不必保证对不同的时间 $t$ 例外集是相同的，也不必验证被积函数的可测性或可積性。**\n\n此方法存在两个根本性缺陷。\n1.  它未能验证积分的适定性。如果不检查 $b(\\cdot, X_\\cdot)$ 和 $\\sigma(\\cdot, X_\\cdot)$ 的可积性条件，表达式 $\\int_0^t b(s,X_s)\\,ds$ 和 $\\int_0^t \\sigma(s,X_s)\\,dW_s$ 可能没有定义。一个验证方法不能忽略其自身术语的先决条件。\n2.  对每个 $t$，等式在 $\\Omega \\setminus N_t$ 上成立的条件远弱于定义的要求。不可数多个零测集的并集 $\\cup_{t \\in [0,T]} N_t$ 通常不是一个零测集。因此，这个条件甚至不能保证存在任何一个样本轨道 $\\omega$ 使得等式 $X_t(\\omega) = \\dots$ 对所有 $t \\in [0,T]$ 都成立。这个较弱的性质有时被称为“广义”解，但它不是标准 Itô 意义下 SDE 解的含义。\n\n结论：**不正确**。\n\n**C. 将随机积分 $\\int_0^t \\sigma(s,X_s)\\,dW_s$ 替换为逐轨道的 Riemann–Stieltjes 积分 $\\int_0^t \\sigma(s,X_s)\\,dW_s$，该积分定义为沿加细的确定性划分的 Riemann 和的极限，并对所有 $\\omega\\in\\Omega$ 逐轨道地检验该积分方程。**\n\n这个方法从根本上误解了 Itô 积分的性质。Itô 积分是一种随机积分，而不是逐轨道的 Stieltjes 型积分。维纳过程 $W_t$ 的一个关键性质是其样本轨道在任何区间上几乎必然是无界变差的。对于无界变差的函数，逐轨道的 Riemann–Stieltjes 积分通常不是良定义的。随机积分理论 (Itô 微积分) 正是为了定义关于像维纳过程这样的过程的积分而专门发展的。试图使用 Riemann-Stieltjes 框架是一个范畴性错误。\n\n结论：**不正确**。\n\n**D. 在可数稠密子集 $\\mathbb{Q}\\cap[0,T]$ 上按如下方式验证积分方程：证明存在一个零测集 $N\\in\\mathcal{F}$，$\\mathbb{P}(N)=0$，使得对于所有 $\\omega\\in N^{c}$ 和所有 $q\\in\\mathbb{Q}\\cap[0,T]$，积分方程成立。此外，还需验证 $X$ 具有几乎必然连续的样本轨道，并且两个积分定义了关于 $t$ 的几乎必然连续的过程。由连续性可断定，对于 $\\omega\\in N^{c}$，该等式对所有 $t\\in[0,T]$ 都成立。**\n\n这描述了一种验证过程相等的有效且常用的技巧。其论证依赖于实分析中的一个标准结果：如果两个闭区间上的连续函数在一个稠密子集上相等，那么它们在整个区间上必定相同。\n该方法需要验证：\n1.  方程左侧 $L_t(\\omega) = X_t(\\omega)$ 和右侧 $R_t(\\omega) = X_0(\\omega) + \\int_0^t b(s,X_s(\\omega))\\,ds + \\int_0^t \\sigma(s,X_s(\\omega))\\,dW_s(\\omega)$ 对于几乎所有 $\\omega$ 都是 $t$ 的连续函数。$X_t$ 的连续性是直接假设的。$R_t$ 的连续性源于$L^1$函数的 Lebesgue 积分对其积分上限是连续的，以及 Itô 积分的一个基本性质是它是一个具有连续样本轨道的过程（这在被积函数几乎必然平方可积时成立，而这必须被验证以确保积分是良定义的）。\n2.  等式 $L_t(\\omega) = R_t(\\omega)$ 对于几乎所有 $\\omega$（即在一个概率为 1 的集合上）和所有 $t \\in \\mathbb{Q}\\cap[0,T]$ 成立。\n\n由于 $\\mathbb{Q}\\cap[0,T]$ 在 $[0,T]$ 中是稠密的，对于任何 $\\omega$，只要两个过程都是连续的且在这个稠密集上相等，那么它们对所有 $t \\in [0,T]$ 都必须相等。由于前提是几乎必然成立的，结论（对所有 $t$ 相等）也几乎必然成立。这就证明了存在一个单一的零测集，在其之外等式对所有 $t$ 都成立，这符合正式定义的要求。\n\n结论：**正确**。\n\n**E. 只需验证对每个 $t\\in[0,T]$，$\\mathbb{E}[X_t] = \\mathbb{E}[X_0] + \\int_0^t \\mathbb{E}[b(s,X_s)]\\,ds$ 和 $\\operatorname{Var}(X_t) = \\int_0^t \\mathbb{E}[\\sigma(s,X_s)^2]\\,ds$ 成立即可，因为这些条件蕴含了积分方程几乎必然成立。**\n\n这是不正确的。SDE 定义的是样本轨道之间的关系，这是一个比矩匹配强得多的条件。\n- 第一个关于均值的方程是 SDE 成立的一个*推论*（在允许交换期望和积分且假设 Itô 积分期望为零的条件下），但它不是充分条件。许多不同的随机过程可以有相同的均值函数。\n- 第二个关于方差的方程甚至通常是不正确的。对于一个一般的 Itô 过程 $X_t$，其方差的演变更为复杂。即使它是正确的，它也只涉及二阶矩。\n- 根本错误在于，矩的相等（即使是所有阶的矩）通常并不蕴含过程的几乎必然逐轨道相等。SDE 的解是一个逐轨道的陈述，而这个方法只检查了每个时刻 $t$ 的 $X_t$ 的边缘分布的性质。\n\n结论：**不正确**。", "answer": "$$\\boxed{AD}$$", "id": "3048330"}, {"introduction": "应用随机分析的一个基石是使用伊藤公式（Itô's formula）求解SDE的能力。这个练习将引导你通过求解一个基本的线性SDE——几何布朗运动（geometric Brownian motion），来掌握这一技能。你将学习如何通过一个巧妙的变换，利用伊藤引理（Itô's lemma）的威力来简化方程。[@problem_id:3048360]", "problem": "设 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t \\in [0,T]},\\mathbb{P})$ 为一个支撑标准一维布朗运动 $W$ 的带滤概率空间。设 $a:[0,T]\\to\\mathbb{R}$ 和 $b:[0,T]\\to\\mathbb{R}$ 为满足 $\\int_{0}^{T}\\big(|a(s)|+b(s)^{2}\\big)\\,ds  \\infty$ 的确定性Borel函数。考虑齐次线性随机微分方程 (SDE)\n$$\ndX_t \\;=\\; a(t)\\,X_t\\,dt \\;+\\; b(t)\\,X_t\\,dW_t,\\qquad X_0 = x_00,\\quad t\\in[0,T].\n$$\n从该 SDE 的积分形式出发，仅使用 Itô 积分和 Itô 公式的核心定义与性质，推导固定 $t\\in(0,T]$ 时 $X_t$ 的分布，证明 $X_t$ 是对数正态的，并用 $a$ 和 $b$ 显式计算 $\\mathbb{E}[X_t]$ 和 $\\operatorname{Var}(X_t)$。将你的最终答案表示为一个 $1\\times 2$ 的行向量，其第一个元素是 $\\mathbb{E}[X_t]$，第二个元素是 $\\operatorname{Var}(X_t)$。无需四舍五入。", "solution": "该问题陈述是随机微分方程领域一个适定的练习题。它提供了所有必要的信息：一个有效的 SDE、一个初始条件，以及对系数和基础布朗运动的标准假设。该问题具有科学依据、客观，且不包含矛盾或歧义。因此，该问题是有效的，我们可以着手求解。\n\n随机微分方程 (SDE) 由下式给出\n$$\ndX_t = a(t)X_t dt + b(t)X_t dW_t\n$$\n初始条件为 $X_0 = x_0  0$，其中 $t \\in [0, T]$。函数 $a(t)$ 和 $b(t)$ 是确定性的。此 SDE 的积分形式为\n$$\nX_t = X_0 + \\int_0^t a(s)X_s ds + \\int_0^t b(s)X_s dW_s.\n$$\n为求解此 SDE，我们通过变换 $Y_t = f(X_t) = \\ln(X_t)$ 引入一个新过程 $Y_t$。这个变换是良定义的，因为对于正的初始条件 $x_0  0$，此 SDE 的解 $X_t$ 几乎必然地对所有 $t \\ge 0$ 保持为正。我们对 $Y_t$ 应用 Itô 公式。对于一个二次可微函数 $f(x)$，关于过程 $X_t$ 的 Itô 引理表述为\n$$\nd f(X_t) = f'(X_t) dX_t + \\frac{1}{2} f''(X_t) (dX_t)^2.\n$$\n在我们的情况下，$f(x) = \\ln(x)$，所以我们有导数 $f'(x) = \\frac{1}{x}$ 和 $f''(x) = -\\frac{1}{x^2}$。二次变分项 $(dX_t)^2$ 使用 Itô 积分的运算法则 $(dt)^2=0$、$dt dW_t = 0$ 和 $(dW_t)^2=dt$ 计算得出：\n$$\n(dX_t)^2 = (a(t)X_t dt + b(t)X_t dW_t)^2 = b(t)^2 X_t^2 (dW_t)^2 = b(t)^2 X_t^2 dt.\n$$\n将这些代入 $Y_t = \\ln(X_t)$ 的 Itô 公式中：\n$$\ndY_t = \\frac{1}{X_t} dX_t + \\frac{1}{2} \\left( -\\frac{1}{X_t^2} \\right) (dX_t)^2\n$$\n$$\ndY_t = \\frac{1}{X_t} (a(t)X_t dt + b(t)X_t dW_t) - \\frac{1}{2X_t^2} (b(t)^2 X_t^2 dt)\n$$\n$$\ndY_t = (a(t) dt + b(t) dW_t) - \\frac{1}{2} b(t)^2 dt\n$$\n$$\ndY_t = \\left( a(t) - \\frac{1}{2} b(t)^2 \\right) dt + b(t) dW_t.\n$$\n这是一个关于 $Y_t$ 的带有加性噪声项的简单 SDE。我们可以通过从 $0$ 到 $t$ 直接积分来求解 $Y_t$：\n$$\nY_t - Y_0 = \\int_0^t \\left( a(s) - \\frac{1}{2} b(s)^2 \\right) ds + \\int_0^t b(s) dW_s.\n$$\n初始条件为 $Y_0 = \\ln(X_0) = \\ln(x_0)$。因此，\n$$\nY_t = \\ln(x_0) + \\int_0^t \\left( a(s) - \\frac{1}{2} b(s)^2 \\right) ds + \\int_0^t b(s) dW_s.\n$$\n现在我们可以确定 $Y_t$ 的分布。$Y_t$ 的表达式包含两部分：一个确定性部分和一个随机积分。\n对于固定的 $t$，前两项是确定性的：\n$$\n\\mu_Y(t) = \\ln(x_0) + \\int_0^t \\left( a(s) - \\frac{1}{2} b(s)^2 \\right) ds.\n$$\n第三项是一个被积函数为确定性函数 $b(s)$ 的 Itô 积分。Itô 积分的一个基本性质是，对于一个确定性的、平方可积的函数 $g(s)$，随机变量 $Z_t = \\int_0^t g(s) dW_s$ 服从均值为 $0$、方差为 $\\int_0^t g(s)^2 ds$ 的正态分布。在我们的情况下，$g(s) = b(s)$，所以随机积分 $\\int_0^t b(s) dW_s$ 是一个正态随机变量，其均值为 $\\mathbb{E}[\\int_0^t b(s) dW_s] = 0$，方差为 $\\operatorname{Var}(\\int_0^t b(s) dW_s) = \\int_0^t b(s)^2 ds$。\n\n因此，$Y_t$ 是一个常数与一个正态随机变量之和，这意味着 $Y_t$ 本身就是一个正态随机变量。其分布为\n$$\nY_t \\sim \\mathcal{N}\\left( \\ln(x_0) + \\int_0^t \\left( a(s) - \\frac{1}{2} b(s)^2 \\right) ds, \\int_0^t b(s)^2 ds \\right).\n$$\n由于 $X_t = \\exp(Y_t)$ 且 $Y_t$ 服从正态分布，根据定义，随机变量 $X_t$ 服从对数正态分布。这就证明了问题的第一部分。\n\n为了计算 $X_t$ 的期望和方差，我们使用对数正态分布的性质。如果 $Y \\sim \\mathcal{N}(\\mu, \\sigma^2)$，那么对于任意实数 $k$，$X = \\exp(Y)$ 的 $k$ 阶矩由下式给出\n$$\n\\mathbb{E}[X^k] = \\mathbb{E}[\\exp(kY)] = \\exp\\left( k\\mu + \\frac{1}{2}k^2\\sigma^2 \\right).\n$$\n对于我们的过程 $X_t = \\exp(Y_t)$，我们有：\n$$\n\\mu_t = \\mathbb{E}[Y_t] = \\ln(x_0) + \\int_0^t \\left( a(s) - \\frac{1}{2}b(s)^2 \\right) ds\n$$\n$$\n\\sigma_t^2 = \\operatorname{Var}(Y_t) = \\int_0^t b(s)^2 ds\n$$\n$X_t$ 的期望对应于一阶矩 ($k=1$)：\n$$\n\\mathbb{E}[X_t] = \\exp\\left( \\mu_t + \\frac{1}{2}\\sigma_t^2 \\right)\n$$\n$$\n\\mathbb{E}[X_t] = \\exp\\left( \\left[ \\ln(x_0) + \\int_0^t \\left( a(s) - \\frac{1}{2}b(s)^2 \\right) ds \\right] + \\frac{1}{2} \\int_0^t b(s)^2 ds \\right)\n$$\n$$\n\\mathbb{E}[X_t] = \\exp\\left( \\ln(x_0) + \\int_0^t a(s) ds - \\frac{1}{2}\\int_0^t b(s)^2 ds + \\frac{1}{2}\\int_0^t b(s)^2 ds \\right)\n$$\n$$\n\\mathbb{E}[X_t] = \\exp\\left( \\ln(x_0) + \\int_0^t a(s) ds \\right) = x_0 \\exp\\left( \\int_0^t a(s) ds \\right).\n$$\n为求方差，我们首先计算二阶矩 $\\mathbb{E}[X_t^2]$ (使用 $k=2$)：\n$$\n\\mathbb{E}[X_t^2] = \\exp\\left( 2\\mu_t + \\frac{1}{2}(2^2)\\sigma_t^2 \\right) = \\exp\\left( 2\\mu_t + 2\\sigma_t^2 \\right)\n$$\n$$\n\\mathbb{E}[X_t^2] = \\exp\\left( 2\\left[ \\ln(x_0) + \\int_0^t \\left( a(s) - \\frac{1}{2}b(s)^2 \\right) ds \\right] + 2 \\int_0^t b(s)^2 ds \\right)\n$$\n$$\n\\mathbb{E}[X_t^2] = \\exp\\left( 2\\ln(x_0) + 2\\int_0^t a(s) ds - \\int_0^t b(s)^2 ds + 2\\int_0^t b(s)^2 ds \\right)\n$$\n$$\n\\mathbb{E}[X_t^2] = \\exp\\left( 2\\ln(x_0) + 2\\int_0^t a(s) ds + \\int_0^t b(s)^2 ds \\right)\n$$\n$$\n\\mathbb{E}[X_t^2] = x_0^2 \\exp\\left( 2\\int_0^t a(s) ds + \\int_0^t b(s)^2 ds \\right).\n$$\n方差由 $\\operatorname{Var}(X_t) = \\mathbb{E}[X_t^2] - (\\mathbb{E}[X_t])^2$ 给出：\n$$\n\\operatorname{Var}(X_t) = x_0^2 \\exp\\left( 2\\int_0^t a(s) ds + \\int_0^t b(s)^2 ds \\right) - \\left( x_0 \\exp\\left( \\int_0^t a(s) ds \\right) \\right)^2\n$$\n$$\n\\operatorname{Var}(X_t) = x_0^2 \\exp\\left( 2\\int_0^t a(s) ds \\right) \\exp\\left( \\int_0^t b(s)^2 ds \\right) - x_0^2 \\exp\\left( 2\\int_0^t a(s) ds \\right)\n$$\n提取公因式 $x_0^2 \\exp\\left( 2\\int_0^t a(s) ds \\right)$，我们得到：\n$$\n\\operatorname{Var}(X_t) = x_0^2 \\exp\\left( 2\\int_0^t a(s) ds \\right) \\left[ \\exp\\left( \\int_0^t b(s)^2 ds \\right) - 1 \\right].\n$$\n所需的两个量是期望 $\\mathbb{E}[X_t]$ 和方差 $\\operatorname{Var}(X_t)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} x_0 \\exp\\left( \\int_0^t a(s) \\, ds \\right)  x_0^2 \\exp\\left( 2\\int_0^t a(s) \\, ds \\right) \\left[ \\exp\\left( \\int_0^t b(s)^2 \\, ds \\right) - 1 \\right] \\end{pmatrix}}\n$$", "id": "3048360"}, {"introduction": "随机积分可以用不同的方式定义，其中伊藤积分（Itô integral）和斯特拉托诺维奇积分（Stratonovich integral）是最著名的两种。虽然伊藤微积分在金融领域占主导地位，但遵循经典链式法则的斯特拉托诺维奇微积分在物理学和工程学中也很常见。这个练习将演示如何推导连接这两个世界的关键转换公式，这对于理解和应用来自不同科学领域的模型至关重要。[@problem_id:3048335]", "problem": "考虑一个由 $m$ 维标准布朗运动 (BM) $W_{t} \\in \\mathbb{R}^{m}$ 驱动的过程 $X_{t} \\in \\mathbb{R}^{n}$ 的 $n$ 维 Stratonovich 意义下的随机微分方程 (SDE)：\n$$\nX_{t} = X_{0} + \\int_{0}^{t} \\alpha\\!\\left(X_{s}\\right)\\,\\mathrm{d}s + \\int_{0}^{t} b\\!\\left(X_{s}\\right) \\circ \\mathrm{d}W_{s},\n$$\n其中 $\\alpha : \\mathbb{R}^{n} \\to \\mathbb{R}^{n}$ 连续可微，而 $b : \\mathbb{R}^{n} \\to \\mathbb{R}^{n \\times m}$ 的列向量为 $b^{(k)}(x) \\in \\mathbb{R}^{n}$，$k = 1,\\dots,m$，每个列向量都是二次连续可微的，并满足适当的增长和 Lipschitz 条件，以确保解的存在性和唯一性以及随机积分的良定义性。积分 $\\int_{0}^{t} b(X_{s}) \\circ \\mathrm{d}W_{s}$ 应通过中点 Riemann 和理解为 Stratonovich 意义下的积分，而 $\\int_{0}^{t} b(X_{s})\\,\\mathrm{d}W_{s}$ 则是通过左端点 Riemann 和定义的 Itô 积分。\n\n仅从半鞅被积函数的 Itô 积分和 Stratonovich 积分的定义以及布朗运动的二次变差性质出发，推导必须加到 Stratonovich 漂移项 $\\alpha(x)$ 上的漂移修正向量 $\\Delta(x)$，使得相应的 Itô 形式的 SDE，\n$$\nX_{t} = X_{0} + \\int_{0}^{t} \\big(\\alpha\\!\\left(X_{s}\\right) + \\Delta\\!\\left(X_{s}\\right)\\big)\\,\\mathrm{d}s + \\int_{0}^{t} b\\!\\left(X_{s}\\right)\\,\\mathrm{d}W_{s},\n$$\n具有相同的解过程 $\\{X_{t}\\}_{t \\ge 0}$。\n\n请将您关于 $\\Delta(x)$ 的最终答案表示为一个单一的闭式解析表达式，该表达式用扩散矩阵 $b(x)$ 及其列向量的雅可比矩阵来表示。令 $J_{b^{(k)}}(x) \\in \\mathbb{R}^{n \\times n}$ 表示向量场 $b^{(k)}(x)$ 的雅可比矩阵。您的最终答案必须是一个单一的表达式，而不是一个方程。不需要进行数值近似或四舍五入。", "solution": "目标是推导一个漂移修正向量 $\\Delta(x)$，它将一个给定的随机微分方程 (SDE) 的 Stratonovich 表示和 Itô 表示联系起来。给定 Stratonovich SDE：\n$$\n\\mathrm{d}X_{t} = \\alpha(X_{t})\\,\\mathrm{d}t + b(X_{t}) \\circ \\mathrm{d}W_{t}\n\\tag{1}\n$$\n及其等价的 Itô 形式：\n$$\n\\mathrm{d}X_{t} = \\left(\\alpha(X_{t}) + \\Delta(X_{t})\\right)\\,\\mathrm{d}t + b(X_{t})\\,\\mathrm{d}W_{t}\n\\tag{2}\n$$\n其中 $X_t \\in \\mathbb{R}^n$，$W_t \\in \\mathbb{R}^m$，$\\alpha: \\mathbb{R}^n \\to \\mathbb{R}^n$ 且 $b: \\mathbb{R}^n \\to \\mathbb{R}^{n \\times m}$。矩阵 $b(x)$ 的列向量用 $b^{(k)}(x)$ 表示，其中 $k=1, \\dots, m$。\n\nItô 积分和 Stratonovich 积分的根本区别在于它们作为 Riemann 和的极限的定义。Itô 积分使用时间区间的左端点来评估被积函数，而 Stratonovich 积分则使用中点。\n\n让我们将 Stratonovich 随机项表示为布朗运动 $W_t$ 各分量的和：\n$$\n\\int_{0}^{t} b(X_{s}) \\circ \\mathrm{d}W_{s} = \\sum_{k=1}^{m} \\int_{0}^{t} b^{(k)}(X_{s}) \\circ \\mathrm{d}W_{s}^{(k)}\n$$\n我们将分析单个项 $\\int_{0}^{t} b^{(k)}(X_{s}) \\circ \\mathrm{d}W_{s}^{(k)}$。让我们考虑区间 $[0, t]$ 的一个划分 $0 = t_0  t_1  \\dots  t_N = t$。Stratonovich 积分是以下和的极限：\n$$\nS_N^{(k)} = \\sum_{i=0}^{N-1} b^{(k)}\\left(\\frac{X_{t_{i+1}} + X_{t_i}}{2}\\right) (W_{t_{i+1}}^{(k)} - W_{t_i}^{(k)})\n$$\n我们可以将 $b^{(k)}$ 的求值点重写为 $X_{t_i} + \\frac{1}{2}(X_{t_{i+1}} - X_{t_i})$。令 $\\Delta X_{t_i} = X_{t_{i+1}} - X_{t_i}$ 且 $\\Delta W_{t_i}^{(k)} = W_{t_{i+1}}^{(k)} - W_{t_i}^{(k)}$。\n\n在 $b^{(k)}$ 是二次连续可微的假设下，我们可以对 $b^{(k)}(x)$ 在 $X_{t_i}$ 附近进行泰勒展开：\n$$\nb^{(k)}\\left(X_{t_i} + \\frac{1}{2}\\Delta X_{t_i}\\right) = b^{(k)}(X_{t_i}) + \\frac{1}{2} J_{b^{(k)}}(X_{t_i}) \\Delta X_{t_i} + O\\left(\\|\\Delta X_{t_i}\\|^2\\right)\n$$\n其中 $J_{b^{(k)}}(x)$ 是向量场 $b^{(k)}(x)$ 的 $n \\times n$ 雅可比矩阵，其第 $(p,q)$ 个元素是 $\\frac{\\partial b_{p}^{(k)}}{\\partial x_q}(x) = \\frac{\\partial b_{pk}}{\\partial x_q}(x)$。\n\n将此展开式代入和 $S_N^{(k)}$ 中：\n$$\nS_N^{(k)} = \\sum_{i=0}^{N-1} \\left( b^{(k)}(X_{t_i}) + \\frac{1}{2} J_{b^{(k)}}(X_{t_i}) \\Delta X_{t_i} \\right) \\Delta W_{t_i}^{(k)} + \\sum_{i=0}^{N-1} O\\left(\\|\\Delta X_{t_i}\\|^2\\right) \\Delta W_{t_i}^{(k)}\n$$\n括号中的第一项 $\\sum_{i=0}^{N-1} b^{(k)}(X_{t_i}) \\Delta W_{t_i}^{(k)}$ 对应于定义 Itô 积分 $\\int_{0}^{t} b^{(k)}(X_{s}) \\mathrm{d}W_{s}^{(k)}$ 的 Riemann 和。\n\n对于第二项，我们需要近似 $\\Delta X_{t_i}$。根据 SDE 的 Itô 形式（方程 2），在一个小区间 $\\Delta t_i = t_{i+1}-t_i$ 上增量 $\\Delta X_{t_i}$ 的最低阶近似由随机部分决定，因为 $\\mathrm{d}t$ 的阶数低于 $\\sqrt{\\mathrm{d}t}$：\n$$\n\\Delta X_{t_i} \\approx b(X_{t_i}) \\Delta W_{t_i} = \\sum_{l=1}^{m} b^{(l)}(X_{t_i}) \\Delta W_{t_i}^{(l)}\n$$\n我们将 $\\Delta X_{t_i}$ 的这个近似代入和的第二部分：\n$$\n\\frac{1}{2} \\sum_{i=0}^{N-1} J_{b^{(k)}}(X_{t_i}) \\left( \\sum_{l=1}^{m} b^{(l)}(X_{t_i}) \\Delta W_{t_i}^{(l)} \\right) \\Delta W_{t_i}^{(k)} = \\frac{1}{2} \\sum_{l=1}^{m} \\sum_{i=0}^{N-1} J_{b^{(k)}}(X_{t_i}) b^{(l)}(X_{t_i}) \\Delta W_{t_i}^{(l)} \\Delta W_{t_i}^{(k)}\n$$\n当划分变得更精细时（即 $\\max_i \\Delta t_i \\to 0$），我们使用独立标准布朗运动的二次协变差性质：\n$$\n\\sum_{i=0}^{N-1} \\Delta W_{t_i}^{(l)} \\Delta W_{t_i}^{(k)} \\longrightarrow [W^{(l)}, W^{(k)}]_t = \\delta_{kl} t\n$$\n其中 $\\delta_{kl}$ 是克罗内克 δ。用微分形式，这可以写成 $\\mathrm{d}W_{t}^{(l)} \\mathrm{d}W_{t}^{(k)} = \\delta_{kl} \\mathrm{d}t$。\n因此，该和收敛于一个关于时间的标准 Riemann 积分：\n$$\n\\frac{1}{2} \\sum_{l=1}^{m} \\int_{0}^{t} J_{b^{(k)}}(X_{s}) b^{(l)}(X_{s}) \\delta_{kl} \\mathrm{d}s = \\frac{1}{2} \\int_{0}^{t} J_{b^{(k)}}(X_{s}) b^{(k)}(X_{s}) \\mathrm{d}s\n$$\n涉及 $O(\\|\\Delta X_{t_i}\\|^2)$ 的高阶项在极限中消失。\n\n结合这些结果，我们得到第 $k$ 个分量的 Stratonovich 积分和 Itô 积分之间的关系：\n$$\n\\int_{0}^{t} b^{(k)}(X_{s}) \\circ \\mathrm{d}W_{s}^{(k)} = \\int_{0}^{t} b^{(k)}(X_{s}) \\mathrm{d}W_{s}^{(k)} + \\frac{1}{2} \\int_{0}^{t} J_{b^{(k)}}(X_{s}) b^{(k)}(X_{s}) \\mathrm{d}s\n$$\n对所有分量 $k=1, \\dots, m$ 求和：\n$$\n\\int_{0}^{t} b(X_{s}) \\circ \\mathrm{d}W_{s} = \\int_{0}^{t} b(X_{s}) \\mathrm{d}W_{s} + \\frac{1}{2} \\int_{0}^{t} \\sum_{k=1}^{m} J_{b^{(k)}}(X_{s}) b^{(k)}(X_{s}) \\mathrm{d}s\n$$\n现在我们将此表达式代回 Stratonovich SDE（方程 1）中：\n$$\nX_{t} = X_{0} + \\int_{0}^{t} \\alpha(X_{s})\\,\\mathrm{d}s + \\int_{0}^{t} b(X_{s})\\,\\mathrm{d}W_{s} + \\frac{1}{2} \\int_{0}^{t} \\sum_{k=1}^{m} J_{b^{(k)}}(X_{s}) b^{(k)}(X_{s}) \\mathrm{d}s\n$$\n合并 $\\mathrm{d}s$ 项：\n$$\nX_{t} = X_{0} + \\int_{0}^{t} \\left( \\alpha(X_{s}) + \\frac{1}{2} \\sum_{k=1}^{m} J_{b^{(k)}}(X_{s}) b^{(k)}(X_{s}) \\right)\\,\\mathrm{d}s + \\int_{0}^{t} b(X_{s})\\,\\mathrm{d}W_{s}\n$$\n通过将此与 Itô SDE 形式（方程 2）进行比较，我们可以确定漂移修正项 $\\Delta(x)$：\n$$\n\\alpha(x) + \\Delta(x) = \\alpha(x) + \\frac{1}{2} \\sum_{k=1}^{m} J_{b^{(k)}}(x) b^{(k)}(x)\n$$\n因此，漂移修正向量为：\n$$\n\\Delta(x) = \\frac{1}{2} \\sum_{k=1}^{m} J_{b^{(k)}}(x) b^{(k)}(x)\n$$\n这个向量 $\\Delta(x)$ 通常被称为 Itô-Stratonovich 修正项。以分量形式表示，$\\Delta(x)$ 的第 $j$ 个分量由 $\\Delta_j(x) = \\frac{1}{2} \\sum_{k=1}^{m} \\sum_{i=1}^{n} b_{ik}(x) \\frac{\\partial b_{jk}}{\\partial x_i}(x)$ 给出。", "answer": "$$\\boxed{\\frac{1}{2} \\sum_{k=1}^{m} J_{b^{(k)}}(x) b^{(k)}(x)}$$", "id": "3048335"}]}