{"hands_on_practices": [{"introduction": "本练习直接探讨 Feller 条件的一个关键推论。我们将使用尺度函数这一分析一维扩散过程的基本工具，来严格证明当条件 $2\\kappa\\theta \\lt \\sigma^2$ 成立时，CIR 过程从任何正的初始点出发，几乎必然会到达零边界。这个结果凸显了为什么零边界被归类为“可达”的，并展示了在原点附近漂移项和扩散项之间强有力的相互作用。[@problem_id:3080493]", "problem": "考虑定义在 $(0,\\infty)$ 上的 Cox–Ingersoll–Ross (CIR) 平方根扩散过程，其随机微分方程为\n$$\n\\mathrm{d}X_t \\;=\\; \\kappa\\big(\\theta - X_t\\big)\\,\\mathrm{d}t \\;+\\; \\sigma \\sqrt{X_t}\\,\\mathrm{d}W_t,\\qquad X_0=x0,\n$$\n其中 $\\kappa0$, $\\theta0$ 和 $\\sigma0$ 是常数，而 $W_t$ 是标准布朗运动。令 $\\tau_0 := \\inf\\{t\\ge 0 : X_t = 0\\}$ 表示首次触碰到边界 $0$ 的时间。假设 Feller 条件不满足，即 $2\\kappa\\theta  \\sigma^2$。\n\n仅使用无穷小生成元和一维扩散的标度函数的定义，按以下步骤进行：\n\n1) 设 $L$ 是作用于二次连续可微的检验函数 $f$ 上的生成元，定义为\n$$\nL f(x) \\;=\\; \\kappa\\big(\\theta - x\\big) f'(x) \\;+\\; \\tfrac{1}{2}\\sigma^2 x\\, f''(x).\n$$\n对于固定的 $bx$，定义 $p_b(x):=\\mathbb{P}_x\\big(\\tau_0  \\tau_b\\big)$，其中 $\\tau_b := \\inf\\{t\\ge 0 : X_t = b\\}$。证明 $p_b$ 满足以下边值问题\n$$\nL p_b(x) \\;=\\; 0 \\quad \\text{在 } (0,b) \\text{ 上}, \\qquad p_b(0)=1,\\quad p_b(b)=0,\n$$\n并且 $p_b$ 可以用该扩散过程的标度函数 $s$ 来表示，其中 $s$ 是 $L s=0$ 在 $(0,\\infty)$ 上的任意严格递增解，且在最多相差一个仿射变换的意义下是唯一的。\n\n2) 通过求解 $L s=0$ 推导标度函数 $s$ 的一个显式表达式（在最多相差一个仿射变换的意义下）。使用此表达式将 $p_b(x)$ 仅用 $s$ 表示出来。\n\n3) 在参数限制 $2\\kappa\\theta  \\sigma^2$ 下，分析极限 $s(0+)$ 和 $s(\\infty)$，然后计算\n$$\n\\lim_{b\\to\\infty} p_b(x) \\;=\\; \\mathbb{P}_x\\big(\\tau_0  \\infty\\big).\n$$\n为 $\\mathbb{P}_x(\\tau_0  \\infty)$ 推导出一个闭式值，并特别证明对于所有 $x0$，该值都严格为正。\n\n你的最终答案必须是一个精确的数值或一个闭式解析表达式。不需要四舍五入。", "solution": "该问题要求计算在条件 $2\\kappa\\theta  \\sigma^2$ 下，一个从 $X_0=x0$ 开始的 Cox-Ingersoll-Ross (CIR) 过程在有限时间内触碰到边界 0 的概率 $\\mathbb{P}_x(\\tau_0  \\infty)$。推导将通过三个步骤，使用该过程的无穷小生成元和标度函数来完成。\n\nCIR 过程由以下随机微分方程描述：\n$$\n\\mathrm{d}X_t = \\kappa(\\theta - X_t)\\,\\mathrm{d}t + \\sigma \\sqrt{X_t}\\,\\mathrm{d}W_t\n$$\n其中参数 $\\kappa0$, $\\theta0$, $\\sigma0$。该扩散过程的无穷小生成元 $L$ 由下式给出：\n$$\nL f(x) = \\kappa(\\theta - x) f'(x) + \\frac{1}{2}\\sigma^2 x f''(x)\n$$\n\n### 第 1 部分：触碰概率的边值问题\n\n令 $\\tau_a = \\inf\\{t \\ge 0 : X_t = a\\}$ 为首次触碰到水平 $a$ 的时间。我们感兴趣的是概率 $p_b(x) = \\mathbb{P}_x(\\tau_0  \\tau_b)$，即从 $x \\in (0, b)$ 出发的过程在触碰到边界 $b$ 之前触碰到边界 $0$ 的概率。\n\n对于一般的一维 Itô 扩散，一个基本结果表明，触碰概率 $p_b(x)$ 是区间 $(0,b)$ 上以下边值问题（BVP）的解：\n$$\nL p_b(x) = 0, \\quad x \\in (0,b)\n$$\n其边界条件由边界上的吸收行为决定：\n$$\np_b(0) = 1 \\quad (\\text{过程触碰 0}) \\\\\np_b(b) = 0 \\quad (\\text{过程触碰 b})\n$$\n题目陈述正确地指出了这个边值问题。\n\n扩散过程的标度函数 $s(x)$ 定义为常微分方程 $L s(x) = 0$ 的任意非常数解。这个二阶线性齐次常微分方程的通解是两个线性无关解的线性组合。其中一个解是常数，例如 $f_1(x) = 1$，另一个则是非常数的标度函数 $s(x)$。因此，$p_b(x)$ 的通解可以写成 $s(x)$ 的一个仿射变换：\n$$\np_b(x) = C_1 s(x) + C_2\n$$\n其中 $C_1$ 和 $C_2$ 是由边界条件决定的常数。\n应用边界条件：\n\\begin{align*}\np_b(0) = C_1 s(0) + C_2 = 1 \\\\\np_b(b) = C_1 s(b) + C_2 = 0\n\\end{align*}\n由第二个方程，我们得到 $C_2 = -C_1 s(b)$。将其代入第一个方程得到：\n$$\nC_1 s(0) - C_1 s(b) = 1 \\implies C_1 = \\frac{1}{s(0) - s(b)}\n$$\n于是，$C_2 = -\\frac{s(b)}{s(0) - s(b)} = \\frac{s(b)}{s(b) - s(0)}$。\n将这些常数代回 $p_b(x)$ 的表达式中：\n$$\np_b(x) = \\frac{1}{s(0) - s(b)} s(x) + \\frac{s(b)}{s(b) - s(0)} = \\frac{-s(x) + s(b)}{s(b) - s(0)} = \\frac{s(b) - s(x)}{s(b) - s(0)}\n$$\n这个表达式用标度函数 $s(x)$ 给出了概率 $p_b(x)$。注意，该表达式在 $s(x)$ 的仿射变换下是不变的，即如果我们用 $a s(x) + d$（其中常数 $a \\neq 0$ 且 $d$ 为任意常数）替换 $s(x)$，$p_b(x)$ 的值保持不变。\n\n### 第 2 部分：标度函数的推导\n\n为了找到标度函数的显式形式，我们必须求解常微分方程 $L s(x) = 0$：\n$$\n\\kappa(\\theta - x)s'(x) + \\frac{1}{2}\\sigma^2 x s''(x) = 0\n$$\n令 $u(x) = s'(x)$。关于 $u(x)$ 的方程是一个一阶线性常微分方程：\n$$\n\\frac{1}{2}\\sigma^2 x u'(x) = -\\kappa(\\theta - x)u(x)\n$$\n这是一个关于 $u(x)$ 的可分离方程：\n$$\n\\frac{u'(x)}{u(x)} = -\\frac{2\\kappa(\\theta - x)}{\\sigma^2 x} = \\frac{2\\kappa x - 2\\kappa\\theta}{\\sigma^2 x} = \\frac{2\\kappa}{\\sigma^2} - \\frac{2\\kappa\\theta}{\\sigma^2 x}\n$$\n对两边关于 $x$ 积分：\n$$\n\\ln|u(x)| = \\int \\left(\\frac{2\\kappa}{\\sigma^2} - \\frac{2\\kappa\\theta}{\\sigma^2 x}\\right) dx = \\frac{2\\kappa}{\\sigma^2} x - \\frac{2\\kappa\\theta}{\\sigma^2} \\ln(x) + C\n$$\n因为定义域是 $(0,\\infty)$，我们使用 $\\ln(x)$。对两边取指数得到：\n$$\nu(x) = \\exp\\left(\\frac{2\\kappa}{\\sigma^2} x - \\frac{2\\kappa\\theta}{\\sigma^2} \\ln(x) + C\\right) = A \\, x^{-2\\kappa\\theta/\\sigma^2} \\exp\\left(\\frac{2\\kappa}{\\sigma^2} x\\right)\n$$\n其中 $A = e^C$ 是一个任意常数。函数 $u(x)$ 被称为标度密度。由于最终的概率 $p_b(x)$ 与 $s(x)$ 的任何标度无关，我们可以选择 $A=1$。\n因此，标度密度为：\n$$\ns'(x) = x^{-2\\kappa\\theta/\\sigma^2} \\exp\\left(\\frac{2\\kappa}{\\sigma^2} x\\right)\n$$\n标度函数 $s(x)$ 通过对标度密度积分得到：\n$$\ns(x) = \\int s'(t) dt = \\int x^{-2\\kappa\\theta/\\sigma^2} \\exp\\left(\\frac{2\\kappa}{\\sigma^2} x\\right) dx\n$$\n我们可以通过选择特定的积分限来定义一个特定的标度函数，例如对于某个 $c0$，令 $s(x) = \\int_c^x s'(t) dt$。利用这一点，概率 $p_b(x)$ 可以明确地写成积分之比：\n$$\np_b(x) = \\frac{s(b) - s(x)}{s(b) - s(0)} = \\frac{\\int_c^b s'(t)dt - \\int_c^x s'(t)dt}{\\int_c^b s'(t)dt - \\int_c^0 s'(t)dt} = \\frac{\\int_x^b s'(t)dt}{\\int_0^b s'(t)dt}\n$$\n所以，\n$$\np_b(x) = \\frac{\\int_x^b t^{-2\\kappa\\theta/\\sigma^2} \\exp\\left(\\frac{2\\kappa}{\\sigma^2} t\\right) dt}{\\int_0^b t^{-2\\kappa\\theta/\\sigma^2} \\exp\\left(\\frac{2\\kappa}{\\sigma^2} t\\right) dt}\n$$\n\n### 第 3 部分：极限分析与最终概率\n\n我们需要计算 $\\mathbb{P}_x(\\tau_0  \\infty)$，它由极限 $\\lim_{b\\to\\infty} p_b(x)$ 给出。\n在给定条件 $2\\kappa\\theta  \\sigma^2$ 下，我们来分析 $p_b(x)$ 表达式中的积分。\n令 $\\alpha = \\frac{2\\kappa}{\\sigma^2}$ 和 $\\beta = \\frac{2\\kappa\\theta}{\\sigma^2}$。给定条件变为 $\\beta  1$。又因为 $\\kappa, \\theta, \\sigma > 0$，我们有 $\\alpha > 0$ 和 $\\beta > 0$。被积函数为 $t^{-\\beta}e^{\\alpha t}$。\n\n首先，考虑分母中的积分：$\\int_0^b t^{-\\beta}e^{\\alpha t} dt$。\n我们必须检查积分在下限 $t=0$ 处是否收敛。在 $t=0$ 附近，项 $e^{\\alpha t} \\approx 1$，所以被积函数的行为类似于 $t^{-\\beta}$。积分 $\\int_0^c t^{-\\beta} dt$ 收敛当且仅当 $-\\beta > -1$，即 $\\beta  1$。这正是问题中给出的条件。因此，对于任何有限的 $b0$，积分 $\\int_0^b t^{-\\beta}e^{\\alpha t} dt$ 是一个有限正数。\n\n现在我们分析当 $b\\to\\infty$ 时的极限。考虑分母 $D(b) = \\int_0^b t^{-\\beta}e^{\\alpha t} dt$。当 $b\\to\\infty$ 时，我们考察被积函数 $t^{-\\beta}e^{\\alpha t}$ 的行为。由于 $\\alpha = 2\\kappa/\\sigma^2 > 0$，指数项 $e^{\\alpha t}$ 增长到无穷大，并主导多项式项 $t^{-\\beta}$。因此，积分是发散的：\n$$\n\\lim_{b\\to\\infty} D(b) = \\int_0^\\infty t^{-\\beta}e^{\\alpha t} dt = \\infty\n$$\n类似地，对于分子 $N(b) = \\int_x^b t^{-\\beta}e^{\\alpha t} dt$（其中 $x0$ 为固定值），当 $b\\to\\infty$ 时极限也发散：\n$$\n\\lim_{b\\to\\infty} N(b) = \\int_x^\\infty t^{-\\beta}e^{\\alpha t} dt = \\infty\n$$\n我们得到了一个 $\\frac{\\infty}{\\infty}$ 形式的极限，可以使用洛必达法则来解决。我们对分子和分母关于 $b$ 求导：\n$$\n\\frac{d}{db}N(b) = \\frac{d}{db}\\int_x^b t^{-\\beta}e^{\\alpha t} dt = b^{-\\beta}e^{\\alpha b}\n$$\n$$\n\\frac{d}{db}D(b) = \\frac{d}{db}\\int_0^b t^{-\\beta}e^{\\alpha t} dt = b^{-\\beta}e^{\\alpha b}\n$$\n应用洛必达法则：\n$$\n\\mathbb{P}_x(\\tau_0  \\infty) = \\lim_{b\\to\\infty} p_b(x) = \\lim_{b\\to\\infty} \\frac{N(b)}{D(b)} = \\lim_{b\\to\\infty} \\frac{N'(b)}{D'(b)} = \\lim_{b\\to\\infty} \\frac{b^{-\\beta}e^{\\alpha b}}{b^{-\\beta}e^{\\alpha b}} = \\lim_{b\\to\\infty} 1 = 1\n$$\n当 Feller 条件不满足（$2\\kappa\\theta  \\sigma^2$）时，CIR 过程从任何 $x0$ 出发，在有限时间内触及零的概率是 $1$。这个结果证实了在该参数体系下，原点是一个可达边界。最终得到的概率 $1$ 对于所有 $x0$ 都是严格为正的。", "answer": "$$\\boxed{1}$$", "id": "3080493"}, {"introduction": "在边界可达性概念的基础上，本问题提出了一个过程触及上边界 $L$ 与零边界之间的“竞赛”。这个练习将演示 Feller 指数 $\\nu = \\frac{2\\kappa\\theta}{\\sigma^2}$ 如何扮演一个关键开关的角色，从根本上改变了零点处的边界条件，从而决定了过程的最终命运。解决这个问题需要你根据 $\\nu \\lt 1$ 或 $\\nu \\ge 1$ 来应用相应的边界分类，为 Feller 条件的实际应用提供一个具体的例子。[@problem_id:3041826]", "problem": "考虑由随机微分方程（SDE）定义的 Cox–Ingersoll–Ross (CIR) 过程\n$$\ndX_t=\\kappa\\big(\\theta-X_t\\big)\\,dt+\\sigma\\sqrt{X_t}\\,dW_t,\n$$\n其中 $\\kappa0$、$\\theta0$ 和 $\\sigma0$ 是常数，而 $W_t$ 是一维标准布朗运动（BM）。定义 Feller 指数\n$$\n\\nu:=\\frac{2\\kappa\\theta}{\\sigma^2}.\n$$\n固定一个水平 $L0$，对于 $x\\in(0,L)$，定义双边首次到达时间\n$$\n\\tau_0:=\\inf\\{t\\ge 0:X_t=0\\},\\qquad \\tau_L:=\\inf\\{t\\ge 0:X_t=L\\}.\n$$\n令\n$$\nu(x):=\\mathbb{P}_x\\big(\\tau_L  \\tau_0\\big),\n$$\n即从 $X_0=x$ 开始的过程在到达 0 之前先到达 $L$ 的概率。你的任务是：\n- 使用一维扩散的 Kolmogorov 后向方程（KBE），以及根据 Feller 指数 $\\nu$ 对 CIR 过程原点的边界分类，确定在 $(0,L)$ 上 $u$ 所满足的后向方程在 $x=0$ 处应施加的正确边界条件，并明确说明该条件如何依赖于 $\\nu  1$ 或 $\\nu\\ge 1$。\n- 从第一性原理（与给定 SDE 和 KBE 相关联的生成元）出发，推导 $u(x)$ 在 $(0,L)$ 上满足的常微分方程（ODE），并在你确定的 $x=0$ 处的边界条件以及由 $u$ 的定义所隐含的 $x=L$ 处的边界条件下求解该方程。\n\n将你得到的 $u(x)$ 的最终答案表示为一个对所有 $x\\in(0,L)$ 和所有参数范围都有效的单一闭式解析表达式，并明确其对 $\\nu$、$\\kappa$、$\\theta$ 和 $\\sigma$ 的依赖关系。不需要数值近似。", "solution": "问题要求计算 Cox–Ingersoll–Ross (CIR) 过程的概率 $u(x) = \\mathbb{P}_x(\\tau_L  \\tau_0)$，其中 $\\tau_0$ 和 $\\tau_L$ 分别是首次到达水平 $0$ 和 $L$ 的时间。\n\n首先，我们验证问题陈述的有效性。\n给定条件如下：\n1.  CIR 过程的 SDE：$dX_t=\\kappa(\\theta-X_t)\\,dt+\\sigma\\sqrt{X_t}\\,dW_t$，其中常数 $\\kappa0$、$\\theta0$、$\\sigma0$。\n2.  Feller 指数：$\\nu := \\frac{2\\kappa\\theta}{\\sigma^2}$。\n3.  起始点 $x$ 的定义域是 $(0,L)$，其中 $L0$。\n4.  首次到达时间：$\\tau_0:=\\inf\\{t\\ge 0:X_t=0\\}$ 和 $\\tau_L:=\\inf\\{t\\ge 0:X_t=L\\}$。\n5.  待求函数：$u(x):=\\mathbb{P}_x(\\tau_L  \\tau_0)$。\n\n该问题具有科学依据，因为它涉及一个标准的、经过充分研究的随机过程（CIR）和一个基本量（首次到达概率）。问题提法得当且客观。该问题是有效的。\n\n我们按要求分两个主要部分进行求解。\n\n第一部分：ODE 和边界条件的推导\n\n对于一维 Itô 扩散 $dX_t = a(X_t)dt + b(X_t)dW_t$，其无穷小生成元 $\\mathcal{A}$ 由下式给出\n$$\n\\mathcal{A}f(x) = a(x)f'(x) + \\frac{1}{2}b(x)^2 f''(x).\n$$\n对于 CIR 过程，漂移项为 $a(x) = \\kappa(\\theta-x)$，扩散系数为 $b(x) = \\sigma\\sqrt{x}$。其生成元为：\n$$\n\\mathcal{A}f(x) = \\kappa(\\theta-x)f'(x) + \\frac{1}{2}\\sigma^2 x f''(x).\n$$\n概率 $u(x) = \\mathbb{P}_x(\\tau_L  \\tau_0)$ 是该过程在离开区间 $(0,L)$ 时被终止的 Kolmogorov 后向方程（KBE）的解。对于 $x \\in (0,L)$，KBE 为 $\\mathcal{A}u(x)=0$。这给出了二阶线性常微分方程（ODE）：\n$$\n\\frac{1}{2}\\sigma^2 x u''(x) + \\kappa(\\theta - x) u'(x) = 0.\n$$\n边界条件由 $u(x)$ 的定义和过程在边界处的行为确定。\n$x=L$ 处的边界条件是直接的。如果过程从 $X_0=L$ 开始，它在时间 $t=0$ 时已经到达水平 $L$。由于 $L0$，它尚未到达 $0$。因此，$\\tau_L = 0$ 且 $\\tau_0  0$，这意味着事件 $\\tau_L  \\tau_0$ 以概率 $1$ 发生。所以，\n$$\nu(L)=1.\n$$\n$x=0$ 处的边界条件更为微妙，它依赖于 Feller 指数 $\\nu = \\frac{2\\kappa\\theta}{\\sigma^2}$。我们必须使用 Feller 检验对 $0$ 处的边界进行分类。标度密度函数 $s'(x)$ 由下式给出\n$$\ns'(x) = \\exp\\left(-\\int \\frac{2a(y)}{b(y)^2} dy\\right) = \\exp\\left(-\\int \\frac{2\\kappa(\\theta-y)}{\\sigma^2 y} dy\\right).\n$$\n积分为\n$$\n\\int \\left(\\frac{2\\kappa\\theta}{\\sigma^2y} - \\frac{2\\kappa}{\\sigma^2}\\right) dy = \\frac{2\\kappa\\theta}{\\sigma^2}\\ln(y) - \\frac{2\\kappa}{\\sigma^2}y = \\nu \\ln(y) - \\frac{2\\kappa}{\\sigma^2}y.\n$$\n因此，标度密度为\n$$\ns'(x) = \\exp\\left(-\\nu \\ln(x) + \\frac{2\\kappa}{\\sigma^2}x\\right) = x^{-\\nu} \\exp\\left(\\frac{2\\kappa}{\\sigma^2}x\\right).\n$$\n$0$ 处边界的性质取决于 $s'(x)$ 在 $0$ 附近的可积性。我们考察 $\\int_0^c s'(y)dy$，其中 $c0$ 是某个小数。当 $y\\to 0$ 时，$e^{(2\\kappa/\\sigma^2)y} \\to 1$，因此收敛性由 $\\int_0^c y^{-\\nu}dy$ 的收敛性决定。该积分收敛当且仅当 $-\\nu  -1$，这等价于 $\\nu  1$。\n\n情况 1：$\\nu  1$。\n标度密度的积分收敛。$0$ 处的边界是正则的。这意味着从 $x0$ 开始的过程可以在有限时间内以正概率到达原点。如果过程到达 $0$，则条件 $\\tau_L  \\tau_0$ 为假。因此，当起始点 $x$ 趋近于 $0$ 时，在到达 $0$ 之前先到达 $L$ 的概率必须为零。这隐含了边界条件：\n$$\nu(0)=0.\n$$\n\n情况 2：$\\nu \\ge 1$。\n标度密度的积分发散。$0$ 处的边界是入口边界，这意味着从定义域 $(0,\\infty)$ 的内部无法到达该边界。对于从 $X_0=x0$ 开始的过程，到达原点的概率为零，即 $\\mathbb{P}_x(\\tau_0 = \\infty)=1$。\n因此，事件 $\\tau_L  \\tau_0$ 等价于事件 $\\tau_L  \\infty$。由于 CIR 过程是向 $\\theta0$ 均值回归的，它不会逃逸到 $+\\infty$，并且最终会以概率 $1$ 到达任何水平 $L$。因此，对于任何 $x \\in (0, L)$，我们有 $u(x)=1$。\n从 ODE 的角度来看，$x=0$ 处边界的不可达性意味着我们不施加像 $u(0)=c$ 这样的值条件。相反，物理要求是解 $u(x)$ 在 $x \\to 0$ 时保持有界。正如我们将看到的，这个条件足以确定唯一的解。\n\n第二部分：求解 ODE\n\n$\\mathcal{A}u(x)=0$ 的通解是 $u(x) = C_1 S(x) + C_2$，其中 $S(x) = \\int^x s'(y)dy$ 是标度函数。我们可以将通解写为：\n$$\nu(x) = C_1 \\int_c^x y^{-\\nu} \\exp\\left(\\frac{2\\kappa}{\\sigma^2} y\\right) dy + C_2,\n$$\n其中 $c \\in (0,L)$ 是某个任意常数。\n\n情况 1：$\\nu  1$。\n边界条件是 $u(0)=0$ 和 $u(L)=1$。我们可以选择积分下限为 $0$，因为积分是收敛的。\n$$\nu(x) = C_1 \\int_0^x y^{-\\nu} \\exp\\left(\\frac{2\\kappa}{\\sigma^2} y\\right) dy + C_2.\n$$\n由 $u(0)=0$，我们得到 $C_1 \\cdot 0 + C_2 = 0$，所以 $C_2=0$。\n解为 $u(x) = C_1 \\int_0^x y^{-\\nu} \\exp\\left(\\frac{2\\kappa}{\\sigma^2} y\\right) dy$。\n由 $u(L)=1$，我们确定 $C_1$：\n$$\n1 = C_1 \\int_0^L y^{-\\nu} \\exp\\left(\\frac{2\\kappa}{\\sigma^2} y\\right) dy \\implies C_1 = \\left(\\int_0^L y^{-\\nu} \\exp\\left(\\frac{2\\kappa}{\\sigma^2} y\\right) dy\\right)^{-1}.\n$$\n所以，对于 $\\nu  1$，解为\n$$\nu(x) = \\frac{\\int_0^x y^{-\\nu} \\exp\\left(\\frac{2\\kappa}{\\sigma^2} y\\right) dy}{\\int_0^L y^{-\\nu} \\exp\\left(\\frac{2\\kappa}{\\sigma^2} y\\right) dy}.\n$$\n\n情况 2：$\\nu \\ge 1$。\n$x=0$ 处的边界条件是 $u(x)$ 在 $x\\to 0^+$ 时必须有界。\n积分 $\\int_c^x y^{-\\nu} e^{\\frac{2\\kappa}{\\sigma^2} y} dy = - \\int_x^c y^{-\\nu} e^{\\frac{2\\kappa}{\\sigma^2} y} dy$。由于 $\\nu \\ge 1$，积分 $\\int_0^c y^{-\\nu} e^{\\frac{2\\kappa}{\\sigma^2} y} dy$ 发散到 $+\\infty$。这意味着当 $x \\to 0^+$ 时，项 $\\int_c^x y^{-\\nu} \\dots dy$ 发散到 $-\\infty$。\n为了使 $u(x) = C_1 \\int_c^x y^{-\\nu} \\dots dy + C_2$ 保持有界，我们必须设置 $C_1=0$。\n这剩下 $u(x)=C_2$。应用另一个边界条件 $u(L)=1$，得到 $C_2=1$。\n因此，对于 $\\nu \\ge 1$，解为 $u(x)=1$。\n\n最终表达式\n我们现在用标准特殊函数来表示 $\\nu  1$ 时的解。该积分与第一类合流超几何函数 $M(a,b,z) = {}_1F_1(a;b;z)$ 有关。一个相关的积分表示是：\n$$\n\\int_0^z t^{\\alpha-1} e^t dt = \\frac{z^\\alpha}{\\alpha} M(\\alpha, \\alpha+1, z), \\quad \\text{对于 } \\alpha0.\n$$\n我们的积分是 $\\int_0^x y^{-\\nu} \\exp(cy) dy$，其中 $c = \\frac{2\\kappa}{\\sigma^2}$。令 $t=cy$，则 $y=t/c$ 且 $dy=dt/c$。\n$$\n\\int_0^{cx} (t/c)^{-\\nu} e^t (dt/c) = c^{\\nu-1} \\int_0^{cx} t^{-\\nu} e^t dt.\n$$\n使用 $\\alpha=1-\\nu$（因为 $\\nu  1$ 所以为正）和 $z=cx$ 的表示，这变成：\n$$\nc^{\\nu-1} \\frac{(cx)^{1-\\nu}}{1-\\nu} M(1-\\nu, 2-\\nu, cx) = \\frac{x^{1-\\nu}}{1-\\nu} M(1-\\nu, 2-\\nu, \\frac{2\\kappa}{\\sigma^2}x).\n$$\n将此应用于 $u(x)$ 表达式的分子和分母：\n$$\nu(x) = \\frac{\\frac{x^{1-\\nu}}{1-\\nu} M(1-\\nu, 2-\\nu, \\frac{2\\kappa}{\\sigma^2}x)}{\\frac{L^{1-\\nu}}{1-\\nu} M(1-\\nu, 2-\\nu, \\frac{2\\kappa}{\\sigma^2}L)} = \\left(\\frac{x}{L}\\right)^{1-\\nu} \\frac{M(1-\\nu, 2-\\nu, \\frac{2\\kappa}{\\sigma^2}x)}{M(1-\\nu, 2-\\nu, \\frac{2\\kappa}{\\sigma^2}L)}.\n$$\n这是 $\\nu  1$ 时的解。作为检验，当 $\\nu \\to 1^-$ 时，令 $\\epsilon = 1-\\nu \\to 0^+$。利用 $M(\\epsilon, 1+\\epsilon, z) \\to M(0,1,z)=1$ 这一事实，我们发现 $u(x) \\to (\\frac{x}{L})^0 \\frac{1}{1} = 1$，这与 $\\nu \\ge 1$ 时的解相匹配。函数 $u(x)$ 在参数 $\\nu=1$ 处是连续的。\n\n结合这两种情况，完整的解是：\n$$\nu(x) =\n\\begin{cases}\n\\displaystyle \\left(\\frac{x}{L}\\right)^{1-\\nu} \\frac{M(1-\\nu, 2-\\nu, \\frac{2\\kappa}{\\sigma^2}x)}{M(1-\\nu, 2-\\nu, \\frac{2\\kappa}{\\sigma^2}L)}  \\text{若 } \\nu  1 \\\\\n1  \\text{若 } \\nu \\ge 1\n\\end{cases}\n$$\n其中 $\\nu = \\frac{2\\kappa\\theta}{\\sigma^2}$ 且 $M(a,b,z)$ 是 Kummer 合流超几何函数。", "answer": "$$\n\\boxed{\nu(x) =\n\\begin{cases}\n\\left(\\frac{x}{L}\\right)^{1-\\frac{2\\kappa\\theta}{\\sigma^2}} \\frac{M\\left(1-\\frac{2\\kappa\\theta}{\\sigma^2}, 2-\\frac{2\\kappa\\theta}{\\sigma^2}, \\frac{2\\kappa}{\\sigma^2}x\\right)}{M\\left(1-\\frac{2\\kappa\\theta}{\\sigma^2}, 2-\\frac{2\\kappa\\theta}{\\sigma^2}, \\frac{2\\kappa}{\\sigma^2}L\\right)}  \\text{若 } \\frac{2\\kappa\\theta}{\\sigma^2}  1 \\\\\n1  \\text{若 } \\frac{2\\kappa\\theta}{\\sigma^2} \\ge 1\n\\end{cases}\n}\n$$", "id": "3041826"}, {"introduction": "理论上的正性保证至关重要，但在金融领域必不可少的计算机模拟中，我们如何保持这一特性呢？本实践通过要求你为 CIR 模型设计一个漂移隐式数值格式，从而将理论与应用联系起来。这个练习挑战你思考离散化方法的选择如何能确保过程的非负性，并将数值格式的行为与 Feller 条件下精确连续时间过程的性质进行比较。[@problem_id:3080496]", "problem": "考虑 Cox–Ingersoll–Ross (CIR) 短期利率模型，它由以下随机微分方程 (SDE) 定义：\n$$\ndX_t \\;=\\; \\kappa\\,(\\theta - X_t)\\,dt \\;+\\; \\sigma\\,\\sqrt{X_t}\\,dW_t,\\qquad X_0 \\ge 0,\n$$\n其中 $\\kappa0$、$\\theta\\ge 0$ 和 $\\sigma\\ge 0$ 是参数，$(W_t)_{t\\ge 0}$ 是标准布朗运动。众所周知，当 $X_00$ 时，所谓的 Feller 条件 $2\\,\\kappa\\,\\theta \\ge \\sigma^2$ 能确保精确解在所有 $t0$ 时严格为正。\n\n您的任务是构建一个保持非负性的单步漂移隐式格式，方法是在下一个时间步长以隐式方式处理均值回归漂移项和平方根扩散项。在步长为 $\\Delta t0$ 的均匀时间网格上进行操作，并将布朗增量表示为 $\\Delta W_n := W_{t_{n+1}}-W_{t_n}$，其中 $\\Delta W_n \\sim \\mathcal{N}(0,\\Delta t)$ 在各步之间独立。从 SDE 和基本的时间离散化原理（随机积分的左点和右点近似，以及用于求解一元二次方程的求根公式）出发，为漂移隐式平方根格式推导出精确的单步更新映射 $\\varphi$ 的闭式解，使得 $X_{n+1}=\\varphi(X_n,\\Delta W_n)$。\n\n然后，使用您推导出的表达式，从第一性原理出发进行推理，评估更新在单步内何时是严格为正的，并解释这与 Feller 条件 $2\\,\\kappa\\,\\theta \\ge \\sigma^2$ 下精确过程的严格正性相比有何不同。在您的讨论中，请将其与完全截断显式格式在非负性与严格正性方面的行为进行对比。\n\n重要提示：作为最终答案，请提供映射 $\\varphi(x,\\Delta W)$ 的单一闭式解析表达式，用 $\\kappa$、$\\theta$、$\\sigma$、$\\Delta t$、$x$ 和 $\\Delta W$ 表示。最终答案中不应包含任何不等式或额外评注。不要对您的表达式进行四舍五入。", "solution": "该问题要求推导和分析 Cox–Ingersoll–Ross (CIR) 过程的一个单步漂移隐式数值格式，该格式也对扩散项进行隐式处理。CIR 过程由以下随机微分方程 (SDE) 描述：\n$$\ndX_t = \\kappa(\\theta - X_t)dt + \\sigma\\sqrt{X_t}dW_t\n$$\n其参数为 $\\kappa  0$、$\\theta \\ge 0$、$\\sigma \\ge 0$，初始条件为 $X_0 \\ge 0$。\n\n首先，我们在均匀时间网格 $t_n = n\\Delta t$ 上推导映射 $\\varphi$，使得 $X_{n+1} = \\varphi(X_n, \\Delta W_n)$。SDE 在区间 $[t_n, t_{n+1}]$ 上的积分形式为：\n$$\nX_{t_{n+1}} - X_{t_n} = \\int_{t_n}^{t_{n+1}} \\kappa(\\theta - X_s)ds + \\int_{t_n}^{t_{n+1}} \\sigma\\sqrt{X_s}dW_s\n$$\n设 $X_n$ 是 $X_{t_n}$ 的数值近似。一个同时对扩散项进行隐式处理的漂移隐式格式，意味着我们使用积分区间右端点 $t_{n+1}$ 处的值来近似被积函数。这是一种后向欧拉类型的近似。\n漂移项积分近似为：\n$$\n\\int_{t_n}^{t_{n+1}} \\kappa(\\theta - X_s)ds \\approx \\kappa(\\theta - X_{n+1})\\Delta t\n$$\n随机积分近似为：\n$$\n\\int_{t_n}^{t_{n+1}} \\sigma\\sqrt{X_s}dW_s \\approx \\sigma\\sqrt{X_{n+1}}\\int_{t_n}^{t_{n+1}}dW_s = \\sigma\\sqrt{X_{n+1}}\\Delta W_n\n$$\n其中 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$。将这些近似代入 SDE 的积分形式，得到 $X_{n+1}$ 的离散更新方程：\n$$\nX_{n+1} - X_n = \\kappa(\\theta - X_{n+1})\\Delta t + \\sigma\\sqrt{X_{n+1}}\\Delta W_n\n$$\n这是一个关于 $X_{n+1}$ 的隐式方程。为了解出 $X_{n+1}$，我们重新整理各项：\n$$\nX_{n+1} + \\kappa X_{n+1}\\Delta t - \\sigma\\sqrt{X_{n+1}}\\Delta W_n - (X_n + \\kappa\\theta\\Delta t) = 0\n$$\n$$\n(1 + \\kappa\\Delta t)X_{n+1} - (\\sigma\\Delta W_n)\\sqrt{X_{n+1}} - (X_n + \\kappa\\theta\\Delta t) = 0\n$$\n这是一个关于变量 $\\sqrt{X_{n+1}}$ 的二次方程。设 $Y = \\sqrt{X_{n+1}}$。由于 $X_{n+1}$ 必须是一个非负量，我们必须有 $Y \\ge 0$。该方程变为：\n$$\n(1 + \\kappa\\Delta t)Y^2 - (\\sigma\\Delta W_n)Y - (X_n + \\kappa\\theta\\Delta t) = 0\n$$\n这是一个形如 $aY^2 + bY + c = 0$ 的二次方程，其系数为：\n$a = 1 + \\kappa\\Delta t$\n$b = -\\sigma\\Delta W_n$\n$c = -(X_n + \\kappa\\theta\\Delta t)$\n\n$Y$ 的解由二次方程求根公式 $Y = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 给出。\n判别式为 $D = b^2 - 4ac = (-\\sigma\\Delta W_n)^2 - 4(1 + \\kappa\\Delta t)(- (X_n + \\kappa\\theta\\Delta t))$：\n$$\nD = \\sigma^2(\\Delta W_n)^2 + 4(1 + \\kappa\\Delta t)(X_n + \\kappa\\theta\\Delta t)\n$$\n鉴于参数约束 $\\kappa  0$、$\\theta \\ge 0$ 以及 $X_n \\ge 0$ 和 $\\Delta t  0$ 的事实，项 $(1 + \\kappa\\Delta t)(X_n + \\kappa\\theta\\Delta t)$ 始终为非负。因此，判别式 $D$ 始终为非负，保证了 $Y$ 存在实数根。解为：\n$$\nY = \\frac{\\sigma\\Delta W_n \\pm \\sqrt{\\sigma^2(\\Delta W_n)^2 + 4(1 + \\kappa\\Delta t)(X_n + \\kappa\\theta\\Delta t)}}{2(1 + \\kappa\\Delta t)}\n$$\n我们要求 $Y = \\sqrt{X_{n+1}} \\ge 0$。分母 $2(1 + \\kappa\\Delta t)$ 是严格为正的。我们来分析两个根的分子符号。平方根项满足 $\\sqrt{D} \\ge \\sqrt{\\sigma^2(\\Delta W_n)^2} = |\\sigma\\Delta W_n|$。\n带有负号的根给出的分子是 $\\sigma\\Delta W_n - \\sqrt{D} \\le \\sigma\\Delta W_n - |\\sigma\\Delta W_n|$，这始终是非正的。这将导致 $Y \\le 0$。\n带有正号的根给出的分子是 $\\sigma\\Delta W_n + \\sqrt{D} \\ge \\sigma\\Delta W_n + |\\sigma\\Delta W_n|$，这始终是非负的。这将导致 $Y \\ge 0$。\n因此，为确保非负性，我们必须选择正根：\n$$\n\\sqrt{X_{n+1}} = \\frac{\\sigma\\Delta W_n + \\sqrt{\\sigma^2(\\Delta W_n)^2 + 4(1 + \\kappa\\Delta t)(X_n + \\kappa\\theta\\Delta t)}}{2(1 + \\kappa\\Delta t)}\n$$\n两边平方得到 $X_{n+1}$ 的表达式。按题目要求写成映射 $\\varphi(x, \\Delta W)$ 的形式，其中 $x$ 表示步长开始时的状态，$\\Delta W$ 是布朗增量，我们有：\n$$\nX_{n+1} = \\varphi(x, \\Delta W) = \\left( \\frac{\\sigma\\Delta W + \\sqrt{\\sigma^2(\\Delta W)^2 + 4(1 + \\kappa\\Delta t)(x + \\kappa\\theta\\Delta t)}}{2(1 + \\kappa\\Delta t)} \\right)^2\n$$\n\n接下来，我们分析该格式的严格正性。由于 $X_{n+1}$ 是一个平方项，只要 $X_n \\ge 0$，其非负性 ($X_{n+1} \\ge 0$) 就由其构造保证。该格式是严格为正的，即 $X_{n+1}  0$，当且仅当平方内的项不为零。分母不为零。分子为零当且仅当：\n$$\n\\sigma\\Delta W_n + \\sqrt{\\sigma^2(\\Delta W_n)^2 + 4(1 + \\kappa\\Delta t)(X_n + \\kappa\\theta\\Delta t)} = 0\n$$\n这要求 $\\sigma\\Delta W_n \\le 0$，并且在平方和整理后，得到 $4(1 + \\kappa\\Delta t)(X_n + \\kappa\\theta\\Delta t) = 0$。由于 $1 + \\kappa\\Delta t  0$，这意味着 $X_n + \\kappa\\theta\\Delta t = 0$。考虑到所有项的非负性，这只可能在 $X_n=0$ 和 $\\theta=0$ 时发生。\n因此，如果 $X_n  0$，则 $X_n + \\kappa\\theta\\Delta t$ 项严格为正，意味着分子严格为正，因此 $X_{n+1}  0$。该格式无条件地保持严格正性。如果 $X_n=0$，只要 $\\theta  0$，$X_{n+1}$ 就将严格为正。如果 $\\theta0$，过程会在一步内脱离零边界。\n\n这种行为比连续时间 CIR 过程的行为更强。只有在满足 Feller 条件 $2\\kappa\\theta \\ge \\sigma^2$ 时，精确解 $X_t$ 才能保证在所有 $t  0$ 时（如果 $X_0  0$）都严格为正。如果 $2\\kappa\\theta  \\sigma^2$，过程可以以正概率触及零。相比之下，我们推导的数值格式对于任何参数集 $\\kappa0, \\theta\\ge 0, \\sigma\\ge 0$ 和任何时间步长 $\\Delta t0$ 都能保持严格正性。对扩散项的隐式处理是这一稳健性质的原因，因为它有效地防止了随机项将过程驱动到零或零以下。\n\n最后，我们将其与完全截断显式格式进行对比，后者通常定义为：\n$$\nX_{n+1} = \\max\\left(0, X_n + \\kappa(\\theta - X_n)\\Delta t + \\sigma\\sqrt{X_n}\\Delta W_n\\right)\n$$\n这种显式格式通过直接截断来保证非负性。然而，每当 $\\max$ 函数的参数为负时，该格式会将 $X_{n+1}$ 精确地设置为 $0$。这会产生一个一个人为的“粘性”边界，过程可能在此处被吸收在零处一个或多个时间步长，这种行为在真实过程中可能不会出现，尤其是在 Feller 条件成立时。相比之下，隐式格式通过其代数结构自然地保证了非负性，并且只允许过程在特定且有限的条件下（$X_n=0, \\theta=0$）触及零，从而为边界附近的过程动态提供了更忠实的表示。", "answer": "$$\\boxed{\\left( \\frac{\\sigma \\Delta W + \\sqrt{\\sigma^2 (\\Delta W)^2 + 4(1 + \\kappa \\Delta t)(x + \\kappa \\theta \\Delta t)}}{2(1 + \\kappa \\Delta t)} \\right)^2}$$", "id": "3080496"}]}