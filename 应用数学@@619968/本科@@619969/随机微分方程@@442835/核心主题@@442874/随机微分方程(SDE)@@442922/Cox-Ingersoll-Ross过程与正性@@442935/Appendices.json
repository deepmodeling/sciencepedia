{"hands_on_practices": [{"introduction": "理解一个随机过程随时间的期望行为是分析其性质的基础。本练习将展示一种强大的分析技术，即利用向后 Kolmogorov 方程，来精确求解 CIR 过程的条件期望 $m_1(t,x)=\\mathbb{E}[X_t \\mid X_0=x]$。这个结果不仅是一次重要的计算实践，更深刻地揭示了模型的核心特征——均值回归特性。", "problem": "考虑 Cox-Ingersoll-Ross (CIR) 扩散，其定义为以下随机微分方程的唯一强解\n$$\ndX_t=\\kappa\\left(\\theta - X_t\\right)\\,dt+\\sigma \\sqrt{X_t}\\,dW_t,\\quad X_0=x,\n$$\n其中 $W_t$ 是标准布朗运动，参数满足 $\\kappa>0$，$\\theta\\ge 0$，$\\sigma>0$ 和 $x\\ge 0$。回顾对于一个足够光滑的检验函数 $f$，该伊藤扩散的无穷小生成元 $\\mathcal{L}$ 为\n$$\n\\mathcal{L}f(x)=\\kappa\\left(\\theta-x\\right)f'(x)+\\frac{1}{2}\\sigma^2 x f''(x),\n$$\n并且后向 Kolmogorov 方程指出，对于 $u(t,x)=\\mathbb{E}_x[f(X_t)]$，我们有\n$$\n\\partial_t u(t,x)=\\mathcal{L}u(t,x),\\quad u(0,x)=f(x).\n$$\n令 $m_1(t,x)=\\mathbb{E}[X_t\\mid X_0=x]$ 并取 $f(y)=y$。仅使用生成元的定义和后向 Kolmogorov 方程作为基础出发点，通过证明 $m_1(t,x)$ 在 $x$ 上是仿射的，来推导一个关于 $t$ 的 $m_1(t,x)$ 的线性常微分方程，并通过求解所得系统及初始条件 $m_1(0,x)=x$ 来确定其系数。将您的最终结果表示为 $m_1(t,x)$ 关于 $t$、$x$、$\\kappa$ 和 $\\theta$ 的单个闭式解析表达式。不需要数值近似，也不涉及单位。", "solution": "所述问题在科学上是合理的、自洽的且良定的。所有给出的定义，包括 Cox-Ingersoll-Ross (CIR) 过程的随机微分方程、其无穷小生成元的形式以及后向 Kolmogorov 方程，在随机微积分领域都是标准且正确的。参数有适当的约束，目标明确无歧义。因此，该问题是有效的，我们可以进行推导。\n\n目标是求条件期望 $m_1(t,x)=\\mathbb{E}[X_t\\mid X_0=x]$。该量是通用函数 $u(t,x)=\\mathbb{E}_x[f(X_t)]$ 在检验函数为 $f(y)=y$ 时的特例。根据问题陈述，$m_1(t,x)$ 必须满足后向 Kolmogorov 偏微分方程 (PDE)：\n$$\n\\partial_t m_1(t,x) = \\mathcal{L}m_1(t,x)\n$$\n其中 $\\mathcal{L}$ 是 CIR 过程的无穷小生成元。生成元对足够光滑的函数 $g(x)$ 的作用由下式给出：\n$$\n\\mathcal{L}g(x) = \\kappa(\\theta - x)g'(x) + \\frac{1}{2}\\sigma^2 x g''(x)\n$$\n在关于 $m_1(t,x)$ 的偏微分方程中，生成元中的导数是关于空间变量 $x$ 的。因此，该偏微分方程为：\n$$\n\\partial_t m_1(t,x) = \\kappa(\\theta - x)\\partial_x m_1(t,x) + \\frac{1}{2}\\sigma^2 x \\partial_{xx}^2 m_1(t,x)\n$$\n初始条件由 $m_1(0,x) = \\mathbb{E}[X_0 \\mid X_0=x] = x$ 给出。\n\n问题建议证明解在 $x$ 上是仿射的。让我们假设一个形式如下的解：\n$$\nm_1(t,x) = A(t)x + B(t)\n$$\n其中 $A(t)$ 和 $B(t)$ 是待确定的随时间变化的系数。我们可以计算这个仿射形式的偏导数：\n$$\n\\partial_t m_1(t,x) = A'(t)x + B'(t)\n$$\n$$\n\\partial_x m_1(t,x) = A(t)\n$$\n$$\n\\partial_{xx}^2 m_1(t,x) = 0\n$$\n将这些导数代入后向 Kolmogorov 偏微分方程，得到：\n$$\nA'(t)x + B'(t) = \\kappa(\\theta - x)A(t) + \\frac{1}{2}\\sigma^2 x (0)\n$$\n$$\nA'(t)x + B'(t) = \\kappa\\theta A(t) - \\kappa x A(t)\n$$\n该方程必须对所有 $x \\ge 0$ 的值成立。因此，我们可以令方程两边 $x$ 的各次幂的系数相等。\n\n令 $x^1$ 的系数相等：\n$$\nA'(t) = -\\kappa A(t)\n$$\n令 $x^0$ 的系数（常数项）相等：\n$$\nB'(t) = \\kappa\\theta A(t)\n$$\n这就得到了一个关于 $A(t)$ 和 $B(t)$ 的由两个线性常微分方程 (ODE) 组成的方程组。为了求解这个方程组，我们需要初始条件。这些条件由偏微分方程的初始条件 $m_1(0,x) = x$ 导出。\n$$\nm_1(0,x) = A(0)x + B(0) = x\n$$\n通过比较系数，我们得到常微分方程组的初始条件：\n$$\nA(0) = 1\n$$\n$$\nB(0) = 0\n$$\n现在，我们求解关于 $A(t)$ 的常微分方程：\n方程 $A'(t) = -\\kappa A(t)$ 及其初始条件 $A(0) = 1$ 是一个标准的一阶线性常微分方程。其解为：\n$$\nA(t) = A(0)\\exp(-\\kappa t) = \\exp(-\\kappa t)\n$$\n接下来，我们将 $A(t)$ 的解代入关于 $B(t)$ 的常微分方程：\n$$\nB'(t) = \\kappa\\theta A(t) = \\kappa\\theta \\exp(-\\kappa t)\n$$\n为了求出 $B(t)$，我们使用初始条件 $B(0) = 0$，将此表达式对时间从 $0$ 积分到 $t$：\n$$\n\\int_0^t B'(s) \\, ds = B(t) - B(0) = B(t)\n$$\n$$\nB(t) = \\int_0^t \\kappa\\theta \\exp(-\\kappa s) \\, ds = \\kappa\\theta \\int_0^t \\exp(-\\kappa s) \\, ds\n$$\n进行积分：\n$$\nB(t) = \\kappa\\theta \\left[ -\\frac{1}{\\kappa} \\exp(-\\kappa s) \\right]_0^t = -\\theta \\left[ \\exp(-\\kappa s) \\right]_0^t\n$$\n$$\nB(t) = -\\theta (\\exp(-\\kappa t) - \\exp(0)) = -\\theta (\\exp(-\\kappa t) - 1)\n$$\n$$\nB(t) = \\theta(1 - \\exp(-\\kappa t))\n$$\n最后，我们将 $A(t)$ 和 $B(t)$ 的表达式代回到我们对 $m_1(t,x)$ 的仿射假设中：\n$$\nm_1(t,x) = A(t)x + B(t) = x\\exp(-\\kappa t) + \\theta(1 - \\exp(-\\kappa t))\n$$\n这就是 CIR 过程条件均值的闭式解析表达式。", "answer": "$$\n\\boxed{x\\exp(-\\kappa t) + \\theta(1 - \\exp(-\\kappa t))}\n$$", "id": "3047774"}, {"introduction": "从解析解转向数值模拟后，我们会遇到新的挑战。理论上的 CIR 过程是保证非负的，但在将其付诸计算机模拟时，最直接的数值方法——欧拉-丸山法——却可能破坏这一关键属性。本练习将深入探究这一现象的根源，通过推导单步更新产生负值的概率，将布朗运动的理论性质与一个常见的模拟陷阱联系起来。", "problem": "请考虑由 $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t$ 给出的 Cox–Ingersoll–Ross (CIR) 随机微分方程 (SDE)，其初始值为 $X_0 \\ge 0$，其中 $\\kappa > 0$，$\\theta > 0$，$\\sigma \\ge 0$，且 $W_t$ 是标准布朗运动。已知当 $X_0 > 0$ 时，在 Feller 条件 $2\\kappa\\theta \\ge \\sigma^2$ 下，此 SDE 的精确解严格为正。然而，像 Euler–Maruyama 方法这样的数值时间离散化方法通常不继承这种正性。\n\n任务：从应用于 Itô SDE 的 Euler–Maruyama 格式的定义出发，并利用长度为 $h$ 的时间步长上的布朗增量服从均值为 $0$、方差为 $h$ 的正态分布这一事实，从第一性原理推导出一个表达式，该表达式表示从给定的非负状态 $x \\ge 0$ 开始，CIR SDE 的单步 Euler–Maruyama 更新产生下一个值为负的概率。您的推导必须仅使用正态分布的标准性质，用 $\\kappa$、$\\theta$、$\\sigma$、$x$ 和 $h$ 来表示这个概率。然后，实现一个程序，对下面测试套件中的每个参数集，计算这个单步为负的概率，并将其作为四舍五入到六位小数的浮点数返回。\n\n您必须正确处理任何退化情况。特别是，如果当前状态下的扩散系数为零，从而导致 Euler–Maruyama 更新中的噪声项消失（例如，当 $\\sigma = 0$ 或 $x = 0$ 时），那么单步更新是确定性的；在这种情况下，概率应为 $0$ 或 $1$，具体取决于确定性更新的符号。\n\n请使用以下测试套件。每个测试用例是一个元组 $(\\kappa,\\theta,\\sigma,x,h)$:\n- 测试用例 1：$(4.0, 0.04, 0.5, 0.04, 0.25)$。\n- 测试用例 2：$(1.2, 0.05, 0.3, 0.0, 0.1)$。\n- 测试用例 3：$(0.3, 0.02, 0.4, 0.02, 0.5)$。\n- 测试用例 4：$(10.0, 0.01, 0.0, 0.03, 0.2)$。\n\n为覆盖率而设计：\n- 测试用例 1 满足 Feller 条件 $2\\kappa\\theta \\ge \\sigma^2$ 且 $x > 0$，说明即使在这种情况下，Euler–Maruyama 方法也可能为负的下一步分配一个正概率。\n- 测试用例 2 从 $x = 0$ 开始，此时扩散项消失，单步格式在第一步是确定性的。\n- 测试用例 3 违反了 Feller 条件，且 $x > 0$，时间步长 $h$ 相对较大，说明其穿过零下方的概率更大。\n- 测试用例 4 中 $\\sigma = 0$，并选择了一个较大的时间步长 $h$，使得确定性的 Euler 步变为负值，尽管 $x \\ge 0$，但为负的概率为 1。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，顺序与测试套件相同，每个概率四舍五入到六位小数（例如，$[0.123456,0.000000,0.654321,1.000000]$）。", "solution": "该问题要求推导 Cox-Ingersoll-Ross (CIR) 过程的 Euler–Maruyama 离散化的单步为负概率。\n\nCIR 过程由以下随机微分方程 (SDE) 描述：\n$$\ndX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t\n$$\n其中 $X_t$ 是过程在时间 $t$ 的状态，$W_t$ 是标准布朗运动，参数 $\\kappa$、$\\theta$ 和 $\\sigma$ 是满足 $\\kappa > 0$、$\\theta > 0$ 和 $\\sigma \\ge 0$ 的常数。该过程从一个非负初始值 $X_0 \\ge 0$ 开始。\n\nEuler-Maruyama 数值格式通过将时间离散化为长度为 $h$ 的步长来近似 SDE 的解。对于一个一般的 Itô SDE $dY_t = a(Y_t, t)\\,dt + b(Y_t, t)\\,dW_t$，该格式由下式给出：\n$$\nY_{n+1} = Y_n + a(Y_n, t_n)h + b(Y_n, t_n)\\Delta W_n\n$$\n其中 $Y_n = Y_{t_n}$，$t_{n+1} = t_n + h$，$\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ 是布朗运动在该时间步长上的增量。布朗运动的一个基本性质是其增量服从正态分布，具体来说是 $\\Delta W_n \\sim N(0, h)$。\n\n对于 CIR 过程，漂移系数和扩散系数分别为 $a(x) = \\kappa(\\theta - x)$ 和 $b(x) = \\sigma \\sqrt{x}$。设过程的当前状态为 $X_n = x$，其中 $x \\ge 0$。应用 Euler-Maruyama 格式，下一个状态 $X_{n+1}$ 为：\n$$\nX_{n+1} = x + \\kappa(\\theta - x)h + \\sigma \\sqrt{x} \\Delta W_n\n$$\n我们需要找到下一个状态为负的概率，即 $P(X_{n+1} < 0)$。\n\n布朗增量 $\\Delta W_n$ 可以表示为 $\\sqrt{h}Z$，其中 $Z$ 是一个标准正态随机变量，$Z \\sim N(0, 1)$。将此代入 $X_{n+1}$ 的方程中，得到：\n$$\nX_{n+1} = x + \\kappa(\\theta - x)h + \\sigma \\sqrt{x} \\sqrt{h} Z\n$$\n我们想计算概率 $P(X_{n+1} < 0)$，这可以转化为：\n$$\nP(x + \\kappa(\\theta - x)h + \\sigma \\sqrt{x} \\sqrt{h} Z < 0)\n$$\n为了解决这个问题，我们必须根据扩散项系数的值分析两种不同的情况。\n\n**情况 1：非退化扩散（$\\sigma > 0$ 且 $x > 0$）**\n在这种情况下，随机变量 $Z$ 的系数，即 $\\sigma \\sqrt{x} \\sqrt{h}$，是严格为正的。我们可以重排不等式以分离出 $Z$：\n$$\n\\sigma \\sqrt{x} \\sqrt{h} Z < - (x + \\kappa(\\theta - x)h)\n$$\n$$\nZ < - \\frac{x + \\kappa(\\theta - x)h}{\\sigma \\sqrt{x} \\sqrt{h}}\n$$\n由于 $Z$ 是一个标准正态随机变量，对于某个常数 $c$，概率 $P(Z < c)$ 由标准正态分布的累积分布函数 (CDF) 给出，记为 $\\Phi(c)$。因此，$X_{n+1}$ 为负的概率是：\n$$\nP(X_{n+1} < 0) = \\Phi\\left(- \\frac{x + \\kappa(\\theta - x)h}{\\sigma \\sqrt{x} \\sqrt{h}}\\right)\n$$\n该表达式根据模型参数、当前状态和时间步长，利用所要求的正态分布的标准性质，给出了概率。\n\n**情况 2：退化扩散（$\\sigma = 0$ 或 $x = 0$）**\n在这种情况下，随机项 $\\sigma \\sqrt{x} \\sqrt{h}Z$ 消失，更新变为确定性的。\n$$\nX_{n+1} = x + \\kappa(\\theta - x)h\n$$\n$X_{n+1}$ 的值是固定的，所以它为负的概率要么是 $0$，要么是 $1$。\n\n子情况 2a：$x = 0$。\n更新方程简化为：\n$$\nX_{n+1} = 0 + \\kappa(\\theta - 0)h = \\kappa\\theta h\n$$\n考虑到约束条件 $\\kappa > 0$、$\\theta > 0$ 以及时间步长 $h > 0$ 的性质，结果 $\\kappa\\theta h$ 严格为正。因此，$X_{n+1} > 0$。下一个状态为负的概率为零。\n$$\nP(X_{n+1} < 0 \\mid x=0) = 0\n$$\n\n子情况 2b：$\\sigma = 0$（且 $x \\ge 0$）。\nSDE 变为一个常微分方程，$dX_t = \\kappa(\\theta - X_t)dt$，Euler 更新为：\n$$\nX_{n+1} = x + \\kappa(\\theta - x)h\n$$\n一个负步长的概率取决于这个确定性值的符号：\n$$\nP(X_{n+1} < 0 \\mid \\sigma=0) = \\begin{cases} 1 & \\text{如果 } x + \\kappa(\\theta - x)h < 0 \\\\ 0 & \\text{如果 } x + \\kappa(\\theta - x)h \\ge 0 \\end{cases}\n$$\n\n总而言之，概率 $P_{neg} = P(X_{n+1} < 0 \\mid X_n = x)$ 的计算方法如下：\n1.  如果 $\\sigma = 0$ 或 $x = 0$：\n    - 更新是确定性的：$X_{next} = x + \\kappa(\\theta - x)h$。\n    - 如果 $X_{next} < 0$，则 $P_{neg} = 1$。\n    - 如果 $X_{next} \\ge 0$，则 $P_{neg} = 0$。（注意：如前所示，如果 $x=0$，则 $X_{next} > 0$，所以 $P_{neg}=0$）\n2.  如果 $\\sigma > 0$ 且 $x > 0$：\n    - 概率由标准正态分布的 CDF 给出：\n    $$\n    P_{neg} = \\Phi\\left(- \\frac{x + \\kappa(\\theta - x)h}{\\sigma \\sqrt{x} \\sqrt{h}}\\right)\n    $$\n该公式为计算任何有效参数集的单步为负概率提供了一个完整的方法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Calculates the one-step negativity probability for the Euler-Maruyama\n    discretization of the Cox-Ingersoll-Ross (CIR) process for several\n    test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (kappa, theta, sigma, x, h)\n    test_cases = [\n        (4.0, 0.04, 0.5, 0.04, 0.25),  # Feller condition satisfied\n        (1.2, 0.05, 0.3, 0.0, 0.1),   # Starts at x=0 (degenerate case)\n        (0.3, 0.02, 0.4, 0.02, 0.5),   # Feller condition violated\n        (10.0, 0.01, 0.0, 0.03, 0.2),  # sigma=0 (degenerate case)\n    ]\n\n    string_results = []\n    for case in test_cases:\n        kappa, theta, sigma, x, h = case\n        \n        prob = 0.0\n\n        # Case 1: Degenerate diffusion term (sigma=0 or x=0)\n        # The update is deterministic.\n        if sigma == 0.0 or x == 0.0:\n            # Deterministic update: X_{n+1} = x + kappa * (theta - x) * h\n            next_val = x + kappa * (theta - x) * h\n            if next_val < 0:\n                prob = 1.0\n            else:\n                prob = 0.0\n        \n        # Case 2: Non-degenerate diffusion term (sigma > 0 and x > 0)\n        # The update is stochastic.\n        else:\n            # Argument for the standard normal CDF\n            # C = - (x + kappa*(theta - x)*h) / (sigma * sqrt(x*h))\n            numerator = x + kappa * (theta - x) * h\n            denominator = sigma * np.sqrt(x * h)\n            \n            # The problem of division by zero in the denominator is already\n            # handled by the check for x=0.\n            cdf_arg = -numerator / denominator\n            \n            # The probability is the CDF of the standard normal distribution.\n            prob = norm.cdf(cdf_arg)\n            \n        string_results.append(f\"{prob:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(string_results)}]\")\n\nsolve()\n```", "id": "3047714"}, {"introduction": "认识到基础数值方法的局限性后，我们自然会寻求更稳健的解决方案。[@problem_id:3047714] 练习揭示了欧拉-丸山法可能产生负值的问题，而本练习将介绍一种专门为此设计的改进方案——全截断欧拉（FTE）格式。通过理解其工作机制，你将掌握一种为非负随机过程（如 CIR 模型）构建可靠模拟方法的关键技术。", "problem": "考虑Cox-Ingersoll-Ross过程，其定义为随机微分方程（SDE）\n$$\ndX_t = \\kappa\\big(\\theta - X_t\\big)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t,\\qquad X_0\\ge 0,\n$$\n的解，其中$\\kappa>0$，$\\theta\\ge 0$，和$\\sigma>0$是常数，并且$(W_t)_{t\\ge 0}$是标准布朗运动。已知其精确解是非负的，并且在Feller条件$2\\kappa\\theta\\ge \\sigma^2$下是严格为正的。然而，在显式数值模拟中，朴素的近似可能会取负值，这是有问题的，因为扩散系数使用了$\\sqrt{X_t}$。\n\n请您确定用于在均匀网格$t_n = n\\,\\Delta t$上近似Cox-Ingersoll-Ross过程的完全截断欧拉（Full Truncation Euler, FTE）离散格式的正确描述，其中高斯增量是独立的，即$\\Delta W_n = W_{t_{n+1}} - W_{t_n}\\sim\\mathcal{N}(0,\\Delta t)$。特别地，选择一个既正确指定了该格式，又正确解释了数值近似在何种意义上保持非负性的陈述。\n\n哪个选项是正确的？\n\nA. 定义$x^+ = \\max(x,0)$。该格式为：计算一个临时更新\n$$\n\\widetilde{X}_{n+1} = X_n + \\kappa\\big(\\theta - X_n^+\\big)\\,\\Delta t + \\sigma \\sqrt{X_n^+}\\,\\Delta W_n,\n$$\n然后通过设置\n$$\nX_{n+1} = \\max\\big(\\widetilde{X}_{n+1},\\,0\\big).\n$$\n将其投影到非负轴上。\n这保持了数值近似的非负性，因为投影确保了对所有$n$都有$X_{n+1}\\ge 0$，并且在系数中使用$X_n^+$保证了平方根总是在非负值上进行计算。\n\nB. 该格式仅在扩散项中使用截断：\n$$\nX_{n+1} = X_n + \\kappa\\big(\\theta - X_n\\big)\\,\\Delta t + \\sigma \\sqrt{X_n^+}\\,\\Delta W_n.\n$$\n每当$2\\kappa\\theta\\ge \\sigma^2$时，该格式都能保持非负性，因为Feller条件确保了精确过程的正性，因此也确保了对于任何时间步长$\\Delta t>0$的离散近似的正性。\n\nC. 该格式是隐式的：\n$$\nX_{n+1} = X_n + \\kappa\\big(\\theta - X_{n+1}\\big)\\,\\Delta t + \\sigma \\sqrt{X_{n+1}}\\,\\Delta W_n,\n$$\n并且“完全截断”意味着在每一步都精确求解这个非线性方程。非负性得以保持，因为平方根是在$X_{n+1}$上求值的，这迫使$X_{n+1}\\ge 0$。\n\nD. 该格式通过绝对值来反射负值：\n$$\nX_{n+1} = \\big|\\,X_n + \\kappa(\\theta - X_n)\\,\\Delta t + \\sigma \\sqrt{X_n}\\,\\Delta W_n\\,\\big|.\n$$\n这保持了非负性，因为任何负的更新都被翻转为正值，因此平方根在其后是良定义的。", "solution": "评估问题陈述的有效性。\n\n**步骤1：提取给定信息**\n-   过程：Cox-Ingersoll-Ross (CIR)\n-   SDE: $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t$\n-   初始条件: $X_0 \\ge 0$\n-   参数: $\\kappa>0$, $\\theta\\ge 0$, $\\sigma>0$\n-   随机驱动项: $(W_t)_{t \\ge 0}$ 是标准布朗运动。\n-   已知性质1: 精确解 $X_t$ 是非负的。\n-   已知性质2 (Feller条件): $2\\kappa\\theta\\ge \\sigma^2$ 意味着精确解是严格为正的。\n-   数值背景: 在均匀网格 $t_n = n\\,\\Delta t$ 上对SDE进行显式模拟，其中高斯增量是独立的，即 $\\Delta W_n \\sim\\mathcal{N}(0,\\Delta t)$。\n-   问题来源: 朴素近似可能产生负值，使得 $\\sqrt{X_t}$ 未定义。\n-   问题: 确定完全截断欧拉 (FTE) 离散格式的正确描述及其保持非负性的机制。\n\n**步骤2：使用提取的给定信息进行验证**\n-   **科学依据：** 该问题牢固地植根于随机微分方程数值解这一成熟领域，特别是关于广泛使用的Cox-Ingersoll-Ross模型。SDE、Feller条件以及所描述的数值挑战都是计算金融与随机分析中的标准且事实正确的主题。\n-   **良态性：** 问题是具体的，要求确定一个名为“完全截断欧拉”方法的数值格式的定义和性质。该术语在相关文献中具有标准含义，使得问题可回答且无歧义。\n-   **客观性：** 语言是技术性和精确的。问题要求确定一个形式化的定义和一个因果机制，这些都是客观问题。\n\n**步骤3：结论与行动**\n-   **结论：** 问题是有效的。它具有科学合理性、良态性、客观性，并包含继续进行所需的所有必要信息。\n-   **行动：** 继续对选项进行全面推导和分析。\n\nCox-Ingersoll-Ross (CIR) 过程由以下SDE给出：\n$$\ndX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t\n$$\n在网格 $t_n = n\\Delta t$ 上的一个朴素的Euler-Maruyama离散格式是：\n$$\nX_{n+1} = X_n + \\kappa(\\theta - X_n)\\,\\Delta t + \\sigma \\sqrt{X_n}\\,\\Delta W_n\n$$\n其中 $\\Delta W_n \\sim \\mathcal{N}(0, \\Delta t)$。项 $\\Delta W_n$ 可以是负数且量级很大，导致总和为负，尤其是在 $X_n$ 接近0时。如果 $X_{n+1}$ 变为负数，项 $\\sqrt{X_{n+1}}$ 在接下来的步骤 $n+2$ 中没有良好定义，导致模拟失败。人们已经开发了各种格式来解决这个问题。问题要求确定“完全截断欧拉” (FTE) 格式。这个名称表明了为强制实现非负性而全面应用截断。\n\n我们来分析各个选项。\n\n**选项A**\n该格式被指定为一个两步过程：\n1.  计算一个临时值 $\\widetilde{X}_{n+1} = X_n + \\kappa(\\theta - X_n^+)\\,\\Delta t + \\sigma \\sqrt{X_n^+}\\,\\Delta W_n$。\n2.  将最终值设置为 $X_{n+1} = \\max(\\widetilde{X}_{n+1}, 0)$。\n\n这里，$X_n^+ = \\max(X_n, 0)$。这种表述是完全截断欧拉格式的标准形式，也称为投影欧拉格式。我们来分析其性质和给定的解释。\n\n该过程从 $X_0 \\ge 0$ 开始。在步骤 $n$，我们假设 $X_n \\ge 0$。\n- 更新的系数是使用 $X_n^+$ 计算的。由于我们假设 $X_n \\ge 0$，我们有 $X_n^+ = X_n$。这意味着项 $\\sqrt{X_n^+}$ 只是 $\\sqrt{X_n}$ 并且总是良定义的。使用正部 $X_n^+$ 是一种保障措施，并使定义更加稳健。\n- 如前所述，临时值 $\\widetilde{X}_{n+1}$ 可以是负的。\n- 最后一步，$X_{n+1} = \\max(\\widetilde{X}_{n+1}, 0)$，将（可能为负的）临时值显式地投影到非负实轴上。根据定义，这保证了 $X_{n+1} \\ge 0$。\n\n提供的解释是：“这保持了数值近似的非负性，因为投影确保了对所有$n$都有$X_{n+1}\\ge 0$，并且在系数中使用$X_n^+$保证了平方根总是在非负值上进行计算。” 这是对该机制完整而正确的描述。该格式确保了每一步都有有效的输入（通过 $X_n^+$）和非负的输出（通过 $\\max(\\cdot, 0)$）。\n**结论：正确**\n\n**选项B**\n该格式被指定为：\n$$\nX_{n+1} = X_n + \\kappa( \\theta - X_n)\\,\\Delta t + \\sigma \\sqrt{X_n^+}\\,\\Delta W_n\n$$\n该格式被称为*部分截断*格式或Higham-Mao格式。它只截断了扩散系数的参数。该格式仍然可能产生负的 $X_{n+1}$ 值，因为没有机制阻止总和变为负数。因此，“完全截断”这个名称不合适。\n\n给出的解释是，在Feller条件 $2\\kappa\\theta \\ge \\sigma^2$ 下，非负性得以保持。这是不正确的。Feller条件保证的是*连续时间精确过程* $X_t$ 的路径正性，而不是其对于有限时间步长 $\\Delta t > 0$ 的离散欧拉型近似。一个众所周知的事实是，无论Feller条件是否成立，该格式在模拟中都可能并且确实会产生负值。\n**结论：错误**\n\n**选项C**\n该格式被指定为一个隐式方程：\n$$\nX_{n+1} = X_n + \\kappa(\\theta - X_{n+1})\\,\\Delta t + \\sigma \\sqrt{X_{n+1}}\\,\\Delta W_n\n$$\n这是一个*隐式欧拉格式*。“完全截断欧拉”格式是一个*显式*格式。因此，该选项错误地识别了格式。此外，关于非负性得以保持是因为方程中出现了 $\\sqrt{X_{n+1}}$ 的解释是有问题的。虽然任何实数解 $X_{n+1}$ 都必须是非负的，但对于 $\\Delta W_n$ 的任何实现，这样一个实数解的存在性和唯一性都不能得到保证。对于一个大的负值 $\\Delta W_n$，可能不存在 $X_{n+1}$ 的实数解。\n**结论：错误**\n\n**选项D**\n该格式被指定为：\n$$\nX_{n+1} = \\big|\\,X_n + \\kappa(\\theta - X_n)\\,\\Delta t + \\sigma \\sqrt{X_n}\\,\\Delta W_n\\,\\big|\n$$\n该格式被称为*反射欧拉格式*。它通过取更新值的绝对值来强制实现非负性。它在边界 $X=0$ 附近的动力学行为与截断格式（它将值设为0，从而暂时在边界上吸收过程）不同。“完全截断”这个名称与反射操作（取绝对值）不一致。虽然该格式确实保持了非负性，但它不是问题所要求的格式。\n**结论：错误**\n\n总而言之，选项A既为完全截断欧拉格式提供了正确的定义，也为其如何稳健地保持近似过程的非负性提供了正确的解释。", "answer": "$$\\boxed{A}$$", "id": "3047718"}]}