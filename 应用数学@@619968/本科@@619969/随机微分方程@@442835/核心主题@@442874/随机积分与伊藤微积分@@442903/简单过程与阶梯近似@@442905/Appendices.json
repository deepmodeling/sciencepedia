{"hands_on_practices": [{"introduction": "将理论转化为实践的第一步是理解如何将连续的随机微分方程 (SDE) 离散化为可计算的步骤。这个练习将几何布朗运动作为典型例子，指导你应用欧拉-丸山格式来构建其单步近似 $X_{k+1}$。通过计算其条件期望 $\\mathbb{E}[X_{k+1} \\mid X_k]$ 和条件方差 $\\operatorname{Var}(X_{k+1} \\mid X_k)$，你将能揭示该数值格式在每一步的局部统计特性，这是理解随机过程模拟和收敛性分析的基石。[@problem_id:3074485]", "problem": "考虑由随机微分方程 (SDE) $dX_t=\\mu X_t\\,dt+\\sigma X_t\\,dW_t$ 定义的几何布朗运动 (GBM)，其中 $W_t$ 是标准布朗运动，$\\mu, \\sigma$ 是实数常量。令 $\\{t_k\\}_{k\\ge 0}$ 为一个步长为 $\\Delta t>0$ 的均匀时间网格，使得 $t_{k+1}-t_k=\\Delta t$，并定义布朗增量为 $\\Delta W_k:=W_{t_{k+1}}-W_{t_k}$。使用 Euler–Maruyama 时间步进格式，写出 $X_{k+1}$ 关于 $X_k$、$\\Delta t$ 和 $\\Delta W_k$ 的单步近似，然后显式计算条件期望 $\\mathbb{E}[X_{k+1}\\mid X_k]$ 和条件方差 $\\operatorname{Var}(X_{k+1}\\mid X_k)$。你可以使用布朗运动具有独立增量这一事实，以及 $\\Delta W_k\\sim \\mathcal{N}(0,\\Delta t)$（一个均值为零、方差为 $\\Delta t$ 的正态随机变量），且独立于直到时间 $t_k$ 的滤子 $\\mathcal{F}_{t_k}$。最终答案应以两个闭式解析表达式的形式给出。无需四舍五入。", "solution": "用户提供了一个需要分析几何布朗运动过程的 Euler-Maruyama 离散化的问题。\n\n首先根据所需标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 几何布朗运动 (GBM) 的随机微分方程 (SDE) 是 $dX_t=\\mu X_t\\,dt+\\sigma X_t\\,dW_t$。\n- $W_t$ 是标准布朗运动。\n- $\\mu$ 和 $\\sigma$ 是实数常量。\n- $\\{t_k\\}_{k\\ge 0}$ 是一个步长为 $\\Delta t > 0$ 的均匀时间网格，其中 $t_{k+1}-t_k=\\Delta t$。\n- 布朗增量定义为 $\\Delta W_k:=W_{t_{k+1}}-W_{t_k}$。\n- 要使用的数值方法是 Euler–Maruyama 时间步进格式。\n- 目标是计算条件期望 $\\mathbb{E}[X_{k+1}\\mid X_k]$ 和条件方差 $\\operatorname{Var}(X_{k+1}\\mid X_k)$。\n- 已知布朗运动具有独立增量。\n- 已知 $\\Delta W_k$ 服从均值为 0、方差为 $\\Delta t$ 的正态分布，记作 $\\Delta W_k\\sim \\mathcal{N}(0,\\Delta t)$。\n- 已知 $\\Delta W_k$ 独立于滤子 $\\mathcal{F}_{t_k}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于几何布朗运动的标准模型和 Euler-Maruyama 方法，这两者都是随机微分方程和量化金融领域基本且成熟的概念。所引用的布朗运动的性质是正确的。该问题在科学上是合理的。\n- **适定性**：问题陈述清晰，并提供了所有必要信息。任务是根据给定信息推导出两个具体的、定义明确的量。可以确定唯一的解析解。\n- **客观性**：该问题以精确、形式化的数学语言陈述，没有任何主观或模糊的术语。\n\n### 步骤 3：结论与行动\n问题是有效的。这是研究随机微分方程数值解的一个标准练习。可以继续求解过程。\n\n### 解题推导\n\n几何布朗运动的 SDE 由下式给出：\n$$dX_t = \\mu X_t dt + \\sigma X_t dW_t$$\n对于一个时间步长 $\\Delta t = t_{k+1} - t_k$ 上的 SDE $dY_t = a(t, Y_t)dt + b(t, Y_t)dW_t$，其 Euler-Maruyama 近似的通用形式为：\n$$Y_{k+1} = Y_k + a(t_k, Y_k)\\Delta t + b(t_k, Y_k) \\Delta W_k$$\n其中 $Y_k \\approx Y_{t_k}$ 且 $\\Delta W_k = W_{t_{k+1}} - W_{t_k}$。\n\n对于给定的 GBM，漂移系数为 $a(t, X_t) = \\mu X_t$，扩散系数为 $b(t, X_t) = \\sigma X_t$。应用 Euler-Maruyama 格式，我们将这些系数代入通用公式，得到 $X_{k+1}$ 的单步近似：\n$$X_{k+1} = X_k + (\\mu X_k)\\Delta t + (\\sigma X_k)\\Delta W_k$$\n从右侧提出因子 $X_k$ 得到所需的 $X_{k+1}$ 关于 $X_k$、$\\Delta t$ 和 $\\Delta W_k$ 的表达式：\n$$X_{k+1} = X_k(1 + \\mu \\Delta t + \\sigma \\Delta W_k)$$\n\n接下来，我们计算条件期望 $\\mathbb{E}[X_{k+1} \\mid X_k]$。记号 $\\mathbb{E}[\\cdot \\mid X_k]$ 意味着以过程在时间 $t_k$ 的值为条件。由于 $X_k$ 在时间 $t_k$ 是已知的（即，它是 $\\mathcal{F}_{t_k}$-可测的），因此在条件期望中可以将其视为常数。\n$$\\mathbb{E}[X_{k+1} \\mid X_k] = \\mathbb{E}[X_k(1 + \\mu \\Delta t + \\sigma \\Delta W_k) \\mid X_k]$$\n使用期望的线性和对于已知值 $A$ 的属性 $\\mathbb{E}[A Y \\mid A] = A \\mathbb{E}[Y \\mid A]$：\n$$\\mathbb{E}[X_{k+1} \\mid X_k] = X_k \\mathbb{E}[1 + \\mu \\Delta t + \\sigma \\Delta W_k \\mid X_k]$$\n$$\\mathbb{E}[X_{k+1} \\mid X_k] = X_k ( \\mathbb{E}[1 \\mid X_k] + \\mathbb{E}[\\mu \\Delta t \\mid X_k] + \\mathbb{E}[\\sigma \\Delta W_k \\mid X_k] )$$\n项 $1$、$\\mu$ 和 $\\Delta t$ 是确定性常数。项 $\\sigma$ 也是一个常数。\n$$\\mathbb{E}[X_{k+1} \\mid X_k] = X_k (1 + \\mu \\Delta t + \\sigma \\mathbb{E}[\\Delta W_k \\mid X_k])$$\n我们已知增量 $\\Delta W_k$ 独立于滤子 $\\mathcal{F}_{t_k}$，并且由于 $X_k$ 是 $\\mathcal{F}_{t_k}$-可测的，所以 $\\Delta W_k$ 独立于 $X_k$。因此，$\\Delta W_k$ 的条件期望等于其无条件期望：\n$$\\mathbb{E}[\\Delta W_k \\mid X_k] = \\mathbb{E}[\\Delta W_k]$$\n我们已知 $\\Delta W_k \\sim \\mathcal{N}(0, \\Delta t)$，这意味着其均值为 0。\n$$\\mathbb{E}[\\Delta W_k] = 0$$\n将此结果代回 $X_{k+1}$ 的条件期望表达式中：\n$$\\mathbb{E}[X_{k+1} \\mid X_k] = X_k(1 + \\mu \\Delta t + \\sigma \\cdot 0) = X_k(1 + \\mu \\Delta t)$$\n\n最后，我们计算条件方差 $\\operatorname{Var}(X_{k+1} \\mid X_k)$。条件方差的定义是：\n$$\\operatorname{Var}(Y \\mid Z) = \\mathbb{E}[(Y - \\mathbb{E}[Y \\mid Z])^2 \\mid Z]$$\n在我们的例子中，$Y = X_{k+1}$ 且 $Z = X_k$。\n$$\\operatorname{Var}(X_{k+1} \\mid X_k) = \\mathbb{E}[(X_{k+1} - \\mathbb{E}[X_{k+1} \\mid X_k])^2 \\mid X_k]$$\n我们首先找出平方内的项：\n$$X_{k+1} - \\mathbb{E}[X_{k+1} \\mid X_k] = X_k(1 + \\mu \\Delta t + \\sigma \\Delta W_k) - X_k(1 + \\mu \\Delta t)$$\n$$X_{k+1} - \\mathbb{E}[X_{k+1} \\mid X_k] = X_k + X_k \\mu \\Delta t + X_k \\sigma \\Delta W_k - X_k - X_k \\mu \\Delta t$$\n$$X_{k+1} - \\mathbb{E}[X_{k+1} \\mid X_k] = X_k \\sigma \\Delta W_k$$\n现在，将此代回方差公式：\n$$\\operatorname{Var}(X_{k+1} \\mid X_k) = \\mathbb{E}[(X_k \\sigma \\Delta W_k)^2 \\mid X_k] = \\mathbb{E}[X_k^2 \\sigma^2 (\\Delta W_k)^2 \\mid X_k]$$\n由于在给定条件下 $X_k$ 和 $\\sigma$ 是已知的，我们可以将它们从期望中提出来：\n$$\\operatorname{Var}(X_{k+1} \\mid X_k) = X_k^2 \\sigma^2 \\mathbb{E}[(\\Delta W_k)^2 \\mid X_k]$$\n由于 $\\Delta W_k$ 和 $X_k$ 的独立性：\n$$\\mathbb{E}[(\\Delta W_k)^2 \\mid X_k] = \\mathbb{E}[(\\Delta W_k)^2]$$\n任何随机变量 $Z$ 的方差由 $\\operatorname{Var}(Z) = \\mathbb{E}[Z^2] - (\\mathbb{E}[Z])^2$ 给出。对于 $Z = \\Delta W_k$，我们知道 $\\operatorname{Var}(\\Delta W_k) = \\Delta t$ 且 $\\mathbb{E}[\\Delta W_k] = 0$。\n$$\\Delta t = \\mathbb{E}[(\\Delta W_k)^2] - (0)^2 \\implies \\mathbb{E}[(\\Delta W_k)^2] = \\Delta t$$\n将此结果代入条件方差的表达式中：\n$$\\operatorname{Var}(X_{k+1} \\mid X_k) = X_k^2 \\sigma^2 \\Delta t$$\n为清晰起见，使用标准约定重写，方差为 $\\sigma^2 X_k^2 \\Delta t$。\n\n所要求的两个表达式是条件期望 $\\mathbb{E}[X_{k+1}\\mid X_k] = X_k(1 + \\mu \\Delta t)$ 和条件方差 $\\operatorname{Var}(X_{k+1}\\mid X_k) = \\sigma^2 X_k^2 \\Delta t$。", "answer": "$$\n\\boxed{X_k(1 + \\mu \\Delta t), \\quad \\sigma^2 X_k^2 \\Delta t}\n$$", "id": "3074485"}, {"introduction": "理解了单个离散步骤后，我们进而探索这些步骤的累积效应如何构成了随机积分 $\\int X_t \\, dW_t$ 的基石。本练习引导你从离散求和的第一性原理出发，推导随机分部积分公式，并在此过程中识别出区分随机微积分与经典微积分的关键——二次协变差项 $[X,W]_T$。完成这个推导将让你深刻理解 Itô 微积分独特规则的起源，特别是著名的“Itô 修正项”为何是不可或缺的。[@problem_id:3074507]", "problem": "考虑一个带滤概率空间，其上支撑一个标准布朗运动（Wiener过程）$W=\\{W_t\\}_{t\\in[0,T]}$，该空间具有其自然滤子，其中 $T>0$ 是一个固定的值。令 $X=\\{X_t\\}_{t\\in[0,T]}$ 为一个连续、适应的半鞅。随机积分 $\\int_{0}^{T} X_t\\,dW_t$ 定义为左点黎曼和的依概率极限\n$$\nS^{(n)}(X,W):=\\sum_{i=0}^{n-1} X_{t_i}\\bigl(W_{t_{i+1}}-W_{t_i}\\bigr),\n$$\n其中 $\\{t_i\\}_{i=0}^{n}$ 是 $[0,T]$ 的一个分割，当 $n\\to\\infty$ 时，其网格尺寸趋于 $0$。二次协变差 $[X,W]_T$ 定义为如下和式的依概率极限\n$$\nC^{(n)}(X,W):=\\sum_{i=0}^{n-1}\\bigl(X_{t_{i+1}}-X_{t_i}\\bigr)\\bigl(W_{t_{i+1}}-W_{t_i}\\bigr).\n$$\n从这些定义以及路径乘积 $X_t W_t$ 增量的乘积法则出发，推导一个 $S^{(n)}(X,W)$ 的离散分部积分表示，该表示将 $\\int_{0}^{T} X_t\\,dW_t$ 用 $\\int_{0}^{T} W_t\\,dX_t$ 和一个修正项表示。你必须在网格尺寸趋于 $0$ 的极限下，将该修正项识别为二次协变差 $[X,W]_T$。然后，将情况特殊化到 $X_t=W_t$，并以 $W_T$ 和 $T$ 的函数形式，显式地计算随机积分 $\\int_{0}^{T} W_t\\,dW_t$ 的闭式解。\n\n你的最终答案必须是单个闭式解析表达式。无需四舍五入，也不涉及单位。", "solution": "问题陈述是有效的，因为它在科学上基于已建立的随机微积分理论，问题设定良好且目标明确，并使用精确、客观的数学语言进行表述。我们可以开始求解。\n\n该问题要求从离散和近似出发，推导随机积分的分部积分公式，然后应用该公式计算 $\\int_{0}^{T} W_t\\,dW_t$。\n\n令 $\\{t_i\\}_{i=0}^{n}$ 为区间 $[0,T]$ 的一个分割，使得 $0=t_0  t_1  \\dots  t_n = T$。令 $\\Delta X_i = X_{t_{i+1}} - X_{t_i}$ 和 $\\Delta W_i = W_{t_{i+1}} - W_{t_i}$ 分别为过程 $X$ 和 $W$ 在区间 $[t_i, t_{i+1}]$ 上的增量。\n\n我们首先考虑乘积 $X_t W_t$ 在子区间 $[t_i, t_{i+1}]$ 上的增量：\n$$ X_{t_{i+1}}W_{t_{i+1}} - X_{t_i}W_{t_i} $$\n由于 $X_{t_{i+1}} = X_{t_i} + \\Delta X_i$ 且 $W_{t_{i+1}} = W_{t_i} + \\Delta W_i$，我们可以将乘积 $X_{t_{i+1}}W_{t_{i+1}}$ 展开为：\n$$ X_{t_{i+1}}W_{t_{i+1}} = (X_{t_i} + \\Delta X_i)(W_{t_i} + \\Delta W_i) = X_{t_i}W_{t_i} + X_{t_i}\\Delta W_i + W_{t_i}\\Delta X_i + \\Delta X_i \\Delta W_i $$\n重新整理该方程，我们得到乘积增量的精确恒等式：\n$$ X_{t_{i+1}}W_{t_{i+1}} - X_{t_i}W_{t_i} = X_{t_i}\\Delta W_i + W_{t_i}\\Delta X_i + \\Delta X_i \\Delta W_i $$\n这个恒等式对任意两个函数（无论是随机的还是确定性的）都逐路径成立。\n\n接下来，我们将此恒等式对分割的所有子区间（从 $i=0$ 到 $n-1$）求和：\n$$ \\sum_{i=0}^{n-1} (X_{t_{i+1}}W_{t_{i+1}} - X_{t_i}W_{t_i}) = \\sum_{i=0}^{n-1} X_{t_i}\\Delta W_i + \\sum_{i=0}^{n-1} W_{t_i}\\Delta X_i + \\sum_{i=0}^{n-1} \\Delta X_i \\Delta W_i $$\n左边是一个伸缩求和：\n$$ \\sum_{i=0}^{n-1} (X_{t_{i+1}}W_{t_{i+1}} - X_{t_i}W_{t_i}) = (X_{t_1}W_{t_1} - X_{t_0}W_{t_0}) + (X_{t_2}W_{t_2} - X_{t_1}W_{t_1}) + \\dots + (X_{t_n}W_{t_n} - X_{t_{n-1}}W_{t_{n-1}}) = X_{t_n}W_{t_n} - X_{t_0}W_{t_0} = X_T W_T - X_0 W_0 $$\n右边的各项对应于问题陈述中给出的离散近似。第一项是 $X$ 对 $W$ 积分的左点黎曼和：\n$$ S^{(n)}(X,W) = \\sum_{i=0}^{n-1} X_{t_i}\\Delta W_i = \\sum_{i=0}^{n-1} X_{t_i}(W_{t_{i+1}}-W_{t_i}) $$\n第二项是 $W$ 对 $X$ 积分的左点黎曼和：\n$$ S^{(n)}(W,X) = \\sum_{i=0}^{n-1} W_{t_i}\\Delta X_i = \\sum_{i=0}^{n-1} W_{t_i}(X_{t_{i+1}}-X_{t_i}) $$\n第三项是二次协变差的离散近似：\n$$ C^{(n)}(X,W) = \\sum_{i=0}^{n-1} \\Delta X_i \\Delta W_i = \\sum_{i=0}^{n-1} (X_{t_{i+1}}-X_{t_i})(W_{t_{i+1}}-W_{t_i}) $$\n将这些代入求和后的恒等式中，我们得到：\n$$ X_T W_T - X_0 W_0 = S^{(n)}(X,W) + S^{(n)}(W,X) + C^{(n)}(X,W) $$\n问题要求给出 $S^{(n)}(X,W)$ 的一个离散表示。重新整理上述方程可得：\n$$ S^{(n)}(X,W) = (X_T W_T - X_0 W_0) - S^{(n)}(W,X) - C^{(n)}(X,W) $$\n现在，我们取分割的网格尺寸 $\\|P_n\\| = \\max_i(t_{i+1}-t_i)$ 趋于 $0$ 的极限。根据所提供的定义以及半鞅的性质，这些和依概率收敛于它们对应的连续时间对象：\n$$ \\lim_{\\|P_n\\|\\to 0} S^{(n)}(X,W) = \\int_{0}^{T} X_t\\,dW_t $$\n$$ \\lim_{\\|P_n\\|\\to 0} S^{(n)}(W,X) = \\int_{0}^{T} W_t\\,dX_t $$\n$$ \\lim_{\\|P_n\\|\\to 0} C^{(n)}(X,W) = [X,W]_T $$\n对 $S^{(n)}(X,W)$ 的离散表示取极限，得到连续的分部积分公式：\n$$ \\int_{0}^{T} X_t\\,dW_t = X_T W_T - X_0 W_0 - \\int_{0}^{T} W_t\\,dX_t - [X,W]_T $$\n该公式将 $\\int_{0}^{T} X_t\\,dW_t$ 用 $\\int_{0}^{T} W_t\\,dX_t$ 和其他项表示。项 $[X,W]_T$ 是二次协变差，它是区分随机微积分与经典 Riemann-Stieltjes 积分（对于有界变差函数，该项为零）的关键修正项。\n\n现在，我们将情况特殊化到 $X_t = W_t$。分部积分公式变为：\n$$ \\int_{0}^{T} W_t\\,dW_t = W_T W_T - W_0 W_0 - \\int_{0}^{T} W_t\\,dW_t - [W,W]_T $$\n按照惯例，标准布朗运动从原点开始，所以 $W_0 = 0$。方程简化为：\n$$ \\int_{0}^{T} W_t\\,dW_t = W_T^2 - \\int_{0}^{T} W_t\\,dW_t - [W,W]_T $$\n重新整理以求解该积分：\n$$ 2\\int_{0}^{T} W_t\\,dW_t = W_T^2 - [W,W]_T $$\n项 $[W,W]_T$ 是布朗运动 $W$ 在 $[0,T]$ 上的二次变差。一个标准结果是 $[W,W]_T = T$。这可以从所提供的定义中得出。和 $C^{(n)}(W,W) = \\sum_{i=0}^{n-1} (W_{t_{i+1}}-W_{t_i})^2$ 的期望为 $E[\\sum_{i=0}^{n-1} (W_{t_{i+1}}-W_{t_i})^2] = \\sum_{i=0}^{n-1} E[(W_{t_{i+1}}-W_{t_i})^2] = \\sum_{i=0}^{n-1} (t_{i+1}-t_i) = T$。可以证明，当网格尺寸趋于 $0$ 时，该和的方差也趋于 $0$，这意味着该和依概率收敛于其期望值 $T$。\n将 $[W,W]_T = T$ 代入我们的方程中：\n$$ 2\\int_{0}^{T} W_t\\,dW_t = W_T^2 - T $$\n最后，解出该随机积分，我们得到闭式表达式：\n$$ \\int_{0}^{T} W_t\\,dW_t = \\frac{1}{2}(W_T^2 - T) $$\n这个结果是 Itô 公式应用于函数 $f(x) = x^2/2$ 的一个特例，但这里是按照问题的要求，从离散和近似的第一性原理推导出来的。", "answer": "$$\\boxed{\\frac{1}{2}(W_T^2 - T)}$$", "id": "3074507"}, {"introduction": "数值方法是强大的工具，但并非完美无瑕，理解其局限性至关重要。本练习探讨了欧拉-丸山格式的一个关键缺陷：即使随机微分方程的精确解 $X_t$ 具有某种重要性质（如正定性），其数值近似 $X_n$ 也未必能继承。通过分析高斯增量 $\\Delta W_n$ 的无界性，你将理解为什么这种看似简单的近似方法可能会产生与真实解在性质上截然不同的结果，从而培养对数值方法批判性思考的能力。[@problem_id:3074530]", "problem": "考虑标量 Itô 随机微分方程 (SDE)\n$$\ndX_t \\;=\\; a\\!\\left(X_t\\right)\\,dt \\;+\\; b\\!\\left(X_t\\right)\\,dW_t,\\qquad X_0 \\ge 0,\n$$\n由标准布朗运动 $W_t$ 驱动。假设在关于 $a(\\cdot)$ 和 $b(\\cdot)$ 的适当条件下，当 $X_0>0$ 时，对于所有 $t>0$，其精确解 $(X_t)_{t\\ge 0}$ 几乎必然是严格为正的。\n\n步长为 $\\Delta t>0$ 的 Euler–Maruyama 时间离散化通过以下方式构造了对 $(X_{t_n})$ 的阶梯近似 $(X_n)_{n\\in\\mathbb{N}}$，其中 $t_n = n\\,\\Delta t$：\n$$\nX_{n+1} \\;=\\; X_n \\;+\\; a\\!\\left(X_n\\right)\\,\\Delta t \\;+\\; b\\!\\left(X_n\\right)\\,\\Delta W_n,\n$$\n其中 $\\Delta W_n := W_{t_{n+1}} - W_{t_n} \\sim \\mathcal{N}(0,\\Delta t)$ 在 $n$ 上是独立的。\n\n关于 Euler–Maruyama 方法对 $X_n$ 的正性保持，以下哪个陈述是正确的？选择所有适用项。\n\nA. 对于几何布朗运动 SDE $dX_t = \\mu\\,X_t\\,dt + \\sigma\\,X_t\\,dW_t$ 且 $X_0>0$，Euler–Maruyama 方法对于任意 $\\Delta t>0$ 和任意实数参数 $\\mu$ 和 $\\sigma$ 几乎必然保持正性。\n\nB. 如果对于所有 $x \\ge 0$ 都有 $b(x) = 0$ 且 $a(x) \\ge 0$，那么从任意 $X_0 \\ge 0$ 开始，对于任意 $\\Delta t>0$，Euler–Maruyama 迭代值几乎必然满足对所有 $n$ 都有 $X_n \\ge 0$。\n\nC. 对于 Cox–Ingersoll–Ross SDE $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma\\sqrt{X_t}\\,dW_t$，其参数满足 Feller 条件 $2\\kappa\\theta \\ge \\sigma^2$ 且 $X_0>0$ 时，其精确解对所有 $t>0$ 都是严格为正的，但对于任何固定的 $\\Delta t>0$，Euler–Maruyama 方法会以正概率产生负值。\n\nD. 存在一个足够小的步长 $\\Delta t_0>0$（仅取决于系数），使得对于所有 $\\Delta t \\in (0,\\Delta t_0)$，Euler–Maruyama 方法对每个其精确解对于 $t>0$ 几乎必然为正的 Itô SDE 几乎必然地保持正性。\n\n基于 Euler–Maruyama 构造的第一性原理和布朗增量的分布特性，为每个选项提供简要的理由，并找出一个具体的反例，说明尽管 SDE 具有严格为正的解，Euler–Maruyama 方法却未能保持正性。", "solution": "在进行解答之前，对问题陈述进行了严格验证。\n\n### 步骤 1：提取已知条件\n-   给定标量 Itô 随机微分方程 (SDE)：\n    $$\n    dX_t \\;=\\; a\\!\\left(X_t\\right)\\,dt \\;+\\; b\\!\\left(X_t\\right)\\,dW_t,\\qquad X_0 \\ge 0\n    $$\n-   $W_t$ 是标准布朗运动。\n-   假设：当 $X_0>0$ 时，对于所有 $t>0$，精确解 $(X_t)_{t\\ge 0}$ 几乎必然是严格为正的。\n-   Euler–Maruyama (EM) 时间离散化为：\n    $$\n    X_{n+1} \\;=\\; X_n \\;+\\; a\\!\\left(X_n\\right)\\,\\Delta t \\;+\\; b\\!\\left(X_n\\right)\\,\\Delta W_n\n    $$\n-   时间步长为 $\\Delta t>0$，且 $t_n = n\\,\\Delta t$。\n-   布朗增量 $\\Delta W_n := W_{t_{n+1}} - W_{t_n}$ 是独立同分布的，服从 $\\mathcal{N}(0,\\Delta t)$。\n-   问题要求识别关于 EM 迭代 $(X_n)_{n\\in\\mathbb{N}}$ 的正性保持的正确陈述。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题是在随机微积分和 SDE 数值分析的标准数学框架内提出的。Itô SDE、布朗运动和 Euler–Maruyama 方法是基本且定义明确的概念。提到的具体 SDE 模型（几何布朗运动，Cox–Ingersoll–Ross）是该领域的标准模型。前提在事实上和科学上都是合理的。\n2.  **适定性：** 问题要求评估关于一个数值方案行为的四个不同数学陈述的真实性。这是一个适定的任务。\n3.  **客观性：** 语言正式、精确且客观。没有主观或含糊不清的术语。\n4.  **不完整或矛盾的设置：** 问题为通用 SDE 和 EM 方案提供了所有必要的定义。每个选项都提供了待评估的具体情境或主张。设置是自洽且一致的。\n5.  **不适定或结构不良：** 问题结构清晰，可以对每个选项得出可验证的答案。\n6.  **琐碎或同义反复：** 问题并非琐碎。它需要理解 EM 方案中高斯增量的分布特性，以及这些特性如何导致数值近似与真实解之间的质的差异（例如，失去正性）。\n\n### 步骤 3：结论与行动\n问题陈述是**有效的**。这是 SDE 数值分析中的一个标准且适定的问题。将推导完整的解答。\n\n### 解答推导\n\n问题的核心在于 Euler–Maruyama 更新步骤的结构：\n$$\nX_{n+1} \\;=\\; X_n \\;+\\; a\\!\\left(X_n\\right)\\,\\Delta t \\;+\\; b\\!\\left(X_n\\right)\\,\\Delta W_n\n$$\n给定 $X_n > 0$，我们关心 $X_{n+1}$ 的符号。增量 $\\Delta W_n$ 是一个服从正态分布的随机变量，$\\Delta W_n \\sim \\mathcal{N}(0, \\Delta t)$。正态分布的一个关键性质是其支撑集是整个实数轴 $(-\\infty, \\infty)$。这意味着对于任何固定的、非零的方差 $\\Delta t > 0$，$\\Delta W_n$ 可以以非零的概率密度取任何实数值。\n\n具体来说，对于任何有限值 $c \\in \\mathbb{R}$，$P(\\Delta W_n  c) > 0$。如果扩散系数 $b(X_n)$ 非零，则项 $b(X_n)\\,\\Delta W_n$ 是一个零均值的高斯随机变量。其随机性可能导致 $X_{n+1}$ 变为负值。$X_{n+1}$ 变为负值的条件是\n$$\nb(X_n)\\,\\Delta W_n \\;\\; -X_n - a(X_n)\\,\\Delta t\n$$\n或者，假设 $b(X_n) \\neq 0$，\n$$\n\\text{如果 } b(X_n) > 0: \\quad \\Delta W_n \\;\\; -\\frac{X_n + a(X_n)\\,\\Delta t}{b(X_n)}\n$$\n$$\n\\text{如果 } b(X_n)  0: \\quad \\Delta W_n \\;>\\; -\\frac{X_n + a(X_n)\\,\\Delta t}{b(X_n)}\n$$\n在任何一种情况下，由于右侧是一个有限值，并且 $\\Delta W_n$ 的支撑集是 $(-\\infty, \\infty)$，因此该事件发生的概率是严格为正的。这一洞察是评估选项的关键。\n\n**选项 A：对于几何布朗运动 SDE $dX_t = \\mu\\,X_t\\,dt + \\sigma\\,X_t\\,dW_t$ 且 $X_0>0$，Euler–Maruyama 方法对于任意 $\\Delta t>0$ 和任意实数参数 $\\mu$ 和 $\\sigma$ 几乎必然保持正性。**\n\n几何布朗运动 (GBM) 的 SDE 系数为 $a(x) = \\mu x$ 和 $b(x) = \\sigma x$。EM 方案为：\n$$\nX_{n+1} = X_n + \\mu X_n \\Delta t + \\sigma X_n \\Delta W_n = X_n(1 + \\mu \\Delta t + \\sigma \\Delta W_n)\n$$\n为使 $X_{n+1}$ 为正，给定 $X_n > 0$，我们必须有 $1 + \\mu \\Delta t + \\sigma \\Delta W_n > 0$。假设 $\\sigma \\neq 0$。这个不等式等价于：\n$$\n\\sigma \\Delta W_n > - (1 + \\mu \\Delta t)\n$$\n随机变量 $\\Delta W_n \\sim \\mathcal{N}(0, \\Delta t)$ 具有无界支撑集。因此，对于任何 $\\Delta t > 0$，$\\Delta W_n$ 取一个违反此不等式的值的概率为正。例如，如果 $\\sigma > 0$，事件 $\\Delta W_n  -(1 + \\mu \\Delta t)/\\sigma$ 发生的概率为 $P(\\Delta W_n  -(1 + \\mu \\Delta t)/\\sigma) > 0$。在此事件中，$X_{n+1} \\le 0$。由于在单步中失败的概率为正，因此在所有步骤中并不能“几乎必然”地保持正性。\n\nA 的结论：**不正确**。\n\n**选项 B：如果对于所有 $x \\ge 0$ 都有 $b(x) = 0$ 且 $a(x) \\ge 0$，那么从任意 $X_0 \\ge 0$ 开始，对于任意 $\\Delta t>0$，Euler–Maruyama 迭代值几乎必然满足对所有 $n$ 都有 $X_n \\ge 0$。**\n\n如果 $b(x)=0$，SDE 变为一个确定性的常微分方程 $dX_t = a(X_t)dt$。EM 方案简化为：\n$$\nX_{n+1} = X_n + a(X_n)\\,\\Delta t\n$$\n这是一个确定性的递推关系。我们可以通过归纳法证明其正性。\n-   基础情况：给定 $X_0 \\ge 0$。\n-   归纳步骤：假设对于某个 $n \\ge 0$ 有 $X_n \\ge 0$。根据问题条件，由于 $X_n \\ge 0$，我们有 $a(X_n) \\ge 0$。因为 $\\Delta t > 0$，所以乘积 $a(X_n)\\,\\Delta t \\ge 0$。\n-   因此，$X_{n+1} = X_n + a(X_n)\\,\\Delta t \\ge 0 + 0 = 0$。\n通过归纳法，对于所有 $n \\in \\mathbb{N}$ 都有 $X_n \\ge 0$。由于演化是确定性的，这以概率 $1$ 成立（即几乎必然）。\n\nB 的结论：**正确**。\n\n**选项 C：对于 Cox–Ingersoll–Ross SDE $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma\\sqrt{X_t}\\,dW_t$，其参数满足 Feller 条件 $2\\kappa\\theta \\ge \\sigma^2$ 且 $X_0>0$ 时，其精确解对所有 $t>0$ 都是严格为正的，但对于任何固定的 $\\Delta t>0$，Euler–Maruyama 方法会以正概率产生负值。**\n\n该 SDE 是 Cox-Ingersoll-Ross (CIR) 模型，其中 $a(x) = \\kappa(\\theta - x)$ 且 $b(x) = \\sigma\\sqrt{x}$。众所周知，Feller 条件 $2\\kappa\\theta \\ge \\sigma^2$ 足以保证在 $X_0 > 0$ 的情况下，精确解 $X_t$ 几乎必然保持严格为正。问题陈述正确地断言了这一点。\nEM 方案为：\n$$\nX_{n+1} = X_n + \\kappa(\\theta - X_n)\\,\\Delta t + \\sigma\\sqrt{X_n}\\,\\Delta W_n\n$$\n让我们分析从某个 $X_n > 0$ 开始，$X_{n+1}  0$ 的可能性。这种情况发生于：\n$$\n\\sigma\\sqrt{X_n}\\,\\Delta W_n  -X_n - \\kappa(\\theta - X_n)\\,\\Delta t\n$$\n由于 $X_n > 0$，我们可以不失一般性地假设 $\\sigma > 0$（如果 $\\sigma=0$，若 $a(x)\\ge 0$ 则属于选项 B 的情况）。变为负值的条件是：\n$$\n\\Delta W_n  -\\frac{X_n + \\kappa(\\theta - X_n)\\,\\Delta t}{\\sigma\\sqrt{X_n}}\n$$\n右侧是一个有限实数。由于 $\\Delta W_n \\sim \\mathcal{N}(0, \\Delta t)$ 的支撑集是 $(-\\infty, \\infty)$，对于任何固定的 $\\Delta t > 0$，$\\Delta W_n$ 小于此有限阈值的事件概率严格大于零。因此，尽管真实解是严格为正的，EM 方法仍能以正概率产生负值。这是标准 EM 方案应用于 CIR 模型时的一个众所周知的缺陷。\n\nC 的结论：**正确**。\n\n**选项 D：存在一个足够小的步长 $\\Delta t_0>0$（仅取决于系数），使得对于所有 $\\Delta t \\in (0,\\Delta t_0)$，Euler–Maruyama 方法对每个其精确解对于 $t>0$ 几乎必然为正的 Itô SDE 几乎必然地保持正性。**\n\n这个陈述提出了一个非常强的、普遍性的主张。让我们用一个反例来证伪它。考虑选项 A 中的 GBM：$dX_t = \\mu X_t dt + \\sigma X_t dW_t$。我们已经证明，对于*任何* $\\Delta t > 0$，过程在单步内变为负值的概率是正的。\n$$\nP(X_{n+1}  0 | X_n>0) = P\\left( \\Delta W_n  -\\frac{1+\\mu \\Delta t}{\\sigma} \\right) > 0\n$$\n由于这个单步转移概率是正的，整个路径 $(X_n)_{n\\in\\mathbb{N}}$ 保持为正的概率小于 $1$。因此，正性并未被“几乎必然”地保持。该陈述声称，对于*每个*这样的 SDE，只需选择足够小的 $\\Delta t$ 即可解决此问题。这是错误的。对于任何具有非零扩散项 $b(x)$ 且当 $x \\to 0$ 时该项消失得不够“快”的 SDE，高斯噪声项 $b(X_n)\\Delta W_n$ 总是以非零概率足够为负，从而使 $X_{n+1}$ 变为负值。无论 $\\Delta t>0$ 多么小，$\\Delta W_n$ 的支撑集仍然是 $(-\\infty, \\infty)$，因此，出现大的负向波动的可能性（无论多么不可能）永远不会被消除。\n\nD 的结论：**不正确**。\n\n**反例识别**\n问题要求给出一个具体的反例，说明对于一个具有严格正解的 SDE，Euler–Maruyama 方法未能保持其正性。选项 C 的分析恰好提供了这样一个例子。Cox–Ingersoll–Ross 模型 $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma\\sqrt{X_t}\\,dW_t$，在满足 $2\\kappa\\theta \\ge \\sigma^2$ 和 $X_0>0$ 的条件下，其解是严格为正的。然而，如上所示，应用于该模型的标准 Euler-Maruyama 方案对于任何步长 $\\Delta t > 0$ 都会以正概率生成负值。选项 A 中的几何布朗运动是另一个这样的例子。", "answer": "$$\\boxed{BC}$$", "id": "3074530"}]}