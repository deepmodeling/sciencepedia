{"hands_on_practices": [{"introduction": "要理解鞅，掌握其基本构成部分——鞅差序列——是至关重要的。本练习 [@problem_id:3049353] 将挑战你验证一个序列是否为鞅差序列，它代表了一系列“公平博弈”的结果。通过计算其部分和的方差，你将体会到这些序列的非相关性如何简化了计算，从而巩固构建鞅所需的基础性质。", "problem": "设 $\\left(\\Omega,\\mathcal{F},\\mathbb{P}\\right)$ 为一个概率空间，其上支撑着一个独立同分布 (i.i.d.) 的拉德马赫 (Rademacher) 随机变量序列 $\\left(\\xi_{k}\\right)_{k \\geq 1}$，即，对任意 $k \\in \\mathbb{N}$ 都有 $\\mathbb{P}\\!\\left(\\xi_{k}=1\\right)=\\mathbb{P}\\!\\left(\\xi_{k}=-1\\right)=\\frac{1}{2}$。固定一个常数 $r$ 满足 $0  r  1$，并定义随机变量 $D_{k}=r^{k-1}\\xi_{k}$。设 $\\mathcal{F}_{k}=\\sigma\\!\\left(\\xi_{1},\\dots,\\xi_{k}\\right)$ 为由该序列前 $k$ 个随机变量生成的自然信息流，并设 $\\mathcal{F}_{0}=\\{\\emptyset,\\Omega\\}$。\n证明序列 $\\left(D_{k}\\right)_{k \\geq 1}$ 是关于信息流 $\\left(\\mathcal{F}_{k}\\right)_{k \\geq 0}$ 的一个鞅差序列，且这些差分是几乎必然有界的。然后，对于部分和 $S_{n} := \\sum_{k=1}^{n} D_{k}$，计算 $\\mathrm{Var}\\!\\left(S_{n}\\right)$。", "solution": "首先验证该问题的合理性、科学性和完整性。所有给出的定义和常数都是随机过程理论中的标准内容。任务具体，可在数学上形式化，且不包含任何矛盾或歧义。对常数 $r$ 的条件与所需的计算是一致的。因此，该问题被认定为有效，下面提供完整解答。\n\n该问题要求完成三件事：\n1. 证明序列 $\\left(D_{k}\\right)_{k \\geq 1}$ 是关于滤子 $\\left(\\mathcal{F}_{k}\\right)_{k \\geq 0}$ 的一个鞅差序列 (MDS)。\n2. 验证对于一个不依赖于 $k$ 的常数 $M$，几乎必然有 $|D_k| \\le M$。\n3. 计算方差 $\\mathrm{Var}\\!\\left(S_{n}\\right)$。\n\n我们将按顺序处理每个部分。\n\n一个随机变量序列 $\\left(D_k\\right)_{k \\geq 1}$ 是关于滤子 $\\left(\\mathcal{F}_k\\right)_{k \\geq 0}$ 的鞅差序列，如果它对所有 $k \\ge 1$ 满足三个条件：\n(i) $D_k$ 是 $\\mathcal{F}_k$-可测的。\n(ii) $D_k$ 是可积的，即 $\\mathbb{E}\\!\\left[|D_k|\\right]  \\infty$。\n(iii) 给定过去的条件下，$D_k$ 的条件期望为零，即 $\\mathbb{E}\\!\\left[D_k|\\mathcal{F}_{k-1}\\right] = 0$。\n\n我们来验证 $D_{k}=r^{k-1}\\xi_{k}$ 是否满足这些条件。\n\n(i) **可测性**：滤子定义为 $\\mathcal{F}_{k}=\\sigma\\!\\left(\\xi_{1},\\dots,\\xi_{k}\\right)$。根据定义，随机变量 $\\xi_k$ 是关于它所生成的 σ-代数 $\\mathcal{F}_k$ 可测的。由于 $D_k$ 是 $\\xi_k$ 的常数倍（即 $D_k = f(\\xi_k)$，其中 $f(x)=r^{k-1}x$），并且 $f$ 是一个波莱尔可测函数，所以 $D_k$ 也是 $\\mathcal{F}_k$-可测的。\n\n(ii) **可积性**：我们计算 $D_k$ 绝对值的期望：\n$$\n\\mathbb{E}\\!\\left[|D_k|\\right] = \\mathbb{E}\\!\\left[|r^{k-1}\\xi_{k}|\\right]\n$$\n因为 $0  r  1$ 且 $k \\geq 1$，项 $r^{k-1}$ 是一个正常数。随机变量 $\\xi_k$ 的取值在 $\\{-1, 1\\}$ 中，所以几乎必然有 $|\\xi_k|=1$。\n$$\n\\mathbb{E}\\!\\left[|D_k|\\right] = \\mathbb{E}\\!\\left[r^{k-1}|\\xi_k|\\right] = r^{k-1}\\mathbb{E}\\!\\left[|\\xi_k|\\right] = r^{k-1}\\mathbb{E}\\!\\left[1\\right] = r^{k-1}\n$$\n由于对于任何 $k \\geq 1$，$r^{k-1}$ 都是一个有限实数，因此条件 $\\mathbb{E}\\!\\left[|D_k|\\right]  \\infty$ 得到满足。\n\n(iii) **鞅差序列条件**：我们必须证明 $\\mathbb{E}\\!\\left[D_k|\\mathcal{F}_{k-1}\\right] = 0$。\n$$\n\\mathbb{E}\\!\\left[D_k|\\mathcal{F}_{k-1}\\right] = \\mathbb{E}\\!\\left[r^{k-1}\\xi_k|\\mathcal{F}_{k-1}\\right]\n$$\n项 $r^{k-1}$ 是一个确定性常数，因此可以从条件期望中提出：\n$$\n\\mathbb{E}\\!\\left[D_k|\\mathcal{F}_{k-1}\\right] = r^{k-1}\\mathbb{E}\\!\\left[\\xi_k|\\mathcal{F}_{k-1}\\right]\n$$\n序列 $\\left(\\xi_i\\right)_{i \\geq 1}$ 是独立的。这意味着 $\\xi_k$ 独立于随机变量集合 $\\{\\xi_1, \\dots, \\xi_{k-1}\\}$。因此，$\\xi_k$ 独立于由它们生成的 σ-代数 $\\mathcal{F}_{k-1}=\\sigma\\!\\left(\\xi_{1},\\dots,\\xi_{k-1}\\right)$。条件期望的一个基本性质是，如果随机变量 $X$ 独立于 σ-代数 $\\mathcal{G}$，则 $\\mathbb{E}\\!\\left[X|\\mathcal{G}\\right]=\\mathbb{E}\\!\\left[X\\right]$。应用此性质，我们有：\n$$\n\\mathbb{E}\\!\\left[\\xi_k|\\mathcal{F}_{k-1}\\right] = \\mathbb{E}\\!\\left[\\xi_k\\right]\n$$\n一个拉德马赫随机变量 $\\xi_k$ 的期望是：\n$$\n\\mathbb{E}\\!\\left[\\xi_k\\right] = (-1) \\cdot \\mathbb{P}\\!\\left(\\xi_k=-1\\right) + (1) \\cdot \\mathbb{P}\\!\\left(\\xi_k=1\\right) = (-1)\\cdot\\frac{1}{2} + (1)\\cdot\\frac{1}{2} = 0\n$$\n将其代回，我们得到：\n$$\n\\mathbb{E}\\!\\left[D_k|\\mathcal{F}_{k-1}\\right] = r^{k-1} \\cdot 0 = 0\n$$\n所有三个条件都得到满足。因此，$\\left(D_{k}\\right)_{k \\geq 1}$ 是关于 $\\left(\\mathcal{F}_{k}\\right)_{k \\geq 0}$ 的一个鞅差序列。\n\n接下来，我们验证这些差分是几乎必然有界的。我们考虑 $D_k$ 的绝对值：\n$$\n|D_k| = |r^{k-1}\\xi_k| = |r^{k-1}||\\xi_k|\n$$\n由于 $0  r  1$ 且 $k \\geq 1$，我们有 $0  r^{k-1} \\leq r^{1-1} = r^0 = 1$。并且，我们几乎必然有 $|\\xi_k|=1$。因此，\n$$\n|D_k| \\leq 1 \\cdot 1 = 1\n$$\n由于 $|D_k|$ 对所有 $k \\geq 1$ 几乎必然被 $M=1$ 所界定，这些差分是几乎必然有界的。\n\n最后，我们计算方差 $\\mathrm{Var}\\!\\left(S_{n}\\right)$。\n$$\nS_n = \\sum_{k=1}^n D_k\n$$\n方差的定义是 $\\mathrm{Var}(X) = \\mathbb{E}[(X - \\mathbb{E}[X])^2]$。首先，我们计算 $S_n$ 的期望：\n$$\n\\mathbb{E}[S_n] = \\mathbb{E}\\left[\\sum_{k=1}^n D_k\\right] = \\sum_{k=1}^n \\mathbb{E}[D_k] = \\sum_{k=1}^n \\mathbb{E}[\\mathbb{E}[D_k|\\mathcal{F}_{k-1}]] = \\sum_{k=1}^n \\mathbb{E}[0] = 0\n$$\n因此，$\\mathrm{Var}(S_n) = \\mathbb{E}[S_n^2]$。\n$$\nS_n^2 = \\left(\\sum_{k=1}^n D_k\\right)^2 = \\sum_{k=1}^n D_k^2 + 2\\sum_{1 \\le j  k \\le n} D_j D_k\n$$\n由于期望的线性性，\n$$\n\\mathbb{E}[S_n^2] = \\sum_{k=1}^n \\mathbb{E}[D_k^2] + 2\\sum_{1 \\le j  k \\le n} \\mathbb{E}[D_j D_k]\n$$\n我们来计算交叉项的期望。对于 $j  k$：\n$$\n\\mathbb{E}[D_j D_k] = \\mathbb{E}[\\mathbb{E}[D_j D_k|\\mathcal{F}_{k-1}]]\n$$\n由于 $j  k$，$D_j$ 是 $\\mathcal{F}_j$-可测的，从而也是 $\\mathcal{F}_{k-1}$-可测的。因此，我们可以将其从内部条件期望中提出：\n$$\n\\mathbb{E}[D_j \\mathbb{E}[D_k|\\mathcal{F}_{k-1}]]\n$$\n由于 $\\left(D_k\\right)$ 是一个鞅差序列，我们有 $\\mathbb{E}[D_k|\\mathcal{F}_{k-1}]=0$。所以，\n$$\n\\mathbb{E}[D_j D_k] = \\mathbb{E}[D_j \\cdot 0] = 0\n$$\n这意味着所有的交叉项都为零。鞅差序列的项是不相关的。\n因此，方差是各项方差之和：\n$$\n\\mathrm{Var}(S_n) = \\mathbb{E}[S_n^2] = \\sum_{k=1}^n \\mathbb{E}[D_k^2]\n$$\n现在我们计算 $\\mathbb{E}[D_k^2]$。\n$$\n\\mathbb{E}[D_k^2] = \\mathbb{E}[(r^{k-1}\\xi_k)^2] = \\mathbb{E}[r^{2(k-1)}\\xi_k^2] = r^{2(k-1)}\\mathbb{E}[\\xi_k^2]\n$$\n由于几乎必然有 $\\xi_k \\in \\{-1,1\\}$，所以几乎必然有 $\\xi_k^2 = 1$。\n$$\n\\mathbb{E}[\\xi_k^2] = 1^2 \\cdot \\mathbb{P}(\\xi_k=1) + (-1)^2 \\cdot \\mathbb{P}(\\xi_k=-1) = 1 \\cdot \\frac{1}{2} + 1 \\cdot \\frac{1}{2} = 1\n$$\n所以，$\\mathbb{E}[D_k^2] = r^{2(k-1)}$。\n将此代入方差公式，我们得到一个几何级数之和：\n$$\n\\mathrm{Var}(S_n) = \\sum_{k=1}^n r^{2(k-1)} = \\sum_{j=0}^{n-1} (r^2)^j\n$$\n这是一个公比为 $r^2$ 的几何级数的和。由于 $0  r  1$，我们有 $0  r^2  1$，所以 $r^2 \\neq 1$。和的公式是：\n$$\n\\mathrm{Var}(S_n) = \\frac{1 - (r^2)^n}{1-r^2} = \\frac{1-r^{2n}}{1-r^2}\n$$", "answer": "$$\n\\boxed{\\frac{1-r^{2n}}{1-r^2}}\n$$", "id": "3049353"}, {"introduction": "鞅理论不仅仅是一个抽象概念，它也是解决复杂随机过程问题的强大工具。本练习 [@problem_id:3049332] 展示了可选停止定理在简单随机游走中的一个经典应用，让你能够巧妙地确定到达某个边界所需的期望时间。你还将从原始鞅中构造一个新的鞅，这是随机分析中一种常见而强大的技巧。", "problem": "考虑一个定义在整数上的简单对称随机游走 $\\{S_{n}\\}_{n \\geq 0}$，其定义为 $S_{0} = 0$ 和 $S_{n} = \\sum_{k=1}^{n} X_{k}$（当 $n \\geq 1$ 时），其中增量 $\\{X_{k}\\}_{k \\geq 1}$ 是独立同分布的，且 $\\mathbb{P}(X_{k} = 1) = \\mathbb{P}(X_{k} = -1) = \\frac{1}{2}$。设 $\\{\\mathcal{F}_{n}\\}_{n \\geq 0}$ 表示 $\\{S_{n}\\}_{n \\geq 0}$ 的自然信息流。我们希望找到一个停时 $T$，使得停时值 $S_{T}$ 服从两点分布 $\\mathbb{P}(S_{T} = 4) = \\frac{3}{7}$ 和 $\\mathbb{P}(S_{T} = -3) = \\frac{4}{7}$。\n\n将停时 $T$ 构造为集合 $\\{-3, 4\\}$ 的首达时间，即\n$$\nT := \\inf\\{n \\geq 0 : S_{n} \\in \\{-3, 4\\}\\}。\n$$\n从鞅和停时的核心定义出发，并且只使用关于条件期望和在标准充分条件下的可选停止定理的成熟结论，完成以下任务：\n\n1. 证明 $T$ 是关于 $\\{\\mathcal{F}_{n}\\}_{n \\geq 0}$ 的一个停时。\n2. 验证 $\\{S_{n}\\}_{n \\geq 0}$ 是关于 $\\{\\mathcal{F}_{n}\\}_{n \\geq 0}$ 的一个鞅。\n3. 证明对有界停时 $T \\wedge n$（其中 $a \\wedge b$ 表示 $a$ 和 $b$ 的最小值）使用可选停止定理的合理性，然后通过适当的极限论证，得出结论 $\\mathbb{E}[S_{T}] = \\mathbb{E}[S_{0}]$。\n4. 使用上一步的结论，推导 $S_{T}$ 的分布，并确认 $\\mathbb{P}(S_{T} = 4) = \\frac{3}{7}$ 和 $\\mathbb{P}(S_{T} = -3) = \\frac{4}{7}$。\n5. 考虑由 $M_{n} := S_{n}^{2} - n$ 定义的随机过程 $\\{M_{n}\\}_{n \\geq 0}$。证明 $\\{M_{n}\\}_{n \\geq 0}$ 是一个鞅，验证对 $T \\wedge n$ 的可选停止，并使用控制收敛定理和单调收敛定理来获得 $\\mathbb{E}[T]$ 的封闭形式表达式。\n\n计算所构造的停时 $T$ 的 $\\mathbb{E}[T]$ 的精确值。不需要四舍五入。将最终答案表示为单个实数。", "solution": "按要求分五部分对问题进行分析和求解。\n\n### 第1部分：证明 $T$ 是一个停时\n一个取值于 $\\{0, 1, 2, \\dots\\} \\cup \\{\\infty\\}$ 的随机变量 $T$，如果对于每个 $n \\geq 0$，事件 $\\{T \\leq n\\}$ 都属于 $\\mathcal{F}_{n}$，则称其为关于信息流 $\\{\\mathcal{F}_{n}\\}_{n \\geq 0}$ 的一个停时。此处信息流是过程 $\\{S_{n}\\}$ 的自然信息流，即 $\\mathcal{F}_{n} = \\sigma(S_{0}, S_{1}, \\dots, S_{n})$。\n\n停时 $T$ 定义为 $T := \\inf\\{k \\geq 0 : S_{k} \\in \\{-3, 4\\}\\}$。\n事件 $\\{T \\leq n\\}$ 可以写成随机游走在时间 $n$ 或之前到达集合 $\\{-3, 4\\}$ 的事件的并集：\n$$\n\\{T \\leq n\\} = \\bigcup_{k=0}^{n} \\{S_{k} \\in \\{-3, 4\\}\\}。\n$$\n对于任意 $k \\in \\{0, 1, \\dots, n\\}$，事件 $\\{S_{k} \\in \\{-3, 4\\}\\}$ 是两个事件 $\\{S_{k} = -3\\}$ 和 $\\{S_{k} = 4\\}$ 的并集。\n由于根据定义 $S_{k}$ 是一个 $\\mathcal{F}_{k}$-可测的随机变量，因此事件 $\\{S_{k} = -3\\}$ 和 $\\{S_{k} = 4\\}$ 都属于 $\\mathcal{F}_{k}$。\n信息流是非递减的，因此对于任意 $k \\leq n$，有 $\\mathcal{F}_{k} \\subseteq \\mathcal{F}_{n}$。\n所以，对于任意 $k \\leq n$，事件 $\\{S_{k} = -3\\}$ 和 $\\{S_{k} = 4\\}$ 都属于 $\\mathcal{F}_{n}$。\nσ-代数中有限个集合的并集也属于该σ-代数。因此，对于每个 $k \\in \\{0, \\dots, n\\}$，事件 $\\{S_{k} \\in \\{-3, 4\\}\\}$ 属于 $\\mathcal{F}_{n}$。\n因此，事件 $\\{T \\leq n\\} = \\bigcup_{k=0}^{n} \\{S_{k} \\in \\{-3, 4\\}\\}$ 作为 $\\mathcal{F}_{n}$-可测集的有限并集，其本身也是 $\\mathcal{F}_{n}$-可测的。这对所有 $n \\geq 0$ 都成立。\n因此， $T$ 是关于 $\\{\\mathcal{F}_{n}\\}_{n \\geq 0}$ 的一个停时。\n\n### 第2部分：验证 $\\{S_{n}\\}_{n \\geq 0}$ 是一个鞅\n要证明 $\\{S_{n}\\}_{n \\geq 0}$ 是关于 $\\{\\mathcal{F}_{n}\\}_{n \\geq 0}$ 的一个鞅，我们必须验证三个条件：\n1.  对于每个 $n \\geq 0$，$S_{n}$ 是 $\\mathcal{F}_{n}$-可测的。根据自然信息流 $\\mathcal{F}_{n}$ 的定义，这是成立的。\n2.  对于每个 $n \\geq 0$，$\\mathbb{E}[|S_{n}|]  \\infty$。由于 $S_{n} = \\sum_{k=1}^{n} X_{k}$，我们有 $|S_{n}| = |\\sum_{k=1}^{n} X_{k}| \\leq \\sum_{k=1}^{n} |X_{k}|$。因为对所有 $k$， $|X_{k}|=1$，我们得到 $|S_{n}| \\leq n$。因此，$\\mathbb{E}[|S_{n}|] \\leq \\mathbb{E}[n] = n  \\infty$。\n3.  对于所有 $n \\geq 1$，$\\mathbb{E}[S_{n} | \\mathcal{F}_{n-1}] = S_{n-1}$。\n我们计算条件期望：\n$$\n\\mathbb{E}[S_{n} | \\mathcal{F}_{n-1}] = \\mathbb{E}[S_{n-1} + X_{n} | \\mathcal{F}_{n-1}]。\n$$\n根据条件期望的线性性质，上式变为：\n$$\n\\mathbb{E}[S_{n-1} | \\mathcal{F}_{n-1}] + \\mathbb{E}[X_{n} | \\mathcal{F}_{n-1}]。\n$$\n由于 $S_{n-1}$ 是 $\\mathcal{F}_{n-1}$-可测的，$\\mathbb{E}[S_{n-1} | \\mathcal{F}_{n-1}] = S_{n-1}$。\n增量 $X_{n}$ 与过去的增量 $\\{X_{1}, \\dots, X_{n-1}\\}$ 独立，因此与它们生成的σ-代数 $\\mathcal{F}_{n-1} = \\sigma(S_0, ..., S_{n-1})$ 独立。因此，$\\mathbb{E}[X_{n} | \\mathcal{F}_{n-1}] = \\mathbb{E}[X_{n}]$。\n$X_{n}$ 的期望是：\n$$\n\\mathbb{E}[X_{n}] = (1) \\cdot \\mathbb{P}(X_{n}=1) + (-1) \\cdot \\mathbb{P}(X_{n}=-1) = 1 \\cdot \\frac{1}{2} - 1 \\cdot \\frac{1}{2} = 0。\n$$\n将这些结果代回，我们得到：\n$$\n\\mathbb{E}[S_{n} | \\mathcal{F}_{n-1}] = S_{n-1} + 0 = S_{n-1}。\n$$\n所有三个条件都满足，所以 $\\{S_{n}\\}_{n \\geq 0}$ 是一个鞅。\n\n### 第3部分：证明使用可选停止定理的合理性\n对于每个 $n \\geq 0$，定义停时 $T_{n} = T \\wedge n = \\min(T, n)$。由于 $T$ 是一个停时而 $n$ 是一个常数， $T_{n}$ 也是一个停时。此外， $T_{n}$ 被 $n$ 所界定。\n有界停时的可选停止定理指出，如果 $\\{S_{k}\\}$ 是一个鞅且 $\\tau$ 是一个有界停时，则 $\\mathbb{E}[S_{\\tau}] = \\mathbb{E}[S_{0}]$。\n将此应用于有界停时 $T_{n}$，我们有：\n$$\n\\mathbb{E}[S_{T \\wedge n}] = \\mathbb{E}[S_{0}]。\n$$\n由于 $S_{0}=0$，我们有 $\\mathbb{E}[S_{T \\wedge n}] = 0$ 对所有 $n \\geq 0$ 成立。\n\n为了将此推广到无界停时 $T$，我们必须证明当 $n \\to \\infty$ 时取极限是合理的。可选停止定理的一个充分条件是停止过程是一致有界的。我们来检验 $S_{T \\wedge n}$ 是否满足这个条件。\n根据 $T$ 的构造，对于任意 $k  T$，随机游走的位置 $S_{k}$ 严格介于 $-3$ 和 $4$ 之间，即 $-3  S_{k}  4$。\n如果停止发生在时间 $n$ 或之前（即 $T \\leq n$），那么 $S_{T \\wedge n} = S_{T}$，其值为 $-3$ 或 $4$。\n如果停止发生在时间 $n$ 之后（即 $T > n$），那么 $S_{T \\wedge n} = S_{n}$，并且由于 $n  T$，我们有 $-3  S_{n}  4$。\n在所有情况下，对于所有 $n \\geq 0$ 和所有样本路径，都有 $|S_{T \\wedge n}| \\leq 4$。停止过程 $\\{S_{T \\wedge n}\\}_{n \\geq 0}$ 被常数 $4$ 一致有界。\n一维简单对称随机游走是常返的，这意味着它最终会访问任何整数状态。因此，它最终会到达集合 $\\{-3, 4\\}$，这意味着 $\\mathbb{P}(T  \\infty)=1$。\n当 $n \\to \\infty$ 时，$T \\wedge n \\to T$ 几乎必然成立。由于 $S$ 是定义在整数上的函数，这意味着 $S_{T \\wedge n} \\to S_{T}$ 几乎必然成立。\n随机变量序列 $\\{S_{T \\wedge n}\\}_{n \\geq 0}$ 几乎必然收敛于 $S_{T}$，并且其绝对值被 $4$ 一致有界。常数随机变量 $Y=4$ 是可积的。因此，根据控制收敛定理，我们可以交换极限和期望：\n$$\n\\mathbb{E}[S_{T}] = \\mathbb{E}[\\lim_{n \\to \\infty} S_{T \\wedge n}] = \\lim_{n \\to \\infty} \\mathbb{E}[S_{T \\wedge n}]。\n$$\n由于对所有 $n$，$\\mathbb{E}[S_{T \\wedge n}] = 0$，我们得出结论：\n$$\n\\mathbb{E}[S_{T}] = \\lim_{n \\to \\infty} 0 = 0。\n$$\n因此，$\\mathbb{E}[S_{T}] = \\mathbb{E}[S_{0}]$。\n\n### 第4部分：推导 $S_{T}$ 的分布\n随机变量 $S_{T}$ 在集合 $\\{-3, 4\\}$ 中取值。设 $p = \\mathbb{P}(S_{T} = 4)$。那么，因为 $\\mathbb{P}(T  \\infty) = 1$，我们有 $\\mathbb{P}(S_{T} = -3) = 1-p$。\n$S_{T}$ 的期望可以用其分布计算：\n$$\n\\mathbb{E}[S_{T}] = (4) \\cdot \\mathbb{P}(S_{T} = 4) + (-3) \\cdot \\mathbb{P}(S_{T} = -3) = 4p - 3(1-p)。\n$$\n从上一步我们知道 $\\mathbb{E}[S_{T}] = 0$。所以我们建立方程：\n$$\n4p - 3(1-p) = 0\n$$\n$$\n4p - 3 + 3p = 0\n$$\n$$\n7p = 3\n$$\n$$\np = \\frac{3}{7}。\n$$\n因此，$\\mathbb{P}(S_{T} = 4) = \\frac{3}{7}$，且 $\\mathbb{P}(S_{T} = -3) = 1 - \\frac{3}{7} = \\frac{4}{7}$。这证实了所求的分布。\n\n### 第5部分：计算 $\\mathbb{E}[T]$\n首先，我们证明 $M_{n} = S_{n}^{2} - n$ 是一个鞅。\n1.  $M_{n}$ 是 $\\mathcal{F}_{n}$-可测的，因为 $S_{n}$ 是 $\\mathcal{F}_{n}$-可测的，而 $n$ 是一个确定性常数。\n2.  $\\mathbb{E}[|M_{n}|] = \\mathbb{E}[|S_{n}^{2} - n|] \\leq \\mathbb{E}[S_{n}^{2}] + n$。$X_{k}$ 的方差是 $\\mathbb{E}[X_{k}^{2}] - (\\mathbb{E}[X_{k}])^{2} = 1 - 0^{2} = 1$。由于 $X_{k}$ 是独立的，$\\text{Var}(S_{n}) = \\sum_{k=1}^{n}\\text{Var}(X_{k}) = n$。又 $\\mathbb{E}[S_{n}]=0$。所以，$\\mathbb{E}[S_{n}^{2}] = \\text{Var}(S_{n}) + (\\mathbb{E}[S_{n}])^{2} = n + 0 = n$。因此，$\\mathbb{E}[|M_{n}|] \\leq n + n = 2n  \\infty$。\n3.  我们检验鞅性质：$\\mathbb{E}[M_{n} | \\mathcal{F}_{n-1}] = M_{n-1}$。\n$$\n\\mathbb{E}[M_{n} | \\mathcal{F}_{n-1}] = \\mathbb{E}[S_{n}^{2} - n | \\mathcal{F}_{n-1}] = \\mathbb{E}[S_{n}^{2} | \\mathcal{F}_{n-1}] - n。\n$$\n代入 $S_{n} = S_{n-1} + X_{n}$：\n$$\n\\mathbb{E}[S_{n}^{2} | \\mathcal{F}_{n-1}] = \\mathbb{E}[(S_{n-1} + X_{n})^{2} | \\mathcal{F}_{n-1}] = \\mathbb{E}[S_{n-1}^{2} + 2S_{n-1}X_{n} + X_{n}^{2} | \\mathcal{F}_{n-1}]。\n$$\n使用条件期望的线性和性质：\n$$\n\\mathbb{E}[S_{n-1}^{2} | \\mathcal{F}_{n-1}] + 2\\mathbb{E}[S_{n-1}X_{n} | \\mathcal{F}_{n-1}] + \\mathbb{E}[X_{n}^{2} | \\mathcal{F}_{n-1}]。\n$$\n- 由于 $S_{n-1}^{2}$ 是 $\\mathcal{F}_{n-1}$-可测的，$\\mathbb{E}[S_{n-1}^{2} | \\mathcal{F}_{n-1}] = S_{n-1}^{2}$。\n- 提出已知项，$\\mathbb{E}[S_{n-1}X_{n} | \\mathcal{F}_{n-1}] = S_{n-1}\\mathbb{E}[X_{n} | \\mathcal{F}_{n-1}] = S_{n-1}\\mathbb{E}[X_{n}] = S_{n-1} \\cdot 0 = 0$。\n- 由于独立性，$\\mathbb{E}[X_{n}^{2} | \\mathcal{F}_{n-1}] = \\mathbb{E}[X_{n}^{2}] = (1)^{2}\\frac{1}{2} + (-1)^{2}\\frac{1}{2} = 1$。\n结合这些结果，我们得到 $\\mathbb{E}[S_{n}^{2} | \\mathcal{F}_{n-1}] = S_{n-1}^{2} + 1$。\n所以，$\\mathbb{E}[M_{n} | \\mathcal{F}_{n-1}] = (S_{n-1}^{2} + 1) - n = S_{n-1}^{2} - (n-1) = M_{n-1}$。\n因此，$\\{M_{n}\\}$ 是一个鞅。\n\n现在，我们将可选停止定理应用于 $M_{n}$ 和有界停时 $T \\wedge n$。\n$$\n\\mathbb{E}[M_{T \\wedge n}] = \\mathbb{E}[M_{0}] = S_{0}^{2} - 0 = 0。\n$$\n这意味着 $\\mathbb{E}[S_{T \\wedge n}^{2} - (T \\wedge n)] = 0$，或者 $\\mathbb{E}[S_{T \\wedge n}^{2}] = \\mathbb{E}[T \\wedge n]$。\n我们需要取 $n \\to \\infty$ 时的极限。\n对于右边，随机变量序列 $\\{T \\wedge n\\}_{n \\geq 0}$ 是非负且非递减的，逐点收敛于 $T$。根据单调收敛定理：\n$$\n\\lim_{n \\to \\infty} \\mathbb{E}[T \\wedge n] = \\mathbb{E}[\\lim_{n \\to \\infty} T \\wedge n] = \\mathbb{E}[T]。\n$$\n对于左边，我们有 $S_{T \\wedge n}^{2} \\to S_{T}^{2}$ 几乎必然成立。如前所示， $|S_{T \\wedge n}| \\leq 4$，所以 $S_{T \\wedge n}^{2} \\leq 16$。由于常数随机变量 $Y=16$ 是可积的，我们可以使用控制收敛定理：\n$$\n\\lim_{n \\to \\infty} \\mathbb{E}[S_{T \\wedge n}^{2}] = \\mathbb{E}[\\lim_{n \\to \\infty} S_{T \\wedge n}^{2}] = \\mathbb{E}[S_{T}^{2}]。\n$$\n令两边极限相等，我们发现 $\\mathbb{E}[T] = \\mathbb{E}[S_{T}^{2}]$。\n我们现在可以使用第4部分中找到的 $S_{T}$ 的分布来计算 $\\mathbb{E}[S_{T}^{2}]$。随机变量 $S_{T}^{2}$ 以概率 $\\frac{3}{7}$ 取值 $4^{2}=16$，以概率 $\\frac{4}{7}$ 取值 $(-3)^{2}=9$。\n$$\n\\mathbb{E}[S_{T}^{2}] = (16) \\cdot \\mathbb{P}(S_{T} = 4) + (9) \\cdot \\mathbb{P}(S_{T} = -3) = 16 \\cdot \\frac{3}{7} + 9 \\cdot \\frac{4}{7}。\n$$\n$$\n\\mathbb{E}[S_{T}^{2}] = \\frac{48}{7} + \\frac{36}{7} = \\frac{48+36}{7} = \\frac{84}{7} = 12。\n$$\n因此，$\\mathbb{E}[T] = 12$。", "answer": "$$\n\\boxed{12}\n$$", "id": "3049332"}, {"introduction": "每个强大的定理都有其适用边界，理解这些边界是正确应用理论的关键。本练习 [@problem_id:3049397] 提出了一个关键场景，其中可选停止定理似乎失效了，并导出了一个与直觉相悖的结论。通过仔细分析该定理的条件，你将发现它为何在此失效，从而加深对定理成立所需满足的那些微妙但至关重要的条件的理解。", "problem": "考虑一个在整数上的简单对称随机游走 $\\{S_{n}\\}_{n \\geq 0}$，其定义为 $S_{0} = -1$ 且对于 $n \\geq 1$，$S_{n} = S_{n-1} + X_{n}$，其中 $\\{X_{n}\\}_{n \\geq 1}$ 是独立同分布的随机变量，满足 $\\mathbb{P}(X_{n} = 1) = \\mathbb{P}(X_{n} = -1) = \\frac{1}{2}$。设 $\\{\\mathcal{F}_{n}\\}_{n \\geq 0}$ 是由 $\\{X_{k}\\}_{k \\leq n}$ 生成的自然信息流，并定义过程 $M_{n} := S_{n}$。定义关于 $\\{\\mathcal{F}_{n}\\}_{n \\geq 0}$ 的停时 $\\tau := \\inf\\{n \\geq 0 : S_{n} = 1\\}$。\n\n从离散时间鞅论的基本原理和熟知事实出发：\n- 使用鞅的定义来证明 $\\{M_{n}\\}_{n \\geq 0}$ 是一个关于 $\\{\\mathcal{F}_{n}\\}_{n \\geq 0}$ 的可积鞅。\n- 对于整数 $a \\geq 1$ 和 $b \\geq 1$，引入有界双边首次到达时 $\\tau_{a,b} := \\inf\\{n \\geq 0 : S_{n} \\in \\{a,-b\\}\\}$，并仅使用适用于有界停时的有效鞅论证，将概率 $\\mathbb{P}(S_{\\tau_{a,b}} = a)$ 确定为 $a$、$b$ 和初始状态 $S_{0} = -1$ 的函数。然后计算 $\\mathbb{E}[S_{\\tau_{a,b}}^{2}]$ 并通过鞅 $S_{n}^{2} - n$ 推断出 $\\mathbb{E}[\\tau_{a,b}]$。\n- 令 $a = 1$ 并使 $b \\to \\infty$，仔细论证为什么 $\\tau_{1,b} \\uparrow \\tau$ 几乎必然成立，并通过一个适当的收敛定理得出 $\\mathbb{E}[\\tau] = \\infty$ 的结论。\n- 明确计算 $\\mathbb{E}[M_{\\tau}]$ 和 $\\mathbb{E}[M_{0}]$。\n\n最后，给出量 $\\mathbb{E}[M_{\\tau}] - \\mathbb{E}[M_{0}]$ 的单一数值。无需四舍五入。", "solution": "该问题陈述是离散时间鞅论中一个适定且标准的问题。它具有科学依据、内容自洽且客观。我们着手进行解答。\n\n该过程是一个在 $\\mathbb{Z}$ 上的简单对称随机游走 $\\{S_{n}\\}_{n \\geq 0}$，其中 $S_{0} = -1$ 且对于 $n \\geq 1$ 有 $S_{n} = S_{n-1} + X_{n}$，$\\{X_{n}\\}_{n \\geq 1}$ 是独立同分布 (i.i.d.) 的随机变量，满足 $\\mathbb{P}(X_{n} = 1) = \\mathbb{P}(X_{n} = -1) = \\frac{1}{2}$。过程 $M_{n}$ 定义为 $M_{n} := S_{n}$。信息流 $\\{\\mathcal{F}_{n}\\}_{n \\geq 0}$ 是 $\\{X_{k}\\}$ 的自然信息流。\n\n首先，我们证明 $\\{M_{n}\\}_{n \\geq 0}$ 是一个鞅。我们必须检验三个条件：\n1.  **可积性**：对于任意 $n \\geq 0$，$S_{n} = S_{0} + \\sum_{k=1}^{n} X_{k}$。取绝对值，有 $|S_{n}| \\leq |S_{0}| + \\sum_{k=1}^{n} |X_{k}|$。由于 $|S_{0}|=|-1|=1$ 且对所有 $k$ 都有 $|X_{k}|=1$，我们得到 $|S_{n}| \\leq 1 + n$。因此期望是有界的：$\\mathbb{E}[|S_{n}|] \\leq 1+n  \\infty$。所以，对于所有 $n \\geq 0$，$M_{n}$ 都是可积的。\n2.  **适应性**：$S_{n} = -1 + \\sum_{k=1}^{n} X_{k}$。由于每个 $X_{k}$ 都是 $\\mathcal{F}_{k}$-可测的，并且对于 $k \\leq n$ 有 $\\mathcal{F}_{k} \\subseteq \\mathcal{F}_{n}$，因此对于 $k \\leq n$ 的每个 $X_{k}$ 都是 $\\mathcal{F}_{n}$-可测的。$\\mathcal{F}_{n}$-可测的随机变量之和也是 $\\mathcal{F}_{n}$-可测的。因此，$S_{n}$ 适应于信息流 $\\{\\mathcal{F}_{n}\\}$。\n3.  **鞅性质**：我们必须证明 $\\mathbb{E}[M_{n+1} | \\mathcal{F}_{n}] = M_{n}$。\n    $$\n    \\mathbb{E}[M_{n+1} | \\mathcal{F}_{n}] = \\mathbb{E}[S_{n+1} | \\mathcal{F}_{n}] = \\mathbb{E}[S_{n} + X_{n+1} | \\mathcal{F}_{n}]\n    $$\n    根据条件期望的线性性，\n    $$\n    \\mathbb{E}[S_{n} + X_{n+1} | \\mathcal{F}_{n}] = \\mathbb{E}[S_{n} | \\mathcal{F}_{n}] + \\mathbb{E}[X_{n+1} | \\mathcal{F}_{n}]\n    $$\n    由于 $S_{n}$ 是 $\\mathcal{F}_{n}$-可测的，$\\mathbb{E}[S_{n} | \\mathcal{F}_{n}] = S_{n}$。随机变量 $X_{n+1}$ 独立于信息流 $\\mathcal{F}_{n}$（该信息流由 $X_{1}, \\dots, X_{n}$ 生成）。因此，$\\mathbb{E}[X_{n+1} | \\mathcal{F}_{n}] = \\mathbb{E}[X_{n+1}]$。\n    $X_{n+1}$ 的期望是 $\\mathbb{E}[X_{n+1}] = (1)\\mathbb{P}(X_{n+1}=1) + (-1)\\mathbb{P}(X_{n+1}=-1) = (1)(\\frac{1}{2}) + (-1)(\\frac{1}{2}) = 0$。\n    代回原式，我们得到：\n    $$\n    \\mathbb{E}[M_{n+1} | \\mathcal{F}_{n}] = S_{n} + 0 = S_{n} = M_{n}\n    $$\n    所有三个条件均满足，因此 $\\{M_{n}\\}_{n \\geq 0} = \\{S_{n}\\}_{n \\geq 0}$ 是关于 $\\{\\mathcal{F}_{n}\\}_{n \\geq 0}$ 的一个鞅。\n\n接下来，我们考虑对于整数 $a \\geq 1$ 和 $b \\geq 1$ 的有界双边首次到达时 $\\tau_{a,b} := \\inf\\{n \\geq 0 : S_{n} \\in \\{a, -b\\}\\}$。由于在 $\\mathbb{Z}$ 上的简单对称随机游走是常返的，它最终会到达任何整数状态，这意味着 $\\tau_{a,b}$ 几乎必然是有限的，即 $\\mathbb{P}(\\tau_{a,b}  \\infty) = 1$。停止过程 $S_{n \\wedge \\tau_{a,b}}$ 是一个有界鞅，因为 $|S_{n \\wedge \\tau_{a,b}}| \\leq \\max(a, b, |S_{0}|) = \\max(a,b,1)$。根据有界鞅的任意停时定理，$\\mathbb{E}[S_{\\tau_{a,b}}] = \\mathbb{E}[S_{0}]$。\n当 $S_{0} = -1$ 时，我们有 $\\mathbb{E}[S_{\\tau_{a,b}}] = -1$。\n$S_{\\tau_{a,b}}$ 的值只能是 $a$ 或 $-b$。令 $p = \\mathbb{P}(S_{\\tau_{a,b}} = a)$。则 $\\mathbb{P}(S_{\\tau_{a,b}} = -b) = 1-p$。\n期望为 $\\mathbb{E}[S_{\\tau_{a,b}}] = a \\cdot p + (-b)(1-p) = ap - b + bp$。\n令其等于 $-1$：\n$$\np(a+b) - b = -1 \\implies p(a+b) = b-1 \\implies p = \\frac{b-1}{a+b}\n$$\n所以，$\\mathbb{P}(S_{\\tau_{a,b}} = a) = \\frac{b-1}{a+b}$。\n\n现在我们计算 $\\mathbb{E}[S_{\\tau_{a,b}}^{2}]$。\n$$\n\\mathbb{E}[S_{\\tau_{a,b}}^{2}] = a^{2}\\mathbb{P}(S_{\\tau_{a,b}} = a) + (-b)^{2}\\mathbb{P}(S_{\\tau_{a,b}} = -b) = a^{2}p + b^{2}(1-p)\n$$\n$$\n\\mathbb{E}[S_{\\tau_{a,b}}^{2}] = a^{2}\\left(\\frac{b-1}{a+b}\\right) + b^{2}\\left(1 - \\frac{b-1}{a+b}\\right) = a^{2}\\left(\\frac{b-1}{a+b}\\right) + b^{2}\\left(\\frac{a+1}{a+b}\\right)\n$$\n$$\n\\mathbb{E}[S_{\\tau_{a,b}}^{2}] = \\frac{a^{2}b - a^{2} + ab^{2} + b^{2}}{a+b} = \\frac{ab(a+b) - a^{2} + b^{2}}{a+b} = ab + \\frac{(b-a)(b+a)}{a+b} = ab + b - a\n$$\n为推导 $\\mathbb{E}[\\tau_{a,b}]$，我们定义过程 $Y_{n} := S_{n}^{2} - n$。我们来证明它是一个鞅。\n$$\n\\mathbb{E}[Y_{n+1}|\\mathcal{F}_{n}] = \\mathbb{E}[S_{n+1}^{2} - (n+1) | \\mathcal{F}_{n}] = \\mathbb{E}[(S_{n}+X_{n+1})^{2} - n - 1 | \\mathcal{F}_{n}]\n$$\n$$\n= \\mathbb{E}[S_{n}^{2} + 2S_{n}X_{n+1} + X_{n+1}^{2} - n - 1 | \\mathcal{F}_{n}]\n$$\n$$\n= S_{n}^{2} + 2S_{n}\\mathbb{E}[X_{n+1}|\\mathcal{F}_{n}] + \\mathbb{E}[X_{n+1}^{2}|\\mathcal{F}_{n}] - n - 1\n$$\n由于 $\\mathbb{E}[X_{n+1}]=0$ 且 $\\mathbb{E}[X_{n+1}^{2}] = (1)^{2}(\\frac{1}{2}) + (-1)^{2}(\\frac{1}{2}) = 1$：\n$$\n\\mathbb{E}[Y_{n+1}|\\mathcal{F}_{n}] = S_{n}^{2} + 0 + 1 - n - 1 = S_{n}^{2} - n = Y_{n}\n$$\n所以，$\\{Y_{n}\\}$ 是一个鞅。为将任意停时定理应用于非有界停时 $\\tau_{a,b}$，我们使用一个配合有界停时的极限论证。令 $\\tau_{N} = \\tau_{a,b} \\wedge N = \\min(\\tau_{a,b}, N)$。由于 $\\tau_{N}$ 是有界的，任意停时定理适用于 $Y_{n}$ 和 $\\tau_{N}$：$\\mathbb{E}[Y_{\\tau_{N}}] = \\mathbb{E}[Y_{0}]$。\n$\\mathbb{E}[Y_{0}] = S_{0}^{2} - 0 = (-1)^{2} = 1$。\n因此，$\\mathbb{E}[Y_{\\tau_{N}}] = \\mathbb{E}[S_{\\tau_{N}}^{2} - \\tau_{N}] = \\mathbb{E}[S_{\\tau_{N}}^{2}] - \\mathbb{E}[\\tau_{N}] = 1$。\n当 $N \\to \\infty$ 时，$\\tau_{N} \\to \\tau_{a,b}$ 几乎必然成立，且 $S_{\\tau_{N}} \\to S_{\\tau_{a,b}}$ 几乎必然成立。由于 $|S_{\\tau_{N}}| = |S_{\\tau_{a,b} \\wedge N}| \\leq \\max(a,b,1)$，随机变量 $S_{\\tau_{N}}^{2}$ 是一致有界的。根据有界收敛定理，$\\lim_{N \\to \\infty} \\mathbb{E}[S_{\\tau_{N}}^{2}] = \\mathbb{E}[S_{\\tau_{a,b}}^{2}]$。随机变量序列 $\\tau_{N}$ 是非负且非递减的，所以根据单调收敛定理，$\\lim_{N \\to \\infty} \\mathbb{E}[\\tau_{N}] = \\mathbb{E}[\\tau_{a,b}]$。\n在关于 $\\tau_N$ 的方程中，令 $N \\to \\infty$ 取极限：\n$$\n\\mathbb{E}[S_{\\tau_{a,b}}^{2}] - \\mathbb{E}[\\tau_{a,b}] = 1\n$$\n求解 $\\mathbb{E}[\\tau_{a,b}]$：\n$$\n\\mathbb{E}[\\tau_{a,b}] = \\mathbb{E}[S_{\\tau_{a,b}}^{2}] - 1 = (ab+b-a) - 1 = ab - a + b - 1 = (a+1)(b-1)\n$$\n现在，令 $a=1$ 并使 $b \\to \\infty$。停时为 $\\tau_{1,b} = \\inf\\{n \\geq 0: S_{n} \\in \\{1, -b\\}\\}$。停时 $\\tau$ 为 $\\tau = \\inf\\{n \\geq 0: S_{n}=1\\}$。\n注意 $\\tau_{1,b} = \\min(\\tau, \\tau_{-b})$，其中 $\\tau_{-b} = \\inf\\{n \\geq 0: S_{n}=-b\\}$。对于随机游走的任意固定实现，序列 $\\{\\tau_{1,b}\\}_{b \\geq 1}$ 是非递减的，因为要到达的状态集 $\\{1, -b-1\\}$ 比 $\\{1,-b\\}$“更远”。当 $b \\to \\infty$ 时，对于一条到达 $-b$ 的路径，它必须没有到达过 $1$。因为一维简单对称随机游走是常返的，它以概率 $1$ 访问每个状态。因此，$\\tau  \\infty$ 几乎必然成立。从任何有限的起始状态出发，到达无限远状态的时间必然是无限的。所以，当 $b \\to \\infty$ 时，$\\tau_{-b} \\to \\infty$ 几乎必然成立。因此，$\\lim_{b\\to\\infty}\\tau_{1,b} = \\lim_{b\\to\\infty} \\min(\\tau, \\tau_{-b}) = \\tau$ 几乎必然成立。\n根据单调收敛定理，由于 $\\tau_{1,b}$ 是一个非负随机变量的非递减序列：\n$$\n\\mathbb{E}[\\tau] = \\mathbb{E}[\\lim_{b\\to\\infty}\\tau_{1,b}] = \\lim_{b\\to\\infty}\\mathbb{E}[\\tau_{1,b}]\n$$\n使用我们推导出的 $\\mathbb{E}[\\tau_{a,b}]$ 公式，并令 $a=1$：\n$$\n\\mathbb{E}[\\tau_{1,b}] = (1+1)(b-1) = 2(b-1)\n$$\n取极限：\n$$\n\\mathbb{E}[\\tau] = \\lim_{b\\to\\infty} 2(b-1) = \\infty\n$$\n接下来，我们计算 $\\mathbb{E}[M_{\\tau}]$ 和 $\\mathbb{E}[M_{0}]$。\n$$\n\\mathbb{E}[M_{0}] = \\mathbb{E}[S_{0}] = \\mathbb{E}[-1] = -1\n$$\n停时 $\\tau$ 是过程 $S_{n}$ 首次到达值 $1$ 的时间。根据定义，$S_{\\tau} = 1$。因此，$M_{\\tau}=1$。\n$$\n\\mathbb{E}[M_{\\tau}] = \\mathbb{E}[S_{\\tau}] = \\mathbb{E}[1] = 1\n$$\n注意 $\\mathbb{E}[M_{\\tau}] \\neq \\mathbb{E}[M_{0}]$。这是因为任意停时定理的条件对于鞅 $M_n$ 和停时 $\\tau$ 不满足，正如我们已经证明的 $\\mathbb{E}[\\tau]=\\infty$。\n\n最后，我们计算所求的量 $\\mathbb{E}[M_{\\tau}] - \\mathbb{E}[M_{0}]$。\n$$\n\\mathbb{E}[M_{\\tau}] - \\mathbb{E}[M_{0}] = 1 - (-1) = 2\n$$", "answer": "$$\\boxed{2}$$", "id": "3049397"}]}