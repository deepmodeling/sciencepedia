{"hands_on_practices": [{"introduction": "我们从一个经典问题开始：一个随机运动的粒子，在到达边界A之前先到达边界B的概率是多少？这类问题被称为命中概率问题，是随机过程理论中的一个基石。费曼-卡茨公式的强大之处在于，它能将这个纯粹的概率问题，转化为一个我们更为熟悉的数学物理问题——求解特定边界条件下的拉普拉斯方程。通过这个练习[@problem_id:1338001]，你将亲手体验如何利用该公式，为一个在环形区域内进行二维布朗运动的粒子计算其逃逸方向的概率。", "problem": "一个金吸附原子在完全平坦的银表面上扩散。使用先进的操纵技术，构建了两个同心圆形势垒，形成一个环形区域，吸附原子被暂时限制在该区域内。内势垒的半径为 $R_1$，外势垒的半径为 $R_2$，且 $R_1  R_2$。吸附原子在表面上的运动可以很好地用标准的二维布朗运动来描述。\n\n这些势垒不是完美的；它们可以被穿越。一旦吸附原子的路径与内或外圆形势垒相交，过程就停止。假设吸附原子最初被放置在距离圆心径向距离为 $r_0$ 的位置，使得 $R_1  r_0  R_2$。由于问题的对称性，所求概率将不依赖于具体的角位置，而只依赖于初始的径向距离 $r_0$。\n\n确定吸附原子在穿过半径为 $R_1$ 的内势垒之前穿过半径为 $R_2$ 的外势垒的概率，我们称之为 $P(r_0)$。你的最终答案应该是一个用 $r_0$、$R_1$ 和 $R_2$ 表示的闭式解析表达式。", "solution": "设 $p(r)$ 为粒子从径向距离 $r$ 处开始，在撞击半径为 $R_1$ 的内圆之前撞击半径为 $R_2$ 的外圆的概率。\n\n根据费曼-卡茨公式，这个命中概率 $p(r)$ 必须满足稳态热方程 $\\mathcal{L}p(r) = 0$，其中 $\\mathcal{L}$ 是该过程的无穷小生成元。对于标准的二维布朗运动，生成元为 $\\mathcal{L} = \\frac{1}{2}\\Delta$，其中 $\\Delta$ 是拉普拉斯算子。由于问题的径向对称性，我们可以使用极坐标。概率 $p$ 只依赖于径向坐标 $r$。在极坐标中，拉普拉斯算子作用于一个仅依赖于 $r$ 的函数的形式为：\n$$\n\\Delta p(r) = \\frac{d^2p}{dr^2} + \\frac{1}{r}\\frac{dp}{dr}\n$$\n因此，我们必须求解的偏微分方程 $\\mathcal{L}p(r)=0$ 简化为以下常微分方程（ODE）：\n$$\n\\frac{d^2p}{dr^2} + \\frac{1}{r}\\frac{dp}{dr} = 0\n$$\n令 $q(r) = p'(r)$，该方程变为 $q'(r) + \\frac{1}{r}q(r) = 0$。这是一个可分离变量的一阶ODE，其解为 $q(r) = A/r$，其中 $A$ 是一个常数。再次对 $r$ 积分，我们得到 $p(r)$ 的通解：\n$$\np(r) = \\int \\frac{A}{r} dr = A \\ln r + B\n$$\n其中 $A$ 和 $B$ 是由边界条件决定的积分常数。\n\n边界条件如下：\n1.  如果粒子从内边界 $r = R_1$ 开始，它已经撞击了内圆，因此它在撞击内圆之前撞击外圆的概率为零。所以，$p(R_1) = 0$。\n2.  如果粒子从外边界 $r = R_2$ 开始，它已经撞击了外圆，因此它在撞击内圆之前撞击外圆的概率为一。所以，$p(R_2) = 1$。\n\n将这些条件应用于通解：\n1.  $A \\ln R_1 + B = 0$\n2.  $A \\ln R_2 + B = 1$\n\n从第二个方程中减去第一个方程，我们得到：\n$A(\\ln R_2 - \\ln R_1) = 1 \\implies A \\ln(R_2/R_1) = 1 \\implies A = \\frac{1}{\\ln(R_2/R_1)}$。\n\n将 $A$ 的值代入第一个方程来求解 $B$：\n$B = -A \\ln R_1 = -\\frac{\\ln R_1}{\\ln(R_2/R_1)}$。\n\n因此，概率函数 $p(r)$ 为：\n$$\np(r) = \\frac{\\ln r}{\\ln(R_2/R_1)} - \\frac{\\ln R_1}{\\ln(R_2/R_1)} = \\frac{\\ln r - \\ln R_1}{\\ln(R_2/R_1)} = \\frac{\\ln(r/R_1)}{\\ln(R_2/R_1)}\n$$\n对于从 $r_0$ 开始的粒子，我们只需将 $r=r_0$ 代入即可：\n$$\nP(r_0) = \\frac{\\ln(r_0/R_1)}{\\ln(R_2/R_1)}\n$$", "answer": "$$\\boxed{\\frac{\\ln\\!\\left(\\frac{r_{0}}{R_{1}}\\right)}{\\ln\\!\\left(\\frac{R_{2}}{R_{1}}\\right)}}$$", "id": "1338001"}, {"introduction": "在掌握了如何计算“在哪里”命中之后，一个自然而然的进阶问题是“需要多久”才能命中。这个问题引导我们思考随机过程在停止前的累积行为，例如计算期望退出时间。这个练习[@problem_id:3080617]将向你展示，费曼-卡茨公式如何将这类期望值的计算，与一个非齐次的偏微分方程（具体来说是泊松方程）的解联系起来。通过求解一个一维布朗运动在区间内的期望累积量，你将加深对公式中“运行成本”项的理解。", "problem": "考虑一个一维标准布朗运动 $X_t$，从 $X_0 = x \\in (0,L)$ 出发，其中 $L  0$。设状态空间为开区间 $D = (0,L)$，其在 $0$ 和 $L$ 处有吸收边界。定义首次退出时间 $\\tau = \\inf\\{t \\geq 0 : X_t \\notin D\\}$。设运行累积率为常数函数 $f \\equiv c$，其中 $c  0$。定义泛函\n$$\nu(x) = \\mathbb{E}_x\\left[\\int_{0}^{\\tau} c \\, dt\\right],\n$$\n它表示直到退出前的预期累积量。\n\n仅使用随机分析的基本原理（特别是，针对布朗运动的时间齐次函数的伊藤公式以及布朗运动无穷小生成元的刻画），推导 $u$ 必须满足的边值问题，并显式求解该问题，以获得 $u(x)$ 关于 $c$、$L$ 和 $x$ 的闭式解析表达式。\n\n你的最终答案必须是单一的闭式表达式。不需要四舍五入，也不涉及单位。", "solution": "问题要求解泛函 $u(x) = \\mathbb{E}_x\\left[\\int_{0}^{\\tau} c \\, dt\\right]$ 的显式闭式表达式，其中 $X_t$ 是从 $X_0=x \\in (0,L)$ 开始的一维标准布朗运动，$\\tau$ 是从开区间 $D=(0,L)$ 的首次退出时间，而 $c$ 是一个正常数。推导过程必须使用随机分析的基本原理。\n\n首先，我们可以简化 $u(x)$ 的表达式。由于 $c$ 是常数，我们可以将其从积分和期望中提出：\n$$\nu(x) = \\mathbb{E}_x\\left[c \\int_{0}^{\\tau} 1 \\, dt\\right] = c \\, \\mathbb{E}_x\\left[\\tau\\right]\n$$\n这表明 $u(x)$ 与从区间 $(0,L)$ 退出的期望时间成正比。我们的目标是找到 $u(x)$ 必须满足的微分方程。\n\n我们将使用的核心原理是构造一个鞅。设 $u(x)$ 是 $C^2((0,L))$ 中的一个函数，即在 $(0,L)$ 上二次连续可微的函数空间。过程 $X_t$ 是一个标准布朗运动，因此其随机微分方程为 $dX_t = dB_t$，其中 $B_t$ 是一个标准维纳过程。$X_t$ 的二次变分为 $d[X]_t = dt$。\n\n我们定义一个新过程 $M_t = u(X_t) + \\int_0^t c \\, ds = u(X_t) + ct$。我们将找到函数 $u(x)$，使得停时过程 $M_{t \\wedge \\tau}$ 是一个鞅。如果一个过程的漂移项为零，那么它就是一个鞅。为了找到漂移项，我们对 $u(X_t)$ 应用伊藤公式。对于时间齐次函数 $u(x)$，伊藤公式表述为：\n$$\ndu(X_t) = u'(X_t) dX_t + \\frac{1}{2} u''(X_t) d[X]_t\n$$\n代入 $dX_t = dB_t$ 和 $d[X]_t = dt$，我们得到：\n$$\ndu(X_t) = u'(X_t) dB_t + \\frac{1}{2} u''(X_t) dt\n$$\n现在，我们来求过程 $M_t$ 的微分：\n$$\ndM_t = du(X_t) + d(ct) = \\left(u'(X_t) dB_t + \\frac{1}{2} u''(X_t) dt\\right) + c \\, dt\n$$\n$$\ndM_t = u'(X_t) dB_t + \\left(\\frac{1}{2} u''(X_t) + c\\right) dt\n$$\n为了使 $M_t$ 成为局部鞅，其漂移项（$dt$ 的系数）对于所有 $x \\in (0,L)$ 都必须为零。项 $\\frac{1}{2}u''(x)$ 是标准布朗运动的无穷小生成元 $\\mathcal{A} = \\frac{1}{2}\\frac{d^2}{dx^2}$ 作用于函数 $u(x)$ 的结果。漂移项为零的条件，即 $\\mathcal{A}u(x) + c = 0$，给了我们以下二阶常微分方程（ODE）：\n$$\n\\frac{1}{2} u''(x) + c = 0\n$$\n简化为：\n$$\nu''(x) = -2c\n$$\n此常微分方程必须对所有 $x \\in D = (0,L)$ 成立。\n\n接下来，我们必须确定此常微分方程的边界条件。泛函 $u(x)$ 是根据首次退出时间 $\\tau = \\inf\\{t \\geq 0 : X_t \\notin (0,L)\\}$ 定义的。如果过程从某个边界开始，即 $x=0$ 或 $x=L$，它已经不在开区间 $D=(0,L)$ 内。因此，首次退出时间为 $\\tau=0$。\n对于 $x=0$：\n$$\nu(0) = \\mathbb{E}_0\\left[\\int_{0}^{0} c \\, dt\\right] = \\mathbb{E}_0[0] = 0\n$$\n对于 $x=L$：\n$$\nu(L) = \\mathbb{E}_L\\left[\\int_{0}^{0} c \\, dt\\right] = \\mathbb{E}_L[0] = 0\n$$\n因此，我们有一个由常微分方程和两个边界条件组成的边值问题（BVP）：\n$$\n\\begin{cases}\nu''(x) = -2c,   x \\in (0,L) \\\\\nu(0) = 0 \\\\\nu(L) = 0\n\\end{cases}\n$$\n我们通过对 $x$ 进行两次积分来求解这个边值问题。\n第一次积分得到导数 $u'(x)$：\n$$\nu'(x) = \\int -2c \\, dx = -2cx + A\n$$\n其中 $A$ 是一个积分常数。\n第二次积分得到 $u(x)$：\n$$\nu(x) = \\int (-2cx + A) \\, dx = -c x^2 + Ax + B\n$$\n其中 $B$ 是第二个积分常数。\n\n现在，我们应用边界条件来确定常数 $A$ 和 $B$。\n使用 $u(0) = 0$：\n$$\n-c(0)^2 + A(0) + B = 0 \\implies B=0\n$$\n解简化为 $u(x) = -cx^2 + Ax$。\n使用 $u(L) = 0$：\n$$\n-cL^2 + A L = 0\n$$\n因为问题中给定 $L  0$，我们可以两边除以 $L$：\n$$\n-cL + A = 0 \\implies A = cL\n$$\n将确定的值 $A=cL$ 和 $B=0$ 代回到 $u(x)$ 的通解中，我们得到显式的闭式表达式：\n$$\nu(x) = -cx^2 + (cL)x\n$$\n我们可以对这个表达式进行因式分解，使其更紧凑：\n$$\nu(x) = cx(L-x)\n$$\n这个函数表示布朗运动从位置 $x$ 开始，直到退出区间 $(0,L)$ 为止的预期累积量 $c$。", "answer": "$$\\boxed{cx(L-x)}$$", "id": "3080617"}, {"introduction": "最后，我们将挑战一个更综合的含时演化问题，这也是费曼-卡茨公式最强大的应用领域之一。我们不再仅仅关注首次命中事件，而是要完整描述一个系统的概率分布如何随时间演化。本练习[@problem_id:3080589]将带你应用费曼-卡茨公式，为一个重要的随机过程——奥恩斯坦-乌伦贝克过程，求解其在给定高斯初始条件下的概率密度演化。这不仅是理论的深化，也直接关联到它在金融物理等领域的实际应用。", "problem": "考虑由下式给出的一维 Ornstein–Uhlenbeck 过程的 Itô 随机微分方程 (SDE)\n$$\ndX_{t}=-\\theta\\,X_{t}\\,dt+\\sigma\\,dW_{t},\\qquad X_{0}=x,\n$$\n其中 $\\theta0$，$\\sigma0$，$x\\in\\mathbb{R}$，且 $(W_{t})_{t\\geq 0}$ 是一个标准布朗运动。令 $\\mathcal{L}$ 表示与此 SDE 相关联的无穷小生成元。将 $u:[0,\\infty)\\times\\mathbb{R}\\to\\mathbb{R}$ 定义为线性抛物型偏微分方程\n$$\n\\partial_{t}u(t,x)=\\mathcal{L}u(t,x),\\qquad t0,\\ x\\in\\mathbb{R},\n$$\n的经典解，其初始条件为高斯形式\n$$\nu(0,x)=g(x):=\\exp\\!\\big(-a\\,x^{2}+b\\,x+c\\big),\n$$\n其中 $a0$，$b\\in\\mathbb{R}$ 和 $c\\in\\mathbb{R}$ 是固定常数。从 Itô 扩散的生成元和连续时间马尔可夫半群的基本定义出发，并仅使用由 Feynman–Kac (F-K) 公式给出的扩散生成元与线性抛物型方程之间的基本关系，推导 $u(t,x)$ 关于 $X_{t}$ 分布的期望表示，并显式计算 $u(t,x)$。将您的最终答案表示为包含 $a$、$b$、$c$、$\\theta$、$\\sigma$、$t$ 和 $x$ 的单一闭式解析表达式。无需四舍五入，也不涉及单位。", "solution": "该问题要求解一个线性抛物型偏微分方程 (PDE) 的显式解 $u(t,x)$，该方程的生成元与一个 Ornstein-Uhlenbeck 过程相关联，并具有高斯初始条件。推导过程必须使用 Feynman–Kac 公式。\n\n**步骤 1：无穷小生成元**\n对于一般的一维 Itô 扩散 $dY_t = \\mu(Y_t) dt + \\eta(Y_t) dW_t$，作用于一个足够光滑的函数 $f(y)$ 的无穷小生成元 $\\mathcal{L}$ 由下式给出\n$$\n\\mathcal{L}f(y) = \\mu(y) \\frac{df}{dy}(y) + \\frac{1}{2} \\eta(y)^2 \\frac{d^2f}{dy^2}(y).\n$$\n对于给定的 Ornstein–Uhlenbeck 过程，漂移系数为 $\\mu(x) = -\\theta x$，扩散系数为 $\\eta(x) = \\sigma$（一个常数）。因此，生成元为\n$$\n\\mathcal{L} = -\\theta x \\frac{\\partial}{\\partial x} + \\frac{\\sigma^2}{2} \\frac{\\partial^2}{\\partial x^2}.\n$$\n\n**步骤 2：Feynman–Kac 表示**\n给定的 PDE 是 $\\partial_{t}u(t,x)=\\mathcal{L}u(t,x)$，初始条件为 $u(0,x)=g(x)$。这是与过程 $X_t$ 相关联的向前 Kolmogorov 方程。Feynman–Kac 公式（在其最简单的形式下，对应于零势能）将解表示为关于从 $x$ 出发的随机过程 $X_t$ 的定律的期望。\n令 $X_t^x$ 表示初始条件为 $X_0=x$ 的 SDE 的解。该 PDE 的解为\n$$\nu(t,x) = \\mathbb{E}[g(X_t^x)].\n$$\n代入 $g(x)$ 的给定形式，我们有\n$$\nu(t,x) = \\mathbb{E}\\big[\\exp(-a\\,(X_t^x)^{2}+b\\,X_t^x+c)\\big].\n$$\n\n**步骤 3：Ornstein–Uhlenbeck 过程的解**\nSDE $dX_{t}=-\\theta\\,X_{t}\\,dt+\\sigma\\,dW_{t}$ 是一个线性 SDE，其解是高斯过程。从 $X_0=x$ 开始的解为：\n$$\nX_t^x = x e^{-\\theta t} + \\sigma \\int_0^t e^{-\\theta(t-s)} dW_s.\n$$\n$X_t^x$ 是一个高斯随机变量。我们计算其均值和方差。\n均值为：\n$$\n\\mu_t(x) = \\mathbb{E}[X_t^x] = x e^{-\\theta t},\n$$\n因为 Itô 积分的期望为零。\n根据 Itô 等距定理，方差为：\n$$\n\\Sigma_t^2 = \\text{Var}(X_t^x) = \\mathbb{E}[(X_t^x - \\mu_t(x))^2] = \\sigma^2 \\int_0^t \\left(e^{-\\theta(t-s)}\\right)^2 ds = \\frac{\\sigma^2}{2\\theta}(1-e^{-2\\theta t}).\n$$\n因此，$X_t^x$ 服从正态分布，$X_t^x \\sim \\mathcal{N}\\left(\\mu_t(x), \\Sigma_t^2\\right)$，其中均值依赖于 $x$ 但方差不依赖于 $x$。\n\n**步骤 4：计算期望**\n我们需要计算 $u(t,x) = \\mathbb{E}[\\exp(-a(X_t^x)^2 + bX_t^x + c)]$。令 $X_t^x$ 表示为 $X_t^x = \\mu_t(x) + \\Sigma_t Z$，其中 $Z \\sim \\mathcal{N}(0,1)$。\n$$\nu(t,x) = e^c \\, \\mathbb{E}\\left[\\exp\\left(-a(\\mu_t(x)+\\Sigma_t Z)^2 + b(\\mu_t(x)+\\Sigma_t Z)\\right)\\right]\n$$\n$$\nu(t,x) = e^c \\exp(-a\\mu_t(x)^2 + b\\mu_t(x)) \\, \\mathbb{E}\\left[\\exp\\left(-a\\Sigma_t^2 Z^2 + (b\\Sigma_t - 2a\\mu_t(x)\\Sigma_t)Z\\right)\\right].\n$$\n我们使用高斯期望的通用公式：对于 $Z \\sim \\mathcal{N}(0,1)$ 和常数 $A, B$（其中 $1+2A>0$），\n$$\n\\mathbb{E}[\\exp(-AZ^2+BZ)] = \\frac{1}{\\sqrt{1+2A}}\\exp\\left(\\frac{B^2}{2(1+2A)}\\right).\n$$\n在我们的例子中，$A = a\\Sigma_t^2$ 且 $B = (b - 2a\\mu_t(x))\\Sigma_t$。由于 $a0$ 且 $\\Sigma_t^2 \\geq 0$，条件得到满足。\n代入并化简指数部分可得：\n$$\nu(t,x) = \\frac{e^c}{\\sqrt{1+2a\\Sigma_t^2}} \\exp\\left(-a\\mu_t(x)^2 + b\\mu_t(x) + \\frac{\\Sigma_t^2(b-2a\\mu_t(x))^2}{2(1+2a\\Sigma_t^2)}\\right).\n$$\n将指数部分通分化简：\n$$\n\\text{指数} = c + \\frac{(-a\\mu_t(x)^2+b\\mu_t(x))(1+2a\\Sigma_t^2) + \\frac{1}{2}\\Sigma_t^2(b-2a\\mu_t(x))^2}{1+2a\\Sigma_t^2}\n$$\n$$\n= c + \\frac{-a\\mu_t(x)^2 + b\\mu_t(x) + \\frac{1}{2}b^2\\Sigma_t^2}{1+2a\\Sigma_t^2}\n$$\n因此，$u(t,x)$ 的完整表达式变为：\n$$\nu(t,x) = \\frac{1}{\\sqrt{1+2a\\Sigma_t^2}} \\exp\\left(c + \\frac{-a\\mu_t(x)^2 + b\\mu_t(x) + \\frac{1}{2}b^2\\Sigma_t^2}{1+2a\\Sigma_t^2}\\right).\n$$\n最后，我们代入 $\\mu_t(x) = xe^{-\\theta t}$ 和 $\\Sigma_t^2 = \\frac{\\sigma^2}{2\\theta}(1-e^{-2\\theta t})$ 的表达式：\n$$\nu(t,x) = \\frac{1}{\\sqrt{1+\\frac{a\\sigma^2}{\\theta}(1-e^{-2\\theta t})}} \\exp\\left(c + \\frac{-a x^{2} e^{-2\\theta t} + b x e^{-\\theta t} + \\frac{b^2\\sigma^2}{4\\theta}(1-e^{-2\\theta t})}{1+\\frac{a\\sigma^2}{\\theta}(1-e^{-2\\theta t})}\\right).\n$$", "answer": "$$\\boxed{\\frac{1}{\\sqrt{1+\\frac{a\\sigma^{2}}{\\theta}(1-\\exp(-2\\theta t))}} \\exp\\left(c + \\frac{-a x^{2} \\exp(-2\\theta t) + b x \\exp(-\\theta t) + \\frac{b^2\\sigma^2}{4\\theta}(1-\\exp(-2\\theta t))}{1+\\frac{a\\sigma^2}{\\theta}(1-\\exp(-2\\theta t))}\\right)}$$", "id": "3080589"}]}