{"hands_on_practices": [{"introduction": "要真正掌握强马尔可夫性，最好的起点是直接应用其定义。这个练习将帮助你内化强马尔可夫性的核心思想：在任意一个停时 $\\tau$ 刻，过程将“忘记”过去，并从当前状态 $B_{\\tau}$ 重新开始，其未来的演化规律与一个从原点开始的全新布朗运动完全相同。通过计算停时后一个固定时间增量的分布，你会亲手验证这个“重启”的特性。[@problem_id:3079174]", "problem": "设 $\\{B_{t}\\}_{t \\geq 0}$ 是一个在满足通常条件的带滤概率空间 $(\\Omega,\\mathcal{F},\\{\\mathcal{F}_{t}\\}_{t \\geq 0},\\mathbb{P})$ 上的标准布朗运动（也称为维纳过程）。回顾强马尔可夫性：对于关于 $\\{\\mathcal{F}_{t}\\}$ 的任意停时 $\\tau$，过程 $\\{B_{\\tau + s} - B_{\\tau}\\}_{s \\geq 0}$ 独立于 $\\mathcal{F}_{\\tau}$，且与 $\\{B_{s}\\}_{s \\geq 0}$ 具有相同的分布。假设 $\\tau$ 是一个有界停时（即存在一个确定性常数 $M>0$ 使得 $\\tau \\leq M$ 几乎必然成立）。固定一个确定性常数 $a>0$。\n\n仅使用标准布朗运动的定义性质（独立平稳增量、均值为 $0$ 且方差与时间间隔成正比的高斯增量）以及强马尔可夫性，确定增量 $B_{\\tau + a} - B_{\\tau}$ 的概率密度函数，该函数应为实变量 $x$ 和参数 $a$ 的显式函数。\n\n你的最终答案必须是该密度函数关于 $x$ 和 $a$ 的单个闭式解析表达式。无需四舍五入。", "solution": "问题要求确定随机变量 $X = B_{\\tau + a} - B_{\\tau}$ 的概率密度函数（PDF），其中 $\\{B_t\\}_{t \\geq 0}$ 是标准布朗运动，$\\tau$ 是有界停时，且 $a>0$ 是一个确定性常数。题目要求我们使用布朗运动的定义性质和强马尔可夫性。\n\n设给定的带滤概率空间为 $(\\Omega, \\mathcal{F}, \\{\\mathcal{F}_t\\}_{t \\geq 0}, \\mathbb{P})$，满足通常条件。过程 $\\{B_t\\}_{t \\geq 0}$ 是适应于此信息流的标准布朗运动。停时 $\\tau$ 是一个随机变量 $\\tau: \\Omega \\to [0, \\infty)$，使得对于每个 $t \\geq 0$，事件 $\\{\\omega \\in \\Omega : \\tau(\\omega) \\leq t\\}$ 属于 $\\mathcal{F}_t$。问题陈述 $\\tau$ 是一个有界停时，这意味着存在一个常数 $M > 0$ 使得 $\\mathbb{P}(\\tau \\leq M) = 1$。这蕴含了 $\\tau$ 是一个几乎必然有限的停时。\n\n问题明确给出了布朗运动的强马尔可夫性的陈述：对于任意停时 $\\tau$，由 $W_s = B_{\\tau+s} - B_{\\tau}$（$s \\geq 0$）定义的过程是一个标准布朗运动，并且这个新过程 $\\{W_s\\}_{s \\geq 0}$ 独立于 $\\tau$ 前 $\\sigma$-代数 $\\mathcal{F}_{\\tau}$。符号 $\\mathcal{F}_{\\tau}$ 代表由过程在随机时间 $\\tau$ 之前的历史所决定的事件集合，定义为 $\\mathcal{F}_{\\tau} = \\{A \\in \\mathcal{F} : A \\cap \\{\\tau \\leq t\\} \\in \\mathcal{F}_t \\text{ for all } t \\geq 0 \\}$。\n\n我们的目标是找到随机变量 $X = B_{\\tau + a} - B_{\\tau}$ 的概率密度函数。根据所给定义，这个随机变量恰好是过程 $\\{W_s\\}_{s \\geq 0}$ 在特定时间 $s=a$ 的值。也就是说，$X = W_a$。\n\n根据强马尔可夫性，随机过程 $\\{W_s\\}_{s \\geq 0}$ 是一个标准布朗运动。这意味着 $\\{W_s\\}_{s \\geq 0}$ 与原始布朗运动 $\\{B_s\\}_{s \\geq 0}$ 具有相同的分布性质。\n\n标准布朗运动 $\\{B_t\\}_{t \\geq 0}$ 的一个定义性质是，对于任意固定时间 $t > 0$，随机变量 $B_t$ 服从均值为 $0$、方差为 $t$ 的正态分布。我们记为 $B_t \\sim \\mathcal{N}(0, t)$。\n\n由于过程 $\\{W_s\\}_{s \\geq 0}$ 是一个标准布朗运动，随机变量 $W_a$（对于固定的 $a>0$）也必须服从均值为 $0$、方差为 $a$ 的正态分布。因此，\n$$\nW_a \\sim \\mathcal{N}(0, a)\n$$\n既然我们已经确定 $X = B_{\\tau + a} - B_{\\tau} = W_a$，直接可得随机变量 $X$ 也服从此分布：\n$$\nX \\sim \\mathcal{N}(0, a)\n$$\n关键要注意的是，这个结果与停时 $\\tau$ 的具体特性无关，只要它是一个有效（几乎必然有限）的停时即可。问题陈述中给出的 $\\tau$ 的有界性保证了此条件。\n\n一般正态分布 $\\mathcal{N}(\\mu, \\sigma^2)$ 的概率密度函数由以下公式给出：\n$$\nf(x; \\mu, \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(x - \\mu)^2}{2\\sigma^2}\\right)\n$$\n对于我们的随机变量 $X \\sim \\mathcal{N}(0, a)$，参数为均值 $\\mu = 0$ 和方差 $\\sigma^2 = a$。将这些值代入通用公式，我们得到 $X = B_{\\tau + a} - B_{\\tau}$ 关于实变量 $x$ 和参数 $a$ 的概率密度函数：\n$$\nf_X(x) = \\frac{1}{\\sqrt{2\\pi a}} \\exp\\left(-\\frac{(x - 0)^2}{2a}\\right)\n$$\n$$\nf_X(x) = \\frac{1}{\\sqrt{2\\pi a}} \\exp\\left(-\\frac{x^2}{2a}\\right)\n$$\n这就是所求的概率密度函数。", "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{2\\pi a}} \\exp\\left(-\\frac{x^2}{2a}\\right)}\n$$", "id": "3079174"}, {"introduction": "在掌握了基本定义后，让我们来看一个更巧妙且强大的应用：反射原理。这个著名的结果展示了强马尔可夫性如何通过对称性论证，解决一个看似棘手的问题——计算布朗运动在一段时间内的最大值分布。在应用该原理之前，我们首先需要严格证明一个关键的随机时间（首次到达时间）确实是一个合法的停时，这本身也是一个重要的基础练习。[@problem_id:3079166]", "problem": "设 $\\{B_t\\}_{t \\ge 0}$ 为一维标准布朗运动（BM），从 $B_0 = 0$ 出发，定义在一个满足通常条件的带域流的概率空间 $(\\Omega,\\mathcal{F},\\{\\mathcal{F}_t\\}_{t \\ge 0},\\mathbb{P})$ 上，其中 $\\{\\mathcal{F}_t\\}_{t \\ge 0}$ 是增广自然域流。对于一个固定的水平 $a > 0$，定义水平 $a$ 的首次到达时为\n$$\n\\tau_a := \\inf\\{t \\ge 0 : B_t = a\\}.\n$$\n仅使用布朗运动的基本性质（平稳独立增量、高斯增量且其方差与时间间隔成正比、路径连续性和强马尔可夫性），回答以下问题。\n\n1) 根据基本定义证明，$\\tau_a$ 是关于 $\\{\\mathcal{F}_t\\}_{t \\ge 0}$ 的一个停时。特别地，请仔细论证为什么对于每个 $t \\ge 0$，事件 $\\{\\tau_a \\le t\\}$ 都属于 $\\mathcal{F}_t$。\n\n2) 设 $M_t := \\sup_{0 \\le s \\le t} B_s$。利用布朗运动在停时 $\\tau_a$ 的强马尔可夫性，计算概率\n$$\n\\mathbb{P}_0\\!\\left(M_t \\ge a\\right)\n$$\n对于固定的 $a > 0$ 和 $t > 0$，以标准正态累积分布函数 $\\Phi(x) := \\int_{-\\infty}^{x} \\frac{1}{\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{u^2}{2}\\right) \\, du$ 的闭式形式表示。请用一个包含 $a$ 和 $t$ 的、使用 $\\Phi$ 的单一解析表达式来表示你的最终答案。", "solution": "这是一个分为两部分的问题，关于从 $B_0=0$ 出发的一维标准布朗运动 $\\{B_t\\}_{t \\ge 0}$ 的基本性质。我们首先证明水平 $a > 0$ 的首次到達時是一个停时，然后计算该过程的运行最大值在时间 $t$ 之前超过此水平的概率。\n\n首先，我们来证明 $\\tau_a := \\inf\\{t \\ge 0 : B_t = a\\}$ 是关于增广自然域流 $\\{\\mathcal{F}_t\\}_{t \\ge 0}$ 的一个停时。根据定义，一个随机时间 $\\tau$ 是停时，如果对于任意 $t \\ge 0$，事件 $\\{\\tau \\le t\\}$ 都属于 $\\sigma$-代数 $\\mathcal{F}_t$。\n\n设 $t \\ge 0$ 为一个固定的时间。我们必须证明集合 $\\{\\omega \\in \\Omega : \\tau_a(\\omega) \\le t\\}$ 是 $\\mathcal{F}_t$ 的一个元素。我们可以通过考虑布朗运动的运行最大值 $M_t := \\sup_{0 \\le s \\le t} B_s$ 来重写这个事件。事件 $\\{\\tau_a \\le t\\}$ 等价于事件 $\\{M_t \\ge a\\}$。为了看出此等价性，考虑两个蕴含关系：\n1. 如果 $\\tau_a(\\omega) \\le t$，那么存在某个时间 $s_0 = \\tau_a(\\omega) \\in [0, t]$ 使得 $B_{s_0}(\\omega) = a$。因此，过程在 $[0, t]$ 上的上确界 $M_t(\\omega) = \\sup_{0 \\le s \\le t} B_s(\\omega)$ 必须至少为 $a$。所以，$\\{\\tau_a \\le t\\} \\subseteq \\{M_t \\ge a\\}$。\n2. 如果 $M_t(\\omega) \\ge a$，那么 $\\sup_{0 \\le s \\le t} B_s(\\omega) \\ge a$。因为 $B_0 = 0$ 且 $a > 0$，并且样本路径 $s \\mapsto B_s(\\omega)$ 是几乎必然连续的，根据介值定理，对于任何这样的路径，必定至少存在一个时间 $s_1 \\in [0, t]$ 使得 $B_{s_1}(\\omega) = a$。所有这类时间的下确界 $\\tau_a(\\omega)$ 因此必须小于或等于 $t$。所以，$\\{M_t \\ge a\\} \\subseteq \\{\\tau_a \\le t\\}$。\n结合这两个包含关系，我们得到事件的相等性：$\\{\\tau_a \\le t\\} = \\{M_t \\ge a\\}$。\n\n问题现在简化为证明事件 $\\{M_t \\ge a\\}$ 属于 $\\mathcal{F}_t$。这需要证明随机变量 $M_t$ 是 $\\mathcal{F}_t$-可测的。域流 $\\mathcal{F}_t$ 是由过程截至时间 $t$ 生成的增广 $\\sigma$-代数，即 $\\mathcal{F}_t = \\sigma(B_s : 0 \\le s \\le t)$ 并用所有 $\\mathbb{P}$-零测集完备化。\n由于布朗路径的几乎必然连续性，连续区间 $[0, t]$ 上的上确界可以通过在一个越来越稠密的离散点集上取上确界的极限来找到。对于每个整数 $n \\ge 1$，我们考虑一个离散的时间点集 $D_n = \\{k t 2^{-n} : k=0, 1, \\dots, 2^n\\}$。令 $M_t^{(n)} = \\max_{s \\in D_n, s \\le t} B_s$。对于每个满足 $s \\le t$ 的 $s \\in D_n$，随机变量 $B_s$ 根据定义是 $\\mathcal{F}_t$-可测的。因为有限个 $\\mathcal{F}_t$-可测随机变量的最大值也是 $\\mathcal{F}_t$-可测的，所以对于每个 $n$，$M_t^{(n)}$ 是 $\\mathcal{F}_t$-可测的。\n因为布朗运动的路径是连续的，所以当 $n \\to \\infty$ 时，集合 $D_n$ 的并集在 $[0, t]$ 中变得稠密，因此随机变量序列 $M_t^{(n)}$ 几乎必然收敛于 $M_t = \\sup_{0 \\le s \\le t} B_s$。一个 $\\mathcal{F}_t$-可测函数序列的极限是 $\\mathcal{F}_t$-可测的（此处，域流的完备性，作为“通常条件”的一部分，确保了可测函数的任何几乎必然极限都是可测的）。因此，$M_t$ 是一个 $\\mathcal{F}_t$-可测的随机变量。\n由于 $M_t$ 是 $\\mathcal{F}_t$-可测的，水平集 $\\{M_t \\ge a\\}$ 是 $\\mathcal{F}_t$ 中的一个事件。这就完成了对所有 $t \\ge 0$ 都有 $\\{\\tau_a \\le t\\} \\in \\mathcal{F}_t$ 的证明，从而确定了 $\\tau_a$ 是一个停时。\n\n接下来，我们利用在停时 $\\tau_a$ 的强马尔可夫性来计算概率 $\\mathbb{P}_0(M_t \\ge a)$，其中 $a > 0$ 且 $t > 0$。如前所述，这等价于计算 $\\mathbb{P}(\\tau_a \\le t)$。我们根据过程在时间 $t$ 的值来分解这个概率：\n$$ \\mathbb{P}(\\tau_a \\le t) = \\mathbb{P}(\\tau_a \\le t \\text{ and } B_t \\ge a) + \\mathbb{P}(\\tau_a \\le t \\text{ and } B_t  a) $$\n由于 $B_t$ 的分布是连续的，$\\mathbb{P}(B_t = a) = 0$，所以我们可以不失一般性地使用严格不等式。如前所述，如果 $B_t \\ge a$，那么根据从 $B_0=0$ 开始的路径连续性，水平 $a$ 必须在时间 $t$ 或之前被穿过，这意味着 $\\tau_a \\le t$。因此，事件 $\\{\\tau_a \\le t \\text{ and } B_t \\ge a\\}$ 与事件 $\\{B_t \\ge a\\}$ 是相同的。我们的分解变为：\n$$ \\mathbb{P}(\\tau_a \\le t) = \\mathbb{P}(B_t \\ge a) + \\mathbb{P}(\\tau_a \\le t \\text{ and } B_t  a) $$\n该关系通常被称为反射原理。为了计算右边的第二项，我们在停时 $\\tau_a$ 处应用强马尔可夫性。该性质指出，在给定截至时间 $\\tau_a$ 的信息（即以 $\\mathcal{F}_{\\tau_a}$ 为条件）下，过程 $W_s := B_{\\tau_a+s} - B_{\\tau_a}$ 是一个独立于 $\\mathcal{F}_{\\tau_a}$ 的标准布朗运动。\n在事件 $\\{\\tau_a \\le t\\}$ 上，我们有 $B_t = B_{\\tau_a} + (B_t - B_{\\tau_a})$。由于在该事件上 $B_{\\tau_a} = a$，条件 $B_t  a$ 等价于 $B_t - B_{\\tau_a}  0$。对称地，条件 $B_t  a$ 等价于 $B_t - B_{\\tau_a}  0$。\n根据全期望定律和强马尔可夫性：\n$$ \\mathbb{P}(\\tau_a \\le t \\text{ and } B_t  a) = \\mathbb{E}\\left[ \\mathbb{I}_{\\{\\tau_a \\le t\\}} \\mathbb{I}_{\\{B_t  a\\}} \\right] = \\mathbb{E}\\left[ \\mathbb{E}\\left[ \\mathbb{I}_{\\{\\tau_a \\le t\\}} \\mathbb{I}_{\\{B_t  a\\}} \\middle| \\mathcal{F}_{\\tau_a} \\right] \\right] $$\n由于 $\\mathbb{I}_{\\{\\tau_a \\le t\\}}$ 是 $\\mathcal{F}_{\\tau_a}$-可测的，我们可以将其从内层期望中提出：\n$$ = \\mathbb{E}\\left[ \\mathbb{I}_{\\{\\tau_a \\le t\\}} \\mathbb{P}(B_t  a \\mid \\mathcal{F}_{\\tau_a}) \\right] = \\mathbb{E}\\left[ \\mathbb{I}_{\\{\\tau_a \\le t\\}} \\mathbb{P}(B_t - B_{\\tau_a}  0 \\mid \\mathcal{F}_{\\tau_a}) \\right] $$\n增量 $B_t - B_{\\tau_a}$ 是新的布朗运动 $W$ 在时间 $t-\\tau_a$ 处的值，其中 $t-\\tau_a$ 是一个正的、$\\mathcal{F}_{\\tau_a}$-可测的随机时间。由于新的布朗运动 $W$ 的独立性和对称性，对于任何 $s' = t-\\tau_a  0$，我们有 $\\mathbb{P}(W_{s'}  0 \\mid \\mathcal{F}_{\\tau_a}) = 1/2$。\n因此，\n$$ \\mathbb{P}(\\tau_a \\le t \\text{ and } B_t  a) = \\mathbb{E}\\left[ \\mathbb{I}_{\\{\\tau_a \\le t\\}} \\cdot \\frac{1}{2} \\right] = \\frac{1}{2} \\mathbb{P}(\\tau_a \\le t) $$\n通过同样的论证，$\\mathbb{P}(\\tau_a \\le t \\text{ and } B_t  a) = \\frac{1}{2} \\mathbb{P}(\\tau_a \\le t)$。正如我们前面指出的，这个事件与 $\\{B_t  a\\}$ 是相同的。所以，我们得到了关键关系：\n$$ \\mathbb{P}(B_t  a) = \\frac{1}{2} \\mathbb{P}(\\tau_a \\le t) $$\n这意味着 $\\mathbb{P}(\\tau_a \\le t) = 2\\mathbb{P}(B_t  a)$。\n随机变量 $B_t$ 服从均值为 $0$、方差为 $t$ 的正态分布，即 $B_t \\sim \\mathcal{N}(0, t)$。令 $Z = B_t/\\sqrt{t}$ 为一个标准正态随机变量，$Z \\sim \\mathcal{N}(0, 1)$。我们可以计算该概率：\n$$ \\mathbb{P}(B_t  a) = \\mathbb{P}\\left(\\frac{B_t}{\\sqrt{t}}  \\frac{a}{\\sqrt{t}}\\right) = \\mathbb{P}\\left(Z  \\frac{a}{\\sqrt{t}}\\right) $$\n用标准正态累积分布函数 $\\Phi(x) = \\mathbb{P}(Z \\le x)$ 表示，该概率为：\n$$ \\mathbb{P}\\left(Z  \\frac{a}{\\sqrt{t}}\\right) = 1 - \\mathbb{P}\\left(Z \\le \\frac{a}{\\sqrt{t}}\\right) = 1 - \\Phi\\left(\\frac{a}{\\sqrt{t}}\\right) $$\n最后，我们将此代回我们所求概率的表达式中：\n$$ \\mathbb{P}_0(M_t \\ge a) = \\mathbb{P}(\\tau_a \\le t) = 2\\mathbb{P}(B_t  a) = 2\\left(1 - \\Phi\\left(\\frac{a}{\\sqrt{t}}\\right)\\right) $$\n这就是标准布朗运动的最大值在时间 $t$ 之前达到水平 $a$ 的概率的闭式解。", "answer": "$$\n\\boxed{2\\left(1 - \\Phi\\left(\\frac{a}{\\sqrt{t}}\\right)\\right)}\n$$", "id": "3079166"}, {"introduction": "强马尔可夫性的威力远不止于分析布朗运动本身，它更是连接随机过程与偏微分方程（PDE）理论的桥梁。这个练习将我们的视野从布朗运动扩展到更一般的伊藤过程，即Ornstein-Uhlenbeck过程。我们将学习如何利用强马尔可夫性（通过无穷小生成元）将一个关于随机过程的问题（计算期望首达时间）转化为一个我们可以用分析方法求解的常微分方程（ODE）边值问题，这揭示了该性质在现代金融和物理学中的核心应用价值。[@problem_id:3079176]", "problem": "设 $\\{X_{t}\\}_{t \\geq 0}$ 是奥恩斯坦-乌伦贝克 (Ornstein–Uhlenbeck) 随机微分方程 (SDE) 的唯一强解\n$$\ndX_{t} \\;=\\; \\kappa \\big(\\theta - X_{t}\\big)\\, dt \\;+\\; \\sigma \\, dW_{t}, \\qquad X_{0}=x,\n$$\n其中 $\\kappa0$, $\\theta \\in \\mathbb{R}$, $\\sigma0$, 且 $\\{W_{t}\\}_{t \\geq 0}$ 是一个标准布朗运动。设 $a \\in \\mathbb{R}$ 且 $x  a$。定义首次到达时间为 $\\tau_a := \\inf\\{t \\geq 0: X_t = a\\}$。为期望首次到达时间 $u(x) = \\mathbb{E}_x[\\tau_a]$ 建立一个边值问题 (BVP)，并求出该 BVP 的显式解。", "solution": "问题要求为奥恩斯坦-乌伦贝克 (Ornstein-Uhlenbeck, OU) 过程到达水平 $a$ 的期望首次到达时间 $u(x) = \\mathbb{E}_{x}[\\tau_{a}]$ 建立一个边值问题 (BVP)，并求出该 BVP 的显式解。OU 过程 $\\{X_{t}\\}_{t \\geq 0}$ 从 $X_{0}=x$ 开始，并遵循随机微分方程 (SDE)：\n$$\ndX_{t} \\;=\\; \\kappa \\big(\\theta - X_{t}\\big)\\, dt \\;+\\; \\sigma \\, dW_{t}\n$$\n其中 $x  a$, $\\kappa0$, $\\theta \\in \\mathbb{R}$, $\\sigma0$。\n\n首先，我们使用过程的无穷小生成元和强马尔可夫性，从第一性原理推导边值问题。形式为 $dX_t = b(X_t)dt + \\sigma(X_t)dW_t$ 的伊藤 (Itô) 扩散有一个无穷小生成元 $\\mathcal{L}$，它作用于一个二次连续可微函数 $f(y)$ 的方式如下：\n$$\n\\mathcal{L}f(y) = b(y)f'(y) + \\frac{1}{2}\\sigma(y)^2 f''(y)\n$$\n对于给定的 OU 过程，漂移系数是 $b(y) = \\kappa(\\theta - y)$，扩散系数是 $\\sigma(y) = \\sigma$。因此，生成元为：\n$$\n\\mathcal{L}f(y) = \\kappa(\\theta - y)f'(y) + \\frac{1}{2}\\sigma^2 f''(y)\n$$\n设 $u(x) = \\mathbb{E}_{x}[\\tau_{a}]$。随机过程理论中的一个基本结果（通常称为丁金公式 (Dynkin's formula) 或通过基于强马尔可夫性的鞅方法推导）指出，从一个区域出离的期望时间在该区域内满足微分方程 $\\mathcal{L}u(x) = -1$。\n\n为了从第一性原理证明这一点，考虑过程 $Y_t = u(X_t) + t$。对 $f(t,x) = u(x)+t$ 应用伊藤引理 (Itô's lemma)（这里，时间是我们新函数中的一个显式变量，而不是 $u$ 本身的变量），我们得到：\n$$\ndY_t = \\left(\\frac{\\partial f}{\\partial t} + \\mathcal{L}f\\right) dt + \\sigma(X_t)\\frac{\\partial f}{\\partial x} dW_t\n$$\n对于 $f(t,X_t) = u(X_t)+t$，我们有 $\\frac{\\partial f}{\\partial t}=1$，$\\frac{\\partial f}{\\partial x}=u'(X_t)$，以及 $\\mathcal{L}f = \\mathcal{L}u(X_t)$。$Y_t$ 的随机微分是：\n$$\ndY_t = (1 + \\mathcal{L}u(X_t)) dt + \\sigma u'(X_t) dW_t\n$$\n如果我们假定 $u(x)$ 满足 $\\mathcal{L}u(x) = -1$，那么 $dY_t$ 中的漂移项消失，使得 $Y_t$ 成为一个局部鞅。对于 OU 过程，在适当的条件下，$Y_t$ 是一个鞅。根据应用于停时 $\\tau_a$ 的任意停时定理 (Optional Stopping Theorem)，我们有 $\\mathbb{E}_x[Y_{\\tau_a}] = Y_0$。\n初始值为 $Y_0 = u(X_0) + 0 = u(x)$。\n在停时的值为 $Y_{\\tau_a} = u(X_{\\tau_a}) + \\tau_a = u(a) + \\tau_a$。\n令期望相等，得到 $u(x) = \\mathbb{E}_x[u(a) + \\tau_a] = u(a) + \\mathbb{E}_x[\\tau_a]$。\n为了求得 $u(x) = \\mathbb{E}_x[\\tau_a]$，我们必须施加边界条件 $u(a)=0$。这是合乎逻辑的，因为从 $a$ 点出发到达 $a$ 点所需的时间为零。\n\n因此，对于 $x \\in (-\\infty, a)$，函数 $u(x)$ 必须解以下 BVP：\n$$\n\\frac{1}{2}\\sigma^2 u''(x) + \\kappa(\\theta - x) u'(x) = -1, \\qquad u(a)=0\n$$\n这是一个二阶线性常微分方程。令 $v(x) = u'(x)$。方程变为关于 $v(x)$ 的一阶 ODE：\n$$\nv'(x) + \\frac{2\\kappa}{\\sigma^2}(\\theta - x)v(x) = -\\frac{2}{\\sigma^2}\n$$\n我们用积分因子 $I(x)$ 来解这个方程：\n$$\nI(x) = \\exp\\left(\\int \\frac{2\\kappa}{\\sigma^2}(\\theta - x) dx\\right) = \\exp\\left(\\frac{2\\kappa}{\\sigma^2}\\left(\\theta x - \\frac{x^2}{2}\\right)\\right) = \\exp\\left(-\\frac{\\kappa}{\\sigma^2}(x-\\theta)^2\\right)\n$$\n将 ODE 乘以 $I(x)$ 得到：\n$$\n\\frac{d}{dx}\\left(v(x)I(x)\\right) = -\\frac{2}{\\sigma^2}I(x)\n$$\n对两边积分得到：\n$$\nv(x)I(x) = C - \\frac{2}{\\sigma^2} \\int^x I(y) dy \\implies v(x) = \\frac{1}{I(x)}\\left(C - \\frac{2}{\\sigma^2} \\int^x I(y) dy\\right)\n$$\n$$\nu'(x) = \\exp\\left(\\frac{\\kappa}{\\sigma^2}(x-\\theta)^2\\right) \\left[C - \\frac{2}{\\sigma^2} \\int^x \\exp\\left(-\\frac{\\kappa}{\\sigma^2}(y-\\theta)^2\\right) dy \\right]\n$$\n需要第二个边界条件来确定常数 $C$。这个条件来自于解在 $x \\to -\\infty$ 时的行为。OU 过程是均值回归的，所以对于 $x \\ll \\theta$，漂移 $\\kappa(\\theta-x)$ 是一个大的正数，将过程推向 $\\theta$。我们期望首次到达时间 $u(x)$ 是有限的，并且当 $x \\to -\\infty$ 时不会过快增长。特别地，我们要求当 $x \\to -\\infty$ 时，$u'(x)$ 不会呈指数增长。\n当 $x \\to -\\infty$ 时，项 $\\exp\\left(\\frac{\\kappa}{\\sigma^2}(x-\\theta)^2\\right)$ 无界增长。为了防止 $u'(x)$ 也无界增长，方括号中的项必须趋于零。这可以通过选择积分下限为 $-\\infty$ 并将常数 $C$ 设为 $0$ 来实现。让我们将其形式化：\n$$\nu'(x) = \\exp\\left(\\frac{\\kappa}{\\sigma^2}(x-\\theta)^2\\right) C - \\frac{2}{\\sigma^2} \\frac{\\int_{-\\infty}^x \\exp\\left(-\\frac{\\kappa}{\\sigma^2}(y-\\theta)^2\\right) dy}{\\exp\\left(-\\frac{\\kappa}{\\sigma^2}(x-\\theta)^2\\right)}\n$$\n当 $x \\to -\\infty$ 时，第二项趋于 $0$（根据洛必达法则 L'Hôpital's rule）。为了使 $u'(x)$ 不指数发散，我们必须有 $C=0$。\n所以，$u'(x)$ 的物理相关解是：\n$$\nu'(x) = -\\frac{2}{\\sigma^2} \\exp\\left(\\frac{\\kappa}{\\sigma^2}(x-\\theta)^2\\right) \\int_{-\\infty}^x \\exp\\left(-\\frac{\\kappa}{\\sigma^2}(y-\\theta)^2\\right) dy\n$$\n现在，我们通过对 $u'(x)$ 积分并应用边界条件 $u(a)=0$ 来求 $u(x)$：\n$$\nu(x) - u(a) = \\int_a^x u'(y) dy\n$$\n因为 $u(a)=0$，我们有：\n$$\nu(x) = \\int_a^x u'(y) dy = -\\int_x^a u'(y) dy\n$$\n代入 $u'(y)$ 的表达式：\n$$\nu(x) = \\int_x^a \\left[ \\frac{2}{\\sigma^2} \\exp\\left(\\frac{\\kappa}{\\sigma^2}(y-\\theta)^2\\right) \\left( \\int_{-\\infty}^y \\exp\\left(-\\frac{\\kappa}{\\sigma^2}(z-\\theta)^2\\right) dz \\right) \\right] dy\n$$\n这就是 $u(x)$ 的显式闭式解析解。它表示为初等函数的迭代积分，并且只依赖于给定的参数。\n最终答案：\n$$\nu(x) = \\frac{2}{\\sigma^2} \\int_x^a \\exp\\left(\\frac{\\kappa}{\\sigma^2}(y-\\theta)^2\\right) \\left( \\int_{-\\infty}^y \\exp\\left(-\\frac{\\kappa}{\\sigma^2}(z-\\theta)^2\\right) dz \\right) dy\n$$", "answer": "$$\n\\boxed{\\frac{2}{\\sigma^2} \\int_x^a \\exp\\left(\\frac{\\kappa}{\\sigma^2}(y-\\theta)^2\\right) \\left( \\int_{-\\infty}^y \\exp\\left(-\\frac{\\kappa}{\\sigma^2}(z-\\theta)^2\\right) dz \\right) dy}\n$$", "id": "3079176"}]}