{"hands_on_practices": [{"introduction": "理解随机过程的长期行为至关重要。本练习将引导你求解奥恩斯坦-乌伦贝克（Ornstein-Uhlenbeck）过程的平稳分布，这是模拟均值回归现象的关键模型。你还将通过验证其生成元在特定希尔伯特空间中的对称性来确认其细致平衡条件，这是热力学平衡系统的一个核心特征。[@problem_id:3048996]", "problem": "考虑由伊藤(Itô)随机微分方程定义的一维Ornstein–Uhlenbeck (OU) 过程\n$$\ndX_t \\;=\\; -\\theta\\big(X_t - \\mu\\big)\\,dt \\;+\\; \\sigma\\,dW_t, \\quad t \\geq 0,\n$$\n其中 $W_t$ 是标准的一维布朗运动 (BM)，$\\theta>0$ 是均值回归率，$\\mu \\in \\mathbb{R}$ 是长期均值，$\\sigma>0$ 是噪声强度。设 $\\pi(x)$ 表示一个不变概率密度（如果存在），并设 $\\mathcal{L}$ 表示作用于二次连续可微函数 $f:\\mathbb{R}\\to\\mathbb{R}$ 的该马尔可夫扩散的无穷小生成元。\n\n从伊藤扩散的 Kolmogorov 正向方程（也称为 Fokker-Planck 方程）和马尔可夫半群下的不变性定义出发，通过求解相应的平稳方程，推导 OU 过程的不变密度 $\\pi(x)$，包括其归一化常数。然后，使用生成元 $\\mathcal{L}$ 的定义和加权内积\n$$\n\\langle f, g\\rangle_{L^{2}(\\pi)} \\;=\\; \\int_{\\mathbb{R}} f(x)\\,g(x)\\,\\pi(x)\\,dx,\n$$\n通过证明 $\\mathcal{L}$ 在 $L^{2}(\\pi)$ 空间中对于一个由光滑、紧支集检验函数构成的核心是对称的，来验证细致平衡条件。在您的验证中，利用 $\\pi(x)$ 的衰减性和检验函数的支集性质，来证明任何分部积分和边界项求值的合理性。\n\n提供不变密度 $\\pi(x)$ 的闭式表达式作为最终答案。不需要数值近似。", "solution": "这个问题是有效的，因为它具有科学依据、提法明确且客观。它是随机微分方程理论中的一个标准问题。\n\nOrnstein-Uhlenbeck (OU) 过程由以下随机微分方程 (SDE) 描述：\n$$\ndX_t = -\\theta(X_t - \\mu) dt + \\sigma dW_t\n$$\n这是一个形式为 $dX_t = a(X_t) dt + b(X_t) dW_t$ 的一维伊藤扩散，其漂移系数为 $a(x) = -\\theta(x - \\mu)$，扩散系数为 $b(x) = \\sigma$。给定的参数为 $\\theta > 0$、$\\mu \\in \\mathbb{R}$ 和 $\\sigma > 0$。\n\n### 第1部分：不变密度 $\\pi(x)$ 的推导\n\n一维伊藤扩散的概率密度函数 $p(x,t)$ 的演化由 Kolmogorov 正向方程（也称为 Fokker-Planck 方程）控制：\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} [a(x) p(x,t)] + \\frac{1}{2} \\frac{\\partial^2}{\\partial x^2} [b(x)^2 p(x,t)]\n$$\n不变（或平稳）密度 $\\pi(x)$ 是一个不随时间变化的解，即 $\\frac{\\partial \\pi(x)}{\\partial t} = 0$。对于这样的密度，Fokker-Planck 方程变为：\n$$\n0 = -\\frac{d}{dx} [a(x) \\pi(x)] + \\frac{1}{2} \\frac{d^2}{dx^2} [b(x)^2 \\pi(x)]\n$$\n这可以写成 $\\frac{d}{dx} J(x) = 0$，其中 $J(x)$ 是概率流：\n$$\nJ(x) = a(x) \\pi(x) - \\frac{1}{2} \\frac{d}{dx} [b(x)^2 \\pi(x)]\n$$\n条件 $\\frac{d}{dx}J(x) = 0$ 意味着 $J(x)$ 是一个常数。对于整个实线 $\\mathbb{R}$ 上的过程，一个可归一化的概率密度要求 $\\pi(x)$ 及其导数在 $|x| \\to \\infty$ 时消失。这意味着常数概率流必须为零，因此对于所有 $x \\in \\mathbb{R}$ 都有 $J(x) = 0$。\n\n将 OU 过程的 $a(x)$ 和 $b(x)$ 的表达式代入，我们得到：\n$$\n-\\theta(x-\\mu)\\pi(x) - \\frac{1}{2} \\frac{d}{dx} [\\sigma^2 \\pi(x)] = 0\n$$\n由于 $\\sigma$ 是一个常数，这简化为关于 $\\pi(x)$ 的一阶常微分方程 (ODE)：\n$$\n-\\theta(x-\\mu)\\pi(x) - \\frac{\\sigma^2}{2} \\frac{d\\pi(x)}{dx} = 0\n$$\n这是一个可分离的 ODE：\n$$\n\\frac{d\\pi}{\\pi} = -\\frac{2\\theta}{\\sigma^2}(x-\\mu) dx\n$$\n对两边积分得到：\n$$\n\\int \\frac{d\\pi}{\\pi} = \\int -\\frac{2\\theta}{\\sigma^2}(x-\\mu) dx\n$$\n$$\n\\ln(\\pi(x)) = -\\frac{2\\theta}{\\sigma^2} \\frac{(x-\\mu)^2}{2} + C'\n$$\n$$\n\\ln(\\pi(x)) = -\\frac{\\theta}{\\sigma^2}(x-\\mu)^2 + C'\n$$\n对两边取指数，得到不变密度的形式：\n$$\n\\pi(x) = C \\exp\\left(-\\frac{\\theta}{\\sigma^2}(x-\\mu)^2\\right)\n$$\n其中 $C = \\exp(C')$ 是一个归一化常数。为了求出 $C$，我们使用 $\\pi(x)$ 必须是概率密度的条件，因此其在 $\\mathbb{R}$ 上的积分必须为 $1$：\n$$\n\\int_{-\\infty}^{\\infty} \\pi(x) dx = C \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\theta}{\\sigma^2}(x-\\mu)^2\\right) dx = 1\n$$\n令 $y = x - \\mu$，则 $dy = dx$。积分变为：\n$$\nC \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\theta}{\\sigma^2}y^2\\right) dy = 1\n$$\n我们使用标准高斯积分公式 $\\int_{-\\infty}^{\\infty} \\exp(-k y^2) dy = \\sqrt{\\frac{\\pi}{k}}$。这里，$k = \\frac{\\theta}{\\sigma^2}$。\n$$\nC \\sqrt{\\frac{\\pi}{\\theta/\\sigma^2}} = C \\sqrt{\\frac{\\pi\\sigma^2}{\\theta}} = 1\n$$\n解出 $C$：\n$$\nC = \\sqrt{\\frac{\\theta}{\\pi\\sigma^2}}\n$$\n因此，OU 过程的不变密度为：\n$$\n\\pi(x) = \\sqrt{\\frac{\\theta}{\\pi\\sigma^2}} \\exp\\left(-\\frac{\\theta}{\\sigma^2}(x-\\mu)^2\\right)\n$$\n这是均值为 $\\mu$、方差为 $\\frac{\\sigma^2}{2\\theta}$ 的高斯分布的概率密度函数。\n\n### 第2部分：细致平衡条件的验证\n\n细致平衡条件等价于证明过程的无穷小生成元 $\\mathcal{L}$ 在具有加权内积 $\\langle f, g\\rangle_{L^{2}(\\pi)} = \\int_{\\mathbb{R}} f(x)\\,g(x)\\,\\pi(x)\\,dx$ 的希尔伯特空间 $L^2(\\pi)$ 中是一个自伴（对称）算子。我们需要对任意两个光滑、紧支集检验函数 $f$ 和 $g$ 验证：\n$$\n\\langle \\mathcal{L}f, g\\rangle_{L^{2}(\\pi)} = \\langle f, \\mathcal{L}g\\rangle_{L^{2}(\\pi)}\n$$\n一维伊藤扩散的生成元是 $\\mathcal{L} = a(x) \\frac{d}{dx} + \\frac{1}{2}b(x)^2 \\frac{d^2}{dx^2}$。对于 OU 过程，它是：\n$$\n\\mathcal{L}f(x) = -\\theta(x-\\mu) \\frac{df}{dx} + \\frac{\\sigma^2}{2} \\frac{d^2f}{dx^2}\n$$\n我们计算对称条件的左边：\n$$\n\\langle \\mathcal{L}f, g\\rangle_{L^{2}(\\pi)} = \\int_{-\\infty}^{\\infty} \\left( -\\theta(x-\\mu) f'(x) + \\frac{\\sigma^2}{2} f''(x) \\right) g(x) \\pi(x) dx\n$$\n我们将积分分成两部分，并对包含 $f''(x)$ 的第二项使用分部积分：\n$$\nI_1 = \\int_{-\\infty}^{\\infty} -\\theta(x-\\mu) f'(x) g(x) \\pi(x) dx\n$$\n$$\nI_2 = \\int_{-\\infty}^{\\infty} \\frac{\\sigma^2}{2} f''(x) g(x) \\pi(x) dx\n$$\n对于 $I_2$，令 $u = \\frac{\\sigma^2}{2} g(x) \\pi(x)$ 且 $dv = f''(x) dx$。那么 $du = \\frac{\\sigma^2}{2} (g'(x)\\pi(x) + g(x)\\pi'(x)) dx$ 且 $v = f'(x)$。\n$$\nI_2 = \\left[ \\frac{\\sigma^2}{2} g(x) \\pi(x) f'(x) \\right]_{-\\infty}^{\\infty} - \\int_{-\\infty}^{\\infty} f'(x) \\frac{\\sigma^2}{2} (g'(x)\\pi(x) + g(x)\\pi'(x)) dx\n$$\n边界项消失，因为 $f$ 和 $g$ （及其导数）具有紧支集，意味着它们在有限区间之外为零。\n所以，$\\langle \\mathcal{L}f, g\\rangle_{L^{2}(\\pi)} = I_1 + I_2$ 变为：\n$$\n\\int_{-\\infty}^{\\infty} \\left[ -\\theta(x-\\mu)f'(x)g(x)\\pi(x) - \\frac{\\sigma^2}{2} f'(x)g'(x)\\pi(x) - \\frac{\\sigma^2}{2} f'(x)g(x)\\pi'(x) \\right] dx\n$$\n我们可以提出因子 $f'(x)$：\n$$\n\\int_{-\\infty}^{\\infty} f'(x) \\left\\{ g(x) \\left[-\\theta(x-\\mu)\\pi(x) - \\frac{\\sigma^2}{2}\\pi'(x)\\right] - g'(x)\\frac{\\sigma^2}{2}\\pi(x) \\right\\} dx\n$$\n从第1部分推导的平稳 Fokker-Planck 方程，我们发现：\n$$\n-\\theta(x-\\mu)\\pi(x) - \\frac{\\sigma^2}{2}\\pi'(x) = 0\n$$\n将此代入表达式，乘以 $g(x)$ 的项变为零。我们剩下：\n$$\n\\langle \\mathcal{L}f, g\\rangle_{L^{2}(\\pi)} = \\int_{-\\infty}^{\\infty} f'(x) \\left\\{ -g'(x)\\frac{\\sigma^2}{2}\\pi(x) \\right\\} dx = -\\frac{\\sigma^2}{2} \\int_{-\\infty}^{\\infty} f'(x)g'(x)\\pi(x) dx\n$$\n这个最终表达式关于交换 $f$ 和 $g$ 是对称的。如果我们从 $\\langle \\mathcal{L}g, f\\rangle_{L^{2}(\\pi)}$ 开始，我们会遵循相同的步骤，只是交换 $f$ 和 $g$ 的角色，从而得到相同的结果：\n$$\n\\langle f, \\mathcal{L}g\\rangle_{L^{2}(\\pi)} = \\langle \\mathcal{L}g, f\\rangle_{L^{2}(\\pi)} = -\\frac{\\sigma^2}{2} \\int_{-\\infty}^{\\infty} g'(x)f'(x)\\pi(x) dx\n$$\n因此，$\\langle \\mathcal{L}f, g\\rangle_{L^{2}(\\pi)} = \\langle f, \\mathcal{L}g\\rangle_{L^{2}(\\pi)}$，这证实了对于 OU 过程，生成元 $\\mathcal{L}$ 在 $L^2(\\pi)$ 中是对称的。这就验证了细致平衡条件。\n\n上述完整推导得出了不变密度 $\\pi(x)$ 的闭式表达式。", "answer": "$$\n\\boxed{\\sqrt{\\frac{\\theta}{\\pi\\sigma^2}} \\exp\\left(-\\frac{\\theta}{\\sigma^2}(x-\\mu)^2\\right)}\n$$", "id": "3048996"}, {"introduction": "扩散过程的行为不仅由其在状态空间内部的动态决定，也取决于它在边界处的表现。本练习介绍费勒（Feller）边界分类法，这是一个强大的工具，它使用标度函数和速度测度来确定一个过程是否能到达或逃离其状态空间的边缘。通过这个练习，你将学会如何系统地分析和描述扩散过程的边界行为。[@problem_id:3049020]", "problem": "考虑由随机微分方程 (SDE) $dX_{t} = \\sqrt{X_{t}}\\, dW_{t}$ 定义的一维扩散过程，其中 $W_{t}$ 是标准一维布朗运动，且 $X_{t} \\in (0,\\infty)$。请仅使用从一维扩散的生成元推导出的标度函数和速度测度的基本定义，根据 Feller 的边界分类（正则、出口、入口、自然）对边界点 $0$ 和 $\\infty$ 进行分类。您的推导必须从扩散的生成元开始，然后推导中标度函数和速度测度，最后应用边界分类准则。\n\n为确保最终答案为计算类型，请将四种边界类型编码为整数：正则 $\\mapsto 0$、出口 $\\mapsto 1$、入口 $\\mapsto 2$、自然 $\\mapsto 3$。请将您的最终答案表示为 LaTeX $\\texttt{pmatrix}$ 环境中的一个 $1 \\times 2$ 行矩阵，其中第一个元素是 $0$ 点的编码类型，第二个元素是 $\\infty$ 点的编码类型。无需四舍五入，也不涉及单位。", "solution": "该问题要求对由随机微分方程 (SDE) 定义在状态空间 $(0, \\infty)$ 上的一维扩散过程 $X_t$ 的边界 $0$ 和 $\\infty$ 进行分类：\n$$dX_{t} = \\sqrt{X_{t}}\\, dW_{t}$$\n这是一个形式为 $dX_t = \\mu(X_t)dt + \\sigma(X_t)dW_t$ 的 SDE，其漂移系数 $\\mu(x)=0$，扩散系数 $\\sigma(x)=\\sqrt{x}$。分类将使用 Feller 边界分类方案进行，该方案依赖于扩散的标度函数和速度测度。推导过程必须从该过程的生成元开始。\n\n一维扩散过程的无穷小生成元 $\\mathcal{L}$ 是一个二阶微分算子，由下式给出：\n$$\\mathcal{L}f(x) = \\mu(x)\\frac{df}{dx} + \\frac{1}{2}\\sigma(x)^2\\frac{d^2f}{dx^2}$$\n对于给定的过程，我们有 $\\mu(x)=0$ 和 $\\sigma(x)^2 = (\\sqrt{x})^2 = x$。将这些代入生成元的公式，得到：\n$$\\mathcal{L}f(x) = (0)\\frac{df}{dx} + \\frac{1}{2}x\\frac{d^2f}{dx^2} = \\frac{1}{2}x\\frac{d^2f}{dx^2}$$\n该生成元定义在合适的函数域上，通常是定义在 $(0, \\infty)$ 上具有紧支集的二次连续可微函数 $f$。\n\n标度函数，记为 $s(x)$，是定义在扩散状态空间上的一个严格递增函数，它使得过程经其变换后成为一个局部鞅。它通过求解微分方程 $\\mathcal{L}s(x) = 0$ 来找到。\n$$\\mathcal{L}s(x) = \\frac{1}{2}x\\frac{d^2s}{dx^2} = 0$$\n由于我们处于区间 $(0, \\infty)$ 上，$x \\neq 0$，因此该方程简化为：\n$$\\frac{d^2s}{dx^2} = 0$$\n对此方程对 $x$ 积分两次，得到 $s(x) = C_1x + C_2$，其中 $C_1$ 和 $C_2$ 是积分常数。标度函数在仿射变换下是唯一的，因此我们可以为简便起见选择常数，但需满足 $s(x)$ 是严格递增的条件（$C_1 > 0$）。我们选择 $C_1 = 1$ 和 $C_2 = 0$，得到标度函数：\n$$s(x) = x$$\n因此，标度函数的密度，记为 $s'(x)$，是 $s'(x) = 1$。\n\n速度测度 $m(dx)$ 描述了过程在其状态空间的不同区域花费的时间。它有一个关于勒贝格测度的密度 $m(x)$，该密度与生成元、扩散系数和标度函数相关。其关系由下式给出：\n$$m(x) = \\frac{2}{\\sigma(x)^2 s'(x)}$$\n代入 $\\sigma(x)^2 = x$ 和 $s'(x) = 1$，我们找到速度测度密度：\n$$m(x) = \\frac{2}{x \\cdot 1} = \\frac{2}{x}$$\n\n有了标度密度 $s'(x)$ 和速度测度密度 $m(x)$，我们就可以进行 Feller 边界分类。对于区间 $(a, b)$ 上的扩散，我们通过评估某些积分的收敛性来分析边界 $a$ 和 $b$。设 $c$ 为状态空间 $(0, \\infty)$ 内部的任意一点。为方便起见，我们选择 $c=1$。\n\n对于一个边界点 $b$，其分类取决于以下两个积分的有限性：\n$$\\sigma(b) = \\int_c^b s'(x)dx \\quad \\text{和} \\quad \\mu(b) = \\int_c^b m(x)dx$$\n（对于左边界 $a$，积分为 $\\int_a^c f(x)dx$）。\n边界 $b$ 被分类为：\n- **正则** (Regular) 如果 $\\sigma(b) < \\infty$ 且 $\\mu(b) < \\infty$。\n- **出口** (Exit) 如果 $\\sigma(b) < \\infty$ 且 $\\mu(b) = \\infty$。\n- **入口** (Entrance) 如果 $\\sigma(b) = \\infty$ 且 $\\mu(b) < \\infty$。\n- **自然** (Natural) 如果 $\\sigma(b) = \\infty$ 且 $\\mu(b) = \\infty$。\n\n首先，我们对位于 $0$ 的左边界进行分类。我们计算从 $0$ 到 $c=1$ 的积分：\n$$\\sigma(0) = \\int_{0^+}^1 s'(x)dx = \\int_{0^+}^1 1 dx = [x]_{0^+}^1 = 1 - 0 = 1$$\n此积分是有限的，$\\sigma(0) < \\infty$。\n$$\\mu(0) = \\int_{0^+}^1 m(x)dx = \\int_{0^+}^1 \\frac{2}{x} dx = 2[\\ln(x)]_{0^+}^1 = 2(\\ln(1) - \\lim_{x\\to 0^+}\\ln(x)) = 2(0 - (-\\infty)) = \\infty$$\n此积分发散，$\\mu(0) = \\infty$。\n由于 $\\sigma(0) < \\infty$ 且 $\\mu(0) = \\infty$，位于 $0$ 的边界是一个**出口**边界。\n\n接下来，我们对位于 $\\infty$ 的右边界进行分类。我们计算从 $c=1$ 到 $\\infty$ 的积分：\n$$\\sigma(\\infty) = \\int_1^\\infty s'(x)dx = \\int_1^\\infty 1 dx = [x]_1^\\infty = \\lim_{x\\to\\infty}x - 1 = \\infty$$\n此积分发散，$\\sigma(\\infty) = \\infty$。\n$$\\mu(\\infty) = \\int_1^\\infty m(x)dx = \\int_1^\\infty \\frac{2}{x} dx = 2[\\ln(x)]_1^\\infty = 2(\\lim_{x\\to\\infty}\\ln(x) - \\ln(1)) = 2(\\infty - 0) = \\infty$$\n此积分也发散，$\\mu(\\infty) = \\infty$。\n由于 $\\sigma(\\infty) = \\infty$ 且 $\\mu(\\infty) = \\infty$，位于 $\\infty$ 的边界是一个**自然**边界。\n\n问题要求将边界类型编码为整数：正则 $\\mapsto 0$、出口 $\\mapsto 1$、入口 $\\mapsto 2$、自然 $\\mapsto 3$。\n- 位于 $0$ 的边界是出口型，对应整数 $1$。\n- 位于 $\\infty$ 的边界是自然型，对应整数 $3$。\n\n最终答案应以 $1 \\times 2$ 行矩阵的形式呈现，其中第一个元素是边界 $0$ 的编码，第二个是边界 $\\infty$ 的编码。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 3\n\\end{pmatrix}\n}\n$$", "id": "3049020"}, {"introduction": "许多随机微分方程无法求得解析解，必须依赖数值模拟，因此理解数值方法的性质至关重要。本练习让你亲手分析基本的欧拉-丸山（Euler-Maruyama）法在模拟奥恩斯坦-乌伦贝克过程时产生的误差。通过直接比较数值解与精确解，你将清晰地理解弱收敛与强收敛这两个核心概念之间的区别，为随机过程的计算实践打下坚实基础。[@problem_id:3049010]", "problem": "考虑由随机微分方程 (SDE) 定义的 Ornstein–Uhlenbeck (OU) 过程\n$$\n\\mathrm{d}X_{s} = -\\theta X_{s}\\,\\mathrm{d}s + \\sigma\\,\\mathrm{d}W_{s}, \\quad s \\in [t,t+h],\n$$\n其中 $\\theta > 0$ 和 $\\sigma > 0$ 是常数，$W_{s}$ 是一个维纳过程（布朗运动），初始条件 $X_{t} = x$ 是确定性的。该过程是一个具有线性漂移和常数扩散系数的时齐马尔可夫扩散过程。仅使用伊藤随机积分的基本定义与性质、马尔可夫性以及布朗运动线性泛函的高斯性，完成以下任务：\n\n1. 推导在 $X_{t} = x$ 条件下 $X_{t+h}$ 的精确单步转移密度，并确定其均值和方差，表示为 $\\theta$、$\\sigma$、$h$ 和 $x$ 的函数。\n\n2. 推导从 $x$ 开始的单步 Euler–Maruyama (EM) 近似 $\\bar{X}_{t+h}$ 及其在 $X_{t} = x$ 条件下的转移密度，并确定其均值和方差。\n\n3. 通过将其均值和方差展开为 $h$ 的幂级数来比较这两种转移密度，并用此来确定局部弱误差的阶数（通过有界且足够光滑的检验函数的期望定义）和均方根意义下的局部强误差的阶数（定义为 $\\left(\\mathbb{E}\\!\\left[|X_{t+h} - \\bar{X}_{t+h}|^{2} \\mid X_{t} = x\\right]\\right)^{1/2}$）。\n\n4. 使用基于马尔可夫性和维纳增量的独立性的标准稳定性和累积论证，推断 Euler–Maruyama 方法在划分为步长为 $h$ 的固定时间区间上对 OU 过程的相应全局弱收敛率和强收敛率。\n\n将最终答案表示为一个行矩阵，依次包含全局弱收敛率和全局强收敛率。不需要进行数值近似。", "solution": "此问题旨在分析奥恩斯坦-乌伦贝克（Ornstein-Uhlenbeck, OU）过程及其应用的欧拉-丸山（Euler-Maruyama, EM）方法的收敛性质。这将分四部分完成：分析精确解，分析 EM 近似，比较它们以找到局部误差，以及推断全局收敛率。\n\nOrnstein-Uhlenbeck SDE 由下式给出：\n$$\n\\mathrm{d}X_{s} = -\\theta X_{s}\\,\\mathrm{d}s + \\sigma\\,\\mathrm{d}W_{s}, \\quad s \\in [t,t+h]\n$$\n参数为 $\\theta > 0$, $\\sigma > 0$，初始条件 $X_{t} = x$ 是确定性的。\n\n**1. 精确的单步转移密度**\n\n该 SDE 是一个线性一阶方程。我们可以使用积分因子 $e^{\\theta s}$ 来求解它。设 $Y_{s} = e^{\\theta s}X_{s}$。使用伊藤乘积法则，我们求得 $Y_s$ 的微分：\n$$\n\\mathrm{d}Y_{s} = \\mathrm{d}(e^{\\theta s} X_{s}) = (\\theta e^{\\theta s} X_{s})\\,\\mathrm{d}s + e^{\\theta s}\\,\\mathrm{d}X_{s}\n$$\n将 $\\mathrm{d}X_{s}$ 的 SDE 代入：\n$$\n\\mathrm{d}Y_{s} = \\theta e^{\\theta s} X_{s}\\,\\mathrm{d}s + e^{\\theta s}(-\\theta X_{s}\\,\\mathrm{d}s + \\sigma\\,\\mathrm{d}W_{s}) = \\sigma e^{\\theta s}\\,\\mathrm{d}W_{s}\n$$\n从 $s=t$ 积分到 $s=t+h$：\n$$\nY_{t+h} - Y_{t} = \\int_{t}^{t+h} \\sigma e^{\\theta s}\\,\\mathrm{d}W_{s}\n$$\n代回 $Y_s = e^{\\theta s}X_s$ 并使用初始条件 $X_t=x$：\n$$\ne^{\\theta(t+h)}X_{t+h} - e^{\\theta t}x = \\sigma \\int_{t}^{t+h} e^{\\theta s}\\,\\mathrm{d}W_{s}\n$$\n求解 $X_{t+h}$：\n$$\nX_{t+h} = x e^{-\\theta h} + \\sigma \\int_{t}^{t+h} e^{-\\theta(t+h-s)}\\,\\mathrm{d}W_{s}\n$$\n$X_{t+h}$ 解是一个确定性项和一个伊藤积分之和。一个确定性函数的伊藤积分是一个高斯随机变量。因此，在 $X_t=x$ 条件下的 $X_{t+h}$ 服从正态分布。\n\n$X_{t+h}$ 的均值通过取期望得到。伊藤积分的均值为零：\n$$\n\\mathbb{E}[X_{t+h} \\mid X_{t}=x] = \\mathbb{E}[x e^{-\\theta h}] + \\sigma \\mathbb{E}\\left[\\int_{t}^{t+h} e^{-\\theta(t+h-s)}\\,\\mathrm{d}W_{s}\\right] = x e^{-\\theta h}\n$$\n$X_{t+h}$ 的方差通过对随机积分部分使用伊藤等距性质得到：\n$$\n\\mathrm{Var}(X_{t+h} \\mid X_{t}=x) = \\mathrm{Var}\\left(\\sigma \\int_{t}^{t+h} e^{-\\theta(t+h-s)}\\,\\mathrm{d}W_{s}\\right) = \\sigma^2 \\int_{t}^{t+h} \\left(e^{-\\theta(t+h-s)}\\right)^2\\,\\mathrm{d}s\n$$\n令 $u = t+h-s$，则 $\\mathrm{d}u = -\\mathrm{d}s$。积分限从 $s=t \\Rightarrow u=h$ 变为 $s=t+h \\Rightarrow u=0$。\n$$\n\\mathrm{Var}(X_{t+h} \\mid X_{t}=x) = \\sigma^2 \\int_{h}^{0} e^{-2\\theta u}(-\\mathrm{d}u) = \\sigma^2 \\int_{0}^{h} e^{-2\\theta u}\\,\\mathrm{d}u = \\sigma^2 \\left[-\\frac{1}{2\\theta}e^{-2\\theta u}\\right]_{0}^{h} = \\frac{\\sigma^2}{2\\theta}(1 - e^{-2\\theta h})\n$$\n所以，转移是高斯的：$X_{t+h} \\mid X_{t}=x \\sim \\mathcal{N}(\\mu, v)$，其中：\n- 均值：$\\mu(h) = x e^{-\\theta h}$\n- 方差：$v(h) = \\frac{\\sigma^2}{2\\theta}(1 - e^{-2\\theta h})$\n转移密度是该正态分布的概率密度函数。\n\n**2. 欧拉-丸山近似及其转移密度**\n\nSDE 在一个时间步长 $h$ 上的欧拉-丸山 (EM) 离散化为：\n$$\n\\bar{X}_{t+h} = \\bar{X}_{t} + (-\\theta \\bar{X}_{t})h + \\sigma(W_{t+h} - W_{t})\n$$\n从 $\\bar{X}_{t} = x$ 开始，我们得到：\n$$\n\\bar{X}_{t+h} = x - \\theta x h + \\sigma \\Delta W_{t} = x(1-\\theta h) + \\sigma \\Delta W_{t}\n$$\n其中 $\\Delta W_{t} = W_{t+h} - W_{t}$ 是一个维纳增量，它是一个均值为 $0$、方差为 $h$ 的高斯随机变量，即 $\\Delta W_{t} \\sim \\mathcal{N}(0, h)$。\n由于 $\\bar{X}_{t+h}$ 是一个高斯变量的线性变换，它也是高斯的。\n\nEM 近似的均值为：\n$$\n\\mathbb{E}[\\bar{X}_{t+h} \\mid X_{t}=x] = \\mathbb{E}[x(1-\\theta h) + \\sigma \\Delta W_{t}] = x(1-\\theta h) + \\sigma \\mathbb{E}[\\Delta W_{t}] = x(1-\\theta h)\n$$\nEM 近似的方差为：\n$$\n\\mathrm{Var}(\\bar{X}_{t+h} \\mid X_{t}=x) = \\mathrm{Var}(x(1-\\theta h) + \\sigma \\Delta W_{t}) = \\sigma^2 \\mathrm{Var}(\\Delta W_{t}) = \\sigma^2 h\n$$\n所以，EM 转移也是高斯的：$\\bar{X}_{t+h} \\mid X_{t}=x \\sim \\mathcal{N}(\\bar{\\mu}, \\bar{v})$，其中：\n- 均值：$\\bar{\\mu}(h) = x(1-\\theta h)$\n- 方差：$\\bar{v}(h) = \\sigma^2 h$\n\n**3. 比较与局部误差**\n\n我们将精确均值和方差展开为 $h$ 的幂级数，以便与 EM 的矩进行比较。\n- **均值：** 使用泰勒级数 $e^{-z} = 1 - z + \\frac{z^2}{2!} - \\dots$：\n  $$\n  \\mu(h) = x e^{-\\theta h} = x\\left(1 - \\theta h + \\frac{\\theta^2 h^2}{2} + O(h^3)\\right)\n  $$\n  精确均值与 EM 均值之差为：\n  $$\n  \\mu(h) - \\bar{\\mu}(h) = x\\left(1 - \\theta h + \\frac{\\theta^2 h^2}{2} + O(h^3)\\right) - x(1-\\theta h) = \\frac{x\\theta^2}{2}h^2 + O(h^3) = O(h^2)\n  $$\n- **方差：** 使用泰勒级数 $e^{-z} = 1 - z + \\frac{z^2}{2!} - \\dots$：\n  $$\n  v(h) = \\frac{\\sigma^2}{2\\theta}(1 - e^{-2\\theta h}) = \\frac{\\sigma^2}{2\\theta}\\left(1 - \\left(1 - 2\\theta h + \\frac{(2\\theta h)^2}{2} + O(h^3)\\right)\\right) = \\frac{\\sigma^2}{2\\theta}(2\\theta h - 2\\theta^2 h^2 + O(h^3)) = \\sigma^2 h - \\sigma^2\\theta h^2 + O(h^3)\n  $$\n  精确方差与 EM 方差之差为：\n  $$\n  v(h) - \\bar{v}(h) = (\\sigma^2 h - \\sigma^2\\theta h^2 + O(h^3)) - \\sigma^2 h = -\\sigma^2\\theta h^2 + O(h^3) = O(h^2)\n  $$\n\n**局部弱误差** 的阶数为 $p$ 是指对于光滑检验函数 $f$，有 $|\\mathbb{E}[f(X_{t+h})] - \\mathbb{E}[f(\\bar{X}_{t+h})]| = O(h^{p+1})$。由于均值和方差在 $h$ 的一阶上匹配，而在 $h^2$ 阶上存在差异，因此任何足够光滑的函数 $f$ 的期望也将相差 $h^2$ 阶。这意味着局部弱误差为 $O(h^2)$。因此，局部弱阶数为 $p=1$。\n\n**局部强误差** 由 $(\\mathbb{E}[|X_{t+h} - \\bar{X}_{t+h}|^2 \\mid X_t=x])^{1/2}$ 给出。我们计算均方误差 (MSE)：\n$$\nX_{t+h} - \\bar{X}_{t+h} = \\left(x e^{-\\theta h} - x(1-\\theta h)\\right) + \\sigma\\left(\\int_{t}^{t+h} e^{-\\theta(t+h-s)}\\,\\mathrm{d}W_{s} - \\int_{t}^{t+h} 1\\,\\mathrm{d}W_{s}\\right)\n$$\n设第一项为 $A$，第二项为 $B$。这两项不相关，因为 $A$ 是确定性的，而 $B$ 是一个零均值的伊藤积分。因此，$\\mathbb{E}[(A+B)^2] = A^2 + \\mathbb{E}[B^2]$。\n- 确定性部分 $A$：\n  $A = x(e^{-\\theta h} - 1 + \\theta h) = x\\left(\\left(1-\\theta h + \\frac{\\theta^2h^2}{2} + O(h^3)\\right) - 1 + \\theta h\\right) = \\frac{x\\theta^2}{2}h^2 + O(h^3) = O(h^2)$。因此，$A^2 = O(h^4)$。\n- 随机部分 $B$：对 $\\mathbb{E}[B^2]$ 使用伊藤等距性质：\n  $$\n  \\mathbb{E}[B^2] = \\sigma^2 \\int_{t}^{t+h} (e^{-\\theta(t+h-s)} - 1)^2\\,\\mathrm{d}s = \\sigma^2 \\int_{0}^{h} (e^{-\\theta u} - 1)^2\\,\\mathrm{d}u\n  $$\n  对于小的 $u$，$(e^{-\\theta u} - 1)^2 = (-\\theta u + O(u^2))^2 = \\theta^2 u^2 + O(u^3)$。\n  $$\n  \\mathbb{E}[B^2] = \\sigma^2 \\int_{0}^{h} (\\theta^2 u^2 + O(u^3))\\,\\mathrm{d}u = \\sigma^2\\left(\\frac{\\theta^2 h^3}{3} + O(h^4)\\right) = O(h^3)\n  $$\n总 MSE 为 $\\mathbb{E}[|X_{t+h} - \\bar{X}_{t+h}|^2] = A^2 + \\mathbb{E}[B^2] = O(h^4) + O(h^3) = O(h^3)$。\n局部强误差是均方根，所以它是 $(O(h^3))^{1/2} = O(h^{1.5})$。局部强阶数为 $1.5$。\n\n**4. 全局收敛率**\n\n全局收敛率可以从局部误差阶数通过对稳定数值方法的标准累积论证推断出来。\n- **全局弱收敛率：** 一个局部弱阶数为 $p$（即单步误差为 $O(h^{p+1})$）的方法，其全局弱收敛率为 $p$。在这里，局部弱误差为 $O(h^2)$，所以局部阶数为 $p=1$。因此，全局弱收敛率为 $1$。\n\n- **全局强收敛率：** 一个局部强阶数为 $\\gamma$（即单步 RMSE 为 $O(h^{\\gamma})$）的方法，其全局强收敛率通常为 $\\gamma - 0.5$。因子 $0.5$ 源于随机误差的累积，其尺度与步数的平方根 $\\sqrt{N} = \\sqrt{T/h}$ 成正比。\n在我们的例子中，局部强阶数为 $\\gamma = 1.5$。因此，全局强收敛率为 $1.5 - 0.5 = 1.0$。\n\n这种改进的强收敛率（从一般的 EM 收敛率 $0.5$ 提高到 $1.0$）是具有加性噪声的 SDE 的一个已知特例，其中扩散系数 $\\sigma(t,x)$ 不依赖于状态 $x$。OU 过程的 SDE 符合这种情况，因为 $\\sigma$ 是一个常数。对于这类 SDE，Euler-Maruyama 格式等价于更高阶的 Milstein 格式，后者通常具有 $1.0$ 的强收敛率。\n\n最终答案需要全局弱收敛率和全局强收敛率。\n- 全局弱收敛率：$1$\n- 全局强收敛率：$1$", "answer": "$$\n\\boxed{\\begin{pmatrix} 1 & 1 \\end{pmatrix}}\n$$", "id": "3049010"}]}