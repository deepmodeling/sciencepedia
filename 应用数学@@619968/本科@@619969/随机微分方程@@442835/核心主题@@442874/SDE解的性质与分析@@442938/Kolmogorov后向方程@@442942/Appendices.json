{"hands_on_practices": [{"introduction": "这个练习是掌握科尔莫戈洛夫后向方程 (KBE) 的基础。它旨在连接随机微分方程 (SDE) 与其对应的偏微分算子——无穷小生成元。通过从第一性原理出发，为一个具体的随机过程计算生成元，你将深入理解 SDE 中的漂移项和扩散项如何分别转化为 KBE 中的一阶和二阶导数项 [@problem_id:3062743]。", "problem": "考虑$\\mathbb{R}$上的一维随机微分方程 (SDE)，其形式如下\n$$\ndX_t = b X_t \\, dt + \\sigma \\, dW_t,\n$$\n其中 $b \\in \\mathbb{R}$ 和 $\\sigma > 0$ 是常数，$W_t$ 是标准布朗运动。设函数 $f:\\mathbb{R}\\to\\mathbb{R}$ 定义为 $f(x)=|x|^2$。仅使用随机微积分的基础工具和科尔莫戈洛夫后向方程 (KBE) 中无穷小生成元的定义，从第一性原理推导无穷小生成元 $\\mathcal{L}$ 作用于 $f$ 的显式形式，即计算 $\\mathcal{L}f(x)$。\n\n将您的最终答案表示为关于 $x$、$b$ 和 $\\sigma$ 的单一简化解析表达式。不需要进行数值计算或四舍五入。", "solution": "该问题要求针对随机微分方程 (SDE) $dX_t = b X_t \\, dt + \\sigma \\, dW_t$，推导无穷小生成元 $\\mathcal{L}$ 作用于函数 $f(x) = |x|^2$ 的显式形式。推导必须从第一性原理出发，使用生成元的定义。\n\n时间齐次的马尔可夫过程 $X_t$ 的无穷小生成元 $\\mathcal{L}$ 是通过其在合适函数 $f$ 上的作用来定义的。对于一个从 $X_0 = x$ 开始的过程，其定义为：\n$$\n\\mathcal{L}f(x) = \\lim_{h \\to 0^+} \\frac{\\mathbb{E}[f(X_h) | X_0=x] - f(x)}{h}\n$$\n前提是此极限存在。符号 $\\mathbb{E}[ \\cdot | X_0=x]$ 表示在过程从点 $x \\in \\mathbb{R}$ 开始的条件下所取的期望。\n\n给定的SDE是一个一维伊藤过程：\n$$\ndX_t = b X_t \\, dt + \\sigma \\, dW_t\n$$\n它有一个漂移系数 $\\mu(X_t) = bX_t$ 和一个常数扩散系数 $\\nu(X_t) = \\sigma$。注意，标准记法通常用 $\\sigma(x)$ 表示扩散系数，但为了避免与给定的常数 $\\sigma$ 混淆，我们将使用 $\\nu(x)$ 并设 $\\nu(x)=\\sigma$。\n\n我们考虑的函数是 $f(x) = |x|^2$。由于 $x$ 是实变量，这等价于 $f(x) = x^2$。这个函数属于 $C^2(\\mathbb{R})$，即二次连续可微函数的空间，这通常是扩散过程无穷小生成元的定义域。$f(x)$ 的导数是 $f'(x) = 2x$ 和 $f''(x) = 2$。\n\n为了计算期望 $\\mathbb{E}[f(X_h) | X_0=x]$，我们可以使用伊藤引理来分析过程 $f(X_t)$ 的动态，这是随机微积分中的一个基础工具。对于一个函数 $f(x)$ 和一个具有漂移 $\\mu(X_t)$ 和扩散 $\\nu(X_t)$ 的伊藤过程 $X_t$，伊藤引理表明：\n$$\ndf(X_t) = \\left( \\mu(X_t) f'(X_t) + \\frac{1}{2} \\nu(X_t)^2 f''(X_t) \\right) dt + \\nu(X_t) f'(X_t) dW_t\n$$\n代入我们具体的漂移 $\\mu(X_t) = bX_t$、扩散 $\\nu(X_t) = \\sigma$ 以及函数导数 $f'(X_t) = 2X_t$ 和 $f''(X_t) = 2$，我们得到：\n$$\nd(f(X_t)) = \\left( (bX_t)(2X_t) + \\frac{1}{2} \\sigma^2 (2) \\right) dt + \\sigma(2X_t) dW_t\n$$\n简化该表达式得到 $f(X_t)$ 的SDE：\n$$\nd(f(X_t)) = (2bX_t^2 + \\sigma^2) dt + 2\\sigma X_t dW_t\n$$\n这个方程描述了 $f(X_t)$ 的无穷小变化。为了将其与生成元的定义联系起来，我们可以将其写成从时间 $0$ 到 $h$ 的积分形式：\n$$\nf(X_h) - f(X_0) = \\int_0^h (2bX_s^2 + \\sigma^2) ds + \\int_0^h 2\\sigma X_s dW_s\n$$\n现在，我们对两边取期望，条件是 $X_0 = x$。这得到：\n$$\n\\mathbb{E}[f(X_h) | X_0=x] - \\mathbb{E}[f(X_0) | X_0=x] = \\mathbb{E}\\left[\\int_0^h (2bX_s^2 + \\sigma^2) ds \\bigg| X_0=x\\right] + \\mathbb{E}\\left[\\int_0^h 2\\sigma X_s dW_s \\bigg| X_0=x\\right]\n$$\n在条件 $X_0=x$ 下，$f(X_0) = f(x)$ 是一个确定性常数。伊藤积分的一个基本性质是，对于一个合适的被积函数（例如 $2\\sigma X_s$，它是一个适应于 $W_s$ 生成的信息流的过程），其期望为零。因此，最后一项为零：\n$$\n\\mathbb{E}\\left[\\int_0^h 2\\sigma X_s dW_s \\bigg| X_0=x\\right] = 0\n$$\n方程简化为：\n$$\n\\mathbb{E}[f(X_h) | X_0=x] - f(x) = \\mathbb{E}\\left[\\int_0^h (2bX_s^2 + \\sigma^2) ds \\bigg| X_0=x\\right]\n$$\n现在，我们将其代入生成元的定义中：\n$$\n\\mathcal{L}f(x) = \\lim_{h \\to 0^+} \\frac{1}{h} \\mathbb{E}\\left[\\int_0^h (2bX_s^2 + \\sigma^2) ds \\bigg| X_0=x\\right]\n$$\n根据富比尼定理，我们可以交换期望和时间积分：\n$$\n\\mathcal{L}f(x) = \\lim_{h \\to 0^+} \\frac{1}{h} \\int_0^h \\mathbb{E}[2bX_s^2 + \\sigma^2 | X_0=x] ds\n$$\n函数 $g(s) = \\mathbb{E}[2bX_s^2 + \\sigma^2 | X_0=x]$ 关于 $s$ 是连续的，因为SDE解的矩是时间连续的。根据微积分基本定理（特别是莱布尼茨积分法则，即积分号下求导），该极限是被积函数在 $s=0$ 处的值：\n$$\n\\mathcal{L}f(x) = g(0) = \\mathbb{E}[2bX_0^2 + \\sigma^2 | X_0=x]\n$$\n由于 $X_0=x$ 是一个给定的确定性值，期望可以直接计算：\n$$\n\\mathcal{L}f(x) = 2bx^2 + \\sigma^2\n$$\n这个从第一性原理出发的推导，通过使用伊藤引理分析 $f(X_t)$ 在无穷小时间间隔内的期望演化，得出了生成元作用于 $f(x)=|x|^2=x^2$ 的显式形式。该结果与伊藤扩散的生成元的一般公式 $\\mathcal{L} = \\mu(x)\\frac{\\partial}{\\partial x} + \\frac{1}{2}\\nu(x)^2\\frac{\\partial^2}{\\partial x^2}$ 一致。对于本问题，该公式为 $\\mathcal{L} = (bx)\\frac{d}{dx} + \\frac{1}{2}\\sigma^2\\frac{d^2}{dx^2}$，得出 $(bx)(2x) + \\frac{1}{2}\\sigma^2(2) = 2bx^2 + \\sigma^2$。", "answer": "$$\\boxed{2bx^{2} + \\sigma^{2}}$$", "id": "3062743"}, {"introduction": "在建立了 SDE 与其生成元之间的联系后，我们现在可以将柯尔莫哥洛夫向后方程投入实际应用。这个练习展示了 KBE 作为一个强大计算工具的威力，用它来求解一个随机过程泛函的期望值。你将通过求解向后热方程来计算多维布朗运动的均方末端位置，从而将一个偏微分方程的解与该过程的一个关键统计特性直接联系起来 [@problem_id:3062740]。", "problem": "考虑一个标准的 $d$ 维布朗运动 $\\{X_{s}\\}_{s \\ge 0}$，它解算随机微分方程 (SDE) $dX_{s} = dW_{s}$，其中 $W_{s}$ 是一个标准的 $d$ 维布朗运动，且在时刻 $t$ 有 $X_{t} = x \\in \\mathbb{R}^{d}$。设 $T > t$ 为固定值。定义函数 $u(t,x)$ 为\n$$\nu(t,x) := \\mathbb{E}\\!\\left[\\,|X_{T}|^{2} \\,\\big|\\, X_{t} = x \\right].\n$$\n使用柯尔莫哥洛夫后向方程 (KBE) 和布朗运动的生成元，从基本定义（例如无穷小生成元和 Dynkin 公式）出发，计算 $u(t,x)$ 的闭式解，且不假设任何关于转移密度的显式公式。然后使用你的表达式，通过确定 $\\mathbb{E}\\!\\left[\\,|X_{T} - x|^{2} \\,\\big|\\, X_{t} = x \\right]$ 的值，来验证布朗运动增量的方差增长性质。\n\n你的最终答案必须是 $u(t,x)$ 的单个闭式解析表达式；不要在最终答案中包含任何中间结果。无需进行四舍五入。", "solution": "根据费曼-卡茨公式，函数 $u(t,x) = \\mathbb{E}[|X_T|^2 \\,|\\, X_t = x]$ 满足科尔莫戈洛夫后向方程 (KBE)：\n$$\n\\frac{\\partial u}{\\partial t} + \\mathcal{L}u = 0, \\quad u(T,x) = |x|^2\n$$\n其中 $\\mathcal{L}$ 是过程 $X_s$ 的无穷小生成元。\n\n对于标准的 $d$ 维布朗运动 $dX_s = dW_s$，漂移向量 $\\mu(x) = 0$，扩散矩阵 $\\sigma(x)$ 为 $d \\times d$ 单位矩阵 $I$。因此，$\\sigma(x)\\sigma(x)^T = I$。生成元 $\\mathcal{L}$ 作用于一个二次连续可微函数 $f(x)$ 的形式为：\n$$\n\\mathcal{L}f(x) = \\mu(x) \\cdot \\nabla f(x) + \\frac{1}{2} \\mathrm{Tr}(\\sigma(x)\\sigma(x)^T D^2 f(x)) = 0 + \\frac{1}{2} \\mathrm{Tr}(I \\cdot D^2 f(x)) = \\frac{1}{2} \\sum_{i=1}^d \\frac{\\partial^2 f}{\\partial x_i^2} = \\frac{1}{2} \\Delta f(x)\n$$\n其中 $\\Delta$ 是拉普拉斯算子。\n\n因此，$u(t,x)$ 满足后向热方程：\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{1}{2}\\Delta u = 0, \\quad \\text{其终值条件为 } u(T,x) = |x|^2 = \\sum_{i=1}^d x_i^2\n$$\n由于终值条件是 $x$ 的二次多项式，我们假设解的形式为 $u(t,x) = A(t)|x|^2 + B(t)$。我们计算其偏导数：\n$$\n\\frac{\\partial u}{\\partial t} = A'(t)|x|^2 + B'(t)\n$$\n$$\n\\frac{\\partial u}{\\partial x_i} = 2A(t)x_i \\quad \\implies \\quad \\frac{\\partial^2 u}{\\partial x_i^2} = 2A(t)\n$$\n$$\n\\Delta u = \\sum_{i=1}^d \\frac{\\partial^2 u}{\\partial x_i^2} = \\sum_{i=1}^d 2A(t) = 2dA(t)\n$$\n将这些导数代入 KBE：\n$$\n(A'(t)|x|^2 + B'(t)) + \\frac{1}{2}(2dA(t)) = 0\n$$\n$$\nA'(t)|x|^2 + (B'(t) + dA(t)) = 0\n$$\n此方程对所有 $x \\in \\mathbb{R}^d$ 均成立，因此 $|x|^2$ 的系数和常数项必须分别等于零。这给出了一个常微分方程组 (ODE)：\n1.  $A'(t) = 0$\n2.  $B'(t) + dA(t) = 0$\n\n我们再利用终值条件 $u(T,x) = A(T)|x|^2 + B(T) = |x|^2$ 来确定 ODE 的终值：\n1.  $A(T) = 1$\n2.  $B(T) = 0$\n\n从 $A'(t) = 0$ 和 $A(T) = 1$ 可得 $A(t) = 1$ 对所有 $t \\le T$ 成立。\n将 $A(t)=1$ 代入第二个 ODE，得到 $B'(t) = -d$。积分并使用 $B(T)=0$：\n$$\nB(t) - B(T) = \\int_T^t (-d) ds \\implies B(t) - 0 = -d(t-T) = d(T-t)\n$$\n因此，$B(t) = d(T-t)$。\n\n将 $A(t)$ 和 $B(t)$ 的解代回，我们得到 $u(t,x)$ 的最终表达式：\n$$\nu(t,x) = 1 \\cdot |x|^2 + d(T-t) = |x|^2 + d(T-t)\n$$\n为了验证布朗运动增量的方差，我们计算 $\\mathbb{E}[|X_T - x|^2 \\,|\\, X_t = x]$。\n$$\n\\mathbb{E}[|X_T - x|^2 | X_t=x] = \\mathbb{E}[|X_T|^2 - 2X_T \\cdot x + |x|^2 | X_t=x] = \\mathbb{E}[|X_T|^2 | X_t=x] - 2\\mathbb{E}[X_T | X_t=x] \\cdot x + |x|^2\n$$\n由于 $X_s$ 是一个鞅（以 $X_t=x$ 为条件），我们有 $\\mathbb{E}[X_T | X_t=x] = x$。因此：\n$$\n\\mathbb{E}[|X_T - x|^2 | X_t=x] = u(t,x) - 2x \\cdot x + |x|^2 = (|x|^2 + d(T-t)) - 2|x|^2 + |x|^2 = d(T-t)\n$$\n这验证了标准布朗运动在时间 $T-t$ 内的均方位移是 $d(T-t)$。", "answer": "$$\n\\boxed{|x|^{2} + d(T-t)}\n$$", "id": "3062740"}, {"introduction": "为了巩固你对费曼-卡茨 (Feynman-Kac) 公式的理解，这最后一个练习将转换视角。这一次，你将首先通过直接求解 SDE 并利用布朗运动的性质来计算一个条件期望。然后，你将通过直接求导来验证这个显式计算出的期望函数确实满足相应的柯尔莫哥洛夫向后方程，从而证实了概率论视角与分析学视角之间的深刻等价性 [@problem_id:3062785]。", "problem": "考虑一个定义在 $s \\in [t,T]$ 上的一维 Itô 随机微分方程 (SDE)，其过程 $X_{s}$ 由 $dX_{s}=\\mu\\,ds+\\sigma\\,dW_{s}$ 给出，其中 $\\mu \\in \\mathbb{R}$ 和 $\\sigma>0$ 是常数，$W_{s}$ 是一个标准布朗运动。假设初始条件为 $X_{t}=x$。设终端收益为 $\\varphi(x)=x^{2}$，并定义函数 $u(t,x)=\\mathbb{E}\\!\\left[\\varphi\\!\\left(X_{T}\\right)\\mid X_{t}=x\\right]$。\n\n仅使用 Itô 积分、布朗运动增量和期望的基本性质，计算 $u(t,x)$ 作为 $x$、$t$、$T$、$\\mu$ 和 $\\sigma$ 的函数的显式解析表达式。然后，通过直接求导验证所得函数 $u$ 满足具有常系数生成元 $L f=\\mu\\,\\partial_{x} f+\\frac{\\sigma^{2}}{2}\\,\\partial_{xx} f$ 的 Kolmogorov 向后方程 (KBE)，即：\n$$\n\\partial_{t}u(t,x)+\\mu\\,\\partial_{x}u(t,x)+\\frac{\\sigma^{2}}{2}\\,\\partial_{xx}u(t,x)=0,\n$$\n终端条件为 $u(T,x)=x^{2}$。特别地，证明你的 $u(t,x)$ 是一个关于 $x$ 和 $T-t$ 的二次多项式，并且它解上述偏微分方程。\n\n你的最终答案必须是 $u(t,x)$ 的单个闭式解析表达式。", "solution": "我们从 Itô 随机微分方程 (SDE) 的基本定义和布朗运动的性质开始。该 SDE 为：\n$$\ndX_{s}=\\mu\\,ds+\\sigma\\,dW_{s},\\qquad s\\in[t,T],\\quad X_{t}=x,\n$$\n其中 $W_{s}$ 是一个标准布朗运动。从 $t$ 到 $T$ 积分，我们得到：\n$$\nX_{T}-X_{t}=\\int_{t}^{T}\\mu\\,ds+\\int_{t}^{T}\\sigma\\,dW_{s}=\\mu\\,(T-t)+\\sigma\\,(W_{T}-W_{t}).\n$$\n使用 $X_{t}=x$，这给出了显式表示：\n$$\nX_{T}=x+\\mu\\,(T-t)+\\sigma\\,(W_{T}-W_{t}).\n$$\n定义 $\\Delta W:=W_{T}-W_{t}$。根据布朗运动的基本性质，$\\Delta W$ 是一个均值为 $0$、方差为 $T-t$ 的高斯随机变量，并且它独立于 $\\mathcal{F}_{t}$。因此，\n$$\nu(t,x)=\\mathbb{E}\\!\\left[X_{T}^{2}\\mid X_{t}=x\\right]=\\mathbb{E}\\!\\left[\\left(x+\\mu\\,(T-t)+\\sigma\\,\\Delta W\\right)^{2}\\right].\n$$\n令 $A:=x+\\mu\\,(T-t)$。那么\n$$\nu(t,x)=\\mathbb{E}\\!\\left[(A+\\sigma\\,\\Delta W)^{2}\\right]=\\mathbb{E}\\!\\left[A^{2}+2A\\sigma\\,\\Delta W+\\sigma^{2}\\,(\\Delta W)^{2}\\right].\n$$\n利用期望的线性性质以及 $\\mathbb{E}[\\Delta W]=0$，$\\mathbb{E}[(\\Delta W)^{2}]=\\mathrm{Var}(\\Delta W)=T-t$，我们得到\n$$\nu(t,x)=A^{2}+\\sigma^{2}\\,(T-t)=\\left(x+\\mu\\,(T-t)\\right)^{2}+\\sigma^{2}\\,(T-t).\n$$\n因此，\n$$\nu(t,x)=x^{2}+2\\mu\\,x\\,(T-t)+\\mu^{2}\\,(T-t)^{2}+\\sigma^{2}\\,(T-t),\n$$\n这显然是一个关于 $x$ 和 $T-t$ 的二次多项式。\n\n接下来，我们验证 $u$ 解 Kolmogorov 向后方程 (KBE) 并满足终端条件。引入 $\\tau:=T-t$，使得 $u$ 可以写成\n$$\nu(t,x)=\\left(x+\\mu\\,\\tau\\right)^{2}+\\sigma^{2}\\,\\tau.\n$$\n对 $u$ 关于 $x$ 和 $t$ 求导。首先计算空间导数。令 $A:=x+\\mu\\,\\tau$。那么\n$$\n\\partial_{x}u(t,x)=\\partial_{x}\\left(A^{2}+\\sigma^{2}\\,\\tau\\right)=2A\\cdot\\partial_{x}A=2A,\n$$\n以及\n$$\n\\partial_{xx}u(t,x)=\\partial_{x}(2A)=2.\n$$\n对于时间导数，注意到 $\\tau=T-t$，所以 $\\partial_{t}\\tau=-1$。计算\n$$\n\\partial_{\\tau}u(t,x)=\\partial_{\\tau}\\left(A^{2}+\\sigma^{2}\\,\\tau\\right)=2A\\cdot\\partial_{\\tau}A+\\sigma^{2}=2A\\mu+\\sigma^{2},\n$$\n因此\n$$\n\\partial_{t}u(t,x)=\\partial_{\\tau}u(t,x)\\cdot\\partial_{t}\\tau=-(2\\mu\\,A+\\sigma^{2}).\n$$\n现在代入 KBE 中：\n$$\n\\partial_{t}u+\\mu\\,\\partial_{x}u+\\frac{\\sigma^{2}}{2}\\,\\partial_{xx}u=-(2\\mu\\,A+\\sigma^{2})+\\mu\\,(2A)+\\frac{\\sigma^{2}}{2}\\,(2)=-(2\\mu\\,A+\\sigma^{2})+2\\mu\\,A+\\sigma^{2}=0.\n$$\n因此 $u$ 满足 Kolmogorov 向后方程。对于终端条件，\n$$\nu(T,x)=\\left(x+\\mu\\,(T-T)\\right)^{2}+\\sigma^{2}\\,(T-T)=x^{2},\n$$\n这与 $\\varphi(x)=x^{2}$ 相匹配。因此，计算出的二次多项式 $u(t,x)$ 既解 KBE 又满足终端条件。", "answer": "$$\\boxed{\\left(x+\\mu\\,(T-t)\\right)^{2}+\\sigma^{2}\\,(T-t)}$$", "id": "3062785"}]}