{"hands_on_practices": [{"introduction": "我们从最基本的任务开始：推导布朗运动游走最大值的分布。通过应用优美的反射原理，你将找到最大值 $M_t$ 的概率密度函数，并用它来计算其期望值，这是描述该随机变量的至关重要的第一步。这个练习 [@problem_id:3049950] 为所有后续分析提供了必要的工具。", "problem": "设 $\\{B_{s}\\}_{s \\geq 0}$ 是一个标准布朗运动，即一个满足 $B_{0}=0$、具有独立平稳增量且对于每个 $t0$ 都有 $B_{t} \\sim \\mathcal{N}(0,t)$ 的连续时间随机过程，其中 $\\mathcal{N}(0,t)$ 表示均值为 $0$、方差为 $t$ 的正态分布。对于一个固定的 $t0$，定义过程最大值\n$$\nM_{t} := \\sup_{0 \\leq s \\leq t} B_{s}.\n$$\n仅使用标准布朗运动的核心性质（包括增量的对称性、$B_{t}$ 的正态分布以及可从反射原理得到的路径论证），推导 $M_{t}$ 在 $m \\geq 0$ 时的累积分布函数和概率密度函数。然后计算期望\n$$\nE[M_{t}] = \\int_{0}^{\\infty} m \\, f_{M_{t}}(m) \\, dm,\n$$\n其中 $f_{M_{t}}$ 是 $M_{t}$ 的概率密度函数。最后，利用布朗运动的尺度变换性质来证明关系式 $M_{t} \\stackrel{d}{=} \\sqrt{t}\\,M_{1}$，并从 $E[M_{1}]$ 推导出 $E[M_{t}]$。将最终答案表示为关于 $t$ 的单个闭式表达式。不需要数值近似。", "solution": "该问题陈述是随机过程理论中的一个标准的、适定的问题。它具有科学依据，内容自洽，且没有任何缺陷。我们可以开始求解。\n\n设 $\\{B_s\\}_{s \\geq 0}$ 是一个标准的一维布朗运动，且 $B_0=0$。直到时间 $t  0$ 的过程最大值定义为 $M_t := \\sup_{0 \\leq s \\leq t} B_s$。我们的任务是求出 $M_t$ 的累积分布函数（CDF）和概率密度函数（PDF），然后计算其期望 $E[M_t]$。\n\n首先，我们推导 $M_t$ 的累积分布函数，即对于任意实数 $m$，$F_{M_t}(m) = P(M_t \\leq m)$。由于 $B_0 = 0$ 且布朗运动的路径是连续的，最大值 $M_t$ 必须是非负的，即 $M_t \\geq B_0 = 0$。因此，对于任意 $m  0$，有 $P(M_t \\leq m) = 0$。我们现在考虑 $m \\geq 0$ 的情况。\n\n此推导的核心工具是布朗运动的反射原理。该原理指出，对于任何水平 $m0$，过程最大值 $M_t$ 超过 $m$ 的概率，是过程值 $B_t$ 大于 $m$ 的概率的两倍。\n我们来分析事件 $\\{M_t \\geq m\\}$。这等价于说布朗路径在某个时间 $s \\in [0, t]$ 触及或穿过了水平 $m$。设 $\\tau_m = \\inf\\{s \\geq 0 : B_s = m\\}$ 为首次到达水平 $m$ 的时间。那么事件 $\\{M_t \\geq m\\}$ 就等同于事件 $\\{\\tau_m \\leq t\\}$。\n我们可以根据终点位置 $B_t$ 来分解这个事件：\n$$\nP(M_t \\geq m) = P(M_t \\geq m, B_t \\geq m) + P(M_t \\geq m, B_t  m)\n$$\n如果 $B_t \\geq m$，那么最大值 $M_t$ 也必然至少为 $m$，所以 $M_t \\geq B_t \\geq m$。因此，事件 $\\{M_t \\geq m, B_t \\geq m\\}$ 就是事件 $\\{B_t \\geq m\\}$。\n所以，该方程变为：\n$$\nP(M_t \\geq m) = P(B_t \\geq m) + P(M_t \\geq m, B_t  m)\n$$\n反射原理指出 $P(M_t \\geq m, B_t  m) = P(B_t > m)$。简而言之，这是因为任何触及 $m$ 且最终低于 $m$ 的路径，都可以在其首次到达时间 $\\tau_m$ 之后关于直线 $y=m$ 进行“反射”。从 $\\tau_m$ 开始的反射路径对应于一条触及 $m$ 且最终高于 $m$ 的路径。根据布朗运动的强马尔可夫性质，这两类路径具有相等的概率。\n由于 $B_t$ 的分布是连续的（正态分布），我们有 $P(B_t \\geq m) = P(B_t > m)$。\n将此代入 $P(M_t \\geq m)$ 的方程中，我们得到：\n$$\nP(M_t \\geq m) = P(B_t > m) + P(B_t > m) = 2 P(B_t > m)\n$$\n随机变量 $B_t$ 服从均值为 $0$、方差为 $t$ 的正态分布，即 $B_t \\sim \\mathcal{N}(0, t)$。我们可以用标准正态变量 $Z \\sim \\mathcal{N}(0, 1)$ 将其表示为 $B_t \\stackrel{d}{=} \\sqrt{t}Z$。\n$$\nP(B_t > m) = P(\\sqrt{t}Z > m) = P(Z > \\frac{m}{\\sqrt{t}}) = 1 - \\Phi\\left(\\frac{m}{\\sqrt{t}}\\right)\n$$\n其中 $\\Phi(\\cdot)$ 是标准正态分布的累积分布函数。\n因此，对于 $m \\geq 0$：\n$$\nP(M_t \\geq m) = 2 \\left(1 - \\Phi\\left(\\frac{m}{\\sqrt{t}}\\right)\\right)\n$$\n$M_t$ 的累积分布函数是 $F_{M_t}(m) = P(M_t \\leq m) = 1 - P(M_t  m)$。由于 $M_t$ 具有连续分布，因此 $P(M_t  m) = P(M_t \\geq m)$。\n$$\nF_{M_t}(m) = 1 - 2 \\left(1 - \\Phi\\left(\\frac{m}{\\sqrt{t}}\\right)\\right) = 2\\Phi\\left(\\frac{m}{\\sqrt{t}}\\right) - 1, \\quad \\text{对于 } m \\geq 0\n$$\n而当 $m  0$ 时，$F_{M_t}(m) = 0$。\n\n接下来，我们通过对 $m \\geq 0$ 时的累积分布函数求导，来求出 $M_t$ 的概率密度函数（PDF） $f_{M_t}(m)$：\n$$\nf_{M_t}(m) = \\frac{d}{dm} F_{M_t}(m) = \\frac{d}{dm} \\left(2\\Phi\\left(\\frac{m}{\\sqrt{t}}\\right) - 1\\right)\n$$\n设 $\\phi(x) = \\frac{d}{dx}\\Phi(x) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-x^2/2)$ 为标准正态分布的PDF。使用链式法则：\n$$\nf_{M_t}(m) = 2 \\phi\\left(\\frac{m}{\\sqrt{t}}\\right) \\cdot \\frac{d}{dm}\\left(\\frac{m}{\\sqrt{t}}\\right) = 2 \\phi\\left(\\frac{m}{\\sqrt{t}}\\right) \\cdot \\frac{1}{\\sqrt{t}}\n$$\n代入 $\\phi(\\cdot)$ 的表达式：\n$$\nf_{M_t}(m) = \\frac{2}{\\sqrt{t}} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1}{2}\\left(\\frac{m}{\\sqrt{t}}\\right)^2\\right) = \\frac{2}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{m^2}{2t}\\right) = \\sqrt{\\frac{2}{\\pi t}} \\exp\\left(-\\frac{m^2}{2t}\\right)\n$$\n这是 $m \\geq 0$ 时的PDF。对于 $m  0$，$f_{M_t}(m) = 0$。这个分布被称为折叠正态分布。值得注意的是，$M_t$ 与 $|B_t|$ 具有相同的分布。\n\n现在我们计算期望 $E[M_t]$：\n$$\nE[M_t] = \\int_{-\\infty}^{\\infty} m f_{M_t}(m) dm = \\int_{0}^{\\infty} m f_{M_t}(m) dm\n$$\n$$\nE[M_t] = \\int_{0}^{\\infty} m \\left(\\sqrt{\\frac{2}{\\pi t}} \\exp\\left(-\\frac{m^2}{2t}\\right)\\right) dm = \\sqrt{\\frac{2}{\\pi t}} \\int_{0}^{\\infty} m \\exp\\left(-\\frac{m^2}{2t}\\right) dm\n$$\n为了计算该积分，我们进行换元 $u = \\frac{m^2}{2t}$。这得到 $du = \\frac{2m}{2t} dm = \\frac{m}{t} dm$，所以 $m \\, dm = t \\, du$。积分上下限仍为从 $0$ 到 $\\infty$。\n$$\nE[M_t] = \\sqrt{\\frac{2}{\\pi t}} \\int_{0}^{\\infty} \\exp(-u) (t \\, du) = t \\sqrt{\\frac{2}{\\pi t}} \\int_{0}^{\\infty} e^{-u} du\n$$\n积分 $\\int_{0}^{\\infty} e^{-u} du = [-e^{-u}]_0^\\infty = 0 - (-1) = 1$。\n$$\nE[M_t] = t \\sqrt{\\frac{2}{\\pi t}} \\cdot 1 = \\sqrt{t^2 \\cdot \\frac{2}{\\pi t}} = \\sqrt{\\frac{2t}{\\pi}}\n$$\n\n最后，我们使用布朗运动的尺度变换性质来验证此结果。该尺度变换性质指出，对于任何常数 $c0$，过程 $W_s = \\frac{1}{\\sqrt{c}}B_{cs}$ 也是一个标准布朗运动。我们选择 $c=t$。那么对于 $s \\geq 0$ 定义的过程 $W_s = \\frac{1}{\\sqrt{t}} B_{ts}$ 是一个标准布朗运动。\n我们可以用这个新过程 $W_s$ 来表示 $M_t$。注意 $B_{ts} = \\sqrt{t} W_s$。\n$$\nM_t = \\sup_{0 \\leq u \\leq t} B_u\n$$\n我们对上确界进行变量替换，令 $s = u/t$。当 $u$ 的取值范围是 $0$ 到 $t$ 时，$s$ 的取值范围是 $0$ 到 $1$。\n$$\nM_t = \\sup_{0 \\leq s \\leq 1} B_{ts} = \\sup_{0 \\leq s \\leq 1} (\\sqrt{t} W_s) = \\sqrt{t} \\sup_{0 \\leq s \\leq 1} W_s\n$$\n项 $\\sup_{0 \\leq s \\leq 1} W_s$ 是标准布朗运动 $W$ 在时间区间 $[0,1]$ 上的最大值。我们将其记为 $M_{W,1}$。由于 $W$ 是一个标准布朗运动，其在 $[0,1]$ 上的最大值的分布与原始布朗运动 $B$ 在 $[0,1]$ 上的最大值（即 $M_1$）的分布相同。因此，$M_{W,1} \\stackrel{d}{=} M_1$。\n这导出了分布上的相等关系：\n$$\nM_t \\stackrel{d}{=} \\sqrt{t} M_1\n$$\n对两边取期望：\n$$\nE[M_t] = E[\\sqrt{t} M_1] = \\sqrt{t} E[M_1]\n$$\n我们可以通过在我们之前的一般计算中令 $t=1$ 来求得 $E[M_1]$：\n$$\nE[M_1] = \\sqrt{\\frac{2(1)}{\\pi}} = \\sqrt{\\frac{2}{\\pi}}\n$$\n将这个值代回，我们得到：\n$$\nE[M_t] = \\sqrt{t} \\cdot \\sqrt{\\frac{2}{\\pi}} = \\sqrt{\\frac{2t}{\\pi}}\n$$\n这验证了我们的直接计算结果，并展示了尺度变换性质的实用性。", "answer": "$$\\boxed{\\sqrt{\\frac{2t}{\\pi}}}$$", "id": "3049950"}, {"introduction": "在我们掌握了最大值分布的知识后，现在我们从一阶矩（均值）转向二阶矩，以计算方差。这个练习 [@problem_id:3049921] 不仅会巩固你的积分技巧，还会揭示一个显著的分布等价关系 $M_t \\stackrel{d}{=} |B_t|$，它为计算矩提供了一个强大的捷径。理解方差为我们提供了衡量最大值分布或波动性的一个指标。", "problem": "设 $\\{B_{s}\\}_{s \\ge 0}$ 为标准布朗运动，且 $B_{0} = 0$。定义截至时刻 $t0$ 的运行最大值为 $M_{t} := \\sup_{0 \\le s \\le t} B_{s}$。从布朗运动的基本性质（平稳独立增量和 $B_{t} \\sim \\mathcal{N}(0,t)$）以及反射原理出发，推导当 $m \\ge 0$ 时 $M_{t}$ 的累积分布函数，求出其概率密度函数，然后计算其一阶矩 $E[M_{t}]$ 和二阶矩 $E[M_{t}^{2}]$。利用这些结果确定方差 $\\operatorname{Var}(M_{t})$。将您的最终答案表示为单一的闭式解析表达式。无需四舍五入。", "solution": "设 $\\{B_{s}\\}_{s \\ge 0}$ 为一个标准布朗运动，且 $B_{0} = 0$。我们的任务是求其在固定时间 $t  0$ 的运行最大值 $M_{t} = \\sup_{0 \\le s \\le t} B_{s}$ 的方差。推导过程将分步进行：首先，我们利用反射原理求出 $M_{t}$ 的累积分布函数（CDF）；其次，推导其概率密度函数（PDF）；第三，计算 $M_{t}$ 的一阶矩和二阶矩；最后，计算方差。\n\n**1. $M_{t}$ 的累积分布函数（CDF）**\n\n对于任意水平 $m \\ge 0$，$M_{t}$ 的累积分布函数为 $F_{M_t}(m) = P(M_{t} \\le m)$。通常，先计算其互补累积分布函数 $P(M_{t}  m)$ 会更直接。事件 $\\{M_{t}  m\\}$ 意味着布朗运动的路径在时刻 $t$ 之前某个时间点已经越过了水平 $m$。设 $\\tau_{m} = \\inf\\{s \\ge 0 : B_{s} = m\\}$ 为首次到达水平 $m$ 的时间（首中时）。那么事件 $\\{M_{t}  m\\}$ 等同于事件 $\\{\\tau_{m} \\le t\\}$。\n\n我们可以根据 $B_t$ 的值将事件 $\\{\\tau_m \\le t\\}$ 进行划分：\n$$P(M_t  m) = P(\\tau_{m} \\le t) = P(\\tau_m \\le t, B_t  m) + P(\\tau_m \\le t, B_t = m) + P(\\tau_m \\le t, B_t  m)$$\n由于 $B_t$ 是一个连续型随机变量，其恰好等于水平 $m$ 的概率为零，即 $P(B_t = m) = 0$。\n如果 $B_t  m$，那么根据布朗运动路径的连续性以及起点 $B_0=0$，该路径必然在某个时间 $\\tau_m \\le t$ 越过了水平 $m$。因此，事件 $\\{B_t  m\\}$ 是 $\\{\\tau_m \\le t\\}$ 的一个子集，这意味着 $P(\\tau_m \\le t, B_t  m) = P(B_t  m)$。\n表达式简化为：\n$$P(M_t  m) = P(B_t  m) + P(\\tau_m \\le t, B_t  m)$$\n为了计算最后一项，我们使用反射原理，这是布朗运动强马尔可夫性的一个推论。在事件 $\\{\\tau_m \\le t\\}$ 发生的情况下，过程在时间 $\\tau_m$ 的状态上进行反射。对于 $s  \\tau_m$，过程 $B_s - m$ 的行为关于 $0$ 是对称的。这意味着，给定路径在时间 $t$ 之前已到达 $m$，它最终在 $m$ 上方或下方的可能性是相等的。更正式地：\n$$P(\\tau_m \\le t, B_t  m) = P(\\tau_m \\le t, B_t > m)$$\n因为 $P(\\tau_m \\le t, B_t > m) = P(B_t > m)$，我们有 $P(\\tau_m \\le t, B_t  m) = P(B_t > m)$。\n将此代入我们关于 $P(M_t > m)$ 的方程中：\n$$P(M_t > m) = P(B_t > m) + P(B_t > m) = 2P(B_t > m)$$\n由于 $M_t$ 是一个连续型随机变量，$P(M_t > m) = P(M_t \\ge m)$，因此对于 $m \\ge 0$：\n$$P(M_t \\ge m) = 2P(B_t \\ge m)$$\n标准布朗运动服从分布 $B_t \\sim \\mathcal{N}(0, t)$。设 $Z \\sim \\mathcal{N}(0, 1)$ 为一个标准正态随机变量。那么 $B_t$ 与 $\\sqrt{t}Z$ 同分布。\n$$P(B_t \\ge m) = P(\\sqrt{t}Z \\ge m) = P\\left(Z \\ge \\frac{m}{\\sqrt{t}}\\right) = 1 - \\Phi\\left(\\frac{m}{\\sqrt{t}}\\right)$$\n其中 $\\Phi(\\cdot)$ 是标准正态分布的累积分布函数。\n$M_t$ 的累积分布函数则为：\n$$F_{M_t}(m) = P(M_t \\le m) = 1 - P(M_t  m) = 1 - 2P(B_t  m) = 1 - 2\\left(1 - \\Phi\\left(\\frac{m}{\\sqrt{t}}\\right)\\right) = 2\\Phi\\left(\\frac{m}{\\sqrt{t}}\\right) - 1$$\n该公式对 $m \\ge 0$ 有效。由于 $M_t \\ge B_0 = 0$，对于 $m  0$，有 $F_{M_t}(m) = 0$。\n\n**2. $M_{t}$ 的概率密度函数（PDF）**\n\n概率密度函数 $f_{M_t}(m)$ 是累积分布函数对 $m$ 的导数（对于 $m \\ge 0$）。\n$$f_{M_t}(m) = \\frac{d}{dm} \\left[2\\Phi\\left(\\frac{m}{\\sqrt{t}}\\right) - 1\\right]$$\n设 $\\phi(x) = \\frac{d}{dx}\\Phi(x) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-x^2/2)$ 为标准正态分布的概率密度函数。使用链式法则：\n$$f_{M_t}(m) = 2 \\cdot \\phi\\left(\\frac{m}{\\sqrt{t}}\\right) \\cdot \\frac{d}{dm}\\left(\\frac{m}{\\sqrt{t}}\\right) = 2 \\cdot \\phi\\left(\\frac{m}{\\sqrt{t}}\\right) \\cdot \\frac{1}{\\sqrt{t}}$$\n代入 $\\phi(\\cdot)$ 的表达式：\n$$f_{M_t}(m) = 2 \\left( \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1}{2}\\left(\\frac{m}{\\sqrt{t}}\\right)^2\\right) \\right) \\frac{1}{\\sqrt{t}} = \\frac{2}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{m^2}{2t}\\right) = \\sqrt{\\frac{2}{\\pi t}} \\exp\\left(-\\frac{m^2}{2t}\\right)$$\n此概率密度函数适用于 $m \\ge 0$ 的情况，而对于 $m  0$，有 $f_{M_t}(m) = 0$。这是一个尺度参数为 $\\sigma = \\sqrt{t}$ 的半正态分布的概率密度函数。一个值得注意的推论是，$M_t$ 与 $|B_t|$ 具有相同的分布。\n\n**3. 一阶矩 $E[M_{t}]$**\n\n$M_t$ 的期望值可以通过在其支撑集 $[0, \\infty)$ 上对 $m \\cdot f_{M_t}(m)$ 进行积分得到：\n$$E[M_{t}] = \\int_{0}^{\\infty} m f_{M_t}(m) dm = \\int_{0}^{\\infty} m \\sqrt{\\frac{2}{\\pi t}} \\exp\\left(-\\frac{m^2}{2t}\\right) dm$$\n$$E[M_t] = \\sqrt{\\frac{2}{\\pi t}} \\int_0^\\infty m \\exp\\left(-\\frac{m^2}{2t}\\right) dm$$\n我们进行换元，令 $u = \\frac{m^2}{2t}$，则 $du = \\frac{m}{t} dm$，或 $m \\, dm = t \\, du$。积分上下限仍为 $0$ 到 $\\infty$。\n$$E[M_t] = \\sqrt{\\frac{2}{\\pi t}} \\int_0^\\infty \\exp(-u) (t \\, du) = t \\sqrt{\\frac{2}{\\pi t}} \\int_0^\\infty \\exp(-u) du$$\n积分 $\\int_0^\\infty \\exp(-u) du = 1$。\n$$E[M_t] = t \\sqrt{\\frac{2}{\\pi t}} = \\sqrt{\\frac{2t^2}{\\pi t}} = \\sqrt{\\frac{2t}{\\pi}}$$\n\n**4. 二阶矩 $E[M_{t}^{2}]$**\n\n二阶矩 $E[M_{t}^{2}]$ 可以通过两种方式计算。第一种是直接积分：\n$$E[M_t^2] = \\int_{0}^{\\infty} m^2 f_{M_t}(m) dm = \\sqrt{\\frac{2}{\\pi t}} \\int_{0}^{\\infty} m^2 \\exp\\left(-\\frac{m^2}{2t}\\right) dm$$\n一个更直接的方法是利用 $M_t$ 与 $|B_t|$ 同分布这一事实。这意味着 $M_t^2$ 与 $|B_t|^2 = B_t^2$ 同分布。因此：\n$$E[M_t^2] = E[B_t^2]$$\n对于一个标准布朗运动 $B_t \\sim \\mathcal{N}(0, t)$，其方差为 $\\operatorname{Var}(B_t) = E[B_t^2] - (E[B_t])^2$。\n我们知道 $E[B_t] = 0$ 且 $\\operatorname{Var}(B_t) = t$。\n代入这些值：$t = E[B_t^2] - 0^2$，得到 $E[B_t^2] = t$。\n因此，最大值的二阶矩为：\n$$E[M_t^2] = t$$\n\n**5. 方差 $\\operatorname{Var}(M_{t})$**\n\n最后，使用标准公式 $\\operatorname{Var}(M_t) = E[M_t^2] - (E[M_t])^2$ 来计算方差。\n使用我们推导出的矩：\n$$\\operatorname{Var}(M_t) = t - \\left(\\sqrt{\\frac{2t}{\\pi}}\\right)^2 = t - \\frac{2t}{\\pi}$$\n提出因子 $t$ 得到方差的最终闭式表达式：\n$$\\operatorname{Var}(M_t) = t\\left(1 - \\frac{2}{\\pi}\\right)$$", "answer": "$$\\boxed{t \\left( 1 - \\frac{2}{\\pi} \\right)}$$", "id": "3049921"}, {"introduction": "布朗运动最大值的理论具有深远的影响，其中最直接的一个是它与首次击中时间的联系。在最后一个练习 [@problem_id:3049951] 中，你将利用 $M_t$ 的分布来确定 $\\tau_a$（布朗运动首次达到水平 $a$ 的时间）的分布。这将引导你得出一个惊人且有些反直觉的结论：虽然该过程保证会达到该水平，但达到该水平的期望时间是无限的。", "problem": "设 $\\{B_{t}\\}_{t \\geq 0}$ 为一维标准布朗运动，且 $B_{0} = 0$。对于一个固定水平 $a  0$，定义首次到达时间 $\\tau_{a} := \\inf\\{t \\geq 0 : B_{t} = a\\}$ 和运行最大值 $M_{t} := \\sup_{0 \\leq s \\leq t} B_{s}$。假设布朗运动的基本性质：对于每个 $t  0$，$B_{t}$ 是均值为 $0$、方差为 $t$ 的高斯随机变量，该过程具有平稳和独立的增量，且路径是连续的。仅使用这些基础知识和反射原理，按以下步骤进行：\n- 对于每个 $t  0$ 和 $a  0$，证明 $\\mathbb{P}(M_{t} \\geq a)$ 可以用 $\\mathbb{P}(B_{t} \\geq a)$ 表示，从而建立运行最大值与 $B_{t}$ 边缘分布之间的关系。\n- 根据此关系，推导出首次到达时间 $\\tau_{a}$ 的累积分布函数 (CDF) $F_{\\tau_{a}}(t) := \\mathbb{P}(\\tau_{a} \\leq t)$ (其中 $t0$)，然后通过求导得到其概率密度函数 (PDF) $f_{\\tau_{a}}(t)$。\n- 计算积分 $\\int_{0}^{\\infty} t \\, f_{\\tau_{a}}(t) \\, dt$，并判断其收敛还是发散，从第一性原理出发证明你的结论，不得使用任何预先给出的简化公式。得出 $\\mathbb{E}[\\tau_{a}]$ 的值。\n\n你的最终答案必须是 $\\mathbb{E}[\\tau_{a}]$ 的值，表示为单个封闭形式的数学表达式。不需要四舍五入，也不涉及物理单位。", "solution": "该问题要求对从 $B_0=0$ 出发的一维标准布朗运动 $\\{B_t\\}_{t \\geq 0}$ 进行多步推导。我们首先被要求将运行最大值 $M_t = \\sup_{0 \\leq s \\leq t} B_s$ 超过水平 $a  0$ 的概率与 $B_t$ 超过该水平的边缘概率联系起来。然后，我们要找出首次到达时间 $\\tau_a = \\inf\\{t \\geq 0: B_t = a\\}$ 的分布，并最终计算其期望 $\\mathbb{E}[\\tau_a]$。解题过程将按要求分为三个部分。\n\n### 第一部分：运行最大值的分布\n\n我们的目标是对于任意固定的 $t0$ 和 $a0$，找到 $\\mathbb{P}(M_t \\geq a)$ 和 $\\mathbb{P}(B_t \\geq a)$ 之间的关系。事件 $\\{M_t \\geq a\\}$ 意味着布朗运动的路径在某个时间 $s \\in [0, t]$ 已经达到或超过了水平 $a$。\n\n我们可以根据 $B_t$ 的值来划分样本空间。根据全概率公式，我们可以写出：\n$$\n\\mathbb{P}(M_t \\geq a) = \\mathbb{P}(M_t \\geq a \\text{ and } B_t \\geq a) + \\mathbb{P}(M_t \\geq a \\text{ and } B_t  a)\n$$\n我们来分析第一项。如果过程在时间 $t$ 处于或高于水平 $a$，即 $B_t \\geq a$，那么它在区间 $[0, t]$ 上的最大值也必须处于或高于 $a$，即 $M_t \\geq a$。这是因为 $M_t = \\sup_{0 \\leq s \\leq t} B_s \\geq B_t$。因此，事件 $\\{B_t \\geq a\\}$ 是事件 $\\{M_t \\geq a\\}$ 的一个子集。这意味着这两个事件的交集就是事件 $\\{B_t \\geq a\\}$ 本身。所以，\n$$\n\\mathbb{P}(M_t \\geq a \\text{ and } B_t \\geq a) = \\mathbb{P}(B_t \\geq a)\n$$\n现在我们分析第二项，$\\mathbb{P}(M_t \\geq a \\text{ and } B_t  a)$。这是路径在某个时刻达到或超过水平 $a$，但在时间 $t$ 结束时低于 $a$ 的概率。要发生这种情况，路径必须在某个时间 $\\tau_a \\leq t$ 穿过水平 $a$。这里就要应用布朗运动的反射原理。\n\n反射原理指出，对于任何 $a  0$，一个从 $0$ 开始的路径在时间 $t$ 之前到达水平 $a$ 并且在 $B_t  a$ 结束的概率，等于一个从 $0$ 开始的路径在 $B_t  a$ 结束的概率。为了证明这一点，考虑一条路径 $\\omega$，对于该路径有 $M_t(\\omega) \\geq a$ 和 $B_t(\\omega)  a$。设 $\\tau_a(\\omega)$ 是这条路径首次到达 $a$ 的时间。我们通过在时间 $\\tau_a(\\omega)$ 之后反射原始路径来定义一条新路径 $\\tilde{\\omega}$：\n$$\n\\tilde{B}_s(\\omega) = \\begin{cases} B_s(\\omega)  \\text{if } s \\leq \\tau_a(\\omega) \\\\ 2a - B_s(\\omega)  \\text{if } s > \\tau_a(\\omega) \\end{cases}\n$$\n根据构造，由于 $B_t(\\omega)  a$，反射路径在时间 $t$ 的值为 $\\tilde{B}_t(\\omega) = 2a - B_t(\\omega)  2a - a = a$。从 $\\omega$ 到 $\\tilde{\\omega}$ 的映射是在 $\\{M_t \\geq a, B_t  a\\}$ 的路径集合与 $\\{B_t  a\\}$ 的路径集合之间的一个双射。布朗运动的强马尔可夫性和其增量的对称性意味着这个映射保持概率不变。因此，\n$$\n\\mathbb{P}(M_t \\geq a \\text{ and } B_t  a) = \\mathbb{P}(B_t  a)\n$$\n由于 $B_t$ 服从正态分布，这是一个连续分布，因此它恰好等于任何特定值的概率为 $0$。所以，$\\mathbb{P}(B_t  a) = \\mathbb{P}(B_t \\geq a)$。\n\n将这些结果代回我们最初的方程：\n$$\n\\mathbb{P}(M_t \\geq a) = \\mathbb{P}(B_t \\geq a) + \\mathbb{P}(B_t  a) = \\mathbb{P}(B_t \\geq a) + \\mathbb{P}(B_t \\geq a)\n$$\n这就得出了基本关系：\n$$\n\\mathbb{P}(M_t \\geq a) = 2 \\, \\mathbb{P}(B_t \\geq a)\n$$\n\n### 第二部分：首次到达时间 $\\tau_a$ 的累积分布函数(CDF)和概率密度函数(PDF)\n\n$\\tau_a$ 的累积分布函数 (CDF) 定义为 $F_{\\tau_a}(t) = \\mathbb{P}(\\tau_a \\leq t)$。首次到达时间 $\\tau_a$ 小于或等于 $t$ 的事件等价于运行最大值 $M_t$ 大于或等于 $a$ 的事件。这是因为 $B_0=0$ 且布朗运动的路径是连续的。如果 $M_t \\geq a$，路径必定在时间 $t$ 或之前访问过 $a$。反之，如果 $\\tau_a \\leq t$，那么 $B_{\\tau_a} = a$，所以 $M_t \\geq a$。因此，$\\{\\tau_a \\leq t\\} = \\{M_t \\geq a\\}$。\n\n使用第一部分的结果，我们可以将 $\\tau_a$ 的CDF写为：\n$$\nF_{\\tau_a}(t) = \\mathbb{P}(\\tau_a \\leq t) = \\mathbb{P}(M_t \\geq a) = 2 \\, \\mathbb{P}(B_t \\geq a)\n$$\n在固定时间 $t$，标准布朗运动 $B_t$ 是一个均值为 $0$、方差为 $t$ 的正态分布随机变量，即 $B_t \\sim \\mathcal{N}(0, t)$。我们可以用标准正态变量 $Z \\sim \\mathcal{N}(0, 1)$ 来表示它，即 $B_t = \\sqrt{t} Z$。\n$$\n\\mathbb{P}(B_t \\geq a) = \\mathbb{P}(\\sqrt{t} Z \\geq a) = \\mathbb{P}\\left(Z \\geq \\frac{a}{\\sqrt{t}}\\right)\n$$\n概率 $\\mathbb{P}(Z \\geq z)$可以写成标准正态PDF $\\phi(u) = \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{u^2}{2}\\right)$的积分：\n$$\n\\mathbb{P}\\left(Z \\geq \\frac{a}{\\sqrt{t}}\\right) = \\int_{a/\\sqrt{t}}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2}\\right) du\n$$\n所以，$\\tau_a$ 的CDF是：\n$$\nF_{\\tau_a}(t) = 2 \\int_{a/\\sqrt{t}}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2}\\right) du\n$$\n为了找到概率密度函数 (PDF) $f_{\\tau_a}(t)$，我们将CDF对 $t$ 求导。使用莱布尼茨积分法则 ($\\frac{d}{dx} \\int_{g(x)}^{h(x)} f(u) du = f(h(x))h'(x) - f(g(x))g'(x)$)，我们有：\n$$\nf_{\\tau_a}(t) = \\frac{d}{dt} F_{\\tau_a}(t) = \\frac{d}{dt} \\left( 2 \\int_{a/\\sqrt{t}}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2}\\right) du \\right)\n$$\n积分上限是一个常数，所以它的导数是 $0$。积分下限是 $g(t) = a t^{-1/2}$，它的导数是 $g'(t) = a(-\\frac{1}{2})t^{-3/2} = -\\frac{a}{2t^{3/2}}$。\n$$\nf_{\\tau_a}(t) = 2 \\left( 0 - \\left[ \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1}{2}\\left(\\frac{a}{\\sqrt{t}}\\right)^2\\right) \\right] \\cdot \\left( -\\frac{a}{2t^{3/2}} \\right) \\right)\n$$\n$$\nf_{\\tau_a}(t) = 2 \\left( \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{a^2}{2t}\\right) \\frac{a}{2t^{3/2}} \\right)\n$$\n简化此表达式，得到首次到达时间 $\\tau_a$ 的PDF：\n$$\nf_{\\tau_a}(t) = \\frac{a}{\\sqrt{2\\pi} t^{3/2}} \\exp\\left(-\\frac{a^2}{2t}\\right) \\quad \\text{对于 } t  0\n$$\n\n### 第三部分：首次到达时间的期望 $\\mathbb{E}[\\tau_a]$\n\n$\\tau_a$ 的期望由 $t$ 乘以其PDF在其支撑集 $(0, \\infty)$ 上的积分给出：\n$$\n\\mathbb{E}[\\tau_a] = \\int_{0}^{\\infty} t \\, f_{\\tau_a}(t) \\, dt\n$$\n代入推导出的PDF：\n$$\n\\mathbb{E}[\\tau_a] = \\int_{0}^{\\infty} t \\left( \\frac{a}{\\sqrt{2\\pi} t^{3/2}} \\exp\\left(-\\frac{a^2}{2t}\\right) \\right) dt\n$$\n我们可以简化被积函数：\n$$\n\\mathbb{E}[\\tau_a] = \\frac{a}{\\sqrt{2\\pi}} \\int_{0}^{\\infty} t \\cdot t^{-3/2} \\exp\\left(-\\frac{a^2}{2t}\\right) dt = \\frac{a}{\\sqrt{2\\pi}} \\int_{0}^{\\infty} t^{-1/2} \\exp\\left(-\\frac{a^2}{2t}\\right) dt\n$$\n我们现在必须计算这个瑕积分并确定它是否收敛。必须在极限 $t \\to 0^+$ 和 $t \\to \\infty$ 处分析该积分。\n\n1.  当 $t \\to 0^+$ 时的行为：令 $y = 1/t$。当 $t \\to 0^+$ 时，$y \\to \\infty$。被积函数变为 $y^{1/2} \\exp(-a^2 y/2)$。多次使用洛必达法则表明 $\\lim_{y\\to\\infty} y^{1/2} \\exp(-a^2 y/2) = 0$。被积函数在积分下限处趋近于 $0$，因此对于任何有限的 $K  0$，积分在形如 $[0, K]$ 的区间上收敛。\n\n2.  当 $t \\to \\infty$ 时的行为：当 $t \\to \\infty$ 时，项 $a^2/(2t) \\to 0$，因此 $\\exp(-a^2/(2t)) \\to \\exp(0) = 1$。\n    对于大的 $t$，被积函数的渐近行为类似于 $t^{-1/2}$：\n    $$\n    t^{-1/2} \\exp\\left(-\\frac{a^2}{2t}\\right) \\sim t^{-1/2} \\quad \\text{当 } t \\to \\infty\n    $$\n    我们可以使用瑕积分的极限比较判别法。考虑积分 $\\int_{1}^{\\infty} t^{-p} dt$。此积分收敛当且仅当 $p  1$。在我们的例子中，幂是 $p = 1/2$。由于 $p = 1/2 \\leq 1$，积分 $\\int_{1}^{\\infty} t^{-1/2} dt$ 发散。\n    形式上，令 $g(t) = t^{-1/2} \\exp(-a^2/(2t))$ 且 $h(t) = t^{-1/2}$。\n    $$\n    \\lim_{t\\to\\infty} \\frac{g(t)}{h(t)} = \\lim_{t\\to\\infty} \\frac{t^{-1/2} \\exp(-a^2/(2t))}{t^{-1/2}} = \\lim_{t\\to\\infty} \\exp\\left(-\\frac{a^2}{2t}\\right) = 1\n    $$\n    由于这个极限是一个有限的正数，并且积分 $\\int_{1}^{\\infty} h(t) dt = \\int_{1}^{\\infty} t^{-1/2} dt$ 发散，所以积分 $\\int_{1}^{\\infty} g(t) dt$ 也必定发散。期望的积分可以分解为 $\\int_{0}^{1} g(t) dt + \\int_{1}^{\\infty} g(t) dt$。第一部分是有限的，但第二部分发散到无穷大。\n\n因此，$\\mathbb{E}[\\tau_a]$ 的积分发散到 $+\\infty$。\n\n结论：标准布朗运动首次到达任何水平 $a  0$ 的期望时间是无限的。\n$$\n\\mathbb{E}[\\tau_a] = \\infty\n$$", "answer": "$$\\boxed{\\infty}$$", "id": "3049951"}]}