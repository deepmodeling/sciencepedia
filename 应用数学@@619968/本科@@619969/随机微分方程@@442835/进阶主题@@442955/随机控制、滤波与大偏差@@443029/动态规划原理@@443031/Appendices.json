{"hands_on_practices": [{"introduction": "本练习将动态规划方法应用于随机控制中的一个基本问题，展示其强大的威力。您将为一个线性系统和一个二次型代价泛函推导哈密顿-雅可比-贝尔曼（HJB）方程。通过假设价值函数具有二次型形式，您将看到HJB偏微分方程如何转化为一个常微分方程组，其中包括著名的黎卡提方程（Riccati equation），然后您将针对一个具体案例求解这些方程 [@problem_id:3051347]。", "problem": "考虑一个由标准一维布朗运动驱动的标量受控随机微分方程，\n$$\ndX_{s}=\\left(A X_{s}+B a_{s}\\right)ds+\\Sigma\\, dW_{s},\\quad s\\in[t,T],\\quad X_{t}=x,\n$$\n其二次代价函数为\n$$\nJ(t,x;a)=\\mathbb{E}\\left[\\int_{t}^{T}\\left(X_{s}^{2}Q+a_{s}^{2}R\\right)ds+X_{T}^{2}S\\right].\n$$\n令价值函数为\n$$\nV(t,x)=\\inf_{a}\\,J(t,x;a),\n$$\n其中下确界取自所有使代价有限的循序可测控制。从价值函数的定义和动态规划原理（DPP）出发，推导相关的哈密顿–雅可比–贝尔曼（HJB）方程，然后为 $V(t,x)$ 引入一个状态的二次型拟设，并确定其系数所满足的常微分方程。\n\n将问题具体化到参数选择 $A=0$, $B=1$, $\\Sigma=2$, $Q=0$, $R=1$, $S=1$，有限时间域 $T>0$ 和初始状态 $X_{0}=x_{0}$。仅使用第一性原理（DPP 和伊藤公式），确定最优控制下 $V(0,x_{0})$ 的闭式解析表达式。将您的最终答案表示为关于 $x_{0}$ 和 $T$ 的单个简化符号表达式。无需进行数值近似或四舍五入。", "solution": "用户希望为一个特定的随机最优控制问题寻找价值函数。解题过程包括从第一性原理推导通用的哈密顿–雅可比–贝尔曼（HJB）方程，针对给定参数进行具体化，然后求解该方程以找到价值函数。\n\n**问题验证**\n\n首先，我将验证问题的有效性。\n\n**步骤 1：提取已知条件**\n-   状态 $X_s$ 的随机微分方程（SDE）：\n    $$dX_{s}=\\left(A X_{s}+B a_{s}\\right)ds+\\Sigma\\, dW_{s},\\quad s\\in[t,T],\\quad X_{t}=x$$\n-   待最小化的代价函数：\n    $$J(t,x;a)=\\mathbb{E}\\left[\\int_{t}^{T}\\left(X_{s}^{2}Q+a_{s}^{2}R\\right)ds+X_{T}^{2}S\\right]$$\n-   价值函数定义：\n    $$V(t,x)=\\inf_{a}\\,J(t,x;a)$$\n-   具体参数值：$A=0$, $B=1$, $\\Sigma=2$, $Q=0$, $R=1$, $S=1$。\n-   初始条件：时间 $t=0$，状态 $X_0=x_0$。\n-   时间域：有限时间 $T>0$。\n-   方法论：解必须从动态规划原理（DPP）出发，并使用伊藤公式推导。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据：**该问题是一个经典的线性二次（LQ）随机控制问题。其数学框架，包括 SDE、代价函数、DPP 和 HJB 方程，是控制理论和随机微积分中的基本概念。该问题没有任何科学或事实上的不健全之处。\n-   **适定性：**问题是完全指定的。所有参数、动态和目标都已明确定义。这是一个标准的问​​题设置，已知有唯一、稳定且有意义的解。\n-   **客观性：**问题陈述使用精确、形式化的数学语言编写，没有主观或含糊不清的术语。\n\n**步骤 3：结论与行动**\n该问题是有效的，因为它是一个标准的、适定的随机最优控制问题。我将继续进行求解。\n\n**哈密顿–雅可比–贝尔曼（HJB）方程的推导**\n\n价值函数 $V(t,x)$ 在无穷小时间区间 $[t, t+dt]$ 上的动态规划原理（DPP）为：\n$$\nV(t,x) = \\inf_{a}\\mathbb{E}\\left[\\int_{t}^{t+dt}\\left(X_{u}^{2}Q+a_{u}^{2}R\\right)du + V(t+dt, X_{t+dt}) \\mid X_{t}=x \\right]\n$$\n对于一个很小的时间间隔 $dt$，我们可以将积分近似为 $(X_t^2 Q + a_t^2 R)dt = (x^2 Q + a_t^2 R)dt$。DPP 变为：\n$$\nV(t,x) \\approx \\inf_{a_t}\\left\\{ (x^2 Q + a_t^2 R)dt + \\mathbb{E}[V(t+dt, X_{t+dt})] \\right\\}\n$$\n我们应用伊藤公式来展开 $V(t,X_t)$：\n$$\ndV(t,X_t) = \\frac{\\partial V}{\\partial t}dt + \\frac{\\partial V}{\\partial x}dX_t + \\frac{1}{2}\\frac{\\partial^2 V}{\\partial x^2}(dX_t)^2\n$$\n对于 $dX_{t}=\\left(A X_{t}+B a_{t}\\right)dt+\\Sigma\\, dW_{t}$，$(dX_t)^2$ 的伊藤规则给出 $(dX_t)^2 = (\\Sigma dW_t)^2 = \\Sigma^2 dt$。将此结果和 $dX_t$ 代入 $dV$ 的展开式：\n$$\ndV(t,X_t) = \\left(\\frac{\\partial V}{\\partial t} + (AX_t+Ba_t)\\frac{\\partial V}{\\partial x} + \\frac{1}{2}\\Sigma^2\\frac{\\partial^2 V}{\\partial x^2}\\right)dt + \\Sigma\\frac{\\partial V}{\\partial x}dW_t\n$$\n对 $dV$ 从 $t$ 到 $t+dt$ 的积分取期望：\n$$\n\\mathbb{E}[V(t+dt,X_{t+dt})] - V(t,x) \\approx \\left(\\frac{\\partial V}{\\partial t} + (Ax+Ba_t)\\frac{\\partial V}{\\partial x} + \\frac{1}{2}\\Sigma^2\\frac{\\partial^2 V}{\\partial x^2}\\right)dt\n$$\n因为 $\\mathbb{E}[dW_t]=0$。将此结果代回 DPP 近似式：\n$$\nV(t,x) \\approx \\inf_{a_t}\\left\\{ (x^2 Q + a_t^2 R)dt + V(t,x) + \\left(\\frac{\\partial V}{\\partial t} + (Ax+Ba_t)\\frac{\\partial V}{\\partial x} + \\frac{1}{2}\\Sigma^2\\frac{\\partial^2 V}{\\partial x^2}\\right)dt \\right\\}\n$$\n整理、除以 $dt$ 并取 $dt \\to 0$ 的极限，得到 HJB 方程：\n$$\n0 = \\frac{\\partial V}{\\partial t} + \\frac{1}{2}\\Sigma^2\\frac{\\partial^2 V}{\\partial x^2} + Qx^2 + \\inf_{a}\\left\\{ (Ax+Ba)\\frac{\\partial V}{\\partial x} + a^2 R \\right\\}\n$$\n为了找到最优控制 $a^*$，我们对括号内的项关于 $a$ 进行最小化。求导并令其为零：\n$$\n\\frac{\\partial}{\\partial a}\\left( Ba\\frac{\\partial V}{\\partial x} + a^2 R \\right) = B\\frac{\\partial V}{\\partial x} + 2aR = 0 \\implies a^* = -\\frac{B}{2R}\\frac{\\partial V}{\\partial x}\n$$\n将 $a^*$ 代回 HJB 方程：\n$$\n-\\frac{\\partial V}{\\partial t} = \\frac{1}{2}\\Sigma^2\\frac{\\partial^2 V}{\\partial x^2} + Ax\\frac{\\partial V}{\\partial x} + Qx^2 - \\frac{B^2}{4R}\\left(\\frac{\\partial V}{\\partial x}\\right)^2\n$$\n终端条件由最终代价项给出：$V(T,x) = Sx^2$。\n\n**使用二次型拟设求解 HJB 方程**\n\n线性动态和二次代价结构启发我们为价值函数做一个二次型拟设：\n$$\nV(t,x) = P(t)x^2 + q(t)\n$$\n相关的导数为：\n$$\n\\frac{\\partial V}{\\partial t} = P'(t)x^2 + q'(t), \\quad \\frac{\\partial V}{\\partial x} = 2P(t)x, \\quad \\frac{\\partial^2 V}{\\partial x^2} = 2P(t)\n$$\n将这些代入 HJB 方程：\n$$\n-(P'(t)x^2 + q'(t)) = \\frac{1}{2}\\Sigma^2(2P(t)) + Ax(2P(t)x) + Qx^2 - \\frac{B^2}{4R}(2P(t)x)^2\n$$\n$$\n-P'(t)x^2 - q'(t) = \\left(2AP(t) + Q - \\frac{B^2}{R}P(t)^2\\right)x^2 + \\Sigma^2 P(t)\n$$\n令 $x$ 的各次幂系数相等：\n- $x^2$ 的系数：$-P'(t) = 2AP(t) + Q - \\frac{B^2}{R}P(t)^2 \\implies P'(t) = -2AP(t) - Q + \\frac{B^2}{R}P(t)^2$\n- 常数项：$-q'(t) = \\Sigma^2 P(t) \\implies q'(t) = -\\Sigma^2 P(t)$\n\n终端条件 $P(T)=S$ 和 $q(T)=0$ 从 $V(T,x)=Sx^2$ 得到。\n\n**具体化与求解**\n\n我们使用具体参数：$A=0$, $B=1$, $\\Sigma=2$, $Q=0$, $R=1$, $S=1$。\n\n$P(t)$ 的常微分方程（ODE）成为一个黎卡提方程：\n$$\nP'(t) = -2(0)P(t) - 0 + \\frac{1^2}{1}P(t)^2 \\implies P'(t) = P(t)^2\n$$\n其终端条件为 $P(T)=1$。我们通过分离变量法求解，从 $T$ 向后积分：\n$$\n\\int_{P(t)}^{P(T)} \\frac{d\\tilde{P}}{\\tilde{P}^2} = \\int_t^T d\\tau \\implies \\left[-\\frac{1}{\\tilde{P}}\\right]_{P(t)}^{1} = T-t\n$$\n$$\n-1 - \\left(-\\frac{1}{P(t)}\\right) = T-t \\implies \\frac{1}{P(t)} = 1+T-t \\implies P(t) = \\frac{1}{1+T-t}\n$$\n$q(t)$ 的 ODE 为：\n$$\nq'(t) = -\\Sigma^2 P(t) = -4P(t) = -\\frac{4}{1+T-t}\n$$\n其终端条件为 $q(T)=0$。我们从 $t$ 积分到 $T$：\n$$\nq(T) - q(t) = \\int_t^T q'(\\tau)d\\tau \\implies 0 - q(t) = \\int_t^T \\left(-\\frac{4}{1+T-\\tau}\\right) d\\tau\n$$\n令 $u = 1+T-\\tau$，则 $du = -d\\tau$。积分上下限变为 $1+T-t$ 和 $1$。\n$$\n-q(t) = \\int_{1+T-t}^1 -\\frac{4}{u}(-du) = -4\\int_1^{1+T-t} \\frac{du}{u} = -4[\\ln(u)]_1^{1+T-t}\n$$\n$$\n-q(t) = -4(\\ln(1+T-t) - \\ln(1)) = -4\\ln(1+T-t)\n$$\n因此，$q(t) = 4\\ln(1+T-t)$。\n\n**最终答案计算**\n\n我们需要找到 $V(0, x_0)$。我们将 $t=0$ 和 $x=x_0$ 代入表达式 $V(t,x) = P(t)x^2 + q(t)$：\n$$\nV(0,x_0) = P(0)x_0^2 + q(0)\n$$\n计算 $t=0$ 时的系数：\n$$\nP(0) = \\frac{1}{1+T-0} = \\frac{1}{1+T}\n$$\n$$\nq(0) = 4\\ln(1+T-0) = 4\\ln(1+T)\n$$\n结合这些结果，得到初始时刻价值函数的最终表达式：\n$$\nV(0, x_0) = \\frac{x_0^2}{1+T} + 4\\ln(1+T)\n$$", "answer": "$$\n\\boxed{\\frac{x_{0}^{2}}{1+T} + 4\\ln(1+T)}\n$$", "id": "3051347"}, {"introduction": "动态规划不仅限于连续控制问题，它也是解决最优停时问题的主要工具。本实践练习将探讨一个来自数理金融的经典例子：为永久美式期权定价 [@problem_id:3051361]。您将看到动态规划原理如何引出一个自由边界问题，其目标是通过应用关键的“价值匹配”和“平滑粘贴”条件来找到最优执行边界。", "problem": "考虑一个连续时间下的一维永久美式看跌期权的最优停时问题。令 $\\{W_{t}\\}_{t \\geq 0}$ 为一个满足通常条件的带滤概率空间上的标准布朗运动。在风险中性测度下，一个支付股息的资产的价格过程 $\\{S_{t}\\}_{t \\geq 0}$ 服从几何布朗运动\n$$\n\\mathrm{d} S_{t} = (r - q) S_{t} \\,\\mathrm{d} t + \\sigma S_{t} \\,\\mathrm{d} W_{t},\n$$\n其中 $r > 0$ 是恒定的无风险利率，$q \\geq 0$ 是恒定的股息率，$\\sigma > 0$ 是恒定的波动率。令 $K > 0$ 为执行价格。定义价值函数\n$$\nV(s) = \\sup_{\\tau \\in \\mathcal{T}} \\mathbb{E}_{s}\\!\\left[ \\exp(- r \\tau) \\, (K - S_{\\tau})_{+} \\right],\n$$\n其中 $\\mathcal{T}$ 是关于 $\\{W_{t}\\}_{t \\geq 0}$ 的滤子的所有停时集合，$\\mathbb{E}_{s}[\\cdot]$ 表示在给定 $S_{0} = s$ 条件下的条件期望。\n\n仅使用动态规划原理和伊藤微积分为基础，推导刻画 $V(s)$ 的相关自由边界问题。证明最优停时区域是阈值类型的，即 $\\{ s \\leq s^{*} \\}$（对于某个 $s^{*} \\in (0, K)$），并通过求解自由边界问题（价值匹配和平滑粘贴），结合 $s$ 很大时的适当边界行为，完全确定 $s^{*}$。将您的最终结果表示为关于 $r$、$q$、$\\sigma$ 和 $K$ 的单一闭式解析表达式。不需要数值近似，也无需四舍五入。", "solution": "用户希望求解永久美式看跌期权的最优执行边界。\n\n### 步骤 1：问题验证\n\n该问题是量化金融和随机控制理论中一个经典且成熟的问题。\n\n**提取的已知条件：**\n- 资产价格过程 $\\{S_t\\}_{t \\geq 0}$ 在风险中性测度下服从几何布朗运动：$\\mathrm{d} S_{t} = (r - q) S_{t} \\,\\mathrm{d} t + \\sigma S_{t} \\,\\mathrm{d} W_{t}$。\n- $r > 0$：恒定无风险利率。\n- $q \\geq 0$：恒定股息率。\n- $\\sigma > 0$：恒定波动率。\n- $\\{W_t\\}_{t \\geq 0}$：标准布朗运动。\n- $K > 0$：执行价格。\n- 价值函数定义为 $V(s) = \\sup_{\\tau \\in \\mathcal{T}} \\mathbb{E}_{s}\\!\\left[ \\exp(- r \\tau) \\, (K - S_{\\tau})_{+} \\right]$，其中 $\\mathcal{T}$ 是所有停时的集合，$\\mathbb{E}_{s}[\\cdot]$ 是在 $S_0=s$ 条件下的期望。\n\n**验证结论：**\n该问题是**有效的**。它在科学上基于随机微分方程和期权定价理论，是适定的、客观的且自洽的。这是一个标准的教科书问题，可以使用所要求的方法（动态规划和伊藤微积分）来解决。\n\n### 步骤 2：求解推导\n\n这是一个最优停时问题。根据动态规划原理，资产价格的状态空间 $s \\in [0, \\infty)$ 可以划分为两个区域：一个是持有期权为最优选择的持有区域 $\\mathcal{C}$，另一个是执行期权为最优选择的停时区域 $\\mathcal{S}$。\n\n期权的价值 $V(s)$ 必须满足以下条件：\n1.  对所有 $s \\geq 0$，$V(s) \\geq (K-s)_{+}$。这是因为总可以选择立即执行。$(K-s)_{+}$ 是内在价值或支付函数。\n2.  在停时区域 $\\mathcal{S}$ 中，期权被执行，因此其价值等于支付：$V(s) = (K-s)_{+}$。\n3.  在持有区域 $\\mathcal{C}$ 中，执行期权不是最优选择。价值函数 $V(s)$ 必须满足 Hamilton-Jacobi-Bellman (HJB) 方程。对于永久期权，此方程不依赖于时间。贴现后的价值过程 $\\exp(-rt)V(S_t)$ 必须是一个上鞅，在持有区域内则是一个鞅。对 $\\exp(-rt)V(S_t)$ 应用伊藤公式并将漂移项设为零，得到 HJB 方程：\n    $$\n    \\frac{1}{2}\\sigma^2 s^2 \\frac{\\mathrm{d}^2 V}{\\mathrm{d}s^2} + (r-q)s \\frac{\\mathrm{d} V}{\\mathrm{d}s} - rV = 0\n    $$\n\n现在，我们来刻画停时区域和持有区域的特征。\n- 如果 $s \\geq K$，支付 $(K-s)_{+}$ 为 $0$。由于 $r>0$，货币具有时间价值，且未来 $S_t$ 跌至 $K$ 以下从而产生正支付的概率不为零。因此，当 $s \\geq K$ 时，执行期权永远不是最优选择。停时区域 $\\mathcal{S}$ 必须是 $[0, K)$ 的一个子集。\n- 当 $s \\to 0$ 时，股票变得一文不值，支付接近 $K$。此时显然应该执行期权。所以，$s=0$ 的一个邻域属于停时区域。\n- 当 $s \\to \\infty$ 时，期权处于深度价外状态。股价跌破 $K$ 的概率变得极小。因此，期权的价值应该趋近于零：$\\lim_{s \\to \\infty} V(s) = 0$。\n\n这些观察强烈表明停时区域是阈值类型的，即区间 $[0, s^*]$，其中 $s^*$ 是某个最优执行边界。那么持有区域就是 $(s^*, \\infty)$。我们必须有 $s^*  K$。\n\n现在问题转化为了一个由以下条件定义的自由边界问题：\n1.  在持有区域 $(s^*, \\infty)$ 内的常微分方程 (ODE)：\n    $$\n    \\frac{1}{2}\\sigma^2 s^2 V''(s) + (r-q)s V'(s) - rV(s) = 0 \\quad \\text{对于 } s  s^*\n    $$\n2.  无穷远处的边界条件：\n    $$\n    \\lim_{s \\to \\infty} V(s) = 0\n    $$\n3.  在自由边界 $s^*$ 处的价值匹配条件：\n    $$\n    V(s^*) = K - s^*\n    $$\n4.  在自由边界 $s^*$ 处的光滑粘贴（或平滑拟合）条件：\n    $$\n    V'(s^*) = -1\n    $$\n\n该 ODE 是一个柯西-欧拉方程。我们寻求形如 $V(s) = s^{\\gamma}$ 的解。将其代入 ODE，得到关于 $\\gamma$ 的特征二次方程：\n$$\n\\frac{1}{2}\\sigma^2 \\gamma(\\gamma-1) + (r-q)\\gamma - r = 0\n$$\n$$\n\\frac{1}{2}\\sigma^2 \\gamma^2 + (r - q - \\frac{1}{2}\\sigma^2)\\gamma - r = 0\n$$\n设其根为 $\\gamma_1$ 和 $\\gamma_2$。两根之积为 $\\gamma_1 \\gamma_2 = \\frac{-r}{\\frac{1}{2}\\sigma^2} = -\\frac{2r}{\\sigma^2}  0$。这意味着一个根是正的（$\\gamma_1  0$），另一个是负的（$\\gamma_2  0$）。\n该 ODE 的通解是 $V(s) = C_1 s^{\\gamma_1} + C_2 s^{\\gamma_2}$。\n\n应用无穷远处的边界条件 $\\lim_{s \\to \\infty} V(s) = 0$。因为 $\\gamma_1  0$，除非 $C_1=0$，否则当 $s \\to \\infty$ 时 $C_1 s^{\\gamma_1}$ 项会发散。而因为 $\\gamma_2  0$，当 $s \\to \\infty$ 时 $C_2 s^{\\gamma_2}$ 项会消失。因此，必须有 $C_1=0$。\n在持有区域的解具有以下形式：\n$$\nV(s) = C_2 s^{\\gamma_2} \\quad \\text{对于 } s  s^*\n$$\n现在，我们在自由边界 $s^*$ 处应用两个条件：\n1.  价值匹配：$C_2 (s^*)^{\\gamma_2} = K - s^*$\n2.  平滑粘贴：导数为 $V'(s) = C_2 \\gamma_2 s^{\\gamma_2-1}$。在 $s=s^*$ 处，我们有 $C_2 \\gamma_2 (s^*)^{\\gamma_2-1} = -1$。\n\n我们得到了一个关于两个未知数 $C_2$ 和 $s^*$ 的方程组。我们可以通过将第一个方程除以第二个方程来解出 $s^*$：\n$$\n\\frac{C_2 (s^*)^{\\gamma_2}}{C_2 \\gamma_2 (s^*)^{\\gamma_2-1}} = \\frac{K - s^*}{-1}\n$$\n$$\n\\frac{s^*}{\\gamma_2} = -(K - s^*)\n$$\n$$\ns^* = -\\gamma_2 (K - s^*) = -\\gamma_2 K + \\gamma_2 s^*\n$$\n$$\ns^*(1 - \\gamma_2) = -\\gamma_2 K\n$$\n$$\ns^* = \\frac{-\\gamma_2}{1 - \\gamma_2} K = \\frac{\\gamma_2}{\\gamma_2 - 1} K\n$$\n由于 $\\gamma_2  0$，因子 $\\frac{\\gamma_2}{\\gamma_2 - 1}$ 位于区间 $(0, 1)$ 内，这证实了 $0  s^*  K$。\n\n最后，我们需要负根 $\\gamma_2$ 的显式表达式。对特征方程使用二次求根公式：\n$$\n\\gamma = \\frac{-(r - q - \\frac{1}{2}\\sigma^2) \\pm \\sqrt{(r - q - \\frac{1}{2}\\sigma^2)^2 - 4(\\frac{1}{2}\\sigma^2)(-r)}}{\\sigma^2}\n$$\n负根 $\\gamma_2$ 是通过在分子中取负号得到的：\n$$\n\\gamma_2 = \\frac{-(r-q-\\frac{1}{2}\\sigma^2) - \\sqrt{(r-q-\\frac{1}{2}\\sigma^2)^2 + 2r\\sigma^2}}{\\sigma^2}\n$$\n将此代入 $s^*$ 的表达式中即可得到完整解。为了将最终答案表示为单个表达式，我们将 $\\gamma_2$ 代入 $s^*$ 的公式中。我们通过分子分母同乘以 $\\sigma^2$ 来简化分数 $\\frac{\\gamma_2}{\\gamma_2 - 1}$：\n$$\ns^* = K \\left( \\frac{\\sigma^2 \\gamma_2}{\\sigma^2 (\\gamma_2 - 1)} \\right) = K \\left( \\frac{\\sigma^2 \\gamma_2}{\\sigma^2 \\gamma_2 - \\sigma^2} \\right)\n$$\n令 $\\Omega = -(r-q-\\frac{1}{2}\\sigma^2) - \\sqrt{(r-q-\\frac{1}{2}\\sigma^2)^2 + 2r\\sigma^2}$。则 $\\sigma^2 \\gamma_2 = \\Omega$。\n$$\ns^* = K \\left( \\frac{\\Omega}{\\Omega - \\sigma^2} \\right)\n$$\n将 $\\Omega$ 代回：\n$$\ns^* = K \\left( \\frac{-(r-q-\\frac{1}{2}\\sigma^2) - \\sqrt{(r-q-\\frac{1}{2}\\sigma^2)^2 + 2r\\sigma^2}}{-(r-q-\\frac{1}{2}\\sigma^2) - \\sqrt{(r-q-\\frac{1}{2}\\sigma^2)^2 + 2r\\sigma^2} - \\sigma^2} \\right)\n$$\n分母简化为：\n$$\n-(r-q+\\frac{1}{2}\\sigma^2) - \\sqrt{(r-q-\\frac{1}{2}\\sigma^2)^2 + 2r\\sigma^2}\n$$\n这就得到了最优执行边界 $s^*$ 的最终闭式表达式。", "answer": "$$\n\\boxed{K \\left( \\frac{-(r-q-\\frac{1}{2}\\sigma^2) - \\sqrt{(r-q-\\frac{1}{2}\\sigma^2)^2 + 2r\\sigma^2}}{-(r-q+\\frac{1}{2}\\sigma^2) - \\sqrt{(r-q-\\frac{1}{2}\\sigma^2)^2 + 2r\\sigma^2}} \\right)}\n$$", "id": "3051361"}, {"introduction": "在前面的练习中，我们通过逐点最小化哈密顿量找到了最优控制。但是，为了使由此产生的反馈控制 $\\alpha^*(t,X_t)$ 在数学上是合理的，并且可以在随机微分方程中使用，它必须满足一定的正则性条件。这个问题 [@problem_id:3051402] 促使您批判性地思考这些技术要求，特别是博雷尔可测性（Borel measurability）的作用，以及为什么它是确保反馈定律可接纳的关键属性。", "problem": "考虑区间 $[0,T]$ 上的一个有限时域随机控制问题，其状态过程 $X^{\\alpha}$ 是以下受控随机微分方程的解\n$$\ndX^{\\alpha}_t \\;=\\; b\\!\\left(t,X^{\\alpha}_t,\\alpha_t\\right)\\,dt \\;+\\; \\sigma\\!\\left(t,X^{\\alpha}_t,\\alpha_t\\right)\\,dW_t,\\qquad t\\in[s,T],\\qquad X^{\\alpha}_s=x,\n$$\n其中 $W$ 是一个满足通常条件的带滤概率空间上的 $d$ 维维纳过程（标准布朗运动），控制 $\\alpha$ 在一个紧度量作用集 $A$ 中取值，并且关于由 $W$ 生成的滤子是循序可测的。性能准则为\n$$\nJ^{\\alpha}(s,x)\\;=\\;\\mathbb{E}\\!\\left[\\int_s^T f\\!\\left(t,X^{\\alpha}_t,\\alpha_t\\right)\\,dt \\;+\\; g\\!\\left(X^{\\alpha}_T\\right)\\right],\n$$\n对于给定的终端成本 $g$ 和运行成本 $f$。假设数据满足以下条件：函数 $b$、$\\sigma$ 和 $f$ 关于 $(t,x)$ 是 Borel 可测的，对于每个 $(t,x)$ 关于 $a\\in A$ 是连续的，并且关于 $x$ 满足局部 Lipschitz 条件和线性增长条件，这些条件对 $a\\in A$ 一致成立，从而使得随机微分方程对于容许控制是适定的，且成本是有限的。\n\n假设值函数\n$$\nv(s,x)\\;=\\;\\inf_{\\alpha}\\,J^{\\alpha}(s,x)\n$$\n是充分光滑的，具体来说 $v\\in C^{1,2}([0,T]\\times\\mathbb{R}^d)$，因此动态规划原理 (DPP) 蕴含 $v$ 是 Hamilton–Jacobi–Bellman (HJB) 方程的古典解\n$$\n-\\,\\partial_t v(t,x)\\;=\\;\\inf_{a\\in A}\\Big\\{ f(t,x,a)\\;+\\; b(t,x,a)\\cdot Dv(t,x)\\;+\\;\\tfrac{1}{2}\\,\\mathrm{tr}\\!\\big(\\sigma\\sigma^{\\top}(t,x,a)\\,D^2v(t,x)\\big)\\Big\\},\n$$\n并满足终端条件 $v(T,x)=g(x)$。定义哈密顿量\n$$\nH(t,x,p,M,a)\\;=\\; f(t,x,a)\\;+\\; b(t,x,a)\\cdot p\\;+\\;\\tfrac{1}{2}\\,\\mathrm{tr}\\!\\big(\\sigma\\sigma^{\\top}(t,x,a)\\,M\\big).\n$$\n\n你的任务是确定哪个陈述正确描述了如何通过最小化哈密顿量来构造一个候选最优反馈控制 $\\alpha^*(t,x)$，以及为了使反馈控制过程 $\\alpha^*_t=\\alpha^*(t,X^{\\alpha^*}_t)$ 是容许的且与动态规划原理兼容，对 $\\alpha^*$ 的可测性性质的最低要求是什么。\n\n选择唯一的最佳选项。\n\nA. 在给定的正则性和紧性假设下，对每个 $(t,x)$ 都存在 $a\\mapsto H\\big(t,x,Dv(t,x),D^2v(t,x),a\\big)$ 的一个最小化子，并且可以选择一个 Borel 可测选择 $\\alpha^*:[0,T]\\times\\mathbb{R}^d\\to A$ 使得\n$$\n\\alpha^*(t,x)\\in\\operatorname*{arg\\,min}_{a\\in A}H\\big(t,x,Dv(t,x),D^2v(t,x),a\\big)\\quad\\text{对所有 }(t,x)\\text{ 成立}.\n$$\n那么 $\\alpha^*_t=\\alpha^*(t,X^{\\alpha^*}_t)$ 是循序可测的，因为 $(t,X^{\\alpha^*}_t)$ 是循序可测的且 $\\alpha^*$ 是 Borel 可测的。如果 $\\alpha^*$ 还服从从 $H$ 的最小化子继承的线性增长界，则此反馈是容许的。\n\nB. 对 $a\\mapsto H\\big(t,x,Dv(t,x),D^2v(t,x),a\\big)$ 的逐点最小化为每个 $(t,x)$ 产生某个选择 $\\alpha^*(t,x)$，而 $\\alpha^*$ 不需要具有可测性，因为随机微分方程在每个时刻仅依赖于 $\\alpha^*_t=\\alpha^*(t,X^{\\alpha^*}_t)$，而这是逐点确定的。\n\nC. 选择 $\\alpha^*(t,x)$ 必须在 $(t,x)$ 上连续；Borel 可测性不足以保证 $\\alpha^*_t=\\alpha^*(t,X^{\\alpha^*}_t)$ 是循序可测的，因此仅有 Borel 可测性的选择不能用于定义容许反馈。\n\nD. 如果映射 $a\\mapsto H\\big(t,x,Dv(t,x),D^2v(t,x),a\\big)$ 对每个 $(t,x)$ 都是严格凸的，那么在每个 $(t,x)$ 处最小化子的唯一性自动保证了 $\\alpha^*(t,x)$ 关于 $(t,x)$ 是可测的，因此不需要单独的可测性论证来确保容许性。\n\nE. 反馈控制可以采用通用形式 $\\alpha^*(t,x)=-\\,Dv(t,x)$，而无需考虑系数 $b$ 和 $\\sigma$，并且由于 $v\\in C^{1,2}$，这立即意味着 $\\alpha^*$ 是可测的和容许的。", "solution": "用户希望我扮演一名 STEM 教授，解决一个关于在随机最优控制设置中构造最优反馈控制的问题。\n\n### 第 1 步：提取已知条件\n\n问题提供了以下信息：\n- 区间 $[0,T]$ 上的一个受控随机微分方程 (SDE)：\n$$\ndX^{\\alpha}_t \\;=\\; b\\!\\left(t,X^{\\alpha}_t,\\alpha_t\\right)\\,dt \\;+\\; \\sigma\\!\\left(t,X^{\\alpha}_t,\\alpha_t\\right)\\,dW_t,\\qquad t\\in[s,T],\\qquad X^{\\alpha}_s=x\n$$\n- $W$ 是一个 $d$ 维维纳过程。\n- 控制 $\\alpha$ 是在紧度量作用集 $A$ 中取值 $\\alpha_t$ 的过程。\n- 容许控制 $\\alpha$ 是关于由 $W$ 生成的滤子循序可测的。\n- 要最小化的性能准则（成本泛函）是：\n$$\nJ^{\\alpha}(s,x)\\;=\\;\\mathbb{E}\\!\\left[\\int_s^T f\\!\\left(t,X^{\\alpha}_t,\\alpha_t\\right)\\,dt \\;+\\; g\\!\\left(X^{\\alpha}_T\\right)\\right]\n$$\n- 函数 $b$、$\\sigma$ 和 $f$ 关于 $(t,x)$ 是 Borel 可测的，对每个 $(t,x)$ 关于 $a\\in A$ 是连续的，并且关于 $x$ 满足局部 Lipschitz 条件和线性增长条件，这些条件对 $a\\in A$ 一致成立。\n- 值函数是 $v(s,x) = \\inf_{\\alpha} J^{\\alpha}(s,x)$。\n- 假设值函数是光滑的：$v \\in C^{1,2}([0,T]\\times\\mathbb{R}^d)$。\n- 值函数 $v$ 是 Hamilton-Jacobi-Bellman (HJB) 方程的古典解：\n$$\n-\\,\\partial_t v(t,x)\\;=\\;\\inf_{a\\in A}\\Big\\{ f(t,x,a)\\;+\\; b(t,x,a)\\cdot Dv(t,x)\\;+\\;\\tfrac{1}{2}\\,\\mathrm{tr}\\!\\big(\\sigma\\sigma^{\\top}(t,x,a)\\,D^2v(t,x)\\big)\\Big\\}\n$$\n并满足终端条件 $v(T,x)=g(x)$。\n- 哈密顿量定义为：\n$$\nH(t,x,p,M,a)\\;=\\; f(t,x,a)\\;+\\; b(t,x,a)\\cdot p\\;+\\;\\tfrac{1}{2}\\,\\mathrm{tr}\\!\\big(\\sigma\\sigma^{\\top}(t,x,a)\\,M\\big)\n$$\n- **任务**：确定关于构造候选最优反馈控制 $\\alpha^*(t,x)$ 及其容许性所需的可测性性质的正确陈述。\n\n### 第 2 步：使用提取的已知条件进行验证\n\n问题陈述描述了扩散过程随机最优控制理论中的一个标准设置。\n- **科学依据**：该问题完全基于随机控制理论中已建立的数学原理，包括受控 SDE、动态规划原理和 Hamilton-Jacobi-Bellman 方程。所有概念都是标准的且定义明确。\n- **适定性**：该问题询问最优反馈控制的性质，这是随机控制验证定理中的一个核心问题。对系数（$b$、$\\sigma$、$f$）和值函数（$v \\in C^{1,2}$）的假设虽然强，但在建立“古典”理论时是标准的，确保了问题在此框架内是可解的并有明确的答案。\n- **客观性**：该问题以精确的数学语言陈述，没有歧义或主观内容。\n\n该问题没有违反任何无效性标准。这是一个在数学控制理论中表述良好的问题。所提供的假设是标准的且内部一致。\n\n### 第 3 步：结论与行动\n\n问题陈述是有效的。我将继续推导解答并评估各个选项。\n\n### 解答推导\n\nHamilton-Jacobi-Bellman (HJB) 方程为最优性提供了一个必要条件，并在适当的条件下（“验证定理”）成为充分条件。该方程为\n$$\n-\\,\\partial_t v(t,x) = \\inf_{a\\in A} H\\big(t,x,Dv(t,x),D^2v(t,x),a\\big)\n$$\n最优控制的一个候选者是反馈（或马尔可夫）控制律 $\\alpha^*(t,x)$，它对每个状态 $(t,x)$ 都能在 HJB 方程中达到下确界。即，\n$$\n\\alpha^*(t,x) \\in \\operatorname*{arg\\,min}_{a \\in A} H\\big(t,x,Dv(t,x),D^2v(t,x),a\\big) \\quad \\text{对所有 } (t,x) \\in [0,T] \\times \\mathbb{R}^d.\n$$\n一旦找到这样的函数 $\\alpha^*(t,x)$，候选的最优控制过程就是 $\\alpha^*_t = \\alpha^*(t, X^*_t)$，其中 $X^*$ 是将此控制代入后 SDE 的解：\n$$\ndX^*_t = b(t,X^*_t,\\alpha^*(t,X^*_t))\\,dt + \\sigma(t,X^*_t,\\alpha^*(t,X^*_t))\\,dW_t.\n$$\n为了使这个方案是适定的，并且得到的控制过程 $\\alpha^*_t$ 是容许的，必须解决几个技术要点。\n\n1.  **最小化子的存在性**：对于任何固定的 $(t,x) \\in [0,T] \\times \\mathbb{R}^d$，我们需要确保最小化子集合 $\\operatorname*{arg\\,min}_{a \\in A} H(\\dots,a)$ 非空。令 $p = Dv(t,x)$ 和 $M = D^2v(t,x)$，由于 $v \\in C^{1,2}$，它们是良定义的。问题陈述函数 $f(t,x,a)$、$b(t,x,a)$ 和 $\\sigma(t,x,a)$ 对每个固定的 $(t,x)$ 关于 $a$ 是连续的。因此，哈密顿量 $H(t,x,p,M,a)$ 也是关于 $a$ 的连续函数。由于控制集 $A$ 假设为紧度量空间，极值定理 (Weierstrass) 保证了连续函数 $a \\mapsto H(t,x,p,M,a)$ 在 $A$ 上达到其最小值。因此，对每个 $(t,x)$，最小化子存在。\n\n2.  **选择的可测性**：对每个 $(t,x)$ 存在一个最小化子是不够的。我们需要能够为每个 $(t,x)$ 选择一个最小化子 $\\alpha^*(t,x)$，使得得到的函数 $\\alpha^*: [0,T] \\times \\mathbb{R}^d \\to A$ 是可测的（具体来说，是 Borel 可测的）。这是必需的，以便复合过程 $\\alpha^*(t, X^*_t)$ 在随机积分的背景下是良定义的。这种可测函数的存在性不是自动的，而是由一类被称为“可测选择定理”的结果保证。一个标准版本（如 Kuratowski and Ryll-Nardzewski 选择定理）在此适用。所需的条件是待最小化的函数 $(t,x,a) \\mapsto H(t,x,Dv(t,x),D^2v(t,x),a)$ 是一个 Carathéodory 函数：对于固定的 $a$，它关于 $(t,x)$ 是可测的；对于固定的 $(t,x)$，它关于 $a$ 是连续的。\n    - 问题陈述 $b$、$\\sigma$ 和 $f$ 关于 $(t,x)$ 是 Borel 可测的，关于 $a$ 是连续的。\n    - 值函数 $v$ 假设在 $C^{1,2}$ 中，这意味着其导数 $Dv(t,x)$ 和 $D^2v(t,x)$ 是 $(t,x)$ 的连续函数，因此是 Borel 可测的。\n    - 由于 Borel 可测函数的乘积和总和是 Borel 可测的，映射 $(t,x) \\mapsto H(t,x,Dv(t,x),D^2v(t,x),a)$ 对每个固定的 $a$ 都是 Borel 可测的。\n    - 可测选择定理的条件得到满足。因此，存在一个 Borel 可测函数 $\\alpha^*: [0,T]\\times\\mathbb{R}^d\\to A$，它是哈密顿量的逐点最小化子。\n\n3.  **反馈控制过程的容许性**：容许控制过程必须是循序可测的。候选过程是 $\\alpha^*_t = \\alpha^*(t,X^*_t)$。SDE 的解 $X^*_t$ 是一个连续的适应过程。随机过程中的一个标准结果指出，一个连续的适应过程是循序可测的。这意味着过程 $(t, \\omega) \\mapsto (t, X^*_t(\\omega))$ 是从 $([0,T]\\times\\Omega, \\mathcal{P})$ 到 $([0,T]\\times\\mathbb{R}^d, \\mathcal{B}([0,T]\\times\\mathbb{R}^d))$ 的循序可测过程，其中 $\\mathcal{P}$ 是循序 $\\sigma$-代数。由于一个循序可测过程的 Borel 可测函数本身也是循序可测的，并且我们已经确定存在一个 Borel 可测选择 $\\alpha^*$，因此复合过程 $\\alpha^*_t = \\alpha^*(t,X^*_t)$ 是循序可测的。这确保了涉及 $\\alpha^*_t$ 的随机积分是良定义的。\n\n4.  **SDE的适定性**：反馈 SDE 要求系数 $t \\mapsto b(t, X^*_t, \\alpha^*(t,X^*_t))$ 和 $t \\mapsto \\sigma(t, X^*_t, \\alpha^*(t,X^*_t))$ 满足保证解的存在唯一性的条件（例如，状态变量的局部 Lipschitz 和线性增长条件）。问题陈述包含一个强假设，即 $b$、$\\sigma$（和 $f$）“关于 $x$ 满足局部 Lipschitz 条件和线性增长条件，这些条件对 $a\\in A$ 一致成立”。这意味着 Lipschitz 和增长常数与 $a$ 无关。因此，对于任何可测选择 $\\alpha^*(t,x)$，得到的复合系数 $x \\mapsto b(t,x,\\alpha^*(t,x))$ 和 $x \\mapsto \\sigma(t,x,\\alpha^*(t,x))$ 自动满足这些条件。这确保了 $X^*$ 的 SDE 是适定的。\n\n### 逐项分析选项\n\n**A. 在给定的正则性和紧性假设下，对每个 $(t,x)$ 都存在 $a\\mapsto H\\big(t,x,Dv(t,x),D^2v(t,x),a\\big)$ 的一个最小化子，并且可以选择一个 Borel 可测选择 $\\alpha^*:[0,T]\\times\\mathbb{R}^d\\to A$ 使得... 成立。那么 $\\alpha^*_t=\\alpha^*(t,X^{\\alpha^*}_t)$ 是循序可测的，因为 $(t,X^{\\alpha^*}_t)$ 是循序可测的且 $\\alpha^*$ 是 Borel 可测的。如果 $\\alpha^*$ 还服从从 $H$ 的最小化子继承的线性增长界，则此反馈是容许的。**\n\n这个陈述准确地遵循了上面详述的推理路线。\n- 最小化子的存在性：正确，因为 $H$ 在 $a$ 上连续且 $A$ 是紧集。\n- Borel 可测选择的存在性：正确，通过可测选择定理。\n- 反馈过程的循序可测性：正确，因为它是循序可测过程的 Borel 函数。\n- 容许性条件：关于线性增长界的最后一句，考虑到问题对 $a$ 一致性的假设，有点多余，但它正确地指出了 SDE 系数需要满足这类界才能使 SDE 适定，这是容许性的一个组成部分。这个陈述是对该过程最完整和正确的描述。\n**结论：正确**\n\n**B. 对 $a\\mapsto H\\big(t,x,Dv(t,x),D^2v(t,x),a\\big)$ 的逐点最小化为每个 $(t,x)$ 产生某个选择 $\\alpha^*(t,x)$，而 $\\alpha^*$ 不需要具有可测性，因为随机微分方程在每个时刻仅依赖于 $\\alpha^*_t=\\alpha^*(t,X^{\\alpha^*}_t)$，而这是逐点确定的。**\n\n这个陈述有根本性的缺陷。可测性是一个过程能成为随机积分（如 Itô 积分）中被积函数的前提条件。如果 $\\alpha^*(t,x)$ 不是一个可测函数，过程 $\\alpha^*_t = \\alpha^*(t,X^*_t)$ 可能不是循序可测的，那么项 $\\int_s^t \\sigma(u,X^*_u,\\alpha^*_u)dW_u$ 可能无定义。整个 SDE 理论都建立在可测性假设之上。\n**结论：不正确**\n\n**C. 选择 $\\alpha^*(t,x)$ 必须在 $(t,x)$ 上连续；Borel 可测性不足以保证 $\\alpha^*_t=\\alpha^*(t,X^{\\alpha^*}_t)$ 是循序可测的，因此仅有 Borel 可测性的选择不能用于定义容许反馈。**\n\n这个陈述包含两个错误。首先，选择 $\\alpha^*(t,x)$ 的连续性是可测性的一个充分条件，但绝不是必要的。最优控制常常是不连续的。其次，“Borel 可测性不足够”的说法是错误的。如主推导中所解释，一个循序可测过程（如 $(t,X^*_t)$）的 Borel 可测函数确实是循序可测的。这是随机微积分中的一个标准结果。\n**结论：不正确**\n\n**D. 如果映射 $a\\mapsto H\\big(t,x,Dv(t,x),D^2v(t,x),a\\big)$ 对每个 $(t,x)$ 都是严格凸的，那么在每个 $(t,x)$ 处最小化子的唯一性自动保证了 $\\alpha^*(t,x)$ 关于 $(t,x)$ 是可测的，因此不需要单独的可测性论证来确保容许性。**\n\n这是一个微妙但不正确的观点。在定义域的每个点上最小化子的唯一性本身并不能保证将每个点映射到其唯一最小化子的函数是可测的。人们可以利用非可测集构造反例，其中一个函数对每个参数值都有唯一的最小化子，但得到的选择函数是不可测的。可测性必须通过其他方式来建立，例如选项 A 分析中提到的可测选择定理。\n**结论：不正确**\n\n**E. 反馈控制可以采用通用形式 $\\alpha^*(t,x)=-\\,Dv(t,x)$，而无需考虑系数 $b$ 和 $\\sigma$，并且由于 $v\\in C^{1,2}$，这立即意味着 $\\alpha^*$ 是可测的和容许的。**\n\n这个陈述明显是错误的。最优控制 $\\alpha^*(t,x)$ 的形式由哈密顿量的最小化决定，因此明确地依赖于成本 $f$ 和动态系数 $b$ 和 $\\sigma$ 的函数形式。形式 $\\alpha^*(t,x)=-\\,Dv(t,x)$ 仅在非常特殊的情况下出现（例如，控制线性进入漂移项且控制有二次成本的线性二次问题）。声称这种形式是“通用的”并且“无需考虑系数”是一种严重的过度概括。\n**结论：不正确**\n\n基于详细的分析，选项 A 提供了关于最优反馈控制的构造和性质的唯一正确且完整的描述。", "answer": "$$\\boxed{A}$$", "id": "3051402"}]}