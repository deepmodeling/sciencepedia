{"hands_on_practices": [{"introduction": "本练习将通过一个具体的数值示例，引导您完成卡尔曼滤波中最核心的步骤：测量更新。通过亲手计算在获得新息后状态的后验均值和方差，您将直观地理解滤波器是如何融合新数据以修正状态估计并减小不确定性的 [@problem_id:3053885]。这个过程是高斯变量贝叶斯推断的直接应用，是掌握滤波理论的基石。", "problem": "考虑离散时间线性高斯状态空间模型\n$$x_{k+1} = A x_k + w_k,\\qquad y_k = C x_k + v_k,$$\n其中 $w_k \\sim \\mathcal{N}(0,Q)$ 和 $v_k \\sim \\mathcal{N}(0,R)$ 相互独立，且与初始状态无关。在时间 $k=0$ 时，给定状态的先验（预测）为 $x_0 \\sim \\mathcal{N}(m_0, P_0)$，然后观测到单个测量值 $y_0$。模型参数为\n$$A = 0.7,\\quad C = 1.2,\\quad Q = 0.09,\\quad R = 0.16,$$\n在时间 $k=0$ 时的先验为\n$$m_0 = 1.5,\\quad P_0 = 0.5,$$\n观测值为\n$$y_0 = 2.0.$$\n使用联合高斯变量条件估计的基本原理以及模型所蕴含的最优线性最小均方误差（LMMSE）更新，计算观测到 $y_0$ 后 $x_0$ 的后验均值 $m_0^{+}$ 和后验方差 $P_0^{+}$。将您的最终数值答案表示为单行矩阵 $\\big[m_0^{+},\\,P_0^{+}\\big]$ 的精确形式（无四舍五入）。", "solution": "该问题要求我们计算在时间 $k=0$ 观测到单个测量值 $y_0$ 后的条件均值 $\\mathbb{E}[x_0 | y_0]$ 和条件方差 $\\mathrm{Var}(x_0 | y_0)$。它们分别是后验均值 $m_0^{+}$ 和后验方差 $P_0^{+}$。由于 $x_0$ 的先验分布是高斯的，且观测值 $y_0$ 是 $x_0$ 的线性函数加上高斯噪声，因此状态 $x_0$ 和观测值 $y_0$ 是联合高斯的。\n\n我们定义随机向量 $\\begin{pmatrix} x_0 \\\\ y_0 \\end{pmatrix}$。我们首先求出其均值和协方差矩阵。\n\n$x_0$ 的均值给定为 $\\mathbb{E}[x_0] = m_0$。\n$y_0$ 的均值由测量方程导出：\n$$\\mathbb{E}[y_0] = \\mathbb{E}[C x_0 + v_0] = C \\mathbb{E}[x_0] + \\mathbb{E}[v_0]$$\n由于 $v_0 \\sim \\mathcal{N}(0,R)$，我们有 $\\mathbb{E}[v_0] = 0$。因此，\n$$\\mathbb{E}[y_0] = C m_0$$\n$\\begin{pmatrix} x_0 \\\\ y_0 \\end{pmatrix}$ 的均值向量为：\n$$\\mu = \\mathbb{E}\\begin{pmatrix} x_0 \\\\ y_0 \\end{pmatrix} = \\begin{pmatrix} m_0 \\\\ C m_0 \\end{pmatrix}$$\n\n接下来，我们计算协方差矩阵 $\\Sigma = \\mathrm{Cov}\\left(\\begin{pmatrix} x_0 \\\\ y_0 \\end{pmatrix}\\right) = \\begin{pmatrix} \\Sigma_{11} & \\Sigma_{12} \\\\ \\Sigma_{21} & \\Sigma_{22} \\end{pmatrix}$。其分量为：\n- $\\Sigma_{11} = \\mathrm{Var}(x_0) = P_0$。\n- $\\Sigma_{12} = \\mathrm{Cov}(x_0, y_0) = \\mathbb{E}[(x_0 - m_0)(y_0 - C m_0)] = \\mathbb{E}[(x_0 - m_0)(C x_0 + v_0 - C m_0)] = \\mathbb{E}[(x_0 - m_0)(C(x_0 - m_0) + v_0)]$。\n展开此式得到 $C \\mathbb{E}[(x_0 - m_0)^2] + \\mathbb{E}[(x_0 - m_0)v_0] = C \\mathrm{Var}(x_0) + 0$，因为 $x_0$ 和 $v_0$ 是独立的。所以，$\\Sigma_{12} = C P_0$。\n- $\\Sigma_{21} = \\mathrm{Cov}(y_0, x_0) = \\Sigma_{12}^T$。由于这些都是标量，$\\Sigma_{21} = C P_0$。\n- $\\Sigma_{22} = \\mathrm{Var}(y_0) = \\mathrm{Var}(C x_0 + v_0)$。由于 $x_0$ 和 $v_0$ 独立，方差相加：$\\mathrm{Var}(C x_0) + \\mathrm{Var}(v_0) = C^2 \\mathrm{Var}(x_0) + R = C^2 P_0 + R$。\n\n所以联合分布为：\n$$\\begin{pmatrix} x_0 \\\\ y_0 \\end{pmatrix} \\sim \\mathcal{N}\\left( \\begin{pmatrix} m_0 \\\\ C m_0 \\end{pmatrix}, \\begin{pmatrix} P_0 & C P_0 \\\\ C P_0 & C^2 P_0 + R \\end{pmatrix} \\right)$$\n\n对于一个一般的联合高斯向量 $\\begin{pmatrix} X_1 \\\\ X_2 \\end{pmatrix} \\sim \\mathcal{N}\\left(\\begin{pmatrix} \\mu_1 \\\\ \\mu_2 \\end{pmatrix}, \\begin{pmatrix} \\Sigma_{11} & \\Sigma_{12} \\\\ \\Sigma_{21} & \\Sigma_{22} \\end{pmatrix}\\right)$，给定 $X_2=x_2$ 时 $X_1$ 的条件分布是高斯分布，其均值和方差为：\n$$\\mu_{1|2} = \\mu_1 + \\Sigma_{12} \\Sigma_{22}^{-1} (x_2 - \\mu_2)$$\n$$\\Sigma_{11|2} = \\Sigma_{11} - \\Sigma_{12} \\Sigma_{22}^{-1} \\Sigma_{21}$$\n\n将此应用于我们的问题，我们认定 $X_1 \\to x_0$，$X_2 \\to y_0$，以及 $x_2 \\to y_0$。后验均值 $m_0^{+}$ 和方差 $P_0^{+}$ 为：\n$$m_0^{+} = \\mathbb{E}[x_0|y_0] = m_0 + (C P_0) (C^2 P_0 + R)^{-1} (y_0 - C m_0)$$\n$$P_0^{+} = \\mathrm{Var}(x_0|y_0) = P_0 - (C P_0) (C^2 P_0 + R)^{-1} (C P_0)$$\n这些是卡尔曼滤波器的标准测量更新方程。\n\n现在我们代入给定的数值，使用精确的分数形式以避免舍入误差。\n$C = 1.2 = \\frac{12}{10} = \\frac{6}{5}$\n$R = 0.16 = \\frac{16}{100} = \\frac{4}{25}$\n$m_0 = 1.5 = \\frac{3}{2}$\n$P_0 = 0.5 = \\frac{1}{2}$\n$y_0 = 2.0 = 2$\n\n首先，我们计算 $(C^2 P_0 + R)$ 项，即新息协方差，通常表示为 $S_0$。\n$$S_0 = C^2 P_0 + R = \\left(\\frac{6}{5}\\right)^2 \\left(\\frac{1}{2}\\right) + \\frac{4}{25} = \\frac{36}{25} \\cdot \\frac{1}{2} + \\frac{4}{25} = \\frac{18}{25} + \\frac{4}{25} = \\frac{22}{25}$$\n\n现在，我们可以计算后验方差 $P_0^{+}$：\n$$P_0^{+} = P_0 - (C P_0) S_0^{-1} (C P_0) = P_0 - \\frac{(C P_0)^2}{S_0}$$\n$$C P_0 = \\frac{6}{5} \\cdot \\frac{1}{2} = \\frac{3}{5}$$\n$$P_0^{+} = \\frac{1}{2} - \\frac{(\\frac{3}{5})^2}{\\frac{22}{25}} = \\frac{1}{2} - \\frac{\\frac{9}{25}}{\\frac{22}{25}} = \\frac{1}{2} - \\frac{9}{22} = \\frac{11}{22} - \\frac{9}{22} = \\frac{2}{22} = \\frac{1}{11}$$\n\n接下来，我们计算后验均值 $m_0^{+}$。\n项 $(y_0 - C m_0)$ 是新息或测量残差。\n$$C m_0 = \\frac{6}{5} \\cdot \\frac{3}{2} = \\frac{9}{5}$$\n$$y_0 - C m_0 = 2 - \\frac{9}{5} = \\frac{10}{5} - \\frac{9}{5} = \\frac{1}{5}$$\n现在我们可以计算 $m_0^{+}$：\n$$m_0^{+} = m_0 + (C P_0) S_0^{-1} (y_0 - C m_0)$$\n$$m_0^{+} = \\frac{3}{2} + \\left(\\frac{3}{5}\\right) \\left(\\frac{22}{25}\\right)^{-1} \\left(\\frac{1}{5}\\right) = \\frac{3}{2} + \\left(\\frac{3}{5}\\right) \\left(\\frac{25}{22}\\right) \\left(\\frac{1}{5}\\right)$$\n$$m_0^{+} = \\frac{3}{2} + \\frac{3 \\cdot 25 \\cdot 1}{5 \\cdot 22 \\cdot 5} = \\frac{3}{2} + \\frac{3 \\cdot (5 \\cdot 5)}{(5 \\cdot 5) \\cdot 22} = \\frac{3}{2} + \\frac{3}{22}$$\n$$m_0^{+} = \\frac{3 \\cdot 11}{2 \\cdot 11} + \\frac{3}{22} = \\frac{33}{22} + \\frac{3}{22} = \\frac{36}{22} = \\frac{18}{11}$$\n\n后验均值为 $m_0^{+} = \\frac{18}{11}$，后验方差为 $P_0^{+} = \\frac{1}{11}$。", "answer": "$$\n\\boxed{\n\\begin{bmatrix}\n\\frac{18}{11} & \\frac{1}{11}\n\\end{bmatrix}\n}\n$$", "id": "3053885"}, {"introduction": "这个练习将带您从单步更新深入到滤波器的长期稳态行为，并将其与系统的基本属性联系起来。您将首先检验系统的可观测性——这是成功估计所有状态的关键前提——然后求解代数Riccati方程以找到滤波器的稳态误差协方差 [@problem_id:3053882]。这个过程将揭示一个深刻的联系：系统的内在结构如何决定了滤波器最终所能达到的最优性能。", "problem": "考虑一个由状态的随机微分方程（SDE）和测量模型控制的连续时间线性随机系统\n$$\n\\mathrm{d}x(t) = A\\,x(t)\\,\\mathrm{d}t + \\mathrm{d}w(t), \\quad \\mathrm{d}y(t) = C\\,x(t)\\,\\mathrm{d}t + \\mathrm{d}v(t),\n$$\n其中 $A \\in \\mathbb{R}^{2 \\times 2}$ 和 $C \\in \\mathbb{R}^{1 \\times 2}$ 由下式给出\n$$\nA = \\begin{pmatrix} -1 & 0 \\\\ 0 & -2 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}.\n$$\n假设过程噪声 $w(t)$ 和测量噪声 $v(t)$ 是独立的标准维纳过程，其协方差为\n$$\nQ = I_2 \\quad \\text{和} \\quad R = 1,\n$$\n其中 $I_2$ 表示 $2 \\times 2$ 单位矩阵。从线性时不变系统的可观测性基本定义以及用于连续时间滤波（卡尔曼-布西滤波）的成熟的稳态代数黎卡提方程出发，完成以下任务：\n\n1. 使用由 $A$ 和 $C$ 构造的可观测性矩阵的秩来检验矩阵对 $(A,C)$ 的可观测性。\n\n2. 使用用于估计误差协方差的稳态代数黎卡提方程，\n$$\nA P + P A^{\\top} - P C^{\\top} R^{-1} C P + Q = 0,\n$$\n在假设 $P$ 是对称半正定矩阵的条件下，求解稳态误差协方差矩阵 $P \\in \\mathbb{R}^{2 \\times 2}$。然后确定得到的 $P$ 是否为正定矩阵。\n\n请给出稳态解 $P$ 的行列式作为最终数值答案。无需四舍五入。最终答案中不要包含任何单位。", "solution": "该问题要求对一个连续时间线性随机系统进行两部分分析。首先，我们必须检验系统的可观测性；其次，我们必须求解稳态估计误差协方差矩阵 $P$ 并求其行列式。\n\n第一部分：可观测性分析\n\n系统由状态方程和测量方程描述：\n$$\n\\mathrm{d}x(t) = A\\,x(t)\\,\\mathrm{d}t + \\mathrm{d}w(t), \\quad \\mathrm{d}y(t) = C\\,x(t)\\,\\mathrm{d}t + \\mathrm{d}v(t)\n$$\n矩阵为 $A = \\begin{pmatrix} -1 & 0 \\\\ 0 & -2 \\end{pmatrix}$ 和 $C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$。\n状态维数为 $n=2$。矩阵对 $(A, C)$ 的可观测性由可观测性矩阵 $\\mathcal{O}$ 的秩决定。对于二阶系统，可观测性矩阵定义为：\n$$\n\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix}\n$$\n我们首先计算乘积 $CA$：\n$$\nCA = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} -1 & 0 \\\\ 0 & -2 \\end{pmatrix} = \\begin{pmatrix} (1)(-1) + (0)(0) & (1)(0) + (0)(-2) \\end{pmatrix} = \\begin{pmatrix} -1 & 0 \\end{pmatrix}\n$$\n现在，我们构造可观测性矩阵 $\\mathcal{O}$：\n$$\n\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ -1 & 0 \\end{pmatrix}\n$$\n矩阵的秩是线性无关的行或列的最大数目。$\\mathcal{O}$ 的第二行是第一行的 $(-1)$ 倍，因此这两行是线性相关的。因此，$\\mathcal{O}$ 的秩为 $1$。\n一个系统是完全可观测的，当且仅当其可观测性矩阵的秩等于状态向量的维数 $n$。这里，$\\mathrm{rank}(\\mathcal{O}) = 1$，小于状态维数 $n=2$。因此，矩阵对 $(A, C)$ 是不可观测的。\n\n第二部分：稳态代数黎卡提方程\n\n题目要求我们求解误差协方差矩阵 $P$ 的稳态代数黎卡提方程(ARE)：\n$$\nA P + P A^{\\top} - P C^{\\top} R^{-1} C P + Q = 0\n$$\n给定的值为 $A = \\begin{pmatrix} -1 & 0 \\\\ 0 & -2 \\end{pmatrix}$，$C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$，$Q = I_2 = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$，以及 $R=1$。设 $P$ 为一个对称矩阵，$P = \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix}$。\n\n由于 $A$ 是对称的，所以 $A^{\\top} = A$。ARE 可简化为 $A P + P A - P C^{\\top} R^{-1} C P + Q = 0$。\n首先，我们计算二次项 $P C^{\\top} R^{-1} C P$。我们有 $R^{-1} = 1^{-1} = 1$ 和 $C^{\\top} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n$$\nC^{\\top} R^{-1} C = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (1) \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\n然后，\n$$\nP (C^{\\top} R^{-1} C) P = \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} = \\begin{pmatrix} p_{11} & 0 \\\\ p_{12} & 0 \\end{pmatrix} \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} = \\begin{pmatrix} p_{11}^2 & p_{11} p_{12} \\\\ p_{11} p_{12} & p_{12}^2 \\end{pmatrix}\n$$\n接下来，我们计算线性项 $AP+PA$：\n$$\nAP + PA = \\begin{pmatrix} -1 & 0 \\\\ 0 & -2 \\end{pmatrix} \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} + \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} \\begin{pmatrix} -1 & 0 \\\\ 0 & -2 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} -p_{11} & -p_{12} \\\\ -2p_{12} & -2p_{22} \\end{pmatrix} + \\begin{pmatrix} -p_{11} & -2p_{12} \\\\ -p_{12} & -2p_{22} \\end{pmatrix} = \\begin{pmatrix} -2p_{11} & -3p_{12} \\\\ -3p_{12} & -4p_{22} \\end{pmatrix}\n$$\n将所有项代回ARE：\n$$\n\\begin{pmatrix} -2p_{11} & -3p_{12} \\\\ -3p_{12} & -4p_{22} \\end{pmatrix} - \\begin{pmatrix} p_{11}^2 & p_{11} p_{12} \\\\ p_{11} p_{12} & p_{12}^2 \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\n这个矩阵方程产生了一个关于 $P$ 元素的标量代数方程组：\n1.  $(1,1)$ 项：$-2p_{11} - p_{11}^2 + 1 = 0$，可以重写为 $p_{11}^2 + 2p_{11} - 1 = 0$。\n2.  $(1,2)$ 项：$-3p_{12} - p_{11}p_{12} = 0$，可以因式分解为 $p_{12}(3+p_{11})=0$。\n3.  $(2,2)$ 项：$-4p_{22} - p_{12}^2 + 1 = 0$。\n\n从方程(1)中，我们使用二次公式求解 $p_{11}$：\n$$\np_{11} = \\frac{-2 \\pm \\sqrt{2^2 - 4(1)(-1)}}{2(1)} = \\frac{-2 \\pm \\sqrt{8}}{2} = -1 \\pm \\sqrt{2}\n$$\n由于 $P$ 必须是一个半正定矩阵，其对角线元素必须为非负值 ($p_{11} \\ge 0$)。$p_{11} = -1 - \\sqrt{2}$ 的值为负。因此，我们必须选择正根：$p_{11} = \\sqrt{2} - 1$。\n\n从方程(2)中，由于 $p_{11} = \\sqrt{2} - 1$，项 $3 + p_{11} = 3 + \\sqrt{2} - 1 = 2 + \\sqrt{2} \\neq 0$。因此，为了使方程 $p_{12}(3+p_{11})=0$ 成立，我们必须有 $p_{12}=0$。\n\n从方程(3)中，我们代入 $p_{12}=0$：\n$$\n-4p_{22} - 0^2 + 1 = 0 \\implies 4p_{22} = 1 \\implies p_{22} = \\frac{1}{4}\n$$\n因此，稳态误差协方差矩阵为：\n$$\nP = \\begin{pmatrix} \\sqrt{2}-1 & 0 \\\\ 0 & \\frac{1}{4} \\end{pmatrix}\n$$\n为了检查 $P$ 是否为正定矩阵，我们考察其特征值。由于 $P$ 是一个对角矩阵，其特征值即为对角线元素：$\\lambda_1 = \\sqrt{2}-1$ 和 $\\lambda_2=\\frac{1}{4}$。因为 $\\sqrt{2} \\approx 1.414$，所以 $\\lambda_1 \\approx 0.414 > 0$。并且 $\\lambda_2 = 0.25 > 0$。两个特征值都是严格正的，这证实了 $P$ 是一个正定矩阵。\n\n问题要求计算 $P$ 的行列式。\n$$\n\\det(P) = p_{11} p_{22} - p_{12}^2 = (\\sqrt{2}-1)\\left(\\frac{1}{4}\\right) - (0)^2 = \\frac{\\sqrt{2}-1}{4}\n$$", "answer": "$$\\boxed{\\frac{\\sqrt{2}-1}{4}}$$", "id": "3053882"}, {"introduction": "理论模型在实际应用中是否有效？本练习将向您介绍一种关键的诊断技术：新息序列分析。您将通过编程实现一个白度检验，来判断滤波器产生的新息序列是否为不相关的白噪声，这是最优滤波器的一个标志性特征 [@problem_id:3053906]。这项实践任务将帮助您跨越理论公式与实际模型验证之间的鸿沟，是评估和调试滤波器的核心技能。", "problem": "给定一个标量线性高斯状态空间模型，其具有一个隐状态和可观测输出。该模型由以下随机差分方程指定\n- 状态动态：$x_{k+1} = A x_k + w_k$\n- 测量：$y_k = C x_k + v_k$\n其中，$\\{w_k\\}$ 是一个独立高斯随机变量序列，满足 $w_k \\sim \\mathcal{N}(0,Q)$；$\\{v_k\\}$ 也是一个独立高斯随机变量序列，满足 $v_k \\sim \\mathcal{N}(0,R)$。序列 $\\{w_k\\}$ 和 $\\{v_k\\}$ 彼此独立，且与初始状态 $x_0$ 独立，初始状态 $x_0$ 服从均值为 $\\mu_0$、方差为 $P_0$ 的高斯分布。在随机微分方程离散化用于滤波的意义上，此设置为线性高斯系统的一个标准标量实例。\n\n您的任务是：\n- 使用卡尔曼滤波器的单步预测器，从给定的观测数据 $\\{y_k\\}_{k=0}^{N-1}$ 构建经验新息序列。\n- 使用中心化有偏估计量，从此新息序列中估计正延迟的样本自相关函数 (ACF)。\n- 基于样本自相关的大样本界，对新息进行白度检验。\n\n请仅使用以下基本定义和广泛接受的结果作为您推导和实现的基础：\n- 线性高斯状态空间模型的卡尔曼滤波器单步预测器和新息定义：\n  - 预测：$x_{k\\mid k-1} = A x_{k-1\\mid k-1}$ 和 $P_{k\\mid k-1} = A P_{k-1\\mid k-1} A + Q$。\n  - 新息：$e_k = y_k - C x_{k\\mid k-1}$ 和新息方差 $S_k = C P_{k\\mid k-1} C + R$。\n  - 卡尔曼增益：$K_k = \\dfrac{P_{k\\mid k-1} C}{S_k}$。\n  - 更新：$x_{k\\mid k} = x_{k\\mid k-1} + K_k e_k$ 和 $P_{k\\mid k} = (1 - K_k C) P_{k\\mid k-1}$。\n- 对于序列 $\\{e_k\\}_{k=0}^{N-1}$，延迟为 $\\ell \\ge 1$ 时的中心化有偏样本自相关估计：\n  - 令 $\\bar{e} = \\dfrac{1}{N}\\sum_{k=0}^{N-1} e_k$ 且 $d = \\sum_{k=0}^{N-1} (e_k - \\bar{e})^2$。\n  - 则 $r_\\ell = \\dfrac{\\sum_{k=\\ell}^{N-1} (e_k - \\bar{e})(e_{k-\\ell} - \\bar{e})}{d}$，对于 $\\ell = 1,2,\\dots,L'$，其中 $L' = \\min(L, N-2)$，$L$ 是用户指定的最大延迟。\n- 新息白度的大样本决策规则：在原假设 $\\{e_k\\}$ 是零均值独立（白噪声）的条件下，一个广泛使用的近似是，对于每个固定的 $\\ell \\ge 1$，$r_\\ell$ 近似服从均值为 $0$、方差为 $1/N$ 的高斯分布。因此，一个双边 $95\\%$ 置信界为 $\\pm \\dfrac{1.96}{\\sqrt{N}}$。如果对于所有 $\\ell = 1,\\dots,L'$，$\\lvert r_\\ell \\rvert \\le \\dfrac{1.96}{\\sqrt{N}}$ 都成立，则判定新息为白噪声。如果 $L' = 0$（即当 $N \\le 2$ 时），由于无法计算正延迟的自相关，按照惯例接受白度假设。\n\n请为下文指定的模型和测试套件实现以上内容。在所有情况下，系统参数为\n- $A = 0$, $C = 1$, $Q = 0$, $R = 1$, $\\mu_0 = 0$, $P_0 = 1$,\n且最大延迟为 $L = 3$。请注意，这些参数意味着对于所有 $k \\ge 0$，$x_{k\\mid k-1} = 0$，因此 $e_k = y_k$。\n\n测试套件（三种情况）：\n- 情况 A（理想情况，长度 $N = 12$）：$y = [0, 2.0, 0, 0, 0, 0, 0, 0, 0, 0, -2.0, 0]$。\n- 情况 B（强序列相关性，长度 $N = 20$）：$y = [1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]$。\n- 情况 C（短序列边缘情况，长度 $N = 3$）：$y = [1.0, -1.0, 1.0]$。\n\n您的程序必须：\n- 对每种情况，通过卡尔曼单步预测器计算新息 $\\{e_k\\}$，并计算 $\\ell = 1,\\dots,L'$ 的中心化有偏样本自相关 $r_\\ell$，其中 $L' = \\min(L,N-2)$，$L = 3$。\n- 对每种情况，使用双边界 $\\pm \\dfrac{1.96}{\\sqrt{N}}$ 对所有延迟 $\\ell = 1,\\dots,L'$ 进行检验，以判定白度。\n- 生成单行输出，包含一个用方括号括起来的逗号分隔列表，例如 $[{\\tt True},{\\tt False},{\\tt True}]$。每种情况的结果必须是一个布尔值，表示是否接受白度假设。\n\n最终输出格式：\n- 单行输出一个 Python 风格的、包含三个布尔值的列表，按顺序对应情况 A、B 和 C 的结果，例如 $[{\\tt True},{\\tt False},{\\tt True}]$。", "solution": "该问题要求基于线性高斯状态空间模型理论和白度假设检验对时间序列进行分析。分析主要分为两个阶段：首先，在给定参数下简化卡尔曼滤波器方程；其次，对得到的新息序列应用统计检验。\n\n**1. 卡尔曼滤波器简化**\n\n状态空间模型由以下标量方程给出：\n状态动态：$x_{k+1} = A x_k + w_k$，其中 $w_k \\sim \\mathcal{N}(0,Q)$\n测量：$y_k = C x_k + v_k$，其中 $v_k \\sim \\mathcal{N}(0,R)$\n\n指定的参数为 $A = 0$, $C = 1$, $Q = 0$, $R = 1$。初始状态为 $x_0 \\sim \\mathcal{N}(\\mu_0, P_0)$，其中 $\\mu_0=0$ 且 $P_0=1$。任务是计算新息序列 $e_k = y_k - C x_{k\\mid k-1}$，其中 $x_{k\\mid k-1}$ 是状态的单步预测值。\n\n状态的卡尔曼滤波器预测由 $x_{k\\mid k-1} = A x_{k-1\\mid k-1}$ 给出。\n我们来分析这个递归关系。过程始于对 $x_0$ 的先验估计，即 $x_{0\\mid -1} = \\mu_0$。给定 $\\mu_0 = 0$，我们有 $x_{0\\mid -1} = 0$。\n\n对于 $k=0$，新息为 $e_0 = y_0 - C x_{0\\mid -1} = y_0 - (1)(0) = y_0$。\n更新后的状态估计为 $x_{0\\mid 0} = x_{0\\mid-1} + K_0 e_0 = 0 + K_0 y_0$。\n\n对于 $k=1$，预测为 $x_{1\\mid 0} = A x_{0\\mid 0}$。由于 $A=0$，我们有 $x_{1\\mid 0} = 0 \\cdot x_{0\\mid 0} = 0$。\n新息为 $e_1 = y_1 - C x_{1\\mid 0} = y_1 - (1)(0) = y_1$。\n\n通过归纳法，我们假设 $x_{k-1\\mid k-2} = 0$。对于步骤 $k$ 的预测是 $x_{k\\mid k-1} = A x_{k-1\\mid k-1}$。因为 $A=0$，这使得 $x_{k\\mid k-1}=0$，而无论 $x_{k-1\\mid k-1}$ 的值是多少。因此，对于所有时间步 $k \\ge 0$，状态的单步预测恒为零。\n\n$x_{k\\mid k-1} = 0$ 对于所有 $k \\ge 0$。\n\n因此，新息序列 $\\{e_k\\}$ 简化为观测序列 $\\{y_k\\}$：\n$$e_k = y_k - C x_{k\\mid k-1} = y_k - (1)(0) = y_k$$\n这一简化将问题从一个滤波问题简化为对给定数据 $\\{y_k\\}$ 的直接时间序列分析。\n\n**2. 白度检验方法**\n\n新息序列 $\\{e_k\\}_{k=0}^{N-1}$ 的白度通过其样本自相关函数 (ACF) 进行检验。\n\n延迟为 $\\ell \\ge 1$ 时的中心化有偏样本 ACF 估计定义为：\n$$r_\\ell = \\frac{\\sum_{k=\\ell}^{N-1} (e_k - \\bar{e})(e_{k-\\ell} - \\bar{e})}{\\sum_{k=0}^{N-1} (e_k - \\bar{e})^2}$$\n其中 $\\bar{e} = \\frac{1}{N}\\sum_{k=0}^{N-1} e_k$ 是样本均值。ACF 的计算延迟为 $\\ell = 1, 2, \\dots, L'$，其中 $L' = \\min(L, N-2)$，且指定的最大延迟 $L=3$。\n\n白度检验基于大样本近似，即在白度原假设下，每个 $r_\\ell$ 近似服从 $\\mathcal{N}(0, 1/N)$ 分布。因此，$r_\\ell$ 的双边 $95\\%$ 置信区间由 $\\pm 1.96/\\sqrt{N}$ 给出。如果所有计算出的样本自相关都落在此界内，则认为序列 $\\{e_k\\}$ 是白噪声：\n$$|r_\\ell| \\le \\frac{1.96}{\\sqrt{N}} \\quad \\text{对于所有 } \\ell = 1, \\dots, L'$$\n如果 $L' = 0$（即当 $N \\le 2$ 时），按照惯例接受白度假设。\n\n**3. 逐个情况分析**\n\n我们现在将此方法应用于提供的三个测试用例。\n\n**情况 A：**\n- 数据：$y = [0, 2.0, 0, 0, 0, 0, 0, 0, 0, 0, -2.0, 0]$\n- 长度：$N=12$。\n- 新息：$e = y$。\n- 最大测试延迟：$L' = \\min(3, 12-2) = \\min(3, 10) = 3$。我们必须计算 $r_1, r_2, r_3$。\n- 样本均值：$\\bar{e} = \\frac{1}{12}(2.0 - 2.0) = 0$。\n- 分母：$d = \\sum_{k=0}^{11} (e_k - 0)^2 = (2.0)^2 + (-2.0)^2 = 4 + 4 = 8$。\n- 对于 $\\ell=1, 2, 3$ 的 ACF 分子：\n  - $\\ell=1$：$\\sum_{k=1}^{11} e_k e_{k-1} = e_1 e_0 + \\dots + e_{11}e_{10} = (2.0)(0) + \\dots + (0)(-2.0) = 0$。\n  - $\\ell=2$：$\\sum_{k=2}^{11} e_k e_{k-2} = 0$。\n  - $\\ell=3$：$\\sum_{k=3}^{11} e_k e_{k-3} = 0$。\n- 样本 ACF：$r_1 = r_2 = r_3 = 0/8 = 0$。\n- 白度检验阈值：$T = \\frac{1.96}{\\sqrt{12}} \\approx 0.5657$。\n- 判定：对于 $\\ell=1, 2, 3$，我们有 $|r_\\ell|=0 \\le 0.5657$。条件成立。\n- 情况 A 的结论：**接受白度假设 (True)**。\n\n**情况 B：**\n- 数据：$y = [1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]$\n- 长度：$N=20$。\n- 新息：$e = y$。\n- 最大测试延迟：$L' = \\min(3, 20-2) = \\min(3, 18) = 3$。我们必须计算 $r_1, r_2, r_3$。\n- 样本均值：$\\bar{e} = \\frac{1}{20}(10 \\times 1 + 10 \\times (-1)) = 0$。\n- 分母：$d = \\sum_{k=0}^{19} (e_k - 0)^2 = 10 \\times (1)^2 + 10 \\times (-1)^2 = 20$。\n- 对于 $\\ell=1$ 的 ACF 分子：$\\sum_{k=1}^{19} e_k e_{k-1} = (9 \\times (1)(1)) + (( -1)(1)) + (9 \\times (-1)(-1)) = 9 - 1 + 9 = 17$。\n- 对于 $\\ell=1$ 的样本 ACF：$r_1 = 17/20 = 0.85$。\n- 白度检验阈值：$T = \\frac{1.96}{\\sqrt{20}} \\approx 0.4382$。\n- 判定：对于 $\\ell=1$，我们有 $|r_1|=0.85 > 0.4382$。条件不满足。检验在第一个延迟处失败。\n- 情况 B 的结论：**拒绝白度假设 (False)**。\n\n**情况 C：**\n- 数据：$y = [1.0, -1.0, 1.0]$\n- 长度：$N=3$。\n- 新息：$e = y$。\n- 最大测试延迟：$L' = \\min(3, 3-2) = \\min(3, 1) = 1$。我们必须计算 $r_1$。\n- 样本均值：$\\bar{e} = \\frac{1}{3}(1.0 - 1.0 + 1.0) = 1/3$。\n- 分母：$d = \\sum_{k=0}^{2} (e_k - \\bar{e})^2 = (1 - 1/3)^2 + (-1 - 1/3)^2 + (1 - 1/3)^2 = (2/3)^2 + (-4/3)^2 + (2/3)^2 = 4/9 + 16/9 + 4/9 = 24/9 = 8/3$。\n- 对于 $\\ell=1$ 的 ACF 分子：$\\sum_{k=1}^{2} (e_k - \\bar{e})(e_{k-1} - \\bar{e}) = (e_1-\\bar{e})(e_0-\\bar{e}) + (e_2-\\bar{e})(e_1-\\bar{e}) = (-1-1/3)(1-1/3) + (1-1/3)(-1-1/3) = (-4/3)(2/3) + (2/3)(-4/3) = -8/9 - 8/9 = -16/9$。\n- 对于 $\\ell=1$ 的样本 ACF：$r_1 = \\frac{-16/9}{24/9} = -16/24 = -2/3 \\approx -0.6667$。\n- 白度检验阈值：$T = \\frac{1.96}{\\sqrt{3}} \\approx 1.1315$。\n- 判定：对于 $\\ell=1$，我们有 $|r_1| = |-2/3| \\approx 0.6667 \\le 1.1315$。条件成立。\n- 情况 C 的结论：**接受白度假设 (True)**。\n\n**结果总结**\n三种情况的白度检验结果如下：\n- 情况 A: True\n- 情况 B: False\n- 情况 C: True\n最终输出将是这些布尔值的列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a whiteness test on three time series based on their sample autocorrelation function.\n    \"\"\"\n    \n    # Test cases as defined in the problem statement.\n    test_cases = [\n        # Case A (ideal case)\n        {\"y\": [0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0]},\n        # Case B (strong serial correlation)\n        {\"y\": [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]},\n        # Case C (short sequence edge case)\n        {\"y\": [1.0, -1.0, 1.0]},\n    ]\n\n    L = 3  # Maximum lag specified in the problem\n\n    results = []\n    \n    for case in test_cases:\n        y = case[\"y\"]\n        N = len(y)\n\n        # The problem states that for the given parameters, the innovations e_k are equal to the observations y_k.\n        e = np.array(y)\n        \n        # Calculate the effective maximum lag L'\n        L_prime = min(L, N - 2)\n        \n        # If L' is 0 (i.e., N = 2), accept whiteness by convention.\n        if L_prime == 0:\n            results.append(True)\n            continue\n            \n        # Calculate the sample mean of the innovations\n        e_mean = np.mean(e)\n        \n        # Calculate the denominator for the ACF: sum of squared deviations\n        d = np.sum((e - e_mean)**2)\n        \n        # Initialize whiteness assumption\n        is_white = True\n        \n        # Calculate the 95% confidence threshold\n        threshold = 1.96 / np.sqrt(N)\n        \n        # Check ACF for lags from 1 to L'\n        for lag in range(1, L_prime + 1):\n            # The denominator d could be zero if all e_k are the same.\n            if d == 0:\n                # If all e_k are the same, they are perfectly predictable.\n                # The ACF is ill-defined. We can treat this as non-white, but the test cases avoid this.\n                # For robustness, we can handle it, though not strictly required by problem.\n                # If N > 1 and all e_k are equal, e-e_mean is zero, numerator is zero. \n                # ACF is 0/0. A constant non-zero signal is not white. Let's assume d > 0 for problem cases.\n                pass\n\n            # Calculate the numerator of the ACF\n            # (e_k - e_mean) for k from lag to N-1\n            term1 = e[lag:] - e_mean\n            # (e_{k-lag} - e_mean) for k from lag to N-1\n            term2 = e[:-lag] - e_mean\n            \n            numerator = np.sum(term1 * term2)\n            \n            r_lag = numerator / d if d != 0 else 0\n            \n            # Check if the absolute value of the ACF exceeds the threshold\n            if abs(r_lag) > threshold:\n                is_white = False\n                break\n        \n        results.append(is_white)\n\n    # Format the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3053906"}]}