{"hands_on_practices": [{"introduction": "掌握任何理论的第一步都是从其最基本的形式开始。这个练习将引导你解决一个标量（一维）随机线性二次调节器（SLQR）问题 [@problem_id:3077803]。通过从哈密顿-雅可比-贝尔曼（HJB）方程出发，你将推导出代数里卡提方程（ARE），并学会如何选择保证系统稳定性的唯一解，这是设计最优控制器的核心步骤。", "problem": "考虑由以下随机微分方程描述的标量受控Ornstein–Uhlenbeck过程：\n$$\n\\mathrm{d}X_t = a X_t\\,\\mathrm{d}t + b U_t\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t,\n$$\n其中 $a>0$，$b\\neq 0$，$\\sigma \\in \\mathbb{R}$，且 $(W_t)_{t\\ge 0}$ 是一个标准维纳过程。对于给定的有限时间域 $T>0$，性能指标为\n$$\nJ_T(x_0;U) = \\mathbb{E}\\left[\\int_{0}^{T} \\big(q X_t^2 + r U_t^2\\big)\\,\\mathrm{d}t\\right],\n$$\n其中 $q>0$ 且 $r>0$。假设价值函数具有二次形式 $V(t,x)=P(t)\\,x^2 + c(t)$，且终端条件为 $V(T,x)=0$。\n\n从该有限时间域问题的动态规划原理和Hamilton–Jacobi–Bellman方程出发，推导 $P(t)$ 必须满足的常微分方程。然后，在基本假设（$a>0$，$q>0$，$r>0$，$b\\neq 0$）下，考虑无限时间域极限 $T\\to\\infty$，确定解所得代数方程的恒定稳态系数 $P_{\\infty}$，并选择使闭环漂移项 $a - \\frac{b^2}{r} P_{\\infty}$ 严格为负的稳定解。\n\n将您的最终答案表示为关于 $a$、$b$、$q$ 和 $r$ 的单个解析闭式表达式。不需要进行数值计算或四舍五入。最终答案必须是单个表达式。", "solution": "该问题陈述是标量有限时间域随机线性二次调节器（SLQR）问题的标准形式，及其到无限时间域情况的延伸。所有给定的数据、条件和参数在随机控制理论的既定框架内都是一致的、科学上合理的和适定的。该问题是有效的。\n\n该问题的价值函数定义为\n$$\nV(t, x) = \\min_{U} \\mathbb{E}\\left[\\int_{t}^{T} \\big(q X_s^2 + r U_s^2\\big)\\,\\mathrm{d}s \\;\\Bigg|\\; X_t=x\\right].\n$$\n价值函数 $V(t,x)$ 必须满足Hamilton-Jacobi-Bellman (HJB) 偏微分方程：\n$$\n-\\frac{\\partial V}{\\partial t}(t,x) = \\min_{U} \\left\\{ (ax + bU)\\frac{\\partial V}{\\partial x}(t,x) + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2}(t,x) + qx^2 + rU^2 \\right\\},\n$$\n终端条件为 $V(T,x) = 0$。\n\n我们给定价值函数具有二次形式 $V(t,x) = P(t)x^2 + c(t)$ 的拟设。我们计算其偏导数：\n$$\n\\frac{\\partial V}{\\partial t} = \\dot{P}(t)x^2 + \\dot{c}(t), \\quad \\frac{\\partial V}{\\partial x} = 2P(t)x, \\quad \\frac{\\partial^2 V}{\\partial x^2} = 2P(t).\n$$\n将这些导数代入HJB方程，得到：\n$$\n-\\left(\\dot{P}(t)x^2 + \\dot{c}(t)\\right) = \\min_{U} \\left\\{ (ax + bU)(2P(t)x) + \\frac{1}{2}\\sigma^2(2P(t)) + qx^2 + rU^2 \\right\\}.\n$$\n$$\n-\\dot{P}(t)x^2 - \\dot{c}(t) = \\min_{U} \\left\\{ 2aP(t)x^2 + 2bP(t)xU + \\sigma^2P(t) + qx^2 + rU^2 \\right\\}.\n$$\n为了找到最优控制 $U_t^*$，我们对花括号中的表达式关于 $U$ 进行最小化。该表达式是关于 $U$ 的凸二次函数，因此通过将其关于 $U$ 的一阶导数置为零来找到其最小值：\n$$\n\\frac{\\partial}{\\partial U} \\left(rU^2 + 2bP(t)xU + \\dots \\right) = 2rU + 2bP(t)x = 0.\n$$\n由于 $r>0$，这给出了唯一的最优控制：\n$$\nU_t^* = -\\frac{b P(t)}{r} X_t.\n$$\n现在，我们将此最优控制代回HJB方程：\n$$\n-\\dot{P}(t)x^2 - \\dot{c}(t) = 2aP(t)x^2 + 2bP(t)x\\left(-\\frac{bP(t)x}{r}\\right) + \\sigma^2P(t) + qx^2 + r\\left(-\\frac{bP(t)x}{r}\\right)^2.\n$$\n化简右侧：\n$$\n-\\dot{P}(t)x^2 - \\dot{c}(t) = 2aP(t)x^2 - \\frac{2b^2P(t)^2}{r}x^2 + \\sigma^2P(t) + qx^2 + \\frac{b^2P(t)^2}{r}x^2.\n$$\n合并同类项：\n$$\n-\\dot{P}(t)x^2 - \\dot{c}(t) = \\left(2aP(t) - \\frac{b^2P(t)^2}{r} + q\\right)x^2 + \\sigma^2P(t).\n$$\n该方程必须对所有 $x \\in \\mathbb{R}$ 成立。通过将依赖于 $x^2$ 的项与常数项分离，我们得到一个由两个常微分方程（ODE）组成的方程组：\n1.  $-\\dot{P}(t) = q + 2aP(t) - \\frac{b^2}{r}P(t)^2$\n2.  $-\\dot{c}(t) = \\sigma^2P(t)$\n\n对所有 $x$ 的终端条件 $V(T,x) = P(T)x^2 + c(T) = 0$ 意味着边界条件为 $P(T)=0$ 和 $c(T)=0$。第一个方程是关于 $P(t)$ 的微分Riccati方程。\n\n对于无限时间域问题（$T \\to \\infty$），我们寻求一个稳态解，其中价值函数是时不变的。这意味着 $P(t)$ 变为一个常数，我们记为 $P_{\\infty}$。在这种稳态下，其时间导数为零，$\\dot{P}(t) = 0$。微分Riccati方程简化为连续时间代数Riccati方程（ARE）：\n$$\n0 = q + 2aP_{\\infty} - \\frac{b^2}{r}P_{\\infty}^2.\n$$\n将其重排为关于 $P_{\\infty}$ 的标准二次形式 $Ax^2+Bx+C=0$：\n$$\n\\frac{b^2}{r}P_{\\infty}^2 - 2aP_{\\infty} - q = 0.\n$$\n我们使用二次公式求解 $P_{\\infty}$：\n$$\nP_{\\infty} = \\frac{-(-2a) \\pm \\sqrt{(-2a)^2 - 4\\left(\\frac{b^2}{r}\\right)(-q)}}{2\\left(\\frac{b^2}{r}\\right)} = \\frac{2a \\pm \\sqrt{4a^2 + \\frac{4b^2q}{r}}}{\\frac{2b^2}{r}}.\n$$\n化简此表达式：\n$$\nP_{\\infty} = \\frac{r}{b^2}\\left(a \\pm \\sqrt{a^2 + \\frac{b^2q}{r}}\\right).\n$$\n问题要求选择使闭环系统稳定的解。稳态最优控制为 $U_t^* = -\\frac{b P_{\\infty}}{r} X_t$。将其代入关于 $X_t$ 的随机微分方程，得到闭环动力学：\n$$\n\\mathrm{d}X_t = a X_t\\,\\mathrm{d}t + b\\left(-\\frac{b P_{\\infty}}{r} X_t\\right)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t = \\left(a - \\frac{b^2 P_{\\infty}}{r}\\right)X_t\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t.\n$$\n为使过程稳定，闭环漂移系数 $a_{cl} = a - \\frac{b^2}{r}P_{\\infty}$ 必须严格为负。我们来检验 $P_{\\infty}$ 的两个解。\n\n情况1：$P_{\\infty,1} = \\frac{r}{b^2}\\left(a + \\sqrt{a^2 + \\frac{b^2q}{r}}\\right)$\n$$\na_{cl,1} = a - \\frac{b^2}{r} \\left[ \\frac{r}{b^2}\\left(a + \\sqrt{a^2 + \\frac{b^2q}{r}}\\right) \\right] = a - \\left(a + \\sqrt{a^2 + \\frac{b^2q}{r}}\\right) = -\\sqrt{a^2 + \\frac{b^2q}{r}}.\n$$\n由于 $b \\neq 0$，$q > 0$ 且 $r > 0$，项 $\\frac{b^2q}{r}$ 为正。因此，$a^2 + \\frac{b^2q}{r} > 0$，其平方根是一个正实数。所以，$a_{cl,1}  0$，这对应于一个稳定的闭环系统。\n\n情况2：$P_{\\infty,2} = \\frac{r}{b^2}\\left(a - \\sqrt{a^2 + \\frac{b^2q}{r}}\\right)$\n$$\na_{cl,2} = a - \\frac{b^2}{r} \\left[ \\frac{r}{b^2}\\left(a - \\sqrt{a^2 + \\frac{b^2q}{r}}\\right) \\right] = a - \\left(a - \\sqrt{a^2 + \\frac{b^2q}{r}}\\right) = +\\sqrt{a^2 + \\frac{b^2q}{r}}.\n$$\n该漂移系数严格为正，$a_{cl,2} > 0$，这对应于一个不稳定的闭环系统。\n\n此外，价值函数必须是非负的，这要求 $P_{\\infty} \\ge 0$。项 $\\sqrt{a^2 + \\frac{b^2q}{r}}$ 总是大于 $|a|$。因此，$a - \\sqrt{a^2 + \\frac{b^2q}{r}}$ 总是负的（因为 $a \\le |a|$），导致 $P_{\\infty,2}$ 为负。相反，$a + \\sqrt{a^2 + \\frac{b^2q}{r}}$ 总是正的（因为 $a \\ge -|a|$），导致 $P_{\\infty,1}$ 为正。因此，稳定性和价值函数正性这两个条件都选择了相同的解 $P_{\\infty,1}$。正确的稳态系数是 $P_{\\infty,1}$。", "answer": "$$\\boxed{\\frac{r}{b^2}\\left(a + \\sqrt{a^2 + \\frac{b^2q}{r}}\\right)}$$", "id": "3077803"}, {"introduction": "真实世界的系统很少是孤立的；它们通常由多个相互作用的部分组成。这个练习将挑战你把标量情况下的理解扩展到一个二维系统，即经典的双积分器模型 [@problem_id:3077758]。通过只惩罚系统的一个状态（位置），你将发现最优控制器如何巧妙地利用系统内部的动态耦合来间接调节另一个未受惩罚的状态（速度），这深刻揭示了在复杂系统中实现全面控制的精髓。", "problem": "考虑一个由标准布朗运动（维纳过程）驱动的连续时间线性随机系统\n$$\nd x(t) = \\big(A\\,x(t) + B\\,u(t)\\big)\\,dt + D\\,dW_t,\n$$\n其状态为 $x(t) \\in \\mathbb{R}^{2}$，控制为 $u(t) \\in \\mathbb{R}$，矩阵为\n$$\nA=\\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix},\\quad B=\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\\quad D=\\begin{pmatrix} 0 \\\\ \\sigma \\end{pmatrix},\n$$\n其中 $\\sigma0$ 是一个固定的常数。考虑无限时域遍历平均成本\n$$\nJ(u) = \\limsup_{T\\to\\infty}\\frac{1}{T}\\,\\mathbb{E}\\left[ \\int_{0}^{T} \\Big(x(t)^{\\top} Q\\, x(t) + u(t)^{\\top} R\\, u(t)\\Big)\\,dt \\right],\n$$\n其中状态惩罚 $Q$ 仅惩罚第一个分量，\n$$\nQ=\\begin{pmatrix} q  0 \\\\ 0  0 \\end{pmatrix},\\quad q0,\n$$\n控制惩罚为 $R=1$。假设全状态反馈是允许的，并且存在一个平稳最优解。\n\n从随机动态规划原理和遍历平均成本的哈密顿-雅可比-贝尔曼（HJB）方程出发，并假设一个二次形式的值函数，推导形如 $u(t)=-K\\,x(t)$ 的平稳最优状态反馈控制律，其中 $K\\in\\mathbb{R}^{1\\times 2}$。具体而言：\n\n1. 推导决定值函数二次形式和最优反馈增益的代数条件。\n2. 对当前系统显式求解此代数条件，并计算最优增益 $K$ 作为 $q$ 的函数的精确闭合形式解。\n3. 在你的推导过程中，解释为什么噪声强度 $\\sigma$ 不影响最优反馈增益，并阐明第二个（未受惩罚的）状态如何通过系统动力学被间接调节。\n\n请以 $1\\times 2$ 行向量的形式给出最优增益 $K$ 的精确表达式。不需要进行数值四舍五入。最终答案中不要包含单位。请使用 $\\text{pmatrix}$ 格式将最终答案表示为行矩阵。", "solution": "该问题是有效的，因为它构成了一个适定且标准的随机线性二次调节问题，具有无限时域遍历平均成本。所有必要的参数和条件都已提供，不存在科学或逻辑上的矛盾。\n\n系统动力学由以下随机微分方程（SDE）给出：\n$$\nd x(t) = \\big(A\\,x(t) + B\\,u(t)\\big)\\,dt + D\\,dW_t\n$$\n其状态为 $x(t) \\in \\mathbb{R}^{2}$，控制为 $u(t) \\in \\mathbb{R}$。矩阵为：\n$$\nA=\\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix},\\quad B=\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\\quad D=\\begin{pmatrix} 0 \\\\ \\sigma \\end{pmatrix}\n$$\n目标是最小化无限时域遍历平均成本：\n$$\nJ(u) = \\limsup_{T\\to\\infty}\\frac{1}{T}\\,\\mathbb{E}\\left[ \\int_{0}^{T} \\Big(x(t)^{\\top} Q\\, x(t) + u(t)^{\\top} R\\, u(t)\\Big)\\,dt \\right]\n$$\n其中权重矩阵为：\n$$\nQ=\\begin{pmatrix} q  0 \\\\ 0  0 \\end{pmatrix},\\quad q0,\\quad R=1\n$$\n\n### 1. 代数条件的推导\n该解可利用随机动态规划原理得到。对于遍历平均成本问题，哈密顿-雅可比-贝尔曼（HJB）方程为：\n$$\n\\rho = \\min_{u} \\left\\{ \\mathcal{L}^u V(x) + l(x, u) \\right\\}\n$$\n此处，$\\rho$ 是最优平均成本（一个常数），$V(x)$ 是微分值函数，$l(x, u) = x^{\\top} Q x + u^{\\top} R u$ 是运行成本，而 $\\mathcal{L}^u$ 是在给定控制 $u$ 下过程 $x(t)$ 的无穷小生成元。对于给定的SDE，作用于二次可微函数 $V(x)$ 的生成元为：\n$$\n\\mathcal{L}^u V(x) = \\nabla V(x)^{\\top} (Ax + Bu) + \\frac{1}{2} \\text{Tr}\\left( D^{\\top} \\text{Hess}(V(x)) D \\right)\n$$\n其中 $\\nabla V(x)$ 是 $V(x)$ 的梯度，$\\text{Hess}(V(x))$ 是 $V(x)$ 的海森矩阵。\n\n考虑到线性系统和二次成本，我们假设一个二次微分值函数形式为 $V(x) = x^{\\top} P x$，其中 $P$ 是一个对称半正定矩阵。其梯度和海森矩阵分别为 $\\nabla V(x) = 2Px$ 和 $\\text{Hess}(V(x)) = 2P$。将这些代入生成元得到：\n$$\n\\mathcal{L}^u V(x) = (2Px)^{\\top} (Ax + Bu) + \\frac{1}{2} \\text{Tr}(D^{\\top} (2P) D) = 2x^{\\top}P(Ax+Bu) + \\text{Tr}(D^{\\top}PD)\n$$\nHJB方程变为：\n$$\n\\rho = \\min_{u} \\left\\{ 2x^{\\top}PAx + 2x^{\\top}PBu + \\text{Tr}(D^{\\top}PD) + x^{\\top}Qx + u^{\\top}Ru \\right\\}\n$$\n为了找到最优控制 $u^*$，我们对关于 $u$ 的表达式进行最小化。涉及 $u$ 的项是 $2x^{\\top}PBu + u^{\\top}Ru$。这是一个关于 $u$ 的二次函数。对 $u$ 求导并令其为零，得到：\n$$\n\\frac{\\partial}{\\partial u} (2x^{\\top}PBu + u^{\\top}Ru) = 2(PBx)^{\\top} + 2Ru = 2B^{\\top}Px + 2Ru = 0\n$$\n由于 $R  0$，我们可以解出最优控制律：\n$$\nu^*(t) = -R^{-1}B^{\\top}Px(t)\n$$\n这是一个线性状态反馈控制律 $u(t) = -Kx(t)$，其最优增益矩阵为 $K = R^{-1}B^{\\top}P$。\n\n将 $u^*$ 代回 HJB 方程：\n$$\n\\rho = 2x^{\\top}PAx + 2x^{\\top}PB(-R^{-1}B^{\\top}Px) + \\text{Tr}(D^{\\top}PD) + x^{\\top}Qx + (-R^{-1}B^{\\top}Px)^{\\top}R(-R^{-1}B^{\\top}Px)\n$$\n$$\n\\rho = x^{\\top}(A^{\\top}P+PA)x - 2x^{\\top}PBR^{-1}B^{\\top}Px + \\text{Tr}(D^{\\top}PD) + x^{\\top}Qx + x^{\\top}PBR^{-1}B^{\\top}Px\n$$\n$$\n\\rho = x^{\\top}\\left( A^{\\top}P + PA - PBR^{-1}B^{\\top}P + Q \\right)x + \\text{Tr}(D^{\\top}PD)\n$$\n这个方程必须对所有 $x(t) \\in \\mathbb{R}^2$ 成立。这只有当 $x$ 的二次项恒为零时才可能。这给出了确定 $P$ 的代数条件：\n$$\nA^{\\top}P + PA - PBR^{-1}B^{\\top}P + Q = 0\n$$\n这就是连续时间代数黎卡提方程（CARE）。这个方程确定了矩阵 $P$，并因此确定了最优反馈增益 $K = R^{-1}B^{\\top}P$。最优平均成本则由 $\\rho = \\text{Tr}(D^{\\top}PD)$ 给出。\n\n### 3. 增益与噪声的无关性及第二状态的调节\n决定矩阵 $P$ 从而决定最优增益 $K$ 的 CARE 方程，$A^{\\top}P + PA - PBR^{-1}B^{\\top}P + Q = 0$，不涉及噪声矩阵 $D$ 或其强度 $\\sigma$。这是LQG控制中分离原理或确定性等价原理的一种体现：最优反馈增益与确定性问题（其中 $D=0$）的最优反馈增益相同。噪声只影响可实现的最小成本 $\\rho = \\text{Tr}(D^{\\top}PD)$，而不影响最优控制策略。\n\n状态向量为 $x(t) = [x_1(t), x_2(t)]^{\\top}$，其中 $x_1$ 是位置，$x_2$ 是速度 ($dx_1/dt = x_2$)。成本函数 $x^{\\top}Qx = qx_1^2$ 只惩罚位置 $x_1$。然而，为了保持 $x_1$ 较小，控制器必须调节 $x_2$。如果 $x_2$ 不被驱动至零，那么 $x_1$ 将会积分到很大的值，导致高昂的成本。最优控制器利用来自两个状态的反馈 $u = -k_1x_1 - k_2x_2$ 来稳定整个系统。来自 $x_2$ 的反馈（速度反馈）为系统提供了必要的阻尼，确保位置和速度都在随机意义上收敛到原点。\n\n### 2. 最优增益的显式解\n我们现在为给定系统求解 CARE。设 $P = \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix}$ 为对称解矩阵。\n矩阵为 $A=\\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}$，$B=\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，$Q=\\begin{pmatrix} q  0 \\\\ 0  0 \\end{pmatrix}$ 和 $R=1$。\n\n我们计算 CARE 的各项：\n$A^{\\top}P + PA = \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix}\\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} + \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix}\\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  p_{11} \\\\ p_{11}  2p_{12} \\end{pmatrix}$。\n$BR^{-1}B^{\\top} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} (1) \\begin{pmatrix} 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}$。\n$P(BR^{-1}B^{\\top})P = \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} = \\begin{pmatrix} p_{12} \\\\ p_{22} \\end{pmatrix} \\begin{pmatrix} p_{12}  p_{22} \\end{pmatrix} = \\begin{pmatrix} p_{12}^2  p_{12}p_{22} \\\\ p_{12}p_{22}  p_{22}^2 \\end{pmatrix}$。\n\nCARE 方程变为：\n$$\n\\begin{pmatrix} 0  p_{11} \\\\ p_{11}  2p_{12} \\end{pmatrix} - \\begin{pmatrix} p_{12}^2  p_{12}p_{22} \\\\ p_{12}p_{22}  p_{22}^2 \\end{pmatrix} + \\begin{pmatrix} q  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} q - p_{12}^2  p_{11} - p_{12}p_{22} \\\\ p_{11} - p_{12}p_{22}  2p_{12} - p_{22}^2 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n这产生了一个包含三个代数方程的方程组：\n1. $q - p_{12}^2 = 0 \\implies p_{12}^2 = q$\n2. $2p_{12} - p_{22}^2 = 0 \\implies p_{22}^2 = 2p_{12}$\n3. $p_{11} - p_{12}p_{22} = 0 \\implies p_{11} = p_{12}p_{22}$\n\n由(1)，因为 $q>0$，我们有 $p_{12} = \\pm\\sqrt{q}$。为了使闭环系统稳定，解 $P$ 必须是正定的。由(2)，$p_{22}^2 = 2p_{12}$。为了使 $p_{22}$ 为实数，$p_{12}$ 必须为非负数。这要求 $p_{12} = \\sqrt{q}$。\n当 $p_{12} = \\sqrt{q}$ 时，方程(2)给出 $p_{22}^2 = 2\\sqrt{q}$。由于 $P$ 必须是正定的，其对角线元素必须为正，我们取正根：$p_{22} = \\sqrt{2\\sqrt{q}}$。\n由(3)，我们得到 $p_{11} = p_{12}p_{22} = \\sqrt{q} \\sqrt{2\\sqrt{q}} = \\sqrt{2}q^{\\frac{3}{4}}$。\n解矩阵为 $P = \\begin{pmatrix} \\sqrt{2}q^{\\frac{3}{4}}  \\sqrt{q} \\\\ \\sqrt{q}  \\sqrt{2\\sqrt{q}} \\end{pmatrix}$。由于 $p_{11}0$ 且 $\\det(P) = p_{11}p_{22} - p_{12}^2 = (\\sqrt{2}q^{\\frac{3}{4}})(\\sqrt{2\\sqrt{q}}) - (\\sqrt{q})^2 = 2q-q=q0$，所以 $P$ 是正定的。\n\n最优反馈增益 $K$ 由下式给出：\n$$\nK = R^{-1}B^{\\top}P = (1) \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} = \\begin{pmatrix} p_{12}  p_{22} \\end{pmatrix}\n$$\n代入推导出的 $p_{12}$ 和 $p_{22}$ 的值：\n$$\nK = \\begin{pmatrix} \\sqrt{q}  \\sqrt{2\\sqrt{q}} \\end{pmatrix}\n$$\n这就是平稳最优状态反馈增益。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{q}  \\sqrt{2\\sqrt{q}} \\end{pmatrix}}\n$$", "id": "3077758"}, {"introduction": "设计一个控制器只是解决方案的一半，我们还需要量化它在随机噪声影响下的表现。这个练习将带你完成“闭环分析”：在应用了你通过代数里卡提方程得到的最优反馈控制器之后，系统将达到什么样的稳定状态 [@problem_id:3077740]？通过计算受控系统的稳态方差，你将直接量化随机扰动$\\sigma$与最优控制策略之间的对抗结果，这是衡量控制器性能的关键指标。", "problem": "考虑标量受控的伊藤随机微分方程 (SDE)\n$$\n\\mathrm{d}x_t = a\\,x_t\\,\\mathrm{d}t + b\\,u_t\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t,\n$$\n其中 $a \\in \\mathbb{R}$，$b \\neq 0$，$\\sigma  0$，且 $\\{W_t\\}_{t \\ge 0}$ 是一个标准维纳过程。性能准则是无限时域遍历平均成本\n$$\nJ(u) \\;=\\; \\limsup_{T \\to \\infty} \\frac{1}{T}\\,\\mathbb{E}\\!\\left[\\int_0^T \\big(q\\,x_t^2 + r\\,u_t^2\\big)\\,\\mathrm{d}t\\right],\n$$\n其中 $q0$ 且 $r0$。假设状态完全可观测，并仅考虑形式为 $u_t = \\pi(x_t)$ 的时不变状态反馈控制，该控制能使闭环系统均方稳定。\n\n从遍历成本的动态规划原理和哈密顿-雅可比-贝尔曼 (HJB) 方程出发，推导最优的无限时域线性二次调节器 (LQR) 反馈律，并证明闭环动力学是奥恩斯坦-乌伦贝克过程。然后，计算在最优反馈下 $x_t$ 的平稳（稳态）方差 $\\operatorname{Var}_{\\pi}(x_t)$，作为 $a$、$b$、$q$、$r$ 和 $\\sigma$ 的显式函数。最后，定性解释平稳方差如何依赖于扩散强度 $\\sigma$。\n\n你最终报告的答案必须是稳态方差 $\\operatorname{Var}_{\\pi}(x_t)$ 关于 $a$、$b$、$q$、$r$ 和 $\\sigma$ 的单一闭式表达式。无需四舍五入。", "solution": "所述问题是一个带有遍历（平均成本）性能准则的连续时间、无限时域、标量随机线性二次调节器 (LQR) 问题。我们首先验证问题陈述的有效性。\n\n给定条件如下：\n- 状态动力学，一个线性伊藤随机微分方程 (SDE)：$\\mathrm{d}x_t = a\\,x_t\\,\\mathrm{d}t + b\\,u_t\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t$，参数为 $a \\in \\mathbb{R}$，$b \\neq 0$ 且 $\\sigma  0$。\n- 成本泛函：$J(u) = \\limsup_{T \\to \\infty} \\frac{1}{T}\\,\\mathbb{E}\\!\\left[\\int_0^T (q\\,x_t^2 + r\\,u_t^2)\\,\\mathrm{d}t\\right]$，权重因子 $q0$ 且 $r0$。\n- 容许控制类：形式为 $u_t = \\pi(x_t)$ 的时不变状态反馈律，其能保证闭环系统的均方稳定性。\n\n该问题具有科学依据，是适定的、客观的。这是随机控制理论中的一个典型问题。系统是可控的（因为 $b \\neq 0$），并且成本函数是凸的，其状态和控制的权重是正定的，这保证了唯一的最优且稳定的控制律的存在。因此，该问题是有效的。\n\n我们继续求解，从遍历成本问题的动态规划原理开始。该原理引出了哈密顿-雅可比-贝尔曼 (HJB) 方程。对于给定的状态 $x$ 和控制 $u$，成本率为 $L(x, u) = q\\,x^2 + r\\,u^2$。SDE 的无穷小生成元作用于一个二阶可微函数 $V(x)$，由下式给出\n$$\n\\mathcal{A}^u V(x) = (a\\,x + b\\,u)\\frac{\\mathrm{d}V}{\\mathrm{d}x} + \\frac{1}{2}\\sigma^2\\frac{\\mathrm{d}^2V}{\\mathrm{d}x^2}.\n$$\n最优平均成本 $\\rho$ 的 HJB 方程为\n$$\n\\rho = \\min_{u \\in \\mathbb{R}} \\left\\{ q\\,x^2 + r\\,u^2 + \\mathcal{A}^u V(x) \\right\\},\n$$\n其中 $V(x)$ 是相对价值函数。代入生成元，我们得到\n$$\n\\rho = \\min_{u \\in \\mathbb{R}} \\left\\{ q\\,x^2 + r\\,u^2 + (a\\,x + b\\,u)V'(x) + \\frac{1}{2}\\sigma^2V''(x) \\right\\}.\n$$\n最小值内部的表达式是关于 $u$ 的凸二次函数。通过将关于 $u$ 的偏导数设为零来找到最小值：\n$$\n\\frac{\\partial}{\\partial u} \\left[ r\\,u^2 + b\\,u\\,V'(x) \\right] = 2\\,r\\,u + b\\,V'(x) = 0.\n$$\n这得到了反馈形式的最优控制律：\n$$\nu^*(x) = -\\frac{b}{2r}V'(x).\n$$\n我们将此最优控制代回 HJB 方程：\n$$\n\\rho = q\\,x^2 + r\\left(-\\frac{b}{2r}V'(x)\\right)^2 + \\left(a\\,x + b\\left(-\\frac{b}{2r}V'(x)\\right)\\right)V'(x) + \\frac{1}{2}\\sigma^2V''(x).\n$$\n化简表达式可得\n$$\n\\rho = q\\,x^2 + \\frac{b^2}{4r}(V'(x))^2 + a\\,x\\,V'(x) - \\frac{b^2}{2r}(V'(x))^2 + \\frac{1}{2}\\sigma^2V''(x),\n$$\n$$\n\\rho = q\\,x^2 + a\\,x\\,V'(x) - \\frac{b^2}{4r}(V'(x))^2 + \\frac{1}{2}\\sigma^2V''(x).\n$$\n对于具有二次成本的线性系统，我们假设一个二次形式的相对价值函数 $V(x) = \\frac{1}{2}Px^2$，其中 $P$ 是一个待定常数。其导数为 $V'(x) = Px$ 和 $V''(x) = P$。将这些代入 HJB 方程：\n$$\n\\rho = q\\,x^2 + a\\,x\\,(Px) - \\frac{b^2}{4r}(Px)^2 + \\frac{1}{2}\\sigma^2P.\n$$\n按 $x$ 的幂次合并各项：\n$$\n\\rho = \\left(q + aP - \\frac{b^2P^2}{4r}\\right)x^2 + \\frac{1}{2}\\sigma^2P.\n$$\n该方程必须对所有 $x \\in \\mathbb{R}$ 成立。这仅当 $x^2$ 项的系数为零时才可能。这一要求得出了标量代数黎卡提方程 (ARE)：\n$$\nq + aP - \\frac{b^2P^2}{4r} = 0 \\quad \\implies \\quad \\frac{b^2}{4r}P^2 - aP - q = 0.\n$$\n这个二次方程关于 $P$ 的解是\n$$\nP = \\frac{a \\pm \\sqrt{a^2 - 4\\left(\\frac{b^2}{4r}\\right)(-q)}}{2\\left(\\frac{b^2}{4r}\\right)} = \\frac{a \\pm \\sqrt{a^2 + \\frac{b^2q}{r}}}{\\frac{b^2}{2r}} = \\frac{2r}{b^2}\\left(a \\pm \\sqrt{a^2 + \\frac{b^2q}{r}}\\right).\n$$\n问题要求一个能使系统均方稳定的控制。最优控制是 $u_t = u^*(x_t) = -\\frac{b}{2r}V'(x_t) = -\\frac{b P}{2r}x_t$。闭环 SDE 变为\n$$\n\\mathrm{d}x_t = \\left(a - \\frac{b^2P}{2r}\\right)x_t\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t.\n$$\n为使此线性 SDE 均方稳定，其漂移系数必须为负：$a_{cl} = a - \\frac{b^2P}{2r}  0$。\n由于 $q0$，$r0$，我们有 $\\sqrt{a^2 + b^2q/r}  \\sqrt{a^2} = |a|$。\n解 $P_{-} = \\frac{2r}{b^2}\\left(a - \\sqrt{a^2 + \\frac{b^2q}{r}}\\right)$ 是负的，因为 $a  \\sqrt{a^2 + \\dots}$。一个负的 $P$ 会意味着一个负的价值（成本），这对于 $q0, r0$ 的成本函数是不一致的。\n另一个解，$P_{+} = \\frac{2r}{b^2}\\left(a + \\sqrt{a^2 + \\frac{b^2q}{r}}\\right)$，是正的，因为 $a + \\sqrt{a^2+\\dots}  a+|a| \\ge 0$。我们来检验 $P=P_{+}$ 时的稳定性条件：\n$$\na_{cl} = a - \\frac{b^2}{2r} P_{+} = a - \\frac{b^2}{2r} \\frac{2r}{b^2}\\left(a + \\sqrt{a^2 + \\frac{b^2q}{r}}\\right) = a - \\left(a + \\sqrt{a^2 + \\frac{b^2q}{r}}\\right) = -\\sqrt{a^2 + \\frac{b^2q}{r}}.\n$$\n由于 $b \\neq 0$，$q  0$，$r  0$，平方根下的项是严格为正的，所以 $a_{cl}  0$。因此，$P = P_{+}$ 是 ARE 唯一的正定解，它提供了一个稳定的反馈控制。\n\n闭环系统由 SDE 描述\n$$\n\\mathrm{d}x_t = a_{cl}\\,x_t\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t, \\quad \\text{其中} \\quad a_{cl} = -\\sqrt{a^2 + \\frac{b^2q}{r}}.\n$$\n这是奥恩斯坦-乌伦贝克 (OU) 过程的方程，其一般形式为 $\\mathrm{d}X_t = -\\theta X_t \\mathrm{d}t + \\nu \\mathrm{d}W_t$。在我们的情况中，均值回归率为 $\\theta = -a_{cl}  0$，波动率为 $\\nu = \\sigma$。\n\n一个 OU 过程有一个平稳（或遍历）分布，它是一个均值为 $0$、方差为 $\\operatorname{Var}(X) = \\frac{\\nu^2}{2\\theta}$ 的高斯分布。\n将此应用于我们的闭环系统，在最优控制策略 $\\pi$ 下 $x_t$ 的平稳方差为\n$$\n\\operatorname{Var}_{\\pi}(x_t) = \\frac{\\sigma^2}{2(-a_{cl})} = \\frac{\\sigma^2}{2\\left(\\sqrt{a^2 + \\frac{b^2q}{r}}\\right)}.\n$$\n\n最后，我们分析平稳方差对扩散强度 $\\sigma$ 的依赖性。推导出的公式表明 $\\operatorname{Var}_{\\pi}(x_t)$ 与 $\\sigma^2$ 成正比。定性地讲，$\\sigma$ 代表了扰动系统的随机噪声的强度。$\\sigma$ 的增加意味着更强的随机力，将状态推离其在 $x=0$ 的平衡点。虽然最优控制器持续作用以调节状态，但更大的噪声自然会导致更大的平稳波动。方差，作为与均值的偏差平方的期望，随噪声振幅呈二次方比例缩放。这是由白噪声驱动的线性系统的一个基本特征。", "answer": "$$\\boxed{\\frac{\\sigma^2}{2\\sqrt{a^2 + \\frac{b^2 q}{r}}}}$$", "id": "3077740"}]}