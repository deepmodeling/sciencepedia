{"hands_on_practices": [{"introduction": "任何随机微分方程（SDE）模拟的准确性都取决于对底层随机过程的正确建模。本练习聚焦于我们数值格式最基本的构成单元：维纳过程增量。我们将探讨在进行有效的强收敛分析时，这些增量必须满足的关键性质，从而为可靠的数值模拟打下坚实的基础。[@problem_id:3079040]", "problem": "考虑一个由维纳过程（也称布朗运动）$W_t$ 驱动的随机微分方程，以及一个步长为 $h>0$ 的均匀时间网格 $t_n = n h$。对于像 Euler–Maruyama 这样的单步数值格式的强收敛性分析，离散噪声输入必须忠实地再现驱动维纳过程的分布律和结构性质。根据维纳过程的定义性质，不相交区间上的增量是独立且平稳的，并且满足 $W_{t_{n+1}} - W_{t_n} \\sim N(0,h)$，其均值为 $0$，方差为 $h$。\n\n你正在实现一个形如 $X_{n+1} = X_n + a(X_n) h + b(X_n) \\Delta W_n$ 的数值格式，并且必须选择如何模拟布朗增量 $\\Delta W_n$ 并确保各步之间的独立性，以支持强误差分析（例如，逐轨道的 $L^p$ 收敛）。下面哪个选项正确描述了一个生成具有所需分布和跨步独立性的 $\\Delta W_n$ 的统计上有效的程序？\n\nA. 初始化一次伪随机正态生成器，然后在每一步 $n$ 抽取一个独立的 $Z_n \\sim N(0,1)$ 并设置 $\\Delta W_n = \\sqrt{h}\\, Z_n$。不要在循环内重置种子；依赖生成器的流来产生独立的抽样。\n\nB. 在每一步 $n$，用相同的固定种子重新初始化随机数生成器，抽取 $Z_n \\sim N(0,1)$，并设置 $\\Delta W_n = \\sqrt{h}\\, Z_n$，以确保循环内的可复现性。\n\nC. 对于每一步 $n$，独立地抽取 $U_n \\sim \\mathrm{Unif}(-\\sqrt{3h},\\sqrt{3h})$，使得 $\\mathbb{E}[U_n]=0$ 和 $\\mathrm{Var}(U_n)=h$，并设置 $\\Delta W_n = U_n$，以匹配 $N(0,h)$ 的前两阶矩。\n\nD. 通过诸如 Box–Muller 变换之类的方法生成独立的标准正态随机变量 $Z_n \\sim N(0,1)$，并设置 $\\Delta W_n = h\\, Z_n$ 以反映时间步长。\n\nE. 在时间步之间使用对偶变量以减少蒙特卡洛方差：对于每对时间步 $(2k,2k+1)$，抽取一个 $Z \\sim N(0,1)$ 并设置 $\\Delta W_{2k} = \\sqrt{h}\\, Z$ 和 $\\Delta W_{2k+1} = -\\sqrt{h}\\, Z$。", "solution": "维纳过程 $W_t$ 由以下基本性质刻画：$W_0=0$，样本路径是连续的，不相交区间上的增量是独立的，并且对于 $0 \\le s < t$，增量 $W_t - W_s$ 服从均值为 $0$、方差为 $t-s$ 的正态分布。在均匀网格 $t_n = n h$ 上，可以得出 $\\Delta W_n := W_{t_{n+1}} - W_{t_n} \\sim N(0,h)$，并且对于不相交的时间步，族 $\\{\\Delta W_n\\}_{n\\ge 0}$ 必须是相互独立的。强误差分析（例如，证明当 $h \\to 0$ 时 $\\mathbb{E}\\big[\\sup_{0\\le n\\le N} |X_{t_n} - X_n|^p\\big]^{1/p}$ 以给定速率衰减）关键地依赖于这些增量性质，以保持鞅结构并使用诸如 Burkholder–Davis–Gundy 不等式之类的工具。因此，模拟必须生成在各步之间独立且精确服从方差为 $h$ 的高斯分布的增量。\n\n获得 $\\Delta W_n \\sim N(0,h)$ 的一种有原则的方法是抽取独立的标准正态随机变量 $Z_n \\sim N(0,1)$ 并设置\n$$\n\\Delta W_n = \\sqrt{h}\\, Z_n.\n$$\n通过 $\\sqrt{h}$ 进行缩放确保了 $\\mathrm{Var}(\\Delta W_n) = h \\cdot \\mathrm{Var}(Z_n) = h$，而 $Z_n$ 的独立性意味着 $\\Delta W_n$ 的独立性。在实践中使用伪随机数生成器时，人们会一次性初始化生成器以固定其流，然后重复调用它以获得独立的抽样；应避免在循环内重置种子，因为它可能导致相关性或重复。\n\n我们现在分析每个选项：\n\nA. 初始化一次伪随机正态生成器，抽取独立的 $Z_n \\sim N(0,1)$，并设置 $\\Delta W_n = \\sqrt{h}\\, Z_n$，且不在循环内重置种子。这符合所需的分布：由于 $\\sqrt{h}$ 的缩放，$\\Delta W_n$ 是均值为 $0$、方差为 $h$ 的高斯分布。通过使用独立的 $Z_n$ 抽样来实现独立性。不在循环内重置种子是保持生成器流独立性的正确实践方法。结论：正确。\n\nB. 在每一步都用相同的固定种子重置生成器，然后抽取 $Z_n \\sim N(0,1)$ 并设置 $\\Delta W_n = \\sqrt{h}\\, Z_n$。每次用相同的种子重置通常会重复产生相同的序列元素，使得 $\\Delta W_n$ 在各步之间完全相关。即使实现细节有所不同，这种做法也有产生强相关性的风险，对于需要独立增量的强误差分析来说是不可接受的。结论：不正确。\n\nC. 使用独立的均匀随机变量 $U_n \\sim \\mathrm{Unif}(-\\sqrt{3h},\\sqrt{3h})$，使得均值为 $0$、方差为 $h$，并设置 $\\Delta W_n = U_n$。虽然如果 $U_n$ 是独立的，那么独立性成立，并且前两阶矩与 $N(0,h)$ 的相匹配，但布朗增量的分布律明确是高斯分布，而非均匀分布。用非高斯分布替换 $N(0,h)$ 会改变驱动噪声，并使由 $W_t$ 驱动的格式进行强收敛分析所需的逐轨道性质无效。矩匹配有时用于弱逼近，但不适用于布朗运动的强逼近。结论：不正确。\n\nD. 使用一个正确的正态生成器，但按 $\\Delta W_n = h\\, Z_n$ 进行缩放。这将得到 $\\mathrm{Var}(\\Delta W_n) = h^2$，而不是 $h$，因此增量不具有正确的分布。正确的缩放因子是 $\\sqrt{h}$，而不是 $h$。结论：不正确。\n\nE. 在连续的时间步上使用对偶变量：$\\Delta W_{2k} = \\sqrt{h}\\, Z$, $\\Delta W_{2k+1} = -\\sqrt{h}\\, Z$。尽管每个边际分布都具有正确的 $N(0,h)$ 分布，但这种构造在相邻增量之间强加了完全负相关，违反了布朗增量在不相交区间上的独立性。对偶变量在独立的重复试验之间可能有用，但不能用于单个路径的时间步之间。结论：不正确。\n\n因此，唯一能为强误差分析正确地模拟具有所需分布和跨步独立性的布朗增量的选项是 A。", "answer": "$$\\boxed{A}$$", "id": "3079040"}, {"introduction": "在正确生成噪声之后，下一步是理解它是如何导致数值误差的。本练习提供了一个动手分析推导，用于计算欧拉-丸山（Euler-Maruyama）格式的局部均方误差。通过剖析单个时间步长上的误差，我们可以深入了解该格式的行为及其收敛阶的来源，体会理论分析在数值方法评估中的力量。[@problem_id:3079032]", "problem": "考虑随机微分方程 (SDE) $dX_{t}=\\alpha X_{t}\\,dt+\\beta X_{t}\\,dW_{t}$，其中 $\\alpha\\in\\mathbb{R}$ 和 $\\beta\\in\\mathbb{R}$ 为常数，$W_{t}$ 是一个标准布朗运动。令 $t_{n}=nh$，其中 $h>0$ 为固定步长，并假设数值近似是从精确初值 $X_{t_{n}}=x$ 出发，使用欧拉-丸山格式\n$$\n\\widehat{X}_{n+1}=x+\\alpha x\\,h+\\beta x\\,\\Delta W_{n},\n$$\n进行推进，其中 $\\Delta W_{n}=W_{t_{n+1}}-W_{t_{n}}$。\n\n从布朗运动和伊藤微积分的核心定义出发，并且不使用任何关于强误差的捷径公式，完成以下任务：\n\n- 推导单步精确解 $X_{t_{n+1}}$，用 $x$、$h$ 和 $\\Delta W_{n}$ 表示。\n- 仅使用布朗运动的定义性质，计算布朗矩 $\\mathbb{E}\\!\\left[(\\Delta W_{n})^{2}\\right]$ 和 $\\mathbb{E}\\!\\left[\\int_{t_{n}}^{t_{n+1}}\\big(W_{s}-W_{t_{n}}\\big)\\,ds\\right]$。\n- 使用这些计算结果，计算主阶渐近（当 $h\\to 0$ 时）的局部均方单步误差\n$$\nL(h;x)\\coloneqq\\mathbb{E}\\!\\left[\\big|X_{t_{n+1}}-\\widehat{X}_{n+1}\\big|^{2}\\,\\big|\\,X_{t_{n}}=x\\right]\n$$\n精确到并包含 $h^{2}$ 阶项，忽略更小阶的误差。将你的最终答案表示为关于 $\\alpha$、$\\beta$、$x$ 和 $h$ 的单个闭式解析表达式。最终答案中不要包含不等式或大$\\mathcal{O}$记号。", "solution": "问题陈述经审查后被认为是有效的。这是一个在计算随机微积分领域内适定的、有科学依据的问题，不包含任何矛盾或含糊之处。\n\n该问题要求对几何布朗运动过程的欧拉-丸山近似进行一个分为三部分的推导。我们将依次处理每个部分。\n\n给定的随机微分方程 (SDE) 为\n$$\ndX_{t}=\\alpha X_{t}\\,dt+\\beta X_{t}\\,dW_{t}\n$$\n初始条件为 $X_{t_n} = x$。在步长为 $h=t_{n+1}-t_n$ 的单步上，欧拉-丸山近似为\n$$\n\\widehat{X}_{n+1}=x+\\alpha x\\,h+\\beta x\\,\\Delta W_{n}\n$$\n其中 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$。\n\n**第一部分：单步精确解的推导**\n\n为了求得 $X_t$ 的精确解，我们考虑函数 $f(X_t) = \\ln(X_t)$。我们应用伊藤引理来求微分 $d(\\ln X_t)$。函数 $f(x)=\\ln(x)$ 的导数是 $f'(x) = 1/x$ 和 $f''(x) = -1/x^2$。根据伊藤引理，\n$$\nd(\\ln X_t) = f'(X_t) dX_t + \\frac{1}{2} f''(X_t) (dX_t)^2\n$$\n二次变差项 $(dX_t)^2$ 使用伊藤乘法规则 $(dt)^2=0$、$dt\\,dW_t=0$ 和 $(dW_t)^2=dt$ 计算：\n$$\n(dX_t)^2 = (\\alpha X_t dt + \\beta X_t dW_t)^2 = (\\beta X_t)^2(dW_t)^2 = \\beta^2 X_t^2 dt\n$$\n将 $dX_t$ 和 $(dX_t)^2$ 代入引理得到：\n$$\nd(\\ln X_t) = \\frac{1}{X_t}(\\alpha X_t dt + \\beta X_t dW_t) + \\frac{1}{2}\\left(-\\frac{1}{X_t^2}\\right)(\\beta^2 X_t^2 dt)\n$$\n$$\nd(\\ln X_t) = (\\alpha dt + \\beta dW_t) - \\frac{1}{2}\\beta^2 dt = \\left(\\alpha - \\frac{1}{2}\\beta^2\\right)dt + \\beta dW_t\n$$\n这个得到的关于 $\\ln X_t$ 的SDE具有常系数。我们将其从 $t_n$ 积分到 $t_{n+1}$：\n$$\n\\int_{t_n}^{t_{n+1}} d(\\ln X_s) = \\int_{t_n}^{t_{n+1}} \\left(\\alpha - \\frac{1}{2}\\beta^2\\right)ds + \\int_{t_n}^{t_{n+1}} \\beta dW_s\n$$\n$$\n\\ln(X_{t_{n+1}}) - \\ln(X_{t_n}) = \\left(\\alpha - \\frac{1}{2}\\beta^2\\right)(t_{n+1}-t_n) + \\beta (W_{t_{n+1}}-W_{t_n})\n$$\n使用 $h=t_{n+1}-t_n$、$\\Delta W_n = W_{t_{n+1}}-W_{t_n}$ 以及条件 $X_{t_n}=x$：\n$$\n\\ln(X_{t_{n+1}}) = \\ln(x) + \\left(\\alpha - \\frac{1}{2}\\beta^2\\right)h + \\beta\\Delta W_n\n$$\n对两边取指数，得到单步区间的精确解：\n$$\nX_{t_{n+1}} = x \\exp\\left(\\left(\\alpha - \\frac{1}{2}\\beta^2\\right)h + \\beta\\Delta W_n\\right)\n$$\n\n**第二部分：布朗矩的计算**\n\n我们基于标准布朗运动 $W_t$ 的定义性质来计算两个指定的期望。\n\n第一个矩：$\\mathbb{E}\\!\\left[(\\Delta W_{n})^{2}\\right]$。\n标准布朗运动的一个关键性质是，对于任意 $t>s$，增量 $W_t-W_s$ 是一个随机变量，服从均值为 $0$、方差为 $t-s$ 的正态分布。在我们的情况中，$\\Delta W_n = W_{t_{n+1}}-W_{t_n}$ 对应于长度为 $h=t_{n+1}-t_n$ 的区间。因此，$\\Delta W_n \\sim \\mathcal{N}(0, h)$。\n方差定义为 $\\text{Var}(\\Delta W_n) = \\mathbb{E}[(\\Delta W_n - \\mathbb{E}[\\Delta W_n])^2]$。由于 $\\mathbb{E}[\\Delta W_n] = 0$，方差就是二阶矩：\n$$\n\\mathbb{E}\\!\\left[(\\Delta W_{n})^{2}\\right] = \\text{Var}(\\Delta W_n) = h\n$$\n\n第二个矩：$\\mathbb{E}\\!\\left[\\int_{t_{n}}^{t_{n+1}}\\big(W_{s}-W_{t_{n}}\\big)\\,ds\\right]$。\n我们可以根据 Fubini 定理交换期望和积分的顺序（因为被积函数是良态的）：\n$$\n\\mathbb{E}\\!\\left[\\int_{t_{n}}^{t_{n+1}}\\big(W_{s}-W_{t_{n}}\\big)\\,ds\\right] = \\int_{t_{n}}^{t_{n+1}}\\mathbb{E}\\!\\left[W_{s}-W_{t_{n}}\\right]\\,ds\n$$\n对于任何 $s > t_n$，增量 $W_s - W_{t_n}$ 的均值为零，即 $\\mathbb{E}[W_s - W_{t_n}] = 0$。因此，积分变为：\n$$\n\\int_{t_{n}}^{t_{n+1}} 0 \\,ds = 0\n$$\n\n**第三部分：局部均方单步误差的计算**\n\n局部均方单步误差定义为 $L(h;x) \\coloneqq \\mathbb{E}\\!\\left[\\big|X_{t_{n+1}}-\\widehat{X}_{n+1}\\big|^{2}\\,\\big|\\,X_{t_{n}}=x\\right]$。由于该SDE是针对一个实值过程，我们可以将其写为在条件 $X_{t_n}=x$ 下的 $\\mathbb{E}\\!\\left[(X_{t_{n+1}}-\\widehat{X}_{n+1})^{2}\\right]$。\n我们展开平方项：\n$$\nL(h;x) = \\mathbb{E}[X_{t_{n+1}}^2] - 2\\mathbb{E}[X_{t_{n+1}}\\widehat{X}_{n+1}] + \\mathbb{E}[\\widehat{X}_{n+1}^2]\n$$\n我们将分别计算每个期望，并将结果按 $h$ 的幂级数展开至 $h^2$ 阶。我们使用这样一个性质：对于一个正态随机变量 $Z \\sim \\mathcal{N}(\\mu, \\sigma^2)$，其矩生成函数为 $\\mathbb{E}[e^{tZ}] = \\exp(t\\mu + \\frac{1}{2}t^2\\sigma^2)$。这里，$\\Delta W_n \\sim \\mathcal{N}(0,h)$。\n\n1.  $\\mathbb{E}[X_{t_{n+1}}^2]$:\n    $X_{t_{n+1}}^2 = x^2 \\exp\\left(2\\left(\\alpha - \\frac{1}{2}\\beta^2\\right)h + 2\\beta\\Delta W_n\\right)$。\n    $\\mathbb{E}[X_{t_{n+1}}^2] = x^2 \\exp\\left((2\\alpha - \\beta^2)h\\right) \\mathbb{E}\\left[\\exp(2\\beta\\Delta W_n)\\right]$。\n    对 $\\Delta W_n$ 使用矩生成函数，其中 $t=2\\beta$：$\\mathbb{E}[\\exp(2\\beta\\Delta W_n)] = \\exp(\\frac{1}{2}(2\\beta)^2 h) = \\exp(2\\beta^2 h)$。\n    $\\mathbb{E}[X_{t_{n+1}}^2] = x^2 \\exp((2\\alpha-\\beta^2)h) \\exp(2\\beta^2 h) = x^2 \\exp((2\\alpha+\\beta^2)h)$。\n    按 $h$ 展开：\n    $\\mathbb{E}[X_{t_{n+1}}^2] = x^2\\left(1 + (2\\alpha+\\beta^2)h + \\frac{1}{2}(2\\alpha+\\beta^2)^2 h^2 + O(h^3)\\right)$\n    $= x^2\\left(1 + (2\\alpha+\\beta^2)h + (2\\alpha^2+2\\alpha\\beta^2+\\frac{1}{2}\\beta^4)h^2 + O(h^3)\\right)$。\n\n2.  $\\mathbb{E}[\\widehat{X}_{n+1}^2]$:\n    $\\widehat{X}_{n+1}^2 = (x+\\alpha x h+\\beta x \\Delta W_n)^2 = x^2((1+\\alpha h) + \\beta\\Delta W_n)^2$。\n    $\\mathbb{E}[\\widehat{X}_{n+1}^2] = x^2\\mathbb{E}\\left[(1+\\alpha h)^2 + 2\\beta(1+\\alpha h)\\Delta W_n + \\beta^2(\\Delta W_n)^2\\right]$。\n    由于 $\\mathbb{E}[\\Delta W_n]=0$ 且 $\\mathbb{E}[(\\Delta W_n)^2]=h$：\n    $\\mathbb{E}[\\widehat{X}_{n+1}^2] = x^2((1+\\alpha h)^2 + \\beta^2 h) = x^2(1+2\\alpha h + \\alpha^2 h^2 + \\beta^2 h)$。\n\n3.  $\\mathbb{E}[X_{t_{n+1}}\\widehat{X}_{n+1}]$:\n    $X_{t_{n+1}}\\widehat{X}_{n+1} = x \\exp\\left(\\left(\\alpha - \\frac{1}{2}\\beta^2\\right)h + \\beta\\Delta W_n\\right) \\cdot x(1+\\alpha h + \\beta \\Delta W_n)$。\n    令 $c = \\alpha-\\frac{1}{2}\\beta^2$。该期望为\n    $x^2\\mathbb{E}\\left[\\exp(ch+\\beta\\Delta W_n)(1+\\alpha h + \\beta\\Delta W_n)\\right] = x^2\\left((1+\\alpha h)\\mathbb{E}[e^{ch+\\beta\\Delta W_n}] + \\beta\\mathbb{E}[\\Delta W_n e^{ch+\\beta\\Delta W_n}]\\right)$。\n    括号内的第一项是 $(1+\\alpha h)e^{ch}\\mathbb{E}[e^{\\beta\\Delta W_n}] = (1+\\alpha h)e^{ch}e^{\\beta^2h/2} = (1+\\alpha h)e^{\\alpha h}$。\n    对于第二项，我们使用 $Z \\sim \\mathcal{N}(0,\\sigma^2)$ 的性质 $\\mathbb{E}[Z e^{kZ}] = k\\sigma^2 \\mathbb{E}[e^{kZ}]$。这里 $Z=\\Delta W_n$，$k=\\beta$。\n    $\\beta\\mathbb{E}[\\Delta W_n e^{\\beta\\Delta W_n}] = \\beta(\\beta h)\\mathbb{E}[e^{\\beta\\Delta W_n}] = \\beta^2 h e^{\\beta^2h/2}$。\n    所以，$\\beta e^{ch}\\mathbb{E}[\\Delta W_n e^{\\beta\\Delta W_n}] = \\beta e^{ch}\\beta^2 h e^{\\beta^2h/2} = \\beta^2 h e^{\\alpha h}$。\n    合并得，$\\mathbb{E}[X_{t_{n+1}}\\widehat{X}_{n+1}] = x^2((1+\\alpha h)e^{\\alpha h} + \\beta^2 h e^{\\alpha h}) = x^2(1+\\alpha h+\\beta^2 h)e^{\\alpha h}$。\n    按 $h$ 展开：\n    $x^2(1+\\alpha h+\\beta^2 h)(1+\\alpha h+\\frac{1}{2}\\alpha^2h^2+O(h^3))$\n    $= x^2(1 + \\alpha h + \\frac{1}{2}\\alpha^2h^2 + \\alpha h + \\alpha^2h^2 + \\beta^2h + \\alpha\\beta^2h^2 + O(h^3))$\n    $= x^2(1+2\\alpha h+\\beta^2 h + (\\frac{3}{2}\\alpha^2+\\alpha\\beta^2)h^2 + O(h^3))$。\n\n最后，我们组合 $L(h;x) = \\mathbb{E}[X_{t_{n+1}}^2] - 2\\mathbb{E}[X_{t_{n+1}}\\widehat{X}_{n+1}] + \\mathbb{E}[\\widehat{X}_{n+1}^2]$。我们按 $h$ 的幂次收集各项：\n-   $h^0$ 项：$x^2(1-2(1)+1) = 0$。\n-   $h^1$ 项：$x^2h((2\\alpha+\\beta^2) - 2(2\\alpha+\\beta^2) + (2\\alpha+\\beta^2)) = 0$。\n\n$h^0$ 和 $h^1$ 项的缺失表明局部强收敛阶至少为 $1$。主项将是 $h^2$ 阶。我们收集 $x^2h^2$ 的系数：\n-   来自 $\\mathbb{E}[X_{t_{n+1}}^2]$: $2\\alpha^2+2\\alpha\\beta^2+\\frac{1}{2}\\beta^4$。\n-   来自 $-2\\mathbb{E}[X_{t_{n+1}}\\widehat{X}_{n+1}]$: $-2(\\frac{3}{2}\\alpha^2+\\alpha\\beta^2) = -3\\alpha^2 - 2\\alpha\\beta^2$。\n-   来自 $\\mathbb{E}[\\widehat{X}_{n+1}^2]$: $\\alpha^2$。\n\n将 $h^2$ 的系数求和：\n$(2\\alpha^2+2\\alpha\\beta^2+\\frac{1}{2}\\beta^4) + (-3\\alpha^2 - 2\\alpha\\beta^2) + \\alpha^2 = (2-3+1)\\alpha^2 + (2-2)\\alpha\\beta^2 + \\frac{1}{2}\\beta^4 = \\frac{1}{2}\\beta^4$。\n\n因此，精确到并包含 $h^2$ 阶项的局部均方单步误差为：\n$$\nL(h;x) = \\frac{1}{2}x^2\\beta^4h^2 + O(h^3)\n$$\n问题要求误差精确到 $h^2$ 阶，忽略更小阶的项。因此，最终表达式为 $\\frac{1}{2}x^2\\beta^4h^2$。", "answer": "$$ \\boxed{\\frac{1}{2}x^2\\beta^4h^2} $$", "id": "3079032"}, {"introduction": "虽然理论分析给出了预期的收敛速度，但在实践中，我们必须通过模拟来验证这些结果。最后一个练习将理论与实践相结合，展示了如何使用蒙特卡洛方法来估计强误差。更重要的是，它教会我们如何运用统计工具从模拟数据中可靠地确定收敛阶，这填补了抽象理论与计算科学之间的鸿沟。[@problem_id:3079024]", "problem": "考虑一个带有加性噪声的标量伊藤随机微分方程，已知欧拉-丸山（Euler–Maruyama）方法对此类方程具有近似为1阶 ($r \\approx 1$) 的强收敛性。设 $X_T$ 表示终端时刻 $T$ 的精确解，而 $X_T^h$ 表示时间步长为 $h$ 的数值近似解。将在终端时刻 $T$ 的均方强误差定义为 $e(h) \\equiv \\left(\\mathbb{E}\\lvert X_T - X_T^h\\rvert^2\\right)^{1/2}$。你使用蒙特卡洛（MC）方法来近似 $e(h)$，其中用一个非常精细的参考解来代表 $X_T$。对于给定的 $h$，设 $Z(h) \\equiv \\lvert X_T - X_T^h\\rvert^2$。从 $M$ 个独立同分布的MC复制 $\\{Z^{(m)}(h)\\}_{m=1}^M$ 中，你记录下样本均值 $\\overline{Z}(h)$ 和样本标准差 $s_Z(h)$。假设 $M$ 很大，因此中心极限定理（CLT）适用于 $\\overline{Z}(h)$。\n\n你对三个步长 $h \\in \\{0.25, 0.125, 0.0625\\}$ 运行此过程，其中 $M = 1000$，并获得以下汇总统计数据：\n- 对于 $h = 0.25$：$\\overline{Z} = 0.0100$，$s_Z = 0.012$。\n- 对于 $h = 0.125$：$\\overline{Z} = 0.0025$，$s_Z = 0.0032$。\n- 对于 $h = 0.0625$：$\\overline{Z} = 0.00062$，$s_Z = 0.00085$。\n\n你希望：\n(i) 基于中心极限定理和适当的变换，为这些 $h$ 值下的 $e(h)$ 构建 $95\\%$ 的置信区间；以及\n(ii) 利用得到的误差棒，从对数-对数关系 $e(h) \\approx C h^r$ 中获得收敛率 $r$ 的可靠估计，并包含一个 $r$ 的保守置信区间。\n\n选择下面所有正确的陈述。\n\nA. 通过首先为 $\\mu_Z(0.25) \\equiv \\mathbb{E}[Z(0.25)]$ 构建一个 $95\\%$ 的置信区间 $\\overline{Z} \\pm 1.96\\, s_Z/\\sqrt{M}$，然后将单调映射 $x \\mapsto \\sqrt{x}$ 应用于区间的端点，可以得到一个 $e(0.25)$ 的有效 $95\\%$ 置信区间，结果约为 $\\left[\\sqrt{0.0100 - 1.96 \\cdot 0.012/\\sqrt{1000}},\\ \\sqrt{0.0100 + 1.96 \\cdot 0.012/\\sqrt{1000}}\\right] \\approx [0.0963,\\ 0.1037]$。\n\nB. 在 $\\mu_Z(0.25) \\approx \\overline{Z} = 0.0100$ 处，使用delta方法和变换 $g(x) = \\sqrt{x}$，可以得到一个 $e(0.25)$ 的近似 $95\\%$ 置信区间，其形式为 $g(\\overline{Z}) \\pm 1.96\\, g'(\\overline{Z}) \\cdot s_Z/\\sqrt{M}$，即约为 $0.10 \\pm 1.96 \\cdot \\left(\\frac{1}{2 \\sqrt{0.0100}}\\right)\\cdot \\frac{0.012}{\\sqrt{1000}} \\approx [0.0963,\\ 0.1037]$。\n\nC. 对于给定的三个 $h$ 值，基于 $y_i \\equiv \\log e(h_i)$ 对 $x_i \\equiv \\log h_i$ 的对数-对数图，斜率估计值 $r$ 约为 $r \\approx 1.00$；通过单调映射 $(\\log e(0.0625) - \\log e(0.25))/(\\log 0.0625 - \\log 0.25)$ 结合 $e(0.25)$ 和 $e(0.0625)$ 的 $95\\%$ 置信区间，可以得到一个 $r$ 的保守 $95\\%$ 置信区间，约为 $[0.95,\\ 1.06]$。\n\nD. 如果将 $\\log \\overline{Z}(h)$ 对 $\\log h$ 进行回归，该回归的斜率直接估计了 $e(h)$ 的强收敛阶 $r$，无需任何调整。\n\nE. $\\mu_Z(0.0625)$ 的一个 $95\\%$ 置信区间是 $[0.00054,\\ 0.00070]$，对其端点取平方根后，得到一个有效的 $e(0.0625)$ 的 $95\\%$ 置信区间，约为 $[0.0232,\\ 0.0265]$。\n\n选择所有适用的选项。", "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 问题考虑的是一个带有加性噪声的标量伊藤随机微分方程（SDE）。\n- 使用欧拉-丸山方法进行数值近似。\n- 理论强收敛阶被陈述为 $r \\approx 1$。\n- $X_T$ 是终端时刻 $T$ 的精确解。\n- $X_T^h$ 是步长为 $h$ 的数值解。\n- 均方强误差定义为 $e(h) \\equiv \\left(\\mathbb{E}\\lvert X_T - X_T^h\\rvert^2\\right)^{1/2}$。\n- 为了进行蒙特卡洛（MC）模拟，$X_T$ 由一个非常精细的参考解来近似。\n- 用于MC的随机变量是 $Z(h) \\equiv \\lvert X_T - X_T^h\\rvert^2$。其期望为 $\\mu_Z(h) = \\mathbb{E}[Z(h)]$。因此，$e(h) = \\sqrt{\\mu_Z(h)}$。\n- MC复制的数量是 $M = 1000$。这些复制是独立同分布的（i.i.d.）。\n- 提供了三个步长的汇总统计数据（样本均值 $\\overline{Z}(h)$ 和样本标准差 $s_Z(h)$）：\n    - 对于 $h_1 = 0.25$：$\\overline{Z}(h_1) = 0.0100$，$s_Z(h_1) = 0.012$。\n    - 对于 $h_2 = 0.125$：$\\overline{Z}(h_2) = 0.0025$，$s_Z(h_2) = 0.0032$。\n    - 对于 $h_3 = 0.0625$：$\\overline{Z}(h_3) = 0.00062$，$s_Z(h_3) = 0.00085$。\n- 假设中心极限定理（CLT）适用于 $\\overline{Z}(h)$。\n- 收敛关系为 $e(h) \\approx C h^r$。\n- 任务是 (i) 为 $e(h)$ 构建 $95\\%$ 置信区间（CIs），以及 (ii) 使用这些区间来估计 $r$ 及其 CI。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据。其背景——估计SDEs数值方法的强收敛阶——是计算数学中的一个标准课题。强误差的定义、蒙特卡洛模拟的使用、样本统计量以及中心极限定理都是标准的且应用正确。用细网格参考解替换未知的精确解 $X_T$ 是该领域常见且必要的做法。问题是适定的，有足够的数据和明确定义的目标。语言客观而精确。所提供的数据值是合理的。该问题没有违反任何无效标准。\n\n### 步骤3：结论与行动\n问题陈述有效。将提供完整的解答和选项评估。\n\n### 解题推导与选项分析\n\n这个问题的核心在于为一个参数及其变换后的版本构建置信区间。主要关注的参数是均方误差 $e(h)$。蒙特卡洛模拟为 $\\mu_Z(h) = \\mathbb{E}[Z(h)] = [e(h)]^2$ 提供了一个估计。\n\n根据中心极限定理，对于大样本量 $M$，样本均值 $\\overline{Z}(h)$ 近似服从以真实均值 $\\mu_Z(h)$ 为中心的正态分布，其标准差由均值标准误 $SE(\\overline{Z}(h)) = s_Z(h)/\\sqrt{M}$ 估计。\n$\\mu_Z(h)$ 的一个 $95\\%$ 置信区间由 $\\overline{Z}(h) \\pm z_{0.025} \\frac{s_Z(h)}{\\sqrt{M}}$ 给出，其中 $z_{0.025} \\approx 1.96$ 是标准正态分布的临界值。给定 $M=1000$，$\\sqrt{M} \\approx 31.623$。\n\n我们想要 $e(h) = \\sqrt{\\mu_Z(h)}$ 的置信区间。这需要对 $\\mu_Z(h)$ 的置信区间进行变换。\n\n**选项A分析：**\n该选项建议通过先为 $\\mu_Z(0.25)$ 构建一个置信区间，然后将函数 $g(x) = \\sqrt{x}$ 应用于该区间的端点来找到 $e(0.25)$ 的置信区间。由于 $g(x)$ 对于 $x>0$ 是一个单调递增函数，这是一种标准且有效的变换置信区间的方法。\n\n我们来验证 $h=0.25$ 的计算：\n- $\\overline{Z}(0.25) = 0.0100$，$s_Z(0.25) = 0.012$。\n- 标准误是 $SE(\\overline{Z}(0.25)) = 0.012 / \\sqrt{1000} \\approx 0.0003795$。\n- 误差范围是 $1.96 \\times SE(\\overline{Z}(0.25)) \\approx 1.96 \\times 0.0003795 \\approx 0.0007438$。\n- $\\mu_Z(0.25)$ 的 $95\\%$ 置信区间是 $0.0100 \\pm 0.0007438$，即约为 $[0.009256, 0.010744]$。\n- 对端点应用平方根变换，得到 $e(0.25)$ 的置信区间：\n  - 下界：$\\sqrt{0.009256} \\approx 0.09621$。\n  - 上界：$\\sqrt{0.010744} \\approx 0.10365$。\n- 所以，置信区间约为 $[0.0962, 0.1037]$。选项中陈述的区间约为 $[0.0963, 0.1037]$。这是一个非常接近的近似值，仅在下界的第四位小数上有差异。其方法论是完全正确的。\n- 结论：**正确**。\n\n**选项B分析：**\n该选项建议使用delta方法。对于一个函数 $g(x)$，delta方法将 $g(\\overline{Z})$ 的方差近似为 $\\text{Var}(g(\\overline{Z})) \\approx [g'(\\mu_Z)]^2 \\text{Var}(\\overline{Z})$。由此得到的 $g(\\mu_Z)$ 的置信区间是 $g(\\overline{Z}) \\pm z_{\\alpha/2} |g'(\\overline{Z})| SE(\\overline{Z})$。这是一种标准的渐近方法。\n\n我们来验证 $h=0.25$ 且 $g(x)=\\sqrt{x}$ 的情况：\n- $e(0.25)$ 的点估计是 $g(\\overline{Z}(0.25)) = \\sqrt{0.0100} = 0.1$。\n- 导数是 $g'(x) = 1/(2\\sqrt{x})$。在 $\\overline{Z}=0.01$ 处，$g'(\\overline{Z}) = 1/(2\\sqrt{0.01}) = 1/0.2 = 5$。\n- $e(0.25)$ 的标准误约为 $|g'(\\overline{Z})| \\times SE(\\overline{Z}) \\approx 5 \\times 0.0003795 = 0.0018975$。\n- $e(0.25)$ 的误差范围是 $1.96 \\times 0.0018975 \\approx 0.003719$。\n- $95\\%$ 置信区间是 $0.1 \\pm 0.003719$，即 $[0.096281, 0.103719]$，约等于 $[0.0963, 0.1037]$。\n- 选项中的公式和数值结果与此推导一致。Delta方法是一个有效的程序。\n- 结论：**正确**。\n\n**选项D分析：**\n该选项声称，将 $\\log \\overline{Z}(h)$ 对 $\\log h$ 进行回归所得的斜率直接估计了 $r$。\n根据问题定义，我们有以下关系：\n$e(h) \\approx C h^r$\n$e(h) = \\sqrt{\\mu_Z(h)}$\n$e(h)$ 的一个估计量是 $\\sqrt{\\overline{Z}(h)}$。\n所以，$\\sqrt{\\overline{Z}(h)} \\approx C h^r$。\n两边取自然对数：\n$\\log\\left(\\sqrt{\\overline{Z}(h)}\\right) = \\log(C) + r \\log(h)$\n$\\frac{1}{2} \\log\\left(\\overline{Z}(h)\\right) = \\log(C) + r \\log(h)$\n整理得到 $\\log(\\overline{Z}(h))$：\n$\\log(\\overline{Z}(h)) = 2\\log(C) + 2r \\log(h)$\n这是一个 $y = a + b x$ 形式的线性关系，其中 $y = \\log(\\overline{Z}(h))$ 且 $x = \\log(h)$。斜率为 $b = 2r$。\n因此，将 $\\log \\overline{Z}(h)$ 对 $\\log h$ 进行回归所得的斜率提供了对 $2r$ 的估计，而不是 $r$。必须将斜率除以2。关于无需调整的说法是错误的。\n- 结论：**不正确**。\n\n**选项E分析：**\n该选项提供了 $\\mu_Z(0.0625)$ 的一个置信区间以及随后的 $e(0.0625)$ 的置信区间。\n我们来计算 $\\mu_Z(0.0625)$ 的 $95\\%$ 置信区间：\n- $\\overline{Z}(0.0625) = 0.00062$，$s_Z(0.0625) = 0.00085$。\n- $SE(\\overline{Z}(0.0625)) = 0.00085 / \\sqrt{1000} \\approx 0.00002688$。\n- 误差范围：$1.96 \\times 0.00002688 \\approx 0.00005268$。\n- $\\mu_Z(0.0625)$ 的 $95\\%$ 置信区间是 $0.00062 \\pm 0.00005268$，即 $[0.00056732, 0.00067268]$，或约等于 $[0.00057, 0.00067]$。\n- 选项中陈述的置信区间是 $[0.00054, 0.00070]$。这在数值上是不正确的。所陈述的区间比一个 $95\\%$ 置信区间要宽得多。\n- 尽管该陈述的第二部分（对其自己陈述的区间端点取平方根）在算术上是正确的（$\\sqrt{0.00054} \\approx 0.0232$，$\\sqrt{0.00070} \\approx 0.0265$），但由于其前提不正确，整个论断无效。\n- 结论：**不正确**。\n\n**选项C分析：**\n该选项提出了两个论断：收敛率 $r$ 的一个估计值，以及 $r$ 的一个置信区间。\n\n(i) $r$ 的估计：\n收敛率 $r$ 是 $\\log e(h)$ 对 $\\log h$ 的斜率。我们可以使用点估计 $e(h_i) \\approx \\sqrt{\\overline{Z}(h_i)}$ 来估计这个斜率。为了得到一个稳定的估计，我们使用两个极值点 $h_1=0.25$ 和 $h_3=0.0625$。\n- $e(0.25)$ 的点估计 $\\approx \\sqrt{0.0100} = 0.1$。\n- $e(0.0625)$ 的点估计 $\\approx \\sqrt{0.00062} \\approx 0.0249$。\n- 斜率估计为 $\\hat{r} = \\frac{\\log(e(h_3)) - \\log(e(h_1))}{\\log(h_3) - \\log(h_1)} = \\frac{\\log(0.0249) - \\log(0.1)}{\\log(0.0625) - \\log(0.25)} = \\frac{-3.6929 - (-2.3026)}{-2.7726 - (-1.3863)} = \\frac{-1.3903}{-1.3863} \\approx 1.0029$。\n$r \\approx 1.00$ 的估计是准确的。\n\n(ii) $r$ 的置信区间：\n建议是使用 $e(0.25)$ 和 $e(0.0625)$ 的置信区间来构建 $r$ 的一个保守置信区间。斜率的公式是 $r = \\frac{\\log e(h_3) - \\log e(h_1)}{\\log h_3 - \\log h_1}$。分母是 $\\log(0.0625/0.25) = \\log(0.25) = -2\\log(2) \\approx -1.3863$，为负数。为了找到 $r = [r_L, r_U]$ 的置信区间，我们必须在 $e(h_1)$ 和 $e(h_3)$ 的置信区间上找到该表达式的最小值和最大值。\n- 设 $[e_1^L, e_1^U]$ 是 $e(h_1)$ 的置信区间。从A/B可知，这是 $[0.0963, 0.1037]$。\n- 设 $[e_3^L, e_3^U]$ 是 $e(h_3)$ 的置信区间。根据我们对E的计算，$\\mu_Z(h_3)$ 的正确置信区间是 $[0.0005673, 0.0006727]$。取平方根得到 $[e_3^L, e_3^U] \\approx [\\sqrt{0.0005673}, \\sqrt{0.0006727}] \\approx [0.02382, 0.02594]$。\n- 函数 $f(e_1, e_3) = (\\log e_3 - \\log e_1) / (\\text{负常数})$。其偏导数为 $\\partial r / \\partial e_1 = -1/(e_1 \\log(h_3/h_1))$ 和 $\\partial r / \\partial e_3 = 1/(e_3 \\log(h_3/h_1))$，其中 $\\log(h_3/h_1)$ 是负数。所以 $\\partial r / \\partial e_1 > 0$ 且 $\\partial r / \\partial e_3 < 0$。为了得到最小的 $r$，我们需要最小的 $e_1$ 和最大的 $e_3$。\n- 下界 $r_L$：使用最小的 $e_1$ ($e_1^L=0.0963$) 和最大的 $e_3$ ($e_3^U=0.02594$)。\n  $r_L = \\frac{\\log(0.02594) - \\log(0.0963)}{-1.3863} = \\frac{-3.6521 - (-2.3404)}{-1.3863} = \\frac{-1.3117}{-1.3863} \\approx 0.9462$。\n- 上界 $r_U$：使用最大的 $e_1$ ($e_1^U=0.1037$) 和最小的 $e_3$ ($e_3^L=0.02382$)。\n  $r_U = \\frac{\\log(0.02382) - \\log(0.1037)}{-1.3863} = \\frac{-3.7369 - (-2.2662)}{-1.3863} = \\frac{-1.4707}{-1.3863} \\approx 1.0609$。\n这给出了区间 $[0.946, 1.061]$。选项中陈述的置信区间约为 $[0.95, 1.06]$。四舍五入后这是正确的匹配。该方法对于获得保守区间是合理的。\n- 结论：**正确**。\n\n最终评估得出A、B和C是正确的。", "answer": "$$\\boxed{ABC}$$", "id": "3079024"}]}