{"hands_on_practices": [{"introduction": "为了真正理解高阶格式的价值，我们必须首先量化和理解最基本方法的局限性。本练习将引导你对一个标准测试问题——几何布朗运动，进行严格分析，以揭示欧拉-丸山（EM）法为何仅能达到 $0.5$ 阶的强收敛。通过这个推导，你将为后续学习更高级的格式奠定坚实的数学基础和直观认识。[@problem_id:3058155]", "problem": "考虑几何布朗运动 (GBM)，它被定义为标量随机微分方程 (SDE) 的唯一强解\n$$\n\\mathrm{d}X_t=\\mu X_t\\,\\mathrm{d}t+\\sigma X_t\\,\\mathrm{d}W_t,\\qquad X_0=x_0,\n$$\n其中 $W_t$ 是一个标准维纳过程，$\\mu,\\sigma,x_0$ 是实常数且 $\\sigma\\neq 0$。设 $T>0$ 为一固定值，并考虑使用均匀步长 $h>0$ 的欧拉-丸山 (EM) 方法，使得 $N=T/h\\in\\mathbb{N}$：\n$$\nX_{n+1}^{\\mathrm{EM}}=X_n^{\\mathrm{EM}}+\\mu X_n^{\\mathrm{EM}}\\,h+\\sigma X_n^{\\mathrm{EM}}\\,\\Delta W_n,\\qquad \\Delta W_n:=W_{t_{n+1}}-W_{t_n},\\quad t_n=nh,\\quad X_0^{\\mathrm{EM}}=x_0.\n$$\n仅使用伊藤积分的基本性质、维纳增量的独立性和高斯性，以及光滑函数在零点附近的泰勒展开，推导在时间 T 时的全局均方误差\n$$\n\\mathbb{E}\\bigl[|X_T-X_N^{\\mathrm{EM}}|^2\\bigr]\n$$\n关于 h 的领先阶渐近式，并证明当 h 很小时，它与 h 成正比。显式地确定常数\n$$\nC=\\lim_{h\\to 0}\\frac{1}{h}\\,\\mathbb{E}\\bigl[|X_T-X_N^{\\mathrm{EM}}|^2\\bigr]\n$$\n用 $x_0,\\mu,\\sigma$ 和 $T$ 的闭式解形式表示。你的最终答案必须是 C 的表达式。无需四舍五入，也不涉及单位。根据你的推导，总结为什么欧拉-丸山方法在几何布朗运动上达到 0.5 的强收敛阶。", "solution": "此问题要求推导几何布朗运动 (GBM) 的欧拉-丸山 (EM) 近似的全局均方误差的领先阶渐近式，并显式确定收敛常数 $C$。\n\n该问题具有科学依据，是适定且客观的。它是随机微分方程数值分析领域中一个标准的、非平凡的问题。所有必要信息均已提供，且前提与既定的数学原理一致。因此，该问题是有效的。\n\n设 SDE 的精确解为 $X_t$，在时间 $t_n = n h$ 的欧拉-丸山近似解为 $X_n^{\\mathrm{EM}}$。第 n 步的全局误差定义为 $e_n = X_{t_n} - X_n^{\\mathrm{EM}}$。初始条件匹配，因此 $e_0 = X_0 - X_0^{\\mathrm{EM}} = x_0 - x_0 = 0$。\n\n我们的目标是找到均方误差 $\\epsilon_n = \\mathbb{E}[|e_n|^2] = \\mathbb{E}[e_n^2]$ 的递推关系。\n误差从一步传播到下一步。第 n+1 步的误差由下式给出\n$$e_{n+1} = X_{t_{n+1}} - X_{n+1}^{\\mathrm{EM}}$$\n为分析此问题，我们引入一个辅助过程，即从精确解 $X_{t_n}$ 开始的单步 EM：\n$$\\hat{X}_{n+1} = X_{t_n} + \\mu X_{t_n} h + \\sigma X_{t_n} \\Delta W_n = X_{t_n}(1 + \\mu h + \\sigma \\Delta W_n)$$\n我们可以将误差 $e_{n+1}$ 分为两部分：\n$$e_{n+1} = (X_{t_{n+1}} - \\hat{X}_{n+1}) + (\\hat{X}_{n+1} - X_{n+1}^{\\mathrm{EM}})$$\n第一部分是局部截断误差，$L_{n+1} = X_{t_{n+1}} - \\hat{X}_{n+1}$。\n第二部分描述了前一步误差 $e_n$ 的传播：\n$$\\hat{X}_{n+1} - X_{n+1}^{\\mathrm{EM}} = X_{t_n}(1 + \\mu h + \\sigma \\Delta W_n) - X_n^{\\mathrm{EM}}(1 + \\mu h + \\sigma \\Delta W_n) = (X_{t_n} - X_n^{\\mathrm{EM}})(1+\\mu h + \\sigma \\Delta W_n) = e_n(1+\\mu h + \\sigma \\Delta W_n)$$\n因此，误差的递推关系为：\n$$e_{n+1} = e_n(1+\\mu h + \\sigma \\Delta W_n) + L_{n+1}$$\n现在，我们计算均方误差 $\\epsilon_{n+1} = \\mathbb{E}[e_{n+1}^2]$，取关于时间 $t_n$ 的滤子 $\\mathcal{F}_{t_n}$ 的条件期望。由于 $e_n$ 是 $\\mathcal{F}_{t_n}$-可测的，且 $L_{n+1}$ 和 $\\Delta W_n$ 独立于 $\\mathcal{F}_{t_n}$（因为SDE的系数仅依赖于 $X_t$）：\n$$\\mathbb{E}[e_{n+1}^2 | \\mathcal{F}_{t_n}] = \\mathbb{E}\\left[ \\left(e_n(1+\\mu h + \\sigma \\Delta W_n) + L_{n+1}\\right)^2 \\Big| \\mathcal{F}_{t_n} \\right]$$\n$$= \\mathbb{E}\\left[ e_n^2(1+\\mu h + \\sigma \\Delta W_n)^2 + L_{n+1}^2 + 2e_n(1+\\mu h + \\sigma \\Delta W_n)L_{n+1} \\Big| \\mathcal{F}_{t_n} \\right]$$\n$$= e_n^2 \\mathbb{E}[(1+\\mu h + \\sigma \\Delta W_n)^2] + \\mathbb{E}[L_{n+1}^2|\\mathcal{F}_{t_n}] + 2e_n \\mathbb{E}[(1+\\mu h + \\sigma \\Delta W_n)L_{n+1}|\\mathcal{F}_{t_n}]$$\n我们分别分析每一项。注意 $\\Delta W_n \\sim \\mathcal{N}(0, h)$，所以 $\\mathbb{E}[\\Delta W_n]=0$, $\\mathbb{E}[(\\Delta W_n)^2]=h$, $\\mathbb{E}[(\\Delta W_n)^3]=0$, 并且 $\\mathbb{E}[(\\Delta W_n)^4]=3h^2$。\n\n1.  **误差传播项：**\n    $$\\mathbb{E}[(1+\\mu h + \\sigma \\Delta W_n)^2] = (1+\\mu h)^2 + \\sigma^2 \\mathbb{E}[(\\Delta W_n)^2] = 1+2\\mu h+\\mu^2 h^2 + \\sigma^2 h = 1 + (2\\mu+\\sigma^2)h + O(h^2)$$\n\n2.  **局部误差方差：** 局部误差为 $L_{n+1} = \\int_{t_n}^{t_{n+1}} (X_s - X_{t_n}) \\mu ds + \\int_{t_n}^{t_{n+1}} (X_s - X_{t_n}) \\sigma dW_s$。\n    我们使用伊藤-泰勒展开来展开 $s \\in [t_n, t_{n+1}]$ 时的 $X_s - X_{t_n}$：\n    $$X_s - X_{t_n} = \\mu \\int_{t_n}^s X_u du + \\sigma \\int_{t_n}^s X_u dW_u \\approx \\mu X_{t_n} (s-t_n) + \\sigma X_{t_n} (W_s - W_{t_n})$$\n    将此代入 $L_{n+1}$ 的表达式中，得到包含迭代伊藤积分的项。领先的随机项来自 $\\sigma \\int (X_s-X_{t_n})dW_s$ 部分，具体为 $\\sigma^2 X_{t_n} \\int_{t_n}^{t_{n+1}} (W_s-W_{t_n})dW_s$。\n    使用伊藤公式，$\\int_{t_n}^{t_{n+1}} (W_s-W_{t_n})dW_s = \\frac{1}{2}((W_{t_{n+1}}-W_{t_n})^2 - (t_{n+1}-t_n)) = \\frac{1}{2}((\\Delta W_n)^2 - h)$。\n    $L_{n+1}$ 展开中的其他项是关于 h 的更高阶项。均方局部误差的主导项是：\n    $$\\mathbb{E}[L_{n+1}^2 | \\mathcal{F}_{t_n}] \\approx \\mathbb{E}\\left[ \\left( \\sigma^2 X_{t_n} \\frac{(\\Delta W_n)^2-h}{2} \\right)^2 \\Big| \\mathcal{F}_{t_n} \\right] = \\frac{1}{4}\\sigma^4 X_{t_n}^2 \\mathbb{E}[((\\Delta W_n)^2-h)^2]$$\n    $$\\mathbb{E}[((\\Delta W_n)^2-h)^2] = \\mathbb{E}[(\\Delta W_n)^4 - 2h(\\Delta W_n)^2 + h^2] = 3h^2 - 2h(h) + h^2 = 2h^2$$\n    因此，局部误差方差的领先项是：\n    $$\\mathbb{E}[L_{n+1}^2|\\mathcal{F}_{t_n}] = \\frac{1}{2}\\sigma^4 X_{t_n}^2 h^2 + O(h^3)$$\n\n3.  **交叉项：** $2e_n \\mathbb{E}[(1+\\mu h + \\sigma \\Delta W_n)L_{n+1}|\\mathcal{F}_{t_n}] = 2e_n \\left( (1+\\mu h)\\mathbb{E}[L_{n+1}|\\mathcal{F}_{t_n}] + \\sigma \\mathbb{E}[\\Delta W_n L_{n+1}|\\mathcal{F}_{t_n}] \\right)$。\n    详细计算表明，$\\mathbb{E}[L_{n+1}|\\mathcal{F}_{t_n}]$ 和 $\\mathbb{E}[\\Delta W_n L_{n+1}|\\mathcal{F}_{t_n}]$ 均为 $O(h^2)$ 阶。例如，$\\mathbb{E}[L_{n+1}|\\mathcal{F}_{t_n}] = X_{t_n}(\\exp(\\mu h)-1-\\mu h) = \\frac{1}{2}\\mu^2 X_{t_n} h^2 + O(h^3)$。这使得整个交叉项的阶为 $e_n X_{t_n} O(h^2)$。取完全期望并使用 Cauchy-Schwarz 不等式，$\\mathbb{E}[e_n X_{t_n}] \\le \\sqrt{\\mathbb{E}[e_n^2]\\mathbb{E}[X_{t_n}^2]} = \\sqrt{\\epsilon_n \\mathbb{E}[X_{t_n}^2]}$。由于我们预期 $\\epsilon_n = O(h)$，此项的贡献为 $O(h^{2.5})$，与 $O(h^2)$ 项相比可以忽略不计。\n\n结合主要项并取完全期望，我们得到 $\\epsilon_n=\\mathbb{E}[e_n^2]$ 的递推关系：\n$$\\epsilon_{n+1} = \\epsilon_n(1 + (2\\mu+\\sigma^2)h) + \\frac{1}{2}\\sigma^4 \\mathbb{E}[X_{t_n}^2]h^2 + O(h^{2.5})$$\n为了解此递推关系，我们求精确解的二阶矩：\n$$d(X_t^2) = (2\\mu X_t^2 + \\sigma^2 X_t^2)dt + 2\\sigma X_t^2 dW_t$$\n取期望，$\\frac{d}{dt}\\mathbb{E}[X_t^2] = (2\\mu+\\sigma^2)\\mathbb{E}[X_t^2]$。在 $\\mathbb{E}[X_0^2]=x_0^2$ 的条件下，解为：\n$$\\mathbb{E}[X_t^2] = x_0^2 \\exp((2\\mu+\\sigma^2)t)$$\n将此代入 $t=t_n$ 时 $\\epsilon_n$ 的递推关系中：\n$$\\epsilon_{n+1} \\approx \\epsilon_n(1 + (2\\mu+\\sigma^2)h) + \\frac{1}{2}\\sigma^4 x_0^2 \\exp((2\\mu+\\sigma^2)t_n)h^2$$\n设 $\\epsilon(t)$ 是一个在 $t_n=nh$ 处插值 $\\epsilon_n$ 的连续函数。对于小的 h，此递推关系可以近似为一个一阶常微分方程 (ODE)。设 $\\epsilon(t) \\approx \\epsilon_n$。\n$$\\frac{\\epsilon(t+h) - \\epsilon(t)}{h} \\approx (2\\mu+\\sigma^2)\\epsilon(t) + \\frac{1}{2}\\sigma^4 x_0^2 \\exp((2\\mu+\\sigma^2)t)h$$\n这表明 $\\epsilon(t)$ 是 h 的阶。我们设 $\\epsilon(t) = c(t)h$。将此假设代入 ODE：\n$$\\frac{c(t+h)h - c(t)h}{h} \\approx (2\\mu+\\sigma^2)c(t)h + \\frac{1}{2}\\sigma^4 x_0^2 \\exp((2\\mu+\\sigma^2)t)h$$\n两边除以 h：\n$$\\frac{c(t+h)-c(t)}{h} \\approx (2\\mu+\\sigma^2)c(t) + \\frac{1}{2}\\sigma^4 x_0^2 \\exp((2\\mu+\\sigma^2)t)$$\n在极限 $h\\to 0$ 时，这变成了比例因子 $c(t)$ 的 ODE：\n$$c'(t) = (2\\mu+\\sigma^2)c(t) + \\frac{1}{2}\\sigma^4 x_0^2 \\exp((2\\mu+\\sigma^2)t)$$\n初始条件是 $\\epsilon_0=0$，这意味着 $c(0)=0$。设 $A = 2\\mu+\\sigma^2$。该 ODE 为 $c'(t) = Ac(t) + \\frac{1}{2}\\sigma^4 x_0^2 e^{At}$。\n我们使用积分因子 $e^{-At}$ 来求解：\n$$(c(t)e^{-At})' = \\frac{1}{2}\\sigma^4 x_0^2 e^{At} e^{-At} = \\frac{1}{2}\\sigma^4 x_0^2$$\n从 0 到 T 积分：\n$$c(T)e^{-AT} - c(0)e^0 = \\int_0^T \\frac{1}{2}\\sigma^4 x_0^2 ds = \\frac{1}{2}\\sigma^4 x_0^2 T$$\n因为 $c(0)=0$，我们有：\n$$c(T) = \\frac{1}{2}\\sigma^4 x_0^2 T e^{AT} = \\frac{1}{2}\\sigma^4 x_0^2 T \\exp((2\\mu+\\sigma^2)T)$$\n在时间 T 的全局均方误差具有领先阶渐近行为：\n$$\\mathbb{E}[|X_T - X_N^{\\mathrm{EM}}|^2] = \\epsilon_N \\approx c(T)h = \\left(\\frac{1}{2}\\sigma^4 x_0^2 T \\exp((2\\mu+\\sigma^2)T)\\right)h$$\n这表明当 h 很小时，误差与 h 成正比。常数 C 是误差除以 h 的极限：\n$$C = \\lim_{h\\to 0}\\frac{1}{h}\\,\\mathbb{E}\\bigl[|X_T-X_N^{\\mathrm{EM}}|^2\\bigr] = c(T) = \\frac{1}{2}\\sigma^4 x_0^2 T \\exp((2\\mu+\\sigma^2)T)$$\n强收敛阶，记为 p，由不等式 $\\mathbb{E}[|X_T - X_N^{\\mathrm{EM}}|] \\le K h^p$ 定义，其中 K 为某个常数。根据 Jensen 不等式（或 Cauchy-Schwarz 不等式）：\n$$(\\mathbb{E}[|X_T - X_N^{\\mathrm{EM}}|])^2 \\le \\mathbb{E}[|X_T - X_N^{\\mathrm{EM}}|^2] \\approx Ch$$\n两边取平方根：\n$$\\mathbb{E}[|X_T - X_N^{\\mathrm{EM}}|] \\le \\sqrt{C h + O(h^2)} = \\sqrt{C}\\sqrt{h} + O(h)$$\n这意味着强收敛阶为 $p = 1/2 = 0.5$。", "answer": "$$\\boxed{\\frac{1}{2} T x_0^2 \\sigma^4 \\exp\\left(\\left(2\\mu + \\sigma^2\\right)T\\right)}$$", "id": "3058155"}, {"introduction": "在揭示了欧拉-丸山法的局限性之后，我们自然要寻求改进方案，而米尔斯坦法正是这样一个直接而有效的改进。本练习将展示，通过在格式中增加一个源于伊藤-泰勒展开的修正项，数值解能够更精确地逼近真实解的路径。完成此练习后，你将能够分析证明米尔斯坦法在几何布朗运动上达到了一阶强收敛，这是对欧拉-丸山法性能的显著提升。[@problem_id:3058125]", "problem": "考虑由以下随机微分方程定义的标量几何布朗运动 (GBM)：\n$$\ndX_{t} = \\mu X_{t}\\,dt + \\sigma X_{t}\\,dW_{t}, \\quad X_{0} = x_{0} > 0,\n$$\n其中 $\\mu \\in \\mathbb{R}$ 和 $\\sigma > 0$ 为常数，$W_{t}$ 是标准维纳过程。设 $h>0$ 为一个固定的时间步长，并令 $\\Delta W := W_{t+h} - W_{t}$ 表示单个步长内的布朗增量。应用于具有扩散系数 $g(x)$ 的标量 Itô 随机微分方程的 Milstein 方法，通过增加一个涉及空间导数 $g'(x)$ 的项来扩展 Euler-Maruyama 方法。在本例中，$g(x) = \\sigma x$ 且 $g'(x) = \\sigma$。\n\n您的任务如下。\n\n1) 仅使用 Itô 公式和布朗运动的基本性质，推导 $X_{t+h}$ 关于 $X_{t}$、$h$ 和 $\\Delta W$ 的精确表达式。然后，将您的表达式展开为随机级数，直到并包括所有 $L^{2}$ 范数大小为 $h$ 阶的项（也就是说，保留所有由 $h$ 和 $\\Delta W$ 构成且均方大小至少为 $h^{2}$ 阶的贡献项）。将您的结果表示为以下形式：\n$$\nX_{t+h} = X_{t} + A_{1}(X_{t})\\,h + A_{2}(X_{t})\\,\\Delta W + A_{3}(X_{t})\\big((\\Delta W)^{2} - h\\big) + R,\n$$\n其中 $R$ 是一个余项，您必须在 $L^{2}$ 中描述其性质。\n\n2) 仅使用 $\\mu$、$\\sigma$、$X_{t}$、$h$ 和 $\\Delta W$，写出此 GBM 在步长 $[t, t+h]$ 上的单步 Milstein 更新，并与您在第 1 部分展开式中的系数 $A_{1}(X_{t})$、$A_{2}(X_{t})$ 和 $A_{3}(X_{t})$ 进行匹配。推导局部缺陷的显式表达式\n$$\nD := \\big(X_{t+h} - X_{t}\\big) \\;-\\; \\Big[ \\mu X_{t}\\,h + \\sigma X_{t}\\,\\Delta W + \\tfrac{1}{2}\\sigma^{2} X_{t}\\,\\big((\\Delta W)^{2} - h\\big) \\Big],\n$$\n并证明其条件均方满足如下标度关系：\n$$\n\\mathbb{E}\\!\\left[\\,|D|^{2} \\,\\big|\\, \\mathcal{F}_{t}\\right] = \\mathcal{O}\\!\\left(h^{3}\\right),\n$$\n其中 $\\mathcal{F}_{t}$ 是截至时间 $t$ 的维纳过程的滤子（filtration）。\n\n3) 使用强收敛的标准定义（均方根误差）以及适用于 Lipschitz 系数的常规稳定性和相合性论证，得出 Milstein 方法对 GBM 在固定时间区间上实现的全局强收敛阶 $p$。仅报告 $p$ 的值作为最终答案，它是一个无单位的数字。无需四舍五入。", "solution": "问题要求分析应用于几何布朗运动 (GBM) 随机微分方程 (SDE) 的 Milstein 方法。分析分三部分进行：推导和展开精确解，分析单步数值方法及其局部误差，以及得出全局强收敛阶。\n\n**第 1 部分：精确解与随机泰勒展开**\n\n几何布朗运动的 SDE 由下式给出：\n$$\ndX_{t} = \\mu X_{t}\\,dt + \\sigma X_{t}\\,dW_{t}, \\quad X_{0} = x_{0} > 0\n$$\n其中 $\\mu \\in \\mathbb{R}$ 和 $\\sigma > 0$ 为常数，$W_{t}$ 是一个标准维纳过程。\n\n为了找到 $X_{t}$ 的精确解，我们对函数 $f(x) = \\ln(x)$ 应用 Itô 公式。其偏导数为 $f'(x) = \\frac{1}{x}$ 和 $f''(x) = -\\frac{1}{x^2}$。根据 Itô 引理，$Y_{t} = \\ln(X_{t})$ 的微分为：\n$$\ndY_{t} = d(\\ln X_{t}) = f'(X_{t})\\,dX_{t} + \\frac{1}{2}f''(X_{t})\\,(dX_{t})^{2}\n$$\n二次变差项 $(dX_{t})^{2}$ 使用 Itô 法则 $dt \\cdot dt = 0$、$dt \\cdot dW_{t} = 0$ 和 $dW_{t} \\cdot dW_{t} = dt$ 计算：\n$$\n(dX_{t})^{2} = (\\mu X_{t}\\,dt + \\sigma X_{t}\\,dW_{t})^{2} = \\sigma^{2} X_{t}^{2}\\,(dW_{t})^{2} = \\sigma^{2} X_{t}^{2}\\,dt\n$$\n将 $dX_{t}$ 和 $(dX_{t})^{2}$ 代入 $dY_{t}$ 的表达式中：\n$$\nd(\\ln X_{t}) = \\frac{1}{X_{t}}(\\mu X_{t}\\,dt + \\sigma X_{t}\\,dW_{t}) + \\frac{1}{2}\\left(-\\frac{1}{X_{t}^{2}}\\right)(\\sigma^{2} X_{t}^{2}\\,dt)\n$$\n$$\nd(\\ln X_{t}) = (\\mu\\,dt + \\sigma\\,dW_{t}) - \\frac{1}{2}\\sigma^{2}\\,dt = \\left(\\mu - \\frac{1}{2}\\sigma^{2}\\right)dt + \\sigma\\,dW_{t}\n$$\n将此 SDE 从时间 $t$ 积分到 $t+h$：\n$$\n\\int_{t}^{t+h} d(\\ln X_{s}) = \\int_{t}^{t+h} \\left(\\mu - \\frac{1}{2}\\sigma^{2}\\right)ds + \\int_{t}^{t+h} \\sigma\\,dW_{s}\n$$\n$$\n\\ln(X_{t+h}) - \\ln(X_{t}) = \\left(\\mu - \\frac{1}{2}\\sigma^{2}\\right)h + \\sigma(W_{t+h} - W_{t})\n$$\n定义布朗增量 $\\Delta W := W_{t+h} - W_{t}$，我们得到：\n$$\n\\ln\\left(\\frac{X_{t+h}}{X_{t}}\\right) = \\left(\\mu - \\frac{1}{2}\\sigma^{2}\\right)h + \\sigma\\,\\Delta W\n$$\n对两边取指数，得到 $X_{t+h}$ 的精确表达式：\n$$\nX_{t+h} = X_{t} \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^{2}\\right)h + \\sigma\\,\\Delta W \\right)\n$$\n接下来，我们将此表达式展开为随机级数。令 $Z = (\\mu - \\frac{1}{2}\\sigma^{2})h + \\sigma\\,\\Delta W$。使用指数函数的泰勒级数 $\\exp(Z) = 1 + Z + \\frac{Z^2}{2!} + \\frac{Z^3}{3!} + \\dots$，我们有：\n$$\nX_{t+h} = X_{t} \\left( 1 + Z + \\frac{1}{2}Z^{2} + \\frac{1}{6}Z^{3} + \\dots \\right)\n$$\n我们需要保留所有 $L^2$ 范数大小为 $h$ 阶或更大的项。基本标度关系为 $\\mathbb{E}[h^k] = h^k$ 和 $\\mathbb{E}[(\\Delta W)^{2k}] = \\frac{(2k)!}{2^k k!} h^k$。这意味着在 $L^2$ 中，$h$ 的大小为 $\\mathcal{O}(h)$，$\\Delta W$ 的大小为 $\\mathcal{O}(h^{1/2})$。因此，$(\\Delta W)^2$ 的大小为 $\\mathcal{O}(h)$。像 $h\\Delta W$ 和 $(\\Delta W)^3$ 这样的项大小为 $\\mathcal{O}(h^{3/2})$，并将成为余项的一部分。\n\n我们来展开 $Z$ 和 $Z^2$：\n$$\nZ = \\left(\\mu - \\frac{1}{2}\\sigma^{2}\\right)h + \\sigma\\,\\Delta W\n$$\n$$\nZ^{2} = \\sigma^{2}(\\Delta W)^{2} + 2\\sigma\\left(\\mu - \\frac{1}{2}\\sigma^{2}\\right)h\\,\\Delta W + \\left(\\mu - \\frac{1}{2}\\sigma^{2}\\right)^{2}h^{2}\n$$\n将这些代入 $X_{t+h}$ 的展开式中：\n$$\nX_{t+h} = X_{t} \\left[ 1 + \\left(\\mu - \\frac{1}{2}\\sigma^{2}\\right)h + \\sigma\\,\\Delta W + \\frac{1}{2}\\left(\\sigma^{2}(\\Delta W)^{2} + \\mathcal{O}(h^{3/2})\\right) + \\mathcal{O}(h^{3/2}) \\right]\n$$\n$$\nX_{t+h} = X_{t} + X_{t}\\left(\\mu - \\frac{1}{2}\\sigma^{2}\\right)h + X_{t}\\sigma\\,\\Delta W + \\frac{1}{2}X_{t}\\sigma^{2}(\\Delta W)^{2} + R_0\n$$\n其中 $R_0$ 包含所有 $L^2$ 范数大小为 $\\mathcal{O}(h^{3/2})$ 或更小的项。为了匹配所要求的形式，我们加上并减去项 $\\frac{1}{2}X_{t}\\sigma^{2}h$：\n$$\nX_{t+h} = X_{t} + X_{t}\\left(\\mu - \\frac{1}{2}\\sigma^{2}\\right)h + \\frac{1}{2}X_{t}\\sigma^{2}h + X_{t}\\sigma\\,\\Delta W + \\frac{1}{2}X_{t}\\sigma^{2}\\left((\\Delta W)^{2} - h\\right) + R_0\n$$\n$$\nX_{t+h} = X_{t} + (\\mu X_{t})h + (\\sigma X_{t})\\Delta W + \\left(\\frac{1}{2}\\sigma^{2}X_{t}\\right)\\left((\\Delta W)^{2} - h\\right) + R\n$$\n其中 $R=R_0$ 是余项。R 的主要贡献来自 $\\frac{1}{2}Z^2$ 展开式中的项 $\\frac{1}{2} X_t \\cdot (2\\sigma(\\mu - \\frac{1}{2}\\sigma^2)h\\Delta W)$ 和 $\\frac{1}{6}Z^3$ 中的项 $\\frac{1}{6}X_t \\cdot (\\sigma^3 (\\Delta W)^3)$。这些项的均方标度为 $\\mathbb{E}[(h\\Delta W)^2] = h^2 \\mathbb{E}[(\\Delta W)^2] = h^3$ 和 $\\mathbb{E}[((\\Delta W)^3)^2] = \\mathbb{E}[(\\Delta W)^6] = 15h^3$。因此，余项 $R$ 的条件均方大小为 $\\mathcal{O}(h^3)$，即 $\\mathbb{E}[|R|^2|\\mathcal{F}_t] = \\mathcal{O}(h^3)$。\n\n从这个展开式中，我们确定系数：\n$A_{1}(X_{t}) = \\mu X_{t}$\n$A_{2}(X_{t}) = \\sigma X_{t}$\n$A_{3}(X_{t}) = \\frac{1}{2}\\sigma^{2} X_{t}$\n\n**第 2 部分：Milstein 方法和局部缺陷**\n\n对于 SDE $dX_{t} = a(X_{t})dt + b(X_{t})dW_{t}$，其通用的单步 Milstein 更新由下式给出：\n$$\nY_{n+1} = Y_{n} + a(Y_{n})h + b(Y_{n})\\Delta W_{n} + \\frac{1}{2}b(Y_{n})b'(Y_{n})\\left((\\Delta W_{n})^{2} - h\\right)\n$$\n对于 GBM SDE，我们有 $a(x) = \\mu x$ 和 $b(x) = \\sigma x$。扩散系数的导数是 $b'(x) = \\sigma$。\n将这些代入 Milstein 公式，GBM 的单步更新为：\n$$\nX_{t+h}^{\\text{Milstein}} = X_{t} + (\\mu X_{t})h + (\\sigma X_{t})\\Delta W + \\frac{1}{2}(\\sigma X_{t})(\\sigma)\\left((\\Delta W)^{2} - h\\right)\n$$\n$$\nX_{t+h}^{\\text{Milstein}} = X_{t} + \\mu X_{t}h + \\sigma X_{t}\\Delta W + \\frac{1}{2}\\sigma^{2}X_{t}\\left((\\Delta W)^{2} - h\\right)\n$$\n将其与形式 $X_{t} + A_{1}(X_{t})h + A_{2}(X_{t})\\Delta W + A_{3}(X_{t})((\\Delta W)^{2} - h)$ 进行比较，我们确认了在第 1 部分中找到的系数：\n$A_{1}(X_{t}) = \\mu X_{t}$\n$A_{2}(X_{t}) = \\sigma X_{t}$\n$A_{3}(X_{t}) = \\frac{1}{2}\\sigma^{2} X_{t}$\n\n局部缺陷 $D$ 定义为精确增量与指定公式给出的数值增量之间的差：\n$$\nD := (X_{t+h} - X_{t}) - \\left[ \\mu X_{t}h + \\sigma X_{t}\\Delta W + \\frac{1}{2}\\sigma^{2} X_{t}\\left((\\Delta W)^{2} - h\\right) \\right]\n$$\n这正是我们在第 1 部分展开式中的余项 $R$，代表局部截断误差 $X_{t+h} - X_{t+h}^{\\text{Milstein}}$。\n$$\nD = X_{t+h} - X_{t+h}^{\\text{Milstein}}\n$$\n为了证明 $\\mathbb{E}[|D|^2 | \\mathcal{F}_{t}] = \\mathcal{O}(h^3)$，我们分析 $X_{t+h}$ 展开式中的高阶项。\n$$\nX_{t+h} = X_{t}\\exp(Z) = X_{t}\\left(1 + Z + \\frac{Z^2}{2} + \\frac{Z^3}{6} + \\mathcal{O}(Z^4)\\right)\n$$\n$$\nX_{t+h}^{\\text{Milstein}} = X_t \\left( 1 + (\\mu - \\frac{1}{2}\\sigma^2)h + \\sigma \\Delta W + \\frac{1}{2}\\sigma^2 (\\Delta W)^2 \\right) = X_t \\left(1 + Z + \\frac{1}{2}(\\sigma \\Delta W)^2 - \\frac{1}{2} Z^2 + \\frac{1}{2} Z^2\\right) - \\dots\n$$\n更直接的相减得到：\n$$\nD = X_{t} \\exp(Z) - X_t \\left( 1 + (\\mu - \\frac{1}{2}\\sigma^2)h + \\sigma \\Delta W + \\frac{1}{2}\\sigma^2 (\\Delta W)^2 \\right)\n$$\n$D/X_t = (1 + Z + \\frac{1}{2}Z^2 + \\frac{1}{6}Z^3 + \\dots) - (1 + (\\mu - \\frac{1}{2}\\sigma^2)h + \\sigma \\Delta W + \\frac{1}{2}\\sigma^2 (\\Delta W)^2)$。\n来自 $Z$ 的项 $1$、$(\\mu - \\frac{1}{2}\\sigma^2)h$ 和 $\\sigma \\Delta W$ 被消去。\n来自 $\\frac{1}{2}Z^2$ 的项 $\\frac{1}{2}\\sigma^2 (\\Delta W)^2$ 也被消去。\n$D/X_t$ 中剩下的主要项是 $\\frac{1}{2}Z^2$ 的其他项和 $\\frac{1}{6}Z^3$ 的主要项：\n$$\nD = X_t \\left( \\frac{1}{2} \\left[ 2\\sigma\\left(\\mu - \\frac{1}{2}\\sigma^{2}\\right)h\\,\\Delta W \\right] + \\frac{1}{6} \\left[ \\sigma^3 (\\Delta W)^3 \\right] + \\text{h.o.t.} \\right)\n$$\n$$\nD = X_t \\left( \\sigma\\left(\\mu - \\frac{1}{2}\\sigma^{2}\\right)h\\,\\Delta W + \\frac{1}{6}\\sigma^3(\\Delta W)^3 + \\text{h.o.t.} \\right)\n$$\n其中 h.o.t. 代表 $h$ 和 $\\Delta W$ 幂次的高阶项。$D$ 的条件均方为：\n$$\n\\mathbb{E}[|D|^2 | \\mathcal{F}_{t}] = X_t^2 \\mathbb{E}\\left[ \\left| \\sigma\\left(\\mu - \\frac{1}{2}\\sigma^{2}\\right)h\\,\\Delta W + \\frac{1}{6}\\sigma^3(\\Delta W)^3 + \\dots \\right|^2 \\right]\n$$\n因为 $\\Delta W$ 与 $\\mathcal{F}_t$ 无关。期望中的主要项的阶将是 $\\mathbb{E}[(h\\Delta W)^2] \\sim h^3$、$\\mathbb{E}[(\\Delta W)^6] \\sim h^3$ 和 $\\mathbb{E}[(h\\Delta W)(\\Delta W)^3] = h\\mathbb{E}[(\\Delta W)^4] \\sim h^3$。具体来说：\n$$\n\\mathbb{E}[|D|^2 | \\mathcal{F}_{t}] = X_t^2 \\left( \\sigma^2\\left(\\mu - \\frac{1}{2}\\sigma^{2}\\right)^2 h^2 \\mathbb{E}[(\\Delta W)^2] + \\frac{1}{3}\\sigma^4\\left(\\mu - \\frac{1}{2}\\sigma^{2}\\right) h \\mathbb{E}[(\\Delta W)^4] + \\frac{1}{36}\\sigma^6 \\mathbb{E}[(\\Delta W)^6] + \\dots \\right)\n$$\n使用 $\\mathbb{E}[(\\Delta W)^2] = h$、$\\mathbb{E}[(\\Delta W)^4] = 3h^2$ 和 $\\mathbb{E}[(\\Delta W)^6] = 15h^3$：\n$$\n\\mathbb{E}[|D|^2 | \\mathcal{F}_{t}] = X_t^2 \\left( C_1 h^3 + C_2 h^3 + C_3 h^3 + \\dots \\right) = \\mathcal{O}(h^3)\n$$\n其中 $C_1, C_2, C_3$ 是依赖于 $\\mu$ 和 $\\sigma$ 的常数。这证明了局部缺陷的条件均方满足 $\\mathcal{O}(h^3)$ 的标度关系。\n\n**第 3 部分：全局强收敛阶**\n\nSDE 数值方法的强收敛阶 $p$ 由固定最终时间 $T$ 处的均方误差随步长 $h \\to 0$ 收敛于零的速率决定。SDE 数值分析中的一个标准结果表明，如果一个单步方法的局部均方误差满足\n$$\n\\mathbb{E}\\left[|X_{t+h} - Y_{t+h}|^2 | \\mathcal{F}_t\\right] = \\mathcal{O}(h^{2p+1})\n$$\n并且 SDE 的系数满足某些正则性条件（例如全局 Lipschitz 连续性），则全局强收敛阶为 $p$。也就是说，\n$$\n\\left(\\mathbb{E}\\left[|X_T - Y_{N_T}|^2\\right]\\right)^{1/2} = \\mathcal{O}(h^p)\n$$\n其中 $Y_{N_T}$ 是在时间 $T=N_T h$ 的数值近似。\n\n问题指出，我们应该使用适用于 Lipschitz 系数的常规论证。对于 GBM，漂移项 $a(x)=\\mu x$ 和扩散项 $b(x)=\\sigma x$ 确实是全局 Lipschitz 函数，因此标准的稳定性和收敛性定理适用。\n\n在第 2 部分中，我们证明了局部缺陷 $D$（即局部误差 $X_{t+h} - X_{t+h}^{\\text{Milstein}}$）的条件均方误差为 $\\mathcal{O}(h^3)$。\n$$\n\\mathbb{E}[|D|^2 | \\mathcal{F}_{t}] = \\mathcal{O}(h^3)\n$$\n通过将其与通用形式 $\\mathcal{O}(h^{2p+1})$ 等同，我们可以确定阶数 $p$：\n$$\n2p+1 = 3\n$$\n$$\n2p = 2\n$$\n$$\np = 1\n$$\n因此，用于几何布朗运动的 Milstein 方法实现了 $p=1$ 的全局强收敛阶。", "answer": "$$\n\\boxed{1}\n$$", "id": "3058125"}, {"introduction": "对数值格式的理解，若不考虑其在不同场景下的行为，则是不完整的。最后的这个练习将探讨一个重要的特例：带有加性噪声的随机微分方程。你将发现，在这种情况下，米尔斯坦修正项会自然消失，使其在形式上退化为欧拉-丸山法，但出人意料的是，其强收敛阶却能达到 $1$。这个练习旨在深化你对数值方法与方程结构之间相互作用的理解。[@problem_id:3058173]", "problem": "考虑具有加性噪声的伊藤(Itô)形式的标量随机微分方程 (SDE)\n$$\ndX_t \\;=\\; a(X_t)\\,dt \\;+\\; \\sigma\\,dW_t,\\qquad X_0=x_0,\n$$\n其中 $a:\\mathbb{R}\\to\\mathbb{R}$ 是二次连续可微函数，其一阶导数全局利普希茨(Lipschitz)连续且至多线性增长，$\\sigma\\in\\mathbb{R}$ 是一个常数，$W_t$ 是一个标准维纳(Wiener)过程。令 $\\{t_n\\}_{n=0}^{N}$ 为 $[0,T]$ 上的均匀网格，其中 $t_n=n h$ 且 $h=T/N$。已知高阶强格式可以从伊藤-泰勒(Itô-Taylor)展开中推导得出，方法是保留那些在给定阶数下均方贡献不可忽略的项。\n\n从伊藤(Itô)积分的基本定义和应用于恒等函数的伊藤(Itô)公式出发，推导精确单步增量 $X_{t+h}-X_t$ 的主阶项，并将其与以下形式的单步数值更新进行比较\n$$\nY_{n+1} \\;=\\; Y_n \\;+\\; a(Y_n)\\,h \\;+\\; \\sigma\\,\\Delta W_n,\n$$\n其中 $\\Delta W_n := W_{t_{n+1}}-W_{t_n}$。利用扩散是加性的（即 $\\sigma$ 为常数）这一事实来：\n- 精确地论证为什么 Milstein 修正项会消失，以及 Milstein 格式简化为上述的 Euler-Maruyama 更新，并且\n- 通过对局部均方截断误差进行界定，并在所述正则性假设下通过离散 Grönwall 论证进行传播，证明所得格式达到了与 Milstein 方法相同的强收敛阶。\n\n你的最终答案必须是简化格式的强收敛阶，以单个数字形式给出。不需要单位。如果需要任何近似，会给出取整说明，但在本例中请提供精确值。", "solution": "根据指定标准评估问题的有效性。\n\n### 步骤 1：提取已知条件\n- 标量随机微分方程 (SDE) 为 $dX_t = a(X_t)\\,dt + \\sigma\\,dW_t$，初始条件为 $X_0=x_0$。\n- 漂移函数 $a:\\mathbb{R}\\to\\mathbb{R}$ 是二次连续可微的 ($a \\in C^2$)。\n- 漂移函数的一阶导数 $a'$ 是全局利普希茨(Lipschitz)的。\n- 漂移函数 $a$ 具有至多线性增长。\n- 扩散系数 $\\sigma \\in \\mathbb{R}$ 是一个常数（加性噪声）。\n- $W_t$ 是一个标准维纳(Wiener)过程。\n- 单步数值更新格式为 $Y_{n+1} = Y_n + a(Y_n)\\,h + \\sigma\\,\\Delta W_n$，其中 $h$ 是步长，$\\Delta W_n = W_{t_{n+1}}-W_{t_n}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学性：** 该问题是随机微分方程数值分析中的一个标准课题。SDE 的形式、数值格式 (Euler-Maruyama) 以及对漂移系数的正则性假设在文献中都是公认的（例如，Kloeden and Platen 的《随机微分方程数值解》）。\n- **适定性：** 该问题要求在特定背景下推导和证明一个已知结果。所提供的假设足以保证 SDE 解的存在性和唯一性，并能对数值格式进行收敛性分析。问题是无歧义的，且有唯一正确的答案。\n- **客观性：** 该问题使用精确的数学语言陈述，没有任何主观或偏见的成分。\n\n该问题没有表现出指令中列出的任何缺陷，如科学性不健全、不完整、矛盾或歧义。这个设置是理解 SDE 数值格式收敛性质的经典案例研究。\n\n### 步骤 3：结论与行动\n问题是 **有效的**。将提供完整解答。\n\n### 解题推导\n\n根据问题的要求，分析分两部分进行：首先，展示 Milstein 格式的简化过程；其次，证明所得格式的强收敛阶。\n\n**第 1 部分：针对加性噪声的 Milstein 格式的简化**\n\n标量 SDE 的一般形式为：\n$$\ndX_t = \\alpha(X_t, t) \\, dt + \\beta(X_t, t) \\, dW_t\n$$\nMilstein 格式是一种从 Itô-Taylor 展开推导出的高阶强格式。其单步更新由下式给出：\n$$\nY_{n+1} = Y_n + \\alpha_n h + \\beta_n \\Delta W_n + \\frac{1}{2} \\beta_n \\beta'_n ((\\Delta W_n)^2 - h)\n$$\n其中 $\\alpha_n = \\alpha(Y_n, t_n)$，$\\beta_n = \\beta(Y_n, t_n)$，$\\beta'_n$ 表示 $\\beta$ 对其状态变量的偏导数，在 $(Y_n, t_n)$ 处取值，即 $\\beta'_n = \\frac{\\partial \\beta}{\\partial x}(Y_n, t_n)$。项 $\\frac{1}{2} \\beta_n \\beta'_n ((\\Delta W_n)^2 - h)$ 被称为 Milstein 修正项。\n\n在问题陈述中，SDE 为：\n$$\ndX_t = a(X_t)\\,dt + \\sigma\\,dW_t\n$$\n通过与一般形式进行比较，我们确定漂移系数和扩散系数为：\n$$\n\\alpha(X_t, t) = a(X_t)\n$$\n$$\n\\beta(X_t, t) = \\sigma\n$$\n问题指明 $\\sigma$ 是一个常数。因此，扩散系数 $\\beta(X_t, t)$ 不依赖于状态变量 $X_t$。其关于 $X_t$ 的导数因此为零：\n$$\n\\beta'(X_t) = \\frac{\\partial \\beta}{\\partial X_t} = \\frac{\\partial \\sigma}{\\partial X_t} = 0\n$$\n将 $\\beta'_n = 0$ 代入 Milstein 格式，修正项消失：\n$$\n\\frac{1}{2} \\beta_n \\beta'_n ((\\Delta W_n)^2 - h) = \\frac{1}{2} \\sigma (0) ((\\Delta W_n)^2 - h) = 0\n$$\n因此，对于这个具有加性噪声的 SDE，Milstein 格式简化为：\n$$\nY_{n+1} = Y_n + a(Y_n) h + \\sigma \\Delta W_n\n$$\n这正是问题陈述中给出的 Euler-Maruyama 格式。这表明对于具有加性噪声的 SDE，Euler-Maruyama 格式和 Milstein 格式是相同的。\n\n**第 2 部分：强收敛阶分析**\n\n我们现在证明该格式达到了 $1$ 阶的强收敛性。强收敛阶 $\\gamma$ 定义为 $\\mathbb{E}[|X_T - Y_N|] \\leq C h^\\gamma$，对于某个常数 $C>0$，其中 $X_T$ 是在时间 $T=Nh$ 的精确解，$Y_N$ 是数值近似解。SDE 数值理论中的一个标准结果表明，如果局部均方误差为 $O(h^{2\\gamma+1})$，则全局强收敛阶为 $\\gamma$。\n其中 $e_{n+1}^{\\text{loc}}$ 是单步误差，定义为从同一点 $Y_n$ 出发，一步内的精确解与数值更新之间的差。令 $X_s^n$ 表示在 $s \\in [t_n, t_{n+1}]$ 上初始条件为 $X_{t_n}^n = Y_n$ 的精确解。局部误差为：\n$$\ne_{n+1}^{\\text{loc}} = X_{t_{n+1}}^n - Y_{n+1}\n$$\n使用 SDE 的积分形式和数值格式的定义：\n$$\nX_{t_{n+1}}^n = Y_n + \\int_{t_n}^{t_{n+1}} a(X_s^n) ds + \\sigma \\Delta W_n\n$$\n$$\nY_{n+1} = Y_n + a(Y_n) h + \\sigma \\Delta W_n\n$$\n两者相减得到局部误差：\n$$\ne_{n+1}^{\\text{loc}} = \\int_{t_n}^{t_{n+1}} a(X_s^n) ds - a(Y_n)h = \\int_{t_n}^{t_{n+1}} (a(X_s^n) - a(Y_n)) ds\n$$\n为了确定收敛阶，我们展开被积函数。将 $a(X_s^n)$ 在 $Y_n$ 附近进行泰勒展开得到：\n$$\na(X_s^n) - a(Y_n) = a'(Y_n)(X_s^n-Y_n) + \\frac{1}{2}a''(\\xi_s)(X_s^n-Y_n)^2\n$$\n对于某个在 $Y_n$ 和 $X_s^n$ 之间的 $\\xi_s$。对于 $s \\in [t_n, t_{n+1}]$，增量 $X_s^n-Y_n$ 的主阶近似为：\n$$\nX_s^n-Y_n = \\int_{t_n}^s a(X_u^n) du + \\sigma (W_s - W_{t_n}) \\approx \\sigma(W_s - W_{t_n})\n$$\n第一项的均方阶为 $O((s-t_n)^2)$，而第二项为 $O(s-t_n)$。\n\n**局部均方误差**\n我们考察局部误差本身的主项：\n$$\ne_{n+1}^{\\text{loc}} = \\int_{t_n}^{t_{n+1}} (a(X_s^n) - a(Y_n)) ds \\approx \\int_{t_n}^{t_{n+1}} a'(Y_n)(X_s^n-Y_n) ds\n$$\n使用主阶近似 $X_s^n-Y_n \\approx \\sigma(W_s-W_{t_n})$：\n$$\ne_{n+1}^{\\text{loc}} \\approx a'(Y_n)\\sigma \\int_{t_n}^{t_{n+1}}(W_s-W_{t_n})ds\n$$\n此项的均方为：\n$$\n\\mathbb{E}[|e_{n+1}^{\\text{loc}}|^2 | \\mathcal{F}_{t_n}] \\approx |a'(Y_n)\\sigma|^2 \\mathbb{E}\\left[\\left(\\int_{t_n}^{t_{n+1}}(W_s-W_{t_n})ds\\right)^2\\right]\n$$\n积分维纳过程的方差是一个标准计算：\n$$\n\\mathbb{E}\\left[\\left(\\int_{t_n}^{t_{n+1}}(W_s-W_{t_n})ds\\right)^2\\right] = \\int_{t_n}^{t_{n+1}}\\int_{t_n}^{t_{n+1}} \\min(s-t_n, u-t_n) ds du = \\frac{h^3}{3}\n$$\n因此，局部均方误差为 $O(h^3)$ 阶：\n$$\n\\mathbb{E}[|e_{n+1}^{\\text{loc}}|^2 | \\mathcal{F}_{t_n}] = O(h^3)\n$$\n\n**全局收敛阶**\n这些局部误差的传播通过离散 Grönwall 型论证来处理，这是由于对 $a(x)$ 的正则性假设（利普希茨导数和线性增长）而可行的。标准的收敛理论表明，若局部均方误差为 $O(h^{2\\gamma+1})$，则全局强收敛阶为 $\\gamma$。\n$$\n2\\gamma+1 = 3 \\implies 2\\gamma = 2 \\implies \\gamma = 1\n$$\n对于具有加性噪声的 SDE，格式 $Y_{n+1} = Y_n + a(Y_n)h + \\sigma \\Delta W_n$ 的强收敛阶为 $1$。这确实与一般 Milstein 格式的强收敛阶相同。这种从 Euler-Maruyama 格式典型的 $0.5$ 阶精度“免费”提升的原因是，通常限制精度的项，即 Itô-随机积分 $I_{(1,1)}$，其系数 $b b'$ 在加性噪声的情况下为零。", "answer": "$$\n\\boxed{1}\n$$", "id": "3058173"}]}