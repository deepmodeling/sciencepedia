{"hands_on_practices": [{"introduction": "要掌握弱收敛，最直接的方法就是亲手计算一次。本练习将引导你分析一个基本但极其重要的随机过程——奥恩斯坦-乌伦贝克（Ornstein-Uhlenbeck）过程。通过为欧拉-丸山（Euler-Maruyama）格式计算弱误差，你将直接比较数值解的期望与精确解的期望，并确定收敛阶。这个实践是理解弱收敛定义和培养分析技能的基石 [@problem_id:3083367]。", "problem": "考虑在区间 $[0,T]$ 上，由标准布朗运动 (BM) 驱动的 Ornstein–Uhlenbeck 随机微分方程 (SDE)，其确定性初始条件为 $X_{0}=x_{0}\\in\\mathbb{R}$：\n$dX_{t} = -\\lambda X_{t}\\,dt + \\sigma\\,dW_{t}$，\n其中 $\\lambda>0$，$\\sigma\\in\\mathbb{R}$，且 $W_{t}$ 是一个标准布朗运动。设可观测量为 $\\varphi(x)=x$。\n\n你的任务是：\n- 仅使用 Itô 微积分的基本性质和期望的线性性，通过求出并求解 $m(t)=\\mathbb{E}[X_{t}]$（满足 $m(0)=x_{0}$）所满足的确定性常微分方程，从第一性原理推导 $m(T)=\\mathbb{E}[\\varphi(X_{T})]=\\mathbb{E}[X_{T}]$ 的闭式表达式。\n- 考虑 Euler–Maruyama (EM) 方法，其时间步长为均匀的 $h>0$，网格为 $t_{k}=kh$，$k=0,1,\\dots,N$，其中 $N=T/h\\in\\mathbb{N}$。该格式为\n$X^{h}_{k+1}=X^{h}_{k}-\\lambda X^{h}_{k}\\,h+\\sigma\\,(W_{t_{k+1}}-W_{t_{k}})$，\n初始条件为 $X^{h}_{0}=x_{0}$。计算 $\\mathbb{E}[X^{h}_{N}]$ 的精确表达式，用 $x_{0}$、$\\lambda$、$h$ 和 $N$ 表示。\n- 定义在时刻 $T$ 对应于可观测量 $\\varphi$ 的弱误差为 $e_{\\text{weak}}(h)=\\mathbb{E}[\\varphi(X_{T})]-\\mathbb{E}[\\varphi(X^{h}_{N})]$。使用你得到的精确表达式，将 $e_{\\text{weak}}(h)$ 显式地写成 $x_{0}$、$\\lambda$、$T$ 和 $h$ 的函数。然后确定当 $h\\to 0$ 时 $e_{\\text{weak}}(h)$ 的主阶行为，并指出此可观测量上的弱阶，根据你得到的展开式证明你的结论。\n\n作为你的最终答案，请提供 $e_{\\text{weak}}(h)$ 关于 $x_{0}$、$\\lambda$、$T$ 和 $h$ 的精确闭式表达式。无需四舍五入。", "solution": "该问题经核实是科学上合理的、适定的、客观的且自洽的。Ornstein–Uhlenbeck 过程和 Euler–Maruyama 方法是随机微分方程及其数值分析中的标准课题。所有提供的信息都是一致且足以推导出所要求的量。\n\n解答按照问题陈述的要求分为三个部分。\n\n### 第 1 部分：精确解的均值\n\n我们已知 Ornstein–Uhlenbeck 随机微分方程 (SDE)：\n$$dX_{t} = -\\lambda X_{t}\\,dt + \\sigma\\,dW_{t}$$\n其确定性初始条件为 $X_{0} = x_{0}$，其中 $\\lambda > 0$，$\\sigma \\in \\mathbb{R}$，且 $W_{t}$ 是一个标准布朗运动。我们关心的是可观测量 $\\varphi(x)=x$，因此需要计算 $m(T) = \\mathbb{E}[\\varphi(X_{T})] = \\mathbb{E}[X_{T}]$。\n\n首先，我们将 SDE 写成其积分形式：\n$$X_{t} = X_{0} + \\int_{0}^{t} (-\\lambda X_{s})\\,ds + \\int_{0}^{t} \\sigma\\,dW_{s}$$\n令 $m(t) = \\mathbb{E}[X_{t}]$。我们对积分方程两边取期望。根据期望算子的线性性，我们有：\n$$m(t) = \\mathbb{E}[X_{t}] = \\mathbb{E}\\left[ X_{0} - \\lambda \\int_{0}^{t} X_{s}\\,ds + \\sigma \\int_{0}^{t} dW_{s} \\right]$$\n$$m(t) = \\mathbb{E}[X_{0}] - \\lambda \\mathbb{E}\\left[\\int_{0}^{t} X_{s}\\,ds\\right] + \\sigma \\mathbb{E}\\left[\\int_{0}^{t} dW_{s}\\right]$$\n\n我们逐项计算：\n1.  初始条件是确定性的，所以 $\\mathbb{E}[X_{0}] = \\mathbb{E}[x_{0}] = x_{0}$。\n2.  对于标准布朗运动，具有确定性被积函数的 Itô 积分的期望为零。由于 $X_s$ 是适应的，随机 Fubini 定理允许我们交换期望和积分，并且对于 Itô 积分，我们有 $\\mathbb{E}\\left[\\int_{0}^{t} dW_{s}\\right] = 0$。这是 Itô 微积分的一个基本性质，因为该积分是一个从 0 开始的鞅。\n3.  在对过程 $X_s$ 的温和条件下（此处已满足），我们可以应用随机 Fubini 定理来交换期望和勒贝格积分：$\\mathbb{E}\\left[\\int_{0}^{t} X_{s}\\,ds\\right] = \\int_{0}^{t} \\mathbb{E}[X_{s}]\\,ds = \\int_{0}^{t} m(s)\\,ds$。\n\n将这些代回 $m(t)$ 的方程，我们得到一个关于均值的积分方程：\n$$m(t) = x_{0} - \\lambda \\int_{0}^{t} m(s)\\,ds$$\n这是一个第一类 Volterra 积分方程。使用微积分基本定理对两边关于 $t$ 求导，得到 $m(t)$ 的常微分方程 (ODE)：\n$$\\frac{d m(t)}{dt} = -\\lambda m(t)$$\n通过在积分方程中令 $t=0$ 可得到初始条件：$m(0) = x_{0}$。\n\n这是一个一阶线性齐次 ODE。其解为：\n$$m(t) = m(0)\\exp(-\\lambda t) = x_{0}\\exp(-\\lambda t)$$\n在最终时刻 $T$，精确解的均值为：\n$$m(T) = \\mathbb{E}[X_{T}] = x_{0}\\exp(-\\lambda T)$$\n\n### 第 2 部分：数值解的均值\n\n时间步长为 $h$ 的 Euler–Maruyama (EM) 格式由下式给出：\n$$X^{h}_{k+1} = X^{h}_{k} - \\lambda X^{h}_{k}\\,h + \\sigma\\,(W_{t_{k+1}} - W_{t_{k}})$$\n初始条件为 $X^{h}_{0}=x_{0}$。这可以重写为：\n$$X^{h}_{k+1} = (1 - \\lambda h)X^{h}_{k} + \\sigma\\,\\Delta W_{k}$$\n其中 $\\Delta W_{k} = W_{t_{k+1}} - W_{t_{k}}$ 是布朗运动在区间 $[t_k, t_{k+1}]$ 上的增量。\n\n令 $\\mu_{k} = \\mathbb{E}[X^{h}_{k}]$。我们对该格式取期望：\n$$\\mathbb{E}[X^{h}_{k+1}] = \\mathbb{E}\\left[ (1 - \\lambda h)X^{h}_{k} + \\sigma\\,\\Delta W_{k} \\right]$$\n利用期望的线性性：\n$$\\mu_{k+1} = (1 - \\lambda h)\\mathbb{E}[X^{h}_{k}] + \\sigma\\mathbb{E}[\\Delta W_{k}]$$\n标准布朗运动的增量 $\\Delta W_{k}$ 是独立同分布的正态随机变量，其均值为 0，方差为 $h$。因此，$\\mathbb{E}[\\Delta W_{k}] = 0$。\n数值解均值的递推关系简化为：\n$$\\mu_{k+1} = (1 - \\lambda h)\\mu_{k}$$\n初始条件为 $\\mu_{0} = \\mathbb{E}[X^{h}_{0}] = \\mathbb{E}[x_{0}] = x_{0}$。\n\n这是一个等比数列。第 $k$ 步的解由下式给出：\n$$\\mu_{k} = (1 - \\lambda h)^{k} \\mu_{0} = x_{0}(1 - \\lambda h)^{k}$$\n我们需要最终时刻 $T$ 的均值，这对应于第 $N$ 步，其中 $N=T/h$。因此，对于 $k=N$：\n$$\\mathbb{E}[X^{h}_{N}] = x_{0}(1 - \\lambda h)^{N}$$\n\n### 第 3 部分：弱误差与主阶分析\n\n在时刻 $T$ 对应于可观测量 $\\varphi(x)=x$ 的弱误差定义为：\n$$e_{\\text{weak}}(h) = \\mathbb{E}[\\varphi(X_{T})] - \\mathbb{E}[\\varphi(X^{h}_{N})] = \\mathbb{E}[X_{T}] - \\mathbb{E}[X^{h}_{N}]$$\n代入前面部分推导出的精确表达式：\n$$\\mathbb{E}[X_{T}] = x_{0}\\exp(-\\lambda T)$$\n$$\\mathbb{E}[X^{h}_{N}] = x_{0}(1 - \\lambda h)^{N}$$\n使用关系式 $N=T/h$，我们可以将 $\\mathbb{E}[X^{h}_{N}]$ 写成 $h$ 和 $T$ 的函数：\n$$\\mathbb{E}[X^{h}_{N}] = x_{0}(1 - \\lambda h)^{T/h}$$\n因此，弱误差的精确表达式为：\n$$e_{\\text{weak}}(h) = x_{0}\\exp(-\\lambda T) - x_{0}(1 - \\lambda h)^{T/h} = x_{0}\\left(\\exp(-\\lambda T) - (1 - \\lambda h)^{T/h}\\right)$$\n\n为了确定当 $h \\to 0$ 时的主阶行为，我们对 $(1 - \\lambda h)^{T/h}$ 项进行泰勒展开。我们可以使用指数函数来写这一项：\n$$(1 - \\lambda h)^{T/h} = \\exp\\left(\\frac{T}{h} \\ln(1 - \\lambda h)\\right)$$\n对于小的 $h$，我们使用自然对数的泰勒级数 $\\ln(1-u) = -u - \\frac{u^2}{2} - O(u^3)$，令 $u = \\lambda h$：\n$$\\ln(1 - \\lambda h) = -\\lambda h - \\frac{(\\lambda h)^2}{2} - O(h^3)$$\n将此代入指数中：\n$$\\frac{T}{h}\\ln(1 - \\lambda h) = \\frac{T}{h}\\left(-\\lambda h - \\frac{\\lambda^2 h^2}{2} - O(h^3)\\right) = -\\lambda T - \\frac{\\lambda^2 T}{2}h - O(h^2)$$\n所以，数值均值的表达式变为：\n$$(1 - \\lambda h)^{T/h} = \\exp\\left(-\\lambda T - \\frac{\\lambda^2 T}{2}h - O(h^2)\\right) = \\exp(-\\lambda T)\\exp\\left(-\\frac{\\lambda^2 T}{2}h - O(h^2)\\right)$$\n现在，我们使用指数函数的泰勒级数 $\\exp(v) = 1 + v + O(v^2)$，其中 $v = -\\frac{\\lambda^2 T}{2}h$：\n$$\\exp\\left(-\\frac{\\lambda^2 T}{2}h - O(h^2)\\right) = 1 - \\frac{\\lambda^2 T}{2}h + O(h^2)$$\n综合起来：\n$$(1 - \\lambda h)^{T/h} = \\exp(-\\lambda T)\\left(1 - \\frac{\\lambda^2 T}{2}h + O(h^2)\\right) = \\exp(-\\lambda T) - \\frac{\\lambda^2 T}{2}\\exp(-\\lambda T)h + O(h^2)$$\n现在我们将这个展开式代回弱误差表达式中：\n$$e_{\\text{weak}}(h) = x_{0}\\left(\\exp(-\\lambda T) - \\left[\\exp(-\\lambda T) - \\frac{\\lambda^2 T}{2}\\exp(-\\lambda T)h + O(h^2)\\right]\\right)$$\n$$e_{\\text{weak}}(h) = x_{0}\\left(\\frac{\\lambda^2 T}{2}\\exp(-\\lambda T)h - O(h^2)\\right)$$\n$$e_{\\text{weak}}(h) = \\frac{x_{0}\\lambda^2 T}{2}\\exp(-\\lambda T)h + O(h^2)$$\n弱误差的主阶行为与 $h$ 成正比。因此，Euler-Maruyama 方法在此可观测量上的弱收敛阶为 1。", "answer": "$$\\boxed{x_{0}\\left(\\exp(-\\lambda T) - (1 - \\lambda h)^{T/h}\\right)}$$", "id": "3083367"}, {"introduction": "理论上的收敛阶在实际计算中究竟意味着什么？这个练习将理论与实践联系起来，探讨了如何在有限的计算资源下最有效地达到给定的精度目标 $\\varepsilon$。你将学习如何分解和平衡两种主要的误差来源：由时间步长 $h$ 引起的离散化误差（偏差）和由蒙特卡洛模拟次数 $M$ 决定的统计误差（方差）。通过这个练习，你将明白弱收敛阶是如何直接指导我们设计高效数值实验的 [@problem_id:3083399]。", "problem": "考虑一个一维随机微分方程 (SDE)，由 $dX_{t} = a(X_{t})\\,dt + b(X_{t})\\,dW_{t}$ 给出，在固定时间区间 $[0,T]$ 上具有确定性初始条件 $X_{0} = x_{0}$，其中 $a$ 和 $b$ 是全局 Lipschitz 连续函数，$(W_{t})_{t \\geq 0}$ 是一个标准布朗运动。令 $\\varphi:\\mathbb{R}\\to\\mathbb{R}$ 为一个具有多项式增长的测试函数，并将目标量表示为 $\\mu := \\mathbb{E}[\\varphi(X_{T})]$。\n\n为了近似 $\\mu$，考虑使用时间步长 $h>0$ 和 $N := T/h \\in \\mathbb{N}$ 个步长的欧拉-丸山 (EM) 格式：\n$$\nY_{0} := x_{0}, \\quad\nY_{n+1} := Y_{n} + a(Y_{n})\\,h + b(Y_{n})\\,\\Delta W_{n}, \\quad \\Delta W_{n} \\sim \\mathcal{N}(0,h), \\quad n=0,1,\\dots,N-1.\n$$\n基于 EM 格式终值的 $M \\in \\mathbb{N}$ 条独立同分布的路径 $(Y_{N}^{(m)})_{m=1}^{M}$，定义蒙特卡洛估计量：\n$$\n\\widehat{\\mu}_{M,h} := \\frac{1}{M}\\sum_{m=1}^{M} \\varphi\\big(Y_{N}^{(m)}\\big).\n$$\n\n假设对于足够小的 $h$，以下两个性质一致成立：\n1. 欧拉-丸山格式的一阶弱收敛阶：存在一个常数 $C_{w}>0$ 使得\n$$\n\\big|\\mathbb{E}[\\varphi(Y_{N})] - \\mathbb{E}[\\varphi(X_{T})]\\big| \\leq C_{w}\\,h.\n$$\n2. 离散化下收益的单位方差界：存在一个常数 $C_{v} \\leq 1$ 使得\n$$\n\\mathrm{Var}\\big(\\varphi(Y_{N})\\big) \\leq C_{v} \\leq 1.\n$$\n\n使用估计量 $\\widehat{\\mu}_{M,h}$ 的均方误差 (MSE)，其定义为\n$$\n\\mathrm{MSE}(M,h) := \\mathbb{E}\\Big[\\big(\\widehat{\\mu}_{M,h} - \\mu\\big)^{2}\\Big],\n$$\n推导时间步长 $h$ 和样本数量 $M$ 关于用户指定的精度 $\\varepsilon \\in (0,1)$ 的渐近尺度，使得均方根误差 $\\sqrt{\\mathrm{MSE}(M,h)}$ 被 $\\varepsilon$ 界定（在不考虑与 $\\varepsilon$ 无关的乘法常数的情况下）。将你的最终答案表示为一个单行矩阵，其中包含 $h$ 和 $M$ 关于 $\\varepsilon$ 的主阶尺度。", "solution": "问题陈述的解析和验证如下。\n\n### 步骤 1：提取已知条件\n- **随机微分方程 (SDE):** $dX_{t} = a(X_{t})\\,dt + b(X_{t})\\,dW_{t}$\n- **初始条件:** $X_{0} = x_{0}$ (确定性)\n- **时间区间:** $[0,T]$\n- **系数:** $a$ 和 $b$ 是全局 Lipschitz 连续的。\n- **随机过程:** $(W_{t})_{t \\geq 0}$ 是标准布朗运动。\n- **测试函数:** $\\varphi:\\mathbb{R}\\to\\mathbb{R}$，具有多项式增长。\n- **目标量:** $\\mu := \\mathbb{E}[\\varphi(X_{T})]$\n- **欧拉-丸山 (EM) 格式:**\n  - 时间步长 $h>0$，$N := T/h \\in \\mathbb{N}$。\n  - $Y_{0} := x_{0}$\n  - $Y_{n+1} := Y_{n} + a(Y_{n})\\,h + b(Y_{n})\\,\\Delta W_{n}$，对于 $n=0,1,\\dots,N-1$。\n  - $\\Delta W_{n}$ 是独立同分布 (i.i.d.) 的，且 $\\Delta W_{n} \\sim \\mathcal{N}(0,h)$。\n- **蒙特卡洛估计量:**\n  - $\\widehat{\\mu}_{M,h} := \\frac{1}{M}\\sum_{m=1}^{M} \\varphi\\big(Y_{N}^{(m)}\\big)$，其中 $M \\in \\mathbb{N}$ 是独立同分布路径的数量。\n- **假设 1 (弱收敛阶):** 存在常数 $C_{w}>0$ 使得 $\\big|\\mathbb{E}[\\varphi(Y_{N})] - \\mathbb{E}[\\varphi(X_{T})]\\big| \\leq C_{w}\\,h$。\n- **假设 2 (方差界):** 存在常数 $C_{v} \\leq 1$ 使得 $\\mathrm{Var}\\big(\\varphi(Y_{N})\\big) \\leq C_{v}$。\n- **误差度量:** 均方误差 (MSE)，$\\mathrm{MSE}(M,h) := \\mathbb{E}\\Big[\\big(\\widehat{\\mu}_{M,h} - \\mu\\big)^{2}\\Big]$。\n- **目标:** 推导 $h$ 和 $M$ 关于给定精度 $\\varepsilon \\in (0,1)$ 的渐近尺度，使得 $\\sqrt{\\mathrm{MSE}(M,h)} \\leq \\varepsilon$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在随机微分方程数值分析领域有坚实的科学基础。它提出了一个标准任务：分析蒙特卡洛方法与时间离散格式相结合的误差。包括 SDE 的形式、系数的性质、欧拉-丸山格式以及关于弱收敛阶和方差的假设在内的前提条件，在文献中都是标准的（例如，在 Kloeden  Platen 或 Glasserman 的著作中）。该问题是适定的、客观的、自洽的，并且没有任何科学或逻辑上的缺陷。\n\n### 步骤 3：结论与行动\n该问题被认为是有效的。将提供完整的解答。\n\n### 解题推导\n目标是找到时间步长 $h$ 和蒙特卡洛样本数量 $M$ 的渐近尺度，以确保均方根误差 (RMSE) 被给定的容差 $\\varepsilon$ 所界定。RMSE 定义为 $\\sqrt{\\mathrm{MSE}(M,h)}$。条件是 $\\sqrt{\\mathrm{MSE}(M,h)} \\leq \\varepsilon$，这等价于 $\\mathrm{MSE}(M,h) \\leq \\varepsilon^{2}$。\n\n均方误差可以分解为偏差的平方和估计量的方差：\n$$\n\\mathrm{MSE}(M,h) = \\mathbb{E}\\Big[\\big(\\widehat{\\mu}_{M,h} - \\mu\\big)^{2}\\Big] = \\Big(\\mathbb{E}\\big[\\widehat{\\mu}_{M,h}\\big] - \\mu\\Big)^{2} + \\mathrm{Var}\\big(\\widehat{\\mu}_{M,h}\\big).\n$$\n\n首先，我们分析偏差项 $\\mathbb{E}\\big[\\widehat{\\mu}_{M,h}\\big] - \\mu$。估计量 $\\widehat{\\mu}_{M,h}$ 的期望为：\n$$\n\\mathbb{E}\\big[\\widehat{\\mu}_{M,h}\\big] = \\mathbb{E}\\left[\\frac{1}{M}\\sum_{m=1}^{M} \\varphi\\big(Y_{N}^{(m)}\\big)\\right].\n$$\n根据期望的线性性质，并且由于路径 $(Y_{N}^{(m)})_{m=1}^{M}$ 是独立同分布的，我们有：\n$$\n\\mathbb{E}\\big[\\widehat{\\mu}_{M,h}\\big] = \\frac{1}{M}\\sum_{m=1}^{M} \\mathbb{E}\\left[\\varphi\\big(Y_{N}^{(m)}\\big)\\right] = \\frac{1}{M} \\cdot M \\cdot \\mathbb{E}\\left[\\varphi\\big(Y_{N}\\big)\\right] = \\mathbb{E}\\left[\\varphi\\big(Y_{N}\\big)\\right].\n$$\n因此，偏差是欧拉-丸山格式的弱误差：\n$$\n\\text{Bias} = \\mathbb{E}\\big[\\widehat{\\mu}_{M,h}\\big] - \\mu = \\mathbb{E}\\left[\\varphi\\big(Y_{N}\\big)\\right] - \\mathbb{E}\\left[\\varphi\\big(X_{T}\\big)\\right].\n$$\n使用假设 1，偏差的绝对值有界：\n$$\n\\big|\\text{Bias}\\big| \\leq C_{w}h.\n$$\n因此，偏差的平方有界：\n$$\n(\\text{Bias})^{2} \\leq (C_{w}h)^{2} = C_{w}^{2}h^{2}.\n$$\n\n其次，我们分析方差项 $\\mathrm{Var}\\big(\\widehat{\\mu}_{M,h}\\big)$。\n$$\n\\mathrm{Var}\\big(\\widehat{\\mu}_{M,h}\\big) = \\mathrm{Var}\\left(\\frac{1}{M}\\sum_{m=1}^{M} \\varphi\\big(Y_{N}^{(m)}\\big)\\right).\n$$\n由于路径是独立同分布的，随机变量 $\\varphi\\big(Y_{N}^{(m)}\\big)$ 也是独立同分布的。对于独立同分布随机变量的和，其方差为：\n$$\n\\mathrm{Var}\\big(\\widehat{\\mu}_{M,h}\\big) = \\frac{1}{M^{2}}\\sum_{m=1}^{M} \\mathrm{Var}\\left(\\varphi\\big(Y_{N}^{(m)}\\big)\\right) = \\frac{1}{M^{2}} \\cdot M \\cdot \\mathrm{Var}\\left(\\varphi\\big(Y_{N}\\big)\\right) = \\frac{1}{M} \\mathrm{Var}\\left(\\varphi\\big(Y_{N}\\big)\\right).\n$$\n使用假设 2，方差有界：\n$$\n\\mathrm{Var}\\big(\\widehat{\\mu}_{M,h}\\big) \\leq \\frac{C_{v}}{M}.\n$$\n\n结合偏差平方和方差的界，我们得到 MSE 的一个上界：\n$$\n\\mathrm{MSE}(M,h) \\leq C_{w}^{2}h^{2} + \\frac{C_{v}}{M}.\n$$\n为了满足精度要求 $\\mathrm{MSE}(M,h) \\leq \\varepsilon^{2}$，我们必须有：\n$$\nC_{w}^{2}h^{2} + \\frac{C_{v}}{M} \\leq \\varepsilon^{2}.\n$$\n为了找到 $h$ 和 $M$ 相对于 $\\varepsilon$ 的渐近尺度，我们需要选择 $h$ 和 $M$ 以使该不等式成立。一种标准的方法是平衡两个误差分量，即离散化误差（来自 $h$）和统计误差（来自 $M$），使它们与目标总平方误差 $\\varepsilon^{2}$ 具有相同的数量级。我们可以要求每一项都被 $\\frac{\\varepsilon^{2}}{2}$ 界定：\n$$\nC_{w}^{2}h^{2} \\leq \\frac{\\varepsilon^{2}}{2} \\quad \\text{和} \\quad \\frac{C_{v}}{M} \\leq \\frac{\\varepsilon^{2}}{2}.\n$$\n将这两个不等式相加，可以保证总 MSE 被 $\\varepsilon^{2}$ 界定。\n\n从第一个不等式，我们推导出 $h$ 的尺度：\n$$\nh^{2} \\leq \\frac{\\varepsilon^{2}}{2C_{w}^{2}} \\implies h \\leq \\frac{\\varepsilon}{\\sqrt{2}C_{w}}.\n$$\n这表明为了达到所需的精度，$h$ 必须选择与 $\\varepsilon$ 成正比。渐近尺度为 $h = \\mathcal{O}(\\varepsilon)$。\n\n从第二个不等式，我们推导出 $M$ 的尺度：\n$$\nM \\geq \\frac{2C_{v}}{\\varepsilon^{2}}.\n$$\n这表明 $M$ 必须选择与 $\\varepsilon^{-2}$ 成正比。渐近尺度为 $M = \\mathcal{O}(\\varepsilon^{-2})$。\n\n主阶尺度是关于 $\\varepsilon$ 的主要依赖关系，对于 $h$ 是 $\\varepsilon$，对于 $M$ 是 $\\varepsilon^{-2}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\varepsilon & \\varepsilon^{-2}\n\\end{pmatrix}\n}\n$$", "id": "3083399"}, {"introduction": "在理解了基本误差的来源和影响之后，一个自然的问题是：我们能否用更巧妙的方法来提高计算精度？本练习介绍了一种强大的误差缩减技术——理查森外推法（Richardson extrapolation）。通过将不同步长（$h$ 和 $h/2$）下的数值结果进行线性组合，我们可以有效地消除弱误差中的主导项，从而以较小的计算代价获得更高阶的收敛精度。这个练习展示了如何利用误差的结构性信息来“加速”收敛，是数值分析中的一个核心思想 [@problem_id:3083381]。", "problem": "考虑标量Ornstein–Uhlenbeck（OU）随机微分方程（SDE）\n$$\n\\mathrm{d}X_{t} = -a\\,X_{t}\\,\\mathrm{d}t + b\\,\\mathrm{d}W_{t}, \\qquad X_{0} = x_{0},\n$$\n其中 $a>0$，$b \\in \\mathbb{R}$，$x_{0} \\in \\mathbb{R}$，$T>0$，且 $W_{t}$ 是一个标准的维纳过程。令 $\\varphi(x) = x$ 并用 $m(T) = \\mathbb{E}[X_{T}]$ 表示在时间 $T$ 的精确均值。定义具有均匀步长 $h = T/N$ 的Euler–Maruyama时间步进格式为\n$$\nX_{n+1}^{(h)} = X_{n}^{(h)} - a\\,X_{n}^{(h)}\\,h + b\\,\\Delta W_{n}, \\quad n=0,1,\\dots,N-1, \\qquad X_{0}^{(h)} = x_{0},\n$$\n并令 $m_{h} := \\mathbb{E}[X_{N}^{(h)}]$。类似地，令 $m_{h/2}$ 表示在相同的终止时间 $T$ 上，由步长为 $h/2$ 的Euler–Maruyama格式产生的均值。\n\n仅使用线性SDE的基本性质（期望的线性和Itô积分）以及Euler–Maruyama格式的定义，推导出 $m(T)$、$m_{h}$ 和 $m_{h/2}$ 的显式表达式，然后应用Richardson外推法来构造\n$$\nR(h) := 2\\,m_{h/2} - m_{h}.\n$$\n通过基于光滑函数级数展开的基本原理进行小 $h$ 分析，确定由以下极限定义的前导常数 $L$\n$$\nL := \\lim_{h \\to 0} \\frac{R(h) - m(T)}{h^{2}},\n$$\n该常数仅用 $a$、$T$ 和 $x_{0}$ 以闭式形式表示。你的最终答案必须是单一的解析表达式。不需要数值舍入，也不涉及单位。", "solution": "对问题陈述进行有效性分析。\n\n### 步骤1：提取已知条件\n- **SDE**：$\\mathrm{d}X_{t} = -a\\,X_{t}\\,\\mathrm{d}t + b\\,\\mathrm{d}W_{t}$，初始条件为 $X_{0} = x_{0}$。\n- **参数**：$a>0$，$b \\in \\mathbb{R}$，$x_{0} \\in \\mathbb{R}$，$T>0$。\n- **过程**：$W_{t}$ 是一个标准的维纳过程。\n- **测试函数**：$\\varphi(x) = x$。\n- **精确均值**：$m(T) = \\mathbb{E}[X_{T}]$。\n- **数值格式**：具有均匀步长 $h = T/N$ 的Euler–Maruyama格式为 $X_{n+1}^{(h)} = X_{n}^{(h)} - a\\,X_{n}^{(h)}\\,h + b\\,\\Delta W_{n}$，对于 $n=0,1,\\dots,N-1$，初始条件为 $X_{0}^{(h)} = x_{0}$。$\\Delta W_n = W_{(n+1)h} - W_{nh}$。\n- **数值均值**：$m_{h} := \\mathbb{E}[X_{N}^{(h)}]$。\n- **精化数值均值**：$m_{h/2}$ 是由相同格式但步长为 $h/2$ 产生的均值。\n- **Richardson外推法**：$R(h) := 2\\,m_{h/2} - m_{h}$。\n- **目标**：确定前导常数 $L := \\lim_{h \\to 0} \\frac{R(h) - m(T)}{h^{2}}$，用 $a$、$T$ 和 $x_{0}$ 表示。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题是随机微分方程数值分析中的一个标准练习。Ornstein–Uhlenbeck过程、Euler–Maruyama方法和Richardson外推法都是该领域基本且成熟的概念。弱收敛阶的分析是一个核心主题。\n- **适定性**：问题陈述清晰，提供了所有必要的参数和定义。它要求一个具体的、可推导的常数 $L$，这指向一个唯一且有意义的解。\n- **客观性**：该问题以精确、客观的数学语言表述，没有歧义或主观论断。\n\n### 步骤3：结论与行动\n该问题是有效的，因为它科学合理、适定、客观且自洽。可以开始求解过程。\n\n### 解的推导\n\n求解需要三个主要部分：精确均值 $m(T)$，数值均值 $m_{h}$ 和 $m_{h/2}$，以及用于评估极限 $L$ 的小 $h$ 渐近分析。\n\n**1. 精确均值 $m(T)$**\n\nOrnstein-Uhlenbeck SDE是一个线性SDE。我们可以显式地求解它。其在时间 $t$ 的解由下式给出\n$$\nX_{t} = X_0 \\exp(-at) + \\int_{0}^{t} b \\exp(-a(t-s)) \\mathrm{d}W_s.\n$$\n取期望，我们得到均值 $m(t) = \\mathbb{E}[X_t]$。利用期望的线性性质，\n$$\nm(t) = \\mathbb{E}[X_0 \\exp(-at)] + \\mathbb{E}\\left[\\int_{0}^{t} b \\exp(-a(t-s)) \\mathrm{d}W_s\\right].\n$$\n由于 $X_0 = x_0$ 是一个确定性的初始条件，$\\mathbb{E}[X_0 \\exp(-at)] = x_0 \\exp(-at)$。第二项是一个具有确定性被积函数的Itô积分的期望，其值为零。\n$$\n\\mathbb{E}\\left[\\int_{0}^{t} b \\exp(-a(t-s)) \\mathrm{d}W_s\\right] = 0.\n$$\n因此，该过程在时间 $t$ 的均值为 $m(t) = x_0 \\exp(-at)$。在终止时间 $T$，精确均值为\n$$\nm(T) = x_{0} \\exp(-aT).\n$$\n\n**2. 数值均值 $m_h$**\n\nEuler–Maruyama格式由下式给出\n$$\nX_{n+1}^{(h)} = (1 - ah) X_{n}^{(h)} + b \\Delta W_{n}.\n$$\n令 $m_n^{(h)} = \\mathbb{E}[X_{n}^{(h)}]$。对该格式取期望，我们得到均值的递推关系：\n$$\n\\mathbb{E}[X_{n+1}^{(h)}] = \\mathbb{E}[(1 - ah) X_{n}^{(h)}] + \\mathbb{E}[b \\Delta W_{n}].\n$$\n维纳过程的增量 $\\Delta W_n$ 的均值为零，$\\mathbb{E}[\\Delta W_n] = 0$。这将递推关系简化为\n$$\nm_{n+1}^{(h)} = (1 - ah) m_n^{(h)}.\n$$\n根据初始条件 $m_0^{(h)} = \\mathbb{E}[X_0^{(h)}] = x_0$，我们可以解这个几何级数：\n$$\nm_n^{(h)} = (1-ah)^n x_0.\n$$\n我们关心的是在终止时间 $T=Nh$ 时的均值，这对应于 $n=N$。因此，\n$$\nm_h = m_N^{(h)} = (1-ah)^N x_0.\n$$\n代入 $N=T/h$，我们得到一个用 $h$ 表示 $m_h$ 的表达式：\n$$\nm_h = x_0 (1-ah)^{T/h}.\n$$\n类似地，对于步长 $h/2$，达到 $T$ 所需的步数为 $2N$。数值均值为\n$$\nm_{h/2} = x_0 (1-a(h/2))^{2N} = x_0 (1-ah/2)^{2T/h}.\n$$\n\n**3. 小 $h$ 渐近分析**\n\n为了找到 $L$ 的极限，我们需要对 $m_h$ 在 $h=0$ 附近进行泰勒展开。首先展开项 $(1-ah)^{T/h}$ 的对数会很方便。\n对于小的 $x$，使用级数展开 $\\ln(1-x) = -x - \\frac{x^2}{2} - \\frac{x^3}{3} - O(x^4)$，我们令 $x=ah$：\n$$\n\\ln\\left((1-ah)^{T/h}\\right) = \\frac{T}{h} \\ln(1-ah) = \\frac{T}{h} \\left( -ah - \\frac{(ah)^2}{2} - \\frac{(ah)^3}{3} - O(h^4) \\right)\n$$\n$$\n= T \\left( -a - \\frac{a^2h}{2} - \\frac{a^3h^2}{3} - O(h^3) \\right) = -aT - \\frac{a^2Th}{2} - \\frac{a^3Th^2}{3} - O(h^3).\n$$\n现在，我们对该表达式取指数。令 $y = - \\frac{a^2Th}{2} - \\frac{a^3Th^2}{3}$。\n$$\n(1-ah)^{T/h} = \\exp\\left(-aT - \\frac{a^2Th}{2} - \\frac{a^3Th^2}{3} - O(h^3)\\right) = \\exp(-aT) \\exp\\left(y - O(h^3)\\right).\n$$\n使用展开式 $\\exp(y) = 1 + y + \\frac{y^2}{2} + O(y^3)$，我们得到\n$$\n\\exp(y) = 1 + \\left(-\\frac{a^2Th}{2} - \\frac{a^3Th^2}{3}\\right) + \\frac{1}{2}\\left(-\\frac{a^2Th}{2} - \\frac{a^3Th^2}{3}\\right)^2 + O(h^3).\n$$\n展开并保留到 $h^2$ 阶的项：\n$$\n\\exp(y) = 1 - \\frac{a^2T}{2}h - \\frac{a^3T}{3}h^2 + \\frac{1}{2}\\left(-\\frac{a^2Th}{2}\\right)^2 + O(h^3)\n$$\n$$\n= 1 - \\frac{a^2T}{2}h - \\frac{a^3T}{3}h^2 + \\frac{a^4T^2}{8}h^2 + O(h^3) = 1 - \\frac{a^2T}{2}h + \\left(\\frac{a^4T^2}{8} - \\frac{a^3T}{3}\\right)h^2 + O(h^3).\n$$\n因此，$m_h$ 的展开式为\n$$\nm_h = x_0 \\exp(-aT) \\left[ 1 - \\frac{a^2T}{2}h + \\left(\\frac{a^4T^2}{8} - \\frac{a^3T}{3}\\right)h^2 + O(h^3) \\right].\n$$\n该展开式的形式为 $m_h = m(T) + C_1 h + C_2 h^2 + O(h^3)$，其中 $m(T) = x_0 \\exp(-aT)$，且系数为\n$$\nC_1 = -x_0 \\exp(-aT) \\frac{a^2T}{2}\n$$\n$$\nC_2 = x_0 \\exp(-aT) \\left(\\frac{a^4T^2}{8} - \\frac{a^3T}{3}\\right).\n$$\n$m_{h/2}$ 的展开式可以通过将 $h$ 替换为 $h/2$ 得到：\n$$\nm_{h/2} = m(T) + C_1 \\frac{h}{2} + C_2 \\left(\\frac{h}{2}\\right)^2 + O(h^3) = m(T) + \\frac{C_1}{2}h + \\frac{C_2}{4}h^2 + O(h^3).\n$$\n\n**4. Richardson外推法与极限 $L$**\n\n现在我们构造Richardson外推值 $R(h)$：\n$$\nR(h) = 2m_{h/2} - m_h\n$$\n$$\n= 2\\left(m(T) + \\frac{C_1}{2}h + \\frac{C_2}{4}h^2\\right) - \\left(m(T) + C_1 h + C_2 h^2\\right) + O(h^3)\n$$\n$$\n= (2m(T) + C_1 h + \\frac{C_2}{2}h^2) - (m(T) + C_1 h + C_2 h^2) + O(h^3)\n$$\n$$\n= m(T) - \\frac{C_2}{2}h^2 + O(h^3).\n$$\n外推值与精确均值之差为\n$$\nR(h) - m(T) = -\\frac{C_2}{2}h^2 + O(h^3).\n$$\n极限 $L$ 于是就是 $h^2$ 项的系数：\n$$\nL = \\lim_{h \\to 0} \\frac{R(h) - m(T)}{h^2} = -\\frac{C_2}{2}.\n$$\n代入 $C_2$ 的表达式：\n$$\nL = -\\frac{1}{2} \\left[ x_0 \\exp(-aT) \\left(\\frac{a^4T^2}{8} - \\frac{a^3T}{3}\\right) \\right]\n$$\n$$\nL = x_0 \\exp(-aT) \\left(-\\frac{a^4T^2}{16} + \\frac{a^3T}{6}\\right).\n$$\n这就是所求的前导常数 $L$ 的闭式表达式。\n$$\nL = x_0 \\exp(-aT) \\left( \\frac{a^3 T}{6} - \\frac{a^4 T^2}{16} \\right).\n$$", "answer": "$$\n\\boxed{x_{0} \\exp(-aT) \\left( \\frac{a^{3} T}{6} - \\frac{a^{4} T^{2}}{16} \\right)}\n$$", "id": "3083381"}]}