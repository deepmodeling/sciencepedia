{"hands_on_practices": [{"introduction": "要真正掌握一个数值格式，最好的方法是从第一性原理出发进行推导。本练习将引导你通过伊藤-泰勒展开（Itô-Taylor expansion）推导出米尔斯坦格式。通过这个过程，你将清楚地看到关键的修正项是如何产生的，并理解为何在加性噪声的随机微分方程中该项会消失，从而使米尔斯坦格式退化为欧拉-丸山格式。[@problem_id:3081404]", "problem": "考虑 Itô 意义下的标量随机微分方程 (SDE)，\n$$\n\\mathrm{d}X_{t} = a(X_{t})\\,\\mathrm{d}t + b(X_{t})\\,\\mathrm{d}W_{t},\n$$\n其中 $a$ 和 $b$ 是具有连续一阶导数的全局 Lipschitz 函数，而 $W_{t}$ 是一个标准布朗运动。给定一个均匀时间离散化 $t_{n+1} = t_{n} + \\Delta t$，其布朗增量为 $\\Delta W_{n} = W_{t_{n+1}} - W_{t_{n}}$。\n\n从该 SDE 的积分形式出发，利用适用于二阶连续可微函数的 Itô 公式以及布朗运动增量的基本矩恒等式，通过在均方意义下保留截至 $\\Delta t$ 阶的项，推导出一个能达到一阶强收敛阶的单步方法。然后，将其特化到扩散系数为常数 $b(x) \\equiv \\sigma$（其中 $\\sigma \\neq 0$）的情形，并从代数上证明为何该一阶强收敛方法中的额外校正项会消失。\n\n作为你的最终答案，提供得到的单步更新，形式为一个仅由 $X_{n}$、$a(X_{n})$、$\\Delta t$、$\\sigma$ 和 $\\Delta W_{n}$ 表示的单一闭式解析表达式，不含等号。无需四舍五入，也不涉及物理单位。在首次使用时定义所有缩写；例如，Euler–Maruyama (EM)。", "solution": "该问题要求为标量随机微分方程 (SDE) 推导一个能达到一阶强收敛阶的单步数值方法。然后，我们将该方法特化到扩散系数为常数的情形，并提供得到的简化更新规则。\n\n给定的 SDE 是 Itô 意义下的：\n$$\n\\mathrm{d}X_{t} = a(X_{t})\\,\\mathrm{d}t + b(X_{t})\\,\\mathrm{d}W_{t}\n$$\n其时间离散化是均匀的，$t_{n+1} = t_{n} + \\Delta t$。该 SDE 的解在单个时间步 $[t_n, t_{n+1}]$ 上可以表示为积分形式：\n$$\nX_{t_{n+1}} = X_{t_n} + \\int_{t_n}^{t_{n+1}} a(X_s)\\,\\mathrm{d}s + \\int_{t_n}^{t_{n+1}} b(X_s)\\,\\mathrm{d}W_s\n$$\n设 $X_n$ 是 $X_{t_n}$ 的数值近似。为构造一个数值格式，我们必须对右侧的两个积分进行近似。\n\n第一个积分，即涉及 $\\mathrm{d}t$ 的部分，是一个标准黎曼积分。最简单且最常见的近似是左端点规则：\n$$\n\\int_{t_n}^{t_{n+1}} a(X_s)\\,\\mathrm{d}s \\approx a(X_n) (t_{n+1} - t_n) = a(X_n) \\Delta t\n$$\n该近似的局部误差阶为 $O((\\Delta t)^2)$。\n\n第二个积分是一个 Itô 随机积分。最简单的近似是在左端点处计算被积函数：\n$$\n\\int_{t_n}^{t_{n+1}} b(X_s)\\,\\mathrm{d}W_s \\approx b(X_n) \\int_{t_n}^{t_{n+1}} \\mathrm{d}W_s = b(X_n) (W_{t_{n+1}} - W_{t_n}) = b(X_n) \\Delta W_n\n$$\n结合这两个简单的近似，便得到 Euler–Maruyama (EM) 格式：\n$$\nX_{n+1} = X_n + a(X_n)\\Delta t + b(X_n)\\Delta W_n\n$$\nEM 格式的强收敛阶为 0.5。为了达到所要求的一阶强收敛阶，我们必须改进随机积分的近似，因为它是主要的误差来源。这需要我们在 $b(X_s)$ 的展开式中保留更高阶的项。\n\n我们可以对项 $b(X_s)$ 在 $t_n$ 附近进行 Itô-Taylor 展开。然而，一个更直接的方法，正如问题所建议的，是展开 $b(X_s)$，然后使用 Itô 公式来处理得到的积分。对于 $s \\in [t_n, t_{n+1}]$，我们使用在 $X_n$ 处的单项泰勒级数展开来近似 $b(X_s)$：\n$$\nb(X_s) \\approx b(X_n) + b'(X_n) (X_s - X_n)\n$$\n将此代入随机积分中：\n$$\n\\int_{t_n}^{t_{n+1}} b(X_s)\\,\\mathrm{d}W_s \\approx \\int_{t_n}^{t_{n+1}} [b(X_n) + b'(X_n)(X_s - X_n)]\\,\\mathrm{d}W_s = b(X_n)\\Delta W_n + b'(X_n) \\int_{t_n}^{t_{n+1}} (X_s - X_n)\\,\\mathrm{d}W_s\n$$\n为了计算剩余的积分，我们需要对 $(X_s - X_n)$ 进行近似。为此，使用最低阶的近似（即 EM 格式本身）就足够了：\n$$\nX_s - X_n \\approx a(X_n)(s - t_n) + b(X_n)(W_s - W_{t_n})\n$$\n将此代入积分得到：\n$$\n\\int_{t_n}^{t_{n+1}} (X_s - X_n)\\,\\mathrm{d}W_s \\approx \\int_{t_n}^{t_{n+1}} [a(X_n)(s - t_n) + b(X_n)(W_s - W_{t_n})]\\,\\mathrm{d}W_s\n$$\n$$\n= a(X_n) \\int_{t_n}^{t_{n+1}} (s - t_n)\\,\\mathrm{d}W_s + b(X_n) \\int_{t_n}^{t_{n+1}} (W_s - W_{t_n})\\,\\mathrm{d}W_s\n$$\n第一项，即涉及 $\\int (s-t_n)\\,\\mathrm{d}W_s$ 的部分，贡献了一个阶为 $O((\\Delta t)^3)$ 的均方误差，其阶数高于一阶强收敛格式所要求的阶数，因此可以忽略。我们关注包含迭代 Itô 积分 $\\int (W_s - W_{t_n})\\,\\mathrm{d}W_s$ 的第二项。\n\n我们使用 Itô 公式来计算这个积分，将其应用于函数 $f(y) = y^2$ 和过程 $Y_s = W_s - W_{t_n}$。我们有 $\\mathrm{d}Y_s = \\mathrm{d}W_s$。Itô 公式表明 $\\mathrm{d}f(Y_s) = f'(Y_s)\\mathrm{d}Y_s + \\frac{1}{2}f''(Y_s)(\\mathrm{d}Y_s)^2$。\n对于 $f(y)=y^2$，我们有 $f'(y)=2y$ 和 $f''(y)=2$。因此：\n$$\n\\mathrm{d}(Y_s^2) = 2 Y_s \\mathrm{d}Y_s + \\frac{1}{2}(2)(\\mathrm{d}Y_s)^2 = 2 Y_s \\mathrm{d}W_s + \\mathrm{d}s\n$$\n对项 $Y_s \\mathrm{d}W_s$ 进行整理，并从 $t_n$ 到 $t_{n+1}$ 积分：\n$$\n\\int_{t_n}^{t_{n+1}} Y_s \\mathrm{d}W_s = \\frac{1}{2}\\int_{t_n}^{t_{n+1}}\\mathrm{d}(Y_s^2) - \\frac{1}{2}\\int_{t_n}^{t_{n+1}}\\mathrm{d}s = \\frac{1}{2}[Y_{t_{n+1}}^2 - Y_{t_n}^2] - \\frac{1}{2}[t_{n+1} - t_n]\n$$\n由于 $Y_{t_n} = W_{t_n} - W_{t_n} = 0$ 且 $Y_{t_{n+1}} = W_{t_{n+1}} - W_{t_n} = \\Delta W_n$，该积分的计算结果为：\n$$\n\\int_{t_n}^{t_{n+1}} (W_s - W_{t_n})\\,\\mathrm{d}W_s = \\frac{1}{2}[(\\Delta W_n)^2 - 0] - \\frac{1}{2}\\Delta t = \\frac{1}{2}((\\Delta W_n)^2 - \\Delta t)\n$$\n将此结果代回到随机积分的近似式中：\n$$\n\\int_{t_n}^{t_{n+1}} b(X_s)\\,\\mathrm{d}W_s \\approx b(X_n)\\Delta W_n + b(X_n)b'(X_n) \\frac{1}{2}((\\Delta W_n)^2 - \\Delta t)\n$$\n将其与漂移项近似结合，我们得到该单步方法：\n$$\nX_{n+1} = X_n + a(X_n)\\Delta t + b(X_n)\\Delta W_n + \\frac{1}{2}b(X_n)b'(X_n)((\\Delta W_n)^2 - \\Delta t)\n$$\n这就是 Milstein 方法，其强收敛阶为 1。涉及 $(\\Delta W_n)^2$ 的附加项是 Milstein 校正项。它利用了布朗增量的二阶矩恒等式 $E[(\\Delta W_n)^2] = \\Delta t$，因为该校正项的均值为零。\n\n现在，我们特化到扩散系数为常数的情形，即 $b(x) \\equiv \\sigma$，其中 $\\sigma \\neq 0$。\n要应用推导出的格式，我们需要函数 $b(x)$ 及其导数 $b'(x)$。\n对于 $b(x) = \\sigma$，其关于 $x$ 的导数为：\n$$\nb'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}(\\sigma) = 0\n$$\n现在我们将 $b(X_n) = \\sigma$ 和 $b'(X_n) = 0$ 代入 Milstein 格式中。校正项为：\n$$\n\\frac{1}{2}b(X_n)b'(X_n)((\\Delta W_n)^2 - \\Delta t) = \\frac{1}{2}(\\sigma)(0)((\\Delta W_n)^2 - \\Delta t)\n$$\n由于乘以 0 的结果为 0，整个校正项都消失了。这就是该简化的代数证明。Milstein 格式简化为：\n$$\nX_{n+1} = X_n + a(X_n)\\Delta t + \\sigma \\Delta W_n + 0 = X_n + a(X_n)\\Delta t + \\sigma \\Delta W_n\n$$\n对于具有加性噪声（即常数扩散系数）的 SDE，Milstein 格式与 Euler-Maruyama 格式相同。在这种特殊情况下，Euler-Maruyama 格式本身就能达到 1.0 阶的强收敛阶。\n\n所要求的最终答案是得到的单步更新表达式，即简化后格式的右侧部分。", "answer": "$$\n\\boxed{X_{n} + a(X_{n}) \\Delta t + \\sigma \\Delta W_{n}}\n$$", "id": "3081404"}, {"introduction": "推导出米尔斯坦格式后，我们自然会问：为什么要使用这个更复杂的公式？本练习旨在探讨米尔斯坦格式的主要优势——其卓越的强收敛速度（strong convergence rate）。通过设计一个计算实验，我们可以凭经验测量模拟误差如何随着时间步长 $h$ 的减小而减小，从而揭示米尔斯坦格式在处理乘性噪声问题时的明显优势。[@problem_id:3081428]", "problem": "考虑由以下随机微分方程（SDE）控制的几何布朗运动（GBM）\n$$\ndX_t = \\mu X_t\\,dt + \\sigma X_t\\,dW_t,\\quad X_0>0,\n$$\n其中 $W_t$ 是一个标准维纳过程。您希望对于两种具有均匀步长 $h=T/N$ 的时间离散化方法——Euler–Maruyama (EM) 方法和 Milstein 方法——估计其强均方误差 $\\mathbb{E}\\!\\left[|X_T - X_N|^2\\right]$。请设计一个计算实验，以经验性地估计每种方法的 $\\mathbb{E}\\!\\left[|X_T - X_N|^2\\right]$，并将观测到的斜率解释为步长的函数。\n\n您的设计应在科学上合理，且必须仅使用随机微积分和数值逼近的基本原理。您将模拟独立的布朗路径，并使用每种方法和多个步长来近似终值 $X_T$。为了消除因不知道精确终值而产生的偏差，请利用从伊藤微积分推导出的 GBM 精确解（此处不写出）来为每条路径计算一个参考值 $X_T$。为具体起见，取 $T=1$，$X_0=1$，$\\mu=0.3$，$\\sigma=0.5$，以及一组步长 $h\\in\\{T/16,T/32,T/64,T/128,T/256\\}$。对于每个 $h$，通过正态增量 $\\Delta W_n\\sim\\mathcal{N}(0,h)$ 模拟 $M=10000$ 条独立路径，沿着相同的路径计算终值近似 $X_N^{\\text{EM}}$ 和 $X_N^{\\text{Milstein}}$，并估计\n$$\n\\widehat{\\mathrm{MSE}}_{\\text{scheme}}(h)=\\frac{1}{M}\\sum_{m=1}^{M}\\left|X_T^{(m)}-X_N^{\\text{scheme},(m)}\\right|^2.\n$$\n然后，对于每种格式，绘制 $\\log\\big(\\widehat{\\mathrm{MSE}}_{\\text{scheme}}(h)\\big)$ 关于 $\\log(h)$ 的图像，并拟合一条直线来估计斜率。\n\n在渐近状态 $h\\to 0$ 下，对观测到的斜率的哪种解释是正确的？\n\nA. 在 $\\mathbb{E}\\!\\left[|X_T - X_N|^2\\right]$ 关于 $h$ 的对数-对数图上，Euler–Maruyama 方法产生的斜率约等于 $1$，而 Milstein 方法产生的斜率约等于 $2$。这分别对应于均方根强误差按 $h^{1/2}$ 和 $h^{1}$ 的比例缩放。\n\nB. Euler–Maruyama 方法产生的斜率约等于 $1/2$，而 Milstein 方法产生的斜率约等于 $1$，因为均方误差本身按 $h^{1/2}$ 和 $h^{1}$ 的比例缩放。\n\nC. 对于 GBM，两种方法产生的斜率都约等于 $1$，因为乘性噪声导致它们具有相同的强收敛阶。\n\nD. Euler–Maruyama 方法产生的斜率约等于 $2$，而 Milstein 方法产生的斜率约等于 $1$，这是由于 Milstein 方法在乘性噪声下的不稳定性。\n\nE. 斜率非平凡地依赖于 $\\mu$ 和 $\\sigma$，并且不是渐近常数；增加 $\\sigma$ 会减小两种方法的斜率。", "solution": "### 问题验证\n\n#### 步骤 1：提取已知信息\n\n问题陈述提供了以下信息：\n-   **随机微分方程 (SDE)**：几何布朗运动 (GBM)，由 $dX_t = \\mu X_t\\,dt + \\sigma X_t\\,dW_t$ 给出，初始条件为 $X_0 > 0$。\n-   **过程**：$W_t$ 是一个标准维纳过程。\n-   **目标**：解释一个为估计强均方误差 $\\mathbb{E}\\!\\left[|X_T - X_N|^2\\right]$ 而设计的计算实验中观测到的斜率。\n-   **数值方法**：Euler–Maruyama (EM) 方法和 Milstein 方法。\n-   **离散化**：均匀步长 $h=T/N$。\n-   **计算实验设置**：\n    -   对每条路径，使用已知的 GBM SDE 精确解计算参考解 $X_T$。\n    -   模拟参数：$T=1$，$X_0=1$，$\\mu=0.3$，$\\sigma=0.5$。\n    -   步长集合：$h\\in\\{T/16, T/32, T/64, T/128, T/256\\}$。\n    -   蒙特卡洛模拟次数：对于每个 $h$，进行 $M=10000$ 次独立路径模拟。\n    -   维纳增量：$\\Delta W_n \\sim \\mathcal{N}(0,h)$。\n    -   误差估计量：样本均方误差计算为 $\\widehat{\\mathrm{MSE}}_{\\text{scheme}}(h)=\\frac{1}{M}\\sum_{m=1}^{M}\\left|X_T^{(m)}-X_N^{\\text{scheme},(m)}\\right|^2$。\n    -   分析方法：对于每种格式，绘制 $\\log\\big(\\widehat{\\mathrm{MSE}}_{\\text{scheme}}(h)\\big)$ 关于 $\\log(h)$ 的图像，并拟合一条直线来估计斜率。\n-   **问题**：在渐近状态 $h\\to 0$ 下，对观测到的斜率的正确解释是什么？\n\n#### 步骤 2：使用提取的已知信息进行验证\n\n该问题陈述是随机微分方程数值分析中一个定义明确的练习。\n-   **有科学依据**：该问题基于 SDE 及其数值逼近的标准理论。GBM 是一个基本模型，而 Euler-Maruyama 和 Milstein 格式是典范的数值方法。强收敛的概念及其通过均方误差的对数-对数图进行的数值验证是该领域的标准程序。该设置在科学上和数学上都是合理的。\n-   **适定性**：该问题要求给出两种标准格式应用于一个标准 SDE 时的理论强收敛率。这些收敛率在文献中已有定论，从而可以对实验结果做出唯一且正确的解释。\n-   **客观性**：问题通过精确的数值和数学定义进行指定，没有主观解释的余地。\n-   **完备性与一致性**：该问题是自洽的。所有必要的参数（$T, X_0, \\mu, \\sigma$）、方法和分析过程都已明确定义。没有矛盾之处。使用精确解来计算误差是分离数值格式离散化误差的标准技术。\n\n#### 步骤 3：结论与行动\n\n问题陈述是有效的。这是一个关于 SDEs 数值方法收敛性质的标准且适定的问题。我将继续推导解决方案。\n\n### 解题推导\n\n该问题要求对应用于给定 SDE 的 Euler-Maruyama 和 Milstein 格式的均方误差关于步长 $h$ 的对数-对数图的斜率进行理论解释。\n\n该 SDE 具有一般形式 $dX_t = a(X_t) dt + b(X_t) dW_t$。对于给定的几何布朗运动，其漂移系数和扩散系数分别为 $a(x) = \\mu x$ 和 $b(x) = \\sigma x$。\n\n一个数值格式的强收敛阶定义为最大的值 $\\gamma > 0$，使得对于任何最终时间 $T$，存在一个常数 $C$（与步长 $h$ 无关），满足在时间 $T$ 的全局误差：\n$$\n\\mathbb{E}\\left[|X_T - X_N|\\right] \\le C h^\\gamma\n$$\n其中 $X_N$ 是在时间 $T=Nh$ 处的数值近似。\n\n均方误差（MSE）是本问题中要估计的量，即 $\\mathbb{E}\\left[|X_T - X_N|^2\\right]$。均方误差的阶数与强收敛阶有关。可以证明，MSE 的收敛阶为 $2\\gamma$：\n$$\n\\text{MSE}(h) = \\mathbb{E}\\left[|X_T - X_N|^2\\right] \\le K h^{2\\gamma}\n$$\n其中 $K$ 是某个常数。在渐近极限 $h \\to 0$ 下，我们可以写成 $\\text{MSE}(h) \\approx K h^{p}$，其中 $p=2\\gamma$ 是均方收敛阶。\n\n问题描述了绘制 $\\log(\\text{MSE})$ 关于 $\\log(h)$ 的图像。对上述渐近关系取对数，得到：\n$$\n\\log(\\text{MSE}(h)) \\approx \\log(K) + p \\log(h)\n$$\n这是一个以 $\\log(\\text{MSE}(h))$ 为因变量、$\\log(h)$ 为自变量的直线方程。这条直线的斜率是 $p$，它等于 $2\\gamma$。\n\n我们现在分析每一种格式。\n\n**1. Euler-Maruyama (EM) 方法**\n其离散格式为：\n$$\nX_{n+1} = X_n + a(X_n)h + b(X_n)\\Delta W_n\n$$\n对于给定的 GBM，这变为：\n$$\nX_{n+1}^{\\text{EM}} = X_n + \\mu X_n h + \\sigma X_n \\Delta W_n = X_n (1 + \\mu h + \\sigma \\Delta W_n)\n$$\n众所周知，对于具有全局 Lipschitz 系数的一般 SDEs，Euler-Maruyama 方法的强收敛阶为 $\\gamma = 0.5$，这对 GBM 也成立。\n因此，均方误差的指数为 $p = 2\\gamma = 2 \\times 0.5 = 1$。\n对于 Euler-Maruyama 方法，MSE vs. $h$ 的对数-对数图的斜率预期为 $1$。\n\n**2. Milstein 方法**\nMilstein 格式源于一个更高阶的 Itô-Taylor 展开。该格式为：\n$$\nX_{n+1} = X_n + a(X_n)h + b(X_n)\\Delta W_n + \\frac{1}{2} b(X_n) b'(X_n) \\left((\\Delta W_n)^2 - h\\right)\n$$\n其中 $b'(x)$ 是 $b(x)$ 关于 $x$ 的导数。对于 GBM，$b(x) = \\sigma x$，所以其导数为 $b'(x) = \\sigma$。项 $b(x)b'(x) = (\\sigma x)(\\sigma) = \\sigma^2 x$。\n将此代入 Milstein 格式，得到：\n$$\nX_{n+1}^{\\text{Milstein}} = X_n + \\mu X_n h + \\sigma X_n \\Delta W_n + \\frac{1}{2} \\sigma^2 X_n \\left((\\Delta W_n)^2 - h\\right)\n$$\nMilstein 方法是专门为改进具有非恒定扩散系数（乘性噪声）的 SDEs 的强收敛阶而设计的。对于这类 SDEs，包括 GBM，其强收敛阶为 $\\gamma = 1.0$。\n因此，均方误差的指数为 $p = 2\\gamma = 2 \\times 1.0 = 2$。\n对于 Milstein 方法，MSE vs. $h$ 的对数-对数图的斜率预期为 $2$。\n\n**预期斜率总结：**\n-   Euler-Maruyama：斜率 $p=1$。\n-   Milstein：斜率 $p=2$。\n\n### 选项评估\n\n**A. 在 $\\mathbb{E}\\!\\left[|X_T - X_N|^2\\right]$ 关于 $h$ 的对数-对数图上，Euler–Maruyama 方法产生的斜率约等于 $1$，而 Milstein 方法产生的斜率约等于 $2$。这分别对应于均方根强误差按 $h^{1/2}$ 和 $h^{1}$ 的比例缩放。**\n这个陈述与我们的推导完全一致。EM 方法的 MSE 斜率为 $p=1$ 意味着 MSE 的缩放阶为 $\\mathcal{O}(h^1)$。那么，均方根 (RMS) 误差 $\\sqrt{\\text{MSE}}$ 将按 $\\sqrt{h^1} = h^{0.5}$ 比例缩放，这对应于强收敛阶 $\\gamma=0.5$。Milstein 方法的 MSE 斜率为 $p=2$ 意味着 MSE 的缩放阶为 $\\mathcal{O}(h^2)$。那么，RMS 误差将按 $\\sqrt{h^2} = h^1$ 比例缩放，这对应于强收敛阶 $\\gamma=1.0$。该选项完全正确。\n**结论：正确。**\n\n**B. Euler–Maruyama 方法产生的斜率约等于 $1/2$，而 Milstein 方法产生的斜率约等于 $1$，因为均方误差本身按 $h^{1/2}$ 和 $h^{1}$ 的比例缩放。**\n这是不正确的。数值 $1/2$ 和 $1$ 是强收敛阶 ($\\gamma$)，而不是 MSE 对数-对数图的斜率。MSE 对数-对数图的斜率是 $p=2\\gamma$。此外，关于 MSE “按 $h^{1/2}$ 和 $h^1$ 比例缩放”的说法是不一致的；第一部分是错误的，因为 EM 的 MSE 是按 $h^1$ 比例缩放的。\n**结论：不正确。**\n\n**C. 对于 GBM，两种方法产生的斜率都约等于 $1$，因为乘性噪声导致它们具有相同的强收敛阶。**\n这是不正确的。Milstein 方法是专门为在具有乘性噪声（如 GBM）的 SDEs 上实现比 Euler-Maruyama 更高的强收敛阶而设计的。如果噪声是加性的（即 $b(x)$ 是一个常数），那么 $b'(x)=0$，Milstein 格式将退化为 Euler-Maruyama 格式，它们将具有相同的收敛阶（对于强收敛，此阶数对于加性噪声通常为 0.5）。但对于乘性噪声，Milstein 方法更优越。\n**结论：不正确。**\n\n**D. Euler–Maruyama 方法产生的斜率约等于 $2$，而 Milstein 方法产生的斜率约等于 $1$，这是由于 Milstein 方法在乘性噪声下的不稳定性。**\n这是不正确的。收敛阶被颠倒了。Milstein 方法并非不稳定；在这种情况下，它在强收敛方面比 Euler-Maruyama 更准确。\n**结论：不正确。**\n\n**E. 斜率非平凡地依赖于 $\\mu$ 和 $\\sigma$，并且不是渐近常数；增加 $\\sigma$ 会减小两种方法的斜率。**\n这是不正确的。收敛的*阶数*，也就是对数-对数误差图的渐近斜率，是数值方法和 SDE 类型的结构性质。虽然误差界 $\\text{MSE} \\le K h^{2\\gamma}$ 中的常数 $K$ 依赖于 $\\mu$、$\\sigma$ 和 $T$，但指数 $2\\gamma$（即斜率）并不依赖。它是一个当 $h \\to 0$ 时的渐近特性。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "3081428"}, {"introduction": "在了解了理论推导和实际精度优势之后，人们很容易认为米尔斯坦格式总是更好的选择。然而，最后一个练习提出了一个关键且有些出人意料的反例。通过分析两种格式的数值稳定性，你将发现对于某些参数，米尔斯坦格式的稳定性条件可能比更简单的欧拉-丸山格式更为苛刻，这突显了在精度和稳定性之间需要权衡的关键一点。[@problem_id:2443132]", "problem": "您的任务是构建并分析一个标量随机微分方程，在该方程中，对于时间步长的选择，Milstein格式的数值稳定性比Euler–Maruyama格式的数值稳定性要求更严格。考虑由下式给出的具有乘性噪声的标量随机微分方程\n$$\n\\mathrm{d}X_t = a\\,X_t\\,\\mathrm{d}t + b\\,X_t\\,\\mathrm{d}W_t,\n$$\n其中 $a \\in \\mathbb{R}$ 和 $b \\in \\mathbb{R}$ 是常数，$X_0 \\in \\mathbb{R}$ 是具有有限二阶矩的给定初始值，$W_t$ 是标准维纳过程。对于此任务，您必须使用特定的参数值 $a=-2$ 和 $b=1$。连续时间系统的零解是一个平衡点，离散时间近似的均方稳定性指的是二阶矩 $\\,\\mathbb{E}[X_n^2]\\,$ 是否随着步长指数 $n$ 的增加而呈几何级数递减。\n\n您的程序必须对每个给定的时间步长 $\\,\\Delta t\\,$，判断以下两种应用于上述方程的离散化格式是否是均方稳定的，即其单步均方放大因子是否严格小于 $\\,1$：\n- Euler–Maruyama 格式。\n- Milstein 格式。\n\n时间步长的测试集为\n$$\n\\{\\Delta t_1, \\Delta t_2, \\Delta t_3\\} = \\{\\,0.1,\\,0.7,\\,1.0\\,\\}。\n$$\n对于此集合中的每个 $\\,\\Delta t\\,$，评估两个布尔值：Euler–Maruyama 格式在该 $\\,\\Delta t\\,$ 下的均方稳定性，以及 Milstein 格式在该 $\\,\\Delta t\\,$ 下的均方稳定性。当且仅当一个格式的单步均方放大因子严格小于 $\\,1$ 时，声明该格式为“稳定”(stable)，否则为“不稳定”(unstable)。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，其顺序为\n$$\n[\\text{EM}(\\Delta t_1),\\ \\text{Mil}(\\Delta t_1),\\ \\text{EM}(\\Delta t_2),\\ \\text{Mil}(\\Delta t_2),\\ \\text{EM}(\\Delta t_3),\\ \\text{Mil}(\\Delta t_3)],\n$$\n其中 $\\,\\text{EM}(\\Delta t)\\,$ 和 $\\,\\text{Mil}(\\Delta t)\\,$ 是分别表示 Euler–Maruyama 和 Milstein 格式在时间步长 $\\,\\Delta t\\,$ 下均方稳定性的布尔值。要求的输出是一个包含六个布尔值的列表，格式化为单行，不含任何附加文本或字符。", "solution": "所述问题是有效的。它具有科学依据，问题提法得当且客观。它使用既定定义和一个具体示例，对随机微分方程常用离散化格式的数值稳定性进行了标准探究。所有必要的数据和条件均已提供，不存在矛盾或歧义。我们将继续进行推导和求解。\n\n该问题要求分析两种数值格式对于标量随机微分方程（SDE）的均方稳定性\n$$\n\\mathrm{d}X_t = a X_t \\mathrm{d}t + b X_t \\mathrm{d}W_t,\n$$\n参数为 $a = -2$ 和 $b = 1$。$W_t$ 是一个标准维纳过程。在离散时间 $t_n = n \\Delta t$ 上的 $X(t_n)$ 的数值近似 $X_n$ 被认为是均方稳定的，如果其单步均方放大因子 $R$ 严格小于1。放大因子定义为 $R = \\mathbb{E}[X_{n+1}^2 | \\mathcal{F}_{t_n}] / X_n^2$，其中 $\\mathbb{E}[ \\cdot | \\mathcal{F}_{t_n}]$ 表示在时间 $t_n$ 可用信息下的条件期望。由于 $X_n$ 在第 $n$ 步是已知的，这可以简化为 $R = \\mathbb{E}[(X_{n+1}/X_n)^2]$。稳定性的条件是 $R < 1$。\n\n我们将分别分析 Euler–Maruyama 和 Milstein 格式。在这些推导中，我们使用维纳增量 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ 的矩，它是一个均值为零、方差为 $\\Delta t$ 的正态分布随机变量。具体来说，$\\mathbb{E}[\\Delta W_n] = 0$ 且 $\\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$。对于 Milstein 格式，我们还需要更高阶的矩：$\\mathbbE}[(\\Delta W_n)^3] = 0$ 和 $\\mathbb{E}[(\\Delta W_n)^4] = 3(\\Delta t)^2$。\n\n**1. Euler–Maruyama (EM) 格式**\n\n给定 SDE 的 Euler–Maruyama 格式为\n$$\nX_{n+1} = X_n + a X_n \\Delta t + b X_n \\Delta W_n = X_n (1 + a \\Delta t + b \\Delta W_n).\n$$\n单步均方放大因子 $R_{EM}$ 为\n$$\nR_{EM} = \\mathbb{E}\\left[ \\left(\\frac{X_{n+1}}{X_n}\\right)^2 \\right] = \\mathbb{E}[ (1 + a \\Delta t + b \\Delta W_n)^2 ].\n$$\n展开平方并求期望可得：\n$$\nR_{EM} = \\mathbb{E}[ 1 + (a \\Delta t)^2 + b^2 (\\Delta W_n)^2 + 2a \\Delta t + 2b \\Delta W_n + 2ab \\Delta t \\Delta W_n ]\n$$\n$$\nR_{EM} = 1 + (a \\Delta t)^2 + b^2 \\mathbb{E}[(\\Delta W_n)^2] + 2a \\Delta t + 2b \\mathbb{E}[\\Delta W_n] + 2ab \\Delta t \\mathbb{E}[\\Delta W_n].\n$$\n代入 $\\Delta W_n$ 的矩：\n$$\nR_{EM} = 1 + a^2 (\\Delta t)^2 + b^2 \\Delta t + 2a \\Delta t = (1 + a \\Delta t)^2 + b^2 \\Delta t.\n$$\n为保证均方稳定性，我们需要 $R_{EM} < 1$。当 $a = -2$ 且 $b = 1$ 时：\n$$\n(1 - 2 \\Delta t)^2 + (1)^2 \\Delta t < 1\n$$\n$$\n1 - 4 \\Delta t + 4(\\Delta t)^2 + \\Delta t < 1\n$$\n$$\n4(\\Delta t)^2 - 3 \\Delta t < 0.\n$$\n由于 $\\Delta t > 0$，我们可以除以 $\\Delta t$ 来获得稳定性条件：\n$$\n4 \\Delta t - 3 < 0 \\implies \\Delta t < \\frac{3}{4} = 0.75.\n$$\n\n**2. Milstein 格式**\n\n通用的 Milstein 格式为 $X_{n+1} = X_n + f(X_n)\\Delta t + g(X_n)\\Delta W_n + \\frac{1}{2}g(X_n)g'(X_n)((\\Delta W_n)^2 - \\Delta t)$。对于我们的 SDE，$f(x) = ax$ 且 $g(x) = bx$，所以 $g'(x) = b$。该格式变为：\n$$\nX_{n+1} = X_n + a X_n \\Delta t + b X_n \\Delta W_n + \\frac{1}{2}(b X_n)(b)((\\Delta W_n)^2 - \\Delta t)\n$$\n$$\nX_{n+1} = X_n \\left( 1 + a \\Delta t - \\frac{1}{2}b^2 \\Delta t + b \\Delta W_n + \\frac{1}{2}b^2 (\\Delta W_n)^2 \\right).\n$$\n放大因子 $R_{Mil}$ 是括号中项的平方的期望。设 $C = 1 + a \\Delta t - \\frac{1}{2}b^2 \\Delta t$。\n$$\nR_{Mil} = \\mathbb{E}\\left[ \\left( C + b \\Delta W_n + \\frac{1}{2}b^2 (\\Delta W_n)^2 \\right)^2 \\right]\n$$\n$$\nR_{Mil} = \\mathbb{E}\\left[ C^2 + b^2(\\Delta W_n)^2 + \\frac{1}{4}b^4(\\Delta W_n)^4 + 2C b \\Delta W_n + C b^2 (\\Delta W_n)^2 + b^3 (\\Delta W_n)^3 \\right].\n$$\n使用 $\\Delta W_n$ 的矩逐项求期望：\n$$\nR_{Mil} = C^2 + b^2\\Delta t + \\frac{1}{4}b^4(3(\\Delta t)^2) + 2C b(0) + C b^2 \\Delta t + b^3(0)\n$$\n$$\nR_{Mil} = C^2 + C b^2 \\Delta t + b^2 \\Delta t + \\frac{3}{4} b^4 (\\Delta t)^2.\n$$\n将 $C = 1 + a \\Delta t - \\frac{1}{2}b^2 \\Delta t$ 代回表达式中：\n$$\nR_{Mil} = \\left(1 + a \\Delta t - \\frac{1}{2}b^2 \\Delta t\\right)^2 + \\left(1 + a \\Delta t - \\frac{1}{2}b^2 \\Delta t\\right)b^2 \\Delta t + b^2 \\Delta t + \\frac{3}{4}b^4 (\\Delta t)^2\n$$\n$$\nR_{Mil} = \\left((1+a\\Delta t) - \\frac{1}{2}b^2\\Delta t\\right) \\left((1+a\\Delta t) + \\frac{1}{2}b^2\\Delta t\\right) + b^2\\Delta t + \\frac{3}{4}b^4 (\\Delta t)^2\n$$\n$$\nR_{Mil} = (1+a\\Delta t)^2 - \\frac{1}{4}b^4(\\Delta t)^2 + b^2\\Delta t + \\frac{3}{4}b^4(\\Delta t)^2 = (1+a\\Delta t)^2 + b^2\\Delta t + \\frac{1}{2}b^4(\\Delta t)^2.\n$$\n为保证均方稳定性，我们需要 $R_{Mil} < 1$。当 $a = -2$ 且 $b = 1$ 时：\n$$\n(1 - 2 \\Delta t)^2 + \\Delta t + \\frac{1}{2}(1)^4 (\\Delta t)^2 < 1\n$$\n$$\n1 - 4 \\Delta t + 4(\\Delta t)^2 + \\Delta t + \\frac{1}{2}(\\Delta t)^2 < 1\n$$\n$$\n\\frac{9}{2}(\\Delta t)^2 - 3 \\Delta t < 0.\n$$\n除以 $\\Delta t > 0$：\n$$\n\\frac{9}{2} \\Delta t - 3 < 0 \\implies \\Delta t < \\frac{3}{9/2} = \\frac{6}{9} = \\frac{2}{3}.\n$$\n\n**3. 测试用例评估**\n\n我们得到了稳定性区域：\n- Euler–Maruyama：$\\Delta t < 0.75$\n- Milstein：$\\Delta t < 2/3 \\approx 0.667$\n\n现在我们测试给定的时间步长 $\\{\\Delta t_1, \\Delta t_2, \\Delta t_3\\} = \\{0.1, 0.7, 1.0\\}$。如果一个格式的 $\\Delta t$ 在其稳定性区域内，则该格式是稳定的。\n\n- 对于 $\\Delta t_1 = 0.1$：\n  - EM: $0.1 < 0.75 \\implies \\text{稳定 (True)}$\n  - Milstein: $0.1 < 2/3 \\implies \\text{稳定 (True)}$\n\n- 对于 $\\Delta t_2 = 0.7$：\n  - EM: $0.7 < 0.75 \\implies \\text{稳定 (True)}$\n  - Milstein: $0.7 > 2/3 \\implies \\text{不稳定 (False)}$\n\n- 对于 $\\Delta t_3 = 1.0$：\n  - EM: $1.0 > 0.75 \\implies \\text{不稳定 (False)}$\n  - Milstein: $1.0 > 2/3 \\implies \\text{不稳定 (False)}$\n\n得到的布尔值序列是 [True, True, True, False, False, False]。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Determines the mean-square stability of the Euler-Maruyama and Milstein schemes\n    for a specific SDE at given timesteps.\n    \"\"\"\n    # Parameters for the SDE: dX = a*X*dt + b*X*dW\n    a = -2.0\n    b = 1.0\n\n    # Test suite of timesteps\n    test_cases = [0.1, 0.7, 1.0]\n\n    results = []\n    \n    # The mean-square stability condition for a scheme is that its one-step\n    # amplification factor R must be strictly less than 1.\n\n    for dt in test_cases:\n        # Euler-Maruyama stability analysis:\n        # The amplification factor is R_EM = (1 + a*dt)^2 + b^2*dt.\n        # The stability condition R_EM < 1 simplifies to:\n        # (1 - 2*dt)^2 + dt < 1\n        # 1 - 4*dt + 4*dt^2 + dt < 1\n        # 4*dt^2 - 3*dt < 0\n        # dt * (4*dt - 3) < 0\n        # Since dt > 0, the condition is 4*dt - 3 < 0.\n        em_stable = (4.0 * dt - 3.0) < 0\n        results.append(em_stable)\n\n        # Milstein stability analysis:\n        # The amplification factor is R_Mil = (1 + a*dt)^2 + b^2*dt + 0.5*b^4*dt^2.\n        # The stability condition R_Mil < 1 simplifies to:\n        # (1 - 2*dt)^2 + dt + 0.5*dt^2 < 1\n        # 1 - 4*dt + 4*dt^2 + dt + 0.5*dt^2 < 1\n        # 4.5*dt^2 - 3*dt < 0\n        # dt * (4.5*dt - 3) < 0\n        # Since dt > 0, the condition is 4.5*dt - 3 < 0.\n        mil_stable = (4.5 * dt - 3.0) < 0\n        results.append(mil_stable)\n\n    # Final print statement in the exact required format.\n    # The str() of a boolean is 'True' or 'False'.\n    print(f\"[{', '.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2443132"}]}