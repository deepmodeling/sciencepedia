{"hands_on_practices": [{"introduction": "要真正理解无套利原则，最好的方法莫过于在一个简化的市场中亲手构建一个套利策略。单期二叉树模型为我们提供了这样一个理想的“沙盒”。通过分析资产在“上涨”和“下跌”两种状态下的收益与无风险利率的关系，我们可以推导出市场不存在套利机会的根本条件。这个练习将引导你识别市场定价的失衡，并利用它来构造一个零成本、零风险、正收益的投资组合，从而将抽象的金融理论转化为具体的盈利操作 [@problem_id:3038414]。", "problem": "考虑一个单期二叉树金融市场，它被视为随机微分方程（SDE）模型的最简单离散时间近似。市场中存在一种风险资产，其当前价格为 $S_0$，在下一个时间步长，其价格将变为两个可能值之一：上涨状态下的 $S_0 u$ 或下跌状态下的 $S_0 d$，其中 $u0$ 且 $d0$。此外，还有一个无风险货币市场账户，其今天的价值为 $B_0=1$，在下一个时间步长的价值为 $B_1=1+r$，其中 $r-1$ 是无风险利率。\n\n一个自融资投资组合由其在风险资产（以股数为单位）和货币市场账户（以账户单位为单位）中的恒定持仓 $(\\phi,\\psi)$ 决定，其初始成本为 $\\phi S_0+\\psi$。套利是指一个初始成本为零的自融资投资组合，其期末收益几乎必然非负，并以正概率严格为正。\n\n仅使用这些核心定义，推导出一个联系 $u$、$d$ 和 $r$ 的必要条件，该条件必须成立才能排除此二叉树市场中的套利机会。特别地，讨论当 $d\\ge 1+r$ 或 $u\\le 1+r$ 时会发生什么。\n\n然后，考虑具体参数值 $S_0=80$，$u=1.05$，$d=1.03$ 和 $r=0.02$。判断该市场是否违反了无套利条件。如果违反，构造一个明确的自融资套利策略，该策略仅使用风险资产和货币市场账户，初始成本为零，并在两种状态下都产生非负收益，且至少在一种状态下收益严格为正。计算您策略在每种状态下的期末收益，并以货币单位报告该策略的每股最低保证利润作为您的最终答案。无需四舍五入；报告精确值。", "solution": "该问题要求在单期二叉树模型中推导无套利条件，分析特定参数值是否存在套利，如果存在套利则构建一个套利投资组合，并计算其每股最低保证利润。\n\n首先，我们验证问题陈述的有效性。\n**步骤1：提取已知条件**\n- 风险资产初始价格：$S_0$。\n- 风险资产期末价格：$S_0 u$（上涨状态），$S_0 d$（下跌状态），其中 $u0, d0$。\n- 无风险资产初始价值：$B_0=1$。\n- 无风险资产期末价值：$B_1=1+r$，其中 $r-1$。\n- 一个自融资投资组合由其在风险资产和无风险资产中的持仓 $(\\phi, \\psi)$ 定义。\n- 投资组合初始成本：$V_0 = \\phi S_0 + \\psi$。\n- 套利是一个自融资投资组合，满足 $V_0=0$，在所有状态下期末收益 $V_1 \\ge 0$，且在至少一个状态下 $V_1  0$。\n- 用于分析的具体参数：$S_0=80$，$u=1.05$，$d=1.03$ 和 $r=0.02$。\n\n**步骤2：使用提取的已知条件进行验证**\n- 该问题具有科学依据，是基于无套利基本原则的介绍性数理金融中的一个标准练习。\n- 问题提法清晰，提供了推导条件和构建所需投资组合的所有必要定义和数据。\n- 语言客观、精确。\n- 设定是自洽且一致的。参数是现实的。\n- 问题并非微不足道，考验了对核心概念的理解。\n\n**步骤3：结论与行动**\n问题有效。我们开始求解。\n\n一个自融资投资组合由 $(\\phi, \\psi)$ 描述，其中 $\\phi$ 是风险资产的股数，$\\psi$ 是无风险货币市场账户的单位数。投资组合的初始价值为 $V_0 = \\phi S_0 + \\psi B_0$。由于 $B_0=1$，因此初始价值为 $V_0 = \\phi S_0 + \\psi$。期末价值为 $V_1 = \\phi S_1 + \\psi B_1 = \\phi S_1 + \\psi (1+r)$。\n\n套利是一个满足以下三个条件的自融资投资组合：\n1.  初始成本为零：$V_0 = \\phi S_0 + \\psi = 0$。\n2.  在所有状态下，期末收益为非负：$V_1 \\ge 0$。\n3.  在至少一种状态下，期末收益严格为正。\n\n根据零成本条件，我们可以用风险资产的持仓来表示无风险资产的持仓：$\\psi = -\\phi S_0$。这意味着该策略包括持有 $\\phi$ 股股票，并通过在货币市场账户中建立一个价值为 $\\phi S_0$ 的相反头寸来融资。\n\n将 $\\psi$ 代入期末价值的表达式，我们得到：\n$V_1 = \\phi S_1 + (-\\phi S_0)(1+r) = \\phi (S_1 - S_0(1+r))$。\n\n期末价值 $V_1$ 取决于市场状态。我们分别用 $V_{1,u}$ 和 $V_{1,d}$ 表示上涨和下跌状态下的收益。\n- 在上涨状态下，$S_1 = S_0 u$，因此收益为 $V_{1,u} = \\phi (S_0 u - S_0(1+r)) = \\phi S_0 (u - (1+r))$。\n- 在下跌状态下，$S_1 = S_0 d$，因此收益为 $V_{1,d} = \\phi (S_0 d - S_0(1+r)) = \\phi S_0 (d - (1+r))$。\n\n要存在套利，必须满足 $V_{1,u} \\ge 0$，$V_{1,d} \\ge 0$，且其中至少一个为严格不等式。让我们考虑 $\\phi$ 的两种情况。\n\n情况1：$\\phi  0$（持有多头股票，空头债券）。\n由于 $\\phi S_0  0$，套利条件变为：\n- $u - (1+r) \\ge 0 \\implies u \\ge 1+r$。\n- $d - (1+r) \\ge 0 \\implies d \\ge 1+r$。\n- 必须至少有一个严格不等式成立。由于在一个非平凡模型中，通常假设 $u  d$，如果 $d \\ge 1+r$，那么 $u  d \\ge 1+r$，这意味着 $u  1+r$。在这种情况下，$V_{1,u}  0$ 且 $V_{1,d} \\ge 0$。因此，如果 $d \\ge 1+r$，就存在套利机会。该策略涉及借钱购买股票，因为在两种情况下，股票的增长至少与贷款利息一样好。\n\n情况2：$\\phi  0$（持有空头股票，多头债券）。\n由于 $\\phi S_0  0$，套利条件的不等号方向相反：\n- $u - (1+r) \\le 0 \\implies u \\le 1+r$。\n- $d - (1+r) \\le 0 \\implies d \\le 1+r$。\n- 必须至少有一个严格不等式成立。由于 $u  d$，如果 $u \\le 1+r$，那么 $d  u \\le 1+r$，这意味着 $d  1+r$。在这种情况下，$V_{1,d}  0$ 且 $V_{1,u} \\ge 0$。因此，如果 $u \\le 1+r$，就存在套利机会。该策略涉及卖空股票并将所得款项投资于无风险资产，因为在两种情况下，无风险回报至少与股票的增长一样好。\n\n为了排除任何套利机会，这两种情况都必须被阻止。\n- 为了防止情况1的套利，我们必须有其条件的相反情况，即 $d  1+r$。\n- 为了防止情况2的套利，我们必须有其条件的相反情况，即 $u  1+r$。\n\n结合这两点，不存在套利的必要条件是 $d  1+r  u$。这确保了无风险回报率严格位于风险资产在下跌和上涨状态下的回报率之间。\n\n现在，我们分析具体的参数值：$S_0=80$，$u=1.05$，$d=1.03$ 和 $r=0.02$。\n无风险增长因子是 $1+r = 1+0.02 = 1.02$。\n我们检查无套利条件：$d  1+r  u$。\n代入数值：$1.03  1.02  1.05$。\n这个陈述是错误的，因为 $1.03$ 不小于 $1.02$。具体来说，我们有 $d=1.03  1+r=1.02$。\n因此，市场违反了无套利条件。这种违规对应于情况1，即 $d \\ge 1+r$，表明通过借款融资买入股票存在套利机会。\n\n我们现在构建一个明确的套利策略。让我们选择购买 $\\phi=1$ 股股票。\n- 购买股票的成本是 $\\phi S_0 = 1 \\times 80 = 80$。\n- 为了创建一个零成本的投资组合，我们必须借入这笔款项。这对应于将我们在货币市场账户中的持仓设为 $\\psi = -80$。\n- 该投资组合的初始价值为 $V_0 = \\phi S_0 + \\psi B_0 = (1)(80) + (-80)(1) = 0$。\n\n接下来，我们计算该策略的期末收益。贷款的期末偿还义务是 $\\psi B_1 = -80 \\times (1+0.02) = -80 \\times 1.02 = -81.6$。投资组合的期末价值是 $V_1 = \\phi S_1 - 81.6 = S_1 - 81.6$。\n- 在上涨状态下，股票价格变为 $S_{1,u} = S_0 u = 80 \\times 1.05 = 84$。\n期末收益为 $V_{1,u} = 84 - 81.6 = 2.4$。\n- 在下跌状态下，股票价格变为 $S_{1,d} = S_0 d = 80 \\times 1.03 = 82.4$。\n期末收益为 $V_{1,d} = 82.4 - 81.6 = 0.8$。\n\n该策略在上涨状态下产生 $2.4$ 的利润，在下跌状态下产生 $0.8$ 的利润，而初始投资为零。两种收益都严格为正，证实了这是一种套利。\n\n最后的问题是求每股的最低保证利润。\n该策略每股持仓的利润由 $\\frac{V_1}{\\phi}$ 给出。\n- 上涨状态下每股利润：$\\frac{V_{1,u}}{\\phi} = \\frac{\\phi S_0 (u - (1+r))}{\\phi} = S_0 (u - (1+r)) = 80(1.05-1.02) = 80(0.03) = 2.4$。\n- 下跌状态下每股利润：$\\frac{V_{1,d}}{\\phi} = \\frac{\\phi S_0 (d - (1+r))}{\\phi} = S_0 (d - (1+r)) = 80(1.03-1.02) = 80(0.01) = 0.8$。\n\n每股最低保证利润是这两个值中的较小者。\n每股最低保证利润 $= \\min(2.4, 0.8) = 0.8$。\n这个值与套利投资组合选择的股数 $\\phi$ 无关（只要 $\\phi0$）。\n最终答案以货币单位表示，所以是 $0.8$。", "answer": "$$\\boxed{0.8}$$", "id": "3038414"}, {"introduction": "从离散的二叉树模型过渡到更真实的连续时间模型后，我们面临一个核心问题：如何动态地复制一个衍生品并消除其风险？理论上的完美复制依赖于连续不断的交易调整，即连续的 Delta 对冲。然而，在现实世界中，交易总是在离散的时间点上进行，这便产生了所谓的“对冲误差”。这个练习将深入探讨这种误差的来源，揭示期权的 Gamma ($\\Gamma$)，即价格对标的资产价格的二阶敏感度，是如何在离散对冲中产生风险的，从而加深你对连续时间对冲机制为何能消除随机风险的理解 [@problem_id:3038454]。", "problem": "考虑一个无摩擦市场，其中有一个单一的风险资产，其价格过程 $S_t$ 服从随机微分方程 (SDE) $\\,dS_t=\\mu_t S_t\\,dt+\\sigma_t S_t\\,dW_t\\,$，其中 $W_t$ 是一个维纳过程（布朗运动），还有一个货币市场账户 $B_t$ 满足 $\\,dB_t=r_t B_t\\,dt\\,$，其短期利率为 $r_t$。设 $V(S,t)$ 表示一个二次连续可微的欧式或有债权在时间 $t$ 的价值。定义 delta 为 $\\Delta=\\partial_S V$，gamma 为 $\\Gamma=\\partial_{SS}V$。一个交易员构建了一个 delta 对冲组合，在时间 $t$ 持有 $\\Delta_t=\\partial_S V(S_t,t)$ 单位的标的资产，并且仅在离散时间点进行再平衡，在区间 $[t,t+\\Delta t]$ 内保持 $\\Delta_t$ 不变。设 $\\Delta W=W_{t+\\Delta t}-W_t$ 表示布朗增量，且 $\\Delta W\\sim \\mathcal{N}(0,\\Delta t)$。\n\n哪个选项正确地描述了由离散再平衡引起的在 $[t,t+\\Delta t]$ 期间对冲误差的主阶随机贡献（用 $\\Gamma$ 表示），并且也正确地解释了为什么连续交易（即时更新 $\\Delta_t$）能够消除对冲组合中的 $dW_t$ 风险？\n\nA. 在 $[t,t+\\Delta t]$ 期间，主阶随机对冲误差大约为\n$$\\frac{1}{2}\\,\\Gamma(S_t,t)\\,\\sigma_t^2\\,S_t^2\\left[(\\Delta W)^2-\\Delta t\\right],$$\n因为已实现的二次变差 $(\\Delta W)^2$ 在其均值 $\\Delta t$ 附近波动。在连续交易下，每时每刻设置 $\\Delta_t=\\partial_S V(S_t,t)$，根据伊藤微积分，这会消除 $dV-\\Delta_t\\,dS_t$ 中的 $dW_t$ 风险，只留下 $dt$ 项。\n\nB. 在 $[t,t+\\Delta t]$ 期间，主阶随机对冲误差大约为\n$$\\Gamma(S_t,t)\\,\\sigma_t\\,S_t^2\\,\\Delta W,$$\n并且连续交易无法移除 $dW_t$ 项，因为 $\\sigma_t0$ 意味着存在不可避免的扩散风险。\n\nC. 在 $[t,t+\\Delta t]$ 期间，主阶对冲误差是确定性的\n$$\\frac{1}{2}\\,\\Gamma(S_t,t)\\,\\sigma_t^2\\,S_t^2\\,\\Delta t,$$\n并且连续交易同时消除了漂移项和扩散项，因此对冲组合的 $dt$ 和 $dW_t$ 分量均为零。\n\nD. 对冲误差与 $\\Gamma$ 无关，仅由时间衰减 $V_t$ 控制，因此在 $[t,t+\\Delta t]$ 期间，误差为\n$$V_t\\,\\Delta t,$$\n并且连续交易通过在风险中性测度下设置 $\\mu_t=r_t$ 来消除 $dW_t$ 项。\n\nE. 在 $[t,t+\\Delta t]$ 期间，主阶随机对冲误差为\n$$\\frac{1}{2}\\,\\Gamma(S_t,t)\\,\\big(\\Delta S\\big)^2\\quad\\text{其中}\\quad \\Delta S=\\mu_t S_t\\,\\Delta t+\\sigma_t S_t\\,\\Delta W,$$\n并且连续交易减少但不能消除 $dW_t$ 项，因为 $\\partial_S V$ 随时间随机变化。", "solution": "用户要求对一个关于量化金融中对冲误差的问题进行详细分析。我将首先验证问题陈述，然后进行完整解答并评估给出的选项。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n-   风险资产 $S_t$ 的价格服从随机微分方程 (SDE)：\n    $$dS_t=\\mu_t S_t\\,dt+\\sigma_t S_t\\,dW_t$$\n-   $W_t$ 是一个标准的维纳过程（布朗运动）。\n-   货币市场账户 $B_t$ 的演变遵循：\n    $$dB_t=r_t B_t\\,dt$$\n-   $V(S,t)$ 是一个二次连续可微的欧式或有债权在时间 $t$ 的价值。\n-   Delta 定义为 $\\Delta = \\partial_S V$。\n-   Gamma 定义为 $\\Gamma = \\partial_{SS} V$。\n-   采用离散对冲策略：交易员持有 $\\Delta_t = \\partial_S V(S_t, t)$ 单位的资产，该数量在时间区间 $[t, t+\\Delta t]$ 内保持不变。\n-   布朗增量为 $\\Delta W = W_{t+\\Delta t} - W_t$，其分布为正态分布：$\\Delta W \\sim \\mathcal{N}(0, \\Delta t)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n-   **科学依据：** 该问题设置在标准的 Black-Scholes-Merton 期权定价和对冲框架内。资产和无风险债券的随机微分方程、Delta 和 Gamma 的定义，以及离散对冲误差的概念都是现代量化金融的标准和基础内容。该问题基于伊藤微积分在金融衍生品中的应用。在此领域内，所有前提都具有科学合理性。\n-   **定义良好：** 问题要求两件具体的事情：主阶随机对冲误差的特征描述，以及连续对冲中风险消除的原因。这些都是定义明确的问题，可以根据所提供的模型得出唯一答案。\n-   **客观性：** 问题以精确的数学和金融术语陈述。没有歧义或主观语言。\n\n该问题没有科学或事实上的不健全之处，是可形式化、完整且结构良好的。\n\n**步骤 3：结论与行动**\n\n问题陈述是**有效**的。我将继续推导解决方案。\n\n### 解答推导\n\n这个问题要求分析由于在离散时间间隔（而非连续）对 delta 对冲进行再平衡而产生的对冲误差。让我们构建一个投资组合来分析这个误差。\n\n考虑一个在时间 $t$ 建立的投资组合，该组合做空一个单位的或有债权 $V$，并做多 $\\Delta_t = \\partial_S V(S_t,t)$ 单位的标的资产 $S$。组合的剩余价值存放在货币市场账户 $B_t$ 中。为了使投资组合在时间 $t$ 的净值为零，货币市场中的金额必须是 $V(S_t,t) - \\Delta_t S_t$。\n该对冲组合在时间 $t$ 的价值是：\n$$ \\Pi_t = -V(S_t,t) + \\Delta_t S_t + \\left(V(S_t,t) - \\Delta_t S_t\\right) = 0 $$\n头寸 $\\Delta_t$ 在时间 $t+\\Delta t$ 之前保持不变。在区间 $[t, t+\\Delta t]$ 内，投资组合价值的变化（表示为 $\\Delta \\Pi$）代表了这种离散对冲策略的利润或亏损。\n$$ \\Delta \\Pi = \\Pi_{t+\\Delta t} - \\Pi_t = \\Pi_{t+\\Delta t} $$\n在时间 $t+\\Delta t$ 的价值是：\n$$ \\Pi_{t+\\Delta t} = -V(S_{t+\\Delta t}, t+\\Delta t) + \\Delta_t S_{t+\\Delta t} + (V(S_t,t) - \\Delta_t S_t) \\frac{B_{t+\\Delta t}}{B_t} $$\n对于一个小的 时间步长 $\\Delta t$，我们可以将货币市场账户的增长近似为 $\\frac{B_{t+\\Delta t}}{B_t} \\approx 1 + r_t \\Delta t$。\n$$ \\Pi_{t+\\Delta t} \\approx -V_{t+\\Delta t} + \\Delta_t S_{t+\\Delta t} + (V_t - \\Delta_t S_t)(1 + r_t \\Delta t) $$\n令 $\\Delta V = V_{t+\\Delta t} - V_t$ 且 $\\Delta S = S_{t+\\Delta t} - S_t$。\n$$ \\Delta \\Pi \\approx -(V_t + \\Delta V) + \\Delta_t (S_t + \\Delta S) + V_t - \\Delta_t S_t + r_t(V_t - \\Delta_t S_t)\\Delta t $$\n$$ \\Delta \\Pi \\approx -\\Delta V + \\Delta_t \\Delta S + r_t(V_t - \\Delta_t S_t)\\Delta t $$\n现在，我们使用伊藤引理对 $\\Delta V$ 进行泰勒展开。对于函数 $V(S,t)$，在一个小区间上的变化 $\\Delta V$ 大约为：\n$$ \\Delta V \\approx \\frac{\\partial V}{\\partial t} \\Delta t + \\frac{\\partial V}{\\partial S} \\Delta S + \\frac{1}{2} \\frac{\\partial^2 V}{\\partial S^2} (\\Delta S)^2 $$\n代入定义 $\\Delta_t = \\partial_S V$ 和 $\\Gamma_t = \\partial_{SS}V$：\n$$ \\Delta \\Pi \\approx -\\left( \\frac{\\partial V}{\\partial t}\\Delta t + \\Delta_t \\Delta S + \\frac{1}{2}\\Gamma_t (\\Delta S)^2 \\right) + \\Delta_t \\Delta S + r_t(V_t - \\Delta_t S_t)\\Delta t $$\n$\\Delta_t \\Delta S$ 项相互抵消：\n$$ \\Delta \\Pi \\approx -\\frac{\\partial V}{\\partial t}\\Delta t - \\frac{1}{2}\\Gamma_t (\\Delta S)^2 + r_t V_t \\Delta t - r_t \\Delta_t S_t \\Delta t $$\n这个表达式代表了对冲组合的盈亏（PL）。根据无套利原理，期权价格 $V$ 必须满足 Black-Scholes 偏微分方程（PDE）：\n$$ \\frac{\\partial V}{\\partial t} + \\frac{1}{2}\\sigma_t^2 S_t^2 \\frac{\\partial^2 V}{\\partial S^2} + r_t S_t \\frac{\\partial V}{\\partial S} - r_t V = 0 $$\n使用 $\\Delta_t$ 和 $\\Gamma_t$ 并重新整理：\n$$ -\\frac{\\partial V}{\\partial t} + r_t V_t - r_t \\Delta_t S_t = \\frac{1}{2}\\sigma_t^2 S_t^2 \\Gamma_t $$\n将此代入 $\\Delta \\Pi$ 的表达式中：\n$$ \\Delta \\Pi \\approx \\left(\\frac{1}{2}\\sigma_t^2 S_t^2 \\Gamma_t\\right)\\Delta t - \\frac{1}{2}\\Gamma_t (\\Delta S)^2 = \\frac{1}{2}\\Gamma_t \\left( \\sigma_t^2 S_t^2 \\Delta t - (\\Delta S)^2 \\right) $$\n这是该策略的利润/亏损。“对冲误差”通常被定义为对冲的成本或缺口，即盈亏的负值：\n$$ \\text{对冲误差} = -\\Delta \\Pi \\approx \\frac{1}{2}\\Gamma_t \\left( (\\Delta S)^2 - \\sigma_t^2 S_t^2 \\Delta t \\right) $$\n为了找到主阶随机贡献，我们考察 $(\\Delta S)^2$。从 $S_t$ 的随机微分方程，我们有 $\\Delta S \\approx \\mu_t S_t \\Delta t + \\sigma_t S_t \\Delta W$。增量的平方由随机项主导：\n$$ (\\Delta S)^2 = (\\mu_t S_t \\Delta t + \\sigma_t S_t \\Delta W)^2 = \\sigma_t^2 S_t^2 (\\Delta W)^2 + 2\\mu_t\\sigma_t S_t^2 \\Delta t \\Delta W + \\mu_t^2 S_t^2 (\\Delta t)^2 $$\n包含 $(\\Delta W)^2$ 的项是 $O(\\Delta t)$ 阶，交叉项是 $O((\\Delta t)^{3/2})$ 阶，最后一项是 $O((\\Delta t)^2)$ 阶。主阶项是 $\\sigma_t^2 S_t^2 (\\Delta W)^2$。\n将此代入误差表达式中：\n$$ \\text{对冲误差} \\approx \\frac{1}{2}\\Gamma_t \\left( \\sigma_t^2 S_t^2 (\\Delta W)^2 - \\sigma_t^2 S_t^2 \\Delta t \\right) $$\n$$ \\text{对冲误差} \\approx \\frac{1}{2}\\Gamma_t \\sigma_t^2 S_t^2 \\left( (\\Delta W)^2 - \\Delta t \\right) $$\n这个表达式代表了主阶对冲误差。$(\\Delta W)^2$ 项是 $[t, t+\\Delta t]$ 上的已实现二次变差，而 $\\Delta t$ 是其期望，$E[(\\Delta W)^2]=\\Delta t$。表达式 $(\\Delta W)^2-\\Delta t$ 是一个均值为零的随机变量，代表已实现波动率围绕其期望值的纯随机波动。\n\n现在，来看问题的第二部分：连续交易。在连续时间极限下（$\\Delta t \\to dt$），一个完美复制的自融资组合 $\\Pi_t$ 的价值变化为 $d\\Pi_t = \\Delta_t dS_t + r_t(V_t - \\Delta_t S_t)dt$。期权价值 $V_t$ 根据伊藤引理变化：$dV_t = (\\partial_t V + \\mu_t S_t \\partial_S V + \\frac{1}{2}\\sigma_t^2 S_t^2 \\partial_{SS}V)dt + \\sigma_t S_t \\partial_S V dW_t$。为了消除随机风险，我们必须匹配 $dW_t$ 项。$d\\Pi_t$ 中的 $dW_t$ 项来自于 $\\Delta_t dS_t = \\Delta_t(\\mu_t S_t dt + \\sigma_t S_t dW_t)$。通过在每时每刻选择持仓 $\\Delta_t = \\partial_S V$，对冲的随机项 $\\Delta_t \\sigma_t S_t dW_t$ 变得与期权价值变化的随机项 $\\sigma_t S_t (\\partial_S V) dW_t$ 完全相同。因此，它们变化的差值 $d V_t - d\\Pi_t$ 将不包含 $dW_t$ 分量，这意味着该投资组合在无穷小区间 $dt$ 上是无风险的。\n\n### 逐项分析\n\n**A. 在 $[t,t+\\Delta t]$ 期间，主阶随机对冲误差大约为 $\\frac{1}{2}\\,\\Gamma(S_t,t)\\,\\sigma_t^2\\,S_t^2\\left[(\\Delta W)^2-\\Delta t\\right]$，因为已实现的二次变差 $(\\Delta W)^2$ 在其均值 $\\Delta t$ 附近波动。在连续交易下，每时每刻设置 $\\Delta_t=\\partial_S V(S_t,t)$，根据伊藤微积分，这会消除 $dV-\\Delta_t\\,dS_t$ 中的 $dW_t$ 风险，只留下 $dt$ 项。**\n\n-   **对冲误差：** 公式 $\\frac{1}{2}\\Gamma \\sigma_t^2 S_t^2 \\left( (\\Delta W)^2 - \\Delta t \\right)$ 与我们推导出的对冲误差（对冲成本）表达式完全匹配。关于其产生于已实现二次变差与期望二次变差之间波动的解释也是正确的。\n-   **连续交易：** 这个解释在概念上是正确的。通过设定 $\\Delta_t=\\partial_S V$，$\\Delta_t dS_t$ 的随机分量完全抵消了 $dV_t$ 的随机分量。表达式 $dV_t - (\\partial_S V)dS_t$ 简化为 $(\\partial_t V + \\frac{1}{2}\\Gamma_t \\sigma_t^2 S_t^2)dt$，它只包含一个 $dt$ 项，从而消除了 $dW_t$ 风险。\n-   **结论：** **正确**。\n\n**B. 在 $[t,t+\\Delta t]$ 期间，主阶随机对冲误差大约为 $\\Gamma(S_t,t)\\,\\sigma_t\\,S_t^2\\,\\Delta W$，并且连续交易无法移除 $dW_t$ 项，因为 $\\sigma_t0$ 意味着存在不可避免的扩散风险。**\n\n-   **对冲误差：** $\\Gamma\\sigma S^2 \\Delta W$ 项是 $O((\\Delta t)^{1/2})$ 阶，不是主阶误差项。我们的推导表明，主阶随机效应是 $O(\\Delta t)$ 阶。这个公式是不正确的。\n-   **连续交易：** 连续交易无法移除扩散风险的说法是根本错误的。它与复制和 delta 对冲的核心原则相矛盾。\n-   **结论：** **不正确**。\n\n**C. 在 $[t,t+\\Delta t]$ 期间，主阶对冲误差是确定性的 $\\frac{1}{2}\\,\\Gamma(S_t,t)\\,\\sigma_t^2\\,S_t^2\\,\\Delta t$，并且连续交易同时消除了漂移项和扩散项，因此对冲组合的 $dt$ 和 $dW_t$ 分量均为零。**\n\n-   **对冲误差：** 在离散区间上的对冲误差本质上是随机的，因为 $(\\Delta S)^2$ 是一个随机变量。声称它是确定性的说法是错误的。所提供的表达式与 gamma 的期望成本有关，而不是误差本身。\n-   **连续交易：** Delta 对冲消除了扩散（$dW_t$）项的不匹配。漂移（$dt$）项的不匹配只有在 Black-Scholes 偏微分方程成立时才被消除，这是无套利的一个条件，而不是对冲行为本身的直接结果。\n-   **结论：** **不正确**。\n\n**D. 对冲误差与 $\\Gamma$ 无关，仅由时间衰减 $V_t$ 控制，因此在 $[t,t+\\Delta t]$ 期间，误差为 $V_t\\,\\Delta t$，并且连续交易通过在风险中性测度下设置 $\\mu_t=r_t$ 来消除 $dW_t$ 项。**\n\n-   **对冲误差：** 由于离散再平衡产生的对冲误差，根本上是期权凸性（由 $\\Gamma$ 衡量）的结果。$\\Gamma=0$ 的期权（例如，远期合约）没有这种误差。所提出的公式是不正确的。\n-   **连续交易：** 风险的消除是通过交易策略（$\\Delta_t = \\partial_S V$）实现的，而不是通过切换到风险中性测度。风险中性测度是一种定价工具，它改变了标的资产的漂移，但不会机械地从投资组合中移除风险。\n-   **结论：** **不正确**。\n\n**E. 在 $[t,t+\\Delta t]$ 期间，主阶随机对冲误差为 $\\frac{1}{2}\\,\\Gamma(S_t,t)\\,\\big(\\Delta S\\big)^2\\quad\\text{其中}\\quad \\Delta S=\\mu_t S_t\\,\\Delta t+\\sigma_t S_t\\,\\Delta W$，并且连续交易减少但不能消除 $dW_t$ 项，因为 $\\partial_S V$ 随时间随机变化。**\n\n-   **对冲误差：** 表达式 $\\frac{1}{2}\\Gamma(\\Delta S)^2$ 只是完整误差表达式的一个组成部分。它忽略了来自偏微分方程的确定性项 $\\frac{1}{2}\\Gamma\\sigma_t^2 S_t^2 \\Delta t$。更重要的是，它没有像选项A的中心化项那样有效地分离出纯随机分量。\n-   **连续交易：** 连续交易不能消除 $dW_t$ 项的说法是错误的。连续 delta 对冲的目的和结果正是完全消除一阶随机风险。\n-   **结论：** **不正确**。", "answer": "$$\\boxed{A}$$", "id": "3038454"}, {"introduction": "超越具体的对冲策略，金融理论提供了一个更为普适和优雅的定价框架，其核心是“状态价格平减因子”（State-Price Deflator），也称为随机折现因子。这个强大的工具 $M_t$ 就像一个万能的“定价核”，任何被正确定价的资产，其价格过程乘以 $M_t$ 后，都会变成一个鞅。这个练习将指导你推导这个随机折现因子的具体形式，并揭示它与等价鞅测度（风险中性测度）之间的深刻联系，即 $M_t = B_t^{-1}Z_t$。完成这个练习，你将对无套利定价背后的统一数学结构有更深入的认识 [@problem_id:3038477]。", "problem": "考虑一个在带域流的概率空间上的布莱克-斯科尔斯市场，该空间在物理测度 $\\mathbb{P}$ 下支持一个标准布朗运动。该市场包含一个货币市场账户 $B_t$ 和一个单一风险资产 $S_t$，其动态过程如下\n$$\n\\mathrm{d}B_t = r\\,B_t\\,\\mathrm{d}t,\\qquad B_0 = 1,\n$$\n和\n$$\n\\mathrm{d}S_t = \\mu\\,S_t\\,\\mathrm{d}t + \\sigma\\,S_t\\,\\mathrm{d}W_t,\\qquad S_00,\n$$\n其中 $r$、$\\mu$ 和 $\\sigma$ 为常数，满足 $r\\in\\mathbb{R}$ 和 $\\sigma0$。状态价格平减指数（也称为随机折现因子）是一个严格为正的适应过程 $M_t$，满足 $M_0=1$，使得对于每一个自融资财富过程 $V_t$，乘积 $M_t V_t$ 是一个 $\\mathbb{P}$-鞅。\n\n从自融资投资组合、伊藤微积分和资产定价基本定理（在无套利条件下存在等价鞅测度）的定义出发，执行以下操作：\n\n- 构建一个过程 $M_t$，使得 $B_t M_t$ 和 $S_t M_t$ 都是 $\\mathbb{P}$-鞅，并推导其必须满足的随机微分方程。\n\n- 用 $t$、$W_t$、$r$、$\\mu$ 和 $\\sigma$ 显式求解此随机微分方程。\n\n- 令 $\\mathbb{Q}$ 表示一个等价鞅测度，其密度过程为 $Z_t=\\frac{\\mathrm{d}\\mathbb{Q}}{\\mathrm{d}\\mathbb{P}}\\big|_{\\mathcal{F}_t}$。证明在 $\\mathbb{Q}$ 下，折现股票价格 $B_t^{-1}S_t$ 是一个鞅，并由此推断出 $M_t=B_t^{-1}Z_t$，然后给出 $M_t$ 的显式闭式表达式。\n\n你的最终答案应该是 $M_t$ 关于 $t$、$W_t$、$r$、$\\mu$ 和 $\\sigma$ 的单一闭式解析表达式。不要对答案进行四舍五入。", "solution": "该问题设置在标准的布莱克-斯科尔斯框架中，要求推导并给出状态价格平减指数（也称为随机折现因子）的显式形式。该问题具有科学依据、是适定的，并包含获得唯一解所需的所有信息。因此，它被认为是有效的。\n\n状态价格平减指数 $M_t$ 是一个严格为正的适应过程，满足 $M_0=1$，使得对于任何自融资财富过程 $V_t$，乘积 $M_t V_t$ 是一个 $\\mathbb{P}$-鞅。在这个市场中，货币市场账户 $B_t$ 和风险资产 $S_t$ 本身就是自融资投资组合。因此，$M_t B_t$ 和 $M_t S_t$ 必须是 $\\mathbb{P}$-鞅。一个过程是鞅当且仅当其漂移项为零。\n\n让我们用以下形式的一般随机微分方程（SDE）来为状态价格平减指数 $M_t$ 的动态过程建模：\n$$\n\\mathrm{d}M_t = a_t M_t \\mathrm{d}t + b_t M_t \\mathrm{d}W_t\n$$\n其中 $a_t$ 和 $b_t$ 是待定的适应过程。由于市场系数是常数，我们将寻求 $a_t$ 和 $b_t$ 的常数解。我们将其表示为 $a$ 和 $b$。因此，$\\mathrm{d}M_t = a M_t \\mathrm{d}t + b M_t \\mathrm{d}W_t$。\n\n首先，我们分析 $M_t B_t$ 是 $\\mathbb{P}$-鞅的条件。货币市场账户遵循 $\\mathrm{d}B_t = r B_t \\mathrm{d}t$。我们对 $M_t B_t$ 应用伊藤乘积法则：\n$$\n\\mathrm{d}(M_t B_t) = M_t \\mathrm{d}B_t + B_t \\mathrm{d}M_t + \\mathrm{d}\\langle M, B \\rangle_t\n$$\n二次协变项 $\\mathrm{d}\\langle M, B \\rangle_t$ 为零，因为过程 $B_t$ 没有扩散部分（即其 $\\mathrm{d}W_t$ 项为零）。我们代入 $M_t$ 和 $B_t$ 的随机微分方程：\n$$\n\\mathrm{d}(M_t B_t) = M_t (r B_t \\mathrm{d}t) + B_t (a M_t \\mathrm{d}t + b M_t \\mathrm{d}W_t) = M_t B_t (r+a) \\mathrm{d}t + M_t B_t b \\mathrm{d}W_t\n$$\n为了使 $M_t B_t$ 成为鞅，其漂移项必须为零。这意味着：\n$$\nr + a = 0 \\implies a = -r\n$$\n\n接下来，我们分析 $M_t S_t$ 是 $\\mathbb{P}$-鞅的条件。风险资产遵循 $\\mathrm{d}S_t = \\mu S_t \\mathrm{d}t + \\sigma S_t \\mathrm{d}W_t$。我们对 $M_t S_t$ 应用伊藤乘积法则：\n$$\n\\mathrm{d}(M_t S_t) = M_t \\mathrm{d}S_t + S_t \\mathrm{d}M_t + \\mathrm{d}\\langle M, S \\rangle_t\n$$\n二次协变项不为零：\n$$\n\\mathrm{d}\\langle M, S \\rangle_t = (b M_t) (\\sigma S_t) \\mathrm{d}t = b \\sigma M_t S_t \\mathrm{d}t\n$$\n代入 $M_t$、$S_t$ 的随机微分方程和二次协变项：\n$$\n\\mathrm{d}(M_t S_t) = M_t (\\mu S_t \\mathrm{d}t + \\sigma S_t \\mathrm{d}W_t) + S_t (a M_t \\mathrm{d}t + b M_t \\mathrm{d}W_t) + b \\sigma M_t S_t \\mathrm{d}t\n$$\n对 $\\mathrm{d}t$ 和 $\\mathrm{d}W_t$ 项进行分组：\n$$\n\\mathrm{d}(M_t S_t) = M_t S_t (\\mu + a + b\\sigma) \\mathrm{d}t + M_t S_t (\\sigma + b) \\mathrm{d}W_t\n$$\n为了使 $M_t S_t$ 成为鞅，其漂移项必须为零：\n$$\n\\mu + a + b\\sigma = 0\n$$\n从我们的第一个条件代入 $a = -r$：\n$$\n\\mu - r + b\\sigma = 0 \\implies b = -\\frac{\\mu - r}{\\sigma}\n$$\n项 $\\theta = \\frac{\\mu - r}{\\sigma}$ 被称为风险的市场价格。所以，$b = -\\theta$。\n\n因此，状态价格平减指数 $M_t$ 的随机微分方程为：\n$$\n\\mathrm{d}M_t = -r M_t \\mathrm{d}t - \\frac{\\mu - r}{\\sigma} M_t \\mathrm{d}W_t\n$$\n这是一个几何布朗运动。具有初始条件 $X_0$ 的随机微分方程 $\\mathrm{d}X_t = \\alpha X_t \\mathrm{d}t + \\beta X_t \\mathrm{d}W_t$ 的通解是 $X_t = X_0 \\exp\\left( (\\alpha - \\frac{1}{2}\\beta^2)t + \\beta W_t \\right)$。\n在我们的情况下，$\\alpha = -r$，$\\beta = -\\frac{\\mu-r}{\\sigma}$，且 $M_0=1$。因此，$M_t$ 的显式解是：\n$$\nM_t = 1 \\cdot \\exp\\left( \\left(-r - \\frac{1}{2}\\left(-\\frac{\\mu-r}{\\sigma}\\right)^2\\right)t - \\frac{\\mu-r}{\\sigma} W_t \\right)\n$$\n$$\nM_t = \\exp\\left( -r t - \\frac{1}{2} \\left(\\frac{\\mu-r}{\\sigma}\\right)^2 t - \\frac{\\mu-r}{\\sigma} W_t \\right)\n$$\n这解答了问题的前两部分。\n\n对于最后一部分，令 $\\mathbb{Q}$ 为一个等价鞅测度（EMM）。根据资产定价第一基本定理，这样的测度存在当且仅当市场无套利。在 $\\mathbb{Q}$ 下，所有折现资产价格都是鞅。折现股票价格为 $\\tilde{S}_t = B_t^{-1} S_t$。其在 $\\mathbb{P}$ 下的动态过程可通过对 $B_t^{-1} = \\exp(-rt)$ 应用伊藤法则找到：\n$$\n\\mathrm{d}\\tilde{S}_t = \\mathrm{d}(B_t^{-1}S_t) = B_t^{-1}\\mathrm{d}S_t + S_t\\mathrm{d}B_t^{-1} = B_t^{-1}(\\mu S_t \\mathrm{d}t + \\sigma S_t \\mathrm{d}W_t) + S_t(-r B_t^{-1}\\mathrm{d}t)\n$$\n$$\n\\mathrm{d}\\tilde{S}_t = \\tilde{S}_t(\\mu-r)\\mathrm{d}t + \\tilde{S}_t\\sigma\\mathrm{d}W_t\n$$\n根据吉尔萨诺夫定理，我们定义一个新过程 $W_t^{\\mathbb{Q}} = W_t + \\theta t$，它在 $\\mathbb{Q}$ 下是布朗运动，其中 $\\theta$ 是风险的市场价格。拉东-尼科迪姆密度过程为 $Z_t = \\frac{\\mathrm{d}\\mathbb{Q}}{\\mathrm{d}\\mathbb{P}}|_{\\mathcal{F}_t} = \\exp(-\\theta W_t - \\frac{1}{2}\\theta^2 t)$。\n为了求出 $\\theta$，我们在 $\\tilde{S}_t$ 的随机微分方程中通过代入 $\\mathrm{d}W_t = \\mathrm{d}W_t^{\\mathbb{Q}} - \\theta \\mathrm{d}t$ 来进行测度变换：\n$$\n\\mathrm{d}\\tilde{S}_t = \\tilde{S}_t(\\mu-r)\\mathrm{d}t + \\tilde{S}_t\\sigma(\\mathrm{d}W_t^{\\mathbb{Q}} - \\theta \\mathrm{d}t) = \\tilde{S}_t(\\mu - r - \\sigma\\theta)\\mathrm{d}t + \\tilde{S}_t\\sigma\\mathrm{d}W_t^{\\mathbb{Q}}\n$$\n为了使 $\\tilde{S}_t$ 成为一个 $\\mathbb{Q}$-鞅，其漂移项必须为零：$\\mu - r - \\sigma\\theta = 0$，这意味着 $\\theta = \\frac{\\mu-r}{\\sigma}$。这证实了我们之前的认定。\n\n状态价格平减指数 $M_t$ 和密度过程 $Z_t$ 之间的关系由 $M_t = B_t^{-1} Z_t$ 给出。这可以如下证明：对于任何交易资产价格过程 $P_t$，折现价格 $B_t^{-1}P_t$ 是一个 $\\mathbb{Q}$-鞅。根据抽象贝叶斯法则，这意味着 $Z_t (B_t^{-1} P_t)$ 是一个 $\\mathbb{P}$-鞅。重新排列得到 $(Z_t B_t^{-1}) P_t$ 是一个 $\\mathbb{P}$-鞅。将此与状态价格平减指数的定义（即 $M_t P_t$ 是一个 $\\mathbb{P}$-鞅）进行比较，我们推断出 $M_t = Z_t B_t^{-1}$。\n\n现在我们可以利用这个关系写出 $M_t$ 的显式形式。我们有 $B_t^{-1} = \\exp(-rt)$ 和 $Z_t = \\exp(-\\theta W_t - \\frac{1}{2}\\theta^2 t)$，其中 $\\theta = \\frac{\\mu-r}{\\sigma}$。\n$$\nM_t = B_t^{-1} Z_t = \\exp(-rt) \\exp\\left(-\\frac{\\mu-r}{\\sigma} W_t - \\frac{1}{2}\\left(\\frac{\\mu-r}{\\sigma}\\right)^2 t\\right)\n$$\n合并指数部分得到最终表达式：\n$$\nM_t = \\exp\\left(-r t - \\frac{1}{2}\\left(\\frac{\\mu-r}{\\sigma}\\right)^2 t - \\frac{\\mu-r}{\\sigma} W_t\\right)\n$$\n这个表达式与直接求解 $M_t$ 的随机微分方程所得到的表达式相同，证实了该框架的一致性。", "answer": "$$\n\\boxed{\\exp\\left(-r t - \\frac{1}{2}\\left(\\frac{\\mu - r}{\\sigma}\\right)^{2} t - \\frac{\\mu - r}{\\sigma}W_t\\right)}\n$$", "id": "3038477"}]}