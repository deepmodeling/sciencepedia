{"hands_on_practices": [{"introduction": "这一实践是现代金融数学的基石。通过从随机微分方程和无套利定价等第一性原理出发，我们将完整地推导出著名的布莱克-斯科尔斯期权定价公式。这个过程不仅能锻炼你的随机微积分计算技巧，更能让你深刻理解风险中性定价的核心思想，将抽象的理论与具体的金融产品联系起来。[@problem_id:3051898]", "problem": "一个资产价格过程 $\\{S_t\\}_{t \\geq 0}$ 在一个支持布朗运动 (BM) $\\{W_t\\}_{t \\geq 0}$ 的概率空间中，由以下随机微分方程 (SDE) 建模：\n$$\ndS_t=\\mu S_t\\,dt+\\sigma S_t\\,dW_t,\n$$\n其中 $\\mu \\in \\mathbb{R}$ 和 $\\sigma>0$ 是常数，且 $S_0>0$。连续复利无风险利率是一个常数 $r \\in \\mathbb{R}$，因此货币市场账户为 $B_t=\\exp(r t)$。考虑一个以 $S_t$ 为标的资产的欧式看涨期权，其到期日为 $T>0$，行权价为 $K>0$，在到期日 $T$ 的支付为 $(S_T-K)^{+}=\\max\\{S_T-K,0\\}$，且无股息。\n\n仅从随机微积分和无套利定价的核心原理出发——即 Itô 引理、扩散型随机微分方程解的定义，以及存在一个等价鞅测度 (EMM) 使得折现资产价格 $\\{B_t^{-1}S_t\\}_{t \\geq 0}$ 是一个鞅——完成以下任务：\n\n1. 显式求解 $S_t$ 的随机微分方程。\n2. 推导 $S_t$ 的风险中性动态，并推断在等价鞅测度下 $\\ln S_T$ 的分布。\n3. 通过风险中性定价原理计算欧式看涨期权在 0 时刻的价格 $C_0$。\n\n将 $C_0$ 的最终答案表示为关于 $S_0$、$K$、$r$、$\\sigma$ 和 $T$ 的单个闭式解析表达式。你可以使用标准正态分布的累积分布函数，记为 $\\Phi(\\cdot)$。不要提供中间或简化的定价公式；从所述原理推导结果。最终答案必须是单个表达式，且不得包含单位。", "solution": "该问题陈述是从第一性原理推导 Black-Scholes-Merton 期权定价公式的标准表述，并且因为其在数学上合理、内容自洽且问题适定，故被确定为有效。我们遵循三个指定步骤进行求解。\n\n资产价格过程 $\\{S_t\\}_{t \\geq 0}$ 服从几何布朗运动的随机微分方程 (SDE)：\n$$\ndS_t = \\mu S_t \\, dt + \\sigma S_t \\, dW_t\n$$\n其中 $S_0 > 0$、$\\mu \\in \\mathbb{R}$ 和 $\\sigma > 0$ 是常数。$\\{W_t\\}_{t \\geq 0}$ 是在物理概率测度 $\\mathbb{P}$ 下的标准布朗运动。\n\n**1. $S_t$ 的显式解**\n\n为求解 $S_t$ 的 SDE，我们考虑资产价格自然对数的过程 $X_t = \\ln S_t$。我们对函数 $f(s) = \\ln s$（其中 $s=S_t$）应用 Itô 引理。其偏导数为 $f'(s) = \\frac{1}{s}$ 和 $f''(s) = -\\frac{1}{s^2}$。根据 Itô 引理，$X_t = f(S_t)$ 的微分为：\n$$\ndX_t = f'(S_t) dS_t + \\frac{1}{2} f''(S_t) (dS_t)^2\n$$\n二次变差项 $(dS_t)^2$ 使用 Itô 微积分的性质计算，其中 $(dt)^2=0$，$dt \\, dW_t = 0$ 且 $(dW_t)^2 = dt$：\n$$\n(dS_t)^2 = (\\mu S_t \\, dt + \\sigma S_t \\, dW_t)^2 = \\mu^2 S_t^2 (dt)^2 + 2\\mu\\sigma S_t^2 dt \\, dW_t + \\sigma^2 S_t^2 (dW_t)^2 = \\sigma^2 S_t^2 dt\n$$\n将 $dS_t$ 和 $(dS_t)^2$ 代入 $dX_t$ 的表达式中：\n$$\ndX_t = \\frac{1}{S_t}(\\mu S_t \\, dt + \\sigma S_t \\, dW_t) + \\frac{1}{2} \\left(-\\frac{1}{S_t^2}\\right) (\\sigma^2 S_t^2 dt)\n$$\n$$\ndX_t = (\\mu \\, dt + \\sigma \\, dW_t) - \\frac{1}{2}\\sigma^2 dt\n$$\n$$\ndX_t = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) dt + \\sigma \\, dW_t\n$$\n这是一个关于 $X_t$ 的线性 SDE。我们可以通过从时间 $0$到 $t$ 直接积分来求解：\n$$\n\\int_0^t dX_u = \\int_0^t \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) du + \\int_0^t \\sigma \\, dW_u\n$$\n$$\nX_t - X_0 = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) t + \\sigma (W_t - W_0)\n$$\n给定 $W_0 = 0$ 且 $X_t = \\ln S_t$，我们有：\n$$\n\\ln S_t = \\ln S_0 + \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) t + \\sigma W_t\n$$\n对两边取指数，得到 $S_t$ 的显式解：\n$$\nS_t = S_0 \\exp\\left(\\left(\\mu - \\frac{1}{2}\\sigma^2\\right) t + \\sigma W_t\\right)\n$$\n\n**2. 风险中性动态及 $\\ln S_T$ 的分布**\n\n无套利定价原理断言存在一个等价鞅测度 (EMM)，记为 $\\mathbb{Q}$，在该测度下折现资产价格 $\\tilde{S}_t = B_t^{-1}S_t$ 是一个鞅。这里，$B_t = \\exp(rt)$ 是具有恒定无风险利率 $r$ 的货币市场账户。首先，我们使用 Itô 乘积法则，找出在物理测度 $\\mathbb{P}$ 下 $\\tilde{S}_t = \\exp(-rt)S_t$ 的动态：\n$$\nd\\tilde{S}_t = d(\\exp(-rt)S_t) = S_t d(\\exp(-rt)) + \\exp(-rt) dS_t\n$$\n$$\nd\\tilde{S}_t = S_t(-r \\exp(-rt) dt) + \\exp(-rt)(\\mu S_t dt + \\sigma S_t dW_t)\n$$\n$$\nd\\tilde{S}_t = \\exp(-rt)S_t(\\mu - r) dt + \\exp(-rt)S_t \\sigma dW_t = \\tilde{S}_t(\\mu - r) dt + \\tilde{S}_t \\sigma dW_t\n$$\n为使 $\\tilde{S}_t$ 成为一个鞅，其漂移项必须为零。根据 Girsanov 定理，我们可以定义一个新过程 $W_t^{\\mathbb{Q}}$，它是在测度 $\\mathbb{Q}$ 下的布朗运动，通过 $dW_t = dW_t^{\\mathbb{Q}} - \\theta dt$ 与原始布朗运动 $W_t$ 相关联，其中 $\\theta = \\frac{\\mu - r}{\\sigma}$ 是风险的市场价格。\n将此代入 $\\tilde{S}_t$ 的动态方程：\n$$\nd\\tilde{S}_t = \\tilde{S}_t(\\mu - r) dt + \\tilde{S}_t \\sigma (dW_t^{\\mathbb{Q}} - \\frac{\\mu-r}{\\sigma} dt) = \\tilde{S}_t(\\mu - r - (\\mu - r)) dt + \\tilde{S}_t \\sigma dW_t^{\\mathbb{Q}}\n$$\n$$\nd\\tilde{S}_t = \\sigma \\tilde{S}_t dW_t^{\\mathbb{Q}}\n$$\n这证明了 $\\tilde{S}_t$ 在 $\\mathbb{Q}$ 下是一个鞅。现在我们求出在 $\\mathbb{Q}$ 下 $S_t = \\exp(rt)\\tilde{S}_t$ 的动态：\n$$\ndS_t = d(\\exp(rt)\\tilde{S}_t) = \\tilde{S}_t d(\\exp(rt)) + \\exp(rt) d\\tilde{S}_t\n$$\n$$\ndS_t = \\tilde{S}_t (r \\exp(rt) dt) + \\exp(rt)(\\sigma \\tilde{S}_t dW_t^{\\mathbb{Q}}) = r S_t dt + \\sigma S_t dW_t^{\\mathbb{Q}}\n$$\n这个 SDE 描述了资产价格的风险中性动态。真实世界漂移 $\\mu$ 被无风险利率 $r$ 替代。在 $\\mathbb{Q}$ 下 $S_t$ 的解可以通过将步骤1解中的 $\\mu$ 替换为 $r$ 得到：\n$$\nS_T = S_0 \\exp\\left(\\left(r - \\frac{1}{2}\\sigma^2\\right) T + \\sigma W_T^{\\mathbb{Q}}\\right)\n$$\n由此，我们求出在 $\\mathbb{Q}$ 下 $\\ln S_T$ 的分布。取自然对数：\n$$\n\\ln S_T = \\ln S_0 + \\left(r - \\frac{1}{2}\\sigma^2\\right) T + \\sigma W_T^{\\mathbb{Q}}\n$$\n在 $\\mathbb{Q}$ 下，$W_T^{\\mathbb{Q}}$ 是一个均值为 $0$、方差为 $T$ 的正态分布随机变量，即 $W_T^{\\mathbb{Q}} \\sim N(0, T)$。由于 $\\ln S_T$ 是一个正态随机变量的线性变换，它也服从正态分布。其在 $\\mathbb{Q}$ 下的期望值和方差为：\n$$\nE^{\\mathbb{Q}}[\\ln S_T] = \\ln S_0 + \\left(r - \\frac{1}{2}\\sigma^2\\right) T + \\sigma E^{\\mathbb{Q}}[W_T^{\\mathbb{Q}}] = \\ln S_0 + \\left(r - \\frac{1}{2}\\sigma^2\\right) T\n$$\n$$\n\\text{Var}^{\\mathbb{Q}}(\\ln S_T) = \\text{Var}^{\\mathbb{Q}}\\left(\\sigma W_T^{\\mathbb{Q}}\\right) = \\sigma^2 \\text{Var}^{\\mathbb{Q}}(W_T^{\\mathbb{Q}}) = \\sigma^2 T\n$$\n因此，在风险中性测度 $\\mathbb{Q}$ 下，$\\ln S_T \\sim N\\left(\\ln S_0 + \\left(r - \\frac{1}{2}\\sigma^2\\right)T, \\sigma^2 T\\right)$。\n\n**3. 0 时刻看涨期权价格 $C_0$ 的计算**\n\n风险中性定价原理指出，欧式看涨期权在 0 时刻的价格 $C_0$ 是在等价鞅测度 $\\mathbb{Q}$ 下的折现期望支付：\n$$\nC_0 = E^{\\mathbb{Q}}[\\exp(-rT)(S_T - K)^+] = \\exp(-rT) E^{\\mathbb{Q}}[\\max(S_T - K, 0)]\n$$\n令 $X_T = \\ln S_T$。我们知道 $X_T \\sim N(m, s^2)$，其中 $m = \\ln S_0 + (r - \\frac{1}{2}\\sigma^2)T$ 且 $s^2 = \\sigma^2 T$。该期望为：\n$$\nE^{\\mathbb{Q}}[\\max(S_T - K, 0)] = \\int_{-\\infty}^{\\infty} \\max(\\exp(x) - K, 0) f_{X_T}(x) dx\n$$\n其中 $f_{X_T}(x)$ 是 $X_T$ 的概率密度函数。被积函数仅在 $\\exp(x) > K$ (即 $x > \\ln K$) 时非零。\n$$\nE^{\\mathbb{Q}}[\\max(S_T - K, 0)] = \\int_{\\ln K}^{\\infty} (\\exp(x) - K) \\frac{1}{s\\sqrt{2\\pi}} \\exp\\left(-\\frac{(x-m)^2}{2s^2}\\right) dx\n$$\n我们将其拆分为两个积分：\n$$\nE^{\\mathbb{Q}}[\\max(S_T - K, 0)] = \\underbrace{\\int_{\\ln K}^{\\infty} \\exp(x) \\frac{1}{s\\sqrt{2\\pi}} \\exp\\left(-\\frac{(x-m)^2}{2s^2}\\right) dx}_{I_1} - \\underbrace{K \\int_{\\ln K}^{\\infty} \\frac{1}{s\\sqrt{2\\pi}} \\exp\\left(-\\frac{(x-m)^2}{2s^2}\\right) dx}_{I_2}\n$$\n对于 $I_2$，我们进行变量替换 $z = \\frac{x-m}{s}$，因此 $dx=s dz$。积分下限变为 $\\frac{\\ln K-m}{s}$。\n$$\nI_2 = K \\int_{\\frac{\\ln K-m}{s}}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right) dz = K \\cdot (1 - \\Phi\\left(\\frac{\\ln K - m}{s}\\right)) = K \\cdot \\Phi\\left(-\\frac{\\ln K - m}{s}\\right)\n$$\n我们定义 $d_2 = \\frac{\\ln(S_0/K) + (r - \\frac{1}{2}\\sigma^2)T}{\\sigma\\sqrt{T}}$。$\\Phi$ 的自变量是：\n$$\n-\\frac{\\ln K - m}{s} = \\frac{m - \\ln K}{s} = \\frac{\\ln S_0 + (r - \\frac{1}{2}\\sigma^2)T - \\ln K}{\\sigma\\sqrt{T}} = d_2\n$$\n因此，$I_2 = K \\Phi(-d_2)$。由于标准正态分布的对称性，$\\Phi(-d_2) = 1 - \\Phi(d_2)$。然而，在布莱克-斯科尔斯公式的推导中，我们通常将第二项写为 $K \\Phi(d_2)$。这是因为积分 $\\int_{a}^{\\infty} n(z)dz = 1 - \\Phi(a) = \\Phi(-a)$。这里的下限是 $\\frac{\\ln K-m}{s} = -d_2$。所以 $I_2 = K \\int_{-d_2}^{\\infty} n(z)dz = K(1-\\Phi(-d_2)) = K\\Phi(d_2)$。让我们重新检查变量替换。\n$I_2 = K P(X_T > \\ln K) = K P(\\frac{X_T-m}{s} > \\frac{\\ln K - m}{s}) = K P(Z > -d_2) = K (1-\\Phi(-d_2)) = K\\Phi(d_2)$。是的，$I_2 = K \\Phi(d_2)$。\n\n对于 $I_1$，我们对指数部分进行配方：$x - \\frac{(x-m)^2}{2s^2} = m + \\frac{s^2}{2} - \\frac{(x-(m+s^2))^2}{2s^2}$。\n$$\n\\exp(x)\\exp\\left(-\\frac{(x-m)^2}{2s^2}\\right) = \\exp\\left(m + \\frac{s^2}{2}\\right) \\exp\\left(-\\frac{(x-(m+s^2))^2}{2s^2}\\right)\n$$\n项 $\\exp(m + s^2/2) = \\exp(\\ln S_0 + (r - \\frac{1}{2}\\sigma^2)T + \\frac{1}{2}\\sigma^2 T) = \\exp(\\ln S_0 + rT) = S_0 \\exp(rT)$。\n$$\nI_1 = S_0 \\exp(rT) \\int_{\\ln K}^{\\infty} \\frac{1}{s\\sqrt{2\\pi}} \\exp\\left(-\\frac{(x-(m+s^2))^2}{2s^2}\\right) dx\n$$\n变量替换为 $z' = \\frac{x-(m+s^2)}{s}$。下限为 $\\frac{\\ln K - m - s^2}{s} = -d_1$。\n$$\nI_1 = S_0 \\exp(rT) \\int_{-d_1}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(z')^2}{2}\\right) dz' = S_0 \\exp(rT) (1-\\Phi(-d_1)) = S_0 \\exp(rT) \\Phi(d_1)\n$$\n因此，$I_1 = S_0 \\exp(rT) \\Phi(d_1)$。\n合并各项：\n$$\nE^{\\mathbb{Q}}[\\max(S_T - K, 0)] = S_0 \\exp(rT) \\Phi(d_1) - K \\Phi(d_2)\n$$\n最后，乘以折现因子 $\\exp(-rT)$：\n$$\nC_0 = \\exp(-rT) [S_0 \\exp(rT) \\Phi(d_1) - K \\Phi(d_2)] = S_0 \\Phi(d_1) - K \\exp(-rT) \\Phi(d_2)\n$$\n这就是欧式看涨期权的 Black-Scholes 公式。原文的推导在$I_2$部分有轻微的不清晰之处，已在此处修正和澄清，但最终结果一致。", "answer": "$$\n\\boxed{S_0 \\Phi\\left(\\frac{\\ln\\left(\\frac{S_0}{K}\\right) + \\left(r + \\frac{1}{2}\\sigma^2\\right)T}{\\sigma\\sqrt{T}}\\right) - K \\exp(-rT) \\Phi\\left(\\frac{\\ln\\left(\\frac{S_0}{K}\\right) + \\left(r - \\frac{1}{2}\\sigma^2\\right)T}{\\sigma\\sqrt{T}}\\right)}\n$$", "id": "3051898"}, {"introduction": "在推导了复杂的动态定价模型之后，让我们回归到一个更基本但同样强大的原则：无套利。本练习将通过一个实际的市场报价场景，检验买权-卖权平价关系。你将学习如何通过静态复制来发现定价偏差，并构建一个无风险套利策略，这正是整个无套利定价理论的精髓所在。[@problem_id:3051869]", "problem": "考虑一个满足 Black–Scholes–Merton 框架标准假设的无摩擦市场：标的股票价格过程 $\\{S_t\\}_{t \\ge 0}$ 服从一个由标准维纳过程驱动的几何布朗运动，具有恒定的漂移率和波动率，没有交易成本，允许卖空，并且可以以相同的连续复利无风险利率 $r$ 进行借贷。该股票不支付股息。在时间 $t=0$ 时，市场上交易着以下基于同一标的资产的金融工具：\n- 一份行权价为 $K$、到期日为 $T$ 的欧式看涨期权，价格为 $C_0$。\n- 一份具有相同行权价 $K$ 和到期日 $T$ 的欧式看跌期权，价格为 $P_0$。\n- 一份在时间 $T$ 到期、面值为 1 的零息债券，每单位面值的价格为 $\\exp(-rT)$。\n- 标的股票，价格为 $S_0$。\n\n假设市场报价如下：\n- $S_0 = 100$，\n- $K = 100$，\n- $r = 0.05$ (连续复利，年化)，\n- $T = 0.5$ (年)，\n- $C_0 = 9$，\n- $P_0 = 6$。\n\n仅使用静态复制和无套利原则，从欧式看涨和看跌期权收益的定义出发，构建一个明确的、自融资的静态套利策略，以利用任何违背连接 $C_0$、$P_0$、$S_0$ 和零息债券的唯一定价关系的情况。您的构建必须：\n- 明确指出在股票、看涨期权、看跌期权和零息债券（面值为 $K$，到期日为 $T$）中的确切头寸（多头或空头）。\n- 证明在时间 $T$ 的期末收益几乎必然为零（即，与 $S_T$ 无关）。\n- 计算在时间 $t=0$ 的初始净现金流。\n\n最后，将该策略在 $t=0$ 时实现的每股无风险利润计算为一个单一的数值。将您的答案四舍五入到四位有效数字。", "solution": "该问题要求基于欧式看涨期权、欧式看跌期权、标的股票和无风险债券的报价，识别并利用一个潜在的套利机会。在无套利框架下，支配这些金融工具之间关系的核心原则是看涨-看跌期权平价关系。\n\n首先，我们从第一性原理出发建立看涨-看跌期权平价关系。设 $C_T$ 和 $P_T$ 分别为欧式看涨期权和看跌期权在到期日 $T$ 的收益。其定义为：\n$$ C_T = \\max(S_T - K, 0) $$\n$$ P_T = \\max(K - S_T, 0) $$\n其中 $S_T$ 是时间 $T$ 时的股票价格，$K$ 是行权价。\n\n考虑在时间 $t=0$ 构建一个投资组合，该组合包含一份具有相同行权价 $K$ 和到期日 $T$ 的标的股票的看涨期权多头和一份看跌期权空头。该投资组合在到期日 $T$ 的价值为：\n$$ C_T - P_T = \\max(S_T - K, 0) - \\max(K - S_T, 0) $$\n我们针对所有可能的 $S_T$ 值分析此收益：\n1. 如果 $S_T > K$，收益为 $(S_T - K) - 0 = S_T - K$。\n2. 如果 $S_T \\le K$，收益为 $0 - (K - S_T) = S_T - K$。\n因此，该投资组合（多头看涨期权，空头看跌期权）的期末收益确定性地等于 $S_T - K$。\n\n这个期末收益 $S_T - K$ 可以通过另一个投资组合来复制：持有一股标的股票多头，并持有一份面值为 $K$、在时间 $T$ 到期的零息债券空头。股票在到期日的价值为 $S_T$，而债券债务要求支付 $K$。\n\n根据无套利原则（或单一价格法则），在所有未来状态下具有相同收益的两个投资组合，在今天的价格必须相同。第一个投资组合在 $t=0$ 时的价格是 $C_0 - P_0$。第二个投资组合的价格是 $S_0 - K \\exp(-rT)$，其中 $S_0$ 是 $t=0$ 时的股票价格，$K \\exp(-rT)$ 是在连续复利无风险利率 $r$ 下 $K$ 债务的现值。\n因此，看涨-看跌期权平价关系为：\n$$ C_0 - P_0 = S_0 - K\\exp(-rT) $$\n\n任何对该等式的偏离都预示着套利机会。我们现在将给定的市场报价代入此方程，以检查是否存在违背。\n给定的值为：\n- $S_0 = 100$\n- $K = 100$\n- $r = 0.05$\n- $T = 0.5$\n- $C_0 = 9$\n- $P_0 = 6$\n\n我们计算平价方程的左边（LHS）和右边（RHS）。\n左边（LHS）：\n$$ C_0 - P_0 = 9 - 6 = 3 $$\n右边（RHS）：\n$$ S_0 - K\\exp(-rT) = 100 - 100\\exp(-0.05 \\times 0.5) = 100 - 100\\exp(-0.025) $$\n数值上，$\\exp(-0.025) \\approx 0.97530991$。\n$$ \\text{RHS} \\approx 100 - 100(0.97530991) = 100 - 97.530991 = 2.469009 $$\n比较两边，我们发现：\n$$ 3 > 2.469009... $$\n所以，$C_0 - P_0 > S_0 - K\\exp(-rT)$。这证实了套利机会的存在。由等式左边代表的投资组合（多头看涨期权，空头看跌期权）相对于由等式右边代表的投资组合（多头股票，空头债券）被高估了。\n\n为了利用这个套利机会，我们构建一个“卖出昂贵的，买入便宜的”策略。该策略为：卖出左侧的投资组合，买入右侧的投资组合。具体交易如下：\n1.  **卖空1份欧式看涨期权**：获得现金流入 $C_0 = 9$。\n2.  **买入1份欧式看跌期权**：产生现金流出 $P_0 = 6$。\n3.  **买入1股股票**：产生现金流出 $S_0 = 100$。\n4.  **以无风险利率借款**：借入行权价的现值 $K\\exp(-rT)$，相当于获得现金流入 $100\\exp(-0.025)$。\n\n在 $t=0$ 时的初始净现金流即为套利利润：\n$$ \\text{利润}_{t=0} = C_0 - P_0 - S_0 + K\\exp(-rT) $$\n$$ \\text{利润}_{t=0} = (C_0 - P_0) - (S_0 - K\\exp(-rT)) $$\n$$ \\text{利润}_{t=0} \\approx 3 - (100 - 100\\exp(-0.025)) \\approx 3 - 2.469009 = 0.530991 $$\n这是在 $t=0$ 时的一个正现金流入。\n\n现在，我们证明这个组合投资组合在时间 $T$ 的期末收益为零，无论股票价格 $S_T$ 如何。\n我们在到期日 $T$ 持有资产的价值为：\n- 来自看涨期权空头的收益：$-\\max(S_T - K, 0)$\n- 来自看跌期权多头的收益：$+\\max(K - S_T, 0)$\n- 来自股票多头的收益：$+S_T$\n- 借款产生的债务：借入的金额 $K\\exp(-rT)$ 增长到 $K\\exp(-rT)\\exp(rT) = K$。所以，债务是支付 $K=100$。这表示为收益 $-K$。\n\n总期末收益为：\n$$ \\text{收益}_T = -\\max(S_T - K, 0) + \\max(K - S_T, 0) + S_T - K $$\n我们再次分情况分析：\n1.  如果 $S_T > K=100$：\n    $$ \\text{收益}_T = -(S_T - K) + 0 + S_T - K = -S_T + K + S_T - K = 0 $$\n2.  如果 $S_T \\le K=100$：\n    $$ \\text{收益}_T = 0 + (K - S_T) + S_T - K = K - S_T + S_T - K = 0 $$\n期末收益几乎必然为零。该策略成功地在时间 $t=0$ 锁定了 $C_0 - P_0 - S_0 + K\\exp(-rT)$ 的无风险利润。\n\n每股的无风险利润就是这个初始现金流：\n$$ \\text{利润} = 9 - 6 - 100 + 100\\exp(-0.05 \\times 0.5) $$\n$$ \\text{利润} = 3 - 100 + 100\\exp(-0.025) $$\n$$ \\text{利润} \\approx 3 - 100 + 97.5309914... = 0.5309914... $$\n将此结果四舍五入到四位有效数字，得到 $0.5310$。", "answer": "$$\\boxed{0.5310}$$", "id": "3051869"}, {"introduction": "理解期权定价不仅在于计算其当前价值，更在于管理其风险。本练习将引导你探索期权价格对标的资产价格变化的敏感度，即所谓的“希腊字母”。我们将推导其中一个关键指标——Gamma（$\\Gamma$），它衡量了对冲头寸的稳定性，并揭示了为何买权和卖权的Gamma值是相等的。[@problem_id:3051897]", "problem": "考虑一个支付连续股息率 $q \\geq 0$ 的标的股票，在风险中性测度下，其模型为几何布朗运动 $S_t$，满足随机微分方程 (SDE)\n$$\n\\mathrm{d}S_t = (r - q) S_t \\, \\mathrm{d}t + \\sigma S_t \\, \\mathrm{d}W_t,\n$$\n其中 $r \\in \\mathbb{R}$ 是连续复利无风险利率，$\\sigma > 0$ 是波动率，$W_t$ 是标准布朗运动。设 $T > 0$ 为固定到期日，$K > 0$ 为固定行权价，$S_0 > 0$ 为初始价格。令 $C(S_0)$ 和 $P(S_0)$ 分别表示到期日为 $T$、行权价为 $K$ 的欧式看涨期权和看跌期权在时刻 $0$ 的价格，由风险中性定价公式给出：\n$$\nC(S_0) = \\exp(-r T) \\, \\mathbb{E}\\!\\left[(S_T - K)^{+}\\right], \n\\qquad\nP(S_0) = \\exp(-r T) \\, \\mathbb{E}\\!\\left[(K - S_T)^{+}\\right].\n$$\n从这些定义和SDE所蕴含的 $S_T$ 分布出发，推导共同的关于初始价格的二阶导数，称为Gamma，\n$$\n\\Gamma := \\frac{\\partial^2 C}{\\partial S_0^2} = \\frac{\\partial^2 P}{\\partial S_0^2},\n$$\n并给出其闭式解。您的推导必须证明任何微分与期望求换序的合理性。然后：\n- 证明看涨期权和看跌期权的Gamma值相等。\n- 确定 $\\Gamma$ 的符号，并根据 $S_0$ 的货币单位的幂次来解释其单位。\n\n请以 $S_0$, $K$, $r$, $q$, $\\sigma$ 和 $T$ 的单一闭式解析表达式形式给出您对 $\\Gamma$ 的最终答案，仅使用初等函数和自然对数。无需四舍五入。最终答案中不包含单位。", "solution": "该问题已验证，是定量金融学中一个标准的、定义明确的问题。\n\n解决过程首先从给定的SDE和风险中性定价公式出发，推导欧式看涨期权价格 $C(S_0)$ 的闭式表达式。随后，我们将此表达式对初始股票价格 $S_0$ 求两次导数，以求得Gamma值 $\\Gamma$。\n\n首先，我们求解 $S_t$ 的SDE。令 $X_t = \\ln S_t$。对 $f(S_t) = \\ln S_t$ 应用伊藤引理 (Itô's lemma)，我们有：\n$$\n\\mathrm{d}X_t = \\left((r-q)S_t \\cdot \\frac{1}{S_t} - \\frac{1}{2}\\sigma^2 S_t^2 \\cdot \\frac{1}{S_t^2}\\right)\\mathrm{d}t + \\sigma S_t \\cdot \\frac{1}{S_t} \\mathrm{d}W_t = \\left(r-q-\\frac{1}{2}\\sigma^2\\right)\\mathrm{d}t + \\sigma\\mathrm{d}W_t\n$$\n从 $t=0$ 到 $t=T$ 积分可得：\n$$\n\\ln S_T - \\ln S_0 = \\left(r-q-\\frac{1}{2}\\sigma^2\\right)T + \\sigma W_T\n$$\n其中 $W_T \\sim N(0, T)$。这意味着 $\\ln S_T$ 服从正态分布：\n$$\n\\ln S_T \\sim N\\left(\\ln S_0 + \\left(r-q-\\frac{1}{2}\\sigma^2\\right)T, \\sigma^2 T\\right)\n$$\n看涨期权价格为 $C(S_0) = \\exp(-rT)\\mathbb{E}[(S_T-K)^+]$。利用 $S_T$ 的对数正态分布计算此期望，得到支付连续股息率 $q$ 的欧式看涨期权的Black-Scholes-Merton公式：\n$$\nC(S_0) = S_0 \\exp(-qT) N(d_1) - K \\exp(-rT) N(d_2)\n$$\n其中 $N(x)$ 是标准正态变量的累积分布函数，且\n$$\nd_1 = \\frac{\\ln(S_0/K) + (r-q+\\frac{1}{2}\\sigma^2)T}{\\sigma\\sqrt{T}}, \\quad d_2 = d_1 - \\sigma\\sqrt{T} = \\frac{\\ln(S_0/K) + (r-q-\\frac{1}{2}\\sigma^2)T}{\\sigma\\sqrt{T}}\n$$\n\n问题要求对微分与期望求换序进行证明。期权 payoff $(S_T - K)^+$ 关于 $S_0$ 并非处处可微，因为其在 $S_T=K$ 处的导数不连续。然而，期望算子平滑了该函数。严格来说，可以通过使用广义函数的性质来证明将微分算子移入期望内的合理性。payoff关于 $S_T$ 的一阶导数是亥维赛阶跃函数 (Heaviside step function) $\\mathbf{1}_{S_T>K}$。二阶导数是狄拉克δ函数 (Dirac delta function) $\\delta(S_T-K)$。这些可以在期望积分中处理，并且其结果与对最终闭式价格公式求导得到的结果一致。因此，我们接下来对闭式公式进行微分，这是一个有效的步骤。\n\n我们现在计算 $C(S_0)$ 关于 $S_0$ 的一阶导数，即Delta ($\\Delta_C$)。我们使用链式法则以及 $\\frac{\\mathrm{d}N(x)}{\\mathrm{d}x} = n(x) = \\frac{1}{\\sqrt{2\\pi}}\\exp(-x^2/2)$ 这一事实。\n$$\n\\frac{\\partial d_1}{\\partial S_0} = \\frac{\\partial d_2}{\\partial S_0} = \\frac{1}{S_0 \\sigma \\sqrt{T}}\n$$\n所以，看涨期权价格的导数为：\n$$\n\\Delta_C = \\frac{\\partial C}{\\partial S_0} = \\exp(-qT)N(d_1) + S_0\\exp(-qT)n(d_1)\\frac{\\partial d_1}{\\partial S_0} - K\\exp(-rT)n(d_2)\\frac{\\partial d_2}{\\partial S_0}\n$$\n$$\n\\Delta_C = \\exp(-qT)N(d_1) + \\frac{\\exp(-qT)n(d_1)}{\\sigma\\sqrt{T}} - \\frac{K\\exp(-rT)n(d_2)}{S_0\\sigma\\sqrt{T}}\n$$\nBlack-Scholes框架中的一个关键恒等式是 $S_0\\exp(-qT)n(d_1) = K\\exp(-rT)n(d_2)$。利用此恒等式，最后两项相互抵消，从而得到Delta的简洁表达式：\n$$\n\\Delta_C = \\exp(-qT)N(d_1)\n$$\n\n现在，我们通过对 $\\Delta_C$ 求关于 $S_0$ 的导数来计算二阶导数Gamma ($\\Gamma$)：\n$$\n\\Gamma = \\frac{\\partial^2 C}{\\partial S_0^2} = \\frac{\\partial \\Delta_C}{\\partial S_0} = \\frac{\\partial}{\\partial S_0} \\left( \\exp(-qT)N(d_1) \\right)\n$$\n$$\n\\Gamma = \\exp(-qT) \\frac{\\mathrm{d}N(d_1)}{\\mathrm{d}d_1} \\frac{\\partial d_1}{\\partial S_0} = \\exp(-qT) n(d_1) \\frac{1}{S_0 \\sigma \\sqrt{T}}\n$$\n代入 $n(d_1)$ 和 $d_1$ 的表达式，得到Gamma的完整闭式公式：\n$$\n\\Gamma = \\frac{\\exp(-qT)}{S_0 \\sigma \\sqrt{T}} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1}{2}d_1^2\\right) = \\frac{\\exp(-qT)}{S_0 \\sigma \\sqrt{2\\pi T}} \\exp\\left(-\\frac{1}{2} \\left( \\frac{\\ln(S_0/K) + (r-q+\\frac{1}{2}\\sigma^2)T}{\\sigma\\sqrt{T}} \\right)^2 \\right)\n$$\n这是欧式看涨期权Gamma所要求的闭式表达式。\n\n接下来，我们必须证明看涨期权和看跌期权的Gamma相等。我们使用针对支付连续股息率 $q$ 的资产的欧式期权看跌-看涨期权平价关系 (put-call parity)：\n$$\nC(S_0) - P(S_0) = S_0 \\exp(-qT) - K \\exp(-rT)\n$$\n将此恒等式对 $S_0$ 求一次导数，得到：\n$$\n\\frac{\\partial C}{\\partial S_0} - \\frac{\\partial P}{\\partial S_0} = \\exp(-qT)\n$$\n再次对 $S_0$ 求导：\n$$\n\\frac{\\partial^2 C}{\\partial S_0^2} - \\frac{\\partial^2 P}{\\partial S_0^2} = \\frac{\\partial}{\\partial S_0}(\\exp(-qT)) = 0\n$$\n由于右侧相对于 $S_0$ 是一个常数，其导数为零。因此，\n$$\n\\frac{\\partial^2 C}{\\partial S_0^2} = \\frac{\\partial^2 P}{\\partial S_0^2}\n$$\n这证实了欧式看涨期权的Gamma与具有相同参数的欧式看跌期权的Gamma是相同的。\n\n为确定 $\\Gamma$ 的符号，我们考察其公式： $\\Gamma = \\frac{\\exp(-qT) n(d_1)}{S_0 \\sigma \\sqrt{T}}$。\n问题指定了参数的以下约束： $S_0 > 0$, $\\sigma > 0$, $T > 0$ 和 $q \\ge 0$。\n分析 $\\Gamma$ 表达式中的每一项：\n- 贴现因子 $\\exp(-qT)$ 是正的，因为 $q \\ge 0$ 且 $T > 0$。\n- 标准正态分布的概率密度函数 $n(d_1) = \\frac{1}{\\sqrt{2\\pi}}\\exp(-d_1^2/2)$ 对于任何实数参数 $d_1$ 都是严格为正的。\n- 分母 $S_0 \\sigma \\sqrt{T}$ 是严格正数的乘积，因此是正的。\n由于 $\\Gamma$ 是正数之比，我们得出结论 $\\Gamma > 0$。Gamma的正性反映了期权价格函数相对于标的资产价格的凸性。\n\n最后，我们解释 $\\Gamma$ 的单位。令资产价格 $S_0$ 和期权价格 $C$ 的货币单位为“货币单位”（CU）。\n- 期权价格 $C$：CU。\n- 资产价格 $S_0$：CU。\n- 一阶导数Delta为 $\\Delta = \\frac{\\partial C}{\\partial S_0}$。其单位为 $\\frac{\\text{CU}}{\\text{CU}}$，是无量纲的。\n- 二阶导数Gamma为 $\\Gamma = \\frac{\\partial \\Delta}{\\partial S_0}$。其单位为 $\\frac{\\text{无量纲}}{\\text{CU}} = (\\text{CU})^{-1}$。\n因此，Gamma的单位是货币单位的倒数。它量化了标的价格变化一个单位时，期权Delta的变化量。用货币单位的幂次表示，该单位是-1。", "answer": "$$\n\\boxed{\\frac{\\exp(-qT)}{S_0 \\sigma \\sqrt{2\\pi T}} \\exp\\left(-\\frac{1}{2} \\left(\\frac{\\ln\\left(\\frac{S_0}{K}\\right) + \\left(r - q + \\frac{1}{2}\\sigma^{2}\\right)T}{\\sigma\\sqrt{T}}\\right)^{2}\\right)}\n$$", "id": "3051897"}]}