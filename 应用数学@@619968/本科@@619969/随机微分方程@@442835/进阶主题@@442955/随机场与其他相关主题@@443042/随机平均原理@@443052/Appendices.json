{"hands_on_practices": [{"introduction": "随机平均原理的核心思想，是用快变量在长期内的期望行为来替代其复杂且快速波动的具体影响。本练习将引导你完成这一基本过程的两个关键步骤。首先，我们将为一个“冻结”的快过程找到其平稳概率分布（或不变测度），它描述了快变量的长期统计特性。然后，我们将利用这个分布来计算驱动慢变量演化的有效“平均”漂移项，从而展示一个复杂的随机系统如何被简化为一个更易于处理的确定性系统。[@problem_id:3076817]", "problem": "考虑一个双时间尺度随机系统中的冻结快子系统，其中快变量 $y_{t}^{x}$ 满足一维伊藤随机微分方程 (SDE)\n$$\n\\mathrm{d}y_{t}^{x} = b(x,y_{t}^{x})\\,\\mathrm{d}t + \\beta(x,y_{t}^{x})\\,\\mathrm{d}W_{t},\n$$\n其中 $x$ 被视为一个固定参数，$W_{t}$ 是一个标准维纳过程，系数由 $b(x,y)=-\\gamma(x)\\,y$ 和 $\\beta(x,y)=\\sigma_{f}(x)$ 给出，对于所有容许的 $x$，都有 $\\gamma(x)>0$ 和 $\\sigma_{f}(x)>0$。令 $\\mu^{x}$ 表示在固定 $x$ 下快变量 $y_{t}^{x}$ 的不变概率测度，其条件保证了平稳分布的存在性和唯一性。对于函数 $f(x,y)=h(x)+p(x)\\,y+q(x)\\,y^{2}$，定义平均可观测量\n$$\n\\bar{f}(x) \\equiv \\int_{\\mathbb{R}} f(x,y)\\,\\mu^{x}(\\mathrm{d}y),\n$$\n其中 $h$、$p$ 和 $q$ 是给定的关于 $x$ 的确定性函数。仅使用随机微分方程的基本原理和稳态柯尔莫哥洛夫前向方程（也称为福克-普朗克方程），推导出不变测度 $\\mu^{x}$，然后以闭式形式计算平均可观测量 $\\bar{f}(x)$。请给出 $\\mu^{x}$ 的显式稳态密度（作为 $y$ 的函数）以及 $\\bar{f}(x)$ 的表达式作为最终答案。不需要进行数值近似；请给出精确的解析表达式。", "solution": "该问题是有效的。这是一个在随机微分方程领域中提法良好且具有科学依据的问题，要求推导奥恩斯坦-乌伦贝克过程的平稳分布并计算一个平均可观测量。所有必要的信息和条件都已提供，不存在矛盾或模糊之处。\n\n快变量 $y_{t}^{x}$ 的随机微分方程 (SDE) 由下式给出：\n$$\n\\mathrm{d}y_{t}^{x} = b(x,y_{t}^{x})\\,\\mathrm{d}t + \\beta(x,y_{t}^{x})\\,\\mathrm{d}W_{t}\n$$\n给定系数 $b(x,y)=-\\gamma(x)\\,y$ 和 $\\beta(x,y)=\\sigma_{f}(x)$，其中 $x$ 是一个固定参数，SDE 变为：\n$$\n\\mathrm{d}y_{t}^{x} = -\\gamma(x) y_{t}^{x}\\,\\mathrm{d}t + \\sigma_{f}(x)\\,\\mathrm{d}W_{t}\n$$\n这是一个线性SDE，称为奥恩斯坦-乌伦贝克过程。问题要求解不变概率测度 $\\mu^{x}$，它由其概率密度函数来表征，我们称之为 $\\pi^{x}(y)$。该密度是柯尔莫哥洛夫前向方程（也称为福克-普朗克方程）的稳态解。\n\n对于一个SDE $\\mathrm{d}Y_{t} = a(Y_{t})\\,\\mathrm{d}t + c(Y_{t})\\,\\mathrm{d}W_{t}$，其对应的概率密度 $\\pi(y)$ 的一般一维稳态福克-普朗克方程为：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}y} \\left[ -a(y)\\pi(y) + \\frac{1}{2} \\frac{\\mathrm{d}}{\\mathrm{d}y} (c(y)^{2}\\pi(y)) \\right] = 0\n$$\n这意味着概率流，即方括号中的项，是一个常数。对于一个概率密度在无穷远处消失（即 $\\lim_{y \\to \\pm\\infty} \\pi(y) = 0$）的平稳分布，这个常数必须为零。因此，我们有：\n$$\n-a(y)\\pi(y) + \\frac{1}{2} \\frac{\\mathrm{d}}{\\mathrm{d}y} (c(y)^{2}\\pi(y)) = 0\n$$\n对于我们的具体问题，将 $x$ 视为参数，漂移项为 $a(y) = b(x,y) = -\\gamma(x)y$，扩散系数为 $c(y) = \\beta(x,y) = \\sigma_{f}(x)$。我们将稳态密度记为 $\\pi^{x}(y)$。将这些代入零概率流条件，得到：\n$$\n-(-\\gamma(x)y)\\pi^{x}(y) + \\frac{1}{2} \\frac{\\mathrm{d}}{\\mathrm{d}y} (\\sigma_{f}(x)^{2}\\pi^{x}(y)) = 0\n$$\n由于 $\\sigma_{f}(x)$ 与 $y$ 无关，我们可以写成：\n$$\n\\gamma(x)y\\pi^{x}(y) + \\frac{\\sigma_{f}(x)^{2}}{2} \\frac{\\mathrm{d}\\pi^{x}(y)}{\\mathrm{d}y} = 0\n$$\n这是一个关于 $\\pi^{x}(y)$ 的一阶线性常微分方程。它是可分离的：\n$$\n\\frac{1}{\\pi^{x}(y)} \\frac{\\mathrm{d}\\pi^{x}(y)}{\\mathrm{d}y} = -\\frac{2\\gamma(x)}{\\sigma_{f}(x)^{2}} y\n$$\n对两边关于 $y$ 积分：\n$$\n\\int \\frac{1}{\\pi^{x}(y)} \\mathrm{d}\\pi^{x}(y) = \\int -\\frac{2\\gamma(x)}{\\sigma_{f}(x)^{2}} y \\,\\mathrm{d}y\n$$\n$$\n\\ln(\\pi^{x}(y)) = -\\frac{\\gamma(x)}{\\sigma_{f}(x)^{2}} y^{2} + C_{0}\n$$\n其中 $C_{0}$ 是积分常数。对两边取指数，得到：\n$$\n\\pi^{x}(y) = C \\exp\\left(-\\frac{\\gamma(x)}{\\sigma_{f}(x)^{2}} y^{2}\\right)\n$$\n其中 $C = \\exp(C_{0})$ 是一个归一化常数。为了求出 $C$，我们使用概率密度积分必须为 $1$ 的条件：\n$$\n\\int_{-\\infty}^{\\infty} \\pi^{x}(y) \\,\\mathrm{d}y = 1\n$$\n$$\nC \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\gamma(x)}{\\sigma_{f}(x)^{2}} y^{2}\\right) \\,\\mathrm{d}y = 1\n$$\n这是一个标准的高斯积分，形式为 $\\int_{-\\infty}^{\\infty} \\exp(-ay^{2})\\,\\mathrm{d}y = \\sqrt{\\pi/a}$。这里，$a = \\frac{\\gamma(x)}{\\sigma_{f}(x)^{2}}$。该积分的值为 $\\sqrt{\\frac{\\pi \\sigma_{f}(x)^{2}}{\\gamma(x)}}$。\n$$\nC \\sqrt{\\frac{\\pi \\sigma_{f}(x)^{2}}{\\gamma(x)}} = 1 \\implies C = \\sqrt{\\frac{\\gamma(x)}{\\pi \\sigma_{f}(x)^{2}}}\n$$\n因此，不变测度 $\\mu^{x}$ 的显式稳态密度为：\n$$\n\\pi^{x}(y) = \\sqrt{\\frac{\\gamma(x)}{\\pi \\sigma_{f}(x)^{2}}} \\exp\\left(-\\frac{\\gamma(x)}{\\sigma_{f}(x)^{2}} y^{2}\\right)\n$$\n这是一个正态分布 $\\mathcal{N}(\\mu, \\sigma^{2})$ 的概率密度函数，其均值 $\\mu=0$，方差 $\\sigma^{2}$ 由 $\\frac{1}{2\\sigma^{2}} = \\frac{\\gamma(x)}{\\sigma_{f}(x)^{2}}$ 给出，这意味着 $\\sigma^{2} = \\frac{\\sigma_{f}(x)^{2}}{2\\gamma(x)}$。\n\n接下来，我们计算平均可观测量 $\\bar{f}(x)$：\n$$\n\\bar{f}(x) = \\int_{\\mathbb{R}} f(x,y)\\,\\mu^{x}(\\mathrm{d}y) = \\int_{-\\infty}^{\\infty} f(x,y) \\pi^{x}(y) \\,\\mathrm{d}y\n$$\n代入给定的函数 $f(x,y)=h(x)+p(x)\\,y+q(x)\\,y^{2}$：\n$$\n\\bar{f}(x) = \\int_{-\\infty}^{\\infty} (h(x)+p(x)\\,y+q(x)\\,y^{2}) \\pi^{x}(y) \\,\\mathrm{d}y\n$$\n根据积分的线性性质：\n$$\n\\bar{f}(x) = h(x) \\int_{-\\infty}^{\\infty} \\pi^{x}(y)\\,\\mathrm{d}y + p(x) \\int_{-\\infty}^{\\infty} y\\,\\pi^{x}(y)\\,\\mathrm{d}y + q(x) \\int_{-\\infty}^{\\infty} y^{2}\\,\\pi^{x}(y)\\,\\mathrm{d}y\n$$\n这些积分是平稳分布的矩：\n1.  零阶矩：根据概率密度的定义，$\\int_{-\\infty}^{\\infty} \\pi^{x}(y)\\,\\mathrm{d}y = 1$。\n2.  一阶矩：$\\int_{-\\infty}^{\\infty} y\\,\\pi^{x}(y)\\,\\mathrm{d}y = \\mathbb{E}[y] = \\mu$。由于分布是 $\\mathcal{N}(0, \\frac{\\sigma_{f}(x)^{2}}{2\\gamma(x)})$，均值为 $\\mu = 0$。\n3.  二阶矩：$\\int_{-\\infty}^{\\infty} y^{2}\\,\\pi^{x}(y)\\,\\mathrm{d}y = \\mathbb{E}[y^{2}]$。对于任何随机变量，$\\mathrm{Var}(y) = \\mathbb{E}[y^{2}] - (\\mathbb{E}[y])^{2}$。因此，$\\mathbb{E}[y^{2}] = \\mathrm{Var}(y) + (\\mathbb{E}[y])^{2}$。由于 $\\mathbb{E}[y]=0$ 且 $\\mathrm{Var}(y) = \\sigma^{2} = \\frac{\\sigma_{f}(x)^{2}}{2\\gamma(x)}$，我们得到 $\\mathbb{E}[y^{2}] = \\frac{\\sigma_{f}(x)^{2}}{2\\gamma(x)}$。\n\n将这些矩代入 $\\bar{f}(x)$ 的表达式中：\n$$\n\\bar{f}(x) = h(x) \\cdot (1) + p(x) \\cdot (0) + q(x) \\cdot \\left(\\frac{\\sigma_{f}(x)^{2}}{2\\gamma(x)}\\right)\n$$\n$$\n\\bar{f}(x) = h(x) + \\frac{q(x)\\sigma_{f}(x)^{2}}{2\\gamma(x)}\n$$\n这就是平均可观测量 $\\bar{f}(x)$ 的闭式表达式。所要求的两个结果是稳态密度 $\\pi^x(y)$ 和平均函数 $\\bar{f}(x)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{\\frac{\\gamma(x)}{\\pi \\sigma_f(x)^2}} \\exp\\left(-\\frac{\\gamma(x) y^2}{\\sigma_f(x)^2}\\right) \\\\ h(x) + \\frac{q(x) \\sigma_f(x)^2}{2\\gamma(x)} \\end{pmatrix}}\n$$", "id": "3076817"}, {"introduction": "数学原理，无论多么强大，都在特定的假设下成立。本练习旨在通过探索随机平均原理的边界来加深你的理解。我们将研究一个特意违背了关键假设——快变量动力学具有唯一遍历性——的情景。通过构建这个简单而深刻的反例，你将清楚地看到标准平均结论为何会失效，以及系统的长期行为如何依赖于快变量的初始状态，这突显了在应用理论之前验证其成立条件的重要性。[@problem_id:3076873]", "problem": "考虑一个定义在概率空间 $(\\Omega,\\mathcal{F},\\mathbb{P})$ 上，尺度分离参数为 $\\varepsilon>0$ 的慢快系统。慢变量 $X^{\\varepsilon}$ 和快变量 $Y$ 的演化遵循以下方程\n$$\n\\begin{cases}\ndX_t^{\\varepsilon} = f\\!\\big(Y_{t/\\varepsilon}\\big)\\, dt,\\quad X_0^{\\varepsilon}=0,\\\\\nY_s \\in \\{-1,1\\}\\ \\text{for all}\\ s\\ge 0,\\quad Y_s = Y_0\\ \\text{for all}\\ s\\ge 0,\n\\end{cases}\n$$\n其中 $f:\\{-1,1\\}\\to\\mathbb{R}$ 由 $f(y)=y$ 给出。快变量 $Y$ 是一个时齐马尔可夫过程，其生成元 $L$ 对所有有界可测函数 $\\phi$ 和 $y\\in\\{-1,1\\}$ 满足 $L\\phi(y)=0$（因此 $Y$ 在时间上是恒定的，并有多个不变概率测度）。\n\n这个设定违反了作为随机微分方程（SDEs）随机平均原理基础的唯一遍历性假设。从不变概率测度、遍历性以及马尔可夫过程时间平均的基本定义出发，明确地构造这个反例，并计算慢变量在固定的终端时间 $T>0$ 时的实际极限：\n$$\n\\lim_{\\varepsilon\\to 0} X_T^{\\varepsilon}\n$$\n对应于两个初始条件 $Y_0=1$ 和 $Y_0=-1$。将你的最终答案以行矩阵形式的单个有序对报告。无需四舍五入，不涉及单位。在你的推导中，简要而精确地解释快动力学缺乏遍历性如何导致平均结论的失败（即，极限慢漂移独立于初始快条件），但你唯一必须输出的量是上面要求的有序对。", "solution": "该问题要求通过分析一个快动力学非唯一遍历的特定慢快系统，来为标准随机平均原理构造一个反例。我们必须计算当时间尺度分离参数 $\\varepsilon$ 趋于零时，对于快变量 $Y_0$ 的两种不同初始条件下，慢变量 $X_T^{\\varepsilon}$ 的极限。\n\n该慢快系统由慢变量 $X^{\\varepsilon}$ 的以下随机微分方程定义：\n$$\ndX_t^{\\varepsilon} = f(Y_{t/\\varepsilon})\\, dt, \\quad X_0^{\\varepsilon} = 0\n$$\n其中 $T > 0$ 是一个固定的终端时间。函数 $f:\\{-1,1\\}\\to\\mathbb{R}$ 由 $f(y)=y$ 给出。快变量 $Y_s$ 是状态空间 $\\{-1,1\\}$ 上的一个马尔可夫过程，其动力学由 $Y_s = Y_0$ 对所有 $s \\ge 0$ 给出。这意味着该过程在时间上是恒定的，其值完全由其初始状态 $Y_0$ 决定。\n\n首先，我们通过对其控制方程从 $t=0$ 到 $t=T$ 进行直接积分来求解慢变量 $X_T^{\\varepsilon}$：\n$$\nX_T^{\\varepsilon} = X_0^{\\varepsilon} + \\int_0^T f(Y_{t/\\varepsilon})\\, dt\n$$\n使用初始条件 $X_0^{\\varepsilon}=0$ 和定义 $f(y)=y$，方程变为：\n$$\nX_T^{\\varepsilon} = \\int_0^T Y_{t/\\varepsilon}\\, dt\n$$\n快过程的动力学为 $Y_s = Y_0$ 对所有 $s \\ge 0$ 成立。这意味着在积分区间内的任何时间 $t$，快过程在重标度时间 $t/\\varepsilon$ 的值就是 $Y_0$。因此被积函数是恒定的：\n$$\nY_{t/\\varepsilon} = Y_0\n$$\n将此代入积分，我们得到：\n$$\nX_T^{\\varepsilon} = \\int_0^T Y_0\\, dt = Y_0 \\int_0^T 1\\, dt = Y_0 T\n$$\n这个 $X_T^{\\varepsilon}$ 的表达式与参数 $\\varepsilon$ 无关。\n\n接下来，我们计算当 $\\varepsilon \\to 0$ 时的极限。由于 $X_T^{\\varepsilon}$ 不依赖于 $\\varepsilon$，这个极限是平凡的：\n$$\n\\lim_{\\varepsilon\\to 0} X_T^{\\varepsilon} = \\lim_{\\varepsilon\\to 0} (Y_0 T) = Y_0 T\n$$\n这个极限取决于快变量的初始条件 $Y_0$。我们被要求对两种具体情况评估这个极限：\n\n1.  对于初始条件 $Y_0 = 1$：\n    $$\n    \\lim_{\\varepsilon\\to 0} X_T^{\\varepsilon} = (1) \\cdot T = T\n    $$\n2.  对于初始条件 $Y_0 = -1$：\n    $$\n    \\lim_{\\varepsilon\\to 0} X_T^{\\varepsilon} = (-1) \\cdot T = -T\n    $$\n\n这个结果构成了对标准随机平均原理的一个反例。为了理解原因，我们必须审视该原理的假设。该原理指出，如果快过程 $Y_s$ 是遍历的，且具有唯一的不变概率测度 $\\mu$，那么慢过程 $X_t^{\\varepsilon}$ 会收敛到一个确定性平均方程 $d\\bar{X}_t = \\bar{f} dt$ 的解 $\\bar{X}_t$，其中平均漂移为 $\\bar{f} = \\int_S f(y) \\mu(dy)$。这一结论的关键特征是，极限动力学与初始状态 $Y_0$ 无关。\n\n我们来分析快过程 $Y_s$ 的遍历性。在状态空间 $S=\\{-1,1\\}$ 上的一个概率测度 $\\mu$ 是不变的，如果对于任何有界可测函数 $\\phi$，关系式 $\\int_S (P_s \\phi)(y) \\mu(dy) = \\int_S \\phi(y) \\mu(dy)$ 成立，其中 $P_s$ 是转移半群。对于我们的过程 $Y_s=Y_0$，半群是恒等算子，$(P_s \\phi)(y) = \\mathbb{E}[\\phi(Y_s)|Y_0=y] = \\phi(y)$。不变性条件成为一个重言式，$\\int_S \\phi(y) \\mu(dy) = \\int_S \\phi(y) \\mu(dy)$。这意味着在 $S=\\{-1,1\\}$ 上的*任何*概率测度都是一个不变测度。\n\n在 $\\{-1,1\\}$ 上的所有概率测度的集合是族 $\\{\\mu_p = p\\delta_1 + (1-p)\\delta_{-1} \\mid p \\in [0,1]\\}$，其中 $\\delta_y$ 是在 $y$ 点的狄拉克测度。由于存在不止一个不变测度，根据定义，该过程不是遍历的。\n\n唯一遍历性假设的失败是标准平均结论失败的核心原因。系统的极限不是单一的平均行为，而是取决于过程从哪个“遍历分支”开始。状态空间 $S$ 分解为两个不相交的、不变的（因此是遍历的）集合：$\\{1\\}$ 和 $\\{-1\\}$。\n- 如果 $Y_0=1$，过程在集合 $\\{1\\}$ 上进行，其唯一不变测度是 $\\delta_1$。有效的平均漂移为 $\\bar{f}_1 = \\int_S y \\, \\delta_1(dy) = 1$。那么 $X_T^{\\varepsilon}$ 的极限是 $1 \\cdot T = T$。\n- 如果 $Y_0=-1$，过程在集合 $\\{-1\\}$ 上进行，其唯一不变测度是 $\\delta_{-1}$。有效的平均漂移为 $\\bar{f}_{-1} = \\int_S y \\, \\delta_{-1}(dy) = -1$。那么 $X_T^{\\varepsilon}$ 的极限是 $(-1) \\cdot T = -T$。\n\n我们的直接计算证实了这一点：慢变量的极限确实依赖于快变量的初始状态，这与由唯一遍历快过程产生的单一、普适极限动力学的预测相矛盾。最终答案是这两个极限的有序对。", "answer": "$$\n\\boxed{\\begin{pmatrix} T  -T \\end{pmatrix}}\n$$", "id": "3076873"}, {"introduction": "从纯理论走向实际应用往往会揭示新的挑战。直接对慢-快系统进行数值模拟的计算成本极高，因为它需要在很长的时间跨度上解析最快的时间尺度。本练习将向你介绍像“异构多尺度方法”（HMM）这类实用数值方案背后的思想。你将分析如何策略性地选择模拟参数，以在准确性和计算成本之间取得平衡，并处理实践中出现的各种误差来源——从数值离散化到统计采样误差。[@problem_id:3076759]", "problem": "考虑有限时间域 $[0,T]$（其中 $T>0$）上的慢快随机微分方程 (SDE) 组，\n$$\n\\mathrm{d}X_t^\\varepsilon \\;=\\; f\\!\\left(X_t^\\varepsilon,Y_t^\\varepsilon\\right)\\,\\mathrm{d}t, \n\\qquad \n\\mathrm{d}Y_t^\\varepsilon \\;=\\; \\frac{1}{\\varepsilon} b\\!\\left(X_t^\\varepsilon,Y_t^\\varepsilon\\right)\\,\\mathrm{d}t \\;+\\; \\frac{1}{\\sqrt{\\varepsilon}} \\beta\\!\\left(X_t^\\varepsilon,Y_t^\\varepsilon\\right)\\,\\mathrm{d}B_t,\n$$\n其中 $B_t$ 是一个标准的 $m$ 维布朗运动，$\\varepsilon\\in(0,1]$ 是尺度分离参数，$f$、$b$ 和 $\\beta$ 是全局利普希茨且满足线性增长条件的。\n假设对于每个固定的 $x$，冻结的快动力学\n$$\n\\mathrm{d}Y_t^{x} \\;=\\; b\\!\\left(x,Y_t^{x}\\right)\\,\\mathrm{d}t \\;+\\; \\beta\\!\\left(x,Y_t^{x}\\right)\\,\\mathrm{d}B_t\n$$\n是遍历的，具有唯一的不变概率测度 $\\mu^x$，并且是指数混合的，具有一致的谱隙：存在 $\\lambda_0>0$，使得对于有界利普希茨可观测量 $g$，相关函数以 $\\mathrm{e}^{-\\lambda_0 t}$ 的速率衰减。\n\n根据随机平均原理，当 $\\varepsilon\\to 0$ 时，慢变量分量 $X_t^\\varepsilon$ (在适当的意义下) 收敛于由平均化方程控制的 $\\bar X_t$\n$$\n\\frac{\\mathrm{d}\\bar X_t}{\\mathrm{d}t} \\;=\\; \\bar f\\!\\left(\\bar X_t\\right), \n\\qquad \n\\bar f(x) \\;=\\; \\int f(x,y)\\,\\mu^x(\\mathrm{d}y).\n$$\n用于近似 $\\bar X_t$ 的一种异构多尺度方法 (HMM) 在每个宏观时间步按如下方式进行：给定一个宏观状态 $x$，通过在长度为 $\\tau>0$ 的短时间窗口上，使用大小为 $\\delta t>0$ 的微观时间步长对冻结的快过程 $Y_t^{x}$ 进行微观模拟，计算其时间平均值来近似 $\\bar f(x)$，然后通过大小为 $\\Delta t>0$ 的显式欧拉宏观步来推進慢变量：\n$$\nX_{n+1} \\;=\\; X_n \\;+\\; \\Delta t \\,\\widehat{f}(X_n),\n\\qquad \n\\widehat{f}(x) \\;=\\; \\frac{1}{\\tau}\\int_0^\\tau f\\!\\left(x,Y_s^{x,\\delta t}\\right)\\,\\mathrm{d}s,\n$$\n其中 $Y_s^{x,\\delta t}$ 表示使用微观步长 $\\delta t$ 对 $Y_s^x$ 进行的 Euler–Maruyama 离散化。\n\n假设对于指数混合马尔可夫过程和 Euler–Maruyama 方法，以下经过充分验证的事实成立：\n- 由不完全混合引起的有限时间平均偏差满足 $\\left|\\mathbb{E}\\,\\widehat{f}(x)-\\bar f(x)\\right| \\le C_1\\,\\mathrm{e}^{-c\\,\\tau/\\varepsilon}$，其中某些 $c,C_1>0$ 与 $\\varepsilon$、$\\tau$ 和 $\\delta t$ 无关。\n- 微观求解器在弱意义下的时间离散化偏差为 $O(\\delta t)$，即 $\\left|\\mathbb{E}\\,\\widehat{f}(x)-\\mathbb{E}\\,\\widehat{f}_{\\mathrm{cont}}(x)\\right| \\le C_2\\,\\delta t$，其中某些 $C_2>0$，$ \\widehat{f}_{\\mathrm{cont}}$ 使用精确的 $Y_t^{x}$。\n- 时间平均的标准差的尺度行为为 $\\mathrm{Std}(\\widehat{f}(x)) \\le C_3 \\sqrt{\\varepsilon/\\tau}$，其中某些 $C_3>0$ (具有相关时间 $O(\\varepsilon)$ 的中心极限定理行为)。\n- 用于 $\\dot X=\\bar f(X)$ 的显式欧拉宏观积分器在 $[0,T]$ 上的全局误差为 $O(\\Delta t)$。\n\n你希望对于一个给定的容差 $\\eta\\in(0,1)$，HMM 对慢变量在时间 $T$ 的近似的均方根全局误差为 $O(\\eta)$，同时保持总计算成本尽可能低。每个宏观步的成本与 $\\tau/\\delta t$ 成正比，并且有 $T/\\Delta t$ 个宏观步，因此总成本的尺度行为类似于 $(T/\\Delta t)(\\tau/\\delta t)$。\n\n哪个选项给出了微观时间步长 $\\delta t$、微观窗口长度 $\\tau$ 和宏观时间步长 $\\Delta t$ 的一个渐近平衡的选择（作为 $\\varepsilon$ 和 $\\eta$ 的函数，不计与 $\\varepsilon$ 和 $\\eta$ 无关的常数），该选择能以接近最小的成本达到 $O(\\eta)$ 的精度？\n\nA. 选择 $\\Delta t \\asymp \\eta$，选择 $\\delta t \\asymp \\min\\{\\varepsilon,\\eta\\}$ 以确保微观稳定性和 $O(\\eta)$ 的弱偏差，并选择 $\\tau \\asymp \\varepsilon \\max\\{ \\eta^{-1}, \\log(1/\\eta)\\}$ 使得混合偏差 $O\\!\\left(\\mathrm{e}^{-c\\,\\tau/\\varepsilon}\\right)$ 和方差为 $O\\!\\left((T/\\Delta t)(\\Delta t)^2\\,\\varepsilon/\\tau\\right)$ 的累积采样噪声在均方根意义下均为 $O(\\eta)$。\n\nB. 选择 $\\Delta t \\asymp \\eta$，选择 $\\delta t \\asymp 1$ 以避免过多的微观步，并选择 $\\tau \\asymp \\log(1/\\eta)$ 因为只需要控制混合偏差；无论 $\\tau$ 如何，采样噪声在 $\\varepsilon\\to 0$ 时都会消失。\n\nC. 选择 $\\Delta t \\asymp \\eta$，选择 $\\delta t \\asymp \\varepsilon$ 以解析快尺度，并选择 $\\tau \\asymp \\varepsilon \\log(1/\\eta)$ 使得混合偏差为 $O(\\eta)$；那么在宏观层面上，平均值的方差会自动变为 $O(\\eta)$。\n\nD. 选择 $\\Delta t \\asymp \\eta^2$ 以将宏观离散化误差减小到 $O(\\eta)$ 以下，选择 $\\delta t \\asymp \\varepsilon^2$ 以进一步减小微观离散化偏差，并选择 $\\tau \\asymp \\varepsilon \\eta^{-4}$ 使得采样噪声可以忽略不计；这以更多计算为代价确保了精度，因此是平衡的。", "solution": "用户需要对应用于慢快随机系统的异构多尺度方法 (HMM) 的参数尺度进行分析。\n\n### 步骤 1：提取给定条件\n\n-   **慢快系统**：对于 $[0,T]$ 上的 $\\varepsilon \\in (0,1]$，\n    $$\n    \\mathrm{d}X_t^\\varepsilon \\;=\\; f\\!\\left(X_t^\\varepsilon,Y_t^\\varepsilon\\right)\\,\\mathrm{d}t, \n    $$\n    $$\n    \\mathrm{d}Y_t^\\varepsilon \\;=\\; \\frac{1}{\\varepsilon} b\\!\\left(X_t^\\varepsilon,Y_t^\\varepsilon\\right)\\,\\mathrm{d}t \\;+\\; \\frac{1}{\\sqrt{\\varepsilon}} \\beta\\!\\left(X_t^\\varepsilon,Y_t^\\varepsilon\\right)\\,\\mathrm{d}B_t.\n    $$\n-   **平均化极限**：当 $\\varepsilon\\to 0$ 时，$X_t^\\varepsilon$ 收敛于 $\\bar X_t$，其中 $\\frac{\\mathrm{d}\\bar X_t}{\\mathrm{d}t} = \\bar f(\\bar X_t)$ 且 $\\bar f(x) = \\int f(x,y)\\,\\mu^x(\\mathrm{d}y)$。$\\mu^x$ 是冻结快过程 $\\mathrm{d}Y_t^{x} = b(x,Y_t^{x})\\,\\mathrm{d}t + \\beta(x,Y_t^{x})\\,\\mathrm{d}B_t$ 的唯一不变测度，该过程假设为指数混合。\n-   **HMM 算法**：\n    -   宏观步: $X_{n+1} = X_n + \\Delta t \\,\\widehat{f}(X_n)$。\n    -   估计量: $\\widehat{f}(x) = \\frac{1}{\\tau}\\int_0^\\tau f(x,Y_s^{x,\\delta t})\\,\\mathrm{d}s$。\n    -   $Y_s^{x,\\delta t}$ 是使用微观步长 $\\delta t$ 对*重标度*快过程（速度为 $1/\\varepsilon$ 的动力学）的 Euler-Maruyama 近似。问题陈述暗示模拟的是生成元为 $(1/\\varepsilon)\\mathcal{L}_x$ 的过程，其中 $\\mathcal{L}_x$ 是 $Y_t^x$ 的生成元。\n-   **误差估计**：\n    1.  混合偏差：由有限时间平均引起的偏差， $|\\mathbb{E}\\,\\widehat{f}(x)-\\bar f(x)| \\le C_1\\,\\mathrm{e}^{-c\\,\\tau/\\varepsilon}$。这个陈述稍有不精确，因为它似乎将总偏差与混合偏差混为一谈。我们将假设采用标准的误差分解，其中总偏差是混合偏差和离散化偏差之和。我们理解为问题为这两个来源提供了独立的估计，其中连续时间估计量的混合偏差以 $O(\\mathrm{e}^{-c\\,\\tau/\\varepsilon})$ 为界。\n    2.  微观求解器弱偏差：$|\\mathbb{E}\\,\\widehat{f}(x)-\\mathbb{E}\\,\\widehat{f}_{\\mathrm{cont}}(x)| \\le C_2\\,\\delta t$。这是 Euler-Maruyama 方法的标准 1 阶弱误差。\n    3.  采样噪声：$\\mathrm{Std}(\\widehat{f}(x)) \\le C_3 \\sqrt{\\varepsilon/\\tau}$。这源于遍历过程时间平均的中心极限定理，其中有效独立样本数量与 $\\tau/\\varepsilon$ 成正比。\n    4.  宏观积分器误差：显式欧拉法的全局误差为 $O(\\Delta t)$。\n-   **目标**：对于容差 $\\eta \\in (0,1)$，达到 $O(\\eta)$ 的均方根 (RMS) 全局误差。\n-   **成本函数**：总成本与 $(T/\\Delta t)(\\tau/\\delta t)$ 成正比。\n\n### 步骤 2：使用提取的条件进行验证\n\n-   **科学依据**：该问题在多尺度随机系统理论及其通过 HMM 等方法的数值近似方面有坚实的基础。所提供的误差估计是该领域的标准结果。\n-   **适定性**：该问题要求参数的最优选择，以平衡不同误差源与计算成本，这是数值分析中的一个标准且适定的问题。\n-   **客观性**：该问题以精确的数学术语陈述。\n\n提供的“有限时间平均偏差”的误差估计 $|\\mathbb{E}\\,\\widehat{f}(x)-\\bar f(x)| \\le C_1\\,\\mathrm{e}^{-c\\,\\tau/\\varepsilon}$ 稍显模糊。它将估计量 $\\widehat{f}(x)$ 的总偏差完全归因于混合误差，而忽略了下一点中给出的微观求解器的离散化误差。更标准的方法是将总偏差视为混合偏差和离散化偏差之和。\n$$\n\\mathbb{E}[\\widehat{f}(x)] - \\bar{f}(x) = \\underbrace{\\left(\\mathbb{E}[\\widehat{f}(x)] - \\mathbb{E}[\\widehat{f}_{\\mathrm{cont}}(x)]\\right)}_{\\text{离散化偏差}} + \\underbrace{\\left(\\mathbb{E}[\\widehat{f}_{\\mathrm{cont}}(x)] - \\bar{f}(x)\\right)}_{\\text{混合偏差}}\n$$\n问题分别为两项提供了界。我们将假设意图是这种标准分解，而第一个陈述只是写得不精确。在这种合理的解释下，问题是有效的并且可以解决。\n\n### 结论与行动\n问题被认为是有效的，我们继续进行求解。\n\n###\n### 最优参数尺度的推导\n\n在时间 $T=N\\Delta t$，HMM 近似 $X_N$ 相对于真实慢变量 $\\bar{X}(T)$ 的总均方根 (RMS) 误差是三个主要误差源的集合：\n\n1.  **宏观离散化误差 ($E_{\\text{macro}}$)**：这是使用显式欧拉法对平均化常微分方程 $\\dot{\\bar{X}} = \\bar{f}(\\bar{X})$ 进行积分所产生的误差。对于长度为 $T$ 的时间区间，一阶方法的全局误差与宏观步长成正比。\n    $$ E_{\\text{macro}} = O(\\Delta t) $$\n    为了达到 $O(\\eta)$ 的总误差，我们必须有 $\\Delta t \\lesssim \\eta$。为了成本效率，我们选择可能的最大步长，因此 $\\Delta t \\asymp \\eta$。\n\n2.  **估计量偏差带来的误差 ($E_{\\text{bias}}$)**：在每个宏观步，我们引入一个偏差 $\\mathbb{E}[\\widehat{f}(X_n)] - \\bar{f}(X_n)$。这个偏差有两个组成部分：\n    -   **离散化偏差**：来自使用微观时间步长 $\\delta t$，为 $O(\\delta t)$。\n    -   **混合偏差**：来自使用有限的微观模拟时间 $\\tau$，为 $O(\\mathrm{e}^{-c\\tau/\\varepsilon})$。\n    总的局部偏差为 $B(x) = O(\\delta t + \\mathrm{e}^{-c\\tau/\\varepsilon})$。这个偏差在 $N=T/\\Delta t$ 个宏观步上累积。由这个系统偏差引起的全局误差与总时间乘以平均偏差成正比，即 $E_{\\text{bias}} \\sim T \\cdot B(X_t)$。为了确保这是 $O(\\eta)$，我们需要：\n    $$ T\\delta t \\lesssim \\eta \\quad \\text{和} \\quad T\\mathrm{e}^{-c\\tau/\\varepsilon} \\lesssim \\eta $$\n    由于 $T$ 是一个固定常数，这简化为 $\\delta t \\lesssim \\eta$ 和 $\\mathrm{e}^{-c\\tau/\\varepsilon} \\lesssim \\eta$。第二个条件等价于 $-c\\tau/\\varepsilon \\lesssim \\log(\\eta)$，或者 $\\tau \\gtrsim \\frac{\\varepsilon}{c} \\log(1/\\eta)$。因此，我们要求：\n    $$ \\delta t \\asymp \\eta \\quad \\text{和} \\quad \\tau \\gtrsim \\varepsilon \\log(1/\\eta) $$\n    此外，用于快过程的 Euler-Maruyama 微观求解器必须是数值稳定的。像 Euler-Maruyama 这样的显式方法，其微观步长为 $\\delta t$，通常要求有效步长 $\\delta t/\\varepsilon$ 有界以保证稳定性。这施加了约束 $\\delta t \\lesssim \\varepsilon$。结合精度要求，我们有 $\\delta t \\asymp \\min(\\eta, \\varepsilon)$。\n\n3.  **估计量统计噪声带来的误差 ($E_{\\text{stat}}$)**：估计量 $\\widehat{f}$ 在其均值周围有随机波动。标准差由 $\\mathrm{Std}(\\widehat{f}(x)) \\le C_3 \\sqrt{\\varepsilon/\\tau}$ 给出。这些在每个宏观步引入的随机误差像随机游走一样累积。由于这些波动，在时间 $T$ 的全局误差方差是每一步引入的误差方差之和，这些误差传播到最终时间。这个和大约是 $N \\times (\\Delta t)^2 \\times \\mathrm{Var}(\\widehat{f})$，其中 $N=T/\\Delta t$。\n    $$ \\mathrm{Var}(E_{\\text{stat}}) \\approx \\frac{T}{\\Delta t} (\\Delta t)^2 \\mathrm{Var}(\\widehat{f}) = T \\Delta t \\cdot \\mathrm{Var}(\\widehat{f}) \\asymp T \\Delta t \\frac{\\varepsilon}{\\tau} $$\n    RMS 误差是平方根：$E_{\\text{stat, RMS}} = \\sqrt{\\mathrm{Var}(E_{\\text{stat}})} \\asymp \\sqrt{T \\Delta t \\varepsilon / \\tau}$。\n    为确保此误差为 $O(\\eta)$，我们需要：\n    $$ \\sqrt{T \\Delta t \\varepsilon / \\tau} \\lesssim \\eta $$\n    代入我们第一个条件中的 $\\Delta t \\asymp \\eta$，我们得到：\n    $$ \\sqrt{T \\eta \\varepsilon / \\tau} \\lesssim \\eta \\implies T \\eta \\varepsilon / \\tau \\lesssim \\eta^2 \\implies \\tau \\gtrsim T \\varepsilon / \\eta $$\n    由于 $T$ 是一个常数，这即是 $\\tau \\gtrsim \\varepsilon/\\eta$。\n\n**平衡与成本最小化**\n\n为了以最小成本实现 $O(\\eta)$ 的总 RMS 误差，我们必须通过在边界上选择参数来满足所有推导出的条件。\n-   $\\Delta t \\asymp \\eta$。\n-   $\\delta t \\asymp \\min(\\eta, \\varepsilon)$。\n-   $\\tau$ 必须同时满足 $\\tau \\gtrsim \\varepsilon \\log(1/\\eta)$（来自偏差）和 $\\tau \\gtrsim \\varepsilon/\\eta$（来自统计）。因为对于小的 $\\eta>0$，我们有 $1/\\eta \\gg \\log(1/\\eta)$，所以第二个条件更严格。\n    因此，我们必须选择 $\\tau \\asymp \\varepsilon/\\eta$。这个选择可以更普遍地写成 $\\tau \\asymp \\varepsilon \\max(\\varepsilon \\log(1/\\eta), \\varepsilon/\\eta)$，对于足够小的目标容差 $\\eta$，它简化为 $\\tau \\asymp \\varepsilon/\\eta$。\n\n平衡的选择是：\n-   宏观步长：$\\Delta t \\asymp \\eta$。\n-   微观步长：$\\delta t \\asymp \\min(\\eta, \\varepsilon)$。\n-   微观窗口：$\\tau \\asymp \\varepsilon/\\eta$。更精确地，$\\tau \\asymp \\varepsilon \\max\\{\\eta^{-1}, \\log(1/\\eta)\\}$。\n\n总成本尺度：成本 $\\propto \\frac{\\tau}{\\Delta t \\cdot \\delta t} \\asymp \\frac{\\varepsilon/\\eta}{\\eta \\cdot \\min(\\eta, \\varepsilon)}$。\n-   如果 $\\eta \\lesssim \\varepsilon$：成本 $\\propto \\frac{\\varepsilon/\\eta}{\\eta \\cdot \\eta} = \\varepsilon/\\eta^3$。\n-   如果 $\\varepsilon \\lesssim \\eta$：成本 $\\propto \\frac{\\varepsilon/\\eta}{\\eta \\cdot \\varepsilon} = 1/\\eta^2$。\n\n### 逐项分析\n\n-   **A. 选择 $\\Delta t \\asymp \\eta$，选择 $\\delta t \\asymp \\min\\{\\varepsilon,\\eta\\}$ 以确保微观稳定性和 $O(\\eta)$ 的弱偏差，并选择 $\\tau \\asymp \\varepsilon \\max\\{ \\eta^{-1}, \\log(1/\\eta)\\}$ 使得混合偏差 $O\\!\\left(\\mathrm{e}^{-c\\,\\tau/\\varepsilon}\\right)$ 和方差为 $O\\!\\left((T/\\Delta t)(\\Delta t)^2\\,\\varepsilon/\\tau\\right)$ 的累积采样噪声在均方根意义下均为 $O(\\eta)$。**\n    -   选择 $\\Delta t \\asymp \\eta$ 正确地平衡了宏观误差。\n    -   选择 $\\delta t \\asymp \\min(\\varepsilon, \\eta)$ 正确地平衡了微观求解器的偏差要求 ($\\lesssim \\eta$) 和稳定性要求 ($\\lesssim \\varepsilon$)。\n    -   选择 $\\tau \\asymp \\varepsilon \\max\\{\\eta^{-1}, \\log(1/\\eta)\\}$ 正确地平衡了混合偏差要求 ($\\tau \\gtrsim \\varepsilon \\log(1/\\eta)$) 和统计误差要求 ($\\tau \\gtrsim \\varepsilon/\\eta$)。\n    -   选项中为每个选择提供的理由也与我们的推导一致。\n    -   **结论：正确。**\n\n-   **B. 选择 $\\Delta t \\asymp \\eta$，选择 $\\delta t \\asymp 1$ 以避免过多的微观步，并选择 $\\tau \\asymp \\log(1/\\eta)$ 因为只需要控制混合偏差；无论 $\\tau$ 如何，采样噪声在 $\\varepsilon\\to 0$ 时都会消失。**\n    -   选择 $\\delta t \\asymp 1$ 太大了。由此产生的全局偏差误差将为 $O(T\\cdot 1) = O(1)$，不满足 $O(\\eta)$ 的精度目标。此外，如果 $\\varepsilon$ 很小，$\\delta t=O(1)$ 将违反稳定性条件 $\\delta t \\lesssim \\varepsilon$。\n    -   关于采样噪声的理由是有缺陷的。虽然对于固定的参数，当 $\\varepsilon \\to 0$ 时噪声会消失，但对于一个给定的、具有小但固定的 $\\varepsilon$ 和 $\\eta$ 的问题，必须主动控制统计误差。选择 $\\tau \\asymp \\log(1/\\eta)$ 将导致 $O(\\sqrt{\\eta\\varepsilon/\\log(1/\\eta)})$ 的 RMS 统计误差，除非 $\\varepsilon$ 相对于 $\\eta$ 极小，否则这远大于要求的 $O(\\eta)$。\n    -   **结论：不正确。**\n\n-   **C. 选择 $\\Delta t \\asymp \\eta$，选择 $\\delta t \\asymp \\varepsilon$ 以解析快尺度，并选择 $\\tau \\asymp \\varepsilon \\log(1/\\eta)$ 使得混合偏差为 $O(\\eta)$；那么在宏观层面上，平均值的方差会自动变为 $O(\\eta)$。**\n    -   如果精度要求 $\\eta$ 远小于 $\\varepsilon$，则选择 $\\delta t \\asymp \\varepsilon$ 是不够的。在这种情况下，偏差误差 $O(\\varepsilon)$ 将主导目标 $O(\\eta)$。\n    -   选择 $\\tau \\asymp \\varepsilon \\log(1/\\eta)$ 只控制了混合偏差。如选项 B 的分析所示，这个选择太小，无法控制统计噪声，后者将为 $O(\\sqrt{\\eta/\\log(1/\\eta)})$，而不是 $O(\\eta)$。声称方差“自动变为 $O(\\eta)$”是错误的。\n    -   **结论：不正确。**\n\n-   **D. 选择 $\\Delta t \\asymp \\eta^2$ 以将宏观离散化误差减小到 $O(\\eta)$ 以下，选择 $\\delta t \\asymp \\varepsilon^2$ 以进一步减小微观离散化偏差，并选择 $\\tau \\asymp \\varepsilon \\eta^{-4}$ 使得采样噪声可以忽略不计；这以更多计算为代价确保了精度，因此是平衡的。**\n    -   这些选择不是“平衡的”。它们使一些误差分量变得比必要的要小得多（例如，宏观误差 $O(\\eta^2)$，统计误差 $O(\\eta^3)$），导致比最优方法高得多的计算成本。目标是以*接近最小*的成本实现 $O(\\eta)$ 的误差，这要求将所有误差贡献平衡到同一数量级 $\\eta$。此选项代表了一种高度次优的“暴力”方法。\n    -   声称它“因此是平衡的”是一个不合逻辑的推论。以极高的计算代价过度解析误差是平衡方法的反面。\n    -   **结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "3076759"}]}