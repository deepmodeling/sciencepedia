{"hands_on_practices": [{"introduction": "对于任何动力系统，一个基本问题是其长期行为。本练习将探讨一个带有阻尼项的线性随机热方程，这是许多物理和生物系统的一个原型模型。通过使用类似于确定性偏微分方程中的谱方法，我们将推导系统能量（$L^2$ 范数的平方）的期望值如何随时间演变，并最终达到一个统计平稳态。这个练习将帮助你理解耗散和随机噪声如何相互作用，共同决定一个系统的长期统计特性。[@problem_id:2998289]", "problem": "考虑线性随机偏微分方程（SPDE）\n$$\n\\partial_{t} u(t,x) \\;=\\; \\nu\\,\\Delta u(t,x) \\;-\\; \\alpha\\,u(t,x) \\;+\\; \\xi(t,x), \\quad x\\in D,\\; t\\ge 0,\n$$\n该方程在有界光滑域 $D\\subset\\mathbb{R}^{d}$ 上具有齐次Dirichlet边界条件，初始条件为 $u(0,\\cdot)=u_{0}\\in L^{2}(D)$。其中，$\\nu0$ 和 $\\alpha\\ge 0$ 是固定常数，$\\Delta$ 是拉普拉斯算子，其定义域为 $H^{2}(D)\\cap H_{0}^{1}(D)$，而 $\\xi$ 是一个中心化高斯噪声，在时间上是白噪声，在空间上是有色噪声，表示为 $\\xi(t,\\cdot)=Q^{1/2}\\dot{W}(t)$。这里，$W(t)$ 是希尔伯特空间 $L^{2}(D)$ 上的柱状维纳过程，$Q:L^{2}(D)\\to L^{2}(D)$ 是一个有界、自伴、非负的协方差算子。假设 $Q$ 与 $-\\Delta$ 可交换，因此存在 $L^{2}(D)$ 的一个由共同特征函数组成的正交归一基 $\\{e_{k}\\}_{k\\ge 1}$，满足\n$$\n-\\Delta e_{k} \\;=\\; \\mu_{k}\\,e_{k}, \\quad \\mu_{k}0,\\qquad\nQ e_{k} \\;=\\; q_{k}\\,e_{k}, \\quad q_{k}\\ge 0,\n$$\n并定义生成元 $A:=\\nu\\,\\Delta-\\alpha I$，因此有 $A e_{k}=(-\\nu\\mu_{k}-\\alpha)e_{k}$。令 $\\|\\cdot\\|_{L^{2}}$ 表示 $L^{2}(D)$ 上的范数，$\\mathbb{E}$ 表示关于噪声的期望。\n\n从线性SPDE的温和解和希尔伯特空间中随机积分的Itô等距定理的基本定义出发，推导当 $t\\to\\infty$ 时 $\\mathbb{E}\\|u(t)\\|_{L^{2}}^{2}$ 的渐近行为。特别地，确定一个用 $\\{\\mu_{k}\\}$、$\\{q_{k}\\}$、$\\nu$ 和 $\\alpha$ 表示的条件，该条件确保存在一个具有有限二阶矩的、取值于 $L^{2}(D)$ 的平稳解，并将极限\n$$\n\\lim_{t\\to\\infty}\\mathbb{E}\\|u(t)\\|_{L^{2}}^{2}\n$$\n表示为关于这些量的单个解析表达式。你的最终答案必须是这个极限表达式。不需要四舍五入。", "solution": "所述问题是有效的。这是一个在随机偏微分方程领域中适定且具有科学依据的问题。所有提供的信息都是自洽和一致的。\n\n我们首先在一个抽象的框架下表述该问题。令 $H = L^{2}(D)$ 为定义在域 $D$ 上的平方可积函数的希尔伯特空间。给定的随机偏微分方程（SPDE）可以写成 $H$ 中的一个抽象随机演化方程：\n$$\ndu(t) = A u(t) dt + Q^{1/2} dW(t), \\quad u(0) = u_{0}\n$$\n其中，$u(t)$ 是一个从 $[0, \\infty)$ 到 $H$ 的函数，代表解 $u(t,\\cdot)$，$u_0 \\in H$ 是初始条件，$W(t)$ 是 $H$ 上的一个柱状维纳过程。算子 $A$ 定义为 $A = \\nu\\Delta - \\alpha I$，其中 $I$ 是单位算子。$A$ 的定义域与拉普拉斯算子 $\\Delta$ 的定义域相同，即 $D(A) = H^{2}(D)\\cap H_{0}^{1}(D)$。算子 $A$ 是 $H$ 上一个强连续解析半群 $S(t) = e^{tA}$ 的生成元。\n\n这个抽象SPDE的温和解由常数变易公式给出：\n$$\nu(t) = S(t)u_{0} + \\int_{0}^{t} S(t-s) Q^{1/2} dW(s).\n$$\n我们希望计算二阶矩 $\\mathbb{E}\\|u(t)\\|_{L^{2}}^{2}$ 的长时间行为。我们用 $\\|\\cdot\\|$ 表示 $H=L^{2}(D)$ 上的范数。取温和解的范数平方，我们得到：\n$$\n\\|u(t)\\|^{2} = \\left\\| S(t)u_{0} + \\int_{0}^{t} S(t-s) Q^{1/2} dW(s) \\right\\|^{2} = \\|S(t)u_{0}\\|^{2} + 2\\left\\langle S(t)u_{0}, \\int_{0}^{t} S(t-s) Q^{1/2} dW(s) \\right\\rangle + \\left\\| \\int_{0}^{t} S(t-s) Q^{1/2} dW(s) \\right\\|^{2}.\n$$\n现在我们取期望 $\\mathbb{E}$。初始条件 $u_{0}$ 是确定性的。随机积分项是一个Itô积分，它是一个期望为零的鞅。因此，交叉项的期望为零：\n$$\n\\mathbb{E}\\left[ 2\\left\\langle S(t)u_{0}, \\int_{0}^{t} S(t-s) Q^{1/2} dW(s) \\right\\rangle \\right] = 2\\left\\langle S(t)u_{0}, \\mathbb{E}\\left[\\int_{0}^{t} S(t-s) Q^{1/2} dW(s)\\right] \\right\\rangle = 0.\n$$\n这样我们就剩下：\n$$\n\\mathbb{E}\\|u(t)\\|^{2} = \\|S(t)u_{0}\\|^{2} + \\mathbb{E}\\left\\| \\int_{0}^{t} S(t-s) Q^{1/2} dW(s) \\right\\|^{2}.\n$$\n我们利用给定的谱分解分别分析每一项。我们有 $H$ 的一个正交归一基 $\\{e_{k}\\}_{k\\ge 1}$ 以及特征值序列 $\\{\\mu_{k}\\}_{k\\ge 1}$ 和 $\\{q_{k}\\}_{k\\ge 1}$，满足 $-\\Delta e_{k} = \\mu_{k}e_{k}$ 和 $Qe_{k} = q_{k}e_{k}$。算子 $A$ 在这个基上的作用为：\n$$\nA e_{k} = (\\nu\\Delta - \\alpha I)e_{k} = -\\nu\\mu_{k}e_{k} - \\alpha e_{k} = -(\\nu\\mu_{k} + \\alpha)e_{k}.\n$$\n我们定义 $\\lambda_{k} := \\nu\\mu_{k} + \\alpha$。由于 $\\nu  0$，对于所有 $k \\ge 1$ 都有 $\\mu_{k}  0$（因为在有界域上的Dirichlet边界条件），并且 $\\alpha \\ge 0$，所以对于所有 $k$ 都有 $\\lambda_{k}  0$。半群作用在基函数上为 $S(t)e_{k} = e^{tA}e_{k} = e^{-t\\lambda_{k}}e_{k}$。\n\n对于第一项，我们在特征基上展开 $u_{0}$：$u_{0} = \\sum_{k=1}^{\\infty} c_{k} e_{k}$，其中 $c_{k} = \\langle u_{0}, e_{k} \\rangle$。然后\n$$\nS(t)u_{0} = \\sum_{k=1}^{\\infty} c_{k} S(t)e_{k} = \\sum_{k=1}^{\\infty} c_{k} e^{-t\\lambda_{k}} e_{k}.\n$$\n根据Parseval恒等式，其范数平方为：\n$$\n\\|S(t)u_{0}\\|^{2} = \\sum_{k=1}^{\\infty} |c_{k}|^{2} e^{-2t\\lambda_{k}}.\n$$\n当 $t \\to \\infty$ 时，由于所有的 $\\lambda_{k}  0$，每一项 $e^{-2t\\lambda_{k}}$ 都收敛到 $0$。该级数由 $\\sum_{k=1}^{\\infty} |c_{k}|^{2} = \\|u_{0}\\|^{2}  \\infty$ 控制。根据级数的控制收敛定理，和的极限等于极限的和，即为 $0$。\n$$\n\\lim_{t\\to\\infty} \\|S(t)u_{0}\\|^{2} = 0.\n$$\n对于第二项，我们应用希尔伯特空间值随机积分的Itô等距定理：\n$$\n\\mathbb{E}\\left\\| \\int_{0}^{t} S(t-s) Q^{1/2} dW(s) \\right\\|^{2} = \\int_{0}^{t} \\text{Tr}\\left( \\left(S(t-s)Q^{1/2}\\right) \\left(S(t-s)Q^{1/2}\\right)^{*} \\right) ds.\n$$\n算子 $A$ 是自伴的，因此对于 $\\tau \\ge 0$，$S(\\tau)=e^{\\tau A}$ 也是自伴的。算子 $Q$ 是自伴的，所以它的平方根 $Q^{1/2}$ 也是自伴的。算子 $A$ 和 $Q$ 可交换，这意味着 $S(\\tau)$ 和 $Q$（以及 $Q^{1/2}$）也可交换。因此，迹中的算子变为：\n$$\nS(t-s)Q^{1/2} (Q^{1/2})^{*} S(t-s)^{*} = S(t-s)Q S(t-s) = S(t-s)^{2} Q = S(2(t-s))Q.\n$$\n使用基 $\\{e_{k}\\}$ 计算迹：\n$$\n\\text{Tr}(S(2(t-s))Q) = \\sum_{k=1}^{\\infty} \\langle S(2(t-s))Q e_{k}, e_{k} \\rangle = \\sum_{k=1}^{\\infty} \\langle q_{k} e^{-2(t-s)\\lambda_{k}} e_{k}, e_{k} \\rangle = \\sum_{k=1}^{\\infty} q_{k} e^{-2(t-s)\\lambda_{k}}.\n$$\n将此代入积分，并应用Fubini-Tonelli定理交换求和与积分（由于所有项都是非负的，这是合理的）：\n$$\n\\mathbb{E}\\left\\| \\int_{0}^{t} S(t-s) Q^{1/2} dW(s) \\right\\|^{2} = \\int_{0}^{t} \\sum_{k=1}^{\\infty} q_{k} e^{-2(t-s)\\lambda_{k}} ds = \\sum_{k=1}^{\\infty} q_{k} \\int_{0}^{t} e^{-2(t-s)\\lambda_{k}} ds.\n$$\n对每个 $k$ 的积分为：\n$$\n\\int_{0}^{t} e^{-2(t-s)\\lambda_{k}} ds = \\left[ \\frac{e^{-2(t-s)\\lambda_{k}}}{2\\lambda_{k}} \\right]_{s=0}^{s=t} = \\frac{1 - e^{-2t\\lambda_{k}}}{2\\lambda_{k}}.\n$$\n所以，我们有：\n$$\n\\mathbb{E}\\|u(t)\\|^{2} = \\sum_{k=1}^{\\infty} |c_{k}|^{2} e^{-2t\\lambda_{k}} + \\sum_{k=1}^{\\infty} \\frac{q_{k}(1-e^{-2t\\lambda_{k}})}{2\\lambda_{k}}.\n$$\n现在，我们取 $t\\to\\infty$ 时的极限。如前所述，第一个和收敛到 $0$。对于第二个和，我们考虑每一项的极限：\n$$\n\\lim_{t\\to\\infty} \\frac{q_{k}(1-e^{-2t\\lambda_{k}})}{2\\lambda_{k}} = \\frac{q_{k}}{2\\lambda_{k}}.\n$$\n存在一个具有有限二阶矩、取值于 $L^{2}(D)$ 的平稳解，等价于平稳分布的协方差是一个迹类算子。平稳分布的二阶矩恰好是 $\\mathbb{E}\\|u(t)\\|^{2}$ 在 $t\\to\\infty$ 时的极限。这个极限是有限的当且仅当极限项构成的级数收敛。因此，条件是：\n$$\n\\sum_{k=1}^{\\infty} \\frac{q_{k}}{2\\lambda_{k}}  \\infty \\quad \\Longleftrightarrow \\quad \\sum_{k=1}^{\\infty} \\frac{q_{k}}{2(\\nu\\mu_{k} + \\alpha)}  \\infty.\n$$\n在此条件下，我们可以应用级数的单调收敛定理（因为每一项对 $t$ 都是非负且非减的）来交换极限和求和：\n$$\n\\lim_{t\\to\\infty} \\sum_{k=1}^{\\infty} \\frac{q_{k}(1-e^{-2t\\lambda_{k}})}{2\\lambda_{k}} = \\sum_{k=1}^{\\infty} \\lim_{t\\to\\infty} \\frac{q_{k}(1-e^{-2t\\lambda_{k}})}{2\\lambda_{k}} = \\sum_{k=1}^{\\infty} \\frac{q_{k}}{2\\lambda_{k}}.\n$$\n综合所有结果，二阶矩的渐近行为是：\n$$\n\\lim_{t\\to\\infty} \\mathbb{E}\\|u(t)\\|_{L^{2}}^{2} = 0 + \\sum_{k=1}^{\\infty} \\frac{q_{k}}{2\\lambda_{k}} = \\sum_{k=1}^{\\infty} \\frac{q_{k}}{2(\\nu\\mu_{k} + \\alpha)}.\n$$\n这个和表示平稳解的方差，该平稳解是一个中心化高斯过程。", "answer": "$$\n\\boxed{\\sum_{k=1}^{\\infty} \\frac{q_{k}}{2(\\nu\\mu_{k} + \\alpha)}}\n$$", "id": "2998289"}, {"introduction": "非线性在现实世界中无处不在，而随机Burgers方程是研究随机非线性现象（如随机激波）的一个经典模型。在确定性物理学中，守恒律（如质量或动量守恒）至关重要。本练习旨在探讨一个这样的量——解的空间平均值——在不同类型的随机强迫下如何演变。通过这个练习，你将学会如何区分那些仅在空间上重新分布物理量和那些真正改变其总量均值的随机项，从而加深对随机系统守恒律的理解。[@problem_id:2998293]", "problem": "考虑周期性环面 $\\mathbb{T}_{2\\pi} = \\mathbb{R}/(2\\pi \\mathbb{Z})$ 上的一维随机 Burgers 方程，其空间坐标为 $x \\in [0,2\\pi)$:\n$$\n\\mathrm{d}u(t,x) \\;=\\; \\Big(\\nu\\,\\partial_{xx} u(t,x) \\;-\\; \\tfrac{1}{2}\\,\\partial_{x}\\big(u(t,x)^{2}\\big)\\Big)\\,\\mathrm{d}t \\;+\\; \\sigma\\,\\mathrm{d}\\beta_{0}(t) \\;+\\; \\gamma\\,\\partial_{x}u(t,x)\\,\\circ \\mathrm{d}\\beta_{1}(t),\n$$\n其中 $x$ 方向满足周期性边界条件，$\\nu0$、$\\sigma\\in\\mathbb{R}$ 和 $\\gamma\\in\\mathbb{R}$ 为固定常数，$\\beta_{0}$ 和 $\\beta_{1}$ 是相互独立标准布朗运动。符号 $\\circ$ 表示斯特拉托诺维奇（Stratonovich）随机积分。假设 $u$ 足够正则，以至于所有空间分部积分和随机微积分操作都是合理的。\n\n定义 $u$ 的空间平均（均值）为\n$$\n\\bar{u}(t) \\;=\\; \\frac{1}{2\\pi}\\int_{0}^{2\\pi} u(t,x)\\,\\mathrm{d}x.\n$$\n\n仅从空间平均、周期性边界条件以及随机微分方程的伊藤-斯特拉托诺维奇（Itō–Stratonovich）转换法则的定义出发，推导控制 $\\bar{u}(t)$ 时间演化的随机微分方程，并显式求解。在您的推导中，请仔细区分确定性守恒贡献与随机贡献，并论证空间平均是守恒的还是经历随机漂移。请以一个关于 $\\bar{u}(0)$、$\\sigma$、$\\gamma$ 及驱动布朗运动的单一闭式解析表达式作为您的最终结果。无需进行数值计算，也无需四舍五入。最终答案请勿包含单位。", "solution": "所述问题具有科学依据，是适定的、客观的，并包含唯一数学推导所需的所有必要信息。因此，我们开始求解。\n\n目标是推导并求解解 $u(t,x)$ 的空间平均的随机微分方程（SDE），其定义为\n$$\n\\bar{u}(t) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} u(t,x)\\,\\mathrm{d}x.\n$$\n$u(t,x)$ 的演化由周期性环面 $\\mathbb{T}_{2\\pi}$ 上的一维随机 Burgers 方程控制：\n$$\n\\mathrm{d}u(t,x) = \\left(\\nu\\,\\partial_{xx} u(t,x) - \\tfrac{1}{2}\\,\\partial_{x}\\big(u(t,x)^{2}\\big)\\right)\\mathrm{d}t + \\sigma\\,\\mathrm{d}\\beta_{0}(t) + \\gamma\\,\\partial_{x}u(t,x)\\,\\circ \\mathrm{d}\\beta_{1}(t).\n$$\n问题假设解 $u(t,x)$ 足够正则，这允许微分、空间积分和随机微分的顺序交换。我们可以通过将 $u(t,x)$ 的随机偏微分方程（SPDE）在空间域 $x \\in [0, 2\\pi)$ 上积分，然后除以区域长度 $2\\pi$，来找到 $\\bar{u}(t)$ 的随机微分方程（SDE）。\n$$\n\\mathrm{d}\\bar{u}(t) = \\mathrm{d}\\left(\\frac{1}{2\\pi}\\int_{0}^{2\\pi} u(t,x)\\,\\mathrm{d}x\\right) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\mathrm{d}u(t,x)\\,\\mathrm{d}x.\n$$\n代入 $\\mathrm{d}u(t,x)$ 的表达式，我们得到：\n$$\n\\mathrm{d}\\bar{u}(t) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\left[ \\left(\\nu\\,\\partial_{xx} u - \\tfrac{1}{2}\\,\\partial_{x}(u^{2})\\right)\\mathrm{d}t + \\sigma\\,\\mathrm{d}\\beta_{0}(t) + \\gamma\\,\\partial_{x}u\\,\\circ \\mathrm{d}\\beta_{1}(t) \\right] \\mathrm{d}x.\n$$\n我们分析积分后每一项的贡献。\n\n1.  **确定性守恒贡献**：随机偏微分方程的漂移部分包含两项，$\\nu\\,\\partial_{xx} u$ 和 $-\\tfrac{1}{2}\\,\\partial_{x}(u^2)$。两者都可以表示为某个通量的空间导数。\n    *   扩散项的积分为：\n        $$\n        \\int_{0}^{2\\pi} \\nu\\,\\partial_{xx} u(t,x)\\,\\mathrm{d}x = \\nu \\int_{0}^{2\\pi} \\frac{\\partial}{\\partial x}\\left(\\partial_{x} u(t,x)\\right)\\,\\mathrm{d}x = \\nu \\left[ \\partial_{x} u(t,x) \\right]_{x=0}^{x=2\\pi}.\n        $$\n        由于在 $\\mathbb{T}_{2\\pi}$ 上的周期性边界条件，函数 $u(t,x)$ 及其空间导数在 $x=0$ 和 $x=2\\pi$ 处必须具有相同的值。因此，$\\partial_{x} u(t, 2\\pi) = \\partial_{x} u(t, 0)$，该积分为 $0$。\n    *   非线性平流项的积分为：\n        $$\n        \\int_{0}^{2\\pi} -\\tfrac{1}{2}\\,\\partial_{x}\\big(u(t,x)^{2}\\big)\\,\\mathrm{d}x = -\\frac{1}{2} \\left[ u(t,x)^{2} \\right]_{x=0}^{x=2\\pi}.\n        $$\n        同样，周期性要求 $u(t, 2\\pi) = u(t, 0)$，所以该积分也为 $0$。\n    这些项是守恒的；它们在空间域上重新分布 $u$，但不改变其总积分。因此，它们对空间平均 $\\bar{u}(t)$ 的时间演化没有贡献。\n\n2.  **随机贡献**：有两个随机项。\n    *   第一项是加性的、空间均匀的噪声项 $\\sigma\\,\\mathrm{d}\\beta_{0}(t)$。其积分为：\n        $$\n        \\int_{0}^{2\\pi} \\sigma\\,\\mathrm{d}\\beta_{0}(t)\\,\\mathrm{d}x = \\sigma\\,\\mathrm{d}\\beta_{0}(t) \\int_{0}^{2\\pi} 1\\,\\mathrm{d}x = 2\\pi\\sigma\\,\\mathrm{d}\\beta_{0}(t).\n        $$\n        这是一个伊当（Itō）微分。它对 $\\mathrm{d}\\bar{u}(t)$ 有非零贡献。\n    *   第二项是涉及斯特拉托诺维奇（Stratonovich）积分的乘性噪声项 $\\gamma\\,\\partial_{x}u(t,x)\\,\\circ \\mathrm{d}\\beta_{1}(t)$。斯特拉托诺维奇积分的关键性质是它们遵循经典微积分的法则。交换空间积分和随机积分的顺序得到：\n        $$\n        \\int_{0}^{2\\pi} \\gamma\\,\\partial_{x}u(t,x)\\,\\circ \\mathrm{d}\\beta_{1}(t)\\,\\mathrm{d}x = \\left(\\gamma \\int_{0}^{2\\pi} \\partial_{x}u(t,x)\\,\\mathrm{d}x \\right) \\circ \\mathrm{d}\\beta_{1}(t).\n        $$\n        由于周期性，空间积分为 $\\int_{0}^{2\\pi} \\partial_{x}u(t,x)\\,\\mathrm{d}x = [u(t,x)]_{x=0}^{x=2\\pi} = u(t, 2\\pi) - u(t, 0) = 0$。因此，整个项为 $0 \\circ \\mathrm{d}\\beta_{1}(t) = 0$。\n\n        为了按要求明确使用伊藤-斯特拉托诺维奇转换法则，我们将斯特拉托诺维奇项转换为其等价的伊当形式。法则是 $G(u) \\circ \\mathrm{d}\\beta = G(u)\\,\\mathrm{d}\\beta + \\frac{1}{2}\\langle \\mathrm{d}G(u), \\mathrm{d}\\beta \\rangle$。这里，$G(u) = \\gamma\\,\\partial_{x}u$，噪声为 $\\beta_{1}$。二次协变项需要找到 $\\mathrm{d}G(u)$ 中与 $\\mathrm{d}\\beta_{1}$ 成正比的部分。\n        $\\mathrm{d}G(u) = \\mathrm{d}(\\gamma\\,\\partial_{x}u) = \\gamma\\,\\partial_{x}(\\mathrm{d}u)$。$\\mathrm{d}u$ 中与 $\\circ\\mathrm{d}\\beta_{1}$ 成正比的部分是 $\\gamma\\,\\partial_{x}u\\,\\circ \\mathrm{d}\\beta_{1}$。因此，$\\mathrm{d}G(u)$ 的相关部分是 $\\gamma\\,\\partial_{x}(\\gamma\\,\\partial_{x}u\\,\\circ \\mathrm{d}\\beta_{1}) = \\gamma^2\\,\\partial_{xx}u\\,\\circ \\mathrm{d}\\beta_{1}$。为了计算伊当修正项，我们只需要随机微分的系数，即 $\\gamma^2\\,\\partial_{xx}u$。\n        伊当修正（或漂移）项为 $\\frac{1}{2}(\\gamma^2\\,\\partial_{xx}u)\\,\\mathrm{d}t$。\n        因此，转换公式为：\n        $$\n        \\gamma\\,\\partial_{x}u\\,\\circ \\mathrm{d}\\beta_{1}(t) = \\gamma\\,\\partial_{x}u\\,\\mathrm{d}\\beta_{1}(t) + \\frac{1}{2}\\gamma^{2}\\,\\partial_{xx}u\\,\\mathrm{d}t.\n        $$\n        现在，我们将这两个伊当项在 $[0, 2\\pi)$ 上积分：\n        $$\n        \\int_{0}^{2\\pi} \\gamma\\,\\partial_{x}u\\,\\mathrm{d}\\beta_{1}(t)\\,\\mathrm{d}x = \\left(\\gamma\\int_{0}^{2\\pi} \\partial_{x}u\\,\\mathrm{d}x\\right)\\mathrm{d}\\beta_{1}(t) = \\gamma[u]_{0}^{2\\pi}\\,\\mathrm{d}\\beta_{1}(t) = 0.\n        $$\n        $$\n        \\int_{0}^{2\\pi} \\frac{1}{2}\\gamma^{2}\\,\\partial_{xx}u\\,\\mathrm{d}t\\,\\mathrm{d}x = \\left(\\frac{1}{2}\\gamma^{2}\\int_{0}^{2\\pi} \\partial_{xx}u\\,\\mathrm{d}x\\right)\\mathrm{d}t = \\frac{1}{2}\\gamma^{2}[\\partial_{x}u]_{0}^{2\\pi}\\,\\mathrm{d}t = 0.\n        $$\n        转换后项的两个部分积分都为零。这证实了乘性噪声项对空间平均演化的贡献为零。空间平均不守恒，但其不守恒性并非由含 $\\nu$ 或 $\\gamma$ 的项引起。它经历的随机演化纯粹由空间均匀的强迫项驱动。\n\n3.  **SDE的组装与求解**：\n    合并所有积分项的结果并除以 $2\\pi$：\n    $$\n    \\mathrm{d}\\bar{u}(t) = \\frac{1}{2\\pi} \\left[ (0 + 0)\\,\\mathrm{d}t + 2\\pi\\sigma\\,\\mathrm{d}\\beta_{0}(t) + 0 \\right] = \\sigma\\,\\mathrm{d}\\beta_{0}(t).\n    $$\n    这就是控制 $\\bar{u}(t)$ 时间演化的随机微分方程。为了找到显式解，我们从时间 $0$ 到 $t$ 进行积分：\n    $$\n    \\int_{0}^{t} \\mathrm{d}\\bar{u}(s) = \\int_{0}^{t} \\sigma\\,\\mathrm{d}\\beta_{0}(s).\n    $$\n    这得到：\n    $$\n    \\bar{u}(t) - \\bar{u}(0) = \\sigma \\left( \\beta_{0}(t) - \\beta_{0}(0) \\right).\n    $$\n    按照惯例，标准布朗运动从零开始，即 $\\beta_{0}(0) = 0$。因此，空间平均的显式解为：\n    $$\n    \\bar{u}(t) = \\bar{u}(0) + \\sigma\\beta_{0}(t).\n    $$", "answer": "$$\n\\boxed{\\bar{u}(0) + \\sigma \\beta_{0}(t)}\n$$", "id": "2998293"}, {"introduction": "对于大多数复杂的随机偏微分方程，我们无法找到解析解，因此必须依赖数值模拟。本练习将带你亲手实践一种强大的数值方法——谱Galerkin方法，将其应用于随机热方程。你不仅需要将无穷维的SPDE降维为一组有限维的随机常微分方程（SDE），还将进一步分析常用的Euler-Maruyama时间离散格式所引入的误差。通过推导并编程计算精确解与数值解之间期望范数的差异，你将获得连接理论分析与计算实践的宝贵经验。[@problem_id:3078121]", "problem": "考虑随机热方程，这是一个典型的随机偏微分方程（SPDE），定义在空间区间 $\\left(0,1\\right)$ 上，具有齐次狄利克雷边界条件和零初始条件。状态变量 $u\\left(x,t\\right)$ 满足\n$$\n\\mathrm{d}u\\left(x,t\\right) = \\nu\\,\\partial_{xx}u\\left(x,t\\right)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W\\left(x,t\\right),\n$$\n其中 $\\nu0$ 是扩散系数，$\\sigma\\ge 0$ 是噪声强度，$W\\left(x,t\\right)$ 是一个在 $L^2\\left(0,1\\right)$ 上的柱形维纳过程，它在时间上是白噪声，并且在空间上关于标准正交拉普拉斯特征系统是齐次的。边界条件为 $u\\left(0,t\\right)=0$ 和 $u\\left(1,t\\right)=0$，初始条件为 $u\\left(x,0\\right)=0$。\n\n谱伽辽金方法通过在 $\\left(0,1\\right)$ 上具有狄利克雷边界条件的前 $N$ 个拉普拉斯特征函数的截断级数来近似 $u\\left(x,t\\right)$，其中特征函数取为标准正交族 $\\left\\{e_k\\right\\}_{k=1}^N$，且相应的特征值为严格正值。设截断近似写为\n$$\nu_N\\left(x,t\\right) = \\sum_{k=1}^N a_k\\left(t\\right)\\,e_k\\left(x\\right),\n$$\n且系数过程 $\\left\\{a_k\\left(t\\right)\\right\\}_{k=1}^N$ 满足一个随机微分方程组（SDEs），该方程组是通过将SPDE投影到 $\\left\\{e_k\\right\\}_{k=1}^N$ 的生成空间上得到的。\n\n你的任务是：\n- 从 $\\left(0,1\\right)$ 上具有狄利克雷边界条件的拉普拉斯特征函数的定义、它们在 $L^2\\left(0,1\\right)$ 中的标准正交性、柱形维纳过程的性质以及线性SDE的伊藤积分出发，推导出计算在最终时刻 $T$ 的期望$L^2$范数平方 $\\mathbb{E}\\left[\\left\\|u_N\\left(\\cdot,T\\right)\\right\\|_{L^2\\left(0,1\\right)}^2\\right]$ 所需的闭式表达式，针对以下两种情况：\n  1. 精确的谱伽辽金系统（即，针对零初始条件精确求解的连续时间系数SDEs）。\n  2. 使用前向欧拉-丸山方法对系数SDEs进行时间步进离散化，其中时间步长为均匀的 $h0$，$T$ 是 $h$ 的整数倍。\n\n- 将两个结果都纯粹用参数 $\\nu$、$\\sigma$、$N$、$T$、$h$ 以及与 $\\left(0,1\\right)$ 上的基 $\\left\\{e_k\\right\\}_{k=1}^N$ 相关联的拉普拉斯特征值来表示。\n\n- 实现一个程序，对于下面的每个测试用例，计算在时刻 $T$，$u_N\\left(x,T\\right)$ 的精确谱伽辽金期望与前向欧拉-丸山期望之间的绝对差：\n  $$\n  \\left|\\ \\mathbb{E}\\left[\\left\\|u_N\\left(\\cdot,T\\right)\\right\\|_{L^2\\left(0,1\\right)}^2\\right]_{\\text{exact}} \\;-\\; \\mathbb{E}\\left[\\left\\|u_N\\left(\\cdot,T\\right)\\right\\|_{L^2\\left(0,1\\right)}^2\\right]_{\\text{Euler}}\\ \\right|.\n  $$\n\n你的程序不能执行任何蒙特卡洛采样，必须依赖于你推导出的闭式表达式。使用标准的双精度算术。此问题不涉及角度和物理单位。\n\n使用以下测试套件，其设计旨在探究典型情况、最小模态截断、近稳定步长以及退化场景：\n- 情况 1：$\\nu=0.1$, $\\sigma=1.0$, $N=5$, $T=1.0$, $h=0.001$。\n- 情况 2：$\\nu=0.1$, $\\sigma=1.0$, $N=1$, $T=2.0$, $h=0.4$。\n- 情况 3：$\\nu=0.1$, $\\sigma=0.8$, $N=8$, $T=0.5$, $h=0.03125$。\n- 情况 4：$\\nu=0.5$, $\\sigma=0.0$, $N=3$, $T=1.0$, $h=0.1$。\n- 情况 5：$\\nu=0.1, \\sigma=1.0, N=4, T=0.0, h=0.1$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5\\right]$），其中每个 $\\text{result}_i$ 是情况 $i$ 的绝对差，表示为浮点数。确保在每个情况中 $T/h$ 都是整数，以保证时间步数是明确定义的。", "solution": "经评估，用户提供的问题是有效的，因为它具有科学依据、是适定的、客观的且内部一致。它提出了随机偏微分方程（SPDEs）数值分析中的一个标准的、非平凡的任务。因此，我们可以进行完整解答。\n\n该问题要求推导并计算随机热方程的谱伽辽金近似的精确期望$L^2$范数平方与其前向欧拉-丸山时间离散化所得结果之间的差异。\n\n### 1. 特征基与SDE系统推导\n第一步是为谱方法建立特征基。我们考虑在空间域 $\\left(0,1\\right)$ 上带有齐次狄利克雷边界条件 $e(0)=e(1)=0$ 的负拉普拉斯算子 $-\\partial_{xx}$ 的特征值问题：\n$$-\\partial_{xx}e_k(x) = \\lambda_k e_k(x)$$\n对于整数 $k \\ge 1$，严格正的特征值为 $\\lambda_k = (k\\pi)^2$。相应的特征函数在 $L^2\\left(0,1\\right)$ 中归一化后形成一个标准正交基，它们是：\n$$e_k(x) = \\sqrt{2}\\sin(k\\pi x)$$\n标准正交性条件为 $\\int_0^1 e_k(x)e_j(x)\\,\\mathrm{d}x = \\delta_{kj}$，其中 $\\delta_{kj}$ 是克罗内克δ函数。\n\n接下来，我们将SPDE投影到这个基上。伽辽金近似为 $u_N(x,t) = \\sum_{k=1}^N a_k(t)e_k(x)$。将其代入SPDE，\n$$\n\\sum_{k=1}^N \\mathrm{d}a_k(t)\\,e_k(x) = \\nu\\,\\partial_{xx}\\left(\\sum_{k=1}^N a_k(t)e_k(x)\\right)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W(x,t)\n$$\n我们对每个 $j \\in \\{1,\\dots,N\\}$ 取 $L^2$ 内积 $\\langle\\cdot, e_j(x)\\rangle = \\int_0^1 \\cdot \\,e_j(x)\\,\\mathrm{d}x$。\n利用 $\\{e_k\\}$ 的标准正交性和特征值属性 $\\partial_{xx}e_k = -\\lambda_k e_k$，投影产生一个关于模态系数 $a_j(t)$ 的解耦随机微分方程组（SDEs）：\n- 左侧：$\\left\\langle \\sum_{k=1}^N \\mathrm{d}a_k(t)\\,e_k(x), e_j(x) \\right\\rangle = \\sum_{k=1}^N \\mathrm{d}a_k(t)\\,\\delta_{kj} = \\mathrm{d}a_j(t)$。\n- 漂移项：$\\left\\langle \\nu\\,\\partial_{xx}\\left(\\sum_{k=1}^N a_k(t)e_k(x)\\right), e_j(x) \\right\\rangle\\,\\mathrm{d}t = \\nu \\sum_{k=1}^N a_k(t)\\langle -\\lambda_k e_k, e_j \\rangle\\,\\mathrm{d}t = -\\nu \\lambda_j a_j(t)\\,\\mathrm{d}t$。\n- 扩散项：$\\sigma\\langle \\mathrm{d}W(x,t), e_j(x) \\rangle = \\sigma\\,\\mathrm{d}W_j(t)$。这里，$\\mathrm{d}W_j(t)$ 是独立的、标准的、一维维纳过程的增量，这是因为噪声 $W(x,t)$ 是一个柱形维纳过程，其协方差结构与拉普拉斯特征系统对齐。\n\n对于 $j=1, \\dots, N$，得到的SDE系统由独立的奥恩斯坦-乌伦贝克过程组成：\n$$\n\\mathrm{d}a_j(t) = -\\nu\\lambda_j a_j(t)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_j(t)\n$$\n初始条件 $u(x,0)=0$ 意味着对所有 $j$ 都有 $a_j(0)=0$。\n\n### 2. 精确期望$L^2$范数平方\n对于 $a_j(0)=0$ 的 $a_j(t)$ 的SDE精确解由伊藤积分给出：\n$$\na_j(t) = \\sigma \\int_0^t e^{-\\nu\\lambda_j(t-s)}\\,\\mathrm{d}W_j(s)\n$$\n这是一个均值为零的高斯过程，$\\mathbb{E}[a_j(t)]=0$。方差通过伊藤等距性求得：\n$$\n\\mathbb{E}[a_j(t)^2] = \\sigma^2 \\int_0^t \\left(e^{-\\nu\\lambda_j(t-s)}\\right)^2\\,\\mathrm{d}s = \\sigma^2 \\int_0^t e^{-2\\nu\\lambda_j(t-s)}\\,\\mathrm{d}s\n$$\n计算该积分得到：\n$$\n\\mathbb{E}[a_j(t)^2] = \\sigma^2 \\left[ \\frac{1}{2\\nu\\lambda_j}e^{-2\\nu\\lambda_j(t-s)} \\right]_0^t = \\sigma^2 \\frac{1 - e^{-2\\nu\\lambda_j t}}{2\\nu\\lambda_j}\n$$\n根据帕塞瓦尔恒等式，近似解的$L^2$范数平方为：\n$$\n\\left\\|u_N(\\cdot,T)\\right\\|_{L^2(0,1)}^2 = \\left\\| \\sum_{k=1}^N a_k(T)e_k \\right\\|^2 = \\sum_{k=1}^N a_k(T)^2\n$$\n取期望并利用系数 $a_k(T)$ 的独立性，我们得到：\n$$\n\\mathbb{E}\\left[\\left\\|u_N(\\cdot,T)\\right\\|^2\\right]_{\\text{exact}} = \\sum_{k=1}^N \\mathbb{E}[a_k(T)^2] = \\sum_{k=1}^N \\sigma^2 \\frac{1 - e^{-2\\nu\\lambda_k T}}{2\\nu\\lambda_k}\n$$\n代入 $\\lambda_k = (k\\pi)^2$，最终表达式为：\n$$\n\\mathbb{E}\\left[\\left\\|u_N(\\cdot,T)\\right\\|^2\\right]_{\\text{exact}} = \\sum_{k=1}^N \\sigma^2 \\frac{1 - e^{-2\\nu(k\\pi)^2 T}}{2\\nu(k\\pi)^2}\n$$\n\n### 3. 欧拉-丸山期望$L^2$范数平方\n对于时间步长为 $h$ 的 $a_k(t)$ 的前向欧拉-丸山离散化由以下递推关系给出：\n$$\na_{k,n+1} = a_{k,n} - h\\nu\\lambda_k a_{k,n} + \\sigma\\sqrt{h}Z_{k,n} = (1 - h\\nu\\lambda_k)a_{k,n} + \\sigma\\sqrt{h}Z_{k,n}\n$$\n其中 $a_{k,n} \\approx a_k(nh)$，$Z_{k,n}$ 是独立的标准正态随机变量。初始条件为 $a_{k,0}=0$。\n\n令 $V_{k,n} = \\mathbb{E}[a_{k,n}^2]$。由于 $\\mathbb{E}[a_{k,n}]=0$ 且 $a_{k,n}$ 与 $Z_{k,n}$ 独立，我们有：\n$$\nV_{k,n+1} = \\mathbb{E}[((1 - h\\nu\\lambda_k)a_{k,n} + \\sigma\\sqrt{h}Z_{k,n})^2] = (1 - h\\nu\\lambda_k)^2 V_{k,n} + \\sigma^2h\n$$\n这是一个关于方差的线性递推关系。令 $C_k = (1 - h\\nu\\lambda_k)^2$。递推关系为 $V_{k,n+1} = C_k V_{k,n} + \\sigma^2h$。在 $V_{k,0}=0$ 的条件下，展开递推关系得到一个几何级数：\n$$\nV_{k,n} = \\sigma^2h \\sum_{i=0}^{n-1} C_k^i\n$$\n在最终时刻 $T$，步数为 $M=T/h$。如果 $C_k \\neq 1$，级数和为 $\\frac{1-C_k^M}{1-C_k}$。如果 $C_k = 1$，级数和为 $M$。\n在时刻 $T$ 的第 $k$ 个模态的方差是 $V_{k,M} = \\mathbb{E}[a_{k,M}^2]$。总的期望范数平方是所有模态之和：\n$$\n\\mathbb{E}\\left[\\left\\|u_N(\\cdot,T)\\right\\|^2\\right]_{\\text{Euler}} = \\sum_{k=1}^N V_{k,M} = \\sum_{k=1}^N \\left( \\sigma^2h \\sum_{i=0}^{M-1} [(1 - h\\nu(k\\pi)^2)^2]^i \\right)\n$$\n这个表达式在数值上是稳健的，将用于实现。\n\n### 4. 最终计算\n所要求的输出是每个测试用例的这两个推导出的期望之间的绝对差：\n$$\n\\text{Difference} = \\left|\\ \\mathbb{E}\\left[\\left\\|u_N\\right\\|^2\\right]_{\\text{exact}} \\;-\\; \\mathbb{E}\\left[\\left\\|u_N\\right\\|^2\\right]_{\\text{Euler}}\\ \\right|\n$$\n实现部分将计算这两个和及其差值。对于参数可能导致数值问题的情况，如 $\\sigma=0$、$T=0$ 或几何级数的公比 $C_k$ 接近1，需要特别处理。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the absolute difference between the exact and Euler-Maruyama\n    expectations of the squared L2-norm for a spectral approximation of the\n    stochastic heat equation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (nu, sigma, N, T, h)\n        (0.1, 1.0, 5, 1.0, 0.001),\n        (0.1, 1.0, 1, 2.0, 0.4),\n        (0.1, 0.8, 8, 0.5, 0.03125),\n        (0.5, 0.0, 3, 1.0, 0.1),\n        (0.1, 1.0, 4, 0.0, 0.1)\n    ]\n\n    results = []\n    for nu, sigma, N, T, h in test_cases:\n        # Handle trivial cases where the solution is deterministically zero.\n        if np.isclose(sigma, 0.0) or np.isclose(T, 0.0):\n            results.append(0.0)\n            continue\n\n        # Convert T/h to an integer number of steps.\n        # The problem statement guarantees this is an integer.\n        M = int(round(T / h))\n\n        # Vectorized calculation over modes k = 1 to N\n        k = np.arange(1, N + 1)\n        lambda_k = (k * np.pi)**2\n        \n        # --- Exact Expectation Calculation ---\n        # E[||u_N||^2] = sum_{k=1 to N} sigma^2 * (1 - exp(-2*nu*lambda_k*T)) / (2*nu*lambda_k)\n        arg = 2 * nu * lambda_k * T\n        # Use np.expm1 for better numerical precision for small arguments.\n        # 1 - exp(-x) = -expm1(-x)\n        exact_terms = sigma**2 * (-np.expm1(-arg)) / (2 * nu * lambda_k)\n        exact_exp = np.sum(exact_terms)\n        \n        # --- Euler-Maruyama Expectation Calculation ---\n        # E[a_{k,M}^2] = sigma^2 * h * sum_{i=0 to M-1} C_k^i\n        # where C_k = (1 - h*nu*lambda_k)^2\n        h_nu_lambda_k = h * nu * lambda_k\n        C_k = (1 - h_nu_lambda_k)**2\n        \n        # Calculate the sum of the geometric series for each mode k.\n        # This approach is numerically stable.\n        geom_sum = np.zeros(N, dtype=float)\n        \n        # Identify modes where C_k is close to 1, which requires special handling.\n        one_mask = np.isclose(C_k, 1.0)\n        \n        # Case 1: C_k is close to 1. The sum is simply M.\n        geom_sum[one_mask] = M\n        \n        # Case 2: C_k is not close to 1. Use the standard formula for a geometric series.\n        not_one_mask = ~one_mask\n        if np.any(not_one_mask):\n            C_k_not_one = C_k[not_one_mask]\n            geom_sum[not_one_mask] = (1 - C_k_not_one**M) / (1 - C_k_not_one)\n            \n        euler_terms = sigma**2 * h * geom_sum\n        euler_exp = np.sum(euler_terms)\n        \n        # Calculate the absolute difference and store the result.\n        results.append(abs(exact_exp - euler_exp))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3078121"}]}