{"hands_on_practices": [{"introduction": "麦克基恩-弗拉索夫随机微分方程（McKean-Vlasov SDEs）可能看起来很抽象，但一个有效的入门方法是分析其统计矩（如均值和方差）的动态演化。这个练习为一个基础的线性模型推导出这些动态方程，为你提供了一个具体的起点，让你掌握将抽象的随机微分方程转化为其矩的确定性常微分方程的核心技巧。[@problem_id:3065754]", "problem": "考虑一个McKean–Vlasov随机微分方程（SDE），其漂移项取决于状态的当前分布。设漂移项由 $b(x,\\mu)=-x+\\int y\\,\\mu(dy)$ 给出，扩散系数为一个常数 $\\sigma > 0$。设 $\\{W_t\\}_{t\\geq 0}$ 是一个标准布朗运动，初始条件 $X_0$ 的分布为 $\\mu_0$，其二阶矩有限，均值为 $m_0=\\int y\\,\\mu_0(dy)$，方差为 $v_0=\\int (y-m_0)^2\\,\\mu_0(dy)$。\n\n从McKean–Vlasov SDE的定义以及期望、布朗运动和Itô微积分的基本性质出发，完成以下任务：\n- 将得到的SDE用 $X_t$ 和 $\\mathbb{E}[X_t]$ 明确地写出来。\n- 推导均值 $m_t=\\mathbb{E}[X_t]$ 的演化方程。\n- 通过考虑中心化过程并对中心化过程的平方应用Itô公式，推导方差 $v_t=\\mathrm{Var}(X_t)$ 的演化方程。\n\n利用这些推导，确定方差的长时间极限 $\\lim_{t\\to\\infty}\\mathrm{Var}(X_t)$，将其表示为仅含 $\\sigma$ 的封闭形式符号表达式。将你的最终答案表示为单个解析表达式。无需四舍五入。", "solution": "该问题描述了一个McKean-Vlasov随机微分方程（SDE），其一般形式为 $dX_t = b(X_t, \\mu_t)dt + \\sigma(X_t, \\mu_t)dW_t$，其中 $\\mu_t$ 是状态 $X_t$ 在时间 $t$ 的概率分布（law）。\n\n给定的漂移系数为 $b(x,\\mu)=-x+\\int y\\,\\mu(dy)$。对于分布为 $\\mu_t$ 的过程 $X_t$，积分项 $\\int y\\,\\mu_t(dy)$ 是 $X_t$ 期望的定义。我们将这个随时间变化的均值记为 $m_t = \\mathbb{E}[X_t]$。\n扩散系数为一个常数 $\\sigma > 0$。\n\n首先，我们将SDE用 $X_t$ 及其期望 $\\mathbb{E}[X_t]$ 明确地写出来。将 $m_t$ 代入漂移项的表达式中，我们得到：\n$b(X_t, \\mu_t) = -X_t + \\mathbb{E}[X_t] = -X_t + m_t$。\n得到的SDE是：\n$$dX_t = (-X_t + m_t) dt + \\sigma dW_t$$\n\n接下来，我们推导均值 $m_t = \\mathbb{E}[X_t]$ 的演化方程。我们对SDE两边取期望。假设我们可以交换期望和微分算子（在SDE的标准假设下这是合理的），我们有 $d\\mathbb{E}[X_t] = \\mathbb{E}[dX_t]$。\n$$dm_t = \\mathbb{E}[(-X_t + m_t) dt + \\sigma dW_t]$$\n根据期望的线性性：\n$$dm_t = \\mathbb{E}[-X_t + m_t] dt + \\mathbb{E}[\\sigma dW_t]$$\n对于一个固定的时间 $t$，$m_t$ 是一个确定性值。因此，$\\mathbb{E}[-X_t + m_t] = -\\mathbb{E}[X_t] + \\mathbb{E}[m_t] = -m_t + m_t = 0$。随机微分项的期望 $\\mathbb{E}[\\sigma dW_t]$ 也为 $0$。\n这将 $m_t$ 的方程简化为：\n$$dm_t = 0 \\cdot dt + 0$$\n$$\\frac{dm_t}{dt} = 0$$\n这是一个常微分方程，其解为 $m_t$ 是一个常数。因此，对于所有 $t \\ge 0$，$m_t = m_0$，其中 $m_0 = \\mathbb{E}[X_0]$ 是初始均值。\n\n现在，我们推导方差 $v_t = \\mathrm{Var}(X_t)$ 的演化方程。方差定义为 $v_t = \\mathbb{E}[(X_t - m_t)^2]$。由于我们发现 $m_t = m_0$ 是一个常数，方差为 $v_t = \\mathbb{E}[(X_t - m_0)^2]$。\n我们定义一个中心化过程 $Y_t = X_t - m_0$。由于 $m_0$ 是一个常数，$Y_t$ 的微分为 $dY_t = dX_t - d(m_0) = dX_t$。\n$X_t$ 的SDE可以写为 $dX_t = (-X_t + m_0) dt + \\sigma dW_t$。我们将 $X_t = Y_t + m_0$ 代入此方程，以求得 $Y_t$ 的SDE：\n$$dY_t = (-(Y_t + m_0) + m_0) dt + \\sigma dW_t$$\n$$dY_t = -Y_t dt + \\sigma dW_t$$\n过程 $Y_t$ 是一个标准的Ornstein-Uhlenbeck过程。$X_t$ 的方差是 $v_t = \\mathbb{E}[(X_t - m_0)^2] = \\mathbb{E}[Y_t^2]$。\n为了求得 $v_t$ 的演化，我们对函数 $f(y) = y^2$ 应用Itô公式。其导数为 $f'(y) = 2y$ 和 $f''(y) = 2$。\nItô公式给出：\n$$d(Y_t^2) = f'(Y_t)dY_t + \\frac{1}{2}f''(Y_t)d\\langle Y, Y \\rangle_t$$\n$Y_t$ 的二次变分是 $d\\langle Y, Y \\rangle_t = (\\sigma)^2 dt = \\sigma^2 dt$。代入各项：\n$$d(Y_t^2) = 2Y_t(-Y_t dt + \\sigma dW_t) + \\frac{1}{2}(2)(\\sigma^2 dt)$$\n$$d(Y_t^2) = (-2Y_t^2 + \\sigma^2)dt + 2\\sigma Y_t dW_t$$\n为了求得 $v_t = \\mathbb{E}[Y_t^2]$ 的演化方程，我们对此表达式取期望：\n$$d v_t = d\\mathbb{E}[Y_t^2] = \\mathbb{E}[d(Y_t^2)]$$\n$$d v_t = \\mathbb{E}[(-2Y_t^2 + \\sigma^2)dt + 2\\sigma Y_t dW_t]$$\n$$d v_t = (-2\\mathbb{E}[Y_t^2] + \\sigma^2)dt + \\mathbb{E}[2\\sigma Y_t dW_t]$$\n注意到 $\\mathbb{E}[Y_t^2] = v_t$ 且Itô积分项的期望为零（$\\mathbb{E}[\\int_0^t 2\\sigma Y_s dW_s] = 0$），我们得到方差的常微分方程：\n$$\\frac{dv_t}{dt} = -2v_t + \\sigma^2$$\n\n最后，我们确定方差的长时间极限 $\\lim_{t\\to\\infty} v_t$。该极限（如果存在）对应于常微分方程的稳态解，此时方差为常数，即 $\\frac{dv_t}{dt} = 0$。令 $v_\\infty = \\lim_{t\\to\\infty} v_t$。在演化方程中将时间导数设为零，得到：\n$$0 = -2v_\\infty + \\sigma^2$$\n解出 $v_\\infty$ 可得：\n$$2v_\\infty = \\sigma^2$$\n$$v_\\infty = \\frac{\\sigma^2}{2}$$\n这就是方差的长时间极限，它只取决于扩散系数 $\\sigma$。该常微分方程的解为 $v_t = \\frac{\\sigma^2}{2} + (v_0 - \\frac{\\sigma^2}{2})\\exp(-2t)$，这证实了当 $t \\to \\infty$ 时，$v_t$ 收敛于此值，而与初始方差 $v_0$ 无关。", "answer": "$$\\boxed{\\frac{\\sigma^2}{2}}$$", "id": "3065754"}, {"introduction": "在推导出解析公式后，现代科学研究中的一个关键步骤是通过计算来验证它们。这项实践要求你为我们刚刚分析过的、用于近似麦克基恩-弗拉索夫随机微分方程的粒子系统，实现欧拉-丸山（Euler-Maruyama）数值格式。这个练习将帮助你连接抽象方程与可触摸的模拟结果，从而加深理解。[@problem_id:3065755]", "problem": "考虑一个由标准布朗运动 $W_t$ 驱动的过程 $X_t$ 的一维 McKean–Vlasov 随机微分方程 (SDE)，\n$$\ndX_t = b\\big(X_t,\\mu_t\\big)\\,dt + \\sigma\\big(X_t,\\mu_t\\big)\\,dW_t,\n$$\n其中 $\\mu_t$ 表示 $X_t$ 的分布，$b$ 和 $\\sigma$ 是可测函数。具有 $N$ 个粒子的平均场粒子近似将 $\\mu_t$ 替换为经验测度 $\\mu_t^N = \\frac{1}{N}\\sum_{i=1}^N \\delta_{X_t^{i,N}}$，并根据以下方程演化粒子系统 $\\{X_t^{i,N}\\}_{i=1}^N$\n$$\ndX_t^{i,N} = b\\big(X_t^{i,N},\\mu_t^N\\big)\\,dt + \\sigma\\big(X_t^{i,N},\\mu_t^N\\big)\\,dW_t^i,\n$$\n其中 $\\{W_t^i\\}_{i=1}^N$ 是独立的标准布朗运动。使用欧拉-丸山格式，在时间步长为 $\\Delta t$ 且 $K = \\lfloor T/\\Delta t \\rfloor$ 的均匀网格上的离散时间近似 $\\{X_k^{i,N}\\}_{k=0}^{K}$ 由独立的服从 $\\mathcal{N}(0,\\Delta t)$ 的正态增量 $\\Delta W_k^i$ 和以下更新规则定义\n$$\nX_{k+1}^{i,N} = X_k^{i,N} + b\\big(X_k^{i,N},\\mu_k^N\\big)\\,\\Delta t + \\sigma\\big(X_k^{i,N},\\mu_k^N\\big)\\,\\Delta W_k^i,\n$$\n其中 $\\mu_k^N = \\frac{1}{N}\\sum_{j=1}^N \\delta_{X_k^{j,N}}$。\n\n你的任务是为以下三个模型类别（每个类别由函数 $b$ 和 $\\sigma$ 指定）实现此欧拉-丸山格式，并将时间 $T$ 的经验均值和方差与解析推导的预测值进行比较：\n\n1. 中心化 Ornstein–Uhlenbeck 平均场模型：\n   - 漂移项：$b(x,\\mu) = -\\alpha\\,(x - m)$，其中 $m = \\int y\\,\\mu(dy)$。\n   - 扩散项：$\\sigma(x,\\mu) = \\beta$，一个常数。\n   - 解析预测：对于 $m_0 = \\mathbb{E}[X_0]$ 和 $s_0^2 = \\mathrm{Var}(X_0)$，均值保持为 $m_T = m_0$。定义 $Y_t = X_t - m_t$，$Y_t$ 满足一个 Ornstein–Uhlenbeck 动力学，得到\n     $$\n     \\mathrm{Var}(X_T) =\n     \\begin{cases}\n     s_0^2 e^{-2\\alpha T} + \\frac{\\beta^2}{2\\alpha}(1 - e^{-2\\alpha T}),  \\text{if } \\alpha > 0 \\\\\n     s_0^2 + \\beta^2 T,  \\text{if } \\alpha = 0\n     \\end{cases}\n     $$\n\n2. 确定性共识（无扩散）：\n   - 漂移项：$b(x,\\mu) = -\\alpha\\,(x - m)$，其中 $m = \\int y\\,\\mu(dy)$。\n   - 扩散项：$\\sigma(x,\\mu) = 0$。\n   - 解析预测：$m_T = m_0$ 且 $\\mathrm{Var}(X_T) = s_0^2\\,e^{-2\\alpha T}$。\n\n3. 仿射均值驱动模型：\n   - 漂移项：$b(x,\\mu) = -\\alpha\\,x + \\gamma\\,m$，其中 $m = \\int y\\,\\mu(dy)$。\n   - 扩散项：$\\sigma(x,\\mu) = \\beta$，一个常数。\n   - 解析预测：均值满足 $dm_t = (\\gamma - \\alpha)\\,m_t\\,dt$，因此 $m_T = m_0\\,e^{(\\gamma - \\alpha)T}$。对于 $Y_t = X_t - m_t$，有 $dY_t = -\\alpha\\,Y_t\\,dt + \\beta\\,dW_t$，因此\n     $$\n     \\mathrm{Var}(X_T) =\n     \\begin{cases}\n     s_0^2 e^{-2\\alpha T} + \\frac{\\beta^2}{2\\alpha}(1 - e^{-2\\alpha T}),  \\text{if } \\alpha > 0 \\\\\n     s_0^2 + \\beta^2 T,  \\text{if } \\alpha = 0\n     \\end{cases}\n     $$\n\n使用以下测试套件。在所有测试中，从正态分布 $\\mathcal{N}(m_0,s_0^2)$ 中独立地初始化 $X_0^{i,N}$，并使用独立的服从 $\\mathcal{N}(0,\\Delta t)$ 的正态增量 $\\Delta W_k^i$。整数 $K$ 必须为 $K = \\lfloor T/\\Delta t \\rfloor$，模拟应进行 $K$ 步，因此模拟的最终时间为 $K\\,\\Delta t$。\n\n- 测试用例 A（中心化 Ornstein–Uhlenbeck，正常路径）：\n  - $N=2000$，$T=1.0$，$\\Delta t=0.001$，$\\alpha=3.0$，$\\beta=0.8$，$m_0=1.25$，$s_0=2.0$，随机种子 $12345$。\n\n- 测试用例 B（确定性共识，零扩散边界情况）：\n  - $N=2000$，$T=0.8$，$\\Delta t=0.001$，$\\alpha=2.0$，$\\beta=0.0$，$m_0=-0.5$，$s_0=1.0$，随机种子 $34567$。\n\n- 测试用例 C（仿射均值驱动，非平凡的均值增长/衰减）：\n  - $N=2000$，$T=1.2$，$\\Delta t=0.001$，$\\alpha=1.0$，$\\beta=0.7$，$\\gamma=0.4$，$m_0=0.75$，$s_0=0.5$，随机种子 $98765$。\n\n- 测试用例 D（中心化 Ornstein–Uhlenbeck，$\\alpha=0$ 的边界情况）：\n  - $N=2000$，$T=0.7$，$\\Delta t=0.001$，$\\alpha=0.0$，$\\beta=0.65$，$m_0=0.0$，$s_0=0.9$，随机种子 $24680$。\n\n为每个测试用例实现欧拉-丸山粒子模拟，计算在最终时间 $K\\,\\Delta t$ 的经验均值 $\\widehat{m}_T^N$ 和经验方差 $\\widehat{v}_T^N$，并通过报告绝对误差将它们与上述解析预测值进行比较：\n$$\n\\varepsilon_{\\mathrm{mean}} = \\big|\\widehat{m}_T^N - m_T\\big|,\\qquad\n\\varepsilon_{\\mathrm{var}} = \\big|\\widehat{v}_T^N - \\mathrm{Var}(X_T)\\big|.\n$$\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序如下：\n$$\n\\big[\\varepsilon_{\\mathrm{mean}}^{\\mathrm{A}},\\,\\varepsilon_{\\mathrm{var}}^{\\mathrm{A}},\\,\\varepsilon_{\\mathrm{mean}}^{\\mathrm{B}},\\,\\varepsilon_{\\mathrm{var}}^{\\mathrm{B}},\\,\\varepsilon_{\\mathrm{mean}}^{\\mathrm{C}},\\,\\varepsilon_{\\mathrm{var}}^{\\mathrm{C}},\\,\\varepsilon_{\\mathrm{mean}}^{\\mathrm{D}},\\,\\varepsilon_{\\mathrm{var}}^{\\mathrm{D}}\\big],\n$$\n每个条目都打印为浮点数。此问题不涉及物理单位。程序必须是完整的，无需任何外部输入即可运行，并且必须使用指定的随机种子以确保可复现性。", "solution": "本问题根据既定标准进行验证。\n\n### 步骤 1：提取已知条件\n- **McKean-Vlasov SDE：** $dX_t = b(X_t,\\mu_t)\\,dt + \\sigma(X_t,\\mu_t)\\,dW_t$，其中 $\\mu_t$ 是 $X_t$ 的分布。\n- **N-粒子近似：** $dX_t^{i,N} = b(X_t^{i,N},\\mu_t^N)\\,dt + \\sigma(X_t^{i,N},\\mu_t^N)\\,dW_t^i$，其中 $\\mu_t^N = \\frac{1}{N}\\sum_{i=1}^N \\delta_{X_t^{i,N}}$ 且 $W_t^i$ 独立。\n- **欧拉-丸山格式：** $X_{k+1}^{i,N} = X_k^{i,N} + b(X_k^{i,N},\\mu_k^N)\\,\\Delta t + \\sigma(X_k^{i,N},\\mu_k^N)\\,\\Delta W_k^i$，其中 $\\mu_k^N = \\frac{1}{N}\\sum_{j=1}^N \\delta_{X_k^{j,N}}$，$\\Delta W_k^i \\sim \\mathcal{N}(0,\\Delta t)$，且 $K = \\lfloor T/\\Delta t \\rfloor$。\n- **初始条件：** $X_0^{i,N} \\sim \\mathcal{N}(m_0,s_0^2)$，独立同分布。\n- **模型 1：中心化 Ornstein–Uhlenbeck：**\n  - $b(x,\\mu) = -\\alpha(x - m)$，$m = \\int y\\,\\mu(dy)$。\n  - $\\sigma(x,\\mu) = \\beta$。\n  - 解析解：$m_T = m_0$。当 $\\alpha > 0$ 时，$\\mathrm{Var}(X_T) = s_0^2\\,e^{-2\\alpha T} + \\frac{\\beta^2}{2\\alpha}(1 - e^{-2\\alpha T})$；当 $\\alpha = 0$ 时，$\\mathrm{Var}(X_T) = s_0^2 + \\beta^2 T$。\n- **模型 2：确定性共识：**\n  - $b(x,\\mu) = -\\alpha(x - m)$。\n  - $\\sigma(x,\\mu) = 0$。\n  - 解析解：$m_T = m_0$，$\\mathrm{Var}(X_T) = s_0^2\\,e^{-2\\alpha T}$。\n- **模型 3：仿射均值驱动：**\n  - $b(x,\\mu) = -\\alpha\\,x + \\gamma\\,m$。\n  - $\\sigma(x,\\mu) = \\beta$。\n  - 解析解：$m_T = m_0\\,e^{(\\gamma - \\alpha)T}$。$\\mathrm{Var}(X_T)$ 与模型 1 相同。\n- **测试用例：**\n  - A: $N=2000$, $T=1.0$, $\\Delta t=0.001$, $\\alpha=3.0$, $\\beta=0.8$, $m_0=1.25$, $s_0=2.0$, 随机种子 $12345$。\n  - B: $N=2000$, $T=0.8$, $\\Delta t=0.001$, $\\alpha=2.0$, $\\beta=0.0$, $m_0=-0.5$, $s_0=1.0$, 随机种子 $34567$。\n  - C: $N=2000$, $T=1.2$, $\\Delta t=0.001$, $\\alpha=1.0$, $\\beta=0.7$, $\\gamma=0.4$, $m_0=0.75$, $s_0=0.5$, 随机种子 $98765$。\n  - D: $N=2000$, $T=0.7$, $\\Delta t=0.001$, $\\alpha=0.0$, $\\beta=0.65$, $m_0=0.0$, $s_0=0.9$, 随机种子 $24680$。\n- **任务：** 计算误差 $\\varepsilon_{\\mathrm{mean}} = |\\widehat{m}_T^N - m_T|$ 和 $\\varepsilon_{\\mathrm{var}} = |\\widehat{v}_T^N - \\mathrm{Var}(X_T)|$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题定义明确且科学上合理。\n1.  **科学性和事实合理性**：该问题基于 McKean-Vlasov SDE 及其通过相互作用粒子系统进行数值近似的标准理论，这是随机分析和计算数学中的一个核心课题。所提出的模型（Ornstein-Uhlenbeck、共识、仿射）是典型的例子。为极限过程的均值和方差提供的解析公式是正确的，可以使用线性 SDE 的标准技术推导出来。\n2.  **完整性和一致性**：每个测试用例都提供了所有必要的参数（$N, T, \\Delta t, \\alpha, \\beta, \\gamma$）、初始条件（$m_0, s_0$）、模型规格和随机种子。指令清晰明确。模拟时间 $K \\Delta t$ 定义良好，因为在所有情况下 $T/\\Delta t$ 都是整数。\n3.  **适定性**：SDE 的系数是全局 Lipschitz 的（在状态和测度上），确保了强解的存在性和唯一性。数值任务被清晰地指定并且是可重复的，从而得到一组可验证的单一结果。\n\n### 步骤 3：结论与行动\n问题有效。将提供一个合理的解答。\n\n### 解答\n该问题要求实现一个由平均场相互作用控制的 $N$ 粒子系统的欧拉-丸山模拟，目标是近似一个一维 McKean-Vlasov SDE。对于每个测试用例，将粒子在最终时间的经验均值和方差与极限 SDE 的解析推导均值和方差进行比较。\n\n**方法论**\n\n解答的核心是 $N$ 粒子系统的数值积分：\n$$\ndX_t^{i,N} = b\\big(X_t^{i,N},\\mu_t^N\\big)\\,dt + \\sigma\\big(X_t^{i,N},\\mu_t^N\\big)\\,dW_t^i, \\quad i=1,\\dots,N\n$$\n每个测试用例的步骤如下：\n\n1.  **初始化**：在时间 $t=0$ 初始化一个包含 $N$ 个粒子的系统。初始位置 $\\{X_0^{i,N}\\}_{i=1}^N$ 作为独立同分布的随机变量从正态分布 $\\mathcal{N}(m_0, s_0^2)$ 中抽取。这是通过从均值为 $m_0$、标准差为 $s_0$ 的正态分布中采样来实现的。使用指定的随机种子以确保可复现性。\n\n2.  **时间离散化**：时间区间 $[0, T]$ 被离散化为 $K = \\lfloor T/\\Delta t \\rfloor$ 个大小为 $\\Delta t$ 的步。对于所有提供的测试用例，$T/\\Delta t$ 都是整数，因此 $K = T/\\Delta t$。模拟进行 $K$ 步，达到最终时间 $T_{final} = K \\Delta t = T$。\n\n3.  **欧拉-丸山迭代**：粒子位置从时间步 $k$ 迭代演化到 $k+1$。对于每个粒子 $i \\in \\{1, \\dots, N\\}$，更新规则为：\n    $$\n    X_{k+1}^{i,N} = X_k^{i,N} + b\\big(X_k^{i,N},\\mu_k^N\\big)\\,\\Delta t + \\sigma\\big(X_k^{i,N},\\mu_k^N\\big)\\,\\Delta W_k^i\n    $$\n    - 对分布 $\\mu_k^N$ 的依赖性通过将关于经验测度 $\\mu_k^N = \\frac{1}{N}\\sum_{j=1}^N \\delta_{X_k^{j,N}}$ 的积分替换为样本平均值来处理。具体来说，均值 $m = \\int y\\,\\mu_k^N(dy)$ 被计算为在步骤 $k$ 时粒子的经验均值：$m_k^N = \\frac{1}{N}\\sum_{j=1}^N X_k^{j,N}$。\n    - 项 $\\Delta W_k^i$ 表示独立维纳过程的增量。它们作为来自正态分布 $\\mathcal{N}(0, \\Delta t)$ 的独立随机变量生成，等价于 $\\sqrt{\\Delta t} \\cdot Z_k^i$，其中 $Z_k^i \\sim \\mathcal{N}(0, 1)$。\n\n4.  **特定模型的动力学**：为每个模型实现漂移函数 $b$ 和扩散函数 $\\sigma$：\n    - **中心化 OU / 共识**：$b(x, \\mu_k^N) = -\\alpha(x - m_k^N)$ 且 $\\sigma(x, \\mu_k^N) = \\beta$。共识模型是 $\\beta=0$ 的一个特例。\n    - **仿射均值驱动**：$b(x, \\mu_k^N) = -\\alpha x + \\gamma m_k^N$ 且 $\\sigma(x, \\mu_k^N) = \\beta$。\n\n5.  **最终统计和误差计算**：经过 $K$ 次迭代后，模拟结束。最终的粒子位置是 $\\{X_K^{i,N}\\}_{i=1}^N$。\n    - **经验均值**计算为 $\\widehat{m}_T^N = \\frac{1}{N} \\sum_{i=1}^N X_K^{i,N}$。\n    - **经验方差**计算为 $\\widehat{v}_T^N = \\frac{1}{N} \\sum_{i=1}^N (X_K^{i,N} - \\widehat{m}_T^N)^2$。\n    - **解析均值** $m_T$ 和**解析方差** $\\mathrm{Var}(X_T)$ 使用问题描述中提供的精确公式计算，注意区分 $\\alpha > 0$ 和 $\\alpha=0$ 的情况。\n    - 最后，计算绝对误差：\n      $$\n      \\varepsilon_{\\mathrm{mean}} = \\big|\\widehat{m}_T^N - m_T\\big|\n      $$\n      $$\n      \\varepsilon_{\\mathrm{var}} = \\big|\\widehat{v}_T^N - \\mathrm{Var}(X_T)\\big|\n      $$\n\n此过程应用于四个测试用例中的每一个，并将得到的八个误差值收集并按指定格式化。该实现是使用 Python 中的 `numpy` 库完成的，以实现高效的向量化操作。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_analytic_solution(model_type, T, params, m0, s0):\n    \"\"\"\n    Calculates the analytical mean and variance at time T.\n    \"\"\"\n    alpha = params.get('alpha', 0.0)\n    beta = params.get('beta', 0.0)\n    s0_sq = s0**2\n\n    if model_type == 'OU':\n        # This covers Centered-OU and Deterministic Consensus (beta=0)\n        m_T = m0\n        if alpha == 0.0:\n            var_T = s0_sq + beta**2 * T\n        else: # alpha > 0\n            exp_term = np.exp(-2 * alpha * T)\n            var_T = s0_sq * exp_term + (beta**2 / (2 * alpha)) * (1 - exp_term)\n            \n    elif model_type == 'Affine':\n        gamma = params['gamma']\n        m_T = m0 * np.exp((gamma - alpha) * T)\n        if alpha == 0.0:\n            var_T = s0_sq + beta**2 * T\n        else: # alpha > 0\n            exp_term = np.exp(-2 * alpha * T)\n            var_T = s0_sq * exp_term + (beta**2 / (2 * alpha)) * (1 - exp_term)\n    else:\n        raise ValueError(f\"Unknown model type: {model_type}\")\n    \n    return m_T, var_T\n\n\ndef run_simulation_case(model_type, N, T, dt, params, m0, s0, seed):\n    \"\"\"\n    Runs the Euler-Maruyama simulation for a single test case.\n    \"\"\"\n    # 1. Initialization\n    rng = np.random.default_rng(seed)\n    # Initial particle positions from N(m0, s0^2)\n    X = rng.normal(loc=m0, scale=s0, size=N)\n\n    # 2. Time Discretization\n    K = int(T / dt)\n    sqrt_dt = np.sqrt(dt)\n\n    # 3. Euler-Maruyama Iteration\n    for _ in range(K):\n        # Compute empirical mean for interaction term\n        m_k_N = np.mean(X)\n        \n        # Generate Wiener increments\n        dW = rng.normal(loc=0.0, scale=sqrt_dt, size=N)\n        \n        # 4. Model-Specific Dynamics\n        if model_type == 'OU':\n            alpha = params['alpha']\n            beta = params['beta']\n            drift = -alpha * (X - m_k_N)\n            diffusion = beta\n            \n        elif model_type == 'Affine':\n            alpha = params['alpha']\n            beta = params['beta']\n            gamma = params['gamma']\n            drift = -alpha * X + gamma * m_k_N\n            diffusion = beta\n        else:\n             raise ValueError(f\"Unknown model type: {model_type}\")\n\n        # Update particle positions\n        X = X + drift * dt + diffusion * dW\n\n    # 5. Final Statistics and Error Calculation\n    # Empirical stats at final time T = K * dt\n    m_hat_T = np.mean(X)\n    v_hat_T = np.var(X) # ddof=0 is default, corresponding to 1/N\n\n    # Analytical stats\n    T_final = K * dt\n    m_T, var_T = calculate_analytic_solution(model_type, T_final, params, m0, s0)\n    \n    # Absolute errors\n    err_mean = np.abs(m_hat_T - m_T)\n    err_var = np.abs(v_hat_T - var_T)\n\n    return err_mean, err_var\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case A (centered Ornstein–Uhlenbeck)\n        { 'model_type': 'OU', 'N': 2000, 'T': 1.0, 'dt': 0.001,\n          'params': {'alpha': 3.0, 'beta': 0.8}, 'm0': 1.25, 's0': 2.0, 'seed': 12345 },\n        \n        # Test case B (deterministic consensus, handled as OU with beta=0)\n        { 'model_type': 'OU', 'N': 2000, 'T': 0.8, 'dt': 0.001,\n          'params': {'alpha': 2.0, 'beta': 0.0}, 'm0': -0.5, 's0': 1.0, 'seed': 34567 },\n        \n        # Test case C (affine mean-driven)\n        { 'model_type': 'Affine', 'N': 2000, 'T': 1.2, 'dt': 0.001,\n          'params': {'alpha': 1.0, 'beta': 0.7, 'gamma': 0.4}, 'm0': 0.75, 's0': 0.5, 'seed': 98765 },\n\n        # Test case D (centered Ornstein–Uhlenbeck, alpha=0)\n        { 'model_type': 'OU', 'N': 2000, 'T': 0.7, 'dt': 0.001,\n          'params': {'alpha': 0.0, 'beta': 0.65}, 'm0': 0.0, 's0': 0.9, 'seed': 24680 }\n    ]\n\n    results = []\n    for case in test_cases:\n        err_mean, err_var = run_simulation_case(**case)\n        results.extend([err_mean, err_var])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "3065755"}, {"introduction": "平均场理论的威力远不止于简单的线性模型。这个问题将引导你探索著名的仓本模型（Kuramoto model），这是一个描述从神经元到萤火虫等系统中同步现象的非线性麦克基恩-弗拉索夫随机微分方程。通过分析其平衡态，我们将揭示相变的迷人现象，即集体秩序如何从无序的个体行为中涌现。[@problem_id:3065766]", "problem": "考虑一个在单位圆上描述相同粒子系统的 McKean–Vlasov 随机微分方程 (SDE)，其中粒子状态为 $\\theta_t \\in [0,2\\pi)$：\n$$\n\\mathrm{d}\\theta_t \\;=\\; - K\\, r_t \\,\\sin\\!\\big(\\theta_t - \\psi_t\\big)\\,\\mathrm{d}t \\;+\\; \\sqrt{2D}\\,\\mathrm{d}W_t,\n$$\n其中 $K0$ 是耦合强度，$D0$ 是扩散系数，$W_t$ 是标准维纳过程，平均场序参量的定义为\n$$\nr_t\\,e^{\\mathrm{i}\\psi_t} \\;=\\; \\mathbb{E}\\!\\left[e^{\\mathrm{i}\\theta_t}\\right],\\quad r_t \\in [0,1],\\;\\psi_t \\in [0,2\\pi).\n$$\n假设在相关的福克-普朗克方程和平均场定律下，系统存在具有静态密度 $f(\\theta)$ 的不随时变的平衡态。从 McKean–Vlasov SDE 的定义和梯度漂移的静态福克-普朗克平衡出发，推导平衡序参量 $r$ 的自洽条件，并根据无量纲参数 $\\alpha = K/D$ 分析其不动点及其稳定性。基于该分析，选择下面所有正确的陈述。\n\nA. 存在一个临界值 $\\alpha_{\\mathrm{c}} = 2$，使得当 $\\alpha \\le 2$ 时不存在非零不动点，而当 $\\alpha  2$ 时出现一个非零不动点 $r^\\star  0$。\n\nB. 当 $\\alpha \\le 2$ 时，不动点 $r=0$ 在平均场动力学下是线性稳定的；而当 $\\alpha  2$ 时，不动点 $r=0$ 是线性不稳定的。\n\nC. 当 $\\alpha  2$ 时，存在一个非零不动点 $r^\\star  0$，它（在相位 $\\psi$ 的旋转对称性下）是线性稳定的。\n\nD. 在 $\\alpha = 2$ 处的相变是不连续的（一级相变）：序参量 $r$ 在 $\\alpha=2$ 处跳跃到一个正值。\n\nE. 当 $\\alpha  2$ 时，存在无穷多个不同的正值大小 $r^\\star$ 解自洽方程。\n\nF. 当 $\\alpha \\downarrow 2^+$ 时，非零解满足 $r^\\star \\sim C\\,\\sqrt{\\alpha - 2}$（其中 $C0$ 为某个常数），这表明这是一个连续的（二级）相变。", "solution": "用户希望我分析一个 McKean-Vlasov SDE 的平衡性质，该模型也被称为含噪声的 Kuramoto 模型。\n\n### 步骤 1：验证问题陈述\n该问题提供了一个描述圆上相互作用粒子系统的 McKean-Vlasov 随机微分方程 (SDE)，定义了相关的平均场序参量，并要求推导平衡序参量的自洽方程并分析其解。\n\n**提取的已知条件：**\n- 粒子角度 $\\theta_t \\in [0, 2\\pi)$ 的 SDE 为：\n$$\n\\mathrm{d}\\theta_t = - K\\, r_t \\,\\sin(\\theta_t - \\psi_t)\\,\\mathrm{d}t + \\sqrt{2D}\\,\\mathrm{d}W_t\n$$\n- $K  0$ 是耦合强度。\n- $D  0$ 是扩散系数。\n- $W_t$ 是标准维纳过程。\n- 平均场序参量由复数 $r_t\\,e^{\\mathrm{i}\\psi_t} = \\mathbb{E}[e^{\\mathrm{i}\\theta_t}]$ 定义，其中 $r_t \\in [0,1]$ 是其模，$\\psi_t \\in [0,2\\pi)$ 是平均相位。\n- 分析针对不随时变的平衡态进行，其特征是静态密度 $f(\\theta)$。\n- 用于分析的无量纲参数是 $\\alpha = K/D$。\n\n**验证：**\n1.  **科学依据：** 所提出的模型是含内在噪声的 Kuramoto 模型的标准形式，这是物理学、生物学和工程学中同步现象研究的基石。McKean-Vlasov SDE、福克-普朗克方程和自洽分析等概念在统计力学和概率论中是基础且被严格定义的。该问题在科学上是合理的。\n2.  **适定与客观：** 该问题在数学上是适定的，要求对一个著名系统进行标准的稳定性分析。所有术语都是标准的、无歧义的。问题设定是自洽的，不含矛盾或主观因素。\n3.  **无其他缺陷：** 问题是完整的、概念上合理的，并与指定主题直接相关。\n\n**结论：**\n问题陈述有效。我将继续进行推导和分析。\n\n### 步骤 2：推导与分析\n\n**静态分布的推导**\n给定的 SDE 形式为 $\\mathrm{d}\\theta_t = b(\\theta_t, \\mu_t)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t$，其中 $\\mu_t$ 是 $\\theta_t$ 的分布，漂移项为 $b(\\theta, \\mu_t) = -K r_t \\sin(\\theta - \\psi_t)$，噪声强度为 $\\sigma = \\sqrt{2D}$。相关的福克-普朗克方程描述概率密度 $p(\\theta, t)$ 的演化：\n$$\n\\frac{\\partial p}{\\partial t} = -\\frac{\\partial}{\\partial\\theta} \\Big( b(\\theta, \\mu_t) p \\Big) + \\frac{\\sigma^2}{2} \\frac{\\partial^2 p}{\\partial\\theta^2}\n$$\n代入 $b$ 和 $\\sigma$ 的表达式，我们得到：\n$$\n\\frac{\\partial p}{\\partial t} = \\frac{\\partial}{\\partial\\theta} \\Big( K r_t \\sin(\\theta - \\psi_t) p \\Big) + D \\frac{\\partial^2 p}{\\partial\\theta^2}\n$$\n在静态平衡时，密度 $p(\\theta, t)$ 变为不随时变的 $f(\\theta)$，序参量也变为常数 $(r_t, \\psi_t) \\to (r, \\psi)$。福克-普朗克方程简化为：\n$$\n0 = \\frac{\\mathrm{d}}{\\mathrm{d}\\theta} \\Big( K r \\sin(\\theta - \\psi) f(\\theta) \\Big) + D \\frac{\\mathrm{d}^2 f(\\theta)}{\\mathrm{d}\\theta^2}\n$$\n该方程意味着概率流 $J(\\theta)$ 是一个常数，其中 $J(\\theta) = - K r \\sin(\\theta - \\psi) f(\\theta) - D \\frac{\\mathrm{d}f(\\theta)}{\\mathrm{d}\\theta}$。对于周期性域上由势漂移驱动的静态系统，净概率流必须为零，因此 $J(\\theta)=0$。\n$$\nD \\frac{\\mathrm{d}f}{\\mathrm{d}\\theta} = - K r \\sin(\\theta - \\psi) f(\\theta)\n$$\n分离变量并积分，使用参数 $\\alpha = K/D$：\n$$\n\\int \\frac{\\mathrm{d}f}{f} = -\\int \\frac{K}{D} r \\sin(\\theta - \\psi) \\mathrm{d}\\theta = -\\alpha r \\int \\sin(\\theta - \\psi) \\mathrm{d}\\theta\n$$\n$$\n\\ln f(\\theta) = \\alpha r \\cos(\\theta - \\psi) + \\text{const}\n$$\n因此，静态分布为 $f(\\theta) = C_0 \\exp(\\alpha r \\cos(\\theta - \\psi))$。归一化常数 $C_0$ 由条件 $\\int_0^{2\\pi} f(\\theta) \\mathrm{d}\\theta = 1$ 确定。此积分与零阶第一类修正贝塞尔函数 $I_0(x) = \\frac{1}{2\\pi} \\int_0^{2\\pi} e^{x \\cos\\phi} \\mathrm{d}\\phi$ 相关。\n$$\n\\int_0^{2\\pi} C_0 e^{\\alpha r \\cos(\\theta-\\psi)} \\mathrm{d}\\theta = C_0 \\cdot 2\\pi I_0(\\alpha r) = 1 \\implies C_0 = \\frac{1}{2\\pi I_0(\\alpha r)}\n$$\n所以，静态分布是一个 von Mises 分布：\n$$\nf(\\theta) = \\frac{\\exp(\\alpha r \\cos(\\theta - \\psi))}{2\\pi I_0(\\alpha r)}\n$$\n\n**自洽方程的推导**\n序参量 $r$ 必须满足其自身的定义，该定义是相对于静态分布 $f(\\theta)$ 计算的：\n$$\nr e^{\\mathrm{i}\\psi} = \\mathbb{E}[e^{\\mathrm{i}\\theta}] = \\int_0^{2\\pi} e^{\\mathrm{i}\\theta} f(\\theta) \\mathrm{d}\\theta\n$$\n$$\nr e^{\\mathrm{i}\\psi} = \\int_0^{2\\pi} e^{\\mathrm{i}\\theta} \\frac{\\exp(\\alpha r \\cos(\\theta - \\psi))}{2\\pi I_0(\\alpha r)} \\mathrm{d}\\theta\n$$\n由于旋转对称性，我们可以不失一般性地设 $\\psi = 0$。\n$$\nr = \\int_0^{2\\pi} e^{\\mathrm{i}\\theta} \\frac{\\exp(\\alpha r \\cos\\theta)}{2\\pi I_0(\\alpha r)} \\mathrm{d}\\theta = \\frac{1}{2\\pi I_0(\\alpha r)} \\int_0^{2\\pi} (\\cos\\theta + i\\sin\\theta) \\exp(\\alpha r \\cos\\theta) \\mathrm{d}\\theta\n$$\n积分的虚部 $\\int_0^{2\\pi} \\sin\\theta \\exp(\\alpha r \\cos\\theta) \\mathrm{d}\\theta$ 为零，因为被积函数在像 $[-\\pi, \\pi]$ 这样的对称区间上具有奇对称性。\n实部给出：\n$$\nr = \\frac{1}{2\\pi I_0(\\alpha r)} \\int_0^{2\\pi} \\cos\\theta \\exp(\\alpha r \\cos\\theta) \\mathrm{d}\\theta\n$$\n根据定义，此积分为 $2\\pi I_1(\\alpha r)$，其中 $I_1(x)$ 是一阶第一类修正贝塞尔函数。这便得到了平衡序参量模 $r$ 的自洽方程：\n$$\nr = \\frac{I_1(\\alpha r)}{I_0(\\alpha r)}\n$$\n\n**不动点及其稳定性的分析**\n我们分析方程 $r = F(r)$ 的解，其中 $F(r) = \\frac{I_1(\\alpha r)}{I_0(\\alpha r)}$。\n\n1.  **平凡解：** $r=0$ 始终是一个解，因为 $F(0) = \\frac{I_1(0)}{I_0(0)} = \\frac{0}{1} = 0$。这对应于非相干态。\n\n2.  **非平凡解：** 为了找到其他解，我们分析 $F(r)$ 在 $r=0$ 附近的行为。使用小 $x$ 的级数展开：$I_0(x) \\approx 1 + \\frac{x^2}{4}$ 和 $I_1(x) \\approx \\frac{x}{2} + \\frac{x^3}{16}$。令 $x=\\alpha r$。\n    $$\n    F(r) \\approx \\frac{\\frac{\\alpha r}{2} + \\frac{(\\alpha r)^3}{16}}{1 + \\frac{(\\alpha r)^2}{4}} \\approx \\left(\\frac{\\alpha r}{2} + \\frac{\\alpha^3 r^3}{16}\\right)\\left(1 - \\frac{\\alpha^2 r^2}{4}\\right) \\approx \\frac{\\alpha r}{2} - \\frac{\\alpha^3 r^3}{16}\n    $$\n    不动点方程 $r=F(r)$ 变为 $r \\approx \\frac{\\alpha r}{2} - \\frac{\\alpha^3 r^3}{16}$。对于 $r0$，我们可以两边同除以 $r$：\n    $$\n    1 \\approx \\frac{\\alpha}{2} - \\frac{\\alpha^3 r^2}{16} \\implies r^2 \\approx \\frac{16}{\\alpha^3}\\left(\\frac{\\alpha}{2} - 1\\right) = \\frac{8(\\alpha - 2)}{\\alpha^3}\n    $$\n    $r$ 的实数非零解仅在 $\\alpha-2  0$（即 $\\alpha  2$）时存在。这表明在临界值 $\\alpha_{\\mathrm{c}} = 2$ 处发生分岔。\n\n3.  **不动点的稳定性：**\n    不动点 $r^*$ 的稳定性由导数 $F'(r^*)$ 决定。如果不动点满足 $|F'(r^*)|1$，则它是线性稳定的；如果不满足 $|F'(r^*)|>1$，则它是不稳定的。\n    *   **$r=0$ 的稳定性：** 原点处的斜率为 $F'(0)$。从展开式 $F(r) \\approx \\frac{\\alpha r}{2}$，我们发现 $F'(0) = \\frac{\\alpha}{2}$。\n        -   如果 $\\alpha  2$，则 $F'(0)  1$，所以不动点 $r=0$ 是稳定的。在 $\\alpha=2$ 处，它是中性稳定的。因此，对于 $\\alpha \\le 2$，它是稳定的。\n        -   如果 $\\alpha > 2$，则 $F'(0) > 1$，所以不动点 $r=0$ 是不稳定的。\n    *   **$r^\\star > 0$ 的稳定性（对于 $\\alpha > 2$）：** 函数 $F(r)$ 是单调递增的，对于 $r>0$ 是凹函数，从 $F(0)=0$ 开始，并趋近于 $\\lim_{r\\to\\infty} F(r) = 1$。对于 $\\alpha > 2$，曲线 $y=F(r)$ 的初始斜率大于1，并且为了达到其渐近线，必须从上方穿过直线 $y=r$。在唯一的交点 $r^\\star > 0$ 处，斜率必须小于1，即 $0 \\le F'(r^\\star)  1$。因此，非零不动点 $r^\\star$ 是稳定的。\n\n### 步骤 3：评估选项\n\n**A. 存在一个临界值 $\\alpha_{\\mathrm{c}} = 2$，使得当 $\\alpha \\le 2$ 时不存在非零不动点，而当 $\\alpha > 2$ 时出现一个非零不动点 $r^\\star > 0$。**\n我们的分析表明，非平凡解 $r > 0$ 恰好在 $\\alpha > 2$ 时出现。临界值为 $\\alpha_{\\mathrm{c}} = 2$。该陈述是**正确的**。\n\n**B. 当 $\\alpha \\le 2$ 时，不动点 $r=0$ 在平均场动力学下是线性稳定的；而当 $\\alpha > 2$ 时，不动点 $r=0$ 是线性不稳定的。**\n我们对 $r=0$ 解的稳定性分析表明，当 $F'(0) = \\alpha/2 \\le 1$ (即 $\\alpha \\le 2$) 时它是稳定的，当 $F'(0) = \\alpha/2 > 1$ (即 $\\alpha > 2$) 时它是不稳定的。该陈述是**正确的**。\n\n**C. 当 $\\alpha > 2$ 时，存在一个非零不动点 $r^\\star > 0$，它（在相位 $\\psi$ 的旋转对称性下）是线性稳定的。**\n如上所示，对于 $\\alpha > 2$，存在一个唯一的非零解 $r^\\star$，并且由于 $F'(r^\\star)1$，该解是稳定的。括号中的注释正确地指出了由于系统的旋转对称性，相位 $\\psi$ 具有中性稳定性。该陈述是**正确的**。\n\n**D. 在 $\\alpha = 2$ 处的相变是不连续的（一级相变）：序参量 $r$ 在 $\\alpha=2$ 处跳跃到一个正值。**\n我们的分析表明，当 $\\alpha$ 略大于 2 时，$r^\\star$ 从 0 开始连续增长（其标度关系为 $\\sqrt{\\alpha-2}$）。它不会发生跳跃。因此，相变是连续的（二级）。该陈述是**不正确的**。\n\n**E. 当 $\\alpha > 2$ 时，存在无穷多个不同的正值大小 $r^\\star$ 解自洽方程。**\n函数 $F(r)$ 在 $r>0$ 上是严格凹的。一个凹函数最多可以与一条直线（$y=r$）相交两次。由于一个交点在 $r=0$ 处，因此对于 $r>0$ 最多只能有另一个交点。我们的分析表明，当 $\\alpha>2$ 时，恰好存在一个正解。该陈述是**不正确的**。\n\n**F. 当 $\\alpha \\downarrow 2^+$ 时，非零解满足 $r^\\star \\sim C\\,\\sqrt{\\alpha - 2}$（其中 $C>0$ 为某个常数），这表明这是一个连续的（二级）相变。**\n我们的展开式得到 $r^2 \\approx \\frac{8(\\alpha-2)}{\\alpha^3}$。当 $\\alpha \\to 2^+$ 时，我们有 $\\alpha^3 \\to 8$，所以 $r^2 \\approx \\alpha-2$。这意味着 $r \\approx \\sqrt{\\alpha-2}$。这与 $r \\sim C\\sqrt{\\alpha-2}$ 的形式相符，其中 $C=1$。这种平方根标度关系是连续二级相变的标志。该陈述是**正确的**。", "answer": "$$\\boxed{ABCF}$$", "id": "3065766"}]}