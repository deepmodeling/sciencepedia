{"hands_on_practices": [{"introduction": "这个练习是一个基础性的实践。我们将分析Ornstein-Uhlenbeck过程——随机过程中的一个基石模型——并通过推导其转移核函数，来明确验证它满足细致平衡条件，即相对于其不变测度的对称性。这个计算过程将帮助我们从转移概率的层面上，对可逆性建立一个具体而深刻的理解。[@problem_id:3072636]", "problem": "考虑一维奥恩斯坦-乌伦贝克（Ornstein–Uhlenbeck, OU）过程，其定义为以下线性随机微分方程（SDE）的唯一强解：\n$$\n\\mathrm{d}X_t = -\\gamma X_t \\,\\mathrm{d}t + \\sigma \\,\\mathrm{d}W_t, \\qquad X_0 = x \\in \\mathbb{R},\n$$\n其中 $\\gamma>0$ 和 $\\sigma>0$ 是常数，而 $(W_t)_{t\\ge 0}$ 是标准的一维布朗运动。从随机微积分的核心原理和线性随机微分方程的性质出发，完成以下任务：\n\n1. 对于有界可测检验函数 $f:\\mathbb{R}\\to\\mathbb{R}$，通过以下方式推导作用于其上的马尔可夫半群 $(P_t)_{t\\ge 0}$ 的显式表达式：\n$$\n(P_t f)(x) = \\mathbb{E}_x[f(X_t)],\n$$\n具体而言，求出转移密度核 $p_t(x,y)$，使得\n$$\n(P_t f)(x) = \\int_{\\mathbb{R}} f(y)\\, p_t(x,y)\\,\\mathrm{d}y.\n$$\n\n2. 确定该过程的不变概率密度 $\\pi(y)$，并使用您推导出的转移密度，通过检验以下对称关系来验证细致平衡条件：\n$$\n\\pi(x)\\, p_t(x,y) = \\pi(y)\\, p_t(y,x) \\quad \\text{for all } x,y \\in \\mathbb{R}, \\; t>0.\n$$\n\n您的最终答案必须是 OU 过程的转移密度 $p_t(x,y)$ 的单个闭式解析表达式。无需进行数值舍入。", "solution": "问题陈述已经过验证，并被认为是合理的。这是一个随机微分方程理论中的适定问题，具体涉及奥恩斯坦-乌伦贝克过程、其转移动态及其平衡性质。该问题具有科学依据、内容自洽且客观。我们现在可以进行形式化推导。\n\n该问题围绕一维奥恩斯坦-乌伦贝克（Ornstein–Uhlenbeck, OU）过程展开，该过程是以下线性随机微分方程（SDE）的解：\n$$\n\\mathrm{d}X_t = -\\gamma X_t \\,\\mathrm{d}t + \\sigma \\,\\mathrm{d}W_t, \\qquad X_0 = x\n$$\n其中 $\\gamma > 0$ 和 $\\sigma > 0$ 是正常数。\n\n**1. 转移密度 $p_t(x,y)$ 的推导**\n\n为了求得转移密度，我们首先求解 $X_t$ 的 SDE。这是一个线性 SDE，可以使用积分因子法求解。我们定义一个积分因子 $I_t = \\exp(\\gamma t)$。考虑过程 $Y_t = I_t X_t = \\exp(\\gamma t) X_t$。对微分 $\\mathrm{d}Y_t = \\mathrm{d}(\\exp(\\gamma t) X_t)$ 使用 Itô 乘积法则：\n$$\n\\mathrm{d}Y_t = (\\mathrm{d}\\exp(\\gamma t))X_t + \\exp(\\gamma t)\\mathrm{d}X_t\n$$\n由于 $\\exp(\\gamma t)$ 是一个关于时间的确定性函数，其微分为 $\\mathrm{d}\\exp(\\gamma t) = \\gamma \\exp(\\gamma t)\\,\\mathrm{d}t$。将此式以及 $\\mathrm{d}X_t$ 的 SDE 代入：\n$$\n\\mathrm{d}Y_t = (\\gamma \\exp(\\gamma t) X_t) \\,\\mathrm{d}t + \\exp(\\gamma t) (-\\gamma X_t \\,\\mathrm{d}t + \\sigma \\,\\mathrm{d}W_t)\n$$\n包含 $X_t \\,\\mathrm{d}t$ 的项相互抵消：\n$$\n\\mathrm{d}Y_t = \\gamma \\exp(\\gamma t) X_t \\,\\mathrm{d}t - \\gamma \\exp(\\gamma t) X_t \\,\\mathrm{d}t + \\sigma \\exp(\\gamma t) \\,\\mathrm{d}W_t = \\sigma \\exp(\\gamma t) \\,\\mathrm{d}W_t\n$$\n从 $s=0$ 到 $s=t$ 积分：\n$$\nY_t - Y_0 = \\int_0^t \\sigma \\exp(\\gamma s) \\,\\mathrm{d}W_s\n$$\n将 $Y_t = \\exp(\\gamma t) X_t$ 和 $Y_0 = \\exp(0) X_0 = x$ 代回：\n$$\n\\exp(\\gamma t) X_t - x = \\sigma \\int_0^t \\exp(\\gamma s) \\,\\mathrm{d}W_s\n$$\n对 $X_t$ 求解，得到显式解：\n$$\nX_t = x \\exp(-\\gamma t) + \\sigma \\exp(-\\gamma t) \\int_0^t \\exp(\\gamma s) \\,\\mathrm{d}W_s\n$$\n通过改变随机积分中的积分变量，上式可重写为：\n$$\nX_t = x \\exp(-\\gamma t) + \\sigma \\int_0^t \\exp(-\\gamma(t-s)) \\,\\mathrm{d}W_s\n$$\n从这个表达式中，我们可以确定在 $X_0 = x$ 条件下 $X_t$ 的分布。第一项 $x \\exp(-\\gamma t)$ 是确定性的。第二项是一个具有确定性被积函数的 Itô 积分。Itô 积分的一个关键性质是，对于一个平方可积的确定性函数 $g(s)$，随机变量 $I = \\int_0^t g(s) \\,\\mathrm{d}W_s$ 是一个高斯随机变量，其均值为 $0$，方差为 $\\int_0^t g(s)^2 \\,\\mathrm{d}s$。\n\n因此，$X_t$ 是一个高斯随机变量，因为它是一个常数与一个高斯随机变量之和。其条件均值为：\n$$\n\\mathbb{E}[X_t | X_0 = x] = \\mathbb{E}[x \\exp(-\\gamma t)] + \\mathbb{E}\\left[\\sigma \\int_0^t \\exp(-\\gamma(t-s)) \\,\\mathrm{d}W_s\\right] = x \\exp(-\\gamma t) + 0 = x \\exp(-\\gamma t)\n$$\n其条件方差为：\n$$\n\\mathrm{Var}(X_t | X_0 = x) = \\mathrm{Var}\\left(x \\exp(-\\gamma t) + \\sigma \\int_0^t \\exp(-\\gamma(t-s)) \\,\\mathrm{d}W_s\\right)\n$$\n$$\n= \\mathrm{Var}\\left(\\sigma \\int_0^t \\exp(-\\gamma(t-s)) \\,\\mathrm{d}W_s\\right) = \\sigma^2 \\int_0^t (\\exp(-\\gamma(t-s)))^2 \\,\\mathrm{d}s\n$$\n$$\n= \\sigma^2 \\int_0^t \\exp(-2\\gamma(t-s)) \\,\\mathrm{d}s = \\sigma^2 \\exp(-2\\gamma t) \\int_0^t \\exp(2\\gamma s) \\,\\mathrm{d}s\n$$\n$$\n= \\sigma^2 \\exp(-2\\gamma t) \\left[\\frac{\\exp(2\\gamma s)}{2\\gamma}\\right]_0^t = \\sigma^2 \\exp(-2\\gamma t) \\left(\\frac{\\exp(2\\gamma t) - 1}{2\\gamma}\\right)\n$$\n$$\n= \\frac{\\sigma^2}{2\\gamma} (1 - \\exp(-2\\gamma t))\n$$\n因此，给定 $X_0=x$ 时 $X_t$ 的条件分布是一个正态分布：\n$$\nX_t | X_0=x \\sim \\mathcal{N}\\left(x \\exp(-\\gamma t), \\frac{\\sigma^2}{2\\gamma}(1 - \\exp(-2\\gamma t))\\right)\n$$\n转移概率密度 $p_t(x,y)$ 是该正态分布的概率密度函数（PDF）在 $y$ 处的值。正态分布 $\\mathcal{N}(\\mu, V)$ 的概率密度函数的一般形式为 $\\frac{1}{\\sqrt{2\\pi V}} \\exp\\left(-\\frac{(z-\\mu)^2}{2V}\\right)$。代入我们的均值和方差：\n$$\np_t(x,y) = \\frac{1}{\\sqrt{2\\pi \\frac{\\sigma^2}{2\\gamma}(1 - \\exp(-2\\gamma t))}} \\exp\\left(-\\frac{(y - x\\exp(-\\gamma t))^2}{2 \\frac{\\sigma^2}{2\\gamma}(1 - \\exp(-2\\gamma t))}\\right)\n$$\n化简该表达式可得：\n$$\np_t(x,y) = \\sqrt{\\frac{\\gamma}{\\pi\\sigma^2(1 - \\exp(-2\\gamma t))}} \\exp\\left(-\\frac{\\gamma(y - x\\exp(-\\gamma t))^2}{\\sigma^2(1 - \\exp(-2\\gamma t))}\\right)\n$$\n这就是 OU 过程的转移密度的显式表达式。\n\n**2. 不变密度与细致平衡的验证**\n\n不变概率密度 $\\pi(y)$ 是过程的平稳分布，可以通过取 $t \\to \\infty$ 时 $X_t$ 分布的极限来求得。当 $t \\to \\infty$ 时：\n$$\n\\lim_{t \\to \\infty} \\mathbb{E}[X_t | X_0 = x] = \\lim_{t \\to \\infty} x \\exp(-\\gamma t) = 0\n$$\n$$\n\\lim_{t \\to \\infty} \\mathrm{Var}(X_t | X_0 = x) = \\lim_{t \\to \\infty} \\frac{\\sigma^2}{2\\gamma}(1 - \\exp(-2\\gamma t)) = \\frac{\\sigma^2}{2\\gamma}\n$$\n因此，不变分布是一个均值为 $0$、方差为 $\\frac{\\sigma^2}{2\\gamma}$ 的正态分布，即 $\\mathcal{N}(0, \\frac{\\sigma^2}{2\\gamma})$。其概率密度函数 $\\pi(y)$ 为：\n$$\n\\pi(y) = \\frac{1}{\\sqrt{2\\pi \\frac{\\sigma^2}{2\\gamma}}} \\exp\\left(-\\frac{y^2}{2 \\frac{\\sigma^2}{2\\gamma}}\\right) = \\sqrt{\\frac{\\gamma}{\\pi\\sigma^2}} \\exp\\left(-\\frac{\\gamma y^2}{\\sigma^2}\\right)\n$$\n现在，我们验证细致平衡条件：$\\pi(x) p_t(x,y) = \\pi(y) p_t(y,x)$。\n我们来分析乘积 $\\pi(x) p_t(x,y)$。为方便起见，令 $V_s = \\frac{\\sigma^2}{2\\gamma}$ 为平稳方差，令 $V_t = \\frac{\\sigma^2}{2\\gamma}(1 - \\exp(-2\\gamma t))$ 为随时间变化的方差。\n$$\n\\pi(x) = \\frac{1}{\\sqrt{2\\pi V_s}} \\exp\\left(-\\frac{x^2}{2V_s}\\right)\n$$\n$$\np_t(x,y) = \\frac{1}{\\sqrt{2\\pi V_t}} \\exp\\left(-\\frac{(y-x\\exp(-\\gamma t))^2}{2V_t}\\right)\n$$\n该乘积为：\n$$\n\\pi(x) p_t(x,y) = \\frac{1}{2\\pi \\sqrt{V_s V_t}} \\exp\\left(-\\frac{x^2}{2V_s} - \\frac{(y-x\\exp(-\\gamma t))^2}{2V_t}\\right)\n$$\n通过交换 $x$ 和 $y$ 可得到 $\\pi(y) p_t(y,x)$ 项：\n$$\n\\pi(y) p_t(y,x) = \\frac{1}{2\\pi \\sqrt{V_s V_t}} \\exp\\left(-\\frac{y^2}{2V_s} - \\frac{(x-y\\exp(-\\gamma t))^2}{2V_t}\\right)\n$$\n两式相等要求指数部分相等。我们考察 $\\pi(x) p_t(x,y)$ 的指数乘以 $-2V_s V_t$ 后的结果：\n$$\nE_{xy} = V_t x^2 + V_s(y-x\\exp(-\\gamma t))^2 = V_t x^2 + V_s(y^2 - 2xy\\exp(-\\gamma t) + x^2\\exp(-2\\gamma t))\n$$\n以及 $\\pi(y) p_t(y,x)$ 的指数乘以 $-2V_s V_t$ 后的结果：\n$$\nE_{yx} = V_t y^2 + V_s(x-y\\exp(-\\gamma t))^2 = V_t y^2 + V_s(x^2 - 2xy\\exp(-\\gamma t) + y^2\\exp(-2\\gamma t))\n$$\n交叉项 $-2V_s xy\\exp(-\\gamma t)$ 在两个表达式中都存在。我们必须证明剩余的项相等：\n$$\nV_t x^2 + V_s y^2 + V_s x^2 \\exp(-2\\gamma t) \\stackrel{?}{=} V_t y^2 + V_s x^2 + V_s y^2 \\exp(-2\\gamma t)\n$$\n代入定义 $V_t = V_s(1 - \\exp(-2\\gamma t))$：\n$$\nV_s(1 - \\exp(-2\\gamma t)) x^2 + V_s y^2 + V_s x^2 \\exp(-2\\gamma t) \\stackrel{?}{=} V_s(1 - \\exp(-2\\gamma t)) y^2 + V_s x^2 + V_s y^2 \\exp(-2\\gamma t)\n$$\n展开左侧：\n$$\nV_s x^2 - V_s x^2 \\exp(-2\\gamma t) + V_s y^2 + V_s x^2 \\exp(-2\\gamma t) = V_s x^2 + V_s y^2\n$$\n展开右侧：\n$$\nV_s y^2 - V_s y^2 \\exp(-2\\gamma t) + V_s x^2 + V_s y^2 \\exp(-2\\gamma t) = V_s y^2 + V_s x^2\n$$\n由于 $V_s x^2 + V_s y^2 = V_s y^2 + V_s x^2$，等式成立。这验证了细致平衡条件，证实了 OU 过程关于其不变测度 $\\pi$ 是可逆的。", "answer": "$$\n\\boxed{\\sqrt{\\frac{\\gamma}{\\pi\\sigma^2(1 - \\exp(-2\\gamma t))}} \\exp\\left(- \\frac{\\gamma(y - x \\exp(-\\gamma t))^2}{\\sigma^2(1 - \\exp(-2\\gamma t))}\\right)}\n$$", "id": "3072636"}, {"introduction": "如果为一个具有状态依赖扩散的系统指定了错误的漂移项，会发生什么？这个练习提供了一个关键的反例，旨在说明为什么为了维持细致平衡，完整的可逆漂移项（包括与扩散系数梯度相关的项）是必不可少的。通过计算由此产生的非零概率流，我们将深入理解平衡是如何被打破的，以及为什么福克-普朗克方程中的每一项都至关重要。[@problem_id:3072633]", "problem": "考虑一个一维伊藤形式的随机微分方程 (SDE)，\n$$\n\\mathrm{d}X_{t} = b(X_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t},\n$$\n其中 $W_{t}$ 是标准布朗运动，$a(x) = \\sigma(x)^{2}$ 是依赖于状态的扩散系数，$b(x)$ 是漂移项。令目标平稳密度为\n$$\n\\pi(x) = \\frac{1}{\\sqrt{2\\pi}}\\,\\exp\\!\\left(-\\frac{x^{2}}{2}\\right),\n$$\n并取非恒定的扩散系数\n$$\na(x) = 1 + x^{2}.\n$$\n假设我们试图通过选择漂移项来强制实现可逆性（细致平衡）\n$$\nb(x) = \\frac{1}{2}\\,a(x)\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log \\pi(x),\n$$\n也就是说，省略了散度项 $ \\tfrac{1}{2}\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}a(x)$。从概率的连续性方程和福克-普朗克方程 (FPE) 出发，推导在此 $b(x)$ 选择下的平稳概率流 $j(x)$，并确定其作为 $x$ 的函数的闭式表达式。你的最终答案必须是 $j(x)$ 的一个单一简化解析表达式。无需四舍五入。", "solution": "该问题要求解由伊藤方程描述的一维随机过程的平稳概率流 $j(x)$：\n$$\n\\mathrm{d}X_{t} = b(X_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t}.\n$$\n该过程的概率密度函数 $p(x,t)$ 的时间演化由福克-普朗克方程 (FPE) 控制，该方程可以写成一个连续性方程：\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x}j(x,t),\n$$\n其中 $j(x,t)$ 是概率流。概率流的一般表达式为\n$$\nj(x,t) = b(x) p(x,t) - \\frac{1}{2} \\frac{\\partial}{\\partial x} [a(x) p(x,t)],\n$$\n其中 $a(x) = \\sigma(x)^{2}$ 是扩散系数。\n\n平稳状态是指概率密度不随时间变化的状态，即 $\\frac{\\partial p}{\\partial t} = 0$。在这种情况下，FPE 意味着平稳流 $j_s(x)$ 必须满足 $\\frac{\\mathrm{d}j_s(x)}{\\mathrm{d}x} = 0$，即 $j_s(x)$ 是一个常数。对于在无穷域上且具有自然边界条件（即概率密度和流在 $x \\to \\pm\\infty$ 处消失）的过程，该常数必须为零。如果一个过程关于平稳密度 $\\pi(x)$ 的平稳流恒为零，即 $j_s(x) = 0$，则该过程是可逆的，或满足细致平衡。\n\n因此，细致平衡的条件是\n$$\nb(x)\\pi(x) - \\frac{1}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x}[a(x)\\pi(x)] = 0.\n$$\n求解漂移项 $b(x)$ 得到可逆性所需的形式：\n$$\nb_{rev}(x) = \\frac{1}{2\\pi(x)}\\frac{\\mathrm{d}}{\\mathrm{d}x}[a(x)\\pi(x)] = \\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x} + \\frac{1}{2}a(x)\\frac{1}{\\pi(x)}\\frac{\\mathrm{d}\\pi(x)}{\\mathrm{d}x} = \\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x} + \\frac{1}{2}a(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x).\n$$\n问题指定了一个漂移项 $b(x)$，它省略了第一项，即所谓的散度项或噪声诱导项：\n$$\nb(x) = \\frac{1}{2}a(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x).\n$$\n任务是在此漂移项选择下，求出“平稳概率流 $j(x)$”。这可以理解为，将给定的动力学和目标密度 $\\pi(x)$ 代入流的一般表达式中，计算所产生的流场。这个量衡量了相对于 $\\pi(x)$ 的细致平衡被破坏的程度。\n\n我们使用所提供的函数来计算流的表达式 $j(x) = b(x)\\pi(x) - \\frac{1}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x}[a(x)\\pi(x)]$。首先，我们展开导数项：\n$$\n\\frac{1}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x}[a(x)\\pi(x)] = \\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x}\\pi(x) + \\frac{1}{2}a(x)\\frac{\\mathrm{d}\\pi(x)}{\\mathrm{d}x}.\n$$\n使用关系式 $\\frac{\\mathrm{d}\\pi(x)}{\\mathrm{d}x} = \\pi(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x)$，上式变为\n$$\n\\frac{1}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x}[a(x)\\pi(x)] = \\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x}\\pi(x) + \\frac{1}{2}a(x)\\pi(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x).\n$$\n现在我们组合出流 $j(x)$ 的完整表达式：\n$$\nj(x) = b(x)\\pi(x) - \\left( \\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x}\\pi(x) + \\frac{1}{2}a(x)\\pi(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x) \\right).\n$$\n代入给定的漂移项 $b(x) = \\frac{1}{2}a(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x)$：\n$$\nj(x) = \\left(\\frac{1}{2}a(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x)\\right)\\pi(x) - \\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x}\\pi(x) - \\frac{1}{2}a(x)\\pi(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x).\n$$\n第一项和第三项相互抵消，留下了流的一个非常简单的表达式：\n$$\nj(x) = -\\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x}\\pi(x).\n$$\n这个结果表明，非零流与扩散系数的梯度成正比，而这正是从可逆漂移中省略的项。\n\n现在我们代入问题陈述中给出的具体函数：\n目标平稳密度是一个标准正态分布：\n$$\n\\pi(x) = \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{x^{2}}{2}\\right).\n$$\n扩散系数为：\n$$\na(x) = 1 + x^{2}.\n$$\n我们计算它关于 $x$ 的导数：\n$$\n\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x} = \\frac{\\mathrm{d}}{\\mathrm{d}x}(1 + x^{2}) = 2x.\n$$\n将这些代入我们简化的 $j(x)$ 表达式中：\n$$\nj(x) = -\\frac{1}{2}(2x)\\pi(x) = -x\\pi(x).\n$$\n最后，我们写出 $j(x)$ 的完整表达式：\n$$\nj(x) = -x \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{x^{2}}{2}\\right).\n$$\n这就是在指定条件下平稳概率流的闭式表达式。由于 $\\frac{\\mathrm{d}j}{\\mathrm{d}x} \\neq 0$，密度 $\\pi(x)$ 不是具有给定漂移项的过程的真实平稳密度，系统不处于平衡状态。计算出的 $j(x)$ 代表了非平衡流场。", "answer": "$$\n\\boxed{-x \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{x^{2}}{2}\\right)}\n$$", "id": "3072633"}, {"introduction": "从分析转向综合，这个练习挑战我们为一个特定目的设计一个随机过程。我们将为一个给定的多峰目标分布和一个精心选择的位置依赖扩散系数，构建正确的保证可逆性的漂移项，这是一种在复杂系统中用于加速采样的技术。这个实践展示了细致平衡原理在设计高效计算算法方面的实际应用价值。[@problem_id:3072619]", "problem": "考虑一个一维伊藤随机微分方程（SDE），其形式为 $dX_t = b(X_t)\\,dt + \\sqrt{2\\,a(X_t)}\\,dW_t$，其中 $a(x)$ 是一个光滑的严格正函数，$W_t$ 是一个标准维纳过程。目标稳态密度是多峰的，由 $\\pi(x) \\propto \\exp(-U(x))$ 给出，其势为 $U(x) = \\tfrac{1}{2}(x^2 - 1)^2$，该势在 $x=\\pm 1$ 附近有两个势阱，并在 $x=0$ 附近由一个势垒隔开。为了预处理几何结构以改善越过势垒的能力，同时保持可逆性，我们选择一个位置依赖的扩散 $a(x) = 1 + \\gamma\\,\\exp(-\\kappa x^2)$，其参数 $\\gamma>0$ 和 $\\kappa>0$。这会增加 $x=0$ 附近势垒处的扩散率。\n\n仅使用前向科尔莫戈罗夫（福克-普朗克）方程和细致平衡（可逆性）的定义（即稳态概率流为零），推导出使扩散相对于给定 $\\pi(x)$ 可逆的漂移 $b(x)$。将您的最终答案表示为 $b(x)$ 关于 $x$、$\\gamma$ 和 $\\kappa$ 的单个简化解析表达式。不需要数值近似。", "solution": "该过程始于所提供的一般一维伊藤随机微分方程（SDE）：\n$$dX_t = b(X_t)\\,dt + \\sqrt{2\\,a(X_t)}\\,dW_t$$\n其中 $b(x)$ 是漂移，$a(x)$ 是位置依赖的扩散函数，$W_t$ 是标准维纳过程。\n\n过程 $X_t$ 的概率密度函数 $p(x,t)$ 的演化由前向科尔莫戈罗夫方程（也称为福克-普朗克方程）描述。对于给定的SDE，福克-普朗克方程为：\n$$\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left( b(x)p(x,t) \\right) + \\frac{\\partial^2}{\\partial x^2} \\left( a(x)p(x,t) \\right)$$\n该方程可以表示为连续性方程 $\\frac{\\partial p}{\\partial t} = -\\frac{\\partial J}{\\partial x}$，其中 $J(x,t)$ 是概率流。通过对福克-普朗克方程关于 $x$ 积分一次，我们可以确定概率流为：\n$$J(x,t) = b(x)p(x,t) - \\frac{\\partial}{\\partial x}\\left(a(x)p(x,t)\\right)$$\n在稳态下，概率密度与时间无关，$p(x,t) = \\pi(x)$，其时间导数为零，$\\frac{\\partial \\pi}{\\partial t} = 0$。这意味着稳态概率流 $J_{st}(x)$ 必须是关于 $x$ 的常数。\n$$J_{st}(x) = b(x)\\pi(x) - \\frac{d}{dx}\\left(a(x)\\pi(x)\\right) = \\text{常数}$$\n过程可逆的条件比稳态性更严格。它要求满足细致平衡，这在一维连续过程的背景下，转化为稳态概率流必须处处为零的条件，即对所有 $x$ 都有 $J_{st}(x) = 0$。\n\n将稳态流设为零，我们得到连接漂移 $b(x)$、稳态密度 $\\pi(x)$ 和扩散函数 $a(x)$ 的方程：\n$$b(x)\\pi(x) - \\frac{d}{dx}\\left(a(x)\\pi(x)\\right) = 0$$\n假设 $\\pi(x)>0$，我们可以求解漂移 $b(x)$：\n$$b(x) = \\frac{1}{\\pi(x)} \\frac{d}{dx}\\left(a(x)\\pi(x)\\right)$$\n对项 $\\frac{d}{dx}(a(x)\\pi(x))$ 使用微分的乘法法则，我们得到：\n$$b(x) = \\frac{1}{\\pi(x)} \\left( a'(x)\\pi(x) + a(x)\\pi'(x) \\right) = a'(x) + a(x)\\frac{\\pi'(x)}{\\pi(x)}$$\n其中 $a'(x)$ 和 $\\pi'(x)$ 分别是 $a(x)$ 和 $\\pi(x)$ 关于 $x$ 的导数。\n\n问题指出，目标稳态密度由 $\\pi(x) \\propto \\exp(-U(x))$ 给出。我们可以将其写为 $\\pi(x) = C \\exp(-U(x))$，其中 $C$ 是一个归一化常数。项 $\\frac{\\pi'(x)}{\\pi(x)}$ 可以通过计算 $\\ln(\\pi(x))$ 的导数得到：\n$$\\frac{\\pi'(x)}{\\pi(x)} = \\frac{d}{dx}\\ln(\\pi(x)) = \\frac{d}{dx}\\left(\\ln(C) - U(x)\\right) = -U'(x)$$\n将此结果代入 $b(x)$ 的表达式，得到可逆扩散漂移的一般公式：\n$$b(x) = a'(x) - a(x)U'(x)$$\n现在，我们使用问题陈述中提供的具体函数。势为 $U(x) = \\frac{1}{2}(x^2 - 1)^2$。其导数为：\n$$U'(x) = \\frac{d}{dx}\\left(\\frac{1}{2}(x^4 - 2x^2 + 1)\\right) = \\frac{1}{2}(4x^3 - 4x) = 2x^3 - 2x = 2x(x^2 - 1)$$\n扩散函数为 $a(x) = 1 + \\gamma\\,\\exp(-\\kappa x^2)$。其导数为：\n$$a'(x) = \\frac{d}{dx}\\left(1 + \\gamma\\,\\exp(-\\kappa x^2)\\right) = \\gamma\\,\\exp(-\\kappa x^2)(-2\\kappa x) = -2\\kappa \\gamma x \\exp(-\\kappa x^2)$$\n我们将这些导数以及函数 $a(x)$ 代入 $b(x)$ 的公式中：\n$$b(x) = \\left(-2\\kappa \\gamma x \\exp(-\\kappa x^2)\\right) - \\left(1 + \\gamma\\,\\exp(-\\kappa x^2)\\right)\\left(2x(x^2 - 1)\\right)$$\n为了简化，我们展开第二项：\n$$b(x) = -2\\kappa \\gamma x \\exp(-\\kappa x^2) - 2x(x^2 - 1) - 2\\gamma x(x^2 - 1)\\exp(-\\kappa x^2)$$\n接下来，我们对包含因子 $\\exp(-\\kappa x^2)$ 的项进行分组：\n$$b(x) = -2x(x^2 - 1) - \\left(2\\kappa \\gamma x + 2\\gamma x(x^2 - 1)\\right)\\exp(-\\kappa x^2)$$\n从括号内的表达式中提出公因式 $2\\gamma x$：\n$$b(x) = -2x(x^2 - 1) - 2\\gamma x\\left(\\kappa + (x^2 - 1)\\right)\\exp(-\\kappa x^2)$$\n对括号内的项进行进一步简化得到：\n$$b(x) = -2x(x^2 - 1) - 2\\gamma x(x^2 + \\kappa - 1)\\exp(-\\kappa x^2)$$\n最后，我们可以提出公因式 $-2x$ 来获得漂移 $b(x)$ 的最终简化表达式：\n$$b(x) = -2x\\left[ (x^2 - 1) + \\gamma(x^2 + \\kappa - 1)\\exp(-\\kappa x^2) \\right]$$\n这就是确保SDE相对于稳态分布 $\\pi(x) \\propto \\exp(-U(x))$ 是可逆的漂移函数。", "answer": "$$\n\\boxed{-2x\\left[ (x^2 - 1) + \\gamma(x^2 + \\kappa - 1)\\exp(-\\kappa x^2) \\right]}\n$$", "id": "3072619"}]}