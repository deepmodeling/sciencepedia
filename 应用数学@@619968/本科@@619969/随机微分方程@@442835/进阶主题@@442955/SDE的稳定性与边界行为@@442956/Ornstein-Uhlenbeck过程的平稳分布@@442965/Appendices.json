{"hands_on_practices": [{"introduction": "在深入探讨OU过程的平稳特性之前，我们首先需要掌握如何从其随机微分方程中推导出核心的统计量。这个练习将引导你使用福克-普朗克方程（Fokker-Planck equation）来求解OU过程的平稳分布，并计算其平稳均值和方差。掌握这一核心计算 [@problem_id:3076368]，是你理解该过程为何具有“均值回归”特性，以及如何量化其长期行为的关键一步。", "problem": "考虑由随机微分方程 (SDE) 定义的一维 Ornstein–Uhlenbeck (OU) 过程\n$$\ndX_{t}=-\\theta\\big(X_{t}-\\mu\\big)\\,dt+\\sigma\\,dW_{t},\n$$\n其中 $W_{t}$ 是一个标准布朗运动，$\\theta0$，$\\sigma0$ 和 $\\mu\\in\\mathbb{R}$ 是常数。假设该过程是遍历的，并且在 $\\mathbb{R}$ 上存在一个平稳分布 $\\pi$，其密度为 $p_{\\pi}(x)$。从具有漂移 $b(x)$ 和恒定扩散系数 $\\sigma$ 的一维扩散的前向 Kolmogorov (Fokker–Planck) 方程出发，\n$$\n\\frac{\\partial}{\\partial t}p(x,t)=-\\frac{\\partial}{\\partial x}\\big(b(x)\\,p(x,t)\\big)+\\frac{1}{2}\\sigma^{2}\\,\\frac{\\partial^{2}}{\\partial x^{2}}p(x,t),\n$$\n通过令 $\\frac{\\partial}{\\partial t}p(x,t)=0$ 并施加确保可归一性和无穷远处通量为零的物理上一致的边界条件，来推导平稳密度 $p_{\\pi}(x)$。然后，使用你推导出的 $p_{\\pi}(x)$，以闭合形式计算平稳均值 $\\mathbb{E}_{\\pi}[X]$ 和平稳方差 $\\operatorname{Var}_{\\pi}(X)$。作为交叉检验，你可以通过 Itô 微积分推导平稳矩方程来验证你的结果。将你的最终答案表示为包含 $\\mathbb{E}_{\\pi}[X]$ 和 $\\operatorname{Var}_{\\pi}(X)$ 的单行矩阵。无需四舍五入，也无需包含单位。", "solution": "该问题陈述是随机微分方程理论中的一个标准练习，并被判定为有效。它有科学依据、适定且客观。所有必要的信息都已提供，问题没有矛盾或歧义。\n\n一维 Ornstein-Uhlenbeck (OU) 过程由以下随机微分方程 (SDE) 描述：\n$$\ndX_{t}=-\\theta\\big(X_{t}-\\mu\\big)\\,dt+\\sigma\\,dW_{t}\n$$\n其中 $\\theta0$，$\\sigma0$，$\\mu\\in\\mathbb{R}$，且 $W_{t}$ 是一个标准布朗运动。该 SDE 具有一般形式 $dX_t = b(X_t)dt + \\sqrt{2D(X_t)}dW_t$，其中 $b(x)$ 是漂移函数，$D(x)$ 是扩散函数。在我们的例子中，漂移是 $b(x) = -\\theta(x-\\mu)$，扩散项是恒定的，我们可以写成 $\\sigma = \\sqrt{2D}$，这意味着一个恒定的扩散系数 $D = \\frac{\\sigma^2}{2}$。\n\n过程 $X_t$ 的概率密度函数 $p(x,t)$ 的时间演化由前向 Kolmogorov 方程（也称为 Fokker-Planck 方程）所支配。对于具有漂移 $b(x)$ 和恒定扩散系数（如问题中所给，为 $\\frac{1}{2}\\sigma^2$）的一般一维扩散，该方程为：\n$$\n\\frac{\\partial}{\\partial t}p(x,t)=-\\frac{\\partial}{\\partial x}\\big(b(x)\\,p(x,t)\\big)+\\frac{1}{2}\\sigma^{2}\\,\\frac{\\partial^{2}}{\\partial x^{2}}p(x,t)\n$$\n具有密度 $p_{\\pi}(x)$ 的平稳分布 $\\pi$ 是一个不随时间变化的概率分布。因此，对于平稳密度，我们必须有 $\\frac{\\partial}{\\partial t}p_{\\pi}(x,t) = 0$。用 $p_{\\pi}(x)$ 替换 $p(x,t)$ 并将时间导数设为零，我们得到关于 $p_{\\pi}(x)$ 的一个常微分方程：\n$$\n0 = -\\frac{d}{dx}\\big(b(x)\\,p_{\\pi}(x)\\big)+\\frac{1}{2}\\sigma^{2}\\,\\frac{d^{2}}{dx^{2}}p_{\\pi}(x)\n$$\n该方程可以用概率通量 $J(x)$ 来表示：\n$$\n\\frac{d}{dx}J(x) = 0, \\quad \\text{其中} \\quad J(x) = b(x)p_{\\pi}(x) - \\frac{1}{2}\\sigma^2 \\frac{d p_{\\pi}(x)}{dx}\n$$\n条件 $\\frac{dJ(x)}{dx} = 0$ 意味着通量 $J(x)$ 必须是一个常数。对于一个局限于 $\\mathbb{R}$ 的过程，一个物理上有意义的平稳态要求概率通量在无穷远处为零，即 $\\lim_{x\\to\\pm\\infty} J(x) = 0$。这是因为在边界处不应该有概率净流出或流入系统，以使分布保持平稳。这意味着常数通量必须处处为零，即 $J(x) = 0$。\n\n将通量设为零，得到关于 $p_{\\pi}(x)$ 的一个一阶可分离常微分方程：\n$$\n\\frac{1}{2}\\sigma^2 \\frac{d p_{\\pi}(x)}{dx} = b(x)p_{\\pi}(x)\n$$\n代入 OU 过程的漂移项 $b(x) = -\\theta(x-\\mu)$：\n$$\n\\frac{1}{2}\\sigma^2 \\frac{d p_{\\pi}(x)}{dx} = -\\theta(x-\\mu)p_{\\pi}(x)\n$$\n假设 $p_{\\pi}(x)  0$，我们可以分离变量：\n$$\n\\frac{1}{p_{\\pi}(x)} dp_{\\pi}(x) = -\\frac{2\\theta}{\\sigma^2}(x-\\mu) dx\n$$\n对两边积分，我们得到：\n$$\n\\int \\frac{1}{p_{\\pi}(x)} dp_{\\pi}(x) = \\int -\\frac{2\\theta}{\\sigma^2}(x-\\mu) dx\n$$\n$$\n\\ln(p_{\\pi}(x)) = -\\frac{2\\theta}{\\sigma^2} \\frac{(x-\\mu)^2}{2} + C' = -\\frac{\\theta(x-\\mu)^2}{\\sigma^2} + C'\n$$\n其中 $C'$ 是积分常数。对两边取指数，得到平稳密度的形式：\n$$\np_{\\pi}(x) = \\exp\\left(-\\frac{\\theta(x-\\mu)^2}{\\sigma^2} + C'\\right) = A \\exp\\left(-\\frac{\\theta(x-\\mu)^2}{\\sigma^2}\\right)\n$$\n其中 $A = e^{C'}$ 是一个归一化常数。这个表达式具有高斯（正态）概率密度的形式。均值为 $\\mu_N$、方差为 $\\sigma_N^2$ 的正态密度标准形式是：\n$$\np(x) = \\frac{1}{\\sqrt{2\\pi\\sigma_N^2}} \\exp\\left(-\\frac{(x-\\mu_N)^2}{2\\sigma_N^2}\\right)\n$$\n通过将我们推导出的密度的指数部分与标准形式进行比较，我们可以确定平稳分布的均值和方差。\n$$\n\\frac{(x-\\mu_N)^2}{2\\sigma_N^2} = \\frac{\\theta(x-\\mu)^2}{\\sigma^2}\n$$\n通过这个比较，我们推断出：\n1. 平稳分布的均值是 $\\mu_N = \\mu$。\n2. 方差项给出 $2\\sigma_N^2 = \\frac{\\sigma^2}{\\theta}$，这意味着方差是 $\\sigma_N^2 = \\frac{\\sigma^2}{2\\theta}$。\n\n因此，平稳分布 $\\pi$ 是一个均值为 $\\mu$、方差为 $\\frac{\\sigma^2}{2\\theta}$ 的正态分布，记作 $N(\\mu, \\frac{\\sigma^2}{2\\theta})$。\n\n根据定义，平稳均值 $\\mathbb{E}_{\\pi}[X]$ 和平稳方差 $\\operatorname{Var}_{\\pi}(X)$ 就是这个平稳分布的均值和方差。\n平稳均值是：\n$$\n\\mathbb{E}_{\\pi}[X] = \\mu\n$$\n平稳方差是：\n$$\n\\operatorname{Var}_{\\pi}(X) = \\frac{\\sigma^2}{2\\theta}\n$$\n\n作为交叉检验，我们可以使用 Itô 引理来推导矩方程。对于一阶矩 $m_1(t) = \\mathbb{E}[X_t]$，对 SDE 取期望：\n$$\nd\\mathbb{E}[X_t] = \\mathbb{E}[-\\theta(X_t - \\mu)dt + \\sigma dW_t] = -\\theta(\\mathbb{E}[X_t] - \\mu)dt\n$$\n平稳均值 $m_{1,\\pi} = \\mathbb{E}_{\\pi}[X]$ 必须满足 $\\frac{d m_{1,\\pi}}{dt} = 0$，所以 $-\\theta(m_{1,\\pi}-\\mu)=0$。因为 $\\theta0$，我们有 $m_{1,\\pi} = \\mu$。\n\n对于二阶矩 $m_2(t) = \\mathbb{E}[X_t^2]$，我们使用 $f(x)=x^2$ 的 Itô 公式：\n$$\nd(X_t^2) = 2X_t dX_t + \\frac{1}{2}(2)(dX_t)^2 = 2X_t(-\\theta(X_t-\\mu)dt + \\sigma dW_t) + \\sigma^2 dt\n$$\n$$\nd(X_t^2) = (-2\\theta X_t^2 + 2\\theta\\mu X_t + \\sigma^2)dt + 2\\sigma X_t dW_t\n$$\n取期望：\n$$\nd\\mathbb{E}[X_t^2] = (-2\\theta\\mathbb{E}[X_t^2] + 2\\theta\\mu\\mathbb{E}[X_t] + \\sigma^2)dt\n$$\n平稳二阶矩 $m_{2,\\pi} = \\mathbb{E}_{\\pi}[X^2]$ 满足 $\\frac{d m_{2,\\pi}}{dt}=0$ 并使用 $m_{1,\\pi}=\\mu$：\n$$\n0 = -2\\theta m_{2,\\pi} + 2\\theta\\mu(\\mu) + \\sigma^2 \\implies 2\\theta m_{2,\\pi} = 2\\theta\\mu^2 + \\sigma^2\n$$\n$$\nm_{2,\\pi} = \\mu^2 + \\frac{\\sigma^2}{2\\theta}\n$$\n平稳方差是 $\\operatorname{Var}_{\\pi}(X) = m_{2,\\pi} - (m_{1,\\pi})^2 = \\left(\\mu^2 + \\frac{\\sigma^2}{2\\theta}\\right) - \\mu^2 = \\frac{\\sigma^2}{2\\theta}$。\n两种方法的结果是一致的。\n\n最终答案要求将平稳均值和方差表示为行矩阵。\n平稳均值：$\\mathbb{E}_{\\pi}[X] = \\mu$\n平稳方差：$\\operatorname{Var}_{\\pi}(X) = \\frac{\\sigma^2}{2\\theta}$\n得到的矩阵是 $\\begin{pmatrix} \\mu  \\frac{\\sigma^2}{2\\theta} \\end{pmatrix}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\mu  \\frac{\\sigma^2}{2\\theta} \\end{pmatrix}}\n$$", "id": "3076368"}, {"introduction": "一个常见的误解是认为“平稳”等同于“不相关”或“独立”。然而，一个过程的统计特性不随时间改变，不代表其在不同时刻的取值没有关联。本练习 [@problem_id:3076442] 将通过推导OU过程的自协方差函数，来精确地揭示其时间结构，帮助你理解过程的“记忆”是如何随时间指数衰减的。这不仅澄清了平稳性与独立性的区别，也让你对过程的动态演化有更深刻的认识。", "problem": "考虑由以下随机微分方程定义的 Ornstein–Uhlenbeck 过程\n$$\ndX_t=-\\theta\\,(X_t-\\mu)\\,dt+\\sigma\\,dW_t,\n$$\n其中 $\\theta0$ 和 $\\sigma0$ 是常数，$\\mu\\in\\mathbb{R}$ 是长期均值，$W_t$ 是标准布朗运动。假设该过程是严平稳的；也就是说，它在所有 $t\\in\\mathbb{R}$ 上运行，并且其分布不依赖于 $t$。\n\n仅使用随机微分方程以及均值、方差和协方差的定义，推导平稳方差 $\\operatorname{Var}(X_t)$ 和自协方差函数\n$$\nC(\\tau)=\\operatorname{Cov}(X_t,X_{t+\\tau})\n$$\n对于 $\\tau\\in\\mathbb{R}$。根据您的推导，哪个选项正确地给出了自协方差函数和相应的自相关函数 $\\rho(\\tau)=\\dfrac{C(\\tau)}{\\operatorname{Var}(X_t)}$，从而解决了平稳性意味着独立性这一误解？\n\nA. $C(\\tau)=\\dfrac{\\sigma^2}{2\\theta}\\,e^{-\\theta|\\tau|}$ 且 $\\rho(\\tau)=e^{-\\theta|\\tau|}$，因此该过程是平稳的，但随时间推移不是独立的。\n\nB. 对于所有 $\\tau\\neq 0$，$C(\\tau)=0$ 且 $\\rho(\\tau)=\\mathbf{1}\\{\\tau=0\\}$，因此平稳性意味着随时间推移是独立的。\n\nC. $C(\\tau)=\\sigma^2\\,e^{-\\theta|\\tau|}$ 且 $\\rho(\\tau)=\\dfrac{\\sigma^2\\,e^{-\\theta|\\tau|}}{\\operatorname{Var}(X_t)}$，因此该过程仅在 $\\theta=0$ 时是独立的。\n\nD. $C(\\tau)=\\dfrac{\\sigma^2}{2\\theta}\\,e^{-2\\theta|\\tau|}$ 且 $\\rho(\\tau)=e^{-2\\theta|\\tau|}$，因此相关性以 $2\\theta$ 的速率衰减，且平稳性意味着瞬间消失的弱依赖性。", "solution": "该问题陈述是随机微分方程理论中关于 Ornstein-Uhlenbeck 过程性质的一个标准练习。该问题在科学上是合理的、适定的、客观的，并包含唯一解所需的所有必要信息。因此，我们进行推导。\n\nOrnstein-Uhlenbeck 过程由以下随机微分方程（SDE）描述：\n$$\ndX_t = -\\theta(X_t - \\mu)dt + \\sigma dW_t\n$$\n参数为 $\\theta  0$，$\\sigma  0$ 和 $\\mu \\in \\mathbb{R}$。我们已知该过程是严平稳的。\n\n**步骤 1：平稳均值和中心化过程**\n\n首先，我们确定过程的平稳均值 $\\mathbb{E}[X_t]$。由于过程是平稳的，其均值必须不随时间变化。设 $m = \\mathbb{E}[X_t]$。对 SDE 取期望：\n$$\nd\\mathbb{E}[X_t] = \\mathbb{E}[-\\theta(X_t - \\mu)dt + \\sigma dW_t]\n$$\n利用期望的线性和 $\\mathbb{E}[dW_t] = 0$ 的事实：\n$$\nd(m) = -\\theta(\\mathbb{E}[X_t] - \\mu)dt = -\\theta(m - \\mu)dt\n$$\n由于对于平稳过程，$m$ 是常数，其微分 $d(m)$ 为零。\n$$\n0 = -\\theta(m - \\mu)dt\n$$\n鉴于 $\\theta  0$ 且此式必须对任何 $dt$ 成立，我们得出结论 $m - \\mu = 0$，因此平稳均值为 $\\mathbb{E}[X_t] = \\mu$。\n\n为了简化方差和协方差的计算，我们定义一个均值为零的过程 $Y_t = X_t - \\mu$。注意到由于 $\\mu$ 是常数，$dY_t = dX_t$，因此 $Y_t$ 的 SDE 为：\n$$\ndY_t = -\\theta Y_t dt + \\sigma dW_t\n$$\n$Y_t$ 的统计特性与 $X_t$ 的统计特性直接相关：\n-   均值: $\\mathbb{E}[Y_t] = \\mathbb{E}[X_t - \\mu] = \\mu - \\mu = 0$。\n-   方差: $\\operatorname{Var}(X_t) = \\operatorname{Var}(Y_t + \\mu) = \\operatorname{Var}(Y_t) = \\mathbb{E}[Y_t^2] - (\\mathbb{E}[Y_t])^2 = \\mathbb{E}[Y_t^2]$。\n-   自协方差: $C(\\tau) = \\operatorname{Cov}(X_t, X_{t+\\tau}) = \\operatorname{Cov}(Y_t + \\mu, Y_{t+\\tau} + \\mu) = \\operatorname{Cov}(Y_t, Y_{t+\\tau}) = \\mathbb{E}[Y_t Y_{t+\\tau}]$。\n\n**步骤 2：平稳方差 $\\operatorname{Var}(X_t)$**\n\n我们使用 Itô 引理对函数 $f(y) = y^2$ 应用于过程 $Y_t$，来推导平稳方差 $v = \\operatorname{Var}(X_t) = \\mathbb{E}[Y_t^2]$。我们有 $f'(y) = 2y$ 和 $f''(y) = 2$。\n$Y_t^2$ 的微分为：\n$$\nd(Y_t^2) = f'(Y_t)dY_t + \\frac{1}{2}f''(Y_t)(dY_t)^2 = 2Y_t dY_t + (dY_t)^2\n$$\n项 $(dY_t)^2$ 使用 Itô 微积分法则（$dt^2=0$, $dt dW_t=0$, $dW_t^2=dt$）计算：\n$$\n(dY_t)^2 = (-\\theta Y_t dt + \\sigma dW_t)^2 = \\theta^2 Y_t^2 dt^2 - 2\\theta\\sigma Y_t dt dW_t + \\sigma^2 (dW_t)^2 = \\sigma^2 dt\n$$\n将 $dY_t$ 和 $(dY_t)^2$ 代入 $d(Y_t^2)$ 的表达式中：\n$$\nd(Y_t^2) = 2Y_t(-\\theta Y_t dt + \\sigma dW_t) + \\sigma^2 dt = (-2\\theta Y_t^2 + \\sigma^2)dt + 2\\sigma Y_t dW_t\n$$\n现在，我们取期望。设 $v(t) = \\mathbb{E}[Y_t^2]$。\n$$\nd\\mathbb{E}[Y_t^2] = \\mathbb{E}[(-2\\theta Y_t^2 + \\sigma^2)dt] + \\mathbb{E}[2\\sigma Y_t dW_t]\n$$\n随机积分项的期望为零。因此：\n$$\ndv(t) = (-2\\theta \\mathbb{E}[Y_t^2] + \\sigma^2)dt = (-2\\theta v(t) + \\sigma^2)dt\n$$\n对于平稳过程，方差 $v(t)=v$ 是常数，因此它对时间的导数为零，$\\frac{dv}{dt}=0$。\n$$\n0 = -2\\theta v + \\sigma^2\n$$\n在 $\\theta  0$ 的条件下解出 $v$，我们得到平稳方差：\n$$\n\\operatorname{Var}(X_t) = v = \\frac{\\sigma^2}{2\\theta}\n$$\n\n**步骤 3：自协方差函数 $C(\\tau)$**\n\n为了求出自协方差 $C(\\tau) = \\mathbb{E}[Y_t Y_{t+\\tau}]$，我们首先解出 $Y_t$ 的线性 SDE。对于时间区间 $[t, t+\\tau]$ 且 $\\tau0$， $dY_s = -\\theta Y_s ds + \\sigma dW_s$ 的解是：\n$$\nY_{t+\\tau} = Y_t e^{-\\theta\\tau} + \\sigma \\int_t^{t+\\tau} e^{-\\theta(t+\\tau-s)} dW_s\n$$\n现在我们计算 $C(\\tau) = \\mathbb{E}[Y_t Y_{t+\\tau}]$：\n$$\nC(\\tau) = \\mathbb{E}\\left[Y_t \\left(Y_t e^{-\\theta\\tau} + \\sigma \\int_t^{t+\\tau} e^{-\\theta(t+\\tau-s)} dW_s\\right)\\right]\n$$\n$$\nC(\\tau) = e^{-\\theta\\tau} \\mathbb{E}[Y_t^2] + \\mathbb{E}\\left[Y_t \\cdot \\sigma \\int_t^{t+\\tau} e^{-\\theta(t+\\tau-s)} dW_s\\right]\n$$\n第一项是 $e^{-\\theta\\tau} \\operatorname{Var}(X_t) = e^{-\\theta\\tau} \\frac{\\sigma^2}{2\\theta}$。\n对于第二项，过程值 $Y_t$ 由布朗运动的历史 $\\{W_s\\}_{s \\leq t}$ 决定。Itô 积分 $\\int_t^{t+\\tau} \\dots dW_s$ 依赖于未来的增量 $\\{W_s - W_t\\}_{s  t}$。根据布朗运动的性质，它们是独立的。因此，$Y_t$ 和该积分是独立的。\n$$\n\\mathbb{E}\\left[Y_t \\cdot \\sigma \\int_t^{t+\\tau} e^{-\\theta(t+\\tau-s)} dW_s\\right] = \\mathbb{E}[Y_t] \\cdot \\mathbb{E}\\left[\\sigma \\int_t^{t+\\tau} e^{-\\theta(t+\\tau-s)} dW_s\\right]\n$$\n由于 $\\mathbb{E}[Y_t] = 0$，整个项为零。\n因此，对于 $\\tau  0$：\n$$\nC(\\tau) = e^{-\\theta\\tau} \\frac{\\sigma^2}{2\\theta}\n$$\n由于平稳性意味着 $C(\\tau) = \\operatorname{Cov}(X_t, X_{t+\\tau}) = \\operatorname{Cov}(X_{t-\\tau}, X_t) = C(-\\tau)$，该函数必须是偶函数。我们可以使用绝对值将其推广到任意 $\\tau \\in \\mathbb{R}$：\n$$\nC(\\tau) = \\frac{\\sigma^2}{2\\theta} e^{-\\theta|\\tau|}\n$$\n\n**步骤 4：自相关函数 $\\rho(\\tau)$**\n\n自相关函数定义为 $\\rho(\\tau) = \\frac{C(\\tau)}{\\operatorname{Var}(X_t)}$。使用我们推导出的表达式：\n$$\n\\rho(\\tau) = \\frac{\\frac{\\sigma^2}{2\\theta} e^{-\\theta|\\tau|}}{\\frac{\\sigma^2}{2\\theta}} = e^{-\\theta|\\tau|}\n$$\n\n**步骤 5：评估选项**\n\n现在我们根据我们的推导评估每个选项。\n\n**A. $C(\\tau)=\\dfrac{\\sigma^2}{2\\theta}\\,e^{-\\theta|\\tau|}$ 且 $\\rho(\\tau)=e^{-\\theta|\\tau|}$，因此该过程是平稳的，但随时间推移不是独立的。**\n-   $C(\\tau)$ 的公式与我们的推导结果相符。\n-   $\\rho(\\tau)$ 的公式与我们的推导结果相符。\n-   解释是正确的。根据假设，该过程是平稳的。对于任何 $\\tau \\neq 0$，自相关 $\\rho(\\tau) = e^{-\\theta|\\tau|}$ 是非零的（因为 $\\theta  0$）。非零相关性意味着随机变量 $X_t$ 和 $X_{t+\\tau}$ 在统计上不是独立的。这正确地指出了平稳性并不意味着独立性。\n-   结论：**正确**。\n\n**B. 对于所有 $\\tau\\neq 0$，$C(\\tau)=0$ 且 $\\rho(\\tau)=\\mathbf{1}\\{\\tau=0\\}$，因此平稳性意味着随时间推移是独立的。**\n-   $C(\\tau)$ 的公式不正确。我们推导的 $C(\\tau)$ 对所有 $\\tau$ 都是非零的。$C(\\tau)$ 仅在 $|\\tau| \\to \\infty$ 时趋近于 $0$。\n-   $\\rho(\\tau)$ 的公式也不正确。\n-   “平稳性意味着随时间推移是独立的”这一结论是一个众所周知的误解，对于作为主要反例的 OU 过程来说，这是错误的。\n-   结论：**不正确**。\n\n**C. $C(\\tau)=\\sigma^2\\,e^{-\\theta|\\tau|}$ 且 $\\rho(\\tau)=\\dfrac{\\sigma^2\\,e^{-\\theta|\\tau|}}{\\operatorname{Var}(X_t)}$，因此该过程仅在 $\\theta=0$ 时是独立的。**\n-   $C(\\tau)$ 的公式缺少因子 $\\frac{1}{2\\theta}$。\n-   结论是有缺陷的。问题陈述要求 $\\theta  0$。如果考虑极限 $\\theta \\to 0$，SDE 变为 $dX_t = \\sigma dW_t$，这描述了一个布朗运动。标准布朗运动不是平稳的，因为其方差为 $\\sigma^2 t$。因此，平稳性的前提将被违反。\n-   结论：**不正确**。\n\n**D. $C(\\tau)=\\dfrac{\\sigma^2}{2\\theta}\\,e^{-2\\theta|\\tau|}$ 且 $\\rho(\\tau)=e^{-2\\theta|\\tau|}$，因此相关性以 $2\\theta$ 的速率衰减，且平稳性意味着瞬间消失的弱依赖性。**\n-   $C(\\tau)$ 和 $\\rho(\\tau)$ 中的指数都是 $-2\\theta|\\tau|$，而我们的推导正确地表明它应该是 $-\\theta|\\tau|$。衰减速率是 $\\theta$，而不是 $2\\theta$。\n-   “依赖性瞬间消失”的说法是错误的。相关性随着 $|\\tau| \\to \\infty$ 呈指数衰减至零，但对于任何有限的 $\\tau$ 都是非零的。\n-   结论：**不正确**。\n\n基于全面的分析，只有选项 A 提供了正确的公式和合理的解释。", "answer": "$$\\boxed{A}$$", "id": "3076442"}, {"introduction": "理论的魅力在于它能被实践所检验。这个编程练习 [@problem_id:3076386] 将带你走完从抽象理论到具体数据的完整循环。你将学习如何精确地模拟OU过程的路径，从模拟数据中估计其平稳方差，并使用卡方检验（chi-square test）来验证这个经验值是否与我们之前推导出的理论公式 $\\frac{\\sigma^2}{2\\theta}$ 相符。这不仅是对理论知识的终极检验，更是将数学模型应用于计算和数据科学领域的宝贵实践。", "problem": "考虑由随机微分方程 (SDE) $$dX_t=-\\theta\\,(X_t-\\mu)\\,dt+\\sigma\\,dW_t,$$ 定义的 Ornstein–Uhlenbeck (OU) 过程，其中 $W_t$ 是一个标准布朗运动，$\\theta0$，$\\mu\\in\\mathbb{R}$ 和 $\\sigma0$ 是参数。假设对于足够长的时间，该过程允许一个平稳分布。您的任务是设计一个程序，对于每个指定的参数集，执行以下基于随机微分方程和正态分布统计推断的第一性原理的步骤。\n\n- 使用由线性 SDE 解所隐含的精确离散时间更新方法来模拟 OU 过程，以获得一个长期的样本序列。为了保证可复现性，请使用固定的伪随机种子 $42$。\n- 丢弃初始的老化（burn-in）阶段，以使过程达到平稳状态。然后以恒定的时间步长 $\\Delta$ 收集 $N$ 个连续样本。\n- 通过从数据中估计其均值和方差，将高斯分布拟合到收集的样本上。对均值使用最大似然估计，对方差使用无偏估计量（除数为 $N-1$）。\n- 从第一性原理计算 OU 过程的理论平稳方差，并将其表示为 $v_{\\mathrm{th}}$。\n- 在显著性水平 $\\alpha$ 下进行双边一致性检验，利用一个经过充分检验的事实：对于来自正态分布的样本，统计量 $\\frac{(N-1)\\,s^2}{v}$ 服从自由度为 $N-1$ 的卡方分布，其中 $s^2$ 是无偏样本方差，$v$ 是真实方差。使用卡方分位数构建真实方差的置信区间，并检验 $v_{\\mathrm{th}}$ 是否落在此区间内。返回一个布尔值，指示理论平稳方差是否在拟合方差的抽样误差范围内。\n\n使用以下测试套件。每个测试用例都是一个元组 $(\\theta,\\mu,\\sigma,\\Delta,B,N,x_0)$，其中 $\\theta$ 是均值回归率，$\\mu$ 是长期均值，$\\sigma$ 是扩散尺度，$\\Delta$ 是抽样时间步长，$B$ 是老化时间，$N$ 是收集的样本数量，$x_0$ 是初始条件。\n- 测试用例 $1$：$(\\theta,\\mu,\\sigma,\\Delta,B,N,x_0)=(1.0,0.0,2.0,0.05,50.0,60000,5.0)$\n- 测试用例 $2$：$(\\theta,\\mu,\\sigma,\\Delta,B,N,x_0)=(0.1,3.0,1.5,0.1,200.0,100000,-10.0)$\n- 测试用例 $3$：$(\\theta,\\mu,\\sigma,\\Delta,B,N,x_0)=(5.0,-1.0,0.5,0.01,10.0,50000,0.0)$\n- 测试用例 $4$：$(\\theta,\\mu,\\sigma,\\Delta,B,N,x_0)=(2.0,0.0,0.01,0.1,20.0,120000,100.0)$\n\n将显著性水平设置为 $\\alpha=0.05$。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,result_3,result_4]$），其中每个 $result_i$ 是一个布尔值，指示对于测试用例 $i$，$v_{\\mathrm{th}}$ 是否落在从拟合高斯分布导出的方差的卡方置信区间内。", "solution": "### 解决方案\n\n解决方案是遵循问题陈述中概述的原则和步骤设计的。\n\n#### 1. Ornstein-Uhlenbeck 过程的理论基础\n\nOrnstein-Uhlenbeck (OU) 过程由线性随机微分方程描述：\n$$dX_t = -\\theta(X_t - \\mu)dt + \\sigma dW_t$$\n其中 $\\theta  0$ 是均值回归率，$\\mu$ 是长期均值，$\\sigma  0$ 是波动率的尺度。$W_t$ 是一个标准维纳过程（布朗运动）。\n\n这个 SDE 是可解的。给定在时间 $s$ 的初始条件 $X_s$，该过程在稍后时间 $t  s$ 的值为：\n$$X_t = \\mu + (X_s - \\mu)e^{-\\theta(t-s)} + \\sigma \\int_s^t e^{-\\theta(t-u)}dW_u$$\n积分项 $\\int_s^t e^{-\\theta(t-u)}dW_u$ 是一个 Itô 积分，它表示一个均值为 $0$ 的正态分布随机变量。根据 Itô 等距同构，其方差为：\n$$\\mathbb{E}\\left[\\left(\\int_s^t e^{-\\theta(t-u)}dW_u\\right)^2\\right] = \\int_s^t e^{-2\\theta(t-u)}du = \\frac{1 - e^{-2\\theta(t-s)}}{2\\theta}$$\n因此，对于离散时间步长 $\\Delta = t-s$，$X_t$ 在给定 $X_s$ 下的条件分布是高斯分布：\n$$X_t | X_s \\sim \\mathcal{N}\\left(\\mu + (X_s - \\mu)e^{-\\theta\\Delta}, \\frac{\\sigma^2}{2\\theta}(1 - e^{-2\\theta\\Delta})\\right)$$\n这为模拟过程提供了一个精确的更新规则：\n$$X_{n+1} = \\mu + (X_n - \\mu)e^{-\\theta\\Delta} + \\sqrt{\\frac{\\sigma^2}{2\\theta}(1 - e^{-2\\theta\\Delta})} Z_{n+1}$$\n其中 $Z_{n+1}$ 是独立同分布的标准正态随机变量，$Z_{n+1} \\sim \\mathcal{N}(0, 1)$。该公式将用于模拟。\n\n当时间 $t \\to \\infty$ 时，初始条件的影响会衰减（$e^{-\\theta(t-s)} \\to 0$），过程收敛到一个平稳分布。平稳分布的均值为 $\\mu$，方差收敛于：\n$$ v_{\\mathrm{th}} = \\lim_{t-s \\to \\infty} \\frac{\\sigma^2}{2\\theta}(1 - e^{-2\\theta(t-s)}) = \\frac{\\sigma^2}{2\\theta} $$\n因此，OU 过程的平稳分布是一个正态分布 $\\mathcal{N}(\\mu, v_{\\mathrm{th}})$。这个理论方差 $v_{\\mathrm{th}}$ 将是我们统计检验的对象。\n\n#### 2. 统计验证方法论\n\n程序将为每个测试用例执行以下序列：\n\n1.  **模拟**：我们首先模拟 OU 过程的一条轨迹。为确保样本是从平稳分布中抽取的，我们丢弃模拟的初始部分。老化时间由 $B$ 给出。要丢弃的模拟步数是 $N_B = \\lceil B/\\Delta \\rceil$。在这个老化期之后，我们再模拟 $N$ 步，收集值 $\\{X_1, X_2, \\dots, X_N\\}$。使用固定的伪随机数生成器种子 $42$ 来确保每次运行时生成的随机数序列是相同的，从而使模拟具有可复现性。\n\n2.  **方差估计**：从收集的 $N$ 个样本中，我们估计平稳分布的方差。问题指定使用无偏样本方差 $s^2$，定义为：\n    $$s^2 = \\frac{1}{N-1} \\sum_{i=1}^{N}(X_i - \\bar{X})^2$$\n    其中 $\\bar{X} = \\frac{1}{N}\\sum_{i=1}^{N}X_i$ 是样本均值。\n\n3.  **通过置信区间进行一致性检验**：验证的核心是检查我们估计的方差 $s^2$ 是否与理论方差 $v_{\\mathrm{th}} = \\frac{\\sigma^2}{2\\theta}$ 在统计上一致。对于从真实方差为 $v$ 的正态分布中抽取的 $N$ 个样本，统计量 $\\frac{(N-1)s^2}{v}$ 的抽样分布是自由度为 $df = N-1$ 的卡方分布，即 $\\frac{(N-1)s^2}{v} \\sim \\chi^2_{N-1}$。\n\n    我们可以利用这种关系来构建真实方差 $v$ 的一个 $(1-\\alpha)$ 置信区间。在显著性水平 $\\alpha=0.05$下，我们找到 $\\chi^2_{N-1}$ 分布的下临界值和上临界值，它们在每个尾部切掉的面积为 $\\alpha/2 = 0.025$。设它们为 $c_{\\text{lower}} = \\chi^2_{0.025, N-1}$ 和 $c_{\\text{upper}} = \\chi^2_{0.975, N-1}$。\n    $v$ 的置信区间由以下概率陈述推导得出：\n    $$P\\left(c_{\\text{lower}} \\le \\frac{(N-1)s^2}{v} \\le c_{\\text{upper}}\\right) = 1-\\alpha$$\n    对 $v$ 的不等式进行反转，得到置信区间 $[CI_{\\text{low}}, CI_{\\text{high}}]$：\n    $$CI_{\\text{low}} = \\frac{(N-1)s^2}{c_{\\text{upper}}}, \\quad CI_{\\text{high}} = \\frac{(N-1)s^2}{c_{\\text{lower}}}$$\n    如果理论方差 $v_{\\mathrm{th}}$ 落在此区间内，即 $CI_{\\text{low}} \\le v_{\\mathrm{th}} \\le CI_{\\text{high}}$，则检验通过（返回 `True`）。否则，检验失败（返回 `False`）。\n\n#### 3. 算法实现\n\nPython 脚本实现了这个逻辑。一个主函数 `solve()` 遍历提供的测试用例。对于每个用例，一个辅助函数将：\n1.  使用指定的种子 $42$ 初始化一个随机数生成器。对每个案例都这样做，以确保独立且可复现的测试。\n2.  解包参数 $(\\theta, \\mu, \\sigma, \\Delta, B, N, x_0)$。\n3.  计算老化步数 $N_B = \\text{int(np.ceil}(B/\\Delta)\\text{)}$。\n4.  生成模拟所需的 $N_B + N$ 个标准正态随机变量。\n5.  使用精确的更新规则运行模拟，首先进行 $N_B$ 步（丢弃结果），然后进行 $N$ 步（存储结果）。\n6.  使用 `numpy.var(ddof=1)` 从存储的样本中计算无偏样本方差 $s^2$。\n7.  计算理论方差 $v_{\\mathrm{th}} = \\sigma^2 / (2\\theta)$。\n8.  使用 `scipy.stats.chi2.ppf` 找到卡方临界值 $c_{\\text{lower}}$ 和 $c_{\\text{upper}}$。\n9.  计算置信区间边界 $CI_{\\text{low}}$ 和 $CI_{\\text{high}}$。\n10. 返回检验的布尔结果 $v_{\\mathrm{th}} \\in [CI_{\\text{low}}, CI_{\\text{high}}]$。\n\n最终结果被收集到一个列表中，并以所需格式打印。", "answer": "```python\nimport numpy as np\nfrom scipy.stats import chi2\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to run the Ornstein-Uhlenbeck process simulation and validation\n    for a suite of test cases.\n    \"\"\"\n    \n    # Each test case is a tuple:\n    # (theta, mu, sigma, delta_t, B, N, x0)\n    # theta: mean-reversion rate\n    # mu: long-run mean\n    # sigma: diffusion scale\n    # delta_t: sampling time step\n    # B: burn-in time\n    # N: number of collected samples\n    # x0: initial condition\n    test_cases = [\n        (1.0, 0.0, 2.0, 0.05, 50.0, 60000, 5.0),\n        (0.1, 3.0, 1.5, 0.1, 200.0, 100000, -10.0),\n        (5.0, -1.0, 0.5, 0.01, 10.0, 50000, 0.0),\n        (2.0, 0.0, 0.01, 0.1, 20.0, 120000, 100.0)\n    ]\n\n    alpha = 0.05\n    results = []\n\n    for case in test_cases:\n        result = run_ou_validation(case, alpha)\n        results.append(result)\n\n    # Format the output as a comma-separated list of booleans in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_ou_validation(case_params, alpha):\n    \"\"\"\n    Performs the OU process simulation and statistical validation for a single case.\n    \n    Args:\n        case_params (tuple): A tuple containing the parameters for the simulation.\n        alpha (float): The significance level for the consistency check.\n        \n    Returns:\n        bool: True if the theoretical variance is within the confidence interval\n              of the sample variance, False otherwise.\n    \"\"\"\n    theta, mu, sigma, delta_t, B, N, x0 = case_params\n\n    # Set a fixed seed for reproducibility for each test case.\n    rng = np.random.default_rng(42)\n\n    # 1. Simulate the OU process using the exact discrete-time update.\n    # The number of burn-in steps islceil(B / delta_t).\n    n_burn = int(math.ceil(B / delta_t))\n    total_steps = n_burn + N\n    \n    # Pre-calculate constants for the update rule for efficiency.\n    # X_{n+1} = mu + (X_n - mu)*exp(-theta*dt) + noise\n    # where noise is a Gaussian with mean 0 and variance V.\n    exp_term = math.exp(-theta * delta_t)\n    var_term = (sigma**2 / (2 * theta)) * (1 - math.exp(-2 * theta * delta_t))\n    std_dev_term = math.sqrt(var_term)\n\n    # Generate all required random numbers at once.\n    z_variates = rng.normal(size=total_steps)\n    \n    samples = np.zeros(N)\n    x_current = float(x0)\n\n    # Burn-in period\n    for i in range(n_burn):\n        x_current = mu + (x_current - mu) * exp_term + std_dev_term * z_variates[i]\n\n    # Sampling period\n    for i in range(N):\n        x_current = mu + (x_current - mu) * exp_term + std_dev_term * z_variates[n_burn + i]\n        samples[i] = x_current\n\n    # 2. Fit a Gaussian: compute the unbiased sample variance (s^2).\n    # ddof=1 provides the unbiased estimator for the variance.\n    sample_variance = np.var(samples, ddof=1)\n\n    # 3. Compute the theoretical stationary variance (v_th).\n    theoretical_variance = sigma**2 / (2 * theta)\n    \n    # 4. Perform the consistency check.\n    # The statistic (N-1)*s^2 / v follows a chi-square distribution with N-1 degrees of freedom.\n    # We construct a (1-alpha) confidence interval for the true variance v.\n    df = N - 1\n    \n    # Find the critical values of the chi-square distribution.\n    # ppf is the percent point function (inverse of cdf).\n    chi2_lower_critical = chi2.ppf(alpha / 2, df)\n    chi2_upper_critical = chi2.ppf(1 - alpha / 2, df)\n    \n    # Construct the confidence interval for the true variance.\n    # [ (df * s^2) / chi2_upper, (df * s^2) / chi2_lower ]\n    ci_lower_bound = (df * sample_variance) / chi2_upper_critical\n    ci_upper_bound = (df * sample_variance) / chi2_lower_critical\n    \n    # Check if the theoretical variance lies within the confidence interval.\n    is_consistent = (theoretical_variance >= ci_lower_bound) and (theoretical_variance = ci_upper_bound)\n    \n    return is_consistent\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3076386"}]}