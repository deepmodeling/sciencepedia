{"hands_on_practices": [{"introduction": "理解和应用李雅普诺夫函数（Lyapunov function）是证明随机微分方程（SDE）解非爆炸性的核心技能。这个基础练习将引导你为一个具体的SDE计算其无穷小生成元（infinitesimal generator），并应用一个简单的二次李雅普诺夫函数来证明其全局解的存在性。通过这个练习[@problem_id:3068503]，你将对这一强大工具的运作机制有一个清晰的认识，即寻找一个随状态增长的函数，其期望变化率却受到抑制，从而将过程“困”在有限空间内。", "problem": "设 $\\{W_{t}\\}_{t \\geq 0}$ 为一维标准布朗运动，并考虑具有确定性初始条件 $X_{0} = x_{0} \\in \\mathbb{R}$ 的一维随机微分方程 (SDE)：\n$$\n\\mathrm{d}X_{t} = b(X_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t}, \\quad \\text{其中 } b(x) = -x^{3} \\text{ 且 } \\sigma(x) = x^{2}.\n$$\n定义爆炸时间 $\\tau_{\\infty} = \\lim_{R \\to \\infty} \\tau_{R}$，其中 $\\tau_{R} = \\inf\\{t \\geq 0 : |X_{t}| \\geq R\\}$ 是从区间 $(-R, R)$ 的离开时间。从 Itô 扩散、通过 Itô 公式构造的无穷小生成元以及强制 $C^{2}$ Lyapunov 函数的概念出发，通过对应用于一个合适的 Lyapunov 函数的生成元进行定界，为上述 SDE 推导一个非爆炸准则。特别地，对于选择 $V(x) = 1 + x^{2}$，确定最小的非负常数 $c$，使得不等式\n$$\nL V(x) \\leq c\\big(1 + V(x)\\big) \\quad \\text{对所有 } x \\in \\mathbb{R}\n$$\n成立，其中 $L$ 表示与该 SDE 相关联的无穷小生成元。使用此界限来解释为何 $\\tau_{\\infty} = +\\infty$ 几乎必然成立，但最终答案只需报告这个最小 $c$ 的值。你的最终答案必须是一个不带单位的实数。不需要进行四舍五入。", "solution": "问题要求我们确定满足一个特定不等式的最小非负常数 $c$，该不等式涉及一个给定随机微分方程 (SDE) 的无穷小生成元，并利用此结果得出解不会爆炸的结论。\n\n该 SDE 由下式给出\n$$\n\\mathrm{d}X_{t} = b(X_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t}\n$$\n初始条件为 $X_{0} = x_{0} \\in \\mathbb{R}$，其中 $\\{W_{t}\\}_{t \\geq 0}$ 是一维标准布朗运动。漂移系数和扩散系数分别为 $b(x) = -x^{3}$ 和 $\\sigma(x) = x^{2}$。\n\n对于一维 Itô 扩散和一个函数 $f \\in C^{2}(\\mathbb{R})$，无穷小生成元 $L$ 定义为：\n$$\nL f(x) = b(x) \\frac{\\mathrm{d}f}{\\mathrm{d}x}(x) + \\frac{1}{2} \\sigma(x)^{2} \\frac{\\mathrm{d}^{2}f}{\\mathrm{d}x^{2}}(x)\n$$\n代入给定的系数，该 SDE 的生成元为：\n$$\nL f(x) = (-x^{3}) \\frac{\\mathrm{d}f}{\\mathrm{d}x}(x) + \\frac{1}{2} (x^{2})^{2} \\frac{\\mathrm{d}^{2}f}{\\mathrm{d}x^{2}}(x) = -x^{3} f'(x) + \\frac{1}{2} x^{4} f''(x)\n$$\n\n我们给定具体的 Lyapunov 函数 $V(x) = 1 + x^{2}$。该函数属于 $C^{2}(\\mathbb{R})$ 类。我们计算其一阶和二阶导数：\n$$\nV'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}(1 + x^{2}) = 2x\n$$\n$$\nV''(x) = \\frac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}(1 + x^{2}) = 2\n$$\n现在，我们将生成元 $L$ 应用于 $V(x)$：\n$$\nL V(x) = -x^{3} V'(x) + \\frac{1}{2} x^{4} V''(x) = -x^{3}(2x) + \\frac{1}{2} x^{4}(2)\n$$\n$$\nL V(x) = -2x^{4} + x^{4} = -x^{4}\n$$\n问题要求找到最小的非负常数 $c$，使得以下不等式对所有 $x \\in \\mathbb{R}$ 成立：\n$$\nL V(x) \\leq c\\big(1 + V(x)\\big)\n$$\n代入 $L V(x)$ 和 $V(x)$ 的表达式：\n$$\n-x^{4} \\leq c\\big(1 + (1 + x^{2})\\big)\n$$\n$$\n-x^{4} \\leq c(2 + x^{2})\n$$\n由于对所有 $x \\in \\mathbb{R}$，$2 + x^{2}$ 恒为正，我们可以用它来除不等式两边而不用改变不等号的方向：\n$$\n\\frac{-x^{4}}{2 + x^{2}} \\leq c\n$$\n这个不等式必须对所有 $x \\in \\mathbb{R}$ 成立。因此，$c$ 必须大于或等于函数 $g(x) = \\frac{-x^{4}}{2 + x^{2}}$ 在 $\\mathbb{R}$ 上的上确界。\n$$\nc \\geq \\sup_{x \\in \\mathbb{R}} \\left( \\frac{-x^{4}}{2 + x^{2}} \\right)\n$$\n我们来分析函数 $g(x)$。对所有 $x$，分子 $-x^{4}$ 是非正的，且分母 $2+x^{2}$ 恒为正。因此，对所有 $x \\in \\mathbb{R}$，$g(x) \\leq 0$。最大值在 $x=0$ 处取得，此时 $g(0) = 0$。对于任何 $x \\neq 0$，$g(x)$ 严格为负。\n因此，上确界为：\n$$\n\\sup_{x \\in \\mathbb{R}} g(x) = 0\n$$\n对 $c$ 的条件变为 $c \\geq 0$。问题要求满足此条件的最小*非负*常数 $c$。有效常数的集合是 $[0, \\infty)$。该集合中的最小值为 $c=0$。\n\n为了解释为何这意味着解不会爆炸（即 $\\tau_{\\infty} = +\\infty$ 几乎必然），我们使用基于此 Lyapunov 函数的标准论证。当 $c=0$ 时，不等式为 $LV(x) \\leq 0$。函数 $V(x) = 1+x^2$ 是一个强制函数，意味着当 $|x| \\to \\infty$ 时 $V(x) \\to \\infty$。\n\n根据 Itô 公式，对于任意停时 $\\tau$：\n$$\n\\mathbb{E}[V(X_{t \\wedge \\tau})] = V(x_{0}) + \\mathbb{E}\\left[\\int_{0}^{t \\wedge \\tau} L V(X_{s}) \\, \\mathrm{d}s\\right]\n$$\n在适当的条件下，随机积分项的期望为零，对于停时过程，这些条件在此成立。\n由于 $L V(x) = -x^{4} \\leq 0$，积分项是非正的。因此，\n$$\n\\mathbb{E}[V(X_{t \\wedge \\tau})] \\leq V(x_{0})\n$$\n令 $\\tau = \\tau_{R} = \\inf\\{t \\geq 0 : |X_{t}| \\geq R\\}$。\n在事件 $\\{\\tau_{R} \\leq t\\}$ 上，我们有 $|X_{\\tau_R}| = R$，所以 $V(X_{\\tau_R}) = 1+R^2$。根据 $V$ 的非负性，我们可以写出：\n$$\n\\mathbb{E}[V(X_{t \\wedge \\tau_{R}})] \\geq \\mathbb{E}[V(X_{t \\wedge \\tau_{R}}) \\cdot \\mathbf{1}_{\\{\\tau_{R} \\leq t\\}}] = \\mathbb{E}[V(X_{\\tau_{R}}) \\cdot \\mathbf{1}_{\\{\\tau_{R} \\leq t\\}}] = (1+R^{2})\\mathbb{P}(\\tau_{R} \\leq t)\n$$\n结合这些不等式：\n$$\n(1+R^{2})\\mathbb{P}(\\tau_{R} \\leq t) \\leq \\mathbb{E}[V(X_{t \\wedge \\tau_{R}})] \\leq V(x_{0}) = 1+x_{0}^{2}\n$$\n这给出了在时间 $t$ 之前离开区间 $(-R, R)$ 的概率的一个上界：\n$$\n\\mathbb{P}(\\tau_{R} \\leq t) \\leq \\frac{1+x_{0}^{2}}{1+R^{2}}\n$$\n当 $R \\to \\infty$ 时取极限：\n$$\n\\lim_{R \\to \\infty} \\mathbb{P}(\\tau_{R} \\leq t) = 0\n$$\n爆炸时间为 $\\tau_{\\infty} = \\lim_{R \\to \\infty} \\tau_{R}$。在时间 $t$ 之前发生爆炸的事件是 $\\{\\tau_{\\infty} \\leq t\\} = \\bigcap_{n \\in \\mathbb{N}} \\{\\tau_{n} \\leq t\\}$。根据概率对此嵌套事件序列的连续性：\n$$\n\\mathbb{P}(\\tau_{\\infty} \\leq t) = \\lim_{R \\to \\infty} \\mathbb{P}(\\tau_{R} \\leq t) = 0\n$$\n这对任何有限的 $t > 0$ 都成立。在有限时间内爆炸的概率是 $\\mathbb{P}(\\tau_{\\infty}  \\infty) = \\mathbb{P}\\left(\\bigcup_{n=1}^{\\infty} \\{\\tau_{\\infty} \\leq n\\}\\right) \\leq \\sum_{n=1}^{\\infty} \\mathbb{P}(\\tau_{\\infty} \\leq n) = \\sum_{n=1}^{\\infty} 0 = 0$。\n因此，$\\mathbb{P}(\\tau_{\\infty} = \\infty) = 1$，且解几乎必然不会爆炸。建立此结论所需的最小非负常数为 $c=0$。", "answer": "$$\n\\boxed{0}\n$$", "id": "3068503"}, {"introduction": "当SDE的系数呈现超线性增长时，标准的非爆炸性条件便不再适用，这要求我们使用更精巧的李雅普诺夫函数。此问题[@problem_id:3068512]旨在训练你处理这类更具挑战性情况的能力。你将学习如何通过分析生成元中各项的增长阶数，来构造一个恰当的李雅普诺夫函数，其形式经过精心设计，能够正好抵消掉系数中的爆炸性增长项，从而证明解的非爆炸性。", "problem": "考虑一维随机微分方程 (SDE)\n$$\n\\mathrm{d}X_{t}=\\big(X_{t}-X_{t}^{3}\\big)\\,\\mathrm{d}t+\\big(1+X_{t}^{2}\\big)\\,\\mathrm{d}W_{t},\\qquad X_{0}=x\\in\\mathbb{R},\n$$\n该方程由标准一维布朗运动 (BM) $\\{W_{t}\\}_{t\\geq 0}$ 驱动。对于 $n\\in\\mathbb{N}$，将半径为 $n$ 的球的首次出时定义为\n$$\n\\tau_{n}=\\inf\\{t\\geq 0:\\,|X_{t}|\\geq n\\},\\qquad \\tau_{\\infty}=\\lim_{n\\to\\infty}\\tau_{n}.\n$$\n从强解直至爆炸时间的定义、Itô 公式和停时的性质出发，从第一性原理推导出一个 Lyapunov 型估计，以排除有限时间内的爆炸。然后推导出以下概率的值\n$$\n\\mathbb{P}_{x}\\big(\\tau_{\\infty}=\\infty\\big),\n$$\n其中 $\\mathbb{P}_{x}$ 表示从 $X_{0}=x$ 开始的过程的定律。你的最终答案必须是这个概率，表示为一个单独的数字。任何中间不等式或方程都不能作为最终答案。如果你选择计算一个数值，请给出精确值；无需四舍五入。", "solution": "该问题要求计算给定随机微分方程 (SDE) 的解在有限时间内不发生爆炸的概率。该 SDE 为\n$$\n\\mathrm{d}X_{t}=\\big(X_{t}-X_{t}^{3}\\big)\\,\\mathrm{d}t+\\big(1+X_{t}^{2}\\big)\\,\\mathrm{d}W_{t},\n$$\n初始条件为 $X_{0}=x\\in\\mathbb{R}$。漂移系数为 $b(x)=x-x^3$，扩散系数为 $\\sigma(x)=1+x^2$。强解存在且唯一，直至爆炸时间 $\\tau_{\\infty} = \\lim_{n\\to\\infty} \\tau_n$，其中 $\\tau_n = \\inf\\{t \\ge 0 : |X_t| \\ge n\\}$。我们想要确定 $\\mathbb{P}_x(\\tau_\\infty = \\infty)$ 的值。\n\n非爆炸的标准条件要求系数具有线性增长性，即存在某个常数 $C0$，使得 $|b(x)| + |\\sigma(x)| \\leq C(1+|x|)$。在这里，当 $|x|$ 很大时，有 $|b(x)| \\sim |x|^3$ 和 $|\\sigma(x)| \\sim |x|^2$，所以这些条件不满足。因此，我们必须使用一种更精细的方法，例如 Lyapunov 函数。\n\n非爆炸的一个充分条件是存在一个二阶连续可微函数 $V: \\mathbb{R} \\to [0, \\infty)$，称为 Lyapunov 函数，使得当 $|x| \\to \\infty$ 时 $V(x) \\to \\infty$，并且该 SDE 的生成元 $L$ 对 $V$ 的作用是受控的。生成元 $L$ 由下式给出\n$$\nL = b(x) \\frac{\\mathrm{d}}{\\mathrm{d}x} + \\frac{1}{2} \\sigma(x)^2 \\frac{\\mathrm{d}^2}{\\mathrm{d}x^2}.\n$$\n具体来说，如果存在这样一个 $V$ 和一个常数 $K \\ge 0$，使得对于所有 $x \\in \\mathbb{R}$，都有 $LV(x) \\le K V(x)$，那么解就是非爆炸的。\n\n对于我们的 SDE，生成元是\n$$\nL = (x-x^3) \\frac{\\mathrm{d}}{\\mathrm{d}x} + \\frac{1}{2} (1+x^2)^2 \\frac{\\mathrm{d}^2}{\\mathrm{d}x^2}.\n$$\n我们寻找一个合适的 Lyapunov 函数 $V(x)$。让我们尝试一个形式为 $V(x) = (1+x^2)^\\alpha$ 的函数，其中 $\\alpha  0$。这个函数满足当 $|x| \\to \\infty$ 时 $V(x) \\to \\infty$。我们计算它的导数：\n$$\nV'(x) = \\frac{\\mathrm{d}V}{\\mathrm{d}x} = 2\\alpha x (1+x^2)^{\\alpha-1}\n$$\n$$\nV''(x) = \\frac{\\mathrm{d}^2V}{\\mathrm{d}x^2} = 2\\alpha(1+x^2)^{\\alpha-1} + 2\\alpha x (\\alpha-1)(1+x^2)^{\\alpha-2}(2x) = 2\\alpha(1+x^2)^{\\alpha-2}\\big( (1+x^2) + 2(\\alpha-1)x^2 \\big) = 2\\alpha(1+x^2)^{\\alpha-2}\\big( 1 + (2\\alpha-1)x^2 \\big).\n$$\n现在我们将生成元 $L$ 应用于 $V(x)$：\n$$\nLV(x) = (x-x^3) \\big(2\\alpha x (1+x^2)^{\\alpha-1}\\big) + \\frac{1}{2} (1+x^2)^2 \\big(2\\alpha(1+x^2)^{\\alpha-2}(1 + (2\\alpha-1)x^2)\\big)\n$$\n$$\nLV(x) = 2\\alpha x^2(1-x^2)(1+x^2)^{\\alpha-1} + \\alpha(1+x^2)^{\\alpha}\\big(1+(2\\alpha-1)x^2\\big)\n$$\n提取公因式 $\\alpha(1+x^2)^{\\alpha-1}$：\n$$\nLV(x) = \\alpha(1+x^2)^{\\alpha-1} \\left[ 2x^2(1-x^2) + (1+x^2)\\big(1+(2\\alpha-1)x^2\\big) \\right]\n$$\n展开方括号内的项：\n$$\n[\\dots] = (2x^2-2x^4) + (1 + (2\\alpha-1)x^2+x^2+(2\\alpha-1)x^4)\n$$\n$$\n[\\dots] = 1 + (2+2\\alpha-1+1)x^2 + (-2+2\\alpha-1)x^4 = 1 + (2+2\\alpha)x^2 + (2\\alpha-3)x^4.\n$$\n所以，我们有：\n$$\nLV(x) = \\alpha(1+x^2)^{\\alpha-1} \\big( 1 + 2(1+\\alpha)x^2 + (2\\alpha-3)x^4 \\big).\n$$\n对于大的 $|x|$，项 $(2\\alpha-3)x^4$ 占主导地位。如果 $2\\alpha-3  0$，那么 $LV(x)$ 的增长速度比 $V(x)$ 快（$V(x)$ 的增长类似于 $(x^2)^\\alpha = x^{2\\alpha}$，而 $LV(x)$ 的增长类似于 $(x^2)^{\\alpha-1} x^4 = x^{2\\alpha+2}$）。为了控制增长，我们选择 $\\alpha$ 使得 $x$ 的最高次幂被消除。我们将 $x^4$ 的系数设为零：\n$$\n2\\alpha-3=0 \\implies \\alpha = \\frac{3}{2}.\n$$\n我们选择 $V(x) = (1+x^2)^{3/2}$。对于这个特定的 $V(x)$，$LV(x)$ 的表达式显著简化为：\n$$\nLV(x) = \\frac{3}{2}(1+x^2)^{1/2} \\left( 1 + 2(1+\\frac{3}{2})x^2 \\right) = \\frac{3}{2}(1+x^2)^{1/2} (1+5x^2).\n$$\n我们现在检查是否存在某个常数 $K$，使得 $LV(x) \\le K V(x)$。\n$$\n\\frac{LV(x)}{V(x)} = \\frac{\\frac{3}{2}(1+x^2)^{1/2} (1+5x^2)}{(1+x^2)^{3/2}} = \\frac{\\frac{3}{2}(1+5x^2)}{1+x^2}.\n$$\n令 $y=x^2 \\ge 0$。我们考虑函数 $f(y) = \\frac{1+5y}{1+y} = \\frac{5(1+y)-4}{1+y} = 5 - \\frac{4}{1+y}$。对于 $y \\ge 0$，这个函数从 $f(0)=1$ 递增到 $\\lim_{y\\to\\infty} f(y) = 5$。因此，它的值在 $[1, 5)$ 上有界。\n这意味着\n$$\n\\frac{LV(x)}{V(x)} = \\frac{3}{2} f(x^2) \\le \\frac{3}{2} \\cdot 5 = \\frac{15}{2}.\n$$\n因此，我们找到了一个 Lyapunov 函数 $V(x)=(1+x^2)^{3/2}$，它满足 $LV(x) \\le K V(x)$，其中 $K = \\frac{15}{2}$。\n\n现在我们用这个结果来证明非爆炸性。令 $t0$ 为任意固定时间。考虑在时间 $\\tau_n$ 停时的过程 $X_{s \\wedge \\tau_n}$。将 Itô 公式应用于 $V(X_t)$：\n$$\nV(X_{t \\wedge \\tau_n}) - V(X_0) = \\int_0^{t \\wedge \\tau_n} LV(X_s)\\,\\mathrm{d}s + \\int_0^{t \\wedge \\tau_n} V'(X_s)\\sigma(X_s)\\,\\mathrm{d}W_s.\n$$\n随机积分项是一个局部鞅。对于停时过程，因为在时间 $\\tau_n$ 之前 $|X_s|$ 有界，所以被积函数 $V'(X_s)\\sigma(X_s)$ 也有界，这确保了随机积分为一个（真正的）鞅，其期望为零。因此：\n$$\n\\mathbb{E}[V(X_{t \\wedge \\tau_n})] = V(x_0) + \\mathbb{E}\\left[\\int_0^{t \\wedge \\tau_n} LV(X_s)\\,\\mathrm{d}s\\right]\n$$\n利用我们导出的界 $LV(x) \\le K V(x)$（其中 $K=15/2$），我们得到：\n$$\n\\mathbb{E}[V(X_{t \\wedge \\tau_n})] \\le V(x_0) + K \\mathbb{E}\\left[\\int_0^{t \\wedge \\tau_n} V(X_s)\\,\\mathrm{d}s\\right] = V(x_0) + K \\int_0^t \\mathbb{E}[V(X_{s \\wedge \\tau_n})]\\,\\mathrm{d}s\n$$\n根据格朗沃尔不等式（Gronwall's inequality），这蕴含着：\n$$\n\\mathbb{E}[V(X_{t \\wedge \\tau_n})] \\le V(x_0) e^{Kt}\n$$\n另一方面，通过使用马尔可夫不等式和 $V$ 的定义：\n$$\n\\mathbb{E}[V(X_{t \\wedge \\tau_n})] \\ge \\mathbb{E}[V(X_{t \\wedge \\tau_n}) \\mathbf{1}_{\\{\\tau_n \\le t\\}}] \\ge V(n) \\mathbb{P}(\\tau_n \\le t)\n$$\n因为在事件 $\\{\\tau_n \\le t\\}$ 上，$|X_{\\tau_n}| \\ge n$，所以 $V(X_{\\tau_n}) = (1+|X_{\\tau_n}|^2)^{3/2} \\ge (1+n^2)^{3/2} = V(n)$。\n结合这两个不等式，我们得到：\n$$\nV(n) \\mathbb{P}(\\tau_n \\le t) \\le V(x_0) e^{Kt}\n$$\n因此，\n$$\n\\mathbb{P}(\\tau_n \\le t) \\le \\frac{V(x_0) e^{Kt}}{V(n)}\n$$\n由于当 $n \\to \\infty$ 时，$V(n)=(1+n^2)^{3/2} \\to \\infty$，我们有：\n$$\n\\lim_{n\\to\\infty} \\mathbb{P}(\\tau_n \\le t) = 0\n$$\n由于这对任何 $t > 0$ 都成立，我们得出在任何有限时间内发生爆炸的概率为零。在形式上，爆炸事件是 $\\{\\tau_\\infty  \\infty\\} = \\bigcup_{k=1}^\\infty \\{\\tau_\\infty \\le k\\}$。由于 $\\mathbb{P}(\\tau_\\infty \\le k) = \\lim_{n\\to\\infty} \\mathbb{P}(\\tau_n \\le k) = 0$，我们有 $\\mathbb{P}(\\tau_\\infty  \\infty) = 0$。\n因此，解几乎必然不会在有限时间内爆炸：\n$$\n\\mathbb{P}_x(\\tau_\\infty = \\infty) = 1 - \\mathbb{P}_x(\\tau_\\infty  \\infty) = 1\n$$", "answer": "$$\\boxed{1}$$", "id": "3068512"}, {"introduction": "理论证明为我们提供了严格的保证，但数值模拟能给予我们关于解的行为的直观理解。这个编程实践[@problem_id:3068502]旨在通过计算实验来连接抽象理论与具体实践。通过实现欧拉-丸山（Euler–Maruyama）方法并观察不同SDEs的样本路径，你将能亲眼看到满足线性增长条件的解与可能发生爆炸的解在行为上的显著差异，从而加深对非爆炸性这一概念的直观感受。", "problem": "考虑定义在时间区间 $[0,T]$ 上的一维随机微分方程（SDE）：\n$$\n\\mathrm{d}X_t = b(X_t)\\,\\mathrm{d}t + \\sigma(X_t)\\,\\mathrm{d}W_t,\\quad X_0 = x_0,\n$$\n其中 $W_t$ 表示布朗运动（也称为维纳过程），$b:\\mathbb{R}\\to\\mathbb{R}$ 是漂移系数，$\\sigma:\\mathbb{R}\\to\\mathbb{R}$ 是扩散系数。如果解在有限时间内变得无界，则称其为爆炸；更精确地说，爆炸时间为：\n$$\n\\tau_e := \\inf\\{t\\ge 0:\\,|X_t|=+\\infty\\}.\n$$\n解的非爆炸性是通过对 $b$ 和 $\\sigma$ 的增长性和正则性假设来研究的一个基本性质。一个经典的非爆炸性充分条件是，$b$ 和 $\\sigma$ 是局部利普希茨的，并且满足以下形式的线性增长界：\n$$\n|b(x)| + |\\sigma(x)| \\le K(1+|x|)\n$$\n对于某个常数 $K0$ 和所有 $x\\in\\mathbb{R}$ 成立。在此类条件下，强解全局存在且不爆炸。\n\n您的任务是使用欧拉-丸山（Euler–Maruyama）离散化方法实现一个数值合理性检查，以深入了解非爆炸性。对于给定的 $b$ 和 $\\sigma$，模拟样本路径并计算路径在终端时刻之前触及一个大阈值的经验概率。触及一个大的有限阈值与数学上的爆炸不同，但在数值上，它为极端增长提供了一个有用的指标。对于每个测试用例，执行以下操作。\n\n1. 使用欧拉-丸山格式：\n$$\nX_{n+1} = X_n + b(X_n)\\,\\Delta t + \\sigma(X_n)\\,\\Delta W_n,\n$$\n其中 $\\Delta W_n \\sim \\mathcal{N}(0,\\Delta t)$ 是独立的服从正态分布的增量，$\\Delta t$ 是时间步长，$n$ 是离散时间的索引，$t_n=n\\,\\Delta t$。\n\n2. 定义一个大的有限阈值 $M0$。对于每个模拟路径，一旦 $|X_n|\\ge M$ 就宣告数值阈值被触及，并记录这是否发生在时间 $T$ 之前。\n\n3. 对 $N$ 条独立路径重复此过程，并计算经验触及概率（以小数形式，而非百分比），即：\n$$\np := \\frac{\\text{在时间 }T\\text{ 前触及阈值的路径数}}{N}.\n$$\n\n4. 独立于模拟，评估给定的 $b$ 和 $\\sigma$ 的参数形式是否满足线性增长条件。在这个问题中，系数将是以下形式的多项式：\n$$\nb(x) = a\\,x^p,\\quad \\sigma(x) = c\\,x^q,\n$$\n其中参数 $a, c$ 为实数，指数 $p, q$ 为非负数。对于这些多项式形式，检查线性增长的一个充分条件是 $p\\le 1$ 和 $q\\le 1$。如果 $p\\le 1$ 且 $q\\le 1$，则将布尔标志 $\\text{LG}$ 声明为 $1$ (True)，否则为 $0$ (False)。注意，多项式系数是光滑的，因此在 $\\mathbb{R}$ 上是局部利普希茨的，所以线性增长检查足以表明标准条件是否满足。\n\n实现程序以运行以下参数值的测试套件。每个测试用例是一个元组 $(a,p,c,q,x_0,T,\\Delta t,M,N)$：\n\n- 测试 1（稳定的奥恩斯坦-乌伦贝克型系数）：$(a,p,c,q,x_0,T,\\Delta t,M,N) = (-1,1,1,0,0,2,0.005,100,2000)$。此处，$b(x)=-1\\cdot x$，$\\sigma(x)=1$，$x_0=0$，$T=2$，$\\Delta t=0.005$，阈值 $M=100$，以及 $N=2000$ 条路径。\n- 测试 2（强向外线性漂移与小扩散）：$(a,p,c,q,x_0,T,\\Delta t,M,N) = (3,1,0.1,0,1,2,0.005,100,2000)$。\n- 测试 3（确定性超线性漂移，零扩散；在相应的常微分方程中存在已知的有限时间爆破）：$(a,p,c,q,x_0,T,\\Delta t,M,N) = (1,2,0,0,1,2,0.005,100,2000)$。\n\n对于每个测试用例，输出一个数对 $[p,\\text{LG}]$，其中 $p$ 是四舍五入到三位小数的经验触及概率，$\\text{LG}$ 是如上指定的布尔标志。最终输出必须是单行，包含所有测试用例的结果，形式为方括号内以逗号分隔的列表，例如 $[[p_1,\\text{LG}_1],[p_2,\\text{LG}_2],[p_3,\\text{LG}_3]]$。\n\n本问题不涉及物理单位。不使用角度。概率必须以小数表示。\n\n您的程序应生成单行输出，包含以方括号括起来的逗号分隔列表形式的结果（例如，`[[p_1,LG_1],[p_2,LG_2],[p_3,LG_3]]`）。", "solution": "该问题要求我们分析具有多项式系数的一维随机微分方程（SDE）解的行为。对于每个给定的测试用例，我们将执行两个主要任务：首先，确定系数是否满足非爆炸性的一个理论充分条件（线性增长条件）；其次，使用欧拉-丸山方法进行数值模拟，以估计解路径达到一个很大数值的概率。\n\n我们考虑的 SDE 是\n$$\n\\mathrm{d}X_t = b(X_t)\\,\\mathrm{d}t + \\sigma(X_t)\\,\\mathrm{d}W_t, \\quad X_0 = x_0\n$$\n其中 $b(x)$ 是漂移系数，$\\sigma(x)$ 是扩散系数。系数以多项式形式给出：\n$$\nb(x) = a\\,x^p, \\quad \\sigma(x) = c\\,x^q\n$$\n其中参数 $a, c \\in \\mathbb{R}$，指数 $p, q$ 为非负数。\n\n### 第1部分：线性增长条件（$\\text{LG}$ 标志）\n\nSDE 存在唯一的、非爆炸的全局解的一个标准充分条件是，系数 $b(x)$ 和 $\\sigma(x)$ 是局部利普希茨的，并满足线性增长条件。线性增长条件指出，存在一个常数 $K  0$，使得对于所有 $x \\in \\mathbb{R}$：\n$$\n|b(x)| + |\\sigma(x)| \\le K(1 + |x|)\n$$\n对于给定的多项式形式 $b(x) = a\\,x^p$ 和 $\\sigma(x) = c\\,x^q$，必须检查此条件。右侧的项 $|x|$ 的增长阶数为 1。左侧的项的增长阶数分别为 $p$ 和 $q$。为了使不等式对所有 $x$ 成立，特别是对于大的 $|x|$，左侧的增长速度不能快于右侧的增长速度。这意味着指数 $p$ 和 $q$ 不得大于 1。因此，当且仅当 $p \\le 1$ 且 $q \\le 1$ 时，线性增长条件得到满足。\n问题指定了一个布尔标志 $\\text{LG}$，如果此条件成立，则设置为 $1$ (True)，否则设置为 $0$ (False)。\n\n对于每个测试用例，我们按如下方式评估 $\\text{LG}$：\n- **测试 1**：$(a,p,c,q) = (-1,1,1,0)$。此处，$p=1$ 且 $q=0$。由于 $p \\le 1$ 且 $q \\le 1$，条件成立。因此，$\\text{LG}=1$。\n- **测试 2**：$(a,p,c,q) = (3,1,0.1,0)$。此处，$p=1$ 且 $q=0$。由于 $p \\le 1$ 且 $q \\le 1$，条件成立。因此，$\\text{LG}=1$。\n- **测试 3**：$(a,p,c,q) = (1,2,0,0)$。此处，$p=2$ 且 $q=0$。由于 $p  1$，条件被违反。因此，$\\text{LG}=0$。\n\n### 第2部分：数值模拟（经验触及概率 $p$）\n\n我们使用欧拉-丸山格式来生成 SDE 的近似样本路径。离散化方法由下式给出：\n$$\nX_{n+1} = X_n + b(X_n)\\,\\Delta t + \\sigma(X_n)\\,\\Delta W_n\n$$\n其中 $X_n$ 是在时间 $t_n = n\\,\\Delta t$ 时的状态。项 $\\Delta W_n$ 表示在区间 $[t_n, t_{n+1}]$ 上的维纳过程增量，它是一个均值为 $0$、方差为 $\\Delta t$ 的正态分布随机变量。我们可以写成 $\\Delta W_n = Z_n \\sqrt{\\Delta t}$，其中 $Z_n \\sim \\mathcal{N}(0,1)$ 是独立的标准正态随机变量。那么更新规则是：\n$$\nX_{n+1} = X_n + (a X_n^p)\\,\\Delta t + (c X_n^q)\\sqrt{\\Delta t}\\,Z_n\n$$\n对于每个测试用例，我们模拟从 $t=0$ 到 $t=T$ 的 $N$ 条独立路径。每条路径的时间步数是 $N_{\\text{steps}} = \\text{int}(T/\\Delta t)$。对于每条路径，我们监控其数值大小 $|X_n|$ 是否曾达到或超过一个大阈值 $M$。如果一条路径在任何时间 $t_n \\le T$ 触及阈值，我们将其计为一次“触及”。然后该特定路径的模拟将停止，因为它关于阈值的命运已经确定。\n\n单个测试用例的算法如下：\n1. 初始化参数：$a, p, c, q, x_0, T, \\Delta t, M, N$。\n2. 初始化 `hit_counter` 为 $0$。\n3. 循环 $N$ 次（对从 $1$ 到 $N$ 的每条路径）：\n    a. 设置初始状态 $X = x_0$。\n    b. 循环 $N_{\\text{steps}}$ 次（对每个时间步）：\n        i. 生成 $Z \\sim \\mathcal{N}(0,1)$。\n        ii. 更新状态：$X \\leftarrow X + (a X^p)\\Delta t + (c X^q)\\sqrt{\\Delta t}Z$。\n        iii. 检查是否触及阈值：如果 $|X| \\ge M$，将 `hit_counter` 增加 1 并跳出内层循环（继续下一条路径）。\n4. 模拟完所有 $N$ 条路径后，计算经验触及概率：$p = \\frac{\\text{hit\\_counter}}{N}$。\n5. 将结果 $p$ 四舍五入到三位小数。\n\n此过程应用于三个测试用例中的每一个。\n\n- **测试 1**：$b(x)=-x$，$\\sigma(x)=1$。这描述了一个奥恩斯坦-乌伦贝克过程，该过程向 $0$ 均值回归。从 $x_0=0$ 开始，该过程预计将保持在 $0$ 的一个小邻域内有界。对于此过程，$M=100$ 的阈值异常大，因此我们预计触及概率 $p$ 将非常接近 $0$。\n\n- **测试 2**：$b(x)=3x$，$\\sigma(x)=0.1$。漂移项是强正线性的，将解推离原点。相应的常微分方程 $dx/dt = 3x$ 具有指数增长的解 $x(t) = x_0 e^{3t}$。当 $x_0=1$ 时，仅此确定性部分在 $t=2$ 时就会达到 $e^{3 \\times 2} = e^6 \\approx 403.4$，远超阈值 $M=100$。小的扩散项增加了噪声，但不太可能抵消这种爆炸性趋势。我们预计会有一个很高的触及概率，$p \\approx 1$。\n\n- **测试 3**：$b(x)=x^2$，$\\sigma(x)=0$。这是一个确定性的常微分方程，$\\mathrm{d}X_t/ \\mathrm{d}t = X_t^2$。当 $x_0=1$ 时，其解析解为 $X_t = 1/(1-t)$，它在 $t=1$ 时会发生有限时间爆破。由于模拟运行到 $T=2$，因此轨迹肯定会超过任何有限阈值 $M$。数值格式应该能捕捉到这种行为，从而得到 $p=1.0$ 的触及概率。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by iterating through test cases, calculating the linear\n    growth flag and simulating SDE paths to find the empirical hitting probability.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a, p, c, q, x0, T, dt, M, N)\n    test_cases = [\n        (-1, 1, 1, 0, 0, 2, 0.005, 100, 2000),\n        (3, 1, 0.1, 0, 1, 2, 0.005, 100, 2000),\n        (1, 2, 0, 0, 1, 2, 0.005, 100, 2000),\n    ]\n\n    results = []\n    # Initialize a random number generator for reproducibility.\n    rng = np.random.default_rng(seed=42)\n\n    for case in test_cases:\n        a, p, c, q, x0, T, dt, M, N = case\n\n        # Part 1: Evaluate the linear growth (LG) condition\n        # The condition holds if p = 1 and q = 1.\n        lg_flag = 1 if p = 1 and q = 1 else 0\n\n        # Part 2: Run the Euler-Maruyama simulation\n        num_steps = int(T / dt)\n        sqrt_dt = np.sqrt(dt)\n        hit_count = 0\n\n        for _ in range(N):\n            X = float(x0)\n\n            for _ in range(num_steps):\n                # Standard normal random variable for the Wiener increment\n                Z = rng.normal(0, 1)\n\n                # Calculate drift and diffusion terms\n                b_X = a * (X**p)\n                sigma_X = c * (X**q)\n\n                # Update the state using the Euler-Maruyama step\n                X += b_X * dt + sigma_X * sqrt_dt * Z\n\n                # Check if the path has hit the threshold\n                if abs(X) >= M:\n                    hit_count += 1\n                    break  # Stop simulating this path as it has already hit\n\n        # Calculate the empirical hitting probability\n        hit_prob = hit_count / N\n\n        results.append([hit_prob, lg_flag])\n\n    # Format the final output string as specified: [[p1,LG1],[p2,LG2],...]\n    # with probabilities rounded to 3 decimal places.\n    str_results = []\n    for res in results:\n        p_val, lg_val = res\n        str_results.append(f\"[{p_val:.3f},{lg_val}]\")\n    \n    final_output_string = f\"[{','.join(str_results)}]\"\n    \n    # The problem asks for a program that *generates* the output.\n    # Executing this function will print the final answer to the console.\n    print(final_output_string)\n\nsolve()\n```", "id": "3068502"}]}