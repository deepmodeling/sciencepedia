{"hands_on_practices": [{"introduction": "要掌握一个新概念，第一步就是根据其基本定义进行直接计算的练习。这个练习将引导你为一个具有线性漂移的扩散过程推导尺度函数和速度密度，该过程与著名的Ornstein-Uhlenbeck过程密切相关。通过这个实践，你将加深对随机微分方程的生成元与包含尺度和速度测度的Sturm-Liouville形式之间联系的理解[@problem_id:3074935]。", "problem": "考虑由随机微分方程 (SDE) $dX_{t}=\\alpha X_{t}\\,dt+\\sigma\\,dW_{t}$ 控制的一维扩散过程，该过程在整个实直线 $\\mathbb{R}$ 上，其中 $\\alpha\\in\\mathbb{R}$ 和 $\\sigma>0$ 是常数，$W_{t}$ 是标准布朗运动。令 $\\mathcal{L}$ 表示作用于二次连续可微函数 $f\\in C^{2}(\\mathbb{R})$ 的此扩散的无穷小生成元。标度函数 $s$ 是一个严格递增的函数，满足 $s\\in C^{2}(\\mathbb{R})$ 且 $\\mathcal{L}s=0$。速度测度 $m$ 是唯一的正测度（在由标度选择固定的一个乘法常数内），使得生成元可以写成 Sturm–Liouville 形式 $\\mathcal{L}f=\\frac{d}{dm}\\left(\\frac{d}{ds}f\\right)$，对于所有 $f\\in C_{c}^{2}(\\mathbb{R})$，其中 $\\frac{d}{ds}f=\\frac{f'(x)}{s'(x)}$ 并且当 $m$ 相对于勒贝格测度具有密度 $m(x)$ 时，$\\frac{d}{dm}g=\\frac{1}{m(x)}\\frac{d}{dx}g(x)$。\n\n仅使用这些基本定义和与给定 SDE 相关联的生成元，在归一化条件 $s'(0)=1$ 下，导出标度函数导数 $s'(x)$ 和速度密度 $m(x)$（$m$ 相对于勒贝格测度的密度）的显式表达式。将您的最终答案以闭合形式表示为一对 $\\big(s'(x),\\,m(x)\\big)$。", "solution": "该问题是有效的，因为它有坚实的随机微分方程理论基础，信息充分且一致，问题设定良好，并且表述客观。\n\n该一维扩散过程由以下随机微分方程 (SDE) 描述：\n$$dX_{t} = \\alpha X_{t}\\,dt + \\sigma\\,dW_{t}$$\n这是一个形式为 $dX_t = \\mu(X_t)dt + \\sigma(X_t)dW_t$ 的 Itô 过程，其漂移系数为 $\\mu(x) = \\alpha x$，扩散系数为常数 $\\sigma(x) = \\sigma$。\n\n此扩散过程的无穷小生成元 $\\mathcal{L}$ 作用于函数 $f \\in C^{2}(\\mathbb{R})$，由以下通用公式给出：\n$$\\mathcal{L}f(x) = \\mu(x)f'(x) + \\frac{1}{2}\\sigma(x)^{2}f''(x)$$\n代入具体的漂移和扩散系数可得：\n$$\\mathcal{L}f(x) = \\alpha x f'(x) + \\frac{\\sigma^2}{2} f''(x)$$\n\n第一步是求标度函数 $s(x)$。问题将标度函数定义为一个严格递增的函数 $s \\in C^{2}(\\mathbb{R})$，它满足方程 $\\mathcal{L}s = 0$。将生成元 $\\mathcal{L}$ 应用于标度函数 $s(x)$，我们得到一个二阶常微分方程 (ODE)：\n$$\\mathcal{L}s(x) = \\alpha x s'(x) + \\frac{\\sigma^2}{2} s''(x) = 0$$\n令 $u(x) = s'(x)$。则 $s''(x) = u'(x)$，该常微分方程变为关于 $u(x)$ 的一阶线性常微分方程：\n$$\\frac{\\sigma^2}{2} u'(x) + \\alpha x u(x) = 0$$\n这是一个可分离方程：\n$$\\frac{\\sigma^2}{2} \\frac{du}{dx} = -\\alpha x u$$\n$$\\frac{du}{u} = -\\frac{2\\alpha x}{\\sigma^2} dx$$\n对两边积分得到：\n$$\\int \\frac{1}{u} du = \\int -\\frac{2\\alpha x}{\\sigma^2} dx$$\n$$\\ln|u(x)| = -\\frac{2\\alpha}{\\sigma^2} \\frac{x^2}{2} + C_0 = -\\frac{\\alpha x^2}{\\sigma^2} + C_0$$\n其中 $C_0$ 是积分常数。对两边取指数，我们得到：\n$$|u(x)| = \\exp\\left(-\\frac{\\alpha x^2}{\\sigma^2} + C_0\\right) = e^{C_0} \\exp\\left(-\\frac{\\alpha x^2}{\\sigma^2}\\right)$$\n这意味着 $u(x) = C \\exp\\left(-\\frac{\\alpha x^2}{\\sigma^2}\\right)$，其中 $C = \\pm e^{C_0}$ 是一个任意非零常数。由于 $u(x) = s'(x)$ 且标度函数 $s(x)$ 必须是严格递增的，我们必须有 $s'(x) > 0$ 对所有 $x \\in \\mathbb{R}$ 成立。指数项总是正的，因此我们要求 $C > 0$。\n问题提供了一个归一化条件 $s'(0) = 1$。我们应用此条件来求常数 $C$：\n$$s'(0) = C \\exp\\left(-\\frac{\\alpha(0)^2}{\\sigma^2}\\right) = C \\exp(0) = C$$\n因此，$C = 1$。标度函数的导数为：\n$$s'(x) = \\exp\\left(-\\frac{\\alpha x^2}{\\sigma^2}\\right)$$\n\n第二步是求速度密度 $m(x)$。问题指出，生成元可以写成 Sturm-Liouville 形式 $\\mathcal{L}f = \\frac{d}{dm}\\left(\\frac{d}{ds}f\\right)$。所提供的定义是 $\\frac{d}{ds}f = \\frac{f'(x)}{s'(x)}$ 并且，对于一个具有密度 $m(x)$ 的测度，$\\frac{d}{dm}g = \\frac{1}{m(x)}\\frac{d}{dx}g(x)$。\n将这些代入 Sturm-Liouville 形式，我们得到：\n$$\\mathcal{L}f(x) = \\frac{1}{m(x)} \\frac{d}{dx}\\left(\\frac{f'(x)}{s'(x)}\\right)$$\n我们现在有两个关于 $\\mathcal{L}f(x)$ 的表达式。令它们相等可得：\n$$\\alpha x f'(x) + \\frac{\\sigma^2}{2} f''(x) = \\frac{1}{m(x)} \\frac{d}{dx}\\left(\\frac{f'(x)}{s'(x)}\\right)$$\n为了求 $m(x)$，我们可以重排这个方程：\n$$m(x)\\left(\\alpha x f'(x) + \\frac{\\sigma^2}{2} f''(x)\\right) = \\frac{d}{dx}\\left(\\frac{f'(x)}{s'(x)}\\right)$$\n在右侧使用商法则：\n$$\\frac{d}{dx}\\left(\\frac{f'(x)}{s'(x)}\\right) = \\frac{f''(x)s'(x) - f'(x)s''(x)}{[s'(x)]^2} = \\frac{f''(x)}{s'(x)} - \\frac{s''(x)}{[s'(x)]^2}f'(x)$$\n将此代回方程：\n$$m(x)\\alpha x f'(x) + m(x)\\frac{\\sigma^2}{2} f''(x) = \\frac{1}{s'(x)}f''(x) - \\frac{s''(x)}{[s'(x)]^2}f'(x)$$\n这个等式必须对任何函数 $f \\in C_c^2(\\mathbb{R})$ 都成立。这意味着方程两边 $f'(x)$ 和 $f''(x)$ 的系数必须相等。\n\n令 $f''(x)$ 的系数相等：\n$$m(x)\\frac{\\sigma^2}{2} = \\frac{1}{s'(x)}$$\n直接解出 $m(x)$，得到以标度函数导数表示的速度密度：\n$$m(x) = \\frac{2}{\\sigma^2 s'(x)}$$\n作为一致性检验，我们可以令 $f'(x)$ 的系数相等：\n$$m(x)\\alpha x = -\\frac{s''(x)}{[s'(x)]^2}$$\n将 $m(x) = \\frac{2}{\\sigma^2 s'(x)}$ 代入此方程得到：\n$$\\frac{2\\alpha x}{\\sigma^2 s'(x)} = -\\frac{s''(x)}{[s'(x)]^2}$$\n乘以 $[s'(x)]^2$ 可得：\n$$\\frac{2\\alpha x}{\\sigma^2} s'(x) = -s''(x)$$\n$$\\frac{\\sigma^2}{2} s''(x) + \\alpha x s'(x) = 0$$\n这正是我们之前求解的关于 $s'(x)$ 的常微分方程，证实了我们推导的一致性。\n\n最后，我们将 $s'(x)$ 的表达式代入 $m(x)$ 的公式中：\n$$m(x) = \\frac{2}{\\sigma^2 s'(x)} = \\frac{2}{\\sigma^2 \\exp\\left(-\\frac{\\alpha x^2}{\\sigma^2}\\right)}$$\n$$m(x) = \\frac{2}{\\sigma^2} \\exp\\left(\\frac{\\alpha x^2}{\\sigma^2}\\right)$$\n所求的对由标度函数的导数 $s'(x)$ 和速度密度 $m(x)$ 组成。", "answer": "$$\n\\boxed{\n\\left( \\exp\\left(-\\frac{\\alpha x^2}{\\sigma^2}\\right), \\frac{2}{\\sigma^2} \\exp\\left(\\frac{\\alpha x^2}{\\sigma^2}\\right) \\right)\n}\n$$", "id": "3074935"}, {"introduction": "在掌握了基本计算之后，我们将从纯粹的计算转向概念的诠释。速度测度并不仅仅是一个数学上的奇特概念，它揭示了关于一个过程行为的深刻见解。本练习将挑战你分析对于具有不同噪声类型（常数噪声与乘性噪声）的过程，其速度测度的形式如何变化，并以几何布朗运动（GBM）和Cox-Ingersoll-Ross（CIR）模型为例。这将帮助你理解速度测度如何量化一个过程在不同位置预期停留的时间[@problem_id:3074956]。", "problem": "考虑在一个具有吸收或反射边界的区间上的一维伊藤扩散，由随机微分方程 $dX_t = b(X_t)\\,dt + \\sigma(X_t)\\,dW_t$ 描述，其中 $b(x)$ 是漂移，$\\sigma(x)$ 是扩散系数，$W_t$ 是标准布朗运动。无穷小生成元和向前方程决定了标度函数和速度测度，它们共同编码了扩散在空间上如何移动以及时间如何被局部加权。仅使用一维扩散的生成元、标度函数和速度测度的核心定义，分析乘性噪声的存在如何相对于常数噪声扩散修改速度测度。特别地，研究定义在 $(0,\\infty)$ 上的几何布朗运动 (GBM) $dX_t = \\mu X_t\\,dt + \\sigma X_t\\,dW_t$，以及定义在 $[0,\\infty)$ 上的 Cox–Ingersoll–Ross (CIR) 过程 $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t$。识别以下关于速度测度密度 $m(x)$ 的函数形式（除去比例常数）以及与常数噪声扩散相比，$m(x)$ 所引致的空间加权的解释的正确陈述。\n\nA. 对于 $(0,\\infty)$ 上的几何布朗运动 (GBM) $dX_t = \\mu X_t\\,dt + \\sigma X_t\\,dW_t$，速度测度密度为 $m(x) \\propto x^{(2\\mu/\\sigma^2) - 2}$。对于零漂移的常数噪声布朗运动 $dY_t = \\sigma\\,dW_t$，速度测度密度在空间上是均匀的。解释：GBM 中的乘性噪声引入了一种幂律空间加权，除非 $\\mu$ 相对于 $\\sigma^2$ 足够大，否则它会降低对较大 $x$ 的权重；而当 $(2\\mu/\\sigma^2) - 2 > 0$ 时，它会增加对较大 $x$ 的权重。\n\nB. 乘性噪声不影响速度测度：几何布朗运动 (GBM) 和 Cox–Ingersoll–Ross (CIR) 过程都具有空间均匀的 $m(x)$，与常数噪声扩散相同。\n\nC. 对于 $[0,\\infty)$ 上的 Cox–Ingersoll–Ross (CIR) 过程 $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t$，速度测度密度为 $m(x) \\propto x^{(2\\kappa\\theta/\\sigma^2) - 1}\\,e^{-(2\\kappa/\\sigma^2)x}$。解释：乘性平方根噪声产生一个多项式因子，当 $2\\kappa\\theta/\\sigma^2  1$ 时，它增加了在 $0$ 附近的权重；当 $2\\kappa\\theta/\\sigma^2 > 1$ 时，它减小了该权重；而指数因子则反映了远离较大 $x$ 的均值回归。\n\nD. 在 Cox–Ingersoll–Ross (CIR) 过程中，速度测度密度为 $m(x) \\propto e^{+(2\\kappa/\\sigma^2)x}$，由于乘性噪声，在较大的 $x$ 处显示出更重的权重；在 $x=0$ 附近没有特殊的加权。\n\nE. 速度测度与平稳分布密度一致。因此，几何布朗运动 (GBM) 具有对数正态的 $m(x)$，而 Cox–Ingersoll–Ross (CIR) 过程具有伽马分布的 $m(x)$。\n\n选择所有正确选项。", "solution": "首先验证问题陈述的科学合理性、自洽性和清晰性。\n\n**步骤1：提取已知条件**\n- 一维伊藤扩散的一般形式为 $dX_t = b(X_t)\\,dt + \\sigma(X_t)\\,dW_t$。\n- $b(x)$ 是漂移系数。\n- $\\sigma(x)$ 是扩散系数。\n- $W_t$ 是标准维纳过程（布朗运动）。\n- 任务涉及标度函数和速度测度，它们由无穷小生成元和向前方程确定。\n- 需要分析的具体过程是：\n    1. 几何布朗运动 (GBM)，在 $(0,\\infty)$ 上：$dX_t = \\mu X_t\\,dt + \\sigma X_t\\,dW_t$。\n    2. Cox–Ingersoll–Ross (CIR) 过程，在 $[0,\\infty)$ 上：$dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t$。\n- 问题要求给出速度测度密度 $m(x)$ 的函数形式，以及与常数噪声扩散相比其解释。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学基础**：该问题基于成熟的随机微分方程数学理论。漂移、扩散、生成元、标度函数和速度测度的概念是一维扩散的标准内容。GBM 和 CIR 是典型的、被深入研究过的模型。这在科学上是合理的。\n-   **适定性**：该问题是适定的。给定漂移 $b(x)$ 和扩散 $\\sigma(x)$，标度函数和速度测度在除去比例常数的意义下是唯一定义的，这允许得到一个确定的解。\n-   **客观性**：该问题以精确、客观的数学语言陈述。\n-   **完整性和一致性**：对于该领域的专家来说，问题陈述是自洽的。它依赖于标度函数和速度测度的标准定义，这些定义被假定为已知。这些定义是一致的，并且足以解决问题。\n    -   标度函数密度：$s(x) \\propto \\exp\\left(-\\int \\frac{2b(y)}{\\sigma(y)^2} dy\\right)$。\n    -   速度测度密度：$m(x) = \\frac{1}{\\sigma(x)^2 s(x)}$。\n-   验证清单中的其他缺陷均不存在。\n\n**步骤3：结论和行动**\n该问题是**有效的**。将通过将核心定义应用于指定的随机过程来推导解答。\n\n**推导**\n\n对于一般的一维伊藤扩散 $dX_t = b(X_t)\\,dt + \\sigma(X_t)\\,dW_t$，标度函数密度 $s(x)$ 和速度测度密度 $m(x)$ 定义如下（除去比例常数）。标度密度 $s(x)$ 由下式给出：\n$$\ns(x) = \\exp\\left( - \\int^x \\frac{2b(y)}{\\sigma(y)^2} dy \\right)\n$$\n然后，速度测度密度 $m(x)$ 通过标度密度和扩散系数来定义：\n$$\nm(x) = \\frac{1}{\\sigma(x)^2 s(x)}\n$$\n速度测度密度与过程的平稳分布（如果存在）成正比。它描述了过程在点 $x$ 的一个无穷小邻域内停留的长期平均时间。\n\n**情况1：常数噪声布朗运动（参考案例）**\n对于一个过程 $dY_t = \\sigma\\,dW_t$，我们有漂移 $b(y)=0$ 和扩散 $\\sigma(y)=\\sigma$（一个常数）。\n标度密度为：\n$$\ns(x) = \\exp\\left( - \\int^x \\frac{2 \\cdot 0}{\\sigma^2} dy \\right) = \\exp(0) = 1\n$$\n速度测度密度为：\n$$\nm(x) = \\frac{1}{\\sigma^2 s(x)} = \\frac{1}{\\sigma^2 \\cdot 1} = \\frac{1}{\\sigma^2}\n$$\n因此，$m(x) \\propto 1$，意味着速度测度密度在空间上是均匀的。\n\n**情况2：几何布朗运动 (GBM)**\n对于 GBM，$dX_t = \\mu X_t\\,dt + \\sigma X_t\\,dW_t$，我们有漂移 $b(x) = \\mu x$ 和扩散 $\\sigma(x) = \\sigma x$。\n标度密度表达式中的积分为：\n$$\n- \\int^x \\frac{2b(y)}{\\sigma(y)^2} dy = - \\int^x \\frac{2\\mu y}{(\\sigma y)^2} dy = - \\int^x \\frac{2\\mu}{\\sigma^2 y} dy = -\\frac{2\\mu}{\\sigma^2} \\ln(x) = \\ln\\left(x^{-2\\mu/\\sigma^2}\\right)\n$$\n所以，标度密度为 $s(x) \\propto x^{-2\\mu/\\sigma^2}$。\n速度测度密度为：\n$$\nm(x) = \\frac{1}{\\sigma(x)^2 s(x)} \\propto \\frac{1}{(\\sigma x)^2 \\cdot x^{-2\\mu/\\sigma^2}} = \\frac{1}{\\sigma^2 x^2 \\cdot x^{-2\\mu/\\sigma^2}} = \\frac{1}{\\sigma^2} x^{(2\\mu/\\sigma^2) - 2}\n$$\n因此，对于 GBM，$m(x) \\propto x^{(2\\mu/\\sigma^2) - 2}$。\n\n**情况3：Cox–Ingersoll–Ross (CIR) 过程**\n对于 CIR 过程，$dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t$，我们有漂移 $b(x) = \\kappa(\\theta - x)$ 和扩散 $\\sigma(x) = \\sigma\\sqrt{x}$。\n标度密度表达式中的积分为：\n$$\n- \\int^x \\frac{2b(y)}{\\sigma(y)^2} dy = - \\int^x \\frac{2\\kappa(\\theta - y)}{(\\sigma \\sqrt{y})^2} dy = - \\frac{2\\kappa}{\\sigma^2} \\int^x \\left(\\frac{\\theta}{y} - 1\\right) dy\n$$\n$$\n= - \\frac{2\\kappa}{\\sigma^2} \\left( \\theta\\ln(x) - x \\right) = \\frac{2\\kappa}{\\sigma^2}x - \\frac{2\\kappa\\theta}{\\sigma^2}\\ln(x) = \\ln\\left(e^{(2\\kappa/\\sigma^2)x}\\right) + \\ln\\left(x^{-2\\kappa\\theta/\\sigma^2}\\right)\n$$\n所以，标度密度为 $s(x) \\propto x^{-2\\kappa\\theta/\\sigma^2} e^{(2\\kappa/\\sigma^2)x}$。\n速度测度密度为：\n$$\nm(x) = \\frac{1}{\\sigma(x)^2 s(x)} \\propto \\frac{1}{(\\sigma\\sqrt{x})^2 \\cdot s(x)} = \\frac{1}{\\sigma^2 x \\cdot x^{-2\\kappa\\theta/\\sigma^2} e^{(2\\kappa/\\sigma^2)x}}\n$$\n$$\n= \\frac{1}{\\sigma^2} \\frac{1}{x^{1-2\\kappa\\theta/\\sigma^2} e^{(2\\kappa/\\sigma^2)x}} = \\frac{1}{\\sigma^2} x^{(2\\kappa\\theta/\\sigma^2) - 1} e^{-(2\\kappa/\\sigma^2)x}\n$$\n因此，对于 CIR 过程，$m(x) \\propto x^{(2\\kappa\\theta/\\sigma^2) - 1} e^{-(2\\kappa/\\sigma^2)x}$。这是 Gamma 分布的密度。\n\n**逐项分析**\n\nA. 对于 $(0,\\infty)$ 上的几何布朗运动 (GBM) $dX_t = \\mu X_t\\,dt + \\sigma X_t\\,dW_t$，速度测度密度为 $m(x) \\propto x^{(2\\mu/\\sigma^2) - 2}$。对于零漂移的常数噪声布朗运动 $dY_t = \\sigma\\,dW_t$，速度测度密度在空间上是均匀的。解释：GBM 中的乘性噪声引入了一种幂律空间加权，除非 $\\mu$ 相对于 $\\sigma^2$ 足够大，否则它会降低对较大 $x$ 的权重；而当 $(2\\mu/\\sigma^2) - 2  0$ 时，它会增加对较大 $x$ 的权重。\n- 推导出的 GBM 公式为 $m(x) \\propto x^{(2\\mu/\\sigma^2) - 2}$。这与选项相符。\n- 推导出的常数噪声 BM 公式为 $m(x) \\propto 1$，即空间均匀。这与选项相符。\n- 解释基于指数 $(2\\mu/\\sigma^2) - 2$ 的符号。如果指数为负，对于大的 $x$，$m(x)$ 减小（降权）。如果为正，$m(x)$ 增加（增权）。增权的条件恰好是 $(2\\mu/\\sigma^2) - 2  0$。这个解释是正确的。\n- **结论：正确。**\n\nB. 乘性噪声不影响速度测度：几何布朗运动 (GBM) 和 Cox–Ingersoll–Ross (CIR) 过程都具有空间均匀的 $m(x)$，与常数噪声扩散相同。\n- 我们的推导表明，GBM 和 CIR 的速度测度都是 $x$ 的函数，并且不是空间均匀的。对于 GBM，$m(x) \\propto x^{(2\\mu/\\sigma^2) - 2}$。对于 CIR，$m(x) \\propto x^{(\\dots)}e^{-(\\dots)x}$。这个陈述显然是错误的。\n- **结论：不正确。**\n\nC. 对于 $[0,\\infty)$ 上的 Cox–Ingersoll–Ross (CIR) 过程 $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t$，速度测度密度为 $m(x) \\propto x^{(2\\kappa\\theta/\\sigma^2) - 1}\\,e^{-(2\\kappa/\\sigma^2)x}$。解释：乘性平方根噪声产生一个多项式因子，当 $2\\kappa\\theta/\\sigma^2  1$ 时，它增加了在 $0$ 附近的权重；当 $2\\kappa\\theta/\\sigma^2 > 1$ 时，它减小了该权重；而指数因子则反映了远离较大 $x$ 的均值回归。\n- 推导出的 CIR 速度测度公式为 $m(x) \\propto x^{(2\\kappa\\theta/\\sigma^2) - 1} e^{-(2\\kappa/\\sigma^2)x}$。这与选项相符。\n- 对多项式项 $x^{(2\\kappa\\theta/\\sigma^2) - 1}$ 在 $x=0$ 附近的解释：如果指数 $(2\\kappa\\theta/\\sigma^2) - 1  0$（即 $2\\kappa\\theta/\\sigma^2  1$），那么当 $x \\to 0^+$ 时 $m(x) \\to \\infty$，表明在原点附近有高权重。如果指数为正（即 $2\\kappa\\theta/\\sigma^2 > 1$），那么当 $x \\to 0^+$ 时 $m(x) \\to 0$，表明权重低。这是正确的。\n- 指数因子 $e^{-(2\\kappa/\\sigma^2)x}$ 导致对于大的 $x$ 快速衰减，这使得过程不会发散到无穷大。这是均值回归漂移 $b(x) = \\kappa(\\theta-x)$ 的结果，它将过程拉回到 $\\theta$。这个解释是正确的。\n- **结论：正确。**\n\nD. 在 Cox–Ingersoll–Ross (CIR) 过程中，速度测度密度为 $m(x) \\propto e^{+(2\\kappa/\\sigma^2)x}$，由于乘性噪声，在较大的 $x$ 处显示出更重的权重；在 $x=0$ 附近没有特殊的加权。\n- 推导出的公式是 $m(x) \\propto x^{(2\\kappa\\theta/\\sigma^2) - 1} e^{-(2\\kappa/\\sigma^2)x}$。该选项给出了一个错误的函数形式（指数中的符号错误，缺少多项式因子）。这导致了一个完全错误的解释。\n- **结论：不正确。**\n\nE. 速度测度与平稳分布密度一致。因此，几何布朗运动 (GBM) 具有对数正态的 $m(x)$，而 Cox–Ingersoll–Ross (CIR) 过程具有伽马分布的 $m(x)$。\n- 速度测度与平稳分布密度“一致”的说法不精确；它们是“成比例”的，$m(x) \\propto \\pi(x)$，并且平稳密度 $\\pi(x)$ 必须是可归一化的，而这对 $m(x)$ 不是一个要求。\n- 声称 GBM 的速度测度是对数正态的说法是错误的。我们的推导显示 $m(x) \\propto x^{(2\\mu/\\sigma^2) - 2}$，这是一个幂律形式。在固定时间 $t$，$X_t$ 的分布是对数正态的，但这与速度测度或平稳分布是不同的。\n- 声称 CIR 的速度测度具有 Gamma 形式是正确的，如我们的推导所示。\n- 然而，由于初始前提不精确且关于 GBM 的结论不正确，整个陈述是有缺陷的。\n- **结论：不正确。**", "answer": "$$\\boxed{AC}$$", "id": "3074956"}, {"introduction": "最后，我们通过一个连接理论与计算的实际应用来收尾。尺度函数和速度测度最强大的应用之一是解决首达时间问题。本练习要求你计算Ornstein-Uhlenbeck过程首次离开一个给定区间所需的平均时间，这是金融和物理学等领域中的一个关键量。这个问题将理论推导与数值实现相结合，提供了一次完整的动手体验[@problem_id:3074929]。", "problem": "考虑由随机微分方程 (SDE) $dX_t = -\\theta X_t \\, dt + \\sigma \\, dW_t$ 定义的奥恩斯坦-乌伦贝克 (OU) 一维扩散，其中参数 $\\theta  0$ 和 $\\sigma  0$，$W_t$ 是标准布朗运动。固定一个有限开区间 $(a,b)$，其中 $a  b$，并为从 $X_0 = x \\in (a,b)$ 开始的 OU 过程定义首次出时 $\\tau_{a,b} = \\inf\\{ t \\ge 0 : X_t \\notin (a,b) \\}$。\n\n仅从一维扩散的基本定义和事实出发：\n- 无穷小生成元 $L$ 作用于二次连续可微函数 $f$ 的形式为 $L f(x) = \\frac{1}{2}\\sigma^2 f''(x) + \\mu(x) f'(x)$，其中 $\\mu(x)$ 是漂移。\n- 标度密度 $p(x)$ 定义为 $p(x) = \\exp\\!\\left(-\\int^{x} \\frac{2\\mu(u)}{\\sigma^2} \\, du\\right)$。\n- 速度密度 $m(x)$ 定义为 $m(x) = \\frac{2}{\\sigma^2 p(x)}$。\n- 标度函数 $s(x)$ 满足 $s'(x) = p(x)$，其定义可相差一个加性常数。\n\n任务：\n1. 对于漂移为 $\\mu(x) = -\\theta x$ 且扩散系数 $\\sigma$ 为常数的 OU 过程，推导标度密度 $p(x)$ 和速度密度 $m(x)$ 的显式形式。然后，构造一个标度函数 $s(x)$，并将其归一化以使 $s(a) = 0$，并证明期望出时 $\\mathbb{E}_x[\\tau_{a,b}]$ 可以表示为在 $(a,b)$ 上一个合适的格林函数 $G_{a,b}(x,y)$ 对速度密度积分的形式。证明对于所有 $x \\in (a,b)$，$\\mathbb{E}_x[\\tau_{a,b}]$ 是有限的。\n2. 通过在 $y \\in (a,b)$ 上对显式速度密度 $m(y)$ 积分 $G_{a,b}(x,y)$，实现 $\\mathbb{E}_x[\\tau_{a,b}]$ 的数值计算。在计算中使用从标度密度得到的 OU 标度函数的解析表达式，并将其归一化以使 $s(a) = 0$。您的算法在给定输入上应稳定且准确。\n3. 使用您的程序为以下参数集测试套件生成 $\\mathbb{E}_x[\\tau_{a,b}]$ 的数值，每个参数集以 $(\\theta,\\sigma,a,b,x)$ 的形式给出：\n   - $(1.0, 1.0, -1.0, 1.0, 0.0)$\n   - $(2.0, 0.75, -2.0, 3.0, 1.0)$\n   - $(0.1, 1.5, -0.25, 0.25, 0.0)$\n   - $(5.0, 0.5, -0.5, 0.5, -0.49)$\n\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[result1,result2,result3,result4]\"）。每个结果必须是一个实数（浮点数）。此问题不涉及物理单位，也没有角度量，因此除了标准实数格式的数值外，不需要指定单位。", "solution": "首先对用户提供的问题进行严格的验证过程。\n\n### 第 1 步：提取给定条件\n-   **随机微分方程 (SDE)：** $dX_t = -\\theta X_t \\, dt + \\sigma \\, dW_t$，用于奥恩斯坦-乌伦贝克 (OU) 过程。\n-   **参数：** $\\theta  0$，$\\sigma  0$。\n-   **漂移和扩散：** $\\mu(x) = -\\theta x$，扩散系数为 $\\sigma$。\n-   **域：** 一个有限开区间 $(a,b)$，其中 $a  b$。\n-   **首次出时：** $\\tau_{a,b} = \\inf\\{ t \\ge 0 : X_t \\notin (a,b) \\}$。\n-   **初始条件：** $X_0 = x \\in (a,b)$。\n-   **无穷小生成元：** 对于 $f \\in C^2$，$L f(x) = \\frac{1}{2}\\sigma^2 f''(x) + \\mu(x) f'(x)$。\n-   **标度密度：** $p(x) = \\exp\\!\\left(-\\int^{x} \\frac{2\\mu(u)}{\\sigma^2} \\, du\\right)$。\n-   **速度密度：** $m(x) = \\frac{2}{\\sigma^2 p(x)}$。\n-   **标度函数：** $s(x)$ 满足 $s'(x) = p(x)$。\n-   **归一化条件：** $s(a) = 0$。\n-   **任务：**\n    1.  为 OU 过程推导 $p(x)$ 和 $m(x)$ 的显式形式。构造归一化的标度函数 $s(x)$。证明期望出时 $\\mathbb{E}_x[\\tau_{a,b}]$ 由一个格林函数 $G_{a,b}(x,y)$ 对速度密度 $m(y)$ 的积分给出，并证明此期望是有限的。\n    2.  使用此积分公式实现一个数值方法来计算 $\\mathbb{E}_x[\\tau_{a,b}]$。\n    3.  将该实现应用于一个特定的参数 $(\\theta,\\sigma,a,b,x)$ 测试套件。\n\n### 第 2 步：使用提取的给定条件进行验证\n该问题定义明确且科学上合理。\n-   **科学依据：** 该问题涉及奥恩斯坦-乌伦贝克过程，这是随机分析的基石，及其首次出时，这是该领域的经典问题。所提供的生成元、标度密度、速度密度和标度函数的定义是一维扩散理论中的标准内容。\n-   **适定性：** 寻找平均首次出时是一个适定的边值问题。条件 $\\theta  0$、$\\sigma  0$ 和 $x \\in (a,b)$ 在物理和数学上都有意义，确保了唯一、有限的解。\n-   **客观性：** 该问题以精确、客观的数学语言陈述，没有歧义或主观断言。\n\n该问题没有表现出任何诸如科学上不健全、信息缺失或逻辑矛盾等缺陷。这是一个应用数学中标准的、尽管不平凡的问题，它结合了理论推导和数值实现。\n\n### 第 3 步：结论与行动\n该问题被判定为**有效**。将提供完整解答。\n\n---\n\n解答过程首先处理理论推导，然后概述数值实现策略。\n\n**任务 1：理论推导**\n\n对于奥恩斯坦-乌伦贝克过程，漂移为 $\\mu(x) = -\\theta x$，扩散系数为常数 $\\sigma$。\n\n首先，我们推导标度密度 $p(x)$。使用给定的定义：\n$$\np(x) = \\exp\\left(-\\int^{x} \\frac{2\\mu(u)}{\\sigma^2} \\, du\\right) = \\exp\\left(-\\int^{x} \\frac{2(-\\theta u)}{\\sigma^2} \\, du\\right) = \\exp\\left(\\frac{2\\theta}{\\sigma^2}\\int^{x} u \\, du\\right)\n$$\n该积分引入了一个任意的积分常数，这对应于 $p(x)$ 的一个乘法常数。我们可以不失一般性地将此常数设为 $1$，因为它将被吸收到标度函数的定义中。选择积分的下限为 $0$ 可得：\n$$\np(x) = \\exp\\left(\\frac{\\theta x^2}{\\sigma^2}\\right)\n$$\n接下来，我们使用其定义找到速度密度 $m(x)$：\n$$\nm(x) = \\frac{2}{\\sigma^2 p(x)} = \\frac{2}{\\sigma^2} \\exp\\left(-\\frac{\\theta x^2}{\\sigma^2}\\right)\n$$\n标度函数 $s(x)$ 由 $s'(x) = p(x)$ 定义，并且必须归一化以使 $s(a) = 0$。这唯一地确定了 $s(x)$ 为 $p(u)$ 的定积分：\n$$\ns(x) = \\int_a^x p(u) \\, du = \\int_a^x \\exp\\left(\\frac{\\theta u^2}{\\sigma^2}\\right) \\, du\n$$\n期望出时 $v(x) = \\mathbb{E}_x[\\tau_{a,b}]$ 是以下二阶常微分方程的解，这是一个边值问题 (BVP)：\n$$\nL v(x) = -1, \\quad x \\in (a,b)\n$$\n边界条件为 $v(a) = 0$ 和 $v(b) = 0$。OU 过程的生成元是 $L = -\\theta x \\frac{d}{dx} + \\frac{\\sigma^2}{2} \\frac{d^2}{dx^2}$。\n\n一维扩散理论中的一个基本结果是，这个边值问题的解由一个格林函数对速度密度的积分给出：\n$$\nv(x) = \\int_a^b G_{a,b}(x,y) m(y) \\, dy\n$$\n在狄利克雷边界条件 $a$ 和 $b$ 下，与出时问题相关的算子的格林函数 $G_{a,b}(x,y)$ 用标度函数 $s(x)$ 表示为：\n$$\nG_{a,b}(x,y) = \\frac{(s(x \\wedge y) - s(a))(s(b) - s(x \\vee y))}{s(b) - s(a)}\n$$\n其中 $x \\wedge y = \\min(x,y)$ 和 $x \\vee y = \\max(x,y)$。\n\n应用我们的归一化 $s(a)=0$，格林函数简化为：\n$$\nG_{a,b}(x,y) = \\frac{s(x \\wedge y)(s(b) - s(x \\vee y))}{s(b)}\n$$\n将此代入 $v(x)$ 的积分中，并在 $x$ 处分割积分，可以展示解的结构：\n$$\nv(x) = \\int_a^x G_{a,b}(x,y) m(y) \\, dy + \\int_x^b G_{a,b}(x,y) m(y) \\, dy\n$$\n对于 $y \\in (a,x)$，$x \\wedge y = y$ 且 $x \\vee y = x$，所以 $G_{a,b}(x,y) = \\frac{s(y)(s(b)-s(x))}{s(b)}$。\n对于 $y \\in (x,b)$，$x \\wedge y = x$ 且 $x \\vee y = y$，所以 $G_{a,b}(x,y) = \\frac{s(x)(s(b)-s(y))}{s(b)}$。\n这给出了显式的积分表达式：\n$$\nv(x) = \\frac{s(b)-s(x)}{s(b)} \\int_a^x s(y) m(y) \\, dy + \\frac{s(x)}{s(b)} \\int_x^b (s(b)-s(y)) m(y) \\, dy\n$$\n这验证了期望出时可以表示为格林函数对速度密度积分的说法。\n\n要证明对于所有 $x \\in (a,b)$，$\\mathbb{E}_x[\\tau_{a,b}]$ 是有限的，我们检查积分的组成部分。\n1.  速度密度 $m(y) = \\frac{2}{\\sigma^2} \\exp\\left(-\\frac{\\theta y^2}{\\sigma^2}\\right)$ 是在有限区间 $(a,b)$ 上的连续正函数。因此它是有界的。\n2.  标度函数 $s(y) = \\int_a^y \\exp\\left(\\frac{\\theta u^2}{\\sigma^2}\\right) du$ 在 $[a,b]$ 上是连续且严格递增的，因为其导数 $p(y)$ 严格为正。\n3.  因为 $s(y)$ 在 $[a,b]$ 上是连续的，所以它是有界的。具体来说，$s(a)=0$ 且 $s(b) = \\int_a^b p(u)du > 0$。\n4.  因此，对于任何固定的 $x \\in (a,b)$，格林函数 $G_{a,b}(x,y)$ 是关于 $y$ 的有界连续函数。\n5.  总的被积函数 $G_{a,b}(x,y)m(y)$ 是在有限区间 $(a,b)$ 上两个有界连续函数的乘积。这样一个函数在有限区间上的积分必然是有限的。\n因此，对于所有 $x \\in (a,b)$，$\\mathbb{E}_x[\\tau_{a,b}]$ 是有限的。\n\n**任务 2 和 3：数值实现与计算**\n\n为了数值计算 $\\mathbb{E}_x[\\tau_{a,b}]$，我们将实现推导出的积分公式。主要挑战是计算标度函数 $s(x)$，它涉及一个没有初等闭式解的积分。\n\n$s(x)$ 中的积分可以用虚误差函数 $\\text{erfi}(z) = \\frac{2}{\\sqrt{\\pi}}\\int_0^z e^{t^2} dt$ 来表示。\n令 $\\alpha = \\sqrt{\\theta}/\\sigma$。那么我们有：\n$$\ns(x) = \\int_a^x \\exp((\\alpha u)^2) \\, du\n$$\n通过替换 $v = \\alpha u$ ($du = dv/\\alpha$)：\n$$\ns(x) = \\frac{1}{\\alpha} \\int_{\\alpha a}^{\\alpha x} e^{v^2} \\, dv = \\frac{1}{\\alpha} \\left[ \\int_0^{\\alpha x} e^{v^2} \\, dv - \\int_0^{\\alpha a} e^{v^2} \\, dv \\right]\n$$\n$$\ns(x) = \\frac{1}{\\alpha} \\frac{\\sqrt{\\pi}}{2} \\left[ \\text{erfi}(\\alpha x) - \\text{erfi}(\\alpha a) \\right]\n$$\n这个 $s(x)$ 的解析表达式（用一个特殊函数表示）将用于数值代码中。`scipy.special.erfi` 提供了一个精确的实现。\n算法如下：\n1.  对于给定的参数集 $(\\theta, \\sigma, a, b, x)$，使用推导出的公式定义标度 $s(y)$ 和速度密度 $m(y)$ 的函数。\n2.  使用数值求积程序 (`scipy.integrate.quad`) 计算两个积分 $I_1 = \\int_a^x s(y)m(y) \\, dy$ 和 $I_2 = \\int_x^b (s(b)-s(y))m(y) \\, dy$。\n3.  使用公式 $v(x) = \\frac{s(b)-s(x)}{s(b)}I_1 + \\frac{s(x)}{s(b)}I_2$ 组合最终结果。\n\n下面的 Python 代码实现了此过程，以计算给定测试用例的结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erfi\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the problem by calculating the expected first exit time for the\n    Ornstein-Uhlenbeck process for a given set of parameters.\n    \"\"\"\n    # The test suite of parameter sets (theta, sigma, a, b, x).\n    test_cases = [\n        (1.0, 1.0, -1.0, 1.0, 0.0),\n        (2.0, 0.75, -2.0, 3.0, 1.0),\n        (0.1, 1.5, -0.25, 0.25, 0.0),\n        (5.0, 0.5, -0.5, 0.5, -0.49),\n    ]\n\n    results = []\n    for params in test_cases:\n        theta, sigma, a, b, x = params\n        \n        # Define a factory for creating the required functions s(y) and m(y) for each case.\n        # This closure captures the parameters for a specific case.\n        def make_functions(theta, sigma, a):\n            \"\"\"\n            Creates the scale function s(y) and speed density m(y) for the given parameters.\n            \"\"\"\n            alpha = np.sqrt(theta) / sigma\n            \n            # The scale function s(y) is normalized such that s(a) = 0.\n            # s(y) = integral_a^y exp(theta*u^2/sigma^2) du\n            # Analytically, this is related to the imaginary error function (erfi).\n            sqrt_pi_half = np.sqrt(np.pi) / 2.0\n            pre_factor = sqrt_pi_half / alpha if alpha != 0 else 0\n            erfi_alpha_a = erfi(alpha * a) if alpha != 0 else 0\n\n            def scale_function(y):\n                if alpha == 0:\n                    # In the limit theta -> 0, the process is a scaled Brownian motion.\n                    # s(y) = y - a. This case is not in the test suite but is included for robustness.\n                    return y - a\n                return pre_factor * (erfi(alpha * y) - erfi_alpha_a)\n\n            # The speed density m(y).\n            # m(y) = (2 / sigma^2) * exp(-theta * y^2 / sigma^2)\n            sigma_sq = sigma**2\n            def speed_density(y):\n                return (2.0 / sigma_sq) * np.exp(-theta * y**2 / sigma_sq)\n\n            return scale_function, speed_density\n\n        s, m = make_functions(theta, sigma, a)\n\n        # Pre-compute the values of the scale function at key points.\n        s_x = s(x)\n        s_b = s(b)\n\n        # The expected exit time formula involves two integrals.\n        # v(x) = ((s(b)-s(x))/s(b)) * I1 + (s(x)/s(b)) * I2\n        # where I1 = integral from a to x of s(y)m(y) dy\n        # and I2 = integral from x to b of (s(b)-s(y))m(y) dy\n\n        # Define the integrands for the two parts of the formula.\n        def integrand1(y):\n            return s(y) * m(y)\n        \n        def integrand2(y):\n            return (s_b - s(y)) * m(y)\n\n        # Perform numerical integration using scipy.integrate.quad.\n        # quad returns a tuple (result, error_estimate). We only need the result.\n        integral1, _ = quad(integrand1, a, x)\n        integral2, _ = quad(integrand2, x, b)\n        \n        # If s_b is zero, it would imply a=b, which is ruled out by the problem statement.\n        # So we can safely divide by s_b.\n        if s_b == 0:\n            # This case should not be reached with valid inputs a  b and theta > 0.\n            # If it were, it could correspond to an infinite exit time.\n            # For this problem, we assume s_b is non-zero.\n            raise ValueError(\"s(b) is zero, cannot compute expectation.\")\n\n        expected_time = ((s_b - s_x) / s_b) * integral1 + (s_x / s_b) * integral2\n        results.append(expected_time)\n\n    # Print the results in the specified format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3074929"}]}