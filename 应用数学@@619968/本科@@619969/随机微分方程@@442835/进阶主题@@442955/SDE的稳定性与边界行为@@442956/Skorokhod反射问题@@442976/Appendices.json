{"hands_on_practices": [{"introduction": "我们从一个基础练习开始，这个练习旨在通过一个具体的、分段线性的输入路径，来巩固你对一维斯科罗霍德（Skorokhod）问题的理解。通过显式地计算反射路径 $y(t)$ 和调节器 $k(t)$，你将直观地看到调节器是如何“启动”并累积的，以确保系统状态始终保持在非负区域。这个练习是掌握斯科罗霍德映射核心机制的第一步 [@problem_id:3081591]。", "problem": "考虑在非负半线上的一个确定性输入路径的Skorokhod反射问题。设 $x:[0,6.2]\\to\\mathbb{R}$ 是如下分段线性函数\n$$\nx(t)=\n\\begin{cases}\nt,   0 \\leq t \\leq 1, \\\\\n2 - t,   1 \\leq t \\leq 3, \\\\\n-1 + 1.5\\,(t-3),   3 \\leq t \\leq 4, \\\\\n0.5 - 0.8\\,(t-4),   4 \\leq t \\leq 5, \\\\\n-0.3 + 0.25\\,(t-5),   5 \\leq t \\leq 6.2,\n\\end{cases}\n$$\n该函数在 $[0,6.2]$ 上是连续且分段线性的。在 $[0,\\infty)$ 上定义Skorokhod反射如下：寻找函数 $y:[0,6.2]\\to\\mathbb{R}$ 和 $k:[0,6.2]\\to\\mathbb{R}$，使得对所有 $t$ 满足 $y(t)=x(t)+k(t)$，对所有 $t$ 满足 $y(t)\\geq 0$，$k$ 是非递减函数且 $k(0)=0$，并且由 $k$ 诱导的Lebesgue–Stieltjes测度的支撑集在集合 $\\{t\\in[0,6.2]:y(t)=0\\}$ 上，即 $\\int_{0}^{6.2} \\mathbf{1}_{\\{y(s)0\\}}\\,\\mathrm{d}k(s)=0$。\n\n从 $[0,\\infty)$ 上Skorokhod反射映射的定义性质出发，推导出在整个区间 $[0,6.2]$ 上 $k(t)$ 和 $y(t)$ 的显式闭式表达式。在您的推导中，请证明 $k$ 的非递减性以及 $\\mathrm{d}k$ 的支撑集性质。请以分段定义公式的形式给出 $k(t)$ 和 $y(t)$ 的最终表达式。", "solution": "问题陈述要求解一个在非负半线（即区域 $D = [0, \\infty) \\subset \\mathbb{R}$）上的Skorokhod反射问题。输入路径 $x(t)$ 是一个定义在时间区间 $[0, 6.2]$ 上的给定的连续分段线性函数。我们的任务是找到一对函数 $(y(t), k(t))$，它们对所有 $t \\in [0, 6.2]$ 满足以下四个条件：\n1.  $y(t) = x(t) + k(t)$\n2.  $y(t) \\geq 0$ (反射路径必须停留在区域 $D$ 内)\n3.  $k(0) = 0$ 且 $k(t)$ 是一个非递减函数 (控制过程是累积的且不能减少)\n4.  控制过程 $k(t)$ 仅当路径 $y(t)$ 位于区域边界（即点 $0$）时才起作用。这可以正式地表示为Lebesgue-Stieltjes测度 $\\mathrm{d}k$ 的支撑集在集合 $\\{t : y(t) = 0\\}$ 上，即 $\\int_{0}^{6.2} \\mathbf{1}_{\\{y(s)0\\}}\\,\\mathrm{d}k(s)=0$。\n\n对于一个连续的输入路径 $x(t)$，这个问题是适定的，并且有唯一解。解由以下显式公式给出：\n$$\nk(t) = \\max\\left(0, -\\inf_{s \\in [0, t]} x(s)\\right)\n$$\n$$\ny(t) = x(t) + k(t)\n$$\n首先，我们验证这些公式满足所需的条件。令 $m(t) = \\inf_{s \\in [0, t]} x(s)$。\n关系 $y(t) = x(t) + k(t)$ 根据定义成立。\n输入路径由 $x(t) = t$ ($0 \\leq t \\leq 1$) 给出，因此 $x(0) = 0$。在 $t=0$ 处使用 $k(t)$ 的公式：\n$k(0) = \\max(0, -m(0)) = \\max(0, -x(0)) = \\max(0, 0) = 0$。初始条件得到满足。\n\n为了证明 $k(t)$ 的非递减性，考虑 $0 \\leq t_1  t_2 \\leq 6.2$。取下确界的区间扩大了，即 $[0, t_1] \\subset [0, t_2]$。因此，$m(t_2) = \\inf_{s \\in [0, t_2]} x(s) \\leq \\inf_{s \\in [0, t_1]} x(s) = m(t_1)$。这意味着 $-m(t_2) \\geq -m(t_1)$。由于函数 $\\max(0, \\cdot)$ 是非递减的，我们有 $k(t_2) = \\max(0, -m(t_2)) \\geq \\max(0, -m(t_1)) = k(t_1)$。因此，$k(t)$ 是非递减的。\n\n对于 $y(t)$ 的非负性，我们有 $y(t) = x(t) + \\max(0, -m(t))$。\n如果 $-m(t) \\leq 0$，那么 $k(t) = 0$ 且 $y(t) = x(t)$。在这种情况下，$m(t) = \\inf_{s \\in [0, t]} x(s) \\geq 0$。由于 $t \\in [0,t]$，我们有 $x(t) \\geq m(t) \\geq 0$。因此 $y(t) \\geq 0$。\n如果 $-m(t)  0$，那么 $k(t) = -m(t)$ 且 $y(t) = x(t) - m(t) = x(t) - \\inf_{s \\in [0, t]} x(s)$。根据下确界的定义，$x(t) \\geq \\inf_{s \\in [0, t]} x(s)$，所以 $y(t) \\geq 0$。在所有情况下，$y(t) \\geq 0$。\n\n最后，我们证明 $\\mathrm{d}k$ 的支撑集性质。函数 $k(t)$ 是连续的，因为 $x(t)$ 是连续的，这意味着 $m(t)$ 也是连续的。$k(t)$ 是连续函数的复合。对于一个连续非递减函数 $k(t)$，条件 $\\int_{0}^{6.2} \\mathbf{1}_{\\{y(s)0\\}}\\,\\mathrm{d}k(s)=0$ 意味着如果在开区间 $(a,b)$ 上 $y(t)  0$，那么 $k(t)$ 在 $(a,b)$ 上必须是常数。\n假设在 $t \\in (a,b)$ 上 $y(t)0$。那么 $x(t) + k(t)  0$。根据上述分析，这意味着 $x(t) + \\max(0, -m(t))  0$。\n函数 $k(t)$ 仅在 $-m(t)$ 增加时才增加，而这仅在 $m(t)$ 减少时发生。$m(t)$ 在时刻 $t$ 的减少只可能在 $x(t)$ 达到新的最小值时发生，即 $x(t) = m(t)$。\n在这样的时刻 $t$，如果 $k(t)$ 要增加，我们必须有 $m(t)  0$。在这种情况下，$y(t) = x(t) + k(t) = m(t) + (-m(t)) = 0$。\n因此，$k(t)$ 只能在 $y(t)=0$ 的时刻 $t$ 增加。如果 $y(t)0$，$k(t)$ 必须是常数。这证实了支撑集条件。\n\n现在我们对给定的特定 $x(t)$ 进行计算。\n$$\nx(t)=\n\\begin{cases}\nt,  0 \\leq t \\leq 1 \\\\\n2 - t,  1 \\leq t \\leq 3 \\\\\n-1 + 1.5(t-3),  3 \\leq t \\leq 4 \\\\\n0.5 - 0.8(t-4),  4 \\leq t \\leq 5 \\\\\n-0.3 + 0.25(t-5),  5 \\leq t \\leq 6.2\n\\end{cases}\n$$\n我们首先计算游动下确界 $m(t) = \\inf_{s \\in [0, t]} x(s)$：\n- 对于 $t \\in [0, 1]$，$x(s)=s$ 从 $0$ 增加到 $1$。所以，$m(t) = \\inf_{s \\in [0,t]} s = 0$。\n- 对于 $t \\in [1, 3]$，$x(s)=2-s$ 从 $1$ 减少到 $-1$。截至时刻 $t$ 的下确界是 $m(t) = \\inf(m(1), \\inf_{s \\in [1,t]} x(s)) = \\inf(0, x(t)) = \\inf(0, 2-t)$。因为当 $t \\leq 2$ 时 $2-t \\geq 0$，当 $t  2$ 时 $2-t  0$，我们有当 $t \\in [1,2]$ 时 $m(t) = 0$，当 $t \\in [2,3]$ 时 $m(t) = 2-t$。\n- 对于 $t \\in [3, 4]$，$x(s)=-1 + 1.5(s-3)$ 从 $-1$ 增加到 $0.5$。下确界 $m(t) = \\inf(m(3), \\inf_{s \\in [3,t]} x(s)) = \\inf(-1, x(3)) = \\inf(-1, -1) = -1$。\n- 对于 $t \\in [4, 5]$，$x(s)=0.5 - 0.8(s-4)$ 从 $0.5$ 减少到 $-0.3$。下确界 $m(t) = \\inf(m(4), \\inf_{s \\in [4,t]} x(s)) = \\inf(-1, x(t)) = \\inf(-1, 0.5 - 0.8(t-4))$。对于 $t \\in [4,5]$，表达式 $0.5 - 0.8(t-4)$ 总是大于 $-1$。所以，$m(t) = -1$。\n- 对于 $t \\in [5, 6.2]$，$x(s)=-0.3 + 0.25(s-5)$ 从 $-0.3$ 增加到 $0$。下确界 $m(t) = \\inf(m(5), \\inf_{s \\in [5,t]} x(s)) = \\inf(-1, x(5)) = \\inf(-1, -0.3) = -1$。\n\n总而言之，游动下确界是：\n$$\nm(t) =\n\\begin{cases}\n0,  0 \\leq t \\leq 2 \\\\\n2-t,  2 \\leq t \\leq 3 \\\\\n-1,  3 \\leq t \\leq 6.2\n\\end{cases}\n$$\n接下来，我们计算 $k(t) = \\max(0, -m(t))$：\n- 对于 $t \\in [0, 2]$，$m(t) = 0$，所以 $k(t) = \\max(0, 0) = 0$。\n- 对于 $t \\in [2, 3]$，$m(t) = 2-t \\leq 0$，所以 $k(t) = \\max(0, -(2-t)) = \\max(0, t-2)$。因为 $t \\geq 2$，$t-2 \\geq 0$，因此 $k(t) = t-2$。\n- 对于 $t \\in [3, 6.2]$，$m(t) = -1$，所以 $k(t) = \\max(0, -(-1)) = \\max(0, 1) = 1$。\n\n所以，控制过程 $k(t)$ 是：\n$$\nk(t) =\n\\begin{cases}\n0,  0 \\leq t \\leq 2 \\\\\nt-2,  2 \\leq t \\leq 3 \\\\\n1,  3 \\leq t \\leq 6.2\n\\end{cases}\n$$\n最后，我们通过组合分段定义来计算反射路径 $y(t) = x(t) + k(t)$：\n- 对于 $t \\in [0, 1]: y(t) = x(t)+k(t) = t + 0 = t$。\n- 对于 $t \\in [1, 2]: y(t) = x(t)+k(t) = (2-t) + 0 = 2-t$。\n- 对于 $t \\in [2, 3]: y(t) = x(t)+k(t) = (2-t) + (t-2) = 0$。\n- 对于 $t \\in [3, 4]: y(t) = x(t)+k(t) = (-1 + 1.5(t-3)) + 1 = 1.5(t-3)$。\n- 对于 $t \\in [4, 5]: y(t) = x(t)+k(t) = (0.5 - 0.8(t-4)) + 1 = 1.5 - 0.8(t-4)$。\n- 对于 $t \\in [5, 6.2]: y(t) = x(t)+k(t) = (-0.3 + 0.25(t-5)) + 1 = 0.7 + 0.25(t-5)$。\n\n这就给出了反射路径 $y(t)$ 的完整分段定义。\n$$\ny(t) =\n\\begin{cases}\nt,  0 \\leq t \\leq 1 \\\\\n2 - t,  1 \\leq t \\leq 2 \\\\\n0,  2 \\leq t \\leq 3 \\\\\n1.5(t-3),  3 \\leq t \\leq 4 \\\\\n1.5 - 0.8(t-4),  4 \\leq t \\leq 5 \\\\\n0.7 + 0.25(t-5),  5 \\leq t \\leq 6.2\n\\end{cases}\n$$\n$k(t)$ 和 $y(t)$ 的这些表达式构成了Skorokhod问题的解。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nk(t) = \n\\begin{cases}\n0,  0 \\leq t \\leq 2 \\\\\nt-2,  2 \\leq t \\leq 3 \\\\\n1,  3 \\leq t \\leq 6.2\n\\end{cases}\n\\\\\\\\\ny(t) = \n\\begin{cases}\nt,  0 \\leq t \\leq 1 \\\\\n2 - t,  1 \\leq t \\leq 2 \\\\\n0,  2 \\leq t \\leq 3 \\\\\n1.5(t-3),  3 \\leq t \\leq 4 \\\\\n1.5 - 0.8(t-4),  4 \\leq t \\leq 5 \\\\\n0.7 + 0.25(t-5),  5 \\leq t \\leq 6.2\n\\end{cases}\n\\end{pmatrix}\n}\n$$", "id": "3081591"}, {"introduction": "现实世界中的许多系统不仅经历连续变化，还会受到突然冲击或跳跃的影响。这个练习将斯科罗霍德问题的应用扩展到处理这类不连续的输入路径，具体来说，是一个复合泊松过程的实现轨迹。通过解决这个问题，你将学会反射机制如何瞬时响应负向跳跃，通过调节器 $K_t$ 的跳跃来立即将过程推回边界，从而保持其在允许的范围内 [@problem_id:3081635]。", "problem": "考虑在 $0$ 处有下界反射的 Skorokhod 反射问题 (SRP)。设输入为一个带漂移的复合泊松过程，由下式给出\n$$\nX_t = x_0 + \\beta t + \\sum_{i=1}^{N_t} J_i,\n$$\n其中 $N_t$ 是一个速率为 $\\lambda0$ 的泊松过程，跳跃大小 $(J_i)_{i\\ge 1}$ 是独立同分布的负随机变量。假设在区间 $[0,T]$ 上观测到一条实现轨迹，其中 $T=4$，参数为 $x_0=1$, $\\beta=0.7$，并在时间 $T_1=0.5$, $T_2=1.6$, $T_3=3.2$ 发生三次跳跃，跳跃大小分别为 $J_1=-1.2$, $J_2=-2.3$, $J_3=-0.9$。Skorokhod 反射旨在寻找满足 $Y_t=X_t+K_t$，$Y_t\\ge 0$，$K_t$ 是非递减的且 $K_0=0$ 的 $(Y_t,K_t)_{t\\in[0,T]}$，以及最小性条件，即 $K$ 仅在 $Y$ 处于边界时才增加，其意义在于对所有 $t\\in[0,T]$，都有 $\\int_{0}^{t} Y_s\\, \\mathrm{d}K_s = 0$。\n\n仅使用 Skorokhod 反射的这些定义性质，确定 $Y_T$ 和 $K_T$ 的值，并通过计算 $\\Delta K_{T_1}$、$\\Delta K_{T_2}$ 和 $\\Delta K_{T_3}$ 来验证在跳跃时间 $T_1$、$T_2$ 和 $T_3$ 时 $K$ 的跳跃大小，其中 $\\Delta K_t := K_t - K_{t-}$。将您的最终答案以行向量的形式给出\n$$\n\\bigl(Y_T,\\; K_T,\\; \\Delta K_{T_1},\\; \\Delta K_{T_2},\\; \\Delta K_{T_3}\\bigr).\n$$\n无需四舍五入；报告精确值。", "solution": "该问题要求确定反射过程 $(Y_t, K_t)$ 在最终时间 $T$ 的状态，以及调节项在特定时间的跳跃大小。该过程由一个下界在 $0$ 的 Skorokhod 反射问题 (SRP) 定义。\n\n对于区间 $[0,T]$ 上的输入过程 $X_t$，Skorokhod 反射 $(Y_t, K_t)$ 的定义性质如下：\n1. 对所有 $t \\in [0, T]$，$Y_t = X_t + K_t$。\n2. 对所有 $t \\in [0, T]$，$Y_t \\ge 0$。\n3. $K_t$ 是一个非递减函数，且 $K_0 = 0$。\n4. $K_t$ 仅在 $Y_t$ 处于边界时增加，这个条件可形式化为 $\\int_{0}^{t} Y_s\\, \\mathrm{d}K_s = 0$。\n\n对于在 $0$ 处有下界反射的一维过程，这些性质唯一地确定了对 $(Y_t, K_t)$。调节项 $K_t$ 由以下公式给出：\n$$\nK_t = \\max\\left(0, \\sup_{s \\in [0,t]} (-X_s)\\right)\n$$\n那么反射过程为：\n$$\nY_t = X_t + K_t = X_t + \\max\\left(0, \\sup_{s \\in [0,t]} (-X_s)\\right)\n$$\n我们已知输入过程 $X_t$ 在区间 $[0, 4]$ 上的一个特定实现。该过程定义为：\n$$\nX_t = x_0 + \\beta t + \\sum_{i=1}^{N_t} J_i\n$$\n该实现的参数为 $x_0=1$, $\\beta=0.7$, $T=4$。在时间 $T_1=0.5$, $T_2=1.6$ 和 $T_3=3.2$ 处发生三次跳跃，各自的大小为 $J_1=-1.2$, $J_2=-2.3$ 和 $J_3=-0.9$。\n\n我们将构建 $X_t$ 的路径，并由此得出 $K_t$ 和 $Y_t$ 在区间 $[0, 4]$ 上的路径。令 $M_t = \\sup_{s \\in [0,t]} (-X_s)$。那么 $K_t = \\max(0, M_t)$。\n\n**区间 1：$t \\in [0, 0.5)$**\n过程从 $X_0 = x_0 = 1$ 开始。在此区间内没有跳跃发生。\n$X_t = 1 + 0.7t$。\n该函数是递增的。在 $[0, 0.5)$ 上 $X_t$ 的最小值为 $t=0$ 时的 $X_0=1$。\n因此，$-X_t$ 是递减的，其上确界在 $t=0$ 处：$M_t = \\sup_{s \\in [0,t]} (-X_s) = -X_0 = -1$。\n$K_t = \\max(0, -1) = 0$。\n$Y_t = X_t + K_t = 1 + 0.7t$。\n就在第一次跳跃 $t=0.5$ 之前：\n$X_{0.5^-} = 1 + 0.7(0.5) = 1 + 0.35 = 1.35$。\n$K_{0.5^-} = 0$。\n$Y_{0.5^-} = 1.35$。\n\n**跳跃 1：在 $t = T_1 = 0.5$**\n发生一次大小为 $J_1 = -1.2$ 的跳跃。\n$X_{0.5} = X_{0.5^-} + J_1 = 1.35 - 1.2 = 0.15$。\n此时 $-X_s$ 的上确界是 $M_{0.5} = \\sup_{s \\in [0, 0.5]} (-X_s) = \\max(M_{0.5^-}, -X_{0.5}) = \\max(-1, -0.15) = -0.15$。\n$K_{0.5} = \\max(0, -0.15) = 0$。\n$K$ 的跳跃为 $\\Delta K_{0.5} = K_{0.5} - K_{0.5^-} = 0 - 0 = 0$。\n$Y_{0.5} = X_{0.5} + K_{0.5} = 0.15 + 0 = 0.15$。由于 $Y_{0.5}  0$，不需要反射。\n\n**区间 2：$t \\in (0.5, 1.6)$**\n对于此区间内的 $t$，$X_t = x_0 + \\beta t + J_1 = 1 + 0.7t - 1.2 = -0.2 + 0.7t$。\n该函数是递增的。其在 $t=0.5$ 时的值为 $0.15$。对于 $t0.5$，$X_t  0.15$。\n因此，$-X_t$ 是负数且递减。\n上确界 $M_t = \\sup_{s \\in [0,t]} (-X_s)$ 从 $t=0.5$ 时的值保持不变，所以 $M_t = -0.15$。\n$K_t = \\max(0, -0.15) = 0$。\n$Y_t = X_t + K_t = X_t = -0.2 + 0.7t$。\n就在第二次跳跃 $t=1.6$ 之前：\n$X_{1.6^-} = -0.2 + 0.7(1.6) = -0.2 + 1.12 = 0.92$。\n$K_{1.6^-} = 0$。\n$Y_{1.6^-} = 0.92$。\n\n**跳跃 2：在 $t = T_2 = 1.6$**\n发生一次大小为 $J_2 = -2.3$ 的跳跃。\n$X_{1.6} = X_{1.6^-} + J_2 = 0.92 - 2.3 = -1.38$。\n过程 $X_t$ 变为负值。我们必须更新上确界。\n$M_{1.6} = \\sup_{s \\in [0, 1.6]} (-X_s) = \\max(M_{1.6^-}, -X_{1.6}) = \\max(-0.15, -(-1.38)) = \\max(-0.15, 1.38) = 1.38$。\n$K_{1.6} = \\max(0, 1.38) = 1.38$。\n$K$ 的跳跃为 $\\Delta K_{1.6} = K_{1.6} - K_{1.6^-} = 1.38 - 0 = 1.38$。\n$Y_{1.6} = X_{1.6} + K_{1.6} = -1.38 + 1.38 = 0$。反射将过程推回到边界。\n\n**区间 3：$t \\in (1.6, 3.2)$**\n对于此区间内的 $t$，$X_t = x_0 + \\beta t + J_1 + J_2 = 1 + 0.7t - 1.2 - 2.3 = -2.5 + 0.7t$。\n该函数是递增的。在 $t=1.6$ 时，$X_{1.6} = -1.38$。对于 $t1.6$，$X_t  -1.38$。\n这意味着 $-X_t  1.38$。\n上确界 $M_t = \\sup_{s \\in [0,t]} (-X_s)$ 保持在 $t=1.6$ 时设定的值，所以 $M_t = 1.38$。\n$K_t = \\max(0, 1.38) = 1.38$。调节项在此区间内是常数。\n$Y_t = X_t + K_t = (-2.5 + 0.7t) + 1.38 = -1.12 + 0.7t$。\n注意到 $Y_{1.6} = -1.12 + 0.7(1.6) = 0$，并且对于 $t1.6$, $Y_t  0$。这与 $K_t$ 是常数相一致。\n就在第三次跳跃 $t=3.2$ 之前：\n$X_{3.2^-} = -2.5 + 0.7(3.2) = -2.5 + 2.24 = -0.26$。\n$K_{3.2^-} = 1.38$。\n$Y_{3.2^-} = X_{3.2^-} + K_{3.2^-} = -0.26 + 1.38 = 1.12$。\n\n**跳跃 3：在 $t = T_3 = 3.2$**\n发生一次大小为 $J_3 = -0.9$ 的跳跃。\n$X_{3.2} = X_{3.2^-} + J_3 = -0.26 - 0.9 = -1.16$。\n我们检查这是否为 $-X_s$ 创造了新的上确界。\n$M_{3.2} = \\sup_{s \\in [0, 3.2]} (-X_s) = \\max(M_{3.2^-}, -X_{3.2}) = \\max(1.38, -(-1.16)) = \\max(1.38, 1.16) = 1.38$。\n上确界没有改变。\n$K_{3.2} = \\max(0, 1.38) = 1.38$。\n$K$ 的跳跃为 $\\Delta K_{3.2} = K_{3.2} - K_{3.2^-} = 1.38 - 1.38 = 0$。\n$Y_{3.2} = X_{3.2} + K_{3.2} = -1.16 + 1.38 = 0.22$。由于 $Y_{3.2}  0$，不需要反射。\n\n**区间 4：$t \\in (3.2, 4]$**\n对于此区间内的 $t$，$X_t = x_0 + \\beta t + J_1 + J_2 + J_3 = 1 + 0.7t - 1.2 - 2.3 - 0.9 = -3.4 + 0.7t$。\n该函数是递增的。在 $t=3.2$ 时，$X_{3.2} = -1.16$。对于 $t3.2$，$X_t  -1.16$。\n所以 $-X_t  1.16$。\n上确界 $M_t = \\sup_{s \\in [0,t]} (-X_s)$ 仍然是 $M_t = 1.38$。\n$K_t = \\max(0, 1.38) = 1.38$。调节项是常数。\n在最终时间 $T=4$ 时：\n$X_T = X_4 = -3.4 + 0.7(4) = -3.4 + 2.8 = -0.6$。\n$K_T = K_4 = 1.38$。\n$Y_T = Y_4 = X_4 + K_4 = -0.6 + 1.38 = 0.78$。\n\n所需的值为：\n- $Y_T = Y_4 = 0.78$\n- $K_T = K_4 = 1.38$\n- $\\Delta K_{T_1} = \\Delta K_{0.5} = 0$\n- $\\Delta K_{T_2} = \\Delta K_{1.6} = 1.38$\n- $\\Delta K_{T_3} = \\Delta K_{3.2} = 0$\n\n我们将这些结果组合成所要求的行向量 $(Y_T, K_T, \\Delta K_{T_1}, \\Delta K_{T_2}, \\Delta K_{T_3})$。\n最终的向量是 $(0.78, 1.38, 0, 1.38, 0)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.78  1.38  0  1.38  0\n\\end{pmatrix}\n}\n$$", "id": "3081635"}, {"introduction": "在掌握了单侧反射之后，我们来探讨一个更普遍的情形：双侧反射。许多系统都受到上下两个边界的约束，例如缓冲区的容量或金融头寸的范围。这个练习引入了双侧斯科罗霍德问题，它需要两个调节器 $L(t)$ 和 $U(t)$ 分别在下边界和上边界起作用。通过构造被限制在区间 $[0,1]$ 内的路径，你将学会如何在两个边界上应用反射原理，这展示了该模型的强大灵活性 [@problem_id:3081567]。", "problem": "考虑区间 $\\left[0,1\\right]$ 上的双边Skorokhod反射问题。给定一个连续输入路径 $\\xi:[0,1]\\to\\mathbb{R}$，任务是找到一个由连续函数构成的三元组 $(X,L,U)$，使得：\n- 对所有 $t\\in[0,1]$，都有 $X(t)=\\xi(t)+L(t)-U(t)$，\n- 对所有 $t\\in[0,1]$，都有 $X(t)\\in[0,1]$，\n- $L$ 和 $U$ 是非减函数，且 $L(0)=U(0)=0$，\n- $L$ 仅在 $X(t)=0$ 时增加，$U$ 仅在 $X(t)=1$ 时增加（最小性）。\n\n将以下确定性、连续、分段线性路径视为在 $[0,1]$ 上从 $0$ 到 $0$ 的布朗桥的一个特定实现：\n\n$$\n\\xi(t)=\n\\begin{cases}\n7t,  t\\in\\left[0,\\frac{1}{5}\\right],\\\\\n\\frac{7}{5}-6\\left(t-\\frac{1}{5}\\right),  t\\in\\left(\\frac{1}{5},\\frac{1}{2}\\right],\\\\\n-\\frac{2}{5}+8\\left(t-\\frac{1}{2}\\right),  t\\in\\left(\\frac{1}{2},\\frac{4}{5}\\right],\\\\\n2-10\\left(t-\\frac{4}{5}\\right),  t\\in\\left(\\frac{4}{5},1\\right].\n\\end{cases}\n$$\n\n仅使用上述定义性质（不使用任何现成公式），构建反射路径 $X$ 和调节项 $L$ 和 $U$。精确指出每个调节项在 $[0,1]$ 的哪些子区间上增加。最后，计算终端累积调节量 $L(1)$ 和 $U(1)$。以行向量 $\\left(L(1),U(1)\\right)$ 的精确形式报告你的最终答案。无需四舍五入。", "solution": "所提出的问题是双边Skorokhod反射问题的一个适定、确定性的实例。输入路径 $\\xi(t)$ 是连续的，并且所有定义性质都是标准的且在数学上是合理的。因此，该问题是有效的。\n\n我们的任务是为给定的输入路径 $\\xi(t)$ 构建在区间 $[0,1]$ 上的反射路径 $X(t)$ 及其相关的非减调节项 $L(t)$ 和 $U(t)$。关系由 $X(t) = \\xi(t) + L(t) - U(t)$ 定义，其约束条件为：对所有 $t$，$X(t) \\in [0,1]$；$L(0)=U(0)=0$；$L(t)$ 和 $U(t)$ 分别仅在 $X(t)=0$ 和 $X(t)=1$ 时增加。\n\n我们将通过分析路径 $\\xi(t)$ 在其分段定义的区间上的行为来构建解 $(X, L, U)$。这种路径跟踪方法是定义性质的直接实现。\n\n首先，我们验证 $t=0$ 时的初始条件。输入路径始于 $\\xi(0)=7(0)=0$。在 $L(0)=0$ 和 $U(0)=0$ 的条件下，我们有 $X(0) = \\xi(0)+L(0)-U(0)=0$，该值位于区间 $[0,1]$ 内。\n\n**区间 1：$t \\in [0, \\frac{1}{5}]$**\n在此区间，$\\xi(t) = 7t$。\n最初，对于小的 $t0$，$\\xi(t)$ 在 $(0,1)$ 内，所以不需要调节。我们设置 $L(t)=0$ 和 $U(t)=0$。这得到 $X(t) = \\xi(t) = 7t$。\n这在 $X(t)$ 碰到边界之前都有效。当 $7t=1$ 时，$X(t)=1$，即在 $t=1/7$ 时。\n所以，对于 $t \\in [0, 1/7]$：\n$L(t)=0$, $U(t)=0$, $X(t)=7t$。\n\n对于 $t \\in (1/7, 1/5]$，$\\xi(t)$ 继续增加，现在超过了 $1$。为了保持 $X(t) \\le 1$，调节项 $U(t)$ 必须增加。另一个调节项 $L(t)$ 保持在 $L(1/7)=0$ 不变，因为 $X(t)$ 不在下边界 $0$ 处。为了将 $X(t)$ 维持在上边界，我们设置 $X(t)=1$。\n从 $X(t) = \\xi(t) + L(t) - U(t)$，我们有 $1 = 7t + 0 - U(t)$，这给出 $U(t) = 7t-1$。\n这个表达式在 $t=1/7$ 处是连续的，因为 $7(1/7)-1=0$，这是 $U(1/7)$ 的值。调节项 $U(t)$ 在 $(1/7, 1/5]$ 上严格增加。\n在这个区间的末端，$t=1/5$ 时：\n$L(1/5) = 0$。\n$U(1/5) = 7(1/5) - 1 = 2/5$。\n$X(1/5) = 1$。\n\n**区间 2：$t \\in (\\frac{1}{5}, \\frac{1}{2}]$**\n在此区间, $\\xi(t) = \\frac{7}{5} - 6(t-\\frac{1}{5}) = \\frac{13}{5} - 6t$。这是一条递减路径。\n在 $t=1/5$ 时，我们有 $L(1/5)=0$ 和 $U(1/5)=2/5$。对于 $t  1/5$，我们暂时保持调节项不变。无约束路径变为 $X(t) = \\xi(t) + L(1/5) - U(1/5) = (\\frac{13}{5} - 6t) + 0 - \\frac{2}{5} = \\frac{11}{5} - 6t$。\n这条路径从 $X(1/5)=1$ 开始并递减。它保持在 $[0,1]$ 内，直到碰到 $0$。\n$X(t)=0 \\implies \\frac{11}{5}-6t = 0 \\implies t=11/30$。因为 $1/5  11/30  1/2$，这发生在当前区间内。\n对于 $t \\in (1/5, 11/30]$：\n$L(t)=0$, $U(t)=2/5$, $X(t)=\\frac{11}{5}-6t$。\n\n对于 $t \\in (11/30, 1/2]$，无约束路径会变为负数。为了保持 $X(t) \\ge 0$，$L(t)$ 必须增加。$U(t)$ 必须保持在 $U(11/30)=2/5$ 不变，因为 $X(t)$ 不在上边界 $1$ 处。我们设置 $X(t)=0$。\n从 $X(t) = \\xi(t) + L(t) - U(t)$，我们有 $0 = (\\frac{13}{5}-6t) + L(t) - \\frac{2}{5}$，这意味着 $L(t) = 6t - \\frac{11}{5}$。\n这在 $t=11/30$ 处是连续的，因为 $6(11/30)-11/5 = 0=L(11/30)$。调节项 $L(t)$ 在 $(11/30, 1/2]$ 上严格增加。\n在这个区间的末端，$t=1/2$ 时：\n$L(1/2) = 6(1/2)-11/5 = 3-11/5=4/5$。\n$U(1/2) = 2/5$。\n$X(1/2) = 0$。\n\n**区间 3：$t \\in (\\frac{1}{2}, \\frac{4}{5}]$**\n在此区间, $\\xi(t) = -\\frac{2}{5} + 8(t-\\frac{1}{2}) = 8t - \\frac{22}{5}$。这是一条递增路径。\n在 $t=1/2$ 时，我们有 $L(1/2)=4/5$ 和 $U(1/2)=2/5$。无约束路径是 $X(t) = \\xi(t) + L(1/2) - U(1/2) = (8t - \\frac{22}{5}) + \\frac{4}{5} - \\frac{2}{5} = 8t - 4$。\n这条路径从 $X(1/2)=0$ 开始并递增。它保持在 $[0,1]$ 内，直到碰到 $1$。\n$X(t)=1 \\implies 8t - 4 = 1 \\implies t=5/8$。因为 $1/2  5/8  4/5$，这发生在当前区间内。\n对于 $t \\in (1/2, 5/8]$：\n$L(t)=4/5$, $U(t)=2/5$, $X(t) = 8t-4$。\n\n对于 $t \\in (5/8, 4/5]$，无约束路径会超过 $1$。为了保持 $X(t) \\le 1$，$U(t)$ 必须增加，而 $L(t)$ 保持在 $L(5/8)=4/5$ 不变。我们设置 $X(t)=1$。\n从 $X(t) = \\xi(t) + L(t) - U(t)$，我们有 $1 = (8t - \\frac{22}{5}) + \\frac{4}{5} - U(t)$，这得到 $U(t) = 8t - \\frac{18}{5} - 1 = 8t - \\frac{23}{5}$。\n这在 $t=5/8$ 处是连续的，因为 $8(5/8)-23/5=5-23/5=2/5=U(5/8)$。调节项 $U(t)$ 在 $(5/8, 4/5]$ 上严格增加。\n在这个区间的末端，$t=4/5$ 时：\n$L(4/5) = 4/5$。\n$U(4/5) = 8(4/5) - 23/5 = 32/5 - 23/5 = 9/5$。\n$X(4/5) = 1$。\n\n**区间 4：$t \\in (\\frac{4}{5}, 1]$**\n在此区间, $\\xi(t) = 2 - 10(t-\\frac{4}{5}) = 10-10t$。这是一条递减路径。\n在 $t=4/5$ 时，我们有 $L(4/5)=4/5$ 和 $U(4/5)=9/5$。无约束路径是 $X(t) = \\xi(t) + L(4/5) - U(4/5) = (10-10t) + \\frac{4}{5} - \\frac{9}{5} = 9-10t$。\n这条路径从 $X(4/5)=1$ 开始递减，在 $9-10t=0 \\implies t=9/10$ 时碰到 $0$。\n对于 $t \\in (4/5, 9/10]$：\n$L(t)=4/5$, $U(t)=9/5$, $X(t) = 9-10t$。\n\n对于 $t \\in (9/10, 1]$，无约束路径将为负。$L(t)$ 必须增加，而 $U(t)$ 保持在 $U(9/10)=9/5$ 不变。我们设置 $X(t)=0$。\n从 $X(t) = \\xi(t) + L(t) - U(t)$，我们有 $0 = (10-10t) + L(t) - \\frac{9}{5}$，这意味着 $L(t) = 10t - 10 + \\frac{9}{5} = 10t - \\frac{41}{5}$。\n这在 $t=9/10$ 处是连续的，因为 $10(9/10)-41/5=9-41/5=4/5=L(9/10)$。调节项 $L(t)$ 在 $(9/10, 1]$ 上严格增加。\n在终端时刻 $t=1$ 时：\n$U(1) = 9/5$。\n$L(1) = 10(1)-\\frac{41}{5} = \\frac{50-41}{5} = \\frac{9}{5}$。\n\n构建完成。调节项在以下子区间上增加：\n- $L(t)$ 在 $(11/30, 1/2]$ 和 $(9/10, 1]$ 上增加。\n- $U(t)$ 在 $(1/7, 1/5]$ 和 $(5/8, 4/5]$ 上增加。\n\n终端累积调节量为 $L(1) = 9/5$ 和 $U(1) = 9/5$。\n最终答案是行向量 $(L(1), U(1))$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{9}{5}  \\frac{9}{5}\n\\end{pmatrix}\n}\n$$", "id": "3081567"}]}