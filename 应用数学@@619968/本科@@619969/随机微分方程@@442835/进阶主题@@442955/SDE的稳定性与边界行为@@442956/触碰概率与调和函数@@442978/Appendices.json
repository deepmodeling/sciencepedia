{"hands_on_practices": [{"introduction": "我们从最基本也是最重要的随机过程——标准布朗运动——开始我们的实践。计算一个粒子首次到达某个特定位置所需的时间，即首达时间，是许多应用中的一个基本问题。本练习将引导你使用一种巧妙且直观的概率论工具，即反射原理，来推导布朗运动首达时间的精确分布[@problem_id:3058442]。", "problem": "设 $\\{B_t : t \\ge 0\\}$ 为一维标准布朗运动，且 $B_0 = 0$。对于一个固定的水平 $a > 0$，定义首次穿越时间 $\\tau_a := \\inf\\{t \\ge 0 : B_t = a\\}$。仅从布朗运动的定义性质（独立平稳高斯增量、样本路径的连续性以及强马尔可夫性质）出发，推导 $\\tau_a$ 的分布函数。特别地，证明对于任意 $t > 0$，有 $\\mathbb{P}(\\tau_a \\le t) = \\mathbb{P}(|B_t| \\ge a)$，然后确定 $\\tau_a$ 在 $(0,\\infty)$ 上的概率密度函数 (PDF)。你的最终答案必须是关于 $a$ 和 $t$ 的 $\\tau_a$ 的PDF的单个闭式解析表达式。无需四舍五入。", "solution": "所述问题具有科学依据，是适定且客观的。这是随机过程理论中的一个标准问题，依赖于布朗运动的基本定义和性质。所有必要信息均已提供，问题没有任何逻辑矛盾或事实错误。因此，我们可以进行形式化推导。\n\n设 $\\{B_t : t \\ge 0\\}$ 为从 $B_0 = 0$ 开始的一维标准布朗运动。我们将使用的定义性质如下：\n1. 对于任意 $0 \\le s  t$，增量 $B_t - B_s$ 是一个均值为 $0$、方差为 $t-s$ 的高斯随机变量，即 $B_t - B_s \\sim \\mathcal{N}(0, t-s)$。不相交时间区间上的增量是独立的。这蕴含了增量的平稳性和独立性。\n2. 样本路径 $t \\mapsto B_t(\\omega)$ 几乎必然连续。\n3. 该过程具有强马尔可夫性质，即对于关于 $B_t$ 的自然滤子流的任意停时 $\\tau$，过程 $\\{B_{\\tau+t} - B_\\tau : t \\ge 0\\}$ 是一个标准布朗运动，且独立于 $\\tau$ 前的 sigma-代数 $\\mathcal{F}_\\tau$。\n\n我们需要求解固定水平 $a > 0$ 下首次穿越时间 $\\tau_a = \\inf\\{t \\ge 0 : B_t = a\\}$ 的概率密度函数 (PDF)。\n\n推导过程主要分为两步。首先，我们确定 $\\tau_a$ 的累积分布函数 (CDF)，记为 $F_{\\tau_a}(t) = \\mathbb{P}(\\tau_a \\le t)$。其次，我们对 CDF 求导以得到 PDF，$f_{\\tau_a}(t)$。\n\n**第一步：推导 $\\tau_a$ 的累积分布函数 (CDF)**\n\n我们的目标是证明对于任意 $t > 0$，$\\mathbb{P}(\\tau_a \\le t) = \\mathbb{P}(|B_t| \\ge a)$。\n考虑事件 $\\{\\tau_a \\le t\\}$，这意味着过程在时间 $t$ 或之前达到了水平 $a$。我们可以根据 $B_t$ 的值对该事件进行划分。使用全概率公式，我们写出：\n$$\n\\mathbb{P}(\\tau_a \\le t) = \\mathbb{P}(\\tau_a \\le t, B_t \\ge a) + \\mathbb{P}(\\tau_a \\le t, B_t  a)\n$$\n我们来分析第一项。由于 $B_0 = 0$ 且样本路径是连续的，要使过程达到一个值 $B_t \\ge a$，它必须在小于或等于 $t$ 的某个时刻穿过水平 $a$。这意味着事件 $\\{B_t \\ge a\\}$ 蕴含了事件 $\\{\\tau_a \\le t\\}$。因此，它们的交集就是事件 $\\{B_t \\ge a\\}$：\n$$\n\\{\\tau_a \\le t, B_t \\ge a\\} = \\{B_t \\ge a\\}\n$$\n因此，第一项变为 $\\mathbb{P}(\\tau_a \\le t, B_t \\ge a) = \\mathbb{P}(B_t \\ge a)$。\n\n现在，我们利用停时 $\\tau_a$ 处的强马尔可夫性质来分析第二项 $\\mathbb{P}(\\tau_a \\le t, B_t  a)$。\n在事件 $\\{\\tau_a \\le t\\}$ 上，强马尔可夫性质意味着对于 $s \\ge 0$，过程 $X_s := B_{\\tau_a + s} - B_{\\tau_a}$ 是一个标准布朗运动，且独立于滤子流 $\\mathcal{F}_{\\tau_a}$。根据连续性，$B_{\\tau_a} = a$。\n条件 $B_t  a$ 可以用 $\\tau_a$ 之后的过程序列来重写。在集合 $\\{\\omega : \\tau_a(\\omega) \\le t\\}$ 上，我们有：\n$$\nB_t = B_{\\tau_a + (t - \\tau_a)} = B_{\\tau_a} + (B_{\\tau_a + (t - \\tau_a)} - B_{\\tau_a}) = a + X_{t-\\tau_a}\n$$\n因此条件 $B_t  a$ 等价于 $a + X_{t-\\tau_a}  a$，可简化为 $X_{t-\\tau_a}  0$。\n所以，\n$$\n\\mathbb{P}(\\tau_a \\le t, B_t  a) = \\mathbb{P}(\\tau_a \\le t, X_{t-\\tau_a}  0)\n$$\n我们可以使用条件概率来计算这个概率。设 $\\mathbb{I}_A$ 为事件 $A$ 的指示函数。\n\\begin{align*}\n\\mathbb{P}(\\tau_a \\le t, B_t  a) = \\mathbb{E}[\\mathbb{I}_{\\{\\tau_a \\le t\\}} \\mathbb{I}_{\\{B_t  a\\}}] \\\\\n= \\mathbb{E}[\\mathbb{E}[\\mathbb{I}_{\\{\\tau_a \\le t\\}} \\mathbb{I}_{\\{B_t  a\\}} | \\mathcal{F}_{\\tau_a}]] \\\\\n= \\mathbb{E}[\\mathbb{I}_{\\{\\tau_a \\le t\\}} \\mathbb{P}(B_t  a | \\mathcal{F}_{\\tau_a})] \\quad \\text{(因为 } \\{\\tau_a \\le t\\} \\in \\mathcal{F}_{\\tau_a})\n\\end{align*}\n在事件 $\\{\\tau_a \\le t\\}$ 上，我们有 $B_t  a \\iff X_{t-\\tau_a}  0$。由于过程 $X$ 独立于 $\\mathcal{F}_{\\tau_a}$，且 $\\tau_a$ 是 $\\mathcal{F}_{\\tau_a}$-可测的，我们有：\n$$\n\\mathbb{P}(B_t  a | \\mathcal{F}_{\\tau_a}) = \\mathbb{P}(X_{t-\\tau_a}  0 | \\mathcal{F}_{\\tau_a}) = \\mathbb{P}(X_{t-\\tau_a}  0)\n$$\n随机变量 $X_{t-\\tau_a}$ 服从以 $0$ 为中心的​​正态分布。根据高斯分布的对称性，$\\mathbb{P}(X_{t-\\tau_a}  0) = \\frac{1}{2}$。\n这得出：\n$$\n\\mathbb{P}(\\tau_a \\le t, B_t  a) = \\mathbb{E}\\left[\\mathbb{I}_{\\{\\tau_a \\le t\\}} \\cdot \\frac{1}{2}\\right] = \\frac{1}{2} \\mathbb{P}(\\tau_a \\le t)\n$$\n将我们对两项的发现代入原始方程：\n$$\n\\mathbb{P}(\\tau_a \\le t) = \\mathbb{P}(B_t \\ge a) + \\frac{1}{2} \\mathbb{P}(\\tau_a \\le t)\n$$\n求解 $\\mathbb{P}(\\tau_a \\le t)$，我们得到：\n$$\n\\frac{1}{2} \\mathbb{P}(\\tau_a \\le t) = \\mathbb{P}(B_t \\ge a) \\implies \\mathbb{P}(\\tau_a \\le t) = 2 \\mathbb{P}(B_t \\ge a)\n$$\n这个结果被称为反射原理。为了完成问题的第一部分，我们必须将其与 $\\mathbb{P}(|B_t| \\ge a)$ 联系起来。\n对于标准布朗运动，$B_t \\sim \\mathcal{N}(0,t)$。$B_t$ 的分布关于 $0$ 对称。因此，对于任意 $a > 0$，有 $\\mathbb{P}(B_t \\ge a) = \\mathbb{P}(B_t \\le -a)$。\n事件 $\\{|B_t| \\ge a\\}$ 是 $\\{B_t \\ge a\\}$ 和 $\\{B_t \\le -a\\}$ 的不交并集（因为 $\\mathbb{P}(B_t=a)=0$）。\n$$\n\\mathbb{P}(|B_t| \\ge a) = \\mathbb{P}(B_t \\ge a) + \\mathbb{P}(B_t \\le -a) = \\mathbb{P}(B_t \\ge a) + \\mathbb{P}(B_t \\ge a) = 2 \\mathbb{P}(B_t \\ge a)\n$$\n将此与我们推导出的 $\\mathbb{P}(\\tau_a \\le t)$ 的表达式进行比较，我们便证明了所要求的恒等式：\n$$\n\\mathbb{P}(\\tau_a \\le t) = \\mathbb{P}(|B_t| \\ge a)\n$$\n\n**第二步：推导 $\\tau_a$ 的概率密度函数 (PDF)**\n\n对于 $t > 0$，$\\tau_a$ 的 CDF 为 $F_{\\tau_a}(t) = \\mathbb{P}(\\tau_a \\le t) = 2 \\mathbb{P}(B_t \\ge a)$。\n设 $Z$ 是一个标准正态随机变量，$Z \\sim \\mathcal{N}(0,1)$。我们可以写出 $B_t = \\sqrt{t} Z$。\n$$\nF_{\\tau_a}(t) = 2 \\mathbb{P}(\\sqrt{t} Z \\ge a) = 2 \\mathbb{P}\\left(Z \\ge \\frac{a}{\\sqrt{t}}\\right)\n$$\n设 $\\Phi(z) = \\mathbb{P}(Z \\le z)$ 是标准正态分布的 CDF。那么 $\\mathbb{P}(Z \\ge z) = 1 - \\Phi(z)$。\n$$\nF_{\\tau_a}(t) = 2 \\left(1 - \\Phi\\left(\\frac{a}{\\sqrt{t}}\\right)\\right)\n$$\nPDF，$f_{\\tau_a}(t)$，是 CDF 关于 $t$ 的导数，对于 $t>0$。\n$$\nf_{\\tau_a}(t) = \\frac{d}{dt} F_{\\tau_a}(t) = \\frac{d}{dt} \\left[2 \\left(1 - \\Phi\\left(a t^{-1/2}\\right)\\right)\\right] = -2 \\frac{d}{dt} \\Phi\\left(a t^{-1/2}\\right)\n$$\n使用链式法则，并注意到 $\\frac{d}{dz}\\Phi(z) = \\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right)$ 是标准正态分布的 PDF：\n\\begin{align*}\nf_{\\tau_a}(t) = -2 \\cdot \\phi\\left(a t^{-1/2}\\right) \\cdot \\frac{d}{dt}\\left(a t^{-1/2}\\right) \\\\\n= -2 \\cdot \\phi\\left(\\frac{a}{\\sqrt{t}}\\right) \\cdot \\left(a \\cdot \\left(-\\frac{1}{2}\\right) t^{-3/2}\\right) \\\\\n= -2 \\cdot \\phi\\left(\\frac{a}{\\sqrt{t}}\\right) \\cdot \\left(-\\frac{a}{2 t^{3/2}}\\right) \\\\\n= \\frac{a}{t^{3/2}} \\phi\\left(\\frac{a}{\\sqrt{t}}\\right)\n\\end{align*}\n现在我们代入 $\\phi(z)$ 的表达式：\n$$\nf_{\\tau_a}(t) = \\frac{a}{t^{3/2}} \\cdot \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1}{2} \\left(\\frac{a}{\\sqrt{t}}\\right)^2\\right) = \\frac{a}{t^{3/2} \\sqrt{2\\pi}} \\exp\\left(-\\frac{a^2}{2t}\\right)\n$$\n这就是对于 $t > 0$ 的首次穿越时间 $\\tau_a$ 的 PDF。该分布是莱维分布的一个实例。该表达式在 $t \\in (0, \\infty)$ 上有效。\n\n最后检查：对于 $a > 0$ 和 $t > 0$，导出的函数是严格为正的。可以证明积分 $\\int_0^\\infty f_{\\tau_a}(t) dt$ 等于 $1$，这证实了它是一个有效的概率密度函数。\n\n最终结果是 PDF 的闭式解析表达式。\n$$\nf_{\\tau_a}(t) = \\frac{a}{\\sqrt{2\\pi} t^{3/2}} \\exp\\left(-\\frac{a^2}{2t}\\right)\n$$", "answer": "$$\\boxed{\\frac{a}{\\sqrt{2\\pi} t^{3/2}} \\exp\\left(-\\frac{a^2}{2t}\\right)}$$", "id": "3058442"}, {"introduction": "现实世界中的随机过程很少像标准布朗运动那样“行为良好”。当过程的漂移和波动率依赖于其当前状态时，像反射原理这样的简单工具便不再适用。本练习将带你处理一个更具一般性的伊藤过程，并学习如何通过求解一个常微分方程来计算其在两个边界之一首先被吸收的概率[@problem_id:3073474]。这个强大的分析方法揭示了随机过程理论与微分方程之间的深刻联系，是求解触碰概率问题的核心技术。", "problem": "考虑一维随机微分方程 (SDE)\n$$\ndX_{t} = X_{t}\\,dt + \\sqrt{1+X_{t}^{2}}\\,dW_{t},\n$$\n其中 $W_{t}$ 是一个标准布朗运动 (BM)。设 $a  x_0  b$。过程从 $X_0 = x_0$ 出发。计算该过程在到达边界 $a$ 之前先到达边界 $b$ 的概率。你的答案应为关于 $a$、$b$ 和 $x_0$ 的封闭形式表达式。", "solution": "该问题要求计算一个一维扩散过程在给定区间 $(a,b)$ 的上边界 $b$ 处退出的概率。过程 $X_t$ 由以下随机微分方程 (SDE) 控制：\n$$\ndX_{t} = X_{t}\\,dt + \\sqrt{1+X_{t}^{2}}\\,dW_{t}\n$$\n初始状态为 $X_0 = x_0 \\in (a, b)$。\n\n该 SDE 具有一般形式 $dX_t = \\mu(X_t)dt + \\sigma(X_t)dW_t$，其中漂移系数为 $\\mu(x) = x$，扩散系数为 $\\sigma(x) = \\sqrt{1+x^2}$。\n\n触及概率定义为 $u(x) = \\mathbb{P}_{x}(X_{\\tau}=b)$，其中 $\\tau = \\inf\\{t \\ge 0 : X_t \\notin (a,b)\\}$ 是首次离开区间 $(a,b)$ 的时间。\n\n一维扩散理论中的一个基本结果（可由 Dynkin 公式导出）指出，触及概率 $u(x)$ 是由过程的无穷小生成元定义的边值问题 (BVP) 的解。对于一个漂移为 $\\mu(x)$、扩散为 $\\sigma(x)$ 的扩散过程，其无穷小生成元 $\\mathcal{L}$ 由以下算子给出：\n$$\n\\mathcal{L} = \\mu(x)\\frac{d}{dx} + \\frac{1}{2}\\sigma(x)^2\\frac{d^2}{dx^2}\n$$\n对于给定的特定过程 $X_t$，其生成元为：\n$$\n\\mathcal{L} = x\\frac{d}{dx} + \\frac{1}{2}\\left(\\sqrt{1+x^2}\\right)^2\\frac{d^2}{dx^2} = x\\frac{d}{dx} + \\frac{1}{2}(1+x^2)\\frac{d^2}{dx^2}\n$$\n触及概率 $u(x)$ 对所有 $x \\in (a,b)$ 满足二阶常微分方程 (ODE) $\\mathcal{L}u(x) = 0$。这是因为当 $\\mathcal{L}u = 0$ 时，过程 $u(X_t)$ 是一个鞅，并且可选停止定理可以应用于停时 $\\tau$。\n\n因此，$u(x)$ 的边值问题 (BVP) 是：\n$$\n\\frac{1}{2}(1+x^2)\\frac{d^2u}{dx^2} + x\\frac{du}{dx} = 0, \\quad x\\in(a,b)\n$$\n边界条件由吸收的定义确定。如果过程从边界开始，它会立即被吸收。\n如果 $x=a$，过程在未触及 $b$ 的情况下触及了 $a$，因此在 $b$ 处退出的概率为 $0$。所以，$u(a) = 0$。\n如果 $x=b$，过程触及了 $b$，因此在 $b$ 处退出的概率为 $1$。所以，$u(b) = 1$。\n\n需要求解的边值问题是：\n$$\n\\begin{cases}\n\\frac{1}{2}(1+x^2)u''(x) + xu'(x) = 0 \\\\\nu(a) = 0 \\\\\nu(b) = 1\n\\end{cases}\n$$\n为了求解该常微分方程，我们可以使用降阶法。令 $v(x) = u'(x)$。方程变为关于 $v(x)$ 的一阶线性常微分方程：\n$$\n\\frac{1}{2}(1+x^2)v'(x) + xv(x) = 0\n$$\n这是一个可分离方程：\n$$\n\\frac{v'(x)}{v(x)} = -\\frac{2x}{1+x^2}\n$$\n对两边关于 $x$ 积分：\n$$\n\\int \\frac{1}{v} dv = \\int -\\frac{2x}{1+x^2} dx\n$$\n右侧的积分为 $-\\ln(1+x^2)$ (因为 $1+x^2>0$)。\n$$\n\\ln|v(x)| = -\\ln(1+x^2) + K_0\n$$\n其中 $K_0$ 是一个积分常数。对两边取指数，得到：\n$$\n|v(x)| = \\exp(K_0) \\exp(-\\ln(1+x^2)) = \\frac{\\exp(K_0)}{1+x^2}\n$$\n将符号和常数吸收到一个新的常数 $C_1$ 中：\n$$\nv(x) = \\frac{C_1}{1+x^2}\n$$\n由于 $v(x) = u'(x)$，我们再次积分以求得 $u(x)$：\n$$\nu(x) = \\int u'(x) dx = \\int \\frac{C_1}{1+x^2} dx = C_1 \\arctan(x) + C_2\n$$\n其中 $C_2$ 是第二个积分常数。\n\n现在我们应用边界条件来确定 $C_1$ 和 $C_2$：\n1. $u(a) = 0 \\implies C_1 \\arctan(a) + C_2 = 0$\n2. $u(b) = 1 \\implies C_1 \\arctan(b) + C_2 = 1$\n\n由方程 1，我们得到 $C_2 = -C_1 \\arctan(a)$。将此代入方程 2：\n$$\nC_1 \\arctan(b) - C_1 \\arctan(a) = 1\n$$\n$$\nC_1 (\\arctan(b) - \\arctan(a)) = 1\n$$\n求解 $C_1$：\n$$\nC_1 = \\frac{1}{\\arctan(b) - \\arctan(a)}\n$$\n注意，由于 $a  b$，我们有 $\\arctan(a)  \\arctan(b)$，所以分母不为零。\n现在求解 $C_2$：\n$$\nC_2 = -C_1 \\arctan(a) = -\\frac{\\arctan(a)}{\\arctan(b) - \\arctan(a)}\n$$\n将 $C_1$ 和 $C_2$ 代回 $u(x)$ 的表达式：\n$$\nu(x) = \\frac{1}{\\arctan(b) - \\arctan(a)}\\arctan(x) - \\frac{\\arctan(a)}{\\arctan(b) - \\arctan(a)}\n$$\n$$\nu(x) = \\frac{\\arctan(x) - \\arctan(a)}{\\arctan(b) - \\arctan(a)}\n$$\n这是从 $x$ 出发在 $a$ 之前击中 $b$ 的概率。问题要求的是从 $x_0$ 出发的概率，所以我们只需将 $x$ 替换为 $x_0$。\n\n最终解是：\n$$\nu(x_0) = \\frac{\\arctan(x_0) - \\arctan(a)}{\\arctan(b) - \\arctan(a)}\n$$", "answer": "$$\n\\boxed{\\frac{\\arctan(x_{0}) - \\arctan(a)}{\\arctan(b) - \\arctan(a)}}\n$$", "id": "3073474"}, {"introduction": "在解决了具体问题之后，让我们退后一步，提炼出解决一维扩散过程触碰概率问题的普适理论。为什么反射原理会失效？是否存在一种万能方法来处理所有情况？本练习将通过引入一个核心概念——尺度函数（scale function）——来回答这些问题[@problem_id:3058453]。掌握尺度函数不仅能让你从根本上理解为何某些方法有效，还能为你提供一个统一的框架来解决所有这类问题。", "problem": "考虑一维伊藤随机微分方程 (SDE) $dX_t = \\mu(X_t)\\,dt + \\sigma(X_t)\\,dW_t$，其中 $W_t$ 是一个标准布朗运动 (BM)，$\\mu$ 和 $\\sigma$ 是可测函数，其中 $\\sigma$ 是连续的，并且对所有 $x \\in \\mathbb{R}$ 满足 $0  \\sigma_0 \\le \\sigma(x) \\le \\sigma_1  \\infty$。该 SDE 存在唯一的非爆炸弱解。固定一个区间 $(a,b)$，其中 $a  b$，并定义首次击中时间 $\\tau_a = \\inf\\{t \\ge 0 : X_t = a\\}$ 和 $\\tau_b = \\inf\\{t \\ge 0 : X_t = b\\}$。令 $u(x) = \\mathbb{P}_x\\{\\tau_b  \\tau_a\\}$ 表示从 $X_0 = x \\in (a,b)$ 出发，在击中 $a$ 之前先击中 $b$ 的概率。当系数为常数时，经典的布朗运动反射原理常用于计算击中概率和上确界分布。你的任务是分析对于非常数扩散系数 $\\sigma(x)$，类似反射原理的论证何时会失效，并找出一个有效的替代方法。\n\n下列哪个陈述是正确的？\n\nA. 对于无漂移扩散 $dX_t = \\sigma(X_t)\\,dW_t$（其中 $\\mu \\equiv 0$ 且 $\\sigma$ 非常数），在水平 $b$ 处的路径反射保持其分布，并得到 $u(x) = \\dfrac{x-a}{b-a}$，与常系数布朗运动的情况完全相同。\n\nB. 函数 $u(x) = \\mathbb{P}_x\\{\\tau_b  \\tau_a\\}$ 的特征是边值问题 $L u = 0$ 在 $(a,b)$ 上的唯一有界解，边界条件为 $u(a) = 0$ 和 $u(b) = 1$，其中无穷小生成元 $L$ 作用于二阶连续可微函数 $f$ 的方式为 $L f(x) = \\dfrac{1}{2}\\sigma^2(x)\\,f''(x) + \\mu(x)\\,f'(x)$。\n\nC. 即使当 $\\sigma$ 非常数且 $\\mu \\equiv 0$ 时，对所有 $T > 0$，其上确界分布仍满足反射恒等式 $\\mathbb{P}_x\\{\\sup_{t \\le T} X_t \\ge b\\} = 2\\,\\mathbb{P}_x\\{X_T \\ge b\\}$。\n\nD. 反射原理的一个稳健的替代方法是变换到尺度坐标 $s(x)$，其定义为（相差一个仿射变换）$s'(x) = \\exp\\!\\Big(-\\displaystyle\\int^x \\dfrac{2\\mu(y)}{\\sigma^2(y)}\\,dy\\Big)$；在此坐标下，扩散过程没有漂移项，并且击中概率是关于 $s$ 的线性函数，即 $u(x) = \\dfrac{s(x) - s(a)}{s(b) - s(a)}$。\n\nE. 人们总可以通过应用时间变换 $\\theta(t) = \\displaystyle\\int_0^t \\sigma^{-2}(X_s)\\,ds$ 来恢复反射原理，这个变换将 $X$ 变为标准布朗运动，因此对于所有 $\\mu$ 和 $\\sigma$ 的选择，$u(x)$ 都是关于 $x$ 的线性函数。", "solution": "用户希望我扮演一名 STEM 教授，解决一个关于一维伊藤 SDE 击中概率的多项选择题。\n\n我的解题过程如下：\n1.  **验证问题陈述**：我需要检查问题是否定义良好、有科学依据，并且符合说明中设定的所有标准。\n2.  **解决问题**：如果问题有效，我将推导关于一般一维 SDE 击中概率的正确理论。\n3.  **评估每个选项**：我将基于推导出的理论，仔细分析每个陈述（A, B, C, D, E），并判断其正确与否。\n\n**第一部分：问题验证**\n\n*   **第1步：提取已知条件**\n    *   SDE: $dX_t = \\mu(X_t)\\,dt + \\sigma(X_t)\\,dW_t$\n    *   $W_t$: 标准布朗运动 (BM)\n    *   $\\mu, \\sigma$: 可测函数\n    *   $\\sigma$: 连续且对所有 $x \\in \\mathbb{R}$ 满足 $0  \\sigma_0 \\le \\sigma(x) \\le \\sigma_1  \\infty$。\n    *   SDE 存在唯一的非爆炸弱解。\n    *   区间: $(a,b)$ 且 $a  b$。\n    *   击中时间: $\\tau_a = \\inf\\{t \\ge 0 : X_t = a\\}$ 和 $\\tau_b = \\inf\\{t \\ge 0 : X_t = b\\}$。\n    *   击中概率: $u(x) = \\mathbb{P}_x\\{\\tau_b  \\tau_a\\}$，对于 $X_0 = x \\in (a,b)$。\n    *   任务：分析对于非常数 $\\sigma(x)$，类似反射原理的论证何时会失效，并找出一个有效的替代方法。\n\n*   **第2步：使用提取的已知条件进行验证**\n    *   **有科学依据**：问题根植于成熟的随机微分方程理论，特别是伊藤积分、击中时间和无穷小生成元。这些是随机过程中的标准课题。对 $\\mu$ 和 $\\sigma$ 的假设（可测性、$\\sigma$ 的连续性和有界性）是确保解的存在性和唯一性（例如，如陈述所述的弱解）的标准条件。该问题完全在数学和随机分析的范畴内。**结论：通过**。\n    *   **定义良好**：问题要求评估关于击中概率 $u(x)$ 性质的陈述。在给定条件下，$u(x)$ 是一个定义明确的量。问题的结构旨在测试对该领域标准结果的理解。所提供的信息足以分析这些选项。**结论：通过**。\n    *   **客观性**：语言精确且数学化。诸如“伊藤 SDE”、“标准布朗运动”、“无穷小生成元”、“击中概率”和“尺度函数”等术语在随机过程的背景下具有清晰、普遍接受的定义。没有主观或基于意见的内容。**结论：通过**。\n\n*   **第3步：结论与行动**\n    *   问题是**有效的**。这是一个随机微分方程中的标准问题。我可以进入解答阶段。\n\n**第二部分：求解推导**\n\n我需要分析一般一维 SDE $dX_t = \\mu(X_t)\\,dt + \\sigma(X_t)\\,dW_t$ 的击中概率 $u(x) = \\mathbb{P}_x\\{\\tau_b  \\tau_a\\}$ 的性质。\n\n令 $\\tau = \\tau_a \\wedge \\tau_b = \\min(\\tau_a, \\tau_b)$。对于 $x \\in (a,b)$，如果从 $x$ 出发的过程序列 $X_t$ 退出区间 $(a,b)$ 的时间几乎必然是有限的。解是非爆炸的以及 $\\sigma$ 有界的条件足以保证 $\\mathbb{P}_x\\{\\tau  \\infty\\} = 1$。这意味着 $\\mathbb{P}_x\\{\\tau_a  \\tau_b\\} + \\mathbb{P}_x\\{\\tau_b  \\tau_a\\} = 1$，所以 $\\mathbb{P}_x\\{\\tau_a  \\tau_b\\} = 1 - u(x)$。\n\n将击中概率与微分方程联系起来的关键结果来自 Feynman-Kac 公式，或者更直接地，来自 $u(X_{t \\wedge \\tau})$ 是一个鞅的事实。令 $f(x)$ 是一个 $C^2$ 函数。根据伊藤公式，\n$$df(X_t) = f'(X_t) dX_t + \\frac{1}{2} f''(X_t) d\\langle X \\rangle_t$$\n$$df(X_t) = f'(X_t)(\\mu(X_t)dt + \\sigma(X_t)dW_t) + \\frac{1}{2} f''(X_t) \\sigma^2(X_t) dt$$\n$$df(X_t) = [f'(X_t)\\mu(X_t) + \\frac{1}{2} f''(X_t)\\sigma^2(X_t)] dt + f'(X_t)\\sigma(X_t)dW_t$$\n方括号中的项是无穷小生成元 $L$ 作用于 $f$ 的结果，即 $Lf(x) = \\mu(x)f'(x) + \\frac{1}{2}\\sigma^2(x)f''(x)$。\n所以，$df(X_t) = Lf(X_t) dt + f'(X_t)\\sigma(X_t)dW_t$。\n\n已知击中概率 $u(x)$ 是边值问题 (BVP) 的解：\n$$L u(x) = 0 \\quad \\text{for } x \\in (a,b)$$\n$$u(a) = 0, \\quad u(b) = 1$$\n让我们来验证一下。如果 $Lu=0$，则 $d(u(X_t)) = u'(X_t)\\sigma(X_t) dW_t$。这意味着 $u(X_t)$ 是一个局部鞅。在给定条件下（例如，$u$ 是有界的），$u(X_{t \\wedge \\tau})$ 是一个真鞅。\n根据可选停止定理，对于 $X_0=x$：\n$$u(x) = \\mathbb{E}_x[u(X_0)] = \\mathbb{E}_x[u(X_\\tau)]$$\n过程在时间 $\\tau$ 停止于 $a$ 或 $b$。所以 $X_\\tau$ 是 $a$ 或 $b$。\n$$\\mathbb{E}_x[u(X_\\tau)] = u(a) \\mathbb{P}_x\\{X_\\tau = a\\} + u(b) \\mathbb{P}_x\\{X_\\tau = b\\}$$\n我们有 $\\mathbb{P}_x\\{X_\\tau = b\\} = \\mathbb{P}_x\\{\\tau_b  \\tau_a\\} = u(x)$ 和 $\\mathbb{P}_x\\{X_\\tau = a\\} = \\mathbb{P}_x\\{\\tau_a  \\tau_b\\} = 1 - u(x)$。\n如果我们设置边界条件 $u(a)=0$ 和 $u(b)=1$，我们得到：\n$$u(x) = 0 \\cdot (1-u(x)) + 1 \\cdot u(x) = u(x)$$\n这证实了如果一个函数 $u(x)$ 满足 $Lu=0$ 和边界条件 $u(a)=0, u(b)=1$，它就代表击中概率。这个边值问题需要求解。\n\n该常微分方程 (ODE) 是：\n$$\\frac{1}{2}\\sigma^2(x)u''(x) + \\mu(x)u'(x) = 0$$\n令 $v(x) = u'(x)$。这是一个关于 $v$ 的一阶线性 ODE：\n$$\\frac{1}{2}\\sigma^2(x)v'(x) + \\mu(x)v(x) = 0$$\n$$\\frac{v'(x)}{v(x)} = -\\frac{2\\mu(x)}{\\sigma^2(x)}$$\n积分得到：\n$$\\ln|v(x)| = -\\int^x \\frac{2\\mu(y)}{\\sigma^2(y)} dy + C_0$$\n$$v(x) = C_1 \\exp\\left(-\\int^x \\frac{2\\mu(y)}{\\sigma^2(y)} dy\\right)$$\n指数内的这个表达式与“尺度函数”有关。\n尺度函数 $s(x)$ 由 $s''(x) + \\frac{2\\mu(x)}{\\sigma^2(x)} s'(x) = 0$ 定义。所以 $s'(x)$ 与 $\\exp\\left(-\\int^x \\frac{2\\mu(y)}{\\sigma^2(y)} dy\\right)$ 成正比。让我们将尺度函数 $s(x)$ 定义为它的一个积分：\n$$s(x) = \\int_c^x \\exp\\left(-\\int_c^z \\frac{2\\mu(y)}{\\sigma^2(y)} dy\\right) dz$$\n对于某个常数 $c$。对 $s(x)$ 的积分常数的具体选择只会导致一个仿射变换 $s(x) \\to A s(x) + B$，这不会改变 $u(x)$ 的最终结果。\n因为 $u'(x) = v(x)$，我们有：\n$$u'(x) = C_1 \\exp\\left(-\\int^x \\frac{2\\mu(y)}{\\sigma^2(y)} dy\\right)$$\n与尺度函数的定义比较，我们看到 $u'(x)$ 与 $s'(x)$ 成正比。\n所以，$u(x)$ 必须是 $s(x)$ 的线性函数。\n$$u(x) = K_1 s(x) + K_2$$\n我们使用边界条件 $u(a) = 0$ 和 $u(b) = 1$ 来找到常数 $K_1$ 和 $K_2$：\n$$0 = K_1 s(a) + K_2$$\n$$1 = K_1 s(b) + K_2$$\n用第二个方程减去第一个方程得到 $1 = K_1(s(b) - s(a))$，所以 $K_1 = \\frac{1}{s(b) - s(a)}$。\n从第一个方程得到，$K_2 = -K_1 s(a) = -\\frac{s(a)}{s(b) - s(a)}$。\n代入回去：\n$$u(x) = \\frac{1}{s(b) - s(a)} s(x) - \\frac{s(a)}{s(b) - s(a)} = \\frac{s(x) - s(a)}{s(b) - s(a)}$$\n这是一个基本结果。它对满足问题条件的任何 $\\mu$ 和 $\\sigma$ 都成立。\n\n现在，让我们分析反射的概念。标准布朗运动 $W_t$ 的反射原理指出，对于 $b>0$，过程 $W_t$ 和反射过程 $\\hat{W}_t = W_t$（当 $t  \\tau_b$）及 $\\hat{W}_t = 2b - W_t$（当 $t \\ge \\tau_b$）具有相同的分布。这是强马尔可夫性质和布朗运动增量对称性的结果。这个原理依赖于过程的空间齐次性。\n\n对于一般 SDE $dX_t = \\sigma(X_t) dW_t$，无穷小生成元是 $L = \\frac{1}{2}\\sigma^2(x) \\frac{d^2}{dx^2}$。如果 $\\sigma(x)$ 不是常数，则过程不再是空间齐次的。在水平 $b$ 处反射路径意味着将路径段从 $X_t$ 映到 $2b - X_t$。反射路径 $\\tilde{X}_t = 2b - X_t$ 的动力学将由不同的 SDE 控制。令 $Y_t = 2b - X_t$。则 $dY_t = -dX_t = -\\sigma(X_t)dW_t = -\\sigma(2b - Y_t)dW_t$。该过程的分布与 $X_t$ 的分布不同，除非 $\\sigma(x)$ 是关于 $b$ 的偶函数，即 $\\sigma(b+z)=\\sigma(b-z)$。对于一般的非常数 $\\sigma$，反射原理失效。\n\n让我们检查一下时间变换的论点。令 $X_t$ 解 $dX_t = \\mu(X_t)dt + \\sigma(X_t)dW_t$。\n尺度函数变换 $Y_t = s(X_t)$ 得到一个零漂移过程。让我们用伊藤公式来检验：\n$dY_t = s'(X_t) dX_t + \\frac{1}{2} s''(X_t) d\\langle X \\rangle_t$\n$dY_t = s'(X_t)(\\mu(X_t)dt + \\sigma(X_t)dW_t) + \\frac{1}{2} s''(X_t) \\sigma^2(X_t) dt$\n$dY_t = [s'(X_t)\\mu(X_t) + \\frac{1}{2} s''(X_t)\\sigma^2(X_t)]dt + s'(X_t)\\sigma(X_t)dW_t$\n漂移项是 $s'(X_t)\\mu(X_t) + \\frac{1}{2} s''(X_t)\\sigma^2(X_t) = \\frac{1}{2}\\sigma^2(X_t) s'(X_t) \\left( \\frac{2\\mu(X_t)}{\\sigma^2(X_t)} + \\frac{s''(X_t)}{s'(X_t)} \\right)$。\n从尺度函数的定义来看，$\\frac{s''(x)}{s'(x)} = -\\frac{2\\mu(x)}{\\sigma^2(x)}$，所以漂移项为零。\n所以，$Y_t = s(X_t)$ 满足 SDE $dY_t = s'(X_t)\\sigma(X_t) dW_t$。\n令 $\\tilde{\\sigma}(y) = s'(s^{-1}(y)) \\sigma(s^{-1}(y))$。则 $dY_t = \\tilde{\\sigma}(Y_t) dW_t$。\n过程 $Y_t$ 是一个无漂移扩散，但它不是标准布朗运动，除非 $\\tilde{\\sigma}(y)$ 是一个常数（我们可以将其缩放为1）。这通常不成立。\n\n还有另一种变换：时间变换。令 $Y_t$ 是一个无漂移扩散：$dY_t = \\tilde{\\sigma}(Y_t) dW_t$。令 $\\theta_t = \\int_0^t \\tilde{\\sigma}^{-2}(Y_s) ds$。这是一个随机时间变换。令 $\\tau_t = \\inf\\{s: \\theta_s > t\\}$ 为其逆。那么过程 $B_t = Y_{\\tau_t}$ 是一个标准布朗运动。这就是 Dubins-Schwarz 定理。\n因此，任何一维扩散过程都可以通过空间变换（尺度函数）和时间变换的组合，转换为标准布朗运动。\n\n现在我们来评估每个选项。\n\n**选项 A：对于无漂移扩散 $dX_t = \\sigma(X_t)\\,dW_t$（其中 $\\mu \\equiv 0$ 且 $\\sigma$ 非常数），在水平 $b$ 处的路径反射保持其分布，并得到 $u(x) = \\dfrac{x-a}{b-a}$，与常系数布朗运动的情况完全相同。**\n\n该陈述是两个主张的结合。第一个主张是对于具有非常数扩散系数 $\\sigma(x)$ 的无漂移 SDE，路径反射保持其分布。如初步分析所示，一个关于水平 $b$ 反射的路径 $X_t$ 变为 $\\tilde{X}_t = 2b - X_t$，将满足 SDE $d\\tilde{X}_t = -\\sigma(2b - \\tilde{X}_t)dW_t$。为了使这个反射过程与原过程具有相同的分布，我们需要 $\\sigma(y)$ 在分布上等于 $-\\sigma(2b-y)$。这通常要求 $\\sigma(y) = \\sigma(2b-y)$，即 $\\sigma(x)$ 必须关于点 $b$ 对称。对于一般的非常数函数 $\\sigma(x)$，这并不成立。因此，反射原理失效。由于其核心理由（“路径反射……保持其分布”）是错误的，整个陈述是错误的。虽然当 $\\mu \\equiv 0$ 时，击中概率确实是 $u(x) = \\frac{x-a}{b-a}$（因为 $Lu = \\frac{1}{2}\\sigma^2(x)u''(x)=0$ 意味着 $u''(x)=0$），但在这个一般情况下，这个结果并不是反射原理的推论。\n\n**结论：错误**\n\n**选项 B：函数 $u(x) = \\mathbb{P}_x\\{\\tau_b  \\tau_a\\}$ 的特征是边值问题 $L u = 0$ 在 $(a,b)$ 上的唯一有界解，边界条件为 $u(a) = 0$ 和 $u(b) = 1$，其中无穷小生成元 $L$ 作用于二阶连续可微函数 $f$ 的方式为 $L f(x) = \\dfrac{1}{2}\\sigma^2(x)\\,f''(x) + \\mu(x)\\,f'(x)$。**\n\n这是一维扩散理论中的一个经典结果。对于函数 $u \\in C^2((a,b)) \\cap C([a,b])$，如果 $Lu=0$，伊藤公式意味着 $u(X_t)$ 是一个局部鞅。在给定的问题条件下，$u(X_{t \\wedge \\tau})$（其中 $\\tau = \\inf\\{t : X_t \\notin (a,b)\\}$）是一个真鞅。应用可选停止定理，我们有 $u(x) = \\mathbb{E}_x[u(X_0)] = \\mathbb{E}_x[u(X_\\tau)]$。由于 $X_\\tau$ 只能是 $a$ 或 $b$，并且我们施加边界条件 $u(a)=0$ 和 $u(b)=1$，我们得到 $u(x) = u(b)\\mathbb{P}_x\\{X_\\tau=b\\} + u(a)\\mathbb{P}_x\\{X_\\tau=a\\} = 1 \\cdot \\mathbb{P}_x\\{\\tau_b  \\tau_a\\} + 0 \\cdot \\mathbb{P}_x\\{\\tau_a  \\tau_b\\} = \\mathbb{P}_x\\{\\tau_b  \\tau_a\\}$。问题陈述提供了充分的条件（非爆炸解，有界且严格为正的 $\\sigma$）来保证这样一个有界解的存在性和唯一性。生成元 $L$ 的形式对于给定的 SDE 是正确的。\n\n**结论：正确**\n\n**选项 C：即使当 $\\sigma$ 非常数且 $\\mu \\equiv 0$ 时，对所有 $T > 0$，其上确界分布仍满足反射恒等式 $\\mathbb{P}_x\\{\\sup_{t \\le T} X_t \\ge b\\} = 2\\,\\mathbb{P}_x\\{X_T \\ge b\\}$。**\n\n这个恒等式是标准布朗运动的一个著名结果，其证明关键依赖于反射原理。如选项A的分析所示，对于具有一般非常数扩散系数 $\\sigma(x)$ 的过程，反射原理不成立。关于 $b$ 反射的路径与原始路径不具有相同的分布，因此没有理由认为相应事件的概率会相等。我们也可以通过将过程 $X_t$（其中 $\\mu=0$）通过时间变换 $\\theta_t = \\int_0^t \\sigma^{-2}(X_s)ds$ 转换为标准布朗运动 $B_u$ 来看出这一点。对于 $X_t$ 的恒等式将是 $\\mathbb{P}_x\\{\\sup_{s\\le T} X_s \\ge b\\} = 2 \\mathbb{P}_x\\{X_T \\ge b\\}$。在时间变换后的图像中，这变为 $\\mathbb{P}_x\\{\\sup_{u \\le \\theta_T} B_u \\ge b\\} = 2 \\mathbb{P}_x\\{B_{\\theta_T} \\ge b\\}$。时间上限 $\\theta_T$ 是一个随机变量，它依赖于 $X_s$（从而依赖于 $B_u$）的路径。布朗运动的反射原理对于固定的、确定性的时间上限 $T$ 是有效的，但通常不适用于依赖路径的随机时间 $\\theta_T$。因此，该恒等式不会继承过来。\n\n**结论：错误**\n\n**选项 D：反射原理的一个稳健的替代方法是变换到尺度坐标 $s(x)$，其定义为（相差一个仿射变换）$s'(x) = \\exp\\!\\Big(-\\displaystyle\\int^x \\dfrac{2\\mu(y)}{\\sigma^2(y)}\\,dy\\Big)$；在此坐标下，扩散过程没有漂移项，并且击中概率是关于 $s$ 的线性函数，即 $u(x) = \\dfrac{s(x) - s(a)}{s(b) - s(a)}$。**\n\n这个陈述正确地指出了尺度函数方法是合适的替代方案。\n1.  函数 $s(x)$ 被定义为 $Ls(x) = 0$ 的解。这导致了 ODE $\\frac{1}{2}\\sigma^2(x)s''(x) + \\mu(x)s'(x) = 0$，等价于 $\\frac{s''(x)}{s'(x)} = -\\frac{2\\mu(x)}{\\sigma^2(x)}$。积分这个方程就给出了陈述中定义的 $s'(x)$（相差一个乘法常数，这对应于 $s(x)$ 的一个仿射变换）。\n2.  如果我们定义一个新过程 $Y_t = s(X_t)$，根据伊藤公式，$Y_t$ 的漂移项是 $Ls(X_t)$，根据尺度函数的构造，它为 $0$。所以，$Y_t$ 是一个无漂移扩散（一个局部鞅）。\n3.  寻找 $u(x) = \\mathbb{P}_x\\{X_t \\text{ hits } b \\text{ before } a\\}$ 的问题等价于寻找 $\\mathbb{P}_{s(x)}\\{Y_t \\text{ hits } s(b) \\text{ before } s(a)\\}$。对于任何无漂移的一维扩散，击中概率在状态变量中是线性的。因此，这个概率是 $\\frac{s(x)-s(a)}{s(b)-s(a)}$。这个公式也可以通过观察 $u(x)$ 和 $s(x)$ 都解同一个 ODE $Lf=0$，因此它们必须是线性相关的，直接推导出来。边界条件 $u(a)=0, u(b)=1$ 将线性关系确定为给定的形式。\n\n**结论：正确**\n\n**选项 E：人们总可以通过应用时间变换 $\\theta(t) = \\displaystyle\\int_0^t \\sigma^{-2}(X_s)\\,ds$ 来恢复反射原理，这个变换将 $X$ 变为标准布朗运动，因此对于所有 $\\mu$ 和 $\\sigma$ 的选择，$u(x)$ 都是关于 $x$ 的线性函数。**\n\n这个陈述包含多个错误。\n1.  将一般的一维扩散 $X_t$ 变换为标准布朗运动需要两个步骤：首先通过尺度函数 $s(x)$ 进行空间坐标变换以消除漂移，然后进行时间变换以使新的扩散系数为1。所提出的时间变换 $\\theta(t) = \\int_0^t \\sigma^{-2}(X_s)ds$ *仅当* 漂移 $\\mu$ 已经为零时才是正确的。对于一般的 $\\mu \\neq 0$，过程 $X_t$ 不是一个局部鞅，这个时间变换不会产生标准布朗运动。\n2.  结论“因此 $u(x)$ 是关于 $x$ 的线性函数”是错误的。如选项D的分析所示，$u(x)$ 是关于*尺度函数* $s(x)$ 的线性函数，而不是关于 $x$ 本身的。只有当尺度函数是 $x$ 的线性函数，即 $s(x) = c_1 x + c_2$ 时，$u(x)$ 才是关于 $x$ 的线性函数。这要求 $s'(x)$ 为常数，根据其定义，这意味着 $\\exp(-\\int^x \\frac{2\\mu(y)}{\\sigma^2(y)}dy)$ 是常数。这仅在 $\\mu(y) \\equiv 0$ 时成立。该陈述声称对于*所有* $\\mu$ 和 $\\sigma$ 的选择都是线性的，这是错误的。\n\n**结论：错误**\n\n正确陈述总结：B 和 D。", "answer": "$$\\boxed{BD}$$", "id": "3058453"}]}