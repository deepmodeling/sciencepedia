{"hands_on_practices": [{"introduction": "我们从一个基本练习开始，计算平方贝塞尔过程的期望值。这个练习将演示如何利用随机微分方程的积分形式和伊藤积分的鞅性质，这是随机分析中的一项核心技能。通过这个计算，我们可以直观地理解维度参数 $\\delta$ 如何作为过程平均平方半径的恒定增长率 [@problem_id:3040417]。", "problem": "设 $\\{X_t\\}_{t \\geq 0}$ 是一个维度为 $\\delta \\geq 0$ 的平方贝塞尔过程，它被定义为以下随机微分方程（SDE）的唯一的非负强解：\n$$\ndX_t \\;=\\; \\delta \\, dt \\;+\\; 2 \\sqrt{X_t}\\, dW_t, \\qquad X_0 = x \\geq 0,\n$$\n其中 $\\{W_t\\}_{t \\geq 0}$ 是一个标准的一维布朗运动，并且当 $X_t=0$ 时，$t \\mapsto \\sqrt{X_t}$ 被解释为 $0$。从该SDE出发，仅使用Itô积分和条件期望的标准性质（不假设任何关于 $X_t$ 期望的现成公式），推导条件期望 $\\,\\mathbb{E}[X_t \\mid X_0 = x]\\,$ 作为一个关于 $t$、$x$ 和 $\\delta$ 的函数的闭式表达式。然后，联系平均平方半径的演化，简要解释 $\\delta$ 的作用。\n\n请以 $x$、$\\delta$ 和 $t$ 的单个符号表达式的形式提供您的最终结果。不需要进行数值近似。", "solution": "该问题要求推导维度为 $\\delta \\geq 0$ 的平方贝塞尔过程 $\\{X_t\\}_{t \\geq 0}$ 的条件期望 $\\,\\mathbb{E}[X_t \\mid X_0 = x]\\,$。该过程由以下随机微分方程（SDE）定义：\n$$\ndX_t \\;=\\; \\delta \\, dt \\;+\\; 2 \\sqrt{X_t}\\, dW_t, \\qquad X_0 = x \\geq 0\n$$\n其中 $\\{W_t\\}_{t \\geq 0}$ 是一个标准的一维布朗运动。\n\n推导必须从该SDE出发，并且仅使用Itô积分和条件期望的标准性质。\n\n首先，我们将SDE写成其积分形式，即对两边从时间 $0$ 到时间 $t$ 进行积分：\n$$\n\\int_0^t dX_s \\;=\\; \\int_0^t \\delta \\, ds \\;+\\; \\int_0^t 2 \\sqrt{X_s}\\, dW_s\n$$\n这得到：\n$$\nX_t - X_0 \\;=\\; \\delta t \\;+\\; 2 \\int_0^t \\sqrt{X_s}\\, dW_s\n$$\n给定初始条件 $X_0 = x$，我们可以写出：\n$$\nX_t \\;=\\; x \\;+\\; \\delta t \\;+\\; 2 \\int_0^t \\sqrt{X_s}\\, dW_s\n$$\n现在，我们计算条件期望 $\\,\\mathbb{E}[X_t \\mid X_0 = x]\\,$。我们将条件期望算子应用于方程的两边。请注意，以事件 $\\{X_0 = x\\}$ 为条件意味着我们将 $X_0$ 视为确定的起始值 $x$。\n$$\n\\mathbb{E}[X_t \\mid X_0 = x] \\;=\\; \\mathbb{E}\\left[x \\;+\\; \\delta t \\;+\\; 2 \\int_0^t \\sqrt{X_s}\\, dW_s \\mid X_0 = x\\right]\n$$\n根据期望的线性性质，我们可以将各项分开：\n$$\n\\mathbb{E}[X_t \\mid X_0 = x] \\;=\\; \\mathbb{E}[x \\mid X_0 = x] \\;+\\; \\mathbb{E}[\\delta t \\mid X_0 = x] \\;+\\; \\mathbb{E}\\left[2 \\int_0^t \\sqrt{X_s}\\, dW_s \\mid X_0 = x\\right]\n$$\n我们来计算右边的每一项：\n1.  项 $x$ 是由初始条件确定的常数。因此，其期望为 $x$：\n    $$\n    \\mathbb{E}[x \\mid X_0 = x] \\;=\\; x\n    $$\n2.  项 $\\delta t$ 也是确定性的，因为对于一个固定的时间 $t$，它是两个常数的乘积。因此：\n    $$\n    \\mathbb{E}[\\delta t \\mid X_0 = x] \\;=\\; \\delta t\n    $$\n3.  第三项涉及一个Itô随机积分。我们可以将常数 $2$ 从期望中提出：\n    $$\n    \\mathbb{E}\\left[2 \\int_0^t \\sqrt{X_s}\\, dW_s \\mid X_0 = x\\right] \\;=\\; 2 \\, \\mathbb{E}\\left[\\int_0^t \\sqrt{X_s}\\, dW_s \\mid X_0 = x\\right]\n    $$\n    Itô积分的一个基本性质是，对于一个合适的被积过程 $\\{H_s\\}_{s \\geq 0}$，随机积分过程 $M_t = \\int_0^t H_s dW_s$ 是一个鞅，条件是该过程是适应的且 $\\mathbb{E}\\left[\\int_0^t H_s^2 \\, ds\\right] < \\infty$。一个从 $M_0=0$ 开始的鞅的关键性质是，其在任何未来时刻的期望为零，即 $\\mathbb{E}[M_t] = 0$。\n\n    在我们的例子中，被积过程是 $H_s = \\sqrt{X_s}$。由于 $\\{X_t\\}$ 是由 $\\{W_t\\}$ 驱动的SDE的解，所以它适应于由 $\\{W_t\\}$ 生成的 filtration。因此，$\\{H_s = \\sqrt{X_s}\\}$ 也是一个适应过程。Itô积分 $\\int_0^t \\sqrt{X_s}\\, dW_s$ 是一个局部鞅。为了使其成为一个真鞅，我们必须验证可积性条件：\n    $$\n    \\mathbb{E}\\left[\\int_0^t \\left(\\sqrt{X_s}\\right)^2 ds\\right] \\;=\\; \\mathbb{E}\\left[\\int_0^t X_s \\, ds\\right] < \\infty\n    $$\n    使用Fubini定理，这等价于 $\\int_0^t \\mathbb{E}[X_s] \\, ds < \\infty$。对于这类SDE的解，一个标准的结论是期望 $\\mathbb{E}[|X_s|]$ 对于有限的 $s$ 是有限的，因此该积分对于有限的 $t$ 也是有限的。所以，过程 $M_t = \\int_0^t \\sqrt{X_s} \\, dW_s$ 是一个真鞅。\n    由于 $M_0 = \\int_0^0 \\sqrt{X_s} \\, dW_s = 0$，鞅性质意味着其条件期望（给定时刻 $0$ 的信息）等于其初始值：\n    $$\n    \\mathbb{E}\\left[\\int_0^t \\sqrt{X_s}\\, dW_s \\mid X_0 = x\\right] \\;=\\; 0\n    $$\n将这些结果代回到 $\\mathbb{E}[X_t \\mid X_0 = x]$ 的方程中，我们得到：\n$$\n\\mathbb{E}[X_t \\mid X_0 = x] \\;=\\; x \\;+\\; \\delta t \\;+\\; 2 \\cdot 0\n$$\n$$\n\\mathbb{E}[X_t \\mid X_0 = x] \\;=\\; x \\;+\\; \\delta t\n$$\n这就是条件期望的闭式表达式。\n\n**$\\delta$的解释：**\n结果 $\\mathbb{E}[X_t \\mid X_0 = x] = x + \\delta t$ 表明，平方贝塞尔过程的期望值随时间线性演化。参数 $\\delta$ 是过程的维度，它充当了平均平方半径的恒定漂移系数。\n- 如果 $\\delta > 0$，平均平方半径随时间线性增加，表明存在一个远离原点的整体漂移。\n- 如果 $\\delta = 0$，平均平方半径保持为其初始值 $x$ 不变。在这种情况下，该过程是一个鞅。\n- 量 $X_t$ 可以解释为在 $\\mathbb{R}^k$（对于整数 $k=\\delta$）中进行随机运动的粒子到原点的欧几里得距离的平方。该公式表明，与原点的平均平方距离随时间线性增长，而增长率恰好是维度 $\\delta$。这个结论可以推广到非整数 $\\delta \\geq 0$。本质上，$\\delta$ 量化了作用于过程平均平方半径的向外“推力”的强度。", "answer": "$$\\boxed{x + \\delta t}$$", "id": "3040417"}, {"introduction": "在计算了基本的期望之后，我们进一步探究贝塞尔过程本身的结构。一个深刻的问题是：对于哪些幂次 $p$，过程 $R_t^p$ 会表现为一个（局部）鞅，即一种“公平游戏”？这个练习要求我们将伊藤公式应用于更一般的幂函数，并通过计算发现使漂移项消失的条件，从而揭示维度 $\\delta$ 与过程的鞅性质之间的深刻联系 [@problem_id:3040461]。", "problem": "令 $\\{R_{t}\\}_{t \\geq 0}$ 为一个维度为 $\\delta > 0$ 的一维贝塞尔过程，定义为随机微分方程 (SDE) $dR_{t} = dB_{t} + \\frac{\\delta - 1}{2 R_{t}} \\, dt$ 在 $(0,\\infty)$ 上的唯一强解，其中 $R_{0} > 0$，且 $\\{B_{t}\\}_{t \\geq 0}$ 是一个标准一维布朗运动。对于一个实指数 $p \\in \\mathbb{R}$，使用从伊藤公式开始的随机微积分来推导随机微分 $d(R_{t}^{p})$，并用 $R_{t}$、$\\delta$ 和 $p$ 明确地表示出漂移系数和扩散系数。然后，确定所有使得过程 $\\{R_{t}^{p}\\}_{t \\geq 0}$ 相对于 $\\{B_{t}\\}_{t \\geq 0}$ 的自然滤子成为局部鞅的 $p$ 值。请以符号形式给出所有此类 $p$ 值的完整集合作为最终答案。", "solution": "我们从维度为 $\\delta > 0$ 的贝塞尔过程的定义开始，它是随机微分方程 (SDE)\n$$\ndR_{t} = dB_{t} + \\frac{\\delta - 1}{2 R_{t}} \\, dt, \\quad R_{0} > 0,\n$$\n的唯一强解，其中 $\\{B_{t}\\}_{t \\geq 0}$ 是一个标准一维布朗运动。我们将对函数 $f(x) = x^{p}$（其中 $x > 0$ 且 $p \\in \\mathbb{R}$）应用伊藤公式。在 $(0,\\infty)$ 上，对于任意实数 $p$，函数 $f$ 都是二阶连续可微的，其导数为\n$$\nf'(x) = p x^{p-1}, \\qquad f''(x) = p(p-1) x^{p-2}.\n$$\n对于一个半鞅 $R_{t}$ 的二阶连续可微函数 $f$，伊藤公式可写为\n$$\ndf(R_{t}) = f'(R_{t}) \\, dR_{t} + \\frac{1}{2} f''(R_{t}) \\, d\\langle R \\rangle_{t},\n$$\n其中 $d\\langle R \\rangle_{t}$ 是 $R_{t}$ 的二次变差。由于 $dR_{t} = dB_{t} + \\frac{\\delta - 1}{2 R_{t}} \\, dt$，我们有 $d\\langle R \\rangle_{t} = d\\langle B \\rangle_{t} = dt$。代入 $f'(R_{t})$ 和 $f''(R_{t})$ 可得\n$$\nd(R_{t}^{p}) = p R_{t}^{p-1} \\, dR_{t} + \\frac{1}{2} p(p-1) R_{t}^{p-2} \\, dt.\n$$\n现在代入 $dR_{t}$ 的 SDE：\n$$\nd(R_{t}^{p}) = p R_{t}^{p-1} \\left( dB_{t} + \\frac{\\delta - 1}{2 R_{t}} \\, dt \\right) + \\frac{1}{2} p(p-1) R_{t}^{p-2} \\, dt.\n$$\n展开并合并各项，以分离鞅（扩散）部分和漂移部分：\n$$\nd(R_{t}^{p}) = p R_{t}^{p-1} \\, dB_{t} + \\left[ \\frac{p(\\delta - 1)}{2} R_{t}^{p-2} + \\frac{1}{2} p(p-1) R_{t}^{p-2} \\right] dt.\n$$\n合并漂移系数：\n$$\n\\frac{p(\\delta - 1)}{2} R_{t}^{p-2} + \\frac{1}{2} p(p-1) R_{t}^{p-2} = \\frac{1}{2} p \\left( (\\delta - 1) + (p - 1) \\right) R_{t}^{p-2} = \\frac{1}{2} p (p + \\delta - 2) R_{t}^{p-2}.\n$$\n因此，微分具有如下显式形式\n$$\nd(R_{t}^{p}) = p R_{t}^{p-1} \\, dB_{t} + \\frac{1}{2} p (p + \\delta - 2) R_{t}^{p-2} \\, dt.\n$$\n从这个表达式中，我们看到 $R_{t}^{p}$ 是一个局部鞅，当且仅当其漂移项恒为零。漂移系数等于 $\\frac{1}{2} p (p + \\delta - 2) R_{t}^{p-2}$。对于 $R_{t} > 0$，该系数为零当且仅当\n$$\np (p + \\delta - 2) = 0.\n$$\n因此，使得 $\\{R_{t}^{p}\\}_{t \\geq 0}$ 为局部鞅的 $p$ 值是\n$$\np = 0 \\quad \\text{或} \\quad p = 2 - \\delta.\n$$\n$p = 0$ 的情况对应于常数过程 $R_{t}^{0} \\equiv 1$，这显然是一个（局部）鞅。$p = 2 - \\delta$ 的情况产生一个非平凡的局部鞅，通常理解为在 $\\delta \\in (0,2)$ 时，过程持续到（可能的）首次击中0的时刻；对于 $\\delta \\geq 2$，$R_{t}$ 几乎必然不会击中0，此时该局部鞅在所有时间上都有定义。\n\n作为与平方贝塞尔过程相关联的一致性检验，定义 $X_{t} = R_{t}^{2}$。将伊藤公式应用于 $f(x) = x^{2}$，并使用上面的 $dR_{t}$，可得\n$$\ndX_{t} = 2 R_{t} \\, dR_{t} + d\\langle R \\rangle_{t} = 2 R_{t} \\left( dB_{t} + \\frac{\\delta - 1}{2 R_{t}} \\, dt \\right) + dt = 2 R_{t} \\, dB_{t} + \\delta \\, dt,\n$$\n这正是维度为 $\\delta$ 的平方贝塞尔过程的定义SDE，用 $R_{t} = \\sqrt{X_{t}}$ 表示。这与上面为幂 $p$ 推导出的漂移结构一致，并支持了局部鞅性质的条件 $p(p + \\delta - 2) = 0$。", "answer": "$$\\boxed{\\{0, 2-\\delta\\}}$$", "id": "3040461"}, {"introduction": "我们的实践从分析过程的演化转向回答关于其边界命中行为的问题。一个典型问题是：一个贝塞尔过程从区间 $(a, b)$ 内的某点 $r$ 出发（即 $0 \\lt a \\lt r \\lt b$），它先到达内边界 $a$ 还是外边界 $b$ 的概率是多少？这个问题引入了一种不同于直接处理随机微分方程的强大工具——无穷小生成元。通过求解一个由生成元导出的、带有相应边界条件的常微分方程，我们可以精确地计算出这个概率 [@problem_id:3040444]。", "problem": "设 $R_{t}$ 是从 $R_{0}=r\\in(0,b)$ 开始的维度为 $\\delta>0$ 的贝塞尔过程，它被定义为随机微分方程 $dR_{t}=\\frac{\\delta-1}{2R_{t}}\\,dt+dW_{t}$ 的唯一强解，其中 $W_{t}$ 是一维标准布朗运动。$R_{t}$ 的无穷小生成元 $\\mathcal{L}$ 作用于二次连续可微函数 $f$ 的方式为 $\\mathcal{L}f(r)=\\frac{1}{2}f''(r)+\\frac{\\delta-1}{2r}f'(r)$。\n\n固定 $0<a<r<b$。令 $\\tau_{a} = \\inf\\{ t>0 : R_{t} = a \\}$ 和 $\\tau_{b} = \\inf\\{ t>0 : R_{t} = b \\}$ 分别表示首次到达 $a$ 和 $b$ 的时间。计算概率 $u(r) = \\mathbb{P}_{r}(\\tau_{a} < \\tau_{b})$，即从 $r$ 出发的过程在到达 $b$ 之前先到达 $a$ 的概率。请提供一个关于 $r$、$a$、$b$ 和 $\\delta$ 的闭式表达式作为最终答案。提示：该概率满足一个关于该过程生成元的常微分方程，并具有特定的边界条件。", "solution": "问题要求计算概率 $u(r) = \\mathbb{P}_{r}(\\tau_{a} < \\tau_{b})$，即一个维度为 $\\delta$ 的贝塞尔过程 $R_t$ 从 $R_0 = r$ 出发，在到达边界 $b$ 之前先到达边界 $a$ 的概率，其中 $0 < a < r < b$。\n\n根据一维扩散过程的理论，函数 $u(r)$ 在区间 $(a, b)$ 上是关于该过程的无穷小生成元 $\\mathcal{L}$ 的调和函数。这意味着 $u(r)$ 必须满足常微分方程（ODE）$\\mathcal{L}u(r) = 0$，其中 $r \\in (a, b)$。贝塞尔过程的生成元给出为 $\\mathcal{L}f(r)=\\frac{1}{2}f''(r)+\\frac{\\delta-1}{2r}f'(r)$。\n因此，$u(r)$ 的常微分方程是：\n$$\n\\frac{1}{2}u''(r) + \\frac{\\delta-1}{2r}u'(r) = 0\n$$\n两边乘以 2，我们得到一个更简单的形式：\n$$\nu''(r) + \\frac{\\delta-1}{r}u'(r) = 0\n$$\n\n边界条件由首中时的定义确定。\n如果过程从 $r=a$ 开始，它在时间 $t=0$ 时就已经到达了 $a$，所以 $\\tau_a=0$。因为 $a < b$，所以 $\\tau_b > 0$。因此，$\\tau_a < \\tau_b$ 的事件以概率 1 发生。所以我们有边界条件 $u(a) = 1$。\n如果 $r=b$，那么 $\\tau_b=0$。因为 $\\tau_a$ 必须大于零（因为 $a < b$），所以 $\\tau_a < \\tau_b$ 的事件以概率 0 发生。所以我们有第二个边界条件 $u(b) = 0$。\n\n现在我们求解这个二阶线性齐次ODE。令 $v(r) = u'(r)$，方程变为一阶线性ODE：\n$$\nv'(r) = -\\frac{\\delta-1}{r}v(r)\n$$\n这是一个可分离变量的方程：\n$$\n\\frac{dv}{v} = -(\\delta-1)\\frac{dr}{r}\n$$\n两边积分得到：\n$$\n\\ln|v| = -(\\delta-1)\\ln|r| + C = \\ln(r^{-(\\delta-1)}) + C\n$$\n因此，$v(r) = C_1 r^{1-\\delta}$。\n现在我们通过积分 $v(r)$ 来找到 $u(r)$：\n$$\nu(r) = \\int v(r) dr = \\int C_1 r^{1-\\delta} dr\n$$\n我们必须考虑两种情况：\n\n**情况 1: $\\delta \\neq 2$**\n在这种情况下，$1-\\delta \\neq -1$，所以积分是：\n$$\nu(r) = C_1 \\frac{r^{2-\\delta}}{2-\\delta} + C_2\n$$\n为简单起见，我们可以将常数 $C_1/(2-\\delta)$ 合并为新的 $C_1$，所以通解的形式为：\n$$\nu(r) = C_1 r^{2-\\delta} + C_2\n$$\n应用边界条件：\n$u(a) = 1 \\implies C_1 a^{2-\\delta} + C_2 = 1$\n$u(b) = 0 \\implies C_1 b^{2-\\delta} + C_2 = 0 \\implies C_2 = -C_1 b^{2-\\delta}$\n将 $C_2$ 代入第一个方程：\n$$\nC_1 a^{2-\\delta} - C_1 b^{2-\\delta} = 1 \\implies C_1(a^{2-\\delta} - b^{2-\\delta}) = 1 \\implies C_1 = \\frac{1}{a^{2-\\delta} - b^{2-\\delta}}\n$$\n因此，$C_2 = -\\frac{b^{2-\\delta}}{a^{2-\\delta} - b^{2-\\delta}}$。\n将 $C_1$ 和 $C_2$ 代回 $u(r)$ 的表达式：\n$$\nu(r) = \\frac{1}{a^{2-\\delta} - b^{2-\\delta}} r^{2-\\delta} - \\frac{b^{2-\\delta}}{a^{2-\\delta} - b^{2-\\delta}} = \\frac{r^{2-\\delta} - b^{2-\\delta}}{a^{2-\\delta} - b^{2-\\delta}}\n$$\n\n**情况 2: $\\delta = 2$**\n在这种情况下，$1-\\delta = -1$，所以积分是：\n$$\nu(r) = \\int C_1 r^{-1} dr = C_1 \\ln(r) + C_2\n$$\n应用边界条件：\n$u(a) = 1 \\implies C_1 \\ln(a) + C_2 = 1$\n$u(b) = 0 \\implies C_1 \\ln(b) + C_2 = 0 \\implies C_2 = -C_1 \\ln(b)$\n将 $C_2$ 代入第一个方程：\n$$\nC_1 \\ln(a) - C_1 \\ln(b) = 1 \\implies C_1 (\\ln(a) - \\ln(b)) = 1 \\implies C_1 = \\frac{1}{\\ln(a) - \\ln(b)} = \\frac{1}{\\ln(a/b)}\n$$\n因此，$C_2 = -\\frac{\\ln(b)}{\\ln(a/b)}$。\n将 $C_1$ 和 $C_2$ 代回 $u(r)$ 的表达式：\n$$\nu(r) = \\frac{\\ln(r)}{\\ln(a/b)} - \\frac{\\ln(b)}{\\ln(a/b)} = \\frac{\\ln(r) - \\ln(b)}{\\ln(a) - \\ln(b)} = \\frac{\\ln(r/b)}{\\ln(a/b)}\n$$\n\n综合两种情况，我们得到了完整的解。", "answer": "$$\n\\boxed{\nu(r) = \n\\begin{cases} \n\\frac{r^{2-\\delta} - b^{2-\\delta}}{a^{2-\\delta} - b^{2-\\delta}} & \\text{if } \\delta \\neq 2 \\\\\n\\frac{\\ln(r) - \\ln(b)}{\\ln(a) - \\ln(b)} & \\text{if } \\delta = 2\n\\end{cases}\n}\n$$", "id": "3040444"}]}