{"hands_on_practices": [{"introduction": "Lévy 过程的一个核心性质是，在任意时刻 $t \\gt 0$，其随机变量 $X_t$ 的分布都必须是无限可分的。本练习将通过强大的特征函数工具，阐明为何像均匀分布这样常见的分布不满足此条件。这个练习为你提供了一个具体的例子，帮助你理解 Lévy 过程定义所施加的深刻限制。[@problem_id:3063708]", "problem": "设 $\\left(X_{t}\\right)_{t \\geq 0}$ 是一个Lévy过程，即一个具有平稳且独立增量的随机过程，并且 $X_{0}=0$ 几乎必然成立。一个经过充分验证的事实是，对于每个固定的 $t>0$，$X_{t}$ 的分布是无限可分的，其特征函数具有Lévy-Khintchine表示 $\\varphi_{X_{t}}(\\theta)=\\exp\\!\\left(t\\,\\Psi(\\theta)\\right)$，其中 $\\Psi$ 是一个合适的特征指数。考虑将 $\\left[0,1\\right]$ 上的均匀分布作为 $X_{t}$ 的一个候选边缘分布。\n\n从特征函数的定义 $\\varphi_{Y}(\\theta)=\\mathbb{E}\\left[\\exp\\!\\left(i\\,\\theta\\,Y\\right)\\right]$ 出发，完成以下任务：\n- 推导在 $\\left[0,1\\right]$ 上均匀分布的随机变量 $U$ 的特征函数；\n- 计算使得 $\\varphi_{U}\\!\\left(\\theta^{\\ast}\\right)=0$ 的最小正实数 $\\theta^{\\ast}>0$；\n- 以此证明为何 $\\left[0,1\\right]$ 上的均匀分布在任何 $t>0$ 时都不能是任何Lévy过程 $X_{t}$ 的分布。\n\n请给出 $\\theta^{\\ast}$ 的值作为最终答案。无需四舍五入，不涉及单位。", "solution": "我们从特征函数的定义开始。如果 $U \\sim \\mathrm{Unif}\\!\\left(0,1\\right)$，那么对于任意实数 $\\theta$，\n\n$$\n\\varphi_{U}(\\theta)=\\mathbb{E}\\!\\left[\\exp\\!\\left(i\\,\\theta\\,U\\right)\\right]=\\int_{0}^{1}\\exp\\!\\left(i\\,\\theta\\,x\\right)\\,\\mathrm{d}x.\n$$\n\n这个积分可以明确地计算出来：\n\n$$\n\\varphi_{U}(\\theta)=\\left.\\frac{\\exp\\!\\left(i\\,\\theta\\,x\\right)}{i\\,\\theta}\\right|_{x=0}^{x=1}=\\frac{\\exp\\!\\left(i\\,\\theta\\right)-1}{i\\,\\theta}.\n$$\n\n通过将分子和分母同乘以 $\\exp\\!\\left(-i\\,\\theta/2\\right)$，可以得到一个等价的因式分解形式，从而使零点变得明显：\n\n$$\n\\varphi_{U}(\\theta)=\\exp\\!\\left(i\\,\\frac{\\theta}{2}\\right)\\,\\frac{\\exp\\!\\left(i\\,\\frac{\\theta}{2}\\right)-\\exp\\!\\left(-i\\,\\frac{\\theta}{2}\\right)}{i\\,\\theta}\n=\\exp\\!\\left(i\\,\\frac{\\theta}{2}\\right)\\,\\frac{2\\,\\sin\\!\\left(\\frac{\\theta}{2}\\right)}{\\theta}.\n$$\n\n因此，$\\varphi_{U}$ 的零点恰好在 $\\sin\\!\\left(\\frac{\\theta}{2}\\right)=0$ 且 $\\theta \\neq 0$（以避免在 $\\theta=0$ 处的可去奇点）时出现。因此，\n\n$$\n\\frac{\\theta}{2}=\\pi\\,k \\quad \\text{for} \\quad k \\in \\mathbb{Z}\\setminus\\{0\\} \\;\\;\\Longleftrightarrow\\;\\; \\theta=2\\pi\\,k,\\; k \\in \\mathbb{Z}\\setminus\\{0\\}.\n$$\n\n因此，最小的正零点是\n\n$$\n\\theta^{\\ast}=2\\pi.\n$$\n\n\n我们现在来证明为何 $\\left[0,1\\right]$ 上的均匀分布在任何 $t>0$ 时都不能是任何Lévy过程 $X_{t}$ 的分布。Lévy过程具有平稳且独立的增量，并且 $X_{0}=0$ 几乎必然成立。一个经过充分验证的基本特征表明，对于每个固定的 $t>0$，$X_{t}$ 的特征函数具有Lévy-Khintchine表示\n\n$$\n\\varphi_{X_{t}}(\\theta)=\\exp\\!\\left(t\\,\\Psi(\\theta)\\right),\n$$\n\n其中 $\\Psi$ 是特征（Lévy-Khintchine）指数。由于指数函数永不为零，所以对于所有实数 $\\theta$，都有 $\\varphi_{X_{t}}(\\theta)\\neq 0$。特别地，任何 $X_{t}$ 的特征函数都没有实零点。\n\n相比之下，我们已经证明了 $\\varphi_{U}(\\theta)$ 存在实零点，其最小正零点位于 $\\theta^{\\ast}=2\\pi$。因此，$\\left[0,1\\right]$ 上的均匀分布不是无限可分的，在任何 $t>0$ 时都不能与任何Lévy过程 $X_{t}$ 的分布相吻合。\n\n因此，所求的最小正零点是 $\\theta^{\\ast}=2\\pi$。", "answer": "$$\\boxed{2\\pi}$$", "id": "3063708"}, {"introduction": "在理解了对 $X_t$ 分布的基本约束之后，我们现在来探究过程的宏观性质是如何由其微观部分构建的。本练习聚焦于复合泊松过程，你将研究其方差这一关键统计量如何完全由单个跳跃的分布特性（特别是其尾部行为）所决定。通过这个计算，你将建立起微观跳跃与宏观过程特性之间的重要联系。[@problem_id:3063738]", "problem": "考虑一个复合泊松过程 $X_{t}$，定义为 $X_{t}=\\sum_{i=1}^{N_{t}} Y_{i}$，其中 $\\{N_{t}:t\\geq 0\\}$ 是一个速率为 $\\lambda>0$ 的泊松过程，$\\{Y_{i}\\}_{i\\geq 1}$ 是独立同分布的跳跃，且独立于 $\\{N_{t}\\}$。假设跳跃分布是对称且重尾的，其密度为\n$$\nf(y)=\\frac{\\alpha\\,y_{0}^{\\alpha}}{2}\\,|y|^{-(1+\\alpha)}\\,\\mathbf{1}_{\\{|y|\\geq y_{0}\\}},\n$$\n其中 $\\alpha>0$ 和 $y_{0}>0$ 是固定常数，$\\mathbf{1}_{A}$ 表示事件 $A$ 的指示函数。过程 $\\{X_{t}\\}$ 是一个具有平稳独立增量的 Lévy 过程。\n\n仅使用复合泊松过程和 Lévy 测度的定义，以及条件期望和方差的基本性质，完成以下任务：\n\n- 推导尾指数 $\\alpha$ 满足的充分必要条件，使得方差 $\\operatorname{Var}(X_{t})$ 对某个（等价地，所有）$t>0$ 是有限的。\n- 用 $\\lambda$ 和 $f$ 表示 $X$ 的 Lévy 测度 $\\nu$，并将您的有限方差条件重新表述为涉及 $\\int_{\\mathbb{R}} x^{2}\\,\\nu(dx)$ 的可积性条件。\n- 当方差有限时，计算 $\\operatorname{Var}(X_{t})$ 作为 $\\lambda$、$t$、$\\alpha$ 和 $y_{0}$ 的函数的闭式表达式。\n\n您的最终答案必须是在方差有限的情况下，$\\operatorname{Var}(X_{t})$ 关于 $\\lambda$、$t$、$\\alpha$ 和 $y_{0}$ 的单个解析表达式。无需进行数值计算或四舍五入。", "solution": "这个问题是随机过程理论中的一个有效练习。所有给出的定义和条件都是标准且自洽的。我们可以开始求解。\n\n复合泊松过程定义为 $X_{t}=\\sum_{i=1}^{N_{t}} Y_{i}$，其中 $\\{N_{t}:t\\geq 0\\}$ 是一个速率为 $\\lambda > 0$ 的泊松过程，$\\{Y_{i}\\}_{i\\geq 1}$ 是独立同分布 (i.i.d.) 的随机变量，且独立于 $N_t$。$X_t$ 的方差，记为 $\\operatorname{Var}(X_{t})$，可以使用全方差公式（也称为迭代方差公式）计算：\n$$\n\\operatorname{Var}(X_{t}) = \\mathbb{E}[\\operatorname{Var}(X_{t}|N_{t})] + \\operatorname{Var}(\\mathbb{E}[X_{t}|N_{t}])\n$$\n\n首先，我们求在给定 $N_t$ 的条件下 $X_t$ 的条件期望和条件方差。\n给定 $N_{t}=n$，过程 $X_t$ 是 $n$ 个独立同分布随机变量 $Y_i$ 的和：$X_{t}|_{N_t=n} = \\sum_{i=1}^{n} Y_{i}$。\n条件期望为：\n$$\n\\mathbb{E}[X_{t}|N_{t}=n] = \\mathbb{E}\\left[\\sum_{i=1}^{n} Y_{i}\\right] = \\sum_{i=1}^{n} \\mathbb{E}[Y_{i}] = n\\,\\mathbb{E}[Y_{1}]\n$$\n这意味着随机变量 $\\mathbb{E}[X_{t}|N_{t}]$ 是 $N_{t}\\mathbb{E}[Y_{1}]$。\n\n条件方差为：\n$$\n\\operatorname{Var}(X_{t}|N_{t}=n) = \\operatorname{Var}\\left(\\sum_{i=1}^{n} Y_{i}\\right) = \\sum_{i=1}^{n} \\operatorname{Var}(Y_{i}) = n\\,\\operatorname{Var}(Y_{1})\n$$\n这意味着随机变量 $\\operatorname{Var}(X_{t}|N_{t})$ 是 $N_{t}\\operatorname{Var}(Y_{1})$。\n\n现在，我们将这些代回到全方差公式中。这两项是：\n1.  $\\operatorname{Var}(\\mathbb{E}[X_{t}|N_{t}]) = \\operatorname{Var}(N_{t}\\mathbb{E}[Y_{1}]) = (\\mathbb{E}[Y_{1}])^{2} \\operatorname{Var}(N_{t})$。\n2.  $\\mathbb{E}[\\operatorname{Var}(X_{t}|N_{t})] = \\mathbb{E}[N_{t}\\operatorname{Var}(Y_{1})] = \\operatorname{Var}(Y_{1}) \\mathbb{E}[N_{t}]$。\n\n对于速率为 $\\lambda$ 的泊松过程 $N_t$，我们知道 $\\mathbb{E}[N_{t}] = \\lambda t$ 且 $\\operatorname{Var}(N_{t}) = \\lambda t$。代入这些可得：\n$$\n\\operatorname{Var}(X_{t}) = \\lambda t \\operatorname{Var}(Y_{1}) + \\lambda t (\\mathbb{E}[Y_{1}])^{2} = \\lambda t (\\operatorname{Var}(Y_{1}) + (\\mathbb{E}[Y_{1}])^{2})\n$$\n使用方差的定义 $\\operatorname{Var}(Y_{1}) = \\mathbb{E}[Y_{1}^{2}] - (\\mathbb{E}[Y_{1}])^{2}$，我们得到：\n$$\n\\operatorname{Var}(X_{t}) = \\lambda t \\mathbb{E}[Y_{1}^{2}]\n$$\n这个结果也被称为 Blackwell-Girshick 方程。要使 $\\operatorname{Var}(X_t)$ 对任意 $t>0$ 有限，$\\mathbb{E}[Y_1^2]$ 必须是有限的。注意，根据柯西-施瓦茨不等式，有限的二阶矩 $\\mathbb{E}[Y_1^2]$ 意味着有限的一阶矩 $\\mathbb{E}[|Y_1|]$。\n\n现在，我们必须确定 $\\mathbb{E}[Y_{1}^{2}]$ 为有限时 $\\alpha$ 所需满足的条件。首先，我们考察均值 $\\mathbb{E}[Y_1]$。跳跃密度是对称的，即 $f(y) = f(-y)$，由下式给出：\n$$\nf(y)=\\frac{\\alpha\\,y_{0}^{\\alpha}}{2}\\,|y|^{-(1+\\alpha)}\\,\\mathbf{1}_{\\{|y|\\geq y_{0}\\}}\n$$\n均值为 $\\mathbb{E}[Y_{1}] = \\int_{-\\infty}^{\\infty} y f(y) dy$。被积函数 $y f(y)$ 是一个奇函数，且积分域 $\\{y:|y| \\ge y_0\\}$ 关于 $y=0$ 对称。因此，如果积分收敛，其值为 0。收敛性取决于绝对值的积分：\n$$\n\\int_{-\\infty}^{\\infty} |y| f(y) dy = 2 \\int_{y_0}^{\\infty} y \\left(\\frac{\\alpha\\,y_{0}^{\\alpha}}{2}\\,y^{-(1+\\alpha)}\\right) dy = \\alpha y_0^\\alpha \\int_{y_0}^{\\infty} y^{-\\alpha} dy\n$$\n该积分收敛当且仅当 $-\\alpha < -1$，即 $\\alpha > 1$。如果 $\\alpha \\le 1$，均值 $\\mathbb{E}[Y_1]$ 未定义，因此方差 $\\operatorname{Var}(X_t)$ 是无穷大。如果 $\\alpha > 1$，则 $\\mathbb{E}[Y_{1}] = 0$。\n\n接下来，我们计算二阶矩 $\\mathbb{E}[Y_{1}^{2}]$：\n$$\n\\mathbb{E}[Y_{1}^{2}] = \\int_{-\\infty}^{\\infty} y^{2} f(y) dy\n$$\n被积函数 $y^2 f(y)$ 是一个偶函数，所以我们可以写成：\n$$\n\\mathbb{E}[Y_{1}^{2}] = 2 \\int_{y_{0}}^{\\infty} y^{2} f(y) dy = 2 \\int_{y_{0}}^{\\infty} y^{2} \\left(\\frac{\\alpha\\,y_{0}^{\\alpha}}{2}\\,y^{-(1+\\alpha)}\\right) dy = \\alpha y_{0}^{\\alpha} \\int_{y_{0}}^{\\infty} y^{1-\\alpha} dy\n$$\n该积分收敛当且仅当指数 $1-\\alpha$ 小于 $-1$，即 $1-\\alpha < -1$，化简为 $\\alpha > 2$。当 $\\alpha \\le 2$ 时，$\\mathbb{E}[Y_1^2]$ 是无穷大，$\\operatorname{Var}(X_t)$ 也是无穷大。条件 $\\alpha > 2$ 蕴含了 $\\alpha > 1$，因此均值存在的条件是满足的。所以，$\\operatorname{Var}(X_t)$ 有限的充分必要条件是 $\\alpha > 2$。\n\n复合泊松过程的 Lévy 测度 $\\nu$ 由 $\\nu(A) = \\lambda P(Y_1 \\in A)$ 给出，其中 $A$ 是 $\\mathbb{R}\\setminus\\{0\\}$ 中的任意 Borel 集。用密度表示，这意味着 $\\nu(dx) = \\lambda f(x) dx$。\n我们得到的有限方差条件是 $\\mathbb{E}[Y_1^2] < \\infty$。我们可以用 Lévy 测度来表示这个条件：\n$$\n\\mathbb{E}[Y_1^2] = \\int_{\\mathbb{R}} x^2 f(x) dx = \\int_{\\mathbb{R}} x^2 \\frac{1}{\\lambda} \\nu(dx) = \\frac{1}{\\lambda} \\int_{\\mathbb{R}} x^2 \\nu(dx)\n$$\n由于 $\\lambda$ 是一个正常数，条件 $\\mathbb{E}[Y_1^2] < \\infty$ 等价于条件 $\\int_{\\mathbb{R}} x^{2}\\,\\nu(dx) < \\infty$。这与 Lévy 过程的一般理论是一致的，对于没有布朗部分且具有有限二阶矩的过程，$\\operatorname{Var}(X_t) = t \\int_{\\mathbb{R}} x^2 \\nu(dx)$。我们的推导证实了这一点：\n$$\n\\operatorname{Var}(X_t) = \\lambda t \\mathbb{E}[Y_1^2] = \\lambda t \\left(\\frac{1}{\\lambda} \\int_{\\mathbb{R}} x^2 \\nu(dx)\\right) = t \\int_{\\mathbb{R}} x^2 \\nu(dx)\n$$\n\n最后，我们在 $\\alpha>2$ 的条件下计算 $\\operatorname{Var}(X_t)$ 的闭式表达式。我们计算 $\\mathbb{E}[Y_{1}^{2}]$ 的积分：\n$$\n\\int_{y_{0}}^{\\infty} y^{1-\\alpha} dy = \\left[ \\frac{y^{2-\\alpha}}{2-\\alpha} \\right]_{y_{0}}^{\\infty}\n$$\n由于 $\\alpha > 2$，指数 $2-\\alpha$ 是负的，所以 $\\lim_{y\\to\\infty} y^{2-\\alpha} = 0$。该积分的值为：\n$$\n0 - \\frac{y_{0}^{2-\\alpha}}{2-\\alpha} = \\frac{y_{0}^{2-\\alpha}}{\\alpha-2}\n$$\n将此代回到二阶矩的表达式中：\n$$\n\\mathbb{E}[Y_{1}^{2}] = \\alpha y_{0}^{\\alpha} \\left( \\frac{y_{0}^{2-\\alpha}}{\\alpha-2} \\right) = \\frac{\\alpha y_{0}^{\\alpha+2-\\alpha}}{\\alpha-2} = \\frac{\\alpha y_{0}^{2}}{\\alpha-2}\n$$\n因此，$X_t$ 的方差是：\n$$\n\\operatorname{Var}(X_{t}) = \\lambda t \\mathbb{E}[Y_{1}^{2}] = \\lambda t \\frac{\\alpha y_{0}^{2}}{\\alpha-2}\n$$\n此表达式在 $\\alpha > 2$ 时有效。", "answer": "$$\\boxed{\\frac{\\lambda t \\alpha y_{0}^{2}}{\\alpha-2}}$$", "id": "3063738"}, {"introduction": "最后的这个练习将理论推导与计算方法融为一体。你将首先推导出复合泊松过程的基本统计特性——期望、方差和特征函数，然后通过编写程序来模拟该过程的实现。通过将模拟结果与理论预测进行比较，你将对这些抽象的随机过程在实践中的具体行为获得更深刻、更直观的理解。[@problem_id:3063719]", "problem": "复合泊松过程是具有平稳独立增量的纯跳跃Lévy过程的一个典型例子。令 $t \\geq 0$ 并固定一个速率参数 $\\lambda > 0$。考虑一个速率为 $\\lambda$ 的泊松过程 $\\{N_s : s \\geq 0\\}$ 和一个独立的、同分布的跳跃大小序列 $\\{Y_i\\}_{i \\geq 1}$，其共同分布为 $F$ 且具有有限二阶矩。定义复合泊松过程 $\\{X_s : s \\geq 0\\}$ 如下\n$$\nX_s = \\sum_{i=1}^{N_s} Y_i, \\quad s \\geq 0,\n$$\n并约定当 $N_s = 0$ 时，$X_s = 0$。过程 $\\{X_s\\}$ 具有平稳独立增量，是一个Lévy过程。随机变量 $Z$ 的特征函数 (CF) 定义为 $\\varphi_Z(u) = \\mathbb{E}[e^{i u Z}]$，其中 $i = \\sqrt{-1}$。\n\n仅从泊松过程和独立性的定义出发，推导如何在区间 $[0,t]$ 上通过先抽样跳跃次数再抽样跳跃大小来模拟过程 $X_s$。推导证明该模拟方法所需的分布性质，并用 $\\lambda$、$t$ 和 $Y_1$ 的分布来计算期望 $\\mathbb{E}[X_t]$、方差 $\\mathrm{Var}(X_t)$ 和特征函数 $\\varphi_{X_t}(u)$。\n\n然后，实现一个程序，该程序：\n- 对于每个指定的测试用例，通过以下步骤模拟 $X_t$ 的单次实现：\n  1. 从 $\\mathrm{Poisson}(\\lambda t)$ 分布中抽样 $N_t$。\n  2. 从指定的分布 $F$ 中抽样 $N_t$ 个独立同分布的跳跃大小。\n  3. 计算 $X_t = \\sum_{i=1}^{N_t} Y_i$。\n- 对于每个测试用例，仅使用您的推导，计算理论上推导出的量 $\\mathbb{E}[X_t]$、$\\mathrm{Var}(X_t)$ 以及在给定的实数参数 $u$ 处求值的特征函数 $\\varphi_{X_t}(u)$。\n- 每个测试用例使用固定的随机种子，以确保输出是确定性的。\n\n您的程序必须使用以下参数值测试套件，这些参数共同测试了典型和边界场景：\n1. $t = 5.0$，$\\lambda = 1.2$， $F$ 为均值 $\\mu = 0.5$、标准差 $\\sigma = 0.3$ 的正态分布，特征函数参数 $u = 1.0$。种子 = 42。\n2. $t = 5.0$，$\\lambda = 0.0$， $F$ 为均值 $\\mu = 0.5$、标准差 $\\sigma = 0.3$ 的正态分布，特征函数参数 $u = 1.0$。种子 = 123。\n3. $t = 0.0$，$\\lambda = 3.0$， $F$ 为速率 $\\beta = 2.0$ 的指数分布（即均值为 $1/\\beta$），特征函数参数 $u = 0.5$。种子 = 7。\n4. $t = 1.0$，$\\lambda = 5.0$， $F$ 为对称伯努利分布，取值 $\\pm 1$ 的概率均为 $1/2$，特征函数参数 $u = 2.0$。种子 = 99。\n\n对于每个测试用例，您的程序必须按以下顺序输出一个列表：\n$$\n\\left[ N_t, \\; X_t, \\; \\mathbb{E}[X_t], \\; \\mathrm{Var}(X_t), \\; \\operatorname{Re}\\left(\\varphi_{X_t}(u)\\right), \\; \\operatorname{Im}\\left(\\varphi_{X_t}(u)\\right) \\right],\n$$\n其中 $N_t$ 是一个整数，其他量是实数。您的程序应生成单行输出，其中包含所有测试用例的结果，形式为由逗号分隔的列表组成的列表，并用方括号括起来，例如：\n$$\n\\big[ [\\cdots], [\\cdots], [\\cdots], [\\cdots] \\big].\n$$\n不涉及物理单位；特征函数的角度以弧度为单位。", "solution": "问题陈述已经过严格验证，并被确定为有效。它在科学上基于随机过程理论，特别是Lévy过程，并且问题定义明确，为理论推导和计算实现提供了所有必要信息。\n\n解决方案分为两部分。首先，我们提供所要求的关于复合泊松过程的模拟方法、期望、方差和特征函数的理论推导。其次，我们将这些推导应用于测试用例中给出的特定跳跃分布。每个数学实体都按要求使用LaTeX呈现。\n\n### 1. 模拟方法的合理性证明\n复合泊松过程 $\\{X_s : s \\geq 0\\}$ 由随机和定义：\n$$\nX_s = \\sum_{i=1}^{N_s} Y_i\n$$\n其中 $\\{N_s : s \\geq 0\\}$ 是一个速率为 $\\lambda$ 的泊松过程，$\\{Y_i\\}_{i \\geq 1}$ 是一个独立同分布 (i.i.d.) 的随机变量序列，并且也独立于过程 $\\{N_s\\}$。按照约定，如果跳跃次数 $N_s$ 为零，则该和为空，且 $X_s = 0$。\n\n为了在固定时间 $t > 0$ 模拟过程的单次实现，我们被要求先抽样跳跃次数，然后抽样跳跃大小。这个过程是该过程定义的直接实现，并依赖于条件概率的性质。$(N_t, X_t)$ 的联合分布可以分解为 $P(N_t=n, X_t \\leq x) = P(X_t \\leq x | N_t=n) P(N_t=n)$。模拟算法遵循这种分解：\n\n1.  **抽样跳跃次数：** 随机变量 $N_t$ 计算泊松过程在区间 $[0, t]$ 内的事件数量。已知其分布为参数是 $\\lambda t$ 的泊松分布。我们从该分布中抽取一个整数样本，称之为 $n$：$n \\sim \\mathrm{Poisson}(\\lambda t)$。\n\n2.  **抽样跳跃大小：** 在 $N_t = n$ 的条件下，过程的值为 $X_t = \\sum_{i=1}^{n} Y_i$。由于跳跃大小 $\\{Y_i\\}$ 是独立同分布且独立于 $N_t$ 的，这个条件和就是从它们的共同分布 $F$ 中抽取的 $n$ 个独立同分布随机变量的和。因此，我们从分布 $F$ 中生成 $n$ 个独立样本 $y_1, y_2, \\dots, y_n$。\n\n3.  **计算和：** $X_t$ 的实现是这些跳跃大小的和，$x_t = \\sum_{i=1}^{n} y_i$。如果 $n=0$，根据约定，该和为空，$x_t=0$。\n\n这个模拟过程正确地从 $X_t$ 的分布中生成了一个样本。\n\n### 2. 分布性质的推导\n设 $\\mu_Y = \\mathbb{E}[Y_1]$ 和 $\\sigma_Y^2 = \\mathrm{Var}(Y_1)$ 分别为跳跃大小分布的均值和方差。我们已知二阶矩 $\\mathbb{E}[Y_1^2] = \\sigma_Y^2 + \\mu_Y^2$ 是有限的。对于泊松过程计数器 $N_t$，我们知道 $\\mathbb{E}[N_t] = \\mathrm{Var}(N_t) = \\lambda t$。\n\n#### 期望 $\\mathbb{E}[X_t]$\n我们使用全期望定律（也称为迭代期望法则）：$\\mathbb{E}[Z] = \\mathbb{E}[\\mathbb{E}[Z|W]]$。令 $Z=X_t$ 和 $W=N_t$。\n$$\n\\mathbb{E}[X_t] = \\mathbb{E}\\left[\\mathbb{E}\\left[X_t | N_t\\right]\\right]\n$$\n首先，我们计算内部的期望，以 $N_t = n$ 为条件：\n$$\n\\mathbb{E}[X_t | N_t = n] = \\mathbb{E}\\left[ \\sum_{i=1}^{n} Y_i \\right] = \\sum_{i=1}^{n} \\mathbb{E}[Y_i] = n \\mathbb{E}[Y_1] = n \\mu_Y\n$$\n这对任何特定的值 $n$ 都成立。因此，作为一个随机变量，条件期望为 $\\mathbb{E}[X_t | N_t] = N_t \\mu_Y$。\n现在，我们取外部的期望：\n$$\n\\mathbb{E}[X_t] = \\mathbb{E}[N_t \\mu_Y] = \\mu_Y \\mathbb{E}[N_t] = \\mu_Y (\\lambda t)\n$$\n所以，期望为 $\\mathbb{E}[X_t] = \\lambda t \\mu_Y$。\n\n#### 方差 $\\mathrm{Var}(X_t)$\n我们使用全方差定律：$\\mathrm{Var}(Z) = \\mathbb{E}[\\mathrm{Var}(Z|W)] + \\mathrm{Var}(\\mathbb{E}[Z|W])$。\n$$\n\\mathrm{Var}(X_t) = \\mathbb{E}[\\mathrm{Var}(X_t | N_t)] + \\mathrm{Var}(\\mathbb{E}[X_t | N_t])\n$$\n我们分别计算每一项。\n1.  **第一项：$\\mathbb{E}[\\mathrm{Var}(X_t | N_t)]$**\n    给定 $N_t=n$ 的条件方差为：\n    $$\n    \\mathrm{Var}(X_t | N_t = n) = \\mathrm{Var}\\left(\\sum_{i=1}^{n} Y_i\\right) = \\sum_{i=1}^{n} \\mathrm{Var}(Y_i) = n \\mathrm{Var}(Y_1) = n \\sigma_Y^2\n    $$\n    这里利用了 $Y_i$ 的独立性。因此，$\\mathrm{Var}(X_t | N_t) = N_t \\sigma_Y^2$。取期望：\n    $$\n    \\mathbb{E}[\\mathrm{Var}(X_t | N_t)] = \\mathbb{E}[N_t \\sigma_Y^2] = \\sigma_Y^2 \\mathbb{E}[N_t] = \\sigma_Y^2 (\\lambda t)\n    $$\n2.  **第二项：$\\mathrm{Var}(\\mathbb{E}[X_t | N_t])$**\n    从期望的计算中，我们知道 $\\mathbb{E}[X_t | N_t] = N_t \\mu_Y$。我们计算其方差：\n    $$\n    \\mathrm{Var}(\\mathbb{E}[X_t | N_t]) = \\mathrm{Var}(N_t \\mu_Y) = \\mu_Y^2 \\mathrm{Var}(N_t) = \\mu_Y^2 (\\lambda t)\n    $$\n结合这两项：\n$$\n\\mathrm{Var}(X_t) = \\lambda t \\sigma_Y^2 + \\lambda t \\mu_Y^2 = \\lambda t (\\sigma_Y^2 + \\mu_Y^2)\n$$\n由于 $\\mathbb{E}[Y_1^2] = \\mathrm{Var}(Y_1) + (\\mathbb{E}[Y_1])^2 = \\sigma_Y^2 + \\mu_Y^2$，方差可以表示为：\n$$\n\\mathrm{Var}(X_t) = \\lambda t \\mathbb{E}[Y_1^2]\n$$\n\n#### 特征函数 $\\varphi_{X_t}(u)$\n设 $\\varphi_Y(u) = \\mathbb{E}[e^{iuY_1}]$ 为跳跃大小分布的特征函数 (CF)。我们再次使用全期望定律。\n$$\n\\varphi_{X_t}(u) = \\mathbb{E}[e^{iuX_t}] = \\mathbb{E}\\left[\\mathbb{E}[e^{iuX_t} | N_t]\\right]\n$$\n内部的条件期望，给定 $N_t=n$：\n$$\n\\mathbb{E}[e^{iuX_t} | N_t=n] = \\mathbb{E}\\left[e^{iu\\sum_{j=1}^{n} Y_j}\\right] = \\mathbb{E}\\left[\\prod_{j=1}^{n} e^{iuY_j}\\right]\n$$\n由于 $Y_j$ 的独立性，这变为：\n$$\n\\prod_{j=1}^{n} \\mathbb{E}[e^{iuY_j}] = \\prod_{j=1}^{n} \\varphi_Y(u) = (\\varphi_Y(u))^n\n$$\n因此，作为一个随机变量，$\\mathbb{E}[e^{iuX_t} | N_t] = (\\varphi_Y(u))^{N_t}$。现在我们取外部的期望：\n$$\n\\varphi_{X_t}(u) = \\mathbb{E}\\left[(\\varphi_Y(u))^{N_t}\\right]\n$$\n这个表达式是 $N_t$ 的概率生成函数 (PGF)，$G_{N_t}(z) = \\mathbb{E}[z^{N_t}]$，在 $z = \\varphi_Y(u)$ 处求值。对于一个泊松随机变量 $K \\sim \\mathrm{Poisson}(\\Lambda)$，其 PGF 为 $G_K(z) = e^{\\Lambda(z-1)}$。对于 $N_t \\sim \\mathrm{Poisson}(\\lambda t)$，我们有 $\\Lambda = \\lambda t$。代入 $z = \\varphi_Y(u)$，我们得到复合泊松过程的特征函数：\n$$\n\\varphi_{X_t}(u) = \\exp\\left(\\lambda t \\left(\\varphi_Y(u) - 1\\right)\\right)\n$$\n这就是复合泊松过程的Lévy-Khintchine公式。\n\n### 3. 特定测试用例的性质\n我们现在陈述问题中指定的跳跃分布所需的性质。\n\n1.  **正态分布：** $Y \\sim N(\\mu, \\sigma^2)$\n    -   均值：$\\mu_Y = \\mu$\n    -   二阶矩：$\\mathbb{E}[Y^2] = \\sigma^2 + \\mu^2$\n    -   特征函数：$\\varphi_Y(u) = \\exp(i u \\mu - \\frac{1}{2}\\sigma^2 u^2)$\n\n2.  **指数分布：** $Y \\sim \\mathrm{Exponential}(\\beta)$ （其概率密度函数 PDF 为 $f(y) = \\beta e^{-\\beta y}$，对于 $y \\ge 0$）\n    -   均值：$\\mu_Y = 1/\\beta$\n    -   方差：$\\sigma_Y^2 = 1/\\beta^2$\n    -   二阶矩：$\\mathbb{E}[Y^2] = \\sigma_Y^2 + \\mu_Y^2 = 2/\\beta^2$\n    -   特征函数：$\\varphi_Y(u) = \\mathbb{E}[e^{iuY}] = \\int_0^\\infty e^{iuy}\\beta e^{-\\beta y} dy = \\beta/(\\beta - iu) = 1/(1 - iu/\\beta)$\n\n3.  **对称伯努利分布：** $P(Y=1) = P(Y=-1) = 1/2$\n    -   均值：$\\mu_Y = 0$\n    -   二阶矩：$\\mathbb{E}[Y^2] = (1)^2(1/2) + (-1)^2(1/2) = 1$\n    -   特征函数：$\\varphi_Y(u) = e^{iu(1)}(1/2) + e^{iu(-1)}(1/2) = \\frac{e^{iu}+e^{-iu}}{2} = \\cos(u)$\n\n对于 $t=0$ 或 $\\lambda=0$ 的情况，乘积 $\\lambda t = 0$。在这些情况下，$N_t$ 确定性地为 $0$，这意味着 $X_t=0$。理论公式正确地退化为：\n- $\\mathbb{E}[X_t] = 0 \\cdot \\mu_Y = 0$\n- $\\mathrm{Var}(X_t) = 0 \\cdot \\mathbb{E}[Y_1^2] = 0$\n- $\\varphi_{X_t}(u) = \\exp(0 \\cdot (\\varphi_Y(u)-1)) = e^0 = 1$。常数 $0$ 的特征函数确实是 $\\mathbb{E}[e^{iu \\cdot 0}] = 1$。\n\n现在将根据这些推导出的公式进行实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy is not used but is an allowed library.\n\ndef solve():\n    \"\"\"\n    Simulates a compound Poisson process and calculates its theoretical properties\n    for a given set of test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"t\": 5.0, \"lam\": 1.2, \"u\": 1.0, \"seed\": 42,\n            \"dist\": \"normal\", \"params\": {\"mu\": 0.5, \"sigma\": 0.3}\n        },\n        {\n            \"t\": 5.0, \"lam\": 0.0, \"u\": 1.0, \"seed\": 123,\n            \"dist\": \"normal\", \"params\": {\"mu\": 0.5, \"sigma\": 0.3}\n        },\n        {\n            \"t\": 0.0, \"lam\": 3.0, \"u\": 0.5, \"seed\": 7,\n            \"dist\": \"exponential\", \"params\": {\"beta\": 2.0}\n        },\n        {\n            \"t\": 1.0, \"lam\": 5.0, \"u\": 2.0, \"seed\": 99,\n            \"dist\": \"bernoulli\", \"params\": {}\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        t, lam, u, seed = case[\"t\"], case[\"lam\"], case[\"u\"], case[\"seed\"]\n        dist, params = case[\"dist\"], case[\"params\"]\n\n        rng = np.random.default_rng(seed)\n\n        # Theoretical properties of the jump distribution Y\n        mu_y, e_y2, phi_y = 0.0, 0.0, 0.0 + 0.0j\n\n        if dist == \"normal\":\n            mu, sigma = params[\"mu\"], params[\"sigma\"]\n            mu_y = mu\n            e_y2 = sigma**2 + mu**2\n            phi_y = np.exp(1j * u * mu - 0.5 * sigma**2 * u**2)\n        elif dist == \"exponential\":\n            beta = params[\"beta\"]\n            mu_y = 1.0 / beta\n            e_y2 = 2.0 / beta**2\n            phi_y = 1.0 / (1.0 - 1j * u / beta)\n        elif dist == \"bernoulli\":\n            mu_y = 0.0\n            e_y2 = 1.0\n            phi_y = np.cos(u)\n\n        # 1. Simulation\n        # Sample N_t from Poisson(lambda*t)\n        lambda_t = lam * t\n        n_t = rng.poisson(lambda_t)\n\n        # Sample N_t jumps and compute X_t\n        x_t = 0.0\n        if n_t > 0:\n            if dist == \"normal\":\n                jumps = rng.normal(params[\"mu\"], params[\"sigma\"], size=n_t)\n            elif dist == \"exponential\":\n                jumps = rng.exponential(scale=1.0/params[\"beta\"], size=n_t)\n            elif dist == \"bernoulli\":\n                jumps = rng.choice([-1, 1], size=n_t)\n            x_t = np.sum(jumps)\n        # If n_t is 0, x_t remains 0.0, which is correct.\n\n        # 2. Theoretical Calculations\n        # Expectation E[X_t] = lambda*t*E[Y]\n        e_xt = lambda_t * mu_y\n\n        # Variance Var(X_t) = lambda*t*E[Y^2]\n        var_xt = lambda_t * e_y2\n\n        # Characteristic function phi_Xt(u) = exp(lambda*t*(phi_Y(u) - 1))\n        phi_xt = np.exp(lambda_t * (phi_y - 1))\n\n        # Store results for this case\n        all_results.append([\n            n_t,\n            x_t,\n            e_xt,\n            var_xt,\n            phi_xt.real,\n            phi_xt.imag\n        ])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    print(all_results)\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3063719"}]}