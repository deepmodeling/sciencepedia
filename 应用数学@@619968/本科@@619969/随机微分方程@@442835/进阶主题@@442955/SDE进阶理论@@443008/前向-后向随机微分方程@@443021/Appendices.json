{"hands_on_practices": [{"introduction": "在着手使用数值方法解决复杂的前向后向随机微分方程（FBSDE）之前，掌握基本情形的解析解法至关重要。本练习将引导你求解一个线性的、解耦的FBSDE，这是该领域的一个基础模型。通过解决这个问题 [@problem_id:3054739]，你将运用Girsanov定理进行测度变换和使用积分因子等关键技巧，从而巩固你对支撑后向随机微分方程（BSDE）分析的理论工具的理解。", "problem": "考虑一个带流概率空间 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\in[0,T]},\\mathbb{P})$，其上定义了一个一维标准布朗运动 $W=(W_t)_{t\\in[0,T]}$，时间范围为固定的 $T0$。一个解耦的前向后向随机微分方程（FBSDE）的前向部分由以下随机微分方程给出：\n$$\n\\mathrm{d}X_t=\\mu\\,\\mathrm{d}t+\\sigma\\,\\mathrm{d}W_t,\\qquad X_0=x_0,\n$$\n其中 $\\mu\\in\\mathbb{R}$ 和 $\\sigma0$ 为常数，$x_0\\in\\mathbb{R}$ 是确定性的。后向部分 $(Y,Z)$ 满足\n$$\n\\mathrm{d}Y_t=-f(t,X_t,Y_t,Z_t)\\,\\mathrm{d}t+Z_t\\,\\mathrm{d}W_t,\\qquad Y_T=g(X_T),\n$$\n其驱动函数和终端函数具体由以下公式指定：\n$$\nf(t,x,y,z)=\\alpha\\,y+\\beta\\,z+\\gamma,\\qquad g(x)=\\lambda\\,x+\\delta,\n$$\n其中 $\\alpha\\in\\mathbb{R}\\setminus\\{0\\}$，$\\beta,\\gamma,\\lambda,\\delta\\in\\mathbb{R}$ 为常数。假设所有确保平方可积解 $(Y,Z)$ 存在且唯一的常规条件（包括可积性以及关于常数 $\\beta$ 的 Novikov 条件）均已满足。\n\n从 Itô 过程和后向随机微分方程的基本定义出发，推导 $Y_0$ 关于 $x_0$、$T$ 以及常数 $\\mu$、$\\sigma$、$\\alpha$、$\\beta$、$\\gamma$、$\\lambda$ 和 $\\delta$ 的显式闭式表达式。最终答案必须是单一的闭式解析表达式。无需四舍五入，也不涉及物理单位。", "solution": "该问题提供了一个解耦的前向后向随机微分方程（FBSDE）系统，并要求计算后向过程在时间 $t=0$ 时的值，记为 $Y_0$。该系统定义在一个带有标准一维布朗运动 $W_t$ 的带流概率空间 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\in[0,T]},\\mathbb{P})$ 上。\n\n前向过程 $X_t$ 是一个算术布朗运动，由以下随机微分方程（SDE）给出：\n$$\\mathrm{d}X_t = \\mu\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t, \\quad X_0 = x_0$$\n其中 $\\mu \\in \\mathbb{R}$，$\\sigma  0$ 和 $x_0 \\in \\mathbb{R}$ 是常数。\n\n后向过程 $(Y_t, Z_t)$ 由以下后向随机微分方程（BSDE）定义：\n$$\\mathrm{d}Y_t = -f(t,X_t,Y_t,Z_t)\\,\\mathrm{d}t + Z_t\\,\\mathrm{d}W_t, \\quad Y_T = g(X_T)$$\n驱动函数 $f$ 和终端函数 $g$ 是线性的：\n$$f(t,x,y,z) = \\alpha y + \\beta z + \\gamma$$\n$$g(x) = \\lambda x + \\delta$$\n其中 $\\alpha \\in \\mathbb{R}\\setminus\\{0\\}$，$\\beta, \\gamma, \\lambda, \\delta \\in \\mathbb{R}$ 是常数。问题假设存在唯一的平方可积解对 $(Y_t, Z_t)$ 的条件已满足。\n\n将驱动函数 $f$ 的具体形式代入 BSDE 中，得到：\n$$\\mathrm{d}Y_t = -(\\alpha Y_t + \\beta Z_t + \\gamma)\\,\\mathrm{d}t + Z_t\\,\\mathrm{d}W_t$$\n这是一个线性 BSDE。求解该方程的一个标准方法是使用测度变换来消除漂移项中包含 $Z_t$ 的项。我们定义一个新的概率测度 $\\mathbb{Q}$，它与 $\\mathbb{P}$ 等价。令 $M_t = \\int_0^t \\beta \\, \\mathrm{d}W_s = \\beta W_t$。$M_t$ 的 Doléans-Dade 指数为 $\\mathcal{E}(M)_t = \\exp(\\beta W_t - \\frac{1}{2}\\beta^2 t)$。我们定义 Radon-Nikodym 导数为 $\\frac{d\\mathbb{Q}}{d\\mathbb{P}}|_{\\mathcal{F}_T} = \\mathcal{E}(M)_T$。Novikov 条件满足的假设确保了 $\\mathcal{E}(M)_t$ 是一个鞅且 $\\mathbb{E}[\\mathcal{E}(M)_T] = 1$。\n\n根据 Girsanov 定理，由下式定义的过程 $\\widetilde{W}_t$\n$$\\widetilde{W}_t = W_t - \\int_0^t \\beta \\, \\mathrm{d}s = W_t - \\beta t$$\n在测度 $\\mathbb{Q}$ 下是一个标准布朗运动。我们可以将 $\\mathrm{d}W_t$ 表示为 $\\mathrm{d}W_t = \\mathrm{d}\\widetilde{W}_t + \\beta \\, \\mathrm{d}t$。\n\n现在，我们在测度 $\\mathbb{Q}$ 下重写这两个 SDE。\n$X_t$ 的前向 SDE 变为：\n$$\\mathrm{d}X_t = \\mu\\,\\mathrm{d}t + \\sigma(\\mathrm{d}\\widetilde{W}_t + \\beta\\,\\mathrm{d}t) = (\\mu + \\sigma\\beta)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}\\widetilde{W}_t$$\n$Y_t$ 的后向 SDE 变为：\n$$\\mathrm{d}Y_t = -(\\alpha Y_t + \\beta Z_t + \\gamma)\\,\\mathrm{d}t + Z_t(\\mathrm{d}\\widetilde{W}_t + \\beta\\,\\mathrm{d}t)$$\n$$\\mathrm{d}Y_t = -(\\alpha Y_t + \\gamma)\\,\\mathrm{d}t - \\beta Z_t\\,\\mathrm{d}t + Z_t\\,\\beta\\,\\mathrm{d}t + Z_t\\,\\mathrm{d}\\widetilde{W}_t$$\n$$\\mathrm{d}Y_t = -(\\alpha Y_t + \\gamma)\\,\\mathrm{d}t + Z_t\\,\\mathrm{d}\\widetilde{W}_t$$\n在 $\\mathbb{Q}$ 下，这个 BSDE 更简单，因为其漂移项与 $Z_t$ 无关。为了求解它，我们使用一个积分因子。考虑过程 $e^{\\alpha t}Y_t$。应用 Itô 乘积法则：\n$$d(e^{\\alpha t}Y_t) = (\\alpha e^{\\alpha t}Y_t)\\,\\mathrm{d}t + e^{\\alpha t}\\,\\mathrm{d}Y_t$$\n代入 $\\mathrm{d}Y_t$ 的表达式：\n$$d(e^{\\alpha t}Y_t) = \\alpha e^{\\alpha t}Y_t\\,\\mathrm{d}t + e^{\\alpha t}(-(\\alpha Y_t + \\gamma)\\,\\mathrm{d}t + Z_t\\,\\mathrm{d}\\widetilde{W}_t)$$\n$$d(e^{\\alpha t}Y_t) = \\alpha e^{\\alpha t}Y_t\\,\\mathrm{d}t - \\alpha e^{\\alpha t}Y_t\\,\\mathrm{d}t - \\gamma e^{\\alpha t}\\,\\mathrm{d}t + e^{\\alpha t}Z_t\\,\\mathrm{d}\\widetilde{W}_t$$\n$$d(e^{\\alpha t}Y_t) = -\\gamma e^{\\alpha t}\\,\\mathrm{d}t + e^{\\alpha t}Z_t\\,\\mathrm{d}\\widetilde{W}_t$$\n将此方程从任意时间 $t \\in [0,T]$ 积分到 $T$：\n$$e^{\\alpha T}Y_T - e^{\\alpha t}Y_t = \\int_t^T -\\gamma e^{\\alpha s}\\,\\mathrm{d}s + \\int_t^T e^{\\alpha s}Z_s\\,\\mathrm{d}\\widetilde{W}_s$$\n我们可以解出 $e^{\\alpha t}Y_t$：\n$$e^{\\alpha t}Y_t = e^{\\alpha T}Y_T + \\gamma \\int_t^T e^{\\alpha s}\\,\\mathrm{d}s - \\int_t^T e^{\\alpha s}Z_s\\,\\mathrm{d}\\widetilde{W}_s$$\n关于流 $\\mathcal{F}_t$ 取在 $\\mathbb{Q}$ 下的条件期望：\n$$\\mathbb{E}_{\\mathbb{Q}}[e^{\\alpha t}Y_t | \\mathcal{F}_t] = \\mathbb{E}_{\\mathbb{Q}}\\left[e^{\\alpha T}Y_T + \\gamma \\int_t^T e^{\\alpha s}\\,\\mathrm{d}s - \\int_t^T e^{\\alpha s}Z_s\\,\\mathrm{d}\\widetilde{W}_s \\bigg| \\mathcal{F}_t\\right]$$\n由于 $Y_t$ 是 $\\mathcal{F}_t$-可测的，$\\mathbb{E}_{\\mathbb{Q}}[e^{\\alpha t}Y_t | \\mathcal{F}_t] = e^{\\alpha t}Y_t$。随机积分 $\\int_t^T e^{\\alpha s}Z_s\\,\\mathrm{d}\\widetilde{W}_s$ 是一个在时间 $t$ 从 $0$ 开始的 $\\mathbb{Q}$-鞅，因此其条件期望为零。包含 $\\gamma e^{\\alpha s}$ 积分的项是确定性的。\n$$e^{\\alpha t}Y_t = \\mathbb{E}_{\\mathbb{Q}}[e^{\\alpha T}Y_T | \\mathcal{F}_t] + \\gamma \\int_t^T e^{\\alpha s}\\,\\mathrm{d}s$$\n我们来计算这个确定性积分：\n$$\\int_t^T e^{\\alpha s}\\,\\mathrm{d}s = \\left[\\frac{e^{\\alpha s}}{\\alpha}\\right]_t^T = \\frac{1}{\\alpha}(e^{\\alpha T} - e^{\\alpha t})$$\n将其代回并解出 $Y_t$：\n$$Y_t = e^{-\\alpha t} \\mathbb{E}_{\\mathbb{Q}}[e^{\\alpha T}Y_T | \\mathcal{F}_t] + \\frac{\\gamma}{\\alpha}e^{-\\alpha t}(e^{\\alpha T} - e^{\\alpha t})$$\n$$Y_t = \\mathbb{E}_{\\mathbb{Q}}[e^{\\alpha(T-t)}Y_T | \\mathcal{F}_t] + \\frac{\\gamma}{\\alpha}(e^{\\alpha(T-t)} - 1)$$\n题目要求我们求 $Y_0$。令 $t=0$：\n$$Y_0 = \\mathbb{E}_{\\mathbb{Q}}[e^{\\alpha T}Y_T | \\mathcal{F}_0] + \\frac{\\gamma}{\\alpha}(e^{\\alpha T} - 1)$$\n由于 $X_0=x_0$ 是确定性的，流 $\\mathcal{F}_0$ 是平凡的。因此，条件期望就是 $\\mathbb{Q}$ 下的无条件期望：\n$$Y_0 = \\mathbb{E}_{\\mathbb{Q}}[e^{\\alpha T}Y_T] + \\frac{\\gamma}{\\alpha}(e^{\\alpha T} - 1)$$\n现在代入终端条件 $Y_T = g(X_T) = \\lambda X_T + \\delta$：\n$$Y_0 = \\mathbb{E}_{\\mathbb{Q}}[e^{\\alpha T}(\\lambda X_T + \\delta)] + \\frac{\\gamma}{\\alpha}(e^{\\alpha T} - 1)$$\n$$Y_0 = \\lambda e^{\\alpha T}\\mathbb{E}_{\\mathbb{Q}}[X_T] + \\delta e^{\\alpha T} + \\frac{\\gamma}{\\alpha}(e^{\\alpha T} - 1)$$\n最后一步是计算 $\\mathbb{E}_{\\mathbb{Q}}[X_T]$。在 $\\mathbb{Q}$ 测度下，$X_t$ 的动态为 $\\mathrm{d}X_t = (\\mu + \\sigma\\beta)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}\\widetilde{W}_t$。从 $0$ 积分到 $T$：\n$$X_T = X_0 + \\int_0^T (\\mu + \\sigma\\beta)\\,\\mathrm{d}s + \\int_0^T \\sigma\\,\\mathrm{d}\\widetilde{W}_s = x_0 + (\\mu + \\sigma\\beta)T + \\sigma\\widetilde{W}_T$$\n在 $\\mathbb{Q}$ 下取期望并利用 $\\mathbb{E}_{\\mathbb{Q}}[\\widetilde{W}_T]=0$：\n$$\\mathbb{E}_{\\mathbb{Q}}[X_T] = x_0 + (\\mu + \\sigma\\beta)T$$\n最后，我们将其代入 $Y_0$ 的表达式中：\n$$Y_0 = \\lambda e^{\\alpha T}(x_0 + (\\mu + \\sigma\\beta)T) + \\delta e^{\\alpha T} + \\frac{\\gamma}{\\alpha}(e^{\\alpha T} - 1)$$\n这可以重新整理为最终的闭式表达式：\n$$Y_0 = \\exp(\\alpha T)\\left(\\lambda x_0 + \\lambda(\\mu + \\sigma\\beta)T + \\delta\\right) + \\frac{\\gamma}{\\alpha}(\\exp(\\alpha T) - 1)$$", "answer": "$$\\boxed{\\exp(\\alpha T)\\left( \\lambda x_0 + \\lambda(\\mu + \\sigma\\beta)T + \\delta \\right) + \\frac{\\gamma}{\\alpha}(\\exp(\\alpha T) - 1)}$$", "id": "3054739"}, {"introduction": "尽管解析解能提供深刻的洞察，但在实践中遇到的大多数FBSDE都缺乏闭式解，必须通过数值方法求解。本练习介绍一种BSDE计算方法的基石：后向递归离散格式。通过识别该算法的正确结构 [@problem_id:3054605]，你将学习如何将连续时间方程转化为一个实用的、分步的计算流程，为实现你自己的FBSDE求解器奠定基础。", "problem": "考虑在时间区间 $[0,T]$ 上由标准布朗运动驱动的一维前向后向随机微分方程，其前向部分由下式给出\n$$\n\\mathrm{d}X_t = b(t,X_t)\\,\\mathrm{d}t + \\sigma(t,X_t)\\,\\mathrm{d}W_t, \\quad X_0 = x_0,\n$$\n其后向部分由积分形式给出\n$$\nY_t = g(X_T) + \\int_t^T f(s,X_s,Y_s,Z_s)\\,\\mathrm{d}s - \\int_t^T Z_s\\,\\mathrm{d}W_s,\n$$\n其中 $b$、$\\sigma$、$f$ 和 $g$ 是适当正则的函数，$(W_t)_{t\\in[0,T]}$ 是一个标准布朗运动。设均匀时间网格定义为 $0=t_0  t_1  \\dots  t_N = T$，步长为 $\\Delta t_i = t_{i+1} - t_i$，布朗运动增量为 $\\Delta W_i = W_{t_{i+1}} - W_{t_i}$。令 $Y_i \\approx Y_{t_i}$，$f_i = f(t_i, X_i, Y_i, Z_i)$，$\\mathbb{E}_i[\\cdot] = \\mathbb{E}[\\cdot|\\mathcal{F}_{t_i}]$。基于对后向方程的离散化，并对时间 $t_i$ 的信息 $\\mathcal{F}_{t_i}$ 取条件期望，下列哪个关系式是 $Y_i$ 的标准一阶向后递推近似？\n\nA. $Y_i \\approx \\mathbb{E}_i[Y_{i+1}] + f_i \\Delta t_i$\n\nB. $Y_i \\approx \\mathbb{E}_i[Y_{i+1}] - f_i \\Delta t_i$\n\nC. $Y_i \\approx \\mathbb{E}_i[Y_{i+1}] + f_i \\Delta t_i + Z_i \\Delta W_i$\n\nD. $Y_i \\approx \\mathbb{E}_i[Y_{i+1}] + f_i \\Delta t_i - Z_i \\Delta W_i$", "solution": "### 推导过程\n\n1.  **从BSDE的积分形式出发**: 问题的核心是离散化后向随机微分方程 (BSDE)。我们从其在时间区间 $[t_i, t_{i+1}]$ 上的动态开始。首先，将 $Y_t$ 的积分形式写在 $t=t_i$ 和 $t=t_{i+1}$ 两个时刻：\n    $$Y_{t_i} = g(X_T) + \\int_{t_i}^T f(s,X_s,Y_s,Z_s)\\,\\mathrm{d}s - \\int_{t_i}^T Z_s\\,\\mathrm{d}W_s$$\n    $$Y_{t_{i+1}} = g(X_T) + \\int_{t_{i+1}}^T f(s,X_s,Y_s,Z_s)\\,\\mathrm{d}s - \\int_{t_{i+1}}^T Z_s\\,\\mathrm{d}W_s$$\n\n2.  **隔离单个时间步的动态**: 用第一个方程减去第二个方程，我们可以得到 $Y_{t_i}$ 和 $Y_{t_{i+1}}$ 之间的关系：\n    $$Y_{t_i} - Y_{t_{i+1}} = \\left(\\int_{t_i}^T - \\int_{t_{i+1}}^T\\right) f(s,\\dots)\\,\\mathrm{d}s - \\left(\\int_{t_i}^T - \\int_{t_{i+1}}^T\\right) Z_s\\,\\mathrm{d}W_s$$\n    根据积分的性质，这简化为在一个小时间区间 $[t_i, t_{i+1}]$ 上的积分：\n    $$Y_{t_i} - Y_{t_{i+1}} = \\int_{t_i}^{t_{i+1}} f(s,X_s,Y_s,Z_s)\\,\\mathrm{d}s - \\int_{t_i}^{t_{i+1}} Z_s\\,\\mathrm{d}W_s$$\n\n3.  **重新整理方程**: 将 $Y_{t_{i+1}}$ 移到方程右边，我们得到 $Y_{t_i}$ 的精确表达式：\n    $$Y_{t_i} = Y_{t_{i+1}} + \\int_{t_i}^{t_{i+1}} f(s,X_s,Y_s,Z_s)\\,\\mathrm{d}s - \\int_{t_i}^{t_{i+1}} Z_s\\,\\mathrm{d}W_s$$\n\n4.  **取条件期望**: 为了得到一个可计算的递推关系，我们对上式两边取关于在时间 $t_i$ 可获得的信息 $\\mathcal{F}_{t_i}$ 的条件期望（记为 $\\mathbb{E}_i[\\cdot]$）。\n    $$\\mathbb{E}_i[Y_{t_i}] = \\mathbb{E}_i[Y_{t_{i+1}}] + \\mathbb{E}_i\\left[\\int_{t_i}^{t_{i+1}} f(s,X_s,Y_s,Z_s)\\,\\mathrm{d}s\\right] - \\mathbb{E}_i\\left[\\int_{t_i}^{t_{i+1}} Z_s\\,\\mathrm{d}W_s\\right]$$\n\n5.  **利用鞅的性质**:\n    *   由于 $Y_{t_i}$ 在时间 $t_i$ 是已知的（即 $\\mathcal{F}_{t_i}$-可测的），我们有 $\\mathbb{E}_i[Y_{t_i}] = Y_{t_i}$。\n    *   Itô 随机积分 $\\int_{t_i}^{t_{i+1}} Z_s\\,\\mathrm{d}W_s$ 是一个鞅增量。根据鞅的性质，其在时间 $t_i$ 的条件期望为零，即 $\\mathbb{E}_i\\left[\\int_{t_i}^{t_{i+1}} Z_s\\,\\mathrm{d}W_s\\right] = 0$。\n    \n    将这些性质代入方程，我们得到一个精确的关系：\n    $$Y_{t_i} = \\mathbb{E}_i[Y_{t_{i+1}}] + \\mathbb{E}_i\\left[\\int_{t_i}^{t_{i+1}} f(s,X_s,Y_s,Z_s)\\,\\mathrm{d}s\\right]$$\n\n6.  **进行数值近似**: 上述关系仍然是精确的。为了得到一个数值格式，我们需要对剩下的积分项进行近似。最简单的近似方法（一阶欧拉格式）是用积分区间左端点的值乘以区间长度来近似积分：\n    $$\\int_{t_i}^{t_{i+1}} f(s,X_s,Y_s,Z_s)\\,\\mathrm{d}s \\approx f(t_i, X_{t_i}, Y_{t_i}, Z_{t_i}) \\cdot (t_{i+1}-t_i)$$\n    使用问题中给出的简写符号，这可以写成 $f_i \\Delta t_i$。\n\n7.  **最终的递推关系**: 将这个近似代入第5步的精确关系中：\n    $$Y_i \\approx \\mathbb{E}_i[Y_{i+1}] + \\mathbb{E}_i[f_i \\Delta t_i]$$\n    由于 $f_i$ 和 $\\Delta t_i$ 在时间 $t_i$ 都是已知的（$\\mathcal{F}_{t_i}$-可测），我们可以将它们从条件期望中提出来：\n    $$Y_i \\approx \\mathbb{E}_i[Y_{i+1}] + f_i \\Delta t_i$$\n    \n### 结论\n这个结果是求解BSDE的标准向后递推格式。它表明，当前时刻的解 $Y_i$ 可以通过对下一时刻解 $Y_{i+1}$ 的条件期望，加上当前时间步内驱动函数 $f$ 产生的“成本”或“收益”的近似值来计算。\n\n该表达式与选项A完全匹配。\n\n*   **选项 B** 的符号错误。\n*   **选项 C 和 D** 包含了随机项 $Z_i \\Delta W_i$，这在取条件期望后应该消失，因此它们描述的是 $Y_{i+1}$ 的近似路径，而不是 $Y_i$ 的递推关系。", "answer": "$$\\boxed{A}$$", "id": "3054605"}, {"introduction": "在BSDE的数值求解中，一个关键且通常具有挑战性的步骤是估计其中的控制过程$Z_t$。本练习将深入探讨现代基于回归方法的理论核心。理解这个问题 [@problem_id:3054590] 中提出的论证，是领会一个实际的计算步骤——最小二乘回归——如何巧妙地植根于随机分析的基本原理（即Itô等距定理）的关键。这种联系不仅功能强大，也揭示了随机分析中理论与计算之间深刻的相互作用。", "problem": "考虑一个定义在带有标准布朗运动 $W$ 的过滤概率空间上的马尔可夫前向后向随机微分方程 (FBSDE)，其中前向分量 $X$ 满足随机微分方程\n$$\n\\mathrm{d}X_t = b(t,X_t)\\,\\mathrm{d}t + \\sigma(t,X_t)\\,\\mathrm{d}W_t,\\quad X_0 = x,\n$$\n且后向分量 $(Y,Z)$ 满足\n$$\nY_t = g(X_T) + \\int_t^T f(s,X_s,Y_s,Z_s)\\,\\mathrm{d}s - \\int_t^T Z_s\\,\\mathrm{d}W_s,\\quad t\\in[0,T].\n$$\n固定一个均匀网格 $0=t_0  t_1  \\dots  t_N = T$。记 $\\Delta t_i = t_{i+1} - t_i$ 和 $\\Delta W_i = W_{t_{i+1}} - W_{t_i}$，并使用符号 $\\mathbb{E}_i[\\cdot] = \\mathbb{E}[\\cdot|\\mathcal{F}_{t_i}]$。为了在数值上求解该BSDE，需要在每个时间步 $t_i$ 估计 $Z_i \\approx Z_{t_i}$。利用BSDE的离散化和伊藤积分的性质，可以推导出 $Z_i$ 和未来价值 $Y_{i+1}$ 之间的一个近似关系。以下哪个关系式正确地表达了这种联系，并构成了基于回归的 $Z_i$ 估计方法的基础？\n\nA. $Z_i \\approx \\mathbb{E}_i[Y_{i+1} \\Delta W_i] / \\Delta t_i$\n\nB. $Z_i \\approx \\mathbb{E}_i[Y_{i+1} / \\Delta W_i]$\n\nC. $Z_i \\approx \\mathbb{E}_i[Y_{i+1}] / \\Delta t_i$\n\nD. $Z_i \\approx \\mathbb{E}_i[Y_{i+1} \\Delta t_i] / \\Delta W_i$", "solution": "### 推导过程\n\n1.  **从BSDE的离散动态出发**: 我们从上一个练习中得到的 $Y_{t_i}$ 和 $Y_{t_{i+1}}$ 之间的关系式开始，但这次是在取期望之前：\n    $$Y_{t_i} = Y_{t_{i+1}} + \\int_{t_i}^{t_{i+1}} f(s,X_s,Y_s,Z_s)\\,\\mathrm{d}s - \\int_{t_i}^{t_{i+1}} Z_s\\,\\mathrm{d}W_s$$\n    重新整理，我们可以得到 $Y_{t_{i+1}}$ 的表达式：\n    $$Y_{t_{i+1}} = Y_{t_i} - \\int_{t_i}^{t_{i+1}} f(s,X_s,Y_s,Z_s)\\,\\mathrm{d}s + \\int_{t_i}^{t_{i+1}} Z_s\\,\\mathrm{d}W_s$$\n\n2.  **应用欧拉格式近似**: 我们用一阶欧拉格式来近似上式中的积分项：\n    *   $\\int_{t_i}^{t_{i+1}} f(s,\\dots)\\,\\mathrm{d}s \\approx f(t_i, X_{t_i}, Y_{t_i}, Z_{t_i}) \\Delta t_i = f_i \\Delta t_i$\n    *   $\\int_{t_i}^{t_{i+1}} Z_s\\,\\mathrm{d}W_s \\approx Z_{t_i} (W_{t_{i+1}} - W_{t_i}) = Z_i \\Delta W_i$\n    \n    将这些近似代入，我们得到 $Y_{i+1}$ 的近似表达式：\n    $$Y_{i+1} \\approx Y_i - f_i \\Delta t_i + Z_i \\Delta W_i$$\n\n3.  **建立与 $Z_i$ 的联系**: 我们的目标是求解 $Z_i$。为了分离出 $Z_i$ 这一项，我们利用布朗运动增量 $\\Delta W_i$ 的性质。将上式两边同乘以 $\\Delta W_i$：\n    $$Y_{i+1} \\Delta W_i \\approx (Y_i - f_i \\Delta t_i)\\Delta W_i + Z_i (\\Delta W_i)^2$$\n\n4.  **取条件期望**: 现在，对上式两边取关于信息流 $\\mathcal{F}_{t_i}$ 的条件期望（记为 $\\mathbb{E}_i[\\cdot]$）：\n    $$\\mathbb{E}_i[Y_{i+1} \\Delta W_i] \\approx \\mathbb{E}_i[(Y_i - f_i \\Delta t_i)\\Delta W_i] + \\mathbb{E}_i[Z_i (\\Delta W_i)^2]$$\n\n5.  **利用随机分析的关键性质**:\n    *   在表达式 $\\mathbb{E}_i[(Y_i - f_i \\Delta t_i)\\Delta W_i]$ 中，项 $(Y_i - f_i \\Delta t_i)$ 在时间 $t_i$ 是已知的（$\\mathcal{F}_{t_i}$-可测），因此可以从条件期望中提出来：\n        $$\\mathbb{E}_i[(Y_i - f_i \\Delta t_i)\\Delta W_i] = (Y_i - f_i \\Delta t_i)\\mathbb{E}_i[\\Delta W_i]$$\n        由于布朗运动的增量具有零均值，$\\mathbb{E}_i[\\Delta W_i] = 0$。所以，这一项为零。\n    *   在表达式 $\\mathbb{E}_i[Z_i (\\Delta W_i)^2]$ 中，项 $Z_i$ 在时间 $t_i$ 是已知的（$\\mathcal{F}_{t_i}$-可测），也可以提出来：\n        $$\\mathbb{E}_i[Z_i (\\Delta W_i)^2] = Z_i \\mathbb{E}_i[(\\Delta W_i)^2]$$\n        布朗运动增量的二阶矩（方差）等于时间增量，即 $\\mathbb{E}_i[(\\Delta W_i)^2] = \\Delta t_i$。所以，这一项等于 $Z_i \\Delta t_i$。\n\n6.  **最终关系式**: 将第5步的结果代入第4步的方程中，我们得到：\n    $$\\mathbb{E}_i[Y_{i+1} \\Delta W_i] \\approx 0 + Z_i \\Delta t_i$$\n    即\n    $$\\mathbb{E}_i[Y_{i+1} \\Delta W_i] \\approx Z_i \\Delta t_i$$\n\n7.  **求解 $Z_i$**: 最后，通过代数运算解出 $Z_i$：\n    $$Z_i \\approx \\frac{\\mathbb{E}_i[Y_{i+1} \\Delta W_i]}{\\Delta t_i}$$\n\n### 结论\n这个关系式揭示了一个深刻的联系：在时间 $t_i$ 的控制量 $Z_i$ 可以通过计算未来价值 $Y_{i+1}$ 与布朗运动增量 $\\Delta W_i$ 的协方差来近似得到（因为 $\\mathbb{E}_i[\\Delta W_i]=0$，所以 $\\mathbb{E}_i[Y_{i+1}\\Delta W_i]$ 就是条件协方差）。\n在实际的蒙特卡洛模拟中，条件期望 $\\mathbb{E}_i[\\cdot]$ 通过对大量模拟路径在特定状态下求样本均值来近似。具体来说，我们可以通过对模拟出的 $(Y_{i+1}, \\Delta W_i)$ 数据对进行最小二乘回归来估计 $Z_i$。\n\n该推导结果与选项A完全匹配。\n\n*   **选项 B 和 D** 包含除以随机变量 $\\Delta W_i$ 的操作，这在数学上是无意义的。\n*   **选项 C** 将 $Z_i$ 与 $Y_{i+1}$ 的条件期望联系起来，这是不正确的。$Y_{i+1}$ 的条件期望关系到 $Y_i$，而不是 $Z_i$。", "answer": "$$\\boxed{A}$$", "id": "3054590"}]}