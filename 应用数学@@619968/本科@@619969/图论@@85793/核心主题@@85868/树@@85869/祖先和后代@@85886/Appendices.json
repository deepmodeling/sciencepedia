{"hands_on_practices": [{"introduction": "我们从有向无环图（DAG）最简单的形式——路径图开始。通过计算祖先-后代对的总数，此练习旨在巩固您对这一核心关系的理解，并揭示其与基础组合学原理的联系。这项练习是后续更复杂问题分析的基础 [@problem_id:1481062]。", "problem": "在一个分布式账本系统中，交易按时间顺序记录，形成一个链。考虑一个由 $n$ 个区块组成的链的简化模型，这些区块根据其在链中的顺序被标记为 $B_1, B_2, \\dots, B_n$。该链的结构可以用一个有向图来表示，其中区块是顶点。对于所有从 $1$ 到 $n-1$ 的 $i$，存在一条从区块 $B_i$ 到区块 $B_{i+1}$ 的有向边，表示 $B_{i+1}$ 是紧接着 $B_i$ 之后附加的。\n\n在这个图中，如果存在一条从顶点 $B_a$ 到顶点 $B_d$ 的有向路径，我们定义区块 $B_a$ 是另一个区块 $B_d$ 的“祖先”。这样的区块对 $(B_a, B_d)$ 被称为“祖先后代对”。一个区块不被认为是其自身的祖先。\n\n您的任务是确定一个包含 $n$ 个区块的链中，不同祖先后代对的总数。请用一个关于 $n$ 的单一闭式解析表达式来陈述您的答案。", "solution": "将区块按顺序标记为 $B_{1}, B_{2}, \\dots, B_{n}$，其中对于 $i=1,\\dots,n-1$，存在从 $B_{i}$ 到 $B_{i+1}$ 的有向边。从 $B_{a}$ 到 $B_{d}$ 的有向路径存在的充要条件是 $a<d$，因为边只指向前方，当 $d>a$ 时，从 $B_{a}$ 到 $B_{d}$ 的唯一路径长度为 $d-a$，而当 $d\\leq a$ 时则不存在路径。\n\n因此，祖先后代对的集合恰好是满足 $1\\leq a<d\\leq n$ 的有序对 $(a,d)$ 的集合。对于每个固定的 $a\\in\\{1,\\dots,n-1\\}$，后代 $d$ 的数量为 $n-a$。对所有有效的 $a$ 求和，得到总的对数：\n$$\n\\sum_{a=1}^{n-1} (n-a) \\,=\\, \\sum_{k=1}^{n-1} k \\,=\\, \\frac{(n-1)n}{2}.\n$$\n这里我们使用了恒等式 $\\sum_{k=1}^{m} k = \\frac{m(m+1)}{2}$，其中 $m=n-1$。因此，不同祖先后代对的总数为 $\\frac{n(n-1)}{2}$。", "answer": "$$\\boxed{\\frac{n(n-1)}{2}}$$", "id": "1481062"}, {"introduction": "科学和数学的进步常常涉及证伪看似合理的假设。本练习将挑战您扮演研究者的角色，检验一个关于祖先和其后代出度（out-degree）关系的猜想。通过寻找反例，您将锻炼批判性思维能力，并加深对有向无环图结构微妙之处的理解 [@problem_id:1481045]。", "problem": "在图论中，有向图是由边连接的顶点集合，其中边带有方向。有向无环图（DAG）是一种没有有向环的有向图。\n\n在有向无环图中，我们定义以下关系和性质：\n- 如果存在一条从顶点 $u$ 到顶点 $v$ 的有向路径，则顶点 $u$ 是顶点 $v$ 的**祖先**。顶点 $v$ 则被称为 $u$ 的**后代**。根据此定义，一个顶点不是其自身的祖先。\n- 一个顶点的**出度**是指从该顶点出发的边的数量。\n\n考虑以下论断：“对于任何有向无环图，如果顶点 $u$ 是顶点 $v$ 的祖先，那么 $u$ 的出度必须大于或等于 $v$ 的出度。”\n\n你的任务是确定下列由顶点集 $V$ 和边集 $E$ 描述的图中，哪一个可以作为该论断的反例。一条边 $(x, y)$ 表示一条从顶点 $x$ 到顶点 $y$ 的有向边。\n\nA. $V = \\{A, B, C, D, E\\}$, $E = \\{(A, B), (B, C), (C, D), (C, E)\\}$\n\nB. $V = \\{A, B, C, D\\}$, $E = \\{(A, B), (A, C), (A, D)\\}$\n\nC. $V = \\{A, B, C\\}$, $E = \\{(A, B), (B, C), (C, A)\\}$\n\nD. $V = \\{A, B, C, D\\}$, $E = \\{(A, B), (B, C), (C, D)\\}$\n\nE. $V = \\{A, B, C, D\\}$, $E = \\{(A, C), (A, D), (B, C), (B, D)\\}$", "solution": "我们要找一个违反以下论断的有向无环图（DAG）：如果 $u$ 是 $v$ 的祖先，则 $\\deg^{+}(u) \\geq \\deg^{+}(v)$，其中 $\\deg^{+}(x)$ 表示顶点 $x$ 的出度。一个反例必须是一个有向无环图，其中存在某个祖先后代对 $(u,v)$ 使得 $\\deg^{+}(u) < \\deg^{+}(v)$。\n\n分析每个选项：\n\n选项 A: $V=\\{A,B,C,D,E\\}$, $E=\\{(A,B),(B,C),(C,D),(C,E)\\}$。该图没有有向环，因此它是一个有向无环图。计算出度：\n$$\n\\deg^{+}(A)=1,\\quad \\deg^{+}(B)=1,\\quad \\deg^{+}(C)=2,\\quad \\deg^{+}(D)=0,\\quad \\deg^{+}(E)=0.\n$$\n存在一条有向路径 $A \\to B \\to C$，所以 $A$ 是 $C$ 的祖先。比较出度：\n$$\n\\deg^{+}(A)=1 \\quad \\text{和} \\quad \\deg^{+}(C)=2,\n$$\n因此 $\\deg^{+}(A) < \\deg^{+}(C)$，这与论断相矛盾。所以，A 是一个反例。\n\n选项 B: $V=\\{A,B,C,D\\}$, $E=\\{(A,B),(A,C),(A,D)\\}$。这是一个有向无环图。出度：\n$$\n\\deg^{+}(A)=3,\\quad \\deg^{+}(B)=0,\\quad \\deg^{+}(C)=0,\\quad \\deg^{+}(D)=0.\n$$\n唯一的祖先后代关系是 $A$ 作为 $B$、$C$ 和 $D$ 的祖先。对于每一个这样的 $v$，\n$$\n\\deg^{+}(A)=3 \\geq 0=\\deg^{+}(v),\n$$\n所以该论断成立；不是一个反例。\n\n选项 C: $V=\\{A,B,C\\}$, $E=\\{(A,B),(B,C),(C,A)\\}$。该图包含一个有向环 $A \\to B \\to C \\to A$，所以它不是一个有向无环图。它不能作为对一个限定于有向无环图的论断的反例。\n\n选项 D: $V=\\{A,B,C,D\\}$, $E=\\{(A,B),(B,C),(C,D)\\}$。这是一个有向无环图。出度：\n$$\n\\deg^{+}(A)=1,\\quad \\deg^{+}(B)=1,\\quad \\deg^{+}(C)=1,\\quad \\deg^{+}(D)=0.\n$$\n对于链上的任何祖先后代对，不等式 $\\deg^{+}(u) \\geq \\deg^{+}(v)$ 均成立（对于非终端后代，取等号；当 $v=D$ 时，取严格大于）。不是一个反例。\n\n选项 E: $V=\\{A,B,C,D\\}$, $E=\\{(A,C),(A,D),(B,C),(B,D)\\}$。这是一个有向无环图。出度：\n$$\n\\deg^{+}(A)=2,\\quad \\deg^{+}(B)=2,\\quad \\deg^{+}(C)=0,\\quad \\deg^{+}(D)=0.\n$$\n祖先是 $A$ 或 $B$，后代是 $C$ 或 $D$。在所有情况下，$\\deg^{+}(u) \\geq \\deg^{+}(v)$ 均成立。不是一个反例。\n\n因此，选项中唯一的反例是 A。", "answer": "$$\\boxed{A}$$", "id": "1481045"}, {"introduction": "现在，让我们将祖先-后代概念应用于一个模拟的现实世界场景：分析社交网络中的影响力。这个问题要求您计算一个名为“三度影响力分数”的特定指标，这涉及到追踪固定长度的路径。此练习将提升您在给定图结构上进行系统性图遍历和数据汇总的能力 [@problem_id:1481106]。", "problem": "在快速发展的社交媒体世界中，一家名为“Nexus”的公司的网络分析师正试图识别其最具影响力的用户。虽然简单的粉丝数是一个有用的指标，但他们希望捕捉一种更细致的影响力形式，称为“深度触及”。他们将其平台建模为一个有向图，其中用户是顶点，从用户A到用户B的一次“分享”是从A到B的一条有向边。为防止无限的内容循环，该平台的架构确保此图总是一个有向无环图（DAG）。\n\n分析师们提出了一种名为“3度影响力深度得分”的新指标。对于任何给定的用户（顶点）$u$，其得分定义为可以从 $u$ 出发，通过一条由恰好三次连续分享组成的简单路径到达的不同用户的数量。\n\n给定 Nexus 网络一小部分的当前状态，它表示为一个包含10个用户的图，标记为1到10。分享（边）如下：\n(1, 2), (1, 3), (1, 4), (2, 5), (2, 6), (3, 6), (3, 7), (4, 7), (5, 8), (6, 8), (6, 9), (7, 9), (7, 10), (8, 10)。\n\n你的任务是确定该网络中所有用户能达到的最高“3度影响力深度得分”。", "solution": "我们将网络建模为一个有向无环图，其顶点标记为1到10，边由集合给出\n$E=\\{(1,2),(1,3),(1,4),(2,5),(2,6),(3,6),(3,7),(4,7),(5,8),(6,8),(6,9),(7,9),(7,10),(8,10)\\}.$\n对于一个顶点 $u$，其“3度影响力深度得分”是从 $u$ 出发，通过一条恰好包含三条边的有向路径可以到达的顶点集合 $S_{3}(u)$ 的基数。因为该图是无环的，且边在拓扑序上是前进的，所以任何长度为三的有向路径自动是简单路径。\n\n令 $A(u)$ 表示 $u$ 的出邻域集合，即 $A(u)=\\{v:(u,v)\\in E\\}$。那么，恰好三步可达的顶点集合为\n$$\nS_{3}(u)=\\bigcup_{x\\in A(u)}\\ \\bigcup_{y\\in A(x)} A(y).\n$$\n根据边列表，各顶点的出邻域为\n$$\n\\begin{aligned}\n&A(1)=\\{2,3,4\\},\\quad A(2)=\\{5,6\\},\\quad A(3)=\\{6,7\\},\\quad A(4)=\\{7\\},\\\\\n&A(5)=\\{8\\},\\quad A(6)=\\{8,9\\},\\quad A(7)=\\{9,10\\},\\quad A(8)=\\{10\\},\\quad A(9)=\\varnothing,\\quad A(10)=\\varnothing.\n\\end{aligned}\n$$\n我们为每个 $u$ 计算 $S_{3}(u)$。\n\n对于 $u=1$，首先找到所有距离为2的顶点：\n$$\n\\bigcup_{x\\in A(1)} A(x)=A(2)\\cup A(3)\\cup A(4)=\\{5,6\\}\\cup\\{6,7\\}\\cup\\{7\\}=\\{5,6,7\\}.\n$$\n然后\n$$\nS_{3}(1)=A(5)\\cup A(6)\\cup A(7)=\\{8\\}\\cup\\{8,9\\}\\cup\\{9,10\\}=\\{8,9,10\\},\n$$\n所以 $|S_{3}(1)|=3$。\n\n对于 $u=2$，距离为2的顶点集合是\n$$\n\\bigcup_{x\\in A(2)} A(x)=A(5)\\cup A(6)=\\{8\\}\\cup\\{8,9\\}=\\{8,9\\},\n$$\n因此\n$$\nS_{3}(2)=A(8)\\cup A(9)=\\{10\\}\\cup\\varnothing=\\{10\\},\n$$\n所以 $|S_{3}(2)|=1$。\n\n对于 $u=3$，距离为2的顶点集合是\n$$\n\\bigcup_{x\\in A(3)} A(x)=A(6)\\cup A(7)=\\{8,9\\}\\cup\\{9,10\\}=\\{8,9,10\\},\n$$\n因此\n$$\nS_{3}(3)=A(8)\\cup A(9)\\cup A(10)=\\{10\\}\\cup\\varnothing\\cup\\varnothing=\\{10\\},\n$$\n所以 $|S_{3}(3)|=1$。\n\n对于 $u=4$，距离为2的顶点集合是\n$$\n\\bigcup_{x\\in A(4)} A(x)=A(7)=\\{9,10\\},\n$$\n因此\n$$\nS_{3}(4)=A(9)\\cup A(10)=\\varnothing\\cup\\varnothing=\\varnothing,\n$$\n所以 $|S_{3}(4)|=0$。\n\n对于 $u=5$，距离为2的顶点集合是\n$$\n\\bigcup_{x\\in A(5)} A(x)=A(8)=\\{10\\},\n$$\n因此\n$$\nS_{3}(5)=A(10)=\\varnothing,\n$$\n所以 $|S_{3}(5)|=0$。\n\n对于 $u=6$，距离为2的顶点集合是\n$$\n\\bigcup_{x\\in A(6)} A(x)=A(8)\\cup A(9)=\\{10\\}\\cup\\varnothing=\\{10\\},\n$$\n因此\n$$\nS_{3}(6)=A(10)=\\varnothing,\n$$\n所以 $|S_{3}(6)|=0$。\n\n对于 $u=7$，距离为2的顶点集合是\n$$\n\\bigcup_{x\\in A(7)} A(x)=A(9)\\cup A(10)=\\varnothing\\cup\\varnothing=\\varnothing,\n$$\n所以 $S_{3}(7)=\\varnothing$ 且 $|S_{3}(7)|=0$。\n\n对于 $u=8$，$A(8)=\\{10\\}$，所以距离为2的顶点集合是 $A(10)=\\varnothing$，因此 $S_{3}(8)=\\varnothing$ 且 $|S_{3}(8)|=0$。\n\n对于 $u=9$ 和 $u=10$, $A(9)=\\varnothing$ 且 $A(10)=\\varnothing$，所以 $S_{3}(9)=\\varnothing$ 且 $S_{3}(10)=\\varnothing$，其大小均为0。\n\n因此，所有顶点中最大的“3度影响力深度得分”在 $u=1$ 处取得，其值为3。", "answer": "$$\\boxed{3}$$", "id": "1481106"}]}