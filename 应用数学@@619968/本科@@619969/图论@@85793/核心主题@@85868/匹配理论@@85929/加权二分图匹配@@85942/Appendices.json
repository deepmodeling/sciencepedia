{"hands_on_practices": [{"introduction": "这一实践将我们带入加权二分匹配的核心——分配问题。想象一下，你需要在两组不同的实体之间建立一一对应的关系，以实现总体效益的最大化。这个练习 [@problem_id:1555315] 通过一个生物技术领域的假设场景，即为抗体和抗原寻找最佳配对以最大化亲和力总分，来具体展示这一概念。通过解决这个问题，你将掌握寻找最大权重完美匹配的基本方法。", "problem": "一个病毒学实验室的研究团队正在开发一组新的抗病毒疗法。他们设计了四种不同的候选抗体，分别表示为 Ab-1、Ab-2、Ab-3 和 Ab-4。他们希望测试这些候选抗体对四种不同病毒抗原变体（表示为 Ag-A、Ag-B、Ag-C 和 Ag-D）的功效。\n\n对于抗体与抗原的每一种可能配对，都通过实验确定了一个“结合亲和力分数”。分数越高表示结合越强、越有效。这些分数总结在下面的亲和力矩阵中，其中行对应候选抗体，列对应抗原变体。\n\n$$\n\\begin{array}{c|cccc}\n & \\text{Ag-A} & \\text{Ag-B} & \\text{Ag-C} & \\text{Ag-D} \\\\\n\\hline\n\\text{Ab-1} & 15 & 12 & 13 & 10 \\\\\n\\text{Ab-2} & 11 & 14 & 16 & 12 \\\\\n\\text{Ab-3} & 13 & 11 & 15 & 14 \\\\\n\\text{Ab-4} & 10 & 13 & 12 & 11 \\\\\n\\end{array}\n$$\n\n为了简化下一阶段的实验，团队需要创建一个最优分配，将每个候选抗体与一个且仅一个独特的抗原变体配对。目标是使所选四个配对的结合亲和力分数之和最大化。\n\n在这种最优分配中，可以实现的最大可能总结合亲和力分数是多少？", "solution": "我们将最优配对问题建模为一个分配问题。设抗体由 $i \\in \\{1,2,3,4\\}$ 索引，抗原由 $j \\in \\{1,2,3,4\\}$ 索引。一个分配对应于 $\\{1,2,3,4\\}$ 的一个排列 $\\sigma$，其中抗体 $i$ 与抗原 $\\sigma(i)$ 配对。$\\sigma$ 的总结合亲和力分数为\n$$\nS(\\sigma) = \\sum_{i=1}^{4} a_{i,\\sigma(i)},\n$$\n其中 $a_{ij}$ 是给定的亲和力矩阵条目：\n$$\n[a_{ij}] =\n\\begin{pmatrix}\n15 & 12 & 13 & 10\\\\\n11 & 14 & 16 & 12\\\\\n13 & 11 & 15 & 14\\\\\n10 & 13 & 12 & 11\n\\end{pmatrix}.\n$$\n我们计算所有 $4! = 24$ 个排列 $\\sigma$ 的 $S(\\sigma)$：\n$$\n(1,2,3,4):\\; 15+14+15+11=55,\\quad\n(1,2,4,3):\\; 15+14+14+12=55,\n$$\n$$\n(1,3,2,4):\\; 15+16+11+11=53,\\quad\n(1,3,4,2):\\; 15+16+14+13=58,\n$$\n$$\n(1,4,2,3):\\; 15+12+11+12=50,\\quad\n(1,4,3,2):\\; 15+12+15+13=55,\n$$\n$$\n(2,1,3,4):\\; 12+11+15+11=49,\\quad\n(2,1,4,3):\\; 12+11+14+12=49,\n$$\n$$\n(2,3,1,4):\\; 12+16+13+11=52,\\quad\n(2,3,4,1):\\; 12+16+14+10=52,\n$$\n$$\n(2,4,1,3):\\; 12+12+13+12=49,\\quad\n(2,4,3,1):\\; 12+12+15+10=49,\n$$\n$$\n(3,1,2,4):\\; 13+11+11+11=46,\\quad\n(3,1,4,2):\\; 13+11+14+13=51,\n$$\n$$\n(3,2,1,4):\\; 13+14+13+11=51,\\quad\n(3,2,4,1):\\; 13+14+14+10=51,\n$$\n$$\n(3,4,1,2):\\; 13+12+13+13=51,\\quad\n(3,4,2,1):\\; 13+12+11+10=46,\n$$\n$$\n(4,1,2,3):\\; 10+11+11+12=44,\\quad\n(4,1,3,2):\\; 10+11+15+13=49,\n$$\n$$\n(4,2,1,3):\\; 10+14+13+12=49,\\quad\n(4,2,3,1):\\; 10+14+15+10=49,\n$$\n$$\n(4,3,1,2):\\; 10+16+13+13=52,\\quad\n(4,3,2,1):\\; 10+16+11+10=47.\n$$\n这些值中的最大值为 $58$，通过排列 $(1,3,4,2)$ 实现，即 Ab-1 与 Ag-A 配对，Ab-2 与 Ag-C 配对，Ab-3 与 Ag-D 配对，以及 Ab-4 与 Ag-B 配对。", "answer": "$$\\boxed{58}$$", "id": "1555315"}, {"introduction": "优化问题并非总是追求“最多”或“最好”，有时我们的目标是实现“最少”或“最低成本”。这个练习 [@problem_id:1555349] 将我们的视角从最大化收益转换为最小化成本，它模拟了一个数据中心需要将计算任务分配给不同服务器以使总能耗最小化的情景。这个问题将帮助你理解如何将匹配算法应用于成本最小化场景，这在资源管理和物流规划中极为常见。", "problem": "一位高性能计算集群的数据中心经理需要将四个专门的计算任务分配给四台不同的服务器。这四台服务器名为 Alpha、Beta、Gamma 和 Delta，它们的硬件架构不同，导致每个任务的能耗也不同。该经理的目标是创建一种任务到服务器的一一对应分配方案，以最小化运行所有四个任务的总能耗。这四个任务是：量子模拟 (QS)、蛋白质折叠模拟 (PF)、流体动力学计算 (FD) 和密码学分析 (CA)。\n\n每种任务-服务器配对的预计能耗（单位：千瓦时，kWh）在以下列表中给出。\n- **服务器 Alpha：** QS 任务 10 kWh，PF 任务 12 kWh，FD 任务 19 kWh，CA 任务 11 kWh。\n- **服务器 Beta：** QS 任务 5 kWh，PF 任务 10 kWh，FD 任务 7 kWh，CA 任务 8 kWh。\n- **服务器 Gamma：** QS 任务 12 kWh，PF 任务 14 kWh，FD 任务 13 kWh，CA 任务 11 kWh。\n- **服务器 Delta：** QS 任务 8 kWh，PF 任务 15 kWh，FD 任务 11 kWh，CA 任务 9 kWh。\n\n每台服务器必须且只能分配一个任务，每个任务也必须且只能在一台服务器上运行。完成所有四个任务的最小可能总能耗是多少？请用 kWh 作答。", "solution": "设服务器集合为 $\\{\\text{Alpha}, \\text{Beta}, \\text{Gamma}, \\text{Delta}\\}$，任务集合为 $\\{\\text{QS}, \\text{PF}, \\text{FD}, \\text{CA}\\}$。目标是找到一个从服务器到任务的一一对应分配 $\\sigma$，以最小化总能耗 $E=\\sum_{s} C\\bigl(s,\\sigma(s)\\bigr)$。我们将按 QS 任务的分配情况进行分情况讨论。\n\n情况1：将 QS 分配给 Beta。初始成本为 5 kWh。对于剩下的3台服务器和3个任务，通过检查所有 $3!=6$ 种配对，可以发现最小成本配对为 PF$\\to$Alpha (12), FD$\\to$Gamma (13), CA$\\to$Delta (9)，剩余成本为 $12+13+9 = 34$ kWh。此情况下的总成本为 $5 + 34 = 39$ kWh。\n\n情况2：将 QS 分配给 Delta。初始成本为 8 kWh。对于剩下的服务器和任务，最小成本配对为 PF$\\to$Alpha (12), FD$\\to$Beta (7), CA$\\to$Gamma (11)，剩余成本为 $12+7+11 = 30$ kWh。此情况下的总成本为 $8 + 30 = 38$ kWh。\n\n情况3：将 QS 分配给 Alpha。初始成本为 10 kWh。对于剩下的服务器和任务，最小成本配对为 FD$\\to$Beta (7), PF$\\to$Gamma (14), CA$\\to$Delta (9)，剩余成本为 $7+14+9 = 30$ kWh。此情况下的总成本为 $10 + 30 = 40$ kWh。\n\n情况4：将 QS 分配给 Gamma。初始成本为 12 kWh。对于剩下的服务器和任务，最小成本配对为 PF$\\to$Alpha (12), FD$\\to$Beta (7), CA$\\to$Delta (9)，剩余成本为 $12+7+9 = 28$ kWh。此情况下的总成本为 $12 + 28 = 40$ kWh。\n\n比较所有情况的最小总成本：$\\min\\{39, 38, 40, 40\\} = 38$。\n因此，可能的最小总能耗是 38 kWh。实现这一最优值的一种分配方案是：QS $\\to$ Delta, PF $\\to$ Alpha, FD $\\to$ Beta, CA $\\to$ Gamma，其总成本为 $8 + 12 + 7 + 11 = 38$ kWh。", "answer": "$$\\boxed{38}$$", "id": "1555349"}, {"introduction": "现实世界的问题很少像教科书那样简洁。这个更具挑战性的练习 [@problem_id:1555326] 引入了现实世界中常见的复杂性，任务不仅仅是简单的配对。你将处理一个公司重组任务，不仅要考虑技能匹配度，还需计入因岗位变动而产生的“扰动成本”，并且团队的规模并不统一。解决这个问题需要你调整和扩展基本的分配模型，这充分展示了加权匹配框架在应对复杂约束时的灵活性和强大功能。", "problem": "一家科技公司正在重组其工程部门，该部门由五名核心工程师组成：Evelyn、Frank、Grace、Heidi和Ivan。新的结构有三个项目团队：Team Apollo（2个职位）、Team Boreas（2个职位）和 Team Cronos（1个职位）。五个可用职位可表示为 $A_1, A_2, B_1, B_2, C_1$。\n\n每位工程师对每个团队都有一个“技能匹配”分数，该分数代表了他们的潜在生产力和贡献。这些分数在下表中给出：\n\n| 工程师 | Team Apollo | Team Boreas | Team Cronos |\n|----------|-------------|-------------|--------------|\n| Evelyn   | 25          | 40          | 50           |\n| Frank    | 30          | 35          | 45           |\n| Grace    | 55          | 20          | 30           |\n| Heidi    | 40          | 60          | 35           |\n| Ivan     | 25          | 30          | 70           |\n\n对于被分配到某个团队的工程师，其技能匹配分数对于该团队中的任何可用职位都是相同的。\n\n目前，工程师的分配如下：\n- Team Apollo：Evelyn、Frank\n- Team Boreas：Grace、Heidi\n- Team Cronos：Ivan\n\n重组要求将所有五名工程师重新分配到五个可用职位上，以组建新的团队。将工程师从其当前团队调动到另一个团队会产生干扰成本，表现为扣除15分。该罚分会从工程师在该新分配中的技能匹配分数中扣除。如果工程师被分配到一个新职位但仍在同一团队，则不产生罚分。\n\n新分配方案的总价值是所有五名工程师的有效分数之和，其中工程师的有效分数是其对于所分配团队的技能匹配分数减去任何适用的罚分。\n\n你的任务是确定新分配方案的最大可能总价值。", "solution": "设团队为 $A$ (Apollo)、$B$ (Boreas) 和 $C$ (Cronos)。对于每位工程师 $i$ 和团队 $T\\in\\{A,B,C\\}$，令 $s_{iT}$ 表示基础技能匹配分数，令 $T_{i}^{0}$ 表示工程师 $i$ 当前所在的团队。将工程师 $i$ 分配到团队 $T$ 的有效分数 $e_{iT}$ 为\n$$\ne_{iT}=\\begin{cases}\ns_{iT}, & T=T_{i}^{0},\\\\\ns_{iT}-15, & T\\neq T_{i}^{0}.\n\\end{cases}\n$$\n根据数据和当前分配情况（Evelyn 和 Frank 在 $A$ 团队，Grace 和 Heidi 在 $B$ 团队，Ivan 在 $C$ 团队），有效分数如下：\n- Evelyn: $e_{EA}=25$, $e_{EB}=40-15=25$, $e_{EC}=50-15=35$.\n- Frank: $e_{FA}=30$, $e_{FB}=35-15=20$, $e_{FC}=45-15=30$.\n- Grace: $e_{GA}=55-15=40$, $e_{GB}=20$, $e_{GC}=30-15=15$.\n- Heidi: $e_{HA}=40-15=25$, $e_{HB}=60$, $e_{HC}=35-15=20$.\n- Ivan: $e_{IA}=25-15=10$, $e_{IB}=30-15=15$, $e_{IC}=70$.\n\n我们必须将恰好两名工程师分配给 $A$，两名分配给 $B$，一名分配给 $C$，以使总有效分数最大化。\n\n按分配到 $C$ 的工程师分情况讨论。\n\n情况1：$C=\\text{Ivan}$。那么剩下的工程师 $\\{\\text{Evelyn},\\text{Frank},\\text{Grace},\\text{Heidi}\\}$ 必须填补两个 $A$ 和两个 $B$ 的位置。他们的 $A$/$B$ 有效分数是：\n- Evelyn: $(A,B)=(25,25)$，\n- Frank: $(30,20)$，\n- Grace: $(40,20)$，\n- Heidi: $(25,60)$。\n选择哪两人去 $A$（其余的去 $B$）；计算每种选择下这四人的总分：\n- $A=\\{E,F\\}$: $25+30+(20+60)=135$,\n- $A=\\{E,G\\}$: $25+40+(20+60)=145$,\n- $A=\\{E,H\\}$: $25+25+(20+20)=90$,\n- $A=\\{F,G\\}$: $30+40+(25+60)=155$,\n- $A=\\{F,H\\}$: $30+25+(25+20)=100$,\n- $A=\\{G,H\\}$: $40+25+(25+20)=110$.\n这四人的最大值为 $155$，在 $A=\\{\\text{Frank},\\text{Grace}\\}$ 且 $B=\\{\\text{Evelyn},\\text{Heidi}\\}$ 时取得。加上在 $C$ 的 Ivan，总分得到\n$$\n155+e_{IC}=155+70=225.\n$$\n\n情况2：$C=\\text{Evelyn}$。剩下的 $\\{\\text{Frank},\\text{Grace},\\text{Heidi},\\text{Ivan}\\}$，其 $(A,B)$ 分数为：\n- Frank $(30,20)$，Grace $(40,20)$，Heidi $(25,60)$，Ivan $(10,15)$。\n评估选择两人到 $A$ 的各种情况：\n- $A=\\{F,G\\}$: $30+40+(60+15)=145$,\n- $A=\\{F,H\\}$: $30+25+(20+15)=90$,\n- $A=\\{F,I\\}$: $30+10+(20+60)=120$,\n- $A=\\{G,H\\}$: $40+25+(20+15)=100$,\n- $A=\\{G,I\\}$: $40+10+(20+60)=130$,\n- $A=\\{H,I\\}$: $25+10+(20+20)=75$.\n这四人的最大值为 $145$。加上 $e_{EC}=35$ 得到总分 $180$。\n\n情况3：$C=\\text{Frank}$。剩下的 $\\{\\text{Evelyn},\\text{Grace},\\text{Heidi},\\text{Ivan}\\}$，其 $(A,B)$ 分数为：\n- Evelyn $(25,25)$，Grace $(40,20)$，Heidi $(25,60)$，Ivan $(10,15)$。\n评估选择两人到 $A$ 的各种情况：\n- $A=\\{E,G\\}$: $25+40+(60+15)=140$,\n- $A=\\{E,H\\}$: $25+25+(20+15)=85$,\n- $A=\\{E,I\\}$: $25+10+(20+60)=115$,\n- $A=\\{G,H\\}$: $40+25+(25+15)=105$,\n- $A=\\{G,I\\}$: $40+10+(25+60)=135$,\n- $A=\\{H,I\\}$: $25+10+(25+20)=80$.\n这四人的最大值为 $140$。加上 $e_{FC}=30$ 得到总分 $170$。\n\n情况4：$C=\\text{Grace}$。剩下的 $\\{\\text{Evelyn},\\text{Frank},\\text{Heidi},\\text{Ivan}\\}$，其 $(A,B)$ 分数为：\n- Evelyn $(25,25)$，Frank $(30,20)$，Heidi $(25,60)$，Ivan $(10,15)$。\n评估选择两人到 $A$ 的各种情况：\n- $A=\\{E,F\\}$: $25+30+(60+15)=130$,\n- $A=\\{E,H\\}$: $25+25+(20+15)=85$,\n- $A=\\{E,I\\}$: $25+10+(20+60)=115$,\n- $A=\\{F,H\\}$: $30+25+(25+15)=95$,\n- $A=\\{F,I\\}$: $30+10+(25+60)=125$,\n- $A=\\{H,I\\}$: $25+10+(25+20)=80$.\n这四人的最大值为 $130$。加上 $e_{GC}=15$ 得到总分 $145$。\n\n情况5：$C=\\text{Heidi}$。剩下的 $\\{\\text{Evelyn},\\text{Frank},\\text{Grace},\\text{Ivan}\\}$，其 $(A,B)$ 分数为：\n- Evelyn $(25,25)$，Frank $(30,20)$，Grace $(40,20)$，Ivan $(10,15)$。\n评估选择两人到 $A$ 的各种情况：\n- $A=\\{E,F\\}$: $25+30+(20+15)=90$,\n- $A=\\{E,G\\}$: $25+40+(20+15)=100$,\n- $A=\\{E,I\\}$: $25+10+(20+20)=75$,\n- $A=\\{F,G\\}$: $30+40+(25+15)=110$,\n- $A=\\{F,I\\}$: $30+10+(25+20)=85$,\n- $A=\\{G,I\\}$: $40+10+(25+20)=95$.\n这四人的最大值为 $110$。加上 $e_{HC}=20$ 得到总分 $130$。\n\n比较所有情况，最大总值为 $225$，在 $C=\\text{Ivan}$ 且在剩下的四人中 $A=\\{\\text{Frank},\\text{Grace}\\}$ 和 $B=\\{\\text{Evelyn},\\text{Heidi}\\}$ 时实现。", "answer": "$$\\boxed{225}$$", "id": "1555326"}]}