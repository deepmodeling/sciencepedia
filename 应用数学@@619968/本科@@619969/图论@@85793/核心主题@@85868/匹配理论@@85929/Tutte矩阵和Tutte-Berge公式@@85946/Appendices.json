{"hands_on_practices": [{"introduction": "图特矩阵是将一个图的组合结构转化为代数对象的一种优雅方式。通过为图的每条边引入一个变量，我们可以构建一个斜对称矩阵，其行列式蕴含了关于图的完美匹配的深刻信息。这个练习将指导你为一个具体的图——$W_5$ 轮图——构建其图特矩阵并计算其行列式，让你亲手体验如何通过代数计算揭示图的匹配特性，从而连接抽象的线性代数与直观的图论概念。[@problem_id:1547389]", "problem": "考虑轮图 $W_5$。该图由六个顶点组成的集合 $V = \\{v_0, v_1, v_2, v_3, v_4, v_5\\}$ 构成。顶点 $v_0$ 是一个中心顶点，与其余五个顶点一一相连。这五个顶点 $\\{v_1, v_2, v_3, v_4, v_5\\}$ 按此顺序构成一个圈图 $C_5$，即边为 $(v_1, v_2), (v_2, v_3), (v_3, v_4), (v_4, v_5)$ 及 $(v_5, v_1)$。\n\n图 $G$ 的 Tutte 矩阵 $T(G)$（其顶点有序排列为 $v_0, v_1, \\ldots, v_{n-1}$）是一个 $n \\times n$ 的斜对称矩阵。其元素由与图的边相关联的一组不同不定元（变量）定义。对于图中满足 $i < j$ 的每条边 $(v_i, v_j)$，元素 $T_{ij}$ 设为变量 $x_{ij}$，元素 $T_{ji}$ 设为 $-x_{ij}$。所有其他元素，包括对角线元素，均为零。\n\n对于顶点有序排列为 $v_0, v_1, v_2, v_3, v_4, v_5$ 的轮图 $W_5$，我们按如下方式为边分配变量：\n- 对于连接中心顶点 $v_0$ 和圈上顶点 $v_i$ 的“辐”边，我们使用变量 $s_i$。即，对于 $i \\in \\{1, 2, 3, 4, 5\\}$，边 $(v_0, v_i)$ 的变量是 $x_{0i} = s_i$。\n- 对于“圈”边，我们使用变量 $c_i$。具体而言，对于边 $(v_1, v_2), (v_2, v_3), (v_3, v_4)$ 和 $(v_4, v_5)$，变量分别为 $x_{12} = c_1, x_{23} = c_2, x_{34} = c_3$ 和 $x_{45} = c_4$。对于连接 $v_1$ 和 $v_5$ 的边，对应的变量是 $x_{15} = c_5$。\n\n您的任务是，为此特定图和变量赋值，计算 Tutte 矩阵 $T(W_5)$ 的行列式。请将答案表示为以变量 $s_1, \\ldots, s_5$ 和 $c_1, \\ldots, c_5$ 表示的多项式表达式。", "solution": "我们利用以下性质：对于任意偶数阶斜对称矩阵，其行列式等于其普法夫值（Pfaffian）的平方：\n$$\n\\det T(W_{5})=\\operatorname{Pf}(T(W_{5}))^{2}.\n$$\n对于 Tutte 矩阵，其普法夫值是图的所有完美匹配 $M$ 的带符号和：\n$$\n\\operatorname{Pf}(T(W_{5}))=\\sum_{M}\\epsilon(M)\\prod_{(i,j)\\in M,\\ i<j}T_{ij},\n$$\n其中 $\\epsilon(M)$ 是一个置换的符号，该置换将有序的顶点列表映射到由匹配对 $(i_{k},j_{k})$（满足 $i_{k}<j_{k}$ 和 $i_{1}<i_{2}<i_{3}$）构成的串接序列 $(i_{1},j_{1},i_{2},j_{2},i_{3},j_{3})$。\n\n在 $W_{5}$ 中，每个完美匹配必须恰好使用一条辐边 $(v_{0},v_{k})$，而剩下的四个圈上顶点则由两条不相交的圈边匹配。\n恰好有五个完美匹配，对应于 $k\\in\\{1,2,3,4,5\\}$ 的每一种选择：\n- 对于 $k=1$：$(0,1),(2,3),(4,5)$。有序对：$(0,1),(2,3),(4,5)$，序列 $(0,1,2,3,4,5)$ 具有偶数奇偶性，因此符号为 $+$。贡献为：$s_{1}c_{2}c_{4}$。\n- 对于 $k=2$：$(0,2),(1,5),(3,4)$。有序对：$(0,2),(1,5),(3,4)$，序列 $(0,2,1,5,3,4)$ 有 3 个逆序，具有奇数奇偶性，符号为 $-$。贡献为：$-s_{2}c_{5}c_{3}$。\n- 对于 $k=3$：$(0,3),(1,2),(4,5)$。有序对：$(0,3),(1,2),(4,5)$，序列 $(0,3,1,2,4,5)$ 有 2 个逆序，具有偶数奇偶性，符号为 $+$。贡献为：$s_{3}c_{1}c_{4}$。\n- 对于 $k=4$：$(0,4),(1,5),(2,3)$。有序对：$(0,4),(1,5),(2,3)$，序列 $(0,4,1,5,2,3)$ 有 5 个逆序，具有奇数奇偶性，符号为 $-$。贡献为：$-s_{4}c_{2}c_{5}$。\n- 对于 $k=5$：$(0,5),(1,2),(3,4)$。有序对：$(0,5),(1,2),(3,4)$，序列 $(0,5,1,2,3,4)$ 有 4 个逆序，具有偶数奇偶性，符号为 $+$。贡献为：$s_{5}c_{1}c_{3}$。\n\n因此，\n$$\n\\operatorname{Pf}(T(W_{5}))=s_{1}c_{2}c_{4}-s_{2}c_{5}c_{3}+s_{3}c_{1}c_{4}-s_{4}c_{2}c_{5}+s_{5}c_{1}c_{3}.\n$$\n将其平方即可得到行列式：\n$$\n\\det T(W_{5})=\\left(s_{1}c_{2}c_{4}-s_{2}c_{5}c_{3}+s_{3}c_{1}c_{4}-s_{4}c_{2}c_{5}+s_{5}c_{1}c_{3}\\right)^{2}.\n$$\n这就是所要求的、关于变量 $s_{1},\\ldots,s_{5},c_{1},\\ldots,c_5$ 的多项式表达式。", "answer": "$$\\boxed{\\left(s_{1}c_{2}c_{4}-s_{2}c_{5}c_{3}+s_{3}c_{1}c_{4}-s_{4}c_{2}c_{5}+s_{5}c_{1}c_{3}\\right)^{2}}$$", "id": "1547389"}, {"introduction": "与代数方法相对应，图特-伯格公式从组合学的角度为我们提供了理解匹配的强大工具。该公式的核心思想是，一个图中匹配的大小受限于某些关键的顶点“瓶颈”（即顶点集 $S$）。这个练习将让你运用这一思想，在一个给定的图中寻找一个特定的顶点集 $S$，使其移除后产生的奇数连通分支数量超过 $|S|$ 本身，从而简洁有力地证明该图不存在完美匹配。[@problem_id:1547426]", "problem": "考虑一个根据以下过程构建的图 $G$。首先，取一个有8个顶点的圈图，顶点按顺时针顺序标记为 $v_1, v_2, \\ldots, v_8$。这构成了一个 $C_8$ 圈。向该图中添加一条连接对径顶点 $v_1$ 和 $v_5$ 的“长弦”边。最后，引入两个新顶点，名为 $u$ 和 $w$。添加一条连接 $u$ 到 $v_1$ 的边，以及另一条连接 $w$ 到 $v_5$ 的边。最终得到的图 $G$ 共有10个顶点。\n\n根据一个与 Tutte-Berge 公式相关的结果，对于一个具有偶数个顶点的图，如果存在一个顶点子集 $S \\subset V(G)$ 使得 $o(G-S) > |S|$，那么该图就没有完美匹配。其中 $|S|$ 是 $S$ 中的顶点数，而 $o(G-S)$ 是子图 $G-S$ 中具有奇数个顶点的连通分量的数量。\n\n下列哪个顶点集 $S$ 通过满足条件 $o(G-S) > |S|$ 证明了所述图 $G$ 不存在完美匹配？\n\nA. $S = \\{v_2, v_6\\}$\n\nB. $S = \\{v_1, v_5\\}$\n\nC. $S = \\{u, w\\}$\n\nD. $S = \\{v_3, v_7\\}$\n\nE. $S = \\{v_2, v_4, v_6, v_8\\}$", "solution": "我们应用 Tutte-Berge 条件：一个具有偶数个顶点的图没有完美匹配，如果存在 $S \\subset V(G)$ 使得 $o(G-S) > |S|$，其中 $o(G-S)$ 是 $G-S$ 中具有奇数个顶点的连通分量的数量。\n\n我们对每个候选集 $S$ 进行评估。\n\n选项 A：$S=\\{v_{2},v_{6}\\}$。移除 $v_{2}$ 和 $v_{6}$ 后，剩下的顶点为 $\\{v_{1},v_{3},v_{4},v_{5},v_{7},v_{8},u,w\\}$。剩余的边包括弦 $v_{1}v_{5}$，圈边 $v_{3}v_{4}$、$v_{4}v_{5}$、$v_{7}v_{8}$、$v_{8}v_{1}$，以及叶边 $uv_{1}$、$wv_{5}$。所有这些顶点都位于一个大小为8（偶数）的单一连通分量中。因此 $o(G-S)=0<|S|=2$，所以这个集合不能证明。\n\n选项 B：$S=\\{v_{1},v_{5}\\}$。移除 $v_{1}$ 和 $v_{5}$ 后，剩下的顶点为 $\\{v_{2},v_{3},v_{4},v_{6},v_{7},v_{8},u,w\\}$。剩余的边是 $v_{2}v_{3}$、$v_{3}v_{4}$ 和 $v_{6}v_{7}$、$v_{7}v_{8}$。因此，连通分量是路径 $\\{v_{2},v_{3},v_{4}\\}$（大小为3，奇数），路径 $\\{v_{6},v_{7},v_{8}\\}$（大小为3，奇数），孤立顶点 $\\{u\\}$（大小为1，奇数），和孤立顶点 $\\{w\\}$（大小为1，奇数）。所以 $o(G-S)=4$ 且 $|S|=2$，因此 $o(G-S)>|S|$ 成立。这证明了 $G$ 没有完美匹配。\n\n选项 C：$S=\\{u,w\\}$。移除 $u$ 和 $w$ 后，剩下的是在 $\\{v_{1},\\dots,v_{8}\\}$ 上的带弦 $v_{1}v_{5}$ 的8顶点连通图。因此，只有一个偶数大小的连通分量，所以 $o(G-S)=0<|S|=2$，不能作为证明。\n\n选项 D：$S=\\{v_{3},v_{7}\\}$。移除 $v_{3}$ 和 $v_{7}$ 后，剩下的顶点为 $\\{v_{1},v_{2},v_{4},v_{5},v_{6},v_{8},u,w\\}$，它们通过圈边 $v_{1}v_{2}$、$v_{4}v_{5}$、$v_{5}v_{6}$、$v_{8}v_{1}$，弦 $v_{1}v_{5}$，以及叶边 $uv_{1}$、$wv_{5}$ 形成一个单一的连通分量。该分量大小为8（偶数），所以 $o(G-S)=0<|S|=2$，不能作为证明。\n\n选项 E：$S=\\{v_{2},v_{4},v_{6},v_{8}\\}$。移除这些顶点后，剩下 $\\{v_{1},v_{3},v_{5},v_{7},u,w\\}$。剩余的边是弦 $v_{1}v_{5}$ 和叶边 $uv_{1}$、$wv_{5}$。因此，有一个大小为4（偶数）的连通分量 $\\{u,v_{1},v_{5},w\\}$ 和两个孤立顶点 $\\{v_{3}\\}$ 和 $\\{v_{7}\\}$（大小均为奇数）。因此 $o(G-S)=2$ 且 $|S|=4$，所以 $o(G-S)\\leq|S|$，不能作为证明。\n\n因此，只有 $S=\\{v_{1},v_{5}\\}$ 满足 $o(G-S) > |S|$。", "answer": "$$\\boxed{B}$$", "id": "1547426"}, {"introduction": "在掌握了如何使用图特-伯格条件判断完美匹配是否存在后，我们可以进一步应用该公式来解决一个更普遍的问题：计算任意图的最大匹配数。这不再是简单地寻找一个符合条件的集合 $S$，而是需要系统地分析并找到一个能使 $o(G-S) - |S|$ 这一表达式达到最大值的“最优”顶点集。通过解决这个问题，你将完整地体验图特-伯格公式在实际计算中的威力，并加深对图的“缺陷”这一核心概念的理解。[@problem_id:1547422]", "problem": "构造一个有10个顶点的图$G$。其顶点集$V$被划分为五个不相交的集合：$A=\\{a_1\\}$，$B=\\{b_1\\}$，$C=\\{c_1, c_2, c_3\\}$，$D=\\{d_1, d_2, d_3\\}$以及$S=\\{s_1, s_2\\}$。$G$的边定义如下：\n1. 由顶点集$C$诱导的子图是一个完全图（$K_3$）。\n2. 由顶点集$D$诱导的子图是一个完全图（$K_3$）。\n3. 对于任意顶点$v \\in A \\cup B \\cup C \\cup D$和任意顶点$s \\in S$，边$(v,s)$存在于$G$中。\n4. 除上述规则指定的边外，$G$中不存在其他边。\n\n图$G$中最大匹配的大小是多少？", "solution": "最大匹配的大小，记为$\\nu(G)$，可以使用Tutte-Berge公式来确定。对于一个顶点集为$V$的图$G$，该公式将$\\nu(G)$与顶点数$|V|$以及图的亏量（defect）$\\text{def}(G)$联系起来：\n$$2\\nu(G) = |V| - \\text{def}(G)$$\n亏量定义为在顶点集$V$的所有可能子集$U$上，$o(G-U) - |U|$的最大值，其中$o(G-U)$表示图$G-U$（由$V \\setminus U$诱导的$G$的子图）中含有奇数个顶点的连通分量的数量。\n$$\\text{def}(G) = \\max_{U \\subseteq V} \\{ o(G-U) - |U| \\}$$\n在我们的问题中，总顶点数为$|V| = |A|+|B|+|C|+|D|+|S| = 1+1+3+3+2 = 10$。我们需要通过找到使$o(G-U) - |U|$最大化的集合$U$来求出$\\text{def}(G)$。\n\n让我们针对$U \\subseteq V$的不同选择来分析表达式$o(G-U) - |U|$。我们可以根据$U$与集合$S=\\{s_1, s_2\\}$的交集将分析分为几种情况。\n\n情况1：$U \\cap S = \\emptyset$。（即$s_1 \\notin U$且$s_2 \\notin U$）\n在这种情况下，$s_1$和$s_2$都在图$G-U$中。根据构造，$(A \\cup B \\cup C \\cup D) \\setminus U$中的每个顶点都与$s_1$和$s_2$相连。因此，$V \\setminus U$中的任意两个顶点之间都存在一条路径（例如，通过$s_1$），这意味着图$G-U$是连通的。只有一个连通分量。该分量中的顶点数为$10 - |U|$。\n奇分量的数量$o(G-U)$为1（如果$10 - |U|$是奇数），否则为0。\n- 如果$o(G-U) = 1$，则$10 - |U|$为奇数，这意味着$|U|$为奇数。表达式的值为$1 - |U|$，对于任何非空的奇数大小的$U$，该值都$\\le 0$。如果$U=\\emptyset$，则$|U|=0$是偶数，$o(G-\\emptyset)=0$。所以$o(G-U)-|U| \\le 0$。\n- 如果$o(G-U) = 0$，表达式的值为$0 - |U| \\le 0$。\n在这种情况下，最大值为0（当$U = \\emptyset$时取得）。\n\n情况2：$|U \\cap S| = 1$。（即$s_1, s_2$中恰好有一个在$U$中）\n假设$s_1 \\in U$且$s_2 \\notin U$（$s_2 \\in U, s_1 \\notin U$的情况是对称的）。$(A \\cup B \\cup C \\cup D) \\setminus U$中的每个顶点都与$s_2$相连。因此，$V \\setminus U$中的所有顶点都在同一个连通分量中。图$G-U$是连通的。\n与情况1类似，$o(G-U)$为0或1。由于$U$必须至少包含一个顶点（$s_1$），所以$|U| \\ge 1$。表达式$o(G-U) - |U|$最多为$1 - |U| \\le 1 - 1 = 0$。\n\n情况3：$S \\subseteq U$。（即$\\{s_1, s_2\\} \\subseteq U$）\n令$U = S \\cup U'$，其中$U' \\subseteq A \\cup B \\cup C \\cup D$。那么$|U| = |S| + |U'| = 2 + |U'|$。\n图$G-U$是在顶点$(A \\cup B \\cup C \\cup D) \\setminus U'$上的图。当我们移除集合$S$时，所有连接到$S$的边都被移除。剩余的图$G-S$的边仅存在于$C$内部和$D$内部。\n$G-S$的连通分量是：\n- 一个孤立顶点$a_1$（一个$K_1$，是奇分量）。\n- 一个孤立顶点$b_1$（一个$K_1$，是奇分量）。\n- 在$C=\\{c_1, c_2, c_3\\}$上的完全图（一个$K_3$，是奇分量）。\n- 在$D=\\{d_1, d_2, d_3\\}$上的完全图（一个$K_3$，是奇分量）。\n所以，$G-S$有4个奇分量。\n现在考虑移除额外的顶点$U' \\subseteq A \\cup B \\cup C \\cup D$。\n我们先测试$U=S$这个特定选择，这对应于$U'=\\emptyset$。\n对于$U=S$，有$|U|=2$。图$G-S$有4个奇分量，所以$o(G-S)=4$。\n表达式的值为$o(G-S) - |S| = 4 - 2 = 2$。\n\n现在我们需要检查移除更多顶点（即$U' \\neq \\emptyset$）是否会产生更大的值。\n令$f(U) = o(G-U) - |U| = o((G-S)-U') - (2+|U'|)$。\n让我们分析从$G-S$的各个分量中移除顶点的效果。令$U'_A=U' \\cap A$，$U'_C=U' \\cap C$等等。\n$o((G-S)-U') = o(\\{a_1\\}\\setminus U'_A) + o(\\{b_1\\}\\setminus U'_B) + o(K_3[C]\\setminus U'_C) + o(K_3[D]\\setminus U'_D)$。\n我们希望最大化的量是$o((G-S)-U') - |U'| - 2$。为了最大化它，我们应该最大化$g(U') = o((G-S)-U')-|U'|$。\n我们来分析每个分量的贡献。\n- 对于分量$\\{a_1\\}$：如果我们移除$a_1$（$|U'_A|=1$），我们得到0个奇分量。变化是$0-1=-1$。如果我们不移除任何顶点（$|U'_A|=0$），我们有1个奇分量。值$o-k$是$1-0=1$。所以，我们不应该移除$a_1$。\n- 对于分量$\\{b_1\\}$：同样，我们不应该移除$b_1$。\n- 对于分量$K_3[C]$：令$k_C = |U'_C|$。\n  - $k_C=0$：剩下$K_3$，$o=1$。值$o-k_C = 1$。\n  - $k_C=1$：剩下$K_2$，$o=0$。值$o-k_C = -1$。\n  - $k_C=2$：剩下$K_1$，$o=1$。值$o-k_C = -1$。\n  - $k_C=3$：剩下空图，$o=0$。值$o-k_C = -3$。\n  最大贡献为1，在从$C$中移除0个顶点时取得。\n- 对于分量$K_3[D]$：同样，最大贡献为1，在从$D$中移除0个顶点时取得。\n\n为了最大化$g(U')$，我们应该选择$U'$，使其能最大化来自$G-S$每个分量的贡献。在所有情况下，这都发生在$U'$为空集时。\n因此，最大值在$U'=\\emptyset$时取得，这意味着$U=S$。\n\n综合所有情况，$o(G-U) - |U|$的最大值为2，在$U=S$时取得。\n因此，$\\text{def}(G) = 2$。\n\n最后，我们可以求出最大匹配的大小$\\nu(G)$：\n$2\\nu(G) = |V| - \\text{def}(G) = 10 - 2 = 8$。\n$\\nu(G) = \\frac{8}{2} = 4$。\n\n图$G$中最大匹配的大小是4。\n为了验证，我们可以构造一个这样的匹配。在$G-S$中，我们有四个奇分量。我们可以在两个$K_3$分量内部进行匹配，例如，使用边$(c_1, c_2)$和$(d_1, d_2)$。这剩下顶点$a_1, b_1, c_3, d_3$未被匹配。由于这些顶点都与$s_1$和$s_2$相连，我们可以形成匹配边$(a_1, s_1)$和$(b_1, s_2)$。现在总的匹配是$M = \\{(c_1, c_2), (d_1, d_2), (a_1, s_1), (b_1, s_2)\\}$。这是一个大小为4的匹配。被覆盖的顶点是$\\{c_1, c_2, d_1, d_2, a_1, s_1, b_1, s_2\\}$。未匹配的顶点是$\\{c_3, d_3\\}$。有两个未匹配的顶点，这证实了$\\text{def}(G)=2$。", "answer": "$$\\boxed{4}$$", "id": "1547422"}]}