{"hands_on_practices": [{"introduction": "我们从一个经典的无限可分分布——伽马分布——开始我们的实践。这个练习旨在通过直接应用无限可分性的定义来巩固核心概念。通过使用矩生成函数（或特征函数）这一强大工具，我们将一个已知的分布分解为其独立同分布的组成部分，这是处理随机变量求和问题的标准方法 [@problem_id:1308915]。", "problem": "如果一个随机变量 $X$ 对于任意正整数 $n$，都可以表示为 $n$ 个独立同分布 (i.i.d.) 的随机变量 $Y_1, Y_2, \\dots, Y_n$ 的和，那么称该随机变量 $X$ 是无限可分的。即，$X = \\sum_{i=1}^n Y_i$。\n\n考虑一个服从伽马分布的随机变量 $X$，其形状参数为 $\\alpha > 0$，率参数为 $\\beta > 0$。我们将其记为 $X \\sim \\Gamma(\\alpha, \\beta)$。该变量的概率密度函数由 $f(x; \\alpha, \\beta) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} x^{\\alpha-1} \\exp(-\\beta x)$ 给出，其中 $x > 0$。已知伽马分布是无限可分的，那么这些独立同分布的分量 $Y_i$ 的分布是什么？\n\nA. 均值为 $\\frac{\\alpha}{n\\beta}$、方差为 $\\frac{\\alpha}{n\\beta^2}$ 的正态分布。\n\nB. 伽马分布 $\\Gamma(\\frac{\\alpha}{n}, \\beta)$。\n\nC. 伽马分布 $\\Gamma(\\alpha, \\frac{\\beta}{n})$。\n\nD. 伽马分布 $\\Gamma(\\frac{\\alpha}{n}, \\frac{\\beta}{n})$。\n\nE. 率为 $\\frac{\\beta}{\\alpha}$ 的指数分布。", "solution": "设 $X \\sim \\Gamma(\\alpha, \\beta)$，其密度函数为 $f(x;\\alpha,\\beta) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} x^{\\alpha - 1} \\exp(-\\beta x)$，其中 $x>0$。对于 $t<\\beta$，$X$ 的矩生成函数 (mgf) 计算如下：\n$$\nM_{X}(t) = \\mathbb{E}[\\exp(tX)] = \\int_{0}^{\\infty} \\exp(tx) \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} x^{\\alpha - 1} \\exp(-\\beta x)\\,dx \\\\\n= \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} \\int_{0}^{\\infty} x^{\\alpha - 1} \\exp\\big(-( \\beta - t ) x\\big)\\,dx \\\\\n= \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} \\cdot \\frac{\\Gamma(\\alpha)}{(\\beta - t)^{\\alpha}} = \\left(\\frac{\\beta}{\\beta - t}\\right)^{\\alpha}.\n$$\n如果 $X$ 是无限可分的，使得 $X = \\sum_{i=1}^{n} Y_{i}$，其中 $Y_{1},\\dots,Y_{n}$ 是独立同分布的，那么根据独立性，\n$$\nM_{X}(t) = \\prod_{i=1}^{n} M_{Y}(t) = \\big(M_{Y}(t)\\big)^{n}.\n$$\n将其与 $X$ 的 mgf 相等，可得\n$$\n\\big(M_{Y}(t)\\big)^{n} = \\left(\\frac{\\beta}{\\beta - t}\\right)^{\\alpha} \\quad \\Longrightarrow \\quad M_{Y}(t) = \\left(\\frac{\\beta}{\\beta - t}\\right)^{\\alpha/n}, \\quad t<\\beta.\n$$\n但是，一个 $\\Gamma(k,\\beta)$ 分布（形状参数为 $k$，率参数为 $\\beta$）的 mgf 是 $M(t) = \\left(\\frac{\\beta}{\\beta - t}\\right)^{k}$，其中 $t<\\beta$。因此，$M_{Y}(t)$ 与 $\\Gamma\\!\\left(\\frac{\\alpha}{n}, \\beta\\right)$ 的矩生成函数相匹配。根据矩生成函数的唯一性，这确定了其分布：\n$$\nY_{i} \\sim \\Gamma\\!\\left(\\frac{\\alpha}{n}, \\beta\\right) \\quad \\text{i.i.d.}\n$$\n这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "1308915"}, {"introduction": "在学习了一个肯定的例子之后，探索一个反例同样重要，因为它能揭示概念的边界。本练习将挑战我们去证明一个非常基础的分布——伯努利分布——实际上并非无限可分。通过分析其分量可能取值的范围并进行逻辑推导，我们将发现一个根本性的矛盾，从而加深对无限可分性内在约束的直观理解 [@problem_id:1308940]。", "problem": "如果一个随机变量 $X$ 对于任意正整数 $n$ 都可以表示为 $n$ 个独立同分布 (i.i.d.) 的随机变量之和 $X = Y_1 + Y_2 + \\dots + Y_n$，则称 $X$ 是无限可分的。\n\n考虑一个成功概率为 $p$ 的伯努利随机变量 $X$，其中 $0 < p < 1$。其概率质量函数为 $P(X=1) = p$ 和 $P(X=0) = 1-p$。我们假设这个伯努利变量是无限可分的。这意味着对于任意整数 $n \\ge 2$，我们可以找到独立同分布的随机变量 $Y_1, Y_2, \\dots, Y_n$ 使得它们的和等于 $X$。\n\n关注 $n=2$ 的情况，我们假设 $X = Y_1 + Y_2$，其中 $Y_1$ 和 $Y_2$ 是独立同分布的。通过分析 $Y_1$ 和 $Y_2$ 必须具备的性质，可以发现一个矛盾。\n\n下列哪个陈述正确地指出了为什么参数为 $p \\in (0,1)$ 的伯努利随机变量不可能是无限可分的根本原因？\n\nA. 和 $Y_1 + Y_2$ 必须能够以非零概率取到 0 或 1 以外的值，这与伯努利变量 $X$ 的支撑集相矛盾。\n\nB. 期望 $E[X] = p$ 无法分解为和 $E[Y_1] + E[Y_2]$，因为变量 $Y_i$ 的期望会是虚数。\n\nC. 方差 $\\text{Var}(X) = p(1-p)$ 无法被方差之和 $\\text{Var}(Y_1) + \\text{Var}(Y_2)$ 满足，因为每个 $Y_i$ 的方差必须是负的。\n\nD. 随机变量 $Y_1$ 和 $Y_2$ 必须能够取负值，这是不可能的，因为它们的和必须是非负的。\n\nE. 对于任何 $p \\in (0,1)$，$X$ 的特征函数都不能表示为另一个有效特征函数的平方。", "solution": "为了确定为什么参数为 $p \\in (0,1)$ 的伯努利随机变量 $X$ 不是无限可分的，我们分析假设它是无限可分所带来的后果。一个无限可分的随机变量对于任意正整数 $n$ 都可以分解为 $n$ 个独立同分布 (i.i.d.) 随机变量的和。我们将研究 $n=2$ 的情况。\n\n假设 $X$ 是无限可分的。那么存在两个独立同分布的随机变量 $Y_1$ 和 $Y_2$，使得 $X = Y_1 + Y_2$。随机变量 $X$ 只能在集合 $\\{0, 1\\}$ 中取值。\n\n我们来分析 $Y_1$ 和 $Y_2$ 的可能取值 (支撑集)。令 $y_{max}$ 为 $Y_1$ (以及 $Y_2$) 能取到的最大可能值。由于 $Y_1$ 和 $Y_2$ 是独立同分布的，它们和的最大值是 $y_{max} + y_{max} = 2y_{max}$。这个和必须小于或等于 $X$ 的最大值，即 1。因此，$2y_{max} \\le 1$，这意味着 $y_{max} \\le \\frac{1}{2}$。\n\n类似地，令 $y_{min}$ 为 $Y_1$ 的最小可能值。它们的和的最小值是 $2y_{min}$。这个值必须大于或等于 $X$ 的最小值，即 0。因此，$2y_{min} \\ge 0$，这意味着 $y_{min} \\ge 0$。\n所以，$Y_1$ 和 $Y_2$ 支撑集中的任何值 $y$ 都必须满足 $0 \\le y \\le \\frac{1}{2}$。\n\n现在，我们来考虑事件 $X=1$ 和 $X=0$。\n事件 $X=1$ 以概率 $P(X=1)=p$ 发生。要使和 $Y_1+Y_2$ 等于 1，鉴于每个变量都被限制在 $[0, \\frac{1}{2}]$ 内，唯一的可能性是 $Y_1$ 和 $Y_2$ 都必须恰好等于 $\\frac{1}{2}$。\n因此，值 $\\frac{1}{2}$ 必须在 $Y_1$ 和 $Y_2$ 的支撑集中。令 $P(Y_1 = \\frac{1}{2}) = q$。因为 $Y_1$ 和 $Y_2$ 是独立同分布的，所以 $P(Y_2 = \\frac{1}{2}) = q$。\n由于它们的独立性，我们有：\n$P(X=1) = P(Y_1 = \\frac{1}{2} \\text{ and } Y_2 = \\frac{1}{2}) = P(Y_1 = \\frac{1}{2}) P(Y_2 = \\frac{1}{2}) = q \\cdot q = q^2$。\n所以，$p = q^2$。因为我们已知 $p \\in (0,1)$，由此得出 $q = \\sqrt{p} \\in (0,1)$。这是一个有效的概率。\n\n接下来，考虑事件 $X=0$，它以概率 $P(X=0)=1-p$ 发生。要使和 $Y_1+Y_2$ 等于 0，鉴于每个变量都是非负的，唯一的可能性是 $Y_1$ 和 $Y_2$ 都必须恰好等于 0。\n因此，值 0 也必须在 $Y_1$ 和 $Y_2$ 的支撑集中。令 $P(Y_1 = 0) = r$。因为它们是独立同分布的，所以 $P(Y_2 = 0) = r$。\n由于它们的独立性，我们有：\n$P(X=0) = P(Y_1 = 0 \\text{ and } Y_2 = 0) = P(Y_1 = 0) P(Y_2 = 0) = r \\cdot r = r^2$。\n所以，$1-p = r^2$。因为 $p \\in (0,1)$，由此得出 $r = \\sqrt{1-p} \\in (0,1)$。这也是一个有效的概率。\n\n现在，我们已经确定分量随机变量 $Y_i$ 必须能够至少取两个值，0 和 $\\frac{1}{2}$，其概率分别为非零的 $r$ 和 $q$。我们来考虑一个变量为 0 而另一个为 $\\frac{1}{2}$ 的情况。和 $Y_1+Y_2$ 将为 $\\frac{1}{2}$。该事件的概率是：\n$P(Y_1 + Y_2 = \\frac{1}{2}) = P(Y_1 = \\frac{1}{2}, Y_2 = 0) + P(Y_1 = 0, Y_2 = \\frac{1}{2})$\n因为 $Y_1$ 和 $Y_2$ 是独立的：\n$P(Y_1 + Y_2 = \\frac{1}{2}) = P(Y_1 = \\frac{1}{2})P(Y_2 = 0) + P(Y_1 = 0)P(Y_2 = \\frac{1}{2}) = q \\cdot r + r \\cdot q = 2qr$。\n\n代入我们关于 $q$ 和 $r$ 的表达式：\n$P(Y_1 + Y_2 = \\frac{1}{2}) = 2\\sqrt{p}\\sqrt{1-p} = 2\\sqrt{p(1-p)}$。\n因为我们已知 $p \\in (0,1)$，所以 $p$ 和 $1-p$ 都是正数。因此，概率 $2\\sqrt{p(1-p)}$ 严格大于 0。\n\n这就导致了矛盾。我们关于 $X = Y_1 + Y_2$ 的假设意味着这个和必须能够以非零概率取值 $\\frac{1}{2}$。然而，原始的伯努利变量 $X$ 只能取值 0 或 1。其支撑集是 $\\{0, 1\\}$。值 $\\frac{1}{2}$ 不在其支撑集中，所以 $P(X=\\frac{1}{2})$ 必须为 0。\n这个假设导出了一个不可能的结论。因此，最初的假设必定是错误的：一个参数为 $p \\in (0,1)$ 的伯努利随机变量不是无限可分的。\n\n这个推理过程直接对应于选项 A。其他选项是不正确的：\nB: $E[X] = p$。$E[Y_1+Y_2] = 2E[Y_1]$。所以 $E[Y_1]=p/2$，这是一个有效的实数。\nC: $\\text{Var}(X) = p(1-p)$。$\\text{Var}(Y_1+Y_2) = 2\\text{Var}(Y_1)$。所以 $\\text{Var}(Y_1) = p(1-p)/2$，当 $p \\in (0,1)$ 时，这个值是正的。\nD: 我们证明了 $Y_i$ 的值必须在 $[0, 1/2]$ 范围内，所以不需要负值。\nE: 尽管这个说法是正确的，但它是一个使用特征函数的更高级的论证。问题要求的是基于分解本身的根本原因，也就是随机变量支撑集上的矛盾。基于值的和的推理更直接也更基础。", "answer": "$$\\boxed{A}$$", "id": "1308940"}, {"introduction": "最后的这个练习将我们的视角从“分析”转向“综合”，直接应用无限可分分布的通用蓝图——Lévy-Khintchine表示。我们将从一个给定的Lévy-Khintchine三元组出发，识别出其漂移、高斯和跳跃部分，并由此构建出具体的随机变量。这个过程不仅揭开了这一抽象表示的神秘面纱，还展示了如何利用它将复杂的随机变量理解为简单独立成分（如常数、泊松和复合泊松过程）之和，并进行实际的概率计算 [@problem_id:1308904]。", "problem": "一个无限可分概率分布是指其特征函数 $\\phi_X(u) = E[\\exp(iuX)]$ 可以用 Lévy-Khintchine 表示法来表达的分布。对于任意这样的随机变量 $X$，其特征函数由下式给出：\n$$ \\phi_X(u) = \\exp\\left(i\\gamma u - \\frac{1}{2}\\sigma^2 u^2 + \\int_{\\mathbb{R}\\setminus\\{0\\}} \\left(e^{iux} - 1 - iux \\mathbf{1}_{|x|<1}\\right) \\nu(dx)\\right) $$\n此处，三元组 $(\\gamma, \\sigma^2, \\nu)$ 唯一地刻画了该分布。参数 $\\gamma \\in \\mathbb{R}$ 是一个漂移系数，$\\sigma^2 \\ge 0$ 是一个连续高斯分量的方差，而 $\\nu$ 是 Lévy 测度，它满足 $\\int_{\\mathbb{R}\\setminus\\{0\\}} \\min(1, x^2) \\nu(dx) < \\infty$。项 $\\mathbf{1}_{|x|<1}$ 是一个指示函数，当 $|x|<1$ 时其值为 1，否则为 0。\n\n考虑一个随机变量 $X$，其分布由具有以下具体分量的 Lévy-Khintchine 三元组 $(\\gamma, \\sigma^2, \\nu)$ 刻画：\n- 漂移：$\\gamma = -1$\n- 高斯方差：$\\sigma^2 = 0$\n- Lévy 测度：$\\nu(dx) = 3 \\delta_{1}(dx) + 1.5 \\delta_{2}(dx)$，其中 $\\delta_{a}(dx)$ 表示集中在点 $x=a$ 的 Dirac delta 测度。\n\n计算概率 $P(X=2)$。将答案表示为一个实数，并四舍五入到四位有效数字。", "solution": "问题要求我们计算一个由特定 Lévy-Khintchine 三元组 $(\\gamma, \\sigma^2, \\nu)$ 定义的随机变量 $X$ 的概率 $P(X=2)$。给定的参数为 $\\gamma = -1$，$\\sigma^2 = 0$，以及 Lévy 测度 $\\nu(dx) = 3 \\delta_1(dx) + 1.5 \\delta_2(dx)$。\n\n首先，我们将这些参数代入特征函数 $\\phi_X(u)$ 的一般 Lévy-Khintchine 公式中：\n$$ \\phi_X(u) = \\exp\\left(i(-1)u - \\frac{1}{2}(0)u^2 + \\int_{\\mathbb{R}\\setminus\\{0\\}} \\left(e^{iux} - 1 - iux \\mathbf{1}_{|x|<1}\\right) \\nu(dx)\\right) $$\n$$ \\phi_X(u) = \\exp\\left(-iu + \\int_{\\mathbb{R}\\setminus\\{0\\}} \\left(e^{iux} - 1 - iux \\mathbf{1}_{|x|<1}\\right) (3 \\delta_1(dx) + 1.5 \\delta_2(dx))\\right) $$\n\n接下来，我们计算关于 Lévy 测度的积分。一个函数 $f(x)$ 关于 Dirac delta 测度 $\\delta_a(dx)$ 的积分就是 $f(a)$。应用这个性质，该积分变成一个和式：\n$$ \\int_{\\mathbb{R}\\setminus\\{0\\}} (\\dots) (3 \\delta_1(dx) + 1.5 \\delta_2(dx)) = 3 \\left(e^{iu(1)} - 1 - iu(1) \\mathbf{1}_{|1|<1}\\right) + 1.5 \\left(e^{iu(2)} - 1 - iu(2) \\mathbf{1}_{|2|<1}\\right) $$\n指示函数 $\\mathbf{1}_{|x|<1}$ 对于 $x=1$ 和 $x=2$ 时的值都为 0，因为 $|1|<1$ 和 $|2|<1$ 都不成立。因此，截断项 $iux \\mathbf{1}_{|x|<1}$ 为零。积分简化为：\n$$ 3(e^{iu} - 1) + 1.5(e^{i2u} - 1) $$\n\n现在我们将这个结果代回到 $\\phi_X(u)$ 的表达式中：\n$$ \\phi_X(u) = \\exp(-iu + 3(e^{iu} - 1) + 1.5(e^{i2u} - 1)) $$\n我们可以将指数中的各项分开，以便更清晰地看清其结构：\n$$ \\phi_X(u) = \\exp(-iu) \\cdot \\exp(3(e^{iu} - 1)) \\cdot \\exp(1.5(e^{i2u} - 1)) $$\n\n这个表达式是三个特征函数的乘积。我们可以解释每一项：\n1. $\\phi_C(u) = \\exp(-iu)$ 是一个退化随机变量（一个常数）$C = -1$ 的特征函数。\n2. $\\phi_{Y_1}(u) = \\exp(3(e^{iu} - 1))$ 是一个参数为 $\\lambda_1 = 3$ 的泊松随机变量 $Y_1$ 的特征函数。我们称这个变量为 $N_1 \\sim \\text{Poisson}(3)$。\n3. $\\phi_{Y_2}(u) = \\exp(1.5(e^{i2u} - 1))$ 是一个伸缩泊松随机变量的特征函数。一个随机变量 $Z = aN$，其中 $N \\sim \\text{Poisson}(\\lambda)$，其特征函数为 $\\phi_Z(u) = E[\\exp(iuaN)] = E[(e^{iua})^N] = \\exp(\\lambda(e^{iua}-1))$。因此，我们的第三项对应于一个随机变量 $Y_2 = 2N_2$，其中 $N_2 \\sim \\text{Poisson}(1.5)$。\n\n由于 $X$ 的特征函数是 $C$、$N_1$ 和 $2N_2$ 特征函数的乘积，随机变量 $X$ 是这三个独立的随机变量之和：\n$$ X = C + N_1 + 2N_2 = -1 + N_1 + 2N_2 $$\n其中 $N_1 \\sim \\text{Poisson}(3)$ 和 $N_2 \\sim \\text{Poisson}(1.5)$ 是独立的。\n\n我们需要计算 $P(X=2)$。这等价于计算 $P(N_1 + 2N_2 - 1 = 2)$，可简化为 $P(N_1 + 2N_2 = 3)$。我们可以通过对所有满足方程 $k_1 + 2k_2 = 3$ 的 $k_1$（来自 $N_1$）和 $k_2$（来自 $N_2$）的可能非负整数值进行求和来找到这个概率。\n可能的数对 $(k_1, k_2)$ 是：\n- 如果 $k_2=0$，那么 $k_1=3$。这给出了数对 $(3, 0)$。\n- 如果 $k_2=1$，那么 $k_1=1$。这给出了数对 $(1, 1)$。\n- 如果 $k_2 \\ge 2$，那么 $2k_2 \\ge 4$，所以对于 $k_1$ 没有非负整数解。\n\n该概率是这两个互斥事件的概率之和：\n$$ P(N_1 + 2N_2 = 3) = P(N_1=3, N_2=0) + P(N_1=1, N_2=1) $$\n由于独立性，我们可以将其写为：\n$$ P(N_1 + 2N_2 = 3) = P(N_1=3)P(N_2=0) + P(N_1=1)P(N_2=1) $$\n使用泊松分布的概率质量函数 $P(N=k) = \\frac{e^{-\\lambda}\\lambda^k}{k!}$：\n- $P(N_1=3) = \\frac{e^{-3}3^3}{3!} = \\frac{27}{6}e^{-3} = 4.5 e^{-3}$\n- $P(N_2=0) = \\frac{e^{-1.5}(1.5)^0}{0!} = e^{-1.5}$\n- $P(N_1=1) = \\frac{e^{-3}3^1}{1!} = 3e^{-3}$\n- $P(N_2=1) = \\frac{e^{-1.5}(1.5)^1}{1!} = 1.5e^{-1.5}$\n\n将这些代入和式中：\n$$ P(X=2) = (4.5 e^{-3})(e^{-1.5}) + (3 e^{-3})(1.5 e^{-1.5}) $$\n$$ P(X=2) = 4.5 e^{-4.5} + 4.5 e^{-4.5} $$\n$$ P(X=2) = 9 e^{-4.5} $$\n\n最后，我们计算其数值并四舍五入到四位有效数字：\n$$ 9 e^{-4.5} \\approx 9 \\times 0.0111089965 \\approx 0.0999809685 $$\n四舍五入到四位有效数字得到 $0.09998$。", "answer": "$$\\boxed{0.09998}$$", "id": "1308904"}]}