{"hands_on_practices": [{"introduction": "这个练习旨在帮助你建立关于高斯过程来源的直观理解。通过从基本、易于理解的随机变量（如本例中的$A$和$B$）构建一个简单的随机过程$X_t = At + B$，我们可以直接推导出其均值和协方差函数。这个过程揭示了抽象的协方差函数的神秘面纱，并展示了它如何捕捉过程的底层结构。[@problem_id:1304141]", "problem": "一个描述传感器读数随时间 $t$ 线性漂移的简单模型由随机过程 $X_t = At + B$ 给出。其中，$B$ 项表示随机初始偏移，$A$ 项表示随机漂移率。假设 $A$ 和 $B$ 是相互独立的随机变量，均服从标准正态分布，即均值为0、方差为1的正态分布。对于任意两个不同的时间点 $t_1$ 和 $t_2$，读数对 $(X_{t_1}, X_{t_2})$ 构成一个随机向量。求此随机向量的协方差矩阵。", "solution": "设随机向量为 $\\mathbf{X} = (X_{t_1}, X_{t_2})$。该向量的协方差矩阵 $\\boldsymbol{\\Sigma}$ 是一个 $2 \\times 2$ 矩阵，其元素 $\\boldsymbol{\\Sigma}_{ij}$ 由向量的第 $i$ 个分量和第 $j$ 个分量之间的协方差给出。\n$$\n\\boldsymbol{\\Sigma} = \\begin{pmatrix}\n\\text{Cov}(X_{t_1}, X_{t_1}) & \\text{Cov}(X_{t_1}, X_{t_2}) \\\\\n\\text{Cov}(X_{t_2}, X_{t_1}) & \\text{Cov}(X_{t_2}, X_{t_2})\n\\end{pmatrix} = \\begin{pmatrix}\n\\text{Var}(X_{t_1}) & \\text{Cov}(X_{t_1}, X_{t_2}) \\\\\n\\text{Cov}(X_{t_1}, X_{t_2}) & \\text{Var}(X_{t_2})\n\\end{pmatrix}\n$$\n两个随机变量 $U$ 和 $V$ 之间的协方差定义为 $\\text{Cov}(U, V) = E[UV] - E[U]E[V]$。\n\n首先，我们需要求出过程 $X_t$ 的期望值（均值）。利用期望的线性性质：\n$$\nE[X_t] = E[At + B] = E[A]t + E[B]\n$$\n题目说明 $A$ 和 $B$ 是标准正态随机变量，$A \\sim N(0, 1)$ 且 $B \\sim N(0, 1)$。因此，它们的期望值为 $E[A] = 0$ 和 $E[B] = 0$。\n$$\nE[X_t] = (0)t + 0 = 0\n$$\n该过程对于所有 $t$ 的均值为零。\n\n现在我们可以计算任意两个时间点 $s$ 和 $t$ 的通用协方差函数 $\\text{Cov}(X_s, X_t)$。\n$$\n\\text{Cov}(X_s, X_t) = E[X_s X_t] - E[X_s]E[X_t]\n$$\n由于 $E[X_s] = 0$ 且 $E[X_t] = 0$，协方差可简化为：\n$$\n\\text{Cov}(X_s, X_t) = E[X_s X_t]\n$$\n我们来计算这个期望：\n$$\nE[X_s X_t] = E[(As + B)(At + B)] = E[A^2 st + ABs + ABt + B^2]\n$$\n根据期望的线性性质，上式变为：\n$$\nE[X_s X_t] = st E[A^2] + (s+t)E[AB] + E[B^2]\n$$\n我们需要求出 $E[A^2]$、$E[B^2]$ 和 $E[AB]$。\n对于任意随机变量 $Z$，其方差由 $\\text{Var}(Z) = E[Z^2] - (E[Z])^2$ 给出。因为 $A$ 和 $B$ 是标准正态分布，所以 $\\text{Var}(A) = 1$，$E[A] = 0$，$\\text{Var}(B) = 1$ 且 $E[B] = 0$。\n对于 $A$：\n$1 = E[A^2] - (0)^2 \\implies E[A^2] = 1$。\n对于 $B$：\n$1 = E[B^2] - (0)^2 \\implies E[B^2] = 1$。\n题目还说明 $A$ 和 $B$ 是相互独立的。因此，它们乘积的期望等于它们期望的乘积：\n$E[AB] = E[A]E[B] = (0)(0) = 0$。\n\n将这些值代回协方差的表达式中：\n$$\n\\text{Cov}(X_s, X_t) = st(1) + (s+t)(0) + 1 = st + 1\n$$\n这就是过程 $X_t$ 的协方差函数。\n\n现在我们可以求出向量 $(X_{t_1}, X_{t_2})$ 的协方差矩阵的具体元素。\n对角线元素是方差：\n$\\boldsymbol{\\Sigma}_{11} = \\text{Var}(X_{t_1}) = \\text{Cov}(X_{t_1}, X_{t_1}) = t_1 t_1 + 1 = t_1^2 + 1$。\n$\\boldsymbol{\\Sigma}_{22} = \\text{Var}(X_{t_2}) = \\text{Cov}(X_{t_2}, X_{t_2}) = t_2 t_2 + 1 = t_2^2 + 1$。\n\n非对角线元素是协方差：\n$\\boldsymbol{\\Sigma}_{12} = \\boldsymbol{\\Sigma}_{21} = \\text{Cov}(X_{t_1}, X_{t_2}) = t_1 t_2 + 1$。\n\n将这些元素组合成协方差矩阵，得到：\n$$\n\\boldsymbol{\\Sigma} = \\begin{pmatrix}\nt_1^2 + 1 & t_1 t_2 + 1 \\\\\nt_1 t_2 + 1 & t_2^2 + 1\n\\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nt_1^2 + 1 & t_1 t_2 + 1 \\\\\nt_1 t_2 + 1 & t_2^2 + 1\n\\end{pmatrix}\n}\n$$", "id": "1304141"}, {"introduction": "在使用协方差矩阵定义了高斯过程之后，一个关键应用是进行预测。这个练习探讨了条件化的基本概念——即观测过程在某一点的值如何更新我们对它在另一点值的认知。计算条件方差是理解高斯过程预测不确定性的至关重要的第一步。[@problem_id:1304181]", "problem": "一个随机模型由一个零均值高斯过程 (GP) 描述。高斯过程是随机变量的集合，其中任意有限个随机变量都服从联合高斯（正态）分布。考虑从此过程中抽取的两个随机变量 $X_1$ 和 $X_2$。随机向量 $\\mathbf{X} = \\begin{pmatrix} X_1 \\\\ X_2 \\end{pmatrix}$ 服从一个多元正态分布，其均值向量为 $\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，协方差矩阵为：\n$$\n\\Sigma = \\begin{pmatrix} 4 & 1 \\\\ 1 & 2 \\end{pmatrix}\n$$\n假设观测到随机变量 $X_1$ 的值为 $x_1$。在此观测条件下，$X_2$ 的条件方差 $\\text{Var}(X_2 | X_1 = x_1)$ 是多少？请将您的答案表示为精确值。", "solution": "我们将 $\\mathbf{X} = \\begin{pmatrix} X_{1} \\\\ X_{2} \\end{pmatrix}$ 建模为联合高斯分布，其均值为 $\\mathbf{0}$，协方差矩阵为\n$$\n\\Sigma = \\begin{pmatrix} \\sigma_{11} & \\sigma_{12} \\\\ \\sigma_{21} & \\sigma_{22} \\end{pmatrix} = \\begin{pmatrix} 4 & 1 \\\\ 1 & 2 \\end{pmatrix}.\n$$\n对于二元正态分布，在给定 $X_{1}=x_{1}$ 的条件下，$X_{2}$ 的条件分布是高斯分布，其方差由舒尔补给出：\n$$\n\\operatorname{Var}(X_{2}\\mid X_{1}=x_{1}) = \\sigma_{22} - \\sigma_{21}\\sigma_{11}^{-1}\\sigma_{12}.\n$$\n代入 $\\Sigma$ 中的元素：$\\sigma_{11}=4$，$\\sigma_{22}=2$，且 $\\sigma_{12}=\\sigma_{21}=1$。因为这些都是标量，所以 $\\sigma_{11}^{-1}=\\frac{1}{4}$，因此\n$$\n\\operatorname{Var}(X_{2}\\mid X_{1}=x_{1}) = 2 - 1 \\cdot \\frac{1}{4} \\cdot 1 = 2 - \\frac{1}{4} = \\frac{7}{4}.\n$$\n该条件方差不依赖于 $x_{1}$。", "answer": "$$\\boxed{\\frac{7}{4}}$$", "id": "1304181"}, {"introduction": "高斯过程的实际应用依赖于选择一个合适的协方差函数，也称为核函数。这个实践问题将我们从抽象原理带到一个具体的例子中，使用广泛应用的Matérn核。通过为一组特定点计算协方差矩阵$K$，你将巩固对核函数如何转化为定义高斯过程行为的相关性的理解。[@problem_id:759044]", "problem": "高斯过程 (GP) 是一组随机变量的集合，其中任意有限个随机变量都具有联合高斯分布。一个高斯过程由其均值函数 $m(x)$ 和协方差函数（或核函数）$k(x, x')$ 完全确定。我们考虑一个均值函数为零 $m(x)=0$ 的一维高斯过程 $f(x) \\sim \\mathcal{GP}(m(x), k(x, x'))$。\n\n协方差由 Matérn 核函数族描述，该族核函数有一个参数 $\\nu > 0$，用于控制所得函数的光滑度。对于 $\\nu=1/2$ 的特殊情况，Matérn 核函数简化为指数核函数：\n$$\nk(x_i, x_j) = \\sigma^2 \\exp\\left(-\\frac{|x_i - x_j|}{\\ell}\\right)\n$$\n此处，$|x_i - x_j|$ 是点 $x_i$ 和 $x_j$ 之间的欧几里得距离，$\\ell > 0$ 是长度尺度参数，$\\sigma^2 > 0$ 是信号方差。\n\n考虑一组三个输入点 $X = \\{x_1, x_2, x_3\\} = \\{0, 1, 2\\}$。在这些点上的函数值 $\\mathbf{f} = [f(x_1), f(x_2), f(x_3)]^T$ 的先验分布是一个均值为零、协方差矩阵为 $3 \\times 3$ 矩阵 $K$ 的多元高斯分布。该矩阵的元素由 $K_{ij} = k(x_i, x_j)$ 给出。\n\n对于给定的输入点，推导先验协方差矩阵 $K$ 的行列式。请用参数 $\\sigma$ 和 $\\ell$ 表示结果。", "solution": "我们有点 $x_1=0,x_2=1,x_3=2$ 和核函数 \n$$k(x_i,x_j)=\\sigma^2\\exp\\!\\bigl(-|x_i-x_j|/\\ell\\bigr)\\,. $$ \n定义 \n$$a=\\exp\\!\\bigl(-1/\\ell\\bigr),\\quad a^2=\\exp\\!\\bigl(-2/\\ell\\bigr)\\,. $$\n那么协方差矩阵为\n$$K=\\sigma^2\n\\begin{pmatrix}\n1 & a & a^2\\\\\na & 1 & a\\\\\na^2 & a & 1\n\\end{pmatrix}\n=\\sigma^2A\\,. $$\n因此\n$$\\det K=\\sigma^6\\det A\\,. $$\n沿第一行展开计算 $\\det A$：\n\n$$\n\\det A\n=1\\cdot\\det\\begin{pmatrix}1&a\\\\a&1\\end{pmatrix}\n-a\\cdot\\det\\begin{pmatrix}a&a\\\\a^2&1\\end{pmatrix}\n+a^2\\cdot\\det\\begin{pmatrix}a&1\\\\a^2&a\\end{pmatrix}.\n$$\n\n计算每个子行列式：\n\n$$\n\\det\\begin{pmatrix}1&a\\\\a&1\\end{pmatrix}=1-a^2,\n\\quad\n\\det\\begin{pmatrix}a&a\\\\a^2&1\\end{pmatrix}=a - a^3,\n\\quad\n\\det\\begin{pmatrix}a&1\\\\a^2&a\\end{pmatrix}=a^2-a^2=0.\n$$\n\n因此\n\n$$\n\\det A=(1-a^2)-a(a-a^3)+a^2\\cdot0\n=1-a^2-a^2+a^4\n=(1-a^2)^2.\n$$\n\n代回原式：\n\n$$\n\\det K=\\sigma^6(1-a^2)^2\n=\\sigma^6\\bigl(1-e^{-2/\\ell}\\bigr)^2.\n$$", "answer": "$$\\boxed{\\sigma^6\\bigl(1-\\exp\\bigl(-\\tfrac{2}{\\ell}\\bigr)\\bigr)^2}$$", "id": "759044"}]}