{"hands_on_practices": [{"introduction": "大偏差理论的核心在于量化罕见事件的发生概率，而这通常通过计算“率函数” $I(x)$ 来实现。本练习将引导你处理一个最典型也是最基础的情景：独立同分布的正态随机变量样本均值的偏差。通过这个练习 [@problem_id:1309800]，你将实践应用克莱姆定理 (Cramér's theorem)，通过勒让德-芬切尔变换 (Legendre-Fenchel transform) 从累积量生成函数 (cumulant generating function) 中推导出率函数，这是掌握大偏差计算的入门关键一步。", "problem": "考虑一个随机变量序列 $X_1, X_2, \\dots, X_n$，它代表了对一个受随机噪声影响的物理系统的一系列测量。这些测量被假定为独立同分布 (i.i.d.)。每次测量 $X_i$ 均从标准正态分布中抽取，该分布的均值为 0，方差为 1。\n\n这些测量的样本均值定义为 $S_n = \\frac{1}{n} \\sum_{i=1}^{n} X_i$。根据大数定律，当 $n$ 变得非常大时，样本均值 $S_n$ 期望收敛到分布的真实均值，即 0。\n\n然而，样本均值显著偏离 0 的概率虽小但非零。大偏差原理提供了一个量化此概率指数衰减的框架。对于大的 $n$，样本均值接近某个值 $x \\neq 0$ 的概率可由以下关系近似：\n$$\nP(S_n \\approx x) \\approx \\exp(-n I(x))\n$$\n函数 $I(x)$ 被称为速率函数。它是非负的，且 $I(0)=0$，并且它衡量了观测到样本均值偏离到值 $x$ 的不可能性。你的任务是确定对于给定的独立同分布标准正态随机变量序列，该速率函数 $I(x)$ 的显式函数形式。\n\n你的最终答案应为 $I(x)$ 关于 $x$ 的表达式。", "solution": "我们已知独立同分布的 $X_{i} \\sim \\mathcal{N}(0,1)$ 和样本均值 $S_{n}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$。根据 Cramér 定理（或在光滑性条件下的 Gärtner-Ellis 定理），$S_{n}$ 的大偏差速率函数是单个 $X_{1}$ 的累积量生成函数的 Legendre–Fenchel 变换。\n\n首先计算 $X_{1}$ 的矩生成函数：\n$$\nM_{X}(t)=\\mathbb{E}[\\exp(tX_{1})]=\\int_{-\\infty}^{\\infty}\\exp(tx)\\,\\frac{1}{\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{x^{2}}{2}\\right)\\,dx.\n$$\n通过配方法合并指数项：\n$$\n-\\frac{x^{2}}{2}+tx=-\\frac{1}{2}\\left(x^{2}-2tx\\right)=-\\frac{1}{2}\\left[(x-t)^{2}-t^{2}\\right]=-\\frac{(x-t)^{2}}{2}+\\frac{t^{2}}{2}.\n$$\n因此\n$$\nM_{X}(t)=\\exp\\!\\left(\\frac{t^{2}}{2}\\right)\\int_{-\\infty}^{\\infty}\\frac{1}{\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{(x-t)^{2}}{2}\\right)\\,dx=\\exp\\!\\left(\\frac{t^{2}}{2}\\right).\n$$\n所以累积量生成函数是\n$$\n\\Lambda(t)=\\ln M_{X}(t)=\\frac{t^{2}}{2}, \\quad t\\in\\mathbb{R}.\n$$\n根据 Cramér 定理，$S_{n}$ 的优良速率函数是 $\\Lambda$ 的 Legendre–Fenchel 变换：\n$$\nI(x)=\\sup_{t\\in\\mathbb{R}}\\{tx-\\Lambda(t)\\}=\\sup_{t\\in\\mathbb{R}}\\left\\{tx-\\frac{t^{2}}{2}\\right\\}.\n$$\n为求关于 $t$ 的凹二次函数的最大值，对其求关于 $t$ 的导数并令其为零：\n$$\n\\frac{d}{dt}\\left(tx-\\frac{t^{2}}{2}\\right)=x-t=0 \\quad \\Rightarrow \\quad t=x.\n$$\n在 $t=x$ 处求值得到\n$$\nI(x)=x\\cdot x-\\frac{x^{2}}{2}=\\frac{x^{2}}{2}.\n$$\n此 $I(x)$ 是非负的，并满足 $I(0)=0$，符合要求。", "answer": "$$\\boxed{\\frac{x^{2}}{2}}$$", "id": "1309800"}, {"introduction": "在掌握了理想化的正态分布案例后，让我们将大偏差理论应用于一个更具现实意义的模型——指数分布，它常被用来描述电子元件的寿命或事件的等待时间。这个练习 [@problem_id:1309802] 要求你计算一组独立同分布的指数随机变量的样本均值发生显著偏离的概率衰减率。这不仅能巩固你对勒让德-芬切尔变换的运用，还能让你体会到不同概率分布如何导致形态各异的率函数，从而反映出不同系统中发生偏差的“成本”。", "problem": "一家公司生产一种特殊类型的电子电容器。每个电容器的失效时间（以小时为单位）是一个随机变量。大量此类电容器（数量为 $n$）被用于一个新的高可靠性服务器集群中。这些电容器的寿命，记作 $X_1, X_2, \\ldots, X_n$，被建模为独立同分布 (IID) 的指数随机变量，其率参数为 $\\lambda > 0$。单个电容器寿命 $X_i$ 的概率密度函数由 $f(x) = \\lambda \\exp(-\\lambda x)$ 给出，其中 $x \\ge 0$。\n\n该服务器集群的可靠性通过观察组件寿命的样本均值 $M_n = \\frac{1}{n} \\sum_{i=1}^{n} X_i$ 来评估。大偏差理论指出，对于非常大的 $n$，样本均值 $M_n$ 偏离其期望值的概率可以近似为 $P(M_n \\leq a) \\approx \\exp(-n \\cdot I(a))$，其中 $a$ 的值小于真实均值。函数 $I(a)$ 被称为大偏差率函数，它衡量了该概率的指数衰减速率。\n\n如果观测到的电容器样本均值寿命小于或等于其理论期望寿命的一半，则宣告存在重大的系统性风险。计算在这种特定风险情景下率函数 $I(a)$ 的值。你的最终答案应该是一个不依赖于参数 $\\lambda$ 的闭式解析表达式。", "solution": "设 $X$ 是一个率参数为 $\\lambda>0$ 的指数随机变量，因此其概率密度函数为 $f(x)=\\lambda \\exp(-\\lambda x)$，其中 $x\\ge 0$。其矩生成函数（对于 $t<\\lambda$）为\n$$\nM_{X}(t)=\\mathbb{E}[\\exp(tX)]=\\int_{0}^{\\infty}\\lambda \\exp\\big(-( \\lambda - t )x\\big)\\,dx=\\frac{\\lambda}{\\lambda - t},\n$$\n因此，累积量生成函数为\n$$\n\\Lambda(t)=\\ln M_{X}(t)=\\ln \\lambda - \\ln(\\lambda - t).\n$$\n根据 Cramér 定理，样本均值的大偏差率函数是 Legendre-Fenchel 变换\n$$\nI(a)=\\sup_{t<\\lambda}\\{t a - \\Lambda(t)\\}.\n$$\n为求最大值点，我们对括号内的表达式求导并令其为零：\n$$\n\\frac{d}{dt}\\big[t a - \\Lambda(t)\\big] = a - \\Lambda'(t) = a - \\frac{1}{\\lambda - t}.\n$$\n令其为零，得到 $a=\\frac{1}{\\lambda - t}$，因此最大值点是 $t^{\\star}=\\lambda - \\frac{1}{a}$。将 $t^{\\star}$ 代回，\n$$\n\\Lambda(t^{\\star})=\\ln \\lambda - \\ln\\!\\big(\\lambda - t^{\\star}\\big)=\\ln \\lambda - \\ln\\!\\Big(\\frac{1}{a}\\Big)=\\ln(\\lambda a),\n$$\n于是\n$$\nI(a)=t^{\\star}a-\\Lambda(t^{\\star})=\\Big(\\lambda - \\frac{1}{a}\\Big)a - \\ln(\\lambda a)=\\lambda a - 1 - \\ln(\\lambda a).\n$$\n在给定的风险情景中，$a$ 是平均寿命的一半。由于 $\\mathbb{E}[X]=\\frac{1}{\\lambda}$，我们有\n$$\na=\\frac{1}{2}\\mathbb{E}[X]=\\frac{1}{2\\lambda},\n$$\n所以 $\\lambda a=\\frac{1}{2}$，因此\n$$\nI(a)=\\frac{1}{2}-1-\\ln\\!\\Big(\\frac{1}{2}\\Big)=-\\frac{1}{2}+\\ln 2.\n$$\n该表达式不依赖于 $\\lambda$，符合要求。", "answer": "$$\\boxed{\\ln 2 - \\frac{1}{2}}$$", "id": "1309802"}, {"introduction": "理论的价值最终体现在其应用上。在推导出抽象的率函数 $I(x)$ 之后，一个自然的问题是如何利用它来估算一个具体罕见事件的概率。本练习 [@problem_id:1309801] 将带你使用切诺夫界 (Chernoff bound)——大偏差原理的一个直接而有力的推论——来为一个泊松分布的实际场景计算概率上限。通过这个实践，你将学习如何将理论转化为具体的数值估计，这在风险评估和系统可靠性分析等领域至关重要。", "problem": "一个研究设施运行着一个由$n$个独立同分布的粒子探测器组成的大型阵列，用于监测背景辐射。在给定的时间间隔内，第$i$个探测器探测到的粒子数$X_i$可以很好地用一个均值为$\\lambda$的泊松随机变量来建模。所有探测器探测到的粒子的样本均值为 $S_n = \\frac{1}{n} \\sum_{i=1}^{n} X_i$。\n\n研究团队对观测到全系统范围内的波动感兴趣，即探测到的平均粒子数显著超过期望值。使用切诺夫界方法，计算样本均值至少为单个探测器期望值的两倍的概率上限。\n\n假设阵列由$n=50$个探测器组成，任何单个探测器的期望计数为$\\lambda=3$，样本均值的指定阈值为$a=2\\lambda$。\n\n计算概率 $P(S_n \\ge a)$ 的上限。将你的答案表示为一个四舍五入到三位有效数字的数值。", "solution": "我们有独立同分布的 $X_{i} \\sim \\text{Poisson}(\\lambda)$，样本均值为 $S_{n} = \\frac{1}{n} \\sum_{i=1}^{n} X_{i}$。我们需要求 $P(S_{n} \\ge a)$ 的一个上界，其中 $a = 2\\lambda$。\n\n根据切诺夫界，对于任意 $t > 0$，\n$$\nP\\!\\left(S_{n} \\ge a\\right) \\;=\\; P\\!\\left(\\sum_{i=1}^{n} X_{i} \\ge n a\\right) \\;\\le\\; \\exp(-t n a)\\, \\mathbb{E}\\!\\left[\\exp\\!\\left(t \\sum_{i=1}^{n} X_{i}\\right)\\right].\n$$\n利用独立性，\n$$\n\\mathbb{E}\\!\\left[\\exp\\!\\left(t \\sum_{i=1}^{n} X_{i}\\right)\\right] \\;=\\; \\prod_{i=1}^{n} \\mathbb{E}\\!\\left[\\exp(t X_{i})\\right] \\;=\\; \\left(M_{X}(t)\\right)^{n},\n$$\n其中 $M_{X}(t)$ 是 $X_{i}$ 的矩生成函数。对于 $X \\sim \\text{Poisson}(\\lambda)$，\n$$\nM_{X}(t) \\;=\\; \\exp\\!\\left(\\lambda\\left(\\exp(t) - 1\\right)\\right).\n$$\n因此，\n$$\nP\\!\\left(S_{n} \\ge a\\right) \\;\\le\\; \\exp\\!\\left(-t n a + n \\lambda \\left(\\exp(t) - 1\\right)\\right).\n$$\n为了收紧这个界，我们需要在 $t>0$ 上最小化指数部分。定义\n$$\n\\phi(t) \\;=\\; -t a + \\lambda \\left(\\exp(t) - 1\\right).\n$$\n那么\n$$\n\\phi'(t) \\;=\\; -a + \\lambda \\exp(t).\n$$\n令 $\\phi'(t)=0$ 以求得最优的 $t^{\\ast}$：\n$$\n\\lambda \\exp(t^{\\ast}) \\;=\\; a \\;\\;\\Rightarrow\\;\\; \\exp(t^{\\ast}) \\;=\\; \\frac{a}{\\lambda}, \\quad t^{\\ast} \\;=\\; \\ln\\!\\left(\\frac{a}{\\lambda}\\right).\n$$\n代入 $t^{\\ast}$ 可得\n$$\nP\\!\\left(S_{n} \\ge a\\right) \\;\\le\\; \\exp\\!\\left(n\\left[-a \\ln\\!\\left(\\frac{a}{\\lambda}\\right) + \\lambda\\!\\left(\\frac{a}{\\lambda} - 1\\right)\\right]\\right)\n\\;=\\; \\exp\\!\\left(-n\\left[a \\ln\\!\\left(\\frac{a}{\\lambda}\\right) - a + \\lambda\\right]\\right).\n$$\n当 $a = 2\\lambda$ 时，上式简化为\n$$\nP\\!\\left(S_{n} \\ge 2\\lambda\\right) \\;\\le\\; \\exp\\!\\left(-n\\left[2\\lambda \\ln 2 - \\lambda\\right]\\right) \\;=\\; \\exp\\!\\left(n \\lambda \\left(1 - 2 \\ln 2\\right)\\right).\n$$\n现在代入 $n=50$ 和 $\\lambda=3$：\n$$\nP\\!\\left(S_{n} \\ge 2\\lambda\\right) \\;\\le\\; \\exp\\!\\left(150\\left(1 - 2 \\ln 2\\right)\\right).\n$$\n数值上，$1 - 2 \\ln 2 \\approx -0.386294361$，因此指数约为 $-57.944154$，并且\n$$\nP\\!\\left(S_{n} \\ge 2\\lambda\\right) \\;\\lesssim\\; \\exp(-57.944154) \\;\\approx\\; 6.84 \\times 10^{-26}.\n$$\n四舍五入到三位有效数字，切诺夫上界为 $6.84 \\times 10^{-26}$。", "answer": "$$\\boxed{6.84 \\times 10^{-26}}$$", "id": "1309801"}]}