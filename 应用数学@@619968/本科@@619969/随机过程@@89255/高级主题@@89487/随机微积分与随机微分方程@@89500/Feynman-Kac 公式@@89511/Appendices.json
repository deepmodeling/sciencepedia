{"hands_on_practices": [{"introduction": "在理论学习之后，让我们通过一个直观的例子来感受费曼-卡茨公式的威力。这个练习 [@problem_id:1338001] 提出了一个经典问题：一个在环形区域内进行布朗运动的粒子，会先碰到内边界还是外边界？这个问题本质上是在计算一个“命中概率”，而费曼-卡茨公式的基本思想告诉我们，这个概率恰好满足一个简单的偏微分方程——拉普拉斯方程。通过求解这个方程，我们能将一个复杂的随机过程问题转化为一个经典的静电学或热传导问题。", "problem": "一个金吸附原子在绝对平坦的银表面上扩散。使用先进的操纵技术，构建了两个同心圆壁垒，形成一个环形区域，该吸附原子被暂时限制在其中。内壁垒的半径为 $R_1$，外壁垒的半径为 $R_2$，且 $R_1 < R_2$。该吸附原子在表面上的运动可以很好地用标准的二维布朗运动来描述。\n\n这些壁垒并非是完美的；它们可以被穿过。一旦吸附原子的路径与内或外圆形壁垒中的任意一个相交，该过程即停止。假设该吸附原子初始时被放置在离圆心径向距离为 $r_0$ 的位置，满足 $R_1 < r_0 < R_2$。由于问题的对称性，我们所关心的概率将不依赖于具体的角位置，而只依赖于初始径向距离 $r_0$。\n\n确定吸附原子在穿过半径为 $R_1$ 的内壁垒之前，先穿过半径为 $R_2$ 的外壁垒的概率，我们将其记为 $P(r_0)$。你的最终答案应该是一个用 $r_0$、$R_1$ 和 $R_2$ 表示的闭式解析表达式。", "solution": "设 $X_{t}$ 为平面上的标准二维布朗运动，从径向坐标为 $r_{0}$ 的一点开始，满足 $R_{1}<r_{0}<R_{2}$。定义环形区域 $A=\\{x\\in\\mathbb{R}^{2}:R_{1}<|x|<R_{2}\\}$。设 $P(x)$ 表示从 $x\\in A$ 开始，该过程在碰到内圆 $\\{|x|=R_{1}\\}$ 之前先碰到外圆 $\\{|x|=R_{2}\\}$ 的概率。根据旋转对称性，$P(x)$ 仅依赖于半径 $r=|x|$，因此我们将其写作 $P(r)$。\n\n对于布朗运动，触碰边界某部分的概率函数是拉普拉斯算子的狄利克雷问题的解。因此 $P(r)$ 在环形区域内是调和函数，并满足对应于吸收壁垒的边界条件：\n$$\n\\Delta P=0\\quad\\text{in }A,\\qquad P(R_{1})=0,\\qquad P(R_{2})=1.\n$$\n在极坐标中，对于径向对称函数 $P(r)$，拉普拉斯算子简化为\n$$\n\\Delta P=P_{rr}+\\frac{1}{r}P_{r}.\n$$\n因此，$P(r)$ 是以下常微分方程的解\n$$\nP''(r)+\\frac{1}{r}P'(r)=0,\\quad R_{1}<r<R_{2},\n$$\n边界条件为\n$$\nP(R_{1})=0,\\qquad P(R_{2})=1.\n$$\n为求解该常微分方程，令 $v(r)=P'(r)$，得到\n$$\nv'(r)+\\frac{1}{r}v(r)=0.\n$$\n这是一个一阶线性方程。两边乘以 $r$ 得到\n$$\n\\frac{d}{dr}\\big(r\\,v(r)\\big)=0\\quad\\Rightarrow\\quad r\\,v(r)=C_{1}\\quad\\Rightarrow\\quad P'(r)=\\frac{C_{1}}{r}.\n$$\n积分可得，\n$$\nP(r)=C_{1}\\ln r+C_{2}.\n$$\n应用边界条件：\n$$\nP(R_{1})=C_{1}\\ln R_{1}+C_{2}=0,\\qquad P(R_{2})=C_{1}\\ln R_{2}+C_{2}=1.\n$$\n第二个方程减去第一个方程，得到\n$$\nC_{1}\\big(\\ln R_{2}-\\ln R_{1}\\big)=1\\quad\\Rightarrow\\quad C_{1}=\\frac{1}{\\ln\\!\\big(\\frac{R_{2}}{R_{1}}\\big)}.\n$$\n于是\n$$\nC_{2}=-C_{1}\\ln R_{1}=-\\frac{\\ln R_{1}}{\\ln\\!\\big(\\frac{R_{2}}{R_{1}}\\big)}.\n$$\n因此，对于任意 $R_{1}<r<R_{2}$，\n$$\nP(r)=\\frac{\\ln r-\\ln R_{1}}{\\ln R_{2}-\\ln R_{1}}=\\frac{\\ln\\!\\big(\\frac{r}{R_{1}}\\big)}{\\ln\\!\\big(\\frac{R_{2}}{R_{1}}\\big)}.\n$$\n在初始半径 $r_{0}$ 处取值，所求的概率为\n$$\nP(r_{0})=\\frac{\\ln\\!\\big(\\frac{r_{0}}{R_{1}}\\big)}{\\ln\\!\\big(\\frac{R_{2}}{R_{1}}\\big)}.\n$$", "answer": "$$\\boxed{\\frac{\\ln\\!\\left(\\frac{r_{0}}{R_{1}}\\right)}{\\ln\\!\\left(\\frac{R_{2}}{R_{1}}\\right)}}$$", "id": "1338001"}, {"introduction": "现在，我们从计算单个事件的概率转向评估一个在时间上持续累积的价值。这个练习 [@problem_id:1337995] 模拟了一个在金融中常见的情景：如何计算一个价格随机波动的资产在未来产生的连续现金流的期望现值。这个问题引入了“运行成本”（或收益）和“贴现率”的概念，是费曼-卡茨公式更完整的体现。通过解决它，你将学会如何处理包含积分项的期望值，并看到它如何对应于一个带有非齐次项的偏微分方程。", "problem": "一个资产的价格在时间 $s$ 时记为 $X_s$，其被建模为标准的一维布朗运动。其演化由随机微分方程 $dX_s = dW_s$ 描述，其中 $W_s$ 是一个标准维纳过程。该资产的初始价格为 $X_0 = x$。\n\n该资产产生一串连续的支付流。在任意时刻 $s \\ge 0$，瞬时支付率由资产价格的平方给出，即支付率为 $f(X_s) = X_s^2$。\n\n一位投资者希望计算该资产在无限时间范围内所有未来支付的总现值。未来的支付以一个恒定的无风险利率 $r > 0$ 进行连续贴现。\n\n确定这个无限支付流的期望总贴现值，将其表示为初始价格 $x$ 和贴现率 $r$ 的函数。", "solution": "设 $X_{s}$ 是一个从 $X_{0}=x$ 开始的标准布朗运动，因此 $dX_{s}=dW_{s}$ 且 $X_{s}=x+W_{s}$。持续收益 $f(X_{s})=X_{s}^{2}$ 的总贴现值为\n$$\nV(x)=\\mathbb{E}_{x}\\left[\\int_{0}^{\\infty} \\exp(-r s)\\,X_{s}^{2}\\,ds\\right], \\quad r>0.\n$$\n由于 $X_{s}^{2}\\ge 0$，根据 Tonelli 定理，可以交换期望和积分的顺序：\n$$\nV(x)=\\int_{0}^{\\infty} \\exp(-r s)\\,\\mathbb{E}_{x}[X_{s}^{2}]\\,ds.\n$$\n因为 $X_{s}=x+W_{s}$，且 $\\mathbb{E}[W_{s}]=0$ 和 $\\mathrm{Var}(W_{s})=s$，我们有\n$$\n\\mathbb{E}_{x}[X_{s}^{2}]=\\mathrm{Var}(X_{s})+\\left(\\mathbb{E}_{x}[X_{s}]\\right)^{2}=s+x^{2}.\n$$\n因此\n$$\nV(x)=\\int_{0}^{\\infty} \\exp(-r s)\\,(x^{2}+s)\\,ds\n= x^{2}\\int_{0}^{\\infty} \\exp(-r s)\\,ds + \\int_{0}^{\\infty} s\\,\\exp(-r s)\\,ds.\n$$\n对于 $r>0$，\n$$\n\\int_{0}^{\\infty} \\exp(-r s)\\,ds=\\frac{1}{r}.\n$$\n对于第二个积分，使用分部积分法，设 $u=s$ 和 $dv=\\exp(-r s)\\,ds$，则 $du=ds$ 和 $v=-(1/r)\\exp(-r s)$：\n$$\n\\int_{0}^{\\infty} s\\,\\exp(-r s)\\,ds=\\left.-\\frac{s}{r}\\exp(-r s)\\right|_{0}^{\\infty}+\\frac{1}{r}\\int_{0}^{\\infty}\\exp(-r s)\\,ds\n=0+\\frac{1}{r}\\cdot\\frac{1}{r}=\\frac{1}{r^{2}}.\n$$\n因此，\n$$\nV(x)=\\frac{x^{2}}{r}+\\frac{1}{r^{2}}.\n$$\n作为通过 Feynman–Kac 公式的交叉检验，$v(x)=V(x)$ 是常微分方程 $(r-\\mathcal{L})v=x^{2}$ 的解，其生成元为 $\\mathcal{L}=\\frac{1}{2}\\frac{d^{2}}{dx^{2}}$，即\n$$\nr v(x)-\\frac{1}{2}v''(x)=x^{2}.\n$$\n一个特解 $v_{p}(x)=a x^{2}+b$ 代入后得到 $r(ax^2+b) - a = x^2$。比较系数解得 $a=\\frac{1}{r}$ 且 $b=\\frac{1}{r^{2}}$。齐次解 $\\exp(\\pm\\sqrt{2r}\\,x)$ 因最多为多项式增长的要求而被排除，从而证实了 $v(x)=\\frac{x^{2}}{r}+\\frac{1}{r^{2}}$。", "answer": "$$\\boxed{\\frac{x^{2}}{r}+\\frac{1}{r^{2}}}$$", "id": "1337995"}, {"introduction": "在前面的实践中，我们应用了费曼-卡茨公式将期望值问题转化为偏微分方程问题。但这个神奇的对应关系究竟从何而来？这个练习 [@problem_id:1337980] 将带你深入核心，亲自推导这个联系。你将从一个二维耦合随机微分方程（SDE）系统出发，利用伊藤引理（Itô's lemma）推导期望值所满足的向后偏微分方程。完成这个练习后，你将深刻理解随机过程的漂移项和扩散项是如何直接“翻译”成偏微分方程中的相应系数的。", "problem": "在一个积分随机信号模型中，系统的状态由一个二维过程 $(X_t, Y_t)$ 描述。量 $X_t$ 表示一个其值进行随机游走的信号，而 $Y_t$ 表示该信号的时间积分值。其动力学由以下耦合随机微分方程（SDEs）系统控制，其中 $t \\ge 0$：\n$$ dX_t = \\sigma dW_t $$\n$$ dY_t = X_t dt $$\n此处，$W_t$ 是一个标准一维维纳过程，$\\sigma$ 是一个表示信号波动率的正常数。\n\n令 $u(t, x, y)$ 为在未来某个终端时刻 $T > t$ 评估的代价函数 $g(X_T, Y_T)$ 的期望值，条件是在时刻 $t$ 系统的状态为 $(X_t, Y_t) = (x, y)$。即，\n$$ u(t, x, y) = \\mathbb{E}\\left[g(X_T, Y_T) | X_t = x, Y_t = y\\right] $$\n其中 $g$ 是一个足够光滑的函数。\n\n函数 $u(t, x, y)$ 满足一个对于 $t < T$ 的倒向抛物型偏微分方程（PDE），其一般形式为：\n$$ A \\frac{\\partial u}{\\partial t} + B \\frac{\\partial u}{\\partial x} + C \\frac{\\partial u}{\\partial y} + D \\frac{\\partial^2 u}{\\partial x^2} + E \\frac{\\partial^2 u}{\\partial y^2} + F \\frac{\\partial^2 u}{\\partial x \\partial y} = 0 $$\n系数 $A, B, C, D, E, F$ 可以是常数或状态变量 $x$ 和 $y$ 的函数。\n\n确定该PDE中的六个系数。请按 $(A, B, C, D, E, F)$ 的顺序将答案表示为一个单行矩阵。", "solution": "我们用SDEs $dX_{t}=\\sigma dW_{t}$ 和 $dY_{t}=X_{t} dt$ 来为二维马尔可夫过程 $(X_{t}, Y_{t})$ 建模。设 $u(t,x,y)=\\mathbb{E}\\left[g(X_{T},Y_{T}) \\mid X_{t}=x, Y_{t}=y\\right]$，其中 $g$ 是一个光滑的终端函数。根据倒向Kolmogorov方程，对于 $t<T$，$u$ 满足 $\\partial_{t}u + \\mathcal{L}u=0$，其中 $\\mathcal{L}$ 是作用于光滑检验函数 $f$ 的 $(X_{t},Y_{t})$ 的无穷小生成元。\n\n为了计算 $\\mathcal{L}$，注意其漂移和扩散结构：\n- 对于 $X_{t}$：漂移为 $0$，扩散系数为 $\\sigma$，因此有 $(dX_{t})^{2}=\\sigma^{2} dt$。\n- 对于 $Y_{t}$：漂移为 $X_{t}$，无扩散项，因此在It\\^o微积分中，$(dY_{t})^{2}=0$ 且 $dX_{t}\\,dY_{t}=0$，因为 $dY_{t}$ 是 $dt$ 阶的。\n\n对 $u(t,X_{t},Y_{t})$ 应用It\\^o公式可得\n$$\ndu = u_{t}\\,dt + u_{x}\\,dX_{t} + u_{y}\\,dY_{t} + \\frac{1}{2}u_{xx}\\,(dX_{t})^{2} + \\frac{1}{2}u_{yy}\\,(dY_{t})^{2} + u_{xy}\\,dX_{t}\\,dY_{t}.\n$$\n将 $dX_{t}=\\sigma dW_{t}$ 和 $dY_{t}=X_{t} dt$ 代入可得\n$$\ndu = \\left(u_{t} + X_{t} u_{y} + \\frac{1}{2}\\sigma^{2} u_{xx}\\right) dt + \\sigma u_{x}\\,dW_{t},\n$$\n因为 $(dY_{t})^{2}=0$ 且 $dX_{t}\\,dY_{t}=0$。由于在条件期望表示下 $u(t,X_{t},Y_{t})$ 是一个鞅，其漂移项必须为零，这给出了倒向PDE\n$$\nu_{t} + x\\,u_{y} + \\frac{1}{2}\\sigma^{2} u_{xx} = 0,\n$$\n其终端条件为 $u(T,x,y)=g(x,y)$。将此式与给定的一般形式\n$$\nA\\,u_{t} + B\\,u_{x} + C\\,u_{y} + D\\,u_{xx} + E\\,u_{yy} + F\\,u_{xy} = 0,\n$$\n匹配，我们确定系数为\n$$\nA=1,\\quad B=0,\\quad C=x,\\quad D=\\frac{1}{2}\\sigma^{2},\\quad E=0,\\quad F=0.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}1 & 0 & x & \\frac{1}{2}\\sigma^{2} & 0 & 0\\end{pmatrix}}$$", "id": "1337980"}]}