{"hands_on_practices": [{"introduction": "构建任何连续时间随机模型的基础是定义所有可能改变系统状态的事件及其对应的发生速率。这个练习将指导你为一个包含人口出生和死亡过程的综合性易感-感染-易感（$SIS$）模型识别所有可能的转变事件。通过解决这个问题 [@problem_id:1281962]，你将练习如何将生物学过程（如感染、恢复、出生和死亡）转化为精确的数学速率，这是任何模型构建工作中的关键第一步。", "problem": "一位野生动物生物学家正在研究一种在孤立的两栖动物种群中传播的非致命性疾病。该疾病的动态过程采用随机易感-感染-易感（SIS）模型进行建模，该模型也考虑了种群的动态变化。在此模型中，个体可以处于两种状态之一：易感（S）或感染（I）。感染者可以康复并再次变为易感者，因为该疾病不会产生免疫力。\n\n系统在任意时刻 $t$ 的状态由一对整数 $(I(t), N(t))$ 描述，其中 $I(t)$ 是感染者数量，$N(t)$ 是总种群数量。因此，易感者数量为 $S(t) = N(t) - I(t)$。\n\n种群动态由以下连续时间随机过程决定：\n1.  **出生**：新个体以恒定速率 $\\Lambda$ 出生，且均为易感者。\n2.  **死亡**：所有个体，无论是易感者还是感染者，其个体自然死亡率均为 $\\mu$。\n3.  **感染**：易感者通过与感染者接触而成为感染者。新感染的总速率由 $\\beta S(t) I(t)$ 给出，其中 $\\beta$ 是传播系数。\n4.  **恢复**：感染者以个体速率 $\\gamma$ 恢复并变为易感者。\n\n假设在某一特定时刻，种群处于状态 $(I, N) = (i_0, n_0)$，其中 $i_0$ 和 $n_0$ 是满足 $0  i_0  n_0$ 的整数。\n\n确定系统从该状态 $(i_0, n_0)$ 转移出去的总瞬时速率。请用参数 $\\Lambda, \\mu, \\beta, \\gamma$ 和状态变量 $n_0, i_0$ 将您的答案表示为单个解析表达式。", "solution": "对于此连续时间马尔可夫链的任意状态 $(i_{0}, n_{0})$，离开该状态的总瞬时速率等于所有可能改变状态的事件的速率之和。在状态 $(i_{0}, n_{0})$ 下，这些事件及其总速率如下。\n\n出生以恒定速率发生，对离开率的贡献为 $\\Lambda$。\n\n自然死亡对所有个体独立发生，个体死亡率为 $\\mu$，因此对于 $n_{0}$ 个个体，总死亡速率为 $\\mu n_{0}$。\n\n感染以总速率 $\\beta S I$ 发生，其中 $S=n_{0}-i_{0}$ 且 $I=i_{0}$，贡献为 $\\beta (n_{0}-i_{0}) i_{0}$。\n\n恢复在感染者中以个体速率 $\\gamma$ 发生，因此对于 $i_{0}$ 个感染者，总恢复速率为 $\\gamma i_{0}$。\n\n将这些独立的转移速率相加，得到离开状态 $(i_{0}, n_{0})$ 的总速率：\n$$\\Lambda + \\mu n_{0} + \\beta (n_{0} - i_{0}) i_{0} + \\gamma i_{0}.$$", "answer": "$$\\boxed{\\Lambda + \\mu n_{0} + \\beta \\left(n_{0} - i_{0}\\right) i_{0} + \\gamma i_{0}}$$", "id": "1281962"}, {"introduction": "现实世界中的人口并非总是“充分混合”的，个体间的接触模式会显著影响疾病的传播。这个练习 [@problem_id:1281964] 挑战了标准的“充分混合”假设，将个体放置在一个简单的线性网络上，感染只能在相邻的个体之间发生。通过计算整个种群被感染所需的期望时间，你将学习如何分析网络上的随机动态，并体会到种群结构是如何从根本上改变疾病传播过程的。", "problem": "考虑一个小型社区，有四个人生活在一个与世隔绝的研究站中，他们排成一列。我们根据他们的位置将这四个人标记为 1、2、3 和 4。一种新型持续性病毒在该社区内的传播采用易感-感染 (SI) 模型进行建模。在此模型中，个体要么对病毒易感，要么具有传染性。一旦个体变得具有传染性，他们将无限期地保持在该状态。\n\n病毒通过直接接触传播，但由于研究站的布局，个体只能将疾病传染给其直接相邻的人。例如，个体 2 可以感染个体 1 和 3，但不能感染个体 4。位于队列两端的个体（1 和 4）各只有一个邻居。\n\n病毒的传播是一个随机过程。某个传染性个体感染一个相邻的易感邻居所需的时间是一个指数随机变量。任何此类传播事件的速率参数为 $\\beta = 0.25 \\text{ per day}$。\n\n在时间 $t=0$ 时，个体 2 变为传染性，而个体 1、3 和 4 均为易感者。\n\n计算整个四人种群全部变为传染性所需的期望时间（以天为单位）。将您的最终答案四舍五入到两位有效数字。", "solution": "我们使用具有指数感染时间的 SI 动力学，将传播建模为感染构型集合上的连续时间马尔可夫链。对于任何状态，到下一次感染的时间是指数分布的，其速率等于所有易感-感染 (S-I) 边的速率之和，而下一次感染沿特定 S-I 边发生的概率等于该边的速率除以总速率。到下一个事件的期望等待时间是总速率的倒数。在进行最终的数值代入之前，我们保持传播速率为一个符号常数 $\\beta$。\n\n用 $E(\\cdot)$ 标记从一个状态到完全感染的期望时间。起始状态为 $\\{2\\}$。可达状态（不考虑对称性）有：\n- $\\{2\\}$,\n- $\\{1,2\\}$,\n- $\\{2,3\\}$,\n- $\\{1,2,3\\}$,\n- $\\{2,3,4\\}$,\n- $\\{1,2,3,4\\}$（吸收态，期望为零）。\n\n我们使用上述原理为期望值编写递归方程：\n\n从状态 $\\{2\\}$ 出发，有两条 S-I 边，$(1,2)$ 和 $(2,3)$，因此总速率为 $2\\beta$，期望等待时间为 $1/(2\\beta)$，下一个状态是 $\\{1,2\\}$ 或 $\\{2,3\\}$ 的概率各为 $1/2$：\n$$\nE(\\{2\\}) \\;=\\; \\frac{1}{2\\beta} \\;+\\; \\frac{1}{2}E(\\{1,2\\}) \\;+\\; \\frac{1}{2}E(\\{2,3\\}).\n$$\n\n从状态 $\\{1,2\\}$ 出发，只有一条 S-I 边 $(2,3)$，因此：\n$$\nE(\\{1,2\\}) \\;=\\; \\frac{1}{\\beta} \\;+\\; E(\\{1,2,3\\}).\n$$\n\n从状态 $\\{2,3\\}$ 出发，有两条 S-I 边，$(1,2)$ 和 $(3,4)$，因此：\n$$\nE(\\{2,3\\}) \\;=\\; \\frac{1}{2\\beta} \\;+\\; \\frac{1}{2}E(\\{1,2,3\\}) \\;+\\; \\frac{1}{2}E(\\{2,3,4\\}).\n$$\n\n从状态 $\\{1,2,3\\}$ 和 $\\{2,3,4\\}$ 出发，都只有一条 S-I 边来感染剩下的易感者（分别为 $(3,4)$ 和 $(1,2)$），而吸收态 $\\{1,2,3,4\\}$ 的剩余时间为零：\n$$\nE(\\{1,2,3\\}) \\;=\\; \\frac{1}{\\beta} \\;+\\; E(\\{1,2,3,4\\}) \\;=\\; \\frac{1}{\\beta},\n$$\n$$\nE(\\{2,3,4\\}) \\;=\\; \\frac{1}{\\beta} \\;+\\; E(\\{1,2,3,4\\}) \\;=\\; \\frac{1}{\\beta}.\n$$\n\n回代：\n$$\nE(\\{1,2\\}) \\;=\\; \\frac{1}{\\beta} \\;+\\; \\frac{1}{\\beta} \\;=\\; \\frac{2}{\\beta},\n$$\n$$\nE(\\{2,3\\}) \\;=\\; \\frac{1}{2\\beta} \\;+\\; \\frac{1}{2}\\cdot\\frac{1}{\\beta} \\;+\\; \\frac{1}{2}\\cdot\\frac{1}{\\beta} \\;=\\; \\frac{3}{2\\beta}.\n$$\n\n因此，\n$$\nE(\\{2\\}) \\;=\\; \\frac{1}{2\\beta} \\;+\\; \\frac{1}{2}\\cdot\\frac{2}{\\beta} \\;+\\; \\frac{1}{2}\\cdot\\frac{3}{2\\beta}\n\\;=\\; \\frac{9}{4\\beta}.\n$$\n\n当 $\\beta = 0.25 \\text{ per day} = \\frac{1}{4} \\text{ per day}$ 时，我们得到\n$$\nE(\\{2\\}) \\;=\\; \\frac{9}{4\\cdot \\frac{1}{4}} \\;=\\; 9 \\text{ days}.\n$$\n\n四舍五入到两位有效数字，期望时间为 $9.0$。", "answer": "$$\\boxed{9.0}$$", "id": "1281964"}, {"introduction": "随机模型的一个核心特征是其结果并非预先确定，而是具有内在的随机性。这个练习 [@problem_id:1281955] 旨在探索这种不确定性，要求你计算在一个小型孤立种群中，一场流行病以特定最终规模结束的概率。通过追踪流行病演化的概率路径，你将加深对随机过程如何运作的理解，并学会量化不同结局出现的可能性。", "problem": "假设一个小型、孤立的火星殖民地，总共有 $N=4$ 名宇航员。抵达时，发现一名宇航员感染了一种新型病毒，而其余 $S_0=3$ 名宇航员是易感者。病毒的传播采用随机易感-感染-康复 (SIR) 模型进行建模。\n\n疫情的进展由一系列离散事件决定。在一个有 $S$ 名易感者和 $I$ 名感染者的状态下，该过程根据下一个事件进行演化，该事件可能是一次感染或一次康复。下一个事件是感染（状态从 $(S, I)$ 变为 $(S-1, I+1)$）的概率由下式给出：\n$$p_{\\text{inf}} = \\frac{\\rho S}{\\rho S + 1}$$\n下一个事件是康复（状态从 $(S, I)$ 变为 $(S, I-1)$）的概率是：\n$$p_{\\text{rec}} = \\frac{1}{\\rho S + 1}$$\n此处，$\\rho$ 是传染率比，它反映了感染率与康复率的相对关系。对于此特定病毒和殖民地条件，传染率比为 $\\rho = 1.2$。当不再有感染者（$I=0$）时，疫情结束。\n\n计算疫情结束时总共恰好有 3 人被感染的概率。将您的最终答案四舍五入到四位有效数字。", "solution": "我们将疫情建模为一系列离散事件。从初始状态 $(S_0, I_0) = (3, 1)$ 开始，令 $j$ 表示已发生的新感染事件数量。因此，易感者数量为 $S = 3 - j$。在任何一个状态，下一个事件是感染的概率为 $p_j = \\frac{\\rho S}{\\rho S + 1}$，是康复的概率为 $q_j = \\frac{1}{\\rho S + 1}$。\n我们要求总共有3人被感染的概率，这意味着在疫情结束（$I=0$）前，恰好发生了2次新的感染。\n\n1.  **第一次感染**：从状态 $(S=3, I=1)$ 开始，疫情要继续传播，第一个事件必须是感染。其概率为 $p_0 = \\frac{3\\rho}{3\\rho+1}$。发生后，系统进入一个有2名感染者的状态，且 $S=2$。\n\n2.  **第二次感染**：现在系统中有2名感染者，易感者为2人。为了发生第二次新感染，感染事件必须在两次康复事件之前发生。有两种途径可以达到第二次感染：\n    *   路径A：下一个事件是感染。概率为 $p_1 = \\frac{2\\rho}{2\\rho+1}$。系统状态变为 $(S=1, I=3)$。\n    *   路径B：下一个事件是康复，再下一个是感染。概率为 $q_1 \\cdot p_1 = \\frac{1}{2\\rho+1} \\cdot \\frac{2\\rho}{2\\rho+1}$。系统状态变为 $(S=1, I=2)$。\n    如果连续发生两次康复，疫情就会在第二次感染发生前结束。\n\n3.  **疫情结束**：在第二次感染发生后，易感者还剩1人 ($S=1$)。为使最终感染总人数为3，必须不再有新的感染发生。这意味着从这一刻起，所有事件都必须是康复。\n    *   如果遵循路径A，系统状态为 $(S=1, I=3)$。需要连续发生3次康复事件。发生这种情况的条件概率是 $q_2^3 = \\left(\\frac{1}{\\rho+1}\\right)^3$。\n    *   如果遵循路径B，系统状态为 $(S=1, I=2)$。需要连续发生2次康复事件。条件概率是 $q_2^2 = \\left(\\frac{1}{\\rho+1}\\right)^2$。\n\n综合起来，总概率 $P(\\text{总感染数}=3)$ 是所有导致恰好2次新感染的路径概率之和：\n$$ P = p_0 \\cdot (p_1 \\cdot q_2^3 + q_1 p_1 \\cdot q_2^2) = p_0 p_1 q_2^2 (q_2 + q_1) $$\n代入 $\\rho = 1.2$：\n- $p_0 = \\frac{3(1.2)}{3(1.2)+1} = \\frac{3.6}{4.6} = \\frac{18}{23}$\n- $p_1 = \\frac{2(1.2)}{2(1.2)+1} = \\frac{2.4}{3.4} = \\frac{12}{17}$\n- $q_1 = \\frac{1}{2(1.2)+1} = \\frac{1}{3.4} = \\frac{5}{17}$\n- $q_2 = \\frac{1}{1.2+1} = \\frac{1}{2.2} = \\frac{5}{11}$\n\n将这些值代入概率公式：\n$$ P = \\left(\\frac{18}{23}\\right) \\cdot \\left(\\frac{12}{17}\\right) \\cdot \\left(\\frac{5}{11}\\right)^2 \\cdot \\left(\\frac{5}{11} + \\frac{5}{17}\\right) $$\n$$ = \\left(\\frac{18}{23}\\right) \\cdot \\left(\\frac{12}{17}\\right) \\cdot \\left(\\frac{25}{121}\\right) \\cdot \\left(\\frac{85 + 55}{187}\\right) $$\n$$ = \\left(\\frac{18}{23}\\right) \\cdot \\left(\\frac{12}{17}\\right) \\cdot \\left(\\frac{25}{121}\\right) \\cdot \\left(\\frac{140}{187}\\right) $$\n$$ = \\frac{756000}{8847157} \\approx 0.08545118 $$\n四舍五入到四位有效数字，结果是 $0.08545$。", "answer": "$$\\boxed{0.08545}$$", "id": "1281955"}]}