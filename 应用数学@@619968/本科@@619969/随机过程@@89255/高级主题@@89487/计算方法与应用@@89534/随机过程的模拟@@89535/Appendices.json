{"hands_on_practices": [{"introduction": "模拟随机过程的第一步是学习如何生成基本的随机事件。本练习将通过一个质量控制的场景，带你动手实践蒙特卡洛方法中最核心的技术之一：使用均匀分布的随机数来模拟伯努利试验（即只有两种结果的事件）。通过手动执行这个简单的模拟过程[@problem_id:1332035]，你将深刻理解如何将计算机生成的伪随机数转化为对现实世界中不确定性的有效建模。", "problem": "一位质量控制工程师正在进行一次蒙特卡洛模拟的单一测试运行，以对电子元件的制造过程进行建模。在完整的生产过程中，每个元件有缺陷的独立概率为 $p=0.05$。该模拟对一批元件的检验过程进行建模。\n\n模拟算法的工作原理如下：对于批次中的每个元件 $i$，从区间 $[0, 1)$ 上的均匀分布中抽取一个随机数 $u_i$。如果 $u_i < p$，则该元件被标记为“有缺陷的”，否则标记为“无缺陷的”。\n\n对于一个包含 $N=12$ 个元件的小样本的特定测试运行，生成了以下随机数序列：\n$0.341, 0.025, 0.789, 0.991, 0.157, 0.450, 0.048, 0.823, 0.616, 0.009, 0.202, 0.533$\n\n根据此特定随机数序列和给定的缺陷概率，确定在本次模拟运行中识别出的有缺陷元件的总数。", "solution": "在此蒙特卡洛检验模型中，每个元件 $i$ 被标记为有缺陷的当且仅当 $u_{i} < p$，其中给定的缺陷概率为 $p=0.05$。定义指示变量 $X_{i}$ 为\n$$\nX_{i}=\\begin{cases}\n1, & \\text{if } u_{i} < p,\\\\\n0, & \\text{if } u_{i} \\geq p,\n\\end{cases}\n$$\n该次运行中缺陷品的总数则为\n$$\nD=\\sum_{i=1}^{N} X_{i}.\n$$\n使用 $N=12$ 和所提供的序列，将每个 $u_{i}$ 与 $p=0.05$ 进行比较：\n- 对于 $i=1$：$u_{1}=0.341 \\geq 0.05 \\Rightarrow X_{1}=0$。\n- 对于 $i=2$：$u_{2}=0.025 < 0.05 \\Rightarrow X_{2}=1$。\n- 对于 $i=3$：$u_{3}=0.789 \\geq 0.05 \\Rightarrow X_{3}=0$。\n- 对于 $i=4$：$u_{4}=0.991 \\geq 0.05 \\Rightarrow X_{4}=0$。\n- 对于 $i=5$：$u_{5}=0.157 \\geq 0.05 \\Rightarrow X_{5}=0$。\n- 对于 $i=6$：$u_{6}=0.450 \\geq 0.05 \\Rightarrow X_{6}=0$。\n- 对于 $i=7$：$u_{7}=0.048 < 0.05 \\Rightarrow X_{7}=1$。\n- 对于 $i=8$：$u_{8}=0.823 \\geq 0.05 \\Rightarrow X_{8}=0$。\n- 对于 $i=9$：$u_{9}=0.616 \\geq 0.05 \\Rightarrow X_{9}=0$。\n- 对于 $i=10$：$u_{10}=0.009 < 0.05 \\Rightarrow X_{10}=1$。\n- 对于 $i=11$：$u_{11}=0.202 \\geq 0.05 \\Rightarrow X_{11}=0$。\n- 对于 $i=12$：$u_{12}=0.533 \\geq 0.05 \\Rightarrow X_{12}=0$。\n\n求和，得到 $D=X_{2}+X_{7}+X_{10}=1+1+1=3$。", "answer": "$$\\boxed{3}$$", "id": "1332035"}, {"introduction": "随机过程的模拟不仅用于预测，更是一种强大的科学发现工具。本练习将我们带入计算物理学的领域，使用自回避随机游走（SAW）这一假想模型来研究聚合物链的行为。你将利用给定的模拟数据，验证一个重要的物理规律——标度律，并估算一个普适指数[@problem_id:1332029]。这个过程完美展示了如何通过计算实验从复杂的模拟结果中提取出简洁深刻的物理洞见。", "problem": "一位计算物理学家正在研究良溶剂中聚合物链的简化模型。该模型将聚合物表示为在单位边长的三维立方晶格上的自回避随机行走 (Self-Avoiding Random Walk, SAW)。SAW 是从原点 $(0,0,0)$ 开始的晶格上的一条路径，它不会多次访问同一个格点。行走 $N$ 步后，其“末端距” $R_N$ 是起始点和终点之间的欧几里得距离。\n\n这位物理学家对两种不同的聚合物长度 $N_1$ 和 $N_2$ 进行了广泛的模拟。使用一种能从给定长度的所有可能 SAW 的均匀分布中正确采样的复杂算法，模拟得出了以下均方末端距的值：\n- 对于长度为 $N_1 = 25$ 步的行走，均方末端距为 $\\langle R_{N_1}^2 \\rangle = 44.51$。\n- 对于长度为 $N_2 = 50$ 步的行走，均方末端距为 $\\langle R_{N_2}^2 \\rangle = 95.83$。\n\n在大 $N$ 的极限下，理论上预测 SAW 的均方末端距遵循一个普适标度律，形式为 $\\langle R_N^2 \\rangle = A N^{2\\nu}$，其中 $A$ 是一个与模型相关的振幅，$\\nu$ 是一个被称为 Flory 指数的普适值。\n\n假设该标度律对于所研究的 $N$ 范围是一个有效的近似，首先使用提供的模拟数据确定指数 $2\\nu$ 的数值。然后，使用这个确定的指数和 $N_2=50$ 步的数据来预测一个更长的聚合物（$N_3 = 500$ 步）的均方末端距 $\\langle R_{N_3}^2 \\rangle$。\n\n将您计算的 $\\langle R_{N_3}^2 \\rangle$ 的最终答案表示为一个四舍五入到三位有效数字的数值。", "solution": "我们使用自回避随机行走的均方末端距的标度律：\n$$\n\\langle R_{N}^{2} \\rangle = A N^{2\\nu},\n$$\n其中 $A$ 是一个振幅，$\\nu$ 是 Flory 指数。对于两个长度 $N_{1}$ 和 $N_{2}$，它们的比值可以消去 $A$：\n$$\n\\frac{\\langle R_{N_{2}}^{2} \\rangle}{\\langle R_{N_{1}}^{2} \\rangle} = \\left(\\frac{N_{2}}{N_{1}}\\right)^{2\\nu}.\n$$\n取自然对数可得\n$$\n2\\nu = \\frac{\\ln\\!\\left(\\frac{\\langle R_{N_{2}}^{2} \\rangle}{\\langle R_{N_{1}}^{2} \\rangle}\\right)}{\\ln\\!\\left(\\frac{N_{2}}{N_{1}}\\right)}.\n$$\n使用给定数据 $N_{1}=25$，$N_{2}=50$，$\\langle R_{N_{1}}^{2} \\rangle=44.51$ 和 $\\langle R_{N_{2}}^{2} \\rangle=95.83$，我们首先求出比值\n$$\nr \\equiv \\frac{\\langle R_{N_{2}}^{2} \\rangle}{\\langle R_{N_{1}}^{2} \\rangle} = \\frac{95.83}{44.51} \\approx 2.15300,\n$$\n并注意到 $\\frac{N_{2}}{N_{1}}=2$。因此，\n$$\n2\\nu = \\frac{\\ln(r)}{\\ln(2)} \\approx \\frac{\\ln(2.15300)}{\\ln(2)} \\approx 1.10635.\n$$\n为了预测 $N_{3}=500$ 时的 $\\langle R_{N_{3}}^{2} \\rangle$，我们使用\n$$\n\\langle R_{N_{3}}^{2} \\rangle = \\langle R_{N_{2}}^{2} \\rangle \\left(\\frac{N_{3}}{N_{2}}\\right)^{2\\nu} = 95.83 \\left(\\frac{500}{50}\\right)^{2\\nu} = 95.83 \\cdot 10^{2\\nu}.\n$$\n使用 $2\\nu \\approx 1.10635$，\n$$\n\\langle R_{500}^{2} \\rangle \\approx 95.83 \\times 10^{1.10635} \\approx 95.83 \\times 12.775 \\approx 1.224 \\times 10^{3}.\n$$\n四舍五入到三位有效数字，可得\n$$\n\\langle R_{500}^{2} \\rangle \\approx 1.22 \\times 10^{3}.\n$$", "answer": "$$\\boxed{1.22 \\times 10^{3}}$$", "id": "1332029"}, {"introduction": "理论与模拟的结合是随机过程研究的魅力所在。本练习聚焦于随机过程中最重要的模型之一——布朗运动，并探索其一个深刻的性质：列维（Lévy）反射原理。虽然问题本身可以从理论上求解，但其设计意图是启发我们思考如何通过大规模数值模拟来经验性地验证一个抽象的数学定理[@problem_id:1332040]。你会发现，计算结果可以为优美的理论提供惊人精确的佐证，这体现了计算在现代科学研究中的强大作用。", "problem": "标准一维布朗运动，记为 $W(t)$，是一个始于 $W(0) = 0$ 且具有独立、正态分布增量的随机过程。具体而言，对于任意 $t_2 > t_1 \\ge 0$，增量 $W(t_2) - W(t_1)$ 是一个服从均值为 0、方差为 $t_2 - t_1$ 的正态分布的随机变量。\n\n该过程在区间 $[0, T]$ 上的一个离散时间路径可以通过将该区间划分为 $N$ 个持续时间为 $\\Delta t = T/N$ 的小步长来模拟。在时间 $t_{i+1} = (i+1)\\Delta t$ 的位置由 $W(t_{i+1}) = W(t_i) + \\sqrt{\\Delta t} Z_i$ 给出，其中 $Z_i$ 是从标准正态分布 $\\mathcal{N}(0, 1)$ 中抽取的独立随机变量。\n\n考虑该过程的运行最大值，定义为 $M(T) = \\max_{0 \\le t \\le T} W(t)$。对于离散模拟，这对应于该过程在从 $t_0=0$ 到 $t_N=T$ 的任何时间步上所达到的最大值。\n\n你需要执行一次数值模拟来研究 $W(T)$ 和 $M(T)$ 的统计特性。在时间区间 $[0, T]$（其中 $T=5.0$）上模拟 $K = 500,000$ 条标准布朗运动的独立路径，每条路径使用 $N=1000$ 个时间步。\n\n根据你的模拟结果，估计以下两个概率：\n1.  $\\hat{P}_1$：运行最大值大于或等于阈值 $a$ 的经验概率，即 $M(T) \\ge a$。\n2.  $\\hat{P}_2$：最终位置大于或等于同一阈值 $a$ 的经验概率，即 $W(T) \\ge a$。\n\n使用阈值 $a=1.5$，计算比率 $R = \\hat{P}_1 / \\hat{P}_2$。\n\n将比率 $R$ 的最终答案四舍五入到三位有效数字。", "solution": "将标准布朗运动的离散时间近似定义为 $S_{0}=0$ 和 $S_{k}=\\sum_{i=1}^{k}X_{i}$（对于 $k=1,\\ldots,N$），其中 $X_{i}\\sim \\mathcal{N}(0,\\Delta t)$ 是独立的，且 $\\Delta t=T/N$。那么 $S_{N}\\sim \\mathcal{N}(0,N\\Delta t)=\\mathcal{N}(0,T)$。令 $M_{N}=\\max_{0\\leq k\\leq N}S_{k}$ 表示网格上的运行最大值。目标概率为 $P_{1}=P(M_{N}\\geq a)$ 和 $P_{2}=P(S_{N}\\geq a)$，而模拟产生的经验估计值 $\\hat{P}_{1}$ 和 $\\hat{P}_{2}$ 会根据大数定律在 $K\\to\\infty$ 时收敛到这些值。\n\n我们对具有独立、同分布、对称、连续增量的随机游走使用反射原理。设 $a>0$ 并定义首次穿越时间 $T_{a}=\\inf\\{k\\geq 1:S_{k}\\geq a\\}$。在 $T_{a}$ 处反射路径，会在满足 $M_{N}\\geq a$ 且终值为 $S_{N}\\in B$ 的路径与满足 $S_{N}\\in 2a-B$ 的路径之间建立一个双射，该双射保持概率不变，因为增量是对称的并且具有连续密度。因此，对于任何 Borel 集 $B\\subset \\mathbb{R}$，\n$$\nP(M_{N}\\geq a,\\;S_{N}\\in B)=P(S_{N}\\in 2a-B).\n$$\n取 $B=(-\\infty,a)$ 可得\n$$\nP(M_{N}\\geq a,\\;S_{N}<a)=P(S_{N}>a).\n$$\n由于 $S_{N}$ 具有连续分布，所以 $P(S_{N}=a)=0$，因此 $P(S_{N}\\geq a)=P(S_{N}>a)$。所以，\n$$\nP(M_{N}\\geq a)=P(S_{N}\\geq a)+P(M_{N}\\geq a,\\;S_{N}<a)=P(S_{N}\\geq a)+P(S_{N}\\geq a)=2\\,P(S_{N}\\geq a).\n$$\n\n接下来，使用 $S_{N}\\sim \\mathcal{N}(0,T)$ 计算 $P(S_{N}\\geq a)$：\n$$\nP(S_{N}\\geq a)=1-\\Phi\\!\\left(\\frac{a}{\\sqrt{T}}\\right),\n$$\n其中 $\\Phi$ 是标准正态累积分布函数。因此，\n$$\n\\frac{P_{1}}{P_{2}}=\\frac{2\\,P(S_{N}\\geq a)}{P(S_{N}\\geq a)}=2.\n$$\n\n对于指定的模拟参数 $T=5.0$，$N=1000$，$K=500{,}000$ 以及 $a=1.5$，经验比率 $R=\\hat{P}_{1}/\\hat{P}_{2}$ 收敛于理论值 $2$。四舍五入到三位有效数字得到 $2.00$。", "answer": "$$\\boxed{2.00}$$", "id": "1332040"}]}