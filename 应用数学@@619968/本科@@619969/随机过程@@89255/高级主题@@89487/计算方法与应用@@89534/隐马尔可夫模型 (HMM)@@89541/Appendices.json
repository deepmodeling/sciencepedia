{"hands_on_practices": [{"introduction": "第一个练习将介绍隐马尔可夫模型 (HMM) 的三个基本问题之一：评估问题。给定一个特定的 HMM 和一个观测序列，我们的目标是计算该序列发生的总概率。这项技能至关重要，因为它使我们能够评估一个给定模型对观测数据的解释程度，为模型选择和异常检测奠定基础。在这里，你将应用前向算法 (Forward Algorithm) 到一个工业传感器的实际场景中，来计算这个可能性 [@problem_id:1306030]。", "problem": "一个工业传感器用于监控一条装配线上零部件的质量。该传感器的状态无法直接观测，可建模为一个具有两个隐藏状态的系统：“运行正常”（Operational）和“故障”（Malfunctioning）。在每个时间步（对应于检测一个零部件），传感器会保持当前状态或转移到另一状态。对于其检测的每个零部件，传感器会输出两种信号之一：'Pass' 或 'Defect'。\n\n该系统的行为可用一个隐马尔可夫模型 (HMM) 描述，其参数定义如下：\n\n设隐藏状态集合为 $S = \\{S_{\\text{Op}}, S_{\\text{Mal}}\\}$，其中 $S_{\\text{Op}}$ 代表“运行正常”状态，$S_{\\text{Mal}}$ 代表“故障”状态。\n\n1.  **初始状态概率 ($\\pi$)：** 在观测周期开始时（时间 $t=1$），传感器处于各个状态的概率为：\n    *   $P(S_{\\text{Op}}) = 0.95$\n    *   $P(S_{\\text{Mal}}) = 0.05$\n\n2.  **状态转移概率矩阵 ($A$)：** 该矩阵给出了在连续时间步之间从一个状态转移到另一个状态的概率。\n    $$\n    A = \n    \\begin{pmatrix}\n    P(S_{t+1}=S_{\\text{Op}} | S_t=S_{\\text{Op}}) & P(S_{t+1}=S_{\\text{Mal}} | S_t=S_{\\text{Op}}) \\\\\n    P(S_{t+1}=S_{\\text{Op}} | S_t=S_{\\text{Mal}}) & P(S_{t+1}=S_{\\text{Mal}} | S_t=S_{\\text{Mal}})\n    \\end{pmatrix}\n    =\n    \\begin{pmatrix}\n    0.98 & 0.02 \\\\\n    0.15 & 0.85\n    \\end{pmatrix}\n    $$\n\n3.  **观测发射概率矩阵 ($B$)：** 该矩阵给出了在传感器当前隐藏状态下，观测到特定信号的概率。\n    $$\n    B = \n    \\begin{pmatrix}\n    P(\\text{'Pass'} | S_{\\text{Op}}) & P(\\text{'Defect'} | S_{\\text{Op}}) \\\\\n    P(\\text{'Pass'} | S_{\\text{Mal}}) & P(\\text{'Defect'} | S_{\\text{Mal}})\n    \\end{pmatrix}\n    =\n    \\begin{pmatrix}\n    0.99 & 0.01 \\\\\n    0.20 & 0.80\n    \\end{pmatrix}\n    $$\n\n一位工程师观测到传感器对连续三个零部件发出的信号序列为：('Pass', 'Pass', 'Defect')。\n\n计算观测到此特定序列的总概率。将最终答案四舍五入到四位有效数字。", "solution": "我们使用前向算法为该观测序列建模。设 $\\alpha_{t}(s) = P(o_{1:t}, S_{t}=s)$，其中 $o_{1:t}$ 表示从时间 $1$ 到 $t$ 的观测序列，$S_{t}$ 是时间 $t$ 的隐藏状态。递推关系如下：\n$$\n\\alpha_{1}(s) = \\pi(s)\\, b_{s}(o_{1}), \\quad\n\\alpha_{t+1}(s') = \\left[\\sum_{s \\in S} \\alpha_{t}(s)\\, a_{s \\to s'}\\right] b_{s'}(o_{t+1}),\n$$\n因此，观测序列 $o_{1:3} = (\\text{Pass}, \\text{Pass}, \\text{Defect})$ 的总概率为\n$$\nP(o_{1:3}) = \\sum_{s \\in S} \\alpha_{3}(s).\n$$\n\n$t=1$ 且 $o_{1}=\\text{Pass}$ 时的初始步骤：\n$$\n\\alpha_{1}(S_{\\text{Op}}) = \\pi(S_{\\text{Op}})\\, b_{S_{\\text{Op}}}(\\text{Pass}) = 0.95 \\cdot 0.99 = 0.9405,\n$$\n$$\n\\alpha_{1}(S_{\\text{Mal}}) = \\pi(S_{\\text{Mal}})\\, b_{S_{\\text{Mal}}}(\\text{Pass}) = 0.05 \\cdot 0.20 = 0.01.\n$$\n\n$t=2$ 且 $o_{2}=\\text{Pass}$ 时的递推步骤：\n$$\n\\alpha_{2}(S_{\\text{Op}}) = \\left[\\alpha_{1}(S_{\\text{Op}})\\, a_{\\text{Op}\\to\\text{Op}} + \\alpha_{1}(S_{\\text{Mal}})\\, a_{\\text{Mal}\\to\\text{Op}}\\right] b_{S_{\\text{Op}}}(\\text{Pass})\n= \\left[0.9405 \\cdot 0.98 + 0.01 \\cdot 0.15\\right] \\cdot 0.99\n= 0.92319 \\cdot 0.99 = 0.9139581,\n$$\n$$\n\\alpha_{2}(S_{\\text{Mal}}) = \\left[\\alpha_{1}(S_{\\text{Op}})\\, a_{\\text{Op}\\to\\text{Mal}} + \\alpha_{1}(S_{\\text{Mal}})\\, a_{\\text{Mal}\\to\\text{Mal}}\\right] b_{S_{\\text{Mal}}}(\\text{Pass})\n= \\left[0.9405 \\cdot 0.02 + 0.01 \\cdot 0.85\\right] \\cdot 0.20\n= 0.02731 \\cdot 0.20 = 0.005462.\n$$\n\n$t=3$ 且 $o_{3}=\\text{Defect}$ 时的递推步骤：\n$$\n\\alpha_{3}(S_{\\text{Op}}) = \\left[\\alpha_{2}(S_{\\text{Op}})\\, a_{\\text{Op}\\to\\text{Op}} + \\alpha_{2}(S_{\\text{Mal}})\\, a_{\\text{Mal}\\to\\text{Op}}\\right] b_{S_{\\text{Op}}}(\\text{Defect})\n= \\left[0.9139581 \\cdot 0.98 + 0.005462 \\cdot 0.15\\right] \\cdot 0.01\n= 0.896498238 \\cdot 0.01 = 0.00896498238,\n$$\n$$\n\\alpha_{3}(S_{\\text{Mal}}) = \\left[\\alpha_{2}(S_{\\text{Op}})\\, a_{\\text{Op}\\to\\text{Mal}} + \\alpha_{2}(S_{\\text{Mal}})\\, a_{\\text{Mal}\\to\\text{Mal}}\\right] b_{S_{\\text{Mal}}}(\\text{Defect})\n= \\left[0.9139581 \\cdot 0.02 + 0.005462 \\cdot 0.85\\right] \\cdot 0.80\n= 0.022921862 \\cdot 0.80 = 0.0183374896.\n$$\n\n序列的总概率为\n$$\nP(\\text{Pass}, \\text{Pass}, \\text{Defect}) = \\alpha_{3}(S_{\\text{Op}}) + \\alpha_{3}(S_{\\text{Mal}}) = 0.00896498238 + 0.0183374896 = 0.02730247198.\n$$\n\n四舍五入到四位有效数字，结果为 $0.02730$。", "answer": "$$\\boxed{0.02730}$$", "id": "1306030"}, {"introduction": "在学习了如何评估整个观测序列的可能性之后，我们现在转向一个更具推断性的任务：解码问题。我们通常希望揭示“隐藏的故事”——即产生我们所见观测结果的最可能的状态序列。这个目标可以通过维特比 (Viterbi) 算法实现。本练习将通过一个有趣的野生动物追踪情景，指导你完成这一过程，帮助你理解如何找到穿过隐藏状态的最佳解释路径 [@problem_id:1306022]。", "problem": "一位野生动物生物学家正在使用GPS项圈研究一只独居捕食者的行为。该生物学家将这只动物的行为建模为一个简单的随机过程，该过程具有两个不可观察的内部状态：`Hunting`（狩猎）和`Resting`（休息）。在每个小时开始时，这只动物精确地处于这两种状态之一。然而，项圈只能提供一个可观察的信号，指示动物是在`Moving`（移动）还是`Stationary`（静止）。\n\n该生物学家模型的参数如下：\n\n**1. 初始状态概率：**\n在观察期最开始时（第1小时），动物初始状态的概率为：\n- 处于`Hunting`状态的概率：$0.2$\n- 处于`Resting`状态的概率：$0.8$\n\n**2. 状态转移概率（每小时）：**\n这些概率描述了动物的内部状态如何从一小时变化到下一小时。\n- 如果动物处于`Hunting`状态，它在下一小时仍处于`Hunting`状态的概率为 $0.7$。\n- 如果动物处于`Hunting`状态，它在下一小时转换到`Resting`状态的概率为 $0.3$。\n- 如果动物处于`Resting`状态，它在下一小时仍处于`Resting`状态的概率为 $0.9$。\n- 如果动物处于`Resting`状态，它在下一小时转换到`Hunting`状态的概率为 $0.1$。\n\n**3. 发射概率：**\n这些概率将不可观察的内部状态与可观察的GPS信号联系起来。\n- 如果动物处于`Hunting`状态，项圈报告`Moving`的概率为 $0.8$，报告`Stationary`的概率为 $0.2$。\n- 如果动物处于`Resting`状态，项圈报告`Moving`的概率为 $0.1$，报告`Stationary`的概率为 $0.9$。\n\n在三小时的观察期内，生物学家从项圈观察到以下信号序列：`(Moving, Stationary, Moving)`。\n\n给定这个观测序列，确定这三小时内动物内部状态的最可能序列。请从以下选项中选择。\n\nA. (`Hunting`, `Hunting`, `Hunting`)\n\nB. (`Hunting`, `Resting`, `Hunting`)\n\nC. (`Resting`, `Resting`, `Hunting`)\n\nD. (`Resting`, `Resting`, `Resting`)\n\nE. (`Hunting`, `Resting`, `Resting`)", "solution": "我们有一个隐马尔可夫模型，其隐藏状态为 Hunting (H) 和 Resting (R)，观测值为 Moving (M) 和 Stationary (St)，初始概率为 $\\pi_{H}=0.2, \\pi_{R}=0.8$，转移概率为 $a_{HH}=0.7, a_{HR}=0.3, a_{RH}=0.1, a_{RR}=0.9$，以及发射概率为 $b_{H}(M)=0.8, b_{H}(\\text{St})=0.2, b_{R}(M)=0.1, b_{R}(\\text{St})=0.9$。观测序列为 $(M,\\text{St},M)$。我们应用维特比算法（Viterbi algorithm），该算法使用以下递归式\n$$\n\\delta_{t}(i)=b_{i}(o_{t})\\max_{j}\\left[\\delta_{t-1}(j)a_{ji}\\right],\\quad\n\\psi_{t}(i)=\\arg\\max_{j}\\left[\\delta_{t-1}(j)a_{ji}\\right],\n$$\n初始化为 $\\delta_{1}(i)=\\pi_{i}b_{i}(o_{1})$。\n\n在 $t=1$ 时对于 $o_{1}=M$ 进行初始化：\n$$\n\\delta_{1}(H)=\\pi_{H}b_{H}(M)=0.2\\cdot 0.8=0.16,\\quad\n\\delta_{1}(R)=\\pi_{R}b_{R}(M)=0.8\\cdot 0.1=0.08.\n$$\n\n在 $t=2$ 时对于 $o_{2}=\\text{St}$ 进行递归：\n$$\n\\delta_{2}(H)=b_{H}(\\text{St})\\max\\{\\delta_{1}(H)a_{HH},\\ \\delta_{1}(R)a_{RH}\\}\n=0.2\\max\\{0.16\\cdot 0.7,\\ 0.08\\cdot 0.1\\}\n=0.2\\cdot 0.112=0.0224,\n$$\n其反向指针为 $\\psi_{2}(H)=H$，因为 $0.112>0.008$。\n$$\n\\delta_{2}(R)=b_{R}(\\text{St})\\max\\{\\delta_{1}(H)a_{HR},\\ \\delta_{1}(R)a_{RR}\\}\n=0.9\\max\\{0.16\\cdot 0.3,\\ 0.08\\cdot 0.9\\}\n=0.9\\cdot 0.072=0.0648,\n$$\n其反向指针为 $\\psi_{2}(R)=R$，因为 $0.072>0.048$。\n\n在 $t=3$ 时对于 $o_{3}=M$ 进行递归：\n$$\n\\delta_{3}(H)=b_{H}(M)\\max\\{\\delta_{2}(H)a_{HH},\\ \\delta_{2}(R)a_{RH}\\}\n=0.8\\max\\{0.0224\\cdot 0.7,\\ 0.0648\\cdot 0.1\\}\n=0.8\\cdot 0.01568=0.012544,\n$$\n其反向指针为 $\\psi_{3}(H)=H$，因为 $0.01568>0.00648$。\n$$\n\\delta_{3}(R)=b_{R}(M)\\max\\{\\delta_{2}(H)a_{HR},\\ \\delta_{2}(R)a_{RR}\\}\n=0.1\\max\\{0.0224\\cdot 0.3,\\ 0.0648\\cdot 0.9\\}\n=0.1\\cdot 0.05832=0.005832,\n$$\n其反向指针为 $\\psi_{3}(R)=R$，因为 $0.05832>0.00672$。\n\n终止与回溯：由于 $\\delta_{3}(H)=0.012544>\\delta_{3}(R)=0.005832$，最可能的最终状态是 $H$。通过指针回溯得到 $\\psi_{3}(H)=H$ 和 $\\psi_{2}(H)=H$，因此最可能的状态序列是 $(H,H,H)$，对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "1306022"}, {"introduction": "最后一个练习将从算法应用转向概念理解，检验你对 HMM 核心原理的掌握程度。如果模型中的马尔可夫属性被特定条件消除——也就是说，如果下一个状态的概率分布独立于当前状态，那么模型的依赖结构会发生什么变化？通过分析这个特殊情况，你将发现 HMM 如何退化为一个更基础的随机过程，从而深化你对状态转移矩阵 $A$ 为何对模型行为如此关键的直觉 [@problem_id:1305982]。", "problem": "考虑一个隐马尔可夫模型 (HMM)，这是一种用于语音识别和生物信息学等应用的统计模型。一个 HMM 由一个元组 $(\\mathcal{S}, \\mathcal{V}, A, B, \\pi)$ 指定，其中：\n- $\\mathcal{S} = \\{s_1, s_2, \\dots, s_N\\}$ 是 $N$ 个隐状态的集合。\n- $\\mathcal{V} = \\{v_1, v_2, \\dots, v_M\\}$ 是 $M$ 个可能观测值的集合。\n- $A$ 是 $N \\times N$ 的状态转移概率矩阵，其中 $A_{ij} = P(q_t = s_j | q_{t-1} = s_i)$ 是从状态 $s_i$ 转移到状态 $s_j$ 的概率。\n- $B$ 是 $N \\times M$ 的发射概率矩阵，其中 $B_{jk} = P(o_t = v_k | q_t = s_j)$ 是当系统处于状态 $s_j$ 时观测到 $v_k$ 的概率。\n- $\\pi$ 是初始状态概率分布，其中 $\\pi_i = P(q_1 = s_i)$。\n\n一位数据科学家正在分析一个特定的 HMM，发现其转移矩阵 $A$ 有一个特殊的性质：它的所有行都完全相同。设这个共同的行向量为概率向量 $\\mathbf{p} = (p_1, p_2, \\dots, p_N)$，其中对所有 $j$ 都有 $p_j > 0$ 且 $\\sum_{j=1}^{N} p_j = 1$。因此，对于任意一对状态 $(s_i, s_j)$，转移概率为 $A_{ij} = p_j$。此外，还发现初始状态分布 $\\pi$ 也等于这个向量，即对所有 $j=1, \\dots, N$ 都有 $\\pi_j = p_j$。\n\n在这些特定条件下，生成观测序列 $(o_1, o_2, o_3, \\dots, o_T)$ 的随机过程退化为一个更简单、广为人知的过程类型。下列哪个选项最能描述观测序列所形成的最终过程？\n\nA. 一个简单的马尔可夫链，其中每个观测仅依赖于前一个观测。\n\nB. 一个鞅过程。\n\nC. 一个泊松过程。\n\nD. 一系列独立同分布 (i.i.d.) 的随机变量。\n\nE. 一个伯努利过程。", "solution": "令 $q_{t} \\in \\mathcal{S}$ 表示时间 $t$ 的隐状态，令 $o_{t} \\in \\mathcal{V}$ 表示时间 $t$ 的观测值。HMM 指定了\n$$\nP(q_{1} = s_{j}) = \\pi_{j} = p_{j}, \\quad P(q_{t} = s_{j} \\mid q_{t-1} = s_{i}) = A_{ij} = p_{j},\n$$\n以及\n$$\nP(o_{t} = v_{k} \\mid q_{t} = s_{j}) = B_{jk}.\n$$\n\n首先，我们推导隐状态的分布和独立性结构。对于任意序列 $(i_{1}, i_{2}, \\dots, i_{T})$，其中 $i_{t} \\in \\{1, \\dots, N\\}$，\n$$\nP(q_{1} = s_{i_{1}}, \\dots, q_{T} = s_{i_{T}}) = P(q_{1} = s_{i_{1}}) \\prod_{t=2}^{T} P(q_{t} = s_{i_{t}} \\mid q_{t-1} = s_{i_{t-1}}).\n$$\n代入给定的 $\\pi$ 和 $A$，\n$$\nP(q_{1} = s_{i_{1}}, \\dots, q_{T} = s_{i_{T}}) = p_{i_{1}} \\prod_{t=2}^{T} p_{i_{t}} = \\prod_{t=1}^{T} p_{i_{t}}.\n$$\n因此，$(q_{t})_{t=1}^{T}$ 是独立同分布 (i.i.d.) 的，且\n$$\nP(q_{t} = s_{j}) = p_{j} \\quad \\text{对所有 } t.\n$$\n\n接下来，我们考察观测值。在给定隐状态的条件下，观测值是独立的，且\n$$\nP(o_{t} = v_{k} \\mid q_{t} = s_{j}) = B_{jk}.\n$$\n每个 $o_{t}$ 的边缘分布可以通过对隐状态求和得到：\n$$\nP(o_{t} = v_{k}) = \\sum_{j=1}^{N} P(o_{t} = v_{k} \\mid q_{t} = s_{j}) P(q_{t} = s_{j}) = \\sum_{j=1}^{N} B_{jk} p_{j}.\n$$\n这个表达式不依赖于 $t$，因此 $o_{t}$ 是同分布的。\n\n为了证明观测值的独立性，我们计算任意固定的 $(k_{1}, \\dots, k_{T})$ 的联合分布：\n$$\nP(o_{1} = v_{k_{1}}, \\dots, o_{T} = v_{k_{T}}) = \\sum_{i_{1}=1}^{N} \\cdots \\sum_{i_{T}=1}^{N} P(q_{1} = s_{i_{1}}, \\dots, q_{T} = s_{i_{T}}) \\prod_{t=1}^{T} P(o_{t} = v_{k_{t}} \\mid q_{t} = s_{i_{t}}).\n$$\n利用为状态推导出的分解形式，\n$$\nP(o_{1} = v_{k_{1}}, \\dots, o_{T} = v_{k_{T}}) = \\sum_{i_{1}=1}^{N} \\cdots \\sum_{i_{T}=1}^{N} \\prod_{t=1}^{T} \\left( p_{i_{t}} B_{i_{t} k_{t}} \\right) = \\prod_{t=1}^{T} \\left( \\sum_{j=1}^{N} p_{j} B_{j k_{t}} \\right).\n$$\n因此，\n$$\nP(o_{1} = v_{k_{1}}, \\dots, o_{T} = v_{k_{T}}) = \\prod_{t=1}^{T} P(o_{t} = v_{k_{t}}),\n$$\n这表明 $(o_{t})_{t=1}^{T}$ 是独立的。结合相同的边缘分布，该观测序列是独立同分布 (i.i.d.) 的，其观测分布由以下混合分布给出：\n$$\nP(o_{t} = v_{k}) = \\sum_{j=1}^{N} p_{j} B_{jk}.\n$$\n\n在这些选项中，这对应于一系列独立同分布的随机变量。选项 E（伯努利过程）仅在 $M=2$ 时是一个特例，而我们的结论对一般的 $M$ 都成立，因此最佳描述是选项 D。", "answer": "$$\\boxed{D}$$", "id": "1305982"}]}