{"hands_on_practices": [{"introduction": "我们的第一个练习是一项基础性任务，旨在帮助你掌握吉布斯采样的核心机制。我们将通过一个简单直观的几何形状——三角形，来学习如何推导全条件分布（full conditional distributions），这是构建吉布斯采样的基石。这个练习将让你深刻理解目标分布的几何特性如何决定采样器的每一步操作 [@problem_id:1338725]。", "problem": "一位统计学家希望生成随机点 $(X, Y)$，这些点在一个特定的二维区域内均匀分布。该区域是笛卡尔平面中的一个三角形，由顶点 $(0,0)$、$(1,0)$ 和 $(0,1)$ 定义。随机向量 $(X,Y)$ 的联合概率密度函数 (PDF) 在此三角形内部为常数，在外部为零。为了生成这些点，该统计学家计划使用吉布斯采样（Gibbs sampler），这是一种马尔可夫链蒙特卡洛（Markov chain Monte Carlo）算法，通过从完全条件分布中迭代采样来工作。\n\n实现吉布斯采样的核心需要正确地指定这些完全条件分布，$p(x|y)$ 和 $p(y|x)$。令 $U(a,b)$ 表示区间 $[a,b]$ 上的连续均匀分布。\n\n以下哪个选项正确指定了吉布斯采样所需的 $X$ 和 $Y$ 的完全条件分布？\n\nA. $X|Y=y \\sim U(0, 1-y)$ 且 $Y|X=x \\sim U(0, 1-x)$\n\nB. $X|Y=y \\sim U(0, 1)$ 且 $Y|X=x \\sim U(0, 1)$\n\nC. $X|Y=y \\sim U(0, y)$ 且 $Y|X=x \\sim U(0, x)$\n\nD. $X|Y=y \\sim U(0, 1-x)$ 且 $Y|X=x \\sim U(0, 1-y)$\n\nE. $X|Y=y \\sim U(y, 1)$ 且 $Y|X=x \\sim U(x, 1)", "solution": "该问题要求在一个由顶点 $(0,0)$、$(1,0)$ 和 $(0,1)$ 定义的三角形内均匀分布的点 $(X,Y)$ 的完全条件分布 $p(x|y)$ 和 $p(y|x)$。\n\n首先，我们定义该分布的支撑集。该三角形由直线 $x=0$、$y=0$ 以及连接 $(1,0)$ 和 $(0,1)$ 的直线 $x+y=1$ 所界定。因此，概率非零的区域，我们称之为 $R$，由 $R = \\{(x,y) | x \\ge 0, y \\ge 0, x+y \\le 1\\}$ 给出。\n\n该分布在此区域上是均匀的。三角形的面积为 $A = \\frac{1}{2} \\times \\text{底} \\times \\text{高} = \\frac{1}{2} \\times 1 \\times 1 = \\frac{1}{2}$。$(X,Y)$ 的联合概率密度函数 (PDF) $f(x,y)$ 在三角形内部是面积的倒数，在其他地方为零。\n$$\nf(x,y) =\n\\begin{cases}\n\\frac{1}{A} = 2 & \\text{如果 } x \\ge 0, y \\ge 0, x+y \\le 1 \\\\\n0 & \\text{否则}\n\\end{cases}\n$$\n为了求条件分布，我们使用公式 $f(x|y) = \\frac{f(x,y)}{f_Y(y)}$ 和 $f(y|x) = \\frac{f(x,y)}{f_X(x)}$，其中 $f_X(x)$ 和 $f_Y(y)$ 是边缘概率密度函数。\n\n我们首先求 $Y$ 的边缘概率密度函数 $f_Y(y)$。我们将联合概率密度函数对所有可能的 $x$ 值进行积分。对于一个固定的值 $y \\in [0,1]$，$x$ 的约束条件是 $x \\ge 0$ 和 $x \\le 1-y$。\n$$\nf_Y(y) = \\int_{-\\infty}^{\\infty} f(x,y) \\, dx = \\int_{0}^{1-y} 2 \\, dx\n$$\n该积分对于 $y \\in [0,1]$ 有效。对于此区间外的 $y$，$f_Y(y)=0$。\n$$\nf_Y(y) = 2 [x]_0^{1-y} = 2(1-y) \\quad \\text{对于 } 0 \\le y \\le 1\n$$\n现在我们可以求给定 $Y=y$ 时 $X$ 的条件概率密度函数。\n$$\nf(x|y) = \\frac{f(x,y)}{f_Y(y)} = \\frac{2}{2(1-y)} = \\frac{1}{1-y}\n$$\n这个条件概率密度函数是在给定 $y$ 的 $x$ 的取值范围上定义的，即 $0 \\le x \\le 1-y$。函数 $f(x|y) = \\frac{1}{1-y}$ 关于 $x$ 是一个常数。这是在区间 $[0, 1-y]$ 上的均匀分布的概率密度函数。因此，我们记为 $X|Y=y \\sim U(0, 1-y)$。\n\n接下来，我们求 $X$ 的边缘概率密度函数 $f_X(x)$。我们将联合概率密度函数对所有可能的 $y$ 值进行积分。对于一个固定的值 $x \\in [0,1]$，$y$ 的约束条件是 $y \\ge 0$ 和 $y \\le 1-x$。\n$$\nf_X(x) = \\int_{-\\infty}^{\\infty} f(x,y) \\, dy = \\int_{0}^{1-x} 2 \\, dy\n$$\n该积分对于 $x \\in [0,1]$ 有效。对于此区间外的 $x$，$f_X(x)=0$。\n$$\nf_X(x) = 2 [y]_0^{1-x} = 2(1-x) \\quad \\text{对于 } 0 \\le x \\le 1\n$$\n现在我们可以求给定 $X=x$ 时 $Y$ 的条件概率密度函数。\n$$\nf(y|x) = \\frac{f(x,y)}{f_X(x)} = \\frac{2}{2(1-x)} = \\frac{1}{1-x}\n$$\n这个条件概率密度函数是在给定 $x$ 的 $y$ 的取值范围上定义的，即 $0 \\le y \\le 1-x$。函数 $f(y|x) = \\frac{1}{1-x}$ 关于 $y$ 是一个常数。这是在区间 $[0, 1-x]$ 上的均匀分布的概率密度函数。因此，我们记为 $Y|X=x \\sim U(0, 1-x)$。\n\n综合我们的两个发现，完全条件分布是：\n$X|Y=y \\sim U(0, 1-y)$\n$Y|X=x \\sim U(0, 1-x)$\n\n将此结果与给定的选项进行比较，我们发现它与选项 A 匹配。", "answer": "$$\\boxed{A}$$", "id": "1338725"}, {"introduction": "在掌握了二维情形的基础之上，这个练习将我们带入三维空间。通过考虑在一个圆柱体内均匀分布的点，你将练习应用相同的原理来推导更高维空间中的条件分布 [@problem_id:1338685]。这体现了吉布斯采样方法的可扩展性与普适性，是将其应用于更复杂问题的关键一步。", "problem": "在计算统计学中，Gibbs 采样器是一种马尔可夫链蒙特卡洛 (MCMC) 算法，用于在直接采样困难时，从一个指定的多变量概率分布中获得近似的观测序列。该方法在贝叶斯推断中对后验分布进行采样时尤其有用。\n\n考虑生成在实心直立圆柱体内均匀分布的随机点 $(X, Y, Z)$ 的问题。该圆柱体由满足不等式 $x^2 + y^2 \\le R^2$ 和 $0 \\le z \\le H$ 的点集 $(x, y, z)$ 定义，其中 $R > 0$ 是底面半径，$H > 0$ 是高。对于此问题，设该圆柱体由特定参数 $R=1$ 和 $H=1$ 定义。\n\n为了在这种情况下实现一个 Gibbs 采样器，必须从全条件分布 $p(x|y,z)$、$p(y|x,z)$ 和 $p(z|x,y)$ 中进行迭代采样。\n\n下列哪项正确描述了坐标 $(X, Y, Z)$ 的全条件分布集？在下面的选项中，$U(a, b)$ 表示区间 $[a, b]$ 上的均匀分布，而 $N(\\mu, \\sigma^2)$ 表示均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布。\n\nA.\n$X | Y=y, Z=z \\sim U(-\\sqrt{1 - y^2}, \\sqrt{1 - y^2})$\n$Y | X=x, Z=z \\sim U(-\\sqrt{1 - x^2}, \\sqrt{1 - x^2})$\n$Z | X=x, Y=y \\sim U(0, 1)$\n\nB.\n$X | Y=y, Z=z \\sim U(-1, 1)$\n$Y | X=x, Z=z \\sim U(-1, 1)$\n$Z | X=x, Y=y \\sim U(0, 1)$\n\nC.\n$X | Y=y, Z=z \\sim N(0, 1 - y^2)$\n$Y | X=x, Z=z \\sim N(0, 1 - x^2)$\n$Z | X=x, Y=y \\sim U(0, 1)$\n\nD.\n$X | Y=y, Z=z \\sim U(0, 1)$\n$Y | X=x, Z=z \\sim U(0, 1)$\n$Z | X=x, Y=y \\sim U(0, \\sqrt{1 - x^2 - y^2})$\n\nE.\n$X | Y=y, Z=z \\sim U(-\\sqrt{1 - y^2}, \\sqrt{1 - y^2})$\n$Y | X=x, Z=z \\sim U(-\\sqrt{1 - x^2}, \\sqrt{1 - x^2})$\n$Z | X=x, Y=y \\sim U(0, H\\exp(-x^2-y^2))$", "solution": "我们的目标是半径和高均为 $1$ 的实心圆柱体上的均匀分布，即集合 $\\{(x,y,z): x^{2}+y^{2}\\le 1,\\ 0\\le z\\le 1\\}$。其联合密度可以写作\n$$\nf(x,y,z)=C\\,\\mathbf{1}\\{x^{2}+y^{2}\\le 1,\\ 0\\le z\\le 1\\},\n$$\n其中 $C$ 是归一化常数（在其支撑集上为常数）。对于全条件分布，我们使用\n$$\np(x\\mid y,z)=\\frac{f(x,y,z)}{\\int f(x',y,z)\\,dx'},\\quad\np(y\\mid x,z)=\\frac{f(x,y,z)}{\\int f(x,y',z)\\,dy'},\\quad\np(z\\mid x,y)=\\frac{f(x,y,z)}{\\int f(x,y,z')\\,dz'}.\n$$\n\n1) 对于 $X\\mid Y=y, Z=z$，在 $|y|\\le 1$ 且 $0\\le z\\le 1$ 的条件下，分子 $f(x,y,z)$ 在指示函数值为 1 的集合（即 $x^{2}+y^{2}\\le 1$）上关于 $x$ 是常数。这个约束等价于 $x\\in\\left[-\\sqrt{1-y^{2}},\\,\\sqrt{1-y^{2}}\\right]$。分母是这个相同的常数乘以该区间的长度，即 $2\\sqrt{1-y^{2}}$。因此，该比率在该区间上是均匀的：\n$$\nX\\mid Y=y, Z=z \\sim U\\!\\left(-\\sqrt{1-y^{2}},\\,\\sqrt{1-y^{2}}\\right).\n$$\n\n2) 根据对称性，对于 $Y\\mid X=x, Z=z$，在 $|x|\\le 1$ 且 $0\\le z\\le 1$ 的条件下，可行集为 $y\\in\\left[-\\sqrt{1-x^{2}},\\,\\sqrt{1-x^{2}}\\right]$，且在此区间上的密度为常数，从而得到\n$$\nY\\mid X=x, Z=z \\sim U\\!\\left(-\\sqrt{1-x^{2}},\\,\\sqrt{1-x^{2}}\\right).\n$$\n\n3) 对于 $Z\\mid X=x, Y=y$，在 $x^{2}+y^{2}\\le 1$ 的条件下，关于 $z$ 的约束就是 $0\\le z\\le 1$，且密度在此区间上为常数。分母是该常数乘以区间长度 $1-0=1$。因此，\n$$\nZ\\mid X=x, Y=y \\sim U(0,1).\n$$\n\n这三个全条件分布与选项 A 完全匹配，并且在所给选项中只与选项 A 匹配。", "answer": "$$\\boxed{A}$$", "id": "1338685"}, {"introduction": "一个有效的吉布斯采样器必须能够探索目标分布的整个支撑集，这一性质被称为“不可约性”（irreducibility）。这个练习通过一个概率空间不连通的巧妙思想实验，揭示了标准吉布斯采样器的一个关键失效模式 [@problem_id:1338689]。通过分析这种情况，你将学会识别采样器何时可能被“困住”在一个局部区域，从而无法收敛到正确的全局分布。", "problem": "考虑一对离散随机变量 $(X, Y)$，其联合概率质量函数 (PMF) $p(x, y)$ 定义在 $\\mathbb{Z}^2$ 的一个子集上。该分布的支撑集，即 $p(x, y) > 0$ 的点集，是两个不相交的正方形区域 $U = A_1 \\cup A_2$ 的并集。这些区域由一个正整数参数 $K$ 和一个更大的整数 $L$（满足 $L > K$）定义。具体而言：\n$A_1 = \\{(x, y) \\in \\mathbb{Z}^2 \\mid 0 \\le x \\le K, 0 \\le y \\le K\\}$\n$A_2 = \\{(x, y) \\in \\mathbb{Z}^2 \\mid L \\le x \\le L+K, L \\le y \\le L+K\\}$\n\n联合概率质量函数 $p(x, y)$ 在支撑集 $U$ 上是均匀分布的。\n\n采用一个 Gibbs 采样器从该分布中生成样本。采样器在状态 $(x^{(0)}, y^{(0)}) = (0, 0)$ 处初始化。每个后续状态 $(x^{(t+1)}, y^{(t+1)})$ 通过以下两步过程从当前状态 $(x^{(t)}, y^{(t)})$ 生成：\n1. 从全条件分布 $p(x | Y = y^{(t)})$ 中抽取 $x^{(t+1)}$。\n2. 从全条件分布 $p(y | X = x^{(t+1)})$ 中抽取 $y^{(t+1)}$。\n\n经过大量迭代后，生成的状态序列将在分布上收敛到一个平稳分布，记为 $\\pi(x, y)$。求随机变量 $X$ 关于此平稳分布的期望值 $\\mathbb{E}_{\\pi}[X]$。答案应为一个以 $K$ 表示的解析表达式。", "solution": "设 $U=A_{1}\\cup A_{2}$，其中 $A_{1}=\\{(x,y)\\in\\mathbb{Z}^{2}\\mid 0\\le x\\le K,\\;0\\le y\\le K\\}$ 且 $A_{2}=\\{(x,y)\\in\\mathbb{Z}^{2}\\mid L\\le x\\le L+K,\\;L\\le y\\le L+K\\}$，并假设 $p(x,y)$ 在 $U$ 上是均匀分布。因此，存在一个常数 $c$，使得当 $(x,y)\\in U$ 时 $p(x,y)=c$，否则 $p(x,y)=0$。因为 $|A_{1}|=|A_{2}|=(K+1)^{2}$ 且 $U$ 是一个不相交并集，所以 $c=\\frac{1}{2(K+1)^{2}}$，尽管其值在条件分布的计算中会被消掉。\n\n固定 $y\\in\\mathbb{Z}$。全条件分布 $p(x\\mid y)$ 由下式给出\n$$\np(x\\mid y)=\\frac{p(x,y)}{\\sum_{x'}p(x',y)}.\n$$\n如果 $0\\le y\\le K$，那么 $(x,y)\\in U$ 当且仅当 $0\\le x\\le K$，所以 $\\sum_{x'}p(x',y)=\\sum_{x'=0}^{K}c=c(K+1)$ 且\n$$\np(x\\mid y)=\\begin{cases}\n\\frac{1}{K+1}, & 0\\le x\\le K,\\\\\n0, & \\text{其它情况}.\n\\end{cases}\n$$\n如果 $L\\le y\\le L+K$，那么 $(x,y)\\in U$ 当且仅当 $L\\le x\\le L+K$，得到\n$$\np(x\\mid y)=\\begin{cases}\n\\frac{1}{K+1}, & L\\le x\\le L+K,\\\\\n0, & \\text{其它情况}.\n\\end{cases}\n$$\n由于在其他 $y$ 值处 $p(y)=0$，因此马尔可夫链中不会出现这些值。根据对称性，另一个全条件分布 $p(y\\mid x)$ 满足：如果 $0\\le x\\le K$，则 $p(y\\mid x)$ 在 $\\{0,\\dots,K\\}$ 上是均匀分布；如果 $L\\le x\\le L+K$，则 $p(y\\mid x)$ 在 $\\{L,\\dots,L+K\\}$ 上是均匀分布。\n\n在初始化条件 $(x^{(0)},y^{(0)})=(0,0)\\in A_{1}$ 下，我们有 $y^{(0)}\\in\\{0,\\dots,K\\}$，因此 $x^{(1)}$ 在 $\\{0,\\dots,K\\}$ 上是均匀分布的。给定任意 $x^{(1)}\\in\\{0,\\dots,K\\}$，则 $y^{(1)}$ 也在 $\\{0,\\dots,K\\}$ 上是均匀分布的。因此，从 $A_{1}$ 中任意状态出发的单步转移所产生的 $(x^{(t+1)},y^{(t+1)})$ 在 $A_{1}$ 上是均匀分布的，且与 $(x^{(t)},y^{(t)})$ 无关。因此，该马尔可夫链是可约的，具有两个闭类 $A_{1}$ 和 $A_{2}$；从 $A_{1}$ 开始，它将始终停留在 $A_{1}$ 中，并且从第一次迭代开始，其状态就服从 $A_1$ 上的独立同分布均匀分布。因此，从给定的初始状态所能达到的平稳分布是 $A_{1}$ 上的均匀分布。\n\n在此平稳分布下，$X$ 的边际分布是在 $\\{0,\\dots,K\\}$ 上的离散均匀分布，因为联合分布在 $A_{1}$ 上是均匀的，并且在此均匀分布的约束下，$X$ 和 $Y$ 是独立的。于是\n$$\n\\mathbb{E}_{\\pi}[X]=\\frac{1}{(K+1)^{2}}\\sum_{x=0}^{K}\\sum_{y=0}^{K} x\n=\\frac{1}{(K+1)^{2}}\\left(\\sum_{x=0}^{K}x\\right)(K+1)\n=\\frac{1}{K+1}\\cdot\\frac{K(K+1)}{2}\n=\\frac{K}{2}.\n$$\n因此，期望值为 $\\frac{K}{2}$。", "answer": "$$\\boxed{\\frac{K}{2}}$$", "id": "1338689"}]}