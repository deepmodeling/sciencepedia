{"hands_on_practices": [{"introduction": "理论知识只有通过实践才能真正掌握。第一个练习将带领你将维特比算法应用于一个经典且直观的场景：根据每日的天气观测（晴、阴、雨）来推断背后隐藏的大气压力状态（高压或低压）。通过这个练习[@problem_id:1664280]，你将有机会亲手执行维特比算法的每一步，从初始化、递推计算到最终的回溯，从而牢固掌握其核心工作流程。", "problem": "一个简化的气象模型使用隐马尔可夫模型（HMM）来描述每日天气。任何一天的天气都由一个不可观测的，或称“隐藏”的大气压力状态决定，该状态可以是“高压”（H）或“低压”（L）。可观测的天气状况可以是“晴天”（S）、“多云”（C）或“雨天”（R）。\n\n该模型由以下概率定义：\n\n**1. 初始状态概率（第1天）：**\n*   第1天以高压状态开始的概率是 $0.6$。\n*   第1天以低压状态开始的概率是 $0.4$。\n\n**2. 状态转移概率（从一天到下一天）：**\n*   从高压转移到高压的概率：$0.7$\n*   从高压转移到低压的概率：$0.3$\n*   从低压转移到低压的概率：$0.6$\n*   从低压转移到高压的概率：$0.4$\n\n**3. 发射概率（在给定隐藏压力状态下，观测到某种天气状况的概率）：**\n*   给定高压状态：\n    *   ‘晴天’的概率：$0.8$\n    *   ‘多云’的概率：$0.15$\n    *   ‘雨天’的概率：$0.05$\n*   给定低压状态：\n    *   ‘晴天’的概率：$0.1$\n    *   ‘多云’的概率：$0.4$\n    *   ‘雨天’的概率：$0.5$\n\n一位观测者记录了连续三天的天气状况序列：第1天：‘晴天’，第2天：‘多云’，第3天：‘雨天’。\n\n根据这个观测序列和模型参数，确定这三天最有可能的隐藏大气压力状态序列。\n\nA. H-H-H\n\nB. H-H-L\n\nC. H-L-L\n\nD. L-H-L\n\nE. L-L-H\n\nF. L-L-L", "solution": "我们将隐藏的大气压力状态建模为 $H$ 和 $L$，三天的观测序列为 $S, C, R$。使用维特比算法，定义\n$$\n\\delta_{t}(i)=\\max_{q_{1},\\dots,q_{t-1}} P(q_{1},\\dots,q_{t}=i, O_{1},\\dots,O_{t}),\n$$\n其中初始概率为 $\\pi_{H}=0.6$，$\\pi_{L}=0.4$，转移概率为 $a_{HH}=0.7$, $a_{HL}=0.3$, $a_{LL}=0.6$, $a_{LH}=0.4$，发射概率为 $b_{H}(S)=0.8$, $b_{H}(C)=0.15$, $b_{H}(R)=0.05$, $b_{L}(S)=0.1$, $b_{L}(C)=0.4$, $b_{L}(R)=0.5$。\n\n对于 $t=1$ 和 $O_{1}=S$ 进行初始化：\n$$\n\\delta_{1}(H)=\\pi_{H} b_{H}(S)=0.6\\cdot 0.8=0.48,\\qquad \\delta_{1}(L)=\\pi_{L} b_{L}(S)=0.4\\cdot 0.1=0.04.\n$$\n\n对于 $t=2$ 和 $O_{2}=C$ 进行递推：\n$$\n\\delta_{2}(H)=\\max\\{\\delta_{1}(H)a_{HH},\\,\\delta_{1}(L)a_{LH}\\}\\,b_{H}(C)=\\max\\{0.48\\cdot 0.7,\\,0.04\\cdot 0.4\\}\\cdot 0.15=0.336\\cdot 0.15=0.0504,\n$$\n因此，回溯指针来自 $H$。类似地，\n$$\n\\delta_{2}(L)=\\max\\{\\delta_{1}(H)a_{HL},\\,\\delta_{1}(L)a_{LL}\\}\\,b_{L}(C)=\\max\\{0.48\\cdot 0.3,\\,0.04\\cdot 0.6\\}\\cdot 0.4=0.144\\cdot 0.4=0.0576,\n$$\n因此，回溯指针来自 $H$。\n\n对于 $t=3$ 和 $O_{3}=R$ 进行递推：\n$$\n\\delta_{3}(H)=\\max\\{\\delta_{2}(H)a_{HH},\\,\\delta_{2}(L)a_{LH}\\}\\,b_{H}(R)=\\max\\{0.0504\\cdot 0.7,\\,0.0576\\cdot 0.4\\}\\cdot 0.05=0.03528\\cdot 0.05=0.001764,\n$$\n因此，回溯指针来自 $H$。并且，\n$$\n\\delta_{3}(L)=\\max\\{\\delta_{2}(H)a_{HL},\\,\\delta_{2}(L)a_{LL}\\}\\,b_{L}(R)=\\max\\{0.0504\\cdot 0.3,\\,0.0576\\cdot 0.6\\}\\cdot 0.5=0.03456\\cdot 0.5=0.01728,\n$$\n因此，回溯指针来自 $L$。\n\n终止步骤通过最大化 $\\delta_{3}$ 来选择最终状态：\n$$\n\\delta_{3}(L)=0.01728>\\delta_{3}(H)=0.001764,\n$$\n因此最有可能的最终状态是 $L$。使用存储的回溯指针进行回溯，得到序列 $q_{3}=L$, $q_{2}=L$, $q_{1}=H$，即 $H$-$L$-$L$，对应选项 C。", "answer": "$$\\boxed{C}$$", "id": "1664280"}, {"introduction": "在上一个练习中，我们找到了唯一的“最可能”路径。然而，在实际应用中，我们可能会遇到两条或多条不同的隐藏状态序列产生相同最大概率的情况。这个练习[@problem_id:1664321]精心设计了一个场景，让你在使用维特比算法时会遇到一个概率“平局”，这有助于你更深入地理解算法的决策过程以及如何解释这种情况下的输出。", "problem": "考虑一个由隐马尔可夫模型 (HMM) 建模的系统。该系统可以处于两种隐状态之一，表示为 $S_1$ 和 $S_2$。在每个离散时间步，系统会发出一个可观测的输出，可以是 $A$ 或 $B$。\n\n此 HMM 的参数定义如下：\n\n1.  **初始状态概率**：已知该系统在时间 $t=1$ 时从状态 $S_1$ 开始。因此，处于状态 $S_1$ 的初始概率为 1.0，而处于状态 $S_2$ 的初始概率为 0.0。\n\n2.  **状态转移概率**：\n    - 从状态 $S_1$ 转移到其自身的概率为 $P(S_1 | S_1) = 0.6$。\n    - 从状态 $S_1$ 转移到状态 $S_2$ 的概率为 $P(S_2 | S_1) = 0.4$。\n    - 从状态 $S_2$ 转移到状态 $S_1$ 的概率为 $P(S_1 | S_2) = 0.5$。\n    - 从状态 $S_2$ 转移到其自身的概率为 $P(S_2 | S_2) = 0.5$。\n\n3.  **发射概率**：\n    - 从状态 $S_1$ 发射输出 $A$ 的概率为 $P(A | S_1) = 0.8$。\n    - 从状态 $S_1$ 发射输出 $B$ 的概率为 $P(B | S_1) = 0.2$。\n    - 从状态 $S_2$ 发射输出 $A$ 的概率为 $P(A | S_2) = 0.7$。\n    - 从状态 $S_2$ 发射输出 $B$ 的概率为 $P(B | S_2) = 0.3$。\n\n假设在两个时间步内观测到以下输出序列：$(A, B)$。\n\n使用维特比算法 (Viterbi algorithm)，确定最有可能产生此观测序列的隐状态序列。从以下选项中选择正确的选项。\n\nA. 两个最可能的序列是 $(S_1, S_1)$ 和 $(S_2, S_1)$。\n\nB. 两个最可能的序列是 $(S_2, S_2)$ 和 $(S_1, S_2)$。\n\nC. 两个最可能的序列是 $(S_1, S_1)$ 和 $(S_1, S_2)$。\n\nD. 只存在一个最可能的路径：$(S_1, S_2)$。\n\nE. 只存在一个最可能的路径：$(S_1, S_1)$。", "solution": "我们有一个双状态的HMM，其状态为 $S_{1}$ 和 $S_{2}$，观测序列为 $(A,B)$。初始分布是确定的：$P(q_{1}=S_{1})=1$ 和 $P(q_{1}=S_{2})=0$。转移概率为 $a_{11}=P(S_{1}\\mid S_{1})=0.6$，$a_{12}=P(S_{2}\\mid S_{1})=0.4$，$a_{21}=P(S_{1}\\mid S_{2})=0.5$，$a_{22}=P(S_{2}\\mid S_{2})=0.5$。发射概率为 $b_{1}(A)=P(A\\mid S_{1})=0.8$，$b_{1}(B)=P(B\\mid S_{1})=0.2$，$b_{2}(A)=P(A\\mid S_{2})=0.7$，$b_{2}(B)=P(B\\mid S_{2})=0.3$。\n\n使用维特比算法，定义递归式\n$$\n\\delta_{t}(j)=\\max_{i}\\bigl[\\delta_{t-1}(i)\\,a_{ij}\\bigr]\\;b_{j}(o_{t}),\\quad \\psi_{t}(j)=\\arg\\max_{i}\\bigl[\\delta_{t-1}(i)\\,a_{ij}\\bigr],\n$$\n初始化为 $\\delta_{1}(j)=\\pi_{j}\\,b_{j}(o_{1})$。\n\n当 $t=1$ 时，$o_{1}=A$ 的初始化给出\n$$\n\\delta_{1}(S_{1})=1\\cdot b_{1}(A)=0.8,\\qquad \\delta_{1}(S_{2})=0\\cdot b_{2}(A)=0.\n$$\n\n当 $t=2$ 时，$o_{2}=B$ 的递归：\n- 对于 $S_{1}$，\n$$\n\\delta_{2}(S_{1})=\\max\\{\\,\\delta_{1}(S_{1})a_{11},\\,\\delta_{1}(S_{2})a_{21}\\,\\}\\,b_{1}(B)=\\max\\{0.8\\cdot 0.6,\\,0\\cdot 0.5\\}\\cdot 0.2=0.48\\cdot 0.2=0.096,\n$$\n因此 $\\psi_{2}(S_{1})=S_{1}$。\n- 对于 $S_{2}$，\n$$\n\\delta_{2}(S_{2})=\\max\\{\\,\\delta_{1}(S_{1})a_{12},\\,\\delta_{1}(S_{2})a_{22}\\,\\}\\,b_{2}(B)=\\max\\{0.8\\cdot 0.4,\\,0\\cdot 0.5\\}\\cdot 0.3=0.32\\cdot 0.3=0.096,\n$$\n因此 $\\psi_{2}(S_{2})=S_{1}$。\n\n终止步骤通过最大化 $\\delta_{2}(j)$ 来选择结束状态 $q_{2}^{*}$。由于 $\\delta_{2}(S_{1})=\\delta_{2}(S_{2})=0.096$，出现了一个平局，因此在回溯时存在两个最优的结束状态，从而有两个最优的状态序列：\n- 在 $S_{1}$ 结束：$(q_{1},q_{2})=(\\psi_{2}(S_{1}),S_{1})=(S_{1},S_{1})$。\n- 在 $S_{2}$ 结束：$(q_{1},q_{2})=(\\psi_{2}(S_{2}),S_{2})=(S_{1},S_{2})$。\n\n等价地，联合路径-观测概率也证实了平局：\n$$\nP(S_{1},S_{1},A,B)=1\\cdot 0.8\\cdot 0.6\\cdot 0.2=0.096,\\qquad\nP(S_{1},S_{2},A,B)=1\\cdot 0.8\\cdot 0.4\\cdot 0.3=0.096,\n$$\n而任何从 $S_{2}$ 开始的路径的概率都为 $0$，这是由初始条件决定的。因此，两个最可能的序列是 $(S_{1},S_{1})$ 和 $(S_{1},S_{2})$，这对应于选项 C。", "answer": "$$\\boxed{C}$$", "id": "1664321"}, {"introduction": "维特比算法的强大之处不仅在于其标准形式，更在于其动态规划思想的灵活性。这个更具挑战性的练习[@problem_id:1345434]将引导你思考如何扩展算法以处理带有“全局约束”的问题，例如，要求整个路径中某个特定状态必须出现固定次数。通过修改动态规划的状态定义，你将学会如何将复杂约束融入算法中，这是解决更高级实际问题的关键一步。", "problem": "一个化学反应器的状态通过一个基于隐马尔可夫模型（HMM）的简化模型进行监测。该反应器可能处于三种隐状态之一：$S_1$（低）、$S_2$（中）或 $S_3$（高）。在每个离散时间步，一个传感器记录反应器的外部温度，该温度可能是三种可观测状态之一：$O_1$（冷）、$O_2$（暖）或 $O_3$（热）。\n\n该HMM由以下参数定义：\n\n1.  **初始状态概率 ($\\pi$)**: 系统在时间 $t=1$ 时处于各个初始状态的概率。\n    $\\pi_1 = P(q_1=S_1) = 0.6$\n    $\\pi_2 = P(q_1=S_2) = 0.2$\n    $\\pi_3 = P(q_1=S_3) = 0.2$\n\n2.  **状态转移概率矩阵 ($A$)**: 矩阵 $A = [a_{ij}]$，其中 $a_{ij} = P(q_{t+1}=S_j | q_t=S_i)$ 是从状态 $S_i$ 转移到状态 $S_j$ 的概率。\n    $$\n    A = \\begin{pmatrix}\n    0.7 & 0.2 & 0.1 \\\\\n    0.3 & 0.4 & 0.3 \\\\\n    0.1 & 0.3 & 0.6\n    \\end{pmatrix}\n    $$\n\n3.  **发射概率矩阵 ($B$)**: 矩阵 $B = [b_j(k)]$，其中 $b_j(k) = P(v_t=O_k | q_t=S_j)$ 是当系统处于状态 $S_j$ 时观测到 $O_k$ 的概率。\n    $$\n    B = \\begin{pmatrix}\n    0.80 & 0.15 & 0.05 \\\\\n    0.20 & 0.60 & 0.20 \\\\\n    0.05 & 0.15 & 0.80\n    \\end{pmatrix}\n    $$\n    在这里，行对应隐状态（$S_1, S_2, S_3$），列对应观测值（$O_1, O_2, O_3$）。例如，$b_1(2) = P(v_t=O_2|q_t=S_1) = 0.15$。\n\n现已记录一个长度为 $T=4$ 的观测序列：$V = (O_1, O_2, O_2, O_3)$，对应于（冷，暖，暖，热）。为了进行安全分析，需要确定生成此观测序列的最可能隐状态序列，但需满足一个全局约束：反应器必须在“中” (Medium) 状态（$S_2$）下精确地停留 $k=2$ 个时间步。\n\n计算这个最可能状态序列的概率。将最终答案四舍五入到四位有效数字。", "solution": "该问题要求在给定一个观测序列和特定状态出现次数的全局约束下，找出最可能的隐状态序列的概率。标准的维特比（Viterbi）算法可以找到最可能的路径，但无法处理此类全局约束。我们必须通过扩充状态定义来修改动态规划方法。\n\n设隐状态为 $\\{S_1, S_2, S_3\\}$，观测序列为 $V = (v_1, v_2, v_3, v_4)$，其中 $v_1=O_1, v_2=O_2, v_3=O_2, v_4=O_3$。特殊状态是 $S_2$，约束条件是它在长度为 $T=4$ 的路径中必须恰好出现 $k=2$ 次。\n\n我们定义一个新的动态规划变量 $\\delta_t(j, m)$，表示任意长度为 $t$ 的路径，该路径在状态 $S_j$ 结束，生成了前 $t$ 个观测值 $v_1, ..., v_t$，并且精确包含 $m$ 次特殊状态 $S_2$ 的最大概率。\n\n递归结构如下：\n\n**1. 初始化 (t=1):**\n观测值为 $v_1=O_1$。如果状态是 $S_2$，则计数 $m$ 为 1，否则为 0。\n$\\delta_1(j, m) = \\pi_j \\cdot b_j(v_1)$\n- 对于 $j=1$（状态 $S_1$，非特殊），$m=0$:\n$\\delta_1(1, 0) = \\pi_1 \\cdot b_1(O_1) = 0.6 \\cdot 0.8 = 0.48$\n- 对于 $j=2$（状态 $S_2$，特殊），$m=1$:\n$\\delta_1(2, 1) = \\pi_2 \\cdot b_2(O_1) = 0.2 \\cdot 0.2 = 0.04$\n- 对于 $j=3$（状态 $S_3$，非特殊），$m=0$:\n$\\delta_1(3, 0) = \\pi_3 \\cdot b_3(O_1) = 0.2 \\cdot 0.05 = 0.01$\n所有其他的 $\\delta_1(j, m)$ 值均为零。\n\n**2. 递归 (t=2, 3, 4):**\n对于 $t > 1$，我们根据 $t-1$ 时的值计算 $\\delta_t(j, m)$。\n特殊状态的计数 $m$ 要么增加，要么保持不变。\n- 如果当前状态 $S_j$ **不是**特殊状态 $S_2$（即 $j=1$ 或 $j=3$）：计数 $m$ 与上一步相比不发生变化。\n$$ \\delta_t(j, m) = b_j(v_t) \\cdot \\max_{i=1,2,3} \\left[ \\delta_{t-1}(i, m) \\cdot a_{ij} \\right] $$\n- 如果当前状态 $S_j$ **是**特殊状态 $S_2$（即 $j=2$）：计数 $m$ 在上一步必须是 $m-1$。\n$$ \\delta_t(2, m) = b_2(v_t) \\cdot \\max_{i=1,2,3} \\left[ \\delta_{t-1}(i, m-1) \\cdot a_{i2} \\right] $$\n\n让我们一步步计算表格。\n\n**时间 t=2 (观测值 $v_2=O_2$):**\n- $\\delta_2(1, m=0)$: (非特殊) $b_1(O_2)=0.15$。来自 $t=1$ 时的 $m=0$。\n$\\delta_2(1, 0) = 0.15 \\cdot \\max[\\delta_1(1,0)a_{11}, \\delta_1(3,0)a_{31}] = 0.15 \\cdot \\max[0.48 \\cdot 0.7, 0.01 \\cdot 0.1] = 0.15 \\cdot 0.336 = 0.0504$\n- $\\delta_2(1, m=1)$: (非特殊) $b_1(O_2)=0.15$。来自 $t=1$ 时的 $m=1$。\n$\\delta_2(1, 1) = 0.15 \\cdot \\max[\\delta_1(2,1)a_{21}] = 0.15 \\cdot [0.04 \\cdot 0.3] = 0.0018$\n- $\\delta_2(2, m=1)$: (特殊) $b_2(O_2)=0.6$。来自 $t=1$ 时的 $m=0$。\n$\\delta_2(2, 1) = 0.6 \\cdot \\max[\\delta_1(1,0)a_{12}, \\delta_1(3,0)a_{32}] = 0.6 \\cdot \\max[0.48 \\cdot 0.2, 0.01 \\cdot 0.3] = 0.6 \\cdot 0.096 = 0.0576$\n- $\\delta_2(2, m=2)$: (特殊) $b_2(O_2)=0.6$。来自 $t=1$ 时的 $m=1$。\n$\\delta_2(2, 2) = 0.6 \\cdot \\max[\\delta_1(2,1)a_{22}] = 0.6 \\cdot [0.04 \\cdot 0.4] = 0.0096$\n- $\\delta_2(3, m=0)$: (非特殊) $b_3(O_2)=0.15$。来自 $t=1$ 时的 $m=0$。\n$\\delta_2(3, 0) = 0.15 \\cdot \\max[\\delta_1(1,0)a_{13}, \\delta_1(3,0)a_{33}] = 0.15 \\cdot \\max[0.48 \\cdot 0.1, 0.01 \\cdot 0.6] = 0.15 \\cdot 0.048 = 0.0072$\n- $\\delta_2(3, m=1)$: (非特殊) $b_3(O_2)=0.15$。来自 $t=1$ 时的 $m=1$。\n$\\delta_2(3, 1) = 0.15 \\cdot \\max[\\delta_1(2,1)a_{23}] = 0.15 \\cdot [0.04 \\cdot 0.3] = 0.0018$\n\n**时间 t=3 (观测值 $v_3=O_2$):**\n- $\\delta_3(1, m=1)$: (非特殊，来自 t=2 时的 m=1) $b_1(O_2)=0.15$。\n$\\delta_3(1, 1) = 0.15 \\cdot \\max[\\delta_2(1,1)a_{11}, \\delta_2(2,1)a_{21}, \\delta_2(3,1)a_{31}] = 0.15 \\cdot \\max[0.0018 \\cdot 0.7, 0.0576 \\cdot 0.3, 0.0018 \\cdot 0.1] = 0.15 \\cdot \\max[0.00126, 0.01728, 0.00018] = 0.15 \\cdot 0.01728 = 0.002592$\n- $\\delta_3(1, m=2)$: (非特殊，来自 t=2 时的 m=2) $b_1(O_2)=0.15$。\n$\\delta_3(1, 2) = 0.15 \\cdot \\max[\\delta_2(2,2)a_{21}] = 0.15 \\cdot [0.0096 \\cdot 0.3] = 0.000432$\n- $\\delta_3(2, m=1)$: (特殊，来自 t=2 时的 m=0) $b_2(O_2)=0.6$。\n$\\delta_3(2, 1) = 0.6 \\cdot \\max[\\delta_2(1,0)a_{12}, \\delta_2(3,0)a_{32}] = 0.6 \\cdot \\max[0.0504 \\cdot 0.2, 0.0072 \\cdot 0.3] = 0.6 \\cdot 0.01008 = 0.006048$\n- $\\delta_3(2, m=2)$: (特殊，来自 t=2 时的 m=1) $b_2(O_2)=0.6$。\n$\\delta_3(2, 2) = 0.6 \\cdot \\max[\\delta_2(1,1)a_{12}, \\delta_2(2,1)a_{22}, \\delta_2(3,1)a_{32}] = 0.6 \\cdot \\max[0.0018 \\cdot 0.2, 0.0576 \\cdot 0.4, 0.0018 \\cdot 0.3] = 0.6 \\cdot \\max[0.00036, 0.02304, 0.00054] = 0.6 \\cdot 0.02304 = 0.013824$\n- $\\delta_3(3, m=1)$: (非特殊，来自 t=2 时的 m=1) $b_3(O_2)=0.15$。\n$\\delta_3(3, 1) = 0.15 \\cdot \\max[\\delta_2(1,1)a_{13}, \\delta_2(2,1)a_{23}, \\delta_2(3,1)a_{33}] = 0.15 \\cdot \\max[0.0018 \\cdot 0.1, 0.0576 \\cdot 0.3, 0.0018 \\cdot 0.6] = 0.15 \\cdot 0.01728 = 0.002592$\n- $\\delta_3(3, m=2)$: (非特殊，来自 t=2 时的 m=2) $b_3(O_2)=0.15$。\n$\\delta_3(3, 2) = 0.15 \\cdot \\max[\\delta_2(2,2)a_{23}] = 0.15 \\cdot [0.0096 \\cdot 0.3] = 0.000432$\n（我们也计算了其他值，如 $\\delta_3(j,0)$、$\\delta_3(j,3)$，但最终 $k=2$ 的计算不需要它们。）\n\n**时间 t=4 (观测值 $v_4=O_3$):**\n我们关心的是 $S_2$ 恰好出现 $k=2$ 次的路径。我们只需要计算 $\\delta_4(j, 2)$。\n\n- $\\delta_4(1, 2)$: (非特殊，来自 t=3 时的 m=2) $b_1(O_3)=0.05$。\n$\\delta_4(1, 2) = 0.05 \\cdot \\max[\\delta_3(1,2)a_{11}, \\delta_3(2,2)a_{21}, \\delta_3(3,2)a_{31}] = 0.05 \\cdot \\max[0.000432 \\cdot 0.7, 0.013824 \\cdot 0.3, 0.000432 \\cdot 0.1] = 0.05 \\cdot \\max[0.0003024, 0.0041472, 0.0000432] = 0.05 \\cdot 0.0041472 = 0.00020736$\n\n- $\\delta_4(2, 2)$: (特殊，来自 t=3 时的 m=1) $b_2(O_3)=0.2$。\n$\\delta_4(2, 2) = 0.2 \\cdot \\max[\\delta_3(1,1)a_{12}, \\delta_3(2,1)a_{22}, \\delta_3(3,1)a_{32}] = 0.2 \\cdot \\max[0.002592 \\cdot 0.2, 0.006048 \\cdot 0.4, 0.002592 \\cdot 0.3] = 0.2 \\cdot \\max[0.0005184, 0.0024192, 0.0007776] = 0.2 \\cdot 0.0024192 = 0.00048384$\n\n- $\\delta_4(3, 2)$: (非特殊，来自 t=3 时的 m=2) $b_3(O_3)=0.8$。\n$\\delta_4(3, 2) = 0.8 \\cdot \\max[\\delta_3(1,2)a_{13}, \\delta_3(2,2)a_{23}, \\delta_3(3,2)a_{33}] = 0.8 \\cdot \\max[0.000432 \\cdot 0.1, 0.013824 \\cdot 0.3, 0.000432 \\cdot 0.6] = 0.8 \\cdot \\max[0.0000432, 0.0041472, 0.0002592] = 0.8 \\cdot 0.0041472 = 0.00331776$\n\n**3. 终止:**\n满足约束条件的最可能路径的概率，是所有长度为 $T=4$ 且恰好包含 $k=2$ 个特殊状态的路径概率的最大值。\n$P^* = \\max_{j=1,2,3} \\delta_4(j, k=2)$\n$P^* = \\max[\\delta_4(1, 2), \\delta_4(2, 2), \\delta_4(3, 2)]$\n$P^* = \\max[0.00020736, 0.00048384, 0.00331776] = 0.00331776$\n\n四舍五入到四位有效数字，我们得到 $0.003318$。\n用科学计数法表示，即为 $3.318 \\times 10^{-3}$。", "answer": "$$\\boxed{3.318 \\times 10^{-3}}$$", "id": "1345434"}]}