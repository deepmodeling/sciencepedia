{"hands_on_practices": [{"introduction": "在使用时间序列模型进行预测或分析之前，首要任务是确保模型的稳定性。对于自回归（AR）模型而言，平稳性是一个核心要求，它保证了模型的统计特性（如均值和方差）不随时间改变。本练习将指导你通过分析一个AR(2)模型特征多项式的根来检验其平稳性，这是模型有效性的基本前提，也是时间序列分析中的一个关键步骤 [@problem_id:1312127]。", "problem": "一位分析师正在使用一个二阶自回归(AR)模型对一个金融时间序列（记为过程 $\\{X_t\\}$）进行建模。一个 AR(2) 过程通常由方程 $X_t = c + \\phi_1 X_{t-1} + \\phi_2 X_{t-2} + Z_t$ 定义，其中 $Z_t$ 是一个零均值的白噪声过程。对于这个特定模型，常数项 $c$ 为零，模型由下式给出：\n\n$$X_t = X_{t-1} - 0.25 X_{t-2} + Z_t$$\n\n该模型的稳定性和性质由其特征多项式 $P(z)$ 决定，该多项式由自回归系数导出。一个关键属性是平稳性，它要求特征方程 $P(z)=0$ 的所有根都位于复平面的单位圆之外（即，每个根的模都必须大于1）。\n\n给定该模型，请确定其特征多项式以及该过程是否平稳。下列哪个陈述是正确的？\n\nA. 特征多项式为 $P(z) = 1 - z + 0.25z^2$，且过程是平稳的。\nB. 特征多项式为 $P(z) = 1 - z + 0.25z^2$，且过程不是平稳的。\nC. 特征多项式为 $P(z) = 1 + z - 0.25z^2$，且过程不是平稳的。\nD. 特征多项式为 $P(z) = z^2 - z + 0.25$，且过程不是平稳的。", "solution": "对于一个 AR(2) 过程 $X_t = \\phi_1 X_{t-1} + \\phi_2 X_{t-2} + Z_t$，以滞后算子 $B$ 表示的自回归多项式是 $\\phi(B) = 1 - \\phi_1 B - \\phi_2 B^2$，它是通过将方程重排为 $\\phi(B)X_t = Z_t$ 得到的。那么以复变量 $z$ 表示的特征多项式是 $P(z) = 1 - \\phi_1 z - \\phi_2 z^2$。\n\n在给定的模型 $X_t = X_{t-1} - 0.25 X_{t-2} + Z_t$ 中，我们确定 $\\phi_1=1$ 和 $\\phi_2=-0.25$。因此，\n$$\nP(z) = 1 - \\phi_1 z - \\phi_2 z^2 = 1 - z + 0.25 z^2\n$$\n\n为了评估平稳性，我们求解 $P(z)=0$ 并要求所有根都满足 $|z|>1$。求解\n$$\n0.25 z^2 - z + 1 = 0\n$$\n当 $a=0.25$，$b=-1$，$c=1$ 时，判别式为\n$$\n\\Delta = b^2 - 4ac = 1 - 4 \\cdot 0.25 \\cdot 1 = 0\n$$\n所以有一个重根\n$$\nz = \\frac{-b}{2a} = \\frac{1}{0.5} = 2\n$$\n因为 $|2|>1$，所有的根都位于单位圆之外，所以该过程是平稳的。\n\n因此，正确的陈述是 $P(z)=1-z+0.25z^2$ 且该过程是平稳的。", "answer": "$$\\boxed{A}$$", "id": "1312127"}, {"introduction": "确保模型平稳后，下一个挑战是如何将理论模型与观测数据联系起来。本练习将具体展示模型参数（例如AR(1)模型中的系数 $\\phi$）与数据的内在结构——自相关函数（ACF）——之间的直接数学关系。通过从已知的相关性反推模型参数，你将亲身体验模型识别的核心逻辑，即如何根据数据的“记忆”模式来确定最合适的模型 [@problem_id:1925246]。", "problem": "一位研究者对某一大气测量值 $X_t$ 与其长期平均值之间的每日偏差进行建模。该过程被假定为平稳的，并可用一个一阶自回归(AR(1))模型来描述：\n$$X_t = \\phi X_{t-1} + W_t$$\n此处，$\\phi$ 是一个常数参数，$W_t$ 是一个白噪声过程，意味着 $W_t$ 是均值为零、方差为常数 $\\sigma^2_W$ 的独立同分布随机变量。噪声 $W_t$ 也与过程的所有过去值不相关，即对于所有 $k > 0$都有 $E[X_{t-k} W_t] = 0$。\n\n对数据的经验分析表明，第 $t$ 天的测量值与第 $t-2$ 天的测量值之间的相关性恰好为 $1/4$。\n\n请确定与此观测结果一致的参数 $\\phi$ 的所有可能的实数值。", "solution": "我们考虑由 $X_t = \\phi X_{t-1} + W_t$ 定义的平稳AR(1)过程，其中 $\\{W_t\\}$ 为白噪声，均值为零，方差为 $\\sigma_W^2$，且与过去的 $\\{X_{t-k}:k>0\\}$不相关。令 $\\gamma(k)=\\operatorname{Cov}(X_t, X_{t-k})$ 表示自协方差函数，$\\rho(k)=\\gamma(k)/\\gamma(0)$ 表示自相关函数。\n\n为推导 Yule-Walker 关系式，将 AR(1) 方程两边同乘以 $X_{t-k}$ 并对 $k\\geq 1$ 取期望：\n$$\n\\operatorname{E}[X_t X_{t-k}] = \\phi\\,\\operatorname{E}[X_{t-1}X_{t-k}]+\\operatorname{E}[W_t X_{t-k}]\n$$\n根据不相关的假设，对于 $k>0$，有 $\\operatorname{E}[W_t X_{t-k}]=0$。利用平稳性，$\\operatorname{E}[X_t X_{t-k}]=\\gamma(k)$ 且 $\\operatorname{E}[X_{t-1}X_{t-k}]=\\gamma(k-1)$，这给出了递归关系\n$$\n\\gamma(k)=\\phi\\,\\gamma(k-1), \\quad k\\geq 1.\n$$\n将此关系应用两次，\n$$\n\\gamma(2)=\\phi\\,\\gamma(1)=\\phi^2 \\gamma(0),\n$$\n因此滞后2阶的自相关为\n$$\n\\rho(2)=\\frac{\\gamma(2)}{\\gamma(0)}=\\phi^2\n$$\n经验观测值为 $\\rho(2)=\\frac{1}{4}$，因此\n$$\n\\phi^2 = \\frac{1}{4} \\quad \\Longrightarrow \\quad \\phi=\\pm \\frac{1}{2}\n$$\nAR(1)过程的平稳性条件是 $|\\phi|<1$，两个解都满足此条件。因此，这两个值都是可接受的。", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{1}{2} & \\frac{1}{2}\\end{pmatrix}}$$", "id": "1925246"}, {"introduction": "时间序列分析不仅涉及模型理论，还关乎数据处理的实践智慧。一个常见的操作是数据平滑，但本练习揭示了一个重要的警示：平滑处理本身可能会在完全随机的数据中引入虚假的结构性模式，如自相关。通过计算一个简单的移动平均如何改变白噪声序列的特性，你将理解数据预处理可能带来的非预期后果，这对于避免错误结论至关重要 [@problem_id:1925233]。", "problem": "一位分析师正在研究一个每日资产回报率的时间序列 $\\{X_t\\}$，并将其建模为白噪声过程。这意味着对于任意整数时间指数 $t$，回报率的期望值为 $E[X_t] = 0$，方差为 $Var(X_t) = \\sigma^2$（其中 $\\sigma^2 > 0$ 为常数），且不同日的回报率不相关，即当 $t \\neq s$ 时，$Cov(X_t, X_s) = 0$。\n\n为降低每日的显著波动性，该分析师通过应用一个简单的双周期移动平均，创建了一个新的平滑时间序列 $\\{S_t\\}$，其定义如下：\n$$S_t = \\frac{1}{2}(X_t + X_{t-1})$$\n虽然这种平滑过程旨在使潜在模式更易于观察，但它也可能在新的序列中引入原始数据中不存在的统计相关性。您的任务是量化这种效应。\n\n计算平滑序列 $\\{S_t\\}$ 在滞后 1 时的理论自相关。", "solution": "目标是计算时间序列 $\\{S_t\\}$ 在滞后 1 时的自相关，记作 $\\rho_S(1)$。对于一个平稳过程，其在滞后 $k$ 时的自相关函数定义为其在滞后 $k$ 时的自协方差与方差的比值。\n$$ \\rho_S(k) = \\frac{\\gamma_S(k)}{\\gamma_S(0)} $$\n其中 $\\gamma_S(k) = Cov(S_t, S_{t-k})$ 是 $\\{S_t\\}$ 的自协方差函数，$\\gamma_S(0) = Var(S_t)$ 是 $\\{S_t\\}$ 的方差。我们需要计算 $\\gamma_S(0)$ 和 $\\gamma_S(1)$。\n\n首先，我们确定原始白噪声过程 $\\{X_t\\}$ 的性质。给定条件如下：\n1.  对所有 $t$，$E[X_t] = 0$。\n2.  对所有 $t$，$Var(X_t) = E[X_t^2] - (E[X_t])^2 = E[X_t^2] = \\sigma^2$。\n3.  当 $t \\neq s$ 时，$Cov(X_t, X_s) = E[X_t X_s] - E[X_t]E[X_s] = E[X_t X_s] = 0$。\n\n平滑序列定义为 $S_t = \\frac{1}{2}(X_t + X_{t-1})$。我们首先检验 $\\{S_t\\}$ 是否为一个零均值过程。\n$$ E[S_t] = E\\left[\\frac{1}{2}(X_t + X_{t-1})\\right] = \\frac{1}{2}(E[X_t] + E[X_{t-1}]) = \\frac{1}{2}(0 + 0) = 0 $$\n由于均值为零且不随时间变化，并且 $S_t$ 的结构是时不变的，我们可以继续计算其方差和自协方差。\n\n接下来，我们计算 $S_t$ 的方差，也就是滞后 0 时的自协方差 $\\gamma_S(0)$。\n$$ \\gamma_S(0) = Var(S_t) = Var\\left(\\frac{1}{2}(X_t + X_{t-1})\\right) $$\n使用性质 $Var(aY) = a^2 Var(Y)$，我们得到：\n$$ \\gamma_S(0) = \\left(\\frac{1}{2}\\right)^2 Var(X_t + X_{t-1}) = \\frac{1}{4} Var(X_t + X_{t-1}) $$\n由于 $X_t$ 和 $X_{t-1}$ 不相关（因为它们来自白噪声过程在不同时间步长的值），它们的和的方差等于它们方差的和：\n$$ Var(X_t + X_{t-1}) = Var(X_t) + Var(X_{t-1}) = \\sigma^2 + \\sigma^2 = 2\\sigma^2 $$\n将此结果代回，我们求得 $S_t$ 的方差：\n$$ \\gamma_S(0) = \\frac{1}{4}(2\\sigma^2) = \\frac{\\sigma^2}{2} $$\n\n现在，我们计算 $S_t$ 在滞后 1 时的自协方差 $\\gamma_S(1)$。\n$$ \\gamma_S(1) = Cov(S_t, S_{t-1}) $$\n由于 $E[S_t]=0$，协方差就是其乘积的期望值：\n$$ \\gamma_S(1) = E[S_t S_{t-1}] = E\\left[ \\left(\\frac{1}{2}(X_t + X_{t-1})\\right) \\left(\\frac{1}{2}(X_{t-1} + X_{t-2})\\right) \\right] $$\n$$ \\gamma_S(1) = \\frac{1}{4} E[(X_t + X_{t-1})(X_{t-1} + X_{t-2})] $$\n我们展开期望内的乘积：\n$$ \\gamma_S(1) = \\frac{1}{4} E[X_t X_{t-1} + X_t X_{t-2} + X_{t-1}^2 + X_{t-1}X_{t-2}] $$\n利用期望算子的线性性质：\n$$ \\gamma_S(1) = \\frac{1}{4} (E[X_t X_{t-1}] + E[X_t X_{t-2}] + E[X_{t-1}^2] + E[X_{t-1}X_{t-2}]) $$\n现在我们使用白噪声过程 $\\{X_t\\}$ 的性质：\n-   $E[X_t X_{t-1}] = Cov(X_t, X_{t-1}) = 0$ (因为 $t \\neq t-1$)\n-   $E[X_t X_{t-2}] = Cov(X_t, X_{t-2}) = 0$ (因为 $t \\neq t-2$)\n-   $E[X_{t-1}^2] = Var(X_{t-1}) = \\sigma^2$\n-   $E[X_{t-1}X_{t-2}] = Cov(X_{t-1}, X_{t-2}) = 0$ (因为 $t-1 \\neq t-2$)\n\n将这些值代入 $\\gamma_S(1)$ 的表达式中：\n$$ \\gamma_S(1) = \\frac{1}{4} (0 + 0 + \\sigma^2 + 0) = \\frac{\\sigma^2}{4} $$\n\n最后，我们可以通过计算滞后 1 的自协方差与方差的比值来求得滞后 1 的自相关 $\\rho_S(1)$。\n$$ \\rho_S(1) = \\frac{\\gamma_S(1)}{\\gamma_S(0)} = \\frac{\\frac{\\sigma^2}{4}}{\\frac{\\sigma^2}{2}} $$\n$$ \\rho_S(1) = \\frac{\\sigma^2}{4} \\cdot \\frac{2}{\\sigma^2} = \\frac{2}{4} = \\frac{1}{2} $$\n参数 $\\sigma^2$ 被消去，得到一个滞后 1 自相关的恒定值。这表明平滑操作确实在新的序列 $\\{S_t\\}$ 的连续项之间引入了正相关性。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1925233"}]}