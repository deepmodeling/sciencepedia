{"hands_on_practices": [{"introduction": "理解一个抽象定理的最好方法就是亲身实践。本节的第一个练习将我们带入随机过程停止时间的具体计算中。这个问题，模拟了生物技术中聚合物链的合成，要求我们计算一个特定单体序列首次出现所需的期望步数。虽然这个问题可以通过基本的一步分析法解决，但它完美地引入了“停时”这一核心概念，并为我们使用更强大的鞅工具解决复杂问题奠定了直观基础。[@problem_id:1298898]", "problem": "一个生物技术实验室正在研究一种长聚合物链的合成。该过程在每一步添加两种单体中的一种：嘌呤 (R) 或嘧啶 (Y)。这个过程被建模为一系列独立同分布 (i.i.d.) 的随机试验。在每一步中，添加一个嘌呤 (R) 的概率是 $p = 0.4$，添加一个嘧啶 (Y) 的概率是 $q = 1-p = 0.6$。\n\n只有当由4个单体组成的序列 RYRY 首次出现时，一种特定的生物功能才会被激活。您的任务是计算为了首次观察到这个目标序列 RYRY，必须添加到链中的单体的期望数量。\n\n将您的最终答案以一个四位有效数字的数字形式报告。", "solution": "设单体序列为一个独立同分布过程，其符号为 $R$ 和 $Y$，其中 $\\Pr(R)=p$ 且 $\\Pr(Y)=q=1-p$。我们要求解在模式 $P=\\text{RYRY}$ 首次出现之前所需的单体期望数量。\n\n通过 $P$ 的最长前缀同时也是当前序列的后缀的长度来对演化过程建模。定义状态 $0,1,2,3,4$，其中状态 $k$ 表示最后 $k$ 个符号与 $P[1..k]$ 匹配，状态 $4$ 是吸收态（找到模式）。根据标准的前缀函数逻辑，状态转移如下：\n- 从 $0$：$R \\to 1$, $Y \\to 0$。\n- 从 $1$ (匹配 $R$)：$R \\to 1$, $Y \\to 2$。\n- 从 $2$ (匹配 $RY$)：$R \\to 3$, $Y \\to 0$。\n- 从 $3$ (匹配 $RYR$)：$R \\to 1$, $Y \\to 4$。\n- 从 $4$：吸收态。\n\n设 $E_{k}$ 为从状态 $k$ 开始到达状态 $4$ 所需的期望剩余步数。那么 $E_{4}=0$，且对于 $k<4$，\n$$\nE_{k}=1+p\\,E_{f(k,R)}+q\\,E_{f(k,Y)}.\n$$\n使用上述转移关系，我们得到\n$$\n\\begin{aligned}\nE_{0}&=1+pE_{1}+qE_{0},\\\\\nE_{1}&=1+pE_{1}+qE_{2},\\\\\nE_{2}&=1+pE_{3}+qE_{0},\\\\\nE_{3}&=1+pE_{1}+qE_{4}=1+pE_{1}.\n\\end{aligned}\n$$\n进行符号求解。从 $E_{0}=1+pE_{1}+qE_{0}$，我们得到 $pE_{0}=1+pE_{1}$，因此\n$$\nE_{0}=\\frac{1}{p}+E_{1}.\n$$\n从 $E_{1}=1+pE_{1}+qE_{2}$，我们得到 $qE_{1}=1+qE_{2}$，因此\n$$\nE_{1}=\\frac{1}{q}+E_{2}.\n$$\n从 $E_{3}=1+pE_{1}$ 和 $E_{2}=1+pE_{3}+qE_{0}$，我们得到\n$$\nE_{2}=1+p(1+pE_{1})+qE_{0}=1+p+p^{2}E_{1}+qE_{0}.\n$$\n代入 $E_0 = \\frac{1}{p}+E_1$ 和 $E_2 = E_1 - \\frac{1}{q}$：\n$$\nE_1 - \\frac{1}{q} = 1+p+p^2E_1 + q\\left(\\frac{1}{p}+E_1\\right)\n$$\n$$\nE_1 - \\frac{1}{q} = 1+p+\\frac{q}{p} + (p^2+q)E_1\n$$\n$$\n(1 - p^2 - q)E_1 = 1+p+\\frac{q}{p}+\\frac{1}{q}\n$$\n因为 $1-p^2-q = 1-p^2-(1-p) = p-p^2 = p(1-p) = pq$，我们有：\n$$\npq E_1 = 1+p+\\frac{q}{p}+\\frac{1}{q}\n$$\n并且因为 $q=1-p \\implies 1+p+q=2$:\n$$\nE_0 = \\frac{1}{p}+E_1 = \\frac{1}{p} + \\frac{1+p+\\frac{q}{p}+\\frac{1}{q}}{pq} = \\frac{q + 1+p+\\frac{q}{p}+\\frac{1}{q}}{pq} = \\frac{2+\\frac{q}{p}+\\frac{1}{q}}{pq}\n$$\n现在代入 $p=0.4$ 和 $q=0.6$：\n$$\nE_{0}=\\frac{2+\\frac{0.6}{0.4}+\\frac{1}{0.6}}{0.4\\times 0.6}=\\frac{2+1.5+1.666\\ldots}{0.24}=\\frac{5.166\\ldots}{0.24}=\\frac{775}{36}\\approx 21.527777\\ldots\n$$\n四舍五入到四位有效数字，期望的单体数量是 $21.53$。", "answer": "$$\\boxed{21.53}$$", "id": "1298898"}, {"introduction": "在掌握了停时的基本概念后，我们来探讨可选停止定理的一个经典应用：计算命中概率。这个问题描绘了一个独特的洗牌过程，本质上是一个“赌徒破产”问题的变体，即过程在到达两个边界之一时停止。解决此问题的关键在于巧妙地构造一个鞅过程，一旦找到这个鞅，可选停止定理便能让我们以惊人地简洁的方式直接求出所需的概率。[@problem_id:1298885]", "problem": "考虑一副有 $N$ 张牌的牌堆，其中有一张被特别指定为“目标”牌。在每个时间步，牌堆按照以下程序进行重排：\n1. 从整副 $N$ 张牌中均匀随机地选择一张牌（即，每张牌被选中的概率为 $1/N$）。\n2. 如果选中的是目标牌本身，则将目标牌移到牌堆顶部（位置 1）。\n3. 如果选中的不是目标牌，且其当前位置在目标牌*上方*，则目标牌向下移动一个位置（例如，从位置 $p$ 移动到 $p+1$）。\n4. 如果选中的不是目标牌，且其当前位置在目标牌*下方*，则目标牌的位置保持不变。\n\n所有其他牌根据需要进行移动，以适应目标牌的移动，同时保持它们的相对顺序。位置从 $1$（顶部）到 $N$（底部）编号。\n\n该过程开始时，目标牌位于初始位置 $p_0$。当目标牌的位置首次到达“目标”位置 $k$ 或“惩罚”位置 1 时，该过程停止。\n\n已知整数参数满足 $1 < p_0 < k \\le N$，求目标牌在到达惩罚位置 1 之前先到达目标位置 $k$ 的概率。将你的答案表示为 $p_0$ 和 $k$ 的函数。", "solution": "令 $f(p)$ 表示从目标牌在位置 $p$ 开始，该过程在到达惩罚位置 1 之前先到达目标位置 $k$ 的概率。我们有边界条件 $f(1)=0$ 和 $f(k)=1$。对于 $2 \\leq p \\leq k-1$，我们对随机选牌的结果应用全概率法则进行第一步分析。\n\n从位置 $p$ 开始：\n- 有 $\\frac{1}{N}$ 的概率，选中目标牌并将其移至位置 1，导致立即在惩罚位置被吸收，贡献为 $\\frac{1}{N}\\cdot f(1)=0$。\n- 有 $\\frac{p-1}{N}$ 的概率，选中目标牌上方的牌，因此目标牌移至 $p+1$，贡献为 $\\frac{p-1}{N} f(p+1)$。\n- 有 $\\frac{N-p}{N}$ 的概率，选中目标牌下方的牌，因此位置保持为 $p$，贡献为 $\\frac{N-p}{N} f(p)$。\n\n因此，对于 $2 \\leq p \\leq k-1$，\n$$\nf(p) \\;=\\; \\frac{p-1}{N} f(p+1) \\;+\\; \\frac{N-p}{N} f(p).\n$$\n整理得，\n$$\nf(p) - \\frac{N-p}{N} f(p) \\;=\\; \\frac{p-1}{N} f(p+1)\n\\;\\;\\Longrightarrow\\;\\;\n\\frac{p}{N} f(p) \\;=\\; \\frac{p-1}{N} f(p+1)\n\\;\\;\\Longrightarrow\\;\\;\np\\, f(p) \\;=\\; (p-1)\\, f(p+1).\n$$\n这个递推关系得出\n$$\nf(p+1) \\;=\\; \\frac{p}{p-1}\\, f(p),\n$$\n且通过归纳法，\n$$\nf(p) \\;=\\; (p-1)\\, f(2), \\quad \\text{for } 2 \\leq p \\leq k.\n$$\n应用边界条件 $f(k)=1$ 可得\n$$\n1 \\;=\\; f(k) \\;=\\; (k-1)\\, f(2) \\;\\;\\Longrightarrow\\;\\; f(2) \\;=\\; \\frac{1}{k-1}.\n$$\n因此，\n$$\nf(p) \\;=\\; \\frac{p-1}{k-1}, \\quad \\text{for } 2 \\leq p \\leq k.\n$$\n对于满足 $1 < p_{0} < k$ 的初始位置 $p_{0}$，所求概率为\n$$\nf(p_{0}) \\;=\\; \\frac{p_{0}-1}{k-1}.\n$$", "answer": "$$\\boxed{\\frac{p_{0}-1}{k-1}}$$", "id": "1298885"}, {"introduction": "现在，我们将探索的领域从离散步数扩展到连续时间，这是可选停止定理在随机分析中大放异彩的地方。本练习是随机过程理论中的一个基石问题：计算标准布朗运动首次离开一个给定区间所需的期望时间。这个问题不仅展示了该定理在连续时间下的强大威力，更重要的是，它迫使我们严谨地处理定理成立的条件，尤其是在停时无界的情况下，从而加深我们对理论严密性的理解。[@problem_id:2989359]", "problem": "设 $\\{B_{t}\\}_{t \\ge 0}$ 是在一个满足通常条件的域流的概率空间 $(\\Omega,\\mathcal{F},\\{\\mathcal{F}_{t}\\}_{t \\ge 0},\\mathbb{P})$ 上的一维标准布朗运动（BM），且 $B_{0}=0$。对于一个固定的常数 $a>0$，定义从开区间 $(-a,a)$ 的首次出时为\n$$\n\\tau_{-a,a} \\coloneqq \\inf\\{t \\ge 0 : B_{t} \\notin (-a,a)\\}.\n$$\n仅使用布朗运动的基本性质，包括伊藤公式（Itô’s formula）和二次变差 $[B]_{t}=t$，按以下步骤进行：\n- 证明过程 $M_{t} \\coloneqq B_{t}^{2}-t$ 是一个 $\\{\\mathcal{F}_{t}\\}$-鞅。\n- 证明 $\\mathbb{P}(\\tau_{-a,a}<\\infty)=1$。\n- 通过对有界停时 $\\tau_{-a,a}\\wedge n$（其中 $n\\in\\mathbb{N}$）应用可选停止定理 (OST)，然后令 $n \\to \\infty$ 并对所有极限步骤进行论证，仔细证明 $\\tau_{-a,a}$ 的可积性，并计算其期望 $\\mathbb{E}[\\tau_{-a,a}]$。\n\n请用含 $a$ 的闭式解析表达式表示你的最终答案。不需要数值近似。", "solution": "我们将按提出的顺序解决这三个任务。令 $\\tau = \\tau_{-a,a}$。\n\n**1. 证明 $M_{t} \\coloneqq B_{t}^{2}-t$ 是一个鞅**\n\n要证明 $M_t$ 是关于域流 $\\{\\mathcal{F}_t\\}_{t \\ge 0}$ 的一个鞅，我们必须证明三个性质：\ni. $M_t$ 对 $\\{\\mathcal{F}_t\\}$ 是适应的。\nii. $M_t$ 是可积的，即对所有 $t \\ge 0$ 有 $\\mathbb{E}[|M_t|] < \\infty$。\niii. 对所有 $s < t$，有 $\\mathbb{E}[M_t | \\mathcal{F}_s] = M_s$。\n\ni. 适应性：由于 $\\{B_t\\}_{t \\ge 0}$ 是一个 $\\{\\mathcal{F}_t\\}$-适应过程，因此对每个 $t \\ge 0$，$B_t^2$ 也是 $\\mathcal{F}_t$-适应的。函数 $g(t)=t$ 是确定性的，因此也是适应的。所以，它们的差 $M_t = B_t^2 - t$ 是 $\\mathcal{F}_t$-适应的。\n\nii. 可积性：对任意 $t \\ge 0$，我们有 $\\mathbb{E}[|M_t|] = \\mathbb{E}[|B_t^2 - t|] \\le \\mathbb{E}[B_t^2] + |t|$。由于 $B_t$ 是标准布朗运动，所以 $B_t \\sim N(0, t)$，其二阶矩为 $\\mathbb{E}[B_t^2] = \\text{Var}(B_t) + (\\mathbb{E}[B_t])^2 = t + 0^2 = t$。因此，$\\mathbb{E}[|M_t|] \\le t + t = 2t$。对任意有限的 $t$，$2t < \\infty$，所以 $M_t$ 是可积的。\n\niii. 鞅性质：我们对过程 $B_t$ 应用函数 $f(x) = x^2$ 的伊藤公式。我们有 $f'(x) = 2x$ 和 $f''(x) = 2$。伊藤公式表述为：\n$$\nf(B_t) - f(B_0) = \\int_0^t f'(B_s) dB_s + \\frac{1}{2} \\int_0^t f''(B_s) d[B]_s\n$$\n代入 $f(x)=x^2$ 及其导数，并使用给定条件 $B_0=0$ 和 $[B]_t=t$：\n$$\nB_t^2 - B_0^2 = \\int_0^t 2B_s dB_s + \\frac{1}{2} \\int_0^t 2 \\, d[B]_s\n$$\n$$\nB_t^2 - 0 = \\int_0^t 2B_s dB_s + \\int_0^t ds\n$$\n$$\nB_t^2 = 2\\int_0^t B_s dB_s + t\n$$\n重新整理各项，我们得到 $M_t$ 的表达式：\n$$\nM_t = B_t^2 - t = 2\\int_0^t B_s dB_s\n$$\n右边是一个伊藤积分。如果被积函数 $H_s$ 是一个满足 $\\mathbb{E}[\\int_0^t H_s^2 ds] < \\infty$ 的适应过程，则过程 $X_t = \\int_0^t H_s dB_s$ 是一个鞅。在这里，被积函数是 $H_s = 2B_s$，它是适应的。我们检查平方可积条件：\n$$\n\\mathbb{E}\\left[\\int_0^t (2B_s)^2 ds\\right] = 4 \\int_0^t \\mathbb{E}[B_s^2] ds = 4 \\int_0^t s \\, ds = 4 \\left[\\frac{s^2}{2}\\right]_0^t = 2t^2\n$$\n由于对所有有限的 $t$ 都有 $2t^2 < \\infty$，过程 $M_t = 2\\int_0^t B_s dB_s$ 是一个真鞅，而不仅仅是局部鞅。这就完成了 $M_t = B_t^2-t$ 是一个鞅的证明。\n\n**2. 证明 $\\mathbb{P}(\\tau < \\infty) = 1$**\n\n事件 $\\{\\tau > t\\}$ 是指布朗运动在整个时间区间 $[0,t]$ 内都停留在区间 $(-a,a)$ 中的事件。这意味着在时间 $t$，其位置必须在 $(-a,a)$ 之内。形式上：\n$$\n\\{\\tau > t\\} = \\{\\sup_{0 \\le s \\le t} |B_s| < a\\} \\implies \\{|B_t| < a\\}\n$$\n因此，第一个事件的概率小于或等于第二个事件的概率：\n$$\n\\mathbb{P}(\\tau > t) \\le \\mathbb{P}(|B_t| < a)\n$$\n对于标准布朗运动，$B_t \\sim N(0, t)$，所以 $B_t/\\sqrt{t}$ 是一个标准正态随机变量，$Z \\sim N(0,1)$。\n$$\n\\mathbb{P}(|B_t| < a) = \\mathbb{P}(-a < B_t < a) = \\mathbb{P}\\left(-\\frac{a}{\\sqrt{t}} < \\frac{B_t}{\\sqrt{t}} < \\frac{a}{\\sqrt{t}}\\right) = \\mathbb{P}\\left(|Z| < \\frac{a}{\\sqrt{t}}\\right)\n$$\n当 $t \\to \\infty$ 时，$a/\\sqrt{t} \\to 0$。由于标准正态变量的累积分布函数是连续的，所以 $Z$ 处于一个收缩到一点的区间内的概率为零：\n$$\n\\lim_{t \\to \\infty} \\mathbb{P}\\left(|Z| < \\frac{a}{\\sqrt{t}}\\right) = \\mathbb{P}(|Z| < 0) = 0\n$$\n根据夹逼定理，由于 $0 \\le \\mathbb{P}(\\tau > t) \\le \\mathbb{P}(|B_t| < a)$，我们有：\n$$\n\\lim_{t \\to \\infty} \\mathbb{P}(\\tau > t) = 0\n$$\n过程永不退出的事件是 $\\{\\tau = \\infty\\}$。这可以写成一个递减事件序列的交集：$\\{\\tau = \\infty\\} = \\bigcap_{n=1}^\\infty \\{\\tau > n\\}$。根据概率测度对递减事件的连续性：\n$$\n\\mathbb{P}(\\tau = \\infty) = \\mathbb{P}\\left(\\bigcap_{n=1}^\\infty \\{\\tau > n\\}\\right) = \\lim_{n\\to\\infty} \\mathbb{P}(\\tau > n) = 0\n$$\n因此，过程在有限时间内退出的概率是 $\\mathbb{P}(\\tau < \\infty) = 1 - \\mathbb{P}(\\tau = \\infty) = 1$。\n\n**3. $\\mathbb{E}[\\tau]$ 的论证与计算**\n\n我们遵循指定的方法，使用在时刻 $\\tau_n \\coloneqq \\tau \\wedge n$（对于 $n \\in \\mathbb{N}$）停止的过程序列。\n\n对任意 $n \\in \\mathbb{N}$，停时 $\\tau_n$ 被 $n$ 有界。我们可以对鞅 $M_t = B_t^2 - t$ 和有界停时 $\\tau_n$ 应用可选停止定理。这得到：\n$$\n\\mathbb{E}[M_{\\tau_n}] = \\mathbb{E}[M_0]\n$$\n由于 $B_0=0$，我们有 $M_0 = B_0^2 - 0 = 0$。所以，$\\mathbb{E}[M_{\\tau_n}] = 0$。\n代入 $M_t$ 的定义，我们得到 $\\mathbb{E}[B_{\\tau_n}^2 - \\tau_n] = 0$。根据期望的线性性质，这得到：\n$$\n\\mathbb{E}[\\tau_n] = \\mathbb{E}[B_{\\tau_n}^2]\n$$\n此等式对所有 $n \\in \\mathbb{N}$ 成立。我们现在取极限 $n \\to \\infty$。\n\n考虑左侧，$\\mathbb{E}[\\tau_n]$。随机变量序列 $\\{\\tau_n\\}_{n\\in\\mathbb{N}}$ 是非负且非递减的，因为 $\\tau_n = \\min(\\tau, n) \\le \\min(\\tau, n+1) = \\tau_{n+1}$。如第2部分所示，$\\tau < \\infty$ 几乎必然成立，所以 $\\lim_{n\\to\\infty} \\tau_n = \\tau$ 几乎必然。根据单调收敛定理，我们可以交换极限和期望：\n$$\n\\lim_{n\\to\\infty} \\mathbb{E}[\\tau_n] = \\mathbb{E}[\\lim_{n\\to\\infty} \\tau_n] = \\mathbb{E}[\\tau]\n$$\n这一步也意味着，如果右侧的极限是有限的，那么 $\\mathbb{E}[\\tau]$ 就是有限的，从而证明了 $\\tau$ 的可积性。\n\n考虑右侧，$\\mathbb{E}[B_{\\tau_n}^2]$。我们分析随机变量 $B_{\\tau_n}^2$。\n根据 $\\tau$ 的定义，对所有 $s < \\tau$，我们有 $|B_s| < a$。\n- 如果一条路径在时间 $n$ 之前退出（即 $\\tau \\le n$），那么 $\\tau_n = \\tau$。根据布朗路径的连续性，有 $|B_{\\tau_n}| = |B_\\tau| = a$。\n- 如果一条路径在时间 $n$ 仍未退出（即 $\\tau > n$），那么 $\\tau_n = n$，并且 $|B_{\\tau_n}| = |B_n| < a$。\n在两种情况下，我们都有 $|B_{\\tau_n}| \\le a$。这意味着随机变量序列 $\\{B_{\\tau_n}^2\\}_{n\\in\\mathbb{N}}$ 被 $a^2$ 一致有界。\n\n当 $n \\to \\infty$ 时，我们有 $\\tau_n \\to \\tau$ 几乎必然。由于布朗运动路径几乎必然是连续的，这意味着 $B_{\\tau_n} \\to B_\\tau$ 几乎必然。因此，$B_{\\tau_n}^2 \\to B_\\tau^2$ 几乎必然。根据停时处的连续性，我们几乎必然有 $|B_\\tau| = a$（因为 $\\mathbb{P}(\\tau < \\infty)=1$），所以 $B_\\tau^2 = a^2$ 几乎必然。\n\n我们有一个随机变量序列 $\\{B_{\\tau_n}^2\\}$，它几乎必然收敛到常数 $a^2$，并且被可积随机变量 $a^2$ 控制（因为 $\\mathbb{E}[a^2] = a^2 < \\infty$）。根据控制收敛定理（或者更具体地说，有界收敛定理），我们可以交换极限和期望：\n$$\n\\lim_{n\\to\\infty} \\mathbb{E}[B_{\\tau_n}^2] = \\mathbb{E}[\\lim_{n\\to\\infty} B_{\\tau_n}^2] = \\mathbb{E}[a^2] = a^2\n$$\n将 $\\mathbb{E}[\\tau_n] = \\mathbb{E}[B_{\\tau_n}^2]$ 的左右两侧的极限相等，得到：\n$$\n\\mathbb{E}[\\tau] = a^2\n$$\n由于 $a^2$ 是一个有限值，$\\tau$ 的期望是有限的，因此 $\\tau$ 是一个可积随机变量。期望的最终表达式是 $a^2$。", "answer": "$$\\boxed{a^2}$$", "id": "2989359"}]}