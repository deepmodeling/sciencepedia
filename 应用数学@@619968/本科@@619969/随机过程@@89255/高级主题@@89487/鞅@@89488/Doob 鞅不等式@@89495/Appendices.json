{"hands_on_practices": [{"introduction": "这个练习提供了一个关于杜布鞅不等式的基本应用。我们将探讨一个代表动态策略的非负鞅，并学习如何利用杜布最大值不等式来计算该过程达到某个不期望状态的概率的严格上界。这个例子清晰地展示了如何应用核心理论，并帮助我们理解边界的“紧性”意味着什么。[@problem_id:1298735]", "problem": "一位数据科学家Priya正在为客户开发一种动态广告策略。该策略可以是两种类型之一：“定向”或“广泛”。在每一天 $n$（$n=0, 1, 2, \\dots$）的开始，Priya的策略是一种混合策略，由选择“定向”方法的概率 $X_n$ 来定义。Priya从初始策略 $X_0 = 0.4$ 开始，这代表了她在收集任何每日数据之前的初始信念。\n\nPriya采用一种学习算法，该算法根据前一天的市场表现每日更新策略 $X_n$。该算法的设计使得概率序列 $\\{X_n\\}_{n\\geq 0}$ 相对于每日信息更新序列构成一个鞅过程。\n\n客户担心过度专业化，并定义一个策略为“过度集中”，如果使用“定向”广告的概率曾达到或超过 $0.95$。假设此过程无限期地持续下去，求广告策略曾变得“过度集中”的最大可能概率。将您的答案计算为四舍五入到三位有效数字的小数。", "solution": "设 $\\{X_{n}\\}_{n\\geq 0}$ 是一个鞅，其中 $X_{0}=0.4$ 且对所有 $n$ 都有 $0\\leq X_{n}\\leq 1$，并设 $a=0.95$。定义事件 $A=\\{\\sup_{n\\geq 0}X_{n}\\geq a\\}$。\n\n因为 $\\{X_{n}\\}$ 是一个非负鞅，所以它也是一个非负超鞅。根据非负超鞅的Ville不等式，\n$$\n\\mathbb{P}(A)\\leq \\frac{\\mathbb{E}[X_{0}]}{a}=\\frac{0.4}{0.95}.\n$$\n因此，\n$$\n\\mathbb{P}\\left(\\sup_{n\\geq 0}X_{n}\\geq 0.95\\right)\\leq \\frac{0.4}{0.95}=\\frac{8}{19}.\n$$\n\n为了证明这个界是可达的，构造一个鞅如下：设\n$$\nX_{1}=\\begin{cases}\na & \\text{with probability } p,\\\\\n0 & \\text{with probability } 1-p,\n\\end{cases}\n$$\n其中 $p$ 的选择满足鞅条件 $\\mathbb{E}[X_{1}\\mid X_{0}]=X_{0}$，即：\n$$\npa+(1-p)\\cdot 0 = X_{0}\\quad\\Rightarrow\\quad p=\\frac{X_{0}}{a}=\\frac{0.4}{0.95}=\\frac{8}{19}.\n$$\n对于 $n\\geq 1$，设 $X_{n}=X_{1}$。这个过程是一个有界鞅，其中 $X_{0}=0.4$，并且它满足\n$$\n\\mathbb{P}\\left(\\sup_{n\\geq 0}X_{n}\\geq a\\right)=\\mathbb{P}(X_{1}=a)=\\frac{X_{0}}{a}=\\frac{8}{19}.\n$$\n因此，该过程曾达到或超过 $0.95$ 的最大可能概率等于 $\\frac{8}{19}$，其作为四舍五入到三位有效数字的小数是 $0.421$。", "answer": "$$\\boxed{0.421}$$", "id": "1298735"}, {"introduction": "在第二个练习中，我们将转换视角，不再关注鞅本身的最大值，而是其增量的波动性。通过一个天气预报的例子，我们利用鞅增量的性质来约束预测模型每日更新的最大可能变化。这个方法突显了鞅理论的灵活性，展示了如何控制一个随机过程的“跳跃”幅度。[@problem_id:1298773]", "problem": "一家气象机构开发了一个复杂的模型，用于预测未来某个重要事件的降雨概率。设 $p_n$ 为第 $n$ 天发布的降雨概率预测，其中 $n=0$ 代表初始预测，$n=N$ 代表事件发生当天。该预测序列 $\\{p_n\\}_{n=0}^N$ 随着每天新信息（例如，卫星数据、大气压力读数）的获得而演变。该模型的设计使得序列 $\\{p_n\\}_{n=0}^N$ 相对于每日的信息流构成一个鞅。\n\n初始预测于今天（第 $n=0$ 天）发布，为 $p_0 = 0.2$。在事件发生的当天，即 $n=N$ 时，所有不确定性都将消除，$p_N$ 的值如果下雨则为 1，如果不下雨则为 0。\n\n该预测用户的一个主要担忧是其稳定性。每日的大幅变化会削弱人们对模型的信心。对于任意一天 $n \\in \\{1, 2, \\dots, N\\}$，单日修正的幅度 $|p_n - p_{n-1}|$ 超过或等于阈值 $\\alpha = 0.5$ 的概率，请求出一个数值上界。\n\n将您的答案表示为一个实数，并四舍五入到三位有效数字。", "solution": "设 $\\{p_{n}\\}_{n=0}^{N}$ 是一个相对于每日信息流的鞅，其中 $p_{0}\\in[0,1]$ 且 $p_{N}\\in\\{0,1\\}$。对于 $n\\geq 1$，定义鞅差 $d_{n}=p_{n}-p_{n-1}$。\n\n因为 $\\{p_{n}\\}$ 是一个 $L^{2}$-鞅，我们有增量正交的恒等式\n$$\n\\mathbb{E}\\big[p_{N}^{2}\\big]=\\mathbb{E}\\big[p_{0}^{2}\\big]+\\sum_{n=1}^{N}\\mathbb{E}\\big[d_{n}^{2}\\big].\n$$\n因此，\n$$\n\\sum_{n=1}^{N}\\mathbb{E}\\big[d_{n}^{2}\\big]=\\mathbb{E}\\big[p_{N}^{2}\\big]-p_{0}^{2}.\n$$\n在事件发生当天，$p_{N}\\in\\{0,1\\}$ 等于下雨的指示函数，所以 $p_{N}^{2}=p_{N}$，因此 $\\mathbb{E}[p_{N}^{2}]=\\mathbb{E}[p_{N}]$。根据鞅的性质，$\\mathbb{E}[p_{N}]=\\mathbb{E}[p_{0}]=p_{0}$。于是，\n$$\n\\sum_{n=1}^{N}\\mathbb{E}\\big[d_{n}^{2}\\big]=p_{0}-p_{0}^{2}=p_{0}(1-p_{0}).\n$$\n\n设 $A=\\{\\max_{1\\leq n\\leq N}|d_{n}|\\geq \\alpha\\}$。由于 $d_{n}^{2}\\geq 0$，我们有如下的确定性不等式\n$$\n\\mathbf{1}_{A}\\leq \\frac{1}{\\alpha^{2}}\\sum_{n=1}^{N}d_{n}^{2},\n$$\n因为在事件 $A$ 上，至少有一个 $d_{n}^{2}$ 不小于 $\\alpha^{2}$，使得总和不小于 $\\alpha^{2}$，而在 $A$ 之外，不等式两边都为零或非负。两边取期望可得\n$$\n\\mathbb{P}(A)=\\mathbb{E}[\\mathbf{1}_{A}]\\leq \\frac{1}{\\alpha^{2}}\\sum_{n=1}^{N}\\mathbb{E}[d_{n}^{2}]=\\frac{p_{0}(1-p_{0})}{\\alpha^{2}}.\n$$\n\n代入 $p_{0}=0.2$ 和 $\\alpha=0.5$ 得\n$$\n\\mathbb{P}\\!\\left(\\max_{1\\leq n\\leq N}|p_{n}-p_{n-1}|\\geq 0.5\\right)\\leq \\frac{0.2\\times 0.8}{(0.5)^{2}}=\\frac{0.16}{0.25}=0.64.\n$$\n四舍五入到三位有效数字，该上界为 $0.640$。", "answer": "$$\\boxed{0.640}$$", "id": "1298773"}, {"introduction": "本练习将杜布不等式应用于一个实际的工程问题：递归最小二乘（RLS）算法的性能分析。这个问题的核心挑战在于，首先需要在一个看似复杂的递归算法中识别出潜在的鞅结构。解决了这一点后，应用杜布不等式就变得直接了当，这充分展示了鞅理论在分析实际系统动态行为时的强大威力。[@problem_id:1298765]", "problem": "一位工程师正在实现一个递归最小二乘 (RLS) 算法，以估计一个静态的、未知的标量参数 $\\theta$。该系统由线性模型 $y_k = x_k \\theta + v_k$ 描述，其中 $k = 1, 2, \\ldots, N$ 是离散时间步。输入 $x_k$ 是确定性的，由工程师选择为 $x_k = \\frac{1}{\\sqrt{k}}$。测量噪声项 $v_k$ 是独立同分布的随机变量，其均值为零，$E[v_k] = 0$，方差为有限值，$Var(v_k) = \\sigma^2$。\n\nRLS 估计 $\\hat{\\theta}_n$ 是使累积平方误差 $\\sum_{k=1}^n (y_k - x_k \\hat{\\theta}_n)^2$ 最小化的值。在第 $n$ 步的估计误差定义为 $\\tilde{\\theta}_n = \\hat{\\theta}_n - \\theta$。分析该算法性能的一个关键量是尺度化误差，定义为 $M_n = \\left(\\sum_{k=1}^n x_k^2\\right) \\tilde{\\theta}_n$。对于该系统，序列 $\\{M_n\\}_{n=1}^N$ 是一个零均值鞅。\n\n为确保系统稳定性和性能，该尺度化误差的幅度必须保持在一定的操作范围内。您的任务是找到一个紧上界，该上界描述了在 $N$ 步内的任何一步，尺度化误差的幅度超过给定常数容差 $c > 0$ 的概率。具体来说，通过应用一个利用鞅的二阶矩的标准鞅不等式，找到 $P(\\max_{1 \\le n \\le N} |M_n| \\ge c)$ 的一个上界。\n\n请用总步数 $N$、噪声方差 $\\sigma^2$ 和容差 $c$ 来表示您的解析表达式答案。您应该使用符号 $H_N$ 来表示第 $N$ 个调和数，其定义为 $H_N = \\sum_{k=1}^N \\frac{1}{k}$。", "solution": "最小化 $\\sum_{k=1}^{n}(y_{k}-x_{k}\\hat{\\theta}_{n})^{2}$ 的最小二乘估计器是\n$$\n\\hat{\\theta}_{n}=\\left(\\sum_{k=1}^{n}x_{k}^{2}\\right)^{-1}\\sum_{k=1}^{n}x_{k}y_{k}.\n$$\n代入 $y_{k}=x_{k}\\theta+v_{k}$ 可得\n$$\n\\tilde{\\theta}_{n}=\\hat{\\theta}_{n}-\\theta=\\left(\\sum_{k=1}^{n}x_{k}^{2}\\right)^{-1}\\sum_{k=1}^{n}x_{k}v_{k}.\n$$\n因此，尺度化误差为\n$$\nM_{n}=\\left(\\sum_{k=1}^{n}x_{k}^{2}\\right)\\tilde{\\theta}_{n}=\\sum_{k=1}^{n}x_{k}v_{k}.\n$$\n当 $x_{k}=\\frac{1}{\\sqrt{k}}$ 且 $v_{k}$ 是具有方差 $\\sigma^{2}$ 的独立零均值随机变量时，$\\{M_{n}\\}$ 是关于由 $\\{v_{k}\\}$ 生成的信息流的零均值鞅。对于平方可积鞅，$M_{n}^{2}$ 是一个非负子鞅。对于非负子鞅的 Doob 最大不等式表明，对任意 $c>0$，\n$$\nP\\!\\left(\\max_{1\\leq n\\leq N}M_{n}^{2}\\geq c^{2}\\right)\\leq \\frac{E[M_{N}^{2}]}{c^{2}}.\n$$\n等价地，\n$$\nP\\!\\left(\\max_{1\\leq n\\leq N}|M_{n}|\\geq c\\right)\\leq \\frac{E[M_{N}^{2}]}{c^{2}}.\n$$\n计算二阶矩：\n$$\nE[M_{N}^{2}]=\\operatorname{Var}\\!\\left(\\sum_{k=1}^{N}x_{k}v_{k}\\right)=\\sum_{k=1}^{N}x_{k}^{2}\\operatorname{Var}(v_{k})=\\sigma^{2}\\sum_{k=1}^{N}\\frac{1}{k}=\\sigma^{2}H_{N}.\n$$\n因此，\n$$\nP\\!\\left(\\max_{1\\leq n\\leq N}|M_{n}|\\geq c\\right)\\leq \\frac{\\sigma^{2}H_{N}}{c^{2}}.\n$$\n此界是通过使用二阶矩的 Doob 最大不等式得到的，并且就该不等式的最优常数而言是紧的。", "answer": "$$\\boxed{\\frac{\\sigma^{2} H_{N}}{c^{2}}}$$", "id": "1298765"}]}