{"hands_on_practices": [{"introduction": "一个随机过程需要多长时间才能偏离其起点一定距离？这个问题在物理学、金融学和生物学中都至关重要。这个练习 [@problem_id:871105] 提供了一个清晰、理想化的场景——一个没有平均漂移的对称随机游走，来介绍一种使用鞅计算期望时间的强大技术。通过“无过冲”（no overshoot）这一简化假设，我们可以专注于核心数学原理，为更复杂的应用打下坚实的基础。", "problem": "考虑一个从原点开始的一维随机游走 $S_n$，$S_0 = 0$。该游走由和式 $S_n = \\sum_{i=1}^n X_i$ 定义，其中增量 $X_i$ 是独立同分布 (i.i.d.) 的随机变量。这些增量的均值为零，$\\mathbb{E}[X_i] = 0$，方差为有限非零值，$\\text{Var}(X_i) = \\mathbb{E}[X_i^2] = \\sigma^2$。\n\n令 $T$ 为该随机游走首次离开开对称区间 $(-a, a)$ 的时刻，其中 $a$ 是一个正常数。该停时形式化定义为 $T = \\inf\\{n \\ge 1 : |S_n| \\ge a \\}$。\n\n为简化分析，我们做出一个关键假设：**无超调**。这意味着当游走停止时，其位置恰好在某个边界上，即 $S_T = a$ 或 $S_T = -a$。我们还假设停时 $T$ 以概率 1 是有限的。\n\n利用与鞅和可选停止定理（常与 Wald's identity 相关）相关的原理，推导期望停时 $\\mathbb{E}[T]$ 的表达式，并用边界参数 $a$ 和增量方差 $\\sigma^2$ 表示。", "solution": "1. 定义过程\n$$M_n = S_n^2 - n\\sigma^2.$$\n由于 $\\{X_i\\}$ 是独立同分布的，且 $\\mathbb{E}[X_i]=0$ 和 $\\text{Var}(X_i)=\\sigma^2$，我们有\n$$\\mathbb{E}[S_{n+1}^2\\mid\\mathcal{F}_n]\n=\\mathbb{E}[(S_n+X_{n+1})^2\\mid\\mathcal{F}_n]\n=S_n^2+2S_n\\mathbb{E}[X_{n+1}]+\\mathbb{E}[X_{n+1}^2]\n=S_n^2+\\sigma^2.$$\n因此\n$$\\mathbb{E}[M_{n+1}\\mid\\mathcal{F}_n]\n=\\mathbb{E}[S_{n+1}^2\\mid\\mathcal{F}_n]-(n+1)\\sigma^2\n=S_n^2+\\sigma^2-(n+1)\\sigma^2\n=M_n,$$\n故 $M_n$ 是一个鞅。\n\n2. 对有限停时 $T$ 应用可选停止定理，可得\n$$\\mathbb{E}[M_T]=\\mathbb{E}[M_0].$$\n由于 $M_0=S_0^2-0\\cdot\\sigma^2=0$，我们得到\n$$\\mathbb{E}[S_T^2 - T\\sigma^2]=0.$$\n\n3. 在无超调假设下，$|S_T|=a$，因此 $S_T^2=a^2$。于是\n$$a^2 - \\sigma^2\\mathbb{E}[T]=0\n\\quad\\Longrightarrow\\quad\n\\mathbb{E}[T]=\\frac{a^2}{\\sigma^2}.$$", "answer": "$$\\boxed{\\frac{a^2}{\\sigma^2}}$$", "id": "871105"}, {"introduction": "现实世界中的许多过程通常具有明确的方向或“漂移”，并且它们不会精确地停在预设的边界上。这个练习 [@problem_id:871116] 在前一个练习的基础上，将瓦尔德等式应用于一个均值不为零的过程。更重要的是，它引入了“过冲”（overshoot）的概念，迫使我们考虑过程超出阈值的距离，这在金融建模或可靠性工程等应用中是至关重要的考量因素。", "problem": "一个敏感的电子元件受到一系列电涌的冲击。每次电涌造成的损害是量化的，第 $i$ 次电涌的强度由一个随机变量 $X_i$ 表示。这些强度是独立同分布 (i.i.d.) 的随机变量。\n\n每个 $X_i$ 服从成功参数为 $p \\in (0, 1]$ 的几何分布，其概率质量函数描述为：\n$$\nP(X = k) = (1-p)^{k-1}p, \\quad \\text{for } k \\in \\{1, 2, 3, \\dots\\}\n$$\n该分布模拟了在一系列独立的伯努利试验中，为取得首次成功所需的试验次数。\n\n当累积损害 $S_n = \\sum_{i=1}^n X_i$ 首次达到或超过一个临界阈值 $K$ 时，该元件会发生灾难性故障，其中 $K$ 是一个正整数。设 $N$ 是导致元件故障的电涌次数。在数学上，$N$ 是一个停时，定义为：\n$$\nN = \\min\\{n \\in \\{1, 2, \\dots\\} : S_n \\ge K\\}\n$$\n\n利用序贯分析的原理，特别是 Wald 等式，推导在故障前该元件能承受的电涌的期望次数 $\\mathbb{E}[N]$。请用 $p$ 和 $K$ 表示你的答案。", "solution": "1. 相关方程\n对于停时 $N$ 和具有有限均值的独立同分布增量 $X_i$，Wald 等式为：\n$$\\mathbb{E}[S_N]=\\mathbb{E}[N]\\,\\mathbb{E}[X],\\quad S_N=\\sum_{i=1}^N X_i.$$\n首次通过时的和满足\n$$S_N=K+R,$$\n其中 $R=S_N-K$ 是超调量。\n\n2. 计算 $\\mathbb{E}[X]$ 和 $\\mathbb{E}[R]$\n对于在 $\\{1,2,\\dots\\}$ 上服从参数为 $p$ 的几何分布 $X\\sim\\mathrm{Geom}(p)$，\n$$\\mathbb{E}[X]=\\frac{1}{p}.$$\n根据无记忆性，在最后一次跳跃超过到达 $K$ 的差距的条件下，超调量 $R$ 在 $\\{0,1,2,\\dots\\}$ 上服从参数为 $p$ 的几何分布，因此\n$$\\mathbb{E}[R]=\\frac{1-p}{p}.$$\n\n3. 通过 Wald 等式合并\n$$\\mathbb{E}[S_N]=\\mathbb{E}[K+R]=K+\\frac{1-p}{p},$$\n所以\n$$\\mathbb{E}[N]\n=\\frac{\\mathbb{E}[S_N]}{\\mathbb{E}[X]}\n=\\biggl(K+\\frac{1-p}{p}\\biggr)\\,p\n=pK+1-p.$$", "answer": "$$\\boxed{pK+1-p}$$", "id": "871116"}, {"introduction": "现在，让我们综合运用所学技能，解决一个更全面、更贴近实际的问题。最后的这个练习 [@problem_id:870990] 融合了多个概念：带偏向的随机游走、不对称的边界以及相关的成本结构。为了计算预期的总成本，你需要应用瓦尔德等式来确定游走的期望持续时间，并将其与到达每个边界的概率相结合，从而展示如何整合这些工具来分析复杂的随机系统。", "problem": "一个粒子在整数集 $\\mathbb{Z}$ 上进行有偏随机游走。该粒子从初始位置 $S_0 = k$ 开始，其中 $k$ 为整数。在每个离散时间步，粒子以概率 $p$ 向右移动一个单位（至位置 $x+1$），或以概率 $q = 1-p$ 向左移动一个单位（至位置 $x-1$）。假设 $p \\neq 1/2$。\n\n该过程受限于两个吸收壁，分别位于 $-a$ 和 $b$ 处，其中 $a$ 和 $b$ 为正整数。粒子在开区间 $(-a, b)$ 内开始，即 $-a < k < b$。游走在随机时刻 $T$ 停止，该时刻为粒子位置 $S_T$ 首次到达 $-a$ 或 $b$ 的时刻。\n\n每走一步都会产生一笔成本。向右走一步的成本为 $c_R$，向左走一步的成本为 $c_L$。设 $C_T$ 为直到停止时刻 $T$ 所累积的总成本。\n\n请推导期望总成本 $\\mathbb{E}[C_T]$ 的闭式表达式，用参数 $a, b, k, p, c_R$ 和 $c_L$ 表示。", "solution": "我们设 $N_R,N_L$ 分别为直到被吸收时向右和向左的步数。于是\n1.  $C_T=c_RN_R+c_LN_L$， $T=N_R+N_L$， $S_T-S_0=N_R-N_L$。 因此\n   $$N_R=\\frac{T+(S_T-S_0)}{2},\\quad N_L=\\frac{T-(S_T-S_0)}{2}$$\n   并且\n   $$\\mathbb{E}[C_T]\n     =c_R\\mathbb{E}[N_R]+c_L\\mathbb{E}[N_L]\n     =\\frac{c_R+c_L}{2}\\,\\mathbb{E}[T]+\\frac{c_R-c_L}{2}\\,\\mathbb{E}[S_T-S_0].$$\n2.  考虑到有位于 $-a$ 和 $b$ 的吸收壁，设 $r=q/p\\neq1$ 以及 $k'=k+a$, $N=a+b$。 首先到达 $b$ 的概率为\n   $$P_b=\\frac{1-r^{k'}}{1-r^N}.$$\n   可以证明\n   $$\\mathbb{E}[T]\n     =\\frac{k'-NP_b}{q-p}\n     =\\frac{k+a-(a+b)P_b}{q-p},$$\n   $$\\mathbb{E}[S_T-S_0]\n     =\\mathbb{E}[S_T]-k\n     =(a+b)P_b-(a+k).$$\n3.  代入可得\n   $$\\mathbb{E}[C_T]\n     =\\frac{c_R+c_L}{2}\\frac{k+a-(a+b)P_b}{q-p}\n      +\\frac{c_R-c_L}{2}\\bigl((a+b)P_b-(a+k)\\bigr).$$\n   整理得\n   $$\\mathbb{E}[C_T]\n     =\\frac{\\bigl((a+b)(1-r^{k+a})-(a+k)(1-r^{a+b})\\bigr)\\,(p\\,c_R+q\\,c_L)}{(p-q)\\,\\bigl(1-r^{a+b}\\bigr)}.$$", "answer": "$$\\boxed{\\frac{\\bigl((a+b)\\bigl(1-(\\tfrac qp)^{k+a}\\bigr)-(a+k)\\bigl(1-(\\tfrac qp)^{a+b}\\bigr)\\bigr)\\,(p\\,c_R+q\\,c_L)}{(p-q)\\,\\bigl(1-(\\tfrac qp)^{a+b}\\bigr)}}$$", "id": "870990"}]}