{"hands_on_practices": [{"introduction": "让我们从一个经典且直观的例子开始：一维空间中的随机游走。这个问题，通常被称为“赌徒破产问题”，是理解鞅论基本概念的绝佳起点。通过计算粒子被吸收的预期时间，你将实践处理停时这一核心概念，这对于理解鞅收敛定理至关重要，因为它正是关于过程在无限时间或在某个特定停时的行为 [@problem_id:1317066]。", "problem": "一个亚原子粒子的位置在一维整数格点上被追踪。在离散时间步 $n$，它的位置由随机变量 $S_n$ 给出。该粒子初始位于原点，因此 $S_0 = 0$。\n\n在每个时间步 $n=1, 2, 3, \\dots$，该粒子以相等的概率向右移动一个单位（例如，从位置 $k$ 到 $k+1$）或向左移动一个单位（从 $k$ 到 $k-1$）。每次移动都与之前的所有移动相独立。\n\n该粒子的运动受到两个吸收壁的限制。一个位于位置 $x=b$，另一个位于 $x=-a$，其中 $a$ 和 $b$ 为给定的正整数。如果粒子的位置到达 $b$ 或 $-a$，它会立即被吸收壁吸收，其运动随之停止。\n\n设 $\\tau$ 为粒子首次被其中一个吸收壁吸收的离散时间步。请确定该停止时间 $\\tau$ 的期望值 $E[\\tau]$ 的一个闭式解析表达式，该表达式以正整数 $a$ 和 $b$ 表示。", "solution": "设 $T(i) = \\mathbb{E}[\\tau \\mid S_{0}=i]$，其中 $i \\in \\{-a,-a+1,\\dots,b-1,b\\}$。根据全期望定律和马尔可夫性质，对于所有内部位置 $-a < i < b$，\n$$\nT(i) = 1 + \\frac{1}{2}T(i+1) + \\frac{1}{2}T(i-1),\n$$\n吸收边界条件为\n$$\nT(-a) = 0, \\quad T(b) = 0.\n$$\n重写内部递推关系，得到二阶差分方程\n$$\nT(i+1) - 2T(i) + T(i-1) = -2.\n$$\n一个特解是 $T_{p}(i) = -i^{2}$，因为 $(i+1)^{2} - 2i^{2} + (i-1)^{2} = 2$。因此，通解为\n$$\nT(i) = -i^{2} + A i + C,\n$$\n其中 $A$ 和 $C$ 为常数。应用边界条件得到\n$$\nT(-a) = -a^{2} - A a + C = 0, \\quad T(b) = -b^{2} + A b + C = 0.\n$$\n将这两个方程相减得到\n$$\na^{2} - b^{2} + A(a+b) = 0 \\quad \\Rightarrow \\quad A = b - a.\n$$\n将结果代入 $T(b)=0$ 得到\n$$\n0 = -b^{2} + (b-a)b + C \\quad \\Rightarrow \\quad C = ab.\n$$\n因此\n$$\nT(i) = -i^{2} + (b-a)i + ab,\n$$\n特别地，由于 $S_{0}=0$，\n$$\n\\mathbb{E}[\\tau] = T(0) = ab.\n$$", "answer": "$$\\boxed{ab}$$", "id": "1317066"}, {"introduction": "在理解了基本鞅过程之后，我们来探讨一个更精妙的问题：鞅是否总是收敛到一个有意义的（非零）值？这个问题通过一个自动投资基金的模型，引入了“积鞅”的概念，其中资本是每日收益因子的乘积。此练习直接应用了一个深刻的理论结果，该结果通过分析一个无穷级数的收敛性来区分鞅收敛到零和收敛到正值的两种情况，这让你能够将抽象的收敛条件与金融模型中的实际成败联系起来 [@problem_id:1317075]。", "problem": "一个自动化投资基金的资本被建模为一个离散时间随机过程。初始资本被归一化为 $M_0 = 1$。$n$天后的资本 $M_n$ 由每日回报因子的乘积给出，即 $M_n = \\prod_{k=1}^{n} Y_k$。每日回报因子 $Y_k$ 是独立的、非负的随机变量。\n\n对于每一天 $k \\ge 1$，回报因子 $Y_k$ 由一个简化的市场模型决定。它可以取两个值之一：高回报 $h_k = 1 + (k+1)^{-1/4}$ 或低回报 $l_k = 1 - (k+1)^{-1/\\alpha}$。此处，$\\alpha > 0$ 是投资策略的一个可调参数。对于任何给定的 $\\alpha$，我们仅考虑使 $l_k > 0$ 成立的 $k$ 值。第 $k$ 天高回报的概率被设定为使得期望回报因子是公平的，即 $E[Y_k] = 1$。\n\n该策略的长期成功与否取决于当 $n \\to \\infty$ 时，资本 $M_n$ 是收敛到一个严格为正的值，还是趋于零。鞅理论中的一个关键结果指出，如果级数 $\\sum_{k=1}^{\\infty} (1 - E[\\sqrt{Y_k}])$ 收敛，则存在非零概率使得 $\\lim_{n \\to \\infty} M_n > 0$。反之，如果该级数发散，则 $\\lim_{n \\to \\infty} M_n = 0$ 几乎必然成立。\n\n存在一个策略参数的临界值 $\\alpha_c$，它区分了这两种结果。对于 $\\alpha > \\alpha_c$，该策略长期来看必然失败（资本收敛到零）。对于 $0 < \\alpha < \\alpha_c$，该策略有成功的机会（资本可能收敛到一个正值）。\n\n确定这个临界值 $\\alpha_c$。", "solution": "令 $a_{k} \\equiv (k+1)^{-1/4}$ 且 $b_{k} \\equiv (k+1)^{-1/\\alpha}$，从而 $h_{k} = 1 + a_{k}$ 且 $l_{k} = 1 - b_{k}$。公平条件 $E[Y_{k}] = 1$ 通过以下方式决定了高回报概率 $p_{k}$：\n$$\np_{k} h_{k} + (1 - p_{k}) l_{k} = 1 \\quad \\Longrightarrow \\quad p_{k} (a_{k} + b_{k}) = b_{k} \\quad \\Longrightarrow \\quad p_{k} = \\frac{b_{k}}{a_{k} + b_{k}}, \\quad 1 - p_{k} = \\frac{a_{k}}{a_{k} + b_{k}}.\n$$\n因此\n$$\nE[\\sqrt{Y_{k}}] = p_{k} \\sqrt{1 + a_{k}} + (1 - p_{k}) \\sqrt{1 - b_{k}} = \\frac{b_{k} \\sqrt{1 + a_{k}} + a_{k} \\sqrt{1 - b_{k}}}{a_{k} + b_{k}}.\n$$\n对小的 $x$ 使用泰勒展开式，\n$$\n\\sqrt{1 + x} = 1 + \\frac{1}{2} x - \\frac{1}{8} x^{2} + O(x^{3}), \\qquad \\sqrt{1 - x} = 1 - \\frac{1}{2} x - \\frac{1}{8} x^{2} + O(x^{3}),\n$$\n我们得到\n$$\nb_{k} \\sqrt{1 + a_{k}} + a_{k} \\sqrt{1 - b_{k}} = b_{k} \\left(1 + \\frac{1}{2} a_{k} - \\frac{1}{8} a_{k}^{2} + O(a_{k}^{3}) \\right) + a_{k} \\left(1 - \\frac{1}{2} b_{k} - \\frac{1}{8} b_{k}^{2} + O(b_{k}^{3}) \\right).\n$$\n合并各项，\n$$\nb_{k} \\sqrt{1 + a_{k}} + a_{k} \\sqrt{1 - b_{k}} = (a_{k} + b_{k}) - \\frac{1}{8} \\left( b_{k} a_{k}^{2} + a_{k} b_{k}^{2} \\right) + O\\left(b_{k} a_{k}^{3} + a_{k} b_{k}^{3}\\right).\n$$\n两边同除以 $a_{k} + b_{k}$ 得到\n$$\nE[\\sqrt{Y_{k}}] = 1 - \\frac{1}{8} \\frac{b_{k} a_{k}^{2} + a_{k} b_{k}^{2}}{a_{k} + b_{k}} + O\\left(\\frac{b_{k} a_{k}^{3} + a_{k} b_{k}^{3}}{a_{k} + b_{k}}\\right).\n$$\n由于 $b_{k} a_{k}^{2} + a_{k} b_{k}^{2} = a_{k} b_{k} (a_{k} + b_{k})$，首项可以精确地化简为\n$$\nE[\\sqrt{Y_{k}}] = 1 - \\frac{1}{8} a_{k} b_{k} + O\\left(a_{k} b_{k} (a_{k} + b_{k})\\right),\n$$\n所以\n$$\n1 - E[\\sqrt{Y_{k}}] = \\frac{1}{8} a_{k} b_{k} + O\\left(a_{k} b_{k} (a_{k} + b_{k})\\right).\n$$\n因为 $a_{k} \\to 0$ 且 $b_{k} \\to 0$，存在常数 $C_{1}, C_{2} > 0$ 和 $K$，使得对于所有 $k \\ge K$，\n$$\nC_{1} a_{k} b_{k} \\le 1 - E[\\sqrt{Y_{k}}] \\le C_{2} a_{k} b_{k}.\n$$\n因此，$\\sum_{k=1}^{\\infty} \\left(1 - E[\\sqrt{Y_{k}}]\\right)$ 的收敛性等价于以下级数的收敛性\n$$\n\\sum_{k=1}^{\\infty} a_{k} b_{k} = \\sum_{k=1}^{\\infty} (k+1)^{-\\left(\\frac{1}{4} + \\frac{1}{\\alpha}\\right)}.\n$$\n根据 p-级数判别法，该级数收敛当且仅当 $\\frac{1}{4} + \\frac{1}{\\alpha} > 1$，而发散当且仅当 $\\frac{1}{4} + \\frac{1}{\\alpha} \\le 1$。临界值 $\\alpha_{c}$ 由等式定义：\n$$\n\\frac{1}{4} + \\frac{1}{\\alpha_{c}} = 1 \\quad \\Longrightarrow \\quad \\frac{1}{\\alpha_{c}} = \\frac{3}{4} \\quad \\Longrightarrow \\quad \\alpha_{c} = \\frac{4}{3}.\n$$\n因此，对于 $0 < \\alpha < \\frac{4}{3}$，级数收敛，且 $\\lim_{n \\to \\infty} M_{n} > 0$ 的概率为正；而对于 $\\alpha \\ge \\frac{4}{3}$，级数发散，且 $\\lim_{n \\to \\infty} M_{n} = 0$ 几乎必然成立。相变发生在 $\\alpha_{c} = \\frac{4}{3}$。", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "1317075"}, {"introduction": "最后，我们挑战一个更高级的例子——著名的 Ehrenfest 瓮模型，它描述了粒子在两个容器间的扩散过程。这个练习展示了鞅理论的强大之处，即如何在看似复杂的随机过程中识别并构建一个“隐藏”的鞅。通过对一个经过中心化和尺度变换后的过程 $M_n$ 进行分析，你不仅能确认其鞅性质，还将计算其二阶矩 $\\mathbb{E}[M_n^2]$，从而定量地理解该过程的波动性和长期稳定性，这是一个展示鞅在物理模型中创造性应用的典范 [@problem_id:1317068]。", "problem": "埃伦费斯特模型（Ehrenfest model）描述了两个物体之间的热交换过程。在一个简化版本中，我们考虑两个分别标记为1和2的瓮，其中总共包含$N$个可区分的粒子。在每个离散时间步，从总共$N$个粒子中均匀随机地选择一个，并将其移动到另一个瓮中。令$X_n$为时刻$n$时瓮1中的粒子数，其中$n=0, 1, 2, \\dots$。$X_n$的状态空间为$\\{0, 1, \\dots, N\\}$。\n\n令$Y_n = X_n - N/2$为中心化的粒子数。可以证明，$Y_n$的条件期望满足关系式$\\mathbb{E}[Y_{n+1} | \\mathcal{F}_n] = (1 - 2/N)Y_n$，其中$\\mathcal{F}_n = \\sigma(X_0, X_1, \\dots, X_n)$是该过程的自然信息流。这个关系式意味着由\n$$M_n = \\left(1 - \\frac{2}{N}\\right)^{-n} \\left(X_n - \\frac{N}{2}\\right)$$\n定义的过程$M_n$是关于$\\mathcal{F}_n$的一个鞅。\n\n假设过程开始时瓮1中有固定的$k$个粒子，即$X_0 = k$，请确定该鞅的二阶矩$\\mathbb{E}[M_n^2]$关于$n$，$N$和$k$的精确表达式。", "solution": "定义$Y_{n}=X_{n}-\\frac{N}{2}$。单步动态如下\n$$\nY_{n+1}=\n\\begin{cases}\nY_{n}+1 & \\text{with probability } \\frac{N-X_{n}}{N}=\\frac{1}{2}-\\frac{Y_{n}}{N},\\\\\nY_{n}-1 & \\text{with probability } \\frac{X_{n}}{N}=\\frac{1}{2}+\\frac{Y_{n}}{N}.\n\\end{cases}\n$$\n令$\\Delta_{n}=Y_{n+1}-Y_{n}\\in\\{-1,+1\\}$。那么，以$\\mathcal{F}_{n}$为条件，\n$$\n\\mathbb{E}[\\Delta_{n}\\mid \\mathcal{F}_{n}]=\\left(\\frac{1}{2}-\\frac{Y_{n}}{N}\\right)-\\left(\\frac{1}{2}+\\frac{Y_{n}}{N}\\right)=-\\frac{2}{N}Y_{n},\n$$\n$$\n\\mathbb{E}[\\Delta_{n}^{2}\\mid \\mathcal{F}_{n}]=1,\n$$\n所以\n$$\n\\operatorname{Var}(\\Delta_{n}\\mid \\mathcal{F}_{n})=1-\\left(\\frac{2}{N}Y_{n}\\right)^{2}=1-\\frac{4}{N^{2}}Y_{n}^{2}.\n$$\n使用$\\mathbb{E}[Y_{n+1}\\mid \\mathcal{F}_{n}]=\\left(1-\\frac{2}{N}\\right)Y_{n}$和恒等式$\\mathbb{E}[Z^{2}]=\\operatorname{Var}(Z)+(\\mathbb{E}Z)^{2}$，\n$$\n\\mathbb{E}[Y_{n+1}^{2}\\mid \\mathcal{F}_{n}]=\\operatorname{Var}(Y_{n+1}\\mid \\mathcal{F}_{n})+\\left(\\mathbb{E}[Y_{n+1}\\mid \\mathcal{F}_{n}]\\right)^{2}\n= \\left(1-\\frac{4}{N^{2}}Y_{n}^{2}\\right)+\\left(1-\\frac{2}{N}\\right)^{2}Y_{n}^{2}\n=1+\\left(1-\\frac{4}{N}\\right)Y_{n}^{2}.\n$$\n取期望，设$s_{n}=\\mathbb{E}[Y_{n}^{2}]$，\n$$\ns_{n+1}=1+\\left(1-\\frac{4}{N}\\right)s_{n},\\qquad s_{0}=\\left(k-\\frac{N}{2}\\right)^{2}.\n$$\n令$b=1-\\frac{4}{N}$。解此线性递推关系，\n$$\ns_{n}=b^{n}s_{0}+\\sum_{j=0}^{n-1}b^{j}=b^{n}\\left(k-\\frac{N}{2}\\right)^{2}+\\frac{1-b^{n}}{1-b}\n=b^{n}\\left(k-\\frac{N}{2}\\right)^{2}+\\frac{N}{4}\\left(1-b^{n}\\right),\n$$\n即\n$$\n\\mathbb{E}[Y_{n}^{2}]=\\left(1-\\frac{4}{N}\\right)^{n}\\left(k-\\frac{N}{2}\\right)^{2}+\\frac{N}{4}\\left(1-\\left(1-\\frac{4}{N}\\right)^{n}\\right).\n$$\n由于$M_{n}=\\left(1-\\frac{2}{N}\\right)^{-n}Y_{n}$，我们得到\n$$\n\\mathbb{E}[M_{n}^{2}]=\\left(1-\\frac{2}{N}\\right)^{-2n}\\mathbb{E}[Y_{n}^{2}]\n=\\left(1-\\frac{2}{N}\\right)^{-2n}\\left[\\left(1-\\frac{4}{N}\\right)^{n}\\left(k-\\frac{N}{2}\\right)^{2}+\\frac{N}{4}\\left(1-\\left(1-\\frac{4}{N}\\right)^{n}\\right)\\right].\n$$\n这就是作为$n$，$N$和$k$的函数的精确二阶矩。", "answer": "$$\\boxed{\\left(1-\\frac{2}{N}\\right)^{-2n}\\left[\\left(1-\\frac{4}{N}\\right)^{n}\\left(k-\\frac{N}{2}\\right)^{2}+\\frac{N}{4}\\left(1-\\left(1-\\frac{4}{N}\\right)^{n}\\right)\\right]}$$", "id": "1317068"}]}