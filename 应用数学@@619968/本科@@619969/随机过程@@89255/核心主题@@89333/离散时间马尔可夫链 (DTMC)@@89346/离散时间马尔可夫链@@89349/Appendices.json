{"hands_on_practices": [{"introduction": "要想真正掌握马尔可夫链的演化方式，没有什么比亲手进行概率计算更有效了。第一个练习将挑战你计算一个随机过程在固定步数后到达特定状态的概率。你需要识别出所有从起点到终点的可行路径，并加总它们的概率，同时要特别注意转移规则是如何根据当前状态而变化的。这个练习将直接巩固马尔可夫链中基于路径进行概率计算的核心逻辑 [@problem_id:1297450]。", "problem": "一个用于描述投机性数字资产价格波动的简化模型，将其价值描述为整数个信用点，$n \\in \\mathbb{Z}$。价格根据一个随机过程在离散时间步长上更新。价格变化的规则取决于当前价格 $n$。\n\n1.  如果当前价格 $n$ 为正 ($n > 0$)，则其在下一步中增加1个信用点的概率为 $p$，减少1个信用点的概率为 $q$。\n2.  如果当前价格 $n$ 为负 ($n < 0$)，则其增加1个信用点的概率为 $q$，减少1个信用点的概率为 $p$。\n3.  如果当前价格恰好为零 ($n = 0$)，则其增加1个信用点的概率为 $1/2$，减少1个信用点的概率为 $1/2$。\n\n参数 $p$ 和 $q$ 是常数，满足 $p+q=1$ 且 $p < 1/2$。\n\n假设一个资产的初始价值为 $n_0 = 1$ 个信用点。在三个时间步长后，其价值恰好为0个信用点的概率是多少？请用参数 $q$ 的封闭形式解析表达式来表达您的答案。", "solution": "设 $X_t$ 表示在时间步长 $t$ 时资产以信用点计价的价格。这个离散时间马尔可夫链的状态空间是整数集 $\\mathbb{Z}$。给定初始状态 $X_0 = 1$。我们要求解概率 $P(X_3 = 0)$。\n\n要使资产价格在三步内从初始状态 $X_0 = 1$ 变为最终状态 $X_3 = 0$，价格的净变化必须是 $X_3 - X_0 = 0 - 1 = -1$。每一步的变化为 +1（向右一步，R）或 -1（向左一步，L）。设 $N_R$ 为向右的步数，$N_L$ 为向左的步数。\n\n总步数为三步：\n$$N_R + N_L = 3$$\n总位移为 -1：\n$$N_R - N_L = -1$$\n\n我们可以求解这个线性方程组。将两个方程相加得到：\n$$2N_R = 2 \\implies N_R = 1$$\n将 $N_R=1$ 代入第一个方程得到：\n$$1 + N_L = 3 \\implies N_L = 2$$\n因此，任何在三步内从状态1到状态0的路径都必须恰好包含一步向右和两步向左。可能的步进序列是 {R, L, L} 的排列，即：RLL、LRL 和 LLR。\n\n我们必须计算每条路径的概率，同时考虑到依赖于状态的转移概率。从状态 $n$ 向右 ($P_R$) 和向左 ($P_L$) 移动的概率为：\n- 如果 $n > 0$：$P_R = p$，$P_L = q$\n- 如果 $n < 0$：$P_R = q$，$P_L = p$\n- 如果 $n = 0$：$P_R = 1/2$，$P_L = 1/2$\n\n让我们从 $X_0=1$ 开始，评估每条路径的概率：\n\n1.  **路径1：RLL**\n    状态序列为 $1 \\xrightarrow{R} 2 \\xrightarrow{L} 1 \\xrightarrow{L} 0$。\n    - 第1步：$X_0=1 \\to X_1=2$。当前状态为 $1 > 0$。向右一步（远离原点）的概率为 $p$。\n    - 第2步：$X_1=2 \\to X_2=1$。当前状态为 $2 > 0$。向左一步（朝向原点）的概率为 $q$。\n    - 第3步：$X_2=1 \\to X_3=0$。当前状态为 $1 > 0$。向左一步（朝向原点）的概率为 $q$。\n    此路径的概率为 $P(\\text{RLL}) = p \\cdot q \\cdot q = pq^2$。\n\n2.  **路径2：LRL**\n    状态序列为 $1 \\xrightarrow{L} 0 \\xrightarrow{R} 1 \\xrightarrow{L} 0$。\n    - 第1步：$X_0=1 \\to X_1=0$。当前状态为 $1 > 0$。向左一步（朝向原点）的概率为 $q$。\n    - 第2步：$X_1=0 \\to X_2=1$。当前状态为 $0$。向右一步的概率为 $1/2$。\n    - 第3步：$X_2=1 \\to X_3=0$。当前状态为 $1 > 0$。向左一步（朝向原点）的概率为 $q$。\n    此路径的概率为 $P(\\text{LRL}) = q \\cdot \\frac{1}{2} \\cdot q = \\frac{1}{2}q^2$。\n\n3.  **路径3：LLR**\n    状态序列为 $1 \\xrightarrow{L} 0 \\xrightarrow{L} -1 \\xrightarrow{R} 0$。\n    - 第1步：$X_0=1 \\to X_1=0$。当前状态为 $1 > 0$。向左一步（朝向原点）的概率为 $q$。\n    - 第2步：$X_1=0 \\to X_2=-1$。当前状态为 $0$。向左一步的概率为 $1/2$。\n    - 第3步：$X_2=-1 \\to X_3=0$。当前状态为 $-1 < 0$。向右一步（朝向原点）的概率为 $q$。\n    此路径的概率为 $P(\\text{LLR}) = q \\cdot \\frac{1}{2} \\cdot q = \\frac{1}{2}q^2$。\n\n在三步后到达状态0的总概率是这些互斥路径的概率之和：\n$$P(X_3=0) = P(\\text{RLL}) + P(\\text{LRL}) + P(\\text{LLR})$$\n$$P(X_3=0) = pq^2 + \\frac{1}{2}q^2 + \\frac{1}{2}q^2 = pq^2 + q^2 = q^2(p+1)$$\n\n题目要求用 $q$ 来表示答案。我们使用给定的关系式 $p+q=1$，这意味着 $p = 1-q$。\n将此代入我们的表达式：\n$$P(X_3=0) = q^2((1-q)+1) = q^2(2-q)$$\n这是概率的最终表达式。", "answer": "$$\\boxed{q^{2}(2-q)}$$", "id": "1297450"}, {"introduction": "“无记忆性”是马尔可夫链的核心特征，但许多现实世界的过程似乎具有记忆。本练习将介绍一种巧妙而强大的技术，用于处理其未来不仅依赖于当前、还依赖于过去的随机过程。通过重新定义“状态”以包含最近的历史信息，我们可以将一个看似非马尔可夫的二阶过程转化为标准的马尔可夫链，从而能够运用寻找长期平稳分布等标准分析方法 [@problem_id:1297471]。", "problem": "一个数据包穿过一个多级处理流水线。在每个阶段 $n \\ge 0$，该数据包被分配一个优先级状态，记为 $X_n$。该状态可以是低优先级 ($L$) 或高优先级 ($H$)。该过程遵循一个记忆依赖规则：阶段 $n+1$ 的优先级取决于阶段 $n$ 和 $n-1$ 的优先级。\n\n对于 $n \\ge 1$，具体的状态转移概率定义如下：\n- 如果数据包在阶段 $n-1$ 和阶段 $n$ 都处于状态 $L$，那么它在阶段 $n+1$ 保持状态 $L$ 的概率为 $P(X_{n+1}=L | X_n=L, X_{n-1}=L) = \\alpha$。\n- 如果数据包在阶段 $n-1$ 从状态 $L$ 转移到阶段 $n$ 的状态 $H$，那么它在阶段 $n+1$ 保持状态 $H$ 的概率为 $P(X_{n+1}=H | X_n=H, X_{n-1}=L) = \\beta$。\n- 如果数据包在阶段 $n-1$ 从状态 $H$ 转移到阶段 $n$ 的状态 $L$，那么它在阶段 $n+1$ 转回状态 $H$ 的概率为 $P(X_{n+1}=H | X_n=L, X_{n-1}=H) = \\gamma$。\n- 如果数据包在阶段 $n-1$ 和阶段 $n$ 都处于状态 $H$，那么它在阶段 $n+1$ 转移到状态 $L$ 的概率为 $P(X_{n+1}=L | X_n=H, X_{n-1}=H) = \\delta$。\n\n假设常数值为 $\\alpha = \\frac{3}{4}$，$\\beta = \\frac{2}{3}$，$\\gamma = \\frac{1}{2}$ 和 $\\delta = \\frac{1}{4}$。假设该过程运行了非常多的阶段，数据包在任意给定阶段处于高优先级状态的长期概率是多少？\n\n请用精确分数表示你的答案。", "solution": "我们将给定的二阶过程建模为基于状态对的一阶马尔可夫链。定义 $Y_{n} = (X_{n-1}, X_{n})$，其状态空间为 $\\{LL, LH, HL, HH\\}$。那么，根据给定的转移规则：\n- 从 $LL$：$P(LL \\to LL) = \\frac{3}{4}$ 且 $P(LL \\to LH) = \\frac{1}{4}$。\n- 从 $LH$：$P(LH \\to HH) = \\frac{2}{3}$ 且 $P(LH \\to HL) = \\frac{1}{3}$。\n- 从 $HL$：$P(HL \\to LL) = \\frac{1}{2}$ 且 $P(HL \\to LH) = \\frac{1}{2}$。\n- 从 $HH$：$P(HH \\to HH) = \\frac{3}{4}$ 且 $P(HH \\to HL) = \\frac{1}{4}$。\n\n设 $Y_n$ 的平稳分布为 $\\pi = (a, b, c, d)$，分别对应于 $(LL, LH, HL, HH)$，因此 $\\pi$ 满足 $\\pi = \\pi P$ 且 $a + b + c + d = 1$。写出其分量方程：\n$$\n\\begin{aligned}\na &= \\frac{3}{4} a + \\frac{1}{2} c, \\\\\nb &= \\frac{1}{4} a + \\frac{1}{2} c, \\\\\nc &= \\frac{1}{3} b + \\frac{1}{4} d, \\\\\nd &= \\frac{2}{3} b + \\frac{3}{4} d.\n\\end{aligned}\n$$\n从 $a = \\frac{3}{4} a + \\frac{1}{2} c$ 可得 $a - \\frac{3}{4} a = \\frac{1}{2} c$，因此 $\\frac{1}{4} a = \\frac{1}{2} c$，所以 $a = 2 c$。\n那么 $b = \\frac{1}{4} a + \\frac{1}{2} c = \\frac{1}{4} (2 c) + \\frac{1}{2} c = c$。\n从 $d = \\frac{2}{3} b + \\frac{3}{4} d$ 可得 $d - \\frac{3}{4} d = \\frac{2}{3} b$，所以 $\\frac{1}{4} d = \\frac{2}{3} b$，因此 $d = \\frac{8}{3} b = \\frac{8}{3} c$。\n关于 $c$ 的方程是一致的：$c = \\frac{1}{3} b + \\frac{1}{4} d = \\frac{1}{3} c + \\frac{1}{4} \\cdot \\frac{8}{3} c = \\left(\\frac{1}{3} + \\frac{2}{3}\\right) c = c$。\n归一化：$a + b + c + d = 2 c + c + c + \\frac{8}{3} c = \\frac{20}{3} c = 1$，所以 $c = \\frac{3}{20}$。因此 $b = \\frac{3}{20}$，$a = 2 c = \\frac{3}{10}$，且 $d = \\frac{8}{3} c = \\frac{8}{20} = \\frac{2}{5}$。\n\n在平稳状态下，$X_{n} = H$ 的长期概率是第二个分量为 H 的状态对的边际概率，即 $P(X_{n} = H) = \\pi(LH) + \\pi(HH) = b + d = \\frac{3}{20} + \\frac{2}{5} = \\frac{3}{20} + \\frac{8}{20} = \\frac{11}{20}$。", "answer": "$$\\boxed{\\frac{11}{20}}$$", "id": "1297471"}, {"introduction": "在许多应用中，我们关心的是一个系统在进入某个不期望的状态（如“严重故障”）之前，先抵达一个特定目标状态的几率。这个问题将引导你学习“首步分析法”（first-step analysis），这是一种计算此类“击中概率”的基本工具。通过对下一步的结果进行条件分析，你可以建立一个方程组，从而系统性地推理并量化不同结局之间的竞争过程，这是分析吸收态马尔可夫链的基石 [@problem_id:1297439]。", "problem": "一台工业机械运行状态的简化模型由一个状态空间为 $S = \\{1, 2, 3, 4\\}$ 的离散时间马尔可夫链描述。各状态定义如下：\n- 状态 1：维护中\n- 状态 2：空闲\n- 状态 3：运行中\n- 状态 4：严重故障\n\n每小时末观察一次机械的状态。一旦机械进入状态 1 或状态 4，它将保持在该状态。对于其他状态，一步转移概率如下：\n\n从状态 2（空闲）出发，机械转移到：\n- 状态 1，概率为 $p_{21} = 0.1$\n- 状态 2，概率为 $p_{22} = 0.5$\n- 状态 3，概率为 $p_{23} = 0.3$\n- 状态 4，概率为 $p_{24} = 0.1$\n\n从状态 3（运行中）出发，机械转移到：\n- 状态 1，概率为 $p_{31} = 0.2$\n- 状态 2，概率为 $p_{32} = 0.4$\n- 状态 3，概率为 $p_{33} = 0.1$\n- 状态 4，概率为 $p_{34} = 0.3$\n\n假设机械当前处于空闲状态（状态 2）。计算它在进入维护中状态（状态 1）之前进入严重故障状态（状态 4）的概率。将您的答案表示为精确分数。", "solution": "我们使用吸收马尔可夫链中的首达概率来为在进入维护中状态（状态 1）之前先进入严重故障状态（状态 4）这一事件建模。设 $h_{i}$ 表示从状态 $i$ 出发，马尔可夫链在到达状态 1 之前先到达状态 4 的概率。由于状态 1 和状态 4 是吸收态，边界条件为 $h_{1}=0$ 和 $h_{4}=1$。对暂态 2 和 3 进行首步分析，我们得到\n$$\nh_{2} = p_{22} h_{2} + p_{23} h_{3} + p_{24}\\cdot 1 + p_{21}\\cdot 0,\n\\quad\nh_{3} = p_{32} h_{2} + p_{33} h_{3} + p_{34}\\cdot 1 + p_{31}\\cdot 0.\n$$\n将给定的转移概率以精确分数形式代入，\n$$\nh_{2} = \\frac{1}{2} h_{2} + \\frac{3}{10} h_{3} + \\frac{1}{10}, \n\\quad\nh_{3} = \\frac{2}{5} h_{2} + \\frac{1}{10} h_{3} + \\frac{3}{10}.\n$$\n整理得，\n$$\n\\left(1 - \\frac{1}{2}\\right) h_{2} - \\frac{3}{10} h_{3} = \\frac{1}{10},\n\\quad\n-\\frac{2}{5} h_{2} + \\left(1 - \\frac{1}{10}\\right) h_{3} = \\frac{3}{10},\n$$\n化简为\n$$\n\\frac{1}{2} h_{2} - \\frac{3}{10} h_{3} = \\frac{1}{10},\n\\quad\n-\\frac{2}{5} h_{2} + \\frac{9}{10} h_{3} = \\frac{3}{10}.\n$$\n两式同乘以 $10$ 得\n$$\n5 h_{2} - 3 h_{3} = 1,\n\\quad\n-4 h_{2} + 9 h_{3} = 3.\n$$\n由第一个方程可得 $h_{2} = \\frac{1 + 3 h_{3}}{5}$。将其代入第二个方程，\n$$\n-4 \\cdot \\frac{1 + 3 h_{3}}{5} + 9 h_{3} = 3\n\\;\\Rightarrow\\;\n-\\frac{4}{5} - \\frac{12}{5} h_{3} + 9 h_{3} = 3\n\\;\\Rightarrow\\;\n\\frac{33}{5} h_{3} - \\frac{4}{5} = 3.\n$$\n同乘以 $5$，\n$$\n33 h_{3} - 4 = 15 \\;\\Rightarrow\\; 33 h_{3} = 19 \\;\\Rightarrow\\; h_{3} = \\frac{19}{33}.\n$$\n则\n$$\nh_{2} = \\frac{1 + 3 \\cdot \\frac{19}{33}}{5} = \\frac{\\frac{33}{33} + \\frac{57}{33}}{5} = \\frac{\\frac{90}{33}}{5} = \\frac{90}{165} = \\frac{6}{11}.\n$$\n因此，从状态 2（空闲）出发，在进入状态 1（维护中）之前进入状态 4（严重故障）的概率为 $\\frac{6}{11}$。", "answer": "$$\\boxed{\\frac{6}{11}}$$", "id": "1297439"}]}