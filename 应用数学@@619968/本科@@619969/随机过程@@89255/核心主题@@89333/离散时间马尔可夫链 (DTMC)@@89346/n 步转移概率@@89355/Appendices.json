{"hands_on_practices": [{"introduction": "在我们深入研究更复杂的矩阵方法之前，让我们从一个直观的练习开始。对于步数较少、状态转移规则清晰的系统，我们可以通过直接追踪所有可能的路径来计算概率。这个练习 [@problem_id:1320861] 将帮助你建立关于多步转移概率的基本直觉，理解其本质是沿着特定事件序列累积概率。", "problem": "一家自动化工厂使用三个专门的机器人工作站——A站（组装）、B站（焊接）和C站（校准）——来处理高科技组件。一个组件在这些工作站之间的流转过程被建模为一个随机过程，其中组件以离散的时间步长从一个站移动到另一个站。组件的移动遵循一组固定的概率规则：\n\n*   从A站出发，组件在下一步总是移动到B站。\n*   从B站出发，组件有50%的概率移动到A站，50%的概率移动到C站。它从不留在B站。\n*   从C站出发，组件有75%的概率被送回A站，25%的概率留在C站进行进一步调整。它从不从C站移动到B站。\n\n一个新组件在A站开始其处理过程。经过恰好三步后，该组件回到A站的概率是多少？", "solution": "设状态为 $A$、$B$ 和 $C$。一步转移概率如下：\n- $P(A \\to B)=1$\n- $P(B \\to A)=\\frac{1}{2}$，$P(B \\to C)=\\frac{1}{2}$，$P(B \\to B)=0$\n- $P(C \\to A)=\\frac{3}{4}$，$P(C \\to C)=\\frac{1}{4}$，$P(C \\to B)=0$\n\n我们要求 $P(X_{3}=A \\mid X_{0}=A)$。根据马尔可夫性质和对中间状态 $X_{1}$ 与 $X_{2}$ 应用的全概率公式，\n$$\nP(X_{3}=A \\mid X_{0}=A)=\\sum_{i \\in \\{A,B,C\\}} \\sum_{j \\in \\{A,B,C\\}} P(X_{1}=i \\mid X_{0}=A)\\,P(X_{2}=j \\mid X_{1}=i)\\,P(X_{3}=A \\mid X_{2}=j).\n$$\n从 $A$ 出发，过程以概率 $1$ 移动到 $B$，所以 $P(X_{1}=B \\mid X_{0}=A)=1$，且 $i \\neq B$ 的项消失。因此，\n$$\nP(X_{3}=A \\mid X_{0}=A)=\\sum_{j \\in \\{A,B,C\\}} P(X_{2}=j \\mid X_{1}=B)\\,P(X_{3}=A \\mid X_{2}=j).\n$$\n从 $B$ 出发，只有两种可能：移动到 $A$ 或 $C$，概率各为 $\\frac{1}{2}$。如果 $X_{2}=A$，那么 $P(X_{3}=A \\mid X_{2}=A)=0$，因为从 $A$ 必须移动到 $B$。如果 $X_{2}=C$，那么 $P(X_{3}=A \\mid X_{2}=C)=\\frac{3}{4}$。因此，\n$$\nP(X_{3}=A \\mid X_{0}=A)=\\left(\\frac{1}{2}\\right)\\cdot 0+\\left(\\frac{1}{2}\\right)\\cdot \\left(\\frac{3}{4}\\right)=\\frac{3}{8}.\n$$\n等价地，唯一有贡献的路径是 $A \\to B \\to C \\to A$，其概率为 $1 \\cdot \\frac{1}{2} \\cdot \\frac{3}{4}=\\frac{3}{8}$。", "answer": "$$\\boxed{\\frac{3}{8}}$$", "id": "1320861"}, {"introduction": "当状态数量增多或步数增加时，逐一列举所有路径会变得非常繁琐。此时，转移矩阵的威力就显现出来了，它是计算n步转移概率的系统性工具。这个练习 [@problem_id:1320922] 将指导你如何利用矩阵乘法，通过计算转移矩阵的n次幂 $P^n$ 来直接得到任意两个状态之间的n步转移概率。", "problem": "一个大学生的每日学习地点可以建模为一个离散时间马尔可夫链。该学生每天从三个地点中选择一个：宿舍、学校图书馆或附近的咖啡馆。在分析了该学生的习惯后，确定了这些地点之间的一日转移概率。\n\n设状态定义如下：\n状态1：宿舍\n状态2：图书馆\n状态3：咖啡馆\n\n转移概率矩阵 $P$ 由下式给出，其中条目 $P_{ij}$ 表示在一天内从状态 $i$ 移动到状态 $j$ 的概率：\n$$\nP = \\begin{pmatrix}\n0.3 & 0.5 & 0.2 \\\\\n0.4 & 0.1 & 0.5 \\\\\n0.6 & 0.3 & 0.1\n\\end{pmatrix}\n$$\n如果该学生在周一在宿舍学习，那么他在接下来的周四在图书馆学习的概率是多少？将您的最终答案四舍五入到三位有效数字。", "solution": "我们将地点之间的每日移动建模为一个具有如下转移矩阵的离散时间马尔可夫链：\n$$\nP=\\begin{pmatrix}\n0.3 & 0.5 & 0.2 \\\\\n0.4 & 0.1 & 0.5 \\\\\n0.6 & 0.3 & 0.1\n\\end{pmatrix}.\n$$\n周一从宿舍开始，求周四在图书馆的概率，这对应于一个三步转移（周一到周二，周二到周三，周三到周四）。根据马尔可夫性质，三步转移概率由 $P^{3}$ 的条目给出。因此，所求的概率是 $(P^{3})_{1,2}$。\n\n计算 $P^{2}=P\\cdot P$：\n$$\nP^{2}=\\begin{pmatrix}\n0.3 & 0.5 & 0.2 \\\\\n0.4 & 0.1 & 0.5 \\\\\n0.6 & 0.3 & 0.1\n\\end{pmatrix}\n\\begin{pmatrix}\n0.3 & 0.5 & 0.2 \\\\\n0.4 & 0.1 & 0.5 \\\\\n0.6 & 0.3 & 0.1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.41 & 0.26 & 0.33 \\\\\n0.46 & 0.36 & 0.18 \\\\\n0.36 & 0.36 & 0.28\n\\end{pmatrix}.\n$$\n那么\n$$\n(P^{3})_{1,2}=\\sum_{k=1}^{3}(P^{2})_{1,k}P_{k,2}=0.41\\cdot 0.5+0.26\\cdot 0.1+0.33\\cdot 0.3=0.33.\n$$\n四舍五入到三位有效数字得到 $0.330$。", "answer": "$$\\boxed{0.330}$$", "id": "1320922"}, {"introduction": "在许多现实世界的应用中，我们关心的是系统在较长时间跨度内的演变。直接计算矩阵的高次幂（如 $P^5$ 或更高）可能计算量巨大。这个练习 [@problem_id:1320892] 介绍了一种更为高效的迭代方法，通过逐步计算每个时间点的状态概率分布，来预测系统在未来某一时刻的状态。这种方法在工程、金融和自然科学的计算建模中非常常见。", "problem": "一座桥梁某部分的结构完整性每年进行评估，并分为四个状态之一：优（E）、良（G）、中（F）或差（P）。桥梁的状况逐年演变，这是一个随机过程。根据历史数据，已经为这些年度转变建立了一个模型。一个部分的状态可以保持不变、改善或恶化。然而，在一年内发生大的变化是极不可能的。具体来说，评级为“优”的部分在一年内不会恶化到“中”或“差”，评级为“良”的部分在一年内不会恶化到“差”。同样，改善也是渐进的：“差”的部分在一年内不能变为“良”或“优”，“中”的部分在一年内不能变为“优”。\n\n一步转移概率由矩阵 $P$ 给出，其中状态按（优、良、中、差）即 (E, G, F, P) 排序：\n$$\nP = \\begin{pmatrix}\n0.70 & 0.30 & 0.00 & 0.00 \\\\\n0.10 & 0.70 & 0.20 & 0.00 \\\\\n0.00 & 0.15 & 0.60 & 0.25 \\\\\n0.00 & 0.00 & 0.10 & 0.90\n\\end{pmatrix}\n$$\n条目 $P_{ij}$ 表示在一年内从状态 $i$ 转移到状态 $j$ 的概率。例如，一个评级为“良”的桥梁部分在一年内恶化为“中”的概率是 $P_{23} = 0.20$。\n\n如果一个桥梁部分目前的评级为“优”，那么五年后该部分被评为“中”的概率是多少？将您的最终答案四舍五入到四位有效数字。", "solution": "我们将年度评级建模为一个时间齐次马尔可夫链，其转移矩阵为 $P$（状态按 $(E,G,F,P)$ 排序）。如果一个部分当前处于状态 E，那么 $n$ 年后的分布为 $e_{1}P^{n}$，其中 $e_{1}=(1,0,0,0)$。因此，五年后处于状态 F 的概率是 $P^{5}$ 的 $(1,3)$ 条目。\n\n为了计算这个值，令 $r_{n}$ 表示 $P^{n}$ 的第一行。那么 $r_{1}$ 是 $P$ 的第一行，且 $r_{n+1}=r_{n}P$。我们迭代计算：\n\n$r_{1} = [0.70,\\,0.30,\\,0.00,\\,0.00]$。\n\n$r_{2} = r_{1}P$，其分量为\n$$\n\\begin{aligned}\nr_{2,1} &= 0.70\\cdot 0.70 + 0.30\\cdot 0.10 = 0.52,\\\\\nr_{2,2} &= 0.70\\cdot 0.30 + 0.30\\cdot 0.70 = 0.42,\\\\\nr_{2,3} &= 0.70\\cdot 0.00 + 0.30\\cdot 0.20 = 0.06,\\\\\nr_{2,4} &= 0.00,\n\\end{aligned}\n$$\n所以 $r_{2}=[0.52,\\,0.42,\\,0.06,\\,0.00]$。\n\n$r_{3} = r_{2}P$，其分量为\n$$\n\\begin{aligned}\nr_{3,1} &= 0.52\\cdot 0.70 + 0.42\\cdot 0.10 = 0.406,\\\\\nr_{3,2} &= 0.52\\cdot 0.30 + 0.42\\cdot 0.70 + 0.06\\cdot 0.15 = 0.459,\\\\\nr_{3,3} &= 0.42\\cdot 0.20 + 0.06\\cdot 0.60 = 0.120,\\\\\nr_{3,4} &= 0.06\\cdot 0.25 = 0.015,\n\\end{aligned}\n$$\n所以 $r_{3}=[0.406,\\,0.459,\\,0.120,\\,0.015]$。\n\n$r_{4} = r_{3}P$，其分量为\n$$\n\\begin{aligned}\nr_{4,1} &= 0.406\\cdot 0.70 + 0.459\\cdot 0.10 = 0.3301,\\\\\nr_{4,2} &= 0.406\\cdot 0.30 + 0.459\\cdot 0.70 + 0.120\\cdot 0.15 = 0.4611,\\\\\nr_{4,3} &= 0.459\\cdot 0.20 + 0.120\\cdot 0.60 + 0.015\\cdot 0.10 = 0.1653,\\\\\nr_{4,4} &= 0.120\\cdot 0.25 + 0.015\\cdot 0.90 = 0.0435,\n\\end{aligned}\n$$\n所以 $r_{4}=[0.3301,\\,0.4611,\\,0.1653,\\,0.0435]$。\n\n$r_{5} = r_{4}P$，其分量为\n$$\n\\begin{aligned}\nr_{5,1} &= 0.3301\\cdot 0.70 + 0.4611\\cdot 0.10 = 0.27718,\\\\\nr_{5,2} &= 0.3301\\cdot 0.30 + 0.4611\\cdot 0.70 + 0.1653\\cdot 0.15 = 0.446595,\\\\\nr_{5,3} &= 0.4611\\cdot 0.20 + 0.1653\\cdot 0.60 + 0.0435\\cdot 0.10 = 0.19575,\\\\\nr_{5,4} &= 0.1653\\cdot 0.25 + 0.0435\\cdot 0.90 = 0.080475.\n\\end{aligned}\n$$\n\n因此，所求概率为 $(P^{5})_{1,3}=r_{5,3}=0.19575$，四舍五入到四位有效数字后为 $0.1958$。", "answer": "$$\\boxed{0.1958}$$", "id": "1320892"}]}