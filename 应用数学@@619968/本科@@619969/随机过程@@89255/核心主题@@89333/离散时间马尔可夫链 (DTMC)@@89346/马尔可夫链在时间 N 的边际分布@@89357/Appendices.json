{"hands_on_practices": [{"introduction": "让我们从一个经典的学习模型开始。这个练习模拟了一个行为实验，其中一个决策（老鼠按哪个杠杆）仅依赖于前一个决策。[@problem_id:1316056] 这个问题的核心价值在于，它教我们如何通过建立和求解一个递推关系，从简单的单步转移概率推导出系统在任意未来时间 $n$ 的状态概率的精确表达式。这是分析小型马尔可夫链动态演化的基本功。", "problem": "在一个行为神经科学实验中，一只大鼠被放置在一个有两个杠杆（一个红色，一个蓝色）的实验箱里。该实验研究大鼠在一系列试验中的学习和选择模式。在任何给定的试验中，大鼠的选择概率被建模为仅取决于其在前一次试验中的选择。\n\n实验数据表明了以下概率模型：\n- 如果大鼠在某次试验中按下了红色杠杆，那么它在下一次试验中再次按下红色杠杆的概率是 $p$。\n- 如果大鼠在某次试验中按下了蓝色杠杆，那么它在下一次试验中按下红色杠杆的概率是 $q$。\n\n假设在第一次试验（试验1）中，大鼠按下红色杠杆的概率是 $r_1$。\n\n推导出一个通用表达式，用于计算大鼠在第 $n$ 次试验（$n \\geq 1$）中按下红色杠杆的概率（我们称之为 $P_n$）。你的答案应该是一个关于 $n$、$p$、$q$ 和 $r_1$ 的封闭形式表达式。为确保模型非平凡且避免某些退化情况，假设 $p \\neq q$ 且 $p-q \\neq 1$。", "solution": "设 $P_n$ 为大鼠在第 $n$ 次试验中按下红色杠杆的概率。设 $R_n$ 和 $B_n$ 分别为大鼠在第 $n$ 次试验中按下红色和蓝色杠杆的事件。我们需要找到 $P_n = P(R_n)$ 的表达式。\n\n我们可以使用全概率公式，根据第 $(n-1)$ 次试验的概率来表示 $P_n$。事件 $R_n$ 可以通过两种互斥的方式发生：大鼠在第 $n-1$ 次试验中选择了红色，然后在第 $n$ 次试验中再次选择红色；或者大鼠在第 $n-1$ 次试验中选择了蓝色，然后在第 $n$ 次试验中选择红色。\n$$P(R_n) = P(R_n | R_{n-1}) P(R_{n-1}) + P(R_n | B_{n-1}) P(B_{n-1})$$\n\n根据题目陈述，我们有以下条件概率：\n1.  $P(R_n | R_{n-1}) = p$\n2.  $P(R_n | B_{n-1}) = q$\n\n此外，在第 $n-1$ 次试验中选择红色的概率是 $P(R_{n-1}) = P_{n-1}$。因为只有两个杠杆，所以在第 $n-1$ 次试验中选择蓝色的概率是 $P(B_{n-1}) = 1 - P(R_{n-1}) = 1 - P_{n-1}$。\n\n将这些代入 $P(R_n)$ 的方程中：\n$$P_n = p \\cdot P_{n-1} + q \\cdot (1 - P_{n-1})$$\n$$P_n = p P_{n-1} + q - q P_{n-1}$$\n$$P_n = (p - q) P_{n-1} + q$$\n这是一个关于 $P_n$ 的线性一阶非齐次递推关系，对 $n \\geq 2$ 成立。\n\n为了解这个递推关系，我们首先找到不动点，或称稳态概率 $P^*$。这是使 $P_n = P_{n-1} = P^*$ 成立的值。\n$$P^* = (p-q)P^* + q$$\n$$P^*(1 - (p-q)) = q$$\n$$P^* = \\frac{q}{1 - p + q}$$\n这个不动点存在，因为题目说明了 $p-q \\neq 1$，这保证了分母 $1-p+q$ 不为零。\n\n现在，我们定义一个新序列 $d_n = P_n - P^*$。\n$$d_n = P_n - \\frac{q}{1-p+q}$$\n让我们代入 $P_n$ 的递推关系：\n$$d_n = ((p-q)P_{n-1} + q) - \\frac{q}{1-p+q}$$\n回想一下，$P_{n-1} = d_{n-1} + P^* = d_{n-1} + \\frac{q}{1-p+q}$。\n$$d_n = (p-q)\\left(d_{n-1} + \\frac{q}{1-p+q}\\right) + q - \\frac{q}{1-p+q}$$\n$$d_n = (p-q)d_{n-1} + \\frac{(p-q)q}{1-p+q} + \\frac{q(1-p+q) - q}{1-p+q}$$\n$$d_n = (p-q)d_{n-1} + \\frac{pq - q^2}{1-p+q} + \\frac{q - pq + q^2 - q}{1-p+q}$$\n$$d_n = (p-q)d_{n-1} + \\frac{pq - q^2 - pq + q^2}{1-p+q}$$\n$$d_n = (p-q)d_{n-1}$$\n这是一个简单的等比数列。其解为 $d_n = (p-q)^{n-1} d_1$。\n\n现在我们求 $d_1$。第一次试验的初始条件为：$P_1 = r_1$。\n$$d_1 = P_1 - P^* = r_1 - \\frac{q}{1-p+q}$$\n将此代回 $d_n$ 的表达式中：\n$$d_n = \\left(r_1 - \\frac{q}{1-p+q}\\right) (p-q)^{n-1}$$\n\n最后，我们通过代回 $d_n = P_n - P^*$ 来求得 $P_n$：\n$$P_n - \\frac{q}{1-p+q} = \\left(r_1 - \\frac{q}{1-p+q}\\right) (p-q)^{n-1}$$\n$$P_n = \\frac{q}{1-p+q} + \\left(r_1 - \\frac{q}{1-p+q}\\right) (p-q)^{n-1}$$\n这就是大鼠在第 $n$ 次试验中按下红色杠杆的概率的通用表达式。约束条件 $p \\neq q$ 确保了因子 $(p-q)$ 不为零，我们在推导中已隐式地使用了这一点。", "answer": "$$\\boxed{\\frac{q}{1-p+q} + \\left(r_1 - \\frac{q}{1-p+q}\\right)(p-q)^{n-1}}$$", "id": "1316056"}, {"introduction": "虽然递推关系对于状态少的系统非常有效，但当系统状态增多时，直接进行矩阵运算会是更强大和系统化的方法。这个练习模拟了一个计算机内存控制器在不同状态间的跳转。[@problem_id:1316084] 通过直接计算概率向量与转移矩阵的乘积，我们能够一步步地追踪系统在特定时刻（例如第3个时间步）的概率分布，这为处理更复杂的现实世界系统提供了直接的计算实践。", "problem": "一个计算机内存控制器的简化模型跟踪两个关键、独立的内存块的状态。该系统可能处于四种状态之一，$\\mathcal{S} = \\{S_1, S_2, S_3, S_4\\}$，分别代表两个内存块的状况：\n- $S_1$：两个内存块都处于空闲状态。\n- $S_2$：第一个内存块处于活动状态，第二个处于空闲状态。\n- $S_3$：第一个内存块处于空闲状态，第二个处于活动状态。\n- $S_4$：两个内存块都处于活动状态。\n\n系统状态随离散时间步演化，遵循一个齐次马尔可夫链 $X_n$。一步转移概率矩阵 $P$ 由下式给出，其中 $P_{ij}$ 是系统在单个时间步内从状态 $S_i$ 转移到状态 $S_j$ 的概率：\n$$\nP = \\begin{pmatrix}\n0.1 & 0.5 & 0.3 & 0.1 \\\\\n0.4 & 0.2 & 0.2 & 0.2 \\\\\n0.2 & 0.1 & 0.4 & 0.3 \\\\\n0.1 & 0.2 & 0.3 & 0.4\n\\end{pmatrix}\n$$\n在时间 $n=0$ 时，系统初始化为两个内存块都处于空闲状态，这意味着过程从状态 $S_1$ 开始。\n\n计算在时间 $n=3$ 时恰好有一个内存块处于活动状态的概率。将最终答案四舍五入到四位有效数字。", "solution": "我们将系统建模为一个齐次马尔可夫链，其状态空间为 $\\mathcal{S}=\\{S_{1},S_{2},S_{3},S_{4}\\}$，转移矩阵为 $P$。设 $p_{n}$ 为时间 $n$ 时的状态概率行向量。初始状态为 $S_1$，我们有\n$$\np_{0}=\\begin{pmatrix}1 & 0 & 0 & 0\\end{pmatrix}, \\quad p_{n}=p_{0}P^{n}.\n$$\n计算 $p_{1}=p_{0}P$，即 $P$ 的第一行：\n$$\np_{1}=\\begin{pmatrix}0.1 & 0.5 & 0.3 & 0.1\\end{pmatrix}.\n$$\n接下来，计算 $p_{2}=p_{1}P$。其各分量为\n$$\np_{2}(1)=0.1\\cdot 0.1+0.5\\cdot 0.4+0.3\\cdot 0.2+0.1\\cdot 0.1=0.28,\n$$\n$$\np_{2}(2)=0.1\\cdot 0.5+0.5\\cdot 0.2+0.3\\cdot 0.1+0.1\\cdot 0.2=0.20,\n$$\n$$\np_{2}(3)=0.1\\cdot 0.3+0.5\\cdot 0.2+0.3\\cdot 0.4+0.1\\cdot 0.3=0.28,\n$$\n$$\np_{2}(4)=0.1\\cdot 0.1+0.5\\cdot 0.2+0.3\\cdot 0.3+0.1\\cdot 0.4=0.24,\n$$\n所以\n$$\np_{2}=\\begin{pmatrix}0.28 & 0.20 & 0.28 & 0.24\\end{pmatrix}.\n$$\n然后计算 $p_{3}=p_{2}P$。其各分量为\n$$\np_{3}(1)=0.28\\cdot 0.1+0.20\\cdot 0.4+0.28\\cdot 0.2+0.24\\cdot 0.1=0.188,\n$$\n$$\np_{3}(2)=0.28\\cdot 0.5+0.20\\cdot 0.2+0.28\\cdot 0.1+0.24\\cdot 0.2=0.256,\n$$\n$$\np_{3}(3)=0.28\\cdot 0.3+0.20\\cdot 0.2+0.28\\cdot 0.4+0.24\\cdot 0.3=0.308,\n$$\n$$\np_{3}(4)=0.28\\cdot 0.1+0.20\\cdot 0.2+0.28\\cdot 0.3+0.24\\cdot 0.4=0.248,\n$$\n所以\n$$\np_{3}=\\begin{pmatrix}0.188 & 0.256 & 0.308 & 0.248\\end{pmatrix}.\n$$\n恰好有一个内存块处于活动状态对应于状态 $S_2$ 或 $S_3$，因此\n$$\n\\mathbb{P}(X_{3}\\in\\{S_{2},S_{3}\\}\\mid X_{0}=S_{1})=p_{3}(2)+p_{3}(3)=0.564.\n$$\n四舍五入到四位有效数字，结果是 $0.5640$。", "answer": "$$\\boxed{0.5640}$$", "id": "1316084"}, {"introduction": "在处理更复杂的随机过程时，我们有时会遇到一些“捷径”，它们能让我们绕过复杂的细节，直击问题的核心。这个练习探讨了群体遗传学中著名的 Wright-Fisher 模型，直接计算等位基因在第 $n$ 代的具体分布是极为复杂的。[@problem_id:1316108] 然而，通过巧妙地运用期望的性质，特别是全期望定律，我们可以为一个看似复杂、依赖于“存活”事件的条件期望，找到一个异常简洁的表达式。这个问题展示了从计算概率分布到计算期望值的思维转变，这是一种在高级随机过程分析中至关重要的高阶技巧。", "problem": "在群体遗传学的中性Wright-Fisher模型中，一个大小固定为 $N$ 的群体中携带特定等位基因 'A' 的个体数量 $X_n$ 随离散的世代 $n=0, 1, 2, \\dots$ 演化。$X_n$ 的过程是状态空间为 $\\{0, 1, \\dots, N\\}$ 的马尔可夫链。下一代中的等位基因数量 $X_{n+1}$ 服从试验次数为 $N$、成功概率为 $p=X_n/N$ 的二项分布。该过程以 $X_0 = i$ 个个体开始，其中 $1 \\le i \\le N-1$。如果等位基因的数量达到 0 则认为其丢失，如果达到 $N$ 则认为其固定。令 $T$ 为等位基因丢失或固定的第一个世代（即 $T = \\min\\{n \\ge 0 \\mid X_n=0 \\text{ or } X_n=N\\}$）。\n\n定义量 $H_n = X_n(N-X_n)$，它与群体在第 $n$ 代的遗传杂合度成正比。令 $S_n(i) = P(T > n | X_0 = i)$ 为在第 $n$ 代等位基因仍在分离（既未丢失也未固定）的概率。令 $E_n^*(i)$ 为在该存活事件下 $H_n$ 的条件期望值，即 $E_n^*(i) = E[H_n | T > n, X_0=i]$。\n\n这两个量 $S_n(i)$ 和 $E_n^*(i)$，作为 $n$ 的函数，各自的计算都非常复杂。然而，它们的乘积却出人意料地简单。请找出乘积 $P(i,n) = S_n(i) \\times E_n^*(i)$ 的一个闭式解析表达式，用 $N$、$n$ 和 $i$ 表示。", "solution": "我们首先将乘积 $P(i,n) = S_{n}(i) \\times E_{n}^{*}(i)$ 改写成一个可以直接计算的形式。根据定义，\n$$\nS_{n}(i) = P(T>n \\mid X_{0}=i), \\quad E_{n}^{*}(i) = E[H_{n} \\mid T>n, X_{0}=i], \\quad H_{n} = X_{n}(N - X_{n}).\n$$\n因此，\n$$\nP(i,n) = P(T>n \\mid X_{0}=i)\\, E[H_{n} \\mid T>n, X_{0}=i] = E[H_{n} \\,\\mathbf{1}_{\\{T>n\\}} \\mid X_{0}=i].\n$$\n然而，根据Wright-Fisher链的吸收性质，如果 $T \\leq n$，则 $X_{n} \\in \\{0, N\\}$，这意味着 $H_{n} = X_{n}(N - X_{n}) = 0$。因此 $H_{n} \\mathbf{1}_{\\{T \\leq n\\}} = 0$，所以\n$$\nE[H_{n} \\mid X_{0}=i] = E[H_{n} \\mathbf{1}_{\\{T>n\\}} \\mid X_{0}=i] = P(i,n).\n$$\n所以该乘积等于无条件期望：\n$$\nP(i,n) = E[H_{n} \\mid X_{0}=i].\n$$\n\n我们现在为中性Wright-Fisher模型计算 $E[H_{n} \\mid X_{0}=i]$。在给定 $X_{n}$ 的条件下，下一代满足\n$$\nX_{n+1} \\mid X_{n} \\sim \\operatorname{Bin}\\!\\left(N, \\frac{X_{n}}{N}\\right).\n$$\n因此，利用二项分布的矩，\n$$\nE[X_{n+1} \\mid X_{n}] = X_{n}, \\qquad \\operatorname{Var}(X_{n+1} \\mid X_{n}) = \\frac{X_{n}(N - X_{n})}{N}.\n$$\n因此，\n$$\nE[X_{n+1}^{2} \\mid X_{n}] = \\operatorname{Var}(X_{n+1} \\mid X_{n}) + \\left(E[X_{n+1} \\mid X_{n}]\\right)^{2} = \\frac{X_{n}(N - X_{n})}{N} + X_{n}^{2}.\n$$\n使用 $H_{n} = X_{n}(N - X_{n}) = N X_{n} - X_{n}^{2}$，我们计算 $H_{n+1}$ 的条件期望：\n$$\nE[H_{n+1} \\mid X_{n}] = E\\big[N X_{n+1} - X_{n+1}^{2} \\mid X_{n}\\big] = N E[X_{n+1} \\mid X_{n}] - E[X_{n+1}^{2} \\mid X_{n}].\n$$\n代入上述表达式可得\n$$\nE[H_{n+1} \\mid X_{n}] = N X_{n} - \\left(\\frac{X_{n}(N - X_{n})}{N} + X_{n}^{2}\\right) = X_{n}(N - X_{n})\\left(1 - \\frac{1}{N}\\right) = \\left(1 - \\frac{1}{N}\\right) H_{n}.\n$$\n取期望并使用迭代期望定律，\n$$\nE[H_{n+1} \\mid X_{0}=i] = E\\!\\left[\\,E[H_{n+1} \\mid X_{n}] \\,\\middle|\\, X_{0}=i \\right] = \\left(1 - \\frac{1}{N}\\right) E[H_{n} \\mid X_{0}=i].\n$$\n初始值为 $H_{0} = i(N - i)$（因为 $X_{0}=i$ 是确定性的），通过归纳法从该递推关系可得\n$$\nE[H_{n} \\mid X_{0}=i] = \\left(1 - \\frac{1}{N}\\right)^{n} i (N - i).\n$$\n由于 $P(i,n) = E[H_{n} \\mid X_{0}=i]$，我们得出结论\n$$\nP(i,n) = i (N - i) \\left(1 - \\frac{1}{N}\\right)^{n}.\n$$\n这就是所求的用 $N$、$n$ 和 $i$ 表示的闭式解析表达式。", "answer": "$$\\boxed{i\\left(N - i\\right)\\left(1 - \\frac{1}{N}\\right)^{n}}$$", "id": "1316108"}]}