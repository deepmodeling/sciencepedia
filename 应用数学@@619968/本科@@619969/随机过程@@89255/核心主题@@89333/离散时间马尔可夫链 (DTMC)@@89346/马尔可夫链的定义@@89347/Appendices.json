{"hands_on_practices": [{"introduction": "要掌握马尔可夫链的定义，关键在于理解其“无记忆性”。这个练习通过一个经典的连续抛硬币场景，构建了一个随机过程。你的任务是判断这个过程的未来状态是否只依赖于当前状态，从而检验你对马尔可夫性质核心思想的理解。[@problem_id:1295273]", "problem": "考虑一个独立同分布（IID）的掷硬币序列。设得到正面（H）的概率为 $p$，得到反面（T）的概率为 $1-p$，其中 $0 < p < 1$。\n\n基于此抛掷序列定义一个随机过程 $\\{X_n\\}_{n \\geq 1}$。对于每个时间步 $n \\geq 1$，随机变量 $X_n$ 表示在时间 $n$ 结束的当前未中断的连续正面的长度。如果第 $n$ 次抛掷为反面，则连续正面中断，其长度定义为 0。例如，如果抛掷序列为 H, H, T, H，则该过程对应的状态序列为 $X_1 = 1, X_2 = 2, X_3 = 0, X_4 = 1$。该过程的状态空间是非负整数集合，$S = \\{0, 1, 2, \\dots\\}$。\n\n该过程 $\\{X_n\\}_{n \\geq 1}$ 是一个马尔可夫链吗？请从以下选项中选择正确的陈述和理由。\n\nA. 是，因为 $X_{n+1}$ 的值完全由 $X_n$ 的值确定。\n\nB. 是，因为未来状态 $X_{n+1}$ 的条件概率分布仅依赖于当前状态 $X_n$，而不依赖于它之前的状态序列。\n\nC. 否，因为要确定 $X_{n+1}$，不仅必须知道 $X_n$，还必须知道第 $(n+1)$ 次掷硬币的结果。\n\nD. 否，因为状态 $X_{n+1}$ 依赖于直到时间 $n+1$ 的整个掷硬币历史，而不仅仅是时间 $n$ 的状态。\n\nE. 否，因为状态空间是无限的，而具有无限状态空间的过程不能是马尔可夫链。", "solution": "设 $\\{Y_{n}\\}_{n \\geq 1}$ 为独立同分布的掷硬币结果，其中 $Y_{n}=1$ 代表正面，$Y_{n}=0$ 代表反面，且 $\\mathbb{P}(Y_{n}=1)=p$ 和 $\\mathbb{P}(Y_{n}=0)=1-p$。根据定义，$X_n$ 是在时间 $n$ 结束的当前连续正面的长度，因此它满足以下递归更新\n$$\nX_{n+1}=\n\\begin{cases}\nX_{n}+1, & \\text{如果 } Y_{n+1}=1,\\\\\n0, & \\text{如果 } Y_{n+1}=0.\n\\end{cases}\n$$\n固定 $n \\geq 1$ 以及过去状态的任意实现 $X_{1}=x_{1},\\dots,X_{n-1}=x_{n-1},X_{n}=i$。因为 $Y_{n+1}$ 独立于 $(Y_{1},\\dots,Y_{n})$，并且过程 $\\{X_{k}\\}$ 是 $(Y_{1},\\dots,Y_{k})$ 的可测函数，所以我们有 $Y_{n+1}$ 独立于由 $(X_{1},\\dots,X_{n})$ 生成的 sigma-代数。因此，\n$$\n\\mathbb{P}(X_{n+1}=i+1 \\mid X_{n}=i, X_{n-1}=x_{n-1},\\dots,X_{1}=x_{1})\n= \\mathbb{P}(Y_{n+1}=1 \\mid X_{n}=i, X_{n-1}=x_{n-1},\\dots,X_{1}=x_{1})=p,\n$$\n并且\n$$\n\\mathbb{P}(X_{n+1}=0 \\mid X_{n}=i, X_{n-1}=x_{n-1},\\dots,X_{1}=x_{1})\n= \\mathbb{P}(Y_{n+1}=0 \\mid X_{n}=i, X_{n-1}=x_{n-1},\\dots,X_{1}=x_{1})=1-p,\n$$\n且对于所有 $j \\notin \\{0,i+1\\}$，\n$$\n\\mathbb{P}(X_{n+1}=j \\mid X_{n}=i, X_{n-1}=x_{n-1},\\dots,X_{1}=x_{1})=0.\n$$\n这些条件概率中的每一个都仅依赖于当前状态 $i=X_n$，而不依赖于更早的状态 $(X_{1},\\dots,X_{n-1})$。因此，该过程满足马尔可夫性质：\n$$\n\\mathbb{P}(X_{n+1}=j \\mid X_{n}=i, X_{n-1},\\dots,X_{1})=\\mathbb{P}(X_{n+1}=j \\mid X_{n}=i).\n$$\n因此 $\\{X_{n}\\}$ 是一个马尔可夫链，其转移概率为\n$$\n\\mathbb{P}(i \\to i+1)=p,\\quad \\mathbb{P}(i \\to 0)=1-p,\\quad \\mathbb{P}(i \\to j)=0 \\text{ for } j \\notin \\{0,i+1\\}.\n$$\n选项 A 是不正确的，因为 $X_{n+1}$ 并非仅由 $X_{n}$ 确定；它是随机的，由第 $(n+1)$ 次抛掷驱动。选项 C 错误地陈述了马尔可夫性质：虽然实现值使用了新的随机性，但给定 $X_n$ 的条件分布就足够了。选项 D 是错误的，因为 $X_{n+1}$ 的分布并不依赖于整个历史。选项 E 是错误的，因为马尔可夫链可以有无限的状态空间。因此，正确的陈述是 B。", "answer": "$$\\boxed{B}$$", "id": "1295273"}, {"introduction": "识别一个过程不具备马尔可夫性质，与证明它具备同样重要。本练习提供了一个带有“动量”效应的城市交通模型，这使得未来的交通状况不仅取决于当前，还与过去的状态有关。通过分析此模型，你将学会精确地区分违反马尔可夫性质的核心原因与其他特性（如时变转移概率）的差异。[@problem_id:1295286]", "problem": "一位城市系统分析师正在为一个市中心的交通拥堵开发一个随机模型。该模型按小时描述拥堵水平，记为过程 $C_n$，其中小时数 $n \\geq 0$。拥堵水平的状态空间为 $S = \\{\\text{低, 中, 高}\\}$。\n\n该过程的动态由以下两个主要观察结果描述：\n\n1.  城市采用了一套自适应交通信号系统，该系统会根据一天中的不同时间进行调整。因此，拥堵从一个级别恶化到下一个级别的概率是与时间相关的。例如，拥堵水平在第 $n$ 小时为“低”并在第 $n+1$ 小时转移到“中”的概率，记为 $P(C_{n+1}=\\text{Medium} | C_n=\\text{Low})$，在早高峰时段的值与深夜时的值不同。\n\n2.  该模型还考虑了交通流中的“惯性”效应。这通过以下规则进行形式化：拥堵从中级升级到高级的概率，取决于拥堵是否已经处于加剧的过程中。对于任何小时 $n \\geq 1$，模型规定，在第 $n$ 小时为“中”级拥堵且第 $n-1$ 小时为“低”级拥堵的条件下，第 $n+1$ 小时达到“高”级拥堵的概率，不等于在第 $n$ 小时和第 $n-1$ 小时均为“中”级拥堵的条件下，第 $n+1$ 小时达到“高”级拥堵的概率。数学上表示为：\n    $$ P(C_{n+1}=\\text{High} | C_n=\\text{Medium}, C_{n-1}=\\text{Low}) \\neq P(C_{n+1}=\\text{High} | C_n=\\text{Medium}, C_{n-1}=\\text{Medium}) $$\n\n根据马尔可夫链的基本定义，以下哪个陈述是过程 $C_n$ 不是马尔可夫链的根本原因？\n\nA. 状态（低、中、高）是定性的而非数值的。\n\nB. 状态之间的转移概率依赖于具体的小时数 $n$。\n\nC. 该过程的状态数量是有限的。\n\nD. 未来状态的概率除了依赖于当前状态外，还依赖于过去的状态。\n\nE. 某些状态之间的转移可能是不可能的（即概率为零）。", "solution": "要确定为什么过程 $C_n$ 不是一个马尔可夫链，我们必须首先回顾马尔可夫链的定义。\n\n一个在状态空间 $S$ 中取值的离散时间随机过程 $\\{X_n : n \\ge 0\\}$，如果它满足马尔可夫性质，则被称为马尔可夫链。马尔可夫性质指出，过程的未来演化仅取决于其当前状态，而与其过去的历史无关。更正式地说，对于任何时间 $n \\ge 0$ 以及来自状态空间 $S$ 的任意状态序列 $i_0, i_1, \\dots, i_n, j$，以下等式必须成立：\n$$ P(X_{n+1} = j | X_n = i_n, X_{n-1} = i_{n-1}, \\dots, X_0 = i_0) = P(X_{n+1} = j | X_n = i_n) $$\n如果过程的历史比单独的当前状态为下一个状态提供了更多信息，那么马尔可夫性质就被违反了。\n\n现在，让我们根据这个定义来分析交通模型 $C_n$ 的两个特征。\n\n1.  **与时间相关的转移概率**：第一个特征指出，像 $P(C_{n+1}=\\text{Medium} | C_n=\\text{Low})$ 这样的转移概率明确地依赖于时间步长 $n$。这个性质关系到马尔可夫链是否是*时间齐次的*。如果对于所有状态 $i, j$，$P(X_{n+1} = j | X_n = i)$ 都与 $n$ 无关，则该马尔可夫链是时间齐次的。如果这个概率确实依赖于 $n$，该过程被称为*时间非齐次马尔可夫链*。然而，一个时间非齐次的过程仍然可以是一个马尔可夫链，只要它满足核心的马尔可夫性质（即，在给定当前状态的条件下，未来与过去无关）。因此，转移概率的时间依赖性本身并不违反马尔可夫性质。这意味着选项 B 不是根本原因。\n\n2.  **“惯性”效应**：第二个特征指出，对于 $n \\ge 1$：\n    $$ P(C_{n+1}=\\text{High} | C_n=\\text{Medium}, C_{n-1}=\\text{Low}) \\neq P(C_{n+1}=\\text{High} | C_n=\\text{Medium}, C_{n-1}=\\text{Medium}) $$\n    让我们检查这是否与马尔可夫性质一致。根据马尔可夫性质，在时间 $n+1$ 的状态概率应该只取决于在时间 $n$ 的状态。这意味着：\n    $$ P(C_{n+1}=\\text{High} | C_n=\\text{Medium}, C_{n-1}=\\text{Low}) $$\n    必须等于\n    $$ P(C_{n+1}=\\text{High} | C_n=\\text{Medium}) $$\n    并且类似地，\n    $$ P(C_{n+1}=\\text{High} | C_n=\\text{Medium}, C_{n-1}=\\text{Medium}) $$\n    也必须等于\n    $$ P(C_{n+1}=\\text{High} | C_n=\\text{Medium}) $$\n    如果该过程是一个马尔可夫链，那么必然得出：\n    $$ P(C_{n+1}=\\text{High} | C_n=\\text{Medium}, C_{n-1}=\\text{Low}) = P(C_{n+1}=\\text{High} | C_n=\\text{Medium}, C_{n-1}=\\text{Medium}) $$\n    然而，问题陈述明确指出这两个概率是不相等的。这直接违反了马尔可夫性质。在时间 $n-1$ 的状态（过去）为时间 $n+1$ 的状态（未来）提供了额外的信息，即使在时间 $n$ 的状态（现在）已知的情况下也是如此。因此，过程 $C_n$ 不是一个马尔可夫链。这对应于选项 D。\n\n让我们简要评估其他选项：\n- A: 状态的标签不影响一个过程是否为马尔可夫链。定性状态是完全可以接受的。\n- C: 拥有有限状态空间是许多常见马尔可夫链的特征（这些被称为有限状态马尔可夫链）。它不是一个过程不满足马尔可夫性质的原因。\n- E: 在马尔可夫链中，概率为零的转移是允许的。例如，在单个小时内从“高”拥堵状态转移到“低”拥堵状态可能是不可能的。\n\n因此，该过程不是马尔可夫链的根本原因是，未来状态的概率除了依赖于当前状态外，还依赖于过去的状态。", "answer": "$$\\boxed{D}$$", "id": "1295286"}, {"introduction": "在现实世界中，许多过程本身可能不满足马尔可夫性质，但它们往往是一个更大马尔可夫系统的一部分。这个问题通过一个受天气影响的自动驾驶汽车的例子，引入了“状态增广”这一强大技术。通过重新定义“状态”，将外部影响因素（如此处的天气）包含进来，我们常常可以恢复一个系统的马尔可夫性质，这在随机建模中是一个至关重要的技巧。[@problem_id:1295253]", "problem": "一辆自动驾驶汽车沿着一维轨道运行，该轨道可以用整数集 $\\mathbb{Z}$ 来表示。汽车的状态在离散时间步 $n=0, 1, 2, \\dots$ 更新。设 $V_n$ 表示汽车在时刻 $n$ 在轨道上的位置。\n\n汽车的运动受天气影响。设 $W_n$ 为时刻 $n$ 的天气状态，天气可以是“晴天”或“雨天”。天气过程本身是随机演变的：时刻 $n+1$ 的天气仅在概率上依赖于时刻 $n$ 的天气。天气状态之间的转移概率都严格介于 0 和 1 之间。\n\n在每个时间步，汽车从其当前位置 $V_n$ 移动一个单位，向右 ($V_{n+1} = V_n + 1$) 或向左 ($V_{n+1} = V_n - 1$) 。向右移动的概率取决于该时间步的天气 $W_n$：\n- 如果 $W_n = \\text{晴天}$，向右移动的概率为 $p_S$。\n- 如果 $W_n = \\text{雨天}$，向右移动的概率为 $p_R$。\n\n假设 $0 < p_S < 1$，$0 < p_R < 1$，并且重要的是，$p_S \\neq p_R$。天气的演变不依赖于汽车的位置或运动历史。\n\n如果对于所有时间步 $n$ 和所有可能的状态，下一个状态 $X_{n+1}$ 在给定过程的整个历史 $\\{X_0, X_1, \\dots, X_n\\}$ 的条件下的概率仅依赖于当前状态 $X_n$，那么随机过程 $\\{X_n\\}$ 被定义为马尔可夫链。\n\n考虑以下陈述：\nI. 汽车位置的过程 $\\{V_n\\}_{n \\ge 0}$ 是一个马尔可夫链。\nII. 天气过程 $\\{W_n\\}_{n \\ge 0}$ 是一个马尔可夫链。\nIII. 位置和天气的组合状态过程 $\\{(V_n, W_n)\\}_{n \\ge 0}$ 是一个马尔可夫链。\n\n上述陈述中哪些是正确的？\n\nA. 仅 II\n\nB. 仅 III\n\nC. 仅 I 和 II\n\nD. 仅 I 和 III\n\nE. 仅 II 和 III\n\nF. I、II 和 III\n\nG. 所有陈述都不正确。", "solution": "我们根据马尔可夫性质的定义来分析每个陈述：一个过程 $\\{X_n\\}$ 要成为马尔可夫链，必须对所有的 $n$ 和所有状态满足，\n$$\n\\mathbb{P}(X_{n+1} \\in A \\mid X_0, X_1, \\dots, X_n) = \\mathbb{P}(X_{n+1} \\in A \\mid X_n).\n$$\n\n首先，天气过程 $\\{W_n\\}$ 根据其构造是马尔可夫的：题目明确指出时刻 $n+1$ 的天气仅在概率上依赖于时刻 $n$ 的天气，且转移概率严格介于 $0$ 和 $1$ 之间。因此，对所有的 $n$，\n$$\n\\mathbb{P}(W_{n+1}=w' \\mid W_0, W_1, \\dots, W_n) = \\mathbb{P}(W_{n+1}=w' \\mid W_n),\n$$\n所以陈述 II 是正确的。\n\n其次，考虑联合过程 $\\{(V_n, W_n)\\}$。给定 $(V_n, W_n)$，下一个状态对 $(V_{n+1}, W_{n+1})$ 按如下方式确定：\n- 根据天气的马尔可夫性质，$W_{n+1}$ 仅依赖于 $W_n$。\n- $V_{n+1}$ 通过以下方式依赖于 $(V_n, W_n)$\n$$\n\\mathbb{P}(V_{n+1}=V_n+1 \\mid V_n, W_n) =\n\\begin{cases}\np_S, & W_n=\\text{晴天},\\\\\np_R, & W_n=\\text{雨天},\n\\end{cases}\n$$\n并且 $\\mathbb{P}(V_{n+1}=V_n-1 \\mid V_n, W_n)=1$ 减去上述概率。\n因此，对于任何历史，\n$$\n\\mathbb{P}\\big((V_{n+1}, W_{n+1}) \\in B \\mid (V_0, W_0), \\dots, (V_n, W_n)\\big)\n$$\n仅依赖于 $(V_n, W_n)$，所以 $\\{(V_n, W_n)\\}$ 是一个马尔可夫链，陈述 III 是正确的。\n\n第三，我们检验 $\\{V_n\\}$ 本身是否是马尔可夫的。定义 $\\Delta_n := V_{n+1}-V_n \\in \\{-1, 1\\}$。那么对于任何位置历史，\n$$\n\\mathbb{P}(\\Delta_n=1 \\mid V_0, V_1, \\dots, V_n)\n= \\mathbb{E}\\big[ \\mathbb{P}(\\Delta_n=1 \\mid V_0, \\dots, V_n, W_n) \\mid V_0, \\dots, V_n \\big]\n= p_S \\,\\mathbb{P}(W_n=\\text{晴天} \\mid V_0, \\dots, V_n) + p_R \\,\\mathbb{P}(W_n=\\text{雨天} \\mid V_0, \\dots, V_n).\n$$\n因为 $p_S \\neq p_R$，上述项依赖于后验概率 $\\mathbb{P}(W_n=\\text{晴天} \\mid V_0, \\dots, V_n)$。在给定模型下，直到时刻 $n$ 的位置是通过增量序列 $\\Delta_0, \\dots, \\Delta_{n-1}$ 生成的，其中每个 $\\Delta_k$ 依赖于 $W_k$。由于天气是一个马尔可夫链，$W_n$ 依赖于 $W_{n-1}$，而 $W_{n-1}$ 又会从观测到的过去增量（也就是整个位置历史）中获得统计信息，而不仅仅是从当前位置 $V_n$ 中获得。因此，滤波概率 $\\mathbb{P}(W_n=\\text{晴天} \\mid V_0, \\dots, V_n)$ 通常是整个历史的函数，而不仅仅是 $V_n$ 的函数。因此，\n$$\n\\mathbb{P}(V_{n+1}=V_n+1 \\mid V_0, \\dots, V_n)\n$$\n通过该后验概率依赖于整个过去，并且通常不能简化为仅关于 $V_n$ 的函数。这违反了 $\\{V_n\\}$ 的马尔可夫性质，所以陈述 I 通常是错误的。\n\n一个具体的两步示例可以明确地说明这种依赖性。设 $n=1$，并考虑两个都结束于 $V_1=1$ 但 $V_0$ 不同的历史：\n- 如果 $(V_0, V_1)=(0,1)$，则 $\\Delta_0=+1$；当 $p_S>p_R$ 时，这使得 $W_0=\\text{晴天}$ 比 $W_0=\\text{雨天}$ 更有可能，而当 $p_S<p_R$ 时则可能性更小。因为 $W_1$ 通过天气转移矩阵依赖于 $W_0$，这会使 $\\mathbb{P}(W_1=\\text{晴天} \\mid V_0, V_1)$ 相对于其先验概率发生偏移。\n- 如果 $(V_0, V_1)=(2,1)$，则 $\\Delta_0=-1$，产生相反的偏移。\n因此\n$$\n\\mathbb{P}(V_2=2 \\mid V_1=1, V_0=0) \\neq \\mathbb{P}(V_2=2 \\mid V_1=1, V_0=2)\n$$\n只要 $p_S \\neq p_R$ 并且天气转移定律依赖于当前天气状态，这就证明了 $\\{V_n\\}$ 不是马尔可夫链。\n\n总结：II 是正确的；III 是正确的；在所述模型下（$p_S \\neq p_R$），I 是错误的。因此，正确选项是仅 II 和 III。", "answer": "$$\\boxed{E}$$", "id": "1295253"}]}