{"hands_on_practices": [{"introduction": "这个练习将带你入门转移概率矩阵最直接的应用。我们将学习如何利用矩阵中的概率来计算一个系统沿特定状态序列演变的概率。这个基本技能是理解和应用马尔可夫链模型的基石 [@problem_id:1345202]。", "problem": "一个简化模型描述了一个粒子的状态，该粒子可以占据三个离散能阱之一，分别标记为状态1、状态2和状态3。该过程被建模为一个离散时间马尔可夫链。在时间 $t$ 从状态 $i$ 转移到在时间 $t+1$ 到达状态 $j$ 的过程由概率 $P_{ij}$ 给出，其中转移概率矩阵 $P$ 定义如下：\n$$\nP = \\begin{pmatrix}\n0.2 & 0.5 & 0.3 \\\\\n0.4 & 0.1 & 0.5 \\\\\n0.7 & 0.2 & 0.1\n\\end{pmatrix}\n$$\n假设在初始时间 $t=0$ 时，粒子总是处于状态1。\n计算在时间 $t=1$ 时观察到粒子处于状态3，并随后在时间 $t=2$ 时处于状态2的概率。将你的答案表示为小数。", "solution": "设 $X_{t}$ 表示时间 $t$ 时的状态。初始条件为 $X_{0}=1$，其概率为1。我们被要求计算在 $X_{0}=1$ 的条件下，事件 $\\{X_{1}=3, X_{2}=2\\}$ 发生的概率。\n\n根据乘法法则和马尔可夫性质，\n$$\n\\Pr(X_{1}=3, X_{2}=2 \\mid X_{0}=1)\n= \\Pr(X_{1}=3 \\mid X_{0}=1)\\,\\Pr(X_{2}=2 \\mid X_{1}=3).\n$$\n从转移矩阵 $P$ 中，我们读出 $P_{13}=0.3$ 和 $P_{32}=0.2$，所以\n$$\n\\Pr(X_{1}=3, X_{2}=2 \\mid X_{0}=1) = 0.3 \\times 0.2 = 0.06.\n$$\n因此，所求概率为 $0.06$。", "answer": "$$\\boxed{0.06}$$", "id": "1345202"}, {"introduction": "在掌握了计算单一路径概率之后，我们现在来探讨一个更常见的问题：系统在多步之后处于某个特定状态的可能性。这个练习将引导你计算两步转移概率，这需要你考虑所有可能到达目标状态的路径。通过这个练习，你将对状态概率如何随时间演变有更深入的理解 [@problem_id:1345206]。", "problem": "一个实验性自动驾驶汽车的控制系统行为被建模为一个离散时间马尔可夫链。在任何给定的时间步，该系统可以处于三种操作模式之一：‘激进’、‘正常’或‘谨慎’。在一个时间步内从一种模式转换到另一种模式由一个固定的概率矩阵决定。设状态由数字表示：1代表‘激进’，2代表‘正常’，3代表‘谨慎’。一步转移概率矩阵 $P$，其中元素 $P_{ij}$ 是从状态 $i$ 转移到状态 $j$ 的概率，由下式给出：\n\n$$\nP = \\begin{pmatrix} 0.5 & 0.4 & 0.1 \\\\ 0.2 & 0.5 & 0.3 \\\\ 0.1 & 0.6 & 0.3 \\end{pmatrix}\n$$\n\n该车的系统初始状态为‘正常’模式。我们想要比较其在恰好两个时间步后各操作模式的概率。下列哪个陈述是正确的？\n\nA. 系统处于‘激进’模式的概率大于处于‘谨慎’模式的概率。\n\nB. 系统处于‘谨慎’模式的概率大于处于‘激进’模式的概率。\n\nC. 系统处于‘激进’模式和‘谨慎’模式的概率完全相等。\n\nD. 根据所提供的信息无法确定。", "solution": "设状态标记为 1 = 激进，2 = 正常，3 = 谨慎。系统从状态2开始，因此两步后处于状态 $j$ 的概率是两步转移概率 $(P^{2})_{2j}$，其中 $P^{2} = P P$。\n\n将给定的转移矩阵写成精确分数形式：\n$$\nP = \\begin{pmatrix}\n\\frac{1}{2} & \\frac{2}{5} & \\frac{1}{10} \\\\\n\\frac{1}{5} & \\frac{1}{2} & \\frac{3}{10} \\\\\n\\frac{1}{10} & \\frac{3}{5} & \\frac{3}{10}\n\\end{pmatrix}.\n$$\n对于 $j \\in \\{1,2,3\\}$，\n$$\n(P^{2})_{2j} = \\sum_{k=1}^{3} P_{2k} P_{kj}.\n$$\n计算两步后转移到状态1和状态3的概率。\n\n对于状态1（激进）：\n$$\n(P^{2})_{21} = P_{21}P_{11} + P_{22}P_{21} + P_{23}P_{31}\n= \\frac{1}{5}\\cdot\\frac{1}{2} + \\frac{1}{2}\\cdot\\frac{1}{5} + \\frac{3}{10}\\cdot\\frac{1}{10}\n= \\frac{1}{10} + \\frac{1}{10} + \\frac{3}{100}\n= \\frac{23}{100}.\n$$\n对于状态3（谨慎）：\n$$\n(P^{2})_{23} = P_{21}P_{13} + P_{22}P_{23} + P_{23}P_{33}\n= \\frac{1}{5}\\cdot\\frac{1}{10} + \\frac{1}{2}\\cdot\\frac{3}{10} + \\frac{3}{10}\\cdot\\frac{3}{10}\n= \\frac{1}{50} + \\frac{3}{20} + \\frac{9}{100}\n= \\frac{2}{100} + \\frac{15}{100} + \\frac{9}{100}\n= \\frac{26}{100}.\n$$\n比较：\n$$\n\\frac{23}{100} < \\frac{26}{100},\n$$\n因此，两步后处于‘谨慎’模式的概率大于处于‘激进’模式的概率。故陈述B是正确的。", "answer": "$$\\boxed{B}$$", "id": "1345206"}, {"introduction": "前面的练习侧重于短期的概率计算，而这个练习则将我们的视角转向分析系统的长期结构特性。我们将学习一个核心概念——“互通类” (communicating classes)，它帮助我们确定哪些状态可以相互到达，以及系统是否可能被“困”在某些状态子集中。理解状态空间的结构对于预测马尔可夫链的长期行为至关重要 [@problem_id:1345194]。", "problem": "一位经济学家建立了一个简化的马尔可夫链模型，用于研究一个国家内部的代际财富流动性。人口被划分为四个不同的经济状态：$S_1$（底层阶级）、$S_2$（中产阶级）、$S_3$（上层阶级）和 $S_4$（稳固财富阶层）。一个家庭的状态按代际进行观察，其在这些状态之间转移的概率由以下的一步转移概率矩阵 $P$ 给出：\n\n$$\nP = \\begin{pmatrix}\n0.7 & 0.3 & 0 & 0 \\\\\n0.2 & 0.6 & 0.2 & 0 \\\\\n0 & 0.1 & 0.8 & 0.1 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\n\n其中，元素 $P_{ij}$ 表示某一代处于状态 $S_i$ 的家庭，其后代在下一代处于状态 $S_j$ 的概率。该模型的状态空间为 $S = \\{S_1, S_2, S_3, S_4\\}$。\n\n你的任务是将状态空间 $S$ 划分为其唯一的互通类。请从以下提供的选项中选择正确的划分。\n\nA. $\\{S_1\\}, \\{S_2\\}, \\{S_3\\}, \\{S_4\\}$\n\nB. $\\{S_1, S_2\\}, \\{S_3, S_4\\}$\n\nC. $\\{S_1, S_2, S_3\\}, \\{S_4\\}$\n\nD. $\\{S_1\\}, \\{S_2, S_3\\}, \\{S_4\\}$\n\nE. $\\{S_1, S_2, S_3, S_4\\}$", "solution": "我们使用离散时间马尔可夫链的标准定义。如果存在 $n \\in \\mathbb{N}$ 使得 $(P^{n})_{ij} > 0$，则称状态 $i$ 可达状态 $j$。如果两个状态 $i$ 和 $j$ 相互可达，则称它们互通，记作 $i \\leftrightarrow j$。互通类是在此关系下的等价类；如果对于所有 $i \\in C$ 和 $j \\notin C$，都有 $P_{ij} = 0$，则称类 $C$ 是闭合的。\n\n根据给定的矩阵 $P$，元素 $P_{12}$ 和 $P_{21}$ 严格为正，因此一步之内 $S_{1} \\to S_{2}$ 且 $S_{2} \\to S_{1}$，所以 $S_{1} \\leftrightarrow S_{2}$。类似地，$P_{23} > 0$ 且 $P_{32} > 0$，所以 $S_{2} \\leftrightarrow S_{3}$。根据互通关系的传递性，有 $S_{1} \\leftrightarrow S_{3}$。具体来说，$(P^{2})_{13} \\geq P_{12}P_{23} > 0$ 得到 $S_{1} \\to S_{3}$，而 $(P^{2})_{31} \\geq P_{32}P_{21} > 0$ 得到 $S_{3} \\to S_{1}$。因此，$S_{1}、S_{2}、S_{3}$ 均相互互通，构成一个单一的互通类 $\\{S_{1}, S_{2}, S_{3}\\}$。\n\n对于状态 $S_{4}$，矩阵 $P$ 的第四行满足 $P_{44} = 1$ 且当 $j \\neq 4$ 时 $P_{4j} = 0$。因此，对于所有 $n \\in \\mathbb{N}$，当 $j \\neq 4$ 时 $(P^{n})_{4j} = 0$，所以 $S_{4}$ 无法到达任何其他状态。然而，其他每个状态都可以通过概率为正的路径到达 $S_{4}$（例如，因为 $P_{34} > 0$，所以 $S_{3} \\to S_{4}$；因为 $P_{23}P_{34} > 0$，所以 $S_{2} \\to S_{3} \\to S_{4}$；因为 $P_{12}P_{23}P_{34} > 0$，所以 $S_{1} \\to S_{2} \\to S_{3} \\to S_{4}$）。因此，$S_{4}$ 只与自身互通，并形成其自身的闭合互通类 $\\{S_{4}\\}$。\n\n因此，将该状态空间划分为互通类的唯一方式是 $\\{S_{1}, S_{2}, S_{3}\\}$ 和 $\\{S_{4}\\}$，这对应于选项 C。", "answer": "$$\\boxed{C}$$", "id": "1345194"}]}