{"hands_on_practices": [{"introduction": "本节的第一个练习旨在将一个系统的文字描述转化为马尔可夫链的数学语言。我们将为一个传感器的电池寿命建模，这是一个具体的例子，你将通过考虑日常事件的概率来计算完整的转移矩阵。这项技能是建立任何随机过程模型的基础。[@problem_id:1322224]", "problem": "一个远程环境传感器由可充电电池供电。其每天开始时的电池电量被分为三种状态之一：1 (高)、2 (中) 或 3 (低)。状态转换以天为单位进行观察，并受到两个独立的日常现象影响：能量消耗和太阳能充电。\n\n在任意一天：\n- 能量消耗可以是“高”或“低”。“高消耗”日发生的概率为 $p_c = 0.45$。\n- 太阳能充电可以是“有效”或“无效”。“有效充电”日发生的概率为 $p_s = 0.60$。\n\n下一天的电池状态 $X_{t+1}$ 由当天开始时的状态 $X_t$ 和当日的条件决定，遵循以下规则：\n\n- 如果电池处于 **状态 1 (高)**：只有当当天是高消耗且无效充电时，它才会降至状态 2 (中)。否则，它将保持在状态 1。\n- 如果电池处于 **状态 2 (中)**：如果当天是低消耗且有效充电，它将升至状态 1 (高)。如果当天是高消耗且无效充电，它将降至状态 3 (低)。否则，它将保持在状态 2。\n- 如果电池处于 **状态 3 (低)**：如果当天是低消耗且有效充电，它将升至状态 2 (中)。它不能在一步内升至状态 1。否则，它将保持在状态 3。\n\n假设该系统可以建模为一个离散时间马尔可夫链，确定其一步转移概率矩阵 $P$。该矩阵的元素 $P_{ij}$ 表示在一天内从状态 $i$ 转移到状态 $j$ 的概率。状态排序为（1：高，2：中，3：低）。", "solution": "设 $p_{c}$ 表示高消耗日的概率，$p_{s}$ 表示有效充电日的概率。给定 $p_{c}=0.45$ 和 $p_{s}=0.60$，并且消耗和充电是独立的，则每日条件的联合概率为：\n$$\\mathbb{P}(\\text{高消耗且无效充电})=p_{c}(1-p_{s}),$$\n$$\\mathbb{P}(\\text{低消耗且有效充电})=(1-p_{c})p_{s},$$\n$$\\mathbb{P}(\\text{高消耗且有效充电})=p_{c}p_{s},$$\n$$\\mathbb{P}(\\text{低消耗且无效充电})=(1-p_{c})(1-p_{s}).$$\n\n根据转移规则：\n- 从状态 1 (高)：当且仅当发生高消耗和无效充电时，它会降至状态 2；否则它保持在状态 1。因此\n$$P_{12}=p_{c}(1-p_{s}),\\quad P_{11}=1-p_{c}(1-p_{s}),\\quad P_{13}=0.$$\n- 从状态 2 (中)：如果发生低消耗和有效充电，它会升至状态 1；如果发生高消耗和无效充电，它会降至状态 3；否则它保持在状态 2。因此\n$$P_{21}=(1-p_{c})p_{s},\\quad P_{23}=p_{c}(1-p_{s}),$$\n$$P_{22}=1-\\big[(1-p_{c})p_{s}+p_{c}(1-p_{s})\\big]=p_{c}p_{s}+(1-p_{c})(1-p_{s}).$$\n- 从状态 3 (低)：如果发生低消耗和有效充电，它会升至状态 2；它不能在一步内升至状态 1；否则它保持在状态 3。因此\n$$P_{32}=(1-p_{c})p_{s},\\quad P_{31}=0,\\quad P_{33}=1-(1-p_{c})p_{s}.$$\n\n代入 $p_{c}=0.45$ 和 $p_{s}=0.60$ 得\n$$p_{c}(1-p_{s})=0.45\\times 0.40=0.18,\\quad (1-p_{c})p_{s}=0.55\\times 0.60=0.33,$$\n$$p_{c}p_{s}=0.45\\times 0.60=0.27,\\quad (1-p_{c})(1-p_{s})=0.55\\times 0.40=0.22.$$\n因此，\n- 从状态 1: $P_{11}=1-0.18=0.82$, $P_{12}=0.18$, $P_{13}=0$。\n- 从状态 2: $P_{21}=0.33$, $P_{23}=0.18$, $P_{22}=0.27+0.22=0.49$。\n- 从状态 3: $P_{31}=0$, $P_{32}=0.33$, $P_{33}=1-0.33=0.67$。\n\n因此，一步转移矩阵 $P$（状态排序为 1, 2, 3）是\n$$P=\\begin{pmatrix}\n0.82 & 0.18 & 0 \\\\\n0.33 & 0.49 & 0.18 \\\\\n0 & 0.33 & 0.67\n\\end{pmatrix}.$$\n每一行的和都为 1，这符合随机矩阵的要求。", "answer": "$$\\boxed{\\begin{pmatrix}0.82 & 0.18 & 0 \\\\ 0.33 & 0.49 & 0.18 \\\\ 0 & 0.33 & 0.67\\end{pmatrix}}$$", "id": "1322224"}, {"introduction": "现实世界中的状态转移通常是多个相互竞争过程的最终结果。在这个问题中，我们将探索一种假设的自愈材料，其中裂纹的形成和愈合同时发生。你将通过组合两个独立随机事件的结果来计算一个特定的转移概率，从而磨炼你在组合概率方面的技能。[@problem_id:1322226]", "problem": "我们提出了一个简化的随机模型，用以描述自修复材料在离散时间间隔内的结构完整性。在任意时间步，材料的状态由其活性微裂纹的数量定义，该数量用一个从0到最大值 $N$ 的整数表示。设 $X_n$ 为时间步 $n$ 时的裂纹数量。\n\n从时间步 $n$ 到 $n+1$，裂纹数量的演化由两个独立的过程决定：裂纹修复和新裂纹形成。\n1.  **裂纹修复：** 在时间步 $n$ 时存在的每个裂纹，在该时间间隔内被修复的独立概率为 $p_h$。\n2.  **新裂纹形成：** 材料总共有 $N$ 个潜在的微裂纹位置。如果存在 $i$ 个裂纹，则还剩下 $N-i$ 个可以形成新裂纹的位置。在这 $N-i$ 个位置中，每一个位置在该时间间隔内产生新裂纹的独立概率为 $p_f$。\n\n考虑一种最多可容纳 $N=4$ 条微裂纹的材料。假设在时间步 $n$，观察到该材料有 $X_n = 2$ 条裂纹。请求出一步转移概率 $P(X_{n+1}=1 | X_n=2)$，并将其表示为概率 $p_f$ 和 $p_h$ 的解析函数。", "solution": "我们以当前裂纹数量为 $X_{n}=2$ 且最大容量为 $N=4$ 为条件。在时间步 $n$，存在两组不相交的位置：2个已开裂的位置和 $N-2=2$ 个完好的位置。这两个过程独立地作用于这两组不相交的位置上。\n\n定义 $Y$ 为修复后仍然存在的原有裂纹数量。每个已有的裂纹存留下来（即未被修复）的独立概率为 $1-p_{h}$，所以\n$$\nY \\sim \\text{Binomial}\\left(2,\\,1-p_{h}\\right), \\quad \\text{with} \\quad P(Y=k)=\\binom{2}{k}(1-p_{h})^{k}p_{h}^{2-k},\\; k=0,1,2.\n$$\n定义 $Z$ 为在2个完好的位置上新形成的裂纹数量。每个完好的位置形成一个新裂纹的独立概率为 $p_{f}$，所以\n$$\nZ \\sim \\text{Binomial}\\left(2,\\,p_{f}\\right), \\quad \\text{with} \\quad P(Z=\\ell)=\\binom{2}{\\ell}p_{f}^{\\ell}(1-p_{f})^{2-\\ell},\\; \\ell=0,1,2.\n$$\n由于修复和新裂纹形成发生在不相交的位置集合上且为独立过程，因此 $Y$ 和 $Z$ 是独立的，下一步的总裂纹数量为\n$$\nX_{n+1}=Y+Z.\n$$\n我们需要计算 $P(X_{n+1}=1 \\mid X_{n}=2)=P(Y+Z=1)=P(Y=0)P(Z=1)+P(Y=1)P(Z=0)$，计算结果为\n$$\nP(X_{n+1}=1 \\mid X_{n}=2)=\\left(p_{h}^{2}\\right)\\left(2p_{f}(1-p_{f})\\right)+\\left(2p_{h}(1-p_{h})\\right)\\left((1-p_{f})^{2}\\right).\n$$\n这可以等价地写成如下的因式分解形式\n$$\nP(X_{n+1}=1 \\mid X_{n}=2)=2p_{h}(1-p_{f})\\left(1-p_{h}-p_{f}+2p_{h}p_{f}\\right).\n$$", "answer": "$$\\boxed{2p_{h}^{2}p_{f}(1-p_{f})+2p_{h}(1-p_{h})(1-p_{f})^{2}}$$", "id": "1322226"}, {"introduction": "超越固定的转移概率，本练习引入了一个模型，其中转移规则取决于系统的当前状态。通过分析一个聚类算法，你将把转移概率定义为状态本身的函数。这展示了如何为更具动态性和自适应性的系统建模，这是高级应用中的一个关键概念。[@problem_id:1322235]", "problem": "一个自动化数据分析算法会迭代地优化一个数据集中的簇的数量。令 $K_n$ 表示在第 $n$ 次迭代时的簇数量。该过程被建模为一个离散时间随机过程，其中任何时刻的状态是簇的整数数量。状态空间定义为整数集合 $\\{2, 3, \\dots, M\\}$，其中 $M > 2$ 是一个预定义的簇的最大数量。\n\n该算法在每次迭代时的行为取决于当前的簇数量，$k$：\n\n1.  对于一个中间数量的簇，其中 $2 < k < M$，算法会在两种操作之间做出一个概率性选择：\n    *   **分裂**：它将簇的数量增加到 $k+1$。该操作被选择的概率为 $p_s(k)$。\n    *   **合并**：它将簇的数量减少到 $k-1$。该操作被选择的概率为互补概率 $1 - p_s(k)$。\n    选择分裂的概率由 logistic 函数 $p_s(k) = \\frac{1}{1 + \\exp(\\alpha(k - k_0))}$ 决定，其中 $\\alpha$ 和 $k_0$ 是算法的正实数值参数。\n\n2.  在状态空间的边界处，算法的操作是确定性的：\n    *   如果簇数量为 $k=2$，算法总是执行分裂操作。\n    *   如果簇数量为 $k=M$，算法总是执行合并操作。\n\n基于此模型，请确定对于任意两个状态 $i, j \\in \\{2, 3, \\dots, M\\}$ 的一步转移概率 $P_{i,j} = P(K_{n+1}=j | K_n=i)$ 的通用表达式。请将你的答案表示为 $i, j, \\alpha, k_0$ 和 $M$ 的函数。", "solution": "我们将 $\\{K_{n}\\}$ 建模为在有限状态空间 $\\{2,3,\\dots,M\\}$ 上的一个时间齐次马尔可夫链。根据题目描述，从任何一个满足 $2<i<M$ 的内部状态 $i$ 出发，下一个状态必然是 $i+1$ (分裂) 或 $i-1$ (合并)。在状态 $i$ 的分裂以概率 $p_{s}(i)$ 发生，合并以概率 $1-p_{s}(i)$ 发生，其中 logistic 形式为\n$$\np_{s}(i)=\\frac{1}{1+\\exp\\big(\\alpha(i-k_{0})\\big)}.\n$$\n因此，对于 $2<i<M$，我们有\n$$\nP_{i,i+1}=p_{s}(i)=\\frac{1}{1+\\exp\\big(\\alpha(i-k_{0})\\big)},\\qquad\nP_{i,i-1}=1-p_{s}(i)=\\frac{\\exp\\big(\\alpha(i-k_{0})\\big)}{1+\\exp\\big(\\alpha(i-k_{0})\\big)},\n$$\n并且对于所有其他的 $j$，有 $P_{i,j}=0$。\n\n在下边界 $i=2$ 处，算法总是执行分裂，所以\n$$\nP_{2,3}=1,\\qquad P_{2,j}=0\\ \\text{，对于 } j\\neq 3\\text{。}\n$$\n在上边界 $i=M$ 处，算法总是执行合并，所以\n$$\nP_{M,M-1}=1,\\qquad P_{M,j}=0\\ \\text{，对于 } j\\neq M-1\\text{。}\n$$\n\n综合这些情况，可以得出对于任意 $i,j\\in\\{2,3,\\dots,M\\}$ 的通用一步转移概率：\n$$\nP_{i,j}=\\begin{cases}\n1, & i=2,\\ j=3,\\\\[4pt]\n1, & i=M,\\ j=M-1,\\\\[4pt]\n\\dfrac{1}{1+\\exp\\big(\\alpha(i-k_{0})\\big)}, & 2<i<M,\\ j=i+1,\\\\[10pt]\n\\dfrac{\\exp\\big(\\alpha(i-k_{0})\\big)}{1+\\exp\\big(\\alpha(i-k_{0})\\big)}, & 2<i<M,\\ j=i-1,\\\\[10pt]\n0, & \\text{其他情况。}\n\\end{cases}\n$$\n这就将 $P_{i,j}$ 完全表示为了 $i$、$j$、$\\alpha$、$k_{0}$ 和 $M$ 的函数。", "answer": "$$\\boxed{P_{i,j}=\\begin{cases}\n1, & i=2,\\ j=3,\\\\[4pt]\n1, & i=M,\\ j=M-1,\\\\[4pt]\n\\dfrac{1}{1+\\exp\\big(\\alpha(i-k_{0})\\big)}, & 2<i<M,\\ j=i+1,\\\\[10pt]\n\\dfrac{\\exp\\big(\\alpha(i-k_{0})\\big)}{1+\\exp\\big(\\alpha(i-k_{0})\\big)}, & 2<i<M,\\ j=i-1,\\\\[10pt]\n0, & \\text{其他情况。}\n\\end{cases}}$$", "id": "1322235"}]}