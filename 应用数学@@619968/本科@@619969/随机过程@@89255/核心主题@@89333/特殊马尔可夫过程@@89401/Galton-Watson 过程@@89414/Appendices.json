{"hands_on_practices": [{"introduction": "在探究一个谱系能否长久存续之前，理解其在初始阶段的增长模式至关重要。本练习将引导你计算预期种群规模及其波动性——这是描述过程增长动态的两个基本指标。通过分析一个社交媒体潮流的传播，你将实践运用关于第 $n$ 代种群规模 $Z_n$ 的均值和方差的递推公式。[@problem_id:1303363]", "problem": "一项新的社交媒体挑战由一个人发起，此人被视为第0代。挑战中任何一代的每位参与者都会独立地鼓励其若干名关注者加入。这些新加入者构成了下一代参与者。任何单个个体招募的新参与者数量是一个随机变量，服从均值为 $\\lambda = 2.0$ 的泊松分布。\n\n设 $Z_n$ 表示第 $n$ 代的参与者人数，其中 $Z_0=1$。计算第3代参与者人数的标准差与第3代参与者期望人数的比率。换句话说，计算 $\\frac{\\sqrt{\\text{Var}(Z_3)}}{E[Z_3]}$ 的值。\n\n将您的最终答案四舍五入到四位有效数字。", "solution": "将参与者人数建模为一个Galton–Watson分支过程，其子代分布为均值参数为 $\\lambda$ 的泊松分布。设 $m$ 表示子代数量的均值，$\\sigma^2$ 表示子代分布的方差。对于泊松分布$\\text{Poisson}(\\lambda)$，我们有 $m=\\lambda$ 且 $\\sigma^2=\\lambda$。\n\n对于一个 $Z_0=1$ 的Galton–Watson过程，给定 $Z_n$ 的条件矩为\n$$\n\\mathbb{E}[Z_{n+1}\\mid Z_{n}] = m Z_{n}, \\qquad \\mathrm{Var}(Z_{n+1}\\mid Z_{n}) = \\sigma^{2} Z_{n}.\n$$\n使用全期望定律和全方差定律，\n$$\n\\mathbb{E}[Z_{n+1}] = \\mathbb{E}[\\mathbb{E}[Z_{n+1}\\mid Z_{n}]] = m\\,\\mathbb{E}[Z_{n}],\n$$\n通过归纳法可得\n$$\n\\mathbb{E}[Z_{n}] = m^{n}.\n$$\n对于方差，\n$$\n\\mathrm{Var}(Z_{n+1}) = \\mathbb{E}[\\mathrm{Var}(Z_{n+1}\\mid Z_{n})] + \\mathrm{Var}(\\mathbb{E}[Z_{n+1}\\mid Z_{n}]) = \\sigma^{2}\\mathbb{E}[Z_{n}] + m^{2}\\mathrm{Var}(Z_{n}).\n$$\n设 $V_n = \\text{Var}(Z_n)$。当 $V_0=0$ 且 $\\mathbb{E}[Z_n] = m^n$ 时，递推关系为\n$$\nV_{n+1} = \\sigma^2 m^n + m^2 V_n.\n$$\n求解此非齐次线性递推关系，当 $m \\neq 1$ 时，可得\n$$\nV_n = \\sigma^2 m^{n-1} \\frac{m^n-1}{m-1}.\n$$\n当 $\\lambda=2$ 时，我们有 $m=2$ 且 $\\sigma^2=2$。对于 $n=3$，\n$$\n\\mathbb{E}[Z_{3}] = m^{3} = 2^{3} = 8,\n$$\n$$\n\\mathrm{Var}(Z_{3}) = \\sigma^{2} m^{2} \\frac{m^{3}-1}{m-1} = 2 \\cdot 2^{2} \\cdot \\frac{2^{3}-1}{2-1} = 2 \\cdot 4 \\cdot 7 = 56.\n$$\n因此，\n$$\n\\frac{\\sqrt{\\mathrm{Var}(Z_{3})}}{\\mathbb{E}[Z_{3}]} = \\frac{\\sqrt{56}}{8} = \\frac{2\\sqrt{14}}{8} = \\frac{\\sqrt{14}}{4}.\n$$\n数值上，四舍五入到四位有效数字，\n$$\n\\frac{\\sqrt{14}}{4} \\approx 0.9354.\n$$", "answer": "$$\\boxed{0.9354}$$", "id": "1303363"}, {"introduction": "判断一个随机过程最终是会无限增长还是走向消亡，是高尔顿-沃森过程理论的核心问题。本练习将带你运用后代分布的概率生成函数，来求解过程最终灭绝的关键概率 $q$。此外，此问题从第二代已有两名成员的特定条件出发，旨在让你体会分支过程的一个核心特性：各个子谱系是相互独立演化的。[@problem_id:1303394]", "problem": "一场新的病毒式营销活动由一位经理发起。该活动的结构要求每位现有参与者尝试招募两名新参与者。对于任何一次招募尝试，成功的概率为 $p=0.6$，且每次尝试都与其他尝试相互独立。如果活动能够无限增长，则认为该活动是成功的。相反，如果在某个时刻，某一代的参与者未能产生任何新的招募，从而结束了招募链，则认为该活动已经崩溃。\n\n假设最初的经理成功招募了两名新参与者，他们构成了活动的第一代。那么，这场活动最终崩溃的概率是多少？\n\n将您的最终答案四舍五入到三位有效数字。", "solution": "将该活动建模为一个Galton–Watson分支过程，其中每个参与者独立地产生一定数量的后代，该数量服从参数为 2 和 $p$ 的二项分布。因此，后代生成函数为\n$$\nf(s)=\\sum_{k=0}^{2} \\binom{2}{k} p^{k} (1-p)^{2-k} s^{k} = \\left( (1-p) + p s \\right)^{2}.\n$$\n设 $r$ 是从单个参与者开始的灭绝概率。它是区间 $[0,1]$ 中不动点方程的最小解：\n$$\nr = f(r) = \\left( (1-p) + p r \\right)^{2}.\n$$\n展开并重新整理，得到一个关于 $r$ 的二次方程：\n$$\np^{2} r^{2} + \\left( 2p(1-p) - 1 \\right) r + (1-p)^{2} = 0.\n$$\n根据二次公式，\n$$\nr = \\frac{1 - 2p(1-p) \\pm \\sqrt{\\left( 1 - 2p(1-p) \\right)^{2} - 4 p^{2} (1-p)^{2}}}{2 p^{2}}.\n$$\n判别式可简化为\n$$\n\\left( 1 - 2p(1-p) \\right)^{2} - 4 p^{2} (1-p)^{2}\n= 1 - 4p(1-p) = \\left( 1 - 2p \\right)^{2}.\n$$\n因此，两个根是\n$$\nr = \\frac{1 - 2p(1-p) \\pm |1 - 2p|}{2 p^{2}}.\n$$\n对于 $p > 1/2$（这里 $p=0.6$），我们有 $|1-2p| = 2p - 1$，得到的根为 $r=1$ 和\n$$\nr = \\left( \\frac{1-p}{p} \\right)^{2}.\n$$\n由于每个参与者招募的平均人数为 $2p > 1$，所以从一个祖先开始的灭绝概率是较小的根 $r = \\left( \\frac{1-p}{p} \\right)^{2}$。\n\n鉴于最初的经理已经在第一代中产生了恰好两名参与者，因此这两个后代分支独立演化。因此，最终崩溃的概率是这两个独立分支的灭绝概率的乘积：\n$$\nr_{\\text{total}} = r^{2} = \\left( \\frac{1-p}{p} \\right)^{4}.\n$$\n代入 $p=0.6$ 可得\n$$\nr_{\\text{total}} = \\left( \\frac{1-0.6}{0.6} \\right)^{4}\n= \\left( \\frac{0.4}{0.6} \\right)^{4}\n= \\left( \\frac{2}{3} \\right)^{4}\n= \\frac{16}{81} \\approx 0.197530864\\ldots\n$$\n四舍五入到三位有效数字，结果是 $0.198$。", "answer": "$$\\boxed{0.198}$$", "id": "1303394"}, {"introduction": "知道一个谱系最终是否会灭绝固然重要，但有时我们更关心它在何时灭绝。本练习将挑战你分辨“在第 $n$ 代或之前灭绝”与“恰好在第 $n$ 代灭绝”这两个概念的细微差别。要解决这个问题，你需要更精确地运用概率生成函数的迭代，从而深化对过程逐代演化本质的理解。[@problem_id:1303348]", "problem": "考虑一个简化模型，用于描述一个自我复制的数字实体在网络中的传播过程。该过程从单个实体开始，其演化以离散的代际进行追踪。在每一代中，每个现存的实体都被独立地处理，并被一定数量的“后代”实体所取代。\n\n任何单个实体产生的后代数量遵循一个特定的概率分布：一个实体要么停止存在（产生0个后代），其概率为 $p_0 = 0.5$；要么分裂成两个新实体（产生2个后代），其概率为 $p_2 = 0.5$。\n\n令 $Z_n$ 表示在第 $n$ 代时种群中的实体总数，初始条件为 $Z_0 = 1$。如果种群数量变为零，则认为该种群已经灭绝。\n\n计算种群恰好在第三代灭绝的概率。这意味着种群在第一代和第二代之后不为零，但在第三代之后变为零。请用精确分数表示你的答案。", "solution": "我们将此过程建模为一个Galton–Watson分支过程，其后代生成函数为\n$$\nf(s)=p_{0}+p_{2}s^{2}=\\frac{1}{2}+\\frac{1}{2}s^{2}.\n$$\n对于单个初始实体，种群在第 $n$ 代或之前灭绝的概率由 $f$ 的 $n$ 次函数迭代在 $0$ 处的取值给出：\n$$\na_{n}=f^{\\circ n}(0).\n$$\n明确地计算前三个值：\n$$\na_{1}=f(0)=\\frac{1}{2},\n$$\n$$\na_{2}=f(a_{1})=\\frac{1}{2}+\\frac{1}{2}\\left(\\frac{1}{2}\\right)^{2}=\\frac{1}{2}+\\frac{1}{8}=\\frac{5}{8},\n$$\n$$\na_{3}=f(a_{2})=\\frac{1}{2}+\\frac{1}{2}\\left(\\frac{5}{8}\\right)^{2}=\\frac{1}{2}+\\frac{25}{128}=\\frac{89}{128}.\n$$\n恰好在第 $3$ 代发生灭绝的概率（即，种群数量首次达到零是在第 $3$ 代）是在第 $3$ 代或之前灭绝的概率减去在第 $2$ 代或之前灭绝的概率：\n$$\n\\mathbb{P}(Z_{3}=0,\\ Z_{2}>0)=a_{3}-a_{2}=\\frac{89}{128}-\\frac{5}{8}=\\frac{89}{128}-\\frac{80}{128}=\\frac{9}{128}.\n$$\n通过直接分支进行验证：要存活过第 $1$ 代，需要 $Z_1=2$，其概率为 $\\frac{1}{2}$。在 $Z_1=2$ 的条件下，$Z_2$ 的分布为：数量为 $0$ 的概率是 $\\frac{1}{4}$，数量为 $2$ 的概率是 $\\frac{1}{2}$，数量为 $4$ 的概率是 $\\frac{1}{4}$。在 $Z_2=2$ 的情况下要在第 $3$ 代灭绝，需要两个个体都产生 $0$ 个后代，其概率为 $(\\frac{1}{2})^{2}=\\frac{1}{4}$；在 $Z_2=4$ 的情况下，该概率为 $(\\frac{1}{2})^{4}=\\frac{1}{16}$。因此\n$$\n\\mathbb{P}(\\text{在第3代灭绝})=\\frac{1}{2}\\cdot\\frac{1}{2}\\cdot\\frac{1}{4}+\\frac{1}{2}\\cdot\\frac{1}{4}\\cdot\\frac{1}{16}=\\frac{1}{16}+\\frac{1}{128}=\\frac{9}{128},\n$$\n这与之前的结果相符。", "answer": "$$\\boxed{\\frac{9}{128}}$$", "id": "1303348"}]}