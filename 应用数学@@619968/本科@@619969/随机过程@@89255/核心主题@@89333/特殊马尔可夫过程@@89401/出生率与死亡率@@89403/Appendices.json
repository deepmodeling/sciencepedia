{"hands_on_practices": [{"introduction": "让我们从一个基础练习开始，这个练习将生灭过程的概念应用到工程可靠性分析中。许多复杂系统可以被简化为几个关键状态，例如机器的“工作”与“非工作”状态。通过解决这个问题 [@problem_id:1284740]，你将练习如何为一个简单的双状态马尔可夫链建模，并计算其长期可用性，这是分析系统稳定性和性能的一项核心技能。", "id": "1284740", "problem": "一条生产线上的一台关键设备会发生随机故障。该设备的状态可以建模为一个连续时间随机过程。当设备处于“工作”状态时，它可能会发生故障。发生故障前的时间是一个速率参数为 $\\alpha$ 的指数随机变量。一旦设备发生故障，它就进入“非运行”状态。此状态包括设备损坏的时间以及正在进行“维修”的时间。设备在恢复“工作”状态之前，处于这种非运行状态的总时间是一个速率参数为 $\\beta$ 的指数随机变量。\n\n确定该设备的长期可用性。可用性定义为在很长一段时间内，设备处于“工作”状态的时间所占的比例。请用 $\\alpha$ 和 $\\beta$ 的符号表达式表示你的答案。", "solution": "将该设备建模为一个两状态的连续时间马尔可夫链，其状态为：工作 (W) 和非运行 (N)。转移速率为：从 W 到 N 的速率为 $\\alpha$（故障率），从 N 到 W 的速率为 $\\beta$（修复率）。因为两个速率都为正，所以该链是不可约且遍历的，因此长期可用性等于处于状态 W 的平稳概率。\n\n设平稳概率为 $\\pi_{W}$ 和 $\\pi_{N}$，且满足 $\\pi_{W}+\\pi_{N}=1$。两个状态之间的全局平衡（流量平衡）为\n$$\n\\pi_{W}\\alpha=\\pi_{N}\\beta.\n$$\n由此，用 $\\pi_{W}$ 表示 $\\pi_{N}$：\n$$\n\\pi_{N}=\\frac{\\alpha}{\\beta}\\pi_{W}.\n$$\n使用归一化条件求解 $\\pi_{W}$：\n$$\n\\pi_{W}+\\pi_{N}=1 \\;\\;\\Rightarrow\\;\\; \\pi_{W}+\\frac{\\alpha}{\\beta}\\pi_{W}=1 \\;\\;\\Rightarrow\\;\\; \\pi_{W}\\left(1+\\frac{\\alpha}{\\beta}\\right)=1.\n$$\n因此，\n$$\n\\pi_{W}=\\frac{1}{1+\\frac{\\alpha}{\\beta}}=\\frac{\\beta}{\\alpha+\\beta}.\n$$\n此 $\\pi_{W}$ 即为长期可用性。\n\n作为通过更新论证的一致性检验，每个“运行-停机”周期由一个正常运行时间 $U\\sim\\text{Exp}(\\alpha)$（其期望为 $\\mathbb{E}[U]=\\frac{1}{\\alpha}$）和一个停机时间 $D\\sim\\text{Exp}(\\beta)$（其期望为 $\\mathbb{E}[D]=\\frac{1}{\\beta}$）组成。长期来看，正常运行时间所占的比例为\n$$\n\\frac{\\mathbb{E}[U]}{\\mathbb{E}[U]+\\mathbb{E}[D]}=\\frac{\\frac{1}{\\alpha}}{\\frac{1}{\\alpha}+\\frac{1}{\\beta}}=\\frac{\\beta}{\\alpha+\\beta},\n$$\n这与平稳概率的结果相符。", "answer": "$$\\boxed{\\frac{\\beta}{\\alpha+\\beta}}$$"}, {"introduction": "接下来，我们将探讨一个群体动力学中的经典问题：一个新物种的繁衍与灭绝。与上一个问题关注系统的长期平均行为不同，这个问题 [@problem_id:1284733] 提出了一个关于最终命运的疑问：一个从单个个体开始的种群，是更有可能在灭绝前达到一定规模，还是会走向消亡？此练习将引导你使用“赌徒破产”模型的思想来计算在到达一个成功状态之前先到达失败状态的概率，这是解决生灭过程中首达时间问题的关键方法。", "id": "1284733", "problem": "将一个新型益生菌株的单个细菌引入受控的生物环境中。该菌株的种群被建模为一个简单的生灭过程。种群中的每个细菌个体具有恒定的单位出生率 $\\lambda$（即它分裂形成两个细菌的速率）和恒定的单位死亡率 $\\mu$（即它从系统中被移除的速率）。因此，对于一个大小为 $n$ 的种群，其总出生率为 $n\\lambda$，总死亡率为 $n\\mu$。\n\n假设出生率 $\\lambda$ 不等于死亡率 $\\mu$。如果细菌种群数量达到 3 个个体，则认为此次引入是“成功定殖”。如果种群灭绝（数量达到 0），则认为此次引入是“定殖失败”。\n\n计算从这个单个细菌开始的谱系在灭绝之前实现成功定殖的概率。用 $\\lambda$ 和 $\\mu$ 的闭式解析表达式表示您的答案。", "solution": "设 $X(t)$ 表示一个连续时间生灭过程在时间 $t$ 的种群大小，其单位出生率为 $\\lambda$，单位死亡率为 $\\mu$。从一个细菌开始，我们要求在到达状态 $0$（灭绝）之前到达状态 $3$（成功定殖）的概率。设 $P_{n}$ 是从状态 $n$ 开始，在到达 $0$ 之前到达 $3$ 的概率，边界条件为 $P_{0}=0$ 和 $P_{3}=1$。\n\n因为该过程是一个具有线性速率的连续时间生灭链，所以从任何内部状态 $n$ 开始的第一次跳跃，以概率 $p=\\lambda/(\\lambda+\\mu)$ 转移到 $n+1$，以概率 $q=\\mu/(\\lambda+\\mu)$ 转移到 $n-1$。根据马尔可夫性质和指数等待时间的无记忆性，$\\{P_{n}\\}$ 满足其嵌入式跳跃链的后向方程：\n$$\nP_{n}=p\\,P_{n+1}+q\\,P_{n-1}, \\quad \\text{for } n=1,2,\n$$\n其中 $P_{0}=0$ 且 $P_{3}=1$，并且 $p+q=1$，在假设 $\\lambda \\neq \\mu$ 的条件下，$p \\neq q$。\n\n求解这个二阶线性递推关系。假设齐次方程有形式为 $P_{n}=r^{n}$ 的解，可得到特征方程\n$$\np r^{2}-r+q=0.\n$$\n由于 $p+q=1$，其根为 $r=1$ 和 $r=q/p$。因此，通解为\n$$\nP_{n}=A+B\\left(\\frac{q}{p}\\right)^{n}.\n$$\n应用边界条件：\n$$\nP_{0}=0 \\implies A+B=0 \\implies B=-A,\n$$\n$$\nP_{3}=1 \\implies A+B\\left(\\frac{q}{p}\\right)^{3}=1 \\implies A\\left[1-\\left(\\frac{q}{p}\\right)^{3}\\right]=1 \\implies A=\\frac{1}{1-\\left(\\frac{q}{p}\\right)^{3}}.\n$$\n因此，\n$$\nP_{1}=A+B\\left(\\frac{q}{p}\\right)=A\\left[1-\\left(\\frac{q}{p}\\right)\\right]=\\frac{1-\\left(\\frac{q}{p}\\right)}{1-\\left(\\frac{q}{p}\\right)^{3}}.\n$$\n代入 $q/p=\\mu/\\lambda$，上式变为\n$$\nP_{1}=\\frac{1-\\frac{\\mu}{\\lambda}}{1-\\left(\\frac{\\mu}{\\lambda}\\right)^{3}}=\\frac{1}{1+\\frac{\\mu}{\\lambda}+\\left(\\frac{\\mu}{\\lambda}\\right)^{2}}=\\frac{\\lambda^{2}}{\\lambda^{2}+\\lambda \\mu+\\mu^{2}}.\n$$\n这就是从单个细菌开始的谱系在灭绝前达到种群数量 $3$ 的概率，适用于 $\\lambda \\neq \\mu$ 的情况。", "answer": "$$\\boxed{\\frac{\\lambda^{2}}{\\lambda^{2}+\\lambda \\mu+\\mu^{2}}}$$"}, {"introduction": "最后，我们将生灭过程应用于一个更贴近现实世界的场景：排队系统。这个问题 [@problem_id:1284759] 模拟了一个服务设施，其服务员会根据等待的顾客数量调整工作效率。这个练习的关键在于展示生灭过程模型的灵活性，特别是如何处理依赖于状态的速率（$state-dependent rates$），这使得模型能够更精确地刻画真实系统中存在的动态反馈机制。", "id": "1284759", "problem": "一个服务设施由单一服务台运作。到达该设施的顾客流遵循一个泊松过程，平均速率为单位时间 $\\lambda$。每位顾客的服务时间呈指数分布。服务台的性能是动态的：若设施中的顾客总数（包括正在接受服务的顾客）为 $N_0$ 或更少，服务台将以单位时间 $\\mu$ 的平均服务率运作。然而，为更快地清除积压，若顾客数超过 $N_0$，服务台将以 $2\\mu$ 的加速平均服务率工作。\n\n对于此系统，设 $N_0 = 2$。假设该排队系统已达到稳态且是稳定的，请确定设施为空的概率 $p_0$。请将您的答案表示为流量强度 $\\rho = \\lambda/\\mu$ 的函数。", "solution": "将系统建模为状态为 $n \\in \\{0,1,2,\\dots\\}$ 的生灭过程。所有状态的到达（生）率均为 $\\lambda$。从状态 $n \\geq 1$ 的服务（灭）率为\n$$\n\\mu_{n}=\\begin{cases}\n\\mu, & n=1,2,\\\\\n2\\mu, & n\\geq 3.\n\\end{cases}\n$$\n在生灭过程的稳态下，细致平衡方程给出\n$$\n\\lambda p_{n}=\\mu_{n+1}p_{n+1}, \\quad n\\geq 0,\n$$\n由此得到递推关系\n$$\np_{n+1}=\\frac{\\lambda}{\\mu_{n+1}}\\,p_{n}.\n$$\n令 $\\rho=\\lambda/\\mu$。则\n$$\np_{1}=\\frac{\\lambda}{\\mu}p_{0}=\\rho p_{0}, \\quad\np_{2}=\\frac{\\lambda}{\\mu}p_{1}=\\rho^{2}p_{0}.\n$$\n对于 $n\\geq 2$，我们有 $\\mu_{n+1}=2\\mu$，所以\n$$\np_{n+1}=\\frac{\\lambda}{2\\mu}p_{n}=\\frac{\\rho}{2}p_{n}.\n$$\n因此，对于 $n\\geq 3$，\n$$\np_{n}=p_{2}\\left(\\frac{\\rho}{2}\\right)^{n-2}=p_{0}\\,\\rho^{2}\\left(\\frac{\\rho}{2}\\right)^{n-2}\n= p_{0}\\,\\frac{\\rho^{n}}{2^{\\,n-2}}.\n$$\n由归一化条件 $\\sum_{n=0}^{\\infty}p_{n}=1$ 可得\n$$\n1=p_{0}\\left[1+\\rho+\\rho^{2}+\\sum_{n=3}^{\\infty}\\frac{\\rho^{n}}{2^{\\,n-2}}\\right].\n$$\n尾项是一个几何级数：\n$$\n\\sum_{n=3}^{\\infty}\\frac{\\rho^{n}}{2^{\\,n-2}}\n=4\\sum_{n=3}^{\\infty}\\left(\\frac{\\rho}{2}\\right)^{n}\n=4\\cdot\\frac{\\left(\\frac{\\rho}{2}\\right)^{3}}{1-\\frac{\\rho}{2}}\n=\\frac{\\rho^{3}/2}{1-\\rho/2},\n$$\n该级数收敛的充要条件为 $\\rho<2$，此即稳定性条件。因此\n$$\n1=p_{0}\\left[1+\\rho+\\rho^{2}+\\frac{\\rho^{3}/2}{1-\\rho/2}\\right].\n$$\n以 $1-\\rho/2$ 为公分母合并各项，\n$$\n1=p_{0}\\,\\frac{(1+\\rho+\\rho^{2})(1-\\rho/2)+\\rho^{3}/2}{1-\\rho/2}\n=p_{0}\\,\\frac{1+\\rho/2+\\rho^{2}/2}{1-\\rho/2}.\n$$\n解出 $p_{0}$ 可得\n$$\np_{0}=\\frac{1-\\rho/2}{1+\\rho/2+\\rho^{2}/2}\n=\\frac{2-\\rho}{2+\\rho+\\rho^{2}}.\n$$\n在所述的稳定性假设下，此表达式对 $0\\leq \\rho<2$ 成立。", "answer": "$$\\boxed{\\frac{2-\\rho}{2+\\rho+\\rho^{2}}}$$"}]}