{"hands_on_practices": [{"introduction": "这个练习将引导我们分析一个基础而重要的生灭过程模型。在此模型中，“出生”率是恒定的，而“死亡”率与当前状态的大小成正比，这是一个在排队论和金融学等多个领域都有广泛应用的场景 [@problem_id:1333907]。通过求解这个模型，你将能够练习如何应用细致平衡方程，并见证泊松分布如何从一个动态过程中自然而然地产生，从而加深对稳态分布核心原理的理解。", "problem": "考虑一个零工经济工作者个人财富的简化模型。该工作者的财富以离散的货币单位来衡量。新的货币单位随时间随机获得，其到达过程遵循泊松过程，平均速率恒为每小时 $\\lambda$ 个单位。该工作者也会花钱，我们将其建模为一个损失过程。在微小时间间隔内花费一个货币单位的概率与该工作者当前拥有的单位数量 $n$ 成正比。具体来说，如果工作者拥有 $n$ 个单位，则损失一个单位的瞬时速率由 $\\mu_n = n \\mu$ 给出，其中 $\\mu$ 是一个恒定的损失率参数，单位为小时的倒数。假设获得和损失金钱的过程是相互独立的。\n\n令 $N(t)$ 为工作者在时间 $t$ 拥有的货币单位数量。经过很长时间后，系统预期将达到统计平衡。对于 $n = 0, 1, 2, ...$，工作者恰好拥有 $n$ 个货币单位的长期概率 $P(N=n)$ 是多少？请用 $n$、$\\lambda$ 和 $\\mu$ 的函数表示你的答案。", "solution": "我们将 $N(t)$ 建模为非负整数集上的一个连续时间生灭过程，其中：\n- 出生（获得）以恒定速率 $\\lambda$ 发生，因此对于所有 $n \\geq 0$，转移 $n \\to n+1$ 的速率为 $\\lambda$。\n- 死亡（支出）以速率 $\\mu_{n} = n \\mu$ 发生，因此对于所有 $n \\geq 1$，转移 $n \\to n-1$ 的速率为 $n \\mu$。\n\n在统计平衡状态下，令 $\\pi_{n} = P(N=n)$ 表示处于状态 $n$ 的平稳概率。对于处于平衡状态的生灭过程，相邻状态之间的局部（细致）平衡方程成立：\n$$\n\\pi_{n} \\cdot \\lambda = \\pi_{n+1} \\cdot \\mu (n+1), \\quad \\text{for all } n \\geq 0.\n$$\n求解此递推关系可得\n$$\n\\pi_{n+1} = \\frac{\\lambda}{\\mu (n+1)} \\pi_{n} \\quad \\Longrightarrow \\quad \\pi_{n} = \\pi_{0} \\prod_{k=0}^{n-1} \\frac{\\lambda}{\\mu (k+1)} = \\pi_{0} \\frac{(\\lambda/\\mu)^{n}}{n!}, \\quad \\text{for } n \\geq 1,\n$$\n其中 $\\pi_{0}$ 待由归一化条件确定。施加 $\\sum_{n=0}^{\\infty} \\pi_{n} = 1$ 的条件可得\n$$\n\\sum_{n=0}^{\\infty} \\pi_{n} = \\pi_{0} \\sum_{n=0}^{\\infty} \\frac{(\\lambda/\\mu)^{n}}{n!} = \\pi_{0} \\exp\\!\\left(\\frac{\\lambda}{\\mu}\\right) = 1,\n$$\n因此\n$$\n\\pi_{0} = \\exp\\!\\left(-\\frac{\\lambda}{\\mu}\\right).\n$$\n所以，\n$$\nP(N=n) = \\pi_{n} = \\exp\\!\\left(-\\frac{\\lambda}{\\mu}\\right) \\frac{\\left(\\frac{\\lambda}{\\mu}\\right)^{n}}{n!}, \\quad n = 0,1,2,\\ldots,\n$$\n这是一个均值为 $\\lambda/\\mu$ 的泊松分布。", "answer": "$$\\boxed{\\exp\\!\\left(-\\frac{\\lambda}{\\mu}\\right)\\,\\frac{\\left(\\frac{\\lambda}{\\mu}\\right)^{n}}{n!}}$$", "id": "1333907"}, {"introduction": "现实系统中的速率往往会根据系统状态动态调整，而非一成不变。这个练习将带你分析一个特殊的排队系统，其中任务的到达率根据系统中已有任务数的奇偶性在两个值之间交替 [@problem_id:1333904]。解决这个问题需要你更细致地应用平衡方程，将状态分为奇数和偶数组进行迭代，这个过程不仅能锻炼你处理状态依赖速率的能力，还能让你在实践中掌握几何级数的求和技巧，这是解决更复杂随机模型的重要一步。", "problem": "考虑一个用于专业数据处理中心的单服务器排队系统模型。新的处理作业根据泊松过程到达，但到达率取决于系统中已有的作业数量 $n$。具体来说，当作业数量 $n$ 为偶数（包括零）时，到达率为 $\\lambda_n = a$。当作业数量 $n$ 为奇数时，到达率为 $\\lambda_n = b$。每个作业的服务时间服从指数分布，导致当 $n \\ge 1$ 时，服务率为常数 $\\mu_n = \\mu$。这意味着只要系统不为空，作业就以速率 $\\mu$ 被处理并离开系统。\n\n假设系统达到稳态，并且满足稳定性条件，从而确保存在平稳分布。你的任务是求出系统为空的概率，记为 $P_0$。请用参数 $a$、$b$ 和 $\\mu$ 将你的答案表示为封闭形式的解析表达式。", "solution": "将系统建模为生灭过程，其出生率为 $\\lambda_{n}$，死亡率为 $\\mu_{n}$。在稳态下，对所有 $n \\ge 0$ 局部平衡成立：\n$$\n\\pi_{n} \\lambda_{n} = \\pi_{n+1} \\mu_{n+1},\n$$\n其中 $\\pi_{n} = P\\{N=n\\}$ 且当 $n \\ge 1$ 时 $\\mu_{n}=\\mu$。因此，对 $n \\ge 0$ 有，\n$$\n\\pi_{n+1} = \\pi_{n} \\frac{\\lambda_{n}}{\\mu}.\n$$\n令 $P_{0}=\\pi_{0}$。使用交替的出生率，即当 $n$ 为偶数时 $\\lambda_{n}=a$ 和当 $n$ 为奇数时 $\\lambda_{n}=b$，迭代递推关系可得\n$$\n\\pi_{1} = P_{0} \\frac{a}{\\mu}, \\quad\n\\pi_{2} = P_{0} \\frac{ab}{\\mu^{2}}, \\quad\n\\pi_{3} = P_{0} \\frac{a^{2} b}{\\mu^{3}}, \\quad\n\\pi_{4} = P_{0} \\frac{a^{2} b^{2}}{\\mu^{4}}, \\ \\ldots\n$$\n定义 $r = \\frac{ab}{\\mu^{2}}$。则对 $m \\ge 0$ 有，\n$$\n\\pi_{2m} = P_{0} r^{m}, \n\\qquad\n\\pi_{2m+1} = P_{0} \\frac{a}{\\mu} r^{m}.\n$$\n归一化条件 $\\sum_{n=0}^{\\infty} \\pi_{n} = 1$ 给出\n$$\n1 = \\sum_{m=0}^{\\infty} \\pi_{2m} + \\sum_{m=0}^{\\infty} \\pi_{2m+1}\n= P_{0} \\sum_{m=0}^{\\infty} r^{m} + P_{0} \\frac{a}{\\mu} \\sum_{m=0}^{\\infty} r^{m}\n= P_{0} \\left(1 + \\frac{a}{\\mu}\\right) \\sum_{m=0}^{\\infty} r^{m}.\n$$\n在稳定性条件 $ab < \\mu^{2}$ 下，几何级数求和为\n$$\n\\sum_{m=0}^{\\infty} r^{m} = \\frac{1}{1 - r}.\n$$\n因此，\n$$\nP_{0} = \\frac{1 - r}{1 + \\frac{a}{\\mu}} = \\frac{1 - \\frac{ab}{\\mu^{2}}}{1 + \\frac{a}{\\mu}} = \\frac{\\mu^{2} - ab}{\\mu^{2} + a \\mu}.\n$$", "answer": "$$\\boxed{\\frac{\\mu^{2} - ab}{\\mu^{2} + a \\mu}}$$", "id": "1333904"}, {"introduction": "生滅過程是模擬化學反應動力學的強大工具，這個練習將帶你探索一個有趣的化學反應模型 [@problem_id:1333917]。在這個模型中，分子以恆定速率生成，但以“成對反應”的方式被消耗，這導致了一个非線性的死亡率 $\\mu_n = \\beta n(n-1)$。通过解决这个问题，你将理解死亡率的特殊形式如何导致某些状态成为暂态，并看到稳态分布可能只存在于状态空间的一个子集上。这个问题是检验你综合应用平衡方程、处理级数求和以及将结果与特殊函数联系起来的能力的绝佳机会。", "problem": "考虑一个在充分混合溶液中化学反应的简化模型。一种分子，我们称之为 $X$，以恒定速率 $\\alpha > 0$ 合成。同时，$X$ 分子通过需要一对分子相互作用的反应被消耗。单个 $X$ 分子被消耗的事件发生的速率与可用的 $X$ 分子对的数量成正比。\n\n设 $N(t)$ 是时刻 $t$ 时 $X$ 分子的数量。我们将此系统建模为在非负整数集 $\\{0, 1, 2, ...\\}$ 上的连续时间马尔可夫链。生率，对应于新分子的产生（从状态 $n$ 转移到 $n+1$），由 $\\lambda_n = \\alpha$ 给出，对所有 $n \\ge 0$ 成立。亡率，对应于单个分子的消耗（从状态 $n$ 转移到 $n-1$），由 $\\mu_n = \\beta n(n-1)$ 给出，对所有 $n \\ge 0$ 成立，其中 $\\beta > 0$ 是一个速率常数。注意，此定义意味着 $\\mu_0 = 0$ 和 $\\mu_1 = 0$。\n\n假设当 $t \\to \\infty$ 时，系统达到一个平稳（或稳态）分布。计算在稳态下系统中分子的期望数量 $E[N]$。用比率 $\\rho = \\alpha/\\beta$ 和第一类修正贝塞尔函数 $I_0(z)$ 与 $I_1(z)$ 表示你的答案。", "solution": "该问题描述了一个生灭过程，其中状态 $n$ 代表分子的数量。生率为 $\\lambda_n = \\alpha$（对 $n \\ge 0$），亡率为 $\\mu_n = \\beta n(n-1)$（对 $n \\ge 0$）。\n\n首先，我们分析该过程在平稳状态下的状态空间。从状态 $n=1$ 的亡率为 $\\mu_1 = \\beta(1)(1-1) = 0$。这意味着如果系统处于状态 1，它不能转移到状态 0。可能发生一次生育，使系统移动到状态 2，从该状态开始可能发生死亡（$\\mu_2 = 2\\beta > 0$）。因此，一旦过程达到任何状态 $n \\ge 1$，它就永远无法返回到状态 0。所以，状态 0 是一个暂态，平稳分布将集中在正整数集 $S = \\{1, 2, 3, ...\\}$ 上。设 $\\pi_n$ 为具有 $n$ 个分子的平稳概率，其中 $n \\in S$。\n\n平稳分布通过求解细致平衡方程得到：\n$$ \\pi_n \\lambda_n = \\pi_{n+1} \\mu_{n+1} \\quad \\text{for } n \\ge 1 $$\n代入给定的速率：\n$$ \\pi_n \\alpha = \\pi_{n+1} \\beta(n+1)(n+1-1) = \\pi_{n+1} \\beta n(n+1) \\quad \\text{for } n \\ge 1 $$\n我们可以用 $\\pi_n$ 来表示 $\\pi_{n+1}$：\n$$ \\pi_{n+1} = \\pi_n \\frac{\\alpha}{\\beta n(n+1)} $$\n我们可以解这个递推关系，用 $\\pi_1$ 来表示所有的 $\\pi_n$。\n对于 $n=2$：\n$$ \\pi_2 = \\pi_1 \\frac{\\alpha}{\\beta \\cdot 1 \\cdot 2} = \\pi_1 \\frac{\\rho}{2 \\cdot 1} $$\n其中我们定义了 $\\rho = \\alpha/\\beta$。\n对于 $n=3$：\n$$ \\pi_3 = \\pi_2 \\frac{\\alpha}{\\beta \\cdot 2 \\cdot 3} = \\left(\\pi_1 \\frac{\\rho}{2 \\cdot 1}\\right) \\frac{\\rho}{3 \\cdot 2} = \\pi_1 \\frac{\\rho^2}{(3 \\cdot 2 \\cdot 1)(2 \\cdot 1)} = \\pi_1 \\frac{\\rho^2}{3! 2!} $$\n通过归纳法，对于 $n \\ge 2$，通式为：\n$$ \\pi_n = \\pi_1 \\prod_{k=1}^{n-1} \\frac{\\alpha}{\\beta k(k+1)} = \\pi_1 \\frac{\\rho^{n-1}}{\\prod_{k=1}^{n-1} k(k+1)} = \\pi_1 \\frac{\\rho^{n-1}}{(\\prod_{k=1}^{n-1} k)(\\prod_{k=1}^{n-1} (k+1))} $$\n$$ \\pi_n = \\pi_1 \\frac{\\rho^{n-1}}{(n-1)! n!} $$\n此公式对 $n \\ge 2$ 有效。对于 $n=1$，我们只有 $\\pi_1$。\n\n为了找到 $\\pi_1$，我们使用归一化条件 $\\sum_{n=1}^{\\infty} \\pi_n = 1$：\n$$ 1 = \\pi_1 + \\sum_{n=2}^{\\infty} \\pi_n = \\pi_1 + \\sum_{n=2}^{\\infty} \\pi_1 \\frac{\\rho^{n-1}}{n!(n-1)!} = \\pi_1 \\left(1 + \\sum_{n=2}^{\\infty} \\frac{\\rho^{n-1}}{n!(n-1)!}\\right) $$\n我们来分析这个和式。令 $j = n-1$。和式变为 $\\sum_{j=1}^{\\infty} \\frac{\\rho^j}{(j+1)!j!}$。\n阶数为 $\\nu$ 的第一类修正贝塞尔函数定义为 $I_\\nu(z) = \\sum_{k=0}^{\\infty} \\frac{1}{k! \\Gamma(k+\\nu+1)} (\\frac{z}{2})^{2k+\\nu}$。\n对于 $\\nu=1$，我们有 $I_1(z) = \\sum_{k=0}^{\\infty} \\frac{1}{k! (k+1)!} (\\frac{z}{2})^{2k+1}$。\n令 $z=2\\sqrt{\\rho}$。则 $z/2 = \\sqrt{\\rho}$，我们有\n$I_1(2\\sqrt{\\rho}) = \\sum_{k=0}^{\\infty} \\frac{1}{k!(k+1)!} (\\sqrt{\\rho})^{2k+1} = \\sqrt{\\rho} \\sum_{k=0}^{\\infty} \\frac{\\rho^k}{k!(k+1)!}$。\n两边除以 $\\sqrt{\\rho}$ 得到：\n$$ \\frac{I_1(2\\sqrt{\\rho})}{\\sqrt{\\rho}} = \\sum_{k=0}^{\\infty} \\frac{\\rho^k}{k!(k+1)!} = \\frac{\\rho^0}{0!1!} + \\sum_{k=1}^{\\infty} \\frac{\\rho^k}{k!(k+1)!} = 1 + \\sum_{j=1}^{\\infty} \\frac{\\rho^j}{j!(j+1)!} $$\n我们归一化方程中的和式正是这个级数，所以 $\\sum_{n=2}^{\\infty} \\frac{\\rho^{n-1}}{n!(n-1)!} = \\frac{I_1(2\\sqrt{\\rho})}{\\sqrt{\\rho}} - 1$。\n将此代回归一化方程：\n$$ 1 = \\pi_1 \\left(1 + \\left(\\frac{I_1(2\\sqrt{\\rho})}{\\sqrt{\\rho}} - 1\\right)\\right) = \\pi_1 \\frac{I_1(2\\sqrt{\\rho})}{\\sqrt{\\rho}} $$\n解出 $\\pi_1$：\n$$ \\pi_1 = \\frac{\\sqrt{\\rho}}{I_1(2\\sqrt{\\rho})} $$\n现在我们可以计算分子的期望数量 $E[N]$：\n$$ E[N] = \\sum_{n=1}^{\\infty} n \\pi_n = 1 \\cdot \\pi_1 + \\sum_{n=2}^{\\infty} n \\pi_n = \\pi_1 + \\sum_{n=2}^{\\infty} n \\left(\\pi_1 \\frac{\\rho^{n-1}}{n!(n-1)!}\\right) $$\n$$ E[N] = \\pi_1 \\left(1 + \\sum_{n=2}^{\\infty} \\frac{n \\rho^{n-1}}{n!(n-1)!}\\right) = \\pi_1 \\left(1 + \\sum_{n=2}^{\\infty} \\frac{\\rho^{n-1}}{(n-1)!(n-1)!}\\right) $$\n我们来分析这第二个和式。令 $j = n-1$。和式变为 $\\sum_{j=1}^{\\infty} \\frac{\\rho^j}{(j!)^2}$。\n阶数为 $\\nu=0$ 的第一类修正贝塞尔函数是 $I_0(z) = \\sum_{k=0}^{\\infty} \\frac{1}{(k!)^2} (\\frac{z}{2})^{2k}$。\n令 $z=2\\sqrt{\\rho}$。那么我们有：\n$$ I_0(2\\sqrt{\\rho}) = \\sum_{k=0}^{\\infty} \\frac{\\rho^k}{(k!)^2} = \\frac{\\rho^0}{(0!)^2} + \\sum_{k=1}^{\\infty} \\frac{\\rho^k}{(k!)^2} = 1 + \\sum_{j=1}^{\\infty} \\frac{\\rho^j}{(j!)^2} $$\n所以 $E[N]$ 表达式中的和式是 $I_0(2\\sqrt{\\rho}) - 1$。\n将此代入 $E[N]$ 的表达式中：\n$$ E[N] = \\pi_1 \\left(1 + (I_0(2\\sqrt{\\rho}) - 1)\\right) = \\pi_1 I_0(2\\sqrt{\\rho}) $$\n最后，我们代入我们找到的 $\\pi_1$ 的表达式：\n$$ E[N] = \\frac{\\sqrt{\\rho}}{I_1(2\\sqrt{\\rho})} I_0(2\\sqrt{\\rho}) = \\sqrt{\\rho} \\frac{I_0(2\\sqrt{\\rho})}{I_1(2\\sqrt{\\rho})} $$\n这就是稳态下分子期望数量的最终表达式。", "answer": "$$\\boxed{\\sqrt{\\rho} \\frac{I_0(2\\sqrt{\\rho})}{I_1(2\\sqrt{\\rho})}}$$", "id": "1333917"}]}