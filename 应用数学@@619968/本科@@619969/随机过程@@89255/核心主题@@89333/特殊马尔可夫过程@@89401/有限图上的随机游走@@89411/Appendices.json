{"hands_on_practices": [{"introduction": "随机游走的一个基本问题是计算从一个状态首次到达另一个状态所需的平均步数，这被称为“首次到达时间”。这项练习通过一个直观的机器人清洁走廊的场景，引导你使用一种称为“一步分析” (first-step analysis) 的强大技术来解决这类问题。掌握这项技术是分析随机过程吸收特性的关键。[@problem_id:1329640]", "problem": "一个自动清洁机器人沿着一条连接着三个房间的狭窄走廊移动，我们可以将这三个位置标记为1、2和3，它们呈一条直线排列。位置2在中间，与1和3都相邻。位置1和3在走廊的两端，各自只与位置2相邻。\n\n机器人从位置1出发。在每个时间步，它会从当前位置移动到一个相邻的位置。移动到哪个相邻位置的选择是均匀随机的。例如，从位置2出发，它以1/2的概率移动到位置1，以1/2的概率移动到位置3。从一个端点位置（1或3）出发，它只有一个相邻位置，因此它以概率1移动到该位置。\n\n当机器人首次到达位置3时，其任务被视为完成。计算机器人完成任务所需步骤的期望值。", "solution": "定义状态空间为位置 $\\{1,2,3\\}$ 的马尔可夫链，其中位置$3$为吸收态（任务在首次到达$3$时完成）。令 $T$ 为到达状态$3$的首达时间，令 $E_{i}=\\mathbb{E}[T\\mid \\text{start at }i]$ 为从位置 $i$ 出发的期望步数，$i\\in\\{1,2,3\\}$。\n\n根据马尔可夫性质和全期望定律（首步分析法）：\n- 从位置$3$出发，任务已完成，所以 $E_{3}=0$。\n- 从位置$1$出发，机器人确定地用一步移动到位置$2$，所以\n$$\nE_{1}=1+E_{2}.\n$$\n- 从位置$2$出发，机器人以概率 $\\frac{1}{2}$ 移动到$1$，以概率 $\\frac{1}{2}$ 移动到$3$，这会消耗一步并加上剩余的期望时间，因此\n$$\nE_{2}=1+\\frac{1}{2}E_{1}+\\frac{1}{2}E_{3}.\n$$\n\n使用 $E_{3}=0$ 的条件，我们得到\n$$\nE_{2}=1+\\frac{1}{2}E_{1}.\n$$\n将此结果代入 $E_{1}=1+E_{2}$ 中：\n$$\nE_{1}=1+\\left(1+\\frac{1}{2}E_{1}\\right)=2+\\frac{1}{2}E_{1}.\n$$\n整理方程以解出 $E_{1}$：\n$$\nE_{1}-\\frac{1}{2}E_{1}=2 \\quad \\Rightarrow \\quad \\frac{1}{2}E_{1}=2 \\quad \\Rightarrow \\quad E_{1}=4.\n$$\n\n因此，从位置$1$出发到达位置$3$所需的期望步数为$4$。", "answer": "$$\\boxed{4}$$", "id": "1329640"}, {"introduction": "随机游走在长时间运行后会呈现出怎样的行为？这个问题的答案在于“平稳分布”，它描述了游走最终停留在每个状态的概率。本练习通过比较一个标准随机游走和一个“懒惰”随机游走，让你探究图的结构（如顶点的度）和游走规则如何共同决定其长期行为。[@problem_id:1329662]", "problem": "考虑一个有三个离散状态的系统，标记为 $\\{1, 2, 3\\}$。这些状态排列成一个线性链，其中状态1仅与状态2相连，状态3仅与状态2相连，而状态2与状态1和状态3都相连。在这个状态集上定义了两种不同的随机游走过程。\n\n**过程1：简单随机游走**\n一个粒子以离散时间步演化。在每一步中，粒子会从其当前状态移动到一个与之相连的邻接状态，并以等概率选择每个邻居。\n\n**过程2：懒惰随机游走**\n这个过程也以离散时间步演化。在每一步中，粒子有 $\\frac{1}{2}$ 的概率停留在当前状态。以剩余的 $\\frac{1}{2}$ 概率，它会移动到一个与之相连的邻接状态，并以等概率选择每个邻居。\n\n令 $\\pi_S = (\\pi_1^S, \\pi_2^S, \\pi_3^S)$ 表示简单随机游走的平稳概率分布，令 $\\pi_L = (\\pi_1^L, \\pi_2^L, \\pi_3^L)$ 表示懒惰随机游走的平稳概率分布。在此记法中，$\\pi_i$ 表示在状态 $i$ 中找到粒子的长期概率。\n\n下列哪个陈述正确描述了 $\\pi_S$ 和 $\\pi_L$ 之间的关系？\n\nA. $\\pi_S = \\pi_L$。\nB. 懒惰随机游走增加了处于中心状态的概率，即 $\\pi_2^L > \\pi_2^S$。\nC. 懒惰随机游走增加了处于末端状态的概率，即 $\\pi_1^L > \\pi_1^S$ 且 $\\pi_3^L > \\pi_3^S$。\nD. 懒惰随机游走的平稳分布是均匀分布，即 $\\pi_L = (1/3, 1/3, 1/3)$。\nE. 简单随机游走的平稳分布 $\\pi_S$ 不存在，因为该链是周期性的。", "solution": "我们将这三个状态建模为路径图，其顶点为 $\\{1,2,3\\}$，边为 $\\{(1,2),(2,3)\\}$。各个顶点的度分别为 $d_{1}=1$, $d_{2}=2$, $d_{3}=1$，总度数为 $\\sum_{i=1}^{3} d_{i}=4$。\n\n对于简单随机游走，如果状态 $i$ 和 $j$ 相邻，则转移概率为 $P_{ij}^{S}=\\frac{1}{d_{i}}$，否则为 $0$。按状态顺序 $(1,2,3)$，这给出了转移矩阵\n$$\nP_{S}=\\begin{pmatrix}\n0 & 1 & 0 \\\\\n\\frac{1}{2} & 0 & \\frac{1}{2} \\\\\n0 & 1 & 0\n\\end{pmatrix}.\n$$\n平稳性的一个标准充分条件是细致平衡。定义 $\\pi_{i}^{S}=\\frac{d_{i}}{\\sum_{k} d_{k}}$，即，\n$$\n\\pi^{S}=\\left(\\frac{1}{4},\\frac{1}{2},\\frac{1}{4}\\right).\n$$\n那么对于相邻的 $i$ 和 $j$，\n$$\n\\pi_{i}^{S} P_{ij}^{S}=\\frac{d_{i}}{4}\\cdot\\frac{1}{d_{i}}=\\frac{1}{4}=\\frac{d_{j}}{4}\\cdot\\frac{1}{d_{j}}=\\pi_{j}^{S} P_{ji}^{S},\n$$\n而对于不相邻的对，两边都为 $0$。因此细致平衡条件成立，所以 $\\pi^{S}$ 是 $P_{S}$ 的平稳分布。尽管因为该图是二分图，$P_{S}$ 是周期性的（周期为 $2$），但该链是有限且不可约的，因此存在唯一的平稳分布；周期性影响收敛性，但不影响存在性。\n\n对于懒惰随机游走，转移矩阵为\n$$\nP_{L}=\\frac{1}{2} I+\\frac{1}{2} P_{S}=\\begin{pmatrix}\n\\frac{1}{2} & \\frac{1}{2} & 0 \\\\\n\\frac{1}{4} & \\frac{1}{2} & \\frac{1}{4} \\\\\n0 & \\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix}.\n$$\n如果 $\\pi$ 是 $P_{S}$ 的平稳分布，那么\n$$\n\\pi P_{L}=\\pi\\left(\\frac{1}{2} I+\\frac{1}{2} P_{S}\\right)=\\frac{1}{2}\\pi+\\frac{1}{2}(\\pi P_{S})=\\frac{1}{2}\\pi+\\frac{1}{2}\\pi=\\pi.\n$$\n因此，相同的 $\\pi$ 也是 $P_{L}$ 的平稳分布，所以 $\\pi^{L}=\\pi^{S}=\\left(\\frac{1}{4},\\frac{1}{2},\\frac{1}{4}\\right)$。因此：\n- 陈述 A 是正确的。\n- 陈述 B 和 C 是错误的，因为平稳分布是相等的。\n- 陈述 D 是错误的，因为由于度不相等，平稳分布不是均匀分布。\n- 陈述 E 是错误的，因为即使简单链是周期性的，平稳分布也确实存在。\n\n因此，正确选项是 A。", "answer": "$$\\boxed{A}$$", "id": "1329662"}, {"introduction": "在许多物理和生物过程中，随机游走会在到达某些特定边界时结束，这被称为“吸收”。本练习将经典的一维随机游走问题（通常称为“赌徒破产问题”）推广到了一个更复杂的情景，其中一个边界是部分吸收的。你将学习如何通过建立和求解差分方程来计算在存在多种吸收结果时，游走以特定方式结束的概率。[@problem_id:1329646]", "problem": "考虑一个简化的电子沿线性聚合物链输运的一维模型，该链有 $n$ 个分子位点，依次标记为 $1, 2, \\dots, n$，其中 $n$ 是大于2的整数。一个电子初始位于位点 $k$，其中 $k$ 是满足 $1 < k < n$ 的整数。电子的运动遵循离散时间随机游走。\n\n运动规则如下：\n- 从任何内部位点 $i$（其中 $1 < i < n$），电子在一个时间步内会以 $1/2$ 的概率跳到 $i-1$ 位点，或以 $1/2$ 的概率跳到 $i+1$ 位点。\n- 位点1是一个完美的“陷阱”。如果电子到达位点1，它会立即被永久吸收。\n- 位点 $n$ 是一个“泄漏出口”。如果电子位于位点 $n$，在下一步中，它要么以概率 $p$（其中 $0 < p \\le 1$）从聚合物链中弹出，要么以概率 $1-p$ 反射回位点 $n-1$。一旦弹出，过程即停止。\n\n求电子最终通过位点 $n$ 从链中弹出，而不是在位点1的陷阱被吸收的概率。请用 $n$、$k$ 和 $p$ 的解析表达式表示你的答案。", "solution": "设 $f_{i}$ 表示从位点 $i$ 出发，电子最终通过位点 $n$ 弹出的概率。根据马尔可夫性质和给定的转移规则：\n- 在陷阱处，$f_{1}=0$。\n- 在泄漏出口处，对下一步进行条件化可得 $f_{n}=p+(1-p)f_{n-1}$。\n- 对于内部位点 $1<i<n$，随机游走在一个步长内向左或向右移动的概率相等，因此\n$$\nf_{i}=\\frac{1}{2}f_{i-1}+\\frac{1}{2}f_{i+1} \\quad \\text{for } 1<i<n,\n$$\n这等价于齐次二阶差分方程\n$$\nf_{i+1}-2f_{i}+f_{i-1}=0.\n$$\n\n为求解内部的递推关系，使用特征方程法。寻找 $f_{i}=r^{i}$ 形式的解可得\n$$\nr^{2}-2r+1=0 \\quad \\Rightarrow \\quad (r-1)^{2}=0,\n$$\n因此在 $1\\leq i\\leq n$ 上的通解是线性的：\n$$\nf_{i}=Ai + B,\n$$\n其中 $A$ 和 $B$ 是常数。应用在 $i=1$ 处的边界条件：\n$$\nf_{1}=A\\cdot 1 + B=0 \\quad \\Rightarrow \\quad B=-A.\n$$\n因此 $f_{i}=A(i-1)$。在 $i=n$ 和 $i=n-1$ 处求值：\n$$\nf_{n}=A(n-1), \\qquad f_{n-1}=A(n-2).\n$$\n使用在 $n$ 处的泄漏边界条件：\n$$\nf_{n}=p+(1-p)f_{n-1} \\quad \\Rightarrow \\quad A(n-1)=p+(1-p)A(n-2).\n$$\n整理得，\n$$\nA\\big[(n-1)-(1-p)(n-2)\\big]=p \\quad \\Rightarrow \\quad A\\big[1+p(n-2)\\big]=p,\n$$\n所以\n$$\nA=\\frac{p}{1+p(n-2)}.\n$$\n因此，对于初始位点 $k$（$1<k<n$），\n$$\nf_{k}=A(k-1)=\\frac{p(k-1)}{1+p(n-2)}.\n$$\n\n这就是所求的电子最终通过位点 $n$ 弹出而不是在位点 $1$ 被吸收的概率。", "answer": "$$\\boxed{\\frac{p(k-1)}{1+p(n-2)}}$$", "id": "1329646"}]}