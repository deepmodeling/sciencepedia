{"hands_on_practices": [{"introduction": "要掌握分支过程，最核心的技能之一便是计算其最终灭绝的概率。这个练习提供了一个经典的场景——社交网络上一个“病毒式”模因的传播——来让你实践这一基本功。你将学习如何根据后代分布构建概率生成函数（PGF），并求解核心不动点方程 $q = G(q)$，从而确定这个模因的传播链最终中断的可能性 [@problem_id:1304392]。", "problem": "一个病毒式模因在社交网络上传播的简化模型由一个离散时间分支过程描述。该过程从第0代的一个发布该模因的单一用户开始。在第$n$代拥有该模因的每个用户都会独立地将其分享给一定数量的新用户，这些新用户继而构成第$n+1$代。个体分享模因的新用户数量是一个随机变量。具体而言，任何给定用户将模因分享给：\n- 0个新用户，概率为 $p_0 = 0.2$。\n- 1个新用户，概率为 $p_1 = 0.5$。\n- 2个新用户，概率为 $p_2 = 0.3$。\n- 一个用户不可能将模因分享给超过2个新用户。\n\n如果某一代的用户数为零，则认为此过程已灭绝。假设该过程从单个初始用户开始，计算该模因的传播最终停止的长期概率。", "solution": "设 $Z_{n}$ 为 Galton–Watson 分支过程中第 $n$ 代的用户数，其后代分布的支撑集为 $\\{0,1,2\\}$，其中一个用户分别以概率 $p_{0}=\\frac{1}{5}$、$p_{1}=\\frac{1}{2}$、$p_{2}=\\frac{3}{10}$ 分享给 $0,1,2$ 个新用户。灭绝概率 $q$（从一个初始用户开始）是定点方程 $q=f(q)$ 在 $[0,1]$ 区间内的最小解，其中后代生成函数为\n$$\nf(s)=\\sum_{k=0}^{2}p_{k}s^{k}=\\frac{1}{5}+\\frac{1}{2}s+\\frac{3}{10}s^{2}.\n$$\n首先，检验新用户的平均数：\n$$\nm=f'(1)=\\frac{1}{2}+2\\cdot\\frac{3}{10}=\\frac{1}{2}+\\frac{3}{5}=\\frac{11}{10}1,\n$$\n因此该过程是超临界的，且灭绝概率满足 $q1$。求解 $q=f(q)$：\n$$\ns=\\frac{1}{5}+\\frac{1}{2}s+\\frac{3}{10}s^{2}\n\\;\\Longleftrightarrow\\;\n\\frac{3}{10}s^{2}-\\frac{1}{2}s+\\frac{1}{5}=0\n\\;\\Longleftrightarrow\\;\n3s^{2}-5s+2=0.\n$$\n根据二次方程求根公式，\n$$\ns=\\frac{5\\pm\\sqrt{25-24}}{6}=\\frac{5\\pm 1}{6}\\in\\left\\{1,\\;\\frac{2}{3}\\right\\}.\n$$\n灭绝概率是 $[0,1]$ 中的较小根，因此 $q=\\frac{2}{3}$。", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "1304392"}, {"introduction": "在掌握了如何计算基本的灭绝概率 $q$ 之后，一个自然而然的进阶问题是：如果我们拥有了关于过程的部分信息，情况会如何变化？这个练习将挑战你进行更深层次的思考，特别是推导在过程至少存活了一代 ($Z_1 > 0$) 的条件下，最终灭绝的概率。这不仅能加深你对条件概率的理解，还能让你体会到概率生成函数在推导普适性结论时的分析威力 [@problem_id:1304391]。", "problem": "考虑一个 Galton-Watson 分支过程 $\\{Z_n\\}_{n \\ge 0}$，其中 $Z_n$ 是第 $n$ 代的种群大小。该过程从单个祖先开始，因此 $Z_0 = 1$。种群中的每个个体根据一个固定的概率分布，独立地产生随机数量的后代。\n\n设此后代分布的概率生成函数 (PGF) 为 $G(s) = \\sum_{k=0}^{\\infty} p_k s^k$，其中 $p_k$ 是一个个体拥有 $k$ 个后代的概率。假设平均后代数大于 1，即 $G'(1) > 1$。设 $E$ 为最终灭绝事件，即种群最终消亡。\n\n求解条件概率 $P(E | Z_1 > 0)$ 的表达式。你的最终答案应该是一个用 PGF $G(s)$ 和无条件灭绝概率（我们记作 $q$）表示的解析表达式。", "solution": "设 $q$ 表示从单个祖先开始的无条件灭绝概率。根据分支特性，在 $Z_{1}=k$ 的条件下，此后的过程是 $k$ 个独立同分布的原始过程之和，因此在给定 $Z_{1}=k$ 的情况下最终灭绝的概率为\n$$\nP(E \\mid Z_{1}=k)=q^{k}。\n$$\n因此，\n$$\nP(E \\mid Z_{1}0)=\\sum_{k=1}^{\\infty}P(E \\mid Z_{1}=k)\\,P(Z_{1}=k \\mid Z_{1}0)=\\sum_{k=1}^{\\infty}q^{k}\\,\\frac{p_{k}}{1-p_{0}}=\\frac{\\sum_{k=1}^{\\infty}p_{k}q^{k}}{1-p_{0}}。\n$$\n使用 PGF $G(s)=\\sum_{k=0}^{\\infty}p_{k}s^{k}$，我们可得 $\\sum_{k=1}^{\\infty}p_{k}q^{k}=G(q)-p_{0}$ 且 $p_{0}=G(0)$。因此，\n$$\nP(E \\mid Z_{1}0)=\\frac{G(q)-G(0)}{1-G(0)}。\n$$\n由于 $q$ 是 $G$ 在 $[0,1]$ 上的最小不动点，我们有 $G(q)=q$，因此一个等价形式是\n$$\nP(E \\mid Z_{1}0)=\\frac{q-G(0)}{1-G(0)}。\n$$\n这两个表达式都是用 $G$ 和 $q$ 表示的解析式。", "answer": "$$\\boxed{\\frac{q - G(0)}{1 - G(0)}}$$", "id": "1304391"}, {"introduction": "生成函数法的强大之处远不止于计算灭绝概率。这个练习将引导你探索一个全新的、同样重要的随机变量：总后代数（total progeny），即包括始祖在内的、在整个过程历史中出现过的所有个体的总和。你将接触到一个优美的函数方程 $H(s) = sG(H(s))$，它将总后代的生成函数 $H(s)$ 与单一个体的后代生成函数 $G(s)$ 联系起来，并亲手解出这个方程，从而体会到生成函数如何成为分析复杂随机变量的利器 [@problem_id:1304403]。", "problem": "Galton-Watson 分支过程是一种用于描述种群增长的随机模型，该过程在离散的代际中演化。该过程从第 $n=0$ 代的一个始祖开始。该始祖产生随机数量的后代，这些后代构成了第 $n=1$ 代。然后，第 $n$ 代中的每个个体都遵循相同的概率分布，独立地产生随机数量的后代，从而形成第 $n+1$ 代。\n\n考虑一个特定的分支过程，其中任何给定个体的后代数量 $X$ 是一个取整数值 $k \\geq 0$ 的随机变量。$X$ 的概率质量函数由下式给出\n$$\nP(X=k) = \\left(\\frac{1}{2}\\right)^{k+1}, \\quad \\text{for } k = 0, 1, 2, \\ldots\n$$\n离散随机变量 $X$ 的概率生成函数 (PGF) 定义为 $G(s) = E[s^X]$。\n\n令 $Y$ 为表示该过程的总后代数的随机变量，其定义为曾经存在过的个体总数，包括最初的始祖。求总后代数 $Y$ 的概率生成函数 $H(s) = E[s^Y]$ 的闭式表达式。", "solution": "我们首先计算后代概率生成函数。对于给定的后代分布，\n$$\nG(s) \\equiv \\mathbb{E}[s^{X}] = \\sum_{k=0}^{\\infty} s^{k} \\left(\\frac{1}{2}\\right)^{k+1} = \\frac{1}{2} \\sum_{k=0}^{\\infty} \\left(\\frac{s}{2}\\right)^{k}.\n$$\n当 $|r|1$ 时，使用几何级数恒等式 $\\sum_{k=0}^{\\infty} r^{k} = \\frac{1}{1-r}$，我们得到\n$$\nG(s) = \\frac{1}{2} \\cdot \\frac{1}{1 - \\frac{s}{2}} = \\frac{1}{2 - s}.\n$$\n\n令 $Y$ 表示总后代数（包括始祖）。在一个从单个始祖开始的 Galton-Watson 过程中，$Y$ 满足以下分解式\n$$\nY = 1 + \\sum_{i=1}^{X} Y_{i},\n$$\n其中，在给定 $X$ 的条件下，$Y_{i}$ 是 $Y$ 的独立副本，且独立于 $X$。对两边取概率生成函数，并利用独立性，\n$$\nH(s) \\equiv \\mathbb{E}[s^{Y}] = \\mathbb{E}\\!\\left[s^{1 + \\sum_{i=1}^{X} Y_{i}}\\right] = s\\, \\mathbb{E}\\!\\left[\\prod_{i=1}^{X} s^{Y_{i}}\\right] = s\\, \\mathbb{E}\\!\\left[\\mathbb{E}\\!\\left[\\prod_{i=1}^{X} s^{Y_{i}} \\,\\bigg|\\, X\\right]\\right].\n$$\n给定 $X=k$ 时，我们有 $\\prod_{i=1}^{k} s^{Y_{i}} = \\left(\\mathbb{E}[s^{Y}]\\right)^{k} = \\left(H(s)\\right)^{k}$。因此，\n$$\nH(s) = s\\, \\mathbb{E}\\!\\left[(H(s))^{X}\\right] = s\\, G\\!\\left(H(s)\\right).\n$$\n将 $G(u) = \\frac{1}{2 - u}$ 代入 $H(s) = s\\, G(H(s))$，得到如下函数方程\n$$\nH(s) = \\frac{s}{2 - H(s)}.\n$$\n整理后得到一个关于 $H(s)$ 的二次方程：\n$$\nH(s)\\left(2 - H(s)\\right) = s \\quad \\Longleftrightarrow \\quad H(s)^{2} - 2 H(s) + s = 0.\n$$\n解这个二次方程，\n$$\nH(s) = 1 \\pm \\sqrt{1 - s}.\n$$\n为了选择正确的分支，我们使用 PGF 的边界条件 $H(0) = \\mathbb{E}[0^{Y}] = 0$，因为 $Y \\geq 1$。在 $s=0$ 处求值可得 $H(0) = 1 \\pm 1$，因此有效的选择是\n$$\nH(s) = 1 - \\sqrt{1 - s}.\n$$\n这也满足 PGF 所要求的 $H(1) = 1$。", "answer": "$$\\boxed{1 - \\sqrt{1 - s}}$$", "id": "1304403"}]}