{"hands_on_practices": [{"introduction": "这个练习将引导你完成分支过程中最基本的计算：预测种群的期望大小。通过应用核心公式 $\\mathbb{E}[Z_n] = \\mu^n Z_0$，你将能够量化一个种群在多代之后平均会发展到多大规模。这个例子 [@problem_id:1317895] 探讨了一个亚临界过程（$\\mu < 1$），这种情况下的种群平均规模会随时间减少，这为理解种群灭绝风险提供了初步的数学视角。", "problem": "一个保护生物学家团队正在研究一种新发现的、极其稀有的生物发光真菌的种群动态。他们使用 Galton-Watson 分支过程来为该真菌种群的增长建模。令 $Z_n$ 表示第 $n$ 代中独立真菌菌落的数量。研究始于一个存活的菌落，因此第零代的种群数量为 $Z_0 = 1$。\n\n每个菌落在完成其生命周期后，会产生随机数量的新后代菌落。根据大量的实验室观察，生物学家们确定任何单个菌落产生的后代平均数量为 $\\mu = 0.75$。\n\n假设该过程从这一个菌落开始，计算第6代中真菌菌落的期望数量。将你的答案以数值形式报告，并四舍五入到四位有效数字。", "solution": "给定一个 Galton-Watson 分支过程，其中 $Z_{0}=1$ 且平均后代数为 $\\mu=0.75$。在 Galton-Watson 过程中，期望种群大小满足以下递归关系\n$$\n\\mathbb{E}[Z_{n+1}\\mid Z_{n}] = \\mu Z_{n}.\n$$\n两边取期望并使用全期望定律，我们得到\n$$\n\\mathbb{E}[Z_{n+1}] = \\mathbb{E}[\\mathbb{E}[Z_{n+1}\\mid Z_{n}]] = \\mathbb{E}[\\mu Z_{n}] = \\mu\\,\\mathbb{E}[Z_{n}].\n$$\n在初始条件 $\\mathbb{E}[Z_{0}] = Z_{0} = 1$ 下，这个一阶线性递归关系的解为\n$$\n\\mathbb{E}[Z_{n}] = \\mu^{n}.\n$$\n对于 $n=6$ 和 $\\mu=0.75$，我们有\n$$\n\\mathbb{E}[Z_{6}] = (0.75)^{6} = \\left(\\frac{3}{4}\\right)^{6} = \\frac{3^{6}}{4^{6}} = \\frac{729}{4096} = 0.177978515625.\n$$\n四舍五入到四位有效数字，结果是 $0.1780$。", "answer": "$$\\boxed{0.1780}$$", "id": "1317895"}, {"introduction": "虽然期望值告诉我们种群规模的平均趋势，但它并未揭示随机性带来的巨大波动。这个练习 [@problem_id:1317871] 将带你更进一步，计算种群规模的方差，它是衡量围绕平均值波动的关键指标。通过这个实践，你将学会如何推导和计算方差，并理解后代数量的均值（$\\mu$）和方差（$\\sigma^2$）如何共同决定了种群未来的不确定性。", "problem": "在一项材料科学实验中，一个新设计的自复制纳米机器人在第 $n=0$ 代被放入一个合适的生长介质中。在随后的每一代中，每一个存在的纳米机器人都会产生随机数量的新的、相同的纳米机器人，然后其自身变为惰性。任何单个纳米机器人产生的“后代”数量与其他所有机器人独立，并服从均值为 $\\lambda = 1.5$ 的泊松分布。\n\n设 $Z_n$ 表示第 $n$ 代存在的纳米机器人总数。从 $Z_0=1$ 开始，计算第 $n=3$ 代时纳米机器人种群大小的均值和方差。\n\n按均值、方差的顺序，将你的答案作为一对数值报告，并四舍五入到四位有效数字。", "solution": "我们将种群 $\\{Z_{n}\\}_{n \\geq 0}$ 建模为一个 Galton–Watson 分支过程，其初始祖先为 $Z_{0}=1$。每个个体产生独立数量的后代 $X$，其中 $X \\sim \\text{Poisson}(\\lambda)$，所以\n$$\n\\mathbb{E}[X]=\\lambda,\\qquad \\operatorname{Var}(X)=\\lambda.\n$$\n给定 $Z_{n}$，下一代为\n$$\nZ_{n+1}=\\sum_{i=1}^{Z_{n}} X_{n,i},\n$$\n其中 $\\{X_{n,i}\\}$ 是 $X$ 的独立同分布 (i.i.d.) 副本，且独立于 $Z_{n}$。以 $Z_{n}$ 为条件，$Z_{n+1}$ 是 $Z_{n}$ 个独立的泊松$\\left(\\lambda\\right)$变量之和，因此\n$$\n\\mathbb{E}[Z_{n+1}\\mid Z_{n}] = \\lambda Z_{n},\\qquad \\operatorname{Var}(Z_{n+1}\\mid Z_{n})=\\lambda Z_{n}.\n$$\n\n均值。取期望得到递推关系\n$$\n\\mathbb{E}[Z_{n+1}] = \\lambda \\mathbb{E}[Z_{n}],\\quad \\mathbb{E}[Z_{0}]=1,\n$$\n其解为\n$$\n\\mathbb{E}[Z_{n}] = \\lambda^{n}.\n$$\n因此对于 $n=3$，\n$$\n\\mathbb{E}[Z_{3}] = \\lambda^{3}.\n$$\n\n方差。根据全方差公式，\n$$\n\\operatorname{Var}(Z_{n+1}) = \\mathbb{E}[\\operatorname{Var}(Z_{n+1}\\mid Z_{n})] + \\operatorname{Var}(\\mathbb{E}[Z_{n+1}\\mid Z_{n}])\n= \\mathbb{E}[\\lambda Z_{n}] + \\operatorname{Var}(\\lambda Z_{n})\n= \\lambda \\mathbb{E}[Z_{n}] + \\lambda^{2} \\operatorname{Var}(Z_{n}).\n$$\n由于 $\\mathbb{E}[Z_{n}] = \\lambda^{n}$ 且 $\\operatorname{Var}(Z_{0})=0$，我们得到递推关系\n$$\n\\operatorname{Var}(Z_{n+1}) = \\lambda^{n+1} + \\lambda^{2} \\operatorname{Var}(Z_{n}).\n$$\n迭代至 $n=3$：\n$$\n\\operatorname{Var}(Z_{1}) = \\lambda^{1},\n$$\n$$\n\\operatorname{Var}(Z_{2}) = \\lambda^{2} + \\lambda^{2}\\operatorname{Var}(Z_{1}) = \\lambda^{2} + \\lambda^{3},\n$$\n$$\n\\operatorname{Var}(Z_{3}) = \\lambda^{3} + \\lambda^{2}\\operatorname{Var}(Z_{2}) = \\lambda^{3} + \\lambda^{2}(\\lambda^{2} + \\lambda^{3}) = \\lambda^{3} + \\lambda^{4} + \\lambda^{5}.\n$$\n\n当 $\\lambda=1.5$ 时，第 $n=3$ 代的均值和方差为\n$$\n\\mathbb{E}[Z_{3}] = (1.5)^{3} = 3.375,\n$$\n$$\n\\operatorname{Var}(Z_{3}) = (1.5)^{3} + (1.5)^{4} + (1.5)^{5} = 16.03125.\n$$\n四舍五入到四位有效数字后，结果为 $3.375$ 和 $16.03$。", "answer": "$$\\boxed{\\begin{pmatrix}3.375 & 16.03\\end{pmatrix}}$$", "id": "1317871"}, {"introduction": "在掌握了基本均值和方差的计算后，我们来探讨一个更深入的问题：初始种群的不确定性如何影响其长期演化的方差？这个练习 [@problem_id:1317889] 通过对比一个从固定数量个体开始的过程与一个从随机数量个体开始的过程，展示了如何运用全方差公式来分解和理解随机性的不同来源。这不仅是一次计算技巧的提升，更是对随机模型进行更精细分析的入门。", "problem": "考虑一个Galton-Watson分支过程，该过程模拟了一个种群的演化。在此过程中，给定一代中的每个个体独立地为下一代产生随机数量的后代。任何单个个体产生的后代数量是一个随机变量，其均值为 $\\mu = 2$，方差为 $\\sigma^2 = 6$。由于 $\\mu > 1$，该过程是超临界的。\n\n我们分析在第 $n=0$ 代的初始种群 $X_0$ 的两种不同情景。\n\n**情景A：** 该过程始于一个固定的、非随机的种群，恰好有5个个体。令 $V_A(n)$ 表示在此情景下第 $n$ 代种群大小 $X_n$ 的方差。\n\n**情景B：** 该过程始于一个随机数量的个体。具体来说，初始种群大小 $X_0$ 服从参数为 $N=10$ 和 $p=1/2$ 的二项分布。令 $V_B(n)$ 表示在此情景下第 $n$ 代种群大小 $X_n$ 的方差。\n\n计算当繁衍的代数变得非常大时，这两个方差之比的极限值。即，求出极限 $\\lim_{n \\to \\infty} \\frac{V_B(n)}{V_A(n)}$ 的值。将您的答案表示为分数。", "solution": "令 $Z$ 表示后代随机变量，其均值为 $\\mu$，方差为 $\\sigma^{2}$。对于一个从 $k$ 个个体开始的Galton-Watson过程，根据谱系树的线性和独立性可得\n$$\n\\mathbb{E}[X_{n}\\mid X_{0}=k]=k \\mu^{n},\\qquad \\operatorname{Var}(X_{n}\\mid X_{0}=k)=k\\,v_{n},\n$$\n其中 $v_{n}=\\operatorname{Var}(X_{n}\\mid X_{0}=1)$。一个标准结果是（由递推式 $\\operatorname{Var}(X_{n+1}\\mid X_{0}=1)=\\mu^{2}\\operatorname{Var}(X_{n}\\mid X_{0}=1)+\\sigma^{2}\\mu^{n}$ 及初始条件 $v_{1}=\\sigma^{2}$ 得到）\n$$\nv_{n}=\\sigma^{2}\\,\\mu^{\\,n-1}\\,\\frac{\\mu^{n}-1}{\\mu-1}\\qquad(\\mu\\neq 1).\n$$\n\n情景A（确定性的 $X_{0}=5$）：\n$$\nV_{A}(n)=\\operatorname{Var}(X_{n})=5\\,v_{n}=5\\,\\sigma^{2}\\,\\mu^{\\,n-1}\\,\\frac{\\mu^{n}-1}{\\mu-1}.\n$$\n\n情景B（随机的 $X_{0}\\sim\\mathrm{Bin}(10,\\tfrac{1}{2})$）：根据全方差公式，\n$$\nV_{B}(n)=\\mathbb{E}[\\operatorname{Var}(X_{n}\\mid X_{0})]+\\operatorname{Var}(\\mathbb{E}[X_{n}\\mid X_{0}])\n= \\mathbb{E}[X_{0}]\\,v_{n}+\\mu^{2n}\\operatorname{Var}(X_{0}).\n$$\n由于 $\\mathbb{E}[X_{0}]=5$，此式变为\n$$\nV_{B}(n)=5\\,v_{n}+\\mu^{2n}\\operatorname{Var}(X_{0})=V_{A}(n)+\\mu^{2n}\\operatorname{Var}(X_{0}).\n$$\n\n因此\n$$\n\\frac{V_{B}(n)}{V_{A}(n)}=1+\\frac{\\mu^{2n}\\operatorname{Var}(X_{0})}{5\\,v_{n}}\n=1+\\frac{\\mu^{2n}\\operatorname{Var}(X_{0})}{5\\,\\sigma^{2}\\,\\mu^{\\,n-1}\\,(\\mu^{n}-1)/(\\mu-1)}\n=1+\\operatorname{Var}(X_{0})\\cdot\\frac{(\\mu-1)\\,\\mu^{\\,n+1}}{5\\,\\sigma^{2}\\,(\\mu^{n}-1)}.\n$$\n令 $n\\to\\infty$，\n$$\n\\lim_{n\\to\\infty}\\frac{(\\mu-1)\\,\\mu^{\\,n+1}}{\\mu^{n}-1}=(\\mu-1)\\,\\lim_{n\\to\\infty}\\frac{\\mu}{1-\\mu^{-n}}=(\\mu-1)\\,\\mu,\n$$\n所以\n$$\n\\lim_{n\\to\\infty}\\frac{V_{B}(n)}{V_{A}(n)}=1+\\operatorname{Var}(X_{0})\\cdot\\frac{(\\mu-1)\\,\\mu}{5\\,\\sigma^{2}}.\n$$\n\n代入 $\\mu=2$，$\\sigma^{2}=6$ 以及 $\\operatorname{Var}(X_{0})=\\operatorname{Var}(\\mathrm{Bin}(10,\\tfrac{1}{2}))=10\\cdot \\tfrac{1}{2}\\cdot \\tfrac{1}{2}=\\tfrac{5}{2}$，\n$$\n\\lim_{n\\to\\infty}\\frac{V_{B}(n)}{V_{A}(n)}=1+\\frac{5}{2}\\cdot\\frac{(2-1)\\cdot 2}{5\\cdot 6}=1+\\frac{5}{30}=1+\\frac{1}{6}=\\frac{7}{6}.\n$$", "answer": "$$\\boxed{\\frac{7}{6}}$$", "id": "1317889"}]}