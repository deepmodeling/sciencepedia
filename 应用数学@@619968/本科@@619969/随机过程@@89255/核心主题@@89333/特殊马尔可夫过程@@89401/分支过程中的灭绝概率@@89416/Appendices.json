{"hands_on_practices": [{"introduction": "让我们通过一个基础练习开始，这个练习将帮助你掌握计算灭绝概率的核心方法。在许多分支过程中，关键的第一步是建立并求解概率生成函数的不动点方程 $q = f(q)$。这个关于自复制恶意软件的假想场景 [@problem_id:1326397] 直接给出了后代的概率分布，让你能够专注于应用核心理论并求解最终的灭绝概率。", "problem": "一个网络安全分析团队正在研究一种新型的、高度复杂的自我复制恶意软件。他们在大型隔离网络中观察其行为。从单一受感染的机器（第0代）开始，任何给定机器上的恶意软件在被系统防御机制检测到并清除之前，只有一次传播机会。\n\n其传播遵循一种特定的概率模式：\n- 恶意软件有 $1/6$ 的概率无法造成任何新的感染，并被直接移除。\n- 恶意软件有 $1/2$ 的概率成功感染恰好一台新机器。\n- 恶意软件有 $1/3$ 的概率成功感染恰好两台新机器。\n\n每台新感染的机器都遵循相同的独立概率行为。从单一初始感染开始，这次恶意软件爆发最终将从网络中被完全根除（即活跃感染数量降至零）的长期概率是多少？\n\n请用分数或小数表示你的答案。", "solution": "将单台受感染机器产生的新感染数量建模为一个 Galton–Watson 分支过程的后代数量 $X$，其分布为\n$$\\Pr(X=0)=\\frac{1}{6},\\quad \\Pr(X=1)=\\frac{1}{2},\\quad \\Pr(X=2)=\\frac{1}{3},$$\n这些概率之和为 $1$。\n\n后代分布的生成函数为\n$$f(s)=\\sum_{k=0}^{\\infty}\\Pr(X=k)s^{k}=\\frac{1}{6}+\\frac{1}{2}s+\\frac{1}{3}s^{2}。$$\n对于从单个个体开始的 Galton–Watson 过程，其灭绝概率 $q$ 是方程 $q=f(q)$ 在 $[0,1]$ 区间内的最小解。\n因此，\n$$q=\\frac{1}{6}+\\frac{1}{2}q+\\frac{1}{3}q^{2}。$$\n两边同乘以 $6$ 以消去分母：\n$$6q=1+3q+2q^{2}。$$\n整理得到一个二次方程：\n$$2q^{2}-3q+1=0。$$\n因式分解：\n$$(2q-1)(q-1)=0,$$\n所以解为 $q=\\frac{1}{2}$ 和 $q=1$。\n\n为了选择正确的灭绝概率，我们计算平均后代数：\n$$m=f'(1)=\\frac{1}{2}+2\\cdot\\frac{1}{3}=\\frac{7}{6}>1。$$\n由于该过程是超临界的，灭绝概率是较小的那个根，因此\n$$q=\\frac{1}{2}。$$", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1326397"}, {"introduction": "在实际应用中，后代分布通常不是直接给出的，而是需要我们从物理或生物过程中建模得出。这个练习 [@problem_id:1326389] 模拟了一种细菌的繁殖过程，要求你首先将描述性的场景（每个“出芽点”独立成功）转化为一个明确的概率分布（二项分布）。这个练习能够训练你将现实世界问题转化为数学模型，然后应用分支过程理论进行求解的能力。", "problem": "一种被命名为*Progenitor biformis*的新嗜极细菌物种，因其独特的繁殖周期而正在被研究。单个*P. biformis*细菌在其细胞壁上恰好有两个潜在的“出芽点”。每个位点相互独立地有 $0.8$ 的概率成功发育为一个新的、有活力的后代。在这一次性繁殖事件之后，亲代细菌会死亡。\n\n假设一个生物培养群落由单个*P. biformis*细菌起始。由这个单个个体繁衍出的整个谱系最终会灭绝的长期概率是多少？将您的答案表示为四舍五入到三位有效数字的小数。", "solution": "将该谱系建模为一个Galton–Watson分支过程。每个细菌有两个独立的出芽点，每个成功出芽的概率为 $p=0.8=\\frac{4}{5}$。因此，单个亲代产生的后代数量 $X$ 服从参数为 $n=2$ 和 $p=\\frac{4}{5}$ 的二项分布：\n$$\n\\mathbb{P}(X=0)=\\left(\\frac{1}{5}\\right)^{2}=\\frac{1}{25},\\quad\n\\mathbb{P}(X=1)=2\\cdot\\frac{4}{5}\\cdot\\frac{1}{5}=\\frac{8}{25},\\quad\n\\mathbb{P}(X=2)=\\left(\\frac{4}{5}\\right)^{2}=\\frac{16}{25}.\n$$\n其概率生成函数为\n$$\nf(s)=\\frac{1}{25}+\\frac{8}{25}s+\\frac{16}{25}s^{2}.\n$$\n灭绝概率 $q$ 是方程 $q=f(q)$ 在 $[0,1]$ 区间内的最小解：\n$$\nq=\\frac{1}{25}+\\frac{8}{25}q+\\frac{16}{25}q^{2}.\n$$\n整理并乘以 $25$ 可得\n$$\n0=1+8q+16q^{2}-25q \\quad\\Longrightarrow\\quad 16q^{2}-17q+1=0.\n$$\n求解这个二次方程：\n$$\nq=\\frac{17\\pm\\sqrt{17^{2}-4\\cdot 16\\cdot 1}}{2\\cdot 16}\n=\\frac{17\\pm\\sqrt{289-64}}{32}\n=\\frac{17\\pm 15}{32}.\n$$\n因此 $q=\\frac{1}{16}$ 或 $q=1$。因为后代的平均数量为 $\\mathbb{E}[X]=2\\cdot\\frac{4}{5}=\\frac{8}{5}>1$，所以灭绝概率是较小的根：\n$$\nq=\\frac{1}{16}=0.0625.\n$$\n四舍五入到三位有效数字，结果仍为 $0.0625$。", "answer": "$$\\boxed{0.0625}$$", "id": "1326389"}, {"introduction": "这个更进一步的练习 [@problem_id:1326384] 旨在检验你对分支过程结构的深刻理解。并非所有过程都始于遵循标准繁殖规则的单个个体；初始代可能具有特殊的、甚至是确定性的行为。通过解决这个问题，你将学会如何处理初始条件的变异，并理解整个种群的灭绝是如何依赖于其后代各个独立子谱系的灭绝概率的。", "problem": "一种新型的自我复制纳米机器人正在被研究。该过程始于第零代的一个特殊设计的“祖先”机器人。根据设计，该祖先机器人保证会产生恰好两个“标准”后代，构成第一代。\n\n每个标准后代及其所有后续后代，都根据一个共同的随机法则独立地进行繁殖。任何一个标准机器人产生的后代数量具有一个概率生成函数 (PGF)，由 $G(s) = 0.4 + 0.6s^2$ 给出。\n\n假设该过程从一个祖先机器人开始，整个纳米机器人种群最终灭绝的概率是多少？请用精确分数表示你的答案。", "solution": "设 $G(s)$ 为一个标准纳米机器人的后代概率生成函数。给定 $G(s) = 0.4 + 0.6 s^{2}$，用精确分数重写为 $G(s) = \\frac{2}{5} + \\frac{3}{5} s^{2}$。对于从单个标准机器人开始的 Galton–Watson 过程，其灭绝概率 $q$ 是不动点方程 $q = G(q)$ 在 $[0,1]$ 区间内的最小解。平均后代数量为 $G'(1) = \\frac{6}{5} > 1$，因此存在一个非平凡的灭绝概率 $q \\in (0,1)$。\n\n求解不动点方程：\n$$\nq \\;=\\; \\frac{2}{5} + \\frac{3}{5} q^{2}\n\\;\\;\\Longleftrightarrow\\;\\;\n\\frac{3}{5} q^{2} - q + \\frac{2}{5} = 0\n\\;\\;\\Longleftrightarrow\\;\\;\n3 q^{2} - 5 q + 2 = 0.\n$$\n使用求根公式，\n$$\nq \\;=\\; \\frac{5 \\pm \\sqrt{25 - 24}}{6} \\;=\\; \\frac{5 \\pm 1}{6},\n$$\n所以 $q \\in \\left\\{1, \\frac{2}{3}\\right\\}$。在 $[0,1]$ 内的最小解为 $q = \\frac{2}{3}$。\n\n该过程始于一个特殊的祖先机器人，它确定性地产生恰好两个标准后代。整个过程会灭绝，当且仅当来自这两个标准后代的两个后代谱系都灭绝。根据两个谱系的独立性，\n$$\n\\mathbb{P}(\\text{祖先机器人后代灭绝}) \\;=\\; q^{2} \\;=\\; \\left(\\frac{2}{3}\\right)^{2} \\;=\\; \\frac{4}{9}.\n$$", "answer": "$$\\boxed{\\frac{4}{9}}$$", "id": "1326384"}]}