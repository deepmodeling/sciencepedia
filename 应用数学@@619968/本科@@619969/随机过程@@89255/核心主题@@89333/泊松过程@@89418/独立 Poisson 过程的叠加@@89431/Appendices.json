{"hands_on_practices": [{"introduction": "我们从一个基本但至关重要的问题开始，它揭示了独立泊松过程叠加的一个核心推论。当来自不同来源的事件流合并时，我们不仅关心总的事件发生率，还常常想知道在一定数量的总事件中，有多少来自特定的某个来源。这个问题 [@problem_id:1335982] 将引导你发现，在给定的 $k$ 个总事件中，源于特定来源的事件数量遵循一个二项分布，其“成功”概率仅取决于各个过程的速率之比。这个原理在通信、可靠性工程和许多其他领域中，对于区分和归因事件来源至关重要。", "problem": "一台高性能计算服务器的核心处理单元面临两种独立的瞬态硬件错误源。来自源 A 的错误构成一个泊松过程，其平均速率为每单位时间 $\\lambda_A$ 个错误。来自另一个过程，源 B 的错误，构成一个独立的泊松过程，其平均速率为每单位时间 $\\lambda_B$ 个错误。\n\n该服务器具有记录错误的容错机制。然而，为防止关键数据损坏，一旦来自源 A 和源 B 的累计错误总数达到一个预定义的整数阈值 $k$，系统就会触发紧急关机。\n\n假设系统在时间 $t=0$ 时处于完美状态，请确定在系统关机的确切时刻，恰好有 $n$ 个错误（其中 $n$ 是一个满足 $0 \\le n \\le k$ 的整数）来自源 A 的概率。请将您的答案表示为 $n, k, \\lambda_A$ 和 $\\lambda_B$ 的函数。", "solution": "设 $N_{A}(t)$ 和 $N_{B}(t)$ 是速率分别为 $\\lambda_{A}$ 和 $\\lambda_{B}$ 的独立泊松过程。它们的叠加过程 $N(t)=N_{A}(t)+N_{B}(t)$ 是一个速率为 $\\lambda=\\lambda_{A}+\\lambda_{B}$ 的泊松过程（独立泊松过程的叠加性质）。\n\n设 $T_{k}$ 表示复合过程 $N(t)$ 的第 $k$ 个事件发生的时间。系统在 $T_{k}$ 时刻关机。我们要求解 $\\mathbb{P}\\{N_{A}(T_{k})=n\\}$，其中 $n$ 为整数且 $0 \\leq n \\leq k$。\n\n考虑该复合过程的事件到达序列。在任何一次事件到达之前的时刻，到下一个 A 类错误发生的时间服从速率为 $\\lambda_{A}$ 的指数分布，到下一个 B 类错误发生的时间服从速率为 $\\lambda_{B}$ 的指数分布，二者相互独立且与过去无关（独立增量和无记忆性）。根据指数分布的竞争性质，下一个复合事件来自源 A 的概率等于\n$$\np=\\mathbb{P}\\{\\text{next arrival is from }A\\}=\\frac{\\lambda_{A}}{\\lambda_{A}+\\lambda_{B}}.\n$$\n无记忆性意味着，每次事件到达时，其来自源 A 的概率都是相同的 $p$，且与之前事件的来源标签无关。因此，前 $k$ 次事件的来源构成了一个成功概率为 $p$ 的独立伯努利试验序列。因此，在前 $k$ 个复合错误中，源于 A 的错误数量，即 $N_{A}(T_{k})$，服从二项分布：\n$$\n\\mathbb{P}\\{N_{A}(T_{k})=n\\}=\\binom{k}{n}p^{n}(1-p)^{k-n}, \\quad 0 \\leq n \\leq k.\n$$\n代入 $p=\\frac{\\lambda_{A}}{\\lambda_{A}+\\lambda_{B}}$ 和 $1-p=\\frac{\\lambda_{B}}{\\lambda_{A}+\\lambda_{B}}$ 可得\n$$\n\\mathbb{P}\\{N_{A}(T_{k})=n\\}=\\binom{k}{n}\\left(\\frac{\\lambda_{A}}{\\lambda_{A}+\\lambda_{B}}\\right)^{n}\\left(\\frac{\\lambda_{B}}{\\lambda_{A}+\\lambda_{B}}\\right)^{k-n}, \\quad 0 \\leq n \\leq k.\n$$\n该分布仅取决于速率，而与 $T_{k}$ 的实际值无关。", "answer": "$$\\boxed{\\binom{k}{n}\\left(\\frac{\\lambda_{A}}{\\lambda_{A}+\\lambda_{B}}\\right)^{n}\\left(\\frac{\\lambda_{B}}{\\lambda_{A}+\\lambda_{B}}\\right)^{k-n}}$$", "id": "1335982"}, {"introduction": "泊松过程的强大之处在于其普适性，它不仅能描述时间上的事件，也能完美地模拟空间中的点分布。这个练习将我们的视角从一维的时间轴扩展到二维的平面上，这是一个在材料科学、天文学和生态学中非常常见的应用场景。通过分析半导体晶圆上的缺陷分布 [@problem_id:1335979]，你将练习如何将叠加原理应用于空间泊松过程，并结合泊松过程的另一个基本性质——空概率（void probability）——来解决一个实际的识别问题。这个问题是理解空间随机性的一个绝佳实践。", "problem": "在一个先进的半导体制造工艺中，两种类型的微观点缺陷（分别标记为A型和B型）可能出现在硅晶圆的表面。这些缺陷的位置可以通过两个独立的均匀二维空间泊松点过程很好地建模。A型缺陷过程的强度为常数 $\\lambda_A$ 个缺陷/单位面积，B型缺陷过程的强度为 $\\lambda_B$ 个缺陷/单位面积。\n\n使用一台自动化光学检测工具来扫描晶圆并对这些缺陷进行分类。然而，该工具的分类算法基于其他缺陷的邻近度而有特定的限制。成功识别的规则如下：\n- 一个A型缺陷被成功识别，当且仅当在其位置的半径 $R_A$ 范围内没有其他A型缺陷，且半径 $R_B$ 范围内没有B型缺陷。\n- 一个B型缺陷被成功识别，当且仅当在其位置的半径 $R_C$ 范围内没有*任何*其他类型（A或B）的缺陷。\n\n考虑一个从非常大的晶圆上的所有缺陷总体中均匀随机选择出的缺陷。计算这个被选中的缺陷被检测工具成功识别的概率。你的答案应该是一个用给定参数 $\\lambda_A$、$\\lambda_B$、$R_A$、$R_B$ 和 $R_C$ 表示的符号表达式。", "solution": "设 $I$ 为一个随机选择的缺陷被成功识别的事件。问题要求计算概率 $P(I)$。一个随机选择的缺陷可以是A型或B型。设 $T_A$ 为所选缺陷是A型的事件， $T_B$ 为其是B型的事件。根据全概率公式，我们可以写出：\n$$P(I) = P(I | T_A) P(T_A) + P(I | T_B) P(T_B)$$\n\n首先，我们确定概率 $P(T_A)$ 和 $P(T_B)$。对于一个非常大的区域 $S$，A型缺陷的期望数量为 $N_A = \\lambda_A S$，B型缺陷的期望数量为 $N_B = \\lambda_B S$。缺陷的总期望数量为 $N_{total} = N_A + N_B = (\\lambda_A + \\lambda_B)S$。一个随机选择的缺陷为A型的概率是A型缺陷数量与总缺陷数量的比值，当区域非常大时，这个比值趋向于它们强度的比值。\n$$P(T_A) = \\frac{\\lambda_A S}{(\\lambda_A + \\lambda_B)S} = \\frac{\\lambda_A}{\\lambda_A + \\lambda_B}$$\n类似地，\n$$P(T_B) = \\frac{\\lambda_B S}{(\\lambda_A + \\lambda_B)S} = \\frac{\\lambda_B}{\\lambda_A + \\lambda_B}$$\n\n接下来，我们需要求条件概率 $P(I | T_A)$ 和 $P(I | T_B)$。这涉及到泊松点过程的性质。一个关键性质（通常与 Slivnyak 定理或 Palm 分布相关）是，以某位置存在一个过程点为条件，并不会改变过程中所有其他点的统计分布。\n\n让我们来计算 $P(I | T_A)$。这是A型缺陷可被识别的概率。让我们假设这个“典型”的A型缺陷位于原点。要使其被识别，必须满足两个条件：\n1.  在以原点为中心、半径为 $R_A$ 的圆盘内，没有*其他*A型缺陷。该圆盘的面积是 $\\pi R_A^2$。此区域内其他A型缺陷的数量遵循泊松分布，其均值为 $\\mu_{A_1} = \\lambda_A \\pi R_A^2$。该区域没有此类缺陷的概率是 $P_1 = \\exp(-\\mu_{A_1}) = \\exp(-\\lambda_A \\pi R_A^2)$。\n2.  在以原点为中心、半径为 $R_B$ 的圆盘内，没有B型缺陷。该区域的面积是 $\\pi R_B^2$。此区域内B型缺陷的数量遵循泊松分布，其均值为 $\\mu_{A_2} = \\lambda_B \\pi R_B^2$。该区域没有此类缺陷的概率是 $P_2 = \\exp(-\\mu_{A_2}) = \\exp(-\\lambda_B \\pi R_B^2)$。\n\n由于两个泊松过程（A型和B型缺陷的）是独立的，所以这两个圆盘为空的事件是独立的。因此，我们可以将它们的概率相乘：\n$$P(I | T_A) = P_1 \\times P_2 = \\exp(-\\lambda_A \\pi R_A^2) \\exp(-\\lambda_B \\pi R_B^2) = \\exp(-\\pi(\\lambda_A R_A^2 + \\lambda_B R_B^2))$$\n\n现在让我们来计算 $P(I | T_B)$。这是B型缺陷可被识别的概率。我们将这个典型的B型缺陷置于原点。要使其被识别，在半径 $R_C$ 范围内必须没有*任何*其他类型（A或B）的缺陷。\n根据独立泊松过程的叠加特性，所有缺陷（A型和B型）的组合过程本身也是一个泊松过程，其强度为 $\\lambda_{total} = \\lambda_A + \\lambda_B$。\n当我们以一个B型缺陷位于原点为条件时，所有*其他*缺陷（包括A型和B型）的分布仍然是一个强度为 $\\lambda_{total}$ 的泊松过程。\n我们需要以原点为中心、半径为 $R_C$ 的圆盘内没有这些其他缺陷。该圆盘的面积是 $\\pi R_C^2$。此区域内其他缺陷的数量遵循泊松分布，其均值为 $\\mu_B = \\lambda_{total} \\pi R_C^2 = (\\lambda_A + \\lambda_B) \\pi R_C^2$。\n该区域内没有缺陷的概率是：\n$$P(I | T_B) = \\exp(-\\mu_B) = \\exp(-(\\lambda_A + \\lambda_B) \\pi R_C^2)$$\n\n最后，我们将这些表达式代回全概率公式：\n$$P(I) = P(I | T_A) P(T_A) + P(I | T_B) P(T_B)$$\n$$P(I) = \\exp(-\\pi(\\lambda_A R_A^2 + \\lambda_B R_B^2)) \\left(\\frac{\\lambda_A}{\\lambda_A + \\lambda_B}\\right) + \\exp(-(\\lambda_A + \\lambda_B) \\pi R_C^2) \\left(\\frac{\\lambda_B}{\\lambda_A + \\lambda_B}\\right)$$\n将各项合并到一个公分母上，得到最终的概率表达式：\n$$P(I) = \\frac{\\lambda_A \\exp(-\\pi(\\lambda_A R_A^2 + \\lambda_B R_B^2)) + \\lambda_B \\exp(-\\pi(\\lambda_A + \\lambda_B) R_C^2)}{\\lambda_A + \\lambda_B}$$", "answer": "$$\\boxed{\\frac{\\lambda_A \\exp(-\\pi(\\lambda_A R_A^2 + \\lambda_B R_B^2)) + \\lambda_B \\exp(-\\pi(\\lambda_A + \\lambda_B) R_C^2)}{\\lambda_A + \\lambda_B}}$$", "id": "1335979"}, {"introduction": "在掌握了基本原理及其空间扩展后，我们来挑战一个更复杂的场景：当事件的观察或记录依赖于系统的当前状态时会发生什么？这个问题引入了一个带有“记忆”的传感器系统，其中一个事件能否被记录取决于上一个被记录的事件类型。你将会看到，尽管底层的粒子到达过程是无记忆的泊松过程，但观察到的过程却呈现出依赖性，其长期行为可以通过构建一个连续时间马尔可夫链来分析 [@problem_id:1335999]。这个练习巧妙地展示了如何将泊松过程作为驱动力，来研究更复杂的、具有状态依赖性的随机系统。", "problem": "一种特制的天体物理传感器被设计用来探测两种奇特粒子：A型和B型。A型粒子到达传感器遵循泊松过程，其恒定速率为每秒 $\\lambda_A$ 个粒子。独立地，B型粒子的到达遵循另一个泊松过程，其恒定速率为每秒 $\\lambda_B$ 个粒子。\n\n该传感器的数据记录系统具有一种特殊的条件记忆功能。它根据以下规则运行：\n1. 每一次探测到的A型粒子总是会被记录。\n2. 一次对B型粒子的探测会被记录，*当且仅当*紧接在其前被记录的粒子是A型。如果前一个被记录的粒子是B型，任何新探测到的B型粒子都将被忽略而不被记录，直到有一个A型粒子被记录为止。\n\n假设传感器已经运行了足够长的时间以达到稳态，求在时长为 $T$ 的时间间隔内，被记录的B型粒子的期望数量。你的答案应该是一个用 $\\lambda_A$、$\\lambda_B$ 和 $T$ 表示的符号表达式。", "solution": "令 $N_{A}(t)$ 和 $N_{B}(t)$ 为两个独立的泊松过程，其速率分别为 $\\lambda_{A}$ 和 $\\lambda_{B}$。定义记录状态过程 $S(t) \\in \\{A,B\\}$ 为在时刻 $t$ 最近被记录的粒子类型。因为每次A型粒子的探测都会被记录，而B型粒子的探测仅在之前记录的粒子为A型时才被记录，所以 $S(t)$ 的演化是一个由粒子的到达驱动的连续时间马尔可夫链：\n- 当 $S(t)=A$ 时，任何B型粒子的到达都会被记录，并将状态切换到 $B$。因此，转移速率 $A \\to B$ 为 $\\lambda_{B}$。\n- 当 $S(t)=B$ 时，B型粒子的到达被忽略，不改变状态；下一次A型粒子的到达会被记录，并将状态切换到 $A$。因此，转移速率 $B \\to A$ 为 $\\lambda_{A}$。\n\n因此，该二状态链的非对角转移速率为 $q_{A,B}=\\lambda_{B}$ 和 $q_{B,A}=\\lambda_{A}$。在稳态下，令 $\\pi_{A}$ 和 $\\pi_{B}$ 为平稳概率。它们满足全局平衡方程和归一化方程\n$$\n\\pi_{A}\\lambda_{B}=\\pi_{B}\\lambda_{A},\\qquad \\pi_{A}+\\pi_{B}=1.\n$$\n解得\n$$\n\\pi_{A}=\\frac{\\lambda_{A}}{\\lambda_{A}+\\lambda_{B}},\\qquad \\pi_{B}=\\frac{\\lambda_{B}}{\\lambda_{A}+\\lambda_{B}}.\n$$\n\n当 $S(t)=A$ 时，B型粒子的探测以瞬时速率 $\\lambda_{B}$ 被记录；当 $S(t)=B$ 时，记录速率为 $0$。因此，在稳态下，B型粒子的期望记录速率为\n$$\nr_{B}^{\\text{log}}=\\lambda_{B}\\pi_{A}=\\frac{\\lambda_{A}\\lambda_{B}}{\\lambda_{A}+\\lambda_{B}}.\n$$\n根据平稳性，在时长为 $T$ 的时间间隔内，被记录的B型粒子的期望数量为速率乘以 $T$：\n$$\n\\mathbb{E}\\big[N_{B}^{\\text{log}}(T)\\big]=r_{B}^{\\text{log}}\\,T=\\frac{\\lambda_{A}\\lambda_{B}}{\\lambda_{A}+\\lambda_{B}}\\,T.\n$$", "answer": "$$\\boxed{\\frac{\\lambda_{A}\\lambda_{B}}{\\lambda_{A}+\\lambda_{B}}\\,T}$$", "id": "1335999"}]}