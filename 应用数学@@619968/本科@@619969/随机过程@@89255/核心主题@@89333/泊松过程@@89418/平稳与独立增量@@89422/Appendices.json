{"hands_on_practices": [{"introduction": "泊松过程是模拟随时间随机发生的离散事件的基石。此练习探讨了其平稳且独立增量性质的一个重要推论。我们将看到，在给定总事件数的情况下，事件在不同子区间内的分布遵循一个二项分布，这突显了在条件概率的背景下，各个事件的发生时间是如何均匀分布的。[@problem_id:1333460] 这个练习不仅能加深你对泊松过程核心特性的理解，还能让你体会到在处理条件概率问题时，有时我们甚至不需要知道事件发生的具体速率 $\\lambda$。", "problem": "到达网络路由器的数据包被建模为一个泊松过程，记为 $\\{N(t), t \\ge 0\\}$，其恒定平均速率为每秒 $\\lambda$ 个数据包。路由器在时间 $t=0$ 开始运行。为了进行计划性维护，路由器在时间区间 $(t_1, t_2]$ 内被关闭，其中 $0 < t_1 < t_2$。一位观察者在从 $t=0$ 到 $t=t_3$ 的整个时间段内监控该路由器，其中 $t_3 > t_2$。在此整个期间，发现在路由器运行的时间内，总共有 $n$ 个数据包到达。\n\n根据此信息，在这 $n$ 个数据包中，恰好有 $k$ 个在维护关闭前（即在区间 $[0, t_1]$ 内）到达的概率是多少？\n\n请用符号参数 $n$、$k$、$t_1$、$t_2$ 和 $t_3$ 给出一个闭式解析表达式作为答案。", "solution": "设 $\\{N(t), t \\ge 0\\}$ 是一个速率为 $\\lambda$ 的齐次泊松过程。路由器在不相交的区间 $[0, t_{1}]$ 和 $(t_{2}, t_{3}]$ 上处于运行状态。定义随机变量\n$$\nX = N(t_{1}) - N(0), \\quad Y = N(t_{3}) - N(t_{2}),\n$$\n它们分别对在区间 $[0, t_{1}]$ 和 $(t_{2}, t_{3}]$ 期间到达的数据包进行计数。根据泊松过程的独立增量性质，$X$ 和 $Y$ 是独立的。根据增量的分布，\n$$\nX \\sim \\text{Poisson}(\\lambda t_{1}), \\quad Y \\sim \\text{Poisson}(\\lambda (t_{3} - t_{2})).\n$$\n观察者报告称，在路由器运行期间总共有 $n$ 个数据包到达，因此给定条件 $X + Y = n$。我们要求解 $P(X = k \\mid X + Y = n)$，其中 $k \\in \\{0, 1, \\ldots, n\\}$。\n\n使用条件概率的定义和独立性，我们有\n$$\nP(X = k \\mid X + Y = n) = \\frac{P(X = k, Y = n - k)}{P(X + Y = n)}.\n$$\n分子中的联合概率可分解为\n$$\nP(X = k, Y = n - k) = P(X = k)\\,P(Y = n - k) = \\exp(-\\lambda t_{1}) \\frac{(\\lambda t_{1})^{k}}{k!} \\cdot \\exp(-\\lambda (t_{3} - t_{2})) \\frac{(\\lambda (t_{3} - t_{2}))^{n - k}}{(n - k)!}.\n$$\n由于独立的泊松随机变量之和仍服从泊松分布，其参数为各自均值之和，因此分母为\n$$\nP(X + Y = n) = \\exp(-\\lambda (t_{1} + t_{3} - t_{2})) \\frac{(\\lambda (t_{1} + t_{3} - t_{2}))^{n}}{n!}.\n$$\n因此，\n$$\nP(X = k \\mid X + Y = n) = \\frac{\\exp(-\\lambda t_{1}) \\exp(-\\lambda (t_{3} - t_{2})) (\\lambda t_{1})^{k} (\\lambda (t_{3} - t_{2}))^{n - k} \\frac{n!}{k!(n-k)!}}{\\exp(-\\lambda (t_{1} + t_{3} - t_{2})) (\\lambda (t_{1} + t_{3} - t_{2}))^{n}}.\n$$\n消去指数项和 $\\lambda$ 的幂，得到二项分布形式\n$$\nP(X = k \\mid X + Y = n) = \\binom{n}{k} \\left(\\frac{t_{1}}{t_{1} + t_{3} - t_{2}}\\right)^{k} \\left(\\frac{t_{3} - t_{2}}{t_{1} + t_{3} - t_{2}}\\right)^{n - k}.\n$$\n这就是所求的概率，即在观测到的 $n$ 个数据包中，恰好有 $k$ 个在路由器关闭前到达。", "answer": "$$\\boxed{\\binom{n}{k}\\left(\\frac{t_{1}}{t_{1}+t_{3}-t_{2}}\\right)^{k}\\left(\\frac{t_{3}-t_{2}}{t_{1}+t_{3}-t_{2}}\\right)^{n-k}}$$", "id": "1333460"}, {"introduction": "维纳过程，或称布朗运动，是随机游走的连续时间对应物，为物理和金融领域的许多现象提供了强大的模型。本练习要求我们根据过程在未来某一时刻的位置，来推断其在过去某一时刻的分布。解决这个问题的关键在于利用维纳过程的独立增量性质来确定其在不同时刻的协方差结构，并应用多维正态分布的条件概率公式。[@problem_id:1333421] 通过这个计算，你将亲身体验如何量化一个连续随机过程的“路径记忆”，并为理解布朗桥等更高级的概念打下基础。", "problem": "一个纳米粒子被观察到沿一个轴进行一维随机运动，在时间 $t=0$ 时从原点出发。其在时间 $t$ 的位置，记为 $X(t)$，可以用一个标准维纳过程来建模。对于本问题而言，一个标准维纳过程 $W(t)$ 的关键性质如下：\n1. $W(0) = 0$。\n2. 对于任意 $t > 0$，随机变量 $W(t)$ 服从均值为 0、方差为 $t$ 的正态分布。\n3. 该过程具有独立增量，即对于任意两个不重叠的时间区间 $[t_1, t_2]$ 和 $[t_3, t_4]$，随机变量 $W(t_2) - W(t_1)$ 和 $W(t_4) - W(t_3)$ 是独立的。\n\n一位实验者在时间 $t=4$ 测量了粒子的位置，发现其为 $X(4) = 2$。在此观测条件下，该粒子在更早的时间 $t=1$ 时的位置为正（即 $X(1) > 0$）的概率是多少？\n\n将你的答案以小数形式报告，并四舍五入到三位有效数字。", "solution": "我们将位置过程建模为标准维纳过程 $W(t)$。考虑二元正态向量 $(W(1), W(4))$。根据维纳过程的性质：\n- $W(1) \\sim \\mathcal{N}(0,1)$ 且 $W(4) \\sim \\mathcal{N}(0,4)$，因为 $\\operatorname{Var}(W(t))=t$。\n- 利用独立增量，我们将 $W(4)$ 写为 $W(4)=W(1)+\\big(W(4)-W(1)\\big)$，其中 $W(4)-W(1)$ 与 $W(1)$ 独立。因此，\n$$\n\\operatorname{Cov}(W(1), W(4))=\\operatorname{Cov}\\big(W(1), W(1)\\big)+\\operatorname{Cov}\\big(W(1), W(4)-W(1)\\big)=\\operatorname{Var}(W(1)) + 0 = 1.\n$$\n所以，$(W(1), W(4))$ 是联合正态分布的，其协方差矩阵为\n$$\n\\Sigma=\\begin{pmatrix}\n1 & 1 \\\\\n1 & 4\n\\end{pmatrix}.\n$$\n\n对于联合正态变量，条件分布 $W(1)\\,|\\,W(4)=2$ 是正态分布，其均值和方差由下式给出\n$$\n\\mu_{1|4}=\\frac{\\operatorname{Cov}(W(1),W(4))}{\\operatorname{Var}(W(4))}\\cdot 2=\\frac{1}{4}\\cdot 2=\\frac{1}{2}, \\quad\n\\sigma_{1|4}^{2}=\\operatorname{Var}(W(1))-\\frac{\\operatorname{Cov}(W(1),W(4))^{2}}{\\operatorname{Var}(W(4))}=1-\\frac{1}{4}=\\frac{3}{4}.\n$$\n于是，\n$$\nW(1)\\,|\\,\\{W(4)=2\\} \\sim \\mathcal{N}\\!\\left(\\frac{1}{2}, \\frac{3}{4}\\right).\n$$\n\n我们要求解\n$$\n\\mathbb{P}\\big(W(1)>0 \\,\\big|\\, W(4)=2\\big)=\\mathbb{P}\\!\\left(\\mathcal{N}\\!\\left(\\frac{1}{2},\\frac{3}{4}\\right)>0\\right).\n$$\n使用 $Z\\sim \\mathcal{N}(0,1)$ 进行标准化，\n$$\n\\mathbb{P}\\!\\left(\\mathcal{N}\\!\\left(\\frac{1}{2},\\frac{3}{4}\\right)>0\\right)\n=1-\\Phi\\!\\left(\\frac{0-\\frac{1}{2}}{\\sqrt{\\frac{3}{4}}}\\right)\n=\\Phi\\!\\left(\\frac{\\frac{1}{2}}{\\sqrt{\\frac{3}{4}}}\\right)\n=\\Phi\\!\\left(\\frac{1}{\\sqrt{3}}\\right),\n$$\n其中 $\\Phi(a)=\\frac{1}{\\sqrt{2\\pi}}\\int_{-\\infty}^{a}\\exp\\!\\left(-\\frac{u^{2}}{2}\\right)\\,du$ 是标准正态累积分布函数。\n\n数值上，$\\frac{1}{\\sqrt{3}}\\approx 0.577350$，因此\n$$\n\\mathbb{P}\\big(W(1)>0 \\,\\big|\\, W(4)=2\\big)=\\Phi\\!\\left(\\frac{1}{\\sqrt{3}}\\right)\\approx 0.718 \\quad \\text{(保留三位有效数字)}.\n$$", "answer": "$$\\boxed{0.718}$$", "id": "1333421"}, {"introduction": "在随机过程理论中，一个强大的思想是通过组合基本过程来构建更复杂、更具描述性的新模型。这个练习介绍了一种称为“从属过程”的构建方法，其中一个维纳过程的时间变量本身就是另一个独立的随机过程——泊松过程。计算其增量的方差需要运用“全方差公式”这一重要工具，它允许我们通过对其中一个随机源进行条件化来分解和计算总体方差。[@problem_id:1333454] 这个富有挑战性的练习将融合你对维纳过程和泊松过程的知识，并向你展示随机建模中蕴含的创造性和构造性。", "problem": "考虑一个随机过程 $X(t)$，它由一个标准维纳过程和一个独立的泊松过程复合而成。设 $W(t)$（$t \\ge 0$）是一个标准一维维纳过程，满足 $W(0) = 0$，且对于任意 $0 \\le u < v$，增量 $W(v) - W(u)$ 服从均值为 0、方差为 $v-u$ 的正态分布。设 $N(t)$（$t \\ge 0$）是一个独立的泊松过程，其常数率为 $\\lambda > 0$，满足 $N(0)=0$。对于任意 $0 \\le u < v$，增量 $N(v) - N(u)$ 服从均值为 $\\lambda(v-u)$ 的泊松分布。过程 $W(t)$ 与过程 $N(t)$ 相互独立。\n\n一个新的“从属”过程 $X(t)$ 定义为 $X(t) = W(N(t))$。对于任意满足 $0 \\le s < t$ 的固定时间 $s$ 和 $t$，求增量 $X(t) - X(s)$ 的方差。\n\n请用 $\\lambda$、$s$ 和 $t$ 给出答案的闭式解析表达式。", "solution": "对于 $0 \\le s < t$，定义增量 $Y:=X(t)-X(s)=W(N(t))-W(N(s))$。以 $\\sigma$-代数 $\\mathcal{G}:=\\sigma(N(s),N(t))$ 为条件。根据 $W$ 的独立增量性以及 $W$ 和 $N$ 的独立性，在给定 $N(s)=n$ 和 $N(t)=\\ell$（因此 $\\ell \\ge n$）的条件下，该增量可以写为 $Y=W(\\ell)-W(n)$，其中 $W(\\ell)-W(n)\\sim \\mathcal{N}(0,\\ell-n)$。因此，\n$$\n\\mathbb{E}[Y \\mid \\mathcal{G}]=0, \\qquad \\operatorname{Var}(Y \\mid \\mathcal{G})=\\ell-n=N(t)-N(s).\n$$\n应用全方差公式：\n$$\n\\operatorname{Var}(Y)=\\mathbb{E}\\!\\left[\\operatorname{Var}(Y \\mid \\mathcal{G})\\right]+\\operatorname{Var}\\!\\left(\\mathbb{E}[Y \\mid \\mathcal{G}]\\right)=\\mathbb{E}[N(t)-N(s)]+0.\n$$\n利用泊松过程的增量性质，$N(t)-N(s)\\sim \\mathrm{Poisson}(\\lambda(t-s))$，因此 $\\mathbb{E}[N(t)-N(s)]=\\lambda(t-s)$。所以，\n$$\n\\operatorname{Var}(X(t)-X(s))=\\lambda(t-s).\n$$", "answer": "$$\\boxed{\\lambda (t-s)}$$", "id": "1333454"}]}