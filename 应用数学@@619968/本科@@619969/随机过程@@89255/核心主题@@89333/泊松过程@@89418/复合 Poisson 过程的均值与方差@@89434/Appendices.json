{"hands_on_practices": [{"introduction": "让我们从一个基因组学的场景开始。这个问题将基因突变的累积效应建模为一个复合泊松过程，其中每次突变事件影响的碱基对数量服从几何分布。这个练习是应用复合泊松过程均值和方差公式来处理离散跳跃的绝佳起点，将理论知识与具体的科学应用相结合。[@problem_id:1317642]", "problem": "在一个简化的基因组学模型中，自发突变会沿着一条DNA链发生，该过程服从一个泊松过程，其速率为常数 $\\lambda$ 个事件/单位时间。每个突变事件会影响一定数量的碱基对。单个突变所影响的碱基对数量，我们将其记为 $Y$，是一个随机变量。我们假设不同突变所影响的片段长度是独立同分布的。$Y$ 的分布是参数为 $p \\in (0, 1)$ 的几何分布，其概率质量函数为 $P(Y=k) = (1-p)^{k-1}p$，其中 $k = 1, 2, 3, \\dots$。\n\n设 $S(t)$ 为截至时间 $t$ 发生的所有突变所影响的总碱基对数量。求出该总数的均值 $\\mathbb{E}[S(t)]$ 和方差 $\\text{Var}(S(t))$。", "solution": "设 $N(t)$ 表示截至时间 $t$ 的突变事件数。根据假设，$N(t)$ 是一个速率为 $\\lambda$ 的泊松过程，因此 $N(t) \\sim \\text{Poisson}(\\lambda t)$。设 $\\{Y_{i}\\}_{i \\geq 1}$ 是 $Y$ 的独立同分布 (i.i.d.) 副本，且与 $N(t)$ 独立，其概率为 $P(Y=k)=(1-p)^{k-1}p$，其中 $k \\in \\{1,2,\\dots\\}$。截至时间 $t$ 受影响的总碱基对数量为\n$$\nS(t)=\\sum_{i=1}^{N(t)} Y_{i},\n$$\n按照约定，当 $N(t)=0$ 时，空和为零。这是一个复合泊松模型。\n\n首先计算 $Y$ 的矩。使用幂级数 $\\sum_{k=1}^{\\infty} k r^{k-1}=\\frac{1}{(1-r)^{2}}$（对于 $|r|<1$），并令 $r=1-p$，我们得到\n$$\n\\mathbb{E}[Y]=\\sum_{k=1}^{\\infty} k (1-p)^{k-1} p = p \\sum_{k=1}^{\\infty} k r^{k-1} = p \\cdot \\frac{1}{(1-r)^{2}}=\\frac{1}{p}.\n$$\n对于二阶矩，使用 $\\sum_{k=2}^{\\infty} k(k-1) r^{k-2}=\\frac{2}{(1-r)^{3}}$，因此 $\\sum_{k=2}^{\\infty} k(k-1) r^{k-1}=\\frac{2r}{(1-r)^{3}}$。所以\n$$\n\\mathbb{E}[Y(Y-1)]=\\sum_{k=2}^{\\infty} k(k-1) (1-p)^{\\,k-1} p = p \\cdot \\frac{2r}{(1-r)^{3}}=\\frac{2(1-p)}{p^{2}},\n$$\n于是\n$$\n\\mathbb{E}[Y^{2}]=\\mathbb{E}[Y(Y-1)]+\\mathbb{E}[Y]=\\frac{2(1-p)}{p^{2}}+\\frac{1}{p}=\\frac{2-p}{p^{2}},\n$$\n从而\n$$\n\\operatorname{Var}(Y)=\\mathbb{E}[Y^{2}]-(\\mathbb{E}[Y])^{2}=\\frac{2-p}{p^{2}}-\\frac{1}{p^{2}}=\\frac{1-p}{p^{2}}.\n$$\n\n对 $S(t)$ 使用全期望定律：\n$$\n\\mathbb{E}[S(t)]=\\mathbb{E}\\big[\\mathbb{E}[S(t)\\mid N(t)]\\big].\n$$\n给定 $N(t)=n$，$S(t)$ 是 $n$ 个独立同分布的 $Y_{i}$ 之和，所以 $\\mathbb{E}[S(t)\\mid N(t)=n]=n\\,\\mathbb{E}[Y]$。因此\n$$\n\\mathbb{E}[S(t)]=\\mathbb{E}[N(t)]\\,\\mathbb{E}[Y]=(\\lambda t)\\cdot \\frac{1}{p}=\\frac{\\lambda t}{p}.\n$$\n\n使用全方差定律：\n$$\n\\operatorname{Var}(S(t))=\\mathbb{E}\\big[\\operatorname{Var}(S(t)\\mid N(t))\\big]+\\operatorname{Var}\\big(\\mathbb{E}[S(t)\\mid N(t)]\\big).\n$$\n给定 $N(t)=n$，$\\operatorname{Var}(S(t)\\mid N(t)=n)=n\\,\\operatorname{Var}(Y)$。因此\n$$\n\\mathbb{E}\\big[\\operatorname{Var}(S(t)\\mid N(t))\\big]=\\mathbb{E}[N(t)]\\,\\operatorname{Var}(Y)=\\lambda t \\cdot \\frac{1-p}{p^{2}}.\n$$\n另外，\n$$\n\\operatorname{Var}\\big(\\mathbb{E}[S(t)\\mid N(t)]\\big)=\\operatorname{Var}\\big(N(t)\\,\\mathbb{E}[Y]\\big)=(\\mathbb{E}[Y])^{2}\\operatorname{Var}(N(t))=\\left(\\frac{1}{p}\\right)^{2}\\cdot \\lambda t=\\frac{\\lambda t}{p^{2}}.\n$$\n将两部分相加得到\n$$\n\\operatorname{Var}(S(t))=\\lambda t \\cdot \\frac{1-p}{p^{2}}+\\frac{\\lambda t}{p^{2}}=\\lambda t \\cdot \\frac{2-p}{p^{2}}.\n$$\n\n等价地，使用复合泊松恒等式 $\\operatorname{Var}(S(t))=\\lambda t\\,\\mathbb{E}[Y^{2}]$ 以及 $\\mathbb{E}[Y^{2}]=\\frac{2-p}{p^{2}}$ 可以得到相同的结果。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\lambda t}{p} & \\frac{\\lambda t\\left(2 - p\\right)}{p^{2}} \\end{pmatrix}}$$", "id": "1317642"}, {"introduction": "接下来，我们将注意力转向制造业背景，并探索连续的跳跃大小。这个问题模拟了光纤电缆中的缺陷，其中每段被丢弃的线缆长度是均匀分布的。通过解决这个问题，你将看到复合泊松过程的相同框架如何无缝地应用于连续结果，从而加深对其通用性的理解。[@problem_id:1317648]", "problem": "在一个光缆生产设施中，发现缺陷会沿着光缆的长度随机出现。这些缺陷的出现可以建模为一个泊松过程，其恒定速率为每公里 $\\lambda$ 个缺陷。每当检测到一个缺陷时，包含该缺陷的一段光缆就会被切除并丢弃。每段被丢弃光缆的长度是一个独立的随机变量，在区间 $[a, b]$ 上均匀分布，其中 $a$ 和 $b$ 是表示长度（单位为公里）的正常数。\n\n考虑一根新制造的总长度为 $L$ 公里的光缆。设 $S$ 为因缺陷而从这段光缆中丢弃的总长度。求总丢弃长度 $S$ 的期望值和方差。你的答案应用给定参数 $\\lambda, L, a$ 和 $b$ 表示。", "solution": "设 $N$ 表示在长度为 $L$ 的光缆上出现的缺陷数量。由于缺陷遵循恒定速率为每公里 $\\lambda$ 个缺陷的泊松过程，因此在长度 $L$ 上的缺陷数量 $N$ 服从参数为 $\\lambda L$ 的泊松分布，即 $N \\sim \\text{Poisson}(\\lambda L)$。每个缺陷导致丢弃一段独立的线段，其长度为 $X$，其中 $X \\sim \\text{Uniform}[a,b]$，且 $X$ 与 $N$ 和其他的 $X$ 相互独立。总丢弃长度是随机和 $S=\\sum_{i=1}^{N} X_{i}$。\n\n首先计算 $X$ 的一阶矩和二阶矩。对于 $X \\sim \\text{Uniform}[a,b]$，其在 $[a,b]$ 上的密度函数为 $f(x)=\\frac{1}{b-a}$，\n$$\n\\mathbb{E}[X]=\\int_{a}^{b} x \\frac{1}{b-a} \\, dx=\\frac{b^{2}-a^{2}}{2(b-a)}=\\frac{a+b}{2},\n$$\n$$\n\\mathbb{E}[X^{2}]=\\int_{a}^{b} x^{2} \\frac{1}{b-a} \\, dx=\\frac{b^{3}-a^{3}}{3(b-a)}=\\frac{a^{2}+ab+b^{2}}{3}.\n$$\n因此\n$$\n\\operatorname{Var}(X)=\\mathbb{E}[X^{2}]-(\\mathbb{E}[X])^{2}=\\frac{a^{2}+ab+b^{2}}{3}-\\left(\\frac{a+b}{2}\\right)^{2}=\\frac{(b-a)^{2}}{12}.\n$$\n\n以 $N=n$ 为条件。因为 $X_{i}$ 是独立同分布的，并且与 $N$ 独立，\n$$\n\\mathbb{E}[S \\mid N=n]=n\\,\\mathbb{E}[X]=n\\,\\frac{a+b}{2}, \\quad \\operatorname{Var}(S \\mid N=n)=n\\,\\operatorname{Var}(X)=n\\,\\frac{(b-a)^{2}}{12}.\n$$\n使用全期望定律和全方差定律，以及泊松随机变量具有 $\\mathbb{E}[N]=\\operatorname{Var}(N)=\\lambda L$ 的性质，\n$$\n\\mathbb{E}[S]=\\mathbb{E}[\\mathbb{E}[S \\mid N]]=\\mathbb{E}[N]\\,\\mathbb{E}[X]=\\lambda L \\cdot \\frac{a+b}{2},\n$$\n$$\n\\operatorname{Var}(S)=\\mathbb{E}[\\operatorname{Var}(S \\mid N)]+\\operatorname{Var}(\\mathbb{E}[S \\mid N])=\\mathbb{E}[N]\\operatorname{Var}(X)+\\operatorname{Var}(N)\\left(\\mathbb{E}[X]\\right)^{2}.\n$$\n将 $\\mathbb{E}[N]=\\operatorname{Var}(N)=\\lambda L$, $\\operatorname{Var}(X)=\\frac{(b-a)^{2}}{12}$ 和 $\\mathbb{E}[X]=\\frac{a+b}{2}$ 代入可得\n$$\n\\operatorname{Var}(S)=\\lambda L\\left(\\frac{(b-a)^{2}}{12}+\\left(\\frac{a+b}{2}\\right)^{2}\\right)=\\lambda L \\cdot \\frac{a^{2}+ab+b^{2}}{3}.\n$$\n因此，\n$$\n\\mathbb{E}[S]=\\lambda L \\cdot \\frac{a+b}{2}, \\quad \\operatorname{Var}(S)=\\lambda L \\cdot \\frac{a^{2}+ab+b^{2}}{3}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\lambda L \\frac{a+b}{2} & \\lambda L \\frac{a^{2}+ab+b^{2}}{3}\\end{pmatrix}}$$", "id": "1317648"}, {"introduction": "在掌握了均值和方差的计算之后，让我们来探究该过程更深层次的结构特性。最后一个练习要求你计算该过程在两个不同时间点 $t_1$ 和 $t_2$ 状态之间的相关性，这是理解其时间演化过程的关键概念。解决这个问题将揭示独立增量属性的强大意义，并得出一个不依赖于具体跳跃分布的、异常简洁优美的结论。[@problem_id:1290820]", "problem": "一家金融科技公司使用一个随机过程来为其一种高频交易算法产生的累计利润建模。到时间 $t$ 为止的总利润，记为 $X(t)$，由一个复合泊松过程描述。该过程定义为 $X(t) = \\sum_{i=1}^{N(t)} Y_i$，其中 $N(t)$ 是一个计算已执行交易数量的泊松过程，而 $Y_i$ 是每次单独交易的利润。\n\n交易次数 $N(t)$ 以每单位时间 $\\lambda > 0$ 次交易的恒定平均速率发生。利润 $\\{Y_i\\}_{i\\geq1}$ 是一个独立同分布 (i.i.d.) 的随机变量序列，它们也独立于过程 $N(t)$。每次交易的平均利润为 $\\mathbb{E}[Y_i] = \\mu_Y$，每次交易利润的方差为 $\\operatorname{Var}(Y_i) = \\sigma_Y^2$。为确保该过程不是平凡的，假设跳跃分布是非退化的，这意味着 $\\mathbb{E}[Y_i^2] > 0$。\n\n考虑两个时间点，$t_1$ 和 $t_2$，使得 $0 < t_1 < t_2$。你的任务是确定在时间 $t_1$ 的累计利润和在时间 $t_2$ 的累计利润之间的相关系数 $\\rho(X(t_1), X(t_2))$。\n\n请用 $t_1$ 和 $t_2$ 表示你的答案，给出一个单一的闭式解析表达式。", "solution": "设 $X(t)=\\sum_{i=1}^{N(t)}Y_{i}$ 是一个速率为 $\\lambda>0$ 的复合泊松过程，其中 $\\{Y_{i}\\}$ 是独立同分布的，独立于 $N(t)$，其期望为 $\\mathbb{E}[Y_{i}]=\\mu_{Y}$，方差为 $\\operatorname{Var}(Y_{i})=\\sigma_{Y}^{2}$。对于 $0<t_{1}<t_{2}$，我们计算 $\\rho\\!\\left(X(t_{1}),X(t_{2})\\right)$。\n\n首先，使用以 $N(t)$ 为条件的条件法以及全期望定律和全方差定律来计算 $X(t)$ 的均值和方差。给定 $N(t)=n$，我们有\n$$\n\\mathbb{E}[X(t)\\mid N(t)=n]=n\\mu_{Y},\\qquad \\operatorname{Var}(X(t)\\mid N(t)=n)=n\\sigma_{Y}^{2}.\n$$\n对 $N(t)$ 取期望，并利用泊松过程的性质 $\\mathbb{E}[N(t)]=\\lambda t$ 和 $\\operatorname{Var}(N(t))=\\lambda t$，\n$$\n\\mathbb{E}[X(t)]=\\mathbb{E}[\\mathbb{E}[X(t)\\mid N(t)]]=\\mu_{Y}\\mathbb{E}[N(t)]=\\lambda t\\,\\mu_{Y},\n$$\n$$\n\\operatorname{Var}(X(t))=\\mathbb{E}[\\operatorname{Var}(X(t)\\mid N(t))]+\\operatorname{Var}(\\mathbb{E}[X(t)\\mid N(t)])\n=\\sigma_{Y}^{2}\\mathbb{E}[N(t)]+\\mu_{Y}^{2}\\operatorname{Var}(N(t))=\\lambda t\\left(\\sigma_{Y}^{2}+\\mu_{Y}^{2}\\right).\n$$\n\n接着，利用复合泊松过程的独立增量性质：将 $X(t_{2})$ 写为 $X(t_{2})=X(t_{1})+\\left(X(t_{2})-X(t_{1})\\right)$，其中 $X(t_{2})-X(t_{1})$ 独立于 $X(t_{1})$，且与 $X(t_{2}-t_{1})$ 同分布。因此，\n$$\n\\operatorname{Cov}\\!\\left(X(t_{1}),X(t_{2})\\right)=\\operatorname{Cov}\\!\\left(X(t_{1}),X(t_{1})\\right)+\\operatorname{Cov}\\!\\left(X(t_{1}),X(t_{2})-X(t_{1})\\right)=\\operatorname{Var}\\!\\left(X(t_{1})\\right).\n$$\n利用上面的方差表达式，\n$$\n\\operatorname{Cov}\\!\\left(X(t_{1}),X(t_{2})\\right)=\\lambda t_{1}\\left(\\sigma_{Y}^{2}+\\mu_{Y}^{2}\\right).\n$$\n\n最后，相关系数为\n$$\n\\rho\\!\\left(X(t_{1}),X(t_{2})\\right)=\\frac{\\operatorname{Cov}\\!\\left(X(t_{1}),X(t_{2})\\right)}{\\sqrt{\\operatorname{Var}\\!\\left(X(t_{1})\\right)\\operatorname{Var}\\!\\left(X(t_{2})\\right)}}\n=\\frac{\\lambda t_{1}\\left(\\sigma_{Y}^{2}+\\mu_{Y}^{2}\\right)}{\\sqrt{\\lambda t_{1}\\left(\\sigma_{Y}^{2}+\\mu_{Y}^{2}\\right)\\cdot \\lambda t_{2}\\left(\\sigma_{Y}^{2}+\\mu_{Y}^{2}\\right)}}\n=\\sqrt{\\frac{t_{1}}{t_{2}}}.\n$$\n假设 $\\mathbb{E}[Y_{i}^{2}]>0$ 保证了方差为正，因此相关系数是良定义的。", "answer": "$$\\boxed{\\sqrt{\\frac{t_{1}}{t_{2}}}}$$", "id": "1290820"}]}