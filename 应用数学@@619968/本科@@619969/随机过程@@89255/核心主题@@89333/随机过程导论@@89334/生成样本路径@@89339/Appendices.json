{"hands_on_practices": [{"introduction": "随机游走是随机过程理论的基石，为布朗运动和扩散现象等更复杂的模型提供了基础。通过追踪一个质点在二维晶格上的轨迹，本练习旨在让你获得从一系列离散的随机步骤生成样本路径的实践经验。这个练习将强化你对向量加法和随机位移如何共同塑造过程轨迹的理解。[@problem_id:1304666]", "problem": "一个粒子在二维整数格点（记为 $\\mathbb{Z}^2$）上进行简单对称随机游走。游走从原点 $(0,0)$ 开始。在每个离散时间步，粒子从其当前位置 $(x,y)$ 移动到其四近邻之一：$(x, y+1)$、$(x, y-1)$、$(x+1, y)$ 或 $(x-1, y)$。\n\n每一步的方向由从集合 $\\{1, 2, 3, 4\\}$ 中生成的随机整数决定。该整数到位移向量的映射如下：\n- 1：沿y轴正方向（上）移动，对应位移 $(0, 1)$。\n- 2：沿x轴正方向（右）移动，对应位移 $(1, 0)$。\n- 3：沿y轴负方向（下）移动，对应位移 $(0, -1)$。\n- 4：沿x轴负方向（左）移动，对应位移 $(-1, 0)$。\n\n考虑一个由10步组成的特定样本路径，它对应于以下生成的整数序列：\n$\\{2, 1, 2, 4, 1, 3, 2, 1, 4, 2\\}$\n\n确定粒子在完成这10步后的最终坐标 $(x_f, y_f)$。", "solution": "设游走从 $(x_{0}, y_{0}) = (0, 0)$ 开始。在每一步 $k$，位移 $d_{k}$ 由 $s_{k} \\in \\{1,2,3,4\\}$ 通过以下映射确定\n$$\n1 \\mapsto (0,1),\\quad 2 \\mapsto (1,0),\\quad 3 \\mapsto (0,-1),\\quad 4 \\mapsto (-1,0).\n$$\n经过 $N=10$ 步后的最终坐标由位移的向量加法给出：\n$$\n(x_{f}, y_{f}) = (x_{0}, y_{0}) + \\sum_{k=1}^{10} d_{k}.\n$$\n等价地，计算每个基本方向上的移动次数。设 $n_{R}$、$n_{L}$、$n_{U}$、$n_{D}$ 分别表示向右、向左、向上和向下移动的次数。则\n$$\nx_{f} = x_{0} + n_{R} - n_{L}, \\qquad y_{f} = y_{0} + n_{U} - n_{D}.\n$$\n根据序列 $\\{2, 1, 2, 4, 1, 3, 2, 1, 4, 2\\}$，各方向的移动次数为\n$$\nn_{R} = 4 \\text{（对应数字2）}, \\quad n_{L} = 2 \\text{（对应数字4）}, \\quad n_{U} = 3 \\text{（对应数字1）}, \\quad n_{D} = 1 \\text{（对应数字3）}。\n$$\n代入并使用 $(x_{0}, y_{0})=(0,0)$，\n$$\nx_{f} = 0 + 4 - 2 = 2, \\qquad y_{f} = 0 + 3 - 1 = 2.\n$$\n因此，最终坐标为 $(2, 2)$。", "answer": "$$\\boxed{\\begin{pmatrix}2 & 2\\end{pmatrix}}$$", "id": "1304666"}, {"introduction": "与在无限空间中的自由移动不同，许多现实世界中的随机过程受到边界的限制。这个练习通过引入一个带有反射和吸收边界的随机游走模型，在一个有限的状态空间上进行模拟，从而扩展了基本随机游走的概念。通过模拟青蛙在睡莲叶上的跳跃，你将学会如何实现依赖于当前状态的转移规则，这是在物理学、金融学和生态学中为受限系统建模的一项关键技能。[@problem_id:1304675]", "problem": "一只青蛙在一组排成直线的五片荷叶上进行随机游走，这些荷叶被标记为 $1, 2, 3, 4, 5$。青蛙在时间步 $n$（其中 $n=0, 1, 2, \\dots$）的位置是一个离散时间随机过程，记为 $X_n$，其取值于状态空间 $S = \\{1, 2, 3, 4, 5\\}$。\n\n青蛙的移动遵循以下规则：\n- 青蛙从荷叶 2 开始，因此其初始位置为 $X_0 = 2$。\n- 在每个时间步 $n \\geq 1$，从区间 $[0,1]$ 上的均匀分布中抽取一个随机数 $u_n$。青蛙的下一个位置 $X_n$ 取决于其当前位置 $X_{n-1}$ 和 $u_n$ 的值。\n- 如果青蛙在内部荷叶上，即 $X_{n-1} = i \\in \\{2, 3, 4\\}$，当 $u_n < 0.5$ 时，它跳到荷叶 $i-1$；当 $u_n \\geq 0.5$ 时，它跳到荷叶 $i+1$。\n- 荷叶 1 是一个部分反射边界。如果青蛙在荷叶 1 上（$X_{n-1}=1$），尝试向左跳（由 $u_n < 0.5$ 触发）将使其停留在荷叶 1 上。向右跳（由 $u_n \\geq 0.5$ 触发）将使其移动到荷叶 2。\n- 荷叶 5 是一个吸收态。如果青蛙到达荷叶 5（$X_{n-1}=5$），它将在之后所有的时间步都停留在那里，即对所有未来的 $n$ 都有 $X_n = 5$。\n\n现进行一次特定的实验，为前八个时间步生成了以下随机数序列：\n$u_1=0.63, u_2=0.24, u_3=0.78, u_4=0.91, u_5=0.04, u_6=0.55, u_7=0.31, u_8=0.82$。\n\n使用这个随机数序列，确定青蛙在时间步 $n=8$ 时的位置。你的答案应该是荷叶的整数编号。", "solution": "我们将青蛙的运动建模为状态空间 $S=\\{1,2,3,4,5\\}$ 上的一个离散时间马尔可夫过程，其转移规则如下。对于时间 $n-1$ 时的内部状态 $i\\in\\{2,3,4\\}$，下一个状态为\n$$\nX_{n}=\\begin{cases}\ni-1, & \\text{if } u_{n}<0.5,\\\\\ni+1, & \\text{if } u_{n}\\geq 0.5.\n\\end{cases}\n$$\n对于边界状态 $1$，\n$$\nX_{n}=\\begin{cases}\n1, & \\text{if } u_{n}<0.5,\\\\\n2, & \\text{if } u_{n}\\geq 0.5,\n\\end{cases}\n$$\n并且状态 $5$ 是吸收态，因此如果 $X_{n-1}=5$，则 $X_{n}=5$。\n\n从 $X_{0}=2$ 开始，并使用给定的序列 $u_{1}=0.63, u_{2}=0.24, u_{3}=0.78, u_{4}=0.91, u_{5}=0.04, u_{6}=0.55, u_{7}=0.31, u_{8}=0.82$，我们在每一步应用规则：\n\n1. 在 $n=1$ 时，$X_{0}=2$ 是内部状态，且 $u_{1}=0.63\\geq 0.5$，所以 $X_{1}=3$。\n2. 在 $n=2$ 时，$X_{1}=3$ 是内部状态，且 $u_{2}=0.24<0.5$，所以 $X_{2}=2$。\n3. 在 $n=3$ 时，$X_{2}=2$ 是内部状态，且 $u_{3}=0.78\\geq 0.5$，所以 $X_{3}=3$。\n4. 在 $n=4$ 时，$X_{3}=3$ 是内部状态，且 $u_{4}=0.91\\geq 0.5$，所以 $X_{4}=4$。\n5. 在 $n=5$ 时，$X_{4}=4$ 是内部状态，且 $u_{5}=0.04<0.5$，所以 $X_{5}=3$。\n6. 在 $n=6$ 时，$X_{5}=3$ 是内部状态，且 $u_{6}=0.55\\geq 0.5$，所以 $X_{6}=4$。\n7. 在 $n=7$ 时，$X_{6}=4$ 是内部状态，且 $u_{7}=0.31<0.5$，所以 $X_{7}=3$。\n8. 在 $n=8$ 时，$X_{7}=3$ 是内部状态，且 $u_{8}=0.82\\geq 0.5$，所以 $X_{8}=4$。\n\n在这些步骤中从未到达状态 $5$，因此没有触发吸收边界。因此，青蛙在时间步 $n=8$ 时的位置是 $4$。", "answer": "$$\\boxed{4}$$", "id": "1304675"}, {"introduction": "随机过程是模拟复杂动态系统的强大工具，尤其是在种群生态学等领域。本练习将带你从抽象的随机游走转向一个具体的应用：带有外来移入的Galton-Watson分支过程。通过计算一个细胞种群在几代中的规模，你将亲身体验如何结合多种随机性来源（个体繁殖和外部移入）来生成系统演化的样本路径，从而揭示这些理论模型在生物学研究中的实际应用价值。[@problem_id:1304687]", "problem": "考虑一个以离散代际演化的特化细胞群体的随机模型。第 $n$ 代的群体大小 $X_n$ 由一个带有迁入成分的 Galton-Watson 分支过程描述。群体从一代到下一代的演化由以下递归公式给出：\n$$X_{n+1} = \\left( \\sum_{i=1}^{X_n} Z_{n,i} \\right) + Y_{n+1} \\quad \\text{for } n \\ge 0$$\n其中，$X_n$ 是第 $n$ 代的群体大小，$Z_{n,i}$ 是第 $n$ 代第 $i$ 个个体产生的后代数量，$Y_{n+1}$ 是在第 $n+1$ 代开始时加入群体的新迁入细胞数量。\n\n任何单个细胞产生的后代数量 $Z$ 是一个独立同分布的随机变量，其概率质量函数为：$P(Z=0) = 0.5$，$P(Z=1) = 0.3$，以及 $P(Z=2) = 0.2$。$Z$ 的所有其他取值的概率均为零。在每一代开始时到达的新迁入数量 $Y$ 是一个独立的随机变量，服从均值率参数为 $\\lambda = 2.1$ 的泊松分布。\n\n该过程的初始群体大小为 $X_0 = 3$ 个细胞。\n\n为了分析该过程的一个特定实现，我们提供了随机变量的预定结果。每个细胞产生的后代数量（首先按代数排序，然后在每一代内按细胞的任意索引排序）由以下序列给出：\n$O = \\{1, 2, 0, 1, 1, 0, 2, 0, 1, 0, 2, 1, 1, 0, 1, ...\\}$。\n分别在第1、2、3代开始时到达的迁入数量由以下序列给出：\n$I = \\{2, 3, 1\\}$。\n\n必须按所提供的顺序使用这些序列中的值来确定群体轨迹。计算前三代 $X_1$、$X_2$ 和 $X_3$ 的群体大小。将这三个整数值作为一个序列给出答案。", "solution": "我们使用带有迁入的 Galton-Watson 过程：\n$$X_{n+1}=\\left(\\sum_{i=1}^{X_{n}} Z_{n,i}\\right)+Y_{n+1},\\quad n\\geq 0,$$\n初始条件为 $X_{0}=3$。特定的样本路径通过逐代地按顺序使用后代序列 $O$ 和迁入序列 $I$ 来确定。\n\n从第0代到第1代：我们需要 $X_{0}=3$ 个后代值，即序列 $O$ 的前三项：$1,2,0$。第1代的迁入量为 $Y_{1}=2$（序列 $I$ 的第一项）。因此\n$$X_{1}=(1+2+0)+2=5.$$\n\n从第1代到第2代：我们需要 $X_{1}=5$ 个后代值，即序列 $O$ 的接下来五项：$1,1,0,2,0$。第2代的迁入量为 $Y_{2}=3$（序列 $I$ 的第二项）。因此\n$$X_{2}=(1+1+0+2+0)+3=4+3=7.$$\n\n从第2代到第3代：我们需要 $X_{2}=7$ 个后代值，即序列 $O$ 的接下来七项：$1,0,2,1,1,0,1$。第3代的迁入量为 $Y_{3}=1$（序列 $I$ 的第三项）。因此\n$$X_{3}=(1+0+2+1+1+0+1)+1=6+1=7.$$\n\n因此，前三代分别为 $X_{1}=5$，$X_{2}=7$ 和 $X_{3}=7$。", "answer": "$$\\boxed{\\begin{pmatrix}5 & 7 & 7\\end{pmatrix}}$$", "id": "1304687"}]}