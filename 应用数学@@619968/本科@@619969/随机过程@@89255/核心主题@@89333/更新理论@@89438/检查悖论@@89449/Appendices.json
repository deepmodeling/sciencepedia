{"hands_on_practices": [{"introduction": "我们从检查悖论最经典的例证开始：等公交车。这个场景 [@problem_id:1293652] 使用泊松过程来模拟公交车的到达，这是对随机事件建模的常用工具。你的任务是计算期望的等待时间，结果可能会让你感到惊讶，它直接揭示了悖论的核心以及指数分布无记忆性的奇特之处。", "problem": "一个城市的公共交通管理部门正在测试一种新的动态调度系统，该系统根据实时客流数据从车站调度公交车，而不是遵循固定的时间表。经过长期的观察，市中心某个公交站的公交车到达情况可以被精确地建模为泊松过程。该站点的平均到达率为每小时6班车。\n\n一名通勤者不知道这个新系统，在某个随机时刻到达该站点。这位通勤者的期望等待时间是多少？\n\n请用分钟表示你的最终答案。", "solution": "设公交车到站的过程可以由一个速率参数为 $\\lambda$ 的泊松过程来描述。题目说明，平均到达率为每小时6班车。\n\n首先，我们将速率 $\\lambda$ 转换为与期望答案格式（分钟）一致的单位。\n$$\n\\lambda = \\frac{6 \\text{ buses}}{1 \\text{ hour}} = \\frac{6 \\text{ buses}}{60 \\text{ minutes}} = \\frac{1}{10} \\text{ buses per minute}\n$$\n\n泊松过程的一个决定性特征是，连续事件之间的时间间隔是服从相同速率参数 $\\lambda$ 的指数分布的独立同分布（i.i.d.）随机变量。设 $T$ 表示两辆连续公交车到达之间的时间。$T$ 的概率密度函数（PDF）由下式给出：\n$$\nf_T(t) = \\lambda \\exp(-\\lambda t), \\quad \\text{for } t \\ge 0\n$$\n这个指数分布的期望值，即公交车到达的平均间隔时间，为：\n$$\nE[T] = \\frac{1}{\\lambda}\n$$\n代入我们的 $\\lambda$ 值：\n$$\nE[T] = \\frac{1}{1/10 \\text{ min}^{-1}} = 10 \\text{ minutes}\n$$\n\n问题要求的是一个在随机时间到达的通勤者的期望等待时间。我们称这个等待时间为 $W$。指数分布（因此也是泊松过程的到达间隔时间）的一个关键性质是无记忆性。该性质指出，需要再等待一段时间的概率与已经等待了多长时间无关。形式上，对于一个服从指数分布的随机变量 $T$，$t$ 和 $s$ 为任意非负数，该性质表示为 $P(T > t + s | T > s) = P(T > t)$。\n\n当通勤者在随机时间到达时，他们是在某个到达间隔内到达。假设上一班车在时间 $t_{last}$ 到达，下一班车将在时间 $t_{next}$ 到达。通勤者在时间 $t_{arrival}$ 到达，其中 $t_{last} < t_{arrival} < t_{next}$。由于无记忆性，自上一班车以来已经过去的时间 $t_{arrival} - t_{last}$ 不影响剩余的等待时间 $W = t_{next} - t_{arrival}$。\n\n因此，剩余等待时间 $W$ 的分布与原始的到达间隔时间 $T$ 的分布相同。所以，它们的期望值也相同。\n$$\nE[W] = E[T]\n$$\n由此得出结论，通勤者的期望等待时间等于公交车之间的平均间隔时间。\n$$\nE[W] = 10 \\text{ minutes}\n$$\n这个结果通常被称为“等待时间悖论”或“检查悖论”。虽然人们可能会直觉地猜测答案是平均间隔的一半（5分钟），但事实上，随机到达更有可能发生在比平均间隔更长的时间段内，这一事实使结果产生了偏差。对于泊松过程的特定情况，这种效应正好抵消了“在时间间隔内取平均”的直觉，使得期望等待时间等于完整的平均到达间隔时间。", "answer": "$$\\boxed{10}$$", "id": "1293652"}, {"introduction": "检查悖论仅仅是泊松过程的一个怪癖吗？接下来的这个练习 [@problem_id:832996] 将证明答案是否定的。通过考虑一个非指数到达间隔时间的公交车时刻表，我们不能再依赖于无记忆性，这个练习迫使我们直面其根本机制：你更有可能在一个比平均更长的时间间隔内到达，这个概念被称为长度偏差采样。", "problem": "考虑一个公交车服务，其中连续两班公交车到达之间的时间间隔（称为到达间隔时间）是独立同分布的随机变量。这些到达间隔时间记为 $X$，服从一个离散分布。具体来说，一个到达间隔时间可以取两个确定性值 $T_1$ 或 $T_2$ 中的一个，两者概率相等：\n$$\nP(X = T_1) = \\frac{1}{2}, \\quad P(X = T_2) = \\frac{1}{2}\n$$\n其中 $T_1 > 0$ 和 $T_2 > 0$ 是不同的时间长度（$T_1 \\neq T_2$）。这描述了一个关于公交车到达的更新过程。\n\n一个观察者在随机时间 $t$ 到达公交车站，假设时间 $t$ 非常大（$t \\to \\infty$），这意味着系统处于稳态。观察者的到达时间与公交车的到达时刻表无关。这个场景是“检查悖论”的一个经典例子，即观察者更有可能在一个比平均时间更长的间隔内到达。\n\n从观察者的角度，推导下一班公交车的期望等待时间。用 $T_1$ 和 $T_2$ 将你的答案表示为一个闭式解析表达式。", "solution": "1. 平均到达间隔时间为\n$$\nE[X]=\\tfrac12T_1+\\tfrac12T_2=\\frac{T_1+T_2}{2}\\,.\n$$\n2. 二阶矩为\n$$\nE[X^2]=\\tfrac12T_1^2+\\tfrac12T_2^2=\\frac{T_1^2+T_2^2}{2}\\,.\n$$\n3. 在更新理论中，稳态下的平均剩余（等待）时间为\n$$\nE[R]=\\frac{E[X^2]}{2E[X]}\\,.\n$$\n4. 代入各阶矩可得\n$$\nE[R]\n=\\frac{\\frac{T_1^2+T_2^2}{2}}{2\\cdot\\frac{T_1+T_2}{2}}\n=\\frac{T_1^2+T_2^2}{2\\,(T_1+T_2)}\\,.\n$$", "answer": "$$\\boxed{\\frac{T_1^2+T_2^2}{2\\,(T_1+T_2)}}$$", "id": "832996"}, {"introduction": "在探讨了期望等待时间之后，我们现在回到泊松过程，更深入地分析观测到的时间间隔 [@problem_id:1339061]。这个问题不再仅仅关注均值，而是要求计算你碰巧检查到的那个时间间隔的长度的方差。解决这个问题需要将观测到的间隔看作两个部分的和——从上一个事件到观测点的时间，以及从观测点到下一个事件的时间——并揭示其统计特性与典型间隔有何不同。", "problem": "一位物理学家正在使用一种专门的粒子探测器研究高能宇宙射线。宇宙射线事件到达探测器的时间可以很好地用泊松过程来建模。任意两次连续探测之间的时间间隔的长期平均值被测量为一个恒定值 $\\tau$。\n\n为了进行抽查，该物理学家随机选取一个时间点，记为 $t_{obs}$，并测量包含 $t_{obs}$ 的那个特定时间间隔的长度。这个间隔是指 $t_{obs}$ 之前的最后一次探测与 $t_{obs}$ 之后的第一次探测之间的时间间隔。设表示该观测间隔长度的随机变量为 $L$。\n\n假设在进行观测之前系统已经运行了很长时间，求观测间隔长度的方差 $\\text{Var}(L)$。请用包含 $\\tau$ 的闭式解析表达式表示您的答案。", "solution": "设泊松过程的率为 $\\lambda$，因此到达间隔时间是均值为 $1/\\lambda$ 的独立同分布的指数随机变量。题目指出，长期平均到达间隔时间为 $\\tau$，因此\n$$\n\\lambda=\\frac{1}{\\tau}.\n$$\n\n根据平稳性（系统已运行很长时间），不失一般性地，我们可以将观测时间设为 $t_{obs}=0$。设 $S$ 表示后向重现时间（自 $0$ 时刻前的最后一次探测以来的时间），$T$ 表示前向重现时间（到 $0$ 时刻后的下一次探测为止的时间）。观测到的间隔长度为\n$$\nL=S+T.\n$$\n\n对于泊松过程，不相交的增量是独立的。因此，在 $(-s,0]$ 和 $(0,t]$ 内的事件是独立的。对于 $s,t \\geq 0$，\n$$\n\\mathbb{P}(S>s,\\,T>t)=\\mathbb{P}(\\text{no events in }(-s,0])\\,\\mathbb{P}(\\text{no events in }(0,t])=\\exp(-\\lambda s)\\exp(-\\lambda t)=\\exp(-\\lambda(s+t)).\n$$\n由此可得，边缘分布为\n$$\n\\mathbb{P}(S>s)=\\exp(-\\lambda s),\\qquad \\mathbb{P}(T>t)=\\exp(-\\lambda t),\n$$\n因此 $S$ 和 $T$ 是独立的，并且都服从率为 $\\lambda$ 的指数分布。\n\n因此，$L=S+T$ 是两个独立的 $\\operatorname{Exp}(\\lambda)$ 随机变量之和，即 $L$ 服从形状参数为 $2$、率为 $\\lambda$ 的伽马（爱尔朗）分布。利用独立性，\n$$\n\\operatorname{Var}(L)=\\operatorname{Var}(S)+\\operatorname{Var}(T)=\\frac{1}{\\lambda^{2}}+\\frac{1}{\\lambda^{2}}=\\frac{2}{\\lambda^{2}}.\n$$\n代入 $\\lambda=1/\\tau$ 可得\n$$\n\\operatorname{Var}(L)=2\\tau^{2}.\n$$", "answer": "$$\\boxed{2\\tau^{2}}$$", "id": "1339061"}]}