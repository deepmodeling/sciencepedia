{"hands_on_practices": [{"introduction": "在许多现实世界的系统中，状态会随着时间的推移而交替变化。关键更新定理的一个直接且强大的推论——更新回报定理，为我们计算系统在长期内处于某一特定状态的时间比例提供了基本工具。这个练习以一个生动有趣的冰球比赛场景为例，让你亲手实践如何应用这个核心概念。通过解决这个问题，你将掌握计算“每个周期内的期望回报”与“期望周期长度”之比的关键方法，从而深入理解系统长期行为的本质。", "problem": "在一场职业冰球比赛中，“随机前锋”队会经历强力进攻（因对方球队受罚而导致的人数优势时段）。连续两次强力进攻开始之间的时间间隔（以分钟为单位）是独立同分布的随机变量。这些间隔服从区间 $[a, b]$ 上的连续均匀分布。每次强力进攻一旦开始，将持续固定的 $d$ 分钟。“人数优势”状态会持续这段时间，即使在此期间又开始了另一次强力进攻。假设比赛时间足够长。\n\n给定参数 $a = 1$ 分钟，$b = 5$ 分钟，以及 $d = 2$ 分钟，确定在长期来看，“前锋”队拥有人数优势（即，处于至少一次强力进攻中）的时间占总比赛时间的比例。", "solution": "设 $\\{T_{n}\\}$ 为强力进攻开始的更新时刻，其到达间隔时间 $X_{n}=T_{n+1}-T_{n}$ 是独立同分布的，且服从 $[a,b]$ 上的均匀分布。球队在时刻 $t$ 拥有人数优势，当且仅当年龄（自最近一次更新以来的时间）$A(t)$ 满足 $A(t)\\leq d$，这等价于说当前周期被覆盖了 $\\min(d,X_{n})$ 的时间。\n\n根据更新回报定理，拥有人数优势的长期时间比例等于每个周期的期望回报除以期望周期长度：\n$$\np=\\frac{\\mathbb{E}[\\min(d,X)]}{\\mathbb{E}[X]}.\n$$\n对于 $X\\sim \\text{Uniform}[a,b]$，其在 $[a,b]$ 上的密度函数为 $f_{X}(x)=\\frac{1}{b-a}$，并且在本问题中给定 $a<d<b$，我们计算\n$$\n\\mathbb{E}[\\min(d,X)]=\\int_{a}^{b}\\min(d,x)\\,\\frac{1}{b-a}\\,dx=\\frac{1}{b-a}\\left(\\int_{a}^{d}x\\,dx+\\int_{d}^{b}d\\,dx\\right).\n$$\n当 $a=1$，$b=5$，$d=2$ 时，\n$$\n\\mathbb{E}[\\min(d,X)]=\\frac{1}{4}\\left(\\int_{1}^{2}x\\,dx+\\int_{2}^{5}2\\,dx\\right)=\\frac{1}{4}\\left(\\left.\\frac{x^{2}}{2}\\right|_{1}^{2}+2(5-2)\\right)=\\frac{1}{4}\\left(\\frac{3}{2}+6\\right)=\\frac{15}{8}.\n$$\n此外，\n$$\n\\mathbb{E}[X]=\\frac{a+b}{2}=\\frac{1+5}{2}=3.\n$$\n因此，\n$$\np=\\frac{\\frac{15}{8}}{3}=\\frac{15}{24}=\\frac{5}{8}.\n$$\n这就是球队拥有人数优势的长期时间比例。", "answer": "$$\\boxed{\\frac{5}{8}}$$", "id": "1339899"}, {"introduction": "更新理论不仅能告诉我们一个事件发生的频率，还能更深入地刻画系统在达到稳态后的精细特征。这个练习引导我们探索一个核心的稳态属性：“过程的年龄”，即当前组件已经运行了多长时间。通过分析服务器部件更换的场景，你将接触到“检查悖论”这一反直觉但至关重要的概念，并推导出年龄的极限分布。这个结果是关键更新定理的直接体现，对于理解和预测长期系统状态至关重要。", "problem": "一个数据中心维护着一台关键服务器，其配备了一种易于发生故障的特定类型处理单元。任何给定单元的故障前时间（以离散时间步（小时）为单位度量）是一个随机变量。当一个单元发生故障时，它会立即被一个相同的新单元替换。\n\n设连续单元的寿命 $\\{X_i\\}_{i=1}^{\\infty}$ 是独立同分布 (i.i.d.) 的正整数值随机变量。其共同的概率质量函数 (PMF) 由 $p(j) = P(X_1 = j)$ 给出，其中 $j \\in \\{1, 2, 3, \\dots\\}$。一个单元的平均寿命是 $\\mu = E[X_1]$，并假设其为有限值。该更新过程被认为是非周期的。\n\n在任意给定的整数时间 $t > 0$，一位工程师检查该服务器。当前安装单元的“年龄”，记为 $A_t$，是它已经运行的小时数。假设系统已经运行了很长时间并达到了稳态，确定单元年龄恰好为 $k$ 的极限概率，其中 $k$ 是一个非负整数。\n\n用 $\\mu$ 和概率质量函数 $p(j)$ 表示 $\\lim_{t \\to \\infty} P(A_t = k)$ 的答案。", "solution": "设 $S_{n}=\\sum_{i=1}^{n} X_{i}$ (其中 $S_{0}=0$) 为更新（故障/替换）时刻，并设 $N(t)=\\max\\{n: S_{n}\\le t\\}$ 为到时间 $t$ 为止的更新次数。在时间 $t$ 的年龄是 $A_{t}=t-S_{N(t)}$，其取值范围为 $\\{0,1,2,\\dots\\}$。\n\n假设该过程已达到平稳性且是非周期的，在很长的时间 $t$ 进行的检查会以长度偏倚分布抽样一个周期（单元寿命）。具体来说，如果 $J$ 表示包含检查时间的那个周期的单元寿命，那么根据更新理论中标准的长度偏倚论证，\n$$\nP(J=j)=\\frac{j\\,p(j)}{\\mu}, \\quad j\\in\\{1,2,3,\\dots\\}.\n$$\n在给定 $J=j$ 的条件下，检查时间在周期内的位置均匀分布在 $j$ 个整数位置 $\\{0,1,\\dots,j-1\\}$ 上，因此\n$$\nP(A_{t}=k\\mid J=j)=\\frac{1}{j} \\quad \\text{for } 0\\le k\\le j-1, \\quad \\text{and } 0 \\text{ otherwise}.\n$$\n因此，让 $t\\to\\infty$ 并使用全概率定律，\n$$\n\\lim_{t\\to\\infty} P(A_{t}=k)=\\sum_{j=k+1}^{\\infty} P(J=j)\\,P(A_{t}=k\\mid J=j)\n=\\sum_{j=k+1}^{\\infty} \\frac{j\\,p(j)}{\\mu}\\cdot \\frac{1}{j}\n=\\frac{1}{\\mu}\\sum_{j=k+1}^{\\infty} p(j),\n$$\n对于每个 $k\\in\\{0,1,2,\\dots\\}$。这等于 $\\frac{1}{\\mu}P(X_{1}\\ge k+1)$，并且可以验证这是一个真分布，因为\n$$\n\\sum_{k=0}^{\\infty} \\frac{1}{\\mu}\\sum_{j=k+1}^{\\infty} p(j)\n=\\frac{1}{\\mu}\\sum_{j=1}^{\\infty} p(j)\\sum_{k=0}^{j-1} 1\n=\\frac{1}{\\mu}\\sum_{j=1}^{\\infty} j\\,p(j)\n=\\frac{\\mu}{\\mu}=1.\n$$", "answer": "$$\\boxed{\\frac{1}{\\mu}\\sum_{j=k+1}^{\\infty} p(j)}$$", "id": "1330923"}, {"introduction": "关键更新定理的威力在于其广泛的适用性，它能够将看似无关的概念联系起来，解决复杂的实际问题。这个练习提出了一个现代分布式计算中的“僵尸任务”问题，要求计算在稳态下处于特定状态的任务的平均数量。这个问题巧妙地展示了如何将更新过程的到达率 ($1/\\mu$) 与一个状态的期望持续时间相结合（通常借助利特尔定律等思想），从而为我们提供一个分析系统“库存”或“人口”的强大框架。它完美地体现了将理论应用于实际工程问题的过程。", "problem": "一个分布式计算系统接收作业，其到达时间构成一个更新过程。连续作业到达之间的时间间隔是独立同分布的随机变量，服从区间 $[T_{min}, T_{max}]$ 上的均匀分布。\n\n每个到达的作业立即分叉成两个并行的子任务：一个“快”任务和一个“慢”任务。\n- 快任务总是在固定的时间量 $\\tau$ 内完成。\n- 完成慢任务所需的时间是一个随机变量 $T$，服从速率参数为 $\\lambda$ 的指数分布。不同作业的慢任务持续时间彼此独立，且与作业到达过程无关。\n\n如果一个作业的快任务已完成，但其慢任务尚未结束，则该作业被认为处于“僵尸”状态。假设系统已经运行了足够长的时间以达到稳态，处于僵尸状态的作业的长期期望数量是多少？\n\n你的答案应该是一个用参数 $T_{min}$、$T_{max}$、$\\tau$ 和 $\\lambda$ 表示的单一闭式解析表达式。", "solution": "设到达间隔时间为 $A \\sim \\text{Uniform}[T_{min}, T_{max}]$。其均值为\n$$\n\\mathbb{E}[A] = \\frac{T_{min} + T_{max}}{2},\n$$\n因此，长期到达率为\n$$\nr = \\frac{1}{\\mathbb{E}[A]} = \\frac{2}{T_{min} + T_{max}}.\n$$\n\n每个作业当且仅当其慢任务的持续时间超过快任务的完成时间 $\\tau$ 时，才会产生一个僵尸区间。设慢任务持续时间为 $T \\sim \\text{Exp}(\\lambda)$，在不同作业之间以及与到达过程均独立。一个作业所贡献的僵尸区间的长度为\n$$\nZ = \\max\\{T - \\tau, 0\\} = (T - \\tau)^{+}.\n$$\n根据更新回报定理（或应用于由这些僵尸区间形成的无限服务器占用的利特尔法则），僵尸的长期期望数量等于到达率乘以每个作业的平均僵尸持续时间：\n$$\n\\mathbb{E}[\\text{zombies}] = r \\,\\mathbb{E}[Z].\n$$\n\n我们使用指数分布来计算 $\\mathbb{E}[Z]$。将其写成积分形式，\n$$\n\\mathbb{E}[Z] = \\int_{\\tau}^{\\infty} (t - \\tau)\\,\\lambda \\exp(-\\lambda t)\\,dt.\n$$\n作代换 $u = t - \\tau$ 得到\n$$\n\\mathbb{E}[Z] = \\int_{0}^{\\infty} u \\,\\lambda \\exp[-\\lambda(u + \\tau)]\\,du\n= \\exp(-\\lambda \\tau)\\int_{0}^{\\infty} u \\,\\lambda \\exp(-\\lambda u)\\,du.\n$$\n利用 $\\int_{0}^{\\infty} u \\,\\lambda \\exp(-\\lambda u)\\,du = \\frac{1}{\\lambda}$，我们得到\n$$\n\\mathbb{E}[Z] = \\frac{\\exp(-\\lambda \\tau)}{\\lambda}.\n$$\n\n因此，\n$$\n\\mathbb{E}[\\text{zombies}] = r \\,\\mathbb{E}[Z] = \\frac{2}{T_{min} + T_{max}} \\cdot \\frac{\\exp(-\\lambda \\tau)}{\\lambda}\n= \\frac{2\\,\\exp(-\\lambda \\tau)}{\\lambda\\,(T_{min} + T_{max})}.\n$$", "answer": "$$\\boxed{\\frac{2\\,\\exp(-\\lambda \\tau)}{\\lambda\\,(T_{min} + T_{max})}}$$", "id": "1339872"}]}