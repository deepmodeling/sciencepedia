{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。本节的第一个练习将引导你完成求解平稳分布的基本步骤。通过为一个三状态服务器系统建模，你将亲手将系统描述转化为生成矩阵 $Q$，并求解核心平衡方程 $\\pi Q = \\mathbf{0}$。这个练习旨在夯实基础，确保你能够熟练运用求解平稳分布的通用方法。[@problem_id:1333676]", "problem": "考虑一个计算机服务器的简化模型，该服务器可以处于以下三种状态之一：{1: 空闲, 2: 计算, 3: 更新}。服务器根据一个连续时间马尔可夫链在这些状态之间进行转换。\n转换规则如下：\n- 从“空闲”（状态1），一个新任务到达，导致以 $3\\lambda$ 的速率转换到“计算”（状态2）。\n- 从“空闲”（状态1），系统可以启动自我更新，以 $\\lambda$ 的速率转换到“更新”（状态3）。\n- 从“计算”（状态2），当前任务可以完成，以 $4\\lambda$ 的速率使服务器返回“空闲”（状态1）。\n- 从“计算”（状态2），一个强制性的系统补丁可能会中断任务，迫使其以 $\\lambda$ 的速率转换到“更新”（状态3）。\n- 从“更新”（状态3），更新过程完成，服务器总是以 $4\\lambda$ 的速率返回“空闲”（状态1）。\n没有其他可能的转换。参数 $\\lambda$ 是一个代表基础转换速率的正常数。\n\n假设系统已经运行了很长时间，它达到了一个平稳状态。确定平稳概率分布向量 $\\pi = (\\pi_1, \\pi_2, \\pi_3)$，其中 $\\pi_i$ 是发现服务器处于状态 $i$ 的长期概率。", "solution": "设连续时间马尔可夫链的状态空间为 $S = \\{1, 2, 3\\}$，分别对应于状态{空闲, 计算, 更新}。平稳分布是一个概率向量 $\\pi = (\\pi_1, \\pi_2, \\pi_3)$，它满足方程 $\\pi Q = \\mathbf{0}$（其中 $Q$ 是该链的生成元矩阵）和归一化条件 $\\sum_{i=1}^3 \\pi_i = 1$。\n\n首先，我们构造生成元矩阵 $Q$。对于 $i \\neq j$，非对角元素 $q_{ij}$ 是从状态 $i$ 到状态 $j$ 的转换速率 $\\lambda_{ij}$。对角元素 $q_{ii}$ 由 $q_{ii} = -\\sum_{j \\neq i} q_{ij}$ 给出。根据问题描述，转换速率如下：\n$q_{12} = 3\\lambda$\n$q_{13} = \\lambda$\n$q_{21} = 4\\lambda$\n$q_{23} = \\lambda$\n$q_{31} = 4\\lambda$\n$q_{32} = 0$ (从“更新”到“计算”没有转换)\n所有其他未列出的非对角速率均为零。\n\n现在，我们计算对角元素：\n$q_{11} = -(q_{12} + q_{13}) = -(3\\lambda + \\lambda) = -4\\lambda$\n$q_{22} = -(q_{21} + q_{23}) = -(4\\lambda + \\lambda) = -5\\lambda$\n$q_{33} = -(q_{31} + q_{32}) = -(4\\lambda + 0) = -4\\lambda$\n\n因此，生成元矩阵 $Q$ 为：\n$$\nQ = \\lambda \\begin{pmatrix}\n-4 & 3 & 1 \\\\\n4 & -5 & 1 \\\\\n4 & 0 & -4\n\\end{pmatrix}\n$$\n\n条件 $\\pi Q = \\mathbf{0}$ 产生一个线性方程组。由于 $\\lambda > 0$，我们可以除以公因子 $\\lambda$。\n$$\n(\\pi_1, \\pi_2, \\pi_3) \\begin{pmatrix}\n-4 & 3 & 1 \\\\\n4 & -5 & 1 \\\\\n4 & 0 & -4\n\\end{pmatrix} = (0, 0, 0)\n$$\n这对应于每一列，得到以下方程：\n1.  $-4\\pi_1 + 4\\pi_2 + 4\\pi_3 = 0$\n2.  $3\\pi_1 - 5\\pi_2 = 0$\n3.  $\\pi_1 + \\pi_2 - 4\\pi_3 = 0$\n\n这个包含三个未知数的三个方程的方程组是线性相关的。我们可以使用其中的任意两个方程以及归一化条件 $\\pi_1 + \\pi_2 + \\pi_3 = 1$。\n\n使用方程(2)：\n$3\\pi_1 - 5\\pi_2 = 0 \\implies 5\\pi_2 = 3\\pi_1 \\implies \\pi_2 = \\frac{3}{5}\\pi_1$。\n\n接下来，我们将方程(1)两边除以4进行简化：\n$-\\pi_1 + \\pi_2 + \\pi_3 = 0 \\implies \\pi_3 = \\pi_1 - \\pi_2$。\n现在，将 $\\pi_2$ 用 $\\pi_1$ 的表达式代入：\n$\\pi_3 = \\pi_1 - \\frac{3}{5}\\pi_1 = \\frac{2}{5}\\pi_1$。\n\n现在我们已经将 $\\pi_2$ 和 $\\pi_3$ 都用 $\\pi_1$ 表示出来了。我们可以使用归一化条件来求解 $\\pi_1$：\n$\\pi_1 + \\pi_2 + \\pi_3 = 1$\n$\\pi_1 + \\frac{3}{5}\\pi_1 + \\frac{2}{5}\\pi_1 = 1$\n$\\frac{5}{5}\\pi_1 + \\frac{3}{5}\\pi_1 + \\frac{2}{5}\\pi_1 = 1$\n$\\frac{10}{5}\\pi_1 = 1 \\implies 2\\pi_1 = 1$\n$\\pi_1 = \\frac{1}{2}$。\n\n现在我们可以求出 $\\pi_2$ 和 $\\pi_3$ 的值：\n$\\pi_2 = \\frac{3}{5}\\pi_1 = \\frac{3}{5} \\left(\\frac{1}{2}\\right) = \\frac{3}{10}$。\n$\\pi_3 = \\frac{2}{5}\\pi_1 = \\frac{2}{5} \\left(\\frac{1}{2}\\right) = \\frac{2}{10} = \\frac{1}{5}$。\n\n平稳分布向量为 $\\pi = (\\pi_1, \\pi_2, \\pi_3) = \\left(\\frac{1}{2}, \\frac{3}{10}, \\frac{1}{5}\\right)$。\n我们可以用方程组中的第三个方程来验证这个结果： $\\pi_1 + \\pi_2 - 4\\pi_3 = \\frac{1}{2} + \\frac{3}{10} - 4\\left(\\frac{1}{5}\\right) = \\frac{5}{10} + \\frac{3}{10} - \\frac{8}{10} = 0$，该等式成立。概率之和为 $\\frac{1}{2} + \\frac{3}{10} + \\frac{1}{5} = \\frac{5}{10} + \\frac{3}{10} + \\frac{2}{10} = \\frac{10}{10} = 1$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2} & \\frac{3}{10} & \\frac{1}{5} \\end{pmatrix}}$$", "id": "1333676"}, {"introduction": "在掌握了通用方法后，我们来学习一种更高效的技巧。许多现实世界系统可以被建模为“生灭过程”，即状态只能线性地增加或减少。对于这类特殊的马尔可夫链，我们可以使用更为简洁的细致平衡方程来求解平稳分布，从而避免复杂的矩阵运算。这个关于网络服务器会话的练习 [@problem_id:1333674] 正是为此设计的，它将教会你如何识别并利用这种结构来简化问题。", "problem": "考虑一个小型Web服务器的简化模型，该服务器最多可以处理两个并发用户会话。令 $N(t)$ 为时间 $t$ 时的活动会话数。因此，会话数的状态空间为 $\\{0, 1, 2\\}$。\n\n新的会话请求根据一个泊松过程到达，其常数速率为 $\\lambda > 0$。如果服务器未满负荷（即，如果 $N(t) < 2$），则接受一个传入的请求，活动会话数增加一。如果服务器处于满负荷状态（$N(t) = 2$），任何新的传入请求都将被拒绝，并且对系统没有影响。\n\n每个活动会话的终止独立于所有其他会话以及新会话的到达。单个会话终止前的时间服从速率为 $\\mu > 0$ 的指数分布。这意味着如果有 $n$ 个活动会话，会话终止的总速率为 $n\\mu$。\n\n假设系统已经运行了很长时间并达到了统计平衡，请确定活动会话数的长期概率。令这些概率分别为 $p_0$、$p_1$ 和 $p_2$，对应于有 0、1 和 2 个会话的情况。\n\n您的答案应为行向量 $(p_0, p_1, p_2)$ 的形式，其中每个分量都是用参数 $\\lambda$ 和 $\\mu$ 表示的表达式。", "solution": "我们将 $\\{N(t)\\}$ 建模为状态空间 $\\{0,1,2\\}$ 上的连续时间生灭马尔可夫链。出生（到达）速率为 $\\lambda_{0}=\\lambda$、$\\lambda_{1}=\\lambda$ 和 $\\lambda_{2}=0$（在容量处阻塞）。死亡（服务完成）速率为 $\\mu_{0}=0$、$\\mu_{1}=\\mu$ 和 $\\mu_{2}=2\\mu$。\n\n在稳态下，对于生灭链，细致平衡成立：\n$$\np_{n}\\lambda_{n}=p_{n+1}\\mu_{n+1}.\n$$\n应用此式，对于 $n=0$：\n$$\np_{0}\\lambda=p_{1}\\mu \\quad\\Rightarrow\\quad p_{1}=\\frac{\\lambda}{\\mu}\\,p_{0},\n$$\n对于 $n=1$：\n$$\np_{1}\\lambda=p_{2}\\cdot 2\\mu \\quad\\Rightarrow\\quad p_{2}=\\frac{\\lambda}{2\\mu}\\,p_{1}=\\frac{\\lambda}{2\\mu}\\left(\\frac{\\lambda}{\\mu}\\,p_{0}\\right)=\\frac{\\lambda^{2}}{2\\mu^{2}}\\,p_{0}.\n$$\n\n使用归一化条件 $\\sum_{n=0}^{2}p_{n}=1$：\n$$\np_{0}+p_{1}+p_{2}=p_{0}\\left(1+\\frac{\\lambda}{\\mu}+\\frac{\\lambda^{2}}{2\\mu^{2}}\\right)=1,\n$$\n因此\n$$\np_{0}=\\frac{1}{1+\\frac{\\lambda}{\\mu}+\\frac{\\lambda^{2}}{2\\mu^{2}}}=\\frac{2\\mu^{2}}{2\\mu^{2}+2\\lambda\\mu+\\lambda^{2}}.\n$$\n那么\n$$\np_{1}=\\frac{\\lambda}{\\mu}p_{0}=\\frac{2\\lambda\\mu}{2\\mu^{2}+2\\lambda\\mu+\\lambda^{2}},\\qquad\np_{2}=\\frac{\\lambda^{2}}{2\\mu^{2}}p_{0}=\\frac{\\lambda^{2}}{2\\mu^{2}+2\\lambda\\mu+\\lambda^{2}}.\n$$\n\n因此，长期概率向量为\n$$\n\\begin{pmatrix}\n\\frac{2\\mu^{2}}{2\\mu^{2}+2\\lambda\\mu+\\lambda^{2}} &\n\\frac{2\\lambda\\mu}{2\\mu^{2}+2\\lambda\\mu+\\lambda^{2}} &\n\\frac{\\lambda^{2}}{2\\mu^{2}+2\\lambda\\mu+\\lambda^{2}}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{2\\mu^{2}}{2\\mu^{2}+2\\lambda\\mu+\\lambda^{2}} & \\frac{2\\lambda\\mu}{2\\mu^{2}+2\\lambda\\mu+\\lambda^{2}} & \\frac{\\lambda^{2}}{2\\mu^{2}+2\\lambda\\mu+\\lambda^{2}}\\end{pmatrix}}$$", "id": "1333674"}, {"introduction": "前面的练习处理的是状态数量固定的系统。现在，让我们挑战一个更具一般性的问题，其中系统的大小由参数 $N$ 决定。通过分析数据包在通信网络中的传输过程，你将学习如何建立关于平稳概率 $\\pi_i$ 的递推关系，并最终导出一个适用于任意大小网络的封闭解。这项练习 [@problem_id:1333689] 旨在培养你处理参数化系统和使用递推关系解决问题的能力，这是随机建模中一项非常重要的进阶技能。", "problem": "考虑一个数据包穿过一个线性通信网络的简化模型。该网络由一个标记为0的源节点和一系列标记为 $1, 2, \\dots, N$ 的后续 $N$ 个节点组成。数据包在该网络中的位置可以被建模为状态空间 $S = \\{0, 1, \\dots, N\\}$ 上的一个连续时间马尔可夫链 (CTMC)。\n\n数据包移动的动态过程如下：\n- 从任何节点 $i$（其中 $0 \\le i < N$），数据包试图向前移动到下一个节点 $i+1$。此转移以一个恒定的速率 $\\lambda > 0$ 发生。\n- 从任何节点 $i$（其中 $1 \\le i \\le N$），数据包存在被丢弃的风险。如果被丢弃，数据包会立即从源节点0重新传输。这个“丢弃并返回”事件以一个恒定的速率 $\\mu > 0$ 发生。\n- 数据包不能从源节点0被丢弃。一旦数据包到达节点 $N$，它只能被丢弃并返回到节点0。\n\n假设该过程已经运行了很长时间并达到了稳态，请确定在最终目的地节点 $N$ 找到该数据包的概率。您的答案应该是一个以 $N$、$\\lambda$ 和 $\\mu$ 表示的闭式解析表达式。", "solution": "将数据包的位置建模为状态空间 $S=\\{0,1,\\dots,N\\}$ 上的一个CTMC。其生成元矩阵的非对角元素为：\n- 对于 $i=0$：$q_{0,1}=\\lambda$。\n- 对于 $1 \\leq i \\leq N-1$：$q_{i,i+1}=\\lambda$，$q_{i,0}=\\mu$。\n- 对于 $i=N$：$q_{N,0}=\\mu$。\n对角元素 $q_{ii} = -\\sum_{j \\neq i} q_{ij}$。\n\n令 $\\pi_i$ 表示状态 $i$ 的稳态概率。稳态条件要求 $\\pi Q=\\mathbf{0}$ 且 $\\sum_{i=0}^{N}\\pi_i=1$。写出每个状态的全局平衡方程（总流出率 = 总流入率）可得：\n- 对于状态 $i=0$：\n$$\n\\lambda \\pi_0 = \\mu\\sum_{i=1}^{N}\\pi_i\n$$\n- 对于状态 $i$（其中 $1 \\leq i \\leq N-1$）：\n$$\n(\\lambda+\\mu)\\pi_i = \\lambda \\pi_{i-1}\n$$\n- 对于状态 $i=N$：\n$$\n\\mu \\pi_N = \\lambda \\pi_{N-1}\n$$\n\n定义 $r=\\frac{\\lambda}{\\lambda+\\mu}$。对于 $1 \\leq i \\leq N-1$ 的递推关系可得\n$$\n\\pi_i = r \\pi_{i-1} = r^2 \\pi_{i-2} = \\dots = r^{i}\\pi_0.\n$$\n使用 $i=N$ 的平衡方程，\n$$\n\\pi_N=\\frac{\\lambda}{\\mu}\\pi_{N-1}=\\frac{\\lambda}{\\mu}r^{N-1}\\pi_0.\n$$\n\n使用 $\\sum_{i=0}^{N}\\pi_i=1$ 进行归一化：\n$$\n1=\\sum_{i=0}^{N}\\pi_i = \\pi_0 + \\sum_{i=1}^{N-1}\\pi_i + \\pi_N = \\pi_0\\left(1 + \\sum_{i=1}^{N-1}r^{i}+\\frac{\\lambda}{\\mu}r^{N-1}\\right)\n$$\n注意到 $1 + \\sum_{i=1}^{N-1}r^{i} = \\sum_{i=0}^{N-1}r^{i}$，这是一个几何级数求和：\n$$\n\\sum_{i=0}^{N-1}r^{i} = \\frac{1-r^{N}}{1-r}\n$$\n所以，\n$$\n1=\\pi_0\\left(\\frac{1-r^{N}}{1-r}+\\frac{\\lambda}{\\mu}r^{N-1}\\right).\n$$\n因为 $1-r=1-\\frac{\\lambda}{\\lambda+\\mu}=\\frac{\\mu}{\\lambda+\\mu}$，所以 $\\frac{1}{1-r}=\\frac{\\lambda+\\mu}{\\mu}$。代入得：\n$$\n1=\\pi_0\\left(\\frac{\\lambda+\\mu}{\\mu}(1-r^{N})+\\frac{\\lambda}{\\mu}r^{N-1}\\right)\n$$\n$$\n1=\\frac{\\pi_0}{\\mu}\\left( (\\lambda+\\mu) - (\\lambda+\\mu)r^{N} + \\lambda r^{N-1} \\right)\n$$\n我们来简化括号中的项：$-(\\lambda+\\mu)r^{N} + \\lambda r^{N-1} = r^{N-1} \\left( -(\\lambda+\\mu)r + \\lambda \\right)$。\n因为 $r=\\frac{\\lambda}{\\lambda+\\mu}$，所以 $-(\\lambda+\\mu)r + \\lambda = -(\\lambda+\\mu)\\frac{\\lambda}{\\lambda+\\mu} + \\lambda = -\\lambda + \\lambda = 0$。\n因此，括号中的项简化为 $(\\lambda+\\mu)$。\n$$\n1 = \\frac{\\pi_0}{\\mu}(\\lambda+\\mu) \\implies \\pi_0=\\frac{\\mu}{\\lambda+\\mu}.\n$$\n最后，我们求 $\\pi_N$：\n$$\n\\pi_N=\\frac{\\lambda}{\\mu}r^{N-1}\\pi_0=\\frac{\\lambda}{\\mu}\\left(\\frac{\\lambda}{\\lambda+\\mu}\\right)^{N-1}\\left(\\frac{\\mu}{\\lambda+\\mu}\\right)\n$$\n$$\n\\pi_N = \\frac{\\lambda \\cdot \\lambda^{N-1}}{(\\lambda+\\mu)^{N-1} \\cdot (\\lambda+\\mu)} = \\frac{\\lambda^N}{(\\lambda+\\mu)^N} = \\left(\\frac{\\lambda}{\\lambda+\\mu}\\right)^{N}.\n$$\n这就是在节点 $N$ 的稳态概率。", "answer": "$$\\boxed{\\left(\\frac{\\lambda}{\\lambda+\\mu}\\right)^{N}}$$", "id": "1333689"}]}