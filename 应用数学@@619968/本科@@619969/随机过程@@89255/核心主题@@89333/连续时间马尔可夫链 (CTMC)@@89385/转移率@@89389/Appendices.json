{"hands_on_practices": [{"introduction": "分析任何连续时间马尔可夫链的第一步通常是将其动态特性用数学语言精确地描述出来。生成元矩阵（或称 $Q$ 矩阵）就是这个过程的“蓝图”，它简洁地概括了系统所有可能的状态转移及其速率。本练习将引导你通过一个包裹物流的现实场景，学习如何将一个系统的状态和转移规则转化为其对应的生成元矩阵 [@problem_id:1347534]。", "problem": "一家现代物流公司使用连续时间马尔可夫链来模拟一个包裹的运送过程。包裹的状态可以是以下四种可能性之一：\n- 状态 1: `Processing` (处理中，在初始仓库)\n- 状态 2: `In Transit` (运送中，正在送往收件人)\n- 状态 3: `Delivered` (已送达，客户成功签收)\n- 状态 4: `Awaiting Return` (等待退回，投递失败，等待返回仓库)\n\n包裹根据以下规则和恒定速率在这些状态之间转换：\n- 一个处于 `Processing` 状态的包裹被发出并变为 `In Transit` 状态，其速率为 $\\alpha$。\n- 一个处于 `In Transit` 状态的包裹成功 `Delivered` (送达)，其速率为 $\\beta$。\n- 一个处于 `In Transit` 状态的包裹也可能投递失败并变为 `Awaiting Return` 状态，其速率为 $\\gamma$。\n- 一个处于 `Awaiting Return` 状态的包裹被送回仓库进行重新处理，以速率 $\\delta$ 重新进入 `Processing` 状态。\n- 一旦包裹被 `Delivered` (送达)，它就被认为是一个吸收状态，意味着它将永远保持 `Delivered` 状态。\n- 没有其他可能的转换。\n\n给定此模型，请确定此过程的正确生成元矩阵 $Q$，其中状态排序为 (1: `Processing`, 2: `In Transit`, 3: `Delivered`, 4: `Awaiting Return`)。\n\n以下哪个矩阵代表 $Q$？\n\nA.\n$$\n\\begin{pmatrix}\n-\\alpha & \\alpha & 0 & 0 \\\\\n0 & -(\\beta+\\gamma) & \\beta & \\gamma \\\\\n0 & 0 & 0 & 0 \\\\\n\\delta & 0 & 0 & -\\delta\n\\end{pmatrix}\n$$\n\nB.\n$$\n\\begin{pmatrix}\n-\\alpha & \\alpha & 0 & 0 \\\\\n0 & -\\beta & \\beta & \\gamma \\\\\n0 & 0 & 0 & 0 \\\\\n\\delta & 0 & 0 & -\\delta\n\\end{pmatrix}\n$$\n\nC.\n$$\n\\begin{pmatrix}\n1-\\alpha & \\alpha & 0 & 0 \\\\\n0 & 1-\\beta-\\gamma & \\beta & \\gamma \\\\\n0 & 0 & 1 & 0 \\\\\n\\delta & 0 & 0 & 1-\\delta\n\\end{pmatrix}\n$$\n\nD.\n$$\n\\begin{pmatrix}\n-\\alpha & \\alpha & 0 & \\delta \\\\\n0 & -(\\beta+\\gamma) & \\beta & 0 \\\\\n0 & \\gamma & 0 & 0 \\\\\n0 & 0 & 0 & -\\delta\n\\end{pmatrix}\n$$\n\nE.\n$$\n\\begin{pmatrix}\n-\\alpha & \\alpha & 0 & 0 \\\\\n\\delta & -(\\beta+\\gamma) & \\beta & \\gamma \\\\\n0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & -\\delta\n\\end{pmatrix}\n$$", "solution": "对于连续时间马尔可夫链，其生成元矩阵 $Q$ 满足以下性质：\n- 对于 $i \\neq j$，$q_{ij} \\geq 0$ 表示从状态 $i$ 到状态 $j$ 的转换速率。\n- 对于每个状态 $i$，对角线元素为 $q_{ii} = -\\sum_{j \\neq i} q_{ij}$，因此每行的和为零。\n- 如果一个状态是吸收状态，则其对应的整行为零。\n\n根据问题描述，状态排序为 $(1,2,3,4)$ 对应 (处理中, 运送中, 已送达, 等待退回)，允许的转换及其速率如下：\n- 从状态 1 到状态 2 的速率为 $\\alpha$，没有其他从状态 1 出发的转换。因此，\n$$\nq_{12}=\\alpha,\\quad q_{11}=-\\alpha,\\quad q_{13}=0,\\quad q_{14}=0.\n$$\n- 从状态 2 到状态 3 的速率为 $\\beta$，到状态 4 的速率为 $\\gamma$，没有其他从状态 2 出发的转换。因此，\n$$\nq_{23}=\\beta,\\quad q_{24}=\\gamma,\\quad q_{21}=0,\\quad q_{22}=-(\\beta+\\gamma).\n$$\n- 状态 3 (已送达) 是吸收状态。因此，\n$$\nq_{3j}=0\\ \\text{for all } j,\\quad \\text{so } q_{33}=0.\n$$\n- 从状态 4 到状态 1 的速率为 $\\delta$，没有其他从状态 4 出发的转换。因此，\n$$\nq_{41}=\\delta,\\quad q_{44}=-\\delta,\\quad q_{42}=0,\\quad q_{43}=0.\n$$\n\n汇总这些元素，生成元矩阵为\n$$\nQ=\\begin{pmatrix}\n-\\alpha & \\alpha & 0 & 0 \\\\\n0 & -(\\beta+\\gamma) & \\beta & \\gamma \\\\\n0 & 0 & 0 & 0 \\\\\n\\delta & 0 & 0 & -\\delta\n\\end{pmatrix}.\n$$\n这与选项 A 匹配。选项 B、C、D 和 E 违反了生成元矩阵的性质或包含了禁止的转换：B 的第 2 行对角线元素不正确；C 是离散时间转换矩阵的形式；D 和 E 包含不允许的转换或遗漏了必要的转换。", "answer": "$$\\boxed{A}$$", "id": "1347534"}, {"introduction": "建立了系统的生成元矩阵后，我们便可以探究其动态行为了。一个基本的问题是：系统在进入某个特定状态后，平均会停留多长时间才会转移到下一个状态？这个练习通过一个易于理解的共享出行业务场景，帮助你掌握计算期望停留时间的方法，这是直接由转移速率决定的一个核心概念 [@problem_id:1347554]。", "problem": "一位网约车服务的司机可以处于三种状态之一：“空闲”（$S_1$）、“前往接乘客”（$S_2$）或“行程中”（$S_3$）。这些状态之间的转移被建模为一个具有恒定转移速率的连续时间马尔可夫过程。\n\n当司机处于“空闲”状态（$S_1$）时，他们可以接收两种类型的请求。一个标准请求会使其以 $\\lambda_{12} = 2.4$ 次/小时的速率转移到“前往接乘客”状态（$S_2$）。一个针对司机当前位置乘客的立即接单请求，会使其以 $\\lambda_{13} = 0.8$ 次/小时的速率直接转移到“行程中”状态（$S_3$）。\n\n系统中的其他转移如下：从状态 $S_2$ 出发，乘客可能会取消订单，导致司机以 $\\lambda_{21} = 0.7$ 次/小时的速率返回状态 $S_1$。或者，司机可以成功接到乘客，以 $\\lambda_{23} = 11.5$ 次/小时的速率转移到状态 $S_3$。在状态 $S_3$ 完成一次行程后，司机会以 $\\lambda_{31} = 2.9$ 次/小时的速率返回“空闲”状态 $S_1$。\n\n假设司机刚刚进入“空闲”状态，他们在转移到另一个状态之前，将保持在这个“空闲”状态的期望时间是多少？请以分钟为单位给出答案，并四舍五入到三位有效数字。", "solution": "设 $T_1$ 为随机变量，表示司机单次处于“空闲”状态（$S_1$）所花费的时间。在连续时间马尔可夫过程中，任何状态 $i$ 的停留时间服从指数分布。该分布的速率参数（我们称之为 $q_i$）是所有可能从状态 $i$ 转移出去的转移速率之和。\n\n在本问题中，我们关心的是在状态 $S_1$ 的期望停留时间。离开状态 $S_1$ 的总速率，记为 $q_1$，是所有从 $S_1$ 发出的转移的速率之和。根据问题描述，司机有两种方式离开“空闲”状态：\n1. 以速率 $\\lambda_{12}$ 转移到状态 $S_2$（“前往接乘客”）。\n2. 以速率 $\\lambda_{13}$ 转移到状态 $S_3$（“行程中”）。\n\n从其他状态转移出去的速率（例如 $\\lambda_{21}$、$\\lambda_{23}$、$\\lambda_{31}$）与计算状态 $S_1$ 的停留时间无关。\n\n从状态 $S_1$ 的总离开速率是这两个转移的速率之和：\n$$q_1 = \\lambda_{12} + \\lambda_{13}$$\n代入给定值：\n$$q_1 = 2.4 \\text{ hr}^{-1} + 0.8 \\text{ hr}^{-1} = 3.2 \\text{ hr}^{-1}$$\n因此，停留时间 $T_1$ 服从速率参数为 $q_1 = 3.2 \\text{ hr}^{-1}$ 的指数分布。\n\n速率参数为 $\\lambda$ 的指数随机变量的期望值（均值）由 $E[T] = \\frac{1}{\\lambda}$ 给出。\n因此，司机保持在“空闲”状态的期望时间是：\n$$E[T_1] = \\frac{1}{q_1} = \\frac{1}{3.2 \\text{ hr}^{-1}} = \\frac{1}{3.2} \\text{ 小时}$$\n题目要求答案以分钟为单位。我们必须将单位从小时转换为分钟：\n$$E[T_1] \\text{（分钟）} = \\left(\\frac{1}{3.2} \\text{ 小时}\\right) \\times \\left(\\frac{60 \\text{ 分钟}}{1 \\text{ 小时}}\\right)$$\n现在我们计算数值：\n$$E[T_1] = \\frac{60}{3.2} = \\frac{600}{32} = \\frac{300}{16} = \\frac{150}{8} = \\frac{75}{4} = 18.75 \\text{ 分钟}$$\n最后，我们需要按要求将结果四舍五入到三位有效数字。前三位有效数字是1、8和7。后一位数字是5，这意味着我们需要对最后一位有效数字进行进位。\n$$18.75 \\approx 18.8$$\n所以，司机保持在“空闲”状态的期望时间是18.8分钟。", "answer": "$$\\boxed{18.8}$$", "id": "1347554"}, {"introduction": "在许多从金融到物理的实际应用中，我们并非一开始就知道精确的转移速率。相反，我们必须通过观测数据来估计它们。这个更深层次的练习将向你介绍一种强大的贝叶斯方法，它展示了我们如何将转移速率本身视为一个随机变量，并根据实验观测结果来更新我们对它的认知 [@problem_id:1347520]。", "problem": "一个研究团队正在研究一种新型量子点的稳定性，该量子点可以通过发射一个光子自发地从激发态跃迁到其基态。由于其精确值未知，该团队将跃迁速率 $\\lambda$ 建模为一个随机变量。基于对相似材料的理论模型，他们关于 $\\lambda$ 的先验信念由一个形状参数为 $\\alpha > 0$、速率参数为 $\\beta > 0$ 的伽马分布描述。这个先验的概率密度函数由下式给出：\n$$ p(\\lambda | \\alpha, \\beta) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} \\lambda^{\\alpha-1} \\exp(-\\beta \\lambda) \\quad \\text{for } \\lambda > 0 $$\n其中 $\\Gamma(\\cdot)$ 是伽马函数。\n\n该团队进行了一项实验，他们将量子点制备在激发态，并对其进行总持续时间为 $T$ 的观测。在此期间，他们精确地探测到 $k$ 次自发跃迁。假定在给定时间间隔内此类跃迁的次数服从泊松过程，其中在给定速率 $\\lambda$ 的情况下，在时间 $T$ 内观测到 $k$ 个事件的概率为：\n$$ P(\\text{data} | \\lambda) = \\frac{(\\lambda T)^{k}}{k!} \\exp(-\\lambda T) $$\n\n在结合了实验观测结果后，该团队关于 $\\lambda$ 的更新后的信念由一个新的伽马分布，即后验分布来描述。该后验分布由一个更新后的形状参数 $\\alpha'$ 和一个更新后的速率参数 $\\beta'$ 来表征。\n\n请用先验参数 $\\alpha, \\beta$ 和实验数据 $k, T$ 来确定后验参数 $\\alpha'$ 和 $\\beta'$ 的表达式。", "solution": "我们从速率参数 $\\lambda$ 在形状为 $\\alpha$、速率为 $\\beta$ 的伽马分布下的先验密度开始：\n$$\np(\\lambda \\mid \\alpha,\\beta)=\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}\\lambda^{\\alpha-1}\\exp(-\\beta \\lambda), \\quad \\lambda>0.\n$$\n在泊松过程中，给定 $\\lambda$ 的条件下，在时间 $T$ 内观测到 $k$ 个事件的似然函数为\n$$\nP(k \\mid \\lambda,T)=\\frac{(\\lambda T)^{k}}{k!}\\exp(-\\lambda T).\n$$\n根据贝叶斯法则，后验密度与似然函数和先验的乘积成正比：\n$$\np(\\lambda \\mid k,T,\\alpha,\\beta)\\propto P(k \\mid \\lambda,T)\\,p(\\lambda \\mid \\alpha,\\beta).\n$$\n代入表达式并将依赖于 $\\lambda$ 的因子归并在一起，我们得到\n$$\np(\\lambda \\mid k,T,\\alpha,\\beta)\\propto \\left[\\frac{(\\lambda T)^{k}}{k!}\\exp(-\\lambda T)\\right]\\left[\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}\\lambda^{\\alpha-1}\\exp(-\\beta \\lambda)\\right].\n$$\n相对于 $\\lambda$ 的常数可以被吸收到归一化常数中，剩下\n$$\np(\\lambda \\mid k,T,\\alpha,\\beta)\\propto \\lambda^{k}\\exp(-\\lambda T)\\,\\lambda^{\\alpha-1}\\exp(-\\beta \\lambda)=\\lambda^{\\alpha+k-1}\\exp\\big(-( \\beta+T)\\lambda\\big).\n$$\n识别出这是形状参数为 $\\alpha+k$、速率参数为 $\\beta+T$ 的伽马密度的核，归一化后的后验分布为\n$$\np(\\lambda \\mid k,T,\\alpha,\\beta)=\\frac{(\\beta+T)^{\\alpha+k}}{\\Gamma(\\alpha+k)}\\lambda^{\\alpha+k-1}\\exp\\big(-(\\beta+T)\\lambda\\big),\n$$\n也就是 $\\text{Gamma}(\\alpha+k,\\beta+T)$ 分布。因此，更新后的参数为\n$$\n\\alpha'=\\alpha+k, \\quad \\beta'=\\beta+T.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\alpha + k & \\beta + T\\end{pmatrix}}$$", "id": "1347520"}]}