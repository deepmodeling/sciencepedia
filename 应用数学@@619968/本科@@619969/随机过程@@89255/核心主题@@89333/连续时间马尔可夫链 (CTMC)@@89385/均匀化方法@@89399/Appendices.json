{"hands_on_practices": [{"introduction": "一致化方法的核心思想是将一个连续时间马尔可夫链分解为一个离散时间马尔可夫链和一个泊松过程。本练习将带你实践这一分解过程的第一步：对于一个描述基因在“开启”和“关闭”状态间切换的简化模型，你需要确定最基本的两个组件——最小一致化率 $\\lambda$ 和相应的离散时间转移矩阵 $P$。掌握这一基础技能是应用一致化方法解决更复杂问题的关键。[@problem_id:1348096]", "problem": "一个简化的基因表达模型考虑了一个可以存在于两种状态之一的单个基因：“活化”状态（状态1），此状态下基因正在被转录；以及“失活”状态（状态2），此状态下基因处于沉默状态。这些状态之间的切换过程可以建模为一个连续时间马尔可夫链。\n\n基因在切换到失活状态之前处于活化状态的时间是一个速率参数为 $\\alpha$ 的指数随机变量。相反地，基因在切换回活化状态之前处于失活状态的时间是一个速率参数为 $\\beta$ 的指数随机变量。参数 $\\alpha$ 和 $\\beta$ 是正常数，分别表示失活速率和活化速率。给定失活速率大于活化速率，即 $\\alpha > \\beta$。\n\n对于该系统，可以使用一致化方法构建一个在相同状态空间上演化的等价离散时间马尔可夫链。请确定最小一致化速率 $\\lambda$ 以及相应的一步转移概率矩阵 $$P = \\begin{pmatrix} P_{11} & P_{12} \\\\ P_{21} & P_{22} \\end{pmatrix}$$ 的四个元素。\n\n请将您的答案表示为一个单行矩阵，其中包含按顺序排列的五个值 $\\lambda, P_{11}, P_{12}, P_{21}, P_{22}$。", "solution": "我们将该基因建模为一个状态空间为 $\\{1,2\\}$ 的两状态连续时间马尔可夫链，其中状态1（活化）以速率 $\\alpha$ 转移到状态2（失活），状态2以速率 $\\beta$ 转移到状态1。因此，其无穷小生成元矩阵 $Q$ 为\n$$\nQ=\\begin{pmatrix}\n-\\alpha & \\alpha \\\\\n\\beta & -\\beta\n\\end{pmatrix}.\n$$\n在一致化方法中，我们选择一个速率 $\\lambda$ 满足 $\\lambda \\geq \\max_{i} q_{i}$，其中 $q_{i}=-q_{ii}$ 是从状态 $i$ 的总离开率。在此，$q_{1}=\\alpha$ 且 $q_{2}=\\beta$。给定 $\\alpha>\\beta$，最小一致化速率为\n$$\n\\lambda=\\alpha.\n$$\n一致化后的离散时间链的一步转移矩阵为\n$$\nP=I+\\frac{Q}{\\lambda}.\n$$\n将 $\\lambda=\\alpha$ 和上述 $Q$ 代入，可得\n$$\nP=\\begin{pmatrix}\n1+\\frac{-\\alpha}{\\alpha} & \\frac{\\alpha}{\\alpha} \\\\\n\\frac{\\beta}{\\alpha} & 1+\\frac{-\\beta}{\\alpha}\n\\end{pmatrix}\n=\\begin{pmatrix}\n0 & 1 \\\\\n\\frac{\\beta}{\\alpha} & 1-\\frac{\\beta}{\\alpha}\n\\end{pmatrix}.\n$$\n因此，按顺序 $\\lambda, P_{11}, P_{12}, P_{21}, P_{22}$ 排列的所需量为 $\\alpha, 0, 1, \\frac{\\beta}{\\alpha}, 1-\\frac{\\beta}{\\alpha}$。", "answer": "$$\\boxed{\\begin{pmatrix}\\alpha & 0 & 1 & \\frac{\\beta}{\\alpha} & 1-\\frac{\\beta}{\\alpha}\\end{pmatrix}}$$", "id": "1348096"}, {"introduction": "在通过一致化方法得到离散时间马尔可夫链 (DTMC) 后，我们便可以利用已知的 DTMC 分析工具来研究其性质。这个练习以一个简单的天气模型为例，让你计算其对应的离散链的两步转移概率矩阵 $P^{(2)}$。这能帮助你理解系统在一致化“时钟”的多次“滴答”后是如何演化的，从而加深对离散化过程的理解。[@problem_id:1348076]", "problem": "考虑一个城市的简单气象模型，该模型可用一个具有两个状态的连续时间马尔可夫过程来描述：状态1（‘晴天’）和状态2（‘雨天’）。从‘晴天’到‘雨天’的转移以每天 $\\lambda = 2$ 的恒定速率发生。从‘雨天’到‘晴天’的转移以每天 $\\mu = 3$ 的恒定速率发生。\n\n为了分析此系统，应用了一致化方法。这涉及创建一个相关的离散时间马尔可夫链，其转移可被视为以恒定速率 $\\Lambda$ 发生。对于此问题，速率 $\\Lambda$ 被选为可能的最小均匀速率，即 $\\Lambda = \\max_{i} |q_{ii}|$，其中 $q_{ii}$ 是该连续时间过程的生成元矩阵 $Q$ 的对角线元素。\n\n令 $P$ 为由此产生的离散时间链的一步转移概率矩阵。你的任务是计算两步转移概率矩阵 $P^{(2)}$。请将你的答案表示为一个2x2矩阵，其行和列索引对应于状态编号。", "solution": "对于一个两状态连续时间马尔可夫链，其中从状态1到2的转移速率为 $\\lambda$，从状态2到1的转移速率为 $\\mu$，其生成元矩阵为\n$$\nQ=\\begin{pmatrix}\n-\\lambda & \\lambda \\\\\n\\mu & -\\mu\n\\end{pmatrix}.\n$$\n当 $\\lambda=2$ 且 $\\mu=3$ 时，该矩阵变为\n$$\nQ=\\begin{pmatrix}\n-2 & 2 \\\\\n3 & -3\n\\end{pmatrix}.\n$$\n一致化方法选择速率 $\\Lambda=\\max_{i}|q_{ii}|=\\max\\{\\lambda,\\mu\\}=\\mu=3$。其嵌入的离散时间转移矩阵是\n$$\nP=I+\\frac{1}{\\Lambda}Q=I+\\frac{1}{3}\\begin{pmatrix}\n-2 & 2 \\\\\n3 & -3\n\\end{pmatrix}\n=\\begin{pmatrix}\n1-\\frac{2}{3} & \\frac{2}{3} \\\\\n1 & 1-1\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\frac{1}{3} & \\frac{2}{3} \\\\\n1 & 0\n\\end{pmatrix}.\n$$\n两步转移概率矩阵为 $P^{(2)}=P^{2}$。计算\n$$\nP^{2}=\\begin{pmatrix}\n\\frac{1}{3} & \\frac{2}{3} \\\\\n1 & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{1}{3} & \\frac{2}{3} \\\\\n1 & 0\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\frac{1}{9}+\\frac{2}{3} & \\frac{2}{9}+0 \\\\\n\\frac{1}{3}+0 & \\frac{2}{3}+0\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\frac{7}{9} & \\frac{2}{9} \\\\\n\\frac{1}{3} & \\frac{2}{3}\n\\end{pmatrix}.\n$$\n因此，两步转移概率矩阵如上所示。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{7}{9} & \\frac{2}{9} \\\\ \\frac{1}{3} & \\frac{2}{3}\\end{pmatrix}}$$", "id": "1348076"}, {"introduction": "一致化方法的真正威力在于它将离散时间马尔可夫链与泊松过程巧妙结合，用以计算原始连续时间系统中的转移概率。本练习将展示如何运用完整的一致化级数公式，哪怕只是截取部分项，来近似计算这些概率。通过一个用户网站导航的实例，你将体会到一致化作为一种强大计算工具，在实际问题中的应用价值。[@problem_id:1348067]", "problem": "一个用户在某热门电子商务网站上的导航行为可以被建模为一个连续时间马尔可夫链 (CTMC)。该用户可能处于三个页面之一：“主页”（状态 1）、“产品页”（状态 2）或“联系页”（状态 3）。在时间 $t=0$ 时，用户从“主页”开始。\n\n用户根据以下恒定速率在页面之间转换：\n- 从“主页”到“产品页”：速率 $\\lambda_{12} = 3.0 \\text{ min}^{-1}$。\n- 从“主页”到“联系页”：速率 $\\lambda_{13} = 1.0 \\text{ min}^{-1}$。\n- 从“产品页”到“主页”：速率 $\\lambda_{21} = 2.0 \\text{ min}^{-1}$。\n- 从“联系页”到“主页”：速率 $\\lambda_{31} = 4.0 \\text{ min}^{-1}$。\n所有其他不同状态之间的转移速率均为零。\n\nCTMC 的转移概率 $p_{ij}(t)$ 可以使用一致化方法计算，该方法给出了精确的表达式：\n$$p_{ij}(t) = \\sum_{n=0}^{\\infty} e^{-\\Lambda t} \\frac{(\\Lambda t)^n}{n!} R^n_{ij}$$\n这里，$\\Lambda$ 是一个一致化速率，其选择需满足 $\\Lambda \\ge \\max_{k} |q_{kk}|$，其中 $q_{kk}$ 是生成元矩阵 $Q$ 的对角线元素。矩阵 $R$ 是一个关联的离散时间马尔可夫链的转移矩阵，由 $R = I + \\frac{1}{\\Lambda}Q$ 给出，其中 $I$ 是单位矩阵。项 $R^n_{ij}$ 表示矩阵 $R^n$ 的第 $(i, j)$ 个元素。\n\n通过截断此无穷级数，我们可以得到一个近似值。计算用户在时间 $t$ 位于“产品页”的概率的近似表达式，已知他们从“主页”开始。你的近似值应通过对一致化级数的前两项（$n=0$ 和 $n=1$ 的项）求和来确定。使用一致化速率 $\\Lambda$ 的最小可能值。将你的最终答案表示为时间 $t$ 的解析函数，其中 $t$ 的单位是分钟。", "solution": "我们将导航行为建模为一个连续时间马尔可夫链，其生成元矩阵为 $Q$。根据给定的速率，非对角线上的非零元素为 $q_{12}=3$，$q_{13}=1$，$q_{21}=2$ 和 $q_{31}=4$。对角线元素由 $q_{ii}=-\\sum_{j\\neq i}q_{ij}$ 确定，得到 $q_{11}=-(3+1)=-4$，$q_{22}=-2$ 和 $q_{33}=-4$。因此，\n$$\nQ=\\begin{pmatrix}\n-4 & 3 & 1\\\\\n2 & -2 & 0\\\\\n4 & 0 & -4\n\\end{pmatrix}.\n$$\n一致化速率必须满足 $\\Lambda\\ge\\max_{k}|q_{kk}|$，因此最小的可能选择是 $\\Lambda=4$。定义 $R=I+\\frac{1}{\\Lambda}Q=I+\\frac{1}{4}Q$。代入 $Q$ 并化简可得\n$$\nR=\\begin{pmatrix}\n1+\\frac{1}{4}(-4) & \\frac{1}{4}\\cdot 3 & \\frac{1}{4}\\cdot 1\\\\\n\\frac{1}{4}\\cdot 2 & 1+\\frac{1}{4}(-2) & 0\\\\\n\\frac{1}{4}\\cdot 4 & 0 & 1+\\frac{1}{4}(-4)\n\\end{pmatrix}\n=\\begin{pmatrix}\n0 & \\frac{3}{4} & \\frac{1}{4}\\\\\n\\frac{1}{2} & \\frac{1}{2} & 0\\\\\n1 & 0 & 0\n\\end{pmatrix}.\n$$\n用于计算转移概率的一致化公式为\n$$\np_{ij}(t)=\\sum_{n=0}^{\\infty}\\exp(-\\Lambda t)\\,\\frac{(\\Lambda t)^{n}}{n!}\\,(R^{n})_{ij}.\n$$\n截取前两项（$n=0$ 和 $n=1$）可得近似值\n$$\np_{12}(t)\\approx \\exp(-\\Lambda t)\\left[\\frac{(\\Lambda t)^{0}}{0!}(R^{0})_{12}+\\frac{(\\Lambda t)^{1}}{1!}(R^{1})_{12}\\right].\n$$\n由于 $R^{0}=I$，我们有 $(R^{0})_{12}=0$，且 $(R^{1})_{12}=R_{12}=\\frac{3}{4}$。使用 $\\Lambda=4$，我们得到\n$$\np_{12}(t)\\approx \\exp(-4 t)\\left[0+4 t\\cdot \\frac{3}{4}\\right]=3 t\\,\\exp(-4 t).\n$$\n这就是所求的，从主页开始、在时间 $t$ 位于产品页的概率的解析近似值，该近似值使用了一致化级数的前两项和最小的一致化速率。", "answer": "$$\\boxed{3 t \\exp(-4 t)}$$", "id": "1348067"}]}