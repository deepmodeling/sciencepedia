{"hands_on_practices": [{"introduction": "柯尔莫哥洛夫前向方程不仅是求解迁移动态的工具，也是验证模型有效性的基本准则。本练习将探讨一个假设的离子通道模型，通过直接应用前向微分方程 $P'(t) = P(t)Q$，来检验一个给定的转移概率矩阵 $P(t)$ 是否与系统的生成元矩阵 $Q$ 相一致。这个过程是随机过程建模中的一个关键验证步骤，确保了我们的数学描述能够准确反映系统的基本动态。 [@problem_id:1340356]", "problem": "一个神经细胞膜上单个离子通道的简化模型考虑了两种状态：状态 1 (开放) 和状态 2 (关闭)。这些状态之间的转换被建模为连续时间马尔可夫链。从开放状态到关闭状态的转移率为 $\\lambda > 0$，从关闭状态到开放状态的转移率为 $\\mu > 0$。该系统的动态可以用生成元矩阵 $Q$ 来描述，其中当 $i \\neq j$ 时，元素 $Q_{ij}$ 是从状态 $i$ 到状态 $j$ 的转移率。\n\n这个两状态系统的生成元矩阵由下式给出：\n$$\nQ = \\begin{pmatrix} -\\lambda & \\lambda \\\\ \\mu & -\\mu \\end{pmatrix}\n$$\n\n一位研究者提出了转移概率矩阵 $P(t) = (P_{ij}(t))$ 的一个模型，其中 $P_{ij}(t)$ 是指在时刻 0 处于状态 $i$ 的条件下，通道在时刻 $t$ 处于状态 $j$ 的概率。所提出的矩阵为：\n$$\nP(t) = \\begin{pmatrix} \\exp(-\\lambda t) & 1 - \\exp(-\\lambda t) \\\\ 1 - \\exp(-\\mu t) & \\exp(-\\mu t) \\end{pmatrix}\n$$\n\n对于一个具有生成元 $Q$ 的系统，其有效转移矩阵的一个基本性质是其时间导数 $P'(t)$ 必须满足矩阵微分方程 $P'(t) = P(t)Q$。基于此信息，下列关于所提出的 $P(t)$ 的陈述中，哪一个是正确的？\n\nA. 所提出的矩阵 $P(t)$ 是该系统的一个有效转移矩阵。\n\nB. 所提出的矩阵 $P(t)$ 无效，因为其行和不等于 1。\n\nC. 所提出的矩阵 $P(t)$ 无效，因为它不满足初始条件 $P(0) = I$，其中 $I$ 是单位矩阵。\n\nD. 所提出的矩阵 $P(t)$ 无效，因为它不满足微分方程 $P'(t) = P(t)Q$。", "solution": "我们有一个两状态连续时间马尔可夫链 (CTMC)，其生成元为\n$$\nQ=\\begin{pmatrix}\n-\\lambda & \\lambda\\\\\n\\mu & -\\mu\n\\end{pmatrix},\n$$\n其中 $\\lambda>0$ 是从开放到关闭的速率，$\\mu>0$ 是从关闭到开放的速率。对于一个有效的转移概率矩阵 $P(t)$，必须满足三个关键性质：\n- 行随机性：对于所有 $t\\geq 0$，每行之和为 $1$。\n- 初始条件: $P(0)=I$。\n- 柯尔莫哥洛夫前向方程：对于所有 $t\\geq 0$，有 $P'(t)=P(t)Q$。\n\n所提出的矩阵是\n$$\nP(t)=\\begin{pmatrix}\n\\exp(-\\lambda t) & 1-\\exp(-\\lambda t)\\\\\n1-\\exp(-\\mu t) & \\exp(-\\mu t)\n\\end{pmatrix}.\n$$\n\n首先，检查行和。对于第一行，\n$$\n\\exp(-\\lambda t)+\\bigl(1-\\exp(-\\lambda t)\\bigr)=1.\n$$\n对于第二行，\n$$\n\\bigl(1-\\exp(-\\mu t)\\bigr)+\\exp(-\\mu t)=1.\n$$\n因此每行之和都为 $1$，所以该矩阵是行随机的，选项 B 是错误的。\n\n其次，检查初始条件：\n$$\nP(0)=\\begin{pmatrix}\n\\exp(0) & 1-\\exp(0)\\\\\n1-\\exp(0) & \\exp(0)\n\\end{pmatrix}\n=\\begin{pmatrix}\n1 & 0\\\\\n0 & 1\n\\end{pmatrix}=I.\n$$\n因此，选项 C 是错误的。\n\n第三，检查柯尔莫哥洛夫前向方程 $P'(t)=P(t)Q$。通过逐项微分计算 $P'(t)$：\n$$\nP'(t)=\\begin{pmatrix}\n-\\lambda\\,\\exp(-\\lambda t) & \\lambda\\,\\exp(-\\lambda t)\\\\\n\\mu\\,\\exp(-\\mu t) & -\\mu\\,\\exp(-\\mu t)\n\\end{pmatrix}.\n$$\n现在计算乘积 $P(t)Q$：\n- $(1,1)$ 项：\n$$\n\\exp(-\\lambda t)\\cdot(-\\lambda)+\\bigl(1-\\exp(-\\lambda t)\\bigr)\\cdot\\mu\n= -\\lambda\\,\\exp(-\\lambda t)+\\mu-\\mu\\,\\exp(-\\lambda t)\n= \\mu-(\\lambda+\\mu)\\exp(-\\lambda t).\n$$\n- $(1,2)$ 项：\n$$\n\\exp(-\\lambda t)\\cdot\\lambda+\\bigl(1-\\exp(-\\lambda t)\\bigr)\\cdot(-\\mu)\n= \\lambda\\,\\exp(-\\lambda t)-\\mu+\\mu\\,\\exp(-\\lambda t)\n= -\\mu+(\\lambda+\\mu)\\exp(-\\lambda t).\n$$\n- $(2,1)$ 项：\n$$\n\\bigl(1-\\exp(-\\mu t)\\bigr)\\cdot(-\\lambda)+\\exp(-\\mu t)\\cdot\\mu\n= -\\lambda+\\lambda\\,\\exp(-\\mu t)+\\mu\\,\\exp(-\\mu t)\n= -\\lambda+(\\lambda+\\mu)\\exp(-\\mu t).\n$$\n- $(2,2)$ 项：\n$$\n\\bigl(1-\\exp(-\\mu t)\\bigr)\\cdot\\lambda+\\exp(-\\mu t)\\cdot(-\\mu)\n= \\lambda-\\lambda\\,\\exp(-\\mu t)-\\mu\\,\\exp(-\\mu t)\n= \\lambda-(\\lambda+\\mu)\\exp(-\\mu t).\n$$\n因此\n$$\nP(t)Q=\\begin{pmatrix}\n\\mu-(\\lambda+\\mu)\\exp(-\\lambda t) & -\\mu+(\\lambda+\\mu)\\exp(-\\lambda t)\\\\\n-\\lambda+(\\lambda+\\mu)\\exp(-\\mu t) & \\lambda-(\\lambda+\\mu)\\exp(-\\mu t)\n\\end{pmatrix}.\n$$\n比较 $P'(t)$ 和 $P(t)Q$。对于 $(1,1)$ 项，\n$$\nP'_{11}(t)=-\\lambda\\,\\exp(-\\lambda t),\\quad \\bigl(P(t)Q\\bigr)_{11}=\\mu-(\\lambda+\\mu)\\exp(-\\lambda t).\n$$\n仅当 $\\mu=0$ 时，它们才对所有 $t$ 相等，但这与 $\\mu>0$ 相矛盾。更明确地说，\n$$\nP'_{11}(t)-\\bigl(P(t)Q\\bigr)_{11}=\\mu\\bigl(\\exp(-\\lambda t)-1\\bigr)\\neq 0\n$$\n对于 $t>0$ 成立。因此，对于 $t>0$，有 $P'(t)\\neq P(t)Q$，所以所提出的 $P(t)$ 违反了柯尔莫哥洛夫前向方程。因此，选项 D 是正确的。\n\n为了完整起见，注意到 $P'(0)=Q$ 确实成立：\n$$\nP'(0)=\\begin{pmatrix}\n-\\lambda & \\lambda\\\\\n\\mu & -\\mu\n\\end{pmatrix}=Q,\n$$\n但这并不足够；该等式必须对所有 $t\\geq 0$ 成立，而事实并非如此。\n\n因此，所提出的 $P(t)$ 是无效的，因为它不满足 $P'(t)=P(t)Q$。", "answer": "$$\\boxed{D}$$", "id": "1340356"}, {"introduction": "在许多应用中，我们更关心系统的宏观平均行为，而非每个微观状态的精确概率。本练习将引导你使用柯尔莫哥洛夫前向方程，从描述单个状态概率 $p_n(t)$ 的无限微分方程组中，推导出描述系统期望大小 $M(t)$ 的一个简洁的一阶常微分方程。通过分析一个假设的社交网络用户增长模型，你将掌握一种强大的分析技巧：将复杂的微观描述转化为简洁的宏观模型，这对于理解和预测大规模系统的总体趋势至关重要。[@problem_id:1340377]", "problem": "一个新的去中心化社交网络上线了。上线后任意时刻 $t$ 的活跃用户数 $N(t)$ 被建模为一个连续时间随机过程。用户参与的动态过程由一个线性生灭过程描述。\n\n新用户的“出生”对应于一个个体加入该网络。新用户加入的速率假定与当前活跃用户数 $n$ 成正比，其恒定的人均加入率为 $\\lambda$。因此，从状态 $n$ 转移到状态 $n+1$ 的总速率为 $\\lambda n$。\n\n用户的“死亡”对应于一个个体离开该网络。用户离开的速率也与当前活跃用户数成正比，其恒定的人均离开率为 $\\mu$。因此，从状态 $n$ 转移到状态 $n-1$ 的总速率为 $\\mu n$。对于没有用户的状态（$n=0$），离开速率为零。\n\n设 $p_n(t)$ 为在时刻 $t$ 网络上恰好有 $n$ 个用户的概率。活跃用户的期望数量由 $M(t) = \\sum_{n=0}^{\\infty} n p_n(t)$ 给出。该期望的时间演化可以用一个形如 $\\frac{dM(t)}{dt} = f(M(t))$ 的一阶常微分方程来描述。\n\n确定控制期望用户数变化率的函数 $f(M(t))$。你的答案应该是一个用 $M(t)$、$\\lambda$ 和 $\\mu$ 表示的表达式。", "solution": "设 $N(t)$ 是一个线性生灭过程，其从 $n$ 到 $n+1$ 的转移速率为 $\\lambda n$，从 $n$ 到 $n-1$ 的转移速率为 $\\mu n$。设 $p_{n}(t)$ 表示 $\\Pr(N(t)=n)$，且 $M(t)=\\sum_{n=0}^{\\infty} n p_{n}(t)$。\n\n对于 $n\\geq 1$，Kolmogorov 前向方程为：\n$$\n\\frac{d p_{n}(t)}{dt}=\\lambda (n-1) p_{n-1}(t)+\\mu (n+1) p_{n+1}(t)-(\\lambda n+\\mu n) p_{n}(t),\n$$\n对于 $n=0$，\n$$\n\\frac{d p_{0}(t)}{dt}=\\mu p_{1}(t).\n$$\n对 $M(t)$ 求导，并交换求和与求导的次序：\n$$\n\\frac{dM(t)}{dt}=\\sum_{n=0}^{\\infty} n \\frac{d p_{n}(t)}{dt}=\\sum_{n=1}^{\\infty} n \\frac{d p_{n}(t)}{dt}.\n$$\n代入 $n\\geq 1$ 的前向方程：\n$$\n\\frac{dM(t)}{dt}=\\sum_{n=1}^{\\infty} n\\left[\\lambda (n-1) p_{n-1}(t)+\\mu (n+1) p_{n+1}(t)-(\\lambda+\\mu) n p_{n}(t)\\right].\n$$\n通过指标变换处理每个求和项。对于出生流入项，令 $m=n-1$：\n$$\n\\sum_{n=1}^{\\infty} n \\lambda (n-1) p_{n-1}(t)=\\lambda \\sum_{m=0}^{\\infty} (m+1) m\\, p_{m}(t)=\\lambda \\left(\\sum_{m=0}^{\\infty} m^{2} p_{m}(t)+\\sum_{m=0}^{\\infty} m p_{m}(t)\\right).\n$$\n对于死亡流入项，令 $k=n+1$：\n$$\n\\sum_{n=1}^{\\infty} n \\mu (n+1) p_{n+1}(t)=\\mu \\sum_{k=2}^{\\infty} (k-1) k\\, p_{k}(t)=\\mu \\left(\\sum_{k=0}^{\\infty} k^{2} p_{k}(t)-\\sum_{k=0}^{\\infty} k p_{k}(t)\\right).\n$$\n对于流出项，\n$$\n\\sum_{n=1}^{\\infty} n (\\lambda+\\mu) n p_{n}(t)=(\\lambda+\\mu)\\sum_{n=0}^{\\infty} n^{2} p_{n}(t).\n$$\n引入 $E[N(t)]=M(t)$ 和 $E[N(t)^{2}]=\\sum_{n=0}^{\\infty} n^{2} p_{n}(t)$ 来合并各项：\n$$\n\\frac{dM(t)}{dt}=\\lambda \\left(E[N(t)^{2}]+M(t)\\right)+\\mu \\left(E[N(t)^{2}]-M(t)\\right)-(\\lambda+\\mu) E[N(t)^{2}].\n$$\n$E[N(t)^{2}]$ 项相互抵消，得到\n$$\n\\frac{dM(t)}{dt}=(\\lambda-\\mu) M(t).\n$$\n因此，控制期望用户数变化率的函数是\n$$\nf(M(t))=(\\lambda-\\mu) M(t).\n$$\n等价地，通过该过程的生成元 $\\mathcal{L}$ 作用于 $f(n)=n$，有 $\\mathcal{L}f(n)=\\lambda n[(n+1)-n]+\\mu n[(n-1)-n]=(\\lambda-\\mu) n$，对其取期望会得到相同的结果。", "answer": "$$\\boxed{(\\lambda-\\mu) M(t)}$$", "id": "1340377"}, {"introduction": "分析具有吸收态（即终端状态）的系统是随机过程论中的一个核心课题，在物理学、金融学和可靠性工程等领域都有广泛应用。本练习将带你进入量子点的世界，利用柯尔莫哥洛夫前向方程，推导在系统被吸收前，在各个瞬时态（激发态）中逗留的期望总时间。你将学到如何运用生成元矩阵的子矩阵 $Q_T$ 来计算这一关键性能指标，最终得到一个优雅的矩阵表达式 $M_T = -Q_T^{-1}$，这个结果深刻揭示了系统在“生命周期”结束前的行为特征。[@problem_id:1340402]", "problem": "考虑一个量子点电子行为的简化模型。该量子点有一个基态（我们标记为状态0）和一组 $N$ 个不同的亚稳激发能级（标记为状态 $1, 2, \\dots, N$）。该系统中的一个电子可以在这些状态之间跃迁。其动力学被建模为状态空间 $S = \\{0, 1, 2, \\dots, N\\}$ 上的连续时间马尔可夫链（CTMC）。\n\n基态（状态0）是一个吸收态；一旦电子进入此状态，它将一直保持在该状态。激发能级（状态 $1, 2, \\dots, N$）是瞬时态。从任意状态 $i \\in S$ 到另一状态 $j \\in S$ ($j \\ne i$) 的常数跃迁速率表示为 $q_{ij} \\ge 0$。由于状态0是吸收态，所以对于所有 $j \\in S$，$q_{0j} = 0$。保证系统最终会从任何瞬时态进入吸收态。\n\n该CTMC的生成元矩阵是一个 $(N+1) \\times (N+1)$ 矩阵 $Q$，其非对角线元素为 $Q_{ij} = q_{ij}$，对角线元素为 $Q_{ii} = -\\sum_{j \\ne i} q_{ij}$。设 $Q_T$ 是对应于瞬时态 $\\{1, 2, \\dots, N\\}$ 之间跃迁的 $N \\times N$ 子生成元矩阵。也就是说，对于 $i,j \\in \\{1, \\dots, N\\}$，$Q_T$ 在第 $i$ 行和第 $j$ 列的元素是跃迁速率 $q_{ij}$（如果 $i \\ne j$），以及 $q_{ii}$（如果 $i=j$）。你可以假设 $Q_T$ 是一个可逆矩阵。\n\n假设在时间 $t=0$ 时，电子初始处于激发态 $i \\in \\{1, 2, \\dots, N\\}$。设 $m_{ij}$ 是电子在被吸收进入基态0之前，停留在激发态 $j \\in \\{1, 2, \\dots, N\\}$ 的期望总时间。设 $M_T$ 是一个 $N \\times N$ 矩阵，其在第 $i$ 行和第 $j$ 列的元素是 $m_{ij}$。\n\n使用 Kolmogorov 前向方程，推导 $M_T$ 关于子生成元矩阵 $Q_T$ 的紧凑矩阵表达式。", "solution": "设 $X_{t}$ 是具有生成元 $Q$ 的 CTMC，其在瞬时态 $\\{1,\\dots,N\\}$ 上的子生成元为 $Q_{T}$。固定一个初始激发态 $i \\in \\{1,\\dots,N\\}$。设 $p^{(i)}(t)$ 表示在时间 $t$ 时的瞬时态概率行向量，其分量为 $p^{(i)}_{j}(t) = \\mathbb{P}(X_{t}=j \\mid X_{0}=i)$，其中 $j \\in \\{1,\\dots,N\\}$。根据限制在瞬时态类上的 Kolmogorov 前向方程，\n$$\n\\frac{d}{dt} p^{(i)}(t) = p^{(i)}(t) Q_{T}, \\qquad p^{(i)}(0) = e_{i}^{\\top},\n$$\n其中 $e_{i}$ 是 $\\mathbb{R}^{N}$ 中的第 $i$ 个标准基向量。解为\n$$\np^{(i)}(t) = e_{i}^{\\top} \\exp(Q_{T} t).\n$$\n从状态 $i$ 开始，在被吸收前停留在瞬时态 $j$ 的期望总时间为\n$$\nm_{ij} = \\int_{0}^{\\infty} p^{(i)}_{j}(t)\\, dt = \\int_{0}^{\\infty} \\left(e_{i}^{\\top} \\exp(Q_{T} t)\\right)_{j} \\, dt.\n$$\n将所有 $i$ 的这些期望值作为行堆叠起来，得到矩阵\n$$\nM_{T} = \\int_{0}^{\\infty} \\exp(Q_{T} t)\\, dt.\n$$\n因为保证所有瞬时态都会被吸收且 $Q_{T}$ 可逆，所以 $Q_{T}$ 的谱位于开放的左半平面，因此该积分收敛。使用矩阵微积分，\n$$\nQ_{T} \\int_{0}^{\\infty} \\exp(Q_{T} t)\\, dt = \\left[\\exp(Q_{T} t)\\right]_{0}^{\\infty} = 0 - I,\n$$\n这意味着\n$$\n\\int_{0}^{\\infty} \\exp(Q_{T} t)\\, dt = - Q_{T}^{-1}.\n$$\n因此，\n$$\nM_{T} = - Q_{T}^{-1}.\n$$", "answer": "$$\\boxed{-Q_{T}^{-1}}$$", "id": "1340402"}]}