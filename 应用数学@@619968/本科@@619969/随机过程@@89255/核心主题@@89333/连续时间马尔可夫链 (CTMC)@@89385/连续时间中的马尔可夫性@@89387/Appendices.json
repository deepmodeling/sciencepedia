{"hands_on_practices": [{"introduction": "生成器矩阵 $Q$ 是驱动连续时间马尔可夫链的无穷小“引擎”。每个非对角线元素 $q_{ij}$ 代表了从状态 $i$ 到状态 $j$ 的瞬时转移速率。本练习通过探究一个转移速率为负数时会发生什么，来揭示该矩阵的基本属性。你将发现这个看似简单的错误如何违反了概率论最基本的公理，从而更深刻地理解为何转移速率必须是非负的。[@problem_id:1342651]", "problem": "一位系统分析师正在为一个关键服务器的运行状态开发一个模型，该服务器可以处于三种状态之一：$S = \\{1, 2, 3\\}$，分别对应“在线”、“性能下降”和“离线”。分析师将该系统建模为一个由生成元矩阵 $Q = (q_{ij})$ 控制的连续时间马尔可夫链（CTMC）。在时间间隔 $t$ 内从状态 $i$ 转移到状态 $j$ 的转移概率记为 $P_{ij}(t) = \\mathbb{P}(X(t+s)=j | X(s)=i)$。\n\n所提出的生成元矩阵 $Q$ 被构建为满足两个标准属性：\n1. 对角线元素为非正数：对于所有 $i \\in S$，有 $q_{ii} \\le 0$。\n2. 每行元素之和为零：对于所有 $i \\in S$，有 $\\sum_{j=1}^{3} q_{ij} = 0$。\n\n然而，在审查时发现，该矩阵包含一个错误的元素：从状态 1（“在线”）到状态 2（“性能下降”）的转移率为负，即 $q_{12} < 0$。所有其他非对角线元素均为非负数。\n\n当考虑系统在无穷小时间间隔 $\\Delta t > 0$ 内的演变时，以下哪个陈述描述了由这一个错误元素引起的最直接和最根本的数学矛盾？\n\nA. 该过程的平稳分布（如果存在）无法被归一化为总和为一。\n\nB. 该过程的 Chapman-Kolmogorov 方程被违反，该方程关联了不同时间间隔内的转移概率。\n\nC. 从状态 1 到状态 2 的特定转移的近似概率 $P_{12}(\\Delta t)$ 变为负数，违反了概率论的基本公理。\n\nD. 全概率定律被违反，因为从状态 1 出发的所有可能转移的概率之和 $\\sum_{j=1}^{3} P_{1j}(\\Delta t)$ 偏离了 1。\n\nE. 该过程变为爆炸性的，意味着在有限时间内发生无穷多次状态转移的概率非零。", "solution": "对于连续时间马尔可夫链（CTMC），生成元矩阵 $Q$ 和转移概率矩阵 $P(t)$ 之间的关系由矩阵指数给出：$P(t) = \\exp(Qt)$。对于一个非常小的正时间间隔 $\\Delta t$，我们可以使用指数函数的一阶泰勒展开来近似这个关系：\n$$ P(\\Delta t) \\approx I + Q\\Delta t $$\n其中 $I$ 是单位矩阵。\n\n让我们分析这个矩阵方程的各个分量。在时间间隔 $\\Delta t$ 内从状态 $i$ 转移到状态 $j$ 的概率 $P_{ij}(\\Delta t)$ 可以近似为：\n$$ P_{ij}(\\Delta t) \\approx \\delta_{ij} + q_{ij}\\Delta t $$\n其中 $\\delta_{ij}$ 是克罗内克 δ，当 $i=j$ 时为 1，当 $i \\neq j$ 时为 0。\n\n我们已知所提出的生成元矩阵有一个元素 $q_{12} < 0$。让我们检查这对每个选项的影响。\n\n**选项 C：**\n我们来计算从状态 1 转移到状态 2 的近似概率。在这种情况下，$i=1$ 且 $j=2$，所以 $i \\neq j$ 且 $\\delta_{12}=0$。近似式变为：\n$$ P_{12}(\\Delta t) \\approx q_{12}\\Delta t $$\n由于题目说明 $q_{12} < 0$ 且我们考虑的是一个时间间隔 $\\Delta t > 0$，所以乘积 $q_{12}\\Delta t$ 严格为负。这意味着从状态 1 转移到状态 2 的概率将为负数。根据概率论公理中的定义，概率必须是一个非负数。因此，生成元矩阵中存在负的非对角线元素会导致物理上和数学上都不可能的负转移概率结果。这是一个直接且根本的违规。\n\n**选项 D：**\n我们来检查从状态 1 转移到任何状态的概率之和。\n$$ \\sum_{j=1}^{3} P_{1j}(\\Delta t) = P_{11}(\\Delta t) + P_{12}(\\Delta t) + P_{13}(\\Delta t) $$\n对每一项使用一阶近似：\n$$ \\sum_{j=1}^{3} P_{1j}(\\Delta t) \\approx (\\delta_{11} + q_{11}\\Delta t) + (\\delta_{12} + q_{12}\\Delta t) + (\\delta_{13} + q_{13}\\Delta t) $$\n代入克罗内克 δ 的值：\n$$ \\sum_{j=1}^{3} P_{1j}(\\Delta t) \\approx (1 + q_{11}\\Delta t) + (0 + q_{12}\\Delta t) + (0 + q_{13}\\Delta t) $$\n$$ \\sum_{j=1}^{3} P_{1j}(\\Delta t) \\approx 1 + (q_{11} + q_{12} + q_{13})\\Delta t $$\n题目明确指出，所提出矩阵的行和为零，所以 $q_{11} + q_{12} + q_{13} = 0$。将此代入我们的近似式中：\n$$ \\sum_{j=1}^{3} P_{1j}(\\Delta t) \\approx 1 + (0)\\Delta t = 1 $$\n在一阶近似 $\\Delta t$ 下，全概率定律是守恒的；概率之和保持为 1。因此，选项 D 是不正确的。这是一个常见的误解，因为行和为零的属性能够正确地保持总概率，即使个别的转移率/概率是无意义的。\n\n**选项 A：**\n平稳分布与链的长期行为（当 $t \\to \\infty$ 时）有关。虽然一个有缺陷的生成元矩阵确实会阻止一个与现实世界过程相对应的有效平稳分布的存在，但最 *直接* 和 *无穷小* 的后果与平稳分布无关，而是与短期转移概率有关。因此，A 不是最佳答案。\n\n**选项 B：**\nChapman-Kolmogorov 方程是底层随机过程具有马尔可夫性的宏观结果。负概率的存在是微观的、公理上的失败。由于基本概率 $P_{ij}(\\Delta t)$ 是不合理的，建立在其上的整个理论结构，包括 Chapman-Kolmogorov 方程，将不可避免地崩溃。然而，负概率是原因，而违反 Chapman-Kolmogorov 方程是结果。因此，C 描述了一个更直接、更根本的矛盾。\n\n**选项 E：**\nCTMC 中的爆炸过程是指在有限时间内可能发生无穷次跳跃的过程。这种现象与状态的离开率有关。对于有限状态空间，这种情况不会发生，因为所有的离开率 $-q_{ii} = \\sum_{j \\neq i} q_{ij}$ 都是有限的。对于无限状态空间，这是一个需要考虑的问题，但它与非对角线元素的符号无关。因此，E 是不正确的。\n\n结论：最直接和最根本的缺陷是特定转移的近似概率变为负数，这违反了概率论的基本公理。", "answer": "$$\\boxed{C}$$", "id": "1342651"}, {"introduction": "连续时间马尔可夫性质的基石是“无记忆性”，在数学上这等价于状态的“持有时间”服从指数分布。这意味着过程的未来演化仅取决于当前状态，而与过程在该状态停留了多久无关。本练习提供了一个实际的建模场景，其中一个被提出的持有时间模型较为复杂。通过强制施加马尔可夫条件，你将亲身体会这一强大性质如何简化系统动力学，并让你能够计算出恒定的转移速率。[@problem_id:1342681]", "problem": "一家公司正在对城市中三个热门枢纽——Central Station (S)、University Campus (U) 和 Tech Park (P)——之间的共享电动自行车移动进行建模。令 $X(t)$ 为某一特定自行车在时间 $t$ 所在的枢纽。自行车在某个枢纽被归还后，会等待下一位用户。这段持续时间被称为“持有时间”(holding time)。\n\n分析师们为 University Campus (U) 的持有时间提出了一个复杂的模型。他们假设，持有时间的统计特性取决于自行车刚刚到达的枢纽，该枢纽可以是 Central Station (S) 或 Tech Park (P)。根据他们的模型，在给定自行车从枢纽 $j \\in \\{S, P\\}$ 到达的条件下，其在枢纽 U 的持有时间的风险率 $h_{U|j}(t)$ 由以下函数描述：\n$$ h_{U|j}(t) = \\frac{\\alpha_j + \\beta_j t}{1 + \\gamma_j t} $$\n此处，$t$ 代表自行车到达枢纽 U 后经过的时间。参数 $\\alpha_j, \\beta_j$, 和 $\\gamma_j$ 是取决于始发枢纽 $j$ 的正常数。\n\n要使由过程 $X(t)$ 表示的自行车移动能被正确地描述为连续时间马尔可夫链 (CTMC)，任何给定枢纽的持有时间分布都必须是指数分布，并且其速率参数必须仅取决于当前枢纽，而与自行车来自哪个枢纽无关。\n\n此外，一项独立的系统范围分析提供了模型参数之间的以下关系：\n1.  $\\beta_S + \\beta_P = 30$\n2.  $\\gamma_S + \\gamma_P = 5$\n3.  $\\beta_S = \\frac{2}{3} \\beta_P$\n4.  $\\alpha_S = \\frac{\\beta_S}{2}$\n\n假设自行车移动满足作为 CTMC 的条件，计算自行车离开 University Campus 枢纽的恒定转移率。以单一数值形式提供您的答案。", "solution": "在枢纽 U 给定的条件风险率为 $h_{U|j}(t) = \\frac{\\alpha_{j} + \\beta_{j} t}{1 + \\gamma_{j} t}$，其中 $j \\in \\{S, P\\}$。为了使 $X(t)$ 成为一个连续时间马尔可夫链，在枢纽 U 的持有时间必须服从指数分布，其速率仅取决于 U，而与始发枢纽无关。因此，必须存在一个常数 $\\lambda_{U}$，使得对于所有的 $j \\in \\{S, P\\}$ 和所有的 $t \\ge 0$，\n$$\n\\frac{\\alpha_{j} + \\beta_{j} t}{1 + \\gamma_{j} t} = \\lambda_{U}.\n$$\n在恒等式\n$$\n\\alpha_{j} + \\beta_{j} t = \\lambda_{U} \\left(1 + \\gamma_{j} t\\right),\n$$\n中，比较常数项与 $t$ 的系数，我们对每个 $j$ 得到：\n$$\n\\alpha_{j} = \\lambda_{U}, \\quad \\beta_{j} = \\lambda_{U} \\gamma_{j}.\n$$\n因此 $\\alpha_{S} = \\alpha_{P} = \\lambda_{U}$ 并且 $\\beta_{j}/\\gamma_{j} = \\lambda_{U}$。\n\n根据所给的关系式，\n$$\n\\beta_{S} + \\beta_{P} = 30, \\quad \\beta_{S} = \\frac{2}{3}\\beta_{P}.\n$$\n代入可得\n$$\n\\frac{2}{3}\\beta_{P} + \\beta_{P} = \\frac{5}{3}\\beta_{P} = 30 \\;\\Rightarrow\\; \\beta_{P} = 18, \\quad \\beta_{S} = 12.\n$$\n另外，\n$$\n\\alpha_{S} = \\frac{\\beta_{S}}{2} = \\frac{12}{2} = 6.\n$$\n根据 CTMC 的要求，$\\alpha_{S} = \\lambda_{U}$，因此\n$$\n\\lambda_{U} = 6.\n$$\n这与 $\\beta_{j} = \\lambda_{U}\\gamma_{j}$ 和 $\\gamma_{S} + \\gamma_{P} = 5$ 一致，因为\n$$\n\\gamma_{S} = \\frac{\\beta_{S}}{\\lambda_{U}} = \\frac{12}{6} = 2, \\quad \\gamma_{P} = \\frac{\\beta_{P}}{\\lambda_{U}} = \\frac{18}{6} = 3, \\quad \\gamma_{S} + \\gamma_{P} = 5.\n$$\n因此，离开 University Campus 枢纽的恒定转移率是 $\\lambda_{U} = 6$。", "answer": "$$\\boxed{6}$$", "id": "1342681"}, {"introduction": "许多现实世界系统，从生态系统到细胞过程，都由多个相互作用的组件构成。当整个系统是马尔可夫过程时，单独观察其中一个组件，它本身还是马尔可夫的吗？本练习使用一个简洁的基因表达模型来探讨这个关键问题。通过分析信使核糖核酸（mRNA）的产生和蛋白质翻译之间的依赖关系，你将学会如何判断马尔可夫性质在子系统中是否得以保持，以及它何时会因为依赖于系统中其他未观测部分的信息而被破坏。[@problem_id:1342680]", "problem": "在一个单个细胞内基因表达的简化模型中，我们追踪一个特定基因的信使RNA（mRNA）分子的数量，用随机过程 $\\{X_t, t \\ge 0\\}$ 表示，以及由该mRNA翻译而来的蛋白质分子的数量，用 $\\{Y_t, t \\ge 0\\}$ 表示。在任意时刻 $t$，系统的状态由数对 $(X_t, Y_t)$ 给出。这些过程根据以下规则演化，其中 $\\alpha, \\beta, \\gamma, \\delta$ 是正常数率：\n\n1.  **转录**：新的mRNA分子以恒定速率 $\\alpha$ 产生。这对应于从状态 $(x, y)$ 到 $(x+1, y)$ 的转移。\n2.  **mRNA降解**：每个mRNA分子以速率 $\\beta$ 独立降解。这对应于从状态 $(x, y)$ 到 $(x-1, y)$ 的转移，总速率为 $\\beta x$。\n3.  **翻译**：每个mRNA分子以速率 $\\gamma$ 独立地产生蛋白质分子。这对应于从状态 $(x, y)$ 到 $(x, y+1)$ 的转移，总速率为 $\\gamma x$。\n4.  **蛋白质降解**：每个蛋白质分子以速率 $\\delta$ 独立降解。这对应于从状态 $(x, y)$ 到 $(x, y-1)$ 的转移，总速率为 $\\delta y$。\n\n联合过程 $\\{(X_t, Y_t), t \\ge 0\\}$ 是一个连续时间马尔可夫链（CTMC）。CTMC是满足马尔可夫性质的随机过程，即过程未来状态的条件概率分布仅依赖于当前状态，而与之前的事件序列无关。\n\n根据对该系统的描述，以下关于单个边缘过程 $\\{X_t, t \\ge 0\\}$ 和 $\\{Y_t, t \\ge 0\\}$ 的陈述中，哪一个是正确的？\n\nA. $\\{X_t\\}$ 是一个CTMC，但 $\\{Y_t\\}$ 不是。\n\nB. $\\{Y_t\\}$ 是一个CTMC，但 $\\{X_t\\}$ 不是。\n\nC. $\\{X_t\\}$ 和 $\\{Y_t\\}$ 都是CTMC。\n\nD. $\\{X_t\\}$ 和 $\\{Y_t\\}$ 都不是CTMC。\n\nE. 联合过程 $\\{(X_t, Y_t)\\}$ 不是一个CTMC，因此关于边缘过程的问题是不适定的。", "solution": "我们在状态空间 $\\mathbb{Z}_{\\ge 0}\\times \\mathbb{Z}_{\\ge 0}$ 上对联合过程 $\\{(X_t, Y_t), t \\ge 0\\}$ 进行建模，其转移和速率如下：\n- $(x,y)\\to (x+1,y)$ 速率为 $\\alpha$，\n- $(x,y)\\to (x-1,y)$ 速率为 $\\beta x$，\n- $(x,y)\\to (x,y+1)$ 速率为 $\\gamma x$，\n- $(x,y)\\to (x,y-1)$ 速率为 $\\delta y$，\n其中 $\\alpha, \\beta, \\gamma, \\delta > 0$。这些是标准的线性反应，意味着这是一个关于数对的连续时间马尔可夫链，因为跳跃强度仅依赖于当前状态 $(x,y)$。\n\n我们通过检查在给定当前边缘状态的条件下，无穷小转移概率是否仅依赖于该边缘状态，来评估每个边缘过程本身是否为CTMC。\n\n对于 $\\{X_t\\}$，固定 $x \\in \\mathbb{Z}_{\\ge 0}$。给定 $X_t=x$，在一个小区间 $(t,t+h]$ 内，\n$$\n\\mathbb{P}(X_{t+h}=x+1\\mid X_t=x,\\text{全部历史})=\\alpha h+o(h),\n$$\n$$\n\\mathbb{P}(X_{t+h}=x-1\\mid X_t=x,\\text{全部历史})=\\beta x\\, h+o(h),\n$$\n和\n$$\n\\mathbb{P}(X_{t+h}=x\\mid X_t=x,\\text{全部历史})=1-(\\alpha+\\beta x)h+o(h).\n$$\n这些强度仅依赖于 $x$，而不依赖于 $y$ 或过去的历史；因此 $\\{X_t\\}$ 是一个出生率为 $\\alpha$、死亡率为 $\\beta x$ 的生灭过程CTMC。\n\n对于 $\\{Y_t\\}$，固定 $y \\in \\mathbb{Z}_{\\ge 0}$。给定联合状态 $(x,y)$，在一个小区间 $(t,t+h]$ 内，\n$$\n\\mathbb{P}(Y_{t+h}=y+1\\mid (X_t,Y_t)=(x,y))=\\gamma x\\, h+o(h),\n$$\n$$\n\\mathbb{P}(Y_{t+h}=y-1\\mid (X_t,Y_t)=(x,y))=\\delta y\\, h+o(h),\n$$\n和\n$$\n\\mathbb{P}(Y_{t+h}=y\\mid (X_t,Y_t)=(x,y))=1-(\\gamma x+\\delta y)h+o(h).\n$$\n向下的强度 $\\delta y$ 仅依赖于 $y$，但向上的强度 $\\gamma x$ 依赖于未观测到的 $x$。因此，仅在 $Y_t=y$ 的条件下，\n$$\n\\mathbb{P}(Y_{t+h}=y+1\\mid Y_t=y,\\text{全部历史})=\\gamma\\,\\mathbb{E}[X_t\\mid Y_t=y,\\text{全部历史}]\\,h+o(h),\n$$\n这通常会通过关于 $X_t$ 的信息而依赖于过去，而不仅仅是依赖于 $y$。具体来说，从两个不同的联合状态 $(x_1,y)$ 和 $(x_2,y)$（其中 $x_1 \\neq x_2$）出发，$Y$ 增加的瞬时速率分别为 $\\gamma x_1$ 和 $\\gamma x_2$；不存在一个仅关于 $y$ 的函数可以同时等于这两个值。因此 $\\{Y_t\\}$ 不满足马尔可夫性质，不是一个CTMC。\n\n根据其构造，联合过程是一个CTMC，因此该问题是适定的。因此，$\\{X_t\\}$ 是一个CTMC，而 $\\{Y_t\\}$ 不是。", "answer": "$$\\boxed{A}$$", "id": "1342680"}]}