{"hands_on_practices": [{"introduction": "要真正掌握几何布朗运动，理解其核心参数——漂移率 $\\mu$ 和波动率 $\\sigma$ ——如何塑造未来的价格分布至关重要。本练习提供了一种实践方法：要求您根据股票在未来某一天的期望值和方差，反向推导出这些参数。通过解决这个问题，您将具体理解 $\\mu$ 如何控制平均增长趋势，以及 $\\sigma$ 如何决定围绕该趋势的风险或离散程度。[@problem_id:1304943]", "problem": "一个不支付股息的股票的价格演变由几何布朗运动 (GBM) 建模，它是一个连续时间随机过程。股票价格 $S_t$ 由以下随机微分方程描述：\n$$dS_t = \\mu S_t dt + \\sigma S_t dW_t$$\n其中 $t$ 是以年为单位的时间，$\\mu$ 是恒定的年漂移系数，$\\sigma$ 是恒定的年波动率系数，而 $W_t$ 是一个标准维纳过程。\n\n假设该股票的初始价格为 $S_0 = 100$。经过 $t=2$ 年后，观测到该股票价格的期望值为 $E[S_2] = 110$，股票价格的方差为 $Var(S_2) = 484$。\n\n根据这些信息，确定年漂移系数 $\\mu$ 和年波动率系数 $\\sigma$ 的精确解析表达式。", "solution": "该问题要求我们在给定初始值、以及未来某一时刻的期望值和方差的情况下，求出几何布朗运动 (GBM) 过程的参数 $\\mu$ 和 $\\sigma$。\n\nGBM的随机微分方程 (SDE) 为 $dS_t = \\mu S_t dt + \\sigma S_t dW_t$。\n该随机微分方程的解由下式给出：\n$$S_t = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t \\right)$$\n其中 $W_t$ 是一个标准维纳过程，意味着 $W_t$ 服从均值为0、方差为$t$的正态分布，即 $W_t \\sim N(0, t)$。\n\n令指数为一个随机变量 $X_t = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t$。\n由于 $W_t \\sim N(0, t)$，随机变量 $X_t$ 也服从正态分布。其均值为：\n$$E[X_t] = E\\left[ \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t \\right] = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma E[W_t] = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t$$\n其方差为：\n$$Var(X_t) = Var\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t \\right) = \\sigma^2 Var(W_t) = \\sigma^2 t$$\n所以，$X_t \\sim N\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t, \\sigma^2 t \\right)$。\n\n股票价格 $S_t = S_0 \\exp(X_t)$ 服从对数正态分布。我们可以利用对数正态分布的性质来求其期望值 $E[S_t]$ 和方差 $Var(S_t)$。对于一个服从正态分布的变量 $Y \\sim N(\\alpha, \\beta^2)$，$\\exp(Y)$ 的期望值为 $E[\\exp(Y)] = \\exp(\\alpha + \\frac{1}{2}\\beta^2)$。\n\n将此应用于求 $E[S_t]$：\n$E[S_t] = E[S_0 \\exp(X_t)] = S_0 E[\\exp(X_t)]$。\n此处，$\\alpha = E[X_t] = (\\mu - \\frac{1}{2}\\sigma^2)t$ 且 $\\beta^2 = Var(X_t) = \\sigma^2 t$。\n$$E[S_t] = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\frac{1}{2}(\\sigma^2 t) \\right) = S_0 \\exp\\left(\\mu t - \\frac{1}{2}\\sigma^2 t + \\frac{1}{2}\\sigma^2 t\\right)$$\n$$E[S_t] = S_0 \\exp(\\mu t)$$\n\n为了求方差，我们首先求出二阶矩 $E[S_t^2]$。\n$E[S_t^2] = E[(S_0 \\exp(X_t))^2] = S_0^2 E[\\exp(2X_t)]$。\n使用性质 $E[\\exp(kY)] = \\exp(k\\alpha + \\frac{1}{2}k^2 \\beta^2)$，并令 $k=2$：\n$$E[S_t^2] = S_0^2 \\exp\\left( 2\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\frac{1}{2}(2^2)(\\sigma^2 t) \\right) = S_0^2 \\exp\\left( 2\\mu t - \\sigma^2 t + 2\\sigma^2 t \\right)$$\n$$E[S_t^2] = S_0^2 \\exp(2\\mu t + \\sigma^2 t)$$\n方差为 $Var(S_t) = E[S_t^2] - (E[S_t])^2$。\n$$Var(S_t) = S_0^2 \\exp(2\\mu t + \\sigma^2 t) - (S_0 \\exp(\\mu t))^2 = S_0^2 \\exp(2\\mu t + \\sigma^2 t) - S_0^2 \\exp(2\\mu t)$$\n$$Var(S_t) = S_0^2 \\exp(2\\mu t) (\\exp(\\sigma^2 t) - 1)$$\n注意到 $S_0 \\exp(\\mu t) = E[S_t]$，所以我们可以将其写为：\n$$Var(S_t) = (E[S_t])^2 (\\exp(\\sigma^2 t) - 1)$$\n\n现在我们使用给定的数值：$S_0 = 100$, $t=2$, $E[S_2] = 110$ 以及 $Var(S_2) = 484$。\n\n首先，我们使用期望值的公式来求解 $\\mu$：\n$$E[S_2] = S_0 \\exp(2\\mu)$$\n$$110 = 100 \\exp(2\\mu)$$\n$$\\exp(2\\mu) = \\frac{110}{100} = \\frac{11}{10}$$\n对等式两边取自然对数：\n$$2\\mu = \\ln\\left(\\frac{11}{10}\\right)$$\n$$\\mu = \\frac{1}{2}\\ln\\left(\\frac{11}{10}\\right)$$\n\n接下来，我们使用方差的公式来求解 $\\sigma$：\n$$Var(S_2) = (E[S_2])^2 (\\exp(2\\sigma^2) - 1)$$\n$$484 = (110)^2 (\\exp(2\\sigma^2) - 1)$$\n$$484 = 12100 (\\exp(2\\sigma^2) - 1)$$\n$$\\exp(2\\sigma^2) - 1 = \\frac{484}{12100} = \\frac{4 \\times 121}{100 \\times 121} = \\frac{4}{100} = \\frac{1}{25}$$\n$$\\exp(2\\sigma^2) = 1 + \\frac{1}{25} = \\frac{26}{25}$$\n对等式两边取自然对数：\n$$2\\sigma^2 = \\ln\\left(\\frac{26}{25}\\right)$$\n$$\\sigma^2 = \\frac{1}{2}\\ln\\left(\\frac{26}{25}\\right)$$\n由于波动率 $\\sigma$ 必须为非负值，我们取正平方根：\n$$\\sigma = \\sqrt{\\frac{1}{2}\\ln\\left(\\frac{26}{25}\\right)}$$\n\n参数的精确解析表达式为 $\\mu = \\frac{1}{2}\\ln\\left(\\frac{11}{10}\\right)$ 和 $\\sigma = \\sqrt{\\frac{1}{2}\\ln\\left(\\frac{26}{25}\\right)}$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2}\\ln\\left(\\frac{11}{10}\\right) & \\sqrt{\\frac{1}{2}\\ln\\left(\\frac{26}{25}\\right)} \\end{pmatrix}}$$", "id": "1304943"}, {"introduction": "在理解了模型参数之后，下一步就是运用模型进行实际的预测。本练习要求您计算一个关键的风险指标：一项资产在经过一段时间后，其价格低于初始价格的概率。对于任何投资者来说，这都是一个基本问题，而解决它需要您运用作为几何布朗运动基础的对数正态分布的性质。[@problem_id:1304937]", "problem": "一位金融分析师使用几何布朗运动 (GBM) 来为一种高波动性数字资产的价格 $S_t$ 建模。在时间 $t$（以年为单位）的价格由以下公式给出：\n$$S_t = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t \\right)$$\n其中 $S_0$ 是初始价格，$\\mu$ 是恒定的年化期望收益率（漂移率），$\\sigma$ 是恒定的年化波动率，而 $W_t$ 是一个标准维纳过程。对于一个标准维纳过程，其在时间 $t$ 的值 $W_t$ 服从均值为0，方差为 $t$ 的正态分布。\n\n该资产的年化期望收益率为 $\\mu = 0.20$，年化波动率为 $\\sigma = 0.40$。\n\n在 $T = 1.5$ 年后，该资产的价格 $S_T$ 低于其初始价格 $S_0$ 的概率是多少？请将此概率计算为小数。将您的最终答案保留四位有效数字。", "solution": "我们要求在 GBM 模型下 $S_{T}<S_{0}$ 的概率。\n$$\nS_{t}=S_{0}\\exp\\left(\\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)t+\\sigma W_{t}\\right).\n$$\n取自然对数并减去 $\\ln S_{0}$，得到对数回报率：\n$$\nY:=\\ln\\left(\\frac{S_{T}}{S_{0}}\\right)=\\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)T+\\sigma W_{T}.\n$$\n由于 $W_{T}\\sim \\mathcal{N}(0,T)$，因此 $Y\\sim \\mathcal{N}(m,s^{2})$，其中\n$$\nm=\\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)T,\\qquad s=\\sigma\\sqrt{T}.\n$$\n因此，\n$$\n\\mathbb{P}(S_{T}<S_{0})=\\mathbb{P}\\!\\left(\\ln\\!\\left(\\frac{S_{T}}{S_{0}}\\right)<0\\right)=\\mathbb{P}(Y<0)=\\mathbb{P}\\!\\left(\\frac{Y-m}{s}<-\\frac{m}{s}\\right)=\\Phi\\!\\left(-\\frac{m}{s}\\right),\n$$\n其中 $\\Phi$ 是标准正态累积分布函数。\n\n当 $\\mu=1/5$，$\\sigma=2/5$，以及 $T=3/2$ 时，我们计算：\n$$\nm=\\left(\\frac{1}{5}-\\frac{1}{2}\\cdot\\frac{4}{25}\\right)\\cdot\\frac{3}{2}=\\left(\\frac{1}{5}-\\frac{2}{25}\\right)\\cdot\\frac{3}{2}=\\frac{3}{25}\\cdot\\frac{3}{2}=\\frac{9}{50},\n$$\n$$\ns=\\sigma\\sqrt{T}=\\frac{2}{5}\\sqrt{\\frac{3}{2}}=\\frac{2\\sqrt{3}}{5\\sqrt{2}}.\n$$\n因此：\n$$\n-\\frac{m}{s}=-\\frac{\\frac{9}{50}}{\\frac{2\\sqrt{3}}{5\\sqrt{2}}}=-\\frac{9\\sqrt{2}}{20\\sqrt{3}}=-\\frac{3\\sqrt{6}}{20},\n$$\n所以：\n$$\n\\mathbb{P}(S_{T}<S_{0})=\\Phi\\!\\left(-\\frac{3\\sqrt{6}}{20}\\right)=\\frac{1}{2}\\left[1-\\operatorname{erf}\\!\\left(\\frac{3\\sqrt{3}}{20}\\right)\\right].\n$$\n数值上，这约等于 $0.3566515868$，保留四位有效数字为 $0.3567$。", "answer": "$$\\boxed{0.3567}$$", "id": "1304937"}, {"introduction": "理论模型的优劣取决于其描述真实世界数据的能力。最后的这个实践将带您从理论走向应用，要求您从一系列观测到的价格中推导出 $\\mu$ 和 $\\sigma$ 的估计量。通过使用最大似然估计法，您将学习如何将几何布朗运动模型“拟合”到数据上，这是任何量化金融从业者必备的核心技能。[@problem_id:1304938]", "problem": "一位量化分析师正在对一只股票的价格进行建模，该价格在时间 $t$ 记为 $S_t$。该分析师假设股票价格遵循几何布朗运动 (GBM)，它由以下随机微分方程描述：\n$$dS_t = \\mu S_t dt + \\sigma S_t dW_t$$\n其中 $\\mu$ 是恒定的漂移率，$\\sigma$ 是恒定的波动率，$W_t$ 是一个标准维纳过程。\n\n该分析师收集了一系列 $n+1$ 个价格观测值 $S_0, S_1, \\ldots, S_n$，这些数据是在离散的、等间隔的时间区间 $\\Delta t$ 上记录的。因此，观测值 $S_i$ 对应于时间 $t_i = i\\Delta t$ 的价格。\n\nGBM 模型的一个关键特性是，这些时间区间上的对数收益率是独立同分布的。具体来说，如果我们将对数收益率定义为 $X_i = \\ln(S_i / S_{i-1})$，其中 $i = 1, 2, \\ldots, n$，那么每个 $X_i$ 都是一个服从正态分布的随机变量，其均值为 $\\nu = (\\mu - \\frac{1}{2}\\sigma^2)\\Delta t$，方差为 $\\tau^2 = \\sigma^2 \\Delta t$。\n\n你的任务是为漂移率 $\\mu$ 和波动率 $\\sigma$ 推导最大似然估计量 (MLEs)，记为 $\\hat{\\mu}$ 和 $\\hat{\\sigma}$。请用观测价格 $S_0, S_1, \\ldots, S_n$、对数收益率的总数 $n$ 以及时间步长 $\\Delta t$ 来表示这些估计量。将你的最终答案以一个行矩阵的形式呈现，其中包含按 $(\\hat{\\mu}, \\hat{\\sigma})$ 顺序排列的估计量。", "solution": "在 GBM 模型下，定义对数收益率 $X_{i}=\\ln\\!\\left(\\frac{S_{i}}{S_{i-1}}\\right)$，其中 $i=1,\\ldots,n$。那么 $X_{1},\\ldots,X_{n}$ 是独立同分布的正态变量，其均值为 $\\nu=(\\mu-\\frac{1}{2}\\sigma^{2})\\Delta t$，方差为 $\\tau^{2}=\\sigma^{2}\\Delta t$。\n\n给定 $x_{1},\\ldots,x_{n}$，$(\\nu,\\tau^{2})$ 的似然函数是：\n$$\nL(\\nu,\\tau^{2})=\\prod_{i=1}^{n}\\frac{1}{\\sqrt{2\\pi\\tau^{2}}}\\exp\\!\\left(-\\frac{(x_{i}-\\nu)^{2}}{2\\tau^{2}}\\right).\n$$\n对数似然函数是：\n$$\n\\ell(\\nu,\\tau^{2})=-\\frac{n}{2}\\ln(2\\pi)-\\frac{n}{2}\\ln(\\tau^{2})-\\frac{1}{2\\tau^{2}}\\sum_{i=1}^{n}(x_{i}-\\nu)^{2}.\n$$\n对 $\\nu$ 求导并令其为零：\n$$\n\\frac{\\partial \\ell}{\\partial \\nu}=\\frac{1}{\\tau^{2}}\\sum_{i=1}^{n}(x_{i}-\\nu)=0\n\\;\\;\\Longrightarrow\\;\\; \\hat{\\nu}=\\bar{X},\\quad \\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i}.\n$$\n对 $\\tau^{2}$ 求导并令其为零：\n$$\n\\frac{\\partial \\ell}{\\partial \\tau^{2}}=-\\frac{n}{2}\\frac{1}{\\tau^{2}}+\\frac{1}{2}\\frac{1}{(\\tau^{2})^{2}}\\sum_{i=1}^{n}(x_{i}-\\nu)^{2}=0\n\\;\\;\\Longrightarrow\\;\\; \\hat{\\tau}^{2}=\\frac{1}{n}\\sum_{i=1}^{n}(x_{i}-\\hat{\\nu})^{2}.\n$$\n使用参数关系 $\\nu=(\\mu-\\frac{1}{2}\\sigma^{2})\\Delta t$ 和 $\\tau^{2}=\\sigma^{2}\\Delta t$，通过代入法得到 $(\\mu,\\sigma)$ 的最大似然估计量：\n$$\n\\hat{\\sigma}^{2}=\\frac{\\hat{\\tau}^{2}}{\\Delta t}=\\frac{1}{n\\Delta t}\\sum_{i=1}^{n}\\left(X_{i}-\\bar{X}\\right)^{2},\n\\quad\n\\hat{\\mu}=\\frac{\\hat{\\nu}}{\\Delta t}+\\frac{1}{2}\\hat{\\sigma}^{2}=\\frac{\\bar{X}}{\\Delta t}+\\frac{1}{2}\\hat{\\sigma}^{2},\n$$\n其中 $\\hat{\\sigma}$ 取正平方根。用价格显式地写出：\n$$\n\\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}\\ln\\!\\left(\\frac{S_{i}}{S_{i-1}}\\right),\\quad\n\\sum_{i=1}^{n}\\left(X_{i}-\\bar{X}\\right)^{2}=\\sum_{i=1}^{n}\\left(\\ln\\!\\left(\\frac{S_{i}}{S_{i-1}}\\right)-\\frac{1}{n}\\sum_{j=1}^{n}\\ln\\!\\left(\\frac{S_{j}}{S_{j-1}}\\right)\\right)^{2}.\n$$\n因此：\n$$\n\\hat{\\mu}=\\frac{1}{\\Delta t}\\left(\\frac{1}{n}\\sum_{i=1}^{n}\\ln\\!\\left(\\frac{S_{i}}{S_{i-1}}\\right)\\right)+\\frac{1}{2}\\left(\\frac{1}{n\\Delta t}\\sum_{i=1}^{n}\\left(\\ln\\!\\left(\\frac{S_{i}}{S_{i-1}}\\right)-\\frac{1}{n}\\sum_{j=1}^{n}\\ln\\!\\left(\\frac{S_{j}}{S_{j-1}}\\right)\\right)^{2}\\right),\n$$\n$$\n\\hat{\\sigma}=\\sqrt{\\frac{1}{n\\Delta t}\\sum_{i=1}^{n}\\left(\\ln\\!\\left(\\frac{S_{i}}{S_{i-1}}\\right)-\\frac{1}{n}\\sum_{j=1}^{n}\\ln\\!\\left(\\frac{S_{j}}{S_{j-1}}\\right)\\right)^{2}}.\n$$\n等价地，使用伸缩恒等式 $\\sum_{i=1}^{n}\\ln(S_{i}/S_{i-1})=\\ln(S_{n}/S_{0})$，可以写出 $\\hat{\\mu}=\\frac{1}{n\\Delta t}\\ln(S_{n}/S_{0})+\\frac{1}{2}\\hat{\\sigma}^{2}$，其中 $\\hat{\\sigma}$ 与上文相同。", "answer": "$$\\boxed{\\begin{pmatrix}\\dfrac{1}{\\Delta t}\\left(\\dfrac{1}{n}\\sum_{i=1}^{n}\\ln\\!\\left(\\dfrac{S_{i}}{S_{i-1}}\\right)\\right)+\\dfrac{1}{2}\\left(\\dfrac{1}{n\\Delta t}\\sum_{i=1}^{n}\\left(\\ln\\!\\left(\\dfrac{S_{i}}{S_{i-1}}\\right)-\\dfrac{1}{n}\\sum_{j=1}^{n}\\ln\\!\\left(\\dfrac{S_{j}}{S_{j-1}}\\right)\\right)^{2}\\right) & \\sqrt{\\dfrac{1}{n\\Delta t}\\sum_{i=1}^{n}\\left(\\ln\\!\\left(\\dfrac{S_{i}}{S_{i-1}}\\right)-\\dfrac{1}{n}\\sum_{j=1}^{n}\\ln\\!\\left(\\dfrac{S_{j}}{S_{j-1}}\\right)\\right)^{2}}\\end{pmatrix}}$$", "id": "1304938"}]}