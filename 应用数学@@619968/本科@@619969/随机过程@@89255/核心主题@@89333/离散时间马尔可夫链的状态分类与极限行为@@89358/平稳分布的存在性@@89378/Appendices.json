{"hands_on_practices": [{"introduction": "在许多现实世界的系统中，特别是工程设计的系统中，对称性是一个关键特征。本练习将探讨这种对称性如何反映在马尔可夫链的长期行为中，以一个服务器集群中的负载均衡算法为例 [@problem_id:1300471]。我们将发现一个强大的捷径，即通过识别一类特殊的转移矩阵——双随机矩阵，来快速确定其平稳分布。", "problem": "一个小型云计算集群由$N=5$台相同的服务器组成，编号为1到5。为了确保均匀利用，实现了一种动态的“作业重排”算法。在每个离散时间间隔结束时，会对当前在某台服务器上运行的单个计算作业进行评估，以决定是否迁移。该算法的规则如下：作业有$\\alpha = 0.6$的概率保留在其当前服务器上；有$1-\\alpha$的概率被迁移。\n\n如果决定迁移，该作业将被移动到其他$N-1$台服务器中的一台，每台目标服务器被选中的概率相等。\n\n这个过程可以被建模为一个有限状态马尔可夫链，其中系统的状态是作业所在的服务器编号。设$P$为该链的转移矩阵。平稳分布是一个概率行向量$\\pi = (\\pi_1, \\pi_2, \\dots, \\pi_N)$，其分量之和为1，代表了在每个服务器上找到该作业的长期概率，并且满足方程$\\pi P = \\pi$。\n\n假设系统已运行了很长时间并达到了平衡状态，请确定其平稳分布$\\pi = (\\pi_1, \\pi_2, \\pi_3, \\pi_4, \\pi_5)$。请将您的答案以精确分数组成的行矩阵形式呈现。", "solution": "设马尔可夫链的状态空间为 $S = \\{1, 2, 3, 4, 5\\}$，代表作业所在的服务器。我们需要找到平稳分布 $\\pi = (\\pi_1, \\pi_2, \\pi_3, \\pi_4, \\pi_5)$。\n\n首先，我们构建 $5 \\times 5$ 的转移矩阵 $P$，其中条目 $P_{ij}$ 是在一个时间步内从状态 $i$ 转移到状态 $j$ 的概率。题目提供了以下信息：\n- 服务器数量为 $N=5$。\n- 作业停留在其当前服务器上的概率为 $\\alpha = 0.6$。\n- 作业被迁移的概率为 $1-\\alpha = 0.4$。\n- 如果从服务器 $i$ 迁移，作业会以相等的概率移动到任何其他服务器 $j \\neq i$。共有 $N-1 = 4$ 台其他服务器。\n\n根据这些规则，我们可以确定转移矩阵 $P$ 的元素：\n1.  对角线元素 $P_{ii}$ 表示停留在状态 $i$ 的概率。这个概率为 $\\alpha$。\n    $$P_{ii} = \\alpha = 0.6$$\n2.  非对角线元素 $P_{ij}$ (对于 $i \\neq j$) 表示从状态 $i$ 移动到状态 $j$ 的概率。这种情况发生在作业被迁移（概率为 $1-\\alpha$）并且从 $N-1$ 个可能性中选择了服务器 $j$作为目的地。\n    $$P_{ij} = \\frac{1-\\alpha}{N-1} = \\frac{1 - 0.6}{5 - 1} = \\frac{0.4}{4} = 0.1$$\n\n所以，转移矩阵 $P$ 为：\n$$\nP = \\begin{pmatrix}\n0.6 & 0.1 & 0.1 & 0.1 & 0.1 \\\\\n0.1 & 0.6 & 0.1 & 0.1 & 0.1 \\\\\n0.1 & 0.1 & 0.6 & 0.1 & 0.1 \\\\\n0.1 & 0.1 & 0.1 & 0.6 & 0.1 \\\\\n0.1 & 0.1 & 0.1 & 0.1 & 0.6\n\\end{pmatrix}\n$$\n\n平稳分布 $\\pi$ 必须满足 $\\pi P = \\pi$ 且 $\\sum_{i=1}^{5} \\pi_i = 1$。\n\n我们可以求解这个线性方程组。方程 $\\pi P = \\pi$ 给出：\n$$\n(\\pi_1, \\pi_2, \\pi_3, \\pi_4, \\pi_5)\n\\begin{pmatrix}\n0.6 & 0.1 & 0.1 & 0.1 & 0.1 \\\\\n0.1 & 0.6 & 0.1 & 0.1 & 0.1 \\\\\n0.1 & 0.1 & 0.6 & 0.1 & 0.1 \\\\\n0.1 & 0.1 & 0.1 & 0.6 & 0.1 \\\\\n0.1 & 0.1 & 0.1 & 0.1 & 0.6\n\\end{pmatrix}\n= (\\pi_1, \\pi_2, \\pi_3, \\pi_4, \\pi_5)\n$$\n这产生了一个方程组。对于第一个分量：\n$$\n\\pi_1 = 0.6\\pi_1 + 0.1\\pi_2 + 0.1\\pi_3 + 0.1\\pi_4 + 0.1\\pi_5\n$$\n由于转移矩阵的完全对称性，关于 $\\pi_2, \\pi_3, \\pi_4, \\pi_5$ 的方程将具有相同的结构。这种对称性意味着平稳分布的各分量必须相等：$\\pi_1 = \\pi_2 = \\pi_3 = \\pi_4 = \\pi_5$。\n\n让我们来验证这一点。一个更直接的方法是检查矩阵 $P$ 的性质。如果一个矩阵是随机矩阵（所有条目均为非负数且所有行和为1），并且其所有列和也为1，则该矩阵被称为双随机矩阵。\n\n让我们检查 $P$ 的行和：\n对于任意行 $i$，其和为 $P_{ii} + \\sum_{j \\neq i} P_{ij} = \\alpha + (N-1) \\frac{1-\\alpha}{N-1} = \\alpha + (1-\\alpha) = 1$。\n具体来说，$0.6 + 4 \\times 0.1 = 0.6 + 0.4 = 1$。所以，$P$ 是一个随机矩阵。\n\n现在，让我们检查 $P$ 的列和：\n对于任意列 $j$，其和为 $P_{jj} + \\sum_{i \\neq j} P_{ij} = \\alpha + (N-1) \\frac{1-\\alpha}{N-1} = \\alpha + (1-\\alpha) = 1$。\n具体来说，$0.6 + 4 \\times 0.1 = 0.6 + 0.4 = 1$。所以，$P$ 也是一个双随机矩阵。\n\n马尔可夫链理论中的一个关键定理指出，如果一个有限状态、不可约且非周期的马尔可夫链具有双随机转移矩阵 $P$，那么其唯一的平稳分布就是均匀分布。\n- 该链是不可约的，因为对于所有 $i, j$ 都有 $P_{ij} > 0$，这意味着任何状态都可以在一步之内从任何其他状态到达。\n- 该链是非周期的，因为对于所有 $i$ 都有 $P_{ii} > 0$。\n\n对于一个有 $N$ 个状态的状态空间，均匀分布由 $\\pi_i = 1/N$ 给出，对所有 $i=1, \\dots, N$ 成立。\n在我们的例子中，$N=5$，所以平稳分布为：\n$$ \\pi_i = \\frac{1}{5} \\quad \\text{for } i=1, 2, 3, 4, 5. $$\n以小数表示，这是 $\\pi_i = 0.2$。以精确分数表示，这是 $1/5$。\n\n因此，平稳分布向量为：\n$$ \\pi = \\left(\\frac{1}{5}, \\frac{1}{5}, \\frac{1}{5}, \\frac{1}{5}, \\frac{1}{5}\\right) $$\n注意，只要问题结构导致一个双随机矩阵，$\\alpha=0.6$ 的具体值不影响最终的平稳分布。\n\n我们可以用方程 $\\pi P = \\pi$来检验这个解：\n设 $\\pi = (\\frac{1}{5}, \\frac{1}{5}, \\frac{1}{5}, \\frac{1}{5}, \\frac{1}{5})$。乘积 $\\pi P$ 的第一个分量是：\n$$ (\\pi P)_1 = \\sum_{i=1}^5 \\pi_i P_{i1} = \\frac{1}{5}(0.6) + \\frac{1}{5}(0.1) + \\frac{1}{5}(0.1) + \\frac{1}{5}(0.1) + \\frac{1}{5}(0.1) $$\n$$ (\\pi P)_1 = \\frac{1}{5} (0.6 + 0.1 + 0.1 + 0.1 + 0.1) = \\frac{1}{5}(1) = \\frac{1}{5} $$\n这等于 $\\pi_1$。根据对称性，这对所有分量都成立。因此，$\\pi P = \\pi$ 成立。另外，$\\sum \\pi_i = 5 \\times \\frac{1}{5} = 1$。该解是正确的。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{5} & \\frac{1}{5} & \\frac{1}{5} & \\frac{1}{5} & \\frac{1}{5} \\end{pmatrix}}$$", "id": "1300471"}, {"introduction": "与前一个不断混合的系统不同，现在我们来探讨当系统中存在一个“陷阱”或吸收态时会发生什么。本练习使用一个简化的天气模型，来展示一个永久且不可逃脱的状态如何从根本上改变长期预测 [@problem_id:1300497]。这个例子凸显了不可约性对于存在一个非平凡平稳分布的关键作用。", "problem": "一位气象学家为特定地区的每日天气模式开发了一个简化的三态模型。可能的状态有晴天 (S)、雨天 (R) 和一个特殊的长期状态——干旱 (D)。该模型表示为一个离散时间马尔可夫链。状态之间的转换遵循以下规则：\n\n1.  如果某一天是晴天，那么第二天将以概率 $p_{SS}$ 保持晴天，以概率 $p_{SR}$ 变为雨天，并以概率 $p_{SD}$ 进入干旱状态。这些概率之和为 1：$p_{SS} + p_{SR} + p_{SD} = 1$。\n2.  如果某一天是雨天，那么第二天将以概率 $p_{RS}$ 变为晴天，或以概率 $p_{RR}$ 保持雨天。概率之和为 1：$p_{RS} + p_{RR} = 1$。没有从雨天直接转换到干旱的可能。\n3.  一旦该地区进入干旱状态，它将永久保持在干旱状态。\n\n所有转换概率 $p_{SR}$、$p_{SD}$ 和 $p_{RS}$ 都严格大于零且小于一。\n\n马尔可夫链的平稳分布是一种不随时间改变的概率分布。对于这个天气模型，唯一的平稳分布 $\\pi = (\\pi_S, \\pi_R, \\pi_D)$ 是什么？其中 $\\pi_S$、$\\pi_R$ 和 $\\pi_D$ 分别是长期处于晴天、雨天和干旱状态的概率。\n\nA. $\\pi = (0, 0, 1)$\n\nB. $\\pi = (1, 0, 0)$\n\nC. $\\pi = \\left(\\frac{p_{RS}}{p_{RS}+p_{SR}}, \\frac{p_{SR}}{p_{RS}+p_{SR}}, 0\\right)$\n\nD. 该模型不存在唯一的平稳分布。\n\nE. 平稳分布取决于天气的初始状态。", "solution": "设马尔可夫链的状态空间为 $\\mathcal{S} = \\{S, R, D\\}$。平稳分布 $\\pi = (\\pi_S, \\pi_R, \\pi_D)$ 必须满足两个条件：\n1.  $\\pi P = \\pi$，其中 $P$ 是转移概率矩阵。\n2.  $\\pi_S + \\pi_R + \\pi_D = 1$。\n\n首先，我们根据问题描述构建转移矩阵 $P$。状态按 (S, R, D) 的顺序排列。\n$$\nP = \\begin{pmatrix}\np_{SS} & p_{SR} & p_{SD} \\\\\np_{RS} & p_{RR} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\n条件 $\\pi P = \\pi$ 展开为一个线性方程组：\n$$\n(\\pi_S, \\pi_R, \\pi_D) \\begin{pmatrix}\np_{SS} & p_{SR} & p_{SD} \\\\\np_{RS} & p_{RR} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix} = (\\pi_S, \\pi_R, \\pi_D)\n$$\n\n这给了我们以下三个方程：\n1.  $\\pi_S p_{SS} + \\pi_R p_{RS} = \\pi_S$\n2.  $\\pi_S p_{SR} + \\pi_R p_{RR} = \\pi_R$\n3.  $\\pi_S p_{SD} + \\pi_D (1) = \\pi_D$\n\n我们来分析第三个方程：\n$\\pi_S p_{SD} + \\pi_D = \\pi_D$\n两边同时减去 $\\pi_D$ 得到：\n$\\pi_S p_{SD} = 0$\n\n问题陈述中说明，从晴天转换到干旱的概率 $p_{SD}$ 严格大于零。要使乘积 $\\pi_S p_{SD}$ 为零，必须有 $\\pi_S = 0$。\n\n现在，我们将 $\\pi_S = 0$ 代入第一个方程：\n$(0) p_{SS} + \\pi_R p_{RS} = (0)$\n$\\pi_R p_{RS} = 0$\n\n问题中还说明，从雨天转换到晴天的概率 $p_{RS}$ 严格大于零。要使乘积 $\\pi_R p_{RS}$ 为零，必须有 $\\pi_R = 0$。\n\n最后，我们使用归一化条件，即平稳分布中所有概率之和必须为 1：\n$\\pi_S + \\pi_R + \\pi_D = 1$\n代入我们找到的 $\\pi_S$ 和 $\\pi_R$ 的值：\n$0 + 0 + \\pi_D = 1$\n这意味着 $\\pi_D = 1$。\n\n因此，该系统的唯一平稳分布是 $\\pi = (0, 0, 1)$。\n\n从概念上讲，状态 D 是一个吸收态，因为一旦进入就无法离开 ($p_{DD}=1$）。其他状态 S 和 R 是暂态。由于从每个暂态到达吸收态 D 的概率都非零（从 R 可以到 S，从 S 可以到 D），系统最终将以概率 1 被吸收到状态 D。平稳分布代表了系统的长期行为。当时间趋于无穷大时，处于任何暂态（S 或 R）的概率趋近于零，而处于吸收态（D）的概率趋近于一。", "answer": "$$\\boxed{A}$$", "id": "1300497"}, {"introduction": "许多随机过程发生在无限状态空间上，其中的粒子可能会永远漂泊。本练习以二维网格 $\\mathbb{Z}^2$ 上的随机游走这一经典模型为例，它因不存在平稳分布而著称 [@problem_id:1300482]。我们将研究如何通过增加一个简单的“重置”机制来约束这种无限游走，从而确保粒子最终会返回并创造一个稳定的长期均衡，这揭示了正回归和零回归之间的关键区别。", "problem": "随机游走理论中的一个经典结果指出，整数格点 $\\mathbb{Z}^2$ 上的简单对称随机游走 (SSRW) 是常返的，但不存在平稳分布。在 SSRW 中，位于任意位置的质点会以相等的概率移动到其四个最近邻之一。\n\n考虑一个在 $\\mathbb{Z}^2$ 上的修正随机游走。在每个时间步，质点的移动由一个两阶段过程决定：\n1. 抛掷一枚硬币，结果为“重置”的概率为 $\\epsilon$，结果为“游走”的概率为 $1-\\epsilon$，其中 $0 < \\epsilon < 1$ 是一个固定常数。\n2. 如果结果是“重置”，质点被直接移动到原点 $(0,0)$。如果结果是“游走”，质点从其当前位置执行一步标准的 SSRW。\n\n这个修正引入了一个朝向原点的全局“拉力”。对于 $\\epsilon$ 的任何有效取值，这个改变是否足以保证该过程存在平稳分布？请选择提供正确结论和理由的选项。\n\nA. 不，因为任何像 $\\mathbb{Z}^2$ 这样的无限状态空间上的马尔可夫链都不可能有可归一化的平稳分布。\n\nB. 不，因为底层的 $\\mathbb{Z}^2$ 上的简单对称随机游走是零常返的，并且由于 $\\epsilon$ 可以任意小，这个性质被该修正所保留。\n\nC. 是，因为对于任何 $0 < \\epsilon < 1$，重置机制确保了该链变为正常返的，这是平稳分布存在的充分条件。\n\nD. 是，但其存在性取决于重置概率 $\\epsilon$ 足够大（例如，大于1/2），以克服游走的扩散性质。\n\nE. 不，因为这个修正使得该链是周期的，而无限状态空间上的周期链不可能有平稳分布。", "solution": "设 $\\{X_n\\}_{n \\ge 0}$ 是在 $\\mathbb{Z}^2$ 上的马尔可夫链，其转移核由两阶段机制定义：\n- 以概率 $\\epsilon$，有 $X_{n+1}=0$。\n- 以概率 $1-\\epsilon$，$X_{n+1}$ 是从 $X_n$ 执行一步 SSRW 得到的。\n\n不可约性：对于任意 $x, y \\in \\mathbb{Z}^2$，$x$ 可以在一步内以 $\\epsilon > 0$ 的概率到达 $0$。从 $0$ 开始，对于到达 $y$ 的任意一条长度为 $n$ 的 SSRW 固定路径，在没有任何重置的情况下沿此路径行走的概率为 $((1-\\epsilon)/4)^n > 0$。因此存在 $k$ 使得 $P^k(x,y) > 0$，所以该链是不可约的。\n\n非周期性：由于 $P(0,0) \\ge \\epsilon > 0$，在 $0$ 处存在一个自环，这意味着该链是非周期的。\n\n正常返性：设 $T_0^+ = \\inf\\{n \\ge 1: X_n = 0 \\mid X_0 = 0\\}$。对于任何 $n \\ge 1$，\n$$\n\\mathbb{P}(T_0^+ > n \\mid X_0 = 0) \\le \\mathbb{P}(\\text{在步骤 } 1, \\dots, n \\text{ 中没有发生重置}) = (1-\\epsilon)^n\n$$\n因此，\n$$\n\\mathbb{E}[T_0^+] = \\sum_{n=0}^{\\infty} \\mathbb{P}(T_0^+ > n) \\le \\sum_{n=0}^{\\infty} (1-\\epsilon)^n = \\frac{1}{\\epsilon}  \\infty\n$$\n所以该链是正常返的。\n\n平稳分布的存在性与唯一性：对于可数空间上的不可约马尔可夫链，正常返性等价于存在唯一的平稳分布。因此，对于每个 $0  \\epsilon  1$，这样的分布都存在。此外，Doeblin 小化条件\n$$\nP(x, \\cdot) \\ge \\epsilon \\delta_0(\\cdot)\n$$\n意味着一致遍历性，从而加强了存在性和唯一性的结论。\n\n因此，对于任何 $0  \\epsilon  1$，重置机制都保证了平稳分布的存在，并且不需要对 $\\epsilon$ 设置任何阈值。\n\n所以，正确选项是 C。而 A 是错误的（无限状态空间可以有平稳分布），B 是错误的（重置打破了零常返性，并产生正常返性，其有限的平均返回时间上界为 $\\frac{1}{\\epsilon}$），D 是错误的（除了要求为正数之外，不需要对 $\\epsilon$ 有任何下界），E 是错误的（该链是非周期的，并且在任何情况下，对于正常返的不可约链，周期性并不排除平稳分布的存在）。", "answer": "$$\\boxed{C}$$", "id": "1300482"}]}