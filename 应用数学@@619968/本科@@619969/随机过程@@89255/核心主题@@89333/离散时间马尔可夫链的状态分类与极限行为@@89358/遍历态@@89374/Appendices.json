{"hands_on_practices": [{"introduction": "我们将从一个直观的例子开始，探索遍历系统及其稳态行为。这个练习模拟了一辆在城市间穿梭的送货卡车，它有一定概率发生故障。这个简单的“故障”机制，即卡车可能停留在当前城市，确保了系统是非周期的，从而使其成为一个遍历系统。通过解决这个问题 [@problem_id:1299404]，你将学会如何为一个遍历马尔可夫链建立转移矩阵，并计算其长期的稳态分布，这直接对应于卡车在每个城市的长期停留时间比例。", "problem": "一家物流公司运营着一辆自动驾驶送货卡车，为三个城市服务：Metropolis (A)、Gotham (B) 和 Zenith (C)。卡车遵循固定的单向每日路线：从 Metropolis 前往 Gotham，从 Gotham 前往 Zenith，再从 Zenith 返回 Metropolis。城市之间的这段行程需要一整天时间。然而，卡车老化的发动机存在可靠性问题。在任何一天，无论其位于何处，卡车都有一个固定的概率 $p$ 发生机械故障。如果发生故障，卡车当天会停留在当前城市进行维修，其预定的行程将推迟到第二天。发生故障的概率 $p$ 是一个满足 $0 < p < 1$ 的固定值。\n\n假设卡车已经运行了很长时间，那么卡车位于 Metropolis 的天数在长期来看占多大比例？请用精确分数作答。", "solution": "将该系统建模为一个在每天开始时观察的离散时间马尔可夫链，状态空间为 $\\{A,B,C\\}$，代表卡车当时所在的城市。每天：\n- 发生故障的概率为 $p$，此时卡车停留在当前城市，因此第二天的状态与今天的状态相同。\n- 不发生故障的概率为 $1-p$；此时卡车完成预定路段，第二天的状态是循环 $A \\to B \\to C \\to A$ 中的下一个城市。\n\n因此，一步转移概率为：\n$$\nP(A \\to A)=p,\\quad P(A \\to B)=1-p,\\quad P(A \\to C)=0,\n$$\n$$\nP(B \\to B)=p,\\quad P(B \\to C)=1-p,\\quad P(B \\to A)=0,\n$$\n$$\nP(C \\to C)=p,\\quad P(C \\to A)=1-p,\\quad P(C \\to B)=0.\n$$\n对于 $0<p<1$，该链是不可约的（每个状态都可以通过连续的移动到达其他状态）和非周期的（每个状态都有一个概率为 $p$ 的正概率自环），因此它具有唯一的平稳分布，并且在每个城市的长期天数比例等于该平稳分布。\n\n令 $(\\pi_{A},\\pi_{B},\\pi_{C})$ 表示平稳概率。平稳性条件 $\\pi=\\pi P$ 给出平衡方程：\n$$\n\\pi_{A}=\\pi_{A}p+\\pi_{C}(1-p),\\qquad\n\\pi_{B}=\\pi_{B}p+\\pi_{A}(1-p),\\qquad\n\\pi_{C}=\\pi_{C}p+\\pi_{B}(1-p),\n$$\n以及归一化条件 $\\pi_{A}+\\pi_{B}+\\pi_{C}=1$。\n\n整理得，\n$$\n(1-p)(\\pi_{A}-\\pi_{C})=0,\\quad (1-p)(\\pi_{B}-\\pi_{A})=0,\\quad (1-p)(\\pi_{C}-\\pi_{B})=0.\n$$\n由于 $1-p>0$，这些方程意味着\n$$\n\\pi_{A}=\\pi_{B}=\\pi_{C}.\n$$\n使用 $\\pi_{A}+\\pi_{B}+\\pi_{C}=1$ 可得\n$$\n\\pi_{A}=\\pi_{B}=\\pi_{C}=\\frac{1}{3}.\n$$\n因此，卡车位于 Metropolis 的天数的长期比例是 $\\frac{1}{3}$。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "1299404"}, {"introduction": "一个马尔可夫链即使是不可约和常返的，也不一定就是遍历的，周期性是其中的一个关键障碍。本练习 [@problem_id:1299388] 通过一个粒子在线性路径上的随机游走模型，清晰地揭示了周期性的概念。通过分析粒子返回初始状态所需的时间步数，你将发现返回只能在偶数步后发生，这揭示了状态的周期性，从而使其不满足遍历性的要求。这个练习有助于你深刻理解为什么非周期性是遍历性的一个必要条件。", "problem": "一个粒子在一组包含四个离散位置的集合上进行随机游走，这些位置我们可标记为状态 {1, 2, 3, 4}。该过程被建模为一个离散时间马尔可夫链。这些位置排列成一条直线，粒子的移动遵循以下转移规则：\n- 当处于内部位置 $i \\in \\{2, 3\\}$ 时，粒子以概率 $0.5$ 移动到位置 $i-1$ 或以概率 $0.5$ 移动到位置 $i+1$。\n- 位置 1 和 4 充当反射边界。从位置 1，粒子在下一步总是移动到位置 2（即，概率为 1）。从位置 4，粒子在下一步总是移动到位置 3（概率为 1）。\n\n基于此模型，以下哪个陈述为状态 2 提供了正确的分类？\n\nA. 状态 2 是遍历的。\n\nB. 状态 2 不是遍历的，因为它是周期性状态。\n\nC. 状态 2 不是遍历的，因为它是暂留状态。\n\nD. 状态 2 不是遍历的，因为它是零常返状态。", "solution": "我们用状态空间 $\\{1,2,3,4\\}$ 上的转移矩阵 $P$ 来对此马尔可夫链建模（行和列按 $1,2,3,4$ 排序）：\n$$\nP=\\begin{pmatrix}\n0 & 1 & 0 & 0\\\\\n\\frac{1}{2} & 0 & \\frac{1}{2} & 0\\\\\n0 & \\frac{1}{2} & 0 & \\frac{1}{2}\\\\\n0 & 0 & 1 & 0\n\\end{pmatrix}.\n$$\n首先，我们确定其不可约性和常返性。其底层的图通过带有反射边界的近邻移动是连通的：$1 \\leftrightarrow 2 \\leftrightarrow 3 \\leftrightarrow 4$，其中每个方向的概率都严格为正。因此，每个状态都与所有其他状态互通；该链是不可约的。由于状态空间是有限的且链是不可约的，所以每个状态都是正常返的。因此状态 $2$ 不是暂留的，也不是零常返的。\n\n接下来，我们确定状态 2 的周期。周期 $d(2)$ 的定义为\n$$\nd(2)=\\gcd\\{n\\ge 1 : (P^{n})_{2,2}>0\\}.\n$$\n每一步都会改变位置的奇偶性（在奇数状态和偶数状态之间移动），因此从偶数状态 2 出发，经过 $n$ 步后，链处于偶数状态当且仅当 $n$ 是偶数。因此，对于所有奇数 $n$，$(P^{n})_{2,2}=0$。对于偶数 $n=2m$，存在一条返回到 2 的路径，例如\n$$\n2 \\to 1 \\to 2 \\to 1 \\to \\cdots \\to 2 \\quad \\text{(长度 }2m\\text{),}\n$$\n其概率等于 $\\left(\\frac{1}{2}\\right)^{m}>0$ （每次 $2\\to 1$ 的概率为 $\\frac{1}{2}$，每次 $1\\to 2$ 的概率为 $1$）。因此，对于所有 $m\\ge 1$，$(P^{2m})_{2,2}>0$。因此\n$$\n\\{n\\ge 1 : (P^{n})_{2,2}>0\\}=\\{2,4,6,\\dots\\}\n$$\n并且\n$$\nd(2)=\\gcd\\{2,4,6,\\dots\\}=2.\n$$\n所以状态 $2$ 是周期性的，周期为 $2$，并且尽管它是正常返的（作为有限不可约链的一部分），它不是非周期的。在标准分类中，一个遍历状态是在一个封闭的不可约类中正常返且非周期的，因此状态 2 不是遍历的，因为它是周期性的。\n\n因此，正确的选项是 B。", "answer": "$$\\boxed{B}$$", "id": "1299388"}, {"introduction": "现在，让我们将遍历性的概念应用到一个更复杂的场景中：策略博弈。这个“石头、剪刀、布”的游戏模型 [@problem_id:1299380] 探讨了一个玩家的自适应策略，并展示了如何将其数学化。有趣的是，模型中引入了一个微小的随机“噪声”项 $\\epsilon$，正是这个噪声确保了整个系统是遍历的，从而可以进行稳定的长期行为分析。通过这个练习，你将实践如何将一个动态策略转化为马尔可夫链，并分析系统参数如何影响最终的稳态结果。", "problem": "考虑一个两位玩家之间重复进行的“石头-布-剪刀”游戏。玩家1的行为是可预测的，他总是选择“石头”。玩家2采用一种更复杂的、受随机噪声影响的自适应策略。设玩家2在任何一轮中的行动为{石头, 布, 剪刀}之一。\n\n玩家2的策略定义如下：\n在每一轮中，玩家2的行动由一个概率规则决定。玩家2有 $1-\\epsilon$ 的概率遵循一个“基本策略”。有 $\\epsilon$ 的概率，玩家2会忽略该基本策略，而是从{石头, 布, 剪刀}三个行动中随机均匀地选择一个（即，每个行动的概率为 $1/3$）。\n\n该基本策略是基于上一轮对抗玩家1的“石头”的结果，遵循“赢则保持，输或平则转换”的规则：\n- **赢则保持**：如果玩家2在上一轮获胜，他们的基本行动是再次执行相同的行动。\n- **输或平则转换**：如果玩家2在上一轮输了或平局，他们的基本行动是从另外两个行动中随机选择一个，每个的概率为 $1/2$。\n\n假设噪声参数 $\\epsilon$ 是一个满足 $0 < \\epsilon < 3/2$ 的常数。\n\n确定玩家2选择“布”这个行动的长期比例。请用含 $\\epsilon$ 的符号表达式表示你的答案。", "solution": "用马尔可夫状态集 $\\{R,P,S\\}$ 来标记玩家2的当前行动。对抗玩家1固定的 $R$ 时，基本规则是：\n- 从 $P$（赢）出发：以概率 $1$ 停留在 $P$。\n- 从 $R$（平局）出发：均匀转换到另外两个行动之一，即以各 $\\frac{1}{2}$ 的概率转换到 $P$ 或 $S$。\n- 从 $S$（输）出发：均匀转换到另外两个行动之一，即以各 $\\frac{1}{2}$ 的概率转换到 $R$ 或 $P$。\n\n因此，基本转移矩阵 $T_{0}$（行是当前状态，列是下一个状态）是\n$$\nT_{0}=\\begin{pmatrix}\n0 & \\frac{1}{2} & \\frac{1}{2}\\\\\n0 & 1 & 0\\\\\n\\frac{1}{2} & \\frac{1}{2} & 0\n\\end{pmatrix}.\n$$\n玩家2有 $\\epsilon$ 的概率忽略基本规则并随机均匀地出招；令 $J$ 为一个 $3\\times 3$ 矩阵，其每一行都等于 $\\left(\\frac{1}{3},\\frac{1}{3},\\frac{1}{3}\\right)$。总的转移矩阵是\n$$\nT=(1-\\epsilon)T_{0}+\\epsilon J.\n$$\n设平稳分布为 $\\pi=(r,p,s)$，对应于 $(R,P,S)$。平稳性条件给出\n$$\n\\pi=\\pi T=(1-\\epsilon)\\,\\pi T_{0}+\\epsilon\\left(\\tfrac{1}{3},\\tfrac{1}{3},\\tfrac{1}{3}\\right),\n$$\n因为 $\\pi J=\\left(\\tfrac{1}{3},\\tfrac{1}{3},\\tfrac{1}{3}\\right)$。计算 $\\pi T_{0}$：\n$$\n\\pi T_{0}\n= r\\,(0,\\tfrac{1}{2},\\tfrac{1}{2})+p\\,(0,1,0)+s\\,(\\tfrac{1}{2},\\tfrac{1}{2},0)\n=\\left(\\tfrac{1}{2}s,\\ \\tfrac{1}{2}r+p+\\tfrac{1}{2}s,\\ \\tfrac{1}{2}r\\right).\n$$\n因此，分量方程为\n$$\nr=(1-\\epsilon)\\tfrac{1}{2}s+\\tfrac{\\epsilon}{3},\\quad\np=(1-\\epsilon)\\left(\\tfrac{1}{2}r+p+\\tfrac{1}{2}s\\right)+\\tfrac{\\epsilon}{3},\\quad\ns=(1-\\epsilon)\\tfrac{1}{2}r+\\tfrac{\\epsilon}{3},\n$$\n以及 $r+p+s=1$。令 $a=\\tfrac{1-\\epsilon}{2}$。那么\n$$\nr=a\\,s+\\tfrac{\\epsilon}{3},\\qquad s=a\\,r+\\tfrac{\\epsilon}{3}.\n$$\n将第一个方程中的 $r$ 代入第二个方程：\n$$\ns=a\\left(a\\,s+\\tfrac{\\epsilon}{3}\\right)+\\tfrac{\\epsilon}{3}\n=a^{2}s+\\tfrac{a\\epsilon}{3}+\\tfrac{\\epsilon}{3}.\n$$\n因此\n$$\ns-a^{2}s=\\tfrac{(a+1)\\epsilon}{3}\\ \\Longrightarrow\\ s(1-a^{2})=\\tfrac{(a+1)\\epsilon}{3}.\n$$\n由于 $1-a^{2}=(1-a)(1+a)$ 且对于 $0<\\epsilon<\\tfrac{3}{2}$ 有 $1+a=\\tfrac{3-\\epsilon}{2}\\neq 0$，可以消去 $(1+a)$ 得到\n$$\ns(1-a)=\\tfrac{\\epsilon}{3}.\n$$\n现在 $1-a=1-\\tfrac{1-\\epsilon}{2}=\\tfrac{1+\\epsilon}{2}$，所以\n$$\ns=\\frac{\\epsilon/3}{(1+\\epsilon)/2}=\\frac{2\\epsilon}{3(1+\\epsilon)}.\n$$\n根据对称性，同样的代数运算得出\n$$\nr=\\frac{2\\epsilon}{3(1+\\epsilon)}.\n$$\n最后，使用 $r+p+s=1$ 得到\n$$\np=1-r-s=1-\\frac{4\\epsilon}{3(1+\\epsilon)}=\\frac{3-\\epsilon}{3(1+\\epsilon)}.\n$$\n这个 $p$ 值也满足中间的平稳性方程，从而证实了一致性。因此，玩家2选择“布”的长期比例是 $\\frac{3-\\epsilon}{3(1+\\epsilon)}$。", "answer": "$$\\boxed{\\frac{3-\\epsilon}{3\\left(1+\\epsilon\\right)}}$$", "id": "1299380"}]}