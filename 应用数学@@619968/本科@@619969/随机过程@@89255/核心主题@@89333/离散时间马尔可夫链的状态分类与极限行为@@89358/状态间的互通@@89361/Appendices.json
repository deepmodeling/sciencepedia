{"hands_on_practices": [{"introduction": "理解状态互通的第一步是掌握其基本定义：两个状态是否可以相互到达。这个练习通过一个直观的电梯运行模型，让你亲手检验相互可达性。通过追踪从一个状态到另一个状态的可能路径及其非零概率，你将巩固对“互通”这一核心概念的理解 [@problem_id:1290007]。", "problem": "考虑一个两层建筑中电梯运行的简化模型。在离散的时间步长上观察电梯的状态。该系统可处于以下四种状态之一：\n- $S_1$：在 1 楼空闲。\n- $S_2$：从 1 楼移动到 2 楼。\n- $S_3$：在 2 楼空闲。\n- $S_4$：从 2 楼移动到 1 楼。\n\n状态之间的转换是概率性的，并遵循以下规则：\n1.  如果电梯处于状态 $S_1$（在 1 楼空闲），则有概率 $p_u$ 因乘客请求而在下一时间步长进入状态 $S_2$（向上移动）。否则，它保持在状态 $S_1$。\n2.  如果电梯处于状态 $S_3$（在 2 楼空闲），则有概率 $p_d$ 因乘客请求而在下一时间步长进入状态 $S_4$（向下移动）。否则，它保持在状态 $S_3$。\n3.  如果电梯处于状态 $S_2$（向上移动），则有很小的概率 $\\epsilon$ 发生轻微机械故障，强制其立即复位，在下一时间步长返回状态 $S_1$。如果没有发生故障，它将在下一时间步长成功到达状态 $S_3$。\n4.  如果电梯处于状态 $S_4$（向下移动），它将总是完成其行程并到达 1 楼，因此在下一时间步长进入状态 $S_1$。\n\n设概率为 $p_u = 0.85$，$p_d = 0.60$ 和 $\\epsilon = 0.05$。\n\n在随机过程的背景下，如果可以以非零概率通过有限步数从状态 $i$ 到达状态 $j$，则称状态 $j$ 是从状态 $i$ 可达的。如果两个状态中的每一个都可以从另一个状态到达，则称这两个状态是互通的。\n\n以下哪个陈述正确描述了状态“向上移动” ($S_2$) 和状态“向下移动” ($S_4$) 之间的关系？\n\nA. $S_2$ 是从 $S_4$ 可达的，但 $S_4$ 不是从 $S_2$ 可达的。\n\nB. $S_4$ 是从 $S_2$ 可达的，但 $S_2$ 不是从 $S_4$ 可达的。\n\nC. $S_2$ 和 $S_4$ 是互通的。\n\nD. 两个状态都不能从另一个状态到达。\n\nE. 可达性关系取决于系统的初始状态。", "solution": "我们将电梯建模为一个离散时间马尔可夫链，其状态为 $S_{1}$（在 1 楼空闲）、$S_{2}$（向上移动）、$S_{3}$（在 2 楼空闲）和 $S_{4}$（向下移动）。非零的单步转移概率为：\n$$\nP(S_{1}\\to S_{2})=p_{u},\\quad P(S_{1}\\to S_{1})=1-p_{u},\n$$\n$$\nP(S_{3}\\to S_{4})=p_{d},\\quad P(S_{3}\\to S_{3})=1-p_{d},\n$$\n$$\nP(S_{2}\\to S_{1})=\\epsilon,\\quad P(S_{2}\\to S_{3})=1-\\epsilon,\n$$\n$$\nP(S_{4}\\to S_{1})=1.\n$$\n可达性意味着存在有限步数，以非零概率从一个状态转移到另一个状态。\n\n要检查 $S_{4}$ 是否是从 $S_{2}$ 可达的，考虑两步路径 $S_{2}\\to S_{3}\\to S_{4}$。其概率为\n$$\nP(S_{2}\\to S_{3})\\cdot P(S_{3}\\to S_{4})=(1-\\epsilon)\\,p_{d}.\n$$\n由于 $p_{d}>0$ 且 $1-\\epsilon>0$，该乘积严格为正，因此 $S_{4}$ 是从 $S_{2}$ 可达的。\n\n要检查 $S_{2}$ 是否是从 $S_{4}$ 可达的，考虑两步路径 $S_{4}\\to S_{1}\\to S_{2}$。其概率为\n$$\nP(S_{4}\\to S_{1})\\cdot P(S_{1}\\to S_{2})=1\\cdot p_{u}=p_{u}.\n$$\n由于 $p_{u}>0$，该值严格为正，因此 $S_{2}$ 是从 $S_{4}$ 可达的。\n\n由于每个状态都可以通过有限步数以非零概率从另一个状态到达，因此 $S_{2}$ 和 $S_4$ 是互通的。这对应于选项 C。", "answer": "$$\\boxed{C}$$", "id": "1290007"}, {"introduction": "状态互通是一种等价关系，它将整个状态空间划分为独立的“连通类”。这个练习将带领你分析一个更复杂的通信协议模型，从而实践如何识别这些连通类。你将学习区分暂态类（系统最终会离开）和吸收态（系统进入后无法离开），并判断整个马尔可夫链是否“不可约” [@problem_id:1290025]。", "problem": "一个研究团队正在对一个特殊自动机的行为进行建模，该自动机旨在解析一种专有通信协议。在任何离散时间步，该自动机的状态由其当前正在处理的数据包类型决定。该系统可以建模为一个具有四个可能状态的离散时间马尔可夫链：`SYNC`（同步）、`DATA`（数据负载）、`CTRL`（控制）和 `ACK`（确认）。\n\n状态转移遵循以下概率规则：\n- 从状态 `SYNC`，自动机总是转移到状态 `DATA`。\n- 从状态 `DATA`，它以0.6的概率转移回 `DATA`，或以0.4的概率转移到 `CTRL`。\n- 从状态 `CTRL`，它以0.8的概率转移到 `ACK`，或以0.2的概率转移到 `SYNC`。\n- 从状态 `ACK`，它总是转移回 `ACK`。\n\n基于此模型，以下关于各状态之间关系的陈述中，哪一个是正确的？\n\nA. 状态 `SYNC` 和 `ACK` 互通。\n\nB. 状态 `DATA` 是一个常返状态。\n\nC. 状态集 {`SYNC`, `DATA`, `CTRL`} 构成一个单一的互通类。\n\nD. 整个马尔可夫链是不可约的。\n\nE. 状态 `ACK` 是一个暂态。", "solution": "设状态空间为 $S=\\{\\text{SYNC},\\text{DATA},\\text{CTRL},\\text{ACK}\\}$。一步转移概率为：\n$$P(\\text{SYNC}\\to\\text{DATA})=1,$$\n$$P(\\text{DATA}\\to\\text{DATA})=0.6,\\quad P(\\text{DATA}\\to\\text{CTRL})=0.4,$$\n$$P(\\text{CTRL}\\to\\text{ACK})=0.8,\\quad P(\\text{CTRL}\\to\\text{SYNC})=0.2,$$\n$$P(\\text{ACK}\\to\\text{ACK})=1.$$\n\n为了检验互通性，我们回顾一下，状态 $i$ 和 $j$ 互通的条件是存在 $m,n\\in\\mathbb{N}$ 使得 $P_{ij}^{m}>0$ 且 $P_{ji}^{n}>0$。\n\n1) 对于陈述 A，$\\text{SYNC}$ 到达 $\\text{ACK}$ 的概率满足\n$$P_{\\text{SYNC},\\text{ACK}}^{3}\\ge P_{\\text{SYNC},\\text{DATA}}P_{\\text{DATA},\\text{CTRL}}P_{\\text{CTRL},\\text{ACK}}=1\\cdot 0.4\\cdot 0.8>0.$$\n然而，从 $\\text{ACK}$ 出发，我们有 $P(\\text{ACK}\\to\\text{ACK})=1$，所以对于任意 $n\\ge 1$，只要 $j\\neq \\text{ACK}$，就有 $P_{\\text{ACK},j}^{n}=0$。因此 $\\text{ACK}$ 无法到达 $\\text{SYNC}$，所以它们不互通。因此 A 是错误的。\n\n2) 对于陈述 B，考虑状态 `DATA`。从 `DATA` 出发，首次到达 `CTRL` 的时间服从成功概率为 0.4 的几何分布，因此最终到达 `CTRL` 的概率为1。从 `CTRL` 出发，链以 0.8 的概率转移到 `ACK`，并以 0.2 的概率转移到 `SYNC`→`DATA` 并重复。永远避开 `ACK` 的概率为 $\\lim_{n\\to\\infty}(0.2)^n=0$，所以（从 `DATA` 出发）最终被 `ACK` 吸收的概率为1。由于从 `ACK` 无法到达任何其他状态，无限次返回 `DATA` 的概率为0，所以 `DATA` 是暂态的，而不是常返的。因此 B 是错误的。\n\n3) 对于陈述 C，检查 $\\{\\text{SYNC},\\text{DATA},\\text{CTRL}\\}$ 内部的成对互通性：\n- $\\text{SYNC}\\to\\text{DATA}$ 的概率为 $P_{\\text{SYNC},\\text{DATA}}=1$，而 $\\text{DATA}\\to\\text{SYNC}$ 的概率满足\n$$P_{\\text{DATA},\\text{SYNC}}^{2}\\ge P_{\\text{DATA},\\text{CTRL}}P_{\\text{CTRL},\\text{SYNC}}=0.4\\cdot 0.2>0.$$\n- $\\text{SYNC}\\to\\text{CTRL}$ 的概率满足\n$$P_{\\text{SYNC},\\text{CTRL}}^{2}\\ge P_{\\text{SYNC},\\text{DATA}}P_{\\text{DATA},\\text{CTRL}}=1\\cdot 0.4>0,$$\n并且 $\\text{CTRL}\\to\\text{SYNC}$ 的概率为 $P_{\\text{CTRL},\\text{SYNC}}=0.2>0$。\n- $\\text{DATA}\\to\\text{CTRL}$ 的概率为 $P_{\\text{DATA},\\text{CTRL}}=0.4>0$，并且 $\\text{CTRL}\\to\\text{DATA}$ 的概率满足\n$$P_{\\text{CTRL},\\text{DATA}}^{2}\\ge P_{\\text{CTRL},\\text{SYNC}}P_{\\text{SYNC},\\text{DATA}}=0.2\\cdot 1>0.$$\n因此，这三个状态两两互通，构成一个单一的互通类。注意，由于 $P_{\\text{CTRL},\\text{ACK}}=0.8>0$，该类不是闭合的。因此 C 是正确的。\n\n4) 对于陈述 D，如果马尔可夫链只有一个互通类，则该链是不可约的。此处，`ACK` 不与其他任何状态互通（它是一个吸收态），因此至少存在两个互通类：$\\{\\text{SYNC},\\text{DATA},\\text{CTRL}\\}$ 和 $\\{\\text{ACK}\\}$。因此 D 是错误的。\n\n5) 对于陈述 E，由于 $P(\\text{ACK}\\to\\text{ACK})=1$，从 `ACK` 出发，链以概率1在一步内返回到 `ACK`，所以 `ACK` 是常返的（实际上是吸收态），而不是暂态的。因此 E 是错误的。\n\n唯一正确的陈述是 C。", "answer": "$$\\boxed{C}$$", "id": "1290025"}, {"introduction": "一个连通类中所有状态的长期行为是相同的：它们要么都是常返的，要么都是暂留的。这个高级练习探讨了这一深刻结论，要求你为一个无限状态空间模型找出使其成为常返链的条件。通过这个过程，你将把状态互通的结构特性与过程的长期动态行为联系起来，理解为什么一个连通类中的状态“命运与共” [@problem_id:1289987]。", "problem": "考虑一个定义在非负整数状态空间 $\\mathbb{N}_0 = \\{0, 1, 2, \\dots\\}$ 上的离散时间马尔可夫链。该过程模拟一个系统，该系统会逐阶段前进，但可能会发生重置故障。转移规则如下：\n- 如果系统处于状态 0，它将在下一个时间步确定性地转移到状态 1。\n- 如果系统处于任何状态 $n \\ge 1$，它将以概率 $p_n$ 转移到状态 $n+1$，或以概率 $1-p_n$ 重置到状态 0。\n\n概率序列 $\\{p_n\\}_{n \\ge 1}$ 是给定的，并且已知对于所有 $n \\ge 1$ 都有 $0 < p_n < 1$。\n\n如果从状态 $i$ 出发，最终返回状态 $i$ 的概率为 1，则称状态 $i$ 是常返的。如果一个不可约马尔可夫链中的所有状态都是常返的，则该链本身被称为常返链。\n\n该马尔可夫链是常返的，关于序列 $\\{p_n\\}_{n \\ge 1}$ 的充分必要条件是什么？\n\nA. 无穷乘积 $\\prod_{n=1}^{\\infty} p_n$ 收敛到一个非零值。\n\nB. 无穷级数 $\\sum_{n=1}^{\\infty} (1-p_n)$ 是收敛的。\n\nC. 无穷级数 $\\sum_{n=1}^{\\infty} (1-p_n)$ 是发散的。\n\nD. 序列 $\\{p_n\\}_{n \\ge 1}$ 收敛到一个严格小于 1 的极限。\n\nE. 序列 $\\{p_n\\}_{n \\ge 1}$ 收敛到 1。", "solution": "我们首先注意到不可约性。对于任何 $n \\geq 1$，该链在一步之内以概率 $1-p_{n} \\in (0,1)$ 转移到 $0$，因此从每个 $n \\geq 1$ 状态都可以到达 $0$。从 $0$ 出发，该链确定性地转移到 $1$，而从 $1$ 出发，它可以通过连续的向上转移以概率 $\\prod_{j=1}^{m-1} p_{j} > 0$ 到达任何 $m \\geq 1$。因此，所有状态都是互通的，该链是不可约的。因此，该链是常返的当且仅当其中一个状态（因此是所有状态）是常返的；我们只需检验状态 $0$ 的常返性。\n\n从 $0$ 出发，链转移到 $1$，然后每一步要么向上转移，要么重置到 $0$。定义事件 $A_{k}$ 为“离开 $0$ 后的前 $k$ 次转移中没有发生重置”。那么\n$$\n\\mathbb{P}(A_{k})=\\prod_{n=1}^{k} p_{n}。\n$$\n离开 $0$ 后永不重置的事件是 $\\bigcap_{k=1}^{\\infty} A_{k}$。由于 $(A_{k})$ 是一个递减事件序列，\n$$\n\\mathbb{P}\\Big(\\bigcap_{k=1}^{\\infty} A_{k}\\Big)=\\lim_{k \\to \\infty} \\mathbb{P}(A_{k})=\\lim_{k \\to \\infty} \\prod_{n=1}^{k} p_{n}=\\prod_{n=1}^{\\infty} p_{n}。\n$$\n因此，从 $0$ 出发，曾返回到 $0$ 的概率等于\n$$\n1-\\prod_{n=1}^{\\infty} p_{n}。\n$$\n因此，状态 $0$ 是常返的当且仅当\n$$\n\\prod_{n=1}^{\\infty} p_{n}=0。\n$$\n我们现在将此与级数 $\\sum_{n=1}^{\\infty} (1-p_{n})$ 联系起来。令 $x_{n}=1-p_{n} \\in (0,1)$，因此 $p_{n}=1-x_{n}$。使用有限乘积的对数，我们得到\n$$\n\\ln\\Big(\\prod_{n=1}^{k} p_{n}\\Big)=\\sum_{n=1}^{k} \\ln(1-x_{n})。\n$$\n对于 $x \\in (0,1)$，有两个标准不等式：\n$$\n\\ln(1-x) \\leq -x\n$$\n以及，对于 $0 \\leq x \\leq \\tfrac{1}{2}$，\n$$\n\\ln(1-x) \\geq -x-2x^{2}。\n$$\n首先，如果 $\\sum_{n=1}^{\\infty} x_{n}$ 发散，那么根据上界不等式\n$$\n\\sum_{n=1}^{k} \\ln(1-x_{n}) \\leq -\\sum_{n=1}^{k} x_{n} \\to -\\infty,\n$$\n因此 $\\prod_{n=1}^{k} p_{n} \\to 0$，从而 $\\prod_{n=1}^{\\infty} p_{n}=0$，状态 $0$ 是常返的。\n\n反之，如果 $\\sum_{n=1}^{\\infty} x_{n}$ 收敛，则 $x_{n} \\to 0$，因此存在一个 $N$ 使得对于所有 $n \\geq N$ 都有 $x_{n} \\leq \\tfrac{1}{2}$。那么\n$$\n\\sum_{n=N}^{k} \\ln(1-x_{n}) \\geq -\\sum_{n=N}^{k} x_{n}-2\\sum_{n=N}^{k} x_{n}^{2}。\n$$\n因为 $\\sum x_{n}$ 收敛，所以 $\\sum x_{n}^{2}$ 也收敛，因此右侧有下界；从而 $\\sum_{n=1}^{\\infty} \\ln(1-x_{n}) > -\\infty$ 并且 $\\prod_{n=1}^{\\infty} p_{n}>0$。在这种情况下，永不返回到 $0$ 的概率为正，因此状态 $0$ 是暂态的。\n\n因此，该链是常返的当且仅当 $\\sum_{n=1}^{\\infty} (1-p_{n})$ 发散。在给定的选项中，这正是选项 C。", "answer": "$$\\boxed{C}$$", "id": "1289987"}]}