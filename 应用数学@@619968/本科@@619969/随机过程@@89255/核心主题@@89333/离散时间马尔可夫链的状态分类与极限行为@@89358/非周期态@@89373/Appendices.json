{"hands_on_practices": [{"introduction": "本练习将通过一个具体情景，帮助你动手计算一个状态的周期。通过分析一个粒子在整数格点上的随机游走，你将深入理解周期的定义——即所有可能返回初始状态的步数的最大公约数。这个模型是物理学和化学中模拟晶格振动或缺陷扩散的基本概念，为我们提供了一个清晰直观的起点。[@problem_id:1281619]", "problem": "一个粒子是一个简化的一维晶格模型的一部分，其位置由数轴 $\\mathbb{Z}$ 上的一个整数表示。在每个离散时间步，该粒子发生一次位移。从任意状态 $i$ 出发的可能位移是到 $i-2$ 或 $i+4$。这些跳跃的概率对所有状态都是相同的，记为 $p_{-2} = P(X_{n+1}=i-2 | X_n=i)$ 和 $p_{4} = P(X_{n+1}=i+4 | X_n=i)$。这两个概率都严格为正，且它们的和为 1，即 $p_{-2} + p_{4} = 1$。\n\n这个随机游走过程构成整数集上的一个马尔可夫链。求此链中任意状态 $j$ 的周期。", "solution": "设 $\\{X_{n}\\}_{n \\ge 0}$ 是 $\\mathbb{Z}$ 上的马尔可夫链，其转移为 $X_{n+1}=X_{n}-2$（概率为 $p_{-2}>0$）和 $X_{n+1}=X_{n}+4$（概率为 $p_{4}>0$），其中 $p_{-2}+p_{4}=1$。状态 $j$ 的周期定义为\n$$\nd(j)=\\gcd\\{n \\ge 1 : P^{n}(j,j) > 0\\}。\n$$\n\n首先，注意到每一步都将位置改变一个偶数，因此奇偶性是守恒的。因此，该链分解为两个闭的互通类：偶数集和奇数集。对任意固定的 $j$，其奇偶性类中的所有状态都与 $j$ 互通，且该类中所有状态的周期都相同。因此，我们只需通过确定使得在 $n$ 步后返回到 $j$ 的概率为正的 $n$ 的集合，来计算 $d(j)$。\n\n任何一个 $n$ 步的路径都由 $a$ 次大小为 $-2$ 的步和 $b$ 次大小为 $+4$ 的步组成，其中 $a,b \\in \\mathbb{Z}_{\\ge 0}$ 且 $a+b=n$。$n$ 步后的净位移是\n$$\n\\Delta = (-2)a + (4)b = -2a + 4b。\n$$\n返回到 $j$ 要求 $\\Delta=0$，因此\n$$\n-2a + 4b = 0 \\quad \\Longleftrightarrow \\quad a = 2b。\n$$\n将 $a=2b$ 代入 $n=a+b$ 可得\n$$\nn = a + b = 2b + b = 3b。\n$$\n因此，在 $n$ 步后能返回的必要条件是 $n$ 是 $3$ 的正整数倍。反之，对任意 $b \\in \\mathbb{Z}_{>0}$，取 $a=2b$ 得到 $n=3b$，且至少存在一条 $n$ 步路径，其恰好包含 $a$ 次大小为 $-2$ 的步和 $b$ 次大小为 $+4$ 的步，使得净位移为零。由于 $p_{-2}, p_{4} > 0$，每条这样的路径都有正的概率，所以对于每个是 $3$ 的正整数倍的 $n$，都有 $P^{n}(j,j)>0$。\n\n因此，集合 $\\{n \\ge 1 : P^{n}(j,j) > 0\\}$ 恰好是 $\\{3,6,9,\\ldots\\}$，其周期为\n$$\nd(j) = \\gcd\\{3,6,9,\\ldots\\} = 3。\n$$\n\n这对任何状态 $j$（无论是偶数还是奇数）都成立，所以每个状态的周期都是 3。", "answer": "$$\\boxed{3}$$", "id": "1281619"}, {"introduction": "这个练习将介绍一种强大而常用的技巧来确保马尔可夫链是非周期的，即“懒惰”随机游走。通过允许系统有一定概率 $p$ 停留在当前状态，我们便可以打破任何潜在的循环模式。本练习不仅展示了这一简单修改如何保证非周期性，还将其与计算网络中数据包长期分布的实际任务联系起来，体现了理论概念的实际应用价值。[@problem_id:1281689]", "problem": "一个通信网络被建模为一组节点（顶点）和链路（边）。这五个节点的集合被划分为两个不相交的子集，一个服务器中心 $U = \\{u_1, u_2\\}$ 和一个客户端组 $V = \\{v_1, v_2, v_3\\}$。服务器中心的每个节点与客户端组的每个节点之间都存在一条链路。同一子集内的节点之间不存在链路。\n\n一个数据包在该网络上进行随机游走。在每个离散时间步，该数据包位于五个节点之一。在其当前节点，数据包有 $p$ 的概率在下一时间步停留在同一节点。有 $1-p$ 的概率，该数据包被传输到一个相邻节点。如果发生传输，目标节点将从所有相连（相邻）的节点中均匀随机地选择。常数 $p$ 满足 $0 < p < 1$。\n\n假设该过程运行了很长时间，数据包位于客户端组 $V$ 中任意一个特定节点（例如，节点 $v_1$）的时间占总时间的长期比例是多少？请用一个单一的封闭形式解析表达式表示您的答案。", "solution": "我们将该网络建模为一个无向图 $K_{2,3}$，其二分部为 $U=\\{u_{1},u_{2}\\}$ 和 $V=\\{v_{1},v_{2},v_{3}\\}$。该随机游走是懒惰的：从一个节点 $i$ 出发，它以概率 $p$ 停留在 $i$，并以概率 $1-p$ 移动到一个从其邻居中均匀选择的节点。\n\n定义节点 $i$ 和 $j$ 的转移概率：\n$$\nP_{ii}=p,\\quad\nP_{ij}=\\begin{cases}\n\\frac{1-p}{\\deg(i)}, & \\text{若 $i$ 和 $j$ 相邻},\\\\\n0, & \\text{其他情况}。\n\\end{cases}\n$$\n因为 $0<p<1$ 且图是连通的，所以该马尔可夫链是不可约且非周期的，因此它有一个唯一的平稳分布 $\\pi$，并且长期比例等于 $\\pi$。\n\n对于无向图上的懒惰随机游走，其平稳分布与节点度成正比。我们验证其关于 $\\pi_{i}\\propto\\deg(i)$ 的可逆性。令 $S=\\sum_{k}\\deg(k)$。设\n$$\n\\pi_{i}=\\frac{\\deg(i)}{S}。\n$$\n对于任意相邻的 $i$ 和 $j$，细致平衡成立：\n$$\n\\pi_{i}P_{ij}=\\frac{\\deg(i)}{S}\\cdot\\frac{1-p}{\\deg(i)}=\\frac{1-p}{S}=\\frac{\\deg(j)}{S}\\cdot\\frac{1-p}{\\deg(j)}=\\pi_{j}P_{ji}。\n$$\n对于不相邻的节点对，等式两边均为零，而自环不影响可逆性。因此 $\\pi$ 是平稳且唯一的。\n\n计算 $K_{2,3}$ 中各节点的度：\n$$\n\\deg(u_{1})=\\deg(u_{2})=3,\\quad \\deg(v_{1})=\\deg(v_{2})=\\deg(v_{3})=2.\n$$\n因此\n$$\nS=\\sum_{k}\\deg(k)=2\\cdot 3+3\\cdot 2=12.\n$$\n所以，对于客户端组 $V$ 中的任意一个特定节点 $v$，\n$$\n\\pi_{v}=\\frac{\\deg(v)}{S}=\\frac{2}{12}=\\frac{1}{6}。\n$$\n该值与 $p$ 无关。\n\n因此，数据包位于某一给定客户端节点（例如 $v_{1}$）的长期时间比例为 $\\frac{1}{6}$。", "answer": "$$\\boxed{\\frac{1}{6}}$$", "id": "1281689"}, {"introduction": "这是一个更具挑战性的练习，它将我们从简单的空间移动带入对排列组合进行的抽象操作。这个问题揭示了一个更深层次的原理：非周期性可以通过组合具有不同、互质循环长度的操作而产生。通过分析置换（2-循环）和循环移位（3-循环）的相互作用，你将对构成非周期性系统的根本原因有更深刻的理解。[@problem_id:1281646]", "problem": "考虑一个离散时间马尔可夫链，其中系统状态由三个不同项（标记为 $I_1, I_2, I_3$）的一个可能排列给出。总共有 $3! = 6$ 个状态。在每个时间步，根据对当前排列 $(x_1, x_2, x_3)$ 应用的以下两种操作之一，发生状态转移：\n\n1.  **交换操作**：以概率 $p$ 交换序列中的前两项。新状态变为 $(x_2, x_1, x_3)$。\n2.  **循环移位操作**：以概率 $1-p$ 对所有三项执行循环移位。\n    *   此移位是以概率 $q$ **向左循环移位**为 $(x_2, x_3, x_1)$。\n    *   此移位是以概率 $1-q$ **向右循环移位**为 $(x_3, x_1, x_2)$。\n\n参数 $p$ 和 $q$ 是 $[0, 1]$ 范围内的常数。马尔可夫链中的一个状态，如果其周期为1，则定义为非周期的。一个状态的周期是所有从该状态出发并最终返回该状态的可能路径长度的最大公约数。如果一个马尔可夫链是不可约的，那么它的所有状态都具有相同的周期。如果链是可约的，则此性质对任何给定互通类中的所有状态都成立。\n\n对于下列哪几对参数 $(p, q)$，该马尔可夫链的所有状态都是非周期的？选择所有适用的选项。\n\nA. $(p, q) = (1, 0.5)$\n\nB. $(p, q) = (0, 1)$\n\nC. $(p, q) = (0.5, 0)$\n\nD. $(p, q) = (0, 0.5)$\n\nE. $(p, q) = (0, 0)$\n\nF. $(p, q) = (0.5, 1)", "solution": "设状态空间为三项的六个排列。将三种操作（应用于位置）定义为三符号对称群中的置换：\n- 交换前两个位置：$s=(1\\ 2)$。\n- 左循环移位：$r=(1\\ 2\\ 3)$。\n- 右循环移位：$r^{-1}=(1\\ 3\\ 2)$。\n\n在每一步，链将当前状态右乘 $s$、$r$ 或 $r^{-1}$ 中的一个，其概率分别为 $p$、$(1-p)q$ 和 $(1-p)(1-q)$。对于任意状态 $x$，$P^{n}(x,x) > 0$ 当且仅当在可用的生成元中存在一个长度为 $n$ 的字，其乘积等于单位元 $e$，且在给定的 $(p,q)$ 下具有正概率。因此，$x$ 的周期是\n$$\n\\gcd\\{\\,n \\geq 1 : \\exists \\text{ 由允许生成元构成的长度为 } n \\text{ 且乘积为 } e \\text{ 的字}\\,\\}。\n$$\n如果链是不可约的，所有状态共享相同的周期。如果链是可约的，则周期在每个互通类中是共同的。\n\n我们使用以下关系式\n$$\ns^{2}=e,\\quad r^{3}=e,\\quad r^{-1}=r^{2},\\quad rr^{-1}=r^{-1}r=e,\\quad srs=r^{-1}.\n$$\n\n对给定的参数对进行分情况讨论：\n\nA. $(p,q)=(1,0.5)$。只有 $s$ 被使用（因为 $p=1$）。那么，返回到 $e$ 的可能乘积恰好是 $s$ 的偶数次幂，得到的返回长度为 $n \\in \\{2,4,6,\\dots\\}$。因此，周期是 $\\gcd\\{2,4,6,\\dots\\}=2$，所以状态不是非周期的。\n\nB. $(p,q)=(0,1)$。只使用 $r$。那么 $r^{n}=e$ 当且仅当 $n$ 是 $3$ 的倍数，所以返回长度为 $\\{3,6,9,\\dots\\}$，周期是 $3$。该链是可约的，可分为两个大小为 $3$ 的类，在每个类中周期都是 $3$，所以状态不是非周期的。\n\nC. $(p,q)=(0.5,0)$。$s$ 和 $r^{-1}$ 都有正概率可用。那么：\n- $s^{2}=e$ 以正概率 $p^{2}>0$ 给出 $2$ 步返回。\n- $(r^{-1})^{3}=e$ 以正概率 $(1-p)^{3}(1-q)^{3}>0$ 给出 $3$ 步返回。\n因此 $2$ 和 $3$ 都是返回长度，周期是 $\\gcd(2,3)=1$。该链是不可约的，并且所有状态都是非周期的。\n\nD. $(p,q)=(0,0.5)$。只有 $r$ 和 $r^{-1}$ 可用，两者都有正概率。该链约化为两个大小为 $3$ 的互通类（$\\{e,r,r^{2}\\}$ 的陪集）。在每个类中：\n- $rr^{-1}=e$ 以正概率 $q(1-q)>0$ 产生 $2$ 步返回。\n- $r^{3}=e$ （或 $(r^{-1})^{3}=e$）以正概率 $q^{3}>0$ （或 $(1-q)^{3}>0$）产生 $3$ 步返回。\n因此，每个类内的周期是 $\\gcd(2,3)=1$，所以每个状态都是非周期的。\n\nE. $(p,q)=(0,0)$。只使用 $r^{-1}$。与情况 B 类似（用 $r^{-1}$ 代替 $r$），返回只在步数为 $3$ 的倍数时发生，所以周期为 $3$。状态不是非周期的。\n\nF. $(p,q)=(0.5,1)$。$s$ 和 $r$ 都有正概率可用。那么：\n- $s^{2}=e$ 以概率 $p^{2}>0$ 给出 $2$ 步返回。\n- $r^{3}=e$ 以概率 $(1-p)^{3}q^{3}>0$ 给出 $3$ 步返回。\n因此，周期是 $\\gcd(2,3)=1$，并且该链是不可约的，所有状态都是非周期的。\n\n汇总所有非周期的情况，正确的选项是 C、D 和 F。", "answer": "$$\\boxed{CDF}$$", "id": "1281646"}]}