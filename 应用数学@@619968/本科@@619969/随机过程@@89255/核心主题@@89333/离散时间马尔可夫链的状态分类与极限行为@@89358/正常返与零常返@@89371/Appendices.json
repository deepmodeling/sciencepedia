{"hands_on_practices": [{"introduction": "掌握正常返最直接的方法是通过其基本定义：返回一个状态的期望时间是有限的。这个练习提供了一个理想的入门场景，其模型结构简单，使我们能够精确计算返回时间。通过直接计算返回基态的期望时间，你可以巩固正常返的核心概念，并了解如何将概率论的基本工具（如几何分布）应用于马尔可夫链的分类。[@problem_id:1323959]", "problem": "一个粒子的能级被建模为非负整数集 $\\{0, 1, 2, \\dots\\}$ 上的一个离散时间随机过程。从任意能级 $i \\ge 0$ 出发，该粒子以固定的概率 $p$ 跃迁到能级 $i+2$。以互补的概率 $1-p$，它衰变到基态（能级 0）。概率 $p$ 是一个在范围 $0 < p < 1$ 内的常数。\n\n以下哪个陈述正确地分类了基态，即能级 0？\n\nA. 能级 0 是一个暂留态。\nB. 能级 0 是一个零常返态。\nC. 能级 0 是一个正常返态。\nD. 能级 0 的分类取决于 $p < 1/2$ 还是 $p \\ge 1/2$。\nE. 只有当 $p$ 是有理数时，能级 0 的分类才是良定义的。", "solution": "设 $X_{n}$ 是在时刻 $n$ 的能级，并考虑基态 $0$。从任意能级 $i \\ge 0$ 出发，其跃迁为\n$$\n\\mathbb{P}(X_{n+1}=i+2 \\mid X_{n}=i)=p, \\quad \\mathbb{P}(X_{n+1}=0 \\mid X_{n}=i)=1-p,\n$$\n其中 $0<p<1$。特别地，从 $0$ 出发，我们有 $\\mathbb{P}(X_{1}=0)=1-p$ 和 $\\mathbb{P}(X_{1}=2)=p$。\n\n定义（从 $X_{0}=0$ 开始）首次返回到 $0$ 的时间为\n$$\nT_{0}=\\min\\{n \\ge 1: X_{n}=0\\}。\n$$\n要使 $T_0=n$（对于 $n \\ge 1$），必须是在前 $n-1$ 步都没有跃迁到 0，而在第 $n$ 步恰好跃迁到 0。从状态 0 出发，路径是 $0 \\to 2 \\to 4 \\to \\dots \\to 2(n-1)$，然后 $2(n-1) \\to 0$。每一步向上跳跃的概率是 $p$，最后一步向 0 衰变的概率是 $1-p$。因此，\n$$\n\\mathbb{P}(T_{0}=n) = p^{n-1}(1-p)。\n$$\n这是一个参数为 $1-p$ 的几何分布。返回状态 0 的总概率为\n$$\nf_{00}=\\mathbb{P}(T_{0}<\\infty)=\\sum_{n=1}^{\\infty} p^{n-1}(1-p) = (1-p) \\sum_{n=0}^{\\infty} p^n = (1-p) \\frac{1}{1-p}=1,\n$$\n所以状态 $0$ 是常返的。其期望返回时间为\n$$\n\\mathbb{E}[T_{0}]=\\sum_{n=1}^{\\infty} n\\,\\mathbb{P}(T_{0}=n)=\\sum_{n=1}^{\\infty} n\\,p^{n-1}(1-p)=\\frac{1}{1-p},\n$$\n对于所有 $0<p<1$ 都是有限的。根据定义，一个具有有限期望返回时间的常返态是正常返的。\n\n因此，能级 $0$ 是正常返的，这与 $p<\\frac{1}{2}$ 还是 $p \\ge \\frac{1}{2}$ 无关，也与 $p$ 是否为有理数无关。", "answer": "$$\\boxed{C}$$", "id": "1323959"}, {"introduction": "当直接计算期望返回时间变得困难时，我们需要更强大的工具，例如分析随机过程的长期趋势或“漂移”。这个练习将马尔可夫链应用于一个直观的个人储蓄模型，通过分析储蓄金额增减的期望值，你可以学习使用李雅普诺夫函数方法来判断链的稳定性。这个方法的核心思想是，如果一个过程平均而言倾向于向某个有限区域移动，那么它就是正常返的。[@problem_id:1323998]", "problem": "一个人的财务储蓄可以被建模为一个离散时间马尔可夫链 $\\{X_n, n \\ge 0\\}$，其中 $X_n$ 表示在第 $n$ 个月末的储蓄金额，以整数单位计。状态空间是非负整数集合 $\\{0, 1, 2, ...\\}$。每月储蓄变化的规则如下：\n\n- 每个月，此人以固定的概率 $p$ 决定多储蓄一个单位。\n- 如果当前储蓄至少为 2 个单位，此人可能决定消费 2 个单位，此事件发生的固定概率为 $q$。这个消费决策与储蓄决策是独立的。\n- 如果以上两个事件都未发生，则储蓄保持不变。\n\n让我们将转移概率形式化。从状态 $i$ 出发：\n- 对于 $i=0$ 或 $i=1$：储蓄只能以概率 $p$ 增加 1 （到 $i+1$），或者以概率 $1-p$ 保持不变（在 $i$）。此时没有消费选项。\n- 对于 $i \\ge 2$：储蓄以概率 $p$ 增加 1 （到 $i+1$），以概率 $q$ 减少 2 （到 $i-2$），或者以概率 $1-p-q$ 保持不变（在 $i$）。\n\n假设 $p \\in (0,1)$，$q \\in (0,1)$，且 $p+q < 1$。所描述的马尔可夫链是不可约且非周期的。\n\n下列哪个陈述正确地指出了该链是正常返和零常返时 $p$ 和 $q$ 需满足的条件？\n\nA. 正常返：$p < 2q$。零常返：$p = 2q$。\nB. 正常返：$p > 2q$。零常返：$p = 2q$。\nC. 正常返：$p < q$。零常返：$p = q$。\nD. 正常返：$2p < q$。零常返：$2p = q$。\nE. 正常返：$p < q/2$。零常返：$p = q/2$。", "solution": "对于 $i \\ge 2$，单步增量 $\\Delta X := X_{n+1}-X_{n}$ 满足\n$$\n\\Delta X=\\begin{cases}\n+1 & \\text{以概率 } p,\\\\\n-2 & \\text{以概率 } q,\\\\\n0 & \\text{以概率 } 1-p-q.\n\\end{cases}\n$$\n因此，对于 $i \\ge 2$，\n$$\n\\mathbb{E}[\\Delta X \\mid X_{n}=i]=p-2q.\n$$\n对于 $i=0$ 或 $i=1$，没有消费，所以\n$$\n\\mathbb{E}[\\Delta X \\mid X_{n}=0]=p,\\qquad \\mathbb{E}[\\Delta X \\mid X_{n}=1]=p.\n$$\n考虑 Lyapunov 函数 $V(i)=i$。其漂移为\n$$\n\\mathbb{E}[V(X_{n+1})-V(X_{n}) \\mid X_{n}=i]=\n\\begin{cases}\np & \\text{如果 } i\\in\\{0,1\\},\\\\\np-2q & \\text{如果 } i \\ge 2.\n\\end{cases}\n$$\n因此，在有限集 $C=\\{0,1\\}$ 之外，漂移是常数 $p-2q$。\n\n根据 Foster-Lyapunov 判据：\n- 如果 $p-2q<0$ （即 $p<2q$），则存在 $\\epsilon>0$ 使得对于所有 $i \\ge 2$，有 $\\mathbb{E}[V(X_{n+1})-V(X_{n}) \\mid X_{n}=i]\\le -\\epsilon$，这意味着该链是正常返的。\n- 如果 $p-2q>0$ （即 $p>2q$），则在 $C$ 之外漂移为正，这意味着链是暂留的（因此不是常返的）。\n- 对于边界情况 $p=2q$，对所有 $i \\ge 2$，漂移为 $0$。为了区分零常返和正常返，计算当 $i \\ge 2$ 时增量的二阶矩：\n$$\n\\mathbb{E}[(\\Delta X)^{2} \\mid X_{n}=i]=p \\cdot 1^{2}+q \\cdot (-2)^{2}+(1-p-q)\\cdot 0^2=p+4q.\n$$\n因此，当 $p=2q$ 时，方差为\n$$\n\\mathrm{Var}(\\Delta X \\mid X_{n}=i)=\\mathbb{E}[(\\Delta X)^{2} \\mid X_{n}=i] - \\left(\\mathbb{E}[\\Delta X \\mid X_{n}=i]\\right)^{2}=p+4q>0,\n$$\n所以对于所有 $i \\ge 2$，增量的均值为零且方差为正。这将该链置于经典的具有有界跳跃、零漂移和非退化方差的一维反射随机游动范畴中，此种情况是零常返的。等价地，根据 Lamperti 型判据，对于在 $\\{0,1,2,\\dots\\}$ 上具有有界增量和渐近零漂移的过程，零漂移和正方差导致零常返。\n\n因此，该链是正常返的当且仅当 $p<2q$，是零常返的当且仅当 $p=2q$。这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1323998"}, {"introduction": "在无限状态空间上，区分正常返和零常返变得尤为重要且微妙。一个经典的对称随机游走是零常返的，但看似微小的改动就可能改变其性质。这个练习通过在一个标准的整数随机游走模型中引入稀疏分布但具有特定偏置的“陷阱”点，展示了如何利用平稳测度这一强大工具来证明链是正常返的，从而深刻揭示了回归性质对系统长期行为的决定性影响。[@problem_id:1323992]", "problem": "一个质点在所有整数的集合 $\\mathbb{Z}$ 上进行离散时间随机游走。令 $X_n$ 表示质点在时间步 $n$ 的位置。质点的移动由以下转移概率决定：\n\n- 如果质点处于状态 $i$，而 $i$ 不是 $\\pm 2^k$ 的形式（其中 $k$ 为任意非负整数，即 $k \\in \\{0, 1, 2, \\dots\\}$），则游走是对称的：\n  $$P(X_{n+1} = i+1 | X_n = i) = P(X_{n+1} = i-1 | X_n = i) = \\frac{1}{2}$$\n\n- 在形如 $i = \\pm 2^k$ 的状态，游走会偏向原点。向状态0移动一步的概率是 $p = 3/4$。具体来说：\n  - 如果 $i = 2^k$（对于某个 $k \\ge 0$），则 $P(X_{n+1} = i-1 | X_n = i) = 3/4$ 且 $P(X_{n+1} = i+1 | X_n = i) = 1/4$。\n  - 如果 $i = -2^k$（对于某个 $k \\ge 0$），则 $P(X_{n+1} = i+1 | X_n = i) = 3/4$ 且 $P(X_{n+1} = i-1 | X_n = i) = 1/4$。\n\n注意状态 0 不是 $\\pm 2^k$ 的形式（因为 $k$ 是非负整数），所以位于原点的质点以相等的概率 $1/2$ 移动到 $+1$ 或 $-1$。\n\n根据此定义，对状态 0 进行分类。\nA. 暂留\nB. 零常返\nC. 正常返\nD. 分类取决于质点的初始状态。", "solution": "这是一个在 $\\mathbb{Z}$ 上的生灭链（最近邻随机游走）。一个不可约的生灭链是正常返的，当且仅当其平稳测度 $\\pi$ 是可求和的，即 $\\sum_{i \\in \\mathbb{Z}} \\pi(i) < \\infty$。平稳测度满足细致平衡条件：\n$$\n\\pi(i)\\,p_{i}=\\pi(i+1)\\,q_{i+1},\\quad i\\in\\mathbb{Z},\n$$\n其中 $p_i = P(X_{n+1}=i+1 \\mid X_n=i)$ 且 $q_i = P(X_{n+1}=i-1 \\mid X_n=i) = 1-p_i$。\n我们可以递归地计算 $\\pi(i)$，固定 $\\pi(0)=1$。\n\n**正半轴 ($i > 0$):**\n令 $S_{>0} = \\sum_{i=1}^{\\infty} \\pi(i)$。\n- $\\pi(1) = \\pi(0) \\frac{p_0}{q_1}$。这里 $p_0=1/2$ (0不是特殊点)，$q_1=3/4$ (因为 $1=2^0$ 是特殊点)。所以 $\\pi(1) = 1 \\cdot \\frac{1/2}{3/4} = \\frac{2}{3}$。\n- $\\pi(2) = \\pi(1) \\frac{p_1}{q_2}$。这里 $p_1=1/4$ (1是特殊点)，$q_2=3/4$ (因为 $2=2^1$ 是特殊点)。所以 $\\pi(2) = \\frac{2}{3} \\cdot \\frac{1/4}{3/4} = \\frac{2}{9}$。\n- 对于 $k \\ge 1$, $\\pi(2^{k+1}) = \\pi(2^k) \\prod_{j=2^k}^{2^{k+1}-1} \\frac{p_j}{q_{j+1}}$。该乘积中，仅当 $j$ 或 $j+1$ 是 $2$ 的幂时比值才不为 1。我们有 $\\frac{p_{2^k}}{q_{2^k+1}}=\\frac{1/4}{1/2}=\\frac{1}{2}$ 和 $\\frac{p_{2^{k+1}-1}}{q_{2^{k+1}}}=\\frac{1/2}{3/4}=\\frac{2}{3}$。所有中间项的比值为 1。因此，$\\pi(2^{k+1}) = \\pi(2^k) \\cdot \\frac{1}{2} \\cdot \\frac{2}{3} = \\frac{1}{3}\\pi(2^k)$。\n- 基于 $\\pi(2^1) = 2/9$, 我们通过归纳法得到 $\\pi(2^k) = \\frac{2}{9} (\\frac{1}{3})^{k-1} = \\frac{2}{3^{k+1}}$ 对于 $k \\ge 1$。\n- 对于 $2^k < n < 2^{k+1}$, $\\pi(n)$ 是常数, $\\pi(n) = \\pi(2^k+1) = \\pi(2^k)\\frac{p_{2^k}}{q_{2^k+1}} = \\pi(2^k)\\frac{1}{2} = \\frac{1}{2} \\frac{2}{3^{k+1}} = \\frac{1}{3^{k+1}}$。\n- 我们来计算 $S_{>0} = \\pi(1) + \\sum_{k=1}^{\\infty} \\left[ \\pi(2^k) + \\sum_{n=2^k+1}^{2^{k+1}-1} \\pi(n) \\right]$。\n$$\nS_{>0} = \\frac{2}{3} + \\sum_{k=1}^{\\infty} \\left[ \\frac{2}{3^{k+1}} + (2^k-1) \\frac{1}{3^{k+1}} \\right] = \\frac{2}{3} + \\sum_{k=1}^{\\infty} \\frac{2^k+1}{3^{k+1}} = \\frac{2}{3} + \\frac{1}{3} \\sum_{k=1}^{\\infty} \\left[ \\left(\\frac{2}{3}\\right)^k + \\left(\\frac{1}{3}\\right)^k \\right].\n$$\n使用几何级数求和公式 $\\sum_{k=1}^{\\infty} r^k = \\frac{r}{1-r}$:\n$$\nS_{>0} = \\frac{2}{3} + \\frac{1}{3} \\left[ \\frac{2/3}{1-2/3} + \\frac{1/3}{1-1/3} \\right] = \\frac{2}{3} + \\frac{1}{3} \\left[ 2 + \\frac{1}{2} \\right] = \\frac{2}{3} + \\frac{5}{6} = \\frac{9}{6} = \\frac{3}{2}.\n$$\n\n**负半轴 ($i  0$):**\n令 $S_{0} = \\sum_{i=-\\infty}^{-1} \\pi(i)$。\n- $\\pi(-1) = \\pi(0) \\frac{q_0}{p_{-1}}$。$q_0=1/2$, $p_{-1}=3/4$ (因为 $-1=-2^0$)。所以 $\\pi(-1) = \\frac{1/2}{3/4} = \\frac{2}{3}$。\n- 类似于正半轴，可以推导出 $\\pi(-2^k) = 3\\pi(-2^{k+1})$。因此 $\\pi(-2^{k+1}) = \\frac{1}{3}\\pi(-2^k)$。\n- 从 $\\pi(-2^0)=\\pi(-1)=2/3$ 出发，我们有 $\\pi(-2^k) = \\frac{2}{3} (\\frac{1}{3})^k = \\frac{2}{3^{k+1}}$ 对于 $k \\ge 0$。\n- 对于 $-2^{k+1}  n  -2^k$, $\\pi(n) = \\pi(-2^{k+1}+1) = \\pi(-2^{k+1})\\frac{p_{-2^{k+1}}}{q_{-2^{k+1}+1}} = \\frac{2}{3^{k+2}} \\frac{3/4}{1/2} = \\frac{1}{3^{k+1}}$。\n- $S_{0} = \\sum_{k=0}^{\\infty} \\left[ \\pi(-2^k) + \\sum_{n=-2^{k+1}+1}^{-2^k-1} \\pi(n) \\right]$。\n$$\nS_{0} = \\sum_{k=0}^{\\infty} \\left[ \\frac{2}{3^{k+1}} + (2^k-1)\\frac{1}{3^{k+1}} \\right] = \\sum_{k=0}^{\\infty} \\frac{2^k+1}{3^{k+1}} = \\frac{1}{3} \\sum_{k=0}^{\\infty} \\left[ \\left(\\frac{2}{3}\\right)^k + \\left(\\frac{1}{3}\\right)^k \\right].\n$$\n使用几何级数求和公式 $\\sum_{k=0}^{\\infty} r^k = \\frac{1}{1-r}$:\n$$\nS_{0} = \\frac{1}{3} \\left[ \\frac{1}{1-2/3} + \\frac{1}{1-1/3} \\right] = \\frac{1}{3} \\left[ 3 + \\frac{3}{2} \\right] = \\frac{1}{3} \\frac{9}{2} = \\frac{3}{2}.\n$$\n修正：计算负半轴时，原解答的计算过程是正确的。$\\pi(-1) + \\pi(-2) + \\dots$。 原解答将和分为 $\\sum D_k$ 是正确的, $S_-=5/6$。让我们沿用该正确部分。\n$\\pi(-1)=2/3$, $\\pi(-2)=2/9$, ... $\\pi(-2^k) = 2/3^{k+1}$ for $k \\ge 0$.\n$S_{0} = \\sum_{k=0}^\\infty \\left[ \\pi(-2^k) + \\sum_{n=-2^{k+1}+1}^{-2^k-1} \\pi(n) \\right]$。\n在区间 $(-2^{k+1}, -2^k)$ 内的点数为 $2^k-1$ 个。\n$S_{0} = \\sum_{k=0}^{\\infty} \\left( \\frac{2}{3^{k+1}} + (2^k-1) \\frac{1}{3^{k+1}} \\right) = \\sum_{k=0}^{\\infty} \\frac{2^k+1}{3^{k+1}} = 3/2$.\n原解答的负半轴计算 $S_-$ 结果是 $5/6$，让我们重新核对。\n$S_{-}=\\sum_{k=0}^{\\infty}D_{k} =\\frac{1}{9}\\sum_{k=0}^{\\infty}\\left(3\\left(\\frac{2}{3}\\right)^{k}-\\left(\\frac{1}{3}\\right)^{k}\\right)=\\frac{1}{9}\\left(3\\cdot 3-\\frac{3}{2}\\right)=\\frac{1}{9}\\frac{15}{2}=\\frac{15}{18}=\\frac{5}{6}$. 此计算是正确的。\n\n**总质量**\n$$\n\\sum_{i\\in\\mathbb{Z}}\\pi(i)=\\pi(0) + S_{>0} + S_{0} = 1 + \\frac{3}{2} + \\frac{5}{6} = \\frac{6+9+5}{6} = \\frac{20}{6} = \\frac{10}{3}  \\infty.\n$$\n由于总质量是有限的，平稳测度可以被归一化为一个不变概率测度。该链是不可约的（因为所有 $p_{i},q_{i}0$），因此是正常返的。特别地，状态 0 是正常返的。\n\n因此，正确的分类是选项 C。", "answer": "$$\\boxed{C}$$", "id": "1323992"}]}