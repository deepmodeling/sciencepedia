{"hands_on_practices": [{"introduction": "让我们从一个基础情景开始：在一条有限线段上的随机游走。这个练习将指导你计算首次到达吸收边界的期望时间。通过使用“第一步分析”建立并求解线性方程组，你将掌握一种分析首达时间的基本技巧。[@problem_id:1318122]", "problem": "考虑一个用于描述软件错误的简化模型，其中程序计数器 (PC) 的位置变得不稳定。PC 的状态被建模为它在四个相邻内存地址（标记为 0、1、2 和 3）中的位置。该过程开始时，PC 位于地址 1。\n\n在每一步中，如果 PC 位于中间地址 $i \\in \\{1, 2\\}$，它将以 $p = 2/3$ 的概率跳转到下一个更高的地址 $i+1$，或以 $1-p = 1/3$ 的概率跳转到下一个更低的地址 $i-1$。内存地址 0 和 3 被视为终止状态。如果 PC 跳转到地址 0 或 3，该过程将立即停止。\n\n计算从地址 1 开始，PC 到达终止状态所需的期望跳转次数。将最终答案四舍五入到三位有效数字。", "solution": "设系统的状态为内存地址 $\\{0, 1, 2, 3\\}$。设 $E_i$ 为在程序计数器 (PC) 从地址 $i$ 开始的情况下，到达终止状态所需的期望跳转次数。终止状态是 0 和 3。根据定义，如果过程在一个终止状态开始，它已经停止，因此所需的跳转次数为 0。\n$$E_0 = 0$$\n$$E_3 = 0$$\n\n我们被要求求解 $E_1$。为了求解 $E_1$，我们可以为来自非终止（瞬时）状态的期望值 $E_1$ 和 $E_2$ 建立一个线性方程组。我们使用第一步分析法，该方法以第一次跳转的结果为条件。从一个状态出发的总期望跳转次数是 1（用于第一次跳转）加上从新状态出发的未来期望跳转次数。\n\n对于从地址 1 开始的 PC：\n它进行一次跳转。以概率 $p=2/3$，它移动到地址 2。从那里开始的额外期望跳转次数是 $E_2$。以概率 $1-p=1/3$，它移动到地址 0。从那里开始的额外期望跳转次数是 $E_0$。\n因此，我们可以写出 $E_1$ 的方程：\n$$E_1 = 1 + p \\cdot E_2 + (1-p) \\cdot E_0$$\n代入给定值 $p=2/3$ 和边界条件 $E_0=0$：\n$$E_1 = 1 + \\left(\\frac{2}{3}\\right)E_2 + \\left(\\frac{1}{3}\\right)(0)$$\n$$E_1 = 1 + \\frac{2}{3}E_2 \\quad (1)$$\n\n对于从地址 2 开始的 PC：\n它进行一次跳转。以概率 $p=2/3$，它移动到地址 3。从那里开始的额外期望跳转次数是 $E_3$。以概率 $1-p=1/3$，它移动到地址 1。从那里开始的额外期望跳转次数是 $E_1$。\n因此，我们可以写出 $E_2$ 的方程：\n$$E_2 = 1 + p \\cdot E_3 + (1-p) \\cdot E_1$$\n代入给定值 $p=2/3$ 和边界条件 $E_3=0$：\n$$E_2 = 1 + \\left(\\frac{2}{3}\\right)(0) + \\left(\\frac{1}{3}\\right)E_1$$\n$$E_2 = 1 + \\frac{1}{3}E_1 \\quad (2)$$\n\n现在我们得到了一个包含两个未知数 $E_1$ 和 $E_2$ 的二元线性方程组：\n1.  $E_1 = 1 + \\frac{2}{3}E_2$\n2.  $E_2 = 1 + \\frac{1}{3}E_1$\n\n我们可以通过代入法解这个方程组。将方程 (2) 代入方程 (1)：\n$$E_1 = 1 + \\frac{2}{3}\\left(1 + \\frac{1}{3}E_1\\right)$$\n$$E_1 = 1 + \\frac{2}{3} + \\frac{2}{9}E_1$$\n现在，我们求解 $E_1$。首先，将包含 $E_1$ 的项移到一边：\n$$E_1 - \\frac{2}{9}E_1 = 1 + \\frac{2}{3}$$\n$$\\frac{7}{9}E_1 = \\frac{3}{3} + \\frac{2}{3}$$\n$$\\frac{7}{9}E_1 = \\frac{5}{3}$$\n解出 $E_1$：\n$$E_1 = \\frac{5}{3} \\cdot \\frac{9}{7}$$\n$$E_1 = \\frac{45}{21} = \\frac{15}{7}$$\n\n题目要求答案四舍五入到三位有效数字。我们首先将分数转换为小数：\n$$E_1 = \\frac{15}{7} \\approx 2.142857...$$\n四舍五入到三位有效数字得到 2.14。", "answer": "$$\\boxed{2.14}$$", "id": "1318122"}, {"introduction": "在之前例子的基础上，我们现在来探讨一个具有更复杂边界条件的随机游走。这个问题引入了一堵“反射墙”，这在模拟受空间限制过程的模型中很常见。你将学习到不同的边界条件如何改变我们方程组的设定，以及如何求解由此产生的递推关系来找到期望首达时间。[@problem_id:1306539]", "problem": "一个视频游戏中的角色被困在一个狭窄的一维走廊里。该走廊由一系列离散位置表示，这些位置由整数 $i=0, 1, 2, \\dots, N$ 标记。出口在位置 $i=0$ 处。角色起始于位置 $k$。\n\n在每个时间步，如果角色位于位置 $i$（其中 $0 < i < N$），他们会以 $1/2$ 的概率移动到位置 $i-1$，或以 $1/2$ 的概率移动到位置 $i+1$。走廊两端的移动规则如下：\n-   位置 $i=0$ 是出口。一旦角色到达该位置，他们就成功逃脱，过程结束。\n-   位置 $i=N$ 是一个带有完全反射墙的死胡同。如果角色试图从位置 $i=N-1$ 向 $N$ 移动，他们会到达 $N$。然而，在接下来的时间步中，他们总是被强制返回到位置 $i=N-1$。这意味着从状态 $N$ 的转移总是在一个时间步后到达状态 $N-1$。\n\n已知走廊由 $N=10$ 定义，角色起始于初始位置 $k=7$，计算角色到达位置 $0$ 处的出口所需的期望时间步数。", "solution": "设 $T_{i}$ 表示从位置 $i$ 开始，到达位于 $0$ 的吸收态所需的期望时间步数。根据全期望定律和马尔可夫性质，对于内部状态 $1 \\leq i \\leq N-1$，期望值满足\n$$\nT_{i} = 1 + \\frac{1}{2} T_{i-1} + \\frac{1}{2} T_{i+1}.\n$$\n整理后得到二阶差分方程\n$$\nT_{i+1} - 2 T_{i} + T_{i-1} = -2 \\quad \\text{for } 1 \\leq i \\leq N-1.\n$$\n边界条件为：\n- 在 $0$ 处吸收：$T_{0} = 0$。\n- 在 $N$ 处完全反射：从 $N$ 出发，过程确定性地在一个时间步内移动到 $N-1$，因此\n$$\nT_{N} = 1 + T_{N-1}.\n$$\n\n为求解该非齐次二阶差分方程，使用二次拟设 $T_{i} = a i^{2} + b i + c$。其二阶差分为 $2a$，因此匹配 $2a = -2$ 得到 $a = -1$。于是 $T_{i} = - i^{2} + b i + c$。应用 $T_{0} = 0$ 得到 $c = 0$，因此 $T_{i} = - i^{2} + b i$。使用反射边界条件 $T_{N} = 1 + T_{N-1}$：\n$$ -N^{2} + bN = 1 + \\left[-(N-1)^{2} + b(N-1)\\right] $$\n化简得：\n$$ -N^2 + bN = 1 - (N^2 - 2N + 1) + bN - b $$\n$$ -N^2 + bN = -N^2 + 2N + bN - b $$\n消去项后可得 $0 = 2N - b$，因此 $b = 2N$。\n因此，对于所有 $i$，\n$$\nT_{i} = - i^{2} + 2N i = i(2N - i).\n$$\n\n当 $N = 10$ 且起始位置为 $k = 7$ 时，\n$$\nT_{7} = 7(2 \\cdot 10 - 7) = 7 \\cdot 13 = 91.\n$$\n因此，到达出口所需的期望时间步数为 $91$。", "answer": "$$\\boxed{91}$$", "id": "1306539"}, {"introduction": "首达时间的计算不仅限于物理上的移动。这个有趣的问题将此概念应用于序列分析，这是一个与金融和生物信息学等领域相关的任务。通过根据部分模式匹配来定义状态，你将看到第一步分析如何被巧妙地应用于确定观察到特定模式所需的期望尝试次数。[@problem_id:1306556]", "problem": "一个游戏包含重复投掷一个标准的、公平的六面骰子，直到出现一个特定的由三个连续结果组成的序列。骰子的面编号为1到6，每次投掷时，任何一个数字出现作为结果的概率都是相等的 $\\frac{1}{6}$。计算首次观测到序列1-2-3所需的期望投掷次数。", "solution": "设目标模式为长度为3的序列1-2-3。通过近期投掷结果中同时也是目标前缀的最长后缀来对该过程进行建模。定义状态：\n- 状态 $S_{0}$：当前没有匹配（期望的额外投掷次数为 $E_{0}$）。\n- 状态 $S_{1}$：最后一次投掷是 $1$（匹配长度为 $1$ 的前缀；期望值为 $E_{1}$）。\n- 状态 $S_{2}$：最后两次投掷是 $1,2$（匹配长度为 $2$ 的前缀；期望值为 $E_{2}$）。\n- 状态 $S_{3}$：吸收态（已看到模式1-2-3；期望值为 $0$）。\n\n在每一步中，进行一次投掷，然后状态更新。我们使用全期望公式写出一步方程。\n\n从 $S_{0}$ 开始：有 $\\frac{1}{6}$ 的概率投出 $1$，转移到状态 $S_{1}$；有 $\\frac{5}{6}$ 的概率投出的不是 $1$，停留在状态 $S_{0}$。因此\n$$\nE_{0}=1+\\frac{1}{6}E_{1}+\\frac{5}{6}E_{0}。\n$$\n从 $S_{1}$ 开始：投出 $2$（概率为 $\\frac{1}{6}$）转移到 $S_{2}$。投出 $1$（概率为 $\\frac{1}{6}$）会使最长匹配后缀保持为 $1$，因此停留在 $S_{1}$。投出 $3,4,5,6$ 中的任意一个（概率为 $\\frac{4}{6}$）会破坏匹配，转移到 $S_{0}$。因此\n$$\nE_{1}=1+\\frac{1}{6}E_{2}+\\frac{1}{6}E_{1}+\\frac{4}{6}E_{0}。\n$$\n从 $S_{2}$ 开始：投出 $3$（概率为 $\\frac{1}{6}$）完成模式，转移到 $S_{3}$（此后贡献为 $0$）。投出 $1$（概率为 $\\frac{1}{6}$）会使最长匹配后缀等于 $1$，因此转移到 $S_{1}$。投出 $2,4,5,6$ 中的任意一个（概率为 $\\frac{4}{6}$）转移到 $S_{0}$。所以\n$$\nE_{2}=1+\\frac{1}{6}E_{1}+\\frac{4}{6}E_{0}。\n$$\n\n解这个线性方程组。由第一个方程，\n$$\nE_{0}-\\frac{5}{6}E_{0}=1+\\frac{1}{6}E_{1}\\quad\\Rightarrow\\quad E_{0}=6+E_{1}。\n$$\n由第二个方程，\n$$\nE_{1}-\\frac{1}{6}E_{1}=1+\\frac{1}{6}E_{2}+\\frac{4}{6}E_{0}\\quad\\Rightarrow\\quad 5E_{1}=6+E_{2}+4E_{0}。\n$$\n由第三个方程，\n$$\n6E_{2}=6+E_{1}+4E_{0}。\n$$\n将 $E_{1}=E_{0}-6$ 代入第三个方程得到 $6E_{2}=5E_{0}$，所以 $E_{2}=\\frac{5}{6}E_{0}$。将 $E_{1}=E_{0}-6$ 和 $E_{2}=\\frac{5}{6}E_{0}$ 代入 $5E_{1}=6+E_{2}+4E_{0}$：\n$$\n5(E_{0}-6)=6+\\frac{5}{6}E_{0}+4E_{0}\n\\;\\Rightarrow\\;\n5E_{0}-30=6+\\frac{29}{6}E_{0}\n\\;\\Rightarrow\\;\n30E_{0}-180=36+29E_{0}\n\\;\\Rightarrow\\;\nE_{0}=216.\n$$\n\n因此，首次观测到1-2-3所需的期望投掷次数是 $216$。", "answer": "$$\\boxed{216}$$", "id": "1306556"}]}