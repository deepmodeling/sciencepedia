{"hands_on_practices": [{"introduction": "时间可逆性的核心在于细致平衡方程。本练习提供了一个直接的机会来检验您对该定义的理解。通过将给定的马尔可夫链转移矩阵 $P$ 和一个提议的分布 $\\pi$ 代入细致平衡方程 $\\pi_i P_{ij} = \\pi_j P_{ji}$，您将能够确定该链相对于此分布是否是时间可逆的。[@problem_id:1346316]", "problem": "一个描述单个Web服务器运行状态的简化模型由一个具有三个状态的离散时间马尔可夫链给出：状态 1 (空闲)、状态 2 (处理中) 和状态 3 (超载)。状态之间的转换在固定的时间间隔进行观察，其单步转移概率矩阵 $P = (P_{ij})$ 如下所示：\n$$ P = \\begin{pmatrix} 0.5 & 0.5 & 0 \\\\ 0.2 & 0.6 & 0.2 \\\\ 0 & 0.7 & 0.3 \\end{pmatrix} $$\n其中 $P_{ij}$ 是从状态 $i$ 转移到状态 $j$ 的概率。\n\n一位系统工程专业的学生提出，该服务器的长期行为可以用分布 $\\pi = (\\pi_1, \\pi_2, \\pi_3) = \\left(\\frac{1}{4}, \\frac{1}{2}, \\frac{1}{4}\\right)$ 来描述。\n\n你的任务是判断该马尔可夫链关于这个给定的分布 $\\pi$ 是否是时间可逆的。如果对于所有状态对 $i$ 和 $j$，细致平衡方程 $\\pi_i P_{ij} = \\pi_j P_{ji}$ 都成立，那么该马尔可夫链关于分布 $\\pi$ 是时间可逆的。\n\n以下哪个陈述是正确的？\n\nA. 该链关于 $\\pi$ 是时间可逆的。\n\nB. 该链不是时间可逆的，且细致平衡方程仅对状态对 (1, 2) 不成立。\n\nC. 该链不是时间可逆的，且细致平衡方程仅对状态对 (2, 3) 不成立。\n\nD. 该链不是时间可逆的，且细致平衡方程对状态对 (1, 2) 和 (2, 3) 都不成立。\n\nE. 给定的分布 $\\pi$ 不是平稳分布，因此关于它的时间可逆性概念没有意义。", "solution": "一个离散时间马尔可夫链关于分布 $\\pi$ 是时间可逆的，当且仅当对所有状态对 $i,j$，细致平衡方程成立：\n$$\n\\pi_i P_{ij} = \\pi_j P_{ji}\n$$\n这里，建议的分布是 $\\pi=\\left(\\frac{1}{4},\\frac{1}{2},\\frac{1}{4}\\right)$ 且转移矩阵是\n$$\nP=\\begin{pmatrix}\n0.5 & 0.5 & 0 \\\\\n0.2 & 0.6 & 0.2 \\\\\n0 & 0.7 & 0.3\n\\end{pmatrix}\n$$\n我们检验无序对 $(1,2)$、$(2,3)$ 和 $(1,3)$ 的细致平衡方程。\n\n对于状态对 $(1,2)$:\n$\\pi_1 P_{12} = \\frac{1}{4} \\cdot 0.5 = \\frac{1}{8}$\n$\\pi_2 P_{21} = \\frac{1}{2} \\cdot 0.2 = \\frac{1}{10}$\n因为 $\\frac{1}{8} \\neq \\frac{1}{10}$，所以细致平衡方程对 $(1,2)$ 不成立。\n\n对于状态对 $(2,3)$:\n$\\pi_2 P_{23} = \\frac{1}{2} \\cdot 0.2 = \\frac{1}{10}$\n$\\pi_3 P_{32} = \\frac{1}{4} \\cdot 0.7 = \\frac{7}{40}$\n因为 $\\frac{1}{10} = \\frac{4}{40} \\neq \\frac{7}{40}$，所以细致平衡方程对 $(2,3)$ 不成立。\n\n对于状态对 $(1,3)$:\n$\\pi_1 P_{13} = \\frac{1}{4} \\cdot 0 = 0$\n$\\pi_3 P_{31} = \\frac{1}{4} \\cdot 0 = 0$\n所以细致平衡方程对 $(1,3)$ 平凡地成立。\n\n因此，该链关于 $\\pi$ 不是时间可逆的，并且在状态对 $(1,2)$ 和 $(2,3)$ 上均不满足细致平衡方程。(注意：对于这个矩阵 $P$，$\\pi$ 也不是一个平稳分布，但这并不意味着关于 $\\pi$ 的时间可逆性问题是无意义的；它只是未能通过细致平衡检验。)", "answer": "$$\\boxed{D}$$", "id": "1346316"}, {"introduction": "时间可逆性不仅是一个理论概念，更是一个强大的计算工具。本练习将向您展示如何利用时间可逆性的假设来简化寻找平稳分布的过程。对于在加权图上的随机游走，求解细致平衡方程通常比求解全局平衡方程 $\\pi P = \\pi$ 更为直接和快捷。[@problem_id:1346362]", "problem": "一款新型自主维护机器人正在工厂进行测试。该机器人在三个特定的工作站（标记为 1、2 和 3）之间运行，这三个工作站连接成一个三角形网络。在任何给定时刻，机器人位于其中一个工作站。在每个离散时间步，机器人从其当前工作站移动到两个相邻工作站之一。\n\n工作站之间的路径具有不同的优先级，由正常数权重来量化。工作站 1 和 2 之间的路径权重为 $w_{12}$，工作站 2 和 3 之间的路径权重为 $w_{23}$，工作站 3 和 1 之间的路径权重为 $w_{31}$。当机器人位于一个站点时，它对下一个站点的选择是概率性的，并与连接路径的权重成正比。例如，从站点 1，机器人可以移动到站点 2 或 3。移动到站点 2 的概率由 $\\frac{w_{12}}{w_{12} + w_{31}}$ 给出，移动到站点 3 的概率为 $\\frac{w_{31}}{w_{12} + w_{31}}$。同样的逻辑适用于从站点 2 和 3 的移动。\n\n长时间运行后，系统达到一个稳态，此时在任何给定工作站找到该机器人的概率变得恒定。确定平稳分布 $\\pi = (\\pi_1, \\pi_2, \\pi_3)$，其中 $\\pi_i$ 是在工作站 $i$ 找到机器人的长期概率。用权重 $w_{12}$、$w_{23}$ 和 $w_{31}$ 表示您的答案。最终答案应表示为行矩阵 $(\\pi_1, \\pi_2, \\pi_3)$。", "solution": "设马尔可夫链的状态空间为 $\\{1,2,3\\}$，转移概率由给定的加权边定义：\n$$ P_{12}=\\frac{w_{12}}{w_{12}+w_{31}},\\quad P_{13}=\\frac{w_{31}}{w_{12}+w_{31}} $$\n$$ P_{21}=\\frac{w_{12}}{w_{12}+w_{23}},\\quad P_{23}=\\frac{w_{23}}{w_{12}+w_{23}} $$\n$$ P_{31}=\\frac{w_{31}}{w_{31}+w_{23}},\\quad P_{32}=\\frac{w_{23}}{w_{31}+w_{23}} $$\n所有其他的 $P_{ii}=0$ 且非相邻转移概率为零。\n\n这种在无向加权图上的随机游走是时间可逆的。其平稳分布 $\\pi_i$ 正比于节点 $i$ 的加权度 $d_i$。\n将节点 $i$ 的加权度定义为\n$$ d_{1}=w_{12}+w_{31},\\quad d_{2}=w_{12}+w_{23},\\quad d_{3}=w_{23}+w_{31} $$\n所以，$\\pi_i \\propto d_i$。我们可以写成 $\\pi_i = C \\cdot d_i$，其中 $C$ 是归一化常数。\n因为 $\\sum_i \\pi_i = 1$，我们有 $C(d_1+d_2+d_3)=1$。\n总度数为：\n$$ d_{1}+d_{2}+d_{3} = (w_{12}+w_{31}) + (w_{12}+w_{23}) + (w_{23}+w_{31}) = 2(w_{12}+w_{23}+w_{31}) $$\n因此，归一化常数 $C = \\frac{1}{2(w_{12}+w_{23}+w_{31})}$。\n\n平稳分布的各个分量为：\n$$ \\pi_{1}=\\frac{d_1}{d_{1}+d_{2}+d_{3}}=\\frac{w_{12}+w_{31}}{2(w_{12}+w_{23}+w_{31})} $$\n$$ \\pi_{2}=\\frac{d_2}{d_{1}+d_{2}+d_{3}}=\\frac{w_{12}+w_{23}}{2(w_{12}+w_{23}+w_{31})} $$\n$$ \\pi_{3}=\\frac{d_3}{d_{1}+d_{2}+d_{3}}=\\frac{w_{23}+w_{31}}{2(w_{12}+w_{23}+w_{31})} $$\n\n我们可以通过验证细致平衡条件 $\\pi_i P_{ij} = \\pi_j P_{ji}$ 来确认这个结果。例如，对于边 $\\{1,2\\}$:\n$\\pi_1 P_{12} = \\frac{d_1}{2\\sum w} \\cdot \\frac{w_{12}}{d_1} = \\frac{w_{12}}{2\\sum w}$\n$\\pi_2 P_{21} = \\frac{d_2}{2\\sum w} \\cdot \\frac{w_{12}}{d_2} = \\frac{w_{12}}{2\\sum w}$\n两者相等，因此细致平衡成立。\n这就得出了所要求的作为行矩阵的平稳分布。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{w_{12}+w_{31}}{2\\left(w_{12}+w_{23}+w_{31}\\right)} & \\frac{w_{12}+w_{23}}{2\\left(w_{12}+w_{23}+w_{31}\\right)} & \\frac{w_{23}+w_{31}}{2\\left(w_{12}+w_{23}+w_{31}\\right)}\\end{pmatrix}}$$", "id": "1346362"}, {"introduction": "这个练习是一个有趣的“逆向工程”问题，它能加深您对时间可逆性所蕴含的结构性约束的理解。当已知一个马尔可夫链相对于某个特定分布是时间可逆时，我们可以反过来推断其转移矩阵的性质。此问题特别展示了当平稳分布为均匀分布时，可逆性对转移矩阵的对称性要求。[@problem_id:1346359]", "problem": "一个关于单个分子的理论模型，通过其在一个表面上三个可用结合位点之一的位置来描述其状态。设这些位点由集合 $S = \\{1, 2, 3\\}$ 标记。该分子在离散时间步长上于这些位点之间随机跳跃，这个过程被建模为一个时间齐次马尔可夫链。单步转移概率矩阵记为 $P$，其中元素 $P_{ij}$ 是分子从位点 $i$ 转移到 位点 $j$ 的概率。\n\n已知该过程相对于这三个位点上的均匀分布是时间可逆的。转移矩阵 $P$ 已通过实验数据部分确定，其形式如下：\n$$\nP = \\begin{pmatrix}\na & 0.5 & c \\\\\nb & 0.2 & 0.3 \\\\\n0.1 & d & e\n\\end{pmatrix}\n$$\n其中 $a, b, c, d,$ 和 $e$ 是未知常数。\n\n确定这五个未知元素的值。将你的答案表示为一个行矩阵，其中包含按 $a, b, c, d, e$ 这个特定字母顺序排列的值。", "solution": "本题要求我们求出马尔可夫链转移矩阵 $P$ 中的未知元素。我们有两个关键信息：该链相对于均匀分布是时间可逆的，并且 $P$ 是一个有效的转移矩阵。\n\n首先，我们利用时间可逆性的性质。一个具有平稳分布 $\\pi = (\\pi_1, \\pi_2, \\ldots)$ 和转移矩阵 $P$ 的马尔可夫链，如果它满足细致平衡方程，则是时间可逆的：\n$$\n\\pi_i P_{ij} = \\pi_j P_{ji} \\quad \\text{for all states } i, j.\n$$\n在本题中，状态空间为 $S = \\{1, 2, 3\\}$，并且该链相对于均匀分布是可逆的。三个状态上的均匀分布由 $\\pi_i = \\frac{1}{3}$（对于 $i=1, 2, 3$）给出。\n\n将 $\\pi_i = \\pi_j = \\frac{1}{3}$ 代入细致平衡方程，我们得到：\n$$\n\\frac{1}{3} P_{ij} = \\frac{1}{3} P_{ji}\n$$\n这可以简化为：\n$$\nP_{ij} = P_{ji}\n$$\n这个结果意味着转移矩阵 $P$ 必须是对称的。\n\n给定的矩阵是：\n$$\nP = \\begin{pmatrix}\na & 0.5 & c \\\\\nb & 0.2 & 0.3 \\\\\n0.1 & d & e\n\\end{pmatrix}\n$$\n应用对称条件 ($P=P^T$)，我们可以使非对角元素相等：\n1.  $P_{21} = P_{12} \\implies b = 0.5$\n2.  $P_{31} = P_{13} \\implies 0.1 = c$\n3.  $P_{32} = P_{23} \\implies d = 0.3$\n\n这样，我们就求出了 $b, c$ 和 $d$ 的值。现在我们可以用这些值更新矩阵 $P$：\n$$\nP = \\begin{pmatrix}\na & 0.5 & 0.1 \\\\\n0.5 & 0.2 & 0.3 \\\\\n0.1 & 0.3 & e\n\\end{pmatrix}\n$$\n接下来，我们使用任何随机（或转移）矩阵的一个基本性质：每行中的概率之和必须等于1。\n$$\n\\sum_{j} P_{ij} = 1 \\quad \\text{for all } i.\n$$\n我们将此条件应用于包含剩余未知数 $a$ 和 $e$ 的行。\n\n对于第一行 ($i=1$)：\n$a + 0.5 + 0.1 = 1 \\implies a + 0.6 = 1 \\implies a = 0.4$\n\n对于第三行 ($i=3$)：\n$0.1 + 0.3 + e = 1 \\implies 0.4 + e = 1 \\implies e = 0.6$\n\n作为检验，我们可以验证第二行的和也为1：\n$P_{21} + P_{22} + P_{23} = 0.5 + 0.2 + 0.3 = 1.0$。该矩阵是一致的。\n\n未知数的值为：\n$a = 0.4$\n$b = 0.5$\n$c = 0.1$\n$d = 0.3$\n$e = 0.6$\n\n题目要求答案表示为一个行矩阵，其中的值按 $a, b, c, d, e$ 的顺序排列。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4 & 0.5 & 0.1 & 0.3 & 0.6\n\\end{pmatrix}\n}\n$$", "id": "1346359"}]}