{"hands_on_practices": [{"introduction": "本练习提供了一个应用“首步分析”的经典入门案例。通过对一个简单且贴近生活的场景——图书馆书籍的流转——进行建模，您将练习如何基于下一步的各种可能结果来建立一个简单的线性方程，并以此求解“可达概率”。这是一个很好的热身练习，旨在帮助您掌握解决此类问题的核心思想和基本步骤。[@problem_id:1326112]", "problem": "一所大学图书馆使用离散时间随机过程来模拟一本书的生命周期。每天观察一本书的状态，可以分为以下四种状态之一：“在架”(S)、“已借出”(C)、“在途”(T，指正在归还和处理中的图书)和“丢失”(L)。\n\n从一天到第二天的转移概率如下：\n- 一本“在架”的图书第二天将变为“已借出”，概率为1.0。\n- 一本“已借出”的图书有0.2的概率被续借（保持“已借出”状态），有0.75的概率被归还（变为“在途”），有0.05的概率被宣布“丢失”。\n- 一本“在途”的图书有0.8的概率被成功上架（变为“在架”），有0.15的概率因需进一步处理而保持“在途”状态，有0.05的概率变为“丢失”。\n- 一本“丢失”的图书将永久保持“丢失”状态。\n\n一本新书被捐赠给图书馆，其初始状态为“在途”。这本书最终能到达“在架”状态的概率是多少？请用精确分数表示你的答案。", "solution": "将每日状态建模为一个马尔可夫链，其状态为 $S$（在架）、$C$（已借出）、$T$（在途）和 $L$（丢失）。我们需要计算的是，从状态 $T$ 开始，该链至少访问一次状态 $S$ 的概率。\n\n设 $x_{T}$ 表示从 $T$ 开始最终能到达状态 $S$ 的概率。使用从状态 $T$ 开始的首步分析法：\n- 下一状态为 $S$ 的概率是 $0.8$，这算作成功，贡献值为 $1$。\n- 下一状态再次为 $T$ 的概率是 $0.15$，此后成功的概率仍然是 $x_{T}$。\n- 下一状态为 $L$ 的概率是 $0.05$，从该状态永远无法到达 $S$，贡献值为 $0$。\n\n因此，\n$$\nx_{T} = 0.8 \\cdot 1 + 0.15 \\cdot x_{T} + 0.05 \\cdot 0.\n$$\n求解方程，\n$$\nx_{T} - 0.15 x_{T} = 0.8 \\quad \\Longrightarrow \\quad 0.85 x_{T} = 0.8 \\quad \\Longrightarrow \\quad x_{T} = \\frac{0.8}{0.85} = \\frac{80}{85} = \\frac{16}{17}.\n$$\n因此，这本捐赠的图书最终能到达“在架”状态的概率是 $\\frac{16}{17}$。", "answer": "$$\\boxed{\\frac{16}{17}}$$", "id": "1326112"}, {"introduction": "在掌握了基本方法后，这个练习将引导您处理一个更普遍的情形，即多个状态相互依赖。您将发现，“首步分析”常常会导出一个线性方程组，其中从一个状态出发的成功概率取决于从其他状态出发的概率。通过为一个假设的天气模型求解这个方程组，您将学会解决在一个状态被“吸收”前到达目标状态的通用方法。[@problem_id:1326137]", "problem": "一个偏远岛屿的简化气象模型描述了每日的天气模式。任何一天的天气可以是四种类型之一：'晴天' (Sunny)、'多云' (Cloudy)、'雨天' (Rainy) 或 '暴风雨' (Storm)。该模型由以下每日转移概率决定：\n\n-   如果当天是晴天，则第二天的天气为晴天、多云或雨天的概率分别为 $0.5$、$0.4$ 和 $0.1$。\n-   如果当天是多云，则第二天的天气为晴天、多云、雨天或暴风雨的概率分别为 $0.3$、$0.4$、$0.2$ 和 $0.1$。\n-   如果当天是雨天，则第二天的天气为晴天、多云、雨天或暴风雨的概率分别为 $0.1$、$0.3$、$0.2$ 和 $0.4$。\n-   一旦出现暴风雨，天气将永久保持为'暴风雨'。\n\n假设今天是晴天。在未来，在暴风雨发生之前，至少会再有一个晴天的概率是多少？\n\n请以单一闭式解析表达式的形式给出你的答案。", "solution": "设状态为 $S$ (晴天)、$C$ (多云)、$R$ (雨天) 和 $T$ (暴风雨，吸收态)。定义 $p_{X}$ 为从状态 $X$ 开始，在到达状态 $T$ 之前先到达状态 $S$ 的概率。我们的目标是 $p_{S}$，它被解释为在到达 $T$ 之前至少重访一次 $S$ (即在时间 $\\geq 1$ 时) 的概率。\n\n根据首步分析法：\n- 从 $S$ 出发：$p_{S} = 0.5 \\cdot 1 + 0.4 p_{C} + 0.1 p_{R}$，因为从 $S$ 转移到 $S$ 的概率为 $0.5$ (立即成功)，转移到 $C$ 的概率为 $0.4$，转移到 $R$ 的概率为 $0.1$，没有直接转移到 $T$。\n- 从 $C$ 出发：$p_{C} = 0.3 \\cdot 1 + 0.4 p_{C} + 0.2 p_{R} + 0.1 \\cdot 0$，因为从 $C$ 转移到 $S$ 的概率为 $0.3$ (成功)，转移到 $C$ 的概率为 $0.4$，转移到 $R$ 的概率为 $0.2$，转移到 $T$ 的概率为 $0.1$ (失败)。\n- 从 $R$ 出发：$p_{R} = 0.1 \\cdot 1 + 0.3 p_{C} + 0.2 p_{R} + 0.4 \\cdot 0$，因为从 $R$ 转移到 $S$ 的概率为 $0.1$ (成功)，转移到 $C$ 的概率为 $0.3$，转移到 $R$ 的概率为 $0.2$，转移到 $T$ 的概率为 $0.4$ (失败)。\n\n重写关于 $p_{C}$ 和 $p_{R}$ 的线性方程组：\n$$\n\\begin{aligned}\np_{C} - 0.4 p_{C} - 0.2 p_{R} &= 0.3 \\quad \\Rightarrow \\quad 0.6 p_{C} - 0.2 p_{R} = 0.3, \\\\\np_{R} - 0.2 p_{R} - 0.3 p_{C} &= 0.1 \\quad \\Rightarrow \\quad 0.8 p_{R} - 0.3 p_{C} = 0.1.\n\\end{aligned}\n$$\n将第一个方程乘以 $10$，第二个方程乘以 $10$ 得到：\n$$\n6 p_{C} - 2 p_{R} = 3, \\qquad -3 p_{C} + 8 p_{R} = 1.\n$$\n求解该方程组得到：\n$$\np_{C} = \\frac{13}{21}, \\qquad p_{R} = \\frac{5}{14}.\n$$\n因此，\n$$\np_{S} = \\frac{1}{2} + \\frac{2}{5}\\cdot \\frac{13}{21} + \\frac{1}{10}\\cdot \\frac{5}{14} = \\frac{1}{2} + \\frac{26}{105} + \\frac{1}{28} = \\frac{210 + 104 + 15}{420} = \\frac{329}{420} = \\frac{47}{60}.\n$$\n因此，在今天是晴天的条件下，未来在发生任何暴风雨之前至少再出现一个晴天的概率是 $\\frac{47}{60}$。", "answer": "$$\\boxed{\\frac{47}{60}}$$", "id": "1326137"}, {"introduction": "这个最后的练习介绍了一种更强大的分析技巧，适用于具有规则结构的问题，例如在整数格点上的随机游走。您将不再逐个状态地建立方程，而是利用随机游走的内在属性来推断解的通用函数形式（在本例中为分段线性函数）。通过为一个带有特殊“传送”点的粒子游走问题求解边界和连接条件 [@problem_id:1326090]，您将学会如何应用这种分析方法处理局部具有不规则性的结构化问题。", "problem": "一个亚原子粒子被限制在一维整数格点上运动。其运动遵循以下规则：\n\n1.  粒子从位置 $i_0 = 0$ 开始。\n2.  在除特殊位置 $k$ 之外的任何整数位置 $j$，粒子在单位时间内有 $0.5$ 的概率移动到 $j+1$，有 $0.5$ 的概率移动到 $j-1$。\n3.  位置 $N$（一个正整数）作为一个捕获区。如果粒子到达位置 $N$，它将被吸收，过程终止。\n4.  位置 $-1$ 作为一个陷阱。如果粒子到达位置 $-1$，它也将被吸收，过程终止。\n5.  位置 $k$（其中 $0 < k < N$）有一个故障传送器。当粒子位于位置 $k$ 时，它有概率 $q$（其中 $0 < q < 1$）移动到位置 $k+1$。在剩余的概率 $1-q$ 下，传送器会激活并将粒子瞬间重新定位到位置 $0$。\n\n求粒子最终在位置 $N$ 被捕获而不是在位置 $-1$ 的陷阱中被捕获的概率。将答案表示为关于符号参数 $N$、$k$ 和 $q$ 的封闭解析表达式。", "solution": "令 $u_{j}$ 表示从位置 $j$ 开始，粒子最终在 $N$ 被吸收而不是在 $-1$ 被吸收的概率。我们需要求 $u_{0}$。\n\n对于所有 $j \\in \\mathbb{Z}$ 且 $j \\notin \\{-1,N,k\\}$，该行走是一个无偏的最近邻随机行走，因此根据首步分析，\n$$\nu_{j}=\\frac{1}{2}u_{j-1}+\\frac{1}{2}u_{j+1},\n$$\n等价地，\n$$\nu_{j+1}-2u_{j}+u_{j-1}=0.\n$$\n因此，在任何该关系成立的区间上，$u_{j}$ 是 $j$ 的仿射函数。因此设定\n$$\nu_{j}=a j+b \\quad \\text{对于 } -1 \\leq j \\leq k,\n$$\n和\n$$\nu_{j}=c j+d \\quad \\text{对于 } k \\leq j \\leq N,\n$$\n其中 $u_{k}$ 是单值的，并且必须从两侧匹配。\n\n边界条件为 $u_{-1}=0$ 和 $u_{N}=1$，得到\n$$\n-a+b=0 \\quad \\Rightarrow \\quad b=a,\n$$\n$$\ncN+d=1.\n$$\n由 $j=k$ 处的连续性可得\n$$\nak+b=ck+d.\n$$\n根据 $j=k$ 处的特殊转移规则，可得\n$$\nu_{k}=q\\,u_{k+1}+(1-q)\\,u_{0}.\n$$\n使用 $b=a$ 和仿射形式，我们计算\n$$\nu_{0}=a,\\quad u_{k}=ak+b=a(k+1),\\quad u_{k+1}=c(k+1)+d.\n$$\n由在 $k$ 处的连续性，$ck+d=ak+b=a(k+1)$，因此\n$$\nc(k+1)+d=(ck+d)+c=a(k+1)+c.\n$$\n代入到 $k$ 处的特殊关系中，\n$$\na(k+1)=q\\bigl[a(k+1)+c\\bigr]+(1-q)a.\n$$\n整理得，\n$$\na(1-q)k=qc,\n$$\n所以\n$$\nc=\\frac{a(1-q)k}{q}.\n$$\n根据右边界条件以及在 $k$ 处的连续性，\n$$\ncN+d=1,\\qquad ck+d=a(k+1),\n$$\n所以\n$$\nc(N-k)=1-a(k+1)\\quad \\Rightarrow \\quad c=\\frac{1-a(k+1)}{N-k}.\n$$\n令 $c$ 的两个表达式相等，\n$$\n\\frac{a(1-q)k}{q}=\\frac{1-a(k+1)}{N-k}.\n$$\n交叉相乘并求解 $a$，\n$$\na(1-q)k(N-k)=q\\bigl[1-a(k+1)\\bigr],\n$$\n$$\na\\bigl[(1-q)k(N-k)+q(k+1)\\bigr]=q,\n$$\n$$\na=\\frac{q}{(1-q)k(N-k)+q(k+1)}.\n$$\n由于 $u_{0}=a$，所需的捕获概率为\n$$\nu_{0}=\\frac{q}{(1-q)k(N-k)+q(k+1)}.\n$$\n这是一个以 $N$、$k$ 和 $q$ 表示的封闭形式解析表达式。", "answer": "$$\\boxed{\\frac{q}{(1-q)k(N-k)+q(k+1)}}$$", "id": "1326090"}]}