{"hands_on_practices": [{"introduction": "本练习将引导你完成一个核心应用：将一个具体场景（用户网页浏览）建模为马尔可夫链。通过构建转移矩阵并求解其平稳分布，你将能够实践遍历定理的一个基本结论：系统在每个状态花费的时间的长期比例由平稳分布给出[@problem_id:1360466]。这个练习是掌握马尔可夫链长期行为分析的基础。", "problem": "一位计算机科学家正在对一个由四个网站（标记为 W1、W2、W3 和 W4）组成的小型孤立网络上的用户浏览行为进行建模。用户从一个任意的网站开始，在每个时间步通过点击链接进行导航。\n\n该网络的链接结构和用户的导航偏好如下：\n- 从网站 W1，有指向 W2 和 W3 的链接。用户点击指向 W2 链接的概率是点击指向 W3 链接概率的两倍。\n- 从网站 W2，有指向 W1 和 W4 的链接。用户以相等的概率选择这两个链接。\n- 从网站 W3，有指向 W1 和 W4 的链接。用户以相等的概率选择这两个链接。\n- 从网站 W4，只有一个链接，该链接指回 W1。\n\n经过很长一段时间后，用户的浏览历史将显示他们在四个网站中的每一个上所花费的时间占总时间的特定比例。\n\n计算用户长期在网站 W1 上花费的时间比例与在网站 W2 上花费的时间比例之比。请将答案表示为最简分数。", "solution": "用户的浏览行为可以建模为状态空间 $S = \\{1, 2, 3, 4\\}$ 上的一个离散时间马尔可夫链，其中每个状态分别对应网站 W1、W2、W3 和 W4。在每个状态上花费的长期时间比例由该马尔可夫链的平稳分布给出。\n\n设 $P_{ij}$ 是从状态 $i$ 到状态 $j$ 的转移概率。我们首先根据问题描述确定这些概率。\n\n对于状态 1 (W1)：有指向 W2 和 W3 的链接。用户选择 W2 的可能性是选择 W3 的两倍。设 $p_2$ 是转移到 W2 的概率，$p_3$ 是转移到 W3 的概率。我们有 $p_2 = 2p_3$ 且 $p_2 + p_3 = 1$。将前者代入后者可得 $2p_3 + p_3 = 1$，所以 $3p_3 = 1$，即 $p_3 = 1/3$。那么 $p_2 = 2/3$。因此，$P_{11}=0, P_{12}=2/3, P_{13}=1/3, P_{14}=0$。\n\n对于状态 2 (W2)：有指向 W1 和 W4 的链接，以相等的概率选择。因此，$P_{21}=1/2, P_{22}=0, P_{23}=0, P_{24}=1/2$。\n\n对于状态 3 (W3)：有指向 W1 和 W4 的链接，以相等的概率选择。因此，$P_{31}=1/2, P_{32}=0, P_{33}=0, P_{34}=1/2$。\n\n对于状态 4 (W4)：只有一个指向 W1 的链接。因此，$P_{41}=1, P_{42}=0, P_{43}=0, P_{44}=0$。\n\n转移矩阵 $P$ 是：\n$$\nP = \\begin{pmatrix}\n0 & 2/3 & 1/3 & 0 \\\\\n1/2 & 0 & 0 & 1/2 \\\\\n1/2 & 0 & 0 & 1/2 \\\\\n1 & 0 & 0 & 0\n\\end{pmatrix}\n$$\n\n设 $\\pi = (\\pi_1, \\pi_2, \\pi_3, \\pi_4)$ 是平稳分布。它必须满足方程 $\\pi P = \\pi$，该方程可展开为一个线性方程组，同时还需满足归一化条件 $\\sum_{i=1}^{4} \\pi_i = 1$。\n\n从 $\\pi P = \\pi$ 得到的方程组是：\n1. $0 \\cdot \\pi_1 + \\frac{1}{2}\\pi_2 + \\frac{1}{2}\\pi_3 + 1 \\cdot \\pi_4 = \\pi_1$\n2. $\\frac{2}{3}\\pi_1 + 0 \\cdot \\pi_2 + 0 \\cdot \\pi_3 + 0 \\cdot \\pi_4 = \\pi_2$\n3. $\\frac{1}{3}\\pi_1 + 0 \\cdot \\pi_2 + 0 \\cdot \\pi_3 + 0 \\cdot \\pi_4 = \\pi_3$\n4. $0 \\cdot \\pi_1 + \\frac{1}{2}\\pi_2 + \\frac{1}{2}\\pi_3 + 0 \\cdot \\pi_4 = \\pi_4$\n\n从方程（2），我们有 $\\pi_2 = \\frac{2}{3}\\pi_1$。\n从方程（3），我们有 $\\pi_3 = \\frac{1}{3}\\pi_1$。\n\n现在我们可以将这些结果代入方程（4）中，用 $\\pi_1$ 来表示 $\\pi_4$：\n$$\n\\pi_4 = \\frac{1}{2}\\pi_2 + \\frac{1}{2}\\pi_3 = \\frac{1}{2}\\left(\\frac{2}{3}\\pi_1\\right) + \\frac{1}{2}\\left(\\frac{1}{3}\\pi_1\\right) = \\frac{1}{3}\\pi_1 + \\frac{1}{6}\\pi_1 = \\left(\\frac{2}{6} + \\frac{1}{6}\\right)\\pi_1 = \\frac{3}{6}\\pi_1 = \\frac{1}{2}\\pi_1\n$$\n（方程（1）与其他方程线性相关，可以用作检验，但对于求解各 $\\pi_i$ 之间的关系并非必需。）\n\n现在我们使用归一化条件：\n$$\n\\pi_1 + \\pi_2 + \\pi_3 + \\pi_4 = 1\n$$\n将用 $\\pi_1$ 表示的 $\\pi_2, \\pi_3, \\pi_4$ 的表达式代入：\n$$\n\\pi_1 + \\frac{2}{3}\\pi_1 + \\frac{1}{3}\\pi_1 + \\frac{1}{2}\\pi_1 = 1\n$$\n提取出 $\\pi_1$：\n$$\n\\pi_1\\left(1 + \\frac{2}{3} + \\frac{1}{3} + \\frac{1}{2}\\right) = 1\n$$\n化简括号中的项：\n$$\n\\pi_1\\left(1 + 1 + \\frac{1}{2}\\right) = 1\n$$\n$$\n\\pi_1\\left(\\frac{5}{2}\\right) = 1\n$$\n解出 $\\pi_1$，我们得到：\n$$\n\\pi_1 = \\frac{2}{5}\n$$\n现在我们求 $\\pi_2$：\n$$\n\\pi_2 = \\frac{2}{3}\\pi_1 = \\frac{2}{3}\\left(\\frac{2}{5}\\right) = \\frac{4}{15}\n$$\n问题要求的是在网站 W1 上花费的长期时间比例与在网站 W2 上花费的时间比例之比。这个比率就是 $\\frac{\\pi_1}{\\pi_2}$。\n$$\n\\frac{\\pi_1}{\\pi_2} = \\frac{2/5}{4/15} = \\frac{2}{5} \\times \\frac{15}{4} = \\frac{30}{20} = \\frac{3}{2}\n$$\n该比率以最简分数形式表示为 $\\frac{3}{2}$。", "answer": "$$\\boxed{\\frac{3}{2}}$$", "id": "1360466"}, {"introduction": "这个赌徒财富问题的模型是一种特殊但非常重要的马尔可夫链，即生灭过程（birth-death process）。这类模型广泛应用于人口动态、排队论和物理学中，理解其特性至关重要[@problem_id:1337731]。此练习不仅要求你计算平稳分布，还进一步要求你利用该分布来计算一个有意义的长期平均值——赌徒的期望财富，这展示了遍历定理在计算期望方面的强大功能。", "problem": "一位谨慎的赌徒正在玩一个游戏，她的赌资，即一个以美元计的整数金额，在每一步都可能发生变化。她的总资本是有限的，因此她在第 $n$ 步的赌资 $X_n$ 必须在集合 $\\{0, 1, 2, 3, 4\\}$ 中。因此，可能的最大赌资为 $M=4$ 美元。\n\n在每一步，她都会下注。她以 $p = 2/3$ 的概率赢得 $1 美元，并以 $1-p = 1/3$ 的概率输掉 $1 美元。然而，她的谨慎策略在其赌资的边界处有特殊规则：\n- 如果她当前的赌资是 $X_n = 0$，她不能再输钱。一次“输”的结果（概率为 $1/3$）会使她的赌资保持在 $0$。一次“赢”的结果（概率为 $2/3$）会使她的赌资增加到 $1$。\n- 如果她当前的赌资是 $X_n = 4$，她不能持有更多的钱。一次“赢”的结果（概率为 $2/3$）会使她的赌资保持在 $4$。一次“输”的结果（概率为 $1/3$）会使她的赌资减少到 $3$。\n- 对于任何其他赌资 $X_n = i$，其中 $i \\in \\{1, 2, 3\\}$，赢一次会使她的赌资增加到 $i+1$，输一次会使其减少到 $i-1$。\n\n假设游戏进行了很长时间，那么该赌徒的长期平均赌资是多少？请将答案四舍五入到四位有效数字。", "solution": "我们将赌资建模为状态空间 $\\{0,1,2,3,4\\}$ 上的一个离散时间马尔可夫链，其转移概率如下：\n- 对于内部状态 $i \\in \\{1,2,3\\}$：$P(i \\to i+1)=p$ 和 $P(i \\to i-1)=q$，其中 $q=1-p$。\n- 在边界处：$P(0 \\to 1)=p$，$P(0 \\to 0)=q$；以及 $P(4 \\to 3)=q$，$P(4 \\to 4)=p$。\n\n这是一个带有反射壁（在 $0$ 和 $4$ 处有自循环）的生灭链。该链是有限的、不可约的和非周期的，因此它有一个唯一的平稳分布 $\\pi$，并且长期时间平均值等于平稳期望。\n\n对于生灭链，平稳分布在边上满足细致平衡条件：\n$$\n\\pi_{i}\\,p_{i}=\\pi_{i+1}\\,q_{i+1}\n$$\n其中 $p_{i}=P(i \\to i+1)$ 且 $q_{i}=P(i \\to i-1)$。此处，对于 $i=0,1,2,3$，我们有 $p_{i}=p$，对于 $i=1,2,3,4$，我们有 $q_{i}=q$。因此对于每个相邻对 $(i,i+1)$，其中 $i=0,1,2,3$，\n$$\n\\frac{\\pi_{i+1}}{\\pi_{i}}=\\frac{p_{i}}{q_{i+1}}=\\frac{p}{q}.\n$$\n令 $r=\\frac{p}{q}$。那么\n$$\n\\pi_{i}=\\pi_{0}\\,r^{i}, \\quad i=0,1,2,3,4.\n$$\n归一化条件 $\\sum_{i=0}^{4}\\pi_{i}=1$ 给出\n$$\n\\pi_{0}\\sum_{i=0}^{4}r^{i}=1 \\quad \\Rightarrow \\quad \\pi_{0}=\\left(\\sum_{i=0}^{4}r^{i}\\right)^{-1}.\n$$\n因此\n$$\n\\pi_{i}=\\frac{r^{i}}{\\sum_{k=0}^{4}r^{k}}.\n$$\n长期平均赌资即为平稳期望\n$$\n\\mathbb{E}[X]=\\sum_{i=0}^{4}i\\,\\pi_{i}=\\frac{\\sum_{i=0}^{4}i\\,r^{i}}{\\sum_{k=0}^{4}r^{k}}.\n$$\n当 $p=\\frac{2}{3}$ 且 $q=\\frac{1}{3}$ 时，我们有 $r=\\frac{p}{q}=2$。那么\n$$\n\\sum_{k=0}^{4}r^{k}=1+2+4+8+16=31,\n$$\n且\n$$\n\\sum_{i=0}^{4}i\\,r^{i}=0\\cdot 1+1\\cdot 2+2\\cdot 4+3\\cdot 8+4\\cdot 16=2+8+24+64=98.\n$$\n因此\n$$\n\\mathbb{E}[X]=\\frac{98}{31}\\approx 3.161290\\ldots\n$$\n四舍五入到四位有效数字，长期平均赌资为 $3.161$。", "answer": "$$\\boxed{3.161}$$", "id": "1337731"}, {"introduction": "现实世界中的许多系统并非总是不可约的；它们可能包含瞬态和多个最终会“陷入”的循环模式。本练习探讨了这种更复杂的结构，即一个可约马尔可夫链[@problem_id:1360496]。通过分析在进入某个特定循环（常返类）的条件下系统的长期行为，你将学会如何处理可约链，并理解其长期行为取决于它被吸收到的子系统。", "problem": "一个复杂的流水线机器人根据一个具有六个状态 $\\{0, 1, 2, 3, 4, 5\\}$ 的离散时间马尔可夫链模型运行。状态 0（‘校准’）和 1（‘任务执行’）是暂态的。其余状态形成两个独立的常返类：$C_1 = \\{2, 3\\}$，代表一个‘标准操作循环’，和 $C_2 = \\{4, 5\\}$，代表一个‘维护回路’。\n\n一步转移概率矩阵 $P = [P_{ij}]$ 由以下非零概率定义：\n- $P_{01} = 1/2$, $P_{02} = 1/4$, $P_{04} = 1/4$.\n- $P_{11} = 1/6$, $P_{12} = 1/3$, $P_{14} = 1/2$.\n- $P_{23} = 1$.\n- $P_{32} = 1$.\n- $P_{45} = 1$.\n- $P_{54} = 1$.\n所有其他转移概率 $P_{ij}$ 均为零。\n\n该机器人从‘校准’状态（状态 0）开始。它最终将被吸收进‘标准操作循环’$C_1$ 或‘维护回路’$C_2$。\n\n假设给定该机器人最终被吸收进‘标准操作循环’$C_1$。该机器人在状态 2 中所花费的时间的长期比例是多少？", "solution": "问题要求在马尔可夫链最终被吸收进常返类 $C_1 = \\{2, 3\\}$ 的条件下，其在状态 2 中所花费的时间的长期比例。\n\n可约马尔可夫链的一个基本性质是，一旦过程进入一个常返类，它就永远无法离开。因此，在被吸收进某一特定常返类的条件下，其长期行为仅取决于该类*内部*的转移动态。由于吸收事件是给定的，所有关于暂态({0, 1})、另一个常返类($C_2$)以及进入这些类的转移概率的信息，对于确定这个条件长期比例而言都变得无关紧要。\n\n我们需要分析限制在 $C_1$ 中各状态的子链。这个子链的转移概率矩阵，我们称之为 $P_{C_1}$，由原始矩阵 $P$ 中的相应条目构成：\n$$\nP_{C_1} = \\begin{pmatrix} P_{22} & P_{23} \\\\ P_{32} & P_{33} \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}\n$$\n这描述了在状态空间 $\\{2, 3\\}$ 上的一个不可约马尔可夫链。对于一个不可约的有限状态马尔可夫链，其在每个状态花费的时间的长期比例由其唯一的平稳分布给出。设该平稳分布为 $\\pi^{(1)} = (\\pi_2, \\pi_3)$。它是线性方程组 $\\pi^{(1)} P_{C_1} = \\pi^{(1)}$ 在满足归一化条件 $\\pi_2 + \\pi_3 = 1$ 下的解。\n\n该矩阵方程为：\n$$\n(\\pi_2, \\pi_3) \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix} = (\\pi_2, \\pi_3)\n$$\n这可以展开为以下方程组：\n1.  $0 \\cdot \\pi_2 + 1 \\cdot \\pi_3 = \\pi_2 \\implies \\pi_3 = \\pi_2$\n2.  $1 \\cdot \\pi_2 + 0 \\cdot \\pi_3 = \\pi_3 \\implies \\pi_2 = \\pi_3$\n\n两个方程是相同的。我们使用条件 $\\pi_2 = \\pi_3$ 以及归一化约束 $\\pi_2 + \\pi_3 = 1$。\n将 $\\pi_3 = \\pi_2$ 代入归一化方程可得：\n$$\n\\pi_2 + \\pi_2 = 1 \\implies 2\\pi_2 = 1 \\implies \\pi_2 = \\frac{1}{2}\n$$\n因为 $\\pi_3 = \\pi_2$，我们也有 $\\pi_3 = \\frac{1}{2}$。\n对于 $C_1$ 上的子链，其平稳分布为 $\\pi^{(1)} = (1/2, 1/2)$。分量 $\\pi_2$ 代表在过程被限制在类 $C_1$ 中的条件下，其在状态 2 中所花费的时间的长期比例。\n\n因此，在被吸收进‘标准操作循环’的条件下，机器人在状态 2 中所花费的时间的长期比例是 $1/2$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1360496"}]}