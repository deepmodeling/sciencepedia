{"hands_on_practices": [{"introduction": "让我们从一个基础模型开始：一维线段上的随机游走。这个练习模拟了一个粒子在有限整数点集上的运动，其边界为“反射壁”，这是一个在物理和计算机科学中常见的简化模型。通过计算返回特定状态的期望时间，您将直接应用“首步分析法”，这是一种通过建立线性方程组来求解期望值的基本而强大的技术。[@problem_id:1301617] 这个练习旨在为您后续解决更复杂的问题打下坚实的数学基础。", "problem": "一个粒子在整数位置集合 $S = \\{1, 2, 3, 4\\}$ 上进行离散时间随机游走。粒子的运动遵循以下规则：\n- 如果粒子处于内部位置 $i \\in \\{2, 3\\}$，在下一个时间步，它有 $0.5$ 的概率移动到位置 $i-1$，有 $0.5$ 的概率移动到位置 $i+1$。\n- 位置 1 和 4 作为反射边界。如果粒子在位置 1，它在下一个时间步必须移动到位置 2。如果粒子在位置 4，它在下一个时间步必须移动到位置 3。\n\n假设粒子从位置 2 开始，计算粒子首次返回位置 2 所需的期望时间步数。", "solution": "我们将此过程建模为状态集为 $\\{1,2,3,4\\}$ 的马尔可夫链，其转移概率为：$P_{1,2}=1$，$P_{2,1}=P_{2,3}=\\frac{1}{2}$，$P_{3,2}=P_{3,4}=\\frac{1}{2}$，以及 $P_{4,3}=1$。设 $f_{i}$ 表示从状态 $i$ 出发首次到达状态 2 的期望步数，其中 $f_{2}=0$。根据首步分析法（马尔可夫链的全期望定律），对于 $i \\neq 2$，我们有\n$$\nf_{i}=1+\\sum_{j}P_{i,j}f_{j}.\n$$\n因此，\n$$\nf_{1}=1+P_{1,2}f_{2}=1,\n$$\n$$\nf_{3}=1+P_{3,2}f_{2}+P_{3,4}f_{4}=1+\\frac{1}{2}f_{4},\n$$\n$$\nf_{4}=1+P_{4,3}f_{3}=1+f_{3}.\n$$\n求解，将 $f_{4}=1+f_{3}$ 代入关于 $f_{3}$ 的方程中：\n$$\nf_{3}=1+\\frac{1}{2}(1+f_{3})=1+\\frac{1}{2}+\\frac{1}{2}f_{3},\n$$\n$$\nf_{3}-\\frac{1}{2}f_{3}=\\frac{3}{2} \\quad \\Rightarrow \\quad \\frac{1}{2}f_{3}=\\frac{3}{2} \\quad \\Rightarrow \\quad f_{3}=3,\n$$\n因此 $f_{4}=1+f_{3}=4$，而如上所述 $f_{1}=1$。\n\n设 $r$ 为从 2 出发首次返回 2 的期望步数。根据首步分析法，\n$$\nr=1+\\sum_{j}P_{2,j}f_{j}=1+\\frac{1}{2}f_{1}+\\frac{1}{2}f_{3}=1+\\frac{1}{2}\\cdot 1+\\frac{1}{2}\\cdot 3=1+\\frac{1}{2}+\\frac{3}{2}=3.\n$$\n所以，粒子首次返回位置 2 所需的期望时间步数是 $3$。", "answer": "$$\\boxed{3}$$", "id": "1301617"}, {"introduction": "接下来，我们探讨一个源于统计力学的经典模型——埃伦费斯特模型（Ehrenfest model），它用于描述两个容器之间的气体扩散。在这个场景中，系统的状态由一个容器中的分子数决定，而分子的转移概率取决于当前状态。[@problem_id:1301629] 这个问题不仅巩固了您对首步分析法的理解，还展示了如何将其应用于转移概率不均匀的马尔可夫链，从而将抽象的数学工具与具体的物理过程联系起来。", "problem": "考虑一个用于描述两个室之间气体扩散的简化模型，称为 Ehrenfest 模型。在此模型中，共有 $N=3$ 个相同的分子分布在 A 室和 B 室之间。在每个离散时间步，从三个分子中均匀随机地选择一个，并将其移動到另一个室中。\n\n系统的状态由 A 室中的分子数量来描述。假设系统初始时处于 A 室中恰好有一个分子的状态。\n\n计算系统首次返回到 A 室中恰好有一个分子的状态所需的期望时间步数。请以精确分数的形式给出你的答案。", "solution": "令状态为 A 室中的分子数，因此状态空间为 $\\{0,1,2,3\\}$。在每一步，如果当前状态为 $i$，则下一状态以概率 $\\frac{3-i}{3}$ 变为 $i+1$（从 B 室中选择了一个分子），并以概率 $\\frac{i}{3}$ 变为 $i-1$（从 A 室中选择了一个分子）。我们寻求从状态 1 出发，首次返回到状态 1 的期望时间。\n\n根据马尔可夫性质和首步分析法，令 $f_{i}$ 表示从状态 $i$ 出发到达状态 1 所需的期望步数。我们需要求首次返回的 $f_{1}$（这不包括时间 $0$）。单步转移结构给出：\n- 从 $0$ 开始：链以概率 $1$ 移动到 $1$，因此\n$$\nf_{0}=1.\n$$\n- 从 $3$ 开始：链以概率 $1$ 移动到 $2$，因此\n$$\nf_{3}=1+f_{2}.\n$$\n- 从 $2$ 开始：它以概率 $\\frac{2}{3}$ 转移到 $1$（到达时间完成），并以概率 $\\frac{1}{3}$ 转移到 $3$，因此\n$$\nf_{2}=1+\\frac{2}{3}\\cdot 0+\\frac{1}{3}f_{3}=1+\\frac{1}{3}f_{3}.\n$$\n- 从 $1$ 开始：它以概率 $\\frac{1}{3}$ 转移到 $0$，并以概率 $\\frac{2}{3}$ 转移到 $2$，因此\n$$\nf_{1}=1+\\frac{1}{3}f_{0}+\\frac{2}{3}f_{2}.\n$$\n\n求解 $f_{2}$ 和 $f_{3}$。将 $f_{3}=1+f_{2}$ 代入 $f_{2}=1+\\frac{1}{3}f_{3}$ 得到\n$$\nf_{2}=1+\\frac{1}{3}(1+f_{2})=1+\\frac{1}{3}+\\frac{1}{3}f_{2}.\n$$\n因此\n$$\nf_{2}-\\frac{1}{3}f_{2}=\\frac{4}{3}\\quad\\Longrightarrow\\quad \\frac{2}{3}f_{2}=\\frac{4}{3}\\quad\\Longrightarrow\\quad f_{2}=2,\n$$\n接着\n$$\nf_{3}=1+f_{2}=3.\n$$\n已知 $f_{0}=1$ 和 $f_{2}=2$，计算\n$$\nf_{1}=1+\\frac{1}{3}\\cdot 1+\\frac{2}{3}\\cdot 2=1+\\frac{1}{3}+\\frac{4}{3}=\\frac{8}{3}.\n$$\n\n因此，系统首次返回到 A 室中恰好有一个分子的状态所需的期望时间步数是 $\\frac{8}{3}$。", "answer": "$$\\boxed{\\frac{8}{3}}$$", "id": "1301629"}, {"introduction": "在前两个练习中，我们使用了首步分析法。现在，我们将介绍一种求解平均返回时间的全新且同样强大的工具：平稳分布。对于一个不可约的正常返马尔可夫链，状态 $i$ 的平均返回时间 $\\mu_i$ 与其平稳概率 $\\pi_i$ 之间存在一个优美的关系：$\\mu_i = 1/\\pi_i$。[@problem_id:1301645] 这个关于服务器状态的实际问题将引导您首先计算系统的平稳分布，然后利用该关系直接求出期望返回时间。掌握这种方法对于分析更复杂系统的长期行为至关重要。", "problem": "一个用于科学模拟的专用计算服务器可以处于三种状态之一：在线 (ONLINE)、降级 (DEGRADED) 或离线 (OFFLINE)。服务器的状态以一小时为固定离散时间间隔进行监控。状态之间的转移被建模为一个离散时间马尔可夫链。\n\n- 如果服务器处于在线 (ONLINE) 状态，在下一小时内，它有概率 $p$ 因发生小故障而转移到降级 (DEGRADED) 状态。否则，它将保持在线状态。\n- 如果服务器处于降级 (DEGRADED) 状态，它无法自我修复回到在线状态。在下一小时内，它有概率 $q$ 因发生严重故障而转移到离线 (OFFLINE) 状态。否则，它将保持降级状态。\n- 如果服务器处于离线 (OFFLINE) 状态，将启动一个自动恢复协议。该协议保证服务器在下一小时内恢复到在线 (ONLINE) 状态。\n\n概率 $p$ 和 $q$ 是常数，满足 $0 < p < 1$ 且 $0 < q < 1$。\n\n计算在线 (ONLINE) 状态的平均返回时间。请用包含 $p$ 和 $q$ 的符号表达式表示答案，单位为小时。", "solution": "我们将服务器的行为建模为一个具有三种状态的离散时间马尔可夫链。我们可以将这些状态标记如下：\n- 状态 0：在线 (ONLINE)\n- 状态 1：降级 (DEGRADED)\n- 状态 2：离线 (OFFLINE)\n\n题目描述了这些状态在一小时时间间隔内的转移概率。我们可以将这些概率总结在一个转移矩阵 $P$ 中，其中元素 $P_{ij}$ 是从状态 $i$ 转移到状态 $j$ 的概率。\n\n转移规则如下：\n- 从状态 0 (ONLINE) 出发：\n  - 以概率 $p$ 转移到状态 1 (DEGRADED)。因此，$P_{01} = p$。\n  - 以概率 $1-p$ 保持在状态 0 (ONLINE)。因此，$P_{00} = 1-p$。\n  - 不能直接转移到状态 2 (OFFLINE)。因此，$P_{02} = 0$。\n- 从状态 1 (DEGRADED) 出发：\n  - 以概率 $q$ 转移到状态 2 (OFFLINE)。因此，$P_{12} = q$。\n  - 以概率 $1-q$ 保持在状态 1 (DEGRADED)。因此，$P_{11} = 1-q$。\n  - 不能返回到状态 0 (ONLINE)。因此，$P_{10} = 0$。\n- 从状态 2 (OFFLINE) 出发：\n  - 以概率 1 转移到状态 0 (ONLINE)。因此，$P_{20} = 1$。\n  - 不能转移到状态 1 或保持在状态 2。因此，$P_{21} = 0$ 且 $P_{22} = 0$。\n\n转移矩阵 $P$ 为：\n$$\nP = \\begin{pmatrix}\n1-p & p & 0 \\\\\n0 & 1-q & q \\\\\n1 & 0 & 0\n\\end{pmatrix}\n$$\n\n问题要求计算在线状态（状态 0）的平均返回时间。对于一个不可约的、正常返的马尔可夫链，状态 $i$ 的平均返回时间 $\\mu_i$ 是其平稳概率 $\\pi_i$ 的倒数。\n$$\n\\mu_i = \\frac{1}{\\pi_i}\n$$\n因此，我们的目标是找到平稳分布向量 $\\pi = (\\pi_0, \\pi_1, \\pi_2)$，它是满足方程 $\\pi P = \\pi$ 并且符合条件 $\\pi_0 + \\pi_1 + \\pi_2 = 1$ 的唯一概率向量。\n\n方程 $\\pi P = \\pi$ 给了我们一个线性方程组：\n1. $\\pi_0 = \\pi_0(1-p) + \\pi_1(0) + \\pi_2(1) \\implies \\pi_0 = \\pi_0 - p\\pi_0 + \\pi_2 \\implies p\\pi_0 = \\pi_2$\n2. $\\pi_1 = \\pi_0(p) + \\pi_1(1-q) + \\pi_2(0) \\implies \\pi_1 = p\\pi_0 + \\pi_1 - q\\pi_1 \\implies q\\pi_1 = p\\pi_0$\n3. $\\pi_2 = \\pi_0(0) + \\pi_1(q) + \\pi_2(0) \\implies \\pi_2 = q\\pi_1$\n\n注意到，如果我们使用前两个方程，第三个方程是多余的。由(2)可得 $\\pi_1 = \\frac{p}{q}\\pi_0$。将此代入(3)可得 $\\pi_2 = q\\left(\\frac{p}{q}\\pi_0\\right) = p\\pi_0$，这与方程(1)相同。\n\n因此，我们得到了用 $\\pi_0$ 表示的 $\\pi_1$ 和 $\\pi_2$ 的表达式：\n- $\\pi_1 = \\frac{p}{q}\\pi_0$\n- $\\pi_2 = p\\pi_0$\n\n现在，我们使用归一化条件 $\\pi_0 + \\pi_1 + \\pi_2 = 1$：\n$$\n\\pi_0 + \\frac{p}{q}\\pi_0 + p\\pi_0 = 1\n$$\n提出因子 $\\pi_0$：\n$$\n\\pi_0 \\left(1 + \\frac{p}{q} + p\\right) = 1\n$$\n为简化括号内的表达式，我们进行通分：\n$$\n\\pi_0 \\left(\\frac{q + p + pq}{q}\\right) = 1\n$$\n现在，解出 $\\pi_0$：\n$$\n\\pi_0 = \\frac{q}{q + p + pq}\n$$\n在线状态（状态 0）的平均返回时间，记为 $\\mu_0$，是 $\\pi_0$ 的倒数：\n$$\n\\mu_0 = \\frac{1}{\\pi_0} = \\frac{q + p + pq}{q}\n$$\n我们可以通过将分子中的每一项除以分母来简化此表达式：\n$$\n\\mu_0 = \\frac{q}{q} + \\frac{p}{q} + \\frac{pq}{q} = 1 + p + \\frac{p}{q}\n$$\n单位是小时，因为马尔可夫链的时间步长是一小时。", "answer": "$$\\boxed{1 + p + \\frac{p}{q}}$$", "id": "1301645"}]}