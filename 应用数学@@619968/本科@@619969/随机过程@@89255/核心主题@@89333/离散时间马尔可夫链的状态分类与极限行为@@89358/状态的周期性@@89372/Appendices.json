{"hands_on_practices": [{"introduction": "一个系统的状态转移结构会极大地影响其长期行为。本练习通过一个“星形图”模型，直观地展示了周期性的基本概念。通过分析粒子在中心枢纽和外围节点间的往返运动，你将发现这种简单的结构如何自然地导致一个大于$1$的周期，并初步接触到图论中“二分图”的思想如何应用于马尔可夫链。[@problem_id:1323482]", "problem": "考虑一个由离散时间马尔可夫链建模的系统，该系统建立在一组六个状态的集合 $\\{S_0, S_1, S_2, S_3, S_4, S_5\\}$ 上。状态 $S_0$ 被称为中心枢纽，状态 $\\{S_1, S_2, S_3, S_4, S_5\\}$ 被称为外围节点。一个粒子在这些状态之间移动的转移规则定义如下：\n\n1.  如果粒子位于任意一个外围节点 $S_i$（其中 $i \\in \\{1, 2, 3, 4, 5\\}$），它将在下一个时间步以概率 1 转移到中心枢纽 $S_0$。\n2.  如果粒子位于中心枢纽 $S_0$，它将在下一个时间步以相等的概率转移到五个外围节点中的任意一个。粒子不能停留在枢纽 $S_0$。\n\n一个状态的周期被定义为：粒子从该状态出发并首次返回该状态所可能花费的所有步数的最大公约数。给定此系统，确定中心枢纽状态 $S_0$ 的周期。", "solution": "设状态为 $\\{S_{0},S_{1},S_{2},S_{3},S_{4},S_{5}\\}$，其中 $S_{0}$ 是枢纽，$S_{1},\\dots,S_{5}$ 是外围节点。转移规则为：\n- 对于每个 $i \\in \\{1,2,3,4,5\\}$，$\\Pr(S_{i} \\to S_{0})=1$。\n- 从 $S_{0}$ 出发，对于每个 $i \\in \\{1,2,3,4,5\\}$ 有 $\\Pr(S_{0} \\to S_{i})=\\frac{1}{5}$，且 $\\Pr(S_{0} \\to S_{0})=0$。\n\n在时间 $t=0$ 时从 $S_0$ 开始。在时间 $t=1$ 时，链必然以概率 1 处于某个外围节点 $S_{i}$，因为不可能停留在 $S_0$。在时间 $t=2$ 时，从那个外围节点 $S_{i}$ 出发，链必然以概率 1 移动到 $S_0$。因此，返回 $S_{0}$ 的首次返回时间 $T$ 满足 $\\Pr(T=2)=1$，所以唯一可能的首次返回时间是 $2$。\n\n根据给定的定义，周期是所有可能的首次返回时间的最大公约数。由于可能的首次返回时间集合为 $\\{2\\}$，所以周期是 $\\gcd\\{2\\}=2$。\n\n等价地，可以注意到 $\\Pr(X_{n}=S_{0}\\mid X_{0}=S_{0})>0$ 当且仅当 $n$ 是偶数，这得到相同的周期 $\\gcd\\{2,4,6,\\dots\\}=2$。", "answer": "$$\\boxed{2}$$", "id": "1323482"}, {"introduction": "周期性并非总是源于简单的往返运动，有时它隐藏在更微妙的系统属性中。这个练习将探讨一个机器人在二维网格上的移动，并揭示一个潜在的“奇偶性”规则。理解这一规则将帮助你确定机器人何时能够返回起点，从而掌握一种在更复杂系统中识别周期性的强大分析工具。[@problem_id:1323470]", "problem": "一个专用的微型机器人被设计用于检查集成电路，它在一个可视为无限大的二维整数坐标网格上移动，该网格可用集合 $\\mathbb{Z}^2$ 表示。机器人从原点，即状态 $(0,0)$ 开始。从任意给定的坐标 $(x,y)$，机器人的移动机制允许它在一步之内移动到四个“对角”位置之一：$(x+1, y+1)$、$(x+1, y-1)$、$(x-1, y+1)$ 或 $(x-1, y-1)$。选择这四个有效移动中的哪一个，是随机的。\n\n机器人的路径构成了一个状态空间为 $\\mathbb{Z}^2$ 的离散时间马尔可夫链。马尔可夫链中状态 $i$ 的周期，定义为所有使得在恰好 $n$ 步后返回状态 $i$ 的概率非零的正整数 $n$ 的最大公约数 (GCD)。\n\n确定状态 $(0,0)$ 的周期。", "solution": "我们分析允许的移动所带来的奇偶性约束。从任意状态 $(x,y)$ 出发，一步移动会使两个坐标都改变 $\\pm 1$。因此，每走一步，$x$ 的奇偶性和 $y$ 的奇偶性都会翻转。从两个坐标都为偶数的 $(0,0)$ 出发，经过奇数步后，两个坐标都变为奇数；而经过偶数步后，两个坐标都变为偶数。因此，返回 $(0,0)$ 的一个必要条件是步数 $n$ 为偶数。等价地，对于所有奇数 $n$，都有 $P^{n}\\big((0,0),(0,0)\\big)=0$。\n\n我们现在证明这个条件也是充分的。考虑任意偶数 $n=2m$。两步序列\n$$(x,y)\\to(x+1,y-1)\\to(x,y)$$\n会返回到原始状态，并且其发生概率非零。通过将这个两步循环重复 $m$ 次，机器人可以在时刻 $n=2m$ 以正概率返回到 $(0,0)$。因此，对于每个偶数 $n$，都有 $P^{n}\\big((0,0),(0,0)\\big)>0$。\n\n综合以上两点，能够以正概率返回的步数集合恰好是 $\\{2,4,6,\\dots\\}$。状态 $(0,0)$ 的周期 $d$ 是所有这些 $n$ 的最大公约数，因此\n$$d=\\gcd\\{2,4,6,\\dots\\}=2.$$", "answer": "$$\\boxed{2}$$", "id": "1323470"}, {"introduction": "并非马尔可夫链中的每个状态都必须是周期的。当状态转移提供了足够多的路径选择时，系统可以打破之前练习中看到的严格时间限制。本练习将引导你分析一个拥有两种不同步长移动方式的系统，通过寻找两个互质的返回步数，你将证明其状态可以是“非周期的”（周期为$1$），这是理解马尔可夫链长期行为的关键一步。[@problem_id:1323476]", "problem": "一个简化的卫星姿态控制系统使用一组离散的12个角位置，由整数集合 $S = \\{0, 1, 2, \\dots, 11\\}$ 索引。卫星的状态转移在此整数集合上以12为模进行。从任意给定状态 $k$，控制系统可以发出两种指令之一，从而进入一个新状态。第一种指令将状态移动 $+2$，得到新状态 $(k+2) \\pmod{12}$。第二种指令将状态移动 $+3$，得到新状态 $(k+3) \\pmod{12}$。每种指令的被选择都具有某个非零概率。\n\n假设卫星的初始状态为 0。我们关心该系统的长期行为，特别是其周期性。一个状态的周期定义为：首次返回该状态所花费的所有可能步数（即发出的指令数）的最大公约数。\n\n确定状态 0 的周期。", "solution": "我们将该系统建模为状态空间 $S=\\{0,1,\\dots,11\\}$ 上的一个马尔可夫链，其转移为 $k \\to (k+2) \\bmod 12$ 或 $k \\to (k+3) \\bmod 12$，且每个转移的概率都为正。状态 0 的周期被定义为所有满足“存在一条从 0 开始、长度为 $n$、且以正概率首次返回 0 的路径”的 $n \\geq 1$ 的最大公约数。\n\n在 $n$ 步后返回到 0，对应于一个序列，其中使用了 $a$ 次 $+2$ 和 $b$ 次 $+3$，使得 $a,b \\in \\mathbb{Z}_{\\geq 0}$，$a+b=n$，并且满足：\n$$\n2a+3b \\equiv 0 \\pmod{12}.\n$$\n首先，观察到在 $n=1,2,3$ 步内不可能返回，因为 $n$ 步后的总和位于区间 $[2n,3n]$ 内，而对于 $n \\leq 3$，此区间包含在 $[2,9]$ 中，其值不可能同余于 $0 \\pmod{12}$。\n\n接下来，我们展示两个具体的首次返回时间：\n- 对于 $n=4$，进行四次 $+3$ 操作：总增量为 $3+3+3+3=12 \\equiv 0 \\pmod{12}$。中间的部分和为 $3$、$6$ 和 $9$，均不同余于 $0 \\pmod{12}$，因此这是在第 $4$ 步的首次返回。\n- 对于 $n=5$，以任意顺序进行三次 $+2$ 操作和两次 $+3$ 操作；例如，$+2,+2,+2,+3,+3$ 得到的总增量为 $2+2+2+3+3=12 \\equiv 0 \\pmod{12}$。在第五步之前的任何部分和最多为 $10$，因此不可能同余于 $0 \\pmod{12}$，所以这是在第 $5$ 步的首次返回。\n\n因此，$n=4$ 和 $n=5$ 都是概率为正的可能首次返回时间。根据周期的定义，\n$$\n\\text{period of }0=\\gcd\\{n \\geq 1 : \\text{first return to }0\\text{ in }n\\text{ steps is possible}\\} \\leq \\gcd(4,5)=1.\n$$\n由于周期是一个正整数，它必须恰好为 $1$。\n\n因此，状态 $0$ 是非周期的，其周期为 $1$。", "answer": "$$\\boxed{1}$$", "id": "1323476"}]}