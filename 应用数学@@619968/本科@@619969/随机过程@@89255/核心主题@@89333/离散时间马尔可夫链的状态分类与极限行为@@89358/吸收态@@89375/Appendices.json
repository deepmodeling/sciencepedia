{"hands_on_practices": [{"introduction": "许多现实世界中的过程都有多种可能的最终结果，例如成功或失败、售出或丢弃。这个练习将带我们进入一个美食奶酪作坊，模拟一个批次的奶酪在成熟过程中可能最终被“包装出售”或“变质”的两种吸收状态。通过这个练习，我们将计算一个从第一阶段开始的奶酪批次最终变质的概率，这是风险分析和质量控制中的一项基本技能 [@problem_id:1280299]。", "problem": "一家美食乳品厂生产一种经过多阶段熟成过程的特殊奶酪。每周观察每批奶酪的状态。一批奶酪可以处于三个瞬时熟成阶段之一（阶段 1、阶段 2 或阶段 3），或者已经进入两个终结吸收状态之一：“已包装”待售或“已变质”。\n\n每周的状态转移概率定义如下：\n- 从**阶段 1**，一批奶酪有 80% 的概率进入阶段 2，有 20% 的概率变质。\n- 从**阶段 2**，一批奶酪有 10% 的概率返回阶段 1 进行再处理，有 70% 的概率进入阶段 3，有 20% 的概率变质。\n- 从**阶段 3**，一批奶酪有 15% 的概率返回阶段 2 进行进一步熟成，有 80% 的概率被包装，有 5% 的概率变质。\n- 一旦一批奶酪处于“已包装”或“已变质”状态，它将永久保持该状态。\n\n一批新奶酪从阶段 1 开始。这批奶酪最终变质的长期概率是多少？\n\n将你的最终答案四舍五入到三位有效数字。", "solution": "将每周的演变建模为一个吸收马尔可夫链，其瞬时态为阶段 1、阶段 2、阶段 3，吸收态为“已包装”和“已变质”。设 $p_1$、$p_2$、$p_3$ 分别是从阶段 1、阶段 2 和阶段 3 开始，过程最终被吸收于“已变质”状态的概率。根据首步分析，从每个瞬时态开始，最终变质的概率等于转移到下一个状态的概率与其最终变质概率的乘积对所有下一个状态求和，再加上直接转移到“已变质”状态的概率。\n\n根据给定的转移概率：\n- 从阶段 1：以概率 $\\frac{4}{5}$ 转移到阶段 2，以概率 $\\frac{1}{5}$ 转移到“已变质”。因此\n$$\np_1=\\frac{4}{5}p_2+\\frac{1}{5}.\n$$\n- 从阶段 2：以概率 $\\frac{1}{10}$ 转移到阶段 1，以概率 $\\frac{7}{10}$ 转移到阶段 3，以概率 $\\frac{1}{5}$ 转移到“已变质”。因此\n$$\np_2=\\frac{1}{10}p_1+\\frac{7}{10}p_3+\\frac{1}{5}.\n$$\n- 从阶段 3：以概率 $\\frac{3}{20}$ 转移到阶段 2，以概率 $\\frac{4}{5}$ 转移到“已包装”（对变质概率的贡献为零），以概率 $\\frac{1}{20}$ 转移到“已变质”。因此\n$$\np_3=\\frac{3}{20}p_2+\\frac{1}{20}.\n$$\n\n求解该线性方程组。将第三个方程中的 $p_3$ 代入第二个方程：\n$$\np_2=\\frac{1}{10}p_1+\\frac{7}{10}\\left(\\frac{3}{20}p_2+\\frac{1}{20}\\right)+\\frac{1}{5}\n=\\frac{1}{10}p_1+\\frac{21}{200}p_2+\\frac{7}{200}+\\frac{1}{5}.\n$$\n整理得：\n$$\n\\left(1-\\frac{21}{200}\\right)p_2=\\frac{1}{10}p_1+\\frac{47}{200}\n\\quad\\Rightarrow\\quad\n\\frac{179}{200}p_2=\\frac{1}{10}p_1+\\frac{47}{200}.\n$$\n两边乘以 $200$：\n$$\n179\\,p_2=20\\,p_1+47,\n\\quad\\Rightarrow\\quad\np_2=\\frac{20\\,p_1+47}{179}.\n$$\n代入第一个方程：\n$$\np_1=\\frac{4}{5}\\cdot\\frac{20\\,p_1+47}{179}+\\frac{1}{5}\n=\\frac{80\\,p_1+188}{895}+\\frac{179}{895}\n=\\frac{80\\,p_1+367}{895}.\n$$\n两边乘以 $895$ 并求解 $p_1$：\n$$\n895\\,p_1=80\\,p_1+367\n\\;\\Rightarrow\\;\n815\\,p_1=367\n\\;\\Rightarrow\\;\np_1=\\frac{367}{815}.\n$$\n因此，从阶段 1 开始最终变质的长期概率为 $p_1=\\frac{367}{815}\\approx 0.450306\\ldots$。四舍五入到三位有效数字得到 $0.450$。", "answer": "$$\\boxed{0.450}$$", "id": "1280299"}, {"introduction": "在确定了一个过程的最终命运后，下一个自然而然的问题是：到达那个最终状态需要多长时间？本练习通过一个园艺研究模型，探讨一株健康的植物在进入“致命病害”这一吸收状态之前，预计能保持非病状态多长时间。这种计算预期寿命或首次到达时间的方法，在可靠性工程、人口动态学和生存分析等领域至关重要 [@problem_id:1280317]。", "problem": "一位园艺研究员根据逐季观察，建立了一个离散时间马尔可夫链模型来描述一种特定观赏植物的健康状况。该植物可能处于以下三种状态之一：健康 (H)、遭受虫害 (P) 或致命病害 (D)。\n\n状态转移如下：\n- 一株在一季中健康的植物，在下一季有 0.7 的概率保持健康，0.2 的概率遭受虫害，0.1 的概率患上致命病害。\n- 一株遭受虫害的植物，在下一季有 0.3 的概率恢复健康（由于治疗），0.5 的概率仍然遭受虫害，0.2 的概率患上致命病害。\n- 一旦植物进入致命病害状态，它就无法恢复并永久保持在该状态。\n\n计算一株从健康状态开始的新植物，在进入致命病害状态之前，保持在非病害状态（即健康或遭受虫害状态）的期望季数。将您的答案表示为一个数值，并四舍五入至三位有效数字。", "solution": "我们将各季节视为离散时间马尔可夫链的步骤，其状态为健康 (H)、遭受虫害 (P) 和致命病害 (D)，其中 D 是吸收态。令 $x_H$ 和 $x_P$ 分别表示从状态 H 和 P 开始，首次进入状态 D 之前所经历的期望季数，并令 $x_D=0$。\n\n根据首步分析法（马尔可夫性质），从 H 开始：\n$$\nx_H=1+\\frac{7}{10}x_H+\\frac{1}{5}x_P+\\frac{1}{10}x_D,\n$$\n从 P 开始：\n$$\nx_P=1+\\frac{3}{10}x_H+\\frac{1}{2}x_P+\\frac{1}{5}x_D,\n$$\n其中 $x_D=0$。\n\n代入 $x_D=0$ 并整理可得\n$$\n\\left(1-\\frac{7}{10}\\right)x_H-\\frac{1}{5}x_P=1 \\quad\\Longrightarrow\\quad \\frac{3}{10}x_H-\\frac{1}{5}x_P=1,\n$$\n$$\n-\\frac{3}{10}x_H+\\left(1-\\frac{1}{2}\\right)x_P=1 \\quad\\Longrightarrow\\quad -\\frac{3}{10}x_H+\\frac{1}{2}x_P=1.\n$$\n将两个方程两边都乘以 $10$ 以消去分母：\n$$\n3x_H-2x_P=10,\\qquad -3x_H+5x_P=10.\n$$\n将两个方程相加，得到 $3x_P=20$，因此\n$$\nx_P=\\frac{20}{3}.\n$$\n代入 $3x_H-2x_P=10$：\n$$\n3x_H-2\\left(\\frac{20}{3}\\right)=10 \\;\\Longrightarrow\\; 3x_H-\\frac{40}{3}=10 \\;\\Longrightarrow\\; 3x_H=\\frac{70}{3} \\;\\Longrightarrow\\; x_H=\\frac{70}{9}.\n$$\n因此，从健康状态开始，植物在进入致命病害状态前保持非病害状态的期望季数是 $x_H=\\frac{70}{9}\\approx 7.777\\ldots$，四舍五入到三位有效数字为 $7.78$。", "answer": "$$\\boxed{7.78}$$", "id": "1280317"}, {"introduction": "仅仅知道平均故障时间可能不足以进行全面的风险评估，因为我们还需要了解故障时间的一致性或波动性。本练习引入了一种功能强大的矩阵方法，用于计算吸收时间的方差（$Var(T)$）。通过分析一个软件组件的可靠性模型，我们将超越平均值，量化系统进入“永久性故障”状态所需时间的不确定性，这对于设计稳健的系统和制定有效的维护策略至关重要 [@problem_id:1280285]。", "problem": "一个关键软件组件的可靠性被建模为一个在每个操作周期后观察的离散时间马尔可夫链。该组件可能处于以下三种状态之一：状态1（稳定）、状态2（间歇性故障）或状态3（永久性故障）。状态3是一个吸收态，意味着一旦组件进入此状态，它将永久停留在该状态。一个周期后状态之间的转移概率由以下矩阵 $P$ 给出，其中 $P_{ij}$ 是从状态 $i$ 转移到状态 $j$ 的概率：\n\n$$\nP = \\begin{pmatrix}\n0.80  0.15  0.05 \\\\\n0.30  0.50  0.20 \\\\\n0.00  0.00  1.00\n\\end{pmatrix}\n$$\n\n假设一个新组件在时间 $t=0$ 时从稳定状态（状态1）开始。令 $T$ 为组件首次进入永久性故障状态所需的操作周期数。计算 $T$ 的方差。将您的最终答案四舍五入到三位有效数字。", "solution": "状态3是吸收态；瞬态是状态1和2。令 $Q$ 为瞬态之间转移的 $2\\times 2$ 子矩阵：\n$$\nQ=\\begin{pmatrix}\n0.80  0.15\\\\\n0.30  0.50\n\\end{pmatrix}.\n$$\n基本矩阵是 $N=(I-Q)^{-1}$。计算\n$$\nI-Q=\\begin{pmatrix}\n1-0.80  -0.15\\\\\n-0.30  1-0.50\n\\end{pmatrix}\n=\\begin{pmatrix}\n0.20  -0.15\\\\\n-0.30  0.50\n\\end{pmatrix},\n$$\n其行列式为\n$$\n\\det(I-Q)=0.20\\cdot 0.50-(-0.15)\\cdot(-0.30)=0.10-0.045=0.055.\n$$\n因此\n$$\nN=(I-Q)^{-1}=\\frac{1}{0.055}\\begin{pmatrix}\n0.50  0.15\\\\\n0.30  0.20\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\frac{100}{11}  \\frac{30}{11}\\\\\n\\frac{60}{11}  \\frac{40}{11}\n\\end{pmatrix}.\n$$\n令 $m=N\\mathbf{1}$ 为到达吸收态的期望步数向量，其中 $\\mathbf{1}=(1,1)^{\\mathsf{T}}$。则\n$$\nm=\\begin{pmatrix}\n\\frac{100}{11}  \\frac{30}{11}\\\\\n\\frac{60}{11}  \\frac{40}{11}\n\\end{pmatrix}\n\\begin{pmatrix}\n1\\\\\n1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{130}{11}\\\\\n\\frac{100}{11}\n\\end{pmatrix}.\n$$\n对于吸收链，吸收时间的方差向量 $v$ 满足\n$$\nv=(2N-I)m-m^{\\circ 2},\n$$\n其中 $m^{\\circ 2}$ 表示 $m$ 的逐元素平方，而 $I$ 是 $2\\times 2$ 的单位矩阵。计算\n$$\n2N-I=\\begin{pmatrix}\n\\frac{200}{11}  \\frac{60}{11}\\\\\n\\frac{120}{11}  \\frac{80}{11}\n\\end{pmatrix}\n-\n\\begin{pmatrix}\n1  0\\\\\n0  1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{189}{11}  \\frac{60}{11}\\\\\n\\frac{120}{11}  \\frac{69}{11}\n\\end{pmatrix}.\n$$\n则\n$$\n(2N-I)m=\n\\begin{pmatrix}\n\\frac{189}{11}  \\frac{60}{11}\\\\\n\\frac{120}{11}  \\frac{69}{11}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{130}{11}\\\\\n\\frac{100}{11}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{30570}{121}\\\\\n\\frac{22500}{121}\n\\end{pmatrix},\n\\quad\nm^{\\circ 2}=\n\\begin{pmatrix}\n\\left(\\frac{130}{11}\\right)^{2}\\\\\n\\left(\\frac{100}{11}\\right)^{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{16900}{121}\\\\\n\\frac{10000}{121}\n\\end{pmatrix}.\n$$\n因此\n$$\nv=\n\\begin{pmatrix}\n\\frac{30570}{121}-\\frac{16900}{121}\\\\\n\\frac{22500}{121}-\\frac{10000}{121}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{13670}{121}\\\\\n\\frac{12500}{121}\n\\end{pmatrix}.\n$$\n从状态1开始，方差为 $v_1=\\frac{13670}{121}\\approx 112.975\\ldots$，四舍五入到三位有效数字为 $113$。", "answer": "$$\\boxed{113}$$", "id": "1280285"}]}