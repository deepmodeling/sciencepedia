{"hands_on_practices": [{"introduction": "我们从一个基础练习开始，旨在巩固马尔可夫链中循环状态的核心概念。通过分析一个简单的双态系统——计数器的奇偶性——我们将学习如何确定转移概率，并计算一个状态的平稳分布。这个练习的关键在于揭示平稳概率与平均返回时间之间的深刻联系，这是理解有限马尔可夫链行为的基石。[@problem_id:1329896]", "problem": "一个自适应数字系统的简化模型涉及一个计数器，其奇偶性（偶数或奇数）决定了系统的运行模式。系统的状态由一个内部计数器跟踪，该计数器从0开始。在每个时间步，一个特定的伪随机数生成器（PRNG）会生成一个随机整数，并加到计数器上。PRNG模式的选择取决于计数器当前的奇偶性。\n\n- 如果计数器的当前值为偶数，系统使用PRNG模式E。在此模式下，生成奇数的概率为 $q_E = 1/3$。\n- 如果计数器的当前值为奇数，系统使用PRNG模式O。在此模式下，生成奇数的概率为 $q_O = 3/4$。\n\n如果计数器的值为偶数，则认为系统处于状态'E'；如果为奇数，则处于状态'O'。关于状态'E'及其平均重返时间（即系统从状态'E'出发，首次返回状态'E'的期望步数），以下哪个陈述是正确的？\n\nA. 状态'E'是瞬态。\n\nB. 状态'E'是常返态，且返回的期望步数是 $13/9$。\n\nC. 状态'E'是常返态，且返回的期望步数是 $13/4$。\n\nD. 状态'E'是常返态，且返回的期望步数是 $9/13$。\n\nE. 状态'E'是常返态，且返回的期望步数是 $2$。", "solution": "将计数器的奇偶性解释为一个具有状态 $E$（偶）和 $O$（奇）的两状态时齐马尔可夫链。加上一个奇数会改变奇偶性；加上一个偶数则保持奇偶性不变。\n\n根据题意：\n- 在状态 $E$ 中，生成奇数的概率为 $q_{E} = \\frac{1}{3}$，因此\n$$\nP(E \\to O) = \\frac{1}{3}, \\quad P(E \\to E) = 1 - \\frac{1}{3} = \\frac{2}{3}.\n$$\n- 在状态 $O$ 中，生成奇数的概率为 $q_{O} = \\frac{3}{4}$，因此\n$$\nP(O \\to E) = \\frac{3}{4}, \\quad P(O \\to O) = 1 - \\frac{3}{4} = \\frac{1}{4}.\n$$\n\n两个状态之间的所有转移概率都严格为正，因此该链是不可约的。由于 $P(E \\to E) = \\frac{2}{3} > 0$ 且 $P(O \\to O) = \\frac{1}{4} > 0$，该链是非周期的。任何不可约的有限马尔可夫链都是正常返的；因此状态 $E$ 是常返态。\n\n设平稳分布为 $(\\pi_{E}, \\pi_{O})$，满足 $\\pi_{E} + \\pi_{O} = 1$ 和 $\\pi = \\pi P$。使用 $\\pi = \\pi P$ 的 $E$ 分量，\n$$\n\\pi_{E} = \\pi_{E}\\left(\\frac{2}{3}\\right) + \\pi_{O}\\left(\\frac{3}{4}\\right).\n$$\n整理可得\n$$\n\\pi_{E} - \\frac{2}{3}\\pi_{E} = \\frac{3}{4}\\pi_{O} \\quad \\Longrightarrow \\quad \\frac{1}{3}\\pi_{E} = \\frac{3}{4}\\pi_{O}.\n$$\n两边同乘以 $12$ 以消去分母：\n$$\n4\\pi_{E} = 9\\pi_{O}.\n$$\n使用 $\\pi_{E} + \\pi_{O} = 1$，代入 $\\pi_{O} = 1 - \\pi_{E}$：\n$$\n4\\pi_{E} = 9(1 - \\pi_{E}) \\quad \\Longrightarrow \\quad 4\\pi_{E} = 9 - 9\\pi_{E} \\quad \\Longrightarrow \\quad 13\\pi_{E} = 9,\n$$\n因此\n$$\n\\pi_{E} = \\frac{9}{13}.\n$$\n\n对于一个不可约的正常返马尔可夫链，到状态 $E$ 的平均重返时间等于 $1/\\pi_{E}$。所以，\n$$\n\\text{到 } E \\text{ 的平均重返时间} = \\frac{1}{\\pi_{E}} = \\frac{13}{9}.\n$$\n因此，$E$ 是常返态，其期望返回时间为 $\\frac{13}{9}$，这对应于选项B。", "answer": "$$\\boxed{B}$$", "id": "1329896"}, {"introduction": "在掌握了双态系统的基础后，我们来挑战一个更复杂的场景，它模拟了数字存储器中随机错误的影响。这个问题将状态空间的规模从2扩展到了 $L+1$ 。在这里，你将应用细致平衡原理——一种寻找平稳分布的强大工具——来分析一个生灭过程，并亲眼见证系统的规模如何极大地影响返回到初始状态的期望时间。[@problem_id:1329929]", "problem": "一个描述数字存储体可靠性的简化模型将其视为一个由 $L$ 个比特组成的比特串。由于环境因素，该存储器会受到随机比特翻转错误的影响。在每个离散时间步，从 $L$ 个可用位置中均匀随机地选择一个比特，并将其值翻转（0 变为 1，1 变为 0）。\n\n设系统初始化为“全 1”状态，即由 $L$ 个 1 组成的比特串。这个过程可以用一个马尔可夫链来描述，其状态由比特串中“1”的数量来刻画。对于任何有限的 $L$，该链中的每个状态都是常返的，这意味着如果系统从一个特定状态开始，它必然最终会返回该状态。\n\n你的任务是计算系统从“全 1”状态开始，首次返回此“全 1”状态所需的平均（期望）时间步数。请用 $L$ 的闭式解析表达式来表示你的答案。", "solution": "用 1 的数量 $k\\in\\{0,1,\\ldots,L\\}$ 为该链建模。从状态 $k$ 出发，从 $L$ 个比特中均匀随机地翻转一个，因此转移概率为\n$$\nP(k\\to k+1)=\\frac{L-k}{L}\\quad\\text{对于 }k<L,\\qquad P(k\\to k-1)=\\frac{k}{L}\\quad\\text{对于 }k>0,\n$$\n没有其他可能的转移。这是一个有限、不可约的生灭链，因此是正常返的。\n\n我们首先利用细致平衡来找到其平稳分布 $\\pi=\\{\\pi_{k}\\}_{k=0}^{L}$。可逆性要求\n$$\n\\pi_{k}\\,P(k\\to k+1)=\\pi_{k+1}\\,P(k+1\\to k)\\quad\\text{对于 }k=0,1,\\ldots,L-1,\n$$\n即，\n$$\n\\pi_{k}\\cdot\\frac{L-k}{L}=\\pi_{k+1}\\cdot\\frac{k+1}{L}.\n$$\n这可化简为递推关系\n$$\n\\frac{\\pi_{k+1}}{\\pi_{k}}=\\frac{L-k}{k+1}.\n$$\n从 $k=0$ 开始迭代可得\n$$\n\\pi_{k}=\\pi_{0}\\prod_{j=0}^{k-1}\\frac{L-j}{j+1}=\\pi_{0}\\binom{L}{k}.\n$$\n归一化条件 $\\sum_{k=0}^{L}\\pi_{k}=1$ 给出\n$$\n1=\\pi_{0}\\sum_{k=0}^{L}\\binom{L}{k}=\\pi_{0}\\,2^{L}\\quad\\Longrightarrow\\quad \\pi_{0}=2^{-L},\n$$\n因此\n$$\n\\pi_{k}=2^{-L}\\binom{L}{k}\\quad\\text{对于所有 }k.\n$$\n\n全 1 的比特串唯一地对应于 $k=L$。对于一个具有平稳分布 $\\pi$ 的不可约正常返马尔可夫链，Kac 引理指出，返回一个状态的平均回返时间等于该状态平稳概率的倒数。因此，返回状态 $k=L$ 的平均时间是\n$$\n\\mathbb{E}[\\text{首次返回 }k=L\\text{ 的时间}]=\\frac{1}{\\pi_{L}}=\\frac{1}{2^{-L}\\binom{L}{L}}=2^{L}.\n$$\n尽管该链是周期为 2 的周期链，但关于平均回返时间的 Kac 公式仍然成立，因此该结果有效。\n\n因此，从全 1 状态开始，首次返回该状态的期望步数是 $2^{L}$。", "answer": "$$\\boxed{2^{L}}$$", "id": "1329929"}, {"introduction": "本章的最后一个练习将带我们进入一个更抽象但极其深刻的领域，探讨一个随机过程的循环特性如何依赖于其所在空间的维度。通过分析一个假设的粒子相互作用系统，我们需要巧妙地将一个双粒子问题转化为一个单粒子随机游走问题。这个练习不仅是对你问题转化能力的考验，更是为了揭示由数学家Pólya发现的著名结论：随机游走在低维空间（$d=1, 2$）是常返的，而在高维空间（$d \\ge 3$）则是暂留的。[@problem_id:1329934]", "problem": "考虑一个假想的物理系统，其中包含两个相互作用的粒子，一个“zeton”和一个“anti-zeton”，它们位于一个无限$d$维立方晶格上，该晶格由整数坐标$\\mathbb{Z}^d$表示。设它们在离散时间步$n$的位置由向量$X_n \\in \\mathbb{Z}^d$和$Y_n \\in \\mathbb{Z}^d$表示。粒子在“碰撞态”下被创造出来，意味着它们从相同的位置开始。它们随后的演化遵循以下规则：\n\n1.  **独立随机游走**：只要粒子处于不同位置（$X_n \\neq Y_n$），它们各自进行独立的简单对称随机游走。在$\\mathbb{Z}^d$上的简单对称随机游走中，位于格点$\\vec{v}$的粒子会移动到其$2d$个最近邻格点$\\vec{v} \\pm \\vec{e_i}$之一（其中$\\{\\vec{e_1}, \\dots, \\vec{e_d}\\}$是标准基），$2d$种可能的移动中的每一种都以相等的概率$1/(2d)$被选择。\n\n2.  **湮灭-再生成相互作用**：如果粒子在同一位置相遇（$X_n = Y_n$），则称它们“湮灭”。这一事件会触发下一步的特殊再生成规则。如果$X_n = Y_n = \\vec{k}$，它们在时间$n+1$的位置将被设置为$X_{n+1} = \\vec{k} + \\vec{\\zeta}$和$Y_{n+1} = \\vec{k} - \\vec{\\zeta}$。步长向量$\\vec{\\zeta}$是从$2d$个可能的最近邻步长向量$\\{\\pm \\vec{e_1}, \\dots, \\pm \\vec{e_d}\\}$中均匀随机选择的。在紧随碰撞之后的那一步，此相互作用规则取代了标准的随机游走动力学。\n\n“碰撞态”是系统中任何满足$X_n = Y_n$的构型。如果一个马尔可夫过程从某个状态集出发，最终返回该状态集的概率为1，则称该过程对于此状态集是常返的。在此背景下，如果一次碰撞后，保证在未来的某个时间会发生下一次碰撞，我们就定义碰撞态为常返的。如果此概率小于1，则碰撞态是暂留的。\n\n对于哪些整数维度$d \\ge 1$，碰撞态是常返的？\n\nA. 仅在$d = 1$时。\n\nB. 仅在$d = 2$时。\n\nC. 在$d = 1$和$d = 2$时。\n\nD. 仅在$d \\ge 3$时。\n\nE. 对于所有维度$d \\ge 1$。", "solution": "定义差分过程$D_{n}=X_{n}-Y_{n}\\in \\mathbb{Z}^{d}$。在时间$n$的碰撞等价于$D_{n}=0$。我们分析$D_{n}$，以确定从一次碰撞开始，该过程是否以概率$1$返回到$D=0$。\n\n当$D_{n}\\neq 0$时，粒子通过简单的对称最近邻步长独立移动。设$U_{n}$和$V_{n}$表示它们在时间$n$的步长，其中$U_{n}$和$V_{n}$各自在$\\{\\pm \\vec{e}_{1},\\dots,\\pm \\vec{e}_{d}\\}$上均匀分布，且相互独立。则\n$$\nD_{n+1}-D_{n}=U_{n}-V_{n}.\n$$\n由此可得\n$$\n\\mathbb{E}[D_{n+1}-D_{n}]=\\mathbb{E}[U_{n}]-\\mathbb{E}[V_{n}]=0,\n$$\n并且，利用独立性，\n$$\n\\operatorname{Cov}(D_{n+1}-D_{n})=\\operatorname{Cov}(U_{n})+\\operatorname{Cov}(V_{n}),\n$$\n这是一个有限的正定矩阵，因为每个$U_{n}$（以及$V_{n}$）都以等概率取$2d$个单位向量中的一个。因此，在远离$0$处，$D_{n}$是$\\mathbb{Z}^{d}$上的一个均值为零、具有有限二阶矩的对称、空间齐次随机游走。增量分布允许$D_{n+1}-D_{n}=0$以正概率发生（当$U_{n}=V_{n}$时），这使得该游走是惰性的；惰性不影响其是常返还是暂留。\n\n在碰撞时间$n$且$D_{n}=0$时，特殊规则规定\n$$\nX_{n+1}= \\vec{k}+\\vec{\\zeta},\\quad Y_{n+1}= \\vec{k}-\\vec{\\zeta}\\quad \\text{其中 }\\vec{\\zeta}\\text{ 在 }\\{\\pm \\vec{e}_{1},\\dots,\\pm \\vec{e}_{d}\\}\\text{ 上均匀分布},\n$$\n所以\n$$\nD_{n+1}=X_{n+1}-Y_{n+1}=2\\vec{\\zeta}.\n$$\n因此，从一次碰撞开始，差分的碰撞后状态为$D_{1}=2\\vec{\\zeta}$，在$2d$个向量$\\{\\pm 2\\vec{e}_{1},\\dots,\\pm 2\\vec{e}_{d}\\}$中均匀选取。从时间$1$开始，直到下一次可能的碰撞，$D_{n}$都遵循上述的独立行走规则演化，即增量为$U_{n}-V_{n}$。\n\n因此，发生后续碰撞的事件，等价于对称随机游走$D_{n}$从一个固定的非零位置（具体地说是$\\pm 2\\vec{e}_{i}$中的一个）出发，能够击中$0$的事件。根据Chung–Fuchs常返判据（Pólya定理的推广），任何在$\\mathbb{Z}^{d}$上均值为零、具有有限二阶矩的对称随机游走，是常返的当且仅当$d\\leq 2$，是暂留的当$d\\geq 3$。特别地，对于$d=1$和$d=2$，从任何起始点击中原点的概率为$1$，而对于$d\\geq 3$，该概率严格小于$1$。\n\n因此，从一次碰撞开始，发生后续碰撞的概率为$1$当且仅当$d=1$或$d=2$，而对于$d\\geq 3$该概率小于$1$。因此，碰撞态仅在维度$d=1$和$d=2$时是常返的。", "answer": "$$\\boxed{C}$$", "id": "1329934"}]}