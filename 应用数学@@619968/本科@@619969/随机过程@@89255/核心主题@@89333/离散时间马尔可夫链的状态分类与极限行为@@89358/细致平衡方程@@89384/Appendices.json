{"hands_on_practices": [{"introduction": "这个练习直接展示了细致平衡方程的核心应用。当一个系统已知是可逆的时，我们可以利用局部平衡条件 $\\pi_i r_{ij} = \\pi_j r_{ji}$ 来直接计算相邻状态的稳态概率之比。这个问题将向你展示，即使不求解完整的稳态分布，我们依然能提取关于系统平衡状态的宝贵信息，这凸显了该方法的简洁与强大。[@problem_id:1296903]", "problem": "一个涉及单个分子的生物物理系统可以被简化并建模为一个在标记为1、2和3的三个不同能量状态之间进行随机游走的粒子。该过程是一个连续时间马尔可夫链。这些状态之间的转移速率由一个正常数 $\\alpha$ 给出，其单位是时间的倒数：\n\n- 从状态 1 到状态 2 的转移速率为 $r_{12} = 2\\alpha$。\n- 从状态 2 到状态 1 的转移速率为 $r_{21} = 5\\alpha$。\n- 从状态 2 到状态 3 的转移速率为 $r_{23} = 3\\alpha$。\n- 从状态 3 到状态 2 的转移速率为 $r_{32} = 4\\alpha$。\n- 从状态 3 到状态 1 的转移速率为 $r_{31} = 10\\alpha$。\n- 从状态 1 到状态 3 的转移速率为 $r_{13}$，它是一个确保该过程可逆的某个恒定速率。\n\n已知该系统会达到一个平稳分布，记为 $\\{\\pi_1, \\pi_2, \\pi_3\\}$，其中 $\\pi_i$ 是在状态 $i$ 中找到该分子的稳态概率。已知该过程是可逆的，求平稳概率的无量纲比率 $\\pi_2 / \\pi_3$ 的值。", "solution": "对于一个具有平稳分布 $\\{\\pi_{1},\\pi_{2},\\pi_{3}\\}$ 和转移速率 $r_{ij}$ 的可逆连续时间马尔可夫链，细致平衡方程对于每条双向边都必须成立：\n$$\n\\pi_{i} r_{ij} = \\pi_{j} r_{ji}.\n$$\n将细致平衡应用于状态对 $2$ 和 $3$ 可得\n$$\n\\pi_{2} r_{23} = \\pi_{3} r_{32}.\n$$\n求解所求的比率可得出\n$$\n\\frac{\\pi_{2}}{\\pi_{3}} = \\frac{r_{32}}{r_{23}}.\n$$\n代入给定的速率 $r_{23} = 3\\alpha$ 和 $r_{32} = 4\\alpha$，\n$$\n\\frac{\\pi_{2}}{\\pi_{3}} = \\frac{4\\alpha}{3\\alpha} = \\frac{4}{3}.\n$$\n该比率与 $\\alpha$ 无关，因为它被消去了。作为使用其他边进行的一致性检验，对 (1,2) 应用细致平衡可得 $\\pi_{2}/\\pi_{1} = \\frac{2\\alpha}{5\\alpha} = \\frac{2}{5}$，因此 $\\pi_{3}/\\pi_{1} = \\frac{3}{10}$，然后对 (1,3) 应用细致平衡要求 $r_{13} = \\frac{\\pi_{3}}{\\pi_{1}} r_{31} = \\frac{3}{10} \\cdot 10\\alpha = 3\\alpha$，这与可逆性是一致的。因此，所求的比率为 $\\frac{4}{3}$。", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "1296903"}, {"introduction": "本实践问题探讨了一种在许多科学领域都至关重要的模型：生灭过程。通过对连续状态应用细致平衡原理，我们可以将所有稳态概率用一个参考状态（例如 $\\pi_0$）来表示。这个练习将引导你根据模型描述计算出生率和死亡率，然后利用细致平衡和归一化条件，系统地求解出完整的稳态分布。[@problem_id:1296899]", "problem": "考虑一个小型孤立社群中的简化社会动态模型，该社群有 $N=4$ 个个体。每个个体可以处于两种状态之一：“单身”或“配对”。整个系统的状态由配对数量 $n$ 描述。该系统可以建模为一个关于配对数量的连续时间马尔可夫链，具体来说是一个生灭过程。\n\n状态之间的转换遵循以下规则：\n1.  **配对（出生）：** 任何两个“单身”个体都可以形成一个新的配对。从具有 $n$ 个配对的状态转换到 $n+1$ 个配对的总速率由出生率 $\\lambda_n = \\alpha \\binom{S_n}{2}$ 给出，其中 $S_n$ 是当有 $n$ 个配对时的单身个体数量，$\\alpha$ 是一个常数配对速率参数。\n2.  **分离（死亡）：** 一个已有的配对可以分离，使两个个体都变回“单身”。从具有 $n$ 个配对的状态转换到 $n-1$ 个配对的总速率由死亡率 $\\mu_n = \\beta n$ 给出，其中 $\\beta$ 是一个常数分离速率参数。\n\n假设系统已运行足够长的时间以达到稳态（或平衡）状态。已知速率参数之比为 $\\frac{\\alpha}{\\beta} = \\frac{1}{3}$，计算社群恰好由两个配对组成（即所有个体都已配对）的稳态概率。将你的答案表示为最简分数形式。", "solution": "令系统的状态为配对的数量 $n$。由于总共有 $N=4$ 个个体，配对的数量可以是 $n=0$，$n=1$ 或 $n=2$。因此，这个生灭过程的状态空间是 $\\{0, 1, 2\\}$。令 $\\pi_n$ 为处于状态 $n$ 的稳态概率。\n\n首先，我们确定每个状态的出生率 $\\lambda_n$ 和死亡率 $\\mu_n$。\n\n当有 $n$ 个配对时，单身个体的数量 $S_n$ 为 $S_n = N - 2n = 4 - 2n$。\n\n**计算出生率 ($\\lambda_n = \\alpha \\binom{S_n}{2}$):**\n-   对于 $n=0$：有 $S_0 = 4-2(0) = 4$ 个单身个体。出生率为 $\\lambda_0 = \\alpha \\binom{4}{2} = \\alpha \\frac{4 \\times 3}{2} = 6\\alpha$。这是从状态 0 转换到状态 1 的速率。\n-   对于 $n=1$：有 $S_1 = 4-2(1) = 2$ 个单身个体。出生率为 $\\lambda_1 = \\alpha \\binom{2}{2} = \\alpha \\frac{2 \\times 1}{2} = \\alpha$。这是从状态 1 转换到状态 2 的速率。\n-   对于 $n=2$：有 $S_2 = 4-2(2) = 0$ 个单身个体。出生率为 $\\lambda_2 = \\alpha \\binom{0}{2} = 0$。无法形成新的配对。\n\n**计算死亡率 ($\\mu_n = \\beta n$):**\n-   对于 $n=0$：没有配对可以分离，所以死亡率为 $\\mu_0 = \\beta(0) = 0$。\n-   对于 $n=1$：有一个配对。死亡率为 $\\mu_1 = \\beta(1) = \\beta$。这是从状态 1 转换到状态 0 的速率。\n-   对于 $n=2$：有两个配对。死亡率为 $\\mu_2 = \\beta(2) = 2\\beta$。这是从状态 2 转换到状态 1 的速率。\n\n在稳态下，生灭过程满足细致平衡方程：\n$$ \\pi_n \\lambda_n = \\pi_{n+1} \\mu_{n+1} $$\n\n我们可以使用这些方程用 $\\pi_0$ 来表示 $\\pi_1$ 和 $\\pi_2$。\n\n对于 $n=0$：\n$$ \\pi_0 \\lambda_0 = \\pi_1 \\mu_1 $$\n$$ \\pi_0 (6\\alpha) = \\pi_1 (\\beta) $$\n$$ \\pi_1 = \\pi_0 \\frac{6\\alpha}{\\beta} $$\n\n对于 $n=1$：\n$$ \\pi_1 \\lambda_1 = \\pi_2 \\mu_2 $$\n$$ \\pi_1 (\\alpha) = \\pi_2 (2\\beta) $$\n$$ \\pi_2 = \\pi_1 \\frac{\\alpha}{2\\beta} $$\n\n现在，将 $\\pi_1$ 的表达式代入 $\\pi_2$ 的方程中：\n$$ \\pi_2 = \\left( \\pi_0 \\frac{6\\alpha}{\\beta} \\right) \\frac{\\alpha}{2\\beta} = \\pi_0 \\frac{6\\alpha^2}{2\\beta^2} = 3 \\left( \\frac{\\alpha}{\\beta} \\right)^2 \\pi_0 $$\n\n给定速率参数之比为 $\\frac{\\alpha}{\\beta} = \\frac{1}{3}$。我们可以将此值代入 $\\pi_1$ 和 $\\pi_2$ 的表达式中。\n\n$$ \\pi_1 = 6 \\left( \\frac{\\alpha}{\\beta} \\right) \\pi_0 = 6 \\left( \\frac{1}{3} \\right) \\pi_0 = 2\\pi_0 $$\n$$ \\pi_2 = 3 \\left( \\frac{\\alpha}{\\beta} \\right)^2 \\pi_0 = 3 \\left( \\frac{1}{3} \\right)^2 \\pi_0 = 3 \\left( \\frac{1}{9} \\right) \\pi_0 = \\frac{1}{3}\\pi_0 $$\n\n所有稳态概率的总和必须等于 1（归一化条件）：\n$$ \\pi_0 + \\pi_1 + \\pi_2 = 1 $$\n\n用 $\\pi_0$ 的表达式代入：\n$$ \\pi_0 + 2\\pi_0 + \\frac{1}{3}\\pi_0 = 1 $$\n$$ \\left(1 + 2 + \\frac{1}{3}\\right) \\pi_0 = 1 $$\n$$ \\left(3 + \\frac{1}{3}\\right) \\pi_0 = 1 $$\n$$ \\left(\\frac{9}{3} + \\frac{1}{3}\\right) \\pi_0 = 1 $$\n$$ \\frac{10}{3} \\pi_0 = 1 $$\n$$ \\pi_0 = \\frac{3}{10} $$\n\n题目要求的是恰好有两个配对的概率，即 $\\pi_2$。我们现在可以计算它的值：\n$$ \\pi_2 = \\frac{1}{3}\\pi_0 = \\frac{1}{3} \\left( \\frac{3}{10} \\right) = \\frac{1}{10} $$", "answer": "$$\\boxed{\\frac{1}{10}}$$", "id": "1296899"}, {"introduction": "现在，我们从连续时间马尔可夫链转向离散时间马尔可夫链，这个问题说明了细致平衡原理同样适用且同样强大。直接使用全局平衡方程组 $\\vec{\\pi} = \\vec{\\pi} P$ 求解稳态分布在代数上可能相当繁琐。这个练习旨在展示，应用细致平衡条件 $\\pi_i P_{ij} = \\pi_j P_{ji}$ 如何为寻找系统的平衡概率提供一条更直接、更直观的路径。[@problem_id:1296904]", "problem": "一个清洁机器人在一个由四个呈直线排列的房间组成的小型办公套间中运行：房间1、房间2、房间3和房间4。房间1仅与房间2相连。房间2与房间1和房间3相连。房间3与房间2和房间4相连。房间4仅与房间3相连。\n\n机器人的移动被建模为一个离散时间马尔可夫链，其中状态是机器人当前所在的房间。在每个时间步，机器人的控制系统执行以下算法：\n- 机器人以 $1/2$ 的概率停留在当前房间进行深度清洁。\n- 以剩余的概率，机器人试图移动到相邻的房间。如果当前房间有多个相邻房间，机器人会以相等的概率选择其中一个。\n\n经过很长一段时间后，机器人的位置服从一个平稳概率分布。设 $\\pi = (\\pi_1, \\pi_2, \\pi_3, \\pi_4)$ 为该平稳分布，其中 $\\pi_i$ 是在房间 $i$ 中找到机器人的概率。\n\n确定平稳分布 $\\pi$。将您的答案表示为一个由四个最简分数组成的行向量，代表概率 $(\\pi_1, \\pi_2, \\pi_3, \\pi_4)$。", "solution": "以房间为状态对此链进行建模。根据规则：\n- 在房间1和4（只有一个邻居的端点房间）中，机器人以 $\\frac{1}{2}$ 的概率停留在原地，并以 $\\frac{1}{2}$ 的概率移动到唯一的邻居。\n- 在房间2和3（有两个邻居的内部房间）中，机器人以 $\\frac{1}{2}$ 的概率停留在原地，并以 $\\frac{1}{4}$ 的概率移动到每个邻居。\n\n因此，非零一步转移概率为\n$$\nP_{11}=\\frac{1}{2},\\quad P_{12}=\\frac{1}{2},\\quad\nP_{21}=\\frac{1}{4},\\quad P_{22}=\\frac{1}{2},\\quad P_{23}=\\frac{1}{4},\n$$\n$$\nP_{32}=\\frac{1}{4},\\quad P_{33}=\\frac{1}{2},\\quad P_{34}=\\frac{1}{4},\\quad\nP_{43}=\\frac{1}{2},\\quad P_{44}=\\frac{1}{2}.\n$$\n\n设 $\\pi=(\\pi_{1},\\pi_{2},\\pi_{3},\\pi_{4})$ 为一个平稳分布，则 $\\pi=\\pi P$ 且 $\\sum_{i=1}^{4}\\pi_{i}=1$。平衡方程 $\\pi_{j}=\\sum_{i}\\pi_{i}P_{ij}$ 为\n$$\n\\pi_{1}=\\frac{1}{2}\\pi_{1}+\\frac{1}{4}\\pi_{2},\\qquad\n\\pi_{2}=\\frac{1}{2}\\pi_{2}+\\frac{1}{2}\\pi_{1}+\\frac{1}{4}\\pi_{3},\n$$\n$$\n\\pi_{3}=\\frac{1}{2}\\pi_{3}+\\frac{1}{4}\\pi_{2}+\\frac{1}{2}\\pi_{4},\\qquad\n\\pi_{4}=\\frac{1}{2}\\pi_{4}+\\frac{1}{4}\\pi_{3},\n$$\n以及\n$$\n\\pi_{1}+\\pi_{2}+\\pi_{3}+\\pi_{4}=1.\n$$\n\n由平衡方程中的第一个和最后一个方程可得，\n$$\n\\pi_{1}-\\frac{1}{2}\\pi_{1}=\\frac{1}{4}\\pi_{2}\\;\\Rightarrow\\;\\pi_{1}=\\frac{1}{2}\\pi_{2},\\qquad\n\\pi_{4}-\\frac{1}{2}\\pi_{4}=\\frac{1}{4}\\pi_{3}\\;\\Rightarrow\\;\\pi_{4}=\\frac{1}{2}\\pi_{3}.\n$$\n使用第二个平衡方程，两边同时减去 $\\frac{1}{2}\\pi_{2}$：\n$$\n\\frac{1}{2}\\pi_{2}=\\frac{1}{2}\\pi_{1}+\\frac{1}{4}\\pi_{3}\\;\\Rightarrow\\;\\pi_{2}=\\pi_{1}+\\frac{1}{2}\\pi_{3}.\n$$\n将由 $\\pi_{1}=\\frac{1}{2}\\pi_{2}$ 得到的 $\\pi_{2}=2\\pi_{1}$ 代入，得到\n$$\n2\\pi_{1}=\\pi_{1}+\\frac{1}{2}\\pi_{3}\\;\\Rightarrow\\;\\pi_{1}=\\frac{1}{2}\\pi_{3}\\;\\Rightarrow\\;\\pi_{3}=2\\pi_{1}.\n$$\n于是 $\\pi_{4}=\\frac{1}{2}\\pi_{3}=\\pi_{1}$ 且 $\\pi_{2}=2\\pi_{1}$。利用归一化条件：\n$$\n\\pi_{1}+\\pi_{2}+\\pi_{3}+\\pi_{4}=\\pi_{1}+2\\pi_{1}+2\\pi_{1}+\\pi_{1}=6\\pi_{1}=1\\;\\Rightarrow\\;\\pi_{1}=\\frac{1}{6}.\n$$\n因此，\n$$\n\\pi_{2}=2\\pi_{1}=\\frac{1}{3},\\quad \\pi_{3}=2\\pi_{1}=\\frac{1}{3},\\quad \\pi_{4}=\\pi_{1}=\\frac{1}{6}.\n$$\n\n因此，平稳分布是\n$$\n\\left(\\frac{1}{6},\\frac{1}{3},\\frac{1}{3},\\frac{1}{6}\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{6} & \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{6}\\end{pmatrix}}$$", "id": "1296904"}]}