{"hands_on_practices": [{"introduction": "要掌握平稳分布，第一步是学会如何从问题描述中建立转移矩阵，并求解相应的稳态方程。这个练习提供了一个经典的离散时间马尔可夫链模型 [@problem_id:1334120]，模拟了网络服务器的负载变化。通过解决这个问题，你将直接实践求解线性方程组以找到唯一平稳分布的核心计算技能，为后续更复杂的应用打下坚实的基础。", "problem": "一个单一网络服务器工作负载的简化模型由一个具有三种状态的离散时间马尔可夫链描述：低 (L)、中 (M) 和高 (H)。服务器的状态在固定的时间间隔被观测。状态之间的转移规则如下：\n\n*   如果服务器处于低状态，在下一个时间步它将以概率 $p_{LM} = 1/2$ 转移到中等状态。否则，它将保持在低状态。\n*   如果服务器处于中等状态，它将以概率 $p_{MH} = 1/3$ 转移到高状态，并以概率 $p_{ML} = 1/3$ 转移到低状态。否则，它将保持在中等状态。\n*   如果服务器处于高状态，它将以概率 $p_{HM} = 3/4$ 转移到中等状态。否则，它将保持在高状态。\n\n假设服务器已经运行了很长时间并达到了稳态，计算该服务器处于高负载状态的时间在长期来看所占的比例。将您的答案表示为最简精确分数。", "solution": "我们将该系统建模为状态为 $L, M, H$ 的离散时间马尔可夫链，其转移矩阵为 $P$（行和列按 $L, M, H$ 排序）：\n$$\nP=\\begin{pmatrix}\n\\frac{1}{2} & \\frac{1}{2} & 0 \\\\\n\\frac{1}{3} & \\frac{1}{3} & \\frac{1}{3} \\\\\n0 & \\frac{3}{4} & \\frac{1}{4}\n\\end{pmatrix}.\n$$\n该链是不可约的（每个状态都可以通过给定的转移到达其他状态）和非周期的（每个状态都有一个正的自循环），因此它有一个唯一的平稳分布。\n\n设平稳分布为 $\\pi=(x,y,z)$，对应于 $(L,M,H)$，其中 $x,y,z \\ge 0$ 且 $x+y+z=1$。平稳条件 $\\pi=\\pi P$ 产生以下分量方程：\n$$\nx = \\frac{1}{2}x + \\frac{1}{3}y + 0\\cdot z,\n$$\n$$\ny = \\frac{1}{2}x + \\frac{1}{3}y + \\frac{3}{4}z,\n$$\n$$\nz = 0\\cdot x + \\frac{1}{3}y + \\frac{1}{4}z,\n$$\n以及归一化条件 $x+y+z=1$。\n\n从 $L$-分量方程可得，\n$$\nx - \\frac{1}{2}x = \\frac{1}{3}y \\quad \\Longrightarrow \\quad \\frac{1}{2}x = \\frac{1}{3}y \\quad \\Longrightarrow \\quad y = \\frac{3}{2}x.\n$$\n从 $H$-分量方程可得，\n$$\nz - \\frac{1}{4}z = \\frac{1}{3}y \\quad \\Longrightarrow \\quad \\frac{3}{4}z = \\frac{1}{3}y \\quad \\Longrightarrow \\quad z = \\frac{4}{9}y.\n$$\n将 $y=\\frac{3}{2}x$ 代入 $z=\\frac{4}{9}y$ 得\n$$\nz = \\frac{4}{9}\\cdot \\frac{3}{2}x = \\frac{2}{3}x.\n$$\n使用归一化条件：\n$$\nx + y + z = x + \\frac{3}{2}x + \\frac{2}{3}x = \\left(1 + \\frac{3}{2} + \\frac{2}{3}\\right)x = \\frac{19}{6}x = 1,\n$$\n所以\n$$\nx = \\frac{6}{19}, \\quad y = \\frac{3}{2}x = \\frac{9}{19}, \\quad z = \\frac{2}{3}x = \\frac{4}{19}.\n$$\n因此，长期来看处于高状态的时间比例是 $z=\\frac{4}{19}$。", "answer": "$$\\boxed{\\frac{4}{19}}$$", "id": "1334120"}, {"introduction": "对于某些特定结构的马尔可夫链，例如生灭过程，存在一种比直接求解全局平衡方程更简洁的方法。这个练习将引导你使用“细致平衡”（detailed balance）条件来找到一个基因调控模型的平稳分布 [@problem_id:1334119]。这个问题不仅展示了一种强大的分析技巧，还能让你体会到如何处理一个由参数 $N$ 定义的可变状态空间系统，其结果恰好对应于一个著名的概率分布。", "problem": "考虑一个单个基因调控的简化模型。基因的活性水平由其启动子区域决定，我们将其建模为一个系统，该系统具有 $N$ 个用于某种调控分子的不同结合位点。系统的状态由整数 $k$ 描述，表示被占据的结合位点的数量，其中 $k$ 的取值范围为从 $0$ 到 $N$。因此，系统可以处于 $N+1$ 个可能状态 $\\{0, 1, \\dots, N\\}$ 中的一个。\n\n状态之间的转换发生在离散的时间步长上。在每个时间步，从 $N$ 个位点中均匀随机地选择一个。如果所选位点被占据，它将变为空置。如果它未被占据，它将被占据。这个过程可以更正式地描述如下：\n假设系统处于状态 $k$，意味着有 $k$ 个位点被占据，有 $N-k$ 个位点未被占据。\n- 如果 $0 < k < N$，当选择到 $k$ 个被占据位点中的一个时，系统将转换到状态 $k-1$；当选择到 $N-k$ 个未被占据位点中的一个时，系统将转换到状态 $k+1$。\n- 如果系统处于状态 $k=0$（所有位点均为空置），任何被选中的位点都将是未被占据的，因此它将被占据。所以系统必须转换到状态 $k=1$。\n- 如果系统处于状态 $k=N$（所有位点均被占据），任何被选中的位点都将被占据，因此它将变为空置。所以系统必须转换到状态 $k=N-1$。\n\n此过程在状态空间 $\\{0, 1, \\dots, N\\}$ 上定义了一个马尔可夫链。经过很长一段时间后，预计系统将达到一个由平稳分布 $\\pi_k$ 描述的统计平衡状态，其中 $\\pi_k$ 表示系统处于状态 $k$ 的长期概率。\n\n确定对于任意状态 $k$（其中 $0 \\le k \\le N$）的平稳分布 $\\pi_k$。您的答案应该是一个以 $k$ 和 $N$ 表示的解析表达式。", "solution": "该链的状态为 $k \\in \\{0,1,\\dots,N\\}$，并且每一步的转换都使 $k$ 恰好改变一。从状态 $k$（$0<k<N$）出发，从 $N$ 个位点中选择的一个位点会被翻转。因此，转移概率为\n$$\nP_{k,k+1}=\\frac{N-k}{N}, \n\\qquad \nP_{k,k-1}=\\frac{k}{N}.\n$$\n在边界处，翻转是确定性的：\n$$\nP_{0,1}=1, \n\\qquad \nP_{N,N-1}=1.\n$$\n\n这是一个有限状态空间上的生灭链，因此是不可约的，并且存在唯一的平稳分布。为了找到它，我们使用细致平衡条件，这对于有限链来说是平稳性的充分条件。对于 $0 \\leq k \\leq N-1$，细致平衡条件要求\n$$\n\\pi_{k} P_{k,k+1}=\\pi_{k+1} P_{k+1,k}.\n$$\n代入转移概率得到\n$$\n\\pi_{k} \\cdot \\frac{N-k}{N}=\\pi_{k+1} \\cdot \\frac{k+1}{N}\n\\quad \\Rightarrow \\quad\n\\frac{\\pi_{k+1}}{\\pi_{k}}=\\frac{N-k}{k+1}.\n$$\n解此递归关系，对于 $k \\geq 1$，可得\n$$\n\\pi_{k}=\\pi_{0} \\prod_{j=0}^{k-1} \\frac{N-j}{j+1}\n=\\pi_{0} \\binom{N}{k}.\n$$\n包含 $k=0$ 的情况（此时 $\\pi_{0}$ 在归一化前是自由的），并使用 $\\sum_{k=0}^{N} \\pi_{k}=1$ 进行归一化，可得\n$$\n1=\\sum_{k=0}^{N} \\pi_{k}\n=\\pi_{0} \\sum_{k=0}^{N} \\binom{N}{k}\n=\\pi_{0} \\cdot 2^{N}\n\\quad \\Rightarrow \\quad\n\\pi_{0}=2^{-N}.\n$$\n因此，对于所有的 $0 \\leq k \\leq N$，\n$$\n\\pi_{k}=2^{-N} \\binom{N}{k}.\n$$\n该结果满足所有相邻状态对（包括边界）的细致平衡条件，因此是平稳分布。", "answer": "$$\\boxed{2^{-N}\\binom{N}{k}}$$", "id": "1334119"}, {"introduction": "系统的长期行为有时会揭示出一些反直觉但深刻的性质。本练习探讨了一个沿着圆形轨迹运动的分子马达模型，其运动具有明显的方向偏好性 [@problem_id:1334104]。通过分析这个问题，你将发现，尽管存在局部运动偏好，系统的整体对称性却导致了一个完全均匀的平稳分布。这个出人意料的结果突显了在分析随机过程时，全局结构往往比局部转移规则更能决定其稳态特性。", "problem": "一个分子马达的生物物理模型描述了其沿着环状丝的运动。该环状丝由 $N$ 个离散的结合位点组成，依次标记为 $0, 1, 2, \\dots, N-1$，形成一个闭合环路，其中位点 $N-1$ 与位点 $0$ 相邻。马达的位置被建模为一个离散时间随机过程。在每个时间步，如果马达位于位点 $i$，它将以概率 $\\alpha$ 跳到序列中的下一个位点 $(i+1) \\pmod N$。相应地，它将以概率 $1-\\alpha$ 跳到前一个位点 $(i-1) \\pmod N$。参数 $\\alpha$ 是一个常数，满足 $0 < \\alpha < 1$，表示马达运动中的方向性偏好。\n\n系统经过很长时间的演化后，会达到一个稳态。确定在稳态下，在任意位点 $k$ (其中 $k$ 是从 $0$ 到 $N-1$ 的整数) 找到该马达的概率。请用关于 $N$ 的闭式解析表达式来表示你的答案。", "solution": "将马达建模为在有限状态空间 $\\{0,1,\\dots,N-1\\}$ 上的时齐马尔可夫链，其转移概率为\n$$\nP\\big(i,(i+1)\\bmod N\\big)=\\alpha,\\qquad P\\big(i,(i-1)\\bmod N\\big)=1-\\alpha,\n$$\n所有其他转移的概率为 $0$。对于一个平稳分布 $\\pi=(\\pi_{0},\\dots,\\pi_{N-1})$，平稳性方程要求对每个 $k$ (下标对 $N$ 取模) 成立：\n$$\n\\pi_{k}=\\sum_{j=0}^{N-1}\\pi_{j}P(j,k)=\\pi_{k-1}\\alpha+\\pi_{k+1}(1-\\alpha).\n$$\n由于转移结构具有平移不变性，考虑一个对所有 $k$ 均为常数的解 $\\pi_{k}=c$。代入平稳性方程得到\n$$\nc=c\\alpha+c(1-\\alpha)=c,\n$$\n该式对任意常数 $c$ 均成立。施加归一化条件，\n$$\n\\sum_{k=0}^{N-1}\\pi_{k}=\\sum_{k=0}^{N-1}c=Nc=1,\n$$\n可得 $c=\\frac{1}{N}$。因为 $0<\\alpha<1$，该链在有限状态空间上是不可约的，所以平稳分布是唯一的。因此，在稳态下，在任意位点 $k$ 找到该马达的概率是\n$$\n\\pi_{k}=\\frac{1}{N}.\n$$", "answer": "$$\\boxed{\\frac{1}{N}}$$", "id": "1334104"}]}