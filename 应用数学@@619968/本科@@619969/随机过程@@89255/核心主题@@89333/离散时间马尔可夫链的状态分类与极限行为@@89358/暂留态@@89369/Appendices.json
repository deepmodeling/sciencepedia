{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式就是实践。在本节中，我们将通过一系列精心设计的练习，将暂态的概念付诸实践。这些练习中的许多场景都是为了教学目的而构建的假设情景，旨在清晰地揭示核心科学原理。我们的重点在于理解这些原理，而非场景本身是否完全写实。让我们从一个直观的例子开始，这个例子模拟了一个工业设备的运行状态。通过分析这个简单的三状态马尔可夫链，你将学会如何通过检查状态之间的转移路径来直接识别暂态，特别是当系统中存在一个无法逃离的“陷阱”（即吸收态）时 [@problem_id:1347265]。", "problem": "一个简化的工业设备运行状态模型由一个具有三个状态的离散时间马尔可夫链描述：\n- 状态 1: 运行正常\n- 状态 2: 需要维护\n- 状态 3: 永久失效\n\n该设备的状态在每天结束时进行评估。状态之间的转移概率如下：\n- 如果某天设备处于状态 1 (运行正常)，那么它在第二天有 0.7 的概率保持在状态 1，有 0.3 的概率转移到状态 2。\n- 如果某天设备处于状态 2 (需要维护)，那么它有 0.5 的概率被修复并返回到状态 1，有 0.5 的概率失效并转移到状态 3。它绝不会连续第二天停留在状态 2。\n- 如果设备达到状态 3 (永久失效)，它将永远保持在该状态。\n\n如果一个状态从自身出发，存在非零概率永远不再返回此状态，则该状态被定义为暂态。根据所提供的转移概率，请确定此马尔可夫链中所有暂态的完整集合。\n\nA. {2}\n\nB. {3}\n\nC. {1, 3}\n\nD. {1, 2}\n\nE. 暂态集为空。", "solution": "设状态标记为 $1$ (运行正常)，$2$ (需要维护)，和 $3$ (永久失效)。单步转移矩阵为\n$$\nP=\\begin{pmatrix}\n0.7  0.3  0 \\\\\n0.5  0  0.5 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\n如果从状态 $i$ 出发，链永远不返回 $i$ 的概率为正，则状态 $i$ 是暂态。形式上，设 $T_{i}^{+}=\\inf\\{n\\ge 1:X_{n}=i\\}$，如果 $\\mathbb{P}_{i}(T_{i}^{+}=\\infty)0$，则状态 $i$ 是暂态。\n\n考虑状态 $1$。返回到状态 $1$ 的情况会在 $X_1=1$ 时发生。因此，为了在任何 $n\\ge 1$ 时都不返回，链必须在时刻 $1$ 避开 $1$（此时只能转移到状态 $2$），然后立即在时刻 $2$ 转移到状态 $3$。因为状态 $3$ 是吸收态，链此后将永远无法访问状态 $1$。因此，\n$$\n\\mathbb{P}_{1}(T_{1}^{+}=\\infty)=\\mathbb{P}(1\\to 2)\\,\\mathbb{P}(2\\to 3)=0.3\\times 0.5=0.150,\n$$\n所以状态 $1$ 是暂态。\n\n考虑状态 $2$。从状态 $2$ 出发，链以 $0.5$ 的概率转移到状态 $3$。由于状态 $3$ 是吸收态，这排除了未来返回到状态 $2$ 的任何可能性。因此，\n$$\n\\mathbb{P}_{2}(T_{2}^{+}=\\infty)\\ge \\mathbb{P}(2\\to 3)=0.50,\n$$\n所以状态 $2$ 是暂态。\n\n考虑状态 $3$。由于状态 $3$ 是吸收态，从状态 $3$ 出发，下一步 $X_1=3$ 的概率为 $1$，因此链在时刻 $1$ 以概率 $1$ 返回到状态 $3$，且\n$$\n\\mathbb{P}_{3}(T_{3}^{+}=\\infty)=0.\n$$\n因此，状态 $3$ 不是暂态（它是常返态）。\n\n所有暂态的完整集合是 $\\{1,2\\}$，对应于选项 D。", "answer": "$$\\boxed{D}$$", "id": "1347265"}, {"introduction": "在掌握了通过路径分析来识别暂态的基本方法后，让我们转向一种更具量化色彩的技巧。这个练习将我们带入著名的“赌徒破产问题”的变体中，这是一个在一维直线上进行的随机游走。你的任务是证明，在两个吸收壁之间，任何中间状态都是暂态。此练习旨在训练你使用“第一步分析”这一强大工具，通过精确计算返回起始点的概率 $P_{\\text{return}}$ 并证明其严格小于 1，从而为状态的分类提供严谨的数学依据 [@problem_id:1347263]。", "problem": "一个粒子被限制在一条一维离散位置线上移动，这些位置由整数 $\\{0, 1, 2, \\dots, N\\}$ 标记，其中 $N$ 是一个大于2的整数。粒子的运动由一个简单对称随机游走描述。在每个离散时间步，如果粒子位于位置 $k$（其中 $0  k  N$），它将以概率 $p=1/2$ 移动到位置 $k-1$，或以概率 $q=1/2$ 移动到位置 $k+1$。\n\n线的两端位置 $0$ 和 $N$ 是吸收壁。这意味着如果粒子到达位置 $0$ 或位置 $N$，它将在之后所有的时间步都停留在该位置。\n\n在随机过程的背景下，系统的状态被分为常返态或暂态。其定义如下：\n- 如果一个粒子从状态 $j$ 出发，必然最终会返回状态 $j$，则状态 $j$ 是**常返的**。返回的概率恰好为1。\n- 如果一个粒子从状态 $j$ 出发，有非零的概率永不返回状态 $j$，则状态 $j$ 是**暂态的**。返回的概率严格小于1。\n\n考虑一个任意起始位置 $i$，满足 $0  i  N$。根据所提供的定义，状态 $i$ 应如何分类？\n\nA. 状态 $i$ 是常返的。\n\nB. 状态 $i$ 是暂态的。\n\nC. 状态 $i$ 是吸收的。\n\nD. 状态 $i$ 的分类取决于 $i$ 和 $N$ 的具体数值。", "solution": "我们考虑在有限位置集合 $\\{0,1,\\dots,N\\}$ 上的简单对称随机游走，其在 $0$ 和 $N$ 处有吸收壁。对于一个满足 $0iN$ 的起始位置 $i$，我们通过计算从 $i$ 出发后，该游走返回到 $i$ 的概率 $r$ 来对状态 $i$ 进行分类。根据定义，状态 $i$ 是常返的当且仅当 $r=1$，是暂态的当且仅当 $r1$。\n\n使用首步分析法（全概率定律）。从 $i$ 出发，第一步以概率 $\\frac{1}{2}$ 移动到 $i-1$，或以概率 $\\frac{1}{2}$ 移动到 $i+1$。在这第一步之后：\n- 如果游走位于 $i-1$，它在被吸收前返回到 $i$ 的条件是当且仅当它在到达 $0$ 之前先到达 $i$。\n- 如果游走位于 $i+1$，它在被吸收前返回到 $i$ 的条件是当且仅当它在到达 $N$ 之前先到达 $i$。\n\n令 $r$ 表示返回概率。则\n$$\nr=\\frac{1}{2}\\,\\mathbb{P}_{i-1}\\!\\left(\\tau_{i}\\tau_{0}\\right)+\\frac{1}{2}\\,\\mathbb{P}_{i+1}\\!\\left(\\tau_{i}\\tau_{N}\\right),\n$$\n其中 $\\tau_{j}$ 是到达状态 $j$ 的首达时间。\n\n对于在具有吸收端点的区间上的无偏随机游走，标准的赌徒破产问题首达概率给出，对于 $ab$ 和 $k\\in\\{a,\\dots,b\\}$，\n$$\n\\mathbb{P}_{k}\\!\\left(\\tau_{b}\\tau_{a}\\right)=\\frac{k-a}{b-a},\\qquad \\mathbb{P}_{k}\\!\\left(\\tau_{a}\\tau_{b}\\right)=\\frac{b-k}{b-a}.\n$$\n将此公式应用于 $(a,b)=(0,i)$ 和 $k=i-1$ 的情况，得到\n$$\n\\mathbb{P}_{i-1}\\!\\left(\\tau_{i}\\tau_{0}\\right)=\\frac{(i-1)-0}{i-0}=\\frac{i-1}{i},\n$$\n应用于 $(a,b)=(i,N)$ 和 $k=i+1$ 的情况，得到\n$$\n\\mathbb{P}_{i+1}\\!\\left(\\tau_{i}\\tau_{N}\\right)=\\frac{N-(i+1)}{N-i}=\\frac{N-i-1}{N-i}.\n$$\n因此，\n$$\nr=\\frac{1}{2}\\left(\\frac{i-1}{i}\\right)+\\frac{1}{2}\\left(\\frac{N-i-1}{N-i}\\right)\n=\\frac{1}{2}\\left(1-\\frac{1}{i}\\right)+\\frac{1}{2}\\left(1-\\frac{1}{N-i}\\right)\n=1-\\frac{1}{2}\\left(\\frac{1}{i}+\\frac{1}{N-i}\\right).\n$$\n因为 $0iN$，我们有 $i\\geq 1$ 和 $N-i\\geq 1$，因此 $\\frac{1}{i}+\\frac{1}{N-i}0$，这意味着 $r1$。\n\n因此，返回到 $i$ 的概率严格小于1，所以状态 $i$ 是暂态的。根据假设 $0iN$，它也不是吸收态。\n\n因此，正确的分类是选项 B。", "answer": "$$\\boxed{B}$$", "id": "1347263"}, {"introduction": "我们已经探讨了有限状态空间中的暂态，现在让我们将视野扩展到无限的二维晶格。众所周知，标准的二维简单对称随机游走是常返的，意味着粒子最终总会返回起点。然而，这个练习引入了一个微妙但关键的改变：在原点设置一个吸收“陷阱”。这个思想实验将挑战你的直觉，并促使你思考一个系统的根本属性如何因一个局部改变而发生全局性的变化。通过构建简洁的论证，你将发现，仅仅一个陷阱的存在就足以使无限晶格上的所有其他点都变为暂态 [@problem_id:1347255]。", "problem": "一个粒子在二维整数格点 $\\mathbb{Z}^2$ 上进行简单对称随机游走。在每个离散时间步，位于位置 $(x, y)$ 的粒子会以相等的概率 $1/4$ 移动到其四个最近邻——$(x+1, y)$、$(x-1, y)$、$(x, y+1)$ 或 $(x, y-1)$——之一。\n\n对此随机游走引入一个修改：原点 $(0,0)$ 被指定为一个吸收“陷阱”。如果粒子一旦到达状态 $(0,0)$，它将在所有后续时间步中都停留在此处。所有其他状态 $(x,y) \\neq (0,0)$ 都是非吸收的。\n\n考虑一个从状态 $S = (1, 0)$ 开始游走的粒子。设 $P_{return}$ 为此粒子在未来某个时间步返回到起始状态 $S$ 的概率。下列关于 $P_{return}$ 的陈述中，哪一个是正确的？\n\nA. $P_{return} = 1$\n\nB. $P_{return}  1$\n\nC. $P_{return} = 0$\n\nD. 由于格点是无限的，$P_{return}$ 无定义。", "solution": "设 $\\{X_{t}\\}_{t \\geq 0}$ 为 $\\mathbb{Z}^{2}$ 上的简单对称随机游走，其起始状态为 $X_{0}=S=(1,0)$，向最近邻的转移概率均为 $\\frac{1}{4}$，且原点为吸收态：若对某个 $t$ 有 $X_{t}=(0,0)$，则对所有 $t' \\geq t$ 都有 $X_{t'}=(0,0)$。定义返回到 $S$ 的时间为 $T_{S}=\\inf\\{t \\geq 1 : X_{t}=S\\}$，且 $P_{return}=\\mathbb{P}(T_{S}\\infty)$。\n\n为证明 $P_{return}0$，考虑一条显式路径：在时间 $1$ 从 $(1,0)$ 移动到 $(2,0)$，然后在时间 $2$ 返回到 $(1,0)$。每一步的概率均为 $\\frac{1}{4}$ 且各步相互独立，所以\n$$\n\\mathbb{P}(X_{1}=(2,0),\\,X_{2}=S)=\\frac{1}{4}\\cdot\\frac{1}{4}=\\frac{1}{16}.\n$$\n在该事件中，$T_{S}=2$，故\n$$\nP_{return}=\\mathbb{P}(T_{S}\\infty)\\geq \\frac{1}{16}0.\n$$\n\n为证明 $P_{return}1$，考虑事件 $A=\\{X_{1}=(0,0)\\}$。由于 $(0,0)$ 是吸收态，若事件 $A$ 发生，则游走永远无法返回到 $S$，所以 $A \\subseteq \\{T_{S}=\\infty\\}$。因此，\n$$\n\\mathbb{P}(T_{S}=\\infty)\\geq \\mathbb{P}(A)=\\frac{1}{4},\n$$\n这意味着\n$$\nP_{return}=\\mathbb{P}(T_{S}\\infty)\\leq 1-\\frac{1}{4}=\\frac{3}{4}1.\n$$\n\n综合以上两点，我们有 $0P_{return}1$，故正确的陈述是 $P_{return}1$。该概率是良定义的，并不因格点无限而无定义，所以选项D不正确。又因存在一条返回路径，该概率不为零，所以选项C也不正确。", "answer": "$$\\boxed{B}$$", "id": "1347255"}]}