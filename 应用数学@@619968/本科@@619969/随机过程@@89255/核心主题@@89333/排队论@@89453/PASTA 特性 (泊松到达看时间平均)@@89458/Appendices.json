{"hands_on_practices": [{"introduction": "这个实践问题将您置于管理一个小型云服务的情境中，这是排队论中的一个经典场景。核心挑战是确定一个新用户请求到达时，发现系统完全空闲的概率是多少。此问题 [@problem_id:1323294] 的精妙之处在于它直接应用了 PASTA 性质。该性质优雅地将到达实体的视角与系统的长期平均状态联系起来，从而将一个看似复杂的“到达时刻”问题，转化为一个更直接的稳态概率计算。", "problem": "一个小型云服务在一个包含两台相同并行服务器的集群上托管一个应用程序。用户请求被引导至此集群，这些请求的到达可以建模为一个泊松过程，平均速率为 $\\lambda = 120$ 请求/小时。如果有一台服务器空闲，则新到达的请求会立即分配给它。如果两台服务器都繁忙，则请求加入一个单一队列等待下一台可用的服务器。任意服务器上单个请求的服务时间呈指数分布，平均服务时间为 $1/\\mu$，其中 $\\mu = 75$ 请求/小时。该系统已运行足够长的时间以达到稳态。\n\n一个新到达的请求发现两台服务器都空闲的概率是多少？将你的答案表示为保留三位有效数字的小数。", "solution": "将此系统建模为一个 $M/M/2$ 排队系统，其到达率为 $\\lambda$，每个服务器的服务率为 $\\mu$。根据PASTA（泊松到达看到时间平均）原理，一个到达的请求发现两台服务器都空闲的概率等于系统中没有请求的稳态概率，记为 $p_{0}$。\n\n对于一个 $M/M/c$ 系统，当 $c=2$ 时，定义到达强度 $a=\\lambda/\\mu$ 和每个服务器的利用率 $\\rho=\\lambda/(c\\mu)=a/c$。系统为空的稳态概率为\n$$\np_{0}=\\left[\\sum_{n=0}^{c-1}\\frac{a^{n}}{n!}+\\frac{a^{c}}{c!\\,(1-\\rho)}\\right]^{-1}.\n$$\n当 $c=2$ 时，该公式变为\n$$\np_{0}=\\left[1+a+\\frac{a^{2}}{2\\,(1-\\rho)}\\right]^{-1}.\n$$\n代入 $\\lambda=120$ 和 $\\mu=75$，则 $a=\\lambda/\\mu=120/75=1.6$ 且 $\\rho=a/2=0.8$。那么 $1-\\rho=0.2$，并且\n$$\np_{0}=\\left[1+1.6+\\frac{(1.6)^{2}}{2\\cdot 0.2}\\right]^{-1}\n=\\left[1+1.6+\\frac{2.56}{0.4}\\right]^{-1}\n=\\left[1+1.6+6.4\\right]^{-1}\n=\\frac{1}{9}.\n$$\n表示为保留三位有效数字的小数，结果是 $0.111$。", "answer": "$$\\boxed{0.111}$$", "id": "1323294"}, {"introduction": "这个练习超越了简单的泊松到达，探讨了一个更现实的场景：一个具有有限“顾客”来源的系统。在这里，我们分析一个机器人车队，其故障（即“到达”）率会随着越来越多机器人停止运行而自然下降。这个问题 [@problem_id:1323275] 对于理解 PASTA 性质的局限性至关重要，它清晰地展示了当到达率依赖于系统状态时为何该性质不再适用，并促使我们进行更基本的分析来区分时间平均和到达平均。", "problem": "一家机器人公司为一个物流仓库运营着一支由 $N=4$ 台相同的自动送货漫游车组成的车队。这些漫游车独立运行。当一台漫游车处于可运行状态时，其发生故障前的时间服从指数分布，故障率为每天 $\\lambda = 0.1$ 次。该公司雇佣了一名单一的、技术娴熟的技术员，可以修理任何损坏的漫游车。技术员完成一次维修所需的时间也服从指数分布，维修率为每天 $\\mu = 0.5$ 次。如果一台漫游车发生故障时技术员正忙，该漫游车将进入一个队列等待维修。\n\n我们对该系统的两个关键性能指标感兴趣。\n1.  令 $L$ 为长期时间平均下处于非运行状态的漫游车数量（这包括正在被维修和在队列中等待维修的漫游车）。\n2.  令 $L_a$ 为一台漫游车在它发生故障的瞬间，观察到的已经处于非运行状态的*其他*漫游车的长期平均数量。\n\n计算差值 $\\Delta L = L - L_a$。将您的最终答案四舍五入到三位有效数字。", "solution": "该系统可以被建模为一个连续时间马尔可夫链，具体来说是一个生灭过程，其中系统的状态 $k$ 是非运行状态的漫游车数量。状态空间为 $\\{0, 1, 2, 3, 4\\}$。\n\n生率（漫游车发生故障的速率）取决于可运行的漫游车数量。如果有 $k$ 台非运行状态的漫游车，那么就有 $N-k$ 台可运行的漫游车，每台都可能以速率 $\\lambda$ 发生故障。因此，从状态 $k$ 到 $k+1$ 的总生率为 $\\lambda_k = (N-k)\\lambda$，其中 $k \\in \\{0, 1, 2, 3\\}$。从状态 $4$ 开始的生率为 $\\lambda_4 = 0$，因为没有可运行的漫游车可以再发生故障了。\n\n亡率（维修的速率）在至少有一台漫游车需要维修时是恒定的，因为只有一名技术员。从状态 $k$ 到 $k-1$ 的亡率为 $\\mu_k = \\mu$，其中 $k \\in \\{1, 2, 3, 4\\}$。从状态 $0$ 开始的亡率为 $\\mu_0 = 0$。\n\n令 $\\pi_k$ 为系统处于状态 $k$ 的稳态概率。对于生灭过程，稳态概率满足细致平衡方程，从而得到以下关系：\n$$ \\pi_k = \\pi_0 \\prod_{i=0}^{k-1} \\frac{\\lambda_i}{\\mu_{i+1}} $$\n代入该模型的速率：\n$$ \\pi_k = \\pi_0 \\prod_{i=0}^{k-1} \\frac{(N-i)\\lambda}{\\mu} = \\pi_0 \\left(\\frac{\\lambda}{\\mu}\\right)^k \\prod_{i=0}^{k-1} (N-i) = \\pi_0 \\frac{N!}{(N-k)!} \\left(\\frac{\\lambda}{\\mu}\\right)^k $$\n令 $\\rho = \\lambda/\\mu = 0.1/0.5 = 0.2$。当 $N=4$ 时，我们可以用 $\\pi_0$ 来表示每个 $\\pi_k$。我们定义 $c_k = \\frac{N!}{(N-k)!} \\rho^k$，因此 $\\pi_k = \\pi_0 c_k$。\n$c_0 = \\frac{4!}{4!} (0.2)^0 = 1$\n$c_1 = \\frac{4!}{3!} (0.2)^1 = 4 \\times 0.2 = 0.8$\n$c_2 = \\frac{4!}{2!} (0.2)^2 = 12 \\times 0.04 = 0.48$\n$c_3 = \\frac{4!}{1!} (0.2)^3 = 24 \\times 0.008 = 0.192$\n$c_4 = \\frac{4!}{0!} (0.2)^4 = 24 \\times 0.0016 = 0.0384$\n\n这些系数的总和为 $S = \\sum_{k=0}^{4} c_k = 1 + 0.8 + 0.48 + 0.192 + 0.0384 = 2.5104$。\n根据归一化条件 $\\sum_{k=0}^{4} \\pi_k = 1$，我们有 $\\pi_0 S = 1$，所以 $\\pi_0 = 1/S = 1/2.5104$。稳态概率为 $\\pi_k = c_k / S$。\n$\\pi_0 = 1 / 2.5104 \\approx 0.398343$\n$\\pi_1 = 0.8 / 2.5104 \\approx 0.318674$\n$\\pi_2 = 0.48 / 2.5104 \\approx 0.191205$\n$\\pi_3 = 0.192 / 2.5104 \\approx 0.076482$\n$\\pi_4 = 0.0384 / 2.5104 \\approx 0.015296$\n\n非运行状态漫游车的时间平均数量 $L$ 是稳态下系统中漫游车数量的期望值：\n$$ L = E[K] = \\sum_{k=0}^{N} k \\pi_k = \\frac{1}{S} \\sum_{k=0}^{4} k c_k $$\n$$ L = \\frac{1}{2.5104} [ (0)(1) + (1)(0.8) + (2)(0.48) + (3)(0.192) + (4)(0.0384) ] $$\n$$ L = \\frac{1}{2.5104} [ 0.8 + 0.96 + 0.576 + 0.1536 ] = \\frac{2.4896}{2.5104} \\approx 0.991714 $$\n\n接下来，我们计算 $L_a$。损坏漫游车的到达过程不是泊松过程，因为故障率 $\\lambda_k = (N-k)\\lambda$ 取决于当前状态 $k$。因此，一个到达的漫游车发现系统处于状态 $k$ 的概率（记为 $a_k$）不等于 $\\pi_k$。到达时概率等于时间平均概率的特性，即PASTA（Poisson Arrivals See Time Averages，泊松到达看到时间平均），在此处不适用。\n到达时概率 $a_k$ 由进入状态 $k$ 的到达流率与总平均到达率 $\\bar{\\lambda}$ 的比值给出：\n$$ a_k = \\frac{\\text{flow rate into state } k+1 \\text{ from } k}{\\text{total flow rate of arrivals}} = \\frac{\\pi_k \\lambda_k}{\\bar{\\lambda}} $$\n总平均到达率为 $\\bar{\\lambda} = \\sum_{j=0}^{N-1} \\pi_j \\lambda_j = \\sum_{j=0}^{3} \\pi_j (N-j)\\lambda$。\n$$ \\bar{\\lambda} = \\frac{\\lambda}{S} \\sum_{j=0}^{3} c_j (N-j) = \\frac{0.1}{2.5104} [ (1)(4) + (0.8)(3) + (0.48)(2) + (0.192)(1) ] $$\n$$ \\bar{\\lambda} = \\frac{0.1}{2.5104} [ 4 + 2.4 + 0.96 + 0.192 ] = \\frac{0.1 \\times 7.552}{2.5104} = \\frac{0.7552}{2.5104} \\approx 0.300829 $$\n现在我们可以计算 $k=0,1,2,3$ 时对应的 $a_k$。请注意，只有当 $k<4$ 时才会发生到达事件。\n$a_0 = \\frac{\\pi_0 \\lambda_0}{\\bar{\\lambda}} = \\frac{(1/S)(4\\lambda)}{\\bar{\\lambda}} = \\frac{4\\lambda/S}{7.552\\lambda/S} = \\frac{4}{7.552} \\approx 0.529661$\n$a_1 = \\frac{\\pi_1 \\lambda_1}{\\bar{\\lambda}} = \\frac{(0.8/S)(3\\lambda)}{\\bar{\\lambda}} = \\frac{2.4\\lambda/S}{7.552\\lambda/S} = \\frac{2.4}{7.552} \\approx 0.317797$\n$a_2 = \\frac{\\pi_2 \\lambda_2}{\\bar{\\lambda}} = \\frac{(0.48/S)(2\\lambda)}{\\bar{\\lambda}} = \\frac{0.96\\lambda/S}{7.552\\lambda/S} = \\frac{0.96}{7.552} \\approx 0.127119$\n$a_3 = \\frac{\\pi_3 \\lambda_3}{\\bar{\\lambda}} = \\frac{(0.192/S)(1\\lambda)}{\\bar{\\lambda}} = \\frac{0.192\\lambda/S}{7.552\\lambda/S} = \\frac{0.192}{7.552} \\approx 0.025424$\n\n量 $L_a$ 是指一台漫游车发生故障时，处于非运行状态的*其他*漫游车的平均数量。如果一个到达的漫游车发现系统处于状态 $k$，它会看到已有 $k$ 台其他漫游车处于非运行状态。\n$$ L_a = \\sum_{k=0}^{N-1} k \\cdot a_k = (0)a_0 + (1)a_1 + (2)a_2 + (3)a_3 $$\n$$ L_a = 0 + \\frac{2.4}{7.552} + 2\\left(\\frac{0.96}{7.552}\\right) + 3\\left(\\frac{0.192}{7.552}\\right) = \\frac{2.4 + 1.92 + 0.576}{7.552} $$\n$$ L_a = \\frac{4.896}{7.552} \\approx 0.648239 $$\n\n最后，我们计算差值 $\\Delta L = L - L_a$：\n$$ \\Delta L = 0.991714 - 0.648239 = 0.343475 $$\n四舍五入到三位有效数字，我们得到 $0.343$。", "answer": "$$\\boxed{0.343}$$", "id": "1323275"}, {"introduction": "这个高级问题深入探讨了具有批量到达的系统中的细微差别，这在电信和数据处理中是一种常见的模式。虽然“批次”的到达遵循泊松过程，但批次内单个顾客的体验却有所不同，因为任意一个顾客更有可能来自一个较大的批次。这个练习 [@problem_id:1323268] 挑战您区分“批次层面”和“顾客层面”的视角，揭示了与检查悖论相关的有趣现象，并加深您对“一次到达”究竟看到了什么的理解。", "problem": "考虑一个单服务台排队系统，记为 $M^{[X]}/G/1$ 排队。顾客成批到达，其到达过程为一个速率为 $\\lambda$ 的泊松过程。一个到达批次中的顾客数量 $X$ 是一个正整数值随机变量，即 $P(X \\ge 1) = 1$。设批大小的一阶矩和二阶矩分别为 $m_1 = E[X]$ 和 $m_2 = E[X^2]$。单个顾客的服务时间是独立同分布的，服从一个具有有限均值的一般分布，并且与到达过程和批大小无关。假设流量强度小于1，以确保系统稳定。到达时，同一批次的顾客被随机分配服务顺序，批次中顾客的每种排列都是等可能的。\n\n我们有兴趣从两个不同的角度比较系统状态：\n\n1.  到达*批次*的视角。令 $A$ 为一个新批次到达瞬间，系统中已存在（排队或正在服务）的顾客的长期平均数。\n2.  任意单个*顾客*的视角。令 $B$ 为该顾客发现排在其前面的顾客的长期平均数。这个数量既包括其所在批次到达时系统中已有的顾客，也包括其同批次中被安排先于其服务的任何其他顾客。\n\n确定差值 $B-A$ 的值。用 $m_1$ 和 $m_2$ 以闭式表达式表示你的答案。", "solution": "令 $N^{-}$ 表示一批次到达前瞬间系统中的顾客数。根据定义，在批次到达的 Palm 测度下，批次平均的到达时所见数量为 $A=E[N^{-}]$。\n\n考虑从长期的顾客流中均匀抽样的一个任意顾客。令 $X$ 为该顾客所在批次的大小。该顾客发现排在其前面的顾客数是两个独立部分的总和：\n(i) 其所在批次到达时系统中已存在的顾客数 $N^{-}$，以及\n(ii) 由于批内随机排列，排在其前面的同批次伙伴的数量。\n\n因为批大小是独立同分布的，并且与到达时刻和服务过程无关，所以到达批的标记 $X$ 与 $N^{-}$ 无关。在顾客抽样下，到达时刻按批次大小加权。因此，在顾客视角下，已存在部分的期望值为\n$$\nE[N^{-}]_{\\text{customer}}=\\frac{E[X N^{-}]}{E[X]}=\\frac{E[X]\\,E[N^{-}]}{E[X]}=E[N^{-}]=A.\n$$\n\n对于批内贡献，以批大小 $k$ 为条件。在 $k$ 个顾客的均匀随机排列下，标记顾客的位置在 $\\{1,\\dots,k\\}$ 上是均匀分布的，因此排在其前面的同批次伙伴的期望数量等于\n$$\nE[\\text{batch-mates ahead}\\mid X=k]=\\frac{k-1}{2}.\n$$\n在顾客视角下，批大小是规模偏倚的 (size-biased)：$P(X^{\\star}=k)=\\frac{k P(X=k)}{m_{1}}$，所以 $E[X^{\\star}]=\\frac{m_{2}}{m_{1}}$。因此，批内贡献的期望值为\n$$\nE\\left[\\frac{X^{\\star}-1}{2}\\right]=\\frac{E[X^{\\star}]-1}{2}=\\frac{\\frac{m_{2}}{m_{1}}-1}{2}.\n$$\n\n结合这两个部分，顾客平均的前方顾客数为\n$$\nB=A+\\frac{\\frac{m_{2}}{m_{1}}-1}{2}.\n$$\n因此，\n$$\nB-A=\\frac{\\frac{m_{2}}{m_{1}}-1}{2}.\n$$", "answer": "$$\\boxed{\\frac{1}{2}\\left(\\frac{m_{2}}{m_{1}}-1\\right)}$$", "id": "1323268"}]}