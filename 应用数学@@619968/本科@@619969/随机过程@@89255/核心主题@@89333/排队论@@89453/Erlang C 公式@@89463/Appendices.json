{"hands_on_practices": [{"introduction": "让我们从一个典型场景开始：估算一个共享资源系统（如大学的渲染农场）中用户需要等待的概率。这个练习将帮助你熟练掌握应用爱尔朗C公式计算延迟概率的核心技能，这是理解和分析任何排队系统的第一步。通过这个实践，你将学会如何将现实世界的问题参数转化为模型输入，并计算出关键的性能指标。[@problem_id:1299667]", "problem": "一所大学的数字媒体实验室为动画和视觉效果课程的学生运营着一个渲染农场。该农场由5个相同的高性能计算节点组成。渲染作业请求被提交到一个中央系统。假设作业提交遵循泊松过程，平均到达率为每小时12个作业。一个节点完成单个渲染作业所需的时间呈指数分布，平均处理时间为20分钟。如果一个作业被提交时所有5个节点都已繁忙，该作业将被放入一个队列中，并将在有节点可用时按先到先服务的原则进行处理。队列可以容纳非常大量的等待作业。\n\n计算一个新提交的渲染作业在开始处理前必须在队列中等待的概率。将您的最终答案四舍五入到四位有效数字。", "solution": "这个场景描述了一个经典的多服务台排队系统。问题要求计算一个到达的作业发现所有服务台都繁忙，因而必须在队列中等待的概率。到达过程是泊松过程，服务时间是指数分布，这对应于一个M/M/c排队模型。在这种情况下，排队概率由爱尔朗C公式给出。\n\n首先，让我们根据问题陈述来定义系统的参数。\n服务台数量（计算节点数）为 $c = 5$。\n作业的平均到达率为 $\\lambda = 12$ 个作业/小时。\n一个作业的平均服务时间是20分钟。我们必须将其转换为小时，以与$\\lambda$的单位保持一致。\n平均服务时间 = $20 \\text{ minutes} \\times \\frac{1 \\text{ hour}}{60 \\text{ minutes}} = \\frac{1}{3}$ 小时。\n每个服务台的服务率 $\\mu$ 是平均服务时间的倒数：\n$$ \\mu = \\frac{1}{1/3 \\text{ hours/job}} = 3 \\text{ jobs/hour} $$\n业务负载（或称话务强度）$A$ 是一个无量纲的量，定义为总到达率与单个服务台服务率之比。\n$$ A = \\frac{\\lambda}{\\mu} = \\frac{12 \\text{ jobs/hour}}{3 \\text{ jobs/hour}} = 4 $$\n量 $A$ 通常以爱尔朗（Erlangs）为单位。对于一个稳定队列（队列中的作业数量不会无限增长），利用率 $\\rho = A/c$ 必须小于1。\n$$ \\rho = \\frac{A}{c} = \\frac{4}{5} = 0.8 $$\n由于 $\\rho = 0.8 < 1$，系统是稳定的。\n\n一个到达的作业需要排队等待的概率 $P_{\\text{queue}}$ 由爱尔朗C公式给出，记作 $C(c, A)$：\n$$ P_{\\text{queue}} = C(c, A) = \\frac{\\frac{A^c}{c!} \\frac{c}{c-A}}{\\sum_{k=0}^{c-1} \\frac{A^k}{k!} + \\frac{A^c}{c!} \\frac{c}{c-A}} $$\n一个更便于计算的形式是：\n$$ C(c, A) = \\frac{\\frac{A^c}{c!(1 - \\rho)}}{\\sum_{k=0}^{c-1} \\frac{A^k}{k!} + \\frac{A^c}{c!(1 - \\rho)}} $$\n让我们用 $c=5$ 和 $A=4$ 来计算这个公式的两个主要组成部分。\n\n首先，是出现在分子和分母中的项：\n$$ \\frac{A^c}{c!(1 - \\rho)} = \\frac{4^5}{5!(1 - 0.8)} = \\frac{1024}{120 \\times 0.2} = \\frac{1024}{24} = \\frac{128}{3} \\approx 42.6667 $$\n接下来，是分母中的求和项：\n$$ \\sum_{k=0}^{c-1} \\frac{A^k}{k!} = \\sum_{k=0}^{4} \\frac{4^k}{k!} = \\frac{4^0}{0!} + \\frac{4^1}{1!} + \\frac{4^2}{2!} + \\frac{4^3}{3!} + \\frac{4^4}{4!} $$\n计算每一项：\n$$ \\frac{4^0}{0!} = \\frac{1}{1} = 1 $$\n$$ \\frac{4^1}{1!} = \\frac{4}{1} = 4 $$\n$$ \\frac{4^2}{2!} = \\frac{16}{2} = 8 $$\n$$ \\frac{4^3}{3!} = \\frac{64}{6} = \\frac{32}{3} \\approx 10.6667 $$\n$$ \\frac{4^4}{4!} = \\frac{256}{24} = \\frac{32}{3} \\approx 10.6667 $$\n将这些值相加：\n$$ \\sum_{k=0}^{4} \\frac{4^k}{k!} = 1 + 4 + 8 + \\frac{32}{3} + \\frac{32}{3} = 13 + \\frac{64}{3} = \\frac{39+64}{3} = \\frac{103}{3} \\approx 34.3333 $$\n现在我们可以将这些结果代回到爱尔朗C公式中：\n$$ C(5, 4) = \\frac{\\frac{128}{3}}{\\frac{103}{3} + \\frac{128}{3}} = \\frac{\\frac{128}{3}}{\\frac{103 + 128}{3}} = \\frac{128}{231} $$\n最后，我们计算其数值并将结果四舍五入到四位有效数字：\n$$ P_{\\text{queue}} = \\frac{128}{231} \\approx 0.5541125541... $$\n四舍五入到四位有效数字得到 0.5541。", "answer": "$$\\boxed{0.5541}$$", "id": "1299667"}, {"introduction": "掌握了如何计算等待概率后，我们可以更进一步，将其应用于系统设计。这个练习模拟了一个常见的商业决策场景：确定需要多少服务人员（例如客服中心坐席）才能满足特定的服务质量目标。这个问题将挑战你反向运用爱尔朗C公式，从期望的服务水平出发，推导出系统所需的最小容量，这在资源规划和成本效益分析中至关重要。[@problem_id:1334592]", "problem": "一家名为 Innovate Solutions 的软件公司正在建立一个新的呼叫中心，为其主要产品提供技术支持。根据市场分析，客户来电预计遵循泊松过程，平均到达率为每小时40个。公司计划招聘一组技术娴熟的坐席。每位坐席处理单个客户电话所需的时间服从指数分布，平均时长为6分钟。假设所有坐席的绩效相同。\n\n该系统可以建模为M/M/c排队模型，其中到达过程是马尔可夫的（泊松分布），服务时间是马尔可夫的（指数分布），并且有 `c` 个并行的相同服务台（即坐席）。来电按照其到达顺序被处理。如果所有坐席都忙，新的来电者将被放入一个单一队列中等待。\n\nInnovate Solutions 的管理层设定了一个服务水平目标：新来电者在接通坐席前必须等待的稳态概率必须严格小于 5%。\n\n公司需要雇佣的最小整数坐席数量 $c$ 是多少，才能满足这个服务水平目标？", "solution": "到达遵循泊松过程，到达率 $\\lambda=40$ 个/小时。每个坐席的服务时间服从指数分布，均值为 $6$ 分钟。换算成小时， $6$ 分钟 $=\\frac{6}{60}=\\frac{1}{10}$ 小时，因此单个坐席的服务率为\n$$\n\\mu=\\frac{1}{\\frac{1}{10}}=10 \\text{ per hour}.\n$$\n提供的负载（爱尔朗）为\n$$\nA=\\frac{\\lambda}{\\mu}=\\frac{40}{10}=4.\n$$\n对于一个 $\\text{M/M/c}$ 排队模型，系统达到稳定的条件是 $\\rho=\\frac{\\lambda}{c\\mu}=\\frac{A}{c}<1$，因此 $c>A$，所以 $c\\geq 5$。\n\n一个到达的顾客必须等待（所有服务台都忙）的稳态概率由爱尔朗C公式给出：\n$$\nP_{\\text{wait}}(c)=\\frac{\\frac{A^{c}}{c!}\\frac{c}{c-A}}{\\sum_{n=0}^{c-1}\\frac{A^{n}}{n!}+\\frac{A^{c}}{c!}\\frac{c}{c-A}}.\n$$\n当 $A=4$ 时，计算 $c=5,6,7,8,9$ 时的 $P_{\\text{wait}}(c)$ 并与 $0.05$ 比较。\n\n对于 $c=5$:\n$$\n\\sum_{n=0}^{4}\\frac{4^{n}}{n!}=1+4+8+\\frac{64}{6}+\\frac{256}{24}=13+\\frac{64}{3}=\\frac{103}{3},\n$$\n$$\n\\frac{4^{5}}{5!}\\frac{5}{5-4}=\\frac{1024}{120}\\cdot 5=\\frac{128}{3}.\n$$\n因此分母是 $\\frac{103}{3}+\\frac{128}{3}=77$，并且\n$$\nP_{\\text{wait}}(5)=\\frac{\\frac{128}{3}}{77}=\\frac{128}{231}>0.05.\n$$\n\n对于 $c=6$:\n$$\n\\sum_{n=0}^{5}\\frac{4^{n}}{n!}=\\frac{103}{3}+\\frac{1024}{120}=\\frac{643}{15},\\quad \\frac{4^{6}}{6!}\\frac{6}{6-4}=\\frac{4096}{720}\\cdot 3=\\frac{256}{15},\n$$\n所以\n$$\nP_{\\text{wait}}(6)=\\frac{\\frac{256}{15}}{\\frac{643}{15}+\\frac{256}{15}}=\\frac{256}{899}>0.05.\n$$\n\n对于 $c=7$:\n$$\n\\sum_{n=0}^{6}\\frac{4^{n}}{n!}=\\frac{643}{15}+\\frac{4096}{720}=\\frac{2185}{45},\\quad \\frac{4^{7}}{7!}\\frac{7}{7-4}=\\frac{16384}{5040}\\cdot \\frac{7}{3}=\\frac{1024}{135},\n$$\n所以\n$$\nP_{\\text{wait}}(7)=\\frac{\\frac{1024}{135}}{\\frac{2185}{45}+\\frac{1024}{135}}=\\frac{1024}{7579}>0.05.\n$$\n\n对于 $c=8$:\n$$\n\\sum_{n=0}^{7}\\frac{4^{n}}{n!}=\\frac{2185}{45}+\\frac{16384}{5040}=\\frac{16319}{315},\\quad \\frac{4^{8}}{8!}\\frac{8}{8-4}=\\frac{65536}{40320}\\cdot 2=\\frac{1024}{315},\n$$\n所以\n$$\nP_{\\text{wait}}(8)=\\frac{\\frac{1024}{315}}{\\frac{16319}{315}+\\frac{1024}{315}}=\\frac{1024}{17343}.\n$$\n为了与 $0.05=\\frac{1}{20}$ 比较，注意到\n$$\n\\frac{1024}{17343}>\\frac{1}{20}\\quad \\text{since}\\quad 1024\\cdot 20=20480>17343,\n$$\n因此 $P_{\\text{wait}}(8)>0.05$。\n\n对于 $c=9$:\n$$\n\\sum_{n=0}^{8}\\frac{4^{n}}{n!}=\\frac{16319}{315}+\\frac{65536}{40320}=\\frac{16831}{315},\\quad \\frac{4^{9}}{9!}\\frac{9}{9-4}=\\frac{262144}{362880}\\cdot \\frac{9}{5}=\\frac{2048}{1575},\n$$\n所以\n$$\nP_{\\text{wait}}(9)=\\frac{\\frac{2048}{1575}}{\\frac{16831}{315}+\\frac{2048}{1575}}=\\frac{2048}{86203}.\n$$\n与 $0.05=\\frac{1}{20}$ 比较：\n$$\n\\frac{2048}{86203}<\\frac{1}{20}\\quad \\text{since}\\quad 2048\\cdot 20=40960<86203.\n$$\n因此 $P_{\\text{wait}}(9)<0.05$，而 $c=8$ 不满足目标。故最小整数 $c$ 为 $9$。", "answer": "$$\\boxed{9}$$", "id": "1334592"}, {"introduction": "在现实世界中，我们可能无法直接测量系统的所有参数，但可以观察其运行结果。这个高级练习将向你展示如何利用有限的观测数据——比如知道有多少顾客需要等待——来反向推断系统的潜在工作负载 $A$。通过解决这个问题，你将学习到一种从经验数据估计模型参数的强大方法，这连接了排队理论与实际的系统性能监控和分析。[@problem_id:1299669]", "problem": "一家小型云原生公司运营一个客户支持聊天系统，该系统配备了两名技术人员。系统的设计是，当有可用的技术人员时，传入的支持请求会被分配给技术人员；否则，该请求将被放入一个单一队列中，由下一个可用的技术人员处理。对历史数据的分析表明，请求的到达遵循泊松过程，技术人员解决一个请求所需的时间呈指数分布。因此，该系统可以被精确地建模为一个 M/M/2 排队系统。\n\n为进行容量规划，该公司希望估计所提供的业务负载。然而，监控系统只记录每个到达请求的二元结果：该请求是立即得到处理，还是必须在队列中等待。在一个具有代表性的一周内，总共收到了 $N=7,500$ 个请求。其中，有 $K=975$ 个请求在被分配给技术人员之前必须在队列中等待。\n\n假设系统处于稳定、稳态条件下，请计算所提供的业务负载 $A$（以爱尔朗 (Erlangs) 为单位）的点估计。将最终答案四舍五入至三位有效数字。", "solution": "到达过程是泊松过程，因此根据 PASTA 原理，观测到的需要等待的到达请求的比例等于稳态延迟概率，对于 M/M/2 排队，这就是爱尔朗C (Erlang C) 延迟概率。设 $A=\\lambda/\\mu$ 是所提供的业务负载（以爱尔朗为单位），并设 $p$ 表示一个到达的请求需要等待的概率。对于 $c=2$ 个服务台，爱尔朗C公式给出\n$$\np=\\frac{\\frac{A^{2}}{2!}\\frac{2}{2-A}}{\\sum_{n=0}^{1}\\frac{A^{n}}{n!}+\\frac{A^{2}}{2!}\\frac{2}{2-A}}\n=\\frac{\\frac{A^{2}}{2-A}}{1+A+\\frac{A^{2}}{2-A}}\n=\\frac{A^{2}}{(1+A)(2-A)+A^{2}}.\n$$\n由于 $(1+A)(2-A)+A^{2}=2+A-A^2+A^2=2+A$，此式可简化为\n$$\np=\\frac{A^{2}}{2+A}.\n$$\n将此式与经验比例 $p=\\frac{K}{N}$ 相等，可得\n$$\n\\frac{A^{2}}{2+A}=\\frac{K}{N}\\quad\\Longrightarrow\\quad A^{2}-\\frac{K}{N}A-2\\frac{K}{N}=0.\n$$\n求解关于 $A$ 的一元二次方程并取正根（稳定性要求 $A<2$），得到\n$$\nA=\\frac{\\frac{K}{N}+\\sqrt{\\left(\\frac{K}{N}\\right)^{2}+8\\frac{K}{N}}}{2}.\n$$\n当 $K=975$ 和 $N=7500$ 时，我们有 $\\frac{K}{N}=0.13$，所以\n$$\nA=\\frac{0.13+\\sqrt{0.13^{2}+8\\cdot 0.13}}{2}\n=\\frac{0.13+\\sqrt{1.0569}}{2}\\approx\\frac{0.13+1.0280565}{2}\\approx 0.579028.\n$$\n四舍五入到三位有效数字，点估计为 $0.579$ 爱尔朗 (Erlangs)。", "answer": "$$\\boxed{0.579}$$", "id": "1299669"}]}