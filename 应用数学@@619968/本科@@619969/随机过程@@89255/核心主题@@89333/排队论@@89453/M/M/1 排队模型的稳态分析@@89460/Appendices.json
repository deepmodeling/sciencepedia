{"hands_on_practices": [{"introduction": "理解任何排队系统的第一步是计算其基本性能指标。本练习提供了一个经典场景——一家咖啡店——来练习计算最重要的指标之一：顾客从到达直到离开，在系统中花费的平均总时间 $W$。通过解决这个问题 [@problem_id:1334433]，你将获得应用 M/M/1 平均逗留时间核心公式的实践经验，并确保你能够正确处理单位换算和检验系统稳定性。", "problem": "市中心一家热门咖啡店只有一名咖啡师负责点单和制作饮品。在一个典型的工作日上午，顾客的到达遵循泊松过程，平均速率为每小时45名顾客。咖啡师服务一名顾客（从点单到交付饮品）的时间服从指数分布，均值为70秒。假设系统在稳态下运行，并且有足够的等待空间容纳所有到达的顾客。\n\n计算顾客在咖啡店花费的平均总时间，即从他们到达的那一刻起，直到他们收到饮品并离开的那一刻为止。请用分钟作答，并四舍五入至三位有效数字。", "solution": "将该系统建模为稳态下的M/M/1排队模型，其到达率为 $\\lambda$，服务率为 $\\mu$。对于M/M/1排队模型，系统中的平均总时间（等待时间加服务时间）为\n$$\nW=\\frac{1}{\\mu-\\lambda},\n$$\n条件是 $\\lambda<\\mu$。\n\n到达率为每小时 $\\lambda=45$ 名顾客。服务时间服从均值为70秒的指数分布，因此每小时的服务率为\n$$\n\\mu=\\frac{1}{70\\ \\text{s}}\\times 3600\\ \\text{s/h}=\\frac{3600}{70}=\\frac{360}{7}\\ \\text{per hour}.\n$$\n检查稳定性：\n$$\n\\rho=\\frac{\\lambda}{\\mu}=\\frac{45}{360/7}=\\frac{315}{360}=0.875<1,\n$$\n因此稳态条件成立。\n\n计算 $W$：\n$$\n\\mu-\\lambda=\\frac{360}{7}-45=\\frac{360-315}{7}=\\frac{45}{7}\\ \\text{per hour},\n$$\n$$\nW=\\frac{1}{\\mu-\\lambda}=\\frac{1}{45/7}=\\frac{7}{45}\\ \\text{hours}.\n$$\n转换为分钟：\n$$\nW=\\frac{7}{45}\\times 60=\\frac{420}{45}=\\frac{28}{3}\\ \\text{minutes}\\approx 9.333\\ldots\\ \\text{minutes}.\n$$\n四舍五入到三位有效数字，结果为 $9.33$ 分钟。", "answer": "$$\\boxed{9.33}$$", "id": "1334433"}, {"introduction": "排队论不仅用于分析现有系统，它更是一个用于设计更优系统的强大工具。这个问题将视角从分析转向设计，要求你确定所需的服务能力，以满足特定的服务质量（QoS）保证。通过计算为确保平均队列等待时间 $W_q$ 低于某一阈值所需的最小服务率 $\\mu$ [@problem_id:1334404]，你将学会如何主动运用 M/M/1 模型来制定关键的运营决策。", "problem": "一家小型初创公司运营着一台单一的高性能计算服务器，用于处理其客户提交的数据分析作业。作业根据泊松过程到达服务器的处理队列，平均速率为每小时144个作业。处理单个作业所需的时间已知服从指数分布。该公司希望保证服务质量，确保作业在开始处理前在队列中等待的平均时间不超过45秒。\n\n为实现这一目标，公司需要配置服务器的处理能力。假设服务器连续运行且一次只处理一个作业，服务器必须维持的最低服务速率是多少（以作业/分钟为单位）？\n\n请以作业/分钟为单位给出答案，并四舍五入到三位有效数字。", "solution": "所描述的物理场景可以建模为M/M/1排队系统。“M”代表马尔可夫（或无记忆），表示到达间隔时间和服务时间都服从指数分布。“1”表示只有一个服务器。\n\n首先，我们需要为速率和时间建立一致的单位。问题给出了以作业/小时为单位的到达速率和以秒为单位的最大等待时间，但要求以作业/分钟为单位的最终服务速率。让我们将所有单位都转换为分钟。\n\n到达速率，用$\\lambda$表示，为每小时144个作业。\n$$ \\lambda = \\frac{144 \\text{ jobs}}{1 \\text{ hour}} \\times \\frac{1 \\text{ hour}}{60 \\text{ minutes}} = 2.4 \\text{ jobs/minute} $$\n\n允许的队列中最大平均等待时间，我们称之为$W_{q, \\text{max}}$，是45秒。\n$$ W_{q, \\text{max}} = 45 \\text{ seconds} \\times \\frac{1 \\text{ minute}}{60 \\text{ seconds}} = 0.75 \\text{ minutes} $$\n\n设$\\mu$为服务速率（单位为作业/分钟），这是我们需要求解的量。对于稳态的M/M/1队列，队列中的平均等待时间$W_q$由以下公式给出：\n$$ W_q = \\frac{\\lambda}{\\mu(\\mu - \\lambda)} $$\n该公式仅在系统稳定时有效，这要求服务速率大于到达速率，即$\\mu > \\lambda$。\n\n我们得到的条件是平均等待时间不能超过$W_{q, \\text{max}}$。这可以转化为不等式：\n$$ W_q \\le W_{q, \\text{max}} $$\n将$W_q$的公式代入：\n$$ \\frac{\\lambda}{\\mu(\\mu - \\lambda)} \\le W_{q, \\text{max}} $$\n\n现在，代入$\\lambda$和$W_{q, \\text{max}}$的数值：\n$$ \\frac{2.4}{\\mu(\\mu - 2.4)} \\le 0.75 $$\n\n为了解这个关于$\\mu$的不等式，我们首先考虑稳定性条件$\\mu > 2.4$。在这种情况下，$\\mu$和$(\\mu - 2.4)$都是正数，所以它们的乘积$\\mu(\\mu - 2.4)$也是正数。我们可以用这个乘积乘以不等式两边，而不用改变不等号的方向：\n$$ 2.4 \\le 0.75 \\mu (\\mu - 2.4) $$\n$$ 2.4 \\le 0.75 \\mu^2 - (0.75)(2.4) \\mu $$\n$$ 2.4 \\le 0.75 \\mu^2 - 1.8 \\mu $$\n\n为了简化，我们可以将整个不等式除以0.75（或乘以4/3）：\n$$ \\frac{2.4}{0.75} \\le \\mu^2 - \\frac{1.8}{0.75} \\mu $$\n$$ 3.2 \\le \\mu^2 - 2.4 \\mu $$\n\n将其整理成标准的二次不等式形式：\n$$ \\mu^2 - 2.4 \\mu - 3.2 \\ge 0 $$\n\n为了找出该不等式成立的条件，我们首先使用求根公式$\\mu = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$来求解相应的一元二次方程$\\mu^2 - 2.4 \\mu - 3.2 = 0$的根：\n$$ \\mu = \\frac{-(-2.4) \\pm \\sqrt{(-2.4)^2 - 4(1)(-3.2)}}{2(1)} $$\n$$ \\mu = \\frac{2.4 \\pm \\sqrt{5.76 + 12.8}}{2} $$\n$$ \\mu = \\frac{2.4 \\pm \\sqrt{18.56}}{2} $$\n\n现在，我们计算两个根：\n$$ \\mu_1 = \\frac{2.4 - \\sqrt{18.56}}{2} \\approx \\frac{2.4 - 4.3081}{2} \\approx -0.95405 $$\n$$ \\mu_2 = \\frac{2.4 + \\sqrt{18.56}}{2} \\approx \\frac{2.4 + 4.3081}{2} \\approx 3.35405 $$\n\n二次函数$f(\\mu) = \\mu^2 - 2.4 \\mu - 3.2$代表一个开口向上的抛物线。因此，当$\\mu \\le \\mu_1$或$\\mu \\ge \\mu_2$时，不等式$f(\\mu) \\ge 0$成立。\n所以，$\\mu \\le -0.95405$ 或 $\\mu \\ge 3.35405$。\n\n我们还必须满足队列的稳定性条件，即$\\mu > \\lambda = 2.4$。\n结合这两个条件：\n1.  $(\\mu \\le -0.95405 \\text{ 或 } \\mu \\ge 3.35405)$\n2.  $\\mu > 2.4$\n\n唯一同时满足这两个条件的区域是$\\mu \\ge 3.35405$。\n问题要求满足该要求的最低服务速率。这对应于$\\mu$有效范围的下界。\n因此，所需的最低服务速率是$\\mu_{\\text{min}} = 3.35405$ 作业/分钟。\n\n问题要求将最终答案四舍五入到三位有效数字。\n3.35405的前三位有效数字是3、3和5。下一位数字是4，小于5，所以我们向下舍入。\n最低服务速率是3.35 作业/分钟。", "answer": "$$\\boxed{3.35}$$", "id": "1334404"}, {"introduction": "平均性能指标虽然有用，但它们并不能完全描绘出系统的运行全貌，尤其是在需要设定服务水平协议（SLA）时。为了更深入地理解系统的波动性，我们需要考察其完整的概率分布。本练习将超越平均值的局限，引导你计算系统中任务数量的百分位数，这对于风险评估和资源规划至关重要 [@problem_id:1334418]。", "problem": "一所大学的数字制造实验室为学生项目运行着一台高需求的3D打印机。该实验室全年无休（24/7）开放，并且该系统可被视为处于稳态运行。打印任务的请求遵循泊松过程，平均到达率为每小时 $\\lambda = 0.5$ 个任务。完成任何给定打印任务所需的时间可以很好地用指数分布来近似，打印机平均每小时能完成 $\\mu = 0.8$ 个任务。\n\n实验室管理员希望为学生设定一个服务水平预期。为此，他们需要确定系统中打印任务总数的第95百分位数。这个数字包括当前正在打印的任务以及在队列中等待的任何任务。求此数值。请注意，任务数量必须是一个整数。", "solution": "这个问题可以被建模为一个 M/M/1 排队系统。其中的'M'表示到达间隔时间和和服务时间都服从指数分布（这等同于泊松到达）。'1'表示单个服务器，在本例中即为这台3D打印机。\n\n给定的参数是：\n- 到达率，$\\lambda = 0.5$ 个任务/小时。\n- 服务率，$\\mu = 0.8$ 个任务/小时。\n\n首先，我们计算系统的流量强度或利用率，$\\rho$。这个值代表了服务器处于忙碌状态的时间比例。\n$$\n\\rho = \\frac{\\lambda}{\\mu} = \\frac{0.5}{0.8} = \\frac{5}{8} = 0.625\n$$\n由于 $\\rho < 1$，队列是稳定的，并将达到稳态，正如问题中所述。\n\n在 M/M/1 队列的稳态下，系统中恰好有 $n$ 个任务（包括正在服务的任务）的概率由几何分布给出：\n$$\nP(N=n) = (1-\\rho)\\rho^n, \\quad \\text{for } n = 0, 1, 2, \\dots\n$$\n我们需要求解系统中任务数量的第95百分位数。设此值为 $k$。根据定义，第95百分位数是满足“系统中任务数量小于或等于 $k$ 的概率至少为0.95”的最小整数 $k$。用数学语言来说，我们需要找到满足以下不等式的最小整数 $k$：\n$$\nP(N \\le k) \\ge 0.95\n$$\n累积分布函数（CDF），$P(N \\le k)$，是从 $n=0$ 到 $n=k$ 的概率之和：\n$$\nP(N \\le k) = \\sum_{n=0}^{k} P(N=n) = \\sum_{n=0}^{k} (1-\\rho)\\rho^n\n$$\n这是一个有限几何级数。我们可以提出常数项 $(1-\\rho)$，并使用几何级数求和公式 $\\sum_{i=0}^{m} r^i = \\frac{1-r^{m+1}}{1-r}$：\n$$\nP(N \\le k) = (1-\\rho) \\sum_{n=0}^{k} \\rho^n = (1-\\rho) \\left( \\frac{1-\\rho^{k+1}}{1-\\rho} \\right) = 1 - \\rho^{k+1}\n$$\n现在，我们可以使用这个简化的CDF表达式来解关于 $k$ 的不等式：\n$$\n1 - \\rho^{k+1} \\ge 0.95\n$$\n整理不等式：\n$$\n0.05 \\ge \\rho^{k+1}\n$$\n或\n$$\n\\rho^{k+1} \\le 0.05\n$$\n为了求解 $k$，我们对两边取自然对数。\n$$\n\\ln(\\rho^{k+1}) \\le \\ln(0.05)\n$$\n$$\n(k+1)\\ln(\\rho) \\le \\ln(0.05)\n$$\n现在我们代入 $\\rho = 0.625$ 的值。一个介于0和1之间的数的自然对数是负数。具体来说，$\\ln(0.625) < 0$。因此，当我们除以 $\\ln(\\rho)$ 时，必须反转不等号的方向：\n$$\nk+1 \\ge \\frac{\\ln(0.05)}{\\ln(0.625)}\n$$\n现在我们计算数值：\n$$\nk+1 \\ge \\frac{-2.99573227}{-0.47000362} \\approx 6.37384\n$$\n两边同时减1：\n$$\nk \\ge 6.37384 - 1\n$$\n$$\nk \\ge 5.37384\n$$\n由于任务数 $k$ 必须是整数，满足此不等式的最小整数 $k$ 是 $6$。\n\n因此，系统中任务总数的第95百分位数是6。这意味着在95%的时间里，到达的学生会发现系统中总共有6个或更少的任务（正在打印或等待中）。", "answer": "$$\\boxed{6}$$", "id": "1334418"}]}