{"hands_on_practices": [{"introduction": "期望值是概率论的基石概念，它简洁地概括了随机变量的中心趋势。第一个练习 [@problem_id:12870] 提供了一个直接但至关重要的实践：利用已知的为达到特定成功次数所需的期望试验次数，反向计算出潜在的成功概率 $p$。这项技能对于验证模型和理解负二项分布过程的基本机制至关重要。", "problem": "考虑一个独立伯努利试验序列，其中每次试验的结果可分为“成功”或“失败”。设任意一次试验成功的概率为 $p$，其中 $0 < p \\leq 1$。\n\n如果随机变量 $X$ 表示为取得固定次数（记为 $r$）的成功所需要的总试验次数，则称 $X$ 服从负二项分布。该随机变量 $X$ 的期望值（或均值），表示为观测到恰好 $r$ 次成功所期望进行的平均试验次数，由以下公式给出：\n$$\nE[X] = \\frac{r}{p}\n$$\n假设一个试验被设计为一直进行，直到观测到 $r=3$ 次成功为止。通过理论分析或先验观察，确定了完成此试验所需的期望试验次数为 $15$。\n\n使用给定的期望值公式，推导出单次试验的成功概率 $p$。", "solution": "目标是在已知期望试验次数和所需成功次数的条件下，确定成功概率 $p$。\n\n**1. 确定已知信息：**\n题目提供了以下数值：\n- 所需的成功次数，$r = 3$。\n- 为实现这些成功所需的期望试验次数，$E[X] = 15$。\n\n**2. 写出相关公式：**\n期望试验次数 $E[X]$、成功次数 $r$ 和成功概率 $p$ 之间的关系由负二项分布的均值公式给出：\n$$\nE[X] = \\frac{r}{p}\n$$\n\n**3. 将已知数值代入公式：**\n我们将 $E[X] = 15$ 和 $r = 3$ 代入方程：\n$$\n15 = \\frac{3}{p}\n$$\n\n**4. 求解未知变量 $p$：**\n为了解出 $p$，我们可以先在方程两边同乘以 $p$：\n$$\n15 \\cdot p = 3\n$$\n接着，两边同除以 $15$ 以解出 $p$：\n$$\np = \\frac{3}{15}\n$$\n\n**5. 简化表达式：**\n该分数可以通过将分子和分母同时除以它们的最大公约数 3 来化简：\n$$\np = \\frac{3 \\div 3}{15 \\div 3} = \\frac{1}{5}\n$$\n因此，单次试验的成功概率为 $\\frac{1}{5}$。", "answer": "$$\\boxed{\\frac{1}{5}}$$", "id": "12870"}, {"introduction": "均值衡量了中心趋势，而方差则告诉我们一个过程的离散程度或波动性。在许多现实应用中，我们可以从数据中同时估算两者。这个练习 [@problem_id:1939495] 将带你更进一步，挑战你使用来自假设数据集的均值和方差，来同时求解负二项分布的两个参数：$r$ 和 $p$。这种被称为矩估计法（method of moments）的技术是将理论分布拟合到观测数据上的有力工具。", "problem": "一个数据科学家团队正在对一个新的社交媒体平台上的用户参与度进行建模。他们感兴趣的是，一个用户在达到一定数量的“成功”帖子之前所发布的帖子数量。“成功”帖子被定义为获得高度社区互动的帖子。\n\n该团队使用负二项分布来对此过程进行建模。令随机变量 $X$ 表示用户在达到 $r$ 个成功帖子的目标之前，所发布的“不成功”帖子的数量。任何给定帖子成功的概率为 $p$，且每次发帖都是一次独立的试验。\n\n从一个庞大的用户历史数据集中，该团队计算了不成功帖子数量的样本均值和方差。估计的均值为 $E[X] = 10$，估计的方差为 $Var(X) = 20$。\n\n基于这些经验估计，确定对此过程建模的负二项分布的参数：成功帖子的目标数量 $r$ 和单次帖子成功的概率 $p$。你的答案应为一个有序对 $(r, p)$。", "solution": "令 $X$ 表示在成功概率为 $p$ 的独立伯努利试验中，达到 $r$ 次成功之前的失败次数。在这种负二项分布的参数化中，$X$ 可以写成 $r$ 个独立的几何随机变量之和（每个变量计算一次成功之前的失败次数），每个变量的均值为 $(1-p)/p$，方差为 $(1-p)/p^{2}$。因此，\n$$\nE[X]=r\\frac{1-p}{p},\\qquad \\operatorname{Var}(X)=r\\frac{1-p}{p^{2}}.\n$$\n令 $\\mu=E[X]$ 且 $\\sigma^{2}=\\operatorname{Var}(X)$。那么\n$$\n\\frac{\\sigma^{2}}{\\mu}=\\frac{r(1-p)/p^{2}}{r(1-p)/p}=\\frac{1}{p}\\quad\\Longrightarrow\\quad p=\\frac{\\mu}{\\sigma^{2}}.\n$$\n接下来，从均值公式中求解 $r$：\n$$\n\\mu=r\\frac{1-p}{p}\\quad\\Longrightarrow\\quad r=\\frac{\\mu p}{1-p}.\n$$\n代入 $p=\\mu/\\sigma^{2}$：\n$$\nr=\\frac{\\mu\\left(\\frac{\\mu}{\\sigma^{2}}\\right)}{1-\\frac{\\mu}{\\sigma^{2}}}\n=\\frac{\\mu^{2}}{\\sigma^{2}-\\mu}.\n$$\n根据经验估计值 $\\mu=10$ 和 $\\sigma^{2}=20$，我们得到\n$$\np=\\frac{10}{20}=\\frac{1}{2},\\qquad r=\\frac{10^{2}}{20-10}=\\frac{100}{10}=10.\n$$\n因此，参数为 $(r,p)=(10,\\frac{1}{2})$。", "answer": "$$\\boxed{(10, \\frac{1}{2})}$$", "id": "1939495"}, {"introduction": "现在，我们将从使用汇总统计量，转向一种更强大、更普适的统计推断方法：最大似然估计（Maximum Likelihood Estimation, MLE）。这个练习 [@problem_id:1321150] 将你置于一个分析多组实验的研究人员的角色。你的任务是推导出成功概率 $p$ 的估计量，该估计量能最好地解释所有观测到的数据，为从实验结果中得出科学结论提供坚实的基础。", "problem": "一个网络安全研究团队正在评估一种新算法，用于检测网络流中的恶意数据包。该算法构成一个入侵检测系统（IDS）。在受控环境中，数据包被逐一发送到检测系统。每个数据包是恶意的并且被算法正确识别的概率是一个恒定且独立的概率 $p$，这种情况被定义为一次“成功”。如果一个数据包因任何原因（例如，它是良性的，或者它是一个被遗漏的恶意数据包）而未被计为一次成功，则被视为一次“失败”。\n\n为了测试该算法的性能，该团队进行了 $n$ 次独立实验。在每次实验 $i$ 中（对于 $i=1, \\dots, n$），团队记录在观察到恰好 $r$ 次成功之前发生的失败次数 $X_i$。$r$ 的值是一个预先确定的正整数，并且对于所有实验都相同。\n\n给定这 $n$ 次实验的观测数据 $x_1, x_2, \\dots, x_n$，求成功概率 $p$ 的最大似然估计量 $\\hat{p}$。将您的答案表示为关于 $r$、$n$ 和观测到的总失败次数 $S = \\sum_{i=1}^{n} x_i$ 的符号表达式。", "solution": "我们将每次实验建模如下。设 $X_i$ 表示在第 $i$ 次实验中，在第 $r$ 次成功之前发生的失败次数，每次试验的成功概率为恒定的 $p$，且各次试验和实验之间相互独立。那么 $X_i$ 服从负二项分布（计算在 $r$ 次成功之前的失败次数），其概率质量函数为\n$$\n\\Pr(X_{i}=x_{i}\\,|\\,p)=\\binom{x_{i}+r-1}{x_{i}}(1-p)^{x_{i}}p^{r},\\quad x_{i}=0,1,2,\\dots.\n$$\n给定 $n$ 次独立实验的观测值 $x_{1},\\dots,x_{n}$，似然函数为\n$$\nL(p)=\\prod_{i=1}^{n}\\binom{x_{i}+r-1}{x_{i}}(1-p)^{x_{i}}p^{r}.\n$$\n设 $S=\\sum_{i=1}^{n}x_{i}$。似然函数可以分解为\n$$\nL(p)=\\left[\\prod_{i=1}^{n}\\binom{x_{i}+r-1}{x_{i}}\\right](1-p)^{S}p^{nr}.\n$$\n由于二项式系数的乘积不依赖于 $p$，对数似然函数为\n$$\n\\ell(p)=\\ln L(p)=\\text{constant}+S\\ln(1-p)+nr\\ln p.\n$$\n对 $p$ 求导并令其为零，得到得分方程：\n$$\n\\frac{d\\ell}{dp}=\\frac{nr}{p}-\\frac{S}{1-p}=0.\n$$\n求解 $p$ 可得\n$$\n\\frac{nr}{p}=\\frac{S}{1-p}\\quad\\Longrightarrow\\quad nr(1-p)=Sp\\quad\\Longrightarrow\\quad nr= p(nr+S)\\quad\\Longrightarrow\\quad \\hat{p}=\\frac{nr}{nr+S}.\n$$\n为验证此临界点为最大值点，计算二阶导数：\n$$\n\\frac{d^{2}\\ell}{dp^{2}}=-\\frac{nr}{p^{2}}-\\frac{S}{(1-p)^{2}}<0\n$$\n对于 $p\\in(0,1)$，该值小于0，这证实了它是一个最大值。因此，最大似然估计量为\n$$\n\\hat{p}=\\frac{nr}{nr+S}.\n$$", "answer": "$$\\boxed{\\frac{nr}{nr+S}}$$", "id": "1321150"}]}