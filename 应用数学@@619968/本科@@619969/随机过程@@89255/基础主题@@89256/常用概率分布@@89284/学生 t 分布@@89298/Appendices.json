{"hands_on_practices": [{"introduction": "学生 t 分布最常见的应用场景之一是在总体方差未知的小样本情况下进行假设检验。本练习将带你进入一个实际的质量控制场景，你需要确定用于决策的关键阈值。通过这个实践，你将掌握如何查找 t 分布临界值，这是应用统计学进行科学推断的一项基本技能。[@problem_id:1335684]", "problem": "一家小批量精品咖啡公司正在试验一种新的烘焙方案，以提高其咖啡豆的品质。咖啡豆的品质采用标准化的100分制进行评分。该公司的传统烘焙方法有一个历史悠久的平均品质得分。为了测试新的方案，他们烘焙了16个独立批次的样本，并对其得分进行评估。\n\n该公司制定了一条统计决策规则。只有当样本提供了强有力的证据，表明新的平均分确实高于历史平均分时，他们才会改用新的烘焙方案。他们通过从样本数据中计算检验统计量 $T$ 来将此过程形式化：\n\n$$\nT = \\frac{\\bar{X} - \\mu_0}{S / \\sqrt{n}}\n$$\n\n其中，$\\bar{X}$ 是16个新批次的平均分，$\\mu_0$ 是历史平均分，$S$ 是16个新批次分数的标准差，$n$ 是样本量。\n\n为了最大限度地降低改用一个实际上并未更好的新流程的风险，他们设定了 $\\alpha = 0.05$ 的显著性水平。只有当他们计算出的 $T$ 值超过一个特定的正阈值（我们称之为 $t_{crit}$）时，他们才会采用新的方案。这个阈值由学生t分布确定，该分布适用于总体标准差未知的小样本情况。\n\n该公司应在其决策中使用的这个临界阈值 $t_{crit}$ 的值是多少？\n\nA. 1.753\n\nB. 2.131\n\nC. 1.341\n\nD. 1.746\n\nE. 2.602", "solution": "问题要求的是使用学生t分布进行单侧假设检验的临界阈值 $t_{crit}$。该公司想确定新的烘焙方案是否更好，这意味着他们正在检验平均分是否有所提高。这对应于一个上尾（或右尾）检验。\n\n临界值是t分布上将“拒绝域”与“非拒绝域”分开的点。对于显著性水平为 $\\alpha$ 的上尾检验，临界值 $t_{crit}$ 是指 $t_{\\alpha, df}$，该值使其右侧尾部的面积等于 $\\alpha$。自由度（用 $df$ 表示）是根据样本量 $n$ 计算的。\n\n首先，我们必须确定自由度。在这种情况下，自由度的计算公式是：\n$$\ndf = n - 1\n$$\n鉴于样本量为 $n=16$，自由度为：\n$$\ndf = 16 - 1 = 15\n$$\n\n接下来，我们确定显著性水平。问题中指出，该公司使用的显著性水平为 $\\alpha = 0.05$。\n\n我们正在寻找一个上尾临界值。因此，我们需要从自由度为15的学生t分布中找到值 $t_{crit}$，使得观察到大于或等于 $t_{crit}$ 的t统计量的概率为0.05。这被记作 $t_{0.05, 15}$。\n\n我们可以使用标准的t分布表或统计软件来找到这个值。查找t分布表中单尾概率为0.05且自由度为15所对应的值。\n\n- 该行对应于 $df = 15$。\n- 该列对应于上尾概率 $\\alpha = 0.05$。\n\n这一行和这一列的交点给出了临界t值。\n$$\nt_{crit} = t_{0.05, 15} \\approx 1.753\n$$\n\n这意味着，如果他们从样本中计算出的检验统计量 $T$ 大于1.753，那么该公司就有了统计上显著的证据（在5%的显著性水平下）来断定新的烘焙方案能产出更高的平均分。\n\n我们来检查一下其他选项，以理解它们为什么是错误的：\n- B. 2.131: 这是 $t_{0.025, 15}$。对于总显著性水平为 $\\alpha=0.05$ 的双侧检验（每个尾部为0.025），这才是正确的临界值。\n- C. 1.341: 这是 $t_{0.10, 15}$。它对应于一个不那么严格的显著性水平 $\\alpha=0.10$。\n- D. 1.746: 这是 $t_{0.05, 16}$。这个值是由于一个常见的错误——使用样本量 $n$ 而不是 $n-1$ 作为自由度——而得出的。\n- E. 2.602: 这是 $t_{0.01, 15}$。它对应于一个更严格的显著性水平 $\\alpha=0.01$。\n\n因此，该公司决策规则的正确临界阈值是1.753。", "answer": "$$\\boxed{A}$$", "id": "1335684"}, {"introduction": "在掌握了如何应用 t 分布之后，我们来探讨一个更根本的问题：t 分布本身是如何产生的？这个练习要求你设计一个算法，仅使用标准正态分布的样本来生成一个服从 t 分布的随机数 $T$。这项任务不仅能加深你对 t 分布定义的理解，还能让你体会到复杂随机变量是如何通过更简单的随机变量构造出来的，这对随机模拟和计算统计至关重要。[@problem_id:1335741]", "problem": "一位计算科学家需要编写一个函数，该函数从具有指定自由度 $\\nu$（其中 $\\nu$ 是一个正整数）的学生t分布中生成随机变量。唯一可用的工具是一个可以从标准正态分布 $N(0,1)$ 中产生独立随机样本的生成器。该科学家提出了几种算法。\n\n以下哪种算法能正确生成一个服从自由度为 $\\nu$ 的学生t分布的随机数 $T$？\n\nA. 生成 $\\nu+1$ 个独立的标准正态样本，我们将其标记为 $Z_0, Z_1, \\ldots, Z_\\nu$。计算值 $T = \\frac{Z_0}{\\sqrt{\\frac{1}{\\nu} \\sum_{i=1}^{\\nu} Z_i}}$。\n\nB. 生成 $\\nu$ 个独立的标准正态样本，我们将其标记为 $Z_1, \\ldots, Z_\\nu$。计算样本均值 $\\bar{Z} = \\frac{1}{\\nu}\\sum_{i=1}^{\\nu} Z_i$ 和样本标准差 $s = \\sqrt{\\frac{1}{\\nu-1}\\sum_{i=1}^{\\nu} (Z_i - \\bar{Z})^2}$。计算值 $T = \\frac{\\bar{Z}}{s / \\sqrt{\\nu}}$。\n\nC. 生成 $\\nu+1$ 个独立的标准正态样本，我们将其标记为 $Z_0, Z_1, \\ldots, Z_\\nu$。计算值 $T = \\frac{Z_0}{\\sqrt{\\frac{1}{\\nu} \\sum_{i=1}^{\\nu} Z_i^2}}$。\n\nD. 生成 $\\nu$ 个独立的标准正态样本，我们将其标记为 $Z_1, \\ldots, Z_\\nu$。计算值 $T = \\frac{Z_1}{\\sqrt{\\frac{1}{\\nu-1} \\sum_{i=2}^{\\nu} Z_i^2}}$。\n\nE. 生成 $\\nu+1$ 个独立的标准正态样本，我们将其标记为 $Z_0, Z_1, \\ldots, Z_\\nu$。计算值 $T = \\frac{Z_0}{\\frac{1}{\\nu} \\sum_{i=1}^{\\nu} Z_i^2}$。", "solution": "目标：确定哪种算法返回一个服从自由度为 $\\nu$ 的学生t分布的随机变量。其定义性构造是：如果 $Z \\sim N(0,1)$ 和 $V \\sim \\chi^{2}_{\\nu}$ 是独立的，那么\n$$\nT \\equiv \\frac{Z}{\\sqrt{V/\\nu}} \\sim t_{\\nu}.\n$$\n此外，如果 $Z_{1},\\ldots,Z_{\\nu}$ 是独立同分布于 $N(0,1)$，那么 $V=\\sum_{i=1}^{\\nu} Z_{i}^{2} \\sim \\chi^{2}_{\\nu}$。同样，对于一个大小为 $n$ 的正态样本，统计量\n$$\n\\frac{\\bar{Z}-\\mu}{S/\\sqrt{n}} \\sim t_{n-1},\n$$\n其中 $S$ 是样本标准差，且 $\\bar{Z}$ 和 $S^{2}$ 是独立的；此外，当每个观测值的方差为 $\\sigma^{2}$ 时，$(n-1)S^{2}/\\sigma^{2} \\sim \\chi^{2}_{n-1}$。\n\n分析每个选项：\n\nA. 分母是 $\\sqrt{\\frac{1}{\\nu}\\sum_{i=1}^{\\nu} Z_{i}}$。由于 $\\sum_{i=1}^{\\nu} Z_{i} \\sim N(0,\\nu)$，平方根内的量不是几乎必然非负的，因此该表达式没有被良好定义，并且肯定不具有 $V \\sim \\chi^{2}_{\\nu}$ 所需的 $\\sqrt{V/\\nu}$ 形式。这不会产生 $t_{\\nu}$ 分布。\n\nB. 这里使用了 $n=\\nu$ 个独立同分布于 $N(0,1)$ 的样本。根据经典的t统计量结果，\n$$\nT=\\frac{\\bar{Z}}{s/\\sqrt{\\nu}} \\sim t_{\\nu-1},\n$$\n因为 $(\\nu-1)s^{2} \\sim \\chi^{2}_{\\nu-1}$ 且 $\\sqrt{\\nu}\\,\\bar{Z} \\sim N(0,1)$，并且两者独立。其自由度为 $\\nu-1$，而不是 $\\nu$，因此这不会产生 $t_{\\nu}$ 分布。\n\nC. 设 $Z_{0},Z_{1},\\ldots,Z_{\\nu}$ 是独立的 $N(0,1)$ 变量。定义 $V=\\sum_{i=1}^{\\nu} Z_{i}^{2} \\sim \\chi^{2}_{\\nu}$，并注意 $Z_{0}$ 与 $V$ 是独立的。那么\n$$\nT=\\frac{Z_{0}}{\\sqrt{\\frac{1}{\\nu}\\sum_{i=1}^{\\nu} Z_{i}^{2}}}=\\frac{Z_{0}}{\\sqrt{V/\\nu}} \\sim t_{\\nu},\n$$\n根据定义关系。这是正确的。\n\nD. 设 $V=\\sum_{i=2}^{\\nu} Z_{i}^{2} \\sim \\chi^{2}_{\\nu-1}$，其与 $Z_{1} \\sim N(0,1)$ 独立。那么\n$$\nT=\\frac{Z_{1}}{\\sqrt{\\frac{1}{\\nu-1}\\sum_{i=2}^{\\nu} Z_{i}^{2}}}=\\frac{Z_{1}}{\\sqrt{V/(\\nu-1)}} \\sim t_{\\nu-1}.\n$$\n这具有 $\\nu-1$ 个自由度，而不是 $\\nu$，所以它对于生成 $t_{\\nu}$ 分布是不正确的。\n\nE. 设 $V=\\sum_{i=1}^{\\nu} Z_{i}^{2} \\sim \\chi^{2}_{\\nu}$，其与 $Z_{0} \\sim N(0,1)$ 独立。那么\n$$\nT=\\frac{Z_{0}}{\\frac{1}{\\nu}\\sum_{i=1}^{\\nu} Z_{i}^{2}}=\\frac{\\nu Z_{0}}{V}.\n$$\nt分布要求除以 $\\sqrt{V/\\nu}$，而不是 $V/\\nu$。一个标准正态变量与一个卡方变量（没有平方根）的比值会产生一个不同的分布，而不是 $t_{\\nu}$ 分布。\n\n结论：只有算法C产生 $t_{\\nu}$ 分布的变量。", "answer": "$$\\boxed{C}$$", "id": "1335741"}, {"introduction": "t 统计量的形式简洁优美，但它的适用性并非理所当然。本练习通过一个思想实验，挑战你思考为何经典的 t 统计量（例如 $T_{\\text{mean}}$）适用于样本均值，却不适用于样本中位数。通过辨析两者的差异，你将深刻理解样本均值与样本方差之间的独立性这一关键性质，它正是 t 分布能够精确描述样本均值抽样分布的理论基石。[@problem_id:1335692]", "problem": "考虑一个由 $n$ 个独立同分布 (i.i.d.) 的随机变量 $X_1, X_2, \\ldots, X_n$ 组成的序列，它们从一个正态分布 $N(\\mu, \\sigma^2)$ 中抽取，其中均值 $\\mu$ 和方差 $\\sigma^2$ 均为未知。\n\n设样本均值为 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^{n} X_i$，样本方差为 $S^2 = \\frac{1}{n-1}\\sum_{i=1}^{n} (X_i - \\bar{X})^2$。统计学中一个众所周知的结果表明，标准化的样本均值（或称 t-统计量），定义为\n$$T_{\\text{mean}} = \\frac{\\bar{X} - \\mu}{S/\\sqrt{n}}$$\n服从自由度为 $n-1$ 的学生t分布（Student's t-distribution）。\n\n现在，考虑观测值的样本中位数，记为 $M$。我们可以为中位数构造一个类似的统计量：\n$$T_{\\text{median}} = \\frac{M - \\mu}{S/\\sqrt{n}}$$\n尽管其结构与 $T_{\\text{mean}}$ 相似，但统计量 $T_{\\text{median}}$ 并*不*服从学生t分布。\n\n下列哪个陈述为这一事实提供了最准确和最根本的原因？\n\nA. 样本中位数 $M$ 的抽样分布仅是渐近正态的，对于有限样本量 $n$ 而言并非精确正态。\n\nB. 样本中位数 $M$ 和样本方差 $S^2$ 不是统计独立的随机变量。\n\nC. 缩放因子 $S/\\sqrt{n}$ 代表样本均值的标准误，而不是样本中位数的正确标准误。\n\nD. 样本中位数是样本观测值的非线性函数，而学生t分布是在位置估计量是线性统计量的假设下推导出来的。\n\nE. 当统计量涉及样本中位数而非样本均值时，与样本方差 $S^2$ 相关的自由度不能被正确指定为 $n-1$。", "solution": "我们首先回顾推导出样本均值服从学生t分布所需的确切要素。对于 $X_{1},\\ldots,X_{n}$ i.i.d. $N(\\mu,\\sigma^{2})$，样本均值和样本方差满足：\n1) $\\bar{X}\\sim N\\!\\left(\\mu,\\frac{\\sigma^{2}}{n}\\right)$。\n2) $\\frac{(n-1)S^{2}}{\\sigma^{2}}\\sim \\chi^{2}_{n-1}$。\n3) $\\bar{X}$ 和 $S^{2}$ 是独立的。\n\n定义 $Z=\\frac{\\bar{X}-\\mu}{\\sigma/\\sqrt{n}}$ 和 $U=\\frac{(n-1)S^{2}}{\\sigma^{2}}$，我们有 $Z\\sim N(0,1)$，$U\\sim \\chi^{2}_{n-1}$，并且 $Z$ 与 $U$ 独立。根据学生t分布的定义属性，\n$$\nT_{\\text{mean}}=\\frac{\\bar{X}-\\mu}{S/\\sqrt{n}}=\\frac{Z}{\\sqrt{U/(n-1)}}\\sim t_{n-1}.\n$$\n\n现在考虑样本中位数 $M$。对于有限的 $n$，在正态模型下 $M$ 的精确抽样分布不是正态的。其渐近方差由样本中位数的一般公式给出：\n$$\n\\operatorname{Var}(M)\\approx\\frac{1}{4n f(\\mu)^{2}},\n$$\n其中 $f$ 是母体密度函数。对于正态分布 $N(\\mu,\\sigma^{2})$，我们有 $f(\\mu)=\\frac{1}{\\sqrt{2\\pi}\\sigma}$，因此\n$$\n\\operatorname{Var}(M)\\approx \\frac{\\pi\\sigma^{2}}{2n}.\n$$\n因此，$S/\\sqrt{n}$ 不是 $M$ 的正确标准误；正确的渐近缩放将需要一个相对于 $\\sigma/\\sqrt{n}$ 的因子 $\\sqrt{\\pi/2}$。\n\n然而，学生t分布的产生并不仅仅是由于缩放。精确的t-分布定律要求两个结构性条件：一个标准正态的分子，以及该分子和一个经过缩放的卡方分母之间的独立性。对于 $M$ 而言，这两个条件都不满足：\n- $M$ 的有限样本分布并非精确正态。\n- 至关重要的是，$M$ 和 $S^{2}$ 不是独立的随机变量。\n\nt-统计量的定义表达式是 $Z/\\sqrt{U/\\nu}$，其中 $Z\\sim N(0,1)$ 且独立于 $U\\sim \\chi^{2}_{\\nu}$。即使人们修正了缩放因子以使用 $M$ 的适当标准误，$M$ 和 $S^{2}$ 之间缺乏独立性也使得这种表示方式无法实现。因此，选项中最准确和最根本的原因是 $M$ 和 $S^{2}$ 不是独立的，这是一个结构性属性，它是均值的精确t分布的基础，但对于中位数则不成立。\n\n因此，正确选项是 B。", "answer": "$$\\boxed{B}$$", "id": "1335692"}]}