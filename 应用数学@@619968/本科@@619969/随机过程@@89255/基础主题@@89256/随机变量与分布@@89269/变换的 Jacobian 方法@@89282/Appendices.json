{"hands_on_practices": [{"introduction": "我们从一个基础但十分重要的练习开始，它涉及到单变量的变换。计算一个随机变量倒数的分布，即 $Y=1/X$，是一项基本技能。这个问题以柯西分布为例，由于其独特的“重尾”性质，使得这个变换的结果尤其有趣。通过这个练习，你将巩固单变量变换的基本公式，为更复杂的多维变换打下坚实的基础。[@problem_id:1313188]", "problem": "一个连续随机变量 $X$ 由一个广义柯西分布描述。该分布常用于物理学中对共振现象进行建模，以及在金融学中对某些类型的波动性资产回报进行建模。$X$ 的概率密度函数 (PDF) 由下式给出：\n$$f_X(x) = \\frac{\\gamma}{\\pi \\left( (x - x_0)^2 + \\gamma^2 \\right)}$$\n对于 $-\\infty < x < \\infty$。此处，$x_0$ 是位置参数，指定了分布峰值的位置；$\\gamma > 0$ 是尺度参数，指定了半峰处的半宽度。\n\n现在，考虑一个新的随机变量 $Y$，它是通过倒数变换 $Y = 1/X$ 从 $X$ 导出的。这种类型的变换出现在各种情境中，例如在电路中关联一个元件的电阻和电导。\n\n求出随机变量 $Y$ 的概率密度函数，记为 $g_Y(y)$。将你的最终答案表示为关于 $y$、$x_0$ 和 $\\gamma$ 的解析表达式。", "solution": "给定一个连续随机变量 $X$，其概率密度函数为\n$$\nf_{X}(x)=\\frac{\\gamma}{\\pi\\left((x-x_{0})^{2}+\\gamma^{2}\\right)},\\quad -\\infty<x<\\infty,\n$$\n其中 $x_{0}\\in\\mathbb{R}$ 且 $\\gamma>0$。定义 $Y=1/X$。为了求出 $Y$ 的概率密度函数，记为 $g_{Y}(y)$，我们使用连续随机变量的变换法则。对于一个可微的、一对一的变换 $y=u(x)$，其反函数为 $x=h(y)$，则 $Y$ 的概率密度函数是\n$$\ng_{Y}(y)=f_{X}(h(y))\\left|\\frac{dh(y)}{dy}\\right|.\n$$\n此处 $y=\\frac{1}{x}$，所以反函数是 $x=h(y)=\\frac{1}{y}$，且\n$$\n\\frac{dh(y)}{dy}=\\frac{d}{dy}\\left(\\frac{1}{y}\\right)=-\\frac{1}{y^{2}},\n\\quad\n\\left|\\frac{dh(y)}{dy}\\right|=\\frac{1}{y^{2}}\\quad (y\\neq 0).\n$$\n代入公式可得\n$$\ng_{Y}(y)=f_{X}\\!\\left(\\frac{1}{y}\\right)\\frac{1}{y^{2}}\n=\\frac{\\gamma}{\\pi\\left(\\left(\\frac{1}{y}-x_{0}\\right)^{2}+\\gamma^{2}\\right)}\\cdot\\frac{1}{y^{2}},\\quad y\\neq 0.\n$$\n我们通过消去括号内的分数来化简该表达式。注意到\n$$\n\\left(\\frac{1}{y}-x_{0}\\right)^{2}=\\frac{(1-x_{0}y)^{2}}{y^{2}},\n$$\n所以\n$$\ny^{2}\\left(\\left(\\frac{1}{y}-x_{0}\\right)^{2}+\\gamma^{2}\\right)=(1-x_{0}y)^{2}+\\gamma^{2}y^{2}.\n$$\n因此，\n$$\ng_{Y}(y)=\\frac{\\gamma}{\\pi\\left((1-x_{0}y)^{2}+\\gamma^{2}y^{2}\\right)}.\n$$\n根据推导，该表达式对所有 $y\\neq 0$ 成立，并且可以用相同的公式连续地延拓到 $y=0$。因此，$Y$ 的概率密度函数是\n$$\ng_{Y}(y)=\\frac{\\gamma}{\\pi\\left((1-x_{0}y)^{2}+\\gamma^{2}y^{2}\\right)}.\n$$", "answer": "$$\\boxed{\\frac{\\gamma}{\\pi\\left((1-x_{0}y)^{2}+\\gamma^{2}y^{2}\\right)}}$$", "id": "1313188"}, {"introduction": "掌握了单变量变换后，我们进入一个更复杂但也更常见的场景：两个随机变量的变换。在许多科学和工程应用中，我们都需要确定两个随机变量之比（例如斜率 $M=Y/X$）的分布。这个练习将引导你完整地应用雅可比方法，包括引入辅助变量和对新变量的联合分布进行积分（边缘化）以求得目标分布的关键步骤。此外，这个问题直观的几何背景将帮助你更好地理解变换后变量的定义域是如何变化的。[@problem_id:1313213]", "problem": "考虑两个独立的随机变量 $X$ 和 $Y$，它们都在区间 $[0, 1]$ 上服从均匀分布。这两个变量可以看作是由区域 $[0, 1] \\times [0, 1]$ 定义的单位正方形内的一个随机点 $(X, Y)$ 的坐标。一个新的随机变量 $M$ 通过取比率 $M = Y/X$ 形成。求随机变量 $M$ 的概率密度函数 (PDF) $f_M(m)$。请将您的答案表示为关于 $m$ 的分段函数。", "solution": "问题要求解随机变量 $M = Y/X$ 的概率密度函数 (PDF)，其中 $X$ 和 $Y$ 是在 $[0, 1]$ 上独立均匀分布的随机变量。\n\n首先，我们写出 $X$ 和 $Y$ 的联合概率密度函数。由于它们是独立的，并且都在 $[0, 1]$ 上均匀分布，它们各自的概率密度函数为 $f_X(x) = 1$（当 $x \\in [0, 1]$ 时）和 $f_Y(y) = 1$（当 $y \\in [0, 1]$ 时）。联合概率密度函数是它们各自概率密度函数的乘积：\n$$ f_{X,Y}(x, y) = \\begin{cases} 1 & \\text{若 } 0 \\le x \\le 1 \\text{ 且 } 0 \\le y \\le 1 \\\\ 0 & \\text{其他情况} \\end{cases} $$\n\n为求解 $M$ 的概率密度函数，我们采用变量变换法（即雅可比方法）。为此，我们引入一个辅助变量 $U$，以建立从 $(X, Y)$ 到新变量对 $(M, U)$ 的一一映射。一个方便的选择是：\n$$ M = \\frac{Y}{X} $$\n$$ U = X $$\n\n接下来，我们通过用 $M$ 和 $U$ 表示 $X$ 和 $Y$ 来求逆变换：\n$$ X = U $$\n$$ Y = MU $$\n\n现在，我们计算这个逆变换的雅可比行列式。雅可比行列式 $J$ 由下式给出：\n$$ J = \\det \\begin{pmatrix} \\frac{\\partial x}{\\partial m} & \\frac{\\partial x}{\\partial u} \\\\ \\frac{\\partial y}{\\partial m} & \\frac{\\partial y}{\\partial u} \\end{pmatrix} = \\det \\begin{pmatrix} 0 & 1 \\\\ u & m \\end{pmatrix} = (0)(m) - (1)(u) = -u $$\n雅可比行列式的绝对值为 $|J| = |-u| = u$。由于 $X=U$ 且 $X \\in [0,1]$，此条件得到满足，且 $u \\ge 0$。\n\n新变量 $M$ 和 $U$ 的联合概率密度函数由公式 $f_{M,U}(m, u) = f_{X,Y}(x(m,u), y(m,u)) |J|$ 给出。代入 $x$、$y$ 和 $|J|$ 的表达式：\n$$ f_{M,U}(m, u) = f_{X,Y}(u, mu) \\cdot u $$\n\n为了计算这个值，我们需要确定 $(M,U)$ 的支撑集（即概率密度函数非零的区域）。$(X,Y)$ 的支撑集是单位正方形 $0 \\le x \\le 1$ 和 $0 \\le y \\le 1$。我们将这些不等式转换为关于 $m$ 和 $u$ 的不等式：\n1.  $0 \\le x \\le 1 \\implies 0 \\le u \\le 1$。\n2.  $0 \\le y \\le 1 \\implies 0 \\le mu \\le 1$。\n\n由于 $u=x>0$ 且 $y \\ge 0$，斜率 $m=y/x$ 必须是非负的，所以 $m \\ge 0$。\n条件 $mu \\le 1$，由于 $u>0$，意味着 $u \\le 1/m$。\n综合这些条件，$(M,U)$ 的支撑集由 $m \\ge 0$, $0 \\le u \\le 1$ 和 $u \\le 1/m$ 定义。\n在此区域内，$f_{X,Y}(u, mu) = 1$。因此，$M$ 和 $U$ 的联合概率密度函数为：\n$$ f_{M,U}(m, u) = 1 \\cdot u = u $$\n当 $m \\ge 0$ 且 $0 \\le u \\le \\min(1, 1/m)$ 时成立，其他情况下 $f_{M,U}(m, u) = 0$。\n\n为了求得 $M$ 的边缘概率密度函数 $f_M(m)$，我们将联合概率密度函数 $f_{M,U}(m, u)$ 在其支撑集上对 $u$ 进行积分。$u$ 的积分上限取决于 $m$，因此我们必须考虑两种情况。\n\n情况1：$0 \\le m \\le 1$\n在这种情况下，$1/m \\ge 1$。$u$ 的上限为 $\\min(1, 1/m) = 1$。\n$$ f_M(m) = \\int_0^1 f_{M,U}(m, u) \\, du = \\int_0^1 u \\, du = \\left[ \\frac{u^2}{2} \\right]_0^1 = \\frac{1}{2} $$\n\n情况2：$m > 1$\n在这种情况下，$0 < 1/m < 1$。$u$ 的上限为 $\\min(1, 1/m) = 1/m$。\n$$ f_M(m) = \\int_0^{1/m} f_{M,U}(m, u) \\, du = \\int_0^{1/m} u \\, du = \\left[ \\frac{u^2}{2} \\right]_0^{1/m} = \\frac{(1/m)^2}{2} - 0 = \\frac{1}{2m^2} $$\n\n对于 $m < 0$，概率密度函数为零。综合这些结果，我们得到 $M$ 的分段概率密度函数：\n$$ f_M(m) = \\begin{cases} \\frac{1}{2} & \\text{若 } 0 \\le m \\le 1 \\\\ \\frac{1}{2m^2} & \\text{若 } m > 1 \\\\ 0 & \\text{其他情况} \\end{cases} $$", "answer": "$$\n\\boxed{\nf_M(m) = \n\\begin{cases} \n\\frac{1}{2} & \\text{如果 } 0 \\le m \\le 1 \\\\\n\\frac{1}{2m^2} & \\text{如果 } m > 1 \\\\\n0 & \\text{其他情况}\n\\end{cases}\n}\n$$", "id": "1313213"}, {"introduction": "最后一个练习展示了雅可比方法在不同坐标系之间进行变换的强大功能和普适性。我们将笛卡尔坐标 $(X,Y)$ 变换为在计算机图形学和工程领域中非常有用的重心坐标。与前面的练习不同，我们的目标是求出新坐标 $(\\Lambda_1, \\Lambda_2)$ 的联合概率密度函数，而不是单个导出变量的分布。这个练习将让你深刻体会到雅可比行列式在概率密度变换中的核心作用，并展示一个完整的二维到二维变换过程。[@problem_id:1313179]", "problem": "在无线网络分析领域，服务区域内用户设备（UE）的位置通常被建模为一个随机变量。考虑一个由三个通信塔定义的三角形服务区，其顶点为 $V_1=(0,0)$、$V_2=(a,0)$ 和 $V_3=(b,c)$，其中 $a, b, c$ 为正常数。UE 的位置 $(X,Y)$ 是该三角形内的一个随机点。由于信号传播特性和用户分布模式，在特定位置找到 UE 的概率并非均匀分布。其位置的联合概率密度函数（PDF）由 $f_{X,Y}(x,y) = k \\cdot y$ 给出（当 $(x,y)$ 在三角形内时），而在其他情况下 $f_{X,Y}(x,y) = 0$。其中 $k$ 是一个归一化常数。\n\nUE 的位置也可以用相对于顶点 $V_1, V_2, V_3$ 的重心坐标 $(\\lambda_1, \\lambda_2, \\lambda_3)$ 来描述。一个点 $(x,y)$ 表示为 $(x,y) = \\lambda_1 V_1 + \\lambda_2 V_2 + \\lambda_3 V_3$，其中 $\\lambda_1, \\lambda_2, \\lambda_3 \\ge 0$ 且 $\\lambda_1 + \\lambda_2 + \\lambda_3 = 1$。设 $\\Lambda_1$ 和 $\\Lambda_2$ 是对应于前两个重心坐标的随机变量。\n\n求联合概率密度函数 $f_{\\Lambda_1, \\Lambda_2}(\\lambda_1, \\lambda_2)$。最终答案应为关于 $\\lambda_1$ 和 $\\lambda_2$ 的表达式，且在分布的非零定义域上有效。", "solution": "我们已知三角形的顶点为 $V_{1}=(0,0)$、$V_{2}=(a,0)$、$V_{3}=(b,c)$，以及联合概率密度函数在三角形内为 $f_{X,Y}(x,y)=k\\,y$，在其他区域为 $0$。首先，通过施加以下积分条件来确定归一化常数 $k$：\n$$\n\\iint_{\\text{triangle}} k\\,y\\,\\mathrm{d}A=1.\n$$\n该三角形的面积为\n$$\nA=\\frac{1}{2}\\left|a c\\right|=\\frac{a c}{2},\n$$\n因为 $a,c>0$。由于 $y$ 是一个仿射函数，其在三角形上的积分等于面积乘以其在形心处的值。形心的 $y$ 坐标是各顶点 $y$ 坐标的平均值，\n$$\n\\bar{y}=\\frac{0+0+c}{3}=\\frac{c}{3}.\n$$\n因此，\n$$\n\\iint_{\\text{triangle}} y\\,\\mathrm{d}A=A\\,\\bar{y}=\\frac{a c}{2}\\cdot\\frac{c}{3}=\\frac{a c^{2}}{6},\n$$\n所以归一化常数为\n$$\nk=\\frac{1}{\\iint_{\\text{triangle}} y\\,\\mathrm{d}A}=\\frac{6}{a c^{2}}.\n$$\n于是\n$$\nf_{X,Y}(x,y)=\\frac{6}{a c^{2}}\\,y\\quad\\text{在三角形上。}\n$$\n\n现在，用重心坐标表示 $(x,y)$。根据 $\\lambda_{1}+\\lambda_{2}+\\lambda_{3}=1$ 和 $(x,y)=\\lambda_{1}V_{1}+\\lambda_{2}V_{2}+\\lambda_{3}V_{3}$，我们有\n$$\nx=a\\lambda_{2}+b\\lambda_{3},\\qquad y=c\\lambda_{3}.\n$$\n因为 $\\lambda_{3}=1-\\lambda_{1}-\\lambda_{2}$，这些方程变为\n$$\nx=b-b\\lambda_{1}+(a-b)\\lambda_{2},\\qquad y=c\\,(1-\\lambda_{1}-\\lambda_{2}).\n$$\n从 $(\\lambda_{1},\\lambda_{2})$ 到 $(x,y)$ 变换的雅可比行列式是\n$$\nJ=\\begin{vmatrix}\n\\dfrac{\\partial x}{\\partial \\lambda_{1}} & \\dfrac{\\partial x}{\\partial \\lambda_{2}} \\\\[6pt]\n\\dfrac{\\partial y}{\\partial \\lambda_{1}} & \\dfrac{\\partial y}{\\partial \\lambda_{2}}\n\\end{vmatrix}\n=\\begin{vmatrix}\n-b & a-b \\\\[3pt]\n-c & -c\n\\end{vmatrix}\n=(-b)(-c)-(a-b)(-c)=a c,\n$$\n所以 $|J|=a c$。\n\n根据变量变换公式，\n$$\nf_{\\Lambda_{1},\\Lambda_{2}}(\\lambda_{1},\\lambda_{2})\n=f_{X,Y}\\bigl(x(\\lambda_{1},\\lambda_{2}),y(\\lambda_{1},\\lambda_{2})\\bigr)\\,|J|\n=\\frac{6}{a c^{2}}\\cdot c\\,(1-\\lambda_{1}-\\lambda_{2})\\cdot a c\n=6\\,(1-\\lambda_{1}-\\lambda_{2}),\n$$\n其定义域为 $\\lambda_{1}\\ge 0$，$\\lambda_{2}\\ge 0$，$\\lambda_{1}+\\lambda_{2}\\le 1$，在其他区域为零。这满足了在单纯形上的归一化条件。", "answer": "$$\\boxed{6\\,(1-\\lambda_{1}-\\lambda_{2})}$$", "id": "1313179"}]}