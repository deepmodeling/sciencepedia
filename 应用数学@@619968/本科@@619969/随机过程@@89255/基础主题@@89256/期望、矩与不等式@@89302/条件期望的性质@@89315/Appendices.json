{"hands_on_practices": [{"introduction": "我们从一个基于离散随机变量的直观练习开始。这个经典的投掷骰子问题，要求我们在已知两个骰子点数最大值的情况下，计算它们的总和的期望值。这个练习将帮助你通过仔细计算基本结果来练习条件期望的定义，从而为更复杂的场景打下坚实的基础。[@problem_id:1381964]", "problem": "设 $X_1$ 和 $X_2$ 为两次独立投掷一枚均匀六面骰子的结果。每次投掷的可能结果集合为 $\\{1, 2, 3, 4, 5, 6\\}$，每个结果的概率为 $1/6$。\n\n定义两个新的随机变量：和 $S = X_1 + X_2$ 以及最大值 $M = \\max(X_1, X_2)$。\n\n求在观测到的最大值为 $k$ 的条件下，和 $S$ 的条件期望，其中 $k$ 是一个满足 $1 \\le k \\le 6$ 的整数。请将答案表示为关于 $k$ 的函数。", "solution": "设 $X_{1}$ 和 $X_{2}$ 独立，且在 $\\{1,2,3,4,5,6\\}$ 上服从均匀分布。定义 $S = X_{1} + X_{2}$ 和 $M = \\max(X_{1}, X_{2})$。我们要求解对于 $1 \\leq k \\leq 6$ 的 $E[S \\mid M = k]$。\n\n首先，描述事件 $\\{M = k\\}$ 的特征。它由所有满足 $1 \\leq i,j \\leq k$ 且至少有一个坐标等于 $k$ 的有序对 $(i,j)$ 组成。这类有序对的总数为\n$$\n|\\{(i,j) : \\max(i,j) = k\\}| = k^{2} - (k-1)^{2} = 2k - 1.\n$$\n由于每个有序对的概率为 $\\frac{1}{36}$，而以 $\\{M=k\\}$ 为条件则将样本空间限制在这 $2k-1$ 个等可能的有序对上，因此该集合上的条件分布是均匀的。\n\n因此，\n$$\nE[S \\mid M = k] = \\frac{1}{2k - 1} \\sum_{\\max(i,j)=k} (i + j).\n$$\n将该集合划分为不相交的并集\n$$\nB = \\{(k,j) : 1 \\leq j \\leq k\\}, \\quad C = \\{(i,k) : 1 \\leq i \\leq k-1\\},\n$$\n使得 $|B| = k$，$|C| = k-1$，且 $B \\cap C = \\varnothing$。然后\n$$\n\\sum_{(i,j)\\in B} (i + j) = \\sum_{j=1}^{k} (k + j) = k^{2} + \\frac{k(k+1)}{2},\n$$\n以及\n$$\n\\sum_{(i,j)\\in C} (i + j) = \\sum_{i=1}^{k-1} (i + k) = \\frac{(k-1)k}{2} + k(k-1) = \\frac{3k(k-1)}{2}.\n$$\n因此，在 $\\{(i,j): \\max(i,j)=k\\}$ 上的总和为\n$$\nk^{2} + \\frac{k(k+1)}{2} + \\frac{3k(k-1)}{2} = k^{2} + \\frac{k(4k - 2)}{2} = k^{2} + k(2k - 1) = 3k^{2} - k.\n$$\n除以等可能对的数量 $2k - 1$ 得到\n$$\nE[S \\mid M = k] = \\frac{3k^{2} - k}{2k - 1}.\n$$\n该式对所有满足 $1 \\leq k \\leq 6$ 的整数 $k$ 成立。", "answer": "$$\\boxed{\\frac{3k^{2} - k}{2k - 1}}$$", "id": "1381964"}, {"introduction": "接下来，我们将从离散世界过渡到连续世界。这个“掰断木棍”问题是一个经典的概率谜题，它要求我们计算中间断裂段的期望长度，前提是已知第一个断裂点的位置。解决这个问题需要你使用条件概率密度函数，其结果非常直观，有助于加深你对条件期望如何处理连续变量的理解。[@problem_id:1381953]", "problem": "一根长度为 $L$ 的笔直刚性杆放置在 x 轴的正半轴上，一端在原点 ($x=0$)，另一端在 $x=L$ 处。\n\n沿着该杆选择两个点将其折断。这两个断点的位置由两个随机变量 $X_1$ 和 $X_2$ 决定，它们独立地从区间 $[0, L]$ 上的均匀分布中抽取。\n\n这两个断点将杆分成三个较短的片段。设 $U$ 为表示离原点较近的断点位置的随机变量，$V$ 为表示离原点较远的断点位置的随机变量。因此，我们有 $U = \\min(X_1, X_2)$ 和 $V = \\max(X_1, X_2)$。中间片段的长度因此由随机变量 $M = V - U$ 给出。\n\n您的任务是，在第一个断点（即离原点较近的那个）出现在特定位置 $u$（其中 $0 < u < L$）的条件下，确定中间片段长度 $M$ 的条件期望。\n\n请用一个包含 $L$ 和 $u$ 的符号表达式来表示您的答案。", "solution": "设 $X_{1}$ 和 $X_{2}$ 为独立同分布的随机变量，在 $[0,L]$ 上服从均匀分布，所以在 $[0,L]^{2}$ 上，其概率密度为 $f_{X_{1},X_{2}}(x_{1},x_{2}) = L^{-2}$。定义顺序统计量 $U=\\min(X_{1},X_{2})$ 和 $V=\\max(X_{1},X_{2})$。对于 $0<u<v<L$，$(U,V)$ 的联合密度是标准的顺序统计量结果\n$$\nf_{U,V}(u,v) = \\frac{2}{L^{2}}, \\quad 0<u<v<L.\n$$\n$U$ 的边缘密度通过对 $v$ 积分得到：\n$$\nf_{U}(u) = \\int_{v=u}^{L} \\frac{2}{L^{2}} \\, dv = \\frac{2(L-u)}{L^{2}}, \\quad 0<u<L.\n$$\n因此，在给定 $U=u$ 的条件下，$V$ 的条件密度是\n$$\nf_{V\\mid U}(v\\mid u) = \\frac{f_{U,V}(u,v)}{f_{U}(u)} = \\frac{1}{L-u}, \\quad u<v<L,\n$$\n所以，在给定 $U=u$ 时，$V$ 在 $(u,L)$ 上服从均匀分布。中间片段的长度为 $M=V-U$，所以在以 $U=u$ 为条件时，我们有 $M=V-u$。因此，\n$$\nE[M\\mid U=u] = \\int_{u}^{L} (v-u)\\,\\frac{1}{L-u}\\,dv\n= \\frac{1}{L-u}\\left[\\frac{(v-u)^{2}}{2}\\right]_{v=u}^{v=L}\n= \\frac{1}{L-u}\\cdot \\frac{(L-u)^{2}}{2}\n= \\frac{L-u}{2}.\n$$\n此结果在 $0<u<L$ 时成立。", "answer": "$$\\boxed{\\frac{L-u}{2}}$$", "id": "1381953"}, {"introduction": "最后，我们来解决一个更高级的问题，它与信号处理等实际应用领域密切相关。在这个场景中，一个高斯信号 $V$ 经过非线性变换，我们需要在已知变换后信号的能量 $P=V^2$ 的情况下，估计原始信号的幅度。这个问题展示了条件期望如何作为实际应用中的最优估计器，并得出一个包含双曲正切函数的有趣结果。[@problem_id:1327108]", "problem": "在数字通信系统中，一个接收到的信号脉冲的幅度，由随机变量 $V$ 表示，其模型为高斯分布。该信号具有一个非零的直流 (DC) 分量 $\\mu$，并受到均值为零的加性高斯噪声的干扰，导致总信号的标准差为 $\\sigma$。因此，$V$ 的概率密度函数由 $f_V(v) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(v-\\mu)^2}{2\\sigma^2}\\right)$ 给出，其中 $\\mu$ 和 $\\sigma$ 是正实数常量。\n\n接收器电路中的一个非线性检测器测量一个量 $P$，它等于信号幅度的平方，即 $P = V^2$。为了实现最优的信号重建，需要根据该测量值 $P$ 计算原始幅度 $V$ 的最佳估计。在最小化均方误差的意义上，这个最佳估计是在给定 $P$ 的条件下 $V$ 的条件期望。\n\n确定条件期望 $E[V | P]$。您的答案应表示为测量量 $P$、直流分量 $\\mu$ 和标准差 $\\sigma$ 的函数。", "solution": "设 $V \\sim \\mathcal{N}(\\mu,\\sigma^{2})$，其密度为 $f_{V}(v)=\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\!\\left(-\\frac{(v-\\mu)^{2}}{2\\sigma^{2}}\\right)$，并设 $P=V^{2}$。我们要求解 $E[V \\mid P]$，它必须是 $P$ 的一个可测函数。对于 $p>0$，映射 $h(v)=v^{2}$ 有两个原像 $v_{1}=\\sqrt{p}$ 和 $v_{2}=-\\sqrt{p}$，其导数为 $h'(v)=2v$，所以 $|h'(v_{1})|=|h'(v_{2})|=2\\sqrt{p}$。在给定 $P=p$ 的条件下，$V$ 的条件分布是在集合 $\\{\\sqrt{p},-\\sqrt{p}\\}$ 上的离散分布，其权重正比于 $f_{V}(v_{i})/|h'(v_{i})|$。因此，\n$$\nE[V \\mid P=p]\n=\\frac{\\sqrt{p}\\,\\frac{f_{V}(\\sqrt{p})}{2\\sqrt{p}}+(-\\sqrt{p})\\,\\frac{f_{V}(-\\sqrt{p})}{2\\sqrt{p}}}{\\frac{f_{V}(\\sqrt{p})}{2\\sqrt{p}}+\\frac{f_{V}(-\\sqrt{p})}{2\\sqrt{p}}}\n=\\sqrt{p}\\,\\frac{f_{V}(\\sqrt{p})-f_{V}(-\\sqrt{p})}{f_{V}(\\sqrt{p})+f_{V}(-\\sqrt{p})}.\n$$\n使用高斯密度函数，\n$$\nf_{V}(\\sqrt{p})=\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\!\\left(-\\frac{(\\sqrt{p}-\\mu)^{2}}{2\\sigma^{2}}\\right),\\quad\nf_{V}(-\\sqrt{p})=\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\!\\left(-\\frac{(\\sqrt{p}+\\mu)^{2}}{2\\sigma^{2}}\\right).\n$$\n设\n$$\nA=\\exp\\!\\left(-\\frac{(\\sqrt{p}-\\mu)^{2}}{2\\sigma^{2}}\\right),\\quad\nB=\\exp\\!\\left(-\\frac{(\\sqrt{p}+\\mu)^{2}}{2\\sigma^{2}}\\right).\n$$\n那么\n$$\nA=\\exp\\!\\left(-\\frac{p+\\mu^{2}}{2\\sigma^{2}}\\right)\\exp\\!\\left(\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right),\\quad\nB=\\exp\\!\\left(-\\frac{p+\\mu^{2}}{2\\sigma^{2}}\\right)\\exp\\!\\left(-\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right),\n$$\n所以\n$$\n\\frac{A-B}{A+B}\n=\\frac{\\exp\\!\\left(\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right)-\\exp\\!\\left(-\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right)}{\\exp\\!\\left(\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right)+\\exp\\!\\left(-\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right)}\n=\\tanh\\!\\left(\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right).\n$$\n因此，对于 $p>0$，\n$$\nE[V \\mid P=p]=\\sqrt{p}\\,\\tanh\\!\\left(\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right).\n$$\n在 $p=0$ 时，唯一的原像是 $v=0$，因此 $E[V \\mid P=0]=0$，这与上述表达式在 $p \\to 0^{+}$ 时的极限一致。因此，作为测量量 $P$ 的函数，\n$$\nE[V \\mid P]=\\sqrt{P}\\,\\tanh\\!\\left(\\frac{\\mu\\sqrt{P}}{\\sigma^{2}}\\right).\n$$", "answer": "$$\\boxed{\\sqrt{P}\\,\\tanh\\!\\left(\\frac{\\mu\\sqrt{P}}{\\sigma^{2}}\\right)}$$", "id": "1327108"}]}