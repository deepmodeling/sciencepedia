{"hands_on_practices": [{"introduction": "要真正掌握协方差矩阵，我们必须从其最基本的构建过程开始。本练习提供了一个具体的场景，您将根据给定的离散随机变量的联合概率分布，一步步计算出协方差矩阵的每一个元素。这个实践将巩固您对期望 $E[X]$、方差 $\\text{Var}(X)$ 和协方差 $\\text{Cov}(X,Y)$ 核心定义的理解，是后续学习更复杂应用的基础。[@problem_id:1294505]", "problem": "考虑一个涉及两个离散随机变量 $X$ 和 $Y$ 的简单博弈。变量 $X$ 的取值集合为 $\\{0, 1\\}$，变量 $Y$ 的取值集合为 $\\{0, 1, 2\\}$。这两个变量的联合概率质量函数 $p(x, y) = P(X=x, Y=y)$ 定义如下：\n\n$p(0, 0) = \\frac{1}{10}$\n$p(0, 1) = \\frac{2}{10}$\n$p(0, 2) = 0$\n$p(1, 0) = \\frac{3}{10}$\n$p(1, 1) = \\frac{1}{10}$\n$p(1, 2) = \\frac{3}{10}$\n\n您的任务是计算随机向量 $(X, Y)$ 的协方差矩阵。协方差矩阵 $K$ 是一个 $2 \\times 2$ 矩阵，其中元素 $K_{ij}$ 是第 $i$ 个和第 $j$ 个随机变量的协方差。对于向量 $(X, Y)$，其协方差矩阵由下式给出：\n$$\nK = \\begin{pmatrix} \\text{Var}(X) & \\text{Cov}(X,Y) \\\\ \\text{Cov}(Y,X) & \\text{Var}(Y) \\end{pmatrix}\n$$\n请给出最终的 $2 \\times 2$ 矩阵。", "solution": "为求出协方差矩阵，我们需要计算三个量：$X$ 的方差 $\\text{Var}(X)$；$Y$ 的方差 $\\text{Var}(Y)$；以及 $X$ 和 $Y$ 之间的协方差 $\\text{Cov}(X,Y)$。回顾一下，$\\text{Cov}(Y,X) = \\text{Cov}(X,Y)$。\n\n首先，我们求 $X$ 和 $Y$ 的边缘概率质量函数。\n$X$ 的边缘概率为 $P(X=x) = \\sum_{y} p(x,y)$。\n$P(X=0) = p(0,0) + p(0,1) + p(0,2) = \\frac{1}{10} + \\frac{2}{10} + 0 = \\frac{3}{10}$。\n$P(X=1) = p(1,0) + p(1,1) + p(1,2) = \\frac{3}{10} + \\frac{1}{10} + \\frac{3}{10} = \\frac{7}{10}$。\n\n$Y$ 的边缘概率为 $P(Y=y) = \\sum_{x} p(x,y)$。\n$P(Y=0) = p(0,0) + p(1,0) = \\frac{1}{10} + \\frac{3}{10} = \\frac{4}{10} = \\frac{2}{5}$。\n$P(Y=1) = p(0,1) + p(1,1) = \\frac{2}{10} + \\frac{1}{10} = \\frac{3}{10}$。\n$P(Y=2) = p(0,2) + p(1,2) = 0 + \\frac{3}{10} = \\frac{3}{10}$。\n\n接下来，我们计算 $X$ 和 $Y$ 的期望值（均值）。\n$\\text{E}[X] = \\sum_{x} x P(X=x) = (0)P(X=0) + (1)P(X=1) = 0 \\cdot \\frac{3}{10} + 1 \\cdot \\frac{7}{10} = \\frac{7}{10}$。\n$\\text{E}[Y] = \\sum_{y} y P(Y=y) = (0)P(Y=0) + (1)P(Y=1) + (2)P(Y=2) = 0 \\cdot \\frac{4}{10} + 1 \\cdot \\frac{3}{10} + 2 \\cdot \\frac{3}{10} = \\frac{3}{10} + \\frac{6}{10} = \\frac{9}{10}$。\n\n现在我们计算方差。随机变量 $Z$ 的方差由 $\\text{Var}(Z) = \\text{E}[Z^2] - (\\text{E}[Z])^2$ 给出。我们需要计算 $\\text{E}[X^2]$ 和 $\\text{E}[Y^2]$。\n$\\text{E}[X^2] = \\sum_{x} x^2 P(X=x) = (0^2)P(X=0) + (1^2)P(X=1) = 0 \\cdot \\frac{3}{10} + 1 \\cdot \\frac{7}{10} = \\frac{7}{10}$。\n$\\text{Var}(X) = \\text{E}[X^2] - (\\text{E}[X])^2 = \\frac{7}{10} - \\left(\\frac{7}{10}\\right)^2 = \\frac{7}{10} - \\frac{49}{100} = \\frac{70}{100} - \\frac{49}{100} = \\frac{21}{100}$。\n\n$\\text{E}[Y^2] = \\sum_{y} y^2 P(Y=y) = (0^2)P(Y=0) + (1^2)P(Y=1) + (2^2)P(Y=2) = 0 \\cdot \\frac{4}{10} + 1 \\cdot \\frac{3}{10} + 4 \\cdot \\frac{3}{10} = \\frac{3}{10} + \\frac{12}{10} = \\frac{15}{10} = \\frac{3}{2}$。\n$\\text{Var}(Y) = \\text{E}[Y^2] - (\\text{E}[Y])^2 = \\frac{15}{10} - \\left(\\frac{9}{10}\\right)^2 = \\frac{15}{10} - \\frac{81}{100} = \\frac{150}{100} - \\frac{81}{100} = \\frac{69}{100}$。\n\n最后，我们计算协方差 $\\text{Cov}(X,Y) = \\text{E}[XY] - \\text{E}[X]\\text{E}[Y]$。我们首先需要求出 $\\text{E}[XY]$。\n$\\text{E}[XY] = \\sum_{x,y} xy \\cdot p(x,y)$。非零项为：\n$(1)(1)p(1,1) = 1 \\cdot \\frac{1}{10} = \\frac{1}{10}$。\n$(1)(2)p(1,2) = 2 \\cdot \\frac{3}{10} = \\frac{6}{10}$。\n因此，$\\text{E}[XY] = \\frac{1}{10} + \\frac{6}{10} = \\frac{7}{10}$。\n\n现在我们可以计算协方差：\n$\\text{Cov}(X,Y) = \\text{E}[XY] - \\text{E}[X]\\text{E}[Y] = \\frac{7}{10} - \\left(\\frac{7}{10}\\right)\\left(\\frac{9}{10}\\right) = \\frac{7}{10} - \\frac{63}{100} = \\frac{70}{100} - \\frac{63}{100} = \\frac{7}{100}$。\n\n现在我们组合出协方差矩阵：\n$$\nK = \\begin{pmatrix} \\text{Var}(X) & \\text{Cov}(X,Y) \\\\ \\text{Cov}(Y,X) & \\text{Var}(Y) \\end{pmatrix} = \\begin{pmatrix} \\frac{21}{100} & \\frac{7}{100} \\\\ \\frac{7}{100} & \\frac{69}{100} \\end{pmatrix}\n$$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{21}{100} & \\frac{7}{100} \\\\ \\frac{7}{100} & \\frac{69}{100} \\end{pmatrix}}$$", "id": "1294505"}, {"introduction": "协方差矩阵不仅是一组数字的集合，其结构本身也蕴含着关于随机变量之间关系的重要信息。当随机变量之间存在完美的线性关系时，它们的协方差矩阵会呈现出什么特性呢？本练习将通过一个看似简单的例子，引导您探索随机变量的线性相关性与其协方差矩阵的秩（rank）之间的深刻联系，这是连接概率论与线性代数的关键桥梁。[@problem_id:1294493]", "problem": "设 $X$ 是一个实值随机变量，其方差有限且非零。考虑一个三维随机向量 $\\mathbf{Y}$，其转置定义为 $\\mathbf{Y}^T = (X, 2X, 3X)$。随机向量 $\\mathbf{Y}$ 的协方差矩阵的秩是多少？", "solution": "令 $\\mathbf{a}=\\begin{pmatrix}1\\\\2\\\\3\\end{pmatrix}$，则 $\\mathbf{Y}=\\mathbf{a}X$。那么 $\\mathbb{E}[\\mathbf{Y}]=\\mathbf{a}\\,\\mathbb{E}[X]$ 并且\n$$\n\\operatorname{Cov}(\\mathbf{Y})=\\mathbb{E}\\!\\left[(\\mathbf{Y}-\\mathbb{E}[\\mathbf{Y}])(\\mathbf{Y}-\\mathbb{E}[\\mathbf{Y}])^{T}\\right]\n=\\mathbb{E}\\!\\left[\\mathbf{a}(X-\\mathbb{E}[X])(X-\\mathbb{E}[X])\\mathbf{a}^{T}\\right]\n=\\operatorname{Var}(X)\\,\\mathbf{a}\\mathbf{a}^{T}.\n$$\n因为 $\\operatorname{Var}(X)\\neq 0$ 且 $\\mathbf{a}\\neq \\mathbf{0}$，矩阵 $\\mathbf{a}\\mathbf{a}^{T}$ 是一个非零向量与自身的外积，其秩为 $1$。乘以非零标量 $\\operatorname{Var}(X)$ 不会改变其秩。因此，该协方差矩阵的秩为 $1$。", "answer": "$$\\boxed{1}$$", "id": "1294493"}, {"introduction": "协方差矩阵是解决实际问题的强大工具，尤其是在信号处理和统计建模中。本练习模拟了一个经典场景：如何通过线性组合来优化信号。您将利用已知的协方差信息来寻找一个最优系数 $\\alpha$，以最小化合成信号 $Z = Y - \\alpha X$ 的方差，并在此过程中发现一个至关重要的特性：最优的残差信号与原始信号是去相关的。[@problem_id:1294483]", "problem": "在一个信号处理应用中，我们处理一对相关的随机信号，由一个二维随机向量 $W = (X, Y)^T$ 表示。信号 $X$ 和 $Y$ 都已经中心化，即它们的期望值为零，即 $E[X] = E[Y] = 0$。这些信号之间的统计关系由它们的协方差矩阵 $K_W$ 捕捉，其给定为：\n$$\nK_W = \\begin{pmatrix} \\mathrm{Var}(X) & \\mathrm{Cov}(X, Y) \\\\ \\mathrm{Cov(Y, X)} & \\mathrm{Var}(Y) \\end{pmatrix} = \\begin{pmatrix} 9 & 3 \\\\ 3 & 5 \\end{pmatrix}\n$$\n为了对信号 $Y$ 进行滤波，我们构建了一个新信号 $Z = Y - \\alpha X$，其中 $\\alpha$ 是一个实值标量系数。目标是选择 $\\alpha$ 以使滤波后信号 $Z$ 的功率（等同于其方差）最小化。\n\n令 $\\alpha_0$ 为最小化 $\\mathrm{Var}(Y - \\alpha X)$ 的 $\\alpha$ 的特定值。现在，考虑一个新的随机向量 $V = (X, Y - \\alpha_0 X)^T$。这个新向量 $V$ 的协方差矩阵的行列式是什么？您的最终答案应该是一个实数。", "solution": "我们给定一个中心化的随机向量 $W=(X,Y)^{T}$，其协方差矩阵为\n$$\nK_{W}=\\begin{pmatrix} \\mathrm{Var}(X) & \\mathrm{Cov}(X,Y) \\\\ \\mathrm{Cov}(Y,X) & \\mathrm{Var}(Y) \\end{pmatrix}=\\begin{pmatrix} 9 & 3 \\\\ 3 & 5 \\end{pmatrix}.\n$$\n定义 $Z=Y-\\alpha X$。使用线性组合的方差公式，即 $\\mathrm{Var}(aU+bV)=a^{2}\\mathrm{Var}(U)+b^{2}\\mathrm{Var}(V)+2ab\\,\\mathrm{Cov}(U,V)$，我们得到\n$$\n\\mathrm{Var}(Y-\\alpha X)=\\mathrm{Var}(Y)-2\\alpha\\,\\mathrm{Cov}(X,Y)+\\alpha^{2}\\mathrm{Var}(X).\n$$\n为了最小化这个关于 $\\alpha$ 的二次式，我们对 $\\alpha$ 求导并令其导数为零：\n$$\n\\frac{d}{d\\alpha}\\mathrm{Var}(Y-\\alpha X)=-2\\,\\mathrm{Cov}(X,Y)+2\\alpha\\,\\mathrm{Var}(X)=0,\n$$\n这得出\n$$\n\\alpha_{0}=\\frac{\\mathrm{Cov}(X,Y)}{\\mathrm{Var}(X)}=\\frac{3}{9}=\\frac{1}{3}.\n$$\n二阶导数等于 $2\\,\\mathrm{Var}(X)>0$，所以这确实是最小值点。将 $\\alpha_{0}$ 代入方差，得到众所周知的残差方差公式\n$$\n\\mathrm{Var}(Y-\\alpha_{0}X)=\\mathrm{Var}(Y)-\\frac{\\mathrm{Cov}(X,Y)^{2}}{\\mathrm{Var}(X)}=5-\\frac{3^{2}}{9}=5-1=4.\n$$\n此外，这个最小化选择使得残差与 $X$ 不相关：\n$$\n\\mathrm{Cov}\\bigl(X,\\,Y-\\alpha_{0}X\\bigr)=\\mathrm{Cov}(X,Y)-\\alpha_{0}\\mathrm{Var}(X)=3-\\frac{1}{3}\\cdot 9=0.\n$$\n因此，对于 $V=(X,\\,Y-\\alpha_{0}X)^{T}$，协方差矩阵是对角的，\n$$\nK_{V}=\\begin{pmatrix} \\mathrm{Var}(X) & 0 \\\\ 0 & \\mathrm{Var}(Y-\\alpha_{0}X) \\end{pmatrix}=\\begin{pmatrix} 9 & 0 \\\\ 0 & 4 \\end{pmatrix},\n$$\n其行列式是对角元素的乘积：\n$$\n\\det(K_{V})=9\\cdot 4=36.\n$$\n作为一致性检验，注意到 $V=M W$，其中 $M=\\begin{pmatrix}1&0\\\\ -\\alpha_{0}&1\\end{pmatrix}$，因此 $K_{V}=M K_{W} M^{T}$，从而 $\\det(K_{V})=\\det(M)^{2}\\det(K_{W})=\\det(K_{W})=9\\cdot 5-3^{2}=36$，与直接计算的结果一致。", "answer": "$$\\boxed{36}$$", "id": "1294483"}]}