{"hands_on_practices": [{"introduction": "掌握贝叶斯定理的最佳方式莫过于亲身实践。这个经典的硬币问题是开启贝叶斯思维之旅的绝佳起点。它将引导你完成一次基本的贝叶斯更新：如何利用新观察到的证据（抛出正面）来更新你对初始情况（选中了一枚特殊硬币）的判断。通过这个练习，你将牢固掌握贝叶斯定理的核心计算机制。", "problem": "一个不透明的袋子里装着大量的硬币。硬币有两种类型：公平硬币和双面均为正面的硬币。一枚公平硬币有“正面”和“反面”两面，投掷时两面朝上的概率相等。一枚双面均为正面的硬币两面都是“正面”。\n\n袋中公平硬币的比例由参数 $p$ 给出，其中 $0 < p < 1$。因此，双面均为正面的硬币的比例是 $1-p$。\n\n某人从袋中随机抽取一枚硬币并投掷一次。观察到投掷结果为“正面”。\n\n根据这一观察结果，推导所选硬币是双面均为正面的硬币的概率的符号表达式。", "solution": "设 $TH$ 为选中的硬币是双面均为正面的硬币的事件，设 $F$ 为选中的硬币是公平硬币的事件。设 $H$ 为投掷结果为正面的事件。我们需要求解条件概率 $P(TH | H)$。\n\n根据问题描述，我们已知选择每种类型硬币的先验概率：\n$$\nP(F) = p\n$$\n$$\nP(TH) = 1 - p\n$$\n\n接下来，我们确定在给定所选硬币类型的情况下，观察到正面的条件概率。\n如果硬币是公平的，投掷出正面的概率是：\n$$\nP(H | F) = \\frac{1}{2}\n$$\n如果硬币是双面均为正面的，投掷出正面的概率是确定的：\n$$\nP(H | TH) = 1\n$$\n\n我们将使用贝叶斯定理来求解 $P(TH | H)$：\n$$\nP(TH | H) = \\frac{P(H | TH) P(TH)}{P(H)}\n$$\n\n为了使用此公式，我们首先需要计算观察到正面的总概率 $P(H)$。我们可以使用全概率公式，对所有可能的硬币类型求和来得到这个概率：\n$$\nP(H) = P(H | F)P(F) + P(H | TH)P(TH)\n$$\n\n将已知值代入此表达式：\n$$\nP(H) = \\left(\\frac{1}{2}\\right) (p) + (1) (1-p)\n$$\n$$\nP(H) = \\frac{p}{2} + 1 - p\n$$\n$$\nP(H) = 1 - \\frac{p}{2}\n$$\n$$\nP(H) = \\frac{2-p}{2}\n$$\n\n现在我们有了贝叶斯定理所需的所有部分。我们代入 $P(H | TH)$、$P(TH)$ 和 $P(H)$ 的表达式：\n$$\nP(TH | H) = \\frac{(1)(1 - p)}{\\frac{2-p}{2}}\n$$\n\n简化表达式得到最终结果：\n$$\nP(TH | H) = \\frac{2(1 - p)}{2 - p}\n$$", "answer": "$$\n\\boxed{\\frac{2(1 - p)}{2 - p}}\n$$", "id": "376"}, {"introduction": "在现实世界的推理中，我们常常需要整合来自不同来源的多条证据。这个练习将场景升级，探讨当有多位独立的目击者提供相同证词时，我们应如何更新我们的信任度。通过解决这个出租车事故的谜题 [@problem_id:691263]，你将学会如何定量地合并独立证据，并直观地感受到证据的一致性如何极大地增强我们对结论的信心。", "problem": "在一个城市里，有三家出租车公司在运营：Azure Autos、Crimson Cabs 和 Garnet Group。一名夜间肇事逃逸事故的目击者报告了涉事出租车的情况。由于光线条件不佳，目击者的证词并非完全可靠。该市的出租车队由 Azure Autos 公司（占比 $p_A$）、Crimson Cabs 公司（占比 $p_C$）和 Garnet Group 公司（占比 $p_G$）组成，其中 $p_A + p_C + p_G = 1$。\n\nAzure Autos 公司的出租车是独特的蓝色，而 Crimson Cabs 和 Garnet Group 公司的出租车是两种不同但容易混淆的红色。一项在类似条件下对目击者可靠性的调查确定了单个目击者报告的以下条件概率。设 $E$ 为目击者报告看到一辆 Azure Autos 公司出租车的事件。\n\n- 当出租车确实来自 Azure Autos 时，目击者正确报告为 Azure Autos 出租车的概率是 $P(E | \\text{Azure}) = \\alpha$。\n- 当出租车实际来自 Crimson Cabs 时，目击者错误地报告为 Azure Autos 出租车的概率是 $P(E | \\text{Crimson}) = \\delta$。\n- 当出租车实际来自 Garnet Group 时，目击者错误地报告为 Azure Autos 出租车的概率是 $P(E | \\text{Garnet}) = \\delta$。\n\n在所讨论的这起特定事件中，有两名独立的目击者在场，他们都报告说涉事出租车来自 Azure Autos。\n\n请根据两名独立目击者相同的证词，推导一个符号表达式，表示涉事出租车来自 Azure Autos 的后验概率。你的最终表达式应以参数 $p_A$、$\\alpha$ 和 $\\delta$ 表示。", "solution": "1. 根据贝叶斯定理，对于两名独立目击者报告 Azure Autos ($E_1,E_2$) 的情况：\n$$\nP(\\text{Azure}\\mid E_1,E_2)\n=\\frac{P(E_1,E_2\\mid \\text{Azure})\\,p_A}\n{P(E_1,E_2\\mid \\text{Azure})\\,p_A\n+P(E_1,E_2\\mid \\text{Crimson})\\,p_C\n+P(E_1,E_2\\mid \\text{Garnet})\\,p_G}\\,.\n$$\n2. 根据独立性可得\n$$P(E_1,E_2\\mid \\text{Azure})=\\alpha^2,\\quad\nP(E_1,E_2\\mid \\text{Crimson})=\\delta^2,\\quad\nP(E_1,E_2\\mid \\text{Garnet})=\\delta^2.\n$$\n3. 代入并使用 $p_C+p_G=1-p_A$：\n$$\nP(\\text{Azure}\\mid E_1,E_2)\n=\\frac{\\alpha^2\\,p_A}\n{\\alpha^2\\,p_A+\\delta^2\\,p_C+\\delta^2\\,p_G}\n=\\frac{\\alpha^2\\,p_A}{\\alpha^2\\,p_A+\\delta^2(1-p_A)}.\n$$", "answer": "$$\\boxed{\\frac{p_A \\alpha^2}{p_A \\alpha^2 + (1-p_A)\\delta^2}}$$", "id": "691263"}, {"introduction": "本练习将带你从计算后验概率迈向贝叶斯统计的一个核心应用：假设检验。在这里，我们不再仅仅是更新对单一事件的信念，而是要利用收集到的数据来裁决两个相互竞争的理论——骰子是公平的，还是被动了手脚？[@problem_id:691425] 这个过程将引入一个强大的工具——贝叶斯因子（Bayes factor），它衡量了数据证据对其中一个假设的支持程度，是进行模型选择和科学推断的基石。", "problem": "一位研究者正在分析一个六面骰子，以确定它是公平的还是有偏的。提出了两个相互竞争的假设：\n\n1.  **假设 $H_F$ (公平骰子)**：该骰子是公平的。掷出任何一面 $i \\in \\{1, 2, 3, 4, 5, 6\\}$ 的概率是恒定且相等的，即 $P(\\text{roll}=i|H_F) = 1/6$。\n\n2.  **假设 $H_L$ (有偏骰子)**：该骰子以特定方式被动了手脚。掷出“6”的概率是 $p$，而掷出其他五个面中任意一个的概率是均匀分布的，即 $P(\\text{roll}=6|H_L, p) = p$ 且对于 $i \\in \\{1, 2, 3, 4, 5\\}$ 有 $P(\\text{roll}=i|H_L, p) = (1-p)/5$。代表偏差的参数 $p$ 是未知的。关于 $p$ 的先验信念由 Beta 分布建模，即 $p \\sim \\text{Beta}(\\alpha_0, \\beta_0)$，其概率密度函数为：\n    $$f(p; \\alpha_0, \\beta_0) = \\frac{p^{\\alpha_0-1}(1-p)^{\\beta_0-1}}{B(\\alpha_0, \\beta_0)}$$\n    其中 $p \\in [0, 1]$。$B(x, y)$ 是 Beta 函数，定义为 $B(x, y) = \\frac{\\Gamma(x)\\Gamma(y)}{\\Gamma(x+y)}$，其中 $\\Gamma(\\cdot)$ 是 Gamma 函数。\n\n观测一个由 $N$ 次独立掷骰子组成的序列。将此数据集表示为 $D$。数据摘要显示，“6”出现了 $n_6$ 次，而除“6”以外的任何面总共出现了 $N - n_6$ 次。\n\n推导贝叶斯因子 $K = \\frac{P(D|H_L)}{P(D|H_F)}$ 的闭式表达式。该因子量化了数据支持有偏骰子假设相对于公平骰子假设的证据强度。用 $N$、$n_6$、$\\alpha_0$、$\\beta_0$ 和 Gamma 函数 $\\Gamma(\\cdot)$ 表示你的最终答案。", "solution": "我们比较每个假设下的边际似然。\n\n1. 在假设 $H_F$ 下，\n$$\nP(D\\mid H_F)\n=\\Bigl(\\tfrac{1}{6}\\Bigr)^N.\n$$\n\n2. 在假设 $H_L$ 下，先验为 $p\\sim \\mathrm{Beta}(\\alpha_0,\\beta_0)$，\n\n$$\nP(D\\mid p,H_L)\n= p^{\\,n_6}\\Bigl(\\tfrac{1-p}{5}\\Bigr)^{\\,N-n_6},\n\\quad\nf(p)=\\frac{p^{\\alpha_0-1}(1-p)^{\\beta_0-1}}{B(\\alpha_0,\\beta_0)}.\n$$\n\n因此\n\n$$\nP(D\\mid H_L)\n=\\int_0^1 p^{n_6}\\Bigl(\\tfrac{1-p}{5}\\Bigr)^{N-n_6}\n\\frac{p^{\\alpha_0-1}(1-p)^{\\beta_0-1}}{B(\\alpha_0,\\beta_0)}\\,dp\n= \\frac{5^{-(N-n_6)}}{B(\\alpha_0,\\beta_0)}\n\\int_0^1 p^{n_6+\\alpha_0-1}(1-p)^{\\,N-n_6+\\beta_0-1}dp.\n$$\n\n剩下的积分是一个 Beta 函数：\n$$\nP(D\\mid H_L)\n=\\frac{5^{-(N-n_6)}}{B(\\alpha_0,\\beta_0)}\\,\nB\\bigl(n_6+\\alpha_0,\\;N-n_6+\\beta_0\\bigr).\n$$\n\n3. 贝叶斯因子 $K=\\dfrac{P(D\\mid H_L)}{P(D\\mid H_F)}$ 为\n$$\nK\n=\\frac{5^{-(N-n_6)}\\,B(n_6+\\alpha_0,N-n_6+\\beta_0)}\n     {B(\\alpha_0,\\beta_0)}\\Big/\\Bigl(\\tfrac{1}{6}\\Bigr)^N\n=6^N\\,5^{\\,n_6-N}\\,\n\\frac{B(n_6+\\alpha_0,\\;N-n_6+\\beta_0)}{B(\\alpha_0,\\beta_0)}.\n$$\n\n4. 将 $B(x,y)=\\dfrac{\\Gamma(x)\\,\\Gamma(y)}{\\Gamma(x+y)}$ 代入，可得\n$$\nK\n=6^N\\,5^{\\,n_6-N}\\,\n\\frac{\\Gamma(n_6+\\alpha_0)\\,\\Gamma(N-n_6+\\beta_0)}\n     {\\Gamma(N+\\alpha_0+\\beta_0)}\n\\;\\frac{\\Gamma(\\alpha_0+\\beta_0)}\n     {\\Gamma(\\alpha_0)\\,\\Gamma(\\beta_0)}.\n$$", "answer": "$$\\boxed{6^N\\,5^{\\,n_6-N}\\;\\frac{\\Gamma(n_6+\\alpha_0)\\,\\Gamma(N-n_6+\\beta_0)}{\\Gamma(N+\\alpha_0+\\beta_0)}\\;\\frac{\\Gamma(\\alpha_0+\\beta_0)}{\\Gamma(\\alpha_0)\\,\\Gamma(\\beta_0)}}$$", "id": "691425"}]}