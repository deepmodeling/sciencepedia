{"hands_on_practices": [{"introduction": "真实的物理或生物系统常常受到随时间突然改变的外部输入的影响。本练习以药物动力学为背景，模拟了静脉输液速率中途改变后，患者血液中药物浓度的变化。通过求解这个初值问题 [@problem_id:2200526]，你将实践处理分段常数强迫函数的基本方法：分段求解并在连接点处确保解的连续性。", "problem": "一位患者正在接受一种通过静脉（IV）滴注给药的新药物治疗。药物在患者血液中的浓度 $C(t)$，以毫克/升 (mg/L) 为单位，可用以下一阶线性微分方程来建模：\n$$ \\frac{dC}{dt} + kC = f(t). $$\n此处，$t$ 是自输注开始以来的时间（单位为小时），$k$ 是药物从体内排出的恒定消除率（单位为 小时$^{-1}$），而 $f(t)$ 代表因输注而导致药物浓度增加的有效速率。最初，患者体内没有该药物。\n\n在第一个小时内，输注以 $r_0$（单位为 mg/L/hr）的恒定有效速率进行。一小时后，为了增强治疗效果，输注速率立即加倍。因此，有效速率函数 $f(t)$ 是一个分段函数，定义如下：\n$$ f(t) = \\begin{cases} r_0 & 0 \\le t \\le 1 \\\\ 2r_0 & t > 1 \\end{cases} $$\n假设药物浓度 $C(t)$ 是时间的连续函数，请求出对于所有 $t \\ge 0$，$C(t)$ 关于 $r_0$ 和 $k$ 的解析表达式。", "solution": "我们已知一阶线性常微分方程\n$$\n\\frac{dC}{dt} + k C = f(t),\n$$\n其初始条件为 $C(0)=0$，其中\n$$\nf(t) = \\begin{cases}\nr_0, & 0 \\le t \\le 1, \\\\\n2 r_0, & t > 1.\n\\end{cases}\n$$\n我们使用积分因子法在每个区间上求解。积分因子为 $\\mu(t)=\\exp\\!\\left(\\int k\\,dt\\right)=\\exp(k t)$，由此可得\n$$\n\\frac{d}{dt}\\big(C(t)\\exp(k t)\\big)=f(t)\\exp(k t).\n$$\n\n对于 $0 \\le t \\le 1$，我们有 $f(t)=r_0$。从 $0$ 到 $t$ 积分并使用 $C(0)=0$ 可得\n$$\nC(t)\\exp(k t)-C(0)=r_0\\int_{0}^{t}\\exp(k s)\\,ds=\\frac{r_0}{k}\\big(\\exp(k t)-1\\big),\n$$\n因此\n$$\nC(t)=\\frac{r_0}{k}\\big(1-\\exp(-k t)\\big), \\quad 0 \\le t \\le 1.\n$$\n\n对于 $t>1$，我们有 $f(t)=2 r_0$。为保证在 $t=1$ 处的连续性，我们从 $1$ 到 $t$ 积分：\n$$\nC(t)\\exp(k t)-C(1)\\exp(k\\cdot 1)=2 r_0\\int_{1}^{t}\\exp(k s)\\,ds=\\frac{2 r_0}{k}\\big(\\exp(k t)-\\exp(k)\\big).\n$$\n求解 $C(t)$ 可得\n$$\nC(t)=C(1)\\exp(-k(t-1))+\\frac{2 r_0}{k}\\big(1-\\exp(-k(t-1))\\big), \\quad t>1.\n$$\n使用第一个区间的值，\n$$\nC(1)=\\frac{r_0}{k}\\big(1-\\exp(-k)\\big),\n$$\n我们得到\n$$\nC(t)=\\frac{r_0}{k}\\big(1-\\exp(-k)\\big)\\exp(-k(t-1))+\\frac{2 r_0}{k}\\big(1-\\exp(-k(t-1))\\big), \\quad t>1.\n$$\n此表达式在 $t=1$ 处是连续的，因为将 $t=1$ 代入，两边均可得到 $C(1)=\\frac{r_0}{k}\\big(1-\\exp(-k)\\big)$。\n\n因此，对所有 $t \\ge 0$ 的分段解如上文所推导。", "answer": "$$\\boxed{C(t)=\\begin{cases}\\frac{r_0}{k}\\left(1-\\exp(-k t)\\right), & 0\\le t\\le 1, \\\\ \\frac{r_0}{k}\\left(1-\\exp(-k)\\right)\\exp(-k(t-1))+\\frac{2 r_0}{k}\\left(1-\\exp(-k(t-1))\\right), & t>1.\\end{cases}}$$", "id": "2200526"}, {"introduction": "接下来，我们来看一个RC电路问题，其中电压源由一个非标准形式的函数 $V(t) = \\min(4t, 12-2t)$ 给出。这类问题要求我们首先分析强迫函数，确定其分段的精确形式和切换点，然后再应用常微分方程的求解技术。这个练习 [@problem_id:2200506] 能够锻炼你分析和解释复杂函数形式的能力，并将其转化为标准的分段函数问题进行求解。", "problem": "考虑一个由电阻 $R = 100.0 \\, \\Omega$ 和电容 $C = 10.0 \\, \\text{mF}$ 组成的简单串联电路。该电路由一个时变电压源 $V(t)$ 驱动。电容器上的电荷 $Q(t)$ 由以下一阶线性常微分方程决定：\n$$R\\frac{dQ}{dt} + \\frac{1}{C}Q = V(t)$$\n对于时间 $t \\ge 0$，电压源由函数 $V(t) = \\min(4t, 12-2t)$ 定义，其中 $V$ 的单位是伏特， $t$ 的单位是秒。电容器初始未充电，即 $Q(0) = 0$。\n\n计算在时间 $t = 3.0$ 秒时电容器上的电荷。答案以库仑（C）为单位，并四舍五入到四位有效数字。", "solution": "控制方程是一个一阶线性常微分方程：\n$$R \\frac{dQ}{dt} + \\frac{1}{C} Q = V(t)。$$\n已知 $R = 100.0\\,\\Omega$ 和 $C = 10.0\\,\\text{mF} = 10.0 \\times 10^{-3}\\,\\text{F}$，我们得到 $RC = 1$。将此常微分方程两边同除以 $R$ 可得\n$$\\frac{dQ}{dt} + \\frac{1}{RC} Q = \\frac{V(t)}{R}，$$\n简化为\n$$\\frac{dQ}{dt} + Q = \\frac{V(t)}{R}。$$\n对于 $t \\ge 0$，$V(t) = \\min(4t,\\,12 - 2t)$。分段点在 $4t = 12 - 2t$ 处，即 $t = 2$。因此，\n- 对于 $0 \\le t \\le 2$：$V(t) = 4t$，所以 $\\frac{V(t)}{R} = \\frac{4t}{100} = 0.04\\,t$。\n- 对于 $t \\ge 2$：$V(t) = 12 - 2t$，所以 $\\frac{V(t)}{R} = \\frac{12 - 2t}{100} = 0.12 - 0.02\\,t$。\n\n在 $[0,2]$ 区间求解，初始条件为 $Q(0) = 0$。使用积分因子 $\\mu(t) = \\exp\\!\\left(\\int 1\\,dt\\right) = \\exp(t)$，\n$$(Q \\exp(t))' = 0.04\\,t\\,\\exp(t)。$$\n从 $0$ 到 $t \\in [0,2]$ 积分，并使用 $Q(0) = 0$，\n$$Q(t) \\exp(t) = \\int_{0}^{t} 0.04\\,s\\,\\exp(s)\\,ds。$$\n使用 $\\int s \\exp(s)\\,ds = (s - 1)\\exp(s)$，我们得到\n$$Q(t) \\exp(t) = 0.04\\left[(t - 1)\\exp(t) + 1\\right]，$$\n所以\n$$Q(t) = 0.04\\left[(t - 1) + \\exp(-t)\\right], \\quad 0 \\le t \\le 2。$$\n因此，\n$$Q(2) = 0.04\\left[1 + \\exp(-2)\\right]。$$\n\n在 $[2,3]$ 区间上，求解 $\\frac{dQ}{dt} + Q = 0.12 - 0.02\\,t$，初始条件为上述的 $Q(2)$。使用相同的积分因子，\n$$(Q \\exp(t))' = \\left(0.12 - 0.02\\,t\\right)\\exp(t)。$$\n从 $2$ 到 $t \\in [2,3]$ 积分：\n$$Q(t) \\exp(t) - Q(2)\\exp(2) = \\int_{2}^{t} \\left(0.12 - 0.02\\,s\\right)\\exp(s)\\,ds。$$\n计算积分：\n$$\\int \\left(0.12 - 0.02\\,s\\right)\\exp(s)\\,ds = \\exp(s)\\left(0.14 - 0.02\\,s\\right)，$$\n因此\n$$\\int_{2}^{t} \\left(0.12 - 0.02\\,s\\right)\\exp(s)\\,ds = \\exp(t)\\left(0.14 - 0.02\\,t\\right) - \\exp(2)\\left(0.10\\right)。$$\n所以，\n$$Q(t) = \\exp(-t)\\left[Q(2)\\exp(2) - 0.10\\,\\exp(2)\\right] + \\left(0.14 - 0.02\\,t\\right)。$$\n代入 $Q(2) = 0.04\\left[1 + \\exp(-2)\\right]$：\n$$Q(t) = \\exp(2 - t)\\left[-0.06 + 0.04\\,\\exp(-2)\\right] + \\left(0.14 - 0.02\\,t\\right)。$$\n当 $t = 3$ 时，\n$$Q(3) = 0.08 - 0.06\\,\\exp(-1) + 0.04\\,\\exp(-3)。$$\n数值计算结果为，\n$$Q(3) \\approx 0.08 - 0.06 \\times 0.3678794412 + 0.04 \\times 0.04978706837 \\approx 0.05991871626。$$\n四舍五入到四位有效数字，电荷为 $0.05992$ 库仑。", "answer": "$$\\boxed{0.05992}$$", "id": "2200506"}, {"introduction": "处理分段强迫函数的思想同样适用于高阶微分方程。这个练习探讨了一个二阶的弹簧-质量-阻尼系统，其受到的外力是利用亥维赛德阶跃函数 (Heaviside step function) 构建的一个有限时长的脉冲。通过解决这个问题 [@problem_id:2200483]，你将学会一种优雅而强大的方法，即利用线性和叠加原理，通过对一个基本响应函数进行时移和组合来构建对复杂输入的完整响应，这在工程和物理学中是一种非常重要的解题策略。", "problem": "正在分析一个机械致动器的运动。致动器末端执行器的位置（记为 $y(t)$，单位为米），相对于其平衡位置，由一个二阶线性常微分方程所描述。该致动器的有效质量为 $1$ kg，阻尼系数为 $3$ Ns/m，弹簧常数为 $2$ N/m。系统初始时在其平衡位置处于静止状态。\n\n在时间 $t=0$ 时，致动器受到一个时变外力 $F(t)$（单位：牛顿），其表达式为\n$$ F(t) = t^2 - (t-1)^2 u(t-1) $$\n其中 $t$ 是时间（单位：秒），$u(t-c)$ 是亥维赛阶跃函数，定义为当 $t < c$ 时 $u(t-c) = 0$，当 $t \\ge c$ 时 $u(t-c) = 1$。\n\n求出在所有 $t \\ge 0$ 的情况下，致动器的位置 $y(t)$。您的答案应为 $y(t)$ 的一个单一解析表达式。", "solution": "该运动由一个具有零初始条件的线性时不变二阶常微分方程描述：\n$$\ny''(t)+3y'(t)+2y(t)=F(t),\\quad y(0)=0,\\quad y'(0)=0,\n$$\n输入为\n$$\nF(t)=t^{2}-(t-1)^{2}u(t-1).\n$$\n从输入力到输出位置的传递函数是\n$$\nG(s)=\\frac{1}{s^{2}+3s+2}=\\frac{1}{(s+1)(s+2)},\n$$\n其脉冲响应是\n$$\nh(t)=\\mathcal{L}^{-1}\\{G(s)\\}= \\exp(-t)-\\exp(-2t),\\quad t\\ge 0.\n$$\n在零初始条件下，响应是卷积\n$$\ny(t)=(h*F)(t)=\\int_{0}^{t}h(t-\\tau)F(\\tau)\\,d\\tau.\n$$\n利用线性和亥维赛函数的时移性质，\n$$\nF(t)=t^{2}-(t-1)^{2}u(t-1)\\quad\\Rightarrow\\quad y(t)=y_{\\text{base}}(t)-u(t-1)\\,y_{\\text{base}}(t-1),\n$$\n其中\n$$\ny_{\\text{base}}(t)=(h*t^{2})(t)=\\int_{0}^{t}\\big(\\exp(-(t-\\tau))-\\exp(-2(t-\\tau))\\big)\\,\\tau^{2}\\,d\\tau.\n$$\n分别计算这两个积分。定义，对于常数 $a\\neq 0$，\n$$\nA(a,t)=\\int_{0}^{t}\\exp(a\\tau)\\tau^{2}\\,d\\tau.\n$$\n使用标准原函数\n$$\n\\int \\exp(a\\tau)\\tau^{2}\\,d\\tau=\\exp(a\\tau)\\left(\\frac{\\tau^{2}}{a}-\\frac{2\\tau}{a^{2}}+\\frac{2}{a^{3}}\\right)+C,\n$$\n我们得到\n$$\nA(a,t)=\\exp(at)\\left(\\frac{t^{2}}{a}-\\frac{2t}{a^{2}}+\\frac{2}{a^{3}}\\right)-\\frac{2}{a^{3}}.\n$$\n因此，\n$$\n\\int_{0}^{t}\\exp(-(t-\\tau))\\,\\tau^{2}\\,d\\tau=\\exp(-t)\\,A(1,t)=\\big(t^{2}-2t+2\\big)-2\\exp(-t),\n$$\n以及\n$$\n\\int_{0}^{t}\\exp(-2(t-\\tau))\\,\\tau^{2}\\,d\\tau=\\exp(-2t)\\,A(2,t)=\\left(\\frac{t^{2}}{2}-\\frac{t}{2}+\\frac{1}{4}\\right)-\\frac{1}{4}\\exp(-2t).\n$$\n所以，\n$$\ny_{\\text{base}}(t)=\\left(t^{2}-2t+2-2\\exp(-t)\\right)-\\left(\\frac{t^{2}}{2}-\\frac{t}{2}+\\frac{1}{4}-\\frac{1}{4}\\exp(-2t)\\right)\n=\\frac{1}{2}t^{2}-\\frac{3}{2}t+\\frac{7}{4}-2\\exp(-t)+\\frac{1}{4}\\exp(-2t).\n$$\n利用上面建立的时移性质，对于所有 $t\\ge 0$ 的完整响应是\n$$\ny(t)=y_{\\text{base}}(t)-u(t-1)\\,y_{\\text{base}}(t-1),\n$$\n即，\n$$\ny(t)=\\left(\\frac{1}{2}t^{2}-\\frac{3}{2}t+\\frac{7}{4}-2\\exp(-t)+\\frac{1}{4}\\exp(-2t)\\right)\n-u(t-1)\\left(\\frac{1}{2}(t-1)^{2}-\\frac{3}{2}(t-1)+\\frac{7}{4}-2\\exp(-(t-1))+\\frac{1}{4}\\exp(-2(t-1))\\right).\n$$\n这个单一的解析表达式满足该常微分方程和初始条件，并通过亥维赛函数解释了在 $t=1$ 时输入的变化。", "answer": "$$\\boxed{\\left(\\frac{1}{2}t^{2}-\\frac{3}{2}t+\\frac{7}{4}-2\\exp(-t)+\\frac{1}{4}\\exp(-2t)\\right)-u(t-1)\\left(\\frac{1}{2}(t-1)^{2}-\\frac{3}{2}(t-1)+\\frac{7}{4}-2\\exp(-(t-1))+\\frac{1}{4}\\exp(-2(t-1))\\right)}$$", "id": "2200483"}]}