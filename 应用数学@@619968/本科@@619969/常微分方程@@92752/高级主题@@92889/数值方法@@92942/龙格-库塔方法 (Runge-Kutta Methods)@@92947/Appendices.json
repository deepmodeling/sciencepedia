{"hands_on_practices": [{"introduction": "在深入研究更复杂的四阶方法之前，让我们先通过一个更简单的二阶技术来建立直观理解。休恩（Heun）方法，也称为改进欧拉法，通过“预测-校正”的策略显著提升了精度。这个练习 [@problem_id:2197374] 将引导你完成此过程，展示如何利用平均斜率来修正初始预测，从而获得更精确的最终结果。", "id": "2197374", "problem": "一个小型自主漫游车在一个平坦的表面上运行。其在y方向的速度分量，记为 $v(t)$，由一台机载计算机控制。该速度的变化率由以下常微分方程建模：\n$$ \\frac{dv}{dt} = \\cos(t) - 0.1 v^{2} $$\n其中 $v$ 是以米/秒 (m/s) 为单位的速度，$t$ 是以秒 (s) 为单位的时间。在其运行开始时，即时间 $t=0$ 时，测得漫游车的初始y向速度为 $v(0) = 2$ m/s。\n\n为了预测漫游车在未来短时间内的状态，控制系统使用数值近似法。使用Heun法（也称为改进欧拉法），计算在时间 $t=0.5$ s 时速度 $v$ 的一个近似值。使用大小为 $h=0.5$ 的单步进行此计算。\n\n假设所有三角函数的参数都以弧度为单位。以 m/s 为单位给出您的答案，并四舍五入到三位有效数字。", "solution": "我们将常微分方程的右侧定义为 $f(t,v)=\\cos(t)-0.1\\,v^{2}$。对于从 $(t_{0},v_{0})$ 到 $(t_{1},v_{1})$ 的一个大小为 $h$ 的步长，Heun法（改进欧拉法）使用以下公式\n$$\n\\tilde{v}=v_{0}+h\\,f(t_{0},v_{0}),\n$$\n$$\nv_{1}=v_{0}+\\frac{h}{2}\\left[f(t_{0},v_{0})+f(t_{1},\\tilde{v})\\right].\n$$\n给定 $t_{0}=0$，$v_{0}=2$ 和 $h=0.5$，首先计算\n$$\nf(t_{0},v_{0})=\\cos(0)-0.1\\,(2)^{2}=1-0.4=0.6.\n$$\n预测值：\n$$\n\\tilde{v}=2+0.5\\times 0.6=2.3.\n$$\n接下来计算在 $t_{1}=0.5$ 处的斜率：\n$$\nf(t_{1},\\tilde{v})=\\cos(0.5)-0.1\\,(2.3)^{2}=\\cos(0.5)-0.529.\n$$\n使用 $\\cos(0.5)\\approx 0.877582562$，我们得到\n$$\nf(t_{1},\\tilde{v})\\approx 0.877582562-0.529=0.348582562.\n$$\n现在应用校正公式：\n$$\nv_{1}=2+\\frac{0.5}{2}\\left(0.6+0.348582562\\right)=2+0.25\\times 0.948582562\\approx 2.2371456405.\n$$\n四舍五入到三位有效数字，得到 $v(0.5)\\approx 2.24$。", "answer": "$$\\boxed{2.24}$$"}, {"introduction": "四阶龙格-库塔（RK4）方法因其在精度和计算效率之间的绝佳平衡，已成为常微分方程数值求解的主力。这个练习 [@problem_id:2197363] 是一项基础训练，旨在帮助你熟练掌握RK4算法的四个步骤。通过仔细计算中间斜率（$k_1, k_2, k_3, k_4$），你将掌握将这一强大方法应用于各种科学和工程问题的核心技能。", "id": "2197363", "problem": "考虑由微分方程 $y' = \\frac{x}{y}$ 定义的初值问题，其初始条件为 $y(1) = 2$。\n\n您的任务是应用单步四阶Runge-Kutta (RK4)方法来近似计算 $y(1.1)$ 的值。对于一个微分方程 $y' = f(x, y)$ 和步长 $h$，RK4方法使用以下公式从当前值 $y_n$ 计算出下一个值 $y_{n+1}$：\n\n$y_{n+1} = y_n + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)$\n\n其中\n\n$k_1 = f(x_n, y_n)$\n$k_2 = f(x_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_1)$\n$k_3 = f(x_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_2)$\n$k_4 = f(x_n + h, y_n + h k_3)$\n\n计算 $y(1.1)$ 的数值近似值，并将最终答案四舍五入到五位有效数字。", "solution": "问题要求使用四阶Runge-Kutta (RK4)方法，对初始条件为 $y(1) = 2$ 的常微分方程 $y' = \\frac{x}{y}$，进行单步近似以求解 $y(1.1)$。\n\n首先，我们确定RK4公式所需的各个组成部分。\n函数为 $f(x, y) = \\frac{x}{y}$。\n初始点为 $(x_0, y_0) = (1, 2)$。\n我们想要求解 $y$ 在 $x_1 = 1.1$ 处的值。这意味着我们取单步，步长为 $h = x_1 - x_0 = 1.1 - 1.0 = 0.1$。\n\n现在，我们计算四个中间斜率 $k_1, k_2, k_3, k_4$。\n\n第1步：计算 $k_1$。\n$k_1 = f(x_0, y_0) = f(1, 2) = \\frac{1}{2} = 0.5$。\n\n第2步：计算 $k_2$。\n$k_2$ 的计算点是 $(x_0 + \\frac{h}{2}, y_0 + \\frac{h}{2}k_1)$。\n$x_0 + \\frac{h}{2} = 1 + \\frac{0.1}{2} = 1.05$。\n$y_0 + \\frac{h}{2}k_1 = 2 + \\frac{0.1}{2}(0.5) = 2 + 0.05(0.5) = 2 + 0.025 = 2.025$。\n所以，$k_2 = f(1.05, 2.025) = \\frac{1.05}{2.025}$。\n该分数为 $\\frac{1050}{2025} = \\frac{42 \\times 25}{81 \\times 25} = \\frac{42}{81} = \\frac{14}{27}$。\n写成小数形式，$k_2 \\approx 0.5185185185...$。\n\n第3步：计算 $k_3$。\n$k_3$ 的计算点是 $(x_0 + \\frac{h}{2}, y_0 + \\frac{h}{2}k_2)$。\nx坐标与 $k_2$ 的相同：$1.05$。\n$y_0 + \\frac{h}{2}k_2 = 2 + \\frac{0.1}{2} \\left(\\frac{14}{27}\\right) = 2 + 0.05 \\left(\\frac{14}{27}\\right) = 2 + \\frac{1}{20}\\frac{14}{27} = 2 + \\frac{7}{270} = \\frac{540+7}{270} = \\frac{547}{270}$。\n所以，$k_3 = f\\left(1.05, \\frac{547}{270}\\right) = \\frac{1.05}{547/270} = \\frac{21/20}{547/270} = \\frac{21}{20} \\cdot \\frac{270}{547} = \\frac{21 \\cdot 27}{2 \\cdot 547} = \\frac{567}{1094}$。\n写成小数形式，$k_3 \\approx 0.5182815356...$。\n\n第4步：计算 $k_4$。\n$k_4$ 的计算点是 $(x_0 + h, y_0 + h k_3)$。\n$x_0 + h = 1 + 0.1 = 1.1$。\n$y_0 + h k_3 = 2 + 0.1 \\left(\\frac{567}{1094}\\right) = 2 + \\frac{567}{10940} = \\frac{21880+567}{10940} = \\frac{22447}{10940}$。\n所以，$k_4 = f\\left(1.1, \\frac{22447}{10940}\\right) = \\frac{1.1}{22447/10940} = \\frac{11/10}{22447/10940} = \\frac{11}{10} \\cdot \\frac{10940}{22447} = \\frac{11 \\cdot 1094}{22447} = \\frac{12034}{22447}$。\n写成小数形式，$k_4 \\approx 0.536107275...$。\n\n第5步：计算最终的近似值 $y_1$。\n$y_1 = y_0 + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)$。\n为了清晰起见，使用小数近似值（同时在计算中保持高精度）：\n$y_1 \\approx 2 + \\frac{0.1}{6}(0.5 + 2(0.5185185185) + 2(0.5182815356) + 0.536107275)$。\n$y_1 \\approx 2 + \\frac{0.1}{6}(0.5 + 1.037037037 + 1.0365630712 + 0.536107275)$。\n$y_1 \\approx 2 + \\frac{0.1}{6}(3.1097073832)$。\n$y_1 \\approx 2 + 0.05182845638...$。\n$y_1 \\approx 2.05182845638...$。\n\n最后，我们将结果四舍五入到五位有效数字。前五位有效数字是2、0、5、1、8。后一位数字是2，小于5，所以我们向下舍入（即，不改变最后一位数字）。\n$y(1.1) \\approx 2.0518$。", "answer": "$$\\boxed{2.0518}$$"}, {"introduction": "我们已经学习了如何实现RK4方法，但一个关键问题仍然存在：它的精确度究竟有多高？这个练习 [@problem_id:2197360] 将通过一个我们已知其精确解析解的基准问题，来直接回答这个问题。通过计算绝对误差，你将具体地体会到RK4方法惊人的高精度，即便是在步长相对较大的情况下也是如此，从而理解它为何在科学计算中广受信赖。", "id": "2197360", "problem": "在许多物理和生物系统中，某个量的变化率与该量本身成正比。这可以用一阶常微分方程 (ODE) $y'(t) = \\lambda y(t)$ 来描述，该方程可用于模拟放射性衰变或简单种群增长等现象。虽然这个特定的常微分方程有一个直接的解析解，但它常被用作检验数值方法准确性的基准。\n\n考虑如下给出的初值问题：\n$$\ny'(t) = \\lambda y(t), \\quad y(0) = y_0\n$$\n\n我们希望使用经典的四阶龙格-库塔 (RK4) 方法，通过单步计算来近似求解在时间 $t=h$ 时的解。RK4 方法根据当前值 $y_0 = y(0)$，通过以下步骤计算下一个值 $y_1 \\approx y(h)$：\n- $k_1 = f(t_0, y_0)$\n- $k_2 = f(t_0 + \\frac{h}{2}, y_0 + \\frac{h}{2} k_1)$\n- $k_3 = f(t_0 + \\frac{h}{2}, y_0 + \\frac{h}{2} k_2)$\n- $k_4 = f(t_0 + h, y_0 + h k_3)$\n- $y_1 = y_0 + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)$\n\n其中 $f(t,y) = y'(t) = \\lambda y(t)$，$t_0=0$，$h$ 为步长。\n\n给定具体参数 $\\lambda = 2$，$y_0 = 1$，步长 $h = 0.1$，请计算 RK4 近似法单步计算后的绝对误差。绝对误差定义为 $|y(h) - y_1|$。\n\n将您的最终答案四舍五入到四位有效数字。", "solution": "我们求解初值问题 $y'(t)=\\lambda y(t)$，其中 $y(0)=y_{0}$。通过分离变量法得到其精确解：\n$$\n\\frac{y'(t)}{y(t)}=\\lambda \\quad \\Rightarrow \\quad \\ln|y(t)|=\\lambda t + C \\quad \\Rightarrow \\quad y(t)=C_{1}\\exp(\\lambda t).\n$$\n使用 $y(0)=y_{0}$ 可得 $C_{1}=y_{0}$，因此\n$$\ny(h)=y_{0}\\exp(\\lambda h).\n$$\n对于 RK4 方法的计算步骤，其中 $f(t,y)=\\lambda y$，$t_{0}=0$，我们计算\n$$\nk_{1}=f(t_{0},y_{0})=\\lambda y_{0}, \\quad\nk_{2}=f\\!\\left(t_{0}+\\frac{h}{2},\\,y_{0}+\\frac{h}{2}k_{1}\\right)=\\lambda\\left(y_{0}+\\frac{h}{2}k_{1}\\right),\n$$\n$$\nk_{3}=f\\!\\left(t_{0}+\\frac{h}{2},\\,y_{0}+\\frac{h}{2}k_{2}\\right)=\\lambda\\left(y_{0}+\\frac{h}{2}k_{2}\\right), \\quad\nk_{4}=f(t_{0}+h,\\,y_{0}+hk_{3})=\\lambda\\left(y_{0}+hk_{3}\\right).\n$$\n然后\n$$\ny_{1}=y_{0}+\\frac{h}{6}\\left(k_{1}+2k_{2}+2k_{3}+k_{4}\\right).\n$$\n代入给定值 $\\lambda=2$，$y_{0}=1$，$h=0.1$，我们进行计算\n$$\nk_{1}=2\\cdot 1=2,\\quad\nk_{2}=2\\left(1+\\frac{0.1}{2}\\cdot 2\\right)=2.2,\\quad\nk_{3}=2\\left(1+\\frac{0.1}{2}\\cdot 2.2\\right)=2.22,\\quad\nk_{4}=2\\left(1+0.1\\cdot 2.22\\right)=2.444.\n$$\n因此\n$$\ny_{1}=1+\\frac{0.1}{6}\\left(2+2\\cdot 2.2+2\\cdot 2.22+2.444\\right)\n=1+\\frac{0.1}{6}\\cdot 13.284=1+0.2214=1.2214.\n$$\n$t=h$ 时的精确值为\n$$\ny(h)=\\exp(\\lambda h)=\\exp(0.2).\n$$\n因此，单步 RK4 计算后的绝对误差为\n$$\n|y(h)-y_{1}|=\\left|\\exp(0.2)-1.2214\\right|.\n$$\n使用高精度值 $\\exp(0.2)=1.221402758160169\\ldots$，我们得到\n$$\n|y(h)-y_{1}|=1.221402758160169-1.2214=2.7581601698339\\times 10^{-6}.\n$$\n四舍五入到四位有效数字，结果为 $2.758\\times 10^{-6}$。", "answer": "$$\\boxed{2.758 \\times 10^{-6}}$$"}]}