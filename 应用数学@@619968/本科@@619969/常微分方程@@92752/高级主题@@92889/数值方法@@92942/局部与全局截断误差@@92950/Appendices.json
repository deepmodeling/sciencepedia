{"hands_on_practices": [{"introduction": "要真正掌握数值方法的精度，首先必须学会如何量化其在单步计算中引入的误差。本练习将引导您完成一项基本技能：为给定的常微分方程（ODE）计算前向欧拉法的局部截断误差。通过运用泰勒级数展开，您将亲自推导出误差的主导项，从而理解步长 $h$ 和方程本身性质（如此处的非线性项 $\\alpha y^2$）是如何共同决定单步误差的大小的 [@problem_id:2185077]。", "problem": "考虑由下式给出的自治常微分方程 (ODE)：\n$$ \\frac{dy}{dt} = \\alpha y^{2} $$\n其中 $\\alpha$ 是一个非零参数。该方程将使用前向欧拉法进行数值求解，该方法使用以下公式将解从时间 $t_n$ 推进到 $t_{n+1} = t_n + h$：\n$$ y_{n+1} = y_n + h f(t_n, y_n) $$\n此处，$h$ 是恒定步长，$y_n$ 是精确解 $y(t)$ 在时间 $t_n$ 处的数值近似。\n\n局部截断误差（单位步长）记为 $\\tau_{n+1}$，它量化了假设起始值精确的情况下，该方法单步引入的误差。其定义为：\n$$ \\tau_{n+1} = \\frac{y(t_{n+1}) - y_{n+1}^{\\text{Euler}}}{h} $$\n其中 $y(t)$ 是通过点 $(t_n, y(t_n))$ 的常微分方程的精确解，而 $y_{n+1}^{\\text{Euler}}$ 是从该精确点开始，通过前向欧拉法单步计算得到的值，即 $y_{n+1}^{\\text{Euler}} = y(t_n) + h f(t_n, y(t_n))$。\n\n确定此方法和常微分方程的局部截断误差 $\\tau_{n+1}$ 的主项。主项是当 $h \\to 0$ 时，关于 $h$ 的最低阶项。请用 $\\alpha$、$h$ 和 $y(t_n)$ 来符号化地表示你的答案。", "solution": "目标是求出前向欧拉法应用于常微分方程(ODE) $y' = \\alpha y^2$ 时的局部截断误差 (LTE) 的主项。\n\n单位步长的局部截断误差的定义如下：\n$$ \\tau_{n+1} = \\frac{y(t_{n+1}) - y_{n+1}^{\\text{Euler}}}{h} $$\n此处我们假设计算从时间 $t_n$ 处的一个精确值开始，因此欧拉步由 $y_{n+1}^{\\text{Euler}} = y(t_n) + h f(t_n, y(t_n))$ 给出。项 $y(t_{n+1})$ 表示在时间 $t_{n+1} = t_n + h$ 处求值的精确解。\n\n首先，我们从给定的常微分方程中确定函数 $f(t,y)$：\n$$ \\frac{dy}{dt} = \\alpha y^{2} \\implies f(t,y) = \\alpha y^{2} $$\n因此，从精确解 $y(t_n)$ 开始的前向欧拉法单步计算为：\n$$ y_{n+1}^{\\text{Euler}} = y(t_n) + h (\\alpha y(t_n)^2) $$\n\n接下来，我们使用泰勒级数展开，将精确解 $y(t)$ 在点 $t_n$ 附近展开至关于 $h$ 的二阶项：\n$$ y(t_{n+1}) = y(t_n + h) = y(t_n) + h y'(t_n) + \\frac{h^2}{2} y''(t_n) + O(h^3) $$\n其中 $y'(t_n)$ 和 $y''(t_n)$ 是精确解在 $t=t_n$ 处求值的一阶和二阶导数。\n\n现在，我们将泰勒展开式和前向欧拉步都代入 LTE 的定义中：\n$$ \\tau_{n+1} = \\frac{1}{h} \\left[ \\left( y(t_n) + h y'(t_n) + \\frac{h^2}{2} y''(t_n) + O(h^3) \\right) - \\left( y(t_n) + h \\alpha y(t_n)^2 \\right) \\right] $$\n\n从常微分方程本身，我们知道 $y'(t) = \\alpha y(t)^2$。在 $t_n$ 处求值得 $y'(t_n) = \\alpha y(t_n)^2$。我们可以将其代入 $\\tau_{n+1}$ 的表达式中：\n$$ \\tau_{n+1} = \\frac{1}{h} \\left[ \\left( y(t_n) + h (\\alpha y(t_n)^2) + \\frac{h^2}{2} y''(t_n) + O(h^3) \\right) - \\left( y(t_n) + h \\alpha y(t_n)^2 \\right) \\right] $$\n\n项 $y(t_n)$ 和 $h \\alpha y(t_n)^2$ 相互抵消：\n$$ \\tau_{n+1} = \\frac{1}{h} \\left[ \\frac{h^2}{2} y''(t_n) + O(h^3) \\right] $$\n$$ \\tau_{n+1} = \\frac{h}{2} y''(t_n) + O(h^2) $$\n\n为了找到主项，我们需要计算 $y''(t_n)$。我们使用链式法则对常微分方程 $y'(t) = \\alpha y(t)^2$ 关于 $t$ 求导：\n$$ y''(t) = \\frac{d}{dt} \\left( \\alpha y(t)^2 \\right) = \\alpha \\cdot 2 y(t) \\cdot y'(t) $$\n现在，我们将 $y'(t)$ 的表达式代回该方程：\n$$ y''(t) = 2 \\alpha y(t) \\left( \\alpha y(t)^2 \\right) = 2 \\alpha^2 y(t)^3 $$\n在 $t_n$ 处求值得：\n$$ y''(t_n) = 2 \\alpha^2 y(t_n)^3 $$\n\n最后，我们将 $y''(t_n)$ 的这个表达式代入我们关于 $\\tau_{n+1}$ 的方程中：\n$$ \\tau_{n+1} = \\frac{h}{2} \\left( 2 \\alpha^2 y(t_n)^3 \\right) + O(h^2) $$\n$$ \\tau_{n+1} = \\alpha^2 h y(t_n)^3 + O(h^2) $$\n\n局部截断误差的主项是当 $h \\to 0$ 时展开式中的首项，也就是 $h$ 的最低次幂项。在本例中，该项为 $\\alpha^2 h y(t_n)^3$。", "answer": "$$\\boxed{\\alpha^{2} h y(t_n)^{3}}$$", "id": "2185077"}, {"introduction": "在掌握了如何计算局部截断误差之后，检查我们对误差来源的根本理解至关重要。这个练习通过一个常见的学生误解来挑战您的概念认知 [@problem_id:2185054]。欧拉法在本质上是用切线来近似真实的解曲线，因此，只有当真实解本身就是一条直线时，这种近似才是精确无误的。通过分析为何对于 $y'(t)=t$ 这样简单的方程，欧拉法仍然会产生误差，您将深化对“近似”与“精确”之间差异的理解。", "problem": "一名学生正在分析常微分方程 (ODE) $y'(t) = t$，其初始条件为 $y(t_0) = y_0$ 的数值解。该学生使用欧拉方法，其数值解通过公式 $y_{n+1} = y_n + h f(t_n, y_n)$ 从第 $n$ 步推进到第 $n+1$ 步，其中 $h$ 是步长且 $f(t,y) = y'(t)$。对于这个特定的 ODE，迭代格式变为 $y_{n+1} = y_n + h t_n$。\n\n该学生断言如下：“局部截断误差，即在单步中引入的误差，对于这个特定的 ODE 可以精确地为零。由于迭代格式 $y_n + h t_n$ 对 $t_n$ 是纯线性的，并且函数 $f(t,y)=t$ 也是线性的，因此没有需要近似的高阶行为。所以，近似必定是精确的，局部截断误差为零。”\n\n这个推理是有缺陷的。下列哪个陈述为该学生的论断错误提供了最准确和最根本的解释？\n\nA. 该学生混淆了局部截断误差和全局截断误差。全局误差是多步累积的，它从不为零，但对于这个 ODE，局部误差在每一步确实为零。\n\nB. 该论断是错误的，因为局部截断误差包含了浮点运算的贡献。即使理论误差为零，计算中的舍入误差在实践中也会使其非零。\n\nC. 欧拉方法的局部截断误差仅在 ODE 的真解是 $t$ 的线性函数时才为零。对于 ODE $y'(t)=t$，其真解是一个二次函数。\n\nD. 任何有限阶的数值方法，例如一阶的欧拉方法，对于任何解不是常数的 ODE，其局部截断误差总是非零的。", "solution": "我们来分析欧拉方法对于 ODE $y'(t)=t$，$y(t_{0})=y_{0}$ 的局部截断误差 (LTE)。\n\n1) 精确解与单步精确增量：\n对 $y'(t)=t$ 积分，得到精确解\n$$\ny(t)=y_{0}+\\frac{1}{2}\\left(t^{2}-t_{0}^{2}\\right).\n$$\n在从 $t_{n}$ 到 $t_{n+1}=t_{n}+h$ 的单个步长内，精确增量为\n$$\ny(t_{n+1})-y(t_{n})=\\frac{1}{2}\\left((t_{n}+h)^{2}-t_{n}^{2}\\right)=t_{n}h+\\frac{1}{2}h^{2}.\n$$\n\n2) 欧拉方法的增量：\n欧拉方法给出\n$$\ny_{n+1}=y_{n}+h f(t_{n},y_{n})=y_{n}+h t_{n}.\n$$\n如果我们从精确值 $y(t_{n})$ 出发，该方法的单步增量为 $h t_{n}$。\n\n3) 局部截断误差：\n使用标准的（未缩放的）残差定义，\n$$\n\\text{LTE}_{n+1}=y(t_{n+1})-y(t_{n})-h f(t_{n},y(t_{n}))=\\left(t_{n}h+\\frac{1}{2}h^{2}\\right)-h t_{n}=\\frac{1}{2}h^{2}\\neq 0.\n$$\n等价地，使用关于 $t_{n}$ 的泰勒定理，\n$$\ny(t_{n}+h)=y(t_{n})+h y'(t_{n})+\\frac{1}{2}h^{2}y''(\\xi_{n})\n$$\n对于某个 $\\xi_{n}\\in[t_{n},t_{n}+h]$。此处 $y'(t)=t$ 且 $y''(t)=1$，因此余项精确地为 $\\frac{1}{2}h^{2}$。因此，只匹配到一阶项 $h y'(t_{n})$ 的欧拉方法，具有一个 $h^{2}$ 阶的非零 LTE。\n\n4) 该学生论断错误的概念性原因：\n欧拉方法的 LTE 仅在精确解是 $t$ 的线性函数时才为零，这样才能使得 $y''\\equiv 0$ 并且二阶项消失。对于 $y'(t)=t$，其精确解 $y(t)$ 是 $t$ 的二次函数，有 $y''(t)=1\\neq 0$，因此局部截断误差不可能为零。\n\n因此，选项中最准确和最根本的解释是，欧拉方法的 LTE 仅在真解是 $t$ 的线性函数时才为零，而对于 $y'(t)=t$ 来说，情况并非如此。因此选项 C 是正确的。其他选项是错误的：A 错误地断言此处的 LTE 为零；B 混淆了理论截断误差和舍入误差；D 的论断过于绝对，因为更高阶的方法（例如，梯形法则）对于某些非恒定解（如此例）可以是精确的。", "answer": "$$\\boxed{C}$$", "id": "2185054"}, {"introduction": "局部截断误差描述的是单步表现，但我们最终关心的是在整个求解区间上累积产生的全局误差。本练习将视角从“局部”转向“全局”，探讨方法阶数对最终精度的实际影响 [@problem_id:2185101]。通过这个思想实验，您将看到一个二阶方法的全局误差 $\\epsilon$ 是如何随着步长 $h$ 的改变而变化的，这揭示了数值分析中的一个核心原则：方法阶数 $p$ 决定了全局误差与步长之间的幂律关系，即 $E \\propto h^p$。", "problem": "一位数值分析学家正在研究一种用于在固定区间上求解常微分方程的稳定数值方法的精度。已知该方法是一种二阶方法。在第一次计算实验中，该分析学家使用常数步长 $h$ 计算其解，并发现区间末端的全局截断误差约为 $\\epsilon$。\n\n在第二次实验中，该分析学家决定将步长改为 $2h$，同时保持所有其他参数和微分方程不变。假设该方法保持稳定，并且全局误差与步长之间的关系在此范围内成立，那么第二次实验的估计全局截断误差是多少？\n\nA. $\\frac{\\epsilon}{4}$\n\nB. $\\frac{\\epsilon}{2}$\n\nC. $\\epsilon$\n\nD. $2\\epsilon$\n\nE. $4\\epsilon$", "solution": "对于一个 $p$ 阶的稳定方法，在固定的最终时间点，其全局截断误差满足 $E(h)=C h^{p}$ 的关系，其中 $C$ 是一个不依赖于 $h$ 的常数，前提是该方法保持稳定且渐近误差关系成立。\n\n已知该方法是二阶的，所以 $p=2$。对于步长 $h$，观测到的全局误差为 $\\epsilon$，因此\n$$\n\\epsilon = C h^{2}.\n$$\n如果步长变为 $2h$，新的全局误差为\n$$\nE(2h) = C (2h)^{2} = 4 C h^{2} = 4 \\epsilon.\n$$\n因此，将步长加倍会使全局误差乘以 $4$，这对应于选项 E。", "answer": "$$\\boxed{E}$$", "id": "2185101"}]}