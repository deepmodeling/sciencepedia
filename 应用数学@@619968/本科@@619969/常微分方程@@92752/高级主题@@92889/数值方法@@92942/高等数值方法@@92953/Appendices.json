{"hands_on_practices": [{"introduction": "当我们从像前向欧拉法这样的显式方法转向更高级的数值技术时，我们经常会遇到隐式方法。与直接计算下一时间步值的显式方法不同，隐式方法（如后向欧拉法）通过求解一个代数方程来确定下一时间步的值。这个练习将让你亲身体验这个核心区别，通过为给定的非线性常微分方程构建后向欧拉法所需的方程，从而揭示隐式方法在提供卓越稳定性的同时所带来的计算挑战。[@problem_id:2158994]", "problem": "考虑由常微分方程 $y'(x) = \\sin(y(x)) + x$ 给出的非线性初值问题。我们希望使用一个固定步长为 $h$ 的数值格式来寻找其近似解。定义域中的离散点记为 $x_n$，其对应的解 $y(x_n)$ 的数值近似记为 $y_n$。\n\n后向欧拉法是求解此类问题的一种隐式方法，其迭代公式定义为：\n$$y_{n+1} = y_n + h f(x_{n+1}, y_{n+1})$$\n其中 $f(x, y)$ 是定义导数的函数，即 $y'(x) = f(x, y(x))$。\n\n对于给定的具体常微分方程，应用后向欧拉公式会得到一个关于 $y_{n+1}$ 的隐式方程。该方程可以通过代数整理变为以下形式：\n$$y_{n+1} - h \\sin(y_{n+1}) = E(y_n, x_{n+1}, h)$$\n确定 $E(y_n, x_{n+1}, h)$ 的表达式。", "solution": "我们给定的初值问题的导数函数为 $f(x,y)=\\sin(y)+x$。步长为 $h$ 的后向欧拉法定义为\n$$\ny_{n+1}=y_{n}+h\\,f(x_{n+1},y_{n+1}).\n$$\n将 $f(x,y)=\\sin(y)+x$ 代入可得\n$$\ny_{n+1}=y_{n}+h\\big(\\sin(y_{n+1})+x_{n+1}\\big).\n$$\n整理各项，将包含 $y_{n+1}$ 的隐式项移到等式左边，可得\n$$\ny_{n+1}-h\\sin(y_{n+1})=y_{n}+h\\,x_{n+1}.\n$$\n与形式 $y_{n+1}-h\\sin(y_{n+1})=E(y_{n},x_{n+1},h)$ 比较，我们确定\n$$\nE(y_{n},x_{n+1},h)=y_{n}+h\\,x_{n+1}.\n$$", "answer": "$$\\boxed{y_{n}+h\\,x_{n+1}}$$", "id": "2158994"}, {"introduction": "多步法，如 Adams-Bashforth (AB) 方法，因其通过重用先前步长的信息而具有计算效率，在数值分析中备受青睐。然而，它们存在一个固有的“启动”问题：要计算第 $n+1$ 步，你需要前面几步的数据，但这些数据在开始时是不可用的。本练习将引导你完成一个非常实用的混合计算程序，即使用高精度的单步法（如四阶龙格-库塔法）来生成必要的初始值，然后切换到高效的 Adams-Bashforth 方法继续求解。[@problem_id:2158977]", "problem": "考虑由以下常微分方程定义的初值问题 (IVP)：\n$$\ny'(t) = t - y(t)^2\n$$\n初始条件为 $y(0) = 1$。\n\n您的任务是近似计算 $y(t)$ 在 $t=0.3$ 处的值。请使用固定步长 $h=0.1$。为求得此解，您必须采用一种混合数值方法。首先，从 $t=0$ 处的初始条件开始，使用经典的四阶龙格-库塔 (RK4) 方法连续执行两步，以求得 $y(0.1)$ 和 $y(0.2)$ 的近似值。然后，应用一步两步亚当斯-巴什福特 (AB2) 方法，求得 $y(0.3)$ 的最终近似值。\n\n对于一个通用的一阶常微分方程 $y' = f(t, y)$，所用方法的公式如下：\n\n- **经典的四阶龙格-库塔 (RK4) 方法：**\n  $y_{n+1} = y_n + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)$\n  其中\n  $k_1 = f(t_n, y_n)$\n  $k_2 = f(t_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_1)$\n  $k_3 = f(t_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_2)$\n  $k_4 = f(t_n + h, y_n + h k_3)$\n\n- **两步亚当斯-巴什福特 (AB2) 方法：**\n  $y_{n+2} = y_{n+1} + \\frac{h}{2}\\left(3f(t_{n+1}, y_{n+1}) - f(t_n, y_n)\\right)$\n\n请报告您计算出的 $y(0.3)$ 的最终近似数值，结果需四舍五入至五位有效数字。", "solution": "给定初值问题 $y'(t)=f(t,y)=t-y^{2}$，其中 $y(0)=1$，步长 $h=0.1$。我们必须先进行两步 RK4 计算以获得 $y(0.1)$ 和 $y(0.2)$，然后进行一步 AB2 计算以获得 $y(0.3)$。\n\n第一步 RK4：从 $t_{0}=0, y_{0}=1$ 到 $t_{1}=0.1$：\n计算\n$$\nk_{1}=f(0,1)=0-1=-1,\n$$\n$$\nk_{2}=f\\!\\left(0.05,\\,1+\\frac{h}{2}k_{1}\\right)=f(0.05,\\,1-0.05)=0.05-(0.95)^{2}=0.05-0.9025=-0.8525,\n$$\n$$\nk_{3}=f\\!\\left(0.05,\\,1+\\frac{h}{2}k_{2}\\right)=f(0.05,\\,1+0.05\\cdot(-0.8525))=f(0.05,\\,0.957375)=0.05-(0.957375)^{2}.\n$$\n由于 $(0.957375)^{2}=0.916566890625$，我们得到 $k_{3}=0.05-0.916566890625=-0.866566890625$。\n接着，\n$$\nk_{4}=f\\!\\left(0.1,\\,1+h\\,k_{3}\\right)=f(0.1,\\,1+0.1\\cdot(-0.866566890625))=f(0.1,\\,0.9133433109375)=0.1-(0.9133433109375)^{2}.\n$$\n利用 $(0.9133433109375)^{2}=0.8341960036362748$，我们得到 $k_{4}=0.1-0.8341960036362748=-0.7341960036362748$。\n因此，\n$$\ny_{1}=y_{0}+\\frac{h}{6}\\left(k_{1}+2k_{2}+2k_{3}+k_{4}\\right)\n=1+\\frac{0.1}{6}\\left(-1-1.705-1.73313378125-0.7341960036362748\\right),\n$$\n所以\n$$\ny_{1}=1+\\frac{0.1}{6}\\left(-5.172329784886275\\right)=1-0.08620549641477125=0.9137945035852288.\n$$\n\n第二步 RK4：从 $t_{1}=0.1, y_{1}=0.9137945035852288$ 到 $t_{2}=0.2$：\n计算\n$$\nk_{1}'=f(t_{1},y_{1})=0.1-y_{1}^{2}.\n$$\n当 $y_{1}^{2}=0.8350203947825746$ 时，可得 $k_{1}'=0.1-0.8350203947825746=-0.7350203947825746$。\n接着，\n$$\nk_{2}'=f\\!\\left(0.15,\\,y_{1}+\\frac{h}{2}k_{1}'\\right)=f\\!\\left(0.15,\\,0.9137945035852288+0.05\\cdot(-0.7350203947825746)\\right)\n=f(0.15,\\,0.8770434838461001),\n$$\n所以\n$$\nk_{2}'=0.15-(0.8770434838461001)^{2}=-0.6192052725569046.\n$$\n然后\n$$\nk_{3}'=f\\!\\left(0.15,\\,y_{1}+\\frac{h}{2}k_{2}'\\right)=f\\!\\left(0.15,\\,0.9137945035852288+0.05\\cdot(-0.6192052725569046)\\right)\n=f(0.15,\\,0.8828342399573836),\n$$\n因此\n$$\nk_{3}'=0.15-(0.8828342399573836)^{2}=-0.6293962952407671.\n$$\n最后，\n$$\nk_{4}'=f\\!\\left(0.2,\\,y_{1}+h\\,k_{3}'\\right)=f\\!\\left(0.2,\\,0.9137945035852288+0.1\\cdot(-0.6293962952407671)\\right)\n=f(0.2,\\,0.8508548740611521),\n$$\n所以\n$$\nk_{4}'=0.2-(0.8508548740611521)^{2}=-0.5239540167137337.\n$$\n现在计算\n$$\ny_{2}=y_{1}+\\frac{h}{6}\\left(k_{1}'+2k_{2}'+2k_{3}'+k_{4}'\\right)\n=0.9137945035852288+\\frac{0.1}{6}\\left(-0.7350203947825746-1.2384105451138092-1.2587925904815342-0.5239540167137337\\right),\n$$\n可得\n$$\ny_{2}=0.9137945035852288+\\frac{0.1}{6}\\left(-3.7561775470916517\\right)\n=0.9137945035852288-0.06260295911819419=0.8511915444670346.\n$$\n\n亚当斯-巴什福特两步法 (AB2)：从 $t_{2}=0.2$ 到 $t_{3}=0.3$：\n我们需要 $f_{1}=f(t_{1},y_{1})$ 和 $f_{2}=f(t_{2},y_{2})$。\n我们已有 $f_{1}=k_{1}'=-0.7350203947825746$。\n接着，\n$$\nf_{2}=f(0.2,\\,y_{2})=0.2-y_{2}^{2}=0.2-(0.8511915444670346)^{2}=-0.5245270453721758.\n$$\n现在应用 AB2 方法：\n$$\ny_{3}=y_{2}+\\frac{h}{2}\\left(3f_{2}-f_{1}\\right)\n=0.8511915444670346+\\frac{0.1}{2}\\left(3\\cdot(-0.5245270453721758)-(-0.7350203947825746)\\right).\n$$\n计算括号内的表达式：\n$$\n3f_{2}-f_{1}=-1.5735811361165274+0.7350203947825746=-0.8385607413339528,\n$$\n所以\n$$\ny_{3}=0.8511915444670346+0.05\\cdot(-0.8385607413339528)=0.8511915444670346-0.04192803706669764=0.8092635074003369.\n$$\n\n四舍五入到五位有效数字，可得 $y(0.3)\\approx 0.80926$。", "answer": "$$\\boxed{0.80926}$$", "id": "2158977"}, {"introduction": "在对物理系统进行建模时，数值解的质量不仅仅取决于其与精确解的接近程度，还取决于它是否能遵守系统的基本物理定律，例如能量守恒。一个理想的数值方法应该能够在模拟过程中保持这些守恒量。这个练习探讨了经典的四阶龙格-库塔（RK4）方法在多大程度上能够为一个基本的物理模型——简谐振子——保持总能量守恒。通过这个实践，你将了解到即使是高阶方法也可能在长期模拟中引入物理上的不一致性，这为几何积分等更专业的数值方法的研究提供了动力。[@problem_id:2158985]", "problem": "一个粒子的一维运动由一个简化的无量纲模型描述，该模型由以下一阶常微分方程组表示：\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{dv}{dt} = -x\n$$\n其中 $x$ 是粒子的位置，$v$ 是其速度。系统的总能量由表达式 $E = \\frac{1}{2}(x^2 + v^2)$ 定义。\n\n在时间 $t=0$ 时，系统的初始条件为 $x(0) = 0$ 和 $v(0) = 1$。\n\n使用步长 $h = 0.2$ 的经典四阶 Runge-Kutta (RK4) 方法，通过执行单步来近似计算系统在时间 $t=0.2$ 时的状态 $(x(t), v(t))$。\n\n使用 $x(0.2)$ 和 $v(0.2)$ 的近似值，计算这一步之后总能量的相对误差。相对误差定义为 $\\frac{|E_1 - E_0|}{E_0}$，其中 $E_0$ 是 $t=0$ 时的初始能量，$E_1$ 是根据在 $t=0.2$ 时的数值近似计算出的能量。\n\n将最终答案四舍五入至四位有效数字。", "solution": "我们有自治系统 $x' = v$, $v' = -x$，初始值为 $x(0) = 0$, $v(0) = 1$，步长为 $h = 0.2$。对于系统 $y' = f(y)$，其中 $y = \\begin{pmatrix} x \\\\ v \\end{pmatrix}$ 且 $f(y) = \\begin{pmatrix} v \\\\ -x \\end{pmatrix}$，经典的 RK4 方法计算\n$$\nk_{1} = f(y_{0}),\\quad\nk_{2} = f\\left(y_{0} + \\frac{h}{2}k_{1}\\right),\\quad\nk_{3} = f\\left(y_{0} + \\frac{h}{2}k_{2}\\right),\\quad\nk_{4} = f\\left(y_{0} + h\\,k_{3}\\right),\n$$\n并更新 $y_{1} = y_{0} + \\frac{h}{6}\\left(k_{1} + 2k_{2} + 2k_{3} + k_{4}\\right)$。\n\n当 $y_{0} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$ 时：\n- $k_{1} = f\\left(\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\\right) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n- $y_{0} + \\frac{h}{2}k_{1} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} + 0.1\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0.1 \\\\ 1 \\end{pmatrix}$，因此 $k_{2} = f\\left(\\begin{pmatrix} 0.1 \\\\ 1 \\end{pmatrix}\\right) = \\begin{pmatrix} 1 \\\\ -0.1 \\end{pmatrix}$。\n- $y_{0} + \\frac{h}{2}k_{2} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} + 0.1\\begin{pmatrix} 1 \\\\ -0.1 \\end{pmatrix} = \\begin{pmatrix} 0.1 \\\\ 0.99 \\end{pmatrix}$，因此 $k_{3} = f\\left(\\begin{pmatrix} 0.1 \\\\ 0.99 \\end{pmatrix}\\right) = \\begin{pmatrix} 0.99 \\\\ -0.1 \\end{pmatrix}$。\n- $y_{0} + h\\,k_{3} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} + 0.2\\begin{pmatrix} 0.99 \\\\ -0.1 \\end{pmatrix} = \\begin{pmatrix} 0.198 \\\\ 0.98 \\end{pmatrix}$，因此 $k_{4} = f\\left(\\begin{pmatrix} 0.198 \\\\ 0.98 \\end{pmatrix}\\right) = \\begin{pmatrix} 0.98 \\\\ -0.198 \\end{pmatrix}$。\n\n合并各项可得\n$$\nx(0.2) \\approx x_{1} = 0 + \\frac{0.2}{6}\\left(1 + 2\\cdot 1 + 2\\cdot 0.99 + 0.98\\right) = \\frac{1}{30}\\cdot 5.96 = \\frac{149}{750},\n$$\n$$\nv(0.2) \\approx v_{1} = 1 + \\frac{0.2}{6}\\left(0 + 2\\cdot(-0.1) + 2\\cdot(-0.1) + (-0.198)\\right) = 1 + \\frac{1}{30}\\cdot(-0.598) = \\frac{14701}{15000}.\n$$\n\n能量为 $E = \\frac{1}{2}(x^{2} + v^{2})$。初始时，\n$$\nE_{0} = \\frac{1}{2}(0^{2} + 1^{2}) = \\frac{1}{2}.\n$$\n经过一步 RK4 计算后，\n$$\nx_{1}^{2} = \\frac{22201}{562500} = \\frac{8880400}{225000000},\\quad v_{1}^{2} = \\frac{216119401}{225000000},\n$$\n所以\n$$\nE_{1} = \\frac{1}{2}\\left(x_{1}^{2} + v_{1}^{2}\\right) = \\frac{1}{2}\\cdot\\frac{224999801}{225000000} = \\frac{224999801}{450000000}.\n$$\n因此，\n$$\n|E_{1} - E_{0}| = \\left|\\frac{224999801}{450000000} - \\frac{1}{2}\\right| = \\frac{199}{450000000},\n$$\n相对误差为\n$$\n\\frac{|E_{1} - E_{0}|}{E_{0}} = \\frac{\\frac{199}{450000000}}{\\frac{1}{2}} = \\frac{199}{225000000} \\approx 8.844444\\ldots \\times 10^{-7}.\n$$\n四舍五入到四位有效数字，得到 $8.844 \\times 10^{-7}$。", "answer": "$$\\boxed{8.844 \\times 10^{-7}}$$", "id": "2158985"}]}