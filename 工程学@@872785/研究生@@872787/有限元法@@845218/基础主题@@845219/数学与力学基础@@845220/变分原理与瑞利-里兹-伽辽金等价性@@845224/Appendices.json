{"hands_on_practices": [{"introduction": "理论是抽象的，而实践则使其具体化。我们的第一个动手练习将理论直接付诸实践。我们将为一个给定的边值问题构建有限元近似解，这个过程完全基于能量最小化原理。通过显式计算近似解的能量并将其与精确解的能量进行比较 ([@problem_id:2609997])，你将亲手验证Rayleigh-Ritz方法的核心思想：在所有可能的近似解中，有限元解使能量泛函达到最小值，并且这个能量值总是精确解能量的一个上界。", "problem": "考虑标量边值问题\n$$\n-\\big((1+x)\\,u'(x)\\big)' \\;=\\; 1 \\quad \\text{for } x\\in(0,1), \\qquad u(0)=0,\\; u(1)=0.\n$$\n从基于能量原理的变分形式出发，定义能量泛函，并论证为何精确解是其在索伯列夫空间 $H^{1}_{0}(0,1)$ 上的唯一极小化子。使用 Rayleigh–Ritz–Galerkin 等价性构建具有两个线性有限元的有限元方法，即在节点为 $x=0$、$x=\\tfrac{1}{2}$ 和 $x=1$ 的均匀剖分上的连续、分段线性函数的协调试探空间，并在 $x=0$ 和 $x=1$ 处施加齐次狄利克雷边界条件。显式计算：\n- 该空间中唯一的 Ritz–Galerkin 近似解 $u_{h}$，\n- 近似解的能量 $J(u_{h})$，\n- 精确解的能量 $J(u)$。\n\n最后，报告能量差\n$$\nE_{\\mathrm{gap}} \\;=\\; J(u_{h}) - J(u)\n$$\n作为一个单一的精确封闭形式表达式。无需四舍五入，不涉及单位。最终答案必须是这个单一的表达式。", "solution": "所提出的问题是应用数学领域中一个适定的、有科学依据的边值问题。它本身是自洽的，提供了所有必要的数据和条件。不存在科学或逻辑上的缺陷。这是微分方程变分形式和 Rayleigh-Ritz-Galerkin 方法的一个标准练习。因此，该问题被认为是有效的，并将提供一个正式的解。\n\n给定的标量边值问题是\n$$\n-\\big((1+x)\\,u'(x)\\big)' \\;=\\; 1 \\quad \\text{for } x\\in(0,1)\n$$\n带有齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。\n\n首先，我们推导变分形式。设解空间为索伯列夫空间 $H^{1}_{0}(0,1)$，它由在边界 $x=0$ 和 $x=1$ 处为零且具有平方可积弱一阶导数的函数组成。我们将微分方程乘以一个任意的测试函数 $v \\in H^{1}_{0}(0,1)$ 并在域 $(0,1)$ 上积分：\n$$\n-\\int_{0}^{1} \\big((1+x)\\,u'(x)\\big)' v(x) \\, dx \\;=\\; \\int_{0}^{1} 1 \\cdot v(x) \\, dx\n$$\n对左侧应用分部积分法得到：\n$$\n-\\Big[(1+x)u'(x)v(x)\\Big]_{0}^{1} + \\int_{0}^{1} (1+x)u'(x)v'(x) \\, dx \\;=\\; \\int_{0}^{1} v(x) \\, dx\n$$\n由于 $v \\in H^{1}_{0}(0,1)$，我们有 $v(0)=0$ 和 $v(1)=0$，所以边界项消失。这导出了弱形式：求 $u \\in H^{1}_{0}(0,1)$ 使得\n$$\na(u,v) \\;=\\; F(v) \\quad \\forall v \\in H^{1}_{0}(0,1)\n$$\n其中双线性形式 $a(\\cdot,\\cdot)$ 和线性泛函 $F(\\cdot)$ 定义为：\n$$\na(w,v) \\;=\\; \\int_{0}^{1} (1+x)w'(x)v'(x) \\, dx\n$$\n$$\nF(v) \\;=\\; \\int_{0}^{1} v(x) \\, dx\n$$\n相应的能量泛函 $J(v)$ 由 $J(v) = \\frac{1}{2}a(v,v) - F(v)$ 给出：\n$$\nJ(v) \\;=\\; \\frac{1}{2} \\int_{0}^{1} (1+x)(v'(x))^{2} \\, dx - \\int_{0}^{1} v(x) \\, dx\n$$\n精确解 $u$ 是此泛函在 $H^{1}_{0}(0,1)$ 上的唯一极小化子。这可以通过双线性形式 $a(\\cdot,\\cdot)$ 的性质来证明。它在 $H^{1}_{0}(0,1)$ 上是对称的、连续的和强制的。强制性是通过观察到对于 $x \\in [0,1]$，我们有 $1+x \\ge 1$ 来建立的。因此，\n$$\na(v,v) = \\int_{0}^{1} (1+x)(v'(x))^{2} \\, dx \\ge \\int_{0}^{1} (v'(x))^{2} \\, dx = \\|v'\\|_{L^{2}(0,1)}^{2}\n$$\n根据庞加莱不等式，存在一个常数 $C > 0$ 使得对于所有 $v \\in H^{1}_{0}(0,1)$，都有 $\\|v\\|_{H^{1}(0,1)} \\le C \\|v'\\|_{L^{2}(0,1)}$。因此，$a(v,v)$ 在 $H^{1}_{0}(0,1)$ 上是强制的。对于一个对称、连续且强制的双线性形式，能量泛函 $J(v)$ 是严格凸且连续的。泛函分析中的一个标准定理保证了这样的泛函在希尔伯特空间中拥有唯一的极小化子，这个极小化子与弱形式的唯一解重合。\n\n接下来，我们构造 Rayleigh-Ritz-Galerkin 近似解 $u_{h}$。有限元空间 $V_{h}$ 由在节点为 $x_{0}=0$、$x_{1}=\\frac{1}{2}$ 和 $x_{2}=1$ 的均匀剖分上满足齐次边界条件的连续、分段线性函数组成。这个空间是一维的，由与内部节点 $x_{1}=\\frac{1}{2}$ 相关联的单个基“帽”函数 $\\phi_{1}(x)$ 张成：\n$$\n\\phi_{1}(x) = \\begin{cases} 2x  &\\text{if } x \\in [0, \\frac{1}{2}] \\\\ 2(1-x)  &\\text{if } x \\in [\\frac{1}{2}, 1] \\end{cases}\n$$\n这个基函数的导数是分段常数：\n$$\n\\phi'_{1}(x) = \\begin{cases} 2  &\\text{if } x \\in (0, \\frac{1}{2}) \\\\ -2  &\\text{if } x \\in (\\frac{1}{2}, 1) \\end{cases}\n$$\nRitz-Galerkin 近似解的形式为 $u_{h}(x) = c_{1}\\phi_{1}(x)$，其中系数 $c_{1}$ 由伽辽金方程 $a(u_{h}, \\phi_{1}) = F(\\phi_{1})$ 确定。这给出了线性系统 $c_{1} a(\\phi_{1}, \\phi_{1}) = F(\\phi_{1})$。我们计算其分量：\n$$\na(\\phi_{1},\\phi_{1}) = \\int_{0}^{1} (1+x)(\\phi'_{1}(x))^{2} \\, dx = \\int_{0}^{1/2} (1+x)(2)^{2} \\, dx + \\int_{1/2}^{1} (1+x)(-2)^{2} \\, dx\n$$\n$$\na(\\phi_{1},\\phi_{1}) = 4 \\int_{0}^{1} (1+x) \\, dx = 4 \\left[x + \\frac{x^{2}}{2}\\right]_{0}^{1} = 4 \\left(1 + \\frac{1}{2}\\right) = 6\n$$\n$$\nF(\\phi_{1}) = \\int_{0}^{1} \\phi_{1}(x) \\, dx = \\int_{0}^{1/2} 2x \\, dx + \\int_{1/2}^{1} 2(1-x) \\, dx = \\left[x^{2}\\right]_{0}^{1/2} + 2\\left[x - \\frac{x^{2}}{2}\\right]_{1/2}^{1} = \\frac{1}{4} + 2\\left(\\frac{1}{2} - \\frac{3}{8}\\right) = \\frac{1}{2}\n$$\n关于 $c_{1}$ 的线性方程是 $6 c_{1} = \\frac{1}{2}$，这给出 $c_{1} = \\frac{1}{12}$。因此近似解为：\n$$\nu_{h}(x) = \\frac{1}{12} \\phi_{1}(x)\n$$\n近似解的能量 $J(u_{h})$ 计算为 $J(u_{h}) = \\frac{1}{2}a(u_{h}, u_{h}) - F(u_{h})$。根据伽辽金正交性，$a(u_{h}, u_{h}) = F(u_{h})$。因此，$J(u_{h}) = -\\frac{1}{2} F(u_{h})$。\n$$\nF(u_{h}) = F(c_{1}\\phi_{1}) = c_{1}F(\\phi_{1}) = \\frac{1}{12} \\cdot \\frac{1}{2} = \\frac{1}{24}\n$$\n因此，近似解的能量是：\n$$\nJ(u_{h}) = -\\frac{1}{2} \\left(\\frac{1}{24}\\right) = -\\frac{1}{48}\n$$\n现在，我们通过直接对微分方程积分来求精确解 $u(x)$：\n$$\n-\\big((1+x)u'(x)\\big)' = 1 \\implies -(1+x)u'(x) = x + C_{1} \\implies u'(x) = -\\frac{x+C_{1}}{1+x} = -1 - \\frac{C_{1}-1}{1+x}\n$$\n再次积分得到：\n$$\nu(x) = -x - (C_{1}-1)\\ln(1+x) + C_{2}\n$$\n应用边界条件：\n$u(0)=0 \\implies 0 = -0 - (C_{1}-1)\\ln(1) + C_{2} \\implies C_{2}=0$。\n$u(1)=0 \\implies 0 = -1 - (C_{1}-1)\\ln(2) \\implies C_{1}-1 = -\\frac{1}{\\ln(2)}$。\n精确解是：\n$$\nu(x) = -x - \\left(-\\frac{1}{\\ln(2)}\\right)\\ln(1+x) = \\frac{\\ln(1+x)}{\\ln(2)} - x\n$$\n精确解的能量 $J(u)$ 的确定方式类似：$J(u) = -\\frac{1}{2}F(u)$。\n$$\nF(u) = \\int_{0}^{1} u(x) \\, dx = \\int_{0}^{1} \\left(\\frac{\\ln(1+x)}{\\ln(2)} - x\\right) \\, dx = \\frac{1}{\\ln(2)} \\int_{0}^{1} \\ln(1+x) \\, dx - \\int_{0}^{1} x \\, dx\n$$\n积分计算如下：\n$\\int_{0}^{1} x \\, dx = \\frac{1}{2}$。\n$\\int_{0}^{1} \\ln(1+x) \\, dx = \\Big[(1+x)\\ln(1+x) - (1+x)\\Big]_{0}^{1} = (2\\ln(2)-2) - (1\\ln(1)-1) = 2\\ln(2) - 1$。\n所以，\n$$\nF(u) = \\frac{1}{\\ln(2)}(2\\ln(2) - 1) - \\frac{1}{2} = 2 - \\frac{1}{\\ln(2)} - \\frac{1}{2} = \\frac{3}{2} - \\frac{1}{\\ln(2)}\n$$\n精确解的能量是：\n$$\nJ(u) = -\\frac{1}{2} F(u) = -\\frac{1}{2} \\left(\\frac{3}{2} - \\frac{1}{\\ln(2)}\\right) = \\frac{1}{2\\ln(2)} - \\frac{3}{4}\n$$\n最后，我们计算能量差 $E_{\\mathrm{gap}} = J(u_{h}) - J(u)$:\n$$\nE_{\\mathrm{gap}} = -\\frac{1}{48} - \\left(\\frac{1}{2\\ln(2)} - \\frac{3}{4}\\right) = -\\frac{1}{48} - \\frac{1}{2\\ln(2)} + \\frac{36}{48}\n$$\n$$\nE_{\\mathrm{gap}} = \\frac{35}{48} - \\frac{1}{2\\ln(2)}\n$$\n根据 Rayleigh-Ritz 原理，这个差值保证为非负，因为 $u$ 是 $J$ 的全局极小化子，而 $u_h$ 是子空间 $V_h$ 上的极小化子。", "answer": "$$\n\\boxed{\\frac{35}{48} - \\frac{1}{2\\ln(2)}}\n$$", "id": "2609997"}, {"introduction": "变分原理的强大之处在于其广泛的适用性，远不止于求解源问题。第二个练习将我们的注意力转向物理和工程中至关重要的另一类问题：特征值问题。我们将探索如何使用Rayleigh商（即特征值问题的“能量泛函”）来近似系统的基本频率或稳定性极限 ([@problem_id:2610000])。这个练习完美地展示了Rayleigh-Ritz方法如何自然地转化为一个矩阵特征值问题，这是计算结构力学和量子力学中司空见惯的核心任务。", "problem": "考虑单位区间上的Sturm–Liouville特征值问题：寻找一个特征对 $(\\lambda,u)$，其中 $u \\neq 0$，使得在 $(0,1)$ 上有 $-u''=\\lambda u$，且满足 $u(0)=u(1)=0$。在Sobolev空间 $H_{0}^{1}(0,1)$ 和标准的 $L^{2}(0,1)$ 内积下进行全部计算。记 $a(u,v)=\\int_{0}^{1} u'(x)\\,v'(x)\\,\\mathrm{d}x$ 和 $m(u,v)=\\int_{0}^{1} u(x)\\,v(x)\\,\\mathrm{d}x$。对于 $v \\in H_{0}^{1}(0,1)$ 且 $v \\neq 0$，定义Rayleigh商 $R(v)=\\dfrac{a(v,v)}{m(v,v)}$。\n\n1. 从强形式 $-u''=\\lambda u$ 及齐次Dirichlet边界条件出发，推导其弱（变分）形式，并证明特征对 $(\\lambda,u)$ 恰好是Rayleigh商 $R(v)$ 在归一化约束 $m(v,v)=1$ 下的驻点。请明确所有步骤和假设，包括分部积分和边界项的消失。\n\n2. 设 $V_{h}=\\mathrm{span}\\{\\varphi_{1},\\varphi_{2}\\}$，其中 $\\varphi_{1}(x)=\\sin(\\pi x)$ 和 $\\varphi_{2}(x)=\\sin(2\\pi x)$。构建在 $V_{h}$ 上的Rayleigh–Ritz近似，并证明其等价于Galerkin广义矩阵特征值问题，即：寻找 $(\\lambda_{h},\\mathbf{c})$，其中 $\\mathbf{c}\\neq \\mathbf{0}$，使得 $\\mathbf{K}\\mathbf{c}=\\lambda_{h}\\,\\mathbf{M}\\mathbf{c}$，这里 $\\mathbf{K}_{ij}=a(\\varphi_{i},\\varphi_{j})$ 且 $\\mathbf{M}_{ij}=m(\\varphi_{i},\\varphi_{j})$。请显式计算矩阵 $\\mathbf{K}$ 和 $\\mathbf{M}$ 的元素。\n\n3. 求解所得的 $2\\times 2$ 广义特征值问题，以获得对最小两个特征值的两个Rayleigh–Ritz近似的闭式表达式。\n\n4. 此边值问题的精确谱是可以通过解析方法得到的。将你的两个近似值与精确的前两个特征值进行比较，并根据 $V_{h}$ 的结构简要说明任何一致或差异的原因。\n\n以闭式形式给出两个近似特征值作为最终答案。不要对答案进行四舍五入。", "solution": "首先对问题陈述进行强制性验证过程。\n\n步骤 1：提取已知条件\n问题提供了以下信息：\n- 微分方程：在区间 $(0,1)$ 上 $-u''=\\lambda u$。\n- 边界条件：$u(0)=0$ 和 $u(1)=0$。\n- 解的函数空间：Sobolev空间 $H_{0}^{1}(0,1)$。\n- 内积空间：$L^{2}(0,1)$。\n- 双线性形式：$a(u,v)=\\int_{0}^{1} u'(x)\\,v'(x)\\,\\mathrm{d}x$ 和 $m(u,v)=\\int_{0}^{1} u(x)\\,v(x)\\,\\mathrm{d}x$。\n- Rayleigh商：对于非零 $v \\in H_{0}^{1}(0,1)$，$R(v)=\\dfrac{a(v,v)}{m(v,v)}$。\n- 用于近似的有限维子空间：$V_{h}=\\mathrm{span}\\{\\varphi_{1},\\varphi_{2}\\}$，其中 $\\varphi_{1}(x)=\\sin(\\pi x)$ 和 $\\varphi_{2}(x)=\\sin(2\\pi x)$。\n- Galerkin矩阵的定义：$\\mathbf{K}_{ij}=a(\\varphi_{i},\\varphi_{j})$ 和 $\\mathbf{M}_{ij}=m(\\varphi_{i},\\varphi_{j})$。\n\n步骤 2：使用提取的已知条件进行验证\n根据有效性标准对问题进行评估。\n- **科学性：** 该问题是一个经典的Sturm-Liouville特征值问题，是数学物理、泛函分析和偏微分方程理论的基石。Sobolev空间、弱形式和Rayleigh-Ritz-Galerkin方法的使用是现代数值分析中标准且严谨的技术。该问题牢固地建立在已有的数学理论之上。\n- **适定性：** 该问题是适定的。在指定的定义域和给定的边界条件下，该算子是自伴且正定的，这保证了其特征值谱是离散、实数且为正的。所有定义都精确无歧义。\n- **客观性：** 问题以精确、客观的数学语言陈述，不含任何主观或非形式化的内容。\n- **完整性与一致性：** 问题是自洽的。所有必要的数据、定义和空间均已提供。不存在矛盾之处。\n\n步骤 3：结论与行动\n该问题被判定为**有效**。这是一个数值分析和变分法中的标准、适定的问题。开始求解。\n\n按要求分四部分给出解答。\n\n第 1 部分：弱形式与变分原理\n出发点是特征值问题的强形式：寻找 $(\\lambda, u)$ 使得\n$$ -u''(x) = \\lambda u(x) \\quad \\text{for } x \\in (0,1) $$\n边界条件为 $u(0)=0$ 和 $u(1)=0$。解 $u$ 在Sobolev空间 $H_{0}^{1}(0,1)$ 中寻找，该空间由 $H^{1}(0,1)$ 中在边界 $x=0$ 和 $x=1$ 处为零的函数组成。设 $v$ 是来自同一空间 $v \\in H_{0}^{1}(0,1)$ 的任意测试函数。我们将强形式乘以 $v(x)$ 并在定义域 $[0,1]$ 上积分：\n$$ -\\int_{0}^{1} u''(x)v(x)\\,\\mathrm{d}x = \\int_{0}^{1} \\lambda u(x)v(x)\\,\\mathrm{d}x $$\n对左侧进行分部积分得到：\n$$ -\\left[ u'(x)v(x) \\right]_{0}^{1} + \\int_{0}^{1} u'(x)v'(x)\\,\\mathrm{d}x = \\lambda \\int_{0}^{1} u(x)v(x)\\,\\mathrm{d}x $$\n边界项 $[u'(x)v(x)]_{0}^{1} = u'(1)v(1) - u'(0)v(0)$ 恒为零，因为测试函数 $v$ 属于 $H_{0}^{1}(0,1)$，这要求 $v(0)=v(1)=0$。于是剩下：\n$$ \\int_{0}^{1} u'(x)v'(x)\\,\\mathrm{d}x = \\lambda \\int_{0}^{1} u(x)v(x)\\,\\mathrm{d}x $$\n使用所给定的双线性形式 $a(u,v)$ 和 $m(u,v)$ 的定义，这正是弱（或变分）形式：寻找一个特征对 $(\\lambda, u)$，其中 $u \\in H_{0}^{1}(0,1)$，$u \\neq 0$，使得对于所有 $v \\in H_{0}^{1}(0,1)$，\n$$ a(u,v) = \\lambda m(u,v) $$\n接下来，我们证明这个弱问题的解是Rayleigh商 $R(v) = a(v,v)/m(v,v)$ 的驻点。如果 $R$ 在 $u$ 点沿任意方向 $\\eta \\in H_{0}^{1}(0,1)$ 的方向导数为零，则函数 $u$ 是 $R(v)$ 的一个驻点。其Gâteaux导数为：\n$$ \\frac{d}{d\\epsilon} R(u+\\epsilon\\eta) \\Big|_{\\epsilon=0} = 0 \\quad \\forall \\eta \\in H_{0}^{1}(0,1) $$\n使用导数的商法则：\n$$ \\frac{\\frac{d}{d\\epsilon}\\left[a(u+\\epsilon\\eta, u+\\epsilon\\eta)\\right]_{\\epsilon=0} m(u,u) - a(u,u) \\frac{d}{d\\epsilon}\\left[m(u+\\epsilon\\eta, u+\\epsilon\\eta)\\right]_{\\epsilon=0}}{[m(u,u)]^2} = 0 $$\n利用双线性形式的对称性和双线性性，其导数计算如下：\n$$ \\frac{d}{d\\epsilon} a(u+\\epsilon\\eta, u+\\epsilon\\eta) \\Big|_{\\epsilon=0} = \\frac{d}{d\\epsilon} [a(u,u) + 2\\epsilon a(u,\\eta) + \\epsilon^2 a(\\eta,\\eta)] \\Big|_{\\epsilon=0} = 2a(u,\\eta) $$\n$$ \\frac{d}{d\\epsilon} m(u+\\epsilon\\eta, u+\\epsilon\\eta) \\Big|_{\\epsilon=0} = \\frac{d}{d\\epsilon} [m(u,u) + 2\\epsilon m(u,\\eta) + \\epsilon^2 m(\\eta,\\eta)] \\Big|_{\\epsilon=0} = 2m(u,\\eta) $$\n将这些代入商法则表达式并令其为零，得到：\n$$ \\frac{2a(u,\\eta)m(u,u) - 2a(u,u)m(u,\\eta)}{[m(u,u)]^2} = 0 $$\n对于 $u \\neq 0$，$m(u,u) \\neq 0$，所以我们必须有：\n$$ a(u,\\eta)m(u,u) - a(u,u)m(u,\\eta) = 0 $$\n$$ a(u,\\eta) = \\frac{a(u,u)}{m(u,u)} m(u,\\eta) $$\n通过定义 $\\lambda = \\frac{a(u,u)}{m(u,u)} = R(u)$，我们恢复了对于所有测试函数 $\\eta \\in H_{0}^{1}(0,1)$ 的弱形式 $a(u,\\eta) = \\lambda m(u,\\eta)$。这证明了弱问题的特征对 $(\\lambda, u)$ 恰好是Rayleigh商的驻值和驻点。约束条件 $m(v,v)=1$ 是一个归一化，它将问题简化为在 $L^2$ 范数的单位球面上寻找 $a(v,v)$ 的驻点，其中Lagrange乘子直接对应于特征值。\n\n第 2 部分：Rayleigh-Ritz近似与Galerkin等价性\nRayleigh-Ritz方法将变分问题限制在一个有限维子空间 $V_{h} \\subset H_{0}^{1}(0,1)$ 上。这里，$V_{h} = \\mathrm{span}\\{\\varphi_{1}, \\varphi_{2}\\}$。我们寻求一个近似解 $u_{h} \\in V_{h}$，它可以表示为基函数的线性组合：\n$$ u_{h}(x) = c_{1}\\varphi_{1}(x) + c_{2}\\varphi_{2}(x) = \\sum_{j=1}^{2} c_{j}\\varphi_{j}(x) $$\nGalerkin方法要求弱形式的残差与近似空间 $V_{h}$ 正交。这意味着弱形式必须对 $u_{h}$ 成立，且测试函数被限制为 $V_{h}$ 的基函数：寻找 $(\\lambda_{h}, u_{h})$ 使得对于 $i=1,2$，\n$$ a(u_{h}, \\varphi_{i}) = \\lambda_{h} m(u_{h}, \\varphi_{i}) $$\n代入 $u_h$ 的展开式：\n$$ a\\left(\\sum_{j=1}^{2} c_{j}\\varphi_{j}, \\varphi_{i}\\right) = \\lambda_{h} m\\left(\\sum_{j=1}^{2} c_{j}\\varphi_{j}, \\varphi_{i}\\right) $$\n根据双线性形式的线性性质，这变成一个包含两个线性方程的方程组（$i=1,2$）：\n$$ \\sum_{j=1}^{2} c_{j} a(\\varphi_{j}, \\varphi_{i}) = \\lambda_{h} \\sum_{j=1}^{2} c_{j} m(\\varphi_{j}, \\varphi_{i}) $$\n使用定义 $\\mathbf{K}_{ij} = a(\\varphi_{i}, \\varphi_{j})$ 和 $\\mathbf{M}_{ij} = m(\\varphi_{i}, \\varphi_{j})$，并利用形式的对称性（$a(u,v)=a(v,u)$ 和 $m(u,v)=m(v,u)$），我们可以将此系统写成矩阵形式：\n$$ \\mathbf{K}\\mathbf{c} = \\lambda_{h}\\mathbf{M}\\mathbf{c} $$\n其中 $\\mathbf{c}=[c_{1}, c_{2}]^{T}$。这就是广义矩阵特征值问题，从而建立了Rayleigh-Ritz形式与Galerkin方法之间的等价性。\n\n现在，我们计算矩阵 $\\mathbf{K}$ 和 $\\mathbf{M}$。基函数为 $\\varphi_{1}(x) = \\sin(\\pi x)$ 和 $\\varphi_{2}(x) = \\sin(2\\pi x)$，其导数为 $\\varphi'_{1}(x) = \\pi\\cos(\\pi x)$ 和 $\\varphi'_{2}(x) = 2\\pi\\cos(2\\pi x)$。\n质量矩阵 $\\mathbf{M}$ 的元素为：\n$$ \\mathbf{M}_{ij} = \\int_{0}^{1} \\sin(i\\pi x) \\sin(j\\pi x) \\,\\mathrm{d}x $$\n由于正弦函数在区间 $[0,1]$ 上的正交性，$\\int_{0}^{1} \\sin(k\\pi x)\\sin(l\\pi x)\\,\\mathrm{d}x = \\frac{1}{2}\\delta_{kl}$，其中 $\\delta_{kl}$ 是Kronecker delta。\n$$ \\mathbf{M}_{11} = \\int_{0}^{1} \\sin^{2}(\\pi x)\\,\\mathrm{d}x = \\frac{1}{2} $$\n$$ \\mathbf{M}_{22} = \\int_{0}^{1} \\sin^{2}(2\\pi x)\\,\\mathrm{d}x = \\frac{1}{2} $$\n$$ \\mathbf{M}_{12} = \\mathbf{M}_{21} = \\int_{0}^{1} \\sin(\\pi x)\\sin(2\\pi x)\\,\\mathrm{d}x = 0 $$\n因此，质量矩阵为 $\\mathbf{M} = \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1/2 \\end{pmatrix}$。\n刚度矩阵 $\\mathbf{K}$ 的元素为：\n$$ \\mathbf{K}_{ij} = \\int_{0}^{1} \\varphi'_{i}(x)\\varphi'_{j}(x)\\,\\mathrm{d}x = (i\\pi)(j\\pi) \\int_{0}^{1} \\cos(i\\pi x)\\cos(j\\pi x)\\,\\mathrm{d}x $$\n余弦函数在 $[0,1]$ 上也是正交的：对于整数 $k,l \\ge 1$，有 $\\int_{0}^{1} \\cos(k\\pi x)\\cos(l\\pi x)\\,\\mathrm{d}x = \\frac{1}{2}\\delta_{kl}$。\n$$ \\mathbf{K}_{11} = \\pi^2 \\int_{0}^{1} \\cos^{2}(\\pi x)\\,\\mathrm{d}x = \\pi^2 \\left(\\frac{1}{2}\\right) = \\frac{\\pi^2}{2} $$\n$$ \\mathbf{K}_{22} = (2\\pi)^2 \\int_{0}^{1} \\cos^{2}(2\\pi x)\\,\\mathrm{d}x = 4\\pi^2\\left(\\frac{1}{2}\\right) = 2\\pi^2 $$\n$$ \\mathbf{K}_{12} = \\mathbf{K}_{21} = (\\pi)(2\\pi) \\int_{0}^{1} \\cos(\\pi x)\\cos(2\\pi x)\\,\\mathrm{d}x = 2\\pi^2(0) = 0 $$\n因此，刚度矩阵为 $\\mathbf{K} = \\begin{pmatrix} \\pi^2/2 & 0 \\\\ 0 & 2\\pi^2 \\end{pmatrix}$。\n\n第 3 部分：广义特征值问题的解\n我们必须求解 $\\mathbf{K}\\mathbf{c} = \\lambda_{h}\\mathbf{M}\\mathbf{c}$：\n$$ \\begin{pmatrix} \\pi^2/2 & 0 \\\\ 0 & 2\\pi^2 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} = \\lambda_{h} \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1/2 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} $$\n由于两个矩阵都是对角矩阵，系统解耦为两个独立的方程：\n对于第一个特征值（取 $\\mathbf{c}=[1,0]^T$）：\n$$ \\frac{\\pi^2}{2} c_1 = \\lambda_{h,1} \\frac{1}{2} c_1 \\implies \\lambda_{h,1} = \\pi^2 $$\n对于第二个特征值（取 $\\mathbf{c}=[0,1]^T$）：\n$$ 2\\pi^2 c_2 = \\lambda_{h,2} \\frac{1}{2} c_2 \\implies \\lambda_{h,2} = 4\\pi^2 $$\n两个近似特征值按大小排序为 $\\lambda_{h,1} = \\pi^2$ 和 $\\lambda_{h,2} = 4\\pi^2$。\n\n第 4 部分：与精确解的比较\n强形式 $-u''=\\lambda u$ 及边界条件 $u(0)=u(1)=0$ 的精确解析解可以通过求解该常微分方程得到。通解为 $u(x) = A\\sin(\\sqrt{\\lambda}x) + B\\cos(\\sqrt{\\lambda}x)$。\n条件 $u(0)=0$ 意味着 $B\\cos(0)=0 \\implies B=0$。\n条件 $u(1)=0$ 意味着 $A\\sin(\\sqrt{\\lambda})=0$。对于非平凡解（$u \\neq 0$），我们必须有 $A \\neq 0$，这要求 $\\sin(\\sqrt{\\lambda})=0$。当 $\\sqrt{\\lambda}=k\\pi$（对于任何整数 $k \\ge 1$）时，此条件成立。\n因此，精确特征值为 $\\lambda_{k} = (k\\pi)^2 = k^2\\pi^2$，其中 $k=1, 2, 3, \\dots$。\n对应的精确特征函数为 $u_{k}(x) = \\sin(k\\pi x)$。\n前两个精确特征值为 $\\lambda_{1} = \\pi^2$ 和 $\\lambda_{2} = 4\\pi^2$。\n将近似值与精确值进行比较：\n- 近似最小特征值：$\\lambda_{h,1} = \\pi^2$。精确最小特征值：$\\lambda_{1} = \\pi^2$。它们是相同的。\n- 近似第二个特征值：$\\lambda_{h,2} = 4\\pi^2$。精确第二个特征值：$\\lambda_{2} = 4\\pi^2$。它们也是相同的。\n在这种情况下，Rayleigh-Ritz近似不仅仅是近似；它们是精确的。这是近似子空间 $V_{h}$ 选择的直接结果。为 $V_{h}$ 选择的基函数 $\\varphi_{1}(x)=\\sin(\\pi x)$ 和 $\\varphi_{2}(x)=\\sin(2\\pi x)$，恰好是原始微分算子的前两个精确特征函数。Rayleigh-Ritz方法在给定子空间内寻找最佳可能解。由于精确解是该子空间的元素，该方法正确地找到了它们，从而得到了精确的特征值。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\pi^{2} & 4\\pi^{2}\n\\end{pmatrix}\n}\n$$", "id": "2610000"}, {"introduction": "深刻的理解不仅来自于知道一个理论何时适用，同样也来自于了解其局限性。最后一个练习旨在磨练这种批判性思维。我们将探讨当一个问题的微分算子非自伴时（例如在包含对流项时）会发生什么 ([@problem_id:2609992])。通过分析一个非对称的双线性形式，你将从根本上证明为什么在这种情况下，伽辽金方程不能再被看作是某个二次泛函最小化问题的直接结果，从而揭示伽辽金方法相对于Rayleigh-Ritz方法更广泛的普适性。", "problem": "设 $V$ 为索博列夫空间 $H^{1}(0,1)$，并设 $V_{h} \\subset V$ 是由两个线性无关函数 $\\phi_{1}(x)=x$ 和 $\\phi_{2}(x)=x^{2}$ 张成的有限维试探与检验空间。考虑由下式定义的双线性形式 $a:V\\times V\\to \\mathbb{R}$\n$$\na(u,v)\\;=\\;\\int_{0}^{1} u'(x)\\,v(x)\\,dx\\;+\\;\\int_{0}^{1} u(x)\\,v(x)\\,dx,\n$$\n以及一个任意的连续线性形式 $\\ell:V\\to\\mathbb{R}$。用于寻找满足对所有 $v_{h}\\in V_{h}$ 都有 $a(u_{h},v_{h})=\\ell(v_{h})$ 的 $u_{h}\\in V_{h}$ 的伽辽金方法，会得到关于系数向量 $\\mathbf{c}\\in\\mathbb{R}^{2}$ 的线性系统 $\\mathbf{K}\\,\\mathbf{c}=\\mathbf{f}$，其中刚度矩阵 $\\mathbf{K}\\in\\mathbb{R}^{2\\times 2}$ 的元素为 $K_{ij}=a(\\phi_{j},\\phi_{i})$（$i,j\\in\\{1,2\\}$），载荷向量 $\\mathbf{f}$ 的元素为 $f_{i}=\\ell(\\phi_{i})$。\n\n从关于 $\\mathbb{R}^{2}$ 上标准欧几里得内积中标量泛函梯度的第一性原理出发，解释为什么存在一个二次泛函 $J(\\mathbf{c})$，其一阶必要条件为对所有 $\\mathbf{c}\\in\\mathbb{R}^{2}$ 都有 $\\nabla J(\\mathbf{c})=\\mathbf{K}\\mathbf{c}-\\mathbf{f}$，这要求 $\\mathbf{K}$ 是对称的。然后，对于上面给出的 $a(\\cdot,\\cdot)$ 和 $V_{h}$ 的具体选择，显式地计算 $K_{12}-K_{21}$ 的值，以确认 $\\mathbf{K}$ 不是对称的，因此伽辽金方程不能通过在标准欧几里得内积中最小化一个二次泛函得到。\n\n将 $K_{12}-K_{21}$ 的最终结果表示为一个无舍入的精确既约分数。", "solution": "该问题提出了两个任务。首先，从第一性原理出发，证明线性系统存在二次势泛函意味着系统矩阵的对称性。其次，计算由一个非对称双线性形式导出的特定刚度矩阵的不对称性。该问题是适定的且在科学上是合理的。我们将开始解答。\n\n首先，我们解决理论要求部分。设 $J(\\mathbf{c})$ 是 $\\mathbb{R}^{n}$ 上的一个标量值泛函，其中 $\\mathbf{c} = (c_{1}, c_{2}, \\dots, c_{n})^{T}$。问题陈述了 $J$ 的极值的一阶必要条件由方程 $\\nabla J(\\mathbf{c}) = \\mathbf{K}\\mathbf{c} - \\mathbf{f}$ 给出，其中 $\\mathbf{K}$ 是一个 $n \\times n$ 矩阵，$\\mathbf{f}$ 是 $\\mathbb{R}^{n}$ 中的一个常向量。向量场 $\\mathbf{F}(\\mathbf{c}) = \\mathbf{K}\\mathbf{c} - \\mathbf{f}$ 被断言为 $J$ 的梯度。\n\n对于一个向量场 $\\mathbf{F}$ 要成为一个标量势 $J$ 的梯度（即 $\\mathbf{F} = \\nabla J$），一个必要条件是其雅可比矩阵必须是对称的。$\\mathbf{F}$ 的雅可比矩阵记为 $\\mathbf{J}_{\\mathbf{F}}$，其元素为 $(\\mathbf{J}_{\\mathbf{F}})_{ij} = \\frac{\\partial F_{i}}{\\partial c_{j}}$。\n给定 $F_{i} = \\frac{\\partial J}{\\partial c_{i}}$，雅可比矩阵的元素变为 $(\\mathbf{J}_{\\mathbf{F}})_{ij} = \\frac{\\partial}{\\partial c_{j}}\\left(\\frac{\\partial J}{\\partial c_{i}}\\right) = \\frac{\\partial^{2} J}{\\partial c_{j} \\partial c_{i}}$。这个矩阵是 $J$ 的海森矩阵，记为 $\\mathbf{H}_{J}$。\n\n根据关于混合偏导数相等性的 Schwarz 定理（或 Clairaut 定理），如果一个函数的二阶偏导数是连续的，那么其海森矩阵是对称的。也就是说，$\\frac{\\partial^{2} J}{\\partial c_{j} \\partial c_{i}} = \\frac{\\partial^{2} J}{\\partial c_{i} \\partial c_{j}}$，这意味着 $(\\mathbf{H}_{J})_{ij} = (\\mathbf{H}_{J})_{ji}$。\n问题指定了一个二次泛函。这种泛函的二阶导数是常数，因此是连续的，所以该定理无条件适用。\n\n现在，我们计算特定向量场 $\\mathbf{F}(\\mathbf{c}) = \\mathbf{K}\\mathbf{c} - \\mathbf{f}$ 的雅可比矩阵。其第 $i$ 个分量是 $F_{i}(\\mathbf{c}) = \\sum_{k=1}^{n} K_{ik}c_{k} - f_{i}$。\n关于 $c_{j}$ 的偏导数是：\n$$\n\\frac{\\partial F_{i}}{\\partial c_{j}} = \\frac{\\partial}{\\partial c_{j}} \\left( \\sum_{k=1}^{n} K_{ik}c_{k} - f_{i} \\right) = \\sum_{k=1}^{n} K_{ik} \\frac{\\partial c_{k}}{\\partial c_{j}} = \\sum_{k=1}^{n} K_{ik} \\delta_{kj} = K_{ij}\n$$\n其中 $\\delta_{kj}$ 是克罗内克δ。\n因此，$\\mathbf{F}(\\mathbf{c})$ 的雅可比矩阵就是矩阵 $\\mathbf{K}$ 本身。\n令两个结果相等，我们得到 $\\mathbf{H}_{J} = \\mathbf{K}$。由于海森矩阵 $\\mathbf{H}_{J}$ 必须是对称的，必然得出矩阵 $\\mathbf{K}$ 也必须是对称的，即 $K_{ij} = K_{ji}$。这就结束了论证的第一部分。\n\n接下来，我们计算特定问题的刚度矩阵并验证其不对称性。空间 $V_{h}$ 由基函数 $\\phi_{1}(x) = x$ 和 $\\phi_{2}(x) = x^{2}$ 张成。它们的导数是 $\\phi_{1}'(x) = 1$ 和 $\\phi_{2}'(x) = 2x$。\n双线性形式由下式给出：\n$$\na(u,v) = \\int_{0}^{1} u'(x)v(x)dx + \\int_{0}^{1} u(x)v(x)dx\n$$\n刚度矩阵 $\\mathbf{K} \\in \\mathbb{R}^{2 \\times 2}$ 的元素由 $K_{ij} = a(\\phi_{j}, \\phi_{i})$ 定义，其中 $i,j \\in \\{1,2\\}$。我们需要计算 $K_{12} - K_{21}$。\n\n我们来计算 $K_{12}$ 项：\n$$\nK_{12} = a(\\phi_{2}, \\phi_{1}) = \\int_{0}^{1} \\phi_{2}'(x)\\phi_{1}(x)dx + \\int_{0}^{1} \\phi_{2}(x)\\phi_{1}(x)dx\n$$\n代入函数及其导数的表达式：\n$$\nK_{12} = \\int_{0}^{1} (2x)(x)dx + \\int_{0}^{1} (x^{2})(x)dx = \\int_{0}^{1} 2x^{2}dx + \\int_{0}^{1} x^{3}dx\n$$\n进行积分：\n$$\nK_{12} = \\left[\\frac{2x^{3}}{3}\\right]_{0}^{1} + \\left[\\frac{x^{4}}{4}\\right]_{0}^{1} = \\frac{2}{3} + \\frac{1}{4} = \\frac{8+3}{12} = \\frac{11}{12}\n$$\n现在，我们来计算 $K_{21}$ 项：\n$$\nK_{21} = a(\\phi_{1}, \\phi_{2}) = \\int_{0}^{1} \\phi_{1}'(x)\\phi_{2}(x)dx + \\int_{0}^{1} \\phi_{1}(x)\\phi_{2}(x)dx\n$$\n代入函数及其导数的表达式：\n$$\nK_{21} = \\int_{0}^{1} (1)(x^{2})dx + \\int_{0}^{1} (x)(x^{2})dx = \\int_{0}^{1} x^{2}dx + \\int_{0}^{1} x^{3}dx\n$$\n进行积分：\n$$\nK_{21} = \\left[\\frac{x^{3}}{3}\\right]_{0}^{1} + \\left[\\frac{x^{4}}{4}\\right]_{0}^{1} = \\frac{1}{3} + \\frac{1}{4} = \\frac{4+3}{12} = \\frac{7}{12}\n$$\n不对称性是显而易见的，因为 $K_{12} \\neq K_{21}$。所要求的量是它们的差：\n$$\nK_{12} - K_{21} = \\frac{11}{12} - \\frac{7}{12} = \\frac{4}{12} = \\frac{1}{3}\n$$\n或者，这个差可以更直接地计算：\n$$\nK_{12} - K_{21} = a(\\phi_{2}, \\phi_{1}) - a(\\phi_{1}, \\phi_{2}) = \\left(\\int_{0}^{1} \\phi_{2}'\\phi_{1}dx + \\int_{0}^{1} \\phi_{2}\\phi_{1}dx\\right) - \\left(\\int_{0}^{1} \\phi_{1}'\\phi_{2}dx + \\int_{0}^{1} \\phi_{1}\\phi_{2}dx\\right)\n$$\n包含 $\\int \\phi_{1}\\phi_{2}dx$ 的项会消去，因为乘法是可交换的。不对称性仅源于双线性形式中的 $u'v$ 项。\n$$\nK_{12} - K_{21} = \\int_{0}^{1} (\\phi_{2}'\\phi_{1} - \\phi_{1}'\\phi_{2})dx = \\int_{0}^{1} ((2x)(x) - (1)(x^{2}))dx = \\int_{0}^{1} (2x^{2} - x^{2})dx = \\int_{0}^{1} x^{2}dx\n$$\n$$\n\\int_{0}^{1} x^{2}dx = \\left[\\frac{x^{3}}{3}\\right]_{0}^{1} = \\frac{1}{3}\n$$\n由于 $K_{12} - K_{21} \\neq 0$，刚度矩阵 $\\mathbf{K}$ 不是对称的。因此，对于这种双线性形式和基的特定选择，伽辽金系统 $\\mathbf{K}\\mathbf{c} = \\mathbf{f}$ 不能通过在标准欧几里得内积中最小化二次泛函 $J(\\mathbf{c})$ 推导出来，因为这需要一个对称矩阵 $\\mathbf{K}$。", "answer": "$$\n\\boxed{\\frac{1}{3}}\n$$", "id": "2609992"}]}