{"hands_on_practices": [{"introduction": "我们的第一个动手实践将使用经典的泊松方程，深入探讨纯自然边界条件的精妙之处。与直接施加在解空间上的本质边界条件不同，自然边界条件是在推导弱形式的分部积分过程中自然产生的。本练习将引导你发现一个对问题可解性至关重要的要求——相容性条件，它将物理源项与边界通量联系起来，从而加深你对变分问题解的存在性和唯一性的理解 [@problem_id:2544240]。", "problem": "考虑一个在有界Lipschitz域 $\\Omega \\subset \\mathbb{R}^{2}$ 上的标量椭圆边值问题（一个偏微分方程），其外单位法向量为 $\\boldsymbol{n}$：\n$$\n-\\Delta u = f \\quad \\text{in } \\Omega, \n\\qquad \n\\boldsymbol{n}\\cdot \\nabla u = q \\quad \\text{on } \\partial\\Omega.\n$$\n在有限元法 (FEM) 的框架内，从弱形式的基本原理（即分部积分和散度定理）出发，完成以下任务：\n(a) 在索博列夫空间 $H^{1}(\\Omega)$ 上推导其弱形式，并清楚地指明在此设定下哪些边界条件是本质的，哪些是自然的。解释为何给定的诺伊曼条件属于其所属的类别。\n(b) 仅通过使用弱形式和容许的检验函数，推导出一个关于数据 $f$ 和 $q$ 的可解性必要相容性条件。将此条件表示为 $(f,q)$ 的单个标量泛函，其值必须为零才能保证可解性。\n(c) 解释此条件与解的存在性和唯一性的关系，并精确说明解在何种意义上是唯一的。\n(d) 现在取以下具体数据\n$$\n\\Omega = \\{(x,y)\\in\\mathbb{R}^{2}:\\; x^{2}+y^{2}  1\\}, \n\\qquad \nf(x,y) = x^{2}+y^{2}-1,\n\\qquad \nq|_{\\partial\\Omega}(\\theta) = \\cos\\theta,\n$$\n其中 $\\theta \\in [0,2\\pi)$ 是以弧度度量的极角，用于参数化 $\\partial\\Omega$。以精确的闭合形式计算(b)部分中的标量相容性泛函。你的最终答案必须是一个没有单位且无额外评论的精确数值。", "solution": "所给问题是带有纯诺伊曼边界条件的泊松方程的标准边值问题。我们将遵循严格的数学原理，逐步进行分析。\n\n首先，我们验证问题陈述的有效性。\n**步骤1：提取的已知条件**\n- 偏微分方程 (PDE): 在有界Lipschitz域 $\\Omega \\subset \\mathbb{R}^{2}$ 中，$-\\Delta u = f$。\n- 边界条件 (BC): 在边界 $\\partial\\Omega$ 上，$\\boldsymbol{n}\\cdot \\nabla u = q$，其中 $\\boldsymbol{n}$ 是外单位法向量。\n- 函数空间: 解 $u$ 和检验函数在索博列夫空间 $H^{1}(\\Omega)$ 中寻找。\n- (a)部分: 推导弱形式，将边界条件分类为本质的或自然的，并为给定的诺伊曼条件说明其分类理由。\n- (b)部分: 推导数据 $(f,q)$ 满足的可解性必要相容性条件。\n- (c)部分: 解释该条件与解的存在性和唯一性的关系。\n- (d)部分: 对于具体情况 $\\Omega = \\{(x,y)\\in\\mathbb{R}^{2}:\\; x^{2}+y^{2}  1\\}$, $f(x,y) = x^{2}+y^{2}-1$, 以及 $q|_{\\partial\\Omega}(\\theta) = \\cos\\theta$，计算在(b)部分推导的相容性泛函。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，对于分析是适定的（尽管该边值问题本身存在可解性问题，而这正是本题的主题），并且是客观的。它是偏微分方程理论及其通过有限元法进行数值求解中的一个典型问题。所有术语都有定义，所提供的数据在数学上是一致的，并且对于所需任务是完整的。该问题不违反任何无效标准。\n\n**结论：**该问题有效。\n\n我们现在开始解答。\n\n**(a) 弱形式和边界条件的分类**\n\n为了推导弱形式，我们从偏微分方程的强形式 $-\\Delta u = f$ 开始。我们将此方程乘以一个来自合适函数空间（指定为 $H^{1}(\\Omega)$）的任意检验函数 $v$，并在域 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} (-\\Delta u) v \\, d\\boldsymbol{x} = \\int_{\\Omega} f v \\, d\\boldsymbol{x}\n$$\n核心步骤是对左侧应用分部积分。对于多维情况，这可以通过使用散度定理来实现。具体来说，我们使用格林第一恒等式，其表述如下：\n$$\n\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{F}) \\phi \\, d\\boldsymbol{x} = - \\int_{\\Omega} \\boldsymbol{F} \\cdot \\nabla \\phi \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} \\phi (\\boldsymbol{F} \\cdot \\boldsymbol{n}) \\, dS\n$$\n令 $\\phi = v$ 且 $\\boldsymbol{F} = \\nabla u$，我们有 $\\nabla \\cdot \\boldsymbol{F} = \\Delta u$。因此，将该恒等式应用于我们的积分，得到：\n$$\n\\int_{\\Omega} (-\\Delta u) v \\, d\\boldsymbol{x} = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\boldsymbol{x} - \\int_{\\partial\\Omega} v (\\nabla u \\cdot \\boldsymbol{n}) \\, dS\n$$\n将其代回到我们的积分偏微分方程中，得到变分方程：\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\boldsymbol{x} - \\int_{\\partial\\Omega} v (\\boldsymbol{n} \\cdot \\nabla u) \\, dS = \\int_{\\Omega} f v \\, d\\boldsymbol{x}\n$$\n此时，我们将边界条件 $\\boldsymbol{n}\\cdot \\nabla u = q$ 纳入考虑。此条件被代入边界积分中：\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\boldsymbol{x} - \\int_{\\partial\\Omega} q v \\, dS = \\int_{\\Omega} f v \\, d\\boldsymbol{x}\n$$\n整理各项，我们得到最终的弱形式：求 $u \\in H^{1}(\\Omega)$，使得对于所有 $v \\in H^{1}(\\Omega)$，\n$$\na(u,v) = L(v)\n$$\n其中双线性形式 $a(u,v)$ 和线性泛函 $L(v)$ 定义为：\n$$\na(u,v) = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\boldsymbol{x}\n\\qquad \\text{and} \\qquad\nL(v) = \\int_{\\Omega} f v \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q v \\, dS\n$$\n在变分形式中，边界条件分类如下：\n- **本质边界条件**：这些是试探（通常也包括检验）空间中的函数必须明确满足的条件。例如，狄利克雷条件 $u=g$ 在 $\\partial\\Omega_D \\subset \\partial\\Omega$ 上会要求在一个仿射子空间 $\\{u \\in H^1(\\Omega) : u|_{\\partial\\Omega_D} = g \\}$ 中寻找解。它们是“本质的”，因为它们定义了函数空间本身。\n- **自然边界条件**：这些条件是作为变分方程对所有检验函数都成立的结果而被“弱”满足的。它们自然地产生于分部积分过程，并在弱形式中以边界积分的形式出现。\n\n在本问题中，条件 $\\boldsymbol{n} \\cdot \\nabla u = q$ 是一个**自然边界条件**。这是因为它并未施加于函数空间 $H^1(\\Omega)$ 上，而是被整合到了线性泛函 $L(v)$ 的定义中。它的满足是弱形式有效的一个推论。\n\n**(b) 相容性条件的推导**\n\n弱形式必须对所有检验函数 $v \\in H^{1}(\\Omega)$ 成立。对于有界域 $\\Omega$，空间 $H^{1}(\\Omega)$ 的一个特性是它包含常数函数。我们选择一个特定的检验函数 $v = c$，其中 $c$ 是一个非零实常数。对于这样的函数，其梯度恒等于零：$\\nabla v = \\nabla c = \\boldsymbol{0}$。\n\n将 $v=c$ 代入弱形式 $a(u,v) = L(v)$：\n左边变为：\n$$\na(u,c) = \\int_{\\Omega} \\nabla u \\cdot \\nabla c \\, d\\boldsymbol{x} = \\int_{\\Omega} \\nabla u \\cdot \\boldsymbol{0} \\, d\\boldsymbol{x} = 0\n$$\n右边变为：\n$$\nL(c) = \\int_{\\Omega} f c \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q c \\, dS = c \\left( \\int_{\\Omega} f \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q \\, dS \\right)\n$$\n为了使等式 $a(u,c)=L(c)$ 成立，我们必须有：\n$$\n0 = c \\left( \\int_{\\Omega} f \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q \\, dS \\right)\n$$\n由于这对任何非零常数 $c$ 都必须成立，它就导出了一个关于数据 $f$ 和 $q$ 的必要条件：\n$$\n\\int_{\\Omega} f \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q \\, dS = 0\n$$\n这就是解存在的相容性条件。其值必须为零的标量泛函正是此表达式。从物理角度（例如，稳态热传导）来看，此条件表示全局守恒：域内的总热源必须与通过边界的总热通量相平衡。\n\n**(c) 与存在性和唯一性的关系**\n\n- **存在性**：相容性条件 $\\int_{\\Omega} f \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q \\, dS = 0$ 是弱解存在的必要条件。对于此类椭圆问题，可以引用弗雷德霍姆择一性，它表明该条件对于解 $u \\in H^{1}(\\Omega)$ 的存在也是充分的。\n- **唯一性**：解不是唯一的。如果 $u$ 是弱形式的一个解，那么对于任意常数 $C$，函数 $u+C$ 也是一个解。这是因为 $\\nabla(u+C) = \\nabla u$，所以对于所有的 $v$，双线性形式 $a(u+C, v) = a(u,v)$ 保持不变。线性泛函 $L(v)$ 仅依赖于数据 $(f,q)$，与 $u$ 无关。因此，如果 $a(u,v) = L(v)$，那么 $a(u+C, v) = L(v)$ 也成立。\n为了正式地证明这一点，假设 $u_1$ 和 $u_2$ 是两个解。它们的差 $w = u_1 - u_2$ 满足 $f=0$ 和 $q=0$ 的齐次问题。$w$ 的弱形式是：\n$$\n\\int_{\\Omega} \\nabla w \\cdot \\nabla v \\, d\\boldsymbol{x} = 0 \\quad \\forall v \\in H^1(\\Omega)\n$$\n通过选择检验函数 $v = w$，我们得到：\n$$\n\\int_{\\Omega} \\nabla w \\cdot \\nabla w \\, d\\boldsymbol{x} = \\int_{\\Omega} |\\nabla w|^2 \\, d\\boldsymbol{x} = 0\n$$\n由于被积函数 $|\\nabla w|^2$ 是非负的，该等式意味着在 $\\Omega$ 上几乎处处有 $\\nabla w = \\boldsymbol{0}$。这意味着 $w$ 必须是一个常数函数，即 $w=C$。因此，任意两个解相差一个常数：$u_1 = u_2 + C$。解在相差一个加性常数的意义下是唯一的。为了获得完全唯一的解，需要一个额外的约束，例如强制要求 $\\int_{\\Omega} u \\, d\\boldsymbol{x} = 0$。\n\n**(d) 相容性泛函的计算**\n\n我们必须为给定的数据计算泛函 $F(f,q) = \\int_{\\Omega} f \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q \\, dS$ 的值。\n域是单位圆盘，$\\Omega = \\{(x,y) : x^2+y^2  1\\}$。我们使用极坐标 $(r,\\theta)$，其中 $x=r\\cos\\theta$ 且 $y=r\\sin\\theta$。微分面积元是 $d\\boldsymbol{x} = r\\,dr\\,d\\theta$。该域可由 $0 \\leq r \\leq 1$ 和 $0 \\leq \\theta  2\\pi$ 描述。源项是 $f(x,y) = x^2+y^2-1$，在极坐标下变为 $f(r,\\theta) = r^2-1$。\n\n第一个积分是在域 $\\Omega$ 上进行的：\n$$\n\\int_{\\Omega} f \\, d\\boldsymbol{x} = \\int_{0}^{2\\pi} \\int_{0}^{1} (r^2 - 1) r \\, dr \\, d\\theta\n$$\n被积函数与 $\\theta$ 无关，所以我们可以分离积分：\n$$\n= \\left( \\int_{0}^{2\\pi} d\\theta \\right) \\left( \\int_{0}^{1} (r^3 - r) \\, dr \\right)\n$$\n$$\n= (2\\pi) \\left[ \\frac{r^4}{4} - \\frac{r^2}{2} \\right]_{0}^{1}\n$$\n$$\n= 2\\pi \\left( \\left(\\frac{1^4}{4} - \\frac{1^2}{2}\\right) - (0) \\right) = 2\\pi \\left( \\frac{1}{4} - \\frac{2}{4} \\right) = 2\\pi \\left( -\\frac{1}{4} \\right) = -\\frac{\\pi}{2}\n$$\n第二个积分是在边界 $\\partial\\Omega$ 上进行的，即单位圆 $r=1$。微分弧长是 $dS = (1) d\\theta = d\\theta$。边界通量给定为 $q|_{\\partial\\Omega}(\\theta) = \\cos\\theta$。\n$$\n\\int_{\\partial\\Omega} q \\, dS = \\int_{0}^{2\\pi} \\cos\\theta \\, d\\theta\n$$\n$$\n= [\\sin\\theta]_{0}^{2\\pi} = \\sin(2\\pi) - \\sin(0) = 0 - 0 = 0\n$$\n最后，我们将两个结果相加，计算相容性泛函的值：\n$$\nF(f,q) = \\int_{\\Omega} f \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q \\, dS = -\\frac{\\pi}{2} + 0 = -\\frac{\\pi}{2}\n$$\n计算出的值为 $-\\frac{\\pi}{2}$。由于该值非零，这个特定的边值问题不存在解。然而，问题只要求计算这个值。", "answer": "$$\n\\boxed{-\\frac{\\pi}{2}}\n$$", "id": "2544240"}, {"introduction": "在之前的基础上，我们的第二个实践将处理一个更复杂、更真实的场景：一个在不同边界段上同时施加本质、自然和罗宾 (Robin) 边界条件的扩散问题。你将学习如何在弱形式中正确地划分边界积分以处理每种类型，包括罗宾条件的混合特性。此外，本练习还引入了强大的“制造解方法” (Method of Manufactured Solutions, MMS)，这是验证数值代码准确性的一个基石技术 [@problem_id:2544251]。", "problem": "对于一个二阶偏微分方程（PDE）应用有限元方法（FEM）的椭圆标量扩散模型，设 $\\Omega = (0,1)\\times(0,1)$ 是单位正方形，其边界 $\\partial\\Omega$ 被划分为三个不相交的部分。考虑其强形式\n$$-\\nabla\\cdot\\big(k(x,y)\\nabla u(x,y)\\big) = f(x,y)\\quad\\text{在 }\\Omega\\text{ 内},$$\n其中未知量和系数为人为设定\n$$u(x,y) = \\exp(x)\\big(\\sin(\\pi y)+y^2\\big),\\qquad k(x,y) = 1+xy.$$\n在不同的边界段上施加如下混合边界类型：\n- 本质（狄利克雷）边界 $\\Gamma_D = \\{(x,0): 0  x  1\\}$，指定值为 $u=g(x)$。\n- 自然（诺伊曼）边界 $\\Gamma_N = \\{(0,y): 0  y  1\\}$，指定通量为 $k\\nabla u \\cdot \\mathbf{n} = q(y)$。\n- 罗宾（Robin）边界 $\\Gamma_R$ 在 `y=1` 和 `x=1` 处，指定条件为 $k\\nabla u \\cdot \\mathbf{n} + \\alpha u = h$，其中系数 $\\alpha$ 在 `y=1` 处为 $\\alpha=1+x^2$，在 `x=1` 处为 $\\alpha=1+y^2$。\n\n任务：\n1. 推导该问题的弱形式，并指明每种边界条件（狄利克雷、诺伊曼、罗宾）为何属于本质或自然类别。\n2. 应用“制造解方法”，以精确的闭合形式计算一致性数据 `f`, `g`, `q`, 和 `h`。将 `f(x,y)` 的最终表达式放入答案框中。", "solution": "所提出的问题是有限元方法框架下的一个适定性练习，要求推导给定偏微分方程的弱形式，并为人为设定的解计算一致性数据。我们将按顺序完成各项任务。\n\n首先，我们来推导弱形式并对边界条件进行分类。问题的强形式由以下二阶椭圆偏微分方程给出：\n$$-\\nabla\\cdot\\big(k(x,y)\\nabla u(x,y)\\big) = f(x,y) \\quad \\text{在 } \\Omega \\text{ 内}$$\n为推导弱形式，我们将该偏微分方程乘以一个属于合适函数空间的任意测试函数 $v$，然后在整个域 $\\Omega$ 上进行积分：\n$$\\int_{\\Omega} -\\nabla\\cdot(k\\nabla u) v \\,d\\Omega = \\int_{\\Omega} f v \\,d\\Omega$$\n我们对左侧应用散度定理。在此背景下，散度定理通常表述为 Green 第一恒等式：$\\int_{\\Omega} \\mathbf{F} \\cdot \\nabla v \\, d\\Omega = -\\int_{\\Omega} (\\nabla \\cdot \\mathbf{F}) v \\, d\\Omega + \\oint_{\\partial\\Omega} (\\mathbf{F} \\cdot \\mathbf{n}) v \\, dS$。令 $\\mathbf{F} = k\\nabla u$。这样得到：\n$$\\int_{\\Omega} k\\nabla u \\cdot \\nabla v \\,d\\Omega - \\oint_{\\partial\\Omega} (k\\nabla u \\cdot \\mathbf{n}) v \\,dS = \\int_{\\Omega} f v \\,d\\Omega$$\n重新整理各项，我们得到了一般的变分形式：\n$$\\int_{\\Omega} k\\nabla u \\cdot \\nabla v \\,d\\Omega = \\int_{\\Omega} f v \\,d\\Omega + \\oint_{\\partial\\Omega} (k\\nabla u \\cdot \\mathbf{n}) v \\,dS$$\n根据给定的边界段 $\\partial\\Omega = \\Gamma_D \\cup \\Gamma_N \\cup \\Gamma_R$，边界积分被划分为：\n$$\\oint_{\\partial\\Omega} (k\\nabla u \\cdot \\mathbf{n}) v \\,dS = \\int_{\\Gamma_D} (k\\nabla u \\cdot \\mathbf{n}) v \\,dS + \\int_{\\Gamma_N} (k\\nabla u \\cdot \\mathbf{n}) v \\,dS + \\int_{\\Gamma_R} (k\\nabla u \\cdot \\mathbf{n}) v \\,dS$$\n现在我们结合边界条件并定义适当的函数空间。试探函数 $u$ 必须属于一个其导数至少是平方可积的函数空间，通常是索博列夫空间 $H^1(\\Omega)$。测试函数 $v$ 属于一个相关的空间。\n\n在 $\\Gamma_D$ 上的狄利克雷条件 $u=g$ 是一个**本质**边界条件。在有限元方法中，此类条件直接施加在试探函数的空间上。我们定义试探空间 $S = \\{ u \\in H^1(\\Omega) \\mid u|_{\\Gamma_D} = g \\}$ 和测试空间 $V_0 = \\{ v \\in H^1(\\Omega) \\mid v|_{\\Gamma_D} = 0 \\}$。通过要求在 $\\Gamma_D$ 上 $v=0$，$\\Gamma_D$ 上的积分 $\\int_{\\Gamma_D} (k\\nabla u \\cdot \\mathbf{n}) v \\,dS = 0$ 消失。这就是为什么该条件被称为本质条件：它是对函数空间本身的一个基本约束，并且测试函数的构造也遵循这一约束。\n\n在 $\\Gamma_N$ 上的诺伊曼条件 $k\\nabla u \\cdot \\mathbf{n} = q$ 和在 $\\Gamma_R$ 上的罗宾条件 $k\\nabla u \\cdot \\mathbf{n} + \\alpha u = h$ 是**自然**边界条件。它们从分部积分过程中“自然”地产生，并被整合到弱形式中。我们将这些条件代入剩余的边界积分中：\n- 在 $\\Gamma_N$ 上：$\\int_{\\Gamma_N} (k\\nabla u \\cdot \\mathbf{n}) v \\,dS = \\int_{\\Gamma_N} q v \\,dS$。\n- 在 $\\Gamma_R$ 上：$k\\nabla u \\cdot \\mathbf{n} = h - \\alpha u$。因此，$\\int_{\\Gamma_R} (k\\nabla u \\cdot \\mathbf{n}) v \\,dS = \\int_{\\Gamma_R} (h-\\alpha u) v \\,dS = \\int_{\\Gamma_R} h v \\,dS - \\int_{\\Gamma_R} \\alpha u v \\,dS$。\n\n将这些代入变分形式，并将所有涉及未知数 $u$ 的项移到左侧，我们得到最终的弱形式：\n寻找 $u \\in S$，使得对于所有 $v \\in V_0$：\n$$ \\int_{\\Omega} k\\nabla u \\cdot \\nabla v \\,d\\Omega + \\int_{\\Gamma_R} \\alpha u v \\,dS = \\int_{\\Omega} f v \\,d\\Omega + \\int_{\\Gamma_N} q v \\,dS + \\int_{\\Gamma_R} h v \\,dS $$\n诺伊曼和罗宾数据（$q$ 和 $h$）出现在右侧的线性泛函中，而罗宾项 $\\alpha u$ 则贡献于左侧的双线性形式。这些条件是在弱的、积分意义上满足的，而不是点态满足的，这就是为什么它们被称为自然条件。\n\n第二，我们为人为设定的解 $u(x,y) = \\exp(x)(\\sin(\\pi y)+y^2)$ 和系数 $k(x,y)=1+xy$ 计算一致性数据 $f, g, q, h$。\n\n1.  **源项 $f(x,y)$**：\n    $f = -\\nabla\\cdot(k\\nabla u)$。我们首先计算 $u$ 的梯度：\n    $$ \\frac{\\partial u}{\\partial x} = \\exp(x)(\\sin(\\pi y)+y^2) $$\n    $$ \\frac{\\partial u}{\\partial y} = \\exp(x)(\\pi \\cos(\\pi y)+2y) $$\n    源项是 $f = -\\left(\\frac{\\partial}{\\partial x}(k u_x) + \\frac{\\partial}{\\partial y}(k u_y)\\right)$。\n    $$ \\frac{\\partial}{\\partial x}(k u_x) = \\frac{\\partial}{\\partial x}\\big[ (1+xy)\\exp(x)(\\sin(\\pi y)+y^2) \\big] = (y)\\exp(x)(\\sin(\\pi y)+y^2) + (1+xy)\\exp(x)(\\sin(\\pi y)+y^2) = (1+y+xy)\\exp(x)(\\sin(\\pi y)+y^2) $$\n    $$ \\frac{\\partial}{\\partial y}(k u_y) = \\frac{\\partial}{\\partial y}\\big[ (1+xy)\\exp(x)(\\pi \\cos(\\pi y)+2y) \\big] = \\exp(x) \\big[ (x)(\\pi \\cos(\\pi y)+2y) + (1+xy)(-\\pi^2\\sin(\\pi y)+2) \\big] $$\n    将这些相加并乘以-1，得到 $f(x,y)$:\n    $$ f(x,y) = -\\exp(x) \\left[ (1+y+xy)(\\sin(\\pi y)+y^2) + x(\\pi \\cos(\\pi y)+2y) + (1+xy)(2-\\pi^2\\sin(\\pi y)) \\right] $$\n    展开并分组简化后：\n    $$ f(x,y) = -\\exp(x) \\left\\{ \\big[1+y-\\pi^2 + (1-\\pi^2)xy\\big]\\sin(\\pi y) + \\pi x \\cos(\\pi y) + (1+x)y^3 + y^2 + 4xy + 2 \\right\\} $$\n\n2.  **$\\Gamma_D$ 上的狄利克雷数据 $g$**：$\\Gamma_D = \\{(x,0): 0  x  1\\}$。\n    $$ g(x) = u(x,0) = \\exp(x)(\\sin(0)+0^2) = 0 $$\n\n3.  **$\\Gamma_N$ 上的诺伊曼数据 $q$**：$\\Gamma_N = \\{(0,y): 0  y  1\\}$。法向量 $\\mathbf{n}=(-1,0)$。\n    $$ q(y) = k\\nabla u \\cdot \\mathbf{n} = (1+0\\cdot y) \\left( \\frac{\\partial u}{\\partial x}(0,y) \\cdot (-1) \\right) = -1 \\cdot \\exp(0)(\\sin(\\pi y)+y^2) = -(\\sin(\\pi y)+y^2) $$\n\n4.  **$\\Gamma_R$ 上的罗宾数据 $h$**：$\\Gamma_R$ 由 $x=1$ 和 $y=1$ 两条边组成。\n    - 在 $x=1$ 的边上 ($0  y  1$): 法向量 $\\mathbf{n}=(1,0)$，$\\alpha=1+y^2$。\n      $$ h(y) = (k\\nabla u \\cdot \\mathbf{n} + \\alpha u)|_{x=1} = \\left(k \\frac{\\partial u}{\\partial x} + \\alpha u\\right)\\Big|_{x=1} $$\n      $$ h(y) = (1+y)\\exp(1)(\\sin(\\pi y)+y^2) + (1+y^2)\\exp(1)(\\sin(\\pi y)+y^2) = \\exp(1)(2+y+y^2)(\\sin(\\pi y)+y^2) $$\n    - 在 $y=1$ 的边上 ($0  x  1$): 法向量 $\\mathbf{n}=(0,1)$，$\\alpha=1+x^2$。\n      $$ h(x) = (k\\nabla u \\cdot \\mathbf{n} + \\alpha u)|_{y=1} = \\left(k \\frac{\\partial u}{\\partial y} + \\alpha u\\right)\\Big|_{y=1} $$\n      $$ \\frac{\\partial u}{\\partial y}(x,1) = \\exp(x)(\\pi\\cos(\\pi)+2) = (2-\\pi)\\exp(x) $$\n      $$ u(x,1) = \\exp(x)(\\sin(\\pi)+1) = \\exp(x) $$\n      $$ k(x,1) = 1+x $$\n      $$ h(x) = (1+x)(2-\\pi)\\exp(x) + (1+x^2)\\exp(x) = \\exp(x)[(1+x)(2-\\pi) + (1+x^2)] = \\exp(x)[x^2+(2-\\pi)x+3-\\pi] $$", "answer": "$$\n\\boxed{-\\exp(x) \\left\\{ \\left[1+y-\\pi^2 + (1-\\pi^2)xy\\right]\\sin(\\pi y) + \\pi x \\cos(\\pi y) + (1+x)y^3 + y^2 + 4xy + 2 \\right\\}}\n$$", "id": "2544251"}, {"introduction": "我们的最后一个练习将通过关注一维弹性杆问题，在抽象的变分原理与具体的工程应用之间架起一座桥梁。在施加本质边界条件以固定杆的一端后，一个自然的问题出现了：这个支撑点上的反力是多大？本练习将演示如何在求解系统*之后*，通过巧妙地利用弱形式本身来计算这个未知的力。这个过程揭示了反力的一个深刻身份：它们是与本质约束相关的离散拉格朗日乘子 [@problem_id:2544278]。", "problem": "考虑一根长度为 $L$ 的棱柱形线性弹性杆，其在区间 $[0,L]$ 上沿 $x$ 轴放置，具有恒定的杨氏模量 $E$ 和横截面积 $A$。轴向位移场为 $u(x)$。其一维控制强形式是平衡方程 $- (EA\\,u^{\\prime})^{\\prime} = q(x)$，并受边界条件约束。在有限元法 (FEM) 中，Dirichlet (本质) 边界条件指定主场（此处为位移），Neumann (自然) 边界条件指定牵引力，而 Robin 边界条件指定主场及其通量之间的仿射关系。在本问题中，该杆受到以下作用：\n- 在 $\\Gamma_{D} = \\{0\\}$ 上的本质边界条件 $u(0) = \\bar{u} = 0$，\n- 在右端 $x = L$ 上的 $\\Gamma_{N} = \\{L\\}$ 处施加的恒定自然牵引力 $\\bar{t}$，\n- 在 $[0,L]$ 上的恒定分布轴向载荷 $q(x) \\equiv q$，\n不存在 Robin 边界条件。\n\n从小应变线性弹性的虚功原理出发，弱形式表述为：寻找 $u \\in H^{1}([0,L])$ 且满足 $u(0)=\\bar{u}$，使得\n$$\n\\int_{0}^{L} EA\\,u^{\\prime}(x)\\,v^{\\prime}(x)\\,dx \\;=\\; \\int_{0}^{L} q\\,v(x)\\,dx \\;+\\; \\bar{t}\\,v(L) \\quad \\text{对所有满足 } v(0)=0 \\text{ 的 } v \\in H^{1}([0,L]) \\text{ 成立}。\n$$\n使用一个在 $[0,L]$ 上的线性有限元对杆进行离散化，该单元的节点位于 $x_{1}=0$ 和 $x_{2}=L$，其试探空间和检验空间的节点基函数为 $N_{1}(x)$ 和 $N_{2}(x)$。强施加本质边界条件 $u(0)=\\bar{u}=0$。\n\n使用以下材料和载荷数据：\n- $E = 200 \\times 10^{9}\\,\\text{Pa}$，\n- $A = 1.0 \\times 10^{-4}\\,\\text{m}^{2}$，\n- $L = 2.0\\,\\text{m}$，\n- $q = 1.0 \\times 10^{3}\\,\\text{N/m}$，\n- $\\bar{t} = 3.0 \\times 10^{3}\\,\\text{N}$。\n\n任务：\n1. 将 $x=0$ 和 $x=L$ 处的边界条件分类为本质、自然或 Robin 边界条件，并简要说明各自指定的物理量。\n2. 组装单单元离散系统，并求解 $x=L$ 处的未知节点位移。\n3. 通过将离散有限元解代入弱形式，并使用一个在 $\\Gamma_{D}$ 上有支撑的函数（具体来说，是在 $x=0$ 处不为零的节点基函数 $N_{1}$）进行检验，来计算本质边界 $\\Gamma_{D}$ 处的反作用力。将所得标量解释为与 $x=0$ 处的本质约束相关的离散拉格朗日乘子。\n\n将最终的反作用力表示为以牛顿 (N) 为单位的带符号标量。无需四舍五入；提供由给定数据隐含的精确值。", "solution": "对问题陈述进行验证。\n\n已知条件逐字摘录如下：\n-   域：长度为 $L$ 的棱柱形线性弹性杆，位于区间 $[0,L]$ 上。\n-   常数：恒定的杨氏模量 $E$ 和横截面积 $A$。\n-   场变量：轴向位移 $u(x)$。\n-   强形式：$- (EA\\,u^{\\prime})^{\\prime} = q(x)$。\n-   边界条件：\n    -   本质边界条件：在 $\\Gamma_{D} = \\{0\\}$ 上，$u(0) = \\bar{u} = 0$。\n    -   自然牵引力：在 $x = L$ 的 $\\Gamma_{N} = \\{L\\}$ 处为 $\\bar{t}$。\n    -   分布载荷：在 $[0,L]$ 上为 $q(x) \\equiv q$。\n-   弱形式：寻找 $u \\in H^{1}([0,L])$ 且满足 $u(0)=\\bar{u}$，使得对所有满足 $v(0)=0$ 的 $v \\in H^{1}([0,L])$，有 $\\int_{0}^{L} EA\\,u^{\\prime}(x)\\,v^{\\prime}(x)\\,dx = \\int_{0}^{L} q\\,v(x)\\,dx + \\bar{t}\\,v(L)$。\n-   离散化：在 $[0,L]$ 上使用一个线性有限元，节点位于 $x_{1}=0$ 和 $x_{2}=L$。节点基函数为 $N_{1}(x)$ 和 $N_{2}(x)$。本质边界条件被强施加。\n-   数据：$E = 200 \\times 10^{9}\\,\\text{Pa}$，$A = 1.0 \\times 10^{-4}\\,\\text{m}^{2}$，$L = 2.0\\,\\text{m}$，$q = 1.0 \\times 10^{3}\\,\\text{N/m}$，$\\bar{t} = 3.0 \\times 10^{3}\\,\\text{N}$。\n-   任务：1. 分类边界条件。2. 求解 $x=L$ 处的节点位移。3. 计算本质边界处的反作用力。\n\n验证结论：该问题是有效的。这是一个在线性弹性静力学中的标准、适定的问题，在有限元法的框架内被正确地构建。控制方程、弱形式和所提供的数据在物理上和数学上都是一致的。所有必要的信息都已提供。\n\n解答过程通过完成三个指定任务来进行。\n\n任务 1：边界条件的分类\n$x=0$ 处的边界条件是 $u(0) = \\bar{u} = 0$。该条件直接指定了主场变量，即位移 $u$ 的值。根据定义，这是一个**本质**边界条件。物理上，它代表一个固定支座，防止该点发生任何位移。\n$x=L$ 处的边界条件指定了一个牵引力 $\\bar{t}$。在弱形式的背景下，项 $\\bar{t}v(L)$ 源于对强形式进行分部积分，其中产生的边界项为 $[(EA u')v]_0^L$。因此，自然边界条件是 $EA u'(L) = \\bar{t}$。量 $EA u'$ 代表杆中的内部轴向力。因此，该条件指定了边界上的力。根据定义，这是一个**自然**边界条件。\n\n任务 2：离散系统的组装与求解\n域 $[0,L]$ 使用一个线性有限元进行离散化，节点位于 $x_1=0$ 和 $x_2=L$。位移场 $u(x)$ 被近似为 $u^h(x) = d_1 N_1(x) + d_2 N_2(x)$，其中 $d_1$ 和 $d_2$ 分别是 $x_1$ 和 $x_2$ 处的节点位移。\n在区间 $[0,L]$ 上的线性基函数为：\n$$\nN_{1}(x) = 1 - \\frac{x}{L} \\quad \\text{和} \\quad N_{2}(x) = \\frac{x}{L}\n$$\n它们的导数是常数：\n$$\nN_{1}^{\\prime}(x) = -\\frac{1}{L} \\quad \\text{和} \\quad N_{2}^{\\prime}(x) = \\frac{1}{L}\n$$\n离散方程组为 $\\mathbf{K}\\mathbf{d} = \\mathbf{f}$，其中 $\\mathbf{K}$ 是刚度矩阵，$\\mathbf{f}$ 是力向量。\n\n刚度矩阵的分量 $K_{ij} = \\int_{0}^{L} E A N_{i}^{\\prime}(x) N_{j}^{\\prime}(x) dx$ 为：\n$K_{11} = \\int_{0}^{L} E A (-\\frac{1}{L})(-\\frac{1}{L}) dx = \\frac{EA}{L}$\n$K_{12} = \\int_{0}^{L} E A (-\\frac{1}{L})(\\frac{1}{L}) dx = -\\frac{EA}{L}$\n$K_{21} = K_{12} = -\\frac{EA}{L}$\n$K_{22} = \\int_{0}^{L} E A (\\frac{1}{L})(\\frac{1}{L}) dx = \\frac{EA}{L}$\n因此，刚度矩阵为：\n$$\n\\mathbf{K} = \\frac{EA}{L} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n力向量的分量 $f_i = \\int_{0}^{L} q N_{i}(x) dx + \\bar{t} N_i(L)$ 为：\n$f_1 = \\int_{0}^{L} q (1-\\frac{x}{L}) dx + \\bar{t} N_1(L) = q \\left[x - \\frac{x^2}{2L}\\right]_{0}^{L} + \\bar{t}(0) = \\frac{qL}{2}$\n$f_2 = \\int_{0}^{L} q (\\frac{x}{L}) dx + \\bar{t} N_2(L) = q \\left[\\frac{x^2}{2L}\\right]_{0}^{L} + \\bar{t}(1) = \\frac{qL}{2} + \\bar{t}$\n因此，力向量为：\n$$\n\\mathbf{f} = \\begin{pmatrix} \\frac{qL}{2} \\\\ \\frac{qL}{2} + \\bar{t} \\end{pmatrix}\n$$\n完整的离散系统为：\n$$\n\\frac{EA}{L} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{qL}{2} \\\\ \\frac{qL}{2} + \\bar{t} \\end{pmatrix}\n$$\n本质边界条件 $u(0)=0$ 被强施加，即设置节点位移 $d_1 = 0$。未知位移 $d_2$ 可从方程组的第二个方程中求得：\n$$\n\\frac{EA}{L} (-d_1 + d_2) = \\frac{qL}{2} + \\bar{t}\n$$\n代入 $d_1=0$：\n$$\n\\frac{EA}{L} d_2 = \\frac{qL}{2} + \\bar{t}\n$$\n求解 $d_2$：\n$$\nd_2 = \\frac{L}{EA} \\left( \\frac{qL}{2} + \\bar{t} \\right)\n$$\n使用所提供的数据：$E = 200 \\times 10^{9}\\,\\text{Pa}$，$A = 1.0 \\times 10^{-4}\\,\\text{m}^{2}$，$L = 2.0\\,\\text{m}$，$q = 1.0 \\times 10^{3}\\,\\text{N/m}$，$\\bar{t} = 3.0 \\times 10^{3}\\,\\text{N}$。\n轴向刚度为 $EA = (200 \\times 10^{9}) \\times (1.0 \\times 10^{-4}) = 2.0 \\times 10^{7}\\,\\text{N}$。\n在节点2处的分布载荷合力分量为 $\\frac{qL}{2} = \\frac{(1.0 \\times 10^{3})(2.0)}{2} = 1.0 \\times 10^{3}\\,\\text{N}$。\n在 $x=L$ 处的位移为：\n$$\nd_2 = \\frac{2.0}{2.0 \\times 10^{7}} \\left( 1.0 \\times 10^{3} + 3.0 \\times 10^{3} \\right) = 1.0 \\times 10^{-7} (4.0 \\times 10^{3}) = 4.0 \\times 10^{-4}\\,\\text{m}\n$$\n\n任务 3：反作用力的计算\n本质边界 $x=0$ 处的反作用力 $R$ 通过将有限元解 $u^h(x)$ 代入弱形式，并使用一个在 $x=0$ 处不为零的检验函数 $v(x)$ 来计算。问题指定使用基函数 $v(x) = N_1(x)$。\n完整的虚功陈述，包括在 $x=0$ 处的反作用力 $R$ 所做的功，为：\n$$\n\\int_{0}^{L} EA\\,u^{\\prime}(x)\\,v^{\\prime}(x)\\,dx = \\int_{0}^{L} q\\,v(x)\\,dx + \\bar{t}\\,v(L) + R\\,v(0)\n$$\n我们将 $u(x) = u^h(x) = d_2 N_2(x)$ (因为 $d_1=0$) 和 $v(x) = N_1(x)$ 代入该方程。对于此检验函数，$v(0)=N_1(0)=1$ 且 $v(L)=N_1(L)=0$。方程变为：\n$$\n\\int_{0}^{L} EA\\, (d_2 N_2'(x)) \\, N_1'(x)\\, dx = \\int_{0}^{L} q\\, N_1(x)\\, dx + \\bar{t}\\,(0) + R\\,(1)\n$$\n这可以简化为：\n$$\nd_2 \\int_{0}^{L} EA\\, N_2'(x) N_1'(x)\\, dx = \\int_{0}^{L} q\\, N_1(x)\\, dx + R\n$$\n这些项可以从已组装的系统中识别出来：\n左边的积分是 $d_2 K_{12} = d_2 (-\\frac{EA}{L})$。\n右边的积分是力向量的第一个分量，$f_1 = \\frac{qL}{2}$。\n所以我们有：\n$$\n-d_2 \\frac{EA}{L} = \\frac{qL}{2} + R\n$$\n求解反作用力 $R$：\n$$\nR = -d_2 \\frac{EA}{L} - \\frac{qL}{2}\n$$\n代入 $d_2 = \\frac{L}{EA}(\\frac{qL}{2} + \\bar{t})$ 的表达式：\n$$\nR = -\\left(\\frac{L}{EA} \\left( \\frac{qL}{2} + \\bar{t} \\right)\\right) \\frac{EA}{L} - \\frac{qL}{2} = - \\left( \\frac{qL}{2} + \\bar{t} \\right) - \\frac{qL}{2} = -qL - \\bar{t}\n$$\n这个结果与静力平衡一致：反作用力必须平衡总外加载荷，即积分分布载荷 $qL$ 和点载荷 $\\bar{t}$ 的总和。\n现在，我们计算其数值：\n$$\nqL = (1.0 \\times 10^{3}\\,\\text{N/m}) \\times (2.0\\,\\text{m}) = 2.0 \\times 10^{3}\\,\\text{N}\n$$\n$$\n\\bar{t} = 3.0 \\times 10^{3}\\,\\text{N}\n$$\n反作用力是：\n$$\nR = -(2.0 \\times 10^{3}\\,\\text{N}) - (3.0 \\times 10^{3}\\,\\text{N}) = -5.0 \\times 10^{3}\\,\\text{N}\n$$\n负号表示支座施加在杆上的反作用力作用于负 $x$ 方向，这在物理上是正确的，因为它与所施加的载荷方向相反。", "answer": "$$\n\\boxed{-5.0 \\times 10^{3}}\n$$", "id": "2544278"}]}