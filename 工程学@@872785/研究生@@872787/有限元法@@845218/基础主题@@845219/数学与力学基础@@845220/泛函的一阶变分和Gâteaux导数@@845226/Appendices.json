{"hands_on_practices": [{"introduction": "泛函的一阶变分是连接变分原理和偏微分方程的桥梁。这个练习将指导你从一个基本的能量泛函（泊松能量）出发，通过计算其在任意方向上的 Gâteaux 导数，来推导出系统的控制方程（即欧拉-拉格朗日方程）及其对应的边界条件 [@problem_id:3035874]。这个过程是有限元方法等变分数值方法的核心，它揭示了物理定律如何从“能量最小化”这一更基本的原理中产生。", "problem": "设 $\\Omega \\subset \\mathbb{R}^{n}$ 是一个有界 Lipschitz 区域，其单位外法向量为 $\\nu$，并设 $f \\in L^{2}(\\Omega)$。考虑泊松 (Poisson) 能量泛函 $J:H^{1}(\\Omega)\\to \\mathbb{R}$，定义为\n$$\nJ(u)\\equiv \\frac{1}{2}\\int_{\\Omega}|\\nabla u|^{2}\\,dx-\\int_{\\Omega}f\\,u\\,dx.\n$$\n使用变分法，从 Gâteaux 导数的定义和散度定理出发，完成以下步骤，不借助任何预先给出的 Euler–Lagrange 公式。\n\n(1) 通过计算在任意方向 $v \\in H^{1}(\\Omega)$ 上的一阶变分 $\\delta J(u;v)$，推导 $J$ 在极小值点 $u \\in H^{1}(\\Omega)$ 处的弱平稳性条件。\n\n(2) 特别地，考虑 Dirichlet 类 $H^{1}_{0}(\\Omega)$，其中 $v$ 的迹在 $\\partial\\Omega$ 上为零。从弱平稳性条件出发，在假设具有足够光滑性的前提下，确定极小值点在经典意义下满足的相关偏微分方程 (PDE) 和边界条件。\n\n(3) 对 Neumann 类重复此推导，其中 $u$ 在 $\\partial\\Omega$ 上是自由的，且变分 $v$ 在 $\\partial\\Omega$ 上不必为零。确定由平稳性所蕴含的自然边界条件，并陈述求解所需满足的关于 $f$ 的任何相容性条件。\n\n(4) 对于 Dirichlet 类 $H^{1}_{0}(\\Omega)$，确定由弱形式产生的双线性形式 $a(u,v)$ 和线性泛函 $\\ell(v)$。使用范数 $\\|u\\|_{H^{1}_{0}(\\Omega)}\\equiv \\left(\\int_{\\Omega}|\\nabla u|^{2}\\,dx\\right)^{1/2}$，验证 Lax–Milgram 定理关于 $a(\\cdot,\\cdot)$ 的连续性和矫顽性假设，以及关于 $\\ell(\\cdot)$ 的连续性假设，并计算由下式定义的矫顽性常数 $\\alpha$\n$$\na(u,u)\\ge \\alpha\\,\\|u\\|_{H^{1}_{0}(\\Omega)}^{2}\\quad\\text{对所有 }u\\in H^{1}_{0}(\\Omega).\n$$\n\n你最终报告的答案应该是矫顽性常数 $\\alpha$ 的值，它是一个实数。不需要四舍五入，也不涉及单位。最终答案中不要报告任何中间方程。", "solution": "本题要求对泊松能量泛函、其平稳性条件以及 Lax-Milgram 定理的应用进行多步推导。我们将按照指示，从基本原理出发，依次解决每个部分。\n\n(1) 弱平稳性条件的推导。\n\n泛函 $J(u)$ 在点 $u \\in H^{1}(\\Omega)$ 处沿方向 $v \\in H^{1}(\\Omega)$ 的 Gâteaux 导数（或一阶变分）定义为\n$$\n\\delta J(u;v) = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} J(u+\\epsilon v) = \\lim_{\\epsilon \\to 0} \\frac{J(u+\\epsilon v) - J(u)}{\\epsilon}.\n$$\n我们首先计算对于标量 $\\epsilon \\in \\mathbb{R}$ 的 $J(u+\\epsilon v)$：\n$$\nJ(u+\\epsilon v) = \\frac{1}{2}\\int_{\\Omega}|\\nabla (u+\\epsilon v)|^{2}\\,dx - \\int_{\\Omega}f(u+\\epsilon v)\\,dx.\n$$\n梯度项的平方范数可以展开为：\n$$\n|\\nabla (u+\\epsilon v)|^{2} = |\\nabla u + \\epsilon \\nabla v|^{2} = (\\nabla u + \\epsilon \\nabla v) \\cdot (\\nabla u + \\epsilon \\nabla v) = |\\nabla u|^{2} + 2\\epsilon(\\nabla u \\cdot \\nabla v) + \\epsilon^{2}|\\nabla v|^{2}.\n$$\n将此代回 $J(u+\\epsilon v)$ 的表达式中，并利用积分的线性性质，我们得到\n$$\nJ(u+\\epsilon v) = \\frac{1}{2}\\int_{\\Omega} (|\\nabla u|^{2} + 2\\epsilon(\\nabla u \\cdot \\nabla v) + \\epsilon^{2}|\\nabla v|^{2})\\,dx - \\int_{\\Omega} (fu + \\epsilon fv)\\,dx\n$$\n$$\nJ(u+\\epsilon v) = \\left(\\frac{1}{2}\\int_{\\Omega}|\\nabla u|^{2}\\,dx - \\int_{\\Omega}fu\\,dx\\right) + \\epsilon \\left(\\int_{\\Omega}(\\nabla u \\cdot \\nabla v)\\,dx - \\int_{\\Omega}fv\\,dx\\right) + \\frac{\\epsilon^{2}}{2}\\int_{\\Omega}|\\nabla v|^{2}\\,dx.\n$$\n第一项恰好是 $J(u)$。因此，差值为\n$$\nJ(u+\\epsilon v) - J(u) = \\epsilon \\left(\\int_{\\Omega}(\\nabla u \\cdot \\nabla v)\\,dx - \\int_{\\Omega}fv\\,dx\\right) + \\frac{\\epsilon^{2}}{2}\\int_{\\Omega}|\\nabla v|^{2}\\,dx.\n$$\n两边除以 $\\epsilon$ 并取 $\\epsilon \\to 0$ 的极限：\n$$\n\\delta J(u;v) = \\lim_{\\epsilon \\to 0} \\left[ \\left(\\int_{\\Omega}(\\nabla u \\cdot \\nabla v)\\,dx - \\int_{\\Omega}fv\\,dx\\right) + \\frac{\\epsilon}{2}\\int_{\\Omega}|\\nabla v|^{2}\\,dx \\right]\n$$\n$$\n\\delta J(u;v) = \\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx - \\int_{\\Omega}f v\\,dx.\n$$\n极小值点 $u$ 是泛函 $J$ 的一个平稳点，这意味着其一阶变分对于所有容许方向 $v$ 都必须为零。因此，弱平稳性条件为 $\\delta J(u;v) = 0$，具体表达式为：\n$$\n\\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx - \\int_{\\Omega}f v\\,dx = 0 \\quad \\text{对所有 } v \\in H^{1}(\\Omega).\n$$\n\n(2) 在 $H^{1}_{0}(\\Omega)$ 上的 Dirichlet 问题。\n\n我们现在专门讨论函数空间为 $H^{1}_{0}(\\Omega)$ 的情况，这是边界 $\\partial\\Omega$ 上迹为零的 $H^{1}$ 函数空间。极小值点 $u$ 必须属于 $H^{1}_{0}(\\Omega)$，变分 $v$ 也必须在 $H^{1}_{0}(\\Omega)$ 中。弱平稳性条件为\n$$\n\\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx = \\int_{\\Omega}f v\\,dx \\quad \\text{对所有 } v \\in H^{1}_{0}(\\Omega).\n$$\n为了推导 PDE，我们假设极小值点 $u$ 具有足够的光滑性（例如，$u \\in H^{2}(\\Omega)$），从而经典导数和散度定理可以应用。我们使用 Green 第一恒等式，它是散度定理应用于向量场 $v\\nabla u$ 的一个推论：$\\text{div}(v\\nabla u) = v\\Delta u + \\nabla v \\cdot \\nabla u$。在 $\\Omega$ 上积分得到\n$$\n\\int_{\\Omega} (v\\Delta u + \\nabla v \\cdot \\nabla u) \\,dx = \\int_{\\partial\\Omega} (v\\nabla u) \\cdot \\nu \\,dS.\n$$\n重新整理，我们得到\n$$\n\\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx = -\\int_{\\Omega}v \\Delta u \\,dx + \\int_{\\partial\\Omega}v (\\nabla u \\cdot \\nu)\\,dS.\n$$\n由于 $v \\in H^{1}_{0}(\\Omega)$，其在边界上的迹为零，所以 $v|_{\\partial\\Omega}=0$。边界积分消失。将此代入弱形式中：\n$$\n-\\int_{\\Omega}v \\Delta u \\,dx = \\int_{\\Omega}f v\\,dx \\quad \\implies \\quad \\int_{\\Omega}(-\\Delta u - f)v\\,dx = 0.\n$$\n该方程必须对所有 $v \\in H^{1}_{0}(\\Omega)$ 成立。由于具有紧支集的无穷次可微函数空间 $C_{c}^{\\infty}(\\Omega)$ 是 $H^{1}_{0}(\\Omega)$ 的一个稠密子空间，该等式对所有 $v \\in C_{c}^{\\infty}(\\Omega)$ 成立。根据变分法基本引理，如果一个函数与所有光滑、紧支集函数的乘积积分为零，则该函数本身必须几乎处处为零。因此，我们得到偏微分方程：\n$$\n-\\Delta u = f \\quad \\text{在 } \\Omega \\text{ 中}.\n$$\n边界条件由解所在的函数空间所决定：$u \\in H^{1}_{0}(\\Omega)$，这意味着齐次 Dirichlet 边界条件：\n$$\nu = 0 \\quad \\text{在 } \\partial\\Omega \\text{ 上}.\n$$\n\n(3) Neumann 问题。\n\n对于 Neumann 问题，解 $u$ 和变分 $v$ 都在 $H^{1}(\\Omega)$ 中，对其边界值没有先验约束。弱平稳性条件同样是\n$$\n\\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx - \\int_{\\Omega}f v\\,dx = 0 \\quad \\text{对所有 } v \\in H^{1}(\\Omega).\n$$\n像之前一样应用 Green 第一恒等式（同样假设 $u$ 具有足够的光滑性）：\n$$\n\\left(-\\int_{\\Omega}v \\Delta u \\,dx + \\int_{\\partial\\Omega}v (\\nabla u \\cdot \\nu)\\,dS\\right) - \\int_{\\Omega}f v\\,dx = 0.\n$$\n重新整理得到\n$$\n\\int_{\\Omega}(-\\Delta u - f)v\\,dx + \\int_{\\partial\\Omega} (\\nabla u \\cdot \\nu) v \\,dS = 0 \\quad \\text{对所有 } v \\in H^{1}(\\Omega).\n$$\n这个等式必须对 $v \\in H^{1}(\\Omega)$ 的任何选择都成立。我们可以首先从子空间 $H^{1}_{0}(\\Omega)$ 中选择变分 $v$，对于这些 $v$，$v|_{\\partial\\Omega}=0$。对于这样的 $v$，边界积分为零，我们得到 $\\int_{\\Omega}(-\\Delta u - f)v\\,dx = 0$。如同第(2)部分，这蕴含了偏微分方程：\n$$\n-\\Delta u = f \\quad \\text{在 } \\Omega \\text{ 中}.\n$$\n由于这个 PDE 必须成立，它必须在完整的平稳性条件内得到满足。将 $-\\Delta u = f$ 代回该条件，得到：\n$$\n\\int_{\\partial\\Omega} (\\nabla u \\cdot \\nu) v \\,dS = 0 \\quad \\text{对所有 } v \\in H^{1}(\\Omega).\n$$\n由于从 $H^{1}(\\Omega)$到$L^{2}(\\partial\\Omega)$的迹算子是满射的，我们可以选择 $v$ 使得其迹 $v|_{\\partial\\Omega}$ 可以是 $L^{2}(\\partial\\Omega)$ 中的任意函数（或其稠密子集）。为了让积分对所有这些选择都为零，被积函数中的另一个因子必须为零。这给出了自然边界条件：\n$$\n\\nabla u \\cdot \\nu = \\frac{\\partial u}{\\partial \\nu} = 0 \\quad \\text{在 } \\partial\\Omega \\text{ 上}.\n$$\n这就是齐次 Neumann 边界条件。\n为了问题的可解性，对 $f$ 有一个相容性条件。将 PDE $-\\Delta u = f$ 在区域 $\\Omega$ 上积分：\n$$\n-\\int_{\\Omega}\\Delta u \\,dx = \\int_{\\Omega}f\\,dx.\n$$\n对左边应用散度定理：\n$$\n-\\int_{\\Omega}\\text{div}(\\nabla u) \\,dx = -\\int_{\\partial\\Omega}\\nabla u \\cdot \\nu \\,dS.\n$$\n使用自然边界条件 $\\nabla u \\cdot \\nu = 0$，左边变为 $0$。因此，为了使解存在，右边也必须为零。这就给出了相容性条件：\n$$\n\\int_{\\Omega}f\\,dx = 0.\n$$\n\n(4) Dirichlet 问题的 Lax-Milgram 假设。\n\nDirichlet 问题的弱形式是：求 $u \\in H^{1}_{0}(\\Omega)$ 使得\n$$\n\\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx = \\int_{\\Omega}f v\\,dx \\quad \\text{对所有 } v \\in H^{1}_{0}(\\Omega).\n$$\n其形式为 $a(u,v) = \\ell(v)$，其中：\n- 双线性形式为 $a(u,v) = \\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx$。\n- 线性泛函为 $\\ell(v) = \\int_{\\Omega}f v\\,dx$。\nHilbert 空间是 $V = H^{1}_{0}(\\Omega)$，其范数指定为 $\\|w\\|_{H^{1}_{0}(\\Omega)} = \\left(\\int_{\\Omega}|\\nabla w|^{2}\\,dx\\right)^{1/2}$。根据 Poincaré 不等式，这是 $H^{1}_{0}(\\Omega)$ 上的一个有效范数。\n\n我们验证 Lax-Milgram 定理的假设：$a(\\cdot,\\cdot)$ 的连续性和矫顽性，以及 $\\ell(\\cdot)$ 的连续性。\n\n- **$a(u,v)$ 的连续性**：我们必须证明存在一个常数 $M > 0$ 使得 $|a(u,v)| \\le M \\|u\\|_{H^{1}_{0}(\\Omega)}\\|v\\|_{H^{1}_{0}(\\Omega)}$ 对所有 $u, v \\in H^{1}_{0}(\\Omega)$ 成立。\n根据积分的 Cauchy-Schwarz 不等式，应用于标量函数 $|\\nabla u||\\nabla v|$：\n$$\n|a(u,v)| = \\left|\\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx\\right| \\le \\int_{\\Omega}|\\nabla u \\cdot \\nabla v|\\,dx.\n$$\n根据 $\\mathbb{R}^n$ 中向量的点积 Cauchy-Schwarz 不等式：$|\\nabla u \\cdot \\nabla v| \\le |\\nabla u||\\nabla v|$。因此，\n$$\n\\int_{\\Omega}|\\nabla u \\cdot \\nabla v|\\,dx \\le \\int_{\\Omega}|\\nabla u||\\nabla v|\\,dx.\n$$\n再次应用积分的 Cauchy-Schwarz 不等式：\n$$\n\\int_{\\Omega}|\\nabla u||\\nabla v|\\,dx \\le \\left(\\int_{\\Omega}|\\nabla u|^{2}\\,dx\\right)^{1/2} \\left(\\int_{\\Omega}|\\nabla v|^{2}\\,dx\\right)^{1/2}.\n$$\n使用给定的范数定义，这便是\n$$\n|a(u,v)| \\le \\|u\\|_{H^{1}_{0}(\\Omega)}\\|v\\|_{H^{1}_{0}(\\Omega)}.\n$$\n因此，$a(\\cdot,\\cdot)$ 是连续的，其连续性常数为 $M = 1$。\n\n- **$\\ell(v)$ 的连续性**：我们必须证明存在一个常数 $C > 0$ 使得 $|\\ell(v)| \\le C \\|v\\|_{H^{1}_{0}(\\Omega)}$ 对所有 $v \\in H^{1}_{0}(\\Omega)$ 成立。\n$$\n|\\ell(v)| = \\left|\\int_{\\Omega}f v\\,dx\\right|.\n$$\n根据 Cauchy-Schwarz 不等式，\n$$\n|\\ell(v)| \\le \\left(\\int_{\\Omega}|f|^{2}\\,dx\\right)^{1/2} \\left(\\int_{\\Omega}|v|^{2}\\,dx\\right)^{1/2} = \\|f\\|_{L^{2}(\\Omega)}\\|v\\|_{L^{2}(\\Omega)}.\n$$\n对于有界区域 $\\Omega$ 的 Poincaré 不等式指出，存在一个仅依赖于 $\\Omega$ 和 $n$ 的常数 $C_{P} > 0$，使得对于任意 $v \\in H^{1}_{0}(\\Omega)$，\n$$\n\\|v\\|_{L^{2}(\\Omega)} \\le C_{P} \\|\\nabla v\\|_{L^{2}(\\Omega)} = C_{P} \\left(\\int_{\\Omega}|\\nabla v|^{2}\\,dx\\right)^{1/2}.\n$$\n使用题目中对 $H^{1}_{0}(\\Omega)$ 上范数的定义，这便是 $\\|v\\|_{L^{2}(\\Omega)} \\le C_{P} \\|v\\|_{H^{1}_{0}(\\Omega)}$。将此代入关于 $|\\ell(v)|$ 的不等式中：\n$$\n|\\ell(v)| \\le \\|f\\|_{L^{2}(\\Omega)} (C_{P} \\|v\\|_{H^{1}_{0}(\\Omega)}) = (C_{P}\\|f\\|_{L^{2}(\\Omega)}) \\|v\\|_{H^{1}_{0}(\\Omega)}.\n$$\n由于 $f \\in L^{2}(\\Omega)$，$\\|f\\|_{L^{2}(\\Omega)}$ 是有限的。因此，$\\ell(\\cdot)$ 是连续的，其连续性常数为 $C = C_{P}\\|f\\|_{L^{2}(\\Omega)}$。\n\n- **$a(u,u)$ 的矫顽性**：我们必须找到一个常数 $\\alpha > 0$ 使得 $a(u,u) \\ge \\alpha \\|u\\|_{H^{1}_{0}(\\Omega)}^{2}$ 对所有 $u \\in H^{1}_{0}(\\Omega)$ 成立。\n根据双线性形式的定义，\n$$\na(u,u) = \\int_{\\Omega}\\nabla u \\cdot \\nabla u\\,dx = \\int_{\\Omega}|\\nabla u|^{2}\\,dx.\n$$\n根据题目中提供的范数定义，\n$$\n\\|u\\|_{H^{1}_{0}(\\Omega)}^{2} = \\left(\\left(\\int_{\\Omega}|\\nabla u|^{2}\\,dx\\right)^{1/2}\\right)^{2} = \\int_{\\Omega}|\\nabla u|^{2}\\,dx.\n$$\n因此，我们有等式\n$$\na(u,u) = \\|u\\|_{H^{1}_{0}(\\Omega)}^{2}.\n$$\n通过选择 $\\alpha = 1$，这可以写成不等式 $a(u,u) \\ge \\alpha \\|u\\|_{H^{1}_{0}(\\Omega)}^{2}$。由于 $1 > 0$，该双线性形式是矫顽的。矫顽性常数为 $\\alpha = 1$。", "answer": "$$\\boxed{1}$$", "id": "3035874"}, {"introduction": "找到泛函的驻点（一阶变分为零的点）只是第一步，但这并不足以保证该点是能量的极小值点，尤其是在处理非凸泛函时。本练习通过一个典型的“双阱”非凸模型，演示了如何出现多个驻点，并探讨了一阶变分在判断极小值时的局限性 [@problem_id:2559350]。这有助于我们理解为何需要二阶变分等更高阶的分析工具来确定解的稳定性，这在非线性力学和物理学中至关重要。", "problem": "考虑泛函 $J: H_0^1(0,1) \\to \\mathbb{R}$，其表达式为\n$$\nJ(u) \\;=\\; \\int_0^1 \\left( \\frac{\\varepsilon^2}{2}\\,|u'(x)|^2 \\;-\\; \\frac{\\alpha}{2}\\,u(x)^2 \\;+\\; \\frac{\\beta}{4}\\,u(x)^4 \\right)\\,dx,\n$$\n其中参数 $\\varepsilon>0$，$\\alpha>0$ 和 $\\beta>0$。该泛函源于一种双阱模型，并且由于二次项和四次项之间的竞争，它关于 $u$ 是非凸的。考虑在试探空间 $V_h=\\mathrm{span}\\{\\varphi\\}$（其中 $\\varphi(x)=\\sin(\\pi x)$）上的一维伽辽金离散化，并通过 $u_h(x)=a\\,\\varphi(x)$ 将 $J$ 限制在 $V_h$ 上，从而得到一个标量泛函 $J_h:\\mathbb{R}\\to\\mathbb{R}$，$J_h(a)=J(a\\varphi)$。\n\n仅使用一阶变分（Gâteaux 导数）的定义，\n$$\n\\delta J_h(a;\\delta a) \\;=\\; \\left.\\frac{d}{dt}\\,J_h(a+t\\,\\delta a)\\right|_{t=0},\n$$\n并结合标准微积分以及 $H_0^1(0,1)$ 和 $\\varphi$ 的性质，推导出 $J_h$ 的驻点条件，并确定 $J_h$ 存在多个驻点的参数范围。然后，回答以下关于一阶变分能揭示什么以及不能确定什么（关于极小值点）的多项选择题。此处，记\n$$\nI_0 \\;=\\;\\int_0^1 \\varphi(x)^2\\,dx,\\quad I_2 \\;=\\;\\int_0^1 |\\varphi'(x)|^2\\,dx,\\quad I_4 \\;=\\;\\int_0^1 \\varphi(x)^4\\,dx.\n$$\n\n选择所有正确的陈述。\n\nA. 如果 $\\alpha\\,I_0>\\varepsilon^2\\,I_2$，那么 $J_h$ 恰好有三个驻点 $a=0$ 和 $a=\\pm a_\\star\\neq 0$，并且仅凭一阶变分无法确定哪些是极小值点。\n\nB. 因为一阶变分在 $a=0$ 处为零，所以对于所有参数值，$a=0$ 必然是 $J_h$ 的一个极小值点。\n\nC. 一阶变分可以导出欧拉方程，因此足以推断 $J$ 在 $H_0^1(0,1)$ 上是非凸的。\n\nD. 极小性需要考察二阶变分：当 $\\alpha\\,I_0>\\varepsilon^2\\,I_2$ 时，有 $J_h''(0)  0$（因此 $a=0$ 不是极小值点）和 $J_h''(\\pm a_\\star)0$（因此 $a=\\pm a_\\star$ 是局部极小值点）。\n\nE. 在非凸情形 $\\alpha\\,I_0\\varepsilon^2\\,I_2$ 下，两个非零驻点是 $J_h$ 的全局极小值点，但这不能仅从一阶变分中得出结论。", "solution": "我们从标量简化泛函 $J_h(a)=J(a\\varphi)$ 的 Gâteaux 导数（一阶变分）的定义开始：\n$$\n\\delta J_h(a;\\delta a) \\;=\\; \\left.\\frac{d}{dt}J_h(a+t\\,\\delta a)\\right|_{t=0}.\n$$\n因为 $u_h(x)=a\\,\\varphi(x)$，我们有 $u_h'(x)=a\\,\\varphi'(x)$。代入 $J$ 中得到\n$$\nJ_h(a) \\;=\\; \\int_0^1 \\left( \\frac{\\varepsilon^2}{2}\\,a^2\\,|\\varphi'(x)|^2 \\;-\\; \\frac{\\alpha}{2}\\,a^2\\,\\varphi(x)^2 \\;+\\; \\frac{\\beta}{4}\\,a^4\\,\\varphi(x)^4 \\right)\\,dx.\n$$\n引入积分\n$$\nI_0 = \\int_0^1 \\varphi^2\\,dx,\\qquad I_2 = \\int_0^1 |\\varphi'|^2\\,dx,\\qquad I_4=\\int_0^1 \\varphi^4\\,dx.\n$$\n于是\n$$\nJ_h(a) \\;=\\; \\frac{1}{2}\\left(\\varepsilon^2 I_2 - \\alpha I_0\\right)a^2 \\;+\\; \\frac{\\beta}{4} I_4\\, a^4.\n$$\n对于特定的 $\\varphi(x)=\\sin(\\pi x)$，我们可以显式计算\n$$\nI_0 \\;=\\; \\int_0^1 \\sin^2(\\pi x)\\,dx \\;=\\; \\frac{1}{2},\\qquad\nI_2 \\;=\\; \\int_0^1 \\pi^2\\cos^2(\\pi x)\\,dx \\;=\\; \\frac{\\pi^2}{2},\n$$\n并使用 $\\sin^4(\\theta)=\\tfrac{3}{8}-\\tfrac{1}{2}\\cos(2\\theta)+\\tfrac{1}{8}\\cos(4\\theta)$，\n$$\nI_4 \\;=\\; \\int_0^1 \\sin^4(\\pi x)\\,dx \\;=\\; \\frac{3}{8}.\n$$\n因此，数值上，\n$$\nJ_h(a) \\;=\\; \\frac{1}{2}\\left(\\varepsilon^2 \\frac{\\pi^2}{2} - \\alpha \\frac{1}{2}\\right)a^2 \\;+\\; \\frac{\\beta}{4}\\frac{3}{8}\\, a^4\n\\;=\\; c_2\\,a^2 + c_4\\,a^4,\n$$\n其中 $c_2 = \\frac{1}{4}(\\varepsilon^2\\pi^2 - \\alpha)$ 且 $c_4=\\frac{3\\beta}{32}0$。然而，为了下面的推导，用 $I_0$、$I_2$ 和 $I_4$ 来表示表达式会更方便。\n\n一阶变分。对 $a$ 求导：\n$$\n\\delta J_h(a;\\delta a) \\;=\\; \\left( (\\varepsilon^2 I_2 - \\alpha I_0)\\,a \\;+\\; \\beta I_4\\,a^3 \\right)\\,\\delta a.\n$$\n因此，对于所有 $\\delta a$，驻点条件 $\\delta J_h(a;\\delta a)=0$ 等价于\n$$\n(\\varepsilon^2 I_2 - \\alpha I_0)\\,a \\;+\\; \\beta I_4\\,a^3 \\;=\\; 0.\n$$\n解是\n$$\na=0,\\quad\\text{或}\\quad a^2 \\;=\\; \\frac{\\alpha I_0 - \\varepsilon^2 I_2}{\\beta I_4}.\n$$\n因此，当且仅当\n$$\n\\alpha I_0 \\;\\; \\varepsilon^2 I_2,\n$$\n时，存在非零驻点，在这种情况下，存在两个额外的驻点 $a=\\pm a_\\star$，其中 $a_\\star = \\sqrt{(\\alpha I_0 - \\varepsilon^2 I_2)/(\\beta I_4)}$。\n\n一阶变分能揭示什么以及不能决定什么。一阶变分通过求解 $\\delta J_h(a;\\delta a)=0$ 来刻画驻点。然而，它不能对这些驻点的性质（极小、极大或鞍点）进行分类。为了分类，必须考察二阶变分（在这个标量情况下，即二阶导数）。\n\n二阶变分与分类。计算\n$$\nJ_h''(a) \\;=\\; \\frac{d}{da}\\left( (\\varepsilon^2 I_2 - \\alpha I_0)\\,a \\;+\\; \\beta I_4\\,a^3 \\right) \\;=\\; (\\varepsilon^2 I_2 - \\alpha I_0) \\;+\\; 3\\beta I_4\\,a^2.\n$$\n当 $\\alpha I_0\\varepsilon^2 I_2$ 时，我们有 $J_h''(0)=\\varepsilon^2 I_2 - \\alpha I_0  0$，所以 $a=0$ 不是一个极小值点（在这种一维情况下它是一个局部极大值点）。在 $a=\\pm a_\\star$ 处，其中 $a_\\star^2 = (\\alpha I_0 - \\varepsilon^2 I_2)/(\\beta I_4)$，我们得到\n$$\nJ_h''(\\pm a_\\star) \\;=\\; (\\varepsilon^2 I_2 - \\alpha I_0) \\;+\\; 3\\beta I_4\\,\\frac{\\alpha I_0 - \\varepsilon^2 I_2}{\\beta I_4} \\;=\\; -2(\\varepsilon^2 I_2 - \\alpha I_0) \\;\\; 0,\n$$\n所以 $a=\\pm a_\\star$ 是局部极小值点。此外，由于 $c_40$，当 $|a|\\to\\infty$ 时 $J_h(a)\\to +\\infty$，且唯一的驻点是 $a=0$ 和 $a=\\pm a_\\star$，因此这些局部极小值点实际上是 $\\mathbb{R}$ 上的全局极小值点：\n$$\nJ_h(a) \\;=\\; c_2 a^2 + c_4 a^4,\\quad c_40,\\quad c_20 \\implies J_h(\\pm a_\\star) \\;=\\; -\\frac{c_2^2}{4c_4}  J_h(0) \\;=\\; 0,\n$$\n且当 $|a|\\to\\infty$ 时 $J_h(a) \\to +\\infty$。\n\n逐项分析。\n\nA. 条件 $\\alpha I_0\\varepsilon^2 I_2$ 正是存在三个驻点 $a=0$ 和 $a=\\pm a_\\star\\neq 0$ 的条件。关于仅凭一阶变分无法确定哪些是极小值点的陈述是正确的：求解 $\\delta J_h=0$ 只能定位驻点，而不能对其进行分类。结论：正确。\n\nB. 一阶变分在 $a=0$ 处为零这一事实仅表示 $a=0$ 是一个驻点；它并不意味着是极小值点。实际上，当 $\\alpha I_0\\varepsilon^2 I_2$ 时，我们发现 $J_h''(0)  0$，所以 $a=0$ 不是一个极小值点。结论：不正确。\n\nC. 一阶变分可以导出全空间上的欧拉-拉格朗日方程，但仅凭该方程不足以推断 $J$ 的非凸性。非凸性是泛函的一个性质（例如，二阶变分的符号或被积函数的凸性），而不是由一阶变分决定的。结论：不正确。\n\nD. 这重申了二阶变分检验及其在非凸情形 $\\alpha I_0\\varepsilon^2 I_2$ 下的含义：$J_h''(0)  0$ 排除了 $a=0$ 作为极小值点的可能性，而 $J_h''(\\pm a_\\star)0$ 表明 $a=\\pm a_\\star$ 是局部极小值点。这使用了超出了一阶变分的信息，并且是正确的。结论：正确。\n\nE. 如上所示，当 $\\alpha I_0\\varepsilon^2 I_2$ 且 $c_40$ 时，非零驻点确实是 $J_h$ 在 $\\mathbb{R}$ 上的全局极小值点，但这个结论需要对 $J_h$ 进行分析（通过二阶变分和/或直接求值），而不仅仅是依靠一阶变分。结论：正确。\n\n因此，正确的选项是 A、D 和 E。这个例子说明了非凸性如何导致多个驻点，以及一阶变分可以识别它们，但本身无法判断极小性或全局极小性；这需要通过二阶变分或凸性论证进行进一步分析。在这个离散的例子中，两个非零驻点在非凸情形下是全局离散极小值点。", "answer": "$$\\boxed{ADE}$$", "id": "2559350"}, {"introduction": "Gâteaux 导数的概念在非线性有限元方法的数值实现中扮演着核心角色。在这个实践中，你将看到能量泛函的一阶变分如何直接对应于牛顿法中的“残差向量”，而残差的 Gâteaux 导数（即能量的二阶变分）则构成了“雅可比矩阵” [@problem_id:2559329]。通过一个“人造解”的例子，本练习将带你从第一性原理出发，精确计算单元层次上的残差和雅可比矩阵，这是验证和调试非线性有限元程序正确性的关键一步。", "problem": "考虑由能量泛函\n$$\\Pi(u) \\;=\\; \\int_{0}^{1} \\left( \\tfrac{1}{2}\\,(u'(x))^{2} \\;+\\; \\tfrac{\\alpha}{4}\\,u(x)^{4} \\;-\\; f(x)\\,u(x) \\right)\\,dx,$$\n的欧拉-拉格朗日方程得到的一维非线性边值问题，其中 $\\alpha0$ 是一个给定的常数。在有限元法（FEM, Finite Element Method）中，牛顿法所使用的单元级残差和雅可比矩阵源于 $\\Pi$ 的一阶变分和 Gâteaux 导数。您的任务是根据第一性原理推导这些对象，然后对一个构造解进行求值，以在单元级别测试牛顿求解器。\n\n在单个单元 $e=[0,1]$ 上进行计算，使用由 $\\varphi_{1}(x)=1-x$ 和 $\\varphi_{2}(x)=x$ 定义的线性节点基函数 $\\{\\varphi_{1}(x),\\varphi_{2}(x)\\}$。令 $\\alpha=2$。使用构造解\n$$u_{m}(x)\\;=\\;1+2x,$$\n并定义源项 $f$，使得 $u_{m}$ 在 $[0,1]$ 上满足强形式的欧拉-拉格朗日方程，即 $-u_{m}''(x)+\\alpha\\,u_{m}(x)^{3}=f(x)$。令 $u_{h}$ 为 $u_{m}$ 在单元 $e$ 上的线性有限元插值，即 $u_{h}(x)=u_{1}\\,\\varphi_{1}(x)+u_{2}\\,\\varphi_{2}(x)$，其中 $u_{1}=u_{m}(0)$ 且 $u_{2}=u_{m}(1)$。\n\n任务：\n- 严格从一阶变分的定义 $\\delta\\Pi(u;v)=\\left.\\dfrac{d}{d\\varepsilon}\\Pi(u+\\varepsilon v)\\right|_{\\varepsilon=0}$ 出发，推导单元 $e$ 上的单元级残差算子 $R(u_{h})[v_{h}]$。\n- 严格从残差的 Gâteaux 导数定义 $J(u_{h})[\\delta u_{h},v_{h}]=\\left.\\dfrac{d}{d\\varepsilon}R(u_{h}+\\varepsilon\\,\\delta u_{h})[v_{h}]\\right|_{\\varepsilon=0}$ 出发，推导单元 $e$ 上的单元级雅可比双线性形式。\n- 当 $\\alpha=2$ 且 $u_{m}(x)=1+2x$ 时，构造 $f(x)$，然后精确计算单元残差向量 $\\boldsymbol{r}_{e}=\\big(R(u_{h})[\\varphi_{1}],\\,R(u_{h})[\\varphi_{2}]\\big)$ 和单元雅可比矩阵 $\\boldsymbol{K}_{e}=\\big(J(u_{h})[\\varphi_{j},\\varphi_{i}]\\big)_{i,j=1}^{2}$（无求积误差）。\n- 最后，对于特定的选择 $\\psi_{h}=\\varphi_{1}+2\\,\\varphi_{2}$ 和 $\\delta u_{h}=3\\,\\varphi_{1}-\\varphi_{2}$，计算单个标量\n$$S \\;=\\; R(u_{h})[\\psi_{h}] \\;+\\; J(u_{h})[\\delta u_{h},\\psi_{h}],$$\n将您对 $S$ 的最终答案表示为一个精确的有理数。不要四舍五入。", "solution": "我们从定义开始。能量泛函 $\\Pi$ 在 $u$ 处沿方向 $v$ 的一阶变分为\n$$\\delta\\Pi(u;v)\\;=\\;\\left.\\dfrac{d}{d\\varepsilon}\\,\\Pi(u+\\varepsilon v)\\right|_{\\varepsilon=0}。$$\n对于\n$$\\Pi(u)\\;=\\;\\int_{0}^{1}\\left(\\tfrac{1}{2}(u')^{2}+\\tfrac{\\alpha}{4}u^{4}-f\\,u\\right)\\,dx,$$\n我们计算\n$$\\Pi(u+\\varepsilon v)\\;=\\;\\int_{0}^{1}\\left(\\tfrac{1}{2}(u'+\\varepsilon v')^{2}+\\tfrac{\\alpha}{4}(u+\\varepsilon v)^{4}-f\\,(u+\\varepsilon v)\\right)\\,dx。$$\n对 $\\varepsilon$ 求导并在 $\\varepsilon=0$ 处求值，得到\n$$\\delta\\Pi(u;v)\\;=\\;\\int_{0}^{1}\\left(u'\\,v'\\;+\\;\\alpha\\,u^{3}\\,v\\;-\\;f\\,v\\right)\\,dx。$$\n因此，对于一个有限元函数 $u_{h}$ 和一个支集在单元 $e=[0,1]$ 上的测试函数 $v_{h}$，单元残差算子为\n$$R(u_{h})[v_{h}]\\;=\\;\\int_{0}^{1}\\left(u_{h}'\\,v_{h}'\\;+\\;\\alpha\\,u_{h}^{3}\\,v_{h}\\;-\\;f\\,v_{h}\\right)\\,dx。$$\n\n接下来，残差在 $u_{h}$ 处沿方向 $\\delta u_{h}$ 作用于 $v_{h}$ 的 Gâteaux 导数为\n$$J(u_{h})[\\delta u_{h},v_{h}]\\;=\\;\\left.\\dfrac{d}{d\\varepsilon}\\,R(u_{h}+\\varepsilon\\,\\delta u_{h})[v_{h}]\\right|_{\\varepsilon=0}。$$\n我们将 $u_{h}+\\varepsilon\\,\\delta u_{h}$ 代入 $R$ 中：\n$$R(u_{h}+\\varepsilon\\,\\delta u_{h})[v_{h}]\\;=\\;\\int_{0}^{1}\\left((u_{h}'+\\varepsilon\\,\\delta u_{h}')\\,v_{h}'\\;+\\;\\alpha\\,(u_{h}+\\varepsilon\\,\\delta u_{h})^{3}\\,v_{h}\\;-\\;f\\,v_{h}\\right)\\,dx。$$\n在 $\\varepsilon=0$ 处求导，得到\n$$J(u_{h})[\\delta u_{h},v_{h}]\\;=\\;\\int_{0}^{1}\\left(\\delta u_{h}'\\,v_{h}'\\;+\\;3\\,\\alpha\\,u_{h}^{2}\\,\\delta u_{h}\\,v_{h}\\right)\\,dx。$$\n\n现在，我们具体考虑 $\\alpha=2$ 和构造解 $u_{m}(x)=1+2x$ 的情况。相应的载荷 $f$ 被选择为在 $[0,1]$ 上满足强形式 $-u_{m}''+\\alpha\\,u_{m}^{3}=f$。由于 $u_{m}''(x)=0$，可得\n$$f(x)\\;=\\;\\alpha\\,u_{m}(x)^{3}\\;=\\;2\\,(1+2x)^{3}。$$\n令 $u_{h}$ 为 $u_{m}$ 在 $e=[0,1]$ 上的线性插值，即 $u_{h}(x)=u_{1}\\,\\varphi_{1}(x)+u_{2}\\,\\varphi_{2}(x)$，其中 $u_{1}=u_{m}(0)=1$ 且 $u_{2}=u_{m}(1)=3$。由于 $u_{m}$ 是线性的，因此在 $[0,1]$ 上 $u_{h}=u_{m}$ 逐点成立，所以 $u_{h}'(x)=2$ 且 $u_{h}(x)^{3}=(1+2x)^{3}$。\n\n单元残差向量。使用基函数作为测试函数 $v_{h}=\\varphi_{i}$，$i\\in\\{1,2\\}$，\n$$r_{i}\\;=\\;R(u_{h})[\\varphi_{i}]\\;=\\;\\int_{0}^{1}\\left(u_{h}'\\,\\varphi_{i}'\\;+\\;\\alpha\\,u_{h}^{3}\\,\\varphi_{i}\\;-\\;f\\,\\varphi_{i}\\right)\\,dx。$$\n由于 $f=\\alpha\\,u_{h}^{3}$，这些项相互抵消，剩下\n$$r_{i}\\;=\\;\\int_{0}^{1}u_{h}'\\,\\varphi_{i}'\\,dx\\;=\\;\\int_{0}^{1}2\\,\\varphi_{i}'\\,dx。$$\n由于 $\\varphi_{1}(x)=1-x$ 和 $\\varphi_{2}(x)=x$，我们有 $\\varphi_{1}'(x)=-1$ 和 $\\varphi_{2}'(x)=1$。因此\n$$r_{1}\\;=\\;\\int_{0}^{1}2\\,(-1)\\,dx\\;=\\;-2,\\qquad r_{2}\\;=\\;\\int_{0}^{1}2\\,(1)\\,dx\\;=\\;2。$$\n因此 $\\boldsymbol{r}_{e}=(-2,\\,2)$。\n\n单元雅可比矩阵。其各项为\n$$a_{ij}\\;=\\;J(u_{h})[\\varphi_{j},\\varphi_{i}]\\;=\\;\\int_{0}^{1}\\left(\\varphi_{j}'\\,\\varphi_{i}'\\;+\\;3\\,\\alpha\\,u_{h}^{2}\\,\\varphi_{j}\\,\\varphi_{i}\\right)\\,dx。$$\n当 $\\alpha=2$ 且 $u_{h}(x)=1+2x$ 时，我们有 $3\\,\\alpha=6$ 且 $u_{h}(x)^{2}=(1+2x)^{2}=1+4x+4x^{2}$。定义梯度部分\n$$k^{(0)}_{ij}=\\int_{0}^{1}\\varphi_{j}'\\,\\varphi_{i}'\\,dx,$$\n和非线性类质量部分\n$$m_{ij}=\\int_{0}^{1}6\\,u_{h}^{2}\\,\\varphi_{j}\\,\\varphi_{i}\\,dx。$$\n在线性基下，$[0,1]$ 上的梯度贡献为\n$$k^{(0)}_{11}=\\int_{0}^{1}(-1)(-1)\\,dx=1,\\quad k^{(0)}_{12}=\\int_{0}^{1}(1)(-1)\\,dx=-1,$$\n$$k^{(0)}_{21}=\\int_{0}^{1}(-1)(1)\\,dx=-1,\\quad k^{(0)}_{22}=\\int_{0}^{1}(1)(1)\\,dx=1。$$\n对于非线性部分，写出 $\\varphi_{1}\\varphi_{1}=(1-x)^{2}=1-2x+x^{2}$，$\\varphi_{1}\\varphi_{2}=(1-x)x=x-x^{2}$，以及 $\\varphi_{2}\\varphi_{2}=x^{2}$。当 $u_{h}^{2}=1+4x+4x^{2}$ 时，\n\n$$\n\\begin{aligned}\nI_{11}=\\int_{0}^{1}(1+4x+4x^{2})(1-2x+x^{2})\\,dx=\\int_{0}^{1}\\big(1+2x-3x^{2}-4x^{3}+4x^{4}\\big)\\,dx=\\tfrac{4}{5},\\\\\nI_{12}=\\int_{0}^{1}(1+4x+4x^{2})(x-x^{2})\\,dx=\\int_{0}^{1}\\big(x+3x^{2}-4x^{4}\\big)\\,dx=\\tfrac{7}{10},\\\\\nI_{22}=\\int_{0}^{1}(1+4x+4x^{2})x^{2}\\,dx=\\int_{0}^{1}\\big(x^{2}+4x^{3}+4x^{4}\\big)\\,dx=\\tfrac{32}{15}。\n\\end{aligned}\n$$\n\n乘以 $6$ 得到\n$$m_{11}=6\\,I_{11}=\\tfrac{24}{5},\\quad m_{12}=6\\,I_{12}=\\tfrac{21}{5},\\quad m_{22}=6\\,I_{22}=\\tfrac{64}{5},$$\n且 $m_{21}=m_{12}$。因此，\n\n$$\n\\boldsymbol{K}_{e}=\\big[a_{ij}\\big]=\\big[k^{(0)}_{ij}+m_{ij}\\big]\n=\\begin{pmatrix}\n1+\\tfrac{24}{5}  -1+\\tfrac{21}{5}\\\\\n-1+\\tfrac{21}{5}  1+\\tfrac{64}{5}\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\tfrac{29}{5}  \\tfrac{16}{5}\\\\\n\\tfrac{16}{5}  \\tfrac{69}{5}\n\\end{pmatrix}。\n$$\n\n\n标量 $S$。令 $\\psi_{h}=\\varphi_{1}+2\\,\\varphi_{2}$ 且 $\\delta u_{h}=3\\,\\varphi_{1}-\\varphi_{2}$。以节点向量形式，记作 $\\boldsymbol{w}=(1,\\,2)$ 和 $\\boldsymbol{d}=(3,\\,-1)$。那么\n$$R(u_{h})[\\psi_{h}]=\\boldsymbol{r}_{e}\\cdot\\boldsymbol{w}=(-2,\\,2)\\cdot(1,\\,2)=-2+4=2。$$\n同样地，\n$$J(u_{h})[\\delta u_{h},\\psi_{h}]=\\boldsymbol{d}^{\\top}\\,\\boldsymbol{K}_{e}\\,\\boldsymbol{w}。$$\n计算\n\n$$\n\\boldsymbol{K}_{e}\\,\\boldsymbol{w}\n=\n\\begin{pmatrix}\n\\tfrac{29}{5}  \\tfrac{16}{5}\\\\\n\\tfrac{16}{5}  \\tfrac{69}{5}\n\\end{pmatrix}\n\\begin{pmatrix}1\\\\\n2\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\tfrac{29}{5}+2\\,\\tfrac{16}{5}\\\\\n\\tfrac{16}{5}+2\\,\\tfrac{69}{5}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\tfrac{61}{5}\\\\\n\\tfrac{154}{5}\n\\end{pmatrix},\n$$\n\n因此\n$$\\boldsymbol{d}^{\\top}(\\boldsymbol{K}_{e}\\,\\boldsymbol{w})=3\\,\\tfrac{61}{5}-1\\cdot\\tfrac{154}{5}=\\tfrac{183}{5}-\\tfrac{154}{5}=\\tfrac{29}{5}。$$\n所以，\n$$S=R(u_{h})[\\psi_{h}]+J(u_{h})[\\delta u_{h},\\psi_{h}]=2+\\tfrac{29}{5}=\\tfrac{39}{5}。$$\n\n这个精确的有理数值同时检验了与非线性泛函的一阶变分和 Gâteaux 导数相一致的残差和雅可比矩阵。", "answer": "$$\\boxed{\\tfrac{39}{5}}$$", "id": "2559329"}]}