{"hands_on_practices": [{"introduction": "本练习将引导你完成一个基础过程：将微分方程（强形式）转化为作为有限元法基础的积分方程（弱形式）。通过分析一个简单的一维泊松问题，并同时考虑狄利克雷（Dirichlet）和诺伊曼（Neumann）边界条件，你将练习应用分部积分，并理解不同的边界条件如何在弱形式框架中被自然地处理。这项实践 [@problem_id:2579521] 对于理解有限元法的理论基础，以及函数空间（如 $H^1$ 和 $H^1_0$）所扮演的角色至关重要。", "problem": "考虑在开区间 $\\Omega=(0,1)$ 上源项为常数 $f(x)\\equiv 1$ 的一维泊松模型问题。从边值问题的强形式出发，基于索伯列夫空间 $H^{1}(0,1)$ 和 $H^{1}_{0}(0,1)$ 推导出相应的弱形式：\n- 狄利克雷问题：求 $u:\\Omega\\to\\mathbb{R}$，使得当 $x\\in(0,1)$ 时有 $-u''(x)=1$，且 $u(0)=u(1)=0$。\n- 纯诺伊曼问题：求 $u:\\Omega\\to\\mathbb{R}$，使得当 $x\\in(0,1)$ 时有 $-u''(x)=1$，且 $u'(0)=u'(1)=0$。\n\n利用弱形式，通过引用庞加莱不等式和Lax–Milgram定理（可不加证明地陈述）来证明解的存在性和唯一性（在适当情况下可相差一个加性常数），然后通过求解强形式显式得到：\n1. 狄利克雷问题的唯一解。\n2. 纯诺伊曼问题解集的刻画，包括关于 $f$ 的可解性所需满足的必要相容性条件，以及对于给定的 $f(x)\\equiv 1$ 的可解性结论。\n\n最终答案仅需报告狄利克雷解 $u_{D}(x)$ 的显式闭式表达式。无需四舍五入，不涉及物理单位。", "solution": "所述问题是数学上良定的，是椭圆边值问题分析中的一个标准练习。我们依次分析狄利克雷问题和纯诺伊曼问题来求解。\n\n首先，我们考虑狄利克雷问题：\n求 $u: \\Omega \\to \\mathbb{R}$，使得\n$$\n-u''(x) = 1 \\text{ for } x \\in \\Omega = (0,1)\n$$\n且满足齐次狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$。\n\n为推导弱形式，我们首先定义适当的函数空间。齐次边界条件是本质（或稳定）条件，必须被构建到试探函数和检验函数的空间中。正确的空间是索伯列夫空间 $H^{1}_{0}(\\Omega)$，其定义为 $C^{\\infty}_{c}(\\Omega)$（在 $\\Omega$ 上具有紧支集的无限可微函数）关于 $H^{1}$ 范数的闭包。$H^{1}_{0}(\\Omega)$ 中的函数在迹的意义上于边界处为零。\n\n我们将方程的强形式乘以一个任意的检验函数 $v \\in H^{1}_{0}(\\Omega)$，并在定义域 $\\Omega$ 上积分：\n$$\n\\int_{0}^{1} -u''(x)v(x) \\,dx = \\int_{0}^{1} 1 \\cdot v(x) \\,dx\n$$\n对左侧应用分部积分得到：\n$$\n\\int_{0}^{1} u'(x)v'(x) \\,dx - \\left[ u'(x)v(x) \\right]_{0}^{1} = \\int_{0}^{1} v(x) \\,dx\n$$\n由于检验函数 $v$ 属于 $H^{1}_{0}(\\Omega)$，我们有 $v(0) = v(1) = 0$。因此，边界项 $\\left[ u'(x)v(x) \\right]_{0}^{1}$ 为零。这导出了狄利克雷问题的弱形式：\n求 $u \\in H^{1}_{0}(\\Omega)$，使得\n$$\n\\int_{0}^{1} u'(x)v'(x) \\,dx = \\int_{0}^{1} v(x) \\,dx \\quad \\forall v \\in H^{1}_{0}(\\Omega)\n$$\n这可以写成抽象形式 $a(u,v) = L(v)$，其中双线性形式 $a(\\cdot, \\cdot): H^{1}_{0}(\\Omega) \\times H^{1}_{0}(\\Omega) \\to \\mathbb{R}$ 定义为 $a(u,v) = \\int_{0}^{1} u'(x)v'(x) \\,dx$，线性泛函 $L(\\cdot): H^{1}_{0}(\\Omega) \\to \\mathbb{R}$ 定义为 $L(v) = \\int_{0}^{1} v(x) \\,dx$。\n\n该弱问题的解的存在性和唯一性由Lax-Milgram定理保证。我们必须验证双线性形式 $a(u,v)$ 是有界的和强制的（或 $H^{1}_{0}$-椭圆的），并且线性泛函 $L(v)$ 是有界的。\n$1$. $a(u,v)$ 的有界性：根据柯西-施瓦茨不等式，\n$|a(u,v)| = \\left| \\int_{0}^{1} u'v' \\,dx \\right| \\leq \\|u'\\|_{L^{2}} \\|v'\\|_{L^{2}} \\leq \\|u\\|_{H^{1}} \\|v\\|_{H^{1}}$。因此 $a(u,v)$ 是有界的。\n$2$. $a(u,v)$ 的强制性：我们有 $a(u,u) = \\int_{0}^{1} (u'(x))^{2} \\,dx = \\|u'\\|_{L^{2}}^{2}$。对于 $H^{1}_{0}(\\Omega)$ 中的函数，庞加莱不等式指出，存在一个常数 $C_{P} > 0$ 使得 $\\|u\\|_{L^{2}} \\leq C_{P} \\|u'\\|_{L^{2}}$。完整的 $H^{1}$ 范数为 $\\|u\\|_{H^{1}}^{2} = \\|u\\|_{L^{2}}^{2} + \\|u'\\|_{L^{2}}^{2}$。使用庞加莱不等式，我们得到 $\\|u\\|_{H^{1}}^{2} \\leq (C_{P}^{2} + 1)\\|u'\\|_{L^{2}}^{2} = (C_{P}^{2} + 1)a(u,u)$。因此，$a(u,u) \\geq \\frac{1}{C_{P}^{2}+1} \\|u\\|_{H^{1}}^{2}$。这证明了 $a(u,v)$ 是强制的，强制性常数为 $\\alpha = (C_{P}^{2}+1)^{-1} > 0$。\n$3$. $L(v)$ 的有界性：根据柯西-施瓦茨不等式， $|L(v)| = \\left| \\int_{0}^{1} 1 \\cdot v(x) \\,dx \\right| \\leq \\|1\\|_{L^{2}} \\|v\\|_{L^{2}} = \\sqrt{1} \\cdot \\|v\\|_{L^{2}} \\leq \\|v\\|_{H^{1}}$。因此 $L(v)$ 是有界的。\n由于所有条件都已满足，Lax-Milgram定理保证了唯一解 $u \\in H^{1}_{0}(\\Omega)$ 的存在性。\n\n为了显式地找到这个解，我们通过直接积分来求解强形式：\n$-u''(x) = 1$\n对 $x$ 积分一次得到：\n$-u'(x) = x + C_{1}$\n积分第二次得到：\n$-u(x) = \\frac{1}{2}x^{2} + C_{1}x + C_{2}$\n所以，通解为 $u(x) = -\\frac{1}{2}x^{2} - C_{1}x - C_{2}$。\n我们应用边界条件来确定常数 $C_1$ 和 $C_2$：\n$u(0) = 0 \\implies -\\frac{1}{2}(0)^{2} - C_{1}(0) - C_{2} = 0 \\implies C_{2} = 0$。\n$u(1) = 0 \\implies -\\frac{1}{2}(1)^{2} - C_{1}(1) - 0 = 0 \\implies -\\frac{1}{2} - C_{1} = 0 \\implies C_{1} = -\\frac{1}{2}$。\n将常数代回，狄利克雷问题的唯一解是：\n$u_{D}(x) = -\\frac{1}{2}x^{2} - \\left(-\\frac{1}{2}\\right)x = \\frac{1}{2}x - \\frac{1}{2}x^{2} = \\frac{1}{2}x(1-x)$。\n\n接下来，我们考虑纯诺伊曼问题：\n求 $u: \\Omega \\to \\mathbb{R}$，使得\n$$\n-u''(x) = 1 \\text{ for } x \\in \\Omega = (0,1)\n$$\n且满足齐次诺伊曼边界条件 $u'(0) = 0$ 和 $u'(1) = 0$。\n\n诺伊曼条件是自然边界条件，所以它们不被强加在函数空间上。试探函数和检验函数的适当空间都是 $H^{1}(\\Omega)$。我们乘以一个检验函数 $v \\in H^{1}(\\Omega)$ 并积分：\n$\\int_{0}^{1} -u''(x)v(x) \\,dx = \\int_{0}^{1} 1 \\cdot v(x) \\,dx$。\n分部积分得到：\n$\\int_{0}^{1} u'(x)v'(x) \\,dx - \\left[ u'(x)v(x) \\right]_{0}^{1} = \\int_{0}^{1} v(x) \\,dx$。\n边界项是 $- (u'(1)v(1) - u'(0)v(0))$。利用给定的诺伊曼条件 $u'(0)=0$ 和 $u'(1)=0$，此项为零。因此，弱形式为：\n求 $u \\in H^{1}(\\Omega)$，使得\n$$\n\\int_{0}^{1} u'(x)v'(x) \\,dx = \\int_{0}^{1} v(x) \\,dx \\quad \\forall v \\in H^{1}(\\Omega)\n$$\n这又是 $a(u,v) = L(v)$ 的形式，其中 $a(u,v) = \\int_{0}^{1} u'v' \\,dx$ 且 $L(v) = \\int_{0}^{1} v \\,dx$，但现在是在空间 $H^{1}(\\Omega)$ 上。\n\n对于此问题，双线性形式 $a(u,v)$ 在 $H^{1}(\\Omega)$ 上不是强制的。考虑任意非零常数函数 $u(x) = c \\neq 0$。对于这样的函数，$\\|u\\|_{H^{1}}^{2} = \\int_{0}^{1} c^{2} \\,dx + \\int_{0}^{1} 0^{2} \\,dx = c^{2} > 0$。然而，$a(u,u) = \\int_{0}^{1} (u'(x))^{2} \\,dx = \\int_{0}^{1} 0^{2} \\,dx = 0$。因此，不存在常数 $\\alpha > 0$ 使得对于所有 $u \\in H^{1}(\\Omega)$ 都有 $a(u,u) \\ge \\alpha \\|u\\|_{H^{1}}^{2}$。该双线性形式的核由所有常数函数组成。Lax-Milgram定理不直接适用。\n\n解存在的必要条件是，对于 $a(\\cdot, \\cdot)$ 的核中的所有函数 $v$，右侧的泛函 $L(v)$ 必须为零。我们通过选择检验函数 $v(x)=1$（它是核的一个基）来检验这个条件。\n$L(1) = \\int_{0}^{1} f(x) \\cdot 1 \\,dx = \\int_{0}^{1} 1 \\,dx = 1$。\n因为 $L(1) = 1 \\neq 0$，所以相容性条件不满足。因此，源项为 $f(x)=1$ 的纯诺伊曼问题没有解。\n\n这可以通过在定义域上对方程的强形式进行积分来确认：\n$\\int_{0}^{1} -u''(x) \\,dx = \\int_{0}^{1} f(x) \\,dx$\n对左侧应用微积分基本定理：\n$-[u'(x)]_{0}^{1} = \\int_{0}^{1} f(x) \\,dx$\n$-(u'(1) - u'(0)) = \\int_{0}^{1} f(x) \\,dx$\n代入诺伊曼边界条件 $u'(0) = 0$ 和 $u'(1) = 0$ 得到相容性（或可解性）条件：\n$0 = \\int_{0}^{1} f(x) \\,dx$。\n对于给定的源项 $f(x)=1$，我们有 $\\int_{0}^{1} 1 \\,dx = 1 \\neq 0$。该条件被违反，证实不存在经典解。\n\n如果源项 $f$ 确实满足 $\\int_{0}^{1} f(x) \\,dx = 0$，则解存在，但不是唯一的。如果 $u(x)$ 是一个解，那么对于任何常数 $C \\in \\mathbb{R}$，$u(x)+C$ 也是一个解，因为 $(u+C)'' = u''$ 并且 $(u+C)'=u'$。解集将是一个相差一个加性常数的函数等价类。可以通过施加一个额外约束，例如 $\\int_{0}^{1} u(x) \\,dx = 0$，来获得唯一解。", "answer": "$$\n\\boxed{\\frac{1}{2}x(1-x)}\n$$", "id": "2579521"}, {"introduction": "在建立弱形式之后，有限元法的下一步是离散化。本练习聚焦于此过程中的“原子”构件：单元刚度矩阵。你将从第一性原理出发，为一个标准的二维参考三角形推导出该矩阵，它构成了分析更复杂几何形状的基础。这项动手计算 [@problem_id:2579542] 不仅将揭开组装过程的神秘面纱，还将揭示局部矩阵的基本性质，例如其奇异性及其零空间的物理意义。", "problem": "考虑有限元方法(FEM)中使用的单个参考单元上的泊松模型问题 $-\\Delta u = f$。令 $\\widehat{T}$ 表示 $\\mathbb{R}^{2}$ 中的参考直角三角形，其顶点为 $(0,0)$、$(1,0)$ 和 $(0,1)$。令 $\\{\\widehat{N}_{1},\\widehat{N}_{2},\\widehat{N}_{3}\\}$ 为与这些顶点相关的标准线性拉格朗日形函数。具有单位扩散系数的拉普拉斯算子的单元刚度矩阵 $K^{e} \\in \\mathbb{R}^{3 \\times 3}$ 由双线性形式定义\n$$\nK^{e}_{ij} \\;=\\; \\int_{\\widehat{T}} \\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j} \\, d\\widehat{x}, \\quad i,j \\in \\{1,2,3\\}.\n$$\n从泊松方程的弱形式和 $\\widehat{T}$ 上的线性形函数的定义出发，根据第一性原理显式推导 $K^{e}$（不要假设任何预先计算的单元矩阵），并用您的推导来验证对称性并严格描述其定性。特别地，确定 $K^{e}$ 是严格正定的还是仅为半正定的，并如果存在零空间，请确定它。\n\n您最终报告的量必须是 $\\det(K^{e})$ 的精确值，作为一个实数。不需要四舍五入，也没有单位。请提供完整的推导和论证，然后仅报告 $\\det(K^{e})$ 作为最终答案。", "solution": "该问题要求推导和分析标准二维线性三角形参考单元 $\\widehat{T}$ 上拉普拉斯算子的单元刚度矩阵 $K^{e}$。$\\widehat{T}$ 的顶点给定为 $\\widehat{\\mathbf{x}}_1 = (0,0)$、$\\widehat{\\mathbf{x}}_2 = (1,0)$ 和 $\\widehat{\\mathbf{x}}_3 = (0,1)$。\n\n首先，我们必须确定与这些顶点相关的线性拉格朗日形函数 $\\{\\widehat{N}_{1}, \\widehat{N}_{2}, \\widehat{N}_{3}\\}$。$\\mathbb{R}^{2}$ 上的线性函数具有一般形式 $\\widehat{N}(\\widehat{x}, \\widehat{y}) = a\\widehat{x} + b\\widehat{y} + c$。形函数 $\\widehat{N}_{i}$ 由属性 $\\widehat{N}_{i}(\\widehat{\\mathbf{x}}_{j}) = \\delta_{ij}$ 定义，其中 $\\delta_{ij}$ 是克罗内克(Kronecker)δ函数。\n\n对于 $\\widehat{N}_{1}(\\widehat{x}, \\widehat{y}) = a_1\\widehat{x} + b_1\\widehat{y} + c_1$：\n条件是 $\\widehat{N}_{1}(0,0)=1$、$\\widehat{N}_{1}(1,0)=0$、$\\widehat{N}_{1}(0,1)=0$。\n从 $\\widehat{N}_{1}(0,0)=1$ 可得 $c_1=1$。\n从 $\\widehat{N}_{1}(1,0)=0$ 可得 $a_1 + c_1 = 0 \\implies a_1 = -1$。\n从 $\\widehat{N}_{1}(0,1)=0$ 可得 $b_1 + c_1 = 0 \\implies b_1 = -1$。\n因此，$\\widehat{N}_{1}(\\widehat{x}, \\widehat{y}) = 1 - \\widehat{x} - \\widehat{y}$。\n\n对于 $\\widehat{N}_{2}(\\widehat{x}, \\widehat{y}) = a_2\\widehat{x} + b_2\\widehat{y} + c_2$：\n条件是 $\\widehat{N}_{2}(0,0)=0$、$\\widehat{N}_{2}(1,0)=1$、$\\widehat{N}_{2}(0,1)=0$。\n从 $\\widehat{N}_{2}(0,0)=0$ 可得 $c_2=0$。\n从 $\\widehat{N}_{2}(1,0)=1$ 可得 $a_2 = 1$。\n从 $\\widehat{N}_{2}(0,1)=0$ 可得 $b_2 = 0$。\n因此，$\\widehat{N}_{2}(\\widehat{x}, \\widehat{y}) = \\widehat{x}$。\n\n对于 $\\widehat{N}_{3}(\\widehat{x}, \\widehat{y}) = a_3\\widehat{x} + b_3\\widehat{y} + c_3$：\n条件是 $\\widehat{N}_{3}(0,0)=0$、$\\widehat{N}_{3}(1,0)=0$、$\\widehat{N}_{3}(0,1)=1$。\n从 $\\widehat{N}_{3}(0,0)=0$ 可得 $c_3=0$。\n从 $\\widehat{N}_{3}(1,0)=0$ 可得 $a_3 = 0$。\n从 $\\widehat{N}_{3}(0,1)=1$ 可得 $b_3 = 1$。\n因此，$\\widehat{N}_{3}(\\widehat{x}, \\widehat{y}) = \\widehat{y}$。\n\n接下来，我们计算这些形函数的梯度。由于这些函数是线性的，它们的梯度是常数向量。\n$$\n\\nabla \\widehat{N}_{1} = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}, \\quad\n\\nabla \\widehat{N}_{2} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad\n\\nabla \\widehat{N}_{3} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}.\n$$\n\n单元刚度矩阵 $K^{e}$ 的元素由 $K^{e}_{ij} = \\int_{\\widehat{T}} \\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j} \\, d\\widehat{x}$ 定义。由于梯度是常数，点积 $\\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j}$ 也是常数。因此，积分就是这个常数值与区域 $\\widehat{T}$ 面积的乘积。\n$$\nK^{e}_{ij} = (\\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j}) \\int_{\\widehat{T}} 1 \\, d\\widehat{x} = (\\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j}) \\cdot \\text{Area}(\\widehat{T}).\n$$\n顶点为 $(0,0)$、$(1,0)$ 和 $(0,1)$ 的直角三角形的面积是 $\\text{Area}(\\widehat{T}) = \\frac{1}{2} \\times \\text{底} \\times \\text{高} = \\frac{1}{2} \\times 1 \\times 1 = \\frac{1}{2}$。\n\n现在我们计算梯度的点积：\n$\\nabla \\widehat{N}_{1} \\cdot \\nabla \\widehat{N}_{1} = (-1)^2 + (-1)^2 = 2$.\n$\\nabla \\widehat{N}_{1} \\cdot \\nabla \\widehat{N}_{2} = (-1)(1) + (-1)(0) = -1$.\n$\\nabla \\widehat{N}_{1} \\cdot \\nabla \\widehat{N}_{3} = (-1)(0) + (-1)(1) = -1$.\n$\\nabla \\widehat{N}_{2} \\cdot \\nabla \\widehat{N}_{2} = (1)^2 + (0)^2 = 1$.\n$\\nabla \\widehat{N}_{2} \\cdot \\nabla \\widehat{N}_{3} = (1)(0) + (0)(1) = 0$.\n$\\nabla \\widehat{N}_{3} \\cdot \\nabla \\widehat{N}_{3} = (0)^2 + (1)^2 = 1$.\n\n使用这些值和 $\\text{Area}(\\widehat{T}) = \\frac{1}{2}$，我们组装矩阵 $K^{e}$：\n$K^{e}_{11} = 2 \\times \\frac{1}{2} = 1$.\n$K^{e}_{12} = -1 \\times \\frac{1}{2} = -\\frac{1}{2}$.\n$K^{e}_{13} = -1 \\times \\frac{1}{2} = -\\frac{1}{2}$.\n$K^{e}_{22} = 1 \\times \\frac{1}{2} = \\frac{1}{2}$.\n$K^{e}_{23} = 0 \\times \\frac{1}{2} = 0$.\n$K^{e}_{33} = 1 \\times \\frac{1}{2} = \\frac{1}{2}$.\n\n根据点积的交换律，$\\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j} = \\nabla \\widehat{N}_{j} \\cdot \\nabla \\widehat{N}_{i}$，这意味着 $K^{e}_{ij} = K^{e}_{ji}$。该矩阵是对称的。完整的矩阵是：\n$$\nK^{e} = \\begin{pmatrix}\n1  -\\frac{1}{2}  -\\frac{1}{2} \\\\\n-\\frac{1}{2}  \\frac{1}{2}  0 \\\\\n-\\frac{1}{2}  0  \\frac{1}{2}\n\\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix}\n2  -1  -1 \\\\\n-1  1  0 \\\\\n-1  0  1\n\\end{pmatrix}.\n$$\n\n现在，我们分析 $K^{e}$ 的定性。考虑一个任意向量 $\\mathbf{v} = (v_1, v_2, v_3)^T \\in \\mathbb{R}^3$ 以及相关的二次型 $\\mathbf{v}^T K^e \\mathbf{v}$。令 $\\widehat{u}_h(\\widehat{\\mathbf{x}}) = \\sum_{j=1}^{3} v_j \\widehat{N}_j(\\widehat{\\mathbf{x}})$ 为有限元空间中的一个函数。二次型为：\n$$\n\\mathbf{v}^T K^e \\mathbf{v} = \\sum_{i=1}^{3} \\sum_{j=1}^{3} v_i K^{e}_{ij} v_j = \\sum_{i,j} v_i v_j \\int_{\\widehat{T}} \\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j} \\, d\\widehat{x}\n$$\n根据积分和微分的线性性质，这变为：\n$$\n\\mathbf{v}^T K^e \\mathbf{v} = \\int_{\\widehat{T}} \\left( \\sum_{i=1}^{3} v_i \\nabla \\widehat{N}_{i} \\right) \\cdot \\left( \\sum_{j=1}^{3} v_j \\nabla \\widehat{N}_{j} \\right) \\, d\\widehat{x} = \\int_{\\widehat{T}} |\\nabla \\widehat{u}_h|^2 \\, d\\widehat{x}.\n$$\n由于被积函数 $|\\nabla \\widehat{u}_h|^2$ 是非负的，所以该积分也是非负的。因此，对于所有 $\\mathbf{v} \\in \\mathbb{R}^3$，都有 $\\mathbf{v}^T K^e \\mathbf{v} \\geq 0$，这证明了 $K^{e}$ 是半正定的。\n\n要使 $K^{e}$ 为正定矩阵，$\\mathbf{v}^T K^e \\mathbf{v} = 0$ 必须意味着 $\\mathbf{v} = \\mathbf{0}$。条件 $\\mathbf{v}^T K^e \\mathbf{v} = 0$ 等价于 $\\int_{\\widehat{T}} |\\nabla \\widehat{u}_h|^2 \\, d\\widehat{x} = 0$。由于被积函数是连续且非负的，这意味着对于所有 $\\widehat{\\mathbf{x}} \\in \\widehat{T}$ 都有 $\\nabla \\widehat{u}_h(\\widehat{\\mathbf{x}}) = \\mathbf{0}$。\n$$\n\\nabla \\widehat{u}_h = \\nabla \\left( \\sum_{j=1}^{3} v_j \\widehat{N}_j \\right) = \\sum_{j=1}^{3} v_j \\nabla \\widehat{N}_j = v_1 \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} + v_2 \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + v_3 \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -v_1 + v_2 \\\\ -v_1 + v_3 \\end{pmatrix}.\n$$\n将梯度设为零，得到方程组：\n$$\n-v_1 + v_2 = 0 \\implies v_1 = v_2\n$$\n$$\n-v_1 + v_3 = 0 \\implies v_1 = v_3\n$$\n因此，$\\nabla \\widehat{u}_h = \\mathbf{0}$ 当且仅当 $v_1 = v_2 = v_3$。对于标量 $c \\in \\mathbb{R}$，任何形如 $\\mathbf{v} = c(1, 1, 1)^T$ 的向量都会导致 $\\mathbf{v}^T K^e \\mathbf{v} = 0$。如果 $c \\neq 0$，那么 $\\mathbf{v} \\neq \\mathbf{0}$。这证明了 $K^{e}$ 不是正定的；它只是半正定的。\n这类向量的集合构成了 $K^e$ 的零空间（核）：\n$$\n\\text{ker}(K^e) = \\{ \\mathbf{v} \\in \\mathbb{R}^3 : K^e \\mathbf{v} = \\mathbf{0} \\} = \\text{span} \\left\\{ \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right\\}.\n$$\n其物理意义是常数函数 $\\widehat{u}_h = c \\sum \\widehat{N}_j = c(1) = c$ 的梯度为零，因此“应变能”$\\int |\\nabla u|^2$ 为零。\n\n最后，我们必须计算 $K^{e}$ 的行列式。线性代数的一个基本定理指出，一个方阵是奇异的（即不可逆的）当且仅当其零空间是非平凡的。正如我们所证，$\\text{dim}(\\text{ker}(K^e)) = 1$，因此矩阵 $K^{e}$ 是奇异的。任何奇异矩阵的行列式都为零。因此，$\\det(K^{e}) = 0$。\n\n为了完整性，我们通过直接计算来验证这一点：\n$$\n\\det(K^{e}) = \\det \\begin{pmatrix}\n1  -\\frac{1}{2}  -\\frac{1}{2} \\\\\n-\\frac{1}{2}  \\frac{1}{2}  0 \\\\\n-\\frac{1}{2}  0  \\frac{1}{2}\n\\end{pmatrix}\n$$\n$$\n= 1 \\left( (\\frac{1}{2})(\\frac{1}{2}) - (0)(0) \\right) - (-\\frac{1}{2}) \\left( (-\\frac{1}{2})(\\frac{1}{2}) - (0)(-\\frac{1}{2}) \\right) + (-\\frac{1}{2}) \\left( (-\\frac{1}{2})(0) - (\\frac{1}{2})(-\\frac{1}{2}) \\right)\n$$\n$$\n= 1 \\left( \\frac{1}{4} \\right) + \\frac{1}{2} \\left( -\\frac{1}{4} \\right) - \\frac{1}{2} \\left( \\frac{1}{4} \\right)\n$$\n$$\n= \\frac{1}{4} - \\frac{1}{8} - \\frac{1}{8} = \\frac{1}{4} - \\frac{2}{8} = \\frac{1}{4} - \\frac{1}{4} = 0.\n$$\n计算结果证实了理论结果。最终答案是 $0$。", "answer": "$$\n\\boxed{0}\n$$", "id": "2579542"}, {"introduction": "有限元解的质量不仅取决于网格的疏密，更关键地取决于其几何质量。本练习通过引导你构建一个“坏”网格，具体展示了这一原理，该网格将导致数值解违反离散极值原理。通过分析三角形内角与刚度矩阵非对角线元素符号之间的关系，这项实践 [@problem_id:2579531] 为我们提供了深刻的见解，解释了为什么网格生成算法通常会避免钝角（例如，通过创建德劳内三角剖分）。", "problem": "考虑泊松方程的模型问题：求 $u:\\Omega \\to \\mathbb{R}$ 使得在 $\\Omega$ 内有 $-\\Delta u = f$，并在 $\\partial \\Omega$ 上有 $u = 0$，其中 $\\Omega \\subset \\mathbb{R}^2$ 是一个多边形区域。设 $V_h$ 是定义在 $\\Omega$ 的一个形状正则的三角剖分 $\\mathcal{T}_h$ 上的连续分片线性函数（$P_1$ 有限元）的协调空间。伽辽金方法旨在寻求 $u_h \\in V_h$，使得对于所有在 $\\partial \\Omega$ 上为零的 $v_h \\in V_h$，都有 $\\int_{\\Omega} \\nabla u_h \\cdot \\nabla v_h \\, dx = \\int_{\\Omega} f v_h \\, dx$。对于数据 $f \\le 0$（几乎处处逐点成立），连续最大值原理意味着在 $\\Omega$ 中 $u \\le 0$。离散最大值原理的一个常用充分代数条件是，组装后的刚度矩阵具有非正的非对角元并且是一个 M-矩阵。\n\n你的任务是确定一个具体的网格构造，该构造包含一个钝角三角形，并且对于齐次狄利克雷边界条件，实际上违反了 $P_1$ 有限元的离散最大值原理。选择一个选项，该选项既：\n- 足够详细地指定一个三角剖分，以识别出一条其组装后的非对角刚度元为正的内部边，并且\n- 根据组装后的非对角刚度元的符号正确解释其代数原因。\n\n只选择一个选项。\n\nA. 设 $\\Omega = (0,1)^2$。引入内部节点 $i=(0.25,0.25)$ 和 $j=(0.75,0.25)$，以及两个额外的顶点 $k=(0.5,0.26)$（恰好在线段 $\\overline{ij}$ 上方）和 $\\ell=(0.5,0.80)$（远高于 $\\overline{ij}$）。在三角剖分中包含两个三角形 $T_1 = \\triangle(i,j,k)$ 和 $T_2 = \\triangle(i,j,\\ell)$，并使用这些顶点，在 $\\Omega$ 上用任何形状正则的三角剖分完成网格剖分，同时在 $\\partial \\Omega$ 上施加 $u_h=0$。在顶点 k 处与内部边 $(i,j)$ 相对的角是钝角，$\\alpha_k \\approx \\pi - 2\\arctan\\left(\\frac{0.01}{0.25}\\right)$，因此 $\\cot \\alpha_k  0$ 且绝对值很大；而在顶点 $\\ell$ 处与 $(i,j)$ 相对的角是锐角，$\\cot \\alpha_\\ell  0$ 但大小适中。因此，内部边 $(i,j)$ 的组装后非对角元满足 $K_{ij} = -\\tfrac{1}{2}\\big(\\cot \\alpha_k + \\cot \\alpha_\\ell\\big)  0$。这破坏了非对角元的非正性，因此刚度矩阵不是一个 M-矩阵，对于某些 $f \\le 0$，离散最大值原理可能被违反。\n\nB. 设 $\\Omega$ 是以 $(0,0)$、$(1,0)$、$(0,1)$ 为顶点的直角三角形。插入一个内部节点 $p=(0.5,0.10)$ 并将其与所有三个顶点连接，形成三个三角形，其中一个在 p 点处有一个钝角，该角与边界边 $[(0,0),(1,0)]$ 相对。由于这在边界节点 $(0,0)$ 和 $(1,0)$ 之间产生了一个正的非对角元，离散最大值原理被违反。\n\nC. 设 $\\Omega = (0,1)^2$。引入内部节点 $i=(0.25,0.25)$ 和 $j=(0.75,0.25)$，并将 $k=(0.5,0.60)$ 和 $\\ell=(0.5,0.80)$ 置于线段 $\\overline{ij}$ 上方。在网格剖分中包含 $T_1=\\triangle(i,j,k)$ 和 $T_2=\\triangle(i,j,\\ell)$，并在 $\\Omega$ 上完成网格剖分，同时在 $\\partial \\Omega$ 上施加 $u_h=0$。尽管在 $T_1$ 和 $T_2$ 中与 $(i,j)$ 相对的两个角都是锐角，但内部边周围存在两个相邻三角形就足以因网格各向异性而导致违反离散最大值原理。\n\nD. 设 $\\Omega = (0,1)^2$。引入内部节点 $i=(0.25,0.25)$ 和 $j=(0.75,0.25)$，取 $k=(0.5,0.40)$ 略高于 $\\overline{ij}$，并使用边界顶点 $\\ell=(0.5,1)$，进行三角剖分以包含 $T_1=\\triangle(i,j,k)$ 和 $T_2=\\triangle(i,j,\\ell)$。在 k 点处与 $(i,j)$ 相对的角是钝角，因此离散最大值原理必然不成立，因为钝角总是导致组装后的非对角元 $K_{ij}$ 为正。", "solution": "该问题陈述在二阶椭圆偏微分方程的有限元方法既有理论框架内，提出了一个有效的问题。其前提在科学上是合理的，术语是标准的，并且任务是一个良定的构造性问题。因此，我们将继续进行分析。\n\n这个问题的核心在于，对于用连续分片线性（$P_1$）基函数离散化的负拉普拉斯算子，其刚度矩阵 $K$ 的非对角元的计算公式。设 $i$ 和 $j$ 是三角剖分 $\\mathcal{T}_h$ 中两个不同节点的索引。刚度矩阵对应的非对角元是 $K_{ij} = a(\\phi_j, \\phi_i) = \\int_{\\Omega} \\nabla \\phi_i \\cdot \\nabla \\phi_j \\, dx$，其中 $\\phi_i$ 和 $\\phi_j$ 是与节点 $i$ 和 $j$ 相关联的拉格朗日基函数。\n\n只有当节点 $i$ 和 $j$ 属于同一个三角形时，这个积分才非零。如果连接节点 $i$ 和 $j$ 的边（记作 $e_{ij}$）是网格的一条内部边，它通常由两个三角形共享，比如 $T_1$ 和 $T_2$。设这两个三角形的顶点分别为 $(i, j, k)$ 和 $(i, j, \\ell)$。在 $T_1$ 和 $T_2$ 中与共享边 $e_{ij}$ 相对的角分别记为 $\\alpha_k$ 和 $\\alpha_\\ell$。有限元分析中的一个标准结果表明，单个三角形 $T_1$ 对刚度元的贡献是 $\\int_{T_1} \\nabla \\phi_i \\cdot \\nabla \\phi_j \\, dx = -\\frac{1}{2} \\cot \\alpha_k$。\n\n因此，内部边 $e_{ij}$ 的组装后非对角元是来自两个三角形贡献的总和：\n$$ K_{ij} = -\\frac{1}{2} (\\cot \\alpha_k + \\cot \\alpha_\\ell) $$\n离散最大值原理（DMP）成立的一个充分条件是刚度矩阵（对内部节点而言）是一个 M-矩阵。M-矩阵的一个必要性质是其所有非对角元都是非正的。因此，我们要求对于所有 $i \\neq j$ 都有 $K_{ij} \\le 0$。根据上面的公式，这等价于条件：\n$$ \\cot \\alpha_k + \\cot \\alpha_\\ell \\ge 0 $$\n这是一个局部的、基于几何的条件，通常称为德劳内(Delaunay)条件。如果 $0  \\alpha  \\pi/2$，则角 $\\alpha$ 是锐角，其 $\\cot \\alpha  0$。如果 $\\pi/2  \\alpha  \\pi$，则角是钝角，其 $\\cot \\alpha  0$。如果 $\\alpha_k$ 和 $\\alpha_\\ell$ 都是锐角，该条件显然满足，且 $K_{ij}  0$。要发生违反情况，即 $K_{ij}  0$，只能是其中一个角为钝角，比如 $\\alpha_k  \\pi/2$，并且其负的余切值绝对值足够大，以至于超过另一个角的正的余切值：$|\\cot \\alpha_k|  \\cot \\alpha_\\ell$。\n\n我们现在根据这一原则来评估每个选项。\n\n**选项 A：**\n该选项提出了一个特定的网格几何形状。设节点为 $i=(0.25, 0.25)$、$j=(0.75, 0.25)$、$k=(0.5, 0.26)$ 和 $\\ell=(0.5, 0.80)$。公共边是 $\\overline{ij}$，其长度为 $d_{ij}=0.5$。\n对于三角形 $T_1 = \\triangle(i,j,k)$，顶点 $k$ 位于 $\\overline{ij}$ 中点上方 $h_k = 0.26 - 0.25 = 0.01$ 的高度处。这是一个等腰三角形。顶点 $k$ 处的角 $\\alpha_k$ 是钝角。我们可以计算它的余切值。底角 $\\theta$ 由 $\\tan \\theta = h_k / (d_{ij}/2) = 0.01 / 0.25 = 1/25$ 给出。角 $\\alpha_k = \\pi - 2\\theta$。因此，$\\cot \\alpha_k = \\cot(\\pi-2\\theta) = -\\cot(2\\theta) = -\\frac{1-\\tan^2\\theta}{2\\tan\\theta} = -\\frac{1-(1/25)^2}{2(1/25)} = -\\frac{1 - 1/625}{2/25} = -\\frac{624/625}{2/25} = -\\frac{624}{625} \\cdot \\frac{25}{2} = -\\frac{312}{25} = -12.48$。这是一个绝对值很大的负数。\n对于三角形 $T_2 = \\triangle(i,j,\\ell)$，顶点 $\\ell$ 位于 $\\overline{ij}$ 中点上方 $h_\\ell = 0.80 - 0.25 = 0.55$ 的高度处。角 $\\alpha_\\ell$ 是锐角。顶点 $\\ell$ 处的半角，我们称之为 $\\gamma$，满足 $\\tan \\gamma = (d_{ij}/2)/h_\\ell = 0.25/0.55 = 25/55 = 5/11$。那么 $\\cot \\alpha_\\ell = \\frac{1-\\tan^2\\gamma}{2\\tan\\gamma} = \\frac{1-(5/11)^2}{2(5/11)} = \\frac{1-25/121}{10/11} = \\frac{96/121}{10/11} = \\frac{96}{110} = \\frac{48}{55} \\approx 0.8727$。\n余切值之和为 $\\cot \\alpha_k + \\cot \\alpha_\\ell = -12.48 + \\frac{48}{55} \\approx -12.48 + 0.8727 = -11.6073  0$。\n因此，组装后的非对角元为 $K_{ij} = -\\frac{1}{2}(\\cot \\alpha_k + \\cot \\alpha_\\ell)  0$。这违反了非正性条件。该选项中提供的推理与此推导完全一致。\n结论：**正确**。\n\n**选项 B：**\n这个选项描述了一个三角剖分，其中一个钝角形成在一条*边界*边的对侧。边界上的节点服从狄利克雷条件（$u_h = 0$）。在线性系统 $Ku=F$ 的组装中，与边界节点对应的方程是不需要求解的；它们会从系统中被消去。保证 DMP 的矩阵性质（如作为 M-矩阵）是针对仅与*内部*自由度对应的缩减刚度矩阵而言的。两个边界节点之间的非对角元，如 $K_{(0,0),(1,0)}$，不会出现在这个缩减系统中，对内部解是否遵守 DMP 没有影响。因此，其推理在根本上是错误的。\n结论：**不正确**。\n\n**选项 C：**\n这个选项提出了一个配置，节点为 $i=(0.25,0.25)$、$j=(0.75,0.25)$、$k=(0.5,0.60)$ 和 $\\ell=(0.5,0.80)$。两个三角形 $T_1 = \\triangle(i,j,k)$ 和 $T_2 = \\triangle(i,j,\\ell)$ 都是以公共底 $\\overline{ij}$ 的等腰三角形。\n对于 $T_1$，高度为 $h_k = 0.60 - 0.25 = 0.35$。$k$ 处的半角为 $\\gamma_k$，其中 $\\tan \\gamma_k = (0.5/2)/0.35 = 0.25/0.35 = 5/7  1$。因此 $\\gamma_k  \\pi/4$，这意味着整个角 $\\alpha_k  \\pi/2$。它是锐角，且 $\\cot \\alpha_k  0$。\n对于 $T_2$，高度为 $h_\\ell = 0.80 - 0.25 = 0.55$。$\\ell$ 处的半角为 $\\gamma_\\ell$，其中 $\\tan \\gamma_\\ell = 0.25/0.55 = 5/11  1$。因此整个角 $\\alpha_\\ell  \\pi/2$。它也是锐角，且 $\\cot \\alpha_\\ell  0$。\n组装后的非对角元是 $K_{ij} = -\\frac{1}{2}(\\cot \\alpha_k + \\cot \\alpha_\\ell)$。由于两个余切值都是正的，它们的和也是正的，因此 $K_{ij}$ 必须是负的。非正性条件得到满足。声称这种配置会强制违反 DMP 是错误的；相反，对于这条特定的边，条件是满足的。术语“网格各向异性”的使用含糊不清，不能为这个不正确的结论提供理由。\n结论：**不正确**。\n\n**选项 D：**\n这个选项提出了一个带有钝角三角形的几何形状，并声称钝角“总是导致组装后的非对角元 $K_{ij}$ 为正”。这个说法是一个逻辑谬误。$K_{ij}$ 的符号取决于 $-(\\cot \\alpha_k + \\cot \\alpha_\\ell)$ 的符号。为了使 $K_{ij}$ 为正，我们需要 $\\cot \\alpha_k + \\cot \\alpha_\\ell  0$。如果一个角 $\\alpha_k$ 是钝角，则 $\\cot \\alpha_k$ 是负的。这是一个必要条件，但不是充分条件。如果另一个角 $\\alpha_\\ell$ 是锐角并且足够“尖锐”（接近于 $0$），它的余切值将是大的正数，可能使和为非负。\n让我们检查一下提供的具体几何形状：$i=(0.25,0.25)$、$j=(0.75,0.25)$、$k=(0.5,0.40)$、$\\ell=(0.5,1)$。\n对于 $T_1 = \\triangle(i,j,k)$，高度 $h_k=0.40-0.25=0.15$。$k$ 处的半角 $\\gamma_k$ 满足 $\\tan \\gamma_k = (0.5/2)/0.15 = 0.25/0.15 = 5/3  1$。因此 $\\alpha_k  \\pi/2$（钝角）。我们计算 $\\cot \\alpha_k = \\frac{1-\\tan^2\\gamma_k}{2\\tan\\gamma_k} = \\frac{1-(5/3)^2}{2(5/3)} = \\frac{1-25/9}{10/3} = \\frac{-16/9}{10/3} = -\\frac{16}{30} = -\\frac{8}{15}$。\n对于 $T_2 = \\triangle(i,j,\\ell)$，高度 $h_\\ell = 1-0.25=0.75$。$\\ell$ 处的半角 $\\gamma_\\ell$ 满足 $\\tan \\gamma_\\ell = (0.5/2)/0.75 = 0.25/0.75 = 1/3  1$。因此 $\\alpha_\\ell  \\pi/2$（锐角）。我们计算 $\\cot \\alpha_\\ell = \\frac{1-(1/3)^2}{2(1/3)} = \\frac{1-1/9}{2/3} = \\frac{8/9}{2/3} = \\frac{12}{9} = \\frac{4}{3}$。\n和为 $\\cot \\alpha_k + \\cot \\alpha_\\ell = -8/15 + 4/3 = (-8 + 20)/15 = 12/15  0$。\n组装后的刚度元为 $K_{ij} = -\\frac{1}{2}(12/15)  0$。\n对于这条边，非正性条件是满足的。该选项中提供的例子直接反驳了它自己的谬误说法。\n结论：**不正确**。\n\n基于这一严谨的分析，选项 A 是唯一一个既提供了正确的几何构造，又对违反非对角刚度矩阵元的非正性（这是离散最大值原理的一个关键条件）给出了正确代数解释的选项。", "answer": "$$\\boxed{A}$$", "id": "2579531"}]}