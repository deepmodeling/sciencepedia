{"hands_on_practices": [{"introduction": "在实际的工程和物理问题中，边界条件很少是齐次的。本练习将引导您掌握有限元分析中的一项基本技术：“提升法”(lifting)。通过将解分解为一个满足给定边界条件的已知函数（提升函数）和一个具有齐次边界条件的未知波动函数，我们可以在标准的泛函分析框架内系统地应用伽辽金法。这个实践将通过一个具体的边界值问题，巩固您从基本原理出发建立并求解伽辽金问题的能力 [@problem_id:2612124]。", "problem": "考虑一个定义在开区间 $\\Omega=(0,1)$ 上的二阶线性标量边值问题，这是一个扩散-反应模型：\n$$\n-\\frac{d}{dx}\\Big(p(x)\\,\\frac{du}{dx}\\Big)+q(x)\\,u(x)=f(x)\\quad\\text{在 }\\Omega,\\qquad u(0)=g_0,\\quad u(1)=g_1,\n$$\n其系数为 $p(x)=1$, $q(x)=2$，源项为 $f(x)=2$，非齐次狄利克雷边界数据为 $g_0=1$, $g_1=2$。令 $H^1(\\Omega)$ 表示一阶索博列夫空间，$H^1_0(\\Omega)$ 表示其在 $\\partial\\Omega$ 上具有齐次迹的子空间。\n\n您的任务是：\n1) 构造一个提升（lifting）函数 $u_g\\in H^1(\\Omega)$，使得 $u_g$ 在 $\\partial\\Omega$ 上的迹等于给定的边界数据，并为涨落 $\\tilde u=u-u_g\\in H^1_0(\\Omega)$ 在齐次空间上重新构建伽辽金加权残差问题。仅使用加权残差法和分部积分的基本原理，不调用任何现成的公式。\n\n2) 专用于一维有限元方法（FEM）近似，使用一维试探-检验空间 $W:=\\operatorname{span}\\{\\varphi\\}$，其中 $\\varphi(x)=x(1-x)$，并采用仿射提升函数 $u_g(x)=g_0(1-x)+g_1 x$。在权函数取自同一空间的情况下，寻求伽辽金近似 $\\tilde u_h(x)=\\alpha\\,\\varphi(x)$。通过精确计算所有积分，确定唯一的标量伽辽金系数 $\\alpha$。\n\n将 $\\alpha$ 的精确值（不四舍五入）作为最终答案报告。不需要单位。", "solution": "对所提出的问题进行验证。\n\n**步骤 1：提取已知条件**\n- 微分方程：$-\\frac{d}{dx}\\Big(p(x)\\,\\frac{du}{dx}\\Big)+q(x)\\,u(x)=f(x)$，在定义域 $\\Omega=(0,1)$ 上。\n- 边界条件：$u(0)=g_0$, $u(1)=g_1$。\n- 系数和源项：$p(x)=1$, $q(x)=2$, $f(x)=2$。\n- 边界数据：$g_0=1$, $g_1=2$。\n- 函数空间：$H^1(\\Omega)$ 和 $H^1_0(\\Omega)$。\n- 任务 1：为边界数据构造一个提升函数 $u_g\\in H^1(\\Omega)$，并为涨落 $\\tilde u=u-u_g\\in H^1_0(\\Omega)$ 重新构建伽辽金问题。\n- 任务 2：使用有限元空间 $W=\\operatorname{span}\\{\\varphi\\}$（其中 $\\varphi(x)=x(1-x)$）和特定的提升函数 $u_g(x)=g_0(1-x)+g_1 x$，求近似解 $\\tilde u_h(x)=\\alpha\\,\\varphi(x)$ 中的伽辽金系数 $\\alpha$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题是一个标准的、适定的二阶线性边值问题。它在科学上基于微分方程理论及其通过有限元方法的数值解。所有数据和函数形式均已提供，构成一个自洽且一致的数学练习。系数 $p(x)=1>0$ 和 $q(x)=2 \\ge 0$ 通过 Lax-Milgram 定理保证了解的存在性和唯一性。该问题是客观、明确且可解的。\n\n**步骤 3：结论与行动**\n该问题被判定为**有效**。将提供解答。\n\n按要求，解答分为两部分。\n\n**第 1 部分：伽辽金问题的重新构建**\n\n控制方程是一个带有非齐次狄利克雷边界条件的二阶线性常微分方程：\n$$\n-\\frac{d}{dx}\\Big(p(x)\\,\\frac{du}{dx}\\Big)+q(x)\\,u(x)=f(x), \\quad x \\in \\Omega = (0,1)\n$$\n$$\nu(0)=g_0, \\quad u(1)=g_1\n$$\n标准的加权残差法从构建弱形式开始。我们将微分方程乘以一个足够光滑的检验函数 $v(x)$，该函数在指定狄利克雷条件的边界上为零。在这里，这个检验函数空间是 $H^1_0(\\Omega) = \\{v \\in H^1(\\Omega) \\,|\\, v(0)=v(1)=0\\}$。在定义域 $\\Omega$ 上积分：\n$$\n\\int_{0}^{1} \\left( -\\frac{d}{dx}\\Big(p(x)\\,\\frac{du}{dx}\\Big)+q(x)\\,u(x) \\right) v(x) \\,dx = \\int_{0}^{1} f(x) v(x) \\,dx\n$$\n对二阶项应用分部积分：\n$$\n\\int_{0}^{1} -\\frac{d}{dx}\\Big(p(x)\\,\\frac{du}{dx}\\Big) v(x) \\,dx = - \\left[ p(x)\\frac{du}{dx}v(x) \\right]_{0}^{1} + \\int_{0}^{1} p(x)\\frac{du}{dx}\\frac{dv}{dx}\\,dx\n$$\n边界项 $-[p(x)\\frac{du}{dx}v(x)]_0^1$ 因为检验函数 $v(x)$ 在 $x=0$ 和 $x=1$ 处为零而消失。于是，弱形式为：求 $u \\in H^1(\\Omega)$，使得 $u(0)=g_0$，$u(1)=g_1$，并且对于所有 $v \\in H^1_0(\\Omega)$：\n$$\n\\int_{0}^{1} \\left( p(x)\\frac{du}{dx}\\frac{dv}{dx} + q(x)u(x)v(x) \\right) \\,dx = \\int_{0}^{1} f(x)v(x) \\,dx\n$$\n试探函数 $u$ 必须满足非齐次边界条件，这对于构造有限维试探空间来说很不方便。为了解决这个问题，我们将解 $u$ 分解为一个预设的“提升”函数 $u_g \\in H^1(\\Omega)$ 和一个“涨落”函数 $\\tilde{u} \\in H^1_0(\\Omega)$ 的和。构造提升函数 $u_g$ 以满足非齐次边界条件，即 $u_g(0)=g_0$ 和 $u_g(1)=g_1$。然后，涨落函数 $\\tilde{u} = u - u_g$ 满足齐次边界条件：$\\tilde{u}(0) = u(0) - u_g(0) = g_0 - g_0 = 0$ 以及 $\\tilde{u}(1) = u(1) - u_g(1) = g_1 - g_1 = 0$。因此，$\\tilde{u}$ 与检验函数位于同一空间 $H^1_0(\\Omega)$ 中。\n\n将 $u = \\tilde{u} + u_g$ 代入弱形式：\n$$\n\\int_{0}^{1} \\left( p(x)\\frac{d}{dx}(\\tilde{u} + u_g)\\frac{dv}{dx} + q(x)(\\tilde{u} + u_g)v \\right) \\,dx = \\int_{0}^{1} f(x)v \\,dx\n$$\n利用积分和导数的线性性质，我们将包含未知量 $\\tilde{u}$ 的项与包含已知量 $u_g$ 的项分开：\n$$\n\\int_{0}^{1} \\left( p(x)\\frac{d\\tilde{u}}{dx}\\frac{dv}{dx} + q(x)\\tilde{u}v \\right) \\,dx + \\int_{0}^{1} \\left( p(x)\\frac{du_g}{dx}\\frac{dv}{dx} + q(x)u_g v \\right) \\,dx = \\int_{0}^{1} f(x)v \\,dx\n$$\n重新整理，将所有已知量放在右侧，得到涨落函数 $\\tilde{u}$ 的弱问题：求 $\\tilde{u} \\in H^1_0(\\Omega)$，使得对于所有 $v \\in H^1_0(\\Omega)$：\n$$\n\\int_{0}^{1} \\left( p(x)\\frac{d\\tilde{u}}{dx}\\frac{dv}{dx} + q(x)\\tilde{u}v \\right) \\,dx = \\int_{0}^{1} \\left( f(x)v - p(x)\\frac{du_g}{dx}\\frac{dv}{dx} - q(x)u_g v \\right) \\,dx\n$$\n这就是所要求的重新构建的伽辽金加权残差问题。它可以抽象地写成：求 $\\tilde{u} \\in H^1_0(\\Omega)$，使得对所有 $v \\in H^1_0(\\Omega)$ 都有 $a(\\tilde{u}, v) = L(v)$，其中双线性形式 $a(\\cdot, \\cdot)$ 和线性泛函 $L(\\cdot)$ 定义为：\n$$\na(w, v) = \\int_{0}^{1} \\left( p(x)\\frac{dw}{dx}\\frac{dv}{dx} + q(x)wv \\right) \\,dx\n$$\n$$\nL(v) = \\int_{0}^{1} f(x)v \\,dx - a(u_g, v) = \\int_{0}^{1} \\left( f(x)v - p(x)\\frac{du_g}{dx}\\frac{dv}{dx} - q(x)u_g v \\right) \\,dx\n$$\n\n**第 2 部分：伽辽金系数的确定**\n\n我们现在专用于给定的数据和有限维近似。\n系数为 $p(x)=1$, $q(x)=2$，源项为 $f(x)=2$。边界数据为 $g_0=1$, $g_1=2$。\n指定的提升函数为 $u_g(x) = g_0(1-x)+g_1 x = 1(1-x)+2x = 1+x$。其导数为 $\\frac{du_g}{dx} = 1$。\n试探函数和检验函数取自空间 $W=\\operatorname{span}\\{\\varphi\\}$，其中 $\\varphi(x)=x(1-x) = x-x^2$。其导数为 $\\frac{d\\varphi}{dx} = 1-2x$。\n涨落函数的伽辽金近似为 $\\tilde{u}_h(x) = \\alpha \\varphi(x)$，其中 $\\alpha$ 是未知的标量系数。检验函数为 $v(x) = \\varphi(x)$。\n将 $\\tilde{u}_h$ 代替 $\\tilde{u}$，$\\varphi$ 代替 $v$ 到弱形式 $a(\\tilde{u}, v) = L(v)$ 中：\n$$\na(\\alpha\\varphi, \\varphi) = L(\\varphi)\n$$\n根据双线性性质，这变成 $\\alpha \\, a(\\varphi, \\varphi) = L(\\varphi)$，从而得到 $\\alpha = \\frac{L(\\varphi)}{a(\\varphi, \\varphi)}$。\n\n我们计算分母 $a(\\varphi, \\varphi)$：\n$$\na(\\varphi, \\varphi) = \\int_{0}^{1} \\left( p(x)\\left(\\frac{d\\varphi}{dx}\\right)^2 + q(x)\\varphi(x)^2 \\right) \\,dx\n$$\n$$\na(\\varphi, \\varphi) = \\int_{0}^{1} \\left( 1 \\cdot (1-2x)^2 + 2 \\cdot (x-x^2)^2 \\right) \\,dx\n$$\n$$\na(\\varphi, \\varphi) = \\int_{0}^{1} \\left( (1-4x+4x^2) + 2(x^2-2x^3+x^4) \\right) \\,dx\n$$\n$$\na(\\varphi, \\varphi) = \\int_{0}^{1} (1-4x+6x^2-4x^3+2x^4) \\,dx\n$$\n$$\na(\\varphi, \\varphi) = \\left[ x - \\frac{4x^2}{2} + \\frac{6x^3}{3} - \\frac{4x^4}{4} + \\frac{2x^5}{5} \\right]_{0}^{1} = \\left[ x - 2x^2 + 2x^3 - x^4 + \\frac{2}{5}x^5 \\right]_{0}^{1}\n$$\n$$\na(\\varphi, \\varphi) = \\left( 1 - 2 + 2 - 1 + \\frac{2}{5} \\right) - 0 = \\frac{2}{5}\n$$\n接下来，我们计算分子 $L(\\varphi)$：\n$$\nL(\\varphi) = \\int_{0}^{1} \\left( f(x)\\varphi(x) - p(x)\\frac{du_g}{dx}\\frac{d\\varphi}{dx} - q(x)u_g(x)\\varphi(x) \\right) \\,dx\n$$\n$$\nL(\\varphi) = \\int_{0}^{1} \\left( 2(x-x^2) - 1 \\cdot 1 \\cdot (1-2x) - 2(1+x)(x-x^2) \\right) \\,dx\n$$\n$$\nL(\\varphi) = \\int_{0}^{1} \\left( (2x-2x^2) - (1-2x) - 2(x-x^3) \\right) \\,dx\n$$\n$$\nL(\\varphi) = \\int_{0}^{1} (2x-2x^2-1+2x - 2x+2x^3) \\,dx\n$$\n$$\nL(\\varphi) = \\int_{0}^{1} (2x^3-2x^2+2x-1) \\,dx\n$$\n$$\nL(\\varphi) = \\left[ \\frac{2x^4}{4} - \\frac{2x^3}{3} + \\frac{2x^2}{2} - x \\right]_{0}^{1} = \\left[ \\frac{1}{2}x^4 - \\frac{2}{3}x^3 + x^2 - x \\right]_{0}^{1}\n$$\n$$\nL(\\varphi) = \\left( \\frac{1}{2} - \\frac{2}{3} + 1 - 1 \\right) - 0 = \\frac{3}{6} - \\frac{4}{6} = -\\frac{1}{6}\n$$\n最后，我们计算系数 $\\alpha$：\n$$\n\\alpha = \\frac{L(\\varphi)}{a(\\varphi, \\varphi)} = \\frac{-1/6}{2/5} = -\\frac{1}{6} \\cdot \\frac{5}{2} = -\\frac{5}{12}\n$$", "answer": "$$\\boxed{-\\frac{5}{12}}$$", "id": "2612124"}, {"introduction": "标准的伽辽金法（即测试函数与试探函数取自同一空间）并非总是稳健的。本练习将探讨一个关键场景——对流占优问题，在这种情况下，标准方法可能会产生非物理的振荡。您将通过分析离散系统，理解这种不稳定性为何发生，并将其与单元佩克莱数（Péclet number）及矩阵M-矩阵性质的丧失联系起来。这项练习对于理解为何需要发展更高级的技术，如Petrov-Galerkin方法和各种稳定化格式，至关重要，这些技术是精确模拟输运现象的基石 [@problem_id:2612128]。", "problem": "考虑区间 $[0,1]$ 上具有常系数的稳定一维对流-扩散边值问题\n$$\n- \\varepsilon \\, u''(x) + \\beta \\, u'(x) = 0 \\quad \\text{for } x \\in (0,1),\n$$\n服从狄利克雷(Dirichlet)边界条件 $u(0)=u_L$ 和 $u(1)=u_R$，其中 $\\varepsilon>0$ 和 $\\beta>0$ 是常数。设 $\\mathcal{T}_h$ 是将 $[0,1]$ 划分为 $N$ 个长度为 $h=1/N$ 的子区间的均匀剖分，并设 $V_h$ 是相对于 $\\mathcal{T}_h$ 的满足本质边界条件的连续分片线性函数空间。使用标准的伽辽金(Galerkin)加权残差法，即从与 $V_h$ 相同的空间中选择权函数。\n\n从弱形式出发，通过将微分方程乘以一个检验函数并在 $[0,1]$ 上积分，对扩散项进行一次分部积分（并利用本质边界条件消除边界积分），推导出关于内部节点未知量的组装线性系统 $\\mathbf{A}\\mathbf{u}=\\mathbf{b}$。具体来说：\n\n- 在除了均匀性和线性形函数之外不作任何特殊结构假设的情况下，用 $\\varepsilon$, $\\beta$ 和 $h$ 表示内部节点 $x_i$ 处的全局三对角系数矩阵 $\\mathbf{A}$ 的非零元素。\n\n- 定义单元佩克莱数(Péclet number) $P_e:=\\dfrac{\\beta h}{2\\varepsilon}$，并确定对于哪些 $P_e$ 值，$\\mathbf{A}$ 的非对角元素会改变符号。利用具有非正非对角元素和适当对角占优的三对角系统的单调矩阵（M-矩阵）的特征，解释为什么当对流占主导地位时，标准的伽辽金方法可能无法满足离散极值原理（DMP）。\n\n根据您的推导和分析，选择下面所有正确描述了在给定网格上为对流主导情况恢复离散单调性（无虚假新极值）的修正方法的陈述：\n\nA. 用流线迎风Petrov-Galerkin (SUPG)检验空间替换标准检验空间，该空间增加了相容的流线扩散，并进行调整以使有效单元佩克莱数不超过1。\n\nB. 各向同性地添加人工扩散 $\\delta \\ge 0$，使得有效扩散率 $\\varepsilon_{\\text{eff}}=\\varepsilon+\\delta$ 满足 $\\varepsilon_{\\text{eff}} \\ge \\dfrac{\\beta h}{2}$，从而在一维中恢复所需的非对角元素符号模式。\n\nC. 切换到使用相同试探空间的节点配置法（强制残差在节点处为零）；这对任何 $P_e$ 都能产生一个单调格式。\n\nD. 添加一个非线性的、依赖于解的激波捕捉粘性或通量限制器，其设计目的是仅在需要的地方强制执行局部M-矩阵结构，从而恢复单调性。\n\nE. 使用子域加权法，其中每个单元上的权函数为分片常数1，并使用中心数值通量；这等效于一个迎风格式，并且对任何 $P_e$ 都是单调的。\n\nF. 均匀加密网格，直到处处满足 $\\dfrac{\\beta h}{2\\varepsilon} \\le 1$；在这样的网格上，一维的标准伽辽金矩阵满足DMP所需的符号条件。\n\n选择所有适用项。", "solution": "问题陈述具有科学依据，提法恰当，并包含进行严格分析所需的所有信息。它描述了一个标准的一维稳定对流-扩散方程边值问题，并要求分析标准的伽辽金有限元方法以及为确保离散极值原理而可能进行的修改。该问题是有效的。我们继续进行推导和分析。\n\n控制微分方程为：\n$$ - \\varepsilon \\, u''(x) + \\beta \\, u'(x) = 0 \\quad \\text{for } x \\in (0,1) $$\n边界条件为狄利克雷(Dirichlet)边界条件 $u(0)=u_L$ 和 $u(1)=u_R$，其中 $\\varepsilon > 0$ 和 $\\beta > 0$。\n\n为了推导弱形式，我们将方程乘以一个来自合适空间（此处为具有齐次边界条件 $v(0)=v(1)=0$ 的试探函数空间）的检验函数 $v(x)$，并在定义域 $[0,1]$ 上积分：\n$$ \\int_0^1 \\left( - \\varepsilon u''(x) + \\beta u'(x) \\right) v(x) \\, dx = 0 $$\n对扩散项应用分部积分，我们得到：\n$$ \\int_0^1 - \\varepsilon u'' v \\, dx = - \\left[ \\varepsilon u' v \\right]_0^1 + \\int_0^1 \\varepsilon u' v' \\, dx $$\n边界项 $- \\left[ \\varepsilon u' v \\right]_0^1$ 因为检验函数 $v(x)$ 在 $x=0$ 和 $x=1$ 处为零而消失。于是弱形式为：求 $u \\in H^1(0,1)$ 使得 $u(0)=u_L$, $u(1)=u_R$ 且对于所有检验函数 $v \\in H_0^1(0,1)$，\n$$ \\int_0^1 \\left( \\varepsilon u'(x)v'(x) + \\beta u'(x)v(x) \\right) \\, dx = 0 $$\n\n对于有限元离散化，我们使用一个均匀网格，节点为 $x_i = ih$，$i=0, \\dots, N$，其中 $h=1/N$。空间 $V_h$ 由连续分片线性函数组成。近似解为 $u_h(x) = \\sum_{j=0}^{N} u_j \\phi_j(x)$，其中 $\\phi_j(x)$ 是标准的线性“帽”状基函数，$u_j$ 是节点值。对于伽辽金方法，检验函数从相同的空间中选取，对于内部节点 $i=1, \\dots, N-1$，取 $v_h(x) = \\phi_i(x)$。\n\n针对内部节点未知量 $u_1, \\dots, u_{N-1}$ 得到的线性系统由下式给出：\n$$ \\sum_{j=0}^{N} u_j \\left( \\int_0^1 \\left( \\varepsilon \\phi_j' \\phi_i' + \\beta \\phi_j' \\phi_i \\right) \\, dx \\right) = 0, \\quad \\text{for } i=1, \\dots, N-1 $$\n线性系统 $\\mathbf{A}\\mathbf{u}=\\mathbf{b}$ 的矩阵元素为 $A_{ij} = \\int_0^1 (\\varepsilon \\phi_j' \\phi_i' + \\beta \\phi_j' \\phi_i) \\, dx$。由于基函数的局部支集特性，对于内部行 $i$，只有元素 $A_{i,i-1}$、$A_{i,i}$ 和 $A_{i,i+1}$ 是非零的。\n\n让我们计算这些元素。在单元 $[x_{k-1}, x_k]$ 上，基函数的导数为 $\\phi_{k-1}' = -1/h$ 和 $\\phi_k' = 1/h$。\n对角元素为：\n$$ A_{i,i} = \\int_{x_{i-1}}^{x_{i+1}} (\\varepsilon (\\phi_i')^2 + \\beta \\phi_i' \\phi_i) \\, dx = \\int_{x_{i-1}}^{x_i} \\varepsilon (\\frac{1}{h})^2 dx + \\int_{x_i}^{x_{i+1}} \\varepsilon (-\\frac{1}{h})^2 dx + \\int_{x_{i-1}}^{x_i} \\beta (\\frac{1}{h})\\phi_i dx + \\int_{x_i}^{x_{i+1}} \\beta (-\\frac{1}{h})\\phi_i dx $$\n$$ A_{i,i} = \\frac{\\varepsilon}{h} + \\frac{\\varepsilon}{h} + \\frac{\\beta}{2} - \\frac{\\beta}{2} = \\frac{2\\varepsilon}{h} $$\n次对角元素为：\n$$ A_{i,i-1} = \\int_{x_{i-1}}^{x_i} (\\varepsilon \\phi_{i-1}' \\phi_i' + \\beta \\phi_{i-1}' \\phi_i) \\, dx = \\int_{x_{i-1}}^{x_i} \\varepsilon (-\\frac{1}{h})(\\frac{1}{h}) dx + \\int_{x_{i-1}}^{x_i} \\beta (-\\frac{1}{h})\\phi_i dx $$\n$$ A_{i,i-1} = -\\frac{\\varepsilon}{h} - \\frac{\\beta}{2} $$\n超对角元素为：\n$$ A_{i,i+1} = \\int_{x_i}^{x_{i+1}} (\\varepsilon \\phi_{i+1}' \\phi_i' + \\beta \\phi_{i+1}' \\phi_i) \\, dx = \\int_{x_i}^{x_{i+1}} \\varepsilon (\\frac{1}{h})(-\\frac{1}{h}) dx + \\int_{x_i}^{x_{i+1}} \\beta (\\frac{1}{h})\\phi_i dx $$\n$$ A_{i,i+1} = -\\frac{\\varepsilon}{h} + \\frac{\\beta}{2} $$\n因此，内部节点 $x_i$ 的方程为：\n$$ \\left(-\\frac{\\varepsilon}{h} - \\frac{\\beta}{2}\\right) u_{i-1} + \\left(\\frac{2\\varepsilon}{h}\\right) u_i + \\left(-\\frac{\\varepsilon}{h} + \\frac{\\beta}{2}\\right) u_{i+1} = 0 $$\n使用单元佩克莱数 $P_e = \\frac{\\beta h}{2\\varepsilon}$，我们可以将这些系数写为：\n$$ A_{i,i-1} = -\\frac{\\varepsilon}{h}(1+P_e) \\quad\\quad A_{i,i} = \\frac{2\\varepsilon}{h} \\quad\\quad A_{i,i+1} = -\\frac{\\varepsilon}{h}(1-P_e) $$\n如果系数矩阵 $\\mathbf{A}$ 是一个 M-矩阵，则离散极值原理(DMP)可以得到保证。对于三对角矩阵，这要求正的对角元素（$A_{i,i} > 0$）、非正的非对角元素（当 $i \\ne j$ 时 $A_{i,j} \\le 0$）以及对角占优。\n我们的矩阵有 $A_{i,i} = \\frac{2\\varepsilon}{h} > 0$。次对角元素 $A_{i,i-1} = -\\frac{\\varepsilon}{h}(1+P_e)$ 总是负的，因为 $P_e > 0$。然而，超对角元素 $A_{i,i+1} = -\\frac{\\varepsilon}{h}(1-P_e)$ 会改变符号。它仅在 $1-P_e \\ge 0$ 时为非正，这意味着 $P_e \\le 1$。\n当对流远大于扩散时，即 $\\beta \\gg \\varepsilon$，这导致 $P_e > 1$。在这种情况下，$A_{i,i+1}$ 变为正数，该矩阵不再是M-矩阵，DMP也不被满足。这会导致数值解中出现非物理的振荡。\n\n我们现在来评估所提出的修正方法。\n\nA. **用流线迎风Petrov–Galerkin (SUPG)检验空间替换标准检验空间，该空间增加了相容的流线扩散，并进行调整以使有效单元佩克莱数不超过1。**\nSUPG方法通过将检验函数修改为 $v_h + \\tau \\beta v_h'$，增加了一个与残差成比例的人工扩散项。在一维中，这相当于在流线（流动）方向上增加扩散。该项可以通过参数 $\\tau$ 进行调整。正确选择 $\\tau$ 可以增加足够的人工扩散，以确保最终的系统矩阵满足M-矩阵条件。该陈述恰好描述了这样一个过程：调整方法以使有效佩克莱数 $P_{e, \\text{eff}} \\le 1$。这恢复了单调性。因此，该陈述是 **正确的**。\n\nB. **各向同性地添加人工扩散 $\\delta \\ge 0$，使得有效扩散率 $\\varepsilon_{\\text{eff}}=\\varepsilon+\\delta$ 满足 $\\varepsilon_{\\text{eff}} \\ge \\dfrac{\\beta h}{2}$，从而在一维中恢复所需的非对角元素符号模式。**\n这是强制实现单调性的直接方法。通过将 $\\varepsilon$ 替换为 $\\varepsilon_{\\text{eff}} = \\varepsilon+\\delta$，超对角元素变为 $A'_{i,i+1} = -\\frac{\\varepsilon_{\\text{eff}}}{h} + \\frac{\\beta}{2}$。条件 $A'_{i,i+1} \\le 0$ 要求 $\\varepsilon_{\\text{eff}} \\ge \\frac{\\beta h}{2}$，这正是该陈述所提议的。这对应于强制有效佩克莱数 $P_{e, \\text{eff}} = \\frac{\\beta h}{2\\varepsilon_{\\text{eff}}} \\le 1$。该方法有效，尽管代价是增加了数值扩散并降低了精度（除非 $\\delta \\to 0$ 随 $h$ 一起，否则这是一个不相容的修改）。“各向同性地”一词在多维中更具相关性，但在1D中仅表示添加到二阶导数项。该陈述是 **正确的**。\n\nC. **切换到使用相同试探空间的节点配置法（强制残差在节点处为零）；这对任何 $P_e$ 都能产生一个单调格式。**\n使用分片线性元的节点配置法是定义不明确的，因为二阶导数 $u_h''$ 在节点处不是一个函数。如果我们将此解释为在节点处应用的中心有限差分格式，我们会得到 $u_h'(x_i) \\approx \\frac{u_{i+1}-u_{i-1}}{2h}$ 和 $u_h''(x_i) \\approx \\frac{u_{i+1}-2u_i+u_{i-1}}{h^2}$。将这些代入偏微分方程会产生与标准伽辽金方法完全相同的代数系统。因此，它也存在同样的缺陷，并在 $P_e > 1$ 时产生振荡。声称它对任何 $P_e$ 都是单调的是错误的。该陈述是 **不正确的**。\n\nD. **添加一个非线性的、依赖于解的激波捕捉粘性或通量限制器，其设计目的是仅在需要的地方强制执行局部M-矩阵结构，从而恢复单调性。**\n这描述了先进的现代技术，如通量修正输运（FCT）或具有总变差递减（TVD）性质的格式。这些方法非线性地、自适应地增加人工扩散，仅在可能出现振荡的高梯度区域（潜在的激波或边界层）应用它。这类限制器的目的正是为了强制执行局部单调性约束，从而导致全局DMP，而不会在所有地方都增加过度的扩散。这是一个非常有效的策略。该陈述是 **正确的**。\n\nE. **使用子域加权法，其中每个单元上的权函数为分片常数1，并使用中心数值通量；这等效于一个迎风格式，并且对任何 $P_e$ 都是单调的。**\n子域加权法，其中残差在控制体积上的积分为零，是一种有限体积法。如果我们围绕每个节点定义控制体积（例如 $[x_i-h/2, x_i+h/2]$），并在控制体积面上使用中心差分类型的通量近似（基于节点值的线性插值），那么得到的代数系统与标准伽辽金方法和中心有限差分法的代数系统是相同的。因此，该格式在 $P_e > 1$ 时不是单调的。此外，中心通量格式根据定义不是迎风格式。迎风格式确实对任何 $P_e$ 都是单调的，但所描述的方法并不能产生迎风格式。该陈述包含多个事实错误。该陈述是 **不正确的**。\n\nF. **均匀加密网格，直到处处满足 $\\dfrac{\\beta h}{2\\varepsilon} \\le 1$；在这样的网格上，一维的标准伽辽金矩阵满足DMP所需的符号条件。**\n正如我们最初的分析所确立的，如果条件 $P_e = \\frac{\\beta h}{2\\varepsilon} \\le 1$ 成立，标准伽辽金矩阵就成为一个M-矩阵并满足DMP。对于任何固定的问题参数 $\\beta$ 和 $\\varepsilon$，总可以通过充分减小网格尺寸 $h$ 来满足这个条件。虽然对于 $\\beta/\\varepsilon$ 比率非常高的问题，这在计算上可能很昂贵，但它是一种在数学上合理且有效的方法来恢复单调性。该陈述是 **正确的**。\n\n总之，选项 A、B、D 和 F 描述了为对流主导的对流-扩散方程恢复离散单调性的有效方法。", "answer": "$$\\boxed{ABDF}$$", "id": "2612128"}, {"introduction": "除了伽辽金法，其他的加权残差技术（如配置法）为离散化提供了不同的途径。本练习聚焦于配置法，并引入一个强大的工具来分析针对瞬态问题的数值格式的质量。通过构建一个配置格式并进行傅里叶分析，您将推导出数值色散关系。这将使您能够量化数值格式在波传播过程中如何扭曲波形，从而深入理解数值色散和耗散这两个计算波物理学中的基本概念 [@problem_id:2612191]。", "problem": "考虑周期区间上的一维线性平流方程，\n$$\nu_{t}(x,t) + a\\,u_{x}(x,t) = 0, \\qquad x \\in [0,L], \\ t \\ge 0,\n$$\n其中平流速度 $a \\in \\mathbb{R}$ 为常数，且边界条件为周期性边界条件。设 $N \\in \\mathbb{N}$，定义一个均匀网格，其网格间距为 $h = L/N$，节点为 $x_{j} = j h$，$j = 0,1,\\dots,N-1$。\n\n采用配点形式的加权残差法，构建空间半离散化如下：在每个节点 $x_{j}$ 处，强制执行强形式残差\n$$\nR(x_{j},t) \\equiv u_{t}(x_{j},t) + a\\,u_{x}(x_{j},t) = 0\n$$\n通过将空间局部上的 $u(x,t)$ 替换为经过三个节点值 $\\{u(x_{j-1},t),u(x_{j},t),u(x_{j+1},t)\\}$ 的二次拉格朗日插值，并在 $x_{j}$ 处对该插值进行精确微分来近似 $u_{x}(x_{j},t)$。\n\n推导关于节点值 $u_{j}(t) \\equiv u(x_{j},t)$ 的半离散常微分方程，然后在周期性网格上进行傅里叶 (von Neumann) 分析，寻找以下形式的简正模解\n$$\nu_{j}(t) = \\hat{u}\\,\\exp\\!\\big(i \\kappa x_{j} - i \\omega t\\big),\n$$\n其中 $\\kappa \\in \\left\\{\\frac{2\\pi m}{L} : m \\in \\mathbb{Z}\\right\\}$ 是空间波数，$\\omega$ 是（可能为复数的）角频率。由此，确定数值色散关系 $\\omega_{h}(\\kappa)$，并通过检验 $\\omega_{h}(\\kappa)$ 的实部和虚部来判断该格式在半离散层面上是否具有色散性或耗散性。\n\n你的最终答案必须是 $\\omega_{h}(\\kappa)$ 作为 $a$、$h$ 和 $\\kappa$ 的函数的单一闭式解析表达式。无需四舍五入。不要包含单位。", "solution": "首先将对所述问题进行严格验证，以确保其科学上合理、适定且客观。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n从问题陈述中逐字提取已知条件：\n-   **控制方程：** $u_{t}(x,t) + a\\,u_{x}(x,t) = 0$\n-   **定义域：** $x \\in [0,L]$, $t \\ge 0$\n-   **平流速度：** 常数 $a \\in \\mathbb{R}$\n-   **边界条件：** 周期性\n-   **网格：** 均匀，其中 $N \\in \\mathbb{N}$，网格间距 $h = L/N$，节点 $x_{j} = j h$，$j = 0,1,\\dots,N-1$。\n-   **方法：** 加权残差法，配点形式。\n-   **残差强制：** 在每个节点 $x_{j}$ 处强制执行强形式残差 $R(x_{j},t) \\equiv u_{t}(x_{j},t) + a\\,u_{x}(x_{j},t) = 0$。\n-   **空间近似：** 将 $u(x,t)$ 替换为经过节点值 $\\{u(x_{j-1},t),u(x_{j},t),u(x_{j+1},t)\\}$ 的二次拉格朗日插值。通过对该插值求导得到导数 $u_{x}(x_{j},t)$。\n-   **分析任务：** 推导关于 $u_{j}(t) \\equiv u(x_{j},t)$ 的半离散常微分方程 (ODE)，使用形式为 $u_{j}(t) = \\hat{u}\\,\\exp\\!\\big(i \\kappa x_{j} - i \\omega t\\big)$ （其中 $\\kappa \\in \\left\\{\\frac{2\\pi m}{L} : m \\in \\mathbb{Z}\\right\\}$）的简正模解进行傅里叶 (von Neumann) 分析，确定数值色散关系 $\\omega_{h}(\\kappa)$，并分析其性质（色散、耗散）。\n\n**步骤2：使用提取的已知条件进行验证**\n根据验证标准对问题进行评估：\n-   **科学依据：** 该问题基于线性平流方程，这是数学物理学中的一个基本偏微分方程。所采用的方法——配点法、拉格朗日插值和傅里叶分析——是偏微分方程数值分析领域的标准和严谨技术。该问题在根本上是合理的。\n-   **适定性：** 提供了所有必要的信息。指令清晰，能够导出一个唯一确定的数值色散关系数学表达式。\n-   **客观性：** 语言技术性强且精确。没有主观或含糊的陈述。\n-   **完备性与一致性：** 问题是自洽的，没有矛盾。使用三点模板进行二次插值是一致的，足以定义空间导数的近似。\n\n**步骤3：结论与行动**\n该问题是**有效的**。这是一个偏微分方程数值分析中的标准、适定练习。现在开始求解。\n\n**求解推导**\n\n任务是推导半离散常微分方程组，然后推导其数值色散关系。\n\n**1. 使用二次插值的空间离散化**\n我们构造一个二次多项式 $P(x)$，它在节点 $x_{j-1}$、$x_{j}$ 和 $x_{j+1}$ 处对函数 $u(x,t)$ 进行插值。为方便起见，我们定义一个局部坐标系 $\\xi = x - x_{j}$，这样插值点就位于 $\\xi = -h$、$\\xi = 0$ 和 $\\xi = h$。在固定的时间 $t$，对应的节点值为 $u_{j-1}$、$u_{j}$ 和 $u_{j+1}$。\n\n二次拉格朗日插值多项式由下式给出：\n$$\nP(\\xi) = u_{j-1} L_{-1}(\\xi) + u_{j} L_{0}(\\xi) + u_{j+1} L_{1}(\\xi)\n$$\n其中 $L_{k}(\\xi)$ 是拉格朗日基多项式：\n-   $L_{-1}(\\xi) = \\frac{(\\xi - 0)(\\xi - h)}{(-h - 0)(-h - h)} = \\frac{\\xi(\\xi - h)}{2h^{2}}$\n-   $L_{0}(\\xi) = \\frac{(\\xi - (-h))(\\xi - h)}{(0 - (-h))(0 - h)} = \\frac{(\\xi + h)(\\xi - h)}{-h^{2}} = \\frac{h^{2} - \\xi^{2}}{h^{2}}$\n-   $L_{1}(\\xi) = \\frac{(\\xi - (-h))(\\xi - 0)}{(h - (-h))(h - 0)} = \\frac{\\xi(\\xi + h)}{2h^{2}}$\n\n我们需要近似空间导数 $u_{x}(x_{j},t)$。这对应于在 $x=x_{j}$ 处计算 $\\frac{dP}{dx}$ 的值，由于 $\\frac{d}{dx} = \\frac{d}{d\\xi}$，这等价于在 $\\xi=0$ 处计算 $\\frac{dP}{d\\xi}$ 的值。\n\n首先，我们计算基多项式的导数：\n-   $\\frac{d L_{-1}}{d\\xi} = \\frac{2\\xi - h}{2h^{2}}$\n-   $\\frac{d L_{0}}{d\\xi} = \\frac{-2\\xi}{h^{2}}$\n-   $\\frac{d L_{1}}{d\\xi} = \\frac{2\\xi + h}{2h^{2}}$\n\n在 $\\xi = 0$ 处计算这些导数的值：\n-   $\\left. \\frac{d L_{-1}}{d\\xi} \\right|_{\\xi=0} = \\frac{-h}{2h^{2}} = -\\frac{1}{2h}$\n-   $\\left. \\frac{d L_{0}}{d\\xi} \\right|_{\\xi=0} = 0$\n-   $\\left. \\frac{d L_{1}}{d\\xi} \\right|_{\\xi=0} = \\frac{h}{2h^{2}} = \\frac{1}{2h}$\n\n因此，在 $x_{j}$ 处的空间导数的近似值为：\n$$\nu_{x}(x_{j},t) \\approx \\left. \\frac{dP}{d\\xi} \\right|_{\\xi=0} = u_{j-1}(t) \\left(-\\frac{1}{2h}\\right) + u_{j}(t) (0) + u_{j+1}(t) \\left(\\frac{1}{2h}\\right) = \\frac{u_{j+1}(t) - u_{j-1}(t)}{2h}\n$$\n这是著名的一阶导数二阶中心差分公式。\n\n**2. 半离散常微分方程**\n配点法要求在每个节点 $x_{j}$ 处的残差为零：\n$$\nu_{t}(x_{j},t) + a\\,u_{x}(x_{j},t) = 0\n$$\n将各项替换为其离散对应项，其中 $u_j(t) \\equiv u(x_j, t)$ 且 $\\frac{du_j}{dt} \\equiv u_t(x_j, t)$，我们得到半离散常微分方程组：\n$$\n\\frac{du_{j}}{dt} + a \\left( \\frac{u_{j+1} - u_{j-1}}{2h} \\right) = 0 \\qquad \\text{对于 } j = 0, 1, \\dots, N-1\n$$\n\n**3. 傅里叶 (von Neumann) 分析**\n我们寻找形式为 $u_{j}(t) = \\hat{u}\\,\\exp(i\\kappa x_{j} - i\\omega t)$ 的简正模解。代入 $x_{j}=jh$：\n$$\nu_{j}(t) = \\hat{u}\\,\\exp(i\\kappa jh - i\\omega t)\n$$\n我们计算半离散常微分方程所需的各项：\n-   $\\frac{du_{j}}{dt} = -i\\omega \\, \\hat{u}\\,\\exp(i\\kappa jh - i\\omega t) = -i\\omega u_{j}(t)$\n-   $u_{j+1}(t) = \\hat{u}\\,\\exp(i\\kappa (j+1)h - i\\omega t) = u_{j}(t) \\exp(i\\kappa h)$\n-   $u_{j-1}(t) = \\hat{u}\\,\\exp(i\\kappa (j-1)h - i\\omega t) = u_{j}(t) \\exp(-i\\kappa h)$\n\n将这些代入半离散常微分方程：\n$$\n-i\\omega u_{j} + \\frac{a}{2h} \\left( u_{j} \\exp(i\\kappa h) - u_{j} \\exp(-i\\kappa h) \\right) = 0\n$$\n对于非平凡解，我们除以 $u_{j} \\neq 0$：\n$$\n-i\\omega + \\frac{a}{2h} \\left( \\exp(i\\kappa h) - \\exp(-i\\kappa h) \\right) = 0\n$$\n使用恒等式 $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$，括号中的表达式变为 $2i\\sin(\\kappa h)$。\n$$\n-i\\omega + \\frac{a}{2h} \\left( 2i\\sin(\\kappa h) \\right) = 0\n$$\n$$\n-i\\omega + i \\frac{a \\sin(\\kappa h)}{h} = 0\n$$\n求解 $\\omega$，我们将其记为数值色散关系 $\\omega_{h}(\\kappa)$：\n$$\n\\omega_{h}(\\kappa) = \\frac{a \\sin(\\kappa h)}{h}\n$$\n\n**4. 色散与耗散分析**\n对于原始的连续偏微分方程 $u_t + a u_x = 0$，代入假设解 $u(x,t) = \\hat{u} \\exp(i \\kappa x - i \\omega t)$ 得到 $-i\\omega + a(i\\kappa) = 0$，因此精确色散关系为 $\\omega(\\kappa) = a\\kappa$。这是一个线性关系。精确相速度为 $v_{p}(\\kappa) = \\omega(\\kappa)/\\kappa = a$，是一个常数。因此，精确方程是非色散的。精确的 $\\omega$ 是纯实数，因此该方程也是非耗散的。\n\n现在，我们分析数值格式：\n-   **耗散性：** 数值频率为 $\\omega_{h}(\\kappa) = a \\frac{\\sin(\\kappa h)}{h}$。由于 $a$、$h$ 和 $\\kappa$ 都是实数，$\\omega_{h}(\\kappa)$ 是纯实数。$\\omega$ 的虚部会导致振幅衰减或增长，对应于数值耗散或不稳定性。由于 $\\text{Im}(\\omega_{h}) = 0$，每个傅里叶模的振幅随时间保持不变。因此，该格式是**非耗散的**。这是中心空间离散化方法的一个典型特性。\n\n-   **色散性：** 数值相速度由下式给出：\n    $$\n    v_{p,h}(\\kappa) = \\frac{\\omega_{h}(\\kappa)}{\\kappa} = \\frac{a \\sin(\\kappa h)}{h\\kappa} = a \\left(\\frac{\\sin(\\kappa h)}{\\kappa h}\\right)\n    $$\n    要使格式非色散，相速度 $v_{p,h}$ 必须对所有波数 $\\kappa$ 都是常数。然而，因子 $\\frac{\\sin(\\kappa h)}{\\kappa h}$ 依赖于 $\\kappa$。在长波（小 $\\kappa h$）的极限下，我们有泰勒展开 $\\sin(\\theta) \\approx \\theta - \\theta^{3}/6$，所以\n    $$\n    v_{p,h}(\\kappa) \\approx a \\left( \\frac{\\kappa h - (\\kappa h)^{3}/6}{\\kappa h} \\right) = a \\left(1 - \\frac{(\\kappa h)^{2}}{6} \\right)\n    $$\n    相速度不是常数；它依赖于波数 $\\kappa$。具体来说，对于任何非零的 $\\kappa h$，都有 $|v_{p,h}(\\kappa)|  |a|$。这意味着不同的傅里叶分量以不同的速度传播，其中短波（较大的 $\\kappa h$）比长波传播得慢。这种现象被称为数值色散，它会导致波形随时间失真。因此，该格式是**色散的**。\n\n最终要求的是数值色散关系 $\\omega_{h}(\\kappa)$ 的解析表达式。", "answer": "$$\\boxed{\\frac{a \\sin(\\kappa h)}{h}}$$", "id": "2612191"}]}