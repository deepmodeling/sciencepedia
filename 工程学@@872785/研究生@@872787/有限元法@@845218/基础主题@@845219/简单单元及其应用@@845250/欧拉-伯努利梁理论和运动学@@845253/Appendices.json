{"hands_on_practices": [{"introduction": "欧拉-伯努利梁理论的有限元分析核心在于创建一个离散的“单元”，该单元能精确地代表梁的一部分。本练习将指导您从虚功原理出发，推导单元刚度矩阵。这个矩阵建立了节点力与位移之间的关系，是后续所有梁结构分析的基石。[@problem_id:2556574]", "problem": "考虑有限元法（FEM）中的一个等截面 Euler–Bernoulli 梁有限元，其杨氏模量 $E$、截面二次矩 $I$ 和单元长度 $L_{e}$ 均为常数。采用经典的小挠度弯曲 Euler–Bernoulli 运动学假设：横截面在变形后保持为平面，且垂直于变形后的中心线，因此转角场等于斜率，$\\theta(x)=\\dfrac{dw}{dx}$，曲率为 $\\kappa(x)=\\dfrac{d\\theta}{dx}=\\dfrac{d^{2}w}{dx^{2}}$。设该单元有两个节点，节点自由度集合为\n$$\n\\mathbf{q}_{e}=\\begin{pmatrix} w_{1}  \\theta_{1}  w_{2}  \\theta_{2}\\end{pmatrix}^{\\mathsf{T}},\n$$\n其中 $w_{a}$ 是节点 $a\\in\\{1,2\\}$ 处的横向位移，$\\theta_{a}$ 是该节点的斜率。使用虚功原理和能够精确再现节点位移和斜率的 $C^{1}$ 连续插值，推导精确的 $4\\times 4$ 弯曲刚度矩阵 $\\mathbf{K}_{e}$，使得在无分布荷载的情况下，节点力向量 $\\mathbf{f}_{e}=\\begin{pmatrix} V_{1}  M_{1}  V_{2}  M_{2}\\end{pmatrix}^{\\mathsf{T}}$ 满足 $\\mathbf{f}_{e}=\\mathbf{K}_{e}\\mathbf{q}_{e}$，其中 $V_{a}$ 和 $M_{a}$ 分别是节点 $a$ 处的剪力和弯矩。\n\n仅从基本定义出发：内虚功 $\\delta U=\\displaystyle\\int_{0}^{L_{e}} M\\,\\delta\\kappa\\,dx$，线性弹性弯曲关系 $M=E I\\,\\kappa$，以及运动学关系 $\\kappa=\\dfrac{d^{2}w}{dx^{2}}$。为 $w(x)$ 构建所需的插值，该插值需满足 $C^{1}$ 连续性以及再现节点值和斜率的条件，并由此得到曲率-位移算子。将单元刚度组装为此算子的一致二次型，并在单元上进行积分。\n\n用一个包含 $E$、$I$ 和 $L_{e}$ 的封闭形式的 $4\\times 4$ 矩阵表达你的最终答案。不需要进行数值计算，也不需要四舍五入。最终的方框表达式中不要包含物理单位。", "solution": "该问题要求推导一个双节点 Euler-Bernoulli 梁单元的弯曲刚度矩阵。推导必须基于虚功原理，并利用适合横向位移场 $w(x)$ 的插值方案。\n\n虚功原理的基本表述是内虚功 $\\delta U$ 等于外虚功 $\\delta W_{\\text{ext}}$。对于一个仅受节点力和节点力矩作用的梁单元，这可以表示为：\n$$\n\\delta U = \\delta W_{\\text{ext}}\n$$\n外虚功是节点力 $\\mathbf{f}_{e}$ 通过虚节点位移 $\\delta\\mathbf{q}_{e}$ 所做的功：\n$$\n\\delta W_{\\text{ext}} = \\delta w_1 V_1 + \\delta \\theta_1 M_1 + \\delta w_2 V_2 + \\delta \\theta_2 M_2 = \\delta\\mathbf{q}_{e}^{\\mathsf{T}} \\mathbf{f}_{e}\n$$\n内虚功，也称为虚应变能，由弯矩 $M$ 与虚曲率 $\\delta\\kappa$ 的乘积在单元长度 $L_e$ 上的积分给出：\n$$\n\\delta U = \\int_{0}^{L_{e}} M \\, \\delta\\kappa \\, dx\n$$\n问题指定了线性弹性本构关系 $M = EI\\kappa$，其中 $E$ 是杨氏模量，$I$ 是截面二次矩，两者均为常数。将此代入 $\\delta U$ 的表达式中：\n$$\n\\delta U = \\int_{0}^{L_{e}} (EI\\kappa) \\, \\delta\\kappa \\, dx\n$$\n为了继续推导，位移场 $w(x)$ 必须由节点自由度 $\\mathbf{q}_{e} = \\begin{pmatrix} w_{1}  \\theta_{1}  w_{2}  \\theta_{2}\\end{pmatrix}^{\\mathsf{T}}$ 插值得到。Euler-Bernoulli 梁的控制微分方程是四阶的，而我们有四个节点自由度。这表明应使用三次多项式对 $w(x)$ 进行插值，这是能够满足四个节点条件并确保跨单元边界的 $C^{1}$ 连续性（位移 $w$ 和斜率 $\\theta = dw/dx$ 的连续性）的最低阶多项式。\n设位移场表示为 $w(x) = \\mathbf{N}(x)\\mathbf{q}_{e}$，其中 $\\mathbf{N}(x)$ 是一个由形函数组成的 $1 \\times 4$ 行向量。\n$$\nw(x) = N_1(x) w_1 + N_2(x) \\theta_1 + N_3(x) w_2 + N_4(x) \\theta_2\n$$\n这些形函数是标准的 Hermite 三次多项式，定义在局部坐标域 $x \\in [0, L_e]$ 上。它们通过施加节点条件来确定：\n\\begin{itemize}\n    \\item $w(0) = w_1$, $\\frac{dw}{dx}(0) = \\theta_1$\n    \\item $w(L_e) = w_2$, $\\frac{dw}{dx}(L_e) = \\theta_2$\n\\end{itemize}\n得到的形函数为：\n$$\n\\begin{aligned}\nN_1(x) = 1 - 3\\left(\\frac{x}{L_e}\\right)^2 + 2\\left(\\frac{x}{L_e}\\right)^3 \\\\\nN_2(x) = x - 2L_e\\left(\\frac{x}{L_e}\\right)^2 + L_e\\left(\\frac{x}{L_e}\\right)^3 = x \\left(1 - \\frac{x}{L_e}\\right)^2 \\\\\nN_3(x) = 3\\left(\\frac{x}{L_e}\\right)^2 - 2\\left(\\frac{x}{L_e}\\right)^3 \\\\\nN_4(x) = -L_e\\left(\\frac{x}{L_e}\\right)^2 + L_e\\left(\\frac{x}{L_e}\\right)^3 = \\frac{x^2}{L_e} \\left(\\frac{x}{L_e} - 1\\right)\n\\end{aligned}\n$$\n曲率 $\\kappa$ 是位移的二阶导数：$\\kappa(x) = \\frac{d^2w}{dx^2}$。对插值位移场求导，我们得到曲率-位移关系：\n$$\n\\kappa(x) = \\frac{d^2}{dx^2} \\left( \\mathbf{N}(x)\\mathbf{q}_{e} \\right) = \\left( \\frac{d^2\\mathbf{N}(x)}{dx^2} \\right) \\mathbf{q}_{e} = \\mathbf{B}(x) \\mathbf{q}_{e}\n$$\n其中 $\\mathbf{B}(x)$ 是应变-位移算子，一个包含形函数二阶导数的 $1 \\times 4$ 行向量：\n$$\n\\mathbf{B}(x) = \\begin{pmatrix} N_1''(x)  N_2''(x)  N_3''(x)  N_4''(x) \\end{pmatrix}\n$$\n二阶导数为：\n$$\n\\begin{aligned}\nN_1''(x) = \\frac{1}{L_e^2}\\left(-6 + 12\\frac{x}{L_e}\\right) \\\\\nN_2''(x) = \\frac{1}{L_e}\\left(-4 + 6\\frac{x}{L_e}\\right) \\\\\nN_3''(x) = \\frac{1}{L_e^2}\\left(6 - 12\\frac{x}{L_e}\\right) \\\\\nN_4''(x) = \\frac{1}{L_e}\\left(-2 + 6\\frac{x}{L_e}\\right)\n\\end{aligned}\n$$\n于是虚曲率为 $\\delta\\kappa(x) = \\mathbf{B}(x)\\delta\\mathbf{q}_{e}$。将 $\\kappa$ 和 $\\delta\\kappa$ 的表达式代入内虚功方程：\n$$\n\\delta U = \\int_{0}^{L_{e}} EI \\left( \\mathbf{B}(x) \\mathbf{q}_{e} \\right)^{\\mathsf{T}} \\left( \\mathbf{B}(x) \\delta\\mathbf{q}_{e} \\right) dx = \\int_{0}^{L_{e}} \\left( \\delta\\mathbf{q}_{e}^{\\mathsf{T}} \\mathbf{B}(x)^{\\mathsf{T}} \\right) EI \\left( \\mathbf{B}(x) \\mathbf{q}_{e} \\right) dx\n$$\n由于 $\\mathbf{q}_{e}$ 和 $\\delta\\mathbf{q}_{e}$ 是关于 $x$ 的积分的常数向量，我们可以写成：\n$$\n\\delta U = \\delta\\mathbf{q}_{e}^{\\mathsf{T}} \\left( \\int_{0}^{L_{e}} EI \\mathbf{B}(x)^{\\mathsf{T}} \\mathbf{B}(x) \\, dx \\right) \\mathbf{q}_{e}\n$$\n令内虚功和外虚功相等，$\\delta\\mathbf{q}_{e}^{\\mathsf{T}} \\mathbf{f}_{e} = \\delta U$，我们得到：\n$$\n\\delta\\mathbf{q}_{e}^{\\mathsf{T}} \\mathbf{f}_{e} = \\delta\\mathbf{q}_{e}^{\\mathsf{T}} \\left( \\int_{0}^{L_{e}} EI \\mathbf{B}(x)^{\\mathsf{T}} \\mathbf{B}(x) \\, dx \\right) \\mathbf{q}_{e}\n$$\n由于此式必须对任意虚位移 $\\delta\\mathbf{q}_{e} \\neq \\mathbf{0}$ 成立，我们得到单元力-位移关系 $\\mathbf{f}_{e} = \\mathbf{K}_{e}\\mathbf{q}_{e}$，其中刚度矩阵 $\\mathbf{K}_{e}$ 为：\n$$\n\\mathbf{K}_{e} = \\int_{0}^{L_{e}} EI \\, \\mathbf{B}(x)^{\\mathsf{T}} \\mathbf{B}(x) \\, dx\n$$\n刚度矩阵的分量 $K_{ij}$ 按 $K_{ij} = \\int_{0}^{L_{e}} EI \\, B_i(x) B_j(x) \\, dx$ 计算。我们进行变量替换，引入无量纲坐标 $\\xi = x/L_e$，因此 $dx = L_e d\\xi$。积分限变为 $0$ 到 $1$。$\\mathbf{B}$ 的分量变为：\n$B_1(\\xi) = \\frac{1}{L_e^2}(-6+12\\xi)$，$B_2(\\xi) = \\frac{1}{L_e}(-4+6\\xi)$，$B_3(\\xi) = \\frac{1}{L_e^2}(6-12\\xi)$，$B_4(\\xi) = \\frac{1}{L_e}(-2+6\\xi)$。\n我们计算必要的积分。例如，对于分量 $K_{11}$：\n$$\nK_{11} = EI \\int_0^1 \\left(\\frac{1}{L_e^2}(-6+12\\xi)\\right)^2 L_e \\, d\\xi = \\frac{EI}{L_e^3} \\int_0^1 (36 - 144\\xi + 144\\xi^2) \\, d\\xi = \\frac{EI}{L_e^3} [36\\xi - 72\\xi^2 + 48\\xi^3]_0^1 = \\frac{12EI}{L_e^3}\n$$\n对于分量 $K_{12}$：\n$$\nK_{12} = EI \\int_0^1 \\left(\\frac{-6+12\\xi}{L_e^2}\\right)\\left(\\frac{-4+6\\xi}{L_e}\\right) L_e \\, d\\xi = \\frac{EI}{L_e^2} \\int_0^1 (24 - 84\\xi + 72\\xi^2) \\, d\\xi = \\frac{EI}{L_e^2} [24\\xi - 42\\xi^2 + 24\\xi^3]_0^1 = \\frac{6EI}{L_e^2}\n$$\n对于分量 $K_{22}$：\n$$\nK_{22} = EI \\int_0^1 \\left(\\frac{-4+6\\xi}{L_e}\\right)^2 L_e \\, d\\xi = \\frac{EI}{L_e} \\int_0^1 (16 - 48\\xi + 36\\xi^2) \\, d\\xi = \\frac{EI}{L_e} [16\\xi - 24\\xi^2 + 12\\xi^3]_0^1 = \\frac{4EI}{L_e}\n$$\n其余分量可以类似地计算，或从形函数导数的对称性和反对称性（$N_3''(x) = -N_1''(x)$）推导得出。这会导出诸如 $K_{13} = -K_{11}$ 和 $K_{33} = K_{11}$ 的关系。计算完所有独立分量并将它们组装起来后，我们便得到了单元刚度矩阵。提取公因子 $\\frac{EI}{L_e^3}$ 后得到最终的矩阵。\n$$\n\\mathbf{K}_{e} = \\frac{EI}{L_e^3}\n\\begin{pmatrix}\n12  & 6L_e  & -12  & 6L_e \\\\\n6L_e  & 4L_e^2  & -6L_e  & 2L_e^2 \\\\\n-12  & -6L_e  & 12  & -6L_e \\\\\n6L_e  & 2L_e^2  & -6L_e  & 4L_e^2\n\\end{pmatrix}\n$$\n这就是在三次位移场假设下，等截面 Euler-Bernoulli 梁单元的精确弯曲刚度矩阵。", "answer": "$$\n\\boxed{\\frac{EI}{L_{e}^{3}} \\begin{pmatrix} 12  & 6 L_{e}  & -12  & 6 L_{e} \\\\ 6 L_{e}  & 4 L_{e}^{2}  & -6 L_{e}  & 2 L_{e}^{2} \\\\ -12  & -6 L_{e}  & 12  & -6 L_{e} \\\\ 6 L_{e}  & 2 L_{e}^{2}  & -6 L_{e}  & 4 L_{e}^{2} \\end{pmatrix}}\n$$", "id": "2556574"}, {"introduction": "在推导出有限元单元后，验证其正确性是至关重要的一步。本练习将介绍“斑块检验”（Patch Test），这是有限元方法中一个基本概念，用于确保单元能够精确地再现常应变状态（在本例中为恒定曲率）。成功通过此检验能够使我们确信，由这些单元组成的网格在求解更复杂问题时将收敛到正确解。[@problem_id:2556548]", "problem": "考虑一个长度为 $L$、抗弯刚度 $E I$ 恒定的两节点欧拉-伯努利梁有限元，其运动学假设为：横截面保持平面且垂直于中性轴，横向剪切变形可忽略不计。横向位移场为 $w(x)$，转角为 $\\theta(x) = \\dfrac{d w}{d x}$。该单元在母坐标 $\\xi = x/L \\in [0,1]$ 中使用标准三次 Hermite 插值：\n$$\nw_h(x) = N_1(\\xi)\\,w_1 + N_2(\\xi)\\,\\theta_1 + N_3(\\xi)\\,w_2 + N_4(\\xi)\\,\\theta_2,\n$$\n其形函数为\n$$\nN_1(\\xi) = 1 - 3\\xi^{2} + 2\\xi^{3}, \\quad\nN_2(\\xi) = L\\left(\\xi - 2\\xi^{2} + \\xi^{3}\\right), \\quad\nN_3(\\xi) = 3\\xi^{2} - 2\\xi^{3}, \\quad\nN_4(\\xi) = L\\left(-\\xi^{2} + \\xi^{3}\\right).\n$$\n你需要通过证明该单元在恒定曲率的纯弯曲条件下通过斑块检验，来验证其完备性和协调性。考虑一个恒定曲率 $\\kappa_0$ 的精确纯弯曲运动场，其刚体项经选择后满足 $w(0) = 0$ 和 $\\theta(0) = 0$，即：\n$$\nw^{\\ast}(x) = \\frac{\\kappa_0}{2}\\,x^{2}, \\qquad \\theta^{\\ast}(x) = \\kappa_0\\,x.\n$$\n请从欧拉-伯努利梁理论的弱形式和给定插值的基本原理出发，按以下步骤进行：\n- 将精确的运动学条件施加于节点上，以获得节点自由度 $\\{w_1,\\theta_1,w_2,\\theta_2\\}$。\n- 使用曲率的定义 $\\kappa(x) = \\dfrac{d^{2} w}{d x^{2}}$ 和内虚功 $\\delta \\Pi_{\\text{int}} = \\displaystyle\\int_{0}^{L} E I\\,\\kappa\\,\\delta \\kappa \\, d x$，推导由插值场 $w_h(x)$ 产生的、对应于所施加的 $\\kappa_0$ 的单元内节点力向量。\n- 通过施加与恒定弯曲一致的边界牵引力（无分布载荷，仅有恒定的端部弯矩），证明该单元通过了斑块检验（即残差向量为零）。\n\n作为最终答案，请报告由单元恢复出的恒定弯矩的单个标量表达式，用 $E$、$I$ 和 $\\kappa_0$ 表示。最终的弯矩以牛顿·米 (N·m) 为单位，用符号表示。不要代入数值。", "solution": "本问题要求严格验证标准的、采用三次 Hermite 插值的两节点欧拉-伯努利梁单元在纯弯曲状态下（其特征为恒定曲率 $\\kappa_0$）能够通过斑块检验。此验证将遵循指定的步骤，从基本原理开始。\n\n首先，我们通过在单元节点处计算精确运动场来确定节点自由度 (DOF)。节点位于 $x=0$ (节点 1) 和 $x=L$ (节点 2)。精确位移场为 $w^{\\ast}(x) = \\frac{\\kappa_0}{2}x^{2}$，精确转角场为 $\\theta^{\\ast}(x) = \\frac{dw^{\\ast}}{dx} = \\kappa_0 x$。\n\n在节点 1 ($x=0$) 处：\n位移为 $w_1 = w^{\\ast}(0) = \\frac{\\kappa_0}{2}(0)^{2} = 0$。\n转角为 $\\theta_1 = \\theta^{\\ast}(0) = \\kappa_0(0) = 0$。\n\n在节点 2 ($x=L$) 处：\n位移为 $w_2 = w^{\\ast}(L) = \\frac{\\kappa_0}{2}L^{2}$。\n转角为 $\\theta_2 = \\theta^{\\ast}(L) = \\kappa_0 L$。\n\n因此，节点位移向量 $\\mathbf{d}$ 为：\n$$\n\\mathbf{d} = \\begin{pmatrix} w_1 \\\\ \\theta_1 \\\\ w_2 \\\\ \\theta_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{2}\\kappa_0 L^{2} \\\\ \\kappa_0 L \\end{pmatrix}\n$$\n\n接下来，我们将这些节点自由度代入横向位移的插值公式 $w_h(x)$。母坐标为 $\\xi = x/L$。\n$$\nw_h(x) = N_1(\\xi)\\,w_1 + N_2(\\xi)\\,\\theta_1 + N_3(\\xi)\\,w_2 + N_4(\\xi)\\,\\theta_2\n$$\n由于 $w_1=0$ 和 $\\theta_1=0$，该式简化为：\n$$\nw_h(x) = N_3(\\xi)\\,w_2 + N_4(\\xi)\\,\\theta_2\n$$\n代入形函数 $N_3(\\xi) = 3\\xi^{2} - 2\\xi^{3}$ 和 $N_4(\\xi) = L(-\\xi^{2} + \\xi^{3})$ 以及 $w_2$ 和 $\\theta_2$ 的值：\n$$\nw_h(x) = (3\\xi^{2} - 2\\xi^{3})\\left(\\frac{1}{2}\\kappa_0 L^{2}\\right) + L(-\\xi^{2} + \\xi^{3})(\\kappa_0 L)\n$$\n$$\nw_h(x) = \\kappa_0 L^{2} \\left( \\frac{3}{2}\\xi^{2} - \\xi^{3} \\right) + \\kappa_0 L^{2} \\left( -\\xi^{2} + \\xi^{3} \\right)\n$$\n$$\nw_h(x) = \\kappa_0 L^{2} \\left( \\frac{3}{2}\\xi^{2} - \\xi^{2} - \\xi^{3} + \\xi^{3} \\right) = \\kappa_0 L^{2} \\left( \\frac{1}{2}\\xi^{2} \\right)\n$$\n用 $x/L$ 替换母坐标 $\\xi$：\n$$\nw_h(x) = \\frac{1}{2} \\kappa_0 L^{2} \\left(\\frac{x}{L}\\right)^{2} = \\frac{1}{2} \\kappa_0 x^{2}\n$$\n这证明了 $w_h(x) = w^{\\ast}(x)$。有限元插值精确地再现了精确位移场。这个被称为完备性的性质，是通斑块检验的必要条件。\n\n现在我们从插值场 $w_h(x)$ 确定曲率 $\\kappa_h(x)$。曲率定义为 $\\kappa(x) = \\frac{d^{2}w}{dx^{2}}$。\n$$\n\\kappa_h(x) = \\frac{d^{2}}{dx^{2}} \\left( \\frac{1}{2} \\kappa_0 x^{2} \\right) = \\frac{d}{dx} (\\kappa_0 x) = \\kappa_0\n$$\n插值曲率是恒定的，并且精确等于所施加的恒定曲率 $\\kappa_0$。这是插值对于二次多项式场具有完备性的直接结果。\n\n下一步是推导内节点力向量 $\\mathbf{f}_{\\text{int}}$，它是由插值场对应的内应力产生的。虚功原理指出，内应变能的变分 $\\delta \\Pi_{\\text{int}}$ 等于内力的虚功 $\\delta\\mathbf{d}^T \\mathbf{f}_{\\text{int}}$。\n$$\n\\delta \\Pi_{\\text{int}} = \\int_{0}^{L} M \\delta\\kappa \\, dx = \\int_{0}^{L} (E I \\kappa_h) \\delta\\kappa_h \\, dx\n$$\n插值曲率可以用应变-位移矩阵 $\\mathbf{B}(x)$ 表示为节点自由度的函数，即 $\\kappa_h(x) = \\mathbf{B}(x)\\mathbf{d}$。$\\mathbf{B}(x)$ 的分量是形函数关于 $x$ 的二阶导数：$B_i(x) = \\frac{d^2N_i}{dx^2}$。\n然后，曲率的变分为 $\\delta\\kappa_h = \\mathbf{B}(x)\\delta\\mathbf{d}$。将此代入虚功表达式：\n$$\n\\delta \\Pi_{\\text{int}} = \\int_{0}^{L} E I \\kappa_h (\\mathbf{B}(x)\\delta\\mathbf{d}) \\, dx = \\delta\\mathbf{d}^T \\int_{0}^{L} E I \\kappa_h \\mathbf{B}(x)^T \\, dx\n$$\n由此，我们确定内力向量为：\n$$\n\\mathbf{f}_{\\text{int}} = \\int_{0}^{L} E I \\kappa_h(x) \\mathbf{B}(x)^T \\, dx\n$$\n由于 $E I$ 是常数，且我们已经发现 $\\kappa_h(x) = \\kappa_0$ 也是常数，我们可以写出：\n$$\n\\mathbf{f}_{\\text{int}} = E I \\kappa_0 \\int_{0}^{L} \\mathbf{B}(x)^T \\, dx\n$$\n矩阵 $\\mathbf{B}(x)$ 是根据形函数和链式法则 $\\frac{d}{dx} = \\frac{1}{L}\\frac{d}{d\\xi}$ 计算的：\n$$\n\\frac{d^2N_1}{dx^2} = \\frac{1}{L^2}(-6 + 12\\xi), \\quad \\frac{d^2N_2}{dx^2} = \\frac{1}{L^2}L(-4 + 6\\xi) = \\frac{1}{L}(-4 + 6\\xi)\n$$\n$$\n\\frac{d^2N_3}{dx^2} = \\frac{1}{L^2}(6 - 12\\xi), \\quad \\frac{d^2N_4}{dx^2} = \\frac{1}{L^2}L(-2 + 6\\xi) = \\frac{1}{L}(-2 + 6\\xi)\n$$\n我们通过将积分变量改为 $\\xi$ (其中 $dx = L d\\xi$) 来计算 $\\mathbf{B}(x)^T$ 的积分：\n$$\n\\int_{0}^{L} \\mathbf{B}(x)^T \\, dx = \\int_{0}^{1} \\frac{1}{L^2} \\begin{pmatrix} -6+12\\xi \\\\ L(-4+6\\xi) \\\\ 6-12\\xi \\\\ L(-2+6\\xi) \\end{pmatrix} L \\,d\\xi = \\frac{1}{L} \\int_{0}^{1} \\begin{pmatrix} -6+12\\xi \\\\ L(-4+6\\xi) \\\\ 6-12\\xi \\\\ L(-2+6\\xi) \\end{pmatrix} d\\xi\n$$\n计算每个分量的积分：\n$$\n\\int_{0}^{1} (-6+12\\xi) \\,d\\xi = [-6\\xi + 6\\xi^2]_0^1 = 0\n$$\n$$\n\\int_{0}^{1} L(-4+6\\xi) \\,d\\xi = L[-4\\xi + 3\\xi^2]_0^1 = -L\n$$\n$$\n\\int_{0}^{1} (6-12\\xi) \\,d\\xi = [6\\xi - 6\\xi^2]_0^1 = 0\n$$\n$$\n\\int_{0}^{1} L(-2+6\\xi) \\,d\\xi = L[-2\\xi + 3\\xi^2]_0^1 = L\n$$\n将这些结果代回：\n$$\n\\int_{0}^{L} \\mathbf{B}(x)^T \\, dx = \\frac{1}{L} \\begin{pmatrix} 0 \\\\ -L \\\\ 0 \\\\ L \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n因此，内节点力向量为：\n$$\n\\mathbf{f}_{\\text{int}} = E I \\kappa_0 \\begin{pmatrix} 0 \\\\ -1 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -E I \\kappa_0 \\\\ 0 \\\\ E I \\kappa_0 \\end{pmatrix}\n$$\n该向量表示单元对节点施加的力和力矩：两个节点处的横向力均为零，节点1处有一个大小为 $E I \\kappa_0$ 的顺时针力矩，节点2处有一个大小为 $E I \\kappa_0$ 的逆时针力矩。\n\n为了通过斑块检验，内节点力向量必须与恒定弯曲状态下一致的外节点力向量 $\\mathbf{f}_{\\text{ext}}$ 相平衡。在纯弯曲状态下，弯矩为 $M = E I \\kappa_0$，剪力 $V = \\frac{dM}{dx}$ 为零。因此，没有横向力施加于节点上。外部牵引力是在端点施加的力矩。在 $x=L$ (节点 2) 处，施加的力矩为 $M_2 = M = E I \\kappa_0$。在 $x=0$ (节点 1) 处，反力矩为 $M_1 = -M = -E I \\kappa_0$。外节点力向量为：\n$$\n\\mathbf{f}_{\\text{ext}} = \\begin{pmatrix} F_1 \\\\ M_1 \\\\ F_2 \\\\ M_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -E I \\kappa_0 \\\\ 0 \\\\ E I \\kappa_0 \\end{pmatrix}\n$$\n残差向量 $\\mathbf{r}$ 是外节点力与内节点力之差：\n$$\n\\mathbf{r} = \\mathbf{f}_{\\text{ext}} - \\mathbf{f}_{\\text{int}} = \\begin{pmatrix} 0 \\\\ -E I \\kappa_0 \\\\ 0 \\\\ E I \\kappa_0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ -E I \\kappa_0 \\\\ 0 \\\\ E I \\kappa_0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n由于残差向量为零，该单元在恒定曲率状态下处于平衡。斑块检验通过。\n\n最后的任务是报告单元恢复出的恒定弯矩。欧拉-伯努利梁的本构关系是 $M(x) = E I \\kappa(x)$。该单元恢复出一个恒定的曲率场 $\\kappa_h(x) = \\kappa_0$。因此，单元恢复出的弯矩沿其长度是恒定的，并由下式给出：\n$$\nM_h = E I \\kappa_0\n$$\n这就是所要求的表达式。", "answer": "$$\n\\boxed{E I \\kappa_0}\n$$", "id": "2556548"}, {"introduction": "超越静态分析，本练习将梁单元应用于一个经典的结构稳定性问题：欧拉屈曲。这涉及到推导和实现几何刚度矩阵，该矩阵考虑了轴向预应力的影响，并通过求解一个广义特征值问题来确定临界载荷。这个计算练习将理论与实际工程分析联系起来，展示了如何使用有限元方法预测结构的临界载荷和屈曲模态。[@problem_id:2556607]", "problem": "考虑一根遵循 Euler-Bernoulli 运动学的细长棱柱梁：其跨度为 $L$，横向位移场为 $w(x)$，具有小挠度/转角，平面横截面在变形后保持平面且垂直于中性轴，曲率为 $\\kappa(x) = d^2 w/dx^2$。设梁具有恒定的抗弯刚度 $E I$，并承受产生经典线性弹性屈曲的均匀轴向压缩荷载 $P$。使用有限元法（FEM），每个节点具有两个自由度，即横向位移 $w$ 和横截面转角 $\\theta = dw/dx$，并在每个单元上通过三次 Hermite 插值进行近似。从虚功原理和内部弯曲能的定义出发，构建单元弯曲刚度以及由轴向力的二阶功产生的几何刚度。组装全局系统，并在两端施加简支边界条件（铰接-铰接）：$w(0)=0$ 和 $w(L)=0$，两端转角不受约束。建立并求解广义线性屈曲特征值问题，以获得最小的正临界荷载。\n\n您的推导和实现必须仅基于基本定律和核心定义，例如 Euler-Bernoulli 梁运动学、虚功原理以及弯曲和轴向预应力的能量表达式。请勿使用任何绕过这些基础的预先推导的简化公式。用于验证的基本铰接-铰接屈曲荷载的解析连续介质参考解，必须根据相同理论从第一性原理推导得出。所有计算必须在国际单位制（SI）下进行：$E$ 的单位是帕斯卡（牛顿/平方米），$I$ 的单位是米的四次方，$L$ 的单位是米，屈曲荷载的单位是牛顿。下面要求的最终数值输出是无量纲的相对误差；因此，这些输出没有物理单位。\n\n实现一个程序，对于下述每个测试用例，计算：\n- 从组装后的有限元模型的广义特征值问题中得到的最小正屈曲特征值 $P_{\\text{FE}}$（单位：牛顿），以及\n- 相对误差 $|P_{\\text{FE}} - P_{\\text{exact}}| / P_{\\text{exact}}$，其中 $P_{\\text{exact}}$ 是根据连续介质理论为铰接-铰接边界条件推导出的精确解析基本屈曲荷载。\n\n您的程序必须求解以下测试套件，每个测试用例指定为一个元组 $(E, I, L, N)$，其中 $N$ 是等长度有限元的数量：\n- 测试 A（类钢梁的网格细化）：$(E, I, L, N) = (210 \\times 10^9, 8.1 \\times 10^{-6}, 2.0, 1)$\n- 测试 B：$(E, I, L, N) = (210 \\times 10^9, 8.1 \\times 10^{-6}, 2.0, 2)$\n- 测试 C：$(E, I, L, N) = (210 \\times 10^9, 8.1 \\times 10^{-6}, 2.0, 4)$\n- 测试 D：$(E, I, L, N) = (210 \\times 10^9, 8.1 \\times 10^{-6}, 2.0, 8)$\n- 测试 E：$(E, I, L, N) = (210 \\times 10^9, 8.1 \\times 10^{-6}, 2.0, 16)$\n- 测试 F（不同材料和几何形状）：$(E, I, L, N) = (70 \\times 10^9, 3.2 \\times 10^{-6}, 1.5, 12)$\n- 测试 G（非常细长的梁）：$(E, I, L, N) = (200 \\times 10^9, 5.0 \\times 10^{-8}, 10.0, 40)$\n\n对于每个测试用例，将相对误差计算为十进制数。您的程序应生成单行输出，其中包含按 A 到 G 顺序排列的结果，形式为逗号分隔的列表并用方括号括起来，例如 $[a,b,c,d,e,f,g]$。角度（如果处理任何中间角度）必须以弧度为单位。不提供用户输入；所有数据如上所述。数值方法必须是通用的：不要硬编码任何精确的屈曲荷载值；在程序中根据连续介质 Euler-Bernoulli 理论推导解析基准，并用它进行比较。最终输出是与测试 A 到 G 相对应的七个浮点相对误差列表，顺序完全一致，以十进制数表示。", "solution": "问题陈述经评估确定为有效。它具有科学依据、是适定的、客观的，并包含建立公式和求解所需量所需的所有必要信息。该问题是有限元法在线性弹性梁屈曲分析中的一个经典应用，基于连续介质力学和虚功的既定原理。\n\n求解过程如下。首先，使用连续介质力学公式推导基本屈曲荷载的精确解析解，该解将作为基准。其次，从虚功原理推导有限元公式，得到单元刚度矩阵和几何刚度矩阵。第三，详细说明组装全局系统、施加边界条件以及求解由此产生的广义特征值问题的过程。\n\n线性弹性屈曲的控制原理源于总势能的二阶变分为零，即 $\\delta^2 \\Pi = 0$。对于一根在压缩轴向荷载 $P$ 作用下、抗弯刚度为 $EI$ 的梁，此条件可利用虚功原理表示为弯曲应力的内部虚功与轴向力 $P$ 在屈曲构型的位移上所做的虚功之间的平衡。由此产生的针对虚横向位移 $\\delta w$ 的弱形式为：\n$$ \\delta U - \\delta W_P = \\int_{0}^{L} EI \\frac{d^2w}{dx^2} \\frac{d^2(\\delta w)}{dx^2} \\,dx - P \\int_{0}^{L} \\frac{dw}{dx} \\frac{d(\\delta w)}{dx} \\,dx = 0 $$\n其中 $w(x)$ 是横向位移场。\n\n首先，我们从控制方程的强形式推导精确解析解。这通过对弱形式进行分部积分并应用变分法的基本引理得到。由此产生的 Euler-Lagrange 方程是众所周知的梁屈曲四阶常微分方程：\n$$ EI \\frac{d^4 w}{dx^4} + P \\frac{d^2 w}{dx^2} = 0 $$\n让我们定义 $k^2 = P / (EI)$。方程变为 $\\frac{d^4 w}{dx^4} + k^2 \\frac{d^2 w}{dx^2} = 0$。其通解为：\n$$ w(x) = C_1 \\sin(kx) + C_2 \\cos(kx) + C_3 x + C_4 $$\n对于铰接-铰接梁（简支），其边界条件为两端位移为零且弯矩为零：\n$1.$ $w(0) = 0$\n$2.$ $w(L) = 0$\n$3.$ $M(0) = -EI \\frac{d^2 w}{dx^2}|_{x=0} = 0$\n$4.$ $M(L) = -EI \\frac{d^2 w}{dx^2}|_{x=L} = 0$\n\n依次应用这些条件：\n由 $w(0)=0$ 可得：$C_2 + C_4 = 0$。\n由 $M(0)=0$ 可得：$\\frac{d^2 w}{dx^2} = -k^2(C_1 \\sin(kx) + C_2 \\cos(kx))$。在 $x=0$ 处，这给出 $-k^2 C_2 = 0$。由于对于非平凡解 $k \\neq 0$，我们必须有 $C_2 = 0$。这意味着 $C_4 = 0$。\n解简化为 $w(x) = C_1 \\sin(kx) + C_3 x$。\n由 $w(L)=0$ 可得：$C_1 \\sin(kL) + C_3 L = 0$。\n由 $M(L)=0$ 可得：$-EI(-k^2 C_1 \\sin(kL)) = 0$，简化为 $C_1 \\sin(kL) = 0$。\n对于非平凡的屈曲形状，$C_1$ 不能为零。因此，我们必须有 $\\sin(kL) = 0$。根据前一个条件，这也意味着 $C_3 L = 0$，所以 $C_3 = 0$。\n特征值方程为 $\\sin(kL) = 0$，它得出 $kL = n\\pi$，对于任何整数 $n \\geq 1$。\n代入 $k = \\sqrt{P/(EI)}$，我们找到临界荷载：\n$$ P_n = \\frac{n^2 \\pi^2 EI}{L^2} $$\n基本（最小正）屈曲荷载对应于 $n=1$：\n$$ P_{\\text{exact}} = \\frac{\\pi^2 EI}{L^2} $$\n此解析结果将用于计算有限元解的相对误差。\n\n接下来，我们建立有限元法解。梁被离散化为 $N$ 个等长度单元，单元长度 $l_e = L/N$。每个单元有两个节点，每个节点有两个自由度（DOF）：横向位移 $w$ 和转角 $\\theta = dw/dx$。单元节点位移向量为 $\\mathbf{d}_e = \\{w_1, \\theta_1, w_2, \\theta_2\\}^T$。\n单元内的位移场使用三次 Hermite 形函数 $\\mathbf{N}(\\xi) = [N_1(\\xi), N_2(\\xi), N_3(\\xi), N_4(\\xi)]$ 进行插值，其中 $\\xi = x/l_e$ 是自然坐标（$0 \\le \\xi \\le 1$）：\n$$ w(\\xi) = \\mathbf{N}(\\xi) \\mathbf{d}_e $$\n形函数为：\n$N_1(\\xi) = 1 - 3\\xi^2 + 2\\xi^3$\n$N_2(\\xi) = l_e(\\xi - 2\\xi^2 + \\xi^3)$\n$N_3(\\xi) = 3\\xi^2 - 2\\xi^3$\n$N_4(\\xi) = l_e(-\\xi^2 + \\xi^3)$\n\n将插值的位移场代入弱形式，得到单元级矩阵方程。\n第一项给出单元弯曲刚度矩阵 $\\mathbf{k}_e$：\n$$ \\delta\\mathbf{d}_e^T \\mathbf{k}_e \\mathbf{d}_e = \\int_{0}^{l_e} EI \\left(\\frac{d^2w}{dx^2}\\right) \\left(\\frac{d^2(\\delta w)}{dx^2}\\right) \\,dx = \\delta\\mathbf{d}_e^T \\left( \\int_{0}^{l_e} EI (\\mathbf{B}_{\\text{curv}})^T \\mathbf{B}_{\\text{curv}} \\,dx \\right) \\mathbf{d}_e $$\n其中 $\\mathbf{B}_{\\text{curv}} = d^2\\mathbf{N}/dx^2$。积分得到标准单元弯曲刚度矩阵：\n$$ \\mathbf{k}_e = \\frac{EI}{l_e^3} \\begin{bmatrix} 12  & 6l_e  & -12  & 6l_e \\\\ 6l_e  & 4l_e^2  & -6l_e  & 2l_e^2 \\\\ -12  & -6l_e  & 12  & -6l_e \\\\ 6l_e  & 2l_e^2  & -6l_e  & 4l_e^2 \\end{bmatrix} $$\n弱形式中的第二项给出单元几何刚度矩阵 $\\mathbf{k}_{g,e}$，它考虑了轴向力 $P$ 的影响：\n$$ \\delta\\mathbf{d}_e^T (P \\mathbf{k}_{g,e}) \\mathbf{d}_e = P \\int_{0}^{l_e} \\left(\\frac{dw}{dx}\\right) \\left(\\frac{d(\\delta w)}{dx}\\right) \\,dx = P \\delta\\mathbf{d}_e^T \\left( \\int_{0}^{l_e} (\\mathbf{B}_{\\text{slope}})^T \\mathbf{B}_{\\text{slope}} \\,dx \\right) \\mathbf{d}_e $$\n其中 $\\mathbf{B}_{\\text{slope}} = d\\mathbf{N}/dx$。积分得到单元几何刚度矩阵：\n$$ \\mathbf{k}_{g,e} = \\frac{1}{30l_e} \\begin{bmatrix} 36  & 3l_e  & -36  & 3l_e \\\\ 3l_e  & 4l_e^2  & -3l_e  & -l_e^2 \\\\ -36  & -3l_e  & 36  & -3l_e \\\\ 3l_e  & -l_e^2  & -3l_e  & 4l_e^2 \\end{bmatrix} $$\n将单元矩阵组装成全局矩阵 $\\mathbf{K}$ 和 $\\mathbf{K}_g$，得到线性屈曲的全局系统：\n$$ \\mathbf{K} \\mathbf{D} = P \\mathbf{K}_g \\mathbf{D} $$\n其中 $\\mathbf{D}$ 是全局节点自由度向量。对于 $N$ 个单元（以及 $N+1$ 个节点），全局系统的规模为 $(2(N+1)) \\times (2(N+1))$。\n\n施加铰接-铰接边界条件 $w(0)=0$ 和 $w(L)=0$。这对应于第一个自由度（$w_0$）和索引为 $2N$ 的自由度（$w_N$）为零。我们通过从全局矩阵 $\\mathbf{K}$ 和 $\\mathbf{K}_g$ 中消去相应的行和列来强制执行这些条件，从而形成简化系统：\n$$ \\mathbf{K}_{\\text{red}} \\mathbf{D}_{\\text{red}} = P \\mathbf{K}_{g, \\text{red}} \\mathbf{D}_{\\text{red}} $$\n这是一个广义特征值问题。特征值 $P$ 是临界屈曲荷载，特征向量 $\\mathbf{D}_{\\text{red}}$ 是相应的屈曲模态振型。我们求解此系统以找到最小的正特征值，它对应于有限元模型预测的基本屈曲荷载 $P_{\\text{FE}}$。\n\n最后，对每个测试用例，使用以下公式计算相对误差：\n$$ \\text{Relative Error} = \\frac{|P_{\\text{FE}} - P_{\\text{exact}}|}{P_{\\text{exact}}} $$\n该实现将对每组给定的参数 $(E, I, L, N)$ 执行这些步骤。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eig\n\ndef solve():\n    \"\"\"\n    Solves for the fundamental buckling load of a pinned-pinned beam using FEM\n    and compares it to the exact analytical solution.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (E, I, L, N).\n    test_cases = [\n        (210e9, 8.1e-6, 2.0, 1),   # Test A\n        (210e9, 8.1e-6, 2.0, 2),   # Test B\n        (210e9, 8.1e-6, 2.0, 4),   # Test C\n        (210e9, 8.1e-6, 2.0, 8),   # Test D\n        (210e9, 8.1e-6, 2.0, 16),  # Test E\n        (70e9, 3.2e-6, 1.5, 12),   # Test F\n        (200e9, 5.0e-8, 10.0, 40), # Test G\n    ]\n\n    results = []\n    for E, I, L, N in test_cases:\n        # Step 1: Calculate the exact analytical fundamental buckling load\n        P_exact = (np.pi**2 * E * I) / (L**2)\n\n        # Step 2: FEM formulation\n        num_nodes = N + 1\n        num_dofs = 2 * num_nodes\n        le = L / N\n\n        # Define element bending stiffness matrix (ke)\n        ke = (E * I / le**3) * np.array([\n            [12, 6 * le, -12, 6 * le],\n            [6 * le, 4 * le**2, -6 * le, 2 * le**2],\n            [-12, -6 * le, 12, -6 * le],\n            [6 * le, 2 * le**2, -6 * le, 4 * le**2]\n        ])\n\n        # Define element geometric stiffness matrix (kge)\n        kge = (1 / (30 * le)) * np.array([\n            [36, 3 * le, -36, 3 * le],\n            [3 * le, 4 * le**2, -3 * le, -le**2],\n            [-36, -3 * le, 36, -3 * le],\n            [3 * le, -le**2, -3 * le, 4 * le**2]\n        ])\n\n        # Step 3: Assemble global matrices\n        K_global = np.zeros((num_dofs, num_dofs))\n        Kg_global = np.zeros((num_dofs, num_dofs))\n\n        for i in range(N):\n            # Global DOFs for element i (connecting nodes i and i+1)\n            # DOFs are w_i, theta_i, w_{i+1}, theta_{i+1}\n            dof_indices = np.array([2*i, 2*i + 1, 2*i + 2, 2*i + 3])\n            \n            # Add element matrices to global matrices\n            K_global[np.ix_(dof_indices, dof_indices)] += ke\n            Kg_global[np.ix_(dof_indices, dof_indices)] += kge\n\n        # Step 4: Apply pinned-pinned boundary conditions\n        # w(0) = 0 -> DOF 0 is constrained\n        # w(L) = 0 -> DOF 2*N is constrained\n        \n        # Identify degrees of freedom to keep\n        all_dofs = list(range(num_dofs))\n        constrained_dofs = [0, 2 * N]\n        kept_dofs = [dof for dof in all_dofs if dof not in constrained_dofs]\n        \n        # Reduce the global matrices\n        K_red = K_global[np.ix_(kept_dofs, kept_dofs)]\n        Kg_red = Kg_global[np.ix_(kept_dofs, kept_dofs)]\n\n        # Step 5: Solve the generalized eigenvalue problem K_red*v = P*Kg_red*v\n        eigenvalues, _ = eig(K_red, Kg_red)\n        \n        # The eigenvalues are the critical loads P. We need the smallest positive one.\n        # Eigenvalues may be complex due to numerical precision, so we take the real part.\n        positive_eigenvalues = np.real(eigenvalues[eigenvalues > 1e-6]) # Filter for positive\n        \n        if len(positive_eigenvalues) == 0:\n            # This case should not happen for a valid physical problem setup\n            P_fe = np.nan \n        else:\n            P_fe = np.min(positive_eigenvalues)\n\n        # Step 6: Calculate the relative error\n        relative_error = abs(P_fe - P_exact) / P_exact\n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```", "id": "2556607"}]}