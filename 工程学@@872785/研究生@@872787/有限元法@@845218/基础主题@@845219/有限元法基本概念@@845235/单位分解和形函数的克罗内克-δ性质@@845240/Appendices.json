{"hands_on_practices": [{"introduction": "我们从有限元方法中最基本的元素——线性三角形——开始。这个练习将抽象的克罗内克-德尔塔(Kronecker-delta)和单位分解(partition of unity)性质与具体计算联系起来。通过显式构造形函数并用它们来插值一个线性场，你将亲手验证这些性质如何保证了对线性函数的精确再现，这是有限元法精度的基石。[@problem_id:2586144]", "problem": "设平面中一个三角形的顶点为 $V_{1}=(1,2)$、$V_{2}=(4,3)$ 和 $V_{3}=(2,6)$。考虑该三角形上的线性Lagrange元，它用于有限元法（FEM，finite element method），其中节点形函数 $\\{N_{i}(x,y)\\}_{i=1}^{3}$ 是三角形上的仿射函数，并满足克罗内克-德尔塔性质 $N_{i}(V_{j})=\\delta_{ij}$ 和单位分解性质 $\\sum_{i=1}^{3}N_{i}(x,y)=1$。设点 $P$ 的坐标为 $P=\\left(\\frac{11}{4},\\frac{7}{2}\\right)$，该点严格位于三角形内部。\n\n任务：\n- 从三角形上线性Lagrange形函数的定义性质（在单元上是仿射的、在顶点处满足克罗内克-德尔塔性质、以及单位分解）出发，构造 $N_{1}(x,y)$、$N_{2}(x,y)$ 和 $N_{3}(x,y)$ 的显式表达式。证明它们满足单位分解和克罗内克-德尔塔性质。\n- 计算点 $P$ 相对于该三角形的重心坐标，其定义为 $\\lambda_{i}=N_{i}(P)$，其中 $i\\in\\{1,2,3\\}$。\n- 设 $g(x,y)\\equiv c$ 为任意常数函数（常数 $c\\in\\mathbb{R}$），并设 $\\ell(x,y)=3x-2y+1$ 为一个线性函数。使用此单元上的节点插值算子 $I_{h}f(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)f(V_{i})$，计算 $I_{h}g(P)$ 和 $I_{h}\\ell(P)$，并通过与 $g(P)$ 和 $\\ell(P)$ 比较来验证其精确性。\n\n请给出在点 $P$ 处插值线性函数的值，即 $I_{h}\\ell(P)$，作为最终答案，以精确分数形式表示。不包含单位。无需四舍五入。", "solution": "所提出的问题是有限元法中的一个标准练习，它问题适定、有科学依据，并包含唯一解所需的所有信息。我们将分三个阶段进行所需的计算。\n\n首先，我们构造线性Lagrange形函数 $N_{i}(x,y)$，其中 $i \\in \\{1, 2, 3\\}$。三角形上的线性形函数是一个形式为 $N_{i}(x,y) = a_{i}x + b_{i}y + c_{i}$ 的仿射函数。系数 $(a_{i}, b_{i}, c_{i})$ 通过施加克罗内克-德尔塔性质 $N_{i}(V_{j}) = \\delta_{ij}$ 来确定，其中 $V_{j}$ 是三角形的顶点。给定的顶点为 $V_{1}=(1,2)$、$V_{2}=(4,3)$ 和 $V_{3}=(2,6)$。\n\n对于形函数 $N_{1}(x,y)$，条件如下：\n$N_{1}(V_{1}) = a_{1}(1) + b_{1}(2) + c_{1} = 1$\n$N_{1}(V_{2}) = a_{1}(4) + b_{1}(3) + c_{1} = 0$\n$N_{1}(V_{3}) = a_{1}(2) + b_{1}(6) + c_{1} = 0$\n这构成了关于三个未知系数 $a_{1}$、$b_{1}$ 和 $c_{1}$ 的三元线性方程组。解此方程组得到 $a_{1} = -\\frac{3}{11}$，$b_{1} = -\\frac{2}{11}$ 和 $c_{1} = \\frac{18}{11}$。因此，第一个形函数是：\n$$N_{1}(x,y) = \\frac{1}{11}(-3x - 2y + 18)$$\n\n对于形函数 $N_{2}(x,y)$，条件如下：\n$N_{2}(V_{1}) = a_{2}(1) + b_{2}(2) + c_{2} = 0$\n$N_{2}(V_{2}) = a_{2}(4) + b_{2}(3) + c_{2} = 1$\n$N_{2}(V_{3}) = a_{2}(2) + b_{2}(6) + c_{2} = 0$\n解此方程组得到 $a_{2} = \\frac{4}{11}$，$b_{2} = -\\frac{1}{11}$ 和 $c_{2} = -\\frac{2}{11}$。第二个形函数是：\n$$N_{2}(x,y) = \\frac{1}{11}(4x - y - 2)$$\n\n对于形函数 $N_{3}(x,y)$，条件如下：\n$N_{3}(V_{1}) = a_{3}(1) + b_{3}(2) + c_{3} = 0$\n$N_{3}(V_{2}) = a_{3}(4) + b_{3}(3) + c_{3} = 0$\n$N_{3}(V_{3}) = a_{3}(2) + b_{3}(6) + c_{3} = 1$\n解此方程组得到 $a_{3} = -\\frac{1}{11}$，$b_{3} = \\frac{3}{11}$ 和 $c_{3} = -\\frac{5}{11}$。第三个形函数是：\n$$N_{3}(x,y) = \\frac{1}{11}(-x + 3y - 5)$$\n\n克罗内克-德尔塔性质根据构造已满足。我们还必须验证单位分解性质，$\\sum_{i=1}^{3}N_{i}(x,y)=1$。将表达式相加：\n$$ \\sum_{i=1}^{3}N_{i}(x,y) = \\frac{1}{11}[(-3x - 2y + 18) + (4x - y - 2) + (-x + 3y - 5)] $$\n$$ = \\frac{1}{11}[(-3+4-1)x + (-2-1+3)y + (18-2-5)] $$\n$$ = \\frac{1}{11}[0 \\cdot x + 0 \\cdot y + 11] = \\frac{11}{11} = 1 $$\n因此，对于所有的 $(x,y)$，单位分解性质都得到满足。\n\n其次，我们计算点 $P=\\left(\\frac{11}{4},\\frac{7}{2}\\right)$ 的重心坐标。重心坐标 $\\lambda_{i}$ 定义为 $\\lambda_{i} = N_{i}(P)$。\n$$\\lambda_{1} = N_{1}\\left(\\frac{11}{4},\\frac{7}{2}\\right) = \\frac{1}{11}\\left(-3\\left(\\frac{11}{4}\\right) - 2\\left(\\frac{7}{2}\\right) + 18\\right) = \\frac{1}{11}\\left(-\\frac{33}{4} - 7 + 18\\right) = \\frac{1}{11}\\left(-\\frac{33}{4} + 11\\right) = \\frac{1}{11}\\left(\\frac{-33+44}{4}\\right) = \\frac{1}{11}\\left(\\frac{11}{4}\\right) = \\frac{1}{4}$$\n$$\\lambda_{2} = N_{2}\\left(\\frac{11}{4},\\frac{7}{2}\\right) = \\frac{1}{11}\\left(4\\left(\\frac{11}{4}\\right) - \\frac{7}{2} - 2\\right) = \\frac{1}{11}\\left(11 - \\frac{7}{2} - \\frac{4}{2}\\right) = \\frac{1}{11}\\left(11 - \\frac{11}{2}\\right) = \\frac{1}{11}\\left(\\frac{22-11}{2}\\right) = \\frac{1}{11}\\left(\\frac{11}{2}\\right) = \\frac{1}{2}$$\n$$\\lambda_{3} = N_{3}\\left(\\frac{11}{4},\\frac{7}{2}\\right) = \\frac{1}{11}\\left(-\\frac{11}{4} + 3\\left(\\frac{7}{2}\\right) - 5\\right) = \\frac{1}{11}\\left(-\\frac{11}{4} + \\frac{21}{2} - 5\\right) = \\frac{1}{11}\\left(\\frac{-11+42-20}{4}\\right) = \\frac{1}{11}\\left(\\frac{11}{4}\\right) = \\frac{1}{4}$$\n$P$ 点的重心坐标是 $(\\lambda_{1}, \\lambda_{2}, \\lambda_{3}) = (\\frac{1}{4}, \\frac{1}{2}, \\frac{1}{4})$。注意它们的和为 $1$（$\\frac{1}{4}+\\frac{1}{2}+\\frac{1}{4}=1$）并且全部为正，这证实了点 $P$ 严格位于三角形内部的说法。\n\n第三，我们计算插值。函数 $f(x,y)$ 的节点插值由 $I_{h}f(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)f(V_{i})$ 给出。在点 $P$ 处，这变为 $I_{h}f(P)=\\sum_{i=1}^{3}N_{i}(P)f(V_{i}) = \\sum_{i=1}^{3}\\lambda_{i}f(V_{i})$。\n\n对于常数函数 $g(x,y) = c$，我们有对所有的 $i$， $g(V_{i}) = c$。\n$$I_{h}g(P) = \\sum_{i=1}^{3}\\lambda_{i}g(V_{i}) = \\lambda_{1}c + \\lambda_{2}c + \\lambda_{3}c = c(\\lambda_{1} + \\lambda_{2} + \\lambda_{3}) = c(1) = c$$\n精确值为 $g(P) = c$。插值是精确的，正如预期。\n\n对于线性函数 $\\ell(x,y) = 3x - 2y + 1$，我们首先计算它在顶点处的值：\n$\\ell(V_{1}) = \\ell(1,2) = 3(1) - 2(2) + 1 = 3 - 4 + 1 = 0$\n$\\ell(V_{2}) = \\ell(4,3) = 3(4) - 2(3) + 1 = 12 - 6 + 1 = 7$\n$\\ell(V_{3}) = \\ell(2,6) = 3(2) - 2(6) + 1 = 6 - 12 + 1 = -5$\n现在我们计算在点 $P$ 的插值：\n$$I_{h}\\ell(P) = \\sum_{i=1}^{3}\\lambda_{i}\\ell(V_{i}) = \\lambda_{1}\\ell(V_{1}) + \\lambda_{2}\\ell(V_{2}) + \\lambda_{3}\\ell(V_{3})$$\n$$I_{h}\\ell(P) = \\left(\\frac{1}{4}\\right)(0) + \\left(\\frac{1}{2}\\right)(7) + \\left(\\frac{1}{4}\\right)(-5) = 0 + \\frac{7}{2} - \\frac{5}{4} = \\frac{14}{4} - \\frac{5}{4} = \\frac{9}{4}$$\n为了验证精确性，我们计算 $\\ell(P)$ 的真实值：\n$$\\ell(P) = \\ell\\left(\\frac{11}{4},\\frac{7}{2}\\right) = 3\\left(\\frac{11}{4}\\right) - 2\\left(\\frac{7}{2}\\right) + 1 = \\frac{33}{4} - 7 + 1 = \\frac{33}{4} - 6 = \\frac{33-24}{4} = \\frac{9}{4}$$\n插值 $I_{h}\\ell(P) = \\frac{9}{4}$ 与真实值 $\\ell(P) = \\frac{9}{4}$ 相同。这证实了线性Lagrange元为其形函数所构造的多项式空间内的任何函数（本例中包括所有仿射函数）提供精确插值的理论性质。最终要求的答案是 $I_{h}\\ell(P)$ 的值。", "answer": "$$\\boxed{\\frac{9}{4}}$$", "id": "2586144"}, {"introduction": "理解一个概念的最好方法之一是探究其不成立时的情形。这个练习提供了一组非标准的基函数，它们不满足克罗内克-德尔塔性质。通过分析这个反例，你将深刻理解为何标准的拉格朗日形函数如此重要，以及它们如何简化节点值与自由度之间的关系。[@problem_id:2586154]", "problem": "考虑平面上的参考三角形 $T$，其顶点为 $\\boldsymbol{v}_1=(0,0)$、$\\boldsymbol{v}_2=(1,0)$ 和 $\\boldsymbol{v}_3=(0,1)$。令 $L_1(x,y)=1-x-y$、$L_2(x,y)=x$ 和 $L_3(x,y)=y$ 表示 $T$ 上的重心坐标，它们满足基本性质 $L_1+L_2+L_3=1$ 和 $L_i(\\boldsymbol{v}_j)=\\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克-德尔塔 (Kronecker delta) 符号。在 $T$ 上定义三个函数：\n$$\n\\phi_1 = L_1 + L_2, \\quad \\phi_2 = L_2 + L_3, \\quad \\phi_3 = L_3 + L_1.\n$$\n这些函数是有限元方法（FEM）中形函数的候选函数。\n\n仅使用重心坐标的性质和上述定义，完成以下任务：\n- 从第一性原理出发，证明 $\\{\\phi_1,\\phi_2,\\phi_3\\}$ 是 $T$ 上的一个线性无关集。\n- 计算节点值 $\\phi_i(\\boldsymbol{v}_j)$，并由此证明克罗内克-德尔塔性质 $\\,\\phi_i(\\boldsymbol{v}_j)=\\delta_{ij}\\,$ 对该基不成立。说明单位分解性质是否成立。\n- 考虑一个形式为 $u_h = a_1 \\phi_1 + a_2 \\phi_2 + a_3 \\phi_3$ 的插值函数 $u_h \\in \\operatorname{span}\\{\\phi_1,\\phi_2,\\phi_3\\}$。设给定的节点值为 $u_1 = u_h(\\boldsymbol{v}_1)$、$u_2 = u_h(\\boldsymbol{v}_2)$ 和 $u_3 = u_h(\\boldsymbol{v}_3)$。解释为什么系数 $a_1,a_2,a_3$ 不能直接设为等于 $u_1,u_2,u_3$，并推导将 $\\begin{pmatrix}a_1  a_2  a_3\\end{pmatrix}^\\top$ 映射到 $\\begin{pmatrix}u_1  u_2  u_3\\end{pmatrix}^\\top$ 的线性系统。\n\n作为最终答案，请提供系数向量 $\\begin{pmatrix}a_1  a_2  a_3\\end{pmatrix}$ 关于节点值 $\\begin{pmatrix}u_1  u_2  u_3\\end{pmatrix}$ 的显式解析表达式。将最终答案表示为单个行矩阵。无需四舍五入。", "solution": "所提供的问题陈述是自洽的、逻辑一致且科学上合理的。它是在有限元方法框架内分析基函数的一个标准练习。所有术语都有明确定义，任务清晰明确。因此，该问题是有效的，我们可以着手解决。\n\n基本原理是重心坐标 $\\{ L_1, L_2, L_3 \\}$ 的线性无关性。这些函数构成了三角形 $T$ 上线性多项式的一个基。因此，对于所有点 $(x,y) \\in T$，任何线性组合 $\\alpha_1 L_1 + \\alpha_2 L_2 + \\alpha_3 L_3 = 0$ 都意味着 $\\alpha_1 = \\alpha_2 = \\alpha_3 = 0$。我们将利用这一事实来回答问题的第一部分。\n\n首先，我们证明集合 $\\{\\phi_1, \\phi_2, \\phi_3\\}$ 的线性无关性。我们在 $T$ 上建立一个等于零函数的线性组合：\n$$\nc_1 \\phi_1 + c_2 \\phi_2 + c_3 \\phi_3 = 0\n$$\n将 $\\phi_i$ 的定义用重心坐标 $L_i$ 代入：\n$$\nc_1 (L_1 + L_2) + c_2 (L_2 + L_3) + c_3 (L_3 + L_1) = 0\n$$\n我们通过对每个重心坐标函数的系数进行分组来重新排列各项：\n$$\n(c_1 + c_3) L_1 + (c_1 + c_2) L_2 + (c_2 + c_3) L_3 = 0\n$$\n由于集合 $\\{L_1, L_2, L_3\\}$ 是线性无关的，该线性组合的系数必须全部为零。这为未知常数 $c_1, c_2, c_3$ 产生一个线性方程组：\n$$\n\\begin{cases}\nc_1 + c_3 = 0 \\\\\nc_1 + c_2 = 0 \\\\\nc_2 + c_3 = 0\n\\end{cases}\n$$\n由第一个方程得 $c_3 = -c_1$。由第二个方程得 $c_2 = -c_1$。将这些代入第三个方程得到 $(-c_1) + (-c_1) = 0$，化简为 $-2c_1 = 0$，这意味着 $c_1 = 0$。因此，$c_2 = 0$ 且 $c_3 = 0$。由于唯一的解是所有系数均为零的平凡解，函数集合 $\\{\\phi_1, \\phi_2, \\phi_3\\}$ 被证明是线性无关的。\n\n接下来，我们使用给定的性质 $L_i(\\boldsymbol{v}_j) = \\delta_{ij}$（其中 $\\delta_{ij}$ 是克罗内克-德尔塔符号）来计算节点值 $\\phi_i(\\boldsymbol{v}_j)$。\n对于 $\\phi_1 = L_1 + L_2$：\n$\\phi_1(\\boldsymbol{v}_1) = L_1(\\boldsymbol{v}_1) + L_2(\\boldsymbol{v}_1) = 1 + 0 = 1$。\n$\\phi_1(\\boldsymbol{v}_2) = L_1(\\boldsymbol{v}_2) + L_2(\\boldsymbol{v}_2) = 0 + 1 = 1$。\n$\\phi_1(\\boldsymbol{v}_3) = L_1(\\boldsymbol{v}_3) + L_2(\\boldsymbol{v}_3) = 0 + 0 = 0$。\n\n对于 $\\phi_2 = L_2 + L_3$：\n$\\phi_2(\\boldsymbol{v}_1) = L_2(\\boldsymbol{v}_1) + L_3(\\boldsymbol{v}_1) = 0 + 0 = 0$。\n$\\phi_2(\\boldsymbol{v}_2) = L_2(\\boldsymbol{v}_2) + L_3(\\boldsymbolv}_2) = 1 + 0 = 1$。\n$\\phi_2(\\boldsymbol{v}_3) = L_2(\\boldsymbol{v}_3) + L_3(\\boldsymbol{v}_3) = 0 + 1 = 1$。\n\n对于 $\\phi_3 = L_3 + L_1$：\n$\\phi_3(\\boldsymbol{v}_1) = L_3(\\boldsymbol{v}_1) + L_1(\\boldsymbol{v}_1) = 0 + 1 = 1$。\n$\\phi_3(\\boldsymbol{v}_2) = L_3(\\boldsymbol{v}_2) + L_1(\\boldsymbol{v}_2) = 0 + 0 = 0$。\n$\\phi_3(\\boldsymbol{v}_3) = L_3(\\boldsymbol{v}_3) + L_1(\\boldsymbol{v}_3) = 1 + 0 = 1$。\n\n克罗内克-德尔塔性质要求 $\\phi_i(\\boldsymbol{v}_j) = \\delta_{ij}$。例如，该性质要求 $\\phi_1(\\boldsymbol{v}_2) = \\delta_{12} = 0$，但我们计算出 $\\phi_1(\\boldsymbol{v}_2) = 1$。由于这些值与克罗内克-德尔塔符号不匹配，该性质对此基不成立。\n\n为了检验单位分解性质，我们必须验证在 $T$ 上是否有 $\\sum_{i=1}^3 \\phi_i = 1$。我们对这些函数求和：\n$$\n\\sum_{i=1}^3 \\phi_i = \\phi_1 + \\phi_2 + \\phi_3 = (L_1 + L_2) + (L_2 + L_3) + (L_3 + L_1) = 2L_1 + 2L_2 + 2L_3\n$$\n利用给定的性质 $L_1 + L_2 + L_3 = 1$，我们发现：\n$$\n\\sum_{i=1}^3 \\phi_i = 2(L_1 + L_2 + L_3) = 2(1) = 2\n$$\n由于和为 $2$ 而不是 $1$，单位分解性质不满足。\n\n最后，我们考虑插值函数 $u_h = a_1 \\phi_1 + a_2 \\phi_2 + a_3 \\phi_3$。系数 $a_i$ 代表自由度。节点值 $u_j$ 由 $u_j = u_h(\\boldsymbol{v}_j)$ 给出。要使系数 $a_i$ 直接等于节点值 $u_i$（即 $a_j = u_j$），基函数必须满足克罗内克-德尔塔性质。要理解这一点，如果 $\\phi_i(\\boldsymbol{v}_j) = \\delta_{ij}$，那么在节点 $\\boldsymbol{v}_j$ 处求值会得到 $u_h(\\boldsymbol{v}_j) = \\sum_{i=1}^3 a_i \\phi_i(\\boldsymbol{v}_j) = \\sum_{i=1}^3 a_i \\delta_{ij} = a_j$。由于我们已经证明了该基函数不满足克罗内克-德尔塔性质，因此系数 $a_j$ 通常不等于节点值 $u_j$。\n\n为了找到系数 $\\boldsymbol{a} = \\begin{pmatrix} a_1  a_2  a_3 \\end{pmatrix}^\\top$ 和节点值 $\\boldsymbol{u} = \\begin{pmatrix} u_1  u_2  u_3 \\end{pmatrix}^\\top$ 之间的关系，我们在每个顶点处对插值函数求值：\n$u_1 = u_h(\\boldsymbol{v}_1) = a_1 \\phi_1(\\boldsymbol{v}_1) + a_2 \\phi_2(\\boldsymbol{v}_1) + a_3 \\phi_3(\\boldsymbol{v}_1) = a_1(1) + a_2(0) + a_3(1) = a_1 + a_3$。\n$u_2 = u_h(\\boldsymbol{v}_2) = a_1 \\phi_1(\\boldsymbol{v}_2) + a_2 \\phi_2(\\boldsymbol{v}_2) + a_3 \\phi_3(\\boldsymbol{v}_2) = a_1(1) + a_2(1) + a_3(0) = a_1 + a_2$。\n$u_3 = u_h(\\boldsymbol{v}_3) = a_1 \\phi_1(\\boldsymbol{v}_3) + a_2 \\phi_2(\\boldsymbol{v}_3) + a_3 \\phi_3(\\boldsymbol{v}_3) = a_1(0) + a_2(1) + a_3(1) = a_2 + a_3$。\n\n这给出了线性系统 $\\boldsymbol{u} = M \\boldsymbol{a}$：\n$$\n\\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\end{pmatrix} = \\begin{pmatrix} 1  0  1 \\\\ 1  1  0 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} a_1 \\\\ a_2 \\\\ a_3 \\end{pmatrix}\n$$\n为了求解 $\\boldsymbol{a}$，我们必须计算矩阵 $M$ 的逆。$M$ 的行列式是 $\\det(M) = 1(1-0) - 0(1-0) + 1(1-0) = 2$。\n逆矩阵 $M^{-1}$ 由 $\\frac{1}{\\det(M)}\\text{adj}(M)$ 给出。伴随矩阵是代数余子式矩阵的转置。\n代数余子式矩阵为：\n$$\nC = \\begin{pmatrix}\n\\begin{vmatrix} 1  0 \\\\ 1  1 \\end{vmatrix}  -\\begin{vmatrix} 1  0 \\\\ 0  1 \\end{vmatrix}  \\begin{vmatrix} 1  1 \\\\ 0  1 \\end{vmatrix} \\\\\n-\\begin{vmatrix} 0  1 \\\\ 1  1 \\end{vmatrix}  \\begin{vmatrix} 1  1 \\\\ 0  1 \\end{vmatrix}  -\\begin{vmatrix} 1  0 \\\\ 0  1 \\end{vmatrix} \\\\\n\\begin{vmatrix} 0  1 \\\\ 1  0 \\end{vmatrix}  -\\begin{vmatrix} 1  1 \\\\ 1  0 \\end{vmatrix}  \\begin{vmatrix} 1  0 \\\\ 1  1 \\end{vmatrix}\n\\end{pmatrix}\n= \\begin{pmatrix} 1  -1  1 \\\\ 1  1  -1 \\\\ -1  1  1 \\end{pmatrix}\n$$\n伴随矩阵是 $\\text{adj}(M) = C^\\top = \\begin{pmatrix} 1  1  -1 \\\\ -1  1  1 \\\\ 1  -1  1 \\end{pmatrix}$。\n因此，逆矩阵是：\n$$\nM^{-1} = \\frac{1}{2} \\begin{pmatrix} 1  1  -1 \\\\ -1  1  1 \\\\ 1  -1  1 \\end{pmatrix}\n$$\n系数 $\\boldsymbol{a}$ 通过 $\\boldsymbol{a} = M^{-1} \\boldsymbol{u}$ 求得：\n$$\n\\begin{pmatrix} a_1 \\\\ a_2 \\\\ a_3 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1  1  -1 \\\\ -1  1  1 \\\\ 1  -1  1 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} u_1 + u_2 - u_3 \\\\ -u_1 + u_2 + u_3 \\\\ u_1 - u_2 + u_3 \\end{pmatrix}\n$$\n这提供了 $a_1, a_2,$ 和 $a_3$ 的显式表达式。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}(u_1 + u_2 - u_3)  \\frac{1}{2}(-u_1 + u_2 + u_3)  \\frac{1}{2}(u_1 - u_2 + u_3)\n\\end{pmatrix}\n}\n$$", "id": "2586154"}, {"introduction": "现在，我们将从更根本的层面来审视这些性质，并将其推广到三维空间。这个练习要求你从第一性原理出发，即从“精确再现线性场”这一目标，反向推导出形函数必须满足的条件。通过在一个四面体上完成这个推导和构造，你将看到单位分解和线性再现性质的普适性及其对单元性能的决定性作用。[@problem_id:2586166]", "problem": "考虑一个用于在有限元法 (FEM) 中近似标量场的单个四节点四面体有限元。设物理四面体的顶点位于已知位置 $\\boldsymbol{X}_{1}, \\boldsymbol{X}_{2}, \\boldsymbol{X}_{3}, \\boldsymbol{X}_{4} \\in \\mathbb{R}^{3}$，且单元近似具有节点形式 $u_{h}(\\boldsymbol{x})=\\sum_{i=1}^{4} N_{i}(\\boldsymbol{x})\\,u_{i}$，其中 $N_{i}(\\boldsymbol{x})$ 是形函数，$u_{i}$ 是节点值。要求该单元能够精确再现任何常数场和任何线性（仿射）场，具体含义如下：如果 $u(\\boldsymbol{x})=a+\\boldsymbol{b}^{\\mathsf{T}}\\boldsymbol{x}$（其中 $a\\in\\mathbb{R}$ 为常数，$\\boldsymbol{b}\\in\\mathbb{R}^{3}$ 为向量），并且节点值取为 $u_{i}=u(\\boldsymbol{X}_{i})$，那么对于四面体内的所有 $\\boldsymbol{x}$，都有 $u_{h}(\\boldsymbol{x})\\equiv u(\\boldsymbol{x})$。\n\n1) 从插值假设 $u_{h}(\\boldsymbol{x})=\\sum_{i=1}^{4} N_{i}(\\boldsymbol{x})\\,u_{i}$ 和对任意 $a$ 和 $\\boldsymbol{b}$ 都能再现所有常数场和线性场 $u(\\boldsymbol{x})=a+\\boldsymbol{b}^{\\mathsf{T}}\\boldsymbol{x}$ 的要求出发，推导出一组施加于形函数 $N_{i}(\\boldsymbol{x})$ 上的最小必要且充分的函数约束，以确保对每个此类场的精确再现。您的推导必须明确说明为什么需要每个约束，并且不得预先假设 $N_{i}(\\boldsymbol{x})$ 的任何特定参数形式。\n\n2) 现在，特化到顶点为\n$$\n\\boldsymbol{X}_{1}=(0,0,0),\\quad \\boldsymbol{X}_{2}=(2,0,0),\\quad \\boldsymbol{X}_{3}=(0,3,0),\\quad \\boldsymbol{X}_{4}=(0,0,4).\n$$\n的四面体。在节点上施加克罗内克-德尔塔性质 $N_{i}(\\boldsymbol{X}_{j})=\\delta_{ij}$，并将注意力限制在 $\\mathbb{R}^{3}$ 上的仿射（一次）形函数上。构造一组满足第 (1) 部分约束的显式形函数 $N_{1}(\\boldsymbol{x}),\\dots,N_{4}(\\boldsymbol{x})$。直接验证您构造的函数在此四面体上同时满足单位分解和线性再现条件。\n\n3) 对于同一四面体和您在第 (2) 部分中得到的显式形函数，在点 $\\boldsymbol{x}^{\\ast}=\\bigl(\\tfrac{2}{5},\\,\\tfrac{3}{5},\\,\\tfrac{4}{5}\\bigr)$ 处计算标量值\n$$\nS \\;=\\; \\sum_{i=1}^{4} \\bigl(N_{i}(\\boldsymbol{x}^{\\ast})\\bigr)^{2}\n$$\n。将您计算出的 $S$ 的最终答案表示为一个精确分数。无需四舍五入。", "solution": "问题陈述已经过审查，并被确定为有效。这是一个在计算力学领域，特别是有限元法领域中，适定的、有科学依据的问题。它没有任何科学、逻辑或事实上的缺陷。我们可以开始解答。\n\n该问题由三部分组成。我们将按顺序解答。\n\n第 1 部分：形函数的函数约束推导。\n\n基本要求是有限元近似 $u_{h}(\\boldsymbol{x})$ 必须能精确再现任何线性（仿射）标量场 $u(\\boldsymbol{x})$。近似由下式给出：\n$$u_{h}(\\boldsymbol{x})=\\sum_{i=1}^{4} N_{i}(\\boldsymbol{x})\\,u_{i}$$\n其中 $u_i$ 是场在单元节点 $\\boldsymbol{X}_i$ 处的值。需要再现的场是\n$$u(\\boldsymbol{x})=a+\\boldsymbol{b}^{\\mathsf{T}}\\boldsymbol{x}$$\n其中 $a\\in\\mathbb{R}$ 是任意标量常数，$\\boldsymbol{b}\\in\\mathbb{R}^{3}$ 是任意常数向量。节点值被设置为该场在节点处的精确值：\n$$u_{i} = u(\\boldsymbol{X}_{i}) = a+\\boldsymbol{b}^{\\mathsf{T}}\\boldsymbol{X}_{i}$$\n精确再现的条件是对于单元内的所有 $\\boldsymbol{x}$，$u_{h}(\\boldsymbol{x}) \\equiv u(\\boldsymbol{x})$。将 $u_{h}(\\boldsymbol{x})$、$u(\\boldsymbol{x})$ 和 $u_i$ 的表达式代入此恒等式，我们得到：\n$$a+\\boldsymbol{b}^{\\mathsf{T}}\\boldsymbol{x} = \\sum_{i=1}^{4} N_{i}(\\boldsymbol{x}) (a+\\boldsymbol{b}^{\\mathsf{T}}\\boldsymbol{X}_{i})$$\n我们可以将右侧求和项中的各项展开：\n$$a+\\boldsymbol{b}^{\\mathsf{T}}\\boldsymbol{x} = \\sum_{i=1}^{4} a N_{i}(\\boldsymbol{x}) + \\sum_{i=1}^{4} N_{i}(\\boldsymbol{x}) (\\boldsymbol{b}^{\\mathsf{T}}\\boldsymbol{X}_{i})$$\n将常数 $a$ 和 $\\boldsymbol{b}^{\\mathsf{T}}$ 提取出来：\n$$a+\\boldsymbol{b}^{\\mathsf{T}}\\boldsymbol{x} = a \\left(\\sum_{i=1}^{4} N_{i}(\\boldsymbol{x})\\right) + \\boldsymbol{b}^{\\mathsf{T}} \\left(\\sum_{i=1}^{4} N_{i}(\\boldsymbol{x}) \\boldsymbol{X}_{i}\\right)$$\n这个恒等式必须对任意选择的 $a\\in\\mathbb{R}$ 和 $\\boldsymbol{b}\\in\\mathbb{R}^{3}$ 都成立。这使我们能够通过考虑 $a$ 和 $\\boldsymbol{b}$ 的特定选择来推导形函数 $N_i(\\boldsymbol{x})$ 的约束。\n\n首先，考虑常数场的情况。这对应于设 $\\boldsymbol{b}=\\boldsymbol{0}$ 并让 $a$ 为任意非零常数。该恒等式简化为：\n$$a = a \\left(\\sum_{i=1}^{4} N_{i}(\\boldsymbol{x})\\right)$$\n由于这对任何 $a$ 都必须成立，特别是对于 $a\\neq 0$，我们可以将两边同除以 $a$。这就得到了第一个必要条件：\n$$ \\sum_{i=1}^{4} N_{i}(\\boldsymbol{x}) = 1 $$\n这是**单位分解**性质。它确保了对常数场的精确再现。\n\n接下来，考虑纯线性场的情况。这对应于设 $a=0$ 并让 $\\boldsymbol{b}$ 为任意非零向量。该恒等式变为：\n$$\\boldsymbol{b}^{\\mathsf{T}}\\boldsymbol{x} = \\boldsymbol{b}^{\\mathsf{T}} \\left(\\sum_{i=1}^{4} N_{i}(\\boldsymbol{x}) \\boldsymbol{X}_{i}\\right)$$\n这可以重新排列为：\n$$\\boldsymbol{b}^{\\mathsf{T}} \\left(\\boldsymbol{x} - \\sum_{i=1}^{4} N_{i}(\\boldsymbol{x}) \\boldsymbol{X}_{i}\\right) = 0$$\n此方程必须对任意向量 $\\boldsymbol{b} \\in \\mathbb{R}^{3}$ 成立。如果一个向量 $\\boldsymbol{v} = \\boldsymbol{x} - \\sum_{i=1}^{4} N_{i}(\\boldsymbol{x}) \\boldsymbol{X}_{i}$ 与任意向量 $\\boldsymbol{b}$ 的点积为零，那么向量 $\\boldsymbol{v}$ 必须是零向量。因此，我们得到第二个必要条件：\n$$ \\sum_{i=1}^{4} N_{i}(\\boldsymbol{x}) \\boldsymbol{X}_{i} = \\boldsymbol{x} $$\n这是**线性场再现**性质。\n\n这两个条件也是充分的。如果它们被满足，主恒等式对所有的 $a$ 和 $\\boldsymbol{b}$ 都成立。因此，对形函数的最小必要且充分的函数约束集是：\n1. $\\sum_{i=1}^{4} N_{i}(\\boldsymbol{x}) = 1$ (单位分解)\n2. $\\sum_{i=1}^{4} N_{i}(\\boldsymbol{x}) \\boldsymbol{X}_{i} = \\boldsymbol{x}$ (线性再现)\n\n第 2 部分：特定形函数的构造和验证。\n\n给定一个四面体，其顶点为：\n$\\boldsymbol{X}_{1}=(0,0,0)$, $\\boldsymbol{X}_{2}=(2,0,0)$, $\\boldsymbol{X}_{3}=(0,3,0)$, $\\boldsymbol{X}_{4}=(0,0,4)$。\n我们寻求形式为 $N_{i}(\\boldsymbol{x}) = c_{i0} + c_{i1}x + c_{i2}y + c_{i3}z$ 的仿射形函数 $N_{i}(\\boldsymbol{x})$，它们满足克罗内克-德尔塔性质 $N_{i}(\\boldsymbol{X}_{j})=\\delta_{ij}$。此性质为每个形函数的四个系数提供了一个由四个线性方程组成的方程组。\n\n对于 $N_{1}(\\boldsymbol{x})$：\n$N_{1}(\\boldsymbol{X}_{1}) = c_{10} = 1$\n$N_{1}(\\boldsymbol{X}_{2}) = c_{10} + 2c_{11} = 0 \\implies 1 + 2c_{11}=0 \\implies c_{11}=-1/2$\n$N_{1}(\\boldsymbol{X}_{3}) = c_{10} + 3c_{12} = 0 \\implies 1 + 3c_{12}=0 \\implies c_{12}=-1/3$\n$N_{1}(\\boldsymbol{X}_{4}) = c_{10} + 4c_{13} = 0 \\implies 1 + 4c_{13}=0 \\implies c_{13}=-1/4$\n因此，$N_{1}(\\boldsymbol{x}) = 1 - \\frac{x}{2} - \\frac{y}{3} - \\frac{z}{4}$。\n\n对于 $N_{2}(\\boldsymbol{x})$：\n$N_{2}(\\boldsymbol{X}_{1}) = c_{20} = 0$\n$N_{2}(\\boldsymbol{X}_{2}) = c_{20} + 2c_{21} = 1 \\implies 2c_{21}=1 \\implies c_{21}=1/2$\n$N_{2}(\\boldsymbol{X}_{3}) = c_{20} + 3c_{22} = 0 \\implies 3c_{22}=0 \\implies c_{22}=0$\n$N_{2}(\\boldsymbol{X}_{4}) = c_{20} + 4c_{23} = 0 \\implies 4c_{23}=0 \\implies c_{23}=0$\n因此，$N_{2}(\\boldsymbol{x}) = \\frac{x}{2}$。\n\n对于 $N_{3}(\\boldsymbol{x})$：\n$N_{3}(\\boldsymbol{X}_{1}) = c_{30} = 0$\n$N_{3}(\\boldsymbol{X}_{2}) = c_{30} + 2c_{31} = 0 \\implies c_{31}=0$\n$N_{3}(\\boldsymbol{X}_{3}) = c_{30} + 3c_{32} = 1 \\implies 3c_{32}=1 \\implies c_{32}=1/3$\n$N_{3}(\\boldsymbol{X}_{4}) = c_{30} + 4c_{33} = 0 \\implies c_{33}=0$\n因此，$N_{3}(\\boldsymbol{x}) = \\frac{y}{3}$。\n\n对于 $N_{4}(\\boldsymbol{x})$：\n$N_{4}(\\boldsymbol{X}_{1}) = c_{40} = 0$\n$N_{4}(\\boldsymbol{X}_{2}) = c_{40} + 2c_{41} = 0 \\implies c_{41}=0$\n$N_{4}(\\boldsymbol{X}_{3}) = c_{40} + 3c_{42} = 0 \\implies c_{42}=0$\n$N_{4}(\\boldsymbol{X}_{4}) = c_{40} + 4c_{43} = 1 \\implies 4c_{43}=1 \\implies c_{43}=1/4$\n因此，$N_{4}(\\boldsymbol{x}) = \\frac{z}{4}$。\n\n显式形函数为：\n$N_{1}(\\boldsymbol{x}) = 1 - \\frac{x}{2} - \\frac{y}{3} - \\frac{z}{4}$, $N_{2}(\\boldsymbol{x}) = \\frac{x}{2}$, $N_{3}(\\boldsymbol{x}) = \\frac{y}{3}$, $N_{4}(\\boldsymbol{x}) = \\frac{z}{4}$。\n\n现在我们验证它们是否满足第 1 部分的约束。\n验证单位分解：\n$$\\sum_{i=1}^{4} N_{i}(\\boldsymbol{x}) = \\left(1 - \\frac{x}{2} - \\frac{y}{3} - \\frac{z}{4}\\right) + \\left(\\frac{x}{2}\\right) + \\left(\\frac{y}{3}\\right) + \\left(\\frac{z}{4}\\right) = 1$$\n该条件满足。\n\n验证线性再现：\n$$\\sum_{i=1}^{4} N_{i}(\\boldsymbol{x})\\boldsymbol{X}_{i} = N_{1}(\\boldsymbol{x})\\boldsymbol{X}_{1} + N_{2}(\\boldsymbol{x})\\boldsymbol{X}_{2} + N_{3}(\\boldsymbol{x})\\boldsymbol{X}_{3} + N_{4}(\\boldsymbol{x})\\boldsymbol{X}_{4}$$\n由于 $\\boldsymbol{X}_{1}=(0,0,0)$，第一项为零。\n$$ \\sum_{i=1}^{4} N_{i}(\\boldsymbol{x})\\boldsymbol{X}_{i} = \\left(\\frac{x}{2}\\right)\\begin{pmatrix} 2 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\left(\\frac{y}{3}\\right)\\begin{pmatrix} 0 \\\\ 3 \\\\ 0 \\end{pmatrix} + \\left(\\frac{z}{4}\\right)\\begin{pmatrix} 0 \\\\ 0 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} x \\\\ 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ y \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ z \\end{pmatrix} = \\begin{pmatrix} x \\\\ y \\\\ z \\end{pmatrix} = \\boldsymbol{x} $$\n该条件满足。所构造的形函数是正确的。\n\n第 3 部分：计算一个标量值。\n\n我们必须在点 $\\boldsymbol{x}^{\\ast}=\\bigl(\\frac{2}{5},\\,\\frac{3}{5},\\,\\frac{4}{5}\\bigr)$ 处计算 $S = \\sum_{i=1}^{4} \\bigl(N_{i}(\\boldsymbol{x}^{\\ast})\\bigr)^{2}$。\n设 $x^{\\ast}=\\frac{2}{5}$，$y^{\\ast}=\\frac{3}{5}$ 和 $z^{\\ast}=\\frac{4}{5}$。我们将这些坐标代入形函数中。\n$N_{1}(\\boldsymbol{x}^{\\ast}) = 1 - \\frac{x^{\\ast}}{2} - \\frac{y^{\\ast}}{3} - \\frac{z^{\\ast}}{4} = 1 - \\frac{2/5}{2} - \\frac{3/5}{3} - \\frac{4/5}{4} = 1 - \\frac{1}{5} - \\frac{1}{5} - \\frac{1}{5} = 1 - \\frac{3}{5} = \\frac{2}{5}$。\n$N_{2}(\\boldsymbol{x}^{\\ast}) = \\frac{x^{\\ast}}{2} = \\frac{2/5}{2} = \\frac{1}{5}$。\n$N_{3}(\\boldsymbol{x}^{\\ast}) = \\frac{y^{\\ast}}{3} = \\frac{3/5}{3} = \\frac{1}{5}$。\n$N_{4}(\\boldsymbol{x}^{\\ast}) = \\frac{z^{\\ast}}{4} = \\frac{4/5}{4} = \\frac{1}{5}$。\n\n现在我们计算平方和：\n$$ S = \\left(\\frac{2}{5}\\right)^{2} + \\left(\\frac{1}{5}\\right)^{2} + \\left(\\frac{1}{5}\\right)^{2} + \\left(\\frac{1}{5}\\right)^{2} $$\n$$ S = \\frac{4}{25} + \\frac{1}{25} + \\frac{1}{25} + \\frac{1}{25} = \\frac{4+1+1+1}{25} = \\frac{7}{25} $$\n标量值 $S$ 的值为 $\\frac{7}{25}$。", "answer": "$$\\boxed{\\frac{7}{25}}$$", "id": "2586166"}]}