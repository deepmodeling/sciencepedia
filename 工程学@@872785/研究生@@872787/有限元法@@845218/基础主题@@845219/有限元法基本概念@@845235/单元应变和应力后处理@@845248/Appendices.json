{"hands_on_practices": [{"introduction": "本练习是理解应力后处理的基础。它将引导您完成一个核心过程：将有限元求解得到的原始节点位移数据，转化为一个线性三角形单元内的常数应变和应力张量。通过这个练习，您将巩固对运动学关系和本构关系等核心概念的理解。[@problem_id:2554896]", "problem": "在有限元法 (FEM) 中使用的一个二维线性三角形单元中，考虑一个三角形上的分段线性位移场，其节点坐标为 $\\left(x_1,y_1\\right) = \\left(0,0\\right)$，$\\left(x_2,y_2\\right) = \\left(2,0\\right)$ 和 $\\left(x_3,y_3\\right) = \\left(0,1\\right)$。节点位移分量 $\\left(u_i,v_i\\right)$ 如下：节点 $1$：$\\left(u_1,v_1\\right) = \\left(0,0\\right)$，节点 $2$：$\\left(u_2,v_2\\right) = \\left(0.2,0.1\\right)$，节点 $3$：$\\left(u_3,v_3\\right) = \\left(0.02,0.08\\right)$，其中 $u$ 是 $x$ 方向的位移，$v$ 是 $y$ 方向的位移。假设小应变运动学和平面应力条件下的各向同性、均质材料，其杨氏模量 $E = 30\\,\\text{GPa}$，泊松比 $\\nu = 0.25$。\n\n仅使用基本定义（单元上的线性形函数插值和基于位移梯度的小应变张量定义），首先计算该单元的常数应变张量 $\\boldsymbol{\\varepsilon}$，然后推导出该单元在三维意义下的 Cauchy 应力张量的偏量部分 $\\text{dev}(\\boldsymbol{\\sigma})$。从以下选项中选择正确的 $\\text{dev}(\\boldsymbol{\\sigma})$（单位为 $\\text{GPa}$）。\n\nA. $\\displaystyle \\begin{bmatrix} 1.44  0.84  0 \\\\ 0.84  0.96  0 \\\\ 0  0  -2.40 \\end{bmatrix}$\n\nB. $\\displaystyle \\begin{bmatrix} 0.24  0.84  0 \\\\ 0.84  -0.24  0 \\\\ 0  0  0 \\end{bmatrix}$\n\nC. $\\displaystyle \\begin{bmatrix} 0.96  0.84  0 \\\\ 0.84  0.48  0 \\\\ 0  0  -1.44 \\end{bmatrix}$\n\nD. $\\displaystyle \\begin{bmatrix} 1.44  0.42  0 \\\\ 0.42  0.96  0 \\\\ 0  0  -2.40 \\end{bmatrix}$", "solution": "问题陈述已经过验证，并且是合理的。在线性弹性和有限元方法的框架内，这是一个适定问题。所有必要的信息都已提供且内部一致。\n\n任务是确定一个二维线性三角形单元的 Cauchy 应力张量的偏量部分 $\\text{dev}(\\boldsymbol{\\sigma})$。我们将按照要求，通过一系列源于第一性原理的步骤来完成。\n\n首先，我们确定单元上的位移场。对于一个线性三角形单元，位移分量 $u(x,y)$ 和 $v(x,y)$ 是坐标 $x$ 和 $y$ 的线性函数：\n$$ u(x,y) = a_1 + a_2 x + a_3 y $$\n$$ v(x,y) = b_1 + b_2 x + b_3 y $$\n系数 $a_i$ 和 $b_i$ 通过施加单元节点处的位移值来确定。\n节点坐标：$(x_1,y_1) = (0,0)$; $(x_2,y_2) = (2,0)$; $(x_3,y_3) = (0,1)$。\n节点位移：$(u_1,v_1) = (0,0)$; $(u_2,v_2) = (0.2,0.1)$; $(u_3,v_3) = (0.02,0.08)$。\n\n对于 $u$-位移：\n在节点 $1$ 处：$u_1 = u(0,0) = a_1 = 0$。\n在节点 $2$ 处：$u_2 = u(2,0) = a_1 + a_2(2) + a_3(0) = 2a_2 = 0.2 \\implies a_2 = 0.1$。\n在节点 $3$ 处：$u_3 = u(0,1) = a_1 + a_2(0) + a_3(1) = a_3 = 0.02$。\n所以，$u(x,y) = 0.1x + 0.02y$。\n\n对于 $v$-位移：\n在节点 $1$ 处：$v_1 = v(0,0) = b_1 = 0$。\n在节点 $2$ 处：$v_2 = v(2,0) = b_1 + b_2(2) + b_3(0) = 2b_2 = 0.1 \\implies b_2 = 0.05$。\n在节点 $3$ 处：$v_3 = v(0,1) = b_1 + b_2(0) + b_3(1) = b_3 = 0.08$。\n所以，$v(x,y) = 0.05x + 0.08y$。\n\n第二，我们使用小应变定义来计算应变张量 $\\boldsymbol{\\varepsilon}$ 的分量。由于位移场是线性的，所以整个单元内的应变将是常数。\n$$ \\varepsilon_{xx} = \\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x}(0.1x + 0.02y) = 0.1 $$\n$$ \\varepsilon_{yy} = \\frac{\\partial v}{\\partial y} = \\frac{\\partial}{\\partial y}(0.05x + 0.08y) = 0.08 $$\n$$ \\varepsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}\\right) = \\frac{1}{2}\\left(\\frac{\\partial}{\\partial y}(0.1x + 0.02y) + \\frac{\\partial}{\\partial x}(0.05x + 0.08y)\\right) = \\frac{1}{2}(0.02 + 0.05) = 0.035 $$\n在 $xy$-平面内的应变张量为：\n$$ \\boldsymbol{\\varepsilon}_{\\text{2D}} = \\begin{bmatrix} 0.1  0.035 \\\\ 0.035  0.08 \\end{bmatrix} $$\n\n第三，我们使用平面应力条件下的线性各向同性本构律来计算应力张量 $\\boldsymbol{\\sigma}$。材料属性为杨氏模量 $E = 30\\,\\text{GPa}$ 和泊松比 $\\nu = 0.25$。\n平面应力的应力-应变关系为：\n$$ \\sigma_{xx} = \\frac{E}{1-\\nu^2}(\\varepsilon_{xx} + \\nu\\varepsilon_{yy}) $$\n$$ \\sigma_{yy} = \\frac{E}{1-\\nu^2}(\\varepsilon_{yy} + \\nu\\varepsilon_{xx}) $$\n$$ \\sigma_{xy} = G \\gamma_{xy} = \\frac{E}{2(1+\\nu)}(2\\varepsilon_{xy}) $$\n让我们计算这些常数：\n$$ \\frac{E}{1-\\nu^2} = \\frac{30\\,\\text{GPa}}{1 - (0.25)^2} = \\frac{30}{1 - 0.0625} = \\frac{30}{0.9375} = 32\\,\\text{GPa} $$\n$$ G = \\frac{E}{2(1+\\nu)} = \\frac{30\\,\\text{GPa}}{2(1+0.25)} = \\frac{30}{2.5} = 12\\,\\text{GPa} $$\n现在我们计算应力：\n$$ \\sigma_{xx} = 32 \\times (0.1 + 0.25 \\times 0.08) = 32 \\times (0.1 + 0.02) = 32 \\times 0.12 = 3.84\\,\\text{GPa} $$\n$$ \\sigma_{yy} = 32 \\times (0.08 + 0.25 \\times 0.1) = 32 \\times (0.08 + 0.025) = 32 \\times 0.105 = 3.36\\,\\text{GPa} $$\n$$ \\sigma_{xy} = 12 \\times (2 \\times 0.035) = 12 \\times 0.07 = 0.84\\,\\text{GPa} $$\n在平面应力条件下，$\\sigma_{zz} = \\sigma_{xz} = \\sigma_{yz} = 0$。完整的三维应力张量为：\n$$ \\boldsymbol{\\sigma} = \\begin{bmatrix} 3.84  0.84  0 \\\\ 0.84  3.36  0 \\\\ 0  0  0 \\end{bmatrix} \\text{ GPa} $$\n\n第四，我们推导应力张量的偏量部分 $\\text{dev}(\\boldsymbol{\\sigma})$。偏应力张量 $\\mathbf{s}$ 定义为 $\\mathbf{s} = \\boldsymbol{\\sigma} - \\sigma_m \\mathbf{I}$，其中 $\\sigma_m$ 是平均（静水）应力，$\\mathbf{I}$ 是 $3 \\times 3$ 单位矩阵。\n平均应力是应力张量的迹除以 $3$：\n$$ \\sigma_m = \\frac{1}{3}(\\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz}) = \\frac{1}{3}(3.84 + 3.36 + 0) = \\frac{7.20}{3} = 2.40\\,\\text{GPa} $$\n现在我们计算偏应力张量的分量：\n$$ s_{xx} = \\sigma_{xx} - \\sigma_m = 3.84 - 2.40 = 1.44\\,\\text{GPa} $$\n$$ s_{yy} = \\sigma_{yy} - \\sigma_m = 3.36 - 2.40 = 0.96\\,\\text{GPa} $$\n$$ s_{zz} = \\sigma_{zz} - \\sigma_m = 0 - 2.40 = -2.40\\,\\text{GPa} $$\n$$ s_{xy} = \\sigma_{xy} = 0.84\\,\\text{GPa} $$\n$$ s_{xz} = \\sigma_{xz} = 0\\,\\text{GPa} $$\n$$ s_{yz} = \\sigma_{yz} = 0\\,\\text{GPa} $$\n因此，偏应力张量为：\n$$ \\text{dev}(\\boldsymbol{\\sigma}) = \\begin{bmatrix} 1.44  0.84  0 \\\\ 0.84  0.96  0 \\\\ 0  0  -2.40 \\end{bmatrix} \\text{ GPa} $$\n\n最后，我们评估所提供的选项。\n\nA. $\\displaystyle \\begin{bmatrix} 1.44  0.84  0 \\\\ 0.84  0.96  0 \\\\ 0  0  -2.40 \\end{bmatrix}$\n该矩阵与我们计算出的偏应力张量逐分量匹配。\n结论：**正确**。\n\nB. $\\displaystyle \\begin{bmatrix} 0.24  0.84  0 \\\\ 0.84  -0.24  0 \\\\ 0  0  0 \\end{bmatrix}$\n对角分量（$s_{xx}$，$s_{yy}$，$s_{zz}$）不正确。要成为一个偏量张量，其迹必须为零。$0.24 + (-0.24) + 0 = 0$。虽然它是一个偏量张量，但它不是与计算出的应力状态相对应的那个。分量 $s_{zz}=0$ 意味着 $\\sigma_m = \\sigma_{zz} = 0$，这对于本问题是不成立的。\n结论：**不正确**。\n\nC. $\\displaystyle \\begin{bmatrix} 0.96  0.84  0 \\\\ 0.84  0.48  0 \\\\ 0  0  -1.44 \\end{bmatrix}$\n对角分量不正确。其迹为 $0.96 + 0.48 - 1.44 = 0$，所以它是一个偏量张量。但是，如果 $s_{xx} = 0.96$，则 $\\sigma_m = \\sigma_{xx} - s_{xx} = 3.84 - 0.96 = 2.88\\,\\text{GPa}$。如果这是正确的，那么 $s_{yy}$ 将是 $\\sigma_{yy} - \\sigma_m = 3.36 - 2.88 = 0.48\\,\\text{GPa}$（与选项匹配），但 $s_{zz}$ 将是 $\\sigma_{zz} - \\sigma_m = 0 - 2.88 = -2.88\\,\\text{GPa}$，这与选项中提供的 $-1.44\\,\\text{GPa}$ 不匹配。因此，该矩阵是不一致的。\n结论：**不正确**。\n\nD. $\\displaystyle \\begin{bmatrix} 1.44  0.42  0 \\\\ 0.42  0.96  0 \\\\ 0  0  -2.40 \\end{bmatrix}$\n非对角分量 $s_{xy}$ 不正确。值 $0.42$ 正好是正确值 $0.84$ 的一半。这个错误源于将剪应力错误地计算为 $\\sigma_{xy} = G \\varepsilon_{xy}$，而不是正确的 $\\sigma_{xy} = G \\gamma_{xy} = 2G\\varepsilon_{xy}$。具体来说，$12 \\times 0.035 = 0.42$。对角分量与我们的计算相符，这表明平均应力是根据一个除了剪切分量外其他都正确的应力张量计算出来的。\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2554896"}, {"introduction": "有限元求解器直接输出的是单元内部（例如，高斯点）的应力，但在工程可视化和失效分析中，我们往往需要更精确的节点应力。本练习介绍了一种功能强大的实用技术——超收敛片修复(Superconvergent Patch Recovery, SPR)。您将学习如何利用一组高精度的高斯点应力数据，通过多项式拟合来构建一个更平滑、更准确的应力场，并最终得到目标节点的应力值。[@problem_id:2554876]", "problem": "在有限元法（FEM）中，采用应力片恢复法（patch recovery procedure）进行应力后处理。考虑一个二维小应变线性弹性分析，其中一个节点位于原点 $(x,y)=(0,0)$。在该节点周围的一个单元片中，给出了以下六个高斯点在全局坐标系下的位置以及对应的计算出的柯西正应力分量 $\\sigma_{xx}$（单位一致，为简洁起见已省略）：\n- $(x,y)=(1,0)$，$\\sigma_{xx}=6$，\n- $(x,y)=(-1,0)$，$\\sigma_{xx}=0$，\n- $(x,y)=(0,1)$，$\\sigma_{xx}=0$，\n- $(x,y)=(0,-1)$，$\\sigma_{xx}=2$，\n- $(x,y)=(1,1)$，$\\sigma_{xx}=6$，\n- $(x,y)=(-1,1)$，$\\sigma_{xx}=-4$。\n\n假设在该节点的邻域内，$\\sigma_{xx}(x,y)$ 可以用以下形式的二次多项式很好地近似\n$$\n\\sigma_{xx}(x,y)\\approx a_0 + a_1 x + a_2 y + a_3 x^2 + a_4 x y + a_5 y^2,\n$$\n其中系数向量为 $\\mathbf{a}=[a_0,\\;a_1,\\;a_2,\\;a_3,\\;a_4,\\;a_5]^T$。使用给定的高斯点数据进行非加权最小二乘拟合，确定恢复的系数 $\\mathbf{a}$ 并计算节点处的恢复节点应力 $\\sigma_{xx}$，即在 $(x,y)=(0,0)$ 处的值。\n\n选择正确的选项：\n\nA. $\\mathbf{a}=[\\,2,\\;3,\\;-1,\\;1,\\;2,\\;-1\\,]^T$，节点 $\\sigma_{xx}=2$。\n\nB. $\\mathbf{a}=[\\,3,\\;3,\\;-3,\\;0,\\;0,\\;0\\,]^T$，节点 $\\sigma_{xx}=3$。\n\nC. $\\mathbf{a}=[\\,2,\\;3,\\;-1,\\;1,\\;0,\\;-1\\,]^T$，节点 $\\sigma_{xx}=2$。\n\nD. $\\mathbf{a}=[\\,2,\\;3,\\;-1,\\;0,\\;2,\\;-1\\,]^T$，节点 $\\sigma_{xx}=2$。", "solution": "首先将验证问题陈述的科学性和逻辑完整性。\n\n**步骤 1：提取已知条件**\n\n给定的信息如下：\n- 一个二维小应变线性弹性分析中的应力片恢复法。\n- 目标节点位于原点，坐标为 $(x,y)=(0,0)$。\n- 提供了六组高斯点的位置和应力数据对：\n    1. 在 $(x,y)=(1,0)$ 处，应力为 $\\sigma_{xx}=6$。\n    2. 在 $(x,y)=(-1,0)$ 处，应力为 $\\sigma_{xx}=0$。\n    3. 在 $(x,y)=(0,1)$ 处，应力为 $\\sigma_{xx}=0$。\n    4. 在 $(x,y)=(0,-1)$ 处，应力为 $\\sigma_{xx}=2$。\n    5. 在 $(x,y)=(1,1)$ 处，应力为 $\\sigma_{xx}=6$。\n    6. 在 $(x,y)=(-1,1)$ 处，应力为 $\\sigma_{xx}=-4$。\n- 应力场 $\\sigma_{xx}(x,y)$ 由一个二次多项式近似：\n$$\n\\sigma_{xx}(x,y)\\approx a_0 + a_1 x + a_2 y + a_3 x^2 + a_4 x y + a_5 y^2\n$$\n- 系数 $\\mathbf{a}=[a_0, a_1, a_2, a_3, a_4, a_5]^T$ 将使用非加权最小二乘拟合来确定。\n- 目标是求解向量 $\\mathbf{a}$ 和在 $(x,y)=(0,0)$ 处的恢复节点应力 $\\sigma_{xx}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n该问题具有科学依据。应力片恢复法，特别是 Zienkiewicz-Zhu 超收敛片恢复法，是有限元法中一种标准且广泛使用的后处理技术，用于获得更准确的应力值，尤其是在节点处。该方法的核心在于，对单元片内高斯点上的超收敛应力值进行多项式拟合，然后利用该多项式插值得到节点处的应力。\n\n该问题是适定的。它提供了六个数据点，并要求确定一个多项式展开的六个未知系数。这导出一个线性代数方程组。所提供的数据足以构建该方程组。问题是客观的，并以数学精度陈述，不含任何歧义或事实错误。这是计算力学背景下数值分析的一个标准应用。\n\n**步骤 3：结论与行动**\n\n问题有效。继续进行求解。\n\n**求解推导**\n\n目标是找到多项式近似\n$$\n\\sigma_{xx}(x,y) = a_0 + a_1 x + a_2 y + a_3 x^2 + a_4 xy + a_5 y^2\n$$\n的系数 $\\mathbf{a} = [a_0, a_1, a_2, a_3, a_4, a_5]^T$，使得该多项式在最小二乘意义下最佳拟合给定数据。非加权最小二乘法旨在最小化残差平方和 $S$：\n$$\nS = \\sum_{i=1}^{6} \\left( (a_0 + a_1 x_i + a_2 y_i + a_3 x_i^2 + a_4 x_i y_i + a_5 y_i^2) - (\\sigma_{xx})_i \\right)^2\n$$\n取最小值的必要条件是 $\\frac{\\partial S}{\\partial a_j} = 0$ 对 $j=0, 1, \\dots, 5$ 成立。这导出一个线性方程组 $\\mathbf{H}^T \\mathbf{H} \\mathbf{a} = \\mathbf{H}^T \\mathbf{b}$，其中 $\\mathbf{H}$ 是设计矩阵，$\\mathbf{b}$ 是应力值向量。\n\n在这个具体问题中，数据点的数量（$N=6$）等于未知系数的数量（$6$）。因此，矩阵 $\\mathbf{H}$ 是一个方阵，最小二乘问题简化为求解线性系统 $\\mathbf{H} \\mathbf{a} = \\mathbf{b}$，前提是 $\\mathbf{H}$ 可逆。\n\n我们将每个数据点代入多项式来构建方程组：\n1. $(x,y)=(1,0), \\sigma_{xx}=6$：$a_0 + a_1(1) + a_2(0) + a_3(1)^2 + a_4(1)(0) + a_5(0)^2 = a_0 + a_1 + a_3 = 6$\n2. $(x,y)=(-1,0), \\sigma_{xx}=0$：$a_0 + a_1(-1) + a_2(0) + a_3(-1)^2 + a_4(-1)(0) + a_5(0)^2 = a_0 - a_1 + a_3 = 0$\n3. $(x,y)=(0,1), \\sigma_{xx}=0$：$a_0 + a_1(0) + a_2(1) + a_3(0)^2 + a_4(0)(1) + a_5(1)^2 = a_0 + a_2 + a_5 = 0$\n4. $(x,y)=(0,-1), \\sigma_{xx}=2$：$a_0 + a_1(0) + a_2(-1) + a_3(0)^2 + a_4(0)(-1) + a_5(-1)^2 = a_0 - a_2 + a_5 = 2$\n5. $(x,y)=(1,1), \\sigma_{xx}=6$：$a_0 + a_1(1) + a_2(1) + a_3(1)^2 + a_4(1)(1) + a_5(1)^2 = a_0 + a_1 + a_2 + a_3 + a_4 + a_5 = 6$\n6. $(x,y)=(-1,1), \\sigma_{xx}=-4$：$a_0 + a_1(-1) + a_2(1) + a_3(-1)^2 + a_4(-1)(1) + a_5(1)^2 = a_0 - a_1 + a_2 + a_3 - a_4 + a_5 = -4$\n\n我们得到了一个包含六个未知数的六元线性方程组。\n由方程 (1) 和 (2) 可得：\n(1) $a_0 + a_1 + a_3 = 6$\n(2) $a_0 - a_1 + a_3 = 0$\n将 (1) 和 (2) 相加：$2a_0 + 2a_3 = 6 \\implies a_0 + a_3 = 3$。\n将 (1) 减去 (2)：$2a_1 = 6 \\implies a_1 = 3$。\n\n由方程 (3) 和 (4) 可得：\n(3) $a_0 + a_2 + a_5 = 0$\n(4) $a_0 - a_2 + a_5 = 2$\n将 (3) 和 (4) 相加：$2a_0 + 2a_5 = 2 \\implies a_0 + a_5 = 1$。\n将 (3) 减去 (4)：$2a_2 = -2 \\implies a_2 = -1$。\n\n现在我们得到 $a_1=3$ 和 $a_2=-1$。该方程组可以简化。根据我们推导出的关系：\n$a_3 = 3 - a_0$\n$a_5 = 1 - a_0$\n\n将这些已知值和表达式代入方程 (5) 和 (6)。\n使用方程 (5)：\n$6 = a_0 + a_1 + a_2 + a_3 + a_4 + a_5 = a_0 + (3) + (-1) + (3 - a_0) + a_4 + (1 - a_0)$\n$6 = (a_0 - a_0 - a_0) + (3 - 1 + 3 + 1) + a_4$\n$6 = -a_0 + 6 + a_4 \\implies -a_0 + a_4 = 0 \\implies a_4 = a_0$。\n\n使用方程 (6)：\n$-4 = a_0 - a_1 + a_2 + a_3 - a_4 + a_5 = a_0 - (3) + (-1) + (3 - a_0) - a_4 + (1 - a_0)$\n$-4 = (a_0 - a_0 - a_0) + (-3 - 1 + 3 + 1) - a_4$\n$-4 = -a_0 + 0 - a_4 \\implies -a_0 - a_4 = -4 \\implies a_0 + a_4 = 4$。\n\n现在我们得到一个关于 $a_0$ 和 $a_4$ 的简单方程组：\n$a_4 = a_0$\n$a_0 + a_4 = 4$\n将第一个方程代入第二个方程得到：$a_0 + a_0 = 4 \\implies 2a_0 = 4 \\implies a_0 = 2$。\n由此，我们求得 $a_4 = 2$。\n\n最后，我们确定余下的系数：\n$a_3 = 3 - a_0 = 3 - 2 = 1$。\n$a_5 = 1 - a_0 = 1 - 2 = -1$。\n\n完整的系数向量为 $\\mathbf{a} = [a_0, a_1, a_2, a_3, a_4, a_5]^T = [2, 3, -1, 1, 2, -1]^T$。\n\n在原点 $(x,y)=(0,0)$ 处的恢复节点应力可通过多项式计算：\n$\\sigma_{xx}(0,0) = a_0 + a_1(0) + a_2(0) + a_3(0)^2 + a_4(0)(0) + a_5(0)^2 = a_0$。\n因此，节点应力为 $\\sigma_{xx}(0,0) = 2$。\n\n**选项评估**\n\n- **A. $\\mathbf{a}=[\\,2,\\;3,\\;-1,\\;1,\\;2,\\;-1\\,]^T$，节点 $\\sigma_{xx}=2$。**\n计算出的系数向量为 $\\mathbf{a}=[2, 3, -1, 1, 2, -1]^T$，与此选项匹配。计算出的节点应力为 $\\sigma_{xx}(0,0) = a_0 = 2$，也相匹配。\n**结论：正确。**\n\n- **B. $\\mathbf{a}=[\\,3,\\;3,\\;-3,\\;0,\\;0,\\;0\\,]^T$，节点 $\\sigma_{xx}=3$。**\n系数向量不正确。例如，我们的计算得出 $a_0=2$，而不是 $a_0=3$，以及 $a_2=-1$，而不是 $a_2=-3$。节点应力为 $\\sigma_{xx}=a_0=3$，也是不正确的。如果我们将此向量代入方程 (4) 进行检验，$a_0 - a_2 + a_5 = 3 - (-3) + 0 = 6$，而结果应为 $2$。该选项无效。\n**结论：不正确。**\n\n- **C. $\\mathbf{a}=[\\,2,\\;3,\\;-1,\\;1,\\;0,\\;-1\\,]^T$，节点 $\\sigma_{xx}=2$。**\n该向量的 $a_4=0$，而我们的计算结果为 $a_4=2$。尽管 $a_0=2$ 与节点应力部分相符，但向量本身是不正确的。将此向量代入方程 (5) 进行检验：$a_0+a_1+a_2+a_3+a_4+a_5 = 2+3-1+1+0-1 = 4$，而结果应为 $6$。该选项无效。\n**结论：不正确。**\n\n- **D. $\\mathbf{a}=[\\,2,\\;3,\\;-1,\\;0,\\;2,\\;-1\\,]^T$，节点 $\\sigma_{xx}=2$。**\n该向量的 $a_3=0$，而我们的计算结果为 $a_3=1$。该向量不正确。将此向量代入方程 (1) 进行检验：$a_0+a_1+a_3 = 2+3+0=5$，而结果应为 $6$。该选项无效。\n**结论：不正确。**\n\n只有选项 A 与推导出的解答一致。", "answer": "$$\\boxed{A}$$", "id": "2554876"}, {"introduction": "应力恢复的精度不仅取决于恢复算法本身，更关键地取决于网格的质量。本练习旨在探讨单元的物理几何形状（即“畸变”）与计算应力场可靠性之间的内在理论联系。通过分析一个畸变单元的等参映射及其雅可比矩阵，您将深入理解单元形状如何影响应力梯度的计算和误差的传播，从而认识到高质量网格划分的重要性。[@problem_id:2554932]", "problem": "考虑一个平面应变条件下的单个等参数双线性四边形有限元，其物理节点坐标（逆时针列出）为：节点 $1$ 在 $(0,0)$，节点 $2$ 在 $(2.0,\\,0.2)$，节点 $3$ 在 $(2.2,\\,1.8)$，以及节点 $4$ 在 $(-0.1,\\,1.9)$。父（参考）单元是正方形 $\\{(\\xi,\\eta)\\in\\mathbb{R}^2:\\,-1\\le \\xi,\\eta\\le 1\\}$，$2\\times 2$ 高斯求积使用四个父空间高斯点 $(\\pm 1/\\sqrt{3},\\,\\pm 1/\\sqrt{3})$。假设为线性弹性，具有恒定的本构矩阵，并对几何场和位移场使用带有双线性形函数的标准等参数插值。从父正方形上的双线性形函数的定义、等参数概念、映射的雅可比矩阵以及梯度的链式法则出发，判断下列哪个陈述对此特定单元是正确的，以及在适当情况下，对一般的双线性等参数四边形单元也是正确的。选择所有适用项。\n\nA. 任何父空间点 $(\\xi,\\eta)$ 的物理坐标都是通过使用相同的双线性形函数对节点坐标进行插值得到的。对于此单元，父高斯点 $(\\xi,\\eta)=(1/\\sqrt{3},\\,1/\\sqrt{3})$ 映射到物理位置 $(x,y)\\approx (1.685,\\,1.470)$。\n\nB. 当且仅当四个物理节点形成一个平行四边形时，等参数映射的雅可比矩阵是空间常数。在这种情况下，对于任何双线性位移插值和平面应变下的恒定本构矩阵，柯西应力场在单元内部具有空间常梯度。\n\nC. 对于任何高斯点，从父空间到物理空间的梯度变换遵循 $\\nabla_{\\mathbf{x}} = J^{-T}\\nabla_{(\\xi,\\eta)}$。因此，恢复的应力梯度中扰动的放大在范数上受 $\\lVert J^{-T}\\rVert$ 的限制，在相对意义上受雅可比条件数 $\\kappa(J)$ 的限制；增加 $\\kappa(J)$ 的单元畸变会倾向于放大应力梯度误差。\n\nD. 如果在所有高斯点处 $\\det J$ 均为正，那么物理空间中映射的四个高斯点与通过连接物理单元形心到其各边中点所形成的四个子区域的形心重合。\n\nE. 在线性变化的体力作用下，对双线性四边形进行 $2\\times 2$ 高斯求积时，只要单元内任何地方没有雅可比行列式符号反转，仅在单元中心计算 $\\det J$ 并使用该单个值来缩放所有积分权重是充分的。", "solution": "基于二维等参数双线性四边形单元的有限元法原理，对问题陈述进行分析。\n\n等参数双线性四边形单元的基本关系如下：\n父单元是 $(\\xi, \\eta)$ 空间中的一个正方形，定义为 $-1 \\le \\xi \\le 1$ 和 $-1 \\le \\eta \\le 1$。\n双线性形函数为：\n$$ N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) $$\n$$ N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) $$\n$$ N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) $$\n$$ N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta) $$\n使用这些形函数和节点坐标 $\\mathbf{x}_i = (x_i, y_i)^T$ 对几何进行插值：\n$$ \\mathbf{x}(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) \\mathbf{x}_i $$\n从父空间到物理空间的这个映射的雅可比矩阵是：\n$$ J = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} x_i  \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} x_i \\\\ \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} y_i  \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} y_i \\end{pmatrix} $$\n提供的节点坐标为：$\\mathbf{x}_1 = (0,0)$，$\\mathbf{x}_2 = (2.0, 0.2)$，$\\mathbf{x}_3 = (2.2, 1.8)$，以及 $\\mathbf{x}_4 = (-0.1, 1.9)$。\n\n### 选项 A 的评估\n该陈述包含两部分。\n首先，“任何父空间点 $(\\xi,\\eta)$ 的物理坐标都是通过使用相同的双线性形函数对节点坐标进行插值得到的。”这是几何的等参数映射的定义。由于问题指定了“标准等参数插值”，根据定义，该陈述是正确的。\n\n第二，“对于此单元，父高斯点 $(\\xi,\\eta)=(1/\\sqrt{3},\\,1/\\sqrt{3})$ 映射到物理位置 $(x,y)\\approx (1.685,\\,1.470)$。”\n我们必须计算物理坐标 $\\mathbf{x}(1/\\sqrt{3}, 1/\\sqrt{3})$。令 $\\xi_g = \\eta_g = 1/\\sqrt{3}$。此点的形函数值为：\n$N_1(\\xi_g, \\eta_g) = \\frac{1}{4}(1-1/\\sqrt{3})^2 = \\frac{1}{3} - \\frac{1}{2\\sqrt{3}}$\n$N_2(\\xi_g, \\eta_g) = \\frac{1}{4}(1+1/\\sqrt{3})(1-1/\\sqrt{3}) = \\frac{1}{4}(1-1/3) = \\frac{1}{6}$\n$N_3(\\xi_g, \\eta_g) = \\frac{1}{4}(1+1/\\sqrt{3})^2 = \\frac{1}{3} + \\frac{1}{2\\sqrt{3}}$\n$N_4(\\xi_g, \\eta_g) = \\frac{1}{4}(1-1/\\sqrt{3})(1+1/\\sqrt{3}) = \\frac{1}{4}(1-1/3) = \\frac{1}{6}$\n\n物理坐标计算为 $x = \\sum_{i=1}^{4} N_i x_i$ 和 $y = \\sum_{i=1}^{4} N_i y_i$。\n使用给定的节点坐标：\n$x(\\xi_g, \\eta_g) = N_1(0) + N_2(2.0) + N_3(2.2) + N_4(-0.1)$\n$x = \\frac{1}{6}(2.0) + \\left(\\frac{1}{3} + \\frac{1}{2\\sqrt{3}}\\right)(2.2) + \\frac{1}{6}(-0.1) = \\frac{1.9}{6} + \\frac{2.2}{3} + \\frac{2.2}{2\\sqrt{3}} = \\frac{1.9+4.4}{6} + \\frac{1.1}{\\sqrt{3}} = \\frac{6.3}{6} + \\frac{1.1}{\\sqrt{3}} = 1.05 + \\frac{1.1}{\\sqrt{3}}$\n$x \\approx 1.05 + \\frac{1.1}{1.73205} \\approx 1.05 + 0.63508 = 1.68508$。这与陈述的值 $1.685$ 相符。\n\n$y(\\xi_g, \\eta_g) = N_1(0) + N_2(0.2) + N_3(1.8) + N_4(1.9)$\n$y = \\frac{1}{6}(0.2) + \\left(\\frac{1}{3} + \\frac{1}{2\\sqrt{3}}\\right)(1.8) + \\frac{1}{6}(1.9) = \\frac{2.1}{6} + \\frac{1.8}{3} + \\frac{1.8}{2\\sqrt{3}} = 0.35 + 0.6 + \\frac{0.9}{\\sqrt{3}} = 0.95 + \\frac{0.9}{\\sqrt{3}}$\n$y \\approx 0.95 + \\frac{0.9}{1.73205} \\approx 0.95 + 0.51962 = 1.46962$。这与陈述的值 $1.470$ 相符。\n陈述的两部分都为真。\nA的结论：**正确**。\n\n### 选项 B 的评估\n该陈述有两部分。\n首先，“当且仅当四个物理节点形成一个平行四边形时，等参数映射的雅可比矩阵是空间常数。”\n雅可比矩阵的分量是 $\\xi$ 和 $\\eta$ 的线性函数。例如，\n$J_{11} = \\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4} \\sum \\frac{\\partial N_i}{\\partial \\xi} x_i = \\frac{1}{4} [ (x_2-x_1+x_3-x_4) - (x_1-x_2+x_3-x_4)\\eta ]$。我的草稿有误。让我们仔细重新计算。\n$\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4}[-(1-\\eta)x_1 + (1-\\eta)x_2 + (1+\\eta)x_3 - (1+\\eta)x_4] = \\frac{1}{4}[(x_2-x_1) + (x_3-x_4) + \\eta(-x_1+x_2+x_3-x_4)]$。\n要使其为常数，$\\eta$ 的系数必须为零：$-x_1+x_2+x_3-x_4 = 0$。\n类似地，要使 $\\frac{\\partial y}{\\partial \\xi}$ 为常数，我们需要 $-y_1+y_2+y_3-y_4 = 0$。\n要使 $\\frac{\\partial x}{\\partial \\eta}$ 为常数，$\\xi$ 的系数必须为零：$-x_1-x_2+x_3+x_4 = 0$。\n要使 $\\frac{\\partial y}{\\partial \\eta}$ 为常数，我们需要 $-y_1-y_2+y_3+y_4 = 0$。\n$\\xi$ 导数的两个条件给出了 $\\mathbf{x}_1-\\mathbf{x}_2+\\mathbf{x}_3-\\mathbf{x}_4=\\mathbf{0}$。不对，让我们重新检查 $\\partial N_i / \\partial \\xi$ 的导数项。$\\partial x / \\partial \\xi$ 中 $\\eta$ 的系数是 $\\frac{1}{4}(x_1 - x_2 + x_3 - x_4)$。\n$\\partial x / \\partial \\eta$ 中 $\\xi$ 的系数是 $\\frac{1}{4}(x_1 - x_2 + x_3 - x_4)$。这是错误的。\n$\\partial x / \\partial \\eta = \\sum \\frac{\\partial N_i}{\\partial \\eta} x_i = \\frac{1}{4}[-(1-\\xi)x_1-(1+\\xi)x_2+(1+\\xi)x_3+(1-\\xi)x_4]$。$\\xi$ 的系数是 $\\frac{1}{4}(x_1-x_2+x_3-x_4)$。这是错误的。\n让我们重新组合含 $\\xi$ 的项：$\\frac{1}{4} \\xi (x_1 - x_2 - x_3 + x_4)$。\n这没有帮助。让我们使用平行四边形的性质 $\\mathbf{x}_1+\\mathbf{x}_3=\\mathbf{x}_2+\\mathbf{x}_4$。\n这等价于 $\\mathbf{x}_1-\\mathbf{x}_2+\\mathbf{x}_3-\\mathbf{x}_4 = \\mathbf{0}$。映射 $x(\\xi,\\eta)$ 中 $\\xi \\eta$ 项的系数是 $\\frac{1}{4}(x_1-x_2+x_3-x_4)$。如果这个系数为零，映射就是仿射的。这就是平行四边形的条件。如果映射是仿射的，$x=a_0+a_1\\xi+a_2\\eta$ 且 $y=b_0+b_1\\xi+b_2\\eta$。那么雅可比矩阵的项 $\\partial x/\\partial\\xi=a_1$，$\\partial x/\\partial\\eta=a_2$ 等是常数。所以平行四边形形状会得到一个常数雅可比矩阵。反之，如果 $J$ 是常数，其项与 $\\xi, \\eta$ 无关。这要求 $J_{ij}$ 表达式中 $\\xi$ 和 $\\eta$ 的系数为零。正如在草稿中确立的，这个条件是 $\\mathbf{x}_1-\\mathbf{x}_2+\\mathbf{x}_3-\\mathbf{x}_4=\\mathbf{0}$，这定义了一个平行四边形。第一部分是正确的。\n\n第二，“在这种情况下...柯西应力场在单元内部具有空间常梯度。”\n如果 J 是常数，则映射是仿射的。形函数相对于物理坐标 $(x,y)$ 的导数是 $\\begin{pmatrix} \\partial N_i/\\partial x \\\\ \\partial N_i/\\partial y \\end{pmatrix} = (J^{-1})^T \\begin{pmatrix} \\partial N_i/\\partial\\xi \\\\ \\partial N_i/\\partial\\eta \\end{pmatrix}$。由于 $J^{-1}$ 是常数，而 $\\partial N_i/\\partial\\xi, \\partial N_i/\\partial\\eta$ 是 $\\xi$ 和 $\\eta$ 的线性函数（例如，$\\partial N_1/\\partial\\xi = -(1-\\eta)/4$），因此导数 $\\partial N_i/\\partial x, \\partial N_i/\\partial y$ 是 $\\xi$ 和 $\\eta$ 的线性函数。应变是 $\\epsilon_{kl} = \\sum_i (\\partial_k N_i) u_{l,i} + \\ldots$，它们也是 $\\xi, \\eta$ 的线性函数。由于映射是仿射的，$(\\xi, \\eta)$ 是 $(x,y)$ 的线性函数。因此，应变是 $(x,y)$ 的线性函数。对于一个常数本构矩阵 $C$，应力 $\\sigma = C\\epsilon$ 也是 $(x,y)$ 的线性函数。一个作为空间坐标线性函数的场具有恒定的梯度。第二部分也是正确的。\nB的结论：**正确**。\n\n### 选项 C 的评估\n第一部分：“对于任何高斯点，从父空间到物理空间的梯度变换遵循 $\\nabla_{\\mathbf{x}} = J^{-T}\\nabla_{(\\xi,\\eta)}$。”\n对标量函数 $f(x,y)$ 使用链式法则：\n$\\frac{\\partial f}{\\partial \\xi} = \\frac{\\partial f}{\\partial x}\\frac{\\partial x}{\\partial \\xi} + \\frac{\\partial f}{\\partial y}\\frac{\\partial y}{\\partial \\xi}$ 和 $\\frac{\\partial f}{\\partial \\eta} = \\frac{\\partial f}{\\partial x}\\frac{\\partial x}{\\partial \\eta} + \\frac{\\partial f}{\\partial y}\\frac{\\partial y}{\\partial \\eta}$。\n以矩阵形式，$\\begin{pmatrix} \\partial f/\\partial \\xi \\\\ \\partial f/\\partial \\eta \\end{pmatrix} = \\begin{pmatrix} \\partial x/\\partial \\xi  \\partial y/\\partial \\xi \\\\ \\partial x/\\partial \\eta  \\partial y/\\partial \\eta \\end{pmatrix} \\begin{pmatrix} \\partial f/\\partial x \\\\ \\partial f/\\partial y \\end{pmatrix}$。\n这是 $\\nabla_{(\\xi,\\eta)} f = J^T \\nabla_{\\mathbf{x}} f$。\n对 $\\nabla_{\\mathbf{x}} f$ 求逆得到 $\\nabla_{\\mathbf{x}} f = (J^T)^{-1} \\nabla_{(\\xi,\\eta)} f = J^{-T} \\nabla_{(\\xi,\\eta)} f$。\n这个关系是正确的。\n\n第二部分：“...恢复的应力梯度中扰动的放大在范数上受 $\\lVert J^{-T}\\rVert$ 限制，在相对意义上受雅可比条件数 $\\kappa(J)$ 限制...”\n令 $\\mathbf{g}_\\mathbf{x} = \\nabla_{\\mathbf{x}} \\sigma$ 为物理空间中的应力梯度，$\\mathbf{g}_{(\\xi,\\eta)} = \\nabla_{(\\xi,\\eta)} \\sigma$ 为父空间中的梯度。\n$\\mathbf{g}_\\mathbf{x} = J^{-T} \\mathbf{g}_{(\\xi,\\eta)}$。\n父空间中的扰动 $\\delta\\mathbf{g}_{(\\xi,\\eta)}$ 导致物理空间中的扰动 $\\delta\\mathbf{g}_\\mathbf{x} = J^{-T} \\delta\\mathbf{g}_{(\\xi,\\eta)}$。\n取向量范数，$\\|\\delta\\mathbf{g}_\\mathbf{x} \\| = \\|J^{-T} \\delta\\mathbf{g}_{(\\xi,\\eta)}\\| \\le \\|J^{-T}\\| \\|\\delta\\mathbf{g}_{(\\xi,\\eta)}\\|$。放大受 $\\|J^{-T}\\|$ 限制。\n对于相对放大，我们有 $\\frac{\\|\\delta\\mathbf{g}_\\mathbf{x} \\|}{\\|\\mathbf{g}_\\mathbf{x} \\|} \\le \\frac{\\|J^{-T}\\| \\|\\delta\\mathbf{g}_{(\\xi,\\eta)}\\|}{\\|\\mathbf{g}_\\mathbf{x} \\|}$。\n从 $\\mathbf{g}_{(\\xi,\\eta)} = J^T \\mathbf{g}_\\mathbf{x}$，我们有 $\\|\\mathbf{g}_{(\\xi,\\eta)}\\| \\le \\|J^T\\| \\|\\mathbf{g}_\\mathbf{x}\\|$，所以 $\\|\\mathbf{g}_\\mathbf{x}\\| \\ge \\|\\mathbf{g}_{(\\xi,\\eta)}\\| / \\|J^T\\|$。\n代入此式可得：\n$\\frac{\\|\\delta\\mathbf{g}_\\mathbf{x} \\|}{\\|\\mathbf{g}_\\mathbf{x} \\|} \\le \\|J^{-T}\\| \\|J^T\\| \\frac{\\|\\delta\\mathbf{g}_{(\\xi,\\eta)}\\|}{\\|\\mathbf{g}_{(\\xi,\\eta)}\\|} = \\kappa(J^T) \\frac{\\|\\delta\\mathbf{g}_{(\\xi,\\eta)}\\|}{\\|\\mathbf{g}_{(\\xi,\\eta)}\\|}$。\n对于许多范数，例如谱（2-）范数，$\\kappa(J^T) = \\kappa(J)$。这证实了相对误差放大受条件数 $\\kappa(J)$ 的限制。单元畸变（大内角、扭曲、大纵横比）已知会增加 $\\kappa(J)$。整个陈述是有限元误差分析中一个正确且基本的概念。\nC的结论：**正确**。\n\n### 选项 D 的评估\n该陈述提出了一个特定的几何主张：“如果 $\\det J$ 在所有高斯点处均为正，那么物理空间中映射的四个高斯点与通过连接物理单元形心到其各边中点所形成的四个子区域的形心重合。”\n让我们用最简单的情况来测试它：父正方形本身，其物理坐标与父坐标相同，即 $(x,y) = (\\xi,\\eta)$。映射是单位映射，$J=I$，且 $\\det J=10$。\n节点是 $P_1(-1,-1), P_2(1,-1), P_3(1,1), P_4(-1,1)$。\n边的中点是 $M_1(0,-1), M_2(1,0), M_3(0,1), M_4(-1,0)$。\n单元的形心（顶点平均值）是 $C(0,0)$。\n四个子区域之一是四边形 $P_1M_1CM_4$，其顶点为 $(-1,-1), (0,-1), (0,0), (-1,0)$。这是一个正方形。其形心在 $(-1/2, -1/2)$。\n其他三个子区域也是正方形，形心分别在 $(1/2, -1/2)$, $(1/2, 1/2)$, 和 $(-1/2, 1/2)$。\n父空间中的 $2\\times 2$ 高斯点是 $(\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$。由于物理单元就是父单元，这些也是物理空间中映射后的高斯点。\n我们将高斯点坐标与子区域形心坐标进行比较。例如，我们比较 $(1/\\sqrt{3}, 1/\\sqrt{3})$ 和 $(1/2, 1/2)$。\n由于 $1/\\sqrt{3} \\approx 0.577 \\neq 1/2 = 0.5$，这些点不重合。\n这个陈述是错误的，这个简单的反例证明了这一点。关于 $\\det J$ 的条件与这个几何谬误无关。\nD的结论：**错误**。\n\n### 选项 E 的评估\n该陈述为数值积分提出了一个近似方法：“...只要单元内任何地方没有雅可比行列式符号反转，仅在单元中心计算 $\\det J$ 并使用该单个值来缩放所有积分权重是充分的...”。\n体力向量的积分形式为 $I = \\int_{\\Omega_e} \\mathbf{F}(\\mathbf{x}) dA = \\int_{-1}^1 \\int_{-1}^1 \\mathbf{F}(\\mathbf{x}(\\xi,\\eta)) \\det J(\\xi,\\eta) d\\xi d\\eta$。\n$2\\times 2$ 高斯求积将其近似为 $I \\approx \\sum_{i=1}^4 w_i \\mathbf{F}(\\mathbf{x}(\\xi_i,\\eta_i)) \\det J(\\xi_i,\\eta_i)$，其中 $w_i=1$。\n建议的程序是 $I \\approx \\det J(0,0) \\sum_{i=1}^4 w_i \\mathbf{F}(\\mathbf{x}(\\xi_i,\\eta_i))$。\n这种近似仅在 $\\det J(\\xi,\\eta)$ 在整个单元上为常数时才是精确的。正如在选项 B 的分析中确立的，当且仅当单元是平行四边形时，$\\det J$ 才为常数。\n对于一般的四边形，比如本题中的这个，$\\det J$ 是 $\\xi$ 和 $\\eta$ 的双线性函数，并且不是常数。用 $\\det J(0,0)$ 代替 $\\det J(\\xi_i,\\eta_i)$ 会引入积分误差。\n“充分”一词意味着该程序足以获得准确的结果。然而，这种简化会导致单元公式无法通过一般四边形形状的“分片检验”（patch test），而这是确保有限元解随着网格细化而收敛的基本标准。因此，对于通用的有限元分析，该程序在理论上是不健全的，也不是“充分的”。关于 $\\det J$ 符号的条件只保证了映射的有效性，但不能证明该近似是合理的。\nE的结论：**错误**。", "answer": "$$\\boxed{ABC}$$", "id": "2554932"}]}