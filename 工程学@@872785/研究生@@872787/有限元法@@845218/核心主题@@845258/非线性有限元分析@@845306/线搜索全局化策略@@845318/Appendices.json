{"hands_on_practices": [{"introduction": "理解线搜索策略的最佳方式是将其应用于一个理想化的简单情形。本练习 [@problem_id:2573793] 考虑了一个在有限元线性弹性分析中常见的凸二次能量泛函。通过从第一性原理出发，您将推导精确的线搜索步长，并将其与通过回溯算法得到的步长进行比较，从而深入理解 Armijo 条件的实际运作机制及其与最优解的关系。", "problem": "考虑由线性弹性力学的有限元离散化产生的二次能量，\n$$J(u) = \\tfrac{1}{2}\\,u^{\\top} K u - f^{\\top} u,$$\n其中 $K \\in \\mathbb{R}^{2 \\times 2}$ 是一个对称正定 (SPD) 刚度矩阵，$f \\in \\mathbb{R}^{2}$ 是载荷向量。设\n$$K = \\begin{pmatrix} 8  -2 \\\\ -2  5 \\end{pmatrix}, \\qquad f = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}, \\qquad u^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.$$\n采用标准欧几里得内积和最速下降方向 $p^{(0)} = -\\nabla J(u^{(0)})$。从 $J$ 的梯度和方向导数的定义以及 Armijo 充分下降条件出发，完成以下操作：\n\n1) 从第一性原理出发，推导使 $J(u^{(0)} + \\alpha\\, p^{(0)})$ 沿着最速下降方向最小化的精确步长 $\\alpha_{\\star}$。\n\n2) 使用回溯线搜索，其中 Armijo 参数 $c_{1} = 10^{-4}$，初始试探步长 $\\alpha_{0} = 1$，缩减因子 $\\rho = \\tfrac{1}{2}$，确定在 $u^{(0)}$ 处接受的回溯步长 $\\alpha_{\\mathrm{bt}}$（即序列 $\\{ \\alpha_{0}, \\rho \\alpha_{0}, \\rho^{2} \\alpha_{0}, \\dots \\}$ 中第一个满足 Armijo 条件的 $\\alpha$）。\n\n3) 将比率 $\\alpha_{\\mathrm{bt}}/\\alpha_{\\star}$ 以一个最简分数的形式报告。无需四舍五入。", "solution": "该问题具有科学依据，是良定的，并包含了获得唯一解所需的所有信息。刚度矩阵 $K$ 是对称的。其正定性可以通过 Sylvester 准则来确认：第一个顺序主子式是 $\\det(8) = 8 > 0$，第二个是 $\\det(K) = (8)(5) - (-2)(-2) = 40 - 4 = 36 > 0$。由于 $K$ 是对称正定 (SPD) 的，二次泛函 $J(u)$ 是严格凸的，并有唯一的最小值。我们继续进行求解。\n\n二次能量泛函由下式给出\n$$J(u) = \\frac{1}{2}u^{\\top} K u - f^{\\top} u.$$\n此泛函关于 $u$ 的梯度使用矩阵微积分求得。二次项 $\\frac{1}{2}u^{\\top} K u$ 的导数是 $\\frac{1}{2}(K + K^{\\top})u$，线性项 $-f^{\\top} u$ 的导数是 $-f$。由于刚度矩阵 $K$ 是对称的（$K = K^{\\top}$），梯度简化为\n$$\\nabla J(u) = K u - f.$$\n给定初始点 $u^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。在该点，梯度为\n$$\\nabla J(u^{(0)}) = K u^{(0)} - f = K \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} - f = -f = -\\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ -1 \\end{pmatrix}.$$\n最速下降方向 $p^{(0)}$ 定义为在 $u^{(0)}$ 处梯度的负值：\n$$p^{(0)} = -\\nabla J(u^{(0)}) = -(-f) = f = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}.$$\n\n1) 首先，我们推导精确步长 $\\alpha_{\\star}$。这是使一维函数 $\\phi(\\alpha) = J(u^{(0)} + \\alpha p^{(0)})$ 最小化的 $\\alpha > 0$ 的值。\n$$\\phi(\\alpha) = J(u^{(0)} + \\alpha p^{(0)}) = \\frac{1}{2}(u^{(0)} + \\alpha p^{(0)})^{\\top} K (u^{(0)} + \\alpha p^{(0)}) - f^{\\top}(u^{(0)} + \\alpha p^{(0)}).$$\n代入 $u^{(0)} = 0$，表达式简化为：\n$$\\phi(\\alpha) = \\frac{1}{2}(\\alpha p^{(0)})^{\\top} K (\\alpha p^{(0)}) - f^{\\top}(\\alpha p^{(0)}) = \\frac{1}{2}\\alpha^{2} (p^{(0)})^{\\top} K p^{(0)} - \\alpha f^{\\top} p^{(0)}.$$\n为求此关于 $\\alpha$ 的二次函数的最小值，我们将其关于 $\\alpha$ 的导数设为零：\n$$\\frac{d\\phi}{d\\alpha} = \\alpha (p^{(0)})^{\\top} K p^{(0)} - f^{\\top} p^{(0)} = 0.$$\n解出 $\\alpha$ 得到精确步长 $\\alpha_{\\star}$：\n$$\\alpha_{\\star} = \\frac{f^{\\top} p^{(0)}}{(p^{(0)})^{\\top} K p^{(0)}}.$$\n由于 $p^{(0)} = f$，我们可以将其写为\n$$\\alpha_{\\star} = \\frac{f^{\\top} f}{f^{\\top} K f}.$$\n现在我们用给定的 $K$ 和 $f$ 计算必要的量：\n$$f^{\\top} f = \\begin{pmatrix} 2  1 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = 2^{2} + 1^{2} = 4 + 1 = 5.$$\n$$K f = \\begin{pmatrix} 8  -2 \\\\ -2  5 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} (8)(2) + (-2)(1) \\\\ (-2)(2) + (5)(1) \\end{pmatrix} = \\begin{pmatrix} 16 - 2 \\\\ -4 + 5 \\end{pmatrix} = \\begin{pmatrix} 14 \\\\ 1 \\end{pmatrix}.$$\n$$f^{\\top} K f = \\begin{pmatrix} 2  1 \\end{pmatrix} \\begin{pmatrix} 14 \\\\ 1 \\end{pmatrix} = (2)(14) + (1)(1) = 28 + 1 = 29.$$\n代入这些值，我们得到精确步长：\n$$\\alpha_{\\star} = \\frac{5}{29}.$$\n\n2) 接下来，我们求接受的回溯步长 $\\alpha_{\\mathrm{bt}}$。回溯线搜索从一个初始试探步长 $\\alpha_{0}=1$ 开始，并以因子 $\\rho = \\frac{1}{2}$ 迭代地减小它，直到满足 Armijo 充分下降条件。Armijo 条件是\n$$J(u^{(k)} + \\alpha p^{(k)}) \\le J(u^{(k)}) + c_{1} \\alpha \\nabla J(u^{(k)})^{\\top} p^{(k)}.$$\n对于我们问题中的初始步（$k=0$），该条件变为\n$$J(u^{(0)} + \\alpha p^{(0)}) \\le J(u^{(0)}) + c_{1} \\alpha \\nabla J(u^{(0)})^{\\top} p^{(0)}.$$\n我们计算每一项：\n$$J(u^{(0)}) = J(\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}) = \\frac{1}{2}(0) - 0 = 0.$$\n$$\\nabla J(u^{(0)})^{\\top} p^{(0)} = (-f)^{\\top} f = -f^{\\top} f = -5.$$\n$$J(u^{(0)} + \\alpha p^{(0)}) = \\phi(\\alpha) = \\frac{1}{2}\\alpha^{2} (p^{(0)})^{\\top} K p^{(0)} - \\alpha f^{\\top} p^{(0)} = \\frac{29}{2}\\alpha^{2} - 5\\alpha.$$\n因此 Armijo 条件是\n$$\\frac{29}{2}\\alpha^{2} - 5\\alpha \\le 0 + c_{1} \\alpha (-5) = -5 c_{1} \\alpha.$$\n由于 $\\alpha$ 必须为正，我们可以除以 $\\alpha$：\n$$\\frac{29}{2}\\alpha - 5 \\le -5 c_{1}.$$\n$$\\frac{29}{2}\\alpha \\le 5 - 5 c_{1} = 5(1 - c_{1}).$$\n$$\\alpha \\le \\frac{10}{29}(1 - c_{1}).$$\n使用给定的 Armijo 参数 $c_{1} = 10^{-4}$：\n$$\\alpha \\le \\frac{10}{29}(1 - 10^{-4}) = \\frac{10}{29}(0.9999) = \\frac{9.999}{29}.$$\n现在我们测试试探步长序列 $\\alpha = \\{1, \\frac{1}{2}, \\frac{1}{4}, \\dots \\}$。\n- 测试 $\\alpha = 1$：$1 \\le \\frac{9.999}{29}$ 是否成立？不成立，因为 $29 > 9.999$。拒绝。\n- 测试 $\\alpha = \\frac{1}{2}$：$\\frac{1}{2} \\le \\frac{9.999}{29}$ 是否成立？这等价于 $29 \\le 2(9.999) = 19.998$。不成立。拒绝。\n- 测试 $\\alpha = \\frac{1}{4}$：$\\frac{1}{4} \\le \\frac{9.999}{29}$ 是否成立？这等价于 $29 \\le 4(9.999) = 39.996$。成立。接受。\n第一个满足条件的步长是 $\\alpha = \\frac{1}{4}$。因此，接受的回溯步长是\n$$\\alpha_{\\mathrm{bt}} = \\frac{1}{4}.$$\n\n3) 最后，我们计算回溯步长与精确步长的比率：\n$$\\frac{\\alpha_{\\mathrm{bt}}}{\\alpha_{\\star}} = \\frac{1/4}{5/29} = \\frac{1}{4} \\cdot \\frac{29}{5} = \\frac{29}{20}.$$\n这个分数已经是其最简形式，因为 29 是一个质数，而 20 不是 29 的倍数。", "answer": "$$\\boxed{\\frac{29}{20}}$$", "id": "2573793"}, {"introduction": "在真实的非线性有限元问题中，能量函数的景观往往不是凸的，这会导致切线刚度矩阵不定。在这种情况下，标准的牛顿方向可能指向能量增加的方向（“上坡”方向），使其在最小化过程中失效。本练习 [@problem_id:2573842] 将通过一个具体的例子展示这种失效情况，并引导您探索一种实用的修正方法——通过修改牛顿系统来确保我们总能获得一个有效的下降方向。", "problem": "考虑一根单位长度的一维非线性弹性杆，其左端固定，在有限元方法 (FEM) 中经过一次线性有限元离散化后，右端位移 $u \\in \\mathbb{R}$ 是其唯一的自由度。储存能量密度是轴向应变 $\\varepsilon$ 的函数，表达式为 $\\psi(\\varepsilon)=\\tfrac{1}{4}(\\varepsilon^{2}-1)^{2}$。在单位区间上采用恒定应变近似 $\\varepsilon=u$，离散势能为 $ \\Pi(u)=\\tfrac{1}{4}(u^{2}-1)^{2}$。在线搜索全局化策略中，取评价函数 $M(u)$ 为势能，即 $M(u)=\\Pi(u)$。梯度为 $g(u)=\\Pi'(u)$，切线（黑塞矩阵）为 $k(u)=\\Pi''(u)$。如果 $g(u)\\,p0$，则方向 $p$ 是 $M$ 在 $u$ 点的一个下降方向。牛顿方向 $p_{\\mathrm{N}}(u)$ 满足方程 $k(u)\\,p_{\\mathrm{N}}(u)=-g(u)$。\n\n在迭代点 $u^{(k)}=\\tfrac{1}{2}$ 处进行计算。仅从上述定义和标准微积分出发，完成以下任务：\n1) 计算 $g(u^{(k)})$、$k(u^{(k)})$ 和牛顿方向 $p_{\\mathrm{N}}(u^{(k)})$，并通过计算 $g(u^{(k)})\\,p_{\\mathrm{N}}(u^{(k)})$ 的值来验证 $p_{\\mathrm{N}}(u^{(k)})$ 是否为下降方向。\n2) 为在切线不定时强制下降，考虑带有对角位移 $\\tau \\in \\mathbb{R}$ 的带保护的修正牛顿系统：$(k(u^{(k)})+\\tau)\\,p_{\\tau}(u^{(k)})=-g(u^{(k)})$。确定最小的实数 $\\tau_{\\star}$，使得对于所有 $\\tau\\tau_{\\star}$，在梯度不为零的情况下，方向 $p_{\\tau}(u^{(k)})$ 都保证是 $M$ 在 $u^{(k)}$ 点的下降方向。以精确数值形式给出 $\\tau_{\\star}$。最终答案必须是 $\\tau_{\\star}$ 的这一个单值（无单位）。", "solution": "所述问题具有科学依据、提法恰当且客观。它代表了非线性计算力学领域的一个标准练习，具体涉及用于求解有限元离散化系统的牛顿法的全局化问题。该问题是有效的，我们开始求解。\n\n系统的势能由下式给出\n$$ \\Pi(u) = \\frac{1}{4}(u^2-1)^2 $$\n势能关于自由度 $u$ 的一阶和二阶导数分别定义了梯度（内力）$g(u)$ 和切线（刚度）$k(u)$。\n\n梯度通过链式法则计算：\n$$ g(u) = \\Pi'(u) = \\frac{d}{du} \\left[ \\frac{1}{4}(u^2-1)^2 \\right] = \\frac{1}{4} \\cdot 2(u^2-1) \\cdot (2u) = u(u^2-1) = u^3 - u $$\n切线是梯度的导数：\n$$ k(u) = \\Pi''(u) = \\frac{d}{du} \\left[ u^3 - u \\right] = 3u^2 - 1 $$\n\n根据题目要求，我们在迭代点 $u^{(k)} = \\frac{1}{2}$ 处分析该系统。\n\n首先，我们解决问题的第一部分。我们计算在 $u^{(k)} = \\frac{1}{2}$ 处的梯度和切线：\n$$ g(u^{(k)}) = g\\left(\\frac{1}{2}\\right) = \\left(\\frac{1}{2}\\right)^3 - \\frac{1}{2} = \\frac{1}{8} - \\frac{1}{2} = -\\frac{3}{8} $$\n$$ k(u^{(k)}) = k\\left(\\frac{1}{2}\\right) = 3\\left(\\frac{1}{2}\\right)^2 - 1 = 3\\left(\\frac{1}{4}\\right) - 1 = \\frac{3}{4} - 1 = -\\frac{1}{4} $$\n牛顿方向 $p_{\\mathrm{N}}(u^{(k)})$ 由线性系统 $k(u^{(k)}) \\, p_{\\mathrm{N}}(u^{(k)}) = -g(u^{(k)})$ 的解定义。代入计算出的值：\n$$ \\left(-\\frac{1}{4}\\right) p_{\\mathrm{N}}\\left(\\frac{1}{2}\\right) = - \\left(-\\frac{3}{8}\\right) = \\frac{3}{8} $$\n求解 $p_{\\mathrm{N}}(\\frac{1}{2})$：\n$$ p_{\\mathrm{N}}\\left(\\frac{1}{2}\\right) = \\frac{3}{8} \\cdot (-4) = -\\frac{12}{8} = -\\frac{3}{2} $$\n为验证这是否是评价函数 $M(u) = \\Pi(u)$ 的一个下降方向，我们必须检查条件 $g(u^{(k)}) \\, p_{\\mathrm{N}}(u^{(k)})  0$ 是否满足。我们计算这个乘积：\n$$ g\\left(\\frac{1}{2}\\right) \\, p_{\\mathrm{N}}\\left(\\frac{1}{2}\\right) = \\left(-\\frac{3}{8}\\right) \\cdot \\left(-\\frac{3}{2}\\right) = \\frac{9}{16} $$\n由于 $\\frac{9}{16} > 0$，牛顿方向 $p_{\\mathrm{N}}(u^{(k)})$ 不是一个下降方向。这是预料之中的，因为切线刚度 $k(u^{(k)}) = -\\frac{1}{4}$ 是负值，表明势能面在该点是下凹的。未修正的牛顿步旨在寻找一个驻点，在本例中该驻点是势能的一个局部极大值点。\n\n接下来，我们解决问题的第二部分。我们考虑带保护的修正牛顿系统：\n$$ (k(u^{(k)}) + \\tau) \\, p_{\\tau}(u^{(k)}) = -g(u^{(k)}) $$\n参数 $\\tau$ 的目的是修正系统，以使得到的方向 $p_{\\tau}(u^{(k)})$ 是一个下降方向。根据系统定义，我们可以将修正后的方向表示为：\n$$ p_{\\tau}(u^{(k)}) = - \\frac{g(u^{(k)})}{k(u^{(k)}) + \\tau} $$\n此表达式在 $k(u^{(k)}) + \\tau \\neq 0$ 的条件下有效。\n\n$p_{\\tau}(u^{(k)})$ 成为下降方向的条件是 $g(u^{(k)}) \\, p_{\\tau}(u^{(k)})  0$。我们将 $p_{\\tau}(u^{(k)})$ 的表达式代入这个不等式中：\n$$ g(u^{(k)}) \\left( - \\frac{g(u^{(k)})}{k(u^{(k)}) + \\tau} \\right)  0 $$\n$$ - \\frac{[g(u^{(k)})]^2}{k(u^{(k)}) + \\tau}  0 $$\n问题指明梯度不为零。对于任何非零实数 $g(u^{(k)})$，其平方 $[g(u^{(k)})]^2$ 严格为正。因此，分子 $-[g(u^{(k)})]^2$ 严格为负。要使整个分数为负，分母必须严格为正：\n$$ k(u^{(k)}) + \\tau > 0 $$\n该条件确保了修正后的切线 $k(u^{(k)}) + \\tau$ 是正定的（在这个一维案例中，即为正值）。对于任何非零梯度，正定的修正切线都能保证得到一个下降方向。\n\n现在我们代入在给定迭代点处的切线值 $k(u^{(k)}) = -\\frac{1}{4}$：\n$$ -\\frac{1}{4} + \\tau > 0 $$\n求解 $\\tau$ 得到条件：\n$$ \\tau > \\frac{1}{4} $$\n问题要求找出最小的实数 $\\tau_{\\star}$，使得对于所有 $\\tau > \\tau_{\\star}$，方向 $p_{\\tau}(u^{(k)})$ 都保证是一个下降方向。推导出的条件恰好是 $\\tau > \\frac{1}{4}$。因此，值 $\\tau_{\\star}$ 是有效 $\\tau$ 值集合的下确界，也就是这个区间的边界。因此，$\\tau_{\\star} = \\frac{1}{4}$。对于任何 $\\tau > \\tau_{\\star}$，修正后的切线 $k(u^{(k)})+\\tau$ 将为正，从而得到一个下降方向。如果 $\\tau = \\tau_{\\star}$，分母为零，方向未定义。", "answer": "$$\n\\boxed{\\frac{1}{4}}\n$$", "id": "2573842"}, {"introduction": "在前一个练习的基础上，我们进一步探讨非凸问题。当切线刚度不定时，即使用修正方法找到了一个下降方向，如果我们试图最小化的“目标”不正确，算法可能依然会失败。本练习 [@problem_id:2573788] 对比了两种常用的评价函数（merit function）：势能和残差的范数平方。它揭示了一个关键场景：一个步长虽然会增加系统的能量，但却能有效地减小残差，这说明了基于残差的评价标准在寻找一般平衡点时具有更强的鲁棒性。", "problem": "考虑一个非线性有限元(FE)平衡问题，该问题源于一个超弹性总势能 $\\Pi(\\mathbf{u})$，其残差为 $\\mathbf{R}(\\mathbf{u}) = \\nabla \\Pi(\\mathbf{u})$，一致切线为 $\\mathbf{K}(\\mathbf{u}) = \\nabla^{2} \\Pi(\\mathbf{u})$。通过线搜索实现的全局化会考虑试探状态 $\\mathbf{u}(\\alpha) = \\mathbf{u}^{k} + \\alpha \\mathbf{p}^{k}$（其中 $\\alpha \\ge 0$），牛顿方向 $\\mathbf{p}^{k}$ 是 $\\mathbf{K}^{k}\\mathbf{p}^{k} = -\\mathbf{R}^{k}$ 的解，其中 $\\mathbf{R}^{k} = \\mathbf{R}(\\mathbf{u}^{k})$ 且 $\\mathbf{K}^{k} = \\mathbf{K}(\\mathbf{u}^{k})$。通常使用两种接受准则：能量 $\\Pi$ 的减少和基于残差的优值函数 $M(\\alpha) = \\tfrac{1}{2}\\|\\mathbf{R}(\\mathbf{u}(\\alpha))\\|_{2}^{2}$ 的减少。\n\n假设在 $\\mathbf{u}^{k}$ 周围一个局部二次模型是精确的，因此对于任何增量 $\\mathbf{s}$，都有 $\\Pi(\\mathbf{u}^{k}+\\mathbf{s}) = \\Pi(\\mathbf{u}^{k}) + \\mathbf{R}^{k\\top}\\mathbf{s} + \\tfrac{1}{2}\\mathbf{s}^{\\top}\\mathbf{K}^{k}\\mathbf{s}$ 和 $\\mathbf{R}(\\mathbf{u}^{k}+\\mathbf{s}) = \\mathbf{R}^{k} + \\mathbf{K}^{k}\\mathbf{s}$。在当前迭代步，设\n- $\\mathbf{R}^{k} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$，\n- $\\mathbf{K}^{k} = \\mathrm{diag}(1,-1)$。\n\n使用精确的牛顿方向 $\\mathbf{p}^{k} = -(\\mathbf{K}^{k})^{-1}\\mathbf{R}^{k}$ 和直线 $\\mathbf{u}(\\alpha) = \\mathbf{u}^{k} + \\alpha \\mathbf{p}^{k}$：\n\n- 推导 $\\Delta \\Pi(\\alpha) := \\Pi(\\mathbf{u}(\\alpha)) - \\Pi(\\mathbf{u}^{k})$ 和 $M(\\alpha) := \\tfrac{1}{2}\\|\\mathbf{R}(\\mathbf{u}(\\alpha))\\|_{2}^{2}$ 作为 $\\alpha$ 的函数的显式表达式。\n- 证明存在一个 $\\alpha$ 的非空区间，在此区间内 $\\Delta \\Pi(\\alpha)$ 严格为正，而 $M(\\alpha)$ 严格递减，从而证明基于残差优值的线搜索会接受基于能量减少的线搜索所拒绝的步。\n- 计算使得 $\\Pi(\\mathbf{u}(\\alpha)) = \\Pi(\\mathbf{u}^{k})$ 的最小正步长 $\\alpha$。将此值作为您的最终答案报告（无量纲）。\n- 根据您的推导，就哪种接受准则（能量减少与残差优值减少）更能直接反映有限元中向平衡状态的收敛给出一个简明的论证。\n\n您最终报告的答案必须是使 $\\Pi(\\mathbf{u}(\\alpha)) = \\Pi(\\mathbf{u}^{k})$ 的最小正 $\\alpha$ 的单一值。无需四舍五入。", "solution": "问题已提交以供验证。\n\n首先，从问题陈述中逐字提取所有给定条件。\n- 该系统是一个源于总势能 $\\Pi(\\mathbf{u})$ 的非线性有限元问题。\n- 残差向量为 $\\mathbf{R}(\\mathbf{u}) = \\nabla \\Pi(\\mathbf{u})$。\n- 一致切线矩阵为 $\\mathbf{K}(\\mathbf{u}) = \\nabla^{2} \\Pi(\\mathbf{u})$。\n- 使用线搜索全局化，试探状态为 $\\mathbf{u}(\\alpha) = \\mathbf{u}^{k} + \\alpha \\mathbf{p}^{k}$，其中 $\\alpha \\ge 0$。\n- 牛顿方向 $\\mathbf{p}^{k}$ 通过求解线性系统 $\\mathbf{K}^{k}\\mathbf{p}^{k} = -\\mathbf{R}^{k}$ 获得，其中 $\\mathbf{R}^{k} = \\mathbf{R}(\\mathbf{u}^{k})$ 且 $\\mathbf{K}^{k} = \\mathbf{K}(\\mathbf{u}^{k})$。\n- 考虑了两种接受准则：能量 $\\Pi$ 的减少和基于残差的优值函数 $M(\\alpha) = \\tfrac{1}{2}\\|\\mathbf{R}(\\mathbf{u}(\\alpha))\\|_{2}^{2}$ 的减少。\n- 假设局部二次模型是精确的：\n  - $\\Pi(\\mathbf{u}^{k}+\\mathbf{s}) = \\Pi(\\mathbf{u}^{k}) + \\mathbf{R}^{k\\top}\\mathbf{s} + \\tfrac{1}{2}\\mathbf{s}^{\\top}\\mathbf{K}^{k}\\mathbf{s}$\n  - $\\mathbf{R}(\\mathbf{u}^{k}+\\mathbf{s}) = \\mathbf{R}^{k} + \\mathbf{K}^{k}\\mathbf{s}$\n- 在当前迭代步 $k$，具体数据为：\n  - $\\mathbf{R}^{k} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$\n  - $\\mathbf{K}^{k} = \\mathrm{diag}(1,-1) = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}$\n\n现在根据所需标准对问题陈述进行验证。\n1.  **科学依据**：该问题明确属于计算力学和数值优化的范畴。势能、残差、切线刚度、牛顿法和线搜索策略等概念是该领域的基础。所提供的切线矩阵 $\\mathbf{K}^{k}$ 是不定的，这是一个关键特征，代表了非凸能量形貌（例如鞍点）。这在结构稳定性和材料失效分析中是一个科学上现实且重要的情景，标准求解算法可能会遇到困难。该问题在科学上是合理的。\n2.  **适定性**：该问题提供了执行所要求的推导和计算所需的所有必要数据和定义。它是自洽的且无矛盾。问题是精确的，并能导出一个唯一且有意义的解。\n3.  **客观性**：该问题使用精确、客观的数学语言表述。没有主观或基于观点的陈述。\n\n该问题因其科学依据充分、适定且客观而被视为有效。没有可识别的缺陷。现在开始求解过程。\n\n第一个任务是计算牛顿方向 $\\mathbf{p}^{k}$。给定 $\\mathbf{K}^{k}\\mathbf{p}^{k} = -\\mathbf{R}^{k}$，我们求解 $\\mathbf{p}^{k}$：\n$$\n\\mathbf{p}^{k} = -(\\mathbf{K}^{k})^{-1}\\mathbf{R}^{k}\n$$\n切线矩阵是 $\\mathbf{K}^{k} = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}$。其逆矩阵是 $(\\mathbf{K}^{k})^{-1} = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}$，与 $\\mathbf{K}^{k}$ 相同。\n对于 $\\mathbf{R}^{k} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$，方向是：\n$$\n\\mathbf{p}^{k} = - \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = - \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}\n$$\n\n接下来，我们推导势能变化的表达式，$\\Delta \\Pi(\\alpha) = \\Pi(\\mathbf{u}(\\alpha)) - \\Pi(\\mathbf{u}^{k})$。\n使用所提供的二次模型和增量 $\\mathbf{s} = \\alpha \\mathbf{p}^{k}$：\n$$\n\\Delta \\Pi(\\alpha) = \\mathbf{R}^{k\\top}(\\alpha \\mathbf{p}^{k}) + \\frac{1}{2}(\\alpha \\mathbf{p}^{k})^{\\top}\\mathbf{K}^{k}(\\alpha \\mathbf{p}^{k}) = \\alpha (\\mathbf{R}^{k\\top}\\mathbf{p}^{k}) + \\frac{1}{2}\\alpha^{2} (\\mathbf{p}^{k\\top}\\mathbf{K}^{k}\\mathbf{p}^{k})\n$$\n我们计算标量积：\n$\\Pi$ 在 $\\mathbf{u}^k$ 处沿 $\\mathbf{p}^{k}$ 的方向导数是 $\\mathbf{R}^{k\\top}\\mathbf{p}^{k}$：\n$$\n\\mathbf{R}^{k\\top}\\mathbf{p}^{k} = \\begin{pmatrix} 1  2 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix} = (1)(-1) + (2)(2) = -1 + 4 = 3\n$$\n二次项是 $\\mathbf{p}^{k\\top}\\mathbf{K}^{k}\\mathbf{p}^{k}$。使用定义 $\\mathbf{K}^{k}\\mathbf{p}^{k} = -\\mathbf{R}^{k}$：\n$$\n\\mathbf{p}^{k\\top}\\mathbf{K}^{k}\\mathbf{p}^{k} = \\mathbf{p}^{k\\top}(-\\mathbf{R}^{k}) = -(\\mathbf{p}^{k\\top}\\mathbf{R}^{k}) = -(\\mathbf{R}^{k\\top}\\mathbf{p}^{k}) = -3\n$$\n将这些值代回 $\\Delta \\Pi(\\alpha)$ 的表达式中：\n$$\n\\Delta \\Pi(\\alpha) = 3\\alpha - \\frac{3}{2}\\alpha^{2}\n$$\n由于方向导数 $\\mathbf{R}^{k\\top}\\mathbf{p}^{k} = 3 > 0$，牛顿方向 $\\mathbf{p}^{k}$ 是势能 $\\Pi$ 的一个上升方向。\n\n接下来，我们推导基于残差的优值函数 $M(\\alpha) = \\frac{1}{2}\\|\\mathbf{R}(\\mathbf{u}(\\alpha))\\|_{2}^{2}$ 的表达式。\n使用残差的精确线性模型和 $\\mathbf{s} = \\alpha \\mathbf{p}^{k}$：\n$$\n\\mathbf{R}(\\mathbf{u}(\\alpha)) = \\mathbf{R}(\\mathbf{u}^{k} + \\alpha\\mathbf{p}^{k}) = \\mathbf{R}^{k} + \\alpha \\mathbf{K}^{k}\\mathbf{p}^{k}\n$$\n代入 $\\mathbf{K}^{k}\\mathbf{p}^{k} = -\\mathbf{R}^{k}$：\n$$\n\\mathbf{R}(\\mathbf{u}(\\alpha)) = \\mathbf{R}^{k} + \\alpha(-\\mathbf{R}^{k}) = (1-\\alpha)\\mathbf{R}^{k}\n$$\n现在我们计算优值函数：\n$$\nM(\\alpha) = \\frac{1}{2}\\|(1-\\alpha)\\mathbf{R}^{k}\\|_{2}^{2} = \\frac{1}{2}(1-\\alpha)^{2}\\|\\mathbf{R}^{k}\\|_{2}^{2}\n$$\n我们计算初始残差的范数平方：$\\|\\mathbf{R}^{k}\\|_{2}^{2} = 1^{2} + 2^{2} = 5$。\n因此，优值函数为：\n$$\nM(\\alpha) = \\frac{5}{2}(1-\\alpha)^{2}\n$$\n\n现在我们必须证明存在一个 $\\alpha$ 的非空区间，其中 $\\Delta \\Pi(\\alpha) > 0$ 而 $M(\\alpha)$ 严格递减。\n条件 $\\Delta \\Pi(\\alpha) > 0$ 变为 $3\\alpha - \\frac{3}{2}\\alpha^{2} > 0$，可化简为 $\\frac{3}{2}\\alpha(2-\\alpha) > 0$。对于 $\\alpha > 0$，这要求 $2-\\alpha > 0$，所以 $\\alpha \\in (0, 2)$。\n为了使 $M(\\alpha)$ 严格递减，其关于 $\\alpha$ 的导数必须为负。\n$$\n\\frac{dM}{d\\alpha} = \\frac{d}{d\\alpha}\\left(\\frac{5}{2}(1-\\alpha)^{2}\\right) = \\frac{5}{2} \\cdot 2(1-\\alpha)(-1) = -5(1-\\alpha)\n$$\n条件 $\\frac{dM}{d\\alpha}  0$ 意味着 $-5(1-\\alpha)  0$，即 $1-\\alpha > 0$，或 $\\alpha  1$。\n两个条件的交集，$\\alpha \\in (0, 2)$ 和 $\\alpha  1$，是区间 $\\alpha \\in (0, 1)$。对于此区间内的任何 $\\alpha$，能量增加 ($\\Delta\\Pi > 0$)，因此基于能量的线搜索会拒绝该步。然而，基于残差的优值函数减少，因此基于 $M(\\alpha)$ 的线搜索会接受这样的步。这证明了该论断。\n\n我们需要计算使势能返回其初始值的最小正步长 $\\alpha$，即 $\\Pi(\\mathbf{u}(\\alpha)) = \\Pi(\\mathbf{u}^{k})$，这等价于 $\\Delta \\Pi(\\alpha) = 0$。\n$$\n3\\alpha - \\frac{3}{2}\\alpha^{2} = 0\n$$\n$$\n\\alpha\\left(3 - \\frac{3}{2}\\alpha\\right) = 0\n$$\n该方程有两个解：$\\alpha = 0$（平凡起始点）和 $3 - \\frac{3}{2}\\alpha = 0$。\n求解非平凡的 $\\alpha$：\n$$\n3 = \\frac{3}{2}\\alpha \\implies \\alpha = 2\n$$\n因此，最小正步长是 $\\alpha = 2$。\n\n最后，关于更合适的接受准则的简明论证。有限元平衡分析的基本目标是找到状态 $\\mathbf{u}^{*}$，在该状态下内力和外力平衡，数学上表示为残差向量为零：$\\mathbf{R}(\\mathbf{u}^{*}) = \\mathbf{0}$。基于残差的优值函数 $M(\\mathbf{u}) = \\frac{1}{2}\\|\\mathbf{R}(\\mathbf{u})\\|_{2}^{2}$ 是专门为衡量实现这一目标的进展而构建的，因为 $M(\\mathbf{u}) \\ge 0$ 且 $M(\\mathbf{u}) = 0$ 当且仅当 $\\mathbf{R}(\\mathbf{u}) = \\mathbf{0}$。因此，确保 M 减少的线搜索直接收敛于一个平衡状态。相比之下，能量减少准则寻求势能 $\\Pi$ 的一个局部最小值。虽然稳定平衡点是局部极小值点，但平衡也可能出现在鞍点或局部极大值点，特别是在涉及失稳和路径跟踪的问题中。如此问题所示，当切线刚度 $\\mathbf{K}^{k}$ 不定时，牛顿方向可能是能量的上升方向，导致基于能量的线搜索失败。然而，基于残差优值的准则仍然有效，并允许算法朝着 $\\mathbf{R}=\\mathbf{0}$ 的解前进（在本例中是在 $\\alpha=1$ 处）。因此，基于残差优值的准则更鲁棒，并且更直接地反映了寻找任何平衡状态（无论稳定与否）的主要目标。", "answer": "$$\n\\boxed{2}\n$$", "id": "2573788"}]}