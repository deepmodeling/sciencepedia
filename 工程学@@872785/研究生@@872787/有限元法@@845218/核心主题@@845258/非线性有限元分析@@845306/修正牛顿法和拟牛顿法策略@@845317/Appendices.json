{"hands_on_practices": [{"introduction": "在我们深入研究数值算法之前，理解它们所用近似的数学起源至关重要。本练习要求您分析推导一维非线性杆的真实（一致）切线刚度与简单前向差分（割线）近似之间的误差。通过这个推导过程，您将对截断误差有一个第一性原理的理解，这是所有拟牛顿方法核心的权衡所在。[@problem_id:2580611]", "problem": "考虑一根长度为 $L$、横截面积为常数 $A$ 的一维杆，其左端固定，右端承受规定的位移 $u$。使用具有线性形函数的有限元方法（FEM），使得轴向应变场是均匀的，并由 $\\varepsilon(u)=u/L$ 给出。材料遵循非线性本构关系 $\\sigma=\\sigma(\\varepsilon)$，与 $u$ 共轭的内节点力为 $f_{\\text{int}}(u)$。\n\n在牛顿型迭代中，一致切线刚度是精确导数 $K_{\\text{t}}(u)=\\mathrm{d}f_{\\text{int}}(u)/\\mathrm{d}u$。在准牛顿或修正牛顿策略中，可以用前向差分正割刚度 $K_{\\text{sec}}(u;h)=\\big(f_{\\text{int}}(u+h)-f_{\\text{int}}(u)\\big)/h$ 来近似它，其中 $h$ 是广义位移 $u$ 的一个小增量。\n\n从虚功原理和杆单元内力的标准有限元定义出发，并设非线性应力-应变关系为三次多项式\n$$\n\\sigma(\\varepsilon)=E\\,\\varepsilon+\\alpha\\,\\varepsilon^{2}+\\beta\\,\\varepsilon^{3},\n$$\n其中 $E0$、$\\alpha$ 和 $\\beta$ 为常数，推导差值\n$$\n\\Delta k(u;h)=K_{\\text{sec}}(u;h)-K_{\\text{t}}(u)\n$$\n的精确闭式表达式，用 $A$、$L$、$E$、$\\alpha$、$\\beta$、$u$ 和 $h$ 表示。您的最终答案必须是单一的闭式解析表达式。不要四舍五入。最终的方框答案中不要包含单位。", "solution": "所述问题具有科学依据，提法恰当且客观。所有必要的数据和定义都已提供，没有内部矛盾或含糊之处。该问题完全属于非线性计算力学和有限元方法的范畴。它提出了一个标准的、尽管详细的计算任务，可以通过数学推导进行验证。因此，该问题是有效的，我将着手解决。\n\n推导始于虚功原理，该原理指出，内虚功 $\\delta W_{\\text{int}}$ 等于应力 $\\sigma$ 乘以虚应变 $\\delta\\varepsilon$ 在物体体积 $V$ 上的积分。对于指定的一维杆，这可以写成：\n$$\n\\delta W_{\\text{int}} = \\int_{V} \\sigma \\, \\delta\\varepsilon \\, dV\n$$\n给定恒定的横截面积 $A$，体积元为 $dV = A \\, dx$。问题指出，由于使用线性形函数，轴向应变场是均匀的。应变由 $\\varepsilon = u/L$ 给出，其中 $u$ 是右端的位移，$L$ 是杆的长度。因此，虚应变也是均匀的：$\\delta\\varepsilon = \\delta u / L$。将这些代入虚功积分，积分范围为杆的长度从 $x=0$ 到 $x=L$：\n$$\n\\delta W_{\\text{int}} = \\int_{0}^{L} \\sigma(\\varepsilon) \\, \\delta\\varepsilon \\, A \\, dx\n$$\n由于 $\\sigma(\\varepsilon)$ 和 $\\delta\\varepsilon$ 相对于空间坐标 $x$ 是常数，因此可以将它们移到积分符号外：\n$$\n\\delta W_{\\text{int}} = \\sigma\\left(\\frac{u}{L}\\right) \\frac{\\delta u}{L} A \\int_{0}^{L} dx = \\sigma\\left(\\frac{u}{L}\\right) \\frac{\\delta u}{L} A L = A \\, \\sigma\\left(\\frac{u}{L}\\right) \\delta u\n$$\n内虚功也可以用与位移 $u$ 共轭的内节点力 $f_{\\text{int}}(u)$ 表示为 $\\delta W_{\\text{int}} = f_{\\text{int}}(u) \\, \\delta u$。通过比较 $\\delta W_{\\text{int}}$ 的两个表达式，我们确定内力为：\n$$\nf_{\\text{int}}(u) = A \\, \\sigma\\left(\\frac{u}{L}\\right)\n$$\n给定的非线性本构应力-应变关系为：\n$$\n\\sigma(\\varepsilon) = E\\,\\varepsilon + \\alpha\\,\\varepsilon^{2} + \\beta\\,\\varepsilon^{3}\n$$\n将 $\\varepsilon = u/L$ 代入此关系式，然后再代入 $f_{\\text{int}}(u)$ 的表达式，我们得到内力作为位移 $u$ 的函数的显式形式：\n$$\nf_{\\text{int}}(u) = A \\left[ E\\left(\\frac{u}{L}\\right) + \\alpha\\left(\\frac{u}{L}\\right)^{2} + \\beta\\left(\\frac{u}{L}\\right)^{3} \\right]\n$$\n$$\nf_{\\text{int}}(u) = \\frac{AE}{L}u + \\frac{A\\alpha}{L^{2}}u^{2} + \\frac{A\\beta}{L^{3}}u^{3}\n$$\n接下来，我们推导一致切线刚度 $K_{\\text{t}}(u)$，它是内力对位移的精确导数：\n$$\nK_{\\text{t}}(u) = \\frac{\\mathrm{d}f_{\\text{int}}(u)}{\\mathrm{d}u} = \\frac{\\mathrm{d}}{\\mathrm{d}u} \\left( \\frac{AE}{L}u + \\frac{A\\alpha}{L^{2}}u^{2} + \\frac{A\\beta}{L^{3}}u^{3} \\right)\n$$\n逐项求导得到：\n$$\nK_{\\text{t}}(u) = \\frac{AE}{L} + \\frac{2A\\alpha}{L^{2}}u + \\frac{3A\\beta}{L^{3}}u^{2}\n$$\n现在，我们推导前向差分正割刚度 $K_{\\text{sec}}(u;h)$，其定义为：\n$$\nK_{\\text{sec}}(u;h) = \\frac{f_{\\text{int}}(u+h)-f_{\\text{int}}(u)}{h}\n$$\n首先，我们求出 $f_{\\text{int}}(u+h)$ 的表达式：\n$$\nf_{\\text{int}}(u+h) = \\frac{AE}{L}(u+h) + \\frac{A\\alpha}{L^{2}}(u+h)^{2} + \\frac{A\\beta}{L^{3}}(u+h)^{3}\n$$\n我们展开多项式项：\n$$\n(u+h)^{2} = u^{2} + 2uh + h^{2}\n$$\n$$\n(u+h)^{3} = u^{3} + 3u^{2}h + 3uh^{2} + h^{3}\n$$\n将这些代回 $f_{\\text{int}}(u+h)$：\n$$\nf_{\\text{int}}(u+h) = \\frac{AE}{L}(u+h) + \\frac{A\\alpha}{L^{2}}(u^{2} + 2uh + h^{2}) + \\frac{A\\beta}{L^{3}}(u^{3} + 3u^{2}h + 3uh^{2} + h^{3})\n$$\n那么差值 $f_{\\text{int}}(u+h) - f_{\\text{int}}(u)$ 为：\n\\begin{align*}\nf_{\\text{int}}(u+h) - f_{\\text{int}}(u) = \\left( \\frac{AE}{L}(u+h) - \\frac{AE}{L}u \\right) + \\left( \\frac{A\\alpha}{L^{2}}(u^{2} + 2uh + h^{2}) - \\frac{A\\alpha}{L^{2}}u^{2} \\right) + \\left( \\frac{A\\beta}{L^{3}}(u^{3} + 3u^{2}h + 3uh^{2} + h^{3}) - \\frac{A\\beta}{L^{3}}u^{3} \\right) \\\\\n= \\frac{AEh}{L} + \\frac{A\\alpha}{L^{2}}(2uh + h^{2}) + \\frac{A\\beta}{L^{3}}(3u^{2}h + 3uh^{2} + h^{3})\n\\end{align*}\n除以 $h$ 得到正割刚度 $K_{\\text{sec}}(u;h)$：\n$$\nK_{\\text{sec}}(u;h) = \\frac{AE}{L} + \\frac{A\\alpha}{L^{2}}(2u + h) + \\frac{A\\beta}{L^{3}}(3u^{2} + 3uh + h^{2})\n$$\n$$\nK_{\\text{sec}}(u;h) = \\frac{AE}{L} + \\frac{2A\\alpha}{L^{2}}u + \\frac{A\\alpha}{L^{2}}h + \\frac{3A\\beta}{L^{3}}u^{2} + \\frac{3A\\beta}{L^{3}}uh + \\frac{A\\beta}{L^{3}}h^{2}\n$$\n最后，我们计算所需的差值 $\\Delta k(u;h) = K_{\\text{sec}}(u;h) - K_{\\text{t}}(u)$：\n$$\n\\Delta k(u;h) = \\left( \\frac{AE}{L} + \\frac{2A\\alpha}{L^{2}}u + \\frac{A\\alpha h}{L^{2}} + \\frac{3A\\beta}{L^{3}}u^{2} + \\frac{3A\\beta uh}{L^{3}} + \\frac{A\\beta h^{2}}{L^{3}} \\right) - \\left( \\frac{AE}{L} + \\frac{2A\\alpha}{L^{2}}u + \\frac{3A\\beta}{L^{3}}u^{2} \\right)\n$$\n对应于 $K_{\\text{t}}(u)$ 的项相互抵消，剩下：\n$$\n\\Delta k(u;h) = \\frac{A\\alpha h}{L^{2}} + \\frac{3A\\beta uh}{L^{3}} + \\frac{A\\beta h^{2}}{L^{3}}\n$$\n为了清晰起见，可以对该表达式进行因式分解。我们可以提出公因式 $\\frac{Ah}{L^{2}}$：\n$$\n\\Delta k(u;h) = \\frac{Ah}{L^{2}} \\left( \\alpha + \\frac{3\\beta u}{L} + \\frac{\\beta h}{L} \\right)\n$$\n进一步因式分解得到最终的闭式表达式：\n$$\n\\Delta k(u;h) = \\frac{Ah}{L^{2}} \\left( \\alpha + \\frac{\\beta}{L}(3u + h) \\right)\n$$\n这表示在给定非线性材料模型下，刚度的前向差分近似与真实切线刚度之间的误差，误差是关于 $h$ 的一阶量。", "answer": "$$\n\\boxed{\\frac{Ah}{L^{2}} \\left( \\alpha + \\frac{\\beta}{L}(3u + h) \\right)}\n$$", "id": "2580611"}, {"introduction": "既然我们对近似误差有了分析上的感觉，现在让我们通过数值方法观察它们对收敛性的影响。这个问题将引导您完成完整牛顿法和最简单的拟牛顿策略——采用“冻结”切线的修正牛顿法的两次迭代。通过逐步比较残差的减少情况，您将直观地理解不重新组装切线矩阵所带来的计算节省与其导致的收敛速率减慢之间的权衡。[@problem_id:2580609]", "problem": "考虑一个简化的双自由度有限元 (FE) 系统产生的非线性平衡方程，其中残差向量 $\\boldsymbol{R}(\\boldsymbol{u}) \\in \\mathbb{R}^{2}$ 的分量定义如下：\n$$\nR_{1}(\\boldsymbol{u}) \\equiv 2\\,u_{1} + \\tfrac{1}{2}\\,u_{1}^{2} + 0.1\\,u_{2}^{2} - 1.2, \\quad\nR_{2}(\\boldsymbol{u}) \\equiv -0.3\\,u_{1} + 1.5\\,u_{2} + 0.2\\,u_{1}\\,u_{2} + 0.1\\,u_{2}^{3} - 0.9,\n$$\n初始猜测值为 $\\boldsymbol{u}_{0} = (0,0)^{\\mathsf{T}}$。一致切线（雅可比）矩阵 $\\boldsymbol{K}(\\boldsymbol{u}) = \\partial \\boldsymbol{R}/\\partial \\boldsymbol{u}$ 为\n$$\n\\boldsymbol{K}(\\boldsymbol{u}) = \n\\begin{pmatrix}\n2 + u_{1}  0.2\\,u_{2} \\\\\n-0.3 + 0.2\\,u_{2}  1.5 + 0.2\\,u_{1} + 0.3\\,u_{2}^{2}\n\\end{pmatrix},\n$$\n在初始猜测值处，该矩阵为\n$$\n\\boldsymbol{K}(\\boldsymbol{u}_{0}) = \n\\begin{pmatrix}\n2  0 \\\\\n-0.3  1.5\n\\end{pmatrix}.\n$$\n从 $\\boldsymbol{u}_{0}$ 开始，对以下每种策略各执行两次迭代：\n- 全 Newton 法：$\\boldsymbol{u}_{k+1} = \\boldsymbol{u}_{k} - \\boldsymbol{K}(\\boldsymbol{u}_{k})^{-1}\\,\\boldsymbol{R}(\\boldsymbol{u}_{k})$。\n- 修正 Newton 法（一种使用冻结切线的拟 Newton 策略）：$\\boldsymbol{u}_{k+1} = \\boldsymbol{u}_{k} - \\boldsymbol{K}(\\boldsymbol{u}_{0})^{-1}\\,\\boldsymbol{R}(\\boldsymbol{u}_{k})$。\n\n对于每种策略，将第 $k$ 次迭代的欧几里得残差缩减因子定义为\n$$\n\\rho_{k} \\equiv \\frac{\\|\\boldsymbol{R}(\\boldsymbol{u}_{k+1})\\|_{2}}{\\|\\boldsymbol{R}(\\boldsymbol{u}_{k})\\|_{2}},\n$$\n其中 $\\|\\cdot\\|_{2}$ 表示欧几里得范数。从 Newton 线性化原理推导迭代过程，并从基本原理计算所有残差和因子（无线性搜索或阻尼）。\n\n作为最终答案，报告修正 Newton 法的第二次迭代残差缩减因子 $\\rho_{1}$。将最终答案四舍五入到四位有效数字。无需物理单位。", "solution": "该问题要求计算修正 Newton 法在两次迭代后的残差缩减因子 $\\rho_{1}$。通过 Newton 型方法求解非线性方程组 $\\boldsymbol{R}(\\boldsymbol{u}) = \\boldsymbol{0}$ 的一般原理是基于残差向量 $\\boldsymbol{R}$ 在当前迭代点 $\\boldsymbol{u}_{k}$ 附近的一阶泰勒级数展开：\n$$\n\\boldsymbol{R}(\\boldsymbol{u}_{k+1}) \\approx \\boldsymbol{R}(\\boldsymbol{u}_{k}) + \\frac{\\partial \\boldsymbol{R}}{\\partial \\boldsymbol{u}}\\bigg|_{\\boldsymbol{u}_{k}} (\\boldsymbol{u}_{k+1} - \\boldsymbol{u}_{k})\n$$\n将 $\\boldsymbol{R}(\\boldsymbol{u}_{k+1})$ 设为 $\\boldsymbol{0}$，并定义切线矩阵 $\\boldsymbol{K}(\\boldsymbol{u}_{k}) = \\frac{\\partial \\boldsymbol{R}}{\\partial \\boldsymbol{u}}\\big|_{\\boldsymbol{u}_{k}}$ 和位移增量 $\\Delta \\boldsymbol{u}_{k} = \\boldsymbol{u}_{k+1} - \\boldsymbol{u}_{k}$，我们得到关于增量的线性系统：\n$$\n\\boldsymbol{K}(\\boldsymbol{u}_{k}) \\Delta \\boldsymbol{u}_{k} = -\\boldsymbol{R}(\\boldsymbol{u}_{k})\n$$\n则下一个迭代点为 $\\boldsymbol{u}_{k+1} = \\boldsymbol{u}_{k} + \\Delta \\boldsymbol{u}_{k}$。\n对于全 Newton 法，切线矩阵 $\\boldsymbol{K}(\\boldsymbol{u}_{k})$ 在每次迭代 $k$ 中都会重新计算。对于修正 Newton 法，切线矩阵仅在初始猜测值 $\\boldsymbol{u}_{0}$ 处计算一次，然后在所有后续迭代中保持不变（冻结）。因此，迭代更新式为 $\\boldsymbol{u}_{k+1} = \\boldsymbol{u}_{k} - \\boldsymbol{K}(\\boldsymbol{u}_{0})^{-1}\\boldsymbol{R}(\\boldsymbol{u}_{k})$。\n\n我们从初始猜测值 $\\boldsymbol{u}_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 开始。\n\n**初始状态 ($k=0$)**\n\n首先，计算初始残差向量 $\\boldsymbol{R}(\\boldsymbol{u}_{0})$：\n$$\nR_{1}(\\boldsymbol{u}_{0}) = 2(0) + \\frac{1}{2}(0)^{2} + 0.1(0)^{2} - 1.2 = -1.2\n$$\n$$\nR_{2}(\\boldsymbol{u}_{0}) = -0.3(0) + 1.5(0) + 0.2(0)(0) + 0.1(0)^{3} - 0.9 = -0.9\n$$\n因此，$\\boldsymbol{R}(\\boldsymbol{u}_{0}) = \\begin{pmatrix} -1.2 \\\\ -0.9 \\end{pmatrix}$。\n初始残差的欧几里得范数为：\n$$\n\\|\\boldsymbol{R}(\\boldsymbol{u}_{0})\\|_{2} = \\sqrt{(-1.2)^{2} + (-0.9)^{2}} = \\sqrt{1.44 + 0.81} = \\sqrt{2.25} = 1.5\n$$\n初始猜测值处的切线矩阵为：\n$$\n\\boldsymbol{K}_{0} = \\boldsymbol{K}(\\boldsymbol{u}_{0}) = \\begin{pmatrix} 2  0 \\\\ -0.3  1.5 \\end{pmatrix}\n$$\n该矩阵的行列式为 $\\det(\\boldsymbol{K}_{0}) = (2)(1.5) - (0)(-0.3) = 3$。其逆矩阵为：\n$$\n\\boldsymbol{K}_{0}^{-1} = \\frac{1}{3} \\begin{pmatrix} 1.5  0 \\\\ 0.3  2 \\end{pmatrix} = \\begin{pmatrix} 0.5  0 \\\\ 0.1  \\frac{2}{3} \\end{pmatrix}\n$$\n\n**第一次迭代 ($k=0$)**\n\n此次迭代对于全 Newton 法和修正 Newton 法是相同的。我们求解 $\\boldsymbol{K}_{0} \\Delta \\boldsymbol{u}_{0} = -\\boldsymbol{R}(\\boldsymbol{u}_{0})$。\n$$\n\\Delta \\boldsymbol{u}_{0} = -\\boldsymbol{K}_{0}^{-1} \\boldsymbol{R}(\\boldsymbol{u}_{0}) = -\\begin{pmatrix} 0.5  0 \\\\ 0.1  \\frac{2}{3} \\end{pmatrix} \\begin{pmatrix} -1.2 \\\\ -0.9 \\end{pmatrix} = -\\begin{pmatrix} 0.5(-1.2) \\\\ 0.1(-1.2) + \\frac{2}{3}(-0.9) \\end{pmatrix} = -\\begin{pmatrix} -0.6 \\\\ -0.12 - 0.6 \\end{pmatrix} = \\begin{pmatrix} 0.6 \\\\ 0.72 \\end{pmatrix}\n$$\n第一个更新后的位移向量为：\n$$\n\\boldsymbol{u}_{1} = \\boldsymbol{u}_{0} + \\Delta \\boldsymbol{u}_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0.6 \\\\ 0.72 \\end{pmatrix} = \\begin{pmatrix} 0.6 \\\\ 0.72 \\end{pmatrix}\n$$\n接下来，我们计算在 $\\boldsymbol{u}_{1}$ 处的残差：\n$$\nR_{1}(\\boldsymbol{u}_{1}) = 2(0.6) + \\frac{1}{2}(0.6)^{2} + 0.1(0.72)^{2} - 1.2 = 1.2 + 0.5(0.36) + 0.1(0.5184) - 1.2 = 0.18 + 0.05184 = 0.23184\n$$\n$$\nR_{2}(\\boldsymbol{u}_{1}) = -0.3(0.6) + 1.5(0.72) + 0.2(0.6)(0.72) + 0.1(0.72)^{3} - 0.9 = -0.18 + 1.08 + 0.0864 + 0.1(0.373248) - 0.9 = 0.0864 + 0.0373248 = 0.1237248\n$$\n因此，$\\boldsymbol{R}(\\boldsymbol{u}_{1}) = \\begin{pmatrix} 0.23184 \\\\ 0.1237248 \\end{pmatrix}$。该残差的范数为：\n$$\n\\|\\boldsymbol{R}(\\boldsymbol{u}_{1})\\|_{2} = \\sqrt{(0.23184)^{2} + (0.1237248)^{2}} = \\sqrt{0.0537498256 + 0.01530782611584} = \\sqrt{0.06905765171584} \\approx 0.2627885994\n$$\n该值将作为缩减因子 $\\rho_{1}$ 的分母。\n\n**第二次迭代 ($k=1$) - 修正 Newton 法**\n\n对于修正 Newton 法，我们使用冻结的切线矩阵 $\\boldsymbol{K}_{0}$。我们求解 $\\boldsymbol{K}_{0} \\Delta \\boldsymbol{u}_{1} = -\\boldsymbol{R}(\\boldsymbol{u}_{1})$。\n$$\n\\Delta \\boldsymbol{u}_{1} = -\\boldsymbol{K}_{0}^{-1} \\boldsymbol{R}(\\boldsymbol{u}_{1}) = -\\begin{pmatrix} 0.5  0 \\\\ 0.1  \\frac{2}{3} \\end{pmatrix} \\begin{pmatrix} 0.23184 \\\\ 0.1237248 \\end{pmatrix} = -\\begin{pmatrix} 0.5(0.23184) \\\\ 0.1(0.23184) + \\frac{2}{3}(0.1237248) \\end{pmatrix} = -\\begin{pmatrix} 0.11592 \\\\ 0.023184 + 0.0824832 \\end{pmatrix} = \\begin{pmatrix} -0.11592 \\\\ -0.1056672 \\end{pmatrix}\n$$\n第二个更新后的位移向量为：\n$$\n\\boldsymbol{u}_{2} = \\boldsymbol{u}_{1} + \\Delta \\boldsymbol{u}_{1} = \\begin{pmatrix} 0.6 \\\\ 0.72 \\end{pmatrix} + \\begin{pmatrix} -0.11592 \\\\ -0.1056672 \\end{pmatrix} = \\begin{pmatrix} 0.48408 \\\\ 0.6143328 \\end{pmatrix}\n$$\n现在我们计算在 $\\boldsymbol{u}_{2}$ 处的残差：\n$$\nR_{1}(\\boldsymbol{u}_{2}) = 2(0.48408) + \\frac{1}{2}(0.48408)^{2} + 0.1(0.6143328)^{2} - 1.2\n$$\n$$\nR_{1}(\\boldsymbol{u}_{2}) = 0.96816 + 0.5(0.2343334464) + 0.1(0.3774048590378304) - 1.2 = 0.96816 + 0.1171667232 + 0.0377404859 - 1.2 \\approx -0.0769327909\n$$\n$$\nR_{2}(\\boldsymbol{u}_{2}) = -0.3(0.48408) + 1.5(0.6143328) + 0.2(0.48408)(0.6143328) + 0.1(0.6143328)^{3} - 0.9\n$$\n$$\nR_{2}(\\boldsymbol{u}_{2}) = -0.145224 + 0.9214992 + 0.2(0.297440535936) + 0.1(0.231846067341235...) - 0.9 \\approx -0.145224 + 0.9214992 + 0.0594881072 + 0.0231846067 - 0.9 \\approx -0.0410520861\n$$\n残差向量为 $\\boldsymbol{R}(\\boldsymbol{u}_{2}) \\approx \\begin{pmatrix} -0.07693279 \\\\ -0.04105209 \\end{pmatrix}$。其范数为：\n$$\n\\|\\boldsymbol{R}(\\boldsymbol{u}_{2})\\|_{2} \\approx \\sqrt{(-0.07693279)^{2} + (-0.04105209)^{2}} = \\sqrt{0.0059186546 + 0.0016852731} = \\sqrt{0.0076039277} \\approx 0.0872005029\n$$\n最后，第二次迭代（$k=1$）的残差缩减因子定义为：\n$$\n\\rho_{1} = \\frac{\\|\\boldsymbol{R}(\\boldsymbol{u}_{2})\\|_{2}}{\\|\\boldsymbol{R}(\\boldsymbol{u}_{1})\\|_{2}} \\approx \\frac{0.0872005029}{0.2627885994} \\approx 0.33182046\n$$\n四舍五入到四位有效数字，我们得到 $0.3318$。", "answer": "$$ \\boxed{0.3318} $$", "id": "2580609"}, {"introduction": "在实际的有限元分析中，我们经常使用非精确牛顿法，其中每一步的线性系统都通过迭代（例如，使用 GMRES）来求解，这引入了另一层近似。最后一个练习呈现了一个已停滞的模拟的真实收敛历史，并要求您诊断其根本原因。这个练习超越了简单的计算，旨在培养关键的工程排错技能，迫使您分析非线性求解器、线性求解器和全局化策略之间的相互作用。[@problem_id:2580751]", "problem": "一个带内变量的非线性有限元平衡问题，在单个载荷步下，使用带有回溯线搜索和迭代线性求解器的全局化牛顿框架进行求解。有限元残差用 $R(u)$ 表示，一致切线（雅可比矩阵）在下面指定的情况下会重新计算。迭代线性求解器是广义最小残差（GMRES）方法，通过不完全分解进行预处理。线搜索强制执行充分下降条件；如果接受了完整步长，步长记录为 $\\alpha_k = 1$。对于每个外层迭代 $k$，非线性残差范数 $\\lVert R_k \\rVert$（在一致的能量范数下测量）和选定的算法诊断信息记录如下：\n\n- $k = 0$：$\\lVert R_0 \\rVert = 1.2 \\times 10^{1}$；重新计算切线；当 $\\lVert J_0 s_0 + R_0 \\rVert / \\lVert R_0 \\rVert \\le 1.0 \\times 10^{-2}$ 时 GMRES 终止；接受步长 $\\alpha_0 = 1$；得到 $\\lVert R_1 \\rVert = 2.3$。\n- $k = 1$：重新计算切线；GMRES 终止条件同上，相对线性残差 $\\le 1.0 \\times 10^{-2}$；接受步长 $\\alpha_1 = 1$；得到 $\\lVert R_2 \\rVert = 4.8 \\times 10^{-1}$。\n- $k = 2$：重新计算切线；GMRES 终止条件同上；接受步长 $\\alpha_2 = 1$；得到 $\\lVert R_3 \\rVert = 1.1 \\times 10^{-1}$。\n- $k = 3$：重新计算切线；GMRES 终止条件同上；接受步长 $\\alpha_3 = 1$；得到 $\\lVert R_4 \\rVert = 2.7 \\times 10^{-2}$。\n- $k = 4$：重新计算切线；GMRES 终止条件同上；接受步长 $\\alpha_4 = 1$；得到 $\\lVert R_5 \\rVert = 2.5 \\times 10^{-2}$。\n- $k = 5$：重新计算切线；GMRES 终止条件同上；接受步长 $\\alpha_5 = 1$；得到 $\\lVert R_6 \\rVert = 2.4 \\times 10^{-2}$。\n\n在任何迭代中均未报告回溯，并且每个外层迭代步的 GMRES 迭代次数保持近似恒定。规定的非线性收敛容差为 $\\lVert R_k \\rVert \\le 1.0 \\times 10^{-8}$。\n\n基于对有限元背景下牛顿类方法的第一性原理分析，诊断在 $\\lVert R_k \\rVert \\approx 2.4 \\times 10^{-2}$ 附近观测到的停滞现象的最可能的主要原因，并选择提供一致且有效的纠正措施的选项。\n\nA. 停滞是由于非精确线性求解，其驱动项（forcing term）的下界为 $10^{-2}$；自适应地收紧线性求解精度，使得相对线性残差 $\\eta_k$ 随 $\\lVert R_k \\rVert$ 的减小而减小（例如，使用 Eisenstat–Walker forcing sequence），将任何硬性下限降低到 $10^{-6}$ 以下，并改进预处理以使 GMRES 能够满足更严格的容差。\n\nB. 停滞是由于使用冻结雅可比矩阵的修正牛顿法策略导致的不良切线；切换到完全牛顿法（即每次迭代都重新计算切线）或 Broyden-Fletcher-Goldfarb-Shanno (BFGS) 拟牛顿更新，以恢复超线性收敛。\n\nC. 停滞是由于过于保守的线搜索拒绝了完整步长；放宽充分下降参数以接受更大的 $\\alpha_k$，或用信赖域方法替换线搜索以避免步长裁剪。\n\nD. 停滞是由于非凸性导致了不定切线和上升方向；添加 Levenberg–Marquardt 阻尼以强制正定性并确保下降方向，即使这会增加线搜索回溯的次数。", "solution": "在进行求解之前，对问题陈述进行验证。\n\n步骤1：提取已知条件\n- 方法：用于非线性有限元平衡问题的全局化牛顿框架。\n- 全局化策略：强制执行充分下降条件的回溯线搜索。完整步长用 $\\alpha_k = 1$ 表示。\n- 残差：$R(u)$。\n- 切线/雅可比矩阵：$J_k$。在每次指定的迭代中重新计算。\n- 线性求解器：迭代的广义最小残差（GMRES）方法，采用不完全分解预处理。\n- 线性求解器终止准则：对于所有迭代 $k$，$ \\lVert J_k s_k + R_k \\rVert / \\lVert R_k \\rVert \\le 1.0 \\times 10^{-2}$。\n- 非线性收敛容差：$\\lVert R_k \\rVert \\le 1.0 \\times 10^{-8}$。\n- 迭代历史：\n  - $k=0$：$\\lVert R_0 \\rVert = 1.2 \\times 10^{1}$；重新计算切线；按指定方式进行线性求解；接受步长 $\\alpha_0 = 1$；得到 $\\lVert R_1 \\rVert = 2.3$。\n  - $k=1$：重新计算切线；按指定方式进行线性求解；接受步长 $\\alpha_1 = 1$；得到 $\\lVert R_2 \\rVert = 4.8 \\times 10^{-1}$。\n  - $k=2$：重新计算切线；按指定方式进行线性求解；接受步长 $\\alpha_2 = 1$；得到 $\\lVert R_3 \\rVert = 1.1 \\times 10^{-1}$。\n  - $k=3$：重新计算切线；按指定方式进行线性求解；接受步长 $\\alpha_3 = 1$；得到 $\\lVert R_4 \\rVert = 2.7 \\times 10^{-2}$。\n  - $k=4$：重新计算切线；按指定方式进行线性求解；接受步长 $\\alpha_4 = 1$；得到 $\\lVert R_5 \\rVert = 2.5 \\times 10^{-2}$。\n  - $k=5$：重新计算切线；按指定方式进行线性求解；接受步长 $\\alpha_5 = 1$；得到 $\\lVert R_6 \\rVert = 2.4 \\times 10^{-2}$。\n- 附加观察：未报告回溯。每个外层迭代步的 GMRES 迭代次数保持近似恒定。\n\n步骤2：使用提取的已知条件进行验证\n- 科学依据：该问题描述了一种应用于非线性有限元问题的标准不精确牛ton法。GMRES、线搜索的使用以及观测到的收敛行为，是计算科学与工程领域中科学上真实且有据可查的现象。\n- 适定性：问题提供了足够的数值数据来诊断一个常见的性能问题，并要求找出最可能的原因和纠正措施。从所提供的信息可以得出一个唯一的、合乎逻辑的结论。\n- 客观性：问题以精确、客观和定量的语言陈述。\n\n该问题具有科学依据、适定性和客观性，其核心陈述中没有明显的缺陷、矛盾或含糊之处。所提供的数据是一致的，足以进行分析。\n\n步骤3：结论与行动\n问题有效。将推导出解决方案。\n\n该算法的核心是不精确牛顿迭代。在每个外层迭代 $k$ 中，我们通过近似求解以下线性系统来寻找位移更新量 $s_k$：\n$$ J_k s_k = -R_k $$\n其中 $J_k = J(u_k)$ 是在当前位移迭代点 $u_k$ 处的雅可比矩阵，$R_k = R(u_k)$ 是残差向量。后续的更新为 $u_{k+1} = u_k + \\alpha_k s_k$。\n\n问题陈述指出，在每次迭代（$k = 0, 1, 2, 3, 4, 5$）中都会重新计算切线。这构成了一个完全牛顿法，而不是切线保持不变或被近似的修正牛顿法或拟牛顿法。\n\n该线性系统使用 GMRES 进行迭代求解，直到相对线性残差满足：\n$$ \\frac{\\lVert J_k s_k + R_k \\rVert}{\\lVert R_k \\rVert} \\le \\eta_k $$\n根据给定数据，对于所有的 $k$，驱动项 $\\eta_k$ 是一个常数：\n$$ \\eta_k = 1.0 \\times 10^{-2} $$\n\n让我们分析收敛行为。\n残差范数的收敛过程如下：$12 \\to 2.3 \\to 0.48 \\to 0.11 \\to 0.027 \\to 0.025 \\to 0.024$。\n收敛最初是线性的：\n- $\\lVert R_1 \\rVert / \\lVert R_0 \\rVert \\approx 2.3/12 \\approx 0.19$\n- $\\lVert R_2 \\rVert / \\lVert R_1 \\rVert \\approx 0.48/2.3 \\approx 0.21$\n- $\\lVert R_3 \\rVert / \\lVert R_2 \\rVert \\approx 0.11/0.48 \\approx 0.23$\n完全牛顿法在接近解时应表现出二次收敛。观测到的线性收敛是问题出现的第一个迹象。\n\n然后收敛发生停滞。残差范数在 $2.4 \\times 10^{-2}$ 附近徘徊，远未达到期望的 $1.0 \\times 10^{-8}$ 的容差。\n\n不精确牛顿法的理论为此提供了解释。下一步的残差 $R_{k+1} = R(u_k + \\alpha_k s_k)$，可以通过泰勒级数展开来近似。对于完整步长（$\\alpha_k = 1$），展开式为：\n$$ R_{k+1} = R(u_k + s_k) \\approx R_k + J_k s_k $$\n$R_k + J_k s_k$ 项正是步骤 $k$ 中求解的线性系统的残差。我们将其表示为 $r_k^{\\text{lin}}$。因此，$\\lVert R_{k+1} \\rVert \\approx \\lVert r_k^{\\text{lin}} \\rVert$。GMRES 的停止准则确保了 $\\lVert r_k^{\\text{lin}} \\rVert \\le \\eta_k \\lVert R_k \\rVert$。\n\n这意味着 $\\lVert R_{k+1} \\rVert \\lesssim \\eta_k \\lVert R_k \\rVert$。当 $\\eta_k = 1.0 \\times 10^{-2}$ 时，我们最多只能期望得到收敛率约为 $10^{-2}$ 的线性收敛。观测到的初始收敛率更慢，这在尚未进入渐近区域时是典型现象。\n\n关键在于，要使非线性迭代收敛到高精度，驱动项 $\\eta_k$ 必须在 $k \\to \\infty$ 时趋于零。一个恒定的 $\\eta_k$ 对可达到的精度施加了硬性限制。一旦非线性残差 $\\lVert R_k \\rVert$ 与非精确线性求解引入的误差处于同一数量级，它就無法再进一步减小。因此，停滞水平由 $\\eta_k$ 决定。在本问题中，停滞发生在 $\\lVert R_k \\rVert \\approx 2.4 \\times 10^{-2}$，这与固定的线性求解器容差 $\\eta_k = 1.0 \\times 10^{-2}$ 完全一致。该方法无法进一步减小非线性残差，因为搜索方向 $s_k$ 不够精确。\n\n逐项分析：\n\nA. 这个诊断与上述分析完全一致。恒定的驱动项 $\\eta_k = 1.0 \\times 10^{-2}$ 是停滞的直接原因。建议的纠正措施——使 $\\eta_k$ 自适应，例如通过 Eisenstat–Walker 策略使 $\\eta_k \\propto \\lVert R_k \\rVert$——是在不精确牛顿法中恢复快速（超线性或二次）收敛的标准且正确的方法。改进预处理是有效达到更严格线性容差的必要实践步骤。该选项正确地指出了原因，并提出了一个完整有效的解决方案。**正确**。\n\nB. 这个诊断在事实上是错误的。问题陈述明确指出，对于从 $k=0$ 到 $k=5$ 的每次迭代都“重新计算切线”。所采用的算法已经是完全牛顿法，而不是使用冻结雅可比矩阵的修正牛顿法。因此，提出的“切换到完全牛ton法”的纠正建议是毫无意义的。**错误**。\n\nC. 这个诊断在事实上是错误的。问题陈述明确报告了所有迭代都“接受步长 $\\alpha_k = 1$”。这意味着线搜索每次都接受了完整的牛顿步长，并且从未执行任何回溯或步长缩减（“裁剪”）。线搜索的行为尽可能宽松，而不是保守。提议接受更大的 $\\alpha_k$ 是不可能的，因为 $\\alpha_k$ 已经处于其最大值 1。**错误**。\n\nD. 这个诊断与所提供的数据不一致。如果牛顿方向 $s_k$ 由于不定切线而不再是下降方向，那么线搜索将无法在完整步长下满足充分下降条件。这将强制进行回溯，导致 $\\alpha_k  1$。然而，数据显示所有迭代的 $\\alpha_k=1$，这有力地证明了计算出的搜索方向是有效的下降方向。失败的根源不在于全局化策略（线搜索），而在于不精确牛顿更新的局部收敛性质。**错误**。", "answer": "$$\\boxed{A}$$", "id": "2580751"}]}