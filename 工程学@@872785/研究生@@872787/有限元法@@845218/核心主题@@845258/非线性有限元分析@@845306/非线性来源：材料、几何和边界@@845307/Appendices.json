{"hands_on_practices": [{"introduction": "变形梯度 $F$ 是描述物体从参考构形到当前构形局部变形的数学核心，也是几何非线性分析的基石。本练习 ([@problem_id:2597165]) 将引导你为一个三维实体单元进行一次具体而基础的计算，通过节点位移场，利用等参映射和形函数的概念，一步步求解单元内某一点的变形梯度。这个实践旨在将抽象的运动学理论与有限元中的实际计算联系起来，是掌握非线性分析不可或缺的一步。", "problem": "在一个用于三维实体力学的全拉格朗日（TL）有限元格式中，使用一个八节点三线性六面体单元来模拟运动学非线性变形（几何非线性）。参考（未变形）构型是一个矩形块，其节点坐标在全局材料坐标系 $\\left(X,Y,Z\\right)$ 中给出：\n- 节点 $1$：$\\left(0,0,0\\right)$，\n- 节点 $2$：$\\left(2,0,0\\right)$，\n- 节点 $3$：$\\left(2,1,0\\right)$，\n- 节点 $4$：$\\left(0,1,0\\right)$，\n- 节点 $5$：$\\left(0,0,1.5\\right)$，\n- 节点 $6$：$\\left(2,0,1.5\\right)$，\n- 节点 $7$：$\\left(2,1,1.5\\right)$，\n- 节点 $8$：$\\left(0,1,1.5\\right)$。\n\n在坐标为 $\\left(\\xi,\\eta,\\zeta\\right)\\in[-1,1]^3$ 的父（等参）空间中，节点1到8分别位于标准符号组合 $\\left(\\xi_i,\\eta_i,\\zeta_i\\right)\\in\\{(-1,-1,-1),(+1,-1,-1),(+1,+1,-1),(-1,+1,-1),(-1,-1,+1),(+1,-1,+1),(+1,+1,+1),(-1,+1,+1)\\}$ 处。\n\n1) 从几何和位移均由相同的三线性形函数 $N_i\\left(\\xi,\\eta,\\zeta\\right)$ 插值的基本等参概念出发，根据节点坐标和形函数，推导该单元的显式等参映射 $\\left(X(\\xi,\\eta,\\zeta),Y(\\xi,\\eta,\\zeta),Z(\\xi,\\eta,\\zeta)\\right)$。请明确写出形函数。\n\n2) 在全拉格朗日设定中，当前位置为 $\\boldsymbol{x}\\left(\\boldsymbol{X}\\right)=\\boldsymbol{X}+\\boldsymbol{u}\\left(\\boldsymbol{X}\\right)$，变形梯度为 $\\boldsymbol{F}\\left(\\boldsymbol{X}\\right)=\\partial \\boldsymbol{x}/\\partial \\boldsymbol{X}$。使用相同的形函数插值位移场，节点位移（在全局基底下）的数值规定如下：\n- 节点 $1$：$\\left(0,0,0\\right)$，\n- 节点 $2$：$\\left(0.24,0.20,0.04\\right)$，\n- 节点 $3$：$\\left(0.39,0.15,0.11\\right)$，\n- 节点 $4$：$\\left(0.15,-0.05,0.07\\right)$，\n- 节点 $5$：$\\left(0.075,-0.045,0.12\\right)$，\n- 节点 $6$：$\\left(0.315,0.155,0.16\\right)$，\n- 节点 $7$：$\\left(0.465,0.105,0.23\\right)$，\n- 节点 $8$：$\\left(0.225,-0.095,0.19\\right)$。\n\n使用TL格式计算单元中心高斯点 $\\left(\\xi,\\eta,\\zeta\\right)=\\left(0,0,0\\right)$ 处的变形梯度 $\\boldsymbol{F}$，并阐明几何非线性如何通过运动学定义进入计算。\n\n最后，报告中心高斯点处的标量体积比 $J=\\det\\left(\\boldsymbol{F}\\right)$。将最终答案表示为一个无单位的纯数字，并四舍五入到四位有效数字。", "solution": "经审阅，问题陈述有效。其科学基础是基于非线性固体力学和有限元法的原理，问题提法得当，提供了所有必要数据，并且表述客观、明确。因此，我将提供完整解答。\n\n该问题需要完成两项主要任务：首先，推导参考构型的等参映射；其次，在给定位移场下，计算单元中心的变形梯度 $\\boldsymbol{F}$ 和体积比 $J$。\n\n**第1部分：参考构型的等参映射**\n\n等参概念规定，单元的几何形状通过其节点坐标进行插值，使用的形函数与插值位移场时使用的形函数相同。对于一个八节点三线性六面体单元，与节点 $i$（其父坐标为 $(\\xi_i, \\eta_i, \\zeta_i)$）相关联的形函数 $N_i$ 由下式给出：\n$$\nN_i(\\xi, \\eta, \\zeta) = \\frac{1}{8}(1 + \\xi_i \\xi)(1 + \\eta_i \\eta)(1 + \\zeta_i \\zeta)\n$$\n其中 $(\\xi, \\eta, \\zeta) \\in [-1, 1]^3$。单元内任意一点的材料坐标 $(X, Y, Z)$ 可通过节点坐标 $(\\boldsymbol{X}_i)$ 插值得到：\n$$\n\\boldsymbol{X}(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) \\boldsymbol{X}_i\n$$\n这个矢量方程代表了坐标 $X$、$Y$ 和 $Z$ 的三个标量方程：\n$$\nX(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) X_i\n$$\n$$\nY(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) Y_i\n$$\n$$\nZ(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) Z_i\n$$\n利用所提供的节点坐标 $(\\boldsymbol{X}_i)$ 和标准父坐标 $(\\xi_i, \\eta_i, \\zeta_i)$ 来找到显式映射。对于给定的矩形块，该映射得以简化。对于坐标 $X$：\n$$\nX(\\xi, \\eta, \\zeta) = N_2(\\xi, \\eta, \\zeta)(2) + N_3(\\xi, \\eta, \\zeta)(2) + N_6(\\xi, \\eta, \\zeta)(2) + N_7(\\xi, \\eta, \\zeta)(2)\n$$\n代入形函数并分组化简，我们得到：\n$$\nX(\\xi, \\eta, \\zeta) = (1+\\xi)\n$$\n类似地，对于坐标 $Y$ 和 $Z$：\n$$\nY(\\xi, \\eta, \\zeta) = N_3(1) + N_4(1) + N_7(1) + N_8(1) = \\frac{1}{2}(1+\\eta) = 0.5(1+\\eta)\n$$\n$$\nZ(\\xi, \\eta, \\zeta) = N_5(1.5) + N_6(1.5) + N_7(1.5) + N_8(1.5) = \\frac{1.5}{2}(1+\\zeta) = 0.75(1+\\zeta)\n$$\n因此，显式等参映射为：\n$$\nX(\\xi, \\eta, \\zeta) = 1 + \\xi\n$$\n$$\nY(\\xi, \\eta, \\zeta) = 0.5(1 + \\eta)\n$$\n$$\nZ(\\xi, \\eta, \\zeta) = 0.75(1 + \\zeta)\n$$\n\n**第2部分：变形梯度和体积比**\n\n在全拉格朗日（TL）格式中，变形梯度 $\\boldsymbol{F}$ 定义为当前位置矢量 $\\boldsymbol{x}$ 相对于初始材料坐标 $\\boldsymbol{X}$ 的梯度：\n$$\n\\boldsymbol{F} = \\frac{\\partial \\boldsymbol{x}}{\\partial \\boldsymbol{X}} = \\frac{\\partial (\\boldsymbol{X} + \\boldsymbol{u})}{\\partial \\boldsymbol{X}} = \\boldsymbol{I} + \\frac{\\partial \\boldsymbol{u}}{\\partial \\boldsymbol{X}}\n$$\n此处，$\\boldsymbol{u}$ 是位移矢量，$\\boldsymbol{I}$ 是二阶单位张量。项 $\\partial \\boldsymbol{u} / \\partial \\boldsymbol{X}$ 是位移梯度张量。使用这个对任意大位移和转动都有效的精确运动学关系，是几何非线性的基础。\n\n为了计算相对于材料坐标 $(X,Y,Z)$ 的导数，我们使用链式法则，将其与父坐标系 $(\\xi, \\eta, \\zeta)$ 中的导数联系起来：\n$$\n\\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\\\ \\frac{\\partial}{\\partial \\zeta} \\end{Bmatrix} = \\begin{bmatrix} \\frac{\\partial X}{\\partial \\xi}  \\frac{\\partial Y}{\\partial \\xi}  \\frac{\\partial Z}{\\partial \\xi} \\\\ \\frac{\\partial X}{\\partial \\eta}  \\frac{\\partial Y}{\\partial \\eta}  \\frac{\\partial Z}{\\partial \\eta} \\\\ \\frac{\\partial X}{\\partial \\zeta}  \\frac{\\partial Y}{\\partial \\zeta}  \\frac{\\partial Z}{\\partial \\zeta} \\end{bmatrix} \\begin{Bmatrix} \\frac{\\partial}{\\partial X} \\\\ \\frac{\\partial}{\\partial Y} \\\\ \\frac{\\partial}{\\partial Z} \\end{Bmatrix} = \\boldsymbol{J_0}^T \\begin{Bmatrix} \\frac{\\partial}{\\partial X} \\\\ \\frac{\\partial}{\\partial Y} \\\\ \\frac{\\partial}{\\partial Z} \\end{Bmatrix}\n$$\n矩阵 $\\boldsymbol{J_0}$ 是从父坐标到参考坐标映射的雅可比矩阵。其分量为 $(\\boldsymbol{J_0})_{ij} = \\partial X_i / \\partial \\xi_j$。根据我们在第1部分推导出的映射，我们计算 $\\boldsymbol{J_0}$：\n$$\n\\boldsymbol{J_0} = \\begin{bmatrix} \\frac{\\partial X}{\\partial \\xi}  \\frac{\\partial X}{\\partial \\eta}  \\frac{\\partial X}{\\partial \\zeta} \\\\ \\frac{\\partial Y}{\\partial \\xi}  \\frac{\\partial Y}{\\partial \\eta}  \\frac{\\partial Y}{\\partial \\zeta} \\\\ \\frac{\\partial Z}{\\partial \\xi}  \\frac{\\partial Z}{\\partial \\eta}  \\frac{\\partial Z}{\\partial \\zeta} \\end{bmatrix} = \\begin{bmatrix} 1  0  0 \\\\ 0  0.5  0 \\\\ 0  0  0.75 \\end{bmatrix}\n$$\n由于该雅可比矩阵是常数，它在各处的值都相同，包括单元中心。我们需要它的逆矩阵来求相对于 $\\boldsymbol{X}$ 的导数：\n$$\n\\boldsymbol{J_0}^{-1} = \\begin{bmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  \\frac{1}{0.75} \\end{bmatrix} = \\begin{bmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  \\frac{4}{3} \\end{bmatrix}\n$$\n位移梯度 $\\nabla_{\\boldsymbol{X}}\\boldsymbol{u} = \\partial \\boldsymbol{u} / \\partial \\boldsymbol{X}$ 通过链式法则计算为 $\\nabla_{\\boldsymbol{X}}\\boldsymbol{u} = (\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u})(\\boldsymbol{J_0}^{-1})^T$，其中 $\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u} = \\partial \\boldsymbol{u} / \\partial \\boldsymbol{\\xi}$。因为 $\\boldsymbol{J_0}^{-1}$ 是对角矩阵，因此是对称的，所以 $(\\boldsymbol{J_0}^{-1})^T = \\boldsymbol{J_0}^{-1}$。\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial \\boldsymbol{X}} = \\left( \\frac{\\partial \\boldsymbol{u}}{\\partial \\boldsymbol{\\xi}} \\right) \\boldsymbol{J_0}^{-1}\n$$\n位移场相对于父坐标的梯度 $\\partial \\boldsymbol{u} / \\partial \\boldsymbol{\\xi}$，是通过对位移插值求导得到的：\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial \\xi_j} (\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi_j} (\\xi, \\eta, \\zeta) \\boldsymbol{u}_i\n$$\n我们必须在单元中心 $(\\xi, \\eta, \\zeta) = (0,0,0)$ 处计算该值。形函数在该点的导数为：\n$$\n\\frac{\\partial N_i}{\\partial \\xi}\\bigg|_{(0,0,0)} = \\frac{1}{8}\\xi_i, \\quad \\frac{\\partial N_i}{\\partial \\eta}\\bigg|_{(0,0,0)} = \\frac{1}{8}\\eta_i, \\quad \\frac{\\partial N_i}{\\partial \\zeta}\\bigg|_{(0,0,0)} = \\frac{1}{8}\\zeta_i\n$$\n现在我们在 $(0,0,0)$ 处计算矩阵 $\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u} = [ \\partial u_k / \\partial \\xi_j ]$ 的分量。\n对于 $\\partial u_x / \\partial \\xi$：\n$\\frac{\\partial u_x}{\\partial \\xi} = \\frac{1}{8}\\sum_{i=1}^8 \\xi_i u_{ix} = \\frac{1}{8}[(-1)(0) + (1)(0.24) + (1)(0.39) + (-1)(0.15) + (-1)(0.075) + (1)(0.315) + (1)(0.465) + (-1)(0.225)] = \\frac{0.96}{8} = 0.12$\n对 $\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u}$ 的所有九个分量重复此过程：\n$$\n\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u} = \\begin{bmatrix} \\frac{\\partial u_x}{\\partial \\xi}  \\frac{\\partial u_x}{\\partial \\eta}  \\frac{\\partial u_x}{\\partial \\zeta} \\\\ \\frac{\\partial u_y}{\\partial \\xi}  \\frac{\\partial u_y}{\\partial \\eta}  \\frac{\\partial u_y}{\\partial \\zeta} \\\\ \\frac{\\partial u_z}{\\partial \\xi}  \\frac{\\partial u_z}{\\partial \\eta}  \\frac{\\partial u_z}{\\partial \\zeta} \\end{bmatrix} = \\begin{bmatrix} 0.12  0.075  0.0375 \\\\ 0.10  -0.025  -0.0225 \\\\ 0.02  0.035  0.06 \\end{bmatrix}\n$$\n现在，我们计算位移梯度 $\\nabla_{\\boldsymbol{X}}\\boldsymbol{u}$：\n$$\n\\nabla_{\\boldsymbol{X}}\\boldsymbol{u} = \\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u} \\boldsymbol{J_0}^{-1} = \\begin{bmatrix} 0.12  0.075  0.0375 \\\\ 0.10  -0.025  -0.0225 \\\\ 0.02  0.035  0.06 \\end{bmatrix} \\begin{bmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  \\frac{4}{3} \\end{bmatrix}\n$$\n$$\n\\nabla_{\\boldsymbol{X}}\\boldsymbol{u} = \\begin{bmatrix} (0.12)(1)  (0.075)(2)  (0.0375)(\\frac{4}{3}) \\\\ (0.10)(1)  (-0.025)(2)  (-0.0225)(\\frac{4}{3}) \\\\ (0.02)(1)  (0.035)(2)  (0.06)(\\frac{4}{3}) \\end{bmatrix} = \\begin{bmatrix} 0.12  0.15  0.05 \\\\ 0.10  -0.05  -0.03 \\\\ 0.02  0.07  0.08 \\end{bmatrix}\n$$\n那么，变形梯度 $\\boldsymbol{F}$ 为：\n$$\n\\boldsymbol{F} = \\boldsymbol{I} + \\nabla_{\\boldsymbol{X}}\\boldsymbol{u} = \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix} + \\begin{bmatrix} 0.12  0.15  0.05 \\\\ 0.10  -0.05  -0.03 \\\\ 0.02  0.07  0.08 \\end{bmatrix} = \\begin{bmatrix} 1.12  0.15  0.05 \\\\ 0.10  0.95  -0.03 \\\\ 0.02  0.07  1.08 \\end{bmatrix}\n$$\n最后，标量体积比 $J$ 是变形梯度的行列式，即 $J = \\det(\\boldsymbol{F})$。\n$$\nJ = 1.12((0.95)(1.08) - (-0.03)(0.07)) - 0.15((0.10)(1.08) - (-0.03)(0.02)) + 0.05((0.10)(0.07) - (0.95)(0.02))\n$$\n$$\nJ = 1.12(1.026 + 0.0021) - 0.15(0.108 + 0.0006) + 0.05(0.007 - 0.019)\n$$\n$$\nJ = 1.12(1.0281) - 0.15(0.1086) + 0.05(-0.012)\n$$\n$$\nJ = 1.151472 - 0.01629 - 0.0006\n$$\n$$\nJ = 1.134582\n$$\n按要求四舍五入到四位有效数字，我们得到 $J = 1.135$。", "answer": "$$\n\\boxed{1.135}\n$$", "id": "2597165"}, {"introduction": "在许多工程应用中，材料和几何非线性往往同时出现，相互耦合，共同决定了结构的响应。本练习 ([@problem_id:2597177]) 提供了一个绝佳的编程实践机会，要求你实现一个同时考虑了材料非线性（超弹性本构）和几何非线性（大变形）的膜单元。通过推导并实现厚度更新法则，你将深刻理解在平面应力假设下，如何通过面外方向的变形来满足不可压缩性这一内部约束，从而将理论知识转化为可工作的代码。", "problem": "在一个有限元法 (FEM) 的设定下，实现一个承受有限应变运动学、平面应力超弹性和不可压缩约束的单四节点等参膜单元。仅从运动学和超弹性的基本定义出发，推导与不可压缩性一致的单元厚度更新法则，然后用它来计算指定本构律下的平面内柯西应力。您的实现应能计算变形梯度，施加平面应力和不可压缩性以确定厚度方向的拉伸，更新当前厚度，并针对几个指定的均匀变形情况，返回单元上的平均当前厚度和平均平面内柯西应力。\n\n您可以假设的基本原理：\n- 变形运动学：变形梯度定义为 $F = \\partial x / \\partial X$。右柯西-格林变形张量定义为 $C = F^{T} F$，左柯西-格林张量定义为 $B = F F^{T}$。\n- 超弹性：对于超弹性材料，应力由应变能密度函数 $W(F)$ 导出。\n- 不可压缩性：不可压缩性的物理约束是 $J = \\det F = 1$。\n- 平面应力膜：平面外柯西应力分量 $\\sigma_{33}$ 为零，平面外剪切分量为零。单元运动学仅限于平面内变形，但必须更新平面外厚度以满足约束。\n\n需实现的本构模型：\n- 不可压缩各向同性 Neo-Hookean 超弹性，剪切模量为 $\\mu$ (单位：帕斯卡)。基尔霍夫应力 $\\tau$ 由 $\\tau = \\mu B - p I$ 给出，其中 $p$ 是一个强制不可压缩性的拉格朗日乘子，$I$ 是单位张量。在不可压缩条件下，柯西应力 $\\sigma = \\tau$。\n\n单元与运动学：\n- 使用单个四节点双线性四边形单元，其参考节点坐标位于 $(0,0)$、$(1,0)$、$(1,1)$、$(0,1)$，单位为米。假设一个形式如下的均匀平面内变形映射\n  $$\n  x = \\lambda_x X + \\gamma Y, \\quad y = \\lambda_y Y,\n  $$\n  其中 $\\lambda_x$ 和 $\\lambda_y$ 是指定的平面内主拉伸，$\\gamma$ 是一个指定的平面内简单剪切参数，均为无量纲。参考厚度为 $t_0$ (单位：米)。\n- 通过标准等参映射，在 $2 \\times 2$ 高斯点处计算平面内变形梯度 $F_{2 \\times 2}$，并用它在每个高斯点评估平面内左柯西-格林张量 $B_{\\text{in}} = F_{2 \\times 2} F_{2 \\times 2}^{T}$。\n\n需推导并实现的厚度更新法则：\n- 施加不可压缩性 $J = \\det F = 1$ 以及块对角膜运动学（无横向剪切），使得\n  $$\n  F = \\begin{bmatrix} F_{2 \\times 2}  \\mathbf{0} \\\\ \\mathbf{0}^T  \\lambda_3 \\end{bmatrix},\n  $$\n  因此\n  $$\n  \\det F = \\det(F_{2 \\times 2}) \\, \\lambda_3 = 1.\n  $$\n  推导 $\\lambda_3$ 与 $F_{2 \\times 2}$ 的关系，并相应地更新当前厚度 $t$。您必须以米为单位表示最终厚度 $t$。\n\n平面应力强制：\n- 施加 $\\sigma_{33} = 0$ 以消除拉格朗日乘子 $p$，并获得平面内柯西应力的显式表达式。应力分量以帕斯卡表示。\n\n数值任务：\n- 实现一个函数，对于每个指定的 $(\\lambda_x, \\lambda_y, \\gamma, t_0, \\mu)$，从均匀映射构造当前节点位置，在 $2 \\times 2$ 高斯积分法下计算 $F_{2 \\times 2}$，施加不可压缩性以更新厚度，施加平面应力以消除 $p$，并返回单元平均的当前厚度和平面内柯西应力分量 $(\\sigma_{xx}, \\sigma_{yy}, \\sigma_{xy})$。\n\n输出单位和格式：\n- 厚度必须以米为单位返回。\n- 应力分量必须以帕斯卡为单位返回。\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，形式为列表的列表\n  $$\n  [ [t,\\sigma_{xx},\\sigma_{yy},\\sigma_{xy}], \\dots ]\n  $$\n  其中每个子列表对应一个测试用例，并包含十进制浮点数。\n\n涵盖不同非线性和边界情况的测试套件：\n- 情况 $1$ ($x$ 方向单轴拉伸): $(\\lambda_x,\\lambda_y,\\gamma,t_0,\\mu) = (1.2, 1.0, 0.0, 1.0 \\times 10^{-3} \\ \\text{m}, 1.0 \\times 10^{6} \\ \\text{Pa})$。\n- 情况 $2$ (双轴混合拉伸): $(\\lambda_x,\\lambda_y,\\gamma,t_0,\\mu) = (0.9, 1.1, 0.0, 2.0 \\times 10^{-3} \\ \\text{m}, 0.5 \\times 10^{6} \\ \\text{Pa})$。\n- 情况 $3$ (简单剪切): $(\\lambda_x,\\lambda_y,\\gamma,t_0,\\mu) = (1.0, 1.0, 0.3, 1.0 \\times 10^{-3} \\ \\text{m}, 2.0 \\times 10^{6} \\ \\text{Pa})$。\n- 情况 $4$ (强面积压缩): $(\\lambda_x,\\lambda_y,\\gamma,t_0,\\mu) = (0.6, 0.7, 0.0, 5.0 \\times 10^{-4} \\ \\text{m}, 3.0 \\times 10^{6} \\ \\text{Pa})$。\n\n最终输出规格：\n- 您的程序应生成单行输出，其中包含结果，形式为由方括号括起来的、以逗号分隔的各用例结果列表，每个用例结果本身是一个列表 $[t,\\sigma_{xx},\\sigma_{yy},\\sigma_{xy}]$。例如：$[[t_1,\\sigma_{xx,1},\\sigma_{yy,1},\\sigma_{xy,1}],[t_2,\\sigma_{xx,2},\\sigma_{yy,2},\\sigma_{xy,2}],\\dots]$。", "solution": "该问题陈述经过严格验证，认定有效。它在科学上基于连续介质力学和有限元法的原理，在数学上是适定的，并且以客观、明确的语言表述。它提出了一个非平凡的任务，要求在多重约束下正确推导和应用运动学及本构关系。因此，我们将着手进行形式化的求解。\n\n目标是推导并实现一个在有限应变、平面应力、不可压缩条件下的单四节点等参膜单元的本构更新。材料被指定为 Neo-Hookean 超弹性固体。\n\n首先，我们分析指定变形的运动学。问题定义了一个从参考构型坐标 $(X, Y)$ 到当前构型坐标 $(x, y)$ 的均匀平面内变形映射：\n$$\nx = \\lambda_x X + \\gamma Y\n$$\n$$\ny = \\lambda_y Y\n$$\n变形梯度张量 $F$ 的平面内分量，记为 $F_{2 \\times 2}$，通过对参考坐标求导得到：\n$$\nF_{2 \\times 2} = \\frac{\\partial (x, y)}{\\partial (X, Y)} = \\begin{bmatrix} \\frac{\\partial x}{\\partial X}  \\frac{\\partial x}{\\partial Y} \\\\ \\frac{\\partial y}{\\partial X}  \\frac{\\partial y}{\\partial Y} \\end{bmatrix} = \\begin{bmatrix} \\lambda_x  \\gamma \\\\ 0  \\lambda_y \\end{bmatrix}\n$$\n尽管问题指定了使用等参公式和高斯积分，但这个特定的变形映射是仿射的。对于参考坐标 $(\\xi, \\eta)$ 中的标准双单位正方形单元，这将导致一个在整个单元内恒定的变形梯度 $F$。因此，任何由 $F$ 导出的量，如应力和厚度，也将是均匀的。“单元平均值”就是这个恒定值，数值积分虽然不是严格必需的，但可以验证这种均匀性。\n\n问题陈述，由于膜假设（无横向剪切），完整的三维变形梯度 $F$ 具有块对角结构：\n$$\nF = \\begin{bmatrix} F_{2 \\times 2}  \\mathbf{0} \\\\ \\mathbf{0}^T  \\lambda_3 \\end{bmatrix} = \\begin{bmatrix} \\lambda_x  \\gamma  0 \\\\ 0  \\lambda_y  0 \\\\ 0  0  \\lambda_3 \\end{bmatrix}\n$$\n其中 $\\lambda_3$ 是厚度方向的拉伸。\n\n接下来，我们施加不可压缩约束，$J = \\det F = 1$。\n$$\nJ = \\det(F_{2 \\times 2}) \\cdot \\lambda_3 = (\\lambda_x \\lambda_y) \\lambda_3 = 1\n$$\n由此，我们推导出平面外拉伸 $\\lambda_3$：\n$$\n\\lambda_3 = \\frac{1}{\\lambda_x \\lambda_y}\n$$\n膜的当前厚度 $t$ 由参考厚度 $t_0$ 通过此拉伸更新：\n$$\nt = \\lambda_3 t_0 = \\frac{t_0}{\\lambda_x \\lambda_y}\n$$\n这就是所需的厚度更新法则。\n\n现在我们转向本构关系。材料是不可压缩的 Neo-Hookean 固体，其基尔霍夫应力 $\\tau$ 由 $\\tau = \\mu B - p I$ 给出。对于不可压缩材料，柯西应力 $\\sigma$ 等于基尔霍夫应力，所以 $\\sigma = \\mu B - p I$。这里，$B$ 是左柯西-格林变形张量，$B = FF^T$，$\\mu$ 是剪切模量，$p$ 是静水压力（一个强制不可压缩性的拉格朗日乘子），$I$ 是单位张量。\n\n我们计算 $B$：\n$$\nB = FF^T = \\begin{bmatrix} \\lambda_x  \\gamma  0 \\\\ 0  \\lambda_y  0 \\\\ 0  0  \\lambda_3 \\end{bmatrix} \\begin{bmatrix} \\lambda_x  0  0 \\\\ \\gamma  \\lambda_y  0 \\\\ 0  0  \\lambda_3 \\end{bmatrix} = \\begin{bmatrix} \\lambda_x^2 + \\gamma^2  \\gamma \\lambda_y  0 \\\\ \\gamma \\lambda_y  \\lambda_y^2  0 \\\\ 0  0  \\lambda_3^2 \\end{bmatrix}\n$$\n于是柯西应力张量为：\n$$\n\\sigma = \\mu \\begin{bmatrix} \\lambda_x^2 + \\gamma^2  \\gamma \\lambda_y  0 \\\\ \\gamma \\lambda_y  \\lambda_y^2  0 \\\\ 0  0  \\lambda_3^2 \\end{bmatrix} - p \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix} = \\begin{bmatrix} \\mu(\\lambda_x^2 + \\gamma^2) - p  \\mu \\gamma \\lambda_y  0 \\\\ \\mu \\gamma \\lambda_y  \\mu \\lambda_y^2 - p  0 \\\\ 0  0  \\mu \\lambda_3^2 - p \\end{bmatrix}\n$$\n要施加的最后一个约束是平面应力条件，$\\sigma_{33} = 0$。这使得可以确定未知压力 $p$。\n$$\n\\sigma_{33} = \\mu \\lambda_3^2 - p = 0 \\implies p = \\mu \\lambda_3^2\n$$\n代入 $\\lambda_3 = 1/(\\lambda_x \\lambda_y)$，我们找到压力与指定的平面内变形的关系：\n$$\np = \\mu \\left( \\frac{1}{\\lambda_x \\lambda_y} \\right)^2 = \\frac{\\mu}{(\\lambda_x \\lambda_y)^2}\n$$\n最后，我们将 $p$ 的这个表达式代回到应力张量的平面内分量中，以获得它们的显式形式。令 $\\sigma_{xx} \\equiv \\sigma_{11}$，$\\sigma_{yy} \\equiv \\sigma_{22}$，以及 $\\sigma_{xy} \\equiv \\sigma_{12}$。\n$$\n\\sigma_{xx} = \\mu(\\lambda_x^2 + \\gamma^2) - p = \\mu \\left( \\lambda_x^2 + \\gamma^2 - \\frac{1}{(\\lambda_x \\lambda_y)^2} \\right)\n$$\n$$\n\\sigma_{yy} = \\mu \\lambda_y^2 - p = \\mu \\left( \\lambda_y^2 - \\frac{1}{(\\lambda_x \\lambda_y)^2} \\right)\n$$\n$$\n\\sigma_{xy} = \\mu \\gamma \\lambda_y\n$$\n这些表达式完整地描述了在指定条件下的平面内柯西应力分量。\n\n数值实现将通过对每个由元组 $(\\lambda_x, \\lambda_y, \\gamma, t_0, \\mu)$ 定义的测试用例直接应用这些推导出的解析公式来进行。计算并报告当前厚度 $t$ 和应力分量 $(\\sigma_{xx}, \\sigma_{yy}, \\sigma_{xy})$ 的结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the element-averaged thickness and in-plane Cauchy stress for a \n    four-node membrane element under finite strain, plane-stress hyperelasticity, \n    and incompressibility.\n    \"\"\"\n    \n    # Test cases: (lambda_x, lambda_y, gamma, t0, mu)\n    # lambda_x, lambda_y, gamma are dimensionless stretches and shear\n    # t0 is initial thickness in meters\n    # mu is shear modulus in Pascals\n    test_cases = [\n        (1.2, 1.0, 0.0, 1.0e-3, 1.0e6),  # Case 1: Uniaxial stretch\n        (0.9, 1.1, 0.0, 2.0e-3, 0.5e6),  # Case 2: Biaxial mixed stretch\n        (1.0, 1.0, 0.3, 1.0e-3, 2.0e6),  # Case 3: Simple shear\n        (0.6, 0.7, 0.0, 5.0e-4, 3.0e6),  # Case 4: Strong areal compression\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        lambda_x, lambda_y, gamma, t0, mu = case\n        \n        # For the given homogeneous deformation, the deformation gradient is constant\n        # across the element. Therefore, the quantities to be computed are also\n        # constant, and the \"element-averaged\" value is simply the value at any point.\n        \n        # 1. Enforce incompressibility to find the out-of-plane stretch (lambda_3)\n        # J = det(F_2x2) * lambda_3 = (lambda_x * lambda_y) * lambda_3 = 1\n        det_F_2x2 = lambda_x * lambda_y\n        \n        # Handle potential division by zero, although not expected in test cases.\n        if abs(det_F_2x2)  1e-12:\n            # Physically, this corresponds to infinite thinning or thickening, a singularity.\n            # We can represent result as NaN or raise an error.\n            # For this problem, we assume valid physical inputs.\n            lambda_3 = np.inf\n        else:\n            lambda_3 = 1.0 / det_F_2x2\n            \n        # 2. Update the current thickness\n        # t = lambda_3 * t0\n        current_thickness = lambda_3 * t0\n        \n        # 3. Enforce plane-stress condition (sigma_33 = 0) to find pressure p\n        # For an incompressible Neo-Hookean material, sigma = mu*B - p*I.\n        # B_33 = lambda_3^2\n        # sigma_33 = mu * lambda_3^2 - p = >  p = mu * lambda_3^2\n        pressure = mu * (lambda_3**2)\n        \n        # 4. Compute the in-plane Cauchy stress components\n        # sigma_xx = mu * B_11 - p = mu * (lambda_x^2 + gamma^2) - p\n        sigma_xx = mu * (lambda_x**2 + gamma**2) - pressure\n        \n        # sigma_yy = mu * B_22 - p = mu * (lambda_y^2) - p\n        sigma_yy = mu * (lambda_y**2) - pressure\n        \n        # sigma_xy = mu * B_12 = mu * (gamma * lambda_y)\n        sigma_xy = mu * gamma * lambda_y\n        \n        result_case = [current_thickness, sigma_xx, sigma_yy, sigma_xy]\n        results.append(result_case)\n\n    # Format the final output string exactly as specified in the problem.\n    # The output is a list of lists, represented as a string.\n    # e.g., [[t1,sxx1,syy1,sxy1],[t2,sxx2,syy2,sxy2],...]\n    output_str_parts = []\n    for res in results:\n        # Format each list as a string \"[v1,v2,v3,v4]\"\n        inner_str = f\"[{','.join(map(str, res))}]\"\n        output_str_parts.append(inner_str)\n    \n    final_output = f\"[{','.join(output_str_parts)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2597177"}, {"introduction": "边界非线性源于边界条件的改变，其中单边接触是其最典型也最具挑战性的例子。接触状态（接触或分离）的切换引入了非光滑的、类似开关的特性，使得标准的求解算法（如牛顿-拉弗森法）常常会收敛失败。本练习 ([@problem_id:2597217]) 让你直面这一难题，通过分析一个接触问题的收敛性障碍，探讨其背后的数学原理，并了解为解决此类非光滑问题而发展起来的半光滑牛顿法等高级算法。", "problem": "一个无摩擦单边接触问题被建模为一个经历小变形的线性弹性体，并使用有限元法（FEM）进行离散化。令 $u \\in \\mathbb{R}^n$ 表示全局位移向量，$\\lambda \\in \\mathbb{R}^m$ 表示节点法向接触力（拉格朗日乘子），$N \\in \\mathbb{R}^{m \\times n}$ 是通过 $g(u) = N u - g_0$ 将位移映射到法向间隙的矩阵，其中 $g_0 \\in \\mathbb{R}^m$ 是与刚性障碍物之间的初始间隙。平衡残差为 $R_u(u,\\lambda) = K u + N^T \\lambda - f$，其中 $K \\in \\mathbb{R}^{n \\times n}$ 是无约束子空间上的对称正定刚度矩阵，$f \\in \\mathbb{R}^n$ 是外载荷向量。接触条件为 Signorini 互补条件：$g(u) \\ge 0$，$\\lambda \\ge 0$ 和 $g(u)^T \\lambda = 0$。\n\n观察到，当某些节点的接触状态在激活和非激活之间切换时，直接应用于互补约束的基于方程重构的朴素 Newton–Raphson 迭代无法收敛。这种失效归因于边界条件的非光滑性。\n\n哪个选项既正确地指出了导致所观察到的收敛问题的非线性来源，又提出了一个有效的半光滑牛顿法，该方法使用了与接触节点激活集表征一致的广义导数？请选择唯一的最佳选项。\n\nA. 非线性源于不等式型边界条件。通过一个参数 $c > 0$ 和到非负象限的投影，为接触引入一个非光滑残差，并对耦合系统应用半光滑牛顿法。定义 $y = \\lambda - c\\, g(u)$ 和 $P(y) = \\max(0, y)$（按分量作用）。接触残差为 $R_\\lambda(u,\\lambda) = \\lambda - P(y)$。通过选择一个对角矩阵 $D \\in \\mathbb{R}^{m \\times m}$ 来获得广义雅可比矩阵，其元素在 $y_i > 0$ 时（接触激活）为 $D_{ii} = 1$，在 $y_i  0$ 时（接触非激活）为 $D_{ii} = 0$，在 $y_i = 0$ 时（双激活）为任意 $D_{ii} \\in [0,1]$。在 $(u,\\lambda)$ 处的相应半光滑牛顿步 $(\\Delta u, \\Delta \\lambda)$ 求解\n$$\n\\begin{bmatrix}\nK  N^T \\\\\nc\\, D\\, N  I - D\n\\end{bmatrix}\n\\begin{bmatrix}\n\\Delta u \\\\ \\Delta \\lambda\n\\end{bmatrix}\n=\n-\n\\begin{bmatrix}\nR_u(u,\\lambda) \\\\\nR_\\lambda(u,\\lambda)\n\\end{bmatrix},\n$$\n并且激活集根据 $y$ 的符号更新。\n\nB. 非线性主要源于几何效应，因为间隙 $g(u)$ 依赖于 $u$。用刚度为 $c > 0$ 的光滑罚函数势替换互补条件，得到光滑残差 $R_\\lambda(u) = c\\, \\min(0, g(u))$，并对罚平衡方程 $K u + N^T R_\\lambda(u) - f = 0$ 应用经典的 Newton–Raphson 方法，其切线刚度为 $K_t = K + c\\, N^T N$。\n\nC. 困难在于数值噪声，而非非光滑性。用 Fischer–Burmeister 函数 $\\phi(a,b) = \\sqrt{a^2 + b^2} - (a + b)$ 重构互补条件，并应用标准牛顿法，因为 $\\phi$ 是光滑的，使用的雅可比矩阵通过对 $\\phi(g(u), \\lambda)$ 微分得到。\n\nD. 非线性源于不等式边界，但可以通过半光滑牛顿法处理，该方法使用对角矩阵 $D$ 来线性化投影，其中在激活集上定义 $D_{ii} = 0$，在非激活集上定义 $D_{ii} = 1$。牛顿系统为\n$$\n\\begin{bmatrix}\nK  N^T \\\\\n-\\, c\\, D\\, N  I + D\n\\end{bmatrix}\n\\begin{bmatrix}\n\\Delta u \\\\ \\Delta \\lambda\n\\end{bmatrix}\n=\n-\n\\begin{bmatrix}\nR_u(u,\\lambda) \\\\\nR_\\lambda(u,\\lambda)\n\\end{bmatrix}.\n$$\n\nE. 非线性是边界引起的，但广义导数是不必要的。在初始猜测时选择一个固定的激活集并保持不变。通过消除非激活乘子并在假设的激活集上强制 $g(u)=0$ 直到收敛，牛顿系统简化为一个光滑的块系统。", "solution": "用户提供了一个计算接触力学中的问题。第一步是验证问题陈述。\n\n**第 1 步：提取已知条件**\n\n*   **问题领域**：线性弹性体在小变形下的无摩擦单边接触问题，使用有限元法（FEM）离散化。\n*   **变量**：\n    *   $u \\in \\mathbb{R}^n$：全局位移向量。\n    *   $\\lambda \\in \\mathbb{R}^m$：节点法向接触力（拉格朗日乘子）。\n*   **问题数据**：\n    *   $K \\in \\mathbb{R}^{n \\times n}$：对称正定刚度矩阵。\n    *   $f \\in \\mathbb{R}^n$：外载荷向量。\n    *   $N \\in \\mathbb{R}^{m \\times n}$：将位移映射到法向间隙的矩阵。\n    *   $g_0 \\in \\mathbb{R}^m$：初始间隙向量。\n*   **控制关系**：\n    *   法向间隙函数：$g(u) = N u - g_0$。\n    *   平衡残差：$R_u(u,\\lambda) = K u + N^T \\lambda - f$。\n    *   Signorini 互补条件：$g(u) \\ge 0$, $\\lambda \\ge 0$ 和 $g(u)^T \\lambda = 0$。\n*   **观察**：当接触状态改变时，朴素的 Newton–Raphson 方法无法收敛，原因是边界条件的非光滑性。\n*   **问题**：识别哪个选项既正确指出了非线性来源，又提出了使用与激活集表征一致的广义导数的有效半光滑牛顿法。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n*   **科学依据**：问题陈述在科学上是合理的。它提出了一个二次规划问题的标准 Karush-Kuhn-Tucker (KKT) 条件，这是线性弹性、小变形、无摩擦接触问题的经典提法。将非光滑性确定为标准牛顿法收敛问题的根源是正确的，而建议使用半光滑牛顿法作为补救方法是计算力学中的一个标准且高级的主题。\n*   **适定性**：问题是适定的。在给定假设（$K$ 是对称正定的）下，其底层物理问题有唯一解。问题要求从一组选项中识别出一种正确的数值方法，这是一个定义明确的任务。\n*   **客观性**：问题以精确、客观的数学语言陈述。\n*   **缺陷检查表**：问题没有违反任何指定的无效标准。它在科学上是合理的、可形式化的、完整的、现实的、适定的和非平凡的。\n\n**第 3 步：结论与行动**\n\n问题陈述是有效的。我现在将进行完整的推导和分析。\n\n问题在于求解由接触的 KKT 条件定义的系统：\n$$\n\\begin{cases}\n    K u + N^T \\lambda - f = 0 \\\\\n    g(u) \\ge 0, \\quad \\lambda \\ge 0 \\\\\n    g(u)^T \\lambda = 0\n\\end{cases}\n$$\n其中 $g(u) = N u - g_0$。核心困难在于互补条件，它可以按分量写为对每个接触节点 $i$ 都有 $g_i(u) \\ge 0$, $\\lambda_i \\ge 0$ 和 $g_i(u) \\lambda_i = 0$。这些条件引入了不可微性，使得标准的 Newton-Raphson 方法不能直接适用。这种困难的来源不是材料非线性（物体是线性弹性的）也不是几何非线性（变形很小，间隙函数是线性的），而是由不等式约束引起的**边界非线性**。\n\n需要使用半光滑牛顿法。这涉及到将互补条件重构为一个非光滑方程组。这类重构中一个著名的方法是基于所谓的 NCP 函数（非线性互补问题函数）$\\phi(a,b)$，它具有性质 $\\phi(a,b)=0 \\iff a \\ge 0, b \\ge 0, ab=0$。\n\n一种这样的重构是使用到非负象限的投影。条件 $a \\ge 0, b \\ge 0, ab=0$ 对于任意常数 $c > 0$ 都等价于 $a - \\max(0, a - cb) = 0$。让我们将这个应用到我们的问题中，设置 $a = \\lambda$ 和 $b = g(u)$。那么互补条件就等价于方程：\n$$\n\\lambda - \\max(0, \\lambda - c\\,g(u)) = 0\n$$\n让我们将投影的自变量定义为 $y(u, \\lambda) = \\lambda - c\\,g(u)$，并使用算子 $P(y) = \\max(0, y)$（按分量作用）。KKT 系统被重写为一个方程组：\n$$\nR(u, \\lambda) = \\begin{bmatrix} R_u(u, \\lambda) \\\\ R_\\lambda(u, \\lambda) \\end{bmatrix} = \\begin{bmatrix} K u + N^T \\lambda - f \\\\ \\lambda - P(y(u, \\lambda)) \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}\n$$\n这个系统是非光滑的，因为当其自变量的任何分量为零时，投影算子 $P$ 是不可微的。然而，它是一个半光滑函数，这允许使用半光滑牛顿法。该方法通过求解以下方程来在当前迭代点 $(u^k, \\lambda^k)$ 处线性化系统：\n$$\nJ_{gen}(u^k, \\lambda^k) \\begin{bmatrix} \\Delta u \\\\ \\Delta \\lambda \\end{bmatrix} = - R(u^k, \\lambda^k)\n$$\n其中 $J_{gen}$ 是 $R$ 的广义雅可比矩阵（Clarke 次微分）中的一个元素。我们必须计算这个广义雅可比矩阵。\n$$\nJ_{gen} = \\begin{bmatrix} \\frac{\\partial R_u}{\\partial u}  \\frac{\\partial R_u}{\\partial \\lambda} \\\\ \\frac{\\partial R_\\lambda}{\\partial u}  \\frac{\\partial R_\\lambda}{\\partial \\lambda} \\end{bmatrix}\n$$\n上块是线性的：$\\frac{\\partial R_u}{\\partial u} = K$ 和 $\\frac{\\partial R_u}{\\partial \\lambda} = N^T$。\n对于下块，我们使用广义导数的链式法则。$P(y)$ 的广义导数可以用一个对角矩阵 $D$ 表示，其对角元素 $D_{ii}$ 取自标量函数 $\\max(0, \\cdot)$ 在 $y_i$ 处的次微分：\n*   如果 $y_i > 0$，导数为 $1$。所以，$D_{ii} = 1$。\n*   如果 $y_i  0$，导数为 $0$。所以，$D_{ii} = 0$。\n*   如果 $y_i = 0$，次微分是区间 $[0,1]$。我们可以选择任何值，例如 $D_{ii}=0$ 或 $D_{ii}=1$。\n\n有了这个矩阵 $D$，$R_\\lambda$ 的广义导数是：\n$$\n\\frac{\\partial R_\\lambda}{\\partial u} = \\frac{\\partial}{\\partial u} [\\lambda - P(\\lambda - c(Nu-g_0))] = -D \\cdot \\frac{\\partial}{\\partial u} [\\lambda - cNu + cg_0] = -D(-cN) = cDN\n$$\n$$\n\\frac{\\partial R_\\lambda}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} [\\lambda - P(\\lambda - c\\,g(u))] = I - D \\cdot \\frac{\\partial}{\\partial \\lambda} [\\lambda - c\\,g(u)] = I - D(I) = I - D\n$$\n因此，广义雅可比矩阵是：\n$$\nJ_{gen} = \\begin{bmatrix} K  N^T \\\\ cDN  I-D \\end{bmatrix}\n$$\n$y_i = \\lambda_i - c\\,g_i(u)$ 的符号决定了下一次迭代的接触状态。\n*   如果接触是激活的 ($g_i \\to 0, \\lambda_i > 0$)，那么 $y_i \\approx \\lambda_i > 0$。在这种情况下，$D_{ii}=1$。\n*   如果接触是非激活的 ($g_i > 0, \\lambda_i \\to 0$)，那么 $y_i \\approx -c\\,g_i  0$。在这种情况下，$D_{ii}=0$。\n现在的问题是将给定的选项与这个正确的推导进行比较。\n\n**逐项分析选项**\n\n**A. 非线性源于不等式型边界条件。通过一个参数 $c > 0$ 和到非负象限的投影，为接触引入一个非光滑残差，并对耦合系统应用半光滑牛顿法。 ...**\n\n此选项正确地指出了非线性来源是“不等式型边界条件”。它提出了一个基于投影函数 $P(y) = \\max(0, y)$ 的半光滑牛顿法，这是一个标准且正确的方法。接触残差被给出为 $R_\\lambda(u,\\lambda) = \\lambda - P(y)$，其中 $y = \\lambda - c\\, g(u)$，这与上面推导的 $\\lambda - \\max(0, \\lambda - c\\,g(u))=0$ 公式完全匹配。广义雅可比矩阵被给出为 $\\begin{bmatrix} K  N^T \\\\ c\\, D\\, N  I - D \\end{bmatrix}$，这与我们推导的矩阵完美匹配。对角矩阵 $D$ 的定义，即对于 $y_i > 0$（激活）时 $D_{ii} = 1$，对于 $y_i  0$（非激活）时 $D_{ii} = 0$，也是正确的。整个描述是一致且数学上合理的。\n**结论：正确。**\n\n**B. 非线性主要源于几何效应，因为间隙 $g(u)$ 依赖于 $u$。用光滑罚函数势替换互补条件...**\n\n此选项错误地指出了非线性的来源。由于问题指定了小变形和线性间隙函数 $g(u) = Nu - g_0$，因此没有几何非线性。非线性来自边界条件的切换性质。所提出的方法是一种罚函数法，它用一个光滑但近似的问题来代替非光滑问题。虽然在某些情况下这是一种有效的数值策略，但它不是半光滑牛ton法，并且已知会引入病态问题。问题明确要求一个半光滑牛顿法。\n**结论：错误。**\n\n**C. 困难在于数值噪声，而非非光滑性。用 Fischer–Burmeister 函数...重构互补条件，并应用标准牛顿法，因为 $\\phi$ 是光滑的...**\n\n此选项有根本性缺陷。主要困难是固有的非光滑性，而不是数值噪声。它建议使用 Fischer-Burmeister 函数 $\\phi(a,b) = \\sqrt{a^2 + b^2} - (a+b)$。虽然这是一个有效的 NCP 函数，但其“是光滑的”这一说法是错误的。函数 $\\phi(a,b)$ 在 $(a,b) = (0,0)$ 处是不可微的。这一点恰好对应于双激活状态（$g_i=0, \\lambda_i=0$），这里的非光滑性是至关重要的。因此，仍然需要半光滑牛顿法，而不是“标准牛顿”法。\n**结论：错误。**\n\n**D. 非线性源于不等式边界，但可以通过半光滑牛顿法处理，该方法使用对角矩阵 $D$ 来线性化投影，其中在激活集上定义 $D_{ii} = 0$，在非激活集上定义 $D_{ii} = 1$...**\n\n此选项正确地指出了非线性的来源，但提出了一个错误的数学提法。矩阵 $D$ 的定义与选项 A 中从投影算子导出的正确定义相反。虽然一个不同的 NCP 函数可能会导致这样的 $D$ 定义，但系统矩阵 $\\begin{bmatrix} K  N^T \\\\ -\\, c\\, D\\, N  I + D \\end{bmatrix}$ 与任何标准 NCP 函数的一致推导都不对应。例如，下块中的符号和项，如 $-cDN$ 和 $I+D$，与此类问题的广义导数基础理论不一致。\n**结论：错误。**\n\n**E. 非线性是边界引起的，但广义导数是不必要的。在初始猜测时选择一个固定的激活集...并保持不变...**\n\n此选项正确地指出了非线性的来源，但摒弃了解决问题所必需的工具。它描述了一种经典但通常低效且不可靠的“激活集策略”。通过固定激活集，人们求解一系列线性问题。已知这种方法在问题描述的情况下——即节点接触状态在迭代之间发生变化时——会无法收敛（“抖动”）。“广义导数是不必要的”这一说法与解决此类非光滑问题的现代、稳健的理论直接矛盾。\n**结论：错误。**\n\n综上所述，只有选项 A 提出了一个完全正确且一致的方法描述，回答了问题。它正确地指出了非线性的来源，并详细描述了一种先进的半光滑牛顿法，具有正确的残差提法和相应的正确广义雅可比矩阵。", "answer": "$$\\boxed{A}$$", "id": "2597217"}]}