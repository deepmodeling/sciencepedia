{"hands_on_practices": [{"introduction": "在后屈曲分析中，结构常常经历大转动，这要求我们使用能够在刚体运动下保持不变（即“客观”）的应变度量。本练习从一个看似简单的平面转动问题入手，旨在揭示为何线性运动学假设在这种情况下会失效。通过计算格林-拉格朗日（Green-Lagrange）应变张量，您将亲身体会到，一个意图为刚体转动的位移场如何在一个非线性框架下产生非零应变，从而理解为何必须采用正确的非线性运动学描述来避免虚假的人为刚度。[@problem_id:2584373]", "problem": "在用于非线性屈曲和后屈曲响应的几何非线性有限元列式中，客观应变度量在任何刚体运动下都必须为零。考虑参考构型中的一个平面运动学映射，其物质点坐标为$\\left(X,Y\\right)$，位移场分量为$u_x\\left(X,Y\\right)=-\\theta\\,Y$，$u_y\\left(X,Y\\right)=\\theta\\,X$，其中$\\theta$是一个常数，可以为有限值。仅使用基本连续介质运动学，即变形梯度$\\mathbf{F}=\\partial\\mathbf{x}/\\partial\\mathbf{X}$、右Cauchy–Green张量$\\mathbf{C}=\\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$和Green–Lagrange应变张量$\\mathbf{E}=\\tfrac{1}{2}\\left(\\mathbf{C}-\\mathbf{I}\\right)$，推导此映射的Green–Lagrange应变分量$E_{xx}$，$E_{yy}$和$E_{xy}$作为$\\theta$的函数。然后，用文字简要解释为什么即使该场的意图是刚体平面旋转，$\\mathbf{E}\\neq\\mathbf{0}$仍然成立，并阐明其对有限元屈曲和后屈曲分析中几何非线性的影响。\n\n以三元组$\\left(E_{xx},\\,E_{yy},\\,E_{xy}\\right)$的形式提供您的最终定量答案。无需四舍五入，也无需单位。定性解释不属于最终数值表达式的一部分，但必须包含在您的推导中。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n步骤1：提取已知条件。\n- 运动学映射：平面。\n- 参考坐标：$\\left(X,Y\\right)$。\n- 位移场分量：$u_x\\left(X,Y\\right)=-\\theta\\,Y$，$u_y\\left(X,Y\\right)=\\theta\\,X$。\n- 参数：$\\theta$是一个常数，可能为有限值。\n- 定义：\n    - 变形梯度：$\\mathbf{F}=\\partial\\mathbf{x}/\\partial\\mathbf{X}$。\n    - 右Cauchy–Green张量：$\\mathbf{C}=\\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$。\n    - Green–Lagrange应变张量：$\\mathbf{E}=\\tfrac{1}{2}\\left(\\mathbf{C}-\\mathbf{I}\\right)$。\n- 任务：\n    1. 推导分量$E_{xx}$，$E_{yy}$和$E_{xy}$作为$\\theta$的函数。\n    2. 解释为什么对于这个旨在表示刚体旋转的场，$\\mathbf{E}\\neq\\mathbf{0}$。\n    3. 阐明其对有限元分析中几何非线性的影响。\n\n步骤2：验证。\n该问题具有科学依据，使用了连续介质力学的标准定义。问题提法恰当，为唯一的推导提供了所有必要信息。它客观地呈现了一个关于有限旋转运动学的标准（尽管微妙）教学问题。所提供的位移场$u_x = -\\theta Y$和$u_y = \\theta X$通常被表示为微小转动，而该问题正确地用它来说明在使用非线性应变度量时，将这种简化应用于有限运动（$\\theta$是有限的）的后果。这是非线性固体力学中一个有效且重要的概念。该问题不违反任何无效标准。\n\n步骤3：结论。\n问题有效。将提供解答。\n\n推导从基本运动学关系开始。物质点在参考构型中的位置矢量为$\\mathbf{X} = X\\mathbf{e}_x + Y\\mathbf{e}_y$。位移矢量为$\\mathbf{u} = u_x\\mathbf{e}_x + u_y\\mathbf{e}_y = -\\theta Y\\mathbf{e}_x + \\theta X\\mathbf{e}_y$。当前（变形后）构型中的位置矢量$\\mathbf{x}$是参考位置和位移之和：\n$$\n\\mathbf{x} = \\mathbf{X} + \\mathbf{u} = \\left(X - \\theta Y\\right)\\mathbf{e}_x + \\left(Y + \\theta X\\right)\\mathbf{e}_y\n$$\n当前位置的分量为$x_1 = X - \\theta Y$和$x_2 = Y + \\theta X$。\n\n变形梯度张量$\\mathbf{F}$由其分量$F_{ij} = \\frac{\\partial x_i}{\\partial X_j}$定义。我们计算这些分量：\n$$\nF_{11} = \\frac{\\partial x_1}{\\partial X} = \\frac{\\partial}{\\partial X}\\left(X - \\theta Y\\right) = 1\n$$\n$$\nF_{12} = \\frac{\\partial x_1}{\\partial Y} = \\frac{\\partial}{\\partial Y}\\left(X - \\theta Y\\right) = -\\theta\n$$\n$$\nF_{21} = \\frac{\\partial x_2}{\\partial X} = \\frac{\\partial}{\\partial X}\\left(Y + \\theta X\\right) = \\theta\n$$\n$$\nF_{22} = \\frac{\\partial x_2}{\\partial Y} = \\frac{\\partial}{\\partial Y}\\left(Y + \\theta X\\right) = 1\n$$\n变形梯度的矩阵形式为：\n$$\n\\mathbf{F} = \\begin{pmatrix} 1  -\\theta \\\\ \\theta  1 \\end{pmatrix}\n$$\n接下来，我们计算右Cauchy–Green张量，$\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$。$\\mathbf{F}$的转置是$\\mathbf{F}^{\\mathsf{T}} = \\begin{pmatrix} 1  \\theta \\\\ -\\theta  1 \\end{pmatrix}$。乘积为：\n$$\n\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F} = \\begin{pmatrix} 1  \\theta \\\\ -\\theta  1 \\end{pmatrix} \\begin{pmatrix} 1  -\\theta \\\\ \\theta  1 \\end{pmatrix} = \\begin{pmatrix} 1\\cdot1 + \\theta\\cdot\\theta  1\\cdot(-\\theta) + \\theta\\cdot1 \\\\ -\\theta\\cdot1 + 1\\cdot\\theta  (-\\theta)\\cdot(-\\theta) + 1\\cdot1 \\end{pmatrix}\n$$\n$$\n\\mathbf{C} = \\begin{pmatrix} 1 + \\theta^2  0 \\\\ 0  1 + \\theta^2 \\end{pmatrix}\n$$\n最后，我们计算Green–Lagrange应变张量，$\\mathbf{E} = \\frac{1}{2}(\\mathbf{C} - \\mathbf{I})$，其中$\\mathbf{I}$是二阶单位张量。\n$$\n\\mathbf{E} = \\frac{1}{2} \\left( \\begin{pmatrix} 1 + \\theta^2  0 \\\\ 0  1 + \\theta^2 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} \\theta^2  0 \\\\ 0  \\theta^2 \\end{pmatrix}\n$$\n$$\n\\mathbf{E} = \\begin{pmatrix} \\frac{1}{2}\\theta^2  0 \\\\ 0  \\frac{1}{2}\\theta^2 \\end{pmatrix}\n$$\n从这个矩阵中，我们可以确定所求的应变分量：\n$E_{xx} = \\frac{1}{2}\\theta^2$\n$E_{yy} = \\frac{1}{2}\\theta^2$\n$E_{xy} = 0$\n\n现在进行定性解释。应变张量$\\mathbf{E}$不为零，对于任何$\\theta \\neq 0$，都有$E_{xx}  0$和$E_{yy}  0$。这表明该变形不是纯粹的刚体运动。真正的刚体运动必须保持任意两物质点之间的距离不变，这要求右Cauchy-Green张量$\\mathbf{C}$等于单位张量$\\mathbf{I}$。如果$\\mathbf{C} = \\mathbf{I}$，则$\\mathbf{E} = \\frac{1}{2}(\\mathbf{I} - \\mathbf{I}) = \\mathbf{0}$。我们的计算表明$\\mathbf{C} = (1+\\theta^2)\\mathbf{I}$，这表示在旋转的同时发生了均匀拉伸。\n\n所给定的位移场$\\mathbf{u} = (-\\theta Y, \\theta X)$实际上是真实有限旋转的线性化，仅对无穷小角度$d\\theta$有效。一个角度为$\\phi$的真实有限旋转由坐标变换$x = X\\cos\\phi - Y\\sin\\phi$和$y = X\\sin\\phi + Y\\cos\\phi$给出。相应的位移场是$u_x = X(\\cos\\phi - 1) - Y\\sin\\phi$和$u_y = X\\sin\\phi + Y(\\cos\\phi - 1)$。对于无穷小角度$\\phi$，我们使用近似$\\sin\\phi \\approx \\phi$和$\\cos\\phi \\approx 1 - \\frac{1}{2}\\phi^2$。位移变为$u_x \\approx X(-\\frac{1}{2}\\phi^2) - Y\\phi$和$u_y \\approx X\\phi + Y(-\\frac{1}{2}\\phi^2)$。问题陈述中使用的位移场仅保留了角度参数的线性项，即$u_x \\approx -Y\\theta$和$u_y \\approx X\\theta$。这种截断的描述无法满足有限旋转的长度保持条件。在$\\sin\\phi$和$\\cos\\phi$表达式中的非线性项正是抵消有限旋转期间由线性项引入的伪应变所必需的。Green-Lagrange张量正确地检测出这种简化的运动学描述未能表示真实刚体运动，从而产生了非零的应变分量。\n\n这对于几何非线性有限元分析，特别是对于固有大旋转的屈曲和后屈曲问题，其影响至关重要。使用非客观（即在刚体运动下非不变）的简化运动学度量，将导致仅由大旋转就预测出虚假的应变和应力。这种现象被称为“膜锁定”或“伪刚度”，会导致对结构刚度的错误高估，从而错误地预测屈曲载荷和后屈曲行为。因此，必须采用非线性应变度量，例如从完整的非线性运动学框架推导出的Green-Lagrange张量。这种“客观”度量能为任何刚体运动正确地得出零应变，确保计算出的应力仅由材料的真实物理变形引起。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}\\theta^{2}  \\frac{1}{2}\\theta^{2}  0 \\end{pmatrix}}\n$$", "id": "2584373"}, {"introduction": "理解了非线性运动学的必要性之后，下一步是将其转化为有限元分析中的实用工具。本练习将指导您从虚功原理出发，推导二维桁架单元的几何刚度矩阵，也称为初始应力刚度矩阵。这个矩阵是线性化屈曲分析的核心，它精确地捕捉了单元在初始轴向力作用下，横向位移如何引起附加的刚度变化，这是预测结构失稳临界点的关键。[@problem_id:2584381]", "problem": "一个直的、铰接的二维桁架单元连接节点 $1$ 和 $2$，其未变形长度为 $L$，方向角 $\\theta$ 从全局 $X$ 轴测量。设全局节点位移向量的顺序为 $\\{d\\} = [u_{X1},\\,u_{Y1},\\,u_{X2},\\,u_{Y2}]^{\\mathsf{T}}$。该单元承受一个沿单元长度恒定的、均匀的、预先存在的轴向力 $N$。采用符号约定，拉伸时 $N$ 为正；对于压缩状态，$N  0$。 \n\n使用虚功原理的总拉格朗日形式和细长杆的Green–Lagrange轴向应变，推导在全局坐标系下，关于直线、预应力构型的增量平衡的一致初始应力（几何）刚度矩阵。假设沿单元轴的横向位移为线性插值，并保留Green–Lagrange应变中将轴向力 $N$ 与横向位移梯度耦合的二次项。用 $c=\\cos\\theta$ 和 $s=\\sin\\theta$ 表示方向余弦，并设以全局分量表示的局部横向单位法向量（垂直于单元轴）为 $\\mathbf{n}=[-s,\\;c]^{\\mathsf{T}}$。\n\n将您的最终答案表示为一个单一的、与全局节点位移向量 $\\{d\\}$ 相乘的闭合形式 $4\\times 4$ 矩阵 $\\mathbf{K}_{g}^{(g)}(N,L,c,s)$，用 $N$、$L$、$c$ 和 $s$ 表示。明确显示 $\\mathbf{K}_{g}^{(g)}$ 如何随 $N$ 和 $L$ 缩放。无需进行数值计算；请提供符号表达式。无需舍入。最终矩阵中不应包含单位。", "solution": "该问题要求推导二维桁架单元的几何刚度矩阵。此推导在总拉格朗日框架内进行，从虚功原理出发，并采用专用于细长杆单元的Green-Lagrange应变度量。\n\n初始应力对切线刚度矩阵的贡献，即所谓的几何或初始应力刚度矩阵 $\\mathbf{K}_g$，源于初始轴向力 $N$ 在单元变形过程中所做的功。虚功原理增量形式中的相关项是：\n$$ \\delta W_g = \\int_{V_0} S_0 \\, \\delta E_{NL} \\, dV_0 $$\n其中，$S_0$ 是参考构型中的初始第二Piola-Kirchhoff应力，$E_{NL}$ 是Green-Lagrange应变张量的非线性部分。对于具有恒定预定义轴向力 $N$ 和初始横截面积 $A_0$ 的桁架单元，初始应力是均匀的，$S_0 = N/A_0$。对初始体积 $V_0$ 的积分简化为对单元初始长度 $L$ 的积分：\n$$ \\delta W_g = \\int_{0}^{L} (A_0 S_0) \\, \\delta E_{NL} \\, dx = \\int_{0}^{L} N \\, \\delta E_{NL} \\, dx $$\n杆单元的Green-Lagrange轴向应变为：\n$$ E = \\frac{\\partial u}{\\partial x} + \\frac{1}{2} \\left[ \\left(\\frac{\\partial u}{\\partial x}\\right)^2 + \\left(\\frac{\\partial v}{\\partial x}\\right)^2 \\right] $$\n其中 $u(x)$ 和 $v(x)$ 分别是单元局部坐标系中的轴向和横向位移。问题指明要保留将轴向力与横向位移梯度耦合的二次项。这意味着我们将非线性应变项视为：\n$$ E_{NL} = \\frac{1}{2} \\left(\\frac{dv}{dx}\\right)^2 $$\n该项的变分为 $\\delta E_{NL} = \\frac{dv}{dx} \\delta\\left(\\frac{dv}{dx}\\right)$。将其代入 $\\delta W_g$ 的表达式中可得：\n$$ \\delta W_g = \\int_{0}^{L} N \\left(\\frac{dv}{dx}\\right) \\delta\\left(\\frac{dv}{dx}\\right) dx $$\n问题陈述假设横向位移 $v(x)$ 基于局部节点横向位移 $u_{y1}$ 和 $u_{y2}$ 进行线性插值：\n$$ v(x) = \\left(1 - \\frac{x}{L}\\right) u_{y1} + \\left(\\frac{x}{L}\\right) u_{y2} $$\n横向位移的梯度，代表单元的转动，因此沿其长度是恒定的：\n$$ \\frac{dv}{dx} = \\frac{1}{L} (u_{y2} - u_{y1}) $$\n该梯度的变分为：\n$$ \\delta\\left(\\frac{dv}{dx}\\right) = \\frac{1}{L} (\\delta u_{y2} - \\delta u_{y1}) $$\n将梯度及其变分的这些表达式代入 $\\delta W_g$ 的积分中：\n$$ \\delta W_g = \\int_{0}^{L} N \\left[ \\frac{1}{L} (u_{y2} - u_{y1}) \\right] \\left[ \\frac{1}{L} (\\delta u_{y2} - \\delta u_{y1}) \\right] dx $$\n由于被积函数相对于 $x$ 是常数，积分是平凡的：\n$$ \\delta W_g = \\frac{N}{L^2} (u_{y2} - u_{y1}) (\\delta u_{y2} - \\delta u_{y1}) \\int_{0}^{L} dx = \\frac{N}{L} (u_{y2} - u_{y1}) (\\delta u_{y2} - \\delta u_{y1}) $$\n该表达式可以写成矩阵形式 $\\delta W_g = \\{\\delta d'\\}^{\\mathsf{T}} \\mathbf{K}_g^{(l)} \\{d'\\}$，其中 $\\{d'\\} = [u_{x1}, u_{y1}, u_{x2}, u_{y2}]^{\\mathsf{T}}$ 是局部节点位移向量。展开该表达式可得：\n$$ \\delta W_g = \\frac{N}{L} (\\delta u_{y1} u_{y1} - \\delta u_{y1} u_{y2} - \\delta u_{y2} u_{y1} + \\delta u_{y2} u_{y2}) $$\n从此二次型中，可以确定局部几何刚度矩阵 $\\mathbf{K}_g^{(l)}$ 为：\n$$ \\mathbf{K}_g^{(l)} = \\frac{N}{L} \\begin{pmatrix} 0  0  0  0 \\\\ 0  1  0  -1 \\\\ 0  0  0  0 \\\\ 0  -1  0  1 \\end{pmatrix} $$\n为了获得全局坐标系中的几何刚度矩阵 $\\mathbf{K}_g^{(g)}$，我们使用旋转矩阵 $\\mathbf{T}$ 进行合同变换：\n$$ \\mathbf{K}_g^{(g)} = \\mathbf{T}^{\\mathsf{T}} \\mathbf{K}_g^{(l)} \\mathbf{T} $$\n旋转矩阵 $\\mathbf{T}$ 将全局位移 $\\{d\\}$ 转换为局部位移 $\\{d'\\}$，并使用方向余弦 $c = \\cos\\theta$ 和 $s = \\sin\\theta$ 构建：\n$$ \\mathbf{T} = \\begin{pmatrix} c  s  0  0 \\\\ -s  c  0  0 \\\\ 0  0  c  s \\\\ 0  0  -s  c \\end{pmatrix} $$\n转置矩阵为：\n$$ \\mathbf{T}^{\\mathsf{T}} = \\begin{pmatrix} c  -s  0  0 \\\\ s  c  0  0 \\\\ 0  0  c  -s \\\\ 0  0  s  c \\end{pmatrix} $$\n执行矩阵乘法 $\\mathbf{K}_g^{(g)} = \\mathbf{T}^{\\mathsf{T}} \\left( \\frac{N}{L} \\begin{pmatrix} 0  0  0  0 \\\\ 0  1  0  -1 \\\\ 0  0  0  0 \\\\ 0  -1  0  1 \\end{pmatrix} \\right) \\mathbf{T}$：\n$$ \\mathbf{K}_g^{(g)} = \\frac{N}{L} \\mathbf{T}^{\\mathsf{T}} \\begin{pmatrix} 0  0  0  0 \\\\ -s  c  s  -c \\\\ 0  0  0  0 \\\\ s  -c  -s  c \\end{pmatrix} $$\n$$ \\mathbf{K}_g^{(g)} = \\frac{N}{L} \\begin{pmatrix} c  -s  0  0 \\\\ s  c  0  0 \\\\ 0  0  c  -s \\\\ 0  0  s  c \\end{pmatrix} \\begin{pmatrix} 0  0  0  0 \\\\ -s  c  s  -c \\\\ 0  0  0  0 \\\\ s  -c  -s  c \\end{pmatrix} $$\n此乘法得出最终矩阵。矩阵元素计算如下：\n第1行：$[s^2, -sc, -s^2, sc]$\n第2行：$[-sc, c^2, sc, -c^2]$\n第3行：$[-s^2, sc, s^2, -sc]$\n第4行：$[sc, -c^2, -sc, c^2]$\n得到的全局几何刚度矩阵为：\n$$ \\mathbf{K}_g^{(g)} = \\frac{N}{L} \\begin{pmatrix} s^2  -sc  -s^2  sc \\\\ -sc  c^2  sc  -c^2 \\\\ -s^2  sc  s^2  -sc \\\\ sc  -c^2  -sc  c^2 \\end{pmatrix} $$\n该矩阵清楚地显示了它与轴向力 $N$ 成正比的缩放关系以及与长度 $L$ 成反比的缩放关系。它与 $N/L$ 成正比。这就是二维桁架单元的一致几何刚度矩阵。", "answer": "$$\n\\boxed{\\frac{N}{L} \\begin{pmatrix} s^{2}  -sc  -s^{2}  sc \\\\ -sc  c^{2}  sc  -c^{2} \\\\ -s^{2}  sc  s^{2}  -sc \\\\ sc  -c^{2}  -sc  c^{2} \\end{pmatrix}}\n$$", "id": "2584381"}, {"introduction": "具备了单元层面的理论工具后，我们需面对求解全局非线性平衡路径的算法挑战。本计算练习通过一个能够展示复杂“回弹”（snap-back）现象的单自由度模型，让您亲手实现一个基本的荷载控制路径追踪算法。通过这个实践，您将直接观察到该算法在荷载-位移曲线的极限点附近如何失效，从而深刻理解在进行高级后屈曲分析时，为何必须采用如弧长法等更为稳健的数值策略。[@problem_id:2584348]", "problem": "构建一个在荷载-位移响应中表现出回弹（snap-back）的极简离散模型，并用它来揭示有限元方法中荷载控制算法所面临的挑战。从总势能驻值原理出发，考虑一个后屈曲结构响应的单自由度代理模型，其总势能为\n$$\\Pi(u;P) = U(u) - P\\,u,$$\n其中，$u$ 是广义位移（单位：米），$P$ 是施加的标量荷载（单位：牛顿），储存的能量函数为\n$$U(u) = \\tfrac{1}{2}k\\,u^{2} - \\tfrac{1}{4}\\alpha\\,u^{4} + \\tfrac{1}{6}\\beta\\,u^{6}.$$\n这里，$k$（单位：$\\mathrm{N/m}$）、$\\alpha$（单位：$\\mathrm{N/m^{3}}$）和 $\\beta$（单位：$\\mathrm{N/m^{5}}$）是正常数。这个拟设可以解释为一个极简离散单元的能量，该单元捕捉了导致软化和随后再硬化的几何非线性。\n\n任务：\n- 从驻值条件 $d\\Pi/du=0$ 出发，推导残差形式的标量平衡方程 $r(u;P)=0$，以及牛顿型迭代所需的切线（雅可比）。清晰解释在此离散背景下，内力和切线刚度是什么。\n- 展示平衡路径上的转折点（极限点）是如何从荷载-位移曲线上的驻值条件产生的。推导一个表征转折点的代数条件，并确定作为参数 $k$、$\\alpha$ 和 $\\beta$ 的函数，可以出现多少个实的正转折点。\n- 仅使用荷载控制（即，给定 $P$ 并求解 $u$），设计一个增量-迭代 Newton-Raphson 过程来追踪从 $P=0$ 到指定目标 $P_{\\max}^{\\mathrm{tar}}$ 的平衡路径。假设有固定的荷载步数 $N_{\\mathrm{steps}}$，残差的收敛容差 $\\varepsilon$，以及每步的最大牛顿迭代次数 $N_{\\mathrm{it}}^{\\max}$。如果某一步未能收敛，则终止并报告成功收敛的步数。\n- 参考推导出的切线，识别并解释当路径接近并试图通过一个转折点（回弹）时，荷载控制所遇到的算法挑战。\n\n测试套件：\n考虑以下3种参数情况（全部采用国际单位制，即力单位为牛顿，位移单位为米）：\n- 情况1：$k=1000$，$\\alpha=10$，$\\beta=1$， $P_{\\max}^{\\mathrm{tar}}=500$， $N_{\\mathrm{steps}}=50$。\n- 情况2：$k=100$，$\\alpha=60$，$\\beta=5$， $P_{\\max}^{\\mathrm{tar}}=60$， $N_{\\mathrm{steps}}=50$。\n- 情况3：$k=22.5$，$\\alpha=10$，$\\beta=2$， $P_{\\max}^{\\mathrm{tar}}=16$， $N_{\\mathrm{steps}}=40$。\n\n对于每种情况：\n- 确定平衡路径上正转折点的数量。将重复的转折点计为1个。\n- 计算转折点处的最大荷载（如果有的话），定义为正转折点中 $P(u)$ 的最大值。如果没有转折点，则报告此量为 $0$。此荷载以牛顿为单位表示，四舍五入到小数点后三位。\n- 执行所述的荷载控制 Newton-Raphson 过程，残差容差为 $\\varepsilon = 10^{-10}$，每步迭代上限为 $N_{\\mathrm{it}}^{\\max} = 50$，从 $P=0$ 时的 $u=0$ 开始，报告在失败前成功收敛的荷载步数（如果未发生失败，则为 $N_{\\mathrm{steps}}$）。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的扁平的、逗号分隔的列表。该列表必须按顺序串联每种情况的三元组\n$[\\text{count}, \\text{P\\_max\\_turn}, \\text{steps\\_converged}]$,\n其中 $\\text{count}$ 是一个整数，$\\text{P\\_max\\_turn}$ 是一个小数点后有三位的浮点数（单位：牛顿），$\\text{steps\\_converged}$ 是一个整数。因此，对于这三种情况，最终的单行输出必须按顺序包含9个值，排列如下\n$[\\text{c1},\\text{p1},\\text{s1},\\text{c2},\\text{p2},\\text{s2},\\text{c3},\\text{p3},\\text{s3}]$，不含任何附加文本。", "solution": "该问题陈述经验证是连贯的、有科学依据且良定的。分析将从总势能驻值这一基本原理出发，推导指定离散系统的平衡行为和算法响应。\n\n系统的总势能由下式给出\n$$\\Pi(u;P) = U(u) - P\\,u,$$\n其中应变能 $U(u)$ 为\n$$U(u) = \\tfrac{1}{2}k\\,u^{2} - \\tfrac{1}{4}\\alpha\\,u^{4} + \\tfrac{1}{6}\\beta\\,u^{6}.$$\n这里，$u$ 是广义位移，$P$ 是施加的荷载，$k, \\alpha, \\beta$ 是正的材料和几何参数。\n\n**平衡方程与切线刚度**\n\n平衡的条件是总势能相对于广义坐标 $u$ 是驻定的。这表示为 $\\Pi$ 的一阶导数为零：\n$$\\frac{d\\Pi}{du} = \\frac{dU}{du} - P = 0.$$\n计算应变能 $U(u)$ 的导数，得到系统的内力，记为 $P_{\\mathrm{int}}(u)$:\n$$P_{\\mathrm{int}}(u) = \\frac{dU}{du} = k\\,u - \\alpha\\,u^{3} + \\beta\\,u^{5}.$$\n在平衡状态下，内力必须与外荷载 $P$ 相平衡。这导出了平衡路径方程 $P(u)$:\n$$P(u) = k\\,u - \\alpha\\,u^{3} + \\beta\\,u^{5}.$$\n对于像 Newton-Raphson 法这样的数值解法，通常将平衡条件表述为残差形式 $r(u;P) = 0$。残差代表了给定状态 $(u,P)$ 下的力不平衡：\n$$r(u;P) = P_{\\mathrm{int}}(u) - P = k\\,u - \\alpha\\,u^{3} + \\beta\\,u^{5} - P.$$\nNewton-Raphson 法需要对残差函数进行线性化，这涉及到它对未知位移 $u$ 的导数。这个导数就是切线刚度 $K_T(u)$，在这个单自由度的情况下，它是雅可比矩阵的标量等价物：\n$$K_T(u) = \\frac{dr}{du} = \\frac{dP_{\\mathrm{int}}(u)}{du} = \\frac{d^2U}{du^2}.$$\n计算这个导数，得到切线刚度的表达式：\n$$K_T(u) = k - 3\\alpha\\,u^{2} + 5\\beta\\,u^{4}.$$\n\n**转折点分析**\n\n荷载-位移平衡路径上的转折点（极限点）是荷载 $P(u)$ 相对于位移 $u$ 达到局部极值的位置。在数学上，这对应于荷载对位移的导数为零的条件：\n$$\\frac{dP}{du} = 0.$$\n从上面的推导可以看出，这个条件与切线刚度为零是相同的：$K_T(u) = 0$。因此，发生转折点时的位移是以下方程的根：\n$$5\\beta\\,u^{4} - 3\\alpha\\,u^{2} + k = 0.$$\n这是一个双二次方程。令 $x = u^2$。因为我们关心的是实数位移 $u$，所以我们需要 $x$ 的实数正解。该方程转换为关于 $x$ 的二次方程：\n$$5\\beta\\,x^{2} - 3\\alpha\\,x + k = 0.$$\n$x$ 的解由二次公式给出：\n$$x = \\frac{3\\alpha \\pm \\sqrt{(3\\alpha)^2 - 4(5\\beta)(k)}}{2(5\\beta)} = \\frac{3\\alpha \\pm \\sqrt{9\\alpha^2 - 20k\\beta}}{10\\beta}.$$\n$u$ 的实数解的性质和数量取决于判别式 $\\Delta = 9\\alpha^2 - 20k\\beta$。\n\n1.  如果 $\\Delta  0$（即 $9\\alpha^2  20k\\beta$）：$x$ 没有实数解，因此平衡路径上没有转折点。荷载-位移曲线是单调的。\n2.  如果 $\\Delta = 0$（即 $9\\alpha^2 = 20k\\beta$）：$x$ 有一个实数解 $x = \\frac{3\\alpha}{10\\beta}$。由于 $k, \\alpha, \\beta$ 都是正数，所以 $x$ 是正的。这产生一对对称解 $u = \\pm\\sqrt{x}$，对应一个正的转折点。\n3.  如果 $\\Delta > 0$（即 $9\\alpha^2 > 20k\\beta$）：$x$ 有两个不同的实数解。由于 $\\sqrt{9\\alpha^2 - 20k\\beta}  \\sqrt{9\\alpha^2} = 3\\alpha$，两个分子 $3\\alpha \\pm \\sqrt{\\Delta}$ 都是正的。因为 $\\beta > 0$，所以两个解 $x_1$ 和 $x_2$ 都是正的。每个正的 $x$ 都给出一对 $u$ 的实数解，从而产生两个不同的正转折点。\n\n**荷载控制 Newton-Raphson 过程**\n\n任务要求使用荷载控制的增量-迭代策略来追踪平衡路径。将总目标荷载 $P_{\\max}^{\\mathrm{tar}}$ 分成 $N_{\\mathrm{steps}}$ 个相等的增量，$\\Delta P = P_{\\max}^{\\mathrm{tar}} / N_{\\mathrm{steps}}$。该过程从已知的平衡状态 $(u,P) = (0,0)$ 开始。\n\n对于每个荷载步 $i = 1, \\dots, N_{\\mathrm{steps}}$:\n1.  将目标荷载设为 $P_i = i \\cdot \\Delta P$。\n2.  启动 Newton-Raphson 迭代，以找到满足 $r(u_i; P_i) = 0$ 的相应平衡位移 $u_i$。\n3.  第 $i$ 步位移的初始猜测是上一步的收敛解，$u_i^{(0)} = u_{i-1}$（其中 $u_0 = 0$）。\n4.  对于迭代 $j=0, 1, 2, \\dots$，迭代更新过程如下：\n    $$u_i^{(j+1)} = u_i^{(j)} - \\left[K_T(u_i^{(j)})\\right]^{-1} r(u_i^{(j)}; P_i).$$\n5.  迭代继续，直到残差的范数低于容差 $|r(u_i^{(j)}; P_i)|  \\varepsilon$，或者达到最大迭代次数 $N_{\\mathrm{it}}^{\\max}$。\n6.  如果在 $N_{\\mathrm{it}}^{\\max}$ 次迭代内未达到收敛，则过程终止并报告失败。\n\n**荷载控制的算法挑战**\n\n荷载控制方法很简单，但在处理涉及转折点（如突跳或回弹）的非线性响应时，存在根本性的局限。\n\n1.  **极限点处的奇异性：** 当平衡状态 $(u, P(u))$ 接近转折点时，切线刚度 $K_T(u)$ 趋近于零。Newton-Raphson 修正量 $\\Delta u = -r/K_T$ 变得无界。这导致了大的、非物理的位移更新，使得迭代过程超越解、振荡并最终发散。该算法在极限点或其附近无法收敛。\n\n2.  **无法穿越转折点：** 荷载控制，根据其定义，规定了一个单调递增的荷载水平序列。然而，要追踪超过最大荷载点（突跳）或最小荷载点（回弹）的平衡路径，荷载参数必须减小。荷载控制方案在算法上无法跟进这样的路径段。当一个荷载增量试图将系统推到一个在当前路径分支上没有稳定平衡存在的荷载水平时（即，荷载大于局部最大值），求解器将无法找到解。\n\n3.  **解的多重性：** 对于介于最大和最小转折点值之间的荷载，存在多个平衡位移 $u$。标准的 Newton-Raphson 方法使用前一个解作为初始猜测，通常会收敛到最近的连续路径段上的解。它没有机制跳转到其他可能稳定的平衡构型。这并不是极限点本身失败的主要原因，但它凸显了荷载控制无法探索的解空间的复杂性。\n\n这些挑战表明了为什么荷载控制不足以分析复杂的后屈曲行为。需要更稳健的路径追踪算法，如弧长法（例如 Riks 或 Crisfield 方法）。这些方法将荷载和位移都视为变量，在荷载-位移空间中为增量步的“长度”增加一个约束方程，这使它们能够成功地穿越极限点。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the three specified test cases.\n    For each case, it determines the number of turning points, the maximum load\n    at these points, and the number of successfully converged steps in a\n    load-controlled simulation.\n    \"\"\"\n\n    test_cases = [\n        # k, alpha, beta, P_max_tar, N_steps\n        (1000.0, 10.0, 1.0, 500.0, 50),\n        (100.0, 60.0, 5.0, 60.0, 50),\n        (22.5, 10.0, 2.0, 16.0, 40),\n    ]\n\n    # Algorithm parameters from problem statement\n    epsilon = 1e-10\n    n_it_max = 50\n\n    results = []\n    for case in test_cases:\n        k, alpha, beta, p_max_tar, n_steps = case\n        \n        # Task 1: Analyze turning points\n        count, p_max_turn = analyze_turning_points(k, alpha, beta)\n        \n        # Task 2: Run load-controlled Newton-Raphson simulation\n        steps_converged = run_load_control(k, alpha, beta, p_max_tar, n_steps, epsilon, n_it_max)\n        \n        results.append(count)\n        results.append(f\"{p_max_turn:.3f}\")\n        results.append(steps_converged)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef analyze_turning_points(k, alpha, beta):\n    \"\"\"\n    Determines the number of positive turning points and the maximum load at those points.\n    \n    A turning point occurs where the tangent stiffness K_T = 5*beta*u^4 - 3*alpha*u^2 + k is zero.\n    This is a quadratic equation in u^2.\n    \"\"\"\n    discriminant = (3 * alpha)**2 - 4 * (5 * beta) * k\n\n    if discriminant  0:\n        return 0, 0.0\n\n    # The problem specifies k, alpha, beta > 0.\n    # The term sqrt(9*alpha^2 - 20*k*beta) is always less than 3*alpha.\n    # Thus, if real solutions for u^2 exist, they must be positive.\n    \n    if discriminant == 0:\n        # One repeated positive root for u^2\n        u_sq = (3 * alpha) / (10 * beta)\n        u_tp = np.sqrt(u_sq)\n        p_tp = u_tp * (k - alpha * u_tp**2 + beta * u_tp**4)\n        return 1, p_tp\n    else: # discriminant > 0\n        # Two distinct positive roots for u^2\n        sqrt_disc = np.sqrt(discriminant)\n        u_sq1 = (3 * alpha - sqrt_disc) / (10 * beta)\n        u_sq2 = (3 * alpha + sqrt_disc) / (10 * beta)\n\n        u_tp1 = np.sqrt(u_sq1)\n        u_tp2 = np.sqrt(u_sq2)\n\n        p_tp1 = u_tp1 * (k - alpha * u_tp1**2 + beta * u_tp1**4)\n        p_tp2 = u_tp2 * (k - alpha * u_tp2**2 + beta * u_tp2**4)\n        \n        return 2, max(p_tp1, p_tp2)\n\ndef run_load_control(k, alpha, beta, p_max_tar, n_steps, tol, max_it):\n    \"\"\"\n    Performs an incremental-iterative analysis using load control and Newton-Raphson.\n    Returns the number of successfully converged load steps.\n    \"\"\"\n    delta_p = p_max_tar / n_steps\n    u_converged = 0.0  # Converged displacement from the previous step\n\n    for i in range(1, n_steps + 1):\n        p_target = i * delta_p\n        u_k = u_converged  # Initial guess for the current step (predictor)\n        \n        step_converged = False\n        for _ in range(max_it):\n            # Calculate residual force\n            residual = k * u_k - alpha * u_k**3 + beta * u_k**5 - p_target\n            \n            # Check for convergence\n            if abs(residual)  tol:\n                u_converged = u_k\n                step_converged = True\n                break\n            \n            # Calculate tangent stiffness\n            tangent = k - 3 * alpha * u_k**2 + 5 * beta * u_k**4\n            \n            # Check for singularity (a symptom of approaching a limit point)\n            if abs(tangent)  1e-12:\n                # Singular tangent, iteration will fail. Break early.\n                break\n            \n            # Calculate displacement correction and update\n            delta_u = -residual / tangent\n            u_k += delta_u\n        \n        if not step_converged:\n            # Current step i failed to converge. Return number of last successful step.\n            return i - 1\n            \n    # All steps converged\n    return n_steps\n\nsolve()\n```", "id": "2584348"}]}