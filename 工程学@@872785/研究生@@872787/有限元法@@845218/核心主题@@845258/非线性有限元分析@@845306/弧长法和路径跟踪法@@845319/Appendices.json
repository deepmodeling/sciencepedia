{"hands_on_practices": [{"introduction": "在学习如何利用弧长法追踪复杂的平衡路径之前，我们首先需要理解这些“复杂”区域的本质特征。本练习将引导你从静态平衡的基本原理出发，推导出荷载-位移路径上“极限点”（limit point）或“转折点”（turning point）的数学条件。通过这个推导实践，你将牢固掌握极限点与切向刚度为零之间的深刻联系，并理解为何标准荷载控制方法在此会失效。[@problem_id:2541468]", "problem": "考虑一个在有限元方法（FEM）框架内的标量、单自由度非线性弹簧，其内力定律由 $f_{\\mathrm{int}}(u)=k\\,u+\\beta\\,u^{3}$ 给出，其中 $k>0$ 且 $\\beta0$，承受一个形状恒定、大小比例为 $p0$ 的恒载荷，因此外力为 $f_{\\mathrm{ext}}(\\lambda)=\\lambda\\,p$。在 Riks（弧长）路径跟踪设置中，将载荷因子 $\\lambda$ 和位移 $u$ 作为未知数。\n\n从静态平衡的控制原理 $f_{\\mathrm{int}}(u)=f_{\\mathrm{ext}}(\\lambda)$ 出发，并将平衡路径视为 $(u,\\lambda)$ 平面内的一个隐式定义曲线，执行以下操作：明确地表达残差 $r(u,\\lambda)$，用 $r(u,\\lambda)$ 陈述平衡条件，并通过分析平衡路径的转折点，确定第一个极限点（即 $\\lambda(u)$ 的第一个极值点）处的正临界载荷因子 $\\lambda_{\\mathrm{cr}}$。您的推导必须从静态平衡陈述和切线刚度的定义出发，不得假设任何预先推导的路径跟踪公式。\n\n请以一个包含 $k$、$\\beta$ 和 $p$ 的单一闭式代数表达式的形式给出 $\\lambda_{\\mathrm{cr}}$ 的最终答案。最终答案中不要包含单位。无需进行数值四舍五入。", "solution": "该问题需要进行验证。已知条件为：内力 $f_{\\mathrm{int}}(u) = k\\,u + \\beta\\,u^{3}$，其中 $k0$，$\\beta0$；外力 $f_{\\mathrm{ext}}(\\lambda) = \\lambda\\,p$，其中 $p0$；以及静态平衡条件 $f_{\\mathrm{int}}(u) = f_{\\mathrm{ext}}(\\lambda)$。任务是找到第一个极限点处的临界载荷因子 $\\lambda_{\\mathrm{cr}}$。该问题具有科学依据，提法恰当，客观，并包含足够的信息以获得唯一解。这是非线性力学中的一个典型问题。该问题被认为是有效的。\n\n解答过程从静态平衡的基本原理出发。\n\n静态平衡的控制方程由内力和外力的平衡给出：\n$$f_{\\mathrm{int}}(u) = f_{\\mathrm{ext}}(\\lambda)$$\n代入指定的力定律，我们得到：\n$$k\\,u + \\beta\\,u^{3} = \\lambda\\,p$$\n这个方程将平衡路径定义为 $(u, \\lambda)$ 平面内的一条隐式曲线。\n\n根据要求，我们将残差函数 $r(u, \\lambda)$ 定义为内力和外力之差：\n$$r(u, \\lambda) = f_{\\mathrm{int}}(u) - f_{\\mathrm{ext}}(\\lambda) = k\\,u + \\beta\\,u^{3} - \\lambda\\,p$$\n因此，平衡条件可表述为在平衡路径上的所有点，残差均为零：\n$$r(u, \\lambda) = 0$$\n\n平衡路径上的转折点或极限点，是载荷因子 $\\lambda$ 相对于位移 $u$ 达到局部极值的点。在这样的点上，$(u, \\lambda)$ 平面中路径的切线是垂直的，这意味着载荷因子对位移的导数为零，即 $\\frac{d\\lambda}{du}=0$。\n\n为了求这个导数，我们可以考虑残差 $r(u, \\lambda)$ 沿平衡路径的全微分。由于对于路径上的任何点 $(u, \\lambda)$ 都有 $r(u, \\lambda) = 0$，其全微分 $dr$ 也必须为零：\n$$dr = \\frac{\\partial r}{\\partial u} du + \\frac{\\partial r}{\\partial \\lambda} d\\lambda = 0$$\n偏导数 $\\frac{\\partial r}{\\partial u}$ 是系统的切线刚度，记为 $K_T(u)$：\n$$K_T(u) = \\frac{\\partial}{\\partial u} (k\\,u + \\beta\\,u^{3} - \\lambda\\,p) = k + 3\\beta u^2$$\n关于载荷因子 $\\lambda$ 的偏导数为：\n$$\\frac{\\partial r}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} (k\\,u + \\beta\\,u^{3} - \\lambda\\,p) = -p$$\n将这些代入 $dr$ 的表达式中，得到：\n$$(k + 3\\beta u^2) du - p\\,d\\lambda = 0$$\n由此，我们可以表达出平衡路径的斜率 $\\frac{d\\lambda}{du}$：\n$$\\frac{d\\lambda}{du} = \\frac{k + 3\\beta u^2}{p} = \\frac{K_T(u)}{p}$$\n极限点的条件 $\\frac{d\\lambda}{du}=0$ 要求分子为零，因为已知 $p0$：\n$$K_T(u) = k + 3\\beta u^2 = 0$$\n这个结果表明，极限点的特征是切线刚度的奇异性（在此标量情况下，为零）。\n\n我们现在求解极限点处的位移 $u$，记为 $u_{\\mathrm{cr}}$：\n$$3\\beta u_{\\mathrm{cr}}^2 = -k$$\n$$u_{\\mathrm{cr}}^2 = -\\frac{k}{3\\beta}$$\n由于已知 $k0$ 且 $\\beta0$，项 $-\\frac{k}{3\\beta}$ 是正的，因此 $u_{\\mathrm{cr}}$ 存在实数解：\n$$u_{\\mathrm{cr}} = \\pm \\sqrt{-\\frac{k}{3\\beta}}$$\n问题要求的是第一个极限点处的正临界载荷因子。从无变形状态 $(u, \\lambda) = (0, 0)$ 开始并施加正载荷 ($p0, \\lambda0$)，位移 $u$ 最初将是正的。因此，第一个极限点将出现在正的临界位移处：\n$$u_{\\mathrm{cr}} = \\sqrt{-\\frac{k}{3\\beta}}$$\n为了找到临界载荷因子 $\\lambda_{\\mathrm{cr}}$，我们将 $u_{\\mathrm{cr}}$ 的值代回平衡方程 $k\\,u + \\beta\\,u^{3} = \\lambda\\,p$：\n$$\\lambda_{\\mathrm{cr}} = \\frac{k\\,u_{\\mathrm{cr}} + \\beta\\,u_{\\mathrm{cr}}^{3}}{p} = \\frac{u_{\\mathrm{cr}} (k + \\beta\\,u_{\\mathrm{cr}}^2)}{p}$$\n代入 $u_{\\mathrm{cr}}$ 和 $u_{\\mathrm{cr}}^2$ 的表达式：\n$$\\lambda_{\\mathrm{cr}} = \\frac{1}{p} \\left(\\sqrt{-\\frac{k}{3\\beta}}\\right) \\left(k + \\beta \\left(-\\frac{k}{3\\beta}\\right)\\right)$$\n简化第二个括号中的项：\n$$k + \\beta \\left(-\\frac{k}{3\\beta}\\right) = k - \\frac{k}{3} = \\frac{2k}{3}$$\n将此结果代回 $\\lambda_{\\mathrm{cr}}$ 的表达式中：\n$$\\lambda_{\\mathrm{cr}} = \\frac{1}{p} \\left(\\sqrt{-\\frac{k}{3\\beta}}\\right) \\left(\\frac{2k}{3}\\right)$$\n这给出了临界载荷因子的最终闭式表达式：\n$$\\lambda_{\\mathrm{cr}} = \\frac{2k}{3p} \\sqrt{-\\frac{k}{3\\beta}}$$\n由于 $k0$，$p0$ 且 $\\beta0$，这个值是正的。这是给定系统在突跳（snap-through）场景中遇到的第一个极限点的正确值。", "answer": "$$\\boxed{\\frac{2k}{3p}\\sqrt{-\\frac{k}{3\\beta}}}$$", "id": "2541468"}, {"introduction": "理解了极限点的概念之后，下一步是掌握绕过这些点的数值技术。弧长法通过求解一个增广方程组来实现这一目标，该方程组将平衡方程与弧长约束相结合。本练习提供了一个具体的数值计算，要求你组装并求解这个核心的“加边系统”（bordered system）。掌握这一计算是理解弧长法框架下牛顿-拉弗森（Newton-Raphson）法单次修正步工作原理的关键。[@problem_id:2541431]", "problem": "考虑有限元法 (FEM) 中的一个比例加载下的非线性准静态平衡问题，其中平衡残差定义为 $r(u,\\lambda) = f_{\\mathrm{int}}(u) - \\lambda f_{\\mathrm{ext}}$。对当前迭代点 $(u^{(i)},\\lambda^{(i)})$ 进行 Newton-Raphson 线性化，得到线性化平衡方程 $K_{\\mathrm{T}} \\,\\delta u - f_{\\mathrm{ext}} \\,\\delta \\lambda = -R$，其中 $K_{\\mathrm{T}} = \\partial f_{\\mathrm{int}}/\\partial u$ 是切线刚度，$R = r(u^{(i)},\\lambda^{(i)})$ 是当前残差。在 Riks/Crisfield 弧长框架中，施加一个形式为 $a^{\\mathsf{T}} \\delta u + c\\, \\delta \\lambda = \\Delta s_{\\mathrm{t}}$ 的线性化约束，其中 $a \\in \\mathbb{R}^{n}$，$c \\in \\mathbb{R}$ 和 $\\Delta s_{\\mathrm{t}} \\in \\mathbb{R}$ 在当前迭代中由所选的路径跟踪策略确定并且是已知的。\n\n对于一个两自由度系统 ($n = 2$)，假设在当前迭代中已知以下数据（所有量均为无量纲）：\n- 切线刚度 $K_{\\mathrm{T}} \\in \\mathbb{R}^{2 \\times 2}$ 为\n$$\nK_{\\mathrm{T}} = \\begin{bmatrix} 4  -1 \\\\ -1  2 \\end{bmatrix}.\n$$\n- 比例载荷向量 $f_{\\mathrm{ext}} \\in \\mathbb{R}^{2}$ 为\n$$\nf_{\\mathrm{ext}} = \\begin{bmatrix} 3 \\\\ 1 \\end{bmatrix}.\n$$\n- 残差向量 $R \\in \\mathbb{R}^{2}$ 为\n$$\nR = \\begin{bmatrix} 2 \\\\ -1 \\end{bmatrix}.\n$$\n- 线性化弧长行由 $a^{\\mathsf{T}} \\delta u + c\\, \\delta \\lambda = \\Delta s_{\\mathrm{t}}$ 给出，其中\n$$\na = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}, \\quad c = 1, \\quad \\Delta s_{\\mathrm{t}} = 1.\n$$\n\n为未知量 $(\\delta u,\\delta \\lambda)$ 建立加边线性系统，并进行一次加边求解，以精确形式获得显式增量 $(\\delta u_{1},\\delta u_{2},\\delta \\lambda)$。以精确有理数的形式报告有序三元组 $(\\delta u_{1},\\delta u_{2},\\delta \\lambda)$。无需四舍五入。将最终答案表示为精确形式的行矩阵，不带单位。", "solution": "所述问题需经过验证。\n\n**步骤 1：提取已知条件**\n- 线性化平衡方程：$K_{\\mathrm{T}} \\,\\delta u - f_{\\mathrm{ext}} \\,\\delta \\lambda = -R$。\n- 线性化弧长约束：$a^{\\mathsf{T}} \\delta u + c\\, \\delta \\lambda = \\Delta s_{\\mathrm{t}}$。\n- 自由度数：$n = 2$。\n- 切线刚度矩阵：$K_{\\mathrm{T}} = \\begin{bmatrix} 4  -1 \\\\ -1  2 \\end{bmatrix}$。\n- 比例载荷向量：$f_{\\mathrm{ext}} = \\begin{bmatrix} 3 \\\\ 1 \\end{bmatrix}$。\n- 残差向量：$R = \\begin{bmatrix} 2 \\\\ -1 \\end{bmatrix}$。\n- 弧长约束向量：$a = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}$。\n- 弧长约束标量：$c = 1$。\n- 弧长增量：$\\Delta s_{\\mathrm{t}} = 1$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了非线性计算力学中一个被称为 Riks/Crisfield 弧长法的标准流程。这些方程是在带有路径跟踪约束的 Newton-Raphson 迭代中使用的正确线性化形式。该问题是适定的；建立增量 $(\\delta u, \\delta \\lambda)$ 线性方程组所需的所有数据均已提供。所有矩阵和向量的维数都是一致的。语言客观且明确。它没有违反任何关于科学合理性、完整性或客观性的标准。\n\n**步骤 3：结论与行动**\n问题有效。将提供解答。\n\n求解过程需要建立并求解一个结合了线性化平衡方程和弧长约束的加边线性系统。该系统的一般形式为：\n$$\n\\begin{bmatrix}\nK_{\\mathrm{T}}  -f_{\\mathrm{ext}} \\\\\na^{\\mathsf{T}}  c\n\\end{bmatrix}\n\\begin{bmatrix}\n\\delta u \\\\\n\\delta \\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n-R \\\\\n\\Delta s_{\\mathrm{t}}\n\\end{bmatrix}\n$$\n未知增量向量为 $\\begin{pmatrix} \\delta u_1  \\delta u_2  \\delta \\lambda \\end{pmatrix}^{\\mathsf{T}}$，其中 $\\delta u = \\begin{pmatrix} \\delta u_1  \\delta u_2 \\end{pmatrix}^{\\mathsf{T}}$。\n\n将给定数据代入此结构：\n- $K_{\\mathrm{T}} = \\begin{bmatrix} 4  -1 \\\\ -1  2 \\end{bmatrix}$\n- $-f_{\\mathrm{ext}} = \\begin{bmatrix} -3 \\\\ -1 \\end{bmatrix}$\n- $a^{\\mathsf{T}} = \\begin{bmatrix} 2  1 \\end{bmatrix}$\n- $c = 1$\n- $-R = \\begin{bmatrix} -2 \\\\ 1 \\end{bmatrix}$\n- $\\Delta s_{\\mathrm{t}} = 1$\n\n这构成如下的 $3 \\times 3$ 线性系统：\n$$\n\\begin{bmatrix}\n4  -1  -3 \\\\\n-1  2  -1 \\\\\n2  1  1\n\\end{bmatrix}\n\\begin{bmatrix}\n\\delta u_1 \\\\\n\\delta u_2 \\\\\n\\delta \\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n-2 \\\\\n1 \\\\\n1\n\\end{bmatrix}\n$$\n设系统矩阵为 $A_{\\mathrm{bordered}}$。为了存在唯一解，该矩阵必须是非奇异的。我们计算其行列式：\n$$\n\\det(A_{\\mathrm{bordered}}) = 4(2 \\cdot 1 - (-1) \\cdot 1) - (-1)((-1) \\cdot 1 - (-1) \\cdot 2) + (-3)((-1) \\cdot 1 - 2 \\cdot 2)\n$$\n$$\n\\det(A_{\\mathrm{bordered}}) = 4(2 + 1) + 1(-1 + 2) - 3(-1 - 4) = 4(3) + 1(1) - 3(-5) = 12 + 1 + 15 = 28\n$$\n由于 $\\det(A_{\\mathrm{bordered}}) = 28 \\neq 0$，该系统有唯一解。我们可以使用任何标准方法求解该系统，例如 Cramer 法则。\n\n每个变量的解由 $\\delta x_i = \\frac{\\det(A_i)}{\\det(A)}$ 给出，其中 $A_i$ 是将 $A$ 的第 $i$ 列替换为右侧向量后形成的矩阵。\n\n对于 $\\delta u_1$：\n$$\n\\det(A_1) = \\det \\begin{pmatrix} -2  -1  -3 \\\\ 1  2  -1 \\\\ 1  1  1 \\end{pmatrix} = -2(2+1) - (-1)(1+1) - 3(1-2) = -6 + 2 + 3 = -1\n$$\n$$\n\\delta u_1 = \\frac{-1}{28}\n$$\n\n对于 $\\delta u_2$：\n$$\n\\det(A_2) = \\det \\begin{pmatrix} 4  -2  -3 \\\\ -1  1  -1 \\\\ 2  1  1 \\end{pmatrix} = 4(1+1) - (-2)(-1+2) - 3(-1-2) = 8 + 2 + 9 = 19\n$$\n$$\n\\delta u_2 = \\frac{19}{28}\n$$\n\n对于 $\\delta \\lambda$：\n$$\n\\det(A_3) = \\det \\begin{pmatrix} 4  -1  -2 \\\\ -1  2  1 \\\\ 2  1  1 \\end{pmatrix} = 4(2-1) - (-1)(-1-2) - 2(-1-4) = 4 - 3 + 10 = 11\n$$\n$$\n\\delta \\lambda = \\frac{11}{28}\n$$\n增量的解是有序三元组 $(\\delta u_1, \\delta u_2, \\delta \\lambda) = \\left(-\\frac{1}{28}, \\frac{19}{28}, \\frac{11}{28}\\right)$。这些就是所要求的精确有理数。", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{28}  \\frac{19}{28}  \\frac{11}{28} \\end{pmatrix}}\n$$", "id": "2541431"}, {"introduction": "我们将理论概念和核心计算机制结合起来，构建一个完整的算法。这个编程练习要求你为一个经典的突越（snap-through）问题，实现一个完整的包含预测步和修正步的Riks弧长法计算步骤。通过编写代码来执行预测、迭代和修正，你将对路径跟踪算法如何导航复杂的平衡路径（包括越过极限点）获得深刻的实践理解。[@problem_id:2541443]", "problem": "考虑一个简化的单自由度模型，该模型通过三次内力定律来捕捉经典的 von Mises 双杆桁架的突跳行为。设标量位移为 $u$（无量纲），载荷因子为 $\\lambda$（无量纲）。参考载荷为 $P_0$（无量纲）。平衡方程被设定为残差的根\n$$\nR(u,\\lambda) \\equiv F_{\\text{int}}(u) - \\lambda P_0 = 0,\n$$\n其中内力由一个三次定律建模\n$$\nF_{\\text{int}}(u) = k\\,u - \\gamma\\,u^3,\n$$\n式中 $k  0$ 和 $\\gamma  0$ 为实常数。这种范式代理模型捕捉了浅 von Mises 桁架在突跳附近的折叠点（极限点）结构。定义切线量\n$$\n\\frac{\\partial R}{\\partial u}(u,\\lambda) = k - 3\\gamma u^2, \\qquad \\frac{\\partial R}{\\partial \\lambda}(u,\\lambda) = -P_0.\n$$\n您将使用带有 Riks 球面约束的弧长法，从给定的平衡状态 $(u_0,\\lambda_0)$ 执行一个载荷-位移步。未知的步增量为 $(\\Delta u, \\Delta \\lambda)$，该步结束时的试探状态为 $(u,\\lambda) = (u_0 + \\Delta u, \\lambda_0 + \\Delta \\lambda)$。Riks 约束为\n$$\ng(\\Delta u,\\Delta \\lambda) \\equiv (\\Delta u)^2 + \\alpha\\,(\\Delta \\lambda)^2 - \\Delta s^2 = 0,\n$$\n其中 $\\alpha  0$ 是载荷缩放参数，$\\Delta s  0$ 是弧长半径。\n\n实现以下算法，为从给定的起始平衡点越过极限点的单个步计算 $(\\Delta u,\\Delta \\lambda)$：\n\n- 预测方向：在 $(u_0,\\lambda_0)$ 处求解齐次线性化平衡方程，得到一个方向 $(\\hat{\\Delta u},\\hat{\\Delta \\lambda})$，满足\n$$\n\\left(k - 3\\gamma u_0^2\\right)\\,\\hat{\\Delta u} - P_0\\,\\hat{\\Delta \\lambda} = 0,\n$$\n并选择 $(\\hat{\\Delta u},\\hat{\\Delta \\lambda})$ 的符号，使载荷因子增量与局部斜率相反，即选择符号使得 $\\operatorname{sign}(\\hat{\\Delta \\lambda}) = -\\operatorname{sign}(k - 3\\gamma u_0^2)$。然后将此方向归一化，以满足半径为 $\\Delta s$ 的 Riks 约束：\n$$\n\\Delta u^{(0)} = c\\,\\hat{\\Delta u}, \\quad \\Delta \\lambda^{(0)} = c\\,\\hat{\\Delta \\lambda}, \\quad c = \\frac{\\Delta s}{\\sqrt{(\\hat{\\Delta u})^2 + \\alpha(\\hat{\\Delta \\lambda})^2}}.\n$$\n\n- 对增广系统的牛顿校正：\n$$\n\\begin{bmatrix}\n\\frac{\\partial R}{\\partial u}(u,\\lambda)  \\frac{\\partial R}{\\partial \\lambda}(u,\\lambda) \\\\\n2\\Delta u  2\\alpha \\Delta \\lambda\n\\end{bmatrix}\n\\begin{bmatrix}\n\\delta u \\\\ \\delta \\lambda\n\\end{bmatrix}\n= -\n\\begin{bmatrix}\nR(u,\\lambda) \\\\ g(\\Delta u,\\Delta \\lambda)\n\\end{bmatrix},\n$$\n其中 $(u,\\lambda) = (u_0 + \\Delta u, \\lambda_0 + \\Delta \\lambda)$，并且 $(\\Delta u,\\Delta \\lambda)$ 更新为 $(\\Delta u,\\Delta \\lambda) \\leftarrow (\\Delta u,\\Delta \\lambda) + (\\delta u,\\delta \\lambda)$ 直到收敛到指定的容差。必须对 $|R|$ 和 $|g|$ 同时强制一个小的正收敛容差。可以假设给定的 $(u_0,\\lambda_0)$ 精确满足平衡方程。\n\n所有量均为无量纲；不涉及物理单位。不出现角度。不使用百分比。\n\n测试套件和要求输出：\n- 使用以下三组参数集 $(k,\\gamma,P_0,u_0,\\alpha,\\Delta s)$。在每种情况下，从平衡方程计算 $\\lambda_0$ 为 $\\lambda_0 = \\big(k\\,u_0 - \\gamma\\,u_0^3\\big)/P_0$，然后使用上述过程执行恰好一个弧长步，并仅报告收敛后的 $(\\Delta u,\\Delta \\lambda)$。\n\n  1. 情况 A: $k=10.0$, $\\gamma=10.0$, $P_0=1.0$, $u_0=0.55$, $\\alpha=0.01$, $\\Delta s=0.10$。\n  2. 情况 B: $k=10.0$, $\\gamma=10.0$, $P_0=1.0$, $u_0=0.575$, $\\alpha=0.001$, $\\Delta s=0.05$。\n  3. 情况 C: $k=5.0$, $\\gamma=2.0$, $P_0=2.0$, $u_0=0.90$, $\\alpha=0.02$, $\\Delta s=0.12$。\n\n- 数值答案格式：您的程序应生成单行输出，其中包含三种情况的结果，格式为逗号分隔的对的列表，每对的顺序为 $(\\Delta u,\\Delta \\lambda)$，每个值四舍五入到六位小数。确切格式必须是\n$$\n[\\,[\\Delta u_A,\\Delta \\lambda_A],[\\Delta u_B,\\Delta \\lambda_B],[\\Delta u_C,\\Delta \\lambda_C]\\,],\n$$\n例如，`[[0.123456,-0.012345],[\\dots],[\\dots]]`。\n\n您的程序必须是自包含的，不接受任何输入，并确定性地计算这三个输出。", "solution": "所呈现的问题是计算力学中标准数值延拓方法的一个适定应用。它在科学上是合理的，包含了解决自身所需的所有信息，并且没有歧义。任务是使用 Riks 弧长法为非线性平衡路径计算单个求解步。我们将继续推导和实现指定的算法。\n\n系统的状态由位移 $u$ 和载荷因子 $\\lambda$ 定义。当残差 $R(u,\\lambda)$ 为零时，系统处于平衡状态，从一个初始平衡点 $(u_0, \\lambda_0)$ 的步进受弧长方程 $g(\\Delta u, \\Delta \\lambda)=0$ 约束。因此，问题是找到增量 $(\\Delta u, \\Delta \\lambda)$，以求解增广非线性方程组：\n$$\n\\begin{cases}\nR(u_0 + \\Delta u, \\lambda_0 + \\Delta \\lambda) = k(u_0 + \\Delta u) - \\gamma(u_0 + \\Delta u)^3 - (\\lambda_0 + \\Delta \\lambda)P_0 = 0 \\\\\ng(\\Delta u, \\Delta \\lambda) = (\\Delta u)^2 + \\alpha(\\Delta \\lambda)^2 - \\Delta s^2 = 0\n\\end{cases}\n$$\n解是通过预测-校正格式找到的。\n\n首先，对于每个测试用例，必须计算初始载荷因子 $\\lambda_0$，以确保起始状态 $(u_0, \\lambda_0)$ 是一个平衡点。根据条件 $R(u_0, \\lambda_0) = 0$，我们有：\n$$\n\\lambda_0 = \\frac{F_{\\text{int}}(u_0)}{P_0} = \\frac{k u_0 - \\gamma u_0^3}{P_0}\n$$\n\n接下来，预测步为增量 $(\\Delta u, \\Delta \\lambda)$ 提供了一个初始猜测。预测方向 $(\\hat{\\Delta u}, \\hat{\\Delta \\lambda})$ 在 $(u_0, \\lambda_0)$ 处与平衡路径相切。这个切线通过求解线性化平衡方程得到：\n$$\n\\frac{\\partial R}{\\partial u}\\bigg|_{(u_0, \\lambda_0)} \\hat{\\Delta u} + \\frac{\\partial R}{\\partial \\lambda}\\bigg|_{(u_0, \\lambda_0)} \\hat{\\Delta \\lambda} = 0\n$$\n代入给定的导数，我们得到：\n$$\n(k - 3\\gamma u_0^2)\\hat{\\Delta u} - P_0 \\hat{\\Delta \\lambda} = 0\n$$\n令 $K_T = k - 3\\gamma u_0^2$ 为初始点的切线刚度。方程变为 $K_T \\hat{\\Delta u} - P_0 \\hat{\\Delta \\lambda} = 0$。平衡路径的斜率是 $\\frac{d\\lambda}{du} = \\frac{K_T}{P_0}$。问题为预测方向指定了一个符号约定，以确保沿路径前进，尤其是在极限点附近：$\\operatorname{sign}(\\hat{\\Delta \\lambda}) = -\\operatorname{sign}(K_T/P_0)$。由于给定的 $P_0$ 是正数，这简化为 $\\operatorname{sign}(\\hat{\\Delta \\lambda}) = -\\operatorname{sign}(K_T)$。\n\n为了满足这一点，我们可以设置 $\\hat{\\Delta \\lambda} = -\\operatorname{sign}(K_T)$ 并求解 $\\hat{\\Delta u}$：\n$$\n\\hat{\\Delta u} = \\frac{P_0 \\hat{\\Delta \\lambda}}{K_T} = \\frac{P_0 (-\\operatorname{sign}(K_T))}{K_T} = -\\frac{P_0}{|K_T|}\n$$\n增量的初始猜测 $(\\Delta u^{(0)}, \\Delta \\lambda^{(0)})$，是通过缩放预测方向使其位于约束面上得到的，即满足 $g(\\Delta u^{(0)}, \\Delta \\lambda^{(0)}) = 0$：\n$$\n\\Delta u^{(0)} = c\\,\\hat{\\Delta u}, \\quad \\Delta \\lambda^{(0)} = c\\,\\hat{\\Delta \\lambda}, \\quad \\text{其中} \\quad c = \\frac{\\Delta s}{\\sqrt{(\\hat{\\Delta u})^2 + \\alpha(\\hat{\\Delta \\lambda})^2}}\n$$\n\n最后，校正步使用牛顿-拉夫逊法对完整的非线性增广系统进行迭代，以修正这个初始猜测。令 $(\\Delta u^{(k)}, \\Delta \\lambda^{(k)})$ 为第 $k$ 次迭代时的增量。我们寻求校正量 $(\\delta u, \\delta \\lambda)$，使得 $(\\Delta u^{(k+1)}, \\Delta \\lambda^{(k+1)}) = (\\Delta u^{(k)} + \\delta u, \\Delta \\lambda^{(k)} + \\delta \\lambda)$ 是解的一个更好的近似。校正量的线性化系统是：\n$$\n\\mathbf{J}^{(k)} \\begin{bmatrix} \\delta u \\\\ \\delta \\lambda \\end{bmatrix} = - \\begin{bmatrix} R(u^{(k)}, \\lambda^{(k)}) \\\\ g(\\Delta u^{(k)}, \\Delta \\lambda^{(k)}) \\end{bmatrix}\n$$\n其中 $(u^{(k)}, \\lambda^{(k)}) = (u_0 + \\Delta u^{(k)}, \\lambda_0 + \\Delta \\lambda^{(k)})$。雅可比矩阵 $\\mathbf{J}^{(k)}$ 由下式给出：\n$$\n\\mathbf{J}^{(k)} = \\begin{bmatrix} \\frac{\\partial R}{\\partial u}  \\frac{\\partial R}{\\partial \\lambda} \\\\ \\frac{\\partial g}{\\partial (\\Delta u)}  \\frac{\\partial g}{\\partial (\\Delta \\lambda)} \\end{bmatrix}_{\\text{在 } (u^{(k)}, \\Delta u^{(k)}, \\Delta \\lambda^{(k)})\\text{ 处}} = \\begin{bmatrix} k - 3\\gamma (u^{(k)})^2  -P_0 \\\\ 2\\Delta u^{(k)}  2\\alpha \\Delta \\lambda^{(k)} \\end{bmatrix}\n$$\n求解这个 $2 \\times 2$ 线性系统以得到 $(\\delta u, \\delta \\lambda)$，然后更新增量。重复此过程，直到残差的量值 $|R|$ 和 $|g|$ 低于指定的微小容差 $\\epsilon$。对于实现而言，$10^{-12}$ 的容差是足够的。收敛后的值 $(\\Delta u, \\Delta \\lambda)$ 是弧长步的结果。", "answer": "[[0.099575, -0.00922],[-0.003316, -0.049887],[0.117511, -0.024345]]", "id": "2541443"}]}