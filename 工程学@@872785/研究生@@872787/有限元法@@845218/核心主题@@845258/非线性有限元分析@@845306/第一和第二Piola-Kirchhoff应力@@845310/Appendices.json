{"hands_on_practices": [{"introduction": "在连续介质力学中，不同的应力张量用于不同的运动学描述框架。理解如何在真实构型中的柯西应力（$\\sigma$）与参考构型中的第一和第二Piola-Kirchhoff应力（分别为 $P$ 和 $S$）之间进行转换至关重要。本练习 [@problem_id:2587889] 将通过从基本原理出发推导这些张量之间的转换关系，并将其应用于一个直观的拉伸变形案例，从而巩固您对这些基本概念的理解。", "problem": "在用于有限变形弹性的全拉格朗日有限元列式中，考虑一个从参考构型（位置矢量为 $\\boldsymbol{X}$）到当前构型（位置矢量为 $\\boldsymbol{x}=\\boldsymbol{\\varphi}(\\boldsymbol{X})$）的材料映射。变形梯度为 $\\boldsymbol{F}=\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{\\varphi}$。设参考构型中面元上的单位法向量为 $\\boldsymbol{N}$，其面积为 $\\mathrm{d}A$；当前构型中对应面元上的单位法向量为 $\\boldsymbol{n}$，其面积为 $\\mathrm{d}a$。设 Cauchy 应力（真实应力）为 $\\boldsymbol{\\sigma}$，第一 Piola–Kirchhoff 应力为 $\\boldsymbol{P}$，第二 Piola–Kirchhoff 应力为 $\\boldsymbol{S}$。\n\n给定以下基本关系式：\n- 当前构型中的 Cauchy 面力定义：$\\boldsymbol{t}=\\boldsymbol{\\sigma}\\,\\boldsymbol{n}$。\n- 参考构型中的名义面力定义：$\\boldsymbol{T}_{0}=\\boldsymbol{P}\\,\\boldsymbol{N}$。\n- 对应面元上接触力的相等关系：$\\boldsymbol{t}\\,\\mathrm{d}a=\\boldsymbol{T}_{0}\\,\\mathrm{d}A$。\n- Nanson 公式：$\\boldsymbol{n}\\,\\mathrm{d}a = J\\,\\boldsymbol{F}^{-T}\\boldsymbol{N}\\,\\mathrm{d}A$，其中 $J=\\det \\boldsymbol{F}$。\n\n仅从上述关系式和定义 $\\boldsymbol{S}=\\boldsymbol{F}^{-1}\\boldsymbol{P}$ 出发，首先推导 $\\boldsymbol{P}$ 和 $\\boldsymbol{S}$ 关于 $\\boldsymbol{F}$、$J$ 和 $\\boldsymbol{\\sigma}$ 的表达式。然后，将结果特化到纯拉伸情况，此时\n$$\n\\boldsymbol{F}=\\operatorname{diag}(\\lambda_{1},\\lambda_{2},\\lambda_{3}), \\quad \\lambda_{i}0,\n$$\n且 Cauchy 应力为对角阵\n$$\n\\boldsymbol{\\sigma}=\\operatorname{diag}(\\sigma_{1},\\sigma_{2},\\sigma_{3}).\n$$\n\n计算 $\\boldsymbol{P}$ 和 $\\boldsymbol{S}$ 的对角分量，以 $\\lambda_{1},\\lambda_{2},\\lambda_{3}$ 和 $\\sigma_{1},\\sigma_{2},\\sigma_{3}$ 的封闭形式显式表达。将最终答案表示为一个单行矩阵，按 $\\big(P_{11},P_{22},P_{33},S_{11},S_{22},S_{33}\\big)$ 的顺序包含六个对角元素，并在需要时使用 $J=\\lambda_{1}\\lambda_{2}\\lambda_{3}$。以符号形式表示最终答案；不要包含单位。", "solution": "对问题陈述进行分析后，确认其有效。这是一个连续介质力学中的适定问题，基于既定原理，定义和关系式完整且一致。不存在科学或逻辑上的缺陷。求解过程将首先推导应力张量之间的一般关系，然后将其特化到给定情况。\n\n出发点是作用在当前构型和参考构型中同一材料面元上的接触力相等：\n$$\n\\boldsymbol{t}\\,\\mathrm{d}a = \\boldsymbol{T}_{0}\\,\\mathrm{d}A\n$$\n这里，$\\boldsymbol{t}$ 是当前构型中的 Cauchy 面力矢量，$\\boldsymbol{T}_{0}$ 是参考构型中的名义面力矢量。面元面积分别为 $\\mathrm{d}a$ 和 $\\mathrm{d}A$。\n\n我们将以 Cauchy 应力 $\\boldsymbol{\\sigma}$ 和第一 Piola-Kirchhoff 应力 $\\boldsymbol{P}$ 表示的面力矢量定义代入：\n$$\n(\\boldsymbol{\\sigma}\\,\\boldsymbol{n})\\,\\mathrm{d}a = (\\boldsymbol{P}\\,\\boldsymbol{N})\\,\\mathrm{d}A\n$$\n其中 $\\boldsymbol{n}$ 和 $\\boldsymbol{N}$ 分别是当前构型和参考构型中面元的单位法向量。整理各项可得：\n$$\n\\boldsymbol{\\sigma}\\,(\\boldsymbol{n}\\,\\mathrm{d}a) = \\boldsymbol{P}\\,(\\boldsymbol{N}\\,\\mathrm{d}A)\n$$\n现在我们使用 Nanson 公式，它关联了两个构型中的有向面积元：\n$$\n\\boldsymbol{n}\\,\\mathrm{d}a = J\\,\\boldsymbol{F}^{-T}\\boldsymbol{N}\\,\\mathrm{d}A\n$$\n其中 $\\boldsymbol{F}$ 是变形梯度，$J = \\det(\\boldsymbol{F})$，$\\boldsymbol{F}^{-T}$ 是 $\\boldsymbol{F}$ 的逆转置。将 Nanson 公式代入力平衡方程得到：\n$$\n\\boldsymbol{\\sigma}\\,(J\\,\\boldsymbol{F}^{-T}\\boldsymbol{N}\\,\\mathrm{d}A) = \\boldsymbol{P}\\,(\\boldsymbol{N}\\,\\mathrm{d}A)\n$$\n由于该关系式必须对任意面元都成立，我们可以消去标量项 $\\mathrm{d}A$，并认识到该等式必须对法向量 $\\boldsymbol{N}$ 的任意选择都成立。这意味着张量之间存在以下关系：\n$$\n\\boldsymbol{P} = J\\,\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T}\n$$\n这就是所求的第一 Piola-Kirchhoff 应力 $\\boldsymbol{P}$ 与 Cauchy 应力 $\\boldsymbol{\\sigma}$ 之间的关系式。\n\n接下来，我们推导第二 Piola-Kirchhoff 应力 $\\boldsymbol{S}$ 的表达式。根据给定的定义：\n$$\n\\boldsymbol{S} = \\boldsymbol{F}^{-1}\\boldsymbol{P}\n$$\n代入我们刚刚推导出的 $\\boldsymbol{P}$ 的表达式：\n$$\n\\boldsymbol{S} = \\boldsymbol{F}^{-1}\\,(J\\,\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T})\n$$\n标量 $J$ 可以移到前面：\n$$\n\\boldsymbol{S} = J\\,\\boldsymbol{F}^{-1}\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T}\n$$\n这就是所求的第二 Piola-Kirchhoff 应力 $\\boldsymbol{S}$ 与 Cauchy 应力 $\\boldsymbol{\\sigma}$ 之间的关系式。这完成了问题的第一部分。\n\n对于第二部分，我们将这些一般关系特化到纯拉伸情况，此时变形梯度 $\\boldsymbol{F}$ 和 Cauchy 应力 $\\boldsymbol{\\sigma}$ 均为对角矩阵：\n$$\n\\boldsymbol{F} = \\begin{pmatrix} \\lambda_{1}  0  0 \\\\ 0  \\lambda_{2}  0 \\\\ 0  0  \\lambda_{3} \\end{pmatrix}, \\quad \\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{1}  0  0 \\\\ 0  \\sigma_{2}  0 \\\\ 0  0  \\sigma_{3} \\end{pmatrix}\n$$\n其中主拉伸 $\\lambda_{i}  0$。$\\boldsymbol{F}$ 的行列式为 $J = \\det(\\boldsymbol{F}) = \\lambda_{1}\\lambda_{2}\\lambda_{3}$。由于 $\\boldsymbol{F}$ 是一个对角矩阵，其转置等于自身，即 $\\boldsymbol{F}^{T} = \\boldsymbol{F}$。其转置的逆为：\n$$\n\\boldsymbol{F}^{-T} = (\\boldsymbol{F}^T)^{-1} = \\boldsymbol{F}^{-1} = \\begin{pmatrix} \\lambda_{1}^{-1}  0  0 \\\\ 0  \\lambda_{2}^{-1}  0 \\\\ 0  0  \\lambda_{3}^{-1} \\end{pmatrix}\n$$\n现在我们使用 $\\boldsymbol{P} = J\\,\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T}$ 计算 $\\boldsymbol{P}$ 的分量：\n$$\n\\boldsymbol{P} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\sigma_{1}  0  0 \\\\ 0  \\sigma_{2}  0 \\\\ 0  0  \\sigma_{3} \\end{pmatrix} \\begin{pmatrix} \\lambda_{1}^{-1}  0  0 \\\\ 0  \\lambda_{2}^{-1}  0 \\\\ 0  0  \\lambda_{3}^{-1} \\end{pmatrix}\n$$\n两个对角矩阵的乘积是一个对角矩阵：\n$$\n\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T} = \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-1}  0  0 \\\\ 0  \\sigma_{2}\\lambda_{2}^{-1}  0 \\\\ 0  0  \\sigma_{3}\\lambda_{3}^{-1} \\end{pmatrix}\n$$\n乘以标量 $J$ 得到 $\\boldsymbol{P}$ 的分量：\n$$\n\\boldsymbol{P} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-1}  0  0 \\\\ 0  \\sigma_{2}\\lambda_{2}^{-1}  0 \\\\ 0  0  \\sigma_{3}\\lambda_{3}^{-1} \\end{pmatrix} = \\begin{pmatrix} \\sigma_{1}\\lambda_{2}\\lambda_{3}  0  0 \\\\ 0  \\sigma_{2}\\lambda_{1}\\lambda_{3}  0 \\\\ 0  0  \\sigma_{3}\\lambda_{1}\\lambda_{2} \\end{pmatrix}\n$$\n第一 Piola-Kirchhoff 应力的对角分量为：\n$P_{11} = \\sigma_{1}\\lambda_{2}\\lambda_{3}$\n$P_{22} = \\sigma_{2}\\lambda_{1}\\lambda_{3}$\n$P_{33} = \\sigma_{3}\\lambda_{1}\\lambda_{2}$\n\n最后，我们使用 $\\boldsymbol{S} = J\\,\\boldsymbol{F}^{-1}\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T}$ 计算 $\\boldsymbol{S}$ 的分量：\n$$\n\\boldsymbol{S} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\lambda_{1}^{-1}  0  0 \\\\ 0  \\lambda_{2}^{-1}  0 \\\\ 0  0  \\lambda_{3}^{-1} \\end{pmatrix} \\begin{pmatrix} \\sigma_{1}  0  0 \\\\ 0  \\sigma_{2}  0 \\\\ 0  0  \\sigma_{3} \\end{pmatrix} \\begin{pmatrix} \\lambda_{1}^{-1}  0  0 \\\\ 0  \\lambda_{2}^{-1}  0 \\\\ 0  0  \\lambda_{3}^{-1} \\end{pmatrix}\n$$\n执行矩阵乘法：\n$$\n\\boldsymbol{S} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\lambda_{1}^{-1}  0  0 \\\\ 0  \\lambda_{2}^{-1}  0 \\\\ 0  0  \\lambda_{3}^{-1} \\end{pmatrix} \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-1}  0  0 \\\\ 0  \\sigma_{2}\\lambda_{2}^{-1}  0 \\\\ 0  0  \\sigma_{3}\\lambda_{3}^{-1} \\end{pmatrix}\n$$\n$$\n\\boldsymbol{S} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-2}  0  0 \\\\ 0  \\sigma_{2}\\lambda_{2}^{-2}  0 \\\\ 0  0  \\sigma_{3}\\lambda_{3}^{-2} \\end{pmatrix} = \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-1}\\lambda_{2}\\lambda_{3}  0  0 \\\\ 0  \\sigma_{2}\\lambda_{1}\\lambda_{2}^{-1}\\lambda_{3}  0 \\\\ 0  0  \\sigma_{3}\\lambda_{1}\\lambda_{2}\\lambda_{3}^{-1} \\end{pmatrix}\n$$\n第二 Piola-Kirchhoff 应力的对角分量为：\n$S_{11} = \\sigma_{1}\\lambda_{1}^{-1}\\lambda_{2}\\lambda_{3}$\n$S_{22} = \\sigma_{2}\\lambda_{1}\\lambda_{2}^{-1}\\lambda_{3}$\n$S_{33} = \\sigma_{3}\\lambda_{1}\\lambda_{2}\\lambda_{3}^{-1}$\n\n将所需的六个对角分量组合成一个单行矩阵作为最终答案。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sigma_{1}\\lambda_{2}\\lambda_{3}  \\sigma_{2}\\lambda_{1}\\lambda_{3}  \\sigma_{3}\\lambda_{1}\\lambda_{2}  \\sigma_{1}\\lambda_{1}^{-1}\\lambda_{2}\\lambda_{3}  \\sigma_{2}\\lambda_{1}\\lambda_{2}^{-1}\\lambda_{3}  \\sigma_{3}\\lambda_{1}\\lambda_{2}\\lambda_{3}^{-1} \\end{pmatrix}}\n$$", "id": "2587889"}, {"introduction": "在超弹性理论中，应力并非独立定义，而是从一个标量势函数——储存能函数 $W$——中导出。第二Piola-Kirchhoff应力 $S$ 与右柯西-格林应变张量 $C$ 在能量上是共轭的，而第一Piola-Kirchhoff应力 $P$ 与变形梯度 $F$ 共轭。本实践 [@problem_id:2587930] 演示了如何从一个给定的能量函数出发推导 $P$ 和 $S$，并通过验证运动学恒等式 $P=FS$ 来连接能量观点和运动学观点，这是一个至关重要的验证步骤。", "problem": "考虑一个三维超弹性固体，其变形梯度为 $F \\in \\mathrm{GL}^{+}(3)$，右Cauchy–Green张量为 $C = F^{\\top} F$，其不变量为 $I_{1}(C) = \\mathrm{tr}(C)$、$I_{2}(C) = \\tfrac{1}{2}\\big((\\mathrm{tr}C)^{2} - \\mathrm{tr}(C^{2})\\big)$ 和 $I_{3}(C) = \\det(C)$。单位参考体积的储存能由下式给出：\n$$\nW(F) = \\alpha\\big(I_{1}(C) - 3\\big) + \\beta\\big(I_{2}(C) - 3\\big) + \\gamma\\big(I_{3}(C) - 1\\big),\n$$\n其中 $\\alpha$、$\\beta$ 和 $\\gamma$ 为正常数。请仅使用连续介质力学的基础定义，计算第一Piola–Kirchhoff应力 $P$ 和第二Piola–Kirchhoff应力 $S$，并验证恒等式 $P = F\\,S$ 对所有与所述能量一致的 $F \\in \\mathrm{GL}^{+}(3)$ 恒成立。作为验证的标量检验，定义Frobenius范数残差 $r = \\|P - F\\,S\\|_{F}^{2}$ 并报告其值。将 $r$ 的最终值表示为无单位的纯数。", "solution": "所述问题具有科学依据、适定且客观。这是非线性连续介质力学中关于各向同性超弹性材料的一个标准练习。所有给出的定义和关系均为标准形式。该问题是有效的，且存在唯一解。\n\n我们将进行推导。根据储存能函数 $W$ 定义第一Piola-Kirchhoff应力张量 $P$ 和第二Piola-Kirchhoff应力张量 $S$ 的基本公式为：\n$$\nP = \\frac{\\partial W}{\\partial F} \\quad \\text{和} \\quad S = 2 \\frac{\\partial W}{\\partial C}\n$$\n其中 $F$ 是变形梯度，$C = F^{\\top} F$ 是右Cauchy-Green变形张量。问题要求为给定的储存能函数计算 $P$ 和 $S$，然后验证基本恒等式 $P = FS$。\n\n储存能函数由下式给出：\n$$\nW(F) = W(C(F)) = \\alpha\\big(I_{1}(C) - 3\\big) + \\beta\\big(I_{2}(C) - 3\\big) + \\gamma\\big(I_{3}(C) - 1\\big)\n$$\n其中 $I_1(C) = \\mathrm{tr}(C)$，$I_2(C) = \\frac{1}{2}\\left((\\mathrm{tr}C)^2 - \\mathrm{tr}(C^2)\\right)$，$I_3(C) = \\det(C)$，且 $\\alpha$、$\\beta$、$\\gamma$ 是正常的材料常数。\n\n首先，我们计算第二Piola-Kirchhoff应力张量 $S$。对张量 $C$ 使用微分链式法则：\n$$\nS = 2 \\frac{\\partial W}{\\partial C} = 2 \\left( \\frac{\\partial W}{\\partial I_1} \\frac{\\partial I_1}{\\partial C} + \\frac{\\partial W}{\\partial I_2} \\frac{\\partial I_2}{\\partial C} + \\frac{\\partial W}{\\partial I_3} \\frac{\\partial I_3}{\\partial C} \\right)\n$$\n$W$ 对不变量 $I_1$、$I_2$ 和 $I_3$ 的偏导数可以从其定义直接得到：\n$$\n\\frac{\\partial W}{\\partial I_1} = \\alpha, \\quad \\frac{\\partial W}{\\partial I_2} = \\beta, \\quad \\frac{\\partial W}{\\partial I_3} = \\gamma\n$$\n不变量对 $C$ 的导数是张量微积分中的标准结果：\n$$\n\\frac{\\partial I_1}{\\partial C} = \\frac{\\partial(\\mathrm{tr}(C))}{\\partial C} = I\n$$\n$$\n\\frac{\\partial I_2}{\\partial C} = \\frac{\\partial}{\\partial C} \\left( \\frac{1}{2}[(\\mathrm{tr}C)^2 - \\mathrm{tr}(C^2)] \\right) = I_1 I - C\n$$\n$$\n\\frac{\\partial I_3}{\\partial C} = \\frac{\\partial(\\det(C))}{\\partial C} = \\det(C) C^{-\\top} = I_3 C^{-1} \\quad (\\text{因为 } C \\text{ 是对称的})\n$$\n将这些表达式代入 $S$ 的公式，得到：\n$$\nS = 2 \\left( \\alpha I + \\beta (I_1 I - C) + \\gamma I_3 C^{-1} \\right)\n$$\n这是给定材料模型的第二Piola-Kirchhoff应力张量的表达式。\n\n接下来，我们独立地计算第一Piola-Kirchhoff应力张量 $P$。对张量 $F$ 使用微分链式法则：\n$$\nP = \\frac{\\partial W}{\\partial F} = \\frac{\\partial W}{\\partial I_1} \\frac{\\partial I_1}{\\partial F} + \\frac{\\partial W}{\\partial I_2} \\frac{\\partial I_2}{\\partial F} + \\frac{\\partial W}{\\partial I_3} \\frac{\\partial I_3}{\\partial F}\n$$\n不变量对 $F$ 的导数也是标准结果：\n$$\n\\frac{\\partial I_1}{\\partial F} = \\frac{\\partial (\\mathrm{tr}(F^{\\top}F))}{\\partial F} = 2F\n$$\n$$\n\\frac{\\partial I_2}{\\partial F} = 2(I_1 F - FC)\n$$\n$$\n\\frac{\\partial I_3}{\\partial F} = \\frac{\\partial ((\\det F)^2)}{\\partial F} = 2\\det(F) \\frac{\\partial(\\det F)}{\\partial F} = 2\\det(F) (\\det(F) F^{-\\top}) = 2(\\det F)^2 F^{-\\top} = 2 I_3 F^{-\\top}\n$$\n将这些以及 $W$ 对不变量的导数代入 $P$ 的公式中：\n$$\nP = \\alpha (2F) + \\beta (2(I_1 F - FC)) + \\gamma (2 I_3 F^{-\\top})\n$$\n$$\nP = 2\\alpha F + 2\\beta(I_1 F - FC) + 2\\gamma I_3 F^{-\\top}\n$$\n这是第一Piola-Kirchhoff应力张量的独立表达式。\n\n现在，我们必须验证恒等式 $P = FS$。我们使用推导出的 $S$ 的表达式来计算乘积 $FS$：\n$$\nFS = F \\left[ 2 \\left( \\alpha I + \\beta (I_1 I - C) + \\gamma I_3 C^{-1} \\right) \\right]\n$$\n$$\nFS = 2\\alpha FI + 2\\beta F(I_1 I - C) + 2\\gamma I_3 F C^{-1}\n$$\n$$\nFS = 2\\alpha F + 2\\beta(I_1 F - FC) + 2\\gamma I_3 F C^{-1}\n$$\n将这个 $FS$ 的表达式与我们得到的 $P$ 的表达式进行比较，我们看到前两项完全匹配。恒等式 $P = FS$ 成立当且仅当第三项相等：\n$$\n2\\gamma I_3 F^{-\\top} = 2\\gamma I_3 F C^{-1}\n$$\n这简化为验证是否 $F^{-\\top} = FC^{-1}$。我们使用定义 $C = F^{\\top}F$。$C$ 的逆是 $C^{-1} = (F^{\\top}F)^{-1} = F^{-1}(F^{\\top})^{-1} = F^{-1}F^{-\\top}$。\n现在，我们用 $F$ 左乘 $C^{-1}$：\n$$\nFC^{-1} = F(F^{-1}F^{-\\top}) = (FF^{-1})F^{-\\top} = I F^{-\\top} = F^{-\\top}\n$$\n等式得证。因此，从 $\\partial W / \\partial F$ 推导出的 $P$ 的表达式与其中 $S$ 是从 $2 \\partial W / \\partial C$ 推导出的 $FS$ 表达式完全相同。对于给定的超弹性储能函数，恒等式 $P = FS$ 对所有 $F \\in \\mathrm{GL}^{+}(3)$ 都成立。\n\n最后，我们计算标量残差 $r = \\|P - FS\\|_{F}^{2}$。矩阵 $A$ 的Frobenius范数定义为 $\\|A\\|_{F} = \\sqrt{\\sum_{i,j} |A_{ij}|^2}$。\n由于我们已经严格证明了 $P = FS$ 是一个恒等式，差值 $P - FS$ 是零张量，记为 $0$。\n$$\nP - FS = 0\n$$\n零张量的Frobenius范数是：\n$$\n\\|0\\|_{F} = \\sqrt{\\sum_{i,j} 0^2} = 0\n$$\n因此，残差为：\n$$\nr = \\|P - FS\\|_{F}^{2} = 0^{2} = 0\n$$\n残差的值恰好为 $0$，这与两种应力度量之间的基本关系所预期的结果一致。", "answer": "$$\\boxed{0}$$", "id": "2587930"}, {"introduction": "在有限元程序中实现超弹性材料模型时，确保其正确性是首要任务。第一Piola-Kirchhoff应力的基本定义是它与变形梯度在能量上共轭，即 $P = \\frac{\\partial W}{\\partial F}$。本练习 [@problem_id:2587909] 介绍了一种强大的数值验证技术，称为“泰勒检验”或“能量平衡检验”，它通过比较解析导数与有限差分近似值，让您能严格地检查所实现的应力张量是否与它所代表的能量函数保持一致。", "problem": "令 $F \\in \\mathbb{R}^{d \\times d}$ 表示从参考构型到当前构型的形变梯度，其中 $d \\in \\{2,3\\}$。考虑一个可压缩超弹性材料，其应变能密度为 $W(F)$，其中 $W$ 仅依赖于 $F$。第一Piola–Kirchhoff应力（有时称为名义应力）定义为能量对应变梯度的导数，即 $P(F) = \\dfrac{\\partial W(F)}{\\partial F}$，并且能量在方向 $\\delta F$ 上的方向导数满足 $\\delta W(F)[\\delta F] = P(F) : \\delta F$，其中Frobenius积为 $A : B = \\sum_{i,j} A_{ij} B_{ij}$。在有限元法的背景下，可以通过验证 $P(F) : \\delta F$ 是否与 $W(F)$ 沿 $\\delta F$ 方向的有限差分方向导数相匹配，来测试 $P$ 的实现的能量平衡一致性。\n\n从第一性原理出发，实现以下可压缩Neo-Hookean固体的应变能密度函数 $W(F)$：\n$$\nW(F) = \\frac{\\mu}{2}\\left(I_1(C) - d\\right) - \\mu \\ln J + \\frac{\\kappa}{2}\\left(\\ln J\\right)^2,\n$$\n其中 $C = F^{\\mathsf{T}}F$，$I_1(C) = \\mathrm{tr}(C)$，$J = \\det(F)$，$\\mu  0$ 是剪切模量，$\\kappa  0$ 是体积模量。您必须使用链式法则和基本的矩阵微积分恒等式，从上述 $W(F)$ 的定义推导出 $P(F)$；不得假设任何已知的应力公式。\n\n通过将解析方向导数 $P(F) : \\delta F$ 与方向导数的中心有限差分近似进行比较，来数值验证能量平衡：\n$$\nD^{\\mathrm{FD}}W(F)[\\delta F] = \\frac{W\\!\\left(F + \\varepsilon\\,\\delta F\\right) - W\\!\\left(F - \\varepsilon\\,\\delta F\\right)}{2\\,\\varepsilon}.\n$$\n对于每个测试用例，计算对称相对误差\n$$\n\\mathrm{err} = \\frac{\\left|\\,P(F) : \\delta F - D^{\\mathrm{FD}}W(F)[\\delta F]\\,\\right|}{\\left|P(F) : \\delta F\\right| + \\left|D^{\\mathrm{FD}}W(F)[\\delta F]\\right| + 10^{-12}},\n$$\n并返回一个布尔值，指示是否满足 $\\mathrm{err} \\leq 10^{-6}$。\n\n您的程序必须根据给定的定义实现 $W(F)$，从第一性原理推导并实现 $P(F)$，然后对下面的每个测试用例，根据上述标准计算布尔值的通过/失败结果。本问题不需要物理单位。在您自己的推导中可能出现的任何角度，都必须纯粹作为符号处理，不需要角度单位。\n\n使用以下测试套件。每个用例都指定了 $F$、$\\delta F$、$\\mu$、$\\kappa$ 和 $\\varepsilon$。所有矩阵都明确给出。\n\n- 用例1 ($d = 3$):\n  $$\n  F = \\begin{bmatrix}\n  1.1   0.2   -0.1 \\\\\n  0.0   0.9   0.15 \\\\\n  0.05  -0.08  1.05\n  \\end{bmatrix},\\quad\n  \\delta F = \\begin{bmatrix}\n  0.3   -0.1  0.2 \\\\\n  -0.05  0.25  -0.15 \\\\\n  0.1   -0.2  0.05\n  \\end{bmatrix},\\quad\n  \\mu = 40.0,\\quad \\kappa = 120.0,\\quad \\varepsilon = 10^{-7}.\n  $$\n\n- 用例2 ($d = 3$):\n  $$\n  F = \\begin{bmatrix}\n  1.3  0.3  0.0 \\\\\n  0.1  0.8  0.2 \\\\\n  0.0  -0.1  1.2\n  \\end{bmatrix},\\quad\n  \\delta F = \\begin{bmatrix}\n  -0.2  0.05  0.1 \\\\\n  0.15  -0.25  0.05 \\\\\n  -0.05  0.1  -0.15\n  \\end{bmatrix},\\quad\n  \\mu = 25.0,\\quad \\kappa = 80.0,\\quad \\varepsilon = 10^{-7}.\n  $$\n\n- 用例3 ($d = 2$):\n  $$\n  F = \\begin{bmatrix}\n  0.85  0.2 \\\\\n  -0.1  1.3\n  \\end{bmatrix},\\quad\n  \\delta F = \\begin{bmatrix}\n  0.1  -0.3 \\\\\n  0.25  0.15\n  \\end{bmatrix},\\quad\n  \\mu = 40.0,\\quad \\kappa = 120.0,\\quad \\varepsilon = 10^{-7}.\n  $$\n\n- 用例4 ($d = 3$):\n  $$\n  F = \\begin{bmatrix}\n  0.85  0.0  0.0 \\\\\n  0.0  0.85  0.0 \\\\\n  0.0  0.0  0.85\n  \\end{bmatrix},\\quad\n  \\delta F = \\begin{bmatrix}\n  -0.1  0.05  0.0 \\\\\n  0.0  0.1  -0.05 \\\\\n  0.02  0.0  -0.02\n  \\end{bmatrix},\\quad\n  \\mu = 10.0,\\quad \\kappa = 300.0,\\quad \\varepsilon = 10^{-7}.\n  $$\n\n- 用例5 ($d = 2$):\n  $$\n  F = \\begin{bmatrix}\n  1.0  0.5 \\\\\n  -0.4  1.1\n  \\end{bmatrix},\\quad\n  \\delta F = \\begin{bmatrix}\n  0.5  -0.2 \\\\\n  0.3  0.4\n  \\end{bmatrix},\\quad\n  \\mu = 60.0,\\quad \\kappa = 150.0,\\quad \\varepsilon = 10^{-7}.\n  $$\n\n要求的输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[r_1,r_2,r_3,r_4,r_5]$，其中每个 $r_i$ 是一个布尔值，表示相应的用例是否通过了能量平衡测试。不应打印任何附加文本。", "solution": "评估问题陈述是强制性的第一步。\n\n**第一步：提取已知条件**\n- 形变梯度：$F \\in \\mathbb{R}^{d \\times d}$，其中 $d \\in \\{2,3\\}$。\n- 应变能密度函数：$W(F) = \\frac{\\mu}{2}\\left(I_1(C) - d\\right) - \\mu \\ln J + \\frac{\\kappa}{2}\\left(\\ln J\\right)^2$。\n- 右Cauchy-Green形变张量：$C = F^{\\mathsf{T}}F$。\n- $C$ 的第一不变量：$I_1(C) = \\mathrm{tr}(C)$。\n- 形变雅可比：$J = \\det(F)$。\n- 材料参数：剪切模量 $\\mu  0$，体积模量 $\\kappa  0$。\n- 第一Piola-Kirchhoff应力张量定义：$P(F) = \\dfrac{\\partial W(F)}{\\partial F}$。\n- 方向导数关系：$\\delta W(F)[\\delta F] = P(F) : \\delta F$。\n- 方向导数的有限差分近似：$D^{\\mathrm{FD}}W(F)[\\delta F] = \\frac{W\\!\\left(F + \\varepsilon\\,\\delta F\\right) - W\\!\\left(F - \\varepsilon\\,\\delta F\\right)}{2\\,\\varepsilon}$。\n- 对称相对误差公式：$\\mathrm{err} = \\frac{\\left|\\,P(F) : \\delta F - D^{\\mathrm{FD}}(W)[\\delta F]\\,\\right|}{\\left|P(F) : \\delta F\\right| + \\left|D^{\\mathrm{FD}}(W)[\\delta F]\\right| + 10^{-12}}$。\n- 通过/失败标准：$\\mathrm{err} \\leq 10^{-6}$。\n- 提供了五个测试用例，每个用例都指定了矩阵 $F$、$\\delta F$ 和标量参数 $\\mu$、$\\kappa$、$\\varepsilon$。\n\n**第二步：使用提取的已知条件进行验证**\n根据验证标准对问题进行审查。\n- **科学性**：该问题植根于成熟的连续介质力学领域。可压缩Neo-Hookean模型是一种标准的超弹性材料模型。形变梯度 $F$、第一Piola-Kirchhoff应力 $P$ 的定义，以及通过Taylor检验验证能量平衡，都是计算力学中的基本概念。该问题是科学合理的。\n- **适定性**：问题定义清晰。它要求推导一个特定量 $P(F)$，并根据一个明确定义的基准对其进行数值验证。所有必要的数据和公式都已提供。预期会得到一个唯一的、数值稳定的结果（每个测试用例对应一个布尔值）。\n- **客观性**：问题以精确的数学语言陈述，没有任何主观性或歧义。\n- **完整性与一致性**：问题是自洽的。没有缺失的定义或矛盾的约束。为测试用例提供的数据是完整的。\n- **其他缺陷**：问题并非无足轻重，因为它需要使用矩阵微积分进行正确推导。它不基于任何不切实际的前提或错误的逻辑。\n\n**第三步：结论与行动**\n该问题是**有效的**。这是连续介质力学中一个标准的、适定的练习。我们着手进行求解。\n\n目标是从给定的应变能密度 $W(F)$ 推导出第一Piola-Kirchhoff应力张量 $P(F)$，并随后通过数值方法验证所推导表达式的正确性。推导必须从第一性原理出发，利用变分法。\n\n应变能密度函数为：\n$$\nW(F) = \\frac{\\mu}{2}\\left(I_1(C) - d\\right) - \\mu \\ln J + \\frac{\\kappa}{2}\\left(\\ln J\\right)^2\n$$\n其中 $C = F^{\\mathsf{T}}F$，$I_1(C) = \\mathrm{tr}(C)$，$J = \\det(F)$。\n\n第一Piola-Kirchhoff应力 $P$ 是 $W$ 相对于 $F$ 的导数，通过 $W$ 在任意方向 $\\delta F$ 上的方向导数（或Gâteaux导数）正式定义：\n$$\n\\delta W(F)[\\delta F] = \\left.\\frac{d}{d\\alpha} W(F + \\alpha\\,\\delta F)\\right|_{\\alpha=0} = P(F) : \\delta F\n$$\n其中 ':' 表示矩阵的Frobenius内积， $A:B = \\mathrm{tr}(A^{\\mathsf{T}}B)$。\n\n我们通过应用链式法则来计算变分 $\\delta W$。为清晰起见，我们将 $W$ 分解为两部分：\n$W(F) = W_{iso}(F) + W_{vol}(F)$，其中\n$W_{iso}(F) = \\frac{\\mu}{2}(\\mathrm{tr}(F^{\\mathsf{T}}F) - d)$ 是等容部分，\n$W_{vol}(F) = -\\mu \\ln(\\det F) + \\frac{\\kappa}{2}(\\ln(\\det F))^2$ 是体积部分。\n总变分为 $\\delta W = \\delta W_{iso} + \\delta W_{vol}$。\n\n首先，我们求等容部分的变分 $\\delta W_{iso}$。\n$C = F^{\\mathsf{T}}F$ 的变分是：\n$$\n\\delta C = \\delta(F^{\\mathsf{T}}F) = (\\delta F)^{\\mathsf{T}}F + F^{\\mathsf{T}}(\\delta F)\n$$\n第一不变量 $I_1(C) = \\mathrm{tr}(C)$ 的变分是：\n$$\n\\delta I_1 = \\delta(\\mathrm{tr}(C)) = \\mathrm{tr}(\\delta C) = \\mathrm{tr}((\\delta F)^{\\mathsf{T}}F + F^{\\mathsf{T}}(\\delta F)) = \\mathrm{tr}((\\delta F)^{\\mathsf{T}}F) + \\mathrm{tr}(F^{\\mathsf{T}}(\\delta F))\n$$\n利用迹的循环性质 $\\mathrm{tr}(AB) = \\mathrm{tr}(BA)$ 和性质 $\\mathrm{tr}(A^{\\mathsf{T}}) = \\mathrm{tr}(A)$，我们有 $\\mathrm{tr}((\\delta F)^{\\mathsf{T}}F) = \\mathrm{tr}(F^{\\mathsf{T}}\\delta F)$。因此：\n$$\n\\delta I_1 = 2\\,\\mathrm{tr}(F^{\\mathsf{T}}(\\delta F)) = 2\\,(F : \\delta F)\n$$\n那么，$W_{iso}$ 的变分为：\n$$\n\\delta W_{iso} = \\frac{\\partial W_{iso}}{\\partial I_1} \\delta I_1 = \\frac{\\mu}{2} \\delta I_1 = \\frac{\\mu}{2} (2\\,F : \\delta F) = \\mu F : \\delta F\n$$\n通过与定义 $\\delta W_{iso} = P_{iso} : \\delta F$ 进行比较，我们确定了应力的等容部分：\n$$\nP_{iso}(F) = \\mu F\n$$\n\n接下来，我们求体积部分的变分 $\\delta W_{vol}$。\n令 $J = \\det(F)$。$W_{vol}$ 相对于 $J$ 的变分是：\n$$\n\\frac{\\partial W_{vol}}{\\partial J} = -\\frac{\\mu}{J} + \\frac{\\kappa}{2} \\cdot 2 (\\ln J) \\cdot \\frac{1}{J} = \\frac{\\kappa \\ln J - \\mu}{J}\n$$\n$W_{vol}$ 的变分由链式法则给出：$\\delta W_{vol} = \\frac{\\partial W_{vol}}{\\partial J} \\delta J$。\n行列式的变分 $\\delta J$ 由Jacobi公式给出：\n$$\n\\delta J = J\\,\\mathrm{tr}(F^{-1} \\delta F)\n$$\n使用恒等式 $\\mathrm{tr}(A B) = (A^{\\mathsf{T}} : B)$，我们可以将其重写为：\n$$\n\\delta J = J\\,(F^{-\\mathsf{T}} : \\delta F)\n$$\n将这些表达式代入 $W_{vol}$ 的变分中：\n$$\n\\delta W_{vol} = \\left(\\frac{\\kappa \\ln J - \\mu}{J}\\right) \\left(J\\,(F^{-\\mathsf{T}} : \\delta F)\\right) = (\\kappa \\ln J - \\mu) F^{-\\mathsf{T}} : \\delta F\n$$\n通过与定义 $\\delta W_{vol} = P_{vol} : \\delta F$ 进行比较，我们确定了应力的体积部分：\n$$\nP_{vol}(F) = (\\kappa \\ln J - \\mu) F^{-\\mathsf{T}}\n$$\n\n总的第一Piola-Kirchhoff应力张量是等容部分和体积部分之和：\n$$\nP(F) = P_{iso}(F) + P_{vol}(F) = \\mu F + (\\kappa \\ln J - \\mu) F^{-\\mathsf{T}}\n$$\n这就是必须实现的应力张量的解析表达式。\n\n对于数值验证，我们实现这个推导出的 $P(F)$ 公式，并计算解析方向导数 $P(F) : \\delta F$。然后，我们按照指定，将此值与使用中心有限差分格式的数值近似进行比较：\n$$\nD^{\\mathrm{FD}}W(F)[\\delta F] = \\frac{W\\!\\left(F + \\varepsilon\\,\\delta F\\right) - W\\!\\left(F - \\varepsilon\\,\\delta F\\right)}{2\\,\\varepsilon}\n$$\n为每个测试用例计算对称相对误差：\n$$\n\\mathrm{err} = \\frac{\\left|\\,P(F) : \\delta F - D^{\\mathrm{FD}}W(F)[\\delta F]\\,\\right|}{\\left|P(F) : \\delta F\\right| + \\left|D^{\\mathrm{FD}}W(F)[\\delta F]\\right| + 10^{-12}}\n$$\n如果此误差小于或等于容差 $\\mathrm{err} \\leq 10^{-6}$，则测试用例通过。实现将根据这些推导出的公式和步骤进行。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by deriving and verifying the First Piola-Kirchhoff stress\n    for a compressible Neo-Hookean material model.\n    \"\"\"\n\n    test_cases = [\n        # Case 1\n        {\n            \"F\": np.array([\n                [1.1, 0.2, -0.1],\n                [0.0, 0.9, 0.15],\n                [0.05, -0.08, 1.05]\n            ]),\n            \"delta_F\": np.array([\n                [0.3, -0.1, 0.2],\n                [-0.05, 0.25, -0.15],\n                [0.1, -0.2, 0.05]\n            ]),\n            \"mu\": 40.0, \"kappa\": 120.0, \"epsilon\": 1e-7\n        },\n        # Case 2\n        {\n            \"F\": np.array([\n                [1.3, 0.3, 0.0],\n                [0.1, 0.8, 0.2],\n                [0.0, -0.1, 1.2]\n            ]),\n            \"delta_F\": np.array([\n                [-0.2, 0.05, 0.1],\n                [0.15, -0.25, 0.05],\n                [-0.05, 0.1, -0.15]\n            ]),\n            \"mu\": 25.0, \"kappa\": 80.0, \"epsilon\": 1e-7\n        },\n        # Case 3\n        {\n            \"F\": np.array([\n                [0.85, 0.2],\n                [-0.1, 1.3]\n            ]),\n            \"delta_F\": np.array([\n                [0.1, -0.3],\n                [0.25, 0.15]\n            ]),\n            \"mu\": 40.0, \"kappa\": 120.0, \"epsilon\": 1e-7\n        },\n        # Case 4\n        {\n            \"F\": np.array([\n                [0.85, 0.0, 0.0],\n                [0.0, 0.85, 0.0],\n                [0.0, 0.0, 0.85]\n            ]),\n            \"delta_F\": np.array([\n                [-0.1, 0.05, 0.0],\n                [0.0, 0.1, -0.05],\n                [0.02, 0.0, -0.02]\n            ]),\n            \"mu\": 10.0, \"kappa\": 300.0, \"epsilon\": 1e-7\n        },\n        # Case 5\n        {\n            \"F\": np.array([\n                [1.0, 0.5],\n                [-0.4, 1.1]\n            ]),\n            \"delta_F\": np.array([\n                [0.5, -0.2],\n                [0.3, 0.4]\n            ]),\n            \"mu\": 60.0, \"kappa\": 150.0, \"epsilon\": 1e-7\n        }\n    ]\n\n    def calculate_W(F, mu, kappa):\n        \"\"\"\n        Computes the strain energy density W(F).\n        \"\"\"\n        d = F.shape[0]\n        C = F.T @ F\n        I1_C = np.trace(C)\n        J = np.linalg.det(F)\n\n        # A valid deformation must have J > 0.\n        if J = 0:\n            # Return a large value to indicate unphysical deformation.\n            # This is not strictly necessary for the given test cases but is good practice.\n            return np.inf\n\n        W = (mu / 2) * (I1_C - d) - mu * np.log(J) + (kappa / 2) * (np.log(J))**2\n        return W\n\n    def calculate_P(F, mu, kappa):\n        \"\"\"\n        Computes the First Piola-Kirchhoff stress tensor P(F) using the derived formula.\n        \"\"\"\n        J = np.linalg.det(F)\n        # It's an established result that d(det(A))/dA = det(A) * A^(-T)\n        F_inv_T = np.linalg.inv(F).T\n        P = mu * F + (kappa * np.log(J) - mu) * F_inv_T\n        return P\n\n    results = []\n    for case in test_cases:\n        F, delta_F, mu, kappa, epsilon = case[\"F\"], case[\"delta_F\"], case[\"mu\"], case[\"kappa\"], case[\"epsilon\"]\n\n        # 1. Analytical directional derivative: dW_analytic = P(F) : delta_F\n        P = calculate_P(F, mu, kappa)\n        dW_analytic = np.sum(P * delta_F)  # Frobenius inner product\n\n        # 2. Finite difference approximation of the directional derivative\n        F_plus = F + epsilon * delta_F\n        F_minus = F - epsilon * delta_F\n        \n        W_plus = calculate_W(F_plus, mu, kappa)\n        W_minus = calculate_W(F_minus, mu, kappa)\n\n        dW_fd = (W_plus - W_minus) / (2 * epsilon)\n\n        # 3. Compute symmetric relative error\n        abs_diff = np.abs(dW_analytic - dW_fd)\n        denominator = np.abs(dW_analytic) + np.abs(dW_fd) + 1e-12\n        err = abs_diff / denominator\n\n        # 4. Check against tolerance\n        passed = err = 1e-6\n        results.append(passed)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2587909"}]}