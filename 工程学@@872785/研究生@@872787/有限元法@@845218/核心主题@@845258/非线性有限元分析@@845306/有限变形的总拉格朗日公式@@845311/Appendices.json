{"hands_on_practices": [{"introduction": "变形梯度$F$是有限变形力学的基石。本练习提供了一种直接的解析方法，针对一个简单但具有代表性的变形来计算$F$及其相关张量（$C$和$J$）。通过检验物理可容许性条件，您将把抽象的数学定义与具体的物理约束（例如物质的不可穿透性）联系起来。", "problem": "考虑一个处于 $\\mathbb{R}^{3}$ 中参考构型下的物体，其物质点位置为 $X \\in \\Omega_{0} \\subset \\mathbb{R}^{3}$。一个均匀变形由映射 $\\varphi:\\Omega_{0}\\to\\mathbb{R}^{3}$ 指定，其形式为 $\\varphi(X)=\\mathrm{diag}(\\lambda_{1},\\lambda_{2},\\lambda_{3})\\,X$，其中 $\\lambda_{1},\\lambda_{2},\\lambda_{3}\\in\\mathbb{R}$ 为常数。使用有限变形的全拉格朗日(TL)描述的运动学，从第一性原理推导变形梯度 $F$、右柯西-格林张量 $C$ 以及变形的雅可比行列式 $J$。然后，基于全拉格朗日有限元分析中的基本物理和数学可容许性要求（包括方向保持、物质不可穿透性和变形的可逆性），确定能够产生可容许变形的三元组 $\\{\\lambda_{i}\\}_{i=1}^{3}$ 的集合，并证明你的答案。\n\n从 $F$、$C$ 和 $J$ 在参考构型中的核心定义开始，给出你推导的所有步骤。为了评分，最终答案只报告你得到的 $J$ 关于 $\\lambda_{1}$、$\\lambda_{2}$ 和 $\\lambda_{3}$ 的闭式解析表达式。最终报告的量无需四舍五入，也不涉及单位。", "solution": "问题陈述已经过验证，并被认定为有效。它在科学上基于连续介质力学原理，是适定的、客观的，并包含获得唯一解所需的所有信息。我们将开始推导。\n\n该问题描述了一个物体从参考构型 $\\Omega_{0}$ 到当前构型的均匀变形。一个位置矢量为 $X \\in \\Omega_{0}$ 的物质点通过函数 $\\varphi$ 映射到空间位置 $x \\in \\Omega$。$X$ 的分量为 $(X_{1}, X_{2}, X_{3})$，$x$ 的分量为 $(x_{1}, x_{2}, x_{3})$。给定的变形映射为：\n$$\nx = \\varphi(X) = \\mathbf{A} X\n$$\n其中 $\\mathbf{A}$ 是一个常数矩阵，给定为 $\\mathrm{diag}(\\lambda_{1}, \\lambda_{2}, \\lambda_{3})$。用分量形式表示为：\n$$\n\\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\end{pmatrix} = \\begin{pmatrix} \\lambda_{1} & 0 & 0 \\\\ 0 & \\lambda_{2} & 0 \\\\ 0 & 0 & \\lambda_{3} \\end{pmatrix} \\begin{pmatrix} X_{1} \\\\ X_{2} \\\\ X_{3} \\end{pmatrix}\n$$\n展开为 $x_{1} = \\lambda_{1} X_{1}$、$x_{2} = \\lambda_{2} X_{2}$ 和 $x_{3} = \\lambda_{3} X_{3}$，其中 $\\lambda_{1}, \\lambda_{2}, \\lambda_{3}$ 是常实数。\n\n首先，我们推导变形梯度张量 $F$。根据定义，$F$ 是变形映射 $\\varphi$ 相对于参考坐标 $X$ 的物质梯度。其分量由 $F_{ij} = \\frac{\\partial \\varphi_{i}}{\\partial X_{j}} = \\frac{\\partial x_{i}}{\\partial X_{j}}$ 给出。我们计算每个分量：\n$$\nF_{11} = \\frac{\\partial x_{1}}{\\partial X_{1}} = \\frac{\\partial (\\lambda_{1} X_{1})}{\\partial X_{1}} = \\lambda_{1}\n$$\n$$\nF_{22} = \\frac{\\partial x_{2}}{\\partial X_{2}} = \\frac{\\partial (\\lambda_{2} X_{2})}{\\partial X_{2}} = \\lambda_{2}\n$$\n$$\nF_{33} = \\frac{\\partial x_{3}}{\\partial X_{3}} = \\frac{\\partial (\\lambda_{3} X_{3})}{\\partial X_{3}} = \\lambda_{3}\n$$\n所有非对角分量均为零。例如，当 $i \\neq j$ 时：\n$$\nF_{ij} = \\frac{\\partial x_{i}}{\\partial X_{j}} = \\frac{\\partial (\\lambda_{i} X_{i})}{\\partial X_{j}} = 0\n$$\n因此，变形梯度张量是一个对角矩阵：\n$$\nF = \\begin{pmatrix} \\lambda_{1} & 0 & 0 \\\\ 0 & \\lambda_{2} & 0 \\\\ 0 & 0 & \\lambda_{3} \\end{pmatrix}\n$$\n\n其次，我们推导右柯西-格林张量 $C$。该张量度量参考构型中的变形，定义为 $C = F^{T}F$，其中 $F^{T}$ 是 $F$ 的转置。由于 $F$ 是一个对角矩阵，其转置与自身相同，即 $F^{T} = F$。因此：\n$$\nC = F^{T}F = F F = F^{2}\n$$\n两个对角矩阵的乘积是一个对角矩阵，其对角元素是原始矩阵相应对角元素的乘积。\n$$\nC = \\begin{pmatrix} \\lambda_{1} & 0 & 0 \\\\ 0 & \\lambda_{2} & 0 \\\\ 0 & 0 & \\lambda_{3} \\end{pmatrix} \\begin{pmatrix} \\lambda_{1} & 0 & 0 \\\\ 0 & \\lambda_{2} & 0 \\\\ 0 & 0 & \\lambda_{3} \\end{pmatrix} = \\begin{pmatrix} \\lambda_{1}^{2} & 0 & 0 \\\\ 0 & \\lambda_{2}^{2} & 0 \\\\ 0 & 0 & \\lambda_{3}^{2} \\end{pmatrix}\n$$\n\n第三，我们推导变形的雅可比行列式 $J$。雅可比行列式定义为变形梯度张量的行列式，$J = \\det(F)$。它表示从参考构型到当前构型的局部体积变化比率，即 $J = \\frac{dV}{dV_{0}}$。对于推导出的 $F$：\n$$\nJ = \\det \\begin{pmatrix} \\lambda_{1} & 0 & 0 \\\\ 0 & \\lambda_{2} & 0 \\\\ 0 & 0 & \\lambda_{3} \\end{pmatrix}\n$$\n对角矩阵的行列式是其对角元素的乘积。因此：\n$$\nJ = \\lambda_{1} \\lambda_{2} \\lambda_{3}\n$$\n\n最后，我们必须确定能够产生可容许变形的三元组 $\\{\\lambda_{i}\\}_{i=1}^{3}$ 的集合。一个变形在物理上和数学上是可容许的，如果它满足几个基本要求：\n1.  **变形映射的可逆性**：映射 $\\varphi$ 必须是一一对应的，以确保每个空间点 $x$ 对应一个唯一的物质点 $X$。这要求变形梯度 $F$ 是一个可逆矩阵，这当且仅当其行列式不为零时成立。因此，我们必须有 $J \\neq 0$。此条件防止有限体积坍缩成一个面、一条线或一个点（此时 $J=0$），或从低维对象创造出有限体积（此时 $J$ 将为无穷大）。\n2.  **物质的不可穿透性**：这个物理公理指出，两个不同的物质粒子不可能同时占据同一个空间位置。如果映射是可逆的，即 $J \\neq 0$，则可以保证这一点。\n3.  **方向的保持**：该要求规定，局部物质基的“手性”必须保持不变。参考构型中的右手基必须映射到当前构型中的右手基。这当且仅当雅可比行列式严格为正时才满足：$J > 0$。$J < 0$ 的变形对应于物质的局部翻转或反射，这对于从一个未变形状态（此时 $J=1$）开始经历连续变形过程的真实物体来说，被认为是物理上不可能的。\n\n综合这些，可容许最终状态的必要条件是 $J = \\lambda_{1} \\lambda_{2} \\lambda_{3} > 0$。这意味着要么所有三个 $\\lambda_{i}$ 都为正，要么一个为正，两个为负。\n\n然而，我们必须考虑整个变形过程。在全拉格朗日描述中，变形通常被看作是一个从参考的、未变形的状态（此时 $X=x$，因此 $F = I$（单位矩阵）且 $\\lambda_{1} = \\lambda_{2} = \\lambda_{3} = 1$）开始的连续过程。雅可比行列式初始为 $J=1$。对于一个连续且物理上合理的变形路径，雅可比行列式 $J(t)$ 在过程中的所有时间 $t$ 都必须保持为正。它不能穿过零变为负。这施加了一个更严格的约束。主伸长 $\\lambda_{i}$ 本身必须从其初始值 $1$ 连续变化。任何 $\\lambda_{i}$ 要变为负，它必须经过值 $0$。在某个 $\\lambda_{i}$ 变为 $0$ 的瞬间，雅可比行列式 $J = \\lambda_{1} \\lambda_{2} \\lambda_{3}$ 变为 $0$，这对应于一个奇异的、物理上不允许的状态。\n\n因此，为了使变形能从参考状态通过一条连续的物理路径达到，每个主伸长在整个过程中都必须保持为正。这导出了最终的可容许性条件：\n$$\n\\lambda_{1} > 0, \\quad \\lambda_{2} > 0, \\quad \\lambda_{3} > 0\n$$\n因此，可容许的三元组集合是 $\\{\\lambda_{1}, \\lambda_{2}, \\lambda_{3}\\} \\in \\mathbb{R}^{3}$，使得对于 $i \\in \\{1, 2, 3\\}$ 都有 $\\lambda_{i} > 0$。这个更严格的条件自动满足了必要的数学条件 $J > 0$。", "answer": "$$\\boxed{\\lambda_{1} \\lambda_{2} \\lambda_{3}}$$", "id": "2607122"}, {"introduction": "有限元分析的准确性和效率取决于数值积分方法的正确选择。这个问题要求您剖析内部虚功积分，这是总拉格朗日列式的一个核心组成部分。通过在特定的运动学假设下确定被积函数的 polynomial degree，您将对如何选择能够实现精确积分的最低阶（从而最高效）高斯求积法则建立起基本的理解。", "problem": "一个三维$8$节点等参六面体单元（$Q_1$）被用于一个针对均匀超弹性固体的全拉格朗日有限元列式中。该单元在参考构型中是无畸变的，因此从父域 $[-1,1]^3$ 到参考域的等参映射是仿射的，具有恒定的雅可比行列式。试探位移场和虚位移场使用相同的三线性形函数进行插值，并且使得单元内的位移场在参考坐标下是线性的。\n\n仅使用基本定义（全拉格朗日虚功原理、变形梯度、格林-拉格朗日应变和第二皮奥拉-基尔霍夫应力的定义）以及关于高斯求积的已验证事实，确定在每个参数方向上精确积分单元内部虚功所需的最小高斯-勒让德求积阶数，记为$n$。将您的答案报告为整数$n$。", "solution": "问题陈述经过验证，被认为是有效的。它在科学上基于连续介质力学和有限元法的原理，并且是适定的、客观的和自洽的。不存在任何矛盾或含糊之处，可以得出一个严谨、唯一的解。问题的核心是在给定的特定约束下，确定内部虚功的被积函数的多项式次数。\n\n在全拉格朗日列式中，内部虚功 $\\delta W_{int}$ 由第二皮奥拉-基尔霍夫应力张量 $\\mathbf{S}$ 和格林-拉格朗日应变张量的变分 $\\delta\\mathbf{E}$ 的缩并在参考体积 $V_0$ 上的积分给出：\n$$\n\\delta W_{int} = \\int_{V_0} \\mathbf{S} : \\delta\\mathbf{E} \\, dV_0\n$$\n对于有限元实现，该积分通过等参映射 $\\mathbf{X}(\\boldsymbol{\\xi})$ 转换到父域 $\\Omega_e = [-1,1]^3$ 上，其中 $\\mathbf{X}$ 是参考坐标，$\\boldsymbol{\\xi} = (\\xi, \\eta, \\zeta)$ 是父坐标。表达式变为：\n$$\n\\delta W_{int} = \\int_{-1}^1 \\int_{-1}^1 \\int_{-1}^1 (\\mathbf{S} : \\delta\\mathbf{E}) \\det(\\mathbf{J}) \\, d\\xi \\, d\\eta \\, d\\zeta\n$$\n这里，$\\mathbf{J}$ 是映射 $\\mathbf{X}(\\boldsymbol{\\xi})$ 的雅可比矩阵。问题陈述该单元在参考构型中是无畸变的，因此映射是仿射的。因此，雅可比矩阵 $\\mathbf{J}$ 是一个常数矩阵，其行列式 $\\det(\\mathbf{J})$ 是一个常数。所以，$\\det(\\mathbf{J})$ 不影响被积函数的多项式次数。我们的任务简化为找出项 $\\mathbf{S} : \\delta\\mathbf{E}$ 作为父坐标 $(\\xi, \\eta, \\zeta)$ 函数的多项式次数。\n\n我们根据所提供的信息分析被积函数的每个分量。\n\n1.  **变形梯度 ($\\mathbf{F}$):** 变形梯度定义为 $F_{iJ} = \\frac{\\partial x_i}{\\partial X_J} = \\delta_{iJ} + \\frac{\\partial u_i}{\\partial X_J}$，其中 $\\mathbf{u}$ 是位移场。问题明确指出“单元内的位移场在参考坐标下是线性的”。这意味着 $\\mathbf{u}(\\mathbf{X}) = \\mathbf{H}\\mathbf{X} + \\mathbf{c}$，其中 $\\mathbf{H}$ 是表示位移梯度的常数矩阵，$\\mathbf{c}$ 是一个常数向量。因此，梯度 $\\frac{\\partial u_i}{\\partial X_J} = H_{iJ}$ 是常数。由此可知，变形梯度 $\\mathbf{F}$ 在整个单元内是一个常数张量。\n\n2.  **格林-拉格朗日应变 ($\\mathbf{E}$):** 格林-拉格朗日应变张量定义为 $\\mathbf{E} = \\frac{1}{2}(\\mathbf{F}^T\\mathbf{F} - \\mathbf{I})$。由于 $\\mathbf{F}$ 是一个常数张量，$\\mathbf{F}^T\\mathbf{F}$ 也是常数。因此，应变张量 $\\mathbf{E}$ 在整个单元内是常数。\n\n3.  **第二皮奥拉-基尔霍夫应力 ($\\mathbf{S}$):** 该实体被指定为超弹性和均匀的。这意味着存在一个应变能密度函数 $W(\\mathbf{E})$，使得 $\\mathbf{S} = \\frac{\\partial W}{\\partial \\mathbf{E}}$。由于材料是均匀的，$W$ 不显式地依赖于位置 $\\mathbf{X}$。因为 $\\mathbf{E}$ 在整个单元内是常数，作为 $\\mathbf{E}$ 函数的应力张量 $\\mathbf{S}$ 也必须在整个单元内是常数。\n\n4.  **格林-拉格朗日应变的变分 ($\\delta\\mathbf{E}$):** 应变的变分为 $\\delta\\mathbf{E} = \\frac{1}{2}(\\delta\\mathbf{F}^T \\mathbf{F} + \\mathbf{F}^T \\delta\\mathbf{F})$。为了确定 $\\delta\\mathbf{E}$ 的性质，我们必须首先分析变形梯度的变分 $\\delta\\mathbf{F}$。虚位移场 $\\delta\\mathbf{u}$ 使用与试探场相同的三线性形函数 $N_I(\\xi, \\eta, \\zeta)$ 进行插值。因此，$\\delta\\mathbf{u}(\\boldsymbol{\\xi}) = \\sum_{I=1}^8 N_I(\\boldsymbol{\\xi}) \\delta\\mathbf{u}_I$，其中 $\\delta\\mathbf{u}_I$ 是节点虚位移。变形梯度的变分为 $\\delta\\mathbf{F} = \\nabla_{\\mathbf{X}}(\\delta\\mathbf{u})$。使用链式法则，我们将关于 $\\mathbf{X}$ 的梯度与关于 $\\boldsymbol{\\xi}$ 的梯度联系起来：\n$$\n\\delta\\mathbf{F} = (\\nabla_{\\boldsymbol{\\xi}}(\\delta\\mathbf{u})) \\mathbf{J}^{-1}\n$$\n由于 $\\mathbf{J}$ 是一个常数矩阵，$\\delta\\mathbf{F}$ 的多项式特性由 $\\nabla_{\\boldsymbol{\\xi}}(\\delta\\mathbf{u})$ 的特性决定。$\\delta\\mathbf{u}$ 的分量是 $(\\xi, \\eta, \\zeta)$ 的三线性函数。一个三线性函数对一个父坐标（例如 $\\xi$）的导数，会得到一个关于另外两个坐标（例如 $\\eta, \\zeta$）的双线性函数。例如，$\\frac{\\partial}{\\partial\\xi}(c_1 + c_2\\xi + c_3\\eta + c_4\\zeta + c_5\\xi\\eta + c_6\\eta\\zeta + c_7\\xi\\zeta + c_8\\xi\\eta\\zeta) = c_2 + c_5\\eta + c_7\\zeta + c_8\\eta\\zeta$。这个结果多项式在 $\\eta$ 和 $\\zeta$ 上都是1次的。因此，$\\nabla_{\\boldsymbol{\\xi}}(\\delta\\mathbf{u})$ 的一个分量，如 $\\frac{\\partial(\\delta u_i)}{\\partial \\xi_k}$，是在每个父坐标上最高次数为1的多项式。因此，$\\delta\\mathbf{F}$ 的分量是关于 $(\\xi, \\eta, \\zeta)$ 的多项式，其中任何单个变量的最高次数为1。现在我们回到 $\\delta\\mathbf{E}$。由于 $\\mathbf{F}$ 是常数，而 $\\delta\\mathbf{F}$ 在每个 $(\\xi, \\eta, \\zeta)$ 中是最高次数为1的多项式，因此乘积项 $\\delta\\mathbf{F}^T \\mathbf{F}$ 和 $\\mathbf{F}^T \\delta\\mathbf{F}$ 也是在每个父坐标上最高次数为1的多项式。因此，$\\delta\\mathbf{E}$ 是一个张量，其分量在每个 $\\xi, \\eta, \\zeta$ 上是最高次数为1的多项式。\n\n5.  **被积函数和求积法则:** 被积函数是 $(\\mathbf{S} : \\delta\\mathbf{E})\\det(\\mathbf{J})$。我们已经确定 $\\mathbf{S}$ 和 $\\det(\\mathbf{J})$ 是常数，而 $\\delta\\mathbf{E}$ 在每个积分变量中是最高次数为1的多项式。因此，被积函数在每个变量 $\\xi$、$\\eta$ 和 $\\zeta$ 中是最高次数为 $P_{max} = 1$ 的多项式。\n\n一个每个方向有 $n$ 个点的高斯-勒让德求积法可以精确地积分最高次数为 $2n - 1$ 的单变量多项式。为了精确积分我们的被积函数，求积法则必须对次数为 $P_{max} = 1$ 的多项式精确。这要求：\n$$\n2n - 1 \\ge 1\n$$\n解出 $n$：\n$$\n2n \\ge 2\n$$\n$$\nn \\ge 1\n$$\n因为 $n$ 必须是表示求积点数的整数，所以 $n$ 的最小值为1。", "answer": "$$\\boxed{1}$$", "id": "2607106"}, {"introduction": "在非线性固体力学中，本构模型必须满足标架无关性（frame-indifference），这意味着其响应与刚体运动无关。这个编码练习将引导您完成任何总拉格朗日列式实现都必须通过的一项基本验证测试。通过数值计算验证刚体旋转在标架无关的超弹性材料中产生零内力，您将获得验证有限元代码物理正确性的实践经验。", "problem": "要求您在全拉格朗日列式中，为一个二维线性三角形有限元（三节点三角形）实现内力向量，并数值验证对于一个标架无关的可压缩超弹性本构模型，刚体转动产生的内力向量为零。您的程序必须使用参考构型和第二 Piola–Kirchhoff 应力来计算节点内力，并测试在刚体转动下这些力是否（在数值容差范围内）消失。\n\n基本原理：\n- 从参考构型中的虚功原理出发：内虚功为 $\\delta W_{\\mathrm{int}} = \\int_{\\Omega_0} \\mathbf{P} : \\nabla_0 \\delta \\mathbf{u} \\, \\mathrm{d}\\Omega_0$，其中 $\\mathbf{P}$ 是第一 Piola–Kirchhoff 应力，$\\nabla_0$ 表示关于参考坐标的梯度，$\\delta \\mathbf{u}$ 是虚位移。\n- 有限变形梯度为 $\\mathbf{F} = \\partial \\mathbf{x} / \\partial \\mathbf{X}$，其中 $\\mathbf{x}$ 是当前位置，$\\mathbf{X}$ 是参考位置。\n- 对于一个超弹性材料，其应变能密度仅依赖于右 Cauchy–Green 张量 $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{F}$（即标架无关），第二 Piola–Kirchhoff 应力为 $\\mathbf{S} = 2 \\, \\partial W / \\partial \\mathbf{C}$，且 $\\mathbf{P} = \\mathbf{F} \\, \\mathbf{S}$。\n- 对于二维可压缩 Neo–Hookean 超弹性模型，使用本构选择\n  $$\n  W(\\mathbf{F}) = \\frac{\\mu}{2} \\left( \\mathrm{tr}(\\mathbf{C}) - 2 \\right) - \\mu \\ln J + \\frac{\\lambda}{2} \\left( \\ln J \\right)^2,\n  $$\n  其中 $\\mu$ 和 $\\lambda$ 是 Lamé 参数，$\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$，以及 $J = \\det \\mathbf{F}$。相关的第二 Piola–Kirchhoff 应力为\n  $$\n  \\mathbf{S} = \\mu \\left( \\mathbf{I} - \\mathbf{C}^{-1} \\right) + \\lambda \\, \\ln J \\, \\mathbf{C}^{-1}.\n  $$\n- 对于刚性转动，$\\mathbf{F} = \\mathbf{R}$，其中 $\\mathbf{R}^{\\mathsf{T}}\\mathbf{R} = \\mathbf{I}$ 且 $\\det \\mathbf{R} = 1$，因此 $\\mathbf{C} = \\mathbf{I}$，$J = 1$，$\\mathbf{S} = \\mathbf{0}$，$\\mathbf{P} = \\mathbf{0}$，内力向量消失。\n\n需遵循的单元和数值实现细节：\n- 使用单个二维线性三角形（三节点单元）。参考节点坐标 $\\mathbf{X}_a$ 以米为单位给出。形函数是线性的，满足单位分解和线性完备性，因此均匀变形可以被精确表示。\n- 设当前节点坐标为 $\\mathbf{x}_a = \\mathbf{A} \\, \\mathbf{X}_a$，其中 $\\mathbf{A}$ 是一个常数 $2 \\times 2$ 变形映射。对于纯刚体转动，$\\mathbf{A} = \\mathbf{R}(\\theta)$，其中 $\\theta$ 以弧度为单位。对于非刚性测试，使用与旋转复合的拉伸，$\\mathbf{A} = \\mathbf{R}(\\theta) \\, \\mathrm{diag}(s, 1/s)$，其中 $s > 1$。\n- 在全拉格朗日列式中，从参考三角形的几何形状计算形函数的常数参考梯度 $\\nabla_0 N_a$。然后组装变形梯度\n  $$\n  \\mathbf{F} = \\sum_{a=1}^{3} \\mathbf{x}_a \\otimes \\left( \\nabla_0 N_a \\right)^{\\mathsf{T}},\n  $$\n  对于均匀变形下的线性三角形，该梯度是常数。计算 $\\mathbf{C}$、$J$、$\\mathbf{S}$ 和 $\\mathbf{P} = \\mathbf{F}\\mathbf{S}$。\n- 节点 $a$ 的内力为\n  $$\n  \\mathbf{r}_a = \\int_{\\Omega_0} \\mathbf{P} \\, \\nabla_0 N_a \\, \\mathrm{d}\\Omega_0,\n  $$\n  对于线性三角形，这简化为 $\\mathbf{r}_a = \\mathbf{P} \\, \\nabla_0 N_a \\, A_0$，其中 $A_0$ 是参考面积。使用单位厚度，不考虑体力。所有材料参数 $\\mu$ 和 $\\lambda$ 的单位是帕斯卡，坐标单位是米。\n\n验证目标：\n- 对于刚体转动映射，结果应为一个数值上为零的内力向量（所有分量在指定的容差范围内等于 $0$）。您必须计算所有节点和分量上节点内力向量的最大绝对值分量，如果该最大值不超过容差 $\\varepsilon$，则声明成功。\n- 使用容差 $\\varepsilon = 10^{-10}$。\n\n测试套件：\n- 使用以下具有节点坐标（单位：米）的单个参考单元：\n  - $\\mathbf{X}_1 = (0, 0)$，$\\mathbf{X}_2 = (1.2, 0.1)$，$\\mathbf{X}_3 = (0.2, 0.9)$。\n- 定义五个测试用例，每个用例产生一个布尔结果，指示该用例的内力向量是否（在数值上）为零：\n  1. 纯刚体转动，角度 $\\theta = \\pi/3$，材料参数 $\\mu = 8.0 \\times 10^{4}$ 和 $\\lambda = 1.2 \\times 10^{5}$。\n  2. 纯刚体转动，角度 $\\theta = 0$，材料参数 $\\mu = 1.0 \\times 10^{5}$ 和 $\\lambda = 2.0 \\times 10^{5}$。\n  3. 纯刚体转动，角度 $\\theta = \\pi/2$，材料参数 $\\mu = 5.0 \\times 10^{4}$ 和 $\\lambda = 1.0 \\times 10^{5}$。\n  4. 纯刚体转动，角度 $\\theta = \\pi$，材料参数 $\\mu = 3.3 \\times 10^{4}$ 和 $\\lambda = 7.7 \\times 10^{4}$。\n  5. 非刚性均匀变形，$\\theta = \\pi/6$，拉伸 $s = 1.05$，施加方式为 $\\mathbf{A} = \\mathbf{R}(\\theta) \\, \\mathrm{diag}(s, 1/s)$，材料参数 $\\mu = 8.0 \\times 10^{4}$ 和 $\\lambda = 1.2 \\times 10^{5}$。该用例应产生非零内力，因此布尔值为 false。\n- 角度以弧度为单位，材料参数以帕斯卡为单位，坐标以米为单位。将布尔结果表示为 Python 风格的字面量。\n\n您的程序必须：\n- 为单个三角形实现所描述的全拉格朗日残差计算。\n- 对于每个测试用例，根据指定的映射构造当前节点位置，组装内力向量，计算最大绝对值分量，并将其与 $\\varepsilon = 10^{-10}$ 进行比较以产生一个布尔值。\n- 生成单行输出，其中包含一个逗号分隔并用方括号括起来的结果列表（例如，“[true,false,true,true,true]”，但使用 Python 布尔值的大小写和确切的列表格式：“[True,False,True,...]”）。\n\n最终输出必须是且仅为一行，包含指定格式的布尔值列表。不允许有其他文本。", "solution": "问题陈述经过严格验证，并被证实是有效的。它在科学上基于连续介质力学和有限元法的原理，问题设定良好，提供了所有必要的数据和定义，并以客观、正式的语言表述。没有可识别的缺陷、矛盾或模糊之处。该任务是计算固体力学中的一个标准验证程序。因此，我们可以着手求解。\n\n目标是在全拉格朗日框架内，计算单个二维三节点线性三角形单元的节点内力向量，并数值验证对于指定的标架无关可压缩超弹性材料模型，刚体转动产生的内力为零。\n\n该列式的基本原理是虚功原理，在参考构型 $\\Omega_0$ 中表述。内虚功 $\\delta W_{\\mathrm{int}}$ 由下式给出：\n$$\n\\delta W_{\\mathrm{int}} = \\int_{\\Omega_0} \\mathbf{P} : \\delta(\\nabla_0 \\mathbf{u}) \\, \\mathrm{d}\\Omega_0\n$$\n其中 $\\mathbf{P}$ 是第一 Piola-Kirchhoff 应力张量，$\\mathbf{u}$ 是位移场 ($\\mathbf{u} = \\mathbf{x} - \\mathbf{X}$)，$\\nabla_0$ 是关于参考坐标 $\\mathbf{X}$ 的梯度算子。对于有限元离散化，该积分导出了节点内力向量的定义。\n\n变形由变形梯度 $\\mathbf{F} = \\partial \\mathbf{x} / \\partial \\mathbf{X}$ 来表征，其中 $\\mathbf{x}$ 是当前坐标。由此，我们定义右 Cauchy-Green 变形张量 $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{F}$ 和体积变形雅可比 $J = \\det \\mathbf{F}$。\n\n问题指定了一个可压缩 Neo-Hookean 超弹性模型，其应变能密度函数 $W$ 由下式给出：\n$$\nW(\\mathbf{C}, J) = \\frac{\\mu}{2} \\left( \\mathrm{tr}(\\mathbf{C}) - 2 \\right) - \\mu \\ln J + \\frac{\\lambda}{2} \\left( \\ln J \\right)^2\n$$\n此处，$\\mu$ 和 $\\lambda$ 是 Lamé 材料参数。此材料模型是标架无关的，因为 $W$ 仅通过 $\\mathbf{C}$ 和 $J$ 依赖于变形。第二 Piola-Kirchhoff 应力张量 $\\mathbf{S}$ 由 $W$ 导出，公式为 $\\mathbf{S} = 2 \\frac{\\partial W}{\\partial \\mathbf{C}}$。对于给定的 $W$，这得到：\n$$\n\\mathbf{S} = \\mu \\left( \\mathbf{I} - \\mathbf{C}^{-1} \\right) + \\lambda (\\ln J) \\mathbf{C}^{-1}\n$$\n第一和第二 Piola-Kirchhoff 应力张量通过前推运算 $\\mathbf{P} = \\mathbf{F} \\mathbf{S}$ 相关联。\n\n对于线性三角形单元，单元内任意点的位置通过线性形函数 $N_a$ 从节点位置插值得到：\n$$\n\\mathbf{X} = \\sum_{a=1}^{3} N_a \\mathbf{X}_a \\quad \\text{和} \\quad \\mathbf{x} = \\sum_{a=1}^{3} N_a \\mathbf{x}_a\n$$\n形函数关于参考坐标的梯度 $\\nabla_0 N_a$ 在单元内是常数。变形梯度 $\\mathbf{F}$ 也是常数，计算如下：\n$$\n\\mathbf{F} = \\frac{\\partial \\mathbf{x}}{\\partial \\mathbf{X}} = \\frac{\\partial}{\\partial \\mathbf{X}} \\left( \\sum_{a=1}^{3} N_a \\mathbf{x}_a \\right) = \\sum_{a=1}^{3} \\mathbf{x}_a \\otimes (\\nabla_0 N_a)^{\\mathsf{T}}\n$$\n我们已知节点变形遵循一个均匀映射 $\\mathbf{x}_a = \\mathbf{A} \\mathbf{X}_a$，其中 $\\mathbf{A}$ 为某个常数 $2 \\times 2$ 矩阵。将此代入 $\\mathbf{F}$ 的表达式中，会得到一个关键简化：\n$$\n\\mathbf{F} = \\sum_{a=1}^{3} (\\mathbf{A} \\mathbf{X}_a) \\otimes (\\nabla_0 N_a)^{\\mathsf{T}} = \\mathbf{A} \\left( \\sum_{a=1}^{3} \\mathbf{X}_a \\otimes (\\nabla_0 N_a)^{\\mathsf{T}} \\right)\n$$\n括号中的项是恒等映射 $\\mathbf{X} = \\sum N_a \\mathbf{X}_a$ 相对于其自身的梯度，即单位张量 $\\mathbf{I}$：\n$$\n\\sum_{a=1}^{3} \\mathbf{X}_a \\otimes (\\nabla_0 N_a)^{\\mathsf{T}} = \\frac{\\partial}{\\partial \\mathbf{X}} \\left( \\sum_{a=1}^{3} N_a \\mathbf{X}_a \\right) = \\frac{\\partial \\mathbf{X}}{\\partial \\mathbf{X}} = \\mathbf{I}\n$$\n因此，对于承受均匀变形的线性单元，变形梯度就是 $\\mathbf{F} = \\mathbf{A}$。\n\n内力向量 $\\mathbf{r}$ 由节点贡献 $\\mathbf{r}_a$ 组装而成。对于节点 $a$，力由下式给出：\n$$\n\\mathbf{r}_a = \\int_{\\Omega_0} (\\nabla_0 N_a)^{\\mathsf{T}} \\mathbf{P}^{\\mathsf{T}} \\, \\mathrm{d}\\Omega_0 = \\left( \\int_{\\Omega_0} \\mathrm{d}\\Omega_0 \\right) \\mathbf{P} (\\nabla_0 N_a) = A_0 \\mathbf{P} (\\nabla_0 N_a)\n$$\n其中 $A_0$ 是单元在参考构型中的面积，我们利用了 $\\mathbf{P}$ 和 $\\nabla_0 N_a$ 是常数这一事实。我们假设单位厚度。\n\n理论验证基于刚体转动下的行为。在这种情况下，变形映射 $\\mathbf{A}$ 是一个正常正交旋转矩阵 $\\mathbf{R}$，因此 $\\mathbf{F} = \\mathbf{R}$。根据定义，$\\mathbf{R}^{\\mathsf{T}}\\mathbf{R} = \\mathbf{I}$ 且 $\\det(\\mathbf{R}) = 1$。这意味着 $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F} = \\mathbf{I}$ 且 $J = \\det \\mathbf{F} = 1$。将这些代入 $\\mathbf{S}$ 的本构律中：\n$$\n\\mathbf{S} = \\mu \\left( \\mathbf{I} - \\mathbf{I}^{-1} \\right) + \\lambda (\\ln 1) \\mathbf{I}^{-1} = \\mu(\\mathbf{I} - \\mathbf{I}) + \\mathbf{0} = \\mathbf{0}\n$$\n由于 $\\mathbf{S} = \\mathbf{0}$，立即得出 $\\mathbf{P} = \\mathbf{F}\\mathbf{S} = \\mathbf{R}\\mathbf{0} = \\mathbf{0}$。因此，节点内力 $\\mathbf{r}_a = A_0 \\mathbf{P} (\\nabla_0 N_a)$ 必定为零。对于任何非刚性变形，通常 $\\mathbf{C} \\neq \\mathbf{I}$，导致 $\\mathbf{S} \\neq \\mathbf{0}$ 和非零内力。\n\n计算流程如下：\n1.  对于给定的参考节点坐标 $\\mathbf{X}_1, \\mathbf{X}_2, \\mathbf{X}_3$，计算单元的常数属性：参考面积 $A_0$ 和形函数梯度矩阵 $\\mathbf{B}_0 = [\\nabla_0 N_1 | \\nabla_0 N_2 | \\nabla_0 N_3]$。\n2.  对于每个测试用例：\n    a. 根据指定的旋转角度 $\\theta$ 和拉伸 $s$ 构造变形映射矩阵 $\\mathbf{A}$。对于刚体转动，$\\mathbf{A} = \\mathbf{R}(\\theta)$。对于非刚性情况，$\\mathbf{A} = \\mathbf{R}(\\theta) \\mathrm{diag}(s, 1/s)$。\n    b. 设置变形梯度 $\\mathbf{F} = \\mathbf{A}$。\n    c. 计算 $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$、$J = \\det \\mathbf{F}$ 和 $\\mathbf{C}^{-1}$。\n    d. 计算第二 Piola-Kirchhoff 应力 $\\mathbf{S} = \\mu(\\mathbf{I} - \\mathbf{C}^{-1}) + \\lambda(\\ln J)\\mathbf{C}^{-1}$。\n    e. 计算第一 Piola-Kirchhoff 应力 $\\mathbf{P} = \\mathbf{F}\\mathbf{S}$。\n    f. 计算节点内力矩阵 $\\mathbf{R}_{\\text{forces}} = A_0 \\mathbf{P} \\mathbf{B}_0$。这是一个 $2 \\times 3$ 矩阵，其中第 $a$ 列对应于 $\\mathbf{r}_a$。\n    g. 找出 $\\mathbf{R}_{\\text{forces}}$ 中所有分量的最大绝对值。\n    h. 将此最大值与容差 $\\varepsilon = 10^{-10}$ 进行比较。如果它小于或等于 $\\varepsilon$，则结果为 True；否则为 False。\n3.  将所有测试用例的布尔结果收集到一个列表中，作为最终输出。\n将实施此程序以产生所需的验证结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the Total Lagrangian internal force calculation for a 2D linear\n    triangular element and verifies that rigid body rotations produce zero\n    internal forces for a compressible Neo-Hookean material.\n    \"\"\"\n\n    # --- Element and Material Properties ---\n    # Reference nodal coordinates (m)\n    X_coords = np.array([\n        [0.0, 0.0],  # Node 1\n        [1.2, 0.1],  # Node 2\n        [0.2, 0.9]   # Node 3\n    ]).T  # Transpose to get a 2x3 matrix [X; Y]\n\n    # Tolerance for numerical zero\n    epsilon = 1e-10\n\n    # --- Pre-computation of Constant Element Properties ---\n    X1, Y1 = X_coords[:, 0]\n    X2, Y2 = X_coords[:, 1]\n    X3, Y3 = X_coords[:, 2]\n\n    # Reference area of the triangle\n    A0 = 0.5 * ((X2 - X1) * (Y3 - Y1) - (X3 - X1) * (Y2 - Y1))\n    \n    # Check for degenerate element\n    if abs(A0)  1e-12:\n        raise ValueError(\"Reference element is degenerate (zero area).\")\n\n    # Matrix of reference shape function gradients (B0-matrix)\n    # B0 = [dN1/dX, dN2/dX, dN3/dX]\n    #      [dN1/dY, dN2/dY, dN3/dY]\n    B0_matrix = (1.0 / (2.0 * A0)) * np.array([\n        [Y2 - Y3, Y3 - Y1, Y1 - Y2],\n        [X3 - X2, X1 - X3, X2 - X1]\n    ])\n\n    # --- Test Cases ---\n    test_cases = [\n        {'theta': np.pi / 3, 's': 1.0, 'mu': 8.0e4, 'lambda': 1.2e5}, # Case 1: Rigid rotation\n        {'theta': 0.0, 's': 1.0, 'mu': 1.0e5, 'lambda': 2.0e5},       # Case 2: Identity (zero rotation)\n        {'theta': np.pi / 2, 's': 1.0, 'mu': 5.0e4, 'lambda': 1.0e5}, # Case 3: Rigid rotation\n        {'theta': np.pi, 's': 1.0, 'mu': 3.3e4, 'lambda': 7.7e4},     # Case 4: Rigid rotation\n        {'theta': np.pi / 6, 's': 1.05, 'mu': 8.0e4, 'lambda': 1.2e5} # Case 5: Non-rigid deformation\n    ]\n\n    results = []\n\n    # --- Main Calculation Loop ---\n    for case in test_cases:\n        theta = case['theta']\n        s = case['s']\n        mu = case['mu']\n        lmbda = case['lambda'] # 'lambda' is a keyword in Python\n\n        # 1. Construct the deformation mapping matrix A\n        # Rotation matrix\n        R = np.array([\n            [np.cos(theta), -np.sin(theta)],\n            [np.sin(theta),  np.cos(theta)]\n        ])\n        # Stretch matrix\n        U = np.diag([s, 1.0 / s])\n        # Deformation mapping\n        A = R @ U\n\n        # 2. For a linear element under homogeneous deformation, F = A\n        F = A\n        \n        # 3. Compute kinematic quantities\n        C = F.T @ F  # Right Cauchy-Green tensor\n        J = np.linalg.det(F) # Jacobian of deformation\n\n        # Check for unphysical deformation\n        if J = 0:\n            raise ValueError(f\"Unphysical deformation with J = {J} = 0.\")\n            \n        C_inv = np.linalg.inv(C)\n        I = np.identity(2)\n        \n        # 4. Compute Second Piola-Kirchhoff stress S\n        S = mu * (I - C_inv) + lmbda * np.log(J) * C_inv\n        \n        # 5. Compute First Piola-Kirchhoff stress P\n        P = F @ S\n        \n        # 6. Compute internal nodal forces\n        # r_a = A0 * P * (nabla_0 N_a)\n        # We can compute all nodal forces at once:\n        # R_forces is a 2x3 matrix where column 'a' is the force vector for node 'a'\n        R_forces = A0 * P @ B0_matrix\n        \n        # 7. Verification\n        # Find the maximum absolute component of the internal force vector\n        max_force_component = np.max(np.abs(R_forces))\n        \n        # Compare with tolerance\n        is_zero = (max_force_component = epsilon)\n        results.append(is_zero)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nsolve()\n```", "id": "2607108"}]}