## 引言
在[有限元分析](@entry_id:138109)（FEM）的广阔领域中，数值积分是连接理论与实践的桥梁，它使得计算复杂几何形状下单元的刚度矩阵和力向量成为可能。然而，积分方案的选择远非一个纯粹的计算精度问题；它深刻地影响着单元的力学行为。一个看似“精确”的完全积分方案，在特定条件下反而会引发灾难性的[数值病态](@entry_id:169044)，使得计算结果毫无物理意义。这一矛盾构成了[计算力学](@entry_id:174464)中的一个核心挑战。

本文旨在系统性地解决这一知识鸿沟，即低阶有限元单元在处理约束性问题时普遍存在的“锁定”（locking）现象。当模拟[近不可压缩材料](@entry_id:752388)或细长结构时，低阶单元有限的运动自由度无法满足完全积分施加的过强[运动学](@entry_id:173318)约束，导致其表现出虚假的、极大的刚度。为了克服这一难题，本文将引导读者深入探索[减缩积分](@entry_id:167949)与[选择性减缩积分](@entry_id:168281)等一系列巧妙的数值技术。

在接下来的章节中，您将学习到：
*   **第一章：原理与机制** 将深入剖析[数值积分](@entry_id:136578)的本质、[体积锁定](@entry_id:172606)与剪切锁定的力学根源，并详细介绍[减缩积分](@entry_id:167949)如何缓解锁定，以及其带来的“[沙漏模式](@entry_id:174855)”副作用。最终，将引出[选择性减缩积分](@entry_id:168281)作为一种更为稳健的解决方案。
*   **第二章：应用与[交叉](@entry_id:147634)学科联系** 将展示这些技术在固体力学、[结构工程](@entry_id:152273)、[非线性](@entry_id:637147)分析乃至[多物理场耦合](@entry_id:171389)问题（如[多孔介质](@entry_id:154591)和[压电材料](@entry_id:197563)）中的广泛应用，并探讨其与混合公式的深刻理论联系以及对[显式动力学](@entry_id:171710)[计算效率](@entry_id:270255)的巨大影响。
*   **第三章：动手实践** 将通过一系列精心设计的计算练习，让您亲手验证单元检验、分析[积分误差](@entry_id:171351)，并直面网格扭曲带来的挑战，从而将理论知识转化为实践能力。

通过本次学习，您将掌握一套关键的有限元高级技术，学会如何在追求计算精度的同时，明智地规避数值陷阱，从而显著提升您解决复杂工程与科学问题的能力。

## 原理与机制

在[有限元法](@entry_id:749389)中，[单元刚度矩阵](@entry_id:139369)等关键量的计算，依赖于在每个单元域上对复杂函数进行积分。解析积分通常是不切实际的，因此[数值积分](@entry_id:136578)，特别是高斯求积，成为了[计算力学](@entry_id:174464)中的标准工具。然而，数值积分的阶次选择并非仅仅关乎计算精度和效率；它深刻地影响着单元的力学行为，甚至可以用来克服低阶单元中普遍存在的[数值病态](@entry_id:169044)问题。本章将深入探讨[数值积分](@entry_id:136578)的基本原理，阐释“锁定”现象的机制，并系统介绍旨在解决这些问题的[减缩积分](@entry_id:167949)与[选择性减缩积分](@entry_id:168281)技术。

### 有限元中的数值积分

[单元刚度矩阵](@entry_id:139369) $\mathbf{k}^e$ 源于弱形式的变分原理，其一般形式为在单元域 $\Omega_e$ 上的积分：
$$
\mathbf{k}^e = \int_{\Omega_e} \mathbf{B}^T \mathbf{D} \mathbf{B} \, dV
$$
其中 $\mathbf{B}$ 是[应变-位移矩阵](@entry_id:163451)，$\mathbf{D}$ 是[本构矩阵](@entry_id:164908)。对于等参元，该积分通过坐标变换映射到规则的父单元域 $\hat{\Omega}$（例如，对于[四边形单元](@entry_id:176937)，是 $[-1, 1] \times [-1, 1]$ 的正方形）上进行计算：
$$
\mathbf{k}^e = \int_{\hat{\Omega}} \mathbf{B}(\boldsymbol{\xi})^T \mathbf{D} \mathbf{B}(\boldsymbol{\xi}) \det(\mathbf{J}(\boldsymbol{\xi})) \, d\boldsymbol{\xi}
$$
这里，$\boldsymbol{\xi}$ 是父坐标，$\mathbf{J}$ 是从父坐标到物理坐标的[雅可比矩阵](@entry_id:264467)。被积函数通常是关于父坐标 $\boldsymbol{\xi}$ 的复杂有理函数，因此必须采用数值方法进行计算。

**[高斯-勒让德求积](@entry_id:138201)** (Gauss-Legendre quadrature) 是有限元分析中最常用的[数值积分方法](@entry_id:141406)。其核心思想是通过精心选择积分点（[高斯点](@entry_id:170251)）的位置和相应的权重，从而以最少的计算量达到最高的积分精度。

一维高斯求积的基本性质是：使用 $n$ 个[高斯点](@entry_id:170251)，可以精确地对任意次数不高于 $2n-1$ 的多项式进行积分 [@problem_id:2592729]。这一非凡的精度源于其积分点的选择——它们是 $n$ 阶[勒让德多项式](@entry_id:141510) $P_n$ 的零点。

对于二维或三维问题，通常采用**[张量积](@entry_id:140694)** (tensor-product) 的方式构建高斯求积法则。例如，在一个二维父单元 $[-1, 1]^2$ 上，一个 $n \times n$ 的[张量积](@entry_id:140694)高斯法则由 $n^2$ 个[高斯点](@entry_id:170251)组成。其积分精度由一维法则决定：它可以精确地对所有形如 $p(\xi, \eta) = \sum_k q_k(\xi) r_k(\eta)$ 的可分离函数求和形式的多项式进行积分，其中每个一维多项式 $q_k(\xi)$ 和 $r_k(\eta)$ 的次数不高于 $2n-1$。这等价于，该法则可以精确积分所有在每个变量 $\xi$ 和 $\eta$ 上的次数分别不高于 $2n-1$ 的多项式 [@problem_id:2592729]。需要注意的是，这比“总次数”不高于 $2n-1$ 的多项式空间要大得多。

在有限元实践中，我们定义**完全积分** (full integration) 为能够精确计算一个理想几何形状（例如，由[仿射映射](@entry_id:746332)生成的平行四边形）[单元刚度矩阵](@entry_id:139369)的最低阶求积法则。让我们以一个四节点双线性[四边形单元](@entry_id:176937) (Q4) 为例。假设单元通过[仿射映射](@entry_id:746332)生成，其雅可比矩阵 $\mathbf{J}$ 和[行列式](@entry_id:142978) $\det(J)$ 均为常数。Q4 单元的形函数 $N_i$ 是关于 $\xi$ 和 $\eta$ 的双线性多项式。其对父坐标的导数，例如 $\frac{\partial N_i}{\partial \xi}$，是关于 $\eta$ 的线性函数，而对 $\xi$ 是常数。[刚度矩阵](@entry_id:178659)的被积函数包含形如 $(\nabla N_i)^T \mathbf{D} (\nabla N_j)$ 的项，这些项是形函数导数的二次乘积。因此，被积函数中关于 $\xi$ 和 $\eta$ 的最高次数均为 2 [@problem_id:2592782]。为了精确积分一个二次多项式，一维高斯求积需要满足 $2n-1 \ge 2$，这意味着 $n \ge 1.5$。因此，必须取整数 $n=2$。结论是，对于 Q4 单元，完全积分方案是一个 $2 \times 2$ 的[高斯求积法](@entry_id:146011)则，共需 4 个积分点 [@problem_id:2592729]。

### 锁定的病态现象

尽管完全积分在数学上能保证对理想单元的精确积分，但在某些物理极限情况下，它反而会导致一种被称为**锁定** (locking) 的[数值病态](@entry_id:169044)。锁定表现为单元变得异常刚硬，无法正确模拟物理变形，导致计算结果毫无意义。这种现象的根源在于，低阶单元的位移插值模式（即其“运动自由度”）不足以满足在完全积分下被过强施加的[运动学](@entry_id:173318)约束。

#### [体积锁定](@entry_id:172606)

**[体积锁定](@entry_id:172606)** (volumetric locking) 出现在模拟[近不可压缩材料](@entry_id:752388)（例如橡胶，其泊松比 $\nu \to 0.5$）时。在不可压缩极限下，材料的运动必须满足体积不变的约束，即应变张量的迹为零：$\mathrm{tr}(\boldsymbol{\varepsilon}) = \nabla \cdot \mathbf{u} = 0$。

当使用位移基的低阶单元（如 Q4 单元）并采用完全积分（$2 \times 2$ 法则）时，该离散格式试图在所有 4 个[高斯点](@entry_id:170251)上强制施加 $\mathrm{tr}(\boldsymbol{\varepsilon}) \approx 0$ 的约束。然而，一个 Q4 单元只有 8 个位移自由度，其双线性[位移场](@entry_id:141476)不足以同时满足这 4 个独立的点态约束，除非位移场趋于[平凡解](@entry_id:155162)（即零位移）。结果，单元表现出极大的伪刚度，仿佛被“锁定”而无法变形 [@problem_id:2592766]。从更高等的数学观点来看，锁定可以被解释为位移-压力[混合格式](@entry_id:167436)中，位移和压力的插值空间不满足离散的 LBB (Ladyzhenskaya-Babuška-Brezzi) 稳定条件 [@problem_id:2592766]。

#### 剪切锁定

**剪切锁定** (shear locking) 主要发生于薄板和薄[壳单元](@entry_id:176094)中，例如基于 Reissner-Mindlin 理论的单元。当板的厚度 $t \to 0$ 时，物理上板的抗横向剪切能力变得极强，其运动学趋向于满足 Kirchhoff-Love 理论的零横向剪切应变约束：$\boldsymbol{\gamma} = \mathbf{0}$。

对于一个使用低阶插值（例如 Q4 单元）的 Reissner-Mindlin 板单元，位移和转角场通常采用相同的[双线性插值](@entry_id:170280)。这种简单的[插值函数](@entry_id:262791)空间往往无法在表示[纯弯曲](@entry_id:202969)变形（薄板的主要变形模式）的同时，精确满足 $\boldsymbol{\gamma} = \mathbf{0}$ 的条件，从而产生“寄生剪切应变”。在离散的能量泛函中，剪切能项的刚度与 $t$ 成正比，而[弯曲能](@entry_id:174691)项的刚度与 $t^3$ 成正比。因此，剪切刚度与弯曲刚度的比值与 $1/t^2$ 成正比 [@problem_id:2592738]。当 $t \to 0$ 时，这个比值趋于无穷大。完全积分会使得能量泛函被剪切能项完全主导，从而极力压制任何非零的剪切应变。由于单元无法在弯曲时保持零剪切，其弯曲能力便被严重抑制，导致了剪切锁定 [@problem_id:2592738]。

### [减缩积分](@entry_id:167949)及其后果：[沙漏模式](@entry_id:174855)

解决锁定问题的一个直观想法是“放松”过强的约束。**[减缩积分](@entry_id:167949)** (Reduced Integration, RI) 正是基于这一思想的策略。它被定义为*有意地*使用比完全积分阶次更低的[求积法则](@entry_id:753909) [@problem_id:2592708]。例如，对于 Q4 单元，使用 $1 \times 1$ 的单[点积](@entry_id:149019)分代替 $2 \times 2$ 的完全积分。值得强调的是，[减缩积分](@entry_id:167949)是一种为改善单元性能而设计的技术，它不同于因疏忽而导致的“欠积分”(underintegration) 错误。例如，对于一个[截面](@entry_id:154995)和材料恒定的线性杆单元，其刚度矩阵的被积函数是常数，因此单点[高斯积分](@entry_id:187139)就能得到精确解。在这种情况下，使用单[点积](@entry_id:149019)分是精确积分，而非[减缩积分](@entry_id:167949)，并不会引入任何数值问题 [@problem_id:2592708]。

然而，[减缩积分](@entry_id:167949)是一把双刃剑。它在放松约束的同时，也可能带来一个致命的副作用：**[伪零能模式](@entry_id:755267)** (spurious zero-energy modes)，通常被称为**[沙漏模式](@entry_id:174855)** (hourglass modes)。

[沙漏模式](@entry_id:174855)是一种非[刚体运动](@entry_id:193355)的单元变形模式，在这种模式下，单元在所有[减缩积分](@entry_id:167949)点上的应均为零。因此，根据[数值积分](@entry_id:136578)计算出的[单元应变](@entry_id:163000)能为零 [@problem_id:2592703]。这意味着单元对于这些特定的变形模式不产生任何抵抗力，其刚度矩阵是奇异的（或称[秩亏](@entry_id:754065)的）。这些模式是纯粹的数值产物，不具备物理意义，若不加控制，将导致整个结构计算结果的崩溃。

我们可以通过分析采用 $1 \times 1$ [减缩积分](@entry_id:167949)的 Q4 单元来精确地理解[沙漏模式](@entry_id:174855)。此时，[单元刚度矩阵](@entry_id:139369)可近似为 $\mathbf{K}_e \approx (\text{Volume}) \cdot \mathbf{B}_0^T \mathbf{D} \mathbf{B}_0$，其中 $\mathbf{B}_0$ 是在单元[中心点](@entry_id:636820) $(\xi, \eta) = (0, 0)$ 计算的[应变-位移矩阵](@entry_id:163451)。一个[零能模式](@entry_id:172472) $\mathbf{u}_e$ 必须满足 $\mathbf{B}_0 \mathbf{u}_e = \mathbf{0}$ [@problem_id:2592754]。

对于一个矩形 Q4 单元，$\mathbf{B}_0$ 是一个 $3 \times 8$ 的矩阵。可以证明，这个[矩阵的秩](@entry_id:155507)为 3。根据线性代数中的[秩-零度定理](@entry_id:154441)，其零空间的维度（即[零能模式](@entry_id:172472)的数量）为 $8 - 3 = 5$ [@problem_id:2592754] [@problem_id:2592750]。

这个 5 维的[零能模式](@entry_id:172472)空间包含了所有物理上合理的零应变能模式，即 3 个刚体运动模式（2 个平移和 1 个转动）。那么，余下的 $5 - 3 = 2$ 个模式就是非物理的、由[减缩积分](@entry_id:167949)引入的[伪零能模式](@entry_id:755267)——即两个独立的[沙漏模式](@entry_id:174855) [@problem_id:2592754] [@problem_id:2592750]。这两个模式具有典型的“领结”或“沙漏”形状，例如，一个模式可以表示为节点 $x$ 方向位移呈现 $[1, -1, 1, -1]^T$ 的模式，而 $y$ 方向位移为零；另一个模式则对应于 $y$ 方向位移呈现该模式。虽然这些变形模式在单元中心点的应变为零，但在单元的其他位置应变非零 [@problem_id:2592703]。在动力学分析中，这些[沙漏模式](@entry_id:174855)对应于[广义特征值问题](@entry_id:151614) $\mathbf{K}_{RI} \mathbf{u} = \lambda \mathbf{M} \mathbf{u}$ 中的零[特征值](@entry_id:154894) [@problem_id:2592750]。

### [选择性减缩积分](@entry_id:168281)：一种精巧的解决方案

既然完全积分会导致锁定，而（均匀的）[减缩积分](@entry_id:167949)又会引发[沙漏模式](@entry_id:174855)，我们是否能找到一种两全其美的方法？**[选择性减缩积分](@entry_id:168281)** (Selective Reduced Integration, SRI) 应运而生。其核心思想是“对症下药”：将单元的应变能分解为不同部分，并对不同部分采用不同的积分法则 [@problem_id:2592708]。

#### 应对[体积锁定](@entry_id:172606)

为了解决[体积锁定](@entry_id:172606)，首先需要将材料的[应变能密度](@entry_id:200085) $W$ 分解为**体积** (volumetric) 和**[偏应变](@entry_id:201263)** (deviatoric) 两部分：$W = W_{\text{vol}} + W_{\text{dev}}$。对于[各向同性线弹性](@entry_id:185899)材料，这个分解是唯一的 [@problem_id:2592746]：
$$
W = \underbrace{\mu\,\boldsymbol{\varepsilon}_{\text{dev}}:\boldsymbol{\varepsilon}_{\text{dev}}}_{W_{\text{dev}}} + \underbrace{\frac{\kappa}{2}\,(\mathrm{tr}\,\boldsymbol{\varepsilon})^{2}}_{W_{\text{vol}}}
$$
其中，$\mu$ 是剪切模量，$\kappa$ 是[体积模量](@entry_id:160069)，$\boldsymbol{\varepsilon}_{\text{dev}} = \boldsymbol{\varepsilon} - \frac{1}{3}\mathrm{tr}(\boldsymbol{\varepsilon})\mathbf{I}$ 是偏应变张量。$W_{\text{dev}}$ 描述了形状改变（剪切变形）所储存的能量，而 $W_{\text{vol}}$ 描述了体积改变所储存的能量。[体积锁定](@entry_id:172606)正是由 $W_{\text{vol}}$ 项引起的。

SRI 的策略是：
1.  对引起锁定的**体积能项** ($W_{\text{vol}}$) 采用**[减缩积分](@entry_id:167949)**（例如，对 Q4 或 H8 单元采用 $1 \times 1 \times 1$ 单[点积](@entry_id:149019)分）。
2.  对表现良好的**[偏应变](@entry_id:201263)能项** ($W_{\text{dev}}$) 仍然采用**完全积分**（例如，对 Q4 单元采用 $2 \times 2$ 积分，对 H8 单元采用 $2 \times 2 \times 2$ 积分）。[@problem_id:2592746]

这种方法的巧妙之处在于 [@problem_id:2592729]：对体积项的[减缩积分](@entry_id:167949)有效地放松了不可压缩约束，从而消除了锁定；与此同时，对[偏应变](@entry_id:201263)项的完全积分保证了单元具有足够的刚度来抵抗沙漏变形模式，从而维持了[单元刚度矩阵](@entry_id:139369)的正确秩，避免了数值失稳。

#### 应对剪切锁定

类似地，SRI 也被成功应用于解决 Reissner-Mindlin 板单元的剪切锁定问题。此时，[应变能](@entry_id:162699)被分为弯曲能 $U_b$ 和剪切能 $U_s$。SRI 的策略是：
1.  对引起锁定的**剪切能项** ($U_s$) 采用**[减缩积分](@entry_id:167949)**（例如，对 Q4 单元采用 $1 \times 1$ 单[点积](@entry_id:149019)分）。
2.  对**弯曲能项** ($U_b$) 采用**完全积分**（例如，对 Q4 单元采用 $2 \times 2$ 积分）。[@problem_id:2592738]

这样，通过在更少的点上施加零剪切约束，放松了对单元运动的限制，使其能够更自由地弯曲，从而缓解了剪切锁定。而完全积分的弯曲项则确保了单元能够正确地模拟弯曲刚度 [@problem_id:2592738]。

### 高级考量与局限性

尽管 SRI 是一种强大且广泛应用的工具，但其有效性并非无条件的，特别是在处理几何形状扭曲的网格时会遇到挑战。

关键问题在于，SRI 的成功在很大程度上依赖于单元几何的理想性。以[体积锁定](@entry_id:172606)为例，对于一个由[仿射映射](@entry_id:746332)生成的、几何规整的 Q4 单元，其[体积应变](@entry_id:267252)场在父坐标中是线性的。在这种情况下，单[点积](@entry_id:149019)分所施加的约束 $\epsilon_v(0,0)=0$ 恰好等价于物理上正确的平均体积应变为零的约束 $\int_{\Omega_e} \epsilon_v \, d\Omega = 0$。因此，SRI 能够完美地消除锁定 [@problem_id:2592752]。

然而，当单元几何发生扭曲（非[仿射映射](@entry_id:746332)）时，[雅可比行列式](@entry_id:137120) $\det J$ 不再是常数，[体积应变](@entry_id:267252) $\epsilon_v$ 在父坐标中也变成了复杂的非多项式函数。此时，单点约束 $\epsilon_v(0,0)=0$ 不再能准确代表真实的平均体积应变为零的约束。这种不匹配意味着，即使使用了 SRI，扭曲单元仍可能表现出一定程度的伪刚度，这种现象被称为**残余锁定** (residual locking)。在严重扭曲的网格中，这种效应会变得十分显著 [@problem_id:2592752]。

此外，对于均匀[减缩积分](@entry_id:167949)，虽然可以通过引入“[沙漏控制](@entry_id:163812)”或“稳定化”技术来抑制[伪零能模式](@entry_id:755267)，但这些稳定化项本身会给单元增加额外的人为刚度。在扭曲网格上，这种人为刚度可能会与体积或[剪切变形](@entry_id:170920)模式发生耦合，从而在一定程度上重新引入锁定，削弱了[减缩积分](@entry_id:167949)的优势 [@problem_id:2592752]。

综上所述，[减缩积分](@entry_id:167949)和[选择性减缩积分](@entry_id:168281)是[有限元法](@entry_id:749389)中应对[锁定现象](@entry_id:751421)的经典而有效的计算技巧。它们通过巧妙地降低[数值积分](@entry_id:136578)的阶次来放松过强的运动学约束，从而显著改善了低阶单元的性能。然而，使用者必须清醒地认识到这些技术，特别是[减缩积分](@entry_id:167949)，所带来的沙漏不稳定性风险，以及它们在处理严重扭曲网格时的局限性。在现代有限元实践中，诸如 $\bar{B}$ 法、增强应变法 (EAS) 和[混合格式](@entry_id:167436)等更为先进的单元技术，虽然理论上更复杂，但通常能提供更为稳健和精确的结果，尤其是在面对具有挑战性的网格和[材料非线性](@entry_id:162855)问题时。