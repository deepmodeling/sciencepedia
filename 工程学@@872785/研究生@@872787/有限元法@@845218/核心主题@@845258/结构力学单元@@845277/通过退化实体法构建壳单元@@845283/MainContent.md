## 引言
在计算结构力学领域，[壳单元](@entry_id:176094)因其在模拟薄壁结构（如车身、机翼、压力容器）时的高效性而占据着核心地位。然而，传统的壳理论往往基于复杂的[曲面](@entry_id:267450)[微分几何](@entry_id:145818)，其公式推导繁琐且在计算实现上存在诸多挑战。退化实体法（Degenerated Solid Approach, DSA）正是在这一背景下应运而生的一种强大而通用的替代方案。它巧妙地将壳体视为一个特殊的三维连续体，通过引入合理的运动学假设来“退化”其自由度，从而在保持三维框架简洁性的同时，高效地捕捉壳体的核心力学行为。

本文旨在系统性地揭示退化实体法的精髓，填补理论知识与实际应用之间的鸿沟。我们将不再局限于零散的概念，而是构建一个从基本原理到高级应用的完整知识体系。通过本文的学习，读者将深入理解[退化实体壳](@entry_id:748279)单元是如何被构建、如何解决其固有的数值难题，以及如何将其应用于复杂的跨学科工程问题中。

为实现这一目标，文章组织为以下三个核心章节：在“**原理与机制**”中，我们将奠定理论基石，详细剖析该方法的运动学定义、应变分析以及[剪切自锁](@entry_id:164115)等关键数值问题的成因与对策。接着，在“**应用与交叉学科联系**”中，我们将视野拓展至真实世界的复杂场景，展示该方法在处理[非线性](@entry_id:637147)材料、大变形、动力学及接触断裂等前沿问题中的强大能力。最后，通过“**动手实践**”部分，我们提供了一系列精心设计的思考练习，旨在引导读者将理论知识转化为解决实际问题的能力，巩固对核心概念的掌握。让我们一同踏上这段探索之旅，全面掌握这一现代有限元技术中的重要基石。

## 原理与机制

本章旨在深入探讨退化实体法（Degenerated Solid Approach, DSA）的基本原理与核心机制。我们将从其[运动学](@entry_id:173318)定义出发，系统阐述其自由度设定、[应力应变](@entry_id:204183)分析方法，并详细讨论在实际应用中至关重要的数值问题及其解决方案。本章内容假定读者已具备有限元法和连续介质力学的基本知识。

### 退化实体法的[运动学](@entry_id:173318)定义

退化实体法的核心思想是将壳体结构直接视为一个三维连续体，然后通过引入特定的[运动学](@entry_id:173318)假设来“退化”其行为，使其能够高效地模拟薄壁结构的力学特性。这种方法避免了传统壳理论中复杂的[曲面](@entry_id:267450)几何和繁琐的公式推导，使其在计算实现上更具通用性和便捷性。

该方法的基础是**[等参概念](@entry_id:136811)**（isoparametric concept）。一个[壳单元](@entry_id:176094)的几何形状和位移场都是通过从一个简单的父单元（parent element）——通常是一个三维的、边长为2的立方体——到物理空间的三维映射来描述的。这个父单元的局部坐标系用 $(\xi, \eta, \zeta)$ 表示，其中 $\xi, \eta \in [-1, 1]$ 是面[内坐标](@entry_id:169764)，而 $\zeta \in [-1, 1]$ 是厚度方向的坐标。

对于一个具有 $n$ 个节点的中面，壳体内任意一点的物理[坐标向量](@entry_id:153319) $\mathbf{x}$ 可以表示为 [@problem_id:2596011] [@problem_id:2596095]：

$$
\mathbf{x}(\xi, \eta, \zeta) = \mathbf{x}_0(\xi, \eta) + \zeta \mathbf{d}(\xi, \eta)
$$

这个方程是[退化实体壳](@entry_id:748279)[运动学](@entry_id:173318)的基石。我们来逐一解析其构成部分：

- **中面位置向量 $\mathbf{x}_0(\xi, \eta)$**：它定义了壳体中面（即 $\zeta=0$ 所在的[曲面](@entry_id:267450)）的几何形状。根据等参思想，它由节点坐标 $\mathbf{x}_i$ 和二维形函数 $N_i(\xi, \eta)$ 插值得到：
  $$
  \mathbf{x}_0(\xi, \eta) = \sum_{i=1}^{n} N_i(\xi, \eta) \mathbf{x}_i
  $$

- **导向矢量（Director）$\mathbf{d}(\xi, \eta)$**：这是一个定义在壳体中面上的矢量场，用于描述厚度方向“纤维”的方位和厚度。它由各节点的导向矢量 $\mathbf{d}_i$ 和形函数插值得到：
  $$
  \mathbf{d}(\xi, \eta) = \sum_{i=1}^{n} N_i(\xi, \eta) \mathbf{d}_i
  $$
  关键在于，节点导向矢量 $\mathbf{d}_i$ 的长度（模）被定义为该节点处厚度的一半，即 $|\mathbf{d}_i| = t_i/2$。因此，插值后的矢量 $\mathbf{d}(\xi, \eta)$ 同时描述了纤维方向和该点的厚度。在初始构型中，$\mathbf{d}_i$ 通常垂直于中面。

- **厚度坐标 $\zeta$**：这是一个无量纲的参数坐标，从壳体底面（$\zeta=-1$）线性变化到顶面（$\zeta=1$）。

这个运动学描述的核心假设是“**直线假设**”：即初始时垂直于中面的直线（纤维）在变形后仍然保持为直线。然而，与经典[Kirchhoff-Love壳](@entry_id:172528)理论不同，该直线**不一定**保持与变形后的中面垂直。导向矢量 $\mathbf{d}$ 的方向与变形后中面的法线方向之间的夹角，恰恰能够描述**[横向剪切变形](@entry_id:176673)**。因此，这种基于一阶线性厚度展开的退化实体单元，天然地属于**Reissner-Mindlin**型壳理论的范畴，能够考虑横向剪切效应，适用于中厚壳的分析。

与经典壳理论的主要区别在于 [@problem_id:2596011]：经典理论是建立在二维[曲面](@entry_id:267450)上的，其映射关系是从一个二维父单元 $(\xi, \eta)$ 到三维中面，厚度效应是在此二维理论基础上附加的。而退化实体法则自始至终都是一个三维提法，它从一个三维父单元 $(\xi, \eta, \zeta)$ 出发，通过[运动学](@entry_id:173318)约束（即 $\zeta$ 的线性依赖关系）将一个三维实体单元“退化”为[壳单元](@entry_id:176094)。这种三维框架使得其在处理复杂几何、[材料非线性](@entry_id:162855)和[大变形](@entry_id:167243)问题时更为直观和统一。

### 节点自由度与导向矢量表示

在有限元实现中，我们必须为每个节点定义一组独立的自由度（Degrees of Freedom, DOFs）。对于[退化实体壳](@entry_id:748279)单元，每个节点的自由度需要能够完整描述中面的平动和厚度纤维的转动。

一个显而易见的自由度设置是：每个节点包含3个[平动自由度](@entry_id:140257) $\mathbf{u}_I$（描述中面节点 $\mathbf{x}_I$ 的位移）和3个描述导向矢量 $\mathbf{d}_I$ 变化的自由度。然而，如何[参数化](@entry_id:272587)导向矢量的变化是一个关键问题。

若将导向矢量 $\mathbf{d}_I$ 的三个分量直接作为独立自由度，会带来一个问题：导向矢量的长度（即壳体厚度）会随着其分量的变化而改变，这可能不是我们期望的物理行为（除非要模拟厚度方向的拉伸）。更重要的是，我们需要一种能够处理大转动的、客观的更新方式。

一个更为健壮和通用的方法是引入[转动自由度](@entry_id:141502)。然而，经典的梁或[壳单元](@entry_id:176094)中使用的“转动”自由度，通常与一个关于节点法线的“[钻孔自由度](@entry_id:173586)”（drilling degree of freedom）相关联，该自由度在仅有单个导向矢量的运动学中没有物理刚度，会产生奇异性。

为了解决这个问题，现代的[退化实体壳](@entry_id:748279)单元通常采用如下策略 [@problem_id:2596083]：
每个节点拥有3个[平动自由度](@entry_id:140257) $\mathbf{u}_I$ 和一个3分量的**增量转动矢量** $\Delta \boldsymbol{\theta}_I$。导向矢量的更新不是通过直接相加，而是通过一个正交旋转矩阵 $\mathbf{R}(\Delta \boldsymbol{\theta}_I)$ 来实现。若 $\mathbf{D}_I$ 是参考构型中的导向矢量，则当前构型中的导向矢量 $\mathbf{d}_I$ 通过下式更新：
$$
\mathbf{d}_I = \mathbf{R}(\Delta \boldsymbol{\theta}_I) \mathbf{D}_I
$$
这种更新方式具有两个显著优点：
1.  **保持厚度**：由于[旋转矩阵](@entry_id:140302) $\mathbf{R}$ 是正交的，它保持了矢量的长度。因此，$||\mathbf{d}_I|| = ||\mathbf{D}_I||$。如果我们在初始时设定 $||\mathbf{D}_I|| = h_I/2$（其中 $h_I$ 是节点厚度），那么在整个变形过程中，壳体厚度将保持不变。这在大多数应用中是符合物理实际的。如果需要考虑厚度变化，可以引入一个额外的标量自由度来控制厚度。
2.  **避免[钻孔自由度](@entry_id:173586)**：虽然我们使用了3个参数来描述转动（例如，$\Delta \boldsymbol{\theta}_I$ 的三个分量），但关于导向矢量 $\mathbf{d}_I$ 自身的旋转（即钻孔转动）并不会改变 $\mathbf{d}_I$ 本身。也就是说，一个绕 $\mathbf{d}_I$ 轴的转动分量对单元的运动学没有贡献，因此它不会作为一个独立的、需要被约束的[广义坐标](@entry_id:156576)出现。这种[参数化](@entry_id:272587)方法自然地回避了[钻孔自由度](@entry_id:173586)问题，而无需引入任何人工[罚刚度](@entry_id:753321)。

因此，一个典型的[非线性](@entry_id:637147)[退化实体壳](@entry_id:748279)单元在每个节点上通常有6个自由度（3个平动和3个转动参数），但其物理意义和更新方式与传统[梁单元](@entry_id:746744)的自由度有所不同。

### 应变分析与三维本构关系

退化实体法最强大的特性之一是其应变和[应力分析](@entry_id:168804)完全基于三维[连续介质力学](@entry_id:155125)，这使得它可以自然地与任意复杂的三维本构模型（包括[弹塑性](@entry_id:193198)、粘弹性、各向异性等）相结合。

#### 应变张量的厚度方向展开

让我们从三维[小应变张量](@entry_id:754968)的定义出发：
$$
\boldsymbol{\varepsilon} = \frac{1}{2} \left( \nabla\mathbf{u} + (\nabla\mathbf{u})^{\mathsf{T}} \right)
$$
其中 $\mathbf{u}$ 是[位移场](@entry_id:141476)。根据退化实体法的[运动学](@entry_id:173318)假设，[位移场](@entry_id:141476) $\mathbf{u}$ 同样可以表示为中面位移 $\bar{\mathbf{u}}$ 和导向矢量转动 $\boldsymbol{\varphi}$ 的线性组合。在一个与中面相切的局部笛卡尔坐标系 $(x_1, x_2, x_3)$ 中，其中 $x_3 = \frac{t}{2}\zeta$，位移场可以写为 [@problem_id:2596031]：
$$
u_{\alpha}(x_1, x_2, \zeta) = \bar{u}_{\alpha}(x_1, x_2) + \frac{t}{2} \zeta \varphi_{\alpha}(x_1, x_2), \quad (\alpha=1, 2)
$$
$$
u_3(x_1, x_2, \zeta) = \bar{w}(x_1, x_2)
$$
这里，$\bar{u}_{\alpha}$ 和 $\bar{w}$ 是中面的面内和法向位移，而 $\varphi_{\alpha}$ 是导向矢量相对于法线的转角分量。

将该位移场代入应变定义，我们可以推导出应变张量沿厚度方向的[分布](@entry_id:182848)规律。经过推导，可以得到工程应变向量 $\mathbf{E} = [\varepsilon_{11}, \varepsilon_{22}, \gamma_{12}, \gamma_{13}, \gamma_{23}, \varepsilon_{33}]^{\mathsf{T}}$ 的表达式 [@problem_id:2596031]：
$$
\mathbf{E}(\zeta) = \begin{pmatrix}
\varepsilon_{11}^{m} + \frac{t}{2}\zeta \kappa_{11} \\
\varepsilon_{22}^{m} + \frac{t}{2}\zeta \kappa_{22} \\
\gamma_{12}^{m} + t\zeta \kappa_{12} \\
\gamma_{13}^{0} \\
\gamma_{23}^{0} \\
0
\end{pmatrix}
$$
其中：
- **膜应变** ($\varepsilon_{\alpha\beta}^{m}$, $\gamma_{12}^{m}$) 是由中面位移的梯度定义的，它们在厚度方向上是**常数**。
- **弯曲曲率** ($\kappa_{\alpha\beta}$) 是由导向矢量转角的梯度定义的。它们导致面内应变沿厚度方向**线性**变化，这正是弯曲效应的体现。
- **横向剪切应变** ($\gamma_{\alpha 3}^{0}$) 是由中面法向位移的梯度和导向矢量转角共同决定的。根据上述运动学假设，它们在厚度方向上也是**常数**。
- **厚度[法向应变](@entry_id:204633)** ($\varepsilon_{33}$) 在这种运动学假设下为**零**。

这个结果清晰地展示了[退化实体壳](@entry_id:748279)如何将复杂的三维应变状态分解为物理意义明确的膜、弯曲和剪切三种基本变形模式。

为了在有限元中计算这些应变，我们需要建立应变与节点自由度之间的关系，即[应变-位移矩阵](@entry_id:163451) $\mathbf{B}$。例如，对于一个平坦的矩形单元，其膜应变分量 $\varepsilon_{xx}$ 可以表示为 [@problem_id:2596019]：
$$
\varepsilon_{xx} = \frac{1}{a} \sum_{I=1}^{4} \frac{\partial N_I(\xi,\eta)}{\partial \xi} u_I + \frac{\zeta t}{2a} \sum_{I=1}^{4} \frac{\partial N_I(\xi,\eta)}{\partial \xi} \theta_{yI}
$$
这里，$a$ 是单元尺寸，$u_I$ 和 $\theta_{yI}$ 分别是节点的位移和[转动自由度](@entry_id:141502)。这个表达式清楚地分离了与 $u_I$ 相关的膜应变部分和与 $\theta_{yI}$ 相关的弯曲应变部分。$\mathbf{B}$ 矩阵的每一列就是应变对某个节点自由度的偏导数。

#### [平面应力条件](@entry_id:168184)的实施

尽管退化实体法基于三维框架，但薄壳结构的一个基本物理特性是**[平面应力](@entry_id:172193)**状态，即垂直于壳体表面的应力分量 $\sigma_{33}$ 应该为零。然而，我们之[前推](@entry_id:158718)导的运动学假设给出了 $\varepsilon_{33}=0$，这是一个**[平面应变](@entry_id:167046)**条件。如果直接将一个三维[本构关系](@entry_id:186508)（例如，[胡克定律](@entry_id:149682)）应用于这个应变状态，由于泊松效应，非零的面内应变 ($\varepsilon_{11}, \varepsilon_{22}$) 会诱导出非零的厚度法向应力 $\sigma_{33}$ [@problem_id:2596075]。

$$
\sigma_{33} = \frac{E\nu}{(1+\nu)(1-2\nu)} (\varepsilon_{11} + \varepsilon_{22}) \quad (\text{当 } \varepsilon_{33}=0)
$$

这个由运动学假设和三维本构律不匹配而产生的虚假应力必须被消除。标准做法是在计算应力时，在每个积分点（[高斯点](@entry_id:170251)）上强制执行[平面应力条件](@entry_id:168184) $S_{33}=0$（在[非线性](@entry_id:637147)分析中，$S_{ij}$ 是第二类[Piola-Kirchhoff应力](@entry_id:173629)）。

具体来说，在每个积分点，我们将面内和剪切应变分量（例如，对于[非线性](@entry_id:637147)分析中的[格林-拉格朗日应变](@entry_id:170427) $E_{ij}$，即 $E_{11}, E_{22}, E_{12}, E_{13}, E_{23}$）视为由单元运动学给定的已知量。然后，我们将厚度[法向应变](@entry_id:204633) $E_{33}$ 视为一个未知变量，求解以下标量非线性方程 [@problem_id:2595970]：
$$
r(E_{33}) = S_{33}(E_{11}, \dots, E_{23}, E_{33}) = 0
$$
这个方程通常使用**牛顿-拉夫逊迭代法**在局部（积分点层面）求解。对于第 $k$ 次迭代，更新量 $\Delta E_{33}$ 由下式给出：
$$
\Delta E_{33} = - \left( \frac{\partial S_{33}}{\partial E_{33}} \right)^{-1} S_{33}^{(k)} = - (C^{\text{mat}}_{3333})^{-1} S_{33}^{(k)}
$$
其中 $C^{\text{mat}}_{ijkl} = \partial S_{ij}/\partial E_{kl}$ 是在当前应变状态下计算的一致性材料[切线刚度](@entry_id:166213)张量。对于线性材料，这个过程一步即可收敛。

当迭代收敛，找到满足 $S_{33}=0$ 的 $E_{33}$ 后，一个更重要的步骤是计算**一致性凝聚[切线刚度](@entry_id:166213)**（consistent condensed tangent）。这是因为 $E_{33}$ 的变化依赖于其他应变分量的变化，这种依赖关系必须反映在单元的[切线刚度矩阵](@entry_id:170852)中，以保证全局牛顿迭代的二次收敛性。通过[静态凝聚](@entry_id:176722)（[舒尔补](@entry_id:142780)）方法，可以推导出凝聚后的[切线刚度](@entry_id:166213) $\tilde{C}_{pq}$ [@problem_id:2595970]：
$$
\tilde{C}_{pq} = C^{\text{mat}}_{pq} - C^{\text{mat}}_{p\,33}\left(C^{\text{mat}}_{3333}\right)^{-1} C^{\text{mat}}_{33\,q}
$$
其中，$p, q$ 代表所有未被消除的应变分量（如 $11, 22, 12, 13, 23$）。这个凝聚后的[刚度矩阵](@entry_id:178659)将用于组装单元的整体刚度矩阵。

### [数值积分](@entry_id:136578)与相关数值问题

[单元刚度矩阵](@entry_id:139369)等是通过在单元体积上对包含形函数导数的复杂表达式进行积分来计算的，这通常需要使用高斯数值积分。然而，对于[退化实体壳](@entry_id:748279)单元，数值积分方案的选择并非无足轻重，它直接关系到单元的性能，并可能引发一系列[数值病态](@entry_id:169044)问题。

#### [剪切自锁](@entry_id:164115)与[沙漏模式](@entry_id:174855)

**[剪切自锁](@entry_id:164115)（Shear Locking）** 是低阶单元（如四节点双线性单元）在模拟薄壳弯曲时出现的一种现象。在薄壳的[纯弯曲](@entry_id:202969)状态下，物理上的横向剪切应变应趋近于零。然而，低阶单元的[插值函数](@entry_id:262791)无法精确地表示这种零剪切应变状态。当使用完全积分（例如，对于四节点四边形，采用 $2 \times 2$ 的[高斯积分](@entry_id:187139)）时，积分点上的非零剪切应变会产生巨大的虚假剪切能，使得单元表现得异常刚硬，无法正确弯曲。这就是“自锁” [@problem_id:2596046]。

为了缓解[剪切自锁](@entry_id:164115)，一种简单而有效的方法是使用**[减缩积分](@entry_id:167949)**（reduced integration），即采用比完全积分阶数更低的高斯积分方案（例如，四节点四边形使用 $1 \times 1$ 积分）。通过在更少的点上施加约束，单元的[运动学](@entry_id:173318)“柔性”增加，能够更好地模拟零剪切状态，从而显著改善弯曲性能。

然而，[减缩积分](@entry_id:167949)的代价是可能引入**[沙漏模式](@entry_id:174855)**（Hourglass Modes）或**[零能模式](@entry_id:172472)**（zero-energy modes）。这些是单元的非刚体变形模式，但在[减缩积分](@entry_id:167949)点上产生的应变为零，因此不产生任何应变能。例如，对于一个采用单[点积](@entry_id:149019)分的四节点[四边形单元](@entry_id:176937)，存在一种棋盘状的节点位移模式，其形函数导数恰好在单元中心点 $(\xi=0, \eta=0)$ 为零 [@problem_id:2596026] [@problem_id:2596017]。例如，如下的节点位移模式：
$$
\mathbf{d}_{h1} = \begin{pmatrix} 1  0  -1  0  1  0  -1  0 \end{pmatrix}^{\mathsf{T}}
$$
对应的位移场为 $u(\xi, \eta) \propto \xi \eta$，其在[中心点](@entry_id:636820)的应变为零。由于这些模式没有刚度，它们会在计算中失控，导致网格出现毫无物理意义的[振荡](@entry_id:267781)，破坏解的稳定性。

#### 自锁的缓解策略：[选择性减缩积分](@entry_id:168281)与[假定自然应变](@entry_id:746536)

为了在缓解自锁和抑制[沙漏模式](@entry_id:174855)之间取得平衡，发展出了更为精巧的技术。

1.  **[选择性减缩积分](@entry_id:168281)（Selective Reduced Integration, SRI）**：这种策略的思想是，自锁主要与剪切能有关，而膜和[弯曲能](@entry_id:174691)的计算需要足够的积分精度来避免[秩亏](@entry_id:754065)。因此，可以对刚度矩阵的不同部分采用不同的积分方案：对引起自锁的横向剪切项采用[减缩积分](@entry_id:167949)，而对膜和弯曲项采用完全积分 [@problem_id:2596046]。这样既能有效缓解[剪切自锁](@entry_id:164115)，又能保持对膜和弯曲模式的足够约束，减少[沙漏模式](@entry_id:174855)的风险。对于由[减缩积分](@entry_id:167949)仍可能引发的剪切[沙漏模式](@entry_id:174855)，则需要辅以**[沙漏控制](@entry_id:163812)**（hourglass control）技术，即添加一个微小的、物理上合理的惩[罚刚度](@entry_id:753321)来抑制这些[零能模式](@entry_id:172472)。

2.  **[假定自然应变](@entry_id:746536)（Assumed Natural Strain, ANS）**：这是一种更为系统和高级的方法。其核心思想是，不直接使用由[位移场](@entry_id:141476)插值得到的“原始”应变场，而是构造一个阶次更低、行为更优的“假定”应变场。对于缓解[剪切自锁](@entry_id:164115)，ANS方法的步骤如下 [@problem_id:2595977]：
    a. 在单元的特定采样点（tying points），例如边的中点，计算由位移插值得到的剪切应变。
    b. 基于这些采样点的应变值，构造一个新的、低阶的[插值函数](@entry_id:262791)来定义整个单元内的剪切应变场。例如，$\gamma_{13}^*(\xi, \eta)$ 可以是只依赖于 $\xi$ 的线性函数。
    c. 在计算[单元刚度矩阵](@entry_id:139369)时，用这个假定的、更“平滑”的剪切应变场 $\boldsymbol{\gamma}^*$ 来替代原始的剪切应变场。

例如，对于一个四[节点单元](@entry_id:752523)，我们可以分别在 $\xi=\pm 1$ 的边中点采样 $\gamma_{13}$，在 $\eta=\pm 1$ 的边中点采样 $\gamma_{23}$，然后用线性插值构造假定剪切应变场 $\gamma_{13}^*(\xi)$ 和 $\gamma_{23}^*(\eta)$ [@problem_id:2595977]。这种构造的一个重要优点是它能够精确地表示常数应变状态，因此能够通过**[分片检验](@entry_id:162864)**（patch test），这是保证单元收敛性的一个基本要求。ANS方法通过在应变层面进行修正，从根本上改善了单元的性能，被认为是缓解自锁问题的最有效途径之一。