{"hands_on_practices": [{"introduction": "为了掌握雅可比行列式在有限元分析中的核心作用，我们从最基本的一维线性单元开始。这个练习旨在揭示雅可比行列式 $J$ 的物理意义，即作为从参考坐标到物理坐标的局部拉伸或压缩比例因子。通过推导一个恒定的雅可比行列式并将其与单元长度联系起来 [@problem_id:2571710]，您将为理解更高维度和更复杂单元中映射质量评估奠定坚实的基础。", "problem": "考虑一个标准的一维等参有限元，它通过插值 $x(\\xi) = N_{1}(\\xi)\\,X_{1} + N_{2}(\\xi)\\,X_{2}$ 将参考坐标 $\\xi \\in [-1,1]$ 映射到物理坐标 $x$，其中 $X_{1}$ 和 $X_{2}$ 是两个物理节点的坐标。形函数 $N_{1}(\\xi)$ 和 $N_{2}(\\xi)$ 是在 $[-1,1]$ 上分别与节点 $\\xi=-1$ 和 $\\xi=1$ 相关联的一阶 Lagrange 多项式，因此满足插值条件 $N_{1}(-1)=1$、$N_{1}(1)=0$、$N_{2}(-1)=0$ 和 $N_{2}(1)=1$。你可以仅假定形函数的线性以及这些节点插值条件作为出发点。\n\n使用一维映射的雅可比行列式定义 $J(\\xi) = \\dfrac{dx}{d\\xi}$，以 $X_{1}$ 和 $X_{2}$ 的形式符号化地推导 $J(\\xi)$。然后，从第一性原理证明 $J(\\xi)$ 是否为关于 $\\xi$ 的常数，并将其值与有向单元长度 $L = X_{2} - X_{1}$ 和绝对单元长度 $\\ell = |X_{2}-X_{1}|$ 联系起来。简要解释 $J$ 的符号和大小对映射质量和单元方向意味着什么。\n\n以 $X_{1}$ 和 $X_{2}$ 的单个闭式表达式的形式提供 $J(\\xi)$ 的最终答案。本问题不要求数值舍入，也不涉及物理单位。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n-   从参考坐标 $\\xi$ 到物理坐标 $x$ 的映射由等参插值给出：$x(\\xi) = N_{1}(\\xi)\\,X_{1} + N_{2}(\\xi)\\,X_{2}$。\n-   参考坐标域为 $\\xi \\in [-1,1]$。\n-   物理节点坐标为 $X_{1}$ 和 $X_{2}$。\n-   形函数 $N_{1}(\\xi)$ 和 $N_{2}(\\xi)$ 是一阶 Lagrange 多项式。\n-   假定形函数是线性的。\n-   节点插值条件为：$N_{1}(-1)=1$，$N_{1}(1)=0$，$N_{2}(-1)=0$ 和 $N_{2}(1)=1$。\n-   一维雅可比行列式定义为 $J(\\xi) = \\frac{dx}{d\\xi}$。\n-   有向单元长度定义为 $L = X_{2} - X_{1}$。\n-   绝对单元长度定义为 $\\ell = |X_{2}-X_{1}|$。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据**：该问题牢固地建立在有限元法 (FEM) 的理论基础之上。等参映射、线性 Lagrange 形函数和雅可比行列式的定义是连续介质力学和数值分析中的标准基本概念。\n-   **适定性**：该问题是适定的。线性的假设和指定的节点条件足以唯一确定形函数，这反过来又允许唯一确定雅可比行列式。\n-   **客观性**：该问题使用精确、客观且无歧义的数学语言陈述。\n-   **完备性与一致性**：所提供的信息对于推导是充分且必要的。不存在矛盾。线性假设与一阶 Lagrange 多项式的性质是一致的。\n\n**步骤 3：结论与行动**\n该问题在科学上是合理的、适定的且自洽的。它是在有限元法中具有根本重要性的有效问题。将提供解答。\n\n**解答的推导**\n任务是为指定的一维线性单元推导雅可比行列式 $J(\\xi)$。该过程从第一性原理出发，显式推导形函数 $N_{1}(\\xi)$ 和 $N_{2}(\\xi)$ 开始。\n\n鉴于形函数是线性的，它们可以表示为一般形式 $N(\\xi) = a\\xi + b$，其中 $a$ 和 $b$ 是常数。\n\n对于第一个形函数 $N_{1}(\\xi)$，我们应用给定的节点条件：\n1.  $N_{1}(-1) = a_{1}(-1) + b_{1} = 1$\n2.  $N_{1}(1) = a_{1}(1) + b_{1} = 0$\n\n这构成了一个关于系数 $a_{1}$ 和 $b_{1}$ 的二元线性方程组：\n$$\n\\begin{cases}\n-a_{1} + b_{1} = 1 \\\\\na_{1} + b_{1} = 0\n\\end{cases}\n$$\n两方程相加得到 $2b_{1} = 1$，由此我们求得 $b_{1} = \\frac{1}{2}$。将此值代入第二个方程得到 $a_{1} + \\frac{1}{2} = 0$，结果为 $a_{1} = -\\frac{1}{2}$。\n因此，第一个形函数是：\n$$\nN_{1}(\\xi) = -\\frac{1}{2}\\xi + \\frac{1}{2} = \\frac{1}{2}(1 - \\xi)\n$$\n\n对于第二个形函数 $N_{2}(\\xi)$，我们应用其对应的节点条件：\n1.  $N_{2}(-1) = a_{2}(-1) + b_{2} = 0$\n2.  $N_{2}(1) = a_{2}(1) + b_{2} = 1$\n\n这给出了方程组：\n$$\n\\begin{cases}\n-a_{2} + b_{2} = 0 \\\\\na_{2} + b_{2} = 1\n\\end{cases}\n$$\n这些方程相加得到 $2b_{2} = 1$，因此 $b_{2} = \\frac{1}{2}$。将其代入第二个方程得到 $a_{2} + \\frac{1}{2} = 1$，由此我们求得 $a_{2} = \\frac{1}{2}$。\n因此，第二个形函数是：\n$$\nN_{2}(\\xi) = \\frac{1}{2}\\xi + \\frac{1}{2} = \\frac{1}{2}(1 + \\xi)\n$$\n\n现在，我们计算雅可比行列式 $J(\\xi) = \\frac{dx}{d\\xi}$。映射由 $x(\\xi) = N_{1}(\\xi)X_{1} + N_{2}(\\xi)X_{2}$ 给出。由于 $X_{1}$ 和 $X_{2}$ 是常数节点坐标，微分仅对 $\\xi$ 进行：\n$$\nJ(\\xi) = \\frac{d}{d\\xi}\\left(N_{1}(\\xi)X_{1} + N_{2}(\\xi)X_{2}\\right) = \\frac{dN_{1}}{d\\xi}X_{1} + \\frac{dN_{2}}{d\\xi}X_{2}\n$$\n我们计算形函数的导数：\n$$\n\\frac{dN_{1}}{d\\xi} = \\frac{d}{d\\xi}\\left(\\frac{1}{2}(1 - \\xi)\\right) = -\\frac{1}{2}\n$$\n$$\n\\frac{dN_{2}}{d\\xi} = \\frac{d}{d\\xi}\\left(\\frac{1}{2}(1 + \\xi)\\right) = \\frac{1}{2}\n$$\n将这些常数导数代入 $J(\\xi)$ 的表达式中：\n$$\nJ(\\xi) = \\left(-\\frac{1}{2}\\right)X_{1} + \\left(\\frac{1}{2}\\right)X_{2} = \\frac{1}{2}(X_{2} - X_{1})\n$$\n\n**雅可比行列式分析**\n从推导出的表达式中，我们可以得出几个观察结论。\n\n首先，雅可比行列式 $J(\\xi)$ 与参考坐标 $\\xi$ 无关。它对于整个单元是一个常数。这是用于等参映射的形函数线性的直接结果。\n\n其次，我们将 $J$ 与有向单元长度 $L = X_{2} - X_{1}$ 和绝对单元长度 $\\ell = |X_{2} - X_{1}|$ 联系起来。从我们的结果可以立即看出：\n$$\nJ = \\frac{L}{2}\n$$\n雅可比行列式是单元有向长度的一半。\n因此，雅可比行列式的绝对值为：\n$$\n|J| = \\left|\\frac{L}{2}\\right| = \\frac{|L|}{2} = \\frac{|X_{2} - X_{1}|}{2} = \\frac{\\ell}{2}\n$$\n\n第三，雅可比行列式的符号和大小携带了关于映射质量的关键信息。\n-   **$J$ 的符号**：符号决定了映射的方向。\n    -   如果 $J > 0$，则 $X_{2} > X_{1}$。映射保持方向；当 $\\xi$ 从 $-1$ 增加到 $1$ 时，物理坐标 $x$ 从 $X_{1}$ 增加到 $X_{2}$。这表示一个有效的、非反转的单元。\n    -   如果 $J < 0$，则 $X_{2} < X_{1}$。映射反转方向；当 $\\xi$ 增加时，$x$ 减小。节点的编号顺序与物理坐标系的方向相反。这是一个反转单元。虽然在数学上是可能的，但这会在数值计算中引起严重问题，尤其是在全局矩阵的组装中。\n    -   如果 $J = 0$，则 $X_{2} = X_{1}$。两个节点重合，意味着单元长度为零。映射将整个参考域 $[-1, 1]$ 塌陷到一个点。这是一个退化映射，是奇异且不可逆的。对于任何有限元分析，$J=0$ 的单元都是无效的。\n\n-   **$J$ 的大小**：大小 $|J| = \\frac{\\ell}{2}$ 是一个微分缩放因子，它关联了参考域中的长度与物理域中的长度。关系为 $dx = J d\\xi$。参考单元的总长度为 $1 - (-1) = 2$。物理单元的总长度为 $\\ell$。这些长度的比值为 $\\frac{\\ell}{2}$，这恰好是 $|J|$。这个常数缩放因子在数值积分中用于将物理单元域上的积分转换为参考单元域上的积分：$\\int_{X_{1}}^{X_{2}} f(x) dx = \\int_{-1}^{1} f(x(\\xi)) J d\\xi$。", "answer": "$$\n\\boxed{\\frac{1}{2}\\left(X_{2} - X_{1}\\right)}\n$$", "id": "2571710"}, {"introduction": "在掌握了一维基础之后，我们将把注意力转向更具实践意义的二维双线性四边形单元。此练习将引导您从基本形函数出发，推导完整的雅可比矩阵 $J(\\xi,\\eta)$ 及其行列式。这个过程不仅能加深您对雅可比行列式如何随单元内部位置变化的理解 [@problem_id:2571760]，还能揭示对于双线性单元，其行列式始终是仿射线性函数这一重要结构特性。", "problem": "考虑一个定义在参考正方形 $[-1,1] \\times [-1,1]$ 上的二维等参双线性四边形单元，其局部坐标为 $(\\xi,\\eta)$，物理坐标为 $(x,y)$。四个角节点位于\n$$(x_1,y_1) = (0,0), \\quad (x_2,y_2) = (3,0.5), \\quad (x_3,y_3) = (2.5,2.0), \\quad (x_4,y_4) = (-0.2,1.5).$$\n设标准的双线性形函数为\n$$N_1(\\xi,\\eta) = \\frac{(1-\\xi)(1-\\eta)}{4}, \\quad N_2(\\xi,\\eta) = \\frac{(1+\\xi)(1-\\eta)}{4}, \\quad N_3(\\xi,\\eta) = \\frac{(1+\\xi)(1+\\eta)}{4}, \\quad N_4(\\xi,\\eta) = \\frac{(1-\\xi)(1+\\eta)}{4}.$$\n等参映射定义为\n$$x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,x_i, \\qquad y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,y_i.$$\n从这些定义出发，不使用任何预先组合好的雅可比表达式，完成以下任务：\n\n1) 推导映射的雅可比矩阵 $J(\\xi,\\eta)$，其中 $J(\\xi,\\eta)$ 的元素为 $\\partial x/\\partial \\xi$、$\\partial x/\\partial \\eta$、$\\partial y/\\partial \\xi$ 和 $\\partial y/\\partial \\eta$。然后以闭式形式计算 $\\det J(\\xi,\\eta)$。\n\n2) 仅使用标准双线性形函数的结构特性和等参定义，确定对于任意双线性四边形映射，$\\det J(\\xi,\\eta)$ 关于 $(\\xi, \\eta)$ 的一般多项式次数。找出使 $\\det J(\\xi,\\eta)$ 在整个单元上为常数的节点坐标所需满足的充分必要条件。解释对于双线性四边形映射，是否会出现真正的二次相关性（即，涉及 $\\xi$ 和 $\\eta$ 的乘积）。\n\n3) 对于上面给定的节点坐标，将第1)部分的结果简化为 $\\det J(\\xi,\\eta)$ 的显式解析表达式。\n\n将给定单元的 $\\det J(\\xi,\\eta)$ 的精确解析表达式作为最终答案。无需四舍五入，在此背景下 $\\det J$ 没有单位。", "solution": "我们从等参定义和标准双线性形函数开始。根据定义，\n$$x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,x_i, \\qquad y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,y_i.$$\n雅可比矩阵为\n$$J(\\xi,\\eta) = \\begin{pmatrix}\n\\displaystyle \\frac{\\partial x}{\\partial \\xi} & \\displaystyle \\frac{\\partial x}{\\partial \\eta} \\\\\n\\displaystyle \\frac{\\partial y}{\\partial \\xi} & \\displaystyle \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}, \\qquad \\det J = \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial x}{\\partial \\eta}\\frac{\\partial y}{\\partial \\xi}.$$\n\n基础：对于四节点双线性形函数，\n$$N_1(\\xi,\\eta) = \\frac{(1-\\xi)(1-\\eta)}{4}, \\quad N_2(\\xi,\\eta) = \\frac{(1+\\xi)(1-\\eta)}{4}, \\quad N_3(\\xi,\\eta) = \\frac{(1+\\xi)(1+\\eta)}{4}, \\quad N_4(\\xi,\\eta) = \\frac{(1-\\xi)(1+\\eta)}{4},$$\n我们计算它们的偏导数。使用乘法法则和常数，\n$$\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1-\\eta}{4}, \\quad \\frac{\\partial N_2}{\\partial \\xi} = \\frac{1-\\eta}{4}, \\quad \\frac{\\partial N_3}{\\partial \\xi} = \\frac{1+\\eta}{4}, \\quad \\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1+\\eta}{4},$$\n$$\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1-\\xi}{4}, \\quad \\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1+\\xi}{4}, \\quad \\frac{\\partial N_3}{\\partial \\eta} = \\frac{1+\\xi}{4}, \\quad \\frac{\\partial N_4}{\\partial \\eta} = \\frac{1-\\xi}{4}.$$\n\n因此，\n$$\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi}\\,x_i, \\qquad \\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta}\\,x_i,$$\n$$\\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi}\\,y_i, \\qquad \\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta}\\,y_i.$$\n\n将双线性映射重写为以下分组形式会很方便：\n$$x(\\xi,\\eta) = \\frac{1}{4}\\Big[(x_1+x_2+x_3+x_4) + \\xi(-x_1+x_2+x_3-x_4) + \\eta(-x_1-x_2+x_3+x_4) + \\xi\\eta(x_1-x_2+x_3-x_4)\\Big],$$\n$$y(\\xi,\\eta) = \\frac{1}{4}\\Big[(y_1+y_2+y_3+y_4) + \\xi(-y_1+y_2+y_3-y_4) + \\eta(-y_1-y_2+y_3+y_4) + \\xi\\eta(y_1-y_2+y_3-y_4)\\Big],$$\n这可以通过展开 $N_i(\\xi,\\eta)$ 的定义并对 $\\xi$ 和 $\\eta$ 的幂次进行分组直接得出。求导可得\n$$\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4}\\Big[(-x_1+x_2+x_3-x_4) + \\eta(x_1-x_2+x_3-x_4)\\Big],$$\n$$\\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4}\\Big[(-x_1-x_2+x_3+x_4) + \\xi(x_1-x_2+x_3-x_4)\\Big],$$\n$$\\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4}\\Big[(-y_1+y_2+y_3-y_4) + \\eta(y_1-y_2+y_3-y_4)\\Big],$$\n$$\\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4}\\Big[(-y_1-y_2+y_3+y_4) + \\xi(y_1-y_2+y_3-y_4)\\Big].$$\n\n引入简写\n$$A_x = -x_1+x_2+x_3-x_4, \\quad B_x = -x_1-x_2+x_3+x_4, \\quad C_x = x_1-x_2+x_3-x_4,$$\n$$A_y = -y_1+y_2+y_3-y_4, \\quad B_y = -y_1-y_2+y_3+y_4, \\quad C_y = y_1-y_2+y_3-y_4.$$\n于是\n$$\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4}\\big(A_x + C_x \\eta\\big), \\quad \\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4}\\big(B_x + C_x \\xi\\big), \\quad \\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4}\\big(A_y + C_y \\eta\\big), \\quad \\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4}\\big(B_y + C_y \\xi\\big).$$\n\n因此，\n$$\\det J(\\xi,\\eta) = \\frac{1}{16}\\Big[(A_x + C_x \\eta)(B_y + C_y \\xi) - (B_x + C_x \\xi)(A_y + C_y \\eta)\\Big].$$\n展开，\n\\begin{align*}\n\\det J(\\xi,\\eta) = \\frac{1}{16}\\Big[A_x B_y + A_x C_y \\xi + C_x B_y \\eta + C_x C_y \\xi\\eta \\\\\n\\qquad - B_x A_y - B_x C_y \\eta - C_x \\xi A_y - C_x C_y \\xi\\eta \\Big].\n\\end{align*}\n混合项 $\\xi\\eta$ 完全抵消，剩下\n$$\\det J(\\xi,\\eta) = \\frac{1}{16}\\Big[(A_x B_y - B_x A_y) + (A_x C_y - C_x A_y)\\,\\xi + (C_x B_y - B_x C_y)\\,\\eta\\Big].$$\n\n这确立了第2)部分要求的一般结构性结果：对于任何双线性四边形映射，$\\det J(\\xi,\\eta)$ 是 $(\\xi,\\eta)$ 的一个仿射线性函数，即其形式为 $a_0 + a_1 \\xi + a_2 \\eta$，不含 $\\xi\\eta$ 项，也不含 $\\xi^2$ 或 $\\eta^2$ 项。对于双线性映射，不可能出现真正的二次相关性（涉及 $\\xi\\eta$），因为如展开式所示，$\\xi\\eta$ 的系数正好抵消了。\n\n此外，行列式在整个单元上为常数的充分必要条件是 $\\xi$ 和 $\\eta$ 的系数为零：\n$$A_x C_y - C_x A_y = 0 \\quad \\text{and} \\quad C_x B_y - B_x C_y = 0.$$\n以向量形式，通过元组 $(A_x,A_y)$、$(B_x,B_y)$ 定义单元中心沿 $\\xi$ 和 $\\eta$ 方向的边向量，通过 $(C_x,C_y)$ 定义双线性畸变。上述条件等价于 $(A_x,A_y)$ 和 $(B_x,B_y)$ 分别独立于 $\\eta$ 和 $\\xi$，且 $(C_x,C_y)$ 与两者都平行，这最终意味着映射是仿射的（物理图像是平行四边形）。从实际几何角度来说，$\\det J$ 为常数的充分必要条件是物理单元为平行四边形，即对边平行且向量差相等。\n\n现在我们针对第1)和第3)部分，特化到给定的节点坐标。计算\n$$(x_1,x_2,x_3,x_4) = (0,3,2.5,-0.2), \\qquad (y_1,y_2,y_3,y_4) = (0,0.5,2.0,1.5).$$\n于是\n\\begin{align*}\nA_x = -x_1+x_2+x_3-x_4 = -0+3+2.5-(-0.2) = 5.7 = \\frac{57}{10}, \\\\\nB_x = -x_1-x_2+x_3+x_4 = -0-3+2.5+(-0.2) = -0.7 = -\\frac{7}{10}, \\\\\nC_x = x_1-x_2+x_3-x_4 = 0-3+2.5-(-0.2) = -0.3 = -\\frac{3}{10},\n\\end{align*}\n及\n\\begin{align*}\nA_y = -y_1+y_2+y_3-y_4 = -0+0.5+2.0-1.5 = 1.0 = \\frac{1}{1}, \\\\\nB_y = -y_1-y_2+y_3+y_4 = -0-0.5+2.0+1.5 = 3.0 = 3, \\\\\nC_y = y_1-y_2+y_3-y_4 = 0-0.5+2.0-1.5 = 0.\n\\end{align*}\n代入一般仿射形式：\n\\begin{align*}\nA_x B_y - B_x A_y = \\frac{57}{10}\\cdot 3 - \\left(-\\frac{7}{10}\\right)\\cdot 1 = \\frac{171}{10} + \\frac{7}{10} = \\frac{178}{10}, \\\\\nA_x C_y - C_x A_y = \\frac{57}{10}\\cdot 0 - \\left(-\\frac{3}{10}\\right)\\cdot 1 = \\frac{3}{10}, \\\\\nC_x B_y - B_x C_y = \\left(-\\frac{3}{10}\\right)\\cdot 3 - \\left(-\\frac{7}{10}\\right)\\cdot 0 = -\\frac{9}{10}.\n\\end{align*}\n因此，\n\\begin{align*}\n\\det J(\\xi,\\eta) = \\frac{1}{16}\\left[\\frac{178}{10} + \\frac{3}{10}\\,\\xi - \\frac{9}{10}\\,\\eta\\right] \\\\\n= \\frac{1}{160}\\left[178 + 3\\,\\xi - 9\\,\\eta\\right].\n\\end{align*}\n这就是所要求的闭式表达式。\n\n出于对映射质量的考虑，要求对于所有 $(\\xi,\\eta) \\in [-1,1]^2$，都有 $\\det J(\\xi,\\eta) > 0$。由于 $\\det J$ 是 $(\\xi,\\eta)$ 的仿射函数，其在正方形上的最小值在某个角点处取得。在四个角点 $(\\xi,\\eta) \\in \\{(-1,-1),(-1,1),(1,-1),(1,1)\\}$ 处计算方括号中的表达式 $178 + 3\\xi - 9\\eta$，分别得到值 $184,166,190,172$，所以最小值为 $166$，意味着 $\\min \\det J = \\frac{166}{160} > 0$。因此，该映射是保向的，对于此单元而言质量是可接受的。此外，正如所证明的，对于双线性四边形，不可能出现 $\\xi\\eta$ 的真正二次（混合）相关性；只有常数或仿射变化是可能的，其中常数情况对应于仿射映射（平行四边形图像）。", "answer": "$$\\boxed{\\frac{178+3\\,\\xi-9\\,\\eta}{160}}$$", "id": "2571760"}, {"introduction": "单元质量评估是有限元分析中的一个关键环节，但常用的几何指标有时会产生误导。本练习通过构建一个具有完美长宽比（$r=1$）但雅可比行列式为负的“蝴蝶结”形单元，来挑战您对单元质量的直观理解。通过亲自计算并发现一个几何上看似“良好”的单元实际上是无效的 [@problem_id:2412959]，您将深刻认识到为何基于映射的雅可比行列式是判断单元有效性的黄金标准。", "problem": "在计算工程中，通常通过将纵横比等几何形状度量与等参数变换的雅可比行列式等基于映射的度量相结合来评估网格质量。考虑一个二维（$2$D）双线性等参数四边形单元，它将参数坐标为 $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$ 的参考正方形映射到物理平面中的一个直边四边形。使用以下构造来说明完美的纵横比并不保证映射有效。\n\n定义物理节点坐标（按参考节点逆时针顺序）如下：\n$$\n(x_1,y_1)=(0,a),\\quad (x_2,y_2)=(a,0),\\quad (x_3,y_3)=(0,-a),\\quad (x_4,y_4)=(-a,0),\n$$\n其中 $a>0$。为进行网格质量评估，采用基于边长的纵横比\n$$\nr=\\frac{\\max\\{\\ell_1,\\ell_2,\\ell_3,\\ell_4\\}}{\\min\\{\\ell_1,\\ell_2,\\ell_3,\\ell_4\\}},\n$$\n其中 $\\ell_i$ 是由连续节点 $i$ 和 $i+1$（节点 $5$ 与节点 $1$ 等同）构成的第 $i$ 条物理边的欧几里得长度。\n\n从一个4节点四边形的标准双线性等参数映射和该映射的雅可比矩阵 $J(\\xi,\\eta)$ 的定义出发，完成以下任务：\n- 证明所构造的单元满足 $r=1$。\n- 计算单元中心 $(\\xi,\\eta)=(0,0)$ 处的雅可比行列式，并用 $a$ 精确表示。\n\n请以单个闭式表达式的形式提供单元中心处雅可比行列式的最终答案（用 $a$ 表示）。不包含单位。无需四舍五入。", "solution": "本题要求分析一个特定的二维双线性等参数四边形单元，以证明完美的纵横比并不排除无效映射的可能性。这将通过首先计算该单元基于边长的纵横比 $r$，然后计算该映射在单元中心的雅可比行列式来完成。\n\n首先，我们证明纵横比 $r=1$。四个节点的物理坐标按参考节点逆时针顺序给出：$(x_1, y_1) = (0, a)$，$(x_2, y_2) = (a, 0)$，$(x_3, y_3) = (0, -a)$，以及 $(x_4, y_4) = (-a, 0)$，其中常数 $a > 0$。纵横比定义为最大边长与最小边长之比，即 $r = \\frac{\\max\\{\\ell_i\\}}{\\min\\{\\ell_i\\}}$。我们使用欧几里得距离公式 $\\ell = \\sqrt{\\Delta x^2 + \\Delta y^2}$ 来计算四条边中每条边的长度 $\\ell_i$。\n\n第一条边 $\\ell_1$（节点1和节点2之间）的长度为：\n$$\n\\ell_1 = \\sqrt{(x_2 - x_1)^2 + (y_2 - y_1)^2} = \\sqrt{(a - 0)^2 + (0 - a)^2} = \\sqrt{a^2 + (-a)^2} = \\sqrt{2a^2} = a\\sqrt{2}\n$$\n\n第二条边 $\\ell_2$（节点2和节点3之间）的长度为：\n$$\n\\ell_2 = \\sqrt{(x_3 - x_2)^2 + (y_3 - y_2)^2} = \\sqrt{(0 - a)^2 + (-a - 0)^2} = \\sqrt{(-a)^2 + (-a)^2} = \\sqrt{2a^2} = a\\sqrt{2}\n$$\n\n第三条边 $\\ell_3$（节点3和节点4之间）的长度为：\n$$\n\\ell_3 = \\sqrt{(x_4 - x_3)^2 + (y_4 - y_3)^2} = \\sqrt{(-a - 0)^2 + (0 - (-a))^2} = \\sqrt{(-a)^2 + a^2} = \\sqrt{2a^2} = a\\sqrt{2}\n$$\n\n第四条边 $\\ell_4$（节点4和节点1之间）的长度为：\n$$\n\\ell_4 = \\sqrt{(x_1 - x_4)^2 + (y_1 - y_4)^2} = \\sqrt{(0 - (-a))^2 + (a - 0)^2} = \\sqrt{a^2 + a^2} = \\sqrt{2a^2} = a\\sqrt{2}\n$$\n\n由于所有边长都相等，$\\ell_1 = \\ell_2 = \\ell_3 = \\ell_4 = a\\sqrt{2}$，所以最大长度和最小长度相同。因此，纵横比为：\n$$\nr = \\frac{\\max\\{\\ell_i\\}}{\\min\\{\\ell_i\\}} = \\frac{a\\sqrt{2}}{a\\sqrt{2}} = 1\n$$\n这表明该单元具有完美的纵横比 $1$。\n\n接下来，我们计算雅可比行列式。从参考坐标 $(\\xi, \\eta)$ 到物理坐标 $(x, y)$ 的等参数映射定义为：\n$$\nx(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i \\quad \\text{和} \\quad y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i\n$$\n对于参考正方形 $[-1,1] \\times [-1,1]$，标准的双线性形函数 $N_i(\\xi, \\eta)$ 与从 $(\\xi, \\eta) = (-1,-1)$ 开始按逆时针顺序排列的节点相关联：\n$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\n代入给定的物理节点坐标：\n$x(\\xi, \\eta) = N_1(0) + N_2(a) + N_3(0) + N_4(-a) = a N_2 - a N_4$\n$y(\\xi, \\eta) = N_1(a) + N_2(0) + N_3(-a) + N_4(0) = a N_1 - a N_3$\n\n代入形函数的表达式：\n$$\nx(\\xi, \\eta) = a \\left( \\frac{1}{4}(1+\\xi)(1-\\eta) \\right) - a \\left( \\frac{1}{4}(1-\\xi)(1+\\eta) \\right) = \\frac{a}{4} ((1-\\eta+\\xi-\\xi\\eta) - (1+\\eta-\\xi-\\xi\\eta)) = \\frac{a}{4}(2\\xi - 2\\eta) = \\frac{a}{2}(\\xi - \\eta)\n$$\n$$\ny(\\xi, \\eta) = a \\left( \\frac{1}{4}(1-\\xi)(1-\\eta) \\right) - a \\left( \\frac{1}{4}(1+\\xi)(1+\\eta) \\right) = \\frac{a}{4} ((1-\\eta-\\xi+\\xi\\eta) - (1+\\eta+\\xi+\\xi\\eta)) = \\frac{a}{4}(-2\\eta - 2\\xi) = -\\frac{a}{2}(\\xi + \\eta)\n$$\n变换的雅可比矩阵为 $J(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}$。我们计算其偏导数：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}\\left(\\frac{a}{2}(\\xi - \\eta)\\right) = \\frac{a}{2}\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}\\left(\\frac{a}{2}(\\xi - \\eta)\\right) = -\\frac{a}{2}\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}\\left(-\\frac{a}{2}(\\xi + \\eta)\\right) = -\\frac{a}{2}\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}\\left(-\\frac{a}{2}(\\xi + \\eta)\\right) = -\\frac{a}{2}\n$$\n因此，雅可比矩阵在整个单元上是常数：\n$$\nJ = \\begin{pmatrix} \\frac{a}{2} & -\\frac{a}{2} \\\\ -\\frac{a}{2} & -\\frac{a}{2} \\end{pmatrix}\n$$\n雅可比行列式 $\\det(J)$ 为：\n$$\n\\det(J) = \\left(\\frac{a}{2}\\right)\\left(-\\frac{a}{2}\\right) - \\left(-\\frac{a}{2}\\right)\\left(-\\frac{a}{2}\\right) = -\\frac{a^2}{4} - \\frac{a^2}{4} = -\\frac{2a^2}{4} = -\\frac{a^2}{2}\n$$\n由于雅可比行列式是常数，其在单元中心 $(\\xi, \\eta)=(0,0)$ 处的值为 $-\\frac{a^2}{2}$。负的雅可比行列式表明映射是局部方向反转的，意味着单元是“扭曲”或“翻转”的。在有限元方法的背景下，这是一个无效单元。本练习正确地说明了完美的几何纵横比（$r=1$）并不保证映射的有效性。", "answer": "$$\n\\boxed{-\\frac{a^2}{2}}\n$$", "id": "2412959"}]}