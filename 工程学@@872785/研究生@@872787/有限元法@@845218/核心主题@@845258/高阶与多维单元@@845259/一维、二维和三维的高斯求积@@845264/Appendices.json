{"hands_on_practices": [{"introduction": "高斯-勒让德求积是有限元方法中数值积分的基石。为了真正理解这些积分点和权重值的来源，本练习将引导你从第一性原理出发，推导最常见的2点和3点高斯求积法则。通过直接求解勒让德多项式的根并利用矩条件，你将亲手揭示这些“神奇数字”背后的数学原理，从而加深对正交多项式与最优求积之间深刻联系的理解。[@problem_id:2562003]", "problem": "在有限元方法 (FEM, Finite Element Method) 的背景下，考虑在参考区间 $[-1,1]$ 上关于单位权重的数值积分，我们使用高斯-勒让德求积法则。设 $(x_{i},w_{i})$ 表示 $[-1,1]$ 上的一个 $m$ 点高斯-勒让德法则的节点和权重，该求积法则通过 $\\sum_{i=1}^{m} w_{i} f(x_{i})$ 来近似 $\\int_{-1}^{1} f(x)\\,\\mathrm{d}x$。仅使用以下基本事实：(i) 勒让德多项式 $\\{P_{n}\\}_{n\\ge 0}$ 在 $[-1,1]$ 上关于单位权重是正交的，具体而言 $\\int_{-1}^{1} P_{n}(x) P_{m}(x)\\,\\mathrm{d}x = \\frac{2}{2n+1}\\delta_{nm}$，(ii) 罗德里格斯公式 $P_{n}(x)=\\frac{1}{2^{n} n!}\\frac{\\mathrm{d}^{n}}{\\mathrm{d}x^{n}}\\bigl[(x^{2}-1)^{n}\\bigr]$，以及 (iii) 高斯-勒让德节点是 $P_{m}(x)$ 的根，而权重通过强制求积法则对最高为 $2m-1$ 次的多项式精确成立来确定。通过以下步骤，显式地推导在 $[-1,1]$ 上的两点法则 ($m=2$) 和三点法则 ($m=3$) 的节点和权重：\n- 建立并求解 $P_{2}(x)=0$ 和 $P_{3}(x)=0$ 以获得节点，\n- 对 $k$ 直到 $2m-1$ 的单项式 $x^{k}$ 强制求积法则精确成立来求解权重，并酌情使用对称性以及单项式的精确积分值 $\\int_{-1}^{1} x^{k}\\,\\mathrm{d}x$。\n\n将你的最终结果表示为一个单行矩阵，该矩阵按以下顺序拼接而成：两点法则的节点和权重（节点按严格递增顺序，后跟对应的权重），然后是三点法则的节点和权重（节点同样按严格递增顺序，后跟对应的权重）。具体来说，该行矩阵必须是\n$$\n\\bigl(x_{1}^{(2)},\\,x_{2}^{(2)},\\,w_{1}^{(2)},\\,w_{2}^{(2)},\\,x_{1}^{(3)},\\,x_{2}^{(3)},\\,x_{3}^{(3)},\\,w_{1}^{(3)},\\,w_{2}^{(3)},\\,w_{3}^{(3)}\\bigr),\n$$\n其中上标表示法则的大小 $m$。不要进行近似计算；请提供精确的根式和有理数。最终答案必须严格按照指定顺序以单行矩阵的形式给出，且不带单位。", "solution": "问题陈述是数值分析中一个定义明确的练习，特别是关于高斯-勒让德求积法则的推导。它有科学依据、自成体系且客观。所有提供的信息，包括勒让德多项式的基本性质和求积方法的定义，都是标准且正确的。因此，该问题是有效的，我将按照指示进行推导。\n\n目标是推导在区间 $[-1, 1]$ 上 $m=2$ 点和 $m=3$ 点高斯-勒让德求积法则的节点 $x_i$ 和权重 $w_i$。求积近似式由 $\\int_{-1}^{1} f(x)\\,\\mathrm{d}x \\approx \\sum_{i=1}^{m} w_{i} f(x_{i})$ 给出。\n\n步骤如下：\n1. 对于每个大小为 $m$ 的法则，使用罗德里格斯公式 $P_{n}(x)=\\frac{1}{2^{n} n!}\\frac{\\mathrm{d}^{n}}{\\mathrm{d}x^{n}}\\bigl[(x^{2}-1)^{n}\\bigr]$ 求出勒让德多项式 $P_m(x)$。\n2. 确定求积节点，它们是方程 $P_m(x)=0$ 的根。\n3. 通过构建一个线性方程组来确定求积权重，该方程组强制要求求积法则对于 $k=0, 1, \\dots, 2m-1$ 的单项式 $x^k$ 精确成立。单项式的精确积分为 $\\int_{-1}^{1} x^{k}\\,\\mathrm{d}x = \\frac{1-(-1)^{k+1}}{k+1}$，当 $k$ 为偶数时其值为 $\\frac{2}{k+1}$，当 $k$ 为奇数时为 $0$。\n\n**第一部分：两点高斯-勒让德求积 ($m=2$)**\n\n首先，我们求勒让德多项式 $P_2(x)$。使用 $n=2$ 的罗德里格斯公式：\n$$\nP_{2}(x) = \\frac{1}{2^{2} 2!} \\frac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}\\bigl[(x^{2}-1)^{2}\\bigr] = \\frac{1}{8} \\frac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}(x^{4} - 2x^{2} + 1)\n$$\n求导：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}(x^{4} - 2x^{2} + 1) = 4x^{3} - 4x\n$$\n$$\n\\frac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}(x^{4} - 2x^{2} + 1) = \\frac{\\mathrm{d}}{\\mathrm{d}x}(4x^{3} - 4x) = 12x^{2} - 4\n$$\n将此结果代回 $P_2(x)$ 的公式：\n$$\nP_{2}(x) = \\frac{1}{8}(12x^{2} - 4) = \\frac{1}{2}(3x^{2} - 1)\n$$\n求积节点 $x_{1}^{(2)}, x_{2}^{(2)}$ 是 $P_2(x)=0$ 的根：\n$$\n\\frac{1}{2}(3x^{2} - 1) = 0 \\implies 3x^{2} = 1 \\implies x^{2} = \\frac{1}{3}\n$$\n按递增顺序排列的节点为：\n$$\nx_{1}^{(2)} = -\\frac{1}{\\sqrt{3}} = -\\frac{\\sqrt{3}}{3} \\quad \\text{和} \\quad x_{2}^{(2)} = \\frac{1}{\\sqrt{3}} = \\frac{\\sqrt{3}}{3}\n$$\n接下来，我们求权重 $w_{1}^{(2)}, w_{2}^{(2)}$。$2$点法则对最高为 $2m-1 = 2(2)-1 = 3$ 次的所有多项式都精确成立。我们使用单项式基底来强制执行此条件。\n对于 $f(x)=x^0=1$：\n$$\n\\int_{-1}^{1} 1\\,\\mathrm{d}x = 2 \\quad \\Rightarrow \\quad w_{1}^{(2)}f(x_{1}^{(2)}) + w_{2}^{(2)}f(x_{2}^{(2)}) = w_{1}^{(2)}(1) + w_{2}^{(2)}(1) = w_{1}^{(2)} + w_{2}^{(2)} = 2\n$$\n对于 $f(x)=x^1=x$：\n$$\n\\int_{-1}^{1} x\\,\\mathrm{d}x = 0 \\quad \\Rightarrow \\quad w_{1}^{(2)}x_{1}^{(2)} + w_{2}^{(2)}x_{2}^{(2)} = w_{1}^{(2)}\\left(-\\frac{\\sqrt{3}}{3}\\right) + w_{2}^{(2)}\\left(\\frac{\\sqrt{3}}{3}\\right) = 0\n$$\n从第二个方程，我们得到 $\\frac{\\sqrt{3}}{3}(-w_{1}^{(2)} + w_{2}^{(2)}) = 0$，这意味着 $w_{1}^{(2)} = w_{2}^{(2)}$。由于节点关于 $x=0$ 对称，这是预期的结果。\n将 $w_{1}^{(2)} = w_{2}^{(2)}$ 代入第一个方程：\n$$\nw_{1}^{(2)} + w_{1}^{(2)} = 2w_{1}^{(2)} = 2 \\implies w_{1}^{(2)} = 1\n$$\n因此，权重为 $w_{1}^{(2)} = 1$ 和 $w_{2}^{(2)} = 1$。\n\n**第二部分：三点高斯-勒让德求积 ($m=3$)**\n\n首先，我们求勒让德多项式 $P_3(x)$。使用 $n=3$ 的罗德里格斯公式：\n$$\nP_{3}(x) = \\frac{1}{2^{3} 3!} \\frac{\\mathrm{d}^{3}}{\\mathrm{d}x^{3}}\\bigl[(x^{2}-1)^{3}\\bigr] = \\frac{1}{48} \\frac{\\mathrm{d}^{3}}{\\mathrm{d}x^{3}}(x^{6} - 3x^{4} + 3x^{2} - 1)\n$$\n求导：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}(x^{6} - 3x^{4} + 3x^{2} - 1) = 6x^{5} - 12x^{3} + 6x\n$$\n$$\n\\frac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}(x^{6} - 3x^{4} + 3x^{2} - 1) = 30x^{4} - 36x^{2} + 6\n$$\n$$\n\\frac{\\mathrm{d}^{3}}{\\mathrm{d}x^{3}}(x^{6} - 3x^{4} + 3x^{2} - 1) = 120x^{3} - 72x\n$$\n将此结果代回 $P_3(x)$ 的公式：\n$$\nP_{3}(x) = \\frac{1}{48}(120x^{3} - 72x) = \\frac{24}{48}(5x^{3} - 3x) = \\frac{1}{2}(5x^{3} - 3x)\n$$\n求积节点 $x_{1}^{(3)}, x_{2}^{(3)}, x_{3}^{(3)}$ 是 $P_3(x)=0$ 的根：\n$$\n\\frac{1}{2}(5x^{3} - 3x) = 0 \\implies x(5x^{2} - 3) = 0\n$$\n根是 $x=0$ 和 $5x^2 = 3 \\implies x^2 = \\frac{3}{5}$。按递增顺序排列的节点为：\n$$\nx_{1}^{(3)} = -\\sqrt{\\frac{3}{5}} = -\\frac{\\sqrt{15}}{5}, \\quad x_{2}^{(3)} = 0, \\quad x_{3}^{(3)} = \\sqrt{\\frac{3}{5}} = \\frac{\\sqrt{15}}{5}\n$$\n接下来，我们求权重 $w_{1}^{(3)}, w_{2}^{(3)}, w_{3}^{(3)}$。$3$点法则对最高为 $2m-1 = 2(3)-1 = 5$ 次的所有多项式都精确成立。\n对于 $f(x)=x^0=1$：\n$$\n\\int_{-1}^{1} 1\\,\\mathrm{d}x = 2 \\quad \\Rightarrow \\quad w_{1}^{(3)} + w_{2}^{(3)} + w_{3}^{(3)} = 2\n$$\n对于 $f(x)=x^1=x$：\n$$\n\\int_{-1}^{1} x\\,\\mathrm{d}x = 0 \\quad \\Rightarrow \\quad w_{1}^{(3)}\\left(-\\sqrt{\\frac{3}{5}}\\right) + w_{2}^{(3)}(0) + w_{3}^{(3)}\\left(\\sqrt{\\frac{3}{5}}\\right) = 0\n$$\n从第二个方程，$\\sqrt{\\frac{3}{5}}(-w_{1}^{(3)} + w_{3}^{(3)}) = 0$，这意味着 $w_{1}^{(3)} = w_{3}^{(3)}$，正如对称性所预期的。\n对于 $f(x)=x^2$：\n$$\n\\int_{-1}^{1} x^{2}\\,\\mathrm{d}x = \\frac{2}{3} \\quad \\Rightarrow \\quad w_{1}^{(3)}\\left(-\\sqrt{\\frac{3}{5}}\\right)^{2} + w_{2}^{(3)}(0)^{2} + w_{3}^{(3)}\\left(\\sqrt{\\frac{3}{5}}\\right)^{2} = w_{1}^{(3)}\\left(\\frac{3}{5}\\right) + w_{3}^{(3)}\\left(\\frac{3}{5}\\right) = \\frac{2}{3}\n$$\n在第三个方程中使用 $w_{1}^{(3)} = w_{3}^{(3)}$：\n$$\n2w_{1}^{(3)}\\left(\\frac{3}{5}\\right) = \\frac{2}{3} \\implies w_{1}^{(3)}\\left(\\frac{6}{5}\\right) = \\frac{2}{3} \\implies w_{1}^{(3)} = \\frac{2}{3} \\cdot \\frac{5}{6} = \\frac{10}{18} = \\frac{5}{9}\n$$\n所以，$w_{1}^{(3)} = w_{3}^{(3)} = \\frac{5}{9}$。\n最后，使用第一个方程，$w_{1}^{(3)} + w_{2}^{(3)} + w_{3}^{(3)} = 2w_{1}^{(3)} + w_{2}^{(3)} = 2$：\n$$\n2\\left(\\frac{5}{9}\\right) + w_{2}^{(3)} = 2 \\implies \\frac{10}{9} + w_{2}^{(3)} = 2 \\implies w_{2}^{(3)} = 2 - \\frac{10}{9} = \\frac{18-10}{9} = \\frac{8}{9}\n$$\n因此，权重为 $w_{1}^{(3)} = \\frac{5}{9}$，$w_{2}^{(3)} = \\frac{8}{9}$ 和 $w_{3}^{(3)} = \\frac{5}{9}$。\n\n我们将结果整合到所要求的行矩阵中：\n$$\n(x_{1}^{(2)}, x_{2}^{(2)}, w_{1}^{(2)}, w_{2}^{(2)}, x_{1}^{(3)}, x_{2}^{(3)}, x_{3}^{(3)}, w_{1}^{(3)}, w_{2}^{(3)}, w_{3}^{(3)})\n$$\n代入推导出的值并对分母进行有理化：\n$$\n\\left(-\\frac{\\sqrt{3}}{3}, \\frac{\\sqrt{3}}{3}, 1, 1, -\\frac{\\sqrt{15}}{5}, 0, \\frac{\\sqrt{15}}{5}, \\frac{5}{9}, \\frac{8}{9}, \\frac{5}{9}\\right)\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{\\sqrt{3}}{3}  \\frac{\\sqrt{3}}{3}  1  1  -\\frac{\\sqrt{15}}{5}  0  \\frac{\\sqrt{15}}{5}  \\frac{5}{9}  \\frac{8}{9}  \\frac{5}{9}\n\\end{pmatrix}\n}\n$$", "id": "2562003"}, {"introduction": "将一维高斯求积理论应用于多维有限元分析时，一个核心问题是如何为特定单元选择合适的求积阶数。本练习以二维四边形单元的质量矩阵积分为例，要求你分析被积函数（形函数乘积与雅可比行列式的组合）的多项式次数。通过这项实践，你将学会如何判断一个给定的高斯求积法则能否精确积分单元矩阵，这是确保有限元计算准确性的关键一步。[@problem_id:2561927]", "problem": "考虑一个定义在参考正方形 $\\hat{K}=[-1,1]\\times[-1,1]$ 上的双线性四边形有限元，其标准双线性形函数为 $N_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)$，$N_{2}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta)$，$N_{3}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta)$，和 $N_{4}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta)$。其一致质量矩阵元为\n$$\nM_{ij}=\\int_{\\hat{K}} N_{i}(\\xi,\\eta)\\,N_{j}(\\xi,\\eta)\\,J(\\xi,\\eta)\\,d\\xi\\,d\\eta,\n$$\n其中 $J(\\xi,\\eta)$ 是等参映射的雅可比行列式。该积分将通过在 $\\hat{K}$ 上使用 $2\\times 2$ 个点的张量积高斯-勒让德求积法进行计算。\n\n仅从一维2点高斯-勒让德法则对至多3次的单变量多项式是精确的这一基本性质出发，分析被积函数 $N_{i}N_{j}J$ 的多项式次数结构，并判断 $2\\times 2$ 法则是否对所有矩阵元 $M_{ij}$ 都是精确的。陈述 $J(\\xi,\\eta)$ 满足精确性的充分必要条件，并通过次数追踪来证明你的结论。\n\n然后，作为对你结论的具体定量检验，假设\n$$\nJ(\\xi,\\eta)=\\alpha+\\beta\\,\\xi+\\gamma\\,\\eta+\\delta\\,\\xi\\eta+\\varepsilon\\,\\xi^{2},\n$$\n其中 $\\alpha,\\beta,\\gamma,\\delta,\\varepsilon\\in\\mathbb{R}$，且 $\\varepsilon$ 是一个表示 $\\xi$ 方向上二次扰动的小参数。对于质量矩阵的 $(1,1)$ 元 $M_{11}$，计算求积误差\n$$\nE(\\varepsilon)=\\iint_{\\hat{K}} N_{1}(\\xi,\\eta)^{2}\\,J(\\xi,\\eta)\\,d\\xi\\,d\\eta\\;-\\;\\sum_{i=1}^{2}\\sum_{j=1}^{2} w_{i}w_{j}\\,N_{1}(\\xi_{i},\\eta_{j})^{2}\\,J(\\xi_{i},\\eta_{j}),\n$$\n其中 $(\\xi_{i},w_{i})$ 和 $(\\eta_{j},w_{j})$ 分别是每个坐标上 $[-1,1]$ 区间的标准2点高斯-勒让德节点和权重。将你的最终答案表示为仅含 $\\varepsilon$ 的闭式解析表达式。无需四舍五入，也不涉及物理单位。只需提供此最终表达式作为你的答案。", "solution": "我们从参考正方形 $\\hat{K}=[-1,1]^{2}$ 上的标准双线性形函数开始。每个 $N_{i}(\\xi,\\eta)$ 都是 $\\xi$ 和 $\\eta$ 中线性因子的乘积，因此是一个关于 $\\xi$ 的次数至多为1、关于 $\\eta$ 的次数也至多为1的二元多项式。因此，对于任意下标 $i,j\\in\\{1,2,3,4\\}$，乘积 $N_{i}N_{j}$ 是一个关于 $\\xi$ 的次数至多为2、关于 $\\eta$ 的次数也至多为2的二元多项式。\n\n$[-1,1]$ 上的2点高斯-勒让德法则对于次数至多为3的单变量多项式是精确的。$\\hat{K}$ 上的张量积 $2\\times 2$ 法则是通过在每个坐标上应用一维法则得到的，它对于任何由可分离单项式 $\\xi^{p}\\eta^{q}$（其中 $p\\leq 3$ 和 $q\\leq 3$）的有限线性组合构成的二元多项式都是精确的。因此，$2\\times 2$ 法则能精确积分任何被积函数，只要其在每个变量中的次数不超过3。\n\n质量矩阵的被积函数是 $N_{i}N_{j}J$。如果 $J(\\xi,\\eta)$ 是一个关于 $\\xi$ 的次数至多为1、关于 $\\eta$ 的次数也至多为1的多项式（即，$J$ 是双线性的：$J(\\xi,\\eta)=a_{0}+a_{1}\\xi+a_{2}\\eta+a_{3}\\xi\\eta$），那么 $N_{i}N_{j}J$ 在每个变量中的次数至多为3，因为将一个次数$\\leq 2$的二元多项式乘以一个次数$\\leq 1$的二元多项式，会得到一个在每个变量上次数$\\leq 3$的二元多项式。因此，在 $J$ 是双线性的条件下（这包括 $J$ 为常数的特殊仿射情况），$2\\times 2$ 高斯法则对所有矩阵元 $M_{ij}$ 都是精确的。\n\n反之，如果 $J$ 在任一变量中包含任何次数 $\\geq 2$ 的项，那么 $N_{i}N_{j}J$ 就可能包含该变量中次数 $\\geq 4$ 的单项式，此时 $2\\times 2$ 高斯法则未必是精确的。因此，$2\\times 2$ 法则对所有矩阵元 $M_{ij}$ 精确的充分必要条件是 $J(\\xi,\\eta)$ 是双线性的，即在每个变量中的次数至多为1。\n\n我们现在为一个特定的扰动计算定量误差。令\n$$\nJ(\\xi,\\eta)=\\alpha+\\beta\\,\\xi+\\gamma\\,\\eta+\\delta\\,\\xi\\eta+\\varepsilon\\,\\xi^{2}.\n$$\n对于 $(1,1)$ 元，被积函数是 $N_{1}^{2}J$。$2\\times 2$ 法则对双线性部分 $\\alpha+\\beta\\xi+\\gamma\\eta+\\delta\\xi\\eta$ 是精确的，因此求积误差完全来自于二次扰动项 $\\varepsilon\\,\\xi^{2}$。于是\n$$\nE(\\varepsilon)=\\varepsilon\\left(\\iint_{\\hat{K}} N_{1}(\\xi,\\eta)^{2}\\,\\xi^{2}\\,d\\xi\\,d\\eta\\;-\\;\\sum_{i=1}^{2}\\sum_{j=1}^{2} w_{i}w_{j}\\,N_{1}(\\xi_{i},\\eta_{j})^{2}\\,\\xi_{i}^{2}\\right).\n$$\n我们计算 $f(\\xi,\\eta)=N_{1}(\\xi,\\eta)^{2}\\,\\xi^{2}$ 的精确积分和 $2\\times 2$ 求积。\n\n首先，写出\n$$\nN_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)=\\frac{1}{4}\\left(1-\\xi-\\eta+\\xi\\eta\\right),\n$$\n所以\n$$\nN_{1}(\\xi,\\eta)^{2}=\\frac{1}{16}\\left(1-\\xi-\\eta+\\xi\\eta\\right)^{2}.\n$$\n展开平方项得到\n$$\n\\left(1-\\xi-\\eta+\\xi\\eta\\right)^{2}=1+\\xi^{2}+\\eta^{2}+\\xi^{2}\\eta^{2}-2\\xi-2\\eta+4\\xi\\eta-2\\xi^{2}\\eta-2\\xi\\eta^{2}.\n$$\n因此，\n$$\nf(\\xi,\\eta)=\\xi^{2}N_{1}(\\xi,\\eta)^{2}=\\frac{1}{16}\\Big(\\xi^{2}+\\xi^{4}+\\xi^{2}\\eta^{2}+\\xi^{4}\\eta^{2}-2\\xi^{3}-2\\xi^{2}\\eta+4\\xi^{3}\\eta-2\\xi^{4}\\eta-2\\xi^{3}\\eta^{2}\\Big).\n$$\n\n精确积分。因为 $\\hat{K}$ 是一个乘积域，且被积函数是可分离单项式的和，我们使用 $\\int_{-1}^{1}\\xi^{n}\\,d\\xi=0$ (对于奇数 $n$) 和 $\\int_{-1}^{1}\\xi^{0}\\,d\\xi=2$, $\\int_{-1}^{1}\\xi^{2}\\,d\\xi=\\frac{2}{3}$, $\\int_{-1}^{1}\\xi^{4}\\,d\\xi=\\frac{2}{5}$。所有在任一变量中具有奇次幂的单项式积分为零。剩下的项是\n$$\n\\iint_{\\hat{K}} f(\\xi,\\eta)\\,d\\xi\\,d\\eta=\\frac{1}{16}\\left(\\frac{4}{3}+\\frac{4}{5}+\\frac{4}{9}+\\frac{4}{15}\\right)=\\frac{1}{4}\\left(\\frac{1}{3}+\\frac{1}{5}+\\frac{1}{9}+\\frac{1}{15}\\right)=\\frac{8}{45}.\n$$\n\n$2\\times 2$ 高斯-勒让德求积。一维 $[-1,1]$ 上的2点高斯-勒让德法则的节点为 $\\pm a$（其中 $a=\\frac{1}{\\sqrt{3}}$），权重为 $1$。$\\hat{K}$ 上的张量积法则使用四个节点 $(\\pm a,\\pm a)$，权重均为 $1$。因为 $f$ 可以分解为\n$$\nf(\\xi,\\eta)=\\frac{1}{16}\\big[\\xi^{2}(1-\\xi)^{2}\\big]\\big[(1-\\eta)^{2}\\big],\n$$\n求积和也可以分解：\n$$\n\\sum_{i=1}^{2}\\sum_{j=1}^{2} w_{i}w_{j}\\,f(\\xi_{i},\\eta_{j})=\\frac{1}{16}\\left(\\sum_{\\xi=\\pm a}\\xi^{2}(1-\\xi)^{2}\\right)\\left(\\sum_{\\eta=\\pm a}(1-\\eta)^{2}\\right).\n$$\n计算\n$$\n\\sum_{\\xi=\\pm a}\\xi^{2}(1-\\xi)^{2}=a^{2}\\big[(1-a)^{2}+(1+a)^{2}\\big]=2a^{2}(1+a^{2}),\n$$\n$$\n\\sum_{\\eta=\\pm a}(1-\\eta)^{2}=(1-a)^{2}+(1+a)^{2}=2(1+a^{2}),\n$$\n所以\n$$\n\\sum_{i,j} w_{i}w_{j}\\,f(\\xi_{i},\\eta_{j})=\\frac{1}{16}\\cdot 2a^{2}(1+a^{2})\\cdot 2(1+a^{2})=\\frac{1}{4}a^{2}(1+a^{2})^{2}.\n$$\n代入 $a^{2}=\\frac{1}{3}$，我们得到\n$$\n\\sum_{i,j} w_{i}w_{j}\\,f(\\xi_{i},\\eta_{j})=\\frac{1}{4}\\cdot\\frac{1}{3}\\cdot\\left(1+\\frac{1}{3}\\right)^{2}=\\frac{1}{12}\\cdot\\frac{16}{9}=\\frac{4}{27}.\n$$\n\n因此，求积误差是\n$$\nE(\\varepsilon)=\\varepsilon\\left(\\frac{8}{45}-\\frac{4}{27}\\right)=\\varepsilon\\left(\\frac{24}{135}-\\frac{20}{135}\\right)=\\varepsilon\\cdot\\frac{4}{135}.\n$$\n此表达式仅依赖于 $\\varepsilon$，正如所要求。符号为正，表明对于此扰动，精确积分值超过了 $2\\times 2$ 高斯近似值。\n\n总而言之：张量积 $2\\times 2$ 高斯法则能精确积分 $M_{ij}$ 当且仅当 $J(\\xi,\\eta)$ 是双线性的（即每个变量的次数至多为1）。对于特定的扰动 $J(\\xi,\\eta)=\\alpha+\\beta\\xi+\\gamma\\eta+\\delta\\xi\\eta+\\varepsilon\\xi^{2}$， $M_{11}$ 的求积误差为 $E(\\varepsilon)=\\frac{4}{135}\\varepsilon$。", "answer": "$$\n\\boxed{\\frac{4}{135}\\,\\varepsilon}\n$$", "id": "2561927"}, {"introduction": "在有限元实践中，选择积分阶数不仅关乎精度，也影响计算效率和单元性能，例如“减缩积分”技术。然而，减缩积分可能导致单元刚度矩阵秩亏，从而产生非物理的“沙漏”变形模式。本练习将引导你分析这一现象，并通过引入一个稳定化项来恢复单元的稳定性，让你深入理解现代有限元程序中为解决复杂单元行为而采用的高级数值技术。[@problem_id:2561940]", "problem": "考虑一个四节点双线性等参四边形有限元单元，该单元通过仿射映射 $x=(\\xi+1)/2$, $y=(\\eta+1)/2$ 将参考正方形 $\\{(\\xi,\\eta)\\in[-1,1]^2\\}$ 映射到物理坐标系中的单位正方形 $\\{(x,y)\\in[0,1]^2\\}$。假设为平面应变线弹性问题，Lamé 参数为 $\\lambda>0$ 和 $\\mu>0$，且单元厚度为单位1。设自由度 (DOF) 向量的顺序为 $[u_1,v_1,u_2,v_2,u_3,v_3,u_4,v_4]^{\\top}$，其中 $(u_i,v_i)$ 是节点位移分量。\n\n您将使用单元中心点 $(\\xi,\\eta)=(0,0)$ 的单点缩减高斯积分来近似单元刚度，然后用一个针对沙漏模式的秩-2 稳定化项对其进行增强。仅使用以下基本事实：\n\n- 在 $[-1,1]^2$ 上的双线性形函数为 $N_1(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta)$，对于此仿射映射，其物理导数满足 $\\partial/\\partial x = 2\\,\\partial/\\partial \\xi$ 和 $\\partial/\\partial y = 2\\,\\partial/\\partial \\eta$。\n- 在某一点的应变-位移矩阵，记为 $B(\\xi,\\eta)$，对于平面应变问题，由形函数导数通过分块矩阵 $B_i=\\begin{bmatrix}N_{i,x}  0\\\\ 0  N_{i,y}\\\\ N_{i,y}  N_{i,x}\\end{bmatrix}$，$i=1,\\dots,4$ 组装而成。\n- 平面应变本构张量为 $D=\\begin{bmatrix}\\lambda+2\\mu  \\lambda  0\\\\ \\lambda  \\lambda+2\\mu  0\\\\ 0  0  \\mu\\end{bmatrix}$，当 $\\lambda>0, \\mu>0$ 时为正定。\n- 在 $[-1,1]^2$ 上的单点高斯乘积法则具有单个积分点 $(0,0)$ 和权重 $4$，且对于上述仿射映射，雅可比行列式为常数，等于 $1/4$。\n\n定义缩减积分单元刚度为 $K_{\\mathrm{RI}}=B_c^{\\top} D B_c$，其中 $B_c:=B(0,0)$。使用规范沙漏向量\n$$\nh_1=\\begin{bmatrix}1\\\\0\\\\-1\\\\0\\\\1\\\\0\\\\-1\\\\0\\end{bmatrix},\\qquad\nh_2=\\begin{bmatrix}0\\\\1\\\\0\\\\-1\\\\0\\\\1\\\\0\\\\-1\\end{bmatrix},\n$$\n和稳定化矩阵 $K_{\\mathrm{stab}}=\\alpha\\,(h_1 h_1^{\\top}+h_2 h_2^{\\top})$ 定义秩-2 稳定化，其中标量系数为 $\\alpha\\ge 0$。总的稳定化刚度为 $K_{\\mathrm{tot}}=K_{\\mathrm{RI}}+K_{\\mathrm{stab}}$。\n\n任务：\n1. 使用第一性原理，通过对中心点处的形函数求导来构造 $B_c$，并证明 $K_{\\mathrm{RI}}=B_c^{\\top} D B_c$ 的秩为3。根据此构造，用 $\\lambda$ 和 $\\mu$ 表示 $K_{\\mathrm{RI}}$ 的三个严格正特征值。\n2. 解释添加 $K_{\\mathrm{stab}}$ 如何影响 $K_{\\mathrm{tot}}$ 的秩，并确定由稳定化项沿沙漏方向引入的两个特征值。\n3. 施加稳定性均衡条件，即 $K_{\\mathrm{tot}}$ 的最小正特征值与 $K_{\\mathrm{RI}}$ 的最小正特征值相同。在此条件下，确定 $\\alpha$ 关于 $\\mu$ 的闭式解。\n\n将您的最终答案表示为 $\\alpha$ 关于 $\\mu$ 的单个解析表达式。不需要进行数值计算，也无需报告单位。", "solution": "所提出的问题是有限元方法中关于缩减积分单元的沙漏稳定化的一个标准练习。它具有科学依据，数学上是适定的，并包含解决该问题所需的所有信息。因此，该问题被认为是有效的。我们按照概述的任务进行求解。\n\n问题的核心是，在平面应变条件下，为四节点四边形单元构建单元刚度矩阵，在使用单点高斯积分时分析其谱特性，然后确定一个为修正这种缩减积分所引入的秩亏而设计的稳定化方案的参数。\n\n首先，我们必须构建在单元中心点计算的应变-位移矩阵 $B$，记为 $B_c$。矩阵 $B$ 将应变向量 $\\varepsilon = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\top}$ 与节点位移向量 $d = [u_1, v_1, \\dots, u_4, v_4]^{\\top}$ 联系起来。对于双线性单元，位移场 $(u,v)$ 是通过使用形函数 $N_i(\\xi, \\eta)$ 从节点值插值得到的：\n$$\nu(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_i, \\qquad v(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) v_i\n$$\n应变由 $\\varepsilon_{xx} = \\partial u / \\partial x$, $\\varepsilon_{yy} = \\partial v / \\partial y$ 和 $\\gamma_{xy} = \\partial u / \\partial y + \\partial v / \\partial x$ 给出。这导出了矩阵关系 $\\varepsilon = B d$。矩阵 $B$ 由分块矩阵 $B_i$ 组成：\n$B(\\xi, \\eta) = [B_1(\\xi, \\eta), B_2(\\xi, \\eta), B_3(\\xi, \\eta), B_4(\\xi, \\eta)]$，其中 $B_i = \\begin{bmatrix}N_{i,x}  0\\\\ 0  N_{i,y}\\\\ N_{i,y}  N_{i,x}\\end{bmatrix}$。\n\n问题给出了仿射映射 $x=(\\xi+1)/2$ 和 $y=(\\eta+1)/2$，其物理导数与参考导数之间的关系为 $\\partial/\\partial x = 2\\,\\partial/\\partial\\xi$ 和 $\\partial/\\partial y = 2\\,\\partial/\\partial\\eta$。我们计算形函数 $N_i$ 关于 $\\xi$ 和 $\\eta$ 的导数，并在中心点 $(\\xi,\\eta)=(0,0)$ 处进行计算：\n$N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta) \\implies N_{1,\\xi}|_{(0,0)}=-\\frac{1}{4}, N_{1,\\eta}|_{(0,0)}=-\\frac{1}{4}$\n$N_2 = \\frac{1}{4}(1+\\xi)(1-\\eta) \\implies N_{2,\\xi}|_{(0,0)}=\\frac{1}{4}, N_{2,\\eta}|_{(0,0)}=-\\frac{1}{4}$\n$N_3 = \\frac{1}{4}(1+\\xi)(1+\\eta) \\implies N_{3,\\xi}|_{(0,0)}=\\frac{1}{4}, N_{3,\\eta}|_{(0,0)}=\\frac{1}{4}$\n$N_4 = \\frac{1}{4}(1-\\xi)(1+\\eta) \\implies N_{4,\\xi}|_{(0,0)}=-\\frac{1}{4}, N_{4,\\eta}|_{(0,0)}=\\frac{1}{4}$\n\n中心点处的物理导数，用下标 $c$ 表示，为：\n$N_{i,x,c} = 2 N_{i,\\xi}|_{(0,0)}$ 和 $N_{i,y,c} = 2 N_{i,\\eta}|_{(0,0)}$。\n这给出了导数向量：\n$[N_{1,x,c}, \\dots, N_{4,x,c}] = \\frac{1}{2}[-1, 1, 1, -1]$\n$[N_{1,y,c}, \\dots, N_{4,y,c}] = \\frac{1}{2}[-1, -1, 1, 1]$\n\n矩阵 $B_c = B(0,0)$ 是一个 $3 \\times 8$ 的矩阵，构造如下：\n$$\nB_c = \\begin{bmatrix}\nN_{1,x,c}  0  N_{2,x,c}  0  N_{3,x,c}  0  N_{4,x,c}  0 \\\\\n0  N_{1,y,c}  0  N_{2,y,c}  0  N_{3,y,c}  0  N_{4,y,c} \\\\\nN_{1,y,c}  N_{1,x,c}  N_{2,y,c}  N_{2,x,c}  N_{3,y,c}  N_{3,x,c}  N_{4,y,c}  N_{4,x,c}\n\\end{bmatrix}\n$$\n代入计算出的值：\n$$\nB_c = \\frac{1}{2} \\begin{bmatrix}\n-1  0  1  0  1  0  -1  0 \\\\\n0  -1  0  -1  0  1  0  1 \\\\\n-1  -1  -1  1  1  1  1  -1\n\\end{bmatrix}\n$$\n为了确定 $B_c$ 的秩，我们检验其三个行向量 $b_1^{\\top}, b_2^{\\top}, b_3^{\\top}$ 的线性无关性。假设一个线性组合等于零向量：$c_1 b_1 + c_2 b_2 + c_3 b_3 = 0$。考察第一个分量得到 $-c_1 - c_3 = 0$，所以 $c_1=-c_3$。考察第三个分量得到 $c_1 - c_3 = 0$，所以 $c_1=c_3$。这两个条件一起意味着 $c_1=c_3=0$。从第二个分量，$-c_2 - c_3 = 0$，现在得到 $c_2=0$。因此，这些行是线性无关的。$B_c$ 的秩为 3。\n缩减积分刚度矩阵为 $K_{\\mathrm{RI}} = B_c^{\\top} D B_c$。由于 $D$ 是一个 $3 \\times 3$ 的正定矩阵（因此秩为 3），$K_{\\mathrm{RI}}$ 的秩等于 $B_c$ 的秩，即 3。这表明 $8 \\times 8$ 矩阵 $K_{\\mathrm{RI}}$ 是秩亏的，其零空间的维数为 $8-3=5$。这些零模中的三个是物理刚体运动，其余两个是非物理的零能模式，称为沙漏模式。\n\n为了找到 $K_{\\mathrm{RI}}$ 的非零特征值，我们可以分析 $3 \\times 3$ 矩阵 $B_c B_c^{\\top}$，然后是 $D (B_c B_c^{\\top})$。$B_c^{\\top} D B_c$ 的特征值就是 $(B_c B_c^{\\top}) D$ 或 $D(B_c B_c^{\\top})$ 的特征值。让我们计算 $G = B_c B_c^{\\top}$。元素 $G_{ij}$ 是 $B_c$ 各行向量的点积：\n$G_{11} = b_1 \\cdot b_1 = (\\frac{1}{2})^2 ((-1)^2 + 1^2 + 1^2 + (-1)^2) = 1$。\n$G_{22} = b_2 \\cdot b_2 = (\\frac{1}{2})^2 ((-1)^2 + (-1)^2 + 1^2 + 1^2) = 1$。\n$G_{33} = b_3 \\cdot b_3 = (\\frac{1}{2})^2 ((-1)^2 + (-1)^2 + (-1)^2 + 1^2 + 1^2 + 1^2 + 1^2 + (-1)^2) = 2$。\n$G_{12} = b_1 \\cdot b_2 = (\\frac{1}{2})^2 (0) = 0$。\n$G_{13} = b_1 \\cdot b_3 = (\\frac{1}{2})^2 ((-1)(-1) + 1(-1) + 1(1) + (-1)(1)) = 0$。\n$G_{23} = b_2 \\cdot b_3 = (\\frac{1}{2})^2 ((-1)(-1) + (-1)(1) + 1(1) + 1(-1)) = 0$。\n因此，矩阵 $G$ 是对角矩阵：\n$$\nG = B_c B_c^{\\top} = \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  2 \\end{bmatrix}\n$$\n$K_{\\mathrm{RI}}$ 的非零特征值是矩阵 $H = D G$ 的特征值：\n$$\nH = \\begin{bmatrix}\\lambda+2\\mu  \\lambda  0\\\\ \\lambda  \\lambda+2\\mu  0\\\\ 0  0  \\mu\\end{bmatrix} \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  2 \\end{bmatrix} = \\begin{bmatrix}\\lambda+2\\mu  \\lambda  0\\\\ \\lambda  \\lambda+2\\mu  0\\\\ 0  0  2\\mu\\end{bmatrix}\n$$\n$H$ 的特征值是 $2\\mu$ 以及左上角 $2 \\times 2$ 块的特征值，即 $(\\lambda+2\\mu) \\pm \\lambda$。这给出了特征值 $2\\mu+2\\lambda$ 和 $2\\mu$。因此，$K_{\\mathrm{RI}}$ 的三个严格正特征值为 $\\{2\\mu, 2\\mu, 2\\lambda+2\\mu\\}$。\n\n接下来，我们分析总刚度 $K_{\\mathrm{tot}} = K_{\\mathrm{RI}} + K_{\\mathrm{stab}}$。稳定化矩阵 $K_{\\mathrm{stab}} = \\alpha(h_1 h_1^{\\top} + h_2 h_2^{\\top})$ 是由沙漏向量 $h_1$ 和 $h_2$ 构造的。可以证明这些向量位于 $B_c$ 的零空间中（因此也位于 $K_{\\mathrm{RI}}$ 的零空间中）。例如，$b_1 \\cdot h_1 = \\frac{1}{2}(-1(1) + 1(-1) + 1(1) -1(-1))=0$，对于所有其他的积 $b_i \\cdot h_j$ 也类似。这意味着 $K_{\\mathrm{RI}} h_1 = 0$ 且 $K_{\\mathrm{RI}} h_2 = 0$。向量 $h_1$ 和 $h_2$ 是正交的，因为 $h_1^{\\top} h_2 = 0$。它们的范数平方分别为 $h_1^{\\top} h_1 = 4$ 和 $h_2^{\\top} h_2 = 4$。\n张成 $K_{\\mathrm{RI}}$ 值域的向量与其零空间正交，因此它们与 $h_1$ 和 $h_2$ 正交。因此，$K_{\\mathrm{RI}}$ 和 $K_{\\mathrm{stab}}$ 的特征空间是正交的。\n$K_{\\mathrm{tot}}$ 的特征向量要么是 $K_{\\mathrm{RI}}$ 的特征向量，要么是 $K_{\\mathrm{stab}}$ 的特征向量。\n$K_{\\mathrm{RI}}$ 对应其正特征值的三个特征向量仍然是 $K_{\\mathrm{tot}}$ 的特征向量，且特征值不变。\n向量 $h_1$ 和 $h_2$ 是 $K_{\\mathrm{tot}}$ 的特征向量：\n$K_{\\mathrm{tot}} h_1 = K_{\\mathrm{RI}} h_1 + \\alpha(h_1 h_1^{\\top} + h_2 h_2^{\\top}) h_1 = 0 + \\alpha(h_1 (h_1^{\\top} h_1)) = 4\\alpha h_1$。\n$K_{\\mathrm{tot}} h_2 = K_{\\mathrm{RI}} h_2 + \\alpha(h_1 h_1^{\\top} + h_2 h_2^{\\top}) h_2 = 0 + \\alpha(h_2 (h_2^{\\top} h_2)) = 4\\alpha h_2$。\n所以，稳定化引入了两个特征值，它们都等于 $4\\alpha$。\n$K_{\\mathrm{tot}}$ 的秩是 $K_{\\mathrm{RI}}$ 和 $K_{\\mathrm{stab}}$ 的秩之和，因此 $\\mathrm{rank}(K_{\\mathrm{tot}}) = 3+2=5$。$K_{\\mathrm{tot}}$ 的零空间维数为 3，由三个刚体运动模式张成，这些模式同时位于 $K_{\\mathrm{RI}}$ 和 $K_{\\mathrm{stab}}$ 的零空间中。\n\n最后，我们必须确定 $\\alpha$。$K_{\\mathrm{tot}}$ 的正特征值列表为 $\\{2\\mu, 2\\mu, 2\\lambda+2\\mu, 4\\alpha, 4\\alpha\\}$。$K_{\\mathrm{RI}}$ 的最小正特征值是 $2\\mu$ （因为 $\\lambda>0, \\mu>0$）。问题陈述了一个“稳定性均衡条件”，即 $K_{\\mathrm{tot}}$ 的最小正特征值与该值一致。$K_{\\mathrm{tot}}$ 的最小正特征值为 $\\min(2\\mu, 4\\alpha)$。条件 $\\min(2\\mu, 4\\alpha) = 2\\mu$ 对任何 $4\\alpha \\ge 2\\mu$ 都成立。然而，在此上下文中，“均衡条件”这一术语具有一个标准的、精确的含义：选择稳定化参数，使得伪模式的刚度等于单元最软物理模式的刚度。这消除了歧义并为 $\\alpha$ 提供了一个唯一的值。因此，我们将对应于沙漏模式的特征值设置为最小的物理特征值：\n$$\n4\\alpha = 2\\mu\n$$\n求解 $\\alpha$ 得到所需的值：\n$$\n\\alpha = \\frac{2\\mu}{4} = \\frac{\\mu}{2}\n$$\n这种选择确保了对伪模式的惩罚刚度与单元最软的变形模式处于同一数量级，这对于一个稳定且精确的数值方案来说是一个理想的属性。", "answer": "$$\n\\boxed{\\frac{\\mu}{2}}\n$$", "id": "2561940"}]}