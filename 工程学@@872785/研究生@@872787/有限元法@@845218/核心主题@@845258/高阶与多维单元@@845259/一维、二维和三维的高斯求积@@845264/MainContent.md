## 引言
在[有限元分析](@entry_id:138109)的庞大体系中，从[单元刚度矩阵](@entry_id:139369)的构建到[载荷向量](@entry_id:635284)的计算，几乎每一步都离不开对函数在复杂域上进行积分。由于解析积分在绝大多数实际问题中都不可行，高效而精确的[数值积分方法](@entry_id:141406)便成为驱动整个有限元模拟引擎的核心部件。在众多[数值积分](@entry_id:136578)技术中，高斯求积（Gauss Quadrature）以其无与伦比的效率和精度脱颖而出，成为[计算力学](@entry_id:174464)和工程领域的标准工具。然而，它的强大并非凭空而来，其背后蕴含着深刻的数学原理，其应用也充满了需要细致考量的工程智慧。

本文旨在系统性地揭示高斯求积的理论与实践。我们将不仅回答“它是什么”，更要深入探讨“它为何如此高效”以及“如何正确地使用它”。通过三个层层递进的章节，读者将踏上一段从理论基础到前沿应用的探索之旅。

- 在**“原理与机制”**一章中，我们将回归第一性原理，探索一维高斯求积如何通过与正交多项式的巧妙结合，实现给定积分点数下的最高代数精度。我们将阐明其与牛顿-科茨等方法的区别，并展示如何通过张量积等方式将其推广至二维和三维问题。
- 接着，在**“应用与跨学科联系”**一章中，我们将把目光投向广阔的工程实践。你将学习如何为不同类型的有限元单元选择恰当的积分阶数，理解“[减缩积分](@entry_id:167949)”在克服“锁定”现象中的双面性，并见证[高斯积分](@entry_id:187139)点在[非线性固体力学](@entry_id:171757)、[流体力学](@entry_id:136788)以及[等几何分析](@entry_id:752839)等前沿领域中扮演的关键角色。
- 最后，在**“动手实践”**部分，我们提供了一系列精心设计的问题，旨在将理论知识转化为可操作的技能，加深你对[高斯求积](@entry_id:146011)在实际编程与分析中应用的理解。

通过本文的学习，你将掌握高斯求积的核心思想，并能将其灵活运用于解决复杂的有限元分析问题。

## 原理与机制

在[有限元分析](@entry_id:138109)中，构建[单元刚度矩阵](@entry_id:139369)、质量矩阵和[载荷向量](@entry_id:635284)等关键步骤，都归结为在单元域上对特定函数进行积分。例如，一个典型的单元积分形如 $\int_K \phi_i(\boldsymbol{x}) \phi_j(\boldsymbol{x}) d\boldsymbol{x}$ 或 $\int_K \nabla \phi_i(\boldsymbol{x}) \cdot \nabla \phi_j(\boldsymbol{x}) d\boldsymbol{x}$，其中 $\phi_i$ 是形函数。除了最简单的情况，这些积分通常无法通过解析方法精确求得，尤其是当涉及复杂的几何形状或变系数时。因此，必须依赖高效且准确的**[数值积分](@entry_id:136578)**（numerical integration），也称为**求积**（quadrature）。本章将深入探讨在有限元方法中占据核心地位的高斯求积（Gauss Quadrature）的原理、机制及其在多维问题中的应用。

### 一维参考区间上的高斯求积

为了标准化和简化计算，有限元中的积分通常通过坐标变换，在一个标准的**参考单元**（reference element）上执行。对于一维问题，这个参考区间通常是 $[-1, 1]$。因此，我们的核心任务是精确地近似积分 $I(f) = \int_{-1}^{1} f(x) dx$。

一个 $n$ 点求积公式具有如下形式：
$$
\int_{-1}^{1} f(x) \,dx \approx \sum_{i=1}^{n} w_i f(x_i)
$$
其中，$x_i$ 称为**求积节点**（quadrature nodes）或[高斯点](@entry_id:170251)，$w_i$ 称为**[求积权重](@entry_id:753910)**（quadrature weights）。此公式的**[代数精度](@entry_id:143382)**（degree of exactness）是指该公式能够精确积分的最高次多项式的次数 $m$。也就是说，对于任意次数不超过 $m$ 的多项式 $p(x)$，都有 $\int_{-1}^{1} p(x) dx = \sum_{i=1}^{n} w_i p(x_i)$。

#### 追求最优精度：[高斯求积](@entry_id:146011)的诞生

在一个 $n$ 点[求积公式](@entry_id:753909)中，我们有 $2n$ 个自由参数可供支配：$n$ 个节点 $x_i$ 和 $n$ 个权重 $w_i$。一个自然而深刻的问题是：我们能否通过精心选择这些参数，来最大化求积公式的[代数精度](@entry_id:143382)？

我们可以用这 $2n$ 个自由度来满足 $2n$ 个约束条件。一个直接的想法是，要求公式对[基函数](@entry_id:170178)（monomial basis）$\{1, x, x^2, \dots, x^{2n-1}\}$ 都精确成立。如果能做到这一点，那么根据线性性，该公式将对所有次数不超过 $2n-1$ 的多项式都精确。这意味着我们可以期望达到的最高[代数精度](@entry_id:143382)为 $2n-1$。

事实证明，这个目标是可以实现的，而实现它的关键在于节点 $x_i$ 的非[均匀分布](@entry_id:194597)。这种最优的求积方法，就是**[高斯求积](@entry_id:146011)**。其核心思想是，通过放弃对节点位置的预先指定（例如等距[分布](@entry_id:182848)），来换取更高的精度。

#### 正交多项式：高斯求积的理论基石

要实现 $2n-1$ 的代数精度，其节点和权重的选择并非任意，而是与正交多项式理论紧密相连。考虑一个任意次数 $\le 2n-1$ 的多项式 $p(x)$。我们定义一个**节点多项式**（nodal polynomial） $\pi_n(x) = \prod_{i=1}^{n} (x-x_i)$。通过[多项式除法](@entry_id:151800)，可将 $p(x)$ 写为：
$$
p(x) = q(x)\pi_n(x) + r(x)
$$
其中 $q(x)$ 和 $r(x)$ 的次数均不超过 $n-1$。对上式进行积分，我们得到：
$$
\int_{-1}^{1} p(x) dx = \int_{-1}^{1} q(x)\pi_n(x) dx + \int_{-1}^{1} r(x) dx
$$
而求积公式作用于 $p(x)$ 时，由于 $x_i$ 是 $\pi_n(x)$ 的根，$\pi_n(x_i)=0$，因此 $p(x_i) = r(x_i)$。求积和为：
$$
\sum_{i=1}^{n} w_i p(x_i) = \sum_{i=1}^{n} w_i r(x_i)
$$
如果我们预先构造[求积公式](@entry_id:753909)，使其至少对所有次数 $\le n-1$ 的多项式精确（这类公式称为插值型求积），那么对于次数 $\le n-1$ 的 $r(x)$，我们有 $\int_{-1}^{1} r(x) dx = \sum_{i=1}^{n} w_i r(x_i)$。在这种情况下，要使求积公式对 $p(x)$ 精确，必须满足：
$$
\int_{-1}^{1} q(x)\pi_n(x) dx = 0
$$
由于 $q(x)$ 是任意一个次数 $\le n-1$ 的多项式，这个条件意味着节点多项式 $\pi_n(x)$ 必须与区间 $[-1,1]$ 上所有次数小于 $n$ 的多项式**正交**（orthogonal）。

在权重函数为 $w(x)=1$ 的标准 $L^2$ [内积](@entry_id:158127)下，满足这种正交性的多项式族正是**勒让德多项式**（Legendre polynomials） $\{P_k(x)\}_{k \ge 0}$。$P_n(x)$ 是一个 $n$ 次多项式，它与任何次数小于 $n$ 的多项式在 $[-1,1]$ 上都是正交的。因此，为了满足上述正交条件，节点多项式 $\pi_n(x)$ 必须是勒让德多项式 $P_n(x)$ 的一个常数倍。这意味着，[高斯求积](@entry_id:146011)的节点 $x_i$ 必须是 $n$ 次[勒让德多项式](@entry_id:141510) $P_n(x)$ 的 $n$ 个根。这些根都是位于 $(-1, 1)$ 内的实数且互不相同。

综上，我们可以给出**高斯-勒让德（Gauss-Legendre）求积**的严格定义 [@problem_id:2561957]：
一个 $n$ 点[高斯-勒让德求积](@entry_id:138201)公式 $Q_n(f)=\sum_{i=1}^{n} w_i f(x_i)$ 的节点 $\{x_i\}$ 是 $n$ 次勒让德多项式 $P_n(x)$ 的 $n$ 个不同零点。其对应的权重 $\{w_i\}$ 是唯一确定的正数。该公式的[代数精度](@entry_id:143382)恰好为 $2n-1$。

这个 $2n-1$ 的精度是无法超越的。考虑多项式 $[P_n(x)]^2$，其次数为 $2n$。它的精确积分为 $\int_{-1}^{1} [P_n(x)]^2 dx > 0$，但[求积公式](@entry_id:753909)给出的值为 $\sum w_i [P_n(x_i)]^2 = 0$，因为所有节点都是 $P_n(x)$ 的根。因此，公式对这个 $2n$ 次多项式不精确。

[高斯求积](@entry_id:146011)的误差项也有一个精确的表达式。对于足够光滑的函数 $f \in C^{2n}([-1,1])$，其误差可以表示为：
$$
\int_{-1}^{1} f(x) dx - \sum_{i=1}^{n} w_i f(x_i) = \frac{f^{(2n)}(\xi)}{(2n)!} \int_{-1}^{1} [\pi_n(x)]^2 dx
$$
其中 $\xi \in (-1,1)$ [@problem_id:2561957]。由于权重 $w_i$ 均为正，[高斯求积](@entry_id:146011)在数值上是稳定的，不会像高阶牛顿-科茨公式那样因权重的正负交替而放大[舍入误差](@entry_id:162651)。

#### 与牛顿-科茨公式的对比

为了更好地理解高斯求积的优越性，我们可以将其与更直观的**牛顿-科茨（Newton-Cotes）公式**进行比较 [@problem_id:2562005]。牛顿-科茨公式（如梯形法则、辛普森法则）的节点是预先固定的[等距点](@entry_id:637779)。例如，一个闭合型 $N$ 点牛顿-科茨公式的节点[均匀分布](@entry_id:194597)在 $[-1,1]$ 上，包括两个端点。

- **精度**：对于 $N$ 个节点，高斯-[勒让德公式](@entry_id:266714)的精度为 $2N-1$。而牛顿-科茨公式的精度至多为 $N$（当 $N$ 为奇数时）或 $N-1$（当 $N$ 为偶数时）。显然，高斯求积的效率远高于牛顿-科茨。
- **稳定性**：高斯-[勒让德公式](@entry_id:266714)的所有权重始终为正。而对于牛顿-科茨公式，当节点数 $N \ge 8$ 时，会出现负权重，并且随着 $N$ 的增大，权重的[绝对值](@entry_id:147688)会剧烈[振荡](@entry_id:267781)，导致数值不稳定（类似于龙格现象）。

在有限元方法中，我们追求用最少的计算量（即最少的求积点）达到所需的积分精度，因此[高斯求积](@entry_id:146011)几乎成为不二之选。

#### 更广泛的视角：高斯型求积族

[高斯-勒让德求积](@entry_id:138201)是权重函数 $w(x)=1$ 的特例。实际上，对于 $[-1,1]$ 上的任何一个正的权重函数 $w(x)$，只要其矩存在，我们都可以定义一个[内积](@entry_id:158127) $\langle f,g \rangle = \int_{-1}^1 f(x)g(x)w(x)dx$，并由此构建一族相应的[正交多项式](@entry_id:146918)。然后，取 $n$ 次正交多项式的根作为节点，即可构造一个 $n$ 点的高斯型求积，其对于积分 $\int_{-1}^1 p(x)w(x)dx$ 的[代数精度](@entry_id:143382)同样为 $2n-1$。

一个重要的推广是**高斯-[雅可比](@entry_id:264467)（Gauss-Jacobi）求积**，其权重函数为 $w_{\alpha,\beta}(x) = (1-x)^\alpha (1+x)^\beta$，其中 $\alpha, \beta > -1$ [@problem_id:2562002]。其节点是 $n$ 次[雅可比多项式](@entry_id:197425) $P_n^{(\alpha,\beta)}(x)$ 的根。[高斯-勒让德求积](@entry_id:138201)是 $\alpha=\beta=0$ 的特例。

在雅可比族中，还有两个在工程中特别有用的变体 [@problem_id:2561996]：
1.  **高斯-洛巴托（Gauss-Lobatto）求积**：节点中强制包含区间的两个端点 $-1$ 和 $1$。一个 $n$ 点的洛巴托求积，其内部的 $n-2$ 个节点是 $P_{n-1}'(x)$ 的根（这里 $P_{n-1}$ 是[勒让德多项式](@entry_id:141510)）。由于固定了两个节点，其自由度减少，[代数精度](@entry_id:143382)降为 $2n-3$。
2.  **高斯-拉道（Gauss-Radau）求积**：节点中强制包含一个端点（例如 $-1$）。一个 $n$ 点的拉道求积，其[代数精度](@entry_id:143382)为 $2n-2$。

这些包含端点节点的规则在特定应用中非常有用，例如在谱方法和间断伽辽金（Discontinuous Galerkin, DG）方法中，需要在单元边界上计算通量。此外，[高斯-洛巴托节点](@entry_id:749738)常被用作高阶有限元（[谱元法](@entry_id:755171)）的插值节点，当使用与之匹配的洛巴托求积时，可以得到对角的[质量矩阵](@entry_id:177093)（称为**[质量集中](@entry_id:175432)** a "mass lumping"），极大地方便了时间依赖问题的求解。但需要注意的是，这种做法通常是一种近似，除非求积点数足够多以保证精确积分。

#### 节点和权重的计算

[高斯求积的节点和权重](@entry_id:636148)并非凭空而来。它们可以通过求解一个与正交多项式相关的**[雅可比矩阵](@entry_id:264467)**（Jacobi matrix）的[特征值问题](@entry_id:142153)来高效计算，这种算法被称为**[Golub-Welsch算法](@entry_id:749964)** [@problem_id:2561961]。

正交多项式族满足一个[三项递推关系](@entry_id:176845)。对于标准化的勒让德多项式，这个关系可以写成对称形式 $x q_k(x) = a_{k+1} q_{k+1}(x) + a_k q_{k-1}(x)$。这个递推关系可以用一个 $n \times n$ 的[对称三对角矩阵](@entry_id:755732)（即[雅可比矩阵](@entry_id:264467) $J_n$）来表示。可以证明，该矩阵的 $n$ 个[特征值](@entry_id:154894)恰好是 $n$ 点[高斯求积](@entry_id:146011)的 $n$ 个节点 $\{x_i\}$，而对应[特征向量](@entry_id:151813)的分量则可以用来计算出相应的权重 $\{w_i\}$。例如，权重 $w_i$ 与对应于[特征值](@entry_id:154894) $x_i$ 的归一化[特征向量](@entry_id:151813)的第一个分量的平方成正比。

### 在有限元中的应用

现在我们把这些理论工具应用于实际的有限元计算中。

#### 从参考单元到物理单元的映射

有限元计算是在**物理单元**（physical element），例如 $[a, b]$ 上进行的，而我们的高斯求积法则是在参考区间 $[-1, 1]$ 上定义的。因此，需要一个映射来连接两者 [@problem_id:2561921]。

对于一维线性元，我们定义一个唯一的[仿射映射](@entry_id:746332) $T: \xi \in [-1, 1] \to x \in [a, b]$：
$$
x = T(\xi) = \frac{a+b}{2} + \frac{b-a}{2}\xi
$$
这个映射将参考区间的中点 $0$ 映到物理区间的中点 $\frac{a+b}{2}$，将参考区间的长度 $2$ 缩放到物理区间的长度 $b-a$。

根据积分换元法，我们有 $dx = T'(\xi) d\xi = \frac{b-a}{2} d\xi$。这个常数 $J = \frac{b-a}{2}$ 就是变换的**雅可比行列式**（Jacobian determinant）。物理单元上的积分可以转换为参考区间上的积分：
$$
\int_a^b f(x) dx = \int_{-1}^1 f(T(\xi)) \frac{b-a}{2} d\xi
$$
现在，我们可以对右侧的积分应用标准的高斯求积公式：
$$
\int_a^b f(x) dx \approx \sum_{i=1}^n w_i^{\text{ref}} \left( f(T(\xi_i^{\text{ref}})) \frac{b-a}{2} \right)
$$
其中 $\{\xi_i^{\text{ref}}, w_i^{\text{ref}}\}$ 是参考区间上的节点和权重。我们可以将此式重新整理为在物理单元上的求积形式 $\sum_{i=1}^n \hat{w}_i f(\hat{x}_i)$，其中：
- **物理节点**： $\hat{x}_i = T(\xi_i^{\text{ref}}) = \frac{a+b}{2} + \frac{b-a}{2}\xi_i^{\text{ref}}$
- **物理权重**： $\hat{w}_i = w_i^{\text{ref}} \cdot \frac{b-a}{2} = w_i^{\text{ref}} \cdot J$

这个简单的变换规则是有限元程序实现数值积分的基础。例如，如果一个 $n$ 点[高斯-勒让德求积](@entry_id:138201)法则在[参考单元](@entry_id:168425)上对次数 $\le 2n-1$ 的多项式精确，那么经过[仿射变换](@entry_id:144885)后，它在物理单元 $[a,b]$ 上也同样对次数 $\le 2n-1$ 的多项式精确。这一点至关重要，它保证了我们可以在所有单元上使用同一套参考求积点和权重，只需进行简单的缩放和平移。

#### 推广至高维：[张量积法则](@entry_id:177156)

对于二维和三维问题，最常见的参考单元是正方形 $[-1,1]^2$ 和立方体 $[-1,1]^3$。在这些**张量积结构**（tensor-product structure）的域上，我们可以通过一维求积法则构造多维求积法则 [@problem_id:2561995]。

以二维为例，积分 $\int_{-1}^1 \int_{-1}^1 f(x,y) dx dy$ 可以写成[累次积分](@entry_id:144407) $\int_{-1}^1 \left(\int_{-1}^1 f(x,y) dx\right) dy$。我们可以对内外两层积分分别使用一维[高斯求积](@entry_id:146011)。假设在 $x$ 和 $y$ 方向我们都使用 $n$ 点一维[高斯-勒让德法则](@entry_id:636900) $\{\xi_i, w_i\}_{i=1}^n$。
$$
\begin{align*}
\int_{-1}^1 \int_{-1}^1 f(x,y) \,dx\,dy  \approx \int_{-1}^1 \left( \sum_{i=1}^n w_i f(\xi_i, y) \right) dy \\
 \approx \sum_{j=1}^n w_j \left( \sum_{i=1}^n w_i f(\xi_i, \xi_j) \right) \\
 = \sum_{i=1}^n \sum_{j=1}^n (w_i w_j) f(\xi_i, \xi_j)
\end{align*}
$$
这就构成了一个二维的**[张量积求积](@entry_id:145940)法则**。其节点是所有一维节点的笛卡尔积 $(\xi_i, \xi_j)$，共有 $n \times n$ 个点。对应的权重是相应一维权重的乘积 $w_i w_j$。这个思想可以直接推广到三维（$n \times n \times n$ 个点）乃至更高维度。

[张量积法则](@entry_id:177156)的代数精度也继承自一维法则。如果一维[高斯-勒让德法则](@entry_id:636900)对次数 $\le 2n-1$ 的多项式精确，那么 $d$ 维[张量积法则](@entry_id:177156)能够精确积分所有形如 $p(x_1, \dots, x_d) = \prod_{k=1}^d p_k(x_k)$ 的可分离变量多项式，只要每个 $p_k(x_k)$ 的次数 $\le 2n-1$ [@problem_id:2561995]。更一般地，它能精确积分所有在每个坐标变量 $x_k$ 上的次数都不超过 $2n-1$ 的多项式。

#### 超越[张量积](@entry_id:140694)：单纯形上的求积

对于三角形和四面体等**单纯形**（simplex）[参考单元](@entry_id:168425)，由于其几何形状不具备张量积结构，无法直接使用[张量积法则](@entry_id:177156)。在这种情况下，我们需要专门为这些区域构造的**[求积法则](@entry_id:753909)**（cubature rules）[@problem_id:2561944]。

与[张量积法则](@entry_id:177156)关注每个坐标的次数不同，单纯形上的求积法则通常以其能精确积分的**总次数**（total degree） $m$ 来衡量。也就是说，一个 $m$ 次精度的求积法则，能够精确积分所有形如 $x^i y^j$ (在2D情况下) 且满足 $i+j \le m$ 的单项式，并因此能精确积分所有总次数 $\le m$ 的多项式。

为单纯形寻找具有最少节点数的最优[求积法则](@entry_id:753909)是一个仍在研究中的复杂数学问题，不存在像一维高斯求积那样统一而优美的理论。然而，在有限元文献中有大量已经构造好的、适用于不同精度要求的高效[求积法则](@entry_id:753909)可供查阅和使用。

### 高级主题与理论启示

#### 弯曲单元上的求积：[等参映射](@entry_id:173239)

在前面的讨论中，我们假设物理单元是通过[仿射映射](@entry_id:746332)从[参考单元](@entry_id:168425)得到的。然而，为了精确地拟合弯曲的几何边界，高阶有限元方法常常使用**[等参单元](@entry_id:173863)**（isoparametric elements）。在这种情况下，从[参考单元](@entry_id:168425) $\hat{K}$到物理单元 $K$ 的映射 $F: \hat{\boldsymbol{\xi}} \to \boldsymbol{x}$ 本身就是一个高阶多项式，其次数 $p$ 与形函数的次数相同。

此时，[积分变换](@entry_id:186209)变为：
$$
\int_K f(\boldsymbol{x}) d\boldsymbol{x} = \int_{\hat{K}} f(F(\boldsymbol{\xi})) \det(DF(\boldsymbol{\xi})) d\boldsymbol{\xi}
$$
其中 $DF(\boldsymbol{\xi})$ 是映射 $F$ 的雅可比矩阵。现在，被积函数 $g(\boldsymbol{\xi}) = f(F(\boldsymbol{\xi})) \det(DF(\boldsymbol{\xi}))$ 的次数会显著增加 [@problem_id:2562023]。
- 复合函数 $f \circ F$：如果 $f$ 是一个 $m$ 次多项式，而映射 $F$ 是 $p$ 次多项式，那么[复合函数](@entry_id:147347) $f(F(\boldsymbol{\xi}))$ 的次数最高可达 $mp$。
- [雅可比行列式](@entry_id:137120) $\det(DF)$：由于 $F$ 是 $p$ 次多项式，其导数（[雅可比矩阵](@entry_id:264467)的元素）是 $p-1$ 次多项式。在 $d$ 维空间中，一个 $d \times d$ 矩阵的行列式是其元素的乘[积之和](@entry_id:266697)，因此 $\det(DF)$ 的次数最高可达 $d(p-1)$。

因此，整个被积函数 $g(\boldsymbol{\xi})$ 在每个坐标变量上的最高次数大约为 $mp + d(p-1)$。为了精确积分，一维高斯法则所需的点数 $n$ 必须满足 $2n-1 \ge mp + d(p-1)$。这表明，当使用高阶弯曲单元时，必须采用更高阶的求积法则才能保证积分的准确性。

#### “变分犯罪”：不精确积分与收敛性

在有限[元理论](@entry_id:638043)中，[伽辽金法](@entry_id:749698)的[误差分析](@entry_id:142477)通常假设所有积分都是精确计算的。然而，在实践中我们几乎总是使用[数值求积](@entry_id:136578)，这引入了额外的误差源。用求积代替精确积分，导致我们求解的离散问题 $a_h(u_h, v_h) = \ell_h(v_h)$ 与理论上的伽辽金方程 $a(u_h, v_h) = \ell(v_h)$ 不完全一致。这种因不精确积分而导致的理论与实践的偏离，在有限元文献中被戏称为**“变分犯罪”**（variational crime）。

幸运的是，这种“犯罪”的后果是可以控制的。**Strang第二引理**为我们提供了分析框架 [@problem_id:2561985]。该引理指出，总误差可以分解为三部分：
$$
\|u - u_h\|_V \le C \left( \inf_{w_h \in V_h} \|u - w_h\|_V + \sup_{v_h \in V_h} \frac{|a(u_h,v_h) - a_h(u_h,v_h)|}{\|v_h\|_V} + \sup_{v_h \in V_h} \frac{|\ell(v_h) - \ell_h(v_h)|}{\|v_h\|_V} \right)
$$
第一项是标准的**逼近误差**（approximation error），取决于有限元空间 $V_h$ 的逼近能力。第二项和第三项是**[相容性误差](@entry_id:747725)**（consistency error），它们度量了由于[数值求积](@entry_id:136578)导致的双线性和[线性形式](@entry_id:276136)的扰动。

为了不让求积误差破坏有限元方法原有的收敛阶，我们必须确保[相容性误差](@entry_id:747725)至少与逼近误差同阶或者更高阶。一个简单的策略是选择足够高阶的求积法则，使得[相容性误差](@entry_id:747725)项直接为零。

考虑一个使用次数为 $p$ 的形函数的问题。
- **刚度矩阵**：被积函数为 $\kappa \nabla w_h \cdot \nabla v_h$。如果 $\kappa$ 是一个 $q$ 次多项式，那么被积函数的总次数最高为 $q + 2(p-1)$。
- **[质量矩阵](@entry_id:177093)**：被积函数为 $\phi_i \phi_j$。其次数最高为 $2p$。
- **[载荷向量](@entry_id:635284)**：被积函数为 $f v_h$。如果 $f$ 是 $q_f$ 次多项式，则总次数最高为 $q_f+p$。

因此，为了消除[相容性误差](@entry_id:747725)，求积法则的代数精度 $r$ 必须满足 $r \ge \max(q+2p-2, q_f+p)$ [@problem_id:2561985]。例如，对于一个使用二次形函数（$p=2$）且材料系数为常数（$q=0$）的拉普拉斯问题，我们需要对刚度矩阵积分次数为 $0+2(2-1)=2$ 的多项式。一个 $n=2$ 点的[高斯-勒让德法则](@entry_id:636900)（精度为 $2(2)-1=3$）就足以精确积分刚度矩阵。而对于质量矩阵，我们需要积分次数为 $2p=4$ 的多项式，此时就需要 $n=3$ 点的高斯法则（精度为 $2(3)-1=5$）。

这个分析揭示了选择[求积法则](@entry_id:753909)的黄金准则：**[求积法则](@entry_id:753909)的阶数必须足够高，以精确积分所有在单元矩阵和向量计算中出现的被积函数，从而保证有限元解的收敛性不受[积分误差](@entry_id:171351)的影响**。这也是为什么高斯求积的原理和机制对于任何一个严谨的有限元实践者来说都是必不可少的知识。