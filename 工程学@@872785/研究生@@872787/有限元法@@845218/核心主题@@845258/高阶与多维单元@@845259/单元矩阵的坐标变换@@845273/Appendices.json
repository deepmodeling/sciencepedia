{"hands_on_practices": [{"introduction": "在有限元分析中，将计算从复杂的物理域转换到简单的参考域是一项核心技术。本练习将引导你为一个常见的工程几何——极坐标扇形——推导其雅可比矩阵和行列式[@problem_id:2550179]。掌握这一推导过程，是理解如何变换积分和导数，并最终精确计算单元矩阵的第一步。", "problem": "在二维问题的有限元方法中，通常方便在参考正方形 $[-1,1]^2$ 上执行数值积分，并映射到物理平面中的弯曲区域。考虑一个从参考坐标 $(\\xi,\\eta)\\in[-1,1]^2$ 到物理平面中一个极坐标扇形的映射，该扇形由径向和角向函数定义\n$$\nr(\\xi) = r_0 + \\frac{r_1 - r_0}{2}\\,(\\xi+1), \\qquad \\theta(\\eta) = \\theta_0 + \\frac{\\theta_1 - \\theta_0}{2}\\,(\\eta+1),\n$$\n其中 $r_00$，$r_1r_0$ 且 $\\theta_1\\theta_0$。角度以弧度为单位。物理域中一点的笛卡尔坐标 $(x,y)$ 由标准的极坐标到笛卡尔坐标转换关系给出\n$$\nx(\\xi,\\eta) = r(\\xi)\\cos\\big(\\theta(\\eta)\\big), \\qquad y(\\xi,\\eta) = r(\\xi)\\sin\\big(\\theta(\\eta)\\big).\n$$\n从雅可比矩阵定义为 $(x,y)$ 关于 $(\\xi,\\eta)$ 的一阶偏导数矩阵出发，并仅使用链式法则和弧度制下的三角函数微分法则，执行以下步骤：\n- 推导用 $r_0$、$r_1$、$\\theta_0$、$\\theta_1$、$\\xi$ 和 $\\eta$ 表示的显式映射 $(x(\\xi,\\eta),y(\\xi,\\eta))$。\n- 计算雅可比矩阵 $J(\\xi,\\eta) = \\partial(x,y)/\\partial(\\xi,\\eta)$。\n- 计算并化简其行列式的绝对值 $|\\det J(\\xi,\\eta)|$。\n\n最终答案请提供 $|\\det J(\\xi,\\eta)|$ 作为 $\\xi$ 和参数 $r_0$、$r_1$、$\\theta_0$ 和 $\\theta_1$ 的函数的完全化简解析表达式。最终答案中不要包含任何数值近似，也不要包含单位。", "solution": "尝试求解前，对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n已知信息如下：\n- 参考坐标： $(\\xi, \\eta) \\in [-1, 1]^2$。\n- 从参考坐标到极坐标的映射：\n  - 径向坐标：$r(\\xi) = r_0 + \\frac{r_1 - r_0}{2}\\,(\\xi+1)$\n  - 角坐标：$\\theta(\\eta) = \\theta_0 + \\frac{\\theta_1 - \\theta_0}{2}\\,(\\eta+1)$\n- 参数约束：$r_0  0$，$r_1  r_0$，$\\theta_1  \\theta_0$。角度以弧度为单位。\n- 从极坐标到笛卡尔坐标的映射：\n  - $x(\\xi,\\eta) = r(\\xi)\\cos\\big(\\theta(\\eta)\\big)$\n  - $y(\\xi,\\eta) = r(\\xi)\\sin\\big(\\theta(\\eta)\\big)$\n- 任务：推导 $(x, y)$ 的显式映射，计算雅可比矩阵 $J(\\xi,\\eta) = \\partial(x,y)/\\partial(\\xi,\\eta)$，并计算其行列式的化简绝对值 $|\\det J(\\xi,\\eta)|$。\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题的有效性进行评估。\n- **科学基础**：该问题描述了一种等参映射，这是有限元方法中将简单参考单元转换为更复杂物理单元的一种标准和基本技术。所涉及的数学工具——多变量微积分、雅可比矩阵和坐标变换——都是成熟的。该问题在科学和数学上是合理的。\n- **适定性**：该问题是适定的。提供了所有必要的函数和参数约束 ($r_00, r_1r_0, \\theta_1\\theta_0$)，以确保映射是唯一的、非退化的，并且雅可比行列式是良定义和可计算的。\n- **客观性**：该问题使用精确、无歧义的数学语言陈述，不含主观或非科学内容。\n\n### 步骤 3：结论与行动\n该问题有效。这是一个应用数学中的适定练习，具体涉及与连续介质力学和数值方法相关的向量微积分。将提供解答。\n\n按要求进行推导。\n\n首先，将给定的 $r(\\xi)$ 和 $\\theta(\\eta)$ 表达式代入，得到映射 $(x(\\xi,\\eta), y(\\xi,\\eta))$ 的显式形式：\n$$\nx(\\xi,\\eta) = \\left[r_0 + \\frac{r_1 - r_0}{2}\\,(\\xi+1)\\right] \\cos\\left[\\theta_0 + \\frac{\\theta_1 - \\theta_0}{2}\\,(\\eta+1)\\right]\n$$\n$$\ny(\\xi,\\eta) = \\left[r_0 + \\frac{r_1 - r_0}{2}\\,(\\xi+1)\\right] \\sin\\left[\\theta_0 + \\frac{\\theta_1 - \\theta_0}{2}\\,(\\eta+1)\\right]\n$$\n这就构成了显式映射。\n\n接下来，我们计算雅可比矩阵 $J(\\xi,\\eta)$，其定义为：\n$$\nJ(\\xi,\\eta) = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n为了计算该矩阵的元素，我们需要求 $x$ 和 $y$ 关于 $\\xi$ 和 $\\eta$ 的偏导数。我们使用链式法则。首先，我们求 $r$ 关于 $\\xi$ 的导数和 $\\theta$ 关于 $\\eta$ 的导数：\n$$\n\\frac{\\partial r}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left[r_0 + \\frac{r_1 - r_0}{2}\\,(\\xi+1)\\right] = \\frac{r_1 - r_0}{2}\n$$\n$$\n\\frac{\\partial \\theta}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left[\\theta_0 + \\frac{\\theta_1 - \\theta_0}{2}\\,(\\eta+1)\\right] = \\frac{\\theta_1 - \\theta_0}{2}\n$$\n现在我们计算雅可比矩阵的四个偏导数：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left[r(\\xi)\\cos(\\theta(\\eta))\\right] = \\frac{\\partial r}{\\partial \\xi} \\cos(\\theta(\\eta)) = \\frac{r_1 - r_0}{2} \\cos(\\theta(\\eta))\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left[r(\\xi)\\cos(\\theta(\\eta))\\right] = r(\\xi) \\left[-\\sin(\\theta(\\eta))\\right] \\frac{\\partial \\theta}{\\partial \\eta} = -r(\\xi) \\frac{\\theta_1 - \\theta_0}{2} \\sin(\\theta(\\eta))\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left[r(\\xi)\\sin(\\theta(\\eta))\\right] = \\frac{\\partial r}{\\partial \\xi} \\sin(\\theta(\\eta)) = \\frac{r_1 - r_0}{2} \\sin(\\theta(\\eta))\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left[r(\\xi)\\sin(\\theta(\\eta))\\right] = r(\\xi) \\cos(\\theta(\\eta)) \\frac{\\partial \\theta}{\\partial \\eta} = r(\\xi) \\frac{\\theta_1 - \\theta_0}{2} \\cos(\\theta(\\eta))\n$$\n组合这些分量，得到雅可比矩阵：\n$$\nJ(\\xi,\\eta) = \\begin{pmatrix}\n\\frac{r_1 - r_0}{2} \\cos(\\theta(\\eta))  -r(\\xi) \\frac{\\theta_1 - \\theta_0}{2} \\sin(\\theta(\\eta)) \\\\\n\\frac{r_1 - r_0}{2} \\sin(\\theta(\\eta))  r(\\xi) \\frac{\\theta_1 - \\theta_0}{2} \\cos(\\theta(\\eta))\n\\end{pmatrix}\n$$\n最后，我们计算 $J(\\xi,\\eta)$ 的行列式：\n$$\n\\det J(\\xi,\\eta) = \\left(\\frac{\\partial x}{\\partial \\xi}\\right)\\left(\\frac{\\partial y}{\\partial \\eta}\\right) - \\left(\\frac{\\partial x}{\\partial \\eta}\\right)\\left(\\frac{\\partial y}{\\partial \\xi}\\right)\n$$\n$$\n\\det J(\\xi,\\eta) = \\left(\\frac{r_1 - r_0}{2} \\cos(\\theta(\\eta))\\right) \\left(r(\\xi) \\frac{\\theta_1 - \\theta_0}{2} \\cos(\\theta(\\eta))\\right) - \\left(-r(\\xi) \\frac{\\theta_1 - \\theta_0}{2} \\sin(\\theta(\\eta))\\right) \\left(\\frac{r_1 - r_0}{2} \\sin(\\theta(\\eta))\\right)\n$$\n提出公因式：\n$$\n\\det J(\\xi,\\eta) = r(\\xi) \\left(\\frac{r_1 - r_0}{2}\\right) \\left(\\frac{\\theta_1 - \\theta_0}{2}\\right) \\left[\\cos^2(\\theta(\\eta)) + \\sin^2(\\theta(\\eta))\\right]\n$$\n使用基本三角恒等式 $\\cos^2(\\alpha) + \\sin^2(\\alpha) = 1$，上式可化简为：\n$$\n\\det J(\\xi,\\eta) = r(\\xi) \\frac{(r_1 - r_0)(\\theta_1 - \\theta_0)}{4}\n$$\n问题要求的是行列式的绝对值 $|\\det J(\\xi,\\eta)|$。我们必须分析行列式的符号。\n给定的约束条件是 $r_1  r_0$ 和 $\\theta_1  \\theta_0$。因此，$(r_1 - r_0)  0$ 且 $(\\theta_1 - \\theta_0)  0$。因子 $\\frac{(r_1 - r_0)(\\theta_1 - \\theta_0)}{4}$ 严格为正。\n径向函数 $r(\\xi)$ 是 $\\xi$ 在 $\\xi \\in [-1, 1]$ 上的线性函数。我们检查其在区间端点的值：\n在 $\\xi = -1$ 处，$r(-1) = r_0 + \\frac{r_1-r_0}{2}(-1+1) = r_0$。已知 $r_0  0$。\n在 $\\xi = 1$ 处，$r(1) = r_0 + \\frac{r_1-r_0}{2}(1+1) = r_0 + (r_1 - r_0) = r_1$。已知 $r_1  r_0  0$。\n由于 $r(\\xi)$ 是 $\\xi$ 的线性函数，并且在区间 $[-1, 1]$ 的边界上为正，因此对于所有 $\\xi \\in [-1, 1]$，它都必须为正。\n因此，对于参考域中的所有 $(\\xi, \\eta)$，$\\det J(\\xi,\\eta)$ 都是正量的乘积，所以它严格为正。因此， $|\\det J(\\xi,\\eta)| = \\det J(\\xi,\\eta)$。\n\n为了得到最终表达式，我们代入 $r(\\xi)$ 的定义并化简：\n$$\n|\\det J(\\xi,\\eta)| = \\left[r_0 + \\frac{r_1 - r_0}{2}(\\xi+1)\\right] \\frac{(r_1 - r_0)(\\theta_1 - \\theta_0)}{4}\n$$\n为了完全化简，我们展开括号内的项：\n$$\nr_0 + \\frac{r_1 - r_0}{2}(\\xi+1) = \\frac{2r_0 + (r_1 - r_0)\\xi + (r_1 - r_0)}{2} = \\frac{(r_1 - r_0)\\xi + r_1 + r_0}{2}\n$$\n将此代回行列式的表达式中：\n$$\n|\\det J(\\xi,\\eta)| = \\left(\\frac{(r_1 - r_0)\\xi + r_1 + r_0}{2}\\right) \\frac{(r_1 - r_0)(\\theta_1 - \\theta_0)}{4}\n$$\n$$\n|\\det J(\\xi,\\eta)| = \\frac{(r_1 - r_0)(\\theta_1 - \\theta_0)}{8} \\left((r_1 - r_0)\\xi + r_1 + r_0\\right)\n$$\n这就是雅可比行列式绝对值作为 $\\xi$ 和给定参数的函数的完全化简解析表达式。", "answer": "$$\n\\boxed{\\frac{(r_1 - r_0)(\\theta_1 - \\theta_0)}{8} \\left((r_1 - r_0)\\xi + r_1 + r_0\\right)}\n$$", "id": "2550179"}, {"introduction": "在掌握了二维映射的基本原理后，我们将把坐标变换的概念扩展到三维空间。本练习以一个六面体单元为例，展示了雅可比行列式在数值积分中的关键作用[@problem_id:2550229]。你将探索它如何缩放高斯求积的权重，从而准确地计算物理单元的体积，这是有限元计算中的一个基本任务。", "problem": "考虑一个在有限元法 (FEM) 中使用的单个六面体等参单元。该单元通过一个三线性（三仿射）映射 $F:\\hat{K}\\to K$ 从具有参考坐标 $(\\xi,\\eta,\\zeta)$ 的参考立方体 $\\hat{K} = [-1,1]^{3}$ 得到，其分量形式定义为\n$$\nx(\\xi,\\eta,\\zeta) = s\\,\\xi\\,(1+\\alpha\\,\\eta),\\qquad y(\\xi,\\eta,\\zeta) = t\\,\\eta,\\qquad z(\\xi,\\eta,\\zeta) = u\\,\\zeta,\n$$\n其中 $s0$, $t0$, $u0$ 和 $\\alpha\\in\\mathbb{R}$ 是常数。此映射与由单元的八个角节点定义的三线性等参插值一致。\n\n你的任务是：\n\n1. 从多重积分的变量替换定理出发，推导将区域 $K$ 上的积分映射到区域 $\\hat{K}$ 上的积分的变换法则，并指明雅可比矩阵 $J(\\xi,\\eta,\\zeta)$ 及其行列式 $\\det J(\\xi,\\eta,\\zeta)$ 的作用。\n\n2. 在 $\\hat{K}$ 上，考虑一个每个坐标方向有 $2$ 个点的张量积高斯-勒让德求积 (GLQ)。解释对于此六面体单元，如何将张量积求积点和权重从 $\\hat{K}$ 映射到 $K$，并指明修改每个张量积权重的因子是什么。\n\n3. 对于上述指定的映射，利用张量积结构，推导一个在所有 $2\\times 2\\times 2$ 个求积点上高效计算 $\\lvert\\det J\\rvert$ 的过程。然后，使用 $2\\times 2\\times 2$ 的 GLQ 法则，计算单元体积\n$$\n|K| \\;=\\; \\int_{K} 1\\,\\mathrm{d}x\\,\\mathrm{d}y\\,\\mathrm{d}z,\n$$\n参数值为 $s=2$，$t=3$，$u=\\tfrac{1}{2}$ 和 $\\alpha=\\tfrac{2}{5}$。将你的最终数值答案四舍五入到四位有效数字，并无单位报告。", "solution": "该问题的分析始于坐标变换的微积分基本定理，该定理构成了有限元法中等参单元积分的基础。该问题将按指定分为三个部分进行解答。\n\n从域 $K$ 中的物理坐标 $(x,y,z)$ 到域 $\\hat{K} = [-1,1]^3$ 中的参考坐标 $(\\xi,\\eta,\\zeta)$ 的变换由映射 $F(\\xi,\\eta,\\zeta)$ 给出。多重积分的变量替换定理建立了函数 $g$ 在这些域上积分的关系。\n\n**第1部分：积分变换法则**\n\n对于定义在物理单元 $K$ 上的任何可积函数 $g$，其积分使用以下公式变换到参考单元 $\\hat{K}$：\n$$\n\\int_K g(x,y,z)\\,\\mathrm{d}x\\,\\mathrm{d}y\\,\\mathrm{d}z = \\int_{\\hat{K}} g(F(\\xi,\\eta,\\zeta))\\, |\\det J(\\xi,\\eta,\\zeta)|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta.\n$$\n在此关系中，$J(\\xi,\\eta,\\zeta)$ 是映射 $F$ 的雅可比矩阵，定义为物理坐标关于参考坐标的一阶偏导数矩阵：\n$$\nJ(\\xi,\\eta,\\zeta) = \\frac{\\partial(x,y,z)}{\\partial(\\xi,\\eta,\\zeta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial x}{\\partial \\zeta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\zeta} \\\\ \\frac{\\partial z}{\\partial \\xi}  \\frac{\\partial z}{\\partial \\eta}  \\frac{\\partial z}{\\partial \\zeta} \\end{pmatrix}.\n$$\n项 $|\\det J|$ 是雅可比矩阵行列式的绝对值。它表示微分体积元的局部比率，使得物理体积元 $\\mathrm{d}V = \\mathrm{d}x\\,\\mathrm{d}y\\,\\mathrm{d}z$ 与参考体积元 $\\mathrm{d}\\hat{V} = \\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta$ 通过 $\\mathrm{d}V = |\\det J|\\,\\mathrm{d}\\hat{V}$ 相关联。\n\n对于给定的三线性映射：\n$$\nx(\\xi,\\eta,\\zeta) = s\\,\\xi\\,(1+\\alpha\\,\\eta)\n$$\n$$\ny(\\xi,\\eta,\\zeta) = t\\,\\eta\n$$\n$$\nz(\\xi,\\eta,\\zeta) = u\\,\\zeta\n$$\n我们计算必要的偏导数：\n$$\n\\frac{\\partial x}{\\partial \\xi} = s(1+\\alpha\\,\\eta), \\quad \\frac{\\partial x}{\\partial \\eta} = s\\alpha\\xi, \\quad \\frac{\\partial x}{\\partial \\zeta} = 0\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = 0, \\quad \\frac{\\partial y}{\\partial \\eta} = t, \\quad \\frac{\\partial y}{\\partial \\zeta} = 0\n$$\n$$\n\\frac{\\partial z}{\\partial \\xi} = 0, \\quad \\frac{\\partial z}{\\partial \\eta} = 0, \\quad \\frac{\\partial z}{\\partial \\zeta} = u\n$$\n得到的雅可比矩阵是上三角矩阵：\n$$\nJ(\\xi,\\eta,\\zeta) = \\begin{pmatrix} s(1+\\alpha\\eta)  s\\alpha\\xi  0 \\\\ 0  t  0 \\\\ 0  0  u \\end{pmatrix}.\n$$\n三角矩阵的行列式是其对角元素的乘积。因此，我们得到：\n$$\n\\det J(\\xi,\\eta,\\zeta) = [s(1+\\alpha\\eta)] \\cdot t \\cdot u = stu(1+\\alpha\\eta).\n$$\n为使映射有效（即在单元内可逆且保向），雅可比行列式必须在整个 $\\hat{K}$ 上严格为正。由于 $s,t,u  0$，这要求对于所有 $\\eta \\in [-1,1]$ 都有 $1+\\alpha\\eta  0$，这意味着条件 $1 - |\\alpha|  0$（即 $|\\alpha|  1$）必须成立。给定的参数 $\\alpha=2/5$ 满足此准则，因此 $\\det J  0$ 且 $|\\det J| = \\det J$。\n\n**第2部分：求积法则映射**\n\n在有限元法中，数值积分通常在参考单元上使用高斯-勒让德求积 (GLQ) 进行。对于每个方向有 $N_p=2$ 个点的张量积法则，$[-1,1]$ 上的一维积分近似为 $\\int_{-1}^{1} f(\\xi)\\,\\mathrm{d}\\xi \\approx \\sum_{i=1}^{2} f(\\xi_i) w_i$。对于 $N_p=2$，求积点为 $\\xi_1 = -1/\\sqrt{3}$，$\\xi_2 = 1/\\sqrt{3}$，相应的权重为 $w_1=w_2=1$。\n对于三维立方体 $\\hat{K}$，其 $2\\times 2\\times 2$ 张量积法则是：\n$$\n\\int_{\\hat{K}} h(\\xi,\\eta,\\zeta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta \\approx \\sum_{i=1}^{2} \\sum_{j=1}^{2} \\sum_{k=1}^{2} h(\\xi_i, \\eta_j, \\zeta_k) w_i w_j w_k.\n$$\n在 $\\hat{K}$ 中的 $8$ 个求积点是 $(\\xi_i, \\eta_j, \\zeta_k)$，其中每个坐标从 $\\{-1/\\sqrt{3}, 1/\\sqrt{3}\\}$ 中选取。每个点的张量积权重为 $w_{ijk} = w_i w_j w_k = 1 \\cdot 1 \\cdot 1 = 1$。\n\n为了近似计算物理单元 $K$ 上的积分，我们将变量替换公式与求积法则结合起来：\n$$\n\\int_K g(x,y,z)\\,\\mathrm{d}V = \\int_{\\hat{K}} g(F(\\xi,\\eta,\\zeta)) |\\det J(\\xi,\\eta,\\zeta)|\\,\\mathrm{d}\\hat{V} \\approx \\sum_{i,j,k} g(F(\\xi_i, \\eta_j, \\zeta_k)) |\\det J(\\xi_i, \\eta_j, \\zeta_k)| w_{ijk}.\n$$\n物理域 $K$ 中的求积点是参考点的像，即 $P_{ijk} = F(\\xi_i, \\eta_j, \\zeta_k)$。函数 $g$ 在这些映射点上求值。每个点对总和的贡献是函数值、参考权重 $w_{ijk}$ 和在求积点 $(\\xi_i, \\eta_j, \\zeta_k)$ 处计算的雅可比行列式 $|\\det J|$ 的乘积。\n因此，修改每个张量积权重 $w_{ijk}$ 的因子正是局部体积比 $|\\det J(\\xi_i, \\eta_j, \\zeta_k)|$。\n\n**第3部分：高效计算与体积求解**\n\n推导出的表达式 $\\det J = stu(1+\\alpha\\eta)$ 仅依赖于参考坐标 $\\eta$。这一结构特性使得我们可以在 $8$ 个 GLQ 点上高效地计算 $|\\det J|$。这些点可以根据其 $\\eta$ 坐标（取值为 $\\eta_1 = -1/\\sqrt{3}$ 和 $\\eta_2 = 1/\\sqrt{3}$）分为两组，每组 $4$ 个点。\n对于 $\\eta = \\eta_1$ 的四个点，雅可比行列式有唯一的值 $|\\det J|_1 = |stu(1 - \\alpha/\\sqrt{3})|$。\n对于 $\\eta = \\eta_2$ 的四个点，雅可比行列式有唯一的值 $|\\det J|_2 = |stu(1 + \\alpha/\\sqrt{3})|$。\n高效的计算过程包括仅计算这两个不同的值，并将它们分配给相应的求积点集，从而将 $8$ 次计算减少到 $2$ 次。\n\n为了计算单元体积 $|K|$，我们在域 $K$ 上对函数 $g=1$ 进行积分：\n$$\n|K| = \\int_K 1\\,\\mathrm{d}V = \\int_{\\hat{K}} |\\det J(\\xi,\\eta,\\zeta)|\\,\\mathrm{d}\\hat{V}.\n$$\n使用 $2\\times 2\\times 2$ 的 GLQ 法则，这变为：\n$$\n|K| \\approx \\sum_{i=1}^2 \\sum_{j=1}^2 \\sum_{k=1}^2 |\\det J(\\xi_i, \\eta_j, \\zeta_k)| w_i w_j w_k.\n$$\n由于权重 $w_i, w_j, w_k$ 都为 $1$，并且 $|\\det J|$ 与 $\\xi$ 和 $\\zeta$ 无关，求和可以简化。对 $i$ 和 $k$ 的求和贡献了一个因子 $2 \\times 2 = 4$。\n$$\n|K| \\approx 4 \\sum_{j=1}^2 |\\det J(\\eta_j)| = 4 \\left( |\\det J(\\eta_1)| + |\\det J(\\eta_2)| \\right).\n$$\n代入 $|\\det J|$ 在 $\\eta_1 = -1/\\sqrt{3}$ 和 $\\eta_2 = 1/\\sqrt{3}$ 处的表达式：\n$$\n|K| \\approx 4 \\left( |stu(1 - \\alpha/\\sqrt{3})| + |stu(1 + \\alpha/\\sqrt{3})| \\right).\n$$\n如前所述，对于 $\\alpha=2/5$，$|\\alpha|1$，所以绝对值内的项是正的。我们可以去掉绝对值符号。\n$$\n|K| \\approx 4 stu \\left( (1 - \\alpha/\\sqrt{3}) + (1 + \\alpha/\\sqrt{3}) \\right) = 4 stu (2) = 8stu.\n$$\n这个结果是精确的。$2$ 点 GLQ 法则能精确积分最高 $2(2)-1=3$ 次的多项式。被积函数 $|\\det J| = stu(1+\\alpha\\eta)$ 是一个关于 $\\eta$ 的 $1$ 次多项式，关于 $\\xi$ 和 $\\zeta$ 的 $0$ 次多项式，因此求积得到的是精确的解析结果。\n\n最后，我们代入指定的参数值 $s=2$, $t=3$, 和 $u=1/2$:\n$$\n|K| = 8stu = 8 \\cdot (2) \\cdot (3) \\cdot \\left(\\frac{1}{2}\\right) = 8 \\cdot 3 = 24.\n$$\n问题要求将答案四舍五入到四位有效数字。精确整数 $24$ 报告为 $24.00$。", "answer": "$$\n\\boxed{24.00}\n$$", "id": "2550229"}, {"introduction": "一个有效的有限元映射要求雅可比行列式 $\\det \\mathbf{J}$ 的值在整个单元内严格为正。这个高级练习探讨了一个病态情况：当单元几何形状变得“反转”时，会导致映射的雅可比行列式在某一点为零[@problem_id:2550222]。通过分析这种情况，你将揭示无效映射在数学和数值计算上带来的后果，这对于网格生成和结果分析至关重要。", "problem": "考虑在有限元方法 (FEM) 中，二维线性弹性力学下的一个 $4$ 节点双线性等参四边形单元。令母（参考）坐标为 $(\\xi,\\eta)\\in[-1,1]^2$，并使用标准的双线性形函数\n$$\nN_{1}(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_{2}(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_{3}(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_{4}(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1+\\eta).\n$$\n通过以下方式映射到物理空间\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)X_i,\\qquad\ny(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)Y_i,\n$$\n节点坐标为\n$$\n(X_1,Y_1)=(0,0),\\quad (X_2,Y_2)=(2,0),\\quad (X_3,Y_3)=(2,2),\\quad (X_4,Y_4)=\\left(\\tfrac{4}{3},-\\tfrac{2}{3}\\right).\n$$\n令 $\\mathbf{J}(\\xi,\\eta)$ 表示映射的雅可比矩阵，$\\det\\mathbf{J}(\\xi,\\eta)$ 表示其行列式。在二维平面应变各向同性线性弹性力学中，拉梅参数 (Lamé parameters) 为 $(\\lambda,\\mu)$，本构矩阵为\n$$\n\\mathbf{C}=\n\\begin{pmatrix}\n\\lambda+2\\mu  \\lambda  0\\\\\n\\lambda  \\lambda+2\\mu  0\\\\\n0  0  \\mu\n\\end{pmatrix}.\n$$\n令 $\\mathbf{B}(\\xi,\\eta)$ 为 $3\\times 8$ 的应变-位移矩阵，该矩阵通过链式法则由形函数的物理梯度构建，并使用工程剪应变约定。\n\n1. 从映射定义和坐标变换的链式法则出发，证明存在一点 $(\\xi,\\eta)=(0,0)$ 使得 $\\det\\mathbf{J}(0,0)=0$，并确定 $\\det\\mathbf{J}(\\xi,\\eta)$ 在 $(0,0)$ 邻域内的一阶展开式。根据该线性化的符号结构，推断该单元在 $(0,0)$ 的一个邻域内是反转的。\n\n2. 考虑刚度矩阵的被积函数 $\\mathbf{B}(\\xi,\\eta)^{\\mathsf{T}}\\mathbf{C}\\,\\mathbf{B}(\\xi,\\eta)\\,\\det\\mathbf{J}(\\xi,\\eta)$。关注其 $(1,1)$ 分量（对应于节点 $1$ 的 $x$ 方向位移自由度），定义标量场\n$$\nI_{11}(\\xi,\\eta)=\\left[\\mathbf{B}(\\xi,\\eta)^{\\mathsf{T}}\\mathbf{C}\\,\\mathbf{B}(\\xi,\\eta)\\,\\det\\mathbf{J}(\\xi,\\eta)\\right]_{(1,1)}.\n$$\n仅使用映射、雅可比矩阵、梯度链式法则和线性弹性本构关系的基本定义，确定以下有限极限\n$$\nL=\\lim_{(\\xi,\\eta)\\to(0,0)}\\left(\\det\\mathbf{J}(\\xi,\\eta)\\right)\\,I_{11}(\\xi,\\eta),\n$$\n并将您的最终答案表示为关于 $\\lambda$ 和 $\\mu$ 的封闭形式解析表达式。无需进行数值计算。给出 $L$ 的最终结果；无需四舍五入。", "solution": "在尝试求解之前，需要对所述问题进行验证。\n\n**第1步：提取已知条件**\n- 单元：$4$ 节点双线性等参四边形。\n- 母坐标：$(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$。\n- 形函数：\n  $N_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)$,\n  $N_{2}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta)$,\n  $N_{3}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta)$,\n  $N_{4}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta)$。\n- 映射：$x(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)X_i$, $y(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)Y_i$。\n- 节点坐标：$(X_1,Y_1)=(0,0)$, $(X_2,Y_2)=(2,0)$, $(X_3,Y_3)=(2,2)$, $(X_4,Y_4)=(\\frac{4}{3},-\\frac{2}{3})$。\n- 雅可比矩阵：$\\mathbf{J}(\\xi,\\eta)$。\n- 材料模型：二维平面应变各向同性线性弹性。\n- 本构矩阵：$\\mathbf{C}= \\begin{pmatrix} \\lambda+2\\mu  \\lambda  0\\\\ \\lambda  \\lambda+2\\mu  0\\\\ 0  0  \\mu \\end{pmatrix}$。\n- 应变-位移矩阵：$\\mathbf{B}(\\xi,\\eta)$，一个 $3\\times8$ 矩阵。\n- 任务1：证明 $\\det\\mathbf{J}(0,0)=0$，求出 $\\det\\mathbf{J}(\\xi,\\eta)$ 在 $(0,0)$ 附近的一阶展开式，并分析单元反转情况。\n- 任务2：定义 $I_{11}(\\xi,\\eta)=\\left[\\mathbf{B}(\\xi,\\eta)^{\\mathsf{T}}\\mathbf{C}\\,\\mathbf{B}(\\xi,\\eta)\\,\\det\\mathbf{J}(\\xi,\\eta)\\right]_{(1,1)}$ 并求极限 $L=\\lim_{(\\xi,\\eta)\\to(0,0)}\\left(\\det\\mathbf{J}(\\xi,\\eta)\\right)\\,I_{11}(\\xi,\\eta)$。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，属于线性弹性有限元方法的标准理论范畴。所有概念——形函数、等参映射、雅可比矩阵、本构关系和应变-位移矩阵——都是标准的。指定的节点坐标描述了一个非凸（凹角）四边形，其雅可比矩阵在母域内部可能为奇异。分析在这种奇点处的行为是数值分析中一个有效且重要的课题。该问题是适定的，提供了所有必要信息，并且其语言客观而精确。它不违反任何无效性标准。\n\n**第3步：结论与行动**\n问题有效。将提供解答。\n\n我们首先构建从母单元到物理单元的坐标映射。\n物理空间中的 $x$ 和 $y$ 坐标由下式给出：\n$$x(\\xi,\\eta) = N_{1}(\\xi,\\eta)X_{1} + N_{2}(\\xi,\\eta)X_{2} + N_{3}(\\xi,\\eta)X_{3} + N_{4}(\\xi,\\eta)X_{4}$$\n$$y(\\xi,\\eta) = N_{1}(\\xi,\\eta)Y_{1} + N_{2}(\\xi,\\eta)Y_{2} + N_{3}(\\xi,\\eta)Y_{3} + N_{4}(\\xi,\\eta)Y_{4}$$\n代入给定的节点坐标：\n$$x(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)(2) + \\frac{1}{4}(1+\\xi)(1+\\eta)(2) + \\frac{1}{4}(1-\\xi)(1+\\eta)\\left(\\frac{4}{3}\\right)$$\n$$x(\\xi,\\eta) = \\frac{1}{2}(1+\\xi)(1-\\eta+1+\\eta) + \\frac{1}{3}(1-\\xi)(1+\\eta) = (1+\\xi) + \\frac{1}{3}(1+\\eta-\\xi-\\xi\\eta) = \\frac{4}{3}+\\frac{2}{3}\\xi+\\frac{1}{3}\\eta-\\frac{1}{3}\\xi\\eta$$\n$$y(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)(2) + \\frac{1}{4}(1-\\xi)(1+\\eta)\\left(-\\frac{2}{3}\\right)$$\n$$y(\\xi,\\eta) = \\frac{1}{2}(1+\\xi)(1+\\eta) - \\frac{1}{6}(1-\\xi)(1+\\eta) = \\frac{1}{6}(1+\\eta)(3(1+\\xi)-(1-\\xi)) = \\frac{1}{6}(1+\\eta)(2+4\\xi) = \\frac{1}{3}(1+\\eta)(1+2\\xi)$$\n$$y(\\xi,\\eta) = \\frac{1}{3}(1+2\\xi+\\eta+2\\xi\\eta) = \\frac{1}{3} + \\frac{2}{3}\\xi + \\frac{1}{3}\\eta + \\frac{2}{3}\\xi\\eta$$\n变换的雅可比矩阵为 $\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}$。我们计算偏导数：\n$$\\frac{\\partial x}{\\partial \\xi} = \\frac{2}{3}-\\frac{1}{3}\\eta, \\quad \\frac{\\partial x}{\\partial \\eta} = \\frac{1}{3}-\\frac{1}{3}\\xi$$\n$$\\frac{\\partial y}{\\partial \\xi} = \\frac{2}{3}+\\frac{2}{3}\\eta, \\quad \\frac{\\partial y}{\\partial \\eta} = \\frac{1}{3}+\\frac{2}{3}\\xi$$\n所以，雅可比矩阵是：\n$$\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} \\frac{2}{3}-\\frac{1}{3}\\eta  \\frac{1}{3}-\\frac{1}{3}\\xi \\\\ \\frac{2}{3}+\\frac{2}{3}\\eta  \\frac{1}{3}+\\frac{2}{3}\\xi \\end{pmatrix}$$\n雅可比矩阵的行列式是：\n$$\\det\\mathbf{J}(\\xi,\\eta) = \\left(\\frac{2}{3}-\\frac{1}{3}\\eta\\right)\\left(\\frac{1}{3}+\\frac{2}{3}\\xi\\right) - \\left(\\frac{1}{3}-\\frac{1}{3}\\xi\\right)\\left(\\frac{2}{3}+\\frac{2}{3}\\eta\\right)$$\n$$\\det\\mathbf{J}(\\xi,\\eta) = \\frac{1}{9} \\left[ (2-\\eta)(1+2\\xi) - (1-\\xi)(2+2\\eta) \\right]$$\n$$\\det\\mathbf{J}(\\xi,\\eta) = \\frac{1}{9} \\left[ (2+4\\xi-\\eta-2\\xi\\eta) - (2+2\\eta-2\\xi-2\\xi\\eta) \\right]$$\n$$\\det\\mathbf{J}(\\xi,\\eta) = \\frac{1}{9} (6\\xi - 3\\eta) = \\frac{2}{3}\\xi - \\frac{1}{3}\\eta$$\n这完成了任务1的第一部分。在母单元的中心 $(\\xi,\\eta)=(0,0)$ 处，行列式为 $\\det\\mathbf{J}(0,0) = \\frac{2}{3}(0) - \\frac{1}{3}(0) = 0$。$\\det\\mathbf{J}(\\xi,\\eta)$ 的表达式已经是关于 $\\xi$ 和 $\\eta$ 的线性函数，因此它本身就是其在 $(0,0)$ 附近的一阶展开式。对于 $(0,0)$ 的任何邻域，都存在使得 $\\det\\mathbf{J}(\\xi,\\eta)  0$ 的点（例如，在正 $\\eta$ 轴上，其中 $\\xi=0, \\eta0$）和使得 $\\det\\mathbf{J}(\\xi,\\eta)  0$ 的点（例如，在正 $\\xi$ 轴上，其中 $\\eta=0, \\xi0$）。负的雅可比行列式表示映射的局部反转，意味着单元自身发生了折叠。因此，该单元在 $(0,0)$ 的任何邻域的某些部分是反转的。\n\n对于任务2，我们必须计算极限 $L=\\lim_{(\\xi,\\eta)\\to(0,0)}\\left(\\det\\mathbf{J}(\\xi,\\eta)\\right)\\,I_{11}(\\xi,\\eta)$。\n代入 $I_{11}(\\xi,\\eta)$ 的定义：\n$$L = \\lim_{(\\xi,\\eta)\\to(0,0)} (\\det\\mathbf{J}) \\left( \\left[\\mathbf{B}^{\\mathsf{T}}\\mathbf{C}\\,\\mathbf{B}\\right]_{(1,1)} \\det\\mathbf{J} \\right) = \\lim_{(\\xi,\\eta)\\to(0,0)} (\\det\\mathbf{J})^{2} \\left[\\mathbf{B}^{\\mathsf{T}}\\mathbf{C}\\,\\mathbf{B}\\right]_{(1,1)}$$\n$\\left[\\mathbf{B}^{\\mathsf{T}}\\mathbf{C}\\,\\mathbf{B}\\right]_{(1,1)}$ 项对应于自由度 $u_{1}$（节点1的 $x$ 方向位移）。它由 $\\mathbf{b}_{u1}^{\\mathsf{T}} \\mathbf{C} \\mathbf{b}_{u1}$ 给出，其中 $\\mathbf{b}_{u1}$ 是矩阵 $\\mathbf{B}$ 的第一列。\n$$\\mathbf{b}_{u1} = \\begin{pmatrix} \\frac{\\partial N_1}{\\partial x} \\\\ 0 \\\\ \\frac{\\partial N_1}{\\partial y} \\end{pmatrix}$$\n乘积为：\n$$\\left[\\mathbf{B}^{\\mathsf{T}}\\mathbf{C}\\,\\mathbf{B}\\right]_{(1,1)} = \\begin{pmatrix} \\frac{\\partial N_1}{\\partial x}  0  \\frac{\\partial N_1}{\\partial y} \\end{pmatrix} \\begin{pmatrix} \\lambda+2\\mu  \\lambda  0\\\\ \\lambda  \\lambda+2\\mu  0\\\\ 0  0  \\mu \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial N_1}{\\partial x} \\\\ 0 \\\\ \\frac{\\partial N_1}{\\partial y} \\end{pmatrix} = (\\lambda+2\\mu)\\left(\\frac{\\partial N_1}{\\partial x}\\right)^2 + \\mu\\left(\\frac{\\partial N_1}{\\partial y}\\right)^2$$\n物理导数 $\\frac{\\partial N_1}{\\partial x}$ 和 $\\frac{\\partial N_1}{\\partial y}$ 通过链式法则求得：\n$$ \\begin{pmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{pmatrix} = (\\mathbf{J}^{\\mathsf{T}})^{-1} \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix} = \\frac{1}{\\det\\mathbf{J}} \\begin{pmatrix} \\frac{\\partial y}{\\partial \\eta}  -\\frac{\\partial y}{\\partial \\xi} \\\\ -\\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial x}{\\partial \\xi} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix} $$\n将此应用于 $N_{1}(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$：\n$$\\frac{\\partial N_1}{\\partial \\xi} = \\frac{1}{4}(-1+\\eta), \\quad \\frac{\\partial N_1}{\\partial \\eta} = \\frac{1}{4}(-1+\\xi)$$\n因此，\n$$\\frac{\\partial N_1}{\\partial x} = \\frac{1}{\\det\\mathbf{J}} \\left( \\frac{\\partial y}{\\partial \\eta}\\frac{\\partial N_1}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi}\\frac{\\partial N_1}{\\partial \\eta} \\right)$$\n$$\\frac{\\partial N_1}{\\partial y} = \\frac{1}{\\det\\mathbf{J}} \\left( -\\frac{\\partial x}{\\partial \\eta}\\frac{\\partial N_1}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial N_1}{\\partial \\eta} \\right)$$\n将这些代入 $L$ 的表达式中：\n$$L = \\lim_{(\\xi,\\eta)\\to(0,0)} (\\det\\mathbf{J})^{2} \\left[ (\\lambda+2\\mu)\\frac{1}{(\\det\\mathbf{J})^2} \\left( \\frac{\\partial y}{\\partial \\eta}\\frac{\\partial N_1}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi}\\frac{\\partial N_1}{\\partial \\eta} \\right)^2 + \\mu\\frac{1}{(\\det\\mathbf{J})^2} \\left( -\\frac{\\partial x}{\\partial \\eta}\\frac{\\partial N_1}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial N_1}{\\partial \\eta} \\right)^2 \\right]$$\n$(\\det\\mathbf{J})^2$ 项消掉了。所得连续函数的极限就是它在 $(\\xi,\\eta)=(0,0)$ 处的值。\n$$L = (\\lambda+2\\mu) \\left( \\frac{\\partial y}{\\partial \\eta}\\frac{\\partial N_1}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi}\\frac{\\partial N_1}{\\partial \\eta} \\right)^2_ {(0,0)} + \\mu \\left( -\\frac{\\partial x}{\\partial \\eta}\\frac{\\partial N_1}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial N_1}{\\partial \\eta} \\right)^2_ {(0,0)}$$\n我们在 $(\\xi,\\eta)=(0,0)$ 处计算所有项的值：\n$$\\frac{\\partial x}{\\partial \\xi}\\Big|_{(0,0)} = \\frac{2}{3}, \\quad \\frac{\\partial x}{\\partial \\eta}\\Big|_{(0,0)} = \\frac{1}{3}$$\n$$\\frac{\\partial y}{\\partial \\xi}\\Big|_{(0,0)} = \\frac{2}{3}, \\quad \\frac{\\partial y}{\\partial \\eta}\\Big|_{(0,0)} = \\frac{1}{3}$$\n$$\\frac{\\partial N_1}{\\partial \\xi}\\Big|_{(0,0)} = -\\frac{1}{4}, \\quad \\frac{\\partial N_1}{\\partial \\eta}\\Big|_{(0,0)} = -\\frac{1}{4}$$\n令 $A = \\frac{\\partial y}{\\partial \\eta}\\frac{\\partial N_1}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi}\\frac{\\partial N_1}{\\partial \\eta}$ 且 $B = -\\frac{\\partial x}{\\partial \\eta}\\frac{\\partial N_1}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial N_1}{\\partial \\eta}$。\n$$A\\Big|_{(0,0)} = \\left(\\frac{1}{3}\\right)\\left(-\\frac{1}{4}\\right) - \\left(\\frac{2}{3}\\right)\\left(-\\frac{1}{4}\\right) = -\\frac{1}{12} + \\frac{2}{12} = \\frac{1}{12}$$\n$$B\\Big|_{(0,0)} = -\\left(\\frac{1}{3}\\right)\\left(-\\frac{1}{4}\\right) + \\left(\\frac{2}{3}\\right)\\left(-\\frac{1}{4}\\right) = \\frac{1}{12} - \\frac{2}{12} = -\\frac{1}{12}$$\n将这些值代回 $L$ 的表达式中：\n$$L = (\\lambda+2\\mu)\\left(\\frac{1}{12}\\right)^2 + \\mu\\left(-\\frac{1}{12}\\right)^2 = \\frac{\\lambda+2\\mu}{144} + \\frac{\\mu}{144} = \\frac{\\lambda+3\\mu}{144}$$\n这就是所求的有限极限。", "answer": "$$\n\\boxed{\\frac{\\lambda+3\\mu}{144}}\n$$", "id": "2550222"}]}