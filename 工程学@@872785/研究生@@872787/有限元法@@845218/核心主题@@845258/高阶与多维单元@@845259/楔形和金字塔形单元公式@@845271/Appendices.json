{"hands_on_practices": [{"introduction": "在有限元分析中，将连续介质力学与离散单元的代数方程联系起来是一项核心任务。本练习将指导您完成这一基本过程中的一个关键步骤：推导单元的运动学矩阵，即 $B$ 矩阵。$B$ 矩阵直接将单元的节点位移与单元内部的应变场联系起来，是构建单元刚度矩阵的基石。通过完成这个推导 [@problem_id:2611736]，您将深入理解等参 (isoparametric) 映射、形函数求导以及链式法则在从自然坐标系转换到物理坐标系中的实际应用。", "problem": "考虑在有限元法 (FEM) 中用于三维小应变弹性力学的等参线性楔形（三棱柱）有限元。令自然坐标为 $(\\xi,\\eta,\\zeta)$，其中 $(\\xi,\\eta)$ 是参考三角形上的面积（重心）坐标，满足 $\\xi \\ge 0$，$\\eta \\ge 0$，$\\xi+\\eta \\le 1$，而 $\\zeta \\in [-1,1]$ 是厚度坐标。使用三角形面积坐标 $L_1=\\xi$，$L_2=\\eta$，$L_3=1-\\xi-\\eta$ 定义线性楔形形函数如下\n$$\nN_1 = L_1 \\frac{1-\\zeta}{2},\\quad\nN_2 = L_2 \\frac{1-\\zeta}{2},\\quad\nN_3 = L_3 \\frac{1-\\zeta}{2},\\quad\nN_4 = L_1 \\frac{1+\\zeta}{2},\\quad\nN_5 = L_2 \\frac{1+\\zeta}{2},\\quad\nN_6 = L_3 \\frac{1+\\zeta}{2}.\n$$\n物理（笛卡尔）节点坐标如下：\n- 节点 $1$：$(x_1,y_1,z_1)=(1,0,0)$，\n- 节点 $2$：$(x_2,y_2,z_2)=(0,1,0)$，\n- 节点 $3$：$(x_3,y_3,z_3)=(0,0,0)$，\n- 节点 $4$：$(x_4,y_4,z_4)=(1,0,1)$，\n- 节点 $5$：$(x_5,y_5,z_5)=(0,1,1)$，\n- 节点 $6$：$(x_6,y_6,z_6)=(0,0,1)$。\n\n任务：\n1) 仅从上述形函数定义和等参映射 $x(\\xi,\\eta,\\zeta)=\\sum_{i=1}^{6} N_i x_i$，$y(\\xi,\\eta,\\zeta)=\\sum_{i=1}^{6} N_i y_i$，$z(\\xi,\\eta,\\zeta)=\\sum_{i=1}^{6} N_i z_i$ 出发，计算所有 $i \\in \\{1,\\dots,6\\}$ 的自然坐标导数 $\\partial N_i/\\partial \\xi$、$\\partial N_i/\\partial \\eta$ 和 $\\partial N_i/\\partial \\zeta$。\n2) 使用小应变张量定义 $\\varepsilon=\\tfrac{1}{2}(\\nabla \\mathbf{u}+(\\nabla \\mathbf{u})^{\\top})$ 以及通过等参映射的雅可比矩阵关联 $(x,y,z)$ 和 $(\\xi,\\eta,\\zeta)$ 导数的链式法则，组装单元运动学矩阵 $B(\\xi,\\eta,\\zeta)$，使得 $\\boldsymbol{\\varepsilon} = B \\mathbf{d}$。其中节点位移向量排序为 $\\mathbf{d}=[u_1\\ v_1\\ w_1\\ u_2\\ v_2\\ w_2\\ u_3\\ v_3\\ w_3\\ u_4\\ v_4\\ w_4\\ u_5\\ v_5\\ w_5\\ u_6\\ v_6\\ w_6]^{\\top}$，工程应变向量排序为 $[\\varepsilon_{xx}\\ \\varepsilon_{yy}\\ \\varepsilon_{zz}\\ \\gamma_{xy}\\ \\gamma_{yz}\\ \\gamma_{zx}]^{\\top}$。\n\n以 $\\xi$、$\\eta$ 和 $\\zeta$ 表示的 $6 \\times 18$ 矩阵 $B(\\xi,\\eta,\\zeta)$ 的单一紧凑解析表达式形式提供您的最终答案。无需数值舍入。最终答案中不包含单位。", "solution": "在尝试求解之前，需对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- 单元类型：等参线性楔形（三棱柱）有限元。\n- 物理背景：三维小应变弹性力学。\n- 自然坐标：$(\\xi, \\eta, \\zeta)$，其中 $\\xi \\ge 0$, $\\eta \\ge 0$, $\\xi+\\eta \\le 1$ 且 $\\zeta \\in [-1,1]$。\n- 三角形面积坐标：$L_1=\\xi$，$L_2=\\eta$，$L_3=1-\\xi-\\eta$。\n- 形函数：\n$$\n\\begin{aligned}\nN_1 = L_1 \\frac{1-\\zeta}{2} = \\xi \\frac{1-\\zeta}{2} \\\\\nN_2 = L_2 \\frac{1-\\zeta}{2} = \\eta \\frac{1-\\zeta}{2} \\\\\nN_3 = L_3 \\frac{1-\\zeta}{2} = (1 - \\xi - \\eta) \\frac{1-\\zeta}{2} \\\\\nN_4 = L_1 \\frac{1+\\zeta}{2} = \\xi \\frac{1+\\zeta}{2} \\\\\nN_5 = L_2 \\frac{1+\\zeta}{2} = \\eta \\frac{1+\\zeta}{2} \\\\\nN_6 = L_3 \\frac{1+\\zeta}{2} = (1 - \\xi - \\eta) \\frac{1+\\zeta}{2}\n\\end{aligned}\n$$\n- 物理节点坐标：\n  - 节点 $1$：$(1,0,0)$\n  - 节点 $2$：$(0,1,0)$\n  - 节点 $3$：$(0,0,0)$\n  - 节点 $4$：$(1,0,1)$\n  - 节点 $5$：$(0,1,1)$\n  - 节点 $6$：$(0,0,1)$\n- 等参映射：$x(\\xi,\\eta,\\zeta)=\\sum_{i=1}^{6} N_i x_i$，$y(\\xi,\\eta,\\zeta)=\\sum_{i=1}^{6} N_i y_i$，$z(\\xi,\\eta,\\zeta)=\\sum_{i=1}^{6} N_i z_i$。\n- 应变定义：小应变张量 $\\boldsymbol{\\varepsilon}=\\tfrac{1}{2}(\\nabla \\mathbf{u}+(\\nabla \\mathbf{u})^{\\top})$。\n- 要求关系：$\\boldsymbol{\\varepsilon} = B \\mathbf{d}$，其中 $\\mathbf{d}$ 是节点位移向量 $[u_1, v_1, w_1, \\dots, u_6, v_6, w_6]^{\\top}$，$\\boldsymbol{\\varepsilon}$ 是工程应变向量 $[\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{zz}, \\gamma_{xy}, \\gamma_{yz}, \\gamma_{zx}]^{\\top}$。\n\n**第2步：验证**\n该问题具有科学依据，是适定且客观的。它提出了有限元法理论中的一个标准、典型的问题。所有定义、数据和条件都是标准的、完整的且一致的。指定的节点坐标定义了一个非退化的单元几何形状，确保了唯一、稳定且有意义的解的存在。该问题不违反任何无效性标准。\n\n**第3步：结论**\n该问题是 **有效的**。将进行求解推导。\n\n**求解推导**\n\n工程应变向量 $\\boldsymbol{\\varepsilon}$ 是根据位移场 $\\mathbf{u} = (u,v,w)$ 的空间导数定义的：\n$$\n\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\varepsilon_{zz} \\\\ \\gamma_{xy} \\\\ \\gamma_{yz} \\\\ \\gamma_{zx} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial u}{\\partial x} \\\\ \\frac{\\partial v}{\\partial y} \\\\ \\frac{\\partial w}{\\partial z} \\\\ \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} \\\\ \\frac{\\partial v}{\\partial z} + \\frac{\\partial w}{\\partial y} \\\\ \\frac{\\partial w}{\\partial x} + \\frac{\\partial u}{\\partial z} \\end{pmatrix}\n$$\n位移场由节点位移 $\\mathbf{d}$ 通过形函数 $N_i$ 插值得到：\n$$\nu = \\sum_{i=1}^{6} N_i u_i, \\quad v = \\sum_{i=1}^{6} N_i v_i, \\quad w = \\sum_{i=1}^{6} N_i w_i\n$$\n将这些代入应变定义中，得到关系式 $\\boldsymbol{\\varepsilon} = B \\mathbf{d}$，其中 $B$ 是 $6 \\times 18$ 的应变-位移矩阵。矩阵 $B$ 通过划分为 $6$ 个块来构造，$B = [B_1, B_2, B_3, B_4, B_5, B_6]$，其中每个 $B_i$ 是与节点 $i$ 相关联的 $6 \\times 3$ 矩阵：\n$$\nB_i = \\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x}  0  0 \\\\\n0  \\frac{\\partial N_i}{\\partial y}  0 \\\\\n0  0  \\frac{\\partial N_i}{\\partial z} \\\\\n\\frac{\\partial N_i}{\\partial y}  \\frac{\\partial N_i}{\\partial x}  0 \\\\\n0  \\frac{\\partial N_i}{\\partial z}  \\frac{\\partial N_i}{\\partial y} \\\\\n\\frac{\\partial N_i}{\\partial z}  0  \\frac{\\partial N_i}{\\partial x}\n\\end{pmatrix}\n$$\n为了构造 $B_i$，我们需要形函数相对于物理坐标 $(x,y,z)$ 的导数。这些导数通过链式法则从相对于自然坐标 $(\\xi, \\eta, \\zeta)$ 的导数获得。物理梯度向量 $\\nabla_{\\mathbf{x}} N_i$ 与参数梯度向量 $\\nabla_{\\boldsymbol{\\xi}} N_i$ 的关系由雅可比矩阵 $J$ 给出：\n$$\n\\nabla_{\\mathbf{x}} N_i = J^{-T} \\nabla_{\\boldsymbol{\\xi}} N_i \\quad \\text{或} \\quad \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial z} \\end{pmatrix} = (J^T)^{-1} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\\\ \\frac{\\partial N_i}{\\partial \\zeta} \\end{pmatrix}\n$$\n其中 $J$ 是标准的雅可比矩阵，其定义为 $J_{ij} = \\frac{\\partial x_i}{\\partial \\xi_j}$。\n\n首先，我们计算形函数关于自然坐标的导数：\n$$\n\\begin{array}{lll}\n\\frac{\\partial N_1}{\\partial \\xi}=\\frac{1-\\zeta}{2}  \\frac{\\partial N_1}{\\partial \\eta}=0  \\frac{\\partial N_1}{\\partial \\zeta}=-\\frac{\\xi}{2} \\\\\n\\frac{\\partial N_2}{\\partial \\xi}=0  \\frac{\\partial N_2}{\\partial \\eta}=\\frac{1-\\zeta}{2}  \\frac{\\partial N_2}{\\partial \\zeta}=-\\frac{\\eta}{2} \\\\\n\\frac{\\partial N_3}{\\partial \\xi}=-\\frac{1-\\zeta}{2}  \\frac{\\partial N_3}{\\partial \\eta}=-\\frac{1-\\zeta}{2}  \\frac{\\partial N_3}{\\partial \\zeta}=-\\frac{1-\\xi-\\eta}{2} \\\\\n\\frac{\\partial N_4}{\\partial \\xi}=\\frac{1+\\zeta}{2}  \\frac{\\partial N_4}{\\partial \\eta}=0  \\frac{\\partial N_4}{\\partial \\zeta}=\\frac{\\xi}{2} \\\\\n\\frac{\\partial N_5}{\\partial \\xi}=0  \\frac{\\partial N_5}{\\partial \\eta}=\\frac{1+\\zeta}{2}  \\frac{\\partial N_5}{\\partial \\zeta}=\\frac{\\eta}{2} \\\\\n\\frac{\\partial N_6}{\\partial \\xi}=-\\frac{1+\\zeta}{2}  \\frac{\\partial N_6}{\\partial \\eta}=-\\frac{1+\\zeta}{2}  \\frac{\\partial N_6}{\\partial \\zeta}=\\frac{1-\\xi-\\eta}{2}\n\\end{array}\n$$\n接下来，我们计算雅可比矩阵 $J$。对于此特定几何形状，映射为：\n$x = \\sum N_i x_i = N_1(1) + N_4(1) = \\xi\\frac{1-\\zeta}{2} + \\xi\\frac{1+\\zeta}{2} = \\xi$\n$y = \\sum N_i y_i = N_2(1) + N_5(1) = \\eta\\frac{1-\\zeta}{2} + \\eta\\frac{1+\\zeta}{2} = \\eta$\n$z = \\sum N_i z_i = N_4(1) + N_5(1) + N_6(1) = (\\xi+\\eta+1-\\xi-\\eta)\\frac{1+\\zeta}{2} = \\frac{1+\\zeta}{2}$\n因此，雅可比矩阵为：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial x}{\\partial \\zeta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\zeta} \\\\ \\frac{\\partial z}{\\partial \\xi}  \\frac{\\partial z}{\\partial \\eta}  \\frac{\\partial z}{\\partial \\zeta} \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  \\frac{1}{2} \\end{pmatrix}\n$$\n其逆转置矩阵为：\n$$\nJ^{-T} = (J^{-1})^T = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  2 \\end{pmatrix}^T = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  2 \\end{pmatrix}\n$$\n现在我们求 $N_i$ 的物理导数：$\\frac{\\partial N_i}{\\partial x} = \\frac{\\partial N_i}{\\partial \\xi}$，$\\frac{\\partial N_i}{\\partial y} = \\frac{\\partial N_i}{\\partial \\eta}$，以及 $\\frac{\\partial N_i}{\\partial z} = 2\\frac{\\partial N_i}{\\partial \\zeta}$。\n$$\n\\begin{array}{lll}\n\\frac{\\partial N_1}{\\partial x}=\\frac{1-\\zeta}{2}  \\frac{\\partial N_1}{\\partial y}=0  \\frac{\\partial N_1}{\\partial z}=-\\xi \\\\\n\\frac{\\partial N_2}{\\partial x}=0  \\frac{\\partial N_2}{\\partial y}=\\frac{1-\\zeta}{2}  \\frac{\\partial N_2}{\\partial z}=-\\eta \\\\\n\\frac{\\partial N_3}{\\partial x}=-\\frac{1-\\zeta}{2}  \\frac{\\partial N_3}{\\partial y}=-\\frac{1-\\zeta}{2}  \\frac{\\partial N_3}{\\partial z}=-(1-\\xi-\\eta) \\\\\n\\frac{\\partial N_4}{\\partial x}=\\frac{1+\\zeta}{2}  \\frac{\\partial N_4}{\\partial y}=0  \\frac{\\partial N_4}{\\partial z}=\\xi \\\\\n\\frac{\\partial N_5}{\\partial x}=0  \\frac{\\partial N_5}{\\partial y}=\\frac{1+\\zeta}{2}  \\frac{\\partial N_5}{\\partial z}=\\eta \\\\\n\\frac{\\partial N_6}{\\partial x}=-\\frac{1+\\zeta}{2}  \\frac{\\partial N_6}{\\partial y}=-\\frac{1+\\zeta}{2}  \\frac{\\partial N_6}{\\partial z}=1-\\xi-\\eta\n\\end{array}\n$$\n最后，我们组装 $B$ 矩阵。各列按节点编号 $(1 \\dots 6)$ 分组，每个节点有三列，对应其 $(u,v,w)$ 位移。\n$$\nB(\\xi,\\eta,\\zeta) = [B_1 \\ B_2 \\ B_3 \\ B_4 \\ B_5 \\ B_6]\n$$\n代入这些导数即可得到 $B$ 矩阵的最终表达式。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1-\\zeta}{2}  0  0  0  0  0  -\\frac{1-\\zeta}{2}  0  0  \\frac{1+\\zeta}{2}  0  0  0  0  0  -\\frac{1+\\zeta}{2}  0  0 \\\\\n0  0  0  0  \\frac{1-\\zeta}{2}  0  0  -\\frac{1-\\zeta}{2}  0  0  0  0  0  \\frac{1+\\zeta}{2}  0  0  -\\frac{1+\\zeta}{2}  0 \\\\\n0  0  -\\xi  0  0  -\\eta  0  0  - (1-\\xi-\\eta)  0  0  \\xi  0  0  \\eta  0  0  1-\\xi-\\eta \\\\\n0  \\frac{1-\\zeta}{2}  0  \\frac{1-\\zeta}{2}  0  0  -\\frac{1-\\zeta}{2}  -\\frac{1-\\zeta}{2}  0  0  \\frac{1+\\zeta}{2}  0  \\frac{1+\\zeta}{2}  0  0  -\\frac{1+\\zeta}{2}  -\\frac{1+\\zeta}{2}  0 \\\\\n0  -\\xi  0  0  -\\eta  \\frac{1-\\zeta}{2}  0  - (1-\\xi-\\eta)  -\\frac{1-\\zeta}{2}  0  \\xi  0  0  \\eta  \\frac{1+\\zeta}{2}  0  1-\\xi-\\eta  -\\frac{1+\\zeta}{2} \\\\\n-\\xi  0  \\frac{1-\\zeta}{2}  -\\eta  0  0  - (1-\\xi-\\eta)  0  -\\frac{1-\\zeta}{2}  \\xi  0  \\frac{1+\\zeta}{2}  \\eta  0  0  1-\\xi-\\eta  0  -\\frac{1+\\zeta}{2}\n\\end{pmatrix}\n}\n$$", "id": "2611736"}, {"introduction": "从静力学分析转向动力学分析，我们需要引入惯性的概念，这在有限元中通过质量矩阵 $M$ 来体现。与刚度矩阵不同，质量矩阵的构造存在重要选择：精确但计算昂贵的“一致质量矩阵” ($M_C$)，以及简化但高效的“集中质量矩阵” ($M_L$)。本练习 [@problem_id:2611757] 旨在通过分析这两种矩阵的谱特性（即特征值），揭示这一选择对显式时间积分算法稳定性的深远影响。理解这种权衡对于在计算成本和精度之间做出明智决策至关重要，尤其是在求解大规模波传播或碰撞问题时。", "problem": "考虑一个半离散线性弹性动力学模型，该模型通过有限元离散化得到，使用了具有 $6$ 个节点和均匀质量密度 $\\rho$ 的线性楔形（棱柱）单元。设形函数为 $\\{N_i\\}_{i=1}^{6}$，它们在单元上非负，并构成单位分解，即对于单元中的所有 $x$，$\\sum_{i=1}^{6} N_i(x)=1$。一致单元质量矩阵 $M_C^{(e)}$ 和行和集中单元质量矩阵 $M_L^{(e)}$ 定义为\n$$\n\\left(M_C^{(e)}\\right)_{ij}=\\int_{V_e} \\rho\\, N_i N_j \\, \\mathrm{d}V,\\qquad\n\\left(M_L^{(e)}\\right)_{ii}=\\sum_{j=1}^{6} \\left(M_C^{(e)}\\right)_{ij},\\qquad \\left(M_L^{(e)}\\right)_{ij}=0 \\text{ for } i\\neq j.\n$$\n设 $M_C$ 和 $M_L$ 表示在此类楔形单元网格上组装得到的相应全局质量矩阵。假设对称半正定全局刚度矩阵 $K$ 来自线性弹性问题和标准的 Galerkin 加权，并考虑对半离散系统 $M\\,\\ddot{u}(t)+K\\,u(t)=0$ 进行显式中心差分时间积分。\n\n根据第一性原理和给定的定义，确定以下关于 $M_C$ 与 $M_L$ 的谱特性以及显式中心差分时间积分稳定性的陈述中，哪些是正确的。\n\n- A. 对于任意全局位移向量 $v$，其二次型满足 $v^{\\top} M_C v \\leq v^{\\top} M_L v$。因此，在广义特征值问题 $K \\phi = \\omega^2 M \\phi$ 中，与 $M_L$ 相关的最大特征值不超过与 $M_C$ 相关的最大特征值，这意味着当用 $M_L$ 替换 $M_C$ 时，中心差分法的最大稳定时间步长不会减小。\n\n- B. 因为质量集中破坏了非对角项，所以必然会增加 $M^{-1}K$ 的最大特征值，因此中心差分法下的最大稳定时间步长严格减小：对于任何此类楔形单元离散化，都有 $\\Delta t_{\\mathrm{crit},L}  \\Delta t_{\\mathrm{crit},C}$。\n\n- C. 与一致质量矩阵相比，行和质量集中减少了每个单元的总质量，这解释了为什么在质量集中下质量矩阵的特征值会增加。\n\n- D. 对于任意全局位移向量 $v$，不等式 $v^{\\top} M_C v \\geq v^{\\top} M_L v$ 成立，因此质量集中减少了所有模态质量并增加了所有固有频率。\n\n- E. 在自由-自由边界条件下，当使用 $M_C$ 或 $M_L$ 时，广义特征值问题 $K \\phi = \\omega^2 M \\phi$ 具有相同的刚体模态（$\\omega=0$），并且总质量 $\\mathbf{1}^{\\top} M \\mathbf{1}$ 在行和质量集中下保持不变。\n\n选择所有适用的选项。", "solution": "在尝试求解之前，必须首先验证问题陈述的正确性和连贯性。\n\n**第一步：提取已知条件**\n-   **系统：** 半离散线性弹性动力学模型，$M\\,\\ddot{u}(t)+K\\,u(t)=0$。\n-   **离散化：** 使用具有 $6$ 个节点的线性楔形（棱柱）单元的有限元方法。\n-   **质量密度：** 均匀，$\\rho$。\n-   **形函数：** 每个单元为 $\\{N_i\\}_{i=1}^{6}$。\n-   **形函数属性：**\n    1.  非负性：对于单元中的所有 $x$，$N_i(x) \\ge 0$。\n    2.  单位分解：对于单元中的所有 $x$，$\\sum_{i=1}^{6} N_i(x) = 1$。\n-   **一致单元质量矩阵：** $\\left(M_C^{(e)}\\right)_{ij}=\\int_{V_e} \\rho\\, N_i N_j \\, \\mathrm{d}V$。\n-   **行和集中单元质量矩阵：** $\\left(M_L^{(e)}\\right)_{ii}=\\sum_{j=1}^{6} \\left(M_C^{(e)}\\right)_{ij}$ 且当 $i \\neq j$ 时 $\\left(M_L^{(e)}\\right)_{ij}=0$。\n-   **全局矩阵：** $M_C$ 和 $M_L$ 分别由 $M_C^{(e)}$ 和 $M_L^{(e)}$ 组装而成。\n-   **刚度矩阵：** 全局刚度矩阵 $K$ 是对称半正定的（SPSD）。\n-   **时间积分：** 显式中心差分法。\n-   **特征值问题：** $K \\phi = \\omega^2 M \\phi$。\n\n**第二步：使用提取的已知条件进行验证**\n该问题陈述在科学上基于应用于结构动力学的有限元方法理论。一致质量矩阵和行和集中质量矩阵的定义是标准的。形函数的属性是线性 Lagrange 单元的典型特征。众所周知，中心差分格式的稳定性与离散化系统的最大频率有关。该问题是适定的、客观的，并包含足够的信息来确定给定陈述的正确性。没有科学缺陷、矛盾或含糊之处。\n\n**第三步：结论与行动**\n问题陈述有效。将推导解答。\n\n**推导与分析**\n这个问题的核心在于一致质量矩阵 $M_C$ 和集中质量矩阵 $M_L$ 之间的数学关系。我们必须首先建立它们二次型 $v^{\\top} M_C v$ 和 $v^{\\top} M_L v$ 之间的关系。\n\n让我们考虑单个单元和任意的节点位移向量 $v_e \\in \\mathbb{R}^6$。集中质量矩阵 $M_L^{(e)}$ 的二次型为：\n$$ v_e^{\\top} M_L^{(e)} v_e = \\sum_{i=1}^{6} (v_e)_i^2 \\left( M_L^{(e)} \\right)_{ii} = \\sum_{i=1}^{6} (v_e)_i^2 \\left( \\sum_{j=1}^{6} \\left( M_C^{(e)} \\right)_{ij} \\right) $$\n使用 $M_C^{(e)}$ 的定义，上式变为：\n$$ v_e^{\\top} M_L^{(e)} v_e = \\sum_{i=1}^{6} (v_e)_i^2 \\sum_{j=1}^{6} \\int_{V_e} \\rho N_i N_j \\, \\mathrm{d}V = \\int_{V_e} \\rho \\sum_{i=1}^{6} (v_e)_i^2 N_i \\left( \\sum_{j=1}^{6} N_j \\right) \\, \\mathrm{d}V $$\n根据单位分解属性，$\\sum_{j=1}^{6} N_j(x) = 1$。因此，\n$$ v_e^{\\top} M_L^{(e)} v_e = \\int_{V_e} \\rho \\left( \\sum_{i=1}^{6} (v_e)_i^2 N_i \\right) \\, \\mathrm{d}V $$\n一致质量矩阵 $M_C^{(e)}$ 的二次型为：\n$$ v_e^{\\top} M_C^{(e)} v_e = \\sum_{i=1}^{6}\\sum_{j=1}^{6} (v_e)_i (v_e)_j (M_C^{(e)})_{ij} = \\sum_{i,j} (v_e)_i (v_e)_j \\int_{V_e} \\rho N_i N_j \\, \\mathrm{d}V $$\n$$ v_e^{\\top} M_C^{(e)} v_e = \\int_{V_e} \\rho \\left( \\sum_{i=1}^{6} (v_e)_i N_i \\right) \\left( \\sum_{j=1}^{6} (v_e)_j N_j \\right) \\, \\mathrm{d}V = \\int_{V_e} \\rho \\left( \\sum_{i=1}^{6} (v_e)_i N_i \\right)^2 \\, \\mathrm{d}V $$\n现在，考虑两个二次型之间的差值：\n$$ v_e^{\\top} M_L^{(e)} v_e - v_e^{\\top} M_C^{(e)} v_e = \\int_{V_e} \\rho \\left[ \\left( \\sum_{i=1}^{6} (v_e)_i^2 N_i \\right) - \\left( \\sum_{i=1}^{6} (v_e)_i N_i \\right)^2 \\right] \\, \\mathrm{d}V $$\n对于任意点 $x \\in V_e$，形函数 $N_i(x)$ 是非负的，$N_i(x) \\ge 0$，并且其和为一，$\\sum_{i=1}^{6} N_i(x) = 1$。令 $p_i = N_i(x)$ 且 $a_i = (v_e)_i$。方括号中的项是 $\\sum p_i a_i^2 - (\\sum p_i a_i)^2$。这是一个离散随机变量的方差的定义，该随机变量以概率 $p_i$ 取值 $a_i$。方差总是非负的。另外，这也是柯西-施瓦茨不等式（Cauchy-Schwarz inequality）的直接推论：$(\\sum a_i p_i)^2 \\le (\\sum p_i)(\\sum a_i^2 p_i)$。因为 $\\sum p_i = \\sum N_i = 1$，我们有 $(\\sum a_i p_i)^2 \\le \\sum a_i^2 p_i$。\n因此，被积函数是逐点非负的：\n$$ \\rho \\left[ \\left( \\sum_{i=1}^{6} (v_e)_i^2 N_i \\right) - \\left( \\sum_{i=1}^{6} (v_e)_i N_i \\right)^2 \\right] \\ge 0 $$\n作为非负函数的积分，其差值也必须是非负的：\n$$ v_e^{\\top} M_L^{(e)} v_e - v_e^{\\top} M_C^{(e)} v_e \\ge 0 \\implies v_e^{\\top} M_L^{(e)} v_e \\ge v_e^{\\top} M_C^{(e)} v_e $$\n由于全局矩阵是通过对单元矩阵求和组装而成的，这个不等式对任意全局位移向量 $v$ 和全局矩阵也成立：\n$$ v^{\\top} M_L v \\ge v^{\\top} M_C v $$\n\n这个基本不等式使得我们可以评估所提供的选项。\n\n**逐项分析**\n\n**A. 对于任意全局位移向量 $v$，其二次型满足 $v^{\\top} M_C v \\leq v^{\\top} M_L v$。因此，在广义特征值问题 $K \\phi = \\omega^2 M \\phi$ 中，与 $M_L$ 相关的最大特征值不超过与 $M_C$ 相关的最大特征值，这意味着当用 $M_L$ 替换 $M_C$ 时，中心差分法的最大稳定时间步长不会减小。**\n\n-   第一部分，$v^{\\top} M_C v \\leq v^{\\top} M_L v$，正是上面所证明的。它是正确的。\n-   广义特征值 $\\lambda = \\omega^2$ 由瑞利商（Rayleigh quotient）给出，$\\lambda = \\frac{v^{\\top} K v}{v^{\\top} M v}$。最大特征值是 $\\lambda_{\\max} = \\max_{v \\neq 0} \\frac{v^{\\top} K v}{v^{\\top} M v}$。\n-   比较 $\\lambda_{\\max, C}$ 和 $\\lambda_{\\max, L}$：由于 $v^{\\top} M_L v \\ge v^{\\top} M_C v  0$（对于非刚体模态），我们有 $\\frac{1}{v^{\\top} M_L v} \\le \\frac{1}{v^{\\top} M_C v}$。对于任意向量 $v$，可以得出 $\\frac{v^{\\top} K v}{v^{\\top} M_L v} \\le \\frac{v^{\\top} K v}{v^{\\top} M_C v}$。\n-   对所有 $v$ 取最大值得到 $\\lambda_{\\max, L} \\le \\lambda_{\\max, C}$，这意味着 $\\omega_{\\max, L}^2 \\le \\omega_{\\max, C}^2$。因此，与 $M_L$ 相关的最大特征值不超过与 $M_C$ 相关的最大特征值。这部分是正确的。\n-   中心差分格式的稳定性受限于 $\\Delta t_{\\mathrm{crit}} \\le \\frac{2}{\\omega_{\\max}}$。\n-   由于 $\\omega_{\\max, L} \\le \\omega_{\\max, C}$，可以得出 $\\frac{1}{\\omega_{\\max, L}} \\ge \\frac{1}{\\omega_{\\max, C}}$，因此 $\\Delta t_{\\mathrm{crit}, L} \\ge \\Delta t_{\\mathrm{crit}, C}$。\n-   这意味着使用质量集中时的最大稳定时间步长大于或等于使用一致质量矩阵时的最大稳定时间步长。它“不会减小”。这部分也是正确的。\n-   **结论：正确**\n\n**B. 因为质量集中破坏了非对角项，所以必然会增加 $M^{-1}K$ 的最大特征值，因此中心差分法下的最大稳定时间步长严格减小：对于任何此类楔形单元离散化，都有 $\\Delta t_{\\mathrm{crit},L}  \\Delta t_{\\mathrm{crit},C}$。**\n\n-   该陈述声称质量集中*增加*了最大特征值 $\\lambda_{\\max} = \\omega_{\\max}^2$。如选项 A 的分析所示，质量集中*减小*（或保持不变）了最大特征值：$\\lambda_{\\max, L} \\le \\lambda_{\\max, C}$。该前提是错误的。\n-   因此，稳定时间步长*严格减小* ($\\Delta t_{\\mathrm{crit},L}  \\Delta t_{\\mathrm{crit},C}$) 的结论也是错误的。如前所示，$\\Delta t_{\\mathrm{crit},L} \\ge \\Delta t_{\\mathrm{crit},C}$。\n-   **结论：不正确**\n\n**C. 与一致质量矩阵相比，行和质量集中减少了每个单元的总质量，这解释了为什么在质量集中下质量矩阵的特征值会增加。**\n\n-   单元的总质量是密度在其体积上的积分，$m_e = \\int_{V_e} \\rho \\, \\mathrm{d}V$。\n-   一致单元质量矩阵所有项的和是 $\\sum_{i,j} (M_C^{(e)})_{ij} = \\sum_{i,j} \\int_{V_e} \\rho N_i N_j \\, \\mathrm{d}V = \\int_{V_e} \\rho (\\sum_i N_i)(\\sum_j N_j) \\, \\mathrm{d}V = \\int_{V_e} \\rho (1)(1) \\, \\mathrm{d}V = m_e$。\n-   集中单元质量矩阵所有项的和是 $\\sum_{i} (M_L^{(e)})_{ii} = \\sum_i \\sum_j (M_C^{(e)})_{ij} = m_e$。\n-   行和集中*保持*了每个单元的总质量。陈述的第一部分是错误的。\n-   一个错误的前提无法正确解释一个结论。\n-   **结论：不正确**\n\n**D. 对于任意全局位移向量 $v$，不等式 $v^{\\top} M_C v \\geq v^{\\top} M_L v$ 成立，因此质量集中减少了所有模态质量并增加了所有固有频率。**\n\n-   不等式 $v^{\\top} M_C v \\geq v^{\\top} M_L v$ 与正确的关系 $v^{\\top} M_C v \\le v^{\\top} M_L v$ 相反。该前提是错误的。\n-   模态 $\\phi_k$ 的“模态质量”定义为 $\\phi_k^{\\top} M \\phi_k$。不等式 $v^{\\top} M_L v \\ge v^{\\top} M_C v$ 意味着模态质量在质量集中下通常会*增加*或保持不变，而不是减少。\n-   固有频率由 $\\omega_k^2 = (\\phi_k^{\\top} K \\phi_k) / (\\phi_k^{\\top} M \\phi_k)$ 关联。如果分母中的模态质量增加，频率 $\\omega_k$ 将会*减小*，而不是增加。该结论也是错误的。\n-   **结论：不正确**\n\n**E. 在自由-自由边界条件下，当使用 $M_C$ 或 $M_L$ 时，广义特征值问题 $K \\phi = \\omega^2 M \\phi$ 具有相同的刚体模态（$\\omega=0$），并且总质量 $\\mathbf{1}^{\\top} M \\mathbf{1}$ 在行和质量集中下保持不变。**\n\n-   刚体模态是产生零应变的非零位移向量 $\\phi_{rbm}$，这意味着它们位于刚度矩阵的零空间中：$K \\phi_{rbm} = 0$。\n-   将此代入特征值问题得到 $0 = \\omega^2 M \\phi_{rbm}$。\n-   对于任何非退化网格，$M_C$ 和 $M_L$ 都是对称正定矩阵。这意味着对于任何非零向量 $v$，$v^\\top M v > 0$，这表明 $Mv \\neq 0$。\n-   由于 $\\phi_{rbm}$ 是一个非零向量，$M_C \\phi_{rbm} \\neq 0$ 且 $M_L \\phi_{rbm} \\neq 0$。\n-   因此，方程 $0 = \\omega^2 M \\phi_{rbm}$ 只有在 $\\omega^2=0$ 时才能满足，即 $\\omega=0$。无论使用 $M_C$ 还是 $M_L$，这都成立。刚体模态由 $K$ 决定，并始终对应于零频率。第一部分是正确的。\n-   项 $\\mathbf{1}^{\\top} M \\mathbf{1}$ 表示全局质量矩阵中所有项的总和，它等于离散化结构的总质量。如选项 C 的分析所示，通过行和集中，总质量在单元级别上是守恒的。由于全局组装是一个求和过程，总质量在全局范围内也是守恒的。因此，$\\mathbf{1}^{\\top} M_C \\mathbf{1} = \\mathbf{1}^{\\top} M_L \\mathbf{1}$。第二部分是正确的。\n-   **结论：正确**", "answer": "$$\\boxed{AE}$$", "id": "2611757"}, {"introduction": "理论知识的最终检验在于实践应用。本练习 [@problem_id:2611725] 是一个综合性的计算任务，要求您将前面章节的理论付诸实践。您需要通过编写代码，利用数值积分（高斯求积）来从头组装楔形单元的一致质量矩阵。在此基础上，您将通过计算其特征值，定量地分析单元的几何形状（特别是“高宽比”）如何影响其动力学特性。这项实践不仅能巩固您对有限元基本流程的理解，还将让您对网格质量如何影响仿真结果的准确性和稳定性获得直观且深刻的认识。", "problem": "考虑有限元法（FEM）中的线性楔形（三棱柱）单元。令自然坐标为 $(\\xi,\\eta,\\zeta)$，其中 $(\\xi,\\eta)$ 位于由 $\\xi \\ge 0$、$\\eta \\ge 0$ 和 $\\xi+\\eta \\le 1$ 定义的参考三角形上，且 $\\zeta \\in [-1,1]$。线性楔形单元有 $6$ 个节点，分别索引为底面（$\\zeta=-1$）的节点 $1,2,3$ 和顶面（$\\zeta=+1$）的节点 $4,5,6$。形函数由标准的线性三角形重心坐标 $L_1=1-\\xi-\\eta$、$L_2=\\xi$、$L_3=\\eta$ 与 $\\zeta$ 的线性函数组合而成：\n$$\nN_1 = L_1 \\frac{1-\\zeta}{2},\\quad\nN_2 = L_2 \\frac{1-\\zeta}{2},\\quad\nN_3 = L_3 \\frac{1-\\zeta}{2},\\quad\nN_4 = L_1 \\frac{1+\\zeta}{2},\\quad\nN_5 = L_2 \\frac{1+\\zeta}{2},\\quad\nN_6 = L_3 \\frac{1+\\zeta}{2}.\n$$\n考虑一个棱柱物理映射，其底面三角形位于平面 $z=0$ 上，节点为\n$$\n\\mathbf{x}_1=(0,0,0),\\quad \\mathbf{x}_2=(s,0,0),\\quad \\mathbf{x}_3=(0,s,0),\n$$\n顶面三角形位于平面 $z=h$ 上，节点为\n$$\n\\mathbf{x}_4=(0,0,h),\\quad \\mathbf{x}_5=(s,0,h),\\quad \\mathbf{x}_6=(0,s,h),\n$$\n其中 $s0$ 是三角形底面的基准尺度，$h0$ 是楔形单元在 $\\zeta$ 方向上的长度。设材料密度为常数，其值为 $\\rho=1$（无量纲）。一致质量矩阵 $M \\in \\mathbb{R}^{6 \\times 6}$ 定义为\n$$\nM = \\int_{V} \\rho\\, \\mathbf{N}^T \\mathbf{N}\\, dV,\n$$\n其中 $\\mathbf{N} = [N_1,\\dots,N_6]$，$V$ 是通过等参法则 $\\mathbf{x}(\\xi,\\eta,\\zeta)=\\sum_{a=1}^6 N_a(\\xi,\\eta,\\zeta)\\mathbf{x}_a$ 从参考域映射而来的物理楔形体积。\n\n任务：根据上述基本定义和域映射，推导并实现一个数值精确的算法（对 $(\\xi,\\eta)$ 中最高 $2$ 次、$\\zeta$ 中最高 $2$ 次的多项式精确），使用可分离的高斯求积（GQ）来组装 $M$：在 $(\\xi,\\eta)$ 上使用一个至少 $2$ 次的三角形积分法则，在 $\\zeta$ 上使用一个至少 $3$ 次的一维高斯-勒让德积分法则。计算 $M$ 的特征值，并分析它们对由下式定义的纵横比的敏感性\n$$\n\\mathrm{AR} = \\frac{h}{s}.\n$$\n使用以下事实作为推导的起点：\n- 对于上述棱柱映射，雅可比行列式 $|\\!J|$ 在整个单元上是常数，等于底面积与高度的乘积，即 $|\\!J| = A\\,h$，其中 $A$ 是底面三角形的物理面积。\n- 对于指定的顶点为 $(0,0)$、$(s,0)$、$(0,s)$ 的直角三角形底面，其面积为 $A = \\frac{s^2}{2}$。\n\n你的程序必须通过求积法实现 $M$ 的组装，计算其特征值，然后评估以下测试套件。所有量均为无量纲。不涉及角度。最终的程序输出必须是单行，包含一个逗号分隔的 Python 列表，其中每个测试用例对应一个浮点数，按下列顺序列出。\n\n测试套件：\n- 测试用例 1（固定基准尺度下，归一化特征值在不同纵横比下的不变性）：设置 $s=1$，计算 $\\mathrm{AR}=0.5$ 和 $\\mathrm{AR}=3.0$（即 $h=\\mathrm{AR}\\cdot s$）时的归一化特征值 $\\lambda_i / (A h)$。将每组特征值按升序排序，并返回两个归一化谱之间的最大绝对差。预期结果是一个接近 $0$ 的小浮点数。\n- 测试用-例 2（固定基准尺度下的对数敏感性）：在 $s=1$ 的情况下，使用对称扰动 $\\delta=10^{-4}$ 在 $\\mathrm{AR}_0=1.2$ 处评估最大特征值 $\\lambda_{\\max}$，以近似对数导数\n$$\nS_{\\mathrm{fixed}\\,s} \\approx \\frac{\\ln \\lambda_{\\max}(\\mathrm{AR}_0+\\delta)-\\ln \\lambda_{\\max}(\\mathrm{AR}_0-\\delta)}{\\ln(\\mathrm{AR}_0+\\delta)-\\ln(\\mathrm{AR}_0-\\delta)}.\n$$\n返回此单个浮点数。预期值接近 $1$。\n- 测试用例 3（固定体积下的对数敏感性）：施加固定体积 $V_0=1$ 和 $\\mathrm{AR}_0=1.2$，并使用相同的对称扰动 $\\delta=10^{-4}$。对于每个扰动后的纵横比 $\\mathrm{AR}$，选择 $s=(2 V_0 / \\mathrm{AR})^{1/3}$ 和 $h=\\mathrm{AR}\\cdot s$，以确保 $A h = V_0$ 精确成立。计算\n$$\nS_{\\mathrm{fixed}\\,V} \\approx \\frac{\\ln \\lambda_{\\max}(\\mathrm{AR}_0+\\delta)-\\ln \\lambda_{\\max}(\\mathrm{AR}_0-\\delta)}{\\ln(\\mathrm{AR}_0+\\delta)-\\ln(\\mathrm{AR}_0-\\delta)}.\n$$\n返回此单个浮点数. 预期值接近 $0$。\n- 测试用例 4（近简并几何缩放检查）：比较 $(s,\\mathrm{AR})=(1,1)$ 和 $(s,\\mathrm{AR})=(10^{-3},10^{3})$ 时的归一化特征值。对于每种情况，计算归一化谱 $\\lambda_i/(A h)$，按升序排序，并返回两个归一化谱之差的欧几里得范数。预期结果是一个接近 $0$ 的小浮点数。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[x_1,x_2,x_3,x_4]$）。每个 $x_k$ 必须是对应于上述顺序的测试用例 $k$ 的浮点数。", "solution": "问题陈述已经过验证，被认为是合理的。它具有科学依据，问题设定良好且客观。它提出了一个有限元法中的标准问题，具有明确的定义和约束，从而能够得到唯一且可验证的解。\n\n任务是计算线性楔形单元的一致质量矩阵 $\\mathbf{M}$ 并分析其特征值。质量矩阵由以下积分定义：\n$$\nM_{ab} = \\int_{V} \\rho N_a N_b dV\n$$\n其中 $a, b \\in \\{1, \\dots, 6\\}$ 是节点索引，$\\mathbf{N} = [N_1, \\dots, N_6]$ 是形函数向量，$V$ 是单元的物理体积，密度 $\\rho$ 给定为 $1$。\n\n等参映射将此积分从物理域转换到参考域 $(\\xi, \\eta, \\zeta)$，其中 $(\\xi, \\eta)$ 是参考三角形上的坐标，$\\zeta \\in [-1, 1]$。体积微元转换为 $dV = |\\!J| d\\xi d\\eta d\\zeta$，其中 $|\\!J|$ 是映射的雅可比矩阵的行列式。问题指出，对于这种特定的棱柱映射，$|\\!J|$ 是常数，等于 $A h = \\frac{s^2 h}{2}$。质量矩阵的积分变为：\n$$\nM_{ab} = \\frac{s^2 h}{2} \\int_{-1}^{1} \\int_{A_{\\text{ref}}} N_a(\\xi, \\eta, \\zeta) N_b(\\xi, \\eta, \\zeta) \\,d\\xi d\\eta \\,d\\zeta\n$$\n其中 $A_{\\text{ref}}$ 是参考三角形的面积，为 $\\frac{1}{2}$。\n\n被积函数 $N_a N_b$ 是形函数的乘积。形函数定义为 $N_i = L_k \\frac{1 \\pm \\zeta}{2}$，其中 $L_k$ 是三角形上的线性重心坐标。具体来说，$L_1 = 1-\\xi-\\eta$，$L_2 = \\xi$，$L_3 = \\eta$。因此，项 $N_a N_b$ 是一个在三角形坐标 $(\\xi,\\eta)$ 中最高 $2$ 次、在坐标 $\\zeta$ 中最高 $2$ 次的多项式。\n\n为了数值上精确地（达到机器精度）计算这个积分，我们使用一个对所需次数的多项式精确的高斯求积方案。\n1.  对于 $(\\xi, \\eta)$ 上的参考三角形积分，被积函数是二次的。一个对最高 $2$ 次多项式精确的 $3$ 点求积法则就足够了。对于顶点在 $(0,0), (1,0), (0,1)$ 的参考三角形，其求积点 $(\\xi_i, \\eta_i)$ 和权重 $w_i^{\\text{tri}}$ 为：\n    *   点：$(1/2, 0), (0, 1/2), (1/2, 1/2)$\n    *   权重：每个点为 $w_i^{\\text{tri}} = 1/6$。这些权重对应于面积为 $1/2$ 的积分域。\n2.  对于 $\\zeta \\in [-1, 1]$ 上的积分，被积函数是二次的。问题要求一个至少 $3$ 次的积分法则。一个 $2$ 点的高斯-勒让德求积法则对最高 $2(2)-1 = 3$ 次的多项式是精确的，这满足了要求。其点 $\\zeta_j$ 和权重 $w_j^{\\zeta}$ 为：\n    *   点：$\\pm 1/\\sqrt{3}$\n    *   权重：每个点为 $w_j^{\\zeta} = 1$。\n\n然后通过对每个求积点的贡献求和来组装质量矩阵：\n$$\nM_{ab} \\approx |\\!J| \\sum_{j} w_j^{\\zeta} \\sum_{i} w_i^{\\text{tri}} N_a(\\xi_i, \\eta_i, \\zeta_j) N_b(\\xi_i, \\eta_i, \\zeta_j)\n$$\n这可以通过遍历所有 $3 \\times 2 = 6$ 个求积点来实现。在每个点上，计算形函数向量 $\\mathbf{N}$，其外积 $\\mathbf{N}^T \\mathbf{N}$ 乘以相应的总权重，然后加到质量矩阵 $\\mathbf{M}$ 上。一个求积点 $(\\xi_i, \\eta_i, \\zeta_j)$ 的总权重是 $|\\!J| \\cdot w_i^{\\text{tri}} \\cdot w_j^{\\zeta}$。\n\n然后数值计算得到的对称正定矩阵 $\\mathbf{M}$ 的特征值 $\\lambda_i$。\n\n对于测试用例中的分析，认识到质量矩阵的缩放行为至关重要。矩阵 $\\mathbf{M}$ 可以表示为：\n$$\n\\mathbf{M} = \\frac{s^2 h}{2} \\mathbf{M}_{\\text{ref}} = (A h) \\mathbf{M}_{\\text{ref}}\n$$\n其中 $\\mathbf{M}_{\\text{ref}}$ 是一个与几何参数 $s$ 和 $h$ 无关的常数参考质量矩阵。因此，$\\mathbf{M}$ 的特征值 $\\lambda_i$ 与单元体积 $V = A h$ 成正比：\n$$\n\\lambda_i = (A h) \\lambda_{i, \\text{ref}}\n$$\n其中 $\\lambda_{i, \\text{ref}}$ 是 $\\mathbf{M}_{\\text{ref}}$ 的常数特征值。这意味着归一化特征值 $\\lambda_i / (A h)$ 相对于单元的几何形状是不变的。这一原则解释了测试用例的预期结果：\n*   **测试用例 1 和 4**：归一化特征值谱与纵横比和尺度无关，因此它们的差应接近于零。\n*   **测试用例 2**：在固定 $s=1$ 时，体积 $A h = \\frac{s^3}{2} \\mathrm{AR} = \\frac{1}{2} \\mathrm{AR}$。因此，$\\lambda_{\\max} \\propto \\mathrm{AR}$。对数导数 $\\frac{d(\\ln \\lambda_{\\max})}{d(\\ln \\mathrm{AR})} = 1$。\n*   **测试用例 3**：在固定体积 $A h = V_0 = 1$ 时，特征值 $\\lambda_{\\max} = V_0 \\lambda_{\\max, \\text{ref}}$ 是常数。因此，它们对任何参数（包括 $\\mathrm{AR}$）的导数都为 $0$。\n\n实现将遵循这个稳健的理论和数值框架。", "answer": "```python\nimport numpy as np\nimport math\n\ndef get_quadrature_data():\n    \"\"\"\n    Provides quadrature points and weights for the reference wedge element.\n    - Triangle: 3-point rule, exact for degree 2 polynomials.\n    - Line: 2-point Gauss-Legendre rule, exact for degree 3 polynomials.\n    \"\"\"\n    # Triangle (xi, eta) quadrature for reference triangle with area 1/2\n    # Vertices at (0,0), (1,0), (0,1)\n    tri_points = np.array([\n        [0.5, 0.0],\n        [0.0, 0.5],\n        [0.5, 0.5]\n    ])\n    # Weights for a domain of area 1/2\n    tri_weights = np.array([1/6.0, 1/6.0, 1/6.0])\n\n    # 1D Gauss-Legendre quadrature for interval [-1, 1]\n    zeta_points = np.array([-1.0 / math.sqrt(3.0), 1.0 / math.sqrt(3.0)])\n    zeta_weights = np.array([1.0, 1.0])\n    \n    return tri_points, tri_weights, zeta_points, zeta_weights\n\ndef assemble_mass_matrix(s, h, quad_data):\n    \"\"\"\n    Assembles the 6x6 consistent mass matrix for a linear wedge element.\n    \n    Args:\n        s (float): Base scale of the triangular face.\n        h (float): Height of the wedge.\n        quad_data (tuple): Quadrature points and weights.\n\n    Returns:\n        numpy.ndarray: The 6x6 mass matrix.\n    \"\"\"\n    tri_points, tri_weights, zeta_points, zeta_weights = quad_data\n    mass_matrix = np.zeros((6, 6))\n    \n    # For this prismatic mapping, the coordinate transformation is\n    # (x,y,z) = (s*xi, s*eta, h/2 * (1+zeta)).\n    # The Jacobian matrix is diagonal with entries (s, s, h/2), so its \n    # determinant is constant: |J| = s^2 * h / 2.\n    jac_det = (s**2 * h) / 2.0\n    \n    # Pre-calculate shape function vector at each quadrature point\n    N_qp = np.zeros(6)\n    \n    for i in range(len(tri_points)):\n        xi, eta = tri_points[i]\n        w_tri = tri_weights[i]\n        \n        # Barycentric coordinates\n        L = np.array([1.0 - xi - eta, xi, eta])\n        \n        for j in range(len(zeta_points)):\n            zeta = zeta_points[j]\n            w_zeta = zeta_weights[j]\n            \n            # Linear functions in zeta direction\n            f_zeta = np.array([(1.0 - zeta) / 2.0, (1.0 + zeta) / 2.0])\n            \n            # Shape functions N_1 to N_6\n            N_qp[0:3] = L * f_zeta[0]  # Bottom face (zeta=-1)\n            N_qp[3:6] = L * f_zeta[1]  # Top face (zeta=+1)\n            \n            # Total weight for the current quadrature point\n            total_weight = jac_det * w_tri * w_zeta\n            \n            # Add contribution to the mass matrix\n            mass_matrix += np.outer(N_qp, N_qp) * total_weight\n            \n    return mass_matrix\n\ndef compute_sorted_eigs(s, h, quad_data):\n    \"\"\"Computes and sorts the eigenvalues of the mass matrix.\"\"\"\n    M = assemble_mass_matrix(s, h, quad_data)\n    # The mass matrix is symmetric, use eigvalsh for numerical stability and efficiency.\n    eigs = np.linalg.eigvalsh(M)\n    return np.sort(eigs)\n\ndef solve():\n    \"\"\"\n    Executes the test suite for the wedge element eigenvalue analysis.\n    \"\"\"\n    quad_data = get_quadrature_data()\n    results = []\n\n    # Test Case 1: Normalized eigenvalue invariance\n    s = 1.0\n    ar_a, ar_b = 0.5, 3.0\n    h_a, h_b = ar_a * s, ar_b * s\n    vol_a, vol_b = (s**2 / 2.0) * h_a, (s**2 / 2.0) * h_b\n    \n    eigs_a = compute_sorted_eigs(s, h_a, quad_data)\n    eigs_b = compute_sorted_eigs(s, h_b, quad_data)\n    \n    norm_eigs_a = eigs_a / vol_a\n    norm_eigs_b = eigs_b / vol_b\n  \n    result1 = np.max(np.abs(norm_eigs_a - norm_eigs_b))\n    results.append(result1)\n\n    # Test Case 2: Logarithmic sensitivity at fixed base scale\n    s = 1.0\n    ar0 = 1.2\n    delta = 1.0e-4\n    ar_plus, ar_minus = ar0 + delta, ar0 - delta\n\n    h_plus, h_minus = ar_plus * s, ar_minus * s\n\n    lambda_max_plus = compute_sorted_eigs(s, h_plus, quad_data)[-1]\n    lambda_max_minus = compute_sorted_eigs(s, h_minus, quad_data)[-1]\n\n    log_deriv_num = math.log(lambda_max_plus) - math.log(lambda_max_minus)\n    log_deriv_den = math.log(ar_plus) - math.log(ar_minus)\n    result2 = log_deriv_num / log_deriv_den\n    results.append(result2)\n\n    # Test Case 3: Logarithmic sensitivity at fixed volume\n    v0 = 1.0\n    ar0 = 1.2\n    delta = 1.0e-4\n    ar_plus, ar_minus = ar0 + delta, ar0 - delta\n\n    def get_geom_from_vol_ar(v, ar):\n        s = (2.0 * v / ar)**(1.0/3.0)\n        h = ar * s\n        return s, h\n\n    s_plus, h_plus = get_geom_from_vol_ar(v0, ar_plus)\n    s_minus, h_minus = get_geom_from_vol_ar(v0, ar_minus)\n\n    lambda_max_plus = compute_sorted_eigs(s_plus, h_plus, quad_data)[-1]\n    lambda_max_minus = compute_sorted_eigs(s_minus, h_minus, quad_data)[-1]\n\n    log_deriv_num = math.log(lambda_max_plus) - math.log(lambda_max_minus)\n    log_deriv_den = math.log(ar_plus) - math.log(ar_minus)\n    result3 = log_deriv_num / log_deriv_den\n    results.append(result3)\n\n    # Test Case 4: Near-degenerate geometric scaling check\n    s_a, ar_a = 1.0, 1.0\n    h_a = s_a * ar_a\n    vol_a = (s_a**2 / 2.0) * h_a\n    eigs_a = compute_sorted_eigs(s_a, h_a, quad_data)\n    norm_eigs_a = eigs_a / vol_a\n\n    s_b, ar_b = 1.0e-3, 1.0e3\n    h_b = s_b * ar_b  # h_b = 1.0\n    vol_b = (s_b**2 / 2.0) * h_b # vol_b = 0.5e-6\n    eigs_b = compute_sorted_eigs(s_b, h_b, quad_data)\n    norm_eigs_b = eigs_b / vol_b\n   \n    result4 = np.linalg.norm(norm_eigs_a - norm_eigs_b)\n    results.append(result4)\n\n    # Format the final output\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```", "id": "2611725"}]}