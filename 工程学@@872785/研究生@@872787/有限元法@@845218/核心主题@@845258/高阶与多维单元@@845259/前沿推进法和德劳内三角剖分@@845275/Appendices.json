{"hands_on_practices": [{"introduction": "在构建任何三角形网格之前，我们需要一个可靠的方法来确定其基本组成部分——三角形的方向。一个三角形的顶点是按顺时针还是逆时针列出，这不仅仅是一个约定，它对于确保整个网格的几何一致性和许多后续计算（如判断一个点是否在三角形内）至关重要。本练习将引导您从第一性原理出发，推导出用于判断方向的 $\\mathrm{orient2d}$ 谓词，揭示一个简单的行列式如何与“方向”这一几何概念联系起来。[@problem_id:2540789]", "problem": "在有限元方法 (FEM) 的网格生成背景下，能够稳健区分几何构型的判定函数对于前沿推进网格生成和Delaunay三角剖分都至关重要。考虑平面上的三个非共线点 $a=(a_x,a_y)$、$b=(b_x,b_y)$ 和 $c=(c_x,c_y)$。请仅使用平面向量几何和行列式的基本原理，推导方向判定函数 $\\mathrm{orient2d}(a,b,c)$ 的表达式，该表达式应为一个由以 $a$ 为基准点的差分向量构成的 $2\\times 2$ 行列式。您的推导必须从 $\\mathbb{R}^2$ 中由两个向量张成的平行四边形的有符号面积的定义开始，并解释为什么 $\\mathrm{orient2d}(a,b,c)$ 的符号可以确定三角形 $(a,b,c)$ 是逆时针、顺时针还是退化的。简要地将此符号与前沿推进算法中如何强制执行单元方向以及Delaunay三角剖分中边翻转的一致性要求联系起来。\n\n完成推导和解释后，对特定点 $a=(1,-1)$、$b=(5,3)$ 和 $c=(2,6)$ 计算所得方向判定函数的值。只需报告这三个点的方向判定函数的最终数值。无需四舍五入；给出不带单位的精确值。", "solution": "所述问题是有效的。它在计算几何和数值分析方面有科学依据，是良定的、客观的，并包含完整推导和计算所需的所有必要信息。我将开始作答。\n\n基本任务是为平面上三个点的方向建立一个代数检验。设这三个点为 $a=(a_x, a_y)$、$b=(b_x, b_y)$ 和 $c=(c_x, c_y)$。通过考察这些点形成的向量可以理解其方向。我们将坐标系的原点固定在点 $a$ 上，并定义两个向量：从 $a$ 到 $b$ 的向量 $\\vec{u}$，以及从 $a$ 到 $c$ 的向量 $\\vec{v}$。\n\n这些向量的分量形式为：\n$$\n\\vec{u} = b - a = (b_x - a_x, b_y - a_y)\n$$\n$$\n\\vec{v} = c - a = (c_x - a_x, c_y - a_y)\n$$\n\n问题要求从平行四边形的有符号面积开始推导。在 $\\mathbb{R}^2$ 中，由两个向量 $\\vec{u} = (u_x, u_y)$ 和 $\\vec{v} = (v_x, v_y)$ 张成的平行四边形的有符号面积由以这些向量为列（或行）的矩阵的行列式给出。让我们以 $\\vec{u}$ 和 $\\vec{v}$ 为列构造这个矩阵：\n$$\n\\text{Area}(\\vec{u}, \\vec{v}) = \\det(\\begin{bmatrix} \\vec{u}  \\vec{v} \\end{bmatrix}) = \\det \\begin{pmatrix} u_x  v_x \\\\ u_y  v_y \\end{pmatrix} = u_x v_y - u_y v_x\n$$\n代入我们的差分向量的分量，即可得到方向判定函数 $\\mathrm{orient2d}(a,b,c)$ 的表达式。该判定函数定义为三角形 $\\triangle abc$ 有符号面积的两倍，这恰好是由向量 $b-a$ 和 $c-a$ 张成的平行四边形的有符号面积。\n$$\n\\mathrm{orient2d}(a,b,c) = \\det \\begin{pmatrix} b_x - a_x  c_x - a_x \\\\ b_y - a_y  c_y - a_y \\end{pmatrix}\n$$\n这就是所要求的表达式：一个由以点 $a$ 为基准点的差分向量构成的 $2 \\times 2$ 行列式。\n\n这个行列式的符号决定了方向。为了理解原因，我们可以将问题嵌入到 $\\mathbb{R}^3$ 中。令 $\\vec{u}' = (u_x, u_y, 0)$ 和 $\\vec{v}' = (v_x, v_y, 0)$ 为我们位于 $xy$ 平面内的向量的三维表示。它们的叉积为：\n$$\n\\vec{u}' \\times \\vec{v}' = \\det \\begin{pmatrix} \\mathbf{i}  \\mathbf{j}  \\mathbf{k} \\\\ u_x  u_y  0 \\\\ v_x  v_y  0 \\end{pmatrix} = (u_x v_y - u_y v_x) \\mathbf{k}\n$$\n这个叉积的模 $|u_x v_y - u_y v_x|$ 是平行四边形的面积。所得向量的方向平行于 $z$ 轴，根据右手法则指示了方向。\n\\begin{enumerate}\n    \\item 如果 $\\mathrm{orient2d}(a,b,c) = u_x v_y - u_y v_x > 0$，向量 $\\vec{u}' \\times \\vec{v}'$ 指向正 $z$ 方向。根据右手法则，从 $\\vec{u}$ 到 $\\vec{v}$ 的转动是逆时针 (CCW) 的。这对应于点 $(a,b,c)$ 的逆时针排序。\n    \\item 如果 $\\mathrm{orient2d}(a,b,c) = u_x v_y - u_y v_x  0$，向量 $\\vec{u}' \\times \\vec{v}'$ 指向负 $z$ 方向。从 $\\vec{u}$ 到 $\\vec{v}$ 的转动是顺时针 (CW) 的。这对应于点 $(a,b,c)$ 的顺时针排序。\n    \\item 如果 $\\mathrm{orient2d}(a,b,c) = u_x v_y - u_y v_x = 0$，向量 $\\vec{u}$ 和 $\\vec{v}$ 共线，意味着叉积为零向量。点 $a,b,c$ 位于一条直线上，这是一个退化构型。\n\\end{enumerate}\n\n在有限元方法 (FEM) 的背景下，这个判定函数至关重要。\n对于**前沿推进网格生成**，算法通过沿边的“前沿”逐个添加三角形单元来构建网格。当通过连接前沿上的一条边（例如从点 $p_1$ 到 $p_2$）到一个新点 $p_3$ 来创建一个新三角形时，整个网格的方向必须保持一致，通常为逆时针 (CCW)。计算判定函数 $\\mathrm{orient2d}(p_1, p_2, p_3)$。如果结果为正，则单元 $(p_1, p_2, p_3)$ 被接受。如果为负，则该单元是“内外翻转”的，因而无效。必须将顶点顺序更改为 $(p_1, p_3, p_2)$ 或拒绝点 $p_3$。这种一致性确保了从参考单元到物理单元的映射的雅可比矩阵为正，这是获得有效数值解的必要条件。\n\n对于**Delaunay三角剖分**，特别是在涉及边翻转的算法（如Lawson算法）中，方向判定函数是隐含的基础。如果翻转能够改善局部Delaunay属性，那么两个三角形共享的一条边就会被翻转。此属性通过`incircle`判定函数来检查，该函数确定一个点是否位于一个三角形的外接圆内部。`incircle`判定函数本身可以表示为一个 $3 \\times 3$ 的行列式，其求值依赖于等价于`orient2d`计算的子式。边翻转后，会形成两个新的三角形。必须使用方向判定函数以正确的顶点顺序（例如，CCW）构造这些新三角形，以确保整个网格数据结构的几何和拓扑一致性。没有稳健的方向检查，算法可能会生成损坏的网格。\n\n最后，我将对给定的点 $a=(1,-1)$、$b=(5,3)$ 和 $c=(2,6)$ 计算该判定函数。\n首先，我们计算以 $a$ 为基准点的差分向量：\n$$\nb - a = (5 - 1, 3 - (-1)) = (4, 4)\n$$\n$$\nc - a = (2 - 1, 6 - (-1)) = (1, 7)\n$$\n现在，我们计算这个 $2 \\times 2$ 行列式：\n$$\n\\mathrm{orient2d}(a,b,c) = \\det \\begin{pmatrix} 4  1 \\\\ 4  7 \\end{pmatrix} = (4)(7) - (1)(4) = 28 - 4 = 24\n$$\n值为 $24$。由于该值为正，点 $(a,b,c)$ 构成一个逆时针方向的三角形。", "answer": "$$\n\\boxed{24}\n$$", "id": "2540789"}, {"introduction": "Delaunay 三角剖分的“空外接圆”准则是其核心定义，但这个概念可能显得有些抽象。本练习旨在将这一抽象规则具体化。通过亲手计算一个三角形的外心和外接圆半径，您将能够直接检验另一个点是否违反了 Delaunay 条件，从而对这一关键属性建立清晰、几何化的理解。[@problem_id:2540805]", "problem": "在前沿推进法（AFM）的平面网格生成步骤中，正在考虑一组候选点以进行Delaunay细化检查。给定四个不同的点 $A(0,0)$、$B(6,0)$、$C(2,4)$ 和 $D(5,5)$，考虑三角形 $ABC$ 以及可能加入点 $D$ 的情况。\n\n从基本原理出发，使用以下基本定义：\n\n- 三角形的外心是到所有三个顶点等距的唯一一个点，它与三角形各边的垂直平分线的交点重合。\n- 外接圆半径是外心到三角形任意一个顶点的公共距离。\n- Delaunay三角剖分的空外接圆条件规定，对于每个三角形，没有其他输入点严格位于其外接圆内部。\n\n请进行以下步骤：\n1. 通过求相应垂直平分线的交点来确定三角形 $ABC$ 的外心 $O$。\n2. 根据外心 $O$ 和任意一个顶点确定三角形 $ABC$ 的外接圆半径 $R$。\n3. 使用空外接圆条件，通过计算Delaunay边距\n$$m \\equiv \\|O-D\\|^{2} - R^{2},$$\n来评估点 $D$ 是否位于三角形 $ABC$ 的外接圆之外，其中 $\\|O-D\\|^{2}$ 是从 $O$ 到 $D$ 的欧几里得距离的平方。\n\n将单个实数 $m$ 作为你的最终答案。不要四舍五入；请提供精确值。无需单位。", "solution": "问题陈述已经过验证，被认为是科学上可靠、良定、客观且自洽的。这是计算几何中的一个标准问题，没有逻辑或事实上的不一致。因此，将提供一个解决方案。\n\n该问题要求计算点 $D(5,5)$ 相对于由顶点 $A(0,0)$、$B(6,0)$ 和 $C(2,4)$ 构成的三角形 $ABC$ 的Delaunay边距 $m$。该边距定义为 $m \\equiv \\|O-D\\|^{2} - R^{2}$，其中 $O$ 是三角形 $ABC$ 的外心，$R$ 是其外接圆半径。\n\n首先，我们确定三角形 $ABC$ 的外心 $O(x_O, y_O)$。外心是三角形各边垂直平分线的交点。\n\n边 $AB$ 的垂直平分线：\n顶点坐标为 $A(0,0)$ 和 $B(6,0)$。\n线段 $AB$ 的中点是 $M_{AB} = \\left(\\frac{0+6}{2}, \\frac{0+0}{2}\\right) = (3,0)$。\n线段 $AB$ 的斜率是 $m_{AB} = \\frac{0-0}{6-0} = 0$。该线段是水平的。\n垂直平分线必然是一条经过 $M_{AB}$ 的垂直线。因此其方程为 $x = 3$。\n\n边 $AC$ 的垂直平分线：\n顶点坐标为 $A(0,0)$ 和 $C(2,4)$。\n线段 $AC$ 的中点是 $M_{AC} = \\left(\\frac{0+2}{2}, \\frac{0+4}{2}\\right) = (1,2)$。\n线段 $AC$ 的斜率是 $m_{AC} = \\frac{4-0}{2-0} = 2$。\n垂直平分线的斜率是 $m_{AC}$ 的负倒数，即 $m_{\\perp AC} = -\\frac{1}{2}$。\n使用点斜式方程 $y - y_1 = m(x - x_1)$，代入点 $M_{AC}(1,2)$ 和斜率 $m_{\\perp AC} = -\\frac{1}{2}$，垂直平分线的方程为：\n$$ y - 2 = -\\frac{1}{2}(x - 1) $$\n$$ y = -\\frac{1}{2}x + \\frac{1}{2} + 2 $$\n$$ y = -\\frac{1}{2}x + \\frac{5}{2} $$\n\n外心 $O(x_O, y_O)$ 是这两条直线的交点。我们得到方程组：\n$$ \\begin{cases} x_O = 3 \\\\ y_O = -\\frac{1}{2}x_O + \\frac{5}{2} \\end{cases} $$\n将 $x_O = 3$ 代入第二个方程得到：\n$$ y_O = -\\frac{1}{2}(3) + \\frac{5}{2} = -\\frac{3}{2} + \\frac{5}{2} = \\frac{2}{2} = 1 $$\n因此，外心是 $O(3,1)$。\n\n第二步，我们确定三角形 $ABC$ 的外接圆半径的平方 $R^2$。$R^2$ 是外心 $O$到任意一个顶点的距离的平方。使用顶点 $A(0,0)$：\n$$ R^2 = \\|O-A\\|^2 = (x_O - x_A)^2 + (y_O - y_A)^2 $$\n$$ R^2 = (3-0)^2 + (1-0)^2 = 3^2 + 1^2 = 9 + 1 = 10 $$\n外接圆半径的平方为 $R^2 = 10$。\n\n第三步，我们评估Delaunay边距 $m$。公式为 $m \\equiv \\|O-D\\|^{2} - R^{2}$。点 $D$ 的坐标是 $(5,5)$。\n我们首先计算从 $O$ 到 $D$ 的欧几里得距离的平方：\n$$ \\|O-D\\|^2 = (x_O - x_D)^2 + (y_O - y_D)^2 $$\n$$ \\|O-D\\|^2 = (3-5)^2 + (1-5)^2 = (-2)^2 + (-4)^2 = 4 + 16 = 20 $$\n现在，我们可以求出边距 $m$：\n$$ m = \\|O-D\\|^2 - R^2 = 20 - 10 = 10 $$\nDelaunay边距的值是 $10$。正值表示点 $D$ 严格位于三角形 $ABC$ 的外接圆之外。", "answer": "$$ \\boxed{10} $$", "id": "2540805"}, {"introduction": "在实际应用中，我们常常需要对带有预定义边界或内部特征线（称为“约束”）的区域进行网格剖分。这要求我们将标准的 Delaunay 三角剖分推广为“约束 Delaunay 三角剖分”（CDT）。这个过程的关键一步是保护这些约束线段不被破坏。本练习聚焦于此过程中的一个核心环节：推导“侵入测试”，它能防止新插入的点过于靠近约束边，从而保证网格的质量和有效性。[@problem_id:2540788]", "problem": "在一个结合了前沿推进法 (AFM) 和约束德劳内三角化 (CDT) 的二维网格生成程序中，必须检测并解决候选顶点对约束边的侵占问题，以保持整合性并维护德劳内属性。考虑一个由端点 $A=(x_{a},y_{a})$ 和 $B=(x_{b},y_{b})$ 定义的约束边，以及一个候选点 $P=(x_{p},y_{p})$（例如，由前沿推进法产生的狭长三角形的外心）。点 $P$ 对边 $AB$ 的侵占由 $P$ 相对于 $AB$ 的直径圆（即以 $AB$ 为直径的唯一圆）的位置来定义。\n\n仅使用欧几里得内积、欧几里得范数和圆的定义，从第一性原理推导出一个单一标量值的侵占指示符 $f(A,B,P)$，其符号约定如下：\n- 当且仅当 $P$ 严格位于 $AB$ 的直径圆内部时（发生侵占），$f(A,B,P)0$。\n- 当且仅当 $P$ 位于 $AB$ 的直径圆上时，$f(A,B,P)=0$。\n- 当且仅当 $P$ 严格位于 $AB$ 的直径圆外部时，$f(A,B,P)0$。\n\n将你的最终结果表示为一个以 $(x_{a},y_{a})$、$(x_{b},y_{b})$ 和 $(x_{p},y_{p})$ 表示的、坐标展开的显式解析表达式。此外，（定性地）解释在基于 CDT 的 AFM 中如何通过在边上插入顶点来解决侵占问题，并说明为什么这样做能保持约束整合性并支持德劳内属性。你的最终答案必须是 $f(A,B,P)$ 的坐标展开的显式表达式。无需四舍五入。", "solution": "所给问题陈述是计算几何领域中一个定义明确的练习，具体涉及约束德劳内三角化（CDT）的生成。它具有科学依据、内容自洽且客观。所有必要的几何实体和条件都已指明，所要求的输出也有明确定义。不存在逻辑矛盾、科学不准确性或病态元素。因此，该问题被认为是**有效的**，并将按要求从第一性原理推导求解。\n\n任务是推导一个标量值函数 $f(A, B, P)$，用以指示点 $P=(x_{p},y_{p})$ 是位于以点 $A=(x_{a},y_{a})$ 和 $B=(x_{b},y_{b})$ 定义的线段为直径的唯一圆的内部、上方还是外部。推导必须基于欧几里得几何的基本定义。\n\n设边 $AB$ 的直径圆记为 $\\mathcal{C}$。根据定义，该圆的圆心（我们称之为 $C$）是线段 $AB$ 的中点。圆心 $C$ 的位置向量由 $A$ 和 $B$ 的位置向量的算术平均值给出：\n$$\nC = \\frac{A + B}{2}\n$$\n圆 $\\mathcal{C}$ 的半径（记为 $R$）是其直径 $AB$ 长度的一半。直径的长度是从 $A$ 到 $B$ 的向量的欧几里得范数，记为 $\\|B-A\\|$。因此，半径为：\n$$\nR = \\frac{1}{2} \\|B-A\\|\n$$\n所以半径的平方是：\n$$\nR^{2} = \\left(\\frac{1}{2}\\right)^{2} \\|B-A\\|^{2} = \\frac{1}{4} \\|B-A\\|^{2}\n$$\n如果点 $P$ 到圆心 $C$ 的距离恰好等于半径 $R$，则定义 $P$ 在圆 $\\mathcal{C}$ 上。如果其距离小于 $R$，则它在圆内；如果距离大于 $R$，则在圆外。为了避免平方根运算，使用距离的平方进行计算在计算上更为稳健和高效。该条件可表示如下：\n- 当且仅当 $\\|P-C\\|^{2}  R^{2}$ 时，$P$ 在 $\\mathcal{C}$ 内部。\n- 当且仅当 $\\|P-C\\|^{2} = R^{2}$ 时，$P$ 在 $\\mathcal{C}$ 上。\n- 当且仅当 $\\|P-C\\|^{2}  R^{2}$ 时，$P$ 在 $\\mathcal{C}$ 外部。\n\n现在，我们可以定义侵占指示符函数 $f(A,B,P)$ 以匹配所需的符号约定，将其设为点 $P$ 到 $C$ 的距离平方与半径平方之差：\n$$\nf(A,B,P) = \\|P-C\\|^{2} - R^{2}\n$$\n这个定义精确地满足了问题的符号要求。现在我们代入 $C$ 和 $R^{2}$ 的表达式，并利用欧几里得内积的性质（对于任意向量 $v$，$ \\|v\\|^{2} = v \\cdot v$）进行化简。\n$$\nf(A,B,P) = \\left\\|P - \\frac{A+B}{2}\\right\\|^{2} - \\frac{1}{4} \\|B-A\\|^{2}\n$$\n使用内积展开各项：\n$$\nf(A,B,P) = \\left(P - \\frac{A+B}{2}\\right) \\cdot \\left(P - \\frac{A+B}{2}\\right) - \\frac{1}{4} (B-A) \\cdot (B-A)\n$$\n我们展开点积。首先，是涉及 $P$ 的项：\n$$\n\\left(P - \\frac{A+B}{2}\\right) \\cdot \\left(P - \\frac{A+B}{2}\\right) = P \\cdot P - 2 \\left(P \\cdot \\frac{A+B}{2}\\right) + \\left(\\frac{A+B}{2}\\right) \\cdot \\left(\\frac{A+B}{2}\\right)\n$$\n$$\n= P \\cdot P - P \\cdot (A+B) + \\frac{1}{4} (A+B) \\cdot (A+B)\n$$\n现在我们将其代回到 $f(A,B,P)$ 的表达式中：\n$$\nf(A,B,P) = P \\cdot P - P \\cdot (A+B) + \\frac{1}{4} (A+B) \\cdot (A+B) - \\frac{1}{4} (B-A) \\cdot (B-A)\n$$\n让我们展开 $(A+B) \\cdot (A+B)$ 和 $(B-A) \\cdot (B-A)$ 这两项：\n$$\n(A+B) \\cdot (A+B) = A \\cdot A + 2(A \\cdot B) + B \\cdot B = \\|A\\|^{2} + 2(A \\cdot B) + \\|B\\|^{2}\n$$\n$$\n(B-A) \\cdot (B-A) = B \\cdot B - 2(A \\cdot B) + A \\cdot A = \\|B\\|^{2} - 2(A \\cdot B) + \\|A\\|^{2}\n$$\n代入这些展开式：\n$$\nf(A,B,P) = P \\cdot P - P \\cdot A - P \\cdot B + \\frac{1}{4} \\left( \\|A\\|^{2} + 2(A \\cdot B) + \\|B\\|^{2} \\right) - \\frac{1}{4} \\left( \\|B\\|^{2} - 2(A \\cdot B) + \\|A\\|^{2} \\right)\n$$\n项 $\\|A\\|^{2}$ 和 $\\|B\\|^{2}$ 相互抵消：\n$$\nf(A,B,P) = P \\cdot P - P \\cdot A - P \\cdot B + \\frac{1}{4} \\left( 4(A \\cdot B) \\right)\n$$\n$$\nf(A,B,P) = P \\cdot P - P \\cdot A - P \\cdot B + A \\cdot B\n$$\n这个表达式可以通过分组项进行优雅地因式分解：\n$$\nf(A,B,P) = P \\cdot (P - A) - B \\cdot (P - A) = (P - B) \\cdot (P - A)\n$$\n这个最终的向量形式 $f(A,B,P) = (P-A) \\cdot (P-B)$ 是一个已知的几何结果，与泰勒斯定理直接相关。如果点 $P$ 分别位于 $AB$ 直径圆的外部、上方或内部，则向量 $\\vec{PA} = A-P$ 和 $\\vec{PB} = B-P$ 之间的夹角 $\\theta=\\angle APB$ 分别为锐角、直角或钝角。点积 $(A-P) \\cdot (B-P)$（其值等于 $\\|A-P\\| \\|B-P\\| \\cos(\\theta)$）的符号直接对应于这个几何条件，并与我们推导的符号约定相匹配。\n\n为了得到最终的坐标展开表达式，我们用分量来定义向量 $P-A$ 和 $P-B$：\n$$\nP-A = (x_{p} - x_{a}, y_{p} - y_{a})\n$$\n$$\nP-B = (x_{p} - x_{b}, y_{p} - y_{b})\n$$\n于是点积为：\n$$\nf(A,B,P) = (x_{p} - x_{a})(x_{p} - x_{b}) + (y_{p} - y_{a})(y_{p} - y_{b})\n$$\n这就是所要求的标量值侵占指示符。\n\n最后，问题要求对侵占的解决方法进行定性解释。在基于 CDT 的网格生成中，特别是在像 Ruppert 算法这样的高质量网格生成算法中，必须尊重约束边。一个三角形的外心 $P$ 侵占了边 $AB$ 是有问题的，因为它在广义上违反了空外接圆属性，并可能导致网格单元质量差或算法不终止。\n\n标准的解决方法是**分割被侵占的边**。一个新顶点（通常是边 $AB$ 的中点 $M$）被插入到三角剖分中。这一单一操作有两个关键后果：\n$1$. **保持约束整合性**：原约束边 $AB$ 从约束集中移除，并被两个新的、更小的约束边 $AM$ 和 $MB$ 所取代。在几何上，由该约束定义的线保持不变，确保了三角剖分仍然“符合”所要求的边界。\n$2$. **支持德劳内属性**：新边 $AM$ 和 $MB$ 的长度是 $AB$ 的一半。因此，它们的直径圆要小得多（半径减半）。侵占点 $P$ 现在位于 $AM$ 和 $MB$ 这两个较小直径圆的外部，从而解决了相对于点 $P$ 的侵占问题。这个分割过程会递归地应用于任何新出现的被侵占边。已经证明，这种递归分割过程是会终止的，它是一个基本机制，保证最终的网格不仅是一个有效的 CDT，而且还具有一定的质量保证，例如所有三角形的最小角下界。", "answer": "$$\n\\boxed{(x_{p} - x_{a})(x_{p} - x_{b}) + (y_{p} - y_{a})(y_{p} - y_{b})}\n$$", "id": "2540788"}]}