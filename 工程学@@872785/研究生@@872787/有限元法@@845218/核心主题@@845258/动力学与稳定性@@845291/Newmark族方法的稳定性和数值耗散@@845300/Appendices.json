{"hands_on_practices": [{"introduction": "对任何数值方法，深刻的理解都源于对其核心性质的分析。本练习将引导您完整地推导Newmark族中的一个经典方法——线性加速度法。通过从第一性原理出发，推导其稳定性极限、色散关系和相位误差 [@problem_id:2598061]，您将掌握评估时间积分方案所需的基础分析工具。", "problem": "考虑由有限元法 (FEM) 产生的无阻尼、线性、半离散弹性动力学模型：\n$$\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0},$$ \n其中质量矩阵 $\\mathbf{M}$ 和刚度矩阵 $\\mathbf{K}$ 均为对称正定矩阵。通过标准模态分析，每个质量归一化模态 $q(t)$ 满足单自由度 (SDOF) 常微分方程 (ODE) \n$$\\ddot{q}(t) + \\omega^{2} q(t) = 0,$$ \n其中 $\\omega$ 是该模态的精确圆频率。将具有线性加速度参数 $(\\beta,\\gamma)=(1/6,1/2)$ 和恒定时间步长 $\\Delta t$ 的 Newmark 族方法应用于此单自由度模态方程。\n\n仅从半离散常微分方程和 $(\\beta,\\gamma)=(1/6,1/2)$ 的 Newmark 族方法的定义出发，推导由此 Newmark 格式控制的离散模态位移 $\\{q_{n}\\}_{n\\in\\mathbb{Z}}$ 的单步放大关系。然后利用该关系：\n\n- 推导离散色散关系，即在设 ansatz $q_{n} \\propto \\exp(\\mathrm{i}\\, n\\, \\bar{\\rho})$ 的条件下，精确无量纲频率 $\\rho := \\omega\\,\\Delta t$ 与每步的数值相增量 $\\bar{\\rho}$ (以弧度为单位) 之间的函数关系。\n- 确定此模态线性稳定的临界时间步长 $\\Delta t_{c}$，其定义为使单步放大映射的谱半径不超过 $1$ 的最大 $\\Delta t$。\n- 评估当 $\\Delta t \\to 0$ 时，该方法相对于精确动力学的领先阶相位误差，该误差定义为 \n$$\\frac{\\bar{\\omega} - \\omega}{\\omega}, \\quad \\text{其中} \\quad \\bar{\\omega} := \\frac{\\bar{\\rho}}{\\Delta t},$$\n表示为一个在 $\\rho$ 的幂次上截断到第一个非零项的渐近级数。\n\n将您的最终答案以一个包含三个条目的行矩阵形式给出，顺序和形式如下：\n(1) $\\bar{\\rho}$ 关于 $\\rho$ 的解析表达式（以弧度为单位），\n(2) $\\Delta t_{c}$ 关于 $\\omega$ 的解析表达式（时间单位与 $\\Delta t$ 的单位相同），以及\n(3) 相对相位误差关于 $\\rho$ 的领先阶解析表达式（无量纲）。最终的方框答案中不包含单位。无需进行数值舍入。", "solution": "所给出的问题陈述是结构动力学数值方法分析中的一个标准的、适定的练习。它具有科学依据，是客观且自洽的。所有提供的信息，包括控制常微分方程 (ODE)、特定的 Newmark 参数 $(\\beta, \\gamma)$ 以及稳定性和相位误差的定义，在计算力学领域都是标准且正确的。因此，该问题被判定为 **有效**，我将继续进行解答。\n\n单个质量归一化模态的运动由单自由度 (SDOF) 方程控制：\n$$\n\\ddot{q}(t) + \\omega^2 q(t) = 0\n$$\n其中 $\\omega$ 是该模态的精确圆频率。我们应用 Newmark 族时间积分算法。从时间步 $n$ 到 $n+1$ 的位移 $q$ 和速度 $\\dot{q}$ 的通用更新规则是：\n$$\nq_{n+1} = q_n + \\Delta t \\dot{q}_n + (\\Delta t)^2 \\left[ \\left(\\frac{1}{2} - \\beta\\right) \\ddot{q}_n + \\beta \\ddot{q}_{n+1} \\right]\n$$\n$$\n\\dot{q}_{n+1} = \\dot{q}_n + \\Delta t \\left[ (1 - \\gamma) \\ddot{q}_n + \\gamma \\ddot{q}_{n+1} \\right]\n$$\n问题指定了线性加速度法，其参数为 $(\\beta, \\gamma) = (1/6, 1/2)$。参数 $\\gamma=1/2$ 确保该方法是二阶精确的，并且没有数值耗散。对于 $\\gamma=1/2$ 的特殊情况，Newmark 更新可以组合成关于离散位移 $\\{q_n\\}$ 的单个三项递推关系。在时间步 $n-1$、$n$ 和 $n+1$ 处评估离散运动方程 $\\ddot{q}_{n} + \\omega^2 q_{n} = 0$，并代入著名的 Newmark 方法三点差分公式，可得：\n$$\nq_{n+1} - 2q_n + q_{n-1} = (\\Delta t)^2 \\left[ \\beta \\ddot{q}_{n+1} + (1-2\\beta) \\ddot{q}_n + \\beta \\ddot{q}_{n-1} \\right]\n$$\n我们在每个时间步强制执行离散运动方程，即对于 $k \\in \\{n-1, n, n+1\\}$，有 $\\ddot{q}_k = -\\omega^2 q_k$。将其代入递推关系中得到：\n$$\nq_{n+1} - 2q_n + q_{n-1} = -(\\omega \\Delta t)^2 \\left[ \\beta q_{n+1} + (1-2\\beta) q_n + \\beta q_{n-1} \\right]\n$$\n引入无量纲频率 $\\rho := \\omega \\Delta t$，我们重新整理各项：\n$$\n(1 + \\beta \\rho^2) q_{n+1} - (2 - (1 - 2\\beta)\\rho^2) q_n + (1 + \\beta \\rho^2) q_{n-1} = 0\n$$\n为了找到离散色散关系，我们代入 ansatz $q_n = C \\exp(\\mathrm{i} n \\bar{\\rho})$，其中 $C$ 是一个常数，$\\bar{\\rho}$ 是每步的数值相增量。\n$$\n(1 + \\beta \\rho^2) \\exp(\\mathrm{i} (n+1) \\bar{\\rho}) - (2 - (1 - 2\\beta)\\rho^2) \\exp(\\mathrm{i} n \\bar{\\rho}) + (1 + \\beta \\rho^2) \\exp(\\mathrm{i} (n-1) \\bar{\\rho}) = 0\n$$\n除以 $C \\exp(\\mathrm{i} n \\bar{\\rho})$ 并使用欧拉公式 $\\exp(\\mathrm{i}\\bar{\\rho}) + \\exp(-\\mathrm{i}\\bar{\\rho}) = 2\\cos(\\bar{\\rho})$，我们得到：\n$$\n(1 + \\beta \\rho^2) (\\exp(\\mathrm{i}\\bar{\\rho}) + \\exp(-\\mathrm{i}\\bar{\\rho})) = 2 - (1 - 2\\beta)\\rho^2\n$$\n$$\n2(1 + \\beta \\rho^2) \\cos(\\bar{\\rho}) = 2 - (1 - 2\\beta)\\rho^2\n$$\n$$\n\\cos(\\bar{\\rho}) = \\frac{1 - (\\frac{1}{2} - \\beta)\\rho^2}{1 + \\beta \\rho^2}\n$$\n对于线性加速度法，$\\beta = 1/6$。代入此值：\n$$\n\\cos(\\bar{\\rho}) = \\frac{1 - (\\frac{1}{2} - \\frac{1}{6})\\rho^2}{1 + \\frac{1}{6}\\rho^2} = \\frac{1 - \\frac{1}{3}\\rho^2}{1 + \\frac{1}{6}\\rho^2}\n$$\n求解 $\\bar{\\rho}$ 得到第一个所需结果，即离散色散关系：\n$$\n\\bar{\\rho} = \\arccos\\left(\\frac{1 - \\frac{\\rho^2}{3}}{1 + \\frac{\\rho^2}{6}}\\right)\n$$\n\n接下来，我们确定线性稳定性极限。对于无耗散方法 ($\\gamma=1/2$)，其稳定性的一个充要条件是其放大矩阵的特征值位于单位圆上。这等价于要求 $\\cos(\\bar{\\rho})$ 的值为实数且在区间 $[-1, 1]$ 内。\n$$\n-1 \\le \\frac{1 - \\frac{\\rho^2}{3}}{1 + \\frac{\\rho^2}{6}} \\le 1\n$$\n由于 $\\rho^2 = (\\omega \\Delta t)^2 \\ge 0$，分母 $1 + \\rho^2/6$ 总是正的。我们可以分别分析这两个不等式。\n右侧不等式：\n$$\n1 - \\frac{\\rho^2}{3} \\le 1 + \\frac{\\rho^2}{6} \\implies -\\frac{\\rho^2}{3} \\le \\frac{\\rho^2}{6} \\implies 0 \\le \\frac{\\rho^2}{2}\n$$\n这对任何实数 $\\rho$ 都成立。\n左侧不等式设定了稳定性极限：\n$$\n-1 \\le \\frac{1 - \\frac{\\rho^2}{3}}{1 + \\frac{\\rho^2}{6}} \\implies -(1 + \\frac{\\rho^2}{6}) \\le 1 - \\frac{\\rho^2}{3}\n$$\n$$\n-1 - \\frac{\\rho^2}{6} \\le 1 - \\frac{\\rho^2}{3} \\implies \\frac{\\rho^2}{3} - \\frac{\\rho^2}{6} \\le 2 \\implies \\frac{\\rho^2}{6} \\le 2 \\implies \\rho^2 \\le 12\n$$\n因此，稳定性极限为 $\\rho_{crit} = \\sqrt{12} = 2\\sqrt{3}$。\n临界时间步长 $\\Delta t_c$ 可由 $\\rho_{crit} = \\omega \\Delta t_c$ 求出：\n$$\n\\Delta t_c = \\frac{2\\sqrt{3}}{\\omega}\n$$\n\n最后，我们评估小时间步长情况下的领先阶相位误差，即当 $\\rho = \\omega \\Delta t \\to 0$ 时。相对相位误差定义为 $(\\bar{\\omega} - \\omega)/\\omega$，这等价于 $(\\bar{\\rho}/\\rho) - 1$。\n我们将色散关系 $\\cos(\\bar{\\rho}) = (1 - \\rho^2/3) / (1 + \\rho^2/6)$ 的两边在 $\\rho=0$ 附近进行泰勒级数展开。\n左边：$\\cos(\\bar{\\rho}) = 1 - \\frac{\\bar{\\rho}^2}{2} + \\frac{\\bar{\\rho}^4}{24} - O(\\bar{\\rho}^6)$。\n右边，使用几何级数 $(1+x)^{-1} = 1 - x + x^2 - \\dots$：\n$$\n\\frac{1 - \\frac{\\rho^2}{3}}{1 + \\frac{\\rho^2}{6}} = \\left(1 - \\frac{\\rho^2}{3}\\right)\\left(1 - \\frac{\\rho^2}{6} + \\frac{\\rho^4}{36} - O(\\rho^6)\\right) = 1 - \\frac{\\rho^2}{6} - \\frac{\\rho^2}{3} + \\frac{\\rho^4}{18} + \\frac{\\rho^4}{36} + O(\\rho^6)\n$$\n$$\n= 1 - \\frac{1}{2}\\rho^2 + \\frac{1}{12}\\rho^4 + O(\\rho^6)\n$$\n令级数展开式相等：\n$$\n1 - \\frac{\\bar{\\rho}^2}{2} + \\frac{\\bar{\\rho}^4}{24} + O(\\bar{\\rho}^6) = 1 - \\frac{1}{2}\\rho^2 + \\frac{1}{12}\\rho^4 + O(\\rho^6)\n$$\n当 $\\rho \\to 0$ 时，我们有 $\\bar{\\rho} \\to \\rho$，因此该方法是一致的。我们来寻找高阶项。令 $\\rho^2$ 和 $\\bar{\\rho}^2$ 的系数相等，得到 $\\bar{\\rho}^2 \\approx \\rho^2$。我们可以将其代入 $\\bar{\\rho}^4$ 项：\n$$\n\\frac{\\bar{\\rho}^2}{2} = \\frac{1}{2}\\rho^2 - \\frac{1}{12}\\rho^4 + \\frac{\\bar{\\rho}^4}{24} + O(\\rho^6) \\approx \\frac{1}{2}\\rho^2 - \\frac{1}{12}\\rho^4 + \\frac{\\rho^4}{24} = \\frac{1}{2}\\rho^2 - \\frac{1}{24}\\rho^4\n$$\n$$\n\\bar{\\rho}^2 \\approx \\rho^2 - \\frac{1}{12}\\rho^4 = \\rho^2\\left(1 - \\frac{\\rho^2}{12}\\right)\n$$\n取平方根并对小的 $x$ 使用二项式近似 $\\sqrt{1-x} \\approx 1 - x/2$：\n$$\n\\bar{\\rho} \\approx \\rho\\sqrt{1 - \\frac{\\rho^2}{12}} \\approx \\rho\\left(1 - \\frac{1}{2} \\cdot \\frac{\\rho^2}{12}\\right) = \\rho\\left(1 - \\frac{\\rho^2}{24}\\right)\n$$\n于是相对相位误差为：\n$$\n\\frac{\\bar{\\omega} - \\omega}{\\omega} = \\frac{\\bar{\\rho}}{\\rho} - 1 \\approx \\left(1 - \\frac{\\rho^2}{24}\\right) - 1 = -\\frac{\\rho^2}{24}\n$$\n领先阶相对相位误差为 $-\\rho^2/24$。负号表示相位滞后（周期延长），这是线性加速度法的特征。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\arccos\\left(\\frac{1 - \\frac{\\rho^2}{3}}{1 + \\frac{\\rho^2}{6}}\\right) & \\frac{2\\sqrt{3}}{\\omega} & -\\frac{\\rho^2}{24}\n\\end{pmatrix}\n}\n$$", "id": "2598061"}, {"introduction": "在分析了单一方法后，对不同方案进行比较以做出明智选择至关重要。本练习聚焦于两种主流的非耗散格式（平均加速度法和线性加速度法）的相位精度。通过量化它们各自的频率误差 [@problem_id:2598031]，您将揭示参数 $\\beta$ 的选择如何直接影响动力学仿真的长期保真度。", "problem": "考虑有限元法 (FEM) 中出现的无阻尼单自由度 (SDOF) 振子，其运动由常微分方程 $m \\ddot{u} + k u = 0$ 控制，其中 $m$ 是质量，$k$ 是刚度，$\\omega = \\sqrt{k/m}$ 是连续自然圆频率。设 $\\Delta t$ 为固定时间步长，并定义无量纲精确步长频率 $\\Omega = \\omega \\Delta t$。Newmark 时程积分算法族定义为\n$$\nu_{n+1} = u_n + \\Delta t\\, v_n + \\Delta t^2 \\left[\\left(\\tfrac{1}{2} - \\beta\\right) a_n + \\beta\\, a_{n+1}\\right], \n\\qquad\nv_{n+1} = v_n + \\Delta t \\left[(1 - \\gamma) a_n + \\gamma\\, a_{n+1}\\right],\n$$\n其中 $u_n$、$v_n$ 和 $a_n$ 分别是时间 $t_n$ 时的位移、速度和加速度，而 $\\beta, \\gamma$ 是 Newmark 参数。对于无阻尼 SDOF 振子，离散加速度满足 $a_n = -\\omega^2 u_n$ 和 $a_{n+1} = -\\omega^2 u_{n+1}$。当 $\\gamma = \\tfrac{1}{2}$ 时，已知该方法对无阻尼振子没有数值耗散，其放大矩阵具有模为1的复共轭特征值，这些特征值通过 $\\lambda_{\\pm} = \\exp(\\pm i \\Omega_d)$ 定义了离散步长频率 $\\Omega_d$。\n\n仅从控制方程、Newmark 更新定义以及上述恒等式出发，对于通用 $\\beta$ 和 $\\gamma = \\tfrac{1}{2}$ 的情况，推导将 $\\begin{pmatrix} u_n \\\\ \\Delta t\\, v_n \\end{pmatrix}$ 映射到 $\\begin{pmatrix} u_{n+1} \\\\ \\Delta t\\, v_{n+1} \\end{pmatrix}$ 的放大矩阵，并从其迹隐式地求得 $\\Omega_d$。通过对 $\\cos(\\Omega_d)$ 进行小$\\Omega$展开，并保留至（并包括）$\\Omega^4$ 阶项，证明离散频率允许形如\n$$\n\\Omega_d = \\Omega + c(\\beta)\\, \\Omega^3 + \\mathcal{O}(\\Omega^5),\n$$\n的展开式，并明确地确定作为 $\\beta$ 函数的主阶系数 $c(\\beta)$。然后，针对两种 Newmark 参数选择 $(\\beta,\\gamma) = \\left(\\tfrac{1}{4}, \\tfrac{1}{2}\\right)$ 和 $(\\beta,\\gamma) = \\left(\\tfrac{1}{6}, \\tfrac{1}{2}\\right)$ 计算该系数的值。以包含两个系数 $c(\\tfrac{1}{4})$ 和 $c(\\tfrac{1}{6})$（按此顺序）的行矩阵形式报告您的最终结果。无需四舍五入。最终答案必须仅包含这两个数，并以单个行矩阵的形式呈现。", "solution": "该问题是有效的，因为它具有科学依据，提法明确，并且基于机械系统数值分析的既定原则。我们将着手进行推导。\n\n分析始于将 Newmark 时程积分算法族应用于无阻尼单自由度 (SDOF) 振子。系统在时间步 $n$ 的状态由向量 $\\mathbf{y}_n = \\begin{pmatrix} u_n \\\\ \\Delta t\\, v_n \\end{pmatrix}$ 描述。我们寻求将状态向前推进的放大矩阵 $\\mathbf{A}$，使得 $\\mathbf{y}_{n+1} = \\mathbf{A} \\mathbf{y}_n$。\n\nNewmark 更新方程如下：\n$$\nu_{n+1} = u_n + \\Delta t\\, v_n + \\Delta t^2 \\left[\\left(\\tfrac{1}{2} - \\beta\\right) a_n + \\beta\\, a_{n+1}\\right]\n$$\n$$\nv_{n+1} = v_n + \\Delta t \\left[(1 - \\gamma) a_n + \\gamma\\, a_{n+1}\\right]\n$$\n对于本问题，给定 $\\gamma = \\tfrac{1}{2}$。SDOF 振子的加速度为 $a_k = -\\omega^2 u_k$。使用无量纲频率 $\\Omega = \\omega \\Delta t$，我们有 $a_k \\Delta t^2 = -\\omega^2 \\Delta t^2 u_k = -\\Omega^2 u_k$。\n\n将这些代入 Newmark 方程：\n$$\nu_{n+1} = u_n + \\Delta t\\, v_n + \\left(\\tfrac{1}{2} - \\beta\\right)(-\\Omega^2 u_n) + \\beta(-\\Omega^2 u_{n+1})\n$$\n$$\nv_{n+1} = v_n + \\frac{\\Delta t}{2} (-\\omega^2 u_n) + \\frac{\\Delta t}{2} (-\\omega^2 u_{n+1})\n$$\n重排第一个方程，用第 $n$ 步的量来求解 $u_{n+1}$：\n$$\nu_{n+1}(1 + \\beta \\Omega^2) = u_n (1 - (\\tfrac{1}{2} - \\beta)\\Omega^2) + (\\Delta t\\, v_n)\n$$\n$$\nu_{n+1} = \\frac{1 - (\\tfrac{1}{2} - \\beta)\\Omega^2}{1 + \\beta \\Omega^2} u_n + \\frac{1}{1 + \\beta \\Omega^2} (\\Delta t\\, v_n)\n$$\n这给出了放大矩阵 $\\mathbf{A}$ 的第一行，其中 $u_{n+1} = A_{11} u_n + A_{12} (\\Delta t v_n)$：\n$$\nA_{11} = \\frac{1 - (\\tfrac{1}{2} - \\beta)\\Omega^2}{1 + \\beta \\Omega^2}, \\quad A_{12} = \\frac{1}{1 + \\beta \\Omega^2}\n$$\n现在，我们处理速度更新方程。乘以 $\\Delta t$ 并代入 $a_k = -\\omega^2 u_k$：\n$$\n\\Delta t\\, v_{n+1} = \\Delta t\\, v_n - \\frac{\\Omega^2}{2} u_n - \\frac{\\Omega^2}{2} u_{n+1}\n$$\n代入上面推导出的 $u_{n+1}$ 的表达式：\n$$\n\\Delta t\\, v_{n+1} = \\Delta t\\, v_n - \\frac{\\Omega^2}{2} u_n - \\frac{\\Omega^2}{2} \\left( \\frac{1 - (\\tfrac{1}{2} - \\beta)\\Omega^2}{1 + \\beta \\Omega^2} u_n + \\frac{1}{1 + \\beta \\Omega^2} (\\Delta t\\, v_n) \\right)\n$$\n将乘以 $u_n$ 和 $\\Delta t v_n$ 的项分组，以找到 $\\mathbf{A}$ 的第二行，其中 $\\Delta t v_{n+1} = A_{21} u_n + A_{22} (\\Delta t v_n)$：\n$$\nA_{21} = -\\frac{\\Omega^2}{2} - \\frac{\\Omega^2}{2} \\left( \\frac{1 - (\\tfrac{1}{2} - \\beta)\\Omega^2}{1 + \\beta \\Omega^2} \\right) = -\\frac{\\Omega^2}{2} \\frac{1 + \\beta \\Omega^2 + 1 - (\\tfrac{1}{2} - \\beta)\\Omega^2}{1 + \\beta \\Omega^2} = -\\frac{\\Omega^2(1 + (\\beta - \\tfrac{1}{4})\\Omega^2)}{1 + \\beta \\Omega^2}\n$$\n$$\nA_{22} = 1 - \\frac{\\Omega^2}{2} \\left( \\frac{1}{1 + \\beta \\Omega^2} \\right) = \\frac{1 + \\beta \\Omega^2 - \\tfrac{1}{2}\\Omega^2}{1 + \\beta \\Omega^2} = \\frac{1 + (\\beta - \\tfrac{1}{2})\\Omega^2}{1 + \\beta \\Omega^2}\n$$\n放大矩阵为：\n$$\n\\mathbf{A} = \\frac{1}{1 + \\beta \\Omega^2} \\begin{pmatrix} 1 - (\\tfrac{1}{2} - \\beta)\\Omega^2 & 1 \\\\ -\\Omega^2(1 + (\\beta - \\tfrac{1}{4})\\Omega^2) & 1 + (\\beta - \\tfrac{1}{2})\\Omega^2 \\end{pmatrix}\n$$\n对于无数值耗散的方法 ($\\gamma = \\tfrac{1}{2}$)，$\\mathbf{A}$ 的特征值是单位圆上的复共轭对，$\\lambda_{\\pm} = \\exp(\\pm i \\Omega_d)$，其中 $\\Omega_d$ 是离散频率。$\\mathbf{A}$ 的迹与其特征值之和相关：$\\text{tr}(\\mathbf{A}) = \\lambda_+ + \\lambda_- = e^{i\\Omega_d} + e^{-i\\Omega_d} = 2\\cos(\\Omega_d)$。\n从我们的矩阵 $\\mathbf{A}$，迹为：\n$$\n\\text{tr}(\\mathbf{A}) = A_{11} + A_{22} = \\frac{1 - (\\tfrac{1}{2} - \\beta)\\Omega^2 + 1 + (\\beta - \\tfrac{1}{2})\\Omega^2}{1 + \\beta \\Omega^2} = \\frac{2 - (1 - 2\\beta)\\Omega^2}{1 + \\beta \\Omega^2}\n$$\n令两个迹的表达式相等，得到关于 $\\Omega_d$ 的关系式：\n$$\n\\cos(\\Omega_d) = \\frac{1 - (\\tfrac{1}{2} - \\beta)\\Omega^2}{1 + \\beta \\Omega^2}\n$$\n为了分析小 $\\Omega$ 时的频率误差，我们对此表达式关于 $\\Omega$ 进行泰勒级数展开。使用几何级数 $(1+x)^{-1} = 1 - x + x^2 - \\dots$：\n$$\n\\cos(\\Omega_d) = \\left(1 - \\left(\\tfrac{1}{2} - \\beta\\right)\\Omega^2\\right) \\left(1 - \\beta\\Omega^2 + \\beta^2\\Omega^4 - \\mathcal{O}(\\Omega^6)\\right)\n$$\n相乘并保留至 $\\Omega^4$ 阶项：\n$$\n\\cos(\\Omega_d) = 1 - \\beta\\Omega^2 - \\left(\\tfrac{1}{2} - \\beta\\right)\\Omega^2 + \\beta\\left(\\tfrac{1}{2}-\\beta\\right)\\Omega^4 + \\beta^2\\Omega^4 + \\mathcal{O}(\\Omega^6) \\\\\n= 1 - \\frac{1}{2}\\Omega^2 + \\left[\\beta^2 + \\beta\\left(\\tfrac{1}{2}-\\beta\\right)\\right]\\Omega^4 + \\mathcal{O}(\\Omega^6) \\\\\n= 1 - \\frac{1}{2}\\Omega^2 + \\frac{1}{2}\\beta\\Omega^4 + \\mathcal{O}(\\Omega^6)\n$$\n接下来，我们使用给定的离散频率形式 $\\Omega_d = \\Omega + c(\\beta)\\Omega^3 + \\mathcal{O}(\\Omega^5)$ 来展开 $\\cos(\\Omega_d)$。我们使用余弦的泰勒级数 $\\cos(x) = 1 - \\frac{x^2}{2} + \\frac{x^4}{24} - \\dots$。\n我们来求所需的 $\\Omega_d$ 的幂：\n$$\n\\Omega_d^2 = \\left(\\Omega + c(\\beta)\\Omega^3 + \\mathcal{O}(\\Omega^5)\\right)^2 = \\Omega^2 + 2c(\\beta)\\Omega^4 + \\mathcal{O}(\\Omega^6)\n$$\n$$\n\\Omega_d^4 = \\left(\\Omega + \\mathcal{O}(\\Omega^3)\\right)^4 = \\Omega^4 + \\mathcal{O}(\\Omega^6)\n$$\n将这些代入余弦展开式：\n$$\n\\cos(\\Omega_d) = 1 - \\frac{1}{2}\\left(\\Omega^2 + 2c(\\beta)\\Omega^4\\right) + \\frac{1}{24}\\left(\\Omega^4\\right) + \\mathcal{O}(\\Omega^6)\n$$\n$$\n\\cos(\\Omega_d) = 1 - \\frac{1}{2}\\Omega^2 + \\left(\\frac{1}{24} - c(\\beta)\\right)\\Omega^4 + \\mathcal{O}(\\Omega^6)\n$$\n通过比较我们得到的两个 $\\cos(\\Omega_d)$ 展开式中 $\\Omega^4$ 项的系数，我们可以解出 $c(\\beta)$：\n$$\n\\frac{1}{2}\\beta = \\frac{1}{24} - c(\\beta)\n$$\n$$\nc(\\beta) = \\frac{1}{24} - \\frac{1}{2}\\beta = \\frac{1 - 12\\beta}{24}\n$$\n这就是频率误差的主阶系数。我们需要针对两个特定情况计算它的值。\n\n情况1：平均加速度法，$(\\beta, \\gamma) = \\left(\\tfrac{1}{4}, \\tfrac{1}{2}\\right)$。\n$$\nc(\\tfrac{1}{4}) = \\frac{1 - 12(\\tfrac{1}{4})}{24} = \\frac{1-3}{24} = \\frac{-2}{24} = -\\frac{1}{12}\n$$\n情况2：线性加速度法，$(\\beta, \\gamma) = \\left(\\tfrac{1}{6}, \\tfrac{1}{2}\\right)$。\n$$\nc(\\tfrac{1}{6}) = \\frac{1 - 12(\\tfrac{1}{6})}{24} = \\frac{1-2}{24} = \\frac{-1}{24}\n$$\n问题要求以行矩阵的形式报告这两个系数。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{12} & -\\frac{1}{24}\n\\end{pmatrix}\n}\n$$", "id": "2598031"}, {"introduction": "理论分析提供了必要的洞见，但经验测试对于验证这些预测和理解其实际影响同样不可或缺。这个动手编程练习旨在通过数值实验来验证不同Newmark格式的收敛阶。通过将计算结果与已知的精确解进行比较 [@problem_id:2598094]，您将对“精度阶”在实践中的含义获得切实的理解。", "problem": "考虑由齐次常微分方程 $m \\ddot{u}(t) + c \\dot{u}(t) + k u(t) = 0$ 及其初始条件 $u(0) = u_0$ 和 $\\dot{u}(0) = v_0$ 给出的线性单自由度二阶初值问题。使用由 $(\\beta,\\gamma)$ 参数化的 Newmark 单步时间积分族，以均匀步长 $\\Delta t$ 在时间上推进求解。目标是通过将步长 $\\Delta t$ 减半并计算误差范数，构建一个经验性测试来验证 Newmark 族的理论精度阶。该测试必须基于以下基本原理进行设计：(i) 体现在控制方程 $m \\ddot{u}(t) + c \\dot{u}(t) + k u(t) = 0$ 中的牛顿第二运动定律，以及 (ii) Newmark 族作为一种双参数的运动学和平衡离散化方法的定义，该方法将状态 $(u,\\dot{u},\\ddot{u})$ 从时间 $t_n$ 推进到 $t_{n+1} = t_n + \\Delta t$。\n\n为便于测量，设 $m = 1$，$c = 0$，$k = \\omega^2$，其中角频率 $\\omega > 0$ 为已知。选择初始条件 $u_0$ 和 $v_0$，使得精确解具有闭合形式。当 $c = 0$ 时，精确解为 $u_{\\text{exact}}(t) = u_0 \\cos(\\omega t) + \\dfrac{v_0}{\\omega} \\sin(\\omega t)$ 和 $\\dot{u}_{\\text{exact}}(t) = -\\omega u_0 \\sin(\\omega t) + v_0 \\cos(\\omega t)$。\n\n您必须实现一个程序，该程序能够：\n- 对于给定的参数对 $(\\beta,\\gamma)$ 和时间步长 $\\Delta t$，使用 Newmark 方法将求解推进到固定的最终时刻 $T$。\n- 对减半的时间步长 $\\Delta t$、$\\Delta t/2$、$\\Delta t/4$ 和 $\\Delta t/8$ 重复计算。\n- 在每个时间步长下，测量以下数据：\n  1. 在时刻 $t_n = n \\Delta t$（其中 $n = 0,1,\\dots,N$，$N = T/\\Delta t$）的离散时间历程 $\\{u_n\\}_{n=0}^{N}$ 和 $\\{\\dot{u}_n\\}_{n=0}^{N}$。\n  2. 相应的精确值 $\\{u_{\\text{exact}}(t_n)\\}$ 和 $\\{\\dot{u}_{\\text{exact}}(t_n)\\}$。\n  3. 在最终时刻 $t_N = T$ 的绝对误差：$e_u(\\Delta t) = |u_N - u_{\\text{exact}}(T)|$ 和 $e_v(\\Delta t) = |\\dot{u}_N - \\dot{u}_{\\text{exact}}(T)|$。\n  4. （可选）在整个时间区间上的时间离散范数，例如时间最大误差 $\\max_n |u_n - u_{\\text{exact}}(t_n)|$ 和均方根误差 $\\left(\\dfrac{1}{N+1} \\sum_{n=0}^N |u_n - u_{\\text{exact}}(t_n)|^2\\right)^{1/2}$，但这些不作为最终输出的一部分。\n- 使用测得的最终时刻误差，通过比较在连续减半的步长下计算出的误差来估计经验精度阶 $p$。该估计值必须基于连续 $\\Delta t$ 值的误差比，并且必须对所有可用的连续对 $(\\Delta t,\\Delta t/2)$、$(\\Delta t/2,\\Delta t/4)$ 和 $(\\Delta t/4,\\Delta t/8)$ 的结果进行聚合，从而为位移和速度各产生一个单一的代表性估计值。\n\n测试套件：\n使用以下三组参数集；选择它们是为了探测 Newmark 族内不同的精度和稳定性特征：\n\n- 情况 A（无条件稳定，经典二阶）：$\\omega = 2\\pi$，$T = 1$，$u_0 = 1$，$v_0 = 0$，$\\beta = \\dfrac{1}{4}$，$\\gamma = \\dfrac{1}{2}$，基础时间步长 $\\Delta t_0 = \\dfrac{T}{10}$。\n- 情况 B（条件稳定成员，通常称为线性加速度法，具有足够小的时间步长以确保在测试范围内的稳定性）：$\\omega = \\sqrt{5}$，$T = 1$，$u_0 = 1$，$v_0 = 0$，$\\beta = \\dfrac{1}{6}$，$\\gamma = \\dfrac{1}{2}$，基础时间步长 $\\Delta t_0 = \\dfrac{T}{10}$。\n- 情况 C（无条件稳定，但由于 $\\gamma \\neq \\dfrac{1}{2}$ 而具有数值耗散和降阶）：$\\omega = 2\\pi$，$T = 1$，$u_0 = 1$，$v_0 = 0$，$\\beta = 0.31$，$\\gamma = 0.6$，基础时间步长 $\\Delta t_0 = \\dfrac{T}{10}$。\n\n对于每种情况，通过将时间步长从基础值 $\\Delta t_0$ 减半至 $\\Delta t_0/8$，并聚合三个连续对的估计值，为每个量（位移和速度）计算一个代表性的经验精度阶。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个按以下顺序排列的包含 $6$ 个浮点数的列表：\n$[p^{(A)}_u, p^{(A)}_v, p^{(B)}_u, p^{(B)}_v, p^{(C)}_u, p^{(C)}_v]$,\n其中 $p^{(X)}_u$ 和 $p^{(X)}_v$ 分别表示情况 $X \\in \\{A,B,C\\}$ 的位移和速度的聚合经验阶。该列表必须以方括号括起、逗号分隔的列表形式打印，每个值四舍五入到三位小数。输出中不需要物理单位，因为报告的量是无量纲的精度阶。", "solution": "该问题要求对 Newmark 时间积分族方法的理论精度阶进行经验性验证。该验证将在一个线性单自由度 (SDOF) 系统上执行。\n\n该单自由度系统的控制常微分方程 (ODE) 是牛顿第二运动定律：\n$$m \\ddot{u}(t) + c \\dot{u}(t) + k u(t) = 0$$\n初始条件为 $u(0) = u_0$ 和 $\\dot{u}(0) = v_0$。对于此问题，指定的参数为质量 $m=1$、阻尼系数 $c=0$ 和刚度 $k=\\omega^2$，其中 $\\omega > 0$ 是自振角频率。方程简化为无阻尼简谐振子：\n$$ \\ddot{u}(t) + \\omega^2 u(t) = 0 $$\n给定初始条件下的精确解为：\n$$ u_{\\text{exact}}(t) = u_0 \\cos(\\omega t) + \\frac{v_0}{\\omega} \\sin(\\omega t) $$\n$$ \\dot{u}_{\\text{exact}}(t) = -u_0 \\omega \\sin(\\omega t) + v_0 \\cos(\\omega t) $$\n\nNewmark 方法族提供了一种时间步进算法来近似求解。系统的状态 $(u, \\dot{u}, \\ddot{u})$ 通过以下由 $\\beta$ 和 $\\gamma$ 参数化的运动学更新方程，从时间 $t_n$ 推进到 $t_{n+1} = t_n + \\Delta t$：\n$$ u_{n+1} = u_n + \\dot{u}_n \\Delta t + \\left[ \\left(\\frac{1}{2} - \\beta\\right) \\ddot{u}_n + \\beta \\ddot{u}_{n+1} \\right] \\Delta t^2 $$\n$$ \\dot{u}_{n+1} = \\dot{u}_n + \\left[ (1-\\gamma) \\ddot{u}_n + \\gamma \\ddot{u}_{n+1} \\right] \\Delta t $$\n这些方程是隐式的，因为时间 $t_{n+1}$ 的未知量出现在方程两侧。为了求解它们，我们在时间 $t_{n+1}$ 施加控制常微分方程：\n$$ \\ddot{u}_{n+1} + \\omega^2 u_{n+1} = 0 \\implies \\ddot{u}_{n+1} = -\\omega^2 u_{n+1} $$\n该关系特定于线性无阻尼系统，并允许直接求解。我们将 $\\ddot{u}_{n+1}$ 的表达式代入位移更新方程：\n$$ u_{n+1} = u_n + \\dot{u}_n \\Delta t + \\left(\\frac{1}{2} - \\beta\\right) \\ddot{u}_n \\Delta t^2 + \\beta (-\\omega^2 u_{n+1}) \\Delta t^2 $$\n现在我们可以用在时间 $t_n$ 已知的量来代数求解 $u_{n+1}$。整理各项得：\n$$ u_{n+1} \\left(1 + \\beta \\omega^2 \\Delta t^2\\right) = u_n + \\dot{u}_n \\Delta t + \\left(\\frac{1}{2} - \\beta\\right) \\ddot{u}_n \\Delta t^2 $$\n这为 $u_{n+1}$ 提供了一个显式公式：\n$$ u_{n+1} = \\frac{1}{1 + \\beta \\omega^2 \\Delta t^2} \\left[ u_n + \\dot{u}_n \\Delta t + \\left(\\frac{1}{2} - \\beta\\right) \\ddot{u}_n \\Delta t^2 \\right] $$\n一旦 $u_{n+1}$ 计算出来，新时间步的加速度 $\\ddot{u}_{n+1}$ 和速度 $\\dot{u}_{n+1}$ 就可以直接求得：\n$$ \\ddot{u}_{n+1} = -\\omega^2 u_{n+1} $$\n$$ \\dot{u}_{n+1} = \\dot{u}_n + (1 - \\gamma) \\ddot{u}_n \\Delta t + \\gamma \\ddot{u}_{n+1} \\Delta t $$\n时间步进过程从初始条件 $u_0$ 和 $\\dot{u}_0 = v_0$ 开始。初始加速度 $\\ddot{u}_0$ 必须与 $t=0$ 时的控制方程一致：\n$$ \\ddot{u}_0 = -\\omega^2 u_0 $$\n求解过程迭代进行，直到达到最终时刻 $T$。\n\n为了确定经验精度阶 $p$，我们分析在固定时刻 $T$ 的全局误差如何随时间步长 $\\Delta t$ 变化。对于一个 $p$ 阶方法，其误差预计会按 $e(\\Delta t) \\approx C (\\Delta t)^p$ 的规律变化，其中 $C$ 是一个常数。考虑两个不同的步长 $\\Delta t_1$ 和一个减半的步长 $\\Delta t_2 = \\Delta t_1/2$，它们对应误差的比值为：\n$$ \\frac{e(\\Delta t_1)}{e(\\Delta t_2)} \\approx \\frac{C (\\Delta t_1)^p}{C (\\Delta t_2)^p} = \\left(\\frac{\\Delta t_1}{\\Delta t_2}\\right)^p = 2^p $$\n对该比值取以 2 为底的对数，可以估算出 $p$：\n$$ p \\approx \\log_2 \\left( \\frac{e(\\Delta t_1)}{e(\\Delta t_2)} \\right) $$\n题目要求对位移误差 $e_u(\\Delta t) = |u_N - u_{\\text{exact}}(T)|$ 和速度误差 $e_v(\\Delta t) = |\\dot{u}_N - \\dot{u}_{\\text{exact}}(T)|$ 进行此计算，其中 $N = T/\\Delta t$。该过程将对一系列减半的时间步长 $\\Delta t_0, \\Delta t_0/2, \\Delta t_0/4, \\Delta t_0/8$ 执行。这将提供三个连续的时间步长对，由此可以计算出三个 $p$ 的估计值。最终报告的精度阶是这三个估计值的算术平均值，从而提供一个更稳健的度量。\n\n实现将包括一个函数，用于对给定的一组参数执行 Newmark 时间积分；一个函数，用于计算精确解；以及一个主程序，用于对问题陈述中指定的每个测试用例组织误差分析。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef exact_solution(t, omega, u0, v0):\n    \"\"\"\n    Computes the exact solution for the SDOF system u'' + omega^2 * u = 0.\n    \n    Args:\n        t (float): Time.\n        omega (float): Natural angular frequency.\n        u0 (float): Initial displacement.\n        v0 (float): Initial velocity.\n        \n    Returns:\n        tuple[float, float]: Displacement and velocity at time t.\n    \"\"\"\n    # Defensive check for omega=0, though problem statement guarantees omega > 0.\n    if omega == 0:\n        u_t = u0 + v0 * t\n        v_t = v0\n        return u_t, v_t\n        \n    u_t = u0 * np.cos(omega * t) + (v0 / omega) * np.sin(omega * t)\n    v_t = -u0 * omega * np.sin(omega * t) + v0 * np.cos(omega * t)\n    return u_t, v_t\n\ndef run_newmark_solver(omega, u0, v0, T, beta, gamma, dt):\n    \"\"\"\n    Solves the SDOF system using the Newmark method.\n    \n    Args:\n        omega (float): Natural angular frequency.\n        u0 (float): Initial displacement.\n        v0 (float): Initial velocity.\n        T (float): Final time.\n        beta (float): Newmark parameter beta.\n        gamma (float): Newmark parameter gamma.\n        dt (float): Time step size.\n        \n    Returns:\n        tuple[float, float]: Numerical displacement and velocity at time T.\n    \"\"\"\n    # Ensure number of steps is integer, using round for float precision\n    N = int(round(T / dt))\n    \n    # Initialize displacement, velocity, and acceleration\n    u, v = u0, v0\n    k = omega**2\n    a = -k * u  # Initial acceleration from EOM: m*a + k*u = 0 with m=1\n\n    # Pre-compute constant part of the denominator for efficiency\n    denom = 1.0 + beta * k * dt**2\n\n    # Time integration loop\n    for _ in range(N):\n        # Update displacement using the derived explicit formula for linear systems\n        u_next = (u + v * dt + (0.5 - beta) * a * dt**2) / denom\n        \n        # Update acceleration using the EOM at the next step\n        a_next = -k * u_next\n        \n        # Update velocity using the Newmark velocity update rule\n        v_next = v + (1.0 - gamma) * a * dt + gamma * a_next * dt\n        \n        # Advance the state\n        u, v, a = u_next, v_next, a_next\n        \n    return u, v\n\ndef compute_order_of_accuracy(params):\n    \"\"\"\n    Computes the empirical order of accuracy for a given test case.\n    \n    Args:\n        params (dict): Dictionary of parameters for the test case.\n        \n    Returns:\n        tuple[float, float]: Aggregated empirical order for displacement and velocity.\n    \"\"\"\n    omega = params['omega']\n    T = params['T']\n    u0 = params['u0']\n    v0 = params['v0']\n    beta = params['beta']\n    gamma = params['gamma']\n    dt0 = params['dt0']\n\n    # Get exact solution at the final time T\n    u_exact_T, v_exact_T = exact_solution(T, omega, u0, v0)\n\n    # Define the sequence of time steps\n    dts = [dt0 / (2**i) for i in range(4)]  # dt0, dt0/2, dt0/4, dt0/8\n\n    errors_u = []\n    errors_v = []\n\n    # Compute errors for each time step size\n    for dt in dts:\n        u_N, v_N = run_newmark_solver(omega, u0, v0, T, beta, gamma, dt)\n        errors_u.append(np.abs(u_N - u_exact_T))\n        errors_v.append(np.abs(v_N - v_exact_T))\n\n    orders_u = []\n    orders_v = []\n\n    # Compute order estimates from consecutive error pairs\n    for i in range(3):  # For pairs (dt_i, dt_{i+1})\n        # Handle cases where error is zero to avoid division by zero\n        if errors_u[i+1] > 1e-16: # Use a small tolerance for stability\n            ratio_u = errors_u[i] / errors_u[i+1]\n            orders_u.append(np.log2(ratio_u))\n        \n        if errors_v[i+1] > 1e-16:\n            ratio_v = errors_v[i] / errors_v[i+1]\n            orders_v.append(np.log2(ratio_v))\n            \n    # Aggregate (average) the order estimates. If no valid estimates, return 0.\n    p_u = np.mean(orders_u) if orders_u else 0.0\n    p_v = np.mean(orders_v) if orders_v else 0.0\n\n    return p_u, p_v\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Unconditionally stable, 2nd order (Constant Average Acceleration)\n        {\n            'omega': 2.0 * np.pi, 'T': 1.0, 'u0': 1.0, 'v0': 0.0,\n            'beta': 1.0/4.0, 'gamma': 1.0/2.0, 'dt0': 1.0/10.0\n        },\n        # Case B: Conditionally stable, 2nd order (Linear Acceleration Method)\n        {\n            'omega': np.sqrt(5.0), 'T': 1.0, 'u0': 1.0, 'v0': 0.0,\n            'beta': 1.0/6.0, 'gamma': 1.0/2.0, 'dt0': 1.0/10.0\n        },\n        # Case C: Unconditionally stable, 1st order (with numerical dissipation)\n        {\n            'omega': 2.0 * np.pi, 'T': 1.0, 'u0': 1.0, 'v0': 0.0,\n            'beta': 0.31, 'gamma': 0.6, 'dt0': 1.0/10.0\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        p_u, p_v = compute_order_of_accuracy(case)\n        results.extend([p_u, p_v])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{x:.3f}' for x in results])}]\")\n\nsolve()\n```", "id": "2598094"}]}