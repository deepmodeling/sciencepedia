{"hands_on_practices": [{"introduction": "Neo-Hookean 和 Mooney-Rivlin 模型是超弹性理论的基石。理解它们之间的关系至关重要，即 Mooney-Rivlin 模型是 Neo-Hookean 模型的推广。本练习通过推导 Mooney-Rivlin 材料在单轴拉伸下的柯西应力（Cauchy stress）响应，并通过取极限来展示其如何简化为 Neo-Hookean 模型，从而加深对这一关系的理解 [@problem_id:2582967]。", "problem": "考虑一个在混合位移-压力有限元法（FEM）公式中使用的近不可压缩超弹性固体，其中不可压缩性由一个拉格朗日乘子强制施加。该材料是各向同性的，其偏应变能密度由双参数 Mooney–Rivlin 模型建模。令变形梯度表示为 $\\mathbf{F}$，雅可比行列式为 $J=\\det \\mathbf{F}$，左柯西-格林张量为 $\\mathbf{B}=\\mathbf{F}\\mathbf{F}^{\\mathsf{T}}$。主伸长为 $\\lambda_{1}$、$\\lambda_{2}$ 和 $\\lambda_{3}$，因此 $\\mathbf{B}$ 的主值为 $\\lambda_{i}^{2}$（$i\\in\\{1,2,3\\}$）。$\\mathbf{B}$ 的第一和第二不变量为 $I_{1}=\\operatorname{tr}\\mathbf{B}$ 和 $I_{2}=\\tfrac{1}{2}\\!\\left[(\\operatorname{tr}\\mathbf{B})^{2}-\\operatorname{tr}(\\mathbf{B}^{2})\\right]$。等容不变量定义为 $\\bar{I}_{1}=J^{-2/3}I_{1}$ 和 $\\bar{I}_{2}=J^{-4/3}I_{2}$。假设精确不可压缩性，因此 $J=1$ 且 $\\bar{I}_{1}=I_{1}$，$\\bar{I}_{2}=I_{2}$。\n\nMooney–Rivlin 应变能密度由下式给出\n$$\nW(\\mathbf{F}) = C_{1}\\!\\left(\\bar{I}_{1}-3\\right) + C_{2}\\!\\left(\\bar{I}_{2}-3\\right),\n$$\n其中材料参数 $C_{1}>0$ 且 $C_{2}\\ge 0$。在混合有限元法设置中，柯西应力的形式为\n$$\n\\boldsymbol{\\sigma} = -p\\,\\mathbf{I} + \\boldsymbol{\\sigma}^{\\text{dev}},\n$$\n其中 $p$ 是强制 $J=1$ 的拉格朗日乘子，$\\boldsymbol{\\sigma}^{\\text{dev}}$ 是由所选 $W$ 隐含的偏量部分。\n\n你的任务是：\n1) 仅使用上述核心定义和经过充分检验的各向同性不可压缩超弹性本构结构，推导在沿方向1的单轴拉伸变形下的主柯西应力，该变形的轴向伸长为 $\\lambda>1$，因此 $\\lambda_{1}=\\lambda$，且不可压缩性强制要求 $\\lambda_{2}=\\lambda_{3}=\\lambda^{-1/2}$。施加侧向无牵引边界条件以确定 $p$ 并将其从轴向应力表达式中消去。\n2) 从第1部分中得到的表达式出发，取极限 $C_{2}\\to 0$，从而解释在该极限下 Mooney–Rivlin 模型如何简化为 Neo–Hookean 模型，并确定其有效剪切模量。\n3) 报告在极限 $C_{2}\\to 0$ 下，作为 $\\lambda$ 和 $C_{1}$ 的函数的轴向柯西应力的最终闭式解析表达式。\n\n以帕斯卡为单位表示轴向柯西应力。最终答案必须是单一的闭式解析表达式（最终方框内的答案不带单位）。", "solution": "所述问题在连续介质力学领域内是科学上合理的且定义明确的。我们将着手解决它。\n\n该问题要求推导 Mooney-Rivlin 材料在单轴拉伸下的轴向柯西应力分量，然后分析其如何简化为 Neo–Hookean 模型。\n\n对于各向同性、不可压缩的超弹性材料，其本构关系以应变能密度函数 $W$ 的形式给出了柯西应力张量 $\\boldsymbol{\\sigma}$。对于应变能 $W$ 是左柯西-格林张量 $\\mathbf{B}$ 的第一和第二不变量（$I_{1}$ 和 $I_{2}$）的函数的材料，其应力由下式给出：\n$$\n\\boldsymbol{\\sigma} = -p\\mathbf{I} + 2\\frac{\\partial W}{\\partial I_{1}}\\mathbf{B} - 2\\frac{\\partial W}{\\partial I_{2}}\\mathbf{B}^{-1}\n$$\n在此，$p$ 是一个任意的静水压力（拉格朗日乘子），用以强制施加不可压缩性约束 $J = \\det(\\mathbf{F})=1$，$\\mathbf{I}$ 是二阶单位张量，而 $\\mathbf{B} = \\mathbf{F}\\mathbf{F}^{\\mathsf{T}}$ 是左柯西-格林变形张量。\n\n问题指定了双参数 Mooney-Rivlin 应变能密度函数。对于不可压缩材料（$J=1$，因此 $\\bar{I}_{1}=I_{1}$ 且 $\\bar{I}_{2}=I_{2}$），该函数为：\n$$\nW(I_{1}, I_{2}) = C_{1}(I_{1}-3) + C_{2}(I_{2}-3)\n$$\n材料参数为 $C_{1} > 0$ 且 $C_{2} \\ge 0$。$W$ 对不变量的偏导数为：\n$$\n\\frac{\\partial W}{\\partial I_{1}} = C_{1}\n$$\n$$\n\\frac{\\partial W}{\\partial I_{2}} = C_{2}\n$$\n将这些代入一般应力方程，得到不可压缩 Mooney-Rivlin 材料的柯西应力：\n$$\n\\boldsymbol{\\sigma} = -p\\mathbf{I} + 2C_{1}\\mathbf{B} - 2C_{2}\\mathbf{B}^{-1}\n$$\n\n我们现在考虑指定的变形：沿方向1的单轴拉伸，轴向伸长 $\\lambda > 1$。主伸长给定为 $\\lambda_{1} = \\lambda$。由于不可压缩条件 $\\lambda_{1}\\lambda_{2}\\lambda_{3} = 1$ 和各向同性假设，侧向伸长必须相等，即 $\\lambda_{2} = \\lambda_{3} = \\lambda^{-1/2}$。\n\n在与伸长方向对齐的主坐标系中，变形梯度张量 $\\mathbf{F}$ 是对角的：\n$$\n\\mathbf{F} = \\begin{pmatrix} \\lambda  0  0 \\\\ 0  \\lambda^{-1/2}  0 \\\\ 0  0  \\lambda^{-1/2} \\end{pmatrix}\n$$\n左柯西-格林张量 $\\mathbf{B} = \\mathbf{F}\\mathbf{F}^{\\mathsf{T}} = \\mathbf{F}^{2}$ 及其逆张量 $\\mathbf{B}^{-1}$ 也是对角的：\n$$\n\\mathbf{B} = \\begin{pmatrix} \\lambda^{2}  0  0 \\\\ 0  \\lambda^{-1}  0 \\\\ 0  0  \\lambda^{-1} \\end{pmatrix}, \\quad \\mathbf{B}^{-1} = \\begin{pmatrix} \\lambda^{-2}  0  0 \\\\ 0  \\lambda  0 \\\\ 0  0  \\lambda \\end{pmatrix}\n$$\n因此，柯西应力张量 $\\boldsymbol{\\sigma}$ 的主分量为：\n$$\n\\sigma_{11} = -p + 2C_{1}\\lambda^{2} - 2C_{2}\\lambda^{-2}\n$$\n$$\n\\sigma_{22} = -p + 2C_{1}\\lambda^{-1} - 2C_{2}\\lambda\n$$\n$$\n\\sigma_{33} = -p + 2C_{1}\\lambda^{-1} - 2C_{2}\\lambda\n$$\n我们注意到 $\\sigma_{22} = \\sigma_{33}$。\n\n问题施加了侧向无牵引边界条件，这意味着垂直于侧面（方向2和3）的应力分量为零。我们强制 $\\sigma_{22}=0$：\n$$\n0 = -p + 2C_{1}\\lambda^{-1} - 2C_{2}\\lambda\n$$\n根据此条件，我们确定静水压力 $p$：\n$$\np = 2C_{1}\\lambda^{-1} - 2C_{2}\\lambda\n$$\n将 $p$ 的这个表达式代入轴向应力 $\\sigma_{11}$ 的方程中，可以消去拉格朗日乘子：\n$$\n\\sigma_{11} = -(2C_{1}\\lambda^{-1} - 2C_{2}\\lambda) + 2C_{1}\\lambda^{2} - 2C_{2}\\lambda^{-2}\n$$\n$$\n\\sigma_{11} = 2C_{1}\\lambda^{2} - 2C_{1}\\lambda^{-1} - 2C_{2}\\lambda^{-2} + 2C_{2}\\lambda\n$$\n重新整理各项，我们得到 Mooney-Rivlin 模型的轴向应力：\n$$\n\\sigma_{11} = 2(\\lambda^{2} - \\lambda^{-1})C_{1} + 2(\\lambda - \\lambda^{-2})C_{2}\n$$\n这完成了第一个任务。\n\n对于第二个任务，我们考察 $C_{2} \\to 0$ 时的极限。Mooney-Rivlin 应变能函数 $W = C_{1}(I_{1}-3) + C_{2}(I_{2}-3)$ 变为：\n$$\n\\lim_{C_{2} \\to 0} W = C_{1}(I_{1}-3)\n$$\n这正是 Neo-Hookean 应变能函数的形式，通常写作 $W_{\\text{NH}} = C_{10}(I_{1}-3)$。因此，在此极限下，Mooney–Rivlin 模型简化为 Neo–Hookean 模型，其中 Mooney–Rivlin 模型的材料常数 $C_{1}$ 对应于 Neo–Hookean 常数。\n对于一般的各向同性超弹性材料，其初始剪切模量 $\\mu$（在未变形参考状态下）由 $\\mu = 2(\\frac{\\partial W}{\\partial I_{1}} + \\frac{\\partial W}{\\partial I_{2}})|_{I_{1}=3, I_{2}=3}$ 给出。对于 Mooney-Rivlin 模型，这给出 $\\mu = 2(C_{1}+C_{2})$。在极限 $C_{2}\\to 0$ 下，我们得到 Neo-Hookean 模型，其有效剪切模量为 $\\mu = 2C_{1}$。\n\n对于第三个任务，我们必须找出在极限 $C_{2} \\to 0$ 下轴向应力的闭式表达式。我们取之前推导的 $\\sigma_{11}$ 表达式并应用此极限：\n$$\n\\sigma_{11} = \\lim_{C_{2} \\to 0} \\left[ 2(\\lambda^{2} - \\lambda^{-1})C_{1} + 2(\\lambda - \\lambda^{-2})C_{2} \\right]\n$$\n$$\n\\sigma_{11} = 2(\\lambda^{2} - \\lambda^{-1})C_{1}\n$$\n这是 Neo-Hookean 材料在单轴拉伸下的轴向柯西应力的最终表达式，表示为伸长 $\\lambda$ 和材料参数 $C_{1}$ 的函数。该量具有应力单位（例如，帕斯卡），符合要求。", "answer": "$$\n\\boxed{2C_{1}(\\lambda^{2} - \\lambda^{-1})}\n$$", "id": "2582967"}, {"introduction": "虽然 Mooney-Rivlin 模型非常有用，但 Ogden 模型在拟合实验数据方面提供了更大的灵活性。该模型基于主拉伸进行表述，其应力推导方法略有不同但同样基础。本练习旨在培养为基于拉伸的模型推导名义应力（nominal stress）-拉伸关系的能力，这是分析更高级材料本构律的一项关键技术 [@problem_id:2582990]。", "problem": "考虑一个由多项 Ogden 应变能密度建模的不可压缩各向同性超弹性固体，该应变能密度由主拉伸 $\\lambda_{1}$、$\\lambda_{2}$ 和 $\\lambda_{3}$ 定义为\n$$\nW(\\lambda_{1},\\lambda_{2},\\lambda_{3})=\\sum_{k=1}^{N}\\frac{\\mu_{k}}{\\alpha_{k}}\\left(\\lambda_{1}^{\\alpha_{k}}+\\lambda_{2}^{\\alpha_{k}}+\\lambda_{3}^{\\alpha_{k}}-3\\right),\n$$\n其中，对于 $k=1,\\dots,N$，$\\mu_{k}>0$ 且 $\\alpha_{k}$ 为实数。不可压缩性约束 $J=\\lambda_{1}\\lambda_{2}\\lambda_{3}=1$ 由一个拉格朗日乘子压力 $p$ 强制施加。第一 Piola–Kirchhoff 应力 $\\mathbf{P}$ 由不可压缩材料的标准超弹性关系得出，\n$$\n\\mathbf{P}=\\frac{\\partial W}{\\partial \\mathbf{F}}-p\\,\\mathbf{F}^{-T},\n$$\n其中 $\\mathbf{F}$ 是变形梯度。\n\n在沿 $\\mathbf{e}_{1}$ 方向的单轴拉伸中，变形梯度是对角矩阵，主拉伸为 $\\lambda_{1}=\\lambda$ 和 $\\lambda_{2}=\\lambda_{3}=\\lambda_{t}$，且 $J=\\lambda\\,\\lambda_{t}^{2}=1$。在当前构型中，垂直于 $\\mathbf{e}_{2}$ 和 $\\mathbf{e}_{3}$ 的侧面是无面力的。使用上述基本定义，利用侧向无面力条件消去拉格朗日乘子压力 $p$，并推导出名义轴向应力 $P_{11}$ 关于 $\\lambda$、$\\mu_{k}$ 和 $\\alpha_{k}$ 的闭式解析表达式。\n\n将您的最终答案表示为 $P_{11}(\\lambda)$ 关于 $\\lambda$、$\\{\\mu_{k}\\}_{k=1}^{N}$ 和 $\\{\\alpha_{k}\\}_{k=1}^{N}$ 的单个解析表达式。不要代入数值或包含单位。", "solution": "该问题是适定的，并且在科学上是合理的，其基础是连续介质力学和超弹性理论的既定原理。我们开始进行推导。\n\nOgden 模型的应变能密度由下式给出：\n$$\nW(\\lambda_{1},\\lambda_{2},\\lambda_{3})=\\sum_{k=1}^{N}\\frac{\\mu_{k}}{\\alpha_{k}}\\left(\\lambda_{1}^{\\alpha_{k}}+\\lambda_{2}^{\\alpha_{k}}+\\lambda_{3}^{\\alpha_{k}}-3\\right)\n$$\n不可压缩材料的第一 Piola-Kirchhoff (PK1) 应力张量 $\\mathbf{P}$ 为：\n$$\n\\mathbf{P}=\\frac{\\partial W}{\\partial \\mathbf{F}}-p\\,\\mathbf{F}^{-T}\n$$\n其中 $\\mathbf{F}$ 是变形梯度， $p$ 是强制施加不可压缩性约束 $J = \\det(\\mathbf{F}) = 1$ 的拉格朗日乘子压力。\n\n对于各向同性材料，在与坐标轴对齐的变形下，应力和应变的主方向重合。变形梯度 $\\mathbf{F}$ 和 PK1 应力 $\\mathbf{P}$ 是对角矩阵。PK1 应力张量的主分量 $P_i$ 与主拉伸 $\\lambda_i$ 的关系为：\n$$\nP_{i} = \\frac{\\partial W}{\\partial \\lambda_{i}} - p\\lambda_{i}^{-1}\n$$\n对于 $i=1,2,3$。对重复指标不进行求和。\n\n首先，我们计算应变能密度 $W$ 对主拉伸 $\\lambda_{i}$ 的偏导数：\n$$\n\\frac{\\partial W}{\\partial \\lambda_{i}} = \\frac{\\partial}{\\partial \\lambda_{i}}\\left[\\sum_{k=1}^{N}\\frac{\\mu_{k}}{\\alpha_{k}}\\left(\\lambda_{1}^{\\alpha_{k}}+\\lambda_{2}^{\\alpha_{k}}+\\lambda_{3}^{\\alpha_{k}}-3\\right)\\right] = \\sum_{k=1}^{N}\\frac{\\mu_{k}}{\\alpha_{k}}\\left(\\alpha_{k}\\lambda_{i}^{\\alpha_{k}-1}\\right) = \\sum_{k=1}^{N}\\mu_{k}\\lambda_{i}^{\\alpha_{k}-1}\n$$\n因此，主 PK1 应力可以写为：\n$$\nP_{1} = \\sum_{k=1}^{N}\\mu_{k}\\lambda_{1}^{\\alpha_{k}-1} - p\\lambda_{1}^{-1}\n$$\n$$\nP_{2} = \\sum_{k=1}^{N}\\mu_{k}\\lambda_{2}^{\\alpha_{k}-1} - p\\lambda_{2}^{-1}\n$$\n$$\nP_{3} = \\sum_{k=1}^{N}\\mu_{k}\\lambda_{3}^{\\alpha_{k}-1} - p\\lambda_{3}^{-1}\n$$\n问题指定了沿 $\\mathbf{e}_{1}$ 方向的单轴拉伸状态。主拉伸为 $\\lambda_{1}=\\lambda$，并且由于对称性，$\\lambda_{2}=\\lambda_{3}=\\lambda_{t}$。不可压缩性约束 $J=\\lambda_{1}\\lambda_{2}\\lambda_{3}=1$ 变为 $\\lambda\\lambda_{t}^{2}=1$，由此得出横向拉伸为 $\\lambda_{t}=\\lambda^{-1/2}$。\n\n边界条件是，垂直于 $\\mathbf{e}_{2}$ 和 $\\mathbf{e}_{3}$ 的侧面在变形后构型中是无面力的。这意味着 Cauchy (真实) 应力张量 $\\boldsymbol{\\sigma}$ 的相应分量为零。Cauchy 应力与 PK1 应力的关系为 $\\boldsymbol{\\sigma} = J^{-1}\\mathbf{P}\\mathbf{F}^{T}$。由于材料是不可压缩的，$J=1$，该关系简化为 $\\boldsymbol{\\sigma} = \\mathbf{P}\\mathbf{F}^{T}$。\n\n在主坐标系中，该关系按分量表示为 $\\sigma_{i}=P_{i}\\lambda_{i}$。因此，侧向无面力条件为 $\\sigma_{2}=0$ 和 $\\sigma_{3}=0$。\n使用条件 $\\sigma_{2}=0$：\n$$\n\\sigma_{2} = P_{2}\\lambda_{2} = 0\n$$\n由于 $\\lambda_{2}=\\lambda_{t}=\\lambda^{-1/2} \\neq 0$，这意味着主 PK1 应力 $P_{2}$ 必须为零。因为 $\\lambda_2=\\lambda_3$，条件 $\\sigma_3=0$ 也会得出 $P_3=0$ 的相同结论。\n令 $P_{2}=0$：\n$$\nP_{2} = \\sum_{k=1}^{N}\\mu_{k}\\lambda_{2}^{\\alpha_{k}-1} - p\\lambda_{2}^{-1} = 0\n$$\n我们现在可以求解拉格朗日乘子 $p$：\n$$\np\\lambda_{2}^{-1} = \\sum_{k=1}^{N}\\mu_{k}\\lambda_{2}^{\\alpha_{k}-1}\n$$\n$$\np = \\lambda_{2}\\sum_{k=1}^{N}\\mu_{k}\\lambda_{2}^{\\alpha_{k}-1} = \\sum_{k=1}^{N}\\mu_{k}\\lambda_{2}^{\\alpha_{k}}\n$$\n将 $\\lambda_{2}=\\lambda^{-1/2}$ 代入 $p$ 的表达式中：\n$$\np = \\sum_{k=1}^{N}\\mu_{k}\\left(\\lambda^{-1/2}\\right)^{\\alpha_{k}} = \\sum_{k=1}^{N}\\mu_{k}\\lambda^{-\\alpha_{k}/2}\n$$\n现在我们得到了压力 $p$ 关于轴向拉伸 $\\lambda$ 和材料参数的表达式。我们可以用它来求名义轴向应力 $P_{11}$，它与第一主 PK1 应力 $P_1$ 相同。\n$$\nP_{11} = P_{1} = \\sum_{k=1}^{N}\\mu_{k}\\lambda_{1}^{\\alpha_{k}-1} - p\\lambda_{1}^{-1}\n$$\n代入 $\\lambda_1=\\lambda$ 和推导出的 $p$ 的表达式：\n$$\nP_{11} = \\sum_{k=1}^{N}\\mu_{k}\\lambda^{\\alpha_{k}-1} - \\left(\\sum_{k=1}^{N}\\mu_{k}\\lambda^{-\\alpha_{k}/2}\\right)\\lambda^{-1}\n$$\n分配 $\\lambda^{-1}$ 项并合并求和，即可得到名义轴向应力的最终表达式：\n$$\nP_{11}(\\lambda) = \\sum_{k=1}^{N}\\mu_{k}\\lambda^{\\alpha_{k}-1} - \\sum_{k=1}^{N}\\mu_{k}\\lambda^{-1-\\alpha_{k}/2} = \\sum_{k=1}^{N}\\mu_{k}\\left(\\lambda^{\\alpha_{k}-1} - \\lambda^{-1-\\frac{\\alpha_{k}}{2}}\\right)\n$$\n这是名义轴向应力作为轴向拉伸 $\\lambda$ 的函数的闭式解析表达式。作为检验，对于未变形状态，其中 $\\lambda=1$，应力 $P_{11}(1)=\\sum_{k=1}^{N}\\mu_{k}(1-1)=0$，这是正确的结果。", "answer": "$$\n\\boxed{\\sum_{k=1}^{N}\\mu_{k}\\left(\\lambda^{\\alpha_{k}-1} - \\lambda^{-1-\\frac{\\alpha_{k}}{2}}\\right)}\n$$", "id": "2582990"}, {"introduction": "解析推导构成了理论基础，但现代工程依赖于有限元法（FEM）等数值方法来解决实际问题。本练习通过对 Ogden 模型进行数值实现，架起了理论与计算之间的桥梁，并比较了处理近不可压缩性的两种常用技术：罚函数法和混合法。通过编写程序比较这两种方法，您将深入了解超弹性材料有限元分析中的实际挑战，并理解选择数值格式时所涉及的权衡 [@problem_id:2582982]。", "problem": "要求您实现一个基于原理的数值比较，用于比较有限元法 (FEM) 中用于近不可压缩超弹性的两种列式方法：罚函数法和混合法，该比较基于一个 Ogden 材料的基准单轴拉伸测试。您的程序必须计算，对于指定的参数集，随着体积罚参数的增加，罚函数法如何收敛到混合（不可压缩）法，并且必须报告一组指定拉伸比下的定量误差度量。\n\n考虑一个沿第一主轴施加于服从 Ogden 模型（具有等容-体积分离）的超弹性固体上的均匀单轴变形。变形梯度被视为对角矩阵，其主拉伸比为 $\\lambda_1=\\lambda$、$\\lambda_2=s$ 和 $\\lambda_3=s$，其中 $\\lambda>0$ 是施加的轴向拉伸比，$s>0$ 是由横向无牵引边界条件决定的未知横向拉伸比。雅可比行列式为 $J=\\det \\mathbf{F}=\\lambda s^2$。等容主拉伸比定义为 $\\bar{\\lambda}_i=J^{-1/3}\\lambda_i$，其中 $i\\in\\{1,2,3\\}$。\n\n总应变能密度可加性地分解为一个等容部分和一个体积部分，\n$$\nW(\\lambda_1,\\lambda_2,\\lambda_3)=W_{\\mathrm{iso}}(\\bar{\\lambda}_1,\\bar{\\lambda}_2,\\bar{\\lambda}_3)+U(J),\n$$\n其中等容 Ogden 模型为\n$$\nW_{\\mathrm{iso}}(\\bar{\\lambda}_1,\\bar{\\lambda}_2,\\bar{\\lambda}_3)=\\sum_{k=1}^{N}\\frac{\\mu_k}{\\alpha_k}\\left(\\bar{\\lambda}_1^{\\alpha_k}+\\bar{\\lambda}_2^{\\alpha_k}+\\bar{\\lambda}_3^{\\alpha_k}-3\\right),\n$$\n对于给定的参数 $\\mu_k>0$ 和 $\\alpha_k>0$。对于罚函数法，体积能取为\n$$\nU(J)=\\frac{K}{2}(J-1)^2,\n$$\n其中体积罚参数 $K\\gg 0$。对于混合法，通过拉格朗日乘子 $p$ 来处理不可压缩性，使得 $J=1$ 精确成立，并且没有 $U(J)$ 项。\n\n从超弹性的基本原理和柯西应力 (Cauchy stress) 的定义 $\\boldsymbol{\\sigma}=\\frac{1}{J}\\mathbf{F}\\,\\frac{\\partial W}{\\partial \\mathbf{F}}\\,\\mathbf{F}^\\mathsf{T}$ 出发，推导两种列式方法下以主拉伸比表示的主柯西应力：\n\n1. 罚函数法：横向无牵引边界条件要求在自由横向表面上 $\\sigma_2=0$ 和 $\\sigma_3=0$。在给定的 $\\lambda$ 和 $K$ 下，从条件 $\\sigma_2(\\lambda,s;K,\\{\\mu_k,\\alpha_k\\})=0$ 中求解 $s$。然后计算轴向柯西应力 $\\sigma_1(\\lambda,s;K,\\{\\mu_k,\\alpha_k\\})$。\n\n2. 混合法（不可压缩）：精确强制 $J=1$，这意味着 $s=\\lambda^{-1/2}$。从横向无牵引边界条件确定拉格朗日乘子 $p$，并计算轴向柯西应力 $\\sigma_1^{(\\mathrm{mix})}(\\lambda;\\{\\mu_k,\\alpha_k\\})$。\n\n为进行数值比较，请使用以下基准参数集和测试套件：\n\n- Ogden 参数：$N=2$，$(\\mu_1,\\alpha_1)=(1.25,\\;2.0)$ 和 $(\\mu_2,\\alpha_2)=(0.10,\\;6.0)$，单位分别为兆帕 (MPa) 和无量纲。\n- 体积罚值：$K\\in\\{20.0,\\;200.0,\\;2000.0\\}$，单位为兆帕 (MPa)。\n- 轴向拉伸比：$\\lambda\\in\\{1.0,\\;1.1,\\;1.5,\\;2.0\\}$（无量纲）。\n\n对于集合中的每个 $K$，计算罚函数法和混合不可压缩法预测的轴向柯西应力在给定拉伸比上的最大绝对差（单位为兆帕），即：\n$$\nE(K)=\\max_{\\lambda\\in\\{1.0,1.1,1.5,2.0\\}}\\left|\\sigma_1^{(\\mathrm{pen})}(\\lambda;K)-\\sigma_1^{(\\mathrm{mix})}(\\lambda)\\right|.\n$$\n\n您的任务：\n\n- 对于每个给定的 $\\lambda$ 和 $K$，稳健地实现罚函数法中横向无牵引边界条件的求解，并计算 $\\sigma_1^{(\\mathrm{pen})}(\\lambda;K)$。\n- 使用精确的不可压缩性约束，为每个 $\\lambda$ 计算混合不可压缩轴向应力 $\\sigma_1^{(\\mathrm{mix})}(\\lambda)$。\n- 使用指定的拉伸比，为每个规定的 $K$ 计算 $E(K)$。\n- 所有应力和最终误差均以兆帕 (MPa) 表示。\n\n最终程序必须生成单行输出，包含三个值 $[E(20.0),E(200.0),E(2000.0)]$，形式为方括号内用逗号分隔的列表，例如 $[e_{20},e_{200},e_{2000}]$。数值应以兆帕为单位的浮点数打印。\n\n您的程序必须是自包含的，不需要任何输入，并且只使用指定的库。确保数值解对于所有测试拉伸比（包括边界情况 $\\lambda=1.0$）都是稳健的。", "solution": "我们从超弹性的基本设定开始。对于应变能密度为 $W(\\mathbf{F})$ 的超弹性材料，第一 Piola–Kirchhoff 应力由 $\\mathbf{P}=\\frac{\\partial W}{\\partial \\mathbf{F}}$ 给出，柯西应力由 $\\boldsymbol{\\sigma}=\\frac{1}{J}\\mathbf{P}\\mathbf{F}^\\mathsf{T}=\\frac{1}{J}\\mathbf{F}\\frac{\\partial W}{\\partial \\mathbf{F}}\\mathbf{F}^\\mathsf{T}$ 给出，其中 $J=\\det \\mathbf{F}$。在主拉伸比和能量通过等容-体积分离依赖于主拉伸比的特殊情况下，在主方向上进行计算很方便。设主拉伸比为 $(\\lambda_1,\\lambda_2,\\lambda_3)$，对于单轴测试，有 $\\lambda_1=\\lambda$ 和 $\\lambda_2=\\lambda_3=s$。\n\n能量为 $W=W_{\\mathrm{iso}}(\\bar{\\lambda}_1,\\bar{\\lambda}_2,\\bar{\\lambda}_3)+U(J)$，其中 $\\bar{\\lambda}_i=J^{-1/3}\\lambda_i$ 且 $J=\\lambda s^2$。对于等容 Ogden 模型，\n$$\nW_{\\mathrm{iso}}(\\bar{\\lambda}_1,\\bar{\\lambda}_2,\\bar{\\lambda}_3)=\\sum_{k=1}^{N}\\frac{\\mu_k}{\\alpha_k}\\left(\\bar{\\lambda}_1^{\\alpha_k}+\\bar{\\lambda}_2^{\\alpha_k}+\\bar{\\lambda}_3^{\\alpha_k}-3\\right).\n$$\n对于罚函数模型，$U(J)=\\tfrac{K}{2}(J-1)^2$，其中 $K>0$。对于混合模型，通过拉格朗日乘子 $p$ 精确强制 $J=1$，且没有 $U(J)$ 贡献。\n\n为了计算应力，我们使用从链式法则和等容能量的各向同性推导出的标准结果。Kirchhoff 应力定义为 $\\boldsymbol{\\tau}=J\\boldsymbol{\\sigma}$。对于上述形式的等容能量，其对主 Kirchhoff 应力的偏（无迹）贡献为\n$$\n\\tau_i^{\\mathrm{iso}}=\\sum_{k=1}^{N}\\mu_k\\left(\\bar{\\lambda}_i^{\\alpha_k}-\\frac{1}{3}\\left(\\bar{\\lambda}_1^{\\alpha_k}+\\bar{\\lambda}_2^{\\alpha_k}+\\bar{\\lambda}_3^{\\alpha_k}\\right)\\right),\\quad i\\in\\{1,2,3\\}.\n$$\n这个形式是通过对 $W_{\\mathrm{iso}}$ 关于 $\\lambda_i$ 求导得出的，同时考虑了 $\\bar{\\lambda}_j$ 对 $J$ 的依赖性，然后组合 $\\boldsymbol{\\tau}=J\\frac{\\partial W}{\\partial \\ln \\lambda_i}$ 的主分量，得到一个偏张量，其迹对于每个 $\\alpha_k$ 阶项都为零。罚函数模型的体积贡献以各向同性压力项 $p_{\\mathrm{vol}}(J)=\\frac{\\mathrm{d}U}{\\mathrm{d}J}$ 的形式进入柯西应力，\n$$\np_{\\mathrm{vol}}(J)=\\frac{\\mathrm{d}}{\\mathrm{d}J}\\left(\\frac{K}{2}(J-1)^2\\right)=K(J-1).\n$$\n因此，罚函数模型的主柯西应力为\n$$\n\\sigma_i^{(\\mathrm{pen})}=\\frac{1}{J}\\tau_i^{\\mathrm{iso}}+p_{\\mathrm{vol}}(J)=\\frac{1}{J}\\tau_i^{\\mathrm{iso}}+K(J-1),\\quad i\\in\\{1,2,3\\}.\n$$\n\n罚函数法。横向无牵引边界条件为 $\\sigma_2^{(\\mathrm{pen})}=0$ 和 $\\sigma_3^{(\\mathrm{pen})}=0$。根据对称性，由于 $\\lambda_2=\\lambda_3=s$，只需施加 $\\sigma_2^{(\\mathrm{pen})}=0$。这对每个给定的轴向拉伸比 $\\lambda$ 和体积模量 $K$ 决定了未知的横向拉伸比 $s$。定义标量方程\n$$\ng(s;\\lambda,K)=\\sigma_2^{(\\mathrm{pen})}(\\lambda,s;K)=\\frac{1}{J(\\lambda,s)}\\tau_2^{\\mathrm{iso}}(\\bar{\\lambda}_1,\\bar{\\lambda}_2,\\bar{\\lambda}_3)+K(J(\\lambda,s)-1)=0,\n$$\n其中 $J(\\lambda,s)=\\lambda s^2$ 且 $\\bar{\\lambda}_i=J(\\lambda,s)^{-1/3}\\lambda_i$。对于固定的 $\\lambda$ 和 $K$，$g(s;\\lambda,K)$ 是 $(0,\\infty)$ 上的连续函数，并且由于体积项在 $J$ 较大时单调增长，以及在轴向拉伸下 $s$ 较小时偏横向应力为负，它将在不可压缩解 $s\\approx\\lambda^{-1/2}$ 附近有一个唯一的零点。我们使用稳健的区间法（如二分法）数值求解 $g(s;\\lambda,K)=0$。一旦找到根 $s^\\star$，我们计算轴向柯西应力\n$$\n\\sigma_1^{(\\mathrm{pen})}(\\lambda;K)=\\frac{1}{J(\\lambda,s^\\star)}\\tau_1^{\\mathrm{iso}}(\\bar{\\lambda}_1,\\bar{\\lambda}_2,\\bar{\\lambda}_3)+K(J(\\lambda,s^\\star)-1).\n$$\n\n混合不可压缩法。精确的不可压缩性强制 $J=1$，在单轴设定下，这意味着 $s=\\lambda^{-1/2}$。柯西应力由一个偏量部分加上拉格朗日乘子 $-p$ 乘以单位张量组成：\n$$\n\\sigma_i^{(\\mathrm{mix})}=\\frac{1}{J}\\tau_i^{\\mathrm{iso}}-p,\\quad J=1.\n$$\n横向无牵引边界条件要求 $\\sigma_2^{(\\mathrm{mix})}=0$，因此在 $J=1$ 时 $p=\\tau_2^{\\mathrm{iso}}$（在 $J=1$ 条件下 $\\bar{\\lambda}_i=\\lambda_i$）。因此，轴向应力为\n$$\n\\sigma_1^{(\\mathrm{mix})}=\\tau_1^{\\mathrm{iso}}-\\tau_2^{\\mathrm{iso}},\\quad \\text{evaluated at }(\\lambda_1,\\lambda_2,\\lambda_3)=(\\lambda,\\lambda^{-1/2},\\lambda^{-1/2}).\n$$\n该表达式对于不可压缩混合法是精确的，并作为我们的基准。\n\n误差度量和测试套件。对于每个体积模量 $K$ in $\\{20.0,200.0,2000.0\\}$ MPa 和每个轴向拉伸比 $\\lambda$ in $\\{1.0,1.1,1.5,2.0\\}$，我们计算绝对误差\n$$\ne(\\lambda,K)=\\left|\\sigma_1^{(\\mathrm{pen})}(\\lambda;K)-\\sigma_1^{(\\mathrm{mix})}(\\lambda)\\right|\\quad \\text{(in MPa)}.\n$$\n然后我们报告在拉伸比集合上的最大绝对误差，\n$$\nE(K)=\\max_{\\lambda\\in\\{1.0,1.1,1.5,2.0\\}} e(\\lambda,K).\n$$\n随着 $K$ 的增加，罚函数解应收敛于混合解，因此 $E(K)$ 应减小。\n\n算法设计。程序按以下步骤进行：\n\n- 实现一个函数，根据给定的 $(\\lambda_1,\\lambda_2,\\lambda_3)$、$J$ 和 Ogden 参数计算 $\\tau_i^{\\mathrm{iso}}$。该函数计算 $\\bar{\\lambda}_i=J^{-1/3}\\lambda_i$，为每个 $k$ 计算 $\\bar{\\lambda}_i^{\\alpha_k}$，形成和 $\\bar{\\lambda}_1^{\\alpha_k}+\\bar{\\lambda}_2^{\\alpha_k}+\\bar{\\lambda}_3^{\\alpha_k}$，并如上所述组合成 $\\tau_i^{\\mathrm{iso}}$。\n\n- 实现一个函数，在给定 $\\lambda$ 和 $K$ 的情况下，通过二分法求解 $g(s;\\lambda,K)=0$：\n  - 初始化一个区间 $(s_{\\mathrm{low}},s_{\\mathrm{high}})$，例如 $s_{\\mathrm{low}}=10^{-6}$ 和 $s_{\\mathrm{high}}=10$，如有必要，扩展 $s_{\\mathrm{high}}$ 直到 $g(s_{\\mathrm{low}})$ 和 $g(s_{\\mathrm{high}})$ 符号相反。$g$ 的结构确保对于所考虑的参数，在合理范围内会发生符号变化。\n  - 迭代二分法，直到 $s$ 或 $g$ 收敛到指定的容差。\n\n- 在收敛的 $s^\\star$ 处计算 $\\sigma_1^{(\\mathrm{pen})}$，在 $s=\\lambda^{-1/2}$ 处计算 $\\sigma_1^{(\\mathrm{mix})}$。\n\n- 对于给定的 Ogden 参数 $(\\mu_1,\\alpha_1)=(1.25,2.0)$ MPa 和 $(\\mu_2,\\alpha_2)=(0.10,6.0)$，体积模量 $K\\in\\{20.0,200.0,2000.0\\}$ MPa，以及拉伸比 $\\lambda\\in\\{1.0,1.1,1.5,2.0\\}$，以兆帕为单位计算 $E(K)$。\n\n- 以 $[E(20.0),E(200.0),E(2000.0)]$ 的格式单行输出结果。\n\n单位。所有应力和模量都以兆帕 (MPa) 为单位。拉伸比是无量纲的。最终误差值 $E(K)$ 必须以兆帕 (MPa) 为单位报告。\n\n此过程在典型的单轴设定下直接测试了罚函数法向混合法收敛的行为，并且忠实于超弹性和 Ogden 模型的基本原理。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Execution environment: Python 3.12, numpy 1.23.5, scipy 1.11.4 (not used), no external files or input.\n\nimport numpy as np\n\n# Ogden parameters (MPa, dimensionless)\nMU = np.array([1.25, 0.10], dtype=float)   # [mu1, mu2] in MPa\nALPHA = np.array([2.0, 6.0], dtype=float)  # [alpha1, alpha2]\n\n# Test suite\nK_LIST = [20.0, 200.0, 2000.0]  # MPa\nLAMBDA_LIST = [1.0, 1.1, 1.5, 2.0]  # dimensionless\n\n\ndef tau_iso_principal(l1, l2, l3):\n    \"\"\"\n    Compute the principal deviatoric Kirchhoff stresses (tau_iso) for the\n    isochoric Ogden model with parameters MU, ALPHA at given principal stretches.\n    Inputs:\n        l1, l2, l3: principal stretches (lambda_1, lambda_2, lambda_3)\n    Returns:\n        tau1_iso, tau2_iso, tau3_iso (in MPa)\n    \"\"\"\n    # J and barred stretches\n    J = l1 * l2 * l3\n    # Guard against non-positive J\n    if J == 0.0:\n        raise ValueError(\"Non-positive Jacobian encountered.\")\n    Jm13 = J ** (-1.0 / 3.0)\n    lb1 = l1 * Jm13\n    lb2 = l2 * Jm13\n    lb3 = l3 * Jm13\n\n    # Accumulate deviatoric Kirchhoff stresses\n    tau1 = 0.0\n    tau2 = 0.0\n    tau3 = 0.0\n    for mu_k, a_k in zip(MU, ALPHA):\n        q1 = lb1 ** a_k\n        q2 = lb2 ** a_k\n        q3 = lb3 ** a_k\n        s = q1 + q2 + q3\n        # Deviatoric principal Kirchhoff stress contribution for this term\n        tau1 += mu_k * (q1 - s / 3.0)\n        tau2 += mu_k * (q2 - s / 3.0)\n        tau3 += mu_k * (q3 - s / 3.0)\n    return tau1, tau2, tau3\n\n\ndef penalty_lateral_equation(s, lam, K):\n    \"\"\"\n    g(s; lam, K) = sigma_2^{penalty} for given lam and K.\n    Returns value in MPa.\n    \"\"\"\n    l1 = lam\n    l2 = s\n    l3 = s\n    J = l1 * l2 * l3\n    tau1, tau2, tau3 = tau_iso_principal(l1, l2, l3)\n    sigma2_iso = tau2 / J  # deviatoric isochoric part in Cauchy stress\n    p_vol = K * (J - 1.0)  # volumetric pressure-like term\n    return sigma2_iso + p_vol\n\n\ndef solve_lateral_stretch_penalty(lam, K, tol=1e-12, max_iter=200):\n    \"\"\"\n    Solve for lateral stretch s > 0 such that penalty_lateral_equation(s, lam, K) = 0.\n    Uses robust bracketing with bisection.\n    \"\"\"\n    # Special case: no deformation, s = 1 exactly\n    if abs(lam - 1.0)  1e-15:\n        return 1.0\n\n    # Initialize bracket\n    s_low = 1e-6\n    s_high = 10.0\n    f_low = penalty_lateral_equation(s_low, lam, K)\n    f_high = penalty_lateral_equation(s_high, lam, K)\n\n    # Expand high until sign change\n    expand_count = 0\n    while f_low * f_high > 0.0 and expand_count  60:\n        s_high *= 2.0\n        f_high = penalty_lateral_equation(s_high, lam, K)\n        expand_count += 1\n\n    if f_low == 0.0:\n        return s_low\n    if f_high == 0.0:\n        return s_high\n    if f_low * f_high > 0.0:\n        # As a fallback, try centering around incompressible guess\n        s_guess = lam ** (-0.5)\n        # Bracket around guess\n        s_low = max(1e-12, 0.1 * s_guess)\n        s_high = 10.0 * s_guess + 1e-12\n        f_low = penalty_lateral_equation(s_low, lam, K)\n        f_high = penalty_lateral_equation(s_high, lam, K)\n        expand_count = 0\n        while f_low * f_high > 0.0 and expand_count  60:\n            s_high *= 2.0\n            f_high = penalty_lateral_equation(s_high, lam, K)\n            expand_count += 1\n        if f_low * f_high > 0.0:\n            raise RuntimeError(\"Failed to bracket root for s in penalty method.\")\n\n    # Bisection\n    for _ in range(max_iter):\n        s_mid = 0.5 * (s_low + s_high)\n        f_mid = penalty_lateral_equation(s_mid, lam, K)\n        if abs(f_mid)  1e-12 or abs(s_high - s_low)  tol:\n            return s_mid\n        if f_low * f_mid = 0.0:\n            s_high = s_mid\n            f_high = f_mid\n        else:\n            s_low = s_mid\n            f_low = f_mid\n    return 0.5 * (s_low + s_high)\n\n\ndef axial_stress_penalty(lam, K):\n    \"\"\"\n    Compute axial Cauchy stress sigma_1 (MPa) for penalty formulation at given lam and K.\n    \"\"\"\n    s = solve_lateral_stretch_penalty(lam, K)\n    l1 = lam\n    l2 = s\n    l3 = s\n    J = l1 * l2 * l3\n    tau1, tau2, tau3 = tau_iso_principal(l1, l2, l3)\n    sigma1_iso = tau1 / J\n    p_vol = K * (J - 1.0)\n    return sigma1_iso + p_vol\n\n\ndef axial_stress_mixed(lam):\n    \"\"\"\n    Compute axial Cauchy stress sigma_1 (MPa) for mixed incompressible formulation at given lam.\n    Enforce J=1 => s = lam^{-1/2}.\n    \"\"\"\n    s = lam ** (-0.5)\n    l1 = lam\n    l2 = s\n    l3 = s\n    # Under J=1, tau_iso equals Cauchy deviatoric part (since J=1)\n    tau1, tau2, tau3 = tau_iso_principal(l1, l2, l3)\n    # Lagrange multiplier p is tau2 to enforce sigma2=0\n    return tau1 - tau2\n\n\ndef compute_errors():\n    \"\"\"\n    For each K in K_LIST, compute the maximum absolute error over LAMBDA_LIST\n    between penalty and mixed axial stresses. Returns list of floats in MPa.\n    \"\"\"\n    errors = []\n    for K in K_LIST:\n        emax = 0.0\n        for lam in LAMBDA_LIST:\n            sig_pen = axial_stress_penalty(lam, K)\n            sig_mix = axial_stress_mixed(lam)\n            err = abs(sig_pen - sig_mix)\n            if err > emax:\n                emax = err\n        errors.append(emax)\n    return errors\n\n\ndef solve():\n    errors = compute_errors()\n    # Print in the exact required format\n    # Use full precision floats as default string conversion\n    print(f\"[{','.join(map(str, errors))}]\")\n\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2582982"}]}