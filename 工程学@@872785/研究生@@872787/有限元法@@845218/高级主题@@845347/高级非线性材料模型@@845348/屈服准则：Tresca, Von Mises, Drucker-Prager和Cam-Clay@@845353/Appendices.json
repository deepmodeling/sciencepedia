{"hands_on_practices": [{"introduction": "大多数高级屈服准则，如von Mises和Drucker-Prager模型，都不是直接用应力张量的分量来表示，而是用其不变量来表示。这个基础练习将引导你计算这些关键量——柯西应力张量的第一不变量 ($I_1$) 和偏应力张量的第二、第三不变量 ($J_2$, $J_3$)，这是在任何弹塑性分析中都必不可少的第一步。[@problem_id:2612526]", "problem": "在有限元法 (FEM) 框架下的计算弹塑性力学中，诸如 von Mises、Tresca、Drucker–Prager 和 Cam–Clay 模型等屈服函数是根据应力不变量和 Cauchy 应力的偏-体分解来计算的。考虑一个 Gauss 点处的小应变三维实体，其对称 Cauchy 应力张量（单位：兆帕）由下式给出：\n$$\n\\boldsymbol{\\sigma}=\\begin{bmatrix} 100  30  0 \\\\ 30  40  0 \\\\ 0  0  20 \\end{bmatrix}.\n$$\n从本构模型中使用的应力不变量和偏量分解的定义出发，计算 Cauchy 应力的第一不变量 $I_1$、偏应力的第二和第三不变量（记为 $J_2$ 和 $J_3$），以及与 $\\boldsymbol{\\sigma}$ 相关的偏应力张量 $\\boldsymbol{s}$。将 $I_1$ 以 $\\mathrm{MPa}$ 为单位、$J_2$ 以 $\\mathrm{MPa}^2$ 为单位、$J_3$ 以 $\\mathrm{MPa}^3$ 为单位，以及 $\\boldsymbol{s}$ 的各分量以 $\\mathrm{MPa}$ 为单位表示。提供精确值（不进行四舍五入）。最终答案必须按顺序依次列出 $I_1$、$J_2$、$J_3$ 和 $\\boldsymbol{s}$。", "solution": "所求的量源于本构模型中用于屈服准则的 Cauchy 应力的标准偏-体分解。基本定义如下：\n- Cauchy 应力的第一不变量是 $I_1=\\operatorname{tr}(\\boldsymbol{\\sigma})$。\n- 偏应力张量是 $\\boldsymbol{s}=\\boldsymbol{\\sigma}-p\\,\\boldsymbol{I}$，其中 $p=\\frac{1}{3}I_1$ 且 $\\boldsymbol{I}$ 是二阶单位张量，这确保了 $\\operatorname{tr}(\\boldsymbol{s})=0$。\n- 偏应力的第二不变量是 $J_2=\\frac{1}{2}\\,s_{ij}s_{ij}$，其中重复的下标表示求和。\n- 偏应力的第三不变量是 $J_3=\\det(\\boldsymbol{s})$。\n\n步骤 1：计算第一不变量 $I_1$。\n给定\n$$\n\\boldsymbol{\\sigma}=\\begin{bmatrix} 100  30  0 \\\\ 30  40  0 \\\\ 0  0  20 \\end{bmatrix},\n$$\n迹为\n$$\nI_1=\\operatorname{tr}(\\boldsymbol{\\sigma})=100+40+20=160.\n$$\n\n步骤 2：计算偏应力 $\\boldsymbol{s}$。\n平均应力为\n$$\np=\\frac{1}{3}I_1=\\frac{160}{3}.\n$$\n因此\n$$\n\\boldsymbol{s}=\\boldsymbol{\\sigma}-\\frac{I_1}{3}\\boldsymbol{I}\n=\\begin{bmatrix} 100  30  0 \\\\ 30  40  0 \\\\ 0  0  20 \\end{bmatrix}\n-\\begin{bmatrix} \\frac{160}{3}  0  0 \\\\ 0  \\frac{160}{3}  0 \\\\ 0  0  \\frac{160}{3} \\end{bmatrix}\n=\\begin{bmatrix}\n100-\\frac{160}{3}  30  0 \\\\\n30  40-\\frac{160}{3}  0 \\\\\n0  0  20-\\frac{160}{3}\n\\end{bmatrix}.\n$$\n简化每个分量，\n$$\n\\boldsymbol{s}=\\begin{bmatrix}\n\\frac{140}{3}  30  0 \\\\\n30  -\\frac{40}{3}  0 \\\\\n0  0  -\\frac{100}{3}\n\\end{bmatrix}.\n$$\n\n步骤 3：计算 $J_2=\\frac{1}{2}\\,s_{ij}s_{ij}$。\n根据定义，\n$$\ns_{ij}s_{ij}=\\sum_{i=1}^{3}\\sum_{j=1}^{3} s_{ij}^{2}\n=\\left(\\frac{140}{3}\\right)^{2}+\\left(-\\frac{40}{3}\\right)^{2}+\\left(-\\frac{100}{3}\\right)^{2}\n+2\\cdot 30^{2}+0+0,\n$$\n其中非对角线项的贡献来自 $s_{12}=s_{21}=30$，其他非对角线项为零。计算对角线项：\n$$\n\\left(\\frac{140}{3}\\right)^{2}=\\frac{19600}{9},\\quad\n\\left(\\frac{40}{3}\\right)^{2}=\\frac{1600}{9},\\quad\n\\left(\\frac{100}{3}\\right)^{2}=\\frac{10000}{9}.\n$$\n求和，\n$$\n\\sum_{\\text{diag}}=\\frac{19600+1600+10000}{9}=\\frac{31200}{9},\\quad\n\\sum_{\\text{off-diag}}=2\\cdot 30^{2}=1800=\\frac{16200}{9}.\n$$\n因此，\n$$\ns_{ij}s_{ij}=\\frac{31200}{9}+\\frac{16200}{9}=\\frac{47400}{9},\n$$\n所以\n$$\nJ_2=\\frac{1}{2}\\,s_{ij}s_{ij}=\\frac{1}{2}\\cdot \\frac{47400}{9}=\\frac{23700}{9}=\\frac{7900}{3}.\n$$\n\n步骤 4：计算 $J_3=\\det(\\boldsymbol{s})$。\n偏应力是块对角的，即第三行和第三列除了对角线项外与前两行两列解耦，所以\n$$\nJ_3=\\det(\\boldsymbol{s})\n=\\left(-\\frac{100}{3}\\right)\\det\\begin{bmatrix} \\frac{140}{3}  30 \\\\ 30  -\\frac{40}{3} \\end{bmatrix}.\n$$\n$2\\times 2$ 行列式是\n$$\n\\det\\begin{bmatrix} \\frac{140}{3}  30 \\\\ 30  -\\frac{40}{3} \\end{bmatrix}\n=\\frac{140}{3}\\left(-\\frac{40}{3}\\right)-30\\cdot 30\n=-\\frac{5600}{9}-900\n=-\\frac{5600+8100}{9}\n=-\\frac{13700}{9}.\n$$\n因此\n$$\nJ_3=\\left(-\\frac{100}{3}\\right)\\left(-\\frac{13700}{9}\\right)=\\frac{1370000}{27}.\n$$\n\n所有量均为精确值。$I_1$ 的单位为 $\\mathrm{MPa}$，$J_2$ 的单位为 $\\mathrm{MPa}^{2}$，$J_3$ 的单位为 $\\mathrm{MPa}^{3}$，$\\boldsymbol{s}$ 各分量的单位为 $\\mathrm{MPa}$。", "answer": "$$\\boxed{\\begin{pmatrix}\n160  \\frac{7900}{3}  \\frac{1370000}{27}  \\begin{pmatrix} \\frac{140}{3}  30  0 \\\\ 30  -\\frac{40}{3}  0 \\\\ 0  0  -\\frac{100}{3} \\end{pmatrix}\n\\end{pmatrix}}$$", "id": "2612526"}, {"introduction": "屈服准则中的材料参数必须通过实验数据来确定。本练习探讨了如何使用最基本的材料试验——单轴拉伸试验——来校准两个经典的屈服准则：Tresca和von Mises。通过这个实践，你将理解这些模型的物理意义，以及它们如何预测不同应力状态下的材料屈服。[@problem_id:2612493]", "problem": "考虑一个沿$x$轴进行单轴拉伸试验的小应变、各向同性、均质固体。测得初始屈服时的Cauchy应力张量为\n$$\n\\boldsymbol{\\sigma} = \\operatorname{diag}(\\sigma_y, 0, 0),\n$$\n其中$\\sigma_y$是测得的轴向屈服应力。您可以假设标准三维设定，主应力表示为$\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3$。\n\n基于此实验结果，校准 Tresca 和 von Mises 屈服准则。具体而言：\n1. 对于 Tresca 准则，其形式为 $\\tau_{\\max} = k$，其中 $\\tau_{\\max} = (\\sigma_1 - \\sigma_3)/2$ 是最大剪应力。请确定材料参数 $k$。\n2. 对于 von Mises 准则，其屈服条件是在单轴拉伸中 $\\sigma_{eq} = \\sigma_y$，其中等效应力定义为 $\\sigma_{eq} = \\sqrt{3J_2}$（$J_2$ 是偏应力第二不变量）。请计算在此屈服状态下的等效应力 $\\sigma_{eq}$ 的值。\n\n将两个结果都用 $\\sigma_y$ 表示。", "solution": "问题要求基于单轴拉伸试验中初始屈服时的应力状态，确定两个量：Tresca剪切屈服应力参数$k$和von Mises等效应力$\\sigma_{eq}$。两者都将用测得的轴向屈服应力$\\sigma_y$来表示。\n\n首先，我们确定Tresca参数$k$。给定的屈服时的Cauchy应力张量为\n$$\n\\boldsymbol{\\sigma} = \\operatorname{diag}(\\sigma_y, 0, 0) = \\begin{pmatrix} \\sigma_y  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n主应力是应力张量的特征值。对于对角矩阵，特征值就是对角线上的元素。问题陈述主应力按$\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3$排序。在拉伸试验中，轴向应力$\\sigma_y$是正值。因此，主应力为：\n$$\n\\sigma_1 = \\sigma_y, \\quad \\sigma_2 = 0, \\quad \\sigma_3 = 0\n$$\n最大剪应力$\\tau_{\\max}$定义为$\\frac{\\sigma_1 - \\sigma_3}{2}$：\n$$\n\\tau_{\\max} = \\frac{\\sigma_y - 0}{2} = \\frac{\\sigma_y}{2}\n$$\n根据Tresca屈服准则，在屈服时$\\tau_{\\max} = k$。因此，Tresca剪切屈服应力$k$为：\n$$\nk = \\frac{\\sigma_y}{2}\n$$\n接下来，我们计算von Mises等效应力$\\sigma_{eq}$。定义为$\\sigma_{eq} = \\sqrt{3J_2}$。首先需要计算偏应力第二不变量$J_2$。为此，我们先计算偏应力张量$\\boldsymbol{s}$。\n应力第一不变量$I_1$是：\n$$\nI_1 = \\operatorname{tr}(\\boldsymbol{\\sigma}) = \\sigma_y + 0 + 0 = \\sigma_y\n$$\n偏应力张量$\\boldsymbol{s}$定义为$\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{I_1}{3}\\boldsymbol{I}$：\n$$\n\\boldsymbol{s} = \\begin{pmatrix} \\sigma_y  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} - \\frac{\\sigma_y}{3} \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3}\\sigma_y  0  0 \\\\ 0  -\\frac{1}{3}\\sigma_y  0 \\\\ 0  0  -\\frac{1}{3}\\sigma_y \\end{pmatrix}\n$$\n偏应力第二不变量$J_2$定义为$J_2 = \\frac{1}{2} s_{ij}s_{ij} = \\frac{1}{2} \\operatorname{tr}(\\boldsymbol{s}^2)$。使用主偏应力分量计算$J_2$：\n$$\nJ_2 = \\frac{1}{2} (s_1^2 + s_2^2 + s_3^2) = \\frac{1}{2} \\left[ \\left(\\frac{2}{3}\\sigma_y\\right)^2 + \\left(-\\frac{1}{3}\\sigma_y\\right)^2 + \\left(-\\frac{1}{3}\\sigma_y\\right)^2 \\right]\n$$\n$$\nJ_2 = \\frac{1}{2} \\left( \\frac{4}{9}\\sigma_y^2 + \\frac{1}{9}\\sigma_y^2 + \\frac{1}{9}\\sigma_y^2 \\right) = \\frac{1}{2} \\left( \\frac{6}{9}\\sigma_y^2 \\right) = \\frac{1}{3}\\sigma_y^2\n$$\n现在我们可以计算von Mises等效应力$\\sigma_{eq}$：\n$$\n\\sigma_{eq} = \\sqrt{3J_2} = \\sqrt{3 \\left( \\frac{1}{3}\\sigma_y^2 \\right)} = \\sqrt{\\sigma_y^2} = \\sigma_y\n$$\n这个结果验证了von Mises等效应力的定义：它被校准为在单轴拉伸下等于轴向应力。因此，在屈服时，$\\sigma_{eq}$的值就是$\\sigma_y$。\n最终结果为$k = \\sigma_y/2$和$\\sigma_{eq} = \\sigma_y$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\sigma_y}{2}  \\sigma_y \\end{pmatrix}}$$", "id": "2612493"}, {"introduction": "在计算塑性力学中，返回映射算法是更新应力状态的核心数值工具。这个综合性练习要求你为修正剑桥模型——一个广泛用于岩土工程的复杂模型——推导并实现返回映射算法。完成此练习将极大地加深你对隐式积分方案、塑性流动法则和硬化规律在有限元程序中如何协同工作的理解。[@problem_id:2612470]", "problem": "要求您在以 $(p',q)$ 表示的平均有效应力-偏应力平面上，为修正剑桥模型建立并实现一个稳健的单步本构更新（返回映射）算法。您的推导和实现必须从有限元法 (FEM) 中弹塑性力学的基本原理出发，仅使用核心定义和经过充分检验的公式。目标是利用一致性条件和各向同性硬化定律，推导出一个关于塑性乘子增量 $\\Delta\\lambda$ 的单一标量方程，然后为一组测试用例计算 $\\Delta\\lambda$。所有类应力量的单位必须为千帕 (kPa)，塑性乘子增量 $\\Delta\\lambda$ 为无量纲。\n\n使用的背景定义与假设：\n- 平均有效应力为 $p' = \\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma}')$（压为正），$q$不变量为 $q = \\sqrt{\\tfrac{3}{2}} \\lVert \\boldsymbol{s} \\rVert$，其中 $\\boldsymbol{s}$ 是偏应力张量。\n- 修正剑桥模型 (MCC) 的屈服函数为\n$$\nf(p',q,p_c') \\equiv \\frac{q^2}{M^2} + p'(p' - p_c') \\,,\n$$\n其中 $M$ 是 $p'$-$q$ 平面上的临界状态线斜率，$p_c'$ 是先期固结压力。\n- 弹性关系是各向同性的，具有共轭对 $(p',\\varepsilon_v)$ 和 $(q,\\varepsilon_s)$，因此弹性增量遵循 $dp' = K\\, d\\varepsilon_v^e$ 和 $dq = 3G\\, d\\varepsilon_s^e$，其中 $K$ 是体积模量，$G$ 是剪切模量。\n- 流动法则是相关联的：$d\\boldsymbol{\\varepsilon}^p = \\Delta\\lambda\\, \\dfrac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$。在共轭不变量对中，这意味着 $d\\varepsilon_v^p = \\Delta\\lambda\\, \\dfrac{\\partial f}{\\partial p'}$ 和 $d\\varepsilon_s^p = \\Delta\\lambda\\, \\dfrac{\\partial f}{\\partial q}$。\n- 各向同性硬化定律为 $d p_c' / p_c' = d\\varepsilon_v^p / (\\lambda - \\kappa)$，其中 $\\lambda$ 和 $\\kappa$ 分别是压缩指数和回弹指数（均为无量纲）。\n\n任务：\n1) 推导更新后的 $(p',q)$ 关于试探状态 $(p'^{tr}, q^{tr})$、塑性乘子增量 $\\Delta\\lambda$ 以及更新后的先期固结压力 $p_c'$ 的隐式返回映射关系。您必须从弹性预测-塑性修正结构出发：\n- 预测步：假设弹性增量以获得试探应力 $(p'^{tr}, q^{tr})$。\n- 修正步：使用 $\\Delta\\lambda$ 沿相关流动法向返回到屈服面，以满足塑性容许性条件。\n2) 在步末施加一致性条件 $f(p',q,p_c') = 0$，并将其与硬化定律结合，以获得关于 $\\Delta\\lambda$ 的单一标量方程。您必须消去 $(p',q)$，用 $\\Delta\\lambda$ 和 $p_c'$ 表示，然后利用硬化定律消去 $p_c'$，从而得到一个一维非线性方程 $g(\\Delta\\lambda) = 0$。请提供推导出该标量方程的显式表达式。\n3) 实现一个程序，对于每个测试用例，按如下方式计算 $\\Delta\\lambda$：\n- 如果试探状态是容许的，即 $f(p'^{tr}, q^{tr}, p_c'^{old}) \\le 0$，则令 $\\Delta\\lambda = 0$ 并保持试探状态（弹性步）。\n- 否则，使用稳健的求根方法求解非线性标量方程 $g(\\Delta\\lambda) = 0$，得到 $\\Delta\\lambda  0$。如果推导过程中自然出现特殊函数，您可以使用它们。当涉及多值函数时，请使用实数主支。\n- 在解出 $\\Delta\\lambda$ 后，您可以计算更新后的 $(p', q, p_c')$ 以进行内部验证，但要求的输出仅为 $\\Delta\\lambda$。\n- 类应力量的单位必须为千帕 (kPa)。塑性乘子 $\\Delta\\lambda$ 是无量纲的。角度单位不适用。此任务不涉及百分比。\n\n测试套件：\n对所有情况使用以下材料常数：$M = 1.2$，$K = 10000$ kPa，$G = 5000$ kPa，$\\lambda = 0.2$，$\\kappa = 0.05$，以及初始先期固结压力 $p_c'^{old} = 200$ kPa。提供以下试探状态 $(p'^{tr}, q^{tr})$：\n- 情况 A (弹性)：$p'^{tr} = 100$ kPa, $q^{tr} = 50$ kPa。\n- 情况 B (位于屈服面上)：$p'^{tr} = 150$ kPa, $q^{tr} = M \\sqrt{p'^{tr}\\,(p_c'^{old} - p'^{tr})} = 1.2 \\sqrt{150 \\cdot 50} \\approx 103.92304845413264$ kPa。\n- 情况 C (偏塑性)：$p'^{tr} = 120$ kPa, $q^{tr} = 200$ kPa。\n- 情况 D (近静水塑性)：$p'^{tr} = 220$ kPa, $q^{tr} = 10$ kPa。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含按顺序排列的情况 A-D 的四个计算出的 $\\Delta\\lambda$ 值，形式为用方括号括起来的逗号分隔列表。列表项必须是浮点数。不应打印任何其他文本。", "solution": "该问题要求为修正剑桥模型 (MCC) 建立并实现一个单步返回映射算法。目标是推导出一个关于塑性乘子增量 $\\Delta\\lambda$ 的单一非线性标量方程，并为一组给定的试探应力状态求解该方程。整个推导将基于完全隐式的后向欧拉积分格式，这是有限元方法中稳健本构更新的标准方法。\n\n材料的状态由平均有效应力 $p'$、偏应力 $q$ 和先期固结压力 $p_c'$ 描述。所有应力量的单位均为千帕 ($kPa$)。材料常数包括临界状态线斜率 $M$、体积模量 $K$、剪切模量 $G$、压缩指数 $\\lambda$ 和回弹指数 $\\kappa$。时间步开始时的状态已知，由 $p_c'^{old}$ 定义。提供了一个试探应力状态 $(p'^{tr}, q^{tr})$，该状态是假设纯弹性增量得到的。\n\n塑性修正步旨在找到更新后的状态 $(p', q, p_c')$ 和塑性乘子增量 $\\Delta\\lambda \\ge 0$，使得在时间步结束时，所有本构关系同时得到满足。\n\n单步更新的基本关系如下：\n1.  **屈服条件（一致性）：** 最终应力状态必须位于屈服面上。\n    $$f(p',q,p_c') = \\frac{q^2}{M^2} + p'(p' - p_c') = 0$$\n2.  **弹性应力-应变关系（返回映射）：** 更新后的应力是由塑性应变增量修正后的试探应力。\n    $$p' = p'^{tr} - K \\Delta\\varepsilon_v^p$$\n    $$q = q^{tr} - 3G \\Delta\\varepsilon_s^p$$\n3.  **相关流动法则：** 塑性应变增量与在最终状态下评估的屈服函数梯度成正比。\n    $$\\Delta\\varepsilon_v^p = \\Delta\\lambda \\frac{\\partial f}{\\partial p'} = \\Delta\\lambda (2p' - p_c')$$\n    $$\\Delta\\varepsilon_s^p = \\Delta\\lambda \\frac{\\partial f}{\\partial q} = \\Delta\\lambda \\frac{2q}{M^2}$$\n4.  **各向同性硬化定律：** 先期固结压力的演化与体积塑性应变相关。对给定的微分定律进行积分可得：\n    $$p_c' = p_c'^{old} \\exp\\left( \\frac{\\Delta\\varepsilon_v^p}{\\lambda - \\kappa} \\right)$$\n\n推导过程通过系统地组合这些方程来分离出 $\\Delta\\lambda$。\n\n首先，我们推导更新后的偏应力 $q$ 关于试探状态和 $\\Delta\\lambda$ 的显式表达式。将 $\\Delta\\varepsilon_s^p$ 的流动法则代入 $q$ 的返回映射方程：\n$$q = q^{tr} - 3G \\left( \\Delta\\lambda \\frac{2q}{M^2} \\right) = q^{tr} - \\frac{6G\\Delta\\lambda}{M^2}q$$\n重新整理以求解 $q$ 可得：\n$$q \\left( 1 + \\frac{6G\\Delta\\lambda}{M^2} \\right) = q^{tr}$$\n$$q(\\Delta\\lambda) = \\frac{q^{tr}}{1 + \\frac{6G\\Delta\\lambda}{M^2}}$$\n\n接下来，我们通过结合一致性条件和返回映射的体积部分，建立更新后的应力分量 $p'$ 和 $q$ 之间的关系。根据一致性条件，我们可以将更新后的先期固结压力 $p_c'$ 表示为：\n$$p_c' = p' + \\frac{q^2}{M^2 p'}$$\n注意，这里假设 $p' \\neq 0$，这是物理上所要求的。\n现在，我们将这个 $p_c'$ 的表达式用于体积塑性应变的流动法则：\n$$\\frac{\\partial f}{\\partial p'} = 2p' - p_c' = 2p' - \\left(p' + \\frac{q^2}{M^2 p'}\\right) = p' - \\frac{q^2}{M^2 p'}$$\n于是，体积塑性应变增量为：\n$$\\Delta\\varepsilon_v^p = \\Delta\\lambda \\left(p' - \\frac{q^2}{M^2 p'}\\right)$$\n将此式代入 $p'$ 的返回映射方程：\n$$p' = p'^{tr} - K \\Delta\\varepsilon_v^p = p'^{tr} - K\\Delta\\lambda \\left(p' - \\frac{q^2}{M^2 p'}\\right)$$\n重新整理此方程以求解 $p'$：\n$$p' + K\\Delta\\lambda\\, p' = p'^{tr} + \\frac{K\\Delta\\lambda\\, q^2}{M^2 p'}$$\n$$p'(1 + K\\Delta\\lambda) = p'^{tr} + \\frac{K\\Delta\\lambda\\, q^2}{M^2 p'}$$\n两边乘以 $p'$ 得到一个关于 $p'$ 的二次方程：\n$$(1 + K\\Delta\\lambda)(p')^2 - p'^{tr} p' - \\frac{K\\Delta\\lambda\\, q^2}{M^2} = 0$$\n使用二次公式求解 $p'$，并选择正根（因为平均有效应力 $p'$ 在受压时为正）：\n$$p'(\\Delta\\lambda) = \\frac{p'^{tr} + \\sqrt{(p'^{tr})^2 + 4(1 + K\\Delta\\lambda) \\frac{K\\Delta\\lambda\\, q(\\Delta\\lambda)^2}{M^2}}}{2(1 + K\\Delta\\lambda)}$$\n至此，$p'$ 和 $q$ 都已表示为单一未知数 $\\Delta\\lambda$ 的函数。\n\n最后，我们使用硬化定律来构建关于 $\\Delta\\lambda$ 的单一标量方程。从 $p'$ 的返回映射关系中，我们得到体积塑性应变增量的另一个表达式：\n$$\\Delta\\varepsilon_v^p = \\frac{p'^{tr} - p'}{K}$$\n将此式代入积分后的硬化定律：\n$$p_c' = p_c'^{old} \\exp\\left( \\frac{p'^{tr} - p'}{K(\\lambda - \\kappa)} \\right)$$\n令我们得到的两个 $p_c'$ 表达式（一个来自一致性条件，另一个来自硬化定律）相等，即可得到最终方程：\n$$p' + \\frac{q^2}{M^2 p'} = p_c'^{old} \\exp\\left( \\frac{p'^{tr} - p'}{K(\\lambda - \\kappa)} \\right)$$\n这就得到了所需单一非线性方程 $g(\\Delta\\lambda) = 0$，其中：\n$$g(\\Delta\\lambda) \\equiv p'(\\Delta\\lambda) + \\frac{q(\\Delta\\lambda)^2}{M^2 p'(\\Delta\\lambda)} - p_c'^{old} \\exp\\left( \\frac{p'^{tr} - p'(\\Delta\\lambda)}{K(\\lambda - \\kappa)} \\right) = 0$$\n这里，$p'(\\Delta\\lambda)$ 和 $q(\\Delta\\lambda)$ 是上面推导出的函数。\n\n为每个测试用例求解 $\\Delta\\lambda$ 的步骤如下：\n1.  首先，在试探状态下计算屈服函数值，$f_{tr} = f(p'^{tr}, q^{tr}, p_c'^{old})$。\n2.  如果 $f_{tr} \\le 0$，则该步为弹性步（或中性加载）。不需要进行塑性修正。因此，$\\Delta\\lambda = 0$。\n3.  如果 $f_{tr}  0$，则试探状态是不可容许的，需要进行塑性修正。我们必须找到方程 $g(\\Delta\\lambda) = 0$ 的正根 $\\Delta\\lambda  0$。可以使用数值求根算法，如 Brent-Dekker 方法。对于塑性步（$f_{tr}0$），可以证明 $g(0) = f_{tr}/p'^{tr}  0$ 且 $\\lim_{\\Delta\\lambda \\to \\infty} g(\\Delta\\lambda)  0$，这保证了正根的存在。\n\n至此，问题的公式化部分完成。实现部分将涉及编写函数 $g(\\Delta\\lambda)$ 的代码，并使用数值求解器在发生塑性变形的情况下找到其根。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the plastic multiplier increment in the Modified Cam-Clay model.\n    \"\"\"\n    # Material constants\n    M = 1.2\n    K = 10000.0  # kPa\n    G = 5000.0   # kPa\n    lam = 0.2    # lambda (compression index)\n    kap = 0.05   # kappa (swelling index)\n    \n    # Initial state\n    pc_old = 200.0  # kPa\n\n    # Test cases: (p_tr, q_tr) in kPa\n    test_cases = [\n        (100.0, 50.0),                          # Case A (elastic)\n        (150.0, 103.92304845413264),            # Case B (on yield surface)\n        (120.0, 200.0),                         # Case C (deviatoric plastic)\n        (220.0, 10.0),                          # Case D (nearly hydrostatic plastic)\n    ]\n\n    results = []\n    \n    # Pre-calculate some constants\n    M2 = M * M\n    lam_minus_kap = lam - kap\n\n    for p_tr, q_tr in test_cases:\n        # Step 1: Check if the trial state is elastic\n        f_tr = (q_tr**2 / M2) + p_tr * (p_tr - pc_old)\n        \n        if f_tr = 0:\n            # Elastic or neutral loading step\n            delta_lambda = 0.0\n            results.append(delta_lambda)\n            continue\n\n        # Step 2: Plastic step, define the residual function g(delta_lambda)\n        def g(delta_lambda):\n            \"\"\"\n            The scalar nonlinear equation g(delta_lambda) = 0.\n            \"\"\"\n            if delta_lambda  0:\n                # Physically inadmissible, return a large positive value\n                # to guide the solver.\n                return 1e12\n\n            # Calculate q based on delta_lambda\n            q = q_tr / (1.0 + 6.0 * G * delta_lambda / M2)\n\n            # Coefficients of the quadratic equation for p':\n            # A*p'^2 + B*p' + C = 0\n            A = 1.0 + K * delta_lambda\n            B = -p_tr\n            C = - (K * delta_lambda * q**2) / M2\n\n            # Solve for p' using the quadratic formula (positive root)\n            discriminant = B**2 - 4 * A * C\n            if discriminant  0:\n                # Should not happen for this problem formulation\n                # Return sentinel to indicate error\n                return np.nan\n            \n            p = (-B + np.sqrt(discriminant)) / (2.0 * A)\n            \n            # Evaluate the two expressions for the updated preconsolidation pressure\n            pc_from_consistency = p + (q**2) / (M2 * p)\n            pc_from_hardening = pc_old * np.exp((p_tr - p) / (K * lam_minus_kap))\n            \n            return pc_from_consistency - pc_from_hardening\n\n        # Step 3: Solve g(delta_lambda) = 0 for delta_lambda  0\n        try:\n            # Search for the root in the interval (0, 1]. This interval\n            # is typically large enough for soil mechanics problems.\n            # brentq requires the function values at the endpoints of the\n            # interval to have opposite signs. We know g(0)  0 and g(large)  0.\n            # Find a suitable upper bound if g(1) is not negative.\n            a = 1e-12  # A small positive number to avoid division by zero in some cases\n            b = 1.0 # Initial guess for upper bound\n            \n            # Simple bracketing: increase upper bound until g(b) is negative\n            while g(b)  0:\n                b *= 10\n                if b  1e6: # Safety break\n                    raise RuntimeError(\"Could not find a valid bracket for root finding.\")\n                    \n            delta_lambda = brentq(g, a, b, xtol=1e-12, rtol=1e-12)\n        except (ValueError, RuntimeError) as e:\n            # Error in root finding\n            print(f\"Error during root finding for case ({p_tr}, {q_tr}): {e}\")\n            delta_lambda = np.nan # Use NaN to indicate failure\n\n        results.append(delta_lambda)\n\n    # Final print statement in the exact required format.\n    # Convert results to string representation for printing\n    formatted_results = [f\"{res:.10f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2612470"}]}