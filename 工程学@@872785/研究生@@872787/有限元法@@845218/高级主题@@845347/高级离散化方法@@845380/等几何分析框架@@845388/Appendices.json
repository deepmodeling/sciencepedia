{"hands_on_practices": [{"introduction": "等几何分析的一个核心计算优势在于它能够利用所谓的“Bézier 提取”技术。这个过程允许我们将 B 样条基函数在每个单元上的表示，转换为等效的、但在计算上更易于处理的 Bernstein 多项式（Bézier 基函数）表示。本练习将通过从 Cox-de Boor 递归这一基本定义出发，推导Bézier提取矩阵，从而加深您对 B 样条与 Bézier 基函数之间内在联系的理解 [@problem_id:2569829]。", "problem": "考虑一维等几何分析（IGA）的设置，其参数域为 $[0,1]$，使用由开放非均匀节点向量 $\\Xi = [0,0,0,a,1,1,1]$ 定义的二次（$p=2$）B样条基，其中 $a \\in (0,1)$。重点关注与参数区间 $[0,a]$ 相关的左单元 $e$。令 $\\xi \\in [0,a]$ 表示参数坐标，并通过 $t = \\xi/a$ 定义到参考单元 $[0,1]$ 的局部仿射映射。令 $\\{B_0(t), B_1(t), B_2(t)\\}$ 表示 $[0,1]$ 上的二次 Bernstein 多项式，其中 $B_0(t) = (1-t)^2$，$B_1(t) = 2t(1-t)$，$B_2(t) = t^2$。\n\n根据贝塞尔提取的定义，B样条基 $\\{N_0^2(\\xi), N_1^2(\\xi), N_2^2(\\xi)\\}$ 在区间 $[0,a]$ 上的单元限制可以表示为 $\\{B_0(t), B_1(t), B_2(t)\\}$ 的线性组合，通过一个 $3 \\times 3$ 的贝塞尔提取矩阵 $C^{e}$ 实现，即\n$$\n\\begin{pmatrix}\nN_0^2(\\xi)\\\\\nN_1^2(\\xi)\\\\\nN_2^2(\\xi)\n\\end{pmatrix}\n= C^{e}\n\\begin{pmatrix}\nB_0(t)\\\\\nB_1(t)\\\\\nB_2(t)\n\\end{pmatrix},\n\\qquad t=\\xi/a,\\ \\xi\\in[0,a].\n$$\n\n仅从B样条的 Cox–de Boor 递归公式、Bernstein 基的定义以及仿射重参数化 $t=\\xi/a$ 出发，推导单元 $[0,a]$ 的 $C^{e}$ 矩阵，然后计算 $\\det(C^{e})$，给出一个关于 $a$ 的闭式解析表达式。\n\n你的最终答案必须是关于 $a$ 的单一闭式表达式（无单位）。不需要进行数值近似或四舍五入。", "solution": "我们从基本定义开始。二次（$p=2$）B样条基函数 $\\{N_i^2(\\xi)\\}$ 是通过 Cox–de Boor 递归公式定义的。开放节点向量为 $\\Xi = [\\xi_0,\\xi_1,\\xi_2,\\xi_3,\\xi_4,\\xi_5,\\xi_6]=[0,0,0,a,1,1,1]$。在左单元 $[0,a]$ 上，非零的B样条基函数为 $N_0^2(\\xi)$、$N_1^2(\\xi)$ 和 $N_2^2(\\xi)$。\n\n我们将使用 Cox–de Boor 递归公式推导这三个函数在区间 $\\xi\\in[0,a]$ 上的显式形式，然后用 $t=\\xi/a$ 将它们在 Bernstein 基 $\\{B_0(t),B_1(t),B_2(t)\\}$ 中重新表示，以确定贝塞尔提取矩阵 $C^{e}$。\n\n步骤1：零次基。根据定义，\n- 如果 $\\xi_i \\le \\xi  \\xi_{i+1}$，$N_i^0(\\xi)=1$，否则为 $0$。\n在 $\\xi\\in[0,a)$上，唯一的非零零次基是 $N_2^0(\\xi)=1$（在 $[\\xi_2,\\xi_3)=[0,a)$ 上）；所有其他零次基在此区间上都为零。\n\n步骤2：通过 Cox–de Boor 公式得到一次基。对于一次基，\n$$\nN_i^1(\\xi) = \\frac{\\xi-\\xi_i}{\\xi_{i+1}-\\xi_i}N_i^0(\\xi) + \\frac{\\xi_{i+2}-\\xi}{\\xi_{i+2}-\\xi_{i+1}}N_{i+1}^0(\\xi),\n$$\n约定任何分母为零的项都取零值。\n\n计算在 $[0,a)$ 上的两个相关的非零函数：\n\n- 对于 $i=1$，\n$$\nN_1^1(\\xi) = \\frac{\\xi-\\xi_1}{\\xi_2-\\xi_1}N_1^0(\\xi) + \\frac{\\xi_3-\\xi}{\\xi_3-\\xi_2}N_2^0(\\xi).\n$$\n这里 $\\xi_1=\\xi_2=0$ 使得第一项按约定为零，而 $\\xi_3=a$，$\\xi_2=0$，且在 $[0,a)$上 $N_2^0(\\xi)=1$。因此\n$$\nN_1^1(\\xi) = \\frac{a-\\xi}{a}.\n$$\n\n- 对于 $i=2$，\n$$\nN_2^1(\\xi) = \\frac{\\xi-\\xi_2}{\\xi_3-\\xi_2}N_2^0(\\xi) + \\frac{\\xi_4-\\xi}{\\xi_4-\\xi_3}N_3^0(\\xi).\n$$\n在 $[0,a)$ 上，$N_3^0(\\xi)=0$，并且有 $\\xi_2=0$，$\\xi_3=a$，我们得到\n$$\nN_2^1(\\xi) = \\frac{\\xi}{a}.\n$$\n\n所有其他的 $N_i^1(\\xi)$ 在 $[0,a)$ 上都为零。\n\n步骤3：通过 Cox–de Boor 公式得到二次基。对于二次基，\n$$\nN_i^2(\\xi) = \\frac{\\xi-\\xi_i}{\\xi_{i+2}-\\xi_i}N_i^1(\\xi) + \\frac{\\xi_{i+3}-\\xi}{\\xi_{i+3}-\\xi_{i+1}}N_{i+1}^1(\\xi),\n$$\n同样遵循分母为零的约定。\n\n计算在 $[0,a)$ 上的 $N_0^2(\\xi)$、$N_1^2(\\xi)$ 和 $N_2^2(\\xi)$：\n\n- 对于 $i=0$，\n$$\nN_0^2(\\xi) = \\frac{\\xi-\\xi_0}{\\xi_2-\\xi_0}N_0^1(\\xi) + \\frac{\\xi_3-\\xi}{\\xi_3-\\xi_1}N_1^1(\\xi).\n$$\n这里 $\\xi_0=\\xi_2=0$ 使得第一项为零，并且有 $\\xi_3=a$，$\\xi_1=0$，我们得到\n$$\nN_0^2(\\xi) = \\frac{a-\\xi}{a}\\,N_1^1(\\xi) = \\frac{a-\\xi}{a}\\cdot \\frac{a-\\xi}{a} = \\frac{(a-\\xi)^2}{a^2}.\n$$\n\n- 对于 $i=1$，\n$$\nN_1^2(\\xi) = \\frac{\\xi-\\xi_1}{\\xi_3-\\xi_1}N_1^1(\\xi) + \\frac{\\xi_4-\\xi}{\\xi_4-\\xi_2}N_2^1(\\xi).\n$$\n使用 $\\xi_1=0$，$\\xi_3=a$，$\\xi_4=1$，$\\xi_2=0$，以及步骤2中的表达式，\n$$\nN_1^2(\\xi) = \\frac{\\xi}{a}\\cdot \\frac{a-\\xi}{a} + (1-\\xi)\\cdot \\frac{\\xi}{a} = \\frac{\\xi(a-\\xi)}{a^2} + \\frac{\\xi(1-\\xi)}{a}.\n$$\n\n- 对于 $i=2$，\n$$\nN_2^2(\\xi) = \\frac{\\xi-\\xi_2}{\\xi_4-\\xi_2}N_2^1(\\xi) + \\frac{\\xi_5-\\xi}{\\xi_5-\\xi_3}N_3^1(\\xi).\n$$\n在 $[0,a)$ 上，$N_3^1(\\xi)=0$，并且有 $\\xi_2=0$，$\\xi_4=1$，\n$$\nN_2^2(\\xi) = \\xi \\cdot \\frac{\\xi}{a} = \\frac{\\xi^2}{a}.\n$$\n\n步骤4：重参数化到参考单元并用 Bernstein 基表示。令 $t=\\xi/a$，则 $\\xi = a t$ 且 $t\\in[0,1]$。代入：\n\n- $N_0^2(\\xi) = \\dfrac{(a-\\xi)^2}{a^2} = \\dfrac{(a-a t)^2}{a^2} = (1-t)^2 = B_0(t).$\n\n- $N_1^2(\\xi) = \\dfrac{\\xi(a-\\xi)}{a^2} + \\dfrac{\\xi(1-\\xi)}{a} = t(1-t) + t(1-a t) = 2t - (1+a)t^2.$\n\n- $N_2^2(\\xi) = \\dfrac{\\xi^2}{a} = \\dfrac{a^2 t^2}{a} = a\\,t^2 = a\\,B_2(t).$\n\n现在将 $N_1^2(\\xi)$ 用 Bernstein 基 $\\{B_0(t),(B_1(t),B_2(t)\\}$ 表示，其中\n$$\nB_0(t)=(1-t)^2=1-2t+t^2,\\quad B_1(t)=2t(1-t)=2t-2t^2,\\quad B_2(t)=t^2.\n$$\n寻找系数 $c_0,c_1,c_2$ 使得\n$$\nN_1^2(\\xi) = c_0 B_0(t) + c_1 B_1(t) + c_2 B_2(t).\n$$\n匹配 $t$ 的幂次系数。左侧是 $2t-(1+a)t^2$，其常数项为零，因此 $c_0=0$。$t$ 的系数给出 $2c_1 = 2$，所以 $c_1=1$。$t^2$ 的系数得出 $(-2)c_1 + c_2 = -(1+a)$，即 $-2 + c_2 = -(1+a)$，所以 $c_2 = 1 - a$。\n\n因此，在单元 $[0,a]$ 上我们有\n$$\n\\begin{aligned}\nN_0^2(\\xi) = 1\\cdot B_0(t) + 0\\cdot B_1(t) + 0\\cdot B_2(t),\\\\\nN_1^2(\\xi) = 0\\cdot B_0(t) + 1\\cdot B_1(t) + (1-a)\\cdot B_2(t),\\\\\nN_2^2(\\xi) = 0\\cdot B_0(t) + 0\\cdot B_1(t) + a\\cdot B_2(t).\n\\end{aligned}\n$$\n\n因此，满足\n$$\n\\begin{pmatrix}\nN_0^2(\\xi)\\\\\nN_1^2(\\xi)\\\\\nN_2^2(\\xi)\n\\end{pmatrix}\n= C^{e}\n\\begin{pmatrix}\nB_0(t)\\\\\nB_1(t)\\\\\nB_2(t)\n\\end{pmatrix}\n$$\n的贝塞尔提取矩阵 $C^{e}$ 是\n$$\nC^{e} =\n\\begin{pmatrix}\n1  0  0\\\\\n0  1  1-a\\\\\n0  0  a\n\\end{pmatrix}.\n$$\n\n这是一个上三角矩阵，所以它的行列式是其对角线元素的乘积：\n$$\n\\det(C^{e}) = 1 \\cdot 1 \\cdot a = a.\n$$\n\n因此，左单元 $[0,a]$ 的贝塞尔提取矩阵的行列式为 $a$。", "answer": "$$\\boxed{a}$$", "id": "2569829"}, {"introduction": "在掌握了基函数的定义之后，下一步是将其应用于求解物理问题。对于任何基于有限元或等几何分析的求解器，其核心步骤都是构建并求解一个代数方程组，其中刚度矩阵的计算至关重要。本练习要求您为一个简单的一维扩散问题计算刚度矩阵中的一个特定元素，这将锻炼您计算 B 样条导数并进行积分的基本技能 [@problem_id:2569885]。", "problem": "考虑物理域 $[0,1]$ 上标量扩散模型问题的一维等几何分析 (Isogeometric Analysis, IGA)。与有限元法 (Finite Element Method, FEM) 的等参概念一样，几何和分析使用相同的基。设几何映射为单位映射 $x(\\xi)=\\xi$，因此雅可比行列式为 $J(\\xi)=1$。基函数为次数 $p=2$ 的二次B样条基函数 (Basis splines, B-splines)，定义在开放节点矢量\n$$\n\\mathcal{U}=\\{0,0,0,\\tfrac{1}{2},1,1,1\\}\n$$\n上。\n设 $\\{N_{i,2}(\\xi)\\}_{i=0}^{3}$ 表示相应的B样条基，它由 Cox–de Boor 递推公式从分段常数函数\n$$\nN_{i,0}(\\xi)=\\begin{cases}\n1,  U_i \\le \\xi  U_{i+1},\\\\\n0,  \\text{其它情况},\n\\end{cases}\n$$\n开始构建，对于 $p\\ge 1$，\n$$\nN_{i,p}(\\xi)=\\frac{\\xi-U_i}{U_{i+p}-U_i}N_{i,p-1}(\\xi)+\\frac{U_{i+p+1}-\\xi}{U_{i+p+1}-U_{i+1}}N_{i+1,p-1}(\\xi),\n$$\n通常约定分母为零的项取为零。\n\n在 $[0,1]$ 上扩散算子弱形式的伽辽金离散化的刚度矩阵由下式给出\n$$\nK_{ij}=\\int_{0}^{1} \\frac{dN_{i,2}}{d\\xi}(\\xi)\\,\\frac{dN_{j,2}}{d\\xi}(\\xi)\\,d\\xi.\n$$\n仅使用上述定义以及B样条和弱形式的基本性质，确定单个元素 $K_{1,2}$ 的精确值，其中下标 $i=1$ 和 $j=2$ 指的是与 $\\mathcal{U}$ 相关联的第二个和第三个二次B样条基函数。\n\n请提供您的精确值答案。不要四舍五入。无需单位。", "solution": "在尝试求解之前，对所述问题进行验证。\n\n**步骤1：提取已知条件**\n- **域**：一维物理域 $[0,1]$。\n- **方法**：等几何分析 (IGA)。\n- **几何映射**：$x(\\xi)=\\xi$，这意味着雅可比行列式为 $J(\\xi)=1$。\n- **基函数**：二次B样条，次数 $p=2$。\n- **节点矢量**：$\\mathcal{U}=\\{0,0,0,\\frac{1}{2},1,1,1\\}$。这对应于节点 $U_0=0$, $U_1=0$, $U_2=0$, $U_3=\\frac{1}{2}$, $U_4=1$, $U_5=1$, $U_6=1$。\n- **B样条定义**：给出了 $p \\ge 1$ 的 Cox–de Boor 递推公式：\n$$\nN_{i,p}(\\xi)=\\frac{\\xi-U_i}{U_{i+p}-U_i}N_{i,p-1}(\\xi)+\\frac{U_{i+p+1}-\\xi}{U_{i+p+1}-U_{i+1}}N_{i+1,p-1}(\\xi)\n$$\n从 $p=0$ 开始：\n$$\nN_{i,0}(\\xi)=\\begin{cases}\n1,  U_i \\le \\xi  U_{i+1},\\\\\n0,  \\text{其它情况}。\n\\end{cases}\n$$\n- **刚度矩阵元素**：刚度矩阵的元素 $K_{ij}$ 定义为：\n$$\nK_{ij}=\\int_{0}^{1} \\frac{dN_{i,2}}{d\\xi}(\\xi)\\,\\frac{dN_{j,2}}{d\\xi}(\\xi)\\,d\\xi.\n$$\n- **目标**：确定 $K_{1,2}$ 的精确值。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题完全在等几何分析的标准数学框架内提出，等几何分析是有限元法的一个成熟的扩展。所有术语和定义（B样条、节点矢量、刚度矩阵）都是标准的。该问题在科学上是合理的。\n- **适定性**：该问题要求计算良定义函数的定积分。所有必要的信息都已提供。存在唯一且有意义的解。\n- **客观性**：问题陈述精确、量化，没有任何主观或模棱两可的语言。\n- **完整性和一致性**：问题是自包含的。次数、节点矢量和定义都已提供且一致。基函数的数量 $n = (\\text{节点数}) - p - 1 = 7-2-1=4$，下标从 $i=0$ 到 $3$，这与要求计算涉及下标 $i=1$ 和 $i=2$ 的元素是一致的。\n\n**步骤3：结论与行动**\n问题有效。将推导解答。\n\n任务是计算由以下积分给出的刚度矩阵元素 $K_{1,2}$：\n$$\nK_{1,2} = \\int_{0}^{1} \\frac{dN_{1,2}}{d\\xi}(\\xi)\\,\\frac{dN_{2,2}}{d\\xi}(\\xi)\\,d\\xi\n$$\nB样条基函数 $N_{i,p}(\\xi)$ 的导数由以下公式给出：\n$$\n\\frac{d}{d\\xi} N_{i,p}(\\xi) = p \\left( \\frac{N_{i,p-1}(\\xi)}{U_{i+p}-U_i} - \\frac{N_{i+1,p-1}(\\xi)}{U_{i+p+1}-U_{i+1}} \\right)\n$$\n我们需要 $N_{1,2}(\\xi)$ 和 $N_{2,2}(\\xi)$ 的导数。对于 $p=2$，该公式得出：\n对于 $i=1$：\n$$\n\\frac{dN_{1,2}}{d\\xi} = 2 \\left( \\frac{N_{1,1}(\\xi)}{U_3-U_1} - \\frac{N_{2,1}(\\xi)}{U_4-U_2} \\right) = 2 \\left( \\frac{N_{1,1}(\\xi)}{\\frac{1}{2}-0} - \\frac{N_{2,1}(\\xi)}{1-0} \\right) = 4N_{1,1}(\\xi) - 2N_{2,1}(\\xi)\n$$\n对于 $i=2$：\n$$\n\\frac{dN_{2,2}}{d\\xi} = 2 \\left( \\frac{N_{2,1}(\\xi)}{U_4-U_2} - \\frac{N_{3,1}(\\xi)}{U_5-U_3} \\right) = 2 \\left( \\frac{N_{2,1}(\\xi)}{1-0} - \\frac{N_{3,1}(\\xi)}{1-\\frac{1}{2}} \\right) = 2N_{2,1}(\\xi) - 4N_{3,1}(\\xi)\n$$\n为了继续，我们必须找到线性 ($p=1$) 基函数 $N_{1,1}(\\xi)$、$N_{2,1}(\\xi)$ 和 $N_{3,1}(\\xi)$ 的显式形式。我们使用 $p=1$ 的 Cox-de Boor 递推公式。\n\n对于 $N_{1,1}(\\xi)$：\n$N_{1,1}(\\xi) = \\frac{\\xi-U_1}{U_2-U_1}N_{1,0}(\\xi) + \\frac{U_3-\\xi}{U_3-U_2}N_{2,0}(\\xi)$。由于 $U_1=0, U_2=0, U_3=\\frac{1}{2}$，第一项分母为零，因此为零。\n$N_{1,1}(\\xi) = \\frac{\\frac{1}{2}-\\xi}{\\frac{1}{2}-0}N_{2,0}(\\xi) = (1-2\\xi)N_{2,0}(\\xi)$。因为 $N_{2,0}(\\xi)$ 在 $[0, \\frac{1}{2})$ 上为 $1$，其它地方为 $0$，所以我们有 $N_{1,1}(\\xi) = 1-2\\xi$ 对于 $\\xi \\in [0, \\frac{1}{2})$，其它地方为 $0$。\n\n对于 $N_{2,1}(\\xi)$：\n$N_{2,1}(\\xi) = \\frac{\\xi-U_2}{U_3-U_2}N_{2,0}(\\xi) + \\frac{U_4-\\xi}{U_4-U_3}N_{3,0}(\\xi)$。由于 $U_2=0, U_3=\\frac{1}{2}, U_4=1$，\n$N_{2,1}(\\xi) = \\frac{\\xi-0}{\\frac{1}{2}-0}N_{2,0}(\\xi) + \\frac{1-\\xi}{1-\\frac{1}{2}}N_{3,0}(\\xi) = 2\\xi N_{2,0}(\\xi) + 2(1-\\xi)N_{3,0}(\\xi)$。\n这给出 $N_{2,1}(\\xi) = 2\\xi$ 对于 $\\xi \\in [0, \\frac{1}{2})$，以及 $N_{2,1}(\\xi) = 2(1-\\xi)$ 对于 $\\xi \\in [\\frac{1}{2}, 1)$。\n\n对于 $N_{3,1}(\\xi)$：\n$N_{3,1}(\\xi) = \\frac{\\xi-U_3}{U_4-U_3}N_{3,0}(\\xi) + \\frac{U_5-\\xi}{U_5-U_4}N_{4,0}(\\xi)$。由于 $U_3=\\frac{1}{2}, U_4=1, U_5=1$，第二项为零。\n$N_{3,1}(\\xi) = \\frac{\\xi-\\frac{1}{2}}{1-\\frac{1}{2}}N_{3,0}(\\xi) = (2\\xi-1)N_{3,0}(\\xi)$。这给出 $N_{3,1}(\\xi) = 2\\xi-1$ 对于 $\\xi \\in [\\frac{1}{2}, 1)$，其它地方为 $0$。\n\n现在我们构造二次样条的导数。区域被内部节点分为两个区间：$[0, \\frac{1}{2}]$ 和 $[\\frac{1}{2}, 1]$。\n\n对于 $\\xi \\in [0, \\frac{1}{2})$：\n$$ \\frac{dN_{1,2}}{d\\xi} = 4(1-2\\xi) - 2(2\\xi) = 4 - 8\\xi - 4\\xi = 4 - 12\\xi $$\n$$ \\frac{dN_{2,2}}{d\\xi} = 2(2\\xi) - 4(0) = 4\\xi $$\n\n对于 $\\xi \\in (\\frac{1}{2}, 1]$：\n$$ \\frac{dN_{1,2}}{d\\xi} = 4(0) - 2(2(1-\\xi)) = -4(1-\\xi) = 4\\xi - 4 $$\n$$ \\frac{dN_{2,2}}{d\\xi} = 2(2(1-\\xi)) - 4(2\\xi-1) = 4-4\\xi - 8\\xi+4 = 8-12\\xi $$\n\n$K_{1,2}$ 的积分被分成两部分：\n$$\nK_{1,2} = \\int_{0}^{1/2} (4-12\\xi)(4\\xi) \\,d\\xi + \\int_{1/2}^{1} (4\\xi-4)(8-12\\xi) \\,d\\xi\n$$\n\n第一个积分：\n$$\n\\int_{0}^{1/2} (16\\xi - 48\\xi^2) \\,d\\xi = \\left[ 8\\xi^2 - 16\\xi^3 \\right]_{0}^{1/2} = \\left( 8\\left(\\frac{1}{2}\\right)^2 - 16\\left(\\frac{1}{2}\\right)^3 \\right) - (0) = 8\\left(\\frac{1}{4}\\right) - 16\\left(\\frac{1}{8}\\right) = 2 - 2 = 0\n$$\n\n第二个积分：\n$$\n\\int_{1/2}^{1} (4\\xi-4)(8-12\\xi) \\,d\\xi = \\int_{1/2}^{1} (32\\xi - 48\\xi^2 - 32 + 48\\xi) \\,d\\xi = \\int_{1/2}^{1} (-48\\xi^2 + 80\\xi - 32) \\,d\\xi\n$$\n$$\n= \\left[ -16\\xi^3 + 40\\xi^2 - 32\\xi \\right]_{1/2}^{1}\n$$\n在上限 $\\xi=1$ 处求值：\n$$ -16(1)^3 + 40(1)^2 - 32(1) = -16 + 40 - 32 = -8 $$\n在下限 $\\xi=\\frac{1}{2}$ 处求值：\n$$ -16\\left(\\frac{1}{2}\\right)^3 + 40\\left(\\frac{1}{2}\\right)^2 - 32\\left(\\frac{1}{2}\\right) = -16\\left(\\frac{1}{8}\\right) + 40\\left(\\frac{1}{4}\\right) - 16 = -2 + 10 - 16 = -8 $$\n第二个积分的值是差值：$(-8) - (-8) = 0$。\n\n积分的总值是各部分之和：\n$$\nK_{1,2} = 0 + 0 = 0\n$$\n结果是精确的。基函数 $N_{1,2}(\\xi)$ 和 $N_{2,2}(\\xi)$ 的导数在区间 $[0,1]$ 上关于标准 $L^2$ 内积是正交的。这是节点矢量 $\\mathcal{U}$ 关于点 $\\xi=\\frac{1}{2}$ 对称性的结果。这种对称性意味着 $N_{1,2}(1-\\xi) = N_{2,2}(\\xi)$，由此可得 $\\frac{d}{d\\xi}N_{2,2}(\\xi) = -\\frac{d}{d\\xi}N_{1,2}(1-\\xi)$。因此，被积函数关于定义域中心 $\\xi=\\frac{1}{2}$ 是一个奇函数，导致在对称定义域 $[0,1]$ 上的积分为零。我上面的计算直接证实了这一结果。\n关于被积函数在 $\\xi=1/2$ 附近为奇函数的断言是不精确的。令 $f(\\xi) = N'_{1,2}(\\xi)N'_{2,2}(\\xi)$。那么 $f(\\xi + 1/2)$ 在 $[-1/2, 1/2]$ 上是 $\\xi$ 的奇函数。然而，直接计算是充分的，并且不会出错。\n最终结果明确为零。", "answer": "$$\\boxed{0}$$", "id": "2569885"}, {"introduction": "与标准的有限元方法不同，等几何分析中使用的 B 样条基函数在边界上通常不具备插值性，这为强加本质边界条件带来了挑战。为了解决这个问题，我们可以采用 Nitsche 方法等弱施加技术，这在计算力学中是一种强大且灵活的工具。本高级练习将指导您使用 Nitsche 方法来处理非插值边界，并分析其数值稳定性，确保离散系统的数学性质（如正定性）得以维持 [@problem_id:2569894]。", "problem": "考虑物理域 $\\Omega = (a,b) = (0.5, 0.75)$ 上的一个一维稳态扩散问题，其控制方程为 $-u''(x) = 0$，并具有齐次狄利克雷边界条件 $u(a) = 0$ 和 $u(b) = 0$。使用基于次数 $p=2$ 的非有理B样条和一个非开放、均匀间隔的节点向量 $\\Xi = \\{0,\\, 0.25,\\, 0.5,\\, 0.75,\\, 1,\\, 1.25\\}$ 以及单位几何映射 $x(\\xi) = \\xi$ 构建的等几何分析(IGA)空间来离散化 $\\Omega$。在此参数化下，活动参数区间为 $[\\xi_{p+1}, \\xi_{n_k - p}] = [0.5, 0.75]$，与 $\\Omega$ 重合。由于端点重数是简单的（非夹持的），基函数在边界 $\\partial \\Omega$ 上是非插值的，因此无法通过控制变量来强施加本质边界条件。\n\n从标准弱形式出发，并使用 Nitsche 方法的对称形式来弱施加本质边界条件，推导出由以下各项组装而成的离散双线性形式：\n- 体积项 $\\int_{\\Omega} u'(x)\\,v'(x)\\,dx$，\n- 边界 $\\partial \\Omega$ 上的两个一致性边界项，\n- 以及带有罚参数 $\\gamma/h$ 的对称罚项，其中 $h = b - a$。\n\n使用 Cox–de Boor 递推公式求得在单个非零单元上的显式基函数，并精确计算所有需要的积分，以组装出作为 $\\gamma$ 函数的全局 $3 \\times 3$ 刚度矩阵。确定使所得离散双线性形式在离散空间上是强制的（等价于全局刚度矩阵是对称正定的）的最小 $\\gamma$ 值。以一个精确的、无单位的数给出最终答案。不需要四舍五入。", "solution": "所述问题在科学上是合理的、适定的，并包含了获得唯一解所需的所有信息。这是计算力学和等几何分析领域中的一个标准问题。因此，该问题是有效的，并且可以被求解。\n\n问题要求解对于一个一维扩散问题，使来自Nitsche方法的离散双线性形式是强制的最小罚参数 $\\gamma$ 值。这等价于找到使全局刚度矩阵是对称正定的最小 $\\gamma$ 值。\n\n该问题由在 $\\Omega = (a, b) = (0.5, 0.75)$ 上的 $-u''(x) = 0$ 控制，边界条件为齐次狄利克雷条件 $u(0.5) = u(0.75) = 0$。\n离散化使用了节点向量 $\\Xi = \\{0, 0.25, 0.5, 0.75, 1, 1.25\\}$ 上的二次B样条（$p=2$）。\n基函数的数量为 $n = n_k - p - 1 = 6 - 2 - 1 = 3$。设它们为 $N_1(x), N_2(x), N_3(x)$。\n物理域 $\\Omega = (0.5, 0.75)$ 对应于单个参数单元 $[\\xi_3, \\xi_4] = [0.5, 0.75]$，因为几何映射是单位映射，$x(\\xi)=\\xi$。单元长度为 $h = 0.75 - 0.5 = 0.25$。\n所有三个基函数（$N_1, N_2, N_3$）在该单元上都非零。\n\n首先，我们确定在区间 $[0.5, 0.75]$ 上基函数 $N_i(x)$ 及其导数 $N_i'(x)$ 的解析表达式。我们使用从参考区间 $\\eta \\in [0, 1]$ 到物理单元 $x \\in [0.5, 0.75]$ 的标准映射 $x = 0.5 + h\\eta = 0.5 + 0.25\\eta$。因此，$\\eta = (x - 0.5)/0.25 = 4x-2$。根据链式法则，有 $\\frac{d}{dx} = \\frac{d\\eta}{dx}\\frac{d}{d\\eta} = 4\\frac{d}{d\\eta}$。\n参考单元上的二次B样条基函数为：\n$$\n\\hat{N}_1(\\eta) = \\frac{1}{2}(1-\\eta)^2, \\quad \\hat{N}_2(\\eta) = \\frac{1}{2}(-2\\eta^2+2\\eta+1), \\quad \\hat{N}_3(\\eta) = \\frac{1}{2}\\eta^2\n$$\n限制在该单元上的全局基函数 $N_i(x)$ 为 $N_i(x) = \\hat{N}_i(\\eta(x))$：\n$N_1(x) = \\frac{1}{2}(1 - (4x-2))^2 = \\frac{1}{2}(3-4x)^2 = 8x^2 - 12x + 4.5$\n$N_2(x) = \\frac{1}{2}(-2(4x-2)^2 + 2(4x-2) + 1) = -16x^2 + 20x - 5.5$\n$N_3(x) = \\frac{1}{2}(4x-2)^2 = 8x^2 - 8x + 2$\n关于 $x$ 的导数为：\n$N_1'(x) = 16x - 12$\n$N_2'(x) = -32x + 20$\n$N_3'(x) = 16x - 8$\n\n该问题的对称Nitsche双线性形式为：\n$$\nB(u_h, v_h) = \\int_a^b u_h' v_h' dx - \\left( u_h'(b)v_h(b) - u_h'(a)v_h(a) \\right) - \\left( u_h(b)v_h'(b) - u_h(a)v_h'(a) \\right) + \\frac{\\gamma}{h}\\left( u_h(a)v_h(a) + u_h(b)v_h(b) \\right)\n$$\n全局刚度矩阵 $K$ 的元素为 $K_{ij} = B(N_j, N_i)$。我们在边界 $a=0.5$ 和 $b=0.75$ 处计算基函数及其导数的值：\n在 $x=a=0.5$ 处：\n$N_1(0.5)=0.5$, $N_2(0.5)=0.5$, $N_3(0.5)=0$\n$N_1'(0.5)=-4$, $N_2'(0.5)=4$, $N_3'(0.5)=0$\n在 $x=b=0.75$ 处：\n$N_1(0.75)=0$, $N_2(0.75)=0.5$, $N_3(0.75)=0.5$\n$N_1'(0.75)=0$, $N_2'(0.75)=-4$, $N_3'(0.75)=4$\n\n刚度矩阵 $K$ 是三个分量的和：$K = K_{vol} + K_{bound} + K_{pen}$。\n\n1.  体积项 $K_{vol}$，其元素为 $(K_{vol})_{ij} = \\int_{0.5}^{0.75} N_i' N_j' dx$。\n    使用参考单元，$(K_{vol})_{ij} = \\int_0^1 (4\\hat{N}_i'(\\eta))(4\\hat{N}_j'(\\eta)) (h d\\eta) = 16h \\int_0^1 \\hat{N}_i'\\hat{N}_j' d\\eta = 4 \\int_0^1 \\hat{N}_i'\\hat{N}_j' d\\eta$。\n    积分矩阵 $\\int_0^1 \\hat{N}_i'\\hat{N}_j' d\\eta$ 为 $\\frac{1}{6}\\begin{pmatrix} 2  -1  -1 \\\\ -1  2  -1 \\\\ -1  -1  2 \\end{pmatrix}$。\n    $$\n    K_{vol} = 4 \\cdot \\frac{1}{6} \\begin{pmatrix} 2  -1  -1 \\\\ -1  2  -1 \\\\ -1  -1  2 \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} 2  -1  -1 \\\\ -1  2  -1 \\\\ -1  -1  2 \\end{pmatrix} = \\begin{pmatrix} 4/3  -2/3  -2/3 \\\\ -2/3  4/3  -2/3 \\\\ -2/3  -2/3  4/3 \\end{pmatrix}\n    $$\n\n2.  边界项（一致性和伴随项）$K_{bound}$，其元素为 $(K_{bound})_{ij} = -(N_i(b)N_j'(b) - N_i(a)N_j'(a)) - (N_i'(b)N_j(b) - N_i'(a)N_j(a))$。\n    令 $\\mathbf{N}(x) = [N_1(x), N_2(x), N_3(x)]^T$。\n    $C = \\mathbf{N}(a)\\mathbf{N}'(a)^T = \\begin{pmatrix} 0.5 \\\\ 0.5 \\\\ 0 \\end{pmatrix} [-4, 4, 0] = \\begin{pmatrix} -2  2  0 \\\\ -2  2  0 \\\\ 0  0  0 \\end{pmatrix}$\n    $D = \\mathbf{N}(b)\\mathbf{N}'(b)^T = \\begin{pmatrix} 0 \\\\ 0.5 \\\\ 0.5 \\end{pmatrix} [0, -4, 4] = \\begin{pmatrix} 0  0  0 \\\\ 0  -2  2 \\\\ 0  -2  2 \\end{pmatrix}$\n    边界矩阵为 $-(D-C) - (D-C)^T$。\n    $D-C = \\begin{pmatrix} 2  -2  0 \\\\ 2  -4  2 \\\\ 0  -2  2 \\end{pmatrix}$\n    $$\n    K_{bound} = -\\begin{pmatrix} 2  -2  0 \\\\ 2  -4  2 \\\\ 0  -2  2 \\end{pmatrix} - \\begin{pmatrix} 2  2  0 \\\\ -2  -4  -2 \\\\ 0  2  2 \\end{pmatrix} = \\begin{pmatrix} -4  0  0 \\\\ 0  8  0 \\\\ 0  0  -4 \\end{pmatrix}\n    $$\n\n3.  罚项 $K_{pen}$，其元素为 $(K_{pen})_{ij} = \\frac{\\gamma}{h}(N_i(a)N_j(a) + N_i(b)N_j(b))$。已知 $h=0.25$，所以 $\\frac{\\gamma}{h} = 4\\gamma$。\n    $A = \\mathbf{N}(a)\\mathbf{N}(a)^T = \\begin{pmatrix} 0.25  0.25  0 \\\\ 0.25  0.25  0 \\\\ 0  0  0 \\end{pmatrix}$\n    $B = \\mathbf{N}(b)\\mathbf{N}(b)^T = \\begin{pmatrix} 0  0  0 \\\\ 0  0.25  0.25 \\\\ 0  0.25  0.25 \\end{pmatrix}$\n    $$\n    K_{pen} = 4\\gamma (A+B) = 4\\gamma \\begin{pmatrix} 0.25  0.25  0 \\\\ 0.25  0.5  0.25 \\\\ 0  0.25  0.25 \\end{pmatrix} = \\gamma \\begin{pmatrix} 1  1  0 \\\\ 1  2  1 \\\\ 0  1  1 \\end{pmatrix}\n    $$\n\n总刚度矩阵为 $K(\\gamma) = K_{vol} + K_{bound} + K_{pen}$：\n$$\nK(\\gamma) = \\begin{pmatrix} 4/3  -2/3  -2/3 \\\\ -2/3  4/3  -2/3 \\\\ -2/3  -2/3  4/3 \\end{pmatrix} + \\begin{pmatrix} -4  0  0 \\\\ 0  8  0 \\\\ 0  0  -4 \\end{pmatrix} + \\gamma \\begin{pmatrix} 1  1  0 \\\\ 1  2  1 \\\\ 0  1  1 \\end{pmatrix}\n$$\n$$\nK(\\gamma) = \\begin{pmatrix} -8/3+\\gamma   -2/3+\\gamma   -2/3 \\\\ -2/3+\\gamma   28/3+2\\gamma   -2/3+\\gamma \\\\ -2/3   -2/3+\\gamma   -8/3+\\gamma \\end{pmatrix}\n$$\n为了使双线性形式是强制的，$K(\\gamma)$ 必须是对称正定的。该矩阵由构造可知是对称的。根据 Sylvester 准则，所有顺序主子式必须为正。\n1.  第一个主子式 $M_1  0$：\n    $K_{11} = -8/3 + \\gamma  0 \\implies \\gamma  8/3$。\n\n2.  第二个主子式 $M_2  0$：\n    $\\det \\begin{pmatrix} -8/3+\\gamma   -2/3+\\gamma \\\\ -2/3+\\gamma   28/3+2\\gamma \\end{pmatrix}  0$\n    $(-8/3+\\gamma)(28/3+2\\gamma) - (-2/3+\\gamma)^2  0$\n    $(2\\gamma^2 + 4\\gamma - 224/9) - (\\gamma^2 - 4/3\\gamma + 4/9)  0$\n    $\\gamma^2 + \\frac{16}{3}\\gamma - \\frac{228}{9}  0 \\implies 3\\gamma^2 + 16\\gamma - 76  0$。\n    $3y^2+16y-76=0$ 的根是 $y = \\frac{-16 \\pm \\sqrt{16^2 - 4(3)(-76)}}{6} = \\frac{-16 \\pm \\sqrt{256+912}}{6} = \\frac{-16 \\pm \\sqrt{1168}}{6} = \\frac{-16 \\pm 4\\sqrt{73}}{6} = \\frac{-8 \\pm 2\\sqrt{73}}{3}$。\n    因为我们需要 $\\gamma0$，所以条件是 $\\gamma  \\frac{-8 + 2\\sqrt{73}}{3}$。由于 $8  \\sqrt{73}  9$，这个值是正的。$\\frac{-8+2(8.54)}{3} \\approx 3.03$。这比 $\\gamma  8/3 \\approx 2.67$ 更严格。\n\n3.  第三个主子式 $M_3 = \\det(K)  0$。\n    令 $K' = 3K$。$\\det(K) = (1/27)\\det(K')$。我们需要 $\\det(K')0$。\n    $$K' = \\begin{pmatrix} -8+3\\gamma   -2+3\\gamma   -2 \\\\ -2+3\\gamma   28+6\\gamma   -2+3\\gamma \\\\ -2   -2+3\\gamma   -8+3\\gamma \\end{pmatrix}$$\n    由于矩阵的结构（$K'_{11}=K'_{33}$，$K'_{12}=K'_{23}=K'_{32}=K'_{21}$），行列式的计算得以简化：\n    $\\det(K') = (K'_{11}-K'_{13})[(K'_{11}+K'_{13})K'_{22} - 2(K'_{12})^2]$\n    $K'_{11}-K'_{13} = (-8+3\\gamma) - (-2) = 3\\gamma-6 = 3(\\gamma-2)$。\n    $K'_{11}+K'_{13} = (-8+3\\gamma) + (-2) = 3\\gamma-10$。\n    $(K'_{11}+K'_{13})K'_{22} - 2(K'_{12})^2 = (3\\gamma-10)(28+6\\gamma) - 2(-2+3\\gamma)^2$\n    $= (18\\gamma^2 + 24\\gamma - 280) - 2(9\\gamma^2 - 12\\gamma + 4)$\n    $= (18\\gamma^2 + 24\\gamma - 280) - (18\\gamma^2 - 24\\gamma + 8) = 48\\gamma - 288 = 48(\\gamma-6)$。\n    所以，$\\det(K') = 3(\\gamma-2) \\cdot 48(\\gamma-6) = 144(\\gamma-2)(\\gamma-6)$。\n    条件 $\\det(K)  0$ 要求 $(\\gamma-2)(\\gamma-6)  0$，这意味着 $\\gamma  6$ 或 $\\gamma  2$。\n\n综合所有条件：\n(1) $\\gamma  8/3 \\approx 2.67$\n(2) $\\gamma  \\frac{-8 + 2\\sqrt{73}}{3} \\approx 3.03$\n(3) $\\gamma  6$ 或 $\\gamma  2$\n\n这些条件的交集是 $\\gamma  6$。使双线性形式是强制的 $\\gamma$ 值的集合是 $(6, \\infty)$。问题要求的是使此条件成立的最小 $\\gamma$ 值。这对应于该集合的下确界。\n\n因此，最小值为 $6$。当 $\\gamma=6$ 时，矩阵是半正定的，但不是正定的，因为其行列式为零。对于任何 $\\gamma  6$，矩阵是严格正定的。", "answer": "$$\\boxed{6}$$", "id": "2569894"}]}