{"hands_on_practices": [{"introduction": "在构建间断Galerkin (DG) 求解器时，我们首先要决定如何在每个单元上表示解。像勒让德多项式这样的模态基函数具有优异的数学特性（如正交性），然而，节点基函数在某些操作中更为直观和方便，例如在单元边界处计算通量。本练习 [@problem_id:2552249] 将引导您完成在这两种关键表示之间进行转换的基本过程，并构建构成任何有限元代码核心的单元质量和刚度矩阵。", "problem": "考虑一个间断 Galerkin 有限元方法的参考单元，该单元位于区间 $[-1,1]$ 上，多项式次数为 $p=2$。设模态基为区间 $[-1,1]$ 上的前三个 Legendre 多项式，即 $P_{0}(x)$、$P_{1}(x)$ 和 $P_{2}(x)$，其中 $P_{0}(x)=1$，$P_{1}(x)=x$，$P_{2}(x)=(3x^{2}-1)/2$。单元上的模态质量矩阵和刚度矩阵由以下双线性形式定义：\n$$\n(M_{\\mathrm{modal}})_{ij}=\\int_{-1}^{1} P_{i}(x)\\,P_{j}(x)\\,dx,\\qquad (K_{\\mathrm{modal}})_{ij}=\\int_{-1}^{1} P_{i}'(x)\\,P_{j}'(x)\\,dx,\n$$\n其中 $i,j\\in\\{0,1,2\\}$。引入与 Legendre–Gauss–Lobatto 点 $x_{1}=-1$、$x_{2}=0$、$x_{3}=1$ 相关联的节点基，并定义 Vandermonde 矩阵 $V\\in\\mathbb{R}^{3\\times 3}$，其元素为 $V_{i j}=P_{j-1}(x_{i})$，其中 $i,j\\in\\{1,2,3\\}$，使得节点值向量等于 $V$ 乘以模态系数向量。仅使用 Legendre 多项式的基本性质和上述定义，构建 $M_{\\mathrm{modal}}$ 和 $K_{\\mathrm{modal}}$，然后将它们变换到节点基以获得 $M_{\\mathrm{nodal}}$ 和 $K_{\\mathrm{nodal}}$。最后，计算节点质量矩阵 $M_{\\mathrm{nodal}}$ 的行列式，并将最终结果表示为最简分数。最终答案仅提供该行列式，不进行四舍五入。", "solution": "我们在参考区间 $[-1,1]$ 上进行计算，多项式次数为 $p=2$。模态基由 $P_{0}(x)=1$、$P_{1}(x)=x$ 和 $P_{2}(x)=(3x^{2}-1)/2$ 组成。模态质量矩阵和刚度矩阵定义为\n$$\n(M_{\\mathrm{modal}})_{ij}=\\int_{-1}^{1} P_{i}(x)\\,P_{j}(x)\\,dx,\\qquad (K_{\\mathrm{modal}})_{ij}=\\int_{-1}^{1} P_{i}'(x)\\,P_{j}'(x)\\,dx,\\quad i,j\\in\\{0,1,2\\}.\n$$\n我们从 Legendre 多项式的基本性质开始。它们在 $[-1,1]$ 上关于单位权重是正交的，即：\n$$\n\\int_{-1}^{1} P_{n}(x)\\,P_{m}(x)\\,dx=\\frac{2}{2n+1}\\,\\delta_{nm},\n$$\n其中 $\\delta_{nm}$ 是 Kronecker delta。对于 $n\\in\\{0,1,2\\}$，这得到\n$$\n\\int_{-1}^{1} P_{0}^{2}(x)\\,dx=2,\\qquad \\int_{-1}^{1} P_{1}^{2}(x)\\,dx=\\frac{2}{3},\\qquad \\int_{-1}^{1} P_{2}^{2}(x)\\,dx=\\frac{2}{5},\n$$\n且当 $i\\neq j$ 时，$\\int_{-1}^{1} P_{i}(x)\\,P_{j}(x)\\,dx=0$。因此，\n$$\nM_{\\mathrm{modal}}=\\mathrm{diag}\\!\\left(2,\\frac{2}{3},\\frac{2}{5}\\right).\n$$\n对于刚度矩阵，我们使用 $P_{0}'(x)=0$、$P_{1}'(x)=1$ 和 $P_{2}'(x)=3x$。因此，\n$$\n(K_{\\mathrm{modal}})_{00}=\\int_{-1}^{1} 0\\cdot 0\\,dx=0,\\quad (K_{\\mathrm{modal}})_{01}=\\int_{-1}^{1} 0\\cdot 1\\,dx=0,\\quad (K_{\\mathrm{modal}})_{02}=\\int_{-1}^{1} 0\\cdot 3x\\,dx=0,\n$$\n$$\n(K_{\\mathrm{modal}})_{11}=\\int_{-1}^{1} 1\\cdot 1\\,dx=2,\\quad (K_{\\mathrm{modal}})_{12}=\\int_{-1}^{1} 1\\cdot 3x\\,dx=3\\int_{-1}^{1} x\\,dx=0,\n$$\n$$\n(K_{\\mathrm{modal}})_{22}=\\int_{-1}^{1} (3x)\\,(3x)\\,dx=9\\int_{-1}^{1} x^{2}\\,dx=9\\cdot\\frac{2}{3}=6.\n$$\n根据对称性，$(K_{\\mathrm{modal}})_{ij}=(K_{\\mathrm{modal}})_{ji}$。汇总这些结果，我们得到\n$$\nK_{\\mathrm{modal}}=\\mathrm{diag}\\!\\left(0,2,6\\right).\n$$\n接下来，我们定义与 Legendre–Gauss–Lobatto 点 $x_{1}=-1$、$x_{2}=0$、$x_{3}=1$ 相关联的节点基。Vandermonde 矩阵 $V\\in\\mathbb{R}^{3\\times 3}$ 定义为 $V_{i j}=P_{j-1}(x_{i})$，其中 $i,j\\in\\{1,2,3\\}$。在节点处计算多项式的值，得到\n$$\nP_{0}(-1)=1,\\quad P_{1}(-1)=-1,\\quad P_{2}(-1)=1;\n$$\n$$\nP_{0}(0)=1,\\quad P_{1}(0)=0,\\quad P_{2}(0)=-\\frac{1}{2};\n$$\n$$\nP_{0}(1)=1,\\quad P_{1}(1)=1,\\quad P_{2}(1)=1.\n$$\n因此，\n$$\nV=\\begin{pmatrix}\n1  -1  1\\\\\n1  0  -\\frac{1}{2}\\\\\n1  1  1\n\\end{pmatrix}.\n$$\n设模态系数向量为 $a\\in\\mathbb{R}^{3}$，节点值向量为 $u\\in\\mathbb{R}^{3}$。根据构造，有 $u=V\\,a$。因此 $a=V^{-1}u$。对于节点向量分别为 $u$ 和 $v$ 的任意两个函数，质量双线性形式满足\n$$\nu^{\\top} M_{\\mathrm{nodal}} v = a^{\\top} M_{\\mathrm{modal}} b = (V^{-1}u)^{\\top}M_{\\mathrm{modal}}(V^{-1}v)=u^{\\top}\\left(V^{-\\top}M_{\\mathrm{modal}}V^{-1}\\right)v.\n$$\n因此，\n$$\nM_{\\mathrm{nodal}}=V^{-\\top}M_{\\mathrm{modal}}V^{-1},\\qquad K_{\\mathrm{nodal}}=V^{-\\top}K_{\\mathrm{modal}}V^{-1}.\n$$\n我们通过求解 $V a=u$ 来显式计算 $V^{-1}$。使用 $x_{1}=-1$、$x_{2}=0$、$x_{3}=1$，将方程按分量写出，\n$$\na_{0}-a_{1}+a_{2}=u_{1},\\qquad a_{0}-\\frac{1}{2}a_{2}=u_{2},\\qquad a_{0}+a_{1}+a_{2}=u_{3}.\n$$\n将第一个和第三个方程相加得到 $a_{0}+a_{2}=(u_{1}+u_{3})/2$，将第三个方程减去第一个方程得到 $a_{1}=(u_{3}-u_{1})/2$，并与第二个方程联立，得到\n$$\na_{2}=\\frac{1}{3}\\left(u_{1}-2u_{2}+u_{3}\\right),\\qquad a_{0}=\\frac{1}{6}\\left(u_{1}+4u_{2}+u_{3}\\right).\n$$\n因此，\n$$\nV^{-1}=\n\\begin{pmatrix}\n\\frac{1}{6}  \\frac{2}{3}  \\frac{1}{6} \\\\\n-\\frac{1}{2}  0  \\frac{1}{2} \\\\\n\\frac{1}{3}  -\\frac{2}{3}  \\frac{1}{3}\n\\end{pmatrix}.\n$$\n设 $W=V^{-1}$，并注意到 $M_{\\mathrm{modal}}=\\mathrm{diag}(2,2/3,2/5)$。那么\n$$\nM_{\\mathrm{nodal}}=W^{\\top}M_{\\mathrm{modal}}W=\\sum_{j=0}^{2} m_{j}\\,r_{j}^{\\top}r_{j},\n$$\n其中 $m_{0}=2$，$m_{1}=2/3$，$m_{2}=2/5$，而 $r_{j}$ 是 $W$ 的第 $j$ 行。已知\n$$\nr_{0}=\\left(\\frac{1}{6},\\frac{2}{3},\\frac{1}{6}\\right),\\quad r_{1}=\\left(-\\frac{1}{2},0,\\frac{1}{2}\\right),\\quad r_{2}=\\left(\\frac{1}{3},-\\frac{2}{3},\\frac{1}{3}\\right),\n$$\n外积和为\n$$\nM_{\\mathrm{nodal}}=\n\\begin{pmatrix}\n\\frac{4}{15}  \\frac{2}{15}  -\\frac{1}{15} \\\\\n\\frac{2}{15}  \\frac{16}{15}  \\frac{2}{15} \\\\\n-\\frac{1}{15}  \\frac{2}{15}  \\frac{4}{15}\n\\end{pmatrix}.\n$$\n为完整起见，对 $K_{\\mathrm{modal}}=\\mathrm{diag}(0,2,6)$ 进行类似的计算可得\n$$\nK_{\\mathrm{nodal}}=\n\\begin{pmatrix}\n\\frac{7}{6}  -\\frac{4}{3}  \\frac{1}{6} \\\\\n-\\frac{4}{3}  \\frac{8}{3}  -\\frac{4}{3} \\\\\n\\frac{1}{6}  -\\frac{4}{3}  \\frac{7}{6}\n\\end{pmatrix}.\n$$\n我们现在计算 $M_{\\mathrm{nodal}}$ 的行列式。为方便计算，可以先提取公分母。定义\n$$\nN=15\\,M_{\\mathrm{nodal}}=\n\\begin{pmatrix}\n4  2  -1\\\\\n2  16  2\\\\\n-1  2  4\n\\end{pmatrix},\n$$\n使得 $\\det(M_{\\mathrm{nodal}})=\\det(N)/15^{3}$。对 $N$ 的行列式进行展开，\n$$\n\\det(N)=4\\begin{vmatrix}16  2\\\\ 2  4\\end{vmatrix}-2\\begin{vmatrix}2  2\\\\ -1  4\\end{vmatrix}-1\\begin{vmatrix}2  16\\\\ -1  2\\end{vmatrix}=4(64-4)-2(8+2)-(4+16)=240-20-20=200.\n$$\n因此，\n$$\n\\det(M_{\\mathrm{nodal}})=\\frac{200}{15^{3}}=\\frac{200}{3375}=\\frac{8}{135}.\n$$\n该分数为最简分数，因此节点质量矩阵的行列式为 $\\frac{8}{135}$。", "answer": "$$\\boxed{\\frac{8}{135}}$$", "id": "2552249"}, {"introduction": "间断Galerkin方法的一个关键特征是通过弱形式灵活地处理边界条件。对称内部罚分Galerkin (SIPG) 等方法不是强制解在边界上精确匹配给定数据，而是在变分公式中添加额外的项，以惩罚解与期望边界值之间的偏差。通过此练习 [@problem_id:2552258]，您将推导狄利克雷边界数据对系统右侧向量的具体贡献，从而具体理解弱边界条件在实践中是如何施加的。", "problem": "考虑在开区间 $(0,1)$ 上的一维泊松问题 $-u''(x) = 0$，其狄利克雷边界数据为 $u(0)=0$ 和 $u(1)=1$。设该区域被划分为两个单元 $K_{1} = (0, \\tfrac{1}{2})$ 和 $K_{2} = (\\tfrac{1}{2}, 1)$，并设试探空间和检验空间为该网格上次数 $p=1$ 的不连续分片多项式函数。使用对称内部罚分Galerkin (SIPG) 方法，其中狄利克雷边界数据通过与 SIPG 一致的对称 Nitsche 方法弱施加。假设单位扩散系数 $a(x) \\equiv 1$。设在 $x=0$ 处的单位外法向量为 $n(0)=-1$，在 $x=1$ 处的单位外法向量为 $n(1)=+1$。在边界面上，使用罚参数 $\\sigma_{F} = \\dfrac{2}{h_{F}}$，其中 $h_{F}$ 是与该边界面相邻的单元长度。\n\n在每个单元 $K=[x_{L},x_{R}]$ 上，使用标准线性基 $\\{\\phi_{1},\\phi_{2}\\}$，满足 $\\phi_{1}(x_{L})=1$, $\\phi_{1}(x_{R})=0$, $\\phi_{2}(x_{L})=0$, $\\phi_{2}(x_{R})=1$，以及常数导数 $\\phi_{1}'=-\\dfrac{1}{h}$, $\\phi_{2}'=\\dfrac{1}{h}$，其中 $h=x_{R}-x_{L}$。将全局自由度按自然的局部到全局排序记为\n$[\\phi_{1}^{(1)}, \\phi_{2}^{(1)}, \\phi_{1}^{(2)}, \\phi_{2}^{(2)}]$，其中上标表示单元编号。\n\n从通过分部积分得到的逐单元弱形式以及 SIPG 框架中边界处的一致性和对称性要求出发，推导由 $x=0$ 和 $x=1$ 处的狄利克雷数据产生的对右端向量的边界贡献。然后，根据给定的数据和网格显式计算这些贡献，并将它们按照 $[\\phi_{1}^{(1)}, \\phi_{2}^{(1)}, \\phi_{1}^{(2)}, \\phi_{2}^{(2)}]$ 的顺序组装成全局右端向量（仅含边界项）。\n\n以单行矩阵的形式提供你的最终答案。无需四舍五入。", "solution": "该问题陈述具有科学依据、是适定且客观的。它展示了将带有 Nitsche 边界条件的对称内部罚分Galerkin (SIPG) 方法应用于一维泊松问题的标准应用。所有必要的数据和定义均已提供。因此，该问题是有效的，将提供解答。\n\n问题是求解在区域 $\\Omega = (0,1)$ 上，使用不连续分片线性基函数时，一维泊松方程 $-u''(x) = 0$ 的右端 (RHS) 向量的边界贡献。指定的方法是对称内部罚分Galerkin (SIPG) 方法，其中狄利克雷边界条件 $u(0)=g_0=0$ 和 $u(1)=g_1=1$ 使用 Nitsche 方法弱施加。\n\n我们从单个单元 $K$ 上的方程弱形式开始。对于检验函数 $v \\in V_h$，我们有：\n$$ -\\int_K u'' v \\, dx = \\int_K 0 \\cdot v \\, dx = 0 $$\n一次分部积分可得：\n$$ \\int_K u' v' \\, dx - [u' v]_{\\partial K} = 0 $$\n对网格 $\\mathcal{T}_h$ 中的所有单元 $K$ 求和，并使用扩散系数 $a(x)=1$：\n$$ \\sum_{K \\in \\mathcal{T}_h} \\int_K u' v' \\, dx - \\sum_{K \\in \\mathcal{T}_h} [u' v]_{\\partial K} = 0 $$\nSIPG 方法修改了此公式，以处理单元交界面处的不连续性并施加边界条件。由此产生的全局问题是找到 $u_h \\in V_h$，使得对于所有 $v_h \\in V_h$：\n$$ B_h(u_h, v_h) = L_h(v_h) $$\n包含已知狄利克雷数据 $g_D$ 的项被移到右侧，形成线性泛函 $L_h(v_h)$。任务是找出由边界面产生的对 $L_h(v_h)$ 的贡献。\n\n对于与 SIPG 一致的对称 Nitsche 公式，源于狄利克雷边界面 $F \\in \\mathcal{F}_D$ 的项是通过考虑内部项、罚项和对称项导出的，但“外部”解值取为狄利克雷数据 $g_D$。单个边界面 $F$ 对 RHS 的贡献结果为：\n$$ L_F(v_h) = \\int_F \\sigma_F g_D v_h \\, dS - \\int_F (a \\nabla v_h \\cdot n) g_D \\, dS $$\n此处，$n$ 是区域 $\\Omega$ 的单位外法向量，$\\sigma_F$ 是罚参数，$g_D$ 是在面 $F$ 上指定的狄利克雷值。\n\n对 RHS 向量的总边界贡献是所有狄利克雷面的总和：\n$$ L^{bnd}(v_h) = \\sum_{F \\in \\mathcal{F}_D} \\left( \\int_F \\sigma_F g_D v_h \\, dS - \\int_F (a \\nabla v_h \\cdot n) g_D \\, dS \\right) $$\n在我们的一维情况下，区域是 $\\Omega=(0,1)$，在面 $F$（这是一个点）上的积分简化为在该点求值。\n\n边界面位于 $x=0$ 和 $x=1$。\n情况1：$x=0$ 处的面。\n狄利克雷数据为 $g_D = u(0) = 0$。\n因此对 RHS 的贡献为：\n$$ L_{x=0}(v_h) = (\\sigma_F g_D v_h)|_{x=0} - (a v_h' n g_D)|_{x=0} = (\\sigma_F \\cdot 0 \\cdot v_h(0)) - (1 \\cdot v_h'(0) \\cdot (-1) \\cdot 0) = 0 $$\n对于任何检验函数 $v_h$，$x=0$ 处边界的贡献为零。\n\n情况2：$x=1$ 处的面。\n狄利克雷数据为 $g_D = u(1) = 1$。\n单位外法向量为 $n = +1$。\n扩散系数为 $a=1$。\n$x=1$ 处的面与单元 $K_2 = (1/2, 1)$ 相邻，其长度为 $h_2 = 1 - 1/2 = 1/2$。\n罚参数由 $\\sigma_F = 2/h_F = 2/(1/2) = 4$ 给出。\n$x=1$ 处的面对 RHS 的贡献为：\n$$ L_{x=1}(v_h) = (\\sigma_F g_D v_h)|_{x=1} - (a v_h' n g_D)|_{x=1} $$\n$$ L_{x=1}(v_h) = (4 \\cdot 1 \\cdot v_h(1)) - (1 \\cdot v_h'(1) \\cdot 1 \\cdot 1) = 4 v_h(1) - v_h'(1) $$\n这是 RHS 向量边界贡献的唯一非零来源。\n\n我们现在为每个全局基函数 $v_h \\in \\{\\phi_{1}^{(1)}, \\phi_{2}^{(1)}, \\phi_{1}^{(2)}, \\phi_{2}^{(2)}\\}$ 计算这个表达式的值，以组装边界贡献向量，我们将其记为 $\\mathbf{b}^{bnd}$。\n\n1.  用 $v_h = \\phi_1^{(1)}$ 检验。此基函数仅在单元 $K_1 = (0, 1/2)$ 上有支撑。因此，$\\phi_1^{(1)}(1) = 0$ 且 $\\phi_1^{(1)'}(1) = 0$。\n    贡献为 $\\mathbf{b}^{bnd}_1 = 4(0) - 0 = 0$。\n\n2.  用 $v_h = \\phi_2^{(1)}$ 检验。此基函数也仅在单元 $K_1$ 上有支撑。因此，$\\phi_2^{(1)}(1) = 0$ 且 $\\phi_2^{(1)'}(1) = 0$。\n    贡献为 $\\mathbf{b}^{bnd}_2 = 4(0) - 0 = 0$。\n\n3.  用 $v_h = \\phi_1^{(2)}$ 检验。此基函数在单元 $K_2 = (1/2, 1)$ 上有支撑。这里，$x_L=1/2$，$x_R=1$，单元长度 $h_2=1/2$。\n    根据定义，$\\phi_1^{(2)}(x_L) = \\phi_1^{(2)}(1/2) = 1$ 且 $\\phi_1^{(2)}(x_R) = \\phi_1^{(2)}(1) = 0$。\n    导数是常数：$\\phi_1^{(2)'}(x) = -1/h_2 = -1/(1/2) = -2$。\n    贡献为：\n    $$ \\mathbf{b}^{bnd}_3 = 4 \\phi_1^{(2)}(1) - \\phi_1^{(2)'}(1) = 4(0) - (-2) = 2 $$\n\n4.  用 $v_h = \\phi_2^{(2)}$ 检验。此基函数在单元 $K_2 = (1/2, 1)$ 上有支撑。\n    根据定义，$\\phi_2^{(2)}(x_L) = \\phi_2^{(2)}(1/2) = 0$ 且 $\\phi_2^{(2)}(x_R) = \\phi_2^{(2)}(1) = 1$。\n    导数是常数：$\\phi_2^{(2)'}(x) = 1/h_2 = 1/(1/2) = 2$。\n    贡献为：\n    $$ \\mathbf{b}^{bnd}_4 = 4 \\phi_2^{(2)}(1) - \\phi_2^{(2)'}(1) = 4(1) - (2) = 2 $$\n\n将这些分量按指定的顺序组装到全局右端向量（仅含边界项）中，即可得到最终结果。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0  0  2  2 \\end{pmatrix}}\n$$", "id": "2552258"}, {"introduction": "当将间断Galerkin方法应用于像平流方程这样的时间相关问题时，空间离散化的选择直接影响时间积分的稳定性。DG空间离散化将偏微分方程 (PDE) 转化为一个大型常微分方程 (ODEs) 系统，形式为 $\\dot{\\mathbf{u}} = \\mathbf{A}\\mathbf{u}$。显式时间步进格式（如前向欧拉法）的稳定性取决于系统矩阵 $\\mathbf{A}$ 的特征值。本练习 [@problem_id:2552265] 将指导您为一个简单的平流问题组装系统矩阵，然后通过特征值分析确定最大稳定时间步长，这是开发稳健的波动现象模拟所需的一项关键技能。", "problem": "考虑无量纲一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，定义在周期性域 $[0,2h]$ 上，其中 $a0$ 为常数平流速度，$h0$ 为单元长度。用2个等长为 $h$ 的单元组成的网格离散该域，并在每个单元上使用由参考区间 $[-1,1]$ 上的节点基生成的 $p=1$ 次间断 Galerkin 有限元空间，其局部基函数为 $\\varphi_{1}(\\xi) = \\frac{1-\\xi}{2}$ 和 $\\varphi_{2}(\\xi) = \\frac{1+\\xi}{2}$。使用标准（一次分部积分）的间断 Galerkin 弱形式，并采用与 $a0$ 和周期性边界条件一致的迎风数值通量。\n\n1. 从每个单元上的弱形式出发，组装半离散系统 $\\dot{\\mathbf{u}} = \\mathbf{A}\\,\\mathbf{u}$，其中全局自由度向量按 $\\mathbf{u} = \\big(u_{1,L},\\,u_{1,R},\\,u_{2,L},\\,u_{2,R}\\big)^{\\top}$ 的顺序列出，分别收集了单元1和单元2上的左右节点值。显式计算 $4\\times 4$ 矩阵 $\\mathbf{A}$，用 $a$ 和 $h$ 表示。\n\n2. 使用 $\\mathbf{A}$ 的特征值分析和已知的前向欧拉时间积分器的稳定域（即满足 $\\lvert 1 + z\\rvert \\le 1$ 的复数 $z$ 的集合），确定使得应用于 $\\dot{\\mathbf{u}} = \\mathbf{A}\\,\\mathbf{u}$ 的前向欧拉方法稳定的最大稳定时间步长 $\\Delta t_{\\max}$。将最终答案表示为含 $a$ 和 $h$ 的精确符号表达式。所有量均为无量纲。答案中不包含单位。", "solution": "所提出的问题是使用间断 Galerkin (DG) 有限元法进行偏微分方程数值分析的一个标准练习。它具有科学依据，是适定的、客观的，并包含了唯一解所需的所有必要信息。因此，该问题是有效的，我将着手解决它。\n\n该问题要求为线性平流方程组装一个半离散系统，然后对前向欧拉时间积分方案进行稳定性分析。\n\n一维线性平流方程由下式给出：\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\n在周期性域 $[0, 2h]$ 上，其中 $a  0$ 且 $h  0$。该域被离散为两个单元，$K_1 = [0, h]$ 和 $K_2 = [h, 2h]$。在每个单元 $K_j$ 上，解 $u_h$ 由一个 $p=1$ 次的多项式近似。\n\n在单元 $K_j = [x_{j-1/2}, x_{j+1/2}]$ 上的 DG 弱形式是通过将偏微分方程乘以一个测试函数 $v_h$ 并在 $K_j$ 上积分得到的：\n$$\n\\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\, dx + \\int_{K_j} a \\frac{\\partial u_h}{\\partial x} v_h \\, dx = 0\n$$\n对第二项进行分部积分可得：\n$$\n\\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\, dx - \\int_{K_j} a u_h \\frac{\\partial v_h}{\\partial x} \\, dx + [a u_h v_h]_{x_{j-1/2}}^{x_{j+1/2}} = 0\n$$\n边界项被数值通量 $\\hat{f}(u_h) = a \\hat{u}_h$ 替代：\n$$\n\\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\, dx = \\int_{K_j} a u_h \\frac{\\partial v_h}{\\partial x} \\, dx - \\left( a \\hat{u}_h(x_{j+1/2}) v_h(x_{j+1/2}^-) - a \\hat{u}_h(x_{j-1/2}) v_h(x_{j-1/2}^+) \\right)\n$$\n其中 $v_h(x^\\pm)$ 表示 $v_h$ 从单元内部/外部的极限。由于 $v_h$ 与 $u_h$ 在单元 $K_j$ 上取自同一空间，我们考虑其内部值，因此我们有 $v_h(x_{j-1/2}^+)$ 和 $v_h(x_{j+1/2}^-)$。对于 $a0$，迎风通量由界面左侧（迎风侧）的值定义，即 $\\hat{u}_h(x) = u_h(x^-)$。\n在单元 $K_j$ 的右边界 $x_{j+1/2}$ 处，迎风值为 $u_h(x_{j+1/2}^-)$。\n在单元 $K_j$ 的左边界 $x_{j-1/2}$ 处，迎风值取自左侧相邻单元 $K_{j-1}$ 的右边界，即 $u_h(x_{j-1/2}^-)$。\n弱形式变为：\n$$\n\\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\, dx = \\int_{K_j} a u_h \\frac{\\partial v_h}{\\partial x} \\, dx - a u_h(x_{j+1/2}^-) v_h(x_{j+1/2}^-) + a u_h(x_{j-1/2}^-) v_h(x_{j-1/2}^+)\n$$\n在每个单元 $K_j$ 上，解在局部节点基中展开：$u_h(x, t) = u_{j,L}(t) \\phi_{j,1}(x) + u_{j,R}(t) \\phi_{j,2}(x)$。为了计算，我们使用 $x(\\xi) = x_{j,c} + \\frac{h}{2}\\xi$ 将每个物理单元 $K_j$ 映射到参考单元 $\\hat{K} = [-1, 1]$，其中 $x_{j,c}$ 是单元的中心。这得到 $dx = \\frac{h}{2}d\\xi$ 和 $\\frac{d}{dx} = \\frac{2}{h}\\frac{d}{d\\xi}$。参考单元上的基函数为 $\\varphi_1(\\xi) = \\frac{1-\\xi}{2}$ 和 $\\varphi_2(\\xi) = \\frac{1+\\xi}{2}$，其导数为 $\\frac{d\\varphi_1}{d\\xi}=-\\frac{1}{2}$ 和 $\\frac{d\\varphi_2}{d\\xi}=\\frac{1}{2}$。\n\n依次选择 $v_h$ 为基函数 $\\phi_{j,i}$ 之一，我们得到每个单元的常微分方程组 $\\mathbf{M} \\dot{\\mathbf{u}}_j = \\mathbf{S} \\mathbf{u}_j + \\mathbf{F}_j$，其中 $\\mathbf{u}_j = (u_{j,L}, u_{j,R})^\\top$。单元质量矩阵 $\\mathbf{M}$ 和刚度矩阵 $\\mathbf{S}$ 的各项为：\n$$\nM_{ik} = \\int_{K_j} \\phi_{j,k} \\phi_{j,i} \\, dx = \\int_{-1}^{1} \\varphi_k(\\xi) \\varphi_i(\\xi) \\frac{h}{2} \\, d\\xi\n$$\n$$\nS_{ik} = \\int_{K_j} a \\phi_{j,k} \\frac{d\\phi_{j,i}}{dx} \\, dx = \\int_{-1}^{1} a \\varphi_k(\\xi) \\left(\\frac{2}{h}\\frac{d\\varphi_i}{d\\xi}\\right) \\frac{h}{2} \\, d\\xi = a \\int_{-1}^{1} \\varphi_k(\\xi) \\frac{d\\varphi_i}{d\\xi} \\, d\\xi\n$$\n计算这些积分可得：\n$$\n\\mathbf{M} = \\frac{h}{6}\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}, \\quad \\mathbf{S} = \\frac{a}{2}\\begin{pmatrix} -1  -1 \\\\ 1  1 \\end{pmatrix}\n$$\n右侧通量贡献由项 $- a u_h(x_{j+1/2}^-) v_h(x_{j+1/2}^-) + a u_h(x_{j-1/2}^-) v_h(x_{j-1/2}^+)$ 给出。\n当 $v_h=\\phi_{j,i}$，$u_h(x_{j+1/2}^-) = u_{j,R}$，$u_h(x_{j-1/2}^-) = u_{j-1, R}$，$v_h(x_{j-1/2}^+) = \\varphi_i(-1)$ 和 $v_h(x_{j+1/2}^-) = \\varphi_i(1)$ 时，单元 $j$ 上方程 $i$ 的通量项组装成以下右侧贡献：\n对于 $i=1$: $- a u_{j,R} \\varphi_1(1) + a u_{j-1,R} \\varphi_1(-1) = a u_{j-1,R}$。\n对于 $i=2$: $- a u_{j,R} \\varphi_2(1) + a u_{j-1,R} \\varphi_2(-1) = -a u_{j,R}$。\n\n单元 $j$ 的半离散系统是：\n$$\n\\frac{h}{6}\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} \\dot{u}_{j,L} \\\\ \\dot{u}_{j,R} \\end{pmatrix} = \\frac{a}{2}\\begin{pmatrix} -1  -1 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} u_{j,L} \\\\ u_{j,R} \\end{pmatrix} + \\begin{pmatrix} a u_{j-1,R} \\\\ -a u_{j,R} \\end{pmatrix}\n$$\n这可以简化为：\n$$\n\\frac{h}{6}\\begin{pmatrix} 2\\dot{u}_{j,L} + \\dot{u}_{j,R} \\\\ \\dot{u}_{j,L} + 2\\dot{u}_{j,R} \\end{pmatrix} = \\begin{pmatrix} \\frac{a}{2}(-u_{j,L} - u_{j,R}) + a u_{j-1,R} \\\\ \\frac{a}{2}(u_{j,L} + u_{j,R}) - a u_{j,R} \\end{pmatrix} = \\begin{pmatrix} \\frac{a}{2}(-u_{j,L} - u_{j,R}) + a u_{j-1,R} \\\\ \\frac{a}{2}(u_{j,L} - u_{j,R}) \\end{pmatrix}\n$$\n对于两个单元和周期性边界条件，我们有 $j=1, 2$。对于 $j=1$，$u_{0,R} = u_{2,R}$。对于 $j=2$，使用 $u_{1,R}$。\n全局自由度向量为 $\\mathbf{u} = (u_{1,L}, u_{1,R}, u_{2,L}, u_{2,R})^\\top$。全局系统 $\\mathbf{M}_{glob} \\dot{\\mathbf{u}} = \\mathbf{K}_{glob} \\mathbf{u}$ 为：\n$$\n\\frac{h}{6}\\begin{pmatrix} 2  1  0  0 \\\\ 1  2  0  0 \\\\ 0  0  2  1 \\\\ 0  0  1  2 \\end{pmatrix} \\begin{pmatrix} \\dot{u}_{1,L} \\\\ \\dot{u}_{1,R} \\\\ \\dot{u}_{2,L} \\\\ \\dot{u}_{2,R} \\end{pmatrix} = a \\begin{pmatrix} -1/2  -1/2  0  1 \\\\ 1/2  -1/2  0  0 \\\\ 0  1  -1/2  -1/2 \\\\ 0  0  1/2  -1/2 \\end{pmatrix} \\begin{pmatrix} u_{1,L} \\\\ u_{1,R} \\\\ u_{2,L} \\\\ u_{2,R} \\end{pmatrix}\n$$\n为了找到 $\\dot{\\mathbf{u}} = \\mathbf{A} \\mathbf{u}$ 中的 $\\mathbf{A}$，我们计算 $\\mathbf{A} = \\mathbf{M}_{glob}^{-1} \\mathbf{K}_{glob}$。\n块对角质量矩阵的逆是 $\\mathbf{M}_{glob}^{-1} = \\frac{6}{h}\\begin{pmatrix} 2/3  -1/3  0  0 \\\\ -1/3  2/3  0  0 \\\\ 0  0  2/3  -1/3 \\\\ 0  0  -1/3  2/3 \\end{pmatrix} = \\frac{2}{h} \\begin{pmatrix} 2  -1  0  0 \\\\ -1  2  0  0 \\\\ 0  0  2  -1 \\\\ 0  0  -1  2 \\end{pmatrix}$。\n$$\n\\mathbf{A} = \\frac{2a}{h} \\begin{pmatrix} 2  -1  0  0 \\\\ -1  2  0  0 \\\\ 0  0  2  -1 \\\\ 0  0  -1  2 \\end{pmatrix} \\begin{pmatrix} -1/2  -1/2  0  1 \\\\ 1/2  -1/2  0  0 \\\\ 0  1  -1/2  -1/2 \\\\ 0  0  1/2  -1/2 \\end{pmatrix}\n$$\n执行矩阵乘法：\n$$\n\\mathbf{A} = \\frac{a}{h} \\begin{pmatrix} 4  -2  0  0 \\\\ -2  4  0  0 \\\\ 0  0  4  -2 \\\\ 0  0  -2  4 \\end{pmatrix} \\begin{pmatrix} -1/2  -1/2  0  1 \\\\ 1/2  -1/2  0  0 \\\\ 0  1  -1/2  -1/2 \\\\ 0  0  1/2  -1/2 \\end{pmatrix}\n$$\n$$\n\\mathbf{A} = \\frac{a}{h} \\begin{pmatrix} -3  -1  0  4 \\\\ 3  -1  0  -2 \\\\ 0  4  -3  -1 \\\\ 0  -2  3  -1 \\end{pmatrix}\n$$\n这就完成了问题的第一部分。\n\n对于第二部分，我们分析前向欧拉方法 $\\mathbf{u}^{n+1} = \\mathbf{u}^n + \\Delta t \\mathbf{A} \\mathbf{u}^n$ 的稳定性。该方法是稳定的，如果对于 $\\mathbf{A}$ 的所有特征值 $\\lambda_k$，值 $z_k = \\Delta t \\lambda_k$ 都位于前向欧拉的稳定域内，该稳定域由 $|1+z| \\le 1$ 定义。对于一个特征值 $\\lambda = \\mathrm{Re}(\\lambda) + i\\,\\mathrm{Im}(\\lambda)$，该条件变为：\n$$\n|1 + \\Delta t \\lambda|^2 \\le 1 \\implies (1 + \\Delta t \\mathrm{Re}(\\lambda))^2 + (\\Delta t \\mathrm{Im}(\\lambda))^2 \\le 1\n$$\n$$\n1 + 2\\Delta t \\mathrm{Re}(\\lambda) + (\\Delta t)^2 (\\mathrm{Re}(\\lambda)^2 + \\mathrm{Im}(\\lambda)^2) \\le 1\n$$\n$$\n2\\Delta t \\mathrm{Re}(\\lambda) + (\\Delta t)^2 |\\lambda|^2 \\le 0\n$$\n为了保证稳定性，所有特征值的实部都必须非正。如果 $\\mathrm{Re}(\\lambda)  0$，对 $\\Delta t$ 的条件是：\n$$\n\\Delta t \\le \\frac{-2 \\mathrm{Re}(\\lambda)}{|\\lambda|^2}\n$$\n矩阵 $\\mathbf{A}$ 具有块循环结构 $\\mathbf{A} = \\text{circ}(\\mathbf{A}_{11}, \\mathbf{A}_{12})$，其中 $\\mathbf{A}_{11} = \\frac{a}{h}\\begin{pmatrix} -3  -1 \\\\ 3  -1 \\end{pmatrix}$ 且 $\\mathbf{A}_{12} = \\frac{a}{h}\\begin{pmatrix} 0  4 \\\\ 0  -2 \\end{pmatrix}$。$\\mathbf{A}$ 的特征值是矩阵 $\\mathbf{A}_{11} + \\omega^k \\mathbf{A}_{12}$（对于 $k=0,1$）的特征值，其中 $\\omega = e^{i 2\\pi/2} = -1$。\n\n情况1：$k=0$ ($\\omega^0 = 1$)\n特征值来自 $\\mathbf{E}_0 = \\mathbf{A}_{11} + \\mathbf{A}_{12} = \\frac{a}{h} \\left( \\begin{pmatrix} -3  -1 \\\\ 3  -1 \\end{pmatrix} + \\begin{pmatrix} 0  4 \\\\ 0  -2 \\end{pmatrix} \\right) = \\frac{a}{h} \\begin{pmatrix} -3  3 \\\\ 3  -3 \\end{pmatrix}$。\n特征方程是 $(-3-\\mu)(-3-\\mu) - 9 = 0 \\Rightarrow (\\mu+3)^2=9 \\Rightarrow \\mu+3 = \\pm 3$。这给出了特征值 $\\mu_1=0$ 和 $\\mu_2=-6$。\n所以，$\\mathbf{A}$ 的两个特征值是 $\\lambda_1 = 0$ 和 $\\lambda_2 = -6a/h$。\n\n情况2：$k=1$ ($\\omega^1 = -1$)\n特征值来自 $\\mathbf{E}_1 = \\mathbf{A}_{11} - \\mathbf{A}_{12} = \\frac{a}{h} \\left( \\begin{pmatrix} -3  -1 \\\\ 3  -1 \\end{pmatrix} - \\begin{pmatrix} 0  4 \\\\ 0  -2 \\end{pmatrix} \\right) = \\frac{a}{h} \\begin{pmatrix} -3  -5 \\\\ 3  1 \\end{pmatrix}$。\n特征方程是 $(-3-\\mu)(1-\\mu) - (-5)(3) = 0 \\Rightarrow \\mu^2 + 2\\mu + 12 = 0$。\n根是 $\\mu = \\frac{-2 \\pm \\sqrt{4-48}}{2} = -1 \\pm i\\sqrt{11}$。\n所以，$\\mathbf{A}$ 的另外两个特征值是 $\\lambda_{3,4} = \\frac{a}{h}(-1 \\pm i\\sqrt{11})$。\n\n现在我们为每个非零特征值找到稳定性限制：\n对于 $\\lambda_2 = -6a/h$：$\\mathrm{Re}(\\lambda_2) = -6a/h$，$|\\lambda_2|^2 = 36(a/h)^2$。\n$$\n\\Delta t \\le \\frac{-2(-6a/h)}{36(a/h)^2} = \\frac{12a/h}{36(a/h)^2} = \\frac{1}{3}\\frac{h}{a}\n$$\n对于 $\\lambda_{3,4} = \\frac{a}{h}(-1 \\pm i\\sqrt{11})$：$\\mathrm{Re}(\\lambda_{3,4}) = -a/h$，$|\\lambda_{3,4}|^2 = (a/h)^2 ((-1)^2 + (\\pm\\sqrt{11})^2) = 12(a/h)^2$。\n$$\n\\Delta t \\le \\frac{-2(-a/h)}{12(a/h)^2} = \\frac{2a/h}{12(a/h)^2} = \\frac{1}{6}\\frac{h}{a}\n$$\n特征值 $\\lambda_1=0$ 对 $\\Delta t$ 没有限制。为确保所有模式的稳定性，我们必须采用最严格的条件，即所计算的时间步长限制的最小值。\n$$\n\\Delta t_{\\max} = \\min\\left(\\frac{1}{3}\\frac{h}{a}, \\frac{1}{6}\\frac{h}{a}\\right) = \\frac{1}{6}\\frac{h}{a}\n$$\n此格式的 Courant-Friedrichs-Lewy (CFL) 数为 $\\frac{a \\Delta t}{h} \\le \\frac{1}{6}$。", "answer": "$$\\boxed{\\frac{h}{6a}}$$", "id": "2552265"}]}