{"hands_on_practices": [{"introduction": "在应用k-refinement等高级技术之前，必须首先掌握B样条空间的基本性质。本练习的核心是从给定的节点向量出发，分析并确定样条空间的属性。通过直接根据节点向量计算连续性、单元数量和空间维度，您将巩固对节点重复度如何控制基函数结构和平滑度的理解。[@problem_id:2572161]", "problem": "在有限元方法的背景下，结合$k$-细化和贝塞尔提取的等几何概念，考虑一个单变量开节点矢量 $\\Xi=(0,0,0,0.25,0.5,0.5,0.75,1,1,1)$ 和多项式次数 $p=2$。假设该样条空间用于构建等几何分析的基函数，并且将应用贝塞尔提取来获得单元级的伯恩斯坦基。\n\n从B样条和节点重复度的核心定义出发，确定：\n- 每个内部节点（即 $0.25$、$0.5$ 和 $0.75$ 处）的连续性阶数 $C^{s}$，\n- 由贝塞尔提取生成的单元数量（解释为非零长度节点区间的数量），\n- 样条空间 $S_{p,\\Xi}$ 的维数。\n\n请按顺序 $\\big(0.25$ 处的连续性阶数，$0.5$ 处的连续性阶数，$0.75$ 处的连续性阶数，单元数量，$S_{p,\\Xi}$ 的维数\\big) 将最终答案表示为单个行向量。无需四舍五入。无需单位。最终答案必须是指定的单个行向量。", "solution": "所提出的问题是有效的，因为它科学地基于B样条的数学理论，而B样条理论是等几何分析的基础。该问题是适定的，提供了所有必要的信息——节点矢量和多项式次数——以唯一地确定样条空间所需的性质。问题是客观且可形式化的。我们将开始求解。\n\n该问题要求确定由给定节点矢量和多项式次数定义的B样条空间的三个性质。让我们系统地分析每个要求。\n\n首先，给定多项式次数 $p=2$ 和开节点矢量 $\\Xi=(\\xi_1, \\xi_2, ..., \\xi_{10}) = (0,0,0,0.25,0.5,0.5,0.75,1,1,1)$。\n\n第一个任务是确定每个内部节点的连续性阶数，记为 $C^s$。内部节点是那些严格位于最小和最大节点值之间的节点。$\\Xi$ 中的唯一节点为 $\\hat{\\Xi}=\\{0, 0.25, 0.5, 0.75, 1\\}$。因此，内部节点为 $\\{0.25, 0.5, 0.75\\}$。\n\nB样条函数在节点 $\\xi$ 处的连续性由该节点在节点矢量中的重复度决定。如果一个节点 $\\xi$ 的重复度为 $m$，则样条基函数在该节点处是 $C^{p-m}$ 连续的。因此，连续性阶数 $s$ 为 $s = p - m$。\n\n1.  在节点 $\\xi = 0.25$ 处：该节点在节点矢量 $\\Xi$ 中出现一次。因此，其重复度为 $m=1$。该节点的连续性阶数 $s$ 计算如下：\n    $$s_{0.25} = p - m = 2 - 1 = 1$$\n    所以，样条在 $\\xi = 0.25$ 处是 $C^1$ 连续的。\n\n2.  在节点 $\\xi = 0.5$ 处：该节点在节点矢量 $\\Xi$ 中出现两次。因此，其重复度为 $m=2$。该节点的连续性阶数 $s$ 为：\n    $$s_{0.5} = p - m = 2 - 2 = 0$$\n    所以，样条在 $\\xi = 0.5$ 处是 $C^0$ 连续的。\n\n3.  在节点 $\\xi = 0.75$ 处：该节点在节点矢量 $\\Xi$ 中出现一次。其重复度为 $m=1$。该节点的连续性阶数 $s$ 为：\n    $$s_{0.75} = p - m = 2 - 1 = 1$$\n    所以，样条在 $\\xi = 0.75$ 处是 $C^1$ 连续的。\n\n第二个任务是确定由贝塞尔提取生成的单元数量。在等几何分析的背景下，“单元”对应于一个非零长度的节点区间。贝塞尔提取是产生B样条基的单元局部伯恩斯坦表示的过程。这类单元的数量等于由节点矢量中的唯一节点定义的区间数量。\n\n唯一节点的集合是 $\\hat{\\Xi}=\\{0, 0.25, 0.5, 0.75, 1\\}$。这些节点定义了以下非零长度的节点区间（间隔）：$[0, 0.25]$、$[0.25, 0.5]$、$[0.5, 0.75]$ 和 $[0.75, 1]$。共有 $4$ 个这样的区间。因此，单元数量为 $4$。\n\n第三个任务是求样条空间 $S_{p,\\Xi}$ 的维数。B样条空间的维数等于B样条基函数的数量，由以下公式给出：\n$$\\text{dim}(S_{p,\\Xi}) = n = (\\text{节点数量}) - p - 1$$\n给定节点矢量 $\\Xi$ 的长度为 $10$。多项式次数为 $p=2$。将这些值代入公式：\n$$\\text{dim}(S_{p,\\Xi}) = 10 - 2 - 1 = 7$$\n因此，样条空间的维数为 $7$。\n\n最后，我们需要按指定顺序将结果表示为单个行向量：（$0.25$ 处的连续性阶数，$0.5$ 处的连续性阶数，$0.75$ 处的连续性阶数，单元数量，$S_{p,\\Xi}$ 的维数）。根据我们的计算，该向量为 $(1, 0, 1, 4, 7)$。", "answer": "$$\\boxed{\\begin{pmatrix} 1  & 0 & 1 & 4 & 7 \\end{pmatrix}}$$", "id": "2572161"}, {"introduction": "h-refinement和k-refinement中的一个关键操作是节点插入，它可以在不改变几何形状的情况下增加新的基函数和控制点。本练习要求您应用Boehm算法这一基本的节点插入程序。通过推导B样条曲线的新控制点，您将具体地理解局部加密是如何实现的，以及原始控制网格与加密后控制网格之间的关系。[@problem_id:2572196]", "problem": "在有限元法中的等几何分析（Isogeometric Analysis, IGA）中，一条二次B样条曲线可以通过一个具有重复端节点的开放均匀节点向量来表示。考虑由控制点 $P_0, P_1, P_2 \\in \\mathbb{R}^d$ 和开放节点向量 $\\Xi = (0,0,0,1,1,1)$ 定义的二次（$p=2$）B样条曲线，该曲线描述了参数区间 $[0,1]$ 上的一个二次Bézier段。使用Boehm节点插入算法（该算法保持曲线的几何形状不变），在 $\\xi^\\star = 0.5$ 处插入一个内部节点，以获得加密后的节点向量 $\\Xi^{\\mathrm{new}}$。根据B样条基函数的定义性质以及曲线在节点插入下的不变性，推导加密后的二次B样条曲线\n$$\nC(\\xi) \\;=\\; \\sum_{i=0}^{3} N^{\\mathrm{new}}_{i,2}(\\xi)\\, Q_i \\quad \\text{on} \\quad \\Xi^{\\mathrm{new}},\n$$\n的新控制点 $Q_0,Q_1,Q_2,Q_3$ 的显式表达式，这些表达式应表示为原始控制点 $P_0,P_1,P_2$ 的线性组合。\n\n将您的最终答案表示为一个单行矩阵，其元素是四个以 $P_0,P_1,P_2$ 表示的新控制点。无需进行数值舍入。不要包含单位。", "solution": "所述问题是有效的。这是一个来自等几何分析和计算机辅助几何设计领域的适定的、有科学依据的问题，需要应用一个标准的基本算法。所有必要的数据都已提供，没有矛盾或含糊之处。\n\n我们的任务是找出在插入一个新节点后，二次B样条曲线的新控制点 $Q_0, Q_1, Q_2, Q_3$。节点插入过程必须保持曲线的几何形状和参数化不变。对此，标准方法是Boehm节点插入算法。\n\n初始曲线是一条次数为 $p=2$ 的二次B样条曲线，由 $n+1=3$ 个控制点 $P_0, P_1, P_2$ 定义。节点向量是开放均匀节点向量 $\\Xi = (\\xi_0, \\xi_1, \\xi_2, \\xi_3, \\xi_4, \\xi_5) = (0,0,0,1,1,1)$。关系式 $m=n+p+1$ 成立，其中节点数 $m=6$，控制点的最高索引 $n=2$，次数 $p=2$。端节点的重复度为 $p+1=3$，这证实了该B样条曲线是在参数区间 $[0, 1]$ 上定义的单个二次Bézier段。\n\n我们必须将新节点 $\\xi^\\star = 0.5$ 插入到 $\\Xi$ 中。首先，我们必须确定包含 $\\xi^\\star$ 的节点区间 $[\\xi_k, \\xi_{k+1})$。给定 $\\Xi = (0,0,0,1,1,1)$，我们有 $\\xi_2 = 0$ 和 $\\xi_3 = 1$。由于 $0 \\le 0.5  1$，我们发现 $\\xi^\\star$ 位于区间 $[\\xi_2, \\xi_3)$ 内，因此索引为 $k=2$。\n\n插入 $\\xi^\\star$ 后，新的节点向量变为 $\\Xi^{\\mathrm{new}} = (0,0,0,0.5,1,1,1)$。这种加密后的表示需要 $n_{new}+1 = m_{new}-p-1 = 7-2-1=4$ 个控制点，我们将其记作 $Q_0, Q_1, Q_2, Q_3$。\n\nBoehm算法提供了计算新控制点的公式。对于在区间 $[\\xi_k, \\xi_{k+1})$ 内插入节点 $\\xi^\\star$ 的情况，新的控制点 $Q_i$ 由旧的控制点 $P_j$ 计算如下：\n$Q_i = P_i$ 对于 $i \\leq k-p$。\n$Q_i = \\alpha_i P_i + (1-\\alpha_i) P_{i-1}$ 对于 $k-p+1 \\leq i \\leq k$。\n$Q_i = P_{i-1}$ 对于 $i  k$。\n\n系数 $\\alpha_i$ 由以下公式给出：\n$$ \\alpha_i = \\frac{\\xi^\\star - \\xi_i}{\\xi_{i+p} - \\xi_i} $$\n\n我们将这些公式应用于我们的具体值：$p=2$，$k=2$，以及 $\\xi^\\star = 0.5$。\n\n1.  对于索引 $i \\leq k-p = 2-2=0$ 的控制点：\n    这仅适用于 $i=0$。\n    $$ Q_0 = P_0 $$\n\n2.  对于索引 $i  k = 2$ 的控制点：\n    新的控制点索引最高为3。此规则适用于 $i=3$。\n    $$ Q_3 = P_{3-1} = P_2 $$\n\n3.  对于索引 $k-p+1 \\leq i \\leq k$ 的控制点，即 $2-2+1 \\leq i \\leq 2$，或 $1 \\leq i \\leq 2$：\n    我们必须计算 $Q_1$ 和 $Q_2$。\n\n    对于 $i=1$：\n    我们首先计算系数 $\\alpha_1$：\n    $$ \\alpha_1 = \\frac{\\xi^\\star - \\xi_1}{\\xi_{1+p} - \\xi_1} = \\frac{0.5 - \\xi_1}{\\xi_{3} - \\xi_1} = \\frac{0.5 - 0}{1 - 0} = 0.5 = \\frac{1}{2} $$\n    那么新的控制点 $Q_1$ 为：\n    $$ Q_1 = \\alpha_1 P_1 + (1-\\alpha_1) P_{0} = \\frac{1}{2} P_1 + \\left(1-\\frac{1}{2}\\right) P_0 = \\frac{1}{2} P_0 + \\frac{1}{2} P_1 $$\n\n    对于 $i=2$：\n    我们计算系数 $\\alpha_2$：\n    $$ \\alpha_2 = \\frac{\\xi^\\star - \\xi_2}{\\xi_{2+p} - \\xi_2} = \\frac{0.5 - \\xi_2}{\\xi_{4} - \\xi_2} = \\frac{0.5 - 0}{1 - 0} = 0.5 = \\frac{1}{2} $$\n    那么新的控制点 $Q_2$ 为：\n    $$ Q_2 = \\alpha_2 P_2 + (1-\\alpha_2) P_{1} = \\frac{1}{2} P_2 + \\left(1-\\frac{1}{2}\\right) P_1 = \\frac{1}{2} P_1 + \\frac{1}{2} P_2 $$\n\n总结结果，加密后的B样条曲线的新控制点集为：\n$Q_0 = P_0$\n$Q_1 = \\frac{1}{2}P_0 + \\frac{1}{2}P_1$\n$Q_2 = \\frac{1}{2}P_1 + \\frac{1}{2}P_2$\n$Q_3 = P_2$\n\n这些表达式即为问题所要求的、以原始控制点表示的显式线性组合。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nP_0   \\frac{1}{2}P_0 + \\frac{1}{2}P_1   \\frac{1}{2}P_1 + \\frac{1}{2}P_2   P_2\n\\end{pmatrix}\n}\n$$", "id": "2572196"}, {"introduction": "Bézier提取的真正威力在于它能够搭建起几何设计（样条）和工程分析（有限元）之间的桥梁。这项实践要求您使用一个$C^1$连续的样条基函数，为一个一维杆件组装全局质量矩阵。您将看到如何通过Bézier提取获得的单元局部Bernstein表示，来简化积分计算并促进矩阵组装，从而展示一个高效的高阶有限元分析框架。[@problem_id:2572110]", "problem": "考虑一个占据参数区间 $[0,1]$ 的一维杆。假设无量纲化的质量密度乘以横截面积等于 $1$，因此一致质量矩阵是纯几何的。试探空间是由在开放、均匀的节点向量\n$$\\Xi = \\big[0,0,0,\\tfrac{1}{4},\\tfrac{1}{2},\\tfrac{3}{4},1,1,1\\big],$$\n上通过 $k$-加密获得的二次、$C^{1}$-连续的B样条基，它产生一个由四个尺寸为 $h=\\tfrac{1}{4}$ 的单元组成的均匀网格和 $6$ 个全局基函数。使用贝塞尔提取，从第一性原理出发，完成以下步骤：\n\n1. 在双单位区间 $t\\in[0,1]$ 上定义二次伯恩斯坦基 $\\{B_{0}(t),B_{1}(t),B_{2}(t)\\}$，以及从 $[0,1]$ 到每个尺寸为 $h=\\tfrac{1}{4}$ 的单元 $e$ 的单元仿射映射 $x = x_{e}(t)$。将单元 $e$ 的贝塞尔提取算子表示为 $C^{(e)}\\in\\mathbb{R}^{3\\times 3}$，使得限制在单元 $e$ 上的单元B样条基函数向量可以写为 $N^{(e)}(t) = C^{(e)}\\,b(t)$，其中 $b(t) = [B_{0}(t),B_{1}(t),B_{2}(t)]^{T}$。\n\n2. 使用一致质量矩阵的定义和单元映射下的变量替换，推导单元质量矩阵 $M^{(e)}\\in\\mathbb{R}^{3\\times 3}$ 关于 $h$、提取矩阵 $C^{(e)}$ 和伯恩斯坦格拉姆矩阵 $G_{B} = \\int_{0}^{1} b(t)b(t)^{T}\\,\\mathrm{d}t$ 的表达式。\n\n3. 通过在 $[0,1]$ 上对二次伯恩斯坦多项式的乘积进行积分，精确计算 $G_{B}$。\n\n4. 使用由 $\\Xi$ 隐含的规范 $C^{1}$ B样条连通性，从四个单元矩阵 $\\{M^{(e)}\\}_{e=1}^{4}$ 组装全局质量矩阵 $M\\in\\mathbb{R}^{6\\times 6}$。您的组装过程必须明确地用 $h$、$G_{B}$ 和提取矩阵 $\\{C^{(e)}\\}$ 来表示。\n\n5. 仅使用B样条和贝塞尔提取的定义性质，验证组装后的 $M$ 是对称且对称正定的（SPD），其中对称正定（SPD）意味着对于所有非零向量 $\\mathbf{v}$，都有 $M^{T}=M$ 和 $\\mathbf{v}^{T}M\\mathbf{v}0$。\n\n6. 令 $\\mathbf{1}\\in\\mathbb{R}^{6}$ 表示所有分量均为 $1$ 的向量。计算标量\n$$q \\;=\\; \\mathbf{1}^{T} M \\mathbf{1}.$$\n将 $q$ 报告为一个没有单位的精确实数。\n\n您的最终答案必须仅为 $q$ 的单个值。不要在最终答案中包含任何中间表达式。", "solution": "问题是使用由特定节点向量定义的 $C^{1}$-连续二次B样条基，为一维杆组装全局一致质量矩阵，然后计算标量值 $q = \\mathbf{1}^{T} M \\mathbf{1}$。\n\n这个问题是有效的。它在科学上基于有限元法和等几何分析的原理。它适定、客观，并包含推导出唯一解所需的所有必要信息。\n\n将按照问题陈述中规定的六个步骤来构建解答。\n\n步骤1：伯恩斯坦基和单元映射\n\n在双单位区间 $t \\in [0,1]$ 上的二次伯恩斯坦基函数定义如下：\n$$B_{0}(t) = \\binom{2}{0} (1-t)^{2}t^{0} = (1-t)^{2}$$\n$$B_{1}(t) = \\binom{2}{1} (1-t)^{1}t^{1} = 2t(1-t)$$\n$$B_{2}(t) = \\binom{2}{2} (1-t)^{0}t^{2} = t^{2}$$\n伯恩斯坦基函数的向量是 $b(t) = [B_{0}(t), B_{1}(t), B_{2}(t)]^{T}$。这些函数构成单位分解，即 $\\sum_{i=0}^{2} B_{i}(t) = 1$。\n\n该网格由四个尺寸为 $h=\\frac{1}{4}$ 的均匀单元组成：$[0,\\frac{1}{4}]$、$[\\frac{1}{4},\\frac{1}{2}]$、$[\\frac{1}{2},\\frac{3}{4}]$ 和 $[\\frac{3}{4},1]$。从参数坐标 $t \\in [0,1]$ 到单元 $e$（跨越区间 $[x_{e-1}, x_{e}]$）中物理坐标 $x$ 的仿射映射由下式给出：\n$$x_{e}(t) = x_{e-1} + (x_{e} - x_{e-1})t = (e-1)h + ht$$\n该变换的雅可比是 $\\frac{\\mathrm{d}x}{\\mathrm{d}t} = h = \\frac{1}{4}$。\n\n步骤2：单元质量矩阵的构建\n\n对于在单元 $e$ 上活跃的基函数（由向量 $N^{(e)}(x)$ 表示），其单元质量矩阵 $M^{(e)}$ 的分量由下式给出：\n$$(M^{(e)})_{ij} = \\int_{x_{e-1}}^{x_e} N^{(e)}_i(x) N^{(e)}_j(x) \\,\\mathrm{d}x$$\n使用变量替换 $x=x_e(t)$ 和 $\\mathrm{d}x = h\\,\\mathrm{d}t$，我们得到：\n$$M^{(e)} = \\int_{0}^{1} N^{(e)}(x_e(t)) (N^{(e)}(x_e(t)))^{T} h \\,\\mathrm{d}t$$\n使用贝塞尔提取关系 $N^{(e)}(t) = C^{(e)} b(t)$，其中 $C^{(e)}$ 是单元 $e$ 的常数提取算子：\n$$M^{(e)} = h \\int_{0}^{1} (C^{(e)} b(t)) (C^{(e)} b(t))^{T} \\,\\mathrm{d}t = h \\int_{0}^{1} C^{(e)} b(t) b(t)^{T} (C^{(e)})^{T} \\,\\mathrm{d}t$$\n由于 $C^{(e)}$ 是常数，可以将其移到积分符号外：\n$$M^{(e)} = h C^{(e)} \\left( \\int_{0}^{1} b(t) b(t)^{T} \\,\\mathrm{d}t \\right) (C^{(e)})^{T}$$\n这给出了以伯恩斯坦格拉姆矩阵 $G_{B} = \\int_{0}^{1} b(t)b(t)^{T}\\,\\mathrm{d}t$ 表示的单元质量矩阵的表达式：\n$$M^{(e)} = h C^{(e)} G_{B} (C^{(e)})^{T}$$\n\n步骤3：伯恩斯坦格拉姆矩阵 $G_B$ 的计算\n\n$G_{B}$ 的分量为 $(G_{B})_{ij} = \\int_{0}^{1} B_{i-1}(t) B_{j-1}(t) \\,\\mathrm{d}t$。我们计算所需的积分：\n$\\int_{0}^{1} B_{0}(t)^2 \\,\\mathrm{d}t = \\int_{0}^{1} (1-t)^4 \\,\\mathrm{d}t = \\frac{1}{5}$\n$\\int_{0}^{1} B_{1}(t)^2 \\,\\mathrm{d}t = \\int_{0}^{1} 4t^2(1-t)^2 \\,\\mathrm{d}t = 4 \\frac{2!2!}{5!} = \\frac{2}{15}$\n$\\int_{0}^{1} B_{2}(t)^2 \\,\\mathrm{d}t = \\int_{0}^{1} t^4 \\,\\mathrm{d}t = \\frac{1}{5}$\n$\\int_{0}^{1} B_{0}(t)B_{1}(t) \\,\\mathrm{d}t = \\int_{0}^{1} 2t(1-t)^3 \\,\\mathrm{d}t = 2 \\frac{1!3!}{5!} = \\frac{1}{10}$\n$\\int_{0}^{1} B_{0}(t)B_{2}(t) \\,\\mathrm{d}t = \\int_{0}^{1} t^2(1-t)^2 \\,\\mathrm{d}t = \\frac{2!2!}{5!} = \\frac{1}{30}$\n$\\int_{0}^{1} B_{1}(t)B_{2}(t) \\,\\mathrm{d}t = \\int_{0}^{1} 2t^3(1-t) \\,\\mathrm{d}t = 2 \\frac{3!1!}{5!} = \\frac{1}{10}$\n得到的伯恩斯坦格拉姆矩阵是：\n$$G_{B} = \\begin{pmatrix} \\frac{1}{5}  \\frac{1}{10}  \\frac{1}{30} \\\\ \\frac{1}{10}  \\frac{2}{15}  \\frac{1}{10} \\\\ \\frac{1}{30}  \\frac{1}{10}  \\frac{1}{5} \\end{pmatrix} = \\frac{1}{30} \\begin{pmatrix} 6  3  1 \\\\ 3  4  3 \\\\ 1  3  6 \\end{pmatrix}$$\n\n步骤4：全局质量矩阵 $M$ 的组装\n\n节点向量 $\\Xi = \\left[0,0,0,\\frac{1}{4},\\frac{1}{2},\\frac{3}{4},1,1,1\\right]$ 定义了 $n=6$ 个二次 ($p=2$) B样条基函数。每个单元上的活跃基函数是：\n- 单元 $1 \\ [0, \\frac{1}{4}]$: $\\{N_1, N_2, N_3\\}$\n- 单元 $2 \\ [\\frac{1}{4}, \\frac{1}{2}]$: $\\{N_2, N_3, N_4\\}$\n- 单元 $3 \\ [\\frac{1}{2}, \\frac{3}{4}]$: $\\{N_3, N_4, N_5\\}$\n- 单元 $4 \\ [\\frac{3}{4}, 1]$: $\\{N_4, N_5, N_6\\}$\n\n对于均匀的 $C^1$-连续二次样条，标准的贝塞尔提取矩阵是：\n$$C^{(1)} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  \\frac{1}{2} \\\\ 0  0  \\frac{1}{2} \\end{pmatrix}, \\quad C^{(2)}=C^{(3)}=C^{(\\text{int})} = \\begin{pmatrix} \\frac{1}{2}  0  0 \\\\ \\frac{1}{2}  1  \\frac{1}{2} \\\\ 0  0  \\frac{1}{2} \\end{pmatrix}, \\quad C^{(4)} = \\begin{pmatrix} \\frac{1}{2}  0  0 \\\\ \\frac{1}{2}  1  0 \\\\ 0  0  1 \\end{pmatrix}$$\n我们用 $h=\\frac{1}{4}$ 计算单元质量矩阵：\n$$M^{(1)} = \\frac{1}{4} C^{(1)} G_B (C^{(1)})^{T} = \\frac{1}{240} \\begin{pmatrix} 12  7  1 \\\\ 7  17  6 \\\\ 1  6  3 \\end{pmatrix} = \\frac{1}{480} \\begin{pmatrix} 24  14  2 \\\\ 14  34  12 \\\\ 2  12  6 \\end{pmatrix}$$\n$$M^{(2)} = M^{(3)} = \\frac{1}{4} C^{(\\text{int})} G_B (C^{(\\text{int})})^{T} = \\frac{1}{480} \\begin{pmatrix} 6  13  1 \\\\ 13  54  13 \\\\ 1  13  6 \\end{pmatrix}$$\n$$M^{(4)} = \\frac{1}{4} C^{(4)} G_B (C^{(4)})^{T} = \\frac{1}{240} \\begin{pmatrix} 3  6  1 \\\\ 6  17  7 \\\\ 1  7  12 \\end{pmatrix} = \\frac{1}{480} \\begin{pmatrix} 6  12  2 \\\\ 12  34  14 \\\\ 2  14  24 \\end{pmatrix}$$\n全局质量矩阵 $M \\in \\mathbb{R}^{6 \\times 6}$ 是通过根据自由度对单元贡献求和来组装的：\n$M(1:3, 1:3) \\mathrel{+}= M^{(1)}$\n$M(2:4, 2:4) \\mathrel{+}= M^{(2)}$\n$M(3:5, 3:5) \\mathrel{+}= M^{(3)}$\n$M(4:6, 4:6) \\mathrel{+}= M^{(4)}$\n这产生了全局质量矩阵：\n$$M = \\frac{1}{480} \\begin{pmatrix}\n24  14  2  0  0  0 \\\\\n14  40  25  1  0  0 \\\\\n2  25  66  26  1  0 \\\\\n0  1  26  66  25  2 \\\\\n0  0  1  25  40  14 \\\\\n0  0  0  2  14  24\n\\end{pmatrix}$$\n\n步骤5：对称性和正定性的验证\n\n对称性：质量矩阵定义为 $M_{ij} = \\int_{0}^{1} N_i(x)N_j(x)\\,\\mathrm{d}x$。由于标量乘法是可交换的，$N_i(x)N_j(x) = N_j(x)N_i(x)$，这意味着 $M_{ij} = M_{ji}$。因此，$M$ 根据定义是对称的。我们组装的矩阵显然是对称的。\n\n对称正定（SPD）：我们必须证明对于任何非零向量 $\\mathbf{v} \\in \\mathbb{R}^6$，都有 $\\mathbf{v}^{T}M\\mathbf{v}0$。令 $u(x) = \\sum_{i=1}^6 v_i N_i(x)$ 为B样条空间中的一个函数。二次型为：\n$$\\mathbf{v}^{T}M\\mathbf{v} = \\sum_{i=1}^6 \\sum_{j=1}^6 v_i M_{ij} v_j = \\sum_{i=1}^6 \\sum_{j=1}^6 v_i \\left( \\int_0^1 N_i(x) N_j(x) \\,\\mathrm{d}x \\right) v_j = \\int_0^1 \\left(\\sum_{i=1}^6 v_i N_i(x)\\right)\\left(\\sum_{j=1}^6 v_j N_j(x)\\right) \\,\\mathrm{d}x = \\int_0^1 [u(x)]^2 \\,\\mathrm{d}x$$\nB样条基函数 $\\{N_i(x)\\}_{i=1}^6$ 是线性无关的。因此，如果 $\\mathbf{v} \\neq \\mathbf{0}$，那么 $u(x)$ 不是零函数。由于 $u(x)$ 是连续的且不恒为零，其平方 $[u(x)]^2$ 是非负的，并且在 $[0,1]$ 的某个子区间上是严格为正的。因此，积分 $\\int_0^1 [u(x)]^2 \\,\\mathrm{d}x$ 是严格为正的。这就证明了 $M$ 是对称正定的。\n\n步骤6：计算 $q = \\mathbf{1}^{T} M \\mathbf{1}$\n\n可以通过在上面推导的二次型中设置 $\\mathbf{v} = \\mathbf{1} = [1, 1, 1, 1, 1, 1]^T$ 来计算量 $q$。对应的函数是 $u(x) = \\sum_{i=1}^6 (1) \\cdot N_i(x)$。在开放节点向量（其中第一个和最后一个节点的重数为 $p+1$）上定义的B样条基的一个基本性质是，基函数在定义域上构成单位分解。对于次数 $p=2$，节点向量 $\\Xi$ 的两端重数为 $3$，所以基函数在定义域 $[0,1]$ 上的和为1：\n$$\\sum_{i=1}^6 N_i(x) = 1, \\quad \\forall x \\in [0,1]$$\n因此，$u(x)=1$。$q$ 的计算变得微不足道：\n$$q = \\mathbf{1}^{T} M \\mathbf{1} = \\int_0^1 \\left( \\sum_{i=1}^6 N_i(x) \\right)^2 \\,\\mathrm{d}x = \\int_0^1 (1)^2 \\,\\mathrm{d}x = \\int_0^1 1 \\,\\mathrm{d}x = [x]_0^1 = 1$$\n这个结果可以通过直接对组装矩阵 $M$ 的所有分量求和来验证：\n$$q = \\sum_{i=1}^6 \\sum_{j=1}^6 M_{ij} = \\frac{1}{480} \\left( (24+14+2) + (14+40+25+1) + \\dots \\right)$$\n对行和求和：\n$$q = \\frac{1}{480} (40 + 80 + 120 + 120 + 80 + 40) = \\frac{480}{480} = 1$$\n直接求和证实了理论结果。", "answer": "$$\\boxed{1}$$", "id": "2572110"}]}