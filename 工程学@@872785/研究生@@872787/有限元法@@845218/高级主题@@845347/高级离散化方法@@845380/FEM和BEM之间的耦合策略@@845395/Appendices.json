{"hands_on_practices": [{"introduction": "实现任何耦合方法的第一步都是将连续的变分问题转化为离散的线性系统。本练习将引导您完成这一核心过程，展示如何将一个简化的拉普拉斯传输问题的变分形式系统地离散化。通过这个实践[@problem_id:2551154]，您将亲手构建有限元刚度矩阵、边界元算子矩阵以及连接两者的关键耦合矩阵，从而对理论与实践的联系获得具体而深入的理解。", "problem": "考虑二维空间中的标量拉普拉斯传输问题。设内部计算域为直角三角形 $\\Omega \\subset \\mathbb{R}^{2}$，其顶点为 $(0,0)$、$(1,0)$ 和 $(0,1)$。将其斜边记为 $\\Gamma := \\{(x,y) \\in \\partial \\Omega : x+y=1,\\ x \\ge 0,\\ y \\ge 0\\}$。假设在三角形的两条直角边上，即在 $\\partial \\Omega \\setminus \\Gamma$ 上，施加齐次狄利克雷边界条件，并通过单层势在 $\\Gamma$ 上与一个无界拉普拉斯外部问题耦合。该单层势涉及二维拉普拉斯基本解 $G(x,y) = -\\frac{1}{2\\pi}\\ln|x-y|$。\n\n您将在以下设置中构建一个有限元法-边界元法（FEM–BEM）耦合：\n\n- 在 $\\Omega$ 上使用一个与单个三角形单元相关联的协调分片仿射（$P_{1}$）有限元空间，其节点基 $\\{\\varphi_{1},\\varphi_{2},\\varphi_{3}\\}$ 分别对应于顶点 $(0,0)$、$(1,0)$ 和 $(0,1)$。\n\n- 在 $\\Gamma$ 上使用一个由单个单元组成的分片常数边界元空间，其基函数 $\\psi_{1}$ 在 $\\Gamma$ 上等于 $1$。\n\n采用以下弱耦合策略：引入一个未知密度 $\\lambda \\in H^{-1/2}(\\Gamma)$，使得 $\\Gamma$ 上的外部势由单层势表示，并通过内部迹等于单层边界迹的弱约束来施加传输条件，即，在变分意义下强制 $\\gamma u - V \\lambda = 0$ 在 $\\Gamma$ 上成立，其中 $\\gamma$ 是内部狄利克雷迹，而 $V$ 是边界单层算子，定义为 $(V\\lambda)(x) = \\int_{\\Gamma} G(x,y)\\lambda(y)\\,\\mathrm{d}s_{y}$，对于 $x \\in \\Gamma$。\n\n从 Green 恒等式和 $\\Omega$ 中拉普拉斯方程的标准变分形式出发，通过上述对传输条件的弱施加，推导耦合的 FEM-BEM 未知量 $(u_{h},\\lambda_{h})$ 的离散鞍点系统，其形式为\n$$\n\\begin{pmatrix}\nA & B^{\\top} \\\\\nB & -V\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{u} \\\\\n\\boldsymbol{\\lambda}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{f} \\\\\n\\mathbf{0}\n\\end{pmatrix},\n$$\n并根据底层的双线性形式辨识每个矩阵块：\n- 内部刚度矩阵 $A$，\n- 源于 $\\Gamma$ 上迹项的 FEM–BEM 耦合矩阵 $B$，\n- 以及边界单层矩阵 $V$。\n\n请用包含基函数 $\\{\\varphi_{i}\\}$ 和 $\\{\\psi_{1}\\}$ 以及核函数 $G$ 的积分明确写出这些矩阵块。\n\n最后，对于给定的特定单单元几何结构，以闭合形式计算单层矩阵 $V$ 的唯一元素，即\n$$\nV_{11} \\;=\\; \\int_{\\Gamma}\\int_{\\Gamma} G(x,y)\\,\\psi_{1}(x)\\,\\psi_{1}(y)\\,\\mathrm{d}s_{x}\\,\\mathrm{d}s_{y},\n$$\n您可以将最终答案用 $\\pi$ 和自然对数表示。请仅提供这个 $V_{11}$ 作为您的最终答案，并以闭合形式的解析表达式给出（无数值舍入）。", "solution": "出发点是内部区域带有齐次源项的拉普拉斯方程，\n$$\n-\\Delta u = 0 \\quad \\text{in } \\Omega,\n$$\n以及在 $\\partial \\Omega \\setminus \\Gamma$ 上的齐次狄利克雷边界条件。在 $\\Gamma$ 上，我们通过单层势表示法与外部拉普拉斯问题耦合。传输条件是内部势的迹等于由单层势引起的外部迹，即在 $\\Gamma$ 上 $\\gamma u = V\\lambda$，其中单层算子 $V$ 定义为\n$$\n(V\\lambda)(x) = \\int_{\\Gamma} G(x,y)\\,\\lambda(y)\\,\\mathrm{d}s_{y}, \\quad G(x,y) = -\\frac{1}{2\\pi}\\ln|x-y|.\n$$\n我们通过用边界测试函数 $\\mu$ 进行测试来弱施加此约束，并要求\n$$\n\\langle \\mu,\\gamma u - V\\lambda \\rangle_{\\Gamma} = 0.\n$$\n\n为了推导耦合变分形式，令 $V(\\Omega)$ 表示在 $\\partial \\Omega \\setminus \\Gamma$ 上为零的 $H^{1}(\\Omega)$ 函数的子空间。取 $v \\in V(\\Omega)$ 作为内部测试函数，$\\mu \\in H^{-1/2}(\\Gamma)$ (在实践中为离散迹空间) 作为边界测试函数，则内部弱形式（根据 Green 恒等式）为\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v\\,\\mathrm{d}x = 0 \\quad \\text{for all } v \\in V(\\Omega),\n$$\n且耦合约束为\n$$\n\\int_{\\Gamma} \\mu\\,\\gamma u\\,\\mathrm{d}s - \\int_{\\Gamma} \\mu\\,(V\\lambda)\\,\\mathrm{d}s = 0 \\quad \\text{for all } \\mu.\n$$\n综合起来，全局变分问题是：求 $(u,\\lambda) \\in V(\\Omega) \\times H^{-1/2}(\\Gamma)$ 使得\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v\\,\\mathrm{d}x \\;+\\; \\int_{\\Gamma} \\mu\\,\\gamma u\\,\\mathrm{d}s \\;-\\; \\int_{\\Gamma} \\mu\\,(V\\lambda)\\,\\mathrm{d}s \\;=\\; 0\n$$\n对所有 $(v,\\mu) \\in V(\\Omega) \\times H^{-1/2}(\\Gamma)$ 成立。如果存在内部强迫项 $f \\in H^{-1}(\\Omega)$，则右端项将是 $\\langle f, v\\rangle$，但这里是 $0$。\n\n我们现在用以下方法进行离散化：\n- 在单个三角形上的 $P_{1}$ 有限元空间，其节点基为 $\\{\\varphi_{1},\\varphi_{2},\\varphi_{3}\\}$，对应于顶点 $(0,0)$、$(1,0)$ 和 $(0,1)$，\n- 在 $\\Gamma$ 上的分片常数边界元空间，其基函数为一个 $\\psi_{1}$，其中对 $x \\in \\Gamma$ 有 $\\psi_{1}(x) \\equiv 1$。\n\n写出 $u_{h} = \\sum_{j=1}^{3} \\mathbf{u}_{j}\\,\\varphi_{j}$ 和 $\\lambda_{h} = \\boldsymbol{\\lambda}_{1}\\,\\psi_{1}$。用 $v_{h} = \\varphi_{i}$ 和 $\\mu_{h} = \\psi_{1}$ 进行测试，得到块形式的离散系统：\n$$\n\\begin{pmatrix}\nA & B^{\\top} \\\\\nB & -V\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{u} \\\\\n\\boldsymbol{\\lambda}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{f} \\\\\n\\mathbf{0}\n\\end{pmatrix},\n$$\n其矩阵块由以下双线性形式定义：\n- 内部刚度矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$，其元素为\n$$\nA_{ij} = \\int_{\\Omega} \\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j}\\,\\mathrm{d}x.\n$$\n- FEM-BEM 耦合矩阵 $B \\in \\mathbb{R}^{1 \\times 3}$，其元素为\n$$\nB_{1j} = \\int_{\\Gamma} \\psi_{1}\\,(\\gamma \\varphi_{j})\\,\\mathrm{d}s = \\int_{\\Gamma} \\varphi_{j}\\,\\mathrm{d}s,\n$$\n因为在 $\\Gamma$ 上 $\\psi_{1} \\equiv 1$。\n- 单层矩阵 $V \\in \\mathbb{R}^{1 \\times 1}$，其元素为\n$$\nV_{11} = \\int_{\\Gamma}\\int_{\\Gamma} G(x,y)\\,\\psi_{1}(x)\\,\\psi_{1}(y)\\,\\mathrm{d}s_{x}\\,\\mathrm{d}s_{y} = \\int_{\\Gamma}\\int_{\\Gamma} G(x,y)\\,\\mathrm{d}s_{x}\\,\\mathrm{d}s_{y}.\n$$\n\n我们确定所需的几何量。斜边 $\\Gamma$ 是从 $(1,0)$ 到 $(0,1)$ 的直线段，其长度为\n$$\nL = \\sqrt{(1-0)^{2} + (0-1)^{2}} = \\sqrt{2}.\n$$\n由于边界元空间在 $\\Gamma$ 上是常数，并且核函数 $G(x,y)$ 仅取决于欧氏距离 $|x-y|$，我们可以用弧长参数化 $\\Gamma$。设 $s \\in [0,L]$ 是沿 $\\Gamma$ 的弧长坐标；类似地，$t \\in [0,L]$。则\n$$\nV_{11} \\;=\\; \\int_{0}^{L}\\int_{0}^{L} G(s,t)\\,\\mathrm{d}t\\,\\mathrm{d}s \\;=\\; -\\frac{1}{2\\pi}\\int_{0}^{L}\\int_{0}^{L} \\ln|s-t|\\,\\mathrm{d}t\\,\\mathrm{d}s.\n$$\n定义\n$$\nI(L) := \\int_{0}^{L}\\int_{0}^{L} \\ln|s-t|\\,\\mathrm{d}t\\,\\mathrm{d}s.\n$$\n我们显式计算 $I(L)$。根据对称性，\n$$\nI(L) = 2\\int_{0}^{L}\\int_{0}^{s} \\ln(s-t)\\,\\mathrm{d}t\\,\\mathrm{d}s.\n$$\n在内层积分中使用换元 $u = s-t$，当 $t=0 \\Rightarrow u=s$ 且 $t=s \\Rightarrow u=0$ 时，得到\n$$\nI(L) = 2\\int_{0}^{L}\\left(\\int_{0}^{s} \\ln u\\,\\mathrm{d}u\\right)\\mathrm{d}s.\n$$\n不定积分是 $\\int \\ln u\\,\\mathrm{d}u = u\\ln u - u$。因此，\n$$\nI(L) = 2\\int_{0}^{L} \\big[s\\ln s - s\\big]\\,\\mathrm{d}s.\n$$\n我们使用 $\\int s\\ln s\\,\\mathrm{d}s = \\frac{s^{2}}{2}\\ln s - \\frac{s^{2}}{4}$ 和 $\\int s\\,\\mathrm{d}s = \\frac{s^{2}}{2}$ 来计算剩余的积分：\n$$\nI(L) = 2\\left[\\left(\\frac{s^{2}}{2}\\ln s - \\frac{s^{2}}{4}\\right) - \\frac{s^{2}}{2}\\right]_{0}^{L}\n= 2\\left[\\frac{s^{2}}{2}\\ln s - \\frac{3}{4}s^{2}\\right]_{0}^{L}.\n$$\n使用 $\\lim_{s\\to 0^{+}} s^{2}\\ln s = 0$，我们得到闭合形式\n$$\nI(L) = L^{2}\\ln L - \\frac{3}{2}L^{2}.\n$$\n因此，\n$$\nV_{11} = -\\frac{1}{2\\pi}\\,I(L) \\;=\\; -\\frac{1}{2\\pi}\\left(L^{2}\\ln L - \\frac{3}{2}L^{2}\\right).\n$$\n对于我们的几何结构，$L = \\sqrt{2}$，因此 $L^{2} = 2$ 且 $L^{2}\\ln L = 2\\ln(\\sqrt{2}) = 2\\cdot \\frac{1}{2}\\ln 2 = \\ln 2$。代入得到\n$$\nV_{11} = -\\frac{1}{2\\pi}\\left(\\ln 2 - 3\\right) = \\frac{3 - \\ln 2}{2\\pi}.\n$$\n\n为了完整起见，我们还确定耦合矩阵 $B$ 的非零元素。沿着 $\\Gamma$，节点基函数的迹在端点之间是线性的。具体来说，$\\varphi_{2}$ 在 $(1,0)$ 处等于 $1$，在 $(0,1)$ 处等于 $0$；$\\varphi_{3}$ 在 $(1,0)$ 处等于 $0$，在 $(0,1)$ 处等于 $1$；而 $\\varphi_{1}$ 在 $\\Gamma$ 上为零。因此，\n$$\nB_{1,1} = \\int_{\\Gamma} \\varphi_{1}\\,\\mathrm{d}s = 0,\\quad\nB_{1,2} = \\int_{\\Gamma} \\varphi_{2}\\,\\mathrm{d}s = \\frac{L}{2} = \\frac{\\sqrt{2}}{2},\\quad\nB_{1,3} = \\int_{\\Gamma} \\varphi_{3}\\,\\mathrm{d}s = \\frac{L}{2} = \\frac{\\sqrt{2}}{2}.\n$$\n刚度矩阵 $A$ 是映射到 $\\Omega$ 的参考三角形上的标准 $3\\times 3$ $P_{1}$ 单元刚度，其元素为 $A_{ij} = \\int_{\\Omega} \\nabla \\varphi_{i}\\cdot \\nabla \\varphi_{j}\\,\\mathrm{d}x$。这些辨识工作完成了块系统的推导和单层矩阵元素的显式计算。所要求的闭合形式的值是 $V_{11} = \\frac{3 - \\ln 2}{2\\pi}$。", "answer": "$$\\boxed{\\frac{3-\\ln 2}{2\\pi}}$$", "id": "2551154"}, {"introduction": "在掌握了基本耦合之后，我们转向更灵活且功能强大的 Nitsche 型耦合方法，这种方法通过弱形式施加边界和界面条件。本练习[@problem_id:2551191]探讨了如何为 FEM-BEM 耦合推导出一个对称的 Nitsche 公式，并重点关注其稳定性。您需要运用迹不等式等分析工具，从量纲和稳定性的角度确定罚参数 $\\alpha(h,\\kappa)$ 的正确缩放关系，这是确保数值方法鲁棒性的关键一步。", "problem": "考虑一个在有界 Lipschitz 区域 $\\Omega \\subset \\mathbb{R}^{d}$（其单位外法向量为 $\\boldsymbol{n}$）与无界外部区域 $\\Omega^{\\mathrm{ext}} := \\mathbb{R}^{d} \\setminus \\overline{\\Omega}$ 之间的拉普拉斯算子模型传输问题。设 $u_{\\mathrm{int}}$ 在 $\\Omega$ 中求解内部扩散方程 $-\\nabla \\cdot \\left(\\kappa \\nabla u_{\\mathrm{int}}\\right) = f$（其中 $\\kappa > 0$ 为常扩散系数），设 $u_{\\mathrm{ext}}$ 在 $\\Omega^{\\mathrm{ext}}$ 中求解齐次拉普拉斯方程 $-\\Delta u_{\\mathrm{ext}} = 0$ 并满足无穷远处的标准辐射条件。在界面 $\\Gamma := \\partial \\Omega$ 上，物理传输条件要求狄利克雷迹的弱连续性和法向通量的平衡，\n$$\n\\gamma^{-} u_{\\mathrm{int}} = \\gamma^{+} u_{\\mathrm{ext}} \\quad \\text{on } \\Gamma, \n\\qquad\n-\\kappa \\,\\partial_{\\boldsymbol{n}}^{-} u_{\\mathrm{int}} = \\partial_{\\boldsymbol{n}}^{+} u_{\\mathrm{ext}} \\quad \\text{on } \\Gamma.\n$$\n此处 $\\gamma^{\\pm}$ 表示内部/外部迹算子，$\\partial_{\\boldsymbol{n}}^{\\pm}$ 表示相应的余法向导数。使用边界元法 (BEM) 消去外部场，以支持外部狄利克雷-诺伊曼映射 $S$，使得在 $\\Gamma$ 上有 $\\partial_{\\boldsymbol{n}}^{+} u_{\\mathrm{ext}} = S \\left( \\gamma^{+} u_{\\mathrm{ext}} \\right)$，并假设 $S$ 导出对称的边界双线性形式 $b(\\psi,\\chi) := \\langle S \\psi, \\chi \\rangle_{\\Gamma}$，其中 $\\psi,\\chi \\in H^{1/2}(\\Gamma)$。\n\n你使用有限元法 (FEM) 在参数为 $h>0$ 的拟一致、形状规则的网格上对内部区域进行离散化。你决定通过对狄利克雷连续性条件 $\\gamma^{-} u_{\\mathrm{int}} = \\gamma^{+} u_{\\mathrm{ext}}$ 进行 Nitsche 型弱施加来耦合 FEM 和 BEM，使用相容项和对称罚项来确保稳定性。从 $\\Omega$ 中的格林恒等式和通过 $S$ 的外部边界表示出发，推导一个对称的耦合变分格式，其界面双线性贡献具有“外部能量+相容项+罚项”的结构。你的推导必须基于以下几点进行论证：\n- $\\Gamma$ 上的传输条件 $-\\kappa \\,\\partial_{\\boldsymbol{n}}^{-} u_{\\mathrm{int}} = S\\left(\\gamma^{-} u_{\\mathrm{int}}\\right)$，\n- 网格族上的迹不等式，它对于分片 $H^{1}$ 函数 $v_{h}$，用 $h^{-1}\\|v_{h}\\|_{L^{2}(\\Omega)}^{2} + h \\|\\nabla v_{h}\\|_{L^{2}(\\Omega)}^{2}$ 控制 $\\|\\gamma v_{h}\\|_{L^{2}(\\Gamma)}^{2}$，\n- 以及最终得到的双线性形式的对称性。\n\n通过量纲平衡和关于依赖于网格的能量范数的矫顽性，推断出罚参数必须满足的关于 $h$ 和 $\\kappa$ 的网格尺度关系。用 $\\alpha(h,\\kappa)$ 表示乘以迹的界面 $L^{2}(\\Gamma)$ 内积的罚系数。以一个闭式符号表达式给出 $\\alpha(h,\\kappa)$ 的最终答案，该表达式用一个正的、无量纲的稳定常数 $\\theta$ 以及参数 $h$ 和 $\\kappa$ 表示。最终答案中不要包含任何中间步骤；只给出最终表达式。答案不需要四舍五入，且不得包含单位。", "solution": "该问题旨在为一个拉普拉斯传输问题的有限元法 (FEM) 和边界元法 (BEM) 耦合推导一个对称的变分格式，并确定 Nitsche 型罚参数的尺度关系。\n\n首先，对问题陈述进行验证。\n\n第一步：提取已知条件\n-   内部区域：有界 Lipschitz 区域 $\\Omega \\subset \\mathbb{R}^{d}$。\n-   外部区域：$\\Omega^{\\mathrm{ext}} := \\mathbb{R}^{d} \\setminus \\overline{\\Omega}$。\n-   界面：$\\Gamma := \\partial \\Omega$，单位外法向量为 $\\boldsymbol{n}$。\n-   内部方程：$-\\nabla \\cdot \\left(\\kappa \\nabla u_{\\mathrm{int}}\\right) = f$，位于 $\\Omega$ 内，常扩散系数 $\\kappa > 0$。\n-   外部方程：$-\\Delta u_{\\mathrm{ext}} = 0$，位于 $\\Omega^{\\mathrm{ext}}$ 内，并满足无穷远处的辐射条件。\n-   $\\Gamma$ 上的传输条件：\n    1.  $\\gamma^{-} u_{\\mathrm{int}} = \\gamma^{+} u_{\\mathrm{ext}}$ (狄利克雷迹的连续性)。\n    2.  $-\\kappa \\,\\partial_{\\boldsymbol{n}}^{-} u_{\\mathrm{int}} = \\partial_{\\boldsymbol{n}}^{+} u_{\\mathrm{ext}}$ (法向通量的平衡)。\n-   BEM 表示：外部问题被简化为一个狄利克雷-诺伊曼 (DtN) 映射 $S$，使得在 $\\Gamma$ 上有 $\\partial_{\\boldsymbol{n}}^{+} u_{\\mathrm{ext}} = S(\\gamma^{+} u_{\\mathrm{ext}})$。\n-   DtN 映射性质：$S$ 导出一个对称的边界双线性形式 $b(\\psi,\\chi) := \\langle S \\psi, \\chi \\rangle_{\\Gamma}$，其中 $\\psi,\\chi \\in H^{1/2}(\\Gamma)$。\n-   离散化：对内部区域采用网格尺寸为 $h$ 的拟一致、形状规则的网格进行 FEM 离散。\n-   耦合方法：通过 Nitsche 型弱施加狄利克雷连续性进行耦合，要求一个对称的格式，其界面贡献结构为“外部能量+相容项+罚项”。\n-   论证工具：\n    1.  $\\Gamma$ 上的简化传输条件：$-\\kappa \\,\\partial_{\\boldsymbol{n}}^{-} u_{\\mathrm{int}} = S(\\gamma^{-} u_{\\mathrm{int}})$。\n    2.  一个反向迹不等式：对于 FEM 空间中的函数 $v_h$，$\\|\\gamma v_{h}\\|_{L^{2}(\\Gamma)}^{2}$ 由 $h^{-1}\\|v_{h}\\|_{L^{2}(\\Omega)}^{2} + h \\|\\nabla v_h\\|_{L^{2}(\\Omega)}^{2}$ 控制。\n-   目标：确定罚参数 $\\alpha(h,\\kappa)$ 的网格尺度关系，该参数乘以迹的 $L^2(\\Gamma)$ 内积。\n\n第二步：使用提取的已知条件进行验证\n该问题具有科学依据，描述了针对一个椭圆传输问题的标准 FEM-BEM 耦合过程。所有概念，包括 DtN 映射和 Nitsche 方法，在数值分析领域都是公认的。问题是适定的、客观的，提供了一套清晰的条件和一个具体的目标。不存在矛盾、信息缺失或伪科学元素。所提供的组件（格林恒等式、DtN 映射、迹不等式）是推导和分析此类方法的标准工具。因此，该问题是有效的。\n\n第三步：变分格式和罚参数的推导\n\n目标是在有限元空间 $V_h \\subset H^1(\\Omega)$ 中找到一个解 $u_h$，以逼近 $u_{\\mathrm{int}}$。我们首先推导内部问题的弱形式。令 $u$ 表示 $u_{\\mathrm{int}}$。将内部偏微分方程乘以一个测试函数 $v \\in V_h$ 并在 $\\Omega$ 上积分，我们应用格林第一恒等式：\n$$\n\\int_{\\Omega} \\kappa \\nabla u \\cdot \\nabla v \\, d\\boldsymbol{x} - \\int_{\\Gamma} \\kappa (\\nabla u \\cdot \\boldsymbol{n}) (\\gamma^{-} v) \\, dS = \\int_{\\Omega} f v \\, d\\boldsymbol{x}.\n$$\n这可以使用余法向导数记法写为：\n$$\n\\int_{\\Omega} \\kappa \\nabla u \\cdot \\nabla v \\, d\\boldsymbol{x} - \\langle \\kappa \\partial_{\\boldsymbol{n}}^{-} u, \\gamma^{-} v \\rangle_{\\Gamma} = \\int_{\\Omega} f v \\, d\\boldsymbol{x}.\n$$\n问题陈述指出，外部场通过 DtN 映射 $S$ 被消去。将传输条件 $\\gamma^{-} u_{\\mathrm{int}} = \\gamma^{+} u_{\\mathrm{ext}}$ 和 $-\\kappa \\partial_{\\boldsymbol{n}}^{-} u_{\\mathrm{int}} = \\partial_{\\boldsymbol{n}}^{+} u_{\\mathrm{ext}}$ 与 DtN 映射的定义 $\\partial_{\\boldsymbol{n}}^{+} u_{\\mathrm{ext}} = S(\\gamma^{+} u_{\\mathrm{ext}})$ 相结合，为 $u_{\\mathrm{int}}$ 在 $\\Gamma$ 上产生一个单一的 Robin 型边界条件：\n$$\n-\\kappa \\partial_{\\boldsymbol{n}}^{-} u = S(\\gamma^{-} u) \\quad \\text{或} \\quad \\kappa \\partial_{\\boldsymbol{n}}^{-} u + S(\\gamma^{-} u) = 0.\n$$\n将此代入精确解的弱形式，得到该耦合问题的标准伽辽金格式：\n$$\n\\int_{\\Omega} \\kappa \\nabla u \\cdot \\nabla v \\, d\\boldsymbol{x} + \\langle S(\\gamma^{-} u), \\gamma^{-} v \\rangle_{\\Gamma} = \\int_{\\Omega} f v \\, d\\boldsymbol{x}.\n$$\n使用记号 $b(\\psi, \\chi) = \\langle S\\psi, \\chi \\rangle_{\\Gamma}$，双线性形式为 $B_{Gal}(u,v) = \\int_{\\Omega} \\kappa \\nabla u \\cdot \\nabla v \\, d\\boldsymbol{x} + b(\\gamma^{-} u, \\gamma^{-} v)$。由于梯度项的对称性和 $b(\\cdot, \\cdot)$ 的假定对称性，该形式是对称的。\n\n问题要求一个 Nitsche 型的格式。这通常涉及在伽辽金格式中添加一些项以增强稳定性，特别是对于离散问题，但代价是引入一个依赖于网格的罚参数。用于对称地施加边界条件（例如 $u=g$）的 Nitsche 方法是在内部弱形式的基础上通过添加对称化项和罚项来构建的。对于一个一般的边界条件，这涉及到添加既相容（对于精确解为零）又确保矫顽性的项。\n\n可以构造一个用于弱施加 Robin 条件的对称 Nitsche 型格式。界面贡献被要求具有“外部能量+相容项+罚项”的形式。标准伽辽金形式已经包含了外部能量项 $b(\\gamma u_h, \\gamma v_h)$。通过添加一个罚项可以实现稳定的格式。需要一个简单、相容且对称的选择，通过迹来惩罚对边界条件的违反。\n\n让我们从量纲和稳定性的角度来分析罚参数 $\\alpha(h,\\kappa)$ 所需的尺度关系，这是问题的核心。罚项被给出为 $\\alpha(h,\\kappa) \\langle \\gamma u_h, \\gamma v_h \\rangle_{\\Gamma}$。为了使最终的离散系统是稳定的（矫顽的），罚项必须足够大，以控制分析中可能出现的边界积分所产生的负项，特别是那些涉及离散法向导数的项，或者在算子 $S$ 仅为半正定（例如，对于 $d=2$）时强制实现矫顽性。\n\n在 Nitsche 型方法的分析中，一个关键步骤涉及对像 $\\langle \\kappa \\partial_{\\boldsymbol{n}} v_h, \\gamma v_h \\rangle_{\\Gamma}$ 这样的边界项进行定界。利用柯西-施瓦茨不等式和一个标准的有限元函数反不等式 $\\|\\partial_{\\boldsymbol{n}} v_h\\|_{L^2(\\Gamma)} \\le C h^{-1/2} \\|\\nabla v_h\\|_{L^2(\\Omega)}$，可以证明：\n$$\n|\\langle \\kappa \\partial_{\\boldsymbol{n}} v_h, \\gamma v_h \\rangle_{\\Gamma}| \\le \\|\\kappa \\partial_{\\boldsymbol{n}} v_h\\|_{L^2(\\Gamma)} \\|\\gamma v_h\\|_{L^2(\\Gamma)} \\le (C \\kappa h^{-1/2} \\|\\nabla v_h\\|_{L^2(\\Omega)}) \\|\\gamma v_h\\|_{L^2(\\Gamma)}.\n$$\n应用杨氏不等式，对于任何 $\\epsilon > 0$：\n$$\n|\\langle \\kappa \\partial_{\\boldsymbol{n}} v_h, \\gamma v_h \\rangle_{\\Gamma}| \\le \\frac{\\epsilon}{2} \\kappa \\|\\nabla v_h\\|_{L^2(\\Omega)}^2 + \\frac{C^2 \\kappa}{2\\epsilon h} \\|\\gamma v_h\\|_{L^2(\\Gamma)}^2.\n$$\n一个 Nitsche 矫顽性证明通常包含来自双线性形式体积分部分的项 $\\kappa \\|\\nabla v_h\\|_{L^2(\\Omega)}^2$ 和罚项 $\\alpha \\|\\gamma v_h\\|_{L^2(\\Gamma)}^2$。由边界项分析产生的负项 $-\\frac{C^2 \\kappa}{\\epsilon h} \\|\\gamma v_h\\|_{L^2(\\Gamma)}^2$ 必须被罚项所控制。这要求 $\\alpha > \\frac{C^2 \\kappa}{\\epsilon h}$。因此，为确保稳定性，$\\alpha$ 必须与 $\\kappa/h$ 成正比。\n\n或者，进行量纲分析：罚项 $\\alpha \\langle \\gamma u_h, \\gamma v_h \\rangle_{\\Gamma}$ 必须具有能量的单位，与项 $\\int_{\\Omega} \\kappa (\\nabla u_h \\cdot \\nabla v_h) \\, d\\boldsymbol{x}$ 一致。令 $[X]$ 表示量 $X$ 的物理量纲。令 $[u]$ 为解的量纲（例如温度），$[L]$ 为长度的量纲。\n$$\n[\\alpha] [u]^2 [L]^{d-1} = [\\kappa] \\left( \\frac{[u]}{[L]} \\right)^2 [L]^d = [\\kappa] [u]^2 [L]^{d-2}.\n$$\n求解 $\\alpha$ 的量纲：\n$$\n[\\alpha] = \\frac{[\\kappa]}{[L]}.\n$$\n由于网格参数 $h$ 是离散模型中的特征长度尺度，罚参数 $\\alpha$ 必须与 $\\kappa/h$ 成正比。\n\n因此，罚参数 $\\alpha(h,\\kappa)$ 必须具有形式 $\\theta \\frac{\\kappa}{h}$，其中 $\\theta$ 是一个正的、无量纲的稳定常数，其选择需足够大以确保双线性形式在离散空间 $V_h$ 上的矫顽性。\n\n最终的表达式反映了这种尺度关系。", "answer": "$$\n\\boxed{\\theta \\frac{\\kappa}{h}}\n$$", "id": "2551191"}, {"introduction": "理论上的稳定性分析最终需要在数值实验中得到验证和体现。本练习[@problem_id:2551171]提供了一个绝佳的机会，通过一个简化的球谐谱模型来探索稳定性的实际意义。您将通过编程计算耦合系统矩阵的最小特征值，并观察它如何依赖于稳定化参数 $\\gamma$，从而直观地理解为何一个精心选择的参数是保证系统正定性和数值方法稳定性的基础。", "problem": "考虑一个建立在 $\\mathbb{R}^3$ 中单位球面上的、位于内部域和外部补集之间的拉普拉斯传输问题。令 $\\Omega \\subset \\mathbb{R}^3$ 表示单位球，$\\Gamma = \\partial \\Omega$ 表示半径为 $1$ 的单位球面。内部场 $u$ 求解 $\\Omega$ 内的拉普拉斯方程，外部场 $u^{\\mathrm{ext}}$ 求解 $\\mathbb{R}^3 \\setminus \\overline{\\Omega}$ 内且在无穷远处衰减的拉普拉斯方程。内部问题和外部问题之间的耦合通过迹的连续性和法向通量的平衡在 $\\Gamma$ 上施加。\n\n一种有限元法 (FEM) 和边界元法 (BEM) 之间的稳定对称耦合可以通过结合以下几点导出：\n- 内部变分形式 $a(u,v) = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, dx$，\n- 通过带有迹算子（单层边界积分算子）$V : H^{-1/2}(\\Gamma) \\to H^{1/2}(\\Gamma)$ 的单层势的外部表示，\n- 通过一个惩罚参数 $\\gamma > 0$ 对连续性约束 $u|_{\\Gamma} = V \\phi$ 进行弱施加，该参数缩放边界上的 $L^2(\\Gamma)$ 内积。\n\n在单位球面上，球谐函数 $Y_{\\ell m}$ 构成 $L^2(\\Gamma)$ 的一组标准正交基，并且单层算子在该基下是对角的，其特征值已知。在一个使用以下模式匹配基的降阶谱伽辽金模型中：\n- 内部基函数 $u_{\\ell m}(x) = r^{\\ell} Y_{\\ell m}(\\hat{x})$（其在 $\\Omega$ 内是调和的），\n- 用于 BEM 未知密度的边界基函数 $\\phi_{\\ell m} = Y_{\\ell m}$，\n\n在进行归一化 $\\int_{\\Gamma} Y_{\\ell m}^2 \\, dS = 1$ 后，可以得到一个块对角代数系统，该系统按球谐函数的阶数 $\\ell \\in \\{0,1,2,\\dots,L\\}$ 和次数 $m \\in \\{-\\ell,\\dots,\\ell\\}$ 解耦。对于每个固定的 $\\ell$，与系数对 $\\left(u_{\\ell m}, \\phi_{\\ell m}\\right)$ 相关联的 $2 \\times 2$ 块具有以下形式\n$$\nK_{\\ell}(\\gamma) \\;=\\; \n\\begin{bmatrix}\n\\ell + \\gamma & -1 \\\\\n-1 & v_{\\ell}\n\\end{bmatrix},\n$$\n其中 $v_{\\ell}$ 是单位球面上阶数为 $\\ell$ 的单层边界积分算子 $V$ 的特征值，由下式给出\n$$\nv_{\\ell} \\;=\\; \\frac{1}{2\\ell + 1}.\n$$\n在所选基中，内部能量满足 $\\int_{\\Omega} |\\nabla (r^{\\ell} Y_{\\ell m})|^2 \\, dx = \\ell \\int_{\\Gamma} Y_{\\ell m}^2 \\, dS = \\ell$，并且由于所选的标准化和符号约定，FEM-BEM 耦合项简化为 $-1$ 项。\n\n将给定惩罚 $\\gamma$ 下的耦合稳定系统的最小特征值定义为 $K_{\\ell}(\\gamma)$ 的最小特征值在所有球谐函数块和所有次数上的最小值。由于对于一个固定的 $\\ell$，所有次数 $m$ 都是相同的副本，因此重数不改变最小值。因此，对于一个截断参数 $L \\in \\mathbb{N}$，我们关心的量是\n$$\n\\lambda_{\\min}^{(L)}(\\gamma) \\;=\\; \\min_{0 \\le \\ell \\le L} \\, \\lambda_{\\min}\\!\\left( K_{\\ell}(\\gamma) \\right),\n$$\n其中\n$$\n\\lambda_{\\min}\\!\\left( K_{\\ell}(\\gamma) \\right) \\;=\\; \\frac{(\\ell+\\gamma) + v_{\\ell} - \\sqrt{\\left((\\ell+\\gamma) - v_{\\ell}\\right)^2 + 4}}{2}.\n$$\n\n任务：\n- 从单位球面上的球谐函数的基本性质和单层边界积分算子的谱映射出发，构建一个程序。该程序通过计算上述闭式表达式并在 $\\ell \\in \\{0,\\dots,L\\}$ 上取最小值，来计算给定截断 $L$ 和稳定化参数 $\\gamma$ 下的 $\\lambda_{\\min}^{(L)}(\\gamma)$。\n- 根据稳定化 FEM-BEM 耦合的稳健性，解释当 $\\gamma$ 变化时 $\\lambda_{\\min}^{(L)}(\\gamma)$ 的行为。特别是，讨论每个 $K_{\\ell}(\\gamma)$ 矩阵正定性关于 $\\gamma$ 和 $L$ 的条件，以及这如何影响全局最小值。\n\n您的程序必须实现以下测试套件，其中截断参数 $L = 8$，稳定化参数为\n- $\\gamma \\in \\{\\,0,\\;0.1,\\;1.0,\\;5.0,\\;9.0,\\;9.1,\\;20.0\\,\\}$。\n\n对于测试套件中的每个 $\\gamma$，计算如上定义的单个浮点值 $\\lambda_{\\min}^{(L)}(\\gamma)$。将结果汇总到一行，形式为方括号内以逗号分隔的列表。输出中的每个浮点数必须四舍五入到小数点后 $8$ 位。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按给定 $\\gamma$ 值精确顺序排列的结果，形式为方括号内以逗号分隔的列表，例如\n$$\n[\\text{result}_{1},\\text{result}_{2},\\dots,\\text{result}_{7}],\n$$\n其中每个 $\\text{result}_{k}$ 四舍五入到小数点后 8 位。\n此计算不涉及物理单位，也没有出现角度。", "solution": "该问题陈述经验证是科学可靠、适定且客观的。它为单位球面上的拉普拉斯传输问题提供了一种稳定的对称 FEM-BEM 耦合公式的标准谱分析。所有提供的数学定义和公式都是正确的，并与计算数学中的既定理论一致。\n\n任务是计算一个离散耦合系统的最小特征值并解释其行为。所考虑的系统由一组 $2 \\times 2$ 块矩阵表示，每个球谐函数阶数 $\\ell \\in \\{0, 1, \\dots, L\\}$ 对应一个。对于固定的阶数 $\\ell$ 和稳定化参数 $\\gamma$，该矩阵由下式给出：\n$$\nK_{\\ell}(\\gamma) \\;=\\; \n\\begin{bmatrix}\n\\ell + \\gamma & -1 \\\\\n-1 & v_{\\ell}\n\\end{bmatrix}\n$$\n其中 $v_{\\ell} = \\frac{1}{2\\ell + 1}$ 是阶数为 $\\ell$ 的模态对应的单层边界积分算子的特征值。该矩阵的特征值是其特征多项式 $\\det(K_{\\ell}(\\gamma) - \\lambda I) = 0$ 的根。较小的特征值由以下显式公式给出：\n$$\n\\lambda_{\\min}\\!\\left( K_{\\ell}(\\gamma) \\right) \\;=\\; \\frac{(\\ell+\\gamma) + v_{\\ell} - \\sqrt{\\left((\\ell+\\gamma) - v_{\\ell}\\right)^2 + 4}}{2}\n$$\n我们寻求在给定截断水平 $L$ 下，所有考虑的模态中的全局最小特征值：\n$$\n\\lambda_{\\min}^{(L)}(\\gamma) \\;=\\; \\min_{0 \\le \\ell \\le L} \\, \\lambda_{\\min}\\!\\left( K_{\\ell}(\\gamma) \\right)\n$$\n\n系统矩阵的一个基本性质是其正定性，这是数值方法的稳定性和唯一可解性所必需的。一个对称矩阵是正定的，当且仅当其所有特征值都严格为正。对于 $2 \\times 2$ 矩阵 $K_{\\ell}(\\gamma)$，这等价于其所有主子式均为正。\n第一个主子式是左上角的元素 $\\ell + \\gamma$。由于 $\\ell \\ge 0$ 并且问题考虑 $\\gamma \\ge 0$，该子式是正的，除了 $\\ell=0, \\gamma=0$ 的边界情况。\n第二个主子式是矩阵的行列式：\n$$\n\\det(K_{\\ell}(\\gamma)) \\;=\\; (\\ell + \\gamma)v_{\\ell} - 1\n$$\n为使 $K_{\\ell}(\\gamma)$ 是正定的，我们需要 $\\det(K_{\\ell}(\\gamma)) > 0$。代入 $v_{\\ell} = \\frac{1}{2\\ell + 1}$：\n$$\n(\\ell + \\gamma)\\frac{1}{2\\ell + 1} - 1 > 0 \\quad \\implies \\quad \\ell + \\gamma > 2\\ell + 1 \\quad \\implies \\quad \\gamma > \\ell + 1\n$$\n全局系统矩阵是块对角矩阵，其块为 $K_{\\ell}(\\gamma)$，它正定的充要条件是每个块都是正定的。这要求条件 $\\gamma > \\ell + 1$ 对所有 $\\ell \\in \\{0, 1, \\dots, L\\}$ 都成立。最严格的情况出现在最高阶数 $\\ell = L$ 时。因此，整个系统保证是正定的，当且仅当：\n$$\n\\gamma > L + 1\n$$\n这个条件对于稳定化 FEM-BEM 耦合的稳健性具有直接而关键的解释。\n1. 如果 $\\gamma > L+1$，系统是正定的。所有特征值 $\\lambda_{\\min}(K_{\\ell}(\\gamma))$ 均为正，因此 $\\lambda_{\\min}^{(L)}(\\gamma) > 0$。数值方法是稳定的。\n2. 如果 $\\gamma \\le L+1$，则至少存在一个索引为 $\\ell$ 的块（具体来说，是任何满足 $\\ell \\ge \\gamma - 1$ 的 $\\ell$），其行列式 $\\det(K_{\\ell}(\\gamma)) \\le 0$。非正的行列式意味着至少有一个特征值是非正的。因此，全局最小特征值 $\\lambda_{\\min}^{(L)}(\\gamma)$ 将是非正的。这标志着数值模型失去了稳定性。\n3. 在临界阈值 $\\gamma = L+1$ 时，我们有 $\\det(K_L(L+1)) = (L + (L+1))v_L - 1 = (2L+1)\\frac{1}{2L+1} - 1 = 0$。该块有一个零特征值。对于所有 $\\ell < L$，我们有 $\\gamma = L+1 > \\ell+1$，因此 $\\det(K_{\\ell}(\\gamma)) > 0$。所以，系统的最小特征值恰好为零：$\\lambda_{\\min}^{(L)}(L+1) = 0$。\n\n该分析表明，稳定化参数 $\\gamma$ 必须选择得足够大，以克服耦合中固有的不稳定性，其所需的大小直接取决于离散化的谱分辨率 $L$。这是惩罚法和稳定化方法的一个典型特征。\n\n为指定的测试套件（$L=8$ 和各种 $\\gamma$）找到 $\\lambda_{\\min}^{(L)}(\\gamma)$ 的计算过程如下：\n对于每个给定的 $\\gamma$ 值：\n1. 初始化一个变量 `current_min_lambda` 为一个大的正数。\n2. 遍历从 $0$ 到 $L=8$ 的所有整数模态阶数 $\\ell$。\n3. 在每次迭代中，计算 $v_{\\ell} = \\frac{1}{2\\ell + 1}$。\n4. 使用提供的公式计算该模态的最小特征值 $\\lambda_{\\min}(K_{\\ell}(\\gamma))$。\n5. 更新 `current_min_lambda = min(current_min_lambda, \\lambda_{\\min}(K_{\\ell}(\\gamma)))$。\n6. 遍历所有 $\\ell$ 后，`current_min_lambda` 的最终值即为结果 $\\lambda_{\\min}^{(8)}(\\gamma)$。\n此过程在所提供的程序中实现。", "answer": "[-1.00000000,-0.95138782,-0.61803399,-0.20871215,0.00000000,0.00539134,0.30153833]", "id": "2551171"}]}