{"hands_on_practices": [{"introduction": "边界元法 (BEM) 的威力在于将定义在整个求解域上的偏微分方程问题，转化为仅在其边界上定义的积分方程问题。本练习将引导您完成其核心的推导过程，从格林第二恒等式出发，为拉普拉斯方程建立边界积分方程。通过对此方程进行离散化，您将构建出BEM的核心线性系统，并深入理解该方法中至关重要的奇异矩阵项的本质。[@problem_id:2560745]", "problem": "考虑一个有界单连通域 $\\Omega \\subset \\mathbb{R}^{2}$，其边界 $\\Gamma$ 为分段 $\\mathcal{C}^{1}$，单位外法向量为 $\\boldsymbol{n}$。考虑拉普拉斯方程的内部狄利克雷边值问题：求 $u$ 使得在 $\\Omega$ 中 $\\Delta u = 0$，且在 $\\Gamma$ 上 $u = \\bar{u}$，其中 $\\bar{u}$ 为给定的且足够光滑的函数。使用格林第二恒等式以及 $\\mathbb{R}^{2}$ 中拉普拉斯算子的自由空间基本解，即 $G(\\boldsymbol{x},\\boldsymbol{\\xi}) = -\\dfrac{1}{2\\pi}\\ln|\\boldsymbol{x}-\\boldsymbol{\\xi}|$，推导内部解的迹在趋近边界点时的极限所满足的直接边界积分方程。然后，通过以下步骤构建配置边界元法 (BEM)：\n- 将 $\\Gamma$ 离散化为 $N$ 个直线单元，其节点 $\\{\\boldsymbol{\\xi}_{i}\\}_{i=1}^{N}$ 沿 $\\Gamma$ 排列，\n- 使用与同一节点集相关的标量形函数 $\\{N_{j}\\}_{j=1}^{N}$ 来近似 $\\Gamma$ 上的边界势 $u$ 及其外法向导数 $q := \\partial u/\\partial n$，\n- 在节点配置点集 $\\{\\boldsymbol{\\xi}_{i}\\}_{i=1}^{N}$ 上强制满足边界积分方程。\n\n明确指出所产生的矩阵核及其在对角线上的极限解释。从第一性原理出发，讨论在对角线元素处如何处理核的奇异行为，区分弱奇异对数核和柯西主值核，并将对角系数 $c_{i}$ 与 $\\boldsymbol{\\xi}_{i}$ 处的局部内楔角 $\\theta_{i}$（以弧度为单位）联系起来。最后，对于 $\\Gamma$ 在点 $\\boldsymbol{\\xi}_{i}$ 处是局部光滑的（即 $\\theta_{i} = \\pi$）情况，给出对角系数 $c_{i}$ 的精确值。您的最终答案必须是一个数字。所有角度考虑均使用弧度。无需四舍五入。", "solution": "我们从格林第二恒等式开始：对于定义在区域 $\\Omega$（其边界为 $\\Gamma$，单位外法向量为 $\\boldsymbol{n}$）上的足够光滑的标量场 $u,v$，\n$$\n\\int_{\\Omega}\\left(u\\,\\Delta v - v\\,\\Delta u\\right)\\,\\mathrm{d}\\Omega\n=\n\\int_{\\Gamma}\\left(u\\,\\frac{\\partial v}{\\partial n} - v\\,\\frac{\\partial u}{\\partial n}\\right)\\,\\mathrm{d}\\Gamma.\n$$\n令 $v(\\boldsymbol{x}) = G(\\boldsymbol{x},\\boldsymbol{\\xi})$，其中 $G$ 是 $\\mathbb{R}^{2}$ 中拉普拉斯算子的自由空间基本解，\n$$\nG(\\boldsymbol{x},\\boldsymbol{\\xi}) = -\\frac{1}{2\\pi}\\ln|\\boldsymbol{x}-\\boldsymbol{\\xi}|,\n$$\n它满足 $\\Delta_{\\boldsymbol{x}} G(\\boldsymbol{x},\\boldsymbol{\\xi}) = \\delta(\\boldsymbol{x}-\\boldsymbol{\\xi})$。由于 $u$ 是调和函数，所以在 $\\Omega$ 中 $\\Delta u = 0$。对于任意固定的 $\\boldsymbol{\\xi}\\in \\Omega$，代入格林恒等式可得，\n$$\n\\int_{\\Omega} u(\\boldsymbol{x})\\,\\delta(\\boldsymbol{x}-\\boldsymbol{\\xi})\\,\\mathrm{d}\\Omega(\\boldsymbol{x})\n=\n\\int_{\\Gamma}\\left(u(\\boldsymbol{x})\\,\\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{\\xi})}{\\partial n(\\boldsymbol{x})} - G(\\boldsymbol{x},\\boldsymbol{\\xi})\\,\\frac{\\partial u(\\boldsymbol{x})}{\\partial n(\\boldsymbol{x})}\\right)\\,\\mathrm{d}\\Gamma(\\boldsymbol{x}).\n$$\n左边化简为 $u(\\boldsymbol{\\xi})$，因此对于 $\\boldsymbol{\\xi}\\in \\Omega$，\n$$\nu(\\boldsymbol{\\xi}) = \\int_{\\Gamma}\\left(u(\\boldsymbol{x})\\,\\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{\\xi})}{\\partial n(\\boldsymbol{x})} - q(\\boldsymbol{x})\\,G(\\boldsymbol{x},\\boldsymbol{\\xi})\\right)\\,\\mathrm{d}\\Gamma(\\boldsymbol{x}),\n$$\n其中 $q := \\partial u/\\partial n$。当 $\\boldsymbol{\\xi}$ 从内部趋近于 $\\boldsymbol{\\xi}_{0}\\in \\Gamma$ 时取极限，经典的层势跳跃关系给出“直接”形式的边界积分方程\n$$\nc(\\boldsymbol{\\xi}_{0})\\,u(\\boldsymbol{\\xi}_{0})\n+\n\\int_{\\Gamma} u(\\boldsymbol{x})\\,\\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{\\xi}_{0})}{\\partial n(\\boldsymbol{x})}\\,\\mathrm{d}\\Gamma(\\boldsymbol{x})\n=\n\\int_{\\Gamma} q(\\boldsymbol{x})\\,G(\\boldsymbol{x},\\boldsymbol{\\xi}_{0})\\,\\mathrm{d}\\Gamma(\\boldsymbol{x}),\n$$\n其中 $c(\\boldsymbol{\\xi}_{0})$ 是一个由 $\\boldsymbol{\\xi}_{0}$ 处的内楔角决定的几何系数：\n$$\nc(\\boldsymbol{\\xi}_{0}) = \\frac{\\theta(\\boldsymbol{\\xi}_{0})}{2\\pi},\n$$\n其中 $\\theta(\\boldsymbol{\\xi}_{0})$ 是 $\\Omega$ 在 $\\boldsymbol{\\xi}_{0}$ 处的内角（以弧度为单位）。对于光滑点，$\\theta(\\boldsymbol{\\xi}_{0}) = \\pi$，因此 $c(\\boldsymbol{\\xi}_{0}) = 1/2$。\n\n为了构建配置边界元法 (BEM)，将 $\\Gamma$ 划分为 $N$ 个直线边界单元 $\\{\\Gamma_{e}\\}_{e=1}^{N}$，其节点 $\\{\\boldsymbol{\\xi}_{i}\\}_{i=1}^{N}$ 沿 $\\Gamma$ 排列。引入与这些节点相关的标量形函数 $\\{N_{j}\\}_{j=1}^{N}$，并将边界场近似为\n$$\nu(\\boldsymbol{x}) \\approx \\sum_{j=1}^{N} N_{j}(\\boldsymbol{x})\\,u_{j}, \n\\qquad\nq(\\boldsymbol{x}) \\approx \\sum_{j=1}^{N} N_{j}(\\boldsymbol{x})\\,q_{j},\n\\quad \\boldsymbol{x}\\in \\Gamma.\n$$\n在配置点 $\\boldsymbol{\\xi}_{i}$（$i=1,\\dots,N$）上强制满足边界积分方程，得到\n$$\nc_{i}\\,u_{i} + \\sum_{j=1}^{N} \\left(\\int_{\\Gamma} N_{j}(\\boldsymbol{x})\\,\\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{\\xi}_{i})}{\\partial n(\\boldsymbol{x})}\\,\\mathrm{d}\\Gamma(\\boldsymbol{x})\\right) u_{j}\n=\n\\sum_{j=1}^{N} \\left(\\int_{\\Gamma} N_{j}(\\boldsymbol{x})\\,G(\\boldsymbol{x},\\boldsymbol{\\xi}_{i})\\,\\mathrm{d}\\Gamma(\\boldsymbol{x})\\right) q_{j}.\n$$\n定义影响矩阵\n$$\nH_{ij} := \\int_{\\Gamma} N_{j}(\\boldsymbol{x})\\,\\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{\\xi}_{i})}{\\partial n(\\boldsymbol{x})}\\,\\mathrm{d}\\Gamma(\\boldsymbol{x}), \n\\qquad\nG_{ij} := \\int_{\\Gamma} N_{j}(\\boldsymbol{x})\\,G(\\boldsymbol{x},\\boldsymbol{\\xi}_{i})\\,\\mathrm{d}\\Gamma(\\boldsymbol{x}),\n$$\n于是离散配置系统可写为\n$$\nc_{i}\\,u_{i} + \\sum_{j=1}^{N} H_{ij}\\,u_{j} = \\sum_{j=1}^{N} G_{ij}\\,q_{j}, \\quad i=1,\\dots,N.\n$$\n对于内部狄利克雷问题，边界值 $u_{j}$ 是已知的（来自 $u|_{\\Gamma}=\\bar{u}$），而未知量是 $\\{q_{j}\\}_{j=1}^{N}$。方程右边由已知的 $u_{j}$ 和矩阵 $H_{ij}$ 构成，而方程左边作用于未知量的矩阵为 $G_{ij}$。\n\n我们现在讨论奇异行为和对角项：\n\n1. 核 $G(\\boldsymbol{x},\\boldsymbol{\\xi}_{i}) = -\\dfrac{1}{2\\pi}\\ln|\\boldsymbol{x}-\\boldsymbol{\\xi}_{i}|$ 在 $\\boldsymbol{x}\\to \\boldsymbol{\\xi}_{i}$ 时是弱奇异的（对数奇异）。对于使得 $N_{j}$ 的支集包含 $\\boldsymbol{\\xi}_{i}$ 的 $j$，积分 $G_{ij}$ 是有限的，并且可以通过在直线单元上的解析积分或通过奇异性减法来精确计算。$G_{ij}$ 不会产生跳跃项；其奇异性是可积的。\n\n2. 核 $\\dfrac{\\partial G(\\boldsymbol{x},\\boldsymbol{\\xi}_{i})}{\\partial n(\\boldsymbol{x})}$ 在 $\\boldsymbol{x}\\to \\boldsymbol{\\xi}_{i}$ 时的行为类似于 $\\mathcal{O}(|\\boldsymbol{x}-\\boldsymbol{\\xi}_{i}|^{-1})$，并且必须在柯西主值的意义下进行解释。双层势的经典跳跃关系表明，在取从内部到边界的极限时，会得到一个额外的局部项 $c_{i}\\,u_{i}$，其中\n$$\nc_{i}=\\frac{\\theta_{i}}{2\\pi},\n$$\n其中 $\\theta_{i}$ 是 $\\Omega$ 在 $\\boldsymbol{\\xi}_{i}$ 处的内楔角（以弧度为单位）。在实践中，可以：\n- 将 $H_{ij}$ 作为主值积分进行计算，并显式处理 $c_{i}$，或者\n- 通过加上或减去 $c_{i}$ 将对角贡献归入 $H_{ii}$，从而使实现的 $H_{ii}$ 是有限的，并与跳跃关系一致。\n\n对于 $\\Gamma$ 上的一个光滑点，局部几何形状的内角为 $\\theta_{i}=\\pi$，因此\n$$\nc_{i}=\\frac{\\pi}{2\\pi}=\\frac{1}{2}.\n$$\n\n因此，在光滑边界配置点处的对角系数的精确值为 $c_{i} = 1/2$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2560745"}, {"introduction": "BEM模型的准确性在很大程度上取决于它如何处理像角点这样的几何不连续之处。本练习聚焦于边界积分方程中的“自由项”系数 $c(\\mathbf{x})$，揭示了它实际上是衡量局部边界几何的一个直接指标。通过从第一性原理出发推导一个通用角点的系数，您将理解为什么其正确的、与角度相关的取值对于保持数值解的一致性和准确性至关重要。[@problem_id:2560772]", "problem": "考虑二维空间中，在一个边界为 $\\Gamma$ 的有界多边形域 $\\Omega \\subset \\mathbb{R}^{2}$ 上的内部拉普拉斯问题，其中 $u$ 在 $\\Omega$ 内满足 $\\nabla^{2} u = 0$。设 $\\mathbf{x}_{0} \\in \\Gamma$ 是两条直边相交的一个角点，并设 $\\theta \\in (0,2\\pi)$ 表示 $\\Omega$ 在 $\\mathbf{x}_{0}$ 处的内角，以弧度为单位。基于格林第三恒等式的直接边界积分方程 (BIE) 是利用二维基本解 $U(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi}\\ln|\\mathbf{x}-\\mathbf{y}|$、$\\Gamma$ 上的外单位法向量 $\\mathbf{n}(\\mathbf{y})$ 以及法向导数 $q(\\mathbf{y}) = \\frac{\\partial u}{\\partial n}(\\mathbf{y})$ 建立的。当源点趋近于边界时，会出现一个系数 $c(\\mathbf{x}_{0})$ 乘以 $u(\\mathbf{x}_{0})$。\n\n从格林恒等式和基本解性质 $\\nabla^{2}_{\\mathbf{y}} U(\\mathbf{x},\\mathbf{y}) = -\\delta(\\mathbf{y}-\\mathbf{x})$ 出发，通过分析从 $\\Omega$ 中移除一个以 $\\mathbf{x}_{0}$ 为中心、半径为 $\\varepsilon$ 的小圆盘并在 $\\varepsilon \\to 0^{+}$ 时的极限过程，推导出 $c(\\mathbf{x}_{0})$ 关于内角 $\\theta$ 的表达式。然后，对于 $\\theta = \\frac{3\\pi}{2}$ 的凹角，计算 $c(\\mathbf{x}_{0})$ 的值。\n\n最后，简要说明在基于配置点的直接边界元法 (BEM) 对 BIE 的离散化中，该系数 $c(\\mathbf{x})$ 如何确定系统矩阵的正确对角元，并解释为何在角点处使用依赖于角度的值对于保证一致性至关重要。\n\n请以精确分数形式给出 $\\theta = \\frac{3\\pi}{2}$ 时 $c(\\mathbf{x}_{0})$ 的值。无需四舍五入，也无需单位。", "solution": "该问题要求在二维域 $\\Omega$ 的边界 $\\Gamma$ 上的一个角点 $\\mathbf{x}_{0}$ 处，推导直接边界积分方程 (BIE) 的系数 $c(\\mathbf{x}_{0})$。推导的起点是针对调和函数 $u$ (即 $\\nabla^{2} u = 0$) 的格林第二恒等式，以及拉普拉斯方程的基本解 $U(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi}\\ln|\\mathbf{x}-\\mathbf{y}|$。基本解的性质是 $\\nabla^{2}_{\\mathbf{y}} U(\\mathbf{x},\\mathbf{y}) = -\\delta(\\mathbf{y}-\\mathbf{x})$，其中 $\\delta$ 是狄拉克-德尔塔函数。\n\n格林第二恒等式表述为：\n$$ \\int_{\\Omega} \\left( u(\\mathbf{y}) \\nabla^{2}_{\\mathbf{y}} U(\\mathbf{x},\\mathbf{y}) - U(\\mathbf{x},\\mathbf{y}) \\nabla^{2}_{\\mathbf{y}} u(\\mathbf{y}) \\right) d\\Omega_{\\mathbf{y}} = \\int_{\\Gamma} \\left( u(\\mathbf{y}) \\frac{\\partial U(\\mathbf{x},\\mathbf{y})}{\\partial n_{\\mathbf{y}}} - U(\\mathbf{x},\\mathbf{y}) \\frac{\\partial u(\\mathbf{y})}{\\partial n_{\\mathbf{y}}} \\right) d\\Gamma_{\\mathbf{y}} $$\n对于域 $\\Omega$ 内的一个源点 $\\mathbf{x}$，代入 $\\nabla^{2}u = 0$ 和 $\\nabla^{2}_{\\mathbf{y}} U = -\\delta(\\mathbf{y}-\\mathbf{x})$，该恒等式变为：\n$$ \\int_{\\Omega} u(\\mathbf{y}) (-\\delta(\\mathbf{y}-\\mathbf{x})) d\\Omega_{\\mathbf{y}} = -u(\\mathbf{x}) $$\n令 $q(\\mathbf{y}) = \\frac{\\partial u}{\\partial n}(\\mathbf{y})$，我们得到对于 $\\mathbf{x} \\in \\Omega$ 的 $u(\\mathbf{x})$ 的积分表达式：\n$$ -u(\\mathbf{x}) = \\int_{\\Gamma} \\left( u(\\mathbf{y}) \\frac{\\partial U(\\mathbf{x},\\mathbf{y})}{\\partial n_{\\mathbf{y}}} - U(\\mathbf{x},\\mathbf{y}) q(\\mathbf{y}) \\right) d\\Gamma_{\\mathbf{y}} $$\n这通常被整理为：\n$$ u(\\mathbf{x}) = \\int_{\\Gamma} \\left( U(\\mathbf{x},\\mathbf{y}) q(\\mathbf{y}) - u(\\mathbf{y}) \\frac{\\partial U(\\mathbf{x},\\mathbf{y})}{\\partial n_{\\mathbf{y}}} \\right) d\\Gamma_{\\mathbf{y}} $$\n为了推导边界上源点 $\\mathbf{x}_{0}$ 的 BIE，我们必须处理核函数 $U$ 和 $\\frac{\\partial U}{\\partial n}$ 的奇异性。我们遵循从域中排除一个以 $\\mathbf{x}_{0}$ 为中心、半径为 $\\varepsilon$ 的小圆盘 $B(\\mathbf{x}_{0}, \\varepsilon)$ 的步骤。新的域为 $\\Omega_{\\varepsilon} = \\Omega \\setminus B(\\mathbf{x}_{0}, \\varepsilon)$。点 $\\mathbf{x}_{0}$ 在 $\\Omega_{\\varepsilon}$ 外部，因此狄拉克-德尔塔函数的筛选性质给出零。在 $\\Omega_{\\varepsilon}$ 上，以 $\\mathbf{x}_{0}$ 为源点的格林恒等式为：\n$$ 0 = \\int_{\\partial \\Omega_{\\varepsilon}} \\left( U(\\mathbf{x}_{0},\\mathbf{y}) q(\\mathbf{y}) - u(\\mathbf{y}) \\frac{\\partial U(\\mathbf{x}_{0},\\mathbf{y})}{\\partial n_{\\mathbf{y}}} \\right) d\\Gamma_{\\mathbf{y}} $$\n边界 $\\partial \\Omega_{\\varepsilon}$ 由原边界除去圆盘内部的部分（我们记为 $\\Gamma'$）和圆弧 $\\Gamma_{\\varepsilon} = \\partial B(\\mathbf{x}_{0}, \\varepsilon) \\cap \\Omega$ 组成。积分变为：\n$$ 0 = \\int_{\\Gamma'} \\left( U q - u \\frac{\\partial U}{\\partial n} \\right) d\\Gamma + \\int_{\\Gamma_{\\varepsilon}} \\left( U q - u \\frac{\\partial U}{\\partial n} \\right) d\\Gamma $$\n现在我们取 $\\varepsilon \\to 0$ 的极限。在此极限下，$\\Gamma'$ 上的积分变为 $\\Gamma$ 上的柯西主值 (p.v.) 积分：\n$$ \\lim_{\\varepsilon \\to 0} \\int_{\\Gamma'} (\\dots) d\\Gamma = \\text{p.v.} \\int_{\\Gamma} (\\dots) d\\Gamma $$\n我们必须计算圆弧 $\\Gamma_{\\varepsilon}$ 上积分的极限。让我们分别分析这两项。\n对于第一项，即包含 $U q$ 的项：在 $\\Gamma_{\\varepsilon}$ 上，有 $|\\mathbf{y}-\\mathbf{x}_{0}|=\\varepsilon$，因此 $U(\\mathbf{x}_{0},\\mathbf{y}) = -\\frac{1}{2\\pi}\\ln(\\varepsilon)$。弧 $\\Gamma_{\\varepsilon}$ 的长度为 $\\theta\\varepsilon$，其中 $\\theta$ 是角点 $\\mathbf{x}_{0}$ 处的内角。假设 $q(\\mathbf{y})$ 在 $\\mathbf{x}_{0}$ 附近有界，我们有：\n$$ \\lim_{\\varepsilon \\to 0} \\int_{\\Gamma_{\\varepsilon}} U q \\, d\\Gamma = \\lim_{\\varepsilon \\to 0} \\left( -\\frac{1}{2\\pi}\\ln(\\varepsilon) \\right) \\cdot (\\text{average } q) \\cdot (\\theta\\varepsilon) = 0 $$\n因为 $\\lim_{\\varepsilon \\to 0} \\varepsilon \\ln(\\varepsilon) = 0$。\n\n对于第二项，即包含 $-u \\frac{\\partial U}{\\partial n}$ 的项：在圆弧 $\\Gamma_{\\varepsilon}$ 上，相对于域 $\\Omega_{\\varepsilon}$ 的外单位法向量 $\\mathbf{n}$ 指向中心 $\\mathbf{x}_{0}$。它由 $\\mathbf{n} = -\\frac{\\mathbf{y}-\\mathbf{x}_{0}}{|\\mathbf{y}-\\mathbf{x}_{0}|}$ 给出。基本解的梯度为 $\\nabla_{\\mathbf{y}} U = -\\frac{1}{2\\pi} \\frac{\\mathbf{y}-\\mathbf{x}_{0}}{|\\mathbf{y}-\\mathbf{x}_{0}|^2}$。\n$U$ 的法向导数为：\n$$ \\frac{\\partial U}{\\partial n_{\\mathbf{y}}} = \\nabla_{\\mathbf{y}} U \\cdot \\mathbf{n} = \\left( -\\frac{1}{2\\pi} \\frac{\\mathbf{y}-\\mathbf{x}_{0}}{|\\mathbf{y}-\\mathbf{x}_{0}|^2} \\right) \\cdot \\left( -\\frac{\\mathbf{y}-\\mathbf{x}_{0}}{|\\mathbf{y}-\\mathbf{x}_{0}|} \\right) = \\frac{1}{2\\pi} \\frac{|\\mathbf{y}-\\mathbf{x}_{0}|^2}{|\\mathbf{y}-\\mathbf{x}_{0}|^3} = \\frac{1}{2\\pi|\\mathbf{y}-\\mathbf{x}_{0}|} $$\n在 $\\Gamma_{\\varepsilon}$ 上，有 $|\\mathbf{y}-\\mathbf{x}_{0}| = \\varepsilon$，因此 $\\frac{\\partial U}{\\partial n} = \\frac{1}{2\\pi\\varepsilon}$。假设 $u$ 在 $\\mathbf{x}_{0}$ 处是连续的，当 $\\varepsilon \\to 0$ 时，有 $u(\\mathbf{y}) \\to u(\\mathbf{x}_{0})$。该积分的极限是：\n$$ \\lim_{\\varepsilon \\to 0} \\int_{\\Gamma_{\\varepsilon}} -u(\\mathbf{y}) \\frac{\\partial U}{\\partial n} \\, d\\Gamma = \\lim_{\\varepsilon \\to 0} \\int_{\\Gamma_{\\varepsilon}} -u(\\mathbf{y}) \\frac{1}{2\\pi\\varepsilon} \\, d\\Gamma = \\lim_{\\varepsilon \\to 0} -u(\\mathbf{x}_{0}) \\frac{1}{2\\pi\\varepsilon} (\\theta\\varepsilon) = -u(\\mathbf{x}_{0}) \\frac{\\theta}{2\\pi} $$\n将这些极限代回到积分方程中：\n$$ 0 = \\text{p.v.} \\int_{\\Gamma} \\left( U q - u \\frac{\\partial U}{\\partial n} \\right) d\\Gamma - u(\\mathbf{x}_{0})\\frac{\\theta}{2\\pi} $$\n直接边界积分方程的标准形式写为：\n$$ c(\\mathbf{x}_{0})u(\\mathbf{x}_{0}) + \\int_{\\Gamma} u \\frac{\\partial U}{\\partial n} \\, d\\Gamma = \\int_{\\Gamma} U q \\, d\\Gamma $$\n其中积分是在主值意义下理解的。整理我们推导出的方程：\n$$ u(\\mathbf{x}_{0})\\frac{\\theta}{2\\pi} = \\text{p.v.} \\int_{\\Gamma} \\left( U q - u \\frac{\\partial U}{\\partial n} \\right) d\\Gamma \\implies u(\\mathbf{x}_{0})\\frac{\\theta}{2\\pi} + \\text{p.v.}\\int_{\\Gamma} u \\frac{\\partial U}{\\partial n} \\, d\\Gamma = \\text{p.v.}\\int_{\\Gamma} U q \\, d\\Gamma $$\n通过将其与标准 BIE 形式进行比较，我们确定系数 $c(\\mathbf{x}_{0})$：\n$$ c(\\mathbf{x}_{0}) = \\frac{\\theta}{2\\pi} $$\n该系数表示域在点 $\\mathbf{x}_{0}$ 处所张的角度占总圆周（$2\\pi$）的比例。对于光滑点，$\\theta=\\pi$，因此 $c(\\mathbf{x}_{0}) = \\frac{1}{2}$。对于内点，$\\theta=2\\pi$，因此 $c(\\mathbf{x}_{0})=1$。\n\n对于内角为 $\\theta = \\frac{3\\pi}{2}$ 的凹角，该系数为：\n$$ c(\\mathbf{x}_{0}) = \\frac{3\\pi/2}{2\\pi} = \\frac{3\\pi}{4\\pi} = \\frac{3}{4} $$\n\n在基于配置点的边界元法 (BEM) 中，BIE 在边界上的一组离散节点 $\\{\\mathbf{x}_i\\}$ 处被强制满足。这会产生一个线性代数方程组 $[H]\\{u\\} = [G]\\{q\\}$。系数矩阵 $[H]$ 由包含自由项系数 $c(\\mathbf{x}_i)$ 和核函数 $\\frac{\\partial U}{\\partial n}$ 积分的项组装而成。作用于未知向量 $\\{u\\}$ 的完整矩阵在节点 $i$ 处的对角元为 $\\hat{H}_{ii} = c(\\mathbf{x}_i) + \\text{p.v.}\\int_{\\Gamma_i} \\frac{\\partial U(\\mathbf{x}_i, \\mathbf{y})}{\\partial n_y} d\\Gamma_y$，其中 $\\Gamma_i$ 是包含节点 $\\mathbf{x}_i$ 的边界单元。因此，系数 $c(\\mathbf{x}_i)$ 是系统矩阵对角项的一个显式的、必要的组成部分。\n\n在角点处使用正确的、与角度相关的值 $c(\\mathbf{x}_i)$ 对保证一致性至关重要，因为该值是从格林恒等式推导出的控制积分方程的直接结果。它在数学上表示了配置点处的局部几何形状。使用不正确的值，例如假设各处都有 $c(\\mathbf{x}_i) = \\frac{1}{2}$，将意味着离散化方程不能正确地表示角点处的内在物理原理。这会给数值模型引入根本性误差，导致系统不一致和解不准确，尤其是在像角点这样的高梯度区域。BEM 的一致性依赖于每个离散方程都是对积分恒等式的忠实表示，为此，正确的几何因子 $c(\\mathbf{x}_i)$ 是不可或缺的。", "answer": "$$\n\\boxed{\\frac{3}{4}}\n$$", "id": "2560772"}, {"introduction": "理论通过实践得以升华。这个动手编程练习要求您将BEM概念应用于一个经典的圆形界面问题，在这种特定几何下，BEM方法尤其强大和高效。通过运用傅里叶分析，您将构建一个数值的狄利克雷-诺伊曼 (DtN) 映射，并对照已知的解析解来验证其准确性，从而切实地展示BEM在处理某些问题时的简洁与精确。[@problem_id:2560737]", "problem": "考虑平面中的二维拉普拉斯方程，其中半径为 $a$ 的圆形界面将内部圆盘 $\\Omega^{-}$ 与无界外部区域 $\\Omega^{+}$ 分开。令单位外法线 $\\mathbf{n}$ 从 $\\Omega^{-}$ 指向 $\\Omega^{+}$。势 $u$ 在 $\\Omega^{-}$ 和 $\\Omega^{+}$ 中均满足 $\\Delta u = 0$。在界面 $\\Gamma = \\{ (x,y) : x^{2} + y^{2} = a^{2} \\}$ 上，无源情况下的完美耦合连续性条件为迹的连续性 $u^{-}|_{\\Gamma} = u^{+}|_{\\Gamma}$ 和法向通量的平衡 $q^{-} + q^{+} = 0$，其中 $q^{\\pm} = \\partial u^{\\pm} / \\partial \\mathbf{n}$ 表示沿从 $\\Omega^{-}$ 指向 $\\Omega^{+}$ 的法线方向的法向导数。假设 $\\Omega^{+}$ 中的外部解在无穷远处衰减。\n\n仅从以下基本出发点开始：\n- 拉普拉斯算子的二维基本解 $G(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi} \\ln \\lvert \\mathbf{x} - \\mathbf{y} \\rvert$。\n- 格林恒等式以及调和函数的边界积分表示。\n- 单层势、双层势及其在光滑曲线上边界迹的定义。\n\n推导一个边界方程，该方程通过边界积分算子将圆上的给定狄利克雷数据 $u|_{\\Gamma}$ 与未知的外部诺伊曼数据 $q^{+}$ 耦合起来。将此方程特化到圆形界面的情况，并推导外部狄利克雷-诺伊曼映射在傅里叶模态 $\\cos(n\\theta)$ 上的作用，其中 $\\theta$ 是 $\\Gamma$ 上的极角，以弧度为单位。\n\n然后，实现一个数值格式，利用此边界积分耦合来施加外部区域的狄利克雷-诺伊曼映射。对于内部场，使用极坐标 $(r,\\theta)$ 中的解析调和多项式 $u^{-}(r,\\theta) = r^{n} \\cos(n\\theta)$；这提供了边界狄利克雷数据 $g(\\theta) = u^{-}(a,\\theta)$ 和内部法向通量 $q^{-}(\\theta) = \\partial u^{-}/\\partial r \\big|_{r=a}$。使用一个基于傅里叶、特化于圆的边界积分耦合实现，将 $g(\\theta)$ 映射到外部通量 $q^{+}(\\theta)$ 的近似值，并验证以下两点：\n- 数值施加的外部狄利克雷-诺伊曼映射与从第一性原理推导出的精确映射一致。\n- 耦合条件 $q^{-} + q^{+} = 0$ 在 $\\Gamma$ 上成立。\n\n您的程序必须：\n- 用 $N$ 个等距角 $\\theta_{j} = 2\\pi j / N$（其中 $j = 0,\\dots,N-1$，角度以弧度为单位）对圆 $\\Gamma$ 进行参数化，在这些点上对 $g(\\theta_{j})$ 进行采样，并使用特化于圆的边界积分耦合的傅里叶符号应用来计算数值外部诺伊曼数据 $q^{+}_{\\mathrm{num}}(\\theta_{j})$。\n- 根据您对圆的精确狄利克雷-诺伊曼映射的推导，计算与从 $u^{-}(r,\\theta) = r^{n}\\cos(n\\theta)$ 得到的 $g(\\theta)$ 相对应的精确外部诺伊曼数据 $q^{+}_{\\mathrm{exact}}(\\theta_{j})$。\n- 为每个测试用例报告两个标量误差：\n  1. 节点上外部狄利克雷-诺伊曼映射的最大绝对误差，$E_{\\mathrm{DtN}} = \\max_{j} \\lvert q^{+}_{\\mathrm{num}}(\\theta_{j}) - q^{+}_{\\mathrm{exact}}(\\theta_{j}) \\rvert$。\n  2. 耦合条件的最大绝对违反量，$E_{\\mathrm{cpl}} = \\max_{j} \\lvert q^{-}(\\theta_{j}) + q^{+}_{\\mathrm{num}}(\\theta_{j}) \\rvert$。\n\n测试套件：\n- 使用以下参数三元组 $(a,n,N)$：\n  1. $(a,n,N) = (1.0, 1, 128)$。\n  2. $(a,n,N) = (1.0, 5, 128)$。\n  3. $(a,n,N) = (2.0, 3, 128)$。\n  4. $(a,n,N) = (1.0, 30, 64)$。\n  5. $(a,n,N) = (1.0, 10, 16)$。\n这些分别涵盖了典型情况、高次谐波、不同半径、近奈奎斯特模态和欠分辨边缘情况。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每一项都是一个包含两个浮点数的列表 $[E_{\\mathrm{DtN}}, E_{\\mathrm{cpl}}]$，对应于按上述顺序列出的测试用例。例如：[[e1_dtn,e1_cpl],[e2_dtn,e2_cpl],...].\n\n不需要外部输入。所有角度都必须以弧度处理，不涉及任何物理单位；所有量均为无量纲。代码必须完全自包含，并能按提供的方式运行。", "solution": "该问题要求推导并数值实现一种边界积分方程（BIE）方法，以确定二维拉普拉斯方程在圆形界面上的外部狄利克雷-诺伊曼（DtN）映射。\n\n### 第 1 部分：边界积分方程的推导\n\n令 $\\Omega^{-}$ 为半径为 $a$ 的内部圆盘，$\\Omega^{+}$ 为无界外部区域。界面是圆 $\\Gamma$。势 $u$ 在 $\\Omega^{-}$ 和 $\\Omega^{+}$ 中是调和的，即 $\\Delta u = 0$。令 $g = u|_{\\Gamma}$ 为界面上的狄利克雷数据，令 $q^{\\pm} = \\partial u^{\\pm}/\\partial\\mathbf{n}$ 为法向导数，其中 $\\mathbf{n}$ 是从 $\\Omega^{-}$ 指出的外法线。\n\n对于区域 $\\Omega$ 内边界为 $\\partial\\Omega$ 的调和函数 $u$，格林第三恒等式为：\n$$\nu(\\mathbf{x}) = \\int_{\\partial\\Omega} \\left( G(\\mathbf{x}, \\mathbf{y}) \\frac{\\partial u}{\\partial \\mathbf{n}_{\\mathbf{y}}}(\\mathbf{y}) - u(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial \\mathbf{n}_{\\mathbf{y}}} \\right) dS_{\\mathbf{y}}, \\quad \\mathbf{x} \\in \\Omega\n$$\n其中 $G(\\mathbf{x}, \\mathbf{y}) = -\\frac{1}{2\\pi} \\ln|\\mathbf{x} - \\mathbf{y}|$ 是基本解，$\\mathbf{n}_{\\mathbf{y}}$ 是在 $\\mathbf{y} \\in \\partial\\Omega$ 处的外法线。\n\n我们将此恒等式应用于外部区域 $\\Omega^{+}$。$\\Omega^{+}$ 的边界是 $\\Gamma \\cup \\Gamma_{\\infty}$，其中 $\\Gamma_{\\infty}$ 是无穷远处的圆。在 $\\Gamma$ 上，指向 $\\Omega^{+}$ 外部的法向量是 $-\\mathbf{n}$。由于 $u^{+}$ 的衰减条件，来自 $\\Gamma_{\\infty}$ 的贡献为零。如果 $u^{+}$ 以 $\\mathcal{O}(1/|\\mathbf{x}|)$ 的速度衰减，则 $u_{\\infty}$ 项为零。我们假设一个对此问题而言更强的标准衰减条件，确保 $u \\to 0$ 在无穷远处。对 $\\Omega^{+}$ 中的 $u^{+}$ 以及点 $\\mathbf{x} \\in \\Omega^{+}$ 应用格林恒等式：\n$$\nu^{+}(\\mathbf{x}) = \\int_{\\Gamma} \\left( G(\\mathbf{x}, \\mathbf{y}) \\frac{\\partial u^{+}}{\\partial (-\\mathbf{n})}(\\mathbf{y}) - u^{+}(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial (-\\mathbf{n})} \\right) dS_{\\mathbf{y}}\n$$\n代入 $g=u^{+}|_{\\Gamma}$、$q^{+} = \\partial u^{+}/\\partial\\mathbf{n}$ 和 $\\partial/\\partial(-\\mathbf{n}) = -\\partial/\\partial\\mathbf{n}$：\n$$\nu^{+}(\\mathbf{x}) = \\int_{\\Gamma} \\left( -G(\\mathbf{x}, \\mathbf{y}) q^{+}(\\mathbf{y}) + g(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial \\mathbf{n}_{\\mathbf{y}}} \\right) dS_{\\mathbf{y}}\n$$\n我们定义单层势算子 $\\mathcal{S}_{\\Gamma}$ 和双层势算子 $\\mathcal{D}_{\\Gamma}$：\n$$\n(\\mathcal{S}_{\\Gamma} \\sigma)(\\mathbf{x}) = \\int_{\\Gamma} G(\\mathbf{x}, \\mathbf{y}) \\sigma(\\mathbf{y}) dS_{\\mathbf{y}}\n$$\n$$\n(\\mathcal{D}_{\\Gamma} \\mu)(\\mathbf{x}) = \\int_{\\Gamma} \\mu(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial \\mathbf{n}_{\\mathbf{y}}} dS_{\\mathbf{y}}\n$$\n因此，对于 $\\mathbf{x} \\in \\Omega^{+}$，$u^{+}$ 的表示为 $u^{+}(\\mathbf{x}) = -(\\mathcal{S}_{\\Gamma} q^{+})(\\mathbf{x}) + (\\mathcal{D}_{\\Gamma} g)(\\mathbf{x})$。\n\n为了得到一个边界积分方程，我们取极限，令 $\\mathbf{x}$ 从外部区域 $\\Omega^{+}$ 趋近于 $\\mathbf{p} \\in \\Gamma$。使用光滑边界上层势的标准跳跃关系：\n$$\n\\lim_{\\mathbf{x} \\to \\mathbf{p}^{+}} (\\mathcal{S}_{\\Gamma} \\sigma)(\\mathbf{x}) = (S_{\\Gamma} \\sigma)(\\mathbf{p})\n$$\n$$\n\\lim_{\\mathbf{x} \\to \\mathbf{p}^{+}} (\\mathcal{D}_{\\Gamma} \\mu)(\\mathbf{x}) = (K_{\\Gamma} \\mu)(\\mathbf{p}) + \\frac{1}{2}\\mu(\\mathbf{p})\n$$\n其中 $S_{\\Gamma}$ 和 $K_{\\Gamma}$ 是边界积分算子（势在 $\\Gamma$ 上的非奇异部分）。将这些极限应用于 $u^{+}$ 的表示：\n$$\ng(\\mathbf{p}) = -(S_{\\Gamma} q^{+})(\\mathbf{p}) + \\left((K_{\\Gamma} g)(\\mathbf{p}) + \\frac{1}{2}g(\\mathbf{p})\\right)\n$$\n整理后得到所需的边界积分方程，该方程将狄利克雷数据 $g$ 与外部诺伊曼数据 $q^{+}$ 耦合起来：\n$$\n\\left(\\frac{1}{2}I - K_{\\Gamma}\\right)g = -S_{\\Gamma} q^{+}\n$$\n\n### 第 2 部分：特化到圆及 DtN 映射\n\n对于半径为 $a$ 的圆形边界，算子 $S_{\\Gamma}$ 和 $K_{\\Gamma}$ 是卷积算子，并可被复傅里叶基 $\\{e^{ik\\theta}\\}_{k \\in \\mathbb{Z}}$ 对角化。我们求出它们的特征值（符号），记为 $\\hat{S}_k$ 和 $\\hat{K}_k$。\n$K_{\\Gamma}$ 的核函数为 $K(\\mathbf{x},\\mathbf{y}) = \\frac{\\partial G}{\\partial n_y} = -\\frac{1}{4\\pi a}$，其中 $\\mathbf{x}, \\mathbf{y} \\in \\Gamma$。其符号可求得为：\n$$\n\\hat{K}_k =\n\\begin{cases}\n-1/2  & \\text{若 } k=0 \\\\\n0  & \\text{若 } k \\neq 0\n\\end{cases}\n$$\n$S_{\\Gamma}$ 的核函数为 $G(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi} \\ln \\lvert \\mathbf{x} - \\mathbf{y} \\rvert = -\\frac{1}{2\\pi} \\ln \\left( 2a \\left|\\sin\\left(\\frac{\\theta'-\\theta}{2}\\right)\\right| \\right)$。其符号为：\n$$\n\\hat{S}_k =\n\\begin{cases}\n-a\\ln a  & \\text{若 } k=0 \\text{ 且 } a \\neq 1 \\\\\na/(2|k|)  & \\text{若 } k \\neq 0\n\\end{cases}\n$$\n当 $a=1$ 时，单位圆的容量在势论中导致对数奇异性，使得 $\\hat{S}_0=0$。这意味着数据需要满足一个相容性条件。\n\n傅里叶空间中的边界积分方程（BIE）成为关于傅里叶系数 $\\hat{g}_k$ 和 $\\hat{q}^{+}_k$ 的代数方程：\n$$\n(\\frac{1}{2} - \\hat{K}_k)\\hat{g}_k = -\\hat{S}_k \\hat{q}^{+}_k\n$$\n现在我们可以求解 $\\hat{q}^{+}_k$，它定义了 DtN 映射 $\\Lambda^{+}: g \\mapsto q^{+}$。\n\n对于 $k \\neq 0$：\n$$\n(\\frac{1}{2} - 0)\\hat{g}_k = -\\frac{a}{2|k|} \\hat{q}^{+}_k \\quad \\implies \\quad \\hat{q}^{+}_k = -\\frac{|k|}{a}\\hat{g}_k\n$$\n\n问题指定了从内部解 $u^{-}(r,\\theta)=r^n\\cos(n\\theta)$ 导出的边界数据，因此 $g(\\theta)=a^n\\cos(n\\theta)$。对于 $n>0$，该函数均值为零，所以 $\\hat{g}_0=0$，这又意味着 $\\hat{q}^{+}_0=0$。对于给定的测试用例，我们无需进一步分析 $k=0$ 的情况。\n\n我们来求 $\\Lambda^{+}$ 在 $g(\\theta) = a^n \\cos(n\\theta)$ 上的作用。\n$g(\\theta) = \\frac{a^n}{2}(e^{in\\theta} + e^{-in\\theta})$。其非零傅里叶系数为 $\\hat{g}_n = \\hat{g}_{-n} = \\frac{a^n}{2\\pi} \\pi = a^n/2$（在使用 $\\frac{1}{2\\pi}\\int$ 傅里叶变换约定的情况下）。为了适配 `numpy.fft` 的归一化，我们直接处理整个函数。\n对于 $g$ 的模态 $e^{in\\theta}$ 会映射到 $q^+$ 的模态 $-\\frac{|n|}{a}e^{in\\theta}$。线性性质意味着：\n$$\n\\Lambda^{+}(a^n\\cos(n\\theta)) = a^n \\Lambda^{+}(\\cos(n\\theta)) = a^n \\left( -\\frac{n}{a} \\cos(n\\theta) \\right) = -n a^{n-1} \\cos(n\\theta)\n$$\n这就是精确的外部诺伊曼数据 $q^{+}_{\\mathrm{exact}}(\\theta)$。\n\n### 第 3 部分：数值实现与验证\n\n数值格式按以下步骤进行：\n1. 用 $N$ 个点 $\\theta_j = 2\\pi j/N$ 对 $\\Gamma$ 进行离散化。采样 $g(\\theta_j) = a^n \\cos(n\\theta_j)$。\n2. 计算 $g$ 的离散傅里叶变换（DFT），得到 $\\hat{g}_k$。\n3. 在傅里叶空间中应用 DtN 映射：对每个波数 $k$，计算 $\\hat{q}^{+}_{k, \\text{num}} = - \\frac{|k|}{a} \\hat{g}_k$。对于 $k=0$，$\\hat{q}^{+}_{0, \\text{num}}=0$。\n4. 对 $\\hat{q}^{+}_{k, \\text{num}}$ 应用逆离散傅里叶变换（Inverse DFT），计算数值外部通量 $q^{+}_{\\mathrm{num}}$。\n5. 计算精确内部通量 $q^{-}(\\theta_j) = \\partial_r(r^n\\cos(n\\theta))|_{r=a} = na^{n-1}\\cos(n\\theta_j)$。\n6. 计算精确外部通量 $q^{+}_{\\mathrm{exact}}(\\theta_j) = -na^{n-1}\\cos(n\\theta_j) = -q^{-}(\\theta_j)$。\n7. 计算误差：\n   - $E_{\\mathrm{DtN}} = \\max_{j} \\lvert q^{+}_{\\mathrm{num}}(\\theta_{j}) - q^{+}_{\\mathrm{exact}}(\\theta_{j}) \\rvert$\n   - $E_{\\mathrm{cpl}} = \\max_{j} \\lvert q^{-}(\\theta_{j}) + q^{+}_{\\mathrm{num}}(\\theta_{j}) \\rvert$\n\n由于 $q^{-}(\\theta_j) = -q^{+}_{\\mathrm{exact}}(\\theta_j)$，这两个误差度量在数学上是等价的：\n$E_{\\mathrm{cpl}} = \\max_{j} \\lvert -q^{+}_{\\mathrm{exact}}(\\theta_{j}) + q^{+}_{\\mathrm{num}}(\\theta_{j}) \\rvert = E_{\\mathrm{DtN}}$。\n数值实现将证实这一点。误差来源于傅里叶变换的离散化和浮点运算。对于欠分辨情况（$n > N/2$），混叠将是主要的误差来源。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    This program implements a Fourier-based boundary integral method to solve for the\n    exterior Dirichlet-to-Neumann (DtN) map for the 2D Laplace equation on a circle.\n    It verifies the numerical DtN map against the exact analytical map for specific\n    harmonic boundary data derived from an interior solution.\n    \"\"\"\n\n    # Test suite: (a, n, N)\n    # a: radius of the circular interface\n    # n: mode number of the harmonic data (cos(n*theta))\n    # N: number of discretization points on the circle\n    test_cases = [\n        (1.0, 1, 128),\n        (1.0, 5, 128),\n        (2.0, 3, 128),\n        (1.0, 30, 64),\n        (1.0, 10, 16),\n    ]\n\n    results = []\n\n    for a, n, N in test_cases:\n        # 1. Discretize the boundary and define data from the interior problem.\n        # N equispaced points on the circle of radius a.\n        theta = 2 * np.pi * np.arange(N) / N\n\n        # The interior potential is u^-(r, theta) = r^n * cos(n*theta).\n        # This provides the Dirichlet data g(theta) on the boundary r=a.\n        g = (a**n) * np.cos(n * theta)\n\n        # The interior normal flux is q^-(theta) = du^-/dr |_(r=a).\n        # For n=0, q- is 0. For n>0, it is n*a^(n-1)*cos(n*theta).\n        if n == 0:\n            q_minus = np.zeros(N)\n        else:\n            q_minus = n * (a**(n - 1)) * np.cos(n * theta)\n\n        # 2. Compute the numerical exterior flux q_plus_num using BIE in Fourier space.\n        # The BIE relating exterior flux q+ to Dirichlet data g is:\n        # (1/2 * I - K) * g = -S * q+\n        # This implies the DtN map in Fourier space for mode k is:\n        # q_hat_k = -inv(S_k) * (1/2 - K_k) * g_hat_k\n        \n        g_hat = np.fft.fft(g)\n        k = np.fft.fftfreq(N) * N\n\n        # The DtN map symbol (eigenvalue) for mode k is -(k/a).\n        # For k=0, the map is more complex, but for mean-zero data, flux is mean-zero.\n        # Since n>0 for all test cases, g has zero mean, so g_hat[0] is zero.\n        # This implies q_plus_hat_num[0] is also zero.\n        \n        dtn_symbol = np.zeros(N, dtype=float)\n        k_nonzero_indices = np.where(k != 0)\n        k_nonzero = k[k_nonzero_indices]\n        dtn_symbol[k_nonzero_indices] = -np.abs(k_nonzero) / a\n        \n        q_plus_hat_num = dtn_symbol * g_hat\n\n        # Transform back to physical space. Result should be real.\n        q_plus_num = np.fft.ifft(q_plus_hat_num).real\n\n        # 3. Compute the exact exterior flux q_plus_exact.\n        # The exterior solution is u^+(r,theta) = a^(2n)*r^(-n)*cos(n*theta).\n        # q_plus_exact = du+/dr |_(r=a) = -n*a^(n-1)*cos(n*theta).\n        if n == 0:\n            q_plus_exact = np.zeros(N)\n        else:\n            q_plus_exact = -n * (a**(n - 1)) * np.cos(n * theta)\n        \n        # 4. Calculate errors.\n        # Error 1: DtN map error\n        e_dtn = np.max(np.abs(q_plus_num - q_plus_exact))\n\n        # Error 2: Coupling condition violation\n        e_cpl = np.max(np.abs(q_minus + q_plus_num))\n        \n        results.append([e_dtn, e_cpl])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(res) for res in results)}]\")\n\nsolve()\n```", "id": "2560737"}]}