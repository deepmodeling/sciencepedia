{"hands_on_practices": [{"introduction": "多尺度建模的基石是均匀化理论，其核心目标是为非均匀材料找到一个“有效”或“均匀化”的属性，以描述其宏观行为。以下练习 [@problem_id:2581861] 将通过一个简单但极具启发性的一维层状介质问题，指导您从第一性原理出发，亲手推导其等效导热系数。这个过程不仅能加深您对均匀化概念的理解，还将揭示串联结构中著名的“调和平均”规则的物理来源。", "problem": "考虑一个具有快速振荡电导率的非均匀介质的一维稳态扩散问题，\n$$-\\,\\frac{d}{dx}\\Big(A\\big(\\tfrac{x}{\\varepsilon}\\big)\\,\\frac{du^{\\varepsilon}}{dx}(x)\\Big) \\;=\\; 0 \\quad \\text{in } (0,L),$$\n其狄利克雷边界条件为 $u^{\\varepsilon}(0)=0$ 和 $u^{\\varepsilon}(L)=U$，其中 $\\varepsilon0$ 表示微观尺度，$A(y)$ 是一个正的 $Y$ 周期函数，周期 $Y=(0,1)$。假设在一个周期内，$A(y)$ 在 $m$ 个层上是分段常数：存在电导率 $\\{k_i\\}_{i=1}^{m}$ 和层厚度分数 $\\{f_i\\}_{i=1}^{m}$，满足 $f_i0$ 和 $\\sum_{i=1}^{m} f_i = 1$，使得在 $Y$ 内长度为 $f_i$ 的第 $i$ 个层区间中，$A(y)=k_i$。\n\n使用与有限元异构多尺度方法（FE-HMM）或多尺度有限元方法（MsFEM）一致的周期性均匀化框架，均匀化极限 $u^{0}$ 求解\n$$-\\,\\frac{d}{dx}\\!\\left(A^{\\text{hom}}\\frac{du^{0}}{dx}(x)\\right) \\;=\\; 0 \\quad \\text{in } (0,L),$$\n对于某个有效电导率 $A^{\\text{hom}}0$。从与施加单位宏观梯度相关的 $Y$ 上的标准一维周期性胞元问题出发，推导 $A^{\\text{hom}}$ 关于 $\\{k_i\\}_{i=1}^{m}$ 和 $\\{f_i\\}_{i=1}^{m}$ 的封闭形式表达式。你的推导必须从弱形式和胞元问题的定义开始，并通过强制施加跨层的周期性和通量连续性来进行。以 $\\{k_i\\}_{i=1}^{m}$ 和 $\\{f_i\\}_{i=1}^{m}$ 的形式，将你的最终结果表示为单个解析表达式。不需要进行数值代入，也不需要四舍五入。你的最终答案应不带单位。", "solution": "该问题陈述具有科学依据、问题适定且客观。它提出了周期性介质均匀化理论中的一个标准任务，这是多尺度建模中的一个核心课题。推导有效电导率所需的所有数据和条件均已提供。该问题是有效的。我们将着手进行推导。\n\n目标是确定给定一维稳态扩散问题的均匀化电导率 $A^{\\text{hom}}$：\n$$-\\,\\frac{d}{dx}\\Big(A\\big(\\tfrac{x}{\\varepsilon}\\big)\\,\\frac{du^{\\varepsilon}}{dx}(x)\\Big) \\;=\\; 0 \\quad \\text{for } x \\in (0,L)$$\n其中 $A(y)$ 是单位胞元 $Y=(0,1)$ 上的一个 $Y$ 周期函数。均匀化方程由下式给出：\n$$-\\,\\frac{d}{dx}\\!\\left(A^{\\text{hom}}\\frac{du^{0}}{dx}(x)\\right) \\;=\\; 0$$\n\n周期性均匀化的基础是解 $u^{\\varepsilon}(x)$ 的双尺度渐近展开。对于一维情况，我们寻求以下形式的近似解：\n$$ u^{\\varepsilon}(x) \\approx u^{0}(x) + \\varepsilon \\chi\\left(\\frac{x}{\\varepsilon}\\right) \\frac{du^0}{dx}(x) $$\n其中 $u^0(x)$ 是缓慢变化的宏观解，$\\chi(y)$ 是一个称为周期性修正子的 $Y$ 周期函数，而 $y=x/\\varepsilon$ 是快速（微观）变量。修正子 $\\chi(y)$ 捕捉了每个周期性胞元内解的微观振荡。\n\n该问题要求从施加单位宏观梯度的胞元问题开始推导。单位宏观梯度对应于设置 $\\frac{du^0}{dx}(x) = 1$。修正子 $\\chi(y)$ 的胞元问题是通过将双尺度展开代入原始微分方程并识别 $\\varepsilon^{-1}$ 阶的项来导出的。其强形式在 $Y=(0,1)$ 上产生以下胞元问题：\n$$ -\\frac{d}{dy}\\left( A(y) \\left( 1 + \\frac{d\\chi}{dy}(y) \\right) \\right) = 0 $$\n并服从 $\\chi(y)$ 的周期性边界条件，即 $\\chi(0) = \\chi(1)$。括号内的项 $1$ 来自于施加的单位宏观梯度。\n\n该方程表明，微观通量 $j(y) = -A(y) \\left( 1 + \\frac{d\\chi}{dy}(y) \\right)$ 相对于微观变量 $y$ 是一个常数。我们将此常数通量表示为 $j(y) = J$。\n均匀化系数 $A^{\\text{hom}}$ 定义为关联平均通量与平均梯度的系数。对于单位宏观梯度，均匀化通量为 $-A^{\\text{hom}}(1) = -A^{\\text{hom}}$。这必须等于微观通量在胞元上的平均值：\n$$ -A^{\\text{hom}} = \\langle j(y) \\rangle_Y = \\int_0^1 J \\, dy = J $$\n因此，有效电导率 $A^{\\text{hom}}$ 正是该常数微观通量的负值，即 $A^{\\text{hom}} = -J$。\n\n根据微观通量的定义，我们有：\n$$ -A^{\\text{hom}} = -A(y) \\left( 1 + \\frac{d\\chi}{dy}(y) \\right) $$\n可以重新整理以表达修正子的梯度：\n$$ 1 + \\frac{d\\chi}{dy}(y) = \\frac{A^{\\text{hom}}}{A(y)} $$\n为了求得 $A^{\\text{hom}}$，我们将此表达式在单位胞元 $Y=(0,1)$ 上积分：\n$$ \\int_0^1 \\left( 1 + \\frac{d\\chi}{dy}(y) \\right) dy = \\int_0^1 \\frac{A^{\\text{hom}}}{A(y)} dy $$\n左侧的积分为：\n$$ \\int_0^1 1 \\, dy + \\int_0^1 \\frac{d\\chi}{dy}(y) dy = 1 + \\big[\\chi(y)\\big]_0^1 = 1 + \\chi(1) - \\chi(0) $$\n由于修正子的周期性，$\\chi(1) = \\chi(0)$，此项简化为 $1$。\n右侧的积分为：\n$$ \\int_0^1 \\frac{A^{\\text{hom}}}{A(y)} dy = A^{\\text{hom}} \\int_0^1 \\frac{1}{A(y)} dy $$\n令两边相等，得到：\n$$ 1 = A^{\\text{hom}} \\int_0^1 \\frac{1}{A(y)} dy $$\n求解 $A^{\\text{hom}}$，我们得到一维情况下有效电导率的通用公式，即局部电导率的调和平均值：\n$$ A^{\\text{hom}} = \\left( \\int_0^1 \\frac{1}{A(y)} dy \\right)^{-1} $$\n对于通过串联层的输运，这个结果在物理上是符合预期的，因为其有效电阻是各个电阻之和。\n\n现在，我们将此公式应用于给定情况，其中介质由 $m$ 个层组成，在单位胞元内具有电导率 $\\{k_i\\}_{i=1}^{m}$ 和厚度分数 $\\{f_i\\}_{i=1}^{m}$，使得 $\\sum_{i=1}^{m} f_i = 1$。胞元上的积分变为各层上的总和：\n$$ \\int_0^1 \\frac{1}{A(y)} dy = \\sum_{i=1}^{m} \\int_{\\text{layer } i} \\frac{1}{k_i} dy $$\n在第 $i$ 层上 $\\frac{1}{k_i}$ 的积分就是 $\\frac{1}{k_i}$ 乘以该层的区间长度，即其厚度分数 $f_i$。因此，\n$$ \\int_0^1 \\frac{1}{A(y)} dy = \\sum_{i=1}^{m} \\frac{f_i}{k_i} $$\n将此结果代回 $A^{\\text{hom}}$ 的表达式，得到最终的封闭形式表达式：\n$$ A^{\\text{hom}} = \\left( \\sum_{i=1}^{m} \\frac{f_i}{k_i} \\right)^{-1} $$\n这是各层电导率的调和平均值，由其各自的厚度分数加权。", "answer": "$$\\boxed{\\left(\\sum_{i=1}^{m} \\frac{f_i}{k_i}\\right)^{-1}}$$", "id": "2581861"}, {"introduction": "在掌握了均匀化的基本理论后，下一步是将其应用于具体的数值算法中。多尺度有限元法（MsFEM）等先进技术，通过将微观尺度信息直接嵌入到有限元基函数中，实现了理论与计算的桥接。本练习 [@problem_id:2581803] 将引导您为一个一维问题构建这些特殊的基函数，并利用它们计算解，从而直观地展示局部物理效应如何被粗尺度网格精确捕捉。", "problem": "考虑域 $\\Omega = [0,1]$ 上的一个一维稳态扩散问题，其具有由 $a(x/\\epsilon)$ 给出的快速振荡的非均匀传导系数，控制方程的强形式为 $-\\dfrac{d}{dx}\\!\\left(a\\!\\left(\\dfrac{x}{\\epsilon}\\right)\\dfrac{du}{dx}\\right)=0$，其中 $x\\in (0,1)$，并服从狄利克雷边界条件 $u(0)=1$ 和 $u(1)=0$。假设已经进行了无量纲化，因此所有量都是无量纲的。系数 $a(y)$ 是关于 $y$ 的周期为 $1$ 的周期函数，并且在每个周期上是分段常数：当 $y\\in[0,0.3)$ 时 $a(y)=10$，当 $y\\in[0.3,1)$ 时 $a(y)=1$，并周期性延拓。设小尺度为 $\\epsilon=0.1$，因此该域恰好包含 $10$ 个微周期。\n\n使用多尺度有限元方法（MsFEM），通过求解粗网格单元 $K=[0,1]$ 上的齐次局部问题（在 $x=0$ 和 $x=1$ 处具有适当的节点边界条件），构造该单元上的单元级多尺度基函数。您的推导必须从控制微分方程以及基函数需满足在 $K$ 上带有节点边界条件的相应齐次方程这一要求开始。然后使用这些基函数来定义 $K$ 上的 MsFEM 近似解 $u_H(x)$，其节点值等于给定的狄利克雷边界数据。\n\n最后，计算 $K$ 内部相应的 MsFEM 粗尺度通量 $q_H(x)=-a(x/\\epsilon)\\,u_H'(x)$，并报告其在粗网格单元上的常数值。您的最终答案必须是一个四舍五入到四位有效数字的数值，并且由于无量纲化，它必须无单位表示。", "solution": "在尝试求解之前，将对所述问题进行验证。\n\n首先，我逐字提取给定的信息。\n- 控制方程：$-\\dfrac{d}{dx}\\!\\left(a\\!\\left(\\dfrac{x}{\\epsilon}\\right)\\dfrac{du}{dx}\\right)=0$，其中 $x\\in (0,1)$。\n- 域：$\\Omega = [0,1]$。\n- 边界条件：$u(0)=1$，$u(1)=0$。\n- 尺度参数：$\\epsilon=0.1$。\n- 非均匀传导系数：$a(y)$ 是一个周期为 $1$ 的周期函数，其中 $y=x/\\epsilon$。\n- $a(y)$ 的定义：当 $y\\in[0,0.3)$ 时 $a(y)=10$，当 $y\\in[0.3,1)$ 时 $a(y)=1$，并周期性延拓。\n- 方法：多尺度有限元方法 (MsFEM)。\n- 粗网格：一个单一的粗网格单元 $K=[0,1]$。\n- 任务：在 $K$ 上构造单元级多尺度基函数，构造 MsFEM 近似解 $u_H(x)$，并计算 $K$ 上的常数粗尺度通量 $q_H(x)=-a(x/\\epsilon)\\,u_H'(x)$。\n- 最终答案格式：一个四舍五入到四位有效数字的数值。\n\n接下来，我验证该问题。\n该问题是均匀化和多尺度数值方法领域中一个标准的、适定的一维边值问题。控制方程是描述稳态扩散的守恒律。传导系数 $a(x/\\epsilon)$ 是严格为正的，这确保了物理和数学上的有效性。多尺度有限元方法是解决此类问题的标准技术。该问题数据充分，内部一致，且有科学依据。所有术语都有明确定义。因此，该问题是有效的，将提供解答。\n\n多尺度有限元方法（MsFEM）的核心原理是将来自微分算子的小尺度信息融入到基函数中。对于给定的粗网格单元 $K$，多尺度基函数 $\\phi_i(x)$ 是通过求解 $K$ 上原始微分方程的齐次版本来计算的，其边界条件模仿了标准有限元基函数。\n\n在此问题中，我们有一个单一的粗网格单元 $K=[0,1]$，其节点位于 $x_1=0$ 和 $x_2=1$。相应的标准线性基函数应为 $N_1(x)=1-x$ 和 $N_2(x)=x$。MsFEM 基函数 $\\phi_1(x)$ 和 $\\phi_2(x)$ 必须满足 $K$ 上的局部问题，其边界条件分别继承自 $N_1(x)$ 和 $N_2(x)$。\n\n我们来构造第一个基函数 $\\phi_1(x)$。它是以下问题的解：\n$$-\\dfrac{d}{dx}\\!\\left(a\\!\\left(\\dfrac{x}{\\epsilon}\\right)\\dfrac{d\\phi_1}{dx}\\right)=0 \\quad \\text{for } x \\in (0,1)$$\n边界条件为 $\\phi_1(0)=1$ 和 $\\phi_1(1)=0$。\n\n将微分方程积分一次得到：\n$$-a\\!\\left(\\dfrac{x}{\\epsilon}\\right)\\dfrac{d\\phi_1}{dx} = C_1$$\n其中 $C_1$ 是一个积分常数。此表达式代表与基函数 $\\phi_1(x)$ 相关的通量。我们可以重新整理这个式子以求得导数：\n$$\\dfrac{d\\phi_1}{dx} = -\\dfrac{C_1}{a(x/\\epsilon)}$$\n\n第二次对 $x$ 从 $0$ 到 $x'$ 积分得到：\n$$\\int_0^{x'} \\dfrac{d\\phi_1}{dx} dx = \\phi_1(x') - \\phi_1(0) = -C_1 \\int_0^{x'} \\dfrac{1}{a(s/\\epsilon)} ds$$\n使用边界条件 $\\phi_1(0)=1$，我们得到 $\\phi_1(x)$ 的表达式：\n$$\\phi_1(x) = 1 - C_1 \\int_0^x \\dfrac{1}{a(s/\\epsilon)} ds$$\n\n为了求出常数 $C_1$，我们应用第二个边界条件 $\\phi_1(1)=0$：\n$$0 = 1 - C_1 \\int_0^1 \\dfrac{1}{a(s/\\epsilon)} ds$$\n因此，$C_1$ 由该积分的倒数给出：\n$$C_1 = \\left( \\int_0^1 \\dfrac{1}{a(s/\\epsilon)} ds \\right)^{-1}$$\n该积分是逆传导系数 $a^{-1}$ 在域 $[0,1]$ 上的平均值。由于系数 $a(x/\\epsilon)$ 的周期为 $\\epsilon=0.1$ 且域长度为 $1$，该域恰好包含 $10$ 个周期。因此，我们可以计算一个周期上的积分，然后乘以 $10$。\n$$\\int_0^1 \\dfrac{1}{a(s/\\epsilon)} ds = 10 \\int_0^{0.1} \\dfrac{1}{a(s/0.1)} ds$$\n我们进行变量替换 $y = s/\\epsilon = s/0.1$，所以 $ds = 0.1 dy$。关于 $s$ 在一个周期内从 $0$ 到 $0.1$ 的积分限变成了关于 $y$ 从 $0$ 到 $1$ 的积分限。\n$$\\int_0^1 \\dfrac{1}{a(s/\\epsilon)} ds = 10 \\int_0^1 \\dfrac{1}{a(y)} (0.1 dy) = \\int_0^1 \\dfrac{1}{a(y)} dy$$\n该积分是传导系数在一个单位晶胞上的调和平均值。我们使用 $a(y)$ 的分段定义来计算它：\n$$\\int_0^1 \\dfrac{1}{a(y)} dy = \\int_0^{0.3} \\dfrac{1}{10} dy + \\int_{0.3}^1 \\dfrac{1}{1} dy$$\n$$= \\dfrac{1}{10}[y]_0^{0.3} + [y]_{0.3}^1 = \\dfrac{1}{10}(0.3 - 0) + (1 - 0.3) = 0.03 + 0.7 = 0.73$$\n所以，常数 $C_1$ 是：\n$$C_1 = \\dfrac{1}{0.73}$$\n基函数被完全定义为 $\\phi_1(x) = 1 - \\frac{1}{0.73} \\int_0^x \\frac{1}{a(s/\\epsilon)} ds$。对于此问题，我们不需要显式地构造 $\\phi_2(x)$，但可以证明 $\\phi_2(x) = 1 - \\phi_1(x)$。\n\nMsFEM 近似解 $u_H(x)$ 是通过基函数的线性组合来构造的，其系数为解的节点值。节点值由狄利克雷边界条件 $u(0)=1$ 和 $u(1)=0$ 给出。\n$$u_H(x) = u(0) \\phi_1(x) + u(1) \\phi_2(x)$$\n$$u_H(x) = (1) \\phi_1(x) + (0) \\phi_2(x) = \\phi_1(x)$$\n因此，在这个单单元网格上的 MsFEM 解与第一个基函数相同，即 $u_H(x) = \\phi_1(x)$。\n\n最后一步是计算粗尺度通量 $q_H(x)$：\n$$q_H(x) = -a\\!\\left(\\dfrac{x}{\\epsilon}\\right)\\dfrac{du_H}{dx}$$\n由于 $u_H(x) = \\phi_1(x)$，我们有 $\\frac{du_H}{dx} = \\frac{d\\phi_1}{dx}$。根据我们之前的推导：\n$$\\dfrac{d\\phi_1}{dx} = -\\dfrac{C_1}{a(x/\\epsilon)}$$\n将此代入通量的表达式中：\n$$q_H(x) = -a\\!\\left(\\dfrac{x}{\\epsilon}\\right) \\left( -\\dfrac{C_1}{a(x/\\epsilon)} \\right) = C_1$$\n正如控制方程所预期的，通量 $q_H(x)$ 在整个单元 $K$ 中是恒定的。它的值就是 $C_1$。\n$$q_H = C_1 = \\dfrac{1}{0.73}$$\n这个结果也称为有效通量，对应于具有等效传导系数 $a_{\\text{eff}} = (\\langle a^{-1} \\rangle)^{-1} = 1/0.73$ 的均匀化问题。\n数值为：\n$$q_H = \\dfrac{1}{0.73} \\approx 1.36986301369...$$\n四舍五入到四位有效数字，我们得到 $1.370$。", "answer": "$$\\boxed{1.370}$$", "id": "2581803"}, {"introduction": "在实际的科研和工程应用中，并不存在一个“普适最优”的多尺度方法；方法的选择往往需要在计算成本、精度要求和可用资源之间进行权衡。最后一个练习 [@problem_id:2581848] 将您置于一个真实的决策场景中：通过一个案例研究，比较三种主流策略（FE²、HMM 和 ROM-FE²）的性能。您需要进行成本效益分析，在不同的约束条件下选择最优方案，这是一项计算科学家和工程师必备的关键技能。", "problem": "考虑一个二维平面应变基准复合材料：一种周期性的基体-夹杂物微观结构，其夹杂物体积分数为 $f=0.3$，刚度对比度为 $\\kappa=20$。代表性体积单元 (RVE) 的特征长度为 $\\ell$，并由一个协调的有限元网格解析，使得微观离散化误差虽小但不可忽略。宏观域由 $N_{\\text{el}}=2500$ 个双线性四边形单元离散化，每个单元有 $N_g=4$ 个Gauss点，并在 $N_{\\text{inc}}=20$ 个伪时间增量步中加载。假设线性弹性和尺度分离，其中 $\\eta=\\ell/H=0.05$，$H$ 是特征宏观单元尺寸。考虑以下三种多尺度策略：\n\n- 直接双尺度平方有限元 ($\\mathrm{FE}^2$)：在每个宏观Gauss点和载荷增量步，求解与当前宏观应变一致的RVE上的微观边值问题，返回均匀化的应力和切线刚度。\n- 非均质多尺度方法 (HMM)：每个宏观单元和载荷增量步，在一个代表该单元的采样区域上评估一个微观问题（即，每个单元每个增量步进行 $N_s=1$ 次微观调用），并使用该样本来近似单元平均的本构响应。\n- 降阶模型 (ROM) 加速的 $\\mathrm{FE}^2$：在RVE上执行离线降阶基训练，包含 $N_{\\text{snap}}=500$ 个快照解，然后在在线阶段用降阶求解替换每个微观求解。\n\n假设在单个工作站上具有以下经验校准的特性：\n\n- 在RVE上的一个全阶微观求解平均耗时 $t_{\\mu}=0.1$ 秒；降阶微观求解耗时 $t_{\\mu}^{\\text{ROM}}=0.005$ 秒；离线训练成本与快照数量成正比。\n- 每个增量步的宏观求解（不包括多尺度本构查询）成本为 $t_M=1$ 秒；这部分对所有策略都是共同的，在比较以微观成本为主的策略时可以忽略。\n- 误差以宏观位移的范数（或等效的能量范数）相对于收敛参考解的相对误差来报告。对于给定的网格，当使用全阶RVE时，宏观离散化贡献了 $e_M=0.5\\%$ 的误差，微观离散化贡献了 $e_{\\mu}=0.5\\%$ 的误差，HMM采样贡献了额外的模型偏差 $e_s=1.5\\%$，降阶基截断贡献了 $e_{\\text{tr}}=0.3\\%$ 的误差。将总误差视为每种策略相应贡献之和，这给出了一个上限。\n\n提出两种操作场景：\n\n- 场景 A：时间预算 $T_{\\max}=8000$ 秒，精度容差 $\\tau=1.5\\%$。\n- 场景 B：时间预算 $T_{\\max}=25000$ 秒，精度容差 $\\tau=1.0\\%$。\n\n从多尺度有限元均匀化的第一性原理和基本操作计数出发，完成以下任务：推导每种策略执行的微观边值问题的数量，估计每种策略的总运行时间，为每种策略的总相对误差建立一个上限，确定在每种场景下哪些策略是可行的（同时满足 $C\\le T_{\\max}$ 和 $e\\le \\tau$），并在可行策略中选择总运行时间最短的那个。根据您的推导，哪个选项正确地指出了每种场景下的可行和最优策略，并陈述了一个表达为约束最小化原理的通用选择标准？\n\nA. 在场景 A 中，非均质多尺度方法 (HMM) 是最优的，因为它将微观调用次数从 $N_{\\text{el}}N_gN_{\\text{inc}}$ 减少到 $N_{\\text{el}}N_{\\text{inc}}$，并且由于采样区域代表了单元，其精度与直接 $\\mathrm{FE}^2$ 基本相同；在场景 B 中，HMM 仍然是最优的；一个通用的选择规则是仅在时间预算的约束下最小化 $N_s$。\n\nB. 在场景 A 中，降阶模型 (ROM) 加速的 $\\mathrm{FE}^2$ 是可行的但不是最优的，因为离线成本 $N_{\\text{snap}}t_{\\mu}$ 占主导地位；直接 $\\mathrm{FE}^2$ 是最优的，因为它避免了离线开销；在场景 B 中，由于降阶基截断，ROM 加速的 $\\mathrm{FE}^2$ 未能满足更严格的容差；一个通用的选择规则是最小化在线运行时间，忽略离线成本。\n\nC. 在场景 A 中，ROM 加速的 $\\mathrm{FE}^2$ 是唯一可行的策略，因为其总运行时间 $N_{\\text{el}}N_gN_{\\text{inc}}\\,t_{\\mu}^{\\text{ROM}}+N_{\\text{snap}}t_{\\mu}$ 低于 $T_{\\max}$ 且其总误差 $e_M+e_{\\mu}+e_{\\text{tr}}$ 低于 $\\tau$，而直接 $\\mathrm{FE}^2$ 违反了时间预算，HMM 违反了容差；在场景 B 中，直接 $\\mathrm{FE}^2$ 是唯一可行的策略，因为 $e_M+e_{\\mu}\\le \\tau$ 且其运行时间 $N_{\\text{el}}N_gN_{\\text{inc}}\\,t_{\\mu}$ 低于 $T_{\\max}$，而 HMM 和 ROM 加速的 $\\mathrm{FE}^2$ 都违反了容差；总的来说，选择在 $C\\le T_{\\max}$ 和 $e\\le \\tau$ 约束下最小化总成本 $C$ 的策略，其中 $C_{\\mathrm{FE}^2}=N_{\\text{el}}N_gN_{\\text{inc}}\\,t_{\\mu}$，$C_{\\text{HMM}}=N_{\\text{el}}N_sN_{\\text{inc}}\\,t_{\\mu}$，$C_{\\text{ROM}}=N_{\\text{el}}N_gN_{\\text{inc}}\\,t_{\\mu}^{\\text{ROM}}+N_{\\text{snap}}t_{\\mu}$，且 $e_{\\mathrm{FE}^2}=e_M+e_{\\mu}$，$e_{\\text{HMM}}=e_M+e_{\\mu}+e_s$，$e_{\\text{ROM}}=e_M+e_{\\mu}+e_{\\text{tr}}$。\n\nD. 在场景 A 中，直接 $\\mathrm{FE}^2$ 是可行的，因为其运行时间为 $N_{\\text{el}}N_g\\,t_{\\mu}$，因此低于 $T_{\\max}$；在场景 B 中，ROM 加速的 $\\mathrm{FE}^2$ 是最优的，因为仅其误差 $e_{\\text{tr}}$ 就低于 $\\tau$；一个通用的选择规则是优先选择建模误差最低的方法，而不考虑运行时间限制。", "solution": "问题陈述已经过评估并被确定为有效。这是一个在计算力学领域中，特别是在多尺度建模策略比较方面，定义明确、有科学依据且客观的问题。唯一解所需的所有数据都已提供，并且没有内部矛盾。\n\n任务是为两种不同的场景确定直接 $\\mathrm{FE}^2$、非均质多尺度方法 (HMM) 和降阶模型 (ROM) 加速的 $\\mathrm{FE}^2$ 中的最优计算策略，每个场景由最大时间预算 $T_{\\max}$ 和最大误差容差 $\\tau$ 定义。最优策略是既可行（满足两个约束条件）又具有最小总运行时间的策略。\n\n首先，我们整理给定的参数：\n- 宏观单元数量：$N_{\\text{el}}=2500$\n- 每个单元的Gauss点数：$N_g=4$\n- 伪时间增量步数：$N_{\\text{inc}}=20$\n- 每个单元的HMM微观样本数：$N_s=1$\n- ROM训练快照数：$N_{\\text{snap}}=500$\n- 单个全阶微观求解时间：$t_{\\mu}=0.1 \\, \\text{s}$\n- 单个降阶微观求解时间：$t_{\\mu}^{\\text{ROM}}=0.005 \\, \\text{s}$\n- 宏观离散化误差：$e_M=0.5\\%=0.005$\n- 微观离散化误差：$e_{\\mu}=0.5\\%=0.005$\n- HMM采样误差：$e_s=1.5\\%=0.015$\n- ROM截断误差：$e_{\\text{tr}}=0.3\\%=0.003$\n- 总成本主要由微观求解决定，因此宏观求解器成本 $t_M$ 被忽略。\n- 总误差是相关误差贡献的总和。\n\n接下来，我们计算每种策略的总计算成本 ($C$) 和总误差 ($e$)。\n\n**策略1：直接双尺度平方有限元 ($\\mathrm{FE}^2$)**\n需要求解的微观边值问题的数量是宏观单元数、每个单元的Gauss点数和载荷增量步数的乘积。\n$$N_{\\text{solves}}^{\\mathrm{FE}^2} = N_{\\text{el}} \\times N_g \\times N_{\\text{inc}} = 2500 \\times 4 \\times 20 = 200,000$$\n总计算成本为：\n$$C_{\\mathrm{FE}^2} = N_{\\text{solves}}^{\\mathrm{FE}^2} \\times t_{\\mu} = 200,000 \\times 0.1 \\, \\text{s} = 20,000 \\, \\text{s}$$\n总误差是宏观和微观离散化误差之和：\n$$e_{\\mathrm{FE}^2} = e_M + e_{\\mu} = 0.005 + 0.005 = 0.010 = 1.0\\%$$\n\n**策略2：非均质多尺度方法 (HMM)**\n微观问题的数量是按每个宏观单元每个增量步评估的，样本数为 $N_s=1$。\n$$N_{\\text{solves}}^{\\text{HMM}} = N_{\\text{el}} \\times N_s \\times N_{\\text{inc}} = 2500 \\times 1 \\times 20 = 50,000$$\n使用全阶微观求解器对每个样本进行计算，总计算成本为：\n$$C_{\\text{HMM}} = N_{\\text{solves}}^{\\text{HMM}} \\times t_{\\mu} = 50,000 \\times 0.1 \\, \\text{s} = 5,000 \\, \\text{s}$$\n总误差包括额外的采样偏差 $e_s$：\n$$e_{\\text{HMM}} = e_M + e_{\\mu} + e_s = 0.005 + 0.005 + 0.015 = 0.025 = 2.5\\%$$\n\n**策略3：降阶模型 (ROM) 加速的 $\\mathrm{FE}^2$**\n该策略有一个离线训练阶段和一个在线计算阶段。总成本是两者之和。在线阶段涉及与 $\\mathrm{FE}^2$ 相同数量的微观求解，但使用速度快得多的降阶求解器。\n离线成本是生成快照的成本：\n$$C_{\\text{offline}} = N_{\\text{snap}} \\times t_{\\mu} = 500 \\times 0.1 \\, \\text{s} = 50 \\, \\text{s}$$\n在线成本为：\n$$C_{\\text{online}} = (N_{\\text{el}} \\times N_g \\times N_{\\text{inc}}) \\times t_{\\mu}^{\\text{ROM}} = 200,000 \\times 0.005 \\, \\text{s} = 1,000 \\, \\text{s}$$\n总计算成本为：\n$$C_{\\text{ROM}} = C_{\\text{offline}} + C_{\\text{online}} = 50 \\, \\text{s} + 1,000 \\, \\text{s} = 1,050 \\, \\text{s}$$\n总误差包括降阶基截断误差 $e_{\\text{tr}}$：\n$$e_{\\text{ROM}} = e_M + e_{\\mu} + e_{\\text{tr}} = 0.005 + 0.005 + 0.003 = 0.013 = 1.3\\%$$\n\n派生特性总结：\n| 策略 | 总成本 ($C$) | 总误差 ($e$) |\n|---|---|---|\n| 直接 $\\mathrm{FE}^2$ | $20,000 \\, \\text{s}$ | $1.0\\%$ |\n| HMM | $5,000 \\, \\text{s}$ | $2.5\\%$ |\n| ROM 加速的 $\\mathrm{FE}^2$ | $1,050 \\, \\text{s}$ | $1.3\\%$ |\n\n现在，我们评估每种场景下的可行性和最优性。\n\n**场景 A：时间预算 $T_{\\max}=8000 \\, \\text{s}$，精度容差 $\\tau=1.5\\%$**\n- **直接 $\\mathrm{FE}^2$**：\n  - 成本：$C_{\\mathrm{FE}^2} = 20,000 \\, \\text{s}  T_{\\max}$。**不可行**（超出时间预算）。\n  - 误差：$e_{\\mathrm{FE}^2} = 1.0\\% \\le \\tau$。\n- **HMM**：\n  - 成本：$C_{\\text{HMM}} = 5,000 \\, \\text{s} \\le T_{\\max}$。\n  - 误差：$e_{\\text{HMM}} = 2.5\\%  \\tau$。**不可行**（超出容差）。\n- **ROM 加速的 $\\mathrm{FE}^2$**：\n  - 成本：$C_{\\text{ROM}} = 1,050 \\, \\text{s} \\le T_{\\max}$。\n  - 误差：$e_{\\text{ROM}} = 1.3\\% \\le \\tau$。**可行**。\n\n对于场景 A，ROM 加速的 $\\mathrm{FE}^2$ 是唯一可行的策略，因此是最佳选择。\n\n**场景 B：时间预算 $T_{\\max}=25000 \\, \\text{s}$，精度容差 $\\tau=1.0\\%$**\n- **直接 $\\mathrm{FE}^2$**：\n  - 成本：$C_{\\mathrm{FE}^2} = 20,000 \\, \\text{s} \\le T_{\\max}$。\n  - 误差：$e_{\\mathrm{FE}^2} = 1.0\\% \\le \\tau$。**可行**。\n- **HMM**：\n  - 成本：$C_{\\text{HMM}} = 5,000 \\, \\text{s} \\le T_{\\max}$。\n  - 误差：$e_{\\text{HMM}} = 2.5\\%  \\tau$。**不可行**（超出容差）。\n- **ROM 加速的 $\\mathrm{FE}^2$**：\n  - 成本：$C_{\\text{ROM}} = 1,050 \\, \\text{s} \\le T_{\\max}$。\n  - 误差：$e_{\\text{ROM}} = 1.3\\%  \\tau$。**不可行**（超出容差）。\n\n对于场景 B，直接 $\\mathrm{FE}^2$ 是唯一可行的策略，因此是最佳选择。\n\n通用的选择原则是一个约束优化问题：选择能够最小化总成本 $C_i$ 的策略 $i$，同时满足成本在时间预算内 ($C_i \\le T_{\\max}$) 和误差在容差内 ($e_i \\le \\tau$) 的约束条件。\n\n现在我们根据这个推导来评估所提供的选项。\n\n**A.** 在场景 A 中，声称 HMM 是最优的。这是**不正确**的。HMM 是不可行的，因为其误差 $e_{\\text{HMM}}=2.5\\%$ 超过了容差 $\\tau=1.5\\%$。基于所提供的数据（$e_s=1.5\\%$），声称 HMM 精度“基本相同”于 $\\mathrm{FE}^2$ 是错误的。所提出的通用选择规则也有缺陷，因为它忽略了精度约束。\n\n**B.** 在场景 A 中，声称 ROM 加速的 $\\mathrm{FE}^2$ 是可行的但不是最优的。这是**不正确**的。它是唯一可行的策略，因此是最优的。声称离线成本占主导地位是错误的；$C_{\\text{offline}}=50 \\, \\text{s}$ 而 $C_{\\text{online}}=1,000 \\, \\text{s}$。声称直接 $\\mathrm{FE}^2$ 是最优的是**不正确**的，因为它不可行。所提出的通用选择规则是无意义的，因为它忽略了离线成本和精度约束。\n\n**C.** 该选项指出，在场景 A 中，ROM 加速的 $\\mathrm{FE}^2$ 是唯一可行且因此最优的策略，因为其成本（$C_{\\text{ROM}}=1050 \\, \\text{s}$）低于 $T_{\\max}=8000 \\, \\text{s}$ 且其误差（$e_{\\text{ROM}}=1.3\\%$）低于 $\\tau=1.5\\%$，而 $\\mathrm{FE}^2$ 违反了时间预算，HMM 违反了误差容差。这完全**正确**，与我们的发现相符。\n它接着指出，在场景 B 中，直接 $\\mathrm{FE}^2$ 是唯一可行的策略，因为其成本（$C_{\\mathrm{FE}^2}=20000 \\, \\text{s}$）低于 $T_{\\max}=25000 \\, \\text{s}$ 且其误差（$e_{\\mathrm{FE}^2}=1.0\\%$）在容差 $\\tau=1.0\\%$ 之内，而 HMM 和 ROM 加速的 $\\mathrm{FE}^2$ 都违反了更严格的误差容差。这也完全**正确**。\n最后，它提供了通用选择规则，即在 $C \\le T_{\\max}$ 和 $e \\le \\tau$ 的约束下最小化总成本 $C$，并正确列出了每种策略的成本和误差公式。这个通用原则和具体公式都是**正确**的。\n\n**D.** 该选项错误地声称直接 $\\mathrm{FE}^2$ 在场景 A 中是可行的。它还使用了错误的 $\\mathrm{FE}^2$ 运行时间公式，忽略了增量步数 $N_{\\text{inc}}$。这是一个根本性错误。关于场景 B 和通用选择规则的说法也有缺陷，忽略了成本约束和总误差计算。这是**不正确**的。\n\n基于严谨的分析，选项 C 是唯一一个与推导结果和工程设计中约束优化的基本原则完全一致的选项。", "answer": "$$\\boxed{C}$$", "id": "2581848"}]}