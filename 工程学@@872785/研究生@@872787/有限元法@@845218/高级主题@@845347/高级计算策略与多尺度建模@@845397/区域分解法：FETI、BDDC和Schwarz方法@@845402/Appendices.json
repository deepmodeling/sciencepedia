{"hands_on_practices": [{"introduction": "在我们能够将复杂问题分解到多个子域上求解之前，必须先掌握如何在单个子域上构建问题的数学表示。本练习将引导你从第一性原理出发，推导出一维线性有限元的局部刚度矩阵 ($K^{(i)}$)。熟练掌握这一基本步骤至关重要，因为这些局部矩阵是构建所有区域分解方法（无论是重叠型的Schwarz方法还是非重叠型的FETI和BDDC方法）的基石。[@problem_id:2552503]", "problem": "考虑开区间 $\\Omega=(0,1)$ 上的标量扩散模型问题，在 $x=0$ 和 $x=1$ 处施加齐次狄利克雷边界条件，其双线性形式为 $a(u,v)=\\int_{0}^{1} u'(x)\\,v'(x)\\,dx$。按照有限元撕裂与连接 (Finite Element Tearing and Interconnecting, FETI) 和约束平衡区域分解 (Balancing Domain Decomposition by Constraints, BDDC) 方法，将 $\\Omega$ 分割成两个不重叠的子区域 $\\Omega_1=(0,\\tfrac{1}{2})$ 和 $\\Omega_2=(\\tfrac{1}{2},1)$。在每个子区域上，使用一个定义在子区域双节点网格上的 $P_1$（连续、分片线性）有限元，并采用与子区域端点相关联的标准节点基函数。在 $\\Omega_1$ 上，按 $x$ 坐标递增顺序对局部节点进行编号，即 $1 \\mapsto x=0$, $2 \\mapsto x=\\tfrac{1}{2}$；在 $\\Omega_2$ 上，编号为 $1 \\mapsto x=\\tfrac{1}{2}$, $2 \\mapsto x=1$。\n\n从有限元刚度贡献的弱形式定义以及从参考单元到物理单元的仿射映射出发，通过对基函数导数的乘积进行积分，推导一个长度为 $h$ 的通用一维 $P_1$ 单元上的 $2\\times 2$ 局部刚度矩阵。将您的结果应用于每个子区域，以获得 $\\Omega_1$ 上的显式局部刚度矩阵 $K^{(1)}$ 和 $\\Omega_2$ 上的显式局部刚度矩阵 $K^{(2)}$。在每个子区域的局部编号中，确定哪个局部自由度位于界面 $x=\\tfrac{1}{2}$ 上。\n\n将您的最终答案表示为一个单行矩阵，其中按顺序列出：$K^{(1)}$ 的四个元素（按行主序），然后是 $K^{(2)}$ 的四个元素（按行主序），最后是 $\\Omega_1$ 和 $\\Omega_2$ 上的局部界面自由度索引。不要四舍五入，请使用精确值。无需单位。", "solution": "问题陈述经分析后被认为是有效的。这是一个标准的、适定的有限元法问题，也是诸如 FETI 和 BDDC 等区域分解技术的一个基础步骤。我们将着手进行推导。\n\n有限单元 $e$ 的局部刚度矩阵 $K^{(e)}$ 由其元素 $K_{ij}^{(e)} = a(\\phi_j, \\phi_i)$ 定义，其中双线性形式 $a(\\cdot, \\cdot)$ 限制在单元域 $\\Omega_e$ 上，而 $\\phi_i, \\phi_j$ 是局部基函数。对于给定的问题，$a(u,v) = \\int_{\\Omega} u'(x)v'(x)dx$，因此对于一个长度为 $h$、跨越区间 $[x_1, x_2]$ 的单元，其局部刚度矩阵的元素由下式给出：\n$$ K_{ij}^{(e)} = \\int_{x_1}^{x_2} \\phi_i'(x)\\phi_j'(x)dx $$\n我们将为一个通用的一维 $P_1$ 单元推导此矩阵，然后将结果应用于子区域 $\\Omega_1$ 和 $\\Omega_2$。\n\n首先，考虑标准参考单元，即具有局部坐标 $\\xi$ 的区间 $\\hat{\\Omega} = [0, 1]$。此参考单元上的 $P_1$ 基函数（帽子函数）是由其节点值定义的线性多项式：\n$$ \\hat{\\phi}_1(\\xi) = 1 - \\xi $$\n$$ \\hat{\\phi}_2(\\xi) = \\xi $$\n它们关于参考坐标 $\\xi$ 的导数是常数：\n$$ \\frac{d\\hat{\\phi}_1}{d\\xi} = -1 $$\n$$ \\frac{d\\hat{\\phi}_2}{d\\xi} = 1 $$\n\n接下来，我们建立从参考坐标 $\\xi \\in [0, 1]$ 到长度为 $h = x_2 - x_1$ 的通用单元 $[x_1, x_2]$ 中的物理坐标 $x$ 的仿射映射：\n$$ x(\\xi) = x_1 + (x_2 - x_1)\\xi = x_1 + h\\xi $$\n此变换的雅可比是 $J = \\frac{dx}{d\\xi} = h$。其逆为 $\\frac{d\\xi}{dx} = \\frac{1}{h}$。\n\n物理基函数 $\\phi_i(x)$ 通过与逆映射的复合与参考基函数 $\\hat{\\phi}_i(\\xi)$ 相关联：$\\phi_i(x) = \\hat{\\phi}_i(\\xi(x))$。我们使用链式法则来求它们关于物理坐标 $x$ 的导数：\n$$ \\frac{d\\phi_i}{dx} = \\frac{d\\hat{\\phi}_i}{d\\xi} \\frac{d\\xi}{dx} = \\frac{1}{h} \\frac{d\\hat{\\phi}_i}{d\\xi} $$\n具体而言：\n$$ \\phi_1'(x) = \\frac{1}{h}(-1) = -\\frac{1}{h} $$\n$$ \\phi_2'(x) = \\frac{1}{h}(1) = \\frac{1}{h} $$\n这些导数在单元上是常数。\n\n现在我们可以计算通用的 $2 \\times 2$ 局部刚度矩阵 $K^{(e)}$ 的元素。使用 $dx = J d\\xi = h d\\xi$，物理域上的积分被变换为参考域 $[0, 1]$ 上的积分：\n$$ K_{ij}^{(e)} = \\int_{x_1}^{x_2} \\phi_i'(x)\\phi_j'(x)dx = \\int_{0}^{1} \\left(\\frac{1}{h}\\frac{d\\hat{\\phi}_i}{d\\xi}\\right) \\left(\\frac{1}{h}\\frac{d\\hat{\\phi}_j}{d\\xi}\\right) (h d\\xi) = \\frac{1}{h} \\int_{0}^{1} \\frac{d\\hat{\\phi}_i}{d\\xi}\\frac{d\\hat{\\phi}_j}{d\\xi}d\\xi $$\n我们计算四个元素中的每一个：\n$$ K_{11}^{(e)} = \\frac{1}{h} \\int_{0}^{1} (-1)(-1) d\\xi = \\frac{1}{h} \\int_{0}^{1} 1 \\, d\\xi = \\frac{1}{h} [\\xi]_0^1 = \\frac{1}{h} $$\n$$ K_{12}^{(e)} = \\frac{1}{h} \\int_{0}^{1} (-1)(1) d\\xi = \\frac{1}{h} \\int_{0}^{1} -1 \\, d\\xi = -\\frac{1}{h} [\\xi]_0^1 = -\\frac{1}{h} $$\n$$ K_{21}^{(e)} = \\frac{1}{h} \\int_{0}^{1} (1)(-1) d\\xi = \\frac{1}{h} \\int_{0}^{1} -1 \\, d\\xi = -\\frac{1}{h} [\\xi]_0^1 = -\\frac{1}{h} $$\n$$ K_{22}^{(e)} = \\frac{1}{h} \\int_{0}^{1} (1)(1) d\\xi = \\frac{1}{h} \\int_{0}^{1} 1 \\, d\\xi = \\frac{1}{h} [\\xi]_0^1 = \\frac{1}{h} $$\n因此，长度为 $h$ 的一维 $P_1$ 单元的通用局部刚度矩阵为：\n$$ K^{(e)} = \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} $$\n\n现在，我们将此结果应用于两个子区域 $\\Omega_1$ 和 $\\Omega_2$。\n\n对于子区域 $\\Omega_1 = (0, \\frac{1}{2})$，我们有一个节点位于 $x=0$ 和 $x=\\frac{1}{2}$ 的单个单元。此单元的长度为 $h_1 = \\frac{1}{2} - 0 = \\frac{1}{2}$。局部刚度矩阵 $K^{(1)}$ 为：\n$$ K^{(1)} = \\frac{1}{1/2} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = 2 \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = \\begin{pmatrix} 2  -2 \\\\ -2  2 \\end{pmatrix} $$\n按行主序排列的元素为 $2, -2, -2, 2$。\n\n对于子区域 $\\Omega_2 = (\\frac{1}{2}, 1)$，我们有一个节点位于 $x=\\frac{1}{2}$ 和 $x=1$ 的单个单元。此单元的长度为 $h_2 = 1 - \\frac{1}{2} = \\frac{1}{2}$。局部刚度矩阵 $K^{(2)}$ 为：\n$$ K^{(2)} = \\frac{1}{1/2} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = 2 \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = \\begin{pmatrix} 2  -2 \\\\ -2  2 \\end{pmatrix} $$\n按行主序排列的元素为 $2, -2, -2, 2$。\n\n最后，我们必须为每个子区域确定界面 $x=\\frac{1}{2}$ 上的局部自由度 (DoF)。自由度的索引与其局部节点编号相对应。\n在子区域 $\\Omega_1$ 上，局部节点编号为 $1 \\mapsto x=0$ 和 $2 \\mapsto x=\\frac{1}{2}$。界面位于 $x=\\frac{1}{2}$，对应于局部节点索引 $2$。\n在子区域 $\\Omega_2$ 上，局部节点编号为 $1 \\mapsto x=\\frac{1}{2}$ 和 $2 \\mapsto x=1$。界面位于 $x=\\frac{1}{2}$，对应于局部节点索引 $1$。\n\n我们按要求将这些结果组合成一个单行矩阵。各个组成部分如下：\n1.  $K^{(1)}$ 的元素（行主序）：$2, -2, -2, 2$。\n2.  $K^{(2)}$ 的元素（行主序）：$2, -2, -2, 2$。\n3.  $\\Omega_1$ 上的界面自由度索引：$2$。\n4.  $\\Omega_2$ 上的界面自由度索引：$1$。\n组合后的值列表为 $(2, -2, -2, 2, 2, -2, -2, 2, 2, 1)$。", "answer": "$$ \\boxed{ \\begin{pmatrix} 2  -2  -2  2  2  -2  -2  2  2  1 \\end{pmatrix} } $$", "id": "2552503"}, {"introduction": "理解了如何构建子域的局部问题后，下一步是学习如何将这些局部解组合起来以逼近全局解。本练习将带你实践经典的加性Schwarz方法，这是一种在重叠子域上进行迭代求解的策略。通过执行一步完整的迭代计算，并将其结果与更基础的Jacobi迭代进行比较，你将具体地体会到重叠区域分解法如何通过并行求解局部问题来有效更新解，并加速收敛。[@problem_id:2552509]", "problem": "考虑标量扩散问题 $-u''=f$，其定义在区间 $[0,6]$ 上，并带有齐次狄利克雷边界条件 $u(0)=u(6)=0$。使用连续分片线性有限元在间距 $h=1$ 的均匀网格上进行离散化，这样在 $5$ 个内部节点 $\\{1,2,3,4,5\\}$ 上组装得到的对称正定（SPD）刚度矩阵 $A\\in\\mathbb{R}^{5\\times 5}$ 是标准的，主对角线上元素为 $2$，第一亚对角线和第一超对角线上元素为 $-1$ 的三对角矩阵。设右端项为向量 $b=e_{3}\\in\\mathbb{R}^{5}$，其中 $e_{3}$ 是在节点 $3$ 处为 $1$、其他位置为零的单位向量，并从初始猜测 $u^{0}=0$ 开始。\n\n定义一个包含三个子区域的重叠区域分解，子区域的索引集为\n- $\\Omega_{1}=\\{1,2,3\\}$,\n- $\\Omega_{2}=\\{3,4,5\\}$,\n- $\\Omega_{3}=\\{2,3,4\\}$。\n\n对于每个子区域 $\\Omega_{i}$，令 $R_{i}\\in\\mathbb{R}^{3\\times 5}$ 为布尔限制算子，它按自然顺序提取 $\\Omega_{i}$ 上的分量，并令局部算子为 $A_{i}=R_{i}AR_{i}^{\\top}\\in\\mathbb{R}^{3\\times 3}$。考虑经典单层加性 Schwarz 稳态迭代（使用简单注入，无单位分解加权），\n$$\nu^{k+1}=u^{k}+\\sum_{i=1}^{3}R_{i}^{\\top}A_{i}^{-1}R_{i}\\,\\bigl(b-Au^{k}\\bigr),\n$$\n以及全局系统上的雅可比迭代，\n$$\nu^{k+1}=u^{k}+D^{-1}\\bigl(b-Au^{k}\\bigr),\n$$\n其中 $D=\\operatorname{diag}(A)$ 是 $A$ 的对角部分。使用 $u^{0}=0$，对每种方法执行一次迭代以获得 $u_{\\mathrm{AS}}^{1}$ 和 $u_{\\mathrm{J}}^{1}$，并计算相应残差的欧几里得范数之比，\n$$\n\\frac{\\|b-Au_{\\mathrm{AS}}^{1}\\|_{2}}{\\|b-Au_{\\mathrm{J}}^{1}\\|_{2}}.\n$$\n\n请以单个精确表达式（无四舍五入，无小数）的形式给出您的答案。", "solution": "该问题陈述是数值线性代数中一个适定的练习，具体涉及求解由微分方程有限元离散化产生的线性系统的迭代方法。它具有科学依据，定义明确，并包含了进行求解所需的所有必要信息。不存在不一致或无效的前提。我们将开始计算。\n\n全局刚度矩阵 $A \\in \\mathbb{R}^{5\\times 5}$ 和右端向量 $b \\in \\mathbb{R}^{5}$ 如下所示：\n$$\nA = \\begin{pmatrix} 2  -1  0  0  0 \\\\ -1  2  -1  0  0 \\\\ 0  -1  2  -1  0 \\\\ 0  0  -1  2  -1 \\\\ 0  0  0  -1  2 \\end{pmatrix}, \\quad b = e_{3} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n初始猜测为 $u^{0} = 0 \\in \\mathbb{R}^{5}$。\n\n首先，我们计算雅可比方法的一次迭代。雅可比迭代定义为 $u^{k+1} = u^{k} + D^{-1}(b - Au^{k})$，其中 $D = \\operatorname{diag}(A)$。\n对于第一次迭代，当 $k=0$ 且 $u^{0} = 0$ 时，我们有：\n$$\nu_{\\mathrm{J}}^{1} = u^{0} + D^{-1}(b - Au^{0}) = D^{-1}b\n$$\n$A$ 的对角部分为 $D = \\operatorname{diag}(2, 2, 2, 2, 2) = 2I$，其中 $I$ 是 $5 \\times 5$ 的单位矩阵。因此，其逆矩阵为 $D^{-1} = \\frac{1}{2}I$。\n第一次雅可比迭代的结果是：\n$$\nu_{\\mathrm{J}}^{1} = \\frac{1}{2}I b = \\frac{1}{2}b = \\frac{1}{2}e_{3} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{2} \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n相应的残差为 $r_{\\mathrm{J}}^{1} = b - Au_{\\mathrm{J}}^{1}$。我们首先计算 $Au_{\\mathrm{J}}^{1}$：\n$$\nA u_{\\mathrm{J}}^{1} = A \\left(\\frac{1}{2}e_{3}\\right) = \\frac{1}{2} (A e_{3}) = \\frac{1}{2} \\begin{pmatrix} 0 \\\\ -1 \\\\ 2 \\\\ -1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\frac{1}{2} \\\\ 1 \\\\ -\\frac{1}{2} \\\\ 0 \\end{pmatrix}\n$$\n那么残差为：\n$$\nr_{\\mathrm{J}}^{1} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ -\\frac{1}{2} \\\\ 1 \\\\ -\\frac{1}{2} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\\\ 0 \\\\ \\frac{1}{2} \\\\ 0 \\end{pmatrix}\n$$\n雅可比残差的欧几里得范数是：\n$$\n\\|r_{\\mathrm{J}}^{1}\\|_{2} = \\left\\| \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\\\ 0 \\\\ \\frac{1}{2} \\\\ 0 \\end{pmatrix} \\right\\|_{2} = \\sqrt{0^{2} + \\left(\\frac{1}{2}\\right)^{2} + 0^{2} + \\left(\\frac{1}{2}\\right)^{2} + 0^{2}} = \\sqrt{\\frac{1}{4} + \\frac{1}{4}} = \\sqrt{\\frac{1}{2}}\n$$\n\n接下来，我们计算单层加性 Schwarz 方法的一次迭代。迭代公式为 $u^{k+1} = u^{k} + \\sum_{i=1}^{3} R_{i}^{\\top}A_{i}^{-1}R_{i}\\,(b - Au^{k})$。\n对于第一次迭代，当 $k=0$ 且 $u^{0}=0$ 时，我们有：\n$$\nu_{\\mathrm{AS}}^{1} = \\sum_{i=1}^{3} R_{i}^{\\top}A_{i}^{-1}R_{i}b\n$$\n我们分析每个子区域的贡献。局部矩阵为 $A_{i} = R_{i}AR_{i}^{\\top}$。对于子区域 $\\Omega_{1} = \\{1,2,3\\}$、$\\Omega_{2} = \\{3,4,5\\}$ 和 $\\Omega_{3} = \\{2,3,4\\}$，相应的局部刚度矩阵是 $A$ 的主子矩阵：\n$$\nA_{1} = A_{2} = A_{3} = \\begin{pmatrix} 2  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  2 \\end{pmatrix}\n$$\n需要求这个矩阵的逆。其行列式为 $\\det(A_{1}) = 2(2 \\cdot 2 - (-1)(-1)) - (-1)(-1 \\cdot 2 - 0) = 2(3) - 2 = 4$。其逆矩阵为：\n$$\nA_{1}^{-1} = A_{2}^{-1} = A_{3}^{-1} = \\frac{1}{4} \\begin{pmatrix} 3  2  1 \\\\ 2  4  2 \\\\ 1  2  3 \\end{pmatrix}\n$$\n现在我们计算局部解。将右端项 $b=e_{3}$ 限制到每个子区域，得到局部向量 $b_{i} = R_{i}b$：\n$$\nb_{1} = R_{1}b = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}, \\quad b_{2} = R_{2}b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad b_{3} = R_{3}b = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n局部解为 $w_{i} = A_{i}^{-1}b_{i}$：\n$$\nw_{1} = A_{1}^{-1}b_{1} = \\frac{1}{4} \\begin{pmatrix} 3  2  1 \\\\ 2  4  2 \\\\ 1  2  3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\n$$\nw_{2} = A_{2}^{-1}b_{2} = \\frac{1}{4} \\begin{pmatrix} 3  2  1 \\\\ 2  4  2 \\\\ 1  2  3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 3 \\\\ 2 \\\\ 1 \\end{pmatrix}\n$$\n$$\nw_{3} = A_{3}^{-1}b_{3} = \\frac{1}{4} \\begin{pmatrix} 3  2  1 \\\\ 2  4  2 \\\\ 1  2  3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 2 \\\\ 4 \\\\ 2 \\end{pmatrix}\n$$\n这些局部解通过 $R_{i}^{\\top}$ 扩展回全局向量空间并相加，得到第一次加性 Schwarz 迭代的结果：\n$$\nu_{\\mathrm{AS}}^{1} = R_{1}^{\\top}w_{1} + R_{2}^{\\top}w_{2} + R_{3}^{\\top}w_{3} = \\frac{1}{4}\\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{1}{4}\\begin{pmatrix} 0 \\\\ 0 \\\\ 3 \\\\ 2 \\\\ 1 \\end{pmatrix} + \\frac{1}{4}\\begin{pmatrix} 0 \\\\ 2 \\\\ 4 \\\\ 2 \\\\ 0 \\end{pmatrix} = \\frac{1}{4}\\begin{pmatrix} 1 \\\\ 4 \\\\ 10 \\\\ 4 \\\\ 1 \\end{pmatrix}\n$$\n相应的残差为 $r_{\\mathrm{AS}}^{1} = b - Au_{\\mathrm{AS}}^{1}$。我们首先计算 $Au_{\\mathrm{AS}}^{1}$：\n$$\nAu_{\\mathrm{AS}}^{1} = \\frac{1}{4} \\begin{pmatrix} 2  -1  0  0  0 \\\\ -1  2  -1  0  0 \\\\ 0  -1  2  -1  0 \\\\ 0  0  -1  2  -1 \\\\ 0  0  0  -1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 4 \\\\ 10 \\\\ 4 \\\\ 1 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 2-4 \\\\ -1+8-10 \\\\ -4+20-4 \\\\ -10+8-1 \\\\ -4+2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} -2 \\\\ -3 \\\\ 12 \\\\ -3 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} -1/2 \\\\ -3/4 \\\\ 3 \\\\ -3/4 \\\\ -1/2 \\end{pmatrix}\n$$\n那么残差为：\n$$\nr_{\\mathrm{AS}}^{1} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} -1/2 \\\\ -3/4 \\\\ 3 \\\\ -3/4 \\\\ -1/2 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 3/4 \\\\ -2 \\\\ 3/4 \\\\ 1/2 \\end{pmatrix}\n$$\n加性 Schwarz 残差的欧几里得范数是：\n$$\n\\|r_{\\mathrm{AS}}^{1}\\|_{2} = \\sqrt{\\left(\\frac{1}{2}\\right)^{2} + \\left(\\frac{3}{4}\\right)^{2} + (-2)^{2} + \\left(\\frac{3}{4}\\right)^{2} + \\left(\\frac{1}{2}\\right)^{2}} = \\sqrt{\\frac{1}{4} + \\frac{9}{16} + 4 + \\frac{9}{16} + \\frac{1}{4}}\n$$\n$$\n\\|r_{\\mathrm{AS}}^{1}\\|_{2} = \\sqrt{2\\left(\\frac{1}{4}\\right) + 2\\left(\\frac{9}{16}\\right) + 4} = \\sqrt{\\frac{1}{2} + \\frac{9}{8} + 4} = \\sqrt{\\frac{4}{8} + \\frac{9}{8} + \\frac{32}{8}} = \\sqrt{\\frac{45}{8}}\n$$\n最后，我们计算所需的残差范数之比：\n$$\n\\frac{\\|b-Au_{\\mathrm{AS}}^{1}\\|_{2}}{\\|b-Au_{\\mathrm{J}}^{1}\\|_{2}} = \\frac{\\|r_{\\mathrm{AS}}^{1}\\|_{2}}{\\|r_{\\mathrm{J}}^{1}\\|_{2}} = \\frac{\\sqrt{\\frac{45}{8}}}{\\sqrt{\\frac{1}{2}}} = \\sqrt{\\frac{45/8}{1/2}} = \\sqrt{\\frac{45}{4}} = \\frac{\\sqrt{45}}{2} = \\frac{3\\sqrt{5}}{2}\n$$", "answer": "$$\n\\boxed{\\frac{3\\sqrt{5}}{2}}\n$$", "id": "2552509"}, {"introduction": "与重叠区域分解法不同，另一大类方法采用“先撕裂，后连接”的策略，在非重叠的子域上展开计算。本练习将向你介绍一种强大的非重叠方法——有限元撕裂与连接法 (FETI)。其核心思想是利用拉格朗日乘子 ($Lagrange multipliers$) 在子域间的交界面上强制施加连续性条件。你将通过推导并求解一个仅与拉格朗日乘子相关的简化系统，来亲身体验FETI方法的精髓，这个乘子在物理上代表了将各个子域“粘合”在一起所需的力。[@problem_id:2552477]", "problem": "考虑一个一维杆，它被分解为两个不重叠的子域，这两个子域在一个界面点相交。每个子域都由一个线性有限元离散化。杆的外端受到指定位移的约束，因此每个子域内的唯一代数未知数是界面位移，这些位移在子域间被复制为 $u_1$ 和 $u_2$。界面连续性约束为 $u_1 - u_2 = 0$。设左子域的子域折减刚度为 $k_1 = EA/\\ell$，右子域的为 $k_2 = EA/\\ell$，其数值分别为 $k_1 = 2$ 和 $k_2 = 6$。界面自由度上的等效节点力（由体力、面力和外部狄利克雷节点静力凝聚产生）在左子域的界面节点上为 $f_1 = 4$，在右子域的界面节点上为 $f_2 = 3$。有限元撕裂与连接（FETI）方法通过子域平衡方程和界面连续性约束，使用单个拉格朗日乘子 $\\lambda$ 来强制实现连续性。\n\n使用子域平衡方程 $K_i u_i + B_i^{\\top} \\lambda = f_i$（其中 $K_i = [k_i]$）以及跳跃算子块 $B_1 = [1]$ 和 $B_2 = [-1]$，按以下步骤进行：\n\n1) 从子域平衡方程和连续性约束 $B_1 u_1 + B_2 u_2 = 0$ 出发，消去 $u_1$ 和 $u_2$ 以组合成折减的 FETI 标量方程 $F \\lambda = d$。用 $k_1$、$k_2$、$f_1$ 和 $f_2$ 符号化地表示 $F$ 和 $d$，然后根据给定的数值数据 $k_1 = 2$、$k_2 = 6$、$f_1 = 4$ 和 $f_2 = 3$ 计算 $F$ 和 $d$ 的值。\n\n2) 对于预处理共轭梯度法（PCG），使用单位预处理器（即 $M=1$）和初始猜测值 $\\lambda_0 = 0$，对标量折减系统 $F \\lambda = d$ 执行一步 PCG。使用标准的 PCG 步骤定义残差 $r_0 = d - F \\lambda_0$、预处理残差 $z_0 = M r_0$、搜索方向 $p_0 = z_0$、步长 $\\alpha_0 = (r_0^{\\top} z_0)/(p_0^{\\top} F p_0)$ 以及更新后的乘子 $\\lambda_1 = \\lambda_0 + \\alpha_0 p_0$。计算 $\\lambda_1$ 的精确值。\n\n给出 $\\lambda_1$ 的最终答案，形式为一个精确的数字，不带单位。无需四舍五入。", "solution": "问题陈述经过验证，是科学上合理、适定、客观且自洽的。它代表了将有限元撕裂与连接（FETI）方法应用于一个简单一维问题的标准练习。我们将开始求解。\n\n问题分为两部分。首先，我们推导折减的 FETI 系统；其次，我们执行一次预处理共轭梯度（PCG）方法的迭代。\n\n**第 1 部分：推导 FETI 系统 $F \\lambda = d$**\n\n对于每个子域 $i \\in \\{1, 2\\}$，子域平衡方程如下：\n$$K_i u_i + B_i^{\\top} \\lambda = f_i$$\n在这个问题中，未知数 $u_i$ 是每个子域的标量界面位移。因此，刚度矩阵 $K_i$ 和跳跃算子块 $B_i$ 都是标量（或 $1 \\times 1$ 矩阵）。\n\n对于子域 1，其中 $K_1 = [k_1]$ 且 $B_1 = [1]$，平衡方程为：\n$$k_1 u_1 + \\lambda = f_1$$\n对于子域 2，其中 $K_2 = [k_2]$ 且 $B_2 = [-1]$，平衡方程为：\n$$k_2 u_2 - \\lambda = f_2$$\n\n子域刚度 $k_1$ 和 $k_2$ 是给定的非零正常数，这意味着子域问题是可逆的。我们可以用拉格朗日乘子 $\\lambda$ 和节点力 $f_1$、$f_2$ 来表示界面位移 $u_1$ 和 $u_2$：\n$$u_1 = k_1^{-1} (f_1 - \\lambda) = \\frac{f_1 - \\lambda}{k_1}$$\n$$u_2 = k_2^{-1} (f_2 + \\lambda) = \\frac{f_2 + \\lambda}{k_2}$$\n\n界面连续性约束以 $B_1 u_1 + B_2 u_2 = 0$ 的形式给出，可简化为：\n$$[1] u_1 + [-1] u_2 = 0 \\implies u_1 - u_2 = 0$$\n将 $u_1$ 和 $u_2$ 的表达式代入此连续性约束，得到关于 $\\lambda$ 的方程：\n$$\\frac{f_1 - \\lambda}{k_1} - \\frac{f_2 + \\lambda}{k_2} = 0$$\n我们必须重排这个方程以分离未知数 $\\lambda$，将含有 $\\lambda$ 的项归到一边，其余项归到另一边。\n$$\\frac{f_1}{k_1} - \\frac{\\lambda}{k_1} - \\frac{f_2}{k_2} - \\frac{\\lambda}{k_2} = 0$$\n$$\\lambda \\left(\\frac{1}{k_1} + \\frac{1}{k_2}\\right) = \\frac{f_1}{k_1} - \\frac{f_2}{k_2}$$\n这就是折减的 FETI 标量方程 $F \\lambda = d$，其中 FETI 算子 $F$ 和右侧向量 $d$ 的符号表示为：\n$$F = \\frac{1}{k_1} + \\frac{1}{k_2}$$\n$$d = \\frac{f_1}{k_1} - \\frac{f_2}{k_2}$$\n\n现在我们代入给定的数值：$k_1 = 2$，$k_2 = 6$，$f_1 = 4$ 和 $f_2 = 3$。\n$$F = \\frac{1}{2} + \\frac{1}{6} = \\frac{3}{6} + \\frac{1}{6} = \\frac{4}{6} = \\frac{2}{3}$$\n$$d = \\frac{4}{2} - \\frac{3}{6} = 2 - \\frac{1}{2} = \\frac{4}{2} - \\frac{1}{2} = \\frac{3}{2}$$\n待求解的标量系统为：\n$$\\frac{2}{3} \\lambda = \\frac{3}{2}$$\n\n**第 2 部分：一步 PCG 方法**\n\n我们的任务是使用单位预处理器 $M=1$ 和初始猜测值 $\\lambda_0 = 0$ 来执行一次预处理共轭梯度算法的迭代。\n\nPCG 算法的步骤如下：\n1.  计算初始残差 $r_0$：\n    $$r_0 = d - F \\lambda_0$$\n    当 $\\lambda_0 = 0$ 时，残差就是右侧项：\n    $$r_0 = d = \\frac{3}{2}$$\n\n2.  应用预处理器。题目给出的公式是 $z_0 = M r_0$。使用单位预处理器 $M=1$：\n    $$z_0 = 1 \\cdot r_0 = \\frac{3}{2}$$\n\n3.  设置初始搜索方向 $p_0$：\n    $$p_0 = z_0 = \\frac{3}{2}$$\n\n4.  计算步长 $\\alpha_0$。由于所有量都是标量，转置操作 $^\\top$ 等同于恒等操作。\n    $$\\alpha_0 = \\frac{r_0^{\\top} z_0}{p_0^{\\top} F p_0} = \\frac{r_0 z_0}{p_0 F p_0}$$\n    代入数值 $r_0 = \\frac{3}{2}$，$z_0 = \\frac{3}{2}$，$p_0 = \\frac{3}{2}$ 和 $F = \\frac{2}{3}$：\n    分子是：\n    $$r_0 z_0 = \\left(\\frac{3}{2}\\right) \\left(\\frac{3}{2}\\right) = \\frac{9}{4}$$\n    分母是：\n    $$p_0 F p_0 = \\left(\\frac{3}{2}\\right) \\left(\\frac{2}{3}\\right) \\left(\\frac{3}{2}\\right) = 1 \\cdot \\frac{3}{2} = \\frac{3}{2}$$\n    因此步长为：\n    $$\\alpha_0 = \\frac{9/4}{3/2} = \\frac{9}{4} \\cdot \\frac{2}{3} = \\frac{18}{12} = \\frac{3}{2}$$\n\n5.  更新解以获得 $\\lambda_1$：\n    $$\\lambda_1 = \\lambda_0 + \\alpha_0 p_0$$\n    代入数值：\n    $$\\lambda_1 = 0 + \\left(\\frac{3}{2}\\right) \\left(\\frac{3}{2}\\right) = \\frac{9}{4}$$\n\n这是一步 PCG 算法后的结果。一个基本事实是，对于一个标量方程（即 $1 \\times 1$ 系统），共轭梯度法在一次迭代中即可收敛到精确解。$\\frac{2}{3} \\lambda = \\frac{3}{2}$ 的精确解是 $\\lambda = \\frac{3}{2} / \\frac{2}{3} = \\frac{3}{2} \\cdot \\frac{3}{2} = \\frac{9}{4}$，这证实了我们的结果。\n最终答案是 $\\lambda_1 = 9/4$。", "answer": "$$\\boxed{\\frac{9}{4}}$$", "id": "2552477"}]}