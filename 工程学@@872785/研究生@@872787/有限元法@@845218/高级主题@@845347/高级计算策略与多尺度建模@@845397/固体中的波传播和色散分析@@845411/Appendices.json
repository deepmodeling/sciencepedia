{"hands_on_practices": [{"introduction": "当我们将波动方程离散化时，数值解的行为并不能完美地再现真实的物理过程，这种现象被称为数值色散。描述能量传播速度的群速度会受到这种数值色散的影响。本练习将指导您推导有限元模型的精确群速度，并量化其相对于真实物理速度的误差，这是评估波传播模拟准确性的一项基本技能。[@problem_id:2611394]", "problem": "考虑在一个均匀、等截面、线弹性杆中的纵向波传播，该杆占据一维域，具有均匀的横截面和材料属性。设轴向位移场为 $u(x,t)$，材料密度为 $\\rho$，杨氏模量为 $E$，波速为 $c$，其中 $c = \\sqrt{E/\\rho}$。其控制方程为线性波动方程 $u_{tt} = c^{2} u_{xx}$，其中下标表示对时间和空间求偏导。使用标准的伽辽金有限元法（FEM），在间距为 $h$ 的均匀网格上采用线性拉格朗日基函数对空间域进行离散化，并保留一致质量矩阵。假设在节点层面采用 Bloch-Floquet 波的拟设，形式为 $u_{j}(t) = U \\exp\\!\\big(i (j k h - \\omega t)\\big)$，其中 $j$ 是整数节点索引，$k$ 是波数，$\\omega$ 是角频率。仅使用基本平衡定律、波速 $c$ 的定义、带有线性形函数的伽辽金有限元构造以及 Bloch-Floquet 拟设，执行以下操作：\n\n- 推导在均匀网格上使用一致质量矩阵的组装系统的半离散色散关系 $\\tilde{\\omega}(k)$。\n- 对 $\\tilde{\\omega}(k)$ 关于 $k$ 求导，得到离散群速度 $c_{g}^{\\mathrm{FE}} = d\\tilde{\\omega}/dk$，并将其与连续群速度 $c = d\\omega/dk$ 进行比较。\n- 定义无量纲波数 $\\xi = k h$ 和相对群速度误差 $\\varepsilon_{g}(\\xi) = \\frac{c_{g}^{\\mathrm{FE}}}{c} - 1$。将您的最终答案表示为仅包含 $\\xi$ 的单一、精确、闭式解析表达式 $\\varepsilon_{g}(\\xi)$，不带单位。\n\n您的最终答案必须仅为 $\\varepsilon_{g}(\\xi)$ 的解析表达式。不要提供数值近似或单位。在最终的方框表达式中，不要包含除 $\\varepsilon_{g}(\\xi)$ 之外的任何其他量。", "solution": "对问题陈述进行验证。\n\n**第一步：提取已知条件**\n- **控制方程**：一维线性波动方程为 $u_{tt} = c^{2} u_{xx}$。\n- **材料属性和定义**：材料密度为 $\\rho$，杨氏模量为 $E$，连续波速为 $c = \\sqrt{E/\\rho}$。\n- **离散化方法**：在间距为 $h$ 的均匀网格上采用线性拉格朗日基函数的伽辽金有限元法（FEM）。使用一致质量矩阵。\n- **假定解的形式**：节点层面上的 Bloch-Floquet 波拟设为 $u_{j}(t) = U \\exp\\!\\big(i (j k h - \\omega t)\\big)$，其中 $j$ 是节点索引，$k$ 是波数，$\\omega$ 是角频率。\n- **要求推导**：\n  1. 推导半离散色散关系 $\\tilde{\\omega}(k)$。\n  2. 对 $\\tilde{\\omega}(k)$ 求导以获得离散群速度 $c_{g}^{\\mathrm{FE}} = d\\tilde{\\omega}/dk$。\n  3. 定义无量纲波数 $\\xi = k h$ 和相对群速度误差 $\\varepsilon_{g}(\\xi) = \\frac{c_{g}^{\\mathrm{FE}}}{c} - 1$。\n- **最终答案**：一个关于 $\\varepsilon_{g}(\\xi)$ 的单一、精确、闭式解析表达式。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据**：该问题在科学上是合理的。它涉及将有限元法应用于波动方程的数值色散分析这一标准课题，这是计算力学和波物理学中的一个基本概念。\n- **适定性**：该问题是适定的。它提供了所有必要的信息——控制方程、离散化方案和假定的解形式——以唯一地推导出所需的量。步骤逻辑上是顺序的，并导向一个单一、明确的答案。\n- **客观性**：问题陈述使用精确、客观和技术性的语言，没有歧义或主观论断。\n\n**第三步：结论与行动**\n问题是有效的。下面将给出解的严格推导过程。\n\n控制方程为一维波动方程：\n$$ \\rho u_{tt} - E u_{xx} = 0 $$\n弱形式是通过乘以一个测试函数 $v(x)$ 并在域上积分得到的。对于长度为 $h$ 的单元，其形式为：\n$$ \\int_{x_j}^{x_{j+1}} v (\\rho u_{tt}) \\, dx + \\int_{x_j}^{x_{j+1}} v_x (E u_x) \\, dx = 0 $$\n我们使用线性拉格朗日基函数 $N_j(x)$ 和 $N_{j+1}(x)$ 在单元内离散化位移场 $u(x,t)$：\n$$ u(x,t) = N_j(x) u_j(t) + N_{j+1}(x) u_{j+1}(t) $$\n使用伽辽金方法，测试函数选自与基函数相同的空间。这会产生单元质量矩阵 $\\mathbf{M}^e$ 和单元刚度矩阵 $\\mathbf{K}^e$。对于均匀横截面积 $A$（将被约去），长度为 $h$ 的线性单元的单元矩阵为：\n$$ \\mathbf{M}^e = \\frac{\\rho A h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} \\quad , \\quad \\mathbf{K}^e = \\frac{E A}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} $$\n组装后的半离散方程组形式为 $\\mathbf{M} \\ddot{\\mathbf{u}} + \\mathbf{K} \\mathbf{u} = \\mathbf{0}$。一个通用内部节点 $j$ 的方程是通过组装跨越节点 $(j-1, j)$ 的单元和跨越节点 $(j, j+1)$ 的单元的贡献得到的：\n$$ \\frac{\\rho A h}{6} (\\ddot{u}_{j-1} + 4 \\ddot{u}_j + \\ddot{u}_{j+1}) + \\frac{E A}{h} (-u_{j-1} + 2 u_j - u_{j+1}) = 0 $$\n我们代入 Bloch-Floquet 拟设 $u_j(t) = U \\exp(i(jkh - \\omega t))$。二阶时间导数为 $\\ddot{u}_j(t) = -\\omega^2 u_j(t)$。节点位移之间的关系为：\n$u_{j-1} = u_j \\exp(-ikh)$ 和 $u_{j+1} = u_j \\exp(ikh)$。\n将这些代入组装后的方程，并除以公因子 $A u_j(t)$，得到：\n$$ -\\omega^2 \\frac{\\rho h}{6} (\\exp(-ikh) + 4 + \\exp(ikh)) + \\frac{E}{h} (-\\exp(-ikh) + 2 - \\exp(ikh)) = 0 $$\n使用欧拉恒等式 $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$，我们简化表达式：\n$$ -\\omega^2 \\frac{\\rho h}{6} (4 + 2\\cos(kh)) + \\frac{E}{h} (2 - 2\\cos(kh)) = 0 $$\n我们求解 $\\omega^2$ 以找到离散色散关系。离散频率表示为 $\\tilde{\\omega}$：\n$$ \\tilde{\\omega}^2 \\rho \\frac{h}{6} (2(2 + \\cos(kh))) = \\frac{E}{h} (2(1 - \\cos(kh))) $$\n$$ \\tilde{\\omega}^2 = \\frac{E}{\\rho} \\frac{1}{h^2} \\frac{6(1 - \\cos(kh))}{2 + \\cos(kh)} $$\n使用定义 $c^2 = E/\\rho$ 和半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$：\n$$ \\tilde{\\omega}^2(k) = c^2 \\frac{6}{h^2} \\frac{2\\sin^2(kh/2)}{2 + \\cos(kh)} = \\frac{12 c^2}{h^2} \\frac{\\sin^2(kh/2)}{2 + \\cos(kh)} $$\n为了简化分母，我们使用 $\\cos(\\theta) = 1 - 2\\sin^2(\\theta/2)$，这得到 $2 + \\cos(kh) = 3 - 2\\sin^2(kh/2)$。\n$$ \\tilde{\\omega}^2(k) = \\frac{12 c^2}{h^2} \\frac{\\sin^2(kh/2)}{3 - 2\\sin^2(kh/2)} $$\n因此，离散色散关系为：\n$$ \\tilde{\\omega}(k) = \\frac{2\\sqrt{3} c}{h} \\frac{|\\sin(kh/2)|}{\\sqrt{3 - 2\\sin^2(kh/2)}} $$\n离散群速度为 $c_g^{\\mathrm{FE}} = d\\tilde{\\omega}/dk$。为了避免对 $\\tilde{\\omega}$ 进行复杂的求导，我们使用恒等式 $2\\tilde{\\omega} (d\\tilde{\\omega}/dk) = d(\\tilde{\\omega}^2)/dk$，这给出 $c_g^{\\mathrm{FE}} = \\frac{1}{2\\tilde{\\omega}} \\frac{d(\\tilde{\\omega}^2)}{dk}$。我们对 $\\tilde{\\omega}^2$ 的更简单表达式进行微分：\n$$ \\tilde{\\omega}^2(k) = \\frac{6 c^2}{h^2} \\frac{1 - \\cos(kh)}{2 + \\cos(kh)} $$\n使用商法则，我们求得关于 $k$ 的导数：\n$$ \\frac{d(\\tilde{\\omega}^2)}{dk} = \\frac{6 c^2}{h^2} \\frac{(h\\sin(kh))(2+\\cos(kh)) - (1-\\cos(kh))(-h\\sin(kh))}{(2+\\cos(kh))^2} $$\n$$ \\frac{d(\\tilde{\\omega}^2)}{dk} = \\frac{6 c^2 h \\sin(kh)}{h^2 (2+\\cos(kh))^2} (2+\\cos(kh) + 1-\\cos(kh)) = \\frac{18 c^2}{h} \\frac{\\sin(kh)}{(2+\\cos(kh))^2} $$\n现在我们构建群速度：\n$$ c_g^{\\mathrm{FE}} = \\frac{1}{2\\tilde{\\omega}} \\left( \\frac{18 c^2}{h} \\frac{\\sin(kh)}{(2+\\cos(kh))^2} \\right) $$\n代入 $\\tilde{\\omega}$ 的表达式：\n$$ c_g^{\\mathrm{FE}} = \\frac{1}{2 \\frac{\\sqrt{6}c}{h} \\sqrt{\\frac{1-\\cos(kh)}{2+\\cos(kh)}}} \\left( \\frac{18 c^2}{h} \\frac{\\sin(kh)}{(2+\\cos(kh))^2} \\right) $$\n$$ c_g^{\\mathrm{FE}} = \\frac{9 c}{\\sqrt{6}} \\frac{\\sin(kh)}{(2+\\cos(kh))^{3/2} \\sqrt{1-\\cos(kh)}} $$\n为简化起见，我们使用半角恒等式，并设 $\\xi = kh$：$\\sin(\\xi) = 2\\sin(\\xi/2)\\cos(\\xi/2)$，$1-\\cos(\\xi) = 2\\sin^2(\\xi/2)$，以及 $2+\\cos(\\xi) = 3 - 2\\sin^2(\\xi/2)$。假设我们在第一布里渊区 $\\xi \\in [0, \\pi]$，则有 $\\sin(\\xi/2) \\ge 0$。\n$$ c_g^{\\mathrm{FE}} = \\frac{9 c}{\\sqrt{6}} \\frac{2\\sin(\\xi/2)\\cos(\\xi/2)}{(3-2\\sin^2(\\xi/2))^{3/2} \\sqrt{2\\sin^2(\\xi/2)}} = \\frac{18 c}{\\sqrt{12}} \\frac{\\sin(\\xi/2)\\cos(\\xi/2)}{(3-2\\sin^2(\\xi/2))^{3/2} \\sin(\\xi/2)} $$\n$$ c_g^{\\mathrm{FE}} = \\frac{18 c}{2\\sqrt{3}} \\frac{\\cos(\\xi/2)}{(3-2\\sin^2(\\xi/2))^{3/2}} = \\frac{3\\sqrt{3} c \\cos(\\xi/2)}{(3-2\\sin^2(\\xi/2))^{3/2}} $$\n相对速度比为：\n$$ \\frac{c_g^{\\mathrm{FE}}}{c} = \\frac{3\\sqrt{3} \\cos(\\xi/2)}{(3-2\\sin^2(\\xi/2))^{3/2}} $$\n相对群速度误差 $\\varepsilon_{g}(\\xi)$ 定义为 $\\frac{c_{g}^{\\mathrm{FE}}}{c} - 1$。\n$$ \\varepsilon_{g}(\\xi) = \\frac{3\\sqrt{3} \\cos(\\xi/2)}{\\left(3 - 2\\sin^2(\\xi/2)\\right)^{3/2}} - 1 $$\n这就是相对群速度误差的最终解析表达式。", "answer": "$$\n\\boxed{\\frac{3\\sqrt{3} \\cos(\\frac{\\xi}{2})}{\\left(3 - 2\\sin^2(\\frac{\\xi}{2})\\right)^{3/2}} - 1}\n$$", "id": "2611394"}, {"introduction": "在理解了离散化带来的精度（色散）问题之后，进行模拟时一个至关重要的实际问题是确保数值稳定性。对于显式时间积分格式，其稳定性受到 Courant-Friedrichs-Lewy (CFL) 条件的限制，该条件将时间步长、网格尺寸和网格所能支持的最大波速联系起来。本练习将演示如何通过分析半离散系统的最高频率来确定稳定性极限，这是建立可靠的显式动力学模拟的关键一步。[@problem_id:2611374]", "problem": "考虑一维纵向波在均匀弹性杆中的传播，该杆具有恒定的杨氏模量 $E$、密度 $\\rho$ 和横截面积 $A$。位移场 $u(x,t)$ 满足运动方程\n$$\n\\rho A\\,\\frac{\\partial^{2} u}{\\partial t^{2}}=\\frac{\\partial}{\\partial x}\\!\\left(EA\\,\\frac{\\partial u}{\\partial x}\\right),\n$$\n对于恒定的 $E$ 和 $\\rho$，该方程可写为\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}}=c^{2}\\,\\frac{\\partial^{2} u}{\\partial x^{2}},\\quad c=\\sqrt{\\frac{E}{\\rho}}.\n$$\n使用长度为 $h$ 的双节点线性单元组成的均匀网格，通过标准 Galerkin 有限元法对杆进行空间离散化，并采用协调单元质量矩阵。设 $\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t)+\\mathbf{K}\\,\\mathbf{u}(t)=\\mathbf{0}$ 是在一个等效的无限均匀点阵上得到的半离散系统（通过假设 Bloch 周期波来忽略边界效应）。使用显式中心差分格式（即 $\\beta=0$ 和 $\\gamma=\\tfrac{1}{2}$ 的显式 Newmark 族）对此系统进行时间推进。\n\n从控制偏微分方程和有限元构造出发，对均匀点阵进行色散分析，以确定所有波数下的最高半离散频率，然后使用中心差分格式的放大因子分析来获得 Courant–Friedrichs–Lewy (CFL) 稳定性界限。最大允许时间步长 $\\Delta t_{\\max}$ 是多少，仅用网格尺寸 $h$ 和波速 $c$ 来表示？请用闭合形式（不含不等式）表达您的最终答案，单位为秒。请勿四舍五入。", "solution": "对问题陈述进行验证。\n\n已知条件逐字提取如下：\n1.  一维纵向波传播的控制偏微分方程 (PDE)：$\\rho A\\,\\frac{\\partial^{2} u}{\\partial t^{2}}=\\frac{\\partial}{\\partial x}\\!\\left(EA\\,\\frac{\\partial u}{\\partial x}\\right)$。\n2.  对于恒定的杨氏模量 $E$ 和密度 $\\rho$，该 PDE 为 $\\frac{\\partial^{2} u}{\\partial t^{2}}=c^{2}\\,\\frac{\\partial^{2} u}{\\partial x^{2}}$，其中波速为 $c=\\sqrt{\\frac{E}{\\rho}}$。\n3.  空间离散化方法：均匀网格上的标准 Galerkin 有限元法 (FEM)。\n4.  单元类型：长度为 $h$ 的双节点线性单元。\n5.  质量矩阵公式：协调单元质量矩阵。\n6.  半离散常微分方程 (ODE) 系统为 $\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t)+\\mathbf{K}\\,\\mathbf{u}(t)=\\mathbf{0}$。\n7.  边界条件：假设为等效的无限均匀点阵，这意味着解为 Bloch 周期波。\n8.  时间积分格式：显式中心差分格式，它是 Newmark 族的一个成员，参数为 $\\beta=0$ 和 $\\gamma=\\frac{1}{2}$。\n9.  目标是求出稳定性的最大允许时间步长 $\\Delta t_{\\max}$，并用 $h$ 和 $c$ 表示。\n\n验证结论：\n该问题具有科学依据、是适定且客观的。它描述了计算力学中分析应用于空间离散波动方程的时间推进格式的数值稳定性的标准流程。物理模型（一维波动方程）、空间离散化方法（使用线性单元的 FEM）、质量矩阵公式（协调）和时间积分格式（中心差分）都是标准的且被正确指定。其假设（用于色散分析的无限点阵）对于 von Neumann 型稳定性分析是适当的。该问题是自洽的，并提供了求解所需的所有必要信息。不存在科学缺陷、不一致或歧义。\n\n该问题被认为是有效的。将提供解答。\n\n确定最大允许时间步长 $\\Delta t_{\\max}$ 需要两个主要步骤。首先，对半离散系统进行色散分析，以找到有限元网格所支持的最高固有频率 $\\omega_{\\max}$。其次，对中心差分时间积分格式进行稳定性分析，以将 $\\Delta t_{\\max}$ 与 $\\omega_{\\max}$ 联系起来。\n\n步骤1：半离散系统的色散分析\n\n考虑一个长度为 $h$ 的双节点线性有限元。单元内的位移场 $u(x')$（在局部坐标 $x' \\in [0, h]$ 中）是使用线性形函数 $\\mathbf{N}(x') = \\begin{pmatrix} N_1(x')  N_2(x') \\end{pmatrix}$ 从节点位移 $\\mathbf{u}^e = \\begin{pmatrix} u_1  u_2 \\end{pmatrix}^T$ 插值得到的，其中 $N_1(x') = 1 - \\frac{x'}{h}$ 且 $N_2(x') = \\frac{x'}{h}$。\n\n单元刚度矩阵 $\\mathbf{k}^e$ 由下式给出：\n$$\n\\mathbf{k}^e = \\int_{0}^{h} \\mathbf{B}^T (EA) \\mathbf{B} \\,dx'\n$$\n其中 $\\mathbf{B} = \\frac{d\\mathbf{N}}{dx'} = \\begin{pmatrix} -\\frac{1}{h}  \\frac{1}{h} \\end{pmatrix}$。\n$$\n\\mathbf{k}^e = EA \\int_{0}^{h} \\begin{pmatrix} -1/h \\\\ 1/h \\end{pmatrix} \\begin{pmatrix} -1/h  1/h \\end{pmatrix} \\,dx' = \\frac{EA}{h^2} \\int_{0}^{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} \\,dx' = \\frac{EA}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}.\n$$\n\n协调单元质量矩阵 $\\mathbf{m}^e$ 由下式给出：\n$$\n\\mathbf{m}^e = \\int_{0}^{h} \\mathbf{N}^T (\\rho A) \\mathbf{N} \\,dx' = \\rho A \\int_0^h \\begin{pmatrix} (1 - x'/h)^2  (x'/h)(1 - x'/h) \\\\ (x'/h)(1 - x'/h)  (x'/h)^2 \\end{pmatrix} \\,dx'.\n$$\n积分的计算结果为：\n$$\n\\mathbf{m}^e = \\rho A h \\begin{pmatrix} 1/3  1/6 \\\\ 1/6  1/3 \\end{pmatrix} = \\frac{\\rho A h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}.\n$$\n\n对于无限均匀点阵，通用节点 $j$ 的运动方程由两个相邻单元 $(j-1, j)$ 和 $(j, j+1)$ 的贡献组装而成。这得到：\n$$\n\\frac{\\rho A h}{6} (\\ddot{u}_{j-1} + 4 \\ddot{u}_j + \\ddot{u}_{j+1}) + \\frac{EA}{h} (-u_{j-1} + 2u_j - u_{j+1}) = 0.\n$$\n\n为进行色散分析，假设一个形式为 $u_j(t) = \\hat{u} \\exp(i(\\omega_h t - k_n j h))$ 的 Bloch 周期波解，其中 $\\omega_h$ 是半离散频率， $k_n$ 是波数。将此形式代入运动方程得到：\n$$\nu_{j \\pm 1} = u_j \\exp(\\mp i k_n h) \\quad \\text{和} \\quad \\ddot{u}_j = -\\omega_h^2 u_j.\n$$\n节点 $j$ 的方程变为：\n$$\n-\\omega_h^2 \\frac{\\rho A h}{6} (\\exp(ik_n h) + 4 + \\exp(-ik_n h)) + \\frac{EA}{h} (-\\exp(ik_n h) + 2 - \\exp(-ik_n h)) = 0.\n$$\n使用恒等式 $2\\cos\\theta = e^{i\\theta} + e^{-i\\theta}$，方程简化为：\n$$\n-\\omega_h^2 \\frac{\\rho A h}{6} (2\\cos(k_n h) + 4) + \\frac{EA}{h} (2 - 2\\cos(k_n h)) = 0.\n$$\n求解 $\\omega_h^2$：\n$$\n\\omega_h^2 \\frac{\\rho A h}{3} (2 + \\cos(k_n h)) = \\frac{2EA}{h} (1 - \\cos(k_n h)).\n$$\n引入 $c^2 = E/\\rho$，我们得到半离散系统的色散关系：\n$$\n\\omega_h^2 = \\frac{6c^2}{h^2} \\frac{1 - \\cos(k_n h)}{2 + \\cos(k_n h)}.\n$$\n\n最高半离散频率 $\\omega_{\\max}$ 出现在依赖于波数的项被最大化时。令 $\\theta = k_n h$。需要最大化的函数是 $f(\\theta) = \\frac{1 - \\cos\\theta}{2 + \\cos\\theta}$。网格能解析的最短波长是 $\\lambda_{\\min} = 2h$，对应于最高波数 $k_{\\max} = \\pi/h$。因此，$\\theta$ 的定义域是 $[0, \\pi]$。函数 $f(\\theta)$ 关于 $(-\\cos\\theta)$ 是单调递增的，因此当 $\\cos\\theta$ 最小时，$f(\\theta)$ 最大化。$\\cos\\theta$ 的最小值为 $-1$，这发生在 $\\theta = \\pi$ 时（即 $k_n h = \\pi$）。\n将 $\\cos(k_n h) = -1$ 代入色散关系，得到最大频率的平方：\n$$\n\\omega_{\\max}^2 = \\frac{6c^2}{h^2} \\frac{1 - (-1)}{2 + (-1)} = \\frac{6c^2}{h^2} \\frac{2}{1} = \\frac{12c^2}{h^2}.\n$$\n最大半离散频率是：\n$$\n\\omega_{\\max} = \\sqrt{\\frac{12c^2}{h^2}} = \\frac{2\\sqrt{3}c}{h}.\n$$\n\n步骤2：中心差分格式的稳定性分析\n\n半离散系统可以解耦为一组模态方程，每个方程都具有简谐振子的形式：\n$$\n\\ddot{q}(t) + \\omega_h^2 q(t) = 0.\n$$\n二阶导数的中心差分近似为 $\\ddot{q}_n \\approx (q_{n+1} - 2q_n + q_{n-1})/\\Delta t^2$。将其应用于模态方程得到：\n$$\n\\frac{q_{n+1} - 2q_n + q_{n-1}}{\\Delta t^2} + \\omega_h^2 q_n = 0.\n$$\n重新整理得到递推关系：\n$$\nq_{n+1} - (2 - \\omega_h^2 \\Delta t^2) q_n + q_{n-1} = 0.\n$$\n为了获得稳定的数值解，特征多项式 $G^2 - (2 - \\omega_h^2 \\Delta t^2)G + 1 = 0$ 的根的模必须满足 $|G| \\leq 1$。此条件当且仅当根是单位圆上的共轭复数时满足，这要求二次方程的判别式为非正。一个更直接的方法是要求 $q_n$ 的系数在 $[-2, 2]$ 范围内。\n$$\n-2 \\le 2 - \\omega_h^2 \\Delta t^2 \\le 2.\n$$\n右侧不等式 $2 - \\omega_h^2 \\Delta t^2 \\le 2$ 意味着 $-\\omega_h^2 \\Delta t^2 \\le 0$，它总是被满足的。\n左侧不等式 $-2 \\le 2 - \\omega_h^2 \\Delta t^2$ 给出稳定性条件：\n$$\n\\omega_h^2 \\Delta t^2 \\le 4 \\implies \\omega_h \\Delta t \\le 2.\n$$\n为使整个方程组稳定，此条件必须对所有频率 $\\omega_h$ 成立。最严格的约束是由最大频率 $\\omega_{\\max}$ 施加的：\n$$\n\\omega_{\\max} \\Delta t \\le 2.\n$$\n因此最大允许时间步长为：\n$$\n\\Delta t_{\\max} = \\frac{2}{\\omega_{\\max}}.\n$$\n\n步骤3：最终结果\n\n将步骤1中 $\\omega_{\\max}$ 的表达式代入步骤2的稳定性极限：\n$$\n\\Delta t_{\\max} = \\frac{2}{2\\sqrt{3}c/h} = \\frac{h}{\\sqrt{3}c}.\n$$\n此表达式可以使用 Courant 数 $C_n = c\\Delta t/h$ 重写。稳定性极限是 $C_n \\le 1/\\sqrt{3}$。最大时间步长是等号成立的情况。\n\n最终答案是最大允许时间步长 $\\Delta t_{\\max}$，仅用网格尺寸 $h$ 和波速 $c$ 表示。\n$$\n\\Delta t_{\\max} = \\frac{h}{c\\sqrt{3}}.\n$$", "answer": "$$\n\\boxed{\\frac{h}{c\\sqrt{3}}}\n$$", "id": "2611374"}, {"introduction": "我们对数值色散的理论理解不仅仅是学术探讨，更是解释模拟或实验数据的有力工具。通过使用正确的半离散色散关系作为模型，我们可以从含噪声的数据中更准确地估计物理参数（如波速），从而校正由离散化引入的系统误差。这项高级练习要求您实现并比较一个忽略数值效应的朴素估计器和一个考虑了模型误差的估计器，并使用统计自助法（bootstrap）来量化结果的不确定性，从而将数值理论与数据科学联系起来。[@problem_id:2611327]", "problem": "给定一根一维、均质、线性弹性杆，该杆通过标准的双节点线性有限元在单元尺寸为 $h$、节点间距为 $h$ 的均匀网格上进行离散化，并采用一致质量矩阵。小振幅轴向波以纵波波速 $c = \\sqrt{E/\\rho}$ 传播，其中 $E$ 是杨氏模量，$\\rho$ 是质量密度。设 $u(x,t)$ 表示轴向位移，$x$ 是以米为单位的空间坐标，$t$ 是以秒为单位的时间。您将分析从受加性噪声污染的有限元数据中提取色散信息，量化由噪声和离散化误差引起的不确定性，并实现一种残差自助法（residual bootstrap）来计算推断波速的双侧置信区间。\n\n起点和范围：\n- 从轴向波动方程 $u_{tt}(x,t) = c^2 u_{xx}(x,t)$ 和在均匀网格上使用一致质量的标准线性有限元半离散化开始。假设在由整数索引的节点上采用离散空间傅里叶（Bloch）拟设，节点间距等于 $h$。\n- 最初不要假设任何色散公式。您必须从第一性原理出发，推导出连接角频率 $\\omega$ 和波数 $k$ 的半离散色散关系，该关系适用于在均匀网格上使用一致质量的线性单元半离散化。\n- 将“测量”的色散数据视为在给定波数 $k$ 下角频率 $\\omega$ 的带噪样本，其中 $\\omega$ 中的加性、独立、零均值噪声具有已知的标准差 $\\sigma_\\omega$（单位为 $\\mathrm{rad/s}$）。\n- 定义并比较两种 $c$ 的估计量：\n  1. 一种忽略离散化的朴素估计量，通过原点的最小二乘法拟合连续模型 $\\omega \\approx c\\,k$。\n  2. 一种基于模型的非线性最小二乘估计量，该估计量拟合您推导出的半离散有限元色散关系。\n- 为每种估计量提出并实现一个残差自助法程序，以构建双侧 $95\\%$ 置信区间（将界限表示为十进制数，输出中不使用百分号，并报告 $c$ 的区间端点，单位为 $\\mathrm{m/s}$）。\n\n推导要求：\n- 从 $u_{tt}(x,t) = c^2 u_{xx}(x,t)$、在间距为 $h$ 的均匀网格上使用一致质量的标准线性有限元方法，以及离散布洛赫波拟设 $u_j(t) = \\Re\\{U\\,e^{\\mathrm{i}(j q - \\omega t)}\\}$（其中 $q = k h$）出发，推导出一个连接 $\\omega$、$k$、$c$ 和 $h$ 的封闭形式的半离散色散关系。\n\n统计建模和自助法要求：\n- 假设“测量”数据为 $N$ 对 $(k_i, \\omega_i)$，其中 $k_i$ 的单位为 $\\mathrm{rad/m}$，$\\omega_i$ 的单位为 $\\mathrm{rad/s}$。对于基于模型的估计量，模型为 $\\omega_i = \\omega_\\text{FE}(k_i; c, h) + \\varepsilon_i$，其中 $\\omega_\\text{FE}$ 是您推导的半离散色散关系，$\\varepsilon_i$ 是独立的，具有零均值和有限方差。对于朴素估计量，将 $\\omega_\\text{FE}(k_i; c, h)$ 替换为 $c\\,k_i$。\n- 对于每个估计量：计算最小二乘拟合以获得 $\\widehat{c}$，计算残差 $r_i = \\omega_i - \\widehat{\\omega}_i$，通过减去样本均值来中心化残差以获得 $r_i^\\circ$，并执行具有 $B$ 次重采样的残差自助法：\n  - 对于每个自助法重复采样 $b \\in \\{1,\\dots,B\\}$，从 $\\{r_i^\\circ\\}$ 中有放回地抽取 $N$ 个残差，形成综合响应 $\\omega_i^{*(b)} = \\widehat{\\omega}_i + r_{j(i)}^\\circ$，重新拟合以获得 $\\widehat{c}^{*(b)}$，并存储结果。\n  - 使用 $\\{\\widehat{c}^{*(b)}\\}_{b=1}^B$ 在水平 $0.025$ 和 $0.975$ 处的经验分位数来构建 $c$ 的双侧 $95\\%$ 置信区间。所有速度均以 $\\mathrm{m/s}$ 为单位报告。\n\n数值实验设计（测试套件）：\n- 使用以下独立的测试用例。在每个用例中，通过选择在 $k_{\\min}$ 和 $k_{\\max}$ 之间线性间隔的 $N$ 个波数，计算无噪声的 $\\omega_\\text{FE}(k_i; c_\\text{true}, h)$，然后添加标准差为 $\\sigma_\\omega$（单位为 $\\mathrm{rad/s}$）的独立高斯噪声来生成综合“测量”数据。\n- 为保证可复现性，将随机数生成器种子固定为 $s=7$。\n- 对于每个测试用例，使用 $B=200$ 次自助法重复采样。\n- 三个测试用例是：\n  1. 用例 A：$c_\\text{true} = 5100\\,\\mathrm{m/s}$，$h = 0.02\\,\\mathrm{m}$，$N = 40$，$k_{\\min} = 0.10\\,\\pi/h$，$k_{\\max} = 0.80\\,\\pi/h$，$\\sigma_\\omega = 20000\\,\\mathrm{rad/s}$。\n  2. 用例 B：$c_\\text{true} = 4800\\,\\mathrm{m/s}$，$h = 0.05\\,\\mathrm{m}$，$N = 60$，$k_{\\min} = 0.15\\,\\pi/h$，$k_{\\max} = 0.90\\,\\pi/h$，$\\sigma_\\omega = 50000\\,\\mathrm{rad/s}$。\n  3. 用例 C：$c_\\text{true} = 5200\\,\\mathrm{m/s}$，$h = 0.02\\,\\mathrm{m}$，$N = 30$，$k_{\\min} = 0.01\\,\\pi/h$，$k_{\\max} = 0.10\\,\\pi/h$，$\\sigma_\\omega = 5000\\,\\mathrm{rad/s}$。\n\n编程任务：\n- 实现一个完整的、可运行的程序，该程序：\n  - 推导并使用您获得的半离散色散关系来合成 $\\omega_i$ 并拟合基于模型的估计量。\n  - 实现两种估计量及其 $B=200$ 次的残差自助法。\n  - 对于每个测试用例，返回一个包含六个浮点数的列表，单位为 $\\mathrm{m/s}$：$[\\widehat{c}_\\text{naive}, c_{\\text{naive},\\;0.025}, c_{\\text{naive},\\;0.975}, \\widehat{c}_\\text{FE}, c_{\\text{FE},\\;0.025}, c_{\\text{FE},\\;0.975}]$，其中下标表示双侧 $95\\%$ 置信区间的下界和上界。\n  - 将报告的每个数字四舍五入到三位小数。\n- 最终输出格式：\n  - 您的程序应生成单行输出，其中包含一个逗号分隔的列表，该列表由三个用方括号括起来的、按用例排列的列表组成。例如，一个正确形状的输出如下所示：$[[a_1,a_2,a_3,a_4,a_5,a_6],[b_1,b_2,b_3,b_4,b_5,b_6],[c_1,c_2,c_3,c_4,c_5,c_6]]$，其中所有符号都表示以 $\\mathrm{m/s}$ 为单位的浮点数。", "solution": "所提出的问题是有效的。它在科学上基于连续介质力学、有限元方法和统计推断的原理。问题陈述清晰，为解析推导和数值实验提供了所有必要的参数和条件。目标明确且可形式化。\n\n该任务要求推导杆中轴向波的半离散色散关系，实现两种不同的波速 $c$ 估计量，并使用残差自助法程序量化不确定性。\n\n**1. 半离散色散关系的推导**\n\n均质、线性弹性杆中小振幅轴向波的控制方程是一维波动方程：\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\n其中 $u(x,t)$ 是轴向位移，$t$ 是时间，$x$ 是空间坐标，$c = \\sqrt{E/\\rho}$ 是纵波波速，其中 $E$ 是杨氏模量，$\\rho$ 是质量密度。\n\n我们使用标准的双节点线性单元，在节点间距为 $h$ 的均匀网格上应用有限元方法。控制方程的弱形式，在域上积分并对空间项进行分部积分后，为：\n$$\n\\int \\rho v \\frac{\\partial^2 u}{\\partial t^2} \\,dx + \\int E v_x u_x \\,dx = 0\n$$\n其中 $v$ 是一个合适的测试函数，我们假设边界项消失。对于长度为 $h$ 的单个单元，标准的线性形函数导出单元一致质量矩阵 $\\mathbf{M}^e$ 和刚度矩阵 $\\mathbf{K}^e$：\n$$\n\\mathbf{M}^e = \\frac{\\rho A h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}, \\quad \\mathbf{K}^e = \\frac{E A}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n其中 $A$ 是横截面积。节点位移向量 $\\mathbf{U}(t)$ 的半离散系统为 $\\mathbf{M} \\ddot{\\mathbf{U}} + \\mathbf{K} \\mathbf{U} = \\mathbf{0}$。对于一个无限均匀的网格，我们可以通过组装来自两个相邻单元 $(j-1, j)$ 和 $(j, j+1)$ 的贡献，写出通用内部节点 $j$ 的运动方程。这得到：\n$$\n\\frac{\\rho A h}{6} (\\ddot{u}_{j-1} + 4\\ddot{u}_j + \\ddot{u}_{j+1}) + \\frac{E A}{h} (-u_{j-1} + 2u_j - u_{j+1}) = 0\n$$\n两边除以 $\\rho A$ 并使用 $c^2 = E/\\rho$，我们得到：\n$$\n\\frac{h}{6} (\\ddot{u}_{j-1} + 4\\ddot{u}_j + \\ddot{u}_{j+1}) + \\frac{c^2}{h} (-u_{j-1} + 2u_j - u_{j+1}) = 0\n$$\n我们寻找形式为 $u_j(t) = U e^{\\mathrm{i}(jkh - \\omega t)}$ 的离散平面波（布洛赫波）解，其中 $k$ 是波数，$\\omega$ 是角频率。时间二阶导数为 $\\ddot{u}_j(t) = -\\omega^2 u_j(t)$。将此式和空间形式代入运动方程得到：\n$$\n-\\omega^2 \\frac{h}{6} (e^{-\\mathrm{i}kh} + 4 + e^{\\mathrm{i}kh}) u_j + \\frac{c^2}{h} (-e^{-\\mathrm{i}kh} + 2 - e^{\\mathrm{i}kh}) u_j = 0\n$$\n两边除以 $u_j$ 并使用恒等式 $e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta} = 2\\cos(\\theta)$，我们简化表达式：\n$$\n-\\omega^2 \\frac{h}{6} (2\\cos(kh) + 4) + \\frac{c^2}{h} (2 - 2\\cos(kh)) = 0\n$$\n整理以求解 $\\omega^2$：\n$$\n\\omega^2 \\frac{h}{3} (2 + \\cos(kh)) = \\frac{2c^2}{h} (1 - \\cos(kh))\n$$\n这导出了适用于一致质量线性有限元的半离散色散关系：\n$$\n\\omega^2 = \\frac{6c^2}{h^2} \\frac{1 - \\cos(kh)}{2 + \\cos(kh)}\n$$\n对于正频率，显式关系为：\n$$\n\\omega_\\text{FE}(k; c, h) = c \\sqrt{\\frac{6}{h^2} \\frac{1 - \\cos(kh)}{2 + \\cos(kh)}}\n$$\n在长波极限（$kh \\to 0$）下，此关系正确地恢复了连续介质的色散关系 $\\omega = ck$。\n\n**2. 波速估计量**\n\n给定一组 $N$ 个带噪测量值 $(k_i, \\omega_i)$，我们定义两种 $c$ 的估计量。\n\n**朴素估计量**：此估计量忽略了有限元离散化引入的数值色散，并假设采用连续模型 $\\omega \\approx ck$。数据模型为 $\\omega_i = c k_i + \\varepsilon_i$。这是一个通过原点的线性回归问题。最小二乘估计 $\\widehat{c}_\\text{naive}$ 最小化 $\\sum_{i=1}^N (\\omega_i - c k_i)^2$，从而得到：\n$$\n\\widehat{c}_\\text{naive} = \\frac{\\sum_{i=1}^N k_i \\omega_i}{\\sum_{i=1}^N k_i^2}\n$$\n\n**基于模型（FE）的估计量**：此估计量使用推导出的半离散色散关系。数据模型为 $\\omega_i = \\omega_\\text{FE}(k_i; c, h) + \\varepsilon_i$。我们可以将模型重写为：\n$$\n\\omega_i = c \\cdot f(k_i, h) + \\varepsilon_i, \\quad \\text{其中} \\quad f(k, h) = \\sqrt{\\frac{6}{h^2} \\frac{1 - \\cos(kh)}{2 + \\cos(kh)}}\n$$\n虽然该模型是 $k$ 的非线性函数，但它对于待估计参数 $c$ 是线性的（因为 $h$ 是已知的）。该问题同样是一个通过原点的线性回归问题，只是自变量经过了变换。最小二乘估计 $\\widehat{c}_\\text{FE}$ 最小化 $\\sum_{i=1}^N (\\omega_i - c \\cdot f(k_i, h))^2$，得到：\n$$\n\\widehat{c}_\\text{FE} = \\frac{\\sum_{i=1}^N f(k_i, h) \\omega_i}{\\sum_{i=1}^N f(k_i, h)^2}\n$$\n\n**3. 不确定性量化：残差自助法**\n\n为了为每种估计量构建 $c$ 的 $95\\%$ 置信区间，我们采用残差自助法。这种非参数方法避免了对误差分布或估计量抽样分布的强假设。其步骤如下：\n1.  计算点估计 $\\widehat{c}$（$\\widehat{c}_\\text{naive}$ 或 $\\widehat{c}_\\text{FE}$）。\n2.  基于拟合模型计算预测频率 $\\widehat{\\omega}_i$（即 $\\widehat{\\omega}_i = \\widehat{c} k_i$ 或 $\\widehat{\\omega}_i = \\widehat{c} f(k_i, h)$）。\n3.  计算残差 $r_i = \\omega_i - \\widehat{\\omega}_i$。\n4.  中心化残差以确保其均值为零：$r_i^\\circ = r_i - \\frac{1}{N}\\sum_{j=1}^N r_j$。\n5.  执行 $B$ 次自助法重复采样。对于每次重复 $b = 1, \\dots, B$：\n    a.  通过从中心化残差集合 $\\{r_i^\\circ\\}$ 中有放回地抽样，得到一组新的 $N$ 个残差 $\\{r_{j(i)}^\\circ\\}$。\n    b.  创建一组综合频率数据：$\\omega_i^{*(b)} = \\widehat{\\omega}_i + r_{j(i)}^\\circ$。\n    c.  使用综合数据 $(\\omega_i^{*(b)}, k_i)$ 重新计算估计值 $\\widehat{c}^{*(b)}$。\n6.  自助法估计值的集合 $\\{\\widehat{c}^{*(b)}\\}_{b=1}^B$ 构成了 $\\widehat{c}$ 抽样分布的经验近似。$c$ 的双侧 $95\\%$ 置信区间由该分布的第 $2.5$ 百分位数和第 $97.5$ 百分位数给出。\n\n**4. 实现策略**\n\n数值实验将使用 Python 的 `numpy` 和 `scipy` 库实现。\n- 对于每个测试用例，生成综合“测量”数据 $(\\omega_i, k_i)$。波数 $k_i$ 在指定范围内线性间隔。真实频率使用 $\\omega_{\\text{true},i} = \\omega_\\text{FE}(k_i; c_\\text{true}, h)$ 计算。然后添加零均值、标准差为 $\\sigma_\\omega$ 的高斯噪声。固定的随机种子确保可复现性。\n- 使用 `scipy.linalg.lstsq` 高效计算 $c$ 的最小二乘估计，该函数求解由正规方程产生的线性矩阵方程。\n- 如上所述，为 $B=200$ 次重复采样实现残差自助法程序。\n- 每个用例的最终输出包括朴素估计量和基于模型估计量的点估计和置信区间界限，四舍五入到三位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import lstsq\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating wave speed `c` from noisy dispersion data\n    using two different models and quantifies uncertainty via residual bootstrap.\n    \"\"\"\n    # Fix the random number generator seed for reproducibility.\n    RNG = np.random.default_rng(7)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {\n            \"c_true\": 5100.0, \"h\": 0.02, \"N\": 40,\n            \"k_min_factor\": 0.10, \"k_max_factor\": 0.80, \"sigma_omega\": 20000.0,\n        },\n        # Case B\n        {\n            \"c_true\": 4800.0, \"h\": 0.05, \"N\": 60,\n            \"k_min_factor\": 0.15, \"k_max_factor\": 0.90, \"sigma_omega\": 50000.0,\n        },\n        # Case C\n        {\n            \"c_true\": 5200.0, \"h\": 0.02, \"N\": 30,\n            \"k_min_factor\": 0.01, \"k_max_factor\": 0.10, \"sigma_omega\": 5000.0,\n        },\n    ]\n\n    B = 200  # Number of bootstrap replicates\n\n    def omega_fe_func(k, c, h):\n        \"\"\"Calculates angular frequency from the derived FE dispersion relation.\"\"\"\n        kh = k * h\n        # This term can be nan if cos(kh) is -2, but that's impossible.\n        # Add a small epsilon to denominator to be safe, though not strictly needed here.\n        denominator = h**2 * (2.0 + np.cos(kh))\n        \n        # Check for non-physical denominator (should not happen for real kh)\n        # but good practice for numerical stability\n        if np.any(denominator = 0):\n             raise ValueError(\"Division by zero or negative value in dispersion relation.\")\n             \n        numerator = 6.0 * (c**2) * (1.0 - np.cos(kh))\n        return np.sqrt(numerator / denominator)\n\n    def perform_bootstrap_analysis(k_data, omega_data, h, estimator_type):\n        \"\"\"\n        Performs point estimation and residual bootstrap for a given estimator type.\n        \"\"\"\n        \n        if estimator_type == 'naive':\n            # Model: omega = c * k\n            A = k_data[:, np.newaxis]\n        elif estimator_type == 'fe':\n            # Model: omega = c * f(k,h)\n            kh = k_data * h\n            fe_factor = np.sqrt(6.0 / h**2 * (1.0 - np.cos(kh)) / (2.0 + np.cos(kh)))\n            A = fe_factor[:, np.newaxis]\n        else:\n            raise ValueError(\"Unknown estimator type.\")\n\n        # 1. Point Estimation using least squares\n        c_hat_vec, _, _, _ = lstsq(A, omega_data)\n        c_hat = c_hat_vec[0]\n\n        # 2. Compute and center residuals\n        omega_hat = A.flatten() * c_hat\n        residuals = omega_data - omega_hat\n        centered_residuals = residuals - np.mean(residuals)\n        \n        # 3. Perform bootstrap\n        c_bootstrap_samples = np.zeros(B)\n        for i in range(B):\n            # Resample residuals with replacement\n            bootstrap_residuals = RNG.choice(centered_residuals, size=len(k_data), replace=True)\n            # Create synthetic data\n            omega_star = omega_hat + bootstrap_residuals\n            # Re-estimate c on synthetic data\n            c_star_vec, _, _, _ = lstsq(A, omega_star)\n            c_bootstrap_samples[i] = c_star_vec[0]\n            \n        # 4. Determine confidence interval from percentiles\n        ci_lower, ci_upper = np.percentile(c_bootstrap_samples, [2.5, 97.5])\n        \n        return [c_hat, ci_lower, ci_upper]\n\n    all_results = []\n    for case in test_cases:\n        # Generate synthetic data for the current test case\n        h = case[\"h\"]\n        N = case[\"N\"]\n        c_true = case[\"c_true\"]\n        sigma_omega = case[\"sigma_omega\"]\n        \n        k_min = case[\"k_min_factor\"] * np.pi / h\n        k_max = case[\"k_max_factor\"] * np.pi / h\n        k_values = np.linspace(k_min, k_max, N)\n        \n        # Ground truth frequencies based on FE model\n        omega_true = omega_fe_func(k_values, c_true, h)\n        \n        # \"Measured\" frequencies with additive Gaussian noise\n        noise = RNG.normal(0, sigma_omega, N)\n        omega_measured = omega_true + noise\n        \n        # Analyze using the naive estimator\n        naive_results = perform_bootstrap_analysis(k_values, omega_measured, h, 'naive')\n        \n        # Analyze using the model-based FE estimator\n        fe_results = perform_bootstrap_analysis(k_values, omega_measured, h, 'fe')\n        \n        # Combine results for the case and round to 3 decimal places\n        case_results = [round(x, 3) for x in naive_results + fe_results]\n        all_results.append(case_results)\n\n    # Format the final output string exactly as specified\n    str_results = []\n    for res_list in all_results:\n        str_list = f\"[{','.join(map(str, res_list))}]\"\n        str_results.append(str_list)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str_results)}]\")\n\nsolve()\n```", "id": "2611327"}]}