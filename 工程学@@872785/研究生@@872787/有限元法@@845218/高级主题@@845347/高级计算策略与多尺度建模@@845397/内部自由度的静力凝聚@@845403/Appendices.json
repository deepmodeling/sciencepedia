{"hands_on_practices": [{"introduction": "静态凝聚的核心在于其代数过程，通过该过程我们可以从一个更大的耦合系统中消去内部自由度。本练习提供了一个具体的数值算例，引导您逐步完成凝聚过程，包括计算凝聚后的力和求解边界未知数。更重要的是，它还演示了在求得边界解后如何“恢复”内部自由度的值，这是在后处理和分析中至关重要的一步 [@problem_id:2598762]。", "problem": "考虑一个一维三节点有限元，其具有两个边界自由度（DOF）和一个内部自由度。边界自由度为两个端点节点处的 $u_{1}$ 和 $u_{2}$，内部自由度为 $u_{3}$，与一个不出现在单元间耦合中的气泡模式相关联。单元平衡方程以有限元法（FEM）的标准分块形式写出：\n$$\n\\begin{pmatrix}\nK_{bb} & K_{bi} \\\\\nK_{ib} & K_{ii}\n\\end{pmatrix}\n\\begin{pmatrix}\nu_{b} \\\\\nu_{i}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nf_{b} \\\\\nf_{i}\n\\end{pmatrix},\n$$\n其中 $u_{b} = \\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix}$ 且 $u_{i} = \\begin{pmatrix} u_{3} \\end{pmatrix}$。对于此单元，矩阵和向量的数值由下式给出\n$$\nK_{bb} = \\begin{pmatrix} 4 & -1 \\\\ -1 & 3 \\end{pmatrix}, \\quad\nK_{bi} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}, \\quad\nK_{ib} = \\begin{pmatrix} 2 & 1 \\end{pmatrix}, \\quad\nK_{ii} = \\begin{pmatrix} 5 \\end{pmatrix},\n$$\n以及\n$$\nf_{b} = \\begin{pmatrix} 0 \\\\ 10 \\end{pmatrix}, \\quad\nf_{i} = \\begin{pmatrix} 3 \\end{pmatrix}.\n$$\n假设施加了本质边界条件 $u_{1} = 0$，且 $u_{2}$ 是自由的。从平衡方程和内部自由度静力凝聚的定义出发，消去内部自由度 $u_{i}$ 以获得关于边界自由度的凝聚方程，并显式计算凝聚边界右端项 $f_{b}^{\\mathrm{cond}}$。然后，求解凝聚系统（施加本质边界条件后）以确定 $u_{2}$ 并恢复内部自由度 $u_{i}$。\n\n你的最终答案必须按此顺序报告 $f_{b}^{\\mathrm{cond}}$ 的两个分量，然后是恢复的 $u_{i}$，形式为一个单行矩阵。请以精确的有理数形式表示你的答案；不需要四舍五入，也不需要物理单位。", "solution": "该问题已经过验证，被认为是科学上合理的、适定的和完整的。这是有限元法中静力凝聚过程应用的一个标准练习。我们开始求解。\n\n该有限元的控制线性方程组以分块形式给出：\n$$\n\\begin{pmatrix} K_{bb} & K_{bi} \\\\ K_{ib} & K_{ii} \\end{pmatrix} \\begin{pmatrix} u_{b} \\\\ u_{i} \\end{pmatrix} = \\begin{pmatrix} f_{b} \\\\ f_{i} \\end{pmatrix}\n$$\n该矩阵方程代表两个耦合的方程组：\n$$\nK_{bb} u_{b} + K_{bi} u_{i} = f_{b} \\quad (1)\n$$\n$$\nK_{ib} u_{b} + K_{ii} u_{i} = f_{i} \\quad (2)\n$$\n其中 $u_{b}$ 包含边界自由度（DOF），$u_{i}$ 包含内部自由度。静力凝聚的过程旨在从系统中消去内部自由度 $u_{i}$，从而得到一个仅含边界自由度 $u_{b}$ 的更小的系统。\n\n从方程 $(2)$，我们将 $u_{i}$ 表示为 $u_{b}$ 的函数：\n$$\nK_{ii} u_{i} = f_{i} - K_{ib} u_{b}\n$$\n由于子矩阵 $K_{ii}$ 是可逆的（在本例中，它是一个非零标量矩阵 $K_{ii} = \\begin{pmatrix} 5 \\end{pmatrix}$），我们可以写出：\n$$\nu_{i} = K_{ii}^{-1} (f_{i} - K_{ib} u_{b}) \\quad (3)\n$$\n这是内部自由度的恢复方程。\n\n将方程 $(3)$ 代入方程 $(1)$ 以消去 $u_{i}$：\n$$\nK_{bb} u_{b} + K_{bi} [K_{ii}^{-1} (f_{i} - K_{ib} u_{b})] = f_{b}\n$$\n重新整理各项，将涉及 $u_{b}$ 的项组合在左侧，得到：\n$$\nK_{bb} u_{b} - K_{bi} K_{ii}^{-1} K_{ib} u_{b} = f_{b} - K_{bi} K_{ii}^{-1} f_{i}\n$$\n这可以写成凝聚形式 $K_{bb}^{\\mathrm{cond}} u_{b} = f_{b}^{\\mathrm{cond}}$，其中凝聚刚度矩阵和凝聚力向量定义为：\n$$\nK_{bb}^{\\mathrm{cond}} = K_{bb} - K_{bi} K_{ii}^{-1} K_{ib}\n$$\n$$\nf_{b}^{\\mathrm{cond}} = f_{b} - K_{bi} K_{ii}^{-1} f_{i}\n$$\n问题要求显式计算 $f_{b}^{\\mathrm{cond}}$。我们使用所给的数值：\n$$\nK_{bb} = \\begin{pmatrix} 4 & -1 \\\\ -1 & 3 \\end{pmatrix}, \\quad K_{bi} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}, \\quad K_{ib} = \\begin{pmatrix} 2 & 1 \\end{pmatrix}, \\quad K_{ii} = \\begin{pmatrix} 5 \\end{pmatrix}\n$$\n$$\nf_{b} = \\begin{pmatrix} 0 \\\\ 10 \\end{pmatrix}, \\quad f_{i} = \\begin{pmatrix} 3 \\end{pmatrix}\n$$\n首先，我们求 $K_{ii}$ 的逆：\n$$\nK_{ii}^{-1} = \\begin{pmatrix} 5 \\end{pmatrix}^{-1} = \\begin{pmatrix} \\frac{1}{5} \\end{pmatrix}\n$$\n现在，我们计算项 $K_{bi} K_{ii}^{-1} f_{i}$：\n$$\nK_{bi} K_{ii}^{-1} f_{i} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{5} \\end{pmatrix} \\begin{pmatrix} 3 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} (3) = \\frac{1}{5} \\begin{pmatrix} 6 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} \\frac{6}{5} \\\\ \\frac{3}{5} \\end{pmatrix}\n$$\n现在我们可以计算凝聚力向量 $f_{b}^{\\mathrm{cond}}$：\n$$\nf_{b}^{\\mathrm{cond}} = f_{b} - K_{bi} K_{ii}^{-1} f_{i} = \\begin{pmatrix} 0 \\\\ 10 \\end{pmatrix} - \\begin{pmatrix} \\frac{6}{5} \\\\ \\frac{3}{5} \\end{pmatrix} = \\begin{pmatrix} 0 - \\frac{6}{5} \\\\ 10 - \\frac{3}{5} \\end{pmatrix} = \\begin{pmatrix} -\\frac{6}{5} \\\\ \\frac{50}{5} - \\frac{3}{5} \\end{pmatrix} = \\begin{pmatrix} -\\frac{6}{5} \\\\ \\frac{47}{5} \\end{pmatrix}\n$$\n$f_{b}^{\\mathrm{cond}}$ 的两个分量是 $-\\frac{6}{5}$ 和 $\\frac{47}{5}$。\n\n接下来，我们求解关于边界自由度的凝聚系统。首先，我们计算凝聚刚度矩阵 $K_{bb}^{\\mathrm{cond}}$：\n$$\nK_{bi} K_{ii}^{-1} K_{ib} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{5} \\end{pmatrix} \\begin{pmatrix} 2 & 1 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} 2 \\times 2 & 2 \\times 1 \\\\ 1 \\times 2 & 1 \\times 1 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} 4 & 2 \\\\ 2 & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{5} & \\frac{2}{5} \\\\ \\frac{2}{5} & \\frac{1}{5} \\end{pmatrix}\n$$\n$$\nK_{bb}^{\\mathrm{cond}} = \\begin{pmatrix} 4 & -1 \\\\ -1 & 3 \\end{pmatrix} - \\begin{pmatrix} \\frac{4}{5} & \\frac{2}{5} \\\\ \\frac{2}{5} & \\frac{1}{5} \\end{pmatrix} = \\begin{pmatrix} 4 - \\frac{4}{5} & -1 - \\frac{2}{5} \\\\ -1 - \\frac{2}{5} & 3 - \\frac{1}{5} \\end{pmatrix} = \\begin{pmatrix} \\frac{16}{5} & -\\frac{7}{5} \\\\ -\\frac{7}{5} & \\frac{14}{5} \\end{pmatrix}\n$$\n对于 $u_{b} = \\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix}$ 的凝聚方程组是：\n$$\n\\begin{pmatrix} \\frac{16}{5} & -\\frac{7}{5} \\\\ -\\frac{7}{5} & \\frac{14}{5} \\end{pmatrix} \\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix} = \\begin{pmatrix} -\\frac{6}{5} \\\\ \\frac{47}{5} \\end{pmatrix}\n$$\n施加了本质边界条件 $u_{1} = 0$。该系统只涉及自由自由度。对于本问题，只有 $u_{2}$ 是自由的。我们从系统中提取第二个方程：\n$$\n-\\frac{7}{5} u_{1} + \\frac{14}{5} u_{2} = \\frac{47}{5}\n$$\n代入 $u_{1}=0$：\n$$\n\\frac{14}{5} u_{2} = \\frac{47}{5}\n$$\n求解 $u_{2}$：\n$$\nu_{2} = \\frac{47/5}{14/5} = \\frac{47}{14}\n$$\n最后，我们使用方程 $(3)$ 恢复内部自由度 $u_{i}=u_{3}$：\n$$\nu_{i} = K_{ii}^{-1} (f_{i} - K_{ib} u_{b})\n$$\n当 $u_{b} = \\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{47}{14} \\end{pmatrix}$ 时，我们有：\n$$\nu_{i} = \\begin{pmatrix} \\frac{1}{5} \\end{pmatrix} \\left( \\begin{pmatrix} 3 \\end{pmatrix} - \\begin{pmatrix} 2 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\frac{47}{14} \\end{pmatrix} \\right)\n$$\n首先，计算矩阵-向量乘积：\n$$\n\\begin{pmatrix} 2 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\frac{47}{14} \\end{pmatrix} = (2)(0) + (1)\\left(\\frac{47}{14}\\right) = \\frac{47}{14}\n$$\n现在将此结果代回恢复方程：\n$$\nu_{i} = u_{3} = \\frac{1}{5} \\left( 3 - \\frac{47}{14} \\right) = \\frac{1}{5} \\left( \\frac{42}{14} - \\frac{47}{14} \\right) = \\frac{1}{5} \\left( -\\frac{5}{14} \\right) = -\\frac{1}{14}\n$$\n问题要求报告 $f_{b}^{\\mathrm{cond}}$ 的两个分量和恢复的 $u_{i}$。这些值是 $-\\frac{6}{5}$、$\\frac{47}{5}$ 和 $-\\frac{1}{14}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{6}{5} & \\frac{47}{5} & -\\frac{1}{14} \\end{pmatrix}}\n$$", "id": "2598762"}, {"introduction": "静态凝聚的效率很大程度上取决于单元的构造，特别是形函数的选择。本练习将探讨一个带有内部“气泡”自由度的二维三角形单元，您将发现一个重要的特性：由于特殊选择的气泡形函数，其梯度与标准线性形函数的梯度在单元上积分正交。这个特性极大地简化了凝聚过程，并揭示了高级单元设计中一个深刻的原理 [@problem_id:2598715]。", "problem": "考虑具有常数传导率 $\\kappa>0$ 的标量扩散模型问题，其由以下弱形式控制：求 $u \\in H^{1}(\\Omega)$，使得对于所有 $v \\in H^{1}(\\Omega)$，\n$$\n\\int_{\\Omega} \\kappa \\,\\nabla u \\cdot \\nabla v \\, \\mathrm{d}\\Omega \\;=\\; \\int_{\\Omega} f\\, v \\,\\mathrm{d}\\Omega,\n$$\n其中 $\\Omega \\subset \\mathbb{R}^{2}$ 是计算域。专注于有限元方法 (FEM) 中的单个有限元，即顶点位于 $(0,0)$、$(1,0)$ 和 $(0,1)$ 的参考三角形 $\\Omega_{e} = \\{(x,y)\\in\\mathbb{R}^{2} \\,:\\, x \\ge 0,\\; y \\ge 0,\\; x+y \\le 1\\}$。用一个内部气泡自由度 (DOF) 来增强标准线性三角形单元：使用三个顶点形函数 $N_{1}(x,y)=1-x-y$、$N_{2}(x,y)=x$、$N_{3}(x,y)=y$ 和内部气泡函数 $N_{b}(x,y)=27\\,x\\,y\\,(1-x-y)$。将该单元的节点未知数向量表示为 $\\big(u_{1},u_{2},u_{3},u_{b}\\big)$，其中 $u_{1},u_{2},u_{3}$ 是顶点处的值，$u_{b}$ 是气泡自由度。\n\n仅使用单元刚度的弱形式定义和上述形函数，对该单个单元执行以下操作：\n- 对于 $a,b \\in \\{1,2,3,b\\}$，组装单元刚度矩阵项 $K_{ab}^{e} = \\int_{\\Omega_{e}} \\kappa \\,\\nabla N_{a}\\cdot \\nabla N_{b}\\,\\mathrm{d}\\Omega$，并将其组织成分块结构，其中边界 (顶点) 自由度排在前面，内部 (气泡) 自由度排在最后。识别并计算内部-内部块 $K_{ii}^{e}$ 和内部-边界块 $K_{ib}^{e}$。\n- 从该单元的分块平衡方程出发，通过对内部自由度进行静态凝聚来消除内部气泡自由度，以获得仅与顶点自由度相关的舒尔补凝聚刚度。用先前组装的块符号化地表示凝聚矩阵。\n\n最后，报告凝聚刚度矩阵中耦合顶点自由度1和顶点自由度2的项对应的单个标量值（即凝聚的 $3 \\times 3$ 单元刚度的 $(1,2)$ 项）。您的最终答案必须是关于 $\\kappa$ 的单个精确代数表达式，不带单位，也无需四舍五入。", "solution": "该问题要求对线性三角形有限元的内部气泡自由度进行静态凝聚，并随后报告凝聚刚度矩阵中的一个特定项。该过程从验证问题陈述开始。\n\n该问题是有效的。它在科学上基于有限元方法的理论，特别涉及增强单元和静态凝聚。弱形式、单元几何形状和形函数的定义都是标准的且数学上是精确的。该问题是适定的、自洽的、客观的，并为获得唯一解提供了所有必要信息。\n\n求解过程主要分为三个步骤：\n1.  组装单元刚度矩阵的相关分块。\n2.  执行静态凝聚以获得凝聚刚度矩阵。\n3.  从凝聚矩阵中提取所要求的项。\n\n设单元节点未知数排序为 $\\mathbf{u}^e = (u_1, u_2, u_3, u_b)^T$。我们将自由度 (DOF) 划分为边界 (顶点) 自由度（用下标 'b' 表示）和内部 (气泡) 自由度（用下标 'i' 表示）。\n边界自由度为 $\\mathbf{u}_b = (u_1, u_2, u_3)^T$。\n内部自由度为 $\\mathbf{u}_i = (u_b)$。\n单元刚度矩阵 $K^e$ 的项为 $K_{ab}^{e} = \\int_{\\Omega_{e}} \\kappa \\,\\nabla N_{a}\\cdot \\nabla N_{b}\\,\\mathrm{d}\\Omega$，其中 $a,b \\in \\{1,2,3,b\\}$。它可以被划分为一个 $2 \\times 2$ 的分块矩阵：\n$$\nK^e = \\begin{pmatrix} K_{bb}^e & K_{bi}^e \\\\ K_{ib}^e & K_{ii}^e \\end{pmatrix}\n$$\n其中 $K_{bb}^e$ 是 $3 \\times 3$ 的边界-边界块，$K_{bi}^e$ 是 $3 \\times 1$ 的边界-内部块，$K_{ib}^e$ 是 $1 \\times 3$ 的内部-边界块，而 $K_{ii}^e$ 是 $1 \\times 1$ 的内部-内部块。\n\n首先，我们计算所需的块 $K_{ii}^e$ 和 $K_{ib}^e$。这需要形函数的梯度。\n顶点形函数为 $N_1(x,y)=1-x-y$、$N_2(x,y)=x$ 和 $N_3(x,y)=y$。它们的梯度是常数：\n$$ \\nabla N_1 = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}, \\quad \\nabla N_2 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad \\nabla N_3 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} $$\n内部气泡形函数为 $N_b(x,y) = 27xy(1-x-y)$。其梯度为：\n$$ \\nabla N_b = 27 \\begin{pmatrix} \\frac{\\partial}{\\partial x}(xy - x^2y - xy^2) \\\\ \\frac{\\partial}{\\partial y}(xy - x^2y - xy^2) \\end{pmatrix} = 27 \\begin{pmatrix} y - 2xy - y^2 \\\\ x - x^2 - 2xy \\end{pmatrix} = 27 \\begin{pmatrix} y(1-2x-y) \\\\ x(1-x-2y) \\end{pmatrix} $$\n\n内部-边界块 $K_{ib}^e$ 是一个 $1 \\times 3$ 的行矩阵，其项为 $K_{b j}^e = \\int_{\\Omega_e} \\kappa \\nabla N_b \\cdot \\nabla N_j d\\Omega$，其中 $j \\in \\{1,2,3\\}$。\n对于 $j=2$：\n$$ K_{b2}^e = \\int_{\\Omega_e} \\kappa (\\nabla N_b \\cdot \\nabla N_2) d\\Omega = \\int_{\\Omega_e} \\kappa \\left( 27 y(1-2x-y) \\right) d\\Omega = 27\\kappa \\int_{\\Omega_e} \\frac{\\partial N_b}{\\partial x} \\frac{1}{27} d\\Omega = \\kappa \\int_{\\Omega_e} \\frac{\\partial N_b}{\\partial x} d\\Omega $$\n使用散度定理（二维中的格林公式），这个面积分可以转换成一个边界积分：\n$$ \\int_{\\Omega_e} \\frac{\\partial N_b}{\\partial x} d\\Omega = \\oint_{\\partial \\Omega_e} N_b n_x dS $$\n其中 $n_x$ 是边界 $\\partial \\Omega_e$ 的外向单位法向量的 $x$ 分量。根据构造，气泡函数 $N_b(x,y)=27xy(1-x-y)$ 在参考三角形 $\\Omega_e$ 的所有三条边上（即 $x=0$、$y=0$ 或 $x+y=1$ 的地方）均为零。因此，边界积分为零，且 $K_{b2}^e = 0$。\n类似地，对于 $j=3$：\n$$ K_{b3}^e = \\kappa \\int_{\\Omega_e} \\nabla N_b \\cdot \\nabla N_3 d\\Omega = \\kappa \\int_{\\Omega_e} \\frac{\\partial N_b}{\\partial y} d\\Omega = \\kappa \\oint_{\\partial \\Omega_e} N_b n_y dS = 0 $$\n对于 $j=1$，我们使用线性形函数梯度之和为 $\\nabla N_1 + \\nabla N_2 + \\nabla N_3 = \\mathbf{0}$ 的性质，这意味着 $\\nabla N_1 = -(\\nabla N_2 + \\nabla N_3)$。\n$$ K_{b1}^e = \\kappa \\int_{\\Omega_e} \\nabla N_b \\cdot \\nabla N_1 d\\Omega = -\\kappa \\int_{\\Omega_e} \\nabla N_b \\cdot (\\nabla N_2 + \\nabla N_3) d\\Omega = -(K_{b2}^e + K_{b3}^e) = 0 $$\n因此，内部-边界块是一个零向量：$K_{ib}^e = \\begin{pmatrix} 0 & 0 & 0 \\end{pmatrix}$。因此，边界-内部块也是零：$K_{bi}^e = (K_{ib}^e)^T = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n\n内部-内部块 $K_{ii}^e$ 是一个 $1 \\times 1$ 矩阵（一个标量），由下式给出：\n$$ K_{ii}^e = \\int_{\\Omega_e} \\kappa (\\nabla N_b \\cdot \\nabla N_b) d\\Omega = \\kappa \\int_{\\Omega_e} |\\nabla N_b|^2 d\\Omega $$\n被积函数为 $|\\nabla N_b|^2 = (27)^2 [y^2(1-2x-y)^2 + x^2(1-x-2y)^2]$。为了在参考三角形上计算这个积分，我们使用面积坐标 $L_1 = 1-x-y, L_2 = x, L_3 = y$ 的公式：$\\int_{\\Omega_e} L_1^a L_2^b L_3^c d\\Omega = \\frac{a!b!c!}{(a+b+c+2)!} \\cdot 2A$。参考单元面积 $A=1/2$。所以 $\\int_{\\Omega_e} L_1^a L_2^b L_3^c d\\Omega = \\frac{a!b!c!}{(a+b+c+2)!}$。\n被积函数变为 $(27)^2 [L_3^2(L_1-L_2)^2 + L_2^2(L_1-L_3)^2]$。如详细推导所示，该表达式的积分为：\n$$ \\int_{\\Omega_e} [L_3^2(L_1-L_2)^2 + L_2^2(L_1-L_3)^2] d\\Omega = \\frac{1}{90} $$\n因此，$K_{ii}^e = \\kappa (27)^2 \\frac{1}{90} = \\kappa \\frac{729}{90} = \\frac{81}{10}\\kappa$。\n\n现在，我们执行静态凝聚。分块方程组为：\n$$\n\\begin{cases}\nK_{bb}^e \\mathbf{u}_b + K_{bi}^e \\mathbf{u}_i = \\mathbf{f}_b \\\\\nK_{ib}^e \\mathbf{u}_b + K_{ii}^e \\mathbf{u}_i = \\mathbf{f}_i\n\\end{cases}\n$$\n从第二个方程，我们用边界自由度 $\\mathbf{u}_b$ 来表示内部自由度 $\\mathbf{u}_i$：\n$$ \\mathbf{u}_i = (K_{ii}^e)^{-1} (\\mathbf{f}_i - K_{ib}^e \\mathbf{u}_b) $$\n将此代入第一个方程，得到一个仅关于 $\\mathbf{u}_b$ 的凝聚系统：\n$$ (K_{bb}^e - K_{bi}^e (K_{ii}^e)^{-1} K_{ib}^e) \\mathbf{u}_b = \\mathbf{f}_b - K_{bi}^e (K_{ii}^e)^{-1} \\mathbf{f}_i $$\n凝聚刚度矩阵是舒尔补，$K_{cond}^e = K_{bb}^e - K_{bi}^e (K_{ii}^e)^{-1} K_{ib}^e$。\n因为我们发现 $K_{ib}^e = \\mathbf{0}$ 且 $K_{bi}^e = \\mathbf{0}$，所以修正项消失：\n$$ K_{cond}^e = K_{bb}^e - \\mathbf{0} = K_{bb}^e $$\n这意味着凝聚刚度矩阵就是原始的边界-边界块，即线性三角形单元的标准刚度矩阵。\n\n最后一步是计算 $K_{cond}^e$ 的 $(1,2)$ 项，也就是 $K_{bb}^e$ 的 $(1,2)$ 项。参考单元 $\\Omega_e$ 的面积是 $A = 1/2$。\n$$ (K_{cond}^e)_{12} = (K_{bb}^e)_{12} = \\int_{\\Omega_e} \\kappa \\nabla N_1 \\cdot \\nabla N_2 d\\Omega $$\n被积函数是常数：$\\nabla N_1 \\cdot \\nabla N_2 = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} \\cdot \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = -1$。\n所以积分为：\n$$ (K_{cond}^e)_{12} = \\kappa \\int_{\\Omega_e} (-1) d\\Omega = -\\kappa \\cdot A = -\\kappa \\cdot \\frac{1}{2} = -\\frac{\\kappa}{2} $$\n所求的凝聚刚度矩阵项为 $-\\frac{\\kappa}{2}$。", "answer": "$$ \\boxed{-\\frac{\\kappa}{2}} $$", "id": "2598715"}, {"introduction": "虽然静态凝聚可以减小问题规模，但它也会改变系统矩阵的性质，这可能影响迭代求解器的性能。本练习通过一个具体的例子，展示了凝聚过程如何导致一个原本具有良好特性的矩阵失去其严格对角占优性 [@problem_id:2598749]。通过分析雅可比迭代法的收敛性，本练习旨在探讨一个核心问题：我们是否应该担心凝聚后矩阵性质的变化，以及这对于求解大规模工程问题有何实际意义。", "problem": "考虑一个线性静态有限元平衡系统，其位移向量 $\\mathbf{u} = \\begin{pmatrix} \\mathbf{u}_{b} \\\\ \\mathbf{u}_{i} \\end{pmatrix}$ 被划分为边界自由度和内点自由度，刚度矩阵被划分为\n$$\n\\mathbf{K} \\;=\\;\n\\begin{pmatrix}\n\\mathbf{K}_{bb} & \\mathbf{K}_{bi} \\\\\n\\mathbf{K}_{ib} & \\mathbf{K}_{ii}\n\\end{pmatrix},\n$$\n以及力向量 $\\mathbf{f} = \\begin{pmatrix} \\mathbf{f}_{b} \\\\ \\mathbf{f}_{i} \\end{pmatrix}$。平衡方程为\n$$\n\\begin{pmatrix}\n\\mathbf{K}_{bb} & \\mathbf{K}_{bi} \\\\\n\\mathbf{K}_{ib} & \\mathbf{K}_{ii}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{u}_{b} \\\\\n\\mathbf{u}_{i}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{f}_{b} \\\\\n\\mathbf{f}_{i}\n\\end{pmatrix}.\n$$\n取以下特定的对称正定分块数据\n$$\n\\mathbf{K}_{bb} \\;=\\;\n\\begin{pmatrix}\n5.6 & -3 \\\\\n-3 &  10\n\\end{pmatrix},\\qquad\n\\mathbf{K}_{bi} \\;=\\;\n\\begin{pmatrix}\n6 \\\\\n0\n\\end{pmatrix},\\qquad\n\\mathbf{K}_{ii} \\;=\\; (10),\n$$\n使得 $\\mathbf{K}_{ib} = \\mathbf{K}_{bi}^{\\top}$。对内点自由度 $\\mathbf{u}_{i}$ 执行静态凝聚，以获得约化的边界系统\n$$\n\\mathbf{S}\\,\\mathbf{u}_{b} \\;=\\; \\mathbf{f}_{b}^{\\star},\n$$\n其中 $\\mathbf{S}$ 是舒尔补，$\\mathbf{f}_{b}^{\\star}$ 是凝聚后的右端项。然后：\n\n- 显式计算约化刚度矩阵 $\\mathbf{S}$。\n- 判断 $\\mathbf{S}$ 是否为严格对角占优矩阵，并陈述你的结论。\n- 考虑应用于 $\\mathbf{S}\\,\\mathbf{u}_{b} = \\mathbf{f}_{b}^{\\star}$ 的线性定常雅可比方法。令 $\\mathbf{D} = \\operatorname{diag}(S_{11}, S_{22})$ 且 $\\mathbf{T}_{J} = \\mathbf{I} - \\mathbf{D}^{-1}\\mathbf{S}$ 为雅可比迭代矩阵。以精确的封闭形式计算谱半径 $\\rho(\\mathbf{T}_{J})$。\n- 基于你的计算和标准收敛理论，简要说明由凝聚引起的严格对角占优性的丧失是否必然导致雅可比方法不收敛，以及高斯-赛德尔方法对于此约化系统是否收敛。\n\n给出你关于 $\\rho(\\mathbf{T}_{J})$ 的最终答案，形式为精确的封闭表达式。无需四舍五入，也无需单位。", "solution": "该问题已根据指定标准进行验证，并被认定为科学上合理、适定、客观和完整。它提出了一个应用于计算力学的数值线性代数中的标准任务。我们将开始解答。\n\n线性平衡方程组以分块形式给出：\n$$\n\\begin{pmatrix}\n\\mathbf{K}_{bb} & \\mathbf{K}_{bi} \\\\\n\\mathbf{K}_{ib} & \\mathbf{K}_{ii}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{u}_{b} \\\\\n\\mathbf{u}_{i}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{f}_{b} \\\\\n\\mathbf{f}_{i}\n\\end{pmatrix}\n$$\n这对应于两个矩阵方程：\n$$\n\\mathbf{K}_{bb} \\mathbf{u}_{b} + \\mathbf{K}_{bi} \\mathbf{u}_{i} = \\mathbf{f}_{b} \\quad (1)\n$$\n$$\n\\mathbf{K}_{ib} \\mathbf{u}_{b} + \\mathbf{K}_{ii} \\mathbf{u}_{i} = \\mathbf{f}_{i} \\quad (2)\n$$\n静态凝聚是消除内点自由度 $\\mathbf{u}_{i}$ 的过程。从方程 $(2)$ 中，我们求解 $\\mathbf{u}_{i}$，假设 $\\mathbf{K}_{ii}$ 是可逆的。问题陈述 $\\mathbf{K}$ 是对称正定 (SPD) 的，这意味着其对角块（例如 $\\mathbf{K}_{ii}$）也是对称正定且因此可逆的。\n$$\n\\mathbf{K}_{ii} \\mathbf{u}_{i} = \\mathbf{f}_{i} - \\mathbf{K}_{ib} \\mathbf{u}_{b}\n$$\n$$\n\\mathbf{u}_{i} = \\mathbf{K}_{ii}^{-1} (\\mathbf{f}_{i} - \\mathbf{K}_{ib} \\mathbf{u}_{b})\n$$\n将 $\\mathbf{u}_{i}$ 的这个表达式代入方程 $(1)$：\n$$\n\\mathbf{K}_{bb} \\mathbf{u}_{b} + \\mathbf{K}_{bi} \\left[ \\mathbf{K}_{ii}^{-1} (\\mathbf{f}_{i} - \\mathbf{K}_{ib} \\mathbf{u}_{b}) \\right] = \\mathbf{f}_{b}\n$$\n重新整理各项以分离出 $\\mathbf{u}_{b}$：\n$$\n(\\mathbf{K}_{bb} - \\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} \\mathbf{K}_{ib}) \\mathbf{u}_{b} = \\mathbf{f}_{b} - \\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} \\mathbf{f}_{i}\n$$\n这就是约化系统 $\\mathbf{S}\\,\\mathbf{u}_{b} = \\mathbf{f}_{b}^{\\star}$，其中约化刚度矩阵，即 $\\mathbf{K}_{ii}$ 在 $\\mathbf{K}$ 中的舒尔补，是 $\\mathbf{S} = \\mathbf{K}_{bb} - \\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} \\mathbf{K}_{ib}$。\n\n我们现在使用所提供的数据计算 $\\mathbf{S}$：\n$$\n\\mathbf{K}_{bb} = \\begin{pmatrix} 5.6 & -3 \\\\ -3 & 10 \\end{pmatrix}, \\quad \\mathbf{K}_{bi} = \\begin{pmatrix} 6 \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{K}_{ii} = (10)\n$$\n由于 $\\mathbf{K}$ 是对称的，$\\mathbf{K}_{ib} = \\mathbf{K}_{bi}^{\\top} = \\begin{pmatrix} 6 & 0 \\end{pmatrix}$。$1 \\times 1$ 矩阵 $\\mathbf{K}_{ii}$ 的逆是 $\\mathbf{K}_{ii}^{-1} = (1/10) = (0.1)$。\n现在，我们计算修正项：\n$$\n \\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} \\mathbf{K}_{ib} = \\begin{pmatrix} 6 \\\\ 0 \\end{pmatrix} (0.1) \\begin{pmatrix} 6 & 0 \\end{pmatrix} = \\begin{pmatrix} 6 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 0.6 & 0 \\end{pmatrix} = \\begin{pmatrix} 3.6 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\n约化刚度矩阵 $\\mathbf{S}$ 是：\n$$\n\\mathbf{S} = \\mathbf{K}_{bb} - \\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} \\mathbf{K}_{ib} = \\begin{pmatrix} 5.6 & -3 \\\\ -3 & 10 \\end{pmatrix} - \\begin{pmatrix} 3.6 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 2 & -3 \\\\ -3 & 10 \\end{pmatrix}\n$$\n接下来，我们判断 $\\mathbf{S}$ 是否为严格对角占优。一个大小为 $n \\times n$ 的矩阵 $\\mathbf{A} = (a_{ij})$ 是严格对角占优的，如果对于所有行 $i=1, \\dots, n$ 都满足 $|a_{ii}| > \\sum_{j=1, j\\neq i}^{n} |a_{ij}|$。对于 $\\mathbf{S}$：\n第 1 行：$|S_{11}| = |2| = 2$。非对角元素之和为 $|S_{12}| = |-3| = 3$。条件 $2 > 3$ 不成立。\n第 2 行：$|S_{22}| = |10| = 10$。非对角元素之和为 $|S_{21}| = |-3| = 3$。条件 $10 > 3$ 成立。\n由于该条件对第一行不成立，矩阵 $\\mathbf{S}$ 不是严格对角占优的。\n\n我们现在计算系统 $\\mathbf{S}\\,\\mathbf{u}_{b} = \\mathbf{f}_{b}^{\\star}$ 的雅可比迭代矩阵 $\\mathbf{T}_{J}$ 的谱半径。该迭代矩阵定义为 $\\mathbf{T}_{J} = \\mathbf{I} - \\mathbf{D}^{-1}\\mathbf{S}$，其中 $\\mathbf{D}$ 是 $\\mathbf{S}$ 的对角部分。\n$$\n\\mathbf{S} = \\begin{pmatrix} 2 & -3 \\\\ -3 & 10 \\end{pmatrix}, \\quad \\mathbf{D} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 10 \\end{pmatrix}\n$$\n$\\mathbf{D}$ 的逆是 $\\mathbf{D}^{-1} = \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1/10 \\end{pmatrix}$。\n$$\n\\mathbf{D}^{-1}\\mathbf{S} = \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1/10 \\end{pmatrix} \\begin{pmatrix} 2 & -3 \\\\ -3 & 10 \\end{pmatrix} = \\begin{pmatrix} 1 & -3/2 \\\\ -3/10 & 1 \\end{pmatrix}\n$$\n$$\n\\mathbf{T}_{J} = \\mathbf{I} - \\mathbf{D}^{-1}\\mathbf{S} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 1 & -3/2 \\\\ -3/10 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 3/2 \\\\ 3/10 & 0 \\end{pmatrix}\n$$\n为了求得谱半径 $\\rho(\\mathbf{T}_{J})$，我们从特征方程 $\\det(\\mathbf{T}_{J} - \\lambda\\mathbf{I}) = 0$ 中求解 $\\mathbf{T}_{J}$ 的特征值 $\\lambda$。\n$$\n\\det \\begin{pmatrix} -\\lambda & 3/2 \\\\ 3/10 & -\\lambda \\end{pmatrix} = (-\\lambda)(-\\lambda) - (\\frac{3}{2})(\\frac{3}{10}) = \\lambda^2 - \\frac{9}{20} = 0\n$$\n特征值为 $\\lambda^2 = \\frac{9}{20}$，所以 $\\lambda = \\pm\\sqrt{\\frac{9}{20}} = \\pm\\frac{3}{\\sqrt{20}} = \\pm\\frac{3}{2\\sqrt{5}}$。\n谱半径是特征值绝对值的最大值：\n$$\n\\rho(\\mathbf{T}_{J}) = \\max\\left(\\left|\\frac{3}{2\\sqrt{5}}\\right|, \\left|-\\frac{3}{2\\sqrt{5}}\\right|\\right) = \\frac{3}{2\\sqrt{5}} = \\frac{3\\sqrt{5}}{10}\n$$\n关于收敛性：\n雅可比方法收敛的充要条件是 $\\rho(\\mathbf{T}_{J})  1$。我们有 $\\rho(\\mathbf{T}_{J}) = \\frac{3\\sqrt{5}}{10}$。因为 $\\sqrt{5} \\approx 2.236$，所以 $\\rho(\\mathbf{T}_{J}) \\approx \\frac{3 \\times 2.236}{10} = 0.6708  1$。更严格地，$(\\frac{3\\sqrt{5}}{10})^2 = \\frac{9 \\times 5}{100} = \\frac{45}{100}  1$。因此，雅可比方法是收敛的。这表明，严格对角占优是雅可比方法收敛的一个充分条件，但不是必要条件。\n\n对于高斯-赛德尔方法，如果系数矩阵 $\\mathbf{S}$ 是对称且正定的 (SPD)，则其收敛性得到保证。\n矩阵 $\\mathbf{S} = \\begin{pmatrix} 2  -3 \\\\ -3  10 \\end{pmatrix}$ 是对称的。为了检验其正定性，我们使用西尔维斯特准则。其顺序主子式为：\n一阶主子式是 $\\det(S_{11}) = 2  0$。\n二阶主子式是 $\\det(\\mathbf{S}) = (2)(10) - (-3)(-3) = 20 - 9 = 11  0$。\n由于所有顺序主子式都为正，$\\mathbf{S}$ 是正定的。因此，高斯-赛德尔方法对于此约化系统保证收敛。", "answer": "$$\n\\boxed{\\frac{3\\sqrt{5}}{10}}\n$$", "id": "2598749"}]}