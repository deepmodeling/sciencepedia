{"hands_on_practices": [{"introduction": "刚度矩阵的条件数是衡量有限元系统数值健康状况的关键指标。在这个基础练习中，我们将从第一性原理出发，推导一个简单一维问题中刚度矩阵的精确条件数。该实践不仅将有限元矩阵与深入研究的图拉普拉斯算子联系起来，还将严格确立著名的 $O(h^{-2})$ 标度关系，从而阐明为何网格加密会内在地导致系统变得更差的病态性。[@problem_id:2546526]", "problem": "考虑一维链上的简单路径图，其两个端点具有齐次狄利克雷边界条件。令 $n \\in \\mathbb{N}$ 表示内部顶点（等效于未知数）的数量。由此产生的限制在内部的图拉普拉斯算子是一个 $n \\times n$ 的对称三对角矩阵 $T_{n}$，其对角线上的元素为 $2$，第一亚对角线和第一超对角线上的元素为 $-1$，其他位置的元素为零。对于一个对称正定 (SPD) 矩阵 $A$，其谱范数下的谱条件数定义为 $\\kappa_{2}(A) = \\lambda_{\\max}(A)/\\lambda_{\\min}(A)$，其中 $\\lambda_{\\max}(A)$ 和 $\\lambda_{\\min}(A)$ 分别是 $A$ 的最大和最小特征值。\n\n另外，考虑区间 $(0,1)$ 上的一维泊松边界值问题 $-u'' = f$，其边界条件为 $u(0)=u(1)=0$。使用有限元法 (FEM; finite element method)，在包含 $N$ 个单元的均匀网格上，采用连续分段线性基函数对其进行离散化，因此网格尺寸为 $h = 1/N$，内部自由度的数量为 $n = N-1$。刚度矩阵 $K_{h}$ 的元素定义为 $K_{h,ij} = \\int_{0}^{1} \\varphi_{i}'(x)\\,\\varphi_{j}'(x)\\,\\mathrm{d}x$，其中 $\\{\\varphi_{i}\\}_{i=1}^{n}$ 是与内部节点相关的节点基函数。\n\n从 $T_{n}$ 的特征值问题出发，并施加路径图内部简化所基于的齐次狄利克雷边界条件，推导出 $\\kappa_{2}(T_{n})$ 作为 $n$ 的函数的确切表达式。仅使用均匀网格上有限元法刚度矩阵的基本性质，将 $K_{h}$ 与 $T_{n}$ 联系起来，并利用此关系推断出 $\\kappa_{2}(K_{h})$ 关于 $n$ 和 $h$ 的渐近标度。\n\n请提供 $\\kappa_{2}(T_{n})$ 关于 $n$ 的单一、闭式解析表达式作为最终答案。不需要进行数值取整，最终答案中也不要包含单位。", "solution": "我们从 $n \\times n$ 的三对角矩阵 $T_{n}$ 开始，其元素为\n$$\n(T_{n})_{ii} = 2,\\quad (T_{n})_{i,i+1} = (T_{n})_{i+1,i} = -1,\\quad \\text{for } i=1,\\dots,n-1,\n$$\n其他位置为零。该矩阵是通过消除具有齐次狄利克雷边界条件的路径图的两个边界节点而得到的简化图拉普拉斯算子；它是一个对称正定 (SPD) 矩阵。\n\n特征值问题 $T_{n} v = \\lambda v$ 的分量形式为\n$$\n- v_{i-1} + 2 v_{i} - v_{i+1} = \\lambda v_{i}, \\quad i=1,\\dots,n,\n$$\n其中通过 $v_{0} = 0$ 和 $v_{n+1} = 0$ 隐式地施加了齐次狄利克雷边界条件。这是一个带边界条件的常系数线性递推关系。一种标准方法是使用试探形式\n$$\nv_{i} = \\sin(i \\theta),\n$$\n该形式已经满足 $v_{0} = \\sin(0) = 0$。代入递推关系可得\n$$\n- \\sin((i-1)\\theta) + 2 \\sin(i\\theta) - \\sin((i+1)\\theta) = \\lambda \\sin(i\\theta).\n$$\n使用三角恒等式\n$$\n\\sin((i+1)\\theta) + \\sin((i-1)\\theta) = 2 \\sin(i\\theta) \\cos(\\theta),\n$$\n我们得到\n$$\n- \\left[2 \\sin(i\\theta) \\cos(\\theta)\\right] + 2 \\sin(i\\theta) = \\lambda \\sin(i\\theta).\n$$\n对于非平凡的特征向量，对于某个 $i$ 有 $\\sin(i\\theta) \\neq 0$，因此我们可以除以 $\\sin(i\\theta)$ 得到\n$$\n- 2 \\cos(\\theta) + 2 = \\lambda.\n$$\n因此，特征值由以下参数化\n$$\n\\lambda(\\theta) = 2 - 2 \\cos(\\theta).\n$$\n剩下的边界条件 $v_{n+1} = \\sin((n+1)\\theta) = 0$ 强制要求\n$$\n(n+1)\\theta = k \\pi, \\quad k \\in \\mathbb{Z}.\n$$\n排除特征向量恒为零的平凡解，我们取 $k = 1,2,\\dots,n$，从而得到\n$$\n\\theta_{k} = \\frac{k \\pi}{n+1}, \\quad k=1,2,\\dots,n.\n$$\n因此，这 $n$ 个正特征值为\n$$\n\\lambda_{k} = 2 - 2 \\cos\\!\\left(\\frac{k \\pi}{n+1}\\right) = 4 \\sin^{2}\\!\\left(\\frac{k \\pi}{2(n+1)}\\right), \\quad k=1,2,\\dots,n.\n$$\n从这个序列中，最小的特征值是\n$$\n\\lambda_{\\min} = \\lambda_{1} = 4 \\sin^{2}\\!\\left(\\frac{\\pi}{2(n+1)}\\right),\n$$\n最大的特征值是\n$$\n\\lambda_{\\max} = \\lambda_{n} = 4 \\sin^{2}\\!\\left(\\frac{n \\pi}{2(n+1)}\\right).\n$$\n使用恒等式 $\\sin\\!\\left(\\frac{n \\pi}{2(n+1)}\\right) = \\cos\\!\\left(\\frac{\\pi}{2(n+1)}\\right)$，我们得到\n$$\n\\lambda_{\\max} = 4 \\cos^{2}\\!\\left(\\frac{\\pi}{2(n+1)}\\right).\n$$\n因此，谱范数下的谱条件数是\n$$\n\\kappa_{2}(T_{n}) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{4 \\cos^{2}\\!\\left(\\frac{\\pi}{2(n+1)}\\right)}{4 \\sin^{2}\\!\\left(\\frac{\\pi}{2(n+1)}\\right)} = \\cot^{2}\\!\\left(\\frac{\\pi}{2(n+1)}\\right).\n$$\n\n现在我们将其与均匀网格上的一维有限元法 (FEM) 刚度矩阵联系起来。考虑在 $(0,1)$ 上的问题 $-u'' = f$，其边界条件为 $u(0)=u(1)=0$，使用连续分段线性基函数在大小为 $h = 1/N$ 的 $N$ 个单元的均匀网格上进行离散化。存在 $n = N-1$ 个内部节点，因此有 $n$ 个基函数 $\\{\\varphi_{i}\\}_{i=1}^{n}$。在线性单元的均匀网格上，每个基函数 $\\varphi_{i}'$ 的梯度是分段常数，并且唯一非零的单元刚度贡献来自于最近邻的相互作用。一个标准的组装计算可以得到全局刚度矩阵\n$$\nK_{h} = \\frac{1}{h} \\, T_{n},\n$$\n其中 $T_{n}$ 正是上面定义的三对角矩阵。由于 $K_{h}$ 是 $T_{n}$ 的一个正常数倍，它们具有相同的特征向量集，并且它们的特征值通过一个统一的缩放因子相关联：\n$$\n\\mu_{k}(K_{h}) = \\frac{1}{h} \\, \\lambda_{k}(T_{n}), \\quad k=1,\\dots,n.\n$$\n因此，谱条件数在正常数乘法下是不变的，得到\n$$\n\\kappa_{2}(K_{h}) = \\kappa_{2}(T_{n}) = \\cot^{2}\\!\\left(\\frac{\\pi}{2(n+1)}\\right).\n$$\n为了提取随 $n$ 和 $h$ 的标度关系，使用小角度展开 $\\cot(x) \\sim \\frac{1}{x}$ 当 $x \\to 0$ 时。此处，\n$$\n\\frac{\\pi}{2(n+1)} \\to 0 \\quad \\text{as } n \\to \\infty,\n$$\n所以\n$$\n\\kappa_{2}(T_{n}) = \\cot^{2}\\!\\left(\\frac{\\pi}{2(n+1)}\\right) \\sim \\left(\\frac{2(n+1)}{\\pi}\\right)^{2} \\quad \\text{as } n \\to \\infty.\n$$\n由于 $n = N-1$ 且 $h = 1/N$，我们有 $n+1 = N = 1/h$，因此\n$$\n\\kappa_{2}(K_{h}) \\sim \\left(\\frac{2}{\\pi}\\right)^{2} \\frac{1}{h^{2}} \\quad \\text{as } h \\to 0,\n$$\n这恢复了在一维均匀网格上有限元刚度矩阵的谱条件数著名的 $O(h^{-2})$ 标度关系。\n\n因此，路径图狄利克雷拉普拉斯算子 $T_{n}$ 的条件数的确切闭式表达式为 $\\cot^{2}\\!\\left(\\frac{\\pi}{2(n+1)}\\right)$，并且它与有限元法刚度矩阵的标度关系在精确值上（通过等式）和渐近行为上（当网格细化时为 $O(n^{2})$ 或 $O(h^{-2})$）都相匹配。", "answer": "$$\\boxed{\\cot^{2}\\!\\left(\\frac{\\pi}{2(n+1)}\\right)}$$", "id": "2546526"}, {"introduction": "在了解了病态性是如何产生之后，我们现在转向缓解策略。本实践将探讨对角缩放，这是一种基本的预处理形式，可以显著改善系统的条件数，尤其对于非均匀网格。通过将两种常见的均衡化技术应用于一个来自梯度网格的刚度矩阵，您将定量地比较它们的效果，并获得关于如何提高数值稳定性的实践见解。[@problem_id:2546522]", "problem": "考虑一维泊松模型问题 $-u'' = f$，该问题定义在一个有界区间上，并在两个端点处具有齐次狄利克雷边界条件。使用有限元方法 (FEM) 对其进行离散化，采用连续分段线性基函数，并使用一个包含三个单元的渐变网格，单元长度 $h_1$、$h_2$、$h_3$ 成等比数列，固定公比为 $r>0$，即 $h_2 = r h_1$ 且 $h_3 = r h_2$。在区间端点施加两个狄利克雷条件，使得恰好有两个内部节点，且全局刚度矩阵 $K \\in \\mathbb{R}^{2 \\times 2}$ 是对称正定的。为不失一般性，可以取 $h_1 = 1$，并且应在精确算术层面进行计算（不进行舍入）。\n\n为刚度矩阵 $K$ 定义以下两种对角均衡化策略：\n- 行和对称均衡化：选择一个对角缩放 $S_{\\mathrm{row}} = \\mathrm{diag}(s_1,s_2)$，其中 $s_i0$，使得对称缩放后的矩阵 $S_{\\mathrm{row}} K S_{\\mathrm{row}}$ 的每一行绝对值之和都等于 $1$。\n- 几何平均（单位对角/雅可比）均衡化：选择一个对角缩放 $S_{\\mathrm{geo}} = \\mathrm{diag}\\!\\big(1/\\sqrt{K_{11}},\\,1/\\sqrt{K_{22}}\\big)$，这使得 $S_{\\mathrm{geo}} K S_{\\mathrm{geo}}$ 的对角线元素等于 $1$。\n\n从标准的有限元双线性形式及其单元级贡献出发，为这个三单元渐变网格显式地组装 $K$。然后，对于一个对称正定矩阵 $K$，使用谱条件数（矩阵 $2$-范数条件数）的定义 $\\kappa_2(K) = \\lambda_{\\max}(K)/\\lambda_{\\min}(K)$，计算以下三个量的封闭形式表达式（用 $r$ 表示）：\n- 未缩放矩阵的 $\\kappa_2(K)$，\n- 行和对称均衡化后的 $\\kappa_2\\!\\big(S_{\\mathrm{row}} K S_{\\mathrm{row}}\\big)$，\n- 几何平均均衡化后的 $\\kappa_2\\!\\big(S_{\\mathrm{geo}} K S_{\\mathrm{geo}}\\big)$。\n\n将你的最终答案表示为一个单行矩阵，按上述顺序列出这三个表达式。不需要数值舍入，也不涉及物理单位。", "solution": "该问题是一维泊松方程 $-u'' = f$，带有齐次狄利克雷边界条件。其弱形式导出双线性形式 $a(u,v) = \\int_{\\Omega} u' v' dx$。对于连续分段线性基函数 $\\phi_i(x)$，刚度矩阵的元素为 $K_{ij} = a(\\phi_j, \\phi_i)$。\n\n一个长度为 $h$ 的标准一维线性有限元的局部刚度矩阵由下式给出\n$$ k_e = \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} $$\n全局刚度矩阵是通过对每个单元的贡献求和来组装的。我们有一个包含三个长度分别为 $h_1$、$h_2$ 和 $h_3$ 的单元的网格。在狄利克雷边界之间有两个内部节点，记为 $1$ 和 $2$。内部节点的全局刚度矩阵为 $K \\in \\mathbb{R}^{2 \\times 2}$。\n\n第一个内部节点由单元 $1$（长度 $h_1$）和单元 $2$（长度 $h_2$）连接。第二个内部节点由单元 $2$（长度 $h_2$）和单元 $3$（长度 $h_3$）连接。组装过程得到：\n$K_{11}$ 是来自单元 $1$ 和单元 $2$ 的对角线元素之和：$K_{11} = \\frac{1}{h_1} + \\frac{1}{h_2}$。\n$K_{22}$ 是来自单元 $2$ 和单元 $3$ 的对角线元素之和：$K_{22} = \\frac{1}{h_2} + \\frac{1}{h_3}$。\n$K_{12} = K_{21}$ 是来自共享单元 $2$ 的非对角线贡献：$K_{12} = -\\frac{1}{h_2}$。\n\n因此，刚度矩阵为：\n$$ K = \\begin{pmatrix} \\frac{1}{h_1} + \\frac{1}{h_2}  -\\frac{1}{h_2} \\\\ -\\frac{1}{h_2}  \\frac{1}{h_2} + \\frac{1}{h_3} \\end{pmatrix} $$\n问题指定了一个渐变网格，其中 $h_1=1$，$h_2=r h_1 = r$，$h_3=r h_2 = r^2$，对于给定的比率 $r>0$。代入这些值：\n$$ K = \\begin{pmatrix} \\frac{1}{1} + \\frac{1}{r}  -\\frac{1}{r} \\\\ -\\frac{1}{r}  \\frac{1}{r} + \\frac{1}{r^2} \\end{pmatrix} = \\begin{pmatrix} \\frac{r+1}{r}  -\\frac{1}{r} \\\\ -\\frac{1}{r}  \\frac{r+1}{r^2} \\end{pmatrix} $$\n\n1.  未缩放矩阵 $K$ 的条件数：$\\kappa_2(K)$。\n    一个 $2 \\times 2$ 对称矩阵 $\\begin{pmatrix} a  c \\\\ c  b \\end{pmatrix}$ 的特征值 $\\lambda$ 由公式 $\\lambda = \\frac{a+b \\pm \\sqrt{(a-b)^2 + 4c^2}}{2}$ 给出。\n    对于我们的矩阵 $K$：\n    $a = \\frac{r+1}{r}$, $b = \\frac{r+1}{r^2}$, $c = -\\frac{1}{r}$。\n    $a+b = \\frac{r(r+1) + (r+1)}{r^2} = \\frac{(r+1)^2}{r^2}$。\n    $a-b = \\frac{r(r+1) - (r+1)}{r^2} = \\frac{(r-1)(r+1)}{r^2} = \\frac{r^2-1}{r^2}$。\n    平方根下的项是\n    $(a-b)^2 + 4c^2 = \\left(\\frac{r^2-1}{r^2}\\right)^2 + 4\\left(-\\frac{1}{r}\\right)^2 = \\frac{r^4 - 2r^2 + 1}{r^4} + \\frac{4}{r^2} = \\frac{r^4 + 2r^2 + 1}{r^4} = \\left(\\frac{r^2+1}{r^2}\\right)^2$。\n    特征值为：\n    $$ \\lambda = \\frac{1}{2} \\left[ \\frac{(r+1)^2}{r^2} \\pm \\frac{r^2+1}{r^2} \\right] $$\n    $\\lambda_{\\max} = \\frac{1}{2r^2} \\left( (r^2+2r+1) + (r^2+1) \\right) = \\frac{2r^2+2r+2}{2r^2} = \\frac{r^2+r+1}{r^2}$。\n    $\\lambda_{\\min} = \\frac{1}{2r^2} \\left( (r^2+2r+1) - (r^2+1) \\right) = \\frac{2r}{2r^2} = \\frac{1}{r}$。\n    条件数是最大特征值与最小特征值之比：\n    $$ \\kappa_2(K) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{(r^2+r+1)/r^2}{1/r} = \\frac{r^2+r+1}{r} $$\n\n2.  行和对称均衡化后的条件数，$\\kappa_2(S_{\\mathrm{row}} K S_{\\mathrm{row}})$。\n    令 $\\hat{K}_{\\mathrm{row}} = S_{\\mathrm{row}} K S_{\\mathrm{row}}$，其中 $S_{\\mathrm{row}} = \\mathrm{diag}(s_1, s_2)$。条件 $\\sum_j |\\hat{K}_{\\mathrm{row}, ij}| = 1$ (对于 $i=1,2$) 意味着：\n    $s_1^2 K_{11} + s_1 s_2 |K_{12}| = 1$\n    $s_2 s_1 |K_{12}| + s_2^2 K_{22} = 1$\n    这直接意味着 $s_1^2 K_{11} = s_2^2 K_{22}$，所以 $\\hat{K}_{\\mathrm{row}}$ 的对角线元素相等。设这个公共值为 $\\alpha$。那么 $\\hat{K}_{\\mathrm{row}} = \\begin{pmatrix} \\alpha  \\beta \\\\ \\beta  \\alpha \\end{pmatrix}$，其中 $\\beta = s_1 s_2 K_{12}$。\n    行和条件变为 $\\alpha + |\\beta| = 1$。$\\hat{K}_{\\mathrm{row}}$ 的特征值为 $\\alpha+\\beta$ 和 $\\alpha-\\beta$。条件数为 $\\kappa_2(\\hat{K}_{\\mathrm{row}}) = \\frac{\\alpha+|\\beta|}{\\alpha-|\\beta|} = \\frac{1}{\\alpha-|\\beta|}$。\n    我们有 $s_1/s_2 = \\sqrt{K_{22}/K_{11}} = \\sqrt{((r+1)/r^2)/((r+1)/r)} = 1/\\sqrt{r}$。所以 $s_2 = s_1 \\sqrt{r}$。\n    代入第一个方程：$s_1^2 K_{11} + s_1 (s_1\\sqrt{r}) |K_{12}| = 1$。\n    由于 $K_{11}=\\frac{r+1}{r}$ 且 $|K_{12}|=\\frac{1}{r}$，我们得到 $s_1^2 \\left( \\frac{r+1}{r} + \\frac{\\sqrt{r}}{r} \\right) = 1$，这给出 $s_1^2 = \\frac{r}{r+\\sqrt{r}+1}$。\n    $\\alpha = s_1^2 K_{11} = \\frac{r}{r+\\sqrt{r}+1} \\cdot \\frac{r+1}{r} = \\frac{r+1}{r+\\sqrt{r}+1}$。\n    $|\\beta| = s_1 s_2 |K_{12}| = s_1^2 \\sqrt{r} |K_{12}| = \\frac{r}{r+\\sqrt{r}+1} \\cdot \\sqrt{r} \\cdot \\frac{1}{r} = \\frac{\\sqrt{r}}{r+\\sqrt{r}+1}$。\n    $\\alpha-|\\beta| = \\frac{r+1}{r+\\sqrt{r}+1} - \\frac{\\sqrt{r}}{r+\\sqrt{r}+1} = \\frac{r-\\sqrt{r}+1}{r+\\sqrt{r}+1}$。\n    条件数为：\n    $$ \\kappa_2(S_{\\mathrm{row}} K S_{\\mathrm{row}}) = \\frac{1}{\\alpha-|\\beta|} = \\frac{r+\\sqrt{r}+1}{r-\\sqrt{r}+1} $$\n\n3.  几何平均均衡化后的条件数，$\\kappa_2(S_{\\mathrm{geo}} K S_{\\mathrm{geo}})$。\n    缩放为 $S_{\\mathrm{geo}} = \\mathrm{diag}(1/\\sqrt{K_{11}}, 1/\\sqrt{K_{22}})$。缩放后的矩阵 $\\hat{K}_{\\mathrm{geo}} = S_{\\mathrm{geo}} K S_{\\mathrm{geo}}$ 的对角线元素为单位一。\n    $$ \\hat{K}_{\\mathrm{geo}} = \\begin{pmatrix} 1  \\frac{K_{12}}{\\sqrt{K_{11}K_{22}}} \\\\ \\frac{K_{21}}{\\sqrt{K_{11}K_{22}}}  1 \\end{pmatrix} $$\n    设非对角项为 $\\rho = \\frac{K_{12}}{\\sqrt{K_{11}K_{22}}}$。\n    $K_{11}K_{22} = \\left(\\frac{r+1}{r}\\right)\\left(\\frac{r+1}{r^2}\\right) = \\frac{(r+1)^2}{r^3}$。\n    $\\rho = \\frac{-1/r}{\\sqrt{(r+1)^2/r^3}} = \\frac{-1/r}{(r+1)/r^{3/2}} = -\\frac{r^{3/2}}{r(r+1)} = -\\frac{\\sqrt{r}}{r+1}$。\n    矩阵 $\\begin{pmatrix} 1  \\rho \\\\ \\rho  1 \\end{pmatrix}$ 的特征值为 $1+\\rho$ 和 $1-\\rho$。\n    因为 $r>0$，所以 $\\rho$ 是负数，因此 $1-\\rho > 1+\\rho$。\n    $\\lambda_{\\max} = 1-\\rho = 1 + \\frac{\\sqrt{r}}{r+1} = \\frac{r+1+\\sqrt{r}}{r+1}$。\n    $\\lambda_{\\min} = 1+\\rho = 1 - \\frac{\\sqrt{r}}{r+1} = \\frac{r+1-\\sqrt{r}}{r+1}$。\n    这些特征值是正的，因为对于所有 $r>0$ 都有 $r-\\sqrt{r}+1 > 0$。条件数为：\n    $$ \\kappa_2(S_{\\mathrm{geo}} K S_{\\mathrm{geo}}) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{(r+1+\\sqrt{r})/(r+1)}{(r+1-\\sqrt{r})/(r+1)} = \\frac{r+\\sqrt{r}+1}{r-\\sqrt{r}+1} $$\n    该结果与行和对称均衡化的结果相同，这是 $2 \\times 2$ 对称正定矩阵的一个已知性质。\n\n将所求的三个量组装成一个单行矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{r^{2}+r+1}{r}  \\frac{r+\\sqrt{r}+1}{r-\\sqrt{r}+1}  \\frac{r+\\sqrt{r}+1}{r-\\sqrt{r}+1}\n\\end{pmatrix}\n}\n$$", "id": "2546522"}, {"introduction": "条件数分析的应用范围超越了静态问题，延伸到了瞬态现象领域。本练习将考察使用向后欧拉法离散的热方程的系统矩阵，该矩阵结合了质量矩阵和刚度矩阵。您将研究当时间步长 $\\Delta t$ 趋近于零和无穷大时条件数的极限行为，从而揭示系统的条件数是如何在由质量矩阵主导和由刚度矩阵主导之间转换的。[@problem_id:2546532]", "problem": "考虑在区间 $\\Omega=(0,1)$ 上的标量扩散方程的初值问题，其边界条件为齐次狄利克雷边界条件：\n$$\nu_t - u_{xx} = f \\quad \\text{在 } (0,1)\\times(0,T], \\qquad u(0,t)=u(1,t)=0, \\qquad u(x,0)=u_0(x).\n$$\n时间上采用步长为 $\\Delta t>0$ 的后向欧拉法进行离散化，空间上采用标准协调有限元方法，在具有 $n$ 个内部节点和网格尺寸 $h = \\frac{1}{n+1}$ 的均匀网格上使用连续分片线性基函数。记 $M\\in\\mathbb{R}^{n\\times n}$ 和 $K\\in\\mathbb{R}^{n\\times n}$ 分别为由以下双线性形式组装得到的一致质量矩阵和刚度矩阵：\n$$\nm(u_h,v_h)=\\int_0^1 u_h v_h\\,dx, \\qquad a(u_h,v_h)=\\int_0^1 u_h' v_h'\\,dx.\n$$\n每个时间步的全离散线性系统具有如下形式：\n$$\nA(\\Delta t)\\, \\mathbf{u}^{k+1} = \\mathbf{b}^k, \\qquad \\text{其中 } A(\\Delta t)=M+\\Delta t\\,K,\n$$\n其中 $\\mathbf{u}^{k+1}\\in\\mathbb{R}^n$ 汇集了时间层 $k+1$ 处有限元解的节点系数。令 $\\kappa_2(\\cdot)$ 表示欧几里得 2-范数下的谱条件数。\n\n仅使用均匀网格上组装矩阵的基本定义和经过充分检验的性质，推导下列两个极限（作为 $n$ 的函数）的精确闭式表达式：\n$$\n\\lim_{\\Delta t\\to 0} \\kappa_2\\big(A(\\Delta t)\\big) \\quad \\text{和} \\quad \\lim_{\\Delta t\\to \\infty} \\kappa_2\\big(A(\\Delta t)\\big).\n$$\n请将你的最终答案表示为两个只包含 $n$ 和初等函数的显式解析表达式。你的答案必须包含在一行中的两个表达式，顺序为 $\\left(\\lim_{\\Delta t\\to 0}\\kappa_2(A(\\Delta t)),\\ \\lim_{\\Delta t\\to \\infty}\\kappa_2(A(\\Delta t))\\right)$。不需要进行数值计算或四舍五入。", "solution": "矩阵 $A(\\Delta t) = M + \\Delta t K$ 是对称的。对于此问题，已知质量矩阵 $M$ 和刚度矩阵 $K$ 是对称正定的。由于 $\\Delta t > 0$，矩阵 $A(\\Delta t)$ 也是对称正定的。因此，谱条件数由其最大特征值与最小特征值之比给出：\n$$\n\\kappa_2(A(\\Delta t)) = \\frac{\\lambda_{\\max}(A(\\Delta t))}{\\lambda_{\\min}(A(\\Delta t))}\n$$\n对于尺寸为 $h = \\frac{1}{n+1}$ 的均匀网格和连续分片线性基函数，一致质量矩阵 $M \\in \\mathbb{R}^{n \\times n}$ 和刚度矩阵 $K \\in \\mathbb{R}^{n \\times n}$ 由以下公式给出：\n$$\nM = \\frac{h}{6} \n\\begin{pmatrix}\n4  1  0  \\dots  0 \\\\\n1  4  1  \\dots  0 \\\\\n0  \\ddots  \\ddots  \\ddots  0 \\\\\n0  \\dots  1  4  1 \\\\\n0  \\dots  0  1  4\n\\end{pmatrix},\n\\quad\nK = \\frac{1}{h} \n\\begin{pmatrix}\n2  -1  0  \\dots  0 \\\\\n-1  2  -1  \\dots  0 \\\\\n0  \\ddots  \\ddots  \\ddots  0 \\\\\n0  \\dots  -1  2  -1 \\\\\n0  \\dots  0  -1  2\n\\end{pmatrix}\n$$\n这些矩阵是可同时对角化的，因为它们可以表示为同一三对角矩阵的多项式。它们对应于同一组特征向量的特征值具有已知的闭式解。对于 $j=1, 2, \\dots, n$，特征值为：\n$$\n\\lambda_j(M) = \\frac{h}{3} \\left(2 + \\cos\\left(\\frac{j\\pi}{n+1}\\right)\\right)\n$$\n$$\n\\lambda_j(K) = \\frac{2}{h} \\left(1 - \\cos\\left(\\frac{j\\pi}{n+1}\\right)\\right) = \\frac{4}{h} \\sin^2\\left(\\frac{j\\pi}{2(n+1)}\\right)\n$$\n因此，$A(\\Delta t) = M + \\Delta t K$ 的特征值为\n$$\n\\lambda_j(A(\\Delta t)) = \\lambda_j(M) + \\Delta t \\lambda_j(K) = \\frac{h}{3} \\left(2 + \\cos\\left(\\frac{j\\pi}{n+1}\\right)\\right) + \\Delta t \\frac{4}{h} \\sin^2\\left(\\frac{j\\pi}{2(n+1)}\\right)\n$$\n为分析这些特征值的排序，我们使用恒等式 $\\cos(2\\theta) = 1 - 2\\sin^2(\\theta)$。令 $\\theta_j = \\frac{j\\pi}{2(n+1)}$，则 $\\frac{j\\pi}{n+1} = 2\\theta_j$。\n$$\n\\lambda_j(A(\\Delta t)) = \\frac{h}{3} \\left(2 + 1 - 2\\sin^2\\left(\\frac{j\\pi}{2(n+1)}\\right)\\right) + \\Delta t \\frac{4}{h} \\sin^2\\left(\\frac{j\\pi}{2(n+1)}\\right)\n$$\n$$\n\\lambda_j(A(\\Delta t)) = h - \\frac{2h}{3} \\sin^2\\left(\\frac{j\\pi}{2(n+1)}\\right) + \\Delta t \\frac{4}{h} \\sin^2\\left(\\frac{j\\pi}{2(n+1)}\\right)\n$$\n$$\n\\lambda_j(A(\\Delta t)) = h + \\left(\\frac{4\\Delta t}{h} - \\frac{2h}{3}\\right) \\sin^2\\left(\\frac{j\\pi}{2(n+1)}\\right)\n$$\n对于 $j \\in \\{1, \\dots, n\\}$，项 $\\sin^2\\left(\\frac{j\\pi}{2(n+1)}\\right)$ 是关于 $j$ 的严格增函数。特征值 $\\lambda_j(A(\\Delta t))$ 的排序取决于系数 $\\left(\\frac{4\\Delta t}{h} - \\frac{2h}{3}\\right)$ 的符号。\n\n情况 1：极限 $\\Delta t \\to 0$。\n对于足够小的 $\\Delta t$，具体来说是对于 $\\Delta t  \\frac{h^2}{6}$，系数 $\\left(\\frac{4\\Delta t}{h} - \\frac{2h}{3}\\right)$ 为负。因此，$\\lambda_j(A(\\Delta t))$ 是关于 $j$ 的减函数。\n最大和最小特征值为：\n$$\n\\lambda_{\\max}(A(\\Delta t)) = \\lambda_1(A(\\Delta t)) = \\lambda_1(M) + \\Delta t \\lambda_1(K)\n$$\n$$\n\\lambda_{\\min}(A(\\Delta t)) = \\lambda_n(A(\\Delta t)) = \\lambda_n(M) + \\Delta t \\lambda_n(K)\n$$\n条件数为 $\\kappa_2(A(\\Delta t)) = \\frac{\\lambda_1(M) + \\Delta t \\lambda_1(K)}{\\lambda_n(M) + \\Delta t \\lambda_n(K)}$。\n取极限 $\\Delta t \\to 0$：\n$$\n\\lim_{\\Delta t\\to 0} \\kappa_2(A(\\Delta t)) = \\frac{\\lambda_1(M)}{\\lambda_n(M)} = \\kappa_2(M)\n$$\n我们使用 $M$ 的特征值表达式计算该值：\n$$\n\\lambda_1(M) = \\frac{h}{3} \\left(2 + \\cos\\left(\\frac{\\pi}{n+1}\\right)\\right)\n$$\n$$\n\\lambda_n(M) = \\frac{h}{3} \\left(2 + \\cos\\left(\\frac{n\\pi}{n+1}\\right)\\right) = \\frac{h}{3} \\left(2 + \\cos\\left(\\pi - \\frac{\\pi}{n+1}\\right)\\right) = \\frac{h}{3} \\left(2 - \\cos\\left(\\frac{\\pi}{n+1}\\right)\\right)\n$$\n因此，第一个极限是：\n$$\n\\lim_{\\Delta t\\to 0} \\kappa_2(A(\\Delta t)) = \\frac{\\frac{h}{3} \\left(2 + \\cos\\left(\\frac{\\pi}{n+1}\\right)\\right)}{\\frac{h}{3} \\left(2 - \\cos\\left(\\frac{\\pi}{n+1}\\right)\\right)} = \\frac{2 + \\cos\\left(\\frac{\\pi}{n+1}\\right)}{2 - \\cos\\left(\\frac{\\pi}{n+1}\\right)}\n$$\n\n情况 2：极限 $\\Delta t \\to \\infty$。\n对于足够大的 $\\Delta t$，具体来说是对于 $\\Delta t > \\frac{h^2}{6}$，系数 $\\left(\\frac{4\\Delta t}{h} - \\frac{2h}{3}\\right)$ 为正。因此，$\\lambda_j(A(\\Delta t))$ 是关于 $j$ 的增函数。\n最小和最大特征值为：\n$$\n\\lambda_{\\min}(A(\\Delta t)) = \\lambda_1(A(\\Delta t)) = \\lambda_1(M) + \\Delta t \\lambda_1(K)\n$$\n$$\n\\lambda_{\\max}(A(\\Delta t)) = \\lambda_n(A(\\Delta t)) = \\lambda_n(M) + \\Delta t \\lambda_n(K)\n$$\n条件数为 $\\kappa_2(A(\\Delta t)) = \\frac{\\lambda_n(M) + \\Delta t \\lambda_n(K)}{\\lambda_1(M) + \\Delta t \\lambda_1(K)}$。\n为计算极限 $\\Delta t \\to \\infty$，我们将分子和分母同除以 $\\Delta t$：\n$$\n\\lim_{\\Delta t\\to \\infty} \\kappa_2(A(\\Delta t)) = \\lim_{\\Delta t\\to \\infty} \\frac{\\frac{1}{\\Delta t}\\lambda_n(M) + \\lambda_n(K)}{\\frac{1}{\\Delta t}\\lambda_1(M) + \\lambda_1(K)} = \\frac{\\lambda_n(K)}{\\lambda_1(K)} = \\kappa_2(K)\n$$\n我们使用 $K$ 的特征值表达式计算该值：\n$$\n\\lambda_1(K) = \\frac{4}{h} \\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)\n$$\n$$\n\\lambda_n(K) = \\frac{4}{h} \\sin^2\\left(\\frac{n\\pi}{2(n+1)}\\right) = \\frac{4}{h} \\sin^2\\left(\\frac{\\pi}{2} - \\frac{\\pi}{2(n+1)}\\right) = \\frac{4}{h} \\cos^2\\left(\\frac{\\pi}{2(n+1)}\\right)\n$$\n因此，第二个极限是：\n$$\n\\lim_{\\Delta t\\to \\infty} \\kappa_2(A(\\Delta t)) = \\frac{\\frac{4}{h} \\cos^2\\left(\\frac{\\pi}{2(n+1)}\\right)}{\\frac{4}{h} \\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)} = \\frac{\\cos^2\\left(\\frac{\\pi}{2(n+1)}\\right)}{\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)} = \\cot^2\\left(\\frac{\\pi}{2(n+1)}\\right)\n$$\n两个所求的极限已作为 $n$ 的函数以闭式形式推导得出。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2 + \\cos\\left(\\frac{\\pi}{n+1}\\right)}{2 - \\cos\\left(\\frac{\\pi}{n+1}\\right)}  \\cot^2\\left(\\frac{\\pi}{2(n+1)}\\right) \\end{pmatrix}}\n$$", "id": "2546532"}]}