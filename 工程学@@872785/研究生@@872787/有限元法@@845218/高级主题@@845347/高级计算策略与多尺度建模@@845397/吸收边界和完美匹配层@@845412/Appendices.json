{"hands_on_practices": [{"introduction": "在深入研究完美匹配层（PML）的复杂性之前，理解更简单的吸收边界条件（ABC）的性能和局限性是至关重要的一步。本练习 [@problem_id:2540259] 将指导您分析标准局部ABC引起的反射，通过推导和评估反射系数$R(\\theta)$，您将亲身体会到这些方法的有效性是如何随入射角变化的。这项实践为理解为何需要像PML这样更先进的技术奠定了基础。", "problem": "考虑均匀介质中的二维时谐亥姆霍兹方程，\n$$\\Delta u + k^{2} u = 0,$$\n该方程定义在半空间 $\\{x \\le 0\\}$ 中，在 $x=0$ 处有一个平面人工边界。一个波数为 $k0$ 的平面波从内部以角度 $\\theta \\in (0,\\pi/2)$ （从外法线方向测量）入射，因此入射场为\n$$u_{\\mathrm{inc}}(x,y) = \\exp\\!\\big(i (k \\cos\\theta) x + i (k \\sin\\theta) y\\big).$$\n用 $y$ 表示边界上的切向坐标。内部的总场被建模为入射波和镜面反射波之和，\n$$u(x,y) = \\exp\\!\\big(i (k \\cos\\theta) x + i (k \\sin\\theta) y\\big) + R(\\theta)\\,\\exp\\!\\big(-i (k \\cos\\theta) x + i (k \\sin\\theta) y\\big),$$\n其中 $R(\\theta)$ 是由 $x=0$ 处的边界条件引起的复反射系数。精确的无反射边界会产生 $R(\\theta)=0$；实践中我们使用局部吸收边界条件（ABCs）。在 $x=0$ 处的两个标准局部ABC是：\n- 一阶（阻抗）ABC：$\\partial_{x} u = i k\\, u$。\n- 二阶ABC：$\\partial_{x} u = i k\\, u - \\frac{1}{2 i k}\\,\\partial_{y}^{2} u$。\n\n仅从上述亥姆霍兹模型和这些边界算子出发，完成以下任务：\n1. 通过在 $x=0$ 上施加 $\\partial_{x} u = i k\\, Q(\\partial_{y})\\,u$ 来推导 $R(\\theta)$ 的闭式表达式，其中 $Q(\\partial_{y})$ 是边界算子符号。然后，通过在平面波因子 $\\exp(i k \\sin\\theta\\, y)$ 上评估 $Q$，证明对于一阶ABC，$Q_{1}(\\theta)=1$，对于二阶ABC，$Q_{2}(\\theta)=1 - \\frac{1}{2}\\sin^{2}\\theta$。\n2. 使用你得到的 $R(\\theta)$ 表达式，分析入射角集合 $\\Theta=\\{\\pi/6,\\ \\pi/4,\\ \\pi/3\\}$ 下反射波的相位，并确定相位的共同值 $\\arg(R(\\theta))$ （如果它与 $\\theta$ 和ABC的阶数无关，请说明并证明）。\n3. 以弧度表示最终的相位值。\n\n你的最终答案必须是单个数字或单个闭式解析表达式。以弧度表示相位。不需要四舍五入。", "solution": "所提出的问题是波传播现象中吸收边界条件分析的一个标准练习。它具有科学依据，问题提法恰当，并包含了获得唯一解所需的所有信息。我们将开始推导。\n\n控制方程是定义在半空间 $\\{x \\le 0\\}$ 中的均匀介质的二维时谐亥姆霍兹方程：\n$$ \\Delta u + k^{2} u = 0 $$\n其中 $k  0$ 是波数。域中的总场 $u(x,y)$ 由入射平面波和反射平面波叠加而成：\n$$ u(x,y) = \\exp(i (k \\cos\\theta) x + i (k \\sin\\theta) y) + R(\\theta)\\,\\exp(-i (k \\cos\\theta) x + i (k \\sin\\theta) y) $$\n其中 $R(\\theta)$ 是复反射系数，$\\theta \\in (0, \\pi/2)$ 是入射角。为简洁起见，我们定义波矢分量 $k_x = k \\cos\\theta$ 和 $k_y = k \\sin\\theta$。场可以写成：\n$$ u(x,y) = \\exp(i k_y y) \\left( \\exp(i k_x x) + R(\\theta) \\exp(-i k_x x) \\right) $$\n分析需要在 $x=0$ 的人工边界上计算场及其导数。在 $x=0$ 处，场为：\n$$ u(0,y) = (1 + R(\\theta)) \\exp(i k_y y) $$\n场关于 $x$ 的偏导数是：\n$$ \\partial_x u(x,y) = \\exp(i k_y y) \\left( i k_x \\exp(i k_x x) - i k_x R(\\theta) \\exp(-i k_x x) \\right) $$\n在边界 $x=0$ 处，这变成：\n$$ \\partial_x u(0,y) = i k_x (1 - R(\\theta)) \\exp(i k_y y) $$\n在 $x=0$ 处的吸收边界条件（ABC）的一般形式为：\n$$ \\partial_x u = i k\\, Q(\\partial_y)\\,u $$\n算子 $Q(\\partial_y)$ 作用于波的切向部分 $\\exp(i k_y y)$。切向导数算子 $\\partial_y$ 对此平面波的作用等效于乘以复数 $i k_y = i k \\sin\\theta$。因此，当算子 $Q(\\partial_y)$ 应用于平面波时，它变成一个乘法符号，记作 $Q(\\theta)$。\n\n首先，我们确定给定的两个ABC的符号 $Q_1(\\theta)$ 和 $Q_2(\\theta)$。\n对于一阶ABC，$\\partial_{x} u = i k\\, u$。将其与一般形式 $\\partial_{x} u = i k\\, Q_1(\\partial_{y})\\,u$ 进行比较，我们看到 $Q_1(\\partial_{y})$ 是单位算子，$Q_1(\\partial_{y}) = 1$。因此，相应的符号是一个常数，$Q_1(\\theta)=1$，与角度 $\\theta$ 无关。这证实了问题陈述的第一部分。\n对于二阶ABC，$\\partial_{x} u = i k\\, u - \\frac{1}{2 i k}\\,\\partial_{y}^{2} u$。我们可以将其因式分解为：\n$$ \\partial_x u = i k \\left( 1 - \\frac{1}{2 (i k) (i k)} \\partial_y^2 \\right) u = i k \\left( 1 + \\frac{1}{2 k^2} \\partial_y^2 \\right) u $$\n将其与一般形式 $\\partial_x u = i k\\, Q_2(\\partial_y)\\,u$ 进行比较，我们确定算子 $Q_2(\\partial_y) = 1 + \\frac{1}{2 k^2} \\partial_y^2$。为了找到其符号 $Q_2(\\theta)$，我们将算子 $\\partial_y^2$ 替换为它对平面波因子 $\\exp(i k_y y)$ 的作用，即乘以 $(i k_y)^2 = (i k \\sin\\theta)^2 = -k^2 \\sin^2\\theta$。这得到：\n$$ Q_2(\\theta) = 1 + \\frac{1}{2 k^2} (-k^2 \\sin^2\\theta) = 1 - \\frac{1}{2} \\sin^2\\theta $$\n这证实了问题陈述的第二部分。\n\n现在，我们推导反射系数 $R(\\theta)$ 的一般表达式。我们将 $u(0,y)$ 和 $\\partial_x u(0,y)$ 的表达式代入一般ABC中，并在符号层面进行评估：\n$$ i k_x (1 - R(\\theta)) \\exp(i k_y y) = i k Q(\\theta) (1 + R(\\theta)) \\exp(i k_y y) $$\n由于 $k0$ 且 $\\exp(i k_y y)$ 非零，我们可以消去项 $i$ 和 $\\exp(i k_y y)$：\n$$ k_x (1 - R(\\theta)) = k Q(\\theta) (1 + R(\\theta)) $$\n代入 $k_x = k \\cos\\theta$ 并除以 $k$：\n$$ \\cos\\theta (1 - R(\\theta)) = Q(\\theta) (1 + R(\\theta)) $$\n我们重排这个代数方程来求解 $R(\\theta)$：\n$$ \\cos\\theta - R(\\theta) \\cos\\theta = Q(\\theta) + R(\\theta) Q(\\theta) $$\n$$ \\cos\\theta - Q(\\theta) = R(\\theta) (\\cos\\theta + Q(\\theta)) $$\n这就得到了反射系数的闭式表达式：\n$$ R(\\theta) = \\frac{\\cos\\theta - Q(\\theta)}{\\cos\\theta + Q(\\theta)} $$\n接下来，我们分析两种ABC下 $R(\\theta)$ 的相位。入射角的定义域是 $\\theta \\in (0, \\pi/2)$，它包括了指定的集合 $\\Theta=\\{\\pi/6,\\ \\pi/4,\\ \\pi/3\\}$。复数 $z$ 的相位是它的辐角，$\\arg(z)$。\n对于一阶ABC，$Q_1(\\theta) = 1$。反射系数是：\n$$ R_1(\\theta) = \\frac{\\cos\\theta - 1}{\\cos\\theta + 1} $$\n对于 $\\theta \\in (0, \\pi/2)$，我们有 $0  \\cos\\theta  1$。因此，分子 $\\cos\\theta - 1$ 是一个负实数，分母 $\\cos\\theta + 1$ 是一个正实数。因此，比值 $R_1(\\theta)$ 是一个负实数。任何负实数的辐角都是 $\\pi$。因此，对于所有 $\\theta \\in (0, \\pi/2)$，有 $\\arg(R_1(\\theta)) = \\pi$。\n\n对于二阶ABC，$Q_2(\\theta) = 1 - \\frac{1}{2} \\sin^2\\theta$。反射系数是：\n$$ R_2(\\theta) = \\frac{\\cos\\theta - \\left(1 - \\frac{1}{2} \\sin^2\\theta\\right)}{\\cos\\theta + \\left(1 - \\frac{1}{2} \\sin^2\\theta\\right)} $$\n对于 $\\theta \\in (0, \\pi/2)$，$\\cos\\theta$ 和 $Q_2(\\theta)$ 都是实数值。分母是 $\\cos\\theta + 1 - \\frac{1}{2} \\sin^2\\theta$。因为 $\\cos\\theta  0$ 并且 $1 - \\frac{1}{2} \\sin^2\\theta  1 - \\frac{1}{2} = \\frac{1}{2}$，所以分母是严格为正的。\n我们使用恒等式 $\\sin^2\\theta = 1 - \\cos^2\\theta$ 来分析分子：\n$$ \\cos\\theta - 1 + \\frac{1}{2} \\sin^2\\theta = \\cos\\theta - 1 + \\frac{1}{2}(1 - \\cos^2\\theta) = -\\frac{1}{2}\\cos^2\\theta + \\cos\\theta - \\frac{1}{2} = -\\frac{1}{2}(\\cos^2\\theta - 2\\cos\\theta + 1) = -\\frac{1}{2}(\\cos\\theta - 1)^2 $$\n由于 $\\theta \\in (0, \\pi/2)$，$\\cos\\theta \\neq 1$，所以 $(\\cos\\theta - 1)^2  0$。因此，分子是一个严格为负的实数。\n由于分子是负实数，分母是正实数，所以比值 $R_2(\\theta)$ 是一个负实数。因此它的辐角是 $\\arg(R_2(\\theta)) = \\pi$。\n\n在这两种情况下，对于任何入射角 $\\theta \\in (0, \\pi/2)$ （包括集合 $\\Theta$ 中的所有角度），反射系数 $R(\\theta)$ 都是一个负实数。这是因为对于这些特定的ABC，符号 $Q(\\theta)$ 是实值的，并且在指定的 $\\theta$ 范围内，分子 $\\cos\\theta - Q(\\theta)$ 始终为负，而分母 $\\cos\\theta + Q(\\theta)$ 始终为正。\n因此，反射波的相位与入射角 $\\theta$ 和ABC的阶数（在所考虑的两种情况下）都无关。相位的共同值是 $\\pi$。以弧度表示，这就是最终答案。", "answer": "$$\\boxed{\\pi}$$", "id": "2540259"}, {"introduction": "明确了对更优吸收体的需求后，下一步是学习如何高效地设计它们。这项实践 [@problem_id:2540286] 聚焦于一个基本的PML优化问题：在满足给定波衰减目标的前提下，如何设计吸收剖面以最小化吸收层的厚度。解决这个问题能让您掌握PML设计的核心原则，这对于在计算模拟中平衡精度与效率至关重要。", "problem": "考虑一个一维标量时谐波，其角频率为 $\\omega$，自由空间波数为 $k0$。该波遵循亥姆霍兹方程，并入射到一个占据区间 $x \\in [0,L]$ 的完美匹配层（PML）上。在本问题用于PML设计的模型中，复数拉伸坐标定义为 $x' = \\int_{0}^{x} s(\\xi)\\,d\\xi$，PML内的出射波振幅被建模为按 $|u(x)| \\propto \\exp\\!\\left(-\\int_{0}^{x} \\Re(k\\,s(\\xi))\\,d\\xi\\right)$ 衰减。其中 $s(x)$ 是一个无量纲拉伸剖面，它通过以下关系式与一个非负的设计“电导率”剖面 $\\sigma(x)$ 相关联：\n$$\ns(x) = \\frac{\\sigma(x)}{\\omega}.\n$$\n假设设计电导率在 $[0,L]$ 上几乎处处满足逐点界 $0 \\le \\sigma(x) \\le \\sigma_{\\max}$。\n\n您的任务是最小化PML厚度 $L$，同时确保一个给定的积分衰减预算，即\n$$\n\\int_{0}^{L} \\Re\\!\\big(k\\,s(x)\\big)\\,dx \\;\\ge\\; \\eta,\n$$\n其中 $\\eta0$ 是给定的。请将此问题视为一个关于厚度 $L0$ 和受其界限约束的可测函数 $\\sigma(x)$ 的联合优化问题。\n\n1. 建立约束优化问题，以最小化 $L$，该问题受积分衰减约束和 $\\sigma(x)$ 的逐点界约束。\n2. 仅使用单调性和积分不等式的基本性质，并且除了上述定义外不引用任何预先推导的PML公式，推导出最优PML厚度 $L^{\\star}$ 并刻画相应的最优剖面 $\\sigma^{\\star}(x)$。\n3. 对于数据 $k = 20\\,\\text{m}^{-1}$、$\\eta = 12$ 以及设计界 $\\sigma_{\\max} = 5\\,\\omega$，计算 $L^{\\star}$ 的值。将最终数值答案四舍五入到四位有效数字。以米为单位表示最终厚度。\n\n您的最终答案必须仅为 $L^{\\star}$ 的值。最终答案中不要包含任何中间表达式。", "solution": "所述问题具有科学依据、提法恰当且客观。没有矛盾或缺失信息。我们可以着手求解。\n\n任务是解决一个约束优化问题。我们必须最小化完美匹配层（PML）的厚度 $L$，同时满足积分衰减约束和一个设计参数的逐点界约束。\n\n首先，我们按要求将优化问题形式化。目标是最小化函数 $f(L, \\sigma) = L$，其中 $L  0$。优化是同时针对标量 $L$ 和定义在区间 $[0,L]$ 上的可测函数 $\\sigma(x)$ 进行的。约束条件是：\n1. 积分衰减预算：$\\int_{0}^{L} \\Re\\!\\big(k\\,s(x)\\big)\\,dx \\ge \\eta$。\n2. 设计电导率的逐点界：对几乎所有 $x \\in [0,L]$，有 $0 \\le \\sigma(x) \\le \\sigma_{\\max}$。\n\n拉伸剖面 $s(x)$ 与电导率剖面 $\\sigma(x)$ 的关系为 $s(x) = \\frac{\\sigma(x)}{\\omega}$。我们已知自由空间波数 $k  0$，角频率 $\\omega  0$，且电导率剖面是非负的，即 $\\sigma(x) \\ge 0$。因此，拉伸函数 $s(x)$ 是实数且非负的。约束中的实部算子 $\\Re$ 因此是多余的，因为 $\\Re(k s(x)) = k s(x)$。衰减约束简化为：\n$$\n\\int_{0}^{L} k\\,s(x)\\,dx \\ge \\eta\n$$\n代入 $s(x)$ 的定义，我们得到：\n$$\n\\int_{0}^{L} k \\frac{\\sigma(x)}{\\omega} \\,dx \\ge \\eta\n$$\n由于 $k$ 和 $\\omega$ 是正常数，我们可以将其写为：\n$$\n\\frac{k}{\\omega} \\int_{0}^{L} \\sigma(x) \\,dx \\ge \\eta\n$$\n我们希望找到能使此不等式成立的 $L$ 的最小值。让我们分析积分项 $\\int_{0}^{L} \\sigma(x) \\,dx$。被积函数 $\\sigma(x)$ 受到逐点约束 $0 \\le \\sigma(x) \\le \\sigma_{\\max}$。为了对于给定的长度 $L$ 使积分值尽可能大，我们必须在积分域中的每个点 $x$ 处选择尽可能大的被积函数 $\\sigma(x)$。这是定积分单调性性质的直接推论。\n\n$\\sigma(x)$ 的最大可能值为 $\\sigma_{\\max}$。因此，对于任何有效的剖面 $\\sigma(x)$，我们有以下不等式：\n$$\n\\sigma(x) \\le \\sigma_{\\max}\n$$\n将此不等式在区间 $[0,L]$ 上积分，得到：\n$$\n\\int_{0}^{L} \\sigma(x) \\,dx \\le \\int_{0}^{L} \\sigma_{\\max} \\,dx = \\sigma_{\\max} L\n$$\n现在，我们可以将此结果与衰减约束结合起来：\n$$\n\\eta \\le \\frac{k}{\\omega} \\int_{0}^{L} \\sigma(x) \\,dx \\le \\frac{k}{\\omega} (\\sigma_{\\max} L)\n$$\n这个不等式链为我们提供了PML厚度 $L$ 的一个下界：\n$$\n\\eta \\le \\frac{k\\,\\sigma_{\\max}}{\\omega} L\n$$\n对 $L$ 求解，我们发现：\n$$\nL \\ge \\frac{\\eta\\,\\omega}{k\\,\\sigma_{\\max}}\n$$\n这个不等式表明，无论剖面 $\\sigma(x)$ 如何选择，任何小于 $\\frac{\\eta\\,\\omega}{k\\,\\sigma_{\\max}}$ 的厚度 $L$ 都无法满足约束条件。因此，$L$ 的最小可能值为：\n$$\nL^{\\star} = \\frac{\\eta\\,\\omega}{k\\,\\sigma_{\\max}}\n$$\n这个最小厚度可以达到，当且仅当不等式链中的两个不等式都变为等式。第一个不等式 $\\eta \\le \\frac{k}{\\omega} \\int_{0}^{L} \\sigma(x) \\,dx$ 变为等式，是根据在最小值处满足衰减预算的定义。第二个不等式 $\\frac{k}{\\omega} \\int_{0}^{L} \\sigma(x) \\,dx \\le \\frac{k\\,\\sigma_{\\max}}{\\omega} L$ 变为等式，当且仅当对于几乎所有 $x \\in [0,L]$ 都有 $\\sigma(x) = \\sigma_{\\max}$。\n\n因此，允许最小厚度 $L^{\\star}$ 的最优电导率剖面 $\\sigma^{\\star}(x)$ 是在其允许的最大值上均匀分布的剖面：\n$$\n\\sigma^{\\star}(x) = \\sigma_{\\max} \\quad \\text{for a.e. } x \\in [0, L^{\\star}]\n$$\n这一选择最大化了单位长度的衰减，从而最小化了达到目标衰减 $\\eta$ 所需的总长度。\n\n最后，我们根据给定的数值数据计算最优厚度 $L^{\\star}$：$k = 20\\,\\text{m}^{-1}$，$\\eta = 12$，以及 $\\sigma_{\\max} = 5\\,\\omega$。\n将 $\\sigma_{\\max} = 5\\,\\omega$ 代入 $L^{\\star}$ 的表达式中：\n$$\nL^{\\star} = \\frac{\\eta\\,\\omega}{k\\,\\sigma_{\\max}} = \\frac{\\eta\\,\\omega}{k\\,(5\\,\\omega)} = \\frac{\\eta}{5\\,k}\n$$\n注意，最优厚度与角频率 $\\omega$ 无关。代入 $\\eta$ 和 $k$ 的数值：\n$$\nL^{\\star} = \\frac{12}{5 \\times 20} = \\frac{12}{100} = 0.12 \\text{ m}\n$$\n问题要求答案四舍五入到四位有效数字。因此，$L^{\\star} = 0.1200$ 米。", "answer": "$$\n\\boxed{0.1200}\n$$", "id": "2540286"}, {"introduction": "将连续的PML理论应用于实际的有限元方法会引入新的误差来源，其中最主要的是离散化本身引起的数值反射。这项高级练习 [@problem_id:2540247] 将带您直面这一挑战，通过协同优化网格密度和吸收剖面来最大限度地减少这些不必要的数值伪影。这项实践连接了理论与实际应用，是PML在计算模型中成功实施的关键。", "problem": "考虑一维时谐标量波，在波数为 $k  0$ 的均匀介质中由亥姆霍兹方程 $u''(x) + k^{2} u(x) = 0$ 控制。物理域占据 $x  0$ 的空间，并在 $x = 0$ 处由一个厚度为 $L  0$ 的完美匹配层 (PML) 终止，该层占据 $0 \\leq x \\leq L$。PML 通过复坐标伸展实现，其伸展因子为 $s(x) = 1 + i\\,\\sigma(x)/\\omega$，其中 $\\sigma(x) \\geq 0$ 是 PML 吸收剖面，$\\omega  0$ 是角频率。对于一个正入射到 PML 上的右行平面波，局部振幅以速率 $\\alpha(x) = k\\,\\mathrm{Im}\\,s(x) = k\\,\\sigma(x)/\\omega$ 衰减，相应的局部衰减长度为 $\\ell(x) = 1/\\alpha(x)$。\n\nPML 使用有限元法 (FEM) 进行离散化，基函数为连续分段线性函数，作用于网格 $\\{x_{j}\\}_{j=0}^{N}$ 上，其中 $x_{0} = 0$，$x_{N} = L$，单元尺寸为 $h_{j} = x_{j+1} - x_{j}$。假设 $\\alpha(x)$ 和 $h(x)$ 的变化足够缓慢，使得局部的 Wentzel–Kramers–Brillouin (WKB) 近似有意义，并且在 $x = L$ 处的截断是无反射的。定义总 PML 衰减预算\n$$\nA_{0} \\;=\\; \\int_{0}^{L} \\alpha(x)\\,dx \\;=\\; \\int_{0}^{L} \\frac{dx}{\\ell(x)} \\,,\n$$\n该预算由精度考虑确定，且与离散化无关。\n\n1) 从一维线性 FEM 一致性的第一性原理出发，分析一个具有恒定 $\\alpha$ 和均匀网格尺寸 $h$ 的半无限均匀 PML，并证明由中心差分计算的离散节点对数导数\n$$\n\\delta \\;=\\; \\frac{u(x+h) - u(x-h)}{2h\\,u(x)}\n$$\n近似精确对数导数 $u'(x)/u(x) = -\\alpha$ 时，其相对误差为 $(\\alpha h)^{2}$ 阶。利用此结果对 $x=0$ 处的离散阻抗失配进行建模，并根据无量纲比 $h/\\ell$ 推导均匀情况下的主阶反射振幅。\n\n2) 通过对局部产生的、经由从 $x=0$ 开始的衰减加权的反向散射进行叠加，将结果启发式地推广到具有可变 $\\ell(x)$ 和 $h(x)$ 的渐变 PML，并论证一个最坏情况界（当所有相位建设性对齐时达到）具有以下形式\n$$\nR_{\\mathrm{worst}} \\;\\approx\\; C \\sum_{j=0}^{N-1} \\left(\\frac{h_{j}}{\\ell_{j}}\\right)^{2} \\exp\\!\\left(-2 \\int_{0}^{x_{j}} \\frac{ds}{\\ell(s)}\\right),\n$$\n其中 $C$ 是由对数导数的主阶离散化决定的某个常数，$\\ell_{j}$ 表示单元 $j$ 上的 $\\ell$ 值，而 $x_{j}$ 是其左端点。\n\n3) 通过忽略指数因子以获得最坏情况上界，建立在以下约束条件下，关于正数 $\\{h_{j}\\}_{j=0}^{N-1}$ 和 $\\{\\ell_{j}\\}_{j=0}^{N-1}$ 的选择来最小化 $R_{\\mathrm{worst}}$ 的优化问题\n$$\n\\sum_{j=0}^{N-1} \\frac{h_{j}}{\\ell_{j}} \\;=\\; A_{0}, \n\\qquad\n\\sum_{j=0}^{N-1} h_{j} \\;=\\; L,\n$$\n以及固定的单元数 $N$。证明最小化器使单元比率 $h_{j}/\\ell_{j}$ 均等分布，并仅用 $A_{0}$ 和 $N$ 表示可达到的最小 $R_{\\mathrm{worst}}$。\n\n4) 使用恒等式 $\\ell(x) = \\omega/(k\\,\\sigma(x))$，将最优吸收梯度 $\\sigma(x)$ 表示为第 3 部分中获得的最小化设计中局部单元尺寸 $h(x)$ 的函数。您的最终答案应以一个包含三个条目的行向量形式给出：最小化的最坏情况反射振幅、由 $r = h(x)/\\ell(x)$ 定义的最优常数比 $r$，以及作为 $h(x)$ 函数的吸收剖面 $\\sigma(x)$。不需要进行数值近似，最终的方框答案中不应包含任何单位。", "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据、适定、客观，并包含足够的信息以进行严谨的求解。我们将按要求进行推导。\n\n该问题要求对一维亥姆霍兹方程的完美匹配层 (PML) 中由离散化引起的反射进行多部分分析，最终对 PML 参数进行优化。\n\n第一部分：均匀 PML 分析\n\n我们被要求分析对数导数的离散近似误差，并用它来建模来自均匀 PML 的反射。控制方程是 $u''(x) + k^2 u(x) = 0$。在 PML 中，使用了复坐标伸展 $x \\to \\tilde{x} = \\int_0^x s(t)dt$，其中 $s(x) = 1 + i\\sigma(x)/\\omega$。对于右行波，PML 中的解形式为 $u(x) \\propto \\exp(ik\\tilde{x})$。对于均匀 PML，$s(x)=s$ 是常数，解为 $u(x) = \\exp(iksx)$。衰减率为 $\\alpha = k\\,\\mathrm{Im}(s)$，所以 $s=1+i\\alpha/k$。波的衰减部分的解可以写为 $u(x) \\sim \\exp(-\\alpha x)$。问题要求分析这个纯衰减波的对数导数。\n\n精确的对数导数是 $\\gamma_{\\text{exact}} = \\frac{u'(x)}{u(x)} = \\frac{-\\alpha \\exp(-\\alpha x)}{\\exp(-\\alpha x)} = -\\alpha$。\n\n问题为节点对数导数提供了一个中心差分近似：\n$$\n\\delta = \\frac{u(x+h) - u(x-h)}{2h\\,u(x)}\n$$\n代入 $u(x) = \\exp(-\\alpha x)$，我们得到离散对数导数：\n$$\n\\delta = \\frac{\\exp(-\\alpha(x+h)) - \\exp(-\\alpha(x-h))}{2h \\exp(-\\alpha x)} = \\frac{\\exp(-\\alpha h) - \\exp(\\alpha h)}{2h} = -\\frac{\\sinh(\\alpha h)}{h}\n$$\n为了找到相对误差，我们将 $\\delta$ 对小的 $\\alpha h$ 进行展开：\n$$\n\\delta = -\\frac{1}{h} \\left( (\\alpha h) + \\frac{(\\alpha h)^3}{3!} + \\mathcal{O}((\\alpha h)^5) \\right) = -\\alpha \\left( 1 + \\frac{(\\alpha h)^2}{6} + \\mathcal{O}((\\alpha h)^4) \\right)\n$$\n近似 $\\gamma_{\\text{exact}} = -\\alpha$ 的相对误差是：\n$$\n\\text{Error}_{\\text{rel}} = \\frac{\\delta - \\gamma_{\\text{exact}}}{\\gamma_{\\text{exact}}} = \\frac{-\\alpha(1 + (\\alpha h)^2/6) - (-\\alpha)}{-\\alpha} = \\frac{-\\alpha (\\alpha h)^2/6}{-\\alpha} = \\frac{(\\alpha h)^2}{6}\n$$\n主阶相对误差确实是 $(\\alpha h)^2$ 阶的。\n\n接下来，我们对离散阻抗失配进行建模。数值误差为离散化介质引入了一个有效阻抗 $Z_{\\text{num}}$，它不同于连续介质的阻抗 $Z_{\\text{cont}}$。这种失配会产生反射。阻抗 $Z$ 与对数导数 $\\gamma = u'/u$ 相关。一个常见的约定是 $Z \\propto 1/\\gamma$。对于小的阻抗失配，反射系数 $R$ 约为 $R \\approx \\frac{\\Delta Z}{2Z}$。给定 $Z \\propto 1/\\gamma$，一个小的变化 $\\Delta \\gamma$ 导致 $\\frac{\\Delta Z}{Z} \\approx -\\frac{\\Delta \\gamma}{\\gamma}$。\n因此，反射振幅为 $|R| \\approx \\frac{1}{2} \\left|\\frac{\\Delta \\gamma}{\\gamma}\\right|$。\n这里，对数导数的“变化”是由离散化引入的误差，$\\Delta\\gamma = \\delta - \\gamma_{\\text{exact}} \\approx -\\alpha \\frac{(\\alpha h)^2}{6}$。\n反射振幅则为：\n$$\n|R| \\approx \\frac{1}{2} \\left| \\frac{-\\alpha (\\alpha h)^2 / 6}{-\\alpha} \\right| = \\frac{(\\alpha h)^2}{12}\n$$\n使用衰减长度 $\\ell = 1/\\alpha$ 的定义，主阶反射振幅为 $\\frac{1}{12}\\left(\\frac{h}{\\ell}\\right)^2$。这表明第二部分中的常数 $C$ 是 $C=1/12$。\n\n第二部分：渐变 PML 与最坏情况反射\n\n我们将此结果启发式地推广到网格尺寸 $h(x)$ 和衰减长度 $\\ell(x)$ 变化的渐变 PML。由位置 $x_j$ 处的单元 $j$ 局部产生的反射，其振幅与 $(h_j/\\ell_j)^2$ 成正比，其中 $h_j$ 和 $\\ell_j$ 分别是局部单元尺寸和衰减长度。根据第一部分，这个局部反射振幅是 $dR_j \\approx \\frac{1}{12}(h_j/\\ell_j)^2$。\n\n这个局部产生的反向传播波必须从其起点 $x_j$ 传播回界面 $x=0$。在此过程中，其振幅会衰减。对于一个从 $x=0$ 传播到 $x_j$ 再返回的波，其往返衰减因子是 $\\exp\\left(-2\\int_0^{x_j} \\alpha(s)\\,ds\\right) = \\exp\\left(-2\\int_0^{x_j} \\frac{ds}{\\ell(s)}\\right)$。\n\n在 $x=0$ 处的总反射是来自所有单元的反射的叠加。通过对这些贡献的幅度求和，可以得到一个最坏情况界，这对应于所有反向散射波的相长干涉。\n$$\nR_{\\mathrm{worst}} \\approx \\sum_{j=0}^{N-1} |dR_j| \\times (\\text{衰减因子}) = \\sum_{j=0}^{N-1} \\frac{1}{12} \\left(\\frac{h_{j}}{\\ell_{j}}\\right)^{2} \\exp\\!\\left(-2 \\int_{0}^{x_{j}} \\frac{ds}{\\ell(s)}\\right)\n$$\n这与问题中给出的形式相符，其中 $C=1/12$。\n\n第三部分：优化问题\n\n问题要求通过忽略指数因子来最小化 $R_{\\mathrm{worst}}$ 的一个最坏情况上界。要最小化的目标函数是一个简化的反射度量，$R_{\\text{up}}$：\n$$\nR_{\\text{up}}(\\{h_j\\}, \\{\\ell_j\\}) = \\frac{1}{12} \\sum_{j=0}^{N-1} \\left(\\frac{h_{j}}{\\ell_{j}}\\right)^{2}\n$$\n这个最小化受 $N$ 个单元的两个约束条件限制：\n1. 总衰减预算：$\\sum_{j=0}^{N-1} \\frac{h_{j}}{\\ell_{j}} = A_{0}$\n2. 总 PML 厚度：$\\sum_{j=0}^{N-1} h_{j} = L$\n\n令 $r_j = h_j/\\ell_j$。关于比率 $\\{r_j\\}$ 的优化问题是在约束 $\\sum_{j=0}^{N-1} r_j = A_0$ 下最小化 $\\sum_{j=0}^{N-1} r_j^2$。第二个约束 $\\sum h_j=L$ 并不直接约束 $\\{r_j\\}$ 的选择。\n\n我们可以使用柯西-施瓦茨不等式来解决这个问题。对于 $\\mathbb{R}^N$ 中的两个向量 $\\vec{a}=(1, 1, \\dots, 1)$ 和 $\\vec{b}=(r_0, r_1, \\dots, r_{N-1})$：\n$$\n(\\vec{a} \\cdot \\vec{b})^2 \\le \\|\\vec{a}\\|^2 \\|\\vec{b}\\|^2\n$$\n$$\n\\left(\\sum_{j=0}^{N-1} 1 \\cdot r_j\\right)^2 \\le \\left(\\sum_{j=0}^{N-1} 1^2\\right) \\left(\\sum_{j=0}^{N-1} r_j^2\\right)\n$$\n代入约束 $\\sum r_j = A_0$：\n$$\nA_0^2 \\le N \\left(\\sum_{j=0}^{N-1} r_j^2\\right)\n$$\n这给出了目标函数的一个下界：$\\sum r_j^2 \\ge \\frac{A_0^2}{N}$。\n当向量共线时，即 $r_j = c \\cdot 1$（其中 $c$ 为某个常数），等号成立，从而达到最小值。这证明了最小化器会均等分配单元比率：对于所有的 $j=0, \\dots, N-1$，$r_j = r$。\n\n在第一个约束中使用这个结果：\n$$\n\\sum_{j=0}^{N-1} r = N r = A_0 \\implies r = \\frac{A_0}{N}\n$$\n该和的最小值为 $\\sum r_j^2 = \\sum (A_0/N)^2 = N (A_0/N)^2 = A_0^2/N$。\n因此，简化的反射度量的可达到的最小值为：\n$$\nR_{\\text{up, min}} = \\frac{1}{12} \\frac{A_0^2}{N}\n$$\n\n第四部分：最优吸收梯度\n\n最后一步是为最小化设计找到最优吸收剖面 $\\sigma(x)$。最优设计要求比率 $h(x)/\\ell(x)$ 在 PML 中处处为常数。取第三部分离散结果的连续极限：\n$$\nr(x) = \\frac{h(x)}{\\ell(x)} = \\frac{A_0}{N}\n$$\n这里，$h(x)$ 是局部单元尺寸。我们已知关系式 $\\ell(x) = \\omega/(k\\,\\sigma(x))$。将其代入最优性条件：\n$$\n\\frac{h(x)}{\\omega / (k\\,\\sigma(x))} = \\frac{A_0}{N}\n$$\n$$\n\\frac{h(x) k \\sigma(x)}{\\omega} = \\frac{A_0}{N}\n$$\n解出 $\\sigma(x)$，得到最优吸收剖面作为局部网格间距 $h(x)$ 的函数：\n$$\n\\sigma(x) = \\frac{A_0 \\omega}{N k h(x)}\n$$\n至此，推导完成。我们收集三个要求的结果作为最终答案。\n\n1.  最小化的最坏情况反射振幅：$\\frac{A_0^2}{12N}$\n2.  最优常数比 $r = h(x)/\\ell(x)$：$\\frac{A_0}{N}$\n3.  吸收剖面 $\\sigma(x)$：$\\frac{A_0 \\omega}{N k h(x)}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{A_0^2}{12N}  \\frac{A_0}{N}  \\frac{A_0 \\omega}{N k h(x)}\n\\end{pmatrix}\n}\n$$", "id": "2540247"}]}