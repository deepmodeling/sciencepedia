{"hands_on_practices": [{"introduction": "要理解多物理场耦合中的挑战，首先必须掌握不同物理场之间是如何相互影响的。本练习通过一个经典的流固耦合模型，从第一性原理出发推导“附加质量”效应，揭示了流体惯性如何传递给结构。通过这个实践 [@problem_id:2598435]，您将为理解耦合项建立坚实的物理直觉，而这些耦合项正是决定整体式和交错式求解策略稳定性和准确性的核心。", "problem": "考虑一个一维流固耦合模型，其中位于 $x=0$ 处的刚性无摩擦活塞连接到一个线性弹性结构上，并推动填充在区间 $x \\in [0,L]$ 上横截面积恒为 $A$ 的刚性直管内的无粘性流体。远端 $x=L$ 处开口于一个维持零表压的大型储液池。流体具有均匀密度 $\\rho$，运动仅限于轴向。假设运动是微小的，重力可忽略，且在所关注的时间尺度上流体表现为不可压缩。活塞的位移为 $u_{s}(t)$，根据连续性原理，流体的轴向速度场为 $v(x,t)$。流体对活塞施加的合力等于 $x=0$ 处的压力乘以面积 $A$。\n\n在流固耦合 (FSI) 的有限元法 (FEM) 背景下，众所周知，所谓的附加质量效应控制着交错（分区）解法与整体（全耦合）解法的稳定性。从流体的基本平衡定律（质量守恒和线性动量守恒）以及活塞的牛顿第二定律出发，推导在整体耦合中归因于流体并增大结构惯性的有效附加质量 $m_{a}$。请用流体密度 $\\rho$、管长 $L$ 和横截面积 $A$ 来纯粹地表示 $m_{a}$。\n\n您的推导必须从一维控制平衡方程开始，并通过流体压力分布消去流场，以活塞加速度表示，最终得到 $m_{a}$ 的闭式表达式。请以符号形式提供最终表达式。不要代入数值。不要将中间方程作为最终结果报告。最终答案必须是单一的解析表达式。", "solution": "推导从流体的控制方程开始。\n\n首先，我们考虑质量守恒。对于在横截面积恒为 $A$ 的管道中流动的一维不可压缩流体，其连续性方程为：\n$$ \\frac{\\partial v}{\\partial x} = 0 $$\n其中 $v(x,t)$ 是轴向流体速度。该方程意味着速度 $v$ 不是空间坐标 $x$ 的函数，只能依赖于时间 $t$。我们可以写成 $v(x,t) = v(t)$。\n\n接下来，我们在活塞与流体的界面上应用运动学边界条件。对于小位移运动，此条件应用于活塞的平均位置 $x=0$。此处的流体速度必须与活塞的速度匹配，活塞速度是其位移的时间导数 $\\dot{u}_s(t)$。\n$$ v(0,t) = \\frac{d u_s}{d t} = \\dot{u}_s(t) $$\n将此结果与连续性方程的结果相结合，我们得出结论，整个流体柱的速度在空间上是均匀的，并且等于活塞的速度：\n$$ v(x,t) = \\dot{u}_s(t) \\quad \\text{对于所有 } x \\in [0,L] $$\n\n现在，我们考虑线性动量守恒。对于体积力可忽略（忽略重力）的无粘性流体，一维欧拉动量方程为：\n$$ \\rho \\left( \\frac{\\partial v}{\\partial t} + v \\frac{\\partial v}{\\partial x} \\right) = - \\frac{\\partial p}{\\partial x} $$\n其中 $p(x,t)$ 是流体压力。根据连续性方程，我们知道 $\\frac{\\partial v}{\\partial x} = 0$。动量方程简化为：\n$$ \\rho \\frac{\\partial v}{\\partial t} = - \\frac{\\partial p}{\\partial x} $$\n流体速度的时间导数是流体加速度，它等于活塞的加速度：\n$$ \\frac{\\partial v}{\\partial t} = \\frac{d}{dt} \\left( \\dot{u}_s(t) \\right) = \\ddot{u}_s(t) $$\n将此代入简化的欧拉方程，得到压力梯度与活塞加速度之间的关系：\n$$ \\rho \\ddot{u}_s(t) = - \\frac{\\partial p}{\\partial x} $$\n由于左侧仅是时间的函数，我们可以对该方程关于空间坐标 $x$ 进行积分，以求得压力分布 $p(x,t)$：\n$$ p(x,t) = \\int - \\rho \\ddot{u}_s(t) \\, dx = - \\rho \\ddot{u}_s(t) x + C(t) $$\n其中 $C(t)$ 是一个可能依赖于时间的积分常数。我们通过在 $x=0$ 处计算该表达式来确定 $C(t)$，得到 $C(t) = p(0,t)$。因此，压力分布为：\n$$ p(x,t) = p(0,t) - \\rho x \\ddot{u}_s(t) $$\n这表明沿管长存在由流体惯性驱动的线性压降。\n\n为了确定活塞面上的压力 $p(0,t)$，我们在管出口 $x=L$ 处应用压力边界条件。问题陈述该处的表压为零，因此 $p(L,t) = 0$。将此代入我们的压力分布方程：\n$$ 0 = p(L,t) = p(0,t) - \\rho L \\ddot{u}_s(t) $$\n解出 $p(0,t)$，我们得到：\n$$ p(0,t) = \\rho L \\ddot{u}_s(t) $$\n流体对活塞施加的力 $F_{fluid}$ 是活塞面上的压力乘以面积 $A$。该力作用在负 $x$ 方向，与加速度方向相反。\n$$ F_{fluid}(t) = -p(0,t) A $$\n代入我们对 $p(0,t)$ 的表达式：\n$$ F_{fluid}(t) = - \\left( \\rho L \\ddot{u}_s(t) \\right) A = - (\\rho A L) \\ddot{u}_s(t) $$\n活塞（质量为 $m_s$ 的“结构”）的运动方程形式为 $m_s \\ddot{u}_s(t) + \\dots = F_{fluid}(t)$。在整体公式中，流体力被视为与结构耦合的惯性项。代入 $F_{fluid}(t)$ 的表达式：\n$$ m_s \\ddot{u}_s(t) + \\dots = - (\\rho A L) \\ddot{u}_s(t) $$\n将流体力项移到左侧，得到：\n$$ m_s \\ddot{u}_s(t) + (\\rho A L) \\ddot{u}_s(t) + \\dots = 0 $$\n$$ \\left(m_s + \\rho A L\\right) \\ddot{u}_s(t) + \\dots = 0 $$\n乘以结构加速度 $\\ddot{u}_s(t)$ 的项代表了耦合系统的总有效惯性。项 $\\rho A L$ 是流体的贡献，它增大了结构质量 $m_s$。根据定义，这就是附加质量 $m_a$。\n量 $\\rho A L$ 是管中流体的总质量。这个结果在物理上是正确的：在给定的不可压缩流体和刚性管的假设下，整个流体柱必须像一个单一的刚体一样随活塞一起加速。\n\n因此，有效附加质量是流体的总质量。", "answer": "$$\n\\boxed{\\rho A L}\n$$", "id": "2598435"}, {"introduction": "尽管交错式方案因其实现简单而具有吸引力，但草率的设计可能导致灾难性的失败。本练习作为一个警示案例，通过一个孔隙弹性问题展示了一个简单的交错方案（其中压力场被滞后处理）如何导致完全不符合物理规律的“锁定”现象。这个鲜明的例子 [@problem_id:2598463] 突显了这类方案的一个常见陷阱，并强调了必须精心设计交错格式或利用整体式方法内在的稳健性，以避免此类病态行为。", "problem": "考虑在区间 $[0,1]$ 上的一维线性孔隙弹性（Biot 理论），横截面积 $A=1$。未知量为固体位移 $u(x,t)$ 和孔隙压力 $p(x,t)$。准静态线性动量平衡和流体质量守恒定律分别为：\n- 动量平衡：$\\nabla \\cdot \\sigma' - \\alpha \\nabla p = 0$，其中在一维情况下 $\\sigma' = E \\nabla u$。\n- 流体质量守恒：$s\\,\\dot{p} + \\alpha\\,\\nabla \\cdot \\dot{u} = w$，达西通量为零（不可渗透），因此没有扩散项出现。\n\n这里 $E>0$ 是排水弹性模量，$\\alpha \\in (0,1]$ 是 Biot 系数，$s>0$ 是比储水系数，$w$ 是给定的单位长度体积流体源。\n\n将区域离散为两个长度为 $h=1/2$ 的等长线性有限元。位移采用 $P_1$（连续、分段线性）单元，压力采用 $P_0$（不连续、单元常数）单元，节点位移未知量为 $\\{u_0,u_1,u_2\\}$，单元压力为 $\\{p_1,p_2\\}$。在 $x=1$ 处施加 $u(0,t)=0$（因此 $u_0=0$）和无牵引力边界条件，并取时间 $t^n$ 时的初始条件为 $u^n(x)=0$, $p^n(x)=0$。在下一个时刻 $t^{n+1}=t^n+\\Delta t$，施加一个均匀的流体源 $w^{n+1}=W$（在空间和时间步长上为常数），且没有外部机械牵引力。\n\n采用后向欧拉法进行时间离散化。对于从 $t^n$到 $t^{n+1}$ 的这个单时间步，执行以下操作。\n\n1. 为在 $t^{n+1}$ 时刻的整体求解，建立半离散 $P_1$–$P_0$ 混合系统的矩阵形式：\n   - 位移块 $K$ 来自一维标准 $P_1$ 刚度组装；\n   - 位移-压力耦合通过与弱形式一致的离散散度算子 $B$ 实现；\n   - 存储项为 $P_0$ 压力空间贡献一个与 $s h$ 成正比的对角块；\n   - 源项在压力方程中贡献一个与 $h \\Delta t W$ 成正比的载荷向量。\n\n2. 求解该整体系统，得到右端节点位移 $u^{n+1}_{\\mathrm{mono}} := u_2^{n+1}$，表示为参数 $E$, $\\alpha$, $s$, $\\Delta t$ 和 $W$ 的封闭形式表达式。\n\n3. 考虑一种朴素的交错（分离）格式，该格式首先使用前一时间步的滞后压力求解力学子问题，然后使用新计算出的位移求解质量守恒子问题。对于此格式，在相同数据下，计算同一时间步结束时的右端节点位移 $u^{n+1}_{\\mathrm{stag}} := u_2^{n+1}$。\n\n最后，计算比率\n$$\nR \\;=\\; \\frac{u^{n+1}_{\\mathrm{stag}}}{u^{n+1}_{\\mathrm{mono}}} \\, .\n$$\n给出 $R$ 的精确值作为最终答案。不要将任何数值代入 $E$, $\\alpha$, $s$, $\\Delta t$ 或 $W$。该比率为无量纲，因此不需要单位。你的最终答案必须是单个数字或单个封闭形式的表达式。", "solution": "该问题要求分析一个一维线性孔隙弹性系统，对单个时间步的整体解和交错解进行比较。\n\n首先，我们建立控制方程的弱形式。定义域为区间 $\\Omega = [0,1]$。未知量为固体位移 $u(x,t)$ 和孔隙压力 $p(x,t)$。准静态方程的强形式为：\n动量平衡：$E \\frac{\\partial^2 u}{\\partial x^2} - \\alpha \\frac{\\partial p}{\\partial x} = 0$，对于 $x \\in (0,1)$。\n流体质量守恒：$s \\frac{\\partial p}{\\partial t} + \\alpha \\frac{\\partial^2 u}{\\partial x \\partial t} = w$。\n\n设 $V$ 为位移的检验函数空间，$Q$ 为压力的检验函数空间。我们将动量方程乘以一个检验函数 $v \\in V$ 并在 $\\Omega$ 上积分。\n$\\int_0^1 \\left( E \\frac{\\partial^2 u}{\\partial x^2} \\right) v \\,dx - \\int_0^1 \\left( \\alpha \\frac{\\partial p}{\\partial x} \\right) v \\,dx = 0$。\n分部积分得到：\n$\\left[ E \\frac{\\partial u}{\\partial x} v \\right]_0^1 - \\int_0^1 E \\frac{\\partial u}{\\partial x} \\frac{\\partial v}{\\partial x} \\,dx - \\left[ \\alpha p v \\right]_0^1 + \\int_0^1 \\alpha p \\frac{\\partial v}{\\partial x} \\,dx = 0$。\n边界条件为 $u(0,t)=0$ 和在 $x=1$ 处无牵引力。无牵引力条件意味着总应力 $\\sigma = E \\frac{\\partial u}{\\partial x} - \\alpha p$ 在 $x=1$ 处为零。位移的检验函数必须满足本质边界条件，因此 $v(0)=0$。边界项变为：\n$[ (E \\frac{\\partial u}{\\partial x} - \\alpha p) v ]_0^1 = (E \\frac{\\partial u}{\\partial x}(1) - \\alpha p(1))v(1) - (E \\frac{\\partial u}{\\partial x}(0) - \\alpha p(0))v(0) = 0 \\cdot v(1) - \\dots \\cdot 0 = 0$。\n因此，动量平衡的弱形式为：\n$\\int_0^1 E \\frac{\\partial u}{\\partial x} \\frac{\\partial v}{\\partial x} \\,dx - \\int_0^1 \\alpha p \\frac{\\partial v}{\\partial x} \\,dx = 0$。\n\n对于质量守恒方程，我们乘以一个检验函数 $q \\in Q$ 并在 $\\Omega$ 上积分：\n$\\int_0^1 s \\frac{\\partial p}{\\partial t} q \\,dx + \\int_0^1 \\alpha \\frac{\\partial^2 u}{\\partial x \\partial t} q \\,dx = \\int_0^1 w q \\,dx$。\n\n我们应用后向欧拉法进行时间离散化。对于一个通用函数 $f(t)$，$\\dot{f}(t^{n+1}) \\approx \\frac{f^{n+1}-f^n}{\\Delta t}$。给定初始条件 $u^n=0$ 和 $p^n=0$，以及源项 $w^{n+1}=W$，在时刻 $t^{n+1}$ 的时间离散化弱形式为：\n1. $\\int_0^1 E \\frac{d u^{n+1}}{d x} \\frac{d v}{d x} \\,dx - \\int_0^1 \\alpha p^{n+1} \\frac{d v}{d x} \\,dx = 0$。\n2. $\\int_0^1 \\frac{s}{\\Delta t} p^{n+1} q \\,dx + \\int_0^1 \\frac{\\alpha}{\\Delta t} \\frac{d u^{n+1}}{d x} q \\,dx = \\int_0^1 W q \\,dx$。\n\n空间离散化使用两个长度为 $h=1/2$ 的等长线性单元。位移 $u$ 使用连续分段线性 ($P_1$) 函数逼近，压力 $p$ 使用分段常数 ($P_0$) 函数逼近。节点位移为 $\\{u_0, u_1, u_2\\}$，对应节点 $x_0=0$, $x_1=h$, $x_2=2h=1$。单元压力为 $\\{p_1, p_2\\}$。\n条件 $u(0,t)=0$ 意味着 $u_0=0$。离散未知量为 $\\mathbf{U} = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$ 和 $\\mathbf{P} = \\begin{pmatrix} p_1 \\\\ p_2 \\end{pmatrix}$。\n\n半离散系统可以写成块矩阵形式：\n$$\n\\begin{pmatrix} K  -\\alpha B^T \\\\ \\frac{\\alpha}{\\Delta t} B  \\frac{s}{\\Delta t} M_p \\end{pmatrix}\n\\begin{pmatrix} \\mathbf{U}^{n+1} \\\\ \\mathbf{P}^{n+1} \\end{pmatrix}\n=\n\\begin{pmatrix} \\mathbf{0} \\\\ \\mathbf{F}_W \\end{pmatrix}\n$$\n其中矩阵和向量分量从弱形式导出：\n- 刚度矩阵 $K_{ij} = \\int_0^1 E N'_i N'_j \\,dx$。对于 2 个活动自由度 ($u_1, u_2$)，组装后得到 $K = \\frac{E}{h} \\begin{pmatrix} 2  -1 \\\\ -1  1 \\end{pmatrix}$。\n- 耦合矩阵 $B_{ki} = \\int_0^1 N'_i \\Psi_k \\,dx$。$\\Psi_k$ 是单元 $k$ 上压力的基函数（单元的特征函数）。\n  $B_{11} = \\int_0^h N'_1 \\,dx = \\int_0^h \\frac{1}{h} \\,dx = 1$。\n  $B_{12} = \\int_0^h N'_2 \\,dx = 0$。\n  $B_{21} = \\int_h^{2h} N'_1 \\,dx = \\int_h^{2h} (-\\frac{1}{h}) \\,dx = -1$。\n  $B_{22} = \\int_h^{2h} N'_2 \\,dx = \\int_h^{2h} \\frac{1}{h} \\,dx = 1$。\n  所以，$B = \\begin{pmatrix} 1  0 \\\\ -1  1 \\end{pmatrix}$，且 $B^T = \\begin{pmatrix} 1  -1 \\\\ 0  1 \\end{pmatrix}$。\n- 压力质量矩阵 $(M_p)_{kl} = \\int_0^1 \\Psi_k \\Psi_l \\,dx$。对于 $P_0$ 单元，这是对角矩阵：$M_p = h \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$。\n- 流体源向量 $(\\mathbf{F}_W)_k = \\int_0^1 \\frac{W}{\\Delta t} \\Psi_k \\,dx$。这给出 $\\mathbf{F}_W = \\frac{W h}{\\Delta t} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n将第二个块行乘以 $\\Delta t$，整体系统为：\n$$\n\\begin{pmatrix} K  -\\alpha B^T \\\\ \\alpha B  s M_p \\end{pmatrix}\n\\begin{pmatrix} \\mathbf{U}^{n+1} \\\\ \\mathbf{P}^{n+1} \\end{pmatrix}\n=\n\\begin{pmatrix} \\mathbf{0} \\\\ \\Delta t W h \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\end{pmatrix}\n$$\n代入矩阵和向量：\n$$\n\\begin{pmatrix}\n\\frac{E}{h} \\begin{pmatrix} 2  -1 \\\\ -1  1 \\end{pmatrix}  -\\alpha \\begin{pmatrix} 1  -1 \\\\ 0  1 \\end{pmatrix} \\\\\n\\alpha \\begin{pmatrix} 1  0 \\\\ -1  1 \\end{pmatrix}  sh \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n\\end{pmatrix}\n\\begin{pmatrix} u_1 \\\\ u_2 \\\\ p_1 \\\\ p_2 \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 0 \\\\ \\Delta t W h \\\\ \\Delta t W h \\end{pmatrix}\n$$\n这得到四个线性方程：\n(1) $\\frac{2E}{h} u_1 - \\frac{E}{h} u_2 - \\alpha p_1 + \\alpha p_2 = 0$\n(2) $-\\frac{E}{h} u_1 + \\frac{E}{h} u_2 - \\alpha p_2 = 0$\n(3) $\\alpha u_1 + sh p_1 = \\Delta t W h$\n(4) $-\\alpha u_1 + \\alpha u_2 + sh p_2 = \\Delta t W h$\n\n从 (1) 和 (2) 式：\n(1) 和 (2) 相加：$\\frac{E}{h} u_1 - \\alpha p_1 = 0 \\implies p_1 = \\frac{E}{\\alpha h} u_1$。\n现在将此代入 (3)：$\\alpha u_1 + sh \\left(\\frac{E}{\\alpha h} u_1\\right) = \\Delta t W h \\implies u_1 \\left(\\alpha + \\frac{sE}{\\alpha}\\right) = \\Delta t W h \\implies u_1 \\left(\\frac{\\alpha^2+sE}{\\alpha}\\right) = \\Delta t W h$。\n$u_1 = \\frac{\\alpha \\Delta t W h}{\\alpha^2 + sE}$。\n从 (4) 和 (2) 式，我们可以得到：$(u_2 - u_1)\\left(\\frac{\\alpha^2+sE}{\\alpha}\\right) = \\Delta t W h$。\n$u_2 - u_1 = \\frac{\\alpha \\Delta t W h}{sE + \\alpha^2}$。\n比较 $u_1$ 和 $u_2-u_1$ 的表达式，我们看到 $u_1 = u_2 - u_1$，这意味着 $u_2=2u_1$。\n所以，$u^{n+1}_{\\mathrm{mono}} = u_2^{n+1} = 2u_1 = \\frac{2 \\alpha \\Delta t W h}{sE + \\alpha^2}$。\n\n现在我们分析朴素的交错格式。该格式描述如下：\n1. 使用前一时间步的压力 $\\mathbf{P}^n$ 求解力学子问题以得到 $\\mathbf{U}^{n+1}$。\n2. 使用新计算出的位移 $\\mathbf{U}^{n+1}$ 求解质量守恒子问题以得到 $\\mathbf{P}^{n+1}$。\n\n步骤 1：力学子问题是 $K \\mathbf{U}^{n+1} - \\alpha B^T \\mathbf{P}^n = \\mathbf{0}$。\n初始压力给定为 $p^n(x)=0$，所以 $\\mathbf{P}^n = \\mathbf{0}$。\n方程变为 $K \\mathbf{U}^{n+1} = \\mathbf{0}$。\n对应于无约束自由度的矩阵 $K = \\frac{E}{h} \\begin{pmatrix} 2  -1 \\\\ -1  1 \\end{pmatrix}$ 是可逆的，因为其行列式为 $(\\frac{E}{h})^2(2-1) = \\frac{E^2}{h^2} \\ne 0$。\n$K \\mathbf{U}^{n+1} = \\mathbf{0}$ 的唯一解是 $\\mathbf{U}^{n+1} = \\mathbf{0}$。\n这意味着 $u_1^{n+1} = 0$ 和 $u_2^{n+1} = 0$。\n因此，交错格式的右端位移为 $u^{n+1}_{\\mathrm{stag}} = u_2^{n+1} = 0$。\n\n问题要求计算比率 $R = \\frac{u^{n+1}_{\\mathrm{stag}}}{u^{n+1}_{\\mathrm{mono}}}$。\n我们有 $u^{n+1}_{\\mathrm{stag}} = 0$ 和 $u^{n+1}_{\\mathrm{mono}} = \\frac{2 \\alpha \\Delta t W h}{sE + \\alpha^2}$。\n为确保问题非平凡且比率定义良好，我们假设源项 $W \\ne 0$。所有其他参数（$E, \\alpha, s, \\Delta t, h$）均为正，因此 $u^{n+1}_{\\mathrm{mono}} \\neq 0$。\n因此，比率为：\n$$\nR = \\frac{0}{\\frac{2 \\alpha \\Delta t W h}{sE + \\alpha^2}} = 0\n$$", "answer": "$$\n\\boxed{0}\n$$", "id": "2598463"}, {"introduction": "除了像锁定这样的静态失效模式，交错式方案还可能遭遇破坏长期模拟的动态不稳定性。本练习探讨了一个更微妙但同样关键的问题：松散耦合方案产生的伪能量。通过分析一个简化的热弹性模型 [@problem_id:2598449]，您将量化每个时间步中不符合物理规律的能量增长，并将其与耦合项的时间滞后直接联系起来。这项实践有助于您深刻理解数值稳定性的概念，并认识到在选择求解策略时能量守恒的重要性。", "problem": "考虑一个简化的线性热弹性有限元法 (FEM) 模型，该模型具有代表单一空间模式的单个力学自由度 $u \\in \\mathbb{R}$ 和单个热学自由度 $\\theta \\in \\mathbb{R}$。在任意构型 $(u,\\theta)$ 下的亥姆霍兹自由能为\n$$\n\\Psi(u,\\theta) \\;=\\; \\frac{1}{2}\\,k\\,\\big(u - \\alpha\\,\\theta\\big)^{2} \\;+\\; \\frac{1}{2}\\,\\eta\\,\\theta^{2},\n$$\n其中刚度 $k>0$，热膨胀系数 $\\alpha \\neq 0$，储热系数 $\\eta>0$。热演化遵循线性一阶平衡律\n$$\nM\\,\\dot{\\theta} \\;+\\; L\\,\\theta \\;=\\; 0,\n$$\n其中 $M>0$ 是集总热容，$L>0$ 是集总传导参数。时间离散化采用后向欧拉法，时间步长为 $\\Delta t>0$，因此 $\\theta^{n+1}$ 满足\n$$\n\\frac{M}{\\Delta t}\\,\\big(\\theta^{n+1} - \\theta^{n}\\big) \\;+\\; L\\,\\theta^{n+1} \\;=\\; 0,\n$$\n这等价于 $\\theta^{n+1} \\,=\\, r\\,\\theta^{n}$，其中 $r \\,=\\, \\frac{M}{M + L\\,\\Delta t} \\in (0,1)$。\n\n在从 $t^{n}$ 到 $t^{n+1}$ 的每个时间步长内，考虑两种求解策略：\n\n(a) 整体求解法 (monolithic solve) 同时强制力学平衡和热更新，即 $k\\,(u^{n+1} - \\alpha\\,\\theta^{n+1}) = 0$ 与上述后向欧拉热方程一起求解。\n\n(b) 松耦合交错格式 (loosely coupled staggered scheme) 首先通过后向欧拉法更新温度得到 $\\theta^{n+1}$，然后通过强制 $k\\,(u^{n+1} - \\alpha\\,\\theta^{n}) = 0$ 来更新力学，即进入力学平衡的温度是滞后的。\n\n假设在时间 $t^{n}$ 时的构型相对于当前温度是力学松弛的，即 $u^{n} = \\alpha\\,\\theta^{n}$。定义滞后误差 $\\delta\\theta := \\theta^{n} - \\theta^{n+1}$，只要 $r \\neq 1$，该误差就非零。\n\n仅使用自由能 $\\Psi$ 和给定的离散方程，构建一个具体的反例，证明即使热动力学是耗散的，松耦合交错格式相对于整体格式仍会注入伪能量。通过推导一个精确的闭式表达式来量化每个时间步的伪能量增长\n$$\n\\Delta E_{\\mathrm{spur}} \\;:=\\; \\Psi\\big(u^{n+1}_{\\mathrm{stag}},\\theta^{n+1}\\big) \\;-\\; \\Psi\\big(u^{n+1}_{\\mathrm{mono}},\\theta^{n+1}\\big)\n$$\n用滞后误差 $\\delta\\theta$ 以及参数 $k$ 和 $\\alpha$ 来表示。请将您的最终答案表示为单个符号表达式。不需要数值近似，也不应报告单位。", "solution": "目标是量化每个时间步的伪能量增长，其定义为 $\\Delta E_{\\mathrm{spur}} := \\Psi(u^{n+1}_{\\mathrm{stag}},\\theta^{n+1}) - \\Psi(u^{n+1}_{\\mathrm{mono}},\\theta^{n+1})$。为此，我们必须首先确定每种格式下的状态变量 $(u^{n+1}, \\theta^{n+1})$。\n\n两种格式的热更新是相同的，由后向欧拉离散化给出：\n$$\n\\frac{M}{\\Delta t}\\,(\\theta^{n+1} - \\theta^{n}) + L\\,\\theta^{n+1} = 0\n$$\n这得到 $\\theta^{n+1} = r\\,\\theta^{n}$，其中 $r = \\frac{M}{M + L\\,\\Delta t}$。由于 $M > 0$，$L > 0$ 且 $\\Delta t > 0$，因此 $r \\in (0,1)$。\n\n首先，考虑整体求解策略。力学方程和热方程被同时求解。力学平衡方程在时间 $t^{n+1}$ 时强制执行，使用同时计算出的温度 $\\theta^{n+1}$：\n$$\nk\\,(u^{n+1}_{\\mathrm{mono}} - \\alpha\\,\\theta^{n+1}) = 0\n$$\n鉴于刚度 $k > 0$，这意味着整体格式的力学自由度为：\n$$\nu^{n+1}_{\\mathrm{mono}} = \\alpha\\,\\theta^{n+1}\n$$\n这个结果在物理上对应于相对于最终温度 $\\theta^{n+1}$ 的力学松弛状态。\n\n接下来，考虑松耦合交错求解策略。在热更新提供 $\\theta^{n+1}$ 之后，使用来自时间 $t^{n}$ 的滞后温度来强制执行力学平衡：\n$$\nk\\,(u^{n+1}_{\\mathrm{stag}} - \\alpha\\,\\theta^{n}) = 0\n$$\n同样，由于 $k > 0$，这意味着：\n$$\nu^{n+1}_{\\mathrm{stag}} = \\alpha\\,\\theta^{n}\n$$\n这表明力学状态与最终温度 $\\theta^{n+1}$ 处于非平衡状态，而是相对于初始温度 $\\theta^n$ 处于松弛状态。\n\n现在我们为两种最终状态计算亥姆霍兹自由能 $\\Psi(u,\\theta) = \\frac{1}{2}\\,k\\,(u - \\alpha\\,\\theta)^{2} + \\frac{1}{2}\\,\\eta\\,\\theta^{2}$。在这两种情况下，热自由度均为 $\\theta^{n+1}$。\n\n对于整体格式，最终状态是 $(u^{n+1}_{\\mathrm{mono}}, \\theta^{n+1})$。其自由能为：\n$$\n\\Psi(u^{n+1}_{\\mathrm{mono}},\\theta^{n+1}) = \\Psi(\\alpha\\,\\theta^{n+1}, \\theta^{n+1}) = \\frac{1}{2}\\,k\\,(\\alpha\\,\\theta^{n+1} - \\alpha\\,\\theta^{n+1})^{2} + \\frac{1}{2}\\,\\eta\\,(\\theta^{n+1})^{2}\n$$\n第一项消失，得到：\n$$\n\\Psi(u^{n+1}_{\\mathrm{mono}},\\theta^{n+1}) = \\frac{1}{2}\\,\\eta\\,(\\theta^{n+1})^{2}\n$$\n这代表了系统在温度 $\\theta^{n+1}$ 下完全力学松弛时的能量。\n\n对于交错格式，最终状态是 $(u^{n+1}_{\\mathrm{stag}}, \\theta^{n+1})$。其自由能为：\n$$\n\\Psi(u^{n+1}_{\\mathrm{stag}},\\theta^{n+1}) = \\Psi(\\alpha\\,\\theta^{n}, \\theta^{n+1}) = \\frac{1}{2}\\,k\\,(\\alpha\\,\\theta^{n} - \\alpha\\,\\theta^{n+1})^{2} + \\frac{1}{2}\\,\\eta\\,(\\theta^{n+1})^{2}\n$$\n该状态同时包含力学应变能（由于滞后）和热能。\n\n现在我们可以通过求差来计算伪能量增长 $\\Delta E_{\\mathrm{spur}}$：\n$$\n\\Delta E_{\\mathrm{spur}} = \\Psi(u^{n+1}_{\\mathrm{stag}},\\theta^{n+1}) - \\Psi(u^{n+1}_{\\mathrm{mono}},\\theta^{n+1})\n$$\n$$\n\\Delta E_{\\mathrm{spur}} = \\left[ \\frac{1}{2}\\,k\\,(\\alpha\\,\\theta^{n} - \\alpha\\,\\theta^{n+1})^{2} + \\frac{1}{2}\\,\\eta\\,(\\theta^{n+1})^{2} \\right] - \\left[ \\frac{1}{2}\\,\\eta\\,(\\theta^{n+1})^{2} \\right]\n$$\n热能项 $\\frac{1}{2}\\,\\eta\\,(\\theta^{n+1})^{2}$相互抵消，剩下：\n$$\n\\Delta E_{\\mathrm{spur}} = \\frac{1}{2}\\,k\\,(\\alpha\\,\\theta^{n} - \\alpha\\,\\theta^{n+1})^{2}\n$$\n问题要求用滞后误差 $\\delta\\theta := \\theta^{n} - \\theta^{n+1}$ 来表示这个表达式。我们可以从平方项中提出因子 $\\alpha$：\n$$\n\\Delta E_{\\mathrm{spur}} = \\frac{1}{2}\\,k\\,\\alpha^{2}\\,(\\theta^{n} - \\theta^{n+1})^{2}\n$$\n代入 $\\delta\\theta$ 的定义：\n$$\n\\Delta E_{\\mathrm{spur}} = \\frac{1}{2}\\,k\\,\\alpha^{2}\\,(\\delta\\theta)^{2}\n$$\n由于 $k > 0$ 且 $\\alpha \\neq 0$，项 $\\frac{1}{2}\\,k\\,\\alpha^{2}$ 是严格为正的。项 $(\\delta\\theta)^{2}$ 是非负的。对于任何 $\\theta^{n} \\neq \\theta^{n+1}$ 的非平凡热演化，我们有 $\\delta\\theta \\neq 0$，因此 $\\Delta E_{\\mathrm{spur}} > 0$。这表明，尽管底层的热物理过程是耗散的，但由于耦合项中的时间滞后，交错格式在每个时间步都会向系统中虚假地注入力学能。这种非物理的能量增长是此类显式耦合格式的一个众所周知的伪影，并可能导致数值不稳定性。相比之下，整体格式正确地找到了给定温度下的最小能量状态，因此在这方面是无条件稳定的。", "answer": "$$\n\\boxed{\\frac{1}{2}\\,k\\,\\alpha^{2}\\,(\\delta\\theta)^{2}}\n$$", "id": "2598449"}]}