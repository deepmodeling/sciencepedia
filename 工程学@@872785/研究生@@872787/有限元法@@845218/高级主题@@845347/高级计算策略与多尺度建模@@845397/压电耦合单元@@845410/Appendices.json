{"hands_on_practices": [{"introduction": "有限元方法的基础在于将连续的物理问题离散化为代数方程组。本练习将通过计算单元刚度矩阵中的一个特定分量，让您直接体验这一基本过程，从而弥合连续介质理论与其数值实现之间的鸿沟。您将学习如何利用数值积分（高斯求积）将材料属性和单元几何形状结合起来，从而构建出压电耦合单元的核心——单元矩阵。", "problem": "一个处于平面应力状态的二维压电固体被一个四节点的双线性四边形有限元离散化。该单元占据一个矩形区域，其节点坐标（单位：米）为：节点1位于$(0,0)$，节点2位于$(0.02,0)$，节点3位于$(0.02,0.01)$，节点4位于$(0,0.01)$。单元厚度为 $h=0.001\\,\\text{m}$。假设对机械位移场 $(u,v)$ 和电势 $\\phi$ 采用等参双线性插值，并使用 $2\\times 2$ 高斯积分，其标准自然坐标为 $(\\xi,\\eta)\\in\\{\\pm 1/\\sqrt{3}\\}\\times\\{\\pm 1/\\sqrt{3}\\}$，每个高斯点的权重均为单位权重。\n\n对于压电介质，其应力-电荷形式的本构方程为\n$$\n\\sigma = \\mathbf{c}^{E}\\,\\epsilon - \\mathbf{e}^{\\top} E, \n\\qquad \nD = \\mathbf{e}\\,\\epsilon + \\boldsymbol{\\varepsilon}^{S} E,\n$$\n其中，$\\sigma$ 和 $\\epsilon$ 分别是平面应力下的 Cauchy 应力和 Voigt 形式的小应变向量，$E$ 是面内电场向量，$D$ 是面内电位移向量，$\\mathbf{c}^{E}$ 是恒定电场下的弹性刚度，$\\mathbf{e}$ 是压电应力矩阵，$\\boldsymbol{\\varepsilon}^{S}$ 是恒定应变下的介电常数。在平面应力条件下，弹性刚度是各向同性的，其杨氏模量 $E_{Y}=60\\times 10^{9}\\,\\text{Pa}$，泊松比 $\\nu=0.30$。压电耦合是面内横向各向同性的，其表达式为\n$$\n\\mathbf{e}=\n\\begin{pmatrix}\n-6.0  2.0  0\\\\\n2.0  -6.0  0\n\\end{pmatrix}\\,\\text{C}\\,\\text{m}^{-2},\n$$\n且介电常数是面内各向同性的，其表达式为\n$$\n\\boldsymbol{\\varepsilon}^{S}=\\begin{pmatrix}\n\\varepsilon  0\\\\\n0  \\varepsilon\n\\end{pmatrix}, \n\\qquad \\varepsilon=1.33\\times 10^{-8}\\,\\text{F}\\,\\text{m}^{-1}.\n$$\n\n从线性压电性的总内能密度和有限元法（FEM）的标准弱形式出发，推导该四节点双线性四边形单元的机械刚度子矩阵、机电耦合子矩阵和电刚度子矩阵的显式单元被积函数，并用应变-位移矩阵 $\\mathbf{B}$、电场-电势梯度算子和材料矩阵表示。\n\n然后，使用 $2\\times 2$ 高斯法则，对给定单元，数值计算电刚度子矩阵中对应于节点1与自身相互作用的项，即 $K_{\\phi\\phi}(1,1)$。将您的答案四舍五入至四位有效数字。最终结果以法拉（Farads）为单位表示。", "solution": "对问题陈述进行验证。\n\n逐字提取给定条件。\n1.  **单元类型**：一个四节点的双线性四边形有限元。\n2.  **单元几何**：节点坐标（单位：米）为节点1位于$(0,0)$，节点2位于$(0.02,0)$，节点3位于$(0.02,0.01)$，节点4位于$(0,0.01)$。\n3.  **单元厚度**：$h=0.001\\,\\text{m}$。\n4.  **插值**：对机械位移 $(u,v)$ 和电势 $\\phi$ 采用等参双线性插值。\n5.  **数值积分**：$2\\times 2$ 高斯积分，自然坐标为 $(\\xi,\\eta)\\in\\{\\pm 1/\\sqrt{3}\\}\\times\\{\\pm 1/\\sqrt{3}\\}$，权重为单位权重。\n6.  **本构方程**：\n    $$\n    \\sigma = \\mathbf{c}^{E}\\,\\epsilon - \\mathbf{e}^{\\top} E,\n    \\qquad\n    D = \\mathbf{e}\\,\\epsilon + \\boldsymbol{\\varepsilon}^{S} E\n    $$\n7.  **材料属性**：\n    -   **机械**：平面应力，各向同性，杨氏模量 $E_{Y}=60\\times 10^{9}\\,\\text{Pa}$，泊松比 $\\nu=0.30$。\n    -   **压电**：面内横向各向同性耦合矩阵 $\\mathbf{e}=\\begin{pmatrix} -6.0  2.0  0\\\\ 2.0  -6.0  0 \\end{pmatrix}\\,\\text{C}\\,\\text{m}^{-2}$。\n    -   **介电**：面内各向同性介电常数 $\\boldsymbol{\\varepsilon}^{S}=\\begin{pmatrix} \\varepsilon  0\\\\ 0  \\varepsilon \\end{pmatrix}$，其中 $\\varepsilon=1.33\\times 10^{-8}\\,\\text{F}\\,\\text{m}^{-1}$。\n\n该问题是**有效的**。这是一个计算固体力学中的标准、适定的问题，具体涉及压电材料的有限元分析。其前提基于线性压电理论和连续介质力学，在科学上是有根据的。所有必要的数据和条件均已提供，且不存在矛盾或含糊之处。任务定义明确，且在计算上是可行的。\n\n解题过程如下。\n\n耦合机电问题的弱形式由虚功原理推导得出。内力的虚功由 $\\delta W_{\\text{int}} = \\int_V (\\delta\\epsilon^T \\sigma - \\delta E^T D) \\, dV$ 给出。将 $\\delta W_{\\text{int}}$ 设为等于外加载荷所做的虚功，即可得到控制积分方程。代入本构关系和离散场近似，即可得到单元矩阵系统。\n\n设单元位移向量为 $\\mathbf{d}^e = \\{u_1, v_1, u_2, v_2, u_3, v_3, u_4, v_4\\}^T$，单元电势向量为 $\\boldsymbol{\\phi}^e = \\{\\phi_1, \\phi_2, \\phi_3, \\phi_4\\}^T$。\n在单元内部，位移场和电势使用双线性形函数 $N_i(\\xi, \\eta)$ 进行插值：\n$$\n\\mathbf{u}(x,y) = \\sum_{i=1}^4 N_i \\begin{pmatrix} u_i \\\\ v_i \\end{pmatrix}, \\qquad \\phi(x,y) = \\sum_{i=1}^4 N_i \\phi_i\n$$\n应变向量 $\\epsilon = \\{\\epsilon_{xx}, \\epsilon_{yy}, 2\\epsilon_{xy}\\}^T$ 通过应变-位移矩阵 $\\mathbf{B}_u$ 与节点位移相关联：\n$$\n\\epsilon = \\sum_{i=1}^4 \\mathbf{B}_{u,i} \\begin{pmatrix} u_i \\\\ v_i \\end{pmatrix} = \\mathbf{B}_u \\mathbf{d}^e, \\quad \\text{其中} \\quad \\mathbf{B}_{u,i} = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x}  0 \\\\ 0  \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y}  \\frac{\\partial N_i}{\\partial x} \\end{pmatrix}\n$$\n电场向量 $E = \\{E_x, E_y\\}^T$ 通过电场-电势梯度算子（此处记为 $\\mathbf{B}_\\phi$）与节点电势相关联：\n$$\nE = -\\nabla\\phi = -\\sum_{i=1}^4 \\nabla N_i \\phi_i = -\\mathbf{B}_\\phi \\boldsymbol{\\phi}^e, \\quad \\text{其中} \\quad \\mathbf{B}_{\\phi,i} = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix}\n$$\n$\\mathbf{B}_u$ 是一个 $3 \\times 8$ 矩阵，$\\mathbf{B}_\\phi$ 是一个 $2 \\times 4$ 矩阵。\n\n将这些代入弱形式，得到单元线性系统：\n$$\n\\begin{pmatrix} \\mathbf{K}_{uu}  \\mathbf{K}_{u\\phi} \\\\ \\mathbf{K}_{\\phi u}  \\mathbf{K}_{\\phi\\phi} \\end{pmatrix}\n\\begin{pmatrix} \\mathbf{d}^e \\\\ \\boldsymbol{\\phi}^e \\end{pmatrix}\n=\n\\begin{pmatrix} \\mathbf{F}_{\\text{mech}} \\\\ \\mathbf{F}_{\\text{elec}} \\end{pmatrix}\n$$\n子矩阵由单元体积 $V$ 上的积分定义。这完成了问题的第一部分。被积函数如下：\n-   机械刚度：$\\mathbf{K}_{uu} = \\int_V \\mathbf{B}_u^T \\mathbf{c}^E \\mathbf{B}_u \\, dV$。被积函数为 $\\mathbf{B}_u^T \\mathbf{c}^E \\mathbf{B}_u$。\n-   压电耦合：$\\mathbf{K}_{u\\phi} = \\int_V \\mathbf{B}_u^T \\mathbf{e}^T \\mathbf{B}_\\phi \\, dV$。被积函数为 $\\mathbf{B}_u^T \\mathbf{e}^T \\mathbf{B}_\\phi$。且 $\\mathbf{K}_{\\phi u} = \\mathbf{K}_{u\\phi}^T$。\n-   电刚度：$\\mathbf{K}_{\\phi\\phi} = \\int_V \\mathbf{B}_\\phi^T \\boldsymbol{\\varepsilon}^S \\mathbf{B}_\\phi \\, dV$。被积函数为 $\\mathbf{B}_\\phi^T \\boldsymbol{\\varepsilon}^S \\mathbf{B}_\\phi$。注意，系统组装存在不同的符号约定；这里我们定义的是矩阵块本身，它是正定的。\n\n现在，我们计算项 $K_{\\phi\\phi}(1,1)$。电刚度矩阵的 $(i,j)$ 块由以下公式给出：\n$$\nK_{\\phi\\phi, ij} = \\int_V \\mathbf{B}_{\\phi,i}^T \\boldsymbol{\\varepsilon}^S \\mathbf{B}_{\\phi,j} \\, dV\n$$\n当 $i=j=1$ 时，我们有：\n$$\nK_{\\phi\\phi}(1,1) = \\int_V \\mathbf{B}_{\\phi,1}^T \\boldsymbol{\\varepsilon}^S \\mathbf{B}_{\\phi,1} \\, dV = h \\int_A \\mathbf{B}_{\\phi,1}^T \\boldsymbol{\\varepsilon}^S \\mathbf{B}_{\\phi,1} \\, dA\n$$\n该积分被变换到自然坐标系 $(\\xi, \\eta)$：\n$$\nK_{\\phi\\phi}(1,1) = h \\int_{-1}^{1} \\int_{-1}^{1} \\mathbf{B}_{\\phi,1}(\\xi, \\eta)^T \\boldsymbol{\\varepsilon}^S \\mathbf{B}_{\\phi,1}(\\xi, \\eta) \\det(\\mathbf{J}) \\, d\\xi d\\eta\n$$\n该单元是由节点 $(0,0)$、$(0.02,0)$、$(0.02,0.01)$ 和 $(0,0.01)$ 定义的矩形。从自然坐标 $(\\xi, \\eta)$ 到物理坐标 $(x,y)$ 的等参映射给出了雅可比矩阵 $\\mathbf{J}$：\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} 0.01  0 \\\\ 0  0.005 \\end{pmatrix}\n$$\n对于矩形单元，雅可比矩阵是常数。其行列式为 $\\det(\\mathbf{J}) = 0.01 \\times 0.005 = 5 \\times 10^{-5} \\, \\text{m}^2$。\n形函数在物理坐标系下的导数可以通过雅可比矩阵的逆矩阵求得：\n$$\n\\mathbf{B}_{\\phi,i} = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} = \\mathbf{J}^{-T} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} 100  0 \\\\ 0  200 \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{pmatrix}\n$$\n对于节点1，其形函数为 $N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$。其导数为：\n$$\n\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta), \\qquad \\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi)\n$$\n因此，节点1的梯度向量为：\n$$\n\\mathbf{B}_{\\phi,1} = \\begin{pmatrix} 100 \\left(-\\frac{1}{4}(1-\\eta)\\right) \\\\ 200 \\left(-\\frac{1}{4}(1-\\xi)\\right) \\end{pmatrix} = \\begin{pmatrix} -25(1-\\eta) \\\\ -50(1-\\xi) \\end{pmatrix}\n$$\n被积函数为 $I(\\xi, \\eta) = \\mathbf{B}_{\\phi,1}^T \\boldsymbol{\\varepsilon}^S \\mathbf{B}_{\\phi,1}$。由于 $\\boldsymbol{\\varepsilon}^S = \\varepsilon \\mathbf{I}$，上式变为：\n$$\nI(\\xi, \\eta) = \\varepsilon \\left( \\left(-25(1-\\eta)\\right)^2 + \\left(-50(1-\\xi)\\right)^2 \\right) = \\varepsilon \\left( 625(1-\\eta)^2 + 2500(1-\\xi)^2 \\right)\n$$\n该积分使用 $2 \\times 2$ 高斯求积法进行计算。四个高斯点为 $(\\xi_k, \\eta_k) = (\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$，权重均为 $w_k=1$。令 $a = 1/\\sqrt{3}$。\n$$\nK_{\\phi\\phi}(1,1) = h \\det(\\mathbf{J}) \\sum_{k=1}^4 w_k I(\\xi_k, \\eta_k) = h \\det(\\mathbf{J}) \\left[ I(-a, -a) + I(a, -a) + I(a, a) + I(-a, a) \\right]\n$$\n被积函数值的总和为：\n$$\n\\sum_{k=1}^4 I(\\xi_k, \\eta_k) = \\varepsilon \\left[ 625 \\sum (1-\\eta_k)^2 + 2500 \\sum (1-\\xi_k)^2 \\right]\n$$\n$(1-\\eta_k)^2$ 的值为 $\\{(1+a)^2, (1+a)^2, (1-a)^2, (1-a)^2\\}$。\n$(1-\\xi_k)^2$ 的值为 $\\{(1+a)^2, (1-a)^2, (1-a)^2, (1+a)^2\\}$。\n两项的和是相同的：$2(1+a)^2 + 2(1-a)^2 = 2(1+2a+a^2 + 1-2a+a^2) = 4(1+a^2)$。\n当 $a^2 = 1/3$ 时，和的值为 $4(1+1/3) = 16/3$。\n$$\n\\sum_{k=1}^4 I(\\xi_k, \\eta_k) = \\varepsilon \\left[ 625 \\left(\\frac{16}{3}\\right) + 2500 \\left(\\frac{16}{3}\\right) \\right] = \\varepsilon (3125) \\left(\\frac{16}{3}\\right) = \\varepsilon \\frac{50000}{3}\n$$\n现在，代入数值：\n$h = 0.001 \\, \\text{m}$\n$\\det(\\mathbf{J}) = 5 \\times 10^{-5} \\, \\text{m}^2$\n$\\varepsilon = 1.33 \\times 10^{-8} \\, \\text{F/m}$\n$$\nK_{\\phi\\phi}(1,1) = (10^{-3}) \\times (5 \\times 10^{-5}) \\times \\left( (1.33 \\times 10^{-8}) \\frac{50000}{3} \\right)\n$$\n$$\nK_{\\phi\\phi}(1,1) = (5 \\times 10^{-8}) \\times (1.33 \\times 10^{-8}) \\times \\left(\\frac{5}{3} \\times 10^4\\right)\n$$\n$$\nK_{\\phi\\phi}(1,1) = \\frac{5 \\times 1.33 \\times 5}{3} \\times 10^{-8-8+4} = \\frac{33.25}{3} \\times 10^{-12} \\approx 11.0833... \\times 10^{-12} \\, \\text{F}\n$$\n转换为标准科学记数法并四舍五入至四位有效数字：\n$$\nK_{\\phi\\phi}(1,1) \\approx 1.108 \\times 10^{-11} \\, \\text{F}\n$$", "answer": "$$\\boxed{1.108 \\times 10^{-11}}$$", "id": "2587393"}, {"introduction": "在构建单元矩阵之后，下一步是组装它们并施加实际的边界条件。虽然简单的固定电压或固定位移条件很容易处理，但许多实际设备（如传感器）具有未连接到外部电压源的“浮动”电极。本实践将演示如何对这种开路条件进行建模，这是精确模拟真实世界压电器件的一项关键技术。", "problem": "一个线性压电固体占据一个有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^3$，其边界为 $\\Gamma = \\Gamma_{t} \\cup \\Gamma_{u} \\cup \\Gamma_{e} \\cup \\Gamma_{q}$，其中 $\\Gamma_{e}$ 是被理想导电电极覆盖的表面，$\\Gamma_{u}$ 是指定位移 $\\boldsymbol{u}$ 的边界，$\\Gamma_{t}$ 是施加面力 $\\bar{\\boldsymbol{t}}$ 的边界，$\\Gamma_{q}$ 是可能指定自由表面电荷密度 $\\bar{\\omega}$ 的边界。准静态控制方程是线动量平衡和高斯定律，\n$\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$ (在 $\\Omega$ 内) 和 $\\nabla \\cdot \\boldsymbol{D} = \\rho_f$ (在 $\\Omega$ 内)，运动学关系为 $\\boldsymbol{S} = \\mathrm{sym}\\,\\nabla \\boldsymbol{u}$ 和 $\\boldsymbol{E} = -\\nabla \\phi$，线性压电本构方程为\n$\\boldsymbol{\\sigma} = \\mathbb{c}^E \\boldsymbol{S} - \\mathbf{e}^\\top \\boldsymbol{E}$ 和 $\\boldsymbol{D} = \\mathbf{e}\\,\\boldsymbol{S} + \\boldsymbol{\\varepsilon}^S \\boldsymbol{E}$。\n这里 $\\mathbb{c}^E$ 是恒定电场下的弹性刚度，$\\mathbf{e}$ 是压电耦合张量（矩阵形式），$\\boldsymbol{\\varepsilon}^S$ 是恒定应变下的介电常数。在一个理想电极上，电势在空间上是均匀的（等势），但对于一个未连接到外部电路的浮动开路电极，其电极电势不是先验给定的。\n\n您的目标是在有限元方法 (FEM) 框架内，确定在 $\\Gamma_{e}$ 上的浮动开路电极的正确建模方式，使其未知电势作为耦合问题的一部分被求解。具体来说，该建模必须：\n- 强制电极为等势体，其未知标量电势为 $\\psi_e$ 待求，并且\n- 通过强制电极上的总自由电荷为零来施加开路条件。\n\n下列哪个陈述正确地阐述了开路条件以及求解浮动电极电势的相关全局约束？\n\nA. 通过在 $\\Gamma_{e}$ 上设置 $\\phi = \\psi_e$ 来强制等势性，其中 $\\psi_e$ 是一个额外的未知标量。施加开路条件作为全局约束，即电极上的净自由电荷消失，\n$$\n\\int_{\\Gamma_{e}} \\boldsymbol{n} \\cdot \\boldsymbol{D}\\, \\mathrm{d}\\Gamma \\;=\\; \\int_{\\Gamma_{e}} \\boldsymbol{n} \\cdot \\big(\\mathbf{e}\\,\\boldsymbol{S} - \\boldsymbol{\\varepsilon}^S \\nabla \\phi\\big)\\, \\mathrm{d}\\Gamma \\;=\\; 0,\n$$\n作为一个额外的方程附加到全局有限元系统中，从而使 $\\psi_e$ 与机械位移和电势一起被确定。\n\nB. 通过在 $\\Gamma_{e}$ 上规定 $\\boldsymbol{n} \\cdot \\boldsymbol{D} = 0$ 来逐点施加开路条件，并通过在 $\\Gamma_{e}$ 上规定 $\\phi = 0$ 来消除浮动电势，因为开路会阻止任何法向电通量。\n\nC. 用电势的积分条件 $\\int_{\\Gamma_{e}} \\phi\\, \\mathrm{d}\\Gamma = 0$ 替换电荷平衡，因为开路不允许电流流过，因此电极的平均电势必须为零，同时在域内保留标准的高斯定律。\n\nD. 假设在 $\\Gamma_{e}$ 上 $\\phi = \\psi_e$，其中 $\\psi_e$ 未知，但通过在电荷平衡中忽略压电耦合来近似开路条件，并施加\n$$\n\\int_{\\Gamma_{e}} \\boldsymbol{n} \\cdot \\big(\\boldsymbol{\\varepsilon}^S \\nabla \\phi\\big)\\, \\mathrm{d}\\Gamma \\;=\\; 0,\n$$\n因为在线性电介质中，机械场不影响电极的净电荷。\n\nE. 强制等势性，其中 $\\psi_e$ 未知，并在电极上施加一个基于场的约束\n$$\n\\int_{\\Gamma_{e}} \\boldsymbol{n} \\cdot \\boldsymbol{E}\\, \\mathrm{d}\\Gamma \\;=\\; 0,\n$$\n理由是外部电流的缺失意味着通过电极的净电场通量为零，这决定了 $\\psi_e$。", "solution": "该问题要求在线性压电材料的有限元方法 (FEM) 框架内，为浮动开路电极找到正确的边界条件提法。我将首先验证问题陈述，然后进行严谨的推导以得出正确的提法。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **域：** 有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^3$。\n- **边界：** $\\Gamma = \\Gamma_{t} \\cup \\Gamma_{u} \\cup \\Gamma_{e} \\cup \\Gamma_{q}$。\n- **边界作用：** $\\Gamma_{u}$ 用于指定位移 $\\boldsymbol{u}$，$\\Gamma_{t}$ 用于指定面力 $\\bar{\\boldsymbol{t}}$，$\\Gamma_{q}$ 用于指定表面电荷密度 $\\bar{\\omega}$，$\\Gamma_{e}$ 用于理想导电电极。\n- **控制方程（准静态）：**\n  - $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$ 在 $\\Omega$ 内（线动量平衡）。\n  - $\\nabla \\cdot \\boldsymbol{D} = \\rho_f$ 在 $\\Omega$ 内（高斯定律）。\n- **运动学关系：**\n  - $\\boldsymbol{S} = \\mathrm{sym}\\,\\nabla \\boldsymbol{u}$（应变-位移）。\n  - $\\boldsymbol{E} = -\\nabla \\phi$（电场-电势）。\n- **本构方程（线性压电）：**\n  - $\\boldsymbol{\\sigma} = \\mathbb{c}^E \\boldsymbol{S} - \\mathbf{e}^\\top \\boldsymbol{E}$（应力-应变-场关系）。\n  - $\\boldsymbol{D} = \\mathbf{e}\\,\\boldsymbol{S} + \\boldsymbol{\\varepsilon}^S \\boldsymbol{E}$（位移-应变-场关系）。\n- **问题细节：** 在 $\\Gamma_{e}$ 上的浮动开路电极。\n- **建模目标/要求：**\n  1. 强制等势性，其未知标量电势为 $\\psi_e$。\n  2. 施加开路条件，即电极上的总自由电荷为零。\n\n**步骤 2：使用提取的已知条件进行验证**\n问题陈述是准静态线性压电理论的标准表述。控制方程、运动学关系和本构定律是正确的，并在连续介质力学和电磁学中被普遍接受。浮动电极的概念在压电器件建模（例如传感器）中是一个定义明确且具有物理意义的场景。该问题是自洽的、有科学依据的、且适定的。它没有歧义、矛盾或过于简单。它针对如何在数值方法中实现一个特定的、具有物理意义的边界条件提出了一个明确的问题。\n\n**步骤 3：结论与行动**\n问题陈述是**有效**的。我将继续进行推导和评估。\n\n### 正确提法的推导\n\n如目标所述，浮动开路电极的建模需要满足两个物理条件。\n\n1.  **等势面**：根据定义，理想导电电极必须是一个等势面。由于电极是“浮动”的，其电势不是预先设定的，而是问题的一个未知数。我们用 $\\psi_e$ 表示这个均匀的、未知的电势。这对电极表面 $\\Gamma_e$ 上所有点 $\\boldsymbol{x}$ 的电势场 $\\phi(\\boldsymbol{x})$ 施加了一个约束：\n    $$\n    \\phi(\\boldsymbol{x}) = \\psi_e \\quad \\forall \\boldsymbol{x} \\in \\Gamma_e\n    $$\n    在有限元方法的背景下，这是一个多点约束，其中 $\\Gamma_e$ 上所有节点的电势自由度都与一个单一的、新的全局自由度 $\\psi_e$ 绑定。\n\n2.  **开路条件**：“开路”条件意味着电极是电隔离的；它没有连接到任何可以提供或吸收电荷的外部电路。因此，电极上的净自由电荷必须为零。\n\n    根据麦克斯韦方程组，特别是电介质中的高斯定律，材料边界上的自由表面电荷密度 $\\omega$ 由电位移场 $\\boldsymbol{D}$ 的法向分量给出。\n    $$\n    \\omega = \\boldsymbol{n} \\cdot \\boldsymbol{D}\n    $$\n    其中 $\\boldsymbol{n}$ 是指向表面 $\\Gamma_e$ 外部的单位法向量。电极上的总自由电荷 $Q_e$ 是该表面密度在电极面积上的积分：\n    $$\n    Q_e = \\int_{\\Gamma_e} \\omega \\, \\mathrm{d}\\Gamma = \\int_{\\Gamma_e} \\boldsymbol{n} \\cdot \\boldsymbol{D} \\, \\mathrm{d}\\Gamma\n    $$\n    因此，开路条件 $Q_e = 0$ 转化为以下积分约束：\n    $$\n    \\int_{\\Gamma_e} \\boldsymbol{n} \\cdot \\boldsymbol{D} \\, \\mathrm{d}\\Gamma = 0\n    $$\n    这是一个全局约束，而不是逐点约束。局部电荷密度 $\\boldsymbol{n} \\cdot \\boldsymbol{D}$ 在电极上的某些点可以不为零，但电荷必须重新分布以使整个电极上的总和为零。\n\n    为了完成这个提法，我们代入 $\\boldsymbol{D}$ 的本构关系：\n    $$\n    \\boldsymbol{D} = \\mathbf{e}\\,\\boldsymbol{S} + \\boldsymbol{\\varepsilon}^S \\boldsymbol{E} = \\mathbf{e}\\,\\boldsymbol{S} - \\boldsymbol{\\varepsilon}^S \\nabla \\phi\n    $$\n    这得到了约束方程的最终形式：\n    $$\n    \\int_{\\Gamma_e} \\boldsymbol{n} \\cdot \\left(\\mathbf{e}\\,\\boldsymbol{S} - \\boldsymbol{\\varepsilon}^S \\nabla \\phi\\right) \\, \\mathrm{d}\\Gamma = 0\n    $$\n\n这个新方程被附加到有限元方程的全局系统中。由于我们引入了一个新的未知数 $\\psi_e$，我们正好需要一个额外的方程。这个积分约束提供了该方程，从而可以唯一地求解包括 $\\psi_e$ 在内的完全耦合系统。\n\n### 选项评估\n\n**A. 通过在 $\\Gamma_{e}$ 上设置 $\\phi = \\psi_e$ 来强制等势性，其中 $\\psi_e$ 是一个额外的未知标量。施加开路条件作为全局约束，即电极上的净自由电荷消失， $$ \\int_{\\Gamma_{e}} \\boldsymbol{n} \\cdot \\boldsymbol{D}\\, \\mathrm{d}\\Gamma \\;=\\; \\int_{\\Gamma_{e}} \\boldsymbol{n} \\cdot \\big(\\mathbf{e}\\,\\boldsymbol{S} - \\boldsymbol{\\varepsilon}^S \\nabla \\phi\\big)\\, \\mathrm{d}\\Gamma \\;=\\; 0, $$ 作为一个额外的方程附加到全局有限元系统中，从而使 $\\psi_e$ 与机械位移和电势一起被确定。**\n-   **分析**：该陈述与推导完全匹配。它正确地用一个未知数 $\\psi_e$ 强制了等势性。它正确地将开路条件确定为总自由电荷为零，将其表述为 $\\boldsymbol{n} \\cdot \\boldsymbol{D}$ 在 $\\Gamma_e$ 上的积分，并使用给定的本构定律正确展开了 $\\boldsymbol{D}$。这个方程为求解 $\\psi_e$ 提供了必要的约束。\n-   **结论**：**正确**。\n\n**B. 通过在 $\\Gamma_{e}$ 上规定 $\\boldsymbol{n} \\cdot \\boldsymbol{D} = 0$ 来逐点施加开路条件，并通过在 $\\Gamma_{e}$ 上规定 $\\phi = 0$ 来消除浮动电势，因为开路会阻止任何法向电通量。**\n-   **分析**：这有两个错误。首先，逐点规定 $\\boldsymbol{n} \\cdot \\boldsymbol{D} = 0$ 是一个处处电荷密度为零的表面的条件，这对于电荷可以重新分布的导体来说是不正确的。约束是针对总电荷（积分），而不是局部密度。其次，规定 $\\phi = 0$ 对应于接地电极，而不是浮动电极。\n-   **结论**：**不正确**。\n\n**C. 用电势的积分条件 $\\int_{\\Gamma_{e}} \\phi\\, \\mathrm{d}\\Gamma = 0$ 替换电荷平衡，因为开路不允许电流流过，因此电极的平均电势必须为零，同时在域内保留标准的高斯定律。**\n-   **分析**：这在物理上是没有根据的。由于压电效应，受到机械应变的浮动电极会产生非零电势。鉴于 $\\phi = \\psi_e$ 在电极上是恒定的，条件 $\\int_{\\Gamma_{e}} \\phi\\, \\mathrm{d}\\Gamma = 0$ 将意味着 $\\psi_e = 0$，这同样是接地条件。开路的物理原理与总电荷有关，而不是电势的平均值。\n-   **结论**：**不正确**。\n\n**D. 假设在 $\\Gamma_{e}$ 上 $\\phi = \\psi_e$，其中 $\\psi_e$ 未知，但通过在电荷平衡中忽略压电耦合来近似开路条件，并施加 $$ \\int_{\\Gamma_{e}} \\boldsymbol{n} \\cdot \\big(\\boldsymbol{\\varepsilon}^S \\nabla \\phi\\big)\\, \\mathrm{d}\\Gamma \\;=\\; 0, $$ 因为在线性电介质中，机械场不影响电极的净电荷。**\n-   **分析**：这种方法不正确地简化了物理过程。它忽略了 $\\boldsymbol{D}$ 表达式中的压电项 $\\mathbf{e}\\,\\boldsymbol{S}$。这一项代表了由应变产生的电荷，这是所研究的基本机制。移除它就是否定压电效应本身。其推理是有缺陷的；在*压电*材料中，机械场绝对会影响净电荷。\n-   **结论**：**不正确**。\n\n**E. 强制等势性，其中 $\\psi_e$ 未知，并在电极上施加一个基于场的约束 $$ \\int_{\\Gamma_{e}} \\boldsymbol{n} \\cdot \\boldsymbol{E}\\, \\mathrm{d}\\Gamma \\;=\\; 0, $$ 理由是外部电流的缺失意味着通过电极的净电场通量为零，这决定了 $\\psi_e$。**\n-   **分析**：这是基于对物质中高斯定律的误解。与自由表面电荷相关的量是电位移 $\\boldsymbol{D}$，而不是电场 $\\boldsymbol{E}$。$\\boldsymbol{D}$ 的通量等于包围的自由电荷。$\\boldsymbol{E}$ 的通量与总电荷（自由电荷+束缚电荷）有关。开路条件是对自由电荷的约束，所以积分必须涉及 $\\boldsymbol{D}$。\n-   **结论**：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2587501"}, {"introduction": "开发或使用数值模型只是工作的一半，确保其正确性至关重要。作为最终的综合实践，本练习将引导您完成一个完整的验证与确认（V&V）过程，从一个可解析的一维问题的解析解开始，然后开发一个简单的有限元模型，最后将数值结果与解析真值进行比较，以验证模型的准确性和收敛率。", "problem": "考虑一个横向各向同性的线性压电板，其厚度为 $h$，沿极化方向 $3$ 占据一维域 $z \\in [0,h]$。根据长板的 Saint-Venant 运动学假设，假定所有场仅依赖于 $z$。电极完全覆盖 $z=0$ 和 $z=h$ 处的表面，并分别施加电势 $\\phi(0)=0$ 和 $\\phi(h)=V$。在 $z=0$ 或 $z=h$ 上没有机械牵引力，也没有侧向约束。该材料在极化方向上具有以下非零的一维本构系数：恒定电场下的弹性柔度 $s_{33}^E$、压电应变系数 $d_{33}$ 和恒定应力下的介电常数 $\\varepsilon_{33}^\\sigma$。\n\n仅从基本的压电本构方程和平衡定律出发，\n- 线性压电本构关系（应变-电荷形式），\n  $$S_3 = s_{33}^E \\, \\sigma_3 + d_{33} \\, E_3, \\quad D_3 = d_{33} \\, \\sigma_3 + \\varepsilon_{33}^\\sigma \\, E_3,$$\n- 静态力学平衡（无体力），\n  $$\\dfrac{d \\sigma_3}{d z} = 0,$$\n- 电位移的高斯定律（自由电荷密度为 $\\rho_f$），\n  $$\\dfrac{d D_3}{d z} = \\rho_f,$$\n- 从电势定义的电场，\n  $$E_3 = -\\dfrac{d \\phi}{d z},$$\n\n推导强形式边值问题及其解析解，求解沿厚度方向的场 $\\phi(z)$, $E_3(z)$, $D_3(z)$, $\\sigma_3(z)$, $S_3(z)$，以及总厚度变化 $\\Delta h = u_3(h) - u_3(0)$，其中 $u_3$ 是 $3$ 方向上的机械位移。你的推导必须明确处理 $\\rho_f=0$ 和 $\\rho_f=\\text{constant} \\neq 0$ 的情况，并且必须说明 $\\Delta h$ 是否依赖于 $\\rho_f$。\n\n接下来，为电势 $\\phi(z)$ 构建一维有限元方法，使用包含 $N$ 个单元的均匀网格上的线性形函数。使用一维标量泊松方程的标准 Galerkin 弱形式，并为 $\\phi(0)$ 和 $\\phi(h)$ 设置狄利克雷边界条件，同时假设 $\\varepsilon_{33}^\\sigma$ 和 $\\rho_f$ 为常数。根据计算出的 $\\phi_h(z)$，将分段常数电场近似值 $E_{3,h}$ 定义为 $\\phi_h$ 的单元梯度。使用本构关系和无牵引力边界条件来定义近似厚度变化\n$$\\Delta h_h = d_{33} \\int_0^h E_{3,h}(z) \\, dz.$$\n\n将电势近似的 $H^1$-半范数误差定义为\n$$\\lVert \\phi' - \\phi_h' \\rVert_{L^2(0,h)} = \\left( \\int_0^h \\left( \\dfrac{d \\phi}{d z} - \\dfrac{d \\phi_h}{d z} \\right)^2 dz \\right)^{1/2}.$$\n使用此误差，通过以下公式计算在具有 $N$ 和 $2N$ 个单元的两个连续均匀网格之间的观测收敛率 $p$\n$$p = \\dfrac{\\log \\left( \\lVert \\phi' - \\phi_{h,N}' \\rVert_{L^2} \\big/ \\lVert \\phi' - \\phi_{h,2N}' \\rVert_{L^2} \\right)}{\\log(2)}.$$\n\n实现一个程序，该程序：\n- 对于给定的 $N$, $h$, $\\varepsilon_{33}^\\sigma$, $\\rho_f$ 和 $V$，组装并求解 $\\phi_h$ 的有限元系统；\n- 计算精确误差计算所需的解析解参数和场；\n- 计算 $\\Delta h$ 和 $\\Delta h_h$；以及\n- 计算网格细化对的 $H^1$-半范数误差和观测速率 $p$。\n\n使用以下科学上一致的参数（所有量均采用国际单位制）：\n- 真空介电常数 $\\varepsilon_0 = 8.854187817 \\times 10^{-12}$,\n- 恒定应力下的材料介电常数 $\\varepsilon_{33}^\\sigma = 1500 \\, \\varepsilon_0$,\n- 压电应变系数 $d_{33} = 400 \\times 10^{-12}$,\n- 恒定电场下的弹性柔度 $s_{33}^E = 16 \\times 10^{-12}$,\n- 板厚 $h = 1 \\times 10^{-3}$.\n\n设计以下包含三种情况的测试套件：\n\n- 情况 A（理想路径：全电极，无自由电荷）：$V = 100$, $\\rho_f = 0$。计算以米为单位的解析厚度变化 $\\Delta h$ 和在均匀网格 $N \\in \\{1,2,4,8\\}$ 上的最大绝对误差 $\\max_N |\\Delta h - \\Delta h_h|$（以米为单位）。\n\n- 情况 B（带体自由电荷的非平凡场）：$V = 100$, $\\rho_f = 0.1$。计算在 $N=16$ 和 $N=32$ 之间电势的 $H^1$-半范数下的观测收敛率 $p$。\n\n- 情况 C（解耦机电学的边界情况）：$V = 50$, $d_{33} = 0$, $\\rho_f = 0$。计算以米为单位的解析厚度变化 $\\Delta h$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个浮点数四舍五入到六位有效数字，顺序如下\n$$[\\Delta h_{\\text{A}}, \\; \\max_N |\\Delta h_{\\text{A}} - \\Delta h_{h,\\text{A}}|, \\; p_{\\text{B}}, \\; \\Delta h_{\\text{C}}].$$\n所有位移以米表示，观测速率为无量纲数。不涉及角度。任何地方都不得使用百分比；任何比率都必须表示为小数。程序不得接受任何输入，并且必须按原样运行。", "solution": "问题陈述经过严格验证，被认为是有效的。它在科学上基于线性压电理论，在数学上是一个适定的一维边值问题，并包含一套完整且一致的数据和定义。问题结构有助于对解析推导和数值实现能力进行严格的测试。\n\n在此，我们提出完整的推导和求解方法。所有数学实体都严格遵守强制性的 LaTeX 格式。\n\n### 第 1 部分：强形式和解的解析推导\n\n我们从所提供的、描述一维压电介质在静态条件下沿极化方向 $3$ 行为的基本方程出发。\n\n**1.1. 控制边值问题的推导**\n\n控制方程如下：\n1.  线性压电本构关系：\n    $$S_3 = s_{33}^E \\, \\sigma_3 + d_{33} \\, E_3$$\n    $$D_3 = d_{33} \\, \\sigma_3 + \\varepsilon_{33}^\\sigma \\, E_3$$\n2.  静态力学平衡（无体力）：\n    $$\\dfrac{d \\sigma_3}{d z} = 0$$\n3.  静电学高斯定律：\n    $$\\dfrac{d D_3}{d z} = \\rho_f$$\n4.  电场定义：\n    $$E_3 = -\\dfrac{d \\phi}{d z}$$\n\n机械边界条件指定在 $z=0$ 和 $z=h$ 的表面上没有牵引力，这转化为 $\\sigma_3(0) = 0$ 和 $\\sigma_3(h) = 0$。平衡方程 $\\frac{d \\sigma_3}{d z} = 0$ 意味着 $\\sigma_3(z)$ 必须为常数。结合边界条件，这迫使应力处处为零：\n$$\\sigma_3(z) = 0 \\quad \\forall z \\in [0, h]$$\n这对于机械自由的板是一个关键的简化。将 $\\sigma_3 = 0$ 代入电位移 $D_3$ 的本构关系，得到：\n$$D_3 = \\varepsilon_{33}^\\sigma \\, E_3$$\n接下来，我们将这个简化的关系代入高斯定律：\n$$\\dfrac{d}{d z} (\\varepsilon_{33}^\\sigma \\, E_3) = \\rho_f$$\n假设介电常数 $\\varepsilon_{33}^\\sigma$ 在空间上是恒定的，我们有：\n$$\\varepsilon_{33}^\\sigma \\dfrac{d E_3}{d z} = \\rho_f$$\n最后，代入电场的定义 $E_3 = -d\\phi/dz$，得到关于电势 $\\phi(z)$ 的控制性二阶常微分方程：\n$$-\\varepsilon_{33}^\\sigma \\dfrac{d^2 \\phi}{d z^2} = \\rho_f$$\n这是一维泊松方程。该问题是一个由这个常微分方程（ODE）和给定的电势狄利克雷边界条件所定义的边值问题（BVP）：\n$$\n\\text{求解在 } z \\in [0,h] \\text{ 上的 } \\phi(z) \\text{，使得：} \\\\\n-\\varepsilon_{33}^\\sigma \\dfrac{d^2 \\phi}{d z^2} = \\rho_f, \\quad z \\in (0,h) \\\\\n\\phi(0) = 0, \\quad \\phi(h) = V\n$$\n\n**1.2. 解析解**\n\n我们通过对常微分方程进行两次积分来求解该边值问题，假设自由电荷密度 $\\rho_f$ 是一个常数。\n$$\\dfrac{d^2 \\phi}{d z^2} = -\\dfrac{\\rho_f}{\\varepsilon_{33}^\\sigma}$$\n对 $z$ 积分：\n$$\\dfrac{d \\phi}{d z} = -\\dfrac{\\rho_f}{\\varepsilon_{33}^\\sigma} z + C_1$$\n再次积分：\n$$\\phi(z) = -\\dfrac{\\rho_f}{2\\varepsilon_{33}^\\sigma} z^2 + C_1 z + C_2$$\n我们利用边界条件来确定积分常数 $C_1$ 和 $C_2$。\n由 $\\phi(0) = 0$ 得：\n$$0 = -\\dfrac{\\rho_f}{2\\varepsilon_{33}^\\sigma} (0)^2 + C_1 (0) + C_2 \\implies C_2 = 0$$\n由 $\\phi(h) = V$ 得：\n$$V = -\\dfrac{\\rho_f}{2\\varepsilon_{33}^\\sigma} h^2 + C_1 h \\implies C_1 = \\dfrac{V}{h} + \\dfrac{\\rho_f h}{2\\varepsilon_{33}^\\sigma}$$\n将常数代回，电势的解析解为：\n$$\\phi(z) = \\left( \\dfrac{V}{h} + \\dfrac{\\rho_f h}{2\\varepsilon_{33}^\\sigma} \\right) z - \\dfrac{\\rho_f}{2\\varepsilon_{33}^\\sigma} z^2 = \\dfrac{V z}{h} + \\dfrac{\\rho_f}{2\\varepsilon_{33}^\\sigma} z(h-z)$$\n该解对 $\\rho_f = 0$ 和 $\\rho_f = \\text{constant} \\neq 0$ 两种情况均有效。\n\n从 $\\phi(z)$，我们推导其他场：\n- **电场 $E_3(z)$**：\n$$E_3(z) = -\\dfrac{d\\phi}{dz} = -\\left( \\dfrac{V}{h} + \\dfrac{\\rho_f h}{2\\varepsilon_{33}^\\sigma} - \\dfrac{\\rho_f}{\\varepsilon_{33}^\\sigma} z \\right) = -\\dfrac{V}{h} - \\dfrac{\\rho_f}{2\\varepsilon_{33}^\\sigma}(h - 2z)$$\n- **应力 $\\sigma_3(z)$**：如前所述，$\\sigma_3(z) = 0$。\n- **应变 $S_3(z)$**：使用本构关系 $S_3 = s_{33}^E \\sigma_3 + d_{33} E_3$ 并设 $\\sigma_3=0$：\n$$S_3(z) = d_{33} E_3(z) = d_{33} \\left( -\\dfrac{V}{h} - \\dfrac{\\rho_f}{2\\varepsilon_{33}^\\sigma}(h - 2z) \\right)$$\n- **总厚度变化 $\\Delta h$**：总伸长量是应变 $S_3(z) = du_3/dz$ 在整个厚度上的积分：\n$$\\Delta h = u_3(h) - u_3(0) = \\int_0^h S_3(z) dz = d_{33} \\int_0^h E_3(z) dz$$\n$$\\Delta h = d_{33} \\int_0^h \\left[ -\\dfrac{V}{h} - \\dfrac{\\rho_f}{2\\varepsilon_{33}^\\sigma}(h - 2z) \\right] dz$$\n计算该积分：\n$$\\Delta h = d_{33} \\left[ -\\dfrac{Vz}{h} - \\dfrac{\\rho_f}{2\\varepsilon_{33}^\\sigma}\\left(hz - z^2\\right) \\right]_0^h$$\n$$\\Delta h = d_{33} \\left( -\\dfrac{V h}{h} - \\dfrac{\\rho_f}{2\\varepsilon_{33}^\\sigma}(h^2 - h^2) - (0) \\right) = d_{33}(-V)$$\n因此，解析厚度变化为：\n$$\\Delta h = -d_{33} V$$\n这是一个关键发现：总厚度变化仅取决于施加的电压 $V$ 和压电系数 $d_{33}$，并且值得注意的是，它与恒定的自由电荷密度 $\\rho_f$ **无关**。\n\n### 第 2 部分：有限元列式\n\n我们使用标准 Galerkin 方法为电势 $\\phi(z)$ 构建一个一维有限元模型。\n\n**2.1. 弱形式**\n\n将控制常微分方程乘以一个在狄利克雷边界上为零（即 $w(0)=w(h)=0$）的函数空间中的试函数 $w(z)$，并在域 $[0,h]$ 上积分，从而导出弱形式：\n$$-\\int_0^h \\varepsilon_{33}^\\sigma \\phi''(z) w(z) dz = \\int_0^h \\rho_f w(z) dz$$\n对左侧应用分部积分：\n$$\\int_0^h \\varepsilon_{33}^\\sigma \\phi'(z) w'(z) dz - \\left[ \\varepsilon_{33}^\\sigma \\phi'(z) w(z) \\right]_0^h = \\int_0^h \\rho_f w(z) dz$$\n由于 $w(0)=w(h)=0$，边界项消失。最终的弱形式为：\n求解满足狄利克雷边界条件的 $\\phi(z)$，使得对于所有有效的试函数 $w(z)$：\n$$\\int_0^h \\varepsilon_{33}^\\sigma \\phi'(z) w'(z) dz = \\int_0^h \\rho_f w(z) dz$$\n\n**2.2. 离散化**\n\n我们将域 $[0,h]$ 离散化为 $N$ 个长度为 $\\Delta z = h/N$ 的均匀单元。我们使用线性基（“帽”）函数 $N_i(z)$ 来近似电势 $\\phi(z)$：$\\phi_h(z) = \\sum_{j=0}^{N} \\Phi_j N_j(z)$，其中 $\\Phi_j$ 是未知的电势节点值。\n位于节点 $a$ 和 $b$ 之间的单元的单元刚度矩阵 $k^e$ 和力向量 $f^e$ 为：\n$$k^e = \\int_{z_a}^{z_b} \\varepsilon_{33}^\\sigma (N')^T (N') dz = \\frac{\\varepsilon_{33}^\\sigma}{\\Delta z} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$$\n$$f^e = \\int_{z_a}^{z_b} \\rho_f N dz = \\frac{\\rho_f \\Delta z}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$$\n组装这些单元得到一个全局线性方程组 $K_{glob} \\mathbf{\\Phi}_{glob} = F_{glob}$。施加狄利克雷边界条件 $\\Phi_0=0$ 和 $\\Phi_N=V$ 后，我们得到一个用于求解内部节点电势 $[\\Phi_1, \\dots, \\Phi_{N-1}]^T$ 的简化的 $(N-1) \\times (N-1)$ 三对角系统。该系统可以被高效求解。\n\n### 第 3 部分：派生量的数值计算\n\n**3.1. 近似厚度变化 $\\Delta h_h$**\n\n问题使用数值计算出的电场 $E_{3,h}$ 来定义近似厚度变化：\n$$\\Delta h_h = d_{33} \\int_0^h E_{3,h}(z) \\, dz$$\n数值场 $E_{3,h}(z)$ 是电势的单元梯度，即 $E_{3,h}(z) = -\\phi_h'(z)$。其积分为：\n$$\\int_0^h E_{3,h}(z) dz = \\int_0^h -\\phi_h'(z) dz = -[\\phi_h(z)]_0^h = -(\\phi_h(h) - \\phi_h(0))$$\n由于有限元解 $\\phi_h(z)$ 精确满足狄利克雷边界条件，即 $\\phi_h(0)=0$ 和 $\\phi_h(h)=V$。因此：\n$$\\int_0^h E_{3,h}(z) dz = -(V - 0) = -V$$\n因此，近似厚度变化为：\n$$\\Delta h_h = -d_{33} V$$\n这个结果与解析解 $\\Delta h$ 完全相同。因此，对于任何网格，误差 $|\\Delta h - \\Delta h_h|$ 都恒等于零，且与 $\\rho_f$ 无关。\n\n**3.2. 误差计算与收敛率**\n\n$H^1$-半范数误差，用于衡量梯度的误差，计算如下：\n$$\\lVert \\phi' - \\phi_h' \\rVert_{L^2(0,h)}^2 = \\int_0^h (\\phi'(z) - \\phi_h'(z))^2 dz = \\int_0^h (E_{3,h}(z) - E_3(z))^2 dz$$\n该积分通过对每个单元的贡献求和来计算，其中 $E_{3,h}(z)$ 是常数，而 $E_3(z)$ 是 $z$ 的线性函数。为了保证精度，每个单元上的积分都进行解析计算。\n然后在大小为 $N$ 和 $2N$ 的两个网格之间计算观测收敛率 $p$：\n$$p = \\dfrac{\\log \\left( \\lVert \\phi' - \\phi_{h,N}' \\rVert_{L^2} \\big/ \\lVert \\phi' - \\phi_{h,2N}' \\rVert_{L^2} \\right)}{\\log(2)}$$\n对于线性单元，$H^1$-半范数的理论收敛率是 $p=1$。\n\n### 第 4 部分：特定情况计算\n\n**情况 A**：$V = 100 \\, \\text{V}$，$\\rho_f = 0 \\, \\text{C/m}^3$，$d_{33} = 400 \\times 10^{-12} \\, \\text{m/V}$。\n- 解析厚度变化：$\\Delta h_A = -d_{33} V = -(400 \\times 10^{-12})(100) = -4 \\times 10^{-8} \\, \\text{m}$。\n- 数值厚度变化误差：如前推导，$\\Delta h_{h,A} = -d_{33} V$ 精确成立。因此，$\\max_N |\\Delta h_A - \\Delta h_{h,A}| = 0$。\n\n**情况 B**：$V = 100 \\, \\text{V}$，$\\rho_f = 0.1 \\, \\text{C/m}^3$。\n- 对于 $N=16 \\to 32$ 的收敛率 $p_B$ 是通过实现上述的有限元求解器和 $H^1$-半范数误差计算来得到的。预期结果将接近理论值 $1$。\n\n**情况 C**：$V = 50 \\, \\text{V}$，$d_{33} = 0$，$\\rho_f = 0 \\, \\text{C/m}^3$。\n- 这种情况代表一个没有压电耦合的简单电介质。\n- 解析厚度变化：$\\Delta h_C = -d_{33} V = -(0)(50) = 0 \\, \\text{m}$。\n\n所提供的材料参数和测试用例值将用于实现中，以产生最终的数值结果。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef format_number(value, sig_figs):\n    \"\"\"Formats a number to a specified number of significant figures.\"\"\"\n    if value == 0:\n        return \"{:.{}e}\".format(0.0, sig_figs - 1)\n    return \"{:.{}e}\".format(value, sig_figs - 1)\n\ndef solve():\n    \"\"\"\n    Solves the 1D piezoelectric problem analytically and numerically\n    for the specified test cases.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    EPS_0 = 8.854187817e-12  # Vacuum permittivity (F/m)\n    EPS_S33 = 1500 * EPS_0     # Permittivity at constant stress (F/m)\n    D33_orig = 400e-12         # Piezoelectric coefficient (m/V or C/N)\n    S33_E = 16e-12             # Elastic compliance at constant E-field (m^2/N)\n    H = 1e-3                   # Plate thickness (m)\n\n    # --- Helper Functions ---\n\n    def solve_fem(N, h, eps_s, rho_f, V):\n        \"\"\"Assembles and solves the 1D FEM system for phi(z).\"\"\"\n        if N  1:\n            raise ValueError(\"Number of elements N must be at least 1.\")\n        \n        num_unknowns = N - 1\n        if num_unknowns == 0: # N=1 case, no internal nodes\n            return np.array([0.0, V])\n\n        dz = h / N\n        \n        # Stiffness matrix K (banded format for scipy.linalg.solve_banded)\n        # K is (N-1)x(N-1)\n        # ab is 3x(N-1) with (l, u) = (1, 1)\n        # Row 0: super-diagonal (padded with 0 at start)\n        # Row 1: main diagonal\n        # Row 2: sub-diagonal (padded with 0 at end)\n        ab = np.zeros((3, num_unknowns))\n        k_factor = eps_s / dz\n        ab[0, 1:] = -k_factor\n        ab[1, :] = 2 * k_factor\n        ab[2, :-1] = -k_factor\n\n        # Force vector F (RHS)\n        F = np.full(num_unknowns, rho_f * dz)\n        \n        # Apply boundary condition from V at z=h\n        F[-1] += k_factor * V\n        \n        # Solve the tridiagonal system for interior nodes\n        phi_internal = solve_banded((1, 1), ab, F)\n        \n        # Construct full solution vector [phi_0, ..., phi_N]\n        phi_full = np.zeros(N + 1)\n        phi_full[1:-1] = phi_internal\n        phi_full[-1] = V\n        \n        return phi_full\n\n    def calculate_h1_seminorm_error(N, h, eps_s, rho_f, V, phi_h):\n        \"\"\"Calculates the H1-seminorm error between analytical and FEM solutions.\"\"\"\n        dz = h / N\n        \n        # Analytical electric field E_3(z) = C1 + C2*z\n        C1 = -V / h - rho_f * h / (2 * eps_s)\n        C2 = rho_f / eps_s\n        \n        total_squared_error = 0.0\n        \n        for i in range(1, N + 1):\n            # Element domain\n            z_a = (i - 1) * dz\n            z_b = i * dz\n            \n            # Numerical field on element (constant)\n            E_h_i = -(phi_h[i] - phi_h[i-1]) / dz\n            \n            # Integral of (E_h - E_analytic)^2 over element\n            # Integral of (A + B*z)^2 dz where A=E_h_i-C1, B=-C2\n            A = E_h_i - C1\n            B = -C2\n            \n            # Indefinite integral of (A+Bz)^2 is A^2*z + A*B*z^2 + (B^2/3)*z^3\n            term1 = A**2 * (z_b - z_a)\n            term2 = A * B * (z_b**2 - z_a**2)\n            term3 = (B**2 / 3) * (z_b**3 - z_a**3)\n            \n            element_error_sq = term1 + term2 + term3\n            total_squared_error += element_error_sq\n            \n        return np.sqrt(total_squared_error)\n\n    # --- Case A: Happy path ---\n    # V=100, rho_f=0. Compute delta_h and max error in delta_h_h.\n    V_A = 100.0\n    rho_f_A = 0.0\n    d33_A = D33_orig\n    \n    # Analytical delta_h\n    delta_h_A = -d33_A * V_A\n\n    # Numerical delta_h_h error\n    # As derived, delta_h_h = -d33 * V, so the error is analytically 0.\n    # We can confirm by calculation, but it will be 0 up to machine precision.\n    max_error_A = 0.0\n    \n    # --- Case B: Non-trivial field ---\n    # V=100, rho_f=0.1. Compute convergence rate p for N=16-32.\n    V_B = 100.0\n    rho_f_B = 0.1\n    \n    N1 = 16\n    phi_h_N1 = solve_fem(N1, H, EPS_S33, rho_f_B, V_B)\n    error_N1 = calculate_h1_seminorm_error(N1, H, EPS_S33, rho_f_B, V_B, phi_h_N1)\n\n    N2 = 32\n    phi_h_N2 = solve_fem(N2, H, EPS_S33, rho_f_B, V_B)\n    error_N2 = calculate_h1_seminorm_error(N2, H, EPS_S33, rho_f_B, V_B, phi_h_N2)\n\n    p_B = np.log(error_N1 / error_N2) / np.log(2) if error_N2 > 0 else 0.0\n\n    # --- Case C: Decoupled edge case ---\n    # V=50, d33=0, rho_f=0. Compute analytical delta_h.\n    V_C = 50.0\n    d33_C = 0.0\n    \n    delta_h_C = -d33_C * V_C\n\n    # --- Final Output ---\n    results = [delta_h_A, max_error_A, p_B, delta_h_C]\n    formatted_results = [format_number(res, 6) for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2587416"}]}