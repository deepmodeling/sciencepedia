{"hands_on_practices": [{"introduction": "几何多重网格方法的核心在于网格间的算子传递：将误差从细网格传递到粗网格的限制(restriction)算子，以及将修正从粗网格传递回细网格的延拓(prolongation)算子。Galerkin原理，$A_H = R A_h P$，提供了一种自动构建粗网格算子的稳健方法。本练习将引导你推导标准的双线性插值和全加权限制算子的计算模板及其傅里叶符号，并理解为何对于嵌套的$Q_1$有限元空间，此过程会生成一个与标准粗网格拉普拉斯算子成比例的算子[@problem_id:2581555]，从而加深对连续（有限元）和离散（多重网格）观点之间联系的理解。", "problem": "考虑模型问题 $-\\Delta u = f$，其定义域为周期性二维环面 $\\Omega = \\mathbb{T}^{2}$，在使用分片双线性 ($Q_{1}$) 有限元方法，于网格尺寸为 $h$ 的均匀笛卡尔网格上进行离散化。在此网格上，得到的刚度矩阵 $A_{h}$ 是标准的五点离散拉普拉斯算子。引入一个网格尺寸为 $H = 2h$ 的粗网格。网格间传递算子的定义如下：延拓算子 $P_{H}^{h}$ 是从粗网格到细网格的双线性（线性）插值，而限制算子 $R_{h}^{H}$ 是从细网格到粗网格的全加权。假设采用周期性边界条件，以便应用平移不变性和傅里叶分析。\n\n任务：\n- 从双线性插值的定义性质出发，并根据限制算子是保持常数的对称、紧凑加权平均，且与在 $d = 2$ 维下 $R_{h}^{H} = 2^{-d} (P_{H}^{h})^{T}$ 的选择一致的要求，推导以粗网格节点为中心的 $P_{H}^{h}$ 和 $R_{h}^{H}$ 的 $3 \\times 3$ 点格式。\n- 使用局部傅里叶分析（LFA, Local Fourier Analysis）中傅里叶符号的定义，即对于网格上的平移不变算子 $M$，傅里叶模 $\\varphi_{\\boldsymbol{\\theta}}(\\boldsymbol{j}) = \\exp\\!\\big(i(\\boldsymbol{j}\\cdot \\boldsymbol{\\theta})\\big)$ 是其特征函数，对应的特征值（符号）为 $\\tilde{M}(\\boldsymbol{\\theta})$，推导你的格式所对应的傅里叶符号 $\\tilde{P}_{H}^{h}(\\boldsymbol{\\theta})$ 和 $\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta})$，其中 $\\boldsymbol{\\theta} = (\\theta_{1},\\theta_{2}) \\in [-\\pi,\\pi]^{2}$。\n- 从细网格上经过充分检验的五点拉普拉斯算子符号 $\\tilde{A}_{h}(\\boldsymbol{\\theta}) = \\dfrac{4}{h^{2}}\\!\\left(\\sin^{2}\\!\\big(\\tfrac{\\theta_{1}}{2}\\big) + \\sin^{2}\\!\\big(\\tfrac{\\theta_{2}}{2}\\big)\\right)$ 出发，结合粗网格算子的 Galerkin 定义 $A_{H} = R_{h}^{H} A_{h} P_{H}^{h}$ 以及在 $d=2$ 维下 $R_{h}^{H} = 2^{-2} (P_{H}^{h})^{T}$ 的关系，从嵌套 $Q_{1}$ 有限元空间的第一性原理出发进行论证，说明 $A_{H}$ 是标准粗网格五点拉普拉斯算子的一个均匀缩放版本，并将其傅里叶符号 $\\tilde{A}_{H}(\\boldsymbol{\\vartheta})$ 显式地写成 $\\boldsymbol{\\vartheta} = (\\vartheta_{1},\\vartheta_{2})$ 和 $H$ 的函数。\n- 最后，在 $\\boldsymbol{\\vartheta} = \\big(\\tfrac{\\pi}{2}, \\tfrac{\\pi}{3}\\big)$ 处计算无量纲标量 $S = \\tilde{A}_{H}(\\boldsymbol{\\vartheta})\\,H^{2}$ 的值，并给出其精确值。不要四舍五入。你的最终答案必须是一个不带单位的单一数字。", "solution": "在尝试求解之前，对问题陈述进行验证。\n\n步骤1：提取已知条件\n\n-   **方程：** $-\\Delta u = f$\n-   **区域：** 周期性二维环面 $\\Omega = \\mathbb{T}^{2}$。\n-   **离散化：** 在均匀笛卡尔网格上使用分片双线性 ($Q_{1}$) 有限元。\n-   **细网格：** 网格尺寸为 $h$。刚度矩阵为 $A_{h}$，即标准的五点离散拉普拉斯算子。\n-   **粗网格：** 网格尺寸为 $H = 2h$。刚度矩阵为 $A_{H}$。\n-   **延拓：** $P_{H}^{h}$ 是双线性（线性）插值。\n-   **限制：** $R_{h}^{H}$ 是全加权。\n-   **网格间算子关系：** 限制算子的选择与在 $d = 2$ 维下 $R_{h}^{H} = 2^{-d} (P_{H}^{h})^{T}$ 一致，即 $R_{h}^{H} = \\frac{1}{4} (P_{H}^{h})^{T}$。\n-   **边界条件：** 周期性，允许进行傅里叶分析。\n-   **傅里叶分析定义：**\n    -   傅里叶模：$\\varphi_{\\boldsymbol{\\theta}}(\\boldsymbol{j}) = \\exp(i(\\boldsymbol{j}\\cdot \\boldsymbol{\\theta}))$\n    -   傅里叶符号 $\\tilde{M}(\\boldsymbol{\\theta})$：对于平移不变算子 $M$，其对应于特征函数 $\\varphi_{\\boldsymbol{\\theta}}(\\boldsymbol{j})$ 的特征值。\n-   **给定的细网格符号：** $\\tilde{A}_{h}(\\boldsymbol{\\theta}) = \\dfrac{4}{h^{2}}(\\sin^{2}(\\tfrac{\\theta_{1}}{2}) + \\sin^{2}(\\tfrac{\\theta_{2}}{2}))$。\n-   **粗网格算子定义：** $A_{H} = R_{h}^{H} A_{h} P_{H}^{h}$。\n-   **任务：**\n    1.  推导 $P_{H}^{h}$ 和 $R_{h}^{H}$ 的 $3 \\times 3$ 格式。\n    2.  推导它们的傅里叶符号 $\\tilde{P}_{H}^{h}(\\boldsymbol{\\theta})$ 和 $\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta})$。\n    3.  从有限元方法原理出发，论证 $A_{H}$ 是粗网格五点拉普拉斯算子的一个缩放版本，并求其符号 $\\tilde{A}_{H}(\\boldsymbol{\\vartheta})$。\n    4.  在 $\\boldsymbol{\\vartheta} = (\\tfrac{\\pi}{2}, \\tfrac{\\pi}{3})$ 处计算 $S = \\tilde{A}_{H}(\\boldsymbol{\\vartheta})\\,H^{2}$。\n\n步骤2：使用提取的已知条件进行验证\n\n该问题在有限元方法（FEM）和多重网格方法等已建立的数学领域中有坚实的科学基础，特别是使用了局部傅里叶分析（LFA）。所有概念，包括双线性元、五点拉普拉斯算子、双线性插值、全加权限制和 Galerkin 粗化，都是标准的且定义明确。该问题是适定的，提供了得到唯一解所需的所有定义、关系和数据。语言客观、精确。不存在矛盾；关系 $R_{h}^{H} = \\frac{1}{4} (P_{H}^{h})^{T}$ 与二维 $Q_1$ 元素的双线性插值和全加权限制的标准配对是一致的。该问题需要实质性的推理，并非微不足道。\n\n步骤3：结论与行动\n\n问题有效。将提供完整的解答。\n\n**求解推导**\n\n按照指定的顺序执行任务来求解。\n\n**任务1：推导格式**\n\n要求格式以粗网格节点为中心。设粗网格节点由 $\\boldsymbol{J}$ 索引，细网格节点由 $\\boldsymbol{j}$ 索引。我们建立一个局部坐标系，以一个粗网格节点为原点。\n\n限制算子 $R_{h}^{H}$ 将细网格上的函数映射到粗网格。它被定义为“保持常数的对称、紧凑加权平均”。一个作用于细网格值以产生粗网格值的通用对称 $3 \\times 3$ 格式由下式给出：\n$$\n(R_{h}^{H} u)_{\\boldsymbol{J}=0} = \\sum_{k_1, k_2 \\in \\{-1,0,1\\}} w_{|k_1|,|k_2|} u_{(k_1, k_2)}\n$$\n对于全加权，权重通常选择为与 $[1, 2, 1] \\otimes [1, 2, 1]^T$ 成比例。为了保持常数（即将常数函数 $u=c$ 映射为 $R_{h}^{H}u=c$），权重的总和必须为 $1$。未归一化权重的总和为 $(1+2+1)\\times(1+2+1) = 4 \\times 4 = 16$。因此，$R_{h}^{H}$ 的格式（它结合了 $9$ 个细网格值来计算 $1$ 个粗网格值）为：\n$$\nS_{R} = \\frac{1}{16}\n\\begin{pmatrix}\n1  2  1 \\\\\n2  4  2 \\\\\n1  2  1\n\\end{pmatrix}\n$$\n延拓算子 $P_{H}^{h}$ 是双线性插值。它的作用是根据粗网格上的值确定细网格上的值。题目要求其以粗网格节点为中心的格式，该格式描述了单个粗网格值对周围九个细网格点的贡献。这即所谓的注入格式，它是限制格式的转置。题目指明了与 $R_{h}^{H} = \\frac{1}{4} (P_{H}^{h})^{T}$ 的一致性。$(P_{H}^{h})^T$ 的格式必须是 $4 S_R$。\n$$\nS_{P^T} = 4 S_R = \\frac{4}{16}\n\\begin{pmatrix}\n1  2  1 \\\\\n2  4  2 \\\\\n1  2  1\n\\end{pmatrix} = \\frac{1}{4}\n\\begin{pmatrix}\n1  2  1 \\\\\n2  4  2 \\\\\n1  2  1\n\\end{pmatrix}\n$$\n由于此格式矩阵是对称的，因此 $P_{H}^{h}$ 的注入格式是相同的。这正确地表示了双线性插值：一个粗网格节点值对重合的细网格节点贡献权重为 $1$，对边上的细网格节点贡献权重为 $1/2$，对单元中心的细网格节点贡献权重为 $1/4$。因此，$P_{H}^{h}$ 的格式为：\n$$\nS_{P} = \\frac{1}{4}\n\\begin{pmatrix}\n1  2  1 \\\\\n2  4  2 \\\\\n1  2  1\n\\end{pmatrix}\n$$\n\n**任务2：推导傅里叶符号**\n\n具有计算格式 $S$ 的算子 $M$ 的傅里叶符号 $\\tilde{M}(\\boldsymbol{\\theta})$ 由 $\\tilde{M}(\\boldsymbol{\\theta}) = \\sum_{\\boldsymbol{k}} S_{\\boldsymbol{k}} \\exp(i(\\boldsymbol{k}\\cdot \\boldsymbol{\\theta}))$ 给出。\n\n对于限制算子 $R_{h}^{H}$，格式 $S_R$ 是细网格上的计算格式。其符号为：\n$$\n\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta}) = \\frac{1}{16} \\sum_{k_1,k_2 \\in \\{-1,0,1\\}} S'_{k_1,k_2} \\exp(i(k_1 \\theta_1 + k_2 \\theta_2))\n$$\n其中 $S'$ 是未归一化权重的矩阵。\n$$\n\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta}) = \\frac{1}{16} \\left[ 4 + 2(e^{i\\theta_1} + e^{-i\\theta_1}) + 2(e^{i\\theta_2} + e^{-i\\theta_2}) + 1(e^{i(\\theta_1+\\theta_2)} + e^{-i(\\theta_1+\\theta_2)} + e^{i(\\theta_1-\\theta_2)} + e^{-i(\\theta_1-\\theta_2)}) \\right]\n$$\n使用 $e^{ix} + e^{-ix} = 2\\cos(x)$，我们得到：\n$$\n\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta}) = \\frac{1}{16} \\left[ 4 + 4\\cos(\\theta_1) + 4\\cos(\\theta_2) + 2\\cos(\\theta_1+\\theta_2) + 2\\cos(\\theta_1-\\theta_2) \\right]\n$$\n使用 $\\cos(A+B)+\\cos(A-B) = 2\\cos A\\cos B$：\n$$\n\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta}) = \\frac{1}{16} \\left[ 4 + 4\\cos(\\theta_1) + 4\\cos(\\theta_2) + 4\\cos(\\theta_1)\\cos(\\theta_2) \\right] = \\frac{1}{4} (1+\\cos(\\theta_1))(1+\\cos(\\theta_2))\n$$\n使用半角恒等式 $1+\\cos(x) = 2\\cos^2(x/2)$：\n$$\n\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta}) = \\frac{1}{4} (2\\cos^2(\\tfrac{\\theta_1}{2}))(2\\cos^2(\\tfrac{\\theta_2}{2})) = \\cos^2(\\tfrac{\\theta_1}{2})\\cos^2(\\tfrac{\\theta_2}{2})\n$$\n对于延拓算子 $P_H^h$（即双线性插值），我们不能直接使用其注入格式来计算其符号，因为它不是单个网格上的计算格式。相反，我们从插值的定义推导其符号。对于低频模式 $\\boldsymbol{\\theta} \\in [-\\pi/2, \\pi/2]^2$，双线性插值的（低频）符号已知为：\n$$\n\\tilde{P}_{H}^{h}(\\boldsymbol{\\theta}) = \\cos(\\tfrac{\\theta_1}{2})\\cos(\\tfrac{\\theta_2}{2})\n$$\n这个符号可以通过分析插值在粗网格傅里叶模上的作用，并将结果投影到低频细网格模上来推导。相位因子被忽略，因为它会在 Galerkin 乘积中抵消。\n\n**任务3：粗网格算子符号**\n\n粗网格算子是通过 Galerkin 投影 $A_{H} = R_{h}^{H} A_{h} P_{H}^{h}$ 形成的。使用给定的关系 $R_{h}^{H} = \\frac{1}{4} (P_{H}^{h})^{T}$，我们得到：\n$$\nA_{H} = \\frac{1}{4} (P_{H}^{h})^{T} A_{h} P_{H}^{h}\n$$\n该问题基于分片双线性 ($Q_{1}$) 有限元。粗网格 $Q_{1}$ 函数空间 $V_H$ 是细网格 $Q_{1}$ 函数空间 $V_h$ 的一个子空间，即 $V_H \\subset V_h$。延拓算子 $P_H^h$ 代表了这种自然嵌入。矩阵 $A_h$ 是双线性形式 $a(u,v)=\\int_\\Omega \\nabla u \\cdot \\nabla v \\, dx$ 在细网格节点基下的表示。乘积 $(P_{H}^{h})^{T} A_{h} P_{H}^{h}$ 是相同双线性形式 $a(u,v)$ 在粗网格节点基下的表示。这正是刚度矩阵，记为 $A_{H}^{\\text{fem}}$，它可以通过直接在网格尺寸为 $H$ 的粗网格上应用有限元法来组装得到。\n\n对于均匀笛卡尔网格，为拉普拉斯算子组装 $Q_{1}$ 刚度矩阵会产生标准的五点离散拉普拉斯算子。因此，$A_{H}^{\\text{fem}}$ 是粗网格上的标准五点拉普拉斯算子。所以，我们有：\n$$\nA_{H} = \\frac{1}{4} A_{H}^{\\text{fem}}\n$$\n这表明 $A_H$ 是标准粗网格五点拉普拉斯算子的一个均匀缩放版本。$A_{H}^{\\text{fem}}$ 的符号由与 $\\tilde{A}_h(\\boldsymbol{\\theta})$ 相同的公式给出，但用 $H$ 替换 $h$，用粗网格频率 $\\boldsymbol{\\vartheta}$ 替换频率 $\\boldsymbol{\\theta}$：\n$$\n\\tilde{A}_{H}^{\\text{fem}}(\\boldsymbol{\\vartheta}) = \\frac{4}{H^2} \\left( \\sin^2(\\tfrac{\\vartheta_1}{2}) + \\sin^2(\\tfrac{\\vartheta_2}{2}) \\right)\n$$\n因此，我们的算子 $A_H$ 的符号是：\n$$\n\\tilde{A}_{H}(\\boldsymbol{\\vartheta}) = \\frac{1}{4} \\tilde{A}_{H}^{\\text{fem}}(\\boldsymbol{\\vartheta}) = \\frac{1}{4} \\frac{4}{H^2} \\left( \\sin^2(\\tfrac{\\vartheta_1}{2}) + \\sin^2(\\tfrac{\\vartheta_2}{2}) \\right) = \\frac{1}{H^2} \\left( \\sin^2(\\tfrac{\\vartheta_1}{2}) + \\sin^2(\\tfrac{\\vartheta_2}{2}) \\right)\n$$\n\n**任务4：最终求值**\n\n我们必须在 $\\boldsymbol{\\vartheta} = (\\tfrac{\\pi}{2}, \\tfrac{\\pi}{3})$ 处计算无量纲标量 $S = \\tilde{A}_{H}(\\boldsymbol{\\vartheta})\\,H^{2}$ 的值。\n代入 $\\tilde{A}_{H}(\\boldsymbol{\\vartheta})$ 的表达式：\n$$\nS = \\left[ \\frac{1}{H^2} \\left( \\sin^2(\\tfrac{\\vartheta_1}{2}) + \\sin^2(\\tfrac{\\vartheta_2}{2}) \\right) \\right] H^2 = \\sin^2(\\tfrac{\\vartheta_1}{2}) + \\sin^2(\\tfrac{\\vartheta_2}{2})\n$$\n现在代入 $\\boldsymbol{\\vartheta}$ 的值：\n$$\nS = \\sin^2\\left(\\frac{1}{2} \\cdot \\frac{\\pi}{2}\\right) + \\sin^2\\left(\\frac{1}{2} \\cdot \\frac{\\pi}{3}\\right) = \\sin^2\\left(\\frac{\\pi}{4}\\right) + \\sin^2\\left(\\frac{\\pi}{6}\\right)\n$$\n我们知道精确值：$\\sin(\\frac{\\pi}{4}) = \\frac{\\sqrt{2}}{2}$ 和 $\\sin(\\frac{\\pi}{6}) = \\frac{1}{2}$。\n$$\nS = \\left(\\frac{\\sqrt{2}}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2 = \\frac{2}{4} + \\frac{1}{4} = \\frac{1}{2} + \\frac{1}{4}\n$$\n$$\nS = \\frac{3}{4}\n$$\n最终值为 $\\frac{3}{4}$。", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "2581555"}, {"introduction": "在了解了Galerkin粗网格算子的构建之后，我们来探讨其在实际应用中的一个重要后果。尽管Galerkin方法在理论上十分优雅，但矩阵乘积$R A_h P$常常导致“模板增长”(stencil growth)，即粗网格算子比直接在粗网格上离散化得到的算子更稠密。本练习通过计算并比较两种多重网格层次结构的算子复杂度——一种使用Galerkin算子，另一种使用重新离散化——来量化这种效应[@problem_id:2581572]，突显了多重网格设计中一个关键的权衡。", "problem": "考虑单位正方形上的二维（$2$-D）泊松方程 $-\\Delta u = f$，其带有齐次狄利克雷边界条件。该方程在一系列嵌套的、均匀加密的笛卡尔网格上进行离散化，这些网格是通过在每个空间方向上对连续层级之间进行因子为2的粗化得到的。\n\n在网格尺寸为 $h$ 的最细层上，假设采用标准的低阶协调离散，其节点基函数组装成的刚度矩阵 $A_h$ 的内部行具有五点（冯·诺伊曼）格式，即每个内部节点都与其北、南、东、西四个邻居耦合，使得每个内部行恰好有 $5$ 个非零元。\n\n构建一个两层几何多重网格转移，使用标准的延长算子 $P$（通过从网格尺寸为 $H=2h$ 的粗网格到细网格的双线性插值给出）和标准的限制算子 $R$（通过全加权给出）。考虑伽辽金粗算子 $A_H = R\\,A_h\\,P$。\n\n任务：\n- 从节点支集的局部性和由 $A_h$ 诱导的图结构出发，确定 $A_H$ 的内部稀疏模式（每个内部行的非零元数量）。\n- 使用该稀疏性，将具有均匀粗化的无限多层级结构的算子复杂度 $C$ 定义为\n$$\nC \\;=\\; \\sum_{\\ell=0}^{\\infty} \\frac{\\operatorname{nnz}\\!\\left(A_{h_\\ell}\\right)}{\\operatorname{nnz}\\!\\left(A_{h_0}\\right)}, \\quad h_{\\ell+1} = 2 h_{\\ell},\n$$\n其中 $\\operatorname{nnz}(\\cdot)$ 表示非零项的总数，$A_{h_\\ell}$ 表示第 $\\ell$ 层的算子。计算 $C_{\\mathrm{RAP}}$ 的值，此时每个粗算子都是通过伽辽金乘积 $A_{h_{\\ell+1}} = R A_{h_\\ell} P$ 构建的，每一层都使用相同的 $P$ 和 $R$，并且在层级 $\\ell \\ge 1$ 上的内部行表现出与你为 $A_H$ 确定的相同的格式模式。\n- 为了比较，假设每个粗算子都是通过在粗网格上重新离散化得到的，因此所有层级上的内部行都与最细层上一样，具有相同的五点格式。计算相应的复杂度 $C_{\\mathrm{red}}$。\n\n忽略边界效应并假设渐近的内部计数占主导地位，将比率\n$$\n\\rho \\;=\\; \\frac{C_{\\mathrm{RAP}}}{C_{\\mathrm{red}}}\n$$\n的精确简化有理数值作为你的最终答案。不需要四舍五入。你的最终答案必须是一个没有单位的单一数字。", "solution": "问题陈述已经过评估并被确定为有效。这是一个适定的、有科学依据的数值分析领域的问题，具体涉及多重网格方法的分析。所有定义都是标准的，任务在计算上是明确定义的。因此，我们可以着手求解。\n\n该问题要求计算二维泊松问题的两种多重网格层级结构的算子复杂度之比。算子复杂度定义为\n$$\nC = \\sum_{\\ell=0}^{\\infty} \\frac{\\operatorname{nnz}(A_{h_\\ell})}{\\operatorname{nnz}(A_{h_0})}\n$$\n其中 $A_{h_\\ell}$ 是第 $\\ell$ 层的系统矩阵。网格层级结构中，第 $\\ell=0$ 层是最细的，后续每一层的网格尺寸都增加2倍，即 $h_{\\ell+1} = 2h_\\ell$。我们被要求忽略边界效应，这使我们能够专注于内部网格点的性质。\n\n设 $n_\\ell$ 是第 $\\ell$ 层上内部网格点的数量。由于维度为 $d=2$ 且网格加密因子为 $2$，连续层级上的网格点数量按 $n_{\\ell+1} \\approx n_\\ell / 2^d = n_\\ell / 4$ 的比例缩放。因此可得 $n_\\ell \\approx n_0 / 4^\\ell$。设 $s_\\ell$ 是矩阵 $A_{h_\\ell}$ 每个内部行的非零元数量。非零元的总数可以近似为 $\\operatorname{nnz}(A_{h_\\ell}) \\approx n_\\ell s_\\ell$。\n\n首先，我们确定伽辽金粗网格算子 $A_H = R A_h P$ 的内部稀疏模式。\n细网格算子 $A_h$ 具有一个 $5$ 点格式，意味着每个内部节点都与自身及其四个正交邻居（北、南、东、西）耦合。延长算子 $P$ 定义为双线性插值，它将一个粗网格节点上的值映射到一个 $3 \\times 3$ 的细网格节点块。限制算子 $R$ 定义为全加权，在相差一个缩放因子的情况下是 $P$ 的转置。它通过一个 $3 \\times 3$ 细网格节点值块的加权平均来计算一个粗网格值。\n\n关键步骤是理解复合算子 $A_H = R A_h P$。一个元素 $(A_H)_{IJ, I'J'}$ 非零当且仅当粗网格节点 $(I,J)$ 与粗网格节点 $(I',J')$ 耦合。如果粗网格节点 $(I,J)$ 的基函数支集（在应用 $R A_h$ 之后）与粗网格节点 $(I',J')$ 的基函数支集（在应用 $P$ 之后）有非零重叠，则存在这种耦合。\n让我们追踪一个单一粗网格节点，比如 $(I', J')$ 的影响。\n1.  **延长 ($P$)**：粗网格节点 $(I', J')$ 上的值被插值到一个以相应细网格节点 $(2I', 2J')$ 为中心的 $3 \\times 3$ 细网格节点块。对于单个粗网格节点，此操作的支集由细网格节点 $(2I'+i, 2J'+j)$ 组成，其中 $i,j \\in \\{-1, 0, 1\\}$。\n2.  **细网格算子 ($A_h$)**：$A_h$ 的 $5$ 点格式扩展了支集。步骤1中 $3 \\times 3$ 块中的每个节点都与其邻居耦合。一个 $3 \\times 3$ 方形支集和一个 $5$ 点格式支集（一个大小为 $3 \\times 3$ 的十字形）的闵可夫斯基和产生一个 $5 \\times 5$ 的方形支集。因此，算子 $A_h P$ 将粗网格节点 $(I', J')$ 上的值映射到一个以 $(2I', 2J')$ 为中心的 $5 \\times 5$ 细网格节点块。该支集由节点 $(2I'+i, 2J'+j)$ 组成，其中 $i,j \\in \\{-2, \\ldots, 2\\}$。\n3.  **限制 ($R$)**：限制算子 $R$ 从一个以 $(2I, 2J)$ 为中心的 $3 \\times 3$ 细网格节点块（即节点 $(2I+i, 2J+j)$，其中 $i,j \\in \\{-1, 0, 1\\}$）计算粗网格节点 $(I, J)$ 的值。\n\n要使矩阵项 $(A_H)_{IJ, I'J'}$ 非零，步骤2中操作的支集（输出）必须与步骤3中操作的支集（输入）重叠。\n令 $\\Delta I = I-I'$ 和 $\\Delta J = J-J'$。来自节点 $(I',J')$ 的输出支集的中心是 $(2I', 2J')$。用于节点 $(I,J)$ 的输入支集的中心是 $(2I, 2J)$。\n如果它们中心之间的距离小于它们半径之和，则支集重叠。输出支集的 $x$ 范围是从 $2I'-2$ 到 $2I'+2$。输入支集的 $x$ 范围是从 $2I-1$ 到 $2I+1$。如果 $|2I - 2I'| \\leq (2+1) = 3$，则发生重叠，这意味着 $|2\\Delta I| \\leq 3$，或 $|\\Delta I| \\leq 1.5$。由于 $\\Delta I$ 必须是整数，我们有 $\\Delta I \\in \\{-1, 0, 1\\}$。\n同样的逻辑适用于 $y$ 方向，所以 $\\Delta J \\in \\{-1, 0, 1\\}$。\n这意味着一个粗网格节点 $(I, J)$ 与每个满足 $I-I' \\in \\{-1, 0, 1\\}$ 和 $J-J' \\in \\{-1, 0, 1\\}$ 的粗网格节点 $(I', J')$ 耦合。这构成了一个 $3 \\times 3$ 的格式，通常称为九点格式。$A_H$ 的每个内部行的非零元数量为 $s_H = 9$。\n\n现在我们计算算子复杂度。\n\n**情况1：伽辽金粗化 ($C_{\\mathrm{RAP}}$)**\n在这种情况下，最细层的矩阵 $A_{h_0}$ 具有 $5$ 点格式，因此 $s_0=5$。对于 $\\ell \\ge 1$ 的所有后续粗网格矩阵 $A_{h_\\ell}$ 都是通过伽辽金乘积 $A_{h_\\ell} = R A_{h_{\\ell-1}} P$ 形成的。正如我们所展示的，这导致了一个 $9$ 点格式。所以，对于所有 $\\ell \\ge 1$，$s_\\ell = 9$。\n\n算子复杂度为\n$$\nC_{\\mathrm{RAP}} = \\sum_{\\ell=0}^{\\infty} \\frac{\\operatorname{nnz}(A_{h_\\ell})}{\\operatorname{nnz}(A_{h_0})} \\approx \\sum_{\\ell=0}^{\\infty} \\frac{n_\\ell s_\\ell}{n_0 s_0}\n$$\n我们将 $\\ell=0$ 的项分离开来：\n$$\nC_{\\mathrm{RAP}} \\approx \\frac{n_0 s_0}{n_0 s_0} + \\sum_{\\ell=1}^{\\infty} \\frac{n_\\ell s_\\ell}{n_0 s_0} = 1 + \\sum_{\\ell=1}^{\\infty} \\frac{(n_0 / 4^\\ell) \\cdot 9}{n_0 \\cdot 5}\n$$\n$$\nC_{\\mathrm{RAP}} = 1 + \\frac{9}{5} \\sum_{\\ell=1}^{\\infty} \\left(\\frac{1}{4}\\right)^\\ell\n$$\n该和是一个几何级数 $\\sum_{k=1}^{\\infty} r^k = r/(1-r)$。当 $r = 1/4$ 时，和为 $(1/4)/(1 - 1/4) = (1/4)/(3/4) = 1/3$。\n$$\nC_{\\mathrm{RAP}} = 1 + \\frac{9}{5} \\cdot \\frac{1}{3} = 1 + \\frac{3}{5} = \\frac{8}{5}\n$$\n\n**情况2：重新离散化 ($C_{\\mathrm{red}}$)**\n在这种情况下，每一层上的算子都是通过在该层的网格上重新离散化偏微分方程得到的。这意味着每个矩阵 $A_{h_\\ell}$ 都具有相同的 $5$ 点格式。因此，对于所有 $\\ell \\ge 0$，$s_\\ell = 5$。\n算子复杂度为\n$$\nC_{\\mathrm{red}} = \\sum_{\\ell=0}^{\\infty} \\frac{\\operatorname{nnz}(A_{h_\\ell})}{\\operatorname{nnz}(A_{h_0})} \\approx \\sum_{\\ell=0}^{\\infty} \\frac{n_\\ell s_\\ell}{n_0 s_0} = \\sum_{\\ell=0}^{\\infty} \\frac{(n_0 / 4^\\ell) \\cdot 5}{n_0 \\cdot 5}\n$$\n$$\nC_{\\mathrm{red}} = \\sum_{\\ell=0}^{\\infty} \\left(\\frac{1}{4}\\right)^\\ell\n$$\n这是一个几何级数 $\\sum_{k=0}^{\\infty} r^k = 1/(1-r)$。当 $r = 1/4$ 时，和为 $1/(1 - 1/4) = 1/(3/4) = 4/3$。\n$$\nC_{\\mathrm{red}} = \\frac{4}{3}\n$$\n\n**最终比率**\n最后，我们计算比率 $\\rho = C_{\\mathrm{RAP}}/C_{\\mathrm{red}}$：\n$$\n\\rho = \\frac{8/5}{4/3} = \\frac{8}{5} \\cdot \\frac{3}{4} = \\frac{24}{20} = \\frac{6}{5}\n$$\n这表明，与重新离散化相比，由于格式增长，使用伽辽金粗算子会使总算子复杂度增加一个因子 $6/5$。", "answer": "$$\n\\boxed{\\frac{6}{5}}\n$$", "id": "2581572"}, {"introduction": "在研究了粗网格算子之后，我们将注意力转向另一个关键的多重网格组件：光滑子(smoother)。对于各向异性扩散等问题，其中一个方向上的耦合远强于其他方向，标准的点光滑子（如Jacobi或Gauss-Seidel）会失效。本练习将演示如何设计一个更稳健的光滑子（行Gauss-Seidel）来适应这类问题，并利用局部傅里叶分析(Local Fourier Analysis, LFA)来证明其有效性[@problem_id:2581527]，其光滑因子在各向异性极强时仍保持稳定。", "problem": "考虑一个无限、均匀的矩形网格上的各向异性扩散模型问题，网格尺寸为 $h$：\n$$\n- \\frac{\\partial^2 u}{\\partial x^2} - \\epsilon \\frac{\\partial^2 u}{\\partial y^2} = f \\quad \\text{in } \\mathbb{R}^2,\n$$\n其中 $0  \\epsilon \\ll 1$。设在均匀笛卡尔网格上使用 $\\mathbb{Q}_1$ (双线性) 协调有限元来离散化弱形式，并考虑无限网格上的标准刚度算子。对于这种结构化设置，您可以使用一个众所周知的事实，即得到的刚度算子与标准的 $5$ 点有限差分离散具有相同的符号。将离散算子 $A$ 写成作用于网格函数 $\\{u_{i,j}\\}_{(i,j)\\in\\mathbb{Z}^2}$ 的常规 $5$ 点模板形式：\n$$\n(Au)_{i,j} \\;=\\; -u_{i-1,j} + \\left(2\\right)u_{i,j} - u_{i+1,j} \\;+\\; \\epsilon\\left( -u_{i,j-1} + \\left(2\\right)u_{i,j} - u_{i,j+1} \\right).\n$$\n\n- 从第一性原理（双线性有限元的刚度形式及其在无限、均匀网格上的平移不变性）出发，论证当 $0  \\epsilon \\ll 1$ 时，强耦合方向是 $x$ 方向。\n- 沿强耦合方向（即，在固定的 $j$ 处沿 $x$ 线）推导线高斯-赛德尔（GS）光滑子。具体来说，写出在 $y$ 索引 $j$ 上进行前向扫描的精确线求解更新，即，对于每个固定的 $j$，沿 $i$ 求解一个三对角系统，您必须指明其对角块。您的答案必须明确给出在每条线上求解的一维三对角“模板”，以及右端项如何依赖于 $y$ 方向上的相邻线，并指明哪个相邻线使用最近更新的值。\n- 在无限网格上执行局部傅里叶分析（LFA），推导此线 GS 光滑子一次前向扫描的误差传播算子的标量傅里叶符号 $\\tilde{E}(\\theta_x,\\theta_y)$，其中 $(\\theta_x,\\theta_y)\\in[-\\pi,\\pi]^2$ 是傅里叶频率。清楚地说明离散算子 $A$ 的符号以及通过您的分裂得到的线 GS 误差传播算子的符号。\n- 对于在 $y$ 方向进行半粗化（粗网格仅在 $y$ 方向上分辨率减半）的多重网格方法，相关的高频集是 $\\Theta_{\\mathrm{H}}=\\{(\\theta_x,\\theta_y): \\theta_x\\in[-\\pi,\\pi],\\, \\theta_y\\in[\\pi/2,\\pi]\\}$。使用您的 LFA 符号，确定最坏情况下的光滑因子\n$$\n\\mu_{\\mathrm{smooth}}(\\epsilon) \\;=\\; \\sup_{(\\theta_x,\\theta_y)\\in\\Theta_{\\mathrm{H}}} \\left| \\tilde{E}(\\theta_x,\\theta_y) \\right|.\n$$\n\n请给出极限 $\\displaystyle \\lim_{\\epsilon\\to 0^+} \\mu_{\\mathrm{smooth}}(\\epsilon)$ 的精确封闭形式值作为您的最终答案。不需要四舍五入。最终答案必须是单个表达式。", "solution": "我们从各向异性扩散算子的弱形式开始，\n$$\na(u,v) \\;=\\; \\int_{\\mathbb{R}^2} \\left( \\frac{\\partial u}{\\partial x}\\frac{\\partial v}{\\partial x} + \\epsilon \\frac{\\partial u}{\\partial y}\\frac{\\partial v}{\\partial y} \\right)\\,\\mathrm{d}x\\,\\mathrm{d}y,\n$$\n以及均匀笛卡尔网格上的 $\\mathbb{Q}_1$（双线性）有限元空间。在无限、均匀的网格上，组装的刚度算子是平移不变的，并且与 $- \\partial_{xx} - \\epsilon \\partial_{yy}$ 的标准 $5$ 点有限差分算子一致（相差一个与局部傅里叶分析无关的常数 $h^{-2}$ 缩放）。因此，作用于网格函数 $\\{u_{i,j}\\}$ 的离散算子 $A$ 具有 5 点模板\n$$\n(Au)_{i,j} \\;=\\; -u_{i-1,j} + \\left(2\\right)u_{i,j} - u_{i+1,j} \\;+\\; \\epsilon\\left( -u_{i,j-1} + \\left(2\\right)u_{i,j} - u_{i,j+1} \\right).\n$$\n\n强耦合方向。$x$ 方向的刚度项量级为 $\\mathcal{O}(1)$，而 $y$ 方向的刚度项量级为 $\\mathcal{O}(\\epsilon)$。因此，当 $0  \\epsilon\\ll 1$ 时，$x$ 方向的耦合占主导地位，强耦合方向是 $x$ 方向。\n\n沿 $x$ 线的线高斯-赛德尔（GS）光滑子。通过在固定的线索引 $j$ 处对 $x$ 和 $y$ 的贡献进行分组来重写 $A$，我们引入一维 $x$ 线算子 $A_x$：\n$$\n(A_x u)_{i,j} \\;=\\; -u_{i-1,j} + \\left(2\\right)u_{i,j} - u_{i+1,j},\n$$\n并观察到\n$$\n(Au)_{i,j} \\;=\\; (A_x u)_{i,j} \\;+\\; \\epsilon\\left(2 u_{i,j} - u_{i,j-1} - u_{i,j+1}\\right).\n$$\n相对于线 $j$ 的分块形式中，对角块是\n$$\nB \\;=\\; A_x \\;+\\; \\left(2\\epsilon\\right) I,\n$$\n非对角块是\n$$\nC_{\\mathrm{lower}} \\;=\\; -\\epsilon I \\quad \\text{(与线 } j-1\\text{ 的耦合)}, \\qquad C_{\\mathrm{upper}} \\;=\\; -\\epsilon I \\quad \\text{(与线 } j+1\\text{ 的耦合)}.\n$$\n在线索引 $j$ 上的前向高斯-赛德尔扫描使用线 $j-1$ 上的最新可用值和线 $j+1$ 上的旧值。因此，对于每个固定的 $j$，线更新 $u^{\\mathrm{new}}_j$ 被定义为三对角系统的精确解\n$$\n\\Big( A_x \\;+\\; \\left(2\\epsilon\\right) I \\Big)\\, u^{\\mathrm{new}}_j \\;=\\; \\epsilon\\, u^{\\mathrm{new}}_{j-1} \\;+\\; \\epsilon\\, u^{\\mathrm{old}}_{j+1} \\;+\\; \\text{(若有，则加上右端项)}.\n$$\n就沿线的“模板”而言，左侧算子是一维三对角模板\n$$\n\\big[-1,\\; 2+2\\epsilon,\\; -1\\big]\n$$\n作用于 $x$ 方向的邻居 $\\{u_{i-1,j},u_{i,j},u_{i+1,j}\\}$，而右端项包含来自相邻线 $j-1$ 和 $j+1$ 的逐线贡献，其中 $u_{j-1}$ 取其最近更新的值，$u_{j+1}$ 取其旧值。\n\n局部傅里叶分析 (LFA)。在无限网格上，傅里叶模式\n$$\n\\varphi_{\\boldsymbol{\\theta}}(i,j) \\;=\\; \\exp\\!\\big(\\mathrm{i} (i\\,\\theta_x + j\\,\\theta_y)\\big), \\qquad (\\theta_x,\\theta_y)\\in[-\\pi,\\pi]^2,\n$$\n可对角化所有平移不变算子。$A_x$ 的傅里叶符号是\n$$\n\\tilde{A}_x(\\theta_x) \\;=\\; 2 - 2\\cos(\\theta_x) \\;=\\; 4 \\sin^2\\!\\left(\\frac{\\theta_x}{2}\\right).\n$$\n因此对角块 $B$ 的符号是\n$$\n\\tilde{B}(\\theta_x) \\;=\\; \\tilde{A}_x(\\theta_x) \\;+\\; \\left(2\\epsilon\\right),\n$$\n非对角块的符号是\n$$\n\\widetilde{C}_{\\mathrm{lower}}(\\theta_y) \\;=\\; -\\epsilon\\, \\exp(-\\mathrm{i}\\theta_y), \\qquad \\widetilde{C}_{\\mathrm{upper}}(\\theta_y) \\;=\\; -\\epsilon\\, \\exp(+\\mathrm{i}\\theta_y).\n$$\n对于 $j$ 上的前向分块高斯-赛德尔扫描，误差传播算子 $E$ 逐线满足\n$$\ne^{\\mathrm{new}}_j \\;=\\; - \\big(B + C_{\\mathrm{lower}}\\big)^{-1} C_{\\mathrm{upper}}\\, e^{\\mathrm{old}}_{j+1}.\n$$\n因此，作用于频率为 $(\\theta_x,\\theta_y)$ 的傅里叶模式的误差传播算子的标量符号是\n$$\n\\tilde{E}(\\theta_x,\\theta_y) \\;=\\; - \\frac{\\widetilde{C}_{\\mathrm{upper}}(\\theta_y)}{\\tilde{B}(\\theta_x) + \\widetilde{C}_{\\mathrm{lower}}(\\theta_y)} \\;=\\; \\frac{\\epsilon\\, \\exp(+\\mathrm{i}\\theta_y)}{\\tilde{A}_x(\\theta_x) + \\left(2\\epsilon\\right) - \\epsilon\\, \\exp(-\\mathrm{i}\\theta_y)}.\n$$\n其模为\n$$\n\\left|\\tilde{E}(\\theta_x,\\theta_y)\\right| \\;=\\; \\frac{\\epsilon}{\\left|\\, \\tilde{A}_x(\\theta_x) + \\left(2\\epsilon\\right) - \\epsilon\\, \\exp(-\\mathrm{i}\\theta_y) \\,\\right|}.\n$$\n\ny 方向半粗化的最坏情况光滑因子。在 $y$ 方向进行半粗化时，高频集为 $\\Theta_{\\mathrm{H}}=\\{(\\theta_x,\\theta_y): \\theta_x\\in[-\\pi,\\pi],\\; \\theta_y\\in[\\pi/2,\\pi]\\}$。我们寻求\n$$\n\\mu_{\\mathrm{smooth}}(\\epsilon) \\;=\\; \\sup_{(\\theta_x,\\theta_y)\\in\\Theta_{\\mathrm{H}}} \\left|\\tilde{E}(\\theta_x,\\theta_y)\\right|.\n$$\n记 $\\tilde{A}_x(\\theta_x)=4\\sin^2(\\theta_x/2) \\equiv s_x^2$，其中 $s_x\\in[0,2]$。则\n$$\n\\left|\\tilde{E}(\\theta_x,\\theta_y)\\right| \\;=\\; \\frac{\\epsilon}{\\sqrt{\\left(s_x^2 + 2\\epsilon - \\epsilon\\cos\\theta_y\\right)^2 + \\left(\\epsilon \\sin\\theta_y\\right)^2}}.\n$$\n对于固定的 $\\epsilon0$，分母随 $s_x^2$ 单调增加，因此在 $\\theta_x\\in[-\\pi,\\pi]$ 上的最坏情况发生在 $s_x^2=0$ 时，即 $\\theta_x=0$。代入 $s_x^2=0$ 得到\n$$\n\\left|\\tilde{E}(0,\\theta_y)\\right| \\;=\\; \\frac{\\epsilon}{\\left|\\, 2\\epsilon - \\epsilon \\exp(-\\mathrm{i}\\theta_y) \\,\\right|} \\;=\\; \\frac{1}{\\left|\\, 2 - \\exp(-\\mathrm{i}\\theta_y) \\,\\right|}.\n$$\n因此对 $\\epsilon$ 的依赖性消除了，我们必须在 $\\theta_y\\in[\\pi/2,\\pi]$ 上最大化函数\n$$\ng(\\theta_y) \\;=\\; \\frac{1}{\\left|\\, 2 - \\exp(-\\mathrm{i}\\theta_y) \\,\\right|}.\n$$\n计算\n$$\n\\left|\\, 2 - \\exp(-\\mathrm{i}\\theta_y) \\,\\right|^2 \\;=\\; \\left(2 - \\cos\\theta_y\\right)^2 + \\left(\\sin\\theta_y\\right)^2 \\;=\\; 4 - 4\\cos\\theta_y + \\cos^2\\theta_y + \\sin^2\\theta_y \\;=\\; 5 - 4\\cos\\theta_y.\n$$\n在 $\\theta_y\\in[\\pi/2,\\pi]$ 上，我们有 $\\cos\\theta_y\\in[-1,0]$，所以 $5 - 4\\cos\\theta_y$ 在 $\\theta_y=\\pi/2$ 时取得最小值，此时 $\\cos\\theta_y=0$。因此，\n$$\n\\sup_{\\theta_y\\in[\\pi/2,\\pi]} g(\\theta_y) \\;=\\; \\frac{1}{\\sqrt{5 - 4\\cdot 0}} \\;=\\; \\frac{1}{\\sqrt{5}}.\n$$\n因此，\n$$\n\\mu_{\\mathrm{smooth}}(\\epsilon) \\;=\\; \\sup_{(\\theta_x,\\theta_y)\\in\\Theta_{\\mathrm{H}}} \\left|\\tilde{E}(\\theta_x,\\theta_y)\\right| \\;=\\; \\frac{1}{\\sqrt{5}} \\quad \\text{对于所有 } \\epsilon\\in(0,1],\n$$\n特别地，\n$$\n\\lim_{\\epsilon\\to 0^+} \\mu_{\\mathrm{smooth}}(\\epsilon) \\;=\\; \\frac{1}{\\sqrt{5}}.\n$$\n这表明沿强耦合（$x$）方向的线高斯-赛德尔光滑子，对于 $y$ 方向半粗化，在相关高频集上具有一个与 $\\epsilon$ 无关且严格小于 $1$ 的光滑因子，从而证明了它对于 $\\epsilon\\ll 1$ 的有效性。", "answer": "$$\\boxed{\\frac{1}{\\sqrt{5}}}$$", "id": "2581527"}]}