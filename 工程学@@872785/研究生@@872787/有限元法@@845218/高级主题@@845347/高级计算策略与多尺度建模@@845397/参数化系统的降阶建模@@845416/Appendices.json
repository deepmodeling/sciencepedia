{"hands_on_practices": [{"introduction": "本征正交分解（Proper Orthogonal Decomposition, POD）是构建降阶模型（Reduced-Order Model, ROM）基函数的一种基础且强大的数据驱动方法。然而，POD基的“最优性”取决于我们如何定义状态空间中的内积。本练习旨在通过一个具体的有限元（FE）离散化案例，让您亲手计算和对比在欧几里得内积与由质量矩阵诱导的$L^{2}$内积下得到的POD模态，从而深刻理解内积选择对模型物理一致性和网格无关性的决定性影响 ([@problem_id:2593071])。", "problem": "考虑区间 $(0,1)$ 上的一维瞬态扩散方程 $u_{t} - \\kappa u_{xx} = 0$，其边界条件为齐次狄利克雷边界条件 $u(0,t)=u(1,t)=0$，扩散系数 $\\kappa0$ 为常数。使用一个协调线性有限元（FE）离散化，该离散化基于一个非均匀网格，网格包含三个长度分别为 $h_{1}=0.2$, $h_{2}=0.3$, $h_{3}=0.5$ 的单元。消除边界自由度后，存在两个内部节点基函数，时间 $t$ 的半离散状态由系数向量 $a(t)\\in\\mathbb{R}^{2}$ 表示。假设在时间 $t_{1},t_{2}$ 收集了两个快照，得到的系数向量为 $s_{1}=\\begin{bmatrix}0.8 \\\\ 0.2\\end{bmatrix}$ 和 $s_{2}=\\begin{bmatrix}0.4 \\\\ 1.2\\end{bmatrix}$。\n\n本征正交分解（POD）模态取决于状态空间中内积的选择。两种常用于有限元系数向量的内积是：\n- $\\mathbb{R}^{2}$ 上的欧几里得内积，以及\n- 由有限元质量矩阵诱导的内积，它离散了连续的 $L^{2}(0,1)$ 内积。\n\n选择所有关于内积选择对所得 POD 模态的影响以及关于上述一维扩散示例的正确陈述。\n\nA. 对于具有非标准正交基函数的有限元离散化，使用质量矩阵诱导的内积产生的 POD 模态近似于 $L^{2}(0,1)$-标准正交模态，并且在基函数缩放和网格加密下是不变的；在系数向量上使用欧几里得内积产生的模态可能依赖于基函数的任意缩放和网格的划分方式。\n\nB. 对于给定的网格和快照 $s_{1}$ 和 $s_{2}$，使用质量矩阵内积计算的主导快照-POD模态的系数与 $\\begin{bmatrix}1.74 \\\\ 3.02\\end{bmatrix}$ 成比例，而使用欧几里得内积计算的模态的系数与 $\\begin{bmatrix}1.65 \\\\ 2.74\\end{bmatrix}$ 成比例。\n\nC. 对于任意快照选择和任意网格，欧几里得内积和质量矩阵内积产生相同的 POD 子空间，当且仅当网格是均匀的。\n\nD. 在系数向量上使用欧几里得内积保证了 POD 模态关于连续 $L^{2}(0,1)$ 内积是标准正交的，条件是有限元基张成 $H_{0}^{1}(0,1)$。\n\nE. 当使用质量矩阵内积时，快照法中出现的相关矩阵是 $C=U^{T}U$，其中 $U=[\\,s_{1}\\;\\;s_{2}\\,]\\in\\mathbb{R}^{2\\times 2}$ 是快照矩阵。", "solution": "问题陈述具有科学依据，是适定的，并包含足够的信息以进行严格分析。所有提供的数据都是一致的。该问题是有效的。\n\n本征正交分解（POD）方法旨在为一组给定的数据（称为快照）找到一个最优的低维基。在有限元（FE）分析的背景下，快照可以是在不同时间实例的有限元解的系数向量。最优性的概念，以及由此产生的 POD 基，取决于在这些系数向量空间上选择的内积。\n\n解 $u(x,t)$ 的有限元近似由 $u_h(x,t) = \\sum_{i=1}^{N} a_i(t)\\phi_i(x)$ 给出，其中 $\\{\\phi_i(x)\\}_{i=1}^N$ 是有限元基函数（这里，对于 $N=2$ 个内部节点），而 $a(t) = [a_1(t), a_2(t)]^T$ 是系数向量。在时间 $t_k$ 的快照是系数向量 $s_k = a(t_k)$。对应的函数是 $u_k(x) = \\sum_i (s_k)_i \\phi_i(x)$。\n\n两个有限元函数 $u_h(x) = \\sum_i a_i \\phi_i(x)$ 和 $v_h(x) = \\sum_j b_j \\phi_j(x)$ 之间的连续 $L^2(0,1)$ 内积是：\n$$ \\langle u_h, v_h \\rangle_{L^2} = \\int_{0}^{1} u_h(x) v_h(x) dx = \\sum_{i,j} a_i b_j \\int_{0}^{1} \\phi_i(x) \\phi_j(x) dx = a^T M b $$\n其中 $M$ 是质量矩阵，其元素为 $M_{ij} = \\int_{0}^{1} \\phi_i(x) \\phi_j(x) dx$。这定义了系数空间上的质量矩阵诱导内积，$\\langle a, b \\rangle_M = a^T M b$。\n\n快照-POD 方法寻求作为快照线性组合的 POD 模态。这导致了相关矩阵 $C$ 的一个特征值问题 $C v = \\lambda v$。POD 模态（作为系数向量）随后被计算为 $\\psi_k \\propto S v_k$，其中 $S = [s_1, s_2, \\dots]$ 是快照向量矩阵，而 $v_k$ 是 $C$ 的特征向量。\n\n相关矩阵的元素是快照函数的内積：$C_{ij} = \\langle u_i, u_j \\rangle$。\n- 如果我们使用质量矩阵内积，那么 $C_{ij} = s_i^T M s_j$，所以 $C = S^T M S$。\n- 如果我们使用欧几里得内积，我们实际上是设置 $M=I$，所以 $C_{ij} = s_i^T s_j$，且 $C = S^T S$。\n\n我们现在来评估每个陈述。\n\n**A. 对于具有非标准正交基函数的有限元离散化，使用质量矩阵诱导的内积产生的 POD 模态近似于 $L^{2}(0,1)$-标准正交模态，并且在基函数缩放和网格加密下是不变的；在系数向量上使用欧几里得内积产生的模态可能依赖于基函数的任意缩放和网格的划分方式。**\n\n该陈述阐述了使用质量矩阵内积的基本动机。\n1.  **质量矩阵内积：** 根据构造，使用此内积得到的 POD 系数向量 $\\psi_k$ 关于此内积是标准正交的：$\\psi_k^T M \\psi_j = \\delta_{kj}$。这等价于相应的有限元函数 $\\Psi_k(x) = \\sum_i (\\psi_k)_i \\phi_i(x)$ 在 $L^2(0,1)$ 中是标准正交的。这种方法提供了连续 POD 问题的一致离散化。因此，结果对于网格加密是鲁棒的（它们收敛于连续模态），并且对于像基函数缩放这样的任意选择是不变的。“近似”一词的使用是可以接受的，因为整个有限元解是在有限维空间中的一个近似。\n2.  **欧几里得内积：** 这个选择 $\\langle a,b \\rangle = a^T b$ 平等地对待所有系数。然而，基函数 $\\phi_i(x)$ 不是 $L^2$-标准正交的，并且它们的范数 $\\|\\phi_i\\|_{L^2}^2 = M_{ii}$ 通常随局部网格尺寸而变化。在函数空间中使用欧几里得内积等价于使用一个加权的 $L^2$ 内积，其权重依赖于网格，而这是任意的。基函数缩放或网格划分（非均匀性）的改变将改变快照系数向量以及它们之间的欧几里得内积，从而导致不同的 POD 模态。这种选择缺乏与 underlying 连续问题的物理和数学一致性。\n\n该陈述正确地总结了这些关键性质。\n结论：**正确**。\n\n**B. 对于给定的网格和快照 $s_{1}$ 和 $s_{2}$，使用质量矩阵内积计算的主导快照-POD模态的系数与 $\\begin{bmatrix}1.74\\\\3.02\\end{bmatrix}$ 成比例，而使用欧几里得内积计算的模态的系数与 $\\begin{bmatrix}1.65\\\\2.74\\end{bmatrix}$ 成比例。**\n\n这需要直接计算。网格由3个长度为 $h_1=0.2$, $h_2=0.3$, $h_3=0.5$ 的单元组成。两个内部节点位于 $x_1=0.2$ 和 $x_2=0.5$。线性“帽子”基函数是 $\\phi_1(x)$ 和 $\\phi_2(x)$。\n\n线性单元的质量矩阵 $M$ 由 $M_{ii} = (h_{left}+h_{right})/3$ 和 $M_{ij} = h_{common}/6$ 给出。\n$M_{11} = (h_1+h_2)/3 = (0.2+0.3)/3 = 0.5/3$。\n$M_{22} = (h_2+h_3)/3 = (0.3+0.5)/3 = 0.8/3$。\n$M_{12} = M_{21} = h_2/6 = 0.3/6 = 0.05 = 1/20$。\n所以，$M = \\begin{bmatrix} 1/6   1/20 \\\\ 1/20  4/15 \\end{bmatrix} = \\frac{1}{60} \\begin{bmatrix} 10   3 \\\\ 3   16 \\end{bmatrix}$。\n\n快照矩阵是 $S = [s_1, s_2] = \\begin{bmatrix} 0.8  0.4 \\\\ 0.2  1.2 \\end{bmatrix}$。\n\n_情况1：欧几里得内积_\n相关矩阵是 $C_E = S^T S = \\begin{bmatrix} 0.8  0.2 \\\\ 0.4  1.2 \\end{bmatrix} \\begin{bmatrix} 0.8  0.4 \\\\ 0.2  1.2 \\end{bmatrix} = \\begin{bmatrix} 0.68  0.56 \\\\ 0.56  1.60 \\end{bmatrix}$。\n最大特征值是 $\\lambda_1 \\approx 1.8647$。对应的特征向量 $v_1$ 满足 $(C_E - \\lambda_1 I)v_1 = 0$，这给出 $v_1 \\propto \\begin{bmatrix} 1 \\\\ 2.1155 \\end{bmatrix}$。\n主导的 POD 模态是 $\\psi_1 \\propto S v_1 = \\begin{bmatrix} 0.8  0.4 \\\\ 0.2  1.2 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 2.1155 \\end{bmatrix} = \\begin{bmatrix} 1.6462 \\\\ 2.7386 \\end{bmatrix}$。\n这与 $\\begin{bmatrix} 1.65 \\\\ 2.74 \\end{bmatrix}$ 成比例，比率为 $2.74/1.65 \\approx 1.661$ 和 $2.7386/1.6462 \\approx 1.664$。值匹配得很好。\n\n_情况2：质量矩阵内积_\n相关矩阵是 $C_M = S^T M S$。\n$M S = \\frac{1}{60} \\begin{bmatrix} 10  3 \\\\ 3  16 \\end{bmatrix} \\begin{bmatrix} 0.8  0.4 \\\\ 0.2  1.2 \\end{bmatrix} = \\frac{1}{60} \\begin{bmatrix} 8.6  7.6 \\\\ 5.6  20.4 \\end{bmatrix}$。\n$C_M = S^T(M S) = \\begin{bmatrix} 0.8  0.2 \\\\ 0.4  1.2 \\end{bmatrix} \\frac{1}{60} \\begin{bmatrix} 8.6  7.6 \\\\ 5.6  20.4 \\end{bmatrix} = \\frac{1}{60} \\begin{bmatrix} 8.0  10.16 \\\\ 10.16  27.52 \\end{bmatrix}$。\n令 $C'_M = 60 C_M$。$C'_M$ 的最大特征值是 $\\lambda'_1 \\approx 31.848$。对应的特征向量 $v_1$ 满足 $(C'_M - \\lambda'_1 I)v_1 = 0$，这给出 $v_1 \\propto \\begin{bmatrix} 1 \\\\ 2.3473 \\end{bmatrix}$。\n主导的 POD 模态是 $\\psi_1 \\propto S v_1 = \\begin{bmatrix} 0.8  0.4 \\\\ 0.2  1.2 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 2.3473 \\end{bmatrix} = \\begin{bmatrix} 1.7389 \\\\ 3.0168 \\end{bmatrix}$。\n这与 $\\begin{bmatrix} 1.74 \\\\ 3.02 \\end{bmatrix}$ 成比例，比率为 $3.02/1.74 \\approx 1.736$ 和 $3.0168/1.7389 \\approx 1.735$。值匹配得非常好。\n\n计算证实了该陈述。\n结论：**正确**。\n\n**C. 对于任意快照选择和任意网格，欧几里得内积和质量矩阵内积产生相同的 POD 子空间，当且仅当网格是均匀的。**\n\nPOD 模态是从相关矩阵 $C_E = S^T S$ 和 $C_M = S^T M S$ 的特征向量派生出来的。有序的 POD 子空间（最优的 k 维子空间）将是相同的，当且仅当这两个矩阵共享相同的特征向量。两个矩阵共享相同的特征向量当且仅当它们可交换：$C_E C_M = C_M C_E$。\n所以，$(S^T S)(S^T M S) = (S^T M S)(S^T S)$。这必须对“任意快照选择” $S$ 都成立。\n这个强大的条件意味着矩阵 M 必须是单位矩阵的标量倍，即对于某个标量 $c>0$，有 $M = cI$。\n\n现在我们必须检查对于线性有限元基函数，何时 $M=cI$。\n$M_{ii} = (h_{left} + h_{right})/3$ 且对于 $i \\neq j$，$M_{ij} = h_{common}/6$。\n要使 M 为对角矩阵，所有非对角元素必须为零。这要求 $M_{i,i+1} = h_{i+1}/6 = 0$，意味着任意两个节点之间的单元长度必须为零，这是不可能的。标准有限元基函数的质量矩阵从来不是对角矩阵，更不用说是单位矩阵的倍数了。\n\n因此，对于任何网格，无论是均匀还是非均匀的，POD 子空间相同的条件（$M=cI$）都永远不会满足。\n陈述“P 当且仅当 Q”是错误的，其中 P 是“子空间相同”，Q 是“网格均匀”。P 总是假的，而 Q 可以是真的也可以是假的。如果 Q 是真的（均匀网格），陈述变为“假当且仅当真”，这是假的。如果 Q 是假的（非均匀网格），它变为“假当且仅当假”，这是真的。由于它并非在所有情况下都为真（例如均匀网格），因此整个“当且仅当”陈述是假的。\n结论：**不正确**。\n\n**D. 在系数向量上使用欧几里得内积保证了 POD 模态关于连续 $L^{2}(0,1)$ 内积是标准正交的，条件是有限元基张成 $H_{0}^{1}(0,1)$。**\n\n令 $\\{\\psi_k\\}$ 为使用欧几里得内积获得的 POD 模态的系数向量。根据构造，它们是欧几里得标准正交的：$\\psi_k^T \\psi_j = \\delta_{kj}$。\n相应的有限元函数是 $\\Psi_k(x) = \\sum_i (\\psi_k)_i \\phi_i(x)$。\n它们的 $L^2(0,1)$ 内积是 $\\langle \\Psi_k, \\Psi_j \\rangle_{L^2} = \\psi_k^T M \\psi_j$。\n该陈述声称 $\\psi_k^T M \\psi_j = \\delta_{kj}$ 是保证的。\n这将意味着 $\\psi_k^T M \\psi_j = \\psi_k^T I \\psi_j$。这不是真的，除非 $M=I$ 或者向量 $\\{\\psi_k\\}$ 恰好是 M 的特征向量。正如在 C 中所确立的，$M \\neq I$，并且没有理由 POD 模态（它依赖于快照 S）会是质量矩阵 M 的特征向量。因此，该陈述是错误的。使用质量矩阵诱导的内积才能保证此性质，而不是欧几里得内积。关于张成 $H^1_0(0,1)$ 的条件对于此有限元问题是标准的，并且不改变结论。\n结论：**不正确**。\n\n**E. 当使用质量矩阵内积时，快照法中出现的相关矩阵是 $C=U^{T}U$，其中 $U=[\\,s_{1}\\;\\;s_{2}\\,]\\in\\mathbb{R}^{2\\times 2}$ 是快照矩阵。**\n\n这里符号 U 是快照矩阵的标准表示，我们之前用 S 表示。快照法通过求解相关矩阵 C 的特征值问题来寻找 POD 模态。该矩阵的元素是快照函数的内积，$C_{ij} = \\langle u_i, u_j \\rangle$。\n问题指定了“当使用质量矩阵内积时”。这意味着系数向量空间上的内积被选为连续 $L^2(0,1)$ 内积的离散表示。\n因此，$C_{ij} = \\langle u_i, u_j \\rangle_{L^2} = s_i^T M s_j$。\n以矩阵形式，这是 $C = S^T M S$，或者使用问题的符号表示，$C=U^T M U$。\n该陈述声称 $C = U^T U$。这是对应于系数向量上欧几里得内积的相关矩阵。该陈述错误地识别了质量矩阵内积的相关矩阵。\n结论：**不正确**。", "answer": "$$\\boxed{AB}$$", "id": "2593071"}, {"introduction": "与完全依赖于“快照”数据的POD方法不同，降阶基（Reduced Basis, RB）方法中的贪婪算法提供了一种目标导向的、自适应的基函数构造策略。该算法通过在参数空间中迭代搜索当前降阶模型误差最大的点，并将其对应的全阶解加入基函数库，从而高效地逼近整个解流形。本练习将引导您模拟贪婪算法的一个核心迭代步骤，通过计算和比较基于残差的误差指示器，来选择下一个要添加到基中的参数点 ([@problem_id:2593056])。", "problem": "考虑一个通过有限元 (FE) 方法离散化的参数化强制线性椭圆问题，对于每个参数值 $\\,\\mu \\in \\mathbb{R}_{+}\\,$，得到线性系统 $\\,A(\\mu) u(\\mu) = f\\,$，其具有仿射分解 $\\,A(\\mu) = \\Theta_{1}(\\mu) A_{1} + \\Theta_{2}(\\mu) A_{2}\\,$。假设 $\\,A_{1} \\in \\mathbb{R}^{3 \\times 3}\\,$ 和 $\\,A_{2} \\in \\mathbb{R}^{3 \\times 3}\\,$ 是对称正定的，参数函数为 $\\,\\Theta_{1}(\\mu) = \\mu\\,$ 和 $\\,\\Theta_{2}(\\mu) = 1\\,$，右端项为 $\\,f \\in \\mathbb{R}^{3}\\,$。降阶基 (RB) 贪心程序从一个初始种子参数 $\\,\\mu_{1}\\,$ 和一个训练集 $\\,\\Xi_{\\mathrm{train}}\\,$ 开始。在一次贪心迭代中，对于每个 $\\,\\mu \\in \\Xi_{\\mathrm{train}}\\,$，在当前 RB 空间中计算降阶伽辽金解 $\\,u_{N}(\\mu)\\,$ 和基于残差的误差指示器\n$$\n\\eta(\\mu) \\;=\\; \\frac{\\|r(\\mu)\\|_{V^{*}}}{\\alpha_{\\mathrm{LB}}(\\mu)} \\,,\n$$\n其中 $\\,r(\\mu) = f - A(\\mu) u_{N}(\\mu)\\,$，$\\,\\|\\cdot\\|_{V^{*}}\\,$ 是由 FE 试验空间范数导出的对偶范数，而 $\\,\\alpha_{\\mathrm{LB}}(\\mu)\\,$ 是 $\\,A(\\mu)\\,$ 的强制性常数的一个可靠下界。贪心更新选择在 $\\,\\Xi_{\\mathrm{train}}\\,$ 上使 $\\,\\eta(\\mu)\\,$ 最大化的参数 $\\,\\mu^{\\star}\\,$。\n\n给定以下具体数据：\n- $\\,A_{1} = \\mathrm{diag}(2,3,4)\\,$, $\\,A_{2} = I_{3}\\,$, and $\\,f = [1,\\,1,\\,1]^{T}\\,$.\n- 试验空间上的 FE 内积是 $\\,\\mathbb{R}^{3}\\,$ 上的标准欧几里得内积，因此对偶范数 $\\,\\|r(\\mu)\\|_{V^{*}}\\,$ 等于欧几里得范数 $\\,\\|r(\\mu)\\|_{2}\\,$。\n- 初始种子为 $\\,\\mu_{1} = 1\\,$，RB 空间是一维的，由真解快照 $\\,\\phi = u_{h}(\\mu_{1})\\,$ 张成，其中 $\\,u_{h}(\\mu_{1})\\,$ 是 $\\,A(\\mu_{1}) u = f\\,$ 的精确 FE 解。不对 $\\,\\phi\\,$ 进行归一化。\n- 训练集为 $\\,\\Xi_{\\mathrm{train}} = \\{\\,\\tfrac{1}{2},\\,\\tfrac{3}{2},\\,2\\,\\}\\,$.\n- 使用可靠强制性下界 $\\,\\alpha_{\\mathrm{LB}}(\\mu) = 2\\mu + 1\\,$。\n\n仅使用以上信息并从第一性原理（当前 RB 空间中的伽辽金投影、残差的定义、欧几里得对偶范数和给定的强制性下界）出发，执行一次贪心迭代，步骤如下：\n1. 对于每个 $\\,\\mu \\in \\Xi_{\\mathrm{train}}\\,$，在 $\\,\\{\\phi\\}\\,$ 的张成空间中计算降阶伽辽金近似解 $\\,u_{N}(\\mu)\\,$。\n2. 计算残差 $\\,r(\\mu) = f - A(\\mu) u_{N}(\\mu)\\,$ 及其欧几里得范数。\n3. 为每个候选参数计算 $\\,\\eta(\\mu) = \\|r(\\mu)\\|_{2} / \\alpha_{\\mathrm{LB}}(\\mu)\\,$。\n4. 选择在 $\\,\\Xi_{\\mathrm{train}}\\,$ 上使 $\\,\\eta(\\mu)\\,$ 最大化的参数 $\\,\\mu^{\\star}\\,$。\n\n将所选参数值 $\\,\\mu^{\\star}\\,$ 报告为单个精确有理数。不包含单位。无需四舍五入。", "solution": "问题陈述经过严格验证，确认有效。这是一个在降阶建模领域内适定的、有科学依据的、客观的问题。所有必要数据均已提供，不存在内部矛盾或逻辑缺陷。任务是执行标准降阶基贪心算法的一次迭代。我将开始解题。\n\n目标是找到在训练集 $\\Xi_{\\mathrm{train}}$ 上使误差指示器 $\\eta(\\mu)$ 最大化的参数 $\\mu^{\\star}$。\n$$\n\\mu^{\\star} = \\arg\\max_{\\mu \\in \\Xi_{\\mathrm{train}}} \\eta(\\mu) = \\arg\\max_{\\mu \\in \\{\\frac{1}{2}, \\frac{3}{2}, 2\\}} \\frac{\\|r(\\mu)\\|_{2}}{\\alpha_{\\mathrm{LB}}(\\mu)}\n$$\n问题设定在 $\\mathbb{R}^{3}$ 中，其中 FE 试验空间内积是标准欧几里得内积。因此，对偶范数 $\\| \\cdot \\|_{V^*}$ 就是欧几里得范数 $\\| \\cdot \\|_2$。\n\n首先，我们确定一维降阶基 (RB) 空间 $V_{N} = \\mathrm{span}\\{\\phi\\}$，其中 $N=1$。基向量 $\\phi$ 是种子参数 $\\mu_1 = 1$ 对应的“真”有限元 (FE) 解 $u_h(\\mu_1)$。\n依赖于参数的矩阵 $A(\\mu)$ 由 $A(\\mu) = \\Theta_{1}(\\mu) A_{1} + \\Theta_{2}(\\mu) A_{2} = \\mu A_{1} + A_{2}$ 给出。\n给定 $A_{1} = \\mathrm{diag}(2, 3, 4)$ 和 $A_{2} = I_{3} = \\mathrm{diag}(1, 1, 1)$，我们有：\n$$\nA(\\mu) = \\mu \\begin{pmatrix} 2   0   0 \\\\ 0   3   0 \\\\ 0   0   4 \\end{pmatrix} + \\begin{pmatrix} 1   0   0 \\\\ 0   1   0 \\\\ 0   0   1 \\end{pmatrix} = \\begin{pmatrix} 2\\mu+1   0   0 \\\\ 0   3\\mu+1   0 \\\\ 0   0   4\\mu+1 \\end{pmatrix}\n$$\n对于 $\\mu_1 = 1$，矩阵为 $A(1) = \\mathrm{diag}(3, 4, 5)$。基向量 $\\phi$ 是 $A(1) \\phi = f$ 的解，其中 $f = [1, 1, 1]^T$。\n$$\n\\begin{pmatrix} 3   0   0 \\\\ 0   4   0 \\\\ 0   0   5 \\end{pmatrix} \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\\\ \\phi_3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\implies \\phi = \\begin{pmatrix} 1/3 \\\\ 1/4 \\\\ 1/5 \\end{pmatrix}\n$$\nRB 空间为 $V_1 = \\mathrm{span}\\{\\phi\\}$。\n\n接下来，对于每个 $\\mu \\in \\Xi_{\\mathrm{train}}$，我们求解降阶伽辽金解 $u_N(\\mu) \\in V_1$。该解可以写成 $u_N(\\mu) = c(\\mu) \\phi$ 的形式，其中 $c(\\mu)$ 是某个标量系数。伽辽金投影条件规定残差必须与 $V_1$ 的基正交。内积是欧几里得点积。\n$$\n\\phi^T (A(\\mu) u_N(\\mu) - f) = 0\n$$\n代入 $u_N(\\mu) = c(\\mu)\\phi$：\n$$\n\\phi^T (A(\\mu) (c(\\mu)\\phi) - f) = 0 \\implies c(\\mu) (\\phi^T A(\\mu) \\phi) - \\phi^T f = 0\n$$\n这给出了系数 $c(\\mu)$：\n$$\nc(\\mu) = \\frac{\\phi^T f}{\\phi^T A(\\mu) \\phi}\n$$\n我们来计算分子和分母。\n$$\n\\phi^T f = \\begin{pmatrix} 1/3   1/4   1/5 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{3} + \\frac{1}{4} + \\frac{1}{5} = \\frac{20+15+12}{60} = \\frac{47}{60}\n$$\n分母是 $\\mu$ 的一个仿射函数：\n$$\n\\phi^T A(\\mu) \\phi = \\phi^T (\\mu A_1 + A_2) \\phi = \\mu (\\phi^T A_1 \\phi) + (\\phi^T A_2 \\phi)\n$$\n$$\n\\phi^T A_1 \\phi = \\begin{pmatrix} \\frac{1}{3}   \\frac{1}{4}   \\frac{1}{5} \\end{pmatrix} \\begin{pmatrix} 2   0   0 \\\\ 0   3   0 \\\\ 0   0   4 \\end{pmatrix} \\begin{pmatrix} 1/3 \\\\ 1/4 \\\\ 1/5 \\end{pmatrix} = 2\\left(\\frac{1}{3}\\right)^2 + 3\\left(\\frac{1}{4}\\right)^2 + 4\\left(\\frac{1}{5}\\right)^2 = \\frac{2}{9} + \\frac{3}{16} + \\frac{4}{25} = \\frac{800+675+576}{3600} = \\frac{2051}{3600}\n$$\n$$\n\\phi^T A_2 \\phi = \\phi^T I_3 \\phi = \\|\\phi\\|_2^2 = \\left(\\frac{1}{3}\\right)^2 + \\left(\\frac{1}{4}\\right)^2 + \\left(\\frac{1}{5}\\right)^2 = \\frac{1}{9} + \\frac{1}{16} + \\frac{1}{25} = \\frac{400+225+144}{3600} = \\frac{769}{3600}\n$$\n所以，$\\phi^T A(\\mu) \\phi = \\mu \\frac{2051}{3600} + \\frac{769}{3600} = \\frac{2051\\mu + 769}{3600}$。\n于是系数为：\n$$\nc(\\mu) = \\frac{47/60}{(2051\\mu + 769)/3600} = \\frac{47 \\cdot 60}{2051\\mu + 769} = \\frac{2820}{2051\\mu + 769}\n$$\n现在我们计算残差 $r(\\mu) = f - A(\\mu) u_N(\\mu) = f - c(\\mu) A(\\mu) \\phi$。一个关键的洞察是，残差向量 $r(\\mu)$ 在 $\\mu = 1$ 时为零，因为 $u_N(1) = c(1)\\phi$ 并且根据构造有 $\\phi = u_h(1)$。我们来验证一下：\n$$\nc(1) = \\frac{47/60}{\\phi^T A(1) \\phi} = \\frac{\\phi^T f}{\\phi^T f} = 1\n$$\n所以 $u_N(1) = 1 \\cdot \\phi = u_h(1)$，并且 $r(1) = f - A(1) u_h(1) = 0$。这意味着残差向量的每个分量都必须包含因子 $(\\mu-1)$。我们来推导 $r(\\mu)$ 的一般形式。\n第 $i$ 个分量是 $r_i(\\mu) = f_i - c(\\mu) (A(\\mu)\\phi)_i$。由于 $A(\\mu)$ 是对角矩阵，$(A(\\mu)\\phi)_i = A_{ii}(\\mu) \\phi_i = (d_i \\mu + 1) \\phi_i$，其中 $d_i$ 是 $A_1$ 的对角元素。\n$$\nr_i(\\mu) = 1 - \\frac{\\phi^T f}{\\phi^T A(\\mu) \\phi} (d_i \\mu + 1) \\phi_i = \\frac{(\\phi^T A(\\mu) \\phi) - (\\phi^T f)(d_i \\mu + 1)\\phi_i}{\\phi^T A(\\mu) \\phi}\n$$\n分子是 $\\mu$ 的一个线性函数。如前所述，当 $\\mu=1$ 时它必须为零。因此，它与 $(\\mu-1)$ 成正比。\n我们发现 $r(\\mu) = \\frac{1-\\mu}{2051\\mu + 769} v$，其中 $v$ 是一个常数向量。\n我们来求 $v$。\n$$r(\\mu) = \\frac{1-\\mu}{2051\\mu + 769}\\begin{pmatrix} -171 \\\\ 64 \\\\ 205 \\end{pmatrix}$$\n我们来验证第一个分量。分子是 $(\\mu-1)(f_1 (\\phi^T A_1 \\phi) - (\\phi^T f)(A_1\\phi)_1) \\cdot 3600$。\n$(\\phi^T A_1 \\phi) = \\frac{2051}{3600}$, $\\phi^T f = \\frac{47}{60}$, $f_1=1$, $(A_1\\phi)_1 = 2 \\cdot \\frac{1}{3}$.\n$1 \\cdot \\frac{2051}{3600} - \\frac{47}{60} \\cdot \\frac{2}{3} = \\frac{2051 - 94 \\cdot 20}{3600} = \\frac{171}{3600}$.\n所以 $r_1(\\mu) = \\frac{171(\\mu-1)}{2051\\mu+769}$，这与 $\\frac{1-\\mu}{2051\\mu+769}(-171)$ 的形式相匹配。\n残差的范数是：\n$$\n\\|r(\\mu)\\|_2 = \\frac{|1-\\mu|}{2051\\mu+769} \\left\\| \\begin{pmatrix} -171 \\\\ 64 \\\\ 205 \\end{pmatrix} \\right\\|_2\n$$\n我们来计算常数向量 $v = [-171, 64, 205]^T$ 的范数：\n$$\n\\|v\\|_2^2 = (-171)^2 + 64^2 + 205^2 = 29241 + 4096 + 42025 = 75362\n$$\n因此，$\\|r(\\mu)\\|_2 = \\frac{|1-\\mu|\\sqrt{75362}}{2051\\mu+769}$。\n误差指示器为 $\\eta(\\mu) = \\frac{\\|r(\\mu)\\|_2}{\\alpha_{\\mathrm{LB}}(\\mu)}$，其中 $\\alpha_{\\mathrm{LB}}(\\mu) = 2\\mu+1$。\n$$\n\\eta(\\mu) = \\frac{|1-\\mu|\\sqrt{75362}}{(2051\\mu+769)(2\\mu+1)}\n$$\n为了找到最大化参数，我们可以忽略常数因子 $\\sqrt{75362}$，并在 $\\mu \\in \\{\\frac{1}{2}, \\frac{3}{2}, 2\\}$ 上最大化函数 $g(\\mu) = \\frac{|1-\\mu|}{(2051\\mu+769)(2\\mu+1)}$。\n\n对于 $\\mu = \\frac{1}{2}$：\n$g(\\frac{1}{2}) = \\frac{|1-\\frac{1}{2}|}{(2051(\\frac{1}{2})+769)(2(\\frac{1}{2})+1)} = \\frac{\\frac{1}{2}}{(1025.5+769)(1+1)} = \\frac{0.5}{1794.5 \\cdot 2} = \\frac{0.5}{3589} = \\frac{1}{7178}$.\n\n对于 $\\mu = \\frac{3}{2}$：\n$g(\\frac{3}{2}) = \\frac{|1-\\frac{3}{2}|}{(2051(\\frac{3}{2})+769)(2(\\frac{3}{2})+1)} = \\frac{\\frac{1}{2}}{(3076.5+769)(3+1)} = \\frac{0.5}{3845.5 \\cdot 4} = \\frac{0.5}{15382} = \\frac{1}{30764}$.\n\n对于 $\\mu = 2$：\n$g(2) = \\frac{|1-2|}{(2051(2)+769)(2(2)+1)} = \\frac{1}{(4102+769)(5)} = \\frac{1}{4871 \\cdot 5} = \\frac{1}{24355}$.\n\n我们必须比较这些值：$g(\\frac{1}{2}) = \\frac{1}{7178}$，$g(\\frac{3}{2}) = \\frac{1}{30764}$，以及 $g(2) = \\frac{1}{24355}$。\n最大值对应于最小的分母。\n由于 $7178  24355  30764$，我们有 $\\frac{1}{7178} > \\frac{1}{24355} > \\frac{1}{30764}$。\n$g(\\mu)$ 的最大值，也就是 $\\eta(\\mu)$ 的最大值，出现在 $\\mu = \\frac{1}{2}$ 处。\n所选参数为 $\\mu^{\\star} = \\frac{1}{2}$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2593056"}, {"introduction": "参数化系统降阶建模的核心优势在于其高效的“离线-在线”（offline-online）计算分解策略。该策略将计算量巨大的、与参数无关的计算任务在“离线”阶段一次性完成，使得“在线”阶段能够针对任意新参数值进行极速求解，且计算成本与原始高维问题的大小无关。本练习要求您为一种具有仿射参数依赖性的问题设计离线预计算方案，并推导出为支持高效在线计算所需的最少存储量，从而加深对ROM实现效率和计算成本的理解 ([@problem_id:2593090])。", "problem": "考虑一个由强制椭圆问题产生的、依赖于参数的有限元方法（FEM）线性系统，该系统在具有 $n_h$ 个自由度的固定网格上进行离散化。对于紧凑参数集中的每个参数向量 $\\mu$，组装的高保真代数系统为\n$$\nA_h(\\mu)\\,u_h(\\mu)=b_h(\\mu), \\quad A_h(\\mu)\\in\\mathbb{R}^{n_h\\times n_h},\\; b_h(\\mu)\\in\\mathbb{R}^{n_h}.\n$$\n假设算子和右端项都存在具有 $Q$ 项的精确仿射参数依赖关系，\n$$\nA_h(\\mu)=\\sum_{q=1}^{Q}\\theta_q(\\mu)\\,A_q,\\qquad b_h(\\mu)=\\sum_{q=1}^{Q}\\theta_q(\\mu)\\,b_q,\n$$\n其中 $A_q\\in\\mathbb{R}^{n_h\\times n_h}$ 和 $b_q\\in\\mathbb{R}^{n_h}$ 是与参数无关的系数对象，$\\theta_q(\\mu)$ 是已知的标量函数，其计算成本与维度为 $n_h$ 的线性代数运算相比可以忽略不计。设 $V_r\\in\\mathbb{R}^{n_h\\times r}$ 是一个降阶试探基，其中 $r\\ll n_h$ 且 $V_r^{T}V_r=I_r$。针对降阶坐标 $a_r(\\mu)\\in\\mathbb{R}^{r}$ 的降阶 Galerkin 系统为\n$$\nA_r(\\mu)\\,a_r(\\mu)=b_r(\\mu),\\qquad A_r(\\mu)=V_r^{T}A_h(\\mu)V_r,\\quad b_r(\\mu)=V_r^{T}b_h(\\mu).\n$$\n您的任务是针对 $\\mu$ 进行多次查询评估，目标是在线组装 $A_r(\\mu)$ 和 $b_r(\\mu)$ 的过程与 $n_h$ 无关。构建一个最小的离线、与参数无关的预计算集合，使得能够仅使用与 $Q$ 和 $r$ 成比例的运算在线组装 $A_r(\\mu)$ 和 $b_r(\\mu)$。假设不利用任何对称性，并且您必须能够在线恢复高保真近似解 $u_h(\\mu)\\approx V_r a_r(\\mu)$。\n\n在这些假设下，确定一个单一表达式 $M(Q,n_h,r)$，该表达式给出在离线阶段之后必须存储的浮点标量的总数，以支持在线组装 $A_r(\\mu)$ 和 $b_r(\\mu)$ 以及恢复 $u_h(\\mu)$，同时丢弃任何不再需要的高维对象。以闭式符号表达式的形式报告 $M(Q,n_h,r)$。不要包括函数 $\\theta_q(\\mu)$ 的存储，也不要计算任何可以在线以 $\\mathcal{O}(r^2)$ 或更少的时间复杂度重新计算且不依赖于 $n_h$ 的量的存储。", "solution": "问题陈述已经过严格验证，并被确定为有效。它具有科学依据，是适定的，并且使用客观、明确的语言进行表述。该问题探讨了参数化系统降阶建模中离线-在线计算范式的一个基本方面，这是计算科学与工程中的一个标准课题。\n\n目标是推导出在离线预计算阶段后必须存储的浮点标量总数 $M(Q, n_h, r)$ 的表达式。这些存储的数据必须足以在指定约束条件下，实现在线组装降阶系统、求解该系统以及重构高保真解近似。降阶矩阵和向量的在线组装必须与高保真维度 $n_h$ 无关。\n\n我们将分析在线阶段所需的不同组件的存储需求。\n\n1.  **降阶矩阵 $A_r(\\mu)$ 的组装**：\n    降阶矩阵由 Galerkin 投影 $A_r(\\mu) = V_r^{T}A_h(\\mu)V_r$ 定义。代入给定的 $A_h(\\mu)$ 的仿射展开式：\n    $$A_r(\\mu) = V_r^{T}\\left(\\sum_{q=1}^{Q}\\theta_q(\\mu)A_q\\right)V_r$$\n    根据矩阵乘法的线性性，我们可以将此表达式重排为：\n    $$A_r(\\mu) = \\sum_{q=1}^{Q}\\theta_q(\\mu)\\left(V_r^{T}A_qV_r\\right)$$\n    为了使在线组装与维度 $n_h$ 无关，必须在离线阶段计算并存储与参数无关的矩阵 $A_{r,q} \\equiv V_r^{T}A_qV_r$。此计算的输入是高保真分量矩阵 $A_q \\in \\mathbb{R}^{n_h \\times n_h}$ 和降阶基 $V_r \\in \\mathbb{R}^{n_h \\times r}$。每个得到的矩阵 $A_{r,q}$ 的维度是 $r \\times r$。由于问题声明不利用任何对称性，我们必须为 $Q$ 个矩阵中的每一个存储全部 $r^2$ 个元素。因此，此组件的标量总数为 $Q r^2$。\n\n2.  **降阶向量 $b_r(\\mu)$ 的组装**：\n    类似地，降阶右端项为 $b_r(\\mu) = V_r^{T}b_h(\\mu)$。我们代入 $b_h(\\mu)$ 的仿射展开式：\n    $$b_r(\\mu) = V_r^{T}\\left(\\sum_{q=1}^{Q}\\theta_q(\\mu)b_q\\right) = \\sum_{q=1}^{Q}\\theta_q(\\mu)\\left(V_r^{T}b_q\\right)$$\n    为确保在线计算与 $n_h$ 无关，必须预先计算并存储与参数无关的向量 $b_{r,q} \\equiv V_r^{T}b_q$。每个向量 $b_{r,q}$ 是一个大小为 $r \\times n_h$ 的矩阵和一个大小为 $n_h \\times 1$ 的向量的乘积，得到一个维度为 $r$ 的向量。共有 $Q$ 个这样的向量。此组件的总存储成本是 $Q r$。\n\n3.  **高保真解 $u_h(\\mu)$ 的重构**：\n    问题要求必须能够使用公式 $u_h(\\mu) \\approx V_r a_r(\\mu)$ 在线恢复高保真解近似，其中 $a_r(\\mu) \\in \\mathbb{R}^r$ 是降阶系统的解。这个重构过程需要降阶基矩阵 $V_r \\in \\mathbb{R}^{n_h \\times r}$。因此，该矩阵必须作为离线计算数据的一部分被存储。存储 $V_r$ 所需的标量数量为 $n_h r$。\n\n高维对象 $\\{A_q\\}_{q=1}^Q$ 和 $\\{b_q\\}_{q=1}^Q$ 仅在离线阶段用于计算 $\\{A_{r,q}\\}_{q=1}^Q$ 和 $\\{b_{r,q}\\}_{q=1}^Q$，然后根据问题的指示被丢弃。因此，为在线阶段需要存储的对象集合是 $\\{A_{r,q}\\}_{q=1}^Q$、$\\{b_{r,q}\\}_{q=1}^Q$ 和 $V_r$。这是完成所有指定的在线任务所需的最小集合。\n\n总存储量 $M(Q, n_h, r)$ 是这三个组件所需标量的总和。\n$$M(Q, n_h, r) = (\\text{存储 } \\{A_{r,q}\\} \\text{ 的量}) + (\\text{存储 } \\{b_{r,q}\\} \\text{ 的量}) + (\\text{存储 } V_r \\text{ 的量})$$\n$$M(Q, n_h, r) = Qr^2 + Qr + n_hr$$\n这个表达式代表了为实现降阶模型的有效在线执行而必须存储的浮点标量的总数。", "answer": "$$\n\\boxed{Qr^2 + Qr + n_hr}\n$$", "id": "2593090"}]}