{"hands_on_practices": [{"introduction": "多孔弹性理论的强大之处在于其能够将固相骨架的变形与流体压力的变化联系起来。然而，要将该理论应用于实际工程问题，我们必须首先确定其本构关系中的关键材料参数。本练习提供了一个从标准岩石力学实验（例如排水和不排水压缩实验）中获得的可测量数据出发，推导 Biot 系数 $\\alpha$ 和 Biot 模量 $M$ 的实践机会。通过这项练习 [@problem_id:2590014]，您将掌握如何连接宏观实验观测值与理论模型中的基本参数，这是进行任何有效多孔弹性模拟的基石。", "problem": "一块完全饱和的各向同性岩石，在线性Biot多孔弹性理论框架下，于等温、小应变条件下进行测试。独立的测量提供了排水压缩系数 $C_{d}$、不排水压缩系数 $C_{u}$ 和 Skempton 系数 $B$（定义为不排水各向同性加载中孔隙压力增量与平均总应力增量之比）。令排水和不排水体积模量分别为 $K_{d} = 1/C_{d}$ 和 $K_{u} = 1/C_{u}$。Biot 系数用 $\\alpha$ 表示，Biot 模量用 $M$ 表示。仅从有效应力（Terzaghi–Biot 有效应力）的定义、固体骨架的线弹性体积响应以及完全饱和介质的流体质量守恒出发，推导在各向同性加载条件下连接 $K_{d}$、$K_{u}$、$\\alpha$、$M$ 和 $B$ 的关系式。然后使用给定的测量值\n- $C_{d} = 6.25 \\times 10^{-10}\\ \\mathrm{Pa}^{-1}$，\n- $C_{u} = 2.50 \\times 10^{-10}\\ \\mathrm{Pa}^{-1}$，\n- $B = 0.65$，\n计算 $\\alpha$ 和 $M$。将 $\\alpha$ 和 $M$ 的值均四舍五入至四位有效数字，并以 $\\mathrm{GPa}$ 为单位表示 $M$。将您的最终答案以单行矩阵的形式给出，其中首先是 $\\alpha$（无量纲），然后是 $M$（以 $\\mathrm{GPa}$ 为单位）。", "solution": "所述问题具有科学依据，提法恰当且客观。这是线性多孔弹性理论中的一个标准练习。我们将进行推导和后续计算。\n\n该分析基于完全饱和、各向同性的多孔弹性介质在等温、小应变条件下的三个基本原理：\n$1$. Terzaghi-Biot 有效应力的定义，它将骨架应变的变化与总应力和孔隙压力的变化联系起来。\n$2$. 固体骨架对该有效应力的线弹性体积响应。\n$3$. 孔隙内流体质量守恒原理。\n\n令 $\\sigma$ 为平均总应力， $p$ 为孔隙压力。我们采用压应力和压缩应变（压实）为正的约定。多孔骨架的体积应变用 $\\varepsilon_v$ 表示。\n\n有效应力原理与线弹性响应相结合，表明骨架的体积应变与有效平均应力 $\\sigma'$ 的变化成正比。有效应力定义为 $\\sigma' = \\sigma - \\alpha p$，其中 $\\alpha$ 是 Biot-Willis 系数。比例常数是排水体积模量 $K_d$ 的倒数。其微分形式为：\n$$d\\varepsilon_v = \\frac{1}{K_d} d\\sigma' = \\frac{1}{K_d} (d\\sigma - \\alpha dp) \\quad (\\text{Eq. } 1)$$\n该方程描述了固体骨架的体积响应。\n\n流体质量守恒通过单位体积内流体体积的增量 $\\zeta$ 来表示。变化量 $d\\zeta$ 是由两种效应引起的：固体骨架的力学压缩（减少了孔隙体积），以及孔隙压力的变化（影响了流体密度和孔隙体积）。本构关系为：\n$$d\\zeta = -\\alpha d\\varepsilon_v + \\frac{1}{M} dp \\quad (\\text{Eq. } 2)$$\n这里，$M$ 是 Biot 模量。项 $-\\alpha d\\varepsilon_v$ 代表因骨架压实 ($d\\varepsilon_v > 0$) 而排出的流体体积。项 $\\frac{1}{M} dp$ 代表因孔隙压力增加而储存的流体体积。\n\n这两个方程构成了我们推导的基础。现在我们分析材料在排水和不排水条件下的响应。\n\n在排水条件下，孔隙压力保持不变，因此 $dp=0$。方程 1 简化为 $d\\varepsilon_v = \\frac{1}{K_d} d\\sigma$。排水体积模量 $K_d = 1/C_d$ 因此定义为 $K_d = \\frac{d\\sigma}{d\\varepsilon_v}\\Big|_{dp=0}$，这与我们的出发点一致。\n\n在不排水条件下，不允许流体进入或离开材料，因此流体体积含量的净变化为零，$d\\zeta=0$。根据方程 2，我们有：\n$$0 = -\\alpha d\\varepsilon_v + \\frac{1}{M} dp$$\n这得出了诱发孔隙压力与体积应变之间的关系：\n$$dp = \\alpha M d\\varepsilon_v \\quad (\\text{Eq. } 3)$$\n将这个 $dp$ 的表达式代入方程 1：\n$$d\\varepsilon_v = \\frac{1}{K_d} (d\\sigma - \\alpha (\\alpha M d\\varepsilon_v))$$\n$$d\\varepsilon_v = \\frac{1}{K_d} d\\sigma - \\frac{\\alpha^2 M}{K_d} d\\varepsilon_v$$\n重新整理各项，以求解比值 $d\\sigma / d\\varepsilon_v$：\n$$d\\varepsilon_v \\left(1 + \\frac{\\alpha^2 M}{K_d}\\right) = \\frac{1}{K_d} d\\sigma$$\n$$d\\varepsilon_v \\left(\\frac{K_d + \\alpha^2 M}{K_d}\\right) = \\frac{1}{K_d} d\\sigma$$\n$$d\\sigma = (K_d + \\alpha^2 M) d\\varepsilon_v$$\n不排水体积模量 $K_u = 1/C_u$ 定义为不排水条件下总应力变化与体积应变变化之比，$K_u = \\frac{d\\sigma}{d\\varepsilon_v}\\Big|_{d\\zeta=0}$。因此，我们得到了第一个所需的关系式：\n$$K_u = K_d + \\alpha^2 M$$\n\nSkempton 系数 $B$ 定义为不排水各向同性加载下诱发孔隙压力增量与平均总应力增量之比：\n$$B = \\frac{dp}{d\\sigma}\\Bigg|_{d\\zeta=0}$$\n使用我们不排水分析的结果，我们有 $dp = \\alpha M d\\varepsilon_v$ （来自方程 3）和 $d\\sigma = K_u d\\varepsilon_v$。将这些代入 $B$ 的定义中：\n$$B = \\frac{\\alpha M d\\varepsilon_v}{K_u d\\varepsilon_v} = \\frac{\\alpha M}{K_u}$$\n这是第二个所需的关系式。推导到此结束。\n\n现在，我们使用所提供的数据计算 $\\alpha$ 和 $M$ 的值。\n给定的测量值为：\n$C_{d} = 6.25 \\times 10^{-10}\\ \\mathrm{Pa}^{-1}$\n$C_{u} = 2.50 \\times 10^{-10}\\ \\mathrm{Pa}^{-1}$\n$B = 0.65$\n\n首先，计算排水和不排水体积模量：\n$$K_d = \\frac{1}{C_d} = \\frac{1}{6.25 \\times 10^{-10}\\ \\mathrm{Pa}^{-1}} = 1.6 \\times 10^9\\ \\mathrm{Pa}$$\n$$K_u = \\frac{1}{C_u} = \\frac{1}{2.50 \\times 10^{-10}\\ \\mathrm{Pa}^{-1}} = 4.0 \\times 10^9\\ \\mathrm{Pa}$$\n\n我们得到一个包含两个未知数 $\\alpha$ 和 $M$ 的方程组：\n1.  $K_u - K_d = \\alpha^2 M$\n2.  $B K_u = \\alpha M$\n\n从第二个方程，我们得到 $\\alpha M = B K_u$。将此代入第一个方程：\n$$K_u - K_d = \\alpha (B K_u)$$\n现在我们可以求解 Biot 系数 $\\alpha$：\n$$\\alpha = \\frac{K_u - K_d}{B K_u}$$\n代入数值：\n$$\\alpha = \\frac{4.0 \\times 10^9\\ \\mathrm{Pa} - 1.6 \\times 10^9\\ \\mathrm{Pa}}{0.65 \\times (4.0 \\times 10^9\\ \\mathrm{Pa})} = \\frac{2.4 \\times 10^9}{2.6 \\times 10^9} = \\frac{12}{13} \\approx 0.9230769...$$\n四舍五入到四位有效数字，我们得到 $\\alpha = 0.9231$。\n\n接下来，我们求解 Biot 模量 $M$。使用关系式 $M = \\frac{B K_u}{\\alpha}$：\n$$M = \\frac{0.65 \\times (4.0 \\times 10^9\\ \\mathrm{Pa})}{\\frac{12}{13}} = \\frac{2.6 \\times 10^9}{\\frac{12}{13}}\\ \\mathrm{Pa} = \\frac{2.6 \\times 13}{12} \\times 10^9\\ \\mathrm{Pa} \\approx 2.81666...\\times 10^9\\ \\mathrm{Pa}$$\n问题要求 $M$ 以吉帕斯卡（GPa）为单位，其中 $1\\ \\mathrm{GPa} = 10^9\\ \\mathrm{Pa}$。\n$$M \\approx 2.8167\\ \\mathrm{GPa}$$\n四舍五入到四位有效数字，我们得到 $M = 2.817\\ \\mathrm{GPa}$。\n\n最终值为 $\\alpha \\approx 0.9231$（无量纲）和 $M \\approx 2.817\\ \\mathrm{GPa}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.9231  2.817\n\\end{pmatrix}\n}\n$$", "id": "2590014"}, {"introduction": "在求解耦合场问题的有限元分析中，静态凝聚是一种旨在减小系统自由度、提高计算效率的强大技巧。本练习将引导您对一个一维双节点多孔弹性单元进行精确的代数推导。您将通过显式地消去压力自由度，得到一个仅与位移相关的凝聚刚度矩阵 [@problem_id:2590016]。这个过程不仅能加深您对有限元列式底层代数结构的理解，还能揭示等阶线性插值选择对数值模型性质的重要影响。", "problem": "考虑一个由 Biot 理论控制的饱和、线性弹性、小应变的一维 ($1$D) 多孔弹性杆，其占据一个长度为 $h$、横截面积为常数 $A$ 的单元。固体骨架的杨氏模量为 $E$，Biot 系数为 $\\alpha$；流体的特征为 Biot 模量 $M$、固有渗透率 $k$ 和动力粘度 $\\mu$。设 $u(x,t)$ 表示固体位移，$p(x,t)$ 表示流体压力。假设准静态力学平衡和等温条件。强形式的控制场方程如下：\n- 力学平衡（总应力 $\\sigma = E\\,\\partial u/\\partial x - \\alpha p$）：$\\partial \\sigma/\\partial x = 0$。\n- 流体质量平衡：$$ \\alpha\\,\\frac{\\partial}{\\partial t}\\left(\\frac{\\partial u}{\\partial x}\\right) + \\frac{1}{M}\\,\\frac{\\partial p}{\\partial t} - \\frac{\\partial}{\\partial x}\\!\\left( \\frac{k}{\\mu}\\,\\frac{\\partial p}{\\partial x} \\right) = 0 $$。\n\n使用有限元法 (FEM)，在 $x \\in [0,h]$ 上用线性的 Lagrange 形函数对位移和压力离散化一个双节点单元，\n- $u(x,t) \\approx N_1(x)\\,u_1(t) + N_2(x)\\,u_2(t)$ 且 $p(x,t) \\approx N_1(x)\\,p_1(t) + N_2(x)\\,p_2(t)$，其中 $N_1(x) = 1 - x/h$ 且 $N_2(x) = x/h$，\n并对时间导数使用时间步长为 $\\Delta t$ 的后向欧拉法进行时间离散化。取从上述强形式得到的弱形式，在单元体积上进行精确的单元级积分（即，非缩减积分），并得到耦合节点向量 $\\{u_1,u_2\\}$ 和 $\\{p_1,p_2\\}$ 的单元块体系统。\n\n在单元级别进行精确的静态凝聚以消除压力自由度，并得到一个凝聚的 $2 \\times 2$ 位移刚度矩阵。最后，将该凝聚的 $2 \\times 2$ 矩阵的唯一非零特征值确定为一个闭式解析表达式，该表达式用符号 $E$, $\\alpha$, $M$, $A$, $h$, $k$, $\\mu$ 和 $\\Delta t$ 表示。将最终答案表示为一个简化的解析表达式。不需要进行数值计算，也不需要报告单位。", "solution": "首先对问题进行验证。给定的条件和任务构成了计算多孔介质力学中一个适定的、有科学依据的问题。这是使用有限元法 (FEM) 对 Biot 多孔弹性理论进行的标准推导。所有必需的信息均已提供，问题没有矛盾或含糊之处。因此，我们开始求解。\n\n该问题要求推导一维多孔弹性杆的凝聚单元刚度矩阵，并确定其非零特征值。\n\n首先，我们建立控制方程的弱形式。单元域为 $x \\in [0, h]$，体元为 $dV = A \\, dx$。\n\n1.  **力学平衡的弱形式：**\n    强形式为 $\\frac{\\partial \\sigma}{\\partial x} = 0$，其中 $\\sigma = E \\frac{\\partial u}{\\partial x} - \\alpha p$。乘以虚位移 $\\delta u$ 并在单元体积上积分，得到：\n    $$ \\int_0^h A \\left( \\delta u \\frac{\\partial \\sigma}{\\partial x} \\right) dx = 0 $$\n    进行分部积分并省略边界项（与外力相关），得到弱形式：\n    $$ \\int_0^h A \\left( \\frac{\\partial(\\delta u)}{\\partial x} \\sigma \\right) dx = \\int_0^h A \\left( \\frac{\\partial(\\delta u)}{\\partial x} \\left( E \\frac{\\partial u}{\\partial x} - \\alpha p \\right) \\right) dx = 0 $$\n\n2.  **流体质量平衡的弱形式：**\n    强形式为 $\\alpha \\frac{\\partial}{\\partial t}(\\frac{\\partial u}{\\partial x}) + \\frac{1}{M} \\frac{\\partial p}{\\partial t} - \\frac{\\partial}{\\partial x} \\left( \\frac{k}{\\mu} \\frac{\\partial p}{\\partial x} \\right) = 0$。乘以虚压力 $\\delta p$ 并积分，得到：\n    $$ \\int_0^h A \\left( \\delta p \\left( \\alpha \\frac{\\partial}{\\partial t}\\left(\\frac{\\partial u}{\\partial x}\\right) + \\frac{1}{M} \\frac{\\partial p}{\\partial t} - \\frac{\\partial}{\\partial x} \\left( \\frac{k}{\\mu} \\frac{\\partial p}{\\partial x} \\right) \\right) \\right) dx = 0 $$\n    对渗透项进行分部积分并省略边界通量项，得到：\n    $$ \\int_0^h A \\left( \\delta p \\alpha \\frac{\\partial}{\\partial t}\\left(\\frac{\\partial u}{\\partial x}\\right) + \\frac{\\delta p}{M} \\frac{\\partial p}{\\partial t} + \\frac{\\partial(\\delta p)}{\\partial x} \\frac{k}{\\mu} \\frac{\\partial p}{\\partial x} \\right) dx = 0 $$\n\n接下来，我们使用线性 Lagrange 形函数 $\\mathbf{N}(x) = [N_1(x), N_2(x)] = [1-x/h, x/h]$ 引入位移场 $u(x,t)$ 和压力场 $p(x,t)$ 的有限元近似：\n$u(x,t) = \\mathbf{N}(x) \\mathbf{u}(t)$ 和 $p(x,t) = \\mathbf{N}(x) \\mathbf{p}(t)$，其中 $\\mathbf{u} = [u_1, u_2]^T$ 和 $\\mathbf{p} = [p_1, p_2]^T$ 是节点值向量。\n空间导数矩阵为 $\\mathbf{B}(x) = \\frac{d\\mathbf{N}}{dx} = [-1/h, 1/h]$，它是一个常数。\n导数的近似为 $\\frac{\\partial u}{\\partial x} = \\mathbf{B} \\mathbf{u}$ 和 $\\frac{\\partial p}{\\partial x} = \\mathbf{B} \\mathbf{p}$。\n\n将这些近似代入弱形式，得到一个半离散化的常微分方程组：\n$$ \\begin{pmatrix} \\mathbf{K}  -\\mathbf{Q} \\\\ \\mathbf{0}  \\mathbf{H} \\end{pmatrix} \\begin{pmatrix} \\mathbf{u} \\\\ \\mathbf{p} \\end{pmatrix} + \\begin{pmatrix} \\mathbf{0}  \\mathbf{0} \\\\ \\mathbf{Q}^T  \\mathbf{S} \\end{pmatrix} \\begin{pmatrix} \\dot{\\mathbf{u}} \\\\ \\dot{\\mathbf{p}} \\end{pmatrix} = \\mathbf{f} $$\n其中 $\\mathbf{f}$ 是外力和流体通量的向量，单元矩阵如下：\n-   刚度矩阵：$\\mathbf{K} = A \\int_0^h E \\mathbf{B}^T \\mathbf{B} \\, dx$\n-   耦合矩阵：$\\mathbf{Q} = A \\int_0^h \\alpha \\mathbf{B}^T \\mathbf{N} \\, dx$\n-   渗透矩阵：$\\mathbf{H} = A \\int_0^h \\frac{k}{\\mu} \\mathbf{B}^T \\mathbf{B} \\, dx$\n-   压缩矩阵：$\\mathbf{S} = A \\int_0^h \\frac{1}{M} \\mathbf{N}^T \\mathbf{N} \\, dx$\n\n我们进行精确积分来求得这些矩阵：\n$\\int_0^h \\mathbf{B}^T \\mathbf{B} \\, dx = \\int_0^h \\begin{pmatrix} 1/h^2  -1/h^2 \\\\ -1/h^2  1/h^2 \\end{pmatrix} dx = \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$\n$\\int_0^h \\mathbf{N}^T \\mathbf{N} \\, dx = h \\int_0^1 \\begin{pmatrix} (1-\\xi)^2  \\xi(1-\\xi) \\\\ \\xi(1-\\xi)  \\xi^2 \\end{pmatrix} d\\xi = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$\n$\\int_0^h \\mathbf{B}^T \\mathbf{N} \\, dx = \\int_0^h \\frac{1}{h} \\begin{pmatrix} -(1-x/h)  -x/h \\\\ 1-x/h  x/h \\end{pmatrix} dx = \\frac{1}{2} \\begin{pmatrix} -1  -1 \\\\ 1  1 \\end{pmatrix}$\n\n单元矩阵为：\n$\\mathbf{K} = \\frac{AE}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$\n$\\mathbf{Q} = \\frac{A\\alpha}{2} \\begin{pmatrix} -1  -1 \\\\ 1  1 \\end{pmatrix}$\n$\\mathbf{H} = \\frac{Ak}{\\mu h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$\n$\\mathbf{S} = \\frac{Ah}{6M} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$\n注意到 $\\int_0^h \\mathbf{N}^T \\mathbf{B} \\, dx = \\frac{1}{2} \\begin{pmatrix} -1  1 \\\\ -1  1 \\end{pmatrix}$，这验证了流体平衡方程中的矩阵确实是 $\\mathbf{Q}^T$。\n\n将后向欧拉时间离散化 $\\dot{\\mathbf{y}}^{n+1} \\approx (\\mathbf{y}^{n+1} - \\mathbf{y}^n)/\\Delta t$ 应用于时间 $t^{n+1}$ 的系统，得到一个全离散的代数系统。为了求出凝聚刚度矩阵，我们只需要左侧的结构：\n$$ \\left( \\begin{pmatrix} \\mathbf{K}  -\\mathbf{Q} \\\\ \\mathbf{0}  \\mathbf{H} \\end{pmatrix} + \\frac{1}{\\Delta t} \\begin{pmatrix} \\mathbf{0}  \\mathbf{0} \\\\ \\mathbf{Q}^T  \\mathbf{S} \\end{pmatrix} \\right) \\begin{pmatrix} \\mathbf{u}^{n+1} \\\\ \\mathbf{p}^{n+1} \\end{pmatrix} = \\text{RHS} $$\n这可以写成两个块方程：\n1.  $\\mathbf{K} \\mathbf{u}^{n+1} - \\mathbf{Q} \\mathbf{p}^{n+1} = \\mathbf{f}_u$\n2.  $\\frac{1}{\\Delta t} \\mathbf{Q}^T \\mathbf{u}^{n+1} + \\left(\\mathbf{H} + \\frac{1}{\\Delta t}\\mathbf{S}\\right) \\mathbf{p}^{n+1} = \\mathbf{f}_p$\n\n为了进行静态凝聚，我们从第二个方程中解出 $\\mathbf{p}^{n+1}$，并代入第一个方程。从(2)式可得：\n$$ \\mathbf{p}^{n+1} = \\left(\\mathbf{H} + \\frac{1}{\\Delta t}\\mathbf{S}\\right)^{-1} \\left(\\mathbf{f}_p - \\frac{1}{\\Delta t} \\mathbf{Q}^T \\mathbf{u}^{n+1}\\right) $$\n代入(1)式：\n$$ \\mathbf{K} \\mathbf{u}^{n+1} - \\mathbf{Q} \\left(\\mathbf{H} + \\frac{1}{\\Delta t}\\mathbf{S}\\right)^{-1} \\left(\\mathbf{f}_p - \\frac{1}{\\Delta t} \\mathbf{Q}^T \\mathbf{u}^{n+1}\\right) = \\mathbf{f}_u $$\n将包含 $\\mathbf{u}^{n+1}$ 的项移到左侧，得到凝聚系统 $\\mathbf{K}_{cond} \\mathbf{u}^{n+1} = \\mathbf{f}_{cond}$，其中凝聚刚度矩阵为：\n$$ \\mathbf{K}_{cond} = \\mathbf{K} + \\frac{1}{\\Delta t} \\mathbf{Q} \\left(\\mathbf{H} + \\frac{1}{\\Delta t}\\mathbf{S}\\right)^{-1} \\mathbf{Q}^T $$\n\n我们来计算项 $\\mathbf{A}_{inv} = \\left(\\mathbf{H} + \\frac{1}{\\Delta t}\\mathbf{S}\\right)^{-1}$。令 $\\mathbf{A} = \\mathbf{H} + \\frac{1}{\\Delta t}\\mathbf{S}$。\n$$ \\mathbf{A} = \\frac{Ak}{\\mu h}\\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} + \\frac{Ah}{6M\\Delta t}\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} = \\begin{pmatrix} \\frac{Ak}{\\mu h} + \\frac{Ah}{3M\\Delta t}  & -\\frac{Ak}{\\mu h} + \\frac{Ah}{6M\\Delta t} \\\\ -\\frac{Ak}{\\mu h} + \\frac{Ah}{6M\\Delta t}  & \\frac{Ak}{\\mu h} + \\frac{Ah}{3M\\Delta t} \\end{pmatrix} $$\n该矩阵具有 $\\begin{pmatrix} a  b \\\\ b  a \\end{pmatrix}$ 的形式，其逆矩阵为 $\\frac{1}{a^2-b^2} \\begin{pmatrix} a  -b \\\\ -b  a \\end{pmatrix}$。\n$a = \\frac{Ak}{\\mu h} + \\frac{Ah}{3M\\Delta t}$ 且 $b = -\\frac{Ak}{\\mu h} + \\frac{Ah}{6M\\Delta t}$。\n行列式为 $a^2 - b^2 = (a-b)(a+b)$。\n$a+b = \\left(\\frac{Ak}{\\mu h} + \\frac{Ah}{3M\\Delta t}\\right) + \\left(-\\frac{Ak}{\\mu h} + \\frac{Ah}{6M\\Delta t}\\right) = \\frac{Ah}{3M\\Delta t} + \\frac{Ah}{6M\\Delta t} = \\frac{Ah}{2M\\Delta t}$。\n$a-b = \\left(\\frac{Ak}{\\mu h} + \\frac{Ah}{3M\\Delta t}\\right) - \\left(-\\frac{Ak}{\\mu h} + \\frac{Ah}{6M\\Delta t}\\right) = \\frac{2Ak}{\\mu h} + \\frac{Ah}{6M\\Delta t}$。\n\n现在，我们计算乘积 $\\mathbf{Q} \\mathbf{A}^{-1} \\mathbf{Q}^T$。先计算 $\\mathbf{Q} \\begin{pmatrix} a  -b \\\\ -b  a \\end{pmatrix} \\mathbf{Q}^T$ 会更方便。\n$$ \\mathbf{Q} \\begin{pmatrix} a  -b \\\\ -b  a \\end{pmatrix} = \\frac{A\\alpha}{2}\\begin{pmatrix} -1  -1 \\\\ 1  1 \\end{pmatrix}\\begin{pmatrix} a  -b \\\\ -b  a \\end{pmatrix} = \\frac{A\\alpha}{2}\\begin{pmatrix} b-a  & -a+b \\\\ a-b  & a-b \\end{pmatrix} = \\frac{A\\alpha(a-b)}{2}\\begin{pmatrix} -1  -1 \\\\ 1  1 \\end{pmatrix} $$\n右乘 $\\mathbf{Q}^T = \\frac{A\\alpha}{2}\\begin{pmatrix} -1  1 \\\\ -1  1 \\end{pmatrix}$：\n$$ \\frac{A\\alpha(a-b)}{2}\\begin{pmatrix} -1  -1 \\\\ 1  1 \\end{pmatrix} \\frac{A\\alpha}{2}\\begin{pmatrix} -1  1 \\\\ -1  1 \\end{pmatrix} = \\frac{A^2\\alpha^2(a-b)}{4}\\begin{pmatrix} 2  -2 \\\\ -2  2 \\end{pmatrix} = \\frac{A^2\\alpha^2(a-b)}{2}\\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} $$\n现在，组合出附加刚度项 $\\Delta\\mathbf{K} = \\mathbf{K}_{cond} - \\mathbf{K}$ 的完整表达式：\n$$ \\Delta\\mathbf{K} = \\frac{1}{\\Delta t} \\frac{1}{(a-b)(a+b)} \\left[ \\frac{A^2\\alpha^2(a-b)}{2}\\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} \\right] = \\frac{A^2\\alpha^2}{2\\Delta t(a+b)}\\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} $$\n代入 $a+b = \\frac{Ah}{2M\\Delta t}$ 的表达式：\n$$ \\Delta\\mathbf{K} = \\frac{A^2\\alpha^2}{2\\Delta t (\\frac{Ah}{2M\\Delta t})}\\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = \\frac{A^2\\alpha^2}{Ah/M}\\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = \\frac{A\\alpha^2 M}{h}\\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} $$\n值得注意的是，该项与渗透率 $k$、粘度 $\\mu$ 和时间步长 $\\Delta t$ 无关。这个数学结果是 $u$ 和 $p$ 采用同阶线性插值时一个已知的产物。\n\n总凝聚刚度矩阵为：\n$$ \\mathbf{K}_{cond} = \\mathbf{K} + \\Delta\\mathbf{K} = \\frac{AE}{h}\\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} + \\frac{A\\alpha^2 M}{h}\\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = \\frac{A(E + \\alpha^2 M)}{h}\\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} $$\n项 $E + \\alpha^2 M$ 是不排水杨氏模量，记为 $E_u$。\n\n最后，我们求 $\\mathbf{K}_{cond}$ 的特征值 $\\lambda$。令 $C = \\frac{A(E + \\alpha^2 M)}{h}$。\n特征方程为 $\\det(\\mathbf{K}_{cond} - \\lambda \\mathbf{I}) = 0$。\n$$ \\det \\begin{pmatrix} C - \\lambda  -C \\\\ -C  C - \\lambda \\end{pmatrix} = (C - \\lambda)^2 - (-C)^2 = (C - \\lambda - C)(C - \\lambda + C) = (-\\lambda)(2C - \\lambda) = 0 $$\n特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = 2C$。零特征值对应于刚体平移，此时不存在内力。问题要求的是唯一的非零特征值。\n$$ \\lambda = 2C = 2 \\frac{A(E + \\alpha^2 M)}{h} $$", "answer": "$$ \\boxed{\\frac{2A(E + \\alpha^2 M)}{h}} $$", "id": "2590016"}, {"introduction": "理论知识的最终检验在于其预测物理现象的能力。本综合练习要求您从零开始，为一个一维多孔弹性杆的固结问题建立一个完整的有限元数值模型。通过编写代码来模拟流体压力在孔隙介质中的扩散过程 [@problem_id:2589919]，您将能够直观地观察系统如何从初始的非排水状态演化到最终的排水状态。此练习特别关注渗透率 $\\kappa$ 对系统响应时间尺度的影响，并要求您通过数值实验来验证当渗透率趋于无穷大时，系统行为收敛于纯弹性（排水）极限的理论预测。", "problem": "考虑一根长度为 $L$ 的一维饱和多孔弹性杆，其承受小变形。令 $u(x,t)$ 表示固体位移，$p(x,t)$ 表示孔隙压力。该杆通过线性Biot理论进行建模，使用以下数据：杨氏模量 $E$、Biot系数 $\\alpha$、Biot模量 $M$ 和水力传导系数 $\\kappa$。基本平衡定律和本构关系被作为出发点：(i) 准静态状态下混合物的线性动量平衡，(ii) 孔隙流体的质量守恒，以及 (iii) 渗流的达西定律。具体来说，在一维空间且横截面积设为单位1的情况下，这些定律导出以下耦合偏微分方程\n$$\\frac{\\partial}{\\partial x}\\left(E\\,\\frac{\\partial u}{\\partial x}-\\alpha\\,p\\right)=0,$$\n$$\\alpha\\,\\frac{\\partial}{\\partial t}\\left(\\frac{\\partial u}{\\partial x}\\right)+\\frac{1}{M}\\,\\frac{\\partial p}{\\partial t}-\\frac{\\partial}{\\partial x}\\left(\\kappa\\,\\frac{\\partial p}{\\partial x}\\right)=0.$$\n杆在 $x=0$ 处被固定，即 $u(0,t)=0$，并在 $x=L$ 处承受给定的总牵引力 $T$，使得 $\\left(E\\,\\frac{\\partial u}{\\partial x}-\\alpha\\,p\\right)(L,t)=T$。在 $x=0$ 和 $x=L$ 处，孔隙压力被指定为恒定边界值 $p(x,t)=\\bar p$，对所有 $t\\ge 0$ 成立。初始条件为 $u(x,0)=0$ 和 $p(x,0)=\\bar p$，对所有 $x\\in[0,L]$ 成立。\n\n任务A（推导）。从上述强形式出发，对均匀网格上的 $u$ 和 $p$ 使用标准伽辽金有限元法 (FEM) 和线性形函数，推导其弱形式以及相应的半离散常微分方程组。对位移使用测试函数 $v$，对压力使用测试函数 $w$，并在适当之处进行分部积分。证明包含 $N$ 个位移和 $N$ 个压力节点自由度的半离散系统可以写成如下的分块矩阵形式\n$$\\mathbf{K}_u\\,\\mathbf{u}-\\mathbf{Q}\\,\\mathbf{p}=\\mathbf{f},$$\n$$\\mathbf{C}\\,\\dot{\\mathbf{u}}+\\mathbf{S}\\,\\dot{\\mathbf{p}}+\\mathbf{K}_p\\,\\mathbf{p}=\\mathbf{0},$$\n其中 $\\mathbf{K}_u$ 是弹性刚度矩阵，$\\mathbf{Q}$ 和 $\\mathbf{C}$ 是耦合矩阵，$\\mathbf{S}$ 是储水矩阵，$\\mathbf{K}_p$ 是流动（扩散）矩阵，$\\mathbf{f}$ 是一致牵引力荷载向量。对于一个长度为 $h$ 的双节点单元，证明其单元矩阵为\n$$\\mathbf{K}_u^{(e)}=\\frac{E}{h}\\begin{bmatrix}1  -1\\\\ -1  1\\end{bmatrix},\\quad \\mathbf{Q}^{(e)}=\\alpha\\begin{bmatrix}-\\tfrac{1}{2}  -\\tfrac{1}{2}\\\\ \\tfrac{1}{2}  \\tfrac{1}{2}\\end{bmatrix},\\quad \\mathbf{S}^{(e)}=\\frac{h}{6M}\\begin{bmatrix}2  1\\\\ 1  2\\end{bmatrix},\\quad \\mathbf{K}_p^{(e)}=\\frac{\\kappa}{h}\\begin{bmatrix}1  -1\\\\ -1  1\\end{bmatrix}.$$\n\n任务B（渐近极限）。使用半离散系统，从第一性原理出发论证为何对于固定的 $M$，当 $\\kappa\\to\\infty$ 时，在任意固定的有限时间内，孔隙压力处处趋近于边界值，即对所有 $x\\in[0,L]$，$p(x,t)\\to\\bar p$。然后，证明动量平衡方程简化为具有均匀孔隙压力的排水弹性关系，从而得到位移分布\n$$u_{\\mathrm{drained}}(x)=\\frac{T+\\alpha\\,\\bar p}{E}\\,x,$$\n该解满足 $u(0)=0$ 和 $\\left(E\\,u_x-\\alpha\\,\\bar p\\right)(L)=T$。\n\n任务C（数值验证）。使用在 $[0,L]$ 上的 $N$ 个等距节点的线性有限元，为上述半离散方程实现一个全离散的后向欧拉时间积分器。组装全局矩阵，并使用固定的时间步长 $\\Delta t$ 从 $t=0$ 推进到最终时间 $t_{\\mathrm{eval}}$。在每个时间步，求解耦合分块系统以获得 $(\\mathbf{u}^{n},\\mathbf{p}^{n})$。使用本质（狄利克雷）边界条件 $u(0,t)=0$ 和 $p(0,t)=\\bar p$, $p(L,t)=\\bar p$，并通过一致力向量施加自然牵引力 $\\left(E\\,u_x-\\alpha\\,p\\right)(L,t)=T$。测试套件采用以下参数值：\n- 域和离散化: $L=1\\,\\mathrm{m}$, $N=21$, $\\Delta t=10^{-2}\\,\\mathrm{s}$, $t_{\\mathrm{eval}}=5\\times 10^{-1}\\,\\mathrm{s}$。\n- 材料和加载: $E=2\\times 10^{7}\\,\\mathrm{Pa}$, $\\alpha=8\\times 10^{-1}$, $M=10^{9}\\,\\mathrm{Pa}$, $T=10^{5}\\,\\mathrm{Pa}$, $\\bar p=10^{5}\\,\\mathrm{Pa}$。\n- 水力传导系数测试案例: $\\kappa\\in\\{10^{-9},\\,10^{-6},\\,10^{-3}\\}\\,\\mathrm{m}^2/(\\mathrm{Pa}\\cdot\\mathrm{s})$。\n\n对于测试套件中的每个 $\\kappa$，在 $t=t_{\\mathrm{eval}}$ 时计算：\n- 最大范数压力偏差 $e_p=\\max_{i}\\left|p_i-\\bar p\\right|$，单位为 $\\mathrm{Pa}$。\n- 与排水解的最大范数位移偏差 $e_u=\\max_{i}\\left|u_i-u_{\\mathrm{drained}}(x_i)\\right|$，单位为 $\\mathrm{m}$。\n\n您的程序必须输出单行结果，该结果是所有测试案例结果的逗号分隔列表，格式为列表的列表：\n$$\\bigl[\\,[e_{p}^{(1)},e_{u}^{(1)}],\\,[e_{p}^{(2)},e_{u}^{(2)}],\\,[e_{p}^{(3)},e_{u}^{(3)}]\\,\\bigr].$$\n将 $e_p$ 以 $\\mathrm{Pa}$ 为单位、将 $e_u$ 以 $\\mathrm{m}$ 为单位表示，每个值都四舍五入到六位小数。不应打印任何其他文本。程序必须是一个完整的、可运行的实现，无需用户输入或外部文件，并且只能使用指定的库。\n\n目标是通过观察给定的测试套件中 $e_p$ 和 $e_u$ 的减小，来数值上证明当 $M$ 固定时，随着 $\\kappa$ 的增加，系统处处趋近于排水弹性状态，即 $p\\to\\bar p$ 且 $u\\to u_{\\mathrm{drained}}(x)$。", "solution": "我们从一维空间中小变形的完全饱和多孔介质的基本平衡定律出发。准静态条件下混合物的线性动量平衡可写为\n$$\\frac{\\partial}{\\partial x}\\left(\\sigma_{\\mathrm{total}}\\right)=0,$$\n其中总应力由有效应力减去流体贡献给出，\n$$\\sigma_{\\mathrm{total}}=\\sigma^{\\prime}-\\alpha\\,p,\\qquad \\sigma^{\\prime}=E\\,\\frac{\\partial u}{\\partial x}.$$\n因此，动量方程变为\n$$\\frac{\\partial}{\\partial x}\\left(E\\,\\frac{\\partial u}{\\partial x}-\\alpha\\,p\\right)=0,$$\n其自然边界条件为 $\\left(E\\,u_x-\\alpha\\,p\\right)(L,t)=T$ 且 $u(0,t)=0$。\n\n接下来，一维流体质量守恒方程为\n$$\\frac{\\partial}{\\partial t}\\left(\\alpha\\,\\varepsilon_v+\\frac{1}{M}\\,p\\right)+\\frac{\\partial q}{\\partial x}=0,$$\n其中，在一维小应变运动学中 $\\varepsilon_v=u_x$，$q$ 是达西通量。达西定律规定\n$$q=-\\kappa\\,\\frac{\\partial p}{\\partial x}.$$\n将这些代入质量平衡方程得到\n$$\\alpha\\,\\frac{\\partial}{\\partial t}\\left(\\frac{\\partial u}{\\partial x}\\right)+\\frac{1}{M}\\,\\frac{\\partial p}{\\partial t}-\\frac{\\partial}{\\partial x}\\left(\\kappa\\,\\frac{\\partial p}{\\partial x}\\right)=0.$$\n边界压力指定为 $p(0,t)=\\bar p$ 和 $p(L,t)=\\bar p$，初始条件为 $u(x,0)=0$ 和 $p(x,0)=\\bar p$。\n\n为推导弱形式，令 $v$ 和 $w$ 分别为位移和压力的测试函数。将动量方程乘以 $v$ 并进行分部积分：\n$$\\int_0^L \\left(E\\,u_x-\\alpha\\,p\\right) v_x\\,\\mathrm{d}x - \\left[\\left(E\\,u_x-\\alpha\\,p\\right) v\\right]_0^L=0.$$\n由于 $u(0,t)=0$（因此 $v(0)=0$）和自然牵引力 $\\left(E\\,u_x-\\alpha\\,p\\right)(L,t)=T$，动量方程的弱形式为\n$$\\int_0^L E\\,u_x\\,v_x\\,\\mathrm{d}x - \\int_0^L \\alpha\\,p\\,v_x\\,\\mathrm{d}x = \\int_0^L 0\\,\\mathrm{d}x + T\\,v(L).$$\n类似地，将质量平衡方程乘以 $w$ 并进行分部积分：\n$$\\int_0^L \\alpha\\,u_{x,t}\\,w\\,\\mathrm{d}x + \\int_0^L \\frac{1}{M}\\,p_t\\,w\\,\\mathrm{d}x + \\int_0^L \\kappa\\,p_x\\,w_x\\,\\mathrm{d}x - \\left[\\kappa\\,p_x\\,w\\right]_0^L = 0.$$\n由于两端都是本质压力边界条件，弱形式中的边界通量项消失。这些弱形式是有限元离散化的基础。\n\n我们现在使用均匀网格上的标准线性（双节点）形函数对 $u$ 和 $p$ 进行离散化。在一个长度为 $h$ 的单元上，令 $\\mathbf{N}=[N_1\\;N_2]$ 表示形函数行向量，$\\mathbf{B}=\\left[\\begin{smallmatrix}-1/h & 1/h\\end{smallmatrix}\\right]$ 表示微分算子。单元级矩阵由以下双线性形式产生：\n- 弹性刚度: $$\\mathbf{K}_u^{(e)}=\\int_{x_e} E\\,\\mathbf{B}^{\\mathsf{T}}\\mathbf{B}\\,\\mathrm{d}x=\\frac{E}{h}\\begin{bmatrix}1 & -1\\\\ -1 & 1\\end{bmatrix}$$\n- 耦合: $$\\mathbf{Q}^{(e)}=\\int_{x_e} \\alpha\\,\\mathbf{B}^{\\mathsf{T}}\\mathbf{N}\\,\\mathrm{d}x=\\alpha\\begin{bmatrix}-\\tfrac{1}{2} & -\\tfrac{1}{2}\\\\ \\tfrac{1}{2} & \\tfrac{1}{2}\\end{bmatrix}, \\quad \\text{以及} \\quad \\mathbf{C}^{(e)}=(\\mathbf{Q}^{(e)})^{\\mathsf{T}}$$\n- 储水: $$\\mathbf{S}^{(e)}=\\int_{x_e} \\frac{1}{M}\\,\\mathbf{N}^{\\mathsf{T}}\\mathbf{N}\\,\\mathrm{d}x=\\frac{h}{6M}\\begin{bmatrix}2 & 1\\\\ 1 & 2\\end{bmatrix}$$\n- 流动: $$\\mathbf{K}_p^{(e)}=\\int_{x_e} \\kappa\\,\\left(\\frac{\\partial \\mathbf{N}}{\\partial x}\\right)^{\\mathsf{T}}\\left(\\frac{\\partial \\mathbf{N}}{\\partial x}\\right)\\,\\mathrm{d}x=\\frac{\\kappa}{h}\\begin{bmatrix}1 & -1\\\\ -1 & 1\\end{bmatrix}$$\n在所有单元上进行组装，得到全局半离散系统\n$$\\mathbf{K}_u\\,\\mathbf{u}-\\mathbf{Q}\\,\\mathbf{p}=\\mathbf{f},\\qquad \\mathbf{C}\\,\\dot{\\mathbf{u}}+\\mathbf{S}\\,\\dot{\\mathbf{p}}+\\mathbf{K}_p\\,\\mathbf{p}=\\mathbf{0}.$$\n\n对于时间离散化，我们采用时间步长为 $\\Delta t$ 的后向欧拉格式。令上标表示时间层级。在第 $n$ 步的全离散系统为\n$$\\mathbf{K}_u\\,\\mathbf{u}^{n}-\\mathbf{Q}\\,\\mathbf{p}^{n}=\\mathbf{f},$$\n$$\\frac{1}{\\Delta t}\\mathbf{C}\\,\\mathbf{u}^{n}+\\left(\\frac{1}{\\Delta t}\\mathbf{S}+\\mathbf{K}_p\\right)\\mathbf{p}^{n}=\\frac{1}{\\Delta t}\\mathbf{C}\\,\\mathbf{u}^{n-1}+\\frac{1}{\\Delta t}\\mathbf{S}\\,\\mathbf{p}^{n-1}.$$\n这可以被写成一个耦合分块线性系统，并在每个时间步进行求解。本质边界条件 $u(0,t)=0$ 和 $p(0,t)=\\bar p$, $p(L,t)=\\bar p$ 通过修改代数系统来强施加，而自然牵引力 $T$ 则作为节点力施加在位移方程的右端。\n\n为分析 $M$ 固定时 $\\kappa\\to\\infty$ 的极限，考虑半离散的质量平衡方程。在任意固定的有限时间步长下，方程\n$$\\mathbf{C}\\,\\dot{\\mathbf{u}}+\\mathbf{S}\\,\\dot{\\mathbf{p}}+\\mathbf{K}_p\\,\\mathbf{p}=\\mathbf{0}$$\n表明扩散算子 $\\mathbf{K}_p$ 与 $\\kappa$ 呈线性关系。当 $\\kappa\\to\\infty$ 时，除非 $\\mathbf{p}$ 几乎处于 $\\mathbf{K}_p$ 的零空间中，否则 $\\mathbf{K}_p\\,\\mathbf{p}$ 项在左侧占主导地位。由于 $\\mathbf{K}_p$ 是一个两端带有狄利克雷条件的二阶算子的刚度矩阵，当边界条件强制两端 $p=\\bar p$ 时，其零空间仅包含常数向量 $\\mathbf{p}=\\bar p\\,\\mathbf{1}$。因此，在固定时间下的唯一有界解是 $\\mathbf{p}\\to \\bar p\\,\\mathbf{1}$，即对所有 $x$，$p(x,t)\\to\\bar p$。将这个均匀压力代入动量平衡方程得到\n$$\\frac{\\partial}{\\partial x}\\left(E\\,u_x-\\alpha\\,\\bar p\\right)=0\\;\\;\\Rightarrow\\;\\;E\\,u_x-\\alpha\\,\\bar p=\\mathrm{const}.$$\n施加 $\\left(E\\,u_x-\\alpha\\,\\bar p\\right)(L)=T$ 可得处处有 $E\\,u_x-\\alpha\\,\\bar p=T$，由此\n$$u_{\\mathrm{drained}}(x)=\\frac{T+\\alpha\\,\\bar p}{E}\\,x,$$\n满足 $u(0)=0$。因此，在 $M$ 固定且 $\\kappa\\to\\infty$ 的极限下，我们得到了排水弹性解。\n\n为了进行数值验证，我们实现了如前所述的后向欧拉混合有限元法。我们选择 $L=1\\,\\mathrm{m}$，$N=21$，$\\Delta t=10^{-2}\\,\\mathrm{s}$，$t_{\\mathrm{eval}}=5\\times 10^{-1}\\,\\mathrm{s}$，$E=2\\times 10^{7}\\,\\mathrm{Pa}$，$\\alpha=8\\times 10^{-1}$，$M=10^{9}\\,\\mathrm{Pa}$，$T=10^{5}\\,\\mathrm{Pa}$，$\\bar p=10^{5}\\,\\mathrm{Pa}$，以及三种电导率 $\\kappa\\in\\{10^{-9},\\,10^{-6},\\,10^{-3}\\}\\,\\mathrm{m}^2/(\\mathrm{Pa}\\cdot\\mathrm{s})$。初始条件为 $\\mathbf{u}^0=\\mathbf{0}$ 和 $\\mathbf{p}^0=\\bar p\\,\\mathbf{1}$。在 $t_{\\mathrm{eval}}$ 时，我们计算 $e_p=\\max_i|p_i-\\bar p|$（单位为Pa）和 $e_u=\\max_i|u_i-u_{\\mathrm{drained}}(x_i)|$（单位为m）。随着 $\\kappa$ 在测试套件中增加，扩散算子的主导作用更强地强制 $p\\approx\\bar p$，因此 $e_p$ 和 $e_u$ 单调递减，从而证实了渐近排水极限。程序输出形如 $\\bigl[\\,[e_{p}^{(1)},e_{u}^{(1)}],\\,[e_{p}^{(2)},e_{u}^{(2)}],\\,[e_{p}^{(3)},e_{u}^{(3)}]\\,\\bigr]$ 的单行结果，其中每个值都四舍五入到六位小数，从而为 $M$ 固定时 $\\kappa\\to\\infty$ 系统收敛于排水弹性的现象提供了可量化的数值证明。", "answer": "```python\n# Poroelastic 1D Biot mixed FEM with backward Euler time stepping\n# Verifies that as kappa increases (with fixed M), p -> pbar and u -> drained elasticity.\n# Python 3.12, numpy 1.23.5, scipy 1.11.4 (not used).\nimport numpy as np\n\ndef assemble_matrices(n_nodes, L, E, alpha, M, kappa):\n    \"\"\"\n    Assemble global matrices for 1D linear elements on a uniform mesh.\n    Returns Ku, Q, S, Kp (each n x n).\n    \"\"\"\n    n = n_nodes\n    Ku = np.zeros((n, n), dtype=float)\n    Q = np.zeros((n, n), dtype=float)\n    S = np.zeros((n, n), dtype=float)\n    Kp = np.zeros((n, n), dtype=float)\n\n    h = L / (n - 1)\n\n    Ku_e = (E / h) * np.array([[1.0, -1.0],\n                               [-1.0, 1.0]])\n    Q_e = alpha * np.array([[-0.5, -0.5],\n                            [ 0.5,  0.5]])\n    S_e = (h / (6.0 * M)) * np.array([[2.0, 1.0],\n                                      [1.0, 2.0]])\n    Kp_e = (kappa / h) * np.array([[1.0, -1.0],\n                                   [-1.0, 1.0]])\n\n    for e in range(n - 1):\n        idx = [e, e + 1]\n        # Assemble\n        Ku[np.ix_(idx, idx)] += Ku_e\n        Q[np.ix_(idx, idx)] += Q_e\n        S[np.ix_(idx, idx)] += S_e\n        Kp[np.ix_(idx, idx)] += Kp_e\n\n    return Ku, Q, S, Kp\n\ndef apply_dirichlet(A, b, dof_indices, values):\n    \"\"\"\n    Apply Dirichlet constraints to the linear system A x = b.\n    dof_indices: list of indices in the global DOF vector.\n    values: corresponding Dirichlet values.\n    Modifies A and b in place (dense arrays).\n    \"\"\"\n    for idx, val in zip(dof_indices, values):\n        # Shift known value to RHS for all equations\n        b -= A[:, idx] * val\n        # Zero row and column, set diagonal to 1 and RHS to value\n        A[:, idx] = 0.0\n        A[idx, :] = 0.0\n        A[idx, idx] = 1.0\n        b[idx] = val\n\ndef solve_case(kappa, params):\n    \"\"\"\n    Solve the transient Biot system for a given kappa, return (e_p_max, e_u_max).\n    \"\"\"\n    # Unpack parameters\n    L = params[\"L\"]\n    n_nodes = params[\"n_nodes\"]\n    E = params[\"E\"]\n    alpha = params[\"alpha\"]\n    M = params[\"M\"]\n    T = params[\"T\"]\n    pbar = params[\"pbar\"]\n    dt = params[\"dt\"]\n    t_eval = params[\"t_eval\"]\n\n    # Assemble matrices\n    Ku, Q, S, Kp = assemble_matrices(n_nodes, L, E, alpha, M, kappa)\n    C = Q.T\n\n    n = n_nodes\n    size = 2 * n\n\n    # Coordinates and initial conditions\n    x = np.linspace(0.0, L, n)\n    u_prev = np.zeros(n, dtype=float)\n    p_prev = np.full(n, pbar, dtype=float)\n\n    # Time stepping\n    n_steps = int(round(t_eval / dt))\n    # Consistent traction vector (only at the last node for 1D bar)\n    f_u = np.zeros(n, dtype=float)\n    f_u[-1] = T\n\n    for _ in range(n_steps):\n        # Build block matrix and RHS for backward Euler\n        A = np.zeros((size, size), dtype=float)\n        b = np.zeros(size, dtype=float)\n\n        # Top-left block: Ku\n        A[0:n, 0:n] = Ku\n        # Top-right block: -Q\n        A[0:n, n:size] = -Q\n        # Bottom-left block: (1/dt) * C\n        A[n:size, 0:n] = (1.0 / dt) * C\n        # Bottom-right block: (S/dt + Kp)\n        A[n:size, n:size] = (1.0 / dt) * S + Kp\n\n        # RHS\n        b[0:n] = f_u  # traction\n        b[n:size] = (1.0 / dt) * (C @ u_prev) + (1.0 / dt) * (S @ p_prev)\n\n        # Dirichlet boundary conditions:\n        # u(0) = 0, p(0) = pbar, p(L) = pbar\n        dir_indices = [0, n + 0, n + (n - 1)]\n        dir_values = [0.0, pbar, pbar]\n        apply_dirichlet(A, b, dir_indices, dir_values)\n\n        # Solve linear system\n        sol = np.linalg.solve(A, b)\n        u_curr = sol[0:n]\n        p_curr = sol[n:size]\n\n        # Update\n        u_prev = u_curr\n        p_prev = p_curr\n\n    # Compute errors at final time\n    e_p = float(np.max(np.abs(p_curr - pbar)))\n    u_drained = ((T + alpha * pbar) / E) * x\n    e_u = float(np.max(np.abs(u_curr - u_drained)))\n\n    return e_p, e_u\n\ndef solve():\n    # Parameters (SI units)\n    params = {\n        \"L\": 1.0,                # m\n        \"n_nodes\": 21,           # nodes\n        \"E\": 2.0e7,              # Pa\n        \"alpha\": 0.8,            # -\n        \"M\": 1.0e9,              # Pa\n        \"T\": 1.0e5,              # Pa\n        \"pbar\": 1.0e5,           # Pa\n        \"dt\": 1.0e-2,            # s\n        \"t_eval\": 5.0e-1,        # s\n    }\n\n    # Test suite for kappa (m^2 / (Pa s))\n    kappas = [1.0e-9, 1.0e-6, 1.0e-3]\n\n    results = []\n    for kappa in kappas:\n        e_p, e_u = solve_case(kappa, params)\n        # Round to six decimal places as required\n        results.append([round(e_p, 6), round(e_u, 6)])\n\n    # Print in the exact required single-line format\n    print(str(results))\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2589919"}]}