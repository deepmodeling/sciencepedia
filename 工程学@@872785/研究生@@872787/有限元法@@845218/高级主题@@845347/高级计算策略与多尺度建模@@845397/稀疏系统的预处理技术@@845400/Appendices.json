{"hands_on_practices": [{"introduction": "预处理器通常不仅仅是近似逆；它们可以被设计用来针对误差的特定分量。本练习探讨了“光滑化”这一概念，它是多重网格方法的基础。通过分析经典泊松问题中的加权雅可比迭代[@problem_id:2590453]，你将进行一次傅里叶分析，以精确观察这种简单的迭代方法如何衰减高频误差分量，并推导出最大化此效应的最优松弛参数。", "problem": "考虑一维（$1$D）泊松边界值问题 $-u'' = f$，定义在区间 $(0,1)$ 上，并具有齐次狄利克雷边界条件 $u(0)=u(1)=0$。设该问题通过有限元法（FEM）进行离散化，使用在间距为 $h = \\frac{1}{n+1}$ 的均匀网格上的连续分段线性基函数，产生一个稀疏对称正定（SPD）刚度矩阵 $A \\in \\mathbb{R}^{n \\times n}$，其元素为 $a_{ii} = \\frac{2}{h}$，$a_{i,i\\pm 1} = -\\frac{1}{h}$，其余为零。考虑将加权雅可比迭代作为此稀疏系统的双网格多重网格预条件子中的预平滑步骤，该迭代由误差传播算子 $S_{\\omega} = I - \\omega D^{-1} A$ 定义，其中 $D = \\operatorname{diag}(A)$，权重 $\\omega \\in (0,1)$。\n\n将相对于一个因子为 $2$ 的标准粗化的高频误差子空间定义为离散频率 $\\theta$ 位于 $[\\frac{\\pi}{2}, \\pi]$ 内的特征模态的张成空间。从核心定义（有限元刚度矩阵结构和加权雅可比迭代的定义）出发，推导 $S_{\\omega}$ 的特征值作为离散频率 $\\theta$ 的显式函数，证明对于任何 $\\omega \\in (0,1)$，所有高频分量的幅值衰减都严格小于 $1$，然后对 $\\theta \\in [\\frac{\\pi}{2}, \\pi]$ 上的最坏情况下的高频放大因子关于 $\\omega \\in (0,1)$ 进行最小化，以获得最优权重。\n\n以 $\\omega$ 的单一最优值的精确形式报告最终答案。无需四舍五入，最终答案不带单位。", "solution": "问题陈述需经过验证。\n\n**步骤 1：提取已知条件**\n- **问题**：一维（$1$D）泊松边界值问题 $-u'' = f$，定义在区间 $(0,1)$ 上。\n- **边界条件**：齐次狄利克雷边界条件，$u(0)=u(1)=0$。\n- **离散化方法**：有限元法（FEM），使用连续分段线性基函数。\n- **网格**：均匀网格，间距为 $h = \\frac{1}{n+1}$。\n- **刚度矩阵**：$A \\in \\mathbb{R}^{n \\times n}$，对称正定（SPD）。\n- **矩阵元素**：$a_{ii} = \\frac{2}{h}$，$a_{i,i\\pm 1} = -\\frac{1}{h}$，其余为零。\n- **迭代法**：加权雅可比方法作为预平滑器。\n- **误差传播算子**：$S_{\\omega} = I - \\omega D^{-1} A$。\n- **定义**：$D = \\operatorname{diag}(A)$，权重 $\\omega \\in (0,1)$。\n- **高频子空间**：离散频率 $\\theta$ 在 $[\\frac{\\pi}{2}, \\pi]$ 内的特征模态的张成空间。\n- **目标**：将 $S_{\\omega}$ 的特征值推导为 $\\theta$ 的函数，证明高频分量的衰减性，并找到最小化最坏情况高频放大因子的最优权重 $\\omega$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，是偏微分方程数值分析领域中的一个典型模型问题，特别是在多重网格方法的研究中。一维泊松问题的有限元刚度矩阵的构建是标准的。加权雅可比方法及其分析是迭代法中的基本课题。用于双网格分析的高频模式的定义是正确的。该问题是适定的、自洽的，并以客观、明确的语言表述。所有推导唯一、有意义解所需的信息都已提供。不存在科学缺陷、矛盾或歧义。\n\n**步骤 3：结论与行动**\n问题有效。将进行严谨的求解。\n\n**求解推导**\n\n由指定的有限元离散化产生的刚度矩阵 $A$ 是一个三对角托普利茨 (Toeplitz) 矩阵，形式如下\n$$\nA = \\frac{1}{h}\n\\begin{pmatrix}\n2  -1  0  \\cdots  0 \\\\\n-1  2  -1  \\cdots  0 \\\\\n0  -1  2  \\ddots  \\vdots \\\\\n\\vdots  \\vdots  \\ddots  \\ddots  -1 \\\\\n0  0  \\cdots  -1  2\n\\end{pmatrix}\n$$\n该矩阵的特征向量 $v_k$ 和特征值 $\\lambda_k(A)$ 是众所周知的。对于 $k=1, 2, \\dots, n$，特征向量的分量为 $(v_k)_j = \\sin(k \\pi j h)$，其中 $j=1, \\dots, n$。将矩阵 $A$ 应用于特征向量 $v_k$，其第 $j$ 个分量为：\n$$\n(A v_k)_j = \\frac{1}{h} \\left( - (v_k)_{j-1} + 2(v_k)_j - (v_k)_{j+1} \\right)\n= \\frac{1}{h} \\left( -\\sin(k\\pi(j-1)h) + 2\\sin(k\\pi j h) - \\sin(k\\pi(j+1)h) \\right)\n$$\n使用三角恒等式 $\\sin(x-y) + \\sin(x+y) = 2\\sin(x)\\cos(y)$，我们简化表达式：\n$$\n(A v_k)_j = \\frac{1}{h} \\left( 2\\sin(k\\pi j h) - 2\\sin(k\\pi j h)\\cos(k\\pi h) \\right) = \\frac{2}{h} (1 - \\cos(k\\pi h)) (v_k)_j\n$$\n使用半角恒等式 $1 - \\cos(x) = 2\\sin^2(x/2)$，$A$ 的特征值为：\n$$\n\\lambda_k(A) = \\frac{4}{h} \\sin^2\\left(\\frac{k\\pi h}{2}\\right), \\quad k=1, \\dots, n\n$$\n问题将离散频率定义为 $\\theta_k = k\\pi h$。因此，特征值可以表示为频率 $\\theta_k$ 的函数：\n$$\n\\lambda(\\theta_k) = \\frac{4}{h} \\sin^2\\left(\\frac{\\theta_k}{2}\\right)\n$$\n加权雅可比误差传播算子是 $S_{\\omega} = I - \\omega D^{-1} A$。矩阵 $D$ 是 $A$ 的对角部分，所以 $D = \\operatorname{diag}(a_{ii}) = \\frac{2}{h}I$，其中 $I$ 是单位矩阵。其逆矩阵为 $D^{-1} = \\frac{h}{2}I$。\n将 $D^{-1}$ 代入 $S_{\\omega}$ 的表达式：\n$$\nS_{\\omega} = I - \\omega \\left(\\frac{h}{2}I\\right) A = I - \\frac{\\omega h}{2} A\n$$\n由于 $S_{\\omega}$ 是 $A$ 的一个多项式，它与 $A$ 共享相同的特征向量 $v_k$。$S_{\\omega}$ 的特征值（记为 $\\mu_k$）可通过将相同的多项式应用于 $A$ 的特征值得到：\n$$\n\\mu_k = 1 - \\frac{\\omega h}{2} \\lambda_k(A) = 1 - \\frac{\\omega h}{2} \\left( \\frac{4}{h} \\sin^2\\left(\\frac{k\\pi h}{2}\\right) \\right) = 1 - 2\\omega \\sin^2\\left(\\frac{k\\pi h}{2}\\right)\n$$\n将此表示为离散频率 $\\theta = k\\pi h$ 的函数，我们得到 $S_{\\omega}$ 的特征值作为 $\\theta$ 的函数：\n$$\n\\mu(\\theta) = 1 - 2\\omega \\sin^2\\left(\\frac{\\theta}{2}\\right)\n$$\n使用恒等式 $\\cos(\\theta) = 1 - 2\\sin^2(\\theta/2)$，我们可以更方便地将其写作：\n$$\n\\mu(\\theta) = 1 - \\omega(1 - \\cos(\\theta)) = (1-\\omega) + \\omega\\cos(\\theta)\n$$\n接下来，我们必须分析高频误差分量的衰减情况，这些分量对应于频率范围 $\\theta \\in [\\frac{\\pi}{2}, \\pi]$。对于该区间内的 $\\theta$，余弦函数 $\\cos(\\theta)$ 的取值范围是 $[-1, 0]$。\n已知权重 $\\omega$ 在区间 $(0, 1)$ 内，$\\omega$ 是严格正的。因此，$\\omega\\cos(\\theta)$ 位于区间 $[-\\omega, 0]$ 内。\n因此，特征值 $\\mu(\\theta)$ 的界限为：\n$$\n(1-\\omega) + \\omega(-1) \\le \\mu(\\theta) \\le (1-\\omega) + \\omega(0)\n$$\n$$\n1-2\\omega \\le \\mu(\\theta) \\le 1-\\omega\n$$\n由于 $\\omega \\in (0,1)$，我们有 $1-\\omega  1$。并且，$1-2\\omega > -1$，因为 $2 > 2\\omega$，这在 $\\omega  1$ 时成立。\n因此，对于任意 $\\theta \\in [\\frac{\\pi}{2}, \\pi]$ 和任意 $\\omega \\in (0,1)$，特征值满足 $-1  \\mu(\\theta)  1$，这意味着 $|\\mu(\\theta)|  1$。这证实了所有高频分量都被严格衰减。\n\n最后一步是找到最优权重 $\\omega_{opt}$，以最小化最坏情况（最大）下的高频放大因子。该因子也称为平滑因子，定义为：\n$$\n\\rho_{HF}(\\omega) = \\max_{\\theta \\in [\\pi/2, \\pi]} |\\mu(\\theta)| = \\max_{\\theta \\in [\\pi/2, \\pi]} |(1-\\omega) + \\omega\\cos(\\theta)|\n$$\n函数 $\\mu(\\theta)$ 相对于 $\\cos(\\theta)$ 是线性的。由于 $\\cos(\\theta)$ 在区间 $[\\frac{\\pi}{2}, \\pi]$ 上是单调函数，$\\mu(\\theta)$ 的极值必定出现在该区间的端点，即 $\\theta=\\frac{\\pi}{2}$ 和 $\\theta=\\pi$。\n在 $\\theta = \\frac{\\pi}{2}$ 处：\n$$\n\\mu(\\pi/2) = (1-\\omega) + \\omega\\cos(\\pi/2) = 1-\\omega\n$$\n在 $\\theta = \\pi$ 处：\n$$\n\\mu(\\pi) = (1-\\omega) + \\omega\\cos(\\pi) = 1-2\\omega\n$$\n因此，平滑因子是这两个量绝对值的最大值：\n$$\n\\rho_{HF}(\\omega) = \\max(|1-\\omega|, |1-2\\omega|)\n$$\n我们寻求在 $\\omega \\in (0,1)$ 上最小化该函数。\n对于 $\\omega \\in (0,1)$，项 $1-\\omega$ 总是正的，所以 $|1-\\omega|=1-\\omega$。\n项 $1-2\\omega$ 在 $\\omega=1/2$ 处变号。\n问题是求解 $\\arg\\min_{\\omega \\in (0,1)} \\max(1-\\omega, |1-2\\omega|)$。\n两个连续函数的最大值的最小值通常在两个函数值相等时达到。我们寻求一个 $\\omega$，使得在频率边界处的放大率达到平衡。\n令 max 函数的两个参数在数值上相等：\n$$\n|1-\\omega| = |1-2\\omega| \\implies 1-\\omega = |1-2\\omega|\n$$\n该方程产生两种可能性：\n1. $1-\\omega = 1-2\\omega \\implies \\omega=0$。这不在指定的区间 $(0,1)$ 内。\n2. $1-\\omega = -(1-2\\omega) = 2\\omega - 1$。\n求解第二种情况：\n$$\n2 = 3\\omega \\implies \\omega = \\frac{2}{3}\n$$\n这个值 $\\omega = \\frac{2}{3}$ 在区间 $(0,1)$ 内。在此值下，放大因子为：\n$$\n\\rho_{HF}(2/3) = \\max\\left(\\left|1-\\frac{2}{3}\\right|, \\left|1-2\\left(\\frac{2}{3}\\right)\\right|\\right) = \\max\\left(\\left|\\frac{1}{3}\\right|, \\left|-\\frac{1}{3}\\right|\\right) = \\frac{1}{3}\n$$\n对于 $\\omega \\in (0,1)$ 中的任何其他值，放大因子都会更大。例如，如果 $\\omega  2/3$，则 $1-\\omega > 1/3$ 并且 $|1-2\\omega|  1/3$（对于 $\\omega > 1/2$），所以 $\\rho_{HF}(\\omega) = 1-\\omega > 1/3$。如果 $\\omega > 2/3$，则 $1-\\omega  1/3$ 并且 $|1-2\\omega| > 1/3$，所以 $\\rho_{HF}(\\omega) = |1-2\\omega| > 1/3$。\n因此，平滑因子 $\\rho_{HF}(\\omega)$ 的最小值确实是 $1/3$，并且在 $\\omega = 2/3$ 时达到。\n最优权重为 $\\omega_{opt} = 2/3$。", "answer": "$$\n\\boxed{\\frac{2}{3}}\n$$", "id": "2590453"}, {"introduction": "在实际的有限元分析中，诸如高对比度材料系数等物理特性会带来显著的数值挑战。本练习探讨了为何一个标准且强大的预处理器——不完全Cholesky分解，在应用于此类问题产生的病态矩阵时，会变得不稳定甚至完全失效[@problem_id:2590421]。你的任务是诊断这种失效的根本原因——不良的矩阵缩放——并评估各种对角缩放策略，这些策略在恢复鲁棒性的同时，保持了预处理共轭梯度（PCG）算法所需的性质。", "problem": "您在一个有界Lipschitz域$\\Omega \\subset \\mathbb{R}^d$上，使用齐次Dirichlet边界条件，通过协调有限元方法离散化标量扩散方程$-\\nabla \\cdot \\left(k(\\mathbf{x}) \\nabla u(\\mathbf{x})\\right) = f(\\mathbf{x})$。该方法使用拟一致网格上的连续分片线性基函数$\\{\\phi_i\\}_{i=1}^n$。组装得到的刚度矩阵$A \\in \\mathbb{R}^{n \\times n}$的元素为$A_{ij} = \\int_{\\Omega} k(\\mathbf{x}) \\nabla \\phi_i \\cdot \\nabla \\phi_j \\, \\mathrm{d}\\mathbf{x}$，且该矩阵是对称正定的。\n\n假设扩散系数$k(\\mathbf{x})$是具有高对比度的分片常数：存在不相交的子区域，其中$k(\\mathbf{x}) = k_{\\min}$，而在其他区域$k(\\mathbf{x}) = k_{\\max}$，其对比度$J = k_{\\max}/k_{\\min} \\gg 1$。在实践中，当使用预条件共轭梯度（PCG）方法求解$A x = b$时，若预条件子是基于$A$构建的零填充不完全Cholesky分解（IC(0)）（或等效地，专用于对称正定矩阵的零填充不完全LU分解（ILU(0)）），对于大的$J$值，会观察到严重的迭代停滞，有时甚至分解失败（由于出现非正主元）。\n\n仅使用有限元方法和线性代数的基本原理，分析为何会发生此类失败。您的分析应从双线性形式$a(u,v) = \\int_{\\Omega} k(\\mathbf{x}) \\nabla u \\cdot \\nabla v \\, \\mathrm{d}\\mathbf{x}$、单元对$A$的贡献结构、以及诸如Gershgorin圆盘定理和对角占优性与主元大小在不进行主元选择的不完全分解中的作用等基本矩阵事实出发。然后，识别哪些对角缩放或均衡策略在理论上可以提高IC(0)/ILU(0)对此类问题的鲁棒性，同时保持PCG方法对所得预处理系统的适用性。\n\n选择所有有效选项，并对每个选择在心中简要论证其如何从第一性原理推导得出，而非依赖于黑箱结果。\n\nA. 应用对称对角均衡，令$D = \\mathrm{diag}(A)$，形成缩放后的系统$\\tilde{A} = D^{-1/2} A D^{-1/2}$，对$\\tilde{A}$计算IC(0)，并用PCG求解$\\tilde{y}$；然后通过$x = D^{-1/2} \\tilde{y}$恢复$x$。这保持了对称性并减少了对角线元素的变异性，从而倾向于稳定不完全分解的主元。\n\nB. 仅执行左行均衡：令$D_r$包含正的行范数（例如，行绝对值和），形成$\\hat{A} = D_r^{-1} A$，对$\\hat{A}$计算ILU(0)，并对原始对称系统$A x = b$使用相同的PCG设置，声称这提高了鲁棒性而不影响PCG的有效性。\n\nC. 使用迭代Ruiz均衡找到对角矩阵$D_r$和$D_c$，使得$D_r A D_c$的行和列的2-范数近似为单位1；然后设置$D = \\sqrt{D_r D_c}$并形成对称缩放$\\tilde{A} = D^{-1/2} A D^{-1/2}$，之后再应用IC(0)，同时保持PCG的适用性。\n\nD. 使用基于匹配的对角缩放：找到对角矩阵$D_r$和$D_c$，使得$D_r A D_c$的对角线元素量级为1且相对于非对角线元素较大（例如，通过最大乘积匹配），然后定义$D = \\sqrt{D_r D_c}$并在IC(0)之前形成$\\tilde{A} = D^{-1/2} A D^{-1/2}$，这保持了对称性并增强了主元。\n\nE. 在组装过程中，将每个单元刚度子矩阵$K_e$乘以$k_e^{-1}$，其中$k_e$是单元上的扩散系数，组装修改后的矩阵，然后应用IC(0)而不进行进一步缩放，声称这在代数层面中和了非均匀性，而不会以损害正确性的方式改变连续算子。\n\n选择所有适用项。", "solution": "问题陈述在科学上和数学上是合理的。它描述了在使用有限元方法数值求解偏微分方程时的一个标准场景，其中高对比度的材料系数会导致病态线性系统，这对标准的迭代求解器和预条件子构成了挑战。所观察到的失败是一个有据可查的现象。\n\n核心任务是首先分析这种对于零填充不完全Cholesky分解（记为IC(0)）的失败机理，然后评估几种提议的缩放策略，看它们在减轻这种失败的同时，是否能保持使用预条件共轭梯度（PCG）方法所必需的矩阵性质。\n\n首先，我们分析数值困难的来源。刚度矩阵$A$的元素由$A_{ij} = \\int_{\\Omega} k(\\mathbf{x}) \\nabla \\phi_i \\cdot \\nabla \\phi_j \\, \\mathrm{d}\\mathbf{x}$给出。矩阵$A$由单元刚度矩阵$K_e$组装而成，其元素为$[K_e]_{ab} = \\int_{K_e} k_e \\nabla \\psi_a \\cdot \\nabla \\psi_b \\, \\mathrm{d}\\mathbf{x}$，其中$k_e$是$k(\\mathbf{x})$在单元$K_e$上的常数值。因此，$K_e$元素的大小与$k_e$成正比。\n\n当域$\\Omega$包含具有高对比度扩散系数的子区域时，即$J = k_{\\max}/k_{\\min} \\gg 1$，全局矩阵$A$的元素将在数量级上表现出巨大差异。对角元素$A_{ii}$对应于以节点$i$为中心的基函数$\\phi_i$。其值是包含该节点的所有单元贡献的总和：$A_{ii} = \\sum_{e | i \\in e} \\int_{K_e} k_e |\\nabla \\phi_i|^2 \\, \\mathrm{d}\\mathbf{x}$。如果节点$i$深处于$k(\\mathbf{x}) = k_{\\max}$的区域，那么$A_{ii}$的量级将是$k_{\\max}$。如果它深处于$k(\\mathbf{x}) = k_{\\min}$的区域，那么$A_{ii}$的量级将是$k_{\\min}$。因此，$A$的对角元素的差异可达约$J$倍。只有当节点$i$和$j$属于同一单元时，非对角元素$A_{ij}$才非零；其大小与共享单元的$k_e$成正比。这导致矩阵$A$的尺度非常差。尽管$A$是对称正定（SPD）的，但其条件数$\\kappa(A)$通常非常大，并随对比度$J$而增长，这解释了迭代方法的缓慢收敛或停滞。\n\nIC(0)预条件子的失效则更为微妙。SPD矩阵$A$的IC(0)分解旨在寻找一个下三角矩阵$L$，其稀疏模式与$A$的下三角部分相同，使得$A \\approx L L^T$。$L$的元素通过以下递推公式计算：\n$$L_{ii} = \\sqrt{A_{ii} - \\sum_{k", "answer": "$$\\boxed{ACD}$$", "id": "2590421"}, {"introduction": "在数学上最优雅的预处理器在实践中并不总是最快的；在应用预处理器的成本和它所节省的迭代次数之间存在一个关键的权衡。本练习[@problem_id:2590469]将你带入性能工程的领域，要求你为总求解时间建立一个简单的分析模型。通过平衡迭代次数模型与预处理器成本模型，你将推导出ILUT预处理器的最优丢弃容差，以最小化实际的计算时间。", "problem": "一个线性系统 $A x = b$ 由一个在形状规则网格上的二阶椭圆边值问题的协调有限元(FE)离散化产生，该过程生成了一个大型稀疏矩阵 $A$。您可以使用带舍弃容差 $\\tau \\in (0,1]$ 的带阈值不完全$\\mathrm{LU}$分解(ILUT)预处理器，通过右预处理的广义最小残差法(GMRES)来求解该系统。假设在 $\\tau$ 的一个操作范围内，以下建模假设成立，在该范围内预处理器是稳定的，且预处理算子的谱是良态的。\n\n1. GMRES的单次迭代需要一次稀疏矩阵向量乘积(SpMV)和两次使用ILUT因子的三角求解。SpMV的成本为 $C_{\\mathrm{spmv}}$ (一个正常数)。ILUT因子中的非零元总数由 $\\phi(\\tau) = \\phi_{0} + \\phi_{1}\\,\\tau^{-1}$ 建模，其中 $\\phi_{0}  0$ 且 $\\phi_{1}  0$。每次三角求解的成本为 $c_{t}\\,\\phi(\\tau)$，其中 $c_{t}  0$。因此，单次迭代的成本为\n$$\nC_{\\mathrm{it}}(\\tau) = C_{\\mathrm{spmv}} + 2\\,c_{t}\\,\\phi(\\tau).\n$$\n\n2. 对于一个给定的相对残差缩减目标 $\\varepsilon \\in (0,1)$，GMRES的迭代次数建模为\n$$\nk(\\tau) = \\ln\\!\\big(\\varepsilon^{-1}\\big)\\,\\big(\\alpha_{0} + \\alpha_{1}\\,\\tau\\big),\n$$\n其中 $\\alpha_{0}  0$ 且 $\\alpha_{1}  0$。这反映了随着舍弃容差 $\\tau$ 增大（舍弃更多元素），预处理器变弱，需要更多次迭代；而当 $\\tau \\to 0$ 时，迭代次数接近一个与 $\\ln(\\varepsilon^{-1})$ 成正比的下限。\n\n3. 总求解时间是 $T(\\tau) = k(\\tau)\\,C_{\\mathrm{it}}(\\tau)$ 的乘积；忽略其他成本。\n\n仅使用这些假设以及求解时间和运算成本的标准定义，推导出在上述模型有效的允许范围内，使总求解时间 $T(\\tau)$ 最小化的舍弃容差 $\\tau^{\\ast}$。将最终答案表示为由正常数 $C_{\\mathrm{spmv}}$、$c_{t}$、$\\phi_{0}$、$\\phi_{1}$、$\\alpha_{0}$、$\\alpha_{1}$ 和 $\\varepsilon$ 构成的单个闭式解析表达式。不需要进行数值计算，也不需要单位。最终答案必须是单个解析表达式。", "solution": "所述问题具有科学依据、适定、客观且自洽。它提出了一个出现在迭代线性求解器性能建模中的标准优化任务。所有必要的函数形式和常数均已提供。不存在矛盾、歧义或违反物理或数学原理的情况。因此，该问题是有效的，并将推导出其解答。\n\n目标是找到最优舍弃容差，记作 $\\tau^{\\ast}$，它能使总求解时间 $T(\\tau)$ 最小化。总时间由迭代次数 $k(\\tau)$ 和每次迭代的成本 $C_{\\mathrm{it}}(\\tau)$ 的乘积给出。\n$$\nT(\\tau) = k(\\tau) C_{\\mathrm{it}}(\\tau)\n$$\n提供的 $k(\\tau)$ 和 $C_{\\mathrm{it}}(\\tau)$ 模型为：\n$$\nk(\\tau) = \\ln(\\varepsilon^{-1})(\\alpha_{0} + \\alpha_{1}\\tau)\n$$\n$$\nC_{\\mathrm{it}}(\\tau) = C_{\\mathrm{spmv}} + 2c_{t}\\phi(\\tau) = C_{\\mathrm{spmv}} + 2c_{t}(\\phi_{0} + \\phi_{1}\\tau^{-1})\n$$\n其中 $C_{\\mathrm{spmv}}$、$c_{t}$、$\\phi_{0}$、$\\phi_{1}$、$\\alpha_{0}$、$\\alpha_{1}$ 均为正常数，且 $\\varepsilon \\in (0,1)$。\n\n结合这些表达式，总求解时间 $T(\\tau)$ 是舍弃容差 $\\tau$ 的函数：\n$$\nT(\\tau) = \\ln(\\varepsilon^{-1}) (\\alpha_{0} + \\alpha_{1}\\tau) \\left( C_{\\mathrm{spmv}} + 2c_{t}\\phi_{0} + 2c_{t}\\phi_{1}\\tau^{-1} \\right)\n$$\n为了找到使 $T(\\tau)$ 最小化的 $\\tau$ 值，我们必须使用微分学。我们计算 $T(\\tau)$ 关于 $\\tau$ 的导数，并将其设为零。为简化表达式，我们定义一些复合正常数：\n令 $K = \\ln(\\varepsilon^{-1})$。\n令 $C_{A} = C_{\\mathrm{spmv}} + 2c_{t}\\phi_{0}$。\n令 $C_{B} = 2c_{t}\\phi_{1}$。\n现在需要最小化的函数是：\n$$\nT(\\tau) = K (\\alpha_{0} + \\alpha_{1}\\tau) (C_{A} + C_{B}\\tau^{-1})\n$$\n展开括号内的项，我们得到：\n$$\nT(\\tau) = K (\\alpha_{0}C_{A} + \\alpha_{0}C_{B}\\tau^{-1} + \\alpha_{1}C_{A}\\tau + \\alpha_{1}C_{B})\n$$\n现在，我们对 $T(\\tau)$ 关于 $\\tau$ 求导：\n$$\n\\frac{dT}{d\\tau} = K \\frac{d}{d\\tau} (\\alpha_{0}C_{A} + \\alpha_{0}C_{B}\\tau^{-1} + \\alpha_{1}C_{A}\\tau + \\alpha_{1}C_{B})\n$$\n项 $\\alpha_{0}C_{A}$ 和 $\\alpha_{1}C_{B}$ 相对于 $\\tau$ 是常数。导数为：\n$$\n\\frac{dT}{d\\tau} = K \\left( -\\alpha_{0}C_{B}\\tau^{-2} + \\alpha_{1}C_{A} \\right)\n$$\n为了找到临界点 $\\tau^{\\ast}$，我们将导数设为零。由于对于 $\\varepsilon \\in (0,1)$，有 $K = \\ln(\\varepsilon^{-1}) > 0$，我们必须有：\n$$\n-\\alpha_{0}C_{B}(\\tau^{\\ast})^{-2} + \\alpha_{1}C_{A} = 0\n$$\n求解 $\\tau^{\\ast}$：\n$$\n\\alpha_{1}C_{A} = \\alpha_{0}C_{B}(\\tau^{\\ast})^{-2}\n$$\n$$\n(\\tau^{\\ast})^{2} = \\frac{\\alpha_{0}C_{B}}{\\alpha_{1}C_{A}}\n$$\n由于舍弃容差 $\\tau$ 必须为正，我们取正根：\n$$\n\\tau^{\\ast} = \\sqrt{\\frac{\\alpha_{0}C_{B}}{\\alpha_{1}C_{A}}}\n$$\n为确认此临界点对应一个最小值，我们考察 $T(\\tau)$ 的二阶导数：\n$$\n\\frac{d^{2}T}{d\\tau^{2}} = \\frac{d}{d\\tau} \\left[ K \\left( -\\alpha_{0}C_{B}\\tau^{-2} + \\alpha_{1}C_{A} \\right) \\right] = K (-(-2)\\alpha_{0}C_{B}\\tau^{-3}) = 2K\\alpha_{0}C_{B}\\tau^{-3}\n$$\n所有常数 $K$、$\\alpha_{0}$ 和 $C_{B}$ 均为正。对于任何允许的 $\\tau > 0$，二阶导数 $\\frac{d^{2}T}{d\\tau^{2}}$ 严格为正。这确认了 $\\tau^{\\ast}$ 是一个局部最小值。考虑到当 $\\tau \\to 0^{+}$ 以及当 $\\tau \\to \\infty$ 时，$T(\\tau) \\to \\infty$，这个唯一的临界点必定是全局最小值。\n\n最后，我们将复合常数 $C_{A}$ 和 $C_{B}$ 的原始表达式代回到 $\\tau^{\\ast}$ 的方程中：\n$$\nC_{A} = C_{\\mathrm{spmv}} + 2c_{t}\\phi_{0}\n$$\n$$\nC_{B} = 2c_{t}\\phi_{1}\n$$\n因此，最优舍弃容差 $\\tau^{\\ast}$ 为：\n$$\n\\tau^{\\ast} = \\sqrt{\\frac{\\alpha_{0}(2c_{t}\\phi_{1})}{\\alpha_{1}(C_{\\mathrm{spmv}} + 2c_{t}\\phi_{0})}}\n$$\n这就是在给定建模假设下，使总求解时间最小化的最优舍弃容差的闭式解析表达式。", "answer": "$$\n\\boxed{\\sqrt{\\frac{2 \\alpha_{0} c_{t} \\phi_{1}}{\\alpha_{1} (C_{\\mathrm{spmv}} + 2 c_{t} \\phi_{0})}}}\n$$", "id": "2590469"}]}