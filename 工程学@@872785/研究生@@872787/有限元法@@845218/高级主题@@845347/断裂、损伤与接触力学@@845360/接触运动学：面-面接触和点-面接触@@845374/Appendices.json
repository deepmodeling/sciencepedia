{"hands_on_practices": [{"introduction": "我们的实践环节将从接触力学最基本的模型——“节点-表面”接触——开始。这个入门练习旨在阐明接触分析中的核心概念，例如间隙、穿透和罚函数法。通过一个清晰的节点与平面接触的假设场景，你将亲手计算法向间隙 $g_n$、接触力 $f_c$ 和切向刚度 $k_c$，为理解更高级的接触算法奠定坚实的数学基础。[@problem_id:2548022]", "problem": "考虑一个有限元法（FEM）中的点到面（节点到面）单边接触场景，其中位于当前位置 $\\boldsymbol{x}_s \\in \\mathbb{R}^3$ 的从节点与一个平面主面发生相互作用。该主面由一个点 $\\boldsymbol{x}_0 \\in \\mathbb{R}^3$ 和一个单位法向量 $\\boldsymbol{n} \\in \\mathbb{R}^3$ 定义。假设为小变形运动学以及无摩擦的纯法向相互作用。\n\n从接触运动学的第一性原理和带有单边接触二次罚函数正则化的虚功原理出发，按如下步骤进行：\n- 对于平面主面，使用 $\\boldsymbol{x}_s$、$\\boldsymbol{x}_0$ 和 $\\boldsymbol{n}$ 定义有符号法向间隙 $g_n$，并解释接触激活条件。\n- 从一个容许的单边法向接触罚势能出发，推导标量法向接触力 $f_c$ 和相关的标量一致切向刚度 $k_c := \\partial f_c / \\partial g_n$。\n- 根据下面给出的数值数据，计算 $g_n$、$f_c$ 和 $k_c$ 的值。\n\n使用以下数据：\n- 从节点位置 $\\boldsymbol{x}_s = \\left(0.3998,\\, -0.1,\\, 0.1998\\right)\\,\\text{m}$，\n- 平面上的点 $\\boldsymbol{x}_0 = \\left(0.4,\\, -0.1,\\, 0.2\\right)\\,\\text{m}$，\n- 平面的单位法向量 $\\boldsymbol{n} = \\dfrac{1}{3}\\left(1,\\, 2,\\, 2\\right)$，\n- 法向罚参数 $\\epsilon_n = 3.5 \\times 10^{7}\\,\\text{N/m}$。\n\n采用符号约定，$g_n  0$ 表示侵入（激活接触），$g_n \\ge 0$ 表示分离（无接触）。$g_n$ 的单位为米，$f_c$ 的单位为牛顿，$k_c$ 的单位为牛顿每米。将最终数值结果保留四位有效数字。\n\n您的最终答案必须按 $(g_n,\\ f_c,\\ k_c)$ 的顺序列出这三个值。", "solution": "所提出的问题陈述经过了形式审查，并被认为是有效的。它在科学上基于计算接触力学的原理，具体来说是有限元法中的罚方法。这是一个适定的问题，为求得唯一解提供了所有必要的数据。其语言是客观且无歧义的。因此，我们可以开始求解。\n\n该问题要求计算从节点与主平面之间的接触状态。这首先需要精确定义几何关系（即间隙），其次需要一个基于该几何关系的相互作用力本构律。\n\n首先，我们定义有符号法向间隙 $g_n$。对于位于位置 $\\boldsymbol{x}_s$ 的从节点和由一个点 $\\boldsymbol{x}_0$ 及一个朝外的单位法向量 $\\boldsymbol{n}$ 定义的主平面，该间隙是从节点到平面的有符号正交距离。它是通过将连接平面上一点到从节点的向量 $(\\boldsymbol{x}_s - \\boldsymbol{x}_0)$ 投影到法向量 $\\boldsymbol{n}$ 上来计算的。\n$$g_n = (\\boldsymbol{x}_s - \\boldsymbol{x}_0) \\cdot \\boldsymbol{n}$$\n给定的符号约定是：$g_n  0$ 意味着侵入，即从节点在与 $\\boldsymbol{n}$ 相反的方向上穿过了该平面。条件 $g_n \\ge 0$ 意味着节点在接触面上或其外部，导致分离。因此，接触激活条件，或者说这个单边约束的 Kuhn-Tucker 条件，是 $g_n  0$。\n\n其次，我们从罚势能推导接触力和切向刚度。罚方法通过允许一个微小的、非物理的侵入来对严格的非侵入约束进行正则化，该侵入会受到一个与侵入深度成正比的排斥力的惩罚。单边法向接触的标准二次罚势能 $\\Pi_p$ 由下式给出：\n$$\\Pi_p(g_n) = \\begin{cases} \\frac{1}{2} \\epsilon_n g_n^2  \\text{if } g_n  0 \\\\ 0  \\text{if } g_n \\ge 0 \\end{cases}$$\n其中 $\\epsilon_n > 0$ 是罚参数。\n\n标量法向接触力 $f_c$（我们将其定义为排斥力向量 $\\boldsymbol{F}_c = f_c \\boldsymbol{n}$ 的大小）必须是非负的，即 $f_c \\ge 0$。它是从 Karush-Kuhn-Tucker (KKT) 条件推导而来的，在罚方法中近似为 $f_c \\approx \\epsilon_n \\max(0, -g_n)$。这得到：\n$$f_c(g_n) = \\begin{cases} -\\epsilon_n g_n  \\text{if } g_n  0 \\\\ 0  \\text{if } g_n \\ge 0 \\end{cases}$$\n对于 $g_n  0$，侵入深度为 $|g_n| = -g_n$，因此力 $f_c = \\epsilon_n |g_n|$ 是正的，正确地表示了排斥作用。\n\n相关的标量一致切向刚度定义为 $k_c := \\partial f_c / \\partial g_n$。我们对 $f_c$ 的表达式求导：\n$$k_c(g_n) = \\frac{\\partial f_c}{\\partial g_n} = \\begin{cases} \\frac{\\partial}{\\partial g_n}(-\\epsilon_n g_n)  \\text{if } g_n  0 \\\\ \\frac{\\partial}{\\partial g_n}(0)  \\text{if } g_n \\ge 0 \\end{cases} = \\begin{cases} -\\epsilon_n  \\text{if } g_n  0 \\\\ 0  \\text{if } g_n \\ge 0 \\end{cases}$$\n对于激活接触，$k_c$ 的负号是正确的，并且从这些定义来看是符合预期的。它表明力的模的增加（$df_c > 0$）对应于侵入的增加，这意味着间隙的代数值减小（$dg_n  0$）。\n\n现在我们使用提供的数值数据计算这些量的值：\n- 从节点位置 $\\boldsymbol{x}_s = \\begin{pmatrix} 0.3998 \\\\ -0.1 \\\\ 0.1998 \\end{pmatrix}\\,\\text{m}$\n- 平面上的点 $\\boldsymbol{x}_0 = \\begin{pmatrix} 0.4 \\\\ -0.1 \\\\ 0.2 \\end{pmatrix}\\,\\text{m}$\n- 平面的单位法向量 $\\boldsymbol{n} = \\frac{1}{3}\\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix}$\n- 法向罚参数 $\\epsilon_n = 3.5 \\times 10^{7}\\,\\text{N/m}$\n\n首先，我们计算从 $\\boldsymbol{x}_0$ 到 $\\boldsymbol{x}_s$ 的向量：\n$$\\boldsymbol{x}_s - \\boldsymbol{x}_0 = \\begin{pmatrix} 0.3998 - 0.4 \\\\ -0.1 - (-0.1) \\\\ 0.1998 - 0.2 \\end{pmatrix} = \\begin{pmatrix} -0.0002 \\\\ 0 \\\\ -0.0002 \\end{pmatrix}\\,\\text{m}$$\n\n接下来，我们计算有符号法向间隙 $g_n$：\n$$g_n = (\\boldsymbol{x}_s - \\boldsymbol{x}_0) \\cdot \\boldsymbol{n} = \\begin{pmatrix} -0.0002 \\\\ 0 \\\\ -0.0002 \\end{pmatrix} \\cdot \\left(\\frac{1}{3}\\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix}\\right)$$\n$$g_n = \\frac{1}{3} \\left( (-0.0002)(1) + (0)(2) + (-0.0002)(2) \\right) = \\frac{1}{3} (-0.0002 - 0.0004) = \\frac{-0.0006}{3}$$\n$$g_n = -0.0002\\,\\text{m}$$\n保留四位有效数字，得到 $g_n = -2.000 \\times 10^{-4}\\,\\text{m}$。\n\n因为 $g_n  0$，所以接触是激活的（发生侵入）。我们继续计算力 $f_c$ 和刚度 $k_c$。\n对于激活接触：\n$$f_c = -\\epsilon_n g_n = -(3.5 \\times 10^{7}\\,\\text{N/m})(-0.0002\\,\\text{m})$$\n$$f_c = (3.5 \\times 10^{7})(2 \\times 10^{-4})\\,\\text{N} = 7 \\times 10^{3}\\,\\text{N}$$\n$$f_c = 7000\\,\\text{N}$$\n保留四位有效数字，得到 $f_c = 7.000 \\times 10^{3}\\,\\text{N}$。\n\n对于激活接触，切向刚度为：\n$$k_c = -\\epsilon_n = -3.5 \\times 10^{7}\\,\\text{N/m}$$\n保留四位有效数字，得到 $k_c = -3.500 \\times 10^{7}\\,\\text{N/m}$。\n\n最终结果为 $(g_n, f_c, k_c)$。", "answer": "$$\\boxed{\\begin{pmatrix} -2.000 \\times 10^{-4}  7.000 \\times 10^{3}  -3.500 \\times 10^{7} \\end{pmatrix}}$$", "id": "2548022"}, {"introduction": "从“节点-表面”模型前进，我们现在探索更通用、更稳健的“表面-表面”接触模型。这种方法的核心挑战在于求解一个几何非线性问题：为从动面上的任意点，精确地找到其在主控面上的最近投影点。本练习将指导你实现高斯-牛顿（Gauss-Newton）算法的单次迭代，这是解决此类问题的标准数值技术。通过这个编码实践，你将获得关于现代接触算法几何搜索部分的第一手经验。[@problem_id:2548007]", "problem": "在三维欧几里得空间中，给定两个等参双线性四边形面片，一个从面片 (slave patch) 和一个主面片 (master patch)，每个面片由四个节点和参考正方形上的标准双线性形函数定义。目标是通过从一个给定的初始猜测值开始，使用单步高斯-牛顿法求解主面上最近点的参数坐标，从而计算在指定从高斯点处面-面接触的法向间隙。\n\n使用以下基本基底和定义：\n\n- 从面曲面映射由等参双线性映射给出\n$$\\mathbf{x}_s(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,\\mathbf{X}_{s,i},$$\n以及主面曲面映射\n$$\\mathbf{x}_m(\\hat{\\xi},\\hat{\\eta}) = \\sum_{i=1}^{4} N_i(\\hat{\\xi},\\hat{\\eta})\\,\\mathbf{X}_{m,i},$$\n其中，参数域 $[-1,1]\\times[-1,1]$ 上的双线性形函数为\n$$N_1(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta),\\quad N_2(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1-\\eta),$$\n$$N_3(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1+\\eta),\\quad N_4(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1+\\eta).$$\n- 主面曲面切向量为\n$$\\mathbf{t}_\\xi(\\hat{\\xi},\\hat{\\eta})=\\frac{\\partial \\mathbf{x}_m}{\\partial \\xi}(\\hat{\\xi},\\hat{\\eta}),\\quad \\mathbf{t}_\\eta(\\hat{\\xi},\\hat{\\eta})=\\frac{\\partial \\mathbf{x}_m}{\\partial \\eta}(\\hat{\\xi},\\hat{\\eta}).$$\n- 主面单位法向量（遵循参数化的右手定则）为\n$$\\mathbf{n}(\\hat{\\xi},\\hat{\\eta})=\\frac{\\mathbf{t}_\\xi(\\hat{\\xi},\\hat{\\eta})\\times \\mathbf{t}_\\eta(\\hat{\\xi},\\hat{\\eta})}{\\|\\mathbf{t}_\\xi(\\hat{\\xi},\\hat{\\eta})\\times \\mathbf{t}_\\eta(\\hat{\\xi},\\hat{\\eta})\\|}.$$\n- 对于一个给定的从点 $\\mathbf{x}_s(\\xi_s,\\eta_s)$，其在主面上的最近点投影旨在寻找 $\\hat{\\boldsymbol{\\xi}}=[\\hat{\\xi},\\hat{\\eta}]^\\top$，使得残差\n$$\\mathbf{R}(\\hat{\\xi},\\hat{\\eta})=\\mathbf{x}_m(\\hat{\\xi},\\hat{\\eta})-\\mathbf{x}_s(\\xi_s,\\eta_s)$$\n与局部切空间正交，即\n$$\\mathbf{t}_\\xi(\\hat{\\xi},\\hat{\\eta})\\cdot \\mathbf{R}(\\hat{\\xi},\\hat{\\eta})=0,\\quad \\mathbf{t}_\\eta(\\hat{\\xi},\\hat{\\eta})\\cdot \\mathbf{R}(\\hat{\\xi},\\hat{\\eta})=0.$$\n- 针对这些条件，从初始猜测值 $\\hat{\\boldsymbol{\\xi}}_0$ 开始的高斯-牛顿更新，求解\n$$\\mathbf{G}(\\hat{\\boldsymbol{\\xi}}_0)\\,\\Delta \\hat{\\boldsymbol{\\xi}} = -\\mathbf{b}(\\hat{\\boldsymbol{\\xi}}_0),$$\n其中\n$$\\mathbf{G}=\n\\begin{bmatrix}\n\\mathbf{t}_\\xi\\cdot \\mathbf{t}_\\xi  \\mathbf{t}_\\xi\\cdot \\mathbf{t}_\\eta\\\\\n\\mathbf{t}_\\eta\\cdot \\mathbf{t}_\\xi  \\mathbf{t}_\\eta\\cdot \\mathbf{t}_\\eta\n\\end{bmatrix},\\quad\n\\mathbf{b}=\n\\begin{bmatrix}\n\\mathbf{t}_\\xi\\cdot \\mathbf{R}\\\\\n\\mathbf{t}_\\eta\\cdot \\mathbf{R}\n\\end{bmatrix},$$\n所有量均在 $\\hat{\\boldsymbol{\\xi}}_0$ 处求值。单步更新为 $\\hat{\\boldsymbol{\\xi}}_1=\\hat{\\boldsymbol{\\xi}}_0+\\Delta \\hat{\\boldsymbol{\\xi}}$。\n- 在从点处的法向间隙定义为\n$$g_n(\\xi_s,\\eta_s) = \\mathbf{n}(\\hat{\\boldsymbol{\\xi}}_1)\\cdot\\left(\\mathbf{x}_s(\\xi_s,\\eta_s)-\\mathbf{x}_m(\\hat{\\boldsymbol{\\xi}}_1)\\right).$$\n\n所有坐标单位均为米；法向间隙必须以米为单位报告。使用上述定义，不要引入任何额外的建模假设。不要将更新后的参数坐标 $\\hat{\\boldsymbol{\\xi}}_1$ 限制在参考正方形内；直接在更新后的值处计算 $\\mathbf{n}$ 和 $\\mathbf{x}_m$。\n\n为以下测试套件计算 $g_n(\\xi_s,\\eta_s)$。在每种情况下，使用相同的从高斯点和相同的主面参数坐标初始猜测值：\n- 从高斯点参数：$(\\xi_s,\\eta_s)=\\left(\\frac{1}{\\sqrt{3}},\\frac{1}{\\sqrt{3}}\\right)$。\n- 主面投影的初始猜测值：$\\hat{\\boldsymbol{\\xi}}_0=[0,0]^\\top$。\n\n测试用例：\n\n- 用例 $1$（平行平面，恒定偏移）：\n  - 主节点 $(\\mathbf{X}_{m,1},\\mathbf{X}_{m,2},\\mathbf{X}_{m,3},\\mathbf{X}_{m,4})$：\n    $$\\left[(-1,-1,0),\\ (1,-1,0),\\ (1,1,0),\\ (-1,1,0)\\right].$$\n  - 从节点 $(\\mathbf{X}_{s,1},\\mathbf{X}_{s,2},\\mathbf{X}_{s,3},\\mathbf{X}_{s,4})$：\n    $$\\left[(-1,-1,0.2),\\ (1,-1,0.2),\\ (1,1,0.2),\\ (-1,1,0.2)\\right].$$\n\n- 用例 $2$（主面绕 x 轴倾斜 $10$ 度，从面为恒定高度的平行平面）：\n  - 设 $\\theta=\\frac{\\pi}{18}$（弧度）。从 $z=0$ 平面内具有以下节点的正方形开始\n    $$\\left[(-1,-1,0),\\ (1,-1,0),\\ (1,1,0),\\ (-1,1,0)\\right]$$\n    并使用标准旋转将每个节点绕 x 轴旋转角度 $\\theta$\n    $$y' = y\\cos\\theta - z\\sin\\theta,\\quad z' = y\\sin\\theta + z\\cos\\theta.$$\n    旋转后的坐标定义了 $(\\mathbf{X}_{m,i})$。\n  - 从节点：\n    $$\\left[(-1,-1,0.2),\\ (1,-1,0.2),\\ (1,1,0.2),\\ (-1,1,0.2)\\right].$$\n\n- 用例 $3$（扭曲主面，偏移从面）：\n  - 主节点：\n    $$\\left[(-1,-1,0.0),\\ (1,-1,0.1),\\ (1,1,0.0),\\ (-1,1,-0.1)\\right].$$\n  - 从节点：\n    $$\\left[(-1,-1,0.05),\\ (1,-1,0.05),\\ (1,1,0.05),\\ (-1,1,0.05)\\right].$$\n\n- 用例 $4$（从点在主面范围之外，较小的主面片）：\n  - 主节点：\n    $$\\left[(-0.5,-0.5,0.0),\\ (0.5,-0.5,0.0),\\ (0.5,0.5,0.0),\\ (-0.5,0.5,0.0)\\right].$$\n  - 从节点：\n    $$\\left[(-1,-1,0.1),\\ (1,-1,0.1),\\ (1,1,0.1),\\ (-1,1,0.1)\\right].$$\n\n要求和输出规范：\n\n- 精确按照上述定义实现双线性形函数及其参数导数的计算。\n- 使用上面定义的矩阵 $\\mathbf{G}$ 和右侧向量 $\\mathbf{b}$，实现从 $\\hat{\\boldsymbol{\\xi}}_0$ 到 $\\hat{\\boldsymbol{\\xi}}_1$ 的单步更新的高斯-牛顿线性系统。\n- 对于每种情况，计算从点 $\\mathbf{x}_s(\\xi_s,\\eta_s)$，对 $\\hat{\\boldsymbol{\\xi}}$ 进行一次更新，计算更新后参数位置处的主面单位法向量，然后计算 $g_n(\\xi_s,\\eta_s)$。\n- 最终的法向间隙以米为单位表示，并四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含按用例 1 到 4 的顺序排列的结果，格式为逗号分隔的列表，并用方括号括起来，例如 $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\right]$。", "solution": "所提出的问题是计算接触力学中一个明确定义的练习，具体涉及有限元方法中的面-面接触公式。所有提供的定义、初始条件和测试用例在科学上都是合理的，在数学上是一致的，并且是完整的。因此，该问题是有效的，并允许一个直接、明确的解决方案。\n\n目标是计算在特定从点处，从面和主面之间的法向间隙 $g_n$。此计算涉及单次高斯-牛顿迭代，以逼近主面上的最近点。整个过程将针对四个不同的测试用例执行。\n\n让我们首先将所需的数学组件形式化。等参双线性四边形面片上一点的位置向量由下式给出\n$$\n\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,\\mathbf{X}_{i}\n$$\n其中 $\\mathbf{X}_{i}$ 是四个角节点的坐标，$N_i(\\xi,\\eta)$ 是在参数域 $[-1,1]\\times[-1,1]$ 上定义的双线性形函数：\n$$\n\\begin{aligned}\nN_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n\\end{aligned}\n$$\n曲面的切向量通过对位置向量关于参数坐标 $\\xi$ 和 $\\eta$ 求导得到。\n$$\n\\begin{aligned}\n\\mathbf{t}_\\xi(\\xi,\\eta) = \\frac{\\partial \\mathbf{x}}{\\partial \\xi}(\\xi,\\eta) = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi}(\\xi,\\eta)\\,\\mathbf{X}_{i} \\\\\n\\mathbf{t}_\\eta(\\xi,\\eta) = \\frac{\\partial \\mathbf{x}}{\\partial \\eta}(\\xi,\\eta) = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta}(\\xi,\\eta)\\,\\mathbf{X}_{i}\n\\end{aligned}\n$$\n形函数的必要偏导数是：\n$$\n\\begin{aligned}\n\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1+\\eta), \\quad \\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta) \\\\\n\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi), \\quad \\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi), \\quad \\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(1+\\xi), \\quad \\frac{\\partial N_4}{\\partial \\eta} = \\frac{1}{4}(1-\\xi)\n\\end{aligned}\n$$\n计算每个用例的法向间隙 $g_n$ 的过程如下。\n\n第 1 步：计算指定从点的位置。\n从高斯点由 $(\\xi_s, \\eta_s) = (\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}})$ 给出。三维空间中的从点 $\\mathbf{x}_s$ 使用从面曲面映射计算得出：\n$$\n\\mathbf{x}_s = \\mathbf{x}_s(\\xi_s, \\eta_s) = \\sum_{i=1}^{4} N_i(\\xi_s,\\eta_s)\\,\\mathbf{X}_{s,i}\n$$\n\n第 2 步：执行一次高斯-牛顿迭代以找到投影的主面坐标。\n我们从主面参数坐标的初始猜测值 $\\hat{\\boldsymbol{\\xi}}_0 = [\\hat{\\xi}_0, \\hat{\\eta}_0]^\\top = [0, 0]^\\top$ 开始。我们必须求解线性系统 $\\mathbf{G}(\\hat{\\boldsymbol{\\xi}}_0)\\,\\Delta \\hat{\\boldsymbol{\\xi}} = -\\mathbf{b}(\\hat{\\boldsymbol{\\xi}}_0)$ 以获得更新量 $\\Delta \\hat{\\boldsymbol{\\xi}} = [\\Delta\\hat{\\xi}, \\Delta\\hat{\\eta}]^\\top$。\n\n首先，在 $\\hat{\\boldsymbol{\\xi}}_0$ 处计算所有量的值。\n主点为 $\\mathbf{x}_m(\\hat{\\boldsymbol{\\xi}}_0)$。残差向量为 $\\mathbf{R}(\\hat{\\boldsymbol{\\xi}}_0) = \\mathbf{x}_m(\\hat{\\boldsymbol{\\xi}}_0) - \\mathbf{x}_s$。主切向量为 $\\mathbf{t}_\\xi(\\hat{\\boldsymbol{\\xi}}_0)$ 和 $\\mathbf{t}_\\eta(\\hat{\\boldsymbol{\\xi}}_0)$。\n\n接下来，构建 $2 \\times 2$ 矩阵 $\\mathbf{G}$ 和 $2 \\times 1$ 向量 $\\mathbf{b}$：\n$$\n\\mathbf{G}(\\hat{\\boldsymbol{\\xi}}_0) =\n\\begin{bmatrix}\n\\mathbf{t}_\\xi \\cdot \\mathbf{t}_\\xi  \\mathbf{t}_\\xi \\cdot \\mathbf{t}_\\eta \\\\\n\\mathbf{t}_\\eta \\cdot \\mathbf{t}_\\xi  \\mathbf{t}_\\eta \\cdot \\mathbf{t}_\\eta\n\\end{bmatrix}_{\\hat{\\boldsymbol{\\xi}}_0}\n\\quad\n\\mathbf{b}(\\hat{\\boldsymbol{\\xi}}_0) =\n\\begin{bmatrix}\n\\mathbf{t}_\\xi \\cdot \\mathbf{R} \\\\\n\\mathbf{t}_\\eta \\cdot \\mathbf{R}\n\\end{bmatrix}_{\\hat{\\boldsymbol{\\xi}}_0}\n$$\n求解该线性系统可得到更新量 $\\Delta \\hat{\\boldsymbol{\\xi}}$。对于一个 $2 \\times 2$ 系统，使用克莱姆法则或矩阵求逆法可以很直接地求解。\n\n第 3 步：更新主面参数坐标。\n更新后的主面坐标为 $\\hat{\\boldsymbol{\\xi}}_1 = \\hat{\\boldsymbol{\\xi}}_0 + \\Delta \\hat{\\boldsymbol{\\xi}}$。问题规定不要将这些值限制在域 $[-1,1]^2$ 内。\n\n第 4 步：计算法向间隙。\n最后一步是使用更新后的坐标 $\\hat{\\boldsymbol{\\xi}}_1 = [\\hat{\\xi}_1, \\hat{\\eta}_1]^\\top$ 来计算法向间隙 $g_n$。\n首先，在新位置计算主点 $\\mathbf{x}_m(\\hat{\\boldsymbol{\\xi}}_1)$ 和主切向量 $\\mathbf{t}_\\xi(\\hat{\\boldsymbol{\\xi}}_1)$ 和 $\\mathbf{t}_\\eta(\\hat{\\boldsymbol{\\xi}}_1)$。\n然后，计算主面单位法向量：\n$$\n\\mathbf{n}(\\hat{\\boldsymbol{\\xi}}_1) = \\frac{\\mathbf{t}_\\xi(\\hat{\\boldsymbol{\\xi}}_1) \\times \\mathbf{t}_\\eta(\\hat{\\boldsymbol{\\xi}}_1)}{\\|\\mathbf{t}_\\xi(\\hat{\\boldsymbol{\\xi}}_1) \\times \\mathbf{t}_\\eta(\\hat{\\boldsymbol{\\xi}}_1)\\|}\n$$\n法向间隙是从投影的主点到从点的有符号距离，沿主法线方向测量：\n$$\ng_n = \\mathbf{n}(\\hat{\\boldsymbol{\\xi}}_1) \\cdot (\\mathbf{x}_s - \\mathbf{x}_m(\\hat{\\boldsymbol{\\xi}}_1))\n$$\n对所提供的所有四个测试用例重复此过程。\n\n对于用例 2，必须首先计算主节点。从 $z=0$ 平面内一个正方形的节点 $\\mathbf{X}_{i}^{(0)} = (x_i, y_i, 0)$ 开始，我们应用一个绕 x 轴旋转 $\\theta = \\pi/18$ 弧度的变换。该变换由下式给出：\n$$\nx' = x, \\quad y' = y\\cos\\theta - z\\sin\\theta, \\quad z' = y\\sin\\theta + z\\cos\\theta\n$$\n对于点 $(x, y, 0)$，这简化为 $(x, y\\cos\\theta, y\\sin\\theta)$。然后将得到的坐标 $\\mathbf{X}_{m,i} = (x_i, y_i\\cos\\theta, y_i\\sin\\theta)$ 用于通用算法中。\n\n实现将对每个用例精确地遵循这些步骤，使用数值数组表示向量和矩阵，并采用标准的线性代数运算进行点积、叉积和求解线性系统。最终结果按要求四舍五入到六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the contact kinematics problem for four test cases.\n    \"\"\"\n\n    # --- Utilities for Bilinear Quadrilateral Patches ---\n\n    def eval_shape_functions(xi, eta):\n        \"\"\"\n        Evaluates the 4 bilinear shape functions at a given parametric point.\n        \"\"\"\n        N1 = 0.25 * (1.0 - xi) * (1.0 - eta)\n        N2 = 0.25 * (1.0 + xi) * (1.0 - eta)\n        N3 = 0.25 * (1.0 + xi) * (1.0 + eta)\n        N4 = 0.25 * (1.0 - xi) * (1.0 + eta)\n        return np.array([N1, N2, N3, N4])\n\n    def eval_shape_derivatives(xi, eta):\n        \"\"\"\n        Evaluates the parametric derivatives of the 4 bilinear shape functions.\n        Returns two arrays: dN/d_xi and dN/d_eta.\n        \"\"\"\n        dN_dxi = np.array([\n            -0.25 * (1.0 - eta),\n             0.25 * (1.0 - eta),\n             0.25 * (1.0 + eta),\n            -0.25 * (1.0 + eta)\n        ])\n        dN_deta = np.array([\n            -0.25 * (1.0 - xi),\n            -0.25 * (1.0 + xi),\n             0.25 * (1.0 + xi),\n             0.25 * (1.0 - xi)\n        ])\n        return dN_dxi, dN_deta\n\n    def eval_position(xi, eta, nodes):\n        \"\"\"\n        Computes the position vector x for a given parametric point.\n        \"\"\"\n        N = eval_shape_functions(xi, eta)\n        return N @ nodes\n\n    def eval_tangents(xi, eta, nodes):\n        \"\"\"\n        Computes the tangent vectors t_xi and t_eta.\n        \"\"\"\n        dN_dxi, dN_deta = eval_shape_derivatives(xi, eta)\n        t_xi = dN_dxi @ nodes\n        t_eta = dN_deta @ nodes\n        return t_xi, t_eta\n\n    # --- Problem Parameters ---\n\n    xi_s, eta_s = 1.0 / np.sqrt(3.0), 1.0 / np.sqrt(3.0)\n    xi_hat_0 = np.array([0.0, 0.0])\n\n    # --- Test Case Definitions ---\n\n    # Case 1: Parallel planes\n    Xm1 = np.array([\n        [-1.0, -1.0, 0.0],\n        [ 1.0, -1.0, 0.0],\n        [ 1.0,  1.0, 0.0],\n        [-1.0,  1.0, 0.0]\n    ])\n    Xs1 = np.array([\n        [-1.0, -1.0, 0.2],\n        [ 1.0, -1.0, 0.2],\n        [ 1.0,  1.0, 0.2],\n        [-1.0,  1.0, 0.2]\n    ])\n\n    # Case 2: Tilted master plane\n    theta = np.pi / 18.0\n    rot_matrix = np.array([\n        [1.0, 0.0, 0.0],\n        [0.0, np.cos(theta), -np.sin(theta)],\n        [0.0, np.sin(theta), np.cos(theta)]\n    ])\n    # Base nodes are same as Xm1\n    Xm2 = np.array([\n        [-1.0, -1.0 * np.cos(theta), -1.0 * np.sin(theta)],\n        [ 1.0, -1.0 * np.cos(theta), -1.0 * np.sin(theta)],\n        [ 1.0,  1.0 * np.cos(theta),  1.0 * np.sin(theta)],\n        [-1.0,  1.0 * np.cos(theta),  1.0 * np.sin(theta)]\n    ])\n    Xs2 = np.array([\n        [-1.0, -1.0, 0.2],\n        [ 1.0, -1.0, 0.2],\n        [ 1.0,  1.0, 0.2],\n        [-1.0,  1.0, 0.2]\n    ])\n\n    # Case 3: Twisted master\n    Xm3 = np.array([\n        [-1.0, -1.0,  0.0],\n        [ 1.0, -1.0,  0.1],\n        [ 1.0,  1.0,  0.0],\n        [-1.0,  1.0, -0.1]\n    ])\n    Xs3 = np.array([\n        [-1.0, -1.0, 0.05],\n        [ 1.0, -1.0, 0.05],\n        [ 1.0,  1.0, 0.05],\n        [-1.0,  1.0, 0.05]\n    ])\n\n    # Case 4: Slave point outside master span\n    Xm4 = np.array([\n        [-0.5, -0.5, 0.0],\n        [ 0.5, -0.5, 0.0],\n        [ 0.5,  0.5, 0.0],\n        [-0.5,  0.5, 0.0]\n    ])\n    Xs4 = np.array([\n        [-1.0, -1.0, 0.1],\n        [ 1.0, -1.0, 0.1],\n        [ 1.0,  1.0, 0.1],\n        [-1.0,  1.0, 0.1]\n    ])\n\n    test_cases = [\n        (Xm1, Xs1),\n        (Xm2, Xs2),\n        (Xm3, Xs3),\n        (Xm4, Xs4),\n    ]\n\n    results = []\n\n    for master_nodes, slave_nodes in test_cases:\n        # Step 1: Compute slave point\n        x_s = eval_position(xi_s, eta_s, slave_nodes)\n\n        # Step 2: Perform one Gauss-Newton step\n        # Evaluate quantities at initial guess xi_hat_0\n        xi0, eta0 = xi_hat_0\n        x_m_0 = eval_position(xi0, eta0, master_nodes)\n        t_xi_0, t_eta_0 = eval_tangents(xi0, eta0, master_nodes)\n        R_0 = x_m_0 - x_s\n\n        # Assemble Gauss-Newton system\n        G_matrix = np.array([\n            [np.dot(t_xi_0, t_xi_0), np.dot(t_xi_0, t_eta_0)],\n            [np.dot(t_eta_0, t_xi_0), np.dot(t_eta_0, t_eta_0)]\n        ])\n        b_vector = np.array([np.dot(t_xi_0, R_0), np.dot(t_eta_0, R_0)])\n\n        # Solve for the update\n        delta_xi_hat = np.linalg.solve(G_matrix, -b_vector)\n\n        # Step 3: Update master parametric coordinates\n        xi_hat_1 = xi_hat_0 + delta_xi_hat\n\n        # Step 4: Compute normal gap\n        xi1, eta1 = xi_hat_1\n        \n        # Evaluate quantities at updated coordinates xi_hat_1\n        x_m_1 = eval_position(xi1, eta1, master_nodes)\n        t_xi_1, t_eta_1 = eval_tangents(xi1, eta1, master_nodes)\n\n        # Compute master normal\n        normal_vec = np.cross(t_xi_1, t_eta_1)\n        norm_of_normal = np.linalg.norm(normal_vec)\n        if norm_of_normal > 1e-12: # Avoid division by zero for degenerate cases\n            unit_normal = normal_vec / norm_of_normal\n        else:\n            # Fallback for degenerate normal, though not expected in these cases\n            unit_normal = np.array([0.0, 0.0, 1.0])\n\n        # Compute final gap\n        gap_vector = x_s - x_m_1\n        g_n = np.dot(unit_normal, gap_vector)\n        \n        results.append(g_n)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2548007"}, {"introduction": "在解决了接触运动学的核心问题——即找到接触点——之后，我们必须将此几何信息转化为动力学量。这个练习关注的是如何通过数值积分，将分布在接触区域上的接触压力转化为施加在单元节点上的等效节点力向量。你将应用高斯积分（Gauss quadrature）来为一个双线性四边形单元组装接触力向量，从而将接触算法与有限元方法的全局求解框架无缝衔接起来。[@problem_id:2548018]", "problem": "给定一个与刚性平面接触的单元从动面单元，该单元为等参双线性四边形单元。该单元有四个节点，其标准母坐标分别为 $(-1,-1)$、$(+1,-1)$、$(+1,+1)$、$(-1,+1)$，并在方形母域 $[-1,1]\\times[-1,1]$ 上使用标准双线性形函数 $N_I(\\xi,\\eta)$（$I=1,\\dots,4$）。刚性平面由平面上的一点 $\\mathbf{x}_0$ 和一个从平面指向从动体的单位法向量 $\\mathbf{n}$ 定义。物理位置为 $\\mathbf{x}(\\xi,\\eta)$ 的表面点的法向间隙场定义为 $g_n(\\xi,\\eta)=\\mathbf{n}\\cdot\\left(\\mathbf{x}(\\xi,\\eta)-\\mathbf{x}_0\\right)$。采用罚函数接触定律，法向拉格朗日乘子（接触压力）为 $\\lambda_n(\\xi,\\eta)=k_p\\,\\langle -g_n(\\xi,\\eta)\\rangle_+$，其中 $k_p$ 是罚刚度，$\\langle\\cdot\\rangle_+=\\max(0,\\cdot)$ 表示麦考利括号。仅在 $g_n(\\xi,\\eta)0$ 的积分点处，接触被视为激活状态。单元接触力向量由面-面弱形式定义\n$$\n\\mathbf{f}_e=\\int_{\\mathcal{A}_c} \\mathbf{N}^T(\\xi,\\eta)\\,\\lambda_n(\\xi,\\eta)\\,\\mathbf{n}\\, \\mathrm{d}A,\n$$\n其中 $\\mathbf{N}^T(\\xi,\\eta)=\\operatorname{diag}\\left(N_1(\\xi,\\eta),N_1(\\xi,\\eta),N_1(\\xi,\\eta),\\dots,N_4(\\xi,\\eta),N_4(\\xi,\\eta),N_4(\\xi,\\eta)\\right)$ 将标量压力分配到每个节点的三个平移分量上，$\\mathcal{A}_c$ 是激活接触区域的子集。表面微分 $\\mathrm{d}A$ 通过等参映射计算，即 $\\mathrm{d}A=\\left\\|\\mathbf{a}_1(\\xi,\\eta)\\times\\mathbf{a}_2(\\xi,\\eta)\\right\\|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$，其中协变基向量为 $\\mathbf{a}_1=\\sum_{I=1}^4 \\frac{\\partial N_I}{\\partial \\xi}\\,\\mathbf{X}_I$ 和 $\\mathbf{a}_2=\\sum_{I=1}^4 \\frac{\\partial N_I}{\\partial \\eta}\\,\\mathbf{X}_I$，以物理节点坐标 $\\mathbf{X}_I$ 表示。使用 $2\\times 2$ 高斯积分来近似该积分，积分点位于 $(\\pm 1/\\sqrt{3},\\pm 1/\\sqrt{3})$，每个点的权重 $w=1$。仅使用激活的高斯积分点进行组装。\n\n实现一个程序，针对下面指定的每个测试用例，计算以牛顿为单位的 12 分量单元接触力向量 $\\mathbf{f}_e=\\left[f_{1x},f_{1y},f_{1z},f_{2x},f_{2y},f_{2z},f_{3x},f_{3y},f_{3z},f_{4x},f_{4y},f_{4z}\\right]$。遵循以下约定：\n- 从动单元节点的物理排序为 $\\mathbf{X}_1=(0,0,z_1)$、$\\mathbf{X}_2=(L_x,0,z_2)$、$\\mathbf{X}_3=(L_x,L_y,z_3)$、$\\mathbf{X}_4=(0,L_y,z_4)$，其中给定的 $L_x$ 和 $L_y$ 单位为米，给定的节点离面坐标 $z_I$ 单位为米。\n- 刚性平面的参数为 $\\mathbf{x}_0=(0,0,0)$ 和 $\\mathbf{n}=\\left[0,0,1\\right]^T$。\n- 使用指定的罚刚度 $k_p$。\n- 使用 $2\\times 2$ 高斯积分，积分点为 $(\\xi,\\eta)\\in\\{\\left(-1/\\sqrt{3},-1/\\sqrt{3}\\right),\\left(+1/\\sqrt{3},-1/\\sqrt{3}\\right),\\left(+1/\\sqrt{3},+1/\\sqrt{3}\\right),\\left(-1/\\sqrt{3},+1/\\sqrt{3}\\right)\\}$，每个点的权重 $w=1$。\n- 当且仅当 $g_n(\\xi,\\eta)0$ 时，将高斯积分点视为激活状态。\n- 以牛顿为单位表示最终的节点力分量，并将每个分量精确到小数点后 $6$ 位。\n\n测试套件（所有长度单位为米，力单位为牛顿）：\n- 情况 A（普遍激活情况）：$L_x=0.2$，$L_y=0.1$，$k_p=10^9$，$(z_1,z_2,z_3,z_4)=(-0.001,-0.001,-0.001,-0.001)$。\n- 情况 B（无激活点）：$L_x=0.2$，$L_y=0.1$，$k_p=10^9$，$(z_1,z_2,z_3,z_4)=(+0.001,+0.001,+0.001,+0.001)$。\n- 情况 C（激活/非激活混合情况）：$L_x=0.2$，$L_y=0.1$，$k_p=10^9$，$(z_1,z_2,z_3,z_4)=(-0.004,+0.001,+0.001,+0.001)$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含三个测试用例的结果，格式为包含三个子列表的列表（每个用例一个子列表）。每个子列表是按上述节点主序展开的 12 分量力向量。该行不应包含空格，每个浮点数必须精确到小数点后 $6$ 位。例如，一个有效的输出格式为 $[[a_1,a_2,\\dots,a_{12}],[b_1,b_2,\\dots,b_{12}],[c_1,c_2,\\dots,c_{12}]]$，其中每个 $a_i$、$b_i$、$c_i$ 都是小数点后恰好有 $6$ 位的小数。", "solution": "首先验证问题，以确保其科学上合理、适定且完整。\n\n### 步骤 1：提取已知条件\n- **单元**：等参双线性四边形从动面单元，节点 1-4 的母坐标为 $(−1,−1)$、$(+1,−1)$、$(+1,+1)$、$(−1,+1)$。\n- **形函数**：$N_I(\\xi,\\eta)$，$I=1,\\dots,4$。\n- **刚性平面**：由点 $\\mathbf{x}_0=(0,0,0)$ 和法线 $\\mathbf{n}=\\left[0,0,1\\right]^T$ 定义。\n- **法向间隙**：$g_n(\\xi,\\eta)=\\mathbf{n}\\cdot\\left(\\mathbf{x}(\\xi,\\eta)-\\mathbf{x}_0\\right)$。\n- **接触定律**：罚函数法，压力为 $\\lambda_n(\\xi,\\eta)=k_p\\,\\langle -g_n(\\xi,\\eta)\\rangle_+$，其中 $\\langle\\cdot\\rangle_+=\\max(0,\\cdot)$。接触在 $g_n(\\xi,\\eta)0$ 处激活。\n- **单元接触力**：$\\mathbf{f}_e=\\int_{\\mathcal{A}_c} \\mathbf{N}^T(\\xi,\\eta)\\,\\lambda_n(\\xi,\\eta)\\,\\mathbf{n}\\, \\mathrm{d}A$。问题陈述中将 $\\mathbf{N}^T$ 定义为一个对角矩阵，这在维度上是不一致的。然而，文本阐明其意图是“将标量压力分配到每个节点的三个平移分量上”，这与标准有限元列式相对应。我们将采用标准解释，即 12 个自由度的力被积函数是向量 $\\lambda_n(\\xi,\\eta) [N_1\\mathbf{n}^T, N_2\\mathbf{n}^T, N_3\\mathbf{n}^T, N_4\\mathbf{n}^T]^T$。\n- **表面微分面积**：$\\mathrm{d}A=\\left\\|\\mathbf{a}_1(\\xi,\\eta)\\times\\mathbf{a}_2(\\xi,\\eta)\\right\\|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$，协变基向量为 $\\mathbf{a}_1=\\sum_{I=1}^4 \\frac{\\partial N_I}{\\partial \\xi}\\,\\mathbf{X}_I$ 和 $\\mathbf{a}_2=\\sum_{I=1}^4 \\frac{\\partial N_I}{\\partial \\eta}\\,\\mathbf{X}_I$。\n- **数值积分**：$2\\times 2$ 高斯积分，积分点为 $(\\xi,\\eta)\\in\\{\\left(\\pm 1/\\sqrt{3},\\pm 1/\\sqrt{3}\\right)\\}$，每个点的权重 $w=1$。积分仅在激活的高斯点上执行。\n- **节点坐标**：$\\mathbf{X}_1=(0,0,z_1)$、$\\mathbf{X}_2=(L_x,0,z_2)$、$\\mathbf{X}_3=(L_x,L_y,z_3)$、$\\mathbf{X}_4=(0,L_y,z_4)$。\n- **测试用例**：\n    - **A**：$L_x=0.2$，$L_y=0.1$，$k_p=10^9$，$(z_1,z_2,z_3,z_4)=(-0.001,-0.001,-0.001,-0.001)$。\n    - **B**：$L_x=0.2$，$L_y=0.1$，$k_p=10^9$，$(z_1,z_2,z_3,z_4)=(+0.001,+0.001,+0.001,+0.001)$。\n    - **C**：$L_x=0.2$，$L_y=0.1$，$k_p=10^9$，$(z_1,z_2,z_3,z_4)=(-0.004,+0.001,+0.001,+0.001)$。\n- **输出格式**：每个用例对应一个 12 分量的力向量，每个分量四舍五入到小数点后 6 位。\n\n### 步骤 2：验证\n该问题在科学上基于有限元方法中的计算接触力学理论。它是一个适定、客观的问题，并提供了计算唯一解所需的所有数据。唯一的模糊之处在于矩阵 $\\mathbf{N}^T$ 的定义，如前所述，可以通过遵循与问题描述文本一致的标准、物理上一致的列式来解决。因此，该问题被认为是**有效的**。\n\n### 步骤 3：求解\n节点接触力向量 $\\mathbf{f}_e$ 是通过对接触虚功的弱形式进行数值积分来计算的。该积分通过对 $M=4$ 个高斯积分点的求和来近似：\n$$\n\\mathbf{f}_e \\approx \\sum_{q=1}^{M} w_q \\, \\left( \\lambda_n(\\xi_q, \\eta_q) \\, \\mathbf{F}_{dist}(\\xi_q, \\eta_q) \\, J_A(\\xi_q, \\eta_q) \\right)\n$$\n其中求和仅针对激活点（$g_n  0$ 的点）。这里，$w_q=1$ 是高斯权重，$(\\xi_q, \\eta_q)$ 是高斯积分点坐标，$\\lambda_n$ 是罚函数压力，$\\mathbf{F}_{dist}$ 是力分布向量，$J_A$ 是表面协变基向量叉积的模（表面雅可比行列式）。\n\n每个测试用例的求解过程如下：\n\n1.  **定义单元几何形状和参数**：对于每个用例，根据给定的 $L_x$、$L_y$ 和 $z_I$ 定义节点坐标 $\\mathbf{X}_I$。设置罚刚度 $k_p$。\n\n2.  **遍历高斯积分点**：我们遍历四个高斯积分点 $(\\xi_q, \\eta_q) = (\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$。\n\n3.  **评估每个高斯积分点的间隙**：\n    - 双线性形函数 $N_I(\\xi, \\eta)$ 为：\n    $$\n    N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta), \\quad N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)\n    $$\n    $$\n    N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta), \\quad N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n    $$\n    - 高斯积分点的物理位置为 $\\mathbf{x}(\\xi_q, \\eta_q) = \\sum_{I=1}^4 N_I(\\xi_q, \\eta_q) \\mathbf{X}_I$。\n    - 间隙为 $g_n = \\mathbf{n} \\cdot (\\mathbf{x} - \\mathbf{x}_0)$。由于 $\\mathbf{n}=[0,0,1]^T$ 和 $\\mathbf{x}_0=\\mathbf{0}$，这简化为插值得到的 z 坐标：$g_n(\\xi_q, \\eta_q) = x_z(\\xi_q, \\eta_q) = \\sum_{I=1}^4 N_I(\\xi_q, \\eta_q) z_I$。\n\n4.  **检查激活接触**：如果 $g_n  0$，则高斯积分点处于激活状态。如果一个点未激活，其对力向量的贡献为零。\n\n5.  **计算激活点的力贡献**：对于每个激活的高斯积分点：\n    - 接触压力为 $\\lambda_n = k_p \\langle -g_n \\rangle_+ = -k_p g_n$。\n    - 形函数的导数，例如 $\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta)$、$\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi)$ 等，被求值。\n    - 协变基向量被计算：$\\mathbf{a}_1 = \\sum_{I=1}^4 \\frac{\\partial N_I}{\\partial \\xi} \\mathbf{X}_I$ 和 $\\mathbf{a}_2 = \\sum_{I=1}^4 \\frac{\\partial N_I}{\\partial \\eta} \\mathbf{X}_I$。\n    - 表面雅可比行列式被计算：$J_A = \\|\\mathbf{a}_1 \\times \\mathbf{a}_2\\|$。\n    - 力分布向量为 $\\mathbf{F}_{dist} = [N_1\\mathbf{n}^T, \\dots, N_4\\mathbf{n}^T]^T$。由于 $\\mathbf{n}=[0,0,1]^T$，该向量仅在 z-自由度上有非零项：$\\mathbf{F}_{dist} = [0, 0, N_1, 0, 0, N_2, 0, 0, N_3, 0, 0, N_4]^T$。\n    - 来自当前高斯积分点的力增量为 $\\Delta\\mathbf{f}_q = w_q \\lambda_n J_A \\mathbf{F}_{dist}$。由于 $w_q=1$，因此 $\\Delta\\mathbf{f}_q = \\lambda_n J_A \\mathbf{F}_{dist}$。\n\n6.  **组装总力向量**：总单元力向量 $\\mathbf{f}_e$ 是所有激活高斯积分点增量的总和：$\\mathbf{f}_e = \\sum_{\\text{active } q} \\Delta\\mathbf{f}_q$。\n\n7.  **最终格式化**：按要求将得到的 12 分量向量 $\\mathbf{f}_e$ 的各分量四舍五入到小数点后 6 位。对所有测试用例重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the element contact force vector for a bilinear quadrilateral element\n    in contact with a rigid plane using a penalty method.\n    \"\"\"\n    test_cases = [\n        # Case A: General active case\n        {'Lx': 0.2, 'Ly': 0.1, 'kp': 1e9, 'z': (-0.001, -0.001, -0.001, -0.001)},\n        # Case B: No active points\n        {'Lx': 0.2, 'Ly': 0.1, 'kp': 1e9, 'z': (0.001, 0.001, 0.001, 0.001)},\n        # Case C: Mixed active/inactive\n        {'Lx': 0.2, 'Ly': 0.1, 'kp': 1e9, 'z': (-0.004, 0.001, 0.001, 0.001)},\n    ]\n\n    # Gauss quadrature points for 2x2 rule\n    alpha = 1.0 / np.sqrt(3.0)\n    gauss_points = [\n        (-alpha, -alpha),\n        (alpha, -alpha),\n        (alpha, alpha),\n        (-alpha, alpha)\n    ]\n    # All weights are 1.0 for 2x2 Gauss quadrature on [-1,1]x[-1,1]\n    gauss_weights = [1.0, 1.0, 1.0, 1.0]\n\n    # Rigid plane definition\n    n_contact = np.array([0.0, 0.0, 1.0])\n    x0_contact = np.array([0.0, 0.0, 0.0])\n\n    all_results = []\n    \n    for case in test_cases:\n        Lx, Ly, kp = case['Lx'], case['Ly'], case['kp']\n        z1, z2, z3, z4 = case['z']\n\n        # Nodal coordinates in physical space (3x4 matrix)\n        X = np.array([\n            [0.0, Lx, Lx, 0.0],\n            [0.0, 0.0, Ly, Ly],\n            [z1,  z2,  z3,  z4]\n        ])\n\n        # Initialize element force vector (12 components)\n        f_e = np.zeros(12)\n\n        for i, (xi, eta) in enumerate(gauss_points):\n            w = gauss_weights[i]\n\n            # Shape functions N_I(xi, eta)\n            N = 0.25 * np.array([\n                (1-xi)*(1-eta),\n                (1+xi)*(1-eta),\n                (1+xi)*(1+eta),\n                (1-xi)*(1+eta)\n            ])\n\n            # Physical position of the Gauss point\n            x_gp = X @ N\n            \n            # Normal gap calculation\n            g_n = np.dot(n_contact, x_gp - x0_contact)\n\n            # Check for active contact (penetration)\n            if g_n  0:\n                # Penalty pressure\n                lambda_n = -kp * g_n\n\n                # Derivatives of shape functions w.r.t. parent coordinates\n                dN_dxi = 0.25 * np.array([-(1-eta), (1-eta), (1+eta), -(1+eta)])\n                dN_deta = 0.25 * np.array([-(1-xi), -(1+xi), (1+xi), (1-xi)])\n\n                # Covariant base vectors\n                a1 = X @ dN_dxi\n                a2 = X @ dN_deta\n\n                # Surface Jacobian\n                normal_vec = np.cross(a1, a2)\n                J_A = np.linalg.norm(normal_vec)\n                \n                # Force contribution from this Gauss point\n                # The force is in the direction of n_contact\n                # Force on node I is lambda_n * N_I * n_contact * J_A * w\n                force_increment = lambda_n * J_A * w * N\n                \n                # Assemble into 12-component vector (only z-components are non-zero)\n                f_e[2] += force_increment[0]\n                f_e[5] += force_increment[1]\n                f_e[8] += force_increment[2]\n                f_e[11] += force_increment[3]\n\n        all_results.append(f_e.tolist())\n    \n    # Format the output string as specified\n    formatted_results = []\n    for res_list in all_results:\n        formatted_list = [f\"{x:.6f}\" for x in res_list]\n        formatted_results.append(f\"[{','.join(formatted_list)}]\")\n    \n    final_output = f\"[{','.join(formatted_results)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2548018"}]}