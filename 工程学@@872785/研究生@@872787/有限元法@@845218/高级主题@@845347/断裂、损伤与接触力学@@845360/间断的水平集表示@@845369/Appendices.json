{"hands_on_practices": [{"introduction": "水平集函数不仅能表示单个几何域，还能通过函数间的运算来表示复杂几何的组合。本练习旨在探索如何通过 $\\min$ 和 $\\max$ 运算实现几何域的并集与交集，这是拓扑优化的基本构件。更重要的是，本练习将揭示这些操作引入的不可微性问题，并介绍一种平滑近似方法，这对于基于梯度的优化算法至关重要。[@problem_id:2573382]", "problem": "考虑一个在多边形域 $\\Omega \\subset \\mathbb{R}^{2}$ 上的标量扩散问题，该问题通过有限元方法 (FEM) 进行离散化。两个子域 $A,B \\subset \\Omega$ 表示具有不连续材料系数的夹杂物。每个子域由一个符号距离水平集表示：一个 Lipschitz 连续函数 $\\phi_{A}:\\Omega \\to \\mathbb{R}$ 和 $\\phi_{B}:\\Omega \\to \\mathbb{R}$，使得对于 $X \\in \\Omega$，$X \\in A$ 当且仅当 $\\phi_{A}(X)0$，且 $X \\in \\partial A$ 当且仅当 $\\phi_{A}(X)=0$（对于 $B$ 也类似）。符号约定为：水平集在集合内部为负，在外部为正。这些水平集用于将清晰的材料界面（不连续性）嵌入到有限元网格中，而无需使网格与界面共形。\n\n(a) 仅使用集合并集 $A \\cup B$ 和交集 $A \\cap B$ 的定义以及上述符号约定，根据 $\\phi_{A}$ 和 $\\phi_{B}$ 推导出表示 $A \\cup B$ 的水平集函数 $\\phi_{A \\cup B}$ 和表示 $A \\cap B$ 的水平集函数 $\\phi_{A \\cap B}$ 的点态公式。你的公式必须在集合的内部和外部恢复正确的符号，并在相应的边界上满足 $\\phi=0$。\n\n(b) 解释为什么你在 (a) 部分中推导的公式不是处处可微的，并讨论当目标和约束通过水平集的正则化亥维赛德函数依赖于材料分布时，这种不可微性对有限元法中基于梯度的形状优化的影响。\n\n(c) 为了实现基于梯度的优化，考虑由 log-sum-exp 平滑给出的点态最小值的光滑近似\n$$\n\\psi_{\\varepsilon}(a,b) \\coloneqq -\\,\\varepsilon \\,\\ln\\!\\big(\\exp(-a/\\varepsilon)+\\exp(-b/\\varepsilon)\\big),\n$$\n其中平滑参数 $\\varepsilon0$。证明当 $\\varepsilon \\to 0^{+}$ 时，$\\psi_{\\varepsilon}(a,b)$ 点态收敛到 $\\min(a,b)$，并推导出梯度公式\n$$\n\\nabla \\psi_{\\varepsilon}\\big(\\phi_{A}(X),\\phi_{B}(X)\\big)\n=\nw_{A}(X)\\,\\nabla \\phi_{A}(X) + w_{B}(X)\\,\\nabla \\phi_{B}(X),\n$$\n其中 $w_{A}(X)$ 和 $w_{B}(X)$ 是你必须根据 $\\phi_{A}(X)$、$\\phi_{B}(X)$ 和 $\\varepsilon$ 明确确定的权重。\n\n(d) 设 $A$ 为左半平面，$B$ 为以 $(1,0)$ 为中心的单位圆盘，由符号距离函数\n$$\n\\phi_{A}(x,y) = x,\n\\qquad\n\\phi_{B}(x,y) = \\sqrt{(x-1)^{2}+y^{2}} - 1.\n$$\n描述。使用平滑并集 $\\phi_{A \\cup B}^{(\\varepsilon)}(x,y) \\coloneqq \\psi_{\\varepsilon}\\!\\big(\\phi_{A}(x,y),\\phi_{B}(x,y)\\big)$，其中 $\\varepsilon = \\tfrac{1}{10}$，计算 $\\phi_{A \\cup B}^{(\\varepsilon)}(0,0)$ 的值。将你的答案四舍五入到 4 位有效数字。", "solution": "问题陈述已经过评估并被确定为有效。它是自洽的，在水平集方法和数值优化的理论中有科学依据，并提出了一系列定义明确的数学任务。我们将开始解答。\n\n(a) 我们必须推导表示并集 $A \\cup B$ 和交集 $A \\cap B$ 的水平集函数的点态公式。集合 $S$ 的水平集函数 $\\phi_{S}$ 的定义由符号约定给出：对于任意点 $X \\in \\Omega$，$X \\in S \\iff \\phi_S(X)  0$。\n\n对于交集 $A \\cap B$，一个点 $X$ 属于 $A \\cap B$ 当且仅当 $X \\in A$ 且 $X \\in B$。将此转换为水平集的语言，这等价于条件 $\\phi_A(X)  0$ 且 $\\phi_B(X)  0$。我们寻找一个函数 $\\phi_{A \\cap B}(X)$，它为负当且仅当 $\\phi_A(X)$ 和 $\\phi_B(X)$ 均为负。点态最大值函数满足此要求。如果两个值都为负，则它们的最大值为负。如果至少有一个值为非负，则它们的最大值为非负。零水平集 $\\phi_{A \\cap B}(X)=0$ 正确对应于边界 $\\partial(A \\cap B)$。因此，交集的水平集函数由下式给出：\n$$\n\\phi_{A \\cap B}(X) = \\max\\big(\\phi_A(X), \\phi_B(X)\\big)\n$$\n\n对于并集 $A \\cup B$，一个点 $X$ 属于 $A \\cup B$ 当且仅当 $X \\in A$ 或 $X \\in B$。用水平集的术语来说，这等价于条件 $\\phi_A(X)  0$ 或 $\\phi_B(X)  0$。我们寻找一个函数 $\\phi_{A \\cup B}(X)$，它为负当且仅当 $\\phi_A(X)$ 或 $\\phi_B(X)$ 中至少有一个为负。点态最小值函数满足此要求。如果至少有一个值为负，则它们的最小值为负。只有当两个值都为非负时，它们的最小值才为非负。零水平集 $\\phi_{A \\cup B}(X)=0$ 对应于边界 $\\partial(A \\cup B)$。因此，并集的水平集函数由下式给出：\n$$\n\\phi_{A \\cup B}(X) = \\min\\big(\\phi_A(X), \\phi_B(X)\\big)\n$$\n\n(b) 函数 $f(a,b) = \\min(a,b)$ 和 $g(a,b) = \\max(a,b)$ 并非处处可微。具体来说，它们在参数相等的点，即 $a=b$ 的点，是不可微的。在水平集函数 $\\phi_A(X)$ 和 $\\phi_B(X)$ 的背景下，$\\phi_{A \\cup B}$ 和 $\\phi_{A \\cap B}$ 的这种不可微性发生在定义域中所有满足 $\\phi_A(X) = \\phi_B(X)$ 的点 $X$ 上。几何上，这个点的轨迹包括两个边界的交集 $\\partial A \\cap \\partial B$，但更一般地，是与两个边界等距的点的集合。在这些位置，组合函数的图像呈现出一个“扭折”或尖角，其梯度没有明确定义；它会经历一个跳跃不连续。\n\n在基于梯度的形状优化中，目标函数 $J$ 通常依赖于材料布局，而材料布局是通过水平集函数 $\\phi$ 定义的。例如，某个属性 $\\kappa$ 可以写为 $\\kappa(\\phi) = \\kappa_{1} + (\\kappa_2 - \\kappa_1)H_{\\delta}(\\phi)$，其中 $H_{\\delta}$ 是一个正则化的亥维赛德函数。目标函数关于形状参数的梯度需要计算 $J$ 关于 $\\phi$ 的导数，这又需要 $\\phi$ 的梯度，即 $\\nabla\\phi$。如果 $\\phi = \\min(\\phi_A, \\phi_B)$，其梯度被分段定义为 $\\nabla\\phi_A$ 或 $\\nabla\\phi_B$，但在 $\\phi_A=\\phi_B$ 的地方是未定义的。梯度场中此类不连续性的存在，阻碍了标准基于梯度的优化算法（如最速下降法、共轭梯度法或拟牛顿法）的稳定应用，因为这些算法依赖于一个连续定义的梯度来确定搜索方向。这可能导致算法不收敛或在不可微点附近振荡。这是在形状优化中使用 min 和 max 算子的光滑近似的主要动机。\n\n(c) 我们得到 $\\min(a,b)$ 的光滑近似 $\\psi_{\\varepsilon}(a,b) = -\\varepsilon \\ln\\big(\\exp(-a/\\varepsilon)+\\exp(-b/\\varepsilon)\\big)$。\n首先，我们证明 $\\lim_{\\varepsilon \\to 0^{+}} \\psi_{\\varepsilon}(a,b) = \\min(a,b)$。\n不失一般性，假设 $a \\le b$。我们可以通过提出对应于最小值 $a$ 的项来重写表达式：\n$$\n\\psi_{\\varepsilon}(a,b) = -\\varepsilon \\ln\\Big(\\exp(-a/\\varepsilon)\\big(1+\\exp(-(b-a)/\\varepsilon)\\big)\\Big)\n$$\n使用对数的性质 $\\ln(xy) = \\ln(x) + \\ln(y)$，我们得到：\n$$\n\\psi_{\\varepsilon}(a,b) = -\\varepsilon \\Big(\\ln\\big(\\exp(-a/\\varepsilon)\\big) + \\ln\\big(1+\\exp(-(b-a)/\\varepsilon)\\big)\\Big)\n$$\n$$\n\\psi_{\\varepsilon}(a,b) = -\\varepsilon \\Big(-\\frac{a}{\\varepsilon} + \\ln\\big(1+\\exp(-(b-a)/\\varepsilon)\\big)\\Big)\n$$\n$$\n\\psi_{\\varepsilon}(a,b) = a - \\varepsilon \\ln\\big(1+\\exp(-(b-a)/\\varepsilon)\\big)\n$$\n现在我们取极限 $\\varepsilon \\to 0^{+}$。因为我们假设了 $a \\le b$，所以差值 $b-a \\ge 0$。\n如果 $a  b$，那么 $b-a > 0$，当 $\\varepsilon \\to 0^{+}$ 时，项 $\\exp(-(b-a)/\\varepsilon) \\to 0$。表达式变为 $a - \\varepsilon \\ln(1+0) = a$。\n如果 $a=b$，表达式变为 $a - \\varepsilon \\ln(1+\\exp(0)) = a - \\varepsilon \\ln(2)$。当 $\\varepsilon \\to 0^{+}$ 时，这也收敛于 $a$。\n在两种情况下，极限都是 $a = \\min(a,b)$。根据对称性，如果 $b  a$，极限是 $b$。因此，点态极限是 $\\min(a,b)$。\n\n接下来，我们推导梯度公式。令 $u(X) = \\phi_A(X)$ 和 $v(X) = \\phi_B(X)$。我们想计算 $\\nabla \\psi_{\\varepsilon}(u,v)$。使用多变量链式法则：\n$$\n\\nabla \\psi_{\\varepsilon}(u,v) = \\frac{\\partial \\psi_{\\varepsilon}}{\\partial u} \\nabla u + \\frac{\\partial \\psi_{\\varepsilon}}{\\partial v} \\nabla v\n$$\n我们计算 $\\psi_{\\varepsilon}(a,b)$ 关于其参数 $a$ 和 $b$ 的偏导数。\n$$\n\\frac{\\partial \\psi_{\\varepsilon}}{\\partial a} = -\\varepsilon \\cdot \\frac{1}{\\exp(-a/\\varepsilon)+\\exp(-b/\\varepsilon)} \\cdot \\frac{\\partial}{\\partial a} \\big(\\exp(-a/\\varepsilon)+\\exp(-b/\\varepsilon)\\big)\n= -\\varepsilon \\cdot \\frac{\\exp(-a/\\varepsilon) \\cdot (-1/\\varepsilon)}{\\exp(-a/\\varepsilon)+\\exp(-b/\\varepsilon)}\n= \\frac{\\exp(-a/\\varepsilon)}{\\exp(-a/\\varepsilon)+\\exp(-b/\\varepsilon)}\n$$\n$$\n\\frac{\\partial \\psi_{\\varepsilon}}{\\partial b} = -\\varepsilon \\cdot \\frac{1}{\\exp(-a/\\varepsilon)+\\exp(-b/\\varepsilon)} \\cdot \\frac{\\partial}{\\partial b} \\big(\\exp(-a/\\varepsilon)+\\exp(-b/\\varepsilon)\\big)\n= -\\varepsilon \\cdot \\frac{\\exp(-b/\\varepsilon) \\cdot (-1/\\varepsilon)}{\\exp(-a/\\varepsilon)+\\exp(-b/\\varepsilon)}\n= \\frac{\\exp(-b/\\varepsilon)}{\\exp(-a/\\varepsilon)+\\exp(-b/\\varepsilon)}\n$$\n这些就是权重 $w_A$ 和 $w_B$。代入 $a=\\phi_A(X)$ 和 $b=\\phi_B(X)$：\n$$\nw_A(X) = \\frac{\\exp(-\\phi_A(X)/\\varepsilon)}{\\exp(-\\phi_A(X)/\\varepsilon) + \\exp(-\\phi_B(X)/\\varepsilon)}\n$$\n$$\nw_B(X) = \\frac{\\exp(-\\phi_B(X)/\\varepsilon)}{\\exp(-\\phi_A(X)/\\varepsilon) + \\exp(-\\phi_B(X)/\\varepsilon)}\n$$\n因此，梯度公式为：\n$$\n\\nabla \\psi_{\\varepsilon}\\big(\\phi_{A}(X),\\phi_{B}(X)\\big)\n=\nw_{A}(X)\\,\\nabla \\phi_{A}(X) + w_{B}(X)\\,\\nabla \\phi_{B}(X)\n$$\n其中权重如上所述。注意 $w_A(X)+w_B(X)=1$。\n\n(d) 我们的任务是计算 $\\phi_{A \\cup B}^{(\\varepsilon)}(0,0) = \\psi_{\\varepsilon}(\\phi_A(0,0), \\phi_B(0,0))$，其中 $\\varepsilon = \\frac{1}{10}$。\n水平集函数为：\n$$\n\\phi_{A}(x,y) = x\n$$\n$$\n\\phi_{B}(x,y) = \\sqrt{(x-1)^{2}+y^{2}} - 1\n$$\n我们在点 $(x,y)=(0,0)$ 处计算这些函数的值：\n$$\n\\phi_{A}(0,0) = 0\n$$\n$$\n\\phi_{B}(0,0) = \\sqrt{(0-1)^{2}+0^{2}} - 1 = \\sqrt{1} - 1 = 1-1 = 0\n$$\n现在我们将这些值代入 $\\psi_{\\varepsilon}$ 的公式中，其中 $\\varepsilon = 0.1$：\n$$\n\\phi_{A \\cup B}^{(\\varepsilon)}(0,0) = \\psi_{0.1}(0, 0) = -0.1 \\cdot \\ln\\big(\\exp(-0/0.1) + \\exp(-0/0.1)\\big)\n$$\n$$\n= -0.1 \\cdot \\ln\\big(\\exp(0) + \\exp(0)\\big)\n$$\n$$\n= -0.1 \\cdot \\ln(1 + 1)\n$$\n$$\n= -0.1 \\ln(2)\n$$\n使用 $\\ln(2) \\approx 0.69314718...$ 的值，我们计算：\n$$\n-0.1 \\times 0.69314718... = -0.069314718...\n$$\n将结果四舍五入到 4 位有效数字，我们得到 $-0.06931$。", "answer": "$$\n\\boxed{-0.06931}\n$$", "id": "2573382"}, {"introduction": "将连续的水平集函数应用于离散的有限元网格时，我们必须能够在单个单元内部精确地重构由界面切割产生的几何形状。本练习提供了一个具体的操作任务：利用单元节点上的水平集函数值，通过线性插值来定位界面，并重建被切割后的子区域。掌握这项技能是实现切割有限元法 (CutFEM) 等非贴体网格方法的关键一步。[@problem_id:2573446]", "problem": "在切割有限元法 (CutFEM) 中，单元内部的材料界面由标量函数 $\\phi(\\mathbf{x})$ 的零水平集表示，子域定义为 $K^{\\pm} = K \\cap \\{\\pm \\phi  0\\}$。考虑一个凸四边形单元 $K$，它是一个单位正方形，其顶点按逆时针顺序列出为 $\\mathbf{x}_1 = (0,0)$、$\\mathbf{x}_2 = (1,0)$、$\\mathbf{x}_3 = (1,1)$ 和 $\\mathbf{x}_4 = (0,1)$。水平集函数的节点值由 $\\phi_1 = -0.6$、$\\phi_2 = 0.4$、$\\phi_3 = 0.8$ 和 $\\phi_4 = -0.2$ 给出。假设沿着 $K$ 的每条边，$\\phi$ 的值随边参数线性变化，这与有限元法中的标准节点插值一致。\n\n仅使用 $K$ 内部的零水平集是集合 $\\{\\mathbf{x} \\in K : \\phi(\\mathbf{x}) = 0\\}$ 的基本定义，以及在两个节点值分别为 $\\phi_a$ 和 $\\phi_b$ 的边上进行线性插值，当且仅当 $\\phi_a \\phi_b  0$ 时会产生唯一的零点穿越，请执行以下操作：\n\n1. 确定 $K$ 的哪些边被界面 $\\{\\phi = 0\\}$ 切割，并对每条这样的边，通过在边上强制线性插值为 $\\phi = 0$ 来推导定位交点的插值参数。\n2. 通过按逆时针顺序列出其顶点来重建 $K^{+} = K \\cap \\{\\phi  0\\}$ 的多边形近似，这些顶点由 $K$ 的相关正值顶点和您找到的界面-边交点组成。\n3. 使用不预设特定公式的通用几何方法计算 $K^{+}$ 的面积，并给出最终面积。\n\n以平方单位表示最终面积。您的最终答案必须是一个数字，如果可能，请使用精确形式。", "solution": "问题要求分析一个被界面切割的四边形有限元，该界面定义为分段线性函数 $\\phi(\\mathbf{x})$ 的零水平集。我们已知单元 $K$ 的几何形状以及在其四个顶点上 $\\phi$ 的值。目标是确定子域 $K^{+} = K \\cap \\{\\phi > 0\\}$ 的几何形状并计算其面积。分析将按指定的三个步骤进行。\n\n单元 $K$ 是单位正方形，其顶点为 $\\mathbf{x}_1 = (0,0)$、$\\mathbf{x}_2 = (1,0)$、$\\mathbf{x}_3 = (1,1)$ 和 $\\mathbf{x}_4 = (0,1)$。水平集函数的节点值为 $\\phi_1 = -0.6$、$\\phi_2 = 0.4$、$\\phi_3 = 0.8$ 和 $\\phi_4 = -0.2$。\n\n首先，我们必须确定单元 $K$ 的哪些边与界面 $\\{\\mathbf{x} \\in K : \\phi(\\mathbf{x}) = 0\\}$ 相交。连接两个顶点 $\\mathbf{x}_i$ 和 $\\mathbf{x}_j$ 的边被切割，当且仅当水平集函数 $\\phi$ 在这两个顶点处具有相反的符号，即 $\\phi_i \\phi_j  0$。对于每条被切割的边，我们通过线性插值找到交点。位于 $\\mathbf{x}_i$ 和 $\\mathbf{x}_j$ 之间的边上的点 $\\mathbf{x}(s)$ 可参数化为 $\\mathbf{x}(s) = (1-s)\\mathbf{x}_i + s\\mathbf{x}_j$，其中边参数 $s \\in [0, 1]$。此点处的 $\\phi$ 值为 $\\phi(s) = (1-s)\\phi_i + s\\phi_j$。交点发生在 $\\phi(s)=0$ 处，这得到参数 $s = \\frac{-\\phi_i}{\\phi_j - \\phi_i}$。\n\n边 $\\mathbf{x}_1\\mathbf{x}_2$: 节点值为 $\\phi_1 = -0.6$ 和 $\\phi_2 = 0.4$。其乘积为 $\\phi_1\\phi_2 = (-0.6)(0.4) = -0.24  0$，所以这条边被切割。交点参数 $s_1$ 为 $s_1 = \\frac{-\\phi_1}{\\phi_2 - \\phi_1} = \\frac{-(-0.6)}{0.4 - (-0.6)} = \\frac{0.6}{1.0} = 0.6$。交点（我们记为 $\\mathbf{p}_1$）的坐标为 $\\mathbf{p}_1 = (1-s_1)\\mathbf{x}_1 + s_1\\mathbf{x}_2 = (1-0.6)(0,0) + 0.6(1,0) = (0.6, 0)$。\n\n边 $\\mathbf{x}_2\\mathbf{x}_3$: 节点值为 $\\phi_2 = 0.4$ 和 $\\phi_3 = 0.8$。其乘积为 $\\phi_2\\phi_3 = (0.4)(0.8) = 0.32  0$，所以这条边未被切割。两个顶点都位于正子域 $K^{+}$ 内。\n\n边 $\\mathbf{x}_3\\mathbf{x}_4$: 节点值为 $\\phi_3 = 0.8$ 和 $\\phi_4 = -0.2$。其乘积为 $\\phi_3\\phi_4 = (0.8)(-0.2) = -0.16  0$，所以这条边被切割。对于从 $\\mathbf{x}_3$ 到 $\\mathbf{x}_4$ 的线段，交点参数 $s_2$ 为 $s_2 = \\frac{-\\phi_3}{\\phi_4 - \\phi_3} = \\frac{-0.8}{-0.2 - 0.8} = \\frac{-0.8}{-1.0} = 0.8$。交点 $\\mathbf{p}_2$ 的坐标为 $\\mathbf{p}_2 = (1-s_2)\\mathbf{x}_3 + s_2\\mathbf{x}_4 = (1-0.8)(1,1) + 0.8(0,1) = 0.2(1,1) + (0, 0.8) = (0.2, 0.2) + (0, 0.8) = (0.2, 1.0)$。\n\n边 $\\mathbf{x}_4\\mathbf{x}_1$: 节点值为 $\\phi_4 = -0.2$ 和 $\\phi_1 = -0.6$。其乘积为 $\\phi_4\\phi_1 = (-0.2)(-0.6) = 0.12  0$，所以这条边未被切割。两个顶点都位于负子域 $K^{-}$ 内。\n\n第二，我们重建子域 $K^{+} = K \\cap \\{\\phi > 0\\}$ 的多边形近似。该多边形的顶点由 $\\phi > 0$ 的原始单元顶点和刚刚计算出的交点 $\\mathbf{p}_1$ 和 $\\mathbf{p}_2$ 组成。$K$ 的顶点中 $\\phi$ 值为正的有 $\\mathbf{x}_2$ ($\\phi_2 = 0.4 > 0$) 和 $\\mathbf{x}_3$ ($\\phi_3 = 0.8 > 0$)。因此，多边形 $K^{+}$ 的顶点是 $\\mathbf{p}_1 = (0.6, 0)$、$\\mathbf{x}_2 = (1, 0)$、$\\mathbf{x}_3 = (1, 1)$ 和 $\\mathbf{p}_2 = (0.2, 1)$。为了形成一个简单多边形，这些顶点必须被排序。观察它们的坐标，逆时针顺序是：$\\mathbf{v}_1 = (0.6, 0), \\mathbf{v}_2 = (1, 0), \\mathbf{v}_3 = (1, 1), \\mathbf{v}_4 = (0.2, 1)$。这个多边形是一个四边形。\n\n第三，我们计算 $K^{+}$ 的面积。对于一个具有 $N$ 个顶点 $(x_1, y_1), (x_2, y_2), \\dots, (x_N, y_N)$（按逆时针顺序列出）的简单多边形，计算其面积的一个通用几何方法是鞋带公式：\n$$ A = \\frac{1}{2} \\sum_{i=1}^{N} (x_i y_{i+1} - x_{i+1} y_i) $$\n其中 $(x_{N+1}, y_{N+1}) = (x_1, y_1)$。\n我们将此公式应用于 $K^{+}$ 的顶点：$\\mathbf{v}_1=(0.6, 0), \\mathbf{v}_2=(1, 0), \\mathbf{v}_3=(1, 1), \\mathbf{v}_4=(0.2, 1)$。\n当 $i=1$ 时: $x_1 y_2 - x_2 y_1 = (0.6)(0) - (1)(0) = 0$。\n当 $i=2$ 时: $x_2 y_3 - x_3 y_2 = (1)(1) - (1)(0) = 1$。\n当 $i=3$ 时: $x_3 y_4 - x_4 y_3 = (1)(1) - (0.2)(1) = 1 - 0.2 = 0.8$。\n当 $i=4$ 时: $x_4 y_1 - x_1 y_4 = (0.2)(0) - (0.6)(1) = -0.6$。\n\n这些项的和是 $0 + 1 + 0.8 - 0.6 = 1.2$。\n因此，$K^{+}$ 的面积 $A$ 为：\n$$ A = \\frac{1}{2} (1.2) = 0.6 $$\n子域 $K^{+}$ 的面积是 $0.6$ 平方单位。这个形状是一个梯形，其平行边位于直线 $y=0$ 和 $y=1$ 上。平行底的长度分别为 $b_1 = 1 - 0.6 = 0.4$ 和 $b_2 = 1 - 0.2 = 0.8$，高度为 $h=1$。使用梯形的专用公式计算面积为 $\\frac{1}{2}(b_1+b_2)h = \\frac{1}{2}(0.4+0.8)(1) = \\frac{1}{2}(1.2) = 0.6$，这验证了我们的通用计算结果。", "answer": "$$\\boxed{0.6}$$", "id": "2573446"}, {"introduction": "在正确表示和划分不连续界面后，我们必须确保物理模型的离散化在数学上和物理上都是一致的。本练习通过一个简单的一维扩散问题，深刻揭示了在处理跨界面单元时，采用朴素的材料属性平均化为何会导致物理上不正确的结果。这个例子作为一个重要的警示，强调了在存在不连续性的情况下，必须采用能够精确反映材料分区的积分方案，从而保证数值解的准确性。[@problem_id:2573395]", "problem": "考虑一维空间中的稳态扩散模型问题：求解 $u$，使得在 $\\Omega=(0,1)$ 上满足 $-\\frac{d}{dx}\\left(\\kappa(x)\\frac{du}{dx}\\right)=0$，并符合狄利克雷边界条件 $u(0)=0$ 和 $u(1)=1$。材料系数 $\\kappa(x)$ 是分段常数，由水平集函数 $\\phi(x)=x-\\alpha$ 表示，其中 $\\alpha\\in(0,1)$ 是一个固定参数，因此\n$$\n\\kappa(x)=\\begin{cases}\n\\kappa_{1},   \\text{若 } \\phi(x)0 \\text{ (即 } x\\in(0,\\alpha)),\\\\\n\\kappa_{2},   \\text{若 } \\phi(x)>0 \\text{ (即 } x\\in(\\alpha,1)).\n\\end{cases}\n$$\n你将使用 $(0,1)$ 上的单个双节点线性有限元方法（FEM）单元来近似 $u$，其形函数为 $N_{1}(x)=1-x$ 和 $N_{2}(x)=x$。令 $u_{h}(x)=N_{1}(x)u_{1}+N_{2}(x)u_{2}$ 表示离散解，并使用标准的伽辽金双线性形式 $a(u_{h},v_{h})=\\int_{0}^{1}\\kappa(x)\\,u_{h}'(x)\\,v_{h}'(x)\\,dx$。\n\n在此设置下：\n- 首先，在这个被切割的单元上证明，用其朴素的单元算术平均值 $\\overline{\\kappa}=\\frac{\\kappa_{1}+\\kappa_{2}}{2}$ 替换 $\\kappa(x)$ 会导致离散通量与精确的界面物理不一致。你的推导应基于通量的定义 $j(x)=-\\kappa(x)u'(x)$ 以及由控制方程和边界条件所蕴含的精确解结构。\n- 接下来，提出一个相容的子单元求积法则，该法则尊重由水平集引起的材料划分，通过在每个子区间上使用正确的材料值分别在 $(0,\\alpha)$ 和 $(\\alpha,1)$ 上进行积分。清晰地说明单元积分 $\\int_{0}^{1}\\kappa(x)\\,(\\cdot)\\,dx$ 是如何由子区间的贡献组装而成的。\n\n最后，令 $J_{\\text{naive}}$ 表示使用 $\\overline{\\kappa}$ 时单单元有限元法预测的恒定离散通量的大小，令 $J_{\\text{exact}}$ 表示由给定边界条件的连续介质模型所蕴含的精确物理通量的大小。以封闭形式报告通量不一致性比率\n$$\nR=\\frac{J_{\\text{naive}}}{J_{\\text{exact}}}\n$$\n的符号表达式，该表达式是 $\\kappa_{1}$、$\\kappa_{2}$ 和 $\\alpha$ 的函数。你的最终答案必须是单个解析表达式。不要提供不等式或方程。无需四舍五入。", "solution": "这是一个适定的一维稳态扩散练习题，可作为分析有限元方法(FEM)处理单元内材料不连续性时产生误差的模型。所有提供的信息在科学上都是合理的、自洽的，并且足以进行完整的分析。因此，该问题是有效的。\n\n首先，我们确定精确解 $u(x)$ 和相应的精确物理通量。控制方程为 $-\\frac{d}{dx}\\left(\\kappa(x)\\frac{du}{dx}\\right)=0$。这意味着通量，定义为 $j(x) = -\\kappa(x)\\frac{du}{dx}$，在整个域 $\\Omega=(0,1)$ 上必须是一个常数。设这个恒定通量为 $-J_{\\text{exact}}$，其中 $J_{\\text{exact}}$ 是通量的恒定大小。由此，我们得到 $\\frac{du}{dx} = \\frac{J_{\\text{exact}}}{\\kappa(x)}$。\n\n解 $u(x)$ 通过对该表达式分段积分得到。\n对于 $x \\in (0, \\alpha)$，系数为 $\\kappa(x)=\\kappa_{1}$。微分方程为 $\\frac{du}{dx} = \\frac{J_{\\text{exact}}}{\\kappa_{1}}$。积分并应用边界条件 $u(0)=0$，我们得到 $u(x) = \\frac{J_{\\text{exact}}}{\\kappa_{1}}x$。\n对于 $x \\in (\\alpha, 1)$，系数为 $\\kappa(x)=\\kappa_{2}$。微分方程为 $\\frac{du}{dx} = \\frac{J_{\\text{exact}}}{\\kappa_{2}}$。积分得到 $u(x) = \\frac{J_{\\text{exact}}}{\\kappa_{2}}x + C$，其中 $C$ 为某个积分常数。\n\n为了确定两个未知常数 $J_{\\text{exact}}$ 和 $C$，我们在 $x=1$ 处施加边界条件，并在材料界面 $x=\\alpha$ 处施加解 $u(x)$ 的连续性条件。\n1.  从 $u(1)=1$ 得：$1 = \\frac{J_{\\text{exact}}}{\\kappa_{2}}(1) + C$。\n2.  从在 $x=\\alpha$ 处的连续性，即 $u(\\alpha^{-}) = u(\\alpha^{+})$ 得：$\\frac{J_{\\text{exact}}}{\\kappa_{1}}\\alpha = \\frac{J_{\\text{exact}}}{\\kappa_{2}}\\alpha + C$。\n\n从第二个条件，我们解出 $C$：$C = J_{\\text{exact}}\\alpha \\left(\\frac{1}{\\kappa_{1}} - \\frac{1}{\\kappa_{2}}\\right)$。\n将 $C$ 的这个表达式代入第一个条件得到：\n$$1 = \\frac{J_{\\text{exact}}}{\\kappa_{2}} + J_{\\text{exact}}\\alpha \\left(\\frac{1}{\\kappa_{1}} - \\frac{1}{\\kappa_{2}}\\right) = J_{\\text{exact}} \\left( \\frac{1}{\\kappa_{2}} + \\frac{\\alpha}{\\kappa_{1}} - \\frac{\\alpha}{\\kappa_{2}} \\right) = J_{\\text{exact}} \\left( \\frac{\\alpha}{\\kappa_{1}} + \\frac{1-\\alpha}{\\kappa_{2}} \\right)$$\n求解 $J_{\\text{exact}}$ 得到精确物理通量的大小：\n$$J_{\\text{exact}} = \\left( \\frac{\\alpha}{\\kappa_{1}} + \\frac{1-\\alpha}{\\kappa_{2}} \\right)^{-1} = \\frac{\\kappa_{1}\\kappa_{2}}{\\alpha\\kappa_{2} + (1-\\alpha)\\kappa_{1}}$$\n这是电导率的长度加权调和平均值，对于一维复合介质，这是正确的有效电导率。\n\n接下来，我们分析“朴素”的单单元有限元近似。离散解为 $u_{h}(x)=N_{1}(x)u_{1}+N_{2}(x)u_{2}$。由于 $N_{1}(x)=1-x$, $N_{2}(x)=x$，以及狄利克雷条件 $u_{1}=u(0)=0$ 和 $u_{2}=u(1)=1$，离散解固定为 $u_{h}(x)=x$。\n这个离散解的梯度是恒定的：$u_{h}'(x) = 1$。\n朴素方法用简单的算术平均值 $\\overline{\\kappa} = \\frac{\\kappa_{1}+\\kappa_{2}}{2}$ 来代替真实的分段常数材料系数 $\\kappa(x)$。\n然后离散通量计算为 $j_{h}(x) = -\\overline{\\kappa}u_{h}'(x)$。对于朴素情况，这等于 $j_{h, \\text{naive}}(x) = -\\left(\\frac{\\kappa_{1}+\\kappa_{2}}{2}\\right)(1) = -\\frac{\\kappa_{1}+\\kappa_{2}}{2}$。\n这个恒定离散通量的大小为 $J_{\\text{naive}} = \\frac{\\kappa_{1}+\\kappa_{2}}{2}$。\n不一致性是显而易见的。精确的物理学要求解的梯度 $u'(x)$ 是不连续的，以便在不同电导率的材料之间保持恒定的通量 $j(x)$。单单元线性有限元模型强制梯度 $u_h'(x)$ 为常数，并试图通过平均电导率来补偿。这种平均过程——使用算术平均值——对于需要调和平均值的串联复合材料在物理上是不正确的。因此，通常情况下 $J_{\\text{naive}} \\neq J_{\\text{exact}}$。\n\n一个用于计算涉及 $\\kappa(x)$ 的积分（例如单元刚度贡献 $\\int_{0}^{1}\\kappa(x)N_{i}'(x)N_{j}'(x)dx$）的相容子单元求积法则必须尊重材料划分。正确的步骤是在不连续点 $x=\\alpha$ 处分割积分：\n$$\\int_{0}^{1}\\kappa(x)\\,f(x)\\,dx = \\int_{0}^{\\alpha}\\kappa(x)\\,f(x)\\,dx + \\int_{\\alpha}^{1}\\kappa(x)\\,f(x)\\,dx = \\kappa_{1}\\int_{0}^{\\alpha}f(x)\\,dx + \\kappa_{2}\\int_{\\alpha}^{1}f(x)\\,dx$$\n这个法则在每个子区间上使用正确的材料值。虽然这种积分与数据是“相容”的，但它不足以纠正单单元公式中的误差。根本的缺陷在于近似空间的选择。$u_h(x)=x$ 缺少了真实解在 $x=\\alpha$ 处所具有的 C0 连续性“拐点”。\n\n最后，我们计算所要求的通量不一致性比率 $R = \\frac{J_{\\text{naive}}}{J_{\\text{exact}}}$。使用上面推导出的表达式：\n$$J_{\\text{naive}} = \\frac{\\kappa_{1}+\\kappa_{2}}{2}$$\n$$J_{\\text{exact}} = \\frac{\\kappa_{1}\\kappa_{2}}{\\alpha\\kappa_{2} + (1-\\alpha)\\kappa_{1}}$$\n因此，该比率为：\n$$R = \\frac{\\frac{\\kappa_{1}+\\kappa_{2}}{2}}{\\frac{\\kappa_{1}\\kappa_{2}}{\\alpha\\kappa_{2} + (1-\\alpha)\\kappa_{1}}} = \\left( \\frac{\\kappa_{1}+\\kappa_{2}}{2} \\right) \\left( \\frac{\\alpha\\kappa_{2} + (1-\\alpha)\\kappa_{1}}{\\kappa_{1}\\kappa_{2}} \\right)$$\n这可以简化为比率的最终符号表达式。\n$$R = \\frac{(\\kappa_{1}+\\kappa_{2})(\\alpha\\kappa_{2} + (1-\\alpha)\\kappa_{1})}{2\\kappa_{1}\\kappa_{2}}$$", "answer": "$$\n\\boxed{\\frac{(\\kappa_{1} + \\kappa_{2})(\\alpha\\kappa_{2} + (1-\\alpha)\\kappa_{1})}{2\\kappa_{1}\\kappa_{2}}}\n$$", "id": "2573395"}]}