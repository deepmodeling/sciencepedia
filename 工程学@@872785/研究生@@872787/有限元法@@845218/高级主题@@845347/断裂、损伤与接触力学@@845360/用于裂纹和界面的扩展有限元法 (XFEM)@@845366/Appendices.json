{"hands_on_practices": [{"introduction": "任何扩展有限元（XFEM）分析的第一步都是确定哪些节点需要通过富集函数进行特殊处理。本练习 [@problem_id:2557355] 聚焦于这一关键的识别过程，通过一个简单的裂纹问题，帮助您掌握如何为代表位移不连续性的亥维赛（Heaviside）富集和代表应力奇异性的近尖端富集选择节点。正确设置代表裂纹体的代数系统并理解 XFEM 近似空间的结构，是进行有效分析的基础。", "problem": "考虑在矩形域 $\\Omega = [0,3] \\times [0,2]$ 上，使用双线性四边形有限元离散的二维平面应变线性弹性问题。网格包含 $3 \\times 2$ 个单元，节点位于整数格点上。从左下角开始按行对节点进行编号，使得节点坐标 $(x,y)$ 如下：\n节点 $1:(0,0)$，节点 $2:(1,0)$，节点 $3:(2,0)$，节点 $4:(3,0)$，\n节点 $5:(0,1)$，节点 $6:(1,1)$，节点 $7:(2,1)$，节点 $8:(3,1)$，\n节点 $9:(0,2)$，节点 $10:(1,2)$，节点 $11:(2,2)$，节点 $12:(3,2)$。\n设六个单元具有以下节点连接关系（逆时针）：$e_1=[1,2,6,5]$，$e_2=[2,3,7,6]$，$e_3=[3,4,8,7]$，$e_4=[5,6,10,9]$，$e_5=[6,7,11,10]$，$e_6=[7,8,12,11]$。\n\n一条零厚度的直裂纹 $\\Gamma_c$ 嵌入在域中。该裂纹使用扩展有限元法 (XFEM) 进行建模，利用 Heaviside 增强来表示裂纹面上的位移跳跃，并利用裂纹尖端附近的渐近分支增强来捕捉裂纹尖端附近的奇异场。该裂纹定义为从点 $\\mathbf{x}_A=(0.2,0.9)$ 到尖端 $\\mathbf{x}_T=(2.4,0.9)$ 的线段（坐标单位与网格相同），它不穿过任何节点，也不与任何单元边重合。\n\n假设采用以下增强选择规则：\n\n(1) Heaviside 增强：如果一个节点所连接的至少一个单元被 $\\Gamma_c$ 的内部所贯穿，并且该节点不属于尖端附近增强集，则该节点为 Heaviside 增强节点。\n\n(2) 尖端附近增强：设 $e_t$ 为包含裂纹尖端 $\\mathbf{x}_T$ 的唯一单元。尖端附近增强集由属于 $e_t$ 以及所有与 $e_t$ 共享边的单元的并集的所有节点组成。\n\n假设标准位移近似中每个节点有 $2$ 个平移自由度。在 XFEM 增强中：\n- 每个 Heaviside 增强节点带有一个与标量 Heaviside 函数相关的向量值增强系数（即，每个 Heaviside 增强节点增加 $2$ 个自由度）。\n- 每个尖端附近增强节点带有四个与四个标准二维尖端附近分支函数相关的向量值增强系数（即，每个尖端附近增强节点增加 $8$ 个自由度）。\n\n从这些定义和有限元法中节点支集的标准概念出发，确定对于此网格和裂纹配置，通过增强相对于标准有限元模型引入的额外自由度总数。根据所述规则，说明哪些节点是 Heaviside 增强节点，哪些是尖端附近增强节点。最终答案以无单位的整数表示。", "solution": "我们从有限元的基本概念开始：一个双线性四边形单元将每个节点与一个标量形函数相关联，该形函数的支集是包含该节点的所有单元的并集。在二维线性弹性中，位移场有两个分量，因此每个节点拥有 $2$ 个标准自由度。在扩展有限元法 (XFEM) 中，由标准形函数提供的单位分解乘以增强函数，以表示位移跳跃和裂纹尖端奇异性等特征。节点上的每个标量增强函数会引入一个向量值增强系数，从而增加 $2$ 个额外的自由度。\n\n我们应用所提供的增强选择规则：\n\n步骤 1：识别被 $\\Gamma_c$ 内部贯穿的单元以及包含裂纹尖端的单元。\n\n裂纹 $\\Gamma_c$ 是从 $\\mathbf{x}_A=(0.2,0.9)$ 到 $\\mathbf{x}_T=(2.4,0.9)$ 的线段，即在 $y=0.9$ 处从 $x=0.2$ 到 $x=2.4$ 的一条水平线。各单元的范围如下：\n- $e_1=[1,2,6,5]$ 覆盖 $x \\in [0,1]$, $y \\in [0,1]$,\n- $e_2=[2,3,7,6]$ 覆盖 $x \\in [1,2]$, $y \\in [0,1]$,\n- $e_3=[3,4,8,7]$ 覆盖 $x \\in [2,3]$, $y \\in [0,1]$,\n- $e_4=[5,6,10,9]$ 覆盖 $x \\in [0,1]$, $y \\in [1,2]$,\n- $e_5=[6,7,11,10]$ 覆盖 $x \\in [1,2]$, $y \\in [1,2]$,\n- $e_6=[7,8,12,11]$ 覆盖 $x \\in [2,3]$, $y \\in [1,2]$。\n\n因为 $y=0.9 \\in (0,1)$，裂纹位于底行单元（$e_1$，$e_2$，$e_3$）内。裂纹的 $x$ 区间是 $[0.2,2.4]$，它与以下单元相交：\n- $e_1$ 对于 $x \\in [0.2,1]$（内部相交），\n- $e_2$ 对于 $x \\in [1,2]$（内部相交），\n- $e_3$ 对于 $x \\in [2,2.4]$（内部相交，直至尖端）。\n\n裂纹尖端点 $\\mathbf{x}_T=(2.4,0.9)$ 满足 $2  2.4  3$ 和 $0  0.9  1$，因此尖端单元为 $e_t=e_3$。\n\n步骤 2：根据规则 (2) 构建尖端附近增强节点集。\n\n根据规则 (2)，尖端附近增强集由 $e_t$ 的节点以及所有与 $e_t$ 共享边的单元的节点组成。$e_3$ 的共边相邻单元是：\n- 左侧相邻单元 $e_2$（共享沿 $x=2$ 的竖直边），\n- 顶部相邻单元 $e_6$（共享沿 $y=1$ 的水平边），\n并且没有右侧相邻单元（域边界在 $x=3$）和底部相邻单元（域边界在 $y=0$）。\n\n因此，尖端附近片区是单元 $\\{e_2,e_3,e_6\\}$ 的并集，其节点集为：\n- $e_2$ 的节点为 $\\{2,3,7,6\\}$，\n- $e_3$ 的节点为 $\\{3,4,8,7\\}$，\n- $e_6$ 的节点为 $\\{7,8,12,11\\}$。\n\n取其并集，得到尖端附近增强节点集为\n$\\mathcal{N}_{\\text{tip}}=\\{2,3,4,6,7,8,11,12\\}$。\n\n根据所述的近似方法，每个尖端附近增强节点引入 $4$ 个标量分支函数，每个函数带有一个 $2$ 分量的向量系数，即每个节点增加 $8$ 个自由度。\n\n步骤 3：根据规则 (1) 构建 Heaviside 增强节点集。\n\n首先列出被 $\\Gamma_c$ 内部贯穿且不包括尖端单元的单元：这些是 $e_1$ 和 $e_2$。它们的节点集是：\n- $\\mathcal{N}(e_1)=\\{1,2,6,5\\}$，\n- $\\mathcal{N}(e_2)=\\{2,3,7,6\\}$。\n\n属于被裂纹内部切割但不包括尖端单元的单元的节点并集是\n$\\{1,2,3,5,6,7\\}$。\n\n根据规则 (1)，移除位于尖端附近增强集 $\\mathcal{N}_{\\text{tip}}$ 中的节点以避免双重增强。由于 $\\mathcal{N}_{\\text{tip}}=\\{2,3,4,6,7,8,11,12\\}$，剩余的 Heaviside 增强节点是\n$\\mathcal{N}_{H}=\\{1,5\\}$。\n\n每个 Heaviside 增强节点引入一个单一的标量 Heaviside 函数，带有一个 $2$ 分量的向量系数，即每个节点增加 $2$ 个自由度。\n\n步骤 4：计算额外自由度的数量。\n\n- Heaviside 贡献：$|\\mathcal{N}_{H}| \\times 2 = 2 \\times 2 = 4$ 个额外自由度。\n- 尖端附近贡献：$|\\mathcal{N}_{\\text{tip}}| \\times 8 = 8 \\times 8 = 64$ 个额外自由度。\n\n通过增强相对于标准有限元模型引入的额外自由度总数为\n$4 + 64 = 68$。\n\n步骤 5：选择的理由。\n\nHeaviside 增强被赋予那些节点支集被裂纹段内部贯穿的节点，以确保单位分解能够表示在远离尖端的裂纹切割单元中裂纹面上的位移跳跃。将尖端附近片区中的节点从 Heaviside 增强中排除，可以避免在相同节点上出现重叠的非连续和奇异增强，这可能导致病态和线性相关。\n\n尖端附近增强被赋予尖端单元及其共边相邻单元，以利用四个标准的二维分支函数来捕捉裂纹尖端附近应力场和位移场的平方根奇异性及角度变化。将尖端增强扩展到共边相邻单元的一环区域，为表示渐近场提供了足够的支集，同时保持了一个紧凑的增强区域。这种增强集的划分与扩展有限元法的单位分解框架一致，并利用了裂纹尖端奇异场的局部特性，同时分别处理了远离尖端的位移跳跃。\n\n因此，额外自由度的总数为 $68$。", "answer": "$$\\boxed{68}$$", "id": "2557355"}, {"introduction": "一旦确定了被裂纹切割的富集单元，一个主要的实践挑战便是计算其上的积分，因为裂纹将标准单元分成了非标准形状的子域。本练习 [@problem_id:2557298] 针对这一问题提供了一种直接的方法。您将学习使用区域分解技术，将被切割的单元分解为多个简单的子三角形，从而简化积分计算，这是精确构建 XFEM 刚度矩阵和力向量的关键步骤。", "problem": "在扩展有限元法 (XFEM) 中，通过将父单元分解为由间断隔开的子域，然后对每个子域应用精确的基于面积的求积来对切割单元进行积分。考虑一个三角形有限元，其顶点为 $A=(0,0)$、$B=(3,0)$ 和 $C=(0,2)$。一条直裂纹沿垂直线 $x=1$ 与该单元相交，从边 $\\overline{AB}$ 上的点 $D=(1,0)$ 到边 $\\overline{BC}$ 上的点 $E=\\left(1,\\frac{4}{3}\\right)$。该裂纹将单元分割成两个多边形子域：$x1$ 的左子域和 $x\\ge 1$ 的右子域。\n\n定义分段线性被积函数 $g:\\mathbb{R}^{2}\\to\\mathbb{R}$ 如下：\n- 在左子域 $\\{(x,y)\\,:\\,x1\\}$ 上，$g(x,y)=1+x+y$，\n- 在右子域 $\\{(x,y)\\,:\\,x\\ge 1\\}$ 上，$g(x,y)=2-x+3y$。\n\n使用适用于 XFEM 子单元积分的精确面积分解法：\n- 将裂纹产生的两个多边形分割成不重叠的三角形，这些三角形的顶点取自集合 $\\{A,B,C,D,E\\}$，且其并集等于原始单元，\n- 对每个三角形，在其形心处构造一个求积点，其权重等于该三角形的面积，\n- 使用这些求积点和权重来计算积分\n$$\nI \\;=\\; \\iint_{T} g(x,y)\\,\\mathrm{d}A,\n$$\n其中 $T=\\mathrm{conv}\\{A,B,C\\}$ 是原始三角形。\n\n将 $I$ 的最终值表示为一个精确的有理数（无四舍五入）。最终答案中不包含单位。如果需要在裂纹本身（即 $x=1$ 处）选择一个值，请证明您的选择不影响积分值。", "solution": "首先对问题进行验证。\n\n**步骤 1：提取已知条件**\n-   父三角形单元 $T$ 的顶点为 $A=(0,0)$、$B=(3,0)$ 和 $C=(0,2)$。\n-   一条直裂纹由从 $D=(1,0)$ 到 $E=\\left(1,\\frac{4}{3}\\right)$ 的线段定义。\n-   该裂纹将单元 $T$ 分割成两个子域：$x1$ 的左子域和 $x \\ge 1$ 的右子域。\n-   被积函数是一个分段函数 $g(x,y)$，定义为：\n    $$\n    g(x,y) = \\begin{cases} 1+x+y  \\text{for } x1 \\\\ 2-x+3y  \\text{for } x\\ge 1 \\end{cases}\n    $$\n-   积分必须使用特定的求积法则进行：\n    1.  将两个多边形子域分割成不重叠的三角形，其顶点取自集合 $\\{A, B, C, D, E\\}$。\n    2.  对于每个子三角形，在其形心处使用一个求积点。\n    3.  每个求积点的权重是相应子三角形的面积。\n-   目标是计算积分 $I = \\iint_{T} g(x,y)\\,\\mathrm{d}A$。\n-   最终答案必须是一个精确的有理数。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据和客观性**：该问题在数值方法，特别是扩展有限元法 (XFEM) 的背景下是良定义的。由于间断引起的域分解、子三角剖分和数值求积等概念都是标准的。几何和函数定义是精确的，没有歧义或主观性。\n-   **适定性**：所有必要信息均已提供。父三角形的顶点已给出。裂纹位置已指定，并且可以很容易地验证点 $D=(1,0)$ 位于边 $\\overline{AB}$ 上，点 $E=\\left(1, \\frac{4}{3}\\right)$ 位于边 $\\overline{BC}$ 上（通过 $B(3,0)$ 和 $C(0,2)$ 的直线是 $\\frac{x}{3}+\\frac{y}{2}=1$，当 $x=1$ 时，我们有 $\\frac{1}{3}+\\frac{y}{2}=1 \\implies \\frac{y}{2}=\\frac{2}{3} \\implies y=\\frac{4}{3}$）。被积函数在整个域上都有定义。积分方法已明确说明。该问题是自洽且一致的，存在唯一解。\n-   **其他缺陷**：问题设置没有矛盾，在计算力学背景下是物理上合理的，并且不是平凡的。\n\n**步骤 3：结论与行动**\n问题是**有效的**。开始求解。\n\n三角形 $T$ 上的积分 $I$ 可以分解为由裂纹在 $x=1$ 处创建的两个子域上的积分之和。令 $T_{left}$ 为 $T$ 中 $x1$ 的部分， $T_{right}$ 为 $T$ 中 $x>1$ 的部分。线 $x=1$ 本身的积分为零，因为线段在 $\\mathbb{R}^2$ 中是零测集。因此，在裂纹线上使用 $x\\ge 1$ 的定义不会影响积分的最终值。\n$$\nI = \\iint_{T} g(x,y)\\,\\mathrm{d}A = \\iint_{T_{left}} (1+x+y)\\,\\mathrm{d}A + \\iint_{T_{right}} (2-x+3y)\\,\\mathrm{d}A\n$$\n子域 $T_{left}$ 是顶点为 $A(0,0)$、$D(1,0)$、$E\\left(1, \\frac{4}{3}\\right)$ 和 $C(0,2)$ 的四边形。子域 $T_{right}$ 是顶点为 $D(1,0)$、$B(3,0)$ 和 $E\\left(1, \\frac{4}{3}\\right)$ 的三角形。\n\n根据问题的指示，我们将四边形 $T_{left}$ 分割成两个三角形。我们选择对角线 $\\overline{AE}$，它将 $T_{left}$ 分解为 $\\triangle ADE$ 和 $\\triangle ACE$。因此，原始三角形 $T$ 被分解为三个子三角形：\n1.  $T_1 = \\triangle ADE$\n2.  $T_2 = \\triangle ACE$\n3.  $T_3 = \\triangle DBE$ (这与 $T_{right}$ 相同)\n\n指定的数值积分方案通过将其面积乘以被积函数在其形心处的值来计算子三角形上的积分。对于三角形 $\\Delta$ 上的线性被积函数 $f(x,y)$，该方法是精确的：$\\iint_{\\Delta} f(x,y)\\,\\mathrm{d}A = \\text{Area}(\\Delta) \\cdot f(x_c, y_c)$，其中 $(x_c, y_c)$ 是 $\\Delta$ 的形心。由于我们的被积函数 $g(x,y)$ 是分段线性的，并且每个子三角形完全位于 $g$ 是线性的区域内，因此这个过程将得到积分的精确值。\n\n我们现在计算每个子三角形的贡献。\n\n**1. 子三角形 $T_1 = \\triangle ADE$**\n-   顶点：$A(0,0)$、$D(1,0)$、$E\\left(1, \\frac{4}{3}\\right)$。\n-   该三角形位于 $x1$ 区域（边 $\\overline{DE}$ 除外）。我们使用 $g(x,y) = 1+x+y$。\n-   面积：$A_1 = \\frac{1}{2} \\times \\text{底} \\times \\text{高} = \\frac{1}{2} \\times (1-0) \\times \\frac{4}{3} = \\frac{2}{3}$。\n-   形心：$C_1 = \\left(\\frac{0+1+1}{3}, \\frac{0+0+\\frac{4}{3}}{3}\\right) = \\left(\\frac{2}{3}, \\frac{4}{9}\\right)$。\n-   在形心处的被积函数值：$g(C_1) = 1 + \\frac{2}{3} + \\frac{4}{9} = \\frac{9}{9} + \\frac{6}{9} + \\frac{4}{9} = \\frac{19}{9}$。\n-   积分贡献：$I_1 = A_1 \\cdot g(C_1) = \\frac{2}{3} \\cdot \\frac{19}{9} = \\frac{38}{27}$。\n\n**2. 子三角形 $T_2 = \\triangle ACE$**\n-   顶点：$A(0,0)$、$C(0,2)$、$E\\left(1, \\frac{4}{3}\\right)$。\n-   该三角形位于 $x1$ 区域（顶点 $E$ 除外）。我们使用 $g(x,y) = 1+x+y$。\n-   面积（使用鞋带公式）：$A_2 = \\frac{1}{2} |(0 \\cdot 2 + 0 \\cdot \\frac{4}{3} + 1 \\cdot 0) - (0 \\cdot 0 + 2 \\cdot 1 + \\frac{4}{3} \\cdot 0)| = \\frac{1}{2} |0 - 2| = 1$。\n-   形心：$C_2 = \\left(\\frac{0+0+1}{3}, \\frac{0+2+\\frac{4}{3}}{3}\\right) = \\left(\\frac{1}{3}, \\frac{\\frac{10}{3}}{3}\\right) = \\left(\\frac{1}{3}, \\frac{10}{9}\\right)$。\n-   在形心处的被积函数值：$g(C_2) = 1 + \\frac{1}{3} + \\frac{10}{9} = \\frac{9}{9} + \\frac{3}{9} + \\frac{10}{9} = \\frac{22}{9}$。\n-   积分贡献：$I_2 = A_2 \\cdot g(C_2) = 1 \\cdot \\frac{22}{9} = \\frac{22}{9}$。\n\n**3. 子三角形 $T_3 = \\triangle DBE$**\n-   顶点：$D(1,0)$、$B(3,0)$、$E\\left(1, \\frac{4}{3}\\right)$。\n-   该三角形位于 $x \\ge 1$ 区域。我们使用 $g(x,y) = 2-x+3y$。\n-   面积：$A_3 = \\frac{1}{2} \\times \\text{底} \\times \\text{高} = \\frac{1}{2} \\times (3-1) \\times \\frac{4}{3} = \\frac{1}{2} \\cdot 2 \\cdot \\frac{4}{3} = \\frac{4}{3}$。\n-   形心：$C_3 = \\left(\\frac{1+3+1}{3}, \\frac{0+0+\\frac{4}{3}}{3}\\right) = \\left(\\frac{5}{3}, \\frac{4}{9}\\right)$。\n-   在形心处的被积函数值：$g(C_3) = 2 - \\frac{5}{3} + 3\\left(\\frac{4}{9}\\right) = 2 - \\frac{5}{3} + \\frac{4}{3} = 2 - \\frac{1}{3} = \\frac{5}{3}$。\n-   积分贡献：$I_3 = A_3 \\cdot g(C_3) = \\frac{4}{3} \\cdot \\frac{5}{3} = \\frac{20}{9}$。\n\n**总积分**\n总积分 $I$ 是三个子三角形贡献之和：\n$$\nI = I_1 + I_2 + I_3 = \\frac{38}{27} + \\frac{22}{9} + \\frac{20}{9}\n$$\n为了对这些分数求和，我们找到一个公分母，即 $27$。\n$$\nI = \\frac{38}{27} + \\frac{22 \\cdot 3}{27} + \\frac{20 \\cdot 3}{27} = \\frac{38 + 66 + 60}{27}\n$$\n$$\nI = \\frac{104 + 60}{27} = \\frac{164}{27}\n$$\n作为检验，面积之和为 $A_1+A_2+A_3 = \\frac{2}{3} + 1 + \\frac{4}{3} = \\frac{6}{3}+1 = 2+1=3$。原始三角形 $T$ 的顶点为 $(0,0)$、$(3,0)$、$(0,2)$，其面积为 $\\frac{1}{2} \\times 3 \\times 2 = 3$。面积分解是正确的。最终结果是积分的精确值。", "answer": "$$\n\\boxed{\\frac{164}{27}}\n$$", "id": "2557298"}]}