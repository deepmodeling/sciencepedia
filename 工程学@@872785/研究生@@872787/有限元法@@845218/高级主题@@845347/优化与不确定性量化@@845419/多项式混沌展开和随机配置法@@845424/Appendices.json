{"hands_on_practices": [{"introduction": "在许多有限元分析中，不确定性并非源于单个随机变量，而是表现为空间相关的随机场，例如材料属性或载荷。多项式混沌展开（PCE）等方法通常基于一组独立的随机变量。本练习 [@problem_id:2589474] 介绍了一种关键的预处理技术——Karhunen–Loève（KL）展开，它通过求解一个积分特征值问题，将一个相关的随机场分解为一组不相关的随机变量。通过这个数值实践，您将学习如何将复杂的随机输入转化为适用于PCE或随机配置方法的简化形式。", "problem": "考虑一个定义在一维空间域 $[0,1]$ 上的零均值高斯随机场，其平稳协方差核为 $C(x,y)=\\sigma^2 \\exp(-|x-y|/\\ell)$，其中 $\\sigma^2>0$ 是方差，$\\ell>0$ 是相关长度。在有限元法 (FEM) 的不确定性量化中，通常通过 Karhunen–Loève (KL) 展开对此类随机场进行参数化，然后由占主导地位的 KL 模态所张成的降维随机空间中建立多项式混沌展开 (PCE) 或随机配置 (SC) 代理模型。\n\n你的任务如下：\n\n1) 从 KL 展开作为协方差积分算子谱分解的定义出发：求解积分方程，找到特征对 $\\{\\lambda_n,\\phi_n(x)\\}$\n\n$$\n\\int_0^1 C(x,y)\\,\\phi_n(y)\\,\\mathrm{d}y=\\lambda_n\\,\\phi_n(x),\\quad x\\in[0,1],\n$$\n其中特征函数 $\\{\\phi_n\\}$ 在 $L^2([0,1])$ 中是标准正交的。该场的截断 KL 展开为\n$$\nX_M(x,\\omega)=\\sum_{n=1}^M \\sqrt{\\lambda_n}\\,\\phi_n(x)\\,\\xi_n(\\omega),\n$$\n其中 $\\{\\xi_n\\}$ 是独立标准正态随机变量。该场的总积分方差等于协方差算子的迹：\n$$\n\\sum_{n=1}^\\infty \\lambda_n=\\int_0^1 C(x,x)\\,\\mathrm{d}x=\\sigma^2.\n$$\n\n2) 设计并实现一个积分特征值问题的数值 Nyström 离散化方法，使用在 $[0,1]$ 上的 $N=200$ 个节点的高斯-勒让德求积。将标准的高斯-勒让德节点和权重从 $[-1,1]$ 映射到 $[0,1]$，以获得节点 $\\{x_i\\}_{i=1}^N$ 和正权重 $\\{w_i\\}_{i=1}^N$。构建对称矩阵\n$$\nA_{ij}=\\sqrt{w_i}\\,C(x_i,x_j)\\,\\sqrt{w_j},\n$$\n其特征值近似于协方差算子的 KL 特征值 $\\{\\lambda_n\\}$。通过将绝对值小于机器容差的负值设置为零，确保数值舍入误差不会产生负特征值。\n\n3) 对于下面测试套件中的每一对参数 $(\\sigma^2,\\ell)$，计算：\n- 前 5 个最大的特征值，按非增序排列。\n- 满足前 $M$ 个特征值捕获的总积分方差的累积分数至少为 $0.95$ 的最小整数 $M$，即：\n$$\n\\frac{\\sum_{n=1}^M \\lambda_n}{\\sum_{n=1}^\\infty \\lambda_n}\\ge 0.95.\n$$\n将分母视为所有 $N$ 个离散特征值的数值计算总和。将 $M$ 报告为整数，并将特征值报告为四舍五入到 $10$ 位小数的实数。\n\n4) 将 $M$ 解释为在基于FEM的不确定性量化工作流中，为基于多项式混沌展开 (PCE) 或随机配置 (SC) 的代理模型参数化随机场所需的最小 KL 截断维度。\n\n使用以下参数值测试套件：\n- 情况 1：$(\\sigma^2,\\ell)=(1.0,\\,0.2)$。\n- 情况 2：$(\\sigma^2,\\ell)=(1.0,\\,0.05)$。\n- 情况 3：$(\\sigma^2,\\ell)=(2.0,\\,0.3)$。\n- 情况 4：$(\\sigma^2,\\ell)=(0.5,\\,1.0)$。\n\n你的程序必须：\n- 实现使用 $N=200$ 个节点在 $[0,1]$ 上的高斯-勒让德 Nyström 方法，为每种情况构建并对角化矩阵 $A$。\n- 对于每种情况，计算满足 $0.95$ 阈值的最小 $M$ 和前 $5$ 个特征值。\n- 生成单行输出，包含所有情况的结果，格式为逗号分隔的列表的列表，每个内部列表的形式为 $[M,\\lambda_1,\\lambda_2,\\lambda_3,\\lambda_4,\\lambda_5]$，其中特征值四舍五入到 $10$ 位小数。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素是如上所述的包含 6 个数字的内部列表。例如，一个可接受的格式是\n$[[M_1,\\lambda_{1,1},\\ldots,\\lambda_{1,5}],[M_2,\\lambda_{2,1},\\ldots,\\lambda_{2,5}],\\ldots]$。\n- 不应打印额外的文本。", "solution": "该问题要求对第二类弗雷德霍姆（Fredholm）积分特征值方程进行数值求解，该方程出现在高斯随机场的 Karhunen-Loève (KL) 展开中。目标是确定协方差算子的主要特征值，并找到 KL 展开所需的截断阶数 $M$，以捕获指定比例的总方差。这是不确定性量化中的一个基础步骤，特别是对于构建像多项式混沌展开 (PCE) 这样的代理模型或使用随机配置 (SC) 方法而言。\n\n控制积分方程为：\n$$\n\\int_0^1 C(x,y)\\,\\phi_n(y)\\,\\mathrm{d}y=\\lambda_n\\,\\phi_n(x),\\quad x\\in[0,1]\n$$\n其中协方差核由 $C(x,y)=\\sigma^2 \\exp(-|x-y|/\\ell)$ 给出。对于 $\\sigma^2>0$ 和 $\\ell>0$，该核是对称且正定的。因此，相应的积分算子是希尔伯特空间 $L^2([0,1])$ 上的一个紧、自伴且正定的算子。根据此类算子的谱定理，存在一个收敛于零的可数正特征值集合 $\\{\\lambda_n\\}_{n=1}^{\\infty}$，并且相应的特征函数 $\\{\\phi_n(x)\\}_{n=1}^{\\infty}$ 构成 $L^2([0,1])$ 的一个完备标准正交基。\n\n为了数值求解此方程，我们采用 Nyström 方法。该积分使用数值求积法则进行近似。问题指定了使用 $N=200$ 个点的高斯-勒让德求积。因此，该积分方程在求积节点 $\\{x_i\\}_{i=1}^N$ 处被转换为一个线性方程组：\n$$\n\\sum_{j=1}^N w_j C(x_i,x_j)\\,\\phi_n(x_j) \\approx \\lambda_n\\,\\phi_n(x_i), \\quad i=1, \\dots, N\n$$\n这里，$\\{x_j\\}_{j=1}^N$ 和 $\\{w_j\\}_{j=1}^N$ 分别是映射到区间 $[0,1]$ 的求积节点和权重。该系统表示一个矩阵特征值问题。然而，以 $D_{ij} = w_j C(x_i,x_j)$ 为元素的矩阵不是对称的。为了恢复对称性——这是原始算子的一个关键属性——我们引入变量替换。令 $v_{nj} = \\sqrt{w_j}\\,\\phi_n(x_j)$。将 $\\phi_n(x_j) = v_{nj}/\\sqrt{w_j}$ 代入离散化方程得到：\n$$\n\\sum_{j=1}^N w_j C(x_i,x_j)\\,\\frac{v_{nj}}{\\sqrt{w_j}} \\approx \\lambda_n \\, \\frac{v_{ni}}{\\sqrt{w_i}}\n$$\n两边同乘以 $\\sqrt{w_i}$ 得到一个对称特征值问题：\n$$\n\\sum_{j=1}^N \\left(\\sqrt{w_i}\\,C(x_i,x_j)\\,\\sqrt{w_j}\\right)\\,v_{nj} \\approx \\lambda_n \\, v_{ni}\n$$\n这是标准形式 $A\\mathbf{v}_n = \\lambda_n\\mathbf{v}_n$，其中对称矩阵 $A$ 由其元素定义\n$$\nA_{ij} = \\sqrt{w_i}\\,C(x_i,x_j)\\,\\sqrt{w_j}\n$$\n这个 $N \\times N$ 矩阵 $A$ 的特征值是我们对原始协方差算子特征值 $\\{\\lambda_n\\}$ 的数值近似。\n\n高斯-勒让德求积节点 $\\{\\hat{x}_i\\}$ 和权重 $\\{\\hat{w}_i\\}$ 通常定义在区间 $[-1,1]$上。使用一个线性仿射变换将它们映射到域 $[0,1]$：\n$$\nx_i = \\frac{1}{2}(\\hat{x}_i+1), \\quad w_i = \\frac{1}{2}\\hat{w}_i\n$$\n\n对于每对参数 $(\\sigma^2, \\ell)$ 的计算过程如下：\n1.  使用标准库函数在 $[-1,1]$ 上生成 $N=200$ 个高斯-勒让德节点和权重。\n2.  使用上述变换将这些节点和权重映射到区间 $[0,1]$。\n3.  构建元素为 $K_{ij} = C(x_i, x_j)$ 的 $N \\times N$ 协方差矩阵 $K$。\n4.  构建对称 Nyström 矩阵 $A$，其元素为 $A_{ij} = \\sqrt{w_i} K_{ij} \\sqrt{w_j}$。\n5.  求解 $A$ 的特征值问题以获得数值特征值 $\\{\\lambda_n\\}_{n=1}^N$。由于理论算子是正定的，任何计算出的负特征值都是数值伪影。我们将任何小于 0 的特征值 $\\lambda$ 设为 0。\n6.  将特征值按非递增顺序排序：$\\lambda_1 \\ge \\lambda_2 \\ge \\dots \\ge \\lambda_N \\ge 0$。\n7.  总积分方差通过所有数值特征值的总和来近似，$V_{total} = \\sum_{n=1}^N \\lambda_n$。这个总和是 $\\int_0^1 C(x,x)\\,\\mathrm{d}x = \\sigma^2$ 的一个离散对应物，并且由于高斯-勒让德求积的性质，它提供了对此积分的一个高度准确的估计。\n8.  确定最小截断维度 $M$。它是使得特征值的累积和至少捕获总方差 $95\\%$ 的最小整数：\n$$\nM = \\min \\left\\{ k \\in \\mathbb{Z}^+ \\, \\Big| \\, \\frac{\\sum_{n=1}^k \\lambda_n}{\\sum_{n=1}^N \\lambda_n} \\ge 0.95 \\right\\}\n$$\n这个值 $M$ 决定了在 PCE 或 SC 框架中准确高效地表示随机场所需的随机维度数量。较小的相关长度 $\\ell$ 意味着场更“粗糙”或去相关，导致特征值衰减更慢，因此需要更大的 $M$。相反，较大的 $\\ell$ 会导致场更平滑，特征值衰减更快，因此需要较小的 $M$。\n\n所提供的程序实现了此过程，为每个指定的测试用例计算 $M$ 和前五个最大特征值 $\\{\\lambda_n\\}_{n=1}^5$。", "answer": "```python\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Computes the Karhunen-Loève eigenvalues for a given covariance kernel\n    using the Nyström method with Gauss-Legendre quadrature.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 0.2),   # Case 1: (sigma^2, ell)\n        (1.0, 0.05),  # Case 2\n        (2.0, 0.3),   # Case 3\n        (0.5, 1.0),   # Case 4\n    ]\n    N = 200\n\n    results = []\n    for sigma2, ell in test_cases:\n        # Step 1: Generate Gauss-Legendre nodes and weights mapped to [0, 1]\n        # roots_legendre returns nodes and weights on [-1, 1]\n        nodes_std, weights_std = roots_legendre(N)\n        # Map nodes and weights to [0, 1]\n        nodes = 0.5 * (nodes_std + 1)\n        weights = 0.5 * weights_std\n\n        # Step 2: Construct the covariance matrix C(x_i, x_j)\n        # Use broadcasting to efficiently compute the distance matrix |x_i - x_j|\n        dist_matrix = np.abs(nodes[:, np.newaxis] - nodes[np.newaxis, :])\n        cov_matrix = sigma2 * np.exp(-dist_matrix / ell)\n\n        # Step 3: Construct the symmetric Nyström matrix A\n        sqrt_w = np.sqrt(weights)\n        # A_ij = sqrt(w_i) * C_ij * sqrt(w_j). This can be done via an outer product.\n        A = np.outer(sqrt_w, sqrt_w) * cov_matrix\n\n        # Step 4: Compute and process eigenvalues\n        # np.linalg.eigh is for symmetric matrices and returns eigenvalues in ascending order.\n        eigvals = np.linalg.eigh(A)[0]\n        \n        # As per problem, set small negative numerical artifacts to zero.\n        eigvals[eigvals < 0] = 0.0\n        \n        # Sort eigenvalues in descending order for analysis.\n        eigvals_desc = np.sort(eigvals)[::-1]\n\n        # Step 5: Compute the minimal truncation dimension M for 95% variance\n        total_variance_numerical = np.sum(eigvals_desc)\n        M = 1\n        if total_variance_numerical > 1e-15: # Avoid division by zero\n            cumulative_variance_fraction = np.cumsum(eigvals_desc) / total_variance_numerical\n            # Find the first index where the cumulative fraction is >= 0.95.\n            # np.searchsorted finds this index efficiently.\n            # M is a 1-based count, so add 1 to the 0-based index.\n            M = np.searchsorted(cumulative_variance_fraction, 0.95, side='left') + 1\n\n        # Step 6: Get the top 5 eigenvalues and round them to 10 decimal places\n        top_5_eigvals = eigvals_desc[:5]\n        rounded_top_5 = np.round(top_5_eigvals, 10).tolist()\n        \n        # Store the case result [M, lambda_1, ..., lambda_5]\n        case_result = [int(M)] + rounded_top_5\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    result_str = \",\".join(map(str, results))\n    print(f\"[{result_str}]\")\n\nsolve()\n```", "id": "2589474"}, {"introduction": "在通过Karhunen-Loève展开得到一组独立的随机变量后，下一步是构建一个多变量多项式基。然而，随着随机维度的增加，基函数的数量会爆炸式增长，这便是所谓的“维度灾难”。本练习 [@problem_id:2589483] 探讨了管理这种复杂性的不同策略，通过计算和比较三种常用截断索引集（全阶、张量积和双曲交叉）的基函数数量，帮助您直观理解在精度和计算成本之间进行权衡的实际考量。", "problem": "考虑一个通过有限元法求解的随机参数模型，其中参数依赖性由$d$个独立随机变量的正交多元多项式构成的多项式混沌展开（PCE）表示。设多元基由多重指标 $\\boldsymbol{\\alpha}=(\\alpha_{1},\\dots,\\alpha_{d}) \\in \\mathbb{N}_{0}^{d}$ 索引，其中 $\\mathbb{N}_{0}$ 表示非负整数集。PCE 和随机配置的三种常用截断指标集定义如下：\n- 全次数集 $\\mathcal{A}_{\\mathrm{TD}}(p)$ 包含所有满足 $\\sum_{i=1}^{d} \\alpha_{i} \\leq p$ 的 $\\boldsymbol{\\alpha}$。\n- 拟范数参数为 $q \\in (0,1]$ 的双曲交叉集，记为 $\\mathcal{A}_{\\mathrm{HC},q}(p)$，包含所有满足 $\\left(\\sum_{i=1}^{d} \\alpha_{i}^{q}\\right)^{1/q} \\leq p$ 的 $\\boldsymbol{\\alpha}$。\n- 张量积集 $\\mathcal{A}_{\\mathrm{TP}}(p)$ 包含所有满足对所有 $i \\in \\{1,\\dots,d\\}$ 都有 $0 \\leq \\alpha_{i} \\leq p$ 的 $\\boldsymbol{\\alpha}$。\n\n这些截断决定了多元基函数的数量，从而决定了相关随机配置法则的计算复杂度。\n\n对于维度 $d=5$，多项式截断阶数 $p=3$，以及双曲交叉拟范数参数 $q=0.5$，计算基数 $\\left|\\mathcal{A}_{\\mathrm{TD}}(p)\\right|$、$\\left|\\mathcal{A}_{\\mathrm{HC},q}(p)\\right|$ 和 $\\left|\\mathcal{A}_{\\mathrm{TP}}(p)\\right|$。请将你的最终答案以单行矩阵的形式报告，顺序为 $\\left(\\left|\\mathcal{A}_{\\mathrm{TD}}(p)\\right|,\\left|\\mathcal{A}_{\\mathrm{HC},q}(p)\\right|,\\left|\\mathcal{A}_{\\mathrm{TP}}(p)\\right|\\right)$。无需四舍五入，不涉及单位。", "solution": "该问题要求计算用于截断多项式混沌展开的三种不同类型指标集的基数。给定参数为随机维度数 $d=5$，最高多项式次数 $p=3$，以及双曲交叉集的拟范数参数 $q=0.5$。我们将根据每个集合的数学定义计算其基数。\n\n首先，我们分析全次数指标集 $\\mathcal{A}_{\\mathrm{TD}}(p)$，其定义为：\n$$ \\mathcal{A}_{\\mathrm{TD}}(p) = \\{ \\boldsymbol{\\alpha} \\in \\mathbb{N}_{0}^{d} \\mid \\sum_{i=1}^{d} \\alpha_{i} \\leq p \\} $$\n该集合的基数 $\\left|\\mathcal{A}_{\\mathrm{TD}}(p)\\right|$ 对应于丢番图不等式 $\\alpha_{1} + \\dots + \\alpha_{d} \\leq p$ 的非负整数解的数量。这是一个经典的组合问题，可以通过引入一个松弛变量 $\\alpha_{d+1} \\in \\mathbb{N}_{0}$ 将不等式转化为等式：$\\alpha_{1} + \\dots + \\alpha_{d} + \\alpha_{d+1} = p$ 来解决。解的数量由多重集系数，即“隔板法”公式 $\\binom{p+d}{d}$ 给出。\n根据给定值 $d=5$ 和 $p=3$，基数为：\n$$ \\left|\\mathcal{A}_{\\mathrm{TD}}(3)\\right| = \\binom{3+5}{5} = \\binom{8}{5} $$\n该二项式系数的值为：\n$$ \\binom{8}{5} = \\frac{8!}{5!(8-5)!} = \\frac{8!}{5!3!} = \\frac{8 \\times 7 \\times 6}{3 \\times 2 \\times 1} = 56 $$\n\n第二，我们分析张量积指标集 $\\mathcal{A}_{\\mathrm{TP}}(p)$，其定义为：\n$$ \\mathcal{A}_{\\mathrm{TP}}(p) = \\{ \\boldsymbol{\\alpha} \\in \\mathbb{N}_{0}^{d} \\mid 0 \\leq \\alpha_{i} \\leq p \\text{ for all } i \\in \\{1,\\dots,d\\} \\} $$\n对于多重指标 $\\boldsymbol{\\alpha}$ 的 $d$ 个分量中的每一个 $\\alpha_i$，都有 $p+1$ 个可能的整数值（从 $0$ 到 $p$）。由于每个分量的选择是独立的，总的组合数是每个分量选择数的乘积。因此，基数为：\n$$ \\left|\\mathcal{A}_{\\mathrm{TP}}(p)\\right| = (p+1)^{d} $$\n代入给定值 $d=5$ 和 $p=3$，我们得到：\n$$ \\left|\\mathcal{A}_{\\mathrm{TP}}(3)\\right| = (3+1)^{5} = 4^{5} = 1024 $$\n\n第三，我们分析双曲交叉指标集 $\\mathcal{A}_{\\mathrm{HC},q}(p)$，其定义为：\n$$ \\mathcal{A}_{\\mathrm{HC},q}(p) = \\{ \\boldsymbol{\\alpha} \\in \\mathbb{N}_{0}^{d} \\mid \\left(\\sum_{i=1}^{d} \\alpha_{i}^{q}\\right)^{1/q} \\leq p \\} $$\n当 $d=5$，$p=3$ 和 $q=0.5 = \\frac{1}{2}$ 时，定义不等式变为：\n$$ \\left(\\sum_{i=1}^{5} \\alpha_{i}^{0.5}\\right)^{1/0.5} \\leq 3 $$\n这可以简化为：\n$$ \\left(\\sum_{i=1}^{5} \\sqrt{\\alpha_i}\\right)^{2} \\leq 3 $$\n由于非负整数的平方根之和是非负的，我们可以对两边取平方根，得到：\n$$ \\sum_{i=1}^{5} \\sqrt{\\alpha_i} \\leq \\sqrt{3} $$\n我们必须枚举所有满足此条件的、其中 $\\alpha_i \\in \\mathbb{N}_0$ 的多重指标 $\\boldsymbol{\\alpha} = (\\alpha_1, \\alpha_2, \\alpha_3, \\alpha_4, \\alpha_5)$。注意 $\\sqrt{3} \\approx 1.732$。\n如果 $\\boldsymbol{\\alpha}$ 的任意两个或更多分量为非零，例如对于 $j \\neq k$ 有 $\\alpha_j \\geq 1$ 和 $\\alpha_k \\geq 1$，则它们的平方根之和至少为 $\\sqrt{1} + \\sqrt{1} = 2$。由于 $2 > \\sqrt{3}$，没有这样的多重指标能满足该条件。因此，$\\boldsymbol{\\alpha}$ 最多只有一个分量可以是非零的。我们分析两种可能的情况：\n\n情况1：恰好有零个非零分量。\n这对应于平凡多重指标 $\\boldsymbol{\\alpha} = (0,0,0,0,0)$。其和为 $0$，满足 $0 \\leq \\sqrt{3}$。这给出了 $1$ 个解。\n\n情况2：恰好有一个非零分量。\n设一个分量 $\\alpha_k$ 是一个正整数，而所有其他分量都为零。条件简化为 $\\sqrt{\\alpha_k} \\leq \\sqrt{3}$，这意味着 $\\alpha_k \\leq 3$。因此，$\\alpha_k$ 可能的整数值为 $1$、$2$ 和 $3$。非零分量 $k$ 的位置有 $\\binom{5}{1} = 5$ 种选择。对于每种位置选择，$\\alpha_k$ 有 $3$ 个可能的值。因此，这种情况下的解的总数为 $5 \\times 3 = 15$。\n\n结合这两种不相交的情况，双曲交叉集的总基数为：\n$$ \\left|\\mathcal{A}_{\\mathrm{HC},0.5}(3)\\right| = 1 + 15 = 16 $$\n\n因此，全次数集、双曲交叉集和张量积集的最终基数分别为 $56$、$16$ 和 $1024$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 56  16  1024 \\end{pmatrix}}\n$$", "id": "2589483"}, {"introduction": "定义了PCE基之后，我们需要计算展开式中的系数。非侵入式方法（如随机配置）通过在随机空间中选择的节点上运行确定性求解器，并使用数值积分（求积）来估计这些系数。本练习 [@problem_id:2589464] 深入探讨了这种方法的一个关键陷阱——“混叠误差”，即由于求积规则精度不足，高阶模式的能量会错误地“污染”低阶系数的估计值。通过推导避免混叠所需的最小求积精度，您将掌握确保非侵入式PCE计算准确性的基本原则。", "problem": "对于具有联合概率密度 $\\rho(\\boldsymbol{\\xi})$ 的随机输入向量 $\\boldsymbol{\\xi} \\in \\mathbb{R}^{d}$ 的每次实现，使用有限元法（FEM）求解一个参数化椭圆边值问题。令 $u(\\boldsymbol{\\xi})$ 表示从有限元解中提取的标量关注量（QoI）。考虑将 $u(\\boldsymbol{\\xi})$ 在广义多项式混沌展开（PCE）中展开，其标准正交基为 $\\{\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\\}_{\\boldsymbol{\\alpha} \\in \\mathbb{N}_{0}^{d}}$（关于 $\\rho(\\boldsymbol{\\xi})$），并将此展开截断至总阶为 $p$ 的多重指标集 $\\Lambda_{p} := \\{\\boldsymbol{\\alpha} \\in \\mathbb{N}_{0}^{d} : |\\boldsymbol{\\alpha}| \\le p\\}$，其中 $|\\boldsymbol{\\alpha}| := \\sum_{i=1}^{d} \\alpha_{i}$。模态 $\\boldsymbol{\\alpha} \\in \\Lambda_{p}$ 的系数由正交投影定义：$c_{\\boldsymbol{\\alpha}} := \\int_{\\mathbb{R}^{d}} u(\\boldsymbol{\\xi}) \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}) \\rho(\\boldsymbol{\\xi}) \\,\\mathrm{d}\\boldsymbol{\\xi}$。\n\n在非侵入式随机配置法中，使用求积法则 $\\{(\\boldsymbol{\\xi}^{(q)}, w^{(q)})\\}_{q=1}^{Q}$ 来估计 $c_{\\boldsymbol{\\alpha}}$，该法则对所有总阶数不超过整数 $r \\ge 0$ 的多元多项式都是精确的。也就是说，对于任何总阶数 $\\le r$ 的多项式 $p(\\boldsymbol{\\xi})$，\n$\\int_{\\mathbb{R}^{d}} p(\\boldsymbol{\\xi}) \\rho(\\boldsymbol{\\xi}) \\,\\mathrm{d}\\boldsymbol{\\xi} = \\sum_{q=1}^{Q} w^{(q)} p(\\boldsymbol{\\xi}^{(q)})$。\n非侵入式估计量为 $\\widehat{c}_{\\boldsymbol{\\alpha}} := \\sum_{q=1}^{Q} w^{(q)} u(\\boldsymbol{\\xi}^{(q)}) \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}^{(q)})$。\n\n从正交性和投影的定义出发，解释当求积精度参数 $r$ 不足时，$\\widehat{c}_{\\boldsymbol{\\alpha}}$ 中出现混叠的机制。然后，通过要求离散内积模拟所有乘积 $\\Psi_{\\boldsymbol{\\alpha}} \\Psi_{\\boldsymbol{\\beta}}$（其中 $|\\boldsymbol{\\alpha}| \\le p$ 和 $|\\boldsymbol{\\beta}| \\le p$）的连续正交性，推导出保证在对所有系数 $c_{\\boldsymbol{\\alpha}}$（其中 $|\\boldsymbol{\\alpha}| \\le p$）进行非侵入式估计时没有混叠的最小总多项式阶数 $r$（表示为 $p$ 的函数）。\n\n将你的最终答案表示为关于 $p$ 的单个闭式表达式。无需单位。", "solution": "该问题要求解释在非侵入式多项式混沌展开（PCE）系数估计中混叠的机制，并推导在特定条件下防止混叠的最小求积精度。\n\n首先，我们分析混叠误差的来源。模态 $\\boldsymbol{\\alpha}$ 的精确系数 $c_{\\boldsymbol{\\alpha}}$ 是由关注量（QoI）$u(\\boldsymbol{\\xi})$ 在基多项式 $\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})$ 上的正交投影给出的。此投影由关于概率测度 $\\rho(\\boldsymbol{\\xi})\\mathrm{d}\\boldsymbol{\\xi}$ 的内积定义：\n$$c_{\\boldsymbol{\\alpha}} := \\langle u, \\Psi_{\\boldsymbol{\\alpha}} \\rangle = \\int_{\\mathbb{R}^{d}} u(\\boldsymbol{\\xi}) \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}) \\rho(\\boldsymbol{\\xi}) \\,\\mathrm{d}\\boldsymbol{\\xi}$$\n非侵入式估计量 $\\widehat{c}_{\\boldsymbol{\\alpha}}$ 用基于求积法则 $\\{(\\boldsymbol{\\xi}^{(q)}, w^{(q)})\\}_{q=1}^{Q}$ 的离散和来代替这个连续积分：\n$$\\widehat{c}_{\\boldsymbol{\\alpha}} := \\sum_{q=1}^{Q} w^{(q)} u(\\boldsymbol{\\xi}^{(q)}) \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}^{(q)})$$\n这个估计量可以看作是一个离散内积，我们将其表示为 $\\langle f, g \\rangle_Q := \\sum_{q=1}^{Q} w^{(q)} f(\\boldsymbol{\\xi}^{(q)}) g(\\boldsymbol{\\xi}^{(q)})$。因此，$\\widehat{c}_{\\boldsymbol{\\alpha}} = \\langle u, \\Psi_{\\boldsymbol{\\alpha}} \\rangle_Q$。\n\n为了理解误差，我们将关注量 QoI 的完整 PCE 表示 $u(\\boldsymbol{\\xi}) = \\sum_{\\boldsymbol{\\beta} \\in \\mathbb{N}_{0}^{d}} c_{\\boldsymbol{\\beta}} \\Psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi})$ 代入 $\\widehat{c}_{\\boldsymbol{\\alpha}}$ 的表达式中：\n$$\\widehat{c}_{\\boldsymbol{\\alpha}} = \\sum_{q=1}^{Q} w^{(q)} \\left( \\sum_{\\boldsymbol{\\beta} \\in \\mathbb{N}_{0}^{d}} c_{\\boldsymbol{\\beta}} \\Psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi}^{(q)}) \\right) \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}^{(q)})$$\n通过交换求和顺序（这是允许的），我们得到：\n$$\\widehat{c}_{\\boldsymbol{\\alpha}} = \\sum_{\\boldsymbol{\\beta} \\in \\mathbb{N}_{0}^{d}} c_{\\boldsymbol{\\beta}} \\left( \\sum_{q=1}^{Q} w^{(q)} \\Psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi}^{(q)}) \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}^{(q)}) \\right) = \\sum_{\\boldsymbol{\\beta} \\in \\mathbb{N}_{0}^{d}} c_{\\boldsymbol{\\beta}} \\langle \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle_Q$$\n作为比较，精确系数 $c_{\\boldsymbol{\\alpha}}$ 是使用基的*连续*正交性 $\\langle \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle = \\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$ 从完整展开中恢复的：\n$$c_{\\boldsymbol{\\alpha}} = \\langle u, \\Psi_{\\boldsymbol{\\alpha}} \\rangle = \\left\\langle \\sum_{\\boldsymbol{\\beta} \\in \\mathbb{N}_{0}^{d}} c_{\\boldsymbol{\\beta}} \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\right\\rangle = \\sum_{\\boldsymbol{\\beta} \\in \\mathbb{N}_{0}^{d}} c_{\\boldsymbol{\\beta}} \\langle \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle = \\sum_{\\boldsymbol{\\beta} \\in \\mathbb{N}_{0}^{d}} c_{\\boldsymbol{\\beta}} \\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}} = c_{\\boldsymbol{\\alpha}}$$\n$\\widehat{c}_{\\boldsymbol{\\alpha}}$ 与 $c_{\\boldsymbol{\\alpha}}$ 之间的差异出现在离散内积 $\\langle \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle_Q$ 不等于连续内积 $\\langle \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle = \\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$ 时。求积法则对于任何总阶数最高为 $r$ 的多项式被积函数都是精确的。内积 $\\langle \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle$ 的被积函数是乘积 $\\Psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi})\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})$。由于 $\\Psi_{\\boldsymbol{\\gamma}}$ 是一个总阶为 $|\\boldsymbol{\\gamma}|$ 的多项式，这个乘积的阶数是 $|\\boldsymbol{\\alpha}| + |\\boldsymbol{\\beta}|$。\n如果 $|\\boldsymbol{\\alpha}| + |\\boldsymbol{\\beta}| > r$，求积法则可能不精确，因此 $\\langle \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle_Q$ 可能不等于 $\\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$。在这种情况下，估计系数的表达式变为：\n$$\\widehat{c}_{\\boldsymbol{\\alpha}} = c_{\\boldsymbol{\\alpha}} \\langle \\Psi_{\\boldsymbol{\\alpha}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle_Q + \\sum_{\\boldsymbol{\\beta} \\neq \\boldsymbol{\\alpha}} c_{\\boldsymbol{\\beta}} \\langle \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle_Q$$\n即使 $|\\boldsymbol{\\alpha}|+|\\boldsymbol{\\alpha}| \\le r$（确保 $\\langle \\Psi_{\\boldsymbol{\\alpha}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle_Q = 1$），如果当 $\\boldsymbol{\\beta} \\neq \\boldsymbol{\\alpha}$ 时 $\\langle \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle_Q$ 的值不为零，这意味着系数 $c_{\\boldsymbol{\\beta}}$ 会错误地贡献给 $c_{\\boldsymbol{\\alpha}}$ 的估计。这种现象被称为混叠：由于离散采样的不足，更高阶或不同阶的模态会“折叠”并污染目标模态的估计。\n\n接下来，我们推导在指定条件下防止混叠所需的最小求积精度 $r$。问题将系数 $\\{c_{\\boldsymbol{\\alpha}}\\}_{|\\boldsymbol{\\alpha}| \\le p}$ 的“无混叠”定义为严格要求离散内积对阶数为 $p$ 的截断展开中的所有基函数模拟连续正交性。也就是说，我们必须强制：\n$$\\langle \\Psi_{\\boldsymbol{\\alpha}}, \\Psi_{\\boldsymbol{\\beta}} \\rangle_Q = \\langle \\Psi_{\\boldsymbol{\\alpha}}, \\Psi_{\\boldsymbol{\\beta}} \\rangle = \\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$$\n对于集合 $\\Lambda_p = \\{\\boldsymbol{\\gamma} \\in \\mathbb{N}_0^d : |\\boldsymbol{\\gamma}| \\le p\\}$ 中的所有多重指标 $\\boldsymbol{\\alpha}$ 和 $\\boldsymbol{\\beta}$。\n为使求积法则能精确计算定义连续内积的积分，被积多项式的总阶数不得超过求积的精度阶数 $r$。被积函数是 $\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}) \\Psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi})$。这个多项式的总阶数是：\n$$\\text{deg}(\\Psi_{\\boldsymbol{\\alpha}}\\Psi_{\\boldsymbol{\\beta}}) = \\text{deg}(\\Psi_{\\boldsymbol{\\alpha}}) + \\text{deg}(\\Psi_{\\boldsymbol{\\beta}}) = |\\boldsymbol{\\alpha}| + |\\boldsymbol{\\beta}|$$\n为了对所有指定的对 $(\\boldsymbol{\\alpha}, \\boldsymbol{\\beta})$ 满足无混叠条件，求积阶数 $r$ 必须大于或等于这些被积函数乘积的最大可能阶数。因此，我们必须在多重指标的允许范围内找到 $|\\boldsymbol{\\alpha}| + |\\boldsymbol{\\beta}|$ 的最大值：\n$$\\max \\{|\\boldsymbol{\\alpha}| + |\\boldsymbol{\\beta}| \\;\\; | \\;\\; |\\boldsymbol{\\alpha}| \\le p \\text{ and } |\\boldsymbol{\\beta}| \\le p \\}$$\n当 $|\\boldsymbol{\\alpha}|$ 和 $|\\boldsymbol{\\beta}|$ 分别取最大值时，该最大值得以实现。集合 $\\Lambda_p$ 中 $|\\boldsymbol{\\alpha}|$ 的最大值是 $p$，同样地， $|\\boldsymbol{\\beta}|$ 的最大值也是 $p$。\n因此，阶数之和的最大值为：\n$$\\max (|\\boldsymbol{\\alpha}| + |\\boldsymbol{\\beta}|) = p + p = 2p$$\n为保证求积对于所有乘积 $\\Psi_{\\boldsymbol{\\alpha}} \\Psi_{\\boldsymbol{\\beta}}$（其中 $|\\boldsymbol{\\alpha}| \\le p$ 和 $|\\boldsymbol{\\beta}| \\le p$）都是精确的，我们必须要求精度阶数 $r$ 满足 $r \\ge 2p$。\n满足此条件的最小整数值 $r$ 是 $2p$。选择此 $r$ 值可确保对于阶数-$p$ 展开中的任意两个基函数，它们的离散内积能正确地计算为克罗内克（Kronecker）$\\delta$，从而防止来自*同一阶数-$p$ 展开内*其他模态的混叠。值得注意的是，这并不能防止来自 $|\\boldsymbol{\\beta}| > p$ 的模态的混叠，因为这些模态可能产生阶数高于 $2p$ 的乘积 $\\Psi_{\\boldsymbol{\\alpha}}\\Psi_{\\boldsymbol{\\beta}}$。然而，根据问题的明确要求，这是最小值。", "answer": "$$\\boxed{2p}$$", "id": "2589464"}]}