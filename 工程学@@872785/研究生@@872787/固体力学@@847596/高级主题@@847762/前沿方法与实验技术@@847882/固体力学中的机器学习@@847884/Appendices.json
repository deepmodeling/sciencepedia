{"hands_on_practices": [{"introduction": "在将机器学习应用于固体力学时，一个基本要求是确保本构模型满足材料客观性原理。这意味着模型的预测不应随刚体转动而改变。实现这一目标的关键是使用变形张量的不变量作为神经网络的输入特征。这个练习将引导你计算一个基本变形情况下的这些不变量，从而将连续介质力学的理论与机器学习模型的实际构建联系起来。[@problem_id:2656035]", "problem": "一个用于超弹性本构模型的不变神经网络，其输入为右Cauchy–Green变形张量的主不变量。考虑简单剪切变形，其变形梯度由二阶张量$\\boldsymbol{F}$给出，\n$$\n\\boldsymbol{F}=\\begin{bmatrix}1 & \\gamma & 0\\\\ 0 & 1 & 0\\\\ 0 & 0 & 1\\end{bmatrix},\n$$\n其中$\\gamma$是工程剪切应变（无量纲）。从右Cauchy–Green变形张量$\\boldsymbol{C}$的定义和$\\boldsymbol{C}$的主不变量出发，推导三个主不变量$I_{1}$，$I_{2}$和$I_{3}$关于$\\gamma$的闭式表达式，这些表达式将作为旋转客观输入用于不变神经网络。将最终答案表示为行向量$[I_{1}, I_{2}, I_{3}]$。不要近似；请提供精确的解析表达式。无需单位。", "solution": "所提出的问题经过严格审查，被认为是有效的。它以连续介质力学原理为科学基础，是适定的，并包含获得唯一解所需的所有信息。我们将继续进行推导。\n\n目标是求出简单剪切变形下右Cauchy–Green变形张量$\\boldsymbol{C}$的三个主不变量$I_{1}$，$I_{2}$和$I_{3}$。这些不变量可作为本构模型（如问题陈述中提到的不变神经网络）的客观输入。\n\n变形梯度张量$\\boldsymbol{F}$由下式给出：\n$$\n\\boldsymbol{F} = \\begin{bmatrix} 1 & \\gamma & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}\n$$\n其中$\\gamma$是剪切量。\n\n右Cauchy–Green变形张量$\\boldsymbol{C}$定义为变形梯度$\\boldsymbol{F}$的转置$\\boldsymbol{F}^T$与变形梯度$\\boldsymbol{F}$的乘积：\n$$\n\\boldsymbol{C} = \\boldsymbol{F}^T \\boldsymbol{F}\n$$\n首先，我们求$\\boldsymbol{F}$的转置：\n$$\n\\boldsymbol{F}^T = \\begin{bmatrix} 1 & 0 & 0 \\\\ \\gamma & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}\n$$\n现在，我们进行矩阵乘法来求$\\boldsymbol{C}$：\n$$\n\\boldsymbol{C} = \\begin{bmatrix} 1 & 0 & 0 \\\\ \\gamma & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} \\begin{bmatrix} 1 & \\gamma & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}\n$$\n$$\n\\boldsymbol{C} = \\begin{bmatrix} (1)(1)+(0)(0)+(0)(0) & (1)(\\gamma)+(0)(1)+(0)(0) & (1)(0)+(0)(0)+(0)(1) \\\\ (\\gamma)(1)+(1)(0)+(0)(0) & (\\gamma)(\\gamma)+(1)(1)+(0)(0) & (\\gamma)(0)+(1)(0)+(0)(1) \\\\ (0)(1)+(0)(0)+(1)(0) & (0)(\\gamma)+(0)(1)+(1)(0) & (0)(0)+(0)(0)+(1)(1) \\end{bmatrix}\n$$\n该计算得出$\\boldsymbol{C}$的分量：\n$$\n\\boldsymbol{C} = \\begin{bmatrix} 1 & \\gamma & 0 \\\\ \\gamma & 1+\\gamma^2 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}\n$$\n三维空间中二阶张量$\\boldsymbol{C}$的主不变量是从其分量导出的标准标量。它们的定义如下：\n$I_1 = \\text{tr}(\\boldsymbol{C})$\n$I_2 = \\frac{1}{2} [(\\text{tr}(\\boldsymbol{C}))^2 - \\text{tr}(\\boldsymbol{C}^2)]$\n$I_3 = \\det(\\boldsymbol{C})$\n\n我们现在将使用导出的张量$\\boldsymbol{C}$计算每个不变量。\n\n第一个不变量$I_1$是$\\boldsymbol{C}$的迹，即其对角元素之和：\n$$\nI_1 = C_{11} + C_{22} + C_{33} = 1 + (1+\\gamma^2) + 1\n$$\n$$\nI_1 = 3 + \\gamma^2\n$$\n第三个不变量$I_3$是$\\boldsymbol{C}$的行列式。对于物理变形，$\\boldsymbol{F}$的行列式必须为正。我们知道$\\det(\\boldsymbol{C}) = \\det(\\boldsymbol{F}^T \\boldsymbol{F}) = \\det(\\boldsymbol{F}^T)\\det(\\boldsymbol{F}) = (\\det(\\boldsymbol{F}))^2 = J^2$，其中$J$是变形的雅可比行列式。对于给定的$\\boldsymbol{F}$，它是一个上三角矩阵，其行列式是对角元素的乘积：\n$$\nJ = \\det(\\boldsymbol{F}) = (1)(1)(1) = 1\n$$\n因此，第三个不变量是：\n$$\nI_3 = J^2 = 1^2 = 1\n$$\n这个结果表明了简单剪切变形的等容（体积保持）性质，因为$J=1$。\n\n第二个不变量$I_2$可以使用涉及$\\boldsymbol{C}$的迹及其平方的迹的公式计算，但更直接的方法是将其计算为$\\boldsymbol{C}$的主子式之和：\n$$\nI_2 = \\begin{vmatrix} C_{22} & C_{23} \\\\ C_{32} & C_{33} \\end{vmatrix} + \\begin{vmatrix} C_{11} & C_{13} \\\\ C_{31} & C_{33} \\end{vmatrix} + \\begin{vmatrix} C_{11} & C_{12} \\\\ C_{21} & C_{22} \\end{vmatrix}\n$$\n代入$\\boldsymbol{C}$的分量：\n$$\nI_2 = \\begin{vmatrix} 1+\\gamma^2 & 0 \\\\ 0 & 1 \\end{vmatrix} + \\begin{vmatrix} 1 & 0 \\\\ 0 & 1 \\end{vmatrix} + \\begin{vmatrix} 1 & \\gamma \\\\ \\gamma & 1+\\gamma^2 \\end{vmatrix}\n$$\n计算每个行列式：\n$$\nI_2 = ((1+\\gamma^2)(1) - (0)(0)) + ((1)(1) - (0)(0)) + ((1)(1+\\gamma^2) - (\\gamma)(\\gamma))\n$$\n$$\nI_2 = (1+\\gamma^2) + 1 + (1+\\gamma^2 - \\gamma^2)\n$$\n$$\nI_2 = 1 + \\gamma^2 + 1 + 1 = 3 + \\gamma^2\n$$\n因此，对于简单剪切，我们发现第一和第二不变量是相同的。\n\n简单剪切下右Cauchy–Green张量的三个主不变量是：\n$$\nI_1 = 3 + \\gamma^2\n$$\n$$\nI_2 = 3 + \\gamma^2\n$$\n$$\nI_3 = 1\n$$\n问题要求将最终答案表示为$\\begin{pmatrix} I_1 & I_2 & I_3 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3 + \\gamma^2 & 3 + \\gamma^2 & 1\n\\end{pmatrix}\n}\n$$", "id": "2656035"}, {"introduction": "一个物理启发的机器学习模型的训练过程，本质上是在多个目标之间寻求平衡。我们既希望模型能精确地遵循物理定律（如平衡方程），又要防止模型变得过于复杂而导致过拟合。这个练习提供了一个具体的编码实践，让你亲手体验物理损失和正则化项权重之间的权衡。通过调整超参数，你将直观地看到过度正则化是如何损害模型捕捉物理现象的能力的，这是模型训练中的一个核心挑战。[@problem_id:2656054]", "problem": "您将研究无量纲化设置下的一维弹性静力学平衡，并量化$L^2$权重衰减惩罚与物理残差惩罚之间的平衡如何影响参数化模型满足平衡的能力。考虑域$[0,1]$，杨氏模量为常数$E=1$，均布体力为$b=1$。平衡的强形式为$E\\,u''(x)+b=0$，其中$x\\in(0,1)$，狄利克雷边界条件为$u(0)=0$和$u(1)=0$。您将使用一个能精确满足边界条件的参数化试函数来近似位移场：$u(x;\\boldsymbol{\\theta})=x(1-x)\\,p(x;\\boldsymbol{\\theta})$，其中$p(x;\\boldsymbol{\\theta})=\\sum_{k=0}^{d}\\theta_k x^k$是一个次数为$d$的多项式，其参数为$\\boldsymbol{\\theta}\\in\\mathbb{R}^{d+1}$。在点$x$处的物理残差为$r(x;\\boldsymbol{\\theta})=E\\,u''(x;\\boldsymbol{\\theta})+b$。物理损失是在一组$N_c$个内部配置点$\\{x_i\\}_{i=1}^{N_c}$上的均方残差，即$L_{\\mathrm{phys}}(\\boldsymbol{\\theta})=\\frac{1}{N_c}\\sum_{i=1}^{N_c} r(x_i;\\boldsymbol{\\theta})^2$。权重衰减惩罚为$L_{\\mathrm{wd}}(\\boldsymbol{\\theta})=\\|\\boldsymbol{\\theta}\\|_2^2$。总损失为$L_{\\mathrm{tot}}(\\boldsymbol{\\theta})=\\lambda_{\\mathrm{phys}}\\,L_{\\mathrm{phys}}(\\boldsymbol{\\theta})+\\lambda_{\\mathrm{wd}}\\,L_{\\mathrm{wd}}(\\boldsymbol{\\theta})$，其中$\\lambda_{\\mathrm{phys}}>0$和$\\lambda_{\\mathrm{wd}}\\ge 0$是用户指定的超参数。您的程序必须：(a) 将配置点集构造为$N_c$个等距内点$x_i=\\frac{i}{N_c+1}$，其中$i\\in\\{1,\\dots,N_c\\}$，(b) 通过对每一对$(\\lambda_{\\mathrm{phys}},\\lambda_{\\mathrm{wd}})$最小化$L_{\\mathrm{tot}}(\\boldsymbol{\\theta})$来训练参数化模型（优化$\\boldsymbol{\\theta}$），以及 (c) 在一个包含$N_{\\mathrm{eval}}$个内点$\\{\\hat{x}_j\\}_{j=1}^{N_{\\mathrm{eval}}}$（其中$\\hat{x}_j=\\frac{j}{N_{\\mathrm{eval}}+1}$）的评估网格上，通过均方根残差$R=\\sqrt{\\frac{1}{N_{\\mathrm{eval}}}\\sum_{j=1}^{N_{\\mathrm{eval}}} r(\\hat{x}_j;\\boldsymbol{\\theta})^2}$来评估平衡满足情况。定义一个基线，其$\\lambda_{\\mathrm{phys}}=1.0$和$\\lambda_{\\mathrm{wd}}=10^{-12}$，这接近于纯物理最小化，并计算其基线均方根残差$R_0$。如果$R/R_0>10$，则声明过度正则化损害了平衡。使用以下固定值：多项式次数$d=6$，配置点数$N_c=200$，评估点数$N_{\\mathrm{eval}}=400$。所有量都是无量纲的，因此不需要物理单位；报告无量纲数。您的测试套件包含以下六种情况，每种情况都是一个有序对$(\\lambda_{\\mathrm{phys}},\\lambda_{\\mathrm{wd}})$：\n- 情况1：$(1.0,10^{-12})$。\n- 情况2：$(1.0,10^{-2})$。\n- 情况3：$(1.0,10^{2})$。\n- 情况4：$(10^{-6},10^{-2})$。\n- 情况5：$(10^{6},10^{-2})$。\n- 情况6：$(1.0,10^{-8})$。\n您的程序应生成单行输出，其中包含一个以方括号括起来的逗号分隔列表形式的结果，每个案例对应一个布尔值，顺序与上述相同，其中每个布尔值为true当且仅当该案例的$R/R_0>10$。例如，您的程序必须打印一行形式为“[true_or_false_case_1,true_or_false_case_2,...,true_or_false_case_6]”的内容。答案必须使用确定性数值线性代数计算；不允许随机化。最终输出必须严格匹配此单行格式。", "solution": "所给出的问题是计算力学中一个有效的、适定的练习，它探索了计算力学与机器学习原理的交叉点。它要求通过最小化一个复合损失函数来求解一维弹性静力学边值问题的近似解。该任务的核心是分析满足基础物理定律与惩罚模型复杂性之间的权衡，这是正则化回归和科学机器学习中的一个共同主题。所有给定的参数和条件都是科学合理的、一致的，并且足以推导出唯一的数值解。\n\n位移场$u(x)$的控制方程是弹性静力学平衡的强形式：\n$$E u''(x) + b = 0, \\quad x \\in (0, 1)$$\n其狄利克雷边界条件为$u(0)=0$和$u(1)=0$。常数为杨氏模量$E=1$和均布体力$b=1$。\n\n位移场由一个旨在精确满足边界条件的参数化试函数$u(x; \\boldsymbol{\\theta})$来近似：\n$$u(x; \\boldsymbol{\\theta}) = x(1-x) p(x; \\boldsymbol{\\theta})$$\n其中$p(x; \\boldsymbol{\\theta})$是一个次数为$d=6$的多项式，其参数为$\\boldsymbol{\\theta} = [\\theta_0, \\theta_1, \\dots, \\theta_d]^T \\in \\mathbb{R}^{d+1}$：\n$$p(x; \\boldsymbol{\\theta}) = \\sum_{k=0}^{d} \\theta_k x^k$$\n为构建优化问题，我们首先推导物理残差$r(x; \\boldsymbol{\\theta})$。这需要$u(x; \\boldsymbol{\\theta})$的二阶导数：\n$$u(x; \\boldsymbol{\\theta}) = \\sum_{k=0}^{d} \\theta_k (x^{k+1} - x^{k+2})$$\n$$u'(x; \\boldsymbol{\\theta}) = \\sum_{k=0}^{d} \\theta_k ((k+1)x^k - (k+2)x^{k+1})$$\n$$u''(x; \\boldsymbol{\\theta}) = \\sum_{k=0}^{d} \\theta_k ((k+1)kx^{k-1} - (k+2)(k+1)x^k)$$\n物理残差定义为$r(x; \\boldsymbol{\\theta}) = E u''(x; \\boldsymbol{\\theta}) + b$。当$E=1$且$b=1$时，它变为：\n$$r(x; \\boldsymbol{\\theta}) = \\left( \\sum_{k=0}^{d} \\theta_k ((k+1)kx^{k-1} - (k+2)(k+1)x^k) \\right) + 1$$\n此表达式是关于参数$\\boldsymbol{\\theta}$的线性表达式。我们可以将其写为$r(x; \\boldsymbol{\\theta}) = \\mathbf{v}(x)^T \\boldsymbol{\\theta} + 1$，其中向量$\\mathbf{v}(x)$的第$k$个分量是$\\theta_k$的系数，即$v_k(x) = (k+1)kx^{k-1} - (k+2)(k+1)x^k$。\n\n要最小化的总损失函数是物理损失和权重衰减惩罚的加权和：\n$$L_{\\mathrm{tot}}(\\boldsymbol{\\theta}) = \\lambda_{\\mathrm{phys}} L_{\\mathrm{phys}}(\\boldsymbol{\\theta}) + \\lambda_{\\mathrm{wd}} L_{\\mathrm{wd}}(\\boldsymbol{\\theta})$$\n物理损失$L_{\\mathrm{phys}}(\\boldsymbol{\\theta})$是在$N_c=200$个配置点$\\{x_i\\}_{i=1}^{N_c}$上的均方残差：\n$$L_{\\mathrm{phys}}(\\boldsymbol{\\theta}) = \\frac{1}{N_c} \\sum_{i=1}^{N_c} r(x_i; \\boldsymbol{\\theta})^2$$\n我们定义一个矩阵$A \\in \\mathbb{R}^{N_c \\times (d+1)}$，使得$A_{ik} = v_k(x_i)$。在配置点处的残差向量可以写为$A\\boldsymbol{\\theta} + \\mathbf{1}_{N_c}$，其中$\\mathbf{1}_{N_c}$是长度为$N_c$的全1向量。于是物理损失为：\n$$L_{\\mathrm{phys}}(\\boldsymbol{\\theta}) = \\frac{1}{N_c} \\| A\\boldsymbol{\\theta} + \\mathbf{1}_{N_c} \\|_2^2$$\n权重衰减惩罚是参数向量的$L^2$范数的平方：\n$$L_{\\mathrm{wd}}(\\boldsymbol{\\theta}) = \\|\\boldsymbol{\\theta}\\|_2^2 = \\boldsymbol{\\theta}^T \\boldsymbol{\\theta}$$\n综合这些，总损失函数为：\n$$L_{\\mathrm{tot}}(\\boldsymbol{\\theta}) = \\frac{\\lambda_{\\mathrm{phys}}}{N_c} \\| A\\boldsymbol{\\theta} + \\mathbf{1}_{N_c} \\|_2^2 + \\lambda_{\\mathrm{wd}} \\|\\boldsymbol{\\theta}\\|_2^2$$\n这是$\\boldsymbol{\\theta}$的二次函数。为了找到最小化此损失的最优参数$\\boldsymbol{\\theta}^*$，我们计算$L_{\\mathrm{tot}}(\\boldsymbol{\\theta})$关于$\\boldsymbol{\\theta}$的梯度并令其为零：\n$$\\nabla_{\\boldsymbol{\\theta}} L_{\\mathrm{tot}}(\\boldsymbol{\\theta}) = \\frac{\\lambda_{\\mathrm{phys}}}{N_c} \\nabla_{\\boldsymbol{\\theta}} \\left( (A\\boldsymbol{\\theta} + \\mathbf{1}_{N_c})^T (A\\boldsymbol{\\theta} + \\mathbf{1}_{N_c}) \\right) + \\lambda_{\\mathrm{wd}} \\nabla_{\\boldsymbol{\\theta}} (\\boldsymbol{\\theta}^T \\boldsymbol{\\theta}) = \\mathbf{0}$$\n$$\\nabla_{\\boldsymbol{\\theta}} L_{\\mathrm{tot}}(\\boldsymbol{\\theta}) = \\frac{\\lambda_{\\mathrm{phys}}}{N_c} (2A^T A \\boldsymbol{\\theta} + 2A^T \\mathbf{1}_{N_c}) + 2\\lambda_{\\mathrm{wd}} \\boldsymbol{\\theta} = \\mathbf{0}$$\n整理各项可得一个标准的线性方程组，也称为此正则化最小二乘问题的正规方程组：\n$$\\left( \\frac{\\lambda_{\\mathrm{phys}}}{N_c} A^T A + \\lambda_{\\mathrm{wd}} I \\right) \\boldsymbol{\\theta} = -\\frac{\\lambda_{\\mathrm{phys}}}{N_c} A^T \\mathbf{1}_{N_c}$$\n其中$I$是$(d+1) \\times (d+1)$的单位矩阵。该系统形为$M\\boldsymbol{\\theta} = \\mathbf{y}$，其中：\n$$M = \\frac{\\lambda_{\\mathrm{phys}}}{N_c} A^T A + \\lambda_{\\mathrm{wd}} I$$\n$$\\mathbf{y} = -\\frac{\\lambda_{\\mathrm{phys}}}{N_c} A^T \\mathbf{1}_{N_c}$$\n对于每组给定的超参数$(\\lambda_{\\mathrm{phys}}, \\lambda_{\\mathrm{wd}})$，我们求解这个$(d+1) \\times (d+1)$的线性系统以获得$\\boldsymbol{\\theta}$。由于$\\lambda_{\\mathrm{phys}} > 0$和$\\lambda_{\\mathrm{wd}} \\ge 0$（在给定的测试案例中严格为正），并且$A^T A$是半正定的，因此矩阵$M$保证是正定的，从而可逆，确保了唯一解的存在。\n\n一旦找到最优参数向量$\\boldsymbol{\\theta}^*$，我们就在一个独立的、更精细的包含$N_{\\mathrm{eval}}=400$个评估点$\\{\\hat{x}_j\\}_{j=1}^{N_{\\mathrm{eval}}}$的网格上，使用均方根(RMS)残差$R$来评估平衡方程的满足程度。\n每个评估点上的残差为$r(\\hat{x}_j; \\boldsymbol{\\theta}^*) = u''(\\hat{x}_j; \\boldsymbol{\\theta}^*) + 1$。这可以通过构建一个大小为$N_{\\mathrm{eval}} \\times (d+1)$的评估矩阵$A_{\\mathrm{eval}}$来高效计算，其中$(A_{\\mathrm{eval}})_{jk} = v_k(\\hat{x}_j)$。评估网格上的残差向量为$\\mathbf{r}_{\\mathrm{eval}} = A_{\\mathrm{eval}}\\boldsymbol{\\theta}^* + \\mathbf{1}_{N_{\\mathrm{eval}}}$。\nRMS残差$R$则为：\n$$R = \\sqrt{\\frac{1}{N_{\\mathrm{eval}}} \\sum_{j=1}^{N_{\\mathrm{eval}}} r(\\hat{x}_j; \\boldsymbol{\\theta}^*)^2} = \\sqrt{\\frac{1}{N_{\\mathrm{eval}}} \\|\\mathbf{r}_{\\mathrm{eval}}\\|_2^2}$$\n对所有测试案例重复此过程。第一个案例$(\\lambda_{\\mathrm{phys}}, \\lambda_{\\mathrm{wd}}) = (1.0, 10^{-12})$作为基线，产生$R_0$。对于随后的每个案例，我们计算比率$R/R_0$并判断其是否超过阈值$10$，这表示过度正则化已显著损害了模型满足物理平衡的能力。\n\n计算算法如下：\n1.  设置固定参数：$d=6$，$N_c=200$，$N_{\\mathrm{eval}}=400$。\n2.  定义$(\\lambda_{\\mathrm{phys}}, \\lambda_{\\mathrm{wd}})$的测试案例集。\n3.  生成配置点$x_i = \\frac{i}{N_c+1}$，其中$i=1, \\dots, N_c$。\n4.  基于配置点构建矩阵$A$。\n5.  生成评估点$\\hat{x}_j = \\frac{j}{N_{\\mathrm{eval}}+1}$，其中$j=1, \\dots, N_{\\mathrm{eval}}$。\n6.  基于评估点构建评估矩阵$A_{\\mathrm{eval}}$。\n7.  初始化一个空列表以存储计算出的$R$值。\n8.  对于每个测试案例$(\\lambda_{\\mathrm{phys}}, \\lambda_{\\mathrm{wd}})$：\n    a. 构造系统矩阵$M$和右端向量$\\mathbf{y}$。\n    b. 求解线性系统$M\\boldsymbol{\\theta}^* = \\mathbf{y}$以得到$\\boldsymbol{\\theta}^*$。\n    c. 计算评估网格上的残差向量$\\mathbf{r}_{\\mathrm{eval}} = A_{\\mathrm{eval}}\\boldsymbol{\\theta}^* + \\mathbf{1}_{N_{\\mathrm{eval}}}$。\n    d. 计算RMS残差$R$并将其附加到列表中。\n9.  从第一个测试案例中确定基线残差$R_0$。\n10. 对于每个存储的$R$，评估布尔条件$R/R_0 > 10$。\n11. 将布尔值列表格式化为所需的输出字符串。\n这个基于数值线性代数的确定性过程为问题提供了一个完整而严谨的解决方案。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D elastostatic problem using a parametric polynomial model\n    and evaluates the effect of regularization on equilibrium satisfaction.\n    \"\"\"\n    # Fixed values from the problem statement\n    d = 6\n    Nc = 200\n    N_eval = 400\n    \n    # Test cases for (lambda_phys, lambda_wd)\n    test_cases = [\n        (1.0, 10**-12),\n        (1.0, 10**-2),\n        (1.0, 10**2),\n        (10**-6, 10**-2),\n        (10**6, 10**-2),\n        (1.0, 10**-8),\n    ]\n\n    def construct_A_matrix(x_points, degree):\n        \"\"\"\n        Constructs the matrix A where A_ik is the coefficient of theta_k in u''(x_i).\n        A_ik = v_k(x_i) = (k+1)k*x_i^(k-1) - (k+2)(k+1)*x_i^k\n        \"\"\"\n        n_pts = len(x_points)\n        A = np.zeros((n_pts, degree + 1))\n        \n        #\n        # The term for u'' corresponding to theta_k is the second derivative of\n        # x^(k+1) - x^(k+2), which is (k+1)*k*x^(k-1) - (k+2)*(k+1)*x^k.\n        \n        # Handle k=0 separately to avoid issues with x**(-1)\n        # For k=0: (1)*0*x^(-1) - (2)*(1)*x^0 = -2\n        A[:, 0] = -2.0\n        \n        # For k >= 1\n        for k in range(1, degree + 1):\n            term1 = k * (k + 1) * np.power(x_points, k - 1)\n            term2 = (k + 1) * (k + 2) * np.power(x_points, k)\n            A[:, k] = term1 - term2\n            \n        return A\n\n    # (a) Construct the collocation and evaluation grids\n    x_c = np.linspace(0, 1, Nc + 2)[1:-1]\n    x_eval = np.linspace(0, 1, N_eval + 2)[1:-1]\n    \n    A_c = construct_A_matrix(x_c, d)\n    A_eval = construct_A_matrix(x_eval, d)\n    \n    rms_residuals = []\n\n    # (b) Train the model for each hyperparameter pair\n    for lambda_phys, lambda_wd in test_cases:\n        # Set up the linear system M * theta = y\n        # M = (lambda_phys/Nc) * A_c.T @ A_c + lambda_wd * I\n        # y = -(lambda_phys/Nc) * A_c.T @ 1\n        \n        A_c_T_A_c = A_c.T @ A_c\n        I = np.identity(d + 1)\n        \n        M = (lambda_phys / Nc) * A_c_T_A_c + lambda_wd * I\n        \n        y = -(lambda_phys / Nc) * (A_c.T @ np.ones(Nc))\n        \n        # Solve for the optimal parameters theta\n        theta = np.linalg.solve(M, y)\n        \n        # (c) Evaluate equilibrium satisfaction on the evaluation grid\n        # Residual vector r = A_eval * theta + 1\n        r_eval = A_eval @ theta + np.ones(N_eval)\n        \n        # Root-mean-square residual R\n        R = np.sqrt(np.mean(r_eval**2))\n        rms_residuals.append(R)\n\n    # Define baseline and check for over-regularization\n    R0 = rms_residuals[0]\n    \n    results = [r / R0 > 10 for r in rms_residuals]\n\n    # Format the final output string\n    # E.g., \"[true,false,true]\"\n    output_str = f\"[{','.join(str(b).lower() for b in results)}]\"\n    \n    print(output_str)\n\nsolve()\n```", "id": "2656054"}, {"introduction": "成功训练模型后，我们必须严格评估其预测的可靠性，尤其是在安全攸关的工程应用中。当模型被要求在其训练数据范围之外进行预测（即外插）时，它可能会产生不符合物理规律的结果。这个练习要求你设计一套准则，用于判断模型是否在进行外插，并检验其预测是否满足材料稳定性要求，这是构建可信赖的力学机器学习模型的关键步骤。[@problem_id:2656058]", "problem": "一个数据驱动的本构模型通过一个学习到的函数 $\\hat{\\sigma}(\\varepsilon)$，将小应变张量 $\\varepsilon$ 映射到柯西应力张量 $\\sigma$。该函数在数据集 $\\mathcal{D}=\\{(\\varepsilon^{(i)},\\sigma^{(i)})\\}_{i=1}^{N}$ 上训练得到。假设为小应变，因此 $\\varepsilon=\\tfrac{1}{2}(\\nabla u+\\nabla u^{\\top})$ 是对称的。设一个固定的向量化映射 $\\mathcal{V}$ 将 $\\varepsilon$ 的独立分量收集到一个向量 $e=\\mathcal{V}(\\varepsilon)\\in\\mathbb{R}^{d}$ 中，其中 $d\\in\\{3,4,6\\}$ 取决于运动学简化（例如，对于平面应力，$d=3$；对于三维情况，$d=6$）。训练输入为 $\\{e^{(i)}\\}_{i=1}^{N}\\subset\\mathbb{R}^{d}$。在实践中，一个关键问题是：一个查询应变 $e^{\\star}$ 是插值（即位于训练输入所张成的区域内）还是外推（即位于该区域之外），以及如果为外推，预测的应力 $\\hat{\\sigma}(\\varepsilon^{\\star})$ 在连续介质力学的意义下是否稳定。\n\n仅使用基本定义和经过充分检验的事实，设计一个有原则的测试方法，用以在应变空间中区分插值和外推，并提出度量指标，以一种与固体力学的增量稳定性要求兼容的方式，量化外推应力预测的稳定性。该测试必须在输入（应变）空间中进行，并且不依赖于查询时无法获得的真实标签。稳定性度量指标必须能从学习到的模型和训练数据中计算得出，并应与增量稳定性的概念（例如，小扰动下切线模量的正定性）相关联。\n\n以下哪个选项提出了一个符合这些要求的正确且完整的程序？\n\nA. 在 $\\mathbb{R}^{d}$ 中构建训练应变的凸包 $\\operatorname{conv}(\\{e^{(i)}\\})$ （对于各向同性材料，可选择在将 $\\varepsilon$ 映射到应变不变量，例如 $\\varepsilon$ 的主不变量后进行），例如通过对 $\\{e^{(i)}\\}$ 进行 Delaunay 三角剖分。如果查询点 $e^{\\star}\\in\\operatorname{conv}(\\{e^{(i)}\\})$，则将其分类为插值（等价地，如果 $e^{\\star}$ 能表示为包含它的某个单纯形的顶点的凸组合，且非负的重心坐标权重之和为 $1$）；否则分类为外推。对于外推预测，通过以下方式量化其稳定性：(i) 到凸包的距离度量，例如 $e^{\\star}$ 到 $\\operatorname{conv}(\\{e^{(i)}\\})$ 的马氏距离 (Mahalanobis distance)；(ii) 在 $\\varepsilon^{\\star}$ 周围对 $\\hat{\\sigma}$ 的局部李普希兹估计，通过在正交应变方向上使用对称有限差分获得；(iii) 通过中心差分估计的一致性切线 $C(\\varepsilon^{\\star})=\\partial \\hat{\\sigma}/\\partial \\varepsilon$ 的对称部分的谱，要求严格为正的最小特征值和有界的条件数来表明增量稳定性；以及 (iv) 在 $\\varepsilon^{\\star}$ 处，独立训练的模型集合 $\\{\\hat{\\sigma}_{m}\\}$ 的集成方差，作为认知不确定性 (epistemic uncertainty) 的度量。\n\nB. 计算 $e^{\\star}$ 到 $\\{e^{(i)}\\}$ 中单个最近邻的欧几里得距离。如果该距离小于训练集中的平均最近邻距离，则标记为插值；否则为外推。使用训练均方误差和在 $\\mathcal{D}$ 上的决定系数来量化稳定性。不需要在应变空间中进行导数或几何测试。\n\nC. 在应力空间中构建凸包 $\\operatorname{conv}(\\{\\sigma^{(i)}\\})$，如果 $\\hat{\\sigma}(\\varepsilon^{\\star})\\in\\operatorname{conv}(\\{\\sigma^{(i)}\\})$，则将 $e^{\\star}$ 分类为插值；否则为外推。通过检查有限元分片检验 (patch test) 来量化稳定性：用 $\\hat{\\sigma}(\\varepsilon^{\\star})$ 组装一个单单元线性动量平衡方程，并验证合成的节点力之和为零。如果和为零，则预测是稳定的。\n\nD. 将 $\\mathbb{R}^{d}$ 围绕 $\\{e^{(i)}\\}$ 划分为 Voronoi 单元，并声明如果 $e^{\\star}$ 位于任何 Voronoi 单元内，则为插值；否则为外推。通过在离 $e^{\\star}$ 最近的训练点处评估的训练损失梯度的范数来量化稳定性；小的梯度范数意味着稳定性。\n\n选择一个在输入（应变）空间中正确区分插值和外推，并提出有原则且与固体力学中的增量稳定性兼容的稳定性度量指标的选项。", "solution": "问题陈述在数据驱动固体力学领域提出了一个有效且高度相关的问题。它要求为学习到的本构模型制定一个有原则的方法，首先用以在输入应变空间中区分插值和外推，其次，以一种与连续介质力学原理一致的方式，提出量化预测稳定性的度量指标，特别是针对外推点。\n\n对问题陈述的验证过程如下：\n1.  **已知条件提取**：\n    *   学习到的本构映射：$\\hat{\\sigma}(\\varepsilon)$，从小应变张量 $\\varepsilon$ 到柯西应力张量 $\\sigma$。\n    *   训练数据集：$\\mathcal{D}=\\{(\\varepsilon^{(i)},\\sigma^{(i)})\\}_{i=1}^{N}$。\n    *   输入向量化：$e=\\mathcal{V}(\\varepsilon)\\in\\mathbb{R}^{d}$，其中 $\\mathcal{V}$ 是一个固定的映射，且 $d\\in\\{3,4,6\\}$。\n    *   训练输入：$\\{e^{(i)}\\}_{i=1}^{N}\\subset\\mathbb{R}^{d}$。\n    *   查询输入：$e^{\\star}$。\n    *   要求1：插值/外推测试必须在输入（应变）空间中进行。\n    *   要求2：稳定性度量指标必须能从模型 $\\hat{\\sigma}$ 和数据 $\\mathcal{D}$ 计算得出。\n    *   要求3：稳定性度量指标必须与固体力学中的增量稳定性概念（例如，切线模量的正定性）相关联。\n\n2.  **验证结论**：\n    *   **科学依据**：该问题基于连续介质力学（应力、应变、本构律、材料稳定性）和机器学习（插值与外推、不确定性量化）的既定原理。它解决了一个在将机器学习应用于安全关键型工程领域时遇到的关键而现实的挑战。\n    *   **适定性**：问题清晰，要求具体，允许对潜在解决方案进行严谨和客观的评估。\n    *   **客观性**：语言精确且专业，没有歧义或主观论断。\n    *   **完整性**：问题陈述提供了构建一个有原则的解决方案所需的所有必要信息。\n\n因此，问题陈述是**有效的**。我将继续进行推导和评估。\n\n### 有原则的解决方案的推导\n\n**第1部分：插值与外推测试**\n训练输入集 $\\{e^{(i)}\\}_{i=1}^{N}$ 在 $d$ 维应变向量空间 $\\mathbb{R}^d$ 中形成一个离散点云。插值域的最稳健且数学上最合理的定义是这些点的**凸包**，记为 $\\operatorname{conv}(\\{e^{(i)}\\})$。如果一个查询点 $e^{\\star}$ 可以表示为训练点的凸组合，即 $e^{\\star} \\in \\operatorname{conv}(\\{e^{(i)}\\})$，则它被认为是插值。否则，如果 $e^{\\star}$ 位于此凸包之外，则为外推。这是标准的定义，因为凸包内的任何点都被训练数据“包围”，而外部的任何点则没有。该测试严格按照要求在输入（应变）空间中进行。对于具有对称性（例如各向同性）的材料，此分析可以在较低维度的应变不变量空间中进行，这是通用原理的一个有效且高效的特例。\n\n**第2部分：稳定性度量指标**\n材料响应的稳定性是固体力学的基石。**增量材料稳定性**要求一个微小的、任意的应变增量 $\\dot{\\varepsilon}$ 导致正的功增量，即 $\\dot{\\sigma}:\\dot{\\varepsilon} > 0$。通过本构关系 $\\dot{\\sigma} = C:\\dot{\\varepsilon}$，这转化为四阶切线模量张量 $C$ 必须是正定的要求。\n\n对于学习到的模型 $\\hat{\\sigma}(\\varepsilon)$，相应的切线是应力预测关于应变输入的雅可比矩阵：\n$$\nC(\\varepsilon) = \\frac{\\partial \\hat{\\sigma}(\\varepsilon)}{\\partial \\varepsilon}\n$$\n在向量化形式下，这是雅可比矩阵 $C(e) = \\frac{\\partial \\hat{s}(e)}{\\partial e}$，其中 $\\hat{s}$ 是向量化的应力预测。因此，主要的力学稳定性度量指标是对查询点 $e^{\\star}$ 处的该切线矩阵 $C(e^{\\star})$ 进行分析。\n1.  **正定性**：稳定性要求 $C(e^{\\star})$ 是正定的。检查这一点最直接的方法是计算其特征值。由于真实的切线是对称的，我们应该分析计算出的雅可比矩阵的对称部分，即 $\\frac{1}{2}(C + C^{\\top})$。它的所有特征值必须严格为正：$\\lambda_{\\min}\\left(\\frac{1}{2}(C(e^{\\star}) + C(e^{\\star})^{\\top})\\right) > 0$。\n2.  **条件数**：条件数 $\\kappa(C) = \\lambda_{\\max}/\\lambda_{\\min}$ 量化了切线矩阵接近奇异（不稳定）的程度。大的条件数表示病态和接近不稳定点。\n\n这些度量指标必须辅以衡量模型偏离其训练域多远的度量，因为仅靠力学稳定性不能保证预测的准确性。\n3.  **外推程度**：量化 $e^{\\star}$ 到训练域 $\\operatorname{conv}(\\{e^{(i)}\\})$ 距离的度量是必不可少的。这可以是欧几里得距离，或者更稳健地，是考虑了数据协方差结构的马氏距离。\n4.  **认知不确定性**：在外推时，由于缺少约束数据，模型的预测变得不那么确定。这被称为认知不确定性。量化它的一个标准方法是在相同数据上训练一个模型集成 $\\{\\hat{\\sigma}_m\\}$ （使用不同的随机初始化或自助采样样本），并测量它们在 $e^{\\star}$ 处预测的方差或标准差。高方差表示低置信度。\n\n一个全面的程序结合了这些元素。\n\n### 对所提供选项的评估\n\n**选项 A：**\n*   **插值/外推测试**：提出使用训练应变的凸包 $\\operatorname{conv}(\\{e^{(i)}\\})$，并基于 Delaunay 三角剖分和重心坐标进行检查。这与上面推导出的有原则的方法完全一致。它还正确地提到了对于各向同性材料可以简化到应变不变量空间的有效方法。\n*   **稳定性度量指标**：提出了一套四个度量指标：(i) 到凸包的距离度量（例如马氏距离），量化外推的程度；(ii) 局部李普希兹估计，测量学习到的函数的局部平滑性或剧烈程度；(iii) 对计算出的切线模量 $C(\\varepsilon^{\\star})$ 进行谱分析，检查其正定性和有界条件数，直接解决了力学稳定性的核心要求；以及 (iv) 集成方差，以量化认知不确定性。\n*   **结论**：该选项正确且完整。它提出了一个严谨、多方面且科学合理的程序，完全满足了问题陈述的所有约束和要求。**正确**。\n\n**选项 B：**\n*   **插值/外推测试**：依赖于最近邻距离阈值。这是一个很差的启发式方法，因为一个点可能离单个训练样本很近，但仍然远远超出数据分布的全局支撑范围。它在许多情况下无法正确识别外推。\n*   **稳定性度量指标**：建议使用全局训练指标，如均方误差和 $R^2$。这些指标评估模型在其训练数据上的平均性能，但对于一个*新的*、特定的查询点的预测稳定性和可靠性，它们不提供任何信息。\n*   **结论**：该选项在两个组成部分上都有根本性缺陷。**不正确**。\n\n**选项 C：**\n*   **插值/外推测试**：在输出（应力）空间中操作，这违反了问题明确要求的在输入（应变）空间中工作的规定。此外，一个模型可能为一个严重外推的应变产生一个看起来合理的应力值（在训练应力范围内），这使得该测试对其预期目的而言并不可靠。\n*   **稳定性度量指标**：提出通过检查节点力在单个单元上是否总和为零的“分片检验”。这是对一个恒定应力状态的静力平衡的检查，该条件总是满足的，因此是同义反复。它与*增量材料稳定性*的概念毫无关系，后者由切线模量决定。\n*   **结论**：该选项违反了一个关键约束，并且误解了外推和材料稳定性的基本概念。**不正确**。\n\n**选项 D：**\n*   **插值/外推测试**：使用 Voronoi 单元。Voronoi 镶嵌划分了整个空间 $\\mathbb{R}^d$，这意味着每个查询点 $e^{\\star}$ 都会落入某个单元。根据这个定义，外推不存在，这使得该测试毫无用处，并显示出对概念的误解。\n*   **稳定性度量指标**：建议使用训练损失的梯度。训练损失梯度用于在优化过程中更新模型参数；它不是用于诊断新查询点预测稳定性的工具。该度量在此背景下是无关且无意义的。\n*   **结论**：该选项基于一系列关于几何分析和机器学习的概念错误。**不正确**。\n\n基于透彻的分析，只有选项A提出了一个正确、有原则且完整的程序。", "answer": "$$\\boxed{A}$$", "id": "2656058"}]}