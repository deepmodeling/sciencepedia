{"hands_on_practices": [{"introduction": "非局部弹性理论最重要的预测之一是波色散现象，即材料的响应取决于波长。本练习将带你亲手实践，使用Eringen模型推导一维杆的色散关系 [@problem_id:2665404]。通过计算相速度和群速度，你将直接观察到非局部效应如何引入一个材料长度尺度来主导波的传播，这是与经典理论的关键区别。", "problem": "一根横截面积均匀的细长棱柱杆沿其轴线作一维小振幅纵向运动。设位移场为 $u(x,t)$，质量密度和杨氏模量分别为 $\\rho$ 和 $E$。一维空间中的线性动量守恒由 $\\rho\\,\\partial^{2}u/\\partial t^{2}=\\partial\\sigma/\\partial x$ 给出，无穷小应变为 $\\varepsilon=\\partial u/\\partial x$。该材料遵循 Eringen 非局部弹性定律的微分形式，\n$(1-\\ell^{2}\\,\\partial^{2}/\\partial x^{2})\\,\\sigma(x,t)=E\\,\\varepsilon(x,t),$\n其中 $\\ell0$ 是内在材料长度尺度（假定为常数）。\n\n考虑一根无限长杆及形式为 $u(x,t)=\\Re\\{U\\,\\exp[i(kx-\\omega t)]\\}$ 的谐波平面波解，其中波数 $k0$ 为实数，圆频率 $\\omega0$。定义经典杆波速度 $c_{0}=\\sqrt{E/\\rho}$、相速度 $c_{p}(k)=\\omega(k)/k$ 以及群速度 $c_{g}(k)=d\\omega/dk$。\n\n仅使用上述控制方程和定义，推导由 Eringen 非局部弹性理论所蕴含的色散关系 $\\omega(k)$，并由此计算出相速度 $c_{p}(k)$ 和群速度 $c_{g}(k)$ 关于 $c_{0}$、$\\ell$ 和 $k$ 的符号表达式。然后，讨论当 $k\\to 0^{+}$ 和 $k\\to\\infty$ 时 $c_{p}(k)$ 和 $c_{g}(k)$ 的极限值，注意其主阶标度关系。你不需要生成数值图；而是给出一个能确定其定性形状的符号化描述。\n\n将你的最终结果以数对 $\\big[c_{p}(k),\\,c_{g}(k)\\big]$ 的形式报告，作为关于 $c_{0}$、$\\ell$ 和 $k$ 的闭式解析表达式。在最终报告的数对中不要包含单位。无需四舍五入。", "solution": "问题陈述已经过审查，并被认定为有效。这是一个连续介质力学中的适定性问题，基于 Eringen 非局部弹性理论的既有理论。所有必要的控制方程和定义均已提供，不存在矛盾或歧义。我们开始推导。\n\n目标是推导由 Eringen 非局部模型控制的无限长杆中纵波的色散关系、相速度和群速度。\n\n控制方程如下：\n1.  线性动量守恒： $\\rho\\,\\frac{\\partial^{2}u}{\\partial t^{2}}=\\frac{\\partial\\sigma}{\\partial x}$\n2.  运动学关系（无穷小应变）： $\\varepsilon=\\frac{\\partial u}{\\partial x}$\n3.  Eringen 非局部本构关系： $(1-\\ell^{2}\\,\\frac{\\partial^{2}}{\\partial x^{2}})\\,\\sigma(x,t)=E\\,\\varepsilon(x,t)$\n\n我们考虑位移场 $u(x,t)$ 的谐波平面波解，其形式为：\n$$u(x,t) = U\\,\\exp[i(kx-\\omega t)]$$\n其中 $U$ 是复振幅，$k0$ 是波数，$\\omega0$ 是圆频率。对于线性方程，我们可以使用这种复数形式进行计算，并在必要时最终取实部。假设应力场 $\\sigma(x,t)$ 具有类似的形式：\n$$\\sigma(x,t) = \\Sigma\\,\\exp[i(kx-\\omega t)]$$\n其中 $\\Sigma$ 是复应力振幅。\n\n首先，我们将这些波形代入控制方程，以获得振幅 $U$ 和 $\\Sigma$ 之间的代数关系。\n\n所需的偏导数是：\n$$\\frac{\\partial u}{\\partial x} = iku, \\quad \\frac{\\partial^{2}u}{\\partial t^{2}} = (-\\mathrm{i}\\omega)^{2}u = -\\omega^{2}u$$\n$$\\frac{\\partial \\sigma}{\\partial x} = ik\\sigma, \\quad \\frac{\\partial^{2} \\sigma}{\\partial x^{2}} = (ik)^{2}\\sigma = -k^{2}\\sigma$$\n\n将这些代入动量守恒方程：\n$$\\rho(-\\omega^{2}u) = ik\\sigma$$\n$$\\rho(-\\omega^{2}U\\exp[i(kx-\\omega t)]) = ik\\Sigma\\exp[i(kx-\\omega t)]$$\n对于非平凡解，我们需要振幅之间存在以下关系：\n$$-\\rho\\omega^{2}U = ik\\Sigma$$\n$$\\Sigma = \\frac{-\\rho\\omega^{2}}{ik}U = \\frac{i\\rho\\omega^{2}}{k}U \\quad (*)$$\n\n接下来，将波形代入应变定义和本构关系。应变为：\n$$\\varepsilon = \\frac{\\partial u}{\\partial x} = iku = ikU\\exp[i(kx-\\omega t)]$$\n现在代入本构关系：\n$$(1-\\ell^{2}(-k^{2}))\\sigma = E\\varepsilon$$\n$$(1+\\ell^{2}k^{2})\\sigma = E\\varepsilon$$\n关联振幅：\n$$(1+\\ell^{2}k^{2})\\Sigma = E(ikU)$$\n$$\\Sigma = \\frac{ikE}{1+\\ell^{2}k^{2}}U \\quad (**)$$\n\n为了找到色散关系，我们通过令方程 $(*)$ 和 $(**)$ 中 $\\Sigma$ 的两个表达式相等来消去 $\\Sigma$ 和 $U$：\n$$\\frac{i\\rho\\omega^{2}}{k}U = \\frac{ikE}{1+\\ell^{2}k^{2}}U$$\n假设波存在（$U \\neq 0$），我们可以除以 $iU$：\n$$\\frac{\\rho\\omega^{2}}{k} = \\frac{kE}{1+\\ell^{2}k^{2}}$$\n解出 $\\omega^{2}$：\n$$\\omega^{2} = \\frac{E}{\\rho}\\frac{k^{2}}{1+\\ell^{2}k^{2}}$$\n使用经典杆波速度的定义 $c_{0} = \\sqrt{E/\\rho}$，上式变为：\n$$\\omega^{2}(k) = \\frac{c_{0}^{2}k^{2}}{1+\\ell^{2}k^{2}}$$\n由于频率 $\\omega$ 必须为正，我们取正平方根以获得色散关系：\n$$\\omega(k) = \\frac{c_{0}k}{\\sqrt{1+\\ell^{2}k^{2}}}$$\n该关系将时间频率 $\\omega$ 与空间频率（波数）$k$ 联系起来。\n\n现在我们计算相速度 $c_{p}(k)$ 和群速度 $c_{g}(k)$。\n\n相速度定义为 $c_{p}(k)=\\omega(k)/k$：\n$$c_{p}(k) = \\frac{1}{k}\\left(\\frac{c_{0}k}{\\sqrt{1+\\ell^{2}k^{2}}}\\right) = \\frac{c_{0}}{\\sqrt{1+\\ell^{2}k^{2}}}$$\n\n群速度定义为 $c_{g}(k)=d\\omega/dk$。我们对 $\\omega(k)$ 的表达式应用商法则：\n$$c_{g}(k) = \\frac{d}{dk}\\left(\\frac{c_{0}k}{(1+\\ell^{2}k^{2})^{\\frac{1}{2}}}\\right)$$\n$$c_{g}(k) = \\frac{c_{0}(1+\\ell^{2}k^{2})^{\\frac{1}{2}} - c_{0}k \\cdot \\frac{1}{2}(1+\\ell^{2}k^{2})^{-\\frac{1}{2}}(2\\ell^{2}k)}{1+\\ell^{2}k^{2}}$$\n$$c_{g}(k) = \\frac{c_{0}(1+\\ell^{2}k^{2}) - c_{0}\\ell^{2}k^{2}}{(1+\\ell^{2}k^{2})^{\\frac{3}{2}}}$$\n$$c_{g}(k) = \\frac{c_{0} + c_{0}\\ell^{2}k^{2} - c_{0}\\ell^{2}k^{2}}{(1+\\ell^{2}k^{2})^{\\frac{3}{2}}} = \\frac{c_{0}}{(1+\\ell^{2}k^{2})^{\\frac{3}{2}}}$$\n\n最后，我们分析这些速度的极限行为。\n\n对于长波极限（$k \\to 0^{+}$）：\n$$\\lim_{k \\to 0^{+}} c_{p}(k) = \\lim_{k \\to 0^{+}} \\frac{c_{0}}{\\sqrt{1+\\ell^{2}k^{2}}} = c_{0}$$\n$$\\lim_{k \\to 0^{+}} c_{g}(k) = \\lim_{k \\to 0^{+}} \\frac{c_{0}}{(1+\\ell^{2}k^{2})^{\\frac{3}{2}}} = c_{0}$$\n在此极限下，两种速度都趋近于经典波速 $c_{0}$。对于远大于内在长度尺度 $\\ell$ 的波长，材料表现得像局部弹性固体。\n\n对于短波极限（$k \\to \\infty$）：\n$$\\lim_{k \\to \\infty} c_{p}(k) = \\lim_{k \\to \\infty} \\frac{c_{0}}{\\sqrt{1+\\ell^{2}k^{2}}} \\sim \\lim_{k \\to \\infty} \\frac{c_{0}}{\\ell k} = 0$$\n主阶标度关系为 $c_{p}(k) \\propto k^{-1}$。\n$$\\lim_{k \\to \\infty} c_{g}(k) = \\lim_{k \\to \\infty} \\frac{c_{0}}{(1+\\ell^{2}k^{2})^{\\frac{3}{2}}} \\sim \\lim_{k \\to \\infty} \\frac{c_{0}}{(\\ell k)^{3}} = 0$$\n主阶标度关系为 $c_{g}(k) \\propto k^{-3}$。\n在此极限下，两种速度都趋于零，表明波长与材料长度尺度 $\\ell$ 相当或更小的波不传播。这是该非局部模型的一个典型特征，通常称为“应变软化”。\n\n为了进行定性描述，我们注意到对于所有 $k0$，两种速度关于 $k$ 的导数都严格为负。因此，$c_{p}(k)$ 和 $c_{g}(k)$ 都是单调递减函数，从 $k=0$ 处的最大值 $c_{0}$ 开始，并随着 $k \\to \\infty$ 衰减到 $0$。此外，对于任何 $k0$，都有 $(1+\\ell^{2}k^{2})^{\\frac{3}{2}}  (1+\\ell^{2}k^{2})^{\\frac{1}{2}}$，这意味着 $c_{g}(k)  c_{p}(k)$。这描述了一种具有反常色散的介质。\n\n所需的相速度和群速度表达式为：\n$$c_{p}(k) = \\frac{c_{0}}{\\sqrt{1+\\ell^{2}k^{2}}}$$\n$$c_{g}(k) = \\frac{c_{0}}{(1+\\ell^{2}k^{2})^{\\frac{3}{2}}}$$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{c_{0}}{\\sqrt{1 + \\ell^{2}k^{2}}}  \\frac{c_{0}}{(1 + \\ell^{2}k^{2})^{\\frac{3}{2}}} \\end{pmatrix}}$$", "id": "2665404"}, {"introduction": "虽然非局部性通常会引入软化或尺寸依赖效应，但在特定条件下，它也可能导致看似经典的行为，从而产生一个明显的“佯谬”。该练习将引导你计算一个在特定载荷分布（其形式与材料的非局部核函数相匹配）作用下的杆件 [@problem_id:2665380]。分析过程将揭示这一特殊情况为何出人意料地将非局部问题简化为其对应的局部问题，从而让你对本构定律与外部作用之间的相互作用产生深刻的理解。", "problem": "考虑一根长度为 $L$、均匀横截面积为 $A$、杨氏模量为 $E$ 的细长、等截面一维弹性杆，沿 $x$ 轴放置在区间 $x \\in [0,L]$ 上。运动学关系为 $\\varepsilon(x) = \\dfrac{du}{dx}$，其中 $u(x)$ 是轴向位移，$\\varepsilon(x)$ 是轴向应变。本构模型遵循 Eringen 非局部弹性理论的积分形式，并采用高斯衰减核。具体来说，对于特征内禀长度 $\\ell0$，衰减核为\n$$\n\\alpha_{\\ell}(r) = \\frac{1}{\\sqrt{2\\pi}\\,\\ell}\\,\\exp\\!\\left(-\\frac{r^{2}}{2\\ell^{2}}\\right),\n$$\n非局部应力 $\\sigma(x)$ 通过以下方式与局部应变相关联\n$$\n\\sigma(x) = \\int_{-\\infty}^{\\infty} \\alpha_{\\ell}(|x-\\xi|)\\,E\\,\\varepsilon(\\xi)\\,d\\xi,\n$$\n我们假设杆的长度远大于 $\\ell$，因此在评估杆中点附近的核卷积时，可以忽略边界效应（长杆近似）。\n\n在杆的中点 $x=L/2$ 处，以与非局部公式相一致的方式施加一个合力大小为 $P$ 的局部轴向载荷；即，所施加的线载荷密度采用以 $x=L/2$ 为中心的相同高斯分布，\n$$\np(x) = P\\,\\alpha_{\\ell}(|x - L/2|),\n$$\n使得 $\\int_{-\\infty}^{\\infty} p(x)\\,dx = P$。一维线性动量的静态平衡方程为\n$$\n\\frac{d}{dx}\\big(A\\,\\sigma(x)\\big) + p(x) = 0.\n$$\n边界条件是运动学的：$u(0)=0$ 和 $u(L)=0$。\n\n将载荷点处的非局部轴向刚度定义为\n$$\nk_{\\mathrm{nl}} := \\frac{P}{u(L/2)}.\n$$\n从上述场方程和定义出发，除了给定的定义外，不使用任何预先制表的公式，利用傅里叶变换（FT）分析来评估高斯卷积并计算 $u(L/2)$。然后，推导出 $k_{\\mathrm{nl}}$ 关于 $E$、$A$ 和 $L$ 的闭式解析表达式。请将最终答案表示为符号表达式。不需要进行数值舍入。", "solution": "所述问题是适定的、内部一致的，并且在非局部连续介质力学的既定框架内具有科学依据。按照要求，该问题可以通过严格应用傅里叶分析来解决。下面我们开始推导。\n\n一维杆的控制方程如下：\n静态平衡方程：\n$$\n\\frac{d}{dx}\\big(A\\,\\sigma(x)\\big) + p(x) = 0\n$$\n运动学关系：\n$$\n\\varepsilon(x) = \\frac{du}{dx}\n$$\n非局部本构关系（Eringen 模型），采用高斯核：\n$$\n\\sigma(x) = \\int_{-\\infty}^{\\infty} \\alpha_{\\ell}(|x-\\xi|)\\,E\\,\\varepsilon(\\xi)\\,d\\xi = (\\alpha_{\\ell} * (E\\varepsilon))(x)\n$$\n其中 `*` 表示卷积。施加的载荷密度为：\n$$\np(x) = P\\,\\alpha_{\\ell}(|x - L/2|)\n$$\n该问题需要使用傅里叶变换分析来求解。设函数 $f(x)$ 的傅里叶变换表示为 $\\hat{f}(k) = \\mathcal{F}\\{f(x)\\}$。我们将傅里叶变换应用于平衡方程。利用微分性质 $\\mathcal{F}\\{f'(x)\\} = ik\\hat{f}(k)$，我们得到：\n$$\nA\\,(ik)\\,\\hat{\\sigma}(k) + \\hat{p}(k) = 0\n$$\n接下来，我们对本构关系进行变换。卷积定理指出 $\\mathcal{F}\\{f * g\\} = \\hat{f}(k)\\hat{g}(k)$。因此：\n$$\n\\hat{\\sigma}(k) = \\hat{\\alpha}_{\\ell}(k) \\mathcal{F}\\{E\\varepsilon(x)\\}\n$$\n应变的变换为 $\\hat{\\varepsilon}(k) = \\mathcal{F}\\{\\frac{du}{dx}\\} = ik\\hat{u}(k)$。因此：\n$$\n\\hat{\\sigma}(k) = \\hat{\\alpha}_{\\ell}(k)\\,E\\,(ik)\\,\\hat{u}(k)\n$$\n我们现在必须求出高斯核 $\\alpha_{\\ell}(r) = \\frac{1}{\\sqrt{2\\pi}\\,\\ell}\\,\\exp(-\\frac{r^{2}}{2\\ell^{2}})$ 的傅里叶变换。这是一个标准结果；高斯函数变换后仍为高斯函数：\n$$\n\\hat{\\alpha}_{\\ell}(k) = \\mathcal{F}\\left\\{\\frac{1}{\\sqrt{2\\pi}\\,\\ell}\\,\\exp\\left(-\\frac{x^{2}}{2\\ell^{2}}\\right)\\right\\} = \\exp\\left(-\\frac{\\ell^{2}k^{2}}{2}\\right)\n$$\n现在，我们求载荷密度 $p(x)$ 的变换。利用位移性质 $\\mathcal{F}\\{f(x-a)\\} = e^{-ika}\\hat{f}(k)$：\n$$\n\\hat{p}(k) = \\mathcal{F}\\{P\\,\\alpha_{\\ell}(|x - L/2|)\\} = P\\,\\exp\\left(-ik\\frac{L}{2}\\right)\\hat{\\alpha}_{\\ell}(k) = P\\,\\exp\\left(-ik\\frac{L}{2}\\right)\\exp\\left(-\\frac{\\ell^{2}k^{2}}{2}\\right)\n$$\n将 $\\hat{\\sigma}(k)$ 和 $\\hat{p}(k)$ 的表达式代入变换后的平衡方程：\n$$\nA\\,(ik)\\left[\\hat{\\alpha}_{\\ell}(k)\\,E\\,(ik)\\,\\hat{u}(k)\\right] + P\\,\\exp\\left(-ik\\frac{L}{2}\\right)\\hat{\\alpha}_{\\ell}(k) = 0\n$$\n$$\nA\\,E\\,(ik)^{2}\\,\\hat{\\alpha}_{\\ell}(k)\\,\\hat{u}(k) + P\\,\\exp\\left(-ik\\frac{L}{2}\\right)\\hat{\\alpha}_{\\ell}(k) = 0\n$$\n$$\n\\hat{\\alpha}_{\\ell}(k) \\left[-A\\,E\\,k^{2}\\,\\hat{u}(k) + P\\,\\exp\\left(-ik\\frac{L}{2}\\right)\\right] = 0\n$$\n对于所有实数波数 $k$，项 $\\hat{\\alpha}_{\\ell}(k) = \\exp(-\\frac{\\ell^{2}k^{2}}{2})$ 恒为正。因此，可以从方程中消去该项，这意味着括号内的表达式必须为零：\n$$\n-A\\,E\\,k^{2}\\,\\hat{u}(k) + P\\,\\exp\\left(-ik\\frac{L}{2}\\right) = 0\n$$\n这个方程至关重要。核函数变换 $\\hat{\\alpha}_{\\ell}(k)$ 的消去表明，在施加载荷分布与材料的非局部核相匹配的特定条件下，非局部问题简化为了一个纯局部问题。为了理解这一点，考虑此方程的傅里叶逆变换。项 $-A\\,E\\,k^{2}\\,\\hat{u}(k)$ 在实空间中对应于 $A\\,E\\,\\frac{d^{2}u}{dx^{2}}$，而项 $P\\,\\exp(-ik\\frac{L}{2})$ 是作用于 $x=L/2$ 处的大小为 $P$ 的狄拉克 $\\delta$ 函数的傅里叶变换，即 $P\\,\\delta(x - L/2)$。\n因此，原始的非局部积分微分方程简化为承受点载荷的局部弹性杆的经典微分方程：\n$$\nA\\,E\\,\\frac{d^{2}u}{dx^{2}} + P\\,\\delta\\left(x - \\frac{L}{2}\\right) = 0\n$$\n我们现在必须求解这个受边界条件 $u(0)=0$ 和 $u(L)=0$ 约束的二阶常微分方程。对该方程积分一次，得到轴向应变梯度：\n$$\nA\\,E\\,\\frac{du}{dx} = -P\\,H\\left(x - \\frac{L}{2}\\right) + C_{1}\n$$\n其中 $H(x)$ 是亥维赛阶跃函数，$C_{1}$ 是一个积分常数。再次积分，得到位移场：\n$$\nA\\,E\\,u(x) = -P\\,\\left(x - \\frac{L}{2}\\right)H\\left(x - \\frac{L}{2}\\right) + C_{1}x + C_{2}\n$$\n常数 $C_{1}$ 和 $C_{2}$ 由边界条件确定。\n在 $x=0$ 处，$u(0)=0$：\n$$\nA\\,E\\,u(0) = 0 = -P\\,\\left(-\\frac{L}{2}\\right)H\\left(-\\frac{L}{2}\\right) + C_{1}(0) + C_{2}\n$$\n由于 $H(-L/2)=0$，这得到 $C_{2}=0$。\n在 $x=L$ 处，$u(L)=0$：\n$$\nA\\,E\\,u(L) = 0 = -P\\,\\left(L - \\frac{L}{2}\\right)H\\left(L - \\frac{L}{2}\\right) + C_{1}L\n$$\n由于 $H(L/2)=1$，这简化为：\n$$\n0 = -P\\left(\\frac{L}{2}\\right) + C_{1}L \\implies C_{1}L = \\frac{PL}{2} \\implies C_{1} = \\frac{P}{2}\n$$\n将常数代回到 $u(x)$ 的表达式中，我们得到：\n$$\nA\\,E\\,u(x) = \\frac{P}{2}x - P\\left(x - \\frac{L}{2}\\right)H\\left(x - \\frac{L}{2}\\right)\n$$\n问题要求计算载荷作用点 $x=L/2$ 处的位移。\n$$\nA\\,E\\,u\\left(\\frac{L}{2}\\right) = \\frac{P}{2}\\left(\\frac{L}{2}\\right) - P\\left(\\frac{L}{2} - \\frac{L}{2}\\right)H\\left(\\frac{L}{2} - \\frac{L}{2}\\right)\n$$\n使用约定 $H(0)=1/2$，或者更简单地，通过在区域 $x \\le L/2$（亥维赛项为零）中评估解，我们发现：\n$$\nA\\,E\\,u\\left(\\frac{L}{2}\\right) = \\frac{PL}{4}\n$$\n因此，中点处的位移为：\n$$\nu\\left(\\frac{L}{2}\\right) = \\frac{PL}{4AE}\n$$\n最后，载荷点处的非局部轴向刚度定义为 $k_{\\mathrm{nl}} := P/u(L/2)$。\n$$\nk_{\\mathrm{nl}} = \\frac{P}{\\frac{PL}{4AE}} = \\frac{4AE}{L}\n$$\n结果与非局部参数 $\\ell$ 无关。这是特意构造的载荷分布的直接结果，该分布与非局部核相同，产生的响应在宏观上与承受点载荷的纯局部系统无法区分。", "answer": "$$\n\\boxed{\\frac{4AE}{L}}\n$$", "id": "2665380"}, {"introduction": "将非局部积分方程转化为高效的计算算法，是现代工程分析中的一项关键技能。本练习专注于使用快速傅里叶变换（FFT）在周期性域上实现非局部本构关系 [@problem_id:2665428]。通过比较基于FFT的方法与直接卷积法，你不仅将验证卷积定理，还将对巨大的计算加速优势有切身体会，正是这种优势使得大规模非局部模拟成为可能。", "problem": "考虑在长度为 $L$、周期为 $L$ 的周期性杆上的一维 Eringen 型非局部积分本构关系，该杆具有 $N$ 个等距节点的网格。令 $x_j = j\\Delta x$，其中 $\\Delta x = L/N$，适用于 $j \\in \\{0,1,\\dots,N-1\\}$。用 $\\varepsilon(x)$ 表示局部应变，用 $\\sigma(x)$ 表示非局部应力。该非局部本构律的标量形式为：\n$$\n\\sigma(x) = \\int_0^L \\alpha_p(x-y)\\,E\\,\\varepsilon(y)\\,dy,\n$$\n其中 $E$ 是弹性模量（一个正常数），$\\alpha_p$ 是周期性非局部衰减核函数。在周期性域上，与内禀长度 $\\ell  0$ 的经典 Helmholtz 型 Eringen 核相对应的傅里叶级数乘子为：\n$$\n\\widehat{\\alpha}(k) = \\frac{1}{1 + (\\ell k)^2},\n$$\n使得对于每个傅里叶波数 $k$，都有 $\\widehat{\\sigma}(k) = \\widehat{\\alpha}(k)\\,E\\,\\widehat{\\varepsilon}(k)$。\n\n在周期性网格上使用梯形法则对该积分进行离散化。定义离散序列 $\\varepsilon_j = \\varepsilon(x_j)$、$\\sigma_j \\approx \\sigma(x_j)$ 以及离散周期核样本 $b_j$，使得：\n$$\n\\sigma_j \\approx \\sum_{m=0}^{N-1} b_{(j-m)\\bmod N}\\,\\varepsilon_m \\quad \\text{for all } j \\in \\{0,1,\\dots,N-1\\}.\n$$\n始终假设离散傅里叶变换 (DFT) 及其逆变换定义如下：\n$$\n\\widehat{f}_n = \\sum_{j=0}^{N-1} f_j \\, e^{-i 2\\pi j n/N}, \\qquad f_j = \\frac{1}{N}\\sum_{n=0}^{N-1} \\widehat{f}_n \\, e^{i 2\\pi j n/N},\n$$\n从而循环卷积定理成立：$\\widehat{f\\star g} = \\widehat{f}\\,\\widehat{g}$，其中 $(f\\star g)_j = \\sum_{m=0}^{N-1} g_{(j-m)\\bmod N} f_m$。\n\n你的任务是：\n\n$1.$ 从积分非局部定律和周期性梯形法则出发，推导 $\\sigma_j$ 的离散循环卷积形式，并确定离散核样本 $b_j$ 与离散波数 $k_n = \\frac{2\\pi}{L}n$（其中 $n \\in \\{0,1,\\dots,N-1\\}$）处的谱乘子 $\\widehat{\\alpha}(k_n)$ 之间的精确关系。\n\n$2.$ 仅使用离散傅里叶变换 (DFT) 的卷积定理，推导一个基于快速傅里叶变换 (FFT, Fast Fourier Transform) 的算法，该算法通过以下步骤计算所有 $j$ 的 $\\sigma_j$：\n- 计算 $\\varepsilon_j$ 的 DFT，\n- 逐点乘以与 Helmholtz 型 Eringen 核相对应的谱乘子，\n- 应用逆 DFT。\n\n使每一步都明确，并确保该算法计算出的离散循环卷积与任务 1 中的结果相同。\n\n$3.$ 进行运算计数，比较朴素的直接循环卷积方法与基于 FFT 的方法。证明直接方法需要 $O(N^2)$ 数量级的算术运算，而基于 FFT 的方法需要 $O(N\\log N)$ 数量级的运算。由此推导出（忽略常数因子）近似的理论加速比：\n$$\nS(N) \\approx \\frac{N}{\\log_2 N}.\n$$\n\n$4.$ 实现一个程序，对于下述每个测试用例，计算：\n- 使用由乘子 $\\widehat{\\alpha}(k_n)$ 所隐含的核 $b_j$，通过直接 $O(N^2)$ 循环卷积计算离散非局部应力，\n- 通过基于 FFT 的 $O(N\\log N)$ 方法计算离散非局部应力，\n- 两种结果之间的最大绝对差（一个绝对误差），\n- 上面定义的理论加速比 $S(N)$。\n\n使用以下测试套件，所有角度均以弧度为单位：\n- 测试 A (通用“理想路径”)：$N = 64$，$L = 2\\pi$，$\\ell = 0.3$，以及 $\\varepsilon(x) = \\sin(3x) + 0.5\\cos(5x) + 0.2\\sin(7x)$。\n- 测试 B (趋近于局部极限)：$N = 128$，$L = 2\\pi$，$\\ell = 10^{-6}$，以及与测试 A 相同的 $\\varepsilon(x)$。\n- 测试 C (非 2 的幂次大小)：$N = 96$，$L = 2\\pi$，$\\ell = 0.5$，以及与测试 A 相同的 $\\varepsilon(x)$。\n- 测试 D (边界情况，恒定应变)：$N = 100$，$L = 2\\pi$，$\\ell = 0.2$，以及 $\\varepsilon(x) \\equiv 3.7$。\n\n必须遵守的实现细节：\n- 使用 $\\widehat{\\alpha}(k_n) = \\frac{1}{1 + (\\ell k_n)^2}$ 在离散波数 $k_n = \\frac{2\\pi}{L} n$ 处构建离散谱乘子。\n- 通过对乘子进行逆 DFT 来构建相应的离散核样本 $b_j$，以使直接循环卷积与基于 FFT 的结果相匹配。\n- 对于直接方法，通过求和以 $O(N^2)$ 的复杂度显式计算循环卷积，不使用 FFT。\n\n你的程序必须以精确的格式输出单行结果：\n- 一个列表，其条目按 A、B、C、D 的测试用例顺序，在以下两者之间交替：\n  - 最大绝对误差（一个浮点数），然后是\n  - 理论加速比 $S(N)$（一个浮点数）。\n因此，输出应为以下形式：\n$$\n[\\text{err}_A, S(N_A), \\text{err}_B, S(N_B), \\text{err}_C, S(N_C), \\text{err}_D, S(N_D)].\n$$\n所有输出均为无量纲实数。角度单位为弧度。输出中无需进行物理单位转换。程序必须在单行上生成一个用方括号括起来的、以逗号分隔的列表。", "solution": "所述问题具有科学依据、是适定的，并且是计算力学和数值分析中的一个客观练习。它包含了推导和实现所需算法的所有必要信息。因此，该问题被认为是有效的。下面提供了完整的解决方案。\n\n弹性模量 $E$ 是一个给定的正常数，但其值未指定。由于它仅作为应力 $\\sigma$ 的一个简单比例因子，且问题的重点是数值算法及其复杂度的比较，我们可以不失一般性地设 $E=1$。所有的推导和计算都将在此假设下进行。\n\n**1. 离散卷积形式的推导**\n\n我们从周期性域（长度为 $L$）上的非局部应力 $\\sigma(x)$ 的一维积分本构关系开始：\n$$\n\\sigma(x) = \\int_0^L \\alpha_p(x-y)\\,E\\,\\varepsilon(y)\\,dy\n$$\n我们在包含 $N$ 个等距节点 $x_j = j\\Delta x$（其中 $j \\in \\{0, 1, \\dots, N-1\\}$ 且 $\\Delta x = L/N$）的网格上对此积分进行离散化。使用周期性梯形法则来近似该积分。设 $x = x_j$，并注意到积分变量 $y$ 对应于网格点 $y_m = m\\Delta x$：\n$$\n\\sigma(x_j) \\approx \\sum_{m=0}^{N-1} \\left(E \\alpha_p(x_j - y_m)\\right) \\varepsilon(y_m) \\Delta x\n$$\n令 $\\sigma_j \\equiv \\sigma(x_j)$ 和 $\\varepsilon_m \\equiv \\varepsilon(y_m)$。代入网格点定义 $x_j - y_m = (j-m)\\Delta x$：\n$$\n\\sigma_j \\approx \\sum_{m=0}^{N-1} \\left(E \\Delta x \\alpha_p((j-m)\\Delta x)\\right) \\varepsilon_m\n$$\n此表达式是一个离散循环卷积。问题陈述中给出了形式 $\\sigma_j \\approx \\sum_{m=0}^{N-1} b_{(j-m)\\bmod N}\\,\\varepsilon_m$。通过直接比较，我们确定离散核样本 $b_k$ 为：\n$$\nb_k = E \\Delta x \\alpha_p(k \\Delta x) = \\frac{EL}{N} \\alpha_p\\left(\\frac{kL}{N}\\right)\n$$\n现在，我们将离散核 $b_j$ 与谱乘子 $\\widehat{\\alpha}(k_n)$ 联系起来。我们对离散卷积进行离散傅里叶变换 (DFT)。使用所提供的循环卷积定理定义 $\\widehat{(\\mathbf{b} \\star \\boldsymbol{\\varepsilon})}_n = \\widehat{b}_n \\widehat{\\varepsilon}_n$，我们得到：\n$$\n\\widehat{\\sigma}_n = \\widehat{b}_n \\widehat{\\varepsilon}_n\n$$\n为了求得 $\\widehat{b}_n$，我们可以将 DFT 与连续傅里叶级数系数联系起来。对于一个函数 $f(x)$，其在波数 $k_n = 2\\pi n/L$ 处的傅里叶级数系数 $\\tilde{c}_n$ 可由其 DFT $\\widehat{f}_n$ 近似为 $\\tilde{c}_n(f) \\approx \\frac{1}{N} \\widehat{f}_n$。\n连续谱定律为 $\\widehat{\\sigma}(k) = E \\widehat{\\alpha}(k) \\widehat{\\varepsilon}(k)$。这暗示了傅里叶级数系数之间存在关系：$\\tilde{c}_n(\\sigma) = E \\widehat{\\alpha}(k_n) \\tilde{c}_n(\\varepsilon)$。\n代入 DFT 近似：\n$$\n\\frac{1}{N} \\widehat{\\sigma}_n \\approx E \\widehat{\\alpha}(k_n) \\left(\\frac{1}{N} \\widehat{\\varepsilon}_n\\right) \\implies \\widehat{\\sigma}_n \\approx E \\widehat{\\alpha}(k_n) \\widehat{\\varepsilon}_n\n$$\n将此与 $\\widehat{\\sigma}_n = \\widehat{b}_n \\widehat{\\varepsilon}_n$ 进行比较，我们建立了精确的关系：\n$$\n\\widehat{b}_n = E \\widehat{\\alpha}(k_n)\n$$\n根据问题要求，我们在离散波数 $k_n = \\frac{2\\pi n}{L}$ (其中 $n \\in \\{0, 1, \\dots, N-1\\}$) 处使用 Helmholtz 型乘子 $\\widehat{\\alpha}(k) = \\frac{1}{1 + (\\ell k)^2}$。设 $E=1$，离散核的谱表示为：\n$$\n\\widehat{b}_n = \\frac{1}{1 + (\\ell k_n)^2} = \\frac{1}{1 + \\left(\\ell \\frac{2\\pi n}{L}\\right)^2}\n$$\n离散核样本 $b_j$ 本身通过对 $\\widehat{b}_n$ 应用离散傅里叶逆变换 (IDFT) 获得：\n$$\nb_j = \\text{IDFT}(\\widehat{b})_j = \\frac{1}{N} \\sum_{n=0}^{N-1} \\widehat{b}_n \\, e^{i 2\\pi j n/N}\n$$\n\n**2. 基于 FFT 的算法**\n\n上面推导的关系 $\\widehat{\\sigma}_n = \\widehat{b}_n \\widehat{\\varepsilon}_n$ 为使用快速傅里叶变换 (FFT) 的高效算法提供了基础。从离散应变 $\\varepsilon_j$ 计算离散应力 $\\sigma_j$ 的步骤如下：\n\n1.  **正变换**：计算离散应变序列 $\\varepsilon_j$ 的 DFT，以获得其谱表示 $\\widehat{\\varepsilon}_n$。这可以通过使用 FFT 算法高效完成。\n    $$\n    \\widehat{\\varepsilon}_n = \\text{DFT}(\\boldsymbol{\\varepsilon})_n = \\sum_{j=0}^{N-1} \\varepsilon_j \\, e^{-i 2\\pi j n/N}\n    $$\n2.  **谱域乘法**：在离散波数 $k_n = \\frac{2\\pi n}{L}$（其中 $n=0, \\dots, N-1$）处构建谱乘子序列 $\\widehat{b}_n$（设 $E=1$）。\n    $$\n    \\widehat{b}_n = \\frac{1}{1 + (\\ell k_n)^2}\n    $$\n    然后，在傅里叶域中执行逐点乘法，以求得应力的谱。\n    $$\n    \\widehat{\\sigma}_n = \\widehat{b}_n \\cdot \\widehat{\\varepsilon}_n\n    $$\n3.  **逆变换**：计算得到的应力谱 $\\widehat{\\sigma}_n$ 的 IDFT，以在物理域中获得离散应力序列 $\\sigma_j$。这可以通过使用快速傅里叶逆变换 (IFFT) 算法高效完成。\n    $$\n    \\sigma_j = \\text{IDFT}(\\widehat{\\boldsymbol{\\sigma}})_j = \\frac{1}{N} \\sum_{n=0}^{N-1} \\widehat{\\sigma}_n \\, e^{i 2\\pi j n/N}\n    $$\n根据卷积定理，此过程在数学上等效于直接循环卷积 $\\sigma_j = \\sum_{m=0}^{N-1} b_{(j-m)\\bmod N}\\,\\varepsilon_m$，其中 $b_j = \\text{IDFT}(\\widehat{b})_j$。基于 FFT 的方法避免了对 $b_j$ 的显式计算和代价高昂的求和运算。\n\n**3. 复杂度分析与加速**\n\n我们分析每种方法的算术运算次数。\n\n*   **直接循环卷积**：计算公式为 $\\sigma_j = \\sum_{m=0}^{N-1} b_{(j-m)\\bmod N}\\,\\varepsilon_m$。\n    *   对于 $N$ 个输出点 $\\sigma_j$ 中的每一个，我们执行一个包含 $N$ 个项的求和。\n    *   求和中的每一项需要一次乘法和一次加法（索引计算是整数运算，通常更快）。\n    *   因此，每个 $\\sigma_j$ 大约需要 $N$ 次乘法和 $N$ 次加法。\n    *   由于必须对所有 $N$ 个 $j$ 值重复此操作，浮点运算的总数与 $N \\times (2N)$ 成正比，即 $O(N^2)$ 数量级。\n\n*   **基于 FFT 的方法**：该计算涉及三个步骤。\n    1.  $\\varepsilon_j$ 的 FFT：标准的 FFT 算法，如 Cooley-Tukey 算法，其计算复杂度为 $O(N \\log N)$。\n    2.  逐点乘法：$\\widehat{\\sigma}_n = \\widehat{b}_n \\widehat{\\varepsilon}_n$。这涉及 $N$ 次复数乘法，是一个 $O(N)$ 的运算。\n    3.  $\\widehat{\\sigma}_n$ 的 IFFT：逆 FFT 与正 FFT 具有相同的复杂度，即 $O(N \\log N)$。\n    *   总复杂度是这些步骤的总和：$O(N \\log N) + O(N) + O(N \\log N) = O(N \\log N)$。\n\n*   **理论加速比**：加速比 $S(N)$ 是较慢算法与较快算法的计算成本之比。\n    $$\n    S(N) = \\frac{\\text{Cost}_{\\text{direct}}}{\\text{Cost}_{\\text{FFT}}} \\approx \\frac{C_1 N^2}{C_2 N \\log N} = \\left(\\frac{C_1}{C_2}\\right) \\frac{N}{\\log N}\n    $$\n    其中 $C_1$ 和 $C_2$ 是与实现相关的常数。渐近地，对于大的 $N$，这些常数变得不那么重要。问题要求使用以 2 为底的对数来计算加速比，这对于常见的 FFT 算法是很自然的：\n    $$\n    S(N) \\approx \\frac{N}{\\log_2 N}\n    $$\n这表明，对于大的 $N$，基于 FFT 的方法比直接卷积显著更高效。\n\n**4. 实现策略**\n\nPython 实现将遵循推导出的算法。对于每个测试用例：\n1. 通过在网格上对给定函数 $\\varepsilon(x)$进行采样，生成离散应变数组 $\\boldsymbol{\\varepsilon}$。\n2. **基于 FFT 的方法**被简洁地实现为：`sigma_fft = np.fft.ifft(np.fft.fft(epsilon) * alpha_hat)`，其中 `alpha_hat` 是谱乘子 $\\widehat{b}_n$ 的数组。\n3. **直接卷积方法**使用嵌套循环来实现，为每个 $\\sigma_j$ 显式计算求和。该方法所需的核 $b_j$ 首先通过 `b = np.fft.ifft(alpha_hat)` 计算得出。\n4. 离散波数计算为 $k_n = \\frac{2\\pi n}{L}$，其中 $n \\in \\{0, \\dots, N-1\\}$。这个非标准范围（未以零为中心）意味着谱乘子数组 `alpha_hat` 将不是共轭对称的。因此，其逆 DFT，即核 `b`，将是复数值的。所以，直接卷积的所有计算都必须在复数算术下进行，以确保与基于 FFT 的方法进行有效比较。\n5. 最大绝对差 `max(abs(sigma_fft - sigma_direct))` 作为误差度量，用以验证两种方法的数值等价性。\n6. 理论加速比 $S(N)$ 使用第 3 部分推导的公式计算。\n\n这个严谨的过程验证了问题的前提，并为获得正确且可验证的解提供了一条清晰的路径。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the nonlocal elasticity problem for the given test cases.\n    It computes nonlocal stress using two methods: direct O(N^2) convolution\n    and an efficient O(N log N) FFT-based method. It then calculates the\n    maximum absolute difference between the results and the theoretical speedup.\n    \"\"\"\n    \n    # Define the strain function ε(x)\n    def strain_func(x):\n        return np.sin(3 * x) + 0.5 * np.cos(5 * x) + 0.2 * np.sin(7 * x)\n\n    # Define the test cases from the problem statement.\n    # Format: (N, L, l, epsilon_func)\n    test_cases = [\n        (64, 2 * np.pi, 0.3, strain_func),\n        (128, 2 * np.pi, 1e-6, strain_func),\n        (96, 2 * np.pi, 0.5, strain_func),\n        (100, 2 * np.pi, 0.2, lambda x: np.full_like(x, 3.7))\n    ]\n\n    results = []\n    \n    for N, L, ell, eps_func in test_cases:\n        # 1. Setup grid and discrete signals\n        # Grid points x_j = j * Delta_x for j=0,...,N-1\n        # Delta_x = L/N\n        # Using endpoint=False ensures periodicity, i.e., x_N = L is not included.\n        x = np.linspace(0, L, N, endpoint=False)\n        \n        # Discrete strain vector epsilon_j = ε(x_j)\n        epsilon = eps_func(x)\n\n        # 2. Define wavenumbers and spectral multiplier\n        # As per problem: k_n = (2*pi/L)*n for n = 0,...,N-1\n        n_indices = np.arange(N)\n        k_n = (2 * np.pi / L) * n_indices\n        \n        # Spectral multiplier for Helmholtz kernel (with E=1)\n        # alpha_hat_n = 1 / (1 + (ell*k_n)^2)\n        alpha_hat = 1.0 / (1.0 + (ell * k_n)**2)\n\n        # 3. FFT-based O(N log N) method\n        # σ_hat = α_hat * ε_hat\n        # σ = IDFT(σ_hat)\n        epsilon_hat = np.fft.fft(epsilon)\n        sigma_hat = alpha_hat * epsilon_hat\n        sigma_fft = np.fft.ifft(sigma_hat)\n\n        # 4. Direct O(N^2) circular convolution method\n        # First, compute the discrete kernel b_j by taking the IDFT of the multiplier\n        # b_j = IDFT(α_hat)_j\n        # The result b will be complex-valued because alpha_hat is not conjugate-symmetric\n        # with the given non-standard definition of k_n.\n        b = np.fft.ifft(alpha_hat)\n        \n        # Initialize the result array for direct convolution\n        sigma_direct = np.zeros(N, dtype=np.complex128)\n        \n        # Perform the explicit O(N^2) circular convolution\n        # σ_j = sum_{m=0}^{N-1} b_{(j-m) mod N} * ε_m\n        for j in range(N):\n            s = 0.0 + 0.0j # Use complex accumulator\n            for m in range(N):\n                # The modulo operator % in Python correctly handles negative results\n                # for the index, mapping them into the range [0, N-1] for positive N.\n                idx = (j - m) % N\n                s += b[idx] * epsilon[m]\n            sigma_direct[j] = s\n\n        # 5. Compute metrics\n        # Maximum absolute difference (absolute error) between the two methods\n        # np.abs computes the magnitude for complex numbers.\n        max_abs_error = np.max(np.abs(sigma_fft - sigma_direct))\n        \n        # Theoretical speedup ratio S(N) = N / log2(N)\n        theoretical_speedup = N / np.log2(N)\n        \n        results.append(max_abs_error)\n        results.append(theoretical_speedup)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2665428"}]}