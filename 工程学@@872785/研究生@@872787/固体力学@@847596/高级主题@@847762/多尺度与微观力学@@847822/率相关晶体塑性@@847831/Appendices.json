{"hands_on_practices": [{"introduction": "滑移的启动并非取决于外加应力的总大小，而是取决于在特定滑移系统上分解的切应力分量。Schmid因子正是量化这一分解效应的关键几何参数。本练习将引导你通过一个基础的推导，找出在所有晶体取向中可能出现的最大Schmid因子，这个推导过程将加深你对分解切应力原理的理解，并揭示滑移激活的纯几何本质。[@problem_id:2678663]", "problem": "一个具有面心立方（FCC）对称性的单晶体在单轴拉伸下变形，其柯西应力状态为 $\\sigma=\\sigma_0\\, e_1\\otimes e_1$，在一个固定的实验室标准正交基 $\\{e_1,e_2,e_3\\}$ 中表示。考虑晶体相对于实验室基底的所有可能取向，并在晶体内考虑所有来自 $\\{111\\}\\langle 110\\rangle$ 族的面心立方滑移系。一个滑移系由单位滑移面法线 $n$ 和位于滑移面内的单位滑移方向 $s$ 来表征，即 $s\\cdot n=0$，$|n|=|s|=1$。法线为 $n$ 的平面上的牵引矢量为 $t=\\sigma\\,n$，该滑移系上的分解剪应力为 $\\tau = t\\cdot s = s\\cdot \\sigma \\, n$。Schmid 因子定义为 $m=\\tau/\\sigma_0$。\n\n仅从这些定义和约束出发，并且不预先假设任何特定的晶体取向，推导在所有晶体取向中取向最有利的 FCC 滑移系的 Schmid 因子的值，并确定相应的最大分解剪应力。您的推导必须清楚地说明为什么在 $s\\cdot n=0$ 和 $|n|=|s|=1$ 的约束下，您的结果是绝对最大值，并且必须阐明为什么当晶体取向可以变化时，FCC 的限制不会降低这个最大值。\n\n将您的最终答案表示为一个单行向量，其中包含：\n- 最大 Schmid 因子 $m_{\\max}$（无量纲），以及\n- 以 $\\sigma_0$ 的符号形式表示的最大分解剪应力 $\\tau_{\\max}$。\n\n不需要数值，也不需要四舍五入。最终的方框答案中不要包含单位；按要求以 $\\sigma_0$ 的符号形式表示 $\\tau_{\\max}$。如果您引入任何角度，请说明它们是以弧度还是度为单位；但是，您的最终答案不得包含角度。", "solution": "该问题要求在单轴拉伸条件下，考虑所有可能的晶体取向和所有可用的滑移系，推导面心立方（FCC）晶体的最大可能 Schmid 因子。\n\n首先，我们根据所给的定义将问题形式化。沿单位矢量 $e_1$ 方向的单轴拉伸的柯西应力张量由 $\\sigma = \\sigma_0 e_1 \\otimes e_1$ 给出，其中对于拉伸，$\\sigma_0 > 0$。一个滑移系由一对正交的单位矢量定义：滑移面单位法线 $n$ 和位于滑移面内的滑移方向单位矢量 $s$。这些矢量受约束 $|n|=1$、 $|s|=1$ 和 $s \\cdot n = 0$。\n\n该滑移系上的分解剪应力 $\\tau$ 定义为牵引矢量 $t=\\sigma n$ 在滑移方向 $s$ 上的投影。\n$$ \\tau = s \\cdot t = s \\cdot (\\sigma n) $$\n代入应力张量 $\\sigma$ 的表达式：\n$$ \\tau = s \\cdot ((\\sigma_0 e_1 \\otimes e_1) n) $$\n使用张量积的性质 $(a \\otimes b) c = (b \\cdot c) a$，我们有：\n$$ (\\sigma_0 e_1 \\otimes e_1) n = \\sigma_0 (e_1 \\cdot n) e_1 $$\n将此代回 $\\tau$ 的表达式中，得到：\n$$ \\tau = s \\cdot (\\sigma_0 (e_1 \\cdot n) e_1) = \\sigma_0 (s \\cdot e_1) (n \\cdot e_1) $$\nSchmid 因子 $m$ 定义为 $m = \\tau / \\sigma_0$，因此：\n$$ m = (s \\cdot e_1) (n \\cdot e_1) $$\n为了找到最大 Schmid 因子，我们必须在约束条件 $|n|=1$、 $|s|=1$ 和 $s \\cdot n = 0$ 下，对滑移系矢量 $n$ 和 $s$ 的所有可能取向最大化此表达式。问题陈述我们必须考虑所有可能的晶体取向。这意味着，只要存在一个相应的晶体取向，能够使其某个内禀滑移系与此空间取向对齐，那么矢量对 $(n, s)$ 就可以在空间中采取任何取向。我们将首先解决这个一般的几何优化问题，然后验证其对于 FCC 晶体是否可实现。\n\n设 $\\phi$ 为拉伸轴 $e_1$ 与滑移面法线 $n$ 之间的夹角，$\\lambda$ 为 $e_1$ 与滑移方向 $s$ 之间的夹角。两个角度均以弧度度量。由于 $e_1$、$n$ 和 $s$ 都是单位矢量，我们有：\n$$ n \\cdot e_1 = |n| |e_1| \\cos\\phi = \\cos\\phi $$\n$$ s \\cdot e_1 = |s| |e_1| \\cos\\lambda = \\cos\\lambda $$\nSchmid 因子于是为 $m = \\cos\\phi \\cos\\lambda$。我们的任务是在约束 $s \\cdot n = 0$ 下最大化此函数。\n\n让我们固定矢量 $n$（从而固定角度 $\\phi$）。现在我们必须找到使 $m$ 最大化的矢量 $s$ 的取向。矢量 $s$ 必须是位于垂直于 $n$ 的平面内的单位矢量。我们希望最大化项 $s \\cdot e_1 = \\cos\\lambda$。从几何上看，当 $s$ 的选择尽可能与 $e_1$ 对齐时，该项达到最大值。矢量 $s$ 被约束在滑移面内。因此，$s$ 的最优选择是滑移面内与拉伸轴 $e_1$ 在该平面上的投影对齐的单位矢量。\n\n我们将 $e_1$ 在滑移面上的投影记为 $e_{1,proj}$。该投影由 $e_{1,proj} = e_1 - (e_1 \\cdot n) n$ 给出。最优滑移方向 $s$ 与此投影平行：$s = \\frac{e_{1,proj}}{|e_{1,proj}|}$。投影的模长为 $|e_{1,proj}| = \\sqrt{|e_1|^2 - (e_1 \\cdot n)^2} = \\sqrt{1 - \\cos^2\\phi} = |\\sin\\phi|$。假设 $\\phi \\in [0, \\pi/2]$，则模长为 $\\sin\\phi$。对于 $s$ 的这个最优选择，三个矢量 $e_1$、 $n$ 和 $s$ 共面。$s$ 和 $n$ 之间的夹角是 $\\pi/2$。$e_1$ 和 $n$ 之间的夹角是 $\\phi$。因此，$e_1$ 和 $s$ 之间的夹角 $\\lambda$ 必须是 $\\lambda = |\\pi/2 - \\phi|$。对于 $\\phi \\in [0, \\pi/2]$，这便是 $\\lambda = \\pi/2 - \\phi$。\n\n利用这个关系，我们可以将 Schmid 因子表示为单个变量 $\\phi$ 的函数：\n$$ m(\\phi) = \\cos\\phi \\cos(\\pi/2 - \\phi) = \\cos\\phi \\sin\\phi $$\n为了找到 $m(\\phi)$ 的最大值，我们可以将其改写为 $m(\\phi) = \\frac{1}{2} \\sin(2\\phi)$。正弦函数的最大值为 1。因此，当 $\\sin(2\\phi) = 1$ 时，$m$ 达到最大值。这发生在 $2\\phi = \\pi/2$ 时，即 $\\phi = \\pi/4$。\n在这个最佳角度下，Schmid 因子的值为：\n$$ m_{\\max} = \\frac{1}{2} \\sin(2 \\cdot \\pi/4) = \\frac{1}{2} \\sin(\\pi/2) = \\frac{1}{2} $$\n相应的角度 $\\lambda$ 是 $\\lambda = \\pi/2 - \\phi = \\pi/2 - \\pi/4 = \\pi/4$。这表明，在纯粹的几何约束下，Schmid 因子的绝对最大值为 $1/2$。当拉伸轴与滑移面法线和滑移方向的夹角均为 $\\pi/4$ 弧度（$45^\\circ$）时，达到此最大值。\n\n现在，我们必须阐明为什么对于 FCC 晶体可以达到这个最大值。FCC 晶体中的滑移系属于 $\\{111\\}\\langle 110\\rangle$ 族。晶体取向可以变化这一事实意味着我们可以相对于固定的拉伸轴 $e_1$ 以任何方式取向晶格。这等效于固定晶格轴，并在晶体坐标系中寻找一个拉伸轴方向 $T_{cryst}$，使得对于晶体的某个内禀滑移系，满足最大 Schmid 因子的几何条件。\n\n我们选择一个特定的 FCC 滑移系。例如，平面 $(111)$ 和方向 $[\\bar{1}10]$。在晶体的标准正交基中，相应的单位矢量为：\n$$ n_{cryst} = \\frac{1}{\\sqrt{3}}(1, 1, 1) $$\n$$ s_{cryst} = \\frac{1}{\\sqrt{2}}(-1, 1, 0) $$\n可以验证 $n_{cryst} \\cdot s_{cryst} = 0$。设此晶体坐标系中的拉伸轴为 $T_{cryst} = (t_1, t_2, t_3)$，它必须是一个单位矢量，因此 $t_1^2 + t_2^2 + t_3^2 = 1$。为了使 Schmid 因子最大化，我们要求角度 $\\phi$ 和 $\\lambda$ 均为 $\\pi/4$。这转化为以下条件：\n$$ n_{cryst} \\cdot T_{cryst} = \\cos(\\pi/4) = \\frac{1}{\\sqrt{2}} $$\n$$ s_{cryst} \\cdot T_{cryst} = \\cos(\\pi/4) = \\frac{1}{\\sqrt{2}} $$\n代入 $n_{cryst}$ 和 $s_{cryst}$ 的表达式：\n$$ \\frac{1}{\\sqrt{3}}(t_1 + t_2 + t_3) = \\frac{1}{\\sqrt{2}} \\implies t_1 + t_2 + t_3 = \\sqrt{\\frac{3}{2}} $$\n$$ \\frac{1}{\\sqrt{2}}(-t_1 + t_2) = \\frac{1}{\\sqrt{2}} \\implies -t_1 + t_2 = 1 $$\n我们现在有一个包含三个未知数 $t_1, t_2, t_3$ 的三元方程组。如在思考过程中所示，该方程组对于 $(t_1, t_2, t_3)$ 有唯一的实数解，该解满足单位矢量约束 $t_1^2 + t_2^2 + t_3^2 = 1$。这样一个方向 $T_{cryst}$ 的存在证明了，可以相对于拉伸轴取向一个 FCC 晶体，使得其某个滑移系经受可能的最大分解剪应力。\n\n因此，对 FCC 滑移系的限制并没有将其可实现的最大 Schmid 因子从其绝对几何极限 $1/2$ 降低，因为改变晶体取向的自由度足以满足最佳几何条件。\n\n最大 Schmid 因子为 $m_{\\max} = 1/2$。相应的最大分解剪应力 $\\tau_{\\max}$ 从其定义中获得：\n$$ \\tau_{\\max} = m_{\\max} \\sigma_0 = \\frac{1}{2} \\sigma_0 $$\n\n最终答案由最大 Schmid 因子 $m_{\\max}$ 和最大分解剪应力 $\\tau_{\\max}$ 组成。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{1}{2}  \\frac{\\sigma_0}{2} \\end{pmatrix} } $$", "id": "2678663"}, {"introduction": "滑移激活后，材料对进一步滑移的抵抗力通常会增加，这一现象称为硬化。本练习探讨如何将一个描述硬化过程的微分方程（Voce硬化定律）转化为宏观的应力-应变曲线。这个练习建立在分解切应力的概念之上，展示了如何通过积分本构关系来预测材料在塑性变形过程中的力学行为，从而连接微观的硬化机制与宏观的材料响应。[@problem_id:2891016]", "problem": "一个单晶体承受小应变简单剪切，其给定的工程剪切应变历史为 $ \\gamma \\ge 0 $。假设只有一个滑移系被激活，其滑移方向和滑移面法向的取向使得分解剪应力等于宏观剪应力。该晶体是弹性各向同性的，剪切模量为 $ \\mu  0 $。塑性运动学由单一滑移变量 $ \\gamma^{p} $ 描述，因此有 $ \\gamma = \\gamma^{e} + \\gamma^{p} $，弹性剪切应力为 $ \\tau = \\mu \\gamma^{e} $。采用率无关的单调加载方案，剪切为正，加载方向不反转。流动法则是标准的率无关晶体塑性条件：在塑性流动期间，分解剪应力等于当前的临界分解剪应力，即 $ \\tau = g $，其中 $ g $ 是演化的滑移抗力。\n\n硬化定律为 Voce 型：滑移抗力 $ g $ 随累积塑性滑移的变化遵循以下常微分方程：\n$$\n\\frac{d g}{d \\gamma^{p}} = h_{0} \\left( 1 - \\frac{g}{\\tau_{s}} \\right),\n$$\n初始条件为 $ g(0) = g_{0} $，初始硬化模量为 $ h_{0}  0 $，饱和抗力为 $ \\tau_{s}  g_{0}  0 $。您可以假设由于所选的取向，Schmid 因子等于 $ 1 $，因此分解剪应力等于单一的非零宏观剪应力分量。\n\n仅使用上述原理和定义，推导屈服后剪应力 $ \\tau $ 作为施加的工程剪切应变 $ \\gamma $ 的函数的闭式解析表达式，其中 $ \\gamma \\ge \\gamma_{y} $，$ \\gamma_{y} $ 为塑性起始点。如有必要，请用包含标准特殊函数的闭式形式表示您最终的 $ \\tau(\\gamma) $。然后，确定 (i) 饱和剪应力 和 (ii) 特征塑性剪切应变，该特征塑性剪切应变定义为当 $ g(\\gamma^{p}) $ 从 $ g_{0} $ 到 $ \\tau_{s} $ 的总渐近增量达到比例 $ 1 - \\exp(-1) $ 时 $ \\gamma^{p} $ 的值。\n\n请将您的最终答案以单行矩阵的形式提供，其中按顺序包含以下三个条目：在屈服后状态下有效的 $ \\tau(\\gamma) $、饱和应力以及特征塑性剪切应变。无需进行数值计算；请给出符号化的闭式表达式。不要在最终的方框表达式中包含单位。如果您选择使用任何特殊函数，请在推导过程中明确指出。", "solution": "任务是推导屈服后的应力-应变响应 $ \\tau(\\gamma) $，确定饱和应力，并找到特征塑性应变。\n\n首先，我们求解关于滑移系抗力 $ g $ 作为累积塑性滑移 $ \\gamma^p $ 的函数的常微分方程。硬化定律由下式给出：\n$$\n\\frac{d g}{d \\gamma^{p}} = h_{0} \\left( 1 - \\frac{g}{\\tau_{s}} \\right)\n$$\n这是一个一阶线性微分方程，也是可分离变量的。我们重新整理各项以分离变量 $ g $ 和 $ \\gamma^p $：\n$$\n\\frac{dg}{\\tau_s - g} = \\frac{h_0}{\\tau_s} d\\gamma^p\n$$\n我们对该方程从初始状态（$ \\gamma^p = 0 $, $ g = g_0 $）积分到一个一般状态（$ \\gamma^p $, $ g $）：\n$$\n\\int_{g_0}^{g} \\frac{d\\tilde{g}}{\\tau_s - \\tilde{g}} = \\int_0^{\\gamma^p} \\frac{h_0}{\\tau_s} d\\tilde{\\gamma}^p\n$$\n左侧积分计算结果为：\n$$\n\\left[ -\\ln(\\tau_s - \\tilde{g}) \\right]_{g_0}^{g} = -\\ln(\\tau_s - g) + \\ln(\\tau_s - g_0) = \\ln\\left(\\frac{\\tau_s - g_0}{\\tau_s - g}\\right)\n$$\n右侧积分很简单：\n$$\n\\frac{h_0}{\\tau_s} \\left[ \\tilde{\\gamma}^p \\right]_0^{\\gamma^p} = \\frac{h_0}{\\tau_s} \\gamma^p\n$$\n令两边结果相等，得到：\n$$\n\\ln\\left(\\frac{\\tau_s - g_0}{\\tau_s - g}\\right) = \\frac{h_0}{\\tau_s} \\gamma^p\n$$\n我们通过对两边取指数来求解 $ g $：\n$$\n\\frac{\\tau_s - g_0}{\\tau_s - g} = \\exp\\left(\\frac{h_0}{\\tau_s} \\gamma^p\\right)\n$$\n$$\n\\tau_s - g = (\\tau_s - g_0) \\exp\\left(-\\frac{h_0}{\\tau_s} \\gamma^p\\right)\n$$\n这得到了滑移抗力作为塑性滑移函数的表达式：\n$$\ng(\\gamma^p) = \\tau_s - (\\tau_s - g_0) \\exp\\left(-\\frac{h_0}{\\tau_s} \\gamma^p\\right)\n$$\n这个方程描述了材料强度的演化。\n\n接下来，我们推导屈服后阶段（$ \\gamma \\ge \\gamma_y $）的宏观应力-应变响应 $ \\tau(\\gamma) $。在此阶段，发生塑性流动，因此流动法则 $ \\tau = g $ 生效。我们将其与运动学和弹性关系结合起来。\n总剪切应变为 $ \\gamma = \\gamma^e + \\gamma^p $。弹性剪切应变由 $ \\gamma^e = \\tau / \\mu $ 给出。因此，塑性滑移可以表示为：\n$$\n\\gamma^p = \\gamma - \\gamma^e = \\gamma - \\frac{\\tau}{\\mu}\n$$\n将 $ \\gamma^p $ 的这个表达式以及 $ \\tau = g $ 代入硬化演化方程，我们得到一个关于 $ \\tau $ 作为 $ \\gamma $ 的函数的单一隐式方程：\n$$\n\\tau = \\tau_s - (\\tau_s - g_0) \\exp\\left[ -\\frac{h_0}{\\tau_s} \\left(\\gamma - \\frac{\\tau}{\\mu}\\right) \\right]\n$$\n为了找到 $ \\tau(\\gamma) $ 的显式表达式，我们必须解这个超越方程。我们重新整理各项：\n$$\n\\tau_s - \\tau = (\\tau_s - g_0) \\exp\\left(-\\frac{h_0}{\\tau_s}\\gamma\\right) \\exp\\left(\\frac{h_0}{\\tau_s \\mu}\\tau\\right)\n$$\n$$\n(\\tau_s - \\tau) \\exp\\left(-\\frac{h_0}{\\tau_s \\mu}\\tau\\right) = (\\tau_s - g_0) \\exp\\left(-\\frac{h_0}{\\tau_s}\\gamma\\right)\n$$\n为了将其转化为可以用 Lambert W 函数（$z \\exp(z) = c$）求解的形式，我们进行变量替换。令 $ u = \\tau_s - \\tau $，这意味着 $ \\tau = \\tau_s - u $。将其代入方程：\n$$\nu \\exp\\left[-\\frac{h_0}{\\tau_s \\mu}(\\tau_s - u)\\right] = (\\tau_s - g_0) \\exp\\left(-\\frac{h_0}{\\tau_s}\\gamma\\right)\n$$\n$$\nu \\exp\\left(-\\frac{h_0}{\\mu}\\right) \\exp\\left(\\frac{h_0 u}{\\tau_s \\mu}\\right) = (\\tau_s - g_0) \\exp\\left(-\\frac{h_0}{\\tau_s}\\gamma\\right)\n$$\n$$\nu \\exp\\left(\\frac{h_0 u}{\\tau_s \\mu}\\right) = (\\tau_s - g_0) \\exp\\left(\\frac{h_0}{\\mu} - \\frac{h_0}{\\tau_s}\\gamma\\right)\n$$\n现在，令 $z = \\frac{h_0 u}{\\tau_s \\mu}$。则 $u = \\frac{\\tau_s \\mu}{h_0} z$。代入 $u$：\n$$\n\\left(\\frac{\\tau_s \\mu}{h_0} z\\right) \\exp(z) = (\\tau_s - g_0) \\exp\\left(\\frac{h_0}{\\mu} - \\frac{h_0 \\gamma}{\\tau_s}\\right)\n$$\n$$\nz \\exp(z) = \\frac{h_0 (\\tau_s - g_0)}{\\tau_s \\mu} \\exp\\left(\\frac{h_0}{\\mu} - \\frac{h_0 \\gamma}{\\tau_s}\\right)\n$$\n形如 $ z \\exp(z) = c $ 的方程的解是 $ z = W(c) $，其中 $ W $ 是 Lambert W 函数。因此：\n$$\nz = W\\left( \\frac{h_0 (\\tau_s - g_0)}{\\tau_s \\mu} \\exp\\left(\\frac{h_0}{\\mu} - \\frac{h_0 \\gamma}{\\tau_s}\\right) \\right)\n$$\n将 $ z = \\frac{h_0 u}{\\tau_s \\mu} $ 和 $ u = \\tau_s - \\tau $ 代回：\n$$\n\\frac{h_0 (\\tau_s - \\tau)}{\\tau_s \\mu} = W\\left( \\frac{h_0 (\\tau_s - g_0)}{\\tau_s \\mu} \\exp\\left(\\frac{h_0}{\\mu} - \\frac{h_0 \\gamma}{\\tau_s}\\right) \\right)\n$$\n最后，求解 $ \\tau(\\gamma) $：\n$$\n\\tau_s - \\tau = \\frac{\\tau_s \\mu}{h_0} W\\left( \\frac{h_0 (\\tau_s - g_0)}{\\tau_s \\mu} \\exp\\left(\\frac{h_0}{\\mu} - \\frac{h_0 \\gamma}{\\tau_s}\\right) \\right)\n$$\n$$\n\\tau(\\gamma) = \\tau_s - \\frac{\\tau_s \\mu}{h_0} W\\left( \\frac{h_0 (\\tau_s - g_0)}{\\tau_s \\mu} \\exp\\left(\\frac{h_0}{\\mu} - \\frac{h_0 \\gamma}{\\tau_s}\\right) \\right)\n$$\n这就是所求的屈服后剪应力作为施加的剪切应变的函数的闭式表达式。\n\n第二，我们确定饱和剪应力。这是当 $ \\gamma \\to \\infty $ 时的应力。在 $ g(\\gamma^p) $ 的表达式中，当 $ \\gamma^p \\to \\infty $ 时，指数项消失：\n$$\n\\lim_{\\gamma^p \\to \\infty} g(\\gamma^p) = \\lim_{\\gamma^p \\to \\infty} \\left[ \\tau_s - (\\tau_s - g_0) \\exp\\left(-\\frac{h_0}{\\tau_s} \\gamma^p\\right) \\right] = \\tau_s\n$$\n由于在塑性流动期间 $ \\tau = g $，饱和应力就是 $ \\tau_s $。\n\n第三，我们确定特征塑性剪切应变，记为 $ \\gamma^p_{char} $。它被定义为当滑移抗力 $ g $ 从 $ g_0 $ 到 $ \\tau_s $ 的总可能增量达到比例 $ 1 - \\exp(-1) $ 时 $ \\gamma^p $ 的值。\n总增量为 $ \\Delta g_{total} = \\tau_s - g_0 $。\n在给定 $ \\gamma^p $ 时的增量为 $ \\Delta g(\\gamma^p) = g(\\gamma^p) - g_0 $。\n使用 $ g(\\gamma^p) $ 的表达式：\n$$\ng(\\gamma^p) - g_0 = \\left[\\tau_s - (\\tau_s - g_0) \\exp\\left(-\\frac{h_0}{\\tau_s} \\gamma^p\\right)\\right] - g_0 = (\\tau_s - g_0) \\left[1 - \\exp\\left(-\\frac{h_0}{\\tau_s} \\gamma^p\\right)\\right]\n$$\n增量的比例为：\n$$\n\\frac{\\Delta g(\\gamma^p)}{\\Delta g_{total}} = \\frac{(\\tau_s - g_0) \\left[1 - \\exp\\left(-\\frac{h_0}{\\tau_s} \\gamma^p\\right)\\right]}{\\tau_s - g_0} = 1 - \\exp\\left(-\\frac{h_0}{\\tau_s} \\gamma^p\\right)\n$$\n我们将这个比例设为指定值 $ 1 - \\exp(-1) $：\n$$\n1 - \\exp\\left(-\\frac{h_0}{\\tau_s} \\gamma^p_{char}\\right) = 1 - \\exp(-1)\n$$\n由此可见：\n$$\n\\exp\\left(-\\frac{h_0}{\\tau_s} \\gamma^p_{char}\\right) = \\exp(-1)\n$$\n对两边取自然对数：\n$$\n-\\frac{h_0}{\\tau_s} \\gamma^p_{char} = -1\n$$\n求解 $ \\gamma^p_{char} $：\n$$\n\\gamma^p_{char} = \\frac{\\tau_s}{h_0}\n$$\n三个所需的量已经推导出来。它们现在将在最终答案中呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\tau_s - \\frac{\\tau_s \\mu}{h_0} W\\left( \\frac{h_0(\\tau_s - g_0)}{\\tau_s \\mu} \\exp\\left(\\frac{h_0}{\\mu} - \\frac{h_0}{\\tau_s} \\gamma\\right) \\right)  \\tau_s  \\frac{\\tau_s}{h_0} \\end{pmatrix}}\n$$", "id": "2891016"}, {"introduction": "现代晶体塑性研究在很大程度上依赖于数值模拟，以处理多滑移系统相互作用和晶格取向演化的复杂性。作为本章的收尾，这个高级实践将指导你完成一个小型计算模型的关键步骤。你将推导并实现一个稳健的牛顿法求解器所需的一致性雅可比矩阵，这对于确保计算的二次收敛至关重要。这个练习综合了运动学、弹性和塑性概念，是理论知识向实用计算工具转化的集中体现。[@problem_id:2678640]", "problem": "考虑一个二维晶体在单个材料点的小应变、平面应变、率相关晶体塑性更新，该晶体具有两个滑移系。目的是推导、实现并使用一个滑移增量的非线性残差的一致线性化（雅可比矩阵），该线性化包含晶格取向更新对滑移增量的依赖性，从而使牛顿迭代达到二次收敛。\n\n从以下基本原理和定义出发。\n\n- 运动学与弹性力学：\n  - 小应变张量为 $ \\varepsilon_{ij} = \\frac{1}{2} \\left( u_{i,j} + u_{j,i} \\right) $，其中 $ u_i $ 是位移场。\n  - 小应变加法分解为 $ \\varepsilon_{ij} = \\varepsilon^{\\mathrm{e}}_{ij} + \\varepsilon^{\\mathrm{p}}_{ij} $，其中 $ \\varepsilon^{\\mathrm{e}}_{ij} $ 是弹性应变，$ \\varepsilon^{\\mathrm{p}}_{ij} $ 是塑性应变。\n  - 各向同性线弹性（拉梅形式）将柯西应力 $ \\sigma_{ij} $ 与弹性应变 $ \\varepsilon^{\\mathrm{e}}_{ij} $ 相关联，表达式为 $ \\sigma_{ij} = \\lambda \\, \\mathrm{tr}(\\varepsilon^{\\mathrm{e}}) \\, \\delta_{ij} + 2 \\mu \\, \\varepsilon^{\\mathrm{e}}_{ij} $，其中 $ \\lambda $ 和 $ \\mu $ 是拉梅常数，由杨氏模量 $ E $ 和泊松比 $ \\nu $ 通过 $ \\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)} $ 和 $ \\mu = \\dfrac{E}{2(1+\\nu)} $ 确定。假设为平面应变，因此上述三维关系在 $ \\varepsilon_{zz} = 0 $ 的条件下适用。\n\n- 滑移系与施密特张量：\n  - 晶体有两个滑移系，索引为 $ \\alpha \\in \\{1,2\\} $。\n  - 在晶格坐标系中，每个滑移系有一个滑移方向 $ \\mathbf{s}^{(0)}_\\alpha \\in \\mathbb{R}^2 $ 和一个滑移面法线 $ \\mathbf{m}^{(0)}_\\alpha \\in \\mathbb{R}^2 $，它们是标准正交的，即 $ \\mathbf{s}^{(0)}_\\alpha \\cdot \\mathbf{m}^{(0)}_\\alpha = 0 $ 且 $ \\|\\mathbf{s}^{(0)}_\\alpha\\| = \\|\\mathbf{m}^{(0)}_\\alpha\\| = 1 $。\n  - 样品坐标系中的晶格取向由单个平面内角度 $ \\theta \\in \\mathbb{R} $ 参数化，其旋转矩阵为 $ \\mathbf{R}(\\theta) \\in \\mathbb{R}^{2 \\times 2} $。当前的滑移方向和法线为 $ \\mathbf{s}_\\alpha(\\theta) = \\mathbf{R}(\\theta) \\, \\mathbf{s}^{(0)}_\\alpha $ 和 $ \\mathbf{m}_\\alpha(\\theta) = \\mathbf{R}(\\theta) \\, \\mathbf{m}^{(0)}_\\alpha $。\n  - 对称施密特张量为 $ \\mathbf{S}_\\alpha(\\theta) = \\dfrac{1}{2} \\left( \\mathbf{s}_\\alpha(\\theta) \\otimes \\mathbf{m}_\\alpha(\\theta) + \\mathbf{m}_\\alpha(\\theta) \\otimes \\mathbf{s}_\\alpha(\\theta) \\right) $，塑性应变为 $ \\varepsilon^{\\mathrm{p}} = \\sum_{\\alpha=1}^{2} \\gamma_\\alpha \\, \\mathbf{S}_\\alpha(\\theta) $，其中 $ \\gamma_\\alpha $ 是当前时间步内的滑移增量（无量纲）。\n\n- 分解剪应力与流动法则：\n  - 滑移系 $ \\alpha $ 上的分解剪应力为 $ \\tau_\\alpha = \\mathbf{S}_\\alpha(\\theta) : \\sigma $，其中 $ A : B = \\sum_{i,j} A_{ij} B_{ij} $。\n  - 滑移系 $ \\alpha $ 的率相关流动法则（幂律）为 $ \\dot{\\gamma}_\\alpha = \\gamma_0 \\left( \\dfrac{|\\tau_\\alpha|}{g} \\right)^n \\mathrm{sign}(\\tau_\\alpha) $，其中 $ \\gamma_0  0 $ 是参考滑移率，$ n \\ge 1 $ 是应变率敏感性指数，$ g $ 是滑移抗力（硬化）。\n  - 使用各向同性硬化：$ g = g_0 + h \\sum_{\\alpha=1}^{2} |\\gamma_\\alpha^{\\mathrm{acc}}| $，其中 $ g_0  0 $ 是初始滑移抗力，$ h \\ge 0 $ 是硬化模量，$ \\gamma_\\alpha^{\\mathrm{acc}} $ 是累积滑移。在单个后向欧拉步中，若先前的累积滑移为零，则可使用 $ g = g_0 + h \\sum_{\\alpha=1}^{2} |\\gamma_\\alpha| $。\n\n- 隐式时间积分与残差：\n  - 在大小为 $ \\Delta t  0 $ 的时间步上使用后向欧拉法，滑移增量 $ \\gamma_\\alpha $ 满足残差方程 $ R_\\alpha(\\boldsymbol{\\gamma}) = \\gamma_\\alpha - \\Delta t \\, \\gamma_0 \\left( \\dfrac{|\\tau_\\alpha(\\boldsymbol{\\gamma})|}{g(\\boldsymbol{\\gamma})} \\right)^n \\mathrm{sign}(\\tau_\\alpha(\\boldsymbol{\\gamma})) = 0 $，其中 $ \\alpha \\in \\{1,2\\} $。这里 $ \\boldsymbol{\\gamma} = [\\gamma_1,\\gamma_2]^T $。\n\n- 塑性自旋驱动的取向更新：\n  - 用 $ \\mathbf{J} = \\begin{bmatrix} 0  -1 \\\\ 1  0 \\end{bmatrix} $ 表示平面内旋转 $ \\pi/2 $ 的矩阵。滑移系 $ \\alpha $ 的塑性自旋贡献的反对称部分为 $ \\mathbf{A}_\\alpha(\\theta) = \\dfrac{1}{2} \\left( \\mathbf{s}_\\alpha(\\theta) \\otimes \\mathbf{m}_\\alpha(\\theta) - \\mathbf{m}_\\alpha(\\theta) \\otimes \\mathbf{s}_\\alpha(\\theta) \\right) $，其标量自旋大小为 $ a_\\alpha(\\theta) = \\dfrac{1}{2} \\left( s_{\\alpha x}(\\theta) m_{\\alpha y}(\\theta) - s_{\\alpha y}(\\theta) m_{\\alpha x}(\\theta) \\right) $。\n  - 在小增量且忽略宏观自旋的情况下，将步内的晶格取向更新近似为 $ \\theta = \\theta_0 - \\sum_{\\alpha=1}^{2} \\gamma_\\alpha \\, a_\\alpha(\\theta_0) $，其中 $ \\theta_0 $ 是步初的初始取向，$ a_\\alpha(\\theta_0) $ 在 $ \\theta_0 $ 处计算。这给出了 $ \\dfrac{\\partial \\theta}{\\partial \\gamma_\\beta} = - a_\\beta(\\theta_0) $。\n\n您的任务是：\n\n1) 推导。推导残差向量 $ \\mathbf{R}(\\boldsymbol{\\gamma}) = [R_1(\\boldsymbol{\\gamma}), R_2(\\boldsymbol{\\gamma})]^T $ 关于 $ \\boldsymbol{\\gamma} $ 的一致线性化。您必须明确包含施密特张量 $ \\mathbf{S}_\\alpha(\\theta) $ 和塑性应变基底 $ \\mathbf{S}_\\alpha(\\theta) $ 对取向角 $ \\theta $ 的依赖性，以及 $ \\theta $ 通过 $ \\theta = \\theta_0 - \\sum_{\\alpha=1}^{2} \\gamma_\\alpha \\, a_\\alpha(\\theta_0) $ 对 $ \\boldsymbol{\\gamma} $ 的依赖性。从以下各式出发，用基本的链式法则运算来表达您的推导：\n- $ \\varepsilon^{\\mathrm{e}}(\\boldsymbol{\\gamma}) = \\varepsilon - \\sum_{\\mu=1}^{2} \\gamma_\\mu \\, \\mathbf{S}_\\mu(\\theta(\\boldsymbol{\\gamma})) $,\n- $ \\sigma(\\boldsymbol{\\gamma}) = \\lambda \\, \\mathrm{tr}(\\varepsilon^{\\mathrm{e}}(\\boldsymbol{\\gamma})) \\, \\mathbf{I} + 2 \\mu \\, \\varepsilon^{\\mathrm{e}}(\\boldsymbol{\\gamma}) $,\n- $ \\tau_\\alpha(\\boldsymbol{\\gamma}) = \\mathbf{S}_\\alpha(\\theta(\\boldsymbol{\\gamma})) : \\sigma(\\boldsymbol{\\gamma}) $,\n- $ R_\\alpha(\\boldsymbol{\\gamma}) = \\gamma_\\alpha - \\Delta t \\, \\gamma_0 \\left( \\dfrac{|\\tau_\\alpha(\\boldsymbol{\\gamma})|}{g(\\boldsymbol{\\gamma})} \\right)^n \\mathrm{sign}(\\tau_\\alpha(\\boldsymbol{\\gamma})) $,\n- $ g(\\boldsymbol{\\gamma}) = g_0 + h \\sum_{\\mu=1}^{2} |\\gamma_\\mu| $,\n以及导数\n- $ \\dfrac{\\partial \\mathbf{S}_\\alpha}{\\partial \\theta} = \\dfrac{1}{2} \\left( (\\mathbf{J} \\mathbf{s}_\\alpha) \\otimes \\mathbf{m}_\\alpha + \\mathbf{s}_\\alpha \\otimes (\\mathbf{J} \\mathbf{m}_\\alpha) + \\mathrm{transpose} \\right) $,\n- $ \\dfrac{\\partial \\theta}{\\partial \\gamma_\\beta} = - a_\\beta(\\theta_0) $。\n提供将在牛顿法中使用的雅可比矩阵项 $ \\dfrac{\\partial R_\\alpha}{\\partial \\gamma_\\beta} $ 的显式表达式。\n\n2) 实现。实现一个程序，该程序：\n- 以给定的材料参数 $ E $（单位：帕斯卡）、$ \\nu $（无量纲）、$ g_0 $（单位：帕斯卡）、$ h $（单位：帕斯卡）、$ \\gamma_0 $（单位：$ \\mathrm{s}^{-1} $）、$ n $（无量纲）和时间步长 $ \\Delta t $（单位：秒）为输入。\n- 在晶格坐标系中使用两个标准正交滑移系：\n  - 滑移系 $ 1 $：$ \\mathbf{s}^{(0)}_1 = [1, 0]^T $，$ \\mathbf{m}^{(0)}_1 = [0, 1]^T $。\n  - 滑移系 $ 2 $：$ \\mathbf{s}^{(0)}_2 = \\left[ \\dfrac{1}{\\sqrt{2}}, \\dfrac{1}{\\sqrt{2}} \\right]^T $，$ \\mathbf{m}^{(0)}_2 = \\left[ -\\dfrac{1}{\\sqrt{2}}, \\dfrac{1}{\\sqrt{2}} \\right]^T $。\n- 给定初始取向 $ \\theta_0 $（单位：弧度）和给定的总对称应变增量 $ \\varepsilon $（一个 $ 2 \\times 2 $ 对称张量，无量纲），使用您推导的一致雅可比矩阵（包括如上所述的 $ \\theta $ 对 $ \\boldsymbol{\\gamma} $ 的依赖性），通过牛顿法求解非线性系统 $ \\mathbf{R}(\\boldsymbol{\\gamma}) = \\mathbf{0} $ 以得到滑移增量 $ \\boldsymbol{\\gamma} \\in \\mathbb{R}^2 $。\n- 使用上述定义的各向同性弹性来计算 $ \\sigma(\\boldsymbol{\\gamma}) $。\n- 收敛后，计算更新后的取向 $ \\theta = \\theta_0 - \\sum_{\\alpha=1}^{2} \\gamma_\\alpha \\, a_\\alpha(\\theta_0) $。\n\n3) 输出。对于每个测试案例，输出一个由 $ \\gamma_1 $、$ \\gamma_2 $ 和更新后的 $ \\theta $（单位：弧度）组成的三元组。最终程序输出必须是单行，包含所有测试案例的结果，按顺序展平为一个列表 $ [\\gamma_1^{(1)}, \\gamma_2^{(1)}, \\theta^{(1)}, \\gamma_1^{(2)}, \\gamma_2^{(2)}, \\theta^{(2)}, \\gamma_1^{(3)}, \\gamma_2^{(3)}, \\theta^{(3)}] $，每个浮点数四舍五入到六位小数。\n\n物理单位和数值细节：\n- $ E $ 和 $ g_0, h $ 以帕斯卡（$ \\mathrm{Pa} $）表示，$ \\Delta t $ 以秒（$ \\mathrm{s} $）表示，角度以弧度表示，应变为无量纲。\n- 使用 $ \\mathrm{sign}(x) = \\begin{cases} 1,  x  0 \\\\ 0,  x = 0 \\\\ -1,  x  0 \\end{cases} $，并在每次牛顿迭代中形成雅可比矩阵时，将 $ \\mathrm{sign}(\\tau_\\alpha) $ 和 $ \\mathrm{sign}(\\gamma_\\alpha) $ 视为冻结（不变）。\n- 程序不得读取任何输入，并且必须仅按规定打印最终的单行列表。\n\n测试套件：\n- 案例 $ 1 $（正常路径，中等剪切）：\n  - $ E = 70 \\times 10^9 \\, \\mathrm{Pa} $，$ \\nu = 0.33 $，$ g_0 = 50 \\times 10^6 \\, \\mathrm{Pa} $，$ h = 400 \\times 10^6 \\, \\mathrm{Pa} $，$ \\gamma_0 = 1.0 \\, \\mathrm{s}^{-1} $，$ n = 10 $，$ \\Delta t = 0.01 \\, \\mathrm{s} $，$ \\theta_0 = \\dfrac{20 \\pi}{180} \\, \\mathrm{rad} $。\n  - 应变增量 $ \\varepsilon = \\begin{bmatrix} 0  0.001 \\\\ 0.001  0 \\end{bmatrix} $。\n- 案例 $ 2 $（边界情况，极小剪切）：\n  - $ E = 70 \\times 10^9 \\, \\mathrm{Pa} $，$ \\nu = 0.33 $，$ g_0 = 50 \\times 10^6 \\, \\mathrm{Pa} $，$ h = 400 \\times 10^6 \\, \\mathrm{Pa} $，$ \\gamma_0 = 1.0 \\, \\mathrm{s}^{-1} $，$ n = 10 $，$ \\Delta t = 0.01 \\, \\mathrm{s} $，$ \\theta_0 = \\dfrac{15 \\pi}{180} \\, \\mathrm{rad} $。\n  - 应变增量 $ \\varepsilon = \\begin{bmatrix} 0  10^{-6} \\\\ 10^{-6}  0 \\end{bmatrix} $。\n- 案例 $ 3 $（不同材料参数下的组合法向和剪切）：\n  - $ E = 210 \\times 10^9 \\, \\mathrm{Pa} $，$ \\nu = 0.28 $，$ g_0 = 200 \\times 10^6 \\, \\mathrm{Pa} $，$ h = 500 \\times 10^6 \\, \\mathrm{Pa} $，$ \\gamma_0 = 5.0 \\, \\mathrm{s}^{-1} $，$ n = 8 $，$ \\Delta t = 0.02 \\, \\mathrm{s} $，$ \\theta_0 = \\dfrac{35 \\pi}{180} \\, \\mathrm{rad} $。\n  - 应变增量 $ \\varepsilon = \\begin{bmatrix} 0.001  0.0005 \\\\ 0.0005  -0.0005 \\end{bmatrix} $。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表，每个浮点数四舍五入到六位小数，并且测试案例按上述顺序连接。例如，一个包含两个案例的输出将类似于 $ [x_1,x_2,x_3,y_1,y_2,y_3] $，其中每个 $ x_i, y_i $ 是一个具有六位小数的浮点数。在这里，您必须输出对应于三个案例的九个浮点数。", "solution": "问题的核心是使用牛顿-拉夫逊方法求解滑移增量 $ \\boldsymbol{\\gamma} = [\\gamma_1, \\gamma_2]^T $ 的非线性残差方程组。滑移系 $ \\alpha $ 的残差由流动法则的后向欧拉离散化给出：\n$$\nR_\\alpha(\\boldsymbol{\\gamma}) = \\gamma_\\alpha - \\Delta t \\, \\gamma_0 \\left( \\frac{|\\tau_\\alpha(\\boldsymbol{\\gamma})|}{g(\\boldsymbol{\\gamma})} \\right)^n \\mathrm{sign}(\\tau_\\alpha(\\boldsymbol{\\gamma})) = 0\n$$\n牛顿-拉夫逊方法需要残差向量 $ \\mathbf{R} = [R_1, R_2]^T $ 的雅可比矩阵，其分量为 $ K_{\\alpha\\beta} = \\dfrac{\\partial R_\\alpha}{\\partial \\gamma_\\beta} $。迭代求解中的一步是通过求解线性系统 $ \\mathbf{K} \\Delta \\boldsymbol{\\gamma} = -\\mathbf{R} $ 并更新 $ \\boldsymbol{\\gamma} \\leftarrow \\boldsymbol{\\gamma} + \\Delta\\boldsymbol{\\gamma} $ 来给出。\n\n**1. 一致雅可比矩阵 $ K_{\\alpha\\beta} $ 的推导**\n\n我们首先对 $ R_\\alpha $ 关于 $ \\gamma_\\beta $ 求导：\n$$\nK_{\\alpha\\beta} = \\frac{\\partial R_\\alpha}{\\partial \\gamma_\\beta} = \\frac{\\partial \\gamma_\\alpha}{\\partial \\gamma_\\beta} - \\Delta t \\, \\gamma_0 \\frac{\\partial}{\\partial \\gamma_\\beta} \\left[ g^{-n} |\\tau_\\alpha|^n \\mathrm{sign}(\\tau_\\alpha) \\right]\n$$\n第一项是克罗内克δ，$ \\delta_{\\alpha\\beta} $。对于第二项，我们应用链式法则和乘积法则。我们使用关系 $ \\dfrac{\\partial |\\tau_\\alpha|}{\\partial \\gamma_\\beta} = \\mathrm{sign}(\\tau_\\alpha) \\dfrac{\\partial \\tau_\\alpha}{\\partial \\gamma_\\beta} $ 和 $ \\dfrac{\\partial |\\gamma_\\mu|}{\\partial \\gamma_\\beta} = \\mathrm{sign}(\\gamma_\\mu)\\delta_{\\mu\\beta} $，并按照规定，在一次迭代中将符号函数视为常数。\n设 $ \\Phi_\\alpha(\\boldsymbol{\\gamma}) = \\Delta t \\, \\gamma_0 \\left( \\frac{|\\tau_\\alpha|}{g} \\right)^n \\mathrm{sign}(\\tau_\\alpha) $。其导数为：\n$$\n\\frac{\\partial \\Phi_\\alpha}{\\partial \\gamma_\\beta} = \\frac{\\partial \\Phi_\\alpha}{\\partial \\tau_\\alpha} \\frac{\\partial \\tau_\\alpha}{\\partial \\gamma_\\beta} + \\frac{\\partial \\Phi_\\alpha}{\\partial g} \\frac{\\partial g}{\\partial \\gamma_\\beta}\n$$\n$ \\Phi_\\alpha $ 的偏导数为：\n$$\n\\frac{\\partial \\Phi_\\alpha}{\\partial \\tau_\\alpha} = \\Delta t \\, \\gamma_0 \\, n \\frac{|\\tau_\\alpha|^{n-1}}{g^n} \\mathrm{sign}(\\tau_\\alpha)^2 = n \\frac{\\Phi_\\alpha}{|\\tau_\\alpha|}\\mathrm{sign}(\\tau_\\alpha) \\equiv \\psi_\\alpha\n$$\n$$\n\\frac{\\partial \\Phi_\\alpha}{\\partial g} = \\Delta t \\, \\gamma_0 \\, |\\tau_\\alpha|^n \\mathrm{sign}(\\tau_\\alpha) (-n g^{-n-1}) = -n \\frac{\\Phi_\\alpha}{g}\n$$\n滑移抗力 $ g(\\boldsymbol{\\gamma}) = g_0 + h \\sum_{\\mu=1}^{2} |\\gamma_\\mu| $ 的导数为：\n$$\n\\frac{\\partial g}{\\partial \\gamma_\\beta} = h \\frac{\\partial}{\\partial \\gamma_\\beta} \\sum_{\\mu=1}^2 |\\gamma_\\mu| = h \\, \\mathrm{sign}(\\gamma_\\beta)\n$$\n将这些代入 $ K_{\\alpha\\beta} $ 的表达式中，我们得到：\n$$\nK_{\\alpha\\beta} = \\delta_{\\alpha\\beta} - \\left( \\psi_\\alpha \\frac{\\partial \\tau_\\alpha}{\\partial \\gamma_\\beta} - n \\frac{\\Phi_\\alpha}{g} h \\, \\mathrm{sign}(\\gamma_\\beta) \\right)\n$$\n在收敛时，$ \\gamma_\\alpha \\approx \\Phi_\\alpha $，所以我们可以写成：\n$$\nK_{\\alpha\\beta} = \\delta_{\\alpha\\beta} - \\psi_\\alpha \\left( \\frac{\\partial \\tau_\\alpha}{\\partial \\gamma_\\beta} + \\frac{\\tau_\\alpha \\mathrm{sign}(\\tau_\\alpha)}{|\\tau_\\alpha|} \\frac{1}{g} h \\, \\mathrm{sign}(\\gamma_\\beta) \\right) = \\delta_{\\alpha\\beta} - \\psi_\\alpha \\left( \\frac{\\partial \\tau_\\alpha}{\\partial \\gamma_\\beta} + \\frac{|\\tau_\\alpha|}{g} h \\, \\mathrm{sign}(\\gamma_\\beta) \\right)\n$$\n下一个关键步骤是推导 $ \\dfrac{\\partial \\tau_\\alpha}{\\partial \\gamma_\\beta} $。分解剪应力 $ \\tau_\\alpha $ 通过应力 $ \\sigma $ 和与取向相关的施密特张量 $ \\mathbf{S}_\\alpha $ 两者依赖于 $ \\boldsymbol{\\gamma} $。\n$$\n\\tau_\\alpha = \\mathbf{S}_\\alpha(\\theta(\\boldsymbol{\\gamma})) : \\sigma(\\boldsymbol{\\gamma})\n$$\n应用乘积法则：\n$$\n\\frac{\\partial \\tau_\\alpha}{\\partial \\gamma_\\beta} = \\frac{\\partial \\mathbf{S}_\\alpha}{\\partial \\gamma_\\beta} : \\sigma + \\mathbf{S}_\\alpha : \\frac{\\partial \\sigma}{\\partial \\gamma_\\beta}\n$$\n我们计算每一项。$ \\mathbf{S}_\\alpha $ 对 $ \\boldsymbol{\\gamma} $ 的依赖性是通过取向 $ \\theta = \\theta_0 - \\sum_{\\mu=1}^{2} \\gamma_\\mu a_\\mu(\\theta_0) $ 实现的。\n$$\n\\frac{\\partial \\mathbf{S}_\\alpha}{\\partial \\gamma_\\beta} = \\frac{\\partial \\mathbf{S}_\\alpha}{\\partial \\theta} \\frac{\\partial \\theta}{\\partial \\gamma_\\beta} = -a_\\beta(\\theta_0) \\frac{\\partial \\mathbf{S}_\\alpha}{\\partial \\theta}\n$$\n应力 $ \\sigma $ 通过各向同性弹性张量 $ \\mathbb{C} $ 与弹性应变 $ \\varepsilon^\\mathrm{e} $ 相关，即 $ \\sigma = \\mathbb{C} : \\varepsilon^\\mathrm{e} $。应力的导数为：\n$$\n\\frac{\\partial \\sigma}{\\partial \\gamma_\\beta} = \\mathbb{C} : \\frac{\\partial \\varepsilon^\\mathrm{e}}{\\partial \\gamma_\\beta}\n$$\n弹性应变为 $ \\varepsilon^\\mathrm{e} = \\varepsilon - \\varepsilon^\\mathrm{p} = \\varepsilon - \\sum_{\\mu=1}^{2} \\gamma_\\mu \\mathbf{S}_\\mu(\\theta(\\boldsymbol{\\gamma})) $。其导数为：\n$$\n\\frac{\\partial \\varepsilon^\\mathrm{e}}{\\partial \\gamma_\\beta} = - \\frac{\\partial}{\\partial \\gamma_\\beta} \\left( \\sum_{\\mu=1}^{2} \\gamma_\\mu \\mathbf{S}_\\mu \\right) = - \\left( \\mathbf{S}_\\beta + \\sum_{\\mu=1}^{2} \\gamma_\\mu \\frac{\\partial \\mathbf{S}_\\mu}{\\partial \\gamma_\\beta} \\right) = - \\left( \\mathbf{S}_\\beta + \\sum_{\\mu=1}^{2} \\gamma_\\mu \\frac{\\partial \\mathbf{S}_\\mu}{\\partial \\theta} \\frac{\\partial \\theta}{\\partial \\gamma_\\beta} \\right)\n$$\n$$\n\\frac{\\partial \\varepsilon^\\mathrm{e}}{\\partial \\gamma_\\beta} = - \\mathbf{S}_\\beta + a_\\beta(\\theta_0) \\sum_{\\mu=1}^{2} \\gamma_\\mu \\frac{\\partial \\mathbf{S}_\\mu}{\\partial \\theta}\n$$\n将这些结果代回 $ \\dfrac{\\partial \\tau_\\alpha}{\\partial \\gamma_\\beta} $ 的表达式中：\n$$\n\\frac{\\partial \\tau_\\alpha}{\\partial \\gamma_\\beta} = \\left( -a_\\beta(\\theta_0) \\frac{\\partial \\mathbf{S}_\\alpha}{\\partial \\theta} \\right) : \\sigma + \\mathbf{S}_\\alpha : \\mathbb{C} : \\left( - \\mathbf{S}_\\beta + a_\\beta(\\theta_0) \\sum_{\\mu=1}^{2} \\gamma_\\mu \\frac{\\partial \\mathbf{S}_\\mu}{\\partial \\theta} \\right)\n$$\n重新整理各项，得到分解剪应力导数的最终表达式：\n$$\n\\frac{\\partial \\tau_\\alpha}{\\partial \\gamma_\\beta} = - \\left( \\mathbf{S}_\\alpha : \\mathbb{C} : \\mathbf{S}_\\beta \\right) - a_\\beta(\\theta_0) \\left( \\frac{\\partial \\mathbf{S}_\\alpha}{\\partial \\theta} : \\sigma - \\mathbf{S}_\\alpha : \\mathbb{C} : \\sum_{\\mu=1}^{2} \\gamma_\\mu \\frac{\\partial \\mathbf{S}_\\mu}{\\partial \\theta} \\right)\n$$\n该表达式包含标准的弹塑性切线模量项 $ -\\mathbf{S}_\\alpha : \\mathbb{C} : \\mathbf{S}_\\beta $，以及考虑了因晶格旋转引起的几何软化的附加项。\n\n**2. 算法实现**\n\n推导出的雅可比矩阵在牛顿-拉夫逊框架内实现，以求解 $ \\boldsymbol{\\gamma} $。单个材料点更新的算法如下：\n1.  初始化滑移增量 $ \\boldsymbol{\\gamma}^{(0)} = \\mathbf{0} $。\n2.  预计算常数，包括标量自旋大小 $ a_\\alpha(\\theta_0) $。对于给定的滑移系，可以证明 $ a_1(\\theta_0) = a_2(\\theta_0) = 0.5 $。\n3.  对于每次迭代 $ k = 0, 1, 2, \\dots $：\n    a.  计算当前取向角：$ \\theta^{(k)} = \\theta_0 - \\sum_{\\mu=1}^2 \\gamma_\\mu^{(k)} a_\\mu(\\theta_0) $。\n    b.  更新所有与取向相关的量：施密特张量 $ \\mathbf{S}_\\alpha(\\theta^{(k)}) $ 及其导数 $ \\dfrac{\\partial \\mathbf{S}_\\alpha}{\\partial \\theta}(\\theta^{(k)}) $。\n    c.  计算当前的塑性应变 $ \\varepsilon^{\\mathrm{p},(k)} $、弹性应变 $ \\varepsilon^{\\mathrm{e},(k)} $、应力 $ \\sigma^{(k)} $、分解剪应力 $ \\tau_\\alpha^{(k)} $ 以及滑移抗力 $ g^{(k)} $。\n    d.  计算残差向量 $ \\mathbf{R}^{(k)} = [R_1^{(k)}, R_2^{(k)}]^T $。\n    e.  如果 $ \\|\\mathbf{R}^{(k)}\\| $ 低于指定的容差，则解已收敛。终止迭代。\n    f.  使用上面推导的表达式组装 $ 2 \\times 2 $ 雅可比矩阵 $ \\mathbf{K}^{(k)} $，其分量为 $ K_{\\alpha\\beta}^{(k)} $。所有量均在当前状态 $ (k) $ 下计算。\n    g.  求解线性系统 $ \\mathbf{K}^{(k)} \\Delta\\boldsymbol{\\gamma} = -\\mathbf{R}^{(k)} $ 以获得增量 $ \\Delta\\boldsymbol{\\gamma} $。\n    h.  更新滑移增量：$ \\boldsymbol{\\gamma}^{(k+1)} = \\boldsymbol{\\gamma}^{(k)} + \\Delta\\boldsymbol{\\gamma} $。\n4.  收敛后，计算最终取向 $ \\theta = \\theta_0 - \\sum_{\\alpha=1}^{2} \\gamma_\\alpha a_\\alpha(\\theta_0) $。\n\n此过程确保了数值解的二次收敛性，因为雅可比矩阵与残差公式是一致的，包括了晶格旋转的几何效应。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main entry point for solving the crystal plasticity problem.\n    Defines test cases and calls the solver for each, then formats the output.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"E\": 70e9, \"nu\": 0.33, \"g0\": 50e6, \"h\": 400e6, \"gamma0\": 1.0, \"n\": 10,\n            \"dt\": 0.01, \"theta0\": np.deg2rad(20),\n            \"eps\": np.array([[0, 0.001], [0.001, 0]])\n        },\n        {\n            \"E\": 70e9, \"nu\": 0.33, \"g0\": 50e6, \"h\": 400e6, \"gamma0\": 1.0, \"n\": 10,\n            \"dt\": 0.01, \"theta0\": np.deg2rad(15),\n            \"eps\": np.array([[0, 1e-6], [1e-6, 0]])\n        },\n        {\n            \"E\": 210e9, \"nu\": 0.28, \"g0\": 200e6, \"h\": 500e6, \"gamma0\": 5.0, \"n\": 8,\n            \"dt\": 0.02, \"theta0\": np.deg2rad(35),\n            \"eps\": np.array([[0.001, 0.0005], [0.0005, -0.0005]])\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        gamma1, gamma2, theta_final = solve_case(params)\n        results.extend([gamma1, gamma2, theta_final])\n\n    # Format output as specified.\n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\n\ndef solve_case(params):\n    \"\"\"\n    Solves a single instance of the crystal plasticity problem using Newton's method.\n    \"\"\"\n    E, nu, g0, h = params[\"E\"], params[\"nu\"], params[\"g0\"], params[\"h\"]\n    gamma0, n, dt = params[\"gamma0\"], params[\"n\"], params[\"dt\"]\n    theta0, eps_total = params[\"theta0\"], params[\"eps\"]\n\n    # --- Pre-computation and helper functions ---\n\n    # Lamé parameters\n    lam = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n    mu = E / (2 * (1 + nu))\n\n    # Slip systems in the reference configuration\n    s0_vecs = [np.array([1., 0.]), np.array([1./np.sqrt(2), 1./np.sqrt(2)])]\n    m0_vecs = [np.array([0., 1.]), np.array([-1./np.sqrt(2), 1./np.sqrt(2)])]\n    \n    # Rotation matrix J (for dR/dtheta)\n    J = np.array([[0., -1.], [1., 0.]])\n\n    def get_rotation_matrix(theta_rad):\n        c, s = np.cos(theta_rad), np.sin(theta_rad)\n        return np.array([[c, -s], [s, c]])\n\n    def stress_from_elastic_strain(eps_e):\n        tr_eps_e = np.trace(eps_e)\n        return lam * tr_eps_e * np.eye(2) + 2 * mu * eps_e\n\n    # Pre-compute scalar spin magnitudes a_alpha(theta_0)\n    # For the given slip systems, these are constant, a_alpha = 0.5\n    a_alpha_0 = np.array([0.5, 0.5])\n\n    # --- Newton-Raphson Solver ---\n    gamma = np.zeros(2)  # Initial guess for slip increments [gamma_1, gamma_2]\n    max_iter = 15\n    tolerance = 1e-9\n\n    for _ in range(max_iter):\n        # Current state variables based on gamma\n        theta = theta0 - np.sum(gamma * a_alpha_0)\n        R = get_rotation_matrix(theta)\n        \n        S_tensors = []  # Schmid tensors\n        s_vecs, m_vecs = [], []\n        for i in range(2):\n            s_i = R @ s0_vecs[i]\n            m_i = R @ m0_vecs[i]\n            s_vecs.append(s_i)\n            m_vecs.append(m_i)\n            S_tensors.append(0.5 * (np.outer(s_i, m_i) + np.outer(m_i, s_i)))\n\n        # Plastic strain and stress\n        eps_p = gamma[0] * S_tensors[0] + gamma[1] * S_tensors[1]\n        eps_e = eps_total - eps_p\n        sigma = stress_from_elastic_strain(eps_e)\n\n        # Resolved shear stresses and hardening\n        tau = np.array([np.sum(S_tensors[0] * sigma), np.sum(S_tensors[1] * sigma)])\n        g = g0 + h * np.sum(np.abs(gamma))\n\n        # Residual vector R\n        R_vec = np.zeros(2)\n        flow = np.zeros(2)\n        for i in range(2):\n            if abs(tau[i])  1e-12: # Avoid division by zero\n                flow[i] = 0.\n            else:\n                flow[i] = gamma0 * (np.abs(tau[i]) / g)**n * np.sign(tau[i])\n        R_vec = gamma - dt * flow\n        \n        # Check for convergence\n        if np.linalg.norm(R_vec)  tolerance:\n            break\n\n        # --- Jacobian (Consistent Linearization) K ---\n        K = np.zeros((2, 2))\n        \n        # Derivatives of Schmid tensors dS/dtheta\n        dSdtheta_tensors = []\n        for i in range(2):\n            s_i, m_i = s_vecs[i], m_vecs[i]\n            Js = J @ s_i\n            Jm = J @ m_i\n            T_mat = np.outer(Js, m_i) + np.outer(s_i, Jm)\n            dSdtheta_tensors.append(0.5 * (T_mat + T_mat.T))\n\n        for alpha in range(2):\n            # Compute psi_alpha term from Jacobian derivation\n            psi_alpha = 0.\n            if abs(tau[alpha]) > 1e-12 and g > 1e-12:\n                 psi_alpha = dt * n * gamma0 * (np.abs(tau[alpha])**(n - 1)) / (g**n) * np.sign(tau[alpha])**2\n\n            for beta in range(2):\n                # Derivative of resolved shear stress d(tau_alpha)/d(gamma_beta)\n                \n                # Elastoplastic modulus part: -(S_alpha : C : S_beta)\n                sigma_from_S_beta = stress_from_elastic_strain(S_tensors[beta])\n                term_elastoplastic = -np.sum(S_tensors[alpha] * sigma_from_S_beta)\n                \n                # Geometric softening part due to lattice rotation\n                sum_term_geom = gamma[0] * dSdtheta_tensors[0] + gamma[1] * dSdtheta_tensors[1]\n                sigma_from_dS_sum = stress_from_elastic_strain(sum_term_geom)\n                \n                dtau_geom_part = np.sum(dSdtheta_tensors[alpha] * sigma) - np.sum(S_tensors[alpha] * sigma_from_dS_sum)\n                \n                dtau_dgamma_beta = term_elastoplastic - a_alpha_0[beta] * dtau_geom_part\n                \n                # Hardening part\n                hardening_term = (n * (dt * flow[alpha]) / g) * h * np.sign(gamma[beta]) if g > 1e-9 else 0.\n                \n                # Assemble Jacobian entry K_alpha,beta\n                delta_ab = 1.0 if alpha == beta else 0.0\n                K[alpha, beta] = delta_ab - (psi_alpha * dtau_dgamma_beta - hardening_term)\n\n        # Solve linear system K * d_gamma = -R and update\n        try:\n            d_gamma = np.linalg.solve(K, -R_vec)\n        except np.linalg.LinAlgError:\n            # Use pseudo-inverse if Jacobian is singular\n            d_gamma = np.linalg.pinv(K) @ -R_vec\n            \n        gamma += d_gamma\n\n    # Final calculation of theta\n    theta_final = theta0 - np.sum(gamma * a_alpha_0)\n    \n    return gamma[0], gamma[1], theta_final\n\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2678640"}]}