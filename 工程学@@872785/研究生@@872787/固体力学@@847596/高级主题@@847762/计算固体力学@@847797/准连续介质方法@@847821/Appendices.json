{"hands_on_practices": [{"introduction": "掌握准连续介质（QC）方法的第一步是理解其核心思想：如何从底层的原子相互作用中构建一个粗粒化的能量泛函。本练习将通过一个一维原子链的简化模型，指导您完成这一基本过程。您将应用柯西-玻恩法则（Cauchy–Born rule）和线性位移插值，手动推导QC能量，并通过对能量求导来计算节点力，从而亲身体验QC方法的基本力学原理。[@problem_id:2923438]", "problem": "考虑一个一维原子链，包含 $9$ 个原子，索引为 $i=0,1,\\ldots,8$，其参考位置为 $X_i=i\\,a_0$，其中 $a_0>0$ 是参考最近邻间距。原子间的相互作用仅限于最近邻，通过一个仅依赖于当前键长 $r$ 的对势 $\\phi(r)$ 来描述。该原子链通过准连续介质 (QuasiContinuum, QC) 方法进行粗粒化，使用一个双单元网格，其代表性原子（也称 repatom）位于 $i=0,4,8$ 处，从而定义了两个单元：单元 $1$ 跨越 $[X_0,X_4]$，单元 $2$ 跨越 $[X_4,X_8]$。假设在每个单元中采用局部 Cauchy–Born 近似，并使用代表性原子之间的位移进行线性插值，同时采用均匀权重求和规则，该规则计算每个单元中所有的最近邻键。\n\n对势是关于 $a_0$ 的谐波势，即 $\\phi(r)=\\tfrac{1}{2}k\\,(r-a_0)^2$，其中刚度 $k>0$。设代表性原子的位移被指定为 $u_0=0$，$u_4=\\bar{u}$ 和 $u_8=2\\bar{u}$，其中 $\\bar{u}>0$ 是一个给定的常数。利用这些数据，QC 总势能定义为各单元贡献之和，该贡献是通过计算每个单元中的 $4$ 个键得到的，每个键的变形都与该单元的线性位移场一致。\n\n从线性位移场引起的键长变化和 Cauchy–Born 关系的定义出发，推导 QC 总能量 $E_{\\mathrm{QC}}(u)$ 作为代表性原子位移的函数。然后，使用具体数值 $k=100~\\mathrm{N/m}$、$a_0=2.5\\times 10^{-10}~\\mathrm{m}$ 和 $\\bar{u}=4.0\\times 10^{-11}~\\mathrm{m}$ 计算 $E_{\\mathrm{QC}}(u)$。最后，通过求导 $\\mathbf{F}=-\\nabla E_{\\mathrm{QC}}(u)$ 计算给定_位移下的代表性原子上的内节点力，并报告其三个分量 $F_0$、$F_4$ 和 $F_8$。\n\n答案要求：\n- 能量以 $\\mathrm{J}$ 为单位，力以 $\\mathrm{N}$ 为单位。\n- 所有报告的数值四舍五入至三位有效数字。\n- 以单行矩阵的形式提供最终答案，依次包含 $E_{\\mathrm{QC}}(u)$、$F_0$、$F_4$ 和 $F_8$。", "solution": "首先对问题陈述进行验证。\n\n步骤 1：提取给定条件。\n- 一个包含 $9$ 个原子的一维链，索引为 $i=0,1,\\ldots,8$。\n- 参考位置：$X_i=i\\,a_0$，晶格参数 $a_0>0$。\n- 相互作用势：最近邻谐波对势 $\\phi(r)=\\tfrac{1}{2}k\\,(r-a_0)^2$，刚度 $k>0$。\n- 粗粒化：准连续介质 (QC) 方法，代表性原子（repatom）位于索引 $0$、$4$ 和 $8$ 处。\n- 网格：两个单元，单元 $1$ 覆盖 $[X_0,X_4]$，单元 $2$ 覆盖 $[X_4,X_8]$。\n- 近似：局部 Cauchy–Born 法则和位移的线性插值。\n- 求和规则：均匀权重求和，计算每个单元中的 $4$ 个键。\n- 指定位移：$u_0=0$，$u_4=\\bar{u}$，$u_8=2\\bar{u}$。\n- 常数：$k=100~\\mathrm{N/m}$，$a_0=2.5\\times 10^{-10}~\\mathrm{m}$，$\\bar{u}=4.0\\times 10^{-11}~\\mathrm{m}$。\n- 要求输出：总 QC 能量 $E_{\\mathrm{QC}}(u)$ 和节点力 $F_0$、$F_4$、$F_8$，数值四舍五入至三位有效数字。\n\n步骤 2：使用提取的给定条件进行验证。\n该问题具有科学依据，因为它描述了准连续介质方法的标准应用，这是一种在计算材料科学中成熟的多尺度技术。使用谐波势对应于线弹性极限，而 Cauchy-Born 近似则是该方法的一个基本原则。该问题是适定的；它提供了所有必要的数据、参数和边界条件，以得出一个唯一且有意义的解。定义清晰、自洽且一致。例如，单元 1 的域 $[X_0, X_4]$ 包含原子 $0, 1, 2, 3, 4$，因此包含四个最近邻键 $(0,1), (1,2), (2,3), (3,4)$，这与指定的 $4$ 个键的数量一致。单元 2 也是如此。数值对于原子系统是物理上合理的。该问题没有违反任何无效性标准。\n\n步骤 3：结论与行动。\n问题有效。将推导解答。\n\nQC 总能量 $E_{\\mathrm{QC}}(u)$ 的推导。\n总能量是两个单元能量之和，$E_{\\mathrm{QC}} = E^{(1)} + E^{(2)}$。\n\n对于单元 1，跨越代表性原子 $0$ 和 $4$，参考长度为 $L_1 = X_4 - X_0 = 4a_0$。对于 $X \\in [X_0, X_4]$ 的位移场 $u(X)$ 假设是线性的：\n$$u(X) = u_0 \\left(1 - \\frac{X-X_0}{L_1}\\right) + u_4 \\left(\\frac{X-X_0}{L_1}\\right)$$\n宏观变形梯度 $F$ 在单元内是恒定的，由 $F = 1 + du/dX$ 给出。\n$$F^{(1)} = 1 + \\frac{u_4 - u_0}{X_4 - X_0} = 1 + \\frac{u_4 - u_0}{4a_0}$$\n根据局部 Cauchy–Born 近似，单元中的每个键都根据此宏观梯度变形。变形后的键长 $r^{(1)}$ 为：\n$$r^{(1)} = F^{(1)} a_0 = \\left(1 + \\frac{u_4 - u_0}{4a_0}\\right) a_0 = a_0 + \\frac{u_4 - u_0}{4}$$\n储存在单个此类键中的能量是：\n$$\\phi(r^{(1)}) = \\frac{1}{2}k(r^{(1)} - a_0)^2 = \\frac{1}{2}k\\left(\\frac{u_4 - u_0}{4}\\right)^2$$\n单元 1 包含 $4$ 个键。使用均匀权重求和规则，单元 1 的能量为：\n$$E^{(1)} = 4 \\times \\phi(r^{(1)}) = 4 \\times \\frac{1}{2}k\\frac{(u_4 - u_0)^2}{16} = \\frac{k}{8}(u_4 - u_0)^2$$\n类似地，对于单元 2，跨越代表性原子 $4$ 和 $8$，参考长度为 $L_2 = X_8 - X_4 = 4a_0$：\n$$F^{(2)} = 1 + \\frac{u_8 - u_4}{X_8 - X_4} = 1 + \\frac{u_8 - u_4}{4a_0}$$\n$$r^{(2)} = F^{(2)} a_0 = a_0 + \\frac{u_8 - u_4}{4}$$\n单元 2 的能量，也包含 $4$ 个键，为：\n$$E^{(2)} = 4 \\times \\frac{1}{2}k(r^{(2)} - a_0)^2 = \\frac{k}{8}(u_8 - u_4)^2$$\n总 QC 能量是单元能量之和：\n$$E_{\\mathrm{QC}}(u_0, u_4, u_8) = E^{(1)} + E^{(2)} = \\frac{k}{8}(u_4 - u_0)^2 + \\frac{k}{8}(u_8 - u_4)^2$$\n\n能量的数值计算。\n代入指定的位移 $u_0=0$、$u_4=\\bar{u}$ 和 $u_8=2\\bar{u}$：\n$$E_{\\mathrm{QC}} = \\frac{k}{8}(\\bar{u} - 0)^2 + \\frac{k}{8}(2\\bar{u} - \\bar{u})^2 = \\frac{k}{8}\\bar{u}^2 + \\frac{k}{8}\\bar{u}^2 = \\frac{k}{4}\\bar{u}^2$$\n使用给定值 $k=100~\\mathrm{N/m}$ 和 $\\bar{u}=4.0\\times 10^{-11}~\\mathrm{m}$：\n$$E_{\\mathrm{QC}} = \\frac{100~\\mathrm{N/m}}{4} (4.0\\times 10^{-11}~\\mathrm{m})^2 = (25~\\mathrm{N/m}) \\times (16.0 \\times 10^{-22}~\\mathrm{m}^2) = 400 \\times 10^{-22}~\\mathrm{J} = 4.0 \\times 10^{-20}~\\mathrm{J}$$\n四舍五入至三位有效数字，能量为 $E_{\\mathrm{QC}} = 4.00 \\times 10^{-20}~\\mathrm{J}$。\n\n节点力的推导与计算。\n代表性原子上的内力由总势能的负梯度给出，$\\mathbf{F} = -\\nabla E_{\\mathrm{QC}}(u)$。其分量为 $F_i = -\\partial E_{\\mathrm{QC}} / \\partial u_i$。\n$$F_0 = -\\frac{\\partial E_{\\mathrm{QC}}}{\\partial u_0} = -\\frac{k}{8} \\cdot 2(u_4-u_0)(-1) = \\frac{k}{4}(u_4 - u_0)$$\n$$F_8 = -\\frac{\\partial E_{\\mathrm{QC}}}{\\partial u_8} = -\\frac{k}{8} \\cdot 2(u_8-u_4)(1) = -\\frac{k}{4}(u_8 - u_4)$$\n$$F_4 = -\\frac{\\partial E_{\\mathrm{QC}}}{\\partial u_4} = -\\left[ \\frac{k}{8} \\cdot 2(u_4-u_0)(1) + \\frac{k}{8} \\cdot 2(u_8-u_4)(-1) \\right] = -\\frac{k}{4}\\left[ (u_4-u_0) - (u_8-u_4) \\right] = -\\frac{k}{4}(2u_4 - u_0 - u_8)$$\n代入指定的位移（$u_0=0, u_4=\\bar{u}, u_8=2\\bar{u}$）和数值：\n$$F_0 = \\frac{k}{4}(\\bar{u} - 0) = \\frac{k}{4}\\bar{u} = \\frac{100}{4}(4.0\\times 10^{-11}) = 25 \\times 4.0\\times 10^{-11} = 100 \\times 10^{-11}~\\mathrm{N} = 1.0 \\times 10^{-9}~\\mathrm{N}$$\n保留三位有效数字，$F_0 = 1.00 \\times 10^{-9}~\\mathrm{N}$。\n\n$$F_8 = -\\frac{k}{4}(2\\bar{u} - \\bar{u}) = -\\frac{k}{4}\\bar{u} = -1.0 \\times 10^{-9}~\\mathrm{N}$$\n保留三位有效数字，$F_8 = -1.00 \\times 10^{-9}~\\mathrm{N}$。\n\n$$F_4 = -\\frac{k}{4}(2\\bar{u} - 0 - 2\\bar{u}) = -\\frac{k}{4}(0) = 0~\\mathrm{N}$$\n力 $F_4$ 恰好为零，因为两个单元的应变是均匀的。均匀应变意味着单元 1 施加在代表性原子 4 上的力与单元 2 施加在代表性原子 4 上的力大小相等、方向相反。其值恰好为 $0$。\n\n最终结果为 $E_{\\mathrm{QC}} = 4.00 \\times 10^{-20}~\\mathrm{J}$，$F_0 = 1.00 \\times 10^{-9}~\\mathrm{N}$，$F_4 = 0~\\mathrm{N}$ 和 $F_8 = -1.00 \\times 10^{-9}~\\mathrm{N}$。", "answer": "$$\\boxed{\\begin{pmatrix} 4.00 \\times 10^{-20} & 1.00 \\times 10^{-9} & 0 & -1.00 \\times 10^{-9} \\end{pmatrix}}$$", "id": "2923438"}, {"introduction": "柯西-玻恩（CB）法则是准连续介质方法的重要基石，但它并非普遍适用，尤其是在材料接近失稳时。本练习旨在通过一个具体的反例，让您深入探究CB法则的适用边界。您将使用能够描述材料非线性和失稳行为的Lennard-Jones势，对比均一变形（CB法则的预测）和更符合能量最低原理的非均一微观结构下的应力，从而量化CB法则在势能非凸区域的失效情况。[@problem_id:2923419]", "problem": "您将构建并量化一个准连续介质方法框架下针对柯西-玻恩（Cauchy–Born）法则的严格反例。您需要比较均质变形预测的应力与在相同宏观应变下由最小原子微结构获得的应力。考虑一个一维无限长的相同原子链，其最近邻相互作用由 Lennard–Jones 势决定\n$$\n\\phi(r) = 4 \\varepsilon \\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right],\n$$\n其中 $r$ 是键长，$\\varepsilon$ 是能量尺度，$\\sigma$ 是长度尺度。参考晶格间距 $a_0$ 是 $\\phi$ 的最小化子，即 $a_0 = \\operatorname{argmin}_r \\phi(r)$，其发生在 $a_0 = 2^{1/6}\\sigma$ 处。您将施加一个宏观拉伸 $F$，使得平均键长等于 $F a_0$。柯西-玻恩（CB）法则假设变形是均质的，而原子计算可能会实现一个非均质的周期倍增微结构，该结构具有两个交替的键长 $l_1$ 和 $l_2$，满足平均约束 $l_1 + l_2 = 2 F a_0$。\n\n仅从牛顿（Newton）定律、能量最小化原理以及第一皮奥拉-基尔霍夫（PK1）应力定义为能量对变形的导数出发，您必须推导出：\n- 在均质变形假设下，由柯西-玻恩法则预测的 PK1 应力。\n- 在平均约束 $l_1 + l_2 = 2 F a_0$ 下，使总势能最小化的原子级双原子周期晶胞所产生的 PK1 应力（这可能在 $\\phi$ 的非凸区域导致 $l_1 \\neq l_2$）。\n- 这两种应力预测值之间的绝对误差，由 $|P_{\\mathrm{atom}} - P_{\\mathrm{CB}}|$ 给出。\n\n假设使用约化单位，其中 $\\varepsilon = 1$ 且 $\\sigma = 1$，因此应力以 $\\varepsilon/\\sigma$ 为单位表示。您的程序必须：\n- 使用 $\\sigma = 1$ 计算 $a_0 = 2^{1/6}\\sigma$。\n- 对于每个给定的宏观拉伸 $F$，计算如上所述的柯西-玻恩 PK1 应力和原子级 PK1 应力。\n- 为每个测试用例输出 PK1 应力的绝对误差 $|P_{\\mathrm{atom}} - P_{\\mathrm{CB}}|$。\n\n测试套件：\n- 使用以下宏观拉伸 $F$：$[1.00, 1.10, 1.12, 1.20, 1.30]$。\n- 选择这些值是为了探测：一个稳定的均质区域（$F=1.00$ 附近），一个刚好在非凸性出现之前的区域（$F=1.10$），一个刚好在非凸性出现之后的区域（$F=1.12$），以及更深入的非凸区域（$F=1.20$ 和 $F=1.30$），在这些区域柯西-玻恩法则可能会失效。\n\n所需输出：\n- 以 $\\varepsilon/\\sigma$ 为单位表示绝对误差。\n- 将每个结果四舍五入到 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[0.000000,0.123456,0.000001,0.500000,0.750000]$）。不应有多余的空格或文本。\n\n注：\n- 此问题不涉及角度。\n- 所有计算都应在约化单位下进行，其中 $\\varepsilon = 1$ 且 $\\sigma = 1$。\n- 不应读取任何输入；指定的测试套件必须硬编码，并在程序运行时自动执行。", "solution": "该问题要求为一维原子链构建并分析柯西-玻恩法则的一个反例。问题陈述的验证已经完成。该问题具有科学依据，提法恰当，客观，并包含进行严谨求解所需的所有信息。我们可以继续进行。\n\n分析在约化单位下进行，其中 $\\varepsilon = 1$ 且 $\\sigma = 1$。\n\n**1. 原子间势与参考态**\n\n最近邻原子间的相互作用由 Lennard-Jones 势描述：\n$$\n\\phi(r) = 4\\varepsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6 \\right] = 4 \\left( r^{-12} - r^{-6} \\right)\n$$\n其中 $r$ 是原子间距。\n\n参考晶格间距 $a_0$ 是使势能 $\\phi(r)$ 最小化的键长。这可以通过将势的一阶导数设为零来找到：\n$$\n\\frac{d\\phi}{dr} = \\phi'(r) = 4 \\left( -12r^{-13} + 6r^{-7} \\right) = 0\n$$\n这得到 $6r^{-7} = 12r^{-13}$，简化为 $r^6 = 2$。因此，参考晶格间距为：\n$$\na_0 = 2^{1/6}\\sigma = 2^{1/6}\n$$\n在此间距下，原子间的力为零，因为 $\\phi'(a_0)=0$。\n\n**2. 第一皮奥拉-基尔霍夫（PK1）应力的定义**\n\n一维情况下的 PK1 应力 $P$ 定义为能量密度对宏观变形梯度 $F$ 的导数。能量密度 $\\mathcal{E}$ 是单位参考长度的能量。对于一个键合系统，这是每个键的能量除以每个键的参考长度 $a_0$。\n$$\nP = \\frac{\\partial \\mathcal{E}}{\\partial F} = \\frac{1}{a_0} \\frac{\\partial E_{\\text{bond}}}{\\partial F}\n$$\n\n**3. 柯西-玻恩（CB）应力预测**\n\n柯西-玻恩法则假设宏观变形 $F$ 在原子尺度上均匀施加。这意味着一种均质变形，其中每个键具有相同的长度 $r_{\\mathrm{CB}}$：\n$$\nr_{\\mathrm{CB}} = F a_0\n$$\n每个键的能量就是在此长度下计算的势能，$E_{\\mathrm{CB}}(F) = \\phi(r_{\\mathrm{CB}}) = \\phi(F a_0)$。\n\n那么，在 CB 假设下的 PK1 应力 $P_{\\mathrm{CB}}$ 为：\n$$\nP_{\\mathrm{CB}}(F) = \\frac{1}{a_0} \\frac{d}{dF} \\left[ \\phi(F a_0) \\right]\n$$\n应用链式法则，$\\frac{d}{dF} = \\frac{dr_{\\mathrm{CB}}}{dF} \\frac{d}{dr_{\\mathrm{CB}}} = a_0 \\frac{d}{dr_{\\mathrm{CB}}}$，我们发现：\n$$\nP_{\\mathrm{CB}}(F) = \\frac{1}{a_0} \\left( a_0 \\cdot \\phi'(F a_0) \\right) = \\phi'(F a_0)\n$$\n代入 $\\phi'(r)$ 的表达式：\n$$\nP_{\\mathrm{CB}}(F) = 24(F a_0)^{-7} - 48(F a_0)^{-13}\n$$\n\n**4. 原子级应力预测**\n\n原子模型考虑了一个最小的微结构：一个具有两个交替键长 $l_1$ 和 $l_2$ 的周期倍增晶胞。宏观拉伸 $F$ 作为平均键长的约束施加：\n$$\n\\frac{l_1 + l_2}{2} = F a_0 \\implies l_1 + l_2 = 2F a_0\n$$\n这个双键晶胞的能量是 $E_{\\mathrm{cell}} = \\phi(l_1) + \\phi(l_2)$。实际的键长是在约束条件下使 $E_{\\mathrm{cell}}$ 最小化的值。我们可以将能量表示为仅关于 $l_1$ 的函数：\n$$\nE_{\\mathrm{cell}}(l_1) = \\phi(l_1) + \\phi(2F a_0 - l_1)\n$$\n驻点的条件是 $\\frac{dE_{\\mathrm{cell}}}{dl_1} = 0$：\n$$\n\\frac{dE_{\\mathrm{cell}}}{dl_1} = \\phi'(l_1) - \\phi'(2F a_0 - l_1) = 0 \\implies \\phi'(l_1) = \\phi'(l_2)\n$$\n这个平衡条件意味着两个键中的内力必须相等。\n\n均质解（$l_1 = l_2 = F a_0$）的稳定性取决于晶胞能量的二阶导数，这对应于势 $\\phi(r)$ 的凸性。\n$$\n\\frac{d^2 E_{\\mathrm{cell}}}{dl_1^2} \\bigg|_{l_1 = F a_0} = \\phi''(F a_0) + \\phi''(F a_0) = 2\\phi''(F a_0)\n$$\n仅当 $2\\phi''(F a_0) > 0$ 时，均质解才是稳定的。在 $\\phi''(r)  0$ 的地方，势变为非凸。让我们找到拐点 $r_c$，在该点 $\\phi''(r_c) = 0$。\n$$\n\\phi''(r) = 4 \\left( 156 r^{-14} - 42 r^{-8} \\right) = 0\n$$\n这得出 $r_c^6 = \\frac{156}{42} = \\frac{26}{7}$。所以，$r_c = (26/7)^{1/6}$。如果键长 $F a_0$ 超过 $r_c$，均质变形就会变得不稳定。这定义了一个临界拉伸 $F_c$：\n$$\nF_c = \\frac{r_c}{a_0} = \\frac{(26/7)^{1/6}}{(2)^{1/6}} = \\left(\\frac{13}{7}\\right)^{1/6} \\approx 1.1086\n$$\n对于 $F \\le F_c$，稳定解是均质的，$l_1 = l_2 = F a_0$。\n对于 $F > F_c$，均质解是不稳定的，系统会分岔到一个具有 $l_1 \\neq l_2$ 的非均质状态。\n\n原子级应力 $P_{\\mathrm{atom}}$ 是从双键晶胞的能量推导出来的。能量密度为 $\\mathcal{E}_{\\mathrm{atom}} = \\frac{E_{\\mathrm{cell}}}{2a_0} = \\frac{\\phi(l_1(F)) + \\phi(l_2(F))}{2a_0}$。\n$$\nP_{\\mathrm{atom}}(F) = \\frac{\\partial \\mathcal{E}_{\\mathrm{atom}}}{\\partial F} = \\frac{1}{2a_0} \\left( \\phi'(l_1) \\frac{dl_1}{dF} + \\phi'(l_2) \\frac{dl_2}{dF} \\right)\n$$\n使用平衡条件 $\\phi'(l_1) = \\phi'(l_2) \\equiv \\phi'_{\\min}$ 和约束的导数 $\\frac{dl_1}{dF} + \\frac{dl_2}{dF} = 2a_0$，我们得到：\n$$\nP_{\\mathrm{atom}}(F) = \\frac{\\phi'_{\\min}}{2a_0} \\left( \\frac{dl_1}{dF} + \\frac{dl_2}{dF} \\right) = \\frac{\\phi'_{\\min}}{2a_0} (2a_0) = \\phi'_{\\min}\n$$\n因此，$P_{\\mathrm{atom}}(F) = \\phi'(l_1)$，其中 $l_1$ 是能量最小化的键长。\n\n**5. 计算算法**\n\n对于每个给定的宏观拉伸 $F$：\n1.  计算 $a_0 = 2^{1/6}$ 和 $F_c = (13/7)^{1/6}$。\n2.  计算柯西-玻恩应力：$P_{\\mathrm{CB}} = \\phi'(F a_0)$。\n3.  将 $F$ 与 $F_c$ 进行比较：\n    *   如果 $F \\le F_c$，系统保持均质。原子模型给出 $l_1 = l_2 = F a_0$，因此 $P_{\\mathrm{atom}} = \\phi'(F a_0) = P_{\\mathrm{CB}}$。误差为 $0$。\n    *   如果 $F > F_c$，系统发生分岔。我们必须通过数值求解 $l_1, l_2$ 的方程组来找到非均质解：\n        $$\n        \\begin{cases}\n        \\phi'(l_1) = \\phi'(l_2) \\\\\n        l_1 + l_2 = 2F a_0\n        \\end{cases}\n        $$\n        这等效于为 $x \\neq F a_0$ 寻找函数 $f(x) = \\phi'(x) - \\phi'(2F a_0 - x)$ 的一个根 $l_1^*$。根据对 $\\phi'(r)$ 的分析，较短键长 $l_1^*$ 的物理上有意义的解位于区间 $(a_0, r_c)$ 内。在此区间上使用数值求根算法。\n4.  一旦找到 $l_1^*$，原子级应力就是 $P_{\\mathrm{atom}} = \\phi'(l_1^*)$。\n5.  绝对误差是 $|P_{\\mathrm{atom}} - P_{\\mathrm{CB}}|$。这个差异量化了柯西-玻恩法则的失效程度。\n\n此过程提供了一种计算所需应力误差的严谨方法。\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes the absolute error between the Cauchy-Born and atomistic PK1 stress\n    for a 1D atomic chain with Lennard-Jones interactions.\n    \"\"\"\n\n    # Reduced units are used, with epsilon = 1 and sigma = 1.\n    SIGMA = 1.0\n    EPSILON = 1.0\n\n    # Test cases for macroscopic stretch F\n    test_cases = [1.00, 1.10, 1.12, 1.20, 1.30]\n\n    # Pre-calculated constants based on the problem statement\n    # Reference lattice spacing a0 minimizes the potential, a0 = 2^(1/6) * sigma\n    a0 = np.power(2.0, 1.0/6.0) * SIGMA\n    \n    # Critical bond length rc is the inflection point of the potential, rc^6 = 26/7\n    rc = np.power(26.0/7.0, 1.0/6.0) * SIGMA\n    \n    # Critical stretch Fc corresponds to the onset of instability, Fc = rc / a0\n    Fc = rc / a0\n\n    def phi_prime(r):\n        \"\"\"\n        First derivative of the Lennard-Jones potential (proportional to force).\n        phi'(r) = 4 * epsilon * (-12 * sigma^12 / r^13 + 6 * sigma^6 / r^7)\n        In reduced units, this simplifies to:\n        phi'(r) = 24 / r^7 - 48 / r^13\n        \"\"\"\n        r_inv = SIGMA / r\n        r_inv6 = np.power(r_inv, 6)\n        r_inv12 = r_inv6 * r_inv6\n        \n        # The true phi'(r) is below. The simplified form 24r^-7 - 48r^-13 works fine.\n        return 4.0 * EPSILON * (-12.0 * r_inv12 / r + 6.0 * r_inv6 / r)\n\n    results = []\n    \n    for F in test_cases:\n        # Calculate the bond length under homogeneous (Cauchy-Born) deformation\n        r_cb = F * a0\n        \n        # Calculate the Cauchy-Born PK1 stress\n        # P_CB = phi'(r_cb)\n        P_cb = phi_prime(r_cb)\n        \n        P_atom = 0.0\n        \n        # Check for stability. The CB rule holds if F = Fc.\n        if F = Fc:\n            # In the stable regime, the atomistic solution is homogeneous.\n            P_atom = P_cb\n        else:\n            # In the unstable regime (F > Fc), the system bifurcates.\n            # We need to find the non-homogeneous solution {l1, l2} that minimizes energy.\n            # This requires solving phi'(l1) = phi'(l2) with l1 + l2 = 2 * F * a0.\n            \n            # Define the function whose root we need to find.\n            def root_func(l1):\n                l2 = 2 * r_cb - l1\n                return phi_prime(l1) - phi_prime(l2)\n            \n            # The smaller bond length l1 must be in the interval (a0, rc).\n            # This bracket is guaranteed to contain the root for F > Fc.\n            bracket = [a0, rc]\n\n            # Use SciPy's root finder to find the energy-minimizing l1.\n            # Trivial solution is l1 = r_cb, we search for the other one.\n            sol = root_scalar(root_func, bracket=bracket, method='brentq')\n            \n            if sol.converged:\n                l1_sol = sol.root\n                # The atomistic stress is phi'(l1_sol)\n                P_atom = phi_prime(l1_sol)\n            else:\n                # Should not happen with the correct bracket and problem setup.\n                # In case of failure, treat as error.\n                P_atom = np.nan\n\n        # Calculate the absolute error between atomistic and CB stress predictions.\n        error = np.abs(P_atom - P_cb)\n        results.append(error)\n\n    # Format the output as a comma-separated list of strings, rounded to 6 decimal places.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# The following line is commented out to prevent execution in this context,\n# but it's the entry point to run the solution.\n# solve()\n```", "answer": "[0.000000,0.000000,0.000632,0.174246,0.509787]", "id": "2923419"}, {"introduction": "在混合原子/连续介质方法中，“鬼力”（ghost forces）是一个必须正视的关键难题。这些非物理力产生于原子区域和连续介质区域之间的界面处，源于能量表述的不自洽。本练习通过构建一个特定的能量耦合方案，让您能够在一个一维模型中解析地推导出鬼力的存在，深刻理解其产生机制。掌握这一概念对于设计和评判多尺度模型的准确性至关重要。[@problem_id:2678008]", "problem": "考虑一个一维($1$D)无限原子链，其参考晶格常数为 $a0$，原子由索引 $i \\in \\mathbb{Z}$ 标记，参考位置为 $x_i = i a$。变形后的位置用 $y_i \\in \\mathbb{R}$ 表示。总原子能量是直到次近邻的对偶相互作用之和，\n$$\nE^{\\mathrm{atom}}(y) \\;=\\; \\sum_{i \\in \\mathbb{Z}} \\Big[ \\phi_1\\!\\big(|y_{i+1}-y_i|\\big) + \\phi_2\\!\\big(|y_{i+2}-y_i|\\big) \\Big],\n$$\n其中 $\\phi_1$ 和 $\\phi_2$ 分别是最近邻和次近邻相互作用的光滑对势。力由能量梯度定义，即原子 $i$ 上的力为 $f_i(y) = -\\partial E/\\partial y_i$。\n\n一个均匀的宏观变形由 $y_i = F x_i = F i a$ 给出，其中拉伸 $F0$ 为固定值。在全原子模型中，对称性意味着在这种均匀变形下，对所有 $i$ 都有 $f_i(y)=0$。\n\n将在准连续介质(QC)方法中，均匀变形下预测的非零力定义为鬼力。构建以下一维基于能量的原子/连续介质(a/c)耦合，其界面位于原子区域 $\\mathcal{A} = \\{ i \\in \\mathbb{Z} : i \\le 0 \\}$ 和连续介质区域 $\\mathcal{C} = \\{ i \\in \\mathbb{Z} : i \\ge 1 \\}$ 之间：\n\n- 所有最近邻键在任何地方都完全保留，即每对 $\\{i,i+1\\}$ 都对QC能量贡献 $\\phi_1(|y_{i+1}-y_i|)$。\n\n- 完全包含在 $\\mathcal{A}$ 中的次近邻键的贡献是精确的，即每对满足 $i+2 \\le 0$ 的 $\\{i,i+2\\}$ 都贡献 $\\phi_2(|y_{i+2}-y_i|)$。\n\n- 完全包含在 $\\mathcal{C}$ 中的次近邻键通过 Cauchy–Born 连续介质能量来近似，该能量是 $\\mathcal{C}$ 中恒定变形梯度 $F$ 的函数；特别地，每个这样的键贡献 $\\phi_2(2Fa)$，并且此连续介质能量仅依赖于 $\\mathcal{C}$ 中的自由度（因此其相对于 $y_0$ 的变分为零）。\n\n- 跨越界面（即一个端点在 $\\mathcal{A}$ 中，另一个在 $\\mathcal{C}$ 中）的次近邻键在QC能量中没有被显式表示。\n\n在均匀变形 $y_i = F i a$ 下，计算界面原子 $i=0$ 上的QC净力。这个非零力就是在这个基于能量的QC耦合中a/c界面上的鬼力。请以 $F$、$a$ 和在相关键长处求值的势的导数，给出一个单一的闭式解析表达式作为最终答案。最终答案中不要包含单位。如果可以简化，请提供与所述假设一致的最简表达式。", "solution": "问题要求在均匀变形下，界面原子 $i=0$ 上的准连续介质(QC)净力。这个力被称为鬼力，因为它在一个完全一致的粗粒化模型中应该为零。\n\n首先，对问题陈述进行验证。\n逐字提取已知条件：\n- 系统：一维($1$D)无限原子链，参考位置为 $x_i = i a$（其中 $i \\in \\mathbb{Z}$ 且 $a0$）。变形后位置为 $y_i$。\n- 原子能量：$E^{\\mathrm{atom}}(y) = \\sum_{i \\in \\mathbb{Z}} [ \\phi_1(|y_{i+1}-y_i|) + \\phi_2(|y_{i+2}-y_i|) ]$。\n- 力：$f_i(y) = -\\partial E/\\partial y_i$。\n- 均匀变形：$y_i = F x_i = F i a$，其中 $F0$。\n- QC 划分：原子区域 $\\mathcal{A} = \\{ i \\in \\mathbb{Z} : i \\le 0 \\}$，连续介质区域 $\\mathcal{C} = \\{ i \\in \\mathbb{Z} : i \\ge 1 \\}$。\n- QC 能量构建：\n    1. 所有最近邻(NN)键 $\\{i,i+1\\}$ 贡献 $\\phi_1(|y_{i+1}-y_i|)$。\n    2. 满足 $i \\le -2$ 的次近邻(NNN)键 $\\{i,i+2\\}$ 贡献 $\\phi_2(|y_{i+2}-y_i|)$。\n    3. 满足 $i \\ge 1$ 的次近邻键 $\\{i,i+2\\}$ 被近似处理，且其能量贡献相对于 $y_0$ 的变分为零。\n    4. 跨越界面的次近邻键 $\\{ -1, 1 \\}$ 和 $\\{ 0, 2 \\}$ 在QC能量中不被表示。\n\n该问题具有科学依据，是适定的、客观的，并包含足够的信息以得到唯一解。这是准连续介质方法研究中的一个标准问题。因此，该问题是有效的。\n\n原子 $k$ 上的力定义为总能量对其位置 $y_k$ 的负梯度：$f_k^{\\mathrm{qc}} = -\\frac{\\partial E^{\\mathrm{qc}}}{\\partial y_k}$。我们被要求计算界面原子 $k=0$ 上的这个力。\n总QC能量 $E^{\\mathrm{qc}}$ 根据所提供的规则构建：\n$$\nE^{\\mathrm{qc}}(y) = \\sum_{i \\in \\mathbb{Z}} \\phi_1(|y_{i+1}-y_i|) + \\sum_{i \\in \\mathbb{Z}, i \\le -2} \\phi_2(|y_{i+2}-y_i|) + E_{\\mathcal{C}}^{\\mathrm{NNN}}(y_j | j \\ge 1)\n$$\n其中 $E_{\\mathcal{C}}^{\\mathrm{NNN}}$ 是连续介质区域 $\\mathcal{C}$ 中次近邻键的能量，根据定义，它不依赖于 $y_0$。注意，跨越界面的次近邻键（在全原子求和中对应于 $i=-1$ 和 $i=0$）从此能量表达式中被省略了。\n\n为了求出原子 $0$ 上的力 $f_0^{\\mathrm{qc}}$，我们必须对 $E^{\\mathrm{qc}}$ 求关于 $y_0$ 的导数。我们只需要考虑 $E^{\\mathrm{qc}}$ 中是 $y_0$ 函数的项。\n1. 从最近邻相互作用的总和 $\\sum_i \\phi_1(|y_{i+1}-y_i|)$ 中，涉及 $y_0$ 的项是 $i=0$ 和 $i=-1$ 的情况：$\\phi_1(|y_1 - y_0|)$ 和 $\\phi_1(|y_0 - y_{-1}|)$。\n2. 从 $\\mathcal{A}$ 中次近邻相互作用的总和 $\\sum_{i \\le -2} \\phi_2(|y_{i+2}-y_i|)$ 中，涉及 $y_0$ 的项是当 $i+2=0$ 时，即 $i=-2$。这满足条件 $i \\le -2$。所以，该项为 $\\phi_2(|y_0 - y_{-2}|)$。$i=0$ 的项不在此和中。\n3. 根据定义，连续介质能量 $E_{\\mathcal{C}}^{\\mathrm{NNN}}$ 具有 $\\frac{\\partial E_{\\mathcal{C}}^{\\mathrm{NNN}}}{\\partial y_0} = 0$。\n4. 原子 $0$ 和原子 $2$ 之间的次近邻相互作用被明确排除。\n\n因此，QC能量中依赖于 $y_0$ 的部分是：\n$$\nE_{y_0-\\text{dep}}^{\\mathrm{qc}} = \\phi_1(|y_1 - y_0|) + \\phi_1(|y_0 - y_{-1}|) + \\phi_2(|y_0 - y_{-2}|)\n$$\n原子 $0$ 上的力是 $f_0^{\\mathrm{qc}} = -\\frac{\\partial}{\\partial y_0} E_{y_0-\\text{dep}}^{\\mathrm{qc}}$。让我们使用链式法则计算每一项的导数，其中 $\\phi'(r) = \\frac{d\\phi}{dr}(r)$。\n$$\n\\frac{\\partial}{\\partial y_k} \\phi(|y_j - y_i|) = \\phi'(|y_j - y_i|) \\cdot \\mathrm{sgn}(y_j - y_i) \\cdot (\\delta_{kj} - \\delta_{ki})\n$$\n将此应用于我们的各项：\n- 对于 $\\phi_1(|y_1-y_0|)$：$i=0, j=1, k=0$。导数为 $\\phi_1'(|y_1-y_0|) \\mathrm{sgn}(y_1-y_0) (-1) = -\\phi_1'(|y_1-y_0|) \\mathrm{sgn}(y_1-y_0)$。\n- 对于 $\\phi_1(|y_0-y_{-1}|)$：$i=-1, j=0, k=0$。导数为 $\\phi_1'(|y_0-y_{-1}|) \\mathrm{sgn}(y_0-y_{-1}) (1) = \\phi_1'(|y_0-y_{-1}|) \\mathrm{sgn}(y_0-y_{-1})$。\n- 对于 $\\phi_2(|y_0-y_{-2}|)$：$i=-2, j=0, k=0$。导数为 $\\phi_2'(|y_0-y_{-2}|) \\mathrm{sgn}(y_0-y_{-2}) (1) = \\phi_2'(|y_0-y_{-2}|) \\mathrm{sgn}(y_0-y_{-2})$。\n\n将这些导数相加得到 $\\frac{\\partial E^{\\mathrm{qc}}}{\\partial y_0}$。力是这个和的负值：\n$$\nf_0^{\\mathrm{qc}} = -\\left[ -\\phi_1'(|y_1-y_0|)\\mathrm{sgn}(y_1-y_0) + \\phi_1'(|y_0-y_{-1}|)\\mathrm{sgn}(y_0-y_{-1}) + \\phi_2'(|y_0-y_{-2}|)\\mathrm{sgn}(y_0-y_{-2}) \\right]\n$$\n现在，我们对均匀变形 $y_i = F i a$（其中 $F0$ 且 $a0$）计算此表达式的值。\n- 键长 $y_1 - y_0 = F(1)a - F(0)a = Fa$。由于 $Fa0$，所以 $|y_1-y_0| = Fa$ 且 $\\mathrm{sgn}(y_1-y_0)=1$。\n- 键长 $y_0 - y_{-1} = F(0)a - F(-1)a = Fa$。由于 $Fa0$，所以 $|y_0-y_{-1}| = Fa$ 且 $\\mathrm{sgn}(y_0-y_{-1})=1$。\n- 键长 $y_0 - y_{-2} = F(0)a - F(-2)a = 2Fa$。由于 $2Fa0$，所以 $|y_0-y_{-2}| = 2Fa$ 且 $\\mathrm{sgn}(y_0-y_{-2})=1$。\n\n将这些代入力的表达式中：\n$$\nf_0^{\\mathrm{qc}} = -\\left[ -\\phi_1'(Fa) \\cdot (1) + \\phi_1'(Fa) \\cdot (1) + \\phi_2'(2Fa) \\cdot (1) \\right]\n$$\n$$\nf_0^{\\mathrm{qc}} = -\\left[ -\\phi_1'(Fa) + \\phi_1'(Fa) + \\phi_2'(2Fa) \\right]\n$$\n$$\nf_0^{\\mathrm{qc}} = - [ 0 + \\phi_2'(2Fa) ] = -\\phi_2'(2Fa)\n$$\n这个非零的力就是界面处的鬼力。它的出现是因为在QC能量公式中，来自原子 $2$ 对原子 $0$ 的力贡献缺失了，从而打破了在全原子系统中存在的力平衡。在原子系统中，原子 $2$ 对原子 $0$ 的力将是 $\\phi_2'(|y_2-y_0|)\\mathrm{sgn}(y_2-y_0) = \\phi_2'(2Fa)$，这恰好是在均匀变形下作用于原子 $0$ 的所有其他力的总和的负值，从而确保了总力为零。QC方法省略了这一个相互作用项，导致了所计算出的残余力。\n最终表达式用 $F$、$a$ 和在次近邻键长 $2Fa$ 处求值的势 $\\phi_2$ 的导数表示。", "answer": "$$\n\\boxed{-\\phi_2'(2Fa)}\n$$", "id": "2678008"}]}