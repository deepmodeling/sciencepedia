{"hands_on_practices": [{"introduction": "本节的第一个实践是后续所有内容的基础。它将指导你从一个给定的应变能势函数出发，直接推导切向刚度张量。这个练习旨在强化热力学（势函数）与材料增量本构响应之间的联系，并介绍在参考构型和当前构型之间转换张量的关键操作——前推（push-forward）运算。通过这个计算，你将掌握从亥姆霍兹自由能推导一致性切向模量的核心技能。[@problem_id:2655396]", "problem": "考虑一个可压缩超弹性固体，其每个参考体积的储能密度由势函数 $\\Psi(\\mathbf{C}) = \\dfrac{\\mu}{2}\\left(\\operatorname{tr}\\mathbf{C} - 3\\right) - \\mu \\ln J + \\dfrac{\\kappa}{2}\\left(\\ln J\\right)^{2}$ 给出，其中 $\\mathbf{F}$ 是变形梯度，$\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$ 是右柯西-格林 (RCC) 张量，$J = \\det \\mathbf{F}$，$\\mu > 0$ 是剪切模量，$\\kappa > 0$ 是体积模量。令 $\\mathbf{E} = \\dfrac{1}{2}(\\mathbf{C} - \\mathbf{I})$ 为格林-拉格朗日应变 (GLS)，$\\mathbf{S}$ 为第二皮奥拉-基尔霍夫 (SPK) 应力，$\\boldsymbol{\\tau}$ 为基尔霍夫应力，$\\mathbf{d}$ 为变形率 (ROD)。\n使用虚功原理和有限变形的标准运动学，按以下步骤进行：\n- 从参考构型虚功 $\\delta W_{\\text{int}} = \\int_{\\Omega_{0}} \\mathbf{S} : \\delta \\mathbf{E}\\,\\mathrm{d}\\Omega_{0}$ 和当前构型虚功 $\\delta W_{\\text{int}} = \\int_{\\Omega} \\boldsymbol{\\tau} : \\delta \\mathbf{d}\\,\\mathrm{d}v$ 出发，推导与 $\\Psi(\\mathbf{C})$ 相关的材料弹性（切线）张量 $\\mathbb{A} = \\dfrac{\\partial \\mathbf{S}}{\\partial \\mathbf{E}}$。\n- 通过线性化虚功并使用客观运动学，推导空间弹性（切线）张量 $\\mathfrak{a}$，该张量将基尔霍夫应力的李导数与变形率关联起来，并通过 $\\mathbf{F}$ 和 $J$ 的前推操作将其与 $\\mathbb{A}$ 联系起来。\n- 将您的结果应用于均匀各向同性膨胀 $\\mathbf{F} = \\lambda \\mathbf{I}$ 的特殊情况，其中 $\\lambda > 0$。在此状态下，将空间切线张量 $\\mathfrak{a}$ 的单个分量 $a_{1111}$ 计算为以 $\\mu$、$\\kappa$ 和 $\\lambda$ 表示的封闭形式解析表达式。\n您的最终答案必须是仅包含 $\\mu$、$\\kappa$ 和 $\\lambda$ 的 $a_{1111}$ 的解析表达式。不要代入数值，也不要在最终答案中包含单位。", "solution": "所述问题经过了严格的验证。\n\n### 步骤 1: 提取已知条件\n- 储能密度函数：$\\Psi(\\mathbf{C}) = \\dfrac{\\mu}{2}\\left(\\operatorname{tr}\\mathbf{C} - 3\\right) - \\mu \\ln J + \\dfrac{\\kappa}{2}\\left(\\ln J\\right)^{2}$。\n- 运动学变量：变形梯度 $\\mathbf{F}$，右柯西-格林张量 $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$，雅可比行列式 $J = \\det \\mathbf{F}$，格林-拉格朗日应变 $\\mathbf{E} = \\dfrac{1}{2}(\\mathbf{C} - \\mathbf{I})$。\n- 材料参数：剪切模量 $\\mu > 0$，体积模量 $\\kappa > 0$。\n- 应力和刚度度量：第二皮奥拉-基尔霍夫 (SPK) 应力 $\\mathbf{S}$，基尔霍夫应力 $\\boldsymbol{\\tau}$，材料弹性张量 $\\mathbb{A} = \\dfrac{\\partial \\mathbf{S}}{\\partial \\mathbf{E}}$，空间弹性张量 $\\mathfrak{a}$。\n- 虚功原理：参考构型形式 $\\delta W_{\\text{int}} = \\int_{\\Omega_{0}} \\mathbf{S} : \\delta \\mathbf{E}\\,\\mathrm{d}\\Omega_{0}$，当前构型形式 $\\delta W_{\\text{int}} = \\int_{\\Omega} \\boldsymbol{\\tau} : \\delta \\mathbf{d}\\,\\mathrm{d}v$。\n- 特定变形状态：均匀各向同性膨胀 $\\mathbf{F} = \\lambda \\mathbf{I}$，其中 $\\lambda > 0$。\n- 目标：求指定膨胀下空间切线张量 $\\mathfrak{a}$ 的分量 $a_{1111}$。\n\n### 步骤 2: 使用提取的已知条件进行验证\n该问题在科学上基于非线性连续介质力学和超弹性理论的既有理论。所提供的储能函数是一个已知且有效的可压缩模型。所有定义、变量和原理（$\\mathbf{F}$、$\\mathbf{C}$、$\\mathbf{S}$、$\\Psi$、虚功）在该领域都是标准的。该问题是适定的，提供了通过逻辑步骤序列推导出唯一解所需的所有必要信息。语言客观且明确。这些任务与固体力学中虚功线性化的主题直接相关。因此，该问题被认为是有效的。\n\n### 步骤 3: 推导\n求解过程首先从给定的势函数 $\\Psi$ 推导出 SPK 应力张量 $\\mathbf{S}$ 和材料切线模量 $\\mathbb{A}$。然后，通过前推操作获得空间切线模量 $\\mathfrak{a}$。最后，针对均匀膨胀的特定情况对这些张量进行求值，以找到分量 $\\mathfrak{a}_{1111}$。\n\n首先，我们将储能函数 $\\Psi$ 完全用右柯西-格林张量 $\\mathbf{C}$ 表示。使用恒等式 $J = (\\det \\mathbf{C})^{1/2}$，我们有：\n$$\n\\Psi(\\mathbf{C}) = \\dfrac{\\mu}{2}(\\operatorname{tr}\\mathbf{C} - 3) - \\mu \\ln((\\det \\mathbf{C})^{1/2}) + \\dfrac{\\kappa}{2}(\\ln((\\det \\mathbf{C})^{1/2}))^{2}\n$$\n$$\n\\Psi(\\mathbf{C}) = \\dfrac{\\mu}{2}(\\operatorname{tr}\\mathbf{C} - 3) - \\dfrac{\\mu}{2}\\ln(\\det \\mathbf{C}) + \\dfrac{\\kappa}{8}(\\ln(\\det \\mathbf{C}))^{2}\n$$\n第二皮奥拉-基尔霍夫应力 $\\mathbf{S}$ 是通过 $\\Psi$ 对格林-拉格朗日应变 $\\mathbf{E}$ 求导得出的。使用链式法则以及 $\\mathbf{E} = \\frac{1}{2}(\\mathbf{C} - \\mathbf{I})$（这意味着 $\\mathrm{d}\\mathbf{E} = \\frac{1}{2}\\mathrm{d}\\mathbf{C}$），我们得到：\n$$\n\\mathbf{S} = \\dfrac{\\partial \\Psi}{\\partial \\mathbf{E}} = 2\\dfrac{\\partial \\Psi}{\\partial \\mathbf{C}}\n$$\n我们使用标准张量恒等式 $\\frac{\\partial(\\operatorname{tr}\\mathbf{C})}{\\partial \\mathbf{C}} = \\mathbf{I}$ 和 $\\frac{\\partial(\\ln(\\det\\mathbf{C}))}{\\partial \\mathbf{C}} = \\mathbf{C}^{-1}$。\n$$\n\\mathbf{S} = 2\\left[ \\dfrac{\\mu}{2}\\mathbf{I} - \\dfrac{\\mu}{2}\\mathbf{C}^{-1} + \\dfrac{\\kappa}{8}(2\\ln(\\det\\mathbf{C}))\\mathbf{C}^{-1} \\right]\n$$\n$$\n\\mathbf{S} = \\mu\\mathbf{I} - \\mu\\mathbf{C}^{-1} + \\dfrac{\\kappa}{2}\\ln(\\det\\mathbf{C})\\mathbf{C}^{-1}\n$$\n重新整理并使用 $\\ln(\\det\\mathbf{C}) = 2\\ln J$：\n$$\n\\mathbf{S} = \\mu\\mathbf{I} + (\\kappa\\ln J - \\mu)\\mathbf{C}^{-1}\n$$\n接下来，我们推导四阶材料切线模量 $\\mathbb{A} = \\frac{\\partial \\mathbf{S}}{\\partial \\mathbf{E}} = 2\\frac{\\partial \\mathbf{S}}{\\partial \\mathbf{C}}$。我们需要 $\\mathbf{C}^{-1}$ 对 $\\mathbf{C}$ 的导数。其分量形式为 $\\frac{\\partial C_{IJ}^{-1}}{\\partial C_{KL}} = -\\frac{1}{2}(C_{IK}^{-1}C_{LJ}^{-1} + C_{IL}^{-1}C_{KJ}^{-1})$。\n$$\n\\mathbb{A} = 2\\dfrac{\\partial}{\\partial \\mathbf{C}} \\left[ \\mu\\mathbf{I} + \\left(\\dfrac{\\kappa}{2}\\ln(\\det\\mathbf{C}) - \\mu\\right)\\mathbf{C}^{-1} \\right]\n$$\n应用求导的乘法法则：\n$$\n\\mathbb{A}_{IJKL} = 2 \\left[ \\left( \\dfrac{\\kappa}{2}\\dfrac{\\partial(\\ln(\\det\\mathbf{C}))}{\\partial C_{KL}} \\right) C_{IJ}^{-1} + \\left(\\dfrac{\\kappa}{2}\\ln(\\det\\mathbf{C}) - \\mu\\right) \\dfrac{\\partial C_{IJ}^{-1}}{\\partial C_{KL}} \\right]\n$$\n$$\n\\mathbb{A}_{IJKL} = 2 \\left[ \\dfrac{\\kappa}{2} C_{KL}^{-1} C_{IJ}^{-1} + \\left(\\dfrac{\\kappa}{2}\\ln(\\det\\mathbf{C}) - \\mu\\right) \\left(-\\dfrac{1}{2}(C_{IK}^{-1}C_{LJ}^{-1} + C_{IL}^{-1}C_{KJ}^{-1})\\right) \\right]\n$$\n$$\n\\mathbb{A}_{IJKL} = \\kappa C_{IJ}^{-1}C_{KL}^{-1} - (\\kappa\\ln(\\det\\mathbf{C}) - 2\\mu) \\dfrac{1}{2}(C_{IK}^{-1}C_{JL}^{-1} + C_{IL}^{-1}C_{JK}^{-1})\n$$\n代入 $\\ln(\\det\\mathbf{C}) = 2\\ln J$：\n$$\n\\mathbb{A}_{IJKL} = \\kappa C_{IJ}^{-1}C_{KL}^{-1} + (\\mu - \\kappa\\ln J)(C_{IK}^{-1}C_{JL}^{-1} + C_{IL}^{-1}C_{JK}^{-1})\n$$\n空间弹性张量 $\\mathfrak{a}$ 通过前推操作与材料张量 $\\mathbb{A}$ 相关联：\n$$\n\\mathfrak{a}_{ijkl} = J^{-1} F_{iI}F_{jJ}F_{kK}F_{lL} A_{IJKL}\n$$\n现在我们将其应用于均匀各向同性膨胀的特殊情况，$\\mathbf{F} = \\lambda\\mathbf{I}$。这得到：\n$$\nJ = \\det(\\lambda\\mathbf{I}) = \\lambda^{3}\n$$\n$$\n\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F} = (\\lambda\\mathbf{I})^{\\mathsf{T}}(\\lambda\\mathbf{I}) = \\lambda^{2}\\mathbf{I}\n$$\n$$\n\\mathbf{C}^{-1} = \\lambda^{-2}\\mathbf{I} \\quad \\text{或} \\quad C_{IJ}^{-1} = \\lambda^{-2}\\delta_{IJ}\n$$\n将这些代入 $\\mathbb{A}$ 的表达式中：\n$$\nA_{IJKL} = \\kappa (\\lambda^{-2}\\delta_{IJ})(\\lambda^{-2}\\delta_{KL}) + (\\mu - \\kappa\\ln(\\lambda^{3}))(\\lambda^{-2}\\delta_{IK}\\lambda^{-2}\\delta_{JL} + \\lambda^{-2}\\delta_{IL}\\lambda^{-2}\\delta_{JK})\n$$\n$$\nA_{IJKL} = \\kappa\\lambda^{-4}\\delta_{IJ}\\delta_{KL} + \\lambda^{-4}(\\mu - 3\\kappa\\ln\\lambda)(\\delta_{IK}\\delta_{JL} + \\delta_{IL}\\delta_{JK})\n$$\n现在，我们执行前推操作以得到 $\\mathfrak{a}$。对于 $\\mathbf{F} = \\lambda\\mathbf{I}$，我们有 $F_{iI} = \\lambda\\delta_{iI}$。\n$$\n\\mathfrak{a}_{ijkl} = (\\lambda^{3})^{-1} (\\lambda\\delta_{iI})(\\lambda\\delta_{jJ})(\\lambda\\delta_{kK})(\\lambda\\delta_{lL}) A_{IJKL}\n$$\n$$\n\\mathfrak{a}_{ijkl} = \\lambda^{-3}\\lambda^{4} A_{ijkl} = \\lambda A_{ijkl}\n$$\n由于 $\\delta_{iI}$ 将 $I$ 与 $i$、$J$ 与 $j$ 等进行缩并，因此可以直接替换索引。\n$$\n\\mathfrak{a}_{ijkl} = \\lambda \\left[ \\kappa\\lambda^{-4}\\delta_{ij}\\delta_{kl} + \\lambda^{-4}(\\mu - 3\\kappa\\ln\\lambda)(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}) \\right]\n$$\n$$\n\\mathfrak{a}_{ijkl} = \\kappa\\lambda^{-3}\\delta_{ij}\\delta_{kl} + \\lambda^{-3}(\\mu - 3\\kappa\\ln\\lambda)(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})\n$$\n这是空间切线模量的表达式。题目要求我们找到分量 $\\mathfrak{a}_{1111}$。我们令 $i=1$, $j=1$, $k=1$, $l=1$：\n$$\n\\mathfrak{a}_{1111} = \\kappa\\lambda^{-3}\\delta_{11}\\delta_{11} + \\lambda^{-3}(\\mu - 3\\kappa\\ln\\lambda)(\\delta_{11}\\delta_{11} + \\delta_{11}\\delta_{11})\n$$\n由于 $\\delta_{11} = 1$：\n$$\n\\mathfrak{a}_{1111} = \\kappa\\lambda^{-3}(1) + \\lambda^{-3}(\\mu - 3\\kappa\\ln\\lambda)(1 + 1)\n$$\n$$\n\\mathfrak{a}_{1111} = \\kappa\\lambda^{-3} + 2\\lambda^{-3}(\\mu - 3\\kappa\\ln\\lambda)\n$$\n$$\n\\mathfrak{a}_{1111} = \\lambda^{-3}[\\kappa + 2\\mu - 6\\kappa\\ln\\lambda]\n$$\n$$\n\\mathfrak{a}_{1111} = \\lambda^{-3}[2\\mu + \\kappa(1 - 6\\ln\\lambda)]\n$$\n这就是最终的解析表达式。", "answer": "$$\n\\boxed{\\frac{2\\mu + \\kappa(1 - 6\\ln\\lambda)}{\\lambda^{3}}}\n$$", "id": "2655396"}, {"introduction": "在掌握了如何从势函数推导切向刚度之后，下一个实践将探讨当外力无法从一个势函数导出时的情况。通过分析一个典型的非保守“随动荷载”，你将发现其线性化算子（即切向刚度）不再是对称的。这个发现对于理解结构在此类荷载作用下的稳定性（例如颤振等动态失稳现象）以及对其进行数值模拟时对求解器提出的特殊要求至关重要。[@problem_id:2655351]", "problem": "一个位于位置向量 $\\boldsymbol{q} \\in \\mathbb{R}^{2}$ 处的二维点状末端执行器受到一个大小为 $P>0$ 的恒定随动推力，该推力的方向始终与经过当前位置 $\\boldsymbol{q}$、以原点为中心的圆的逆时针切线方向重合。切向单位向量由下式给出\n$$\n\\boldsymbol{t}(\\boldsymbol{q}) \\;=\\; \\frac{\\boldsymbol{R}\\,\\boldsymbol{q}}{\\|\\boldsymbol{q}\\|},\n$$\n其中 $\\|\\cdot\\|$ 表示欧几里得范数，$\\boldsymbol{R}$ 是平面内恒定的旋转九十度算子，\n$$\n\\boldsymbol{R} \\;=\\; \\begin{bmatrix} 0  -1 \\\\ 1  0 \\end{bmatrix}.\n$$\n因此，外部随动力为 $\\boldsymbol{f}(\\boldsymbol{q}) = P\\,\\boldsymbol{t}(\\boldsymbol{q})$。外虚功为\n$$\n\\delta W_{\\mathrm{ext}}(\\boldsymbol{q};\\delta \\boldsymbol{q}) \\;=\\; \\boldsymbol{f}(\\boldsymbol{q}) \\cdot \\delta \\boldsymbol{q}.\n$$\n考虑非线性虚功在基准构型 $\\boldsymbol{q}_{0} = \\begin{bmatrix} L \\\\ 0 \\end{bmatrix}$（其中 $L>0$）附近的线性化，即对于增量 $\\Delta \\boldsymbol{q}$ 和虚位移 $\\delta \\boldsymbol{q}$，\n$$\n\\Delta\\big(\\delta W_{\\mathrm{ext}}\\big) \\;=\\; \\delta \\boldsymbol{q}^{\\mathsf{T}} \\,\\boldsymbol{K}\\, \\Delta \\boldsymbol{q} \\;+\\; \\text{高阶项},\n$$\n其中 $\\boldsymbol{K} = \\left.\\dfrac{\\partial \\boldsymbol{f}}{\\partial \\boldsymbol{q}}\\right|_{\\boldsymbol{q}_{0}}$ 是切线算子。仅从外虚功的定义和给定的随动力方向出发，不使用任何预先给出的线性化公式，完成以下任务：\n\n- 在 $\\boldsymbol{q}_{0}$ 处显式推导 $\\boldsymbol{K}$。\n- 证明 $\\boldsymbol{K}$ 是非对称的，从而构建一个在非保守随动载荷下非线性虚功的线性化不对称的反例。\n- 从载荷方向对构型的依赖性以及相关的势能不存在性方面，解释反对称性的物理根源。\n\n最后，为了量化线性化虚功中的不对称性，计算差异\n$$\nM \\;=\\; \\Delta\\big(\\delta W_{\\mathrm{ext}}\\big)\\big|_{\\delta \\boldsymbol{q}=\\boldsymbol{e}_{1},\\,\\Delta \\boldsymbol{q}=\\boldsymbol{e}_{2}} \\;-\\; \\Delta\\big(\\delta W_{\\mathrm{ext}}\\big)\\big|_{\\delta \\boldsymbol{q}=\\boldsymbol{e}_{2},\\,\\Delta \\boldsymbol{q}=\\boldsymbol{e}_{1}},\n$$\n其中 $\\boldsymbol{e}_{1}=\\begin{bmatrix}1\\\\0\\end{bmatrix}$ 和 $\\boldsymbol{e}_{2}=\\begin{bmatrix}0\\\\1\\end{bmatrix}$ 是规范基向量。用 $P$ 和 $L$ 的封闭解析表达式符号化地表示最终答案。最终答案中不包含单位。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 位置向量：$\\boldsymbol{q} \\in \\mathbb{R}^{2}$。\n- 推力大小：$P > 0$，恒定。\n- 力的方向：切向单位向量 $\\boldsymbol{t}(\\boldsymbol{q}) = \\frac{\\boldsymbol{R}\\,\\boldsymbol{q}}{\\|\\boldsymbol{q}\\|}$。\n- 旋转算子：$\\boldsymbol{R} = \\begin{bmatrix} 0  -1 \\\\ 1  0 \\end{bmatrix}$。\n- 外部随动力：$\\boldsymbol{f}(\\boldsymbol{q}) = P\\,\\boldsymbol{t}(\\boldsymbol{q})$。\n- 外虚功：$\\delta W_{\\mathrm{ext}}(\\boldsymbol{q};\\delta \\boldsymbol{q}) = \\boldsymbol{f}(\\boldsymbol{q}) \\cdot \\delta \\boldsymbol{q}$。\n- 用于线性化的基准构型：$\\boldsymbol{q}_{0} = \\begin{bmatrix} L \\\\ 0 \\end{bmatrix}$，其中 $L>0$。\n- 虚功的线性化：$\\Delta\\big(\\delta W_{\\mathrm{ext}}\\big) = \\delta \\boldsymbol{q}^{\\mathsf{T}} \\,\\boldsymbol{K}\\, \\Delta \\boldsymbol{q} + \\text{高阶项}$。\n- 切线算子：$\\boldsymbol{K} = \\left.\\dfrac{\\partial \\boldsymbol{f}}{\\partial \\boldsymbol{q}}\\right|_{\\boldsymbol{q}_{0}}$。\n- 待求的差异：$M = \\Delta\\big(\\delta W_{\\mathrm{ext}}\\big)\\big|_{\\delta \\boldsymbol{q}=\\boldsymbol{e}_{1},\\,\\Delta \\boldsymbol{q}=\\boldsymbol{e}_{2}} - \\Delta\\big(\\delta W_{\\mathrm{ext}}\\big)\\big|_{\\delta \\boldsymbol{q}=\\boldsymbol{e}_{2},\\,\\Delta \\boldsymbol{q}=\\boldsymbol{e}_{1}}$。\n- 基向量：$\\boldsymbol{e}_{1}=\\begin{bmatrix}1\\\\0\\end{bmatrix}$ 和 $\\boldsymbol{e}_{2}=\\begin{bmatrix}0\\\\1\\end{bmatrix}$。\n\n**步骤 2：验证**\n该问题具有科学依据、提法恰当且客观。它描述了连续介质力学中的一个标准非保守随动力问题。所有术语都有数学定义，所提供的数据是自洽且一致的。该问题不违反任何物理学或数学的基本原理。这是一个严谨且可形式化的问题，是非线性力学主题的核心。\n\n**步骤 3：结论**\n该问题有效。将推导其解。\n\n第一个任务是推导切线刚度算子 $\\boldsymbol{K}$。我们首先用 $\\boldsymbol{q} = \\begin{bmatrix} q_1 \\\\ q_2 \\end{bmatrix}$ 的分量来表示力向量 $\\boldsymbol{f}(\\boldsymbol{q})$。\n范数为 $\\|\\boldsymbol{q}\\| = \\sqrt{q_1^2 + q_2^2}$。旋转后的向量为 $\\boldsymbol{R}\\,\\boldsymbol{q} = \\begin{bmatrix} -q_2 \\\\ q_1 \\end{bmatrix}$。\n因此，力向量为：\n$$\n\\boldsymbol{f}(\\boldsymbol{q}) = \\begin{bmatrix} f_1(q_1, q_2) \\\\ f_2(q_1, q_2) \\end{bmatrix} = \\frac{P}{\\sqrt{q_1^2 + q_2^2}} \\begin{bmatrix} -q_2 \\\\ q_1 \\end{bmatrix}\n$$\n切线算子 $\\boldsymbol{K}$ 是 $\\boldsymbol{f}$ 关于 $\\boldsymbol{q}$ 的雅可比矩阵：\n$$\n\\boldsymbol{K} = \\frac{\\partial \\boldsymbol{f}}{\\partial \\boldsymbol{q}} = \\begin{bmatrix} \\frac{\\partial f_1}{\\partial q_1} & \\frac{\\partial f_1}{\\partial q_2} \\\\ \\frac{\\partial f_2}{\\partial q_1} & \\frac{\\partial f_2}{\\partial q_2} \\end{bmatrix}\n$$\n我们计算 $\\boldsymbol{f}$ 各分量的偏导数。\n对于 $f_1 = -P q_2 (q_1^2 + q_2^2)^{-1/2}$：\n$$\n\\frac{\\partial f_1}{\\partial q_1} = -P q_2 \\left(-\\frac{1}{2}(q_1^2 + q_2^2)^{-3/2}(2q_1)\\right) = \\frac{P q_1 q_2}{(q_1^2 + q_2^2)^{3/2}}\n$$\n$$\n\\frac{\\partial f_1}{\\partial q_2} = P \\frac{\\partial}{\\partial q_2} \\left(\\frac{-q_2}{(q_1^2 + q_2^2)^{1/2}}\\right) = P \\left[ \\frac{-1 \\cdot (q_1^2+q_2^2)^{1/2} - (-q_2) \\cdot \\frac{1}{2}(q_1^2+q_2^2)^{-1/2}(2q_2)}{q_1^2+q_2^2} \\right] = P \\frac{-(q_1^2+q_2^2)+q_2^2}{(q_1^2+q_2^2)^{3/2}} = \\frac{-P q_1^2}{(q_1^2 + q_2^2)^{3/2}}\n$$\n对于 $f_2 = P q_1 (q_1^2 + q_2^2)^{-1/2}$：\n$$\n\\frac{\\partial f_2}{\\partial q_1} = P \\frac{\\partial}{\\partial q_1} \\left(\\frac{q_1}{(q_1^2 + q_2^2)^{1/2}}\\right) = P \\left[ \\frac{1 \\cdot (q_1^2+q_2^2)^{1/2} - q_1 \\cdot \\frac{1}{2}(q_1^2+q_2^2)^{-1/2}(2q_1)}{q_1^2+q_2^2} \\right] = P \\frac{(q_1^2+q_2^2)-q_1^2}{(q_1^2+q_2^2)^{3/2}} = \\frac{P q_2^2}{(q_1^2 + q_2^2)^{3/2}}\n$$\n$$\n\\frac{\\partial f_2}{\\partial q_2} = P q_1 \\left(-\\frac{1}{2}(q_1^2 + q_2^2)^{-3/2}(2q_2)\\right) = \\frac{-P q_1 q_2}{(q_1^2 + q_2^2)^{3/2}}\n$$\n组合成雅可比矩阵 $\\boldsymbol{K}(\\boldsymbol{q})$：\n$$\n\\boldsymbol{K}(\\boldsymbol{q}) = \\frac{P}{(q_1^2 + q_2^2)^{3/2}} \\begin{bmatrix} q_1 q_2 & -q_1^2 \\\\ q_2^2 & -q_1 q_2 \\end{bmatrix}\n$$\n现在，我们在指定的基准构型 $\\boldsymbol{q}_{0} = \\begin{bmatrix} L \\\\ 0 \\end{bmatrix}$ 处计算该矩阵。此时，$q_1 = L$ 且 $q_2 = 0$。分母变为 $(L^2 + 0^2)^{3/2} = L^3$。\n将这些值代入 $\\boldsymbol{K}$ 的分量中：\n$$\nK_{11} = \\frac{P(L)(0)}{L^3} = 0\n$$\n$$\nK_{12} = \\frac{-P(L^2)}{L^3} = -\\frac{P}{L}\n$$\n$$\nK_{21} = \\frac{P(0^2)}{L^3} = 0\n$$\n$$\nK_{22} = \\frac{-P(L)(0)}{L^3} = 0\n$$\n所以，在 $\\boldsymbol{q}_{0}$ 处的切线算子为：\n$$\n\\boldsymbol{K} = \\begin{bmatrix} 0 & -\\frac{P}{L} \\\\ 0 & 0 \\end{bmatrix}\n$$\n为了证明 $\\boldsymbol{K}$ 是非对称的，我们计算其转置：\n$$\n\\boldsymbol{K}^{\\mathsf{T}} = \\begin{bmatrix} 0 & 0 \\\\ -\\frac{P}{L} & 0 \\end{bmatrix}\n$$\n由于 $P>0$ 和 $L>0$，项 $-P/L$ 非零。显然 $K_{12} = -P/L$ 而 $K_{21} = 0$，所以 $K_{12} \\neq K_{21}$。因此，$\\boldsymbol{K} \\neq \\boldsymbol{K}^{\\mathsf{T}}$，切线刚度矩阵是非对称的。这就构成了所要求的反例。\n\n这种不对称性的物理根源在于随动力的非保守性质。一个力场 $\\boldsymbol{f}$ 是保守的，当且仅当它是一个标量势的梯度，即 $\\boldsymbol{f} = -\\nabla V$。一个力场是保守的必要条件是其雅可比矩阵对称。这是混合偏导数相等性（克莱罗定理）的结果，因为 $K_{ij} = \\frac{\\partial f_i}{\\partial q_j} = \\frac{\\partial}{\\partial q_j}(-\\frac{\\partial V}{\\partial q_i}) = -\\frac{\\partial^2 V}{\\partial q_j \\partial q_i}$，这必须等于 $K_{ji} = -\\frac{\\partial^2 V}{\\partial q_i \\partial q_j}$。由于我们已经证明了 $\\boldsymbol{K}$ 是不对称的，因此力 $\\boldsymbol{f}(\\boldsymbol{q})$ 不存在这样的势 $V(\\boldsymbol{q})$。这也可以通过计算二维力场的旋度来验证：\n$$\n(\\text{curl}\\,\\boldsymbol{f})_z = \\frac{\\partial f_2}{\\partial q_1} - \\frac{\\partial f_1}{\\partial q_2} = \\frac{P q_2^2}{(q_1^2 + q_2^2)^{3/2}} - \\left(\\frac{-P q_1^2}{(q_1^2 + q_2^2)^{3/2}}\\right) = \\frac{P(q_1^2 + q_2^2)}{(q_1^2 + q_2^2)^{3/2}} = \\frac{P}{\\sqrt{q_1^2 + q_2^2}} = \\frac{P}{\\|\\boldsymbol{q}\\|}\n$$\n旋度不为零（对于 $\\|\\boldsymbol{q}\\|  \\infty$），这证明了该力场是旋转的，因此是非保守的。该力所做的功与路径有关。切线刚度矩阵 $\\boldsymbol{K}$ 中的不对称性是随动载荷方向依赖于构型的直接数学体现，这种依赖性使得功无法表示为势能的变化。\n\n最后，我们计算差异 $M$。线性化虚功为 $\\Delta(\\delta W_{\\mathrm{ext}}) = \\delta \\boldsymbol{q}^{\\mathsf{T}} \\boldsymbol{K} \\Delta \\boldsymbol{q}$。\n差异定义为：\n$$\nM = \\left(\\boldsymbol{e}_{1}^{\\mathsf{T}} \\boldsymbol{K} \\boldsymbol{e}_{2}\\right) - \\left(\\boldsymbol{e}_{2}^{\\mathsf{T}} \\boldsymbol{K} \\boldsymbol{e}_{1}\\right)\n$$\n该表达式就是 $\\boldsymbol{K}$ 的非对角线分量之差：\n$$\nM = K_{12} - K_{21}\n$$\n使用在 $\\boldsymbol{q}_{0}$ 处计算的 $\\boldsymbol{K}$ 的分量：\n$$\nK_{12} = -\\frac{P}{L}\n$$\n$$\nK_{21} = 0\n$$\n代入这些值得到差异：\n$$\nM = -\\frac{P}{L} - 0 = -\\frac{P}{L}\n$$\n这量化了对于给定的无穷小虚位移和实位移，线性化虚功中的不对称性。", "answer": "$$\n\\boxed{-\\frac{P}{L}}\n$$", "id": "2655351"}, {"introduction": "最后的实践练习将理论与计算实践联系起来，展示了为何严格推导切向模量是至关重要的。你将比较两种不同的线性化策略——“先离散后线性化”（Discretize-then-Linearize）和“先线性化后离散”（Linearize-then-Discretize）——并观察它们对牛顿-拉夫森（Newton-Raphson）求解器收敛性的巨大影响。这个练习突出了“一致性切向”（consistent tangent）的概念，并阐明了它在非线性有限元分析中实现二次收敛速度的关键作用。[@problem_id:2664942]", "problem": "考虑在全拉格朗日框架下，一维超弹性杆的几何非线性轴向变形。参考构型为区间 $[0,L]$，其横截面积 $A$ 为常数。位移场为沿轴向的 $u(X)$，其中 $X$ 是物质坐标。变形梯度为 $F = 1 + \\dfrac{du}{dX}$，Green-Lagrange 应变为 $E = \\dfrac{1}{2}\\left(F^2 - 1\\right)$，本构行为是 Saint-Venant–Kirchhoff 模型，其应变能密度为 $\\psi(E) = \\dfrac{1}{2} E_m E^2$，其中 $E_m$ 是材料模量。第二 Piola–Kirchhoff 应力为 $S = \\dfrac{d\\psi}{dE} = E_m E$。在参考构型中，虚功原理（内力功等于外力功）表示为\n$$ \\int_{0}^{L} A\\, S\\, \\delta E \\, dX \\;=\\; P\\, \\delta u(L), $$\n其中本质边界条件为 $u(0) = 0$，并在 $X = L$ 处施加一个集中外载荷 $P$。\n\n使用参考域上该单元的标准线性形函数，将杆离散化为一个线性（2 节点）有限元，节点位移为 $u_1$ 和 $u_2$。您将实现并比较两种不同的 Newton–Raphson 线性化方案，以求解单个未知数 $u_2$（因为 $u_1=0$）的离散平衡方程：\n\n- 先离散后线性化 (DTL)：首先从离散虚功中精确推导出离散残差，然后计算其关于离散未知数的精确雅可比矩阵（一致切线刚度）。\n- 先线性化后离散 (LTL)：首先使用材料模量将连续体虚功密度对 Green-Lagrange 应变进行线性化（即，仅使用本构线性化 $C = \\dfrac{dS}{dE}$），在形成雅可比矩阵时将从 $u$到 $E$ 的运动学映射视为固定的，然后进行离散化。这将产生一个不同的离散切线刚度，因为运动学算子对位移的依赖性未包含在雅可比矩阵中。\n\n您的任务：\n\n$1.$ 从上述基本定义出发，构建单元素问题（$u_1=0$，未知数 $u_2$）的离散残差。不要假设小应变。表达节点 $X=L$ 处的离散内力，并建立与外载荷 $P$ 的标量平衡方程。\n\n$2.$ 对于 DTL 方法，计算您在任务 1 中推导出的离散残差（关于 $u_2$）的精确导数。\n\n$3.$ 对于 LTL 方法，通过仅在连续体层面使用本构线性化 $C = \\dfrac{dS}{dE}$，然后在雅可比矩阵中保持当前运动学映射不变进行离散化来计算雅可比矩阵（即，在雅可比矩阵中省略运动学映射对位移的导数）。明确证明两个雅可比矩阵不同，并指出 DTL 中存在的附加项。\n\n$4.$ 使用每种雅可比矩阵选择（DTL 和 LTL），为标量未知数 $u_2$ 实现一个 Newton–Raphson 求解器。在两个求解器中使用任务 1 中得到的相同残差，但在牛顿更新中使用各自的雅可比矩阵。\n\n$5.$ 使用相同的初始猜测 $u_2^{(0)} = \\dfrac{P L}{A E_m}$ 进行迭代，直到残差绝对值小于容差 $\\varepsilon_R = 10^{-10}\\,\\mathrm{N}$，或更新量绝对值小于 $\\varepsilon_U = 10^{-12}\\,\\mathrm{m}$，或达到最大迭代次数 $N_{\\max} = 50$。如果方法在达到 $N_{\\max}$ 之前达到容差，则宣布收敛；否则，宣布不收敛。确保您的实现在牛顿更新中防止除零错误。\n\n您必须在以下测试套件上评估这两种方案，该套件固定了几何和材料参数，并改变载荷：\n\n- 固定参数：$L = 1.0\\,\\mathrm{m}$，$A = 0.01\\,\\mathrm{m}^2$，$E_m = 2.10\\times 10^{11}\\,\\mathrm{Pa}$。\n- 载荷：\n  - 情况 $1$：$P = 0\\,\\mathrm{N}$。\n  - 情况 $2$：$P = 0.02 \\times A E_m\\,\\mathrm{N}$。\n  - 情况 $3$：$P = 0.50 \\times A E_m\\,\\mathrm{N}$。\n  - 情况 $4$：$P = 0.90 \\times A E_m\\,\\mathrm{N}$。\n\n对于每种情况，您的程序必须按顺序输出以下内容：使用 DTL 得到的收敛位移（单位：米），DTL 的迭代次数，一个表示 DTL 是否收敛的布尔值，使用 LTL 得到的收敛位移（单位：米，如果不收敛则使用特殊浮点标记 NaN），LTL 的迭代次数，以及一个表示 LTL 是否收敛的布尔值。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个结果列表，每个测试案例一个结果，而每个测试案例的结果本身是包含上述六个值的列表，例如\n$$ [\\,[u_{2,\\mathrm{DTL}},\\, n_{\\mathrm{DTL}},\\, \\mathrm{True},\\, u_{2,\\mathrm{LTL}},\\, n_{\\mathrm{LTL}},\\, \\mathrm{False}],\\; \\ldots\\,] $$\n涉及长度的数值量必须以米为单位，涉及力的数值量必须以牛顿为单位。打印的行必须是单个有效的 Python 列表字面量，使用逗号分隔条目和方括号，仅包含浮点数、整数和布尔值，并按上述顺序排列。", "solution": "所提出的问题是计算固体力学中一个有效且适定的练习，要求将 Newton-Raphson 方法应用于通过有限元方法离散化的几何非线性问题。它是一个典型的例子，用于比较基于一致切线刚度（先离散后线性化，DTL）的二次收敛方案与使用不一致切线刚度（先线性化后离散，LTL）的方案，从而展示了非线性有限元分析的基本概念。所有提供的数据在科学上都是合理、一致且足以推导出唯一解的。我们将继续进行推导和求解。\n\n分析始于对跨越域 $X \\in [0,L]$ 的单个双节点有限元的连续介质力学公式进行离散化。\n\n**1. 离散化与残差公式**\n\n位移场 $u(X)$ 通过线性形函数 $N_1(X) = 1 - X/L$ 和 $N_2(X) = X/L$ 进行近似。对于节点位移 $u_1$ 和 $u_2$，位移场为 $u(X) = u_1 N_1(X) + u_2 N_2(X)$。应用本质边界条件 $u(0) = 0$ 意味着 $u_1 = 0$，从而将位移场简化为：\n$$ u(X) = u_2 N_2(X) = u_2 \\frac{X}{L} $$\n位移梯度在整个单元内是恒定的：\n$$ \\frac{du}{dX} = \\frac{d}{dX} \\left( u_2 \\frac{X}{L} \\right) = \\frac{u_2}{L} $$\n由此，我们推导出变形梯度 $F$ 和 Green-Lagrange 应变 $E$：\n$$ F = 1 + \\frac{du}{dX} = 1 + \\frac{u_2}{L} $$\n$$ E = \\frac{1}{2}(F^2 - 1) = \\frac{1}{2}\\left[\\left(1 + \\frac{u_2}{L}\\right)^2 - 1\\right] = \\frac{u_2}{L} + \\frac{1}{2}\\left(\\frac{u_2}{L}\\right)^2 $$\n材料是 Saint-Venant–Kirchhoff 类型，因此第二 Piola-Kirchhoff 应力 $S$ 通过模量 $E_m$ 与 Green-Lagrange 应变线性相关：\n$$ S = E_m E = E_m \\left[ \\frac{u_2}{L} + \\frac{1}{2}\\left(\\frac{u_2}{L}\\right)^2 \\right] $$\n虚功原理 $\\int_{0}^{L} A S \\delta E \\, dX = P \\delta u(L)$ 提供了控制平衡方程。应变的变分 $\\delta E$ 通过应用变分算子 $\\delta$ 得到：\n$$ \\delta E = \\frac{dE}{du_2} \\delta u_2 = \\left[ \\frac{1}{L} + \\frac{u_2}{L^2} \\right] \\delta u_2 = \\frac{1}{L} \\left( 1 + \\frac{u_2}{L} \\right) \\delta u_2 = \\frac{F}{L} \\delta u_2 $$\n加载端的虚位移为 $\\delta u(L) = \\delta u_2$。由于所有运动学量（$F$、$E$、$S$、$\\delta E$）在单个单元域上都是常数，虚功表达式中的积分变得非常简单：\n$$ \\text{内虚功 (IVW)} = \\int_{0}^{L} A S \\delta E \\, dX = A S (\\delta E) L = A S \\left( \\frac{F}{L} \\delta u_2 \\right) L = A S F \\delta u_2 $$\n节点 2 处的离散内力 $f_{\\text{int}}$ 是 $\\delta u_2$ 的系数：\n$$ f_{\\text{int}}(u_2) = A S F = A (E_m E) F = A E_m \\left[ \\frac{u_2}{L} + \\frac{1}{2}\\left(\\frac{u_2}{L}\\right)^2 \\right] \\left( 1 + \\frac{u_2}{L} \\right) $$\n平衡要求内力等于外力，即 $f_{\\text{int}} = P$。用于 Newton-Raphson 过程的残差函数 $R(u_2)$ 定义为内力和外力之间的不平衡量：\n$$ R(u_2) = f_{\\text{int}}(u_2) - P = A E_m \\left[ \\frac{u_2}{L} + \\frac{1}{2}\\left(\\frac{u_2}{L}\\right)^2 \\right] \\left( 1 + \\frac{u_2}{L} \\right) - P $$\n\n**2. 先离散后线性化 (DTL) 雅可比矩阵**\n\nDTL 方法通过对离散残差 $R(u_2)$ 求关于未知数 $u_2$ 的精确导数来推导切线刚度（雅可比矩阵）。这得到了一致切线刚度，它能确保 Newton-Raphson 方法在解附近具有二次收敛性。\n$$ K_{\\text{DTL}}(u_2) = \\frac{d R(u_2)}{d u_2} = \\frac{d f_{\\text{int}}(u_2)}{d u_2} $$\n使用表达式 $f_{\\text{int}} = A E_m E F$ 并应用乘法法则：\n$$ K_{\\text{DTL}} = A E_m \\frac{d}{du_2}(E F) = A E_m \\left[ \\left(\\frac{dE}{du_2}\\right) F + E \\left(\\frac{dF}{du_2}\\right) \\right] $$\n所需的导数为：\n$$ \\frac{dF}{du_2} = \\frac{d}{du_2}\\left(1 + \\frac{u_2}{L}\\right) = \\frac{1}{L} $$\n$$ \\frac{dE}{du_2} = \\frac{d}{du_2}\\left(\\frac{u_2}{L} + \\frac{1}{2}\\frac{u_2^2}{L^2}\\right) = \\frac{1}{L} + \\frac{u_2}{L^2} = \\frac{1}{L}\\left(1+\\frac{u_2}{L}\\right) = \\frac{F}{L} $$\n将这些代入 $K_{\\text{DTL}}$ 的表达式中：\n$$ K_{\\text{DTL}} = A E_m \\left[ \\left(\\frac{F}{L}\\right)F + E\\left(\\frac{1}{L}\\right) \\right] = \\frac{A E_m}{L} (F^2 + E) $$\n该表达式结合了材料刚度贡献（$\\propto F^2$）和几何刚度贡献（$\\propto E$）。用 $u_2$ 表示 $F$ 和 $E$ 并代入：\n$$ K_{\\text{DTL}} = \\frac{A E_m}{L} \\left[ \\left(1+\\frac{u_2}{L}\\right)^2 + \\left(\\frac{u_2}{L} + \\frac{1}{2}\\left(\\frac{u_2}{L}\\right)^2\\right) \\right] $$\n$$ K_{\\text{DTL}} = \\frac{A E_m}{L} \\left[ 1 + 3\\frac{u_2}{L} + \\frac{3}{2}\\left(\\frac{u_2}{L}\\right)^2 \\right] $$\n\n**3. 先线性化后离散 (LTL) 雅可比矩阵及比较**\n\nLTL 方法遵循不同的过程。它在连续体层面进行线性化，但只是部分线性化。它只考虑线性化的材料部分，即 $\\Delta S = C \\Delta E$，其中 $C = dS/dE = E_m$，而忽略了由应变算子本身变分产生的几何部分。切线刚度是通过离散化近似的线性化虚功来形成的：\n$$ \\delta(\\text{IVW})_{\\text{LTL}} = \\int_0^L A (C \\Delta E) \\delta E \\, dX $$\n我们现在代入 $\\Delta E$ 和 $\\delta E$ 的离散形式：\n$$ \\Delta E = \\frac{dE}{du_2} \\Delta u_2 = \\frac{F}{L} \\Delta u_2 $$\n$$ \\delta E = \\frac{dE}{du_2} \\delta u_2 = \\frac{F}{L} \\delta u_2 $$\n代入 LTL 积分中：\n$$ \\delta(\\text{IVW})_{\\text{LTL}} = \\int_0^L A E_m \\left(\\frac{F}{L} \\Delta u_2\\right) \\left(\\frac{F}{L} \\delta u_2\\right) \\, dX $$\n由于所有项在单元上都是常数，计算结果为：\n$$ \\delta(\\text{IVW})_{\\text{LTL}} = A E_m \\frac{F^2}{L^2} L \\, \\Delta u_2 \\, \\delta u_2 = \\left( \\frac{A E_m F^2}{L} \\right) \\Delta u_2 \\, \\delta u_2 $$\nLTL 雅可比矩阵是位移增量的乘数项：\n$$ K_{\\text{LTL}} = \\frac{A E_m F^2}{L} = \\frac{A E_m}{L} \\left(1 + \\frac{u_2}{L}\\right)^2 = \\frac{A E_m}{L} \\left[ 1 + 2\\frac{u_2}{L} + \\left(\\frac{u_2}{L}\\right)^2 \\right] $$\n比较这两个雅可比矩阵，我们发现它们不相同：\n$$ K_{\\text{DTL}} = K_{\\text{LTL}} + \\frac{A E_m}{L} E $$\nLTL 雅可比矩阵缺少几何刚度项 $\\frac{A E_m}{L} E = \\frac{A S}{L}$。该项解释了现有应力对刚度的影响。省略该项意味着 $K_{\\text{LTL}}$ 不是残差 $R(u_2)$ 的一致切线刚度，使用它的 Newton-Raphson 方法将不会表现出二次收敛性。收敛速度预计会降至线性，甚至完全不收敛，尤其是在 $E$ 显著的大应变情况下。\n\n**4. Newton-Raphson 实现**\n\n对于标量未知数 $u_2$，在第 $k$ 次迭代时的 Newton-Raphson 更新为：\n$$ u_2^{(k+1)} = u_2^{(k)} - \\frac{R(u_2^{(k)})}{K(u_2^{(k)})} $$\n我们对雅可比矩阵 $K$ 的 DTL 和 LTL 两种选择都实现了这个迭代方案。初始猜测取自线性弹性理论，$u_2^{(0)} = PL/(AE_m)$。迭代过程持续进行，直到残差的绝对值小于 $\\varepsilon_R = 10^{-10}\\,\\mathrm{N}$，或者位移更新的绝对值小于 $\\varepsilon_U = 10^{-12}\\,\\mathrm{m}$。允许的最大迭代次数为 $N_{\\max} = 50$。如果未达到收敛，则宣布该方法不收敛。实现中包含了对雅可比矩阵是否接近于零的检查，以防止除零错误，这种情况表示刚度丧失。以下 Python 代码实现了这一逻辑，并评估了两种方案在指定测试用例上的性能。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the nonlinear axial deformation of a hyperelastic bar using\n    two different Newton-Raphson schemes (DTL and LTL) and reports\n    the convergence behavior for a suite of test cases.\n    \"\"\"\n    \n    # Fixed parameters\n    L = 1.0  # m\n    A = 0.01  # m^2\n    E_m = 2.10e11  # Pa\n    \n    # Numerical parameters for the solver\n    TOL_R = 1e-10  # N, absolute residual tolerance\n    TOL_U = 1e-12  # m, absolute update tolerance\n    MAX_ITER = 50  # Maximum number of iterations\n    \n    # Reference force for defining loads\n    A_Em = A * E_m\n    \n    # Test cases: loads P\n    test_cases = [\n        0.0,\n        0.02 * A_Em,\n        0.50 * A_Em,\n        0.90 * A_Em,\n    ]\n\n    def run_newton_solver(P, jacobian_type):\n        \"\"\"\n        Performs the Newton-Raphson iteration for a given load and Jacobian type.\n        \n        Args:\n            P (float): External load in N.\n            jacobian_type (str): 'DTL' or 'LTL'.\n            \n        Returns:\n            tuple: (final_displacement, num_iterations, converged_status)\n        \"\"\"\n        # Initial guess from linear elasticity\n        u = (P * L) / A_Em\n        \n        # Calculate initial residual\n        u_L_ratio = u / L\n        F = 1.0 + u_L_ratio\n        E = u_L_ratio + 0.5 * u_L_ratio**2\n        S = E_m * E\n        R = A * S * F - P\n        \n        if abs(R)  TOL_R:\n            return u, 0, True\n\n        for n_iter in range(1, MAX_ITER + 1):\n            # Calculate Jacobian K\n            u_L_ratio = u / L\n            F = 1.0 + u_L_ratio\n            \n            if jacobian_type == 'DTL':\n                # Consistent tangent K_DTL = A*Em/L * (1 + 3*(u/L) + 1.5*(u/L)^2)\n                K = (A * E_m / L) * (1.0 + 3.0 * u_L_ratio + 1.5 * u_L_ratio**2)\n            elif jacobian_type == 'LTL':\n                # Inconsistent tangent K_LTL = A*Em/L * F^2\n                K = (A * E_m / L) * F**2\n            else:\n                raise ValueError(\"Unknown Jacobian type\")\n            \n            # Check for near-zero stiffness (singularity)\n            if abs(K)  1e-20:\n                u_final = float('nan') if jacobian_type == 'LTL' else u\n                return u_final, n_iter - 1, False\n\n            # Calculate update and apply it\n            du = -R / K\n            u += du\n            \n            # Check update convergence\n            if abs(du)  TOL_U:\n                return u, n_iter, True\n            \n            # Recalculate residual for next iteration's residual check\n            u_L_ratio = u / L\n            F = 1.0 + u_L_ratio\n            E = u_L_ratio + 0.5 * u_L_ratio**2\n            S = E_m * E\n            R = A * S * F - P\n            \n            # Check residual convergence\n            if abs(R)  TOL_R:\n                return u, n_iter, True\n\n        # If loop completes, max iterations were reached without convergence\n        u_final = float('nan') if jacobian_type == 'LTL' else u\n        return u_final, MAX_ITER, False\n\n    results = []\n    for P in test_cases:\n        u_dtl, n_dtl, conv_dtl = run_newton_solver(P, 'DTL')\n        u_ltl, n_ltl, conv_ltl = run_newton_solver(P, 'LTL')\n        \n        # For LTL non-convergence, the displacement is NaN as per problem spec\n        if not conv_ltl:\n            u_ltl = float('nan')\n\n        results.append([u_dtl, n_dtl, conv_dtl, u_ltl, n_ltl, conv_ltl])\n\n    # Final print statement must produce a single valid Python list literal.\n    # The default print() for a list of lists matches the required format.\n    print(results)\n\nsolve()\n```", "id": "2664942"}]}