{"hands_on_practices": [{"introduction": "等几何分析的核心优势在于其使用了在计算机辅助设计（CAD）中占主导地位的 B 样条和 NURBS 基函数。然而，为了高效地执行有限元分析，将这些全局定义的样条函数分解为一系列定义在各个单元上的局部“类有限元”基函数至关重要。贝塞尔提取（Bézier extraction）正是实现这一目标的关键算法，它将 B 样条基函数表示为每个单元上伯恩斯坦多项式（Bernstein polynomials）的线性组合。这项实践将指导你从第一性原理出发，为一个具体的二次 B 样条基推导其贝塞尔提取矩阵，从而深入理解样条基函数的内在结构及其在等几何分析中的应用方式 ([@problem_id:2651347])。", "problem": "考虑在参数域 $[0,1]$ 上定义的一维、开、非均匀二次B样条基，其次数为 $p=2$，节点向量为 $\\boldsymbol{\\Xi}=[0,0,0,0.5,1,1,1]$。基函数的数量为 $n+1=4$。唯一的节点区间定义了两个单元：单元 $e=1$ 覆盖 $[0,0.5]$，单元 $e=2$ 覆盖 $[0.5,1]$。对每个单元，通过参数坐标 $\\xi$ 的仿射映射定义局部坐标 $s\\in[0,1]$，即 $s=(\\xi-\\xi_{e}^{\\text{min}})/(\\xi_{e}^{\\text{max}}-\\xi_{e}^{\\text{min}})$，并令2次局部Bernstein多项式为 $\\boldsymbol{B}(s)=[B_0(s),B_1(s),B_2(s)]^{\\mathsf{T}}$，其中 $B_0(s)=(1-s)^2$，$B_1(s)=2s(1-s)$，$B_2(s)=s^2$。使用B样条的基本原理（Cox–de Boor递推公式）和这些定义，完成以下任务：\n\n1) 推导四个二次B样条基函数 $\\{N_0(\\xi),N_1(\\xi),N_2(\\xi),N_3(\\xi)\\}$ 在每个单元上的显式多项式表达式（以 $\\xi$ 表示）。\n\n2) 根据这些表达式和到 $s$ 的仿射映射，确定大小均为 $3\\times 3$ 的Bézier提取矩阵 $\\boldsymbol{C}_1$ 和 $\\boldsymbol{C}_2$，使得\n- 在单元 $e=1$ 上, $\\begin{bmatrix}N_0 \\\\ N_1 \\\\ N_2\\end{bmatrix}=\\boldsymbol{C}_1\\,\\boldsymbol{B}$,\n- 在单元 $e=2$ 上, $\\begin{bmatrix}N_1 \\\\ N_2 \\\\ N_3\\end{bmatrix}=\\boldsymbol{C}_2\\,\\boldsymbol{B}$,\n其中基函数被隐式地限制在各自的单元域上。\n\n3) 通过代入推导出的多项式并确认关于 $s$ 的恒等式成立，来验证每个单元上的重构 $\\boldsymbol{N}=\\boldsymbol{C}_e\\,\\boldsymbol{B}$。\n\n将最终答案报告为一个单行矩阵，该矩阵由 $\\boldsymbol{C}_1$ 的元素后接 $\\boldsymbol{C}_2$ 的元素连接而成，两者均按行主序排列，并使用精确的有理数（不进行四舍五入）。", "solution": "所述问题是适定的，有科学依据，并包含足够的信息以得到唯一解。我们直接进行推导。\n\n次数为 $p$ 的B样条基函数 $N_{i,p}(\\xi)$ 由Cox-de Boor递推公式定义。对于 $p0$：\n$$N_{i,p}(\\xi) = \\frac{\\xi - \\xi_i}{\\xi_{i+p} - \\xi_i} N_{i,p-1}(\\xi) + \\frac{\\xi_{i+p+1} - \\xi}{\\xi_{i+p+1} - \\xi_{i+1}} N_{i+1,p-1}(\\xi)$$\n当 $p=0$ 时的基例是：\n$$N_{i,0}(\\xi) = \\begin{cases} 1   \\text{if } \\xi_i \\le \\xi  \\xi_{i+1} \\\\ 0  \\text{otherwise} \\end{cases}$$\n当分母为零时，该项取零。给定的节点向量为 $\\boldsymbol{\\Xi} = [\\xi_0, \\xi_1, \\xi_2, \\xi_3, \\xi_4, \\xi_5, \\xi_6] = [0, 0, 0, 0.5, 1, 1, 1]$。次数为 $p=2$。\n\n首先，我们计算 $p=0$ 时的基函数。由于存在重复节点，仅有的非零函数是：\n$N_{2,0}(\\xi) = 1$ 对于 $\\xi \\in [0, 0.5)$\n$N_{3,0}(\\xi) = 1$ 对于 $\\xi \\in [0.5, 1)$\n\n接下来，我们计算 $p=1$ 时的基函数：\n$N_{0,1}(\\xi) = 0$\n$N_{1,1}(\\xi) = \\frac{\\xi_3 - \\xi}{\\xi_3 - \\xi_2} N_{2,0}(\\xi) = \\frac{0.5 - \\xi}{0.5 - 0} N_{2,0}(\\xi) = (1 - 2\\xi)N_{2,0}(\\xi)$.\n$N_{2,1}(\\xi) = \\frac{\\xi - \\xi_2}{\\xi_3 - \\xi_2} N_{2,0}(\\xi) + \\frac{\\xi_4 - \\xi}{\\xi_4 - \\xi_3} N_{3,0}(\\xi) = \\frac{\\xi}{0.5}N_{2,0}(\\xi) + \\frac{1-\\xi}{0.5}N_{3,0}(\\xi) = 2\\xi N_{2,0}(\\xi) + 2(1-\\xi)N_{3,0}(\\xi)$.\n$N_{3,1}(\\xi) = \\frac{\\xi - \\xi_3}{\\xi_4 - \\xi_3} N_{3,0}(\\xi) = \\frac{\\xi - 0.5}{1 - 0.5} N_{3,0}(\\xi) = (2\\xi - 1)N_{3,0}(\\xi)$.\n$N_{4,1}(\\xi) = 0$\n\n最后，我们计算所需的 $p=2$ 时的二次基函数，记为 $N_i(\\xi) \\equiv N_{i,2}(\\xi)$：\n$N_0(\\xi) = \\frac{\\xi_3 - \\xi}{\\xi_3 - \\xi_1} N_{1,1}(\\xi) = \\frac{0.5 - \\xi}{0.5 - 0}N_{1,1}(\\xi) = (1-2\\xi)N_{1,1}(\\xi)$。在 $[0, 0.5]$ 上，此式为 $(1-2\\xi)(1-2\\xi) = (1-2\\xi)^2$。\n$N_1(\\xi) = \\frac{\\xi - \\xi_1}{\\xi_3 - \\xi_1} N_{1,1}(\\xi) + \\frac{\\xi_4 - \\xi}{\\xi_4 - \\xi_2} N_{2,1}(\\xi) = \\frac{\\xi}{0.5}N_{1,1}(\\xi) + \\frac{1-\\xi}{1}N_{2,1}(\\xi) = 2\\xi N_{1,1}(\\xi) + (1-\\xi)N_{2,1}(\\xi)$。\n在单元1上（$\\xi \\in [0, 0.5]$）：$N_1(\\xi) = 2\\xi(1-2\\xi) + (1-\\xi)(2\\xi) = 2\\xi-4\\xi^2 + 2\\xi-2\\xi^2 = 4\\xi - 6\\xi^2$。\n在单元2上（$\\xi \\in [0.5, 1]$）：$N_1(\\xi) = 2\\xi(0) + (1-\\xi)(2(1-\\xi)) = 2(1-\\xi)^2$。\n$N_2(\\xi) = \\frac{\\xi - \\xi_2}{\\xi_4 - \\xi_2} N_{2,1}(\\xi) + \\frac{\\xi_5 - \\xi}{\\xi_5 - \\xi_3} N_{3,1}(\\xi) = \\frac{\\xi}{1}N_{2,1}(\\xi) + \\frac{1-\\xi}{0.5}N_{3,1}(\\xi) = \\xi N_{2,1}(\\xi) + 2(1-\\xi)N_{3,1}(\\xi)$。\n在单元1上（$\\xi \\in [0, 0.5]$）：$N_2(\\xi) = \\xi(2\\xi) + 2(1-\\xi)(0) = 2\\xi^2$。\n在单元2上（$\\xi \\in [0.5, 1]$）：$N_2(\\xi) = \\xi(2(1-\\xi)) + 2(1-\\xi)(2\\xi-1) = 2\\xi-2\\xi^2 + 2(3\\xi-1-2\\xi^2) = -6\\xi^2+8\\xi-2$。\n$N_3(\\xi) = \\frac{\\xi - \\xi_3}{\\xi_5 - \\xi_3} N_{3,1}(\\xi) = \\frac{\\xi-0.5}{0.5}N_{3,1}(\\xi) = (2\\xi-1)N_{3,1}(\\xi)$。在 $[0.5, 1]$ 上，此式为 $(2\\xi-1)(2\\xi-1) = (2\\xi-1)^2$。\n\n每个单元上的基函数总结如下：\n在单元 $e=1$ 上（$\\xi \\in [0, 0.5]$）：\n$N_0(\\xi) = (1-2\\xi)^2$\n$N_1(\\xi) = 4\\xi - 6\\xi^2$\n$N_2(\\xi) = 2\\xi^2$\n在单元 $e=2$ 上（$\\xi \\in [0.5, 1]$）：\n$N_1(\\xi) = 2(1-\\xi)^2$\n$N_2(\\xi) = -6\\xi^2 + 8\\xi - 2$\n$N_3(\\xi) = (2\\xi-1)^2$\n局部Bernstein基为 $\\boldsymbol{B}(s) = [(1-s)^2, 2s(1-s), s^2]^{\\mathsf{T}} = [B_0(s), B_1(s), B_2(s)]^{\\mathsf{T}}$。\n\n为求单元1的Bézier提取矩阵 $\\boldsymbol{C}_1$，我们使用仿射映射 $s = (\\xi-0)/(0.5-0) = 2\\xi$，因此 $\\xi=s/2$。我们将此代入 $N_0, N_1, N_2$ 的表达式中。\n$N_0(s) = (1-2(s/2))^2 = (1-s)^2 = B_0(s)$。\n$N_1(s) = 4(s/2) - 6(s/2)^2 = 2s - \\frac{3}{2}s^2$。我们将其用Bernstein基表示：$2s-\\frac{3}{2}s^2 = 2s(1-s) + 2s^2 - \\frac{3}{2}s^2 = 2s(1-s) + \\frac{1}{2}s^2 = B_1(s) + \\frac{1}{2}B_2(s)$。\n$N_2(s) = 2(s/2)^2 = \\frac{1}{2}s^2 = \\frac{1}{2}B_2(s)$。\n写成矩阵形式：\n$\\begin{bmatrix} N_0 \\\\ N_1 \\\\ N_2 \\end{bmatrix} = \\begin{bmatrix} 1  0  0 \\\\ 0  1  \\frac{1}{2} \\\\ 0  0  \\frac{1}{2} \\end{bmatrix} \\begin{bmatrix} B_0(s) \\\\ B_1(s) \\\\ B_2(s) \\end{bmatrix}$。因此，$\\boldsymbol{C}_1 = \\begin{bmatrix} 1  0  0 \\\\ 0  1  1/2 \\\\ 0  0  1/2 \\end{bmatrix}$。\n\n为求单元2的Bézier提取矩阵 $\\boldsymbol{C}_2$，我们使用映射 $s = (\\xi-0.5)/(1-0.5) = 2\\xi-1$，因此 $\\xi=(s+1)/2$。我们将此代入 $N_1, N_2, N_3$ 的表达式中。\n$N_1(s) = 2(1 - \\frac{s+1}{2})^2 = 2(\\frac{1-s}{2})^2 = \\frac{1}{2}(1-s)^2 = \\frac{1}{2}B_0(s)$。\n$N_2(s) = -6(\\frac{s+1}{2})^2 + 8(\\frac{s+1}{2}) - 2 = -\\frac{3}{2}(s^2+2s+1) + 4(s+1) - 2 = -\\frac{3}{2}s^2 + s + \\frac{1}{2}$。我们将其用Bernstein基表示：$-\\frac{3}{2}s^2+s+\\frac{1}{2} = \\frac{1}{2}(1-2s+s^2) + 2s - 2s^2 = \\frac{1}{2}(1-s)^2 + 2s(1-s) = \\frac{1}{2}B_0(s) + B_1(s)$。\n$N_3(s) = (2(\\frac{s+1}{2})-1)^2 = (s)^2 = B_2(s)$。\n写成矩阵形式：\n$\\begin{bmatrix} N_1 \\\\ N_2 \\\\ N_3 \\end{bmatrix} = \\begin{bmatrix} \\frac{1}{2}  0  0 \\\\ \\frac{1}{2}  1  0 \\\\ 0  0  1 \\end{bmatrix} \\begin{bmatrix} B_0(s) \\\\ B_1(s) \\\\ B_2(s) \\end{bmatrix}$。因此，$\\boldsymbol{C}_2 = \\begin{bmatrix} 1/2  0  0 \\\\ 1/2  1  0 \\\\ 0  0  1 \\end{bmatrix}$。\n\n对这些矩阵的验证（任务3）已内含于构造推导過程中。为求完整，我们进行验证：\n对于 $\\boldsymbol{C}_1$：\n$N_0 = 1 \\cdot B_0 + 0 \\cdot B_1 + 0 \\cdot B_2 = (1-s)^2 = (1-2\\xi)^2$。正确。\n$N_1 = 0 \\cdot B_0 + 1 \\cdot B_1 + \\frac{1}{2} \\cdot B_2 = 2s(1-s)+\\frac{1}{2}s^2 = 2s-\\frac{3}{2}s^2 = 2(2\\xi)-\\frac{3}{2}(2\\xi)^2 = 4\\xi-6\\xi^2$。正确。\n$N_2 = 0 \\cdot B_0 + 0 \\cdot B_1 + \\frac{1}{2} \\cdot B_2 = \\frac{1}{2}s^2 = \\frac{1}{2}(2\\xi)^2 = 2\\xi^2$。正确。\n对于 $\\boldsymbol{C}_2$：\n$N_1 = \\frac{1}{2} \\cdot B_0 + 0 \\cdot B_1 + 0 \\cdot B_2 = \\frac{1}{2}(1-s)^2 = \\frac{1}{2}(1-(2\\xi-1))^2 = \\frac{1}{2}(2-2\\xi)^2 = 2(1-\\xi)^2$。正确。\n$N_2 = \\frac{1}{2} \\cdot B_0 + 1 \\cdot B_1 + 0 \\cdot B_2 = \\frac{1}{2}(1-s)^2+2s(1-s) = \\frac{1}{2}-s+\\frac{s^2}{2}+2s-2s^2 = \\frac{1}{2}+s-\\frac{3}{2}s^2 = \\frac{1}{2}+(2\\xi-1)-\\frac{3}{2}(2\\xi-1)^2 = -\\frac{1}{2}+2\\xi-\\frac{3}{2}(4\\xi^2-4\\xi+1) = -6\\xi^2+8\\xi-2$。正确。\n$N_3 = 0 \\cdot B_0 + 0 \\cdot B_1 + 1 \\cdot B_2 = s^2 = (2\\xi-1)^2$。正确。\n\n推导得到验证。最终答案需要将 $\\boldsymbol{C}_1$ 和 $\\boldsymbol{C}_2$ 的元素按行主序连接起来。\n$\\boldsymbol{C}_1$ 的元素：$1, 0, 0, 0, 1, 1/2, 0, 0, 1/2$。\n$\\boldsymbol{C}_2$ 的元素：$1/2, 0, 0, 1/2, 1, 0, 0, 0, 1$。\n连接后的结果构成了最终答案。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} 1  0  0  0  1  \\frac{1}{2}  0  0  \\frac{1}{2}  \\frac{1}{2}  0  0  \\frac{1}{2}  1  0  0  0  1 \\end{pmatrix}\n}\n$$", "id": "2651347"}, {"introduction": "在掌握了基函数的局部表示之后，下一步是理解如何利用这些函数来精确构建几何模型。非均匀有理 B 样条（NURBS）是工业产品设计的黄金标准，能够精确表示从简单平面到复杂自由曲面的各种形状。这个练习将带你亲手构建一个 NURBS 曲面，你需要综合运用控制点、权重和节点矢量来计算曲面上特定点的精确坐标。此外，你还将计算该点的切向量和法向量，这些量是定义曲面微分几何性质的基础，对于后续的应力分析和壳单元建模等高级应用至关重要 ([@problem_id:2651405])。", "problem": "考虑构建一个非均匀有理B样条（NURBS）曲面，其中NURBS代表非均匀有理B样条。在右手笛卡尔坐标系中进行计算。设双次数为 $p=q=1$，开放节点向量为 $U=[0,0,1,1]$ 和 $V=[0,0,1,1]$。$2 \\times 2$ 的控制网格由控制点 $P_{00}=(0,0,0)$ m, $P_{10}=(2,0,1)$ m, $P_{01}=(0,3,1)$ m, 和 $P_{11}=(2,3,2)$ m 给出，对应的NURBS权重为 $w_{00}=1$, $w_{10}=2$, $w_{01}=1$, 和 $w_{11}=\\tfrac{3}{2}$。使用标准的张量积NURBS构造方法，在 $[0,1]\\times[0,1]$ 上定义曲面 $S(u,v)$，其中标量权重函数 $W(u,v)$ 和有理基函数 $R_{ij}(u,v)$ 由每个方向上的1次B样条基函数构成。\n\n从第一性原理出发，使用开放节点向量上的1次B样条基函数的定义和有理曲面构造方法，在参数对 $(u_{0},v_{0})=\\left(\\tfrac{1}{3},\\tfrac{1}{2}\\right)$ 处执行以下操作：\n1. 构建NURBS曲面点 $S(u_{0},v_{0})$。\n2. 通过对有理曲面分别关于 $u$ 和 $v$ 求导，计算切向量 $S_{u}(u_{0},v_{0})$ 和 $S_{v}(u_{0},v_{0})$。\n3. 计算曲面法向量 $n(u_{0},v_{0})=S_{u}(u_{0},v_{0})\\times S_{v}(u_{0},v_{0})$ 和相关的单位法向量 $\\hat{n}(u_{0},v_{0})=n/\\|n\\|$。\n\n答案要求：仅报告模长 $\\|n(u_{0},v_{0})\\|$，单位为平方米。将您的答案四舍五入到四位有效数字。最终的模长以 $\\mathrm{m}^{2}$ 表示（在最终答案的方框中不要包含单位）。", "solution": "首先将对问题陈述进行严格的验证。\n\n步骤1：提取已知条件\n已知条件逐字从问题陈述中提取：\n- 双次数：$p=1, q=1$。\n- 开放节点向量：$U=[0,0,1,1]$, $V=[0,0,1,1]$。\n- 控制网格 ($2 \\times 2$): $P_{00}=(0,0,0)$ m, $P_{10}=(2,0,1)$ m, $P_{01}=(0,3,1)$ m, $P_{11}=(2,3,2)$ m。\n- NURBS权重：$w_{00}=1$, $w_{10}=2$, $w_{01}=1$, $w_{11}=\\tfrac{3}{2}$。\n- 曲面定义：通过标准的张量积NURBS构造在 $[0,1]\\times[0,1]$ 上定义 $S(u,v)$。\n- 计算点：$(u_{0},v_{0})=\\left(\\tfrac{1}{3},\\tfrac{1}{2}\\right)$。\n- 任务：计算 $S(u_0,v_0)$、$S_{u}(u_0,v_0)$、$S_{v}(u_0,v_0)$、$n(u_0,v_0)=S_{u}\\times S_{v}$，最后计算 $\\|n(u_0,v_0)\\|$。\n- 最终答案要求：报告 $\\|n(u_0,v_0)\\|$ 并四舍五入到四位有效数字。\n\n步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题是计算机辅助几何设计（CAGD）中的一个标准练习，并且是等几何分析的基础。NURBS曲面的构建基于成熟的数学原理。该问题在科学上是合理的。\n- **适定性**：该问题是完全指定的。控制点的数量（$2 \\times 2$）与次数（$p=1, q=1$）和开放节点向量的长度（对于1次和2个控制点，有4个节点）是一致的。计算点在参数域内。存在唯一、稳定的解。\n- **客观性**：该问题使用精确、无歧义的数学语言陈述，不包含任何主观或基于意见的主张。\n\n所有其他有效性标准也均得到满足。没有矛盾、缺失数据或不切实际的条件。\n\n步骤3：结论与行动\n问题有效。下面是一个完整的、有理有据的解答。\n\nNURBS曲面 $S(u,v)$ 由以下有理公式定义：\n$$ S(u,v) = \\frac{\\sum_{i=0}^{1} \\sum_{j=0}^{1} N_{i,p}(u) N_{j,q}(v) w_{ij} P_{ij}}{\\sum_{i=0}^{1} \\sum_{j=0}^{1} N_{i,p}(u) N_{j,q}(v) w_{ij}} = \\frac{A(u,v)}{W(u,v)} $$\n其中 $p=1$ 且 $q=1$。对于开放节点向量 $U=[0,0,1,1]$，在定义域 $u \\in [0,1]$ 上的1次B样条基函数是线性Bernstein多项式：\n$$ N_{0,1}(u) = 1-u $$\n$$ N_{1,1}(u) = u $$\n类似地，对于节点向量 $V=[0,0,1,1]$，1次基函数为：\n$$ N_{0,1}(v) = 1-v $$\n$$ N_{1,1}(v) = v $$\n\n首先，我们在指定的参数点 $(u_0, v_0) = (\\frac{1}{3}, \\frac{1}{2})$ 处计算标量权重函数 $W(u,v)$ 和向量值函数 $A(u,v)$。\n基函数的计算结果为：\n$N_{0,1}(u_0) = 1 - \\frac{1}{3} = \\frac{2}{3}$， $N_{1,1}(u_0) = \\frac{1}{3}$。\n$N_{0,1}(v_0) = 1 - \\frac{1}{2} = \\frac{1}{2}$， $N_{1,1}(v_0) = \\frac{1}{2}$。\n\n权重函数 $W(u,v)$ 是：\n$$ W(u,v) = (1-u)(1-v)w_{00} + u(1-v)w_{10} + (1-u)v w_{01} + uv w_{11} $$\n在 $(u_0, v_0)$ 处：\n$$ W(\\tfrac{1}{3},\\tfrac{1}{2}) = (\\tfrac{2}{3})(\\tfrac{1}{2})(1) + (\\tfrac{1}{3})(\\tfrac{1}{2})(2) + (\\tfrac{2}{3})(\\tfrac{1}{2})(1) + (\\tfrac{1}{3})(\\tfrac{1}{2})(\\tfrac{3}{2}) = \\tfrac{1}{3} + \\tfrac{1}{3} + \\tfrac{1}{3} + \\tfrac{1}{4} = 1 + \\tfrac{1}{4} = \\tfrac{5}{4} $$\n向量值函数 $A(u,v)$ 是：\n$$ A(u,v) = (1-u)(1-v)w_{00}P_{00} + u(1-v)w_{10}P_{10} + (1-u)v w_{01}P_{01} + uv w_{11}P_{11} $$\n在 $(u_0, v_0)$ 处：\n$$ A(\\tfrac{1}{3},\\tfrac{1}{2}) = (\\tfrac{2}{3})(\\tfrac{1}{2})(1)P_{00} + (\\tfrac{1}{3})(\\tfrac{1}{2})(2)P_{10} + (\\tfrac{2}{3})(\\tfrac{1}{2})(1)P_{01} + (\\tfrac{1}{3})(\\tfrac{1}{2})(\\tfrac{3}{2})P_{11} $$\n$$ A(\\tfrac{1}{3},\\tfrac{1}{2}) = \\tfrac{1}{3}P_{00} + \\tfrac{1}{3}P_{10} + \\tfrac{1}{3}P_{01} + \\tfrac{1}{4}P_{11} $$\n代入控制点 $P_{ij}$：\n$$ A(\\tfrac{1}{3},\\tfrac{1}{2}) = \\tfrac{1}{3}(0,0,0) + \\tfrac{1}{3}(2,0,1) + \\tfrac{1}{3}(0,3,1) + \\tfrac{1}{4}(2,3,2) $$\n$$ A(\\tfrac{1}{3},\\tfrac{1}{2}) = (0,0,0) + (\\tfrac{2}{3},0,\\tfrac{1}{3}) + (0,1,\\tfrac{1}{3}) + (\\tfrac{1}{2},\\tfrac{3}{4},\\tfrac{1}{2}) = (\\tfrac{2}{3}+\\tfrac{1}{2}, 1+\\tfrac{3}{4}, \\tfrac{2}{3}+\\tfrac{1}{2}) = (\\tfrac{7}{6}, \\tfrac{7}{4}, \\tfrac{7}{6}) $$\n曲面点为 $S(u_0, v_0) = \\frac{A(u_0, v_0)}{W(u_0, v_0)} = \\frac{(\\tfrac{7}{6}, \\tfrac{7}{4}, \\tfrac{7}{6})}{\\tfrac{5}{4}} = \\tfrac{4}{5}(\\tfrac{7}{6}, \\tfrac{7}{4}, \\tfrac{7}{6}) = (\\tfrac{14}{15}, \\tfrac{7}{5}, \\tfrac{14}{15})$。\n\n接下来，我们计算切向量。有理曲面的导数使用商法则求得：\n$$ S_{u} = \\frac{A_u W - A W_u}{W^2} \\quad \\text{和} \\quad S_{v} = \\frac{A_v W - A W_v}{W^2} $$\n我们需要 $A(u,v)$ 和 $W(u,v)$ 的偏导数。\n基函数的导数为 $\\frac{d}{du}N_{0,1}(u) = -1$, $\\frac{d}{du}N_{1,1}(u) = 1$，对 $v$ 也类似。\n$$ W_u = \\frac{\\partial W}{\\partial u} = (1-v)(w_{10}-w_{00}) + v(w_{11}-w_{01}) $$\n$$ W_v = \\frac{\\partial W}{\\partial v} = (1-u)(w_{01}-w_{00}) + u(w_{11}-w_{10}) $$\n$$ A_u = \\frac{\\partial A}{\\partial u} = (1-v)(w_{10}P_{10}-w_{00}P_{00}) + v(w_{11}P_{11}-w_{01}P_{01}) $$\n$$ A_v = \\frac{\\partial A}{\\partial v} = (1-u)(w_{01}P_{01}-w_{00}P_{00}) + u(w_{11}P_{11}-w_{10}P_{10}) $$\n在 $(u_0, v_0) = (\\frac{1}{3}, \\frac{1}{2})$ 处计算这些值：\n$$ W_u = \\tfrac{1}{2}(2-1) + \\tfrac{1}{2}(\\tfrac{3}{2}-1) = \\tfrac{1}{2} + \\tfrac{1}{4} = \\tfrac{3}{4} $$\n$$ W_v = \\tfrac{2}{3}(1-1) + \\tfrac{1}{3}(\\tfrac{3}{2}-2) = 0 + \\tfrac{1}{3}(-\\tfrac{1}{2}) = -\\tfrac{1}{6} $$\n$$ A_u = \\tfrac{1}{2}(2P_{10}-1P_{00}) + \\tfrac{1}{2}(\\tfrac{3}{2}P_{11}-1P_{01}) = \\tfrac{1}{2}(2(2,0,1)) + \\tfrac{1}{2}((\\tfrac{3}{2}(2,3,2))-(0,3,1)) = (2,0,1) + \\tfrac{1}{2}((3,\\tfrac{9}{2},3)-(0,3,1)) = (2,0,1) + \\tfrac{1}{2}(3,\\tfrac{3}{2},2) = (2+\\tfrac{3}{2}, \\tfrac{3}{4}, 1+1) = (\\tfrac{7}{2}, \\tfrac{3}{4}, 2) $$\n$$ A_v = \\tfrac{2}{3}(1P_{01}-1P_{00}) + \\tfrac{1}{3}(\\tfrac{3}{2}P_{11}-2P_{10}) = \\tfrac{2}{3}(0,3,1) + \\tfrac{1}{3}((\\tfrac{3}{2}(2,3,2))-(2(2,0,1))) = (0,2,\\tfrac{2}{3}) + \\tfrac{1}{3}((3,\\tfrac{9}{2},3)-(4,0,2)) = (0,2,\\tfrac{2}{3}) + \\tfrac{1}{3}(-1,\\tfrac{9}{2},1) = (-\\tfrac{1}{3}, 2+\\tfrac{3}{2}, \\tfrac{2}{3}+\\tfrac{1}{3}) = (-\\tfrac{1}{3}, \\tfrac{7}{2}, 1) $$\n现在，组合切向量。我们有 $W=\\tfrac{5}{4}$，所以 $W^2=\\tfrac{25}{16}$。\n对于 $S_u$：\n$$ A_u W - A W_u = (\\tfrac{7}{2}, \\tfrac{3}{4}, 2)(\\tfrac{5}{4}) - (\\tfrac{7}{6}, \\tfrac{7}{4}, \\tfrac{7}{6})(\\tfrac{3}{4}) = (\\tfrac{35}{8}, \\tfrac{15}{16}, \\tfrac{5}{2}) - (\\tfrac{7}{8}, \\tfrac{21}{16}, \\tfrac{7}{8}) = (\\tfrac{28}{8}, -\\tfrac{6}{16}, \\tfrac{13}{8}) = (\\tfrac{7}{2}, -\\tfrac{3}{8}, \\tfrac{13}{8}) $$\n$$ S_u(\\tfrac{1}{3},\\tfrac{1}{2}) = \\frac{(\\tfrac{7}{2}, -\\tfrac{3}{8}, \\tfrac{13}{8})}{\\tfrac{25}{16}} = \\tfrac{16}{25}(\\tfrac{7}{2}, -\\tfrac{3}{8}, \\tfrac{13}{8}) = (\\tfrac{56}{25}, -\\tfrac{6}{25}, \\tfrac{26}{25}) $$\n对于 $S_v$：\n$$ A_v W - A W_v = (-\\tfrac{1}{3}, \\tfrac{7}{2}, 1)(\\tfrac{5}{4}) - (\\tfrac{7}{6}, \\tfrac{7}{4}, \\tfrac{7}{6})(-\\tfrac{1}{6}) = (-\\tfrac{5}{12}, \\tfrac{35}{8}, \\tfrac{5}{4}) - (-\\tfrac{7}{36}, -\\tfrac{7}{24}, -\\tfrac{7}{36}) = (-\\tfrac{8}{36}, \\tfrac{112}{24}, \\tfrac{52}{36}) = (-\\tfrac{2}{9}, \\tfrac{14}{3}, \\tfrac{13}{9}) $$\n$$ S_v(\\tfrac{1}{3},\\tfrac{1}{2}) = \\frac{(-\\tfrac{2}{9}, \\tfrac{14}{3}, \\tfrac{13}{9})}{\\tfrac{25}{16}} = \\tfrac{16}{25}(-\\tfrac{2}{9}, \\tfrac{14}{3}, \\tfrac{13}{9}) = (-\\tfrac{32}{225}, \\tfrac{224}{75}, \\tfrac{208}{225}) $$\n计算法向量 $n = S_u \\times S_v$：\n$$ n = (\\tfrac{56}{25}, -\\tfrac{6}{25}, \\tfrac{26}{25}) \\times (-\\tfrac{32}{225}, \\tfrac{224}{75}, \\tfrac{208}{225}) $$\n$$ n = \\frac{1}{25 \\cdot 225} (56, -6, 26) \\times (-32, 672, 208) $$\n叉积为：\n$$ \\begin{vmatrix} \\mathbf{i}  \\mathbf{j}  \\mathbf{k} \\\\ 56  -6  26 \\\\ -32  672  208 \\end{vmatrix} = ((-6)(208) - (26)(672))\\mathbf{i} - ((56)(208) - (26)(-32))\\mathbf{j} + ((56)(672) - (-6)(-32))\\mathbf{k} $$\n$$ = (-1248 - 17472)\\mathbf{i} - (11648 + 832)\\mathbf{j} + (37632 - 192)\\mathbf{k} = -18720\\mathbf{i} - 12480\\mathbf{j} + 37440\\mathbf{k} $$\n因此 $n = \\frac{1}{5625}(-18720, -12480, 37440)$。\n我们从向量分量中简化公因子 $6240$：$6240(-3, -2, 6)$。\n$$ n = \\frac{6240}{5625}(-3, -2, 6) = \\frac{416}{375}(-3, -2, 6) $$\n法向量的模长为：\n$$ \\|n\\| = |\\tfrac{416}{375}| \\cdot \\|(-3, -2, 6)\\| = \\tfrac{416}{375} \\sqrt{(-3)^2 + (-2)^2 + 6^2} = \\tfrac{416}{375} \\sqrt{9+4+36} = \\tfrac{416}{375} \\sqrt{49} $$\n$$ \\|n(\\tfrac{1}{3},\\tfrac{1}{2})\\| = \\tfrac{416 \\times 7}{375} = \\tfrac{2912}{375} $$\n作为小数，这等于 $\\tfrac{2912}{375} \\approx 7.765333...$\n四舍五入到四位有效数字得到 $7.765$。\n控制点的单位是米（m），因此切向量的单位是 m，法向量的模长单位是 $\\mathrm{m}^2$。", "answer": "$$\n\\boxed{7.765}\n$$", "id": "2651405"}, {"introduction": "等几何分析的最终目标是对所构建的几何模型进行物理分析，这通常需要通过数值积分来计算刚度矩阵等关键量。由于等几何分析中的物理域是通过从一个简单的参数域（例如单位正方形）映射而来的，因此积分过程必须考虑这种几何映射引入的变形。本练习旨在连接几何与分析，要求你为一个二维 NURBS 补片计算其在高斯积分点处的积分权重。你需要处理从父单元到参数空间，再到物理空间的一系列坐标变换，并计算相应的雅可比行列式，从而精确地构建出在物理域上进行数值积分所需的“面积元素” ([@problem_id:2651381])。", "problem": "考虑一个双参数非均匀有理B样条 (NURBS) 曲面，它在二维固体力学中用于等几何分析，将参数域映射到平面实体域。该曲面的双次数为 $(p,q)=(1,1)$，每个参数方向上的开放节点向量由下式给出\n$$\\Xi = [\\,0,\\,0,\\,0.5,\\,1,\\,1\\,], \\qquad \\mathcal{H} = [\\,0,\\,0,\\,0.3,\\,1,\\,1\\,].$$\n在 $\\xi$ 方向上有 $n_{\\xi}=3$ 个基函数，在 $\\eta$ 方向上有 $n_{\\eta}=3$ 个基函数。$3\\times 3$ 的控制网格 $\\{\\mathbf{P}_{ij}\\}_{i=1..3,\\,j=1..3}$（坐标单位为米）和相应的NURBS权重 $\\{w_{ij}\\}$ 如下\n$$\\mathbf{P}_{11}=(0,0),\\;\\mathbf{P}_{21}=(2,0.2),\\;\\mathbf{P}_{31}=(4,0),$$\n$$\\mathbf{P}_{12}=(0.1,1),\\;\\mathbf{P}_{22}=(2.1,1.1),\\;\\mathbf{P}_{32}=(4.1,1),$$\n$$\\mathbf{P}_{13}=(0,2),\\;\\mathbf{P}_{23}=(2,2.1),\\;\\mathbf{P}_{33}=(4,2),$$\n且\n$$w_{ij}=1 \\quad \\text{对所有 } i,j.$$\n\n关注由 $[\\xi_{2},\\xi_{3}]\\times[\\eta_{2},\\eta_{3}] = [0.5,\\,1]\\times[0.3,\\,1]$ 给出的张量积节点区间（单元）。考虑在父方形 $[-1,1]\\times[-1,1]$ 上的标准两点 Gauss–Legendre 求积，其点和权重为\n$$r,s \\in \\left\\{-\\frac{1}{\\sqrt{3}},\\,+\\frac{1}{\\sqrt{3}}\\right\\}, \\qquad w_{r}=1,\\; w_{s}=1.$$\n在特定的父空间高斯点 $(r,s)=\\left(\\frac{1}{\\sqrt{3}},\\,-\\frac{1}{\\sqrt{3}}\\right)$ 处：\n\n- 通过从 $[-1,1]$ 到每个节点子区间的标准仿射映射，将 $(r,s)$ 映射到所选单元的参数坐标 $(\\xi,\\eta)$。\n- 在单个节点区间上，使用1次B样条基函数的基本定义，构造在 $(\\xi,\\eta)$ 处的非零张量积基函数及其关于 $\\xi$ 和 $\\eta$ 的一阶导数。然后，使用NURBS基函数的定义，获得几何映射所需的相应有理基函数及其导数。\n- 使用几何映射 $\\mathbf{x}(\\xi,\\eta)=\\sum_{i=1}^{3}\\sum_{j=1}^{3} R_{ij}(\\xi,\\eta)\\,\\mathbf{P}_{ij}$，计算所选积分点的映射物理坐标以及在该点的雅可比矩阵 $\\mathbf{J}=\\partial\\mathbf{x}/\\partial(\\xi,\\eta)$。计算 $\\det\\mathbf{J}$。\n- 使用从父空间到物理空间的积分变量替换（面积元的推前），组合该高斯点处的求积权重 $W$，该权重必须包括从父空间到参数空间的缩放和 $\\det\\mathbf{J}$。\n\n仅报告此高斯点的最终求积权重 $W$。以平方米为单位表示您的答案。不要四舍五入；提供精确值。", "solution": "在继续之前，对所述问题进行验证。\n\n**步骤 1：提取已知条件**\n- **几何类型**：双参数非均匀有理B样条 (NURBS) 曲面。\n- **双次数**：$(p,q)=(1,1)$。\n- **节点向量**：$\\xi$ 方向为 $\\Xi = [\\,0,\\,0,\\,0.5,\\,1,\\,1\\,]$，$\\eta$ 方向为 $\\mathcal{H} = [\\,0,\\,0,\\,0.3,\\,1,\\,1\\,]$。\n- **基函数**：$\\xi$ 方向有 $n_{\\xi}=3$ 个函数，$\\eta$ 方向有 $n_{\\eta}=3$ 个函数。\n- **控制网格**：一个 $3\\times 3$ 的点阵 $\\{\\mathbf{P}_{ij}\\}$，坐标单位为米：\n  $\\mathbf{P}_{11}=(0,0)$, $\\mathbf{P}_{21}=(2,0.2)$, $\\mathbf{P}_{31}=(4,0)$,\n  $\\mathbf{P}_{12}=(0.1,1)$, $\\mathbf{P}_{22}=(2.1,1.1)$, $\\mathbf{P}_{32}=(4.1,1)$,\n  $\\mathbf{P}_{13}=(0,2)$, $\\mathbf{P}_{23}=(2,2.1)$, $\\mathbf{P}_{33}=(4,2)$。\n- **权重**：对所有 $i,j$，$w_{ij}=1$。\n- **目标单元**：张量积节点区间 $[\\xi_{i},\\xi_{i+1}]\\times[\\eta_{j},\\eta_{j+1}] = [0.5,\\,1]\\times[0.3,\\,1]$。使用标准的基于0的节点索引（$m+1=n+p+1=5$ 个节点，索引从0到4），这对应于单元 $[\\xi_2, \\xi_3] \\times [\\eta_2, \\eta_3]$。\n- **求积法则**：父方形 $[-1,1]\\times[-1,1]$ 上的两点 Gauss–Legendre 求积。\n- **求积点/权重**：$r,s \\in \\{-\\frac{1}{\\sqrt{3}},\\,+\\frac{1}{\\sqrt{3}}\\}$，权重为 $w_{r}=1, w_{s}=1$。\n- **特定积分点**：父域中的 $(r,s)=\\left(\\frac{1}{\\sqrt{3}},\\,-\\frac{1}{\\sqrt{3}}\\right)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，是适定的、客观的。这是等几何分析中的一个标准练习，等几何分析是计算固体力学中一个成熟的学科。所有数据都已提供，是自洽的，并且足以计算出唯一解。语言精确，设置中没有逻辑矛盾或物理上不合理的情况。因此，该问题被认为是 **有效的**。\n\n**步骤 3：求解**\n我们继续进行计算。\n\n**1. 从父域到参数域的映射**\n从父坐标 $\\hat{\\zeta} \\in [-1,1]$ 到参数坐标 $\\zeta \\in [\\zeta_a, \\zeta_b]$ 的仿射映射由下式给出\n$$ \\zeta(\\hat{\\zeta}) = \\frac{\\zeta_b - \\zeta_a}{2} \\hat{\\zeta} + \\frac{\\zeta_a + \\zeta_b}{2} $$\n对于 $\\xi$ 方向，单元是 $[0.5, 1]$。映射为：\n$$ \\xi(r) = \\frac{1 - 0.5}{2} r + \\frac{0.5 + 1}{2} = 0.25 r + 0.75 = \\frac{1}{4} r + \\frac{3}{4} $$\n对于 $\\eta$ 方向，单元是 $[0.3, 1]$。映射为：\n$$ \\eta(s) = \\frac{1 - 0.3}{2} s + \\frac{0.3 + 1}{2} = 0.35 s + 0.65 = \\frac{7}{20} s + \\frac{13}{20} $$\n在指定的高斯点 $(r,s)=\\left(\\frac{1}{\\sqrt{3}},\\,-\\frac{1}{\\sqrt{3}}\\right)$，参数坐标为：\n$$ \\xi = \\frac{1}{4}\\left(\\frac{1}{\\sqrt{3}}\\right) + \\frac{3}{4} = \\frac{1+3\\sqrt{3}}{4\\sqrt{3}} $$\n$$ \\eta = \\frac{7}{20}\\left(-\\frac{1}{\\sqrt{3}}\\right) + \\frac{13}{20} = \\frac{13\\sqrt{3}-7}{20\\sqrt{3}} $$\n\n**2. B样条基函数及其导数**\n对于节点区间 $[\\xi_i, \\xi_{i+1}]$ 上的 $p=1$ 次B样条，两个非零基函数是线性的：\n$$ N_{i-1,1}(\\xi) = \\frac{\\xi_{i+1}-\\xi}{\\xi_{i+1}-\\xi_i}, \\qquad N_{i,1}(\\xi) = \\frac{\\xi-\\xi_i}{\\xi_{i+1}-\\xi_i} $$\n目标单元是 $[\\xi_2, \\xi_3] \\times [\\eta_2, \\eta_3] = [0.5, 1] \\times [0.3, 1]$。根据问题中基于1的基函数索引，该单元上的非零函数是 $N_{2,1}(\\xi), N_{3,1}(\\xi)$ 和 $N_{2,1}(\\eta), N_{3,1}(\\eta)$。\n\n在 $\\xi$ 方向，于区间 $[\\xi_2, \\xi_3] = [0.5, 1]$ 上：\n$$ N_{2,1}(\\xi) = \\frac{1-\\xi}{1-0.5} = 2(1-\\xi) \\implies \\frac{dN_{2,1}}{d\\xi} = -2 $$\n$$ N_{3,1}(\\xi) = \\frac{\\xi-0.5}{1-0.5} = 2(\\xi-0.5) \\implies \\frac{dN_{3,1}}{d\\xi} = 2 $$\n\n在 $\\eta$ 方向，于区间 $[\\eta_2, \\eta_3] = [0.3, 1]$ 上：\n$$ N_{2,1}(\\eta) = \\frac{1-\\eta}{1-0.3} = \\frac{10}{7}(1-\\eta) \\implies \\frac{dN_{2,1}}{d\\eta} = -\\frac{10}{7} $$\n$$ N_{3,1}(\\eta) = \\frac{\\eta-0.3}{1-0.3} = \\frac{10}{7}(\\eta-0.3) \\implies \\frac{dN_{3,1}}{d\\eta} = \\frac{10}{7} $$\n\n**3. NURBS基函数**\nNURBS基函数 $R_{ij}$ 定义为 $R_{ij}(\\xi,\\eta) = \\frac{N_{i,p}(\\xi)N_{j,q}(\\eta)w_{ij}}{\\sum_{k,l} N_{k,p}(\\xi)N_{l,q}(\\eta)w_{kl}}$。由于所有权重 $w_{ij}=1$，分母是所有加权基函数的和，根据B样条的单位分解性质，变为 $\\sum_{k,l} N_{k,p}(\\xi)N_{l,q}(\\eta)w_{kl} = (\\sum_k N_{k,p}(\\xi))(\\sum_l N_{l,q}(\\eta)) = 1 \\cdot 1 = 1$。\n因此，NURBS公式简化为B样条公式：$R_{ij}(\\xi,\\eta) = N_{i,1}(\\xi)N_{j,1}(\\eta)$。导数也得以简化，例如 $\\frac{\\partial R_{ij}}{\\partial\\xi} = \\frac{dN_{i,1}}{d\\xi} N_{j,1}(\\eta)$。\n\n**4. 几何映射的雅可比矩阵**\n几何映射为 $\\mathbf{x}(\\xi,\\eta)=\\sum_{i=1}^{3}\\sum_{j=1}^{3} R_{ij}(\\xi,\\eta)\\,\\mathbf{P}_{ij}$。在指定的单元上，只有控制点 $\\mathbf{P}_{22}, \\mathbf{P}_{23}, \\mathbf{P}_{32}, \\mathbf{P}_{33}$ 是活动的。雅可比矩阵是 $\\mathbf{J} = \\frac{\\partial\\mathbf{x}}{\\partial(\\xi,\\eta)}$。其列向量是 $\\frac{\\partial\\mathbf{x}}{\\partial\\xi}$ 和 $\\frac{\\partial\\mathbf{x}}{\\partial\\eta}$。\n$$ \\frac{\\partial\\mathbf{x}}{\\partial\\xi} = \\sum_{i=2,3}\\sum_{j=2,3} \\frac{dN_{i,1}}{d\\xi} N_{j,1}(\\eta) \\mathbf{P}_{ij} = \\frac{dN_{2,1}}{d\\xi} \\sum_{j=2,3} N_{j,1}(\\eta) \\mathbf{P}_{2j} + \\frac{dN_{3,1}}{d\\xi} \\sum_{j=2,3} N_{j,1}(\\eta) \\mathbf{P}_{3j} $$\n由于 $\\sum_j N_{j,1}(\\eta) = 1$（单位分解），表达式得以简化。更直接地，对于一个由单位父单元上的四个控制点 $\\mathbf{P}_{00}, \\mathbf{P}_{10}, \\mathbf{P}_{01}, \\mathbf{P}_{11}$ 定义的双线性面片，其切向量是边向量的线性组合。\n在此，我们可以重新计算具体的导数。因为基函数是线性的，其导数在单个节点区间内是常数。\n$$ \\frac{\\partial\\mathbf{x}}{\\partial\\xi} = \\frac{\\partial N_{2,1}}{\\partial\\xi} (N_{2,1}(\\eta) \\mathbf{P}_{22} + N_{3,1}(\\eta)\\mathbf{P}_{23}) + \\frac{\\partial N_{3,1}}{\\partial\\xi} (N_{2,1}(\\eta) \\mathbf{P}_{32} + N_{3,1}(\\eta)\\mathbf{P}_{33}) $$\n$$ = -2 (N_{2,1}(\\eta)\\mathbf{P}_{22} + N_{3,1}(\\eta)\\mathbf{P}_{23}) + 2 (N_{2,1}(\\eta)\\mathbf{P}_{32} + N_{3,1}(\\eta)\\mathbf{P}_{33}) = 2 (N_{2,1}(\\eta)(\\mathbf{P}_{32}-\\mathbf{P}_{22}) + N_{3,1}(\\eta)(\\mathbf{P}_{33}-\\mathbf{P}_{23})) $$\n$\\mathbf{P}_{32}-\\mathbf{P}_{22} = (4.1-2.1, 1-1.1) = (2, -0.1)$。\n$\\mathbf{P}_{33}-\\mathbf{P}_{23} = (4-2, 2-2.1) = (2, -0.1)$。\n$$ \\frac{\\partial\\mathbf{x}}{\\partial\\xi} = 2 (N_{2,1}(\\eta)(2, -0.1) + N_{3,1}(\\eta)(2, -0.1)) = 2 (N_{2,1}(\\eta)+N_{3,1}(\\eta))(2, -0.1) = 2(1)(2, -0.1) = (4,-0.2) $$\n同样对于 $\\eta$ 方向：\n$$ \\frac{\\partial\\mathbf{x}}{\\partial\\eta} = N_{2,1}(\\xi)(\\frac{dN_{2,1}}{d\\eta}\\mathbf{P}_{22} + \\frac{dN_{3,1}}{d\\eta}\\mathbf{P}_{23}) + N_{3,1}(\\xi)(\\frac{dN_{2,1}}{d\\eta}\\mathbf{P}_{32} + \\frac{dN_{3,1}}{d\\eta}\\mathbf{P}_{33}) $$\n$\\mathbf{P}_{23}-\\mathbf{P}_{22} = (2-2.1, 2.1-1.1) = (-0.1, 1)$。\n$\\mathbf{P}_{33}-\\mathbf{P}_{32} = (4-4.1, 2-1) = (-0.1, 1)$。\n导数为 $\\frac{dN_{2,1}}{d\\eta}=-\\frac{10}{7}, \\frac{dN_{3,1}}{d\\eta}=\\frac{10}{7}$。\n$$ \\frac{\\partial\\mathbf{x}}{\\partial\\eta} = \\frac{10}{7}[N_{2,1}(\\xi)(\\mathbf{P}_{23}-\\mathbf{P}_{22}) + N_{3,1}(\\xi)(\\mathbf{P}_{33}-\\mathbf{P}_{32})] = \\frac{10}{7}[N_{2,1}(\\xi)(-0.1, 1) + N_{3,1}(\\xi)(-0.1, 1)] $$\n$$ = \\frac{10}{7}(N_{2,1}(\\xi)+N_{3,1}(\\xi))(-0.1, 1) = \\frac{10}{7}(1)(-0.1, 1) = (-\\frac{1}{7}, \\frac{10}{7}) $$\n由于几何是一个双线性面片，雅可比矩阵 $\\mathbf{J}$ 在此单元上是常数：\n$$ \\mathbf{J} = \\begin{pmatrix} 4  -\\frac{1}{7} \\\\ -0.2  \\frac{10}{7} \\end{pmatrix} = \\begin{pmatrix} 4  -\\frac{1}{7} \\\\ -\\frac{1}{5}  \\frac{10}{7} \\end{pmatrix} $$\n雅可比矩阵的行列式为：\n$$ \\det\\mathbf{J} = (4)\\left(\\frac{10}{7}\\right) - \\left(-\\frac{1}{7}\\right)\\left(-\\frac{1}{5}\\right) = \\frac{40}{7} - \\frac{1}{35} = \\frac{200-1}{35} = \\frac{199}{35} $$\n\n**5. 求积权重计算**\n微分面积元从父空间变换到物理空间为 $d\\mathbf{x} = \\det\\mathbf{J} \\,d\\xi d\\eta$。我们还必须考虑从父单元 $(r,s)$ 到参数单元 $(\\xi,\\eta)$ 的映射：$d\\xi d\\eta = \\det\\mathbf{J}_{\\text{param}} \\,dr ds$。\n父空间到参数空间映射的雅可比矩阵是：\n$$ \\mathbf{J}_{\\text{param}} = \\begin{pmatrix} \\frac{\\partial\\xi}{\\partial r}  0 \\\\ 0  \\frac{\\partial\\eta}{\\partial s} \\end{pmatrix} = \\begin{pmatrix} \\frac{1-0.5}{2}  0 \\\\ 0  \\frac{1-0.3}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4}  0 \\\\ 0  \\frac{7}{20} \\end{pmatrix} $$\n$$ \\det\\mathbf{J}_{\\text{param}} = \\left(\\frac{1}{4}\\right)\\left(\\frac{7}{20}\\right) = \\frac{7}{80} $$\n一个高斯点处的总求积权重 $W$ 是父空间权重和总雅可比行列式的乘积：\n$$ W = w_{r} w_{s} \\cdot \\det\\mathbf{J}_{\\text{param}} \\cdot \\det\\mathbf{J} $$\n给定 $w_{r}=1$ 和 $w_{s}=1$：\n$$ W = (1)(1) \\cdot \\left(\\frac{7}{80}\\right) \\cdot \\left(\\frac{199}{35}\\right) = \\frac{7 \\cdot 199}{80 \\cdot 35} = \\frac{199}{80 \\cdot 5} = \\frac{199}{400} $$\n控制点的单位是米，因此得到的求积权重（代表一个面积元）的单位是平方米。", "answer": "$$\n\\boxed{\\frac{199}{400}}\n$$", "id": "2651381"}]}