{"hands_on_practices": [{"introduction": "伽辽金方法的核心在于将连续的物理问题（由偏微分方程描述）转化为一个离散的代数方程组，形式为 $[K]\\{d\\} = \\{F\\}$。本节的第一个实践练习将聚焦于其中最关键的部分：推导单元刚度矩阵 $[K^e]$。这个矩阵编码了单元的材料行为和几何信息，是连接连续介质力学理论和有限元数值求解的桥梁。通过这个练习，我们将从弱形式出发，为线性弹性材料推导出单元刚度矩阵的具体条目，从而深刻理解其物理和数学内涵。 [@problem_id:2697408]", "problem": "考虑一个二维、静态、小应变的线性弹性体，其占据一个有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{2}$，外法线单位向量为 $\\boldsymbol{n}$。设位移场为 $\\boldsymbol{u}:\\Omega \\rightarrow \\mathbb{R}^{2}$，体力密度为 $\\boldsymbol{b}:\\Omega \\rightarrow \\mathbb{R}^{2}$，在 Neumann 边界 $\\Gamma_{t}\\subset \\partial \\Omega$ 上的给定牵引力为 $\\boldsymbol{t}:\\Gamma_{t} \\rightarrow \\mathbb{R}^{2}$。本构律为线性弹性，其四阶弹性张量为 $\\mathbb{C}$（假设为均匀和各向同性），小应变张量为 $\\boldsymbol{\\varepsilon}(\\boldsymbol{u})=\\nabla^{s}\\boldsymbol{u}=\\tfrac{1}{2}(\\nabla \\boldsymbol{u}+\\nabla \\boldsymbol{u}^{T})$。从弱形式 $a(\\boldsymbol{u},\\boldsymbol{v})=\\ell(\\boldsymbol{v})$ 出发，对于在 Dirichlet 边界上为零的所有虚位移 $\\boldsymbol{v}\\in [H^{1}(\\Omega)]^{2}$，推导在 $\\Omega$ 的三角剖分上使用 $C^{0}$ 连续的分片线性形函数的有限元 Galerkin 离散化。具体要求如下：\n- 从双线性形式 $a(\\boldsymbol{u},\\boldsymbol{v})$ 以及 $\\boldsymbol{u}$ 和 $\\boldsymbol{v}$ 的 Galerkin 假设出发，推导单元刚度矩阵各项的显式表达式，该表达式应使用标量形函数的导数和弹性张量的分量来表示。\n- 明确说明对称梯度算子和本构张量在推导过程中的作用。\n- 定义单元自由度排序，并给出连接形函数梯度与应变的单元应变-位移算子。\n- 精确解释如何使用单元到全局自由度的映射，将得到的单元矩阵组装成全局刚度矩阵。\n\n然后，为使推导具体化，将其特化为二维平面应变问题，其各向同性弹性由杨氏模量 $E$ 和泊松比 $\\nu$ 表征，并考虑一个具有以下节点的等厚度三角形单元\n- 节点 $1$ 位于 $(x_1,y_1)=(0,0)$，\n- 节点 $2$ 位于 $(x_2,y_2)=(0.3,0)$，\n- 节点 $3$ 位于 $(x_3,y_3)=(0,0.2)$，\n以及均匀的平面外厚度 $t$。使用规范的单元自由度排序 $[u_1,v_1,u_2,v_2,u_3,v_3]^T$，其中 $u_i$ 和 $v_i$ 分别是节点 $i$ 处的水平和垂直位移分量。\n\n计算单元刚度矩阵中耦合节点1的水平位移与节点2的水平位移的特定标量项（即在所述排序下的 $(1,3)$ 项），并用 $E$、$\\nu$ 和 $t$ 表示最终结果的闭式解析表达式。您的最终表达式单位为 $\\mathrm{N}/\\mathrm{m}$；请不要在最终的方框答案中包含单位。不要代入数值；只提供符号表达式。", "solution": "该问题陈述在计算固体力学领域中被验证为一个正确且自洽的表述。它具有科学依据、是适定的，并为获得唯一解提供了所有必要的数据和定义。我们继续进行推导和计算。\n\n出发点是虚功原理，对于静态弹性体，它导出平衡方程的弱形式。该形式指出，对于任何运动学上容许的虚位移场 $\\boldsymbol{v}$（其在 Dirichlet 边界上为零），以下等式必须成立：\n$$\n\\int_{\\Omega} \\boldsymbol{\\sigma}(\\boldsymbol{u}) : \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) \\, dV = \\int_{\\Omega} \\boldsymbol{b} \\cdot \\boldsymbol{v} \\, dV + \\int_{\\Gamma_t} \\boldsymbol{t} \\cdot \\boldsymbol{v} \\, dS\n$$\n此处，$\\boldsymbol{u}$ 是真实位移场，$\\boldsymbol{\\sigma}(\\boldsymbol{u})$ 是对应于 $\\boldsymbol{u}$ 的 Cauchy 应力张量，$\\boldsymbol{\\varepsilon}(\\boldsymbol{v})$ 是虚位移场的小应变张量。等式右侧的项代表了体力 $\\boldsymbol{b}$ 和面牵引力 $\\boldsymbol{t}$ 所做的虚功。\n应力张量和应变张量通过线性本构律 $\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon}$ 相关联，其中 $\\mathbb{C}$ 是四阶弹性张量。应变由位移的对称梯度给出，$\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\nabla^s \\boldsymbol{u} = \\frac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^T)$。\n将本构律代入弱形式可得：\n$$\n\\underbrace{\\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) : \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) \\, dV}_{a(\\boldsymbol{u},\\boldsymbol{v})} = \\underbrace{\\int_{\\Omega} \\boldsymbol{b} \\cdot \\boldsymbol{v} \\, dV + \\int_{\\Gamma_t} \\boldsymbol{t} \\cdot \\boldsymbol{v} \\, dS}_{\\ell(\\boldsymbol{v})}\n$$\n左侧定义了一个对称双线性形式 $a(\\boldsymbol{u},\\boldsymbol{v})$，右侧定义了一个线性泛函 $\\ell(\\boldsymbol{v})$。\n\n在有限元 Galerkin 方法中，区域 $\\Omega$ 被离散化为单元网格 $\\Omega_e$。在每个单元内，位移场 $\\boldsymbol{u}$ 由一个函数 $\\boldsymbol{u}^h$ 来近似，该函数由一组有限的基函数（称为形函数）构建。对于 $C^0$ 连续的分片线性单元，单元内一点 $\\boldsymbol{x}$ 处的位移由节点位移 $\\boldsymbol{d}_i^e$ 插值得到：\n$$\n\\boldsymbol{u}^h(\\boldsymbol{x}) = \\sum_{i=1}^{n_{nodes}} N_i(\\boldsymbol{x}) \\boldsymbol{d}_i^e\n$$\n此处，$n_{nodes}$ 是单元中的节点数，$N_i(\\boldsymbol{x})$ 是标量形函数，$\\boldsymbol{d}_i^e = [u_i, v_i]^T$ 是节点 $i$ 处的位移分量。对虚位移场也使用相同的近似，$\\boldsymbol{v}^h = \\sum_{j=1}^{n_{nodes}} N_j(\\boldsymbol{x}) \\boldsymbol{c}_j^e$，其中 $\\boldsymbol{c}_j^e$ 是任意的虚拟节点位移。\n\n为方便计算，我们采用矩阵-向量表示法（Voigt 表示法）。应变张量的分量被排列成一个向量 $\\boldsymbol{\\epsilon} = [\\epsilon_{xx}, \\epsilon_{yy}, \\gamma_{xy}]^T$，其中 $\\gamma_{xy}=2\\epsilon_{xy}$。本构律变为 $\\boldsymbol{\\sigma}=\\boldsymbol{D}\\boldsymbol{\\epsilon}$，其中 $\\boldsymbol{D}$ 是用于二维问题的 $3 \\times 3$ 本构矩阵。双线性形式变为 $a(\\boldsymbol{u}, \\boldsymbol{v}) = \\int_{\\Omega} \\boldsymbol{\\epsilon}(\\boldsymbol{v})^T \\boldsymbol{D} \\boldsymbol{\\epsilon}(\\boldsymbol{u}) \\, dV$。\n\n应变向量通过将矩阵微分算子应用于位移向量得到：$\\boldsymbol{\\epsilon} = \\boldsymbol{\\mathcal{L}}\\boldsymbol{u}$，其中 $\\boldsymbol{\\mathcal{L}} = \\begin{pmatrix} \\partial/\\partial x  0 \\\\ 0  \\partial/\\partial y \\\\ \\partial/\\partial y  \\partial/\\partial x \\end{pmatrix}$。\n将此应用于有限元近似 $\\boldsymbol{u}^h$，我们得到应变向量与所有单元节点自由度向量 $\\boldsymbol{d}^e = [u_1,v_1,u_2,v_2,\\dots]^T$ 之间的关系：\n$$\n\\boldsymbol{\\epsilon}(\\boldsymbol{x}) = \\boldsymbol{B}(\\boldsymbol{x}) \\boldsymbol{d}^e\n$$\n矩阵 $\\boldsymbol{B}$ 是应变-位移矩阵。对于一个具有指定自由度（DOF）排序 $\\boldsymbol{d}^e=[u_1, v_1, u_2, v_2, u_3, v_3]^T$ 的三节点三角形，它是一个 $3 \\times 6$ 的矩阵，定义如下：\n$$\n\\boldsymbol{B} = \\begin{pmatrix}\n\\frac{\\partial N_1}{\\partial x}  0  \\frac{\\partial N_2}{\\partial x}  0  \\frac{\\partial N_3}{\\partial x}  0 \\\\\n0  \\frac{\\partial N_1}{\\partial y}  0  \\frac{\\partial N_2}{\\partial y}  0  \\frac{\\partial N_3}{\\partial y} \\\\\n\\frac{\\partial N_1}{\\partial y}  \\frac{\\partial N_1}{\\partial x}  \\frac{\\partial N_2}{\\partial y}  \\frac{\\partial N_2}{\\partial x}  \\frac{\\partial N_3}{\\partial y}  \\frac{\\partial N_3}{\\partial x}\n\\end{pmatrix}\n$$\n将 Galerkin 近似代入单个单元的双线性形式中可得：\n$$\na(\\boldsymbol{u}^h, \\boldsymbol{v}^h)_{\\Omega_e} = \\int_{\\Omega_e} (\\boldsymbol{B}\\boldsymbol{c}^e)^T \\boldsymbol{D} (\\boldsymbol{B}\\boldsymbol{d}^e) \\, dV = (\\boldsymbol{c}^e)^T \\left( \\int_{\\Omega_e} \\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B} \\, dV \\right) \\boldsymbol{d}^e\n$$\n由此，我们确定单元刚度矩阵 $\\boldsymbol{K}^e$：\n$$\n\\boldsymbol{K}^e = \\int_{\\Omega_e} \\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B} \\, dV\n$$\n对称梯度算子 $\\nabla^s \\boldsymbol{u}$ 的作用是根本性的，因为它从位移定义了应变。其结构被编码在算子 $\\boldsymbol{\\mathcal{L}}$ 中，并直接决定了连接节点位移与单元应变的应变-位移矩阵 $\\boldsymbol{B}$ 的内容和结构。本构张量 $\\mathbb{C}$（或其矩阵形式 $\\boldsymbol{D}$）的作用是提供应力与应变之间特定于材料的线性关系。它在能量双线性形式中充当核，并决定了刚度矩阵的数值。\n\n全局刚度矩阵 $\\boldsymbol{K}$是通过组装所有单元矩阵 $\\boldsymbol{K}^e$ 的贡献来构建的。这个组装过程涉及将单元矩阵的各项加到全局矩阵的适当位置，该过程由单元到全局自由度的映射所控制。\n\n现在，我们特化到平面应变条件下的给定三角形单元。对于一个线性三角形单元（常应变三角形单元或 CST），形函数的梯度在整个单元内是常数。因此，矩阵 $\\boldsymbol{B}$ 是常数。$\\boldsymbol{K}^e$ 的积分简化为：\n$$\n\\boldsymbol{K}^e = (\\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B}) \\int_{\\Omega_e} dV = A_e t \\, \\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B}\n$$\n其中 $A_e$ 是单元的面积，$t$ 是其恒定厚度。\n\n节点坐标给出为 $1: (x_1, y_1)=(0,0)$，$2: (x_2, y_2)=(0.3,0)$，以及 $3: (x_3, y_3)=(0,0.2)$。这个直角三角形的面积是 $A_e = \\frac{1}{2} \\times 0.3 \\times 0.2 = 0.03$。\n线性形函数的导数由标准公式给出。对于 $1,2,3$ 的循环置换 $i_1, i_2, i_3$：\n$\\frac{\\partial N_{i_1}}{\\partial x} = \\frac{y_{i_2}-y_{i_3}}{2A_e}$，以及 $\\frac{\\partial N_{i_1}}{\\partial y} = \\frac{x_{i_3}-x_{i_2}}{2A_e}$。\n计算 $2A_e = 0.06$：\n$\\frac{\\partial N_1}{\\partial x} = \\frac{0-0.2}{0.06} = -\\frac{10}{3}$；$\\frac{\\partial N_1}{\\partial y} = \\frac{0-0.3}{0.06} = -5$。\n$\\frac{\\partial N_2}{\\partial x} = \\frac{0.2-0}{0.06} = \\frac{10}{3}$；$\\frac{\\partial N_2}{\\partial y} = \\frac{0-0}{0.06} = 0$。\n$\\frac{\\partial N_3}{\\partial x} = \\frac{0-0}{0.06} = 0$；$\\frac{\\partial N_3}{\\partial y} = \\frac{0.3-0}{0.06} = 5$。\n因此，$\\boldsymbol{B}$ 矩阵为：\n$$\n\\boldsymbol{B} = \\begin{pmatrix}\n-\\frac{10}{3}  0  \\frac{10}{3}  0  0  0 \\\\\n0  -5  0  0  0  5 \\\\\n-5  -\\frac{10}{3}  0  \\frac{10}{3}  5  0\n\\end{pmatrix}\n$$\n对于平面应变下的各向同性线性弹性，本构矩阵 $\\boldsymbol{D}$ 是：\n$$\n\\boldsymbol{D} = \\frac{E}{(1+\\nu)(1-2\\nu)} \\begin{pmatrix}\n1-\\nu  \\nu  0 \\\\\n\\nu  1-\\nu  0 \\\\\n0  0  \\frac{1-2\\nu}{2}\n\\end{pmatrix}\n$$\n我们需要计算单元刚度矩阵的 $(1,3)$ 项，$K^e_{13}$。该项耦合了节点1的水平位移（$u_1$，自由度1）与节点2的水平位移（$u_2$，自由度3）。它由 $K^e_{13} = A_e t (\\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B})_{13}$ 给出。$\\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B}$ 的 $(i,j)$ 项是 $(\\boldsymbol{B}_{col,i})^T \\boldsymbol{D} (\\boldsymbol{B}_{col,j})$，其中 $\\boldsymbol{B}_{col,k}$ 是 $\\boldsymbol{B}$ 的第 $k$ 列。\n因此，$K^e_{13} = A_e t (\\boldsymbol{B}_{col,1})^T \\boldsymbol{D} (\\boldsymbol{B}_{col,3})$。\n$\\boldsymbol{B}$ 所需的列是：\n$$\n\\boldsymbol{B}_{col,1} = \\begin{pmatrix} -\\frac{10}{3} \\\\ 0 \\\\ -5 \\end{pmatrix}, \\quad \\boldsymbol{B}_{col,3} = \\begin{pmatrix} \\frac{10}{3} \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n我们计算乘积 $(\\boldsymbol{B}_{col,1})^T \\boldsymbol{D} (\\boldsymbol{B}_{col,3})$：\n$$\n\\begin{pmatrix} -\\frac{10}{3}  0  -5 \\end{pmatrix} \\frac{E}{(1+\\nu)(1-2\\nu)} \\begin{pmatrix}\n1-\\nu  \\nu  0 \\\\\n\\nu  1-\\nu  0 \\\\\n0  0  \\frac{1-2\\nu}{2}\n\\end{pmatrix} \\begin{pmatrix} \\frac{10}{3} \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n首先，计算 $\\boldsymbol{D}$ 和 $\\boldsymbol{B}_{col,3}$ 的乘积：\n$$\n\\frac{E}{(1+\\nu)(1-2\\nu)} \\begin{pmatrix}\n(1-\\nu)\\frac{10}{3} \\\\\n\\nu\\frac{10}{3} \\\\\n0\n\\end{pmatrix}\n$$\n然后，与 $(\\boldsymbol{B}_{col,1})^T$ 进行点积：\n$$\n\\frac{E}{(1+\\nu)(1-2\\nu)} \\left[ \\left(-\\frac{10}{3}\\right)(1-\\nu)\\frac{10}{3} + (0)(\\nu)\\frac{10}{3} + (-5)(0) \\right] = -\\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} \\frac{100}{9}\n$$\n最后，我们乘以 $A_e t$：\n$$\nK^e_{13} = (0.03) t \\left( -\\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} \\frac{100}{9} \\right) = \\left(\\frac{3}{100}\\right) t \\left( -\\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} \\frac{100}{9} \\right)\n$$\n$$\nK^e_{13} = -\\frac{3 \\cdot 100}{100 \\cdot 9} \\frac{t E (1-\\nu)}{(1+\\nu)(1-2\\nu)} = -\\frac{1}{3} \\frac{t E (1-\\nu)}{(1+\\nu)(1-2\\nu)}\n$$\n这就是所求刚度矩阵项的最终符号表达式。", "answer": "$$\n\\boxed{-\\frac{t E (1-\\nu)}{3 (1+\\nu) (1-2\\nu)}}\n$$", "id": "2697408"}, {"introduction": "在计算出刚度矩阵之后，构建有限元方程组的下一个逻辑步骤是确定力向量 $\\{F\\}$，它代表施加在系统上的外部载荷。这个实践练习将演示如何运用伽辽金原理，将体力和面力等分布式载荷一致地转化为等效的节点力。这个过程对于确保外力功在离散模型中得到正确表示至关重要，该练习特别强调了在处理任意单元几何时，使用等参映射及其雅可比行列式的重要性。 [@problem_id:2697388]", "problem": "考虑一个厚度恒为 $h$ 的平面应力连续体，它由一个四节点双线性等参四边形有限元建模。节点位于 $(x_1,y_1)=(0,0)$、$(x_2,y_2)=(L_x,0)$、$(x_3,y_3)=(L_x,L_y)$ 和 $(x_4,y_4)=(0,L_y)$，并沿周边采用常规的局部节点排序 $1 \\rightarrow 2 \\rightarrow 3 \\rightarrow 4$。单位体积的体力是均匀的，由向量 $\\mathbf{b}=[\\,b_x,\\;b_y\\,]^{\\mathsf{T}}$ 给出。位于 $x=L_x$ 的右边界（连接节点 $2$ 和 $3$ 的边）承受均布面力向量 $\\bar{\\mathbf{t}}=[\\,\\bar{t}_x,\\;\\bar{t}_y\\,]^{\\mathsf{T}}$。假设小变形和线性运动学，并使用定义在母单元正方形 $\\{(\\xi,\\eta):\\,-1\\le \\xi,\\eta \\le 1\\}$ 上的标准双线性等参形函数。\n\n仅从虚功原理和伽辽金法（其中虚位移场通过与位移场相同的形函数进行插值）出发，推导与体力及边界面力相关的一致单元节点力贡献。明确展示在等参映射下体积积分和边界积分如何变换，包括用于面积测度的雅可比矩阵行列式和用于边界测度的一维边界雅可比。然后，对此特定矩形单元和给定的均匀数据执行这些变换后的积分，得到组集后的八分量单元节点力向量 $[\\,F_{1x},\\,F_{1y},\\,F_{2x},\\,F_{2y},\\,F_{3x},\\,F_{3y},\\,F_{4x},\\,F_{4y}\\,]^{\\mathsf{T}}$ 的闭式表达式。\n\n将最终答案以 $L_x$、$L_y$、$h$、$b_x$、$b_y$、$\\bar{t}_x$ 和 $\\bar{t}_y$ 的符号函数形式表示。无需进行数值计算。最终的方框答案中不要包含单位。", "solution": "该问题是应用伽辽金有限元法确定线性弹性中由外载荷引起的一致节点力的标准应用。该问题在科学上是合理的、适定的，并包含唯一解所需的所有必要信息。我们开始推导。\n\n虚功原理指出，对于处于平衡状态的物体，外力所做的虚功 $\\delta W_{ext}$ 等于内应力所做的虚功（虚应变能）$\\delta W_{int}$。外力虚功由体力 $\\mathbf{b}$ 在体积 $V$ 上所做的功和给定面力 $\\bar{\\mathbf{t}}$ 在面力边界 $\\Gamma_t$ 上所做的功之和给出。\n$$ \\delta W_{ext} = \\int_V \\delta\\mathbf{u}^{\\mathsf{T}} \\mathbf{b} \\, dV + \\int_{\\Gamma_t} \\delta\\mathbf{u}^{\\mathsf{T}} \\bar{\\mathbf{t}} \\, d\\Gamma $$\n此处，$\\delta\\mathbf{u}$ 是任意的、运动学容许的虚位移场。\n\n在伽辽金有限元列式中，单元内的位移场 $\\mathbf{u}$ 和虚位移场 $\\delta\\mathbf{u}$ 是使用相同的形函数从节点位移 $\\mathbf{d}$ 和虚节点位移 $\\delta\\mathbf{d}$ 插值得到的。\n$$ \\mathbf{u}(\\mathbf{x}) = \\mathbf{N}(\\mathbf{x}) \\mathbf{d} $$\n$$ \\delta\\mathbf{u}(\\mathbf{x}) = \\mathbf{N}(\\mathbf{x}) \\delta\\mathbf{d} $$\n一个四节点二维单元的形函数矩阵 $\\mathbf{N}$ 为\n$$ \\mathbf{N} = \\begin{bmatrix} N_1  0  N_2  0  N_3  0  N_4  0 \\\\ 0  N_1  0  N_2  0  N_3  0  N_4 \\end{bmatrix} $$\n单元节点位移向量为 $\\mathbf{d} = [u_1, v_1, u_2, v_2, u_3, v_3, u_4, v_4]^{\\mathsf{T}}$ 和 $\\delta\\mathbf{d} = [\\delta u_1, \\delta v_1, \\dots, \\delta v_4]^{\\mathsf{T}}$。\n\n将插值得到的虚位移代入 $\\delta W_{ext}$ 的表达式中，可得：\n$$ \\delta W_{ext} = \\int_V (\\mathbf{N} \\delta\\mathbf{d})^{\\mathsf{T}} \\mathbf{b} \\, dV + \\int_{\\Gamma_t} (\\mathbf{N} \\delta\\mathbf{d})^{\\mathsf{T}} \\bar{\\mathbf{t}} \\, d\\Gamma $$\n$$ \\delta W_{ext} = \\delta\\mathbf{d}^{\\mathsf{T}} \\left( \\int_V \\mathbf{N}^{\\mathsf{T}} \\mathbf{b} \\, dV + \\int_{\\Gamma_t} \\mathbf{N}^{\\mathsf{T}} \\bar{\\mathbf{t}} \\, d\\Gamma \\right) $$\n根据定义，$\\delta W_{ext} = \\delta\\mathbf{d}^{\\mathsf{T}} \\mathbf{F}_{ext}$，其中 $\\mathbf{F}_{ext}$ 是一致单元节点力向量。由于 $\\delta\\mathbf{d}$ 是任意的，我们可确定 $\\mathbf{F}_{ext}$ 为：\n$$ \\mathbf{F}_{ext} = \\mathbf{F}_b + \\mathbf{F}_t = \\int_V \\mathbf{N}^{\\mathsf{T}} \\mathbf{b} \\, dV + \\int_{\\Gamma_t} \\mathbf{N}^{\\mathsf{T}} \\bar{\\mathbf{t}} \\, d\\Gamma $$\n其中 $\\mathbf{F}_b$ 是体力贡献，$\\mathbf{F}_t$ 是面力贡献。\n\n该问题使用一个四节点双线性等参单元。这意味着几何形状是从母单元正方形域 $\\{(\\xi,\\eta) : -1 \\le \\xi,\\eta \\le 1\\}$ 使用与位移场相同的形函数进行映射的。\n形函数为：\n$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\n坐标映射由 $x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i$ 和 $y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i$ 给出。该变换的雅可比矩阵为\n$$ \\mathbf{J} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} = \\begin{bmatrix} \\sum \\frac{\\partial N_i}{\\partial \\xi} x_i  \\sum \\frac{\\partial N_i}{\\partial \\xi} y_i \\\\ \\sum \\frac{\\partial N_i}{\\partial \\eta} x_i  \\sum \\frac{\\partial N_i}{\\partial \\eta} y_i \\end{bmatrix} $$\n使用给定的节点坐标 $(x_1,y_1)=(0,0)$、$(x_2,y_2)=(L_x,0)$、$(x_3,y_3)=(L_x,L_y)$、$(x_4,y_4)=(0,L_y)$：\n$\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4} \\left[ -(1-\\eta)x_1 + (1-\\eta)x_2 + (1+\\eta)x_3 - (1+\\eta)x_4 \\right] = \\frac{1}{4} \\left[ 0 + (1-\\eta)L_x + (1+\\eta)L_x - 0 \\right] = \\frac{L_x}{2}$\n$\\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4} \\left[ -(1-\\eta)y_1 + (1-\\eta)y_2 + (1+\\eta)y_3 - (1+\\eta)y_4 \\right] = \\frac{1}{4} \\left[ 0 + 0 + (1+\\eta)L_y - (1+\\eta)L_y \\right] = 0$\n$\\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4} \\left[ -(1-\\xi)x_1 - (1+\\xi)x_2 + (1+\\xi)x_3 + (1-\\xi)x_4 \\right] = \\frac{1}{4} \\left[ 0 - (1+\\xi)L_x + (1+\\xi)L_x + 0 \\right] = 0$\n$\\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4} \\left[ -(1-\\xi)y_1 - (1+\\xi)y_2 + (1+\\xi)y_3 + (1-\\xi)y_4 \\right] = \\frac{1}{4} \\left[ 0 - 0 + (1+\\xi)L_y + (1-\\xi)L_y \\right] = \\frac{L_y}{2}$\n因此，对于此矩形单元，雅可比矩阵是恒定的：\n$$ \\mathbf{J} = \\begin{bmatrix} L_x/2  0 \\\\ 0  L_y/2 \\end{bmatrix} $$\n行列式为 $\\det(\\mathbf{J}) = \\frac{L_x L_y}{4}$。微分体积元变换为 $dV = h \\, dA = h \\det(\\mathbf{J}) d\\xi d\\eta = \\frac{h L_x L_y}{4} d\\xi d\\eta$。\n\n首先，我们计算体力向量 $\\mathbf{F}_b$：\n$$ \\mathbf{F}_b = \\int_V \\mathbf{N}^{\\mathsf{T}} \\mathbf{b} \\, dV = \\int_{-1}^{1} \\int_{-1}^{1} \\mathbf{N}(\\xi, \\eta)^{\\mathsf{T}} \\mathbf{b} \\, h \\det(\\mathbf{J}) d\\xi d\\eta $$\n由于 $\\mathbf{b}$、$h$ 和 $\\det(\\mathbf{J})$ 均为常数，因此可以简化。节点 $i$ 的力分量为：\n$$ \\mathbf{F}_{ib} = \\begin{bmatrix} F_{ibx} \\\\ F_{iby} \\end{bmatrix} = \\left( \\int_V N_i dV \\right) \\mathbf{b} = h \\det(\\mathbf{J}) \\left( \\int_{-1}^{1} \\int_{-1}^{1} N_i(\\xi, \\eta) d\\xi d\\eta \\right) \\mathbf{b} $$\n对于任何双线性形函数，在母单元上的积分均为 $1$。例如，对于 $N_1$：\n$$ \\int_{-1}^{1} \\int_{-1}^{1} N_1 d\\xi d\\eta = \\int_{-1}^{1} \\int_{-1}^{1} \\frac{1}{4}(1-\\xi)(1-\\eta) d\\xi d\\eta = \\frac{1}{4} \\left( \\int_{-1}^{1} (1-\\xi) d\\xi \\right) \\left( \\int_{-1}^{1} (1-\\eta) d\\eta \\right) = \\frac{1}{4}(2)(2) = 1 $$\n因此，$\\int_V N_i dV = h \\frac{L_x L_y}{4} (1) = \\frac{h L_x L_y}{4}$。这意味着单元上的总体力 $\\mathbf{b} (h L_x L_y)$ 均等地分布到四个节点上。\n$$ \\mathbf{F}_{ib} = \\frac{h L_x L_y}{4} \\begin{bmatrix} b_x \\\\ b_y \\end{bmatrix} \\quad \\text{for } i=1, 2, 3, 4 $$\n\n接下来，我们计算面力向量 $\\mathbf{F}_t$。面力 $\\bar{\\mathbf{t}}$ 作用于连接节点 $2$ 和 $3$ 的边 $x=L_x$ 上。在母单元域中，这对应于 $-1 \\le \\eta \\le 1$ 时的边 $\\xi=1$。\n积分是在施加面力的表面区域 $\\Gamma_t$ 上进行的。微分表面元 $d\\Gamma$ 是 $h\\,ds$，其中 $ds$ 是微分弧长。变换关系为 $ds = \\sqrt{(\\frac{dx}{d\\eta})^2 + (\\frac{dy}{d\\eta})^2} \\, d\\eta$。我们将平方根因子称为一维边界雅可比 $J_{1D}$。\n在边 $\\xi=1$ 上，映射为 $x(\\eta) = L_x$ 和 $y(\\eta) = \\frac{L_y}{2}(1+\\eta)$。\n关于 $\\eta$ 的导数为 $\\frac{dx}{d\\eta}=0$ 和 $\\frac{dy}{d\\eta}=\\frac{L_y}{2}$。\n边界雅可比为 $J_{1D} = \\sqrt{0^2 + (L_y/2)^2} = \\frac{L_y}{2}$。\n所以，$d\\Gamma = h J_{1D} d\\eta = \\frac{h L_y}{2} d\\eta$。\n面力向量为：\n$$ \\mathbf{F}_t = \\int_{\\Gamma_t} \\mathbf{N}^{\\mathsf{T}} \\bar{\\mathbf{t}} \\, d\\Gamma = \\int_{-1}^{1} \\mathbf{N}(\\xi=1, \\eta)^{\\mathsf{T}} \\bar{\\mathbf{t}} \\, \\frac{h L_y}{2} d\\eta $$\n在边 $\\xi=1$ 上，形函数 $N_1$ 和 $N_4$ 恒为零。只有 $N_2$ 和 $N_3$ 有贡献。\n$N_2(1, \\eta) = \\frac{1}{2}(1-\\eta)$ 和 $N_3(1, \\eta) = \\frac{1}{2}(1+\\eta)$。\n对节点 $2$ 的力贡献为：\n$$ \\mathbf{F}_{2t} = \\left( \\int_{-1}^{1} N_2(1, \\eta) \\frac{h L_y}{2} d\\eta \\right) \\bar{\\mathbf{t}} = \\frac{h L_y}{2} \\left( \\int_{-1}^{1} \\frac{1}{2}(1-\\eta) d\\eta \\right) \\bar{\\mathbf{t}} = \\frac{h L_y}{4} [\\eta - \\frac{\\eta^2}{2}]_{-1}^{1} \\bar{\\mathbf{t}} = \\frac{h L_y}{4} (2) \\bar{\\mathbf{t}} = \\frac{h L_y}{2} \\bar{\\mathbf{t}} $$\n对节点 $3$ 的力贡献为：\n$$ \\mathbf{F}_{3t} = \\left( \\int_{-1}^{1} N_3(1, \\eta) \\frac{h L_y}{2} d\\eta \\right) \\bar{\\mathbf{t}} = \\frac{h L_y}{2} \\left( \\int_{-1}^{1} \\frac{1}{2}(1+\\eta) d\\eta \\right) \\bar{\\mathbf{t}} = \\frac{h L_y}{4} [\\eta + \\frac{\\eta^2}{2}]_{-1}^{1} \\bar{\\mathbf{t}} = \\frac{h L_y}{4} (2) \\bar{\\mathbf{t}} = \\frac{h L_y}{2} \\bar{\\mathbf{t}} $$\n节点 $1$ 和 $4$ 不受此边上面力的作用。这在物理上意味着总面力 $\\bar{\\mathbf{t}} (h L_y)$ 在该边上的两个节点之间均等分配。\n\n最后，我们将每个分量的体力和面力贡献相加，组集得到总节点力向量 $\\mathbf{F} = [F_{1x}, F_{1y}, \\dots, F_{4y}]^{\\mathsf{T}}$。\n\n$F_{1x} = F_{1bx} + F_{1tx} = \\frac{h L_x L_y}{4} b_x + 0 = \\frac{h L_x L_y}{4} b_x$\n$F_{1y} = F_{1by} + F_{1ty} = \\frac{h L_x L_y}{4} b_y + 0 = \\frac{h L_x L_y}{4} b_y$\n\n$F_{2x} = F_{2bx} + F_{2tx} = \\frac{h L_x L_y}{4} b_x + \\frac{h L_y}{2} \\bar{t}_x$\n$F_{2y} = F_{2by} + F_{2ty} = \\frac{h L_x L_y}{4} b_y + \\frac{h L_y}{2} \\bar{t}_y$\n\n$F_{3x} = F_{3bx} + F_{3tx} = \\frac{h L_x L_y}{4} b_x + \\frac{h L_y}{2} \\bar{t}_x$\n$F_{3y} = F_{3by} + F_{3ty} = \\frac{h L_x L_y}{4} b_y + \\frac{h L_y}{2} \\bar{t}_y$\n\n$F_{4x} = F_{4bx} + F_{4tx} = \\frac{h L_x L_y}{4} b_x + 0 = \\frac{h L_x L_y}{4} b_x$\n$F_{4y} = F_{4by} + F_{4ty} = \\frac{h L_x L_y}{4} b_y + 0 = \\frac{h L_x L_y}{4} b_y$\n\n这就构成了完整的八分量单元节点力向量。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{h L_x L_y}{4} b_x, & \\frac{h L_x L_y}{4} b_y, & \\frac{h L_x L_y}{4} b_x + \\frac{h L_y}{2} \\bar{t}_x, & \\frac{h L_x L_y}{4} b_y + \\frac{h L_y}{2} \\bar{t}_y, & \\frac{h L_x L_y}{4} b_x + \\frac{h L_y}{2} \\bar{t}_x, & \\frac{h L_x L_y}{4} b_y + \\frac{h L_y}{2} \\bar{t}_y, & \\frac{h L_x L_y}{4} b_x, & \\frac{h L_x L_y}{4} b_y\n\\end{pmatrix}^{\\mathsf{T}}\n}\n$$", "id": "2697388"}, {"introduction": "当完整的系统 $[K]\\{d\\} = \\{F\\}$ 建立起来后，人们可能认为任务已经完成。然而，实际的计算实现常常会暴露出一些数值伪影，这些伪影可能导致计算结果毫无意义。本节的最后一个实践练习将探讨其中一个典型问题——“沙漏现象”，它通常由单元刚度矩阵的减缩积分引起。通过这个练习，你不仅能学会识别这些非物理的零能模式，还将掌握一种变分一致的稳定化方法，以抑制这些不稳定性，从而确保有限元解的准确性和可靠性。 [@problem_id:2697340]", "problem": "考虑有界域 $\\Omega \\subset \\mathbb{R}^{2}$ 上的小应变、静态、线性弹性问题，其体力为 $\\mathbf{b}$，在 $\\Gamma_{t}$ 上的面力为 $\\bar{\\mathbf{t}}$，在 $\\Gamma_{u}$ 上的位移为 $\\bar{\\mathbf{u}}$，其中 $\\Gamma_{u} \\cup \\Gamma_{t} = \\partial \\Omega$ 且 $\\Gamma_{u} \\cap \\Gamma_{t} = \\emptyset$。其强形式为 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{b} = \\mathbf{0}$ 在 $\\Omega$ 内，其中 $\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\mathbf{u})$，$\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{T}\\right)$，而 $\\mathbb{C}$ 是具有Lamé参数 $\\lambda$ 和 $\\mu$ 的四阶弹性张量。相应的Galerkin弱形式寻求 $\\mathbf{u} \\in \\mathcal{V}$，使得对于所有 $\\mathbf{v} \\in \\mathcal{V}_{0}$，\n$$\na(\\mathbf{u},\\mathbf{v}) = \\ell(\\mathbf{v}), \\quad a(\\mathbf{u},\\mathbf{v}) = \\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\mathbf{v}) : \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\mathbf{u}) \\, \\mathrm{d}\\Omega, \\quad \\ell(\\mathbf{v}) = \\int_{\\Omega} \\mathbf{v} \\cdot \\mathbf{b} \\, \\mathrm{d}\\Omega + \\int_{\\Gamma_{t}} \\mathbf{v} \\cdot \\bar{\\mathbf{t}} \\, \\mathrm{d}\\Gamma.\n$$\n使用双线性四边形 $Q1$ 单元离散化 $\\Omega$，并利用从 $Q1$ 形函数构建的常规有限维子空间来近似 $\\mathbf{u}$ 和 $\\mathbf{v}$。考虑一个边长为 $h$ 的单一、轴对齐的方形单元，节点从左下角开始逆时针编号为 $1,2,3,4$。假设对内虚功在单元中心采用单点高斯法则（减缩积分）。\n\n仅使用上述基本定律和定义：\n\n- 解释单点高斯法则如何将单元双线性形式变为秩亏的代数形式，从而在 $Q1$ 单元中引入零能模式（沙漏模式）。确定单元级零能子空间的维度，并指出其中有多少模式是非刚体沙漏模式。\n- 展示至少一个明确的节点位移模式 $\\mathbf{u}_{e}$（用节点 $1,2,3,4$ 的节点值表示），该模式在单点法则下，在单元的高斯点处产生零应变，并简要说明为什么它对于减缩积分单元是一个零能模式。\n- 从以下选项中选择一种稳定化方法，该方法既能抑制这些沙漏模式，又能在变分正确性意义上保持正确性，即它源于对双线性形式的对称、相容的修正，且不会污染常应变片检验。\n\n选项：\nA. 在离散双线性形式上增加单元脉动罚项\n$$\na_{s}(\\mathbf{u}_{h},\\mathbf{v}_{h}) = \\sum_{e} \\alpha_{e} \\int_{\\Omega_{e}} \\left(\\boldsymbol{\\varepsilon}(\\mathbf{v}_{h}) - \\Pi_{0}\\boldsymbol{\\varepsilon}(\\mathbf{v}_{h})\\right) : \\mathbb{C} : \\left(\\boldsymbol{\\varepsilon}(\\mathbf{u}_{h}) - \\Pi_{0}\\boldsymbol{\\varepsilon}(\\mathbf{u}_{h})\\right) \\, \\mathrm{d}\\Omega,\n$$\n其中 $\\Pi_{0}$ 是到单元常应变（例如，在单点高斯点处的值）的 $L^{2}$-正交投影，$\\alpha_{e} > 0$ 是一个与网格和材料相关的缩放参数。\n\nB. 在每个 $Q1$ 单元上，用完全的 $2 \\times 2$ 高斯法则替换单点法则来计算 $a(\\cdot,\\cdot)$。\n\nC. 增加一个基于对角线上节点差分的特设沙漏罚项，\n$$\nE_{\\mathrm{hg}} = \\sum_{e} \\beta \\left[\\left\\|\\mathbf{u}_1 - \\mathbf{u}_3\\right\\|^{2} + \\left\\|\\mathbf{u}_2 - \\mathbf{u}_4\\right\\|^{2}\\right],\n$$\n其中 $\\beta > 0$ 是用户选择的参数，并通过相容线性化获得附加刚度。\n\nD. 增加一个基于残差的平衡稳定化项\n$$\na_{s}^{\\mathrm{res}}(\\mathbf{u}_{h},\\mathbf{v}_{h}) = \\sum_{e} \\tau_{e} \\int_{\\Omega_{e}} \\left(\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{v}_{h})\\right) \\cdot \\left(\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u}_{h})\\right) \\, \\mathrm{d}\\Omega,\n$$\n其中 $\\tau_{e} > 0$。\n\n选择满足所述稳定化要求的唯一最佳选项。", "solution": "首先必须确定问题陈述的有效性。\n\n### 步骤1：提取已知条件\n- **问题类型**：小应变、静态、线性弹性。\n- **域**：有界域 $\\Omega \\subset \\mathbb{R}^{2}$，边界 $\\partial \\Omega = \\Gamma_u \\cup \\Gamma_t$ 且 $\\Gamma_u \\cap \\Gamma_t = \\emptyset$。\n- **控制方程（强形式）**：在 $\\Omega$ 内 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{b} = \\mathbf{0}$。\n- **本构定律**：$\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\mathbf{u})$，其中 $\\mathbb{C}$ 是四阶弹性张量（Lamé参数 $\\lambda, \\mu$）。\n- **应变-位移关系**：$\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{T}\\right)$。\n- **边界条件**：在 $\\Gamma_u$ 上给定-位移 $\\mathbf{u} = \\bar{\\mathbf{u}}$；在 $\\Gamma_t$ 上给定面力 $\\boldsymbol{\\sigma} \\cdot \\mathbf{n} = \\bar{\\mathbf{t}}$。\n- **Galerkin弱形式**：求解 $\\mathbf{u} \\in \\mathcal{V}$，使得对于所有 $\\mathbf{v} \\in \\mathcal{V}_{0}$，$a(\\mathbf{u},\\mathbf{v}) = \\ell(\\mathbf{v})$。\n- **双线性形式**：$a(\\mathbf{u},\\mathbf{v}) = \\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\mathbf{v}) : \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\mathbf{u}) \\, \\mathrm{d}\\Omega$。\n- **线性泛函**：$\\ell(\\mathbf{v}) = \\int_{\\Omega} \\mathbf{v} \\cdot \\mathbf{b} \\, \\mathrm{d}\\Omega + \\int_{\\Gamma_{t}} \\mathbf{v} \\cdot \\bar{\\mathbf{t}} \\, \\mathrm{d}\\Gamma$。\n- **离散化**：双线性四边形（$Q1$）单元。\n- **数值积分**：对内虚功（即双线性形式 $a(\\cdot,\\cdot)$）在单元中心采用单点高斯求积。\n- **单元几何**：一个边长为 $h$ 的单一、轴对齐的方形单元，节点从左下角开始逆时针编号为 $1,2,3,4$。\n- **要求任务**：\n    1. 解释由单点积分引起的秩亏和零能模式的出现。\n    2. 确定零能子空间的维度以及非刚体沙漏模式的数量。\n    3. 给出一个非刚体零能模式的显式节点位移模式。\n    4. 从给定选项中选择一种稳定化方法，该方法能抑制沙漏模式，是对称、相容的，并通过常应变片检验。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学上成立**：该问题是有限元法（FEM）理论应用于固体力学的一个标准、典型问题。所有概念——线性弹性、Galerkin方法、Q1单元、数值求积和沙漏不稳定性——都是计算力学中的基本且公认的概念。\n- **良定的**：问题陈述清晰，要求对一个已知的数值现象进行分析，并对标准补救措施进行评估。任务具体，能得出确定且可推导的结论。\n- **客观的**：问题以精确的数学和工程语言表述，没有主观性或含糊不清之处。\n\n问题陈述在科学或事实上没有不健全之处，是可形式化且相关的，是完整且一致的，在数值分析的背景下是现实的，是良定的，并且是对有限元法基本概念的非平凡检验。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。将推导解答。\n\n---\n\n### 推导与分析\n\n在评估选项之前，我们首先处理问题陈述所要求的分析任务。\n\n**1. 秩亏和零能模式**\n\n一个二维双线性四边形（$Q1$）单元有4个节点，每个节点有2个自由度（DOF），总共有8个自由度。单元刚度矩阵 $\\mathbf{k}_e$ 是一个 $8 \\times 8$ 的矩阵。其元素由双线性形式计算得出，离散化后变为 $\\mathbf{d}_v^T \\mathbf{k}_e \\mathbf{d}_u$，其中 $\\mathbf{d}$ 是节点位移向量。刚度矩阵由 $\\mathbf{k}_e = \\int_{\\Omega_e} \\mathbf{B}^T \\mathbf{D} \\mathbf{B} \\, \\mathrm{d}\\Omega$ 给出，其中 $\\mathbf{B}$ 是二维平面应力/应变中的 $3 \\times 8$ 应变-位移矩阵，$\\mathbf{D}$ 是 $3 \\times 3$ 的材料矩阵。\n\n使用单点高斯法则将此积分近似为：\n$$ \\mathbf{k}_{e}^{1pt} = \\left(\\mathbf{B}(\\boldsymbol{\\xi}_c)\\right)^T \\mathbf{D} \\mathbf{B}(\\boldsymbol{\\xi}_c) \\cdot \\text{Area}(\\Omega_e) $$\n其中 $\\boldsymbol{\\xi}_c$ 是参考坐标系中单元的中心，并假设 $\\mathbf{D}$ 在单元上是常数。$\\mathbf{k}_{e}^{1pt}$ 的秩由矩阵 $\\mathbf{B}(\\boldsymbol{\\xi}_c)$ 的秩决定，因为 $\\mathbf{D}$ 是满秩的（秩为3）。\n\n矩阵 $\\mathbf{B}$ 将应变向量 $\\boldsymbol{\\varepsilon} = (\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy})^T$ 与节点位移向量 $\\mathbf{d}_e$ 联系起来。$\\mathbf{B}$ 的元素取决于形函数的空间导数。对于 $Q1$ 单元，位移场分量是双线性的，例如 $u_x(x,y) = c_1 + c_2 x + c_3 y + c_4 xy$。因此，应变分量是线性的，例如 $\\varepsilon_{xx} = \\partial u_x / \\partial x = c_2 + c_4 y$。\n\n当 $\\mathbf{B}$ 在一个轴对齐单元的单一点 $\\boldsymbol{\\xi}_c = (0,0)$ 处求值时，它变成一个常数矩阵。可以发现 $\\mathbf{B}(\\boldsymbol{\\xi}_c)$ 的秩为3。因此，$8 \\times 8$ 矩阵 $\\mathbf{k}_{e}^{1pt}$ 的秩也为3。\n\n一个满秩的 $8 \\times 8$ 矩阵的秩为8。秩亏为 $\\mathrm{dim}(\\mathrm{ker}(\\mathbf{k}_{e}^{1pt})) = 8 - \\mathrm{rank}(\\mathbf{k}_{e}^{1pt}) = 8 - 3 = 5$。这意味着存在一个5维的节点位移向量 $\\mathbf{d}_e$ 子空间，对于这个子空间，由单点法则计算的应变能为零：$\\frac{1}{2} \\mathbf{d}_e^T \\mathbf{k}_{e}^{1pt} \\mathbf{d}_e = 0$。这些就是**零能模式**。\n\n在二维情况下，任何单元都必须允许3种刚体模式（两次平移，一次旋转），这些模式不产生应变，因此没有应变能。这些是物理上必须存在的。剩下的 $5 - 3 = 2$ 个零能模式是伪的、非物理的变形模式，称为**沙漏模式**。它们对应于在单元中心产生零应变但在其他地方产生非零应变的变形。\n\n**2. 显式沙漏模式**\n\n我们寻求一个节点位移向量 $\\mathbf{d}_e = (u_{x1}, u_{y1}, u_{x2}, u_{y2}, u_{x3}, u_{y3}, u_{x4}, u_{y4})^T$，它是一个非刚体模式，并且满足 $\\boldsymbol{\\varepsilon}(\\mathbf{u}_h)|_{\\boldsymbol{\\xi}_c} = \\mathbf{0}$。节点坐标为（对于 $h=2$，在参考空间中）：$1(-1,-1)$, $2(1,-1)$, $3(1,1)$, $4(-1,1)$。一个典型的沙漏位移模式与局部坐标的乘积 $\\xi\\eta$ 成正比。让我们定义一个由节点位移模式产生的位移场 $\\mathbf{u}_h$：\n$$ \\mathbf{u}_1 = (c, 0), \\quad \\mathbf{u}_2 = (-c, 0), \\quad \\mathbf{u}_3 = (c, 0), \\quad \\mathbf{u}_4 = (-c, 0) $$\n对于某个常数 $c \\ne 0$。这对应于节点向量 $\\mathbf{d}_e = (c, 0, -c, 0, c, 0, -c, 0)^T$。插值位移场为 $u_x(x,y) \\propto xy$ 和 $u_y(x,y) = 0$。应变分量为：\n$$ \\varepsilon_{xx}(\\mathbf{u}_h) = \\frac{\\partial u_x}{\\partial x} \\propto y, \\quad \\varepsilon_{yy}(\\mathbf{u}_h) = \\frac{\\partial u_y}{\\partial y} = 0, \\quad \\gamma_{xy}(\\mathbf{u}_h) = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} \\propto x $$\n在单元中心 $(x,y)=(0,0)$，所有应变分量均为零。因此，$\\boldsymbol{\\varepsilon}(\\mathbf{u}_h)|_{\\boldsymbol{\\xi}_c} = \\mathbf{0}$，并且该模式在单点法则下具有零能量。此模式是一种非刚体变形（一个“领结”形状），因为节点之间的距离发生了变化。这是一个经典的沙漏模式。\n\n**3. 稳定化方案评估**\n\n稳定化方法必须抑制这些模式，源于对称且相容的修正，并通过常应变片检验。\n\n**选项A：** 此方法添加了一个基于应变从其单元常数部分 $\\boldsymbol{\\varepsilon}_h - \\Pi_0\\boldsymbol{\\varepsilon}_h$ 的脉动的罚项。常数部分 $\\Pi_0\\boldsymbol{\\varepsilon}_h$ 是应变在单元上常数张量空间上的 $L^2$ 正交投影，对于矩形域上的Q1单元，这对应于在中心点 $\\boldsymbol{\\xi}_c$ 处评估的应变 $\\boldsymbol{\\varepsilon}_h(\\boldsymbol{\\xi}_c)$。\n- **抑制沙漏模式**：对于沙漏模式 $\\mathbf{u}_{hg}$，根据定义我们有 $\\boldsymbol{\\varepsilon}_h(\\boldsymbol{\\xi}_c) = \\mathbf{0}$。脉动项 $\\boldsymbol{\\varepsilon}_h - \\Pi_0\\boldsymbol{\\varepsilon}_h$ 就变成了 $\\boldsymbol{\\varepsilon}_h$。由于沙漏模式是一种真实的变形，其应变场 $\\boldsymbol{\\varepsilon}_h$ 在单元上并非恒为零。因此，稳定化项 $\\int_{\\Omega_e} \\boldsymbol{\\varepsilon}_h : \\mathbb{C} : \\boldsymbol{\\varepsilon}_h \\mathrm{d}\\Omega$ 为正，增加了惩罚该模式所必需的刚度。**此方法有效。**\n- **变分正确性**：添加的双线性形式通过构造是**对称的**。\n- **片检验**：对于常应变状态，位移场 $\\mathbf{u}_h$ 是线性的。产生的应变场 $\\boldsymbol{\\varepsilon}(\\mathbf{u}_h)$ 在单元上是常数。对于一个常数场，其投影 $\\Pi_0\\boldsymbol{\\varepsilon}(\\mathbf{u}_h)$ 就是该场本身。因此，脉动项 $\\boldsymbol{\\varepsilon}(\\mathbf{u}_h) - \\Pi_0\\boldsymbol{\\varepsilon}(\\mathbf{u}_h)$ 恒为零，稳定化项消失。**该方法通过了常应变片检验。**\n此选项代表了来自变分多尺度（VMS）方法的一种公认的、理论上健全的方法。它被设计为相容的，并专门针对由减缩积分引起的不稳定性。\n\n**选项B：** 此选项用完全的 $2 \\times 2$ 高斯求积代替单点法则。\n- **抑制沙漏模式**：$2 \\times 2$ 求积足以精确地积分矩形Q1单元的刚度矩阵。得到的刚度矩阵 $\\mathbf{k}_e$ 具有正确的秩 $8 - 3 = 5$，其零空间仅包含3个物理刚体模式。沙漏模式不再是零能模式。**此方法有效。**\n- **变分正确性**：完全积分是对该单元定义的弱形式的“精确”计算，因此在变分上是正确的。\n- **片检验**：众所周知，完全积分的Q1单元能通过片检验。**此方法有效。**\n虽然此方法有效，但它通常被看作是对主要积分方案的改变，而不是对减缩积分方案的“稳定化”。选择减缩积分通常是为了计算效率或避免闭锁现象；像A这样的稳定化方法旨在保留这些好处的同时解决不稳定性问题。对于Q1单元的特定情况，当 $\\alpha_e=1$ 时，A中的稳定化在数学上等价于这种完全积分方案。然而，A代表了一个更普遍的稳定化原理。\n\n**选项C：** 此选项提出了一种基于单元对角线长度的*特设*罚项。\n- **抑制沙漏模式**：让我们测试前面找到的沙漏模式：$\\mathbf{u}_1=(c,0), \\mathbf{u}_3=(c,0) \\implies \\mathbf{u}_1-\\mathbf{u}_3 = \\mathbf{0}$。同样地，$\\mathbf{u}_2=(-c,0), \\mathbf{u}_4=(-c,0) \\implies \\mathbf{u}_2-\\mathbf{u}_4 = \\mathbf{0}$。对于这个沙漏模式，提议的罚能量 $E_{\\mathrm{hg}}$ 为零。它未能抑制该模式。**此方法无效。**\n- **变分正确性**：“特设”一词以及使用一个没有明确缩放规则的用户选择参数 $\\beta$，表明该方法可能缺乏形式上的相容性，并且对于一般四边形形状可能无法可靠地通过片检验。\n\n**选项D：** 此选项提出了一种基于残差的稳定化项，$a_{s}^{\\mathrm{res}} = \\sum \\tau_e \\int_{\\Omega_e} (\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{v}_h)) \\cdot (\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u}_h)) \\mathrm{d}\\Omega$。\n- **抑制沙漏模式**：对于沙漏模式，项 $\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u}_h)$ 在单元内部通常非零，因此该罚项会增加刚度。**此方法原则上有效。**\n- **变分正确性与片检验**：对于任何常应变状态，位移是线性的，应变是常数，应力 $\\boldsymbol{\\sigma}$ 是常数，因此 $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$。稳定化项为零，因此**通过了片检验**。该项也是对称的。\n- **缺陷**：存在一个关键缺陷。项 $\\nabla \\cdot \\boldsymbol{\\sigma}$ 涉及位移场 $\\mathbf{u}_h$ 的二阶导数。对于像Q1这样的标准 $C^0$ 连续有限元，二阶导数在单元边界上没有定义。虽然积分可以在每个单元内部计算，但该公式缺乏标准协调Galerkin框架所需的连续性。正确制定的基于残差的方法（如GLS/SUPG）更为复杂，通常还涉及检验函数，或者分别在单元内部和边界上定义。如其所述，该公式对于 $C^0$ 单元在理论上是有问题的。\n\n**结论**\n\n选项B是一个有效的解决方案，但它是一种暴力方法。选项C有缺陷。选项D在概念上与有效方法相关，但其表述方式对于Q1单元是有问题的。选项A描述了一种复杂的、通用的、理论上健全的稳定化方法，它正确地识别了不稳定的来源（求积法“看不见”的应变场的高频部分）并对其进行惩罚。它满足了正确性、相容性（在基本的片检验意义上）和对称性的所有标准。它代表了选项中“最佳”且最有原则的稳定化策略。", "answer": "$$\\boxed{A}$$", "id": "2697340"}]}