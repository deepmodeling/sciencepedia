{"hands_on_practices": [{"introduction": "本练习为实现径向返回算法提供了一个全面的蓝图。通过完整地走过单个积分点的整个计算序列——从弹性试探应力到最终应力状态和一致切线模量——您将巩固对该算法核心逻辑和数据流的理解。这个详细的练习对于在任何有限元代码中构建一个稳健且正确的材料子程序至关重要 [@problem_id:2678297]。", "problem": "考虑在小应变、关联 von Mises (J$2$) 各向同性硬化弹塑性的有限元 (FE) 计算中的单个材料积分点，该积分点通过后向欧拉径向返回映射进行隐式积分。材料具有线性弹性，其体积模量为 $\\kappa$，剪切模量为 $\\mu$，以及各向同性硬化屈服应力 $\\sigma_{y}(\\alpha)$，其切线模量为 $H' = d\\sigma_{y}/d\\alpha$。第 $n$ 步的状态包括 Cauchy 应力 $\\boldsymbol{\\sigma}_{n}$、塑性应变 $\\boldsymbol{\\varepsilon}^{p}_{n}$ 和等效塑性应变 $\\alpha_{n}$。在第 $n+1$ 步，输入为总应变增量 $\\Delta \\boldsymbol{\\varepsilon}$ 和当前温度下的材料参数。更新过程必须输出 Cauchy 应力 $\\boldsymbol{\\sigma}_{n+1}$ 和对称的算法一致性切线张量 $\\mathbb{C}_{n+1}$，以及更新后的内变量。假设为小应变运动学，并采用标准关联流动法则和适用于率无关塑性的 Kuhn–Tucker 条件。不存在额外的运动硬化。\n\n对于单个积分点上鲁棒的径向返回实现，哪个选项最准确、最完整地说明了正确顺序的算法序列、连接输入、状态和输出的数据依赖关系，以及需要防范的现实且常见的实现错误来源？\n\nA. 序列和依赖关系：\n- 输入：$\\Delta \\boldsymbol{\\varepsilon}$、$\\boldsymbol{\\sigma}_{n}$、$\\boldsymbol{\\varepsilon}^{p}_{n}$、$\\alpha_{n}$、$\\kappa$、$\\mu$、$\\sigma_{y}(\\cdot)$。\n- 计算弹性试探应力 $\\boldsymbol{\\sigma}_{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbb{C}^{e} : \\Delta \\boldsymbol{\\varepsilon}$，其中 $\\mathbb{C}^{e} = \\kappa \\mathbf{I} \\otimes \\mathbf{I} + 2\\mu \\mathbb{I}_{\\mathrm{dev}}$。\n- 使用 $f_{\\mathrm{tr}} = \\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert - \\sigma_{y}(\\alpha_{n})$ 检查屈服。\n- 如果 $f_{\\mathrm{tr}} \\le 0$，则设置 $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}}$、$\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n}$、$\\alpha_{n+1} = \\alpha_{n}$ 和 $\\mathbb{C}_{n+1} = \\mathbb{C}^{e}$。\n- 如果 $f_{\\mathrm{tr}}  0$，计算方向 $\\mathbf{n} = \\boldsymbol{\\sigma}_{\\mathrm{tr}}/\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert$ 和塑性乘子 $\\Delta \\gamma = f_{\\mathrm{tr}}/(2\\mu)$，修正应力 $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}} - 2\\mu \\Delta \\gamma \\mathbf{n}$，更新 $\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n} + \\Delta \\gamma \\mathbf{n}$ 和 $\\alpha_{n+1} = \\alpha_{n} + \\sqrt{2/3}\\,\\Delta \\gamma$，并设置 $\\mathbb{C}_{n+1} = \\mathbb{C}^{e}$。\n- 常见错误：由大的 $\\Delta \\boldsymbol{\\varepsilon}$ 引起的 Newton–Raphson 发散；范数计算中的浮点数下溢。\n\nB. 序列和依赖关系：\n- 输入：$\\Delta \\boldsymbol{\\varepsilon}$、$\\boldsymbol{\\sigma}_{n}$、$\\boldsymbol{\\varepsilon}^{p}_{n}$、$\\alpha_{n}$、材料参数 $\\kappa$、$\\mu$、硬化定律 $\\sigma_{y}(\\cdot)$ 及其切线 $H'(\\cdot)$，这些参数的取值与所选积分点状态一致。\n- 弹性预测步：通过对总增量的弹性响应并保持塑性应变不变来计算试探应力，$\\boldsymbol{\\sigma}_{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbb{C}^{e} : \\Delta \\boldsymbol{\\varepsilon}$，其中 $\\mathbb{C}^{e} = \\kappa \\mathbf{I} \\otimes \\mathbf{I} + 2\\mu \\mathbb{I}_{\\mathrm{dev}}$，$\\mathbb{I}_{\\mathrm{dev}} = \\mathbb{I}_{\\mathrm{s}} - \\tfrac{1}{3} \\mathbf{I} \\otimes \\mathbf{I}$ 且 $\\mathbb{I}_{\\mathrm{s}}$ 是四阶对称单位张量。提取偏试探应力 $\\mathbf{s}_{\\mathrm{tr}} = \\mathrm{dev}(\\boldsymbol{\\sigma}_{\\mathrm{tr}})$。\n- 基于偏应力范数的屈服检查：$f_{\\mathrm{tr}} = \\sqrt{3/2}\\,\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sigma_{y}(\\alpha_{n})$。\n- 如果 $f_{\\mathrm{tr}} \\le 0$，则为弹性步：接受试探状态，即 $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}}$、$\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n}$、$\\alpha_{n+1} = \\alpha_{n}$，并设置 $\\mathbb{C}_{n+1} = \\mathbb{C}^{e}$。\n- 如果 $f_{\\mathrm{tr}}  0$，则为塑性修正步：计算单位流动方向 $\\mathbf{n} = \\mathbf{s}_{\\mathrm{tr}}/\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert$ (共轴性)，并使用一致性线性化计算塑性乘子 $\\Delta \\gamma = f_{\\mathrm{tr}}/(3\\mu + H')$，其中 $H' = d\\sigma_{y}/d\\alpha$ 的取值是一致的（对于闭式解更新，通常在 $\\alpha_{n}$ 处取值；或在局部 Newton 迭代中，在 $\\alpha_{n+1}$ 处取值）。通过对偏量部分进行径向返回来更新应力，并保持静水压力部分为弹性：$\\mathbf{s}_{n+1} = \\mathbf{s}_{\\mathrm{tr}} - 2\\mu\\,\\Delta \\gamma\\,\\sqrt{3/2}\\,\\mathbf{n}$ 和 $p_{n+1} = p_{\\mathrm{tr}}$，因此 $\\boldsymbol{\\sigma}_{n+1} = p_{\\mathrm{tr}}\\mathbf{I} + \\mathbf{s}_{n+1}$。通过关联流动法则更新内变量：$\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\partial f/\\partial \\boldsymbol{\\sigma} = \\Delta \\gamma\\,\\sqrt{3/2}\\,\\mathbf{n}$，$\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n} + \\Delta \\boldsymbol{\\varepsilon}^{p}$，以及 $\\alpha_{n+1} = \\alpha_{n} + \\Delta \\gamma$。\n- 算法一致性切线张量：返回 $\\mathbb{C}_{n+1} = \\kappa \\mathbf{I} \\otimes \\mathbf{I} + 2\\mu\\left(\\mathbb{I}_{\\mathrm{dev}} - \\dfrac{2\\mu}{3\\mu + H'}\\,\\mathbf{n} \\otimes \\mathbf{n}\\right)$，它是对称的，并且仅在偏量空间中沿 $\\mathbf{n}$ 方向降低刚度；如果 $\\sigma_{y}$ 是非线性的，则使用 $H' = d\\sigma_{y}/d\\alpha$，其取值点与应力更新点一致。\n- 数据依赖关系：更新过程依赖于 $(\\Delta \\boldsymbol{\\varepsilon}, \\boldsymbol{\\sigma}_{n}, \\boldsymbol{\\varepsilon}^{p}_{n}, \\alpha_{n}, \\kappa, \\mu, \\sigma_{y}(\\cdot), H'(\\cdot))$；塑性分支进一步依赖于试探方向 $\\mathbf{n}$ 和 $H'$，而切线张量依赖于在所选评估状态下的 $\\mathbf{n}$ 和 $H'$。\n- 常见实现错误：在 $f_{\\mathrm{tr}}$ 中使用 $\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert$ 而不是 $\\lVert \\mathrm{dev}(\\boldsymbol{\\sigma}_{\\mathrm{tr}}) \\rVert$；在构造 $\\mathbf{n}$ 时忘记对 $\\mathbf{s}_{\\mathrm{tr}}$ 进行归一化；在塑性修正期间错误地修改了静水应力（违反了塑性不可压缩性）；由于省略了投影算子 $\\mathbf{n} \\otimes \\mathbf{n}$ 而导致 $\\mathbb{C}_{n+1}$ 不一致或不对称；对于非线性硬化，在错误的状态下计算 $H'$；未能鲁棒地处理 $\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert \\approx 0$ 或非常小的 $f_{\\mathrm{tr}}$ 的情况；混用 $\\boldsymbol{\\varepsilon}^{p}$ 或 $\\alpha$ 的总量和增量；返回割线切线张量而非一致性切线张量；在适用时忽略 $\\kappa$、$\\mu$ 或 $\\sigma_{y}$ 的温度或率相关性；如果对 $\\Delta \\gamma$ 使用 Newton 迭代，则局部求解中的容差不足，或对于非常大的 $\\Delta \\boldsymbol{\\varepsilon}$ 缺乏子步长法。\n\nC. 序列和依赖关系：\n- 输入：$\\Delta \\boldsymbol{\\varepsilon}$、$\\boldsymbol{\\sigma}_{n}$、$\\boldsymbol{\\varepsilon}^{p}_{n}$、$\\alpha_{n}$、$\\kappa$、$\\mu$、$\\sigma_{y}(\\cdot)$。\n- 像在弹性预测步中一样计算 $\\boldsymbol{\\sigma}_{\\mathrm{tr}}$ 和 $f_{\\mathrm{tr}}$，但将屈服函数替换为 $f_{\\mathrm{tr}} = \\sqrt{3}\\,\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert - \\sigma_{y}(\\alpha_{n})$。\n- 如果 $f_{\\mathrm{tr}}  0$，通过对 $g(\\Delta \\gamma) = \\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} - 2\\mu \\Delta \\gamma \\mathbf{n} \\rVert - \\sigma_{y}(\\alpha_{n})$ 进行 Newton 迭代求解 $\\Delta \\gamma$，初始猜测为 $\\Delta \\gamma = f_{\\mathrm{tr}}/\\mu$；首先通过 $\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n} + \\Delta \\gamma \\mathbf{n}$ 更新塑性应变，然后从总应变弹性地重新计算应力；设置 $\\alpha_{n+1} = \\alpha_{n} + \\Delta \\gamma$ 并将静水应力减小与偏应力修正相同的量；返回从 $\\Delta \\boldsymbol{\\sigma}/\\Delta \\boldsymbol{\\varepsilon}$ 计算的对称割线切线张量。\n- 常见错误：Newton 求解收敛性差；$\\Delta \\gamma$ 的过冲；对时间步长选择的敏感性。\n\nD. 序列和依赖关系：\n- 输入：$\\Delta \\boldsymbol{\\varepsilon}$、$\\boldsymbol{\\sigma}_{n}$、$\\boldsymbol{\\varepsilon}^{p}_{n}$、$\\alpha_{n}$、$\\kappa$、$\\mu$、$\\sigma_{y}(\\cdot)$。\n- 使用一个客观应力率 (Jaumann 率) 来旋转 $\\boldsymbol{\\sigma}_{n}$，然后计算试探应力；对于塑性，从 $\\boldsymbol{\\sigma}_{n+1}$ 计算 $\\mathbf{n}$ 并设置 $\\Delta \\gamma = \\left(\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert - \\sigma_{y}(\\alpha_{n+1})\\right)/(3\\mu)$；通过相同的塑性修正来更新静水应力和偏应力；从 $\\Delta \\boldsymbol{\\varepsilon}^{p}$ 的迹更新 $\\alpha_{n+1}$；返回 $\\mathbb{C}_{n+1} = \\mathbb{C}^{e}$ 以保持对称性。\n- 常见错误：忽略协同旋转效应；主方向未对齐；在屈服面角点附近 $\\mathbf{n}$ 的非唯一性。\n\n选择一个选项。", "solution": "我们从具有各向同性硬化的小应变关联 von Mises (J$2$) 塑性以及后向欧拉时间离散化的基本原理出发，推导算法序列、数据依赖关系和一致性切线张量。目标是以一种热力学上一致且数值上鲁棒的方式，将单个积分点的输入映射到更新后的应力和算法切线张量。\n\n基本本构结构。在具有线性弹性的小应变弹塑性中，Cauchy 应力为\n$$\n\\boldsymbol{\\sigma} = \\kappa\\,\\mathrm{tr}\\!\\left(\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{p}\\right)\\mathbf{I} + 2\\mu\\,\\mathrm{dev}\\!\\left(\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{p}\\right),\n$$\n其中 $\\boldsymbol{\\varepsilon}$ 是总应变，$\\boldsymbol{\\varepsilon}^{p}$ 是塑性应变，$\\kappa$ 是体积模量，$\\mu$ 是剪切模量，$\\mathbf{I}$ 是二阶单位张量，$\\mathrm{dev}(\\cdot)$ 表示偏量部分。定义偏应力 $\\mathbf{s} = \\mathrm{dev}(\\boldsymbol{\\sigma})$ 和静水压力 $p = \\tfrac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})$。von Mises 等效应力为 $\\sigma_{\\mathrm{eq}} = \\sqrt{3/2}\\,\\lVert \\mathbf{s} \\rVert$，带有各向同性硬化的屈服函数为\n$$\nf(\\boldsymbol{\\sigma}, \\alpha) = \\sigma_{\\mathrm{eq}} - \\sigma_{y}(\\alpha) \\le 0.\n$$\n关联流动和硬化法则表示为\n$$\n\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\Delta \\gamma\\,\\sqrt{\\tfrac{3}{2}}\\,\\mathbf{n}, \\quad \\mathbf{n} := \\frac{\\mathbf{s}}{\\lVert \\mathbf{s} \\rVert}, \\quad \\Delta \\alpha = \\sqrt{\\tfrac{2}{3}}\\lVert \\Delta \\boldsymbol{\\varepsilon}^{p} \\rVert = \\Delta \\gamma,\n$$\n其中 Kuhn–Tucker 条件为 $\\Delta \\gamma \\ge 0$，$f \\le 0$ 和 $\\Delta \\gamma\\,f = 0$。弹性刚度张量为 $\\mathbb{C}^{e} = \\kappa \\mathbf{I} \\otimes \\mathbf{I} + 2\\mu \\mathbb{I}_{\\mathrm{dev}}$，其中 $\\mathbb{I}_{\\mathrm{dev}} = \\mathbb{I}_{\\mathrm{s}} - \\tfrac{1}{3} \\mathbf{I} \\otimes \\mathbf{I}$ 且 $\\mathbb{I}_{\\mathrm{s}}$ 是四阶对称单位张量。\n\n径向返回映射。给定状态 $(\\boldsymbol{\\sigma}_{n}, \\boldsymbol{\\varepsilon}^{p}_{n}, \\alpha_{n})$ 和增量 $\\Delta \\boldsymbol{\\varepsilon}$，弹性预测步（试探状态）假设 $\\Delta \\boldsymbol{\\varepsilon}^{p} = \\mathbf{0}$：\n$$\n\\boldsymbol{\\sigma}_{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbb{C}^{e} : \\Delta \\boldsymbol{\\varepsilon}, \\qquad \\mathbf{s}_{\\mathrm{tr}} = \\mathrm{dev}(\\boldsymbol{\\sigma}_{\\mathrm{tr}}).\n$$\n计算试探屈服函数\n$$\nf_{\\mathrm{tr}} = \\sqrt{\\tfrac{3}{2}}\\,\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sigma_{y}(\\alpha_{n}).\n$$\n如果 $f_{\\mathrm{tr}} \\le 0$，则该步为弹性步：接受试探状态\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}}, \\quad \\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n}, \\quad \\alpha_{n+1} = \\alpha_{n}, \\quad \\mathbb{C}_{n+1} = \\mathbb{C}^{e}.\n$$\n如果 $f_{\\mathrm{tr}}  0$，则发生塑性加载。在各向同性和关联性假设下，修正量与偏试探应力共轴（共轴性）。定义单位方向\n$$\n\\mathbf{n} = \\frac{\\mathbf{s}_{\\mathrm{tr}}}{\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert}.\n$$\n对流动和硬化法则使用后向欧拉法，并强制 $f_{n+1} = 0$（一致性条件），偏应力更新为\n$$\n\\mathbf{s}_{n+1} = \\mathbf{s}_{\\mathrm{tr}} - 2\\mu\\,\\Delta \\gamma\\,\\sqrt{\\tfrac{3}{2}}\\,\\mathbf{n}, \\quad p_{n+1} = p_{\\mathrm{tr}},\n$$\n使得 $\\boldsymbol{\\sigma}_{n+1} = p_{\\mathrm{tr}} \\mathbf{I} + \\mathbf{s}_{n+1}$。更新后的内变量为\n$$\n\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n} + \\Delta \\gamma\\,\\sqrt{\\tfrac{3}{2}}\\,\\mathbf{n}, \\qquad \\alpha_{n+1} = \\alpha_{n} + \\Delta \\gamma.\n$$\n为了找到 $\\Delta \\gamma$，施加 $f_{n+1} = 0$ 条件，并对 $\\sigma_{y}(\\alpha_{n+1}) \\approx \\sigma_{y}(\\alpha_{n}) + H' \\Delta \\gamma$ 进行一阶线性化，其中 $H' = d\\sigma_{y}/d\\alpha$ 的取值是一致的。$n+1$ 步的等效应力等于\n$$\n\\sigma_{\\mathrm{eq},n+1} = \\sqrt{\\tfrac{3}{2}}\\,\\lVert \\mathbf{s}_{n+1} \\rVert = \\sqrt{\\tfrac{3}{2}}\\left(\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - 2\\mu\\,\\Delta \\gamma\\,\\sqrt{\\tfrac{3}{2}}\\right) = \\sqrt{\\tfrac{3}{2}}\\,\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - 3\\mu\\,\\Delta \\gamma.\n$$\n一致性条件 $f_{n+1} = \\sigma_{\\mathrm{eq},n+1} - \\sigma_{y}(\\alpha_{n+1}) = 0$ 给出\n$$\n0 = \\underbrace{\\left(\\sqrt{\\tfrac{3}{2}}\\,\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sigma_{y}(\\alpha_{n})\\right)}_{f_{\\mathrm{tr}}} - (3\\mu + H')\\,\\Delta \\gamma \\quad \\Rightarrow \\quad \\Delta \\gamma = \\frac{f_{\\mathrm{tr}}}{3\\mu + H'}.\n$$\n这是各向同性硬化径向返回算法的标志性闭式解；对于非线性的 $\\sigma_{y}(\\cdot)$，也可以对 $f_{n+1} = 0$ 采用标量 Newton 法求解 $\\Delta \\gamma$，同时保持相同的结构。\n\n算法一致性切线张量。将应力更新对总应变求导。静水压力部分保持弹性，贡献项为 $\\kappa \\mathbf{I} \\otimes \\mathbf{I}$。在偏量子空间中，使用由共轴性固定的 $\\mathbf{n}$，并通过一致性线性化考虑 $\\mathrm{d}\\Delta \\gamma$，可以得到著名的对称算法切线张量\n$\n\\mathbb{C}_{n+1} = \\kappa \\mathbf{I} \\otimes \\mathbf{I} + 2\\mu\\left(\\mathbb{I}_{\\mathrm{dev}} - \\dfrac{2\\mu}{3\\mu + H'}\\,\\mathbf{n} \\otimes \\mathbf{n}\\right).\n$\n这种形式仅沿活动流动方向 $\\mathbf{n}$ 将剪切刚度降低了，保持了体积弹性，并且是对称的。如果硬化模量依赖于 $\\alpha$，$H' = d\\sigma_{y}/d\\alpha$ 的取值应与应力更新点一致，以保证全局 Newton 方法的二次收敛性。\n\n数据依赖关系。更新需要应变增量 $\\Delta \\boldsymbol{\\varepsilon}$、先前的状态 $(\\boldsymbol{\\sigma}_{n}, \\boldsymbol{\\varepsilon}^{p}_{n}, \\alpha_{n})$、弹性模量 $(\\kappa, \\mu)$ 以及硬化定律 $\\sigma_{y}(\\cdot)$ 及其切线 $H'(\\cdot)$。在塑性分支上，方向 $\\mathbf{n}$ 和标量 $\\Delta \\gamma$ 从试探状态计算得出；一致性切线张量显式地依赖于 $\\mathbf{n}$ 和 $H'$。\n\n常见的错误来源。典型的错误有：在屈服检查中使用了范数 $\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert$ 而不是 $\\lVert \\mathrm{dev}(\\boldsymbol{\\sigma}_{\\mathrm{tr}}) \\rVert$；在构造 $\\mathbf{n}$ 时未能对 $\\mathbf{s}_{\\mathrm{tr}}$ 进行归一化；在塑性修正期间错误地修改了静水应力（违反了塑性不可压缩性）；由于省略了投影算子 $\\mathbf{n} \\otimes \\mathbf{n}$ 而返回了不一致或不对称的切线张量；对于非线性硬化，在不一致的状态下计算 $H'$；未能鲁棒地处理 $\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert \\approx 0$ 或非常小的 $f_{\\mathrm{tr}}$；混用 $\\boldsymbol{\\varepsilon}^{p}$ 或 $\\alpha$ 的总量与增量；返回割线切线张量而非一致性切线张量；在适用时忽略温度或率相关性；对于非常大的 $\\Delta \\boldsymbol{\\varepsilon}$，若使用 Newton 迭代求解 $\\Delta \\gamma$ 则容差不足或缺乏子步长法。\n\n逐项分析。\n\n- 选项 A：不正确。它在屈服检查中使用了全应力范数 $\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert$，而不是偏应力范数 $\\sqrt{3/2}\\,\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert$。塑性流动方向 $\\mathbf{n}$ 取自总应力，且流动大小的计算省略了因子 $\\sqrt{3/2}$，破坏了与 von Mises 度量的一致性。硬化增量 $\\alpha_{n+1} = \\alpha_{n} + \\sqrt{2/3}\\,\\Delta \\gamma$ 与 $\\Delta \\alpha = \\Delta \\gamma$ 的标准归一化不一致。它还在塑性情况下返回 $\\mathbb{C}^{e}$，这不是算法一致性切线张量，会损害全局 Newton 法的收敛性。所列出的错误不完整，没有突出上面提到的基本陷阱。\n\n- 选项 B：正确。它一致地指定了输入和状态，执行弹性预测步，使用正确的 $\\sqrt{3/2}$ 因子对偏应力范数进行屈服检查，区分弹性和塑性分支，沿归一化的偏试探方向应用塑性修正，保持静水应力为弹性（塑性不可压缩性），根据关联流动法则和确保 $\\Delta \\alpha = \\Delta \\gamma$ 的归一化更新 $\\boldsymbol{\\varepsilon}^{p}$ 和 $\\alpha$，并提供了对称的算法一致性切线张量。它还正确地指出了对 $H'$ 和 $\\mathbf{n}$ 的依赖性，并列举了现实的实现错误。\n\n- 选项 C：不正确。它用 $\\sqrt{3}\\,\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert$ 定义了屈服检查，错误地缩放了等效应力并使用了总应力范数。初始猜测 $\\Delta \\gamma = f_{\\mathrm{tr}}/\\mu$ 忽略了硬化和正确的因子，并且塑性更新在更新塑性应变后从总应变纯弹性地重新计算应力，这不是径向返回的形式。它在塑性修正过程中错误地减小了静水应力，违反了塑性不可压缩性，并返回了割线切线张量，而不是二次全局收敛所需的一致性切线张量。\n\n- 选项 D：不正确。在没有有限旋转的小应变设置中，引入客观应力率 (Jaumann) 和应力旋转是不必要且不正确的。它用一个不一致的分母计算 $\\Delta \\gamma$，并在 $\\alpha_{n+1}$ 被一致地确定之前就在屈服应力中使用了它。它还将塑性修正同时应用于静水压力和偏量部分，违反了塑性不可压缩性，并在塑性情况下返回 $\\mathbb{C}^{e}$，这是不一致的。所列出的错误来源并非此算法背景下的主要问题。\n\n因此，只有选项 B 满足了正确的序列、依赖关系和错误识别。", "answer": "$$\\boxed{B}$$", "id": "2678297"}, {"introduction": "正确的理论理解只是成功的一半，验证您的代码同样重要。本练习将指导您为径向返回算法的实现设计一套最简但功能强大的单元测试。通过将您的代码输出与单轴拉伸和纯剪切等典型加载路径的解析解进行比较，您可以对您实现方案的准确性和稳健性建立信心 [@problem_id:2678252]。", "problem": "一个采用应力空间中偏应力径向回归映射算法实现的小应变各向同性弹塑性本构模型，该模型具有 von Mises (J2) 屈服准则和线性各向同性硬化。材料参数为：杨氏模量 $E = 210\\,\\mathrm{GPa}$，泊松比 $\\nu = 0.3$，初始屈服应力 $\\sigma_{y0} = 250\\,\\mathrm{MPa}$，以及线性各向同性硬化模量 $H = 1\\,\\mathrm{GPa}$。初始状态为无应力，塑性应变和硬化变量均为零。请您根据第一性原理，设计一个最小且充分的单元测试套件，用于验证在以下典型加载情况下径向回归映射的应力更新和内变量更新：单轴拉伸、纯剪切和平面应力下的等双轴面内加载。测试必须指明加载条件、试探弹性响应、屈服检查、精确的塑性修正和预期的闭式解更新应力，以及至少一项能够区分正确与不正确实现的算法切线模量或不变性检查。\n\n哪个选项提出了这样一套正确且完全自洽的单元测试及其预期的闭式解响应？\n\nA. 单轴拉伸：施加总轴向应变 $\\varepsilon_{11} = 0.003$，所有其他应变分量为零。弹性预测器给出的试探轴向应力为 $\\sigma^{\\mathrm{tr}} = E\\,\\varepsilon_{11} = 0.630\\,\\mathrm{GPa}$，试探等效应力为 $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = 0.630\\,\\mathrm{GPa}$。剪切模量 $G = \\dfrac{E}{2(1+\\nu)} = 80.769\\,\\mathrm{GPa}$，且 $3G + H = 243.307\\,\\mathrm{GPa}$，则试探屈服函数为 $f^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_{y0} = 0.380\\,\\mathrm{GPa}  0$，因此发生塑性修正。采用线性硬化的径向回归给出塑性乘子增量 $\\Delta \\gamma = \\dfrac{f^{\\mathrm{tr}}}{3G + H} = 0.0015619$ 和更新后的等效应力 $\\sigma_{\\mathrm{eq}}^{n+1} = \\sigma_{y0} + H\\,\\Delta \\gamma = 0.2515619\\,\\mathrm{GPa}$。因为状态是单轴的，所以更新后的轴向应力为 $\\sigma_{11}^{n+1} = 0.251562\\,\\mathrm{GPa}$。单调塑性流动下的斜率检查给出的单轴弹塑性切线模量为 $E_{\\mathrm{ep}} = \\dfrac{E\\,H}{E + H} = 0.99526\\,\\mathrm{GPa}$。纯剪切：施加工程剪应变 $\\gamma_{12} = 0.01$（因此小应变张量分量为 $\\varepsilon_{12} = \\gamma_{12}/2$）。弹性预测器产生 $\\tau^{\\mathrm{tr}} = G\\,\\gamma_{12} = 0.80769\\,\\mathrm{GPa}$ 和 $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{3}\\,\\tau^{\\mathrm{tr}} = 1.3987\\,\\mathrm{GPa}$。然后 $f^{\\mathrm{tr}} = 1.1487\\,\\mathrm{GPa}$，$\\Delta \\gamma = \\dfrac{1.1487}{243.307} = 0.0047219$，$\\sigma_{\\mathrm{eq}}^{n+1} = 0.250 + 0.0047219 = 0.2547219\\,\\mathrm{GPa}$，以及 $\\tau^{n+1} = \\sigma_{\\mathrm{eq}}^{n+1}/\\sqrt{3} = 0.147054\\,\\mathrm{GPa}$。偏应力方向与试探剪切方向保持一致，且静水应力保持为零。平面应力下的等双轴面内加载：施加相等的面内应变 $\\varepsilon_{11} = \\varepsilon_{22} = 0.0015$，并强制平面应力 $\\sigma_{33} = 0$。弹性平面应力预测器给出的两个面内方向应力均为 $\\sigma^{\\mathrm{tr}} = \\dfrac{E}{1-\\nu}\\,\\varepsilon_{11} = 0.450\\,\\mathrm{GPa}$，且 $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sigma^{\\mathrm{tr}} = 0.450\\,\\mathrm{GPa}$。然后 $f^{\\mathrm{tr}} = 0.200\\,\\mathrm{GPa}$，$\\Delta \\gamma = \\dfrac{0.200}{243.307} = 0.00082234$，以及 $\\sigma_{\\mathrm{eq}}^{n+1} = 0.25082234\\,\\mathrm{GPa}$。对于平面应力等双轴状态，$\\sigma_{\\mathrm{eq}} = \\sigma$，因此 $\\sigma_{11}^{n+1} = \\sigma_{22}^{n+1} = 0.250822\\,\\mathrm{GPa}$ 且 $\\sigma_{33}^{n+1} = 0$。在所有三个测试中，等效塑性应变增量等于 $\\Delta \\gamma$，这必须通过内变量更新来验证。\n\nB. 单轴拉伸：施加 $\\varepsilon_{11} = 0.003$；使用塑性乘子增量 $\\Delta \\gamma = \\dfrac{f^{\\mathrm{tr}}}{2G + H}$，因此 $\\Delta \\gamma = \\dfrac{0.380}{163.538} = 0.002324$ 且 $\\sigma_{11}^{n+1} = 0.252324\\,\\mathrm{GPa}$。屈服后斜率取为 $E_{\\mathrm{ep}} = H$。纯剪切：在 $\\tau_{y} = \\sigma_{y0}/2 = 125\\,\\mathrm{MPa}$ 时取 von Mises 剪切屈服，并使用 $\\sigma_{\\mathrm{eq}} = 2\\,\\tau$ 进行回归映射，对于 $\\gamma_{12} = 0.01$ 给出修正后的 $\\tau^{n+1} = 0.125\\,\\mathrm{GPa}$。等双轴面内加载：对于平面应力下的 $\\varepsilon_{11} = \\varepsilon_{22} = 0.0015$，假设 $\\sigma_{\\mathrm{eq}} = \\sqrt{2}\\,\\sigma$，因此回归后的修正面内应力为 $\\sigma_{11}^{n+1} = \\sigma_{22}^{n+1} = \\sigma_{\\mathrm{eq}}^{n+1}/\\sqrt{2} = 0.1773\\,\\mathrm{GPa}$。\n\nC. 单轴拉伸：施加 $\\varepsilon_{11} = 0.003$，并在屈服后通过分段双线性关系 $\\sigma_{11}^{n+1} = \\sigma_{y0} + H(\\varepsilon_{11} - \\sigma_{y0}/E)$ 更新应力，得出 $\\sigma_{11}^{n+1} = 0.2518095\\,\\mathrm{GPa}$，并取 $E_{\\mathrm{ep}} = H$。纯剪切：取 $\\sigma_{\\mathrm{eq}} = 2\\,\\tau$ 并在 $\\tau_{y} = \\sigma_{y0}/\\sqrt{2}$ 时发生剪切屈服；对于 $\\gamma_{12} = 0.01$，修正后的 $\\tau^{n+1} = 0.125\\,\\mathrm{GPa}$。平面应力下的等双轴面内加载：使用预测器 $\\sigma^{\\mathrm{tr}} = \\dfrac{E}{1+\\nu}\\,\\varepsilon$，因此对于 $\\varepsilon_{11} = \\varepsilon_{22} = 0.0015$，有 $\\sigma^{\\mathrm{tr}} = 0.2423\\,\\mathrm{GPa}  \\sigma_{y0}$，响应是弹性的，$\\sigma_{11}^{n+1} = \\sigma_{22}^{n+1} = 0.2423\\,\\mathrm{GPa}$。\n\nD. 单轴拉伸：施加 $\\varepsilon_{11} = 0.003$，并使用基于体积模量 $K$ 的静水回归映射，塑性乘子增量为 $\\Delta \\gamma = \\dfrac{f^{\\mathrm{tr}}}{3K + H}$，更新后的应力为 $\\sigma_{11}^{n+1} = 0.2516\\,\\mathrm{GPa}$。纯剪切：通过施加静水应变 $\\varepsilon_{11} = \\varepsilon_{22} = \\varepsilon_{33} = 0.002$ 来检查静水不变性；预期当静水压力超过 $\\sigma_{y0}$ 时发生屈服，并进行降低压力的塑性修正。等双轴面内加载：对于 $\\varepsilon_{11} = \\varepsilon_{22} = 0.0015$，假设 $\\sigma_{\\mathrm{eq}} = \\sqrt{2}\\,\\sigma$，并用 $\\Delta \\gamma = \\dfrac{f^{\\mathrm{tr}}}{2G + H}$ 进行更新，得到 $\\sigma_{11}^{n+1} = 0.180\\,\\mathrm{GPa}$。\n\n请选择正确的选项。", "solution": "问题陈述要求为使用偏应力径向回归映射算法实现的小应变各向同性 J2 弹塑性模型（带线性硬化）确定一个正确且自洽的单元测试集。测试涵盖单轴拉伸、纯剪切和等双轴平面应力加载。\n\n首先，我将验证问题陈述本身。\n\n### 步骤1：提取已知条件\n- **本构模型**：小应变各向同性弹塑性，von Mises (J2) 屈服，线性各向同性硬化。\n- **算法**：应力空间中的偏应力径向回归映射算法。\n- **材料参数**：\n    - 杨氏模量：$E = 210\\,\\mathrm{GPa}$\n    - 泊松比：$\\nu = 0.3$\n    - 初始屈服应力：$\\sigma_{y0} = 250\\,\\mathrm{MPa} = 0.250\\,\\mathrm{GPa}$\n    - 线性各向同性硬化模量：$H = 1\\,\\mathrm{GPa}$\n- **初始状态**：无应力 ($\\boldsymbol{\\sigma}^n = \\mathbf{0}$)，零塑性应变 ($\\boldsymbol{\\varepsilon}_p^n = \\mathbf{0}$)，零硬化 ($\\alpha^n = 0$)。\n- **任务**：为三种特定加载验证一个单元测试套件，包括加载定义、试探响应、屈服检查、带有闭式解结果的塑性修正，以及一个额外的检查（切线模量或不变性）。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在计算塑性力学的标准框架内定义明确。材料模型、参数和数值算法都是固体力学领域的标准内容。材料属性对于钢是符合实际的。所要求的测试用例是典型的，可作为极好的验证问题。该问题有科学依据，是适定的、客观的。它提供了推导每个测试用例唯一解所需的所有信息。\n\n### 步骤3：结论与行动\n问题陈述有效。我现在将继续推导解答并评估每个提供的选项。\n\n### 理论框架\n\n该算法的核心涉及一个弹性预测步骤，如果试探应力位于屈服面之外，则进行塑性修正。\n\n1.  **弹性常数**：\n    -   剪切模量：$G = \\dfrac{E}{2(1+\\nu)} = \\dfrac{210\\,\\mathrm{GPa}}{2(1+0.3)} = \\dfrac{210}{2.6} \\approx 80.76923\\,\\mathrm{GPa}$。\n    -   体积模量：$K = \\dfrac{E}{3(1-2\\nu)} = \\dfrac{210\\,\\mathrm{GPa}}{3(1-0.6)} = \\dfrac{210}{1.2} = 175\\,\\mathrm{GPa}$。\n\n2.  **径向回归算法**：\n    -   **试探应力**：$\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbf{C} : (\\boldsymbol{\\varepsilon}^{n+1} - \\boldsymbol{\\varepsilon}_p^n)$。从无应力状态开始，$\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbf{C} : \\Delta\\boldsymbol{\\varepsilon}$。\n    -   **屈服检查**：计算试探等效应力 $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2}\\mathbf{s}^{\\mathrm{tr}}:\\mathbf{s}^{\\mathrm{tr}}}$，其中 $\\mathbf{s}^{\\mathrm{tr}}$ 是 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ 的偏量部分。屈服函数为 $f^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_y(\\alpha^n)$。如果 $f^{\\mathrm{tr}}  0$，则发生塑性流动。\n    -   **塑性修正**：如果发生屈服，则计算塑性乘子增量 $\\Delta \\gamma$。对于线性各向同性硬化，它由下式给出：\n        $$ \\Delta\\gamma = \\dfrac{f^{\\mathrm{tr}}}{3G+H} $$\n    -   更新后的等效应力为：\n        $$ \\sigma_{\\mathrm{eq}}^{n+1} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - 3G\\Delta\\gamma = \\sigma_y(\\alpha^n) + H\\Delta\\gamma $$\n    -   更新后的偏应力通过径向回归回到新的屈服面上：\n        $$ \\mathbf{s}^{n+1} = \\dfrac{\\sigma_{\\mathrm{eq}}^{n+1}}{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}} \\mathbf{s}^{\\mathrm{tr}} $$\n    -   对于 J2 塑性，静水应力不变：$\\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}^{n+1}) = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}^{\\mathrm{tr}})$。\n    -   更新后的各向同性硬化变量（等效塑性应变）为 $\\alpha^{n+1} = \\alpha^n + \\Delta\\gamma$。\n\n现在，让我们分析每个选项中提出的测试。\n\n### 选项A的分析\n\n该选项提出了三个测试。让我们逐一验证。\n\n**1. 单轴拉伸：**\n-   **加载**：“施加总轴向应变 $\\varepsilon_{11} = 0.003$，所有其他应变分量为零”。这定义了一个单轴应变状态。\n-   **弹性预测器**：该选项将试探应力计算为 $\\sigma^{\\mathrm{tr}} = E\\,\\varepsilon_{11} = 210\\,\\mathrm{GPa} \\times 0.003 = 0.630\\,\\mathrm{GPa}$。这是单轴应力状态下的正确应力，而不是所施加的单轴应变状态。这是测试描述中的一个不一致之处。然而，我们将继续假设其意图是一个单轴应力测试，其中轴向应变达到了 $\\varepsilon_{11}=0.003$。在这种情况下，$\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathrm{diag}(0.630, 0, 0)\\,\\mathrm{GPa}$。对于单轴应力，$\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = |\\sigma_{11}^{\\mathrm{tr}}| = 0.630\\,\\mathrm{GPa}$。这与选项相符。\n-   **屈服检查**：由于 $\\sigma_{y0} = 0.250\\,\\mathrm{GPa}$，试探屈服函数为 $f^{\\mathrm{tr}} = 0.630 - 0.250 = 0.380\\,\\mathrm{GPa}$。由于 $f^{\\mathrm{tr}}  0$，需要进行塑性修正。这是正确的。\n-   **塑性修正**：\n    -   模量项为 $3G + H = 3 \\times 80.76923... + 1 = 242.30769...\\,\\mathrm{GPa}$。使用选项中的值 $G \\approx 80.769\\,\\mathrm{GPa}$ 得到 $3G+H \\approx 243.307\\,\\mathrm{GPa}$。\n    -   塑性乘子为 $\\Delta\\gamma = \\dfrac{f^{\\mathrm{tr}}}{3G+H} = \\dfrac{0.380\\,\\mathrm{GPa}}{243.307\\,\\mathrm{GPa}} \\approx 0.0015619$。这个计算是正确的。\n    -   更新后的等效应力为 $\\sigma_{\\mathrm{eq}}^{n+1} = \\sigma_{y0} + H\\Delta\\gamma = 0.250\\,\\mathrm{GPa} + 1\\,\\mathrm{GPa} \\times 0.0015619 = 0.2515619\\,\\mathrm{GPa}$。这是正确的。\n    -   该选项接着声称“因为状态是单轴的，所以更新后的轴向应力为 $\\sigma_{11}^{n+1} = 0.251562\\,\\mathrm{GPa}$”。这有缺陷。通用的三维径向回归算法并不保持单轴应力状态。此外，一个正确的 一维模型会给出不同的结果 ($\\sigma_{11}^{n+1} \\approx 0.2518\\,\\mathrm{GPa}$)，这是使用分母 $E+H$ 而非 $3G+H$ 推导出来的。该选项内部不一致，因为它也正确地给出了 一维弹塑性切线模量 $E_{\\mathrm{ep}} = \\dfrac{E\\,H}{E + H} = \\dfrac{210 \\times 1}{210+1} \\approx 0.99526\\,\\mathrm{GPa}$，这与一维模型的结果相关。\n-   尽管存在这些不一致，但计算遵循一个特定的（尽管是简单应用的）逻辑。\n\n**2. 纯剪切：**\n-   **加载**：$\\gamma_{12} = 0.01$，所以张量应变为 $\\varepsilon_{12} = 0.005$。\n-   **弹性预测器**：试探剪切应力 $\\tau^{\\mathrm{tr}} = \\sigma_{12}^{\\mathrm{tr}} = G\\gamma_{12} = 80.769\\,\\mathrm{GPa} \\times 0.01 = 0.80769\\,\\mathrm{GPa}$。对于纯剪切，$\\sigma_{\\mathrm{eq}} = \\sqrt{3}\\tau$。所以 $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{3} \\times 0.80769 \\approx 1.3987\\,\\mathrm{GPa}$。这是正确的。\n-   **屈服检查**：$f^{\\mathrm{tr}} = 1.3987 - 0.250 = 1.1487\\,\\mathrm{GPa}  0$。这是正确的。\n-   **塑性修正**：\n    -   $\\Delta\\gamma = \\dfrac{1.1487\\,\\mathrm{GPa}}{243.307\\,\\mathrm{GPa}} \\approx 0.0047219$。正确。\n    -   $\\sigma_{\\mathrm{eq}}^{n+1} = 0.250\\,\\mathrm{GPa} + 1\\,\\mathrm{GPa} \\times 0.0047219 = 0.2547219\\,\\mathrm{GPa}$。正确。\n    -   更新后的剪切应力必须满足 $\\sigma_{\\mathrm{eq}}^{n+1} = \\sqrt{3} \\tau^{n+1}$。因此，$\\tau^{n+1} = \\dfrac{\\sigma_{\\mathrm{eq}}^{n+1}}{\\sqrt{3}} = \\dfrac{0.2547219}{\\sqrt{3}} \\approx 0.147054\\,\\mathrm{GPa}$。正确。\n-   这个测试用例是正确且自洽的。\n\n**3. 平面应力下的等双轴面内加载：**\n-   **加载**：$\\varepsilon_{11} = \\varepsilon_{22} = 0.0015$，且 $\\sigma_{33} = 0$。\n-   **弹性预测器**：对于弹性平面应力且 $\\varepsilon_{11}=\\varepsilon_{22}=\\varepsilon$，面内应力为 $\\sigma_{11}=\\sigma_{22}=\\dfrac{E}{1-\\nu}\\varepsilon = \\dfrac{210}{0.7} \\times 0.0015 = 0.450\\,\\mathrm{GPa}$。这是正确的。\n-   对于此应力状态（$\\sigma_{11}=\\sigma_{22}=\\sigma$，$\\sigma_{33}=0$），等效应力为 $\\sigma_{\\mathrm{eq}} = \\sigma$。因此 $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = 0.450\\,\\mathrm{GPa}$。正确。\n-   **屈服检查**：$f^{\\mathrm{tr}} = 0.450 - 0.250 = 0.200\\,\\mathrm{GPa}  0$。正确。\n-   **塑性修正**：\n    -   使用通用公式：$\\Delta\\gamma = \\dfrac{0.200\\,\\mathrm{GPa}}{243.307\\,\\mathrm{GPa}} \\approx 0.0008220$。该选项使用的是 $0.00082234$，这是一个微小的差异。\n    -   使用该选项的 $\\Delta\\gamma$，$\\sigma_{\\mathrm{eq}}^{n+1} = 0.250 + 1 \\times 0.00082234 = 0.25082234\\,\\mathrm{GPa}$。根据给定的 $\\Delta\\gamma$，这是正确的。\n    -   该选项接着声称 $\\sigma_{11}^{n+1} = \\sigma_{22}^{n+1} = \\sigma_{\\mathrm{eq}}^{n+1}$。如前所示，这对于等双轴平面应力状态是正确的。虽然对 $\\Delta\\gamma$ 使用三维公式而不是严格的平面应力算法是一种简化，但得到的状态是一致的。\n-   这个测试用例在很大程度上是一致的，假设采用了一个特定的（简化的）实现选择。\n\n**关于A的结论**：虽然单轴拉伸测试的描述和计算不一致，但纯剪切测试是完美的，而等双轴测试是合理的。与其他选项相比，它包含了迄今为止最正确的物理和计算。在单轴测试中发现的不一致性（例如将 $E_{ep}$ 这样的一维分析与三维更新公式混合使用）与其他选项中公然的错误相比是细微的。因此，选项A是唯一可行的选择。\n\n### 选项B的分析\n-   **单轴拉伸**：提出 $\\Delta\\gamma = \\dfrac{f^{\\mathrm{tr}}}{2G+H}$。这个分母是错误的。正确的是 $3G+H$。\n-   **纯剪切**：声称剪切屈服应力是 $\\tau_y = \\sigma_{y0}/2$。这对应于 Tresca 准则，而不是 von Mises 准则，对于后者 $\\tau_y = \\sigma_{y0}/\\sqrt{3}$。还使用了 $\\sigma_{eq} = 2\\tau$，这也适用于 Tresca。不正确。\n-   **等双轴**：假设 $\\sigma_{\\mathrm{eq}} = \\sqrt{2}\\,\\sigma$。对于等双轴平面应力，$\\sigma_{eq} = \\sigma$。不正确。\n**关于B的结论**：在多个塑性理论要点上存在根本性错误。\n\n### 选项C的分析\n-   **单轴拉伸**：给出了一个关系式 $\\sigma_{11}^{n+1} = \\sigma_{y0} + H(\\varepsilon_{11} - \\sigma_{y0}/E)$。这在量纲上不一致（应力 = 应力 + 模量 * 应变），并且是错误的，尽管数值结果恰好是 一维模型的正确结果。声称 $E_{ep}=H$ 是不正确的；$E_{ep}=EH/(E+H)$。\n-   **纯剪切**：使用 $\\sigma_{eq} = 2\\tau$ (Tresca) 和 $\\tau_y = \\sigma_{y0}/\\sqrt{2}$ (不正确)。\n-   **等双轴**：使用了不正确的弹性预测器 $\\sigma^{\\mathrm{tr}} = \\dfrac{E}{1+\\nu}\\varepsilon$ 而不是 $\\dfrac{E}{1-\\nu}\\varepsilon$。\n**关于C的结论**：在多个要点上存在根本性错误。\n\n### 选项D的分析\n-   **单轴拉伸**：提出了一个“基于体积模量 $K$ 的静水回归映射”。J2 塑性是纯偏量的；屈服与静水压力无关。这是一个根本性的误解。\n-   **纯剪切**：提出了一个静水不变性的测试，但错误地暗示屈服是由静水压力引起的。这与静水不变性恰恰相反。\n-   **等双轴**：使用不正确的关系 $\\sigma_{eq} = \\sqrt{2}\\,\\sigma$ 和不正确的分母 $2G+H$ 来计算 $\\Delta\\gamma$。\n**关于D的结论**：表现出对 J2 塑性理论的完全不理解。不正确。\n\n### 结论\n\n选项B、C和D包含塑性理论中严重的、根本性的错误。选项A虽然在其单轴拉伸测试的描述中存在不一致之处，并且对一维/二维情况使用了简化的算法，但它在物理和数学上是迄今为止最合理的。纯剪切测试完全正确，另外两个测试与一个合理的（尽管可能有些简单）三维算法实现是一致的。与其他选项中的公然错误相比，单轴测试中已识别的不一致性是细微的。因此，选项A是唯一可行的选择。", "answer": "$$\\boxed{A}$$", "id": "2678252"}, {"introduction": "经典的径向返回算法是为光滑的屈服面（如 von Mises 屈服面）设计的。本练习挑战您超越这一理想化模型，思考具有非光滑屈服面的材料，例如由 Tresca 或 Mohr-Coulomb 准则描述的材料。理解如何处理拐角和棱边处的非唯一法向是将在计算塑性力学领域的工具箱扩展到更广泛的工程材料的关键 [@problem_id:2678260]。", "problem": "一个小应变、率无关、各向同性弹性、理想塑性固体通过相关联流动法则和凸但非光滑的屈服面进行建模。设弹性自由能为 $\\psi(\\boldsymbol{\\varepsilon},\\boldsymbol{\\varepsilon}^{p})=\\tfrac{1}{2}\\,(\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^{p}):\\mathbb{C}:(\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^{p})$，其中 $\\mathbb{C}$ 是四阶弹性张量，$\\boldsymbol{\\varepsilon}$ 是总小应变，$\\boldsymbol{\\varepsilon}^{p}$ 是塑性应变。Cauchy 应力为 $\\boldsymbol{\\sigma}=\\mathbb{C}:(\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^{p})$。屈服条件为 $f(\\boldsymbol{\\sigma})\\le 0$，相关联流动法则为 $\\dot{\\boldsymbol{\\varepsilon}}^{p}=\\dot{\\lambda}\\,\\partial f(\\boldsymbol{\\sigma})$，其中 $\\partial f(\\boldsymbol{\\sigma})$ 表示当 $f$ 可微时 $f$ 的梯度。\n\n考虑一类非光滑屈服函数，其局部可写为有限多个光滑函数的逐点最大值，\n$$\nf(\\boldsymbol{\\sigma})=\\max_{i\\in\\{1,\\dots,m\\}}\\left\\{f_{i}(\\boldsymbol{\\sigma})\\right\\},\\quad \\text{with } f_{i}(\\boldsymbol{\\sigma})=\\boldsymbol{n}_{i}:\\boldsymbol{\\sigma}-k_{i},\n$$\n其中每个 $\\boldsymbol{n}_{i}$ 是应力空间中的常数单位张量，而 $k_{i}$ 是常数。此构造表示沿棱和角点相交的相邻平面屈服面，如 Mohr–Coulomb 型准则。令 $\\mathcal{E}=\\{\\boldsymbol{\\sigma}\\,:\\,f(\\boldsymbol{\\sigma})\\le 0\\}$ 表示弹性域。\n\n一个标准的增量返回映射步从一个产生弹性预测（试探）应力 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}=\\mathbb{C}:(\\boldsymbol{\\varepsilon}_{n+1}-\\boldsymbol{\\varepsilon}^{p}_{n})$ 的应变增量开始。如果 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}\\notin \\mathcal{E}$，则应用塑性修正以获得满足 Karush–Kuhn–Tucker 条件和相关联流动法则的 $\\boldsymbol{\\sigma}_{n+1}\\in \\partial \\mathcal{E}$。对于光滑的 $f$，通常使用沿外法线 $\\nabla f(\\boldsymbol{\\sigma}_{n+1})$ 的“径向返回”更新。\n\n在当前的非光滑情况下，假设 $\\boldsymbol{\\sigma}_{n+1}$ 位于 $\\partial \\mathcal{E}$ 的一个棱或角点上，其中至少有两个面同时激活，即存在一个非空激活集 $\\mathcal{A}\\subset\\{1,\\dots,m\\}$，其基数 $|\\mathcal{A}|\\ge 2$，使得对于所有 $i\\in \\mathcal{A}$ 都有 $f_{i}(\\boldsymbol{\\sigma}_{n+1})=0$。从上述基本原理（能量、屈服容许性、相关联法向性和弹性度量下的约束最近点投影）出发，推断这种非光滑性对返回映射算法的影响。\n\n下列陈述中哪些是正确的？选择所有适用的选项。\n\nA. 在 $|\\mathcal{A}|\\ge 2$ 的棱和角点处，$f(\\boldsymbol{\\sigma})=0$ 的法线是集值的，由激活面法线的凸包给出，因此纯粹的单方向径向返回是非适定的。正确的塑性修正可以表述为在 $\\mathbb{C}^{-1}$ 度量下的最近点投影，并采用激活集或次微分处理，从而得到外法线的组合和多个塑性乘子。\n\nB. 在偏应力空间中构造的径向返回总能找到能量上最接近的容许应力，即使在角点和棱上也是如此，因此单一曲面算法无需修改仍然有效。\n\nC. 角点处法线的非唯一性仅仅是一个数值假象；通过充分减小时间步长并强制对称一致切线，可以恢复唯一的法线方向，因此不需要特殊的算法更改。\n\nD. 由于相邻面在角点处共享相同的外法线，因此可以任意选择任何相邻面的法线作为返回方向；最终的修正应力和一致切线与此任意选择无关。\n\nE. 一种替代显式非光滑处理的方法是通过平滑角点来正则化 $f$（例如，用光滑近似替换逐点最大值）。这使得单方向返回成为可能，但代价是改变了本构响应；在正则化参数趋于零的极限下，平滑化算法逼近非光滑解，并且必须根据所选的平滑方法进行一致地重新线性化。", "solution": "问题陈述需经过验证。\n\n步骤 1：提取已知条件\n- 弹性自由能: $\\psi(\\boldsymbol{\\varepsilon},\\boldsymbol{\\varepsilon}^{p})=\\tfrac{1}{2}\\,(\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^{p}):\\mathbb{C}:(\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^{p})$。\n- Cauchy 应力: $\\boldsymbol{\\sigma}=\\mathbb{C}:(\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^{p})$。\n- 屈服条件: $f(\\boldsymbol{\\sigma})\\le 0$。\n- 流动法则: $\\dot{\\boldsymbol{\\varepsilon}}^{p}=\\dot{\\lambda}\\,\\partial f(\\boldsymbol{\\sigma})$ (相关联)。\n- 非光滑屈服函数: $f(\\boldsymbol{\\sigma})=\\max_{i\\in\\{1,\\dots,m\\}}\\left\\{f_{i}(\\boldsymbol{\\sigma})\\right\\}$，其中 $f_{i}(\\boldsymbol{\\sigma})=\\boldsymbol{n}_{i}:\\boldsymbol{\\sigma}-k_{i}$。\n- 弹性域: $\\mathcal{E}=\\{\\boldsymbol{\\sigma}\\,:\\,f(\\boldsymbol{\\sigma})\\le 0\\}$。\n- 弹性预测应力: $\\boldsymbol{\\sigma}^{\\mathrm{tr}}=\\mathbb{C}:(\\boldsymbol{\\varepsilon}_{n+1}-\\boldsymbol{\\varepsilon}^{p}_{n})$。\n- 非光滑条件: 最终应力 $\\boldsymbol{\\sigma}_{n+1}$ 位于一个棱或角点上，意味着对于一个基数 $|\\mathcal{A}|\\ge 2$ 的激活集 $\\mathcal{A}$ 中的所有 $i$，都有 $f_{i}(\\boldsymbol{\\sigma}_{n+1})=0$。\n\n步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了率无关、小应变弹塑性力学的标准框架。使用最大值类型的凸非光滑屈服面是土壤、岩石或混凝土等材料（例如 Mohr-Coulomb、Drucker-Prager）的经典表示。相关联流动、返回映射和次微分的概念是现代计算塑性力学的核心。所有前提都是合理的。\n- **适定性**：问题是适定的。它要求在特定的、明确定义的数学条件下对返回映射算法进行正确的特征描述。底层的变分结构保证了应力更新的唯一解。\n- **客观性**：语言清晰、精确，没有主观性。所有术语都是固体力学领域的标准术语。\n\n步骤 3：结论与行动\n问题陈述有效。这是一个关于计算固体力学基本主题的适定且科学合理的问题。将推导解答。\n\n相关联塑性中返回映射算法的核心是最大塑性耗散原理。对于率无关固体，这等价于陈述：更新后的应力状态 $\\boldsymbol{\\sigma}_{n+1}$ 是在容许弹性域 $\\mathcal{E}$ 上距离试探应力状态 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 最近的点，其中“距离”是在由逆弹性张量 $\\mathbb{C}^{-1}$ 定义的能量度量下测量的。这是一个约束优化问题：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\arg \\min_{\\boldsymbol{\\tau} \\in \\mathcal{E}} \\left\\{ \\frac{1}{2} (\\boldsymbol{\\sigma}^{\\text{tr}} - \\boldsymbol{\\tau}) : \\mathbb{C}^{-1} : (\\boldsymbol{\\sigma}^{\\text{tr}} - \\boldsymbol{\\tau}) \\right\\}\n$$\n这个问题的解由 Karush-Kuhn-Tucker (KKT) 条件刻画。对于一般的凸屈服函数 $f$，这些条件要求塑性应变增量 $\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{\\varepsilon}^p_{n+1} - \\boldsymbol{\\varepsilon}^p_n$ 在 $\\boldsymbol{\\sigma}_{n+1}$ 处与屈服面正交。由于 $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\text{tr}} - \\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon}^p$，这等价于陈述返回路径 $(\\boldsymbol{\\sigma}^{\\text{tr}} - \\boldsymbol{\\sigma}_{n+1})$ 与 $\\mathbb{C}:\\boldsymbol{N}$ 共线，其中 $\\boldsymbol{N}$ 是外法线。\n\n在光滑屈服面的情况下，法线 $\\boldsymbol{N} = \\nabla f(\\boldsymbol{\\sigma}_{n+1})$ 是唯一的，离散化的流动法则是 $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\lambda \\, \\nabla f(\\boldsymbol{\\sigma}_{n+1})$，对应单个标量塑性乘子 $\\Delta\\lambda \\ge 0$。\n\n然而，问题指定了一个非光滑屈服函数 $f(\\boldsymbol{\\sigma}) = \\max_{i \\in \\{1,\\dots,m\\}} \\{f_i(\\boldsymbol{\\sigma})\\}$。这个函数是凸的，但在多个函数 $f_i$ 同时激活的点（即棱和角点）不可微。在这些点，梯度的概念被凸分析中的次微分所取代，记为 $\\partial f(\\boldsymbol{\\sigma})$。对于给定形式的 $f$，在应力状态 $\\boldsymbol{\\sigma}$ 的次微分是激活函数梯度的凸包：\n$$\n\\partial f(\\boldsymbol{\\sigma}) = \\text{Co} \\left\\{ \\nabla f_i(\\boldsymbol{\\sigma}) \\mid i \\in \\mathcal{A}(\\boldsymbol{\\sigma}) \\right\\} = \\text{Co} \\left\\{ \\boldsymbol{n}_i \\mid i \\in \\mathcal A(\\boldsymbol{\\sigma}) \\right\\}\n$$\n其中 $\\mathcal{A}(\\boldsymbol{\\sigma}) = \\{i \\mid f_i(\\boldsymbol{\\sigma}) = f(\\boldsymbol{\\sigma})\\}$。如果 $|\\mathcal{A}| \\ge 2$，这是一个向量集合，而不是单个向量。相关联流动法则推广为流动包含关系：\n$$\n\\dot{\\boldsymbol{\\varepsilon}}^p \\in \\dot{\\lambda} \\, \\partial f(\\boldsymbol{\\sigma})\n$$\n在时间积分后，这意味着塑性应变增量必须是激活面法线的非负线性组合：\n$$\n\\Delta\\boldsymbol{\\varepsilon}^p = \\sum_{i \\in \\mathcal{A}} \\Delta\\lambda_i \\, \\boldsymbol{n}_i\n$$\n其中 $\\Delta\\lambda_i \\ge 0$ 是每个激活面 $i \\in \\mathcal{A}$ 的单个塑性乘子。返回映射算法必须通过强制执行条件 $f_i(\\boldsymbol{\\sigma}_{n+1}) = 0$ 对所有 $i \\in \\mathcal{A}$ 求解这些乘子。这通常需要一个激活集策略。\n\n在这个框架下，我们评估所提供的选项。\n\nA. 在 $|\\mathcal{A}|\\ge 2$ 的棱和角点处，$f(\\boldsymbol{\\sigma})=0$ 的法线是集值的，由激活面法线的凸包给出，因此纯粹的单方向径向返回是非适定的。正确的塑性修正可以表述为在 $\\mathbb{C}^{-1}$ 度量下的最近点投影，并采用激活集或次微分处理，从而得到外法线的组合和多个塑性乘子。\n\n此陈述是对非光滑塑性力学研究现状的精确和正确总结。法线确实是集值的，由次微分给出，即激活面法线 $\\boldsymbol{n}_i$ 的凸包。单方向返回是非适定的，因为方向不唯一。表述为最近点投影是基本的变分基础。算法解涉及到找到法线的正确组合 $\\sum_i \\Delta\\lambda_i \\boldsymbol{n}_i$，这通常通过激活集方法来确定乘子 $\\Delta\\lambda_i$。\n**结论：正确。**\n\nB. 在偏应力空间中构造的径向返回总能找到能量上最接近的容许应力，即使在角点和棱上也是如此，因此单一曲面算法无需修改仍然有效。\n\n这是不正确的。偏应力空间中的径向返回是 J2 (von Mises) 塑性的一个特有性质，其中屈服面在偏平面上是一个圆。这里的问题考虑的是一般的非光滑曲面，如 Tresca 六边形或 Mohr-Coulomb 曲面，对于这些曲面，从试探应力到曲面上一点的简单径向返回，一般而言不是最近点投影，特别是对于返回到角点的情况。返回的方向由最小化原理决定，而不是由预定的几何构造决定。声称单一曲面算法无需修改仍然有效是根本错误的；角点的存在需要更复杂的多曲面或基于次梯度的算法。\n**结论：错误。**\n\nC. 角点处法线的非唯一性仅仅是一个数值假象；通过充分减小时间步长并强制对称一致切线，可以恢复唯一的法线方向，因此不需要特殊的算法更改。\n\n这是大错特错的。屈服面在角点处的不可微性是所选本构模型的一个内在数学属性，而不是数值假象。减小时间步长 $\\Delta t$ 并不能平滑一个不可微的点；它只会使试探应力更接近屈服面。如果物理应力路径穿过一个角点，任何足够小的步长的返回映射仍将涉及角点处理。法线的非唯一性是根本性的，需要特殊的算法更改，如选项 A 中所述。强制切线对称是一个正确的、基于势的算法的结果，而不是规避非光滑性的一种手段。\n**结论：错误。**\n\nD. 由于相邻面在角点处共享相同的外法线，因此可以任意选择任何相邻面的法线作为返回方向；最终的修正应力和一致切线与此任意选择无关。\n\n这个陈述基于一个错误的前提。根据定义，相邻面有*不同*的外法线 $\\{\\boldsymbol{n}_i\\}$。正是这种差异产生了棱或角点。角点处可能的法线方向集合是由这些不同法线的凸组合形成的锥体。任意选择其中一个法线作为返回方向，通常会导致一个不正确的最终应力，它不是最近点投影，并且可能违反其他激活面的屈服条件。最终的应力和切线将高度依赖于这个任意且不正确的选择。\n**结论：错误。**\n\nE. 一种替代显式非光滑处理的方法是通过平滑角点来正则化 $f$（例如，用光滑近似替换逐点最大值）。这使得单方向返回成为可能，但代价是改变了本构响应；在正则化参数趋于零的极限下，平滑化算法逼近非光滑解，并且必须根据所选的平滑方法进行一致地重新线性化。\n\n此陈述描述了一种有效且广泛使用的替代方法。正则化（或平滑化）将非光滑的 $f$ 替换为一个近似它的光滑函数 $f_{\\epsilon}$。例如，$\\max$ 函数可以用 log-sum-exp 函数或 p-范数函数来近似。这个正则化曲面 $f_{\\epsilon}=0$ 处处有唯一的法线，因此可以应用标准的单一曲面返回映射算法。其代价是稍微修改了材料的本构定律。随着正则化参数 $\\epsilon \\to 0$，平滑模型的响应逼近非平滑模型的响应，尽管这个极限过程可能会引入数值刚度。为了使全局 Newton-Raphson 格式二次收敛，一致切线算子必须从算法中实际使用的平滑函数 $f_{\\epsilon}$ 推导出来，这一点至关重要。\n**结论：正确。**", "answer": "$$\\boxed{AE}$$", "id": "2678260"}]}