{"hands_on_practices": [{"introduction": "有限元方法的准确性在很大程度上依赖于积分的精确数值计算，尤其是单元刚度矩阵的计算。本练习旨在深入探讨等参单元数值积分的核心问题。通过分析刚度矩阵被积函数的精确多项式阶次，您将能够确定所需的最小高斯积分点数，并揭示理想（仿射）四边形单元与一般扭曲四边形单元在积分要求上的关键区别 [@problem_id:2651702]。", "problem": "一个双线性四边形有限元（在有限元法 (FEM) 中通常表示为 $Q4$）被用于平面应力或平面应变状态下的均匀、线性弹性体。该单元采用等参格式，其自然坐标为 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$，双线性形函数为 $N_{i}(\\xi,\\eta)$，映射关系为 $\\boldsymbol{x}(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,\\boldsymbol{x}_{i}$。单元刚度矩阵为\n$$\n\\boldsymbol{K}_{e}=\\int_{\\Omega_{e}}\\boldsymbol{B}^{\\mathsf{T}}\\boldsymbol{D}\\,\\boldsymbol{B}\\,\\mathrm{d}\\Omega\n=\\int_{-1}^{1}\\int_{-1}^{1}\\boldsymbol{B}^{\\mathsf{T}}(\\xi,\\eta)\\,\\boldsymbol{D}\\,\\boldsymbol{B}(\\xi,\\eta)\\,\\det\\boldsymbol{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\n其中 $\\boldsymbol{D}$ 是常数材料矩阵，$\\boldsymbol{B}(\\xi,\\eta)$ 是通过链式法则使用等参映射的雅可比矩阵 $\\boldsymbol{J}(\\xi,\\eta)$ 得到的应变-位移矩阵，而 $\\det\\boldsymbol{J}(\\xi,\\eta)$ 是雅可比行列式。该积分通过具有 $n_{\\xi}\\times n_{\\eta}$ 个点的张量积 Gauss–Legendre 求积法进行计算。仅使用以下基本事实：\n- 双线性形函数是多项式，在每个自然坐标上最多是线性的。\n- 仿射（平行四边形）映射的雅可比矩阵 $\\boldsymbol{J}(\\xi,\\eta)$ 是常数，而对于一般的双线性映射，其元素在 $\\xi$ 和 $\\eta$ 上是线性的，因此 $\\det\\boldsymbol{J}(\\xi,\\eta)$ 通常是一个总次数最高为2的多项式。\n- 具有 $n$ 个点的一维 Gauss–Legendre 法则可以精确积分任何次数最高为 $2n-1$ 的多项式；二维中的张量积法则在每个坐标上都继承了这种精确性。\n\n对于线性材料行为下的双线性四边形，确定精确积分 $\\boldsymbol{K}_{e}$ 所需的最小 Gauss 点数，并通过追踪被积函数的多项式阶数来证明你的选择。选择正确的陈述。\n\nA. $1\\times 1$ Gauss 点足以对任何双线性四边形精确积分 $\\boldsymbol{K}_{e}$，因为形函数是双线性的。\n\nB. $2\\times 2$ Gauss 点可以对任何双线性四边形（包括任意扭曲的单元）精确积分 $\\boldsymbol{K}_{e}$，因为被积函数的最高多项式次数为2。\n\nC. 当映射为仿射（矩形或平行四边形）时，$2\\times 2$ Gauss 点可以精确积分 $\\boldsymbol{K}_{e}$，因为此时被积函数在每个自然坐标上是次数最高为2的多项式；对于一般的双线性（扭曲）映射，被积函数是有理函数，没有有限的张量积 Gauss–Legendre 法则能对所有此类单元都精确。\n\nD. 需要 $3\\times 3$ Gauss 点才能对任何双线性四边形精确积分 $\\boldsymbol{K}_{e}$，因为即使对于仿射映射，被积函数也含有三次项。", "solution": "对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 单元：一个双线性四边形有限元 ($Q4$)。\n- 物理背景：平面应力或平面应变状态下的均匀、线性弹性体。\n- 格式：等参，自然坐标为 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$。\n- 形函数：双线性形函数, $N_{i}(\\xi,\\eta)$。\n- 映射：$\\boldsymbol{x}(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,\\boldsymbol{x}_{i}$。\n- 单元刚度矩阵：$\\boldsymbol{K}_{e} = \\int_{-1}^{1}\\int_{-1}^{1}\\boldsymbol{B}^{\\mathsf{T}}(\\xi,\\eta)\\,\\boldsymbol{D}\\,\\boldsymbol{B}(\\xi,\\eta)\\,\\det\\boldsymbol{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$。\n- 材料矩阵 $\\boldsymbol{D}$ 是常数。\n- 应变-位移矩阵 $\\boldsymbol{B}(\\xi,\\eta)$ 是通过链式法则使用雅可比矩阵 $\\boldsymbol{J}(\\xi,\\eta)$ 获得的。\n- 数值积分：使用 $n_{\\xi}\\times n_{\\eta}$ 个点的张量积 Gauss–Legendre 求积法。\n- 基本事实1：双线性形函数是多项式，在每个自然坐标上最多是线性的。\n- 基本事实2：仿射（平行四边形）映射的雅可比矩阵 $\\boldsymbol{J}(\\xi,\\eta)$ 是常数。对于一般的双线性映射，其元素在 $\\xi$ 和 $\\eta$ 上是线性的，且 $\\det\\boldsymbol{J}(\\xi,\\eta)$ 是一个总次数最高为2的多项式。\n- 基本事实3：具有 $n$ 个点的一维 Gauss–Legendre 法则可以精确积分任何次数最高为 $2n-1$ 的多项式。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，提法得当且客观。它提供了计算固体力学（有限元法）领域的一个标准理论问题。所有给定的定义和“基本事实”都与既有理论一致。问题本身是自洽的，没有矛盾、歧义或伪科学论断。\n\n### 步骤3：结论和行动\n问题有效。将推导完整解答。\n\n目标是确定精确积分单元刚度矩阵 $\\boldsymbol{K}_{e}$ 所需的最小 Gauss 求积点数。这需要分析被积函数的多项式阶数，即矩阵值的函数 $\\boldsymbol{I}(\\xi,\\eta) = \\boldsymbol{B}^{\\mathsf{T}}(\\xi,\\eta)\\,\\boldsymbol{D}\\,\\boldsymbol{B}(\\xi,\\eta)\\,\\det\\boldsymbol{J}(\\xi,\\eta)$。材料矩阵 $\\boldsymbol{D}$ 是常数，不影响被积函数的多项式特性。我们必须分析 $\\boldsymbol{B}(\\xi,\\eta)$ 和 $\\det\\boldsymbol{J}(\\xi,\\eta)$ 的结构。\n\n应变-位移矩阵 $\\boldsymbol{B}$ 将应变分量与节点位移关联起来。其元素由形函数相对于全局坐标 $(x,y)$ 的导数构成。这些是通过链式法则获得的：\n$$\n\\begin{Bmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{Bmatrix} = \\boldsymbol{J}^{-1} \\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{Bmatrix} = \\frac{1}{\\det\\boldsymbol{J}} \\begin{pmatrix} J_{22} & -J_{12} \\\\ -J_{21} & J_{11} \\end{pmatrix} \\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{Bmatrix}\n$$\n节点 $i$ 的 $\\boldsymbol{B}$ 矩阵的元素由诸如 $\\frac{\\partial N_i}{\\partial x}$ 和 $\\frac{\\partial N_i}{\\partial y}$ 的项构成。例如：\n$$\n\\frac{\\partial N_i}{\\partial x} = \\frac{1}{\\det\\boldsymbol{J}} \\left( J_{22} \\frac{\\partial N_i}{\\partial \\xi} - J_{12} \\frac{\\partial N_i}{\\partial \\eta} \\right)\n$$\n我们必须分析等参映射的两种不同情况。\n\n**情况1：一般（扭曲）双线性四边形**\n\n根据基本事实1，双线性形函数 $N_i(\\xi, \\eta)$ 在每个坐标上是线性的。例如，$N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$。其导数为：\n- $\\frac{\\partial N_i}{\\partial \\xi}$：一个在 $\\eta$ 上是线性的多项式。\n- $\\frac{\\partial N_i}{\\partial \\eta}$：一个在 $\\xi$ 上是线性的多项式。\n\n根据基本事实2，对于一般映射，雅可比矩阵 $\\boldsymbol{J}$ 的元素在 $\\xi$ 和 $\\eta$ 上是线性的。更具体地说，元素 $J_{11} = \\frac{\\partial x}{\\partial \\xi}$ 和 $J_{12} = \\frac{\\partial x}{\\partial \\eta}$ 在 $\\eta$ 上是线性的。元素 $J_{21} = \\frac{\\partial y}{\\partial \\xi}$ 和 $J_{22} = \\frac{\\partial y}{\\partial \\eta}$ 在 $\\xi$ 上是线性的。\n因此，行列式 $\\det\\boldsymbol{J} = J_{11}J_{22} - J_{12}J_{21}$ 是一个在 $\\eta$ 上线性的函数与一个在 $\\xi$ 上线性的函数的乘积，再减去另一个类似的乘积。结果是一个形式为 $p(\\xi,\\eta) = c_0 + c_1\\xi + c_2\\eta + c_3\\xi\\eta$ 的多项式。这在每个坐标上是分别线性的。\n\n现在考虑 $\\boldsymbol{B}$ 中某项的分子，例如 $J_{22} \\frac{\\partial N_i}{\\partial \\xi} - J_{12} \\frac{\\partial N_i}{\\partial \\eta}$。\n- $J_{22}$ 在 $\\xi$ 上是线性的。$\\frac{\\partial N_i}{\\partial \\xi}$ 在 $\\eta$ 上是线性的。它们的乘积包含一个 $\\xi\\eta$ 项。\n- $J_{12}$ 在 $\\eta$ 上是线性的。$\\frac{\\partial N_i}{\\partial \\eta}$ 在 $\\xi$ 上是线性的。它们的乘积包含一个 $\\xi\\eta$ 项。\n因此，分子是与 $\\det\\boldsymbol{J}$ 形式相同的多项式：在每个坐标上是线性的。\n因此，$\\boldsymbol{B}$ 矩阵的元素是**有理函数**，形式为 $\\frac{\\text{Polynomial}(\\xi,\\eta)}{\\det\\boldsymbol{J}(\\xi,\\eta)}$。\n\n刚度矩阵的被积函数包含 $\\boldsymbol{B}^{\\mathsf{T}}\\boldsymbol{B} \\det\\boldsymbol{J}$ 形式的项。该乘积中的任意一个元素的行为如下：\n$$\n\\left( \\frac{\\text{Poly}_1}{\\det\\boldsymbol{J}} \\right) \\left( \\frac{\\text{Poly}_2}{\\det\\boldsymbol{J}} \\right) \\det\\boldsymbol{J} = \\frac{\\text{Poly}_1 \\cdot \\text{Poly}_2}{\\det\\boldsymbol{J}}\n$$\n这是一个有理函数，其分母通常不是常数。Gauss-Legendre 求积法则是为精确积分多项式而设计的。通常，它不能用有限个点来精确积分分母可变的有理函数。\n\n**情况2：仿射映射（矩形或平行四边形）**\n\n根据基本事实2，对于仿射映射，雅可比矩阵 $\\boldsymbol{J}$ 是常数。因此，其逆矩阵 $\\boldsymbol{J}^{-1}$ 和行列式 $\\det\\boldsymbol{J}$ 也是常数。\n形函数相对于全局坐标的导数现在是：\n$$\n\\begin{Bmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{Bmatrix} = \\boldsymbol{J}^{-1} \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{Bmatrix}\n$$\n由于 $\\boldsymbol{J}^{-1}$ 是一个常数矩阵，$\\frac{\\partial N_i}{\\partial x}$ 和 $\\frac{\\partial N_i}{\\partial y}$ 是 $\\frac{\\partial N_i}{\\partial \\xi}$（在 $\\eta$ 上线性）和 $\\frac{\\partial N_i}{\\partial \\eta}$（在 $\\xi$ 上线性）的线性组合。因此，$\\boldsymbol{B}$ 矩阵的元素是形式为 $a+b\\xi+c\\eta$ 的多项式。\n\n被积函数 $\\boldsymbol{I}(\\xi,\\eta) = \\boldsymbol{B}^{\\mathsf{T}}\\boldsymbol{D}\\,\\boldsymbol{B}\\,\\det\\boldsymbol{J}$ 现在是一个多项式，因为 $\\boldsymbol{D}$ 和 $\\det\\boldsymbol{J}$ 是常数。乘积 $\\boldsymbol{B}^{\\mathsf{T}}\\boldsymbol{B}$ 的元素是通过将 $\\boldsymbol{B}$ 的两个元素相乘而形成的，这两个元素是 $\\xi$ 和 $\\eta$ 的线性多项式。两个此类多项式的乘积，例如 $(a_1+b_1\\xi+c_1\\eta)(a_2+b_2\\xi+c_2\\eta)$，得到一个包含最高达 $\\xi^2$、$\\eta^2$ 和 $\\xi\\eta$ 项的多项式。在变量 $\\xi$ 中的最高次数为2，在变量 $\\eta$ 中的最高次数为2。\n\n根据基本事实3，具有 $n$ 个点的一维 Gauss 法则可以精确积分次数最高为 $2n-1$ 的多项式。为了精确积分一个次数 $p=2$ 的多项式，我们必须有 $2n-1 \\ge 2$，这意味着 $2n \\ge 3$，或 $n \\ge 1.5$。$n$ 的最小整数值为2。\n由于被积函数在每个坐标方向上是次数最高为2的多项式，张量积法则需要在 $\\xi$ 方向上有2个点，在 $\\eta$ 方向上有2个点。因此，对于仿射映射的情况，$2 \\times 2$ Gauss-Legendre 求积对于精确积分是必要且充分的。\n\n**选项评估**\n\n*   **A. $1\\times 1$ Gauss 点足以对任何双线性四边形精确积分 $\\boldsymbol{K}_{e}$，因为形函数是双线性的。**\n    **不正确。** $1 \\times 1$ 法则可以积分次数最高为 $2(1)-1=1$ 的多项式。如前所示，即使对于最简单的非平凡仿射映射（矩形），被积函数在每个坐标上也是二次的。因此，$1 \\times 1$ 是不够的。\n\n*   **B. $2\\times 2$ Gauss 点可以对任何双线性四边形（包括任意扭曲的单元）精确积分 $\\boldsymbol{K}_{e}$，因为被积函数的最高多项式次数为2。**\n    **不正确。** 对于一个一般的、任意扭曲的单元，被积函数是一个有理函数，而不是多项式。没有有限的 Gauss-Legendre 法则能保证精确积分。其前提，即对于*任何*双线性四边形，被积函数都是一个2次多项式，是错误的。\n\n*   **C. 当映射为仿射（矩形或平行四边形）时，$2\\times 2$ Gauss 点可以精确积分 $\\boldsymbol{K}_{e}$，因为此时被积函数在每个自然坐标上是次数最高为2的多项式；对于一般的双线性（扭曲）映射，被积函数是有理函数，没有有限的张量积 Gauss–Legendre 法则能对所有此类单元都精确。**\n    **正确。** 该陈述准确地反映了推导出的结论。它正确地指出，对于仿射映射，被积函数在每个坐标上是次数为2的多项式，对此 $2 \\times 2$ 法则是精确且最小的。它还正确地说明，对于一般的扭曲单元，被积函数是一个有理函数，通常不能通过有限的 Gauss-Legendre 法则精确积分。\n\n*   **D. 需要 $3\\times 3$ Gauss 点才能对任何双线性四边形精确积分 $\\boldsymbol{K}_{e}$，因为即使对于仿射映射，被积函数也含有三次项。**\n    **不正确。** 其前提，即对于仿射映射，被积函数含有三次项，是错误的；它实际上是二次的。因此，$2 \\times 2$ 法则是足够的，而不需要 $3 \\times 3$ 法则（这是过度了）。此外，对于一般单元，没有有限的法则是精确的。", "answer": "$$\\boxed{C}$$", "id": "2651702"}, {"introduction": "在有限元分析的实际应用中，网格生成错误是问题的常见来源。本练习提供了一个假设但非常现实的情景：在定义一个单元的节点连接性时，意外地交换了两个节点的顺序。理解这种错误的后果对于诊断仿真失败至关重要，因为它将单元映射这一抽象概念与仿真结果中可观测到的非物理现象直接联系起来 [@problem_id:2405067]。", "problem": "考虑一个有界多边形域 $\\Omega \\subset \\mathbb{R}^2$ 上的二维标量扩散问题：求 $u$ 使得\n$-\\nabla \\cdot (k \\nabla u) = f$ 在 $\\Omega$ 中成立，其中在 $\\Gamma_D$ 上有狄利克雷边界条件 $u = \\bar{u}$，在 $\\Gamma_N$ 上有齐次诺伊曼边界条件 $k \\nabla u \\cdot n = 0$。这里 $\\Gamma_D \\cup \\Gamma_N = \\partial \\Omega$，$\\Gamma_D \\cap \\Gamma_N = \\emptyset$，$k > 0$ 是一个常数，且 $f$ 和 $\\bar{u}$ 是给定的足够光滑的数据。该问题使用有限元方法 (FEM) 进行离散化，采用双线性等参 $4$ 节点四边形单元 (Q$4$)，并在参考正方形上使用标准的逆时针局部节点排序 $\\{1,2,3,4\\}$。在一个大型网格中，一名学生意外地交换了单个单元的单元连接列表中的节点 $3$ 和 $4$，而所有节点的坐标保持不变。所有其他单元都保持标准排序，并且全局组装和求解过程在没有任何额外检查或网格修复的情况下进行。\n\n以下哪项最能描述这对计算解 $u_h$ 产生的局部影响？\n\nA. 在任何地方都没有影响，因为单元矩阵在局部节点编号的任何置换下都是不变的。\n\nB. 受影响的单元局部发生反转（雅可比行列式为负），导致刚度贡献的符号错误，从而在该单元附近产生非物理的扰动（例如，伪振荡或过冲），而远离该区域的解基本不受影响。\n\nC. 在整个域 $\\Omega$ 上，解 $u_h$ 被引入一个均匀的加性偏移，而各处的梯度保持不变。\n\nD. 节点交换引入了一个全局刚体模式，使得即使存在狄利克雷边界条件，$u_h$ 也会因一个常数而变得不确定，从而破坏了各处的解。", "solution": "首先必须验证问题陈述的科学性和逻辑完整性。\n\n**步骤 1：提取已知条件**\n- **控制方程：** 二维标量扩散方程，$-\\nabla \\cdot (k \\nabla u) = f$，定义在域 $\\Omega \\subset \\mathbb{R}^2$ 上。\n- **参数和数据：** 扩散系数 $k$ 是一个正常数。源项 $f$ 和狄利克雷数据 $\\bar{u}$ 是给定的且足够光滑。\n- **域和边界条件：** $\\Omega$ 是一个有界多边形域。边界 $\\partial \\Omega$ 被划分为狄利克雷部分 $\\Gamma_D$ 和诺伊曼部分 $\\Gamma_N$，其中 $\\Gamma_D \\cup \\Gamma_N = \\partial \\Omega$ 且 $\\Gamma_D \\cap \\Gamma_N = \\emptyset$。边界条件为在 $\\Gamma_D$ 上 $u = \\bar{u}$，在 $\\Gamma_N$ 上为齐次诺伊曼条件 $k \\nabla u \\cdot n = 0$。\n- **离散化方法：** 该问题使用有限元方法 (FEM) 进行离散化。\n- **单元类型：** 双线性等参 $4$ 节点四边形单元 (Q$4$)。\n- **标准节点排序：** 在参考正方形上，局部节点按逆时针 (CCW) 排序，例如 $\\{1,2,3,4\\}$。\n- **特定错误：** 在一个大型网格中，单个单元的局部节点连接被错误地指定为 $\\{1,2,4,3\\}$，即交换了节点 $3$ 和 $4$。节点坐标未改变。\n- **过程：** 使用这个错误的单元进行全局系统组装和求解，没有任何纠正措施。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题描述了一个经典的椭圆型偏微分方程（泊松/扩散方程）及其使用有限元方法的数值解法。等参四边形单元的使用、局部节点排序的概念、全局刚度矩阵的组装以及网格连接中可能出现的错误，都是计算工程和应用数学中标准的、基本的主题。该问题牢固地建立在公认的科学和工程原理之上。\n- **适定性：** 原始的边值问题是适定的，前提是狄利克雷边界 $\\Gamma_D$ 非空（这由 $u = \\bar{u}$ 的规定所暗示）。所提出的问题不是关于求解偏微分方程本身，而是关于预测数值实现中一个特定的、明确定义的错误的确定性后果。这是一个适定的问题。\n- **客观性：** 该问题使用有限元领域中精确、无歧义的技术术语进行描述。诸如“双线性等参”、“雅可比行列式”、“刚度贡献”和“节点排序”等术语具有清晰和标准的定义。该情景是客观的，没有主观解释的余地。\n\n**步骤 3：结论和行动**\n问题陈述在科学上是合理的、适定的和客观的。它不包含任何不一致之处、缺失数据或逻辑缺陷。这是一个计算工程中的有效问题。我将继续推导解答。\n\n**推导**\n\n等参公式的核心是从一个参考单元（一个具有局部坐标 $(\\xi, \\eta)$ 的正方形 $\\hat{\\Omega} = [-1,1] \\times [-1,1]$）到网格中的物理单元（具有全局坐标 $(x,y)$）的映射。对于一个 Q$4$ 单元，坐标使用与解变量 $u_h$ 相同的双线性形函数 $N_i(\\xi, \\eta)$ 进行插值：\n$$ x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i, \\quad y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i $$\n其中 $(x_i, y_i)$ 是物理单元节点的坐标。标准的逆时针 (CCW) 排序将节点 $1,2,3,4$ 分别与参考正方形的角点 $(-1,-1), (1,-1), (1,1), (-1,1)$ 相关联。\n\n变换的雅可比矩阵 $\\mathbf{J}$ 关联了两个坐标系之间的导数：\n$$ \\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} $$\n单元刚度矩阵 $K^e$ 涉及在物理单元面积上的积分，该积分被变换为在参考单元上的积分：\n$$ K_{ij}^e = \\int_{\\Omega_e} k (\\nabla N_i \\cdot \\nabla N_j) \\, dA = \\int_{\\hat{\\Omega}} k (\\nabla_{\\xi,\\eta} N_i)^T (\\mathbf{J}^{-1})^T (\\mathbf{J}^{-1}) (\\nabla_{\\xi,\\eta} N_j) \\, \\det(\\mathbf{J}) \\, d\\xi \\, d\\eta $$\n对于一个有效的映射，雅可比行列式 $\\det(\\mathbf{J})$ 必须在整个单元内严格为正。这确保了单元不会“折叠”或反转，并保持其方向。凸四边形节点的标准逆时针排序保证了 $\\det(\\mathbf{J}) > 0$。\n\n在有缺陷的单元中，学生在连接列表中交换了节点 $3$ 和 $4$。节点的物理坐标 $\\{ (x_1, y_1), (x_2, y_2), (x_3, y_3), (x_4, y_4) \\}$ 在空间中保持其正确的逆时针位置。然而，映射使用了错误的关联：\n$$ x(\\xi, \\eta) = N_1 x_1 + N_2 x_2 + N_3 x_4 + N_4 x_3 $$\n$$ y(\\xi, \\eta) = N_1 y_1 + N_2 y_2 + N_3 y_4 + N_4 y_3 $$\n标准节点 $1-2-3-4$ 沿四边形的周界。错误的排序 $1-2-4-3$ 从节点 $1$ 到 $2$，然后穿过对角线到节点 $4$，再沿着一条边到节点 $3$，最后穿过另一条对角线回到节点 $1$。这定义了一个自相交的“领结”形或“沙漏”形。从参考正方形到这种形状的映射必然涉及折叠。\n\n因此，雅可比行列式 $\\det(\\mathbf{J})$ 将不会处处为正。在单元的某些区域，$\\det(\\mathbf{J})$ 将为负。当使用数值积分计算单元刚度矩阵 $K^e$ 时，落在 $\\det(\\mathbf{J}) < 0$ 区域的积分点将以不正确的、反转的符号贡献给矩阵项。这导致了一个根本上有缺陷的单元刚度矩阵 $K^e_{bad}$，它可能不再是半正定的。\n\n当这个 $K^e_{bad}$ 被组装到全局刚度矩阵 $K$ 中时，它会破坏与受影响单元四个节点的自由度相对应的项。有限元系统是稀疏的，意味着一个节点只与其直接邻居耦合。因此，对矩阵 $K$ 的直接修改被局部化到一个小的子块中。全局系统 $K u_h = F$ 的解将被改变。由于算子的椭圆性质，由 $K$ 中的局部扰动引入的误差在有缺陷的单元处及其附近最为严重，并随着进入域内其他部分的距离而衰减。这与弹性力学中的 Saint-Venant 原理或离散拉普拉斯算子的格林函数的衰减特性相一致。由于数值模型试图满足由反转几何形状引起的不一致方程，预计局部解将表现出非物理行为，例如大的伪振荡或过冲。\n\n**逐项分析**\n\n**A. 在任何地方都没有影响，因为单元矩阵在局部节点编号的任何置换下都是不变的。**\n这种说法根本上是错误的。单元矩阵的推导明确依赖于映射的雅可比行列式，而雅可比行列式是由参考节点形函数和物理节点坐标的指定配对构建的。置换节点会改变这种配对，从而改变雅可比行列式，因此也改变了单元矩阵。不变性对于任意置换不成立。\n**结论：错误。**\n\n**B. 受影响的单元局部发生反转（雅可比行列式为负），导致刚度贡献的符号错误，从而在该单元附近产生非物理的扰动（例如，伪振荡或过冲），而远离该区域的解基本不受影响。**\n这个描述与分析预测的完全一致。节点交换产生了一个折叠的单元，导致雅可比行列式的符号改变。这通过引入符号错误的贡献来破坏单元刚度矩阵。有限元基函数的局部性确保了这种破坏直接影响全局矩阵的一小部分，导致解的误差局部化在有缺陷的单元周围，并表现为非物理的伪影。\n**结论：正确。**\n\n**C. 在整个域 $\\Omega$ 上，解 $u_h$ 被引入一个均匀的加性偏移，而各处的梯度保持不变。**\n这是不正确的。首先，在部分边界（$\\Gamma_D$）上存在狄利克雷边界条件，固定了那里的解值，从而阻止了在整个域上产生任何均匀的偏移。其次，刚度矩阵中的局部错误不会产生全局的、均匀的偏移。第三，局部解将是高度振荡的，这意味着梯度将受到严重且不正确的影响，而不是保持不变。\n**结论：错误。**\n\n**D. 节点交换引入了一个全局刚体模式，使得即使存在狄利克雷边界条件，$u_h$ 也会因一个常数而变得不确定，从而破坏了各处的解。**\n这是不正确的。全局刚体模式意味着全局刚度矩阵 $K$ 变得奇异，使得对于一个常数向量 $\\mathbf{c}$ 有 $K \\mathbf{c} = 0$。虽然有缺陷的单元刚度矩阵 $K^e_{bad}$ 可能是奇异或不定的，但它对全局矩阵 $K$（它是许多有效单元矩阵之和）的贡献的结构方式不会产生一个完美的全局刚体模式。此外，即使引入了这样的模式，狄利克雷边界条件也会适当地约束系统并消除这种不确定性。解被破坏了，但不是以所描述的特定方式。\n**结论：错误。**", "answer": "$$\\boxed{B}$$", "id": "2405067"}, {"introduction": "雅可比行列式 $J$ 为正是保证等参映射有效的必要条件。然而，在实践中我们如何验证这一条件？本练习挑战了一种常见的简化做法，即仅在数值积分点上检查雅可比行列式的符号。通过构建一个能够通过此简化检查但实际上无效的扭曲单元反例，您将对单元质量的微妙之处以及开发更稳健验证方法的必要性有更深刻的理解 [@problem_id:2651722]。", "problem": "给定一个二维四节点双线性等参四边形。节点的父（参考）坐标为 $(-1,-1)$、$(+1,-1)$、$(+1,+1)$ 和 $(-1,+1)$，并使用标准的双线性等参形函数将父坐标 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 映射到物理坐标 $(x,y)$。等参映射定义为 $x(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)X_i$ 和 $y(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)Y_i$，其中 $(X_i,Y_i)$ 是节点的物理坐标。此映射的雅可比行列式 $J(\\xi,\\eta)$ 定义为 $J=\\det\\left(\\partial(x,y)/\\partial(\\xi,\\eta)\\right)$，它控制父单元和物理单元之间的局部面积缩放。\n\n考虑以下物理节点坐标（节点顺序与上文相同）：\n- $Y_1=-1$, $Y_2=-1$, $Y_3=+1$, $Y_4=+1$,\n- $X_1=\\tfrac{1}{2}$, $X_2=-\\tfrac{1}{2}$, $X_3=\\tfrac{5}{2}$, $X_4=-\\tfrac{5}{2}$。\n\n从等参映射和雅可比行列式的定义出发，执行以下操作：\n1. 推导 $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$ 的显式表达式。\n2. 推导雅可比行列式 $J(\\xi,\\eta)$。\n3. 在四个两点高斯积分 (GQ) 位置 $(\\xi,\\eta)=(\\pm 1/\\sqrt{3},\\pm 1/\\sqrt{3})$ 处计算 $J(\\xi,\\eta)$ 的值，并验证其在这些点处的符号。\n4. 在内点 $(\\xi,\\eta)=(0,-\\tfrac{4}{5})$ 处计算 $J(\\xi,\\eta)$ 的值，证明映射在此处发生局部反转，并报告该值。\n\n简要解释您的发现对于仅在GQ点测试 $J>0$ 的单元质量检查的可靠性有何影响。为便于评分，请仅提供在 $(\\xi,\\eta)=(0,-\\tfrac{4}{5})$ 处计算出的 $J$ 值作为最终答案。无需四舍五入，$J$ 没有物理单位。", "solution": "该问题陈述已经过验证，并且被认为是科学上合理的、适定的、客观的且内部一致的。它代表了有限元方法中一个标准的、尽管是精心构建的练习，用以测试对等参映射和单元质量度量的理解。该问题是有效的，将提供解答。\n\n四节点双线性等参单元利用形函数 $N_i(\\xi, \\eta)$ 从父域 $(\\xi, \\eta) \\in [-1,1] \\times [-1,1]$ 映射到物理域 $(x,y)$。按标准顺序，节点1, 2, 3, 4的形函数为：\n$$N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$$\n$$N_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$$\n$$N_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$$\n$$N_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$$\n\n给定的物理节点坐标 $(X_i, Y_i)$ 为：\n节点 1: $(X_1, Y_1) = (\\frac{1}{2}, -1)$\n节点 2: $(X_2, Y_2) = (-\\frac{1}{2}, -1)$\n节点 3: $(X_3, Y_3) = (\\frac{5}{2}, 1)$\n节点 4: $(X_4, Y_4) = (-\\frac{5}{2}, 1)$\n\n**1. $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$ 的推导**\n\n等参映射定义为 $x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) X_i$ 和 $y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) Y_i$。\n\n首先，我们推导 $y$ 坐标的表达式：\n$$y(\\xi,\\eta) = N_1(-1) + N_2(-1) + N_3(1) + N_4(1)$$\n$$y(\\xi,\\eta) = \\frac{1}{4} [ -1(1-\\xi)(1-\\eta) - 1(1+\\xi)(1-\\eta) + 1(1+\\xi)(1+\\eta) + 1(1-\\xi)(1+\\eta) ]$$\n$$y(\\xi,\\eta) = \\frac{1}{4} [ -(1-\\eta)( (1-\\xi) + (1+\\xi) ) + (1+\\eta)( (1+\\xi) + (1-\\xi) ) ]$$\n$$y(\\xi,\\eta) = \\frac{1}{4} [ -2(1-\\eta) + 2(1+\\eta) ] = \\frac{1}{2} [ -1+\\eta + 1+\\eta ] = \\frac{1}{2}(2\\eta) = \\eta$$\n因此，$y$ 坐标的映射就是简单的 $y(\\xi,\\eta) = \\eta$。\n\n接下来，我们推导 $x$ 坐标的表达式：\n$$x(\\xi,\\eta) = N_1 X_1 + N_2 X_2 + N_3 X_3 + N_4 X_4$$\n$$x(\\xi,\\eta) = \\frac{1}{4} [ (\\frac{1}{2})(1-\\xi)(1-\\eta) + (-\\frac{1}{2})(1+\\xi)(1-\\eta) + (\\frac{5}{2})(1+\\xi)(1+\\eta) + (-\\frac{5}{2})(1-\\xi)(1+\\eta) ]$$\n提出因子 $\\frac{1}{8}$：\n$$x(\\xi,\\eta) = \\frac{1}{8} [ (1-\\xi)(1-\\eta) - (1+\\xi)(1-\\eta) + 5(1+\\xi)(1+\\eta) - 5(1-\\xi)(1+\\eta) ]$$\n$$x(\\xi,\\eta) = \\frac{1}{8} [ (1-\\eta)((1-\\xi)-(1+\\xi)) + 5(1+\\eta)((1+\\xi)-(1-\\xi)) ]$$\n$$x(\\xi,\\eta) = \\frac{1}{8} [ (1-\\eta)(-2\\xi) + 5(1+\\eta)(2\\xi) ]$$\n$$x(\\xi,\\eta) = \\frac{2\\xi}{8} [ -(1-\\eta) + 5(1+\\eta) ] = \\frac{\\xi}{4} [ -1+\\eta+5+5\\eta ] = \\frac{\\xi}{4}(4+6\\eta)$$\n$$x(\\xi,\\eta) = \\xi(1+\\frac{3}{2}\\eta)$$\n\n映射的显式表达式为 $x(\\xi,\\eta) = \\xi(1+\\frac{3}{2}\\eta)$ 和 $y(\\xi,\\eta)=\\eta$。\n\n**2. 雅可比行列式 $J(\\xi,\\eta)$ 的推导**\n\n该映射的雅可比矩阵为 $\\mathbf{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}$。\n偏导数为：\n$$\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( \\xi + \\frac{3}{2}\\xi\\eta \\right) = 1 + \\frac{3}{2}\\eta$$\n$$\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( \\xi + \\frac{3}{2}\\xi\\eta \\right) = \\frac{3}{2}\\xi$$\n$$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} (\\eta) = 0$$\n$$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} (\\eta) = 1$$\n\n雅可比矩阵为：\n$$\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} 1 + \\frac{3}{2}\\eta & \\frac{3}{2}\\xi \\\\ 0 & 1 \\end{pmatrix}$$\n雅可比行列式，$J(\\xi,\\eta) = \\det(\\mathbf{J})$，为：\n$$J(\\xi,\\eta) = (1 + \\frac{3}{2}\\eta)(1) - (\\frac{3}{2}\\xi)(0) = 1 + \\frac{3}{2}\\eta$$\n\n**3. 在高斯积分点处计算 $J$**\n\n四个两点高斯积分 (GQ) 位置是 $(\\xi,\\eta) = (\\pm \\frac{1}{\\sqrt{3}}, \\pm \\frac{1}{\\sqrt{3}})$。由于 $J$ 仅依赖于 $\\eta$，我们只需对 $\\eta = \\pm \\frac{1}{\\sqrt{3}}$ 进行计算。\n\n对于 $\\eta = +\\frac{1}{\\sqrt{3}}$：\n$$J = 1 + \\frac{3}{2}\\left(\\frac{1}{\\sqrt{3}}\\right) = 1 + \\frac{\\sqrt{3}}{2}$$\n由于 $\\sqrt{3} \\approx 1.732$, $J \\approx 1 + 0.866 = 1.866 > 0$。\n\n对于 $\\eta = -\\frac{1}{\\sqrt{3}}$：\n$$J = 1 + \\frac{3}{2}\\left(-\\frac{1}{\\sqrt{3}}\\right) = 1 - \\frac{\\sqrt{3}}{2}$$\n由于 $\\frac{\\sqrt{3}}{2} \\approx 0.866 < 1$, $J \\approx 1 - 0.866 = 0.134 > 0$。\n\n在所有四个GQ点，雅可比行列式均为正。该单元将通过基于在这些点上进行评估的标准质量检查。\n\n**4. 在 $(\\xi,\\eta)=(0,-\\frac{4}{5})$ 处计算 $J$**\n\n我们现在在指定的内点 $(\\xi,\\eta)=(0, -\\frac{4}{5})$ 处计算雅可比行列式。\n$$J\\left(0, -\\frac{4}{5}\\right) = 1 + \\frac{3}{2}\\eta = 1 + \\frac{3}{2}\\left(-\\frac{4}{5}\\right) = 1 - \\frac{12}{10} = 1 - \\frac{6}{5} = \\frac{5}{5} - \\frac{6}{5} = -\\frac{1}{5}$$\n在该点，雅可比行列式为负， $J = -\\frac{1}{5}$。这表明等参映射在单元内部的一个区域发生了局部反转（即，它自身发生了折叠）。\n\n**对单元质量检查的影响**\n\n主要影响是，仅仅依赖在标准高斯积分点检查 $J > 0$ 是一种不充分且不可靠的方法，无法确保在整个父域上单元几何形状有效且非退化。单元矩阵的数值积分方案通常是通过对GQ点处的加权函数求值进行求和来实现的。如果在这些点上 $J > 0$，数值积分程序将无错误地执行，有限元代码很可能会接受该单元。然而，如此处所示，存在 $J \\le 0$ 的区域，意味着违反了从父单元到物理单元的一对一映射的基本要求。这在物理上意味着单元几何形状是“纠缠”或“反转”的。尽管在组装阶段没有计算错误，但使用此类单元进行的分析将产生物理上无意义的结果。\n\n此问题说明，对于扭曲的单元，特别是非凸或“领结”形状的单元，需要更鲁棒的质量检查。对于双线性四边形，雅可比行列式 $J(\\xi, \\eta)$ 是 $\\xi$ 和 $\\eta$ 的线性函数。因此，其极值必须出现在父域的角点 $(\\xi, \\eta) \\in \\{(-1,-1), (1,-1), (1,1), (-1,1)\\}$ 处。对此类单元，一个充分的检查是验证雅可比行列式在所有四个角节点处均为正。在本例中，由于 $J = 1 + \\frac{3}{2}\\eta$，最小值出现在 $\\eta=-1$ 处，此时 $J = 1 - \\frac{3}{2} = -\\frac{1}{2}$。这证实了单元的一部分是无效的，而仅在GQ点进行检查会忽略这一事实。", "answer": "$$\\boxed{-\\frac{1}{5}}$$", "id": "2651722"}]}