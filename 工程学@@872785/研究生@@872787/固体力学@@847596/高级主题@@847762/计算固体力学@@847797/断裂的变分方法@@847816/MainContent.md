## 引言
预测材料和结构中的裂纹如何萌生和扩展，是工程与科学领域一个长期存在的挑战。传统的[断裂力学](@entry_id:141480)方法在处理复杂的裂纹路径、[分叉](@entry_id:270606)和三维问题时面临巨大困难。断裂的[变分方法](@entry_id:163656)为此提供了一个强大而统一的理论框架，它将断裂过程重新表述为一个能量最小化问题，从而绕开了追踪[裂纹尖端奇异性](@entry_id:171868)的难题。这种能量视角不仅在理论上更为优雅，也为强大的数值模拟技术铺平了道路。本文旨在系统性地介绍这一深刻而实用的方法。

在接下来的内容中，我们将分三章深入探讨断裂的[变分方法](@entry_id:163656)：
- **第一章：原理与机制** 将奠定理论基础，从 Griffith 的[能量平衡](@entry_id:150831)准则出发，介绍 Francfort 和 Marigo 发展的严谨变分框架，并重点阐述作为现代[计算断裂力学](@entry_id:203605)核心的相场[正则化方法](@entry_id:150559)。
- **第二章：应用与[交叉](@entry_id:147634)学科联系** 将展示该框架的广泛适用性，探讨其如何用于预测工程强度、分析混合模式与各向异性断裂，以及处理与塑性、动力学和[流体流动](@entry_id:201019)等[多物理场](@entry_id:164478)的复杂耦合问题。
- **第三章：动手实践** 将通过一系列精心设计的编程练习，引导读者从零开始构建一个一维[相场断裂](@entry_id:178059)模拟器，将理论知识转化为实际的计算能力。

通过本次学习，读者将能够掌握从基本能量原理到前沿计算实现的全过程，为解决复杂的断裂力学问题打下坚实的基础。让我们首先从其核心原理与机制开始。

## 原理与机制

在上一章中，我们介绍了断裂力学中[变分方法](@entry_id:163656)的思想背景。本章我们将深入探讨其核心原理与关键机制，从尖锐裂纹的[能量表述](@entry_id:199250)开始，逐步过渡到作为现代[计算断裂力学](@entry_id:203605)基石的相场[正则化方法](@entry_id:150559)。

### [脆性断裂](@entry_id:158949)的能量原理：尖锐裂纹模型

[变分断裂力学](@entry_id:196925)的核心思想源于 Griffith 的[能量平衡](@entry_id:150831)准则，该准则被 Francfort 和 Marigo 推广并置于一个严谨的变分框架中。该理论假设，一个含有裂纹的弹性体的平衡构型是其总势能达到最小值的构型。

对于一个占据有界区域 $\Omega \subset \mathbb{R}^d$ 的弹性体，其构型由[位移场](@entry_id:141476) $u$ 和裂纹集 $\Gamma$ 共同描述。总势能泛函 $\Pi(u, \Gamma)$ 由三个基本部分组成 [@problem_id:2709367]：

$$
\Pi(u,\Gamma) = \int_{\Omega \setminus \Gamma} \psi(\varepsilon(u))\, \mathrm{d}x - \int_{\partial_N \Omega} t \cdot u \, \mathrm{d}s + G_c \mathcal{H}^{d-1}(\Gamma)
$$

让我们逐一剖析这个泛函的构成：

1.  **储存的弹性应变能**：第一项 $\int_{\Omega \setminus \Gamma} \psi(\varepsilon(u))\, \mathrm{d}x$ 代表了物体未开裂部分储存的弹性应变能。在这里，$\psi$ 是弹性应变能密度，对于线性弹性小应变材料，其形式为 $\psi(\varepsilon(u)) = \frac{1}{2}\varepsilon(u) : \mathbb{C} : \varepsilon(u)$，其中 $\varepsilon(u) = \frac{1}{2}(\nabla u + \nabla u^\top)$ 是[无穷小应变张量](@entry_id:167211)，$\mathbb{C}$ 是[四阶弹性张量](@entry_id:188318)。积分区域是 $\Omega \setminus \Gamma$，即整个物体区域除去裂纹，因为裂纹本身不储存弹性变形能。

2.  **外加载荷的势能**：第二项 $- \int_{\partial_N \Omega} t \cdot u \, \mathrm{d}s$ 代表了施加在Neumann边界 $\partial_N \Omega$ 上的外载荷 $t$ 所做的功的负值。根据[最小势能原理](@entry_id:173340)，保守外力的势能是其所做功的相反数，因此这里的负号至关重要 [@problem_id:2709367]。如果存在体力 $b$，则该项还应包含 $- \int_{\Omega} b \cdot u \, \mathrm{d}x$ [@problem_id:2667954]。

3.  **断裂[表面能](@entry_id:161228)**：第三项 $G_c \mathcal{H}^{d-1}(\Gamma)$ 是 Griffith 理论的核心，代表了形成裂纹表面所消耗的能量。**$G_c$** 是一个材料常数，称为**临界[能量释放率](@entry_id:158357)**或**[断裂韧性](@entry_id:157609)**，其单位是能量/面积（例如 $J/m^2$）。它量化了创造单位面积新表面所需的能量。**$\mathcal{H}^{d-1}(\Gamma)$** 是裂纹集 $\Gamma$ 的 $(d-1)$ 维 **Hausdorff 测度**，在三维空间 ($d=3$) 中它就是裂纹的面积，在二维空间 ($d=2$) 中则是裂纹的长度。Hausdorff 测度为描述可能具有复杂几何形状的裂纹提供了一个严谨的数学工具 [@problem_id:2709367]。

这个能量泛函与图像处理领域的 **Mumford-Shah 泛函** 有着深刻的类比关系。Mumford-Shah 泛函旨在通过惩罚图像梯度的平方和跳跃集（边缘）的长度来分割图像，其形式为 $\mathcal{F}(u,\Gamma) = \int_{\Omega\setminus\Gamma}|\nabla u|^2\,dx + \alpha \mathcal{H}^{d-1}(\Gamma)$。在力学中，梯度平方项被更普适的[弹性应变能](@entry_id:202243)密度 $\psi(\varepsilon(u))$ 替代，而惩罚参数 $\alpha$ 则对应于物理量 $G_c$ [@problem_id:2709394]。

一个关键的数学问题是确定位移 $u$ 和裂纹 $\Gamma$ 的合理函数空间。由于裂纹的定义就是位移的不连续，标准的 Sobolev 空间如 $H^1(\Omega)$ 是不适用的，因为该空间中的函数不允许跨越 $(d-1)$ 维集合的跳跃不连续。正确的[函数空间](@entry_id:143478)必须能够同时描述连续变形和尖锐断裂。**特殊有界变分函数空间** ($SBV(\Omega; \mathbb{R}^d)$) 正是为此而生。一个 $SBV$ 函数的[分布导数](@entry_id:181138) $Du$ 可以被唯一地分解为一个对应于体变形的绝对连续部分 $\nabla u \mathcal{L}^d$ 和一个对应于裂纹跳跃的奇异部分 $(u^+ - u^-)\otimes \nu_u \mathcal{H}^{d-1}\llcorner J_u$。重要的是，$SBV$ 函数排除了不对应物理裂纹的“康托尔(Cantor)”部分，使得函数的“奇异性”完全由可求测度的跳跃集 $J_u$ 来描述。这与 Griffith 能量泛函的形式完美契合，因为它只惩罚了体应变能和跳跃集的面积。因此，$SBV$ 空间为尖锐裂纹的变分提法提供了自然的数学框架 [@problem_id:2709412]。

### 变分原理的推论

通过最小化总势能泛函，我们可以推导出断裂力学的一系列基本方程和准则，而无需预先假设裂纹的行为。

#### 平衡与裂纹面条件

对于一个给定的裂纹几何 $\Gamma$，平衡[位移场](@entry_id:141476) $u$ 应使能量泛函 $\Pi(u, \Gamma)$ 达到最小。通过计算泛函对 $u$ 的一阶变分（Gâteaux 导数）并令其为零，我们可以得到系统的[平衡方程](@entry_id:172166)。这个过程自然地导出了弹性力学的标准控制方程和边界条件 [@problem_id:2709367] [@problem_id:2709394]：
- 在未开裂的体内 ($\Omega \setminus \Gamma$)，应力散度为零：$\mathrm{div}\,\sigma = 0$。
- 在 Neumann 边界 $\partial_N \Omega$ 上，应力张量与法向的[点积](@entry_id:149019)等于施加的面力：$\sigma n = t$。
- 一个至关重要的结果是，在裂纹表面 $\Gamma$ 上，自然边界条件是**牵[引力](@entry_id:175476)自由**（traction-free），即 $\sigma n = 0$。这是因为泛函中没有与裂纹表面上的外力相关的项。这表明，[变分原理](@entry_id:198028)自动包含了裂纹面是自由的这一物理事实。

#### 裂纹扩展准则与尺寸效应

变分原理不仅给出平衡方程，还能预测裂纹是否会扩展。考虑能量对裂纹集 $\Gamma$ 本身的变分，可以得到[裂纹扩展](@entry_id:749562)的驱动力。这与经典的**[能量释放率](@entry_id:158357)** $G$ 直接相关，$G$ 定义为裂纹扩展单位面积时系统势能的减少量。当 $G$ 达到材料的临界值 $G_c$ 时，裂纹扩展变得能量上有利。[最小化原理](@entry_id:169952)蕴含了 Griffith 准则：裂纹在 $G \ge G_c$ 时扩展 [@problem_id:2709394]。

变分公式还直接揭示了[脆性断裂](@entry_id:158949)中的**尺寸效应**。考虑一个几何相似的结构，其特征尺寸缩放因子为 $\lambda$。在相似的载荷条件下，其储存的体弹性应变能与体积成正比，因此与 $\lambda^d$ 成正比。然而，形成一个相对尺寸相同的裂纹所需的表面能则与面积成正比，即与 $\lambda^{d-1}$ 成正比。当结构尺寸 $\lambda$ 增大时，体能的增长速度快于[表面能](@entry_id:161228)。这意味着，大尺寸结构储存的[弹性应变](@entry_id:189634)更容易超过形成新裂纹所需的能量，因此它们表现得更“脆” [@problem_id:2709394]。

#### 准静态演化与不[可逆性](@entry_id:143146)

在随时间变化的载荷下，裂纹的演化可以被看作是一系列准静态平衡状态的序列。Francfort-Marigo 演化准则指出，在每个时间步 $t_k$，系统会寻找一个新的构型 $(u_k, \Gamma_k)$ 来最小化该时刻的总势能 $\Pi(u_k, \Gamma_k)$。然而，这个最小化过程必须受到一个关键的物理约束：**断裂的不[可逆性](@entry_id:143146)**。物理上，裂纹不能自愈。这个约束在数学上表示为裂纹集的单调增长：$\Gamma_{k-1} \subseteq \Gamma_k$。因此，在第 $k$ 步的求解是在所有包含前一步裂纹集 $\Gamma_{k-1}$ 的候选裂纹集 $\Gamma$ 中寻找能量的最小值。这个不[可逆性](@entry_id:143146)条件是作为对[可行解](@entry_id:634783)集的约束引入的，而不是通过修改能量泛函本身 [@problem_id:2667954] [@problem_id:2709367]。

### 正则化：相场方法

尽管尖锐裂纹模型在理论上极其优美，但从计算角度看，它带来了巨大挑战。在数值模拟中，显式地追踪一个几何形状任意复杂的移动边界（裂纹）是一项非常困难的任务。为了克服这一困难，研究者们发展了**相场（phase-field）方法**，它用一个连续的辅助场——**相场变量** $d(\mathbf{x})$——来“弥散”或“正则化”尖锐的裂纹界面。

在[相场模型](@entry_id:202885)中，$d$ 是一个[标量场](@entry_id:151443)，其值在 $[0, 1]$ 区间内变化。约定 $d=0$ 代表完全完整的材料，而 $d=1$ 代表完全断裂的材料。介于两者之间的值则表示部分损伤。这样，一个尖锐的裂纹就被一个宽度有限的、光滑过渡的损伤带所替代。

相应的，总势能泛函也被重写为一个依赖于位移场 $u$ 和相场 $d$ 的积分形式：

$$
\mathcal{E}(u,d) = \int_{\Omega} g(d) \psi_0(\varepsilon(u)) \, \mathrm{d}V + \int_{\Omega} G_c \left( \frac{w(d)}{\ell} + \ell |\nabla d|^2 \right) \mathrm{d}V
$$

这里，$\psi_0$ 是未损伤材料的[应变能密度](@entry_id:200085)。这个泛函包含两个核心部分：

1.  **退化的[弹性应变能](@entry_id:202243)**：第一项描述了材料的弹性行为如何随着损伤而减弱。**$g(d)$** 是一个**退化函数**，通常是一个从 $g(0)=1$（无损）单调递减到 $g(1)=0$（或一个很小的残余值 $\kappa > 0$ 以保证[数值稳定性](@entry_id:146550)）的函数。这意味着随着损伤场 $d$ 的增加，材料的承载能力（刚度）逐渐降低。

2.  **正则化的断裂表面能**：第二项是对 Griffith [表面能](@entry_id:161228)的正则化近似。它本身由两部分竞争构成：一个“势能”项 $\frac{w(d)}{\ell}$ 和一个“梯度”项 $\ell |\nabla d|^2$。
    - $w(d)$ 是一个[势函数](@entry_id:176105)，它惩罚 $d \ne 0$ 的状态，通常满足 $w(0)=0$ 和 $w(1)>0$。
    - **$\ell$** 是一个**内部长度[尺度参数](@entry_id:268705)**，它具有长度的量纲，并控制着弥散裂纹带的**宽度**。梯度项 $\ell |\nabla d|^2$ 惩罚相场的剧烈空间变化，倾向于使过渡带变宽；而势能项 $\frac{w(d)}{\ell}$ 则惩罚过渡带的存在，倾向于使其变窄。这两项的平衡导致了一个特征宽度正比于 $\ell$ 的稳定过渡剖面 [@problem_id:2709416]。
    - 关键在于，通过对该项进行适当的**校准**（即选择合适的[势函数](@entry_id:176105) $w(d)$ 和相关常数），可以使得一个一维过渡剖面所包含的总[断裂能](@entry_id:174458)恰好等于 $G_c$，并且这个总能量与 $\ell$ 的取值无关 [@problem_id:2487758] [@problem_id:2709416]。

相场方法的数学基础是 **$\Gamma$-收敛**理论。它严格证明了，在长度[尺度参数](@entry_id:268705) $\ell \to 0$ 的极限下，相场能量泛函 $\mathcal{E}(u,d)$ 会收敛到原始的 Griffith 尖锐裂纹[能量泛函](@entry_id:170311) $\Pi(u, \Gamma)$。同时，相场能量的最小化解也会收敛到尖锐裂纹问题的解。这为[相场模型](@entry_id:202885)作为 Griffith 理论的一个有效近似提供了坚实的数学保障 [@problem_id:2709368] [@problem_id:2667993]。

### [相场模型](@entry_id:202885)的关键要素与选择

构建一个有效的[相场模型](@entry_id:202885)需要在几个关键点上做出选择，这些选择会影响模型的物理行为。

#### 退化函数 $g(d)$ 与[势函数](@entry_id:176105) $w(d)$

退化函数 $g(d)$ 的具体形式（例如，线性函数 $g(d)=1-d$ 或二次函数 $g(d)=(1-d)^2$）是一个建模选择。只要它满足基本条件（单调性、 $g(0)=1$、 $g(1)=0$），$\Gamma$-[收敛理论](@entry_id:176137)就能保证在 $\ell \to 0$ 时模型会趋向于具有断裂韧性 $G_c$ 的 Griffith 断裂。不同的 $g(d)$ 形式主要影响在有限长度尺度 $\ell$ 下，损伤过程区的应力-应变响应，但不会改变极限情况下的总耗散能 [@problem_id:2487758]。

相比之下，势函数 $w(d)$ 的选择对材料的**[裂纹萌生](@entry_id:748035)**行为有质的影响。考虑两种经典的 Ambrosio-Tortorelli (AT) 模型 [@problem_id:2709417]：
- **AT1 模型**：$w(d) = d$。在这种情况下，损伤的“能量壁垒”在 $d=0$ 处具有非零的斜率。这意味着，只有当[弹性应变能](@entry_id:202243)密度 $\psi_0$ 达到一个有限的临界值时，系统总能量对 $d$ 的导数才会变为负，损伤才会开始萌生。因此，AT1 模型描述了一种具有**有限萌生应力**的材料，其临界应力 $\sigma_c$ 正比于 $\sqrt{E G_c / \ell}$。
- **AT2 模型**：$w(d) = d^2/2$。在这种情况下，$w'(0)=0$，导致损伤的能量壁垒在 $d=0$ 处是平坦的。只要有任意小的载荷（即 $\psi_0 > 0$），系统总能量对 $d$ 的导数在 $d=0$ 处就是负的。这意味着损伤会立即开始累积，没有[弹塑性](@entry_id:193198)极限。因此，AT2 模型描述了一种**无萌生阈值**的理想脆性材料。

#### [拉压不对称性](@entry_id:201728)

标准的[相场模型](@entry_id:202885)中，退化函数 $g(d)$ 对整个[弹性应变能](@entry_id:202243) $\psi_0$ 起作用，这意味着材料在拉伸和压缩下的刚度都会同样退化。这在物理上是不合理的：在压缩状态下，裂纹面会闭合，材料应能继续承载压应力。直接应用对称模型会导致在纯压缩下产生不真实的损伤和破坏。

为了解决这个问题，需要引入**[拉压不对称性](@entry_id:201728)**。一个行之有效的方法是对弹性应变能进行**[能量分解](@entry_id:193582)**，将其分解为拉伸部分 $\psi_0^+$ 和压缩部分 $\psi_0^-$，并只让退化函数作用于拉伸部分。即，总的[应变能密度](@entry_id:200085)写为 $g(d)\psi_0^+ + \psi_0^-$。

一个常用的分解方法是基于[应变张量](@entry_id:193332) $\varepsilon$ 的谱分解（主[应变分解](@entry_id:186005)）[@problem_id:2709373]。例如，Miehe 等人提出的分解方式定义为：
$$
\psi_0^+(\varepsilon) = \frac{1}{2}\lambda \langle \mathrm{tr}\,\varepsilon \rangle_+^2 + \mu \varepsilon^+ : \varepsilon^+
$$
$$
\psi_0^-(\varepsilon) = \frac{1}{2}\lambda \langle \mathrm{tr}\,\varepsilon \rangle_-^2 + \mu \varepsilon^- : \varepsilon^-
$$
其中，$\langle x \rangle_\pm$ 是 Macaulay 括号，代表取正/负部分，而 $\varepsilon^\pm$ 是通过对[主应变](@entry_id:197797)取正/负部分后重构的[应变张量](@entry_id:193332)。这种分解保证了 $\psi_0^+ + \psi_0^- = \psi_0$，并且在纯压缩状态（所有主应均为非正）下，$\psi_0^+ = 0$。因此，损伤的驱动力（与 $\psi_0^+$ 成正比）在纯压缩下为零，从而阻止了不真实的裂纹扩展。

### 求解演化问题

相场方法的巨大优势在于它将复杂的裂纹追踪问题转化为了求解两个耦合场（$u$ 和 $d$）的[偏微分方程组](@entry_id:172573)的问题，这可以用标准的有限元方法等工具高效解决。

#### 复杂裂纹路径的预测

变分方法最吸引人的特点之一是它能够**自然地预测复杂的裂纹模式**，包括裂纹的萌生、扩展、分叉和合并，而无需任何额外的、基于经验的[裂纹扩展](@entry_id:749562)方向准则（如最大周向应力准则）。这是因为整个过程被归结为一个全局能量最小化问题。在每个加载步，系统会自动寻找一个能最有效地释放能量的损伤[分布](@entry_id:182848) $d(\mathbf{x})$。裂纹路径是[能量最小化](@entry_id:147698)的一个**结果**，而不是一个预设的输入。从更深层次的物理角度看，这等价于裂纹前缘在材料**[构型力](@entry_id:188113)**（configurational forces）的驱动下运动 [@problem_id:2667993]。

#### 不可逆性与增量求解

与尖锐裂纹模型一样，[相场模型](@entry_id:202885)中的准静态演化也必须强制执行**断裂不[可逆性](@entry_id:143146)**的物理约束。在相场框架下，这表现为损伤场 $d$ 随时间只能单调不减，即 $\frac{\partial d}{\partial t} \ge 0$。

在时间离散的增量求解方案中，假设在 $t_{n-1}$ 时刻的损伤场为 $d^{n-1}$，那么在 $t_n$ 时刻求解时，必须施加一个逐点的约束 $d^n(\mathbf{x}) \ge d^{n-1}(\mathbf{x})$。这使得每一步的求解都成为一个**[约束优化](@entry_id:635027)问题**。该问题的解，即 $(u^n, d^n)$，必须满足一个**[变分不等式](@entry_id:172788)** [@problem_id:2709388]：
$$
\langle \partial_d \Pi(t_n;u^n,d^n), \tilde{d} - d^n \rangle \ge 0, \quad \forall \tilde{d} \in \mathcal{K}^n
$$
其中 $\mathcal{K}^n = \{ d \in H^1(\Omega) \mid d(\mathbf{x}) \ge d^{n-1}(\mathbf{x}) \text{ a.e.} \}$ 是当前步的可行损伤场集合。在数值实现中，这通常通过引入 Lagrange 乘子（KKT 条件）或使用罚函数法等算法来处理。这个不[可逆性](@entry_id:143146)约束对于获得物理上真实的加载-卸载响应和[能量耗散](@entry_id:147406)至关重要。