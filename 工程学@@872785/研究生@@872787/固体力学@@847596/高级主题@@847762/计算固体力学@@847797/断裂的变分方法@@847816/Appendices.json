{"hands_on_practices": [{"introduction": "在深入研究复杂的数值实现之前，理解简单情境下的解析解至关重要。这项练习 [@problem_id:2709354] 旨在通过推导经典的一维稳态相场解，来揭示相场模型中关键参数的物理意义。通过求解，你将亲身体会正则化长度 $\\ell$ 如何定义裂纹的弥散宽度，以及模型如何与宏观断裂韧度 $G_c$ 相关联，这是连接微观模型与宏观断裂力学性能的关键一步。", "problem": "考虑一个用于脆性断裂的变分相场描述的一维、面外单位厚度设定。令 $d(x)$ 表示一个损伤类型的相场变量，其中 $d(x)\\in[0,1]$，$d(x)=1$ 表示完全发展的裂纹，$d(x)\\to 0$ 表示远离裂纹的完整材料。单位面外厚度的断裂表面能由以下公式建模：\n$$\n\\mathcal{E}_{\\Gamma}[d] \\;=\\; G_{c}\\,\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}\\!\\left(d(x),d'(x)\\right)\\,\\mathrm{d}x,\n$$\n其中简化的裂纹表面密度为\n$$\n\\gamma_{\\ell}(d,d') \\;=\\; \\frac{1}{c_{0}}\\,\\bigg[\\,\\frac{1}{2\\,\\ell}\\,d^{2} \\;+\\; \\frac{\\ell}{2}\\,\\big(d'\\big)^{2}\\,\\bigg],\n$$\n其中 $G_{c}$ 是临界能量释放率，$\\ell>0$ 是内禀长度，而 $c_{0}>0$ 是一个待通过校准确定的无量纲归一化常数。\n\n假设一个以 $x=0$ 为中心的稳态偶函数相场分布，它满足 $d(0)=1$，当 $|x|\\to\\infty$ 时 $d(x)\\to 0$，并由下式给出：\n$$\nd(x) \\;=\\; \\exp\\!\\big(-|x|/\\ell\\big).\n$$\n\n从上述泛函的变分法出发，并使用孤立裂纹在无穷远处的标准边界条件，计算与此分布相关的断裂表面能，并确定使 $\\mathcal{E}_{\\Gamma}[d]=G_{c}$ 所需的 $c_{0}$ 值，即与单个完全发展的裂纹相关的能量等于 $G_{c}$。请以 $c_{0}$ 的单个闭式值的形式给出最终答案。无需四舍五入，也无需报告 $c_{0}$ 的物理单位。", "solution": "起点是断裂表面能泛函\n$$\n\\mathcal{E}_{\\Gamma}[d] \\;=\\; G_{c}\\,\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}(d,d')\\,\\mathrm{d}x,\n\\quad\n\\gamma_{\\ell}(d,d') \\;=\\; \\frac{1}{c_{0}}\\left[\\frac{1}{2\\,\\ell}\\,d^{2} + \\frac{\\ell}{2}\\,(d')^{2}\\right].\n$$\n一个稳态分布 $d(x)$ 满足与被积函数 $f(d,d')$ 相关的欧拉-拉格朗日方程：\n$$\nf(d,d') \\;=\\; \\frac{1}{2\\,\\ell}\\,d^{2} + \\frac{\\ell}{2}\\,(d')^{2}.\n$$\n计算一阶变分：\n$$\n\\frac{\\partial f}{\\partial d} \\;=\\; \\frac{d}{\\ell},\n\\qquad\n\\frac{\\partial f}{\\partial d'} \\;=\\; \\ell\\,d'.\n$$\n因此，在 $d$ 光滑的任何区间上，欧拉-拉格朗日方程为\n$$\n\\frac{\\partial f}{\\partial d} \\;-\\; \\frac{\\mathrm{d}}{\\mathrm{d}x}\\!\\left(\\frac{\\partial f}{\\partial d'}\\right) \\;=\\; 0\n\\;\\;\\Longrightarrow\\;\\;\n\\frac{d}{\\ell} \\;-\\; \\frac{\\mathrm{d}}{\\mathrm{d}x}\\!\\left(\\ell\\,d'\\right) \\;=\\; 0,\n$$\n即，\n$$\n\\ell\\,d'' \\;-\\; \\frac{1}{\\ell}\\,d \\;=\\; 0\n\\;\\;\\Longleftrightarrow\\;\\;\nd'' \\;-\\; \\frac{1}{\\ell^{2}}\\,d \\;=\\; 0,\n$$\n该方程需分别在 $x>0$ 和 $x<0$ 上施加，具有关于 $x=0$ 的对称性，并满足边界条件 $d(0)=1$ 和当 $|x|\\to\\infty$ 时 $d(x)\\to 0$。\n\n在 $x>0$ 上，常微分方程的通解是 $d(x)=A\\,\\exp(x/\\ell)+B\\,\\exp(-x/\\ell)$。当 $x\\to +\\infty$ 时的有界性要求 $A=0$。施加 $d(0)=1$ 得到 $B=1$。因此，对于 $x>0$：\n$$\nd(x) \\;=\\; \\exp(-x/\\ell).\n$$\n根据关于 $x=0$ 的偶对称性，完整的分布为\n$$\nd(x) \\;=\\; \\exp\\!\\big(-|x|/\\ell\\big),\n$$\n这与假设的稳态分布相匹配，因此在 $x\\neq 0$ 上与欧拉-拉格朗日方程一致。\n\n接下来，我们计算断裂表面能积分。对于给定的 $d(x)$，我们有\n$$\nd(x)^{2} \\;=\\; \\exp\\!\\big(-2|x|/\\ell\\big),\n\\qquad\nd'(x) \\;=\\; \n\\begin{cases}\n-\\dfrac{1}{\\ell}\\,\\exp(-x/\\ell),  x0, \\\\\n\\;\\;\\dfrac{1}{\\ell}\\,\\exp(x/\\ell),  x0.\n\\end{cases}\n$$\n因此，\n$$\n\\big(d'(x)\\big)^{2} \\;=\\; \\frac{1}{\\ell^{2}}\\,\\exp\\!\\big(-2|x|/\\ell\\big).\n$$\n表面能密度变为\n$$\n\\gamma_{\\ell}(d,d') \\;=\\; \\frac{1}{c_{0}}\\left[\\frac{1}{2\\,\\ell}\\,\\exp\\!\\big(-2|x|/\\ell\\big) + \\frac{\\ell}{2}\\cdot \\frac{1}{\\ell^{2}}\\,\\exp\\!\\big(-2|x|/\\ell\\big)\\right]\n\\;=\\; \\frac{1}{c_{0}}\\left[\\frac{1}{2\\,\\ell} + \\frac{1}{2\\,\\ell}\\right]\\exp\\!\\big(-2|x|/\\ell\\big)\n\\;=\\; \\frac{1}{c_{0}}\\,\\frac{1}{\\ell}\\,\\exp\\!\\big(-2|x|/\\ell\\big).\n$$\n所以，\n$$\n\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}(d,d')\\,\\mathrm{d}x\n\\;=\\;\n\\frac{1}{c_{0}}\\,\\int_{-\\infty}^{\\infty} \\frac{1}{\\ell}\\,\\exp\\!\\big(-2|x|/\\ell\\big)\\,\\mathrm{d}x.\n$$\n被积函数是偶函数，所以\n$$\n\\int_{-\\infty}^{\\infty} \\frac{1}{\\ell}\\,\\exp\\!\\big(-2|x|/\\ell\\big)\\,\\mathrm{d}x\n\\;=\\;\n2\\int_{0}^{\\infty} \\frac{1}{\\ell}\\,\\exp\\!\\big(-2x/\\ell\\big)\\,\\mathrm{d}x\n\\;=\\;\n2\\cdot \\frac{1}{\\ell}\\cdot \\left[\\,-\\frac{\\ell}{2}\\,\\exp\\!\\big(-2x/\\ell\\big)\\,\\right]_{0}^{\\infty}\n\\;=\\;\n2\\cdot \\frac{1}{\\ell}\\cdot \\frac{\\ell}{2}\n\\;=\\;\n1.\n$$\n由此得出\n$$\n\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}(d,d')\\,\\mathrm{d}x \\;=\\; \\frac{1}{c_{0}}.\n$$\n因此，这个稳态分布的断裂表面能为\n$$\n\\mathcal{E}_{\\Gamma}[d] \\;=\\; G_{c}\\,\\frac{1}{c_{0}}.\n$$\n校准为单个完全发展的裂纹需要 $\\mathcal{E}_{\\Gamma}[d]=G_{c}$，这意味着\n$$\nG_{c}\\,\\frac{1}{c_{0}} \\;=\\; G_{c}\n\\;\\;\\Longrightarrow\\;\\;\nc_{0} \\;=\\; 1.\n$$\n这个 $c_{0}$ 的值确保了稳态分布的断裂表面能等于 $G_{c}$，且与内禀长度 $\\ell$ 无关。", "answer": "$$\\boxed{1}$$", "id": "2709354"}, {"introduction": "获得了相场变量的解析形式后，一个自然的数值问题便是：需要多精细的网格才能准确地模拟裂纹？本练习 [@problem_id:2709362] 直接回应了这一核心关切，指导你推导出一个连接有限元网格尺寸 $h$ 与正则化长度 $\\ell$ 的准则。掌握这种分析能力对于确保计算结果的准确性和网格收敛性至关重要，是任何成功的变分断裂模拟的基石。", "problem": "考虑基于 Ambrosio–Tortorelli 近似和二次裂纹密度（通常称为 AT-2 模型）的脆性断裂正则化变分公式。在没有弹性耦合的情况下，静态损伤场 $d(x)$ 在半直线 $x \\ge 0$ 上最小化断裂正则化泛函，\n$$\n\\Psi_{\\ell}[d] \\;=\\; \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,w(d) \\;+\\; \\frac{\\ell}{2}\\,|d'(x)|^{2} \\right)\\,\\mathrm{d}x,\n$$\n其中 $w(d) = d^{2}$，并满足边界条件 $d(0)=1$（在裂纹面完全断裂）和 $\\lim_{x\\to\\infty} d(x)=0$（远离裂纹处完好无损）。这里 $\\ell0$ 是相场正则化长度尺度，$d\\in[0,1]$ 是标量损伤场。\n\na) 从 $\\Psi_{\\ell}[d]$ 的 Euler–Lagrange 方程出发，确定与所述边界条件一致的静态一维剖面 $d(x)$，并描述其在远离 $x=0$ 处的衰减特性。\n\nb) 假设要在 $[0,h]$ 上使用尺寸为 $h$ 的均匀网格，通过连续分段线性有限元来近似 $x=0$ 附近的 $d(x)$。令 $I_{h}[d](x)$ 表示通过在 $x=0$ 和 $x=h$ 处的节点值对 $d(x)$ 进行的线性插值。施加精度要求，即第一个单元上的最大逐点绝对插值误差满足\n$$\n\\max_{x\\in[0,h]} \\,|\\,d(x) - I_{h}[d](x)\\,| \\;\\le\\; \\varepsilon,\n$$\n对于给定的容差 $\\varepsilon\\in(0,1)$。仅使用 a) 部分得到的 $d$ 的衰减剖面和以 $[0,h]$ 上 $|d''(x)|$ 的上确界表示的线性单元标准插值误差界，推导出一个网格尺寸准则 $h \\le h_{\\max}(\\ell,\\varepsilon)$。\n\n以 $\\ell$ 和 $\\varepsilon$ 的单一闭式解析表达式形式给出 $h_{\\max}(\\ell,\\varepsilon)$ 的最终结果。如果要进行数值计算，请以国际单位制（SI）中的米为单位表示网格尺寸。不要代入数字；在最终答案中仅报告符号表达式。", "solution": "首先对问题陈述进行严格验证。该问题要求解答一个来自脆性断裂相场理论的一维平衡问题，具体是 Ambrosio-Tortorelli (AT-2) 模型，并随后进行有限元插值误差分析。泛函 $\\Psi_{\\ell}[d]$、退化函数 $w(d)$、边界条件以及 Euler-Lagrange 方程的使用都是该理论中标准且成熟的组成部分。问题的第二部分，关于基于标准插值误差界推导网格尺寸准则，是偏微分方程数值分析中的常规程序。该问题具有科学依据，是适定的、客观的且内部一致的。它包含了获得唯一解所需的所有信息。因此，该问题被认为是有效的，并且可以得到严格的解。\n\na) 部分：确定静态损伤剖面 $d(x)$。\n\n静态场 $d(x)$ 是使给定泛函 $\\Psi_{\\ell}[d]$ 最小化的场。根据变分法，这样的场必须满足与泛函的拉格朗日量（被积函数）相对应的 Euler-Lagrange 方程。拉格朗日量 $L(d, d')$ 为\n$$\nL(d, d') \\;=\\; \\frac{1}{2\\ell} w(d) + \\frac{\\ell}{2} |d'(x)|^2.\n$$\n给定 $w(d) = d^2$，拉格朗日量变为\n$$\nL(d, d') \\;=\\; \\frac{d^2}{2\\ell} + \\frac{\\ell}{2} (d')^2.\n$$\nEuler-Lagrange 方程由下式给出\n$$\n\\frac{\\partial L}{\\partial d} - \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\frac{\\partial L}{\\partial d'} \\right) = 0.\n$$\n首先，我们计算 $L$ 所需的偏导数：\n$$\n\\frac{\\partial L}{\\partial d} = \\frac{2d}{2\\ell} = \\frac{d}{\\ell}.\n$$\n$$\n\\frac{\\partial L}{\\partial d'} = \\frac{\\ell}{2} (2d') = \\ell d'.\n$$\n将这些表达式代入 Euler-Lagrange 方程，我们得到\n$$\n\\frac{d}{\\ell} - \\frac{\\mathrm{d}}{\\mathrm{d}x}(\\ell d') = 0,\n$$\n这可以简化为一个二阶线性常系数常微分方程：\n$$\n\\ell d''(x) - \\frac{1}{\\ell} d(x) = 0 \\quad \\implies \\quad d''(x) - \\frac{1}{\\ell^2} d(x) = 0.\n$$\n该常微分方程的特征方程为 $r^2 - 1/\\ell^2 = 0$，其实数根为 $r_{1,2} = \\pm 1/\\ell$。因此，$d(x)$ 的通解是指数函数的线性组合：\n$$\nd(x) = C_1 \\exp\\left(\\frac{x}{\\ell}\\right) + C_2 \\exp\\left(-\\frac{x}{\\ell}\\right),\n$$\n其中 $C_1$ 和 $C_2$ 是由边界条件决定的积分常数。\n\n边界条件为 $d(0)=1$ 和 $\\lim_{x\\to\\infty} d(x)=0$。\n必须满足在无穷远处的条件 $\\lim_{x\\to\\infty} d(x)=0$。当 $x \\to \\infty$ 时，项 $\\exp(x/\\ell)$ 无界增长。为确保极限为零，其系数必须为零。因此，我们必须有 $C_1=0$。\n解简化为\n$$\nd(x) = C_2 \\exp\\left(-\\frac{x}{\\ell}\\right).\n$$\n现在我们应用在 $x=0$ 处的边界条件，即 $d(0)=1$：\n$$\nd(0) = C_2 \\exp\\left(-\\frac{0}{\\ell}\\right) = C_2 \\cdot 1 = 1 \\quad \\implies \\quad C_2=1.\n$$\n因此，损伤场的静态一维剖面是\n$$\nd(x) = \\exp\\left(-\\frac{x}{\\ell}\\right).\n$$\n该解表示损伤场从 $x=0$ 处的完全断裂状态开始呈指数衰减，其特征长度尺度由正则化参数 $\\ell$ 决定。\n\nb) 部分：推导网格尺寸准则 $h \\le h_{\\max}(\\ell,\\varepsilon)$。\n\n我们必须为第一个单元 $[0,h]$ 的网格尺寸 $h$ 推导一个条件，以确保最大逐点插值误差不超过容差 $\\varepsilon \\in (0,1)$。精度要求是\n$$\n\\max_{x\\in[0,h]} | d(x) - I_{h}[d](x) | \\le \\varepsilon,\n$$\n其中 $I_{h}[d](x)$ 是 $d(x)$ 在 $[0,h]$ 上的线性插值。\n\n问题指定使用线性单元的标准插值误差界，即\n$$\n\\max_{x\\in[a,b]} |f(x) - I_h[f](x)| \\le \\frac{(b-a)^2}{8} \\sup_{z\\in[a,b]} |f''(z)|.\n$$\n对于我们的情况，函数是 $d(x)$，区间是 $[0,h]$，所以 $a=0$，$b=h$。该界变为\n$$\n\\max_{x\\in[0,h]} |d(x) - I_{h}[d](x)| \\le \\frac{h^2}{8} \\sup_{z\\in[0,h]} |d''(z)|.\n$$\n我们需要计算 $d(x) = \\exp(-x/\\ell)$ 的二阶导数。\n一阶导数是\n$$\nd'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left(\\exp\\left(-\\frac{x}{\\ell}\\right)\\right) = -\\frac{1}{\\ell} \\exp\\left(-\\frac{x}{\\ell}\\right).\n$$\n二阶导数是\n$$\nd''(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left(-\\frac{1}{\\ell} \\exp\\left(-\\frac{x}{\\ell}\\right)\\right) = \\left(-\\frac{1}{\\ell}\\right)^2 \\exp\\left(-\\frac{x}{\\ell}\\right) = \\frac{1}{\\ell^2} \\exp\\left(-\\frac{x}{\\ell}\\right).\n$$\n接下来，我们确定在区间 $[0,h]$ 上 $|d''(x)|$ 的上确界。由于 $\\ell  0$，函数 $d''(x) = \\frac{1}{\\ell^2} \\exp(-x/\\ell)$ 在 $x \\ge 0$ 上是正的且单调递减。它在区间 $[0,h]$ 上的最大值在 $x=0$ 处取得。\n$$\n\\sup_{z\\in[0,h]} |d''(z)| = d''(0) = \\frac{1}{\\ell^2} \\exp(0) = \\frac{1}{\\ell^2}.\n$$\n将此最大值代入误差界表达式，我们得到\n$$\n\\max_{x\\in[0,h]} |d(x) - I_{h}[d](x)| \\le \\frac{h^2}{8} \\left( \\frac{1}{\\ell^2} \\right) = \\frac{h^2}{8\\ell^2}.\n$$\n为满足规定的精度要求，我们施加条件\n$$\n\\frac{h^2}{8\\ell^2} \\le \\varepsilon.\n$$\n现在我们可以求解网格尺寸 $h$。整理不等式得到\n$$\nh^2 \\le 8 \\ell^2 \\varepsilon.\n$$\n由于 $h$ 必须是正长度，我们对两边取正平方根：\n$$\nh \\le \\sqrt{8 \\ell^2 \\varepsilon} = \\ell \\sqrt{8\\varepsilon}.\n$$\n简化根式项，$\\sqrt{8} = \\sqrt{4 \\cdot 2} = 2\\sqrt{2}$。对 $h$ 的条件变为\n$$\nh \\le 2\\ell\\sqrt{2\\varepsilon}.\n$$\n这个不等式就是所要求的网格尺寸准则。允许的最大网格尺寸 $h_{\\max}$ 对应于此关系的上界。\n$$\nh_{\\max}(\\ell, \\varepsilon) = 2\\ell\\sqrt{2\\varepsilon}.\n$$\n这是最终的符号表达式。关于单位的说明，如果 $\\ell$ 以米（m）为单位表示，那么 $h_{\\max}$ 也将以米为单位，因为 $\\varepsilon$ 是一个无量纲的量。", "answer": "$$\n\\boxed{2\\ell\\sqrt{2\\varepsilon}}\n$$", "id": "2709362"}, {"introduction": "这项压轴练习 [@problem_id:2709351] 将前面所学的概念融会贯通，指导你构建一个完整的一维相场断裂模拟程序。你将亲手实现广泛应用的交替最小化（或称“交错”）算法，在该算法中，位移场和相场问题被顺序求解。通过本练习，你不仅能掌握相场断裂求解器的核心逻辑，还能学会利用总能量单调递减这一稳健的特性作为迭代收敛的判断依据。", "problem": "考虑一个位于区间 $\\left[0,L\\right]$ 上的一维无量纲弹性杆，其具有标量位移场 $u(x)$ 和标量相场断裂变量 $d(x)$ ，其中 $d(x)$ 近似损伤， $d(x)=0$ 表示材料完好， $d(x)=1$ 表示材料完全断裂。断裂的变分法旨在寻找总能量关于 $u$ 和 $d$ 的极小值点。在本问题中，您将实现一个交替最小化方案，以在数值上原则性地证明总能量在迭代过程中是非增的，并且您将使用总能量的单调减少作为停止迭代的收敛准则。\n\n基本原理和模型：\n- 最小势能原理指出，对于固定的边界条件，物理上实现的场会使总能量最小化。我们使用一维脆性断裂的标准相场正则化。无量纲总能量泛函为\n$$\n\\mathcal{E}(u,d) \\;=\\; \\int_0^L \\left[ g(d)\\,\\frac{E}{2}\\,\\left(u'(x)\\right)^2 \\;+\\; G_c\\left(\\frac{d(x)^2}{4\\ell} \\;+\\; \\ell\\,\\left(d'(x)\\right)^2\\right) \\right]\\,\\mathrm{d}x,\n$$\n其中 $E$ 是无量纲弹性模量， $G_c$ 是无量纲临界能量释放率， $\\ell$ 是无量纲内禀长度尺度， $g(d)$ 是一个退化函数。令 $g(d) = \\left(1-d\\right)^2 + \\kappa$ ，其中 $\\kappa0$ 是一个小的残余刚度参数，以保持椭圆性。该杆受到狄利克雷位移边界条件 $u(0)=0$ 和 $u(L)=\\bar{U}$ 的约束。\n\n离散化与数值方案：\n- 使用 $N$ 个节点对区间 $\\left[0,L\\right]$ 进行离散化，节点间均匀间距为 $h = L/(N-1)$ 。\n- 对梯度使用二阶有限差分（基于边的中心差分）。将在节点 $i$ 和 $i+1$ 之间的边上的差分表示为 $\\Delta u_i = u_{i+1}-u_i$ 和 $\\Delta d_i = d_{i+1}-d_i$ 。\n- 离散能量近似：\n  - 弹性势能近似为\n    $$\n    \\mathcal{E}_{\\text{el}}(u,d) \\approx \\sum_{i=0}^{N-2} \\frac{1}{2}\\,\\frac{E\\,g_{i+\\frac{1}{2}}}{h}\\,\\left(\\Delta u_i\\right)^2,\n    $$\n    其中 $g_{i+\\frac{1}{2}} = \\tfrac{1}{2}\\big(g(d_i)+g(d_{i+1})\\big)$ 。\n  - 断裂表面能近似为\n    $$\n    \\mathcal{E}_{\\text{frac}}(d) \\approx \\sum_{i=0}^{N-1} G_c\\,\\frac{d_i^2}{4\\ell}\\,h \\;+\\; \\sum_{i=0}^{N-2} G_c\\,\\ell\\,\\frac{\\left(\\Delta d_i\\right)^2}{h}.\n    $$\n  - 总能量为 $\\mathcal{E}(u,d) \\approx \\mathcal{E}_{\\text{el}}(u,d) + \\mathcal{E}_{\\text{frac}}(d)$ 。\n- 交替最小化（也称为块坐标下降）：\n  - 固定 $d$ ，在 $u(0)=0$ 和 $u(L)=\\bar{U}$ 的约束下，对 $\\mathcal{E}(u,d)$ 关于 $u$ 进行最小化。由于 $g(d)\\ge \\kappa0$ ，这会产生一个具有对称正定（SPD）刚度矩阵的线性系统。\n  - 固定 $u$ ，对 $\\mathcal{E}(u,d)$ 关于 $d$ 进行最小化，无附加约束。欧拉-拉格朗日方程离散化为一个形如 $\\mathbf{A}_d \\mathbf{d} = \\mathbf{b}_d$ 的SPD线性系统，其中\n    $$\n    \\mathbf{A}_d \\;=\\; \\underbrace{\\mathbf{K}_{\\text{grad}}}_{\\text{from } \\ell(d')^2} \\;+\\; \\underbrace{\\operatorname{diag}\\!\\big(2\\,\\psi_i\\,h\\big)}_{\\text{from } g'(d)\\psi}\\;+\\; \\underbrace{\\operatorname{diag}\\!\\left(\\frac{G_c}{2\\ell}\\,h\\right)}_{\\text{from } d^2/(4\\ell)},\n    $$\n    其中 $\\psi_i$ 是弹性势能密度 $\\psi(u)=\\frac{E}{2}(u')^2$ 的节点近似， $\\mathbf{b}_d$ 的分量为 $\\left(\\mathbf{b}_d\\right)_i = 2\\,\\psi_i\\,h$ 。\n  - 在此演示中，我们不强制施加不可逆性或边界约束，从而使每个子问题都是一个无约束的凸最小化问题，确保在精确算术下，能量在每个子步骤中都是非增的。\n- 能量密度节点近似：计算边应变 $\\varepsilon_{i+\\frac{1}{2}}=\\Delta u_i/h$ 和边弹性势能 $\\psi_{i+\\frac{1}{2}}=\\tfrac{E}{2}\\,\\varepsilon_{i+\\frac{1}{2}}^2$ ，然后设置 $\\psi_0=\\psi_{\\frac{1}{2}}$ ， $\\psi_{N-1}=\\psi_{N-\\frac{3}{2}}$ ，对于内部节点 $i$ ，使用 $\\psi_i=\\tfrac{1}{2}\\left(\\psi_{i-\\frac{1}{2}}+\\psi_{i+\\frac{1}{2}}\\right)$ 。\n\n任务：\n1. 实现所述的交替最小化算法。对于所有节点 $i$ ，以 $d^{(0)}_i=0$ 进行初始化。在每次迭代 $k$ 中：\n   - 在固定 $d^{(k)}$ 的情况下求解 $u^{(k+1)}$ 。\n   - 计算并记录总能量 $\\mathcal{E}\\big(u^{(k+1)},d^{(k)}\\big)$ 。\n   - 在固定 $u^{(k+1)}$ 的情况下求解 $d^{(k+1)}$ 。\n   - 计算并记录总能量 $\\mathcal{E}\\big(u^{(k+1)},d^{(k+1)}\\big)$ 。\n2. 在数值上证明，在浮点容差范围内，所有子步骤的总能量序列是非增的。使用混合容差准则：给定每个子步骤后记录的能量 $\\{E_j\\}_{j\\ge 0}$ ，检查是否满足 $E_{j+1}\\le E_j + \\varepsilon_{\\text{abs}} + \\varepsilon_{\\text{rel}}\\,E_j$ ，其中 $\\varepsilon_{\\text{abs}}=10^{-14}$ 且 $\\varepsilon_{\\text{rel}}=10^{-12}$ 。\n3. 使用总能量的减少作为收敛准则。在每个完整的交替最小化循环之后（即，在更新 $u$ 和 $d$ 之后），计算相对减少量\n   $$\n   r_k \\;=\\; \\frac{\\mathcal{E}\\big(u^{(k)},d^{(k)}\\big) - \\mathcal{E}\\big(u^{(k+1)},d^{(k+1)}\\big)}{\\max\\!\\left(\\mathcal{E}\\big(u^{(k)},d^{(k)}\\big),\\,10^{-16}\\right)}.\n   $$\n   当 $r_k  \\text{tol}$ 或达到最大迭代次数时停止。\n\n测试套件：\n- 对于每个测试用例，所有量都是无量纲的，因此不需要物理单位。使用以下参数集：\n  - 情况 A (一般情况)： $L=1.0$ ， $N=101$ ， $E=1.0$ ， $G_c=0.01$ ， $\\ell=0.02$ ， $\\kappa=10^{-6}$ ， $\\bar{U}=0.2$ ， $\\text{tol}=10^{-10}$ ， $\\text{max\\_iter}=200$ 。\n  - 情况 B (近弹性，微小载荷)： $L=1.0$ ， $N=51$ ， $E=1.0$ ， $G_c=0.01$ ， $\\ell=0.02$ ， $\\kappa=10^{-6}$ ， $\\bar{U}=10^{-4}$ ， $\\text{tol}=10^{-12}$ ， $\\text{max\\_iter}=200$ 。\n  - 情况 C (更易断裂)： $L=1.0$ ， $N=101$ ， $E=1.0$ ， $G_c=0.005$ ， $\\ell=0.05$ ， $\\kappa=10^{-6}$ ， $\\bar{U}=0.2$ ， $\\text{tol}=10^{-10}$ ， $\\text{max\\_iter}=200$ 。\n\n程序要求：\n- 对于每种情况，您的程序必须计算以下输出：\n  - 一个布尔值，指示在运行过程中的所有子步骤中，记录的总能量是否根据上述指定的混合容差测试为非增。\n  - 在达到收敛或最大迭代次数之前所执行的完整交替最小化迭代的次数。\n  - 最终的总能量值，四舍五入到八位小数。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个方括号括起来的扁平、逗号分隔的列表。该列表必须按顺序连接每个案例的三元组。具体输出格式为\n  $$\n  [\\text{mono\\_A},\\text{iter\\_A},\\text{energy\\_A},\\text{mono\\_B},\\text{iter\\_B},\\text{energy\\_B},\\text{mono\\_C},\\text{iter\\_C},\\text{energy\\_C}],\n  $$\n  其中每个 $\\text{mono\\_*}$ 是 $\\text{True}$ 或 $\\text{False}$ ，每个 $\\text{iter\\_*}$ 是一个整数，每个 $\\text{energy\\_*}$ 是一个四舍五入到八位小数的浮点数。", "solution": "该问题陈述在计算固体力学领域提出了一个明确定义的任务。它在科学上基于使用标准相场模型的断裂变分理论。所有参数、方程、边界条件和数值程序都已足够清晰地指定，并且内部一致。该问题不违反任何物理或数学原理；它是客观且可形式化的。因此，该问题被认为是有效的，并将提供一个解决方案。\n\n目标是为一维相场断裂问题实现一个交替最小化方案。该方案通过迭代求解位移场 $u(x)$ 和相场 $d(x)$ 来寻找总能量泛函 $\\mathcal{E}(u,d)$ 的极小值点。主要任务是在数值上证明总能量在最小化子步骤中是非增的，并使用能量的减少作为收敛准则。\n\n解决方案是通过离散化问题域和控制能量泛函，然后交替求解由此产生的关于 $u$ 和 $d$ 的子问题来构建的。\n\n**1. 离散化与状态变量**\n\n一维域 $[0,L]$ 被离散化为 $N$ 个节点，索引为 $i=0, 1, \\dots, N-1$ 。节点之间的均匀间距为 $h = L/(N-1)$ 。位移场和相场由节点值向量 $\\mathbf{u} = [u_0, u_1, \\dots, u_{N-1}]^T$ 和 $\\mathbf{d} = [d_0, d_1, \\dots, d_{N-1}]^T$ 表示。\n\n**2. 总能量泛函**\n\n总能量 $\\mathcal{E}(u,d)$ 是弹性势能 $\\mathcal{E}_{\\text{el}}(u,d)$ 和断裂能 $\\mathcal{E}_{\\text{frac}}(d)$ 的和。根据提供的离散化方法：\n\n弹性势能为：\n$$\n\\mathcal{E}_{\\text{el}}(\\mathbf{u},\\mathbf{d}) = \\sum_{i=0}^{N-2} \\frac{E}{2h} g_{i+\\frac{1}{2}} (u_{i+1}-u_i)^2\n$$\n其中 $g(d) = (1-d)^2+\\kappa$ ，边中心的退化值为 $g_{i+\\frac{1}{2}} = \\frac{1}{2}(g(d_i) + g(d_{i+1}))$ 。\n\n断裂能为：\n$$\n\\mathcal{E}_{\\text{frac}}(\\mathbf{d}) = \\sum_{i=0}^{N-1} G_c \\frac{d_i^2}{4\\ell} h + \\sum_{i=0}^{N-2} G_c \\ell \\frac{(d_{i+1}-d_i)^2}{h}\n$$\n\n**3. 交替最小化子问题**\n\n该算法的核心是交替最小化循环。在每次迭代 $k$ 中，我们首先在保持 $\\mathbf{d}^{(k)}$ 固定的情况下求解 $\\mathbf{u}^{(k+1)}$ ，然后在保持 $\\mathbf{u}^{(k+1)}$ 固定的情况下求解 $\\mathbf{d}^{(k+1)}$ 。\n\n**3.1. 关于位移 $u$ 的最小化**\n\n对于固定的相场 $\\mathbf{d}$ ，我们在边界条件 $u_0=0$ 和 $u_{N-1}=\\bar{U}$ 下，对 $\\mathcal{E}(\\mathbf{u},\\mathbf{d})$ 关于 $\\mathbf{u}$ 进行最小化。这等价于对内部节点 $i=1, \\dots, N-2$ 求解 $\\frac{\\partial \\mathcal{E}_{\\text{el}}}{\\partial u_i} = 0$ 。对于内部节点 $u_i$ 的导数为：\n$$\n\\frac{\\partial \\mathcal{E}_{\\text{el}}}{\\partial u_i} = \\frac{\\partial}{\\partial u_i} \\left[ \\frac{E}{2h}g_{i-\\frac{1}{2}}(u_i-u_{i-1})^2 + \\frac{E}{2h}g_{i+\\frac{1}{2}}(u_{i+1}-u_i)^2 \\right] = 0\n$$\n这会产生一个线性方程组：\n$$\n\\frac{E}{h}g_{i-\\frac{1}{2}}(u_i-u_{i-1}) - \\frac{E}{h}g_{i+\\frac{1}{2}}(u_{i+1}-u_i) = 0\n$$\n对 $i=1, \\dots, N-2$ 进行重排：\n$$\n-\\left(\\frac{E}{h}g_{i-\\frac{1}{2}}\\right)u_{i-1} + \\left(\\frac{E}{h}g_{i-\\frac{1}{2}} + \\frac{E}{h}g_{i+\\frac{1}{2}}\\right)u_i - \\left(\\frac{E}{h}g_{i+\\frac{1}{2}}\\right)u_{i+1} = 0\n$$\n这为未知的内部位移 $\\mathbf{u}_{\\text{int}} = [u_1, \\dots, u_{N-2}]^T$ 定义了一个线性系统 $\\mathbf{K}_u \\mathbf{u}_{\\text{int}} = \\mathbf{f}_u$ 。刚度矩阵 $\\mathbf{K}_u$ 是一个 $(N-2) \\times (N-2)$ 的对称三对角矩阵。\n对角线元素为 $(\\mathbf{K}_u)_{j,j} = \\frac{E}{h}(g_{j-\\frac{1}{2}} + g_{j+\\frac{1}{2}})$ （使用局部矩阵索引， $j=1, \\dots, N-2$ ）。\n非对角线元素为 $(\\mathbf{K}_u)_{j,j+1} = (\\mathbf{K}_u)_{j+1,j} = -\\frac{E}{h}g_{j+\\frac{1}{2}}$ 。\n边界条件 $u_0=0$ 和 $u_{N-1}=\\bar{U}$ 分别修改了 $i=1$ 和 $i=N-2$ 的方程。对于 $i=1$ ， $u_0$ 项为零。对于 $i=N-2$ ，项 $-\\frac{E}{h}g_{N-\\frac{3}{2}}u_{N-1}$ 成为一个已知值并移到右侧，因此力向量 $\\mathbf{f}_u$ 的最后一个分量是 $f_{N-2} = \\frac{E}{h}g_{N-\\frac{3}{2}}\\bar{U}$ 。 $\\mathbf{f}_u$ 的所有其他分量均为零。由于 $g(d) \\ge \\kappa  0$ ，矩阵 $\\mathbf{K}_u$ 是对称正定的（SPD），保证了唯一解的存在。\n\n**3.2. 关于相场 $d$ 的最小化**\n\n对于固定的位移场 $\\mathbf{u}$ ，我们对 $\\mathcal{E}(\\mathbf{u},\\mathbf{d})$ 关于 $\\mathbf{d}$ 进行最小化。问题陈述给出了所得线性系统 $\\mathbf{A}_d \\mathbf{d} = \\mathbf{b}_d$ 的形式。该系统由对所有节点 $i=0, \\dots, N-1$ 设置 $\\frac{\\partial \\mathcal{E}}{\\partial d_i} = 0$ 推导而来。能量在弹性驱动力周围进行二次近似，从而得到指定的系统。\n\n首先，我们计算节点弹性势能密度 $\\psi_i$ 。计算边应变 $\\varepsilon_{i+\\frac{1}{2}} = (u_{i+1}-u_i)/h$ 和边能量密度 $\\psi_{i+\\frac{1}{2}} = \\frac{E}{2}\\varepsilon_{i+\\frac{1}{2}}^2$ 。然后，按规定分配节点值：\n$$\n\\psi_0 = \\psi_{\\frac{1}{2}}, \\quad \\psi_{N-1} = \\psi_{N-\\frac{3}{2}}, \\quad \\psi_i = \\frac{1}{2}(\\psi_{i-\\frac{1}{2}} + \\psi_{i+\\frac{1}{2}}) \\text{ for } i=1, \\dots, N-2.\n$$\n线性系统为 $\\mathbf{A}_d \\mathbf{d} = \\mathbf{b}_d$ ，其中 $N \\times N$ 矩阵 $\\mathbf{A}_d$ 和 $N$ 维向量 $\\mathbf{b}_d$ 的构造如下。向量 $\\mathbf{b}_d$ 的分量为 $(\\mathbf{b}_d)_i = 2\\psi_i h$ 。对称三对角矩阵 $\\mathbf{A}_d$ 是三部分贡献的总和：\n1.  来自梯度项 $\\ell(d')^2$ ：这产生一个离散拉普拉斯算子。对矩阵的贡献是在索引 $i=0$ 和 $i=N-1$ 处的对角线上为 $\\frac{2G_c \\ell}{h}$ ，在内部索引 $i=1, \\dots, N-2$ 的对角线上为 $\\frac{4G_c \\ell}{h}$ ，在次对角线和超对角线上为 $-\\frac{2G_c \\ell}{h}$ 。\n2.  来自应变能依赖性 $g''(d)\\psi$ ： $g(d)$ 的二阶导数是 $g''(d) = 2$ 。这会向对角线元素 $(\\mathbf{A}_d)_{i,i}$ 增加 $2\\psi_i h$ 。\n3.  来自表面项 $d^2/(4\\ell)$ ：这会向对角线元素 $(\\mathbf{A}_d)_{i,i}$ 增加 $\\frac{G_c h}{2\\ell}$ 。\n\n综合这些，系统矩阵 $\\mathbf{A}_d$ 是SPD的，可以高效地求解 $\\mathbf{d}$ 。\n\n**4. 算法与收敛**\n\n整体算法如下：\n1.  **初始化**：设置迭代计数器 $k=0$ 。将相场 $\\mathbf{d}^{(0)}$ 初始化为零向量。计算相应的线性弹性位移场 $\\mathbf{u}^{(0)}$ ，其分量为 $u_i^{(0)} = \\bar{U} \\cdot i / (N-1)$ 。计算初始总能量 $E_{\\text{prev}} = \\mathcal{E}(\\mathbf{u}^{(0)}, \\mathbf{d}^{(0)})$ 。\n2.  **迭代循环**：对于 $k=0, 1, \\dots, \\text{max_iter}-1$ ：\n    a. 使用 $\\mathbf{d}^{(k)}$ 求解 $\\mathbf{u}^{(k+1)}$ 。\n    b. 记录能量 $\\mathcal{E}(\\mathbf{u}^{(k+1)}, \\mathbf{d}^{(k)})$ 。\n    c. 使用 $\\mathbf{u}^{(k+1)}$ 求解 $\\mathbf{d}^{(k+1)}$ 。\n    d. 计算新的总能量 $E_{\\text{new}} = \\mathcal{E}(\\mathbf{u}^{(k+1)}, \\mathbf{d}^{(k+1)})$ 。记录此能量。\n    e. 通过计算相对能量减少量 $r_k = (E_{\\text{prev}} - E_{\\text{new}})/\\max(E_{\\text{prev}}, 10^{-16})$ 来检查收敛性。如果 $r_k  \\text{tol}$ ，则终止循环。\n    f. 为下一次迭代更新： $E_{\\text{prev}} = E_{\\text{new}}$ 。\n3.  **后处理**：循环结束后，验证所有记录的能量序列在指定的数值容差内是非增的： $E_{j+1} \\le E_j + \\varepsilon_{\\text{abs}} + \\varepsilon_{\\text{rel}} E_j$ 。\n4.  **输出**：返回单调性检查结果、执行的总迭代次数以及最终的收敛能量。\n\n此过程构成了一个完整且稳健的解决指定问题的方法。实现将精确遵循这些步骤。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # Case A (general case)\n        (1.0, 101, 1.0, 0.01, 0.02, 1e-6, 0.2, 1e-10, 200),\n        # Case B (near-elastic, tiny load)\n        (1.0, 51, 1.0, 0.01, 0.02, 1e-6, 1e-4, 1e-12, 200),\n        # Case C (more compliant fracture)\n        (1.0, 101, 1.0, 0.005, 0.05, 1e-6, 0.2, 1e-10, 200),\n    ]\n\n    all_results = []\n    for params in test_cases:\n        L, N, E, Gc, l, kappa, U_bar, tol, max_iter = params\n        is_monotonic, iters, final_energy = solve_case(L, N, E, Gc, l, kappa, U_bar, tol, max_iter)\n        all_results.extend([is_monotonic, iters, round(final_energy, 8)])\n\n    # Format and print the final output string\n    print(f\"[{','.join(map(str, all_results))}]\")\n\ndef solve_case(L, N, E, Gc, l, kappa, U_bar, tol, max_iter):\n    \"\"\"\n    Solves a single instance of the phase-field fracture problem.\n    \n    Returns:\n        tuple: (is_monotonic, iterations, final_energy)\n    \"\"\"\n    h = L / (N - 1)\n    x = np.linspace(0, L, N)\n    \n    # --- Helper Functions ---\n\n    def compute_total_energy(u, d):\n        # Elastic energy\n        g = (1 - d)**2 + kappa\n        g_mid = 0.5 * (g[:-1] + g[1:])\n        du = u[1:] - u[:-1]\n        el_energy = np.sum(0.5 * E * g_mid / h * du**2)\n        \n        # Fracture energy\n        frac_surf = np.sum(Gc * d**2 / (4 * l) * h)\n        dd = d[1:] - d[:-1]\n        frac_grad = np.sum(Gc * l * (dd**2) / h)\n        \n        return el_energy + frac_surf + frac_grad\n\n    def solve_for_u(d):\n        g = (1 - d)**2 + kappa\n        g_mid = 0.5 * (g[:-1] + g[1:])\n        k_stiff_edge = E * g_mid / h\n        \n        # System for interior nodes u_1, ..., u_{N-2}\n        num_internal_nodes = N - 2\n        diag = k_stiff_edge[:-1] + k_stiff_edge[1:]\n        off_diag = -k_stiff_edge[1:-1]\n        \n        Ku = np.zeros((3, num_internal_nodes))\n        Ku[0, 1:] = off_diag\n        Ku[1, :] = diag\n        Ku[2, :-1] = off_diag\n        \n        fu = np.zeros(num_internal_nodes)\n        fu[-1] = k_stiff_edge[-1] * U_bar\n        \n        u_internal = solve_banded((1, 1), Ku, fu)\n        \n        u = np.zeros(N)\n        u[1:-1] = u_internal\n        u[-1] = U_bar\n        return u\n\n    def solve_for_d(u):\n        # Calculate nodal elastic energy density psi\n        eps_edge = (u[1:] - u[:-1]) / h\n        psi_edge = 0.5 * E * eps_edge**2\n        \n        psi = np.zeros(N)\n        psi[0] = psi_edge[0]\n        psi[-1] = psi_edge[-1]\n        psi[1:-1] = 0.5 * (psi_edge[:-1] + psi_edge[1:])\n\n        # Assemble and solve Ad * d = bd\n        bd = 2 * psi * h\n\n        # Build Ad matrix (tridiagonal, N x N)\n        # K_grad part\n        diag_Ad = np.full(N, 4 * Gc * l / h)\n        diag_Ad[0] = 2 * Gc * l / h\n        diag_Ad[-1] = 2 * Gc * l / h\n        off_diag_Ad = np.full(N - 1, -2 * Gc * l / h)\n        \n        # Other diagonal contributions\n        diag_Ad += 2 * psi * h\n        diag_Ad += Gc * h / (2 * l)\n        \n        Ad_banded = np.zeros((3, N))\n        Ad_banded[0, 1:] = off_diag_Ad\n        Ad_banded[1, :] = diag_Ad\n        Ad_banded[2, :-1] = off_diag_Ad\n        \n        d_new = solve_banded((1, 1), Ad_banded, bd)\n        return d_new\n\n    # --- Alternate Minimization Loop ---\n    \n    # Initialization\n    d_k = np.zeros(N)\n    u_k = x * U_bar / L  # Linear elastic solution for d=0\n    \n    energy_k = compute_total_energy(u_k, d_k)\n    all_energies = [energy_k]\n    \n    iters_done = 0\n    for k in range(max_iter):\n        iters_done = k + 1\n        energy_prev_cycle = energy_k\n        \n        # Step 1: u-minimization\n        u_k_plus_1 = solve_for_u(d_k)\n        all_energies.append(compute_total_energy(u_k_plus_1, d_k))\n        \n        # Step 2: d-minimization\n        d_k_plus_1 = solve_for_d(u_k_plus_1)\n        energy_k = compute_total_energy(u_k_plus_1, d_k_plus_1)\n        all_energies.append(energy_k)\n        \n        # Update state for next iteration\n        u_k = u_k_plus_1\n        d_k = d_k_plus_1\n        \n        # Check for convergence\n        rel_decr = (energy_prev_cycle - energy_k) / max(energy_prev_cycle, 1e-16)\n        if rel_decr  tol:\n            break\n            \n    # --- Post-processing ---\n    \n    # Check for non-increasing energy property (monotonicity)\n    is_monotonic = True\n    eps_abs = 1e-14\n    eps_rel = 1e-12\n    for i in range(len(all_energies) - 1):\n        if all_energies[i+1] > all_energies[i] + eps_abs + eps_rel * all_energies[i]:\n            is_monotonic = False\n            break\n            \n    return is_monotonic, iters_done, energy_k\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2709351"}]}