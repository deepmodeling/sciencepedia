{"hands_on_practices": [{"introduction": "理解一个新概念的最好方法是将其应用于一个简单明了的案例。本练习侧重于纯拉伸，即变形轴线保持固定的情况。通过从第一性原理出发解决这个基本示例 [@problem_id:2675183]，您可以巩固对变形梯度 $\\boldsymbol{F}$、柯西-格林张量 ($\\boldsymbol{C}$ 和 $\\boldsymbol{B}$) 与主拉伸之间关系的理解。", "problem": "考虑一个连续介质体的均匀变形，其变形梯度 $\\boldsymbol{F}$ 是相对于一个标准正交基 $\\{e_1,e_2,e_3\\}$ 描述的。记 $\\boldsymbol{C}$ 为右柯西-格林变形张量 $\\boldsymbol{C}=\\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$，记 $\\boldsymbol{B}$ 为左柯西-格林变形张量 $\\boldsymbol{B}=\\boldsymbol{F} \\boldsymbol{F}^{\\mathsf{T}}$。右拉伸张量 $\\boldsymbol{U}$ 和左拉伸张量 $\\boldsymbol{V}$ 定义为出现在极分解 $\\boldsymbol{F}=\\boldsymbol{R}\\,\\boldsymbol{U}$ 和 $\\boldsymbol{F}=\\boldsymbol{V}\\,\\boldsymbol{R}$ 中的唯一正定平方根 $\\boldsymbol{U}=\\boldsymbol{C}^{1/2}$ 和 $\\boldsymbol{V}=\\boldsymbol{B}^{1/2}$，其中 $\\boldsymbol{R}$ 是一个正交旋转张量。主拉伸定义为 $\\boldsymbol{U}$（或等效地，$\\boldsymbol{V}$）的特征值，主方向是其相关的特征向量。\n\n现假设 $\\boldsymbol{F}$ 是一个对角矩阵，其对角线元素严格为正，$\\boldsymbol{F}=\\operatorname{diag}(\\lambda_1,\\lambda_2,\\lambda_3)$，且 $\\lambda_i>0$。仅从上述定义和事实出发，完成以下任务：\n\n1) 明确计算 $\\boldsymbol{C}$ 和 $\\boldsymbol{B}$，并通过仅使用正定对称张量的性质来刻画 $\\boldsymbol{C}^{1/2}$ 和 $\\boldsymbol{B}^{1/2}$，从而确定 $\\boldsymbol{U}$ 和 $\\boldsymbol{V}$。\n\n2) 在不引用任何未经证明的捷径的情况下，证明 $\\boldsymbol{U}$ 和 $\\boldsymbol{V}$ 在与 $\\boldsymbol{F}$ 相同的标准正交基下是对角矩阵，并且它们的特征向量与坐标基向量 $\\{e_i\\}$ 重合。用 $\\lambda_1,\\lambda_2,\\lambda_3$ 表示主拉伸。\n\n3) 将您的结果具体化到 $e_1$–$e_2$ 平面内的双轴拉伸情况（定义为 $\\lambda_3=1$，其中 $\\lambda_1,\\lambda_2>0$ 为任意值）和 $e_1$–$e_2$ 平面内的等容纯剪切情况（定义为 $\\det \\boldsymbol{F}=1$，其中 $\\lambda_3=1$ 且 $\\lambda_1>0$），并确定每种情况下相应的主拉伸。\n\n提供基于上述定义的清晰推理。作为您的最终答案，仅报告用 $\\lambda_1,\\lambda_2,\\lambda_3$ 表示的主拉伸的有序三元组 $(\\lambda^{(1)},\\lambda^{(2)},\\lambda^{(3)})$。不包括单位。此符号结果无需进行数值四舍五入。", "solution": "首先对问题陈述进行验证程序。\n\n步骤 1：提取的已知条件\n提供了以下定义、条件和任务：\n- 均匀变形由变形梯度张量 $\\boldsymbol{F}$ 描述。\n- 基是标准正交的：$\\{e_1,e_2,e_3\\}$。\n- 右柯西-格林变形张量为 $\\boldsymbol{C}=\\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$。\n- 左柯西-格林变形张量为 $\\boldsymbol{B}=\\boldsymbol{F}\\boldsymbol{F}^{\\mathsf{T}}$。\n- 右拉伸张量为 $\\boldsymbol{U}=\\boldsymbol{C}^{1/2}$，定义为 $\\boldsymbol{C}$ 的唯一正定平方根。\n- 左拉伸张量为 $\\boldsymbol{V}=\\boldsymbol{B}^{1/2}$，定义为 $\\boldsymbol{B}$ 的唯一正定平方根。\n- 极分解为 $\\boldsymbol{F}=\\boldsymbol{R}\\,\\boldsymbol{U}$ 和 $\\boldsymbol{F}=\\boldsymbol{V}\\,\\boldsymbol{R}$，其中 $\\boldsymbol{R}$ 是一个正交旋转张量。\n- 主拉伸是 $\\boldsymbol{U}$（或 $\\boldsymbol{V}$）的特征值。\n- 主方向是 $\\boldsymbol{U}$（或 $\\boldsymbol{V}$）的特征向量。\n- 在标准正交基中，变形梯度以对角矩阵形式给出：$\\boldsymbol{F}=\\operatorname{diag}(\\lambda_1,\\lambda_2,\\lambda_3)$，条件是对于 $i=1,2,3$，$\\lambda_i>0$。\n- 任务 1：根据定义明确计算 $\\boldsymbol{C}$、$\\boldsymbol{B}$、$\\boldsymbol{U}$ 和 $\\boldsymbol{V}$，使用正定对称张量的性质来刻画 $\\boldsymbol{C}^{1/2}$ 和 $\\boldsymbol{B}^{1/2}$。\n- 任务 2：证明 $\\boldsymbol{U}$ 和 $\\boldsymbol{V}$ 在与 $\\boldsymbol{F}$ 相同的基下是对角矩阵，其特征向量是 $\\{e_i\\}$，并陈述主拉伸。\n- 任务 3：将结果具体化到双轴拉伸（$\\lambda_3=1$）和等容纯剪切（$\\det \\boldsymbol{F}=1$, $\\lambda_3=1$）的情况。\n\n步骤 2：使用提取的已知条件进行验证\n根据指定标准对问题进行验证。\n- **科学依据：** 该问题牢固地植根于连续介质力学的基本原理。所使用的所有术语——变形梯度、柯西-格林张量、拉伸张量、极分解、主拉伸——都是该领域中标准的、定义明确的概念。\n- **适定性：** 该问题在数学上是适定的。所提供的信息是充分且一致的，允许通过直接应用张量代数和谱理论得到唯一解。\n- **客观性：** 该问题以精确、客观的数学语言表达，没有任何主观性、模糊性或基于意见的主张。\n- **完整性与一致性：** 该问题是自洽的。它提供了所有必要的定义和约束，没有内部矛盾。\n- **可行性：** 给定的 $\\boldsymbol{F}$ 形式为一个具有正对角元素的对角矩阵，代表了一种物理上有意义的变形，称为纯拉伸，这是固体力学中的一个标准例子。\n\n步骤 3：结论与行动\n该问题被确定为**有效**，因为它是科学合理的、适定的、客观的和自洽的。我现在将继续提供完整的解决方案。\n\n根据要求，解决方案分三部分展开。\n\n1) 计算 $\\boldsymbol{C}, \\boldsymbol{B}, \\boldsymbol{U}, \\boldsymbol{V}$：\n变形梯度 $\\boldsymbol{F}$ 在标准正交基 $\\{e_1, e_2, e_3\\}$ 中以对角矩阵形式给出：\n$$\n\\boldsymbol{F} = \\begin{pmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{pmatrix}\n$$\n由于 $\\boldsymbol{F}$ 是一个对角矩阵，其转置 $\\boldsymbol{F}^{\\mathsf{T}}$ 与 $\\boldsymbol{F}$ 相同：\n$$\n\\boldsymbol{F}^{\\mathsf{T}} = \\boldsymbol{F} = \\begin{pmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{pmatrix}\n$$\n右柯西-格林张量 $\\boldsymbol{C}$ 计算为 $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$。鉴于 $\\boldsymbol{F}^{\\mathsf{T}}=\\boldsymbol{F}$，这简化为 $\\boldsymbol{C}=\\boldsymbol{F}^2$：\n$$\n\\boldsymbol{C} = \\boldsymbol{F}^2 = \\begin{pmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{pmatrix} \\begin{pmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{pmatrix} = \\begin{pmatrix} \\lambda_1^2  0  0 \\\\ 0  \\lambda_2^2  0 \\\\ 0  0  \\lambda_3^2 \\end{pmatrix}\n$$\n类似地，左柯西-格林张量 $\\boldsymbol{B}$ 计算为 $\\boldsymbol{B} = \\boldsymbol{F}\\boldsymbol{F}^{\\mathsf{T}}$。由于 $\\boldsymbol{F}=\\boldsymbol{F}^{\\mathsf{T}}$，我们发现 $\\boldsymbol{B}=\\boldsymbol{C}$：\n$$\n\\boldsymbol{B} = \\boldsymbol{F}\\boldsymbol{F}^{\\mathsf{T}} = \\boldsymbol{F}^2 = \\begin{pmatrix} \\lambda_1^2  0  0 \\\\ 0  \\lambda_2^2  0 \\\\ 0  0  \\lambda_3^2 \\end{pmatrix}\n$$\n接下来，我们确定右拉伸张量 $\\boldsymbol{U} = \\boldsymbol{C}^{1/2}$ 和左拉伸张量 $\\boldsymbol{V} = \\boldsymbol{B}^{1/2}$。根据定义，$\\boldsymbol{U}$ 和 $\\boldsymbol{V}$ 分别是 $\\boldsymbol{C}$ 和 $\\boldsymbol{B}$ 的唯一正定平方根。对于一个在给定基下是对角矩阵的正定对称张量，例如 $\\boldsymbol{D} = \\operatorname{diag}(d_1, d_2, d_3)$ 且 $d_i > 0$，其唯一的正定平方根也是对角矩阵，由 $\\boldsymbol{D}^{1/2} = \\operatorname{diag}(\\sqrt{d_1}, \\sqrt{d_2}, \\sqrt{d_3})$ 给出。张量 $\\boldsymbol{C}$ 是对称且对角的。其对角元素为 $\\lambda_i^2$。由于已知 $\\lambda_i > 0$，我们有 $\\lambda_i^2 > 0$，这证实了 $\\boldsymbol{C}$ 是正定的。\n将此性质应用于 $\\boldsymbol{C}$，我们得到 $\\boldsymbol{U}$：\n$$\n\\boldsymbol{U} = \\boldsymbol{C}^{1/2} = \\begin{pmatrix} \\sqrt{\\lambda_1^2}  0  0 \\\\ 0  \\sqrt{\\lambda_2^2}  0 \\\\ 0  0  \\sqrt{\\lambda_3^2} \\end{pmatrix}\n$$\n由于 $\\lambda_i > 0$，我们有 $\\sqrt{\\lambda_i^2} = \\lambda_i$。因此，\n$$\n\\boldsymbol{U} = \\begin{pmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{pmatrix}\n$$\n由于 $\\boldsymbol{B}=\\boldsymbol{C}$，它们唯一的正定平方根必须相同，所以 $\\boldsymbol{V}=\\boldsymbol{U}$。我们注意到 $\\boldsymbol{U}=\\boldsymbol{V}=\\boldsymbol{F}$。因此，极分解 $\\boldsymbol{F}=\\boldsymbol{R}\\boldsymbol{U}$ 要求 $\\boldsymbol{R}$ 是单位张量 $\\mathbf{I}$，即 $\\boldsymbol{F}=\\mathbf{I}\\boldsymbol{F}$。单位张量 $\\mathbf{I}$ 确实是一个正交张量（$\\mathbf{I}^{\\mathsf{T}}\\mathbf{I} = \\mathbf{I}$），所以这是相符的。纯拉伸对应于没有旋转的变形。\n\n2) 主拉伸和主方向：\n主拉伸是右拉伸张量 $\\boldsymbol{U}$ 的特征值，主方向是相应的特征向量。我们已经发现 $\\boldsymbol{U} = \\operatorname{diag}(\\lambda_1, \\lambda_2, \\lambda_3)$。\n$\\boldsymbol{U}$ 的特征值问题是 $\\boldsymbol{U}\\boldsymbol{x} = \\mu\\boldsymbol{x}$，其中 $\\mu$ 是特征值，$\\boldsymbol{x}$ 是相应的特征向量。以矩阵形式表示为：\n$$\n\\begin{pmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} = \\mu \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}\n$$\n这等价于方程组 $( \\lambda_i - \\mu ) x_i = 0$（对于 $i=1,2,3$）。对于一个非平凡解 $\\boldsymbol{x} \\neq \\boldsymbol{0}$，矩阵 $(\\boldsymbol{U} - \\mu \\mathbf{I})$ 的行列式必须为零：$\\det(\\boldsymbol{U} - \\mu \\mathbf{I}) = (\\lambda_1 - \\mu)(\\lambda_2 - \\mu)(\\lambda_3 - \\mu) = 0$。\n$\\mu$ 的解，即特征值，恰好是 $\\mu_1=\\lambda_1$，$\\mu_2=\\lambda_2$ 和 $\\mu_3=\\lambda_3$。这些就是主拉伸。\n通过将每个特征值代回特征值方程，可以找到相应的特征向量。\n- 对于 $\\mu = \\lambda_1$：方程变为 $(\\lambda_1 - \\lambda_1)x_1=0$、$(\\lambda_2 - \\lambda_1)x_2=0$ 和 $(\\lambda_3 - \\lambda_1)x_3=0$。如果所有的 $\\lambda_i$ 都不同，这将迫使 $x_2=0$ 和 $x_3=0$，而 $x_1$ 是任意的。特征向量是 $(1, 0, 0)^{\\mathsf{T}}$ 的任何非零倍数，即基向量 $e_1$。\n- 对于 $\\mu = \\lambda_2$：类似地，特征向量是 $e_2$。\n- 对于 $\\mu = \\lambda_3$：特征向量是 $e_3$。\n如果有任何主拉伸相等（例如 $\\lambda_1=\\lambda_2$），则相应的特征空间是多维的。例如，如果 $\\lambda_1=\\lambda_2$，则由 $\\{e_1, e_2\\}$ 张成的平面中的任何向量都是特征值 $\\lambda_1$ 的特征向量。无论如何，集合 $\\{e_1, e_2, e_3\\}$ 仍然是 $\\boldsymbol{U}$ 的一个有效的标准正交特征向量基。\n因此，$\\boldsymbol{U}$ 和 $\\boldsymbol{V}$ 在与 $\\boldsymbol{F}$ 相同的基下是对角矩阵，它们的特征向量与坐标基向量 $\\{e_i\\}$ 重合，主拉伸是 $\\lambda_1, \\lambda_2, \\lambda_3$。\n\n3) 特殊情况：\n- 双轴拉伸：这种情况定义为 $\\lambda_3=1$，其中 $\\lambda_1>0$ 和 $\\lambda_2>0$ 是任意的。应用第 2 部分的一般结果，主拉伸是 $\\boldsymbol{F}$ 的对角元素，因此它们是 $\\lambda_1, \\lambda_2, 1$。\n- $e_1-e_2$ 平面内的等容纯剪切：这种情况由条件 $\\det \\boldsymbol{F}=1$、$\\lambda_3=1$ 和 $\\lambda_1>0$ 定义。$\\boldsymbol{F}=\\operatorname{diag}(\\lambda_1, \\lambda_2, \\lambda_3)$ 的行列式是 $\\det \\boldsymbol{F} = \\lambda_1 \\lambda_2 \\lambda_3$。当 $\\det \\boldsymbol{F}=1$ 和 $\\lambda_3=1$ 时，我们有 $\\lambda_1 \\lambda_2 (1) = 1$，这意味着 $\\lambda_2 = \\frac{1}{\\lambda_1}$。由于 $\\lambda_1 > 0$，因此 $\\lambda_2 > 0$。变形梯度为 $\\boldsymbol{F} = \\operatorname{diag}(\\lambda_1, 1/\\lambda_1, 1)$。因此，主拉伸为 $\\lambda_1, \\frac{1}{\\lambda_1}, 1$。\n\n所要求的最终答案是对于一般情况，用 $\\lambda_1, \\lambda_2, \\lambda_3$ 表示的主拉伸的有序三元组。根据以上推导，这些就是 $\\lambda_1, \\lambda_2, \\lambda_3$，分别对应于主方向 $e_1, e_2, e_3$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\lambda_1  \\lambda_2  \\lambda_3\n\\end{pmatrix}\n}\n$$", "id": "2675183"}, {"introduction": "主拉伸不仅是一个抽象的运动学度量，它们还是定义各种有限应变张量的基础。本练习 [@problem_id:2675211] 演示了如何直接用主拉伸来表示格林-拉格朗日和阿尔曼西应变张量（固体力学中两种最常见的应变度量）的主值。这个练习凸显了主拉伸在有限应变理论框架中的核心作用。", "problem": "一个均匀的有限变形通过变形梯度张量 $\\boldsymbol{F}$ 将一个物质点从参考位置映射到当前位置。右柯西-格林变形张量定义为 $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$，左柯西-格林变形张量定义为 $\\boldsymbol{b} = \\boldsymbol{F}\\boldsymbol{F}^{\\mathsf{T}}$。格林-拉格朗日应变张量定义为 $\\boldsymbol{E} = \\tfrac{1}{2}(\\boldsymbol{C} - \\mathbf{I})$，阿尔曼西应变张量定义为 $\\boldsymbol{e} = \\tfrac{1}{2}(\\mathbf{I} - \\boldsymbol{b}^{-1})$，其中 $\\mathbf{I}$ 是单位张量。主伸长 $\\lambda_i$ 是 $\\boldsymbol{F}$ 的正奇异值，在主方向上，变形是纯拉伸，拉伸比为 $\\lambda_i$。\n\n1. 仅从这些定义和主伸长是 $\\boldsymbol{F}$ 的奇异值的概念出发，推导 $\\boldsymbol{E}$ 的主值 $E_i$ 和 $\\boldsymbol{e}$ 的主值 $e_i$ 关于主伸长 $\\lambda_i$ 的显式表达式。\n\n2. 对于主伸长为 $\\lambda_1 = 1.3$、$\\lambda_2 = 0.8$ 和 $\\lambda_3 = 1.1$ 的均匀变形，计算标量\n$$\nS = \\sum_{i=1}^{3} E_i\\, e_i.\n$$\n请将 $S$ 的最终答案以无量纲数的形式给出，并四舍五入到六位有效数字。", "solution": "该问题提法良好且科学上合理，它基于连续介质力学的基本原理。它包括两个部分：主应变表达式的推导和随后的数值计算。我们将依次处理每个部分。\n\n第 1 部分：主应变的推导\n\n主伸长，记为 $\\lambda_i$（其中 $i \\in \\{1, 2, 3\\}$），是变形梯度张量 $\\boldsymbol{F}$ 的正奇异值。这与极分解定理直接相关，该定理指出 $\\boldsymbol{F}$ 可以分解为 $\\boldsymbol{F} = \\boldsymbol{R}\\boldsymbol{U} = \\boldsymbol{V}\\boldsymbol{R}$，其中 $\\boldsymbol{R}$ 是表示旋转的正常正交张量，$\\boldsymbol{U}$ 和 $\\boldsymbol{V}$ 分别是对称正定的右和左伸长张量。$\\boldsymbol{U}$ 和 $\\boldsymbol{V}$ 的特征值都是主伸长 $\\lambda_i$。相应的特征向量定义了参考构型（对于 $\\boldsymbol{U}$）和当前构型（对于 $\\boldsymbol{V}$）中的主伸长方向。\n\n首先，我们推导格林-拉格朗日应变张量 $\\boldsymbol{E}$ 的主值的表达式。张量 $\\boldsymbol{E}$ 是相对于参考构型定义的。其定义涉及右柯西-格林变形张量 $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$。使用极分解 $\\boldsymbol{F} = \\boldsymbol{R}\\boldsymbol{U}$，我们可以将 $\\boldsymbol{C}$ 表示为：\n$$\n\\boldsymbol{C} = (\\boldsymbol{R}\\boldsymbol{U})^{\\mathsf{T}}(\\boldsymbol{R}\\boldsymbol{U}) = \\boldsymbol{U}^{\\mathsf{T}}\\boldsymbol{R}^{\\mathsf{T}}\\boldsymbol{R}\\boldsymbol{U}\n$$\n鉴于 $\\boldsymbol{R}$ 是正交的，$\\boldsymbol{R}^{\\mathsf{T}}\\boldsymbol{R} = \\mathbf{I}$，其中 $\\mathbf{I}$ 是二阶单位张量。由于 $\\boldsymbol{U}$ 是对称的，$\\boldsymbol{U}^{\\mathsf{T}} = \\boldsymbol{U}$。因此，$\\boldsymbol{C}$ 的表达式简化为：\n$$\n\\boldsymbol{C} = \\boldsymbol{U}\\mathbf{I}\\boldsymbol{U} = \\boldsymbol{U}^2\n$$\n这个结果表明 $\\boldsymbol{C}$ 和 $\\boldsymbol{U}$ 是共轴的，意味着它们共享相同的主方向（特征向量）。如果 $\\boldsymbol{N}_i$ 是 $\\boldsymbol{U}$ 对应于特征值 $\\lambda_i$ 的特征向量，那么 $\\boldsymbol{U}\\boldsymbol{N}_i = \\lambda_i\\boldsymbol{N}_i$。因此，$\\boldsymbol{C}$ 作用于 $\\boldsymbol{N}_i$ 的结果是：\n$$\n\\boldsymbol{C}\\boldsymbol{N}_i = \\boldsymbol{U}^2\\boldsymbol{N}_i = \\boldsymbol{U}(\\boldsymbol{U}\\boldsymbol{N}_i) = \\boldsymbol{U}(\\lambda_i\\boldsymbol{N}_i) = \\lambda_i(\\boldsymbol{U}\\boldsymbol{N}_i) = \\lambda_i(\\lambda_i\\boldsymbol{N}_i) = \\lambda_i^2\\boldsymbol{N}_i\n$$\n因此，$\\boldsymbol{C}$ 的主值是 $\\lambda_i^2$。\n现在，考虑格林-拉格朗日应变张量 $\\boldsymbol{E} = \\frac{1}{2}(\\boldsymbol{C} - \\mathbf{I})$。$\\boldsymbol{E}$ 的主值，记为 $E_i$，是它的特征值。由于 $\\boldsymbol{E}$ 是 $\\boldsymbol{C}$ 的线性函数，它也与 $\\boldsymbol{C}$ 和 $\\boldsymbol{U}$ 共轴。通过将 $\\boldsymbol{E}$ 应用于主方向 $\\boldsymbol{N}_i$，可以找到特征值 $E_i$：\n$$\n\\boldsymbol{E}\\boldsymbol{N}_i = \\frac{1}{2}(\\boldsymbol{C} - \\mathbf{I})\\boldsymbol{N}_i = \\frac{1}{2}(\\boldsymbol{C}\\boldsymbol{N}_i - \\mathbf{I}\\boldsymbol{N}_i) = \\frac{1}{2}(\\lambda_i^2\\boldsymbol{N}_i - \\boldsymbol{N}_i) = \\frac{1}{2}(\\lambda_i^2 - 1)\\boldsymbol{N}_i\n$$\n由此，我们确定格林-拉格朗日应变张量的主值为：\n$$\nE_i = \\frac{1}{2}(\\lambda_i^2 - 1)\n$$\n\n接下来，我们推导阿尔曼西应变张量 $\\boldsymbol{e}$ 的主值的表达式。该张量是相对于当前构型通过关系式 $\\boldsymbol{e} = \\frac{1}{2}(\\mathbf{I} - \\boldsymbol{b}^{-1})$ 定义的，其中 $\\boldsymbol{b}$ 是左柯西-格林变形张量，$\\boldsymbol{b} = \\boldsymbol{F}\\boldsymbol{F}^{\\mathsf{T}}$。使用极分解 $\\boldsymbol{F} = \\boldsymbol{V}\\boldsymbol{R}$：\n$$\n\\boldsymbol{b} = (\\boldsymbol{V}\\boldsymbol{R})(\\boldsymbol{V}\\boldsymbol{R})^{\\mathsf{T}} = \\boldsymbol{V}\\boldsymbol{R}\\boldsymbol{R}^{\\mathsf{T}}\\boldsymbol{V}^{\\mathsf{T}}\n$$\n由于 $\\boldsymbol{R}\\boldsymbol{R}^{\\mathsf{T}} = \\mathbf{I}$ 且 $\\boldsymbol{V}^{\\mathsf{T}} = \\boldsymbol{V}$，这简化为：\n$$\n\\boldsymbol{b} = \\boldsymbol{V}\\mathbf{I}\\boldsymbol{V} = \\boldsymbol{V}^2\n$$\n与前一种情况类似，$\\boldsymbol{b}$ 和 $\\boldsymbol{V}$ 是共轴的。$\\boldsymbol{b}$ 的主值是 $\\boldsymbol{V}$ 主值的平方，即主伸长 $\\lambda_i$ 的平方。因此，$\\boldsymbol{b}$ 的特征值是 $\\lambda_i^2$。逆张量 $\\boldsymbol{b}^{-1}$ 的主值是 $\\boldsymbol{b}$ 主值的倒数，即 $\\lambda_i^{-2}$。$\\boldsymbol{b}$ 和 $\\boldsymbol{e}$ 的主方向，记为 $\\boldsymbol{n}_i$，是 $\\boldsymbol{V}$ 的特征向量。\n$\\boldsymbol{e}$ 的主值，记为 $e_i$，是它的特征值。将 $\\boldsymbol{e}$ 应用于其主方向 $\\boldsymbol{n}_i$：\n$$\n\\boldsymbol{e}\\boldsymbol{n}_i = \\frac{1}{2}(\\mathbf{I} - \\boldsymbol{b}^{-1})\\boldsymbol{n}_i = \\frac{1}{2}(\\mathbf{I}\\boldsymbol{n}_i - \\boldsymbol{b}^{-1}\\boldsymbol{n}_i) = \\frac{1}{2}(\\boldsymbol{n}_i - \\lambda_i^{-2}\\boldsymbol{n}_i) = \\frac{1}{2}(1 - \\lambda_i^{-2})\\boldsymbol{n}_i\n$$\n因此，阿尔曼西应变张量的主值为：\n$$\ne_i = \\frac{1}{2}(1 - \\lambda_i^{-2})\n$$\n至此完成了所需的推导。\n\n第 2 部分：数值计算\n\n我们需要为主伸长为 $\\lambda_1 = 1.3$、$\\lambda_2 = 0.8$ 和 $\\lambda_3 = 1.1$ 的变形计算标量 $S = \\sum_{i=1}^{3} E_i e_i$。\n首先，让我们找到乘积 $E_i e_i$ 的一般表达式：\n$$\nE_i e_i = \\left(\\frac{1}{2}(\\lambda_i^2 - 1)\\right) \\left(\\frac{1}{2}(1 - \\lambda_i^{-2})\\right) = \\frac{1}{4}(\\lambda_i^2 - 1)\\left(1 - \\frac{1}{\\lambda_i^2}\\right)\n$$\n$$\nE_i e_i = \\frac{1}{4}(\\lambda_i^2 - 1)\\left(\\frac{\\lambda_i^2 - 1}{\\lambda_i^2}\\right) = \\frac{1}{4}\\frac{(\\lambda_i^2 - 1)^2}{\\lambda_i^2}\n$$\n现在我们将给定的数值代入每个主伸长。\n\n对于 $\\lambda_1 = 1.3$：\n$$\nE_1 e_1 = \\frac{1}{4}\\frac{(1.3^2 - 1)^2}{1.3^2} = \\frac{1}{4}\\frac{(1.69 - 1)^2}{1.69} = \\frac{1}{4}\\frac{0.69^2}{1.69} = \\frac{1}{4}\\frac{0.4761}{1.69} \\approx 0.070428994\n$$\n对于 $\\lambda_2 = 0.8$：\n$$\nE_2 e_2 = \\frac{1}{4}\\frac{(0.8^2 - 1)^2}{0.8^2} = \\frac{1}{4}\\frac{(0.64 - 1)^2}{0.64} = \\frac{1}{4}\\frac{(-0.36)^2}{0.64} = \\frac{1}{4}\\frac{0.1296}{0.64} = 0.050625\n$$\n对于 $\\lambda_3 = 1.1$：\n$$\nE_3 e_3 = \\frac{1}{4}\\frac{(1.1^2 - 1)^2}{1.1^2} = \\frac{1}{4}\\frac{(1.21 - 1)^2}{1.21} = \\frac{1}{4}\\frac{0.21^2}{1.21} = \\frac{1}{4}\\frac{0.0441}{1.21} \\approx 0.009111570\n$$\n标量 $S$ 是这些值的和：\n$$\nS = \\sum_{i=1}^{3} E_i e_i = E_1 e_1 + E_2 e_2 + E_3 e_3\n$$\n$$\nS \\approx 0.070428994 + 0.050625 + 0.009111570 = 0.130165564\n$$\n问题要求答案四舍五入到六位有效数字。第一位有效数字是小数点后第一位的 $1$。因此，我们必须提供小数点后五位的结果，并对最后一位进行四舍五入。\n$$\nS \\approx 0.130166\n$$\n这是最终的数值结果。", "answer": "$$\n\\boxed{0.130166}\n$$", "id": "2675211"}, {"introduction": "从理论走向计算实践会揭示新的挑战。在分析一个连续的变形过程时，必须持续地追踪主拉伸及其方向，但是当拉伸值接近或相同时（即特征值交叉或简并），数值特征值求解器可能会引入不连续性。这项高级练习 [@problem_id:2675219] 要求您设计并实现一个鲁棒的算法，以正确追踪主轴，这对于开发可靠的有限元模拟至关重要。", "problem": "给定三维空间中的离散变形路径。对于每条路径，提供一系列变形梯度张量 $\\{\\boldsymbol{F}_k\\}_{k=0}^{N}$，其中 $\\boldsymbol{F}_k \\in \\mathbb{R}^{3 \\times 3}$ 是可逆的，并且在所提供的测试套件中是对称正定的。从基本定义出发，主伸长的定义如下。右柯西-格林张量为 $\\boldsymbol{C}_k = \\boldsymbol{F}_k^{\\mathsf{T}} \\boldsymbol{F}_k$。在步骤 $k$ 的主伸长 $\\{\\lambda_{k,i}\\}_{i=1}^{3}$ 是 $\\boldsymbol{C}_k$ 特征值的正平方根，而相应的主方向是 $\\boldsymbol{C}_k$ 的单位特征向量。$\\boldsymbol{C}_k$ 的特征对是实数，其特征向量是标准正交的，因为 $\\boldsymbol{C}_k$ 是对称正定的。然而，沿着变形路径，特征值可能会相互接近或交叉，这使得按大小进行朴素排序的方法变得不稳定和不符合物理实际。任务是为每条给定路径构建一个数值上鲁棒、客观且连续的主伸长及相应主方向的标记方法，即使在特征值交叉时也能适用。\n\n您的程序应基于以下基本定律和核心定义，不得使用任何未经证实的捷径：\n\n- 变形梯度 $\\boldsymbol{F}$ 通过 $d\\boldsymbol{x} = \\boldsymbol{F} \\, d\\boldsymbol{X}$ 映射微分线元。\n- 右柯西-格林张量 $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}} \\boldsymbol{F}$ 测量参考构型中的伸长。\n- 主伸长由特征值问题 $\\boldsymbol{C} \\, \\boldsymbol{v}_i = \\mu_i \\, \\boldsymbol{v}_i$ 定义，其中 $\\mu_i > 0$ 且 $\\lambda_i = \\sqrt{\\mu_i}$，主方向是相关的标准正交特征向量 $\\{\\boldsymbol{v}_i\\}_{i=1}^{3}$。\n- 特征向量的定义可相差一个符号，当特征值完全重复时，对应不变子空间的任何标准正交基都是可接受的。\n\n您的程序必须为每条路径执行以下操作：\n\n1. $k=0$ 时的初始化：计算 $\\boldsymbol{C}_0$ 及其特征对，并通过将主伸长按严格降序排列来设置初始标签 $(i=1,2,3)$，并将相应的主方向作为标记框架。如果需要在 $k=0$ 时打破任何精确的平局，则通过特征向量分量的字典序来确保确定性。\n\n2. $k=1,\\dots,N$ 时标签的传递：在每一步，计算 $\\boldsymbol{C}_k$ 及其特征对 $\\{(\\mu_{k,j}, \\boldsymbol{v}_{k,j})\\}_{j=1}^{3}$ 和主伸长 $\\lambda_{k,j} = \\sqrt{\\mu_{k,j}}$。选择一个排列，将当前的特征对分配给先前的标签 $(i=1,2,3)$，以最大化连续性。您的程序必须至少满足以下所有要求：\n\n   - 客观性：方向的分配和比较必须仅使用主方向的内积和主伸长，并且在固定的标准正交基变换下不变。\n   - 符号解析：如果当前方向 $\\boldsymbol{v}_{k,j}$ 被分配给先前的标记方向 $\\boldsymbol{p}_{k-1,i}$，通过翻转 $\\boldsymbol{v}_{k,j}$ 的符号以确保 $\\boldsymbol{p}_{k-1,i}^{\\mathsf{T}} \\boldsymbol{v}_{k,j} \\ge 0$ 来强制实现连续性。\n   - 简并处理：使用数值容差 $\\tau = 10^{-8}$ 来检测重复或近乎重复的主伸长。如果当前伸长的一个子集两两之差在 $\\tau$ 之内，则将其张成的空间视为一个简并子空间。在任何此类子空间内，选择一个与传递过来的该子空间的先前标记基最大程度对齐的标准正交基（例如，通过在子空间内解决一个最佳正交对齐问题），然后再决定分配，以避免标签因非唯一性而任意跳跃。如果前一步和当前步都存在简并，则一致地应用相同的规则。\n   - 交叉鲁棒性：当特征值交叉时，不要按瞬时大小重新标记；相反，根据您的对齐和邻近性标准，通过连续性来传递标签，以使标签保持附加在其连续的特征数据分支上。\n\n3. 最终报告：对于每条路径，以传递的标签顺序 $(i=1,2,3)$ 报告最后一步 $k=N$ 的三个主伸长。将每个伸长表示为精确到六位小数的浮点数。不需要物理单位，因为主伸长是无量纲的。\n\n角度单位：在内部使用角度的任何地方（例如，在构造旋转时），单位均为弧度。您的程序输出不包含角度。\n\n测试套件。使用以下四个路径，每个路径在 $N=10$ 处离散化，步骤为 $k=0,1,\\dots,10$，参数为 $t_k = k/10$：\n\n- 测试用例 A（理想路径，无重复伸长，无交叉）：\n  对于每个 $k$，设置\n  $$\\boldsymbol{F}_k = \\mathrm{diag}\\big(1.0 + 0.05\\,k,\\; 1.2 + 0.02\\,k,\\; 0.9 + 0.01\\,k\\big).$$\n\n- 测试用例 B（特征值交叉，方向固定）：\n  对于每个 $k$，设置\n  $$\\boldsymbol{F}_k = \\mathrm{diag}\\big(1.1 + 0.02\\,k,\\; 1.3 - 0.02\\,k,\\; 0.95\\big).$$\n\n- 测试用例 C（旋转子空间中的精确简并）：\n  令 $R_z(\\theta)$ 表示绕 $z$ 轴旋转角度 $\\theta$：\n  $$R_z(\\theta) = \\begin{bmatrix}\n  \\cos\\theta  -\\sin\\theta  0\\\\\n  \\sin\\theta  \\phantom{-}\\cos\\theta  0\\\\\n  0  0  1\n  \\end{bmatrix}.$$\n  对于每个 $k$，当 $\\theta_k = \\pi\\, t_k$ 时，设置\n  $$\\boldsymbol{F}_k = R_z(\\theta_k)\\; \\mathrm{diag}(1.2,\\, 1.2,\\, 0.8)\\; R_z(\\theta_k)^{\\mathsf{T}}.$$\n\n- 测试用例 D（近简并、交叉和旋转方向）：\n  当 $\\theta_k = \\pi\\, t_k$ 和 $\\varepsilon = 0.2$ 时，定义\n  $$a_k = 1.0 + \\varepsilon\\,(t_k - 0.5),\\qquad b_k = 1.0 - \\varepsilon\\,(t_k - 0.5),\\qquad c_k = 1.05.$$\n  对于每个 $k$，设置\n  $$\\boldsymbol{F}_k = R_z(\\theta_k)\\; \\mathrm{diag}(a_k,\\, b_k,\\, c_k)\\; R_z(\\theta_k)^{\\mathsf{T}}.$$\n\n最终输出格式。您的程序应生成一行输出，其中包含一个长度为 $4$ 的列表，按顺序为每个测试用例 $\\mathrm{A}$ 到 $\\mathrm{D}$ 提供一个条目。每个条目本身是一个包含最后一步 $k=10$ 时三个标记主伸长的列表，四舍五入到恰好六位小数。格式是用方括号括起来的逗号分隔列表，例如 $[[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot]]$，没有多余的空格，也没有附加文本。", "solution": "用户请求解决一个问题：如何沿离散变形路径连续跟踪主伸长及其对应方向。该问题在连续介质力学的框架内提出，并要求一个能够处理特征值交叉和简并情况的数值鲁棒算法。\n\n### 步骤 1：提取已知信息\n\n- **变形梯度**：一个张量序列 $\\{\\boldsymbol{F}_k\\}_{k=0}^{N}$，其中 $\\boldsymbol{F}_k \\in \\mathbb{R}^{3 \\times 3}$，可逆、对称且正定。\n- **右柯西-格林张量**：$\\boldsymbol{C}_k = \\boldsymbol{F}_k^{\\mathsf{T}} \\boldsymbol{F}_k$。由于 $\\boldsymbol{F}_k$ 是对称的，所以 $\\boldsymbol{C}_k = \\boldsymbol{F}_k^2$。\n- **主伸长**：$\\{\\lambda_{k,i}\\}_{i=1}^{3}$，$\\boldsymbol{C}_k$ 特征值的正平方根。\n- **主方向**：$\\{\\boldsymbol{v}_{k,i}\\}_{i=1}^{3}$，$\\boldsymbol{C}_k$ 的标准正交单位特征向量。\n- **路径离散化**：$N=10$ 个步骤，参数 $t_k = k/10$，$k=0, \\dots, 10$。\n- **数值容差**：$\\tau = 10^{-8}$，用于检测近乎重复的主伸长。\n- **初始化 ($k=0$)**：\n    1. 计算 $\\boldsymbol{C}_0$ 的特征对。\n    2. 按严格降序排列主伸长 $(\\lambda_{0,i})$ 以标记它们。\n    3. 使用相应特征向量的字典序来打破伸长值的平局。\n    4. 得到的有序特征向量成为初始标记方向 $(\\boldsymbol{p}_{0,i})$。\n- **传递 ($k > 0$)**：\n    1. 计算 $\\boldsymbol{C}_k$ 的特征对。\n    2. 将当前的特征对分配给先前的标签 $(i=1,2,3)$，以最大化连续性。\n    3. **客观性**：该过程必须在固定的基变换下保持不变，并且只使用内积和伸长。\n    4. **符号解析**：通过选择方向向量的符号，确保 $\\boldsymbol{p}_{k-1,i}^{\\mathsf{T}} \\boldsymbol{p}_{k,i} \\ge 0$，从而强制实现方向的连续性。\n    5. **简并处理**：对于容差 $\\tau$ 内的当前伸长，将其特征向量视为张成一个简并子空间。在此子空间内，找到一个新的标准正交基，使其与前一步对应的基最大程度地对齐。这被指定为解决一个“最佳正交对齐问题”。\n- **测试用例**：四个用例（A, B, C, D），具有明确的 $\\boldsymbol{F}_k$ 公式。\n- **输出**：一个包含四个列表的单一列表。每个内部列表包含一个测试用例在跟踪标签顺序下的三个最终主伸长 $(\\lambda_{10,1}, \\lambda_{10,2}, \\lambda_{10,3})$，四舍五入到六位小数。\n\n### 步骤 2：使用提取的已知信息进行验证\n\n- **科学依据**：该问题是使用连续介质力学的标准基本定义（变形梯度、柯西-格林张量、主伸长/方向）来表述的。在交叉和简并情况下跟踪特征系统是计算固体力学中一个公认且关键的课题。其前提在事实上和科学上都是合理的。\n- **适定性**：问题是适定的。它指定了明确的目标，为测试用例提供了所有必要的数据和数学公式，并概述了一个虽复杂但具有建设性的求解过程。处理简并和确保连续性的要求足够具体，可以指导确定性算法的实现。\n- **客观性**：问题是用精确、客观的数学术语陈述的。\n\n该问题没有表现出任何无效性缺陷。它是一个非平凡但定义明确的固体力学计算问题。\n\n### 步骤 3：结论与行动\n\n问题陈述是**有效的**。将提供一个解决方案。\n\n### 基于原则的解决方案设计\n\n问题的核心是在从一步到下一步的特征数据（主伸长和主方向）之间建立连续的对应关系。在每一步都按伸长大小进行朴素排序的方法会在伸长交叉时失效，因为标签会在不同的物理变形模式之间不连续地跳跃。算法必须“记住”它正在跟踪解的哪个分支。\n\n该解决方案通过从 $k=0$ 到 $k=N$ 的逐步更新过程来实现。\n\n**初始化 ($k=0$)**\n1.  对于初始变形梯度 $\\boldsymbol{F}_0$，计算右柯西-格林张量 $\\boldsymbol{C}_0 = \\boldsymbol{F}_0^2$。\n2.  求解 $\\boldsymbol{C}_0$ 的特征值问题，以获得其特征值 $\\mu_{0,j}$ 和特征向量 $\\boldsymbol{v}_{0,j}$。NumPy 函数 `numpy.linalg.eigh` 非常适合此任务，因为它能处理对称矩阵并返回排序后的特征值和相应的特征向量标准正交基。\n3.  初始主伸长为 $\\lambda_{0,j} = \\sqrt{\\mu_{0,j}}$。\n4.  建立初始标签 $i \\in \\{1, 2, 3\\}$。伸长按严格降序排序。为确保在平局（伸长值相同）情况下的确定性行为，相应的特征向量按字典序排序。这个排序顺序定义了初始标记的伸长 $\\Lambda_0 = (\\lambda_{0,1}, \\lambda_{0,2}, \\lambda_{0,3})$ 和方向 $\\boldsymbol{P}_0 = (\\boldsymbol{p}_{0,1}, \\boldsymbol{p}_{0,2}, \\boldsymbol{p}_{0,3})$。\n\n**传递与跟踪 ($k > 0$)**\n在每一步 $k$，我们有前一步的标记方向 $\\boldsymbol{P}_{k-1}$，并计算 $\\boldsymbol{C}_k$ 的原始、未标记的特征对 $(\\mu_{k,j}, \\boldsymbol{v}_{k,j})$。目标是找到一个排列 $\\pi$ 和一组调整后的方向 $\\boldsymbol{p}_{k,i}$，使得从标签 $i$ 到 $\\boldsymbol{p}_{k,i}$ 的映射是连续的。\n\n该过程必须鲁棒地处理简并情况，即特征求解器可能为对应于几乎相同特征值的子空间返回一个任意的标准正交基。问题陈述明确要求解决一个“最佳正交对齐问题”来解决这种模糊性。这是通过正交普罗克汝斯忒斯问题（Orthogonal Procrustes problem）来实现的。\n\n步骤 $k$ 的算法如下：\n\n1.  **计算当前特征数据**：计算 $\\boldsymbol{C}_k = \\boldsymbol{F}_k^2$ 并使用 `numpy.linalg.eigh` 找到其特征值 $\\mu_{k,j}$ 和特征向量 $\\boldsymbol{v}_{k,j}$。这些是当前步骤的“原始”数据。令当前伸长为 $\\lambda_{k,j} = \\sqrt{\\mu_{k,j}}$。\n\n2.  **识别简并子空间**：根据当前原始伸长值的邻近性，将当前原始特征向量分组到子空间中。如果一组伸长 $\\{\\lambda_{k,j}\\}$ 的两两绝对差都小于容差 $\\tau$，则它们形成一个简并组。\n\n3.  **对齐简并子空间**：对于在当前步骤中识别出的每个简并子空间：\n    a. 我们必须首先从前一步 $\\boldsymbol{P}_{k-1}$ 中识别出与当前简并子空间最接近的标记方向集。这种对应关系可以通过找到哪些先前的方向在当前原始子空间上具有最大的投影来建立。一个简单而鲁棒的方法是使用线性分配问题（LAP）来找到所有先前方向和所有当前方向之间的初步最佳猜测排列。\n    b. 令先前对应子空间的基为矩阵 $\\boldsymbol{A}$，当前简并子空间的原始基为矩阵 $\\boldsymbol{B}$。\n    c. 我们解决正交普罗克汝斯忒斯问题：找到使弗罗贝尼乌斯范数 $\\|\\boldsymbol{A} - \\boldsymbol{B}\\boldsymbol{R}\\|_F^2$ 最小化的正交矩阵 $\\boldsymbol{R}$。这个 $\\boldsymbol{R}$ 代表了将基 $\\boldsymbol{B}$ 与目标基 $\\boldsymbol{A}$ 最佳对齐的旋转。为此使用 `scipy.linalg.orthogonal_procrustes` 函数。\n    d. 然后计算出当前子空间的一个新的、对齐的基 $\\boldsymbol{B}_{aligned} = \\boldsymbol{B} \\boldsymbol{R}$。$\\boldsymbol{B}_{aligned}$ 的列替换了当前方向集中的原始原始特征向量。此过程“解开”了特征求解器返回的任意基，使其与前一步连续。\n\n4.  **最终分配**：在所有简并子空间都已对齐后，执行先前标签与（现已对齐的）当前方向之间的最终分配。这被视为一个线性分配问题。构建一个成本矩阵，其中将先前方向 $\\boldsymbol{p}_{k-1,i}$ 分配给当前方向 $\\boldsymbol{v}'_{k,j}$ 的成本由 $1.0 - (\\boldsymbol{p}_{k-1,i}^{\\mathsf{T}} \\boldsymbol{v}'_{k,j})^2$ 给出。最小化总成本可找到最大化整体对齐的排列。`scipy.optimize.linear_sum_assignment` 函数解决此问题。\n\n5.  **更新与符号解析**：来自 LAP 的排列确定了新的标记伸长 $\\lambda_{k,i}$ 和方向 $\\boldsymbol{p}_{k,i}$。对于每个标签 $i$，调整新方向向量 $\\boldsymbol{p}_{k,i}$ 的符号（如果需要则翻转），以确保与前一方向的内积为非负（$\\boldsymbol{p}_{k-1,i}^{\\mathsf{T}} \\boldsymbol{p}_{k,i} \\ge 0$），从而满足符号连续性要求。\n\n对路径中的所有步骤重复此过程。然后报告在 $k=N$ 时的最终标记伸长。这种方法系统地解决了所有要求，为主伸长和方向的鲁棒跟踪提供了保障。", "answer": "[[1.400000,1.500000,1.000000],[1.100000,1.300000,0.950000],[1.200000,1.200000,0.800000],[0.900000,1.050000,1.100000]]", "id": "2675219"}]}