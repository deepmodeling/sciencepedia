{"hands_on_practices": [{"introduction": "为了建立对有限应变塑性中核心概念的直观理解，我们从最简单的一维单轴拉伸问题开始。这个练习将帮助你区分材料本身的硬化响应和有限变形引起的“几何软化”效应。通过推导和比较有限应变算法模量与小应变切线模量，你将深刻理解在大变形下几何非线性如何影响结构的表观刚度，这是理解结构失稳问题的关键一步。", "problem": "一根直的等截面杆承受单轴单调拉伸，直至达到有限轴向拉伸。采用基于乘法分解和 Hencky 弹性的 一维有限应变弹塑性模型，以分离几何效应。\n\n运动学和弹性：设总轴向拉伸为 $\\lambda$，其乘法分解为 $\\lambda = \\lambda_{e}\\,\\lambda_{p}$。定义对数 (Hencky) 应变为 $\\varepsilon = \\ln \\lambda$，$\\varepsilon_{e} = \\ln \\lambda_{e}$ 和 $\\varepsilon_{p} = \\ln \\lambda_{p}$，从而得到 $\\varepsilon = \\varepsilon_{e} + \\varepsilon_{p}$。弹性储存能量密度为 $W(\\varepsilon_{e}) = \\tfrac{1}{2} E \\varepsilon_{e}^{2}$，其中 $E$ 为杨氏模量。Kirchhoff 应力为 $\\tau = \\partial W/\\partial \\varepsilon_{e} = E \\varepsilon_{e}$，轴向第一 Piola-Kirchhoff 应力为 $P = \\tau/\\lambda$。\n\n塑性：在单调拉伸下，考虑具有线性各向同性硬化的关联、率无关塑性。屈服函数为 $\\phi(\\tau,\\kappa) = \\tau - (\\tau_{y0} + H \\kappa) \\le 0$，其中 $\\tau_{y0}$ 是以 Kirchhoff 单位表示的初始屈服应力，$H$ 是塑性模量，$\\kappa$ 是累积塑性应变。在单调拉伸下，取 $\\kappa = \\varepsilon_{p}$，流动法则是 $d \\varepsilon_{p} = d \\gamma$，并满足 Kuhn–Tucker 条件 $d\\gamma \\ge 0$，$\\phi \\le 0$，$d\\gamma\\,\\phi = 0$。\n\n加载步和参数：杆从初始无应力、无塑性应变的状态加载到有限拉伸 $\\lambda = 1.20$。材料参数为 $E = 210\\,\\mathrm{GPa}$，$H = 2\\,\\mathrm{GPa}$，以及 $\\tau_{y0} = 0.300\\,\\mathrm{GPa}$。\n\n目标量的定义：将有限应变问题的标量算法模量定义为在弹塑性响应路径下，在加载步结束时计算的一致切线 \n$$K_{\\mathrm{alg}}^{\\mathrm{F}} := \\frac{d P}{d \\lambda}$$\n将其小应变对应量定义为在单调塑性流动下，具有相同 $E$ 和 $H$ 的单轴小应变弹塑性模型的一致弹塑性切线 \n$$E_{t}^{\\mathrm{S}} := \\frac{d \\sigma}{d \\varepsilon}$$\n\n任务：从给定的运动学、能量和塑性定义出发，推导在 $\\lambda = 1.20$ 时的 $K_{\\mathrm{alg}}^{\\mathrm{F}}$ 和 $E_{t}^{\\mathrm{S}}$，并计算比率 \n$$r := \\frac{K_{\\mathrm{alg}}^{\\mathrm{F}}}{E_{t}^{\\mathrm{S}}}.$$\n将 $r$ 的最终答案表示为一个纯数，四舍五入到四位有效数字。最终数字不包含单位。", "solution": "首先对问题陈述进行严格验证。\n\n**步骤1：提取已知条件**\n- **运动学**：总轴向拉伸 $\\lambda$，其乘法分解为 $\\lambda = \\lambda_{e}\\,\\lambda_{p}$。对数 (Hencky) 应变：$\\varepsilon = \\ln \\lambda$，$\\varepsilon_{e} = \\ln \\lambda_{e}$，和 $\\varepsilon_{p} = \\ln \\lambda_{p}$，得到加法分解 $\\varepsilon = \\varepsilon_{e} + \\varepsilon_{p}$。\n- **弹性**：弹性储存能量密度 $W(\\varepsilon_{e}) = \\tfrac{1}{2} E \\varepsilon_{e}^{2}$。Kirchhoff 应力 $\\tau = \\partial W/\\partial \\varepsilon_{e} = E \\varepsilon_{e}$。第一 Piola-Kirchhoff 应力 $P = \\tau/\\lambda$。\n- **塑性**：关联、率无关塑性，伴随线性各向同性硬化。屈服函数 $\\phi(\\tau,\\kappa) = \\tau - (\\tau_{y0} + H \\kappa) \\le 0$。在单调拉伸下，累积塑性应变为 $\\kappa = \\varepsilon_{p}$。流动法则是 $d \\varepsilon_{p} = d \\gamma$，并满足 Kuhn–Tucker 条件 $d\\gamma \\ge 0$，$\\phi \\le 0$，$d\\gamma\\,\\phi = 0$。\n- **加载和参数**：杆从无应力、无塑性应变的状态加载到最终拉伸 $\\lambda = 1.20$。材料参数为杨氏模量 $E = 210\\,\\mathrm{GPa}$，塑性模量 $H = 2\\,\\mathrm{GPa}$，以及初始屈服应力 $\\tau_{y0} = 0.300\\,\\mathrm{GPa}$。\n- **目标量**：\n  - 有限应变算法模量：$K_{\\mathrm{alg}}^{\\mathrm{F}} := \\frac{d P}{d \\lambda}$，在 $\\lambda = 1.20$ 处计算。\n  - 小应变一致弹塑性切线：$E_{t}^{\\mathrm{S}} := \\frac{d \\sigma}{d \\varepsilon}$，适用于具有相同 $E$ 和 $H$ 的小应变模型。\n  - 比率：$r := \\frac{K_{\\mathrm{alg}}^{\\mathrm{F}}}{E_{t}^{\\mathrm{S}}}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题在连续介质塑性力学的标准框架内构建，使用了乘法运动学、基于 Hencky 应变的超弹性定律和关联流动理论。这些都是固体力学中完善且基本的概念。\n- **适定性**：问题是完全明确的。本构模型完整，初始条件已说明，加载已定义，所有材料参数均已提供。目标是计算一个定义明确的数学量。\n- **客观性**：问题使用精确、无歧义的数学和物理术语进行陈述。\n\n**结论**：该问题在科学上是合理的，自洽的，并且是适定的。它没有违反任何无效性标准。因此，将推导求解。\n\n推导过程分为三个部分：首先，推导小应变切线模量 $E_{t}^{\\mathrm{S}}$；其次，推导有限应变切线模量 $K_{\\mathrm{alg}}^{\\mathrm{F}}$；第三，计算比率 $r$。\n\n**第1部分：小应变切线模量 $E_{t}^{\\mathrm{S}}$ 的推导**\n在小应变背景下，应力和应变的关系为 $\\sigma = E(\\varepsilon - \\varepsilon_p)$。在塑性流动期间，单调拉伸的屈服条件为 $\\phi = \\sigma - (\\sigma_{y0} + H\\varepsilon_p) = 0$。一致性条件 $d\\phi = 0$ 必须成立。\n$$ d\\phi = d\\sigma - H d\\varepsilon_p = 0 \\implies d\\sigma = H d\\varepsilon_p $$\n从弹性关系式，我们微分求得 $d\\sigma = E(d\\varepsilon - d\\varepsilon_p)$。\n将 $d\\varepsilon_p = d\\sigma/H$ 代入微分后的弹性定律得到：\n$$ d\\sigma = E\\left(d\\varepsilon - \\frac{d\\sigma}{H}\\right) $$\n$$ d\\sigma \\left(1 + \\frac{E}{H}\\right) = E d\\varepsilon $$\n$$ d\\sigma \\left(\\frac{H+E}{H}\\right) = E d\\varepsilon $$\n因此，小应变切线模量为：\n$$ E_{t}^{\\mathrm{S}} = \\frac{d\\sigma}{d\\varepsilon} = \\frac{EH}{E+H} $$\n这是线性硬化的一个标准结果。\n\n**第2部分：有限应变算法模量 $K_{\\mathrm{alg}}^{\\mathrm{F}}$ 的推导**\n目标是 $K_{\\mathrm{alg}}^{\\mathrm{F}} = \\frac{dP}{d\\lambda}$。第一 Piola-Kirchhoff 应力由 $P = \\tau/\\lambda$ 给出。使用关于 $\\lambda$ 的商法则求导：\n$$ K_{\\mathrm{alg}}^{\\mathrm{F}} = \\frac{d P}{d \\lambda} = \\frac{1}{\\lambda}\\frac{d\\tau}{d\\lambda} - \\frac{\\tau}{\\lambda^2} $$\n为了求出 $\\frac{d\\tau}{d\\lambda}$，我们使用有限应变模型的本构关系和一致性条件。在塑性加载期间，屈服条件是激活的：$\\phi = \\tau - (\\tau_{y0} + H\\varepsilon_p) = 0$。其率形式为 $d\\phi = 0$：\n$$ d\\tau - H d\\varepsilon_p = 0 \\implies d\\tau = H d\\varepsilon_p $$\nKirchhoff 应力也由弹性定律 $\\tau = E\\varepsilon_e = E(\\varepsilon - \\varepsilon_p) = E(\\ln\\lambda - \\varepsilon_p)$ 给出。对此式关于 $\\lambda$ 求导可得：\n$$ \\frac{d\\tau}{d\\lambda} = E \\left(\\frac{1}{\\lambda} - \\frac{d\\varepsilon_p}{d\\lambda}\\right) $$\n我们得到了一个关于率 $\\frac{d\\tau}{d\\lambda}$ 和 $\\frac{d\\varepsilon_p}{d\\lambda}$ 的方程组。根据一致性条件，$\\frac{d\\varepsilon_p}{d\\lambda} = \\frac{1}{H}\\frac{d\\tau}{d\\lambda}$。将此代入第二个方程：\n$$ \\frac{d\\tau}{d\\lambda} = E \\left(\\frac{1}{\\lambda} - \\frac{1}{H}\\frac{d\\tau}{d\\lambda}\\right) $$\n$$ \\frac{d\\tau}{d\\lambda}\\left(1 + \\frac{E}{H}\\right) = \\frac{E}{\\lambda} $$\n$$ \\frac{d\\tau}{d\\lambda}\\left(\\frac{E+H}{H}\\right) = \\frac{E}{\\lambda} $$\n解出 $\\frac{d\\tau}{d\\lambda}$：\n$$ \\frac{d\\tau}{d\\lambda} = \\frac{E}{\\lambda}\\frac{H}{E+H} = \\frac{1}{\\lambda} E_{t}^{\\mathrm{S}} $$\n现在，我们将此结果代回 $K_{\\mathrm{alg}}^{\\mathrm{F}}$ 的表达式中：\n$$ K_{\\mathrm{alg}}^{\\mathrm{F}} = \\frac{1}{\\lambda}\\left(\\frac{1}{\\lambda}E_{t}^{\\mathrm{S}}\\right) - \\frac{\\tau}{\\lambda^2} = \\frac{E_{t}^{\\mathrm{S}} - \\tau}{\\lambda^2} $$\n该表达式需要在指定的最终拉伸 $\\lambda = 1.20$ 处的 Kirchhoff 应力 $\\tau$ 的值。\n\n**第3部分：状态变量和比率 $r$ 的计算**\n首先，我们必须确定材料在 $\\lambda = 1.20$ 时是否已经屈服。当纯弹性变形产生的应力达到 $\\tau_{y0}$ 时发生屈服。在弹性范围内，$\\varepsilon_p = 0$，所以 $\\tau = E\\varepsilon_e = E\\ln\\lambda$。屈服时的拉伸 $\\lambda_y$ 可通过设置 $\\tau = \\tau_{y0}$ 求得：\n$$ E \\ln\\lambda_y = \\tau_{y0} \\implies \\lambda_y = \\exp\\left(\\frac{\\tau_{y0}}{E}\\right) $$\n使用给定值，$\\frac{\\tau_{y0}}{E} = \\frac{0.300\\,\\mathrm{GPa}}{210\\,\\mathrm{GPa}} = \\frac{1}{700}$。\n$$ \\lambda_y = \\exp\\left(\\frac{1}{700}\\right) \\approx 1.00143 $$\n由于最终拉伸 $\\lambda=1.20$ 大于 $\\lambda_y$，材料处于塑性区。\n\n为了求出在 $\\lambda = 1.20$ 时的应力 $\\tau$，我们求解由屈服条件和本构定律定义的方程组：\n1. $\\tau = \\tau_{y0} + H\\varepsilon_p$\n2. $\\tau = E(\\ln\\lambda - \\varepsilon_p)$\n令 $\\tau$ 的表达式相等：\n$$ \\tau_{y0} + H\\varepsilon_p = E\\ln\\lambda - E\\varepsilon_p $$\n解出塑性应变 $\\varepsilon_p$：\n$$ (E+H)\\varepsilon_p = E\\ln\\lambda - \\tau_{y0} \\implies \\varepsilon_p = \\frac{E\\ln\\lambda - \\tau_{y0}}{E+H} $$\n将 $\\varepsilon_p$ 的这个表达式代回屈服条件以求出 $\\tau$：\n$$ \\tau = \\tau_{y0} + H\\left(\\frac{E\\ln\\lambda - \\tau_{y0}}{E+H}\\right) = \\frac{\\tau_{y0}(E+H) + H(E\\ln\\lambda - \\tau_{y0})}{E+H} $$\n$$ \\tau = \\frac{E\\tau_{y0} + HE\\ln\\lambda}{E+H} = \\frac{E}{E+H}\\tau_{y0} + \\frac{EH}{E+H}\\ln\\lambda = \\frac{E}{E+H}\\tau_{y0} + E_{t}^{\\mathrm{S}}\\ln\\lambda $$\n所求的比率是 $r = \\frac{K_{\\mathrm{alg}}^{\\mathrm{F}}}{E_{t}^{\\mathrm{S}}}$。代入推导出的表达式：\n$$ r = \\frac{(E_{t}^{\\mathrm{S}}-\\tau)/\\lambda^2}{E_{t}^{\\mathrm{S}}} = \\frac{1}{\\lambda^2}\\left(1 - \\frac{\\tau}{E_{t}^{\\mathrm{S}}}\\right) $$\n我们可以使用我们得到的 $\\tau$ 的表达式来简化 $\\frac{\\tau}{E_{t}^{\\mathrm{S}}}$ 这一项：\n$$ \\frac{\\tau}{E_{t}^{\\mathrm{S}}} = \\frac{\\frac{E}{E+H}\\tau_{y0} + E_{t}^{\\mathrm{S}}\\ln\\lambda}{E_{t}^{\\mathrm{S}}} = \\left(\\frac{E}{E+H}\\tau_{y0}\\right)\\frac{1}{E_{t}^{\\mathrm{S}}} + \\ln\\lambda $$\n由于 $E_{t}^{\\mathrm{S}} = \\frac{EH}{E+H}$，其倒数为 $\\frac{1}{E_{t}^{\\mathrm{S}}} = \\frac{E+H}{EH}$。\n$$ \\frac{\\tau}{E_{t}^{\\mathrm{S}}} = \\left(\\frac{E}{E+H}\\tau_{y0}\\right)\\left(\\frac{E+H}{EH}\\right) + \\ln\\lambda = \\frac{\\tau_{y0}}{H} + \\ln\\lambda $$\n这为比率 $r$ 提供了一个简单的表达式：\n$$ r = \\frac{1}{\\lambda^2}\\left(1 - \\left(\\frac{\\tau_{y0}}{H} + \\ln\\lambda\\right)\\right) $$\n现在，我们代入数值：$\\lambda = 1.20$，$\\tau_{y0} = 0.300\\,\\mathrm{GPa}$，和 $H = 2\\,\\mathrm{GPa}$。\n$$ r = \\frac{1}{(1.20)^2}\\left(1 - \\left(\\frac{0.300}{2} + \\ln(1.20)\\right)\\right) $$\n$$ r = \\frac{1}{1.44}\\left(1 - (0.150 + 0.182321556...)\\right) $$\n$$ r = \\frac{1}{1.44}\\left(1 - 0.332321556...\\right) $$\n$$ r = \\frac{0.667678443...}{1.44} $$\n$$ r \\approx 0.46366558... $$\n四舍五入到四位有效数字，结果是 $0.4637$。\n比率 $r$ 量化了在有限应变设置中，与纯材料模量 $E_{t}^{\\mathrm{S}}$ 相比，几何软化（$K_{\\mathrm{alg}}^{\\mathrm{F}}$ 中的 $-\\tau/\\lambda^2$ 项）和运动学缩放（因子 $1/\\lambda^2$）对切线模量的综合影响。", "answer": "$$\\boxed{0.4637}$$", "id": "2640736"}, {"introduction": "掌握了一维连续介质模型后，下一步是理解如何在三维情况下进行数值求解，这是现代计算塑性力学的核心。本练习将引导你深入“返回映射”算法的内部，这是求解弹塑性本构方程的基石。你的任务是推导用于确定塑性乘子增量的标量残差方程，这个过程能让你彻底明白如何将抽象的塑性流动法则和一致性条件，转化为可供计算机求解的具体代数方程。", "problem": "考虑一个经历有限应变的各向同性弹塑性材料。其运动学遵循变形梯度的乘法分解 $\\,\\mathbf{F} = \\mathbf{F}_{\\mathrm{e}} \\mathbf{F}_{\\mathrm{p}}$，其中塑性流动是等体积的，即 $\\,\\det \\mathbf{F}_{\\mathrm{p}} = 1\\,$. 设弹性自由能为可压缩 Neo-Hookean 类型，\n$$\nW(\\mathbf{b}_{\\mathrm{e}},J) = \\tfrac{1}{2}\\kappa \\big(\\ln J\\big)^{2} + \\tfrac{\\mu}{2}\\Big(\\operatorname{tr}(\\mathbf{b}_{\\mathrm{e}}) - 3 - 2 \\ln J\\Big),\n$$\n其中 $\\,\\mathbf{b}_{\\mathrm{e}} = \\mathbf{F}_{\\mathrm{e}}\\mathbf{F}_{\\mathrm{e}}^{\\mathsf{T}}\\,$ 是弹性左 Cauchy-Green 张量，$\\,J = \\det \\mathbf{F}\\,$，$\\,\\kappa\\,$ 是体积模量，$\\,\\mu\\,$ 是剪切模量。Kirchhoff 应力定义为\n$$\n\\boldsymbol{\\tau} = \\kappa \\ln J \\,\\mathbf{I} + \\mu\\,\\operatorname{dev}(\\mathbf{b}_{\\mathrm{e}}), \\quad \\text{因此} \\quad \\mathbf{s} := \\operatorname{dev}(\\boldsymbol{\\tau}) = \\mu\\,\\operatorname{dev}(\\mathbf{b}_{\\mathrm{e}}).\n$$\n塑性行为由一个带线性各向同性硬化的关联 von Mises（也称为 $J_{2}$）屈服函数控制，\n$$\n\\Phi(\\boldsymbol{\\tau}, \\bar{\\varepsilon}^{\\mathrm{p}}) = \\big\\|\\mathbf{s}\\big\\| - \\sqrt{\\tfrac{2}{3}}\\Big(\\sigma_{y0} + H\\,\\bar{\\varepsilon}^{\\mathrm{p}}\\Big) \\le 0,\n$$\n其中 $\\,\\|\\cdot\\|\\,$ 表示 Frobenius 范数，$\\,\\sigma_{y0}\\,$ 是初始屈服应力，$\\,H\\,$ 是塑性模量，$\\,\\bar{\\varepsilon}^{\\mathrm{p}}\\,$ 是累积等效塑性应变。流动法则是关联的，塑性变形率为 $\\,\\mathbf{D}_{\\mathrm{p}} = \\dot{\\gamma}\\,\\mathbf{n}\\,$，其中 $\\,\\mathbf{n} = \\partial \\Phi/\\partial \\boldsymbol{\\tau} = \\mathbf{s}/\\|\\mathbf{s}\\|\\,$ 是流动方向，硬化法则为 $\\,\\dot{\\bar{\\varepsilon}}^{\\mathrm{p}} = \\dot{\\gamma}\\,$。在一个从 $\\,t_{n}\\,$ 到 $\\,t_{n+1}\\,$ 的时间步内，使用后向欧拉时间离散化方法对演化方程进行离散，并采用标准的弹性预测-塑性修正（隐式返回映射）算法。用上标 $\\,\\mathrm{tr}\\,$ 表示试探量（通过在该步中将塑性增量设为零得到）。\n\n从上述定义和乘法运动学出发，推导在时间步末强制满足屈服条件的算法一致性条件，并证明未知的塑性乘子增量 $\\,\\Delta\\gamma\\,$ 可以通过求解一个单一标量非线性方程获得。消去张量未知数，使其表达式只包含 $\\,\\Delta\\gamma\\,$ 和先前已知的第 $\\,n\\,$ 步的量。假设在修正过程中，方向 $\\,\\mathbf{n}_{n+1}\\,$ 与试探 Kirchhoff 偏应力方向一致，即 $\\,\\mathbf{n}_{n+1} = \\mathbf{s}^{\\mathrm{tr}}/\\|\\mathbf{s}^{\\mathrm{tr}}\\|\\,$，并且在用于关联 $J_{2}$ 塑性与 Neo-Hookean 弹性的后向欧拉格式下，Kirchhoff 偏应力沿着 $\\,\\mathbf{n}_{n+1}\\,$ 进行修正。\n\n你的最终任务是提供标量残差函数 $\\,R(\\Delta\\gamma)\\,$，该函数的根能在 $\\,t_{n+1}\\,$ 时刻强制满足算法一致性条件。$\\,R(\\Delta\\gamma)\\,$ 的表达式应只包含 $\\,\\|\\mathbf{s}^{\\mathrm{tr}}\\|\\,$, $\\,\\mu\\,$, $\\,\\sigma_{y0}\\,$, $\\,H\\,$ 和 $\\,\\bar{\\varepsilon}^{\\mathrm{p}}_{n}\\,$. 不要在你最终的方框答案中包含任何待解方程；仅以单个闭式表达式的形式提供残差函数。无需进行数值计算。所有数学实体均以 LaTeX 格式表示。", "solution": "在尝试求解之前，将对问题的有效性进行分析。\n\n首先，我将逐字从问题陈述中提取已知条件。\n-   运动学：乘法分解 $\\mathbf{F} = \\mathbf{F}_{\\mathrm{e}} \\mathbf{F}_{\\mathrm{p}}$。\n-   塑性流动约束：等体积，$\\det \\mathbf{F}_{\\mathrm{p}} = 1$。\n-   弹性自由能函数（可压缩 Neo-Hookean）：$W(\\mathbf{b}_{\\mathrm{e}},J) = \\tfrac{1}{2}\\kappa (\\ln J)^{2} + \\tfrac{\\mu}{2}(\\operatorname{tr}(\\mathbf{b}_{\\mathrm{e}}) - 3 - 2 \\ln J)$。\n-   弹性左 Cauchy-Green 张量：$\\mathbf{b}_{\\mathrm{e}} = \\mathbf{F}_{\\mathrm{e}}\\mathbf{F}_{\\mathrm{e}}^{\\mathsf{T}}$。\n-   总体积变化：$J = \\det \\mathbf{F}$。\n-   Kirchhoff 应力张量：$\\boldsymbol{\\tau} = \\kappa \\ln J \\,\\mathbf{I} + \\mu\\,\\operatorname{dev}(\\mathbf{b}_{\\mathrm{e}})$。\n-   Kirchhoff 偏应力：$\\mathbf{s} := \\operatorname{dev}(\\boldsymbol{\\tau}) = \\mu\\,\\operatorname{dev}(\\mathbf{b}_{\\mathrm{e}})$。\n-   屈服函数（带线性各向同性硬化的 von Mises）：$\\Phi(\\boldsymbol{\\tau}, \\bar{\\varepsilon}^{\\mathrm{p}}) = \\|\\mathbf{s}\\| - \\sqrt{\\tfrac{2}{3}}(\\sigma_{y0} + H\\,\\bar{\\varepsilon}^{\\mathrm{p}}) \\le 0$。\n-   流动法则：关联的，塑性变形率 $\\mathbf{D}_{\\mathrm{p}} = \\dot{\\gamma}\\,\\mathbf{n}$。\n-   流动方向：$\\mathbf{n} = \\partial \\Phi/\\partial \\boldsymbol{\\tau} = \\mathbf{s}/\\|\\mathbf{s}\\|$。\n-   硬化法则：$\\dot{\\bar{\\varepsilon}}^{\\mathrm{p}} = \\dot{\\gamma}$。\n-   数值格式：在从 $t_{n}$ 到 $t_{n+1}$ 的时间步上采用后向欧拉时间离散化，并以弹性预测-塑性修正算法实现。\n-   假设 1：在修正步中，流动方向是固定的：$\\mathbf{n}_{n+1} = \\mathbf{s}^{\\mathrm{tr}}/\\|\\mathbf{s}^{\\mathrm{tr}}\\|$。\n-   假设 2：Kirchhoff 偏应力沿着该固定方向进行修正。\n-   任务：推导塑性乘子增量 $\\Delta\\gamma$ 的标量残差函数 $R(\\Delta\\gamma)$。\n\n接下来，我将验证问题陈述的有效性。\n该问题具有科学依据。它提出了一个计算有限应变弹塑性力学的标准框架，利用了诸如乘法运动学、Neo-Hookean 超弹性模型和关联 $J_{2}$ 流动理论等成熟概念。这些都是现代固体力学中的基石课题。\n该问题是适定的。它要求在返回映射算法中推导塑性乘子的标量方程，这是计算力学中的一个标准可解问题。所提供的假设（例如固定的流动方向）是简化算法并确保增量 $\\Delta\\gamma$ 具有唯一解的典型做法。\n该问题是客观且自洽的。所有必要的本构定义、运动学关系和演化方程都已提供。语言精确，没有主观论断。该问题直接关系到*固体力学*领域中指定的*有限应变塑性*分支。不存在会妨碍严格推导的内部矛盾或缺失信息。\n基于此分析，该问题被认为是**有效的**。我现在将开始求解。\n\n目标是推导标量残差函数 $R(\\Delta\\gamma)$，当其为零时，可确定从 $t_{n}$ 到 $t_{n+1}$ 的时间步内的塑性乘子增量 $\\Delta\\gamma$。这是在弹性预测-塑性修正算法的框架内，使用后向欧拉积分格式完成的。我们考虑塑性加载的情况，即试探状态违反了屈服条件。\n\n修正阶段从 $t_{n}$ 时刻的状态和 $t_{n+1}$ 时刻的试探状态开始。目标是找到满足屈服条件的 $t_{n+1}$ 时刻的更新后状态。待更新的状态变量是 Kirchhoff 应力 $\\boldsymbol{\\tau}_{n+1}$ 和等效塑性应变 $\\bar{\\varepsilon}^{\\mathrm{p}}_{n+1}$。驱动更新的未知量是 $\\Delta\\gamma$。\n\n根据后向欧拉格式以及问题中针对关联 $J_{2}$ 塑性与给定 Neo-Hookean 模型的假设，Kirchhoff 偏应力 $\\mathbf{s}_{n+1}$ 是通过在偏应力空间中对试探应力 $\\mathbf{s}^{\\mathrm{tr}}$ 进行径向返回得到的。此更新法则由下式给出：\n$$\n\\mathbf{s}_{n+1} = \\mathbf{s}^{\\mathrm{tr}} - 2\\mu\\Delta\\gamma \\mathbf{n}_{n+1}\n$$\n因子 $2\\mu\\Delta\\gamma$ 是修正量的大小。问题明确指出修正方向为试探偏应力方向，即 $\\mathbf{n}_{n+1} = \\mathbf{s}^{\\mathrm{tr}}/\\|\\mathbf{s}^{\\mathrm{tr}}\\|$。将此代入更新法则，得到：\n$$\n\\mathbf{s}_{n+1} = \\mathbf{s}^{\\mathrm{tr}} - 2\\mu\\Delta\\gamma \\frac{\\mathbf{s}^{\\mathrm{tr}}}{\\|\\mathbf{s}^{\\mathrm{tr}}\\|} = \\left( 1 - \\frac{2\\mu\\Delta\\gamma}{\\|\\mathbf{s}^{\\mathrm{tr}}\\|} \\right) \\mathbf{s}^{\\mathrm{tr}}\n$$\n此关系表明 $\\mathbf{s}_{n+1}$ 与 $\\mathbf{s}^{\\mathrm{tr}}$ 共线。对两边取 Frobenius 范数，得到更新后偏应力的大小：\n$$\n\\|\\mathbf{s}_{n+1}\\| = \\left| 1 - \\frac{2\\mu\\Delta\\gamma}{\\|\\mathbf{s}^{\\mathrm{tr}}\\|} \\right| \\|\\mathbf{s}^{\\mathrm{tr}}\\|\n$$\n由于塑性变形必须减小应力的大小，我们有 $\\|\\mathbf{s}_{n+1}\\|  \\|\\mathbf{s}^{\\mathrm{tr}}\\|$，这意味着 $2\\mu\\Delta\\gamma  0$。因此，可以去掉绝对值，得到：\n$$\n\\|\\mathbf{s}_{n+1}\\| = \\|\\mathbf{s}^{\\mathrm{tr}}\\| - 2\\mu\\Delta\\gamma\n$$\n接下来，我们更新累积等效塑性应变 $\\bar{\\varepsilon}^{\\mathrm{p}}$。其演化由硬化法则 $\\dot{\\bar\\varepsilon}^{\\mathrm{p}} = \\dot{\\gamma}$ 给出。对该率方程应用后向欧拉格式，得到：\n$$\n\\frac{\\bar{\\varepsilon}^{\\mathrm{p}}_{n+1} - \\bar{\\varepsilon}^{\\mathrm{p}}_{n}}{\\Delta t} = \\dot{\\gamma}_{n+1}\n$$\n其中 $\\Delta\\gamma = \\dot{\\gamma}_{n+1}\\Delta t$ 是该时间步内的塑性乘子增量。这得出了更新法则：\n$$\n\\bar{\\varepsilon}^{\\mathrm{p}}_{n+1} = \\bar{\\varepsilon}^{\\mathrm{p}}_{n} + \\Delta\\gamma\n$$\n算法一致性条件要求时间步末的状态位于屈服面上。对于塑性加载（$\\Delta\\gamma  0$），这意味着屈服函数必须为零：\n$$\n\\Phi(\\boldsymbol{\\tau}_{n+1}, \\bar{\\varepsilon}^{\\mathrm{p}}_{n+1}) = 0\n$$\n代入屈服函数的定义，我们有：\n$$\n\\|\\mathbf{s}_{n+1}\\| - \\sqrt{\\frac{2}{3}}\\Big(\\sigma_{y0} + H\\,\\bar{\\varepsilon}^{\\mathrm{p}}_{n+1}\\Big) = 0\n$$\n现在，我们将推导出的 $\\|\\mathbf{s}_{n+1}\\|$ 和 $\\bar{\\varepsilon}^{\\mathrm{p}}_{n+1}$ 的更新表达式代入此一致性条件。这样就消去了张量未知数，只留下标量未知数 $\\Delta\\gamma$：\n$$\n\\left( \\|\\mathbf{s}^{\\mathrm{tr}}\\| - 2\\mu\\Delta\\gamma \\right) - \\sqrt{\\frac{2}{3}}\\Big(\\sigma_{y0} + H\\,(\\bar{\\varepsilon}^{\\mathrm{p}}_{n} + \\Delta\\gamma)\\Big) = 0\n$$\n这就是关于 $\\Delta\\gamma$ 的单一标量方程。问题要求提供残差函数 $R(\\Delta\\gamma)$，其根是该方程的解。我们将残差函数定义为该方程的左手边：\n$$\nR(\\Delta\\gamma) = \\|\\mathbf{s}^{\\mathrm{tr}}\\| - 2\\mu\\Delta\\gamma - \\sqrt{\\frac{2}{3}}\\Big(\\sigma_{y0} + H\\,(\\bar{\\varepsilon}^{\\mathrm{p}}_{n} + \\Delta\\gamma)\\Big)\n$$\n该表达式仅依赖于试探偏应力范数 $\\|\\mathbf{s}^{\\mathrm{tr}}\\|$、材料参数 $\\mu$、$\\sigma_{y0}$、$H$、上一步已知的塑性应变 $\\bar{\\varepsilon}^{\\mathrm{p}}_{n}$ 以及未知增量 $\\Delta\\gamma$，这与问题陈述的要求一致。", "answer": "$$\n\\boxed{\\|\\mathbf{s}^{\\mathrm{tr}}\\| - 2\\mu\\Delta\\gamma - \\sqrt{\\frac{2}{3}}\\Big(\\sigma_{y0} + H(\\bar{\\varepsilon}^{\\mathrm{p}}_{n} + \\Delta\\gamma)\\Big)}\n$$", "id": "2640759"}, {"introduction": "理论的最终检验是实践。这个综合性练习要求你将前面学到的理论和算法付诸于代码实现，从而完成从理论推导到实际应用的跨越。你将为平面应变压缩问题编写一个完整的仿真程序，实现包括弹性预测和塑性修正（返回映射）在内的整个计算循环。这项编程任务不仅能巩固你对整个算法流程的理解，还将让你通过数值结果来验证塑性流动不可压缩等基本假设。", "problem": "考虑一个均匀、等温的固体，其经历有限平面应变压缩，并通过具有乘法运动学的率无关、各向同性 von Mises (J2) 有限应变塑性模型进行建模。设总变形梯度用 $F \\in \\mathbb{R}^{3 \\times 3}$ 表示，弹性变形梯度用 $F_{e} \\in \\mathbb{R}^{3 \\times 3}$ 表示，塑性变形梯度用 $F_{p} \\in \\mathbb{R}^{3 \\times 3}$ 表示，它们通过乘法分解 $F = F_{e} F_{p}$ 关联。假设塑性不可压缩，即 $\\det(F_{p}) = 1$。定义弹性右 Cauchy-Green 张量 $C_{e} = F_{e}^{\\mathsf{T}} F_{e}$，弹性对数 (Hencky) 应变 $E_{e} = \\tfrac{1}{2} \\ln(C_{e})$，以及 Mandel 应力 $M$。取弹性自由能为关于 $E_{e}$ 的二次函数，即\n$$\nW(E_{e}) = \\mu \\, \\| \\operatorname{dev}(E_{e}) \\|^{2} + \\frac{\\kappa}{2} \\left( \\operatorname{tr}(E_{e}) \\right)^{2},\n$$\n其中 $\\mu  0$ 是剪切模量，$\\kappa  0$ 是体积模量，$\\operatorname{dev}(\\cdot)$ 是偏量算子，$\\operatorname{tr}(\\cdot)$ 是迹，$\\|\\cdot\\|$ 是 Frobenius 范数。由此能量可得 Mandel 应力为\n$$\nM = 2 \\mu \\, \\operatorname{dev}(E_{e}) + \\kappa \\, \\operatorname{tr}(E_{e}) \\, I,\n$$\n其中 $I$ 是单位张量。该塑性模型是具有线性各向同性硬化的相关 von Mises (J2) 模型。引入等效塑性应变 $p \\ge 0$ 和屈服应力 $\\sigma_{y}(p) = \\sigma_{y0} + H p$，其中初始屈服应力为 $\\sigma_{y0} \\ge 0$，硬化模量为 $H \\ge 0$。屈服函数为\n$$\n\\Phi(M, p) = \\| \\operatorname{dev}(M) \\| - \\sqrt{\\frac{2}{3}} \\, \\sigma_{y}(p) \\le 0.\n$$\n塑性流动在 Mandel 应力空间中是相关的，并且是塑性等体积的。该过程在给定的运动学路径下，以增量方式在离散伪时间内推进。\n\n任务。从这些核心定义出发，推导一个健全、完全一致的算法，用于计算在给定的对角平面应变压缩路径下 $F_{p}$ 和相应 $M$ 的演化，并数值验证塑性不可压缩性。加载路径全程是对角的和共轴的：设\n$$\nF = \\operatorname{diag}(\\lambda, 1, 1),\n$$\n其中给定的拉伸 $\\lambda \\in (0,1]$ 从 $\\lambda = 1$ 单调施加到最终值，分给定的等增量步数完成。假设弹塑性自旋为零，并且所有张量在整个加载过程中在固定基中保持对角形式，因此主方向不发生演化。\n\n需要推导和实现的算法要求：\n- 使用乘法分解 $F = F_{e} F_{p}$，初始条件为 $F_{p}^{0} = I$ 和 $p^{0} = 0$。\n- 在每个增量步，使用 $C_{e}^{\\mathrm{tr}} = F_{p}^{-\\mathsf{T}} C F_{p}^{-1}$（其中 $C = F^{\\mathsf{T}} F$）计算试探弹性状态，然后计算 $E_{e}^{\\mathrm{tr}} = \\tfrac{1}{2} \\ln(C_{e}^{\\mathrm{tr}})$ 和试探 Mandel 应力。\n- 如果是弹性的，则接受试探状态。如果是塑性的，则在 Mandel 应力空间中执行与相关 von Mises (J2) 塑性和塑性不可压缩性一致的隐式返回映射，对 $E_{e}$ 进行偏量更新，同时保持 $\\operatorname{tr}(E_{e})$ 不变，更新 $p$，重构 $F_{e}$，然后通过乘法分解重构 $F_{p}$。\n- 在每个增量步计算并记录 $F_{p}$ 的行列式，以验证塑性不可压缩性。\n\n交付成果和数值输出：\n- 为以下三个案例的测试套件实现上述算法。所有应力和模量单位为帕斯卡 (Pa)，拉伸为无量纲。对于每个案例，压缩沿 $F = \\operatorname{diag}(\\lambda,1,1)$ 以 $N$ 个相等的增量从 $\\lambda=1$ 单调进行到 $\\lambda=\\lambda_{\\mathrm{final}}$。\n  1. 案例 A (一般塑性响应): $\\mu = 80 \\times 10^{6}$，$\\kappa = 160 \\times 10^{6}$，$\\sigma_{y0} = 120 \\times 10^{6}$， $H = 10 \\times 10^{6}$，$N = 60$，$\\lambda_{\\mathrm{final}} = 0.70$。\n  2. 案例 B (近弹性响应): 与案例 A 相同的材料参数，但 $N = 10$，$\\lambda_{\\mathrm{final}} = 0.98$。\n  3. 案例 C (理想塑性边缘情况): $\\mu = 50 \\times 10^{6}$，$\\kappa = 100 \\times 10^{6}$，$\\sigma_{y0} = 80 \\times 10^{6}$，$H = 0$，$N = 80$，$\\lambda_{\\mathrm{final}} = 0.60$。\n- 对于每个案例，您的程序必须输出一个实数：整个加载路径上与塑性不可压缩性的最大绝对偏差，定义为\n$$\n\\max_{k=1,\\dots,N} \\left| \\det(F_{p}^{(k)}) - 1 \\right|.\n$$\n- 最终输出格式：您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如，“[rA,rB,rC]”），其中 $rA$、$rB$ 和 $rC$ 分别是案例 A、B 和 C 的结果，表示为十进制数（无单位）。\n\n此问题不使用角度度量。所有物理常数均使用国际单位制单位（帕斯卡）。所有要求的数值结果均为如上定义的无单位浮点数。", "solution": "我们从乘法运动学 $F = F_{e} F_{p}$ 和塑性不可压缩性条件 $\\det(F_{p}) = 1$ 开始。弹性右 Cauchy-Green 张量为 $C_{e} = F_{e}^{\\mathsf{T}} F_{e}$，其对数 (Hencky) 应变为 $E_{e} = \\tfrac{1}{2} \\ln(C_{e})$。采用的弹性自由能\n$$\nW(E_{e}) = \\mu \\, \\| \\operatorname{dev}(E_{e}) \\|^{2} + \\frac{\\kappa}{2} \\left( \\operatorname{tr}(E_{e}) \\right)^{2}\n$$\n是客观且各向同性的，由此得到 Mandel 应力\n$$\nM = \\frac{\\partial W}{\\partial E_{e}} = 2 \\mu \\, \\operatorname{dev}(E_{e}) + \\kappa \\, \\operatorname{tr}(E_{e}) \\, I.\n$$\n具有线性各向同性硬化的 von Mises (J2) 屈服函数为\n$$\n\\Phi(M, p) = \\| \\operatorname{dev}(M) \\| - \\sqrt{\\frac{2}{3}} \\left( \\sigma_{y0} + H p \\right) \\le 0,\n$$\n其塑性流动在 Mandel 应力空间中是相关的，同时确保塑性等体积性（零塑性体积应变率）。\n\n给定路径下的运动学和共轴性。加载全程被视为对角的和共轴的，\n$$\nF = \\operatorname{diag}(\\lambda,1,1),\n$$\n其中 $\\lambda$ 从 $1$ 单调地施加到 $\\lambda_{\\mathrm{final}} \\in (0,1]$。由于 $F_{p}^{0} = I$ 且加载是对角的，我们采用零弹塑性自旋，因此所有张量在固定的标准正交基中保持对角。这极大地简化了张量运算：对于任何对角张量 $X = \\operatorname{diag}(x_{1}, x_{2}, x_{3})$，我们有 $\\ln(X) = \\operatorname{diag}(\\ln x_{1}, \\ln x_{2}, \\ln x_{3})$，$\\exp(X) = \\operatorname{diag}(e^{x_{1}}, e^{x_{2}}, e^{x_{3}})$，并且偏量算子简化为减去对角元的平均值。\n\n增量算法。考虑增量步 $n \\to n+1$。给定 $F^{n+1}$（对角）、$F_{p}^{n}$（对角）和 $p^{n}$，我们按以下步骤进行。\n\n1) 试探弹性状态。计算\n$$\nC^{n+1} = (F^{n+1})^{\\mathsf{T}} F^{n+1} = \\operatorname{diag}(\\lambda^{2}, 1, 1), \\quad C_{e}^{\\mathrm{tr}} = (F_{p}^{n})^{-\\mathsf{T}} C^{n+1} (F_{p}^{n})^{-1}.\n$$\n由于所有张量都是对角的，这简化为逐分量除法。然后\n$$\nE_{e}^{\\mathrm{tr}} = \\frac{1}{2} \\ln(C_{e}^{\\mathrm{tr}}), \\quad \\text{因此其分量形式为 } E_{e,ii}^{\\mathrm{tr}} = \\frac{1}{2} \\ln\\left( C_{e,ii}^{\\mathrm{tr}} \\right).\n$$\n计算其偏量部分\n$$\n\\operatorname{dev}\\left( E_{e}^{\\mathrm{tr}} \\right) = E_{e}^{\\mathrm{tr}} - \\frac{1}{3} \\operatorname{tr}(E_{e}^{\\mathrm{tr}}) \\, I,\n$$\n和试探偏量 Mandel 应力\n$$\n\\operatorname{dev}(M)^{\\mathrm{tr}} = 2 \\mu \\, \\operatorname{dev}(E_{e}^{\\mathrm{tr}}), \\quad \\xi^{\\mathrm{tr}} := \\left\\| \\operatorname{dev}(M)^{\\mathrm{tr}} \\right\\|.\n$$\n构造试探屈服函数\n$$\n\\Phi^{\\mathrm{tr}} = \\xi^{\\mathrm{tr}} - \\sqrt{\\frac{2}{3}} \\left( \\sigma_{y0} + H p^{n} \\right).\n$$\n\n2) 弹性步。如果 $\\Phi^{\\mathrm{tr}} \\le 0$，则该步为弹性步。设置 $E_{e}^{n+1} = E_{e}^{\\mathrm{tr}}$，$p^{n+1} = p^{n}$，计算 $F_{e}^{n+1} = \\exp(E_{e}^{n+1})$（对对角张量是逐分量的），并将塑性变形更新为 $F_{p}^{n+1} = (F_{e}^{n+1})^{-1} F^{n+1}$。Mandel 应力为\n$$\nM^{n+1} = 2 \\mu \\, \\operatorname{dev}(E_{e}^{n+1}) + \\kappa \\, \\operatorname{tr}(E_{e}^{n+1}) \\, I.\n$$\n\n3) 塑性步（在 Mandel 应力空间中对 Hencky 弹性模型进行相关返回映射）。如果 $\\Phi^{\\mathrm{tr}}  0$，则需要进行塑性修正。在所采用的能量函数下，$\\operatorname{dev}(M)$ 与 $\\operatorname{dev}(E_{e})$ 呈线性关系且与之共轴。设流动方向为\n$$\nN = \\frac{\\operatorname{dev}(M)^{\\mathrm{tr}}}{\\left\\| \\operatorname{dev}(M)^{\\mathrm{tr}} \\right\\|} = \\frac{\\operatorname{dev}(E_{e}^{\\mathrm{tr}})}{\\left\\| \\operatorname{dev}(E_{e}^{\\mathrm{tr}}) \\right\\|}.\n$$\n相关性和塑性不可压缩性意味着塑性修正仅减小 $E_{e}$ 的偏量部分，而保持 $\\operatorname{tr}(E_{e})$ 不变。用 $\\Delta \\Gamma \\ge 0$ 表示塑性乘子增量。修正后的弹性 Hencky 应变偏量为\n$$\n\\operatorname{dev}(E_{e}^{n+1}) = \\operatorname{dev}(E_{e}^{\\mathrm{tr}}) - \\Delta \\Gamma \\, N,\n$$\n因此其 Mandel 偏量的范数为\n$$\n\\left\\| \\operatorname{dev}(M^{n+1}) \\right\\| = 2 \\mu \\, \\left\\| \\operatorname{dev}(E_{e}^{\\mathrm{tr}}) - \\Delta \\Gamma \\, N \\right\\| = \\xi^{\\mathrm{tr}} - 2 \\mu \\, \\Delta \\Gamma,\n$$\n因为 $N$ 与 $\\operatorname{dev}(E_{e}^{\\mathrm{tr}})$ 对齐。在 $n+1$ 时刻的一致性条件要求\n$$\n\\left\\| \\operatorname{dev}(M^{n+1}) \\right\\| = \\sqrt{\\frac{2}{3}} \\left( \\sigma_{y0} + H \\, p^{n+1} \\right), \\quad p^{n+1} = p^{n} + \\sqrt{\\frac{2}{3}} \\, \\Delta \\Gamma.\n$$\n结合这些，我们得到一个关于 $\\Delta \\Gamma$ 的标量方程，\n$$\n\\xi^{\\mathrm{tr}} - 2 \\mu \\, \\Delta \\Gamma = \\sqrt{\\frac{2}{3}} \\left( \\sigma_{y0} + H \\left( p^{n} + \\sqrt{\\frac{2}{3}} \\, \\Delta \\Gamma \\right) \\right).\n$$\n求解 $\\Delta \\Gamma$ 得\n$$\n\\Delta \\Gamma = \\frac{\\xi^{\\mathrm{tr}} - \\sqrt{\\frac{2}{3}} \\left( \\sigma_{y0} + H p^{n} \\right)}{2 \\mu + \\frac{2}{3} H},\n$$\n根据塑性加载条件 $\\Phi^{\\mathrm{tr}}  0$，该值是非负的。然后更新\n$$\n\\operatorname{dev}(E_{e}^{n+1}) = \\operatorname{dev}(E_{e}^{\\mathrm{tr}}) - \\Delta \\Gamma \\, N, \\quad \\operatorname{tr}(E_{e}^{n+1}) = \\operatorname{tr}(E_{e}^{\\mathrm{tr}}),\n$$\n$$\np^{n+1} = p^{n} + \\sqrt{\\frac{2}{3}} \\, \\Delta \\Gamma, \\quad M^{n+1} = 2 \\mu \\, \\operatorname{dev}(E_{e}^{n+1}) + \\kappa \\, \\operatorname{tr}(E_{e}^{n+1}) \\, I.\n$$\n从 $E_{e}^{n+1}$ 的偏量和体积部分重构它，然后得到 $F_{e}^{n+1} = \\exp(E_{e}^{n+1})$（对对角张量是逐分量的），最后更新 $F_{p}^{n+1} = (F_{e}^{n+1})^{-1} F^{n+1}$。\n\n塑性不可压缩性验证。由于塑性修正仅作用于 $E_{e}$ 的偏量部分，其体积部分（迹）在塑性修正过程中保持不变。因为 $\\operatorname{tr}(E_{e}) = \\ln J_{e}$，其中 $J_{e} = \\det(F_{e})$，所以弹性体积比 $J_{e}$ 在每个增量步的塑性修正中不受影响。此外，由 $F = F_{e} F_{p}$ 可得 $J = \\det(F) = J_{e} J_{p}$，因此 $J_{p} = J / J_{e}$。初始时，$J_{p}^{0} = 1$。对于给定的增量步，由于根据归纳法 $J_{p}^{n} = 1$，试探弹性状态有 $J_{e}^{\\mathrm{tr}} = J / J_{p}^{n} = J$。塑性修正是偏量的，使得 $J_{e}^{n+1} = J_{e}^{\\mathrm{tr}} = J$。因此，$J_{p}^{n+1} = J / J_{e}^{n+1} = 1$。在数值上，由于有限精度，我们预计偏差在机器精度量级；程序记录加载路径上的最大绝对偏差 $\\max_{k} | \\det(F_{p}^{(k)}) - 1 |$ 作为塑性不可压缩性的验证指标。\n\n测试套件和输出。我们用帕斯卡单位的指定参数和给定的 $\\lambda$ 路径模拟三个案例：\n- 案例 A: $\\mu = 80 \\times 10^{6}$, $\\kappa = 160 \\times 10^{6}$, $\\sigma_{y0} = 120 \\times 10^{6}$, $H = 10 \\times 10^{6}$, $N = 60$, $\\lambda_{\\mathrm{final}} = 0.70$。\n- 案例 B: 与案例 A 相同，但 $N = 10$, $\\lambda_{\\mathrm{final}} = 0.98$。\n- 案例 C: $\\mu = 50 \\times 10^{6}$, $\\kappa = 100 \\times 10^{6}$, $\\sigma_{y0} = 80 \\times 10^{6}$, $H = 0$, $N = 80$, $\\lambda_{\\mathrm{final}} = 0.60$。\n\n对于每个案例，我们计算各增量步中与塑性不可压缩性的最大绝对偏差，即 $\\max_{k} \\left| \\det(F_{p}^{(k)}) - 1 \\right|$，并以 $[rA,rB,rC]$ 的形式在单行中输出三个结果，结果为无单位十进制数。\n\n该算法使用对角张量运算、通过逐分量运算实现的对角矩阵的对数和指数，以及为具有 von Mises (J2) 塑性和线性各向同性硬化的 Hencky 弹性模型推导出的塑性乘子增量 $\\Delta \\Gamma$ 的闭式解来实现。", "answer": "```python\nimport numpy as np\n\ndef run_case(mu, kappa, sig_y0, H, N, lam_final):\n    # Initialize\n    Fp = np.ones(3)  # diagonal of F_p\n    p = 0.0          # equivalent plastic strain\n    max_dev = 0.0\n\n    # Path: lambda from 1 to lam_final in N steps (inclusive of final)\n    lambdas = np.linspace(1.0, lam_final, N)\n\n    # Helper functions for diagonal tensors\n    def dev_diag(v):\n        m = np.mean(v)\n        return v - m\n\n    for lam in lambdas:\n        # Total deformation gradient diagonal\n        F = np.array([lam, 1.0, 1.0])\n        C = F**2  # since diagonal: C = F^T F - component-wise square\n\n        # Trial elastic right Cauchy-Green in diagonal form: Ce_tr = inv(Fp)^T * C * inv(Fp)\n        invFp = 1.0 / Fp\n        Ce_tr = (invFp**2) * C\n\n        # Elastic Hencky strain trial: Ee_tr = 0.5 * ln(Ce_tr)\n        Ee_tr = 0.5 * np.log(Ce_tr)\n\n        # Deviatoric part and Mandel deviator norm\n        dev_Ee_tr = dev_diag(Ee_tr)\n        devM_tr = 2.0 * mu * dev_Ee_tr\n        xi_tr = np.linalg.norm(devM_tr)\n\n        # Yield function trial\n        phi_tr = xi_tr - np.sqrt(2.0/3.0) * (sig_y0 + H * p)\n\n        tol = 1e-12\n        if phi_tr = tol or xi_tr  tol:\n            # Elastic step: accept trial\n            Ee = Ee_tr\n        else:\n            # Plastic correction: radial return in Mandel space for Hencky elasticity\n            DeltaGamma = phi_tr / (2.0 * mu + (2.0/3.0) * H)\n            # Flow direction N aligned with dev_Ee_tr (same as devM_tr)\n            n_dir = dev_Ee_tr / (np.linalg.norm(dev_Ee_tr) + 1e-30)\n            dev_Ee = dev_Ee_tr - DeltaGamma * n_dir\n            # Volumetric part unchanged\n            tr_Ee = np.sum(Ee_tr)\n            mean_Ee = tr_Ee / 3.0\n            Ee = dev_Ee + mean_Ee\n            # Update equivalent plastic strain\n            p += np.sqrt(2.0/3.0) * DeltaGamma\n\n        # Reconstruct Fe from Ee: Fe = exp(Ee) component-wise\n        Fe = np.exp(Ee)\n        # Update Fp from multiplicative split: F = Fe^{-1} * F\n        Fp = F / Fe\n\n        # Track plastic incompressibility deviation\n        detFp = np.prod(Fp)\n        dev = abs(detFp - 1.0)\n        if dev  max_dev:\n            max_dev = dev\n\n        # Mandel stress could be computed if needed:\n        # M = 2 mu dev(Ee) + kappa tr(Ee) I; not used in output but we ensure computability\n        # dev part:\n        # devM = 2.0 * mu * dev_diag(Ee)\n        # trM = kappa * np.sum(Ee)\n        # M_diag = devM + (trM / 3.0)\n\n    return max_dev\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (mu, kappa, sigma_y0, H, N, lambda_final)\n    test_cases = [\n        (80e6, 160e6, 120e6, 10e6, 60, 0.70),  # Case A\n        (80e6, 160e6, 120e6, 10e6, 10, 0.98),  # Case B\n        (50e6, 100e6, 80e6, 0.0, 80, 0.60),    # Case C\n    ]\n\n    results = []\n    for case in test_cases:\n        mu, kappa, sig_y0, H, N, lam_final = case\n        result = run_case(mu, kappa, sig_y0, H, N, lam_final)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2640752"}]}