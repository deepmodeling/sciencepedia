{"hands_on_practices": [{"introduction": "最小势能原理的一个核心应用是使用近似方法求解复杂结构的平衡问题。本练习将引导你使用经典的瑞利-里兹法 (Rayleigh-Ritz method) 来解决悬臂梁的变形问题。通过选择满足运动学边界条件的容许位移函数，并将总势能极小化，我们可以获得一个精确的近似解。这个实践旨在帮助你掌握如何将一个无限维的泛函极值问题转化为一个有限维的代数问题，这是变分法在工程中应用的基石。[@problem_id:2675671]", "problem": "一根细长、等截面、线性弹性的欧拉-伯努利梁，长度为 $L$，抗弯刚度为常数 $E I$。梁在 $x=0$ 处被夹紧，在 $x=L$ 处自由。一个大小为 $P$ 的静态集中载荷在 $x=L$ 处垂直向下作用。假设小挠度且线性化运动学有效。使用最小势能原理和瑞利-里兹简化模型，通过以下双参数容许形式来近似横向挠度场 $w(x)$\n$$\nw(x)=a\\,\\phi_{1}(x)+b\\,\\phi_{2}(x), \\quad \\phi_{1}(x)=\\left(\\frac{x}{L}\\right)^{2}, \\quad \\phi_{2}(x)=\\left(\\frac{x}{L}\\right)^{3},\n$$\n对于任意系数 $a$ 和 $b$，该形式满足夹紧端的本质边界条件 $w(0)=0$ 和 $w'(0)=0$。\n\n从弯曲应变能和外力功的基本定义出发，构建总势能泛函，对系数 $a$ 和 $b$ 强制其驻定性，并确定由此得到的瑞利-里兹近似下的梁端挠度 $w(L)$。\n\n请以 $P$、$E$、$I$ 和 $L$ 的闭合解析表达式形式给出最终答案。不要计算任何数值，最终表达式中不要包含单位。", "solution": "首先验证问题。\n\n**步骤1：提取已知条件**\n- **系统**：一根细长、等截面、线性弹性的欧拉-伯努利梁。\n- **长度**：$L$。\n- **抗弯刚度**：$EI$，为常数。\n- **边界条件**：在 $x=0$ 处夹紧，在 $x=L$ 处自由。\n- **载荷**：在 $x=L$ 处作用的大小为 $P$ 的静态集中垂直载荷。\n- **假设**：小挠度，线性化运动学。\n- **方法**：最小势能原理与瑞利-里兹近似法。\n- **近似挠度场**：$w(x) = a \\phi_1(x) + b \\phi_2(x)$，其中 $\\phi_1(x) = (x/L)^2$ 且 $\\phi_2(x) = (x/L)^3$。\n- **本质边界条件**：试验函数满足 $w(0)=0$ 和 $w'(0)=0$。\n- **目标**：确定梁端挠度 $w(L)$ 的近似值，以 $P$、$E$、$I$ 和 $L$ 表示。\n\n**步骤2：使用提取的已知条件进行验证**\n- 该问题具有**科学依据**。这是一个将基于最小势能原理的变分法——瑞利-里兹法，应用于经典欧拉-伯努利梁问题的标准应用。所有概念都是固体力学的基础。\n- 该问题是**适定的**。它提供了所有必要的信息（几何形状、材料属性、载荷和边界条件）以及一个清晰明确的目标。所提供的试验函数 $w(x) = a(x/L)^2 + b(x/L)^3$ 是容许的，因为它们满足夹紧端 ($x=0$) 的本质（运动学）边界条件：\n  $w(0) = a(0)^2 + b(0)^3 = 0$。\n  $w'(x) = a(2x/L^2) + b(3x^2/L^3)$，所以 $w'(0) = a(0) + b(0) = 0$。\n- 该问题是**客观的**。语言技术性强且精确。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。将构建解答。\n\n**求解过程**\n最小势能原理指出，对于处于稳定平衡状态的保守系统，其总势能 $\\Pi$ 对于容许的运动学变分是驻定的。总势能是内应变能 $U$ 和外力势能 $V$ 的和。\n$$\n\\Pi = U + V\n$$\n在小挠度假设下，欧拉-伯努利梁的应变能 $U$ 由下式给出：\n$$\nU = \\frac{1}{2} \\int_{0}^{L} EI [w''(x)]^2 dx\n$$\n其中 $w''(x)$ 是梁的曲率。作用在 $x=L$ 处的外集中载荷 $P$ 的势能为：\n$$\nV = -P w(L)\n$$\n近似挠度场由 $w(x) = a\\left(\\frac{x}{L}\\right)^2 + b\\left(\\frac{x}{L}\\right)^3$ 给出。我们首先计算其二阶导数 $w''(x)$：\n$$\nw'(x) = \\frac{d}{dx}\\left[a\\frac{x^2}{L^2} + b\\frac{x^3}{L^3}\\right] = a\\frac{2x}{L^2} + b\\frac{3x^2}{L^3}\n$$\n$$\nw''(x) = \\frac{d}{dx}\\left[a\\frac{2x}{L^2} + b\\frac{3x^2}{L^3}\\right] = a\\frac{2}{L^2} + b\\frac{6x}{L^3}\n$$\n现在，我们将 $w''(x)$ 代入应变能 $U$ 的表达式中：\n$$\nU = \\frac{1}{2} \\int_{0}^{L} EI \\left( \\frac{2a}{L^2} + \\frac{6bx}{L^3} \\right)^2 dx\n$$\n展开被积函数：\n$$\nU = \\frac{EI}{2} \\int_{0}^{L} \\left( \\frac{4a^2}{L^4} + \\frac{24abx}{L^5} + \\frac{36b^2x^2}{L^6} \\right) dx\n$$\n对 $x$ 在 $0$ 到 $L$ 的区间上进行积分：\n$$\nU = \\frac{EI}{2} \\left[ \\frac{4a^2x}{L^4} + \\frac{24abx^2}{2L^5} + \\frac{36b^2x^3}{3L^6} \\right]_{0}^{L}\n$$\n$$\nU = \\frac{EI}{2} \\left( \\frac{4a^2L}{L^4} + \\frac{12abL^2}{L^5} + \\frac{12b^2L^3}{L^6} \\right) = \\frac{EI}{2L^3} (4a^2 + 12ab + 12b^2)\n$$\n$$\nU = \\frac{EI}{L^3} (2a^2 + 6ab + 6b^2)\n$$\n接下来，我们确定外加载荷的势能。梁端 $x=L$ 处的挠度为：\n$$\nw(L) = a\\left(\\frac{L}{L}\\right)^2 + b\\left(\\frac{L}{L}\\right)^3 = a+b\n$$\n因此，载荷的势能为：\n$$\nV = -P w(L) = -P(a+b)\n$$\n总势能 $\\Pi$ 是未知系数 $a$ 和 $b$ 的函数：\n$$\n\\Pi(a,b) = U + V = \\frac{EI}{L^3} (2a^2 + 6ab + 6b^2) - P(a+b)\n$$\n为了求出 $a$ 和 $b$ 的平衡值，我们通过对 $\\Pi$ 分别求关于 $a$ 和 $b$ 的偏导数并令其为零来强制执行驻定条件：\n$$\n\\frac{\\partial \\Pi}{\\partial a} = \\frac{EI}{L^3}(4a + 6b) - P = 0 \\quad \\implies \\quad 4a + 6b = \\frac{PL^3}{EI}\n$$\n$$\n\\frac{\\partial \\Pi}{\\partial b} = \\frac{EI}{L^3}(6a + 12b) - P = 0 \\quad \\implies \\quad 6a + 12b = \\frac{PL^3}{EI}\n$$\n这给了我们一个关于 $a$ 和 $b$ 的二元线性方程组：\n1. $4a + 6b = \\frac{PL^3}{EI}$\n2. $6a + 12b = \\frac{PL^3}{EI}$\n\n为了解这个方程组，我们可以将第一个方程乘以 $2$：\n3. $8a + 12b = \\frac{2PL^3}{EI}$\n\n从这个新方程 (3) 中减去第二个方程，可以消去 $b$：\n$$\n(8a + 12b) - (6a + 12b) = \\frac{2PL^3}{EI} - \\frac{PL^3}{EI}\n$$\n$$\n2a = \\frac{PL^3}{EI} \\quad \\implies \\quad a = \\frac{PL^3}{2EI}\n$$\n将 $a$ 的这个结果代回第一个方程：\n$$\n4\\left(\\frac{PL^3}{2EI}\\right) + 6b = \\frac{PL^3}{EI}\n$$\n$$\n\\frac{2PL^3}{EI} + 6b = \\frac{PL^3}{EI}\n$$\n$$\n6b = \\frac{PL^3}{EI} - \\frac{2PL^3}{EI} = -\\frac{PL^3}{EI}\n$$\n$$\nb = -\\frac{PL^3}{6EI}\n$$\n问题要求的是梁端挠度 $w(L)$，它由 $w(L) = a+b$ 给出。\n$$\nw(L) = \\frac{PL^3}{2EI} + \\left(-\\frac{PL^3}{6EI}\\right) = \\frac{3PL^3 - PL^3}{6EI} = \\frac{2PL^3}{6EI}\n$$\n$$\nw(L) = \\frac{PL^3}{3EI}\n$$\n这个结果是悬臂梁在自由端受点载荷作用下梁端挠度的精确解。所选择的试验函数能够表示精确的挠度曲线，因此瑞利-里兹法正确地确定了精确的系数。", "answer": "$$\\boxed{\\frac{P L^{3}}{3 E I}}$$", "id": "2675671"}, {"introduction": "从解析近似到现代计算力学，最小势能原理提供了一座坚实的桥梁。本练习要求你通过有限元方法 (Finite Element Method) 将连续的杆件离散化，从而将最小化势能泛函的问题转变为一个有限变量的约束优化问题。特别地，单边接触约束的引入展示了该框架如何优雅地处理复杂的非线性边界条件，这在工程实践中至关重要。通过解决这个问题，你将深入理解势能最小化如何自然地导出变分不等式和接触力学的基本条件。[@problem_id:2675683]", "problem": "给定一根一维线性弹性杆，其长度为 $L$，恒定横截面积为 $A$，杨氏模量为 $E$。该杆的左端（$x=0$）被夹紧，右端（$x=L$）承受一个集中的轴向力 $P$。右端可能与一个刚性挡块发生无摩擦的单边接触，该挡块距离夹紧构型为 $g$，这施加了单边运动学约束 $u(L) \\le g$，其中 $u(x)$ 是沿杆的轴向位移场。假设小应变、小位移和线性弹性行为。\n\n根据最小势能原理，在所有运动学上容许的场中，实际位移场 $u(x)$ 使总势能最小化。设应变能密度为 $W(\\varepsilon) = \\tfrac{1}{2} E \\varepsilon^2$，应变为 $\\varepsilon = du/dx$，外力势为 $-P\\,u(L)$。在 $x=L$ 处存在单边约束的情况下，最小值是在所有满足 $u(0)=0$ 和 $u(L)\\le g$ 的 $u(x)$ 上求得的。这导致了一个变分不等式以及相关的 Karush–Kuhn–Tucker (KKT) 条件，其中包含一个非负的接触乘子。\n\n任务：使用 $N$ 个均匀的双节点轴向有限元将杆离散化，节点位移为 $\\{u_i\\}_{i=0}^{N}$，其中 $u_0 = 0$ 是固定的。使用线性形函数和单元长度 $h=L/N$ 组装全局刚度矩阵 $K \\in \\mathbb{R}^{(N+1)\\times(N+1)}$，每个单元的刚度为 $k_e = \\dfrac{EA}{h}\\begin{bmatrix}1  -1\\\\ -1  1\\end{bmatrix}$。设全局力向量为 $f \\in \\mathbb{R}^{N+1}$，其中 $f_N = P$ 且其他分量为零。将离散总势能定义为\n$$\n\\Pi(u) = \\tfrac{1}{2}\\,u^\\top K u - f^\\top u,\n$$\n其中 $u = (u_0,\\dots,u_N)^\\top$，容许性要求 $u_0 = 0$ 且 $u_N \\le g$。\n\n您的程序必须为每个指定的测试用例计算一个三元组，包括：\n- 以米为单位的端点位移 $u_N$，\n- 指示单边约束是否激活的布尔接触状态（如果 $u_N$ 因接触反力而被强制等于 $g$ 则为真，否则为假），以及\n- 以牛顿为单位的接触反力 $\\lambda$，定义为 KKT 条件中与不等式 $u_N \\le g$ 相关联的非负拉格朗日乘子。使用符号约定，其中平衡条件为 $K u - f + \\lambda e_N = 0$，$e_N$ 是对应于端点自由度的标准单位向量。在此约定下，反力由收敛的位移计算得出，即 $\\lambda = f_N - (K u)_N$，并且在接触激活时必须满足 $\\lambda \\ge 0$，在接触未激活时 $\\lambda = 0$。\n\n您的算法必须基于以下基本原理：\n- 线性运动学 $\\varepsilon = du/dx$ 和胡克定律 $\\sigma = E \\varepsilon$，\n- 最小势能原理，导出凸二次最小化问题，\n- 单边接触建模为带有非负乘子 $\\lambda$ 的不等式约束 $u_N \\le g$，这意味着互补条件 $u_N \\le g$、$\\lambda \\ge 0$ 和 $\\lambda\\,(u_N - g) = 0$。\n\n在您的实现中不要使用任何预先推导的快捷公式；而是应组装 $K$ 和 $f$，施加 $u_0=0$，并使用数学上可靠的方法求解在端点处具有单边约束的凸二次规划问题（例如，一个小型活动集检查方法：首先求解无约束的简化系统，在 $u_N$ 处检验不等式，如果违反，则施加 $u_N = g$ 并重新计算状态和反力）。\n\n数值说明：\n- 所有输入和输出均采用国际单位制 (SI)：$L$ 单位为米，$A$ 单位为平方米，$E$ 单位为帕斯卡，$P$ 和 $\\lambda$ 单位为牛顿，$g$ 和位移单位为米。\n- 将以米为单位的端点位移和以牛顿为单位的接触反力表示为浮点数。接触状态必须是布尔值。\n- 不包含角度。本问题不出现百分比。\n- 在比较不等式 $u_N \\le g$ 以决定接触活动性时，使用数值公差 $\\tau = 10^{-12}$。\n\n测试套件：\n为以下四个案例提供解答，每个案例以元组 $(E, A, L, N, P, g)$ 的形式给出：\n1. $(7.0\\times 10^{10},\\, 1.0\\times 10^{-4},\\, 2.0,\\, 5,\\, 3.0\\times 10^{3},\\, 1.0\\times 10^{-2})$,\n2. $(7.0\\times 10^{10},\\, 1.0\\times 10^{-4},\\, 2.0,\\, 5,\\, 3.0\\times 10^{3},\\, 1.0\\times 10^{-4})$,\n3. $(7.0\\times 10^{10},\\, 1.0\\times 10^{-4},\\, 2.0,\\, 5,\\, 3.0\\times 10^{3},\\, 8.571428571428572\\times 10^{-4})$,\n4. $(7.0\\times 10^{10},\\, 1.0\\times 10^{-4},\\, 2.0,\\, 5,\\, 0.0,\\, 1.0\\times 10^{-4})$.\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个逗号分隔的四个结果列表，与测试套件的顺序相同，并用方括号括起来。每个结果本身必须是一个列表，顺序为 $[u_N,\\, \\text{contact\\_active},\\, \\lambda]$。例如，输出格式必须类似于\n\"[ [u1,True,lambda1],[u2,False,lambda2],[u3,True,lambda3],[u4,False,lambda4] ]\"\n但要用实际的数值和布尔值替换占位符。", "solution": "用户提供的问题是计算固体力学中的一个适定 (well-posed) 场景，具体涉及带有单边接触约束的一维线性弹性杆。该问题具有科学依据、内部一致，并包含获得唯一解所需的所有信息。因此，该问题被认定为有效，并将提供完整的解答。\n\n求解方法遵循有限元法 (FEM) 结合活动集策略来处理单边接触约束，如问题陈述中所述。最小势能原理为该方法提供了理论基础。对于离散化系统，总势能 $\\Pi(u)$ 是节点位移 $u$ 的二次函数，必须在运动学约束 $u_0=0$ 和 $u_N \\le g$ 的条件下将其最小化。\n\n首先，我们将长度为 $L$ 的杆离散化为 $N$ 个均匀的线性有限元。每个单元的长度为 $h=L/N$。这产生一个包含 $N+1$ 个节点的系统，节点编号从 $0$ 到 $N$，对应的轴向位移为 $u_0, u_1, \\dots, u_N$。双节点杆单元的单元刚度矩阵 $k_e$ 由下式给出：\n$$\nk_e = \\frac{EA}{h}\\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\n其中 $E$ 是杨氏模量，$A$ 是横截面积。全局刚度矩阵 $K \\in \\mathbb{R}^{(N+1)\\times(N+1)}$ 是通过遍历所有单元并将其贡献加到相应的全局自由度上组装而成的。\n\n全局外力向量 $f \\in \\mathbb{R}^{N+1}$ 是通过考虑施加在杆尖（节点 $N$）上的集中力 $P$ 来构建的。这会得到一个除了 $f_N = P$ 外所有项都为零的向量。\n\n本质边界条件 $u_0=0$ 通过对方程组进行分区来处理。我们将自由度分为已知（或规定）和未知两部分。最初，只有 $u_0$ 是已知的。方程组 $Ku=f$ 被简化为一个只涉及未知位移 $u_1, \\dots, u_N$ 的更小的系统。设 $u_R = [u_1, \\dots, u_N]^T$ 为自由位移向量。简化后的系统是 $K_{RR} u_R = f_R$，其中 $K_{RR}$ 是 $K$ 中对应于自由自由度（DOFs）的子矩阵，$f_R$ 是 $f$ 中对应的子向量。\n\n问题的核心是在端点节点处的单边接触约束 $u_N \\le g$。这个不等式通过一个简单而稳健的活动集方法进行管理，该方法包括两个主要阶段：\n\n1.  **试探步骤（假设无接触）：** 首先，我们假设约束未激活（$\\lambda=0$）来求解问题。求解简化的线性系统 $K_{RR} u_R = f_R$ 得到 $u_R$。这给出了一个试探位移场，包括端点位移，我们将其记为 $u_N^{\\text{unc}}$。然后我们检查这个试探解相对于接触约束是否运动学上容许。使用指定的公差 $\\tau = 10^{-12}$，我们检验是否 $u_N^{\\text{unc}} \\le g + \\tau$。\n\n2.  **决策与修正（如果需要）：**\n    -   **如果 $u_N^{\\text{unc}} \\le g + \\tau$：** 试探解是有效的。约束未激活。最终的端点位移为 $u_N = u_N^{\\text{unc}}$，接触状态为 `False`，接触反力 $\\lambda$ 为零，这符合互补条件 $\\lambda(u_N-g)=0$ 且 $u_N  g$（或者 $u_N=g$ 但没有强制反力）。\n    -   **如果 $u_N^{\\text{unc}} > g + \\tau$：** 试探解违反了约束。这意味着接触被激活，且约束必须作为等式 $u_N = g$ 来强制执行。然后，使用两个规定的位移 $u_0=0$ 和 $u_N=g$ 重新求解问题。此时的未知位移是 $u_1, \\dots, u_{N-1}$。通过对 $K$ 和 $f$ 进行分区，形成一个新的、更小的线性系统来求解这些内部位移。该系统的右侧包含一个项，用于解释在节点 $N$ 处规定的非零位移 $g$ 的影响。一旦完整的位移向量 $u$ 已知（其中 $u_0=0$ 和 $u_N=g$），最终结果是：端点位移为 $u_N=g$，接触状态为 `True`。然后计算接触反力 $\\lambda$。它是在强制位移 $u_N=g$ 的同时维持平衡所需的力。根据节点 $N$ 处的平衡方程 $(K u)_N = f_N - \\lambda$，反力计算如下：\n        $$\n        \\lambda = f_N - (K u)_N\n        $$\n        这个值必须是非负的，这一条件由仅在无约束位移会超过间隙时才激活接触约束的逻辑所保证。\n\n这个过程正确地实现了该约束优化问题的 Karush-Kuhn-Tucker (KKT) 条件，并为每个测试用例提供了所需的输出。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the results.\n    \"\"\"\n    # Test suite from the problem statement\n    # Each case is a tuple: (E, A, L, N, P, g)\n    test_cases = [\n        (7.0e10, 1.0e-4, 2.0, 5, 3.0e3, 1.0e-2),\n        (7.0e10, 1.0e-4, 2.0, 5, 3.0e3, 1.0e-4),\n        (7.0e10, 1.0e-4, 2.0, 5, 3.0e3, 8.571428571428572e-4),\n        (7.0e10, 1.0e-4, 2.0, 5, 0.0, 1.0e-4),\n    ]\n\n    results_as_strings = []\n    for case in test_cases:\n        u_N, contact_active, lambda_val = solve_case(*case)\n        # Format each result as '[u_N,contact_status,lambda]'\n        results_as_strings.append(f\"[{u_N},{str(contact_active)},{lambda_val}]\")\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(results_as_strings)}]\")\n\ndef solve_case(E, A, L, N, P, g):\n    \"\"\"\n    Solves the 1D bar problem with a unilateral contact constraint for a single test case.\n\n    Args:\n        E (float): Young's modulus [Pa]\n        A (float): Cross-sectional area [m^2]\n        L (float): Length of the bar [m]\n        N (int): Number of finite elements\n        P (float): Applied axial force at the tip [N]\n        g (float): Gap to the rigid stop [m]\n\n    Returns:\n        tuple: A triplet containing:\n            - u_N (float): Tip displacement [m]\n            - contact_active (bool): True if contact is active, False otherwise\n            - lambda_val (float): Contact reaction force [N]\n    \"\"\"\n    num_nodes = N + 1\n    h = L / N\n    tau = 1e-12  # Numerical tolerance for contact check\n\n    # 1. Assemble global stiffness matrix K and force vector f\n    k_e_val = E * A / h\n    k_e = k_e_val * np.array([[1, -1], [-1, 1]])\n    \n    K = np.zeros((num_nodes, num_nodes))\n    for i in range(N):\n        # Add element stiffness matrix to global matrix\n        K[i:i+2, i:i+2] += k_e\n\n    f = np.zeros(num_nodes)\n    f[N] = P\n\n    # 2. Trial step: Solve unconstrained problem (assuming no contact)\n    # The system is reduced by applying the constraint u_0 = 0.\n    # We solve for DOFs 1 to N.\n    dofs_free = np.arange(1, num_nodes)\n    K_red = K[np.ix_(dofs_free, dofs_free)]\n    f_red = f[dofs_free]\n    \n    u_R = np.linalg.solve(K_red, f_red)\n    u_N_unc = u_R[-1]\n\n    # 3. Check contact condition\n    if u_N_unc = g + tau:\n        # Case: Contact is NOT active\n        u_N = u_N_unc\n        contact_active = False\n        lambda_val = 0.0\n    else:\n        # Case: Contact IS active\n        u_N = g\n        contact_active = True\n        \n        # Re-solve for internal DOFs u_1, ..., u_{N-1}\n        # with u_0 = 0 and u_N = g set as knowns.\n        dofs_internal = np.arange(1, N) # DOFs from 1 to N-1\n        \n        # Partition K for internal DOFs\n        K_internal = K[np.ix_(dofs_internal, dofs_internal)]\n        \n        # Calculate effective force vector considering the prescribed displacement u_N = g.\n        # The contribution from u_0 is zero.\n        f_effective = f[dofs_internal] - K[dofs_internal, N] * g\n        \n        u_internal = np.linalg.solve(K_internal, f_effective)\n        \n        # Assemble the full displacement vector\n        u_full = np.zeros(num_nodes)\n        u_full[dofs_internal] = u_internal\n        u_full[N] = g\n        \n        # Calculate the contact reaction lambda = f_N - (K*u)_N\n        internal_force_at_N = K[N, :] @ u_full\n        lambda_val = f[N] - internal_force_at_N\n\n    return u_N, contact_active, lambda_val\n\nsolve()\n\n```", "id": "2675683"}, {"introduction": "最小势能原理的应用远不止于求解平衡构型，它更是预测材料失效和状态演变的关键工具。本练习将最小势能原理应用于断裂力学领域，通过计算双悬臂梁 (Double Cantilever Beam, DCB) 试件的能量释放率来预测裂纹的扩展。你将学习如何通过考察系统总势能随裂纹扩展的变化，推导出能量释放率这一核心物理量。这个实践将抽象的能量原理与结构完整性预测的具体问题联系起来，展示了其在材料科学和失效分析中的强大威力。[@problem_id:2675679]", "problem": "将使用最小势能原理，对符合小挠度 Euler–Bernoulli 梁理论的对称双悬臂梁（DCB）试样进行线性弹性断裂力学计算。该试样由两个相同的棱柱形臂组成，其高度为 $h$，宽度为 $b$，杨氏模量为 $E$，被一个半长为 $a$ 的中面裂纹隔开（即总裂纹长度为 $2a$）。平面外厚度等于试样宽度 $b$，因此能量释放量应解释为每单位宽度的值。加载方式为在两端准静态施加的指定端部力 $P$（载荷控制）或指定的张开位移 $\\Delta$（位移控制）。根据 Euler–Bernoulli 梁理论，DCB 在加载点的柔度函数是一个经过充分检验的结果：\n$$\nC(a) \\equiv \\frac{\\Delta}{P} = \\frac{8\\,a^3}{E\\,b\\,h^3}.\n$$\n假设为线性弹性，各场量对裂纹长度 $a$ 平滑依赖，并且存在一个与所选控制模式一致的理想化载荷/位移源。设总势能为 $\\Pi = U + V$，其中 $U$ 是结构中储存的应变能，$V$ 是外力势能。最小势能原理指出，对于固定的参数，平衡位移场使 $\\Pi$ 最小化（取驻值）；裂纹扩展由能量平衡控制，通过 $\\Pi$ 对 $a$ 的驻定性实现。\n\n任务：\n- 从基本定义出发，包括 $U = \\int \\sigma \\,\\varepsilon\\, dV / 2$ 以及 $\\Delta$、$P$ 和 $C(a)$ 之间的运动学关系，利用最小势能原理推导两种加载情况下单位宽度的能量释放率 $G$ 的表达式，并用 $C(a)$ 及其关于 $a$ 的导数 $C'(a) = dC/da$ 明确表示。仔细论证在载荷控制和位移控制下，系统势能的形式，以及在求导过程中保持相应广义变量不变的理由。\n- 然后，通过在初始裂纹扩展时施加 Griffith 能量中性条件，将能量释放率 $G$ 与材料的断裂韧性 $G_c$ 相等，从而求解出临界载荷 $P_{\\text{crit}}$（对于载荷控制）或临界位移 $\\Delta_{\\text{crit}}$（对于位移控制），以适用于以下每个测试用例。\n\n所有答案必须使用指定的国际单位制（SI单位）表示：$E$ 的单位为 $\\text{Pa}$，$b$、$h$ 和 $a$ 的单位为 $\\text{m}$，$G_c$ 的单位为 $\\text{J}/\\text{m}^2$，$P_{\\text{crit}}$ 的单位为 $\\text{N}$，$\\Delta_{\\text{crit}}$ 的单位为 $\\text{m}$。本问题不涉及角度。您的程序必须为每个测试用例计算所要求的临界量，并将其报告为浮点数。\n\n测试套件：\n- 情况1（载荷控制）：$E = 70\\times 10^9\\ \\text{Pa}$，$b = 0.02\\ \\text{m}$，$h = 0.003\\ \\text{m}$，$a = 0.05\\ \\text{m}$，$G_c = 300\\ \\text{J}/\\text{m}^2$。输出 $P_{\\text{crit}}$，单位为 $\\text{N}$。\n- 情况2（位移控制）：$E = 70\\times 10^9\\ \\text{Pa}$，$b = 0.02\\ \\text{m}$，$h = 0.003\\ \\text{m}$，$a = 0.05\\ \\text{m}$，$G_c = 300\\ \\text{J}/\\text{m}^2$。输出 $\\Delta_{\\text{crit}}$，单位为 $\\text{m}$。\n- 情况3（载荷控制，小裂纹边界情况）：$E = 70\\times 10^9\\ \\text{Pa}$，$b = 0.02\\ \\text{m}$，$h = 0.003\\ \\text{m}$，$a = 0.001\\ \\text{m}$，$G_c = 300\\ \\text{J}/\\text{m}^2$。输出 $P_{\\text{crit}}$，单位为 $\\text{N}$。\n- 情况4（位移控制，柔性材料）：$E = 3.2\\times 10^9\\ \\text{Pa}$，$b = 0.025\\ \\text{m}$，$h = 0.004\\ \\text{m}$，$a = 0.03\\ \\text{m}$，$G_c = 1200\\ \\text{J}/\\text{m}^2$。输出 $\\Delta_{\\text{crit}}$，单位为 $\\text{m}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按情况1到4的顺序排列结果。每个数字必须是四舍五入到小数点后6位的小数。对于载荷控制的情况，数字是 $P_{\\text{crit}}$（单位 N）。对于位移控制的情况，数字是 $\\Delta_{\\text{crit}}$（单位 m）。例如，包含四个结果的输出应如下所示：“[x1,x2,x3,x4]”，其中每个 $x_i$ 都四舍五入到小数点后6位。", "solution": "该问题已经过验证，被认为是具有科学依据、提法恰当且客观的。这是线性弹性断裂力学（LEFM）中的一个标准问题。解题过程如下。\n\n首先，我们确定基本的能量量。储存在线性弹性体中的应变能 $U$ 可以根据载荷 $P$ 或位移 $\\Delta$ 表示。使用给定的柔度函数 $C(a) = \\Delta/P$，我们有：\n$$\nU(a, P) = \\frac{1}{2} P \\Delta = \\frac{1}{2} C(a) P^2\n$$\n$$\nU(a, \\Delta) = \\frac{1}{2} P \\Delta = \\frac{1}{2} \\left(\\frac{\\Delta}{C(a)}\\right) \\Delta = \\frac{\\Delta^2}{2 C(a)}\n$$\n能量释放率 $G$ 定义为裂纹每扩展单位面积时，系统势能的减少量，即 $G = -\\frac{1}{b}\\frac{d\\Pi}{da}$，其中 $\\Pi$ 是相关的系统势能，其形式取决于加载条件。\n\n情况1：载荷控制（恒定 $P$）\n在载荷控制下，包含载荷源在内的系统总势能为 $\\Pi_{LC} = U - P\\Delta$。将 $U$ 和 $\\Delta$ 用 $P$ 和 $C(a)$ 表示，得到：\n$$\n\\Pi_{LC}(a) = \\frac{1}{2}C(a)P^2 - P(C(a)P) = -\\frac{1}{2} C(a) P^2\n$$\n对 $a$ 求导（$P$ 为常数），总能量释放率为 $\\mathcal{G}_{total} = -\\frac{d\\Pi_{LC}}{da} = \\frac{1}{2} P^2 C'(a)$。因此，单位宽度的能量释放率 $G$ 为：\n$$\nG_{LC} = \\frac{P^2}{2b} C'(a)\n$$\n\n情况2：位移控制（恒定 $\\Delta$）\n在位移控制下，加载点位移 $\\Delta$ 保持恒定，外部载荷不做功。相关的系统势能就是储存的应变能 $\\Pi_{DC} = U$。\n$$\n\\Pi_{DC}(a) = U(a, \\Delta) = \\frac{\\Delta^2}{2 C(a)}\n$$\n对 $a$ 求导（$\\Delta$ 为常数），总能量释放率为 $\\mathcal{G}_{total} = -\\frac{d\\Pi_{DC}}{da} = - \\frac{\\Delta^2}{2} \\left(-\\frac{C'(a)}{C(a)^2}\\right) = \\frac{\\Delta^2 C'(a)}{2 C(a)^2}$。单位宽度的能量释放率 $G$ 为：\n$$\nG_{DC} = \\frac{\\Delta^2}{2b C(a)^2} C'(a)\n$$\n作为一致性检验，将 $P = \\Delta/C(a)$ 代入 $G_{LC}$ 的表达式即可得到 $G_{DC}$ 的表达式，这证实了对于给定的状态 $(P, \\Delta, a)$，能量释放率与控制模式无关。\n\n接下来，我们建立裂纹扩展的准则。根据 Griffith 的断裂理论，当能量释放率 $G$ 达到临界值，即材料的断裂韧性 $G_c$ 时，裂纹发生扩展。因此，初始裂纹扩展的条件是 $G = G_c$。\n\n从给定的 DCB 试样柔度函数 $C(a) = \\frac{8a^3}{Ebh^3}$，我们计算它关于裂纹长度 $a$ 的导数：\n$$\nC'(a) = \\frac{d}{da}\\left(\\frac{8a^3}{Ebh^3}\\right) = \\frac{24a^2}{Ebh^3}\n$$\n现在我们求解临界载荷 $P_{\\text{crit}}$ 和临界位移 $\\Delta_{\\text{crit}}$。\n\n对于载荷控制，我们设 $G_{LC} = G_c$：\n$$\n\\frac{P_{\\text{crit}}^2}{2b} C'(a) = G_c \\implies P_{\\text{crit}}^2 = \\frac{2bG_c}{C'(a)}\n$$\n代入 $C'(a)$ 的表达式：\n$$\nP_{\\text{crit}}^2 = \\frac{2bG_c}{\\frac{24a^2}{Ebh^3}} = \\frac{2bG_c Ebh^3}{24a^2} = \\frac{E G_c b^2 h^3}{12a^2}\n$$\n因此，临界载荷为：\n$$\nP_{\\text{crit}} = \\sqrt{\\frac{E G_c b^2 h^3}{12 a^2}} = \\frac{bh\\sqrt{h}}{2a\\sqrt{3}}\\sqrt{EG_c}\n$$\n\n对于位移控制，我们设 $G_{DC} = G_c$：\n$$\n\\frac{\\Delta_{\\text{crit}}^2}{2b C(a)^2} C'(a) = G_c \\implies \\Delta_{\\text{crit}}^2 = \\frac{2b G_c C(a)^2}{C'(a)}\n$$\n这意味着 $\\Delta_{\\text{crit}} = C(a) \\sqrt{\\frac{2bG_c}{C'(a)}} = C(a) P_{\\text{crit}}$。代入 $C(a)$ 和 $P_{\\text{crit}}$ 的表达式：\n$$\n\\Delta_{\\text{crit}} = \\left(\\frac{8a^3}{Ebh^3}\\right) \\sqrt{\\frac{E G_c b^2 h^3}{12 a^2}} = \\frac{8a^3}{Ebh^3} \\frac{bh\\sqrt{E G_c h}}{2a\\sqrt{3}} = \\frac{4a^2 \\sqrt{E G_c h}}{\\sqrt{3} E h^2} = \\frac{4a^2}{\\sqrt{3}h^{3/2}}\\sqrt{\\frac{G_c}{E}}\n$$\n这些最终推导出的 $P_{\\text{crit}}$ 和 $\\Delta_{\\text{crit}}$ 公式被用来计算给定测试用例的数值答案。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for critical load or displacement for a Double Cantilever Beam (DCB) specimen.\n\n    The problem is based on linear elastic fracture mechanics (LEFM) and the principle\n    of minimum potential energy. The derivations in the solution lead to the following\n    formulas for critical load (P_crit) and critical displacement (Delta_crit):\n\n    P_crit = sqrt((E * Gc * b^2 * h^3) / (12 * a^2))\n    Delta_crit = (4 * a^2 / (sqrt(3) * h^(3/2))) * sqrt(Gc / E)\n\n    where:\n    E: Young's modulus (Pa)\n    b: Specimen width (m)\n    h: Arm height (m)\n    a: Crack half-length (m)\n    Gc: Fracture resistance (J/m^2)\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"type\": \"load\", \"E\": 70e9, \"b\": 0.02, \"h\": 0.003, \"a\": 0.05, \"Gc\": 300\n        },\n        {\n            \"type\": \"displacement\", \"E\": 70e9, \"b\": 0.02, \"h\": 0.003, \"a\": 0.05, \"Gc\": 300\n        },\n        {\n            \"type\": \"load\", \"E\": 70e9, \"b\": 0.02, \"h\": 0.003, \"a\": 0.001, \"Gc\": 300\n        },\n        {\n            \"type\": \"displacement\", \"E\": 3.2e9, \"b\": 0.025, \"h\": 0.004, \"a\": 0.03, \"Gc\": 1200\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        E = case[\"E\"]\n        b = case[\"b\"]\n        h = case[\"h\"]\n        a = case[\"a\"]\n        Gc = case[\"Gc\"]\n\n        if case[\"type\"] == \"load\":\n            # Calculate critical load P_crit in N\n            numerator = E * Gc * (b**2) * (h**3)\n            denominator = 12 * (a**2)\n            p_crit = np.sqrt(numerator / denominator)\n            result = p_crit\n        elif case[\"type\"] == \"displacement\":\n            # Calculate critical displacement Delta_crit in m\n            term1 = (4 * a**2) / (np.sqrt(3) * h**1.5)\n            term2 = np.sqrt(Gc / E)\n            delta_crit = term1 * term2\n            result = delta_crit\n        else:\n            # This path should not be reached with the given test cases.\n            raise ValueError(\"Invalid test case type.\")\n            \n        # Format result to 6 decimal places as required.\n        results.append(f\"{result:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2675679"}]}