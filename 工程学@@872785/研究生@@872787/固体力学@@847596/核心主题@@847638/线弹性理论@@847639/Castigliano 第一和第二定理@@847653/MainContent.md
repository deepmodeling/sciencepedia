## 引言
在[结构力学](@entry_id:276699)领域，求解位移和分析[超静定](@entry_id:178116)系统是工程师面临的核心挑战。虽然[静力平衡](@entry_id:163498)方程是基础，但它们本身不足以解决这类问题。基于能量的分析方法，特别是卡氏第一及第二定理，为此提供了强大而优雅的解决方案，它将结构的外部载荷与内部储存的能量直接联系起来，绕过了复杂的几何推导。

本文旨在系统性地阐述[卡氏定理](@entry_id:191013)的理论与实践。通过学习本文，您将深入理解[能量法](@entry_id:183021)的精髓，并掌握其在解决复杂工程问题中的应用技巧。

文章将分为三个核心部分展开：首先，在“原理与机制”一章中，我们将从[应变能](@entry_id:162699)和余能的基本概念出发，严谨推导卡氏第一及第二定理，并明确其适用条件与限制。接着，在“应用与跨学科联系”一章中，我们将展示该定理如何应用于从简单梁到复杂框架的位移计算和[超静定](@entry_id:178116)分析，并探讨其与断裂力学、[热弹性](@entry_id:158447)及[计算力学](@entry_id:174464)等领域的深刻联系。最后，通过“动手实践”部分精选的练习题，您将有机会亲手应用所学知识，巩固并深化对这些强大分析工具的理解。

## 原理与机制

在上一章引言的基础上，本章将深入探讨基于能量的结构分析方法的核心——[卡氏定理](@entry_id:191013)（Castigliano's Theorems）。这些定理将结构内部储存的能量与其外部载荷及位移联系起来，为求解复杂结构的变形和[内力](@entry_id:167605)提供了优雅而强大的工具。我们将从第一性原理出发，系统地建立应变能、[余能](@entry_id:192009)以及它们与卡氏第一、第二定理的联系，阐明其适用条件，并通过具体算例展示其在工程问题中的应用。

### 应变能与卡氏第一定理

弹性体在载荷作用下发生变形时，外力所做的功将以**[应变能](@entry_id:162699)**（Strain Energy）的形式储存在物体内部。对于一个保守系统，若移除外载荷，储存的[应变能](@entry_id:162699)将被释放，使物体恢复到初始状态。因此，[应变能](@entry_id:162699) $U$ 是一个依赖于结构变形状态的标量函数。

对于受弯曲作用的[欧拉-伯努利梁](@entry_id:749104)（Euler–Bernoulli beam），其[应变能](@entry_id:162699)主要由弯曲变形贡献。我们可以从[应变能密度](@entry_id:200085)的基本定义出发推导其表达式。对于单轴应力状态下的线弹性材料，[应变能密度](@entry_id:200085)（单位体积的应变能）为 $u = \frac{1}{2}\sigma_x \epsilon_x = \frac{1}{2}E\epsilon_x^2$。根据[欧拉-伯努利梁](@entry_id:749104)的运动学假设，距中性轴为 $y$ 处的[轴向应变](@entry_id:160811) $\epsilon_x$与梁的曲率 $\kappa(x)$ 成正比，即 $\epsilon_x = -y \kappa(x)$。将此关系代入，并在[横截面](@entry_id:154995)积 $A$ 上积分，可得单位长度梁段的[应变能](@entry_id:162699)：
$$
\frac{\mathrm{d}U}{\mathrm{d}x} = \int_A \frac{1}{2} E (y \kappa(x))^2 \mathrm{d}A = \frac{1}{2} E \kappa(x)^2 \int_A y^2 \mathrm{d}A
$$
其中，积分项 $\int_A y^2 \mathrm{d}A$正是[截面](@entry_id:154995)绕弯曲中性轴的惯性矩 $I$。利用线弹性梁的[弯矩-曲率关系](@entry_id:180260) $M(x) = EI(x)\kappa(x)$，我们可以将曲率 $\kappa(x)$ 替换为[弯矩](@entry_id:202968) $M(x)$，得到更实用的形式。最终，梁的总[弯曲应变能](@entry_id:203595)为沿其长度 $L$ 的积分：
$$
U = \int_0^L \frac{M(x)^2}{2EI(x)} \mathrm{d}x
$$
这个公式是应用[能量法](@entry_id:183021)分析梁结构的基础 [@problem_id:2867821]。

应变能与[广义力](@entry_id:169699)之间的关系由**卡氏第一定理**（Castigliano's First Theorem）给出。该定理源于**[最小势能原理](@entry_id:173340)**（Principle of Minimum Potential Energy）。一个保守弹性系统的总势能 $\Pi$ 由其内部应变能 $U$ 和外载荷[势能](@entry_id:748988) $W$ 组成。对于一组[广义力](@entry_id:169699) $\{Q_i\}$ 和与之共轭的广义位移 $\{q_i\}$，外载荷势能为 $W = -\sum_i Q_i q_i$，因此总[势能](@entry_id:748988)为：
$$
\Pi(\{q_i\}) = U(\{q_i\}) - \sum_i Q_i q_i
$$
在平衡状态下，系统的总势能对于任何微小的、运动学容许的位移变化都处于驻定值（通常是最小值）。这意味着总势能对任意广义位移 $q_j$ 的偏导数为零：
$$
\frac{\partial \Pi}{\partial q_j} = \frac{\partial U}{\partial q_j} - Q_j = 0
$$
由此可得：
$$
Q_j = \frac{\partial U}{\partial q_j}
$$
这便是**卡氏第一定理**的数学表述：在保守弹性系统中，对应于某广义位移的[广义力](@entry_id:169699)，等于系统的总应变能对该广义位移的偏导数 [@problem_id:2577354]。该定理的精髓在于，如果已知[应变能](@entry_id:162699)如何随位移变化，就可以求出维持该位移状态所需的力。它适用于线性和[非线性弹性](@entry_id:185743)系统。例如，对于一个[非线性弹簧](@entry_id:173069)，其力-位移关系为 $F(\delta) = k\delta + \beta\delta^3$，其应变能为 $U(\delta) = \int_0^\delta F(\hat{\delta})\mathrm{d}\hat{\delta} = \frac{1}{2}k\delta^2 + \frac{1}{4}\beta\delta^4$。根据卡氏第一定理，作用在弹簧上的外力 $P$ 必须等于 $\frac{\mathrm{d}U}{\mathrm{d}\delta} = k\delta + \beta\delta^3$，这与弹簧的本构关系一致 [@problem_id:2621176]。

### [余能](@entry_id:192009)与[卡氏第二定理](@entry_id:176952)

与[应变能](@entry_id:162699) $U(q)$ 概念对偶的是**余能**（Complementary Energy），记为 $U^*$。如果说应变能是位移的函数，那么余能天然地是力的函数。在力-位移图上，应变能是曲线下方的面积，而余能是曲线左侧的面积。对于一个从零状态加载的弹性系统，它们之间通过**[勒让德变换](@entry_id:146727)**（Legendre Transform）联系：
$$
U^* = \sum_i Q_i q_i - U
$$
对上式求[全微分](@entry_id:171747)，并利用卡氏第一定理（$dQ_j = \sum_k \frac{\partial^2 U}{\partial q_j \partial q_k} dq_k$的关系暗含其中，而 $\mathrm{d}U = \sum_j \frac{\partial U}{\partial q_j} dq_j = \sum_j Q_j dq_j$），可得：
$$
\mathrm{d}U^* = \sum_i (q_i \mathrm{d}Q_i + Q_i \mathrm{d}q_i) - \mathrm{d}U = \sum_i q_i \mathrm{d}Q_i
$$
从这个微分形式可以看出，$U^*$ 是[广义力](@entry_id:169699) $\{Q_i\}$ 的函数，并且：
$$
q_j = \frac{\partial U^*}{\partial Q_j}
$$
此关系被称为**克罗蒂-恩格塞定理**（Crotti-Engesser Theorem），它对任何保守的、具有单值力-位移关系的弹性系统都成立，无论其是否为线性 [@problem_id:2621176] [@problem_id:2628235]。该定理表明，在力控制下，某[广义力](@entry_id:169699)所对应的广义位移，等于系统的总余能对该[广义力](@entry_id:169699)的[偏导数](@entry_id:146280)。这个定理是更普适的能量-位移关系。

现在，我们考虑一个重要的特例：**线弹性系统**。在线弹性系统中，力与位移成正比，其力-位移曲线是一条过原点的直线。在这种情况下，应变能（曲线下的三角形面积）和[余能](@entry_id:192009)（曲线左的三角形面积）在数值上是相等的：
$$
U = U^* = \frac{1}{2} \sum_i Q_i q_i
$$
这一[等价关系](@entry_id:138275)是线弹性系统的一个标志性特征 [@problem_id:2870231]。正是由于 $U = U^*$，我们可以将克罗蒂-恩格塞定理中的余能 $U^*$ 替换为更容易计算的应变能 $U$，从而得到一个在工程中极为常用的简化形式。这就是**[卡氏第二定理](@entry_id:176952)**（Castigliano's Second Theorem）[@problem_id:2577354]：
$$
q_j = \frac{\partial U}{\partial Q_j}
$$
该定理指出：对于**线弹性**结构，在某点沿某方向的位移（或转角），等于结构的总应变能对作用在该点并沿该方向的力（或力偶矩）的[偏导数](@entry_id:146280)。

必须强调[卡氏第二定理](@entry_id:176952)的适用条件，任何误用都将导致错误的结果 [@problem_id:2867821]：
1.  **线弹性材料**：这是 $U=U^*$ 的前提。
2.  **小变形**：确保叠加原理成立，并且可以在未变形的结构上建立平衡。
3.  **保守载荷与支座**：载荷与变形路径无关，支座不发生移动。
4.  **温度恒定**：避免产生温度应力与应变。

只要满足这些条件，[卡氏第二定理](@entry_id:176952)对静定和[超静定结构](@entry_id:185344)都同样有效。

### [卡氏第二定理](@entry_id:176952)的应用

[卡氏第二定理](@entry_id:176952)的应用主要体现在两个方面：计算结构的位移和求解[超静定结构](@entry_id:185344)的冗余力。

#### 计算位移：虚设载荷法

在许多情况下，我们希望计算结构在某一点的位移，但该点上并未施加与位移方向一致的集中载荷。此时，可以采用**虚设载荷法**（Method of Fictitious/Dummy Loads）。具体步骤如下：

1.  在需要求解位移 $q_j$ 的点，沿该位移方向施加一个虚拟的[广义力](@entry_id:169699) $Q_j$（如果求转角，则施加[虚拟力](@entry_id:165088)偶矩）。
2.  计算整个结构在真实载荷和虚拟载荷 $Q_j$ 共同作用下的总[应变能](@entry_id:162699) $U$。此时，$U$ 是 $Q_j$ 和其他真实载荷的函数。
3.  根据[卡氏第二定理](@entry_id:176952)，对总应变能 $U$ 求关于虚拟载荷 $Q_j$ 的偏导数。
4.  在求导完成后，令虚拟载荷 $Q_j = 0$，即可得到该点在原始载荷下的真实位移。

例如，考虑一个平面刚架上的节点 A，我们希望求其水平位移 $u_A$、竖向位移 $v_A$ 和[截面](@entry_id:154995)转角 $\theta_A$。我们需要引入三个独立的虚拟载荷：一个水平力 $P_x$、一个竖向力 $P_y$ 和一个绕 z 轴的力偶矩 $M_z$，均作用于节点 A。然后计算包含这些虚拟载荷的总[应变能](@entry_id:162699) $U(P_x, P_y, M_z, \dots)$。节点 A 的位移和转角则可按如下方式求得 [@problem_id:2870285]：
$$
u_A = \left.\frac{\partial U}{\partial P_x}\right|_{P_x, P_y, M_z = 0}
$$
$$
v_A = \left.\frac{\partial U}{\partial P_y}\right|_{P_x, P_y, M_z = 0}
$$
$$
\theta_A = \left.\frac{\partial U}{\partial M_z}\right|_{P_x, P_y, M_z = 0}
$$
其中，求导后令虚拟载荷为零，是为了消除它们对结构响应的实际影响，仅利用它们作为数学上的“探针”。

作为一个具体的计算实例，考虑一根长度为 $L$、[抗弯刚度](@entry_id:180453)为 $EI$ 的悬臂梁，在自由端承受集中力 $P$。梁内任意位置 $x$ (从固定端算起) 的[弯矩](@entry_id:202968)为 $M(x) = -P(L-x)$。梁的总应变能为：
$$
U = \int_0^L \frac{M(x)^2}{2EI} \mathrm{d}x = \int_0^L \frac{(-P(L-x))^2}{2EI} \mathrm{d}x = \frac{P^2}{2EI} \int_0^L (L-x)^2 \mathrm{d}x = \frac{P^2L^3}{6EI}
$$
根据[卡氏第二定理](@entry_id:176952)，自由端的竖向位移 $\delta$ 为：
$$
\delta = \frac{\partial U}{\partial P} = \frac{\partial}{\partial P}\left(\frac{P^2L^3}{6EI}\right) = \frac{2P L^3}{6EI} = \frac{PL^3}{3EI}
$$
这个结果与[材料力学](@entry_id:201885)中的经典公式完全一致 [@problem_id:2577354]。

#### 求解[超静定结构](@entry_id:185344)

[卡氏第二定理](@entry_id:176952)为求解[超静定结构](@entry_id:185344)提供了一种基于变形协调条件的系统方法，有时也被称为**最小功原理**（Principle of Least Work）。其核心思想是：将一个或多个冗余约束（反力或内力）视作未知的“载荷”，使原结构变为静定的基本结构。然后利用位移协调条件建立方程，求解这些未知载荷。

步骤如下：
1.  确定结构的[超静定](@entry_id:178116)次数 $n$，并选取 $n$ 个冗余力 $R_1, R_2, \dots, R_n$。将这些冗余力当作外加载荷，得到一个静定基[本体](@entry_id:264049)系。
2.  计算该基[本体](@entry_id:264049)系在所有真实载荷和冗余力 $R_i$ 共同作用下的总[应变能](@entry_id:162699) $U$。$U$ 将是冗余力 $R_i$ 的函数。
3.  应用位移协调条件。在冗余约束所在的点，位移是已知的（通常为零）。根据[卡氏第二定理](@entry_id:176952)，该点的位移等于[应变能](@entry_id:162699)对相应冗余力的[偏导数](@entry_id:146280)。因此，我们得到一组方程：
    $$
    \delta_i = \frac{\partial U}{\partial R_i} = \text{已知位移（通常为0）}, \quad i=1, 2, \dots, n
    $$
4.  求解这个包含 $n$ 个方程的[代数方程](@entry_id:272665)组，即可得到所有冗余力的大小。

让我们看一个例子：一根长度为 $L$、抗弯刚度为 $EI$ 的梁，左端固定，右端由滚轴支座支撑（即一端固定、一端简支的梁）。梁上作用有向下的线性[分布载荷](@entry_id:162746) $w(x) = \frac{w_0}{L}x$。这是一个一次[超静定结构](@entry_id:185344)。我们可以选择右端支座的反力 $R_B$ 作为冗余力。移除该支座，结构变为一个承受[分布载荷](@entry_id:162746)和末端未知力 $R_B$ 的悬臂梁。
梁内任意位置 $x$ 处的[弯矩](@entry_id:202968) $M(x)$ 是真实载荷和冗余力 $R_B$ 共同作用的结果。总[应变能](@entry_id:162699) $U$ 是 $R_B$ 的函数。
右端滚轴支座的位移协调条件是其竖向位移为零，即 $\delta_B=0$。根据[卡氏第二定理](@entry_id:176952)：
$$
\delta_B = \frac{\partial U}{\partial R_B} = \frac{\partial}{\partial R_B} \int_0^L \frac{M(x, R_B)^2}{2EI} \mathrm{d}x = \frac{1}{EI}\int_0^L M(x, R_B) \frac{\partial M(x, R_B)}{\partial R_B} \mathrm{d}x = 0
$$
通过计算弯矩表达式 $M(x, R_B)$ 及其对 $R_B$ 的偏导数，并求解上述[积分方程](@entry_id:138643)，可以得到冗余力 $R_B$ 的值。对于本例，精确求解后可得 $R_B = \frac{w_0 L}{10}$ [@problem_id:2621171]。

此方法同样适用于包含不同弹性元件的组合结构。例如，考虑一根简支梁，其中点下方由一根刚度为 $k$ 的线性弹簧支撑，同时中点承受集中载荷 $P$。我们可以将弹簧提供的未知支撑力 $X$ 视为冗余力。系统的总应变能是梁的[弯曲应变能](@entry_id:203595) $U_{beam}$ 和弹簧的[弹性势能](@entry_id:168893) $U_{spring}$ 之和：
$$
U_{total}(X) = U_{beam}(P, X) + U_{spring}(X) = \frac{(P-X)^2 L^3}{96EI} + \frac{X^2}{2k}
$$
根据最小功原理（即变形协调），冗余力 $X$ 的值必须使总[应变能](@entry_id:162699)取最小值。这意味着[应变能](@entry_id:162699)对 $X$ 的导数为零（因为弹簧连接点的“净位移”为零，弹簧的伸长量等于梁的挠度）：
$$
\frac{\partial U_{total}}{\partial X} = 0
$$
求解此方程即可得到弹簧力 $X$ 和中点挠度 $\delta$ [@problem_id:2621188]。

### 局限性与推广

尽管[卡氏定理](@entry_id:191013)非常强大，但理解其局限性至关重要。如前所述，[卡氏第二定理](@entry_id:176952) $\delta = \partial U / \partial P$ 严格限于**线弹性、小变形**的范畴。

当结构出现**[几何非线性](@entry_id:169896)**（即大变形）时，即使材料本身是线弹性的，力与位移的关系也不再是线性的。在这种情况下，应变能 $U$ 是变形（构型）的函数，它通过[平衡方程](@entry_id:172166)与载荷 $F$ 产生隐式关联，而不是显式依赖于 $F$。因此，在固定构型下对 $U$ 求关于 $F$ 的偏导数 $\left(\frac{\partial U}{\partial F}\right)_{\text{config}}$ 将得到零，这显然不等于非零的位移 $\delta$ [@problem_id:2870259]。在这种[非线性弹性](@entry_id:185743)情况下，必须回归到更具普适性的克罗蒂-恩格塞定理，即通过对**余能** $U^*$求导来计算位移：$\delta = \partial U^* / \partial P$ [@problem_id:2621176]。

此外，对于**[弹塑性](@entry_id:193198)**等[非保守系统](@entry_id:166237)，加载和卸载路径不同，能量会被耗散（例如通过塑性功），不存在一个单值的[应变能函数](@entry_id:178435)来描述系统的状态。因此，[卡氏定理](@entry_id:191013)及其推广形式均不再适用 [@problem_id:2628235]。

综上所述，卡氏第一定理和第二定理构成了能量方法的重要支柱。第一定理从应变能导出[内力](@entry_id:167605)，而第二定理则从[应变能](@entry_id:162699)（或更广义的余能）导出位移。正确理解和应用这两个定理，特别是它们各自的适用范围——第一定理适用于所有弹性体，而第二定理的经典形式仅限于线弹性系统——是进行精确[结构分析](@entry_id:153861)的关键。