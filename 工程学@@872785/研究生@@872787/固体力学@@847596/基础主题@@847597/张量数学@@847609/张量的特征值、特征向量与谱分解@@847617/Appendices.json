{"hands_on_practices": [{"introduction": "理解张量的谱分解始于亲手进行基本计算的能力。本练习提供了一个具体的柯西应力张量，引导你完成求解其主值和主方向的关键步骤[@problem_id:2633182]。通过利用其特征值和特征向量显式地重构原始张量，你将巩固对支撑连续介质力学诸多理论的核心定理的理解。", "problem": "一个均匀、静态、小变形固体承受一均匀柯西应力场，该应力场在固定正交基 $\\{\\mathbf{e}_{x},\\mathbf{e}_{y},\\mathbf{e}_{z}\\}$ 中由对称二阶张量表示为\n$$\n\\mathbf{T}=\\begin{bmatrix}2 & 1 & 0\\\\ 1 & 3 & 0\\\\ 0 & 0 & 1\\end{bmatrix}.\n$$\n在固体力学中，主应力是 $\\mathbf{T}$ 的特征值，主方向是相应的特征向量。$\\mathbf{T}$ 在主基中的谱表示是主方向与其对应主应力标度的并矢积之和。\n\n从二阶张量的特征值-特征向量对 $(\\lambda,\\mathbf{v}\\neq\\mathbf{0})$ 的定义（即 $\\mathbf{T}\\mathbf{v}=\\lambda\\,\\mathbf{v}$）以及实对称张量的标准性质（特征值为实数且特征向量相互正交）出发，执行以下操作：\n\na) 计算 $\\mathbf{T}$ 的所有特征值 $\\lambda_{i}$ 以及每个特征值对应的一个单位化特征向量 $\\mathbf{n}_{i}$。采用符号约定，即对每个单位化特征向量，其第一个非零分量为正。\n\nb) 显式验证集合 $\\{\\mathbf{n}_{1},\\mathbf{n}_{2},\\mathbf{n}_{3}\\}$ 是正交归一的。\n\nc) 利用您的结果，写出 $\\mathbf{T}$ 关于其特征对的谱分解，并通过直接重构验证其能再现给定的 $\\mathbf{T}$ 矩阵。\n\n最后，令 $\\mathbf{Q}$ 表示一个正交矩阵，其列向量是按特征值降序排列的单位化特征向量，即 $\\mathbf{Q}=\\begin{bmatrix}\\mathbf{n}_{1} & \\mathbf{n}_{2} & \\mathbf{n}_{3}\\end{bmatrix}$，其中 $\\lambda_{1}>\\lambda_{2}>\\lambda_{3}$。计算标量\n$$\nD=\\det(\\mathbf{Q})\n$$\n并将此值作为您的最终答案。$D$ 是无量纲的。不需要四舍五入。最终报告的值不应包含任何单位。", "solution": "问题陈述具有科学依据，提法恰当且客观。这是一个连续介质力学中的标准问题，涉及对称二阶张量（柯西应力张量）的谱分析。所有必要的数据和定义均已提供，没有矛盾或含糊之处。该问题是可解的。\n\n任务是求解给定柯西应力张量 $\\mathbf{T}$ 的特征值（主应力）和特征向量（主方向），验证它们的性质，构造谱分解，并最终计算由单位化特征向量构成的旋转矩阵的行列式。\n\n给定的应力张量为：\n$$\n\\mathbf{T}=\\begin{bmatrix}2 & 1 & 0\\\\1 & 3 & 0\\\\0 & 0 & 1\\end{bmatrix}\n$$\n特征值 $\\lambda$ 是特征方程 $\\det(\\mathbf{T} - \\lambda\\mathbf{I}) = 0$ 的根，其中 $\\mathbf{I}$ 是单位张量。\n$$\n\\det\\left(\\begin{bmatrix}2 & 1 & 0\\\\1 & 3 & 0\\\\0 & 0 & 1\\end{bmatrix} - \\lambda\\begin{bmatrix}1 & 0 & 0\\\\0 & 1 & 0\\\\0 & 0 & 1\\end{bmatrix}\\right) = 0\n$$\n$$\n\\det\\begin{bmatrix}2-\\lambda & 1 & 0\\\\1 & 3-\\lambda & 0\\\\0 & 0 & 1-\\lambda\\end{bmatrix} = 0\n$$\n沿第三行展开行列式可得：\n$$\n(1-\\lambda) \\det\\begin{pmatrix} 2-\\lambda & 1 \\\\ 1 & 3-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(1-\\lambda) [(2-\\lambda)(3-\\lambda) - (1)(1)] = 0\n$$\n$$\n(1-\\lambda) [\\lambda^2 - 5\\lambda + 6 - 1] = 0\n$$\n$$\n(1-\\lambda) (\\lambda^2 - 5\\lambda + 5) = 0\n$$\n根为 $\\lambda = 1$ 以及二次方程 $\\lambda^2 - 5\\lambda + 5 = 0$ 的根。使用二次公式，$\\lambda = \\frac{-(-5) \\pm \\sqrt{(-5)^2 - 4(1)(5)}}{2(1)} = \\frac{5 \\pm \\sqrt{25-20}}{2} = \\frac{5 \\pm \\sqrt{5}}{2}$。\n\na) 根据问题最后部分的要求，将三个特征值按降序排列（$\\lambda_1 > \\lambda_2 > \\lambda_3$），它们是：\n$$\n\\lambda_1 = \\frac{5+\\sqrt{5}}{2}\n$$\n$$\n\\lambda_2 = \\frac{5-\\sqrt{5}}{2}\n$$\n$$\n\\lambda_3 = 1\n$$\n现在我们从方程 $(\\mathbf{T} - \\lambda\\mathbf{I})\\mathbf{v} = \\mathbf{0}$ 求解相应的特征向量 $\\mathbf{v}$。\n\n对于 $\\lambda_1 = \\frac{5+\\sqrt{5}}{2}$：\n令 $\\mathbf{v}_1 = [v_x, v_y, v_z]^T$。\n$$\n\\begin{bmatrix}2-\\lambda_1 & 1 & 0 \\\\ 1 & 3-\\lambda_1 & 0 \\\\ 0 & 0 & 1-\\lambda_1\\end{bmatrix} \\begin{bmatrix}v_x \\\\ v_y \\\\ v_z\\end{bmatrix} = \\begin{bmatrix}0\\\\0\\\\0\\end{bmatrix}\n$$\n由于 $\\lambda_1 \\neq 1$，第三行意味着 $(1-\\lambda_1)v_z=0 \\Rightarrow v_z=0$。第一行给出 $(2-\\lambda_1)v_x + v_y = 0$，因此 $v_y = (\\lambda_1-2)v_x$。\n$$\n\\lambda_1 - 2 = \\frac{5+\\sqrt{5}}{2} - 2 = \\frac{1+\\sqrt{5}}{2}\n$$\n选择 $v_x=1$（以满足第一个非零分量为正的规则），一个未单位化的特征向量是 $\\mathbf{v}_1 = [1, \\frac{1+\\sqrt{5}}{2}, 0]^T$。其模的平方为 $|\\mathbf{v}_1|^2 = 1^2 + (\\frac{1+\\sqrt{5}}{2})^2 + 0^2 = 1 + \\frac{1+2\\sqrt{5}+5}{4} = 1 + \\frac{6+2\\sqrt{5}}{4} = 1 + \\frac{3+\\sqrt{5}}{2} = \\frac{5+\\sqrt{5}}{2}$。\n单位化特征向量是 $\\mathbf{n}_1 = \\frac{\\mathbf{v}_1}{|\\mathbf{v}_1|} = \\frac{1}{\\sqrt{\\frac{5+\\sqrt{5}}{2}}} \\begin{bmatrix} 1 \\\\ \\frac{1+\\sqrt{5}}{2} \\\\ 0 \\end{bmatrix}$。\n\n对于 $\\lambda_2 = \\frac{5-\\sqrt{5}}{2}$：\n类似地，$v_z=0$ 且 $v_y = (\\lambda_2-2)v_x$。\n$$\n\\lambda_2 - 2 = \\frac{5-\\sqrt{5}}{2} - 2 = \\frac{1-\\sqrt{5}}{2}\n$$\n选择 $v_x=1$，一个未单位化的特征向量是 $\\mathbf{v}_2 = [1, \\frac{1-\\sqrt{5}}{2}, 0]^T$。其模的平方为 $|\\mathbf{v}_2|^2 = 1^2 + (\\frac{1-\\sqrt{5}}{2})^2 + 0^2 = 1 + \\frac{1-2\\sqrt{5}+5}{4} = 1 + \\frac{3-\\sqrt{5}}{2} = \\frac{5-\\sqrt{5}}{2}$。\n单位化特征向量是 $\\mathbf{n}_2 = \\frac{\\mathbf{v}_2}{|\\mathbf{v}_2|} = \\frac{1}{\\sqrt{\\frac{5-\\sqrt{5}}{2}}} \\begin{bmatrix} 1 \\\\ \\frac{1-\\sqrt{5}}{2} \\\\ 0 \\end{bmatrix}$。\n\n对于 $\\lambda_3 = 1$：\n$$\n\\begin{bmatrix}1 & 1 & 0 \\\\ 1 & 2 & 0 \\\\ 0 & 0 & 0\\end{bmatrix} \\begin{bmatrix}v_x \\\\ v_y \\\\ v_z\\end{bmatrix} = \\begin{bmatrix}0\\\\0\\\\0\\end{bmatrix}\n$$\n这得到 $v_x+v_y=0$ 和 $v_x+2v_y=0$，这意味着 $v_x=0$ 和 $v_y=0$。$v_z$ 是任意的。选择 $v_z=1$ 以满足符号约定，特征向量为 $\\mathbf{v}_3 = [0, 0, 1]^T$。这个向量已经是单位向量，所以 $\\mathbf{n}_3 = [0, 0, 1]^T$。\n\nb) 为验证正交归一性，我们检查点积：根据构造，模长都为 $1$。\n$\\mathbf{n}_1 \\cdot \\mathbf{n}_3 = 0$ 且 $\\mathbf{n}_2 \\cdot \\mathbf{n}_3 = 0$，因为 $\\mathbf{n}_1$ 和 $\\mathbf{n}_2$ 的 $z$ 分量为零，而 $\\mathbf{n}_3$ 的 $x$ 和 $y$ 分量为零。\n对于 $\\mathbf{n}_1 \\cdot \\mathbf{n}_2$，我们可以使用它们未单位化的对应向量 $\\mathbf{v}_1$ 和 $\\mathbf{v}_2$：\n$$\n\\mathbf{v}_1 \\cdot \\mathbf{v}_2 = (1)(1) + \\left(\\frac{1+\\sqrt{5}}{2}\\right)\\left(\\frac{1-\\sqrt{5}}{2}\\right) + (0)(0) = 1 + \\frac{1^2 - (\\sqrt{5})^2}{4} = 1 + \\frac{1-5}{4} = 1 - 1 = 0\n$$\n由于 $\\mathbf{v}_1 \\cdot \\mathbf{v}_2 = 0$，因此 $\\mathbf{n}_1 \\cdot \\mathbf{n}_2 = 0$。集合 $\\{\\mathbf{n}_1, \\mathbf{n}_2, \\mathbf{n}_3\\}$ 是正交归一的。\n\nc) $\\mathbf{T}$ 的谱分解为 $\\mathbf{T} = \\sum_{i=1}^{3} \\lambda_i \\mathbf{n}_i \\otimes \\mathbf{n}_i = \\sum_{i=1}^{3} \\lambda_i \\mathbf{n}_i \\mathbf{n}_i^T$。\n我们注意到 $|\\mathbf{v}_1|^2 = \\lambda_1$ 且 $|\\mathbf{v}_2|^2 = \\lambda_2$。\n$$\n\\lambda_1 \\mathbf{n}_1 \\mathbf{n}_1^T = \\lambda_1 \\frac{\\mathbf{v}_1 \\mathbf{v}_1^T}{|\\mathbf{v}_1|^2} = \\lambda_1 \\frac{\\mathbf{v}_1 \\mathbf{v}_1^T}{\\lambda_1} = \\mathbf{v}_1 \\mathbf{v}_1^T = \\begin{bmatrix} 1 \\\\ \\frac{1+\\sqrt{5}}{2} \\\\ 0 \\end{bmatrix} \\begin{bmatrix} 1 & \\frac{1+\\sqrt{5}}{2} & 0 \\end{bmatrix} = \\begin{bmatrix} 1 & \\frac{1+\\sqrt{5}}{2} & 0 \\\\ \\frac{1+\\sqrt{5}}{2} & \\frac{3+\\sqrt{5}}{2} & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\n$$\n$$\n\\lambda_2 \\mathbf{n}_2 \\mathbf{n}_2^T = \\lambda_2 \\frac{\\mathbf{v}_2 \\mathbf{v}_2^T}{|\\mathbf{v}_2|^2} = \\lambda_2 \\frac{\\mathbf{v}_2 \\mathbf{v}_2^T}{\\lambda_2} = \\mathbf{v}_2 \\mathbf{v}_2^T = \\begin{bmatrix} 1 \\\\ \\frac{1-\\sqrt{5}}{2} \\\\ 0 \\end{bmatrix} \\begin{bmatrix} 1 & \\frac{1-\\sqrt{5}}{2} & 0 \\end{bmatrix} = \\begin{bmatrix} 1 & \\frac{1-\\sqrt{5}}{2} & 0 \\\\ \\frac{1-\\sqrt{5}}{2} & \\frac{3-\\sqrt{5}}{2} & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\n$$\n$$\n\\lambda_3 \\mathbf{n}_3 \\mathbf{n}_3^T = (1) \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} 0 & 0 & 1 \\end{bmatrix} = \\begin{bmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}\n$$\n将这些矩阵相加：\n$$\n\\mathbf{T}_{\\text{recon}} = \\begin{bmatrix} 1+1+0 & \\frac{1+\\sqrt{5}}{2}+\\frac{1-\\sqrt{5}}{2}+0 & 0 \\\\ \\frac{1+\\sqrt{5}}{2}+\\frac{1-\\sqrt{5}}{2}+0 & \\frac{3+\\sqrt{5}}{2}+\\frac{3-\\sqrt{5}}{2}+0 & 0 \\\\ 0 & 0 & 0+0+1 \\end{bmatrix} = \\begin{bmatrix} 2 & \\frac{2}{2} & 0 \\\\ \\frac{2}{2} & \\frac{6}{2} & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} = \\begin{bmatrix} 2 & 1 & 0 \\\\ 1 & 3 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}\n$$\n这与原始张量 $\\mathbf{T}$ 相符，因此谱分解得到验证。\n\n最后，我们计算 $D = \\det(\\mathbf{Q})$，其中 $\\mathbf{Q} = [\\mathbf{n}_1, \\mathbf{n}_2, \\mathbf{n}_3]$。\n$$\n\\mathbf{Q} = \\begin{bmatrix} n_{1x} & n_{2x} & n_{3x} \\\\ n_{1y} & n_{2y} & n_{3y} \\\\ n_{1z} & n_{2z} & n_{3z} \\end{bmatrix} = \\begin{bmatrix} \\frac{1}{|\\mathbf{v}_1|} & \\frac{1}{|\\mathbf{v}_2|} & 0 \\\\ \\frac{(1+\\sqrt{5})/2}{|\\mathbf{v}_1|} & \\frac{(1-\\sqrt{5})/2}{|\\mathbf{v}_2|} & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}\n$$\n行列式为：\n$$\nD = \\det(\\mathbf{Q}) = (1) \\cdot \\det\\begin{pmatrix} \\frac{1}{|\\mathbf{v}_1|} & \\frac{1}{|\\mathbf{v}_2|} \\\\ \\frac{(1+\\sqrt{5})/2}{|\\mathbf{v}_1|} & \\frac{(1-\\sqrt{5})/2}{|\\mathbf{v}_2|} \\end{pmatrix}\n$$\n$$\nD = \\frac{1}{|\\mathbf{v}_1||\\mathbf{v}_2|} \\left( (1)\\left(\\frac{1-\\sqrt{5}}{2}\\right) - (1)\\left(\\frac{1+\\sqrt{5}}{2}\\right) \\right)\n$$\n分母是 $|\\mathbf{v}_1||\\mathbf{v}_2| = \\sqrt{\\lambda_1}\\sqrt{\\lambda_2} = \\sqrt{\\lambda_1 \\lambda_2} = \\sqrt{5}$。\n分子是 $\\frac{1-\\sqrt{5}-1-\\sqrt{5}}{2} = \\frac{-2\\sqrt{5}}{2} = -\\sqrt{5}$。\n$$\nD = \\frac{-\\sqrt{5}}{\\sqrt{5}} = -1\n$$\n另外，正交矩阵 $\\mathbf{Q}$ 的行列式是其列向量的标量三重积，即 $\\det(\\mathbf{Q}) = \\mathbf{n}_1 \\cdot (\\mathbf{n}_2 \\times \\mathbf{n}_3)$。由于特征向量构成一个正交归一基，行列式必须为 $\\pm1$。我们为特征向量选择的符号约定决定了该基是右手系（$+1$）还是左手系（$-1$）。计算结果表明，所得到的特征向量基 $\\{\\mathbf{n}_1, \\mathbf{n}_2, \\mathbf{n}_3\\}$ 是一个左手系。\n最终值为无量纲，符合要求。", "answer": "$$\\boxed{-1}$$", "id": "2633182"}, {"introduction": "掌握了基本计算之后，我们现在将这些概念应用于固体力学的一个核心主题：应力分解。本练习要求将一个应力张量分解为其静水压力部分和偏应力部分，这两部分分别控制材料的体积和形状变化[@problem_id:2633200]。通过验证应力张量与其偏应力部分共享相同的主轴（即共轴性），你将对其特征系统的物理诠释获得更深刻的见解。", "problem": "一个固体承受柯西应力张量 $\\boldsymbol{\\sigma}$（单位为兆帕），其表达式为\n$$\n\\boldsymbol{\\sigma}=\\begin{bmatrix}10 & 4 & 0 \\\\ 4 & 6 & 0 \\\\ 0 & 0 & 2\\end{bmatrix}.\n$$\n从固体力学的核心定义出发，完成以下任务：\n\n- 将平均（静水）应力 $p$ 定义为柯西应力张量迹的三分之一，并为给定的 $\\boldsymbol{\\sigma}$ 计算 $p$。\n- 通过 $\\mathbf{S}=\\boldsymbol{\\sigma}-p\\,\\mathbf{I}$ 定义偏应力张量 $\\mathbf{S}$，其中 $\\mathbf{I}$ 是单位张量，并显式计算 $\\mathbf{S}$。\n- 通过求解 $\\boldsymbol{\\sigma}$ 的特征值问题来获得主应力，并用其特征值和标准正交特征向量来表述 $\\boldsymbol{\\sigma}$ 的谱分解。\n- 使用第一性原理，验证 $\\boldsymbol{\\sigma}$ 和 $\\mathbf{S}$ 的共轴性。\n\n作为最终答案，报告由 $\\sigma_{\\mathrm{eq}}=\\sqrt{\\tfrac{3}{2}\\,\\mathbf{S}\\!:\\!\\mathbf{S}}$ 定义的 von Mises 等效应力，以兆帕（MPa）为单位的精确解析表达式。最终的方框答案中不包含单位。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 柯西应力张量：$\\boldsymbol{\\sigma}=\\begin{bmatrix}10 & 4 & 0 \\\\ 4 & 6 & 0 \\\\ 0 & 0 & 2\\end{bmatrix}$，单位为兆帕（$MPa$）。\n- 平均应力的定义：$p = \\frac{1}{3} \\mathrm{tr}(\\boldsymbol{\\sigma})$。\n- 偏应力张量的定义：$\\mathbf{S} = \\boldsymbol{\\sigma} - p\\,\\mathbf{I}$，其中 $\\mathbf{I}$ 是单位张量。\n- 任务a：计算 $p$。\n- 任务b：计算 $\\mathbf{S}$。\n- 任务c：求出 $\\boldsymbol{\\sigma}$ 的主应力（特征值）和标准正交特征向量，并陈述其谱分解。\n- 任务d：验证 $\\boldsymbol{\\sigma}$ 和 $\\mathbf{S}$ 的共轴性。\n- 最终答案：报告 von Mises 等效应力 $\\sigma_{\\mathrm{eq}}=\\sqrt{\\frac{3}{2}\\,\\mathbf{S}\\!:\\!\\mathbf{S}}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础**：该问题从根本上基于连续介质力学的原理，特别是对某一点应力状态的分析。所有概念——柯西应力、静水应力、偏应力、主应力、谱分解以及 von Mises 屈服准则——都是固体力学的标准和核心内容。该问题在科学上是合理的。\n- **适定性**：该问题是适定的。给定的应力张量是一个 $3 \\times 3$ 的实对称矩阵，这是角动量守恒对柯西应力张量的要求。所有定义都是标准的，任务是明确的计算，可以导出一个唯一且有意义的解。\n- **客观性**：问题以精确、客观的数学语言陈述。\n- **缺陷检查清单**：该问题没有违反任何有效性标准。它在科学上是合理的、可形式化的、完整的、现实的、适定的且非平凡的。\n\n**步骤3：结论与行动**\n该问题有效。将提供完整的解答。\n\n**解答推导**\n\n分析过程将逐一解决问题陈述中规定的每个任务。\n\n**平均（静水）应力, $p$**\n平均应力 $p$ 定义为应力张量 $\\boldsymbol{\\sigma}$ 的迹的三分之一。迹 $\\mathrm{tr}(\\boldsymbol{\\sigma})$ 是对角分量之和。\n$$\n\\mathrm{tr}(\\boldsymbol{\\sigma}) = \\sigma_{11} + \\sigma_{22} + \\sigma_{33} = 10 + 6 + 2 = 18\n$$\n因此，平均应力为：\n$$\np = \\frac{1}{3} \\mathrm{tr}(\\boldsymbol{\\sigma}) = \\frac{1}{3}(18) = 6 \\text{ MPa}\n$$\n\n**偏应力张量, $\\mathbf{S}$**\n偏应力张量 $\\mathbf{S}$ 代表应力的剪切分量，定义为 $\\mathbf{S} = \\boldsymbol{\\sigma} - p\\,\\mathbf{I}$。使用计算出的 $p=6$ 和 $3 \\times 3$ 单位张量 $\\mathbf{I}$：\n$$\n\\mathbf{S} = \\begin{bmatrix} 10 & 4 & 0 \\\\ 4 & 6 & 0 \\\\ 0 & 0 & 2 \\end{bmatrix} - 6 \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}\n$$\n$$\n\\mathbf{S} = \\begin{bmatrix} 10-6 & 4-0 & 0-0 \\\\ 4-0 & 6-6 & 0-0 \\\\ 0-0 & 0-0 & 2-6 \\end{bmatrix} = \\begin{bmatrix} 4 & 4 & 0 \\\\ 4 & 0 & 0 \\\\ 0 & 0 & -4 \\end{bmatrix}\n$$\n根据定义，偏应力张量的迹为零：$\\mathrm{tr}(\\mathbf{S}) = 4 + 0 + (-4) = 0$。\n\n**$\\boldsymbol{\\sigma}$ 的主应力和谱分解**\n主应力，用 $\\lambda$ 表示，是应力张量 $\\boldsymbol{\\sigma}$ 的特征值。它们通过求解特征方程 $\\det(\\boldsymbol{\\sigma} - \\lambda\\mathbf{I}) = 0$ 得到。\n$$\n\\det \\begin{pmatrix} 10-\\lambda & 4 & 0 \\\\ 4 & 6-\\lambda & 0 \\\\ 0 & 0 & 2-\\lambda \\end{pmatrix} = 0\n$$\n由于矩阵的块对角结构，行列式简化为：\n$$\n(2-\\lambda) \\left[ (10-\\lambda)(6-\\lambda) - (4)(4) \\right] = 0\n$$\n此方程立即给出一个主应力：$\\lambda_3 = 2$。另外两个主应力由以下二次方程求得：\n$$\n\\lambda^2 - 16\\lambda + 60 - 16 = 0 \\implies \\lambda^2 - 16\\lambda + 44 = 0\n$$\n使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$：\n$$\n\\lambda = \\frac{16 \\pm \\sqrt{(-16)^2 - 4(1)(44)}}{2} = \\frac{16 \\pm \\sqrt{256 - 176}}{2} = \\frac{16 \\pm \\sqrt{80}}{2}\n$$\n化简 $\\sqrt{80} = \\sqrt{16 \\times 5} = 4\\sqrt{5}$：\n$$\n\\lambda = \\frac{16 \\pm 4\\sqrt{5}}{2} = 8 \\pm 2\\sqrt{5}\n$$\n三个主应力，按照惯例排序为 $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3$，是：\n$\\sigma_1 = 8+2\\sqrt{5}$\n$\\sigma_2 = 8-2\\sqrt{5}$\n$\\sigma_3 = 2$\n\n主方向是相应的标准正交特征向量 $\\mathbf{n}_i$。它们通过对每个特征值 $\\lambda_i$ 求解 $(\\boldsymbol{\\sigma} - \\lambda_i\\mathbf{I})\\mathbf{n}_i = \\mathbf{0}$ 来找到。\n对于 $\\lambda_3 = 2$：\n$$\n(\\boldsymbol{\\sigma} - 2\\mathbf{I})\\mathbf{n}_3 = \\begin{pmatrix} 8 & 4 & 0 \\\\ 4 & 4 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} n_{31} \\\\ n_{32} \\\\ n_{33} \\end{pmatrix} = \\mathbf{0} \\implies n_{31}=0, n_{32}=0\n$$\n归一化的特征向量是 $\\mathbf{n}_3 = \\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix}^T$。\n\n对于 $\\lambda_1 = 8+2\\sqrt{5}$ 和 $\\lambda_2 = 8-2\\sqrt{5}$，我们求解：\n$$\n\\begin{pmatrix} 10-\\lambda & 4 \\\\ 4 & 6-\\lambda \\end{pmatrix} \\begin{pmatrix} n_1 \\\\ n_2 \\end{pmatrix} = \\mathbf{0}\n$$\n对于 $\\lambda_1 = 8+2\\sqrt{5}$：$(10-(8+2\\sqrt{5})) n_{11} + 4n_{12} = 0 \\implies (2-2\\sqrt{5})n_{11} + 4n_{12} = 0$。\n这给出了方向向量 $\\begin{pmatrix} 2 & \\sqrt{5}-1 \\end{pmatrix}^T$。将其归一化得到特征向量：\n$\\mathbf{n}_1 = \\frac{1}{\\sqrt{2^2+(\\sqrt{5}-1)^2}} \\begin{pmatrix} 2 \\\\ \\sqrt{5}-1 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{10-2\\sqrt{5}}} \\begin{pmatrix} 2 \\\\ \\sqrt{5}-1 \\\\ 0 \\end{pmatrix}$。\n\n对于 $\\lambda_2 = 8-2\\sqrt{5}$：$(10-(8-2\\sqrt{5})) n_{21} + 4n_{22} = 0 \\implies (2+2\\sqrt{5})n_{21} + 4n_{22} = 0$。\n这给出了方向向量 $\\begin{pmatrix} 2 & -1-\\sqrt{5} \\end{pmatrix}^T$。将其归一化得到特征向量：\n$\\mathbf{n}_2 = \\frac{1}{\\sqrt{2^2+(-1-\\sqrt{5})^2}} \\begin{pmatrix} 2 \\\\ -1-\\sqrt{5} \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{10+2\\sqrt{5}}} \\begin{pmatrix} 2 \\\\ -1-\\sqrt{5} \\\\ 0 \\end{pmatrix}$。\n\n对称张量的谱分解是其表示为特征值乘以其相应特征向量的外积之和：\n$$\n\\boldsymbol{\\sigma} = \\sum_{i=1}^3 \\sigma_i \\mathbf{n}_i \\otimes \\mathbf{n}_i = \\sigma_1 \\mathbf{n}_1\\mathbf{n}_1^T + \\sigma_2 \\mathbf{n}_2\\mathbf{n}_2^T + \\sigma_3 \\mathbf{n}_3\\mathbf{n}_3^T\n$$\n其中 $\\sigma_i$ 是上面计算的特征值，$\\mathbf{n}_i$ 是特征向量。\n\n**$\\boldsymbol{\\sigma}$ 与 $\\mathbf{S}$ 的共轴性**\n如果两个对称张量的主轴（特征向量）重合，则它们是共轴的。设 $\\mathbf{n}$ 是 $\\boldsymbol{\\sigma}$ 的一个特征向量，对应的特征值为 $\\lambda$。那么 $\\boldsymbol{\\sigma}\\mathbf{n} = \\lambda\\mathbf{n}$。我们研究 $\\mathbf{S}$ 对 $\\mathbf{n}$ 的作用：\n$$\n\\mathbf{S}\\mathbf{n} = (\\boldsymbol{\\sigma} - p\\mathbf{I})\\mathbf{n} = \\boldsymbol{\\sigma}\\mathbf{n} - p\\mathbf{I}\\mathbf{n} = \\lambda\\mathbf{n} - p\\mathbf{n} = (\\lambda-p)\\mathbf{n}\n$$\n这表明 $\\mathbf{n}$ 也是 $\\mathbf{S}$ 的一个特征向量，其特征值为 $(\\lambda-p)$。由于 $\\boldsymbol{\\sigma}$ 和 $\\mathbf{S}$ 共享同一组完整的标准正交特征向量 $\\{\\mathbf{n}_1, \\mathbf{n}_2, \\mathbf{n}_3\\}$，根据定义，它们是共轴的。这是任何应力张量及其偏量的一般性质。\n\n**von Mises 等效应力, $\\sigma_{\\mathrm{eq}}$**\nvon Mises 等效应力定义为 $\\sigma_{\\mathrm{eq}}=\\sqrt{\\frac{3}{2}\\,\\mathbf{S}\\!:\\!\\mathbf{S}}$。Frobenius 内积 $\\mathbf{S}\\!:\\!\\mathbf{S}$ 是 $\\mathbf{S}$ 各分量平方的和。\n$$\n\\mathbf{S} = \\begin{bmatrix} 4 & 4 & 0 \\\\ 4 & 0 & 0 \\\\ 0 & 0 & -4 \\end{bmatrix}\n$$\n$$\n\\mathbf{S}\\!:\\!\\mathbf{S} = S_{ij}S_{ij} = (4)^2 + (4)^2 + (0)^2 + (4)^2 + (0)^2 + (0)^2 + (0)^2 + (0)^2 + (-4)^2\n$$\n$$\n\\mathbf{S}\\!:\\!\\mathbf{S} = 16 + 16 + 0 + 16 + 0 + 0 + 0 + 0 + 16 = 64\n$$\n现在，我们计算 $\\sigma_{\\mathrm{eq}}$：\n$$\n\\sigma_{\\mathrm{eq}} = \\sqrt{\\frac{3}{2} (64)} = \\sqrt{3 \\times 32} = \\sqrt{96}\n$$\n为了以最简根式形式呈现答案，我们对被开方数进行因式分解：\n$$\n\\sqrt{96} = \\sqrt{16 \\times 6} = 4\\sqrt{6}\n$$\n该值为 $4\\sqrt{6}$ MPa。", "answer": "$$\n\\boxed{4\\sqrt{6}}\n$$", "id": "2633200"}, {"introduction": "最后的练习旨在弥合解析理论与计算应用之间的鸿沟，这是现代工程分析中至关重要的一步。本练习要求你实现谱分解算法，并探索在实际应用中出现的数值挑战，例如如何处理重根或数值上非常接近的特征值[@problem_id:2922080]。通过量化重构误差和投影算子的性质，你将体会到在有限元分析等领域中，数值代码所必需的稳健性。", "problem": "实现一个程序，对于一个实对称二阶张量 $A \\in \\mathbb{R}^{3 \\times 3}$，基于谱定理构建其谱分解，评估投影算子的性质，并量化重构质量。实现必须从以下基本概念出发：线性变换的特征值和特征向量的定义、实对称张量的谱定理以及正交投影算子的定义。不得假定在这些基础之外给定了任何专门的快捷公式；所有必需的计算步骤都必须从这些原理中推导出来。\n\n对于每个测试张量 $A$，您的程序必须执行以下操作：\n- 计算特征值 $\\lambda_i$ 和一组相应的标准正交特征向量 $n_i$，其中 $i \\in \\{1,2,3\\}$。\n- 构造秩一特征投影算子 $P_i = n_i \\otimes n_i$，其中 $(P_i)_{jk} = (n_i)_j (n_i)_k$。\n- 将特征值分组为簇，以表示重复或数值上聚集的特征值。两个相邻的特征值 $\\lambda_i$ 和 $\\lambda_{i+1}$（按值排序后）如果满足 $|\\lambda_{i+1} - \\lambda_i| \\le \\tau$，则属于同一个簇，其中 $\\tau = a_{\\text{tol}} + r_{\\text{tol}} \\cdot \\max_j |\\lambda_j|$，$a_{\\text{tol}} = 10^{-12}$，$r_{\\text{tol}} = 10^{-8}$。\n- 对于每个簇 $g$，定义簇投影算子 $P_g = \\sum_{i \\in g} P_i$ 和簇特征值 $\\bar{\\lambda}_g = \\frac{1}{|g|} \\sum_{i \\in g} \\lambda_i$。\n- 构建 $A$ 的两种重构：\n  - 完全重构 $A_{\\text{full}} = \\sum_{i=1}^{3} \\lambda_i P_i$。\n  - 分簇重构 $A_{\\text{group}} = \\sum_{g} \\bar{\\lambda}_g P_g$。\n- 计算以下标量诊断量：\n  1. 使用完全谱和的相对 Frobenius 范数重构误差：$E_{\\text{full}} = \\frac{\\| A - A_{\\text{full}} \\|_F}{\\max(\\|A\\|_F, 1)}$。\n  2. 使用分簇的相对 Frobenius 范数重构误差：$E_{\\text{group}} = \\frac{\\| A - A_{\\text{group}} \\|_F}{\\max(\\|A\\|_F, 1)}$。\n  3. 秩一投影算子间的最大正交性缺陷：$E_{\\text{orth}} = \\max_{i \\ne j} \\| P_i P_j \\|_F$。\n  4. 秩一投影算子间的最大幂等性缺陷：$E_{\\text{idem}} = \\max_{i} \\| P_i^2 - P_i \\|_F$。\n此处 $\\|\\cdot\\|_F$ 表示 Frobenius 范数。规定分母为 $\\max(\\|A\\|_F, 1)$ 以避免当 $A$ 为零张量时出现除以零的情况。\n\n您的程序必须为以下五个测试用例的测试套件实现上述功能。所用角度必须以弧度为单位。\n\n- 测试 1 (不同特征值，非对角耦合):\n  $$A_1 = \\begin{bmatrix}\n  2.0 & 0.3 & 0.0 \\\\\n  0.3 & 1.0 & 0.1 \\\\\n  0.0 & 0.1 & 0.5\n  \\end{bmatrix}.$$\n\n- 测试 2 (对角线上近似重复的特征值):\n  $$A_2 = \\operatorname{diag}(1.0,\\, 1.0 + 10^{-8},\\, 2.0).$$\n\n- 测试 3 (旋转坐标系中的精确重复特征值)。令 $\\theta = \\pi/6$。定义绕 z 轴的平面内旋转\n  $$Q = \\begin{bmatrix}\n  \\cos\\theta & -\\sin\\theta & 0 \\\\\n  \\sin\\theta & \\cos\\theta & 0 \\\\\n  0 & 0 & 1\n  \\end{bmatrix}, \\quad D = \\operatorname{diag}(3.0,\\, 3.0,\\, 1.0), \\quad A_3 = Q D Q^\\top.$$\n\n- 测试 4 (零张量):\n  $$A_4 = \\begin{bmatrix}\n  0.0 & 0.0 & 0.0 \\\\\n  0.0 & 0.0 & 0.0 \\\\\n  0.0 & 0.0 & 0.0\n  \\end{bmatrix}.$$\n\n- 测试 5 (不定对称张量):\n  $$A_5 = \\begin{bmatrix}\n  4.0 & -2.0 & 1.0 \\\\\n  -2.0 & 0.0 & 0.5 \\\\\n  1.0 & 0.5 & -1.0\n  \\end{bmatrix}.$$\n\n您的程序必须为每个测试张量 $A_k$ 按此顺序输出列表 $[E_{\\text{full}}, E_{\\text{group}}, E_{\\text{orth}}, E_{\\text{idem}}]$。将所有五个测试的结果汇总到一个列表中。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素本身是按指定顺序排列的四个浮点数的列表。例如，打印的字符串必须如下所示\n$$[\\,[x_{11},x_{12},x_{13},x_{14}],\\,[x_{21},x_{22},x_{23},x_{24}],\\,\\dots,\\,[x_{51},x_{52},x_{53},x_{54}]\\,].$$\n此问题不涉及单位，也不需要用户输入。", "solution": "我们从有限维内积空间上线性变换的基本陈述开始。一个实对称二阶张量 $A \\in \\mathbb{R}^{3 \\times 3}$ 代表一个线性映射 $A:\\mathbb{R}^3 \\to \\mathbb{R}^3$，对于所有 $x,y \\in \\mathbb{R}^3$ 满足 $x^\\top A y = y^\\top A x$。谱定理指出，这样的 $A$ 存在一组由特征向量构成的标准正交基，且特征值为实数，因此存在实标量 $\\lambda_1,\\lambda_2,\\lambda_3$ 和标准正交向量 $n_1,n_2,n_3$，满足 $A n_i = \\lambda_i n_i$ 和 $n_i^\\top n_j = \\delta_{ij}$。\n\n从这些特征向量，我们定义秩一正交投影算子 $P_i = n_i \\otimes n_i$，即 $(P_i)_{jk} = (n_i)_j (n_i)_k$。它们满足两个关键的代数性质：\n- 幂等性：$P_i^2 = (n_i \\otimes n_i)(n_i \\otimes n_i) = n_i (n_i^\\top n_i) n_i^\\top = n_i \\otimes n_i = P_i$，因为 $n_i$ 是单位范数向量。\n- 对于不同索引的正交性：当 $i \\ne j$ 时，$P_i P_j = (n_i \\otimes n_i)(n_j \\otimes n_j) = n_i (n_i^\\top n_j) n_j^\\top = 0$，因为 $n_i^\\top n_j = 0$。\n\n在三个特征值互不相同的情况下，谱分解可唯一表示为（不计特征向量的符号变化）\n$$\nA = \\sum_{i=1}^{3} \\lambda_i P_i.\n$$\n如果某些特征值重复，重复特征空间内的特征向量不唯一，但投影到该特征空间上的投影算子是唯一的。如果一个簇 $g$ 对应一个重复特征值 $\\lambda$，其特征空间维数为 $|g|$，则任何一组标准正交基 $\\{n_i\\}_{i \\in g}$ 都会产生相同的子空间投影算子 $P_g = \\sum_{i\\in g} P_i$。在精确算术和精确重复的情况下，谱和简化为 $A = \\sum_{g} \\lambda P_g$。在浮点算术中，当特征值在数值上聚集时，检测簇并构造 $P_g$ 作为一个不变子空间投影算子既有意义又具有鲁棒性；簇内一个有效的代表性特征值是 $\\bar{\\lambda}_g = \\frac{1}{|g|}\\sum_{i\\in g}\\lambda_i$。\n\n对于数值实现：\n- 我们使用专门用于实对称张量的例程计算特征对 $(\\lambda_i, n_i)$，确保特征向量是标准正交的（例如，通过使用保证正交性的算法）。\n- 我们对特征值及其特征向量进行一致排序。排序提供了确定性的簇检测。\n- 簇检测由容差参数 $\\tau = a_{\\text{tol}} + r_{\\text{tol}} \\cdot \\max_j |\\lambda_j|$ 指导。这平衡了绝对和相对尺度，因此当 $A$ 很小时，$a_{\\text{tol}}$ 起主导作用；当 $A$ 很大时，阈值会随谱的大小而缩放。此处我们规定 $a_{\\text{tol}} = 10^{-12}$ 和 $r_{\\text{tol}} = 10^{-8}$。\n- 对于每个簇 $g$，我们组装 $P_g = \\sum_{i\\in g} P_i$ 和 $\\bar{\\lambda}_g = \\{\\lambda_i\\}_{i\\in g} \\text{ 的均值}$。\n- 计算两种重构：\n  - 完全重构 $A_{\\text{full}} = \\sum_{i=1}^{3} \\lambda_i P_i$，在精确算术下等于 $A$。\n  - 分簇重构 $A_{\\text{group}} = \\sum_{g} \\bar{\\lambda}_g P_g$，如果所有成簇的特征值都相等，则该重构是精确的；如果它们只是近似相等，则这是一个近似值。\n- 我们评估：\n  1. $E_{\\text{full}} = \\frac{\\| A - A_{\\text{full}} \\|_F}{\\max(\\|A\\|_F, 1)}$，预计处于浮点舍入误差的水平。\n  2. $E_{\\text{group}} = \\frac{\\| A - A_{\\text{group}} \\|_F}{\\max(\\|A\\|_F, 1)}$，当簇是精确的或紧密聚集时，预计该值很小。\n  3. $E_{\\text{orth}} = \\max_{i\\ne j} \\| P_i P_j \\|_F$，应接近于零。\n  4. $E_{\\text{idem}} = \\max_i \\| P_i^2 - P_i \\|_F$，应接近于零。\n\n数值问题及其处理：\n- 聚集特征值下特征向量的敏感性：当 $|\\lambda_{i+1} - \\lambda_i|$ 很小时，与这些特征值相关的特征向量可能是不确定的；任何张成该簇不变子空间的标准正交基都是有效的。对特征值进行分组可以防止将不稳定的特征向量解释为连续介质力学中物理上不同的方向。\n- 投影算子的稳定性：秩一投影算子 $P_i$ 对特征向量的方向敏感，这些方向可能在簇内发生符号翻转或旋转。不变子空间投影算子 $P_g$ 是唯一定义的，并在扰动下表现出更好的数值稳定性。\n- 排序和符号模糊性：特征向量的定义可差一个符号；投影算子 $P_i$ 不受符号翻转的影响，因为 $n_i \\otimes n_i = (-n_i) \\otimes (-n_i)$。排序确保了一致的簇形成。\n- 分簇容差的缩放：使用 $\\tau = a_{\\text{tol}} + r_{\\text{tol}} \\cdot \\max_j |\\lambda_j|$ 平衡了绝对和相对尺度，使得该方法对于零张量和大幅值张量都具有鲁棒性。所选的 $a_{\\text{tol}} = 10^{-12}$ 和 $r_{\\text{tol}} = 10^{-8}$ 对于双精度计算是合理的。\n\n算法设计到代码的映射：\n- 使用对称特征值求解器获得 $(\\lambda, V)$，其中 $V = [n_1, n_2, n_3]$ 是标准正交的，$\\lambda$ 是排序的。\n- 构建 $P_i = n_i n_i^\\top$。\n- 通过使用阈值 $\\tau$ 对相邻的已排序特征值进行单遍扫描来确定簇。\n- 从相应的和构建 $A_{\\text{full}}$ 和 $A_{\\text{group}}$。\n- 计算 Frobenius 范数和四个误差度量。\n- 对五个测试用例重复上述步骤：\n  1. $A_1$ 测试一个通用的、非对角的、良态的、具有不同谱的情况。\n  2. $A_2$ 测试一个近似重复的对，揭示了在小于 $10^{-8}$ 的间隙下簇检测的行为。\n  3. $A_3$ 测试旋转下的精确重复特征值，验证分簇投影算子对于特征空间内基的选择的不变性；角度为 $\\theta = \\pi/6$ 弧度。\n  4. $A_4$ 测试零张量；分母 $\\max(\\|A\\|_F, 1)$ 防止了除以零。\n  5. $A_5$ 测试一个谱中符号混合的不定张量。\n\n程序输出一个单行字符串，表示包含五个内部列表的外部列表，每个内部列表为对应测试用例的 $[E_{\\text{full}}, E_{\\text{group}}, E_{\\text{orth}}, E_{\\text{idem}}]$。此设计遵循所需的输出格式，并确保全面覆盖了材料力学和连续介质力学张量分析中所用对称张量谱分解的相关数值问题。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef spectral_decomposition_with_groups(A, atol=1e-12, rtol=1e-8):\n    \"\"\"\n    Compute spectral decomposition of a real symmetric 3x3 tensor A.\n    Returns:\n        E_full: relative Frobenius error of full reconstruction\n        E_group: relative Frobenius error of grouped reconstruction\n        E_orth: max orthogonality defect among rank-one projectors\n        E_idem: max idempotency defect among rank-one projectors\n    \"\"\"\n    # Ensure symmetry numerically\n    A = 0.5 * (A + A.T)\n\n    # Eigen-decomposition for symmetric matrices: eigh returns eigenvalues in ascending order\n    w, V = np.linalg.eigh(A)\n\n    # Sort explicitly (though eigh returns sorted), keep ascending order\n    idx = np.argsort(w)\n    w = w[idx]\n    V = V[:, idx]\n\n    # Build rank-one projectors P_i = n_i n_i^T\n    projectors = []\n    for i in range(3):\n        ni = V[:, i]\n        Pi = np.outer(ni, ni)\n        projectors.append(Pi)\n\n    # Cluster detection using tolerance tau = atol + rtol * max(|lambda|)\n    max_abs_w = np.max(np.abs(w)) if w.size > 0 else 0.0\n    tau = atol + rtol * max_abs_w\n\n    # Determine clusters as contiguous groups in sorted eigenvalues\n    groups = []\n    if len(w) > 0:\n        current_group = [0]\n        for i in range(1, len(w)):\n            if abs(w[i] - w[i - 1]) = tau:\n                current_group.append(i)\n            else:\n                groups.append(current_group)\n                current_group = [i]\n        groups.append(current_group)\n\n    # Full reconstruction: sum_i lambda_i P_i\n    A_full = np.zeros_like(A)\n    for i in range(3):\n        A_full += w[i] * projectors[i]\n\n    # Grouped reconstruction: sum_g lambda_bar_g P_g\n    A_group = np.zeros_like(A)\n    for g in groups:\n        lam_bar = float(np.mean(w[g]))\n        Pg = np.zeros_like(A)\n        for i in g:\n            Pg += projectors[i]\n        A_group += lam_bar * Pg\n\n    # Norms and error metrics\n    def fro_norm(M):\n        return np.sqrt(np.sum(M * M))\n\n    denom = max(fro_norm(A), 1.0)\n    E_full = fro_norm(A - A_full) / denom\n    E_group = fro_norm(A - A_group) / denom\n\n    # Orthogonality and idempotency defects for rank-one projectors\n    E_orth = 0.0\n    for i in range(3):\n        for j in range(3):\n            if i == j:\n                continue\n            pij = projectors[i] @ projectors[j]\n            E_orth = max(E_orth, fro_norm(pij))\n\n    E_idem = 0.0\n    for i in range(3):\n        Pi = projectors[i]\n        idem_def = fro_norm(Pi @ Pi - Pi)\n        E_idem = max(E_idem, idem_def)\n\n    return E_full, E_group, E_orth, E_idem\n\ndef rotation_z(theta):\n    c = np.cos(theta)\n    s = np.sin(theta)\n    Q = np.array([[c, -s, 0.0],\n                  [s,  c, 0.0],\n                  [0.0, 0.0, 1.0]], dtype=float)\n    return Q\n\ndef solve():\n    # Define the test cases from the problem statement.\n\n    # Test 1: distinct eigenvalues, off-diagonal couplings\n    A1 = np.array([\n        [2.0, 0.3, 0.0],\n        [0.3, 1.0, 0.1],\n        [0.0, 0.1, 0.5]\n    ], dtype=float)\n\n    # Test 2: nearly repeated eigenvalues on the diagonal\n    A2 = np.diag([1.0, 1.0 + 1e-8, 2.0]).astype(float)\n\n    # Test 3: exactly repeated eigenvalues in a rotated frame, theta = pi/6 radians\n    theta = np.pi / 6.0\n    Q = rotation_z(theta)\n    D = np.diag([3.0, 3.0, 1.0]).astype(float)\n    A3 = Q @ D @ Q.T\n\n    # Test 4: zero tensor\n    A4 = np.zeros((3, 3), dtype=float)\n\n    # Test 5: indefinite symmetric tensor\n    A5 = np.array([\n        [4.0, -2.0, 1.0],\n        [-2.0, 0.0, 0.5],\n        [1.0, 0.5, -1.0]\n    ], dtype=float)\n\n    test_cases = [A1, A2, A3, A4, A5]\n\n    results = []\n    for A in test_cases:\n        # Check for the empty case A4 to avoid issues with groups logic if not handled.\n        if A.shape[0] == 0:\n            results.append([0.0, 0.0, 0.0, 0.0])\n            continue\n        E_full, E_group, E_orth, E_idem = spectral_decomposition_with_groups(A, atol=1e-12, rtol=1e-8)\n        results.append([E_full, E_group, E_orth, E_idem])\n\n    # Final print statement in the exact required format.\n    # Single line: list of lists with floats\n    # Ensure default Python formatting with commas and brackets.\n    print(str(results))\n\nsolve()\n```", "id": "2922080"}]}