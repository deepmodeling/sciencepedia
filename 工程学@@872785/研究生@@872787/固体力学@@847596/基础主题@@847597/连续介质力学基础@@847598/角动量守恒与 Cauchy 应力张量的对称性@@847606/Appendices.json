{"hands_on_practices": [{"introduction": "本节的第一个练习将带领我们从一个基础的二维剪切流问题入手。通过这个练习 ([@problem_id:2616470])，我们将把运动学、本构关系（牛顿流体）和动量守恒定律联系起来，一步步推导出应力张量的具体形式。这个过程不仅能让我们验证柯西应力张量 $\\boldsymbol{\\sigma}$ 的对称性，还能加深我们对连续介质力学基本原理实际应用的理解。", "problem": "考虑一个具有恒定动力粘度 $\\mu$ 和恒定密度 $\\rho$ 的不可压缩牛顿连续介质中的稳态二维简单剪切流。在笛卡尔坐标系 $(x,y,z)$ 中，速度场由 $\\mathbf{v}(x,y,z) = (\\gamma\\,y,\\,0,\\,0)$ 给出，其中 $\\gamma$ 是一个恒定的剪切率。不存在体力或体力偶。\n\n从线性动量守恒（柯西方程）和角动量守恒出发，结合不可压缩材料的牛顿本构关系，确定柯西应力张量场 $\\boldsymbol{\\sigma}(x,y,z)$。将机械压力 $p$ 视为与不可压缩性相关的拉格朗日乘子。具体要求如下：\n- 利用给定流动的运动学计算变形率张量。\n- 利用线性动量守恒确定此流动中 $p$ 的空间限制。\n- 利用角动量守恒来论证 $\\boldsymbol{\\sigma}$ 的对称性，并验证本构预测符合此对称性。\n\n将最终答案表示为柯西应力张量 $\\boldsymbol{\\sigma}(x,y,z)$ 的 $3\\times 3$ 矩阵，用 $\\mu$、$\\gamma$ 和一个恒定压力 $p_0$ 表示。不需要进行数值计算或四舍五入。无需报告单位；仅提供符号表达式。", "solution": "该问题是连续介质力学（特别是在流体动力学领域）中的一个标准练习。它具有科学依据，问题明确且客观。所有必要信息都已提供，没有内部矛盾或逻辑缺陷。该问题是有效的。我们开始求解。\n\n分析从指定流动的运动学开始。在笛卡尔坐标系 $(x,y,z)$ 中，速度场为 $\\mathbf{v} = (\\gamma y, 0, 0)$，其分量为 $v_x = \\gamma y$，$v_y = 0$ 和 $v_z = 0$。常数 $\\gamma$ 是剪切率。材料被规定为不可压缩的。我们首先验证给定的速度场是否满足不可压缩性条件，其局部形式为 $\\nabla \\cdot \\mathbf{v} = 0$。\n$$\n\\nabla \\cdot \\mathbf{v} = \\frac{\\partial v_x}{\\partial x} + \\frac{\\partial v_y}{\\partial y} + \\frac{\\partial v_z}{\\partial z} = \\frac{\\partial(\\gamma y)}{\\partial x} + \\frac{\\partial(0)}{\\partial y} + \\frac{\\partial(0)}{\\partial z} = 0 + 0 + 0 = 0\n$$\n该条件得到满足。\n\n第一个任务是计算变形率张量 $\\mathbf{D}$。该张量定义为速度梯度张量 $\\mathbf{L}$ 的对称部分，其中 $L_{ij} = \\frac{\\partial v_i}{\\partial x_j}$。首先，我们计算 $\\mathbf{L}$：\n$$\nL_{11} = \\frac{\\partial v_x}{\\partial x} = 0, \\quad L_{12} = \\frac{\\partial v_x}{\\partial y} = \\gamma, \\quad L_{13} = \\frac{\\partial v_x}{\\partial z} = 0\n$$\n$$\nL_{21} = \\frac{\\partial v_y}{\\partial x} = 0, \\quad L_{22} = \\frac{\\partial v_y}{\\partial y} = 0, \\quad L_{23} = \\frac{\\partial v_y}{\\partial z} = 0\n$$\n$$\nL_{31} = \\frac{\\partial v_z}{\\partial x} = 0, \\quad L_{32} = \\frac{\\partial v_z}{\\partial y} = 0, \\quad L_{33} = \\frac{\\partial v_z}{\\partial z} = 0\n$$\n速度梯度张量的矩阵形式为：\n$$\n\\mathbf{L} = \\begin{pmatrix} 0  \\gamma  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n变形率张量 $\\mathbf{D}$ 由 $\\mathbf{D} = \\frac{1}{2}(\\mathbf{L} + \\mathbf{L}^T)$ 给出。\n$$\n\\mathbf{D} = \\frac{1}{2} \\left[ \\begin{pmatrix} 0  \\gamma  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} + \\begin{pmatrix} 0  0  0 \\\\ \\gamma  0  0 \\\\ 0  0  0 \\end{pmatrix} \\right] = \\frac{1}{2} \\begin{pmatrix} 0  \\gamma  0 \\\\ \\gamma  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n\n接下来，我们处理线性动量守恒，它由柯西第一运动定律给出：$\\rho \\frac{D\\mathbf{v}}{Dt} = \\nabla \\cdot \\boldsymbol{\\sigma} + \\rho\\mathbf{b}$。这里，$\\rho$ 是恒定密度，$\\frac{D\\mathbf{v}}{Dt}$ 是速度的物质导数（加速度），$\\boldsymbol{\\sigma}$ 是柯西应力张量，$\\mathbf{b}$ 是单位质量的体力。问题指明没有体力，所以 $\\mathbf{b} = \\mathbf{0}$。加速度项为 $\\frac{D\\mathbf{v}}{Dt} = \\frac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v} \\cdot \\nabla)\\mathbf{v}$。流动是稳态的，所以 $\\frac{\\partial \\mathbf{v}}{\\partial t} = \\mathbf{0}$。对流加速度为：\n$$\n(\\mathbf{v} \\cdot \\nabla)\\mathbf{v} = \\left(v_x\\frac{\\partial}{\\partial x} + v_y\\frac{\\partial}{\\partial y} + v_z\\frac{\\partial}{\\partial z}\\right)\\mathbf{v} = \\left((\\gamma y)\\frac{\\partial}{\\partial x} + (0)\\frac{\\partial}{\\partial y} + (0)\\frac{\\partial}{\\partial z}\\right)(\\gamma y \\mathbf{e}_x) = \\gamma y \\frac{\\partial(\\gamma y \\mathbf{e}_x)}{\\partial x} = \\mathbf{0}\n$$\n由于加速度为零，动量方程简化为 $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$。\n\n对于不可压缩的牛顿流体，应力张量的本构关系为 $\\boldsymbol{\\sigma} = -p\\mathbf{I} + 2\\mu\\mathbf{D}$，其中 $p$ 是机械压力，$\\mathbf{I}$ 是单位张量，$\\mu$ 是动力粘度。代入推导出的 $\\mathbf{D}$ 的表达式：\n$$\n\\boldsymbol{\\sigma} = -p\\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} + 2\\mu \\left( \\frac{1}{2} \\begin{pmatrix} 0  \\gamma  0 \\\\ \\gamma  0  0 \\\\ 0  0  0 \\end{pmatrix} \\right) = \\begin{pmatrix} -p  \\mu\\gamma  0 \\\\ \\mu\\gamma  -p  0 \\\\ 0  0  -p \\end{pmatrix}\n$$\n现在我们应用动量守恒条件 $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$。用分量形式表示：\n$x$ 分量：$\\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{yx}}{\\partial y} + \\frac{\\partial \\sigma_{zx}}{\\partial z} = \\frac{\\partial(-p)}{\\partial x} + \\frac{\\partial(\\mu\\gamma)}{\\partial y} + \\frac{\\partial(0)}{\\partial z} = 0$。由于 $\\mu$ 和 $\\gamma$ 是常数，这简化为 $-\\frac{\\partial p}{\\partial x} = 0$。\n$y$ 分量：$\\frac{\\partial \\sigma_{xy}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y} + \\frac{\\partial \\sigma_{zy}}{\\partial z} = \\frac{\\partial(\\mu\\gamma)}{\\partial x} + \\frac{\\partial(-p)}{\\partial y} + \\frac{\\partial(0)}{\\partial z} = 0$。这简化为 $-\\frac{\\partial p}{\\partial y} = 0$。\n$z$ 分量：$\\frac{\\partial \\sigma_{xz}}{\\partial x} + \\frac{\\partial \\sigma_{yz}}{\\partial y} + \\frac{\\partial \\sigma_{zz}}{\\partial z} = \\frac{\\partial(0)}{\\partial x} + \\frac{\\partial(0)}{\\partial y} + \\frac{\\partial(-p)}{\\partial z} = 0$。这简化为 $-\\frac{\\partial p}{\\partial z} = 0$。\n条件 $\\frac{\\partial p}{\\partial x} = 0$、$\\frac{\\partial p}{\\partial y} = 0$ 和 $\\frac{\\partial p}{\\partial z} = 0$ 共同意味着压力 $p$ 必须在空间上是恒定的。我们将这个恒定压力记为 $p_0$。\n\n问题的第三部分涉及角动量守恒和应力张量的对称性。在没有体力偶和内力偶应力（经典连续介质的情况就是如此）的情况下，角动量守恒的局部形式简化为柯西应力张量必须是对称的条件。这就是柯西第二运动定律：$\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^T$。\n这个基本原理要求对于所有的 $i,j$ 都有 $\\sigma_{ij} = \\sigma_{ji}$。特别是 $\\sigma_{xy} = \\sigma_{yx}$，$\\sigma_{xz} = \\sigma_{zx}$ 和 $\\sigma_{yz} = \\sigma_{zy}$。\n我们必须验证不可压缩牛顿流体的本构关系是否符合这种对称性。所提出的应力张量是 $\\boldsymbol{\\sigma} = -p\\mathbf{I} + 2\\mu\\mathbf{D}$。项 $-p\\mathbf{I}$ 是一个对角矩阵，其本身就是对称的。项 $2\\mu\\mathbf{D}$ 是变形率张量 $\\mathbf{D}$ 的标量倍数。根据其定义 $\\mathbf{D} = \\frac{1}{2}(\\mathbf{L} + \\mathbf{L}^T)$，张量 $\\mathbf{D}$ 是对称的。两个对称张量之和也是一个对称张量。因此，本构模型 $\\boldsymbol{\\sigma} = -p\\mathbf{I} + 2\\mu\\mathbf{D}$ 总能得到一个对称的应力张量，这完全符合角动量守恒原理。\n\n最后，我们构建显式的柯西应力张量场 $\\boldsymbol{\\sigma}(x,y,z)$。使用 $\\boldsymbol{\\sigma}$ 的表达式以及 $p$ 是一个常数 $p_0$ 的结论：\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} -p_0  \\mu\\gamma  0 \\\\ \\mu\\gamma  -p_0  0 \\\\ 0  0  -p_0 \\end{pmatrix}\n$$\n这就是应力张量场的完整且最终的表达式，结果表明它在空间上是均匀的。", "answer": "$$\n\\boxed{\\begin{pmatrix} -p_0  \\mu\\gamma  0 \\\\ \\mu\\gamma  -p_0  0 \\\\ 0  0  -p_0 \\end{pmatrix}}\n$$", "id": "2616470"}, {"introduction": "在掌握了小变形理论后，我们进一步探讨更具挑战性的有限变形问题。这个练习 ([@problem_id:2616480]) 要求我们推导并应用不同应力张量（第二类Piola-Kirchhoff应力 $\\mathbf{S}$ 和柯西应力 $\\boldsymbol{\\sigma}$）之间的转换关系。它清晰地揭示了，在有限变形理论中，柯西应力张量的对称性是如何通过对称的第二类Piola-Kirchhoff应力张量和变形梯度得以保证的，这直接体现了材料本构关系的客观性原理。", "problem": "固体的均匀有限变形由一个从参考构型到当前构型的光滑双射 $\\boldsymbol{\\chi} : \\mathbf{X} \\mapsto \\mathbf{x}$ 描述，其变形梯度为 $\\mathbf{F} = \\nabla_{\\! \\mathbf{X}} \\boldsymbol{\\chi}$，雅可比行列式为 $J = \\det \\mathbf{F}$。在没有体力矩和面力矩的情况下，内力矩仅由柯西应力张量 $\\boldsymbol{\\sigma}$ 产生。第二类 Piola-Kirchhoff (SPK) 应力 $\\mathbf{S}$ 在参考构型中定义为与 Green-Lagrange 应变能量共轭的应力量度，而第一类 Piola-Kirchhoff 应力 $\\mathbf{P}$ 的定义使得 $\\mathbf{P}\\mathbf{N}$ 给出单位参考面积上的面力。\n\n1) 仅从基本原理（柯西牵引力定律、Nanson 面积映射关系、$\\mathbf{P}$ 的定义，以及在没有力偶应力从而角动量守恒以其经典形式成立的条件下）出发，推导将柯西应力 $\\boldsymbol{\\sigma}$ 表示为变形梯度 $\\mathbf{F}$、雅可比行列式 $J$ 和第二类 Piola-Kirchhoff 应力 $\\mathbf{S}$ 的本构变换关系。\n\n2) 考虑以下特定的均匀变形\n$$\n\\begin{aligned}\nx_{1} = 1.1\\,X_{1} + 0.2\\,X_{2},\\\\\nx_{2} = 0.3\\,X_{1} + 0.9\\,X_{2} + 0.1\\,X_{3},\\\\\nx_{3} = 0.05\\,X_{1} + 0.2\\,X_{2} + 1.2\\,X_{3},\n\\end{aligned}\n$$\n其中 $\\mathbf{F}$ 在空间上是常数。设对称的第二类 Piola-Kirchhoff 应力为\n$$\n\\mathbf{S} = \\begin{pmatrix}\n12  3  4\\\\\n3  10  5\\\\\n4  5  8\n\\end{pmatrix} \\text{ MPa}.\n$$\n计算 $\\mathbf{F}$ 和 $J$，然后根据第 (1) 部分的结果计算相应的柯西应力 $\\boldsymbol{\\sigma}$。\n\n3) 定义张量 $\\mathbf{A}$ 的反对称部分为 $\\operatorname{skw}\\mathbf{A} = \\tfrac{1}{2}(\\mathbf{A} - \\mathbf{A}^{T})$。使用您计算出的 $\\boldsymbol{\\sigma}$，通过计算 Frobenius 范数 $\\|\\operatorname{skw}\\boldsymbol{\\sigma}\\|_{F}$ 来数值验证角动量守恒所蕴含的对称性。\n\n将最终答案表示为单个实数 $\\|\\operatorname{skw}\\boldsymbol{\\sigma}\\|_{F}$，单位为兆帕（MPa）。如果需要四舍五入，请将最终数值保留四位有效数字。如果不需要四舍五入，请报告精确值。", "solution": "所述问题具有科学依据，提法恰当，客观且内部一致，包含了求解所需的所有信息。这是有限变形连续介质力学中的一个标准问题。验证通过，我将开始解答。\n\n问题包含三个部分。第一，推导柯西应力张量 $\\boldsymbol{\\sigma}$ 与第二类 Piola-Kirchhoff (SPK) 应力张量 $\\mathbf{S}$ 之间的关系。第二，对给定的变形和 $\\mathbf{S}$ 进行 $\\boldsymbol{\\sigma}$ 的数值计算。第三，验证所得 $\\boldsymbol{\\sigma}$ 的对称性。\n\n第 $1$ 部分：应力变换的推导\n\n我们从规定的基本原理出发。设 $d\\mathbf{f}$ 是作用在面积元上的无穷小力矢量。这个力是标架无关的，因此无论是在参考构型（体积 $V_0$，表面积 $A_0$）还是当前构型（体积 $V$，表面积 $A$）中观察，其值都相同。\n\n在当前构型中，面力矢量 $\\mathbf{t}$（单位当前面积上的力）通过柯西牵引力定律与柯西应力 $\\boldsymbol{\\sigma}$ 相关联：\n$$d\\mathbf{f} = \\mathbf{t} \\, da = (\\boldsymbol{\\sigma}\\mathbf{n}) \\, da$$\n其中 $\\mathbf{n}$ 是当前构型中面积元 $da$ 的单位法向量。\n\n在参考构型中，名义面力矢量 $\\mathbf{T}$（单位参考面积上的力）通过其定义与第一类 Piola-Kirchhoff (PK$1$) 应力张量 $\\mathbf{P}$ 相关联：\n$$d\\mathbf{f} = \\mathbf{T} \\, dA = (\\mathbf{P}\\mathbf{N}) \\, dA$$\n其中 $\\mathbf{N}$ 是参考构型中面积元 $dA$ 的单位法向量。\n\n令 $d\\mathbf{f}$ 的两个表达式相等，可得：\n$$(\\boldsymbol{\\sigma}\\mathbf{n}) \\, da = (\\mathbf{P}\\mathbf{N}) \\, dA$$\n当前构型和参考构型中面积元之间的关系由 Nanson 公式给出：\n$$\\mathbf{n} \\, da = J \\mathbf{F}^{-T} \\mathbf{N} \\, dA$$\n其中 $\\mathbf{F}$ 是变形梯度，$J = \\det(\\mathbf{F})$ 是其行列式，$\\mathbf{F}^{-T}$ 是 $\\mathbf{F}$ 的逆转置。将 Nanson 公式代入力平衡方程，得到：\n$$\\boldsymbol{\\sigma} (J \\mathbf{F}^{-T} \\mathbf{N} \\, dA) = (\\mathbf{P}\\mathbf{N}) \\, dA$$\n由于该等式必须对任何具有法向量 $\\mathbf{N}$ 的任意面积元 $dA$ 都成立，我们可以令作用于 $\\mathbf{N}$ 的张量算子相等：\n$$J \\boldsymbol{\\sigma} \\mathbf{F}^{-T} = \\mathbf{P}$$\n求解柯西应力 $\\boldsymbol{\\sigma}$，我们得到它与 PK$1$ 应力 $\\mathbf{P}$ 的关系：\n$$\\boldsymbol{\\sigma} = \\frac{1}{J} \\mathbf{P} \\mathbf{F}^T$$\n这个关系被称为 PK$1$ 应力的前推变换。\n\n接下来，我们引入第二类 Piola-Kirchhoff (SPK) 应力张量 $\\mathbf{S}$。PK$1$ 和 SPK 张量通过拉回操作相关联：\n$$\\mathbf{P} = \\mathbf{F} \\mathbf{S}$$\n将 $\\mathbf{P}$ 的这个定义代入 $\\boldsymbol{\\sigma}$ 的表达式，得到所需的变换关系：\n$$\\boldsymbol{\\sigma} = \\frac{1}{J} (\\mathbf{F}\\mathbf{S}) \\mathbf{F}^T$$\n这就是将柯西应力 $\\boldsymbol{\\sigma}$ 表示为 $\\mathbf{F}$、$J$ 和 $\\mathbf{S}$ 的本构变换。\n\n问题指出，在没有力偶应力的情况下，角动量守恒意味着柯西应力张量的对称性，即 $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^T$。我们来检验这一点。$\\boldsymbol{\\sigma}$ 的转置是：\n$$\\boldsymbol{\\sigma}^T = \\left(\\frac{1}{J} \\mathbf{F} \\mathbf{S} \\mathbf{F}^T\\right)^T = \\frac{1}{J} (\\mathbf{F}^T)^T \\mathbf{S}^T \\mathbf{F}^T = \\frac{1}{J} \\mathbf{F} \\mathbf{S}^T \\mathbf{F}^T$$\n要使 $\\boldsymbol{\\sigma}$ 对称，必须有 $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^T$，这意味着 $\\mathbf{F} \\mathbf{S} \\mathbf{F}^T = \\mathbf{F} \\mathbf{S}^T \\mathbf{F}^T$。由于 $\\mathbf{F}$ 是可逆的，这等价于 $\\mathbf{S} = \\mathbf{S}^T$。因此，柯西应力的对称性取决于 SPK 应力的对称性，我们将在第 $3$ 部分使用这一事实。\n\n第 $2$ 部分：数值计算\n\n给定的均匀变形为：\n$$\n\\begin{aligned}\nx_{1} = 1.1\\,X_{1} + 0.2\\,X_{2} + 0\\,X_{3}\\\\\nx_{2} = 0.3\\,X_{1} + 0.9\\,X_{2} + 0.1\\,X_{3}\\\\\nx_{3} = 0.05\\,X_{1} + 0.2\\,X_{2} + 1.2\\,X_{3}\n\\end{aligned}\n$$\n变形梯度 $\\mathbf{F}$ 的分量为 $F_{ij} = \\frac{\\partial x_i}{\\partial X_j}$。我们计算其矩阵表示：\n$$\n\\mathbf{F} = \\begin{pmatrix}\n1.1  0.2  0 \\\\\n0.3  0.9  0.1 \\\\\n0.05  0.2  1.2\n\\end{pmatrix}\n$$\n雅可比行列式 $J$ 是 $\\mathbf{F}$ 的行列式：\n$$J = \\det(\\mathbf{F}) = 1.1(0.9 \\times 1.2 - 0.1 \\times 0.2) - 0.2(0.3 \\times 1.2 - 0.1 \\times 0.05) + 0$$\n$$J = 1.1(1.08 - 0.02) - 0.2(0.36 - 0.005) = 1.1(1.06) - 0.2(0.355) = 1.166 - 0.071 = 1.095$$\n给定的 SPK 应力张量 $\\mathbf{S}$ 是对称的：\n$$\n\\mathbf{S} = \\begin{pmatrix}\n12  3  4\\\\\n3  10  5\\\\\n4  5  8\n\\end{pmatrix} \\text{ MPa}\n$$\n我们现在计算乘积 $\\boldsymbol{\\Sigma}_u = \\mathbf{F} \\mathbf{S} \\mathbf{F}^T$。首先，我们计算 $\\mathbf{F} \\mathbf{S}$：\n$$\n\\mathbf{F}\\mathbf{S} = \\begin{pmatrix}\n1.1  0.2  0 \\\\\n0.3  0.9  0.1 \\\\\n0.05  0.2  1.2\n\\end{pmatrix} \\begin{pmatrix}\n12  3  4\\\\\n3  10  5\\\\\n4  5  8\n\\end{pmatrix} = \\begin{pmatrix}\n13.8  5.3  5.4 \\\\\n6.7  10.4  6.5 \\\\\n6.0  8.15  10.8\n\\end{pmatrix}\n$$\n接下来，我们右乘 $\\mathbf{F}^T$：\n$$\n\\boldsymbol{\\Sigma}_u = (\\mathbf{F}\\mathbf{S})\\mathbf{F}^T = \\begin{pmatrix}\n13.8  5.3  5.4 \\\\\n6.7  10.4  6.5 \\\\\n6.0  8.15  10.8\n\\end{pmatrix} \\begin{pmatrix}\n1.1  0.3  0.05 \\\\\n0.2  0.9  0.2 \\\\\n0  0.1  1.2\n\\end{pmatrix}\n$$\n$$\n\\boldsymbol{\\Sigma}_u = \\begin{pmatrix}\n16.24  9.45  8.23 \\\\\n9.45  12.02  10.215 \\\\\n8.23  10.215  14.89\n\\end{pmatrix}\n$$\n正如在第 $1$ 部分所证明的，由于 $\\mathbf{S}$ 是对称的，所得矩阵 $\\mathbf{F} \\mathbf{S} \\mathbf{F}^T$ 也是对称的。我们的计算证实了这一点。这些值是精确的。\n\n最后，我们计算柯西应力 $\\boldsymbol{\\sigma} = J^{-1} \\boldsymbol{\\Sigma}_u$：\n$$\n\\boldsymbol{\\sigma} = \\frac{1}{1.095} \\begin{pmatrix}\n16.24  9.45  8.23 \\\\\n9.45  12.02  10.215 \\\\\n8.23  10.215  14.89\n\\end{pmatrix} \\text{ MPa}\n$$\n这就是相应的柯西应力张量。\n\n第 $3$ 部分：对称性验证\n\n题目要求我们通过计算其反对称部分的 Frobenius 范数 $\\|\\operatorname{skw}\\boldsymbol{\\sigma}\\|_{F}$ 来验证 $\\boldsymbol{\\sigma}$ 的对称性。张量 $\\mathbf{A}$ 的反对称部分定义为 $\\operatorname{skw}\\mathbf{A} = \\frac{1}{2}(\\mathbf{A} - \\mathbf{A}^{T})$。\n\n根据第 $1$ 部分的推导和第 $2$ 部分的数值计算，我们已经证明，如果 $\\mathbf{S}$ 是对称的，那么矩阵 $\\boldsymbol{\\Sigma}_u = \\mathbf{F} \\mathbf{S} \\mathbf{F}^T$ 也是对称的。即 $\\boldsymbol{\\Sigma}_u = \\boldsymbol{\\Sigma}_u^T$。\n柯西应力为 $\\boldsymbol{\\sigma} = J^{-1} \\boldsymbol{\\Sigma}_u$。其转置为 $\\boldsymbol{\\sigma}^T = (J^{-1} \\boldsymbol{\\Sigma}_u)^T = J^{-1} \\boldsymbol{\\Sigma}_u^T$。\n由于 $\\boldsymbol{\\Sigma}_u = \\boldsymbol{\\Sigma}_u^T$，必然得出 $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^T$。柯西应力张量的精确对称性是该理论的代数推论，而非偶然的数值结果。\n\n因此，$\\boldsymbol{\\sigma}$ 的反对称部分是：\n$$\\operatorname{skw}\\boldsymbol{\\sigma} = \\frac{1}{2}(\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^T) = \\frac{1}{2}(\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}) = \\mathbf{0}$$\n其中 $\\mathbf{0}$ 是零张量。\n\n矩阵 $\\mathbf{A}$ 的 Frobenius 范数由 $\\|\\mathbf{A}\\|_{F} = \\sqrt{\\sum_{i,j} A_{ij}^2}$ 给出。对于零张量，其范数为：\n$$\\|\\operatorname{skw}\\boldsymbol{\\sigma}\\|_{F} = \\|\\mathbf{0}\\|_{F} = \\sqrt{0^2 + 0^2 + \\dots + 0^2} = 0$$\n该值恒等于零。无需四舍五入。结果以兆帕（MPa）表示，与应力张量的单位一致。", "answer": "$$\\boxed{0}$$", "id": "2616480"}, {"introduction": "理论的正确性最终需要在数值计算中得到保证，尤其是在复杂的工程应用中。最后一个练习 ([@problem_id:2616496]) 将我们带入计算力学的实践领域，要求我们设计一套基准测试来验证数值算法的客观性。通过这个编码实践，我们可以检验一个有限元程序是否能在纯刚体转动下正确地保持应力为零（或保持对称性），从而确保其计算结果符合角动量守恒这一基本物理定律。", "problem": "需要一个有限元基准来验证计算固体力学程序在纯刚体旋转下是否遵循角动量守恒和柯西应力响应的客观性（框架无关性）。目标是编写测试程序，以检测柯西应力张量的任何伪斜对称分量。所有角度应以弧度为单位，所有长度以米为单位，时间以秒为单位，应力以帕斯卡为单位。\n\n出发点和基本依据：仅使用以下基本原理。\n- 柯西牵引力由 $\\boldsymbol{t} = \\boldsymbol{\\sigma} \\boldsymbol{n}$ 给出，其中 $\\boldsymbol{\\sigma}$ 是柯西应力张量，$\\boldsymbol{n}$ 是单位法向量。\n- 在没有惯性力的情况下，线动量守恒为 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$，其中 $\\boldsymbol{b}$ 是单位体积的体力。\n- 角动量守恒（无体力偶）意味着柯西应力的对称性，即 $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathsf{T}}$。\n- 刚体运动的变形梯度为 $\\boldsymbol{F} = \\boldsymbol{R}$，其中 $\\boldsymbol{R} \\in \\mathrm{SO}(3)$，因此右柯西-格林张量 $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F} = \\boldsymbol{I}$，格林-拉格朗日应变为 $\\boldsymbol{E} = \\boldsymbol{0}$。任何客观的本构更新在材料为弹性且初始无应力时，都不能因刚体旋转而产生应力。\n- 一个客观的共旋应力率，如柯西应力的 Jaumann 率，定义为 $\\overset{\\triangledown}{\\boldsymbol{\\sigma}} = \\dot{\\boldsymbol{\\sigma}} - \\boldsymbol{W} \\boldsymbol{\\sigma} + \\boldsymbol{\\sigma} \\boldsymbol{W}$，其中 $\\boldsymbol{W} = \\tfrac{1}{2}(\\nabla \\boldsymbol{v} - \\nabla \\boldsymbol{v}^{\\mathsf{T}})$ 是自旋张量。在具有恒定角速度矢量 $\\boldsymbol{\\omega}$ 的刚体旋转下，有 $\\nabla \\boldsymbol{v} = \\boldsymbol{\\Omega}$，其中 $\\boldsymbol{\\Omega}$ 是与 $\\boldsymbol{\\omega}$ 相关的斜对称张量，且 $\\boldsymbol{W} = \\boldsymbol{\\Omega}$。\n\n要编码的问题任务：\n1) 以编程方式推导角动量守恒所隐含的基准条件：对于任何没有体力偶的容许运动，柯西应力的斜对称部分必须消失，即 $\\mathrm{skew}(\\boldsymbol{\\sigma}) := \\tfrac{1}{2}(\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\mathsf{T}}) = \\boldsymbol{0}$。在数值验证中，如果 $\\|\\mathrm{skew}(\\boldsymbol{\\sigma})\\|_{\\mathrm{F}} \\le \\tau$，则声明测试通过，其中 $\\|\\cdot\\|_{\\mathrm{F}}$ 是 Frobenius 范数，$\\tau$ 是下面将指定的容差。\n2) 在二维和三维中实现刚体旋转：\n   - 在二维中，对于给定角度 $\\theta$，$\\boldsymbol{R}(\\theta) = \\begin{bmatrix}\\cos\\theta  -\\sin\\theta\\\\ \\sin\\theta  \\cos\\theta\\end{bmatrix}$。\n   - 在三维中，使用轴-角 $(\\widehat{\\boldsymbol{a}}, \\theta)$ 的 Rodrigues 公式，其中 $\\widehat{\\boldsymbol{a}}$ 是单位轴，$\\theta$ 是角度，来计算 $\\boldsymbol{R} \\in \\mathrm{SO}(3)$。\n3) 使用精确的乘法共旋更新 $\\boldsymbol{\\sigma}(t+\\Delta t) = \\boldsymbol{R}(\\Delta t)\\,\\boldsymbol{\\sigma}(t)\\,\\boldsymbol{R}(\\Delta t)^{\\mathsf{T}}$，实现在纯自旋下的柯西应力客观更新，其中 $\\boldsymbol{R}(\\Delta t) = \\exp(\\boldsymbol{\\Omega}\\Delta t)$，$\\boldsymbol{\\Omega}$ 是从 $\\boldsymbol{\\omega}$ 构建的斜对称张量。\n4) 实现一个故意的非客观、破坏对称性的更新 $\\boldsymbol{\\sigma}(t+\\Delta t) = \\boldsymbol{\\sigma}(t) + \\Delta t\\,\\boldsymbol{\\Omega}\\,\\boldsymbol{\\sigma}(t)$（缺少了必要的右乘操作），以演示如何检测伪斜对称分量。\n5) 在二维中实现一个单常应变三角形单元，用于平面内的小刚体旋转。使用线性形函数，根据由平面外轴的小角度刚体旋转引起的节点位移，计算位移梯度 $\\nabla \\boldsymbol{u}$。形成小应变张量 $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}})$ 和一个各向同性线弹性本构模型 $\\boldsymbol{\\sigma} = \\lambda\\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})\\,\\boldsymbol{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}$，其中拉梅参数为 $\\lambda$ 和 $\\mu$。在纯刚体旋转下，$\\boldsymbol{\\varepsilon} = \\boldsymbol{0}$，因此 $\\boldsymbol{\\sigma} = \\boldsymbol{0}$；检查简化为验证零斜对称应力。\n\n使用以下测试套件。在所有情况下，报告一个布尔值，当且仅当计算出的柯西应力斜对称部分的 Frobenius 范数小于或等于容差 $\\tau = 10^{-9}\\max\\{1,\\|\\boldsymbol{\\sigma}\\|_{\\mathrm{F}}\\}$ 时，该值为真。\n- 测试 A（二维旋转初始对称应力）：设 $\\theta = 0.7$，初始应力为 $\\boldsymbol{\\sigma}_0^{(2\\mathrm{D})} = \\begin{bmatrix}1.2\\times 10^8  3.1\\times 10^7 \\\\ 3.1\\times 10^7  8.8\\times 10^7 \\end{bmatrix}$。计算 $\\boldsymbol{\\sigma} = \\boldsymbol{R}(\\theta)\\,\\boldsymbol{\\sigma}_0^{(2\\mathrm{D})}\\,\\boldsymbol{R}(\\theta)^{\\mathsf{T}}$ 并测试零斜对称性。\n- 测试 B（三维旋转初始对称应力）：设轴为 $\\boldsymbol{a} = \\begin{bmatrix}0.3 \\\\ -0.4 \\\\ 0.8660254\\end{bmatrix}$，角度为 $\\theta = 1.1$，初始应力为 $\\boldsymbol{\\sigma}_0^{(3\\mathrm{D})} = \\begin{bmatrix}5\\times 10^6  -2\\times 10^6  1\\times 10^6 \\\\ -2\\times 10^6  4\\times 10^6  0.5\\times 10^6 \\\\ 1\\times 10^6  0.5\\times 10^6  6\\times 10^6\\end{bmatrix}$。计算 $\\boldsymbol{\\sigma} = \\boldsymbol{R}\\,\\boldsymbol{\\sigma}_0^{(3\\mathrm{D})}\\,\\boldsymbol{R}^{\\mathsf{T}}$ 并测试零斜对称性。\n- 测试 C（纯刚体旋转下的客观 Jaumann 共旋更新）：设 $\\boldsymbol{\\omega} = \\begin{bmatrix}10.0 \\\\ -5.0 \\\\ 3.0\\end{bmatrix}$，总时间 $T = 0.2$，步数 $N = 4000$，初始应力 $\\boldsymbol{\\sigma}_0^{(3\\mathrm{D})}$ 与测试 B 中相同。设 $\\Delta t = T/N$，通过 $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{R}(\\Delta t)\\,\\boldsymbol{\\sigma}_n\\,\\boldsymbol{R}(\\Delta t)^{\\mathsf{T}}$ 进行更新，其中 $\\boldsymbol{R}(\\Delta t) = \\exp(\\boldsymbol{\\Omega}\\Delta t)$，$\\boldsymbol{\\Omega}$ 是 $\\boldsymbol{\\omega}$ 的斜对称张量。测试最终的 $\\boldsymbol{\\sigma}_N$ 是否具有零斜对称性。\n- 测试 D（非客观、破坏对称性的更新）：使用与测试 C 相同的 $\\boldsymbol{\\omega}$、$T$、$N$ 和初始 $\\boldsymbol{\\sigma}_0^{(3\\mathrm{D})}$，但通过 $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_n + \\Delta t\\,\\boldsymbol{\\Omega}\\,\\boldsymbol{\\sigma}_n$ 进行更新。该算法不是客观的，应该会产生一个非零的斜对称部分；测试应返回 false。\n- 测试 E（小刚体旋转下的单常应变三角形单元）：设节点为 $\\boldsymbol{x}_1 = \\begin{bmatrix}0 \\\\ 0\\end{bmatrix}$、$\\boldsymbol{x}_2 = \\begin{bmatrix}1 \\\\ 0\\end{bmatrix}$、$\\boldsymbol{x}_3 = \\begin{bmatrix}0 \\\\ 1\\end{bmatrix}$，角速度 $\\omega_z = 100.0$，时间步长 $\\Delta t = 10^{-8}$。通过 $\\boldsymbol{u}_i = \\Delta t\\,\\omega_z\\,\\begin{bmatrix}-y_i \\\\ x_i\\end{bmatrix}$ 设置节点位移。使用线性形函数计算恒定位移梯度，计算小应变张量，并使用 $E = 2.0\\times 10^{11}$ 和 $\\nu = 0.3$ 的 $\\lambda = \\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu = \\dfrac{E}{2(1+\\nu)}$ 计算各向同性应力。测试得到的平面内柯西应力是否具有零斜对称性。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含测试 A–E 的结果，格式为方括号括起来的逗号分隔列表，例如 $\\left[\\text{result}_A,\\text{result}_B,\\text{result}_C,\\text{result}_D,\\text{result}_E\\right]$，其中每个条目为 true 或 false（不要求小写；原生布尔值可接受）。\n\n角度单位要求：所有角度和角速度分别以弧度和弧度/秒为单位。\n\n该测试套件涵盖了二维的一般情况、三维的一般情况、使用客观更新的时间积分情况、一个故意的非客观（且会失败的）更新情况，以及小刚体旋转下的有限元（Finite Element (FE)）常应变三角形一致性检查。", "solution": "当前问题要求以编程方式验证连续介质力学的一个基本原理：柯西应力张量的对称性。在没有分布体力偶的情况下，这是角动量守恒的直接结果。我们将构建一系列数值测试，以验证计算程序能否正确处理此属性，尤其是在客观性至关重要的刚体旋转情况下。如果本构方程与观察者无关，则程序是客观的（或框架无关的），这意味着如果材料体初始无应力，其刚体运动不应引起任何应力。\n\n验证的基础是检查柯西应力张量 $\\boldsymbol{\\sigma}$ 在各种变换下是否保持对称。如果一个张量 $\\boldsymbol{\\sigma}$ 等于其转置，即 $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathsf{T}}$，则该张量是对称的。等效地，其斜对称部分 $\\mathrm{skew}(\\boldsymbol{\\sigma})$ 必须是零张量。\n\n**1. 数值验证准则**\n\n二阶张量 $\\boldsymbol{\\sigma}$ 的斜对称部分定义为：\n$$\n\\mathrm{skew}(\\boldsymbol{\\sigma}) = \\frac{1}{2}(\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\mathsf{T}})\n$$\n角动量守恒要求 $\\mathrm{skew}(\\boldsymbol{\\sigma}) = \\boldsymbol{0}$。在数值计算中，我们必须在一定的浮点容差内测试此条件。矩阵 $\\boldsymbol{A}$ 的 Frobenius 范数定义为 $\\|\\boldsymbol{A}\\|_{\\mathrm{F}} = \\sqrt{\\sum_{i, j} A_{ij}^2}$，它提供了其大小的度量。如果计算出的应力斜对称部分的范数与应力张量本身的范数相比可以忽略不计，则基准测试被认为通过。条件是：\n$$\n\\|\\mathrm{skew}(\\boldsymbol{\\sigma})\\|_{\\mathrm{F}} \\le \\tau_{\\text{abs}} \\cdot \\max\\{1, \\|\\boldsymbol{\\sigma}\\|_{\\mathrm{F}}\\}\n$$\n其中 $\\tau_{\\text{abs}} = 10^{-9}$ 是指定的绝对容差。当 $\\|\\boldsymbol{\\sigma}\\|_{\\mathrm{F}}$ 很大时，此公式提供相对检查；当 $\\|\\boldsymbol{\\sigma}\\|_{\\mathrm{F}}$ 很小或为零时，提供绝对检查。\n\n**2. 刚体旋转运动学**\n\n纯刚体旋转由一个正常正交张量 $\\boldsymbol{R} \\in \\mathrm{SO}(d)$ 描述，其中 $d$ 是维度（$d=2$ 或 $d=3$）。$\\mathrm{SO}(d)$ 是特殊正交群，其成员满足 $\\boldsymbol{R}^{\\mathsf{T}}\\boldsymbol{R} = \\boldsymbol{I}$ 和 $\\det(\\boldsymbol{R}) = 1$。\n\n-   **二维 ($d=2$)**：旋转角度为 $\\theta$ 的旋转由以下矩阵给出：\n    $$\n    \\boldsymbol{R}(\\theta) = \\begin{bmatrix}\\cos\\theta  -\\sin\\theta\\\\ \\sin\\theta  \\cos\\theta\\end{bmatrix}\n    $$\n-   **三维 ($d=3$)**：围绕单位轴 $\\widehat{\\boldsymbol{a}}$ 旋转角度 $\\theta$ 的旋转使用 Rodrigues 公式计算。首先，将轴向量 $\\widehat{\\boldsymbol{a}} = [a_x, a_y, a_z]^{\\mathsf{T}}$ 与一个斜对称张量 $\\boldsymbol{A}$ 相关联：\n    $$\n    \\boldsymbol{A} = \\begin{bmatrix} 0  -a_z  a_y \\\\ a_z  0  -a_x \\\\ -a_y  a_x  0 \\end{bmatrix}\n    $$\n    旋转矩阵 $\\boldsymbol{R}$ 的 Rodrigues 公式为：\n    $$\n    \\boldsymbol{R}(\\widehat{\\boldsymbol{a}}, \\theta) = \\boldsymbol{I} + (\\sin\\theta)\\boldsymbol{A} + (1-\\cos\\theta)\\boldsymbol{A}^2\n    $$\n    其中 $\\boldsymbol{I}$ 是单位张量。问题提供了一个轴向量 $\\boldsymbol{a} = [0.3, -0.4, 0.8660254]^{\\mathsf{T}}$，在使用此公式前必须将其归一化为 $\\widehat{\\boldsymbol{a}} = \\boldsymbol{a}/\\|\\boldsymbol{a}\\|$。\n\n**3. 旋转下的应力更新算法**\n\n当一个材料单元经历由 $\\boldsymbol{R}$ 描述的刚体旋转时，客观的本构律规定，新构型中的柯西应力张量 $\\boldsymbol{\\sigma}$ 与原始构型中的应力张量 $\\boldsymbol{\\sigma}_0$ 通过简单的推前运算相关联：\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{R} \\boldsymbol{\\sigma}_0 \\boldsymbol{R}^{\\mathsf{T}}\n$$\n如果初始应力 $\\boldsymbol{\\sigma}_0$ 是对称的，则得到的应力 $\\boldsymbol{\\sigma}$ 也将是对称的，因为：\n$$\n\\boldsymbol{\\sigma}^{\\mathsf{T}} = (\\boldsymbol{R} \\boldsymbol{\\sigma}_0 \\boldsymbol{R}^{\\mathsf{T}})^{\\mathsf{T}} = (\\boldsymbol{R}^{\\mathsf{T}})^{\\mathsf{T}} \\boldsymbol{\\sigma}_0^{\\mathsf{T}} \\boldsymbol{R}^{\\mathsf{T}} = \\boldsymbol{R} \\boldsymbol{\\sigma}_0 \\boldsymbol{R}^{\\mathsf{T}} = \\boldsymbol{\\sigma}\n$$\n这构成了测试 A 和 B 的基础。\n\n对于时间积分方案，必须使用客观应力率。问题考虑了从时间 $t$ 到 $t+\\Delta t$ 的共旋更新。\n-   **客观更新（测试 C）**：在时间步长 $\\Delta t$ 内，对于具有恒定角速度 $\\boldsymbol{\\omega}$ 的纯刚性自旋，精确的更新是：\n    $$\n    \\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{R}(\\Delta t) \\boldsymbol{\\sigma}_n \\boldsymbol{R}(\\Delta t)^{\\mathsf{T}}\n    $$\n    其中 $\\boldsymbol{R}(\\Delta t)$ 是增量旋转矩阵。这可以计算为 $\\boldsymbol{R}(\\Delta t) = \\exp(\\boldsymbol{\\Omega}\\Delta t)$，其中 $\\boldsymbol{\\Omega}$ 是与 $\\boldsymbol{\\omega}$ 相关的斜对称张量。这等效于使用 Rodrigues 公式，轴为 $\\widehat{\\boldsymbol{\\omega}} = \\boldsymbol{\\omega}/\\|\\boldsymbol{\\omega}\\|$，角度为 $\\theta = \\|\\boldsymbol{\\omega}\\|\\Delta t$。此更新在每一步都保持对称性。\n\n-   **非客观更新（测试 D）**：提出了一个故意错误的更新：\n    $$\n    \\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_n + \\Delta t\\,\\boldsymbol{\\Omega}\\,\\boldsymbol{\\sigma}_n\n    $$\n    这是一个速率方程的错误单边离散化。如果 $\\boldsymbol{\\sigma}_n$ 是对称的，则项 $\\boldsymbol{\\Omega}\\boldsymbol{\\sigma}_n$ 通常不是。它的斜对称部分是 $\\mathrm{skew}(\\boldsymbol{\\Omega}\\boldsymbol{\\sigma}_n) = \\frac{1}{2}(\\boldsymbol{\\Omega}\\boldsymbol{\\sigma}_n + \\boldsymbol{\\sigma}_n\\boldsymbol{\\Omega})$。此项是一个斜对称张量和一个对称张量的反交换子，通常不为零。因此，此更新将人为地给应力引入一个伪斜对称分量，对称性测试应该会失败。\n\n**4. 有限元验证（测试 E）**\n\n此测试验证了一个简单的有限元公式能否正确地将刚体运动表示为无应变。我们使用一个带有线性形函数 $N_i(\\boldsymbol{x})$ 的二维常应变三角形（CST）单元。位移场为 $\\boldsymbol{u}(\\boldsymbol{x}) = \\sum_{i=1}^3 N_i(\\boldsymbol{x})\\boldsymbol{u}_i$，其中 $\\boldsymbol{u}_i$ 是节点位移。位移梯度 $\\nabla\\boldsymbol{u}$ 在单元内是恒定的，由下式给出：\n$$\n\\nabla\\boldsymbol{u} = \\sum_{i=1}^3 \\boldsymbol{u}_i \\otimes \\nabla N_i\n$$\n形函数的梯度 $\\nabla N_i = [b_i, c_i]^{\\mathsf{T}}$ 可以从节点坐标 $\\boldsymbol{x}_i = (x_i, y_i)$ 计算得出：\n$$\nb_i = \\frac{y_{i+1}-y_{i-1}}{2A_{\\text{elem}}}, \\quad c_i = \\frac{x_{i-1}-x_{i+1}}{2A_{\\text{elem}}} \\quad (\\text{循环索引 } 1,2,3)\n$$\n其中 $A_{\\text{elem}}$ 是三角形单元的面积。对于围绕原点以角速度 $\\omega_z$ 进行的小刚体旋转，速度场为 $\\boldsymbol{v}(\\boldsymbol{x}) = \\omega_z[-y, x]^{\\mathsf{T}}$。在小时间步长 $\\Delta t$ 后的位移是 $\\boldsymbol{u}(\\boldsymbol{x}) = \\Delta t \\boldsymbol{v}(\\boldsymbol{x})$。因此节点位移为 $\\boldsymbol{u}_i = \\Delta t\\,\\omega_z[-y_i, x_i]^{\\mathsf{T}}$。对于给定的节点 $\\boldsymbol{x}_1=(0,0), \\boldsymbol{x}_2=(1,0), \\boldsymbol{x}_3=(0,1)$，我们发现数值计算的位移梯度恰好是：\n$$\n\\nabla\\boldsymbol{u} = \\begin{bmatrix} 0  -\\omega_z \\Delta t \\\\ \\omega_z \\Delta t  0 \\end{bmatrix}\n$$\n这是一个斜对称张量。线性化（小）应变张量是 $\\boldsymbol{\\varepsilon} = \\frac{1}{2}(\\nabla\\boldsymbol{u} + (\\nabla\\boldsymbol{u})^{\\mathsf{T}})$。由于 $\\nabla\\boldsymbol{u}$ 是斜对称的，$(\\nabla\\boldsymbol{u})^{\\mathsf{T}} = -\\nabla\\boldsymbol{u}$，因此 $\\boldsymbol{\\varepsilon} = \\boldsymbol{0}$。对于一个具有本构律 $\\boldsymbol{\\sigma} = \\lambda\\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})\\,\\boldsymbol{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}$ 的各向同性线弹性材料，零应变意味着零应力：$\\boldsymbol{\\sigma} = \\boldsymbol{0}$。零张量是对称的，所以测试必须通过。\n\n实现将通过编写这五个测试中的每一个并应用数值验证准则来继续。", "answer": "```python\nimport numpy as np\n\ndef check_symmetry(sigma: np.ndarray) -> bool:\n    \"\"\"\n    Checks if a given Cauchy stress tensor is symmetric within a given tolerance.\n\n    Args:\n        sigma: The Cauchy stress tensor (2D or 3D).\n\n    Returns:\n        True if the tensor is symmetric within tolerance, False otherwise.\n    \"\"\"\n    if sigma.shape[0] != sigma.shape[1]:\n        raise ValueError(\"Input must be a square matrix.\")\n    \n    skew_sigma = 0.5 * (sigma - sigma.T)\n    norm_skew = np.linalg.norm(skew_sigma, 'fro')\n    norm_sigma = np.linalg.norm(sigma, 'fro')\n    \n    tolerance_val = 1e-9 * max(1.0, norm_sigma)\n    \n    return norm_skew = tolerance_val\n\ndef skew_matrix(v: np.ndarray) - np.ndarray:\n    \"\"\"\n    Creates a skew-symmetric matrix from a 3D vector.\n    \"\"\"\n    if v.shape != (3,):\n        raise ValueError(\"Input must be a 3D vector.\")\n    return np.array([\n        [0, -v[2], v[1]],\n        [v[2], 0, -v[0]],\n        [-v[1], v[0], 0]\n    ])\n\ndef rodrigues_rotation(axis: np.ndarray, angle: float) - np.ndarray:\n    \"\"\"\n    Computes a 3D rotation matrix using Rodrigues' formula.\n    \"\"\"\n    axis_norm = np.linalg.norm(axis)\n    if not np.isclose(axis_norm, 1.0):\n        # Normalize the axis to be a unit vector\n        axis = axis / axis_norm\n        \n    A = skew_matrix(axis)\n    I = np.eye(3)\n    R = I + np.sin(angle) * A + (1 - np.cos(angle)) * (A @ A)\n    return R\n\ndef test_a():\n    \"\"\"\n    Test A: two-dimensional rotation of an initially symmetric stress.\n    \"\"\"\n    theta = 0.7\n    sigma0 = np.array([\n        [1.2e8, 3.1e7],\n        [3.1e7, 8.8e7]\n    ])\n    R = np.array([\n        [np.cos(theta), -np.sin(theta)],\n        [np.sin(theta), np.cos(theta)]\n    ])\n    sigma_final = R @ sigma0 @ R.T\n    return check_symmetry(sigma_final)\n\ndef test_b():\n    \"\"\"\n    Test B: three-dimensional rotation of an initially symmetric stress.\n    \"\"\"\n    axis = np.array([0.3, -0.4, 0.8660254])\n    theta = 1.1\n    sigma0 = np.array([\n        [5e6, -2e6, 1e6],\n        [-2e6, 4e6, 0.5e6],\n        [1e6, 0.5e6, 6e6]\n    ])\n    \n    R = rodrigues_rotation(axis, theta)\n    sigma_final = R @ sigma0 @ R.T\n    return check_symmetry(sigma_final)\n\ndef test_c():\n    \"\"\"\n    Test C: objective Jaumann corotation under pure rigid rotation.\n    \"\"\"\n    omega = np.array([10.0, -5.0, 3.0])\n    T = 0.2\n    N = 4000\n    dt = T / N\n    sigma_n = np.array([\n        [5e6, -2e6, 1e6],\n        [-2e6, 4e6, 0.5e6],\n        [1e6, 0.5e6, 6e6]\n    ])\n\n    omega_norm = np.linalg.norm(omega)\n    rot_axis = omega / omega_norm\n    rot_angle_dt = omega_norm * dt\n    R_dt = rodrigues_rotation(rot_axis, rot_angle_dt)\n    \n    for _ in range(N):\n        sigma_n = R_dt @ sigma_n @ R_dt.T\n    \n    return check_symmetry(sigma_n)\n\ndef test_d():\n    \"\"\"\n    Test D: non-objective, symmetry-violating update.\n    \"\"\"\n    omega = np.array([10.0, -5.0, 3.0])\n    T = 0.2\n    N = 4000\n    dt = T / N\n    sigma_n = np.array([\n        [5e6, -2e6, 1e6],\n        [-2e6, 4e6, 0.5e6],\n        [1e6, 0.5e6, 6e6]\n    ])\n    \n    Omega = skew_matrix(omega)\n\n    for _ in range(N):\n        sigma_n = sigma_n + dt * (Omega @ sigma_n)\n        \n    return check_symmetry(sigma_n)\n\ndef test_e():\n    \"\"\"\n    Test E: single constant-strain triangle element under small rigid rotation.\n    \"\"\"\n    # Nodal coordinates\n    x1, y1 = 0.0, 0.0\n    x2, y2 = 1.0, 0.0\n    x3, y3 = 0.0, 1.0\n    nodes = np.array([[x1, y1], [x2, y2], [x3, y3]])\n\n    # Parameters\n    omega_z = 100.0\n    dt = 1e-8\n    E = 2.0e11\n    nu = 0.3\n    \n    # Nodal displacements for rigid rotation\n    k = omega_z * dt\n    u1 = k * np.array([-y1, x1])\n    u2 = k * np.array([-y2, x2])\n    u3 = k * np.array([-y3, x3])\n    nodal_disp = np.array([u1, u2, u3])\n    \n    # Element area\n    area = 0.5 * np.abs(x1*(y2-y3) + x2*(y3-y1) + x3*(y1-y2))\n\n    # Shape function derivatives (B matrix components)\n    b1 = (y2 - y3) / (2 * area)\n    b2 = (y3 - y1) / (2 * area)\n    b3 = (y1 - y2) / (2 * area)\n    c1 = (x3 - x2) / (2 * area)\n    c2 = (x1 - x3) / (2 * area)\n    c3 = (x2 - x1) / (2 * area)\n    b = np.array([b1, b2, b3])\n    c = np.array([c1, c2, c3])\n    \n    # Displacement gradient du_ij = u_i,j\n    grad_u = np.array([\n        [np.dot(b, nodal_disp[:, 0]), np.dot(c, nodal_disp[:, 0])],\n        [np.dot(b, nodal_disp[:, 1]), np.dot(c, nodal_disp[:, 1])]\n    ])\n    \n    # Small strain tensor\n    epsilon = 0.5 * (grad_u + grad_u.T)\n    \n    # Lamé parameters\n    lame_lambda = E * nu / ((1 + nu) * (1 - 2 * nu))\n    lame_mu = E / (2 * (1 + nu))\n    \n    # Stress calculation\n    I = np.eye(2)\n    sigma = lame_lambda * np.trace(epsilon) * I + 2 * lame_mu * epsilon\n    \n    return check_symmetry(sigma)\n\ndef solve():\n    \"\"\"\n    Runs all tests and prints the results in the required format.\n    \"\"\"\n    test_results = [\n        test_a(),\n        test_b(),\n        test_c(),\n        test_d(),\n        test_e()\n    ]\n    \n    # Format output as a list of lowercase boolean strings\n    result_str = ','.join(map(lambda x: str(x).lower(), test_results))\n    print(f\"[{result_str}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2616496"}]}