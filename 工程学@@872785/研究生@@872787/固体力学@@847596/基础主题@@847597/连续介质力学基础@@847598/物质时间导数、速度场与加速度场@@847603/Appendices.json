{"hands_on_practices": [{"introduction": "本练习侧重于运动的局部描述。在一个给定的简单剪切速度场中，我们将计算所有关键的运动学量：加速度、速度梯度、变形率张量和自旋张量。这项实践旨在巩固您对连续体在某一点如何变形和旋转的理解，并让您动手验证一个连接加速度梯度和速度梯度物质导数的重要运动学恒等式。", "problem": "考虑一个三维欧几里得连续介质，其具有固定的笛卡尔基 $\\{\\boldsymbol{e}_{1}, \\boldsymbol{e}_{2}, \\boldsymbol{e}_{3}\\}$ 和空间坐标 $(x,y,z)$。一个简单的平面剪切运动由空间速度场给出\n$$\\boldsymbol{v}(\\boldsymbol{x},t) = \\gamma(t)\\,y\\,\\boldsymbol{e}_{1},$$\n其中 $\\gamma(t)$ 是一个关于时间的二阶连续可微标量函数。仅使用基本运动学定义，显式计算以下物理量：\n- 物质加速度场 $\\boldsymbol{a}(\\boldsymbol{x},t)$，\n- 速度梯度张量 $\\boldsymbol{L}(\\boldsymbol{x},t)$，\n- 变形率张量 $\\boldsymbol{D}(\\boldsymbol{x},t)$，\n- 自旋张量 $\\boldsymbol{W}(\\boldsymbol{x},t)$，\n- 以及加速度的梯度 $\\nabla \\boldsymbol{a}(\\boldsymbol{x},t)$。\n\n从以下定义出发\n$$\\boldsymbol{a}=\\frac{D\\boldsymbol{v}}{Dt}=\\frac{\\partial \\boldsymbol{v}}{\\partial t}+(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v},\\qquad \\boldsymbol{L}=\\nabla\\boldsymbol{v},\\qquad \\boldsymbol{D}=\\frac{\\boldsymbol{L}+\\boldsymbol{L}^{\\mathsf{T}}}{2},\\qquad \\boldsymbol{W}=\\frac{\\boldsymbol{L}-\\boldsymbol{L}^{\\mathsf{T}}}{2},$$\n并根据其定义直接计算 $\\nabla \\boldsymbol{a}$。然后，通过分量计算，显式验证恒等式\n$$\\nabla \\boldsymbol{a}=\\dot{\\boldsymbol{L}}+\\boldsymbol{L}^{2},$$\n其中上方的点表示物质时间导数，且 $\\boldsymbol{L}^{2}=\\boldsymbol{L}\\,\\boldsymbol{L}$。\n\n作为您最终报告的量，计算张量 $\\nabla \\boldsymbol{a}-\\dot{\\boldsymbol{L}}-\\boldsymbol{L}^{2}$ 的弗罗贝尼乌斯范数。用国际单位制中的秒的负二次方（$\\mathrm{s}^{-2}$）表示最终值。在最终的方框答案中不要包含单位。", "solution": "该问题陈述是连续介质运动学中的一个有效练习。它具有科学依据，提法恰当且客观。我们将继续进行求解。\n\n问题给出了三维连续介质中简单平面剪切运动的空间速度场 $\\boldsymbol{v}(\\boldsymbol{x},t)$。在对应于坐标 $(x,y,z)$ 的固定笛卡尔基 $\\{\\boldsymbol{e}_{1}, \\boldsymbol{e}_{2}, \\boldsymbol{e}_{3}\\}$ 中，速度矢量表示为：\n$$ \\boldsymbol{v}(\\boldsymbol{x},t) = \\gamma(t)\\,y\\,\\boldsymbol{e}_{1} $$\n速度矢量的分量为 $v_1 = \\gamma(t)y$，$v_2 = 0$ 和 $v_3 = 0$。函数 $\\gamma(t)$ 是一个关于时间的二阶连续可微标量函数，我们记为 $\\gamma \\in C^2$。我们将其时间导数记为 $\\dot{\\gamma}(t) = d\\gamma/dt$。\n\n首先，我们计算物质加速度场 $\\boldsymbol{a}(\\boldsymbol{x},t)$。物质加速度的定义是速度场的物质时间导数：\n$$ \\boldsymbol{a} = \\frac{D\\boldsymbol{v}}{Dt} = \\frac{\\partial \\boldsymbol{v}}{\\partial t} + (\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v} $$\n$\\boldsymbol{v}$ 的局部或偏时间导数为：\n$$ \\frac{\\partial \\boldsymbol{v}}{\\partial t} = \\frac{\\partial}{\\partial t}(\\gamma(t)y\\,\\boldsymbol{e}_{1}) = \\dot{\\gamma}(t)y\\,\\boldsymbol{e}_{1} $$\n对流项是 $(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}$。算子 $(\\boldsymbol{v}\\cdot\\nabla)$ 是：\n$$ \\boldsymbol{v}\\cdot\\nabla = v_1 \\frac{\\partial}{\\partial x} + v_2 \\frac{\\partial}{\\partial y} + v_3 \\frac{\\partial}{\\partial z} = (\\gamma y) \\frac{\\partial}{\\partial x} + (0) \\frac{\\partial}{\\partial y} + (0) \\frac{\\partial}{\\partial z} = \\gamma y \\frac{\\partial}{\\partial x} $$\n将此算子作用于 $\\boldsymbol{v}$：\n$$ (\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v} = \\left(\\gamma y \\frac{\\partial}{\\partial x}\\right)(\\gamma y\\,\\boldsymbol{e}_{1}) = \\boldsymbol{0} $$\n该项为零，因为速度场 $\\boldsymbol{v}$ 不依赖于空间坐标 $x$。\n因此，加速度场纯粹是局部的：\n$$ \\boldsymbol{a}(\\boldsymbol{x},t) = \\dot{\\gamma}(t)y\\,\\boldsymbol{e}_{1} $$\n\n接下来，我们计算速度梯度张量 $\\boldsymbol{L}(\\boldsymbol{x},t)$，其定义为 $\\boldsymbol{L} = \\nabla\\boldsymbol{v}$。在笛卡尔坐标系中，其分量为 $L_{ij} = \\partial v_i / \\partial x_j$，其中 $(x_1, x_2, x_3) = (x, y, z)$。\n唯一非零的分量导数是：\n$$ L_{12} = \\frac{\\partial v_1}{\\partial x_2} = \\frac{\\partial}{\\partial y}(\\gamma y) = \\gamma(t) $$\n所有其他分量 $L_{ij}$ 均为零。$\\boldsymbol{L}$ 的矩阵表示为：\n$$ [\\boldsymbol{L}] = \\begin{pmatrix} 0 & \\gamma(t) & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n以张量形式表示，$\\boldsymbol{L} = \\gamma(t) \\boldsymbol{e}_1 \\otimes \\boldsymbol{e}_2$。\n\n变形率张量 $\\boldsymbol{D}$ 是 $\\boldsymbol{L}$ 的对称部分：\n$$ \\boldsymbol{D} = \\frac{1}{2}(\\boldsymbol{L} + \\boldsymbol{L}^{\\mathsf{T}}) $$\n$\\boldsymbol{L}$ 的转置是 $[\\boldsymbol{L}]^{\\mathsf{T}} = \\begin{pmatrix} 0 & 0 & 0 \\\\ \\gamma(t) & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$。\n$$ [\\boldsymbol{D}] = \\frac{1}{2}\\left(\\begin{pmatrix} 0 & \\gamma & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} 0 & 0 & 0 \\\\ \\gamma & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\\right) = \\begin{pmatrix} 0 & \\gamma/2 & 0 \\\\ \\gamma/2 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n\n自旋张量 $\\boldsymbol{W}$ 是 $\\boldsymbol{L}$ 的反对称部分：\n$$ \\boldsymbol{W} = \\frac{1}{2}(\\boldsymbol{L} - \\boldsymbol{L}^{\\mathsf{T}}) $$\n$$ [\\boldsymbol{W}] = \\frac{1}{2}\\left(\\begin{pmatrix} 0 & \\gamma & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} - \\begin{pmatrix} 0 & 0 & 0 \\\\ \\gamma & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\\right) = \\begin{pmatrix} 0 & \\gamma/2 & 0 \\\\ -\\gamma/2 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n\n接下来，我们计算加速度的梯度 $\\nabla \\boldsymbol{a}$。该张量的分量为 $(\\nabla \\boldsymbol{a})_{ij} = \\partial a_i / \\partial x_j$。我们有 $\\boldsymbol{a} = \\dot{\\gamma}y\\,\\boldsymbol{e}_1$，所以 $a_1 = \\dot{\\gamma}y$, $a_2 = 0$, $a_3 = 0$。\n唯一非零的偏导数是：\n$$ (\\nabla \\boldsymbol{a})_{12} = \\frac{\\partial a_1}{\\partial y} = \\frac{\\partial}{\\partial y}(\\dot{\\gamma}y) = \\dot{\\gamma}(t) $$\n$\\nabla \\boldsymbol{a}$ 的矩阵表示为：\n$$ [\\nabla\\boldsymbol{a}] = \\begin{pmatrix} 0 & \\dot{\\gamma}(t) & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n\n现在，我们必须通过显式计算右侧来验证恒等式 $\\nabla \\boldsymbol{a} = \\dot{\\boldsymbol{L}} + \\boldsymbol{L}^2$。项 $\\dot{\\boldsymbol{L}}$ 是 $\\boldsymbol{L}$ 的物质时间导数：\n$$ \\dot{\\boldsymbol{L}} = \\frac{D\\boldsymbol{L}}{Dt} = \\frac{\\partial \\boldsymbol{L}}{\\partial t} + (\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{L} $$\n$\\boldsymbol{L}$ 的分量为 $L_{12} = \\gamma(t)$，所有其他分量均为零。这些分量仅是时间的函数，不随空间位置变化。因此，每个分量的空间梯度均为零，即对于所有的 $i,j,k$，有 $\\partial L_{ij}/\\partial x_k = 0$。这意味着对流项为零：\n$$ (\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{L} = \\boldsymbol{0} $$\n所以，物质导数简化为偏时间导数：\n$$ \\dot{\\boldsymbol{L}} = \\frac{\\partial \\boldsymbol{L}}{\\partial t} = \\frac{\\partial}{\\partial t}(\\gamma(t)\\,\\boldsymbol{e}_1 \\otimes \\boldsymbol{e}_2) = \\dot{\\gamma}(t)\\,\\boldsymbol{e}_1 \\otimes \\boldsymbol{e}_2 $$\n$\\dot{\\boldsymbol{L}}$ 的矩阵表示为：\n$$ [\\dot{\\boldsymbol{L}}] = \\begin{pmatrix} 0 & \\dot{\\gamma}(t) & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n要计算的最后一项是 $\\boldsymbol{L}^2 = \\boldsymbol{L}\\boldsymbol{L}$。使用矩阵乘法：\n$$ [\\boldsymbol{L}^2] = [\\boldsymbol{L}][\\boldsymbol{L}] = \\begin{pmatrix} 0 & \\gamma & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & \\gamma & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n所以，$\\boldsymbol{L}^2$ 是零张量。\n结合这些结果，我们得到恒等式的右侧：\n$$ \\dot{\\boldsymbol{L}} + \\boldsymbol{L}^2 = \\dot{\\gamma}(t)\\,\\boldsymbol{e}_1 \\otimes \\boldsymbol{e}_2 + \\boldsymbol{0} = \\dot{\\gamma}(t)\\,\\boldsymbol{e}_1 \\otimes \\boldsymbol{e}_2 $$\n其矩阵为 $[\\dot{\\boldsymbol{L}} + \\boldsymbol{L}^2] = \\begin{pmatrix} 0 & \\dot{\\gamma} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$。\n将其与我们对 $\\nabla\\boldsymbol{a}$ 的直接计算进行比较，我们看到 $[\\nabla\\boldsymbol{a}] = [\\dot{\\boldsymbol{L}} + \\boldsymbol{L}^2]$。因此，该恒等式对于此运动得到了显式验证。\n\n最后的任务是计算张量 $\\nabla \\boldsymbol{a} - \\dot{\\boldsymbol{L}} - \\boldsymbol{L}^2$ 的弗罗贝尼乌斯范数。\n根据我们的验证，该张量是零张量：\n$$ \\nabla \\boldsymbol{a} - \\dot{\\boldsymbol{L}} - \\boldsymbol{L}^2 = \\boldsymbol{0} $$\n具有分量 $T_{ij}$ 的张量 $\\boldsymbol{T}$ 的弗罗贝尼乌斯范数由 $\\|\\boldsymbol{T}\\|_F = \\sqrt{\\sum_{i,j} |T_{ij}|^2}$ 给出。对于零张量，所有分量都为 $0$，所以其弗罗贝尼乌斯范数为：\n$$ \\|\\boldsymbol{0}\\|_F = \\sqrt{0^2 + 0^2 + \\dots + 0^2} = 0 $$\n张量表达式 $\\nabla \\boldsymbol{a} - \\dot{\\boldsymbol{L}} - \\boldsymbol{L}^2$ 中所有项的单位都是 $\\mathrm{s}^{-2}$。因此，得到的范数的单位也是 $\\mathrm{s}^{-2}$。数值为零。", "answer": "$$\n\\boxed{0}\n$$", "id": "2659112"}, {"introduction": "本练习将我们从瞬时描述带入对变形历史的分析。通过对速度梯度进行积分以求得变形梯度，我们将探索最终变形状态如何依赖于所施加变形的*顺序*。此练习通过一个包含两种非对易变形方案的假想情景，清晰地揭示了有限变形的路径依赖性，这是在材料加工和塑性理论等领域中的一个核心概念。", "problem": "一个固体的均匀、不可压缩平面形变由形变梯度 $\\boldsymbol{F}(t)$ 描述，其初始条件为 $\\boldsymbol{F}(0)=\\boldsymbol{I}$，并根据运动学关系 $\\dot{\\boldsymbol{F}}(t)=\\boldsymbol{L}(t)\\,\\boldsymbol{F}(t)$ 演化，其中 $\\boldsymbol{L}(t)$ 是速度梯度。考虑在总时长 $t^{\\ast}=\\tau+\\Delta$ 内的两种时间方案，这两种方案以不同顺序使用相同的两个恒定速度梯度：\n- 方案A：在 $0 \\le t  \\tau$ 时间段内，$\\boldsymbol{L}(t)=\\boldsymbol{L}_{1}$；之后在 $\\tau \\le t \\le \\tau+\\Delta$ 时间段内，$\\boldsymbol{L}(t)=\\boldsymbol{L}_{2}$。\n- 方案B：在 $0 \\le t  \\Delta$ 时间段内，$\\boldsymbol{L}(t)=\\boldsymbol{L}_{2}$；之后在 $\\Delta \\le t \\le \\Delta+\\tau$ 时间段内，$\\boldsymbol{L}(t)=\\boldsymbol{L}_{1}$。\n\n恒定的速度梯度为\n$$\n\\boldsymbol{L}_{1} = s\\,\\boldsymbol{e}_{1}\\otimes\\boldsymbol{e}_{2}\n=\n\\begin{bmatrix}\n0  s \\\\\n0  0\n\\end{bmatrix},\n\\qquad\n\\boldsymbol{L}_{2} = \\alpha\\,\\boldsymbol{e}_{1}\\otimes\\boldsymbol{e}_{1} - \\alpha\\,\\boldsymbol{e}_{2}\\otimes\\boldsymbol{e}_{2}\n=\n\\begin{bmatrix}\n\\alpha  0 \\\\\n0  -\\alpha\n\\end{bmatrix},\n$$\n其中 $s0$ 和 $\\alpha0$ 为常数，$\\{\\boldsymbol{e}_{1},\\boldsymbol{e}_{2}\\}$ 是平面的固定标准正交基。右和左柯西-格林形变张量分别为 $\\boldsymbol{C}(t)=\\boldsymbol{F}(t)^{\\mathsf{T}}\\boldsymbol{F}(t)$ 和 $\\boldsymbol{B}(t)=\\boldsymbol{F}(t)\\boldsymbol{F}(t)^{\\mathsf{T}}$。\n\n任务：\n1. 从基本运动学关系 $\\dot{\\boldsymbol{F}}=\\boldsymbol{L}\\boldsymbol{F}$ 和给定的 $\\boldsymbol{L}(t)$ 出发，通过积分求得方案A和方案B在 $t^{\\ast}$ 时刻的显式 $\\boldsymbol{F}(t^{\\ast})$。你可以使用以下结论：对于一个时间常数 $\\boldsymbol{L}$，在一个区间上的解由矩阵指数给出。\n2. 根据 $\\boldsymbol{C}$ 和 $\\boldsymbol{B}$ 的定义以及物质时间导数的链式法则，推导出 $\\dot{\\boldsymbol{C}}$ 和 $\\dot{\\boldsymbol{B}}$ 关于 $\\boldsymbol{F}$ 和 $\\boldsymbol{L}$ 的表达式，并使用你得到的 $\\boldsymbol{F}(t^{\\ast})$ 和各方案中相应的当前 $\\boldsymbol{L}(t^{\\ast})$，计算每个方案的 $\\dot{\\boldsymbol{C}}(t^{\\ast})$ 和 $\\dot{\\boldsymbol{B}}(t^{\\ast})$。\n3. 通过显式计算，证明 $\\boldsymbol{L}_{1}$ 和 $\\boldsymbol{L}_{2}$ 不对易，并且两种方案得到不同的 $\\boldsymbol{F}(t^{\\ast})$。\n4. 令 $\\left(\\dot{\\boldsymbol{B}}(t^{\\ast})\\right)_{12}$ 表示 $\\dot{\\boldsymbol{B}}(t^{\\ast})$ 的 $\\left(1,2\\right)$ 分量。计算标量差\n$$\n\\Delta_{12} \\equiv \\left(\\dot{\\boldsymbol{B}}(t^{\\ast})\\right)_{12}^{\\text{A}} - \\left(\\dot{\\boldsymbol{B}}(t^{\\ast})\\right)_{12}^{\\text{B}},\n$$\n其中上标表示方案A和方案B。将你的最终答案表示为关于 $\\alpha$、$s$、$\\tau$ 和 $\\Delta$ 的单个简化解析表达式。最终结果以 $\\mathrm{s}^{-1}$ 为单位表示。\n\n你的最终答案必须仅为 $\\Delta_{12}$ 的值，形式为一个单一的闭式表达式（不含中间步骤），且答案框内不包含单位。", "solution": "所述问题具有科学依据、提法恰当、客观且完整。它提出了一个连续介质运动学中的标准问题，可以利用所提供的信息解决。因此，该问题是有效的，我们开始求解。\n\n形变梯度 $\\boldsymbol{F}(t)$ 的运动学演化由微分方程 $\\dot{\\boldsymbol{F}}(t) = \\boldsymbol{L}(t)\\boldsymbol{F}(t)$ 和初始条件 $\\boldsymbol{F}(0)=\\boldsymbol{I}$ 控制，其中 $\\boldsymbol{I}$ 是 $2 \\times 2$ 单位矩阵。对于速度梯度 $\\boldsymbol{L}$ 恒定的时间间隔 $\\delta t$，解由矩阵指数给出：$\\boldsymbol{F}(t_{0}+\\delta t) = \\exp(\\boldsymbol{L}\\,\\delta t)\\boldsymbol{F}(t_{0})$。\n\n1. 为求得每个方案的最终形变梯度 $\\boldsymbol{F}(t^{\\ast})$（其中 $t^{\\ast} = \\tau+\\Delta$），我们首先计算给定的速度梯度 $\\boldsymbol{L}_{1}$ 和 $\\boldsymbol{L}_{2}$ 的矩阵指数。\n速度梯度 $\\boldsymbol{L}_{1} = \\begin{bmatrix} 0  s \\\\ 0  0 \\end{bmatrix}$ 是一个幂零矩阵，具体来说 $\\boldsymbol{L}_{1}^2 = \\boldsymbol{0}$。矩阵指数的泰勒级数在一次项后截断：\n$$\n\\exp(\\boldsymbol{L}_{1}t) = \\boldsymbol{I} + t\\boldsymbol{L}_{1} = \\begin{bmatrix} 1  st \\\\ 0  1 \\end{bmatrix}.\n$$\n速度梯度 $\\boldsymbol{L}_{2} = \\begin{bmatrix} \\alpha  0 \\\\ 0  -\\alpha \\end{bmatrix}$ 是一个对角矩阵。其指数可通过对角元素取指数得到：\n$$\n\\exp(\\boldsymbol{L}_{2}t) = \\begin{bmatrix} \\exp(\\alpha t)  0 \\\\ 0  \\exp(-\\alpha t) \\end{bmatrix}.\n$$\n对于方案A，形变包括施加 $\\boldsymbol{L}_{1}$ 持续时间 $\\tau$，然后施加 $\\boldsymbol{L}_{2}$ 持续时间 $\\Delta$。最终的形变梯度是相应矩阵指数的乘积：\n$$\n\\boldsymbol{F}_{\\text{A}}(t^{\\ast}) = \\exp(\\boldsymbol{L}_{2}\\Delta)\\exp(\\boldsymbol{L}_{1}\\tau) = \\begin{bmatrix} \\exp(\\alpha \\Delta)  0 \\\\ 0  \\exp(-\\alpha \\Delta) \\end{bmatrix} \\begin{bmatrix} 1  s\\tau \\\\ 0  1 \\end{bmatrix} = \\begin{bmatrix} \\exp(\\alpha \\Delta)  s\\tau \\exp(\\alpha \\Delta) \\\\ 0  \\exp(-\\alpha \\Delta) \\end{bmatrix}.\n$$\n对于方案B，操作顺序相反：施加 $\\boldsymbol{L}_{2}$ 持续时间 $\\Delta$，然后施加 $\\boldsymbol{L}_{1}$ 持续时间 $\\tau$。最终的形变梯度是：\n$$\n\\boldsymbol{F}_{\\text{B}}(t^{\\ast}) = \\exp(\\boldsymbol{L}_{1}\\tau)\\exp(\\boldsymbol{L}_{2}\\Delta) = \\begin{bmatrix} 1  s\\tau \\\\ 0  1 \\end{bmatrix} \\begin{bmatrix} \\exp(\\alpha \\Delta)  0 \\\\ 0  \\exp(-\\alpha \\Delta) \\end{bmatrix} = \\begin{bmatrix} \\exp(\\alpha \\Delta)  s\\tau \\exp(-\\alpha \\Delta) \\\\ 0  \\exp(-\\alpha \\Delta) \\end{bmatrix}.\n$$\n3. 我们证明 $\\boldsymbol{L}_{1}$ 和 $\\boldsymbol{L}_{2}$ 不对易，这解释了为何两种方案产生不同的最终状态 $\\boldsymbol{F}(t^\\ast)$。对易子计算如下：\n$$\n[\\boldsymbol{L}_{1}, \\boldsymbol{L}_{2}] = \\boldsymbol{L}_{1}\\boldsymbol{L}_{2} - \\boldsymbol{L}_{2}\\boldsymbol{L}_{1} = \\begin{bmatrix} 0  s \\\\ 0  0 \\end{bmatrix}\\begin{bmatrix} \\alpha  0 \\\\ 0  -\\alpha \\end{bmatrix} - \\begin{bmatrix} \\alpha  0 \\\\ 0  -\\alpha \\end{bmatrix}\\begin{bmatrix} 0  s \\\\ 0  0 \\end{bmatrix}\n$$\n$$\n= \\begin{bmatrix} 0  -s\\alpha \\\\ 0  0 \\end{bmatrix} - \\begin{bmatrix} 0  s\\alpha \\\\ 0  0 \\end{bmatrix} = \\begin{bmatrix} 0  -2s\\alpha \\\\ 0  0 \\end{bmatrix}.\n$$\n由于 $s0$ 且 $\\alpha0$，对易子 $[\\boldsymbol{L}_{1}, \\boldsymbol{L}_{2}]$ 不是零矩阵 $\\boldsymbol{0}$。因为变换的生成元不对易，最终的形变梯度取决于操作的顺序。直接比较 $\\boldsymbol{F}_{\\text{A}}(t^{\\ast})$ 和 $\\boldsymbol{F}_{\\text{B}}(t^{\\ast})$ 可知，它们的 $(1,2)$ 分量不同，因为对于 $\\alpha\\Delta \\neq 0$，$s\\tau \\exp(\\alpha \\Delta) \\neq s\\tau \\exp(-\\alpha \\Delta)$。\n\n2. 我们推导柯西-格林形变张量的物质时间导数表达式。右柯西-格林张量为 $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$。其时间导数使用乘法法则和运动学关系 $\\dot{\\boldsymbol{F}}=\\boldsymbol{L}\\boldsymbol{F}$ 及其转置 $\\dot{\\boldsymbol{F}}^{\\mathsf{T}} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{L}^{\\mathsf{T}}$ 求得：\n$$\n\\dot{\\boldsymbol{C}} = \\frac{d}{dt}(\\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}) = \\dot{\\boldsymbol{F}}^{\\mathsf{T}}\\boldsymbol{F} + \\boldsymbol{F}^{\\mathsf{T}}\\dot{\\boldsymbol{F}} = (\\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{L}^{\\mathsf{T}})\\boldsymbol{F} + \\boldsymbol{F}^{\\mathsf{T}}(\\boldsymbol{L}\\boldsymbol{F}) = \\boldsymbol{F}^{\\mathsf{T}}(\\boldsymbol{L}^{\\mathsf{T}} + \\boldsymbol{L})\\boldsymbol{F}.\n$$\n左柯西-格林张量为 $\\boldsymbol{B} = \\boldsymbol{F}\\boldsymbol{F}^{\\mathsf{T}}$。其时间导数为：\n$$\n\\dot{\\boldsymbol{B}} = \\frac{d}{dt}(\\boldsymbol{F}\\boldsymbol{F}^{\\mathsf{T}}) = \\dot{\\boldsymbol{F}}\\boldsymbol{F}^{\\mathsf{T}} + \\boldsymbol{F}\\dot{\\boldsymbol{F}}^{\\mathsf{T}} = (\\boldsymbol{L}\\boldsymbol{F})\\boldsymbol{F}^{\\mathsf{T}} + \\boldsymbol{F}(\\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{L}^{\\mathsf{T}}) = \\boldsymbol{L}(\\boldsymbol{F}\\boldsymbol{F}^{\\mathsf{T}}) + (\\boldsymbol{F}\\boldsymbol{F}^{\\mathsf{T}})\\boldsymbol{L}^{\\mathsf{T}} = \\boldsymbol{L}\\boldsymbol{B} + \\boldsymbol{B}\\boldsymbol{L}^{\\mathsf{T}}.\n$$\n在时刻 $t^{\\ast}$，方案A的速度梯度为 $\\boldsymbol{L}(t^{\\ast}) = \\boldsymbol{L}_{2}$。对于方案B，速度梯度为 $\\boldsymbol{L}(t^{\\ast}) = \\boldsymbol{L}_{1}$。$\\dot{\\boldsymbol{C}}(t^{\\ast})$ 和 $\\dot{\\boldsymbol{B}}(t^{\\ast})$ 的计算使用了每个方案对应的形变梯度 $\\boldsymbol{F}(t^{\\ast})$ 和施加的速度梯度 $\\boldsymbol{L}(t^{\\ast})$。\n\n4. 现在我们计算标量差 $\\Delta_{12} = (\\dot{\\boldsymbol{B}}(t^{\\ast}))_{12}^{\\text{A}} - (\\dot{\\boldsymbol{B}}(t^{\\ast}))_{12}^{\\text{B}}$。首先，我们确定左柯西-格林张量 $\\boldsymbol{B}_{\\text{A}}(t^{\\ast})$ 和 $\\boldsymbol{B}_{\\text{B}}(t^{\\ast})$。\n对于方案A：\n$$\n\\boldsymbol{B}_{\\text{A}}(t^{\\ast}) = \\boldsymbol{F}_{\\text{A}}(t^{\\ast})\\boldsymbol{F}_{\\text{A}}(t^{\\ast})^{\\mathsf{T}} = \\begin{bmatrix} \\exp(\\alpha \\Delta)  s\\tau \\exp(\\alpha \\Delta) \\\\ 0  \\exp(-\\alpha \\Delta) \\end{bmatrix} \\begin{bmatrix} \\exp(\\alpha \\Delta)  0 \\\\ s\\tau \\exp(\\alpha \\Delta)  \\exp(-\\alpha \\Delta) \\end{bmatrix}\n$$\n$$\n= \\begin{bmatrix} (1+s^2\\tau^2)\\exp(2\\alpha\\Delta)  s\\tau \\\\ s\\tau  \\exp(-2\\alpha\\Delta) \\end{bmatrix}.\n$$\n时间导数为 $\\dot{\\boldsymbol{B}}_{\\text{A}}(t^{\\ast}) = \\boldsymbol{L}_{2}\\boldsymbol{B}_{\\text{A}}(t^{\\ast}) + \\boldsymbol{B}_{\\text{A}}(t^{\\ast})\\boldsymbol{L}_{2}^{\\mathsf{T}}$。由于 $\\boldsymbol{L}_{2}$ 是对称的（$\\boldsymbol{L}_{2}^{\\mathsf{T}} = \\boldsymbol{L}_{2}$），$(1,2)$ 分量为：\n$$\n(\\dot{\\boldsymbol{B}}_{\\text{A}}(t^{\\ast}))_{12} = (\\boldsymbol{L}_{2}\\boldsymbol{B}_{\\text{A}})_{12} + (\\boldsymbol{B}_{\\text{A}}\\boldsymbol{L}_{2})_{12} = [(\\boldsymbol{L}_{2})_{11}(\\boldsymbol{B}_{\\text{A}})_{12}] + [(\\boldsymbol{B}_{\\text{A}})_{12}(\\boldsymbol{L}_{2})_{22}] = \\alpha(s\\tau) + (s\\tau)(-\\alpha) = 0.\n$$\n对于方案B：\n$$\n\\boldsymbol{B}_{\\text{B}}(t^{\\ast}) = \\boldsymbol{F}_{\\text{B}}(t^{\\ast})\\boldsymbol{F}_{\\text{B}}(t^{\\ast})^{\\mathsf{T}} = \\begin{bmatrix} \\exp(\\alpha \\Delta)  s\\tau \\exp(-\\alpha \\Delta) \\\\ 0  \\exp(-\\alpha \\Delta) \\end{bmatrix} \\begin{bmatrix} \\exp(\\alpha \\Delta)  0 \\\\ s\\tau \\exp(-\\alpha \\Delta)  \\exp(-\\alpha \\Delta) \\end{bmatrix}\n$$\n$$\n= \\begin{bmatrix} \\exp(2\\alpha\\Delta) + s^2\\tau^2\\exp(-2\\alpha\\Delta)  s\\tau\\exp(-2\\alpha\\Delta) \\\\ s\\tau\\exp(-2\\alpha\\Delta)  \\exp(-2\\alpha\\Delta) \\end{bmatrix}.\n$$\n时间导数为 $\\dot{\\boldsymbol{B}}_{\\text{B}}(t^{\\ast}) = \\boldsymbol{L}_{1}\\boldsymbol{B}_{\\text{B}}(t^{\\ast}) + \\boldsymbol{B}_{\\text{B}}(t^{\\ast})\\boldsymbol{L}_{1}^{\\mathsf{T}}$。$(1,2)$ 分量为：\n$$\n(\\dot{\\boldsymbol{B}}_{\\text{B}}(t^{\\ast}))_{12} = (\\boldsymbol{L}_{1}\\boldsymbol{B}_{\\text{B}})_{12} + (\\boldsymbol{B}_{\\text{B}}\\boldsymbol{L}_{1}^{\\mathsf{T}})_{12}.\n$$\n第一项是 $(\\boldsymbol{L}_{1}\\boldsymbol{B}_{\\text{B}})_{12} = (\\boldsymbol{L}_{1})_{12}(\\boldsymbol{B}_{\\text{B}})_{22} = s \\cdot \\exp(-2\\alpha\\Delta)$。\n第二项是 $(\\boldsymbol{B}_{\\text{B}}\\boldsymbol{L}_{1}^{\\mathsf{T}})_{12} = (\\boldsymbol{B}_{\\text{B}})_{11}(\\boldsymbol{L}_{1}^{\\mathsf{T}})_{12} + (\\boldsymbol{B}_{\\text{B}})_{12}(\\boldsymbol{L}_{1}^{\\mathsf{T}})_{22} = (\\dots)(0) + (\\dots)(0) = 0$。\n因此，$(\\dot{\\boldsymbol{B}}_{\\text{B}}(t^{\\ast}))_{12} = s\\exp(-2\\alpha\\Delta)$。\n所求的差为：\n$$\n\\Delta_{12} = (\\dot{\\boldsymbol{B}}(t^{\\ast}))_{12}^{\\text{A}} - (\\dot{\\boldsymbol{B}}(t^{\\ast}))_{12}^{\\text{B}} = 0 - s\\exp(-2\\alpha\\Delta) = -s\\exp(-2\\alpha\\Delta).\n$$", "answer": "$$\n\\boxed{-s\\exp(-2\\alpha\\Delta)}\n$$", "id": "2659109"}, {"introduction": "本项实践将运动学概念应用于计算力学领域，以分析一个复杂的非定常流场。我们将通过数值方法实现质点路径的定义，以生成迹线——一条追踪了连续释放的质点在某一时刻位置的曲线。这项计算练习将直观地展示流线（流向的瞬时快照）和迹线（时间积分的流动历史）之间的关键区别，从而加深对欧拉和拉格朗日描述的理解。", "problem": "给定一个二维运动学模型，用于描述一个在原点附近具有局部、时变强迫的瞬态平面射流。该模型通过光滑速度场 $\\mathbf{v}(\\mathbf{x},t)$ 来描述，其中 $\\mathbf{x}=(x,y)$，时间 $t$ 以秒为单位。射流沿 $x$ 轴正方向从原点射出，在 $y$ 方向具有高斯截面，并在 $x=0$ 附近中心处有一个随时间振荡的局部强迫。所有角度均以弧度为单位。所有空间坐标以米为单位，所有速度以米/秒为单位。\n\n速度场由以下公式指定\n$$\nv_x(x,y,t) = U_0 \\exp\\!\\left(-\\frac{y^2}{w^2}\\right) \\left[1 + A \\exp\\!\\left(-\\frac{x^2}{L_f^2}\\right) \\sin(\\omega t)\\right],\n$$\n$$\nv_y(x,y,t) = A\\,c \\exp\\!\\left(-\\frac{x^2}{L_f^2}-\\frac{y^2}{w^2}\\right) \\sin(\\omega t + \\phi),\n$$\n其中 $U_00$ 是基础射流速度， $w0$ 是射流半宽， $L_f0$ 是强迫局部化长度尺度， $A \\ge 0$ 是无量纲的强迫振幅， $\\omega \\ge 0$ 是强迫角频率（单位为弧度/秒）， $c0$ 是横向流速度尺度， $\\phi$ 是相位偏移（单位为弧度）。\n\n您的任务是从基本运动学出发，实现以下定义和计算：\n\n- 一个连续介质粒子的物质（路径线）轨迹 $\\mathbf{x}(t)$ 由以下常微分方程决定\n$$\n\\frac{d\\mathbf{x}}{dt} = \\mathbf{v}(\\mathbf{x}(t),t),\n$$\n其在指定释放时间 $t_r$ 的初始条件为 $\\mathbf{x}(t_r)=\\mathbf{x}_0$。物质（Eulerian）加速度场是速度场的物质时间导数，\n$$\n\\mathbf{a}(\\mathbf{x},t) = \\frac{D\\mathbf{v}}{Dt}(\\mathbf{x},t),\n$$\n需使用 $\\mathbf{v}$ 对 $t$ 的偏导数和对 $(x,y)$ 的空间梯度来表示。\n\n- 在观测时间 $T$ 的一条流线是满足以下条件的积分曲线 $\\mathbf{x}(\\sigma)$\n$$\n\\frac{d\\mathbf{x}}{d\\sigma} = \\mathbf{v}(\\mathbf{x}(\\sigma),T),\n$$\n其在 $\\sigma=0$ 处有选定的起始点。为方便起见，这里的 $\\sigma$ 是一个具有时间量纲的积分参数。\n\n- 在观测时间 $T$ 时，从位于 $\\mathbf{x}_0$ 的喷射器发出的一条脉线，是在指定区间 $[T-\\tau_{\\max},T]$ 内不同释放时间 $t_r$ 从 $\\mathbf{x}_0$ 释放的所有粒子在时间 $T$ 的位置集合，即集合 $\\{\\mathbf{x}(T; t_r) : t_r \\in [T-\\tau_{\\max},T]\\}$，其中每个 $\\mathbf{x}(t)$ 都是满足初始条件 $\\mathbf{x}(t_r)=\\mathbf{x}_0$ 的物质轨迹方程的解。\n\n仅基于这些定义，实现一个数值程序来完成以下任务：\n1. 通过在等间隔的释放时间 $t_r \\in [T-\\tau_{\\max},T]$（间隔为 $\\Delta t_{\\text{rel}}$）释放粒子，并将其轨迹向前积分至时间 $T$，来构建在观测时间 $T$ 时从位于 $\\mathbf{x}_0=(0,0)$ 的喷射器发出的脉线的离散近似。\n2. 通过在长度为 $S_{\\max}$ 的参数区间上向前积分流线常微分方程，来构建在时间 $T$ 穿过 $\\mathbf{x}_0$ 的瞬时流线的离散近似。\n3. 计算在第1项和第2项中得到的两条多段线之间的离散 Hausdorff 距离（以米为单位）。该距离应计算为两个有向离散距离的最大值：对于一条多段线上的每个点，找到其到另一条多段线的最小 Euclidean 距离，然后在两个方向上取所有这些逐点最小值的最大值。\n4. 计算在时间 $T$ 沿脉线各点的物质（Eulerian）加速度 $\\|\\mathbf{a}(\\mathbf{x},T)\\|$ 的平均大小（以米/秒平方为单位）。\n\n使用一种适用于光滑右端项的数值稳定的显式时间步进法，并采用足够小的步长以解析给定参数所蕴含的运动学特性。\n\n常数固定为 $U_0=1.0$ $\\mathrm{m/s}$，$w=0.08$ $\\mathrm{m}$，$L_f=0.15$ $\\mathrm{m}$，$c=0.25$ $\\mathrm{m/s}$，喷射器位置为 $\\mathbf{x}_0=(0,0)$ $\\mathrm{m}$。对于每种情况，流线积分范围应设置为 $S_{\\max}=\\tau_{\\max}+0.5$ $\\mathrm{s}$。\n\n您的程序必须评估以下参数集测试套件，其中每个集合为 $(A,\\omega,\\phi,T,\\tau_{\\max},\\Delta t_{\\text{rel}})$：\n\n- 情况 1：$(0.3, 4.0, 0.0, 2.0, 1.0, 0.02)$。\n- 情况 2（无强迫的边界情况）：$(0.0, 5.0, 0.0, 2.0, 1.0, 0.02)$。\n- 情况 3（有相位的高频强迫）：$(0.3, 20.0, 0.5, 1.2, 0.8, 0.01)$。\n\n对于每种情况，计算：\n- 在时间 $T$ 的脉线与在时间 $T$ 穿过 $\\mathbf{x}_0$ 的瞬时流线之间的离散 Hausdorff 距离，以米表示。\n- 在时间 $T$ 沿脉线的物质（Eulerian）加速度的平均大小，以米/秒平方表示。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个扁平列表中的所有结果，顺序为 $[\\text{d}_1,\\bar{a}_1,\\text{d}_2,\\bar{a}_2,\\text{d}_3,\\bar{a}_3]$，其中 $\\text{d}_k$ 是情况 $k$ 的 Hausdorff 距离（以米为单位），$\\bar{a}_k$ 是情况 $k$ 的平均加速度大小（以 $\\mathrm{m/s^2}$ 为单位）。每个数字必须打印为十进制浮点值，并四舍五入到小数点后六位。不应打印其他任何文本。\n\n所有角度必须以弧度为单位。所有空间距离必须以米为单位。所有时间必须以秒为单位。所有速度必须以米/秒为单位。所有加速度必须以米/秒平方为单位。确保您的方法是从上述基本运动学定义推导出来的，没有调用任何未经证明的快捷公式。", "solution": "该问题已经过验证，被认为是科学上合理、适定且自洽的。它提出了一个流体运动学中的标准计算练习，基于基本原理和定义。所有提供的参数在物理上和量纲上都是一致的。任务定义清晰，并能导出一个唯一的、可验证的解。因此，将提供一个解决方案。\n\n问题的核心是通过计算和比较不同的运动学量（脉线、流线和物质加速度场）来分析给定的二维非定常速度场 $\\mathbf{v}(\\mathbf{x},t)$。解决方案涉及常微分方程（ODE）的数值积分以及基于所得几何和物理数据的度量计算。该方法论是根据问题陈述中阐述的第一性原理构建的。\n\n速度场分量由下式给出\n$$v_x(x,y,t) = U_0 \\exp\\left(-\\frac{y^2}{w^2}\\right) \\left[1 + A \\exp\\left(-\\frac{x^2}{L_f^2}\\right) \\sin(\\omega t)\\right]$$\n$$v_y(x,y,t) = A\\,c \\exp\\left(-\\frac{x^2}{L_f^2}-\\frac{y^2}{w^2}\\right) \\sin(\\omega t + \\phi)$$\n\n解决方案的结构如下：首先，推导物质加速度场的解析表达式。其次，指定用于积分运动学 ODE 的数值方法。第三，详细说明构建离散脉线和流线的过程。第四，定义这两条曲线之间离散 Hausdorff 距离的计算。最后，描述沿脉线的平均加速度大小的计算。\n\n**1. 物质加速度场**\n\n速度场的物质（或随体）导数 $\\mathbf{a}(\\mathbf{x},t) = \\frac{D\\mathbf{v}}{Dt}$ 提供了在时间 $t$ 位于位置 $\\mathbf{x}$ 的流体粒子的加速度。它由 Euler-Lagrange 关系给出：\n$$\\mathbf{a}(\\mathbf{x}, t) = \\frac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v} \\cdot \\nabla) \\mathbf{v} = \\frac{\\partial \\mathbf{v}}{\\partial t} + v_x \\frac{\\partial \\mathbf{v}}{\\partial x} + v_y \\frac{\\partial \\mathbf{v}}{\\partial y}$$\n加速度的分量 $a_x$ 和 $a_y$ 是通过计算 $v_x$ 和 $v_y$ 对 $t$、$x$ 和 $y$ 的偏导数得出的。让我们定义指数因子 $E_y = \\exp(-y^2/w^2)$ 和 $E_{xy} = \\exp(-x^2/L_f^2 - y^2/w^2)$。所需的偏导数是：\n$\\frac{\\partial v_x}{\\partial t} = A \\omega U_0 E_{xy} \\cos(\\omega t)$\n$\\frac{\\partial v_y}{\\partial t} = A c \\omega E_{xy} \\cos(\\omega t + \\phi)$\n$\\frac{\\partial v_x}{\\partial x} = - \\frac{2 A U_0 x}{L_f^2} E_{xy} \\sin(\\omega t)$\n$\\frac{\\partial v_y}{\\partial x} = - \\frac{2 A c x}{L_f^2} E_{xy} \\sin(\\omega t + \\phi)$\n$\\frac{\\partial v_x}{\\partial y} = - \\frac{2y}{w^2} v_x(x,y,t)$\n$\\frac{\\partial v_y}{\\partial y} = - \\frac{2y}{w^2} v_y(x,y,t)$\n\n将这些代入 $\\mathbf{a}$ 的表达式中，得到分量：\n$$a_x(x,y,t) = A \\omega U_0 E_{xy} \\cos(\\omega t) + v_x \\left( - \\frac{2 A U_0 x}{L_f^2} E_{xy} \\sin(\\omega t) \\right) + v_y \\left( - \\frac{2y}{w^2} v_x \\right)$$\n$$a_y(x,y,t) = A c \\omega E_{xy} \\cos(\\omega t + \\phi) + v_x \\left( - \\frac{2 A c x}{L_f^2} E_{xy} \\sin(\\omega t + \\phi) \\right) + v_y \\left( - \\frac{2y}{w^2} v_y \\right)$$\n这些解析表达式被实现用于计算任何点 $(\\mathbf{x},t)$ 的加速度。其大小则为 $\\|\\mathbf{a}\\| = \\sqrt{a_x^2 + a_y^2}$。\n\n**2. 数值积分方案**\n\n路径线和流线都是通过积分形式为 $\\frac{d\\mathbf{x}}{d\\tau} = \\mathbf{f}(\\mathbf{x}, \\tau)$ 的一阶 ODE 系统来确定的。由于速度场 $\\mathbf{v}(\\mathbf{x},t)$ 是光滑的，为了保证准确性和效率，采用高阶显式积分器是合适的。我们选择经典的四阶 Runge-Kutta (RK4) 方法。对于一个 ODE $\\frac{d\\mathbf{y}}{d\\tau} = \\mathbf{f}(\\mathbf{y}, \\tau)$，从 $\\tau_n$ 到 $\\tau_{n+1}$ 的一个步长为 $h$ 的步进由以下公式给出：\n$$\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{h}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)$$\n其中\n$\\mathbf{k}_1 = \\mathbf{f}(\\mathbf{y}_n, \\tau_n)$\n$\\mathbf{k}_2 = \\mathbf{f}(\\mathbf{y}_n + \\frac{h}{2}\\mathbf{k}_1, \\tau_n + \\frac{h}{2})$\n$\\mathbf{k}_3 = \\mathbf{f}(\\mathbf{y}_n + \\frac{h}{2}\\mathbf{k}_2, \\tau_n + \\frac{h}{2})$\n$\\mathbf{k}_4 = \\mathbf{f}(\\mathbf{y}_n + h\\mathbf{k}_3, \\tau_n + h)$\n选择一个小的固定积分步长，例如 $\\Delta\\tau = 10^{-3} s$，以确保数值稳定性和对问题中存在的最高频率的解析。\n\n**3. 脉线构建**\n\n在观测时间 $T$ 的一条脉线是先前通过固定喷射点 $\\mathbf{x}_0$ 的粒子轨迹。为了构建离散近似，我们遵循以下定义：\n1. 在区间 $[T-\\tau_{\\max}, T]$ 内生成一组释放时间 $\\{t_r\\}$，其均匀间隔为 $\\Delta t_{\\text{rel}}$。\n2. 对于每个释放时间 $t_r$，通过积分 ODE $\\frac{d\\mathbf{x}}{dt} = \\mathbf{v}(\\mathbf{x}(t), t)$ 并使用初始条件 $\\mathbf{x}(t_r) = \\mathbf{x}_0$ 来计算粒子的轨迹（路径线）。积分从 $t=t_r$ 进行到 $t=T$。\n3. 存储每个粒子的最终位置 $\\mathbf{x}(T; t_r)$。\n4. 这些最终位置的有序集合 $\\{\\mathbf{x}(T; t_r)\\}$ 构成了离散脉线的多段线。其顺序由释放时间 $t_r$ 决定。\n\n**4. 流线构建**\n\n流线是在固定时刻 $T$ 处处与瞬时速度场相切的曲线。它是时间冻结速度场的积分曲线。\n1. 控制 ODE 为 $\\frac{d\\mathbf{x}}{d\\sigma} = \\mathbf{v}(\\mathbf{x}(\\sigma), T)$，其中 $\\sigma$ 是沿曲线的参数，具有时间量纲。请注意，右侧相对于 $\\sigma$ 是自治的。\n2. 从 $\\mathbf{x}(\\sigma=0) = \\mathbf{x}_0$ 开始，该 ODE 在区间 $[0, S_{\\max}]$ 上沿 $\\sigma$ 向前积分。\n3. 在每个积分步 $i$ 存储位置 $\\mathbf{x}(\\sigma_i)$，以形成离散流线多段线的点。\n\n**5. 离散 Hausdorff 距离**\n\n该问题要求对两条多段线 $P$ 和 $Q$ 之间的离散 Hausdorff 距离进行特定定义。一条多段线由一个顶点序列表示，这些顶点定义了一组连接的线段。该距离是两个有向距离的最大值。从多段线 $P$ 到多段线 $Q$ 的有向距离，记为 $\\vec{d}(P, Q)$，通过以下方式找到：\n1. 对于多段线 $P$ 的每个顶点 $p_i$，计算其到多段线 $Q$ 的最小 Euclidean 距离。这是通过找到从 $p_i$ 到构成 $Q$ 的任何线段的最小距离来完成的。\n2. 从一个点到一条线段的距离是最短距离，它要么是到该线段的某个端点的距离，要么是到包含该线段的直线的垂直投影的距离（如果该投影位于端点之间）。\n3. 在所有顶点 $p_i$ 上的这些最小距离的最大值给出了有向距离 $\\vec{d}(P, Q) = \\max_{p_i \\in P} \\left( \\min_{s_j \\in \\text{segments}(Q)} \\text{dist}(p_i, s_j) \\right)$。\n最终的 Hausdorff 距离是 $d_H(P, Q) = \\max(\\vec{d}(P, Q), \\vec{d}(Q, P))$。\n\n**6. 平均加速度大小**\n\n物质加速度的平均大小是沿生成的脉线在观测时间 $T$ 计算的。\n1. 对于离散脉线多段线的每个点（顶点）$\\mathbf{x}_k$，使用第1节中推导的解析公式计算物质加速度矢量 $\\mathbf{a}_k = \\mathbf{a}(\\mathbf{x}_k, T)$。\n2. 计算每个加速度矢量的大小 $\\|\\mathbf{a}_k\\|$。\n3. 计算这些大小的算术平均值：$\\bar{a} = \\frac{1}{N} \\sum_{k=1}^N \\|\\mathbf{a}_k\\|$，其中 $N$ 是离散脉线中的点数。\n\n这些步骤为解决所述问题提供了一个完整的框架。每个测试用例的计算都使用这些方法执行。", "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Main solver function to process test cases and produce the final output.\n    \"\"\"\n    \n    # Global constants for the velocity field model\n    U0 = 1.0  # m/s\n    w = 0.08  # m\n    Lf = 0.15 # m\n    c = 0.25  # m/s\n    x0 = np.array([0.0, 0.0]) # m\n    \n    # Numerical integration step size\n    dt_integ = 0.001 # s\n\n    # Test cases: (A, omega, phi, T, tau_max, dt_rel)\n    test_cases = [\n        (0.3, 4.0, 0.0, 2.0, 1.0, 0.02),\n        (0.0, 5.0, 0.0, 2.0, 1.0, 0.02),\n        (0.3, 20.0, 0.5, 1.2, 0.8, 0.01),\n    ]\n\n    all_results = []\n\n    # --- Kinematic Functions ---\n\n    def velocity(pos, t, A, omega, phi):\n        \"\"\"Computes the velocity vector v(pos, t).\"\"\"\n        x, y = pos\n        exp_y2 = np.exp(-(y**2) / w**2)\n        exp_x2 = np.exp(-(x**2) / Lf**2)\n        exp_xy = exp_x2 * exp_y2\n        \n        sin_wt = np.sin(omega * t)\n        \n        vx = U0 * exp_y2 * (1 + A * exp_x2 * sin_wt)\n        vy = A * c * exp_xy * np.sin(omega * t + phi)\n        \n        return np.array([vx, vy])\n\n    def acceleration(pos, t, A, omega, phi):\n        \"\"\"Computes the material acceleration vector a(pos, t).\"\"\"\n        x, y = pos\n        \n        exp_y2 = np.exp(-(y**2) / w**2)\n        exp_x2 = np.exp(-(x**2) / Lf**2)\n        exp_xy = exp_x2 * exp_y2\n\n        sin_wt = np.sin(omega * t)\n        cos_wt = np.cos(omega * t)\n        sin_wt_phi = np.sin(omega * t + phi)\n        cos_wt_phi = np.cos(omega * t + phi)\n        \n        # Velocity components\n        vx = U0 * exp_y2 * (1 + A * exp_x2 * sin_wt)\n        vy = A * c * exp_xy * sin_wt_phi\n        \n        # d/dt terms\n        dvx_dt = A * omega * U0 * exp_xy * cos_wt\n        dvy_dt = A * c * omega * exp_xy * cos_wt_phi\n\n        # d/dx terms\n        dvx_dx = -2 * A * U0 * x / Lf**2 * exp_xy * sin_wt\n        dvy_dx = -2 * A * c * x / Lf**2 * exp_xy * sin_wt_phi\n        \n        # d/dy terms\n        dvx_dy = -2 * y / w**2 * vx\n        dvy_dy = -2 * y / w**2 * vy\n        \n        # Acceleration components\n        ax = dvx_dt + vx * dvx_dx + vy * dvx_dy\n        ay = dvy_dt + vx * dvy_dx + vy * dvy_dy\n        \n        return np.array([ax, ay])\n\n    # --- Numerical Integration ---\n\n    def rk4_step(func, y, t, h, *args):\n        \"\"\"Performs a single step of the RK4 method.\"\"\"\n        k1 = func(y, t, *args)\n        k2 = func(y + 0.5 * h * k1, t + 0.5 * h, *args)\n        k3 = func(y + 0.5 * h * k2, t + 0.5 * h, *args)\n        k4 = func(y + h * k3, t + h, *args)\n        return y + (h / 6.0) * (k1 + 2*k2 + 2*k3 + k4)\n\n    # --- Polyline Construction ---\n\n    def construct_streakline(T, tau_max, dt_rel, A, omega, phi):\n        \"\"\"Constructs a discrete streakline at time T.\"\"\"\n        release_times = np.arange(T - tau_max, T + dt_rel/2, dt_rel)\n        streakline_points = []\n        \n        for t_r in release_times:\n            pos = np.copy(x0)\n            t = t_r\n            \n            integration_duration = T - t_r\n            if integration_duration == 0:\n                streakline_points.append(pos)\n                continue\n            \n            num_steps = math.ceil(integration_duration / dt_integ)\n            h = integration_duration / num_steps\n            \n            for _ in range(num_steps):\n                pos = rk4_step(velocity, pos, t, h, A, omega, phi)\n                t += h\n            streakline_points.append(pos)\n        \n        return np.array(streakline_points)\n\n    def construct_streamline(T, S_max, A, omega, phi):\n        \"\"\"Constructs a discrete streamline at time T.\"\"\"\n        streamline_points = [np.copy(x0)]\n        pos = np.copy(x0)\n        \n        def v_frozen(p, sigma): # sigma is a dummy variable\n            return velocity(p, T, A, omega, phi)\n\n        num_steps = math.ceil(S_max / dt_integ)\n        if num_steps == 0:\n            return np.array(streamline_points)\n        h = S_max / num_steps\n        sigma = 0.0\n\n        for _ in range(num_steps):\n            pos = rk4_step(v_frozen, pos, sigma, h)\n            sigma += h\n            streamline_points.append(pos)\n            \n        return np.array(streamline_points)\n\n    # --- Distance and Metric Calculation ---\n\n    def point_to_polyline_dist(point, polyline):\n        \"\"\"Calculates the minimum distance from a point to a polyline.\"\"\"\n        min_dist_sq = np.inf\n        for i in range(len(polyline) - 1):\n            p1, p2 = polyline[i], polyline[i+1]\n            line_vec = p2 - p1\n            pnt_vec = point - p1\n            line_len_sq = np.dot(line_vec, line_vec)\n            \n            if line_len_sq == 0.0:\n                dist_sq = np.dot(pnt_vec, pnt_vec)\n            else:\n                t = np.dot(pnt_vec, line_vec) / line_len_sq\n                t = np.clip(t, 0, 1)\n                closest_point = p1 + t * line_vec\n                dist_sq = np.sum((point - closest_point)**2)\n            \n            if dist_sq  min_dist_sq:\n                min_dist_sq = dist_sq\n        \n        return np.sqrt(min_dist_sq)\n\n    def discrete_hausdorff_distance(poly1, poly2):\n        \"\"\"Computes the discrete Hausdorff distance between two polylines.\"\"\"\n        if len(poly1)  2 or len(poly2)  2:\n            return 0.0\n            \n        d1 = max(point_to_polyline_dist(p, poly2) for p in poly1)\n        d2 = max(point_to_polyline_dist(p, poly1) for p in poly2)\n        return max(d1, d2)\n\n    def mean_acceleration_magnitude(streakline, T, A, omega, phi):\n        \"\"\"Computes mean acceleration magnitude on the streakline points.\"\"\"\n        if len(streakline) == 0:\n            return 0.0\n        \n        accel_mags = [np.linalg.norm(acceleration(p, T, A, omega, phi)) for p in streakline]\n        return np.mean(accel_mags)\n\n    # --- Main Loop ---\n\n    for case in test_cases:\n        A, omega, phi, T, tau_max, dt_rel = case\n        S_max = tau_max + 0.5\n        \n        # 1. Construct streakline\n        streakline = construct_streakline(T, tau_max, dt_rel, A, omega, phi)\n        \n        # 2. Construct streamline\n        streamline = construct_streamline(T, S_max, A, omega, phi)\n        \n        # 3. Compute Hausdorff distance\n        dist = discrete_hausdorff_distance(streakline, streamline)\n        \n        # 4. Compute mean acceleration magnitude\n        mean_accel = mean_acceleration_magnitude(streakline, T, A, omega, phi)\n        \n        all_results.append(f\"{dist:.6f}\")\n        all_results.append(f\"{mean_accel:.6f}\")\n\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "2659115"}]}