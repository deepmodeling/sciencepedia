## 引言
原子力显微镜（AFM）是纳米科技领域的基石工具之一，它赋予了科学家们在原子和分子尺度上“看见”并“触摸”物质的能力，彻底改变了我们对微观世界的认知。然而，从对AFM有一个概念性认识，到能够熟练运用其解决复杂科研问题之间，存在着一条深刻的知识鸿沟。许多使用者了解其基本成像功能，但对其背后的定量力学原理、多样的功能化成像模式以及数据解读中的关键细节缺乏系统性的理解。

本文旨在填补这一鸿沟，为读者提供一份关于AFM从原理到实践的全面指南。我们将分三章展开：第一章“原理与机制”将深入剖析AFM的核心，从[压电](@entry_id:268187)扫描器、悬臂梁力学到[反馈控制系统](@entry_id:274717)，揭示其实现纳米级探测的物理基础。第二章“应用与跨学科连接”将展示AFM的强大功能，通过实例介绍其在[材料科学](@entry_id:152226)、[生物物理学](@entry_id:154938)等领域如何绘制力学、电学、磁学性质图谱并操纵单个分子。最后，第三章“动手实践”将通过一系列计算和分析问题，巩固并应用前两章学到的核心概念。

通过这一结构化的学习路径，读者将不仅理解AFM“如何工作”，更将掌握其“为何如此工作”，从而能够自信地设计实验、解读数据，并将这一强大的工具应用于自己的研究前沿。现在，让我们从构成AFM工作基础的第一章“原理与机制”开始。

## 原理与机制

继前一章对[原子力显微镜](@entry_id:163411)（AFM）的基本介绍之后，本章将深入探讨其工作的核心原理与关键机制。我们将从构成AFM的基本硬件组件开始，解析其如何实现纳米级的精确定位与微[弱力](@entry_id:152942)学的[精密测量](@entry_id:145551)。随后，我们将系统地阐述针尖与样品之间多种复杂的相互作用力，这些力是AFM所有成像和测量功能的物理基础。在此基础上，我们将区分并详述AFM的几种主要工作模式，并揭示其背后的动力学原理。最后，我们将剖析AFM的“大脑”——[反馈控制系统](@entry_id:274717)，解释图像是如何形成的，并讨论高级成像模式以及影响最终图像真实性的主要因素。

### 核心部件及其功能

一台AFM的核心功能，即以极高分辨率“感知”并绘制样品表面，依赖于两个关键子系统的协同工作：一个用于精确移动探针的扫描器，以及一个用于探测探针微小响应的检测系统。

#### 扫描器：压[电[陶](@entry_id:187650)瓷](@entry_id:148626)实现精确定位

AFM能够在三维空间中实现亚纳米级精度的相对运动，其核心是**[压电](@entry_id:268187)扫描器**。这种扫描器通常由压[电陶瓷](@entry_id:187650)管制成，在外加电压下会发生可控的微小形变。通过对扫描器的不同电极施加电压，可以精确控制探针或样品在 $x$、$y$（横向）和 $z$（纵向）方向上的移动。

为了理解这种控制的精度，我们可以考虑一个典型的纵向（$z$轴）定位校准过程。[压电致动器](@entry_id:169515)的纵向位移 $\Delta z$ 通常与施加的电压 $V_z$ 成正比，其关系可由一个实验确定的**[压电](@entry_id:268187)响应系数** $\alpha_z$ 描述，即 $\Delta z = \alpha_z V_z$。例如，一个典型的 $\alpha_z$ 值可能为 $14.5 \text{ nm/V}$。电压本身由一个**[数模转换器 (DAC)](@entry_id:269050)** 提供，其分辨率决定了定位的最小步长。一个 $N=16$ 位的DAC可以将一个从 $0$ 到 $2^{16}-1$ 的整数输入 $D$ 线性地映射到其输出电压范围，例如 $[-10.0 \text{ V}, +10.0 \text{ V}]$。

在这种设置下，DAC的最小电压步长（对应于整数 $D$ 改变1）为 $\Delta V_{\text{LSB}} = \frac{2V_{\max}}{2^N-1}$。因此，要使探针移动一个特定的高度 $h$（例如一个已知高度为 $22.5 \text{ nm}$ 的台阶），所需的电压变化为 $\Delta V_z = h / \alpha_z$。这对应于DAC输入整数值的变化量 $\Delta D = \Delta V_z / \Delta V_{\text{LSB}}$。通过计算，我们可以确定实现特定位移所需的精确数字指令 [@problem_id:1761829]。这个例子凸显了AFM硬件的精密本质：通过数字电压信号对物理世界的纳米级操控。

#### 检测系统：光学杠杆

AFM的另一项核心技术是检测[悬臂梁](@entry_id:174096)的微小弯曲。最广泛使用的方法是**光学杠杆**（optical lever）系统。其工作原理如下：一束[激光](@entry_id:194225)（LASER）聚焦在悬臂梁自由端的背面，反射后投射到一个**四象限[光电二极管](@entry_id:270637) (QPD)** 上。当针尖与样品相互作用导致悬臂梁发生弯曲时，其背面的局部**斜率**（slope）会发生改变。

根据[反射定律](@entry_id:175197)，如果[悬臂梁](@entry_id:174096)的斜率改变了角度 $\phi$，反射光束的偏转角将是 $2\phi$。经过一段长度为 $L_{\mathrm{bd}}$ 的光路后，这个角度偏转会在QPD上产生一个光斑位移 $\Delta x_{\mathrm{det}} \approx 2 L_{\mathrm{bd}} \phi$（在[小角度近似](@entry_id:145423)下）。QPD被设计用来检测光斑位置的变化。通过计算上下两个象限（或左右两个象限）光强的差异，QPD及其后续电路可以输出一个与光斑位移成正比的差分电压 $V$。这种关系由QPD的**位置[响应度](@entry_id:267762)** $\alpha$（单位通常为 V/μm）来量化，即 $V = \alpha \Delta x_{\mathrm{det}}$。

将这些环节联系起来，我们得到悬臂梁的斜率变化与输出电压之间的关系：$V = 2 \alpha L_{\mathrm{bd}} \phi$。然而，我们最终关心的是针尖的**垂直位移** $z$，而不是斜率 $\phi$。对于一个末端受力的标准矩形悬臂梁，根据**[欧拉-伯努利梁理论](@entry_id:177359)**，其末端位移 $z$ 和斜率 $\phi$ 之间存在一个纯粹的几何关系：$\phi = \frac{3}{2} \frac{z}{L_c}$，其中 $L_c$ 是悬臂梁的长度。

综合以上关系，我们可以推导出针尖位移 $z$ 和检测器电压 $V$ 之间的关系，并定义一个至关重要的校准参数——**偏转灵敏度**（deflection sensitivity），其单位为 nm/V：
$$ \text{偏转灵敏度} = \frac{z}{V} = \frac{L_c}{3 \alpha L_{\mathrm{bd}}} $$
这个值可以通过在硬质样品上按压针尖并测量电压随压[电位移](@entry_id:269383)的变化[曲线的斜率](@entry_id:178976)来实验确定。值得注意的是，该灵敏度只依赖于系统的几何参数（$L_c, L_{\mathrm{bd}}$）和探测器响应（$\alpha$），而与[悬臂梁](@entry_id:174096)的材料性质（如弹性模量）无关 [@problem_id:2782764]。

### 探针：一种机械传感器

AFM的探针，即一个末端带有尖锐针尖的微型悬臂梁，是系统的核心传感器。它将针尖与样品间的微弱相互作用力转化为可测量的机械形变。为了进行定量分析，理解其力学特性至关重要。

#### 悬臂梁力学：[弹簧常数](@entry_id:167197)

在最简单的模型中，[悬臂梁](@entry_id:174096)可以被视为一个遵循[胡克定律](@entry_id:149682)的理想弹簧。其最重要的力学参数是**法向弹簧常数** $k$，它定义为施加在针尖上的法向力 $F$ 与由此产生的法向偏转 $z$ 之比，即 $F = kz$。这个参数决定了悬臂梁的“软硬”，是进行力谱测量和从偏转计算作用力的关键。

弹簧常数 $k$ 由[悬臂梁](@entry_id:174096)的材料性质和几何形状决定。对于一个长度为 $L$、宽度为 $b$、厚度为 $t$ 的均匀矩形悬臂梁，根据**[欧拉-伯努利梁理论](@entry_id:177359)**，其法向[弹簧常数](@entry_id:167197)可以通过以下公式计算 [@problem_id:2801565]：
$$ k = \frac{Ebt^3}{4L^3} $$
其中，$E$ 是[悬臂梁](@entry_id:174096)材料的**[杨氏模量](@entry_id:140430)**（Young's modulus），表征材料的刚度。$I$ 是梁[横截面](@entry_id:154995)关于中性轴的**面积二次矩**（second moment of area），它描述了[横截面](@entry_id:154995)的形状如何影响其抗[弯曲能](@entry_id:174691)力。对于法向（垂直于平面）的弯曲，矩形[截面](@entry_id:154995)的面积二次矩为：
$$ I = \frac{bt^3}{12} $$
将 $I$ 代入 $k$ 的表达式，我们得到：
$$ k = \frac{Ebt^3}{4L^3} $$
这个公式清晰地揭示了[弹簧常数](@entry_id:167197)与各参数的依赖关系。它对厚度 $t$ 的三次方极其敏感，这意味着悬臂梁厚度的微小变化会极大地影响其弹簧常数。而它与长度 $L$ 的三次方成反比，说明较长的[悬臂梁](@entry_id:174096)会更“软”。在实际应用中，精确知道 $k$ 值对于将AFM从一个成像工具转变为一个定量力学测量工具至关重要。

### 针尖-样品相互作用：衬度的来源

AFM之所以能够“看见”表面，是因为其针尖能够“感觉”到来自样品表面的各种力。这些**针尖-样品相互作用力**是所有AFM模式中衬度（contrast）的物理来源。这些力的性质复杂多样，通常可以分为长程吸[引力](@entry_id:175476)和短程排斥力。

#### 相互作用[力场](@entry_id:147325)

我们可以用一个类似于[Lennard-Jones势](@entry_id:143105)的势能曲线来定性地描述针尖与样品原子间的相互作用。当针尖距离样品非常远时，相互作用力几乎为零。当针尖靠近时，首先进入**长程吸引区**，这主要源于[范德华力](@entry_id:145564)。随着距离进一步减小，当针尖的电子云与样品的电子云开始重叠时，**[泡利不相容原理](@entry_id:141850)**（Pauli exclusion principle）导致了极强的**短程排斥力**。在这两种力的共同作用下，存在一个[势能](@entry_id:748988)最低点，对应于吸[引力](@entry_id:175476)与排斥力相平衡的位置。AFM的不同工作模式就是通过有选择性地探测这些不同区域的力来实现的 [@problem_id:1761841]。

#### 作用力分类

在实际的AFM实验中，尤其是在大气环境下，多种力会同时存在。理解并控制这些力是获取高质量、可解释数据的关键。最主要的三种力包括 [@problem_id:2801562]：

1.  **[范德华力](@entry_id:145564) (Van der Waals Force)**：这是普遍存在于所有物质间的力，源于原子或分子间瞬时偶极-[诱导偶极](@entry_id:143340)的相互作用。在AFM中，通常采用一个球形针尖（半径为 $R$）与一个平面样品的模型来描述。在非延迟（non-retarded）极限下，即针尖-样品距离 $d \ll R$ 时，[范德华力](@entry_id:145564)为吸[引力](@entry_id:175476)，其大小为：
    $$ F_{vdW}(d) = -\frac{AR}{6d^2} $$
    这里的 $A$ 是**[哈梅克常数](@entry_id:197237) (Hamaker constant)**，它取决于针尖、样品以及两者之间介质的材料性质。可见，范德华力随距离的减小而迅速增强。

2.  **静电力 (Electrostatic Force)**：当针尖与样品之间存在电势差时，就会产生静电力。这个[电势差](@entry_id:275724)可能来自于外部施加的偏压 $V_{dc}$，也可能源于两者材料[功函数](@entry_id:143004)不同而产生的**[接触电势差](@entry_id:187064) (Contact Potential Difference, $V_{CPD}$)**。针尖-样品系统可以被看作一个[电容器](@entry_id:267364)，其电容 $C(z)$ 随距离 $z$ 变化。[静电力](@entry_id:203379)可以表示为：
    $$ F_{es}(z) = \frac{1}{2}\frac{\partial C}{\partial z}(V_{dc} - V_{CPD})^2 $$
    由于电容随距离减小而增大，$\partial C / \partial z$ 为负值，因此[静电力](@entry_id:203379)通常是吸[引力](@entry_id:175476)。通过调节 $V_{dc}$ 来补偿 $V_{CPD}$，可以使静电力最小化。这一原理是**[开尔文探针力显微镜](@entry_id:264191) (KPFM)** 的基础，用于测量表面的[功函数](@entry_id:143004)或表面[电势](@entry_id:267554)。

3.  **[毛细力](@entry_id:181817) (Capillary Force)**：在空气等非真空环境中，由于空气中存在水蒸气，当针尖足够靠近甚至接触样品时，会在针尖和样品之间形成一个纳米尺度的水桥（弯月面）。这个水桥的表面张力会产生一个强大的吸[引力](@entry_id:175476)，即[毛细力](@entry_id:181817)。其最大值（即[拉脱力](@entry_id:194410)）可近似为：
    $$ F_{cap} \approx 4\pi R\gamma \cos\theta $$
    其中 $\gamma$ 是水的表面张力，$ \theta $ 是水在样品表面的[接触角](@entry_id:145614)。[毛细力](@entry_id:181817)通常是大气环境下AFM中最强的吸[引力](@entry_id:175476)，它的大小与空气湿度密切相关，但在[超高真空](@entry_id:196222)（UHV）中会完全消失。

### 工作模式：探测相互作用

为了适应不同的样品性质和研究目的，AFM发展出了多种工作模式。这些模式的核心区别在于它们如何利用上述的针尖-样品相互作用力。最基本的三种模式是接触模式、非接触模式和[轻敲模式](@entry_id:263659)。

#### 静态（接触）模式

在**接触模式 (Contact Mode)** 中，AFM针尖在扫描过程中始终与样品表面保持物理接触。这意味着针尖工作在相互作用势能曲线的**强排斥力区**。[反馈系统](@entry_id:268816)通过调节Z向压[电[陶](@entry_id:187650)瓷](@entry_id:148626)的高度，来维持悬臂梁的**恒定偏转**，即维持恒定的排斥力。这种模式的优点是扫描速度快、信噪比高。然而，由于针尖与样品间存在较大的[法向力](@entry_id:174233)和横向[摩擦力](@entry_id:171772)，它容易对软、易损的样品造成损伤，或在扫描过程中移动样品上的吸附物。

#### 动态模式：概述

为了克服接触模式的缺点，**动态模式**被发展出来。在所有动态模式中，悬臂梁不再是静止的，而是被一个驱动源（通常是[压电](@entry_id:268187)片）以接近其共振频率的频率进行[振动](@entry_id:267781)。当[振动](@entry_id:267781)的针尖靠近样品表面时，针尖-样品相互作用力会改变[悬臂梁](@entry_id:174096)的[振动](@entry_id:267781)状态（如振幅、频率、相位）。通过检测这些变化，AFM可以获得关于表面形貌和性质的信息。

#### 运动方程

动态模式下[悬臂梁](@entry_id:174096)的运动可以被一个**[受驱阻尼谐振子](@entry_id:165087) (driven, damped harmonic oscillator)** 模型来描述。其[运动方程](@entry_id:170720)为 [@problem_id:2782740]：
$$ m_{\mathrm{eff}} \ddot{z} + \gamma \dot{z} + k z = F_{\mathrm{drive}}(t) + F_{\mathrm{ts}}(z, \dot{z}) $$
这里：
- $z(t)$ 是悬臂梁相对于其静态[平衡位置](@entry_id:272392)的位移。
- $m_{\mathrm{eff}}$ 是悬臂梁在该[振动](@entry_id:267781)模式下的**[有效质量](@entry_id:142879)**，它通常是悬臂梁总质量的一个分数。
- $\gamma$ 是**[阻尼系数](@entry_id:163719)**，代表了[悬臂梁](@entry_id:174096)与周围环境的[能量耗散](@entry_id:147406)（如空气阻力）和内部摩擦。
- $k$ 是[悬臂梁](@entry_id:174096)的弹簧常数。
- $F_{\mathrm{drive}}(t)$ 是外部施加的周期性驱动力。
- $F_{\mathrm{ts}}(z, \dot{z})$ 是针尖-样品相互作用力，它可能既依赖于距离 $z$（保守力），也依赖于速度 $\dot{z}$（[耗散力](@entry_id:166970)）。

当[悬臂梁](@entry_id:174096)远离样品表面时， $F_{\mathrm{ts}} \approx 0$，我们称之为**自由[振荡](@entry_id:267781) (free)** 状态。此时，[振荡器](@entry_id:271549)的固有共振频率为 $\omega_0 = \sqrt{k/m_{\mathrm{eff}}}$，其**品质因子 (Quality Factor)** $Q = m_{\mathrm{eff}} \omega_0 / \gamma$ 是衡量阻尼大小的无量纲参数。当悬臂梁靠近样品， $F_{\mathrm{ts}} \neq 0$ 时，我们称之为**啮合 (engaged)** 状态。$F_{\mathrm{ts}}$ 的存在会有效地改变系统的刚度（通过 $\partial F_{\mathrm{ts}} / \partial z$）和阻尼，从而导致[振动](@entry_id:267781)参数的变化。

#### 非接触模式

在**非接触模式 (Non-Contact Mode)** 中，[悬臂梁](@entry_id:174096)在样品表面上方[振动](@entry_id:267781)，但其振幅较小，以至于在整个[振动](@entry_id:267781)周期内针尖都**不与样品发生物理接触**。这意味着针尖始终工作在相互作用[势能曲线](@entry_id:178979)的**长程吸[引力](@entry_id:175476)区**。吸[引力](@entry_id:175476)及其梯度会改变悬臂梁的[有效弹簧常数](@entry_id:171743)，从而导致其[共振频率](@entry_id:265742)发生微小的偏移。通过检测这个频率偏移，[反馈系统](@entry_id:268816)可以维持恒定的针尖-样品距离。由于没有接触，这种模式对样品的损伤几乎为零，非常适合于观测原子尺度的周期性结构，尤其是在[超高真空](@entry_id:196222)环境下。

#### [调幅](@entry_id:266006)（轻敲）模式

**[轻敲模式](@entry_id:263659) (Tapping Mode™)**，或更普遍地称为**[调幅](@entry_id:266006)模式 (Amplitude-Modulation, AM-AFM)**，是目前应用最广泛的AFM模式。在这种模式下，[悬臂梁](@entry_id:174096)被驱动以较大的振幅（通常为几十纳米）[振动](@entry_id:267781)。当针尖-样品距离减小时，针尖在每个[振荡周期](@entry_id:271387)的最低点会**间歇性地“轻敲”样品表面** [@problem_id:1761841]。这意味着针尖的相互作用在长程吸[引力](@entry_id:175476)和短程排斥力之间循环切换。

与接触模式相比，[轻敲模式](@entry_id:263659)大大减小了作用在样品上的横向剪切力，因此对软样品的损伤要小得多。与非接触模式相比，它对力的变化更敏感，在空气中操作也更稳定（因为它能有效克服[毛细力](@entry_id:181817)的影响）。

### AFM的大脑：[反馈回路](@entry_id:273536)与图像形成

AFM之所以能够生成图像，核心在于一个高速、精密的**闭环[反馈系统](@entry_id:268816)**。这个系统就像AFM的“大脑”，它实时监测探针的状态，并指挥扫描器做出响应，从而维持一种恒定的针尖-样品相互作用。

#### [PID控制器](@entry_id:268708)

AFM中最常用的反馈控制器是**PID（[比例-积分-微分](@entry_id:174286)）控制器**。它的任务是尽可能快而准地消除**误差信号** $e(t)$。误差信号定义为用户设定的**设定点 (Setpoint, SP)** 与实时测量的**过程变量 (Process Variable, PV)** 之间的差值，即 $e(t) = SP - PV(t)$。[PID控制器](@entry_id:268708)根据这个误差信号计算出一个输出信号 $u(t)$，指令Z向压[电陶瓷](@entry_id:187650)移动 [@problem_id:2468685]：
$$ u(t) = K_p e(t) + K_i \int_{0}^{t} e(\tau) d\tau + K_d \frac{de(t)}{dt} $$
- **比例 (P) 项**：提供一个与当前误差成正比的校正，是反馈的主要驱动力。
- **积分 (I) 项**：累积过去的误差。它的主要作用是消除**[稳态误差](@entry_id:271143)**，确保即使在面对缓慢漂移或恒定偏移时，系统也能精确地达到设定点。这对于准确追踪表面形貌至关重要。
- **[微分](@entry_id:158718) (D) 项**：响应误差的变化率。它起到预测和阻尼的作用，可以减少系统的过冲和[振荡](@entry_id:267781)，提高[反馈回路](@entry_id:273536)的稳定性。

在扫描过程中，AFM记录下[PID控制器](@entry_id:268708)的输出信号（即Z向压[电[陶](@entry_id:187650)瓷](@entry_id:148626)的高度）作为每个 $(x, y)$ 位置的高度值，最终汇成一幅三维的**形貌图**。

#### 设定点与相互作用强度

设定点（Setpoint）的物理意义取决于所选的工作模式，它直接控制了针尖与样品相互作用的强度 [@problem_id:2468685]。

- 在**接触模式**下，过程变量是[悬臂梁](@entry_id:174096)的静态偏转 $d$。设定点 $d_{\text{set}}$ 就是一个目标偏转值。由于法向力 $F_N \approx k d$，**增加偏转[设定点](@entry_id:154422)意味着增加作用在样品上的[法向力](@entry_id:174233)**，即更强的相互作用。

- 在**[调幅](@entry_id:266006)（轻敲）模式**下，过程变量是[悬臂梁](@entry_id:174096)的[振动](@entry_id:267781)**振幅** $A$。[设定点](@entry_id:154422) $A_{\text{sp}}$ 是一个目标振幅值，通常表示为自由振幅 $A_0$ 的一个比率，即 $A_{\text{sp}}/A_0$。当针尖与样品相互作用时，能量被耗散，振幅会从 $A_0$ 减小到 $A$。振幅减小得越多，表示相互作用越强。因此，**减小振幅[设定点](@entry_id:154422)（即选择一个更小的 $A_{\text{sp}}/A_0$ 比率）意味着让针尖与样品发生更强的相互作用**（更“硬”的轻敲）。反之，将 $A_{\text{sp}}$ 设得更接近 $A_0$ 则对应更“软”、更弱的相互作用。

#### [轻敲模式](@entry_id:263659)成像：形貌与相位

[轻敲模式](@entry_id:263659)的一个强大之处在于它能同时提供多种[信息通道](@entry_id:266393)。当[反馈回路](@entry_id:273536)工作时，它通过调节Z向高度来保持振幅 $A$ 等于设定值 $A_{\text{sp}}$。这个Z向高度信号构成了**形貌图像** (topography)。

与此同时，悬臂梁的**相位** $\phi$（[振动](@entry_id:267781)相对于驱动力的延迟）也在被连续记录。相位信号对针尖-样品相互作用中的**[能量耗散](@entry_id:147406)**过程非常敏感。可以证明，在振幅和驱动参数固定的情况下，驱动源输入系统的平均功率与 $\sin\phi$ 成正比。这部分功率必须平衡掉系统的总能量耗-散，包括[悬臂梁](@entry_id:174096)的内禀耗散和针尖-样品相互作用引起的额外耗散。因此，当针尖扫过具有不同[粘弹性](@entry_id:148045)、附着力或[摩擦力](@entry_id:171772)的区域时，能量耗散会发生变化，这会直接反映为相位的变化。

因此，**[相位图](@entry_id:264603)像 (phase image)** 提供了一种与形貌无关的材料衬度，能够揭示样品表面的化学成分、机械性能（如粘弹性、硬度）或电学性质的[分布](@entry_id:182848) [@problem_id:2782757]。这使得[轻敲模式](@entry_id:263659)成为研究[复合材料](@entry_id:139856)、聚合物和生物样品等复杂体系的强大工具。

### 高级动态模式：[频率调制](@entry_id:162932)AFM

除了[调幅](@entry_id:266006)模式（AM-AFM），另一种重要的动态模式是**[频率调制](@entry_id:162932)AFM (FM-AFM)**。这种技术，特别是在[超高真空](@entry_id:196222)环境下，是实现真正原子级分辨率的关键。

#### FM-[AFM原理](@entry_id:186754)

与AM-AFM通过监测振幅变化来成像不同，FM-AFM的核心可观测量是悬臂梁**[共振频率](@entry_id:265742)的偏移** $\Delta f$。当[振动](@entry_id:267781)的针尖靠近样品时，保守的针尖-样品相互作用力梯度会改变悬臂梁的[有效弹簧常数](@entry_id:171743)，从而使其[共振频率](@entry_id:265742)发生变化。

#### 力梯度探测

我们可以通过分析悬臂梁的[运动方程](@entry_id:170720)来理解这一点。保守的针尖-样品相互作用力 $F_{\mathrm{ts}}$ 的梯度 $k_{\mathrm{int}} = \partial F_{\mathrm{ts}} / \partial z$ 相当于一个额外的“弹簧”，它与悬臂梁自身的弹簧常数 $k$ [串联](@entry_id:141009)或并联，导致[有效弹簧常数](@entry_id:171743)变为 $k_{\mathrm{eff}} = k - k_{\mathrm{int}}$。这会导致[共振频率](@entry_id:265742)发生偏移。在一阶近似下，[频率偏移](@entry_id:266447) $\Delta f$ 与力梯度之间存在一个简单的关系 [@problem_id:2782743]：
$$ \Delta f = f - f_0 \approx -\frac{f_0}{2k} \left\langle \frac{\partial F_{\mathrm{ts}}}{\partial z} \right\rangle $$
其中 $f_0$ 是自由共振频率，而尖括号表示在整个[振动](@entry_id:267781)周期内[对力](@entry_id:159909)梯度的加权平均。这个公式表明，**FM-AFM直接测量的是针尖-样品相互作用力的梯度**。一个吸[引力](@entry_id:175476)（随距离减小而增强，因此 $\partial F_{\mathrm{ts}} / \partial z > 0$）会导致频率负向偏移（$\Delta f  0$），而一个排斥力梯度则会导致频率正向偏移。

#### 自激[振荡](@entry_id:267781)回路

为了精确测量 $\Delta f$，FM-AFM采用了一个巧妙的**自激[振荡](@entry_id:267781)回路**（self-oscillation loop）。这个回路将悬臂梁本身作为[振荡器](@entry_id:271549)的一个元件。它实时检测悬臂梁的[振动](@entry_id:267781)信号，通过一个**移相器**（phase shifter）将信号移动一个特定的相位（通常是 $90^\circ$），然后用这个信号来驱动[悬臂梁](@entry_id:174096)。这个正反馈回路的[振荡条件](@entry_id:262777)是总环路相移为 $2\pi$ 的整数倍，这将迫使系统始终在悬臂梁的**瞬时[共振频率](@entry_id:265742)**下[振荡](@entry_id:267781)。因此，通过一个频率计数器，就可以直接读出频率偏移 $\Delta f$。

同时，回路中还有一个**[自动增益控制](@entry_id:265863)器 (AGC)**，它会调节驱动信号的幅度，以保持[悬臂梁](@entry_id:174096)的[振动](@entry_id:267781)**振幅恒定**。如果存在[耗散性](@entry_id:162959)的针尖-样品相互作用（如原子尺度的摩擦），AGC需要提供更大的驱动能量来补偿，因此AGC的输出信号就成了测量[耗散力](@entry_id:166970)的通道。这样，FM-AFM巧妙地将[保守力](@entry_id:170586)（通过 $\Delta f$）和[耗散力](@entry_id:166970)（通过AGC信号）分离开来 [@problem_id:2782743]。在成像时，反馈系统调节Z向高度以维持 $\Delta f$ 恒定，从而生成力梯度的[等值面](@entry_id:196027)图像。

### 理解图像：伪影与分辨率

AFM图像并非样品表面的完美复制品，而是针尖与样品相互作用的结果。理解图像的形成过程对于正确解读图像和识别**伪影**（artifacts）至关重要。最基本、最普遍的伪影来源于针尖的有限尺寸。

#### [针尖-样品卷积](@entry_id:188759)效应

在理想的几何极限下，我们可以忽略力的复杂性和样品的形变，将成像过程看作是一个纯粹的几何问题。由于针尖具有非零的尺寸和特定的形状，AFM图像并不是样品表面的真实轮廓，而是样品表面与**针尖形状**发生**卷积**（convolution）或更准确地说是**[形态学](@entry_id:273085)膨胀**（morphological dilation）的结果 [@problem_tgo_2782778]。

其基本原理是：在每个扫描点，AFM记录的高度是针尖的最高点（apex）在该位置时，针尖体恰好接触到样品表面的高度。这意味着，当扫描一个凸起特征时，接触点可能并非在针尖的顶点，而是在针尖的侧面。反之，当扫描一个凹陷特征时，如果针尖不够尖锐，它可能无法探到底部，而是被凹陷的边缘“架住”。

#### 特征展宽

[针尖卷积](@entry_id:267613)最直接的后果是**特征展宽**（feature broadening）。任何比针尖尖锐的样品特征在图像中都会呈现出针尖的形状。例如，一个理想的陡峭台阶会被展宽为一个具有一定[曲率半径](@entry_id:274690)的斜坡；一个孤立的纳米颗粒或柱状物会显得比实际更“胖”。

我们可以用一个简单的模型来量化这种效应。考虑一个半径为 $R$ 的球形针尖扫描一个位于平坦基底上、高度为 $h$ 的无限细的垂直柱。[几何分析](@entry_id:157700)表明，在AFM图像中，这个柱子的表观宽度 $w_{\text{app}}$ 为 [@problem_id:2782778]：
$$ w_{\text{app}} = 2\sqrt{2Rh - h^2} $$
例如，对于一个半径 $R=10 \text{ nm}$ 的针尖和一个高度 $h=5 \text{ nm}$ 的特征，其表观宽度约为 $17.3 \text{ nm}$。这个公式清晰地表明，展宽效应随着针尖半径 $R$ 的增大而加剧。因此，使用尽可能尖锐的探针是提高AFM横向分辨率的关键。反过来，如果已知样品上某个特征的精确形状，也可以通过分析其在AFM图像中的表观形状来反推出针尖的曲率半径。