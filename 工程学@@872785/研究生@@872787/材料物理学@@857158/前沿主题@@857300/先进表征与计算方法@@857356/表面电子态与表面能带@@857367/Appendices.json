{"hands_on_practices": [{"introduction": "在分析表面电子性质之前，我们必须首先理解其在倒易空间中的晶体结构。本练习将指导您从第一性原理出发，为面心立方（fcc）晶体常见的 (111) 表面构建其表面布里渊区（SBZ）。掌握这一几何框架对于解读表面能带结构以及角分辨光电子能谱（ARPES）等实验数据至关重要。[@problem_id:2863764]", "problem": "考虑一个面心立方（fcc）晶体的洁净、未重构表面，其常规立方晶格常数为 $a$，表面法线沿密勒指数 $(111)$ 方向。二维表面布拉维晶格由连接 $(111)$ 平面内最近邻晶格点的面内原胞基矢生成。表面布里渊区（SBZ）定义为由相应表面倒易矢量张成的二维倒易晶格的维格纳-赛兹原胞。高对称点 $\\bar{M}$ 是一个 SBZ 边界的中点，而 $\\bar{\\Gamma}$ 是 SBZ 的中心。\n\n从倒易晶格的标准定义（即对于实空间原胞基矢 $\\mathbf{t}_j$，倒易矢量 $\\mathbf{g}_i$ 满足 $\\mathbf{g}_i \\cdot \\mathbf{t}_j = 2\\pi \\delta_{ij}$）和布里渊区的定义（即布里渊区是比其他任何倒易晶格点更靠近原点的点的集合）出发，完成以下任务：\n\n- 为该 fcc 晶体的 $(111)$ 表面构建一对最短的、线性无关的面内原胞基矢 $\\mathbf{t}_1$ 和 $\\mathbf{t}_2$，并用 $a$ 表示。\n- 仅使用基本定义，确定从 $\\bar{\\Gamma}$ 到 $\\bar{M}$ 的 SBZ 矢量的大小。\n\n将你的最终答案表示为以 $a$ 为变量的闭式解析表达式。假设 $a$ 的单位是米，并以倒易米为单位报告其大小。最终答案中不要包含单位。", "solution": "所给出的问题陈述是固态物理学中的一个标准的、适定的问题。它具有科学依据、内容自洽且客观。所有术语在该学科内都有明确的定义。因此，该问题是有效的，我们将继续进行解答。\n\n该问题要求确定面心立方（fcc）晶体 $(111)$ 表面的表面布里渊区（SBZ）中，从中心 $\\bar{\\Gamma}$ 到高对称点 $\\bar{M}$ 的矢量的大小。\n\n首先，我们必须为 $(111)$ 表面的二维布拉维晶格构建实空间原胞基矢 $\\mathbf{t}_1$ 和 $\\mathbf{t}_2$。我们建立一个笛卡尔坐标系，其坐标轴与边长为 $a$ 的常规立方晶胞的轴对齐。fcc 结构的晶格点由矢量 $\\mathbf{R} = ia\\hat{x} + ja\\hat{y} + ka\\hat{z}$ 给出，其中 $i,j,k$ 为整数，在此基础上我们添加一个包含四个原子的基元，其位置分别为 $\\mathbf{0}$、$\\frac{a}{2}(\\hat{x}+\\hat{y})$、$\\frac{a}{2}(\\hat{x}+\\hat{z})$ 和 $\\frac{a}{2}(\\hat{y}+\\hat{z})$。连接任意两个晶格点的矢量是一个晶格矢量。表面的原胞基矢必须连接 $(111)$ 平面内的最近邻原子。\n\n如果一个矢量 $\\mathbf{v}$ 与平面法线 $\\mathbf{n} = \\hat{x}+\\hat{y}+\\hat{z}$ 的点积为零，则该矢量位于一个平行于 $(111)$ 平面的平面内。fcc 结构中最短的非零晶格矢量（连接最近邻）的形式为 $\\frac{a}{2}(\\pm 1, \\pm 1, 0)$ 及其置换。这些矢量的长度平方为 $(\\frac{a}{2})^2(1^2+1^2) = \\frac{a^2}{2}$。因此，最近邻距离为 $\\frac{a}{\\sqrt{2}}$。\n\n我们必须找到长度为此值且与 $\\mathbf{n}=(1,1,1)$ 正交的矢量。考虑连接原点处原子与其 12 个最近邻的矢量集合。例如，$\\mathbf{v} = \\frac{a}{2}(1,1,0)$。这是一个从角原子到面心原子的矢量。连接两个面心原子的矢量，例如位于 $\\mathbf{p}_1 = \\frac{a}{2}(1,1,0)$ 和 $\\mathbf{p}_2 = \\frac{a}{2}(1,0,1)$ 的原子，由 $\\mathbf{v}' = \\mathbf{p}_2 - \\mathbf{p}_1 = \\frac{a}{2}(0,-1,1)$ 给出。\n让我们检查这个矢量是否满足条件。\n1. 它是一个连接两个 fcc 晶格点的有效晶格矢量。\n2. 其大小为 $|\\mathbf{v}'| = \\frac{a}{2}\\sqrt{0^2+(-1)^2+1^2} = \\frac{a}{\\sqrt{2}}$，即最近邻距离。\n3. 它与法线 $\\mathbf{n}=(1,1,1)$ 的点积为 $\\mathbf{v}' \\cdot \\mathbf{n} = \\frac{a}{2}(0 \\cdot 1 + (-1) \\cdot 1 + 1 \\cdot 1) = 0$。它位于一个 $(111)$ 型平面内。\n\n因此，这类矢量是表面晶格的原胞基矢。我们需要两个这样的线性无关矢量。六个最短的面内矢量是 $\\frac{a}{2}(\\pm 1, \\mp 1, 0)$、$\\frac{a}{2}(\\pm 1, 0, \\mp 1)$ 和 $\\frac{a}{2}(0, \\pm 1, \\mp 1)$。我们选择一对夹角为 $60^\\circ$（$\\pi/3$ 弧度）的矢量来定义原胞。我们选择：\n$$ \\mathbf{t}_1 = \\frac{a}{2}(1, -1, 0) $$\n$$ \\mathbf{t}_2 = \\frac{a}{2}(1, 0, -1) $$\n它们的大小均为 $|\\mathbf{t}_1| = |\\mathbf{t}_2| = \\frac{a}{\\sqrt{2}}$。它们之间的夹角 $\\theta$ 可以通过点积求得：\n$$ \\cos\\theta = \\frac{\\mathbf{t}_1 \\cdot \\mathbf{t}_2}{|\\mathbf{t}_1||\\mathbf{t}_2|} = \\frac{\\frac{a^2}{4}(1 \\cdot 1 + (-1) \\cdot 0 + 0 \\cdot (-1))}{(\\frac{a}{\\sqrt{2}})(\\frac{a}{\\sqrt{2}})} = \\frac{a^2/4}{a^2/2} = \\frac{1}{2} $$\n所以，$\\theta = \\frac{\\pi}{3}$ 或 $60^\\circ$。这些矢量构成了六角形表面晶格的一组有效的原胞基矢。\n\n接下来，我们构建倒易晶格矢量 $\\mathbf{g}_1$ 和 $\\mathbf{g}_2$，它们与 $\\mathbf{t}_1$ 和 $\\mathbf{t}_2$ 位于同一平面内。它们满足关系 $\\mathbf{g}_i \\cdot \\mathbf{t}_j = 2\\pi \\delta_{ij}$。对于二维晶格，原胞倒易矢量的大小由 $g = |\\mathbf{g}_1| = |\\mathbf{g}_2| = \\frac{2\\pi}{t \\sin\\theta}$ 给出，其中 $t = |\\mathbf{t}_1| = |\\mathbf{t}_2|$。\n代入已知值 $t=\\frac{a}{\\sqrt{2}}$ 和 $\\sin\\theta = \\sin(60^\\circ) = \\frac{\\sqrt{3}}{2}$：\n$$ g = \\frac{2\\pi}{\\left(\\frac{a}{\\sqrt{2}}\\right)\\left(\\frac{\\sqrt{3}}{2}\\right)} = \\frac{4\\pi}{\\frac{a\\sqrt{3}}{\\sqrt{2}}} = \\frac{4\\pi\\sqrt{2}}{a\\sqrt{3}} = \\frac{4\\pi\\sqrt{6}}{3a} $$\n六角形实空间晶格的倒易晶格也是一个六角形晶格，旋转了 $30^\\circ$。定义第一个 SBZ 的六个最短非零倒易晶格矢量都具有这个大小 $g$。\n\nSBZ 是倒易晶格的维格纳-赛兹原胞。对于六角形晶格，SBZ 是一个六边形。SBZ 的中心是 $\\bar{\\Gamma}$ 点，即倒易空间的原点。六边形 SBZ 的边界是从原点到六个最近邻倒易晶格点的矢量的垂直平分线段。$\\bar{M}$ 点定义为这样一条边界的中点。\n从原点（$\\bar{\\Gamma}$）到矢量 $\\mathbf{G}$ 的垂直平分线的距离是 $\\frac{1}{2}|\\mathbf{G}|$。因此，从 $\\bar{\\Gamma}$ 到 $\\bar{M}$ 的矢量沿着最短倒易晶格矢量之一 $\\mathbf{G}$ 的方向，其大小是该矢量长度的一半。\n最短的非零倒易晶格矢量的大小为 $g$。因此，从 $\\bar{\\Gamma}$ 到 $\\bar{M}$ 的矢量的大小为：\n$$ |\\bar{\\Gamma}\\bar{M}| = \\frac{1}{2}g $$\n代入 $g$ 的表达式：\n$$ |\\bar{\\Gamma}\\bar{M}| = \\frac{1}{2} \\left( \\frac{4\\pi\\sqrt{6}}{3a} \\right) = \\frac{2\\pi\\sqrt{6}}{3a} $$\n该表达式表示从 SBZ 中心到其一条边界中点的距离，单位为倒易米，符合要求。", "answer": "$$\\boxed{\\frac{2\\pi\\sqrt{6}}{3a}}$$", "id": "2863764"}, {"introduction": "表面原子排列可能与体相不同，这种现象称为表面重构，它会给电子势带来新的周期性。本练习探讨了这种重构势如何导致原始表面能带“折叠”到新的、更小的布里渊区中，并在新布里渊区边界处打开能隙。理解这种能带折叠机制对于解释许多真实表面的电子特性至关重要。[@problem_id:2863744]", "problem": "一个晶格常数为 $a$ 的方形晶格上的准二维表面态，可以用一个具有各向异性最近邻和次近邻跃迁的单轨道紧束缚能带模型来描述。在没有重构的情况下，裸表面态的色散关系为\n$$\nE_{0}(\\mathbf{k}) \\equiv E_{0}(k_{x},k_{y}) \\;=\\; \\varepsilon_{S} \\;-\\; 2 t_{x} \\cos(k_{x} a) \\;-\\; 2 t_{y} \\cos(k_{y} a) \\;-\\; 2 t_{x}' \\cos(2 k_{x} a) \\;-\\; 2 t_{y}' \\cos(2 k_{y} a),\n$$\n其中 $\\varepsilon_{S}$ 是在位能，$t_{x}$ 和 $t_{y}$ 分别是沿 $x$ 和 $y$ 方向的最近邻跃迁振幅，$t_{x}'$ 和 $t_{y}'$ 是相应的次近邻跃迁振幅。一个 $(2\\times 1)$ 表面重构使得沿 $x$ 方向的实空间周期性加倍，并引入了一个形式为 $U(x) = 2 \\Delta \\cos\\!\\left(\\frac{\\pi}{a} x\\right)$ 的弱一维表面势调制，其在波矢 $\\mathbf{G} = \\left(\\frac{\\pi}{a}\\right)\\hat{\\mathbf{x}}$ 处有唯一的非零傅里叶分量。该重构势在布洛赫态 $|\\mathbf{k}\\rangle$ 和 $|\\mathbf{k}+\\mathbf{G}\\rangle$ 之间的矩阵元是一个实正常数 $\\Delta$。\n\n假设可以忽略 $\\mathbf{k}$ 和 $\\mathbf{k}+\\mathbf{G}$ 耦合之外的带间混合，并且最终的重构表面能带结构可以通过在由 $\\{\\,|\\mathbf{k}\\rangle,\\,|\\mathbf{k}+\\mathbf{G}\\rangle\\,\\}$ 张成的子空间中对角化 $2\\times 2$ 哈密顿量得到。在重构表面布里渊区的边界，即 $k_{x} = \\frac{\\pi}{2 a}$ 且 $k_{y}$ 为任意值的情况下，从第一性原理出发，推导较低的重构表面能带的能量关于 $k_{y}$、$a$、$\\varepsilon_{S}$、$t_{y}$、$t_{y}'$、$t_{x}'$ 和 $\\Delta$ 的精确解析表达式。\n\n将你的最终答案表示为一个以电子伏特 (eV) 为单位的单一闭合形式表达式。不要在你最终的方框答案中包含单位。", "solution": "该问题要求在一个弱周期势作用下的紧束缚模型所描述的系统中，推导较低的重构表面能带的能量。分析需在重构布里渊区的特定边界上进行。\n\n首先，我们验证问题陈述的有效性。\n已知条件如下：\n- 裸表面态色散关系：$E_{0}(\\mathbf{k}) = \\varepsilon_{S} - 2 t_{x} \\cos(k_{x} a) - 2 t_{y} \\cos(k_{y} a) - 2 t_{x}' \\cos(2 k_{x} a) - 2 t_{y}' \\cos(2 k_{y} a)$。\n- 一个 $(2\\times 1)$ 表面重构势：$U(x) = 2 \\Delta \\cos\\!\\left(\\frac{\\pi}{a} x\\right)$。\n- 该势在 $\\mathbf{G} = \\left(\\frac{\\pi}{a}\\right)\\hat{\\mathbf{x}}$ 处有唯一的非零傅里叶分量。\n- 耦合布洛赫态的矩阵元为 $\\langle \\mathbf{k}+\\mathbf{G} | U | \\mathbf{k} \\rangle = \\Delta$，其中 $\\Delta$ 是一个实正常数。\n- 分析被限制在由两个耦合态 $\\{|\\mathbf{k}\\rangle, |\\mathbf{k}+\\mathbf{G}\\rangle\\}$ 构成的基矢下的 $2\\times 2$ 哈密顿量中。\n- 动量空间中的具体位置是重构布里渊区的边界，$k_{x} = \\frac{\\pi}{2 a}$，对于任意的 $k_y$。\n\n该问题具有科学依据，提法明确且客观。它描述了将近自由电子理论应用于紧束缚能带结构的典型情况，这是表面物理学中的常见情景。参数是一致的，并且预期会有一个唯一的解。最终答案的参数列表中省略了 $t_x$，这是一个关键细节，并且我们发现这与 $k_x = \\frac{\\pi}{2a}$ 处的物理情况相符。该问题是有效的。\n\n现在我们开始求解。具有波矢 $\\mathbf{G}$ 的周期势 $U(x)$ 将未微扰的布洛赫态 $|\\mathbf{k}\\rangle$ 与态 $|\\mathbf{k}+\\mathbf{G}\\rangle$ 耦合起来。在二能级近似下，系统的哈密顿量在基矢 $\\{|\\mathbf{k}\\rangle, |\\mathbf{k}+\\mathbf{G}\\rangle\\}$ 中表示为一个 $2\\times 2$ 矩阵：\n$$\nH(\\mathbf{k}) = \\begin{pmatrix} \\langle\\mathbf{k}|H_0+U|\\mathbf{k}\\rangle  \\langle\\mathbf{k}|H_0+U|\\mathbf{k}+\\mathbf{G}\\rangle \\\\ \\langle\\mathbf{k}+\\mathbf{G}|H_0+U|\\mathbf{k}\\rangle  \\langle\\mathbf{k}+\\mathbf{G}|H_0+U|\\mathbf{k}+\\mathbf{G}\\rangle \\end{pmatrix}\n$$\n此处，$H_0$ 是未微扰的哈密顿量，其本征态为 $|\\mathbf{k}\\rangle$，本征值为 $E_0(\\mathbf{k})$。势 $U$ 耦合了由 $\\mathbf{G}$ 分隔的态。该矩阵变为：\n$$\nH(\\mathbf{k}) = \\begin{pmatrix} E_{0}(\\mathbf{k})  \\Delta \\\\ \\Delta  E_{0}(\\mathbf{k}+\\mathbf{G}) \\end{pmatrix}\n$$\n我们被要求在重构布里渊区的边界处计算这个矩阵，对于沿 $x$ 方向的 $(2\\times 1)$ 重构，该边界位于 $k_x = \\pm \\frac{\\pi}{2a}$。我们取 $k_x = \\frac{\\pi}{2a}$。波矢为 $\\mathbf{k} = \\left(\\frac{\\pi}{2a}, k_y\\right)$。耦合的态位于 $\\mathbf{k}+\\mathbf{G} = \\left(\\frac{\\pi}{2a} + \\frac{\\pi}{a}, k_y\\right) = \\left(\\frac{3\\pi}{2a}, k_y\\right)$。\n\n我们必须计算哈密顿量的对角元，它们是这两个态的未微扰能量。\n对于第一个对角元，$H_{11} = E_0(\\mathbf{k}) = E_0(\\frac{\\pi}{2a}, k_y)$：\n我们计算 $E_0(\\mathbf{k})$ 中 $k_x a = \\frac{\\pi}{2a} \\cdot a = \\frac{\\pi}{2}$ 的各项：\n$$\n\\cos(k_x a) = \\cos\\left(\\frac{\\pi}{2}\\right) = 0\n$$\n$$\n\\cos(2k_x a) = \\cos\\left(2 \\cdot \\frac{\\pi}{2}\\right) = \\cos(\\pi) = -1\n$$\n将这些代入 $E_0(\\mathbf{k})$ 的表达式中：\n$$\nH_{11} = \\varepsilon_{S} - 2 t_{x} (0) - 2 t_{y} \\cos(k_{y} a) - 2 t_{x}' (-1) - 2 t_{y}' \\cos(2 k_{y} a)\n$$\n$$\nH_{11} = \\varepsilon_{S} + 2 t_{x}' - 2 t_{y} \\cos(k_{y} a) - 2 t_{y}' \\cos(2 k_{y} a)\n$$\n\n对于第二个对角元，$H_{22} = E_0(\\mathbf{k}+\\mathbf{G}) = E_0(\\frac{3\\pi}{2a}, k_y)$：\n波矢的 $x$ 分量现在是 $k'_x = \\frac{3\\pi}{2a}$。我们计算余弦项，其中 $k'_x a = \\frac{3\\pi}{2a} \\cdot a = \\frac{3\\pi}{2}$：\n$$\n\\cos(k'_x a) = \\cos\\left(\\frac{3\\pi}{2}\\right) = 0\n$$\n$$\n\\cos(2k'_x a) = \\cos\\left(2 \\cdot \\frac{3\\pi}{2}\\right) = \\cos(3\\pi) = -1\n$$\n将这些代入 $E_0$ 的表达式中：\n$$\nH_{22} = \\varepsilon_{S} - 2 t_{x} (0) - 2 t_{y} \\cos(k_{y} a) - 2 t_{x}' (-1) - 2 t_{y}' \\cos(2 k_{y} a)\n$$\n$$\nH_{22} = \\varepsilon_{S} + 2 t_{x}' - 2 t_{y} \\cos(k_{y} a) - 2 t_{y}' \\cos(2 k_{y} a)\n$$\n\n值得注意的是，在新的布里渊区边界，由重构势耦合的未微扰态是简并的：$H_{11} = H_{22}$。这种简并性的出现是因为与 $t_x$ 成正比的项对于这两个态都为零。我们用 $E_{deg}$ 表示这个简并能量：\n$$\nE_{deg} = \\varepsilon_{S} + 2 t_{x}' - 2 t_{y} \\cos(k_{y} a) - 2 t_{y}' \\cos(2 k_{y} a)\n$$\n哈密顿矩阵简化为：\n$$\nH = \\begin{pmatrix} E_{deg}  \\Delta \\\\ \\Delta  E_{deg} \\end{pmatrix}\n$$\n本征值 $E$ 通过求解特征方程 $\\det(H - E I) = 0$ 得到：\n$$\n(E_{deg} - E)^2 - \\Delta^2 = 0\n$$\n$$\nE_{deg} - E = \\pm \\Delta\n$$\n这给出了两个本征值，分别对应于上 ($E_+$) 和下 ($E_-$) 重构能带：\n$$\nE_{\\pm} = E_{deg} \\pm \\Delta\n$$\n问题要求的是较低的重构能带的能量，即 $E_-$。\n$$\nE_{-} = E_{deg} - \\Delta\n$$\n代入 $E_{deg}$ 的表达式，我们得到较低能带的能量作为指定参数的函数的最终解析表达式：\n$$\nE_{-}(k_y) = \\varepsilon_{S} + 2 t_{x}' - 2 t_{y} \\cos(k_{y} a) - 2 t_{y}' \\cos(2 k_{y} a) - \\Delta\n$$\n如题目所要求，该表达式依赖于 $k_{y}$、$a$、$\\varepsilon_{S}$、$t_{y}$、$t_{y}'$、$t_{x}'$ 和 $\\Delta$。由于特定条件 $k_x = \\frac{\\pi}{2a}$，跃迁参数 $t_x$ 从最终结果中消失了。", "answer": "$$\n\\boxed{\\varepsilon_{S} + 2 t_{x}' - 2 t_{y} \\cos(k_{y} a) - 2 t_{y}' \\cos(2 k_{y} a) - \\Delta}\n$$", "id": "2863744"}, {"introduction": "现代计算材料科学依赖于密度泛函理论（DFT）等方法来预测表面性质，通常使用带有周期性边界条件的“板层模型”。本编程练习模拟了该设置中的一个常见挑战：非对称板层会产生虚假电场，需要进行校正。通过在一个简化的紧束缚模型中实现偶极校正，您将对先进表面模拟中使用的关键技术获得实践性的理解。[@problem_id:2863738]", "problem": "要求您在一个最小一维平板超胞模型中模拟偶极校正对表面电子态的影响，该模型旨在模拟平板密度泛函理论（DFT）计算的定性特征。您的模型应为一个具有内部带隙（可容纳表面态）的平板实现一个紧束缚哈密顿量，将其在周期性边界条件下嵌入真空区域，并添加一个非对称的表面微扰，以在真空中产生一个赝电场。然后，您必须实现一个偶极校正，以抵消该真空场，同时不扰动平板内部。您的程序必须针对给定的参数集，计算特征表面态能量和平均真空势斜率。\n\n基本和建模假设：\n- 从一维定态薛定谔方程 $\\hat{H}\\psi(z) = E\\psi(z)$ 出发，其中包含一个分段势 $V(z)$ 和由有限差分方法离散化产生的最近邻动能耦合。在一个晶格常数为 $a$ 的离散晶格表示中，这被建模为一个具有最近邻跃迁的紧束缚哈密顿量。\n- 用一个具有交替最近邻跃迁 $t_1$ 和 $t_2$ 的 Su-Schrieffer-Heeger (SSH) 链来表示平板区域，以产生体带隙，并在链在弱键处终止时产生带隙中表面态。使用 $t_1 = 1.0$ eV 和 $t_2 = 2.0$ eV。\n- 用具有较大在位势 $V_{\\mathrm{vac}}$ 和均匀跃迁 $t_{\\mathrm{vac}}$ 的格点来表示真空区域，其中 $V_{\\mathrm{vac}} = 8.0$ eV， $t_{\\mathrm{vac}} = 0.7$ eV。\n- 对整个超胞（平板+真空）施加周期性边界条件，因此最后一个格点与第一个格点相连。\n- 通过在两个表面平板格点（分别位于平板区域的最左侧和最右侧）上添加在位势偏移 $\\Delta_L$ 和 $\\Delta_R$ 来模拟非对称平板。在周期性边界条件下，这种非对称性会在真空区域引入一个补偿性的线性势斜坡。真空斜坡的斜率可近似为\n$$ s = \\frac{\\Delta_L - \\Delta_R}{N_{\\mathrm{vac}}}, $$\n其中 $N_{\\mathrm{vac}}$ 是真空格点数，晶格常数设为 $a = 1$，因此斜率单位为 eV/晶格间距。\n- 定义格点索引 $i$ 上的未校正总势 $V_0(i)$ 如下：\n  - 对于平板格点，$V_0(i) = 0$，除了两个表面偏移 $V_0(0) \\leftarrow V_0(0) + \\Delta_L$ 和 $V_0(N_{\\mathrm{slab}} - 1) \\leftarrow V_0(N_{\\mathrm{slab}} - 1) + \\Delta_R$。其中，$N_{\\mathrm{slab}} = 2N_{\\mathrm{cells}}$ 是由 $N_{\\mathrm{cells}}$ 个 SSH 晶胞构成的平板格点数。\n  - 对于真空格点 $i = N_{\\mathrm{slab}}, \\dots, N_{\\mathrm{slab}} + N_{\\mathrm{vac}} - 1$，$V_0(i) = V_{\\mathrm{vac}} + s\\,(i - N_{\\mathrm{slab}})$，这实现了穿过真空的线性斜坡。\n- 实现一个偶极校正势 $V_{\\mathrm{dip}}(i)$，它能抵消穿过真空的平均斜率而不扰动平板内部：\n  - 对于真空格点，$V_{\\mathrm{dip}}(i) = -s\\,[\\,i - N_{\\mathrm{slab}} - (N_{\\mathrm{vac}} - 1)/2\\,]$。\n  - 对于平板格点，$V_{\\mathrm{dip}}(i) = 0$。\n  当启用偶极校正时，校正后的势为 $V(i) = V_0(i) + V_{\\mathrm{dip}}(i)$，否则为 $V(i) = V_0(i)$。\n- 构建一个大小为 $N \\times N$ 的紧束缚哈密顿量 $\\mathbf{H}$，其中 $N = N_{\\mathrm{slab}} + N_{\\mathrm{vac}}$，在位项为 $H_{ii} = V(i)$，最近邻跃迁为 $H_{i,i+1} = H_{i+1,i} = -t$，且：\n  - 对于平板内部的键：$t$ 在 $t_1$ 和 $t_2$ 之间交替，从最左侧的平板键处的弱键 $t_1$ 开始，以确保表面态的存在。\n  - 对于任何涉及至少一个真空格点的键（包括平板-真空界面和周期性边界键），设置 $t = t_{\\mathrm{vac}}$。\n\n对每个参数集要执行的计算：\n1. 对角化 $\\mathbf{H}$ 以获得本征值 $E_n$ 和本征向量 $\\psi^{(n)}$。\n2. 通过最大化表面局域化度量来识别一个特征性的表面局域态\n$$ w_n = \\sum_{i=0}^{W-1} |\\psi^{(n)}_i|^2 + \\sum_{i=N_{\\mathrm{slab}}-W}^{N_{\\mathrm{slab}}-1} |\\psi^{(n)}_i|^2, $$\n其中每个平板表面的窗口大小为 $W = 4$ 个格点。将相应的本征值报告为表面态能量 $E_s$。\n3. 通过对仅包含真空格点索引的 $V(i)$ 与 $i$ 进行最小二乘线性拟合，来估计平均真空势斜率 $\\bar{s}$。报告拟合得到的斜率。\n\n单位和数值输出要求：\n- 以电子伏特 (eV) 报告 $E_s$，四舍五入到六位小数。\n- 以 eV/晶格间距报告 $\\bar{s}$，四舍五入到六位小数。\n- 此问题不涉及角度。\n- 您的程序必须生成单行输出，其中包含所有测试用例的结果，格式为一个用方括号括起来的逗号分隔列表，其中每个测试用例的结果本身是一个形式为 $[E_s,\\bar{s}]$ 的双元素列表。例如：\"[[0.123456,0.000000],[...],...]\"。输出字符串中不允许有空格。\n\n测试套件：\n使用以下参数集，每个参数集以 $(N_{\\mathrm{cells}}, N_{\\mathrm{vac}}, \\Delta_L, \\Delta_R, \\mathrm{apply\\_correction})$ 的形式给出：\n- 案例 1：$(20, 40, 0.4, 0.0, \\mathrm{否})$。\n- 案例 2：$(20, 40, 0.4, 0.0, \\mathrm{是})$。\n- 案例 3：$(20, 80, 0.4, 0.0, \\mathrm{否})$。\n- 案例 4：$(20, 40, 0.2, 0.2, \\mathrm{否})$。\n- 案例 5：$(6, 40, 0.4, 0.0, \\mathrm{否})$。\n\n算法和实现要求：\n- 代码必须为每个案例构建 $\\mathbf{H}$，按定义计算 $E_s$ 和 $\\bar{s}$，并以指定的精确格式在单行上打印所有案例的结果列表。\n- 使用 $t_1 = 1.0$ eV，$t_2 = 2.0$ eV，$t_{\\mathrm{vac}} = 0.7$ eV，$V_{\\mathrm{vac}} = 8.0$ eV，以及表面窗口 $W = 4$。\n- 晶格常数为 $a = 1$，因此格点索引的差异以晶格间距为单位。", "solution": "所提出的问题是凝聚态物理中一个有效且良态的计算练习。它要求构建和分析一个在周期性边界条件下的晶体平板的一维紧束缚模型，包括表面非对称性和偶极校正的影响。其物理和数学框架是合理的。我们将通过首先建立数值模型的理论基础，然后详细说明计算步骤来着手解决。\n\n系统的电子结构由定态薛定谔方程 $\\hat{H}\\psi = E\\psi$ 描述。在由索引 $i$ 标记的离散格点上的紧束缚近似下，该方程采用矩阵本征值问题的形式，$\\mathbf{H}\\psi = E\\psi$，其中 $\\mathbf{H}$ 是哈密顿矩阵。系统总共包含 $N = N_{\\mathrm{slab}} + N_{\\mathrm{vac}}$ 个格点，其中 $N_{\\mathrm{slab}}$ 是晶体平板中的格点数，$N_{\\mathrm{vac}}$ 是代表真空区域的格点数。施加周期性边界条件，使得格点 $N-1$ 与格点 $0$ 耦合。\n\n哈密顿矩阵 $\\mathbf{H}$ 是根据指定的物理参数构建的。其矩阵元 $H_{ij}$ 定义如下：\n\n构成对角元 $H_{ii}$ 的在位能由局域势 $V(i)$ 给出。势 $V(i)$ 取决于是否应用了偶极校正。\n首先，我们定义未校正的势 $V_0(i)$。对于对应于索引 $i = 0, \\dots, N_{\\mathrm{slab}}-1$ 的平板区域，势被设置为零，$V(i)=0$，但在两个表面施加了非对称微扰 $\\Delta_L$ 和 $\\Delta_R$：$V(0) = \\Delta_L$ 和 $V(N_{\\mathrm{slab}}-1) = \\Delta_R$。平板本身被建模为由 $N_{\\mathrm{cells}}$ 个晶胞组成的 Su-Schrieffer-Heeger (SSH) 链，总共有 $N_{\\mathrm{slab}} = 2N_{\\mathrm{cells}}$ 个格点。\n在真空区域，对于索引 $i = N_{\\mathrm{slab}}, \\dots, N-1$，势包含一个大的恒定偏移 $V_{\\mathrm{vac}} = 8.0$ eV 来表示功函数，外加一个线性斜坡，以抵消周期性边界条件下由表面非对称性引起的势阶。该斜坡由 $s(i - N_{\\mathrm{slab}})$ 给出，其中斜率 $s$ 近似为 $s = (\\Delta_L - \\Delta_R) / N_{\\mathrm{vac}}$。因此，未校正的势为：\n$$\nV_0(i) = \\begin{cases}\n\\Delta_L  \\text{如果 } i = 0 \\\\\n\\Delta_R  \\text{如果 } i = N_{\\mathrm{slab}}-1 \\\\\n0  \\text{如果 } 0  i  N_{\\mathrm{slab}}-1 \\\\\nV_{\\mathrm{vac}} + s(i - N_{\\mathrm{slab}})  \\text{如果 } N_{\\mathrm{slab}} \\le i  N\n\\end{cases}\n$$\n当启用偶极校正时，会添加一个校正势 $V_{\\mathrm{dip}}(i)$。该势被设计为仅在真空区域非零，并抵消其中的赝电场。其形式为，对于真空中的 $i$，$V_{\\mathrm{dip}}(i) = -s[i - N_{\\mathrm{slab}} - (N_{\\mathrm{vac}}-1)/2]$，其他情况为零。如果应用了校正，则总势为 $V(i) = V_0(i) + V_{\\mathrm{dip}}(i)$，否则为 $V(i)=V_0(i)$。\n\n非对角元 $H_{i,j}$ 代表格点间的动能或跃迁。我们只考虑最近邻跃迁，因此 $H_{i,j}$ 仅在 $j = i \\pm 1$（以及周期性边界连接）时非零。其值为 $H_{i,i+1} = H_{i+1,i} = -t$。\n在平板内部（$0 \\le i  N_{\\mathrm{slab}}-1$），跃迁在 $t_1 = 1.0$ eV 和 $t_2 = 2.0$ eV 之间交替，这是 SSH 模型的特征。为确保表面态的存在，链在弱键（$t_1$）处终止。这是通过将格点 $i$ 和 $i+1$ 之间键的跃迁设置为：如果 $i$ 是偶数则为 $t_1$，如果 $i$ 是奇数则为 $t_2$ 来实现的。\n对于任何涉及至少一个真空格点的键，跃迁参数被设置为一个恒定值 $t_{\\mathrm{vac}} = 0.7$ eV。这适用于真空内部的键、两个平板-真空界面以及格点 $N-1$ 和格点 $0$ 之间的周期性连接。\n因此，完整的哈密顿量是一个实对称（厄米）的 $N \\times N$ 矩阵。\n\n为了找到电子态，我们通过数值对角化 $\\mathbf{H}$ 来求解本征值问题 $\\mathbf{H}\\psi^{(n)} = E_n\\psi^{(n)}$。这将产生一组 $N$ 个实数本征值 $E_n$（能级）及其对应的本征向量 $\\psi^{(n)}$（波函数）。\n\n下一步是识别一个特征性的表面态。根据定义，表面态是局域在平板表面附近的。我们通过为每个态 $n$ 计算一个权重 $w_n$ 来量化这种局域性：\n$$\nw_n = \\sum_{i=0}^{W-1} |\\psi^{(n)}_i|^2 + \\sum_{i=N_{\\mathrm{slab}}-W}^{N_{\\mathrm{slab}}-1} |\\psi^{(n)}_i|^2\n$$\n这里，$\\psi^{(n)}_i$ 是第 $n$ 个本征向量在格点 $i$ 上的分量，而 $W=4$ 是表面窗口的宽度。具有最大 $w_n$ 值的态被识别为最具有表面局域性的态，其能量被报告为表面态能量 $E_s$。\n\n最后，我们必须计算真空区域中势的平均斜率 $\\bar{s}$。这是通过对真空中所有格点（从 $i=N_{\\mathrm{slab}}$ 到 $i=N-1$）的势值 $V(i)$ 进行线性最小二乘拟合来完成的。我们将模型 $V(i) = \\bar{s} \\cdot i + c$ 拟合到这些点，其中 $\\bar{s}$ 是斜率，$c$ 是截距。报告最终得到的斜率 $\\bar{s}$。对于未校正的非对称平板，该值应接近 $s$，而对于校正后的平板，该值应接近于零。\n\n这个过程将对五个指定的测试用例中的每一个执行。计算出的 $E_s$ 和 $\\bar{s}$ 值将四舍五入到六位小数并按要求格式化。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for surface state energy and vacuum potential slope in a 1D slab model.\n    \"\"\"\n    # Define physical constants from the problem statement\n    T1 = 1.0  # eV\n    T2 = 2.0  # eV\n    T_VAC = 0.7  # eV\n    V_VAC = 8.0  # eV\n    W = 4  # sites\n\n    # Define the test cases\n    test_cases = [\n        # (N_cells, N_vac, Delta_L, Delta_R, apply_correction)\n        (20, 40, 0.4, 0.0, False),\n        (20, 40, 0.4, 0.0, True),\n        (20, 80, 0.4, 0.0, False),\n        (20, 40, 0.2, 0.2, False),\n        (6, 40, 0.4, 0.0, False),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        n_cells, n_vac, delta_l, delta_r, apply_correction = case\n\n        # Calculate system dimensions\n        n_slab = 2 * n_cells\n        n_total = n_slab + n_vac\n\n        # Initialize the Hamiltonian matrix\n        H = np.zeros((n_total, n_total), dtype=float)\n\n        # 1. Construct the on-site potential V(i) (diagonal of H)\n        V = np.zeros(n_total, dtype=float)\n\n        # Slab on-site potentials\n        V[0] = delta_l\n        if n_slab > 1:\n            V[n_slab - 1] = delta_r\n\n        # Spurious field slope\n        s = (delta_l - delta_r) / n_vac if n_vac > 0 else 0.0\n\n        # Vacuum on-site potentials (uncorrected)\n        vac_indices = np.arange(n_slab, n_total)\n        if n_vac > 0:\n            V[n_slab:] = V_VAC + s * (vac_indices - n_slab)\n\n        # Apply dipole correction if specified\n        if apply_correction and n_vac > 0:\n            dipole_term = -s * (vac_indices - n_slab - (n_vac - 1) / 2.0)\n            V[n_slab:] += dipole_term\n        \n        np.fill_diagonal(H, V)\n\n        # 2. Construct the hopping terms (off-diagonal of H)\n        for i in range(n_total - 1):\n            j = i + 1\n            if i  n_slab - 1:  # Bond is inside the slab\n                t = T1 if i % 2 == 0 else T2\n            else:  # Bond involves at least one vacuum site\n                t = T_VAC\n            H[i, j] = H[j, i] = -t\n\n        # Periodic boundary condition (bond between N-1 and 0)\n        # This bond connects a vacuum site to a slab site.\n        H[n_total - 1, 0] = H[0, n_total - 1] = -T_VAC\n\n        # 3. Diagonalize the Hamiltonian\n        # eigh is used for Hermitian matrices, returns sorted eigenvalues\n        eigenvalues, eigenvectors = np.linalg.eigh(H)\n\n        # 4. Identify the characteristic surface state\n        # Find the state that maximizes localization on the slab surfaces\n        if n_slab > 0:\n            # Use W, but don't exceed half the slab length\n            win = min(W, n_slab // 2)\n            left_surface_prob = np.sum(eigenvectors[0:win, :]**2, axis=0)\n            right_surface_prob = np.sum(eigenvectors[n_slab-win:n_slab, :]**2, axis=0)\n            localization_weights = left_surface_prob + right_surface_prob\n            \n            surface_state_index = np.argmax(localization_weights)\n            e_s = eigenvalues[surface_state_index]\n        else:\n            e_s = 0.0 # Should not happen with given test cases\n\n        # 5. Estimate the mean vacuum potential slope\n        if n_vac > 0:\n            vac_potential = H.diagonal()[n_slab:]\n            vac_indices_fit = np.arange(n_slab, n_total)\n            # Use numpy.polyfit for linear least-squares regression\n            # It returns [slope, intercept]\n            slope, _ = np.polyfit(vac_indices_fit, vac_potential, 1)\n            s_bar = slope\n        else:\n            s_bar = 0.0\n\n        # 6. Store rounded results\n        result = [round(e_s, 6), round(s_bar, 6)]\n        all_results.append(result)\n\n    # 7. Print the final results in the specified format\n    # The string representation of a list of lists is almost correct.\n    # We just need to remove spaces.\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```", "id": "2863738"}]}