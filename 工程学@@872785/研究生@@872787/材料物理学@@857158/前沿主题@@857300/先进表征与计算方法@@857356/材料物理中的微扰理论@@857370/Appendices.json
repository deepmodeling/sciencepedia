{"hands_on_practices": [{"introduction": "自旋轨道耦合（SOC）是一种基本的相对论效应，它显著影响材料（尤其是半导体）的电子能带结构。本练习将演示如何应用一级简并微扰理论来求解由SOC引起的能级分裂。通过运用总角动量的简洁形式，本练习为说明对称性在简化复杂量子问题中的威力提供了一个清晰的解析解 [@problem_id:2846766]。", "problem": "考虑一个立方半导体，其在布里渊区中心的价带边态可以很好地用类原子$p$轨道来近似，其轨道角动量为 $l=1$，电子自旋为 $s=\\frac{1}{2}$。忽略晶体场各向异性及其他相互作用，未微扰哈密顿量 $H_{0}$ 在此能级组内是球对称的，并在能量 $E_{p}$ 处产生一个六重简并，对应于基 $\\{|l=1,m_{l}\\rangle\\otimes|s=\\frac{1}{2},m_{s}\\rangle\\}$，其中 $m_{l}\\in\\{-1,0,1\\}$ 且 $m_{s}\\in\\{-\\frac{1}{2},\\frac{1}{2}\\}$。现在引入自旋轨道耦合 (SOC) 作为弱微扰\n$$\nH' \\;=\\; \\lambda\\,\\frac{\\mathbf{L}\\cdot\\mathbf{S}}{\\hbar^{2}},\n$$\n其中 $\\mathbf{L}$ 和 $\\mathbf{S}$ 分别是轨道和自旋角动量算符，$\\hbar$ 是约化普朗克常数，$\\lambda$ 是一个具有能量量纲、与材料相关的常数。假设 $H_{0}$ 的六重简并是严格的，并且 $|\\lambda|$ 与到其他能带的间隔相比很小，因此一阶简并微扰理论适用于此六维子空间。\n\n仅从角动量相加的基本定义、算符对易关系以及一阶简并微扰理论的原理出发，确定由 $H'$ 引起的、在耦合 $\\mathbf{J}=\\mathbf{L}+\\mathbf{S}$ 产生的总角动量多重态之间的能级分裂 $\\Delta E \\equiv E_{J=\\frac{3}{2}} - E_{J=\\frac{1}{2}}$。将你的最终答案表示为仅含 $\\lambda$ 的单个闭式解析表达式。能量以电子伏特 (eV) 表示，其中 $\\lambda$ 以电子伏特为单位给出。不需要进行数值舍入。", "solution": "该问题要求确定一个六重简并电子能级在自旋轨道耦合影响下的能级分裂，其中自旋轨道耦合被视为微扰。未微扰系统由类原子$p$轨道表征，其对应于轨道角动量量子数 $l=1$。电子的自旋为 $s=\\frac{1}{2}$。未微扰的简并子空间由非耦合基的 $2(2l+1) = 2(2 \\cdot 1+1)=6$ 个态张成，即 $\\{|l, m_l\\rangle \\otimes |s, m_s\\rangle\\}$，其中 $l=1$, $s=\\frac{1}{2}$, $m_l \\in \\{-1, 0, 1\\}$ 且 $m_s \\in \\{-\\frac{1}{2}, \\frac{1}{2}\\}$。所有这些态共享相同的未微扰能量 $E_p$。\n\n微扰是自旋轨道哈密顿量 $H' = \\lambda \\frac{\\mathbf{L}\\cdot\\mathbf{S}}{\\hbar^2}$。为求一阶能量修正，我们必须应用简并微扰理论。这涉及到在简并子空间内对角化微扰哈密顿量。能量修正是在此子空间中 $H'$ 的 $6 \\times 6$ 矩阵表示的本征值。\n\n一种更直接的方法是找到一个能够直接对角化 $H'$ 的基。算符 $\\mathbf{L}\\cdot\\mathbf{S}$ 与总角动量的平方 $J^2$ 及其在 $z$ 轴上的投影 $J_z$ 对易，其中 $\\mathbf{J} = \\mathbf{L} + \\mathbf{S}$。这是因为 $J^2$ 和 $J_z$ 是由 $\\mathbf{L}$ 和 $\\mathbf{S}$ 的分量构成的，而 $\\mathbf{L} \\cdot \\mathbf{S}$ 是一个在轨道和自旋空间同时旋转下的标量不变量。因此，在 $J^2$ 和 $J_z$ 的共同本征态基中 $H'$ 是对角化的，该基即为耦合基，记作 $|j, m_j, l, s\\rangle$。\n\n我们首先通过耦合 $l=1$ 和 $s=\\frac{1}{2}$ 来确定总角动量量子数 $j$ 的可能取值。角动量相加的规则规定 $j$ 的取值范围为 $|l-s| \\le j \\le l+s$。对于给定值：\n$$\n|1 - \\frac{1}{2}| \\le j \\le 1 + \\frac{1}{2}\n$$\n$$\n\\frac{1}{2} \\le j \\le \\frac{3}{2}\n$$\n因此，$j$ 的可能值为 $j=\\frac{1}{2}$ 和 $j=\\frac{3}{2}$。这对应于两个不同的多重态。原来的六重简并能级分裂为：\n一个 $j=\\frac{3}{2}$ 多重态，简并度为 $2j+1 = 2(\\frac{3}{2})+1=4$。\n一个 $j=\\frac{1}{2}$ 多重态，简并度为 $2j+1 = 2(\\frac{1}{2})+1=2$。\n总态数 $4+2=6$ 守恒。\n\n算符 $\\mathbf{L}\\cdot\\mathbf{S}$ 可以通过从 $J^2 = (\\mathbf{L}+\\mathbf{S})^2 = L^2+S^2+2\\mathbf{L}\\cdot\\mathbf{S}$ 推导出的恒等式，用总、轨道和自旋角动量算符来表示：\n$$\n\\mathbf{L}\\cdot\\mathbf{S} = \\frac{1}{2} (J^2 - L^2 - S^2)\n$$\n对于特定 $j$-多重态内的态，一阶能量修正 $\\Delta E_j^{(1)}$ 是这些态对应的 $H'$ 的本征值。由于态 $|j, m_j, l, s\\rangle$ 是 $J^2$, $L^2$ 和 $S^2$ 的本征态，计算是直接的：\n$$\n\\Delta E_j^{(1)} = \\langle j, m_j | H' | j, m_j \\rangle = \\frac{\\lambda}{\\hbar^2} \\langle j, m_j | \\frac{1}{2} (J^2 - L^2 - S^2) | j, m_j \\rangle\n$$\n$J^2$, $L^2$ 和 $S^2$ 的本征值分别为 $\\hbar^2 j(j+1)$, $\\hbar^2 l(l+1)$ 和 $\\hbar^2 s(s+1)$。因此，能量移动为：\n$$\n\\Delta E_j^{(1)} = \\frac{\\lambda}{2\\hbar^2} \\left[ \\hbar^2 j(j+1) - \\hbar^2 l(l+1) - \\hbar^2 s(s+1) \\right] = \\frac{\\lambda}{2} \\left[ j(j+1) - l(l+1) - s(s+1) \\right]\n$$\n这个修正是独立于 $m_j$ 的，所以给定 $j$-多重态内的所有态都移动相同的量。我们现在代入已知的量子数：$l=1$ 和 $s=\\frac{1}{2}$。这得到 $l(l+1)=1(2)=2$ 和 $s(s+1)=\\frac{1}{2}(\\frac{3}{2})=\\frac{3}{4}$。\n\n对于 $j=\\frac{3}{2}$ 多重态：\n$j(j+1) = \\frac{3}{2}(\\frac{5}{2}) = \\frac{15}{4}$。\n能量修正是：\n$$\n\\Delta E_{j=3/2}^{(1)} = \\frac{\\lambda}{2} \\left[ \\frac{15}{4} - 2 - \\frac{3}{4} \\right] = \\frac{\\lambda}{2} \\left[ \\frac{12}{4} - 2 \\right] = \\frac{\\lambda}{2} [3-2] = \\frac{\\lambda}{2}\n$$\n该能级的能量为 $E_{J=3/2} = E_p + \\frac{\\lambda}{2}$。\n\n对于 $j=\\frac{1}{2}$ 多重态：\n$j(j+1) = \\frac{1}{2}(\\frac{3}{2}) = \\frac{3}{4}$。\n能量修正是：\n$$\n\\Delta E_{j=1/2}^{(1)} = \\frac{\\lambda}{2} \\left[ \\frac{3}{4} - 2 - \\frac{3}{4} \\right] = \\frac{\\lambda}{2} [-2] = -\\lambda\n$$\n该能级的能量为 $E_{J=1/2} = E_p - \\lambda$。\n\n问题要求能量分裂 $\\Delta E$，定义为 $\\Delta E \\equiv E_{J=\\frac{3}{2}} - E_{J=\\frac{1}{2}}$。\n$$\n\\Delta E = \\left( E_p + \\frac{\\lambda}{2} \\right) - \\left( E_p - \\lambda \\right) = \\frac{\\lambda}{2} - (-\\lambda) = \\frac{3}{2}\\lambda\n$$\n最终结果仅用与材料相关的参数 $\\lambda$ 表示。", "answer": "$$\n\\boxed{\\frac{3}{2}\\lambda}\n$$", "id": "2846766"}, {"introduction": "虽然谐振子近似为晶格振动提供了一个很好的出发点，但真实材料表现出非谐性，这对于理解热膨胀和有限声子寿命等现象至关重要。本练习涉及应用二级非简并微扰理论，来计算由立方非谐势引起的声子模式频移。掌握此计算能够加深您对相互作用如何重整化元激发性质的理解，并提供宝贵的升降算符代数练习 [@problem_id:2846758]。", "problem": "考虑一个质量为 $M$、谐振频率为 $\\omega$ 的无色散光学声子模式（爱因斯坦模型），其哈密顿量为\n$$\nH_{0}=\\frac{p^{2}}{2M}+\\frac{1}{2}M\\omega^{2}x^{2},\n$$\n带有微弱的三次非谐性微扰\n$$\nV=\\frac{\\alpha}{3!}\\,x^{3},\n$$\n其中 $\\alpha$ 是一个实数参数，其量纲为能量除以位移的立方。在零温下，通过第一激发态与基态之间能级间距的变化来模拟由非谐性引起的声子频率重整化，即，将重整化频率 $\\omega+\\Delta\\omega$ 定义为\n$$\n\\hbar(\\omega+\\Delta\\omega)=\\left[E_{1}^{(0)}+E_{1}^{(\\mathrm{anh})}\\right]-\\left[E_{0}^{(0)}+E_{0}^{(\\mathrm{anh})}\\right],\n$$\n其中 $E_{n}^{(0)}$ 是未受微扰的能量，$E_{n}^{(\\mathrm{anh})}$ 是由 $V$ 引起的修正。使用对 $\\alpha$ 的二阶不含时微扰理论，计算频率移动 $\\Delta\\omega$ 的首个非零表达式，用 $\\alpha$、$M$、$\\omega$ 和 $\\hbar$ 表示。假设谐振子采用标准的正则量子化，并计算到 $\\mathcal{O}(\\alpha^{2})$ 阶。将您关于 $\\Delta\\omega$ 的最终答案以弧度每秒为单位表示。请勿代入任何数值，并提供一个单一的闭式解析表达式。", "solution": "该问题要求计算一个受到微弱三次非谐性微扰的爱因斯坦声子模式的频率移动 $\\Delta\\omega$。该移动由第一激发态与基态之间能隙的变化定义。我们将采用对微扰参数 $\\alpha$ 的二阶不含时微扰理论。\n\n未受微扰的系统是一个一维量子谐振子，其哈密顿量为 $H_{0}=\\frac{p^{2}}{2M}+\\frac{1}{2}M\\omega^{2}x^{2}$。能量本征值为 $E_{n}^{(0)} = \\hbar\\omega(n + \\frac{1}{2})$，其中 $n=0, 1, 2, \\dots$。微扰由 $V=\\frac{\\alpha}{3!}\\,x^{3} = \\frac{\\alpha}{6}x^3$ 给出。\n\n在升降算符的形式体系中，位置算符 $x$ 表示为 $x = \\sqrt{\\frac{\\hbar}{2M\\omega}}(a + a^{\\dagger})$，其中 $a$ 和 $a^{\\dagger}$ 分别是湮没算符和产生算符。它们作用于能量本征态 $|n\\rangle$ 的方式为 $a|n\\rangle = \\sqrt{n}|n-1\\rangle$ 和 $a^{\\dagger}|n\\rangle = \\sqrt{n+1}|n+1\\rangle$。\n\n经微扰修正后的本征态 $|n\\rangle$ 的总能量为 $E_n = E_n^{(0)} + E_n^{(1)} + E_n^{(2)} + \\mathcal{O}(\\alpha^3)$，其中 $E_n^{(k)}$ 是 $k$ 阶能量修正。一阶修正由微扰在未受微扰态中的期望值给出：$E_n^{(1)} = \\langle n | V | n \\rangle = \\frac{\\alpha}{6}\\langle n | x^3 | n \\rangle$。与本征态 $|n\\rangle$ 对应的波函数具有确定的宇称，对于偶数 $n$ 为偶宇称，对于奇数 $n$ 为奇宇称。算符 $x^3$ 是一个奇宇称算符。一个奇宇称算符在确定宇称态中的期望值恒为零。因此，所有态的一阶能量修正都为零：$E_{n}^{(1)} = 0$。\n\n对能量移动的首个非零贡献将来自二阶修正，其公式为：\n$$\nE_{n}^{(2)} = \\sum_{m \\neq n} \\frac{|\\langle m | V | n \\rangle|^2}{E_{n}^{(0)} - E_{m}^{(0)}}\n$$\n问题通过关系式 $\\hbar(\\omega+\\Delta\\omega)=\\left[E_{1}^{(0)}+E_{1}^{(\\mathrm{anh})}\\right]-\\left[E_{0}^{(0)}+E_{0}^{(\\mathrm{anh})}\\right]$ 定义了重整化频率 $\\omega + \\Delta\\omega$。由于一阶修正为零，所以 $E_n^{(\\mathrm{anh})} \\approx E_n^{(2)}$。未受微扰的能级间距为 $E_1^{(0)} - E_0^{(0)} = \\hbar\\omega$。因此，我们有 $\\hbar\\omega + \\hbar\\Delta\\omega = \\hbar\\omega + (E_1^{(2)} - E_0^{(2)})$，简化后为 $\\hbar\\Delta\\omega = E_1^{(2)} - E_0^{(2)}$。\n\n我们必须计算基态（$n=0$）和第一激发态（$n=1$）的二阶能量修正。这需要计算微扰 $V = \\frac{\\alpha}{6}x^3$ 的矩阵元。我们定义常数 $C = \\sqrt{\\frac{\\hbar}{2M\\omega}}$，因此 $x = C(a+a^{\\dagger})$。算符 $x^3$ 将态 $|n\\rangle$ 连接到态 $|n\\pm 1\\rangle$ 和 $|n\\pm 3\\rangle$。\n\n首先，我们计算基态 $|0\\rangle$ 所需的矩阵元。我们计算 $x^3$ 对 $|0\\rangle$ 的作用：\n$$\nx^3|0\\rangle = C^3 (a+a^{\\dagger})^3 |0\\rangle = C^3 (a+a^{\\dagger}) (a+a^{\\dagger}) (a+a^{\\dagger})|0\\rangle\n$$\n$$\nx|0\\rangle = C a^{\\dagger}|0\\rangle = C|1\\rangle\n$$\n$$\nx^2|0\\rangle = C^2(a+a^{\\dagger})|1\\rangle = C^2(a|1\\rangle + a^{\\dagger}|1\\rangle) = C^2(|0\\rangle + \\sqrt{2}|2\\rangle)\n$$\n$$\nx^3|0\\rangle = C^3(a+a^{\\dagger})(|0\\rangle + \\sqrt{2}|2\\rangle) = C^3(a^{\\dagger}|0\\rangle + \\sqrt{2}a|2\\rangle + \\sqrt{2}a^{\\dagger}|2\\rangle) = C^3(|1\\rangle + 2|1\\rangle + \\sqrt{6}|3\\rangle) = C^3(3|1\\rangle + \\sqrt{6}|3\\rangle)\n$$\n从基态出发的 $x^3$ 的非零矩阵元为 $\\langle 1 | x^3 | 0 \\rangle = 3C^3$ 和 $\\langle 3 | x^3 | 0 \\rangle = \\sqrt{6}C^3$。\n\n对基态能量的二阶修正是：\n$$\nE_{0}^{(2)} = \\frac{|\\langle 1 | V | 0 \\rangle|^2}{E_{0}^{(0)} - E_{1}^{(0)}} + \\frac{|\\langle 3 | V | 0 \\rangle|^2}{E_{0}^{(0)} - E_{3}^{(0)}}\n$$\n利用 $E_n^{(0)} - E_m^{(0)} = (n-m)\\hbar\\omega$，上式变为：\n$$\nE_{0}^{(2)} = \\left(\\frac{\\alpha}{6}\\right)^2 \\left( \\frac{|\\langle 1 | x^3 | 0 \\rangle|^2}{-\\hbar\\omega} + \\frac{|\\langle 3 | x^3 | 0 \\rangle|^2}{-3\\hbar\\omega} \\right) = \\frac{\\alpha^2}{36} \\left( \\frac{(3C^3)^2}{-\\hbar\\omega} + \\frac{(\\sqrt{6}C^3)^2}{-3\\hbar\\omega} \\right)\n$$\n$$\nE_{0}^{(2)} = \\frac{\\alpha^2 C^6}{36} \\left( -\\frac{9}{\\hbar\\omega} - \\frac{6}{3\\hbar\\omega} \\right) = \\frac{\\alpha^2 C^6}{36\\hbar\\omega} (-9 - 2) = -\\frac{11\\alpha^2 C^6}{36\\hbar\\omega}\n$$\n\n接下来，我们计算第一激发态 $|1\\rangle$ 的矩阵元。我们计算 $x^3|1\\rangle$：\n$$\nx|1\\rangle = C(a+a^{\\dagger})|1\\rangle = C(|0\\rangle + \\sqrt{2}|2\\rangle)\n$$\n$$\nx^2|1\\rangle = C^2(a+a^{\\dagger})(|0\\rangle + \\sqrt{2}|2\\rangle) = C^2(a^{\\dagger}|0\\rangle + \\sqrt{2}a|2\\rangle + \\sqrt{2}a^{\\dagger}|2\\rangle) = C^2(|1\\rangle + 2|1\\rangle + \\sqrt{6}|3\\rangle) = C^2(3|1\\rangle + \\sqrt{6}|3\\rangle)\n$$\n$$\nx^3|1\\rangle = C^3(a+a^{\\dagger})(3|1\\rangle + \\sqrt{6}|3\\rangle) = C^3(3a|1\\rangle + 3a^{\\dagger}|1\\rangle + \\sqrt{6}a|3\\rangle + \\sqrt{6}a^{\\dagger}|3\\rangle)\n$$\n$$\nx^3|1\\rangle = C^3(3|0\\rangle + 3\\sqrt{2}|2\\rangle + \\sqrt{18}|2\\rangle + \\sqrt{24}|4\\rangle) = C^3(3|0\\rangle + 6\\sqrt{2}|2\\rangle + 2\\sqrt{6}|4\\rangle)\n$$\n非零矩阵元为 $\\langle 0 | x^3 | 1 \\rangle = 3C^3$、$\\langle 2 | x^3 | 1 \\rangle = 6\\sqrt{2}C^3$ 和 $\\langle 4 | x^3 | 1 \\rangle = 2\\sqrt{6}C^3$。\n\n对第一激发态能量的二阶修正是：\n$$\nE_{1}^{(2)} = \\frac{|\\langle 0 | V | 1 \\rangle|^2}{E_{1}^{(0)} - E_{0}^{(0)}} + \\frac{|\\langle 2 | V | 1 \\rangle|^2}{E_{1}^{(0)} - E_{2}^{(0)}} + \\frac{|\\langle 4 | V | 1 \\rangle|^2}{E_{1}^{(0)} - E_{4}^{(0)}}\n$$\n$$\nE_{1}^{(2)} = \\left(\\frac{\\alpha}{6}\\right)^2 \\left( \\frac{|\\langle 0 | x^3 | 1 \\rangle|^2}{\\hbar\\omega} + \\frac{|\\langle 2 | x^3 | 1 \\rangle|^2}{-\\hbar\\omega} + \\frac{|\\langle 4 | x^3 | 1 \\rangle|^2}{-3\\hbar\\omega} \\right)\n$$\n$$\nE_{1}^{(2)} = \\frac{\\alpha^2}{36} \\left( \\frac{(3C^3)^2}{\\hbar\\omega} - \\frac{(6\\sqrt{2}C^3)^2}{\\hbar\\omega} - \\frac{(2\\sqrt{6}C^3)^2}{3\\hbar\\omega} \\right) = \\frac{\\alpha^2 C^6}{36\\hbar\\omega} \\left( 9 - 72 - \\frac{24}{3} \\right)\n$$\n$$\nE_{1}^{(2)} = \\frac{\\alpha^2 C^6}{36\\hbar\\omega} (9 - 72 - 8) = -\\frac{71\\alpha^2 C^6}{36\\hbar\\omega}\n$$\n\n现在我们计算频率移动 $\\Delta\\omega$：\n$$\n\\hbar\\Delta\\omega = E_1^{(2)} - E_0^{(2)} = \\left(-\\frac{71\\alpha^2 C^6}{36\\hbar\\omega}\\right) - \\left(-\\frac{11\\alpha^2 C^6}{36\\hbar\\omega}\\right) = \\frac{(-71+11)\\alpha^2 C^6}{36\\hbar\\omega} = -\\frac{60\\alpha^2 C^6}{36\\hbar\\omega} = -\\frac{5\\alpha^2 C^6}{3\\hbar\\omega}\n$$\n最后，我们代入 $C^6 = \\left(\\frac{\\hbar}{2M\\omega}\\right)^3 = \\frac{\\hbar^3}{8M^3\\omega^3}$：\n$$\n\\hbar\\Delta\\omega = -\\frac{5\\alpha^2}{3\\hbar\\omega} \\left(\\frac{\\hbar^3}{8M^3\\omega^3}\\right) = -\\frac{5\\alpha^2\\hbar^2}{24M^3\\omega^4}\n$$\n两边除以 $\\hbar$ 得到频率移动：\n$$\n\\Delta\\omega = -\\frac{5\\alpha^2\\hbar}{24M^3\\omega^4}\n$$\n这是由三次非谐性引起的声子频率的首个非零修正，在 $\\mathcal{O}(\\alpha^2)$ 阶内有效。负号表示非谐性通过降低声子频率来使其软化。", "answer": "$$\n\\boxed{-\\frac{5\\alpha^{2}\\hbar}{24M^{3}\\omega^{4}}}\n$$", "id": "2846758"}, {"introduction": "精确预测材料的电子特性通常需要超越密度泛函理论（DFT），使用多体微扰理论，其中GW近似是一种领先的方法。本练习通过要求您推导准粒子能量的线性化解，并针对一个模型自能进行计算实现，从而将理论与实践联系起来。这项动手练习揭开了准粒子校正和自能作用的神秘面纱，让您深入了解现代电子结构计算的核心机制 [@problem_id:2846767]。", "problem": "考虑晶体固体中的一个单电子布洛赫态，该状态最初由密度泛函理论（DFT）中的 Kohn–Sham（KS）本征值描述。在多体微扰理论中，准粒子（QP）能量定义为相互作用格林函数的极点，通过求解包含自能算符的戴森方程获得。在格林函数乘以屏蔽库仑相互作用（GW）近似中，电子自能近似为单粒子格林函数与动态屏蔽库仑相互作用的乘积。对于一个给定的状态，当在极点附近忽略自能的虚部时，戴森方程简化为关于实准粒子能量 $E$ 的标量不动点条件。\n\n从戴森方程和准粒子极点的定义出发，构建一个用 KS 参考能量 $\\varepsilon$、投影 GW 自能的实部 $\\mathrm{Re}\\,\\Sigma(\\omega)$ 以及 DFT 交换相关势 $v_{\\mathrm{xc}}$ 的期望值来确定 $E$ 的标量方程。然后，在 $\\omega=\\varepsilon$ 附近将此方程线性化，以获得一个实用的准粒子能量修正一阶表达式。对 GW 自能的实部使用以下具有物理动机的单极点模型（一个与因果性和粒子-空穴对称性一致的简化等离激元-极点表示）：\n$$\n\\mathrm{Re}\\,\\Sigma(\\omega) \\equiv \\Sigma(\\omega) = s_0 + s_1\\,\\omega + c\\,\\frac{\\omega}{\\omega^2 - \\Omega^2},\n$$\n其中 $s_0$ 和 $\\Omega$ 的单位是电子伏特，$s_1$ 是无量纲的，$c$ 的单位是电子伏特的平方。所有能量和频率都必须以电子伏特处理。\n\n你的任务是：\n- 从第一性原理出发，推导准粒子能量 $E$ 的线性化解，用 $\\varepsilon$、$v_{\\mathrm{xc}}$、$\\Sigma(\\omega)$ 及其在 $\\omega=\\varepsilon$ 处的一阶频率导数表示。\n- 实现一个程序，通过将你的线性化表达式应用于上述模型 $\\Sigma(\\omega)$，来评估以下每个测试用例的 $E$。使用所提供的显式参数。对于每个测试，输出以电子伏特为单位的准粒子能量，四舍五入到三位小数。\n\n测试套件（所有能量单位均为电子伏特）：\n- 测试 $1$：$\\varepsilon = 1.0$, $v_{\\mathrm{xc}} = -7.0$, $s_0 = -6.5$, $s_1 = 0.1$, $c = 2.0$, $\\Omega = 10.0$。\n- 测试 $2$：$\\varepsilon = -2.0$, $v_{\\mathrm{xc}} = -4.0$, $s_0 = -3.9$, $s_1 = 0.0$, $c = 0.1$, $\\Omega = 8.0$。\n- 测试 $3$：$\\varepsilon = 2.0$, $v_{\\mathrm{xc}} = -5.4$, $s_0 = -5.0$, $s_1 = 0.05$, $c = 1.2$, $\\Omega = 2.5$。\n- 测试 $4$：$\\varepsilon = 0.5$, $v_{\\mathrm{xc}} = -3.0$, $s_0 = -2.6$, $s_1 = 0.9$, $c = 0.0$, $\\Omega = 9.0$。\n\n最终输出规范：\n- 你的程序必须生成单行输出，其中包含一个 Python 风格的列表，按顺序包含测试 $1$ 到 $4$ 的准粒子能量。格式为用方括号括起来的逗号分隔列表，每个能量以电子伏特为单位，四舍五入到三位小数（例如，$[1.234,-0.567,8.900,0.000]$）。", "solution": "问题陈述在科学上是有效且适定的。我们将着手进行推导和后续计算。\n\n确定准粒子（QP）能量 $E$ 的出发点是戴森方程。对于一个具有本征值 $\\varepsilon_{n\\mathbf{k}}$ 的特定 Kohn-Sham（KS）态 $| \\psi_{n\\mathbf{k}} \\rangle$，准粒子能量 $E_{n\\mathbf{k}}$ 是相互作用单粒子格林函数 $G$ 的一个极点。该条件表示为以下非线性标量方程的解：\n$$\nE = \\varepsilon + \\mathrm{Re} \\left[ \\Sigma(E) \\right] - v_{\\mathrm{xc}}\n$$\n此处，$\\varepsilon$ 是初始 KS 本征值，$v_{\\mathrm{xc}}$ 是该 KS 态的交换相关势的期望值，$\\Sigma(\\omega)$ 是频率依赖的自能算符。问题为自能的实部 $\\mathrm{Re}[\\Sigma(\\omega)]$ 提供了一个模型，由于该模型是纯实数的，我们将简单地将其表示为 $\\Sigma(\\omega)$。所有量都应理解为所讨论态的期望值。需要求解的方程是：\n$$\nE = \\varepsilon + \\Sigma(E) - v_{\\mathrm{xc}}\n$$\n这个方程是非线性的，因为未知能量 $E$ 作为自能函数 $\\Sigma$ 的自变量出现。一个常用且实用的求解方法是在已知的 KS 能量 $\\varepsilon$ 附近对自能项进行线性化。这可以通过对 $\\Sigma(E)$ 在 $E = \\varepsilon$ 处进行一阶泰勒级数展开来实现：\n$$\n\\Sigma(E) \\approx \\Sigma(\\varepsilon) + (E - \\varepsilon) \\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon}\n$$\n当准粒子修正 $E - \\varepsilon$ 相对于 $\\Sigma(\\omega)$ 发生显著变化的能量尺度较小时，这种近似在物理上是合理的。将 $\\Sigma(E)$ 的线性化表达式代入准粒子方程，得到：\n$$\nE \\approx \\varepsilon + \\left[ \\Sigma(\\varepsilon) + (E - \\varepsilon) \\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon} \\right] - v_{\\mathrm{xc}}\n$$\n我们现在必须求解这个关于 $E$ 的线性方程。重新整理各项以分离 $E$：\n$$\nE - (E - \\varepsilon) \\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon} = \\varepsilon + \\Sigma(\\varepsilon) - v_{\\mathrm{xc}}\n$$\n$$\nE \\left( 1 - \\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon} \\right) = \\varepsilon - \\varepsilon \\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon} + \\Sigma(\\varepsilon) - v_{\\mathrm{xc}}\n$$\n$$\nE \\left( 1 - \\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon} \\right) = \\varepsilon \\left( 1 - \\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon} \\right) + \\Sigma(\\varepsilon) - v_{\\mathrm{xc}}\n$$\n两边同除以括号中的项，我们便得到准粒子能量的线性化解：\n$$\nE = \\varepsilon + \\frac{\\Sigma(\\varepsilon) - v_{\\mathrm{xc}}}{1 - \\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon}}\n$$\n这个表达式通常用准粒子重整化因子 $Z$ 来表示：\n$$\nZ = \\left( 1 - \\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon} \\right)^{-1}\n$$\n这样，准粒子能量可以表示为：\n$$\nE = \\varepsilon + Z (\\Sigma(\\varepsilon) - v_{\\mathrm{xc}})\n$$\n至此，推导完成。\n\n为了应用此结果，我们使用所提供的单极点自能模型：\n$$\n\\Sigma(\\omega) = s_0 + s_1\\,\\omega + c\\,\\frac{\\omega}{\\omega^2 - \\Omega^2}\n$$\n我们需要此函数及其一阶导数，两者均在 $\\omega = \\varepsilon$ 处求值。函数在 $\\varepsilon$ 处的值为：\n$$\n\\Sigma(\\varepsilon) = s_0 + s_1\\,\\varepsilon + c\\,\\frac{\\varepsilon}{\\varepsilon^2 - \\Omega^2}\n$$\n对 $\\omega$ 的一阶导数可使用商法则计算第三项：\n$$\n\\frac{d\\Sigma(\\omega)}{d\\omega} = s_1 + c \\cdot \\frac{d}{d\\omega}\\left( \\frac{\\omega}{\\omega^2 - \\Omega^2} \\right) = s_1 + c \\cdot \\frac{1(\\omega^2 - \\Omega^2) - \\omega(2\\omega)}{(\\omega^2 - \\Omega^2)^2} = s_1 - c \\frac{\\omega^2 + \\Omega^2}{(\\omega^2 - \\Omega^2)^2}\n$$\n在 $\\omega = \\varepsilon$ 处对导数求值：\n$$\n\\left. \\frac{d\\Sigma(\\omega)}{d\\omega} \\right|_{\\omega=\\varepsilon} = s_1 - c \\frac{\\varepsilon^2 + \\Omega^2}{(\\varepsilon^2 - \\Omega^2)^2}\n$$\n利用这些解析表达式，我们现在可以通过将给定参数代入 $\\Sigma(\\varepsilon)$、其导数、重整化因子 $Z$ 以及最终的 $E$ 的公式中，来计算每个测试用例的准粒子能量 $E$。此过程的实现已在最终答案中提供。\n测试用例的计算结果如下：\n测试 $1$：$E = 1.630$ eV\n测试 $2$：$E = -1.897$ eV\n测试 $3$：$E = 1.832$ eV\n测试 $4$：$E = 9.000$ eV\n这些值是通过直接应用推导出的线性化公式得到的，并按要求四舍五入到三位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the linearized quasiparticle (QP) energy for several test cases\n    based on the GW approximation in many-body perturbation theory.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Parameters are: (epsilon, v_xc, s0, s1, c, Omega)\n    test_cases = [\n        (1.0, -7.0, -6.5, 0.1, 2.0, 10.0),  # Test 1\n        (-2.0, -4.0, -3.9, 0.0, 0.1, 8.0),  # Test 2\n        (2.0, -5.4, -5.0, 0.05, 1.2, 2.5),  # Test 3\n        (0.5, -3.0, -2.6, 0.9, 0.0, 9.0),   # Test 4\n    ]\n\n    results = []\n    for case in test_cases:\n        eps, v_xc, s0, s1, c, Omega = case\n\n        # Calculate Sigma(epsilon) using the provided single-pole model.\n        # Sigma(w) = s0 + s1*w + c*w / (w^2 - Omega^2)\n        # Denominator of the pole term:\n        denom_sigma = eps**2 - Omega**2\n        \n        # The problem data is chosen to avoid the pole where eps = Omega.\n        sigma_eps = s0 + s1 * eps + c * eps / denom_sigma\n\n        # Calculate the derivative of Sigma with respect to omega, evaluated at epsilon.\n        # dSigma/dw = s1 - c * (w^2 + Omega^2) / (w^2 - Omega^2)^2\n        # Denominator of the derivative term:\n        denom_deriv = (eps**2 - Omega**2)**2\n        \n        d_sigma_d_omega = s1 - c * (eps**2 + Omega**2) / denom_deriv\n\n        # Calculate the quasiparticle renormalization factor Z.\n        # Z = 1 / (1 - dSigma/domega)\n        Z = 1.0 / (1.0 - d_sigma_d_omega)\n\n        # Calculate the linearized quasiparticle energy E.\n        # E = eps + Z * (Sigma(eps) - v_xc)\n        E = eps + Z * (sigma_eps - v_xc)\n\n        # Append the result, formatted to three decimal places.\n        results.append(f\"{E:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2846767"}]}