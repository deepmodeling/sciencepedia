{"hands_on_practices": [{"introduction": "我们从一个基本问题开始：当光的波长远大于光子晶体的周期时，这个精细的周期结构在宏观上如何与光相互作用？此时，结构可以被视为一个均匀的“有效介质”。本练习将指导您超越简单的平均，运用微扰理论推导出一维光子晶体在长波极限下的有效折射率，并计算其色散的一阶修正项 [@problem_id:2850161]。这项实践旨在深化您对均质化理论的理解，并掌握一种连接微观结构与宏观光学响应的强大分析方法。", "problem": "一个一维光子晶体由两种非磁性电介质层周期性堆叠而成，其标量相对介电常数分别为 $\\varepsilon_{1}$ 和 $\\varepsilon_{2}$，厚度分别为 $d_{1}$ 和 $d_{2}$，周期为 $a = d_{1} + d_{2}$。该结构在堆叠方向 $z$ 上无限延伸，在横向上是均匀的。一束单色平面波以角频率 $\\omega$ 沿 $z$ 轴正向入射传播，真空光速为 $c$，布洛赫波数为 $k_{B}(\\omega)$。假设电介质是各向同性、无损的，并且亚波长（均匀化）条件 $|\\omega| a / c \\ll 1$ 成立。\n\n从频域中的无源宏观麦克斯韦方程组、每个界面上切向场的边界条件以及周期性介质的布洛赫定理出发，推导布洛赫色散的长波长展开，并通过 $k_{B}(\\omega) = (\\omega/c)\\, n_{\\mathrm{eff}}(\\omega)$ 定义有效折射率 $n_{\\mathrm{eff}}(\\omega)$。证明该展开式具有以下结构：\n$$\nn_{\\mathrm{eff}}^{2}(\\omega) \\;=\\; \\varepsilon_{\\parallel} \\;+\\; \\alpha \\left(\\frac{\\omega a}{c}\\right)^{2} \\;+\\; \\mathcal{O}\\!\\left(\\left(\\frac{\\omega a}{c}\\right)^{4}\\right),\n$$\n其中 $\\varepsilon_{\\parallel} \\equiv f\\,\\varepsilon_{1} + (1-f)\\,\\varepsilon_{2}$ 是算术（面内）平均介电常数，填充分数为 $f \\equiv d_{1}/a$。\n\n确定系数 $\\alpha$ 关于 $\\varepsilon_{1}$、$\\varepsilon_{2}$ 和 $f$ 的闭合形式解析表达式。你的最终答案必须是 $\\alpha$ 作为 $\\varepsilon_{1}$、$\\varepsilon_{2}$ 和 $f$ 的函数的单一显式表达式。无需进行数值计算。", "solution": "首先对用户提供的问题进行严格的验证过程。\n\n**第1步：提取已知条件**\n\n-   系统：一维光子晶体，由两种非磁性电介质层周期性堆叠而成。\n-   堆叠方向：$z$。\n-   第1层属性：相对介电常数 $\\varepsilon_{1}$，厚度 $d_{1}$。\n-   第2层属性：相对介电常数 $\\varepsilon_{2}$，厚度 $d_{2}$。\n-   周期：$a = d_{1} + d_{2}$。\n-   波的属性：单色平面波，正入射（沿 $z$ 轴传播），角频率 $\\omega$。\n-   常数：真空光速 $c$。\n-   布洛赫波数：$k_{B}(\\omega)$。\n-   假设：各向同性、无损、非磁性电介质。亚波长（均匀化）条件 $|\\omega| a / c \\ll 1$。\n-   目标关系：有效折射率 $n_{\\mathrm{eff}}(\\omega)$ 由 $k_{B}(\\omega) = (\\omega/c)\\, n_{\\mathrm{eff}}(\\omega)$ 定义。\n-   目标展开结构：$n_{\\mathrm{eff}}^{2}(\\omega) = \\varepsilon_{\\parallel} + \\alpha \\left(\\frac{\\omega a}{c}\\right)^{2} + \\mathcal{O}\\!\\left(\\left(\\frac{\\omega a}{c}\\right)^{4}\\right)$。\n-   定义：填充分数 $f \\equiv d_{1}/a$，算术平均介电常数 $\\varepsilon_{\\parallel} \\equiv f\\,\\varepsilon_{1} + (1-f)\\,\\varepsilon_{2}$。\n-   目标：确定系数 $\\alpha$ 关于 $\\varepsilon_{1}$、$\\varepsilon_{2}$ 和 $f$ 的闭合形式解析表达式。\n\n**第2步：使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题基于周期性介质（光子晶体）中电磁学的基本原理，受麦克斯韦方程组和布洛赫定理支配。均匀化极限是超材料和有效介质理论中的一个标准且具有物理意义的范畴。该问题在科学上是合理的。\n-   **适定性**：该问题要求推导微扰展开中的一个特定系数。问题设置清晰，预期存在唯一解。\n-   **客观性**：语言精确、技术性强，没有主观或模糊的陈述。\n-   **完整性**：所有必要的参数（$\\varepsilon_{1}, \\varepsilon_{2}, d_{1}, d_{2}$）和条件（正入射、长波长极限）都已提供。该问题是自洽的。\n-   **一致性与可行性**：该问题没有矛盾之处。所给条件描述了一个可以通过实验实现的标准的物理系统。\n\n**第3步：结论与行动**\n\n该问题是**有效的**。这是一个凝聚态物理/光子学中的标准、适定的问题。我现在将进行推导。\n\n在一维非磁性电介质中，沿 $z$ 轴正向入射的单色平面波的传播由标量波动方程决定，该方程由麦克斯韦方程组导出。对于沿 $x$ 方向偏振的电场 $E_x(z)$，其方程为：\n$$\n\\frac{d^2 E_x(z)}{dz^2} + \\left(\\frac{\\omega}{c}\\right)^2 \\varepsilon(z) E_x(z) = 0\n$$\n其中 $k_0 = \\omega/c$ 是真空波数，$\\varepsilon(z)$ 是空间变化的相对介电常数。函数 $\\varepsilon(z)$ 是周期函数，周期为 $a$，即 $\\varepsilon(z+a) = \\varepsilon(z)$。\n\n根据布洛赫定理，这个具有周期系数的微分方程的解必须具有 $E_x(z) = u(z) e^{i k_B z}$ 的形式，其中 $u(z)$ 是一个具有相同周期 $a$ 的周期函数，即 $u(z+a) = u(z)$，而 $k_B$ 是布洛赫波数。\n\n一个解决此问题的有效方法是平面波展开法。场的周期部分 $u(z)$ 和周期介电常数 $\\varepsilon(z)$ 都可以展开成傅里叶级数：\n$$\nE_x(z) = \\sum_{m=-\\infty}^{\\infty} A_m e^{i(k_B + \\frac{2\\pi m}{a})z}\n$$\n$$\n\\varepsilon(z) = \\sum_{n=-\\infty}^{\\infty} \\varepsilon_n e^{i \\frac{2\\pi n}{a} z}\n$$\n介电常数分布的傅里叶系数 $\\varepsilon_n$ 由下式给出：\n$$\n\\varepsilon_n = \\frac{1}{a} \\int_0^a \\varepsilon(z') e^{-i \\frac{2\\pi n}{a} z'} dz'\n$$\n对于 $n=0$，我们得到介电常数的空间平均值：\n$$\n\\varepsilon_0 = \\frac{1}{a} \\left( \\int_0^{d_1} \\varepsilon_1 dz' + \\int_{d_1}^{a} \\varepsilon_2 dz' \\right) = \\frac{\\varepsilon_1 d_1 + \\varepsilon_2 d_2}{a} = f \\varepsilon_1 + (1-f) \\varepsilon_2 = \\varepsilon_{\\parallel}\n$$\n对于 $n \\neq 0$：\n$$\n\\varepsilon_n = \\frac{1}{a} \\left( \\varepsilon_1 \\int_0^{d_1} e^{-i \\frac{2\\pi n z'}{a}} dz' + \\varepsilon_2 \\int_{d_1}^{a} e^{-i \\frac{2\\pi n z'}{a}} dz' \\right)\n$$\n$$\n\\varepsilon_n = \\frac{1}{a} \\left[ \\varepsilon_1 \\frac{a}{-i 2\\pi n} \\left(e^{-i 2\\pi n f} - 1\\right) + \\varepsilon_2 \\frac{a}{-i 2\\pi n} \\left(e^{-i 2\\pi n} - e^{-i 2\\pi n f}\\right) \\right]\n$$\n由于 $e^{-i 2\\pi n} = 1$：\n$$\n\\varepsilon_n = \\frac{i}{2\\pi n} \\left[ \\varepsilon_1(1 - e^{-i 2\\pi n f}) - \\varepsilon_2(1 - e^{-i 2\\pi n f}) \\right] = \\frac{i(\\varepsilon_1 - \\varepsilon_2)}{2\\pi n} (1 - e^{-i 2\\pi n f})\n$$\n注意 $\\varepsilon_{-n} = \\varepsilon_n^*$，其中 $*$ 表示复共轭。\n\n将 $E_x(z)$ 和 $\\varepsilon(z)$ 的傅里叶展开式代入波动方程，得到关于系数 $A_m$ 的无穷耦合代数方程组：\n$$\n-\\left(k_B + \\frac{2\\pi m}{a}\\right)^2 A_m + k_0^2 \\sum_{n=-\\infty}^{\\infty} \\varepsilon_{m-n} A_n = 0\n$$\n在长波长极限下，$k_0 a = \\frac{\\omega a}{c} \\ll 1$，我们可以使用微扰理论来处理这个系统。布洛赫波数 $k_B$ 也将很小。未微扰解对应于介电常数为 $\\varepsilon_0 = \\varepsilon_\\parallel$ 的均匀介质。这对应于只保留 $m=0$ 的项：\n$$\n-k_B^2 A_0 + k_0^2 \\varepsilon_0 A_0 = 0 \\implies k_B^2 = k_0^2 \\varepsilon_0\n$$\n使用定义 $k_B = k_0 n_{\\mathrm{eff}}$，我们发现 $n_{\\mathrm{eff}}^2 = \\varepsilon_0 = \\varepsilon_\\parallel$。这是零阶近似。\n\n为了找到下一阶修正，我们考虑 $m \\neq 0$ 的方程。在长波长极限下，$k_B \\ll \\frac{2\\pi m}{a}$，并且项 $A_m$ 相对于 $A_0$ 会很小。$m \\neq 0$ 的方程可以近似为：\n$$\n-\\left(\\frac{2\\pi m}{a}\\right)^2 A_m + k_0^2 \\varepsilon_m A_0 \\approx 0\n$$\n这给出了 $m \\neq 0$ 时振幅 $A_m$ 的一阶修正：\n$$\nA_m \\approx \\frac{k_0^2 \\varepsilon_m}{(\\frac{2\\pi m}{a})^2} A_0 = \\frac{(k_0 a)^2}{4\\pi^2 m^2} \\varepsilon_m A_0\n$$\n现在，我们将其代回 $m=0$ 的方程中：\n$$\n-k_B^2 A_0 + k_0^2 \\left( \\varepsilon_0 A_0 + \\sum_{n \\neq 0} \\varepsilon_{-n} A_n \\right) = 0\n$$\n两边除以 $A_0$ 并代入 $A_n$ 的表达式：\n$$\nk_B^2 = k_0^2 \\left( \\varepsilon_0 + \\sum_{n \\neq 0} \\varepsilon_{-n} \\frac{(k_0 a)^2}{4\\pi^2 n^2} \\varepsilon_n \\right) = k_0^2 \\varepsilon_0 + (k_0 a)^2 k_0^2 \\sum_{n \\neq 0} \\frac{|\\varepsilon_n|^2}{4\\pi^2 n^2}\n$$\n我们有 $n_{\\mathrm{eff}}^2 = k_B^2 / k_0^2$。与目标形式 $n_{\\mathrm{eff}}^{2}(\\omega) = \\varepsilon_{\\parallel} + \\alpha (k_0 a)^2 + \\mathcal{O}((k_0 a)^4)$ 相比较，我们可以确定系数 $\\alpha$为：\n$$\n\\alpha = \\sum_{n \\neq 0} \\frac{|\\varepsilon_n|^2}{4\\pi^2 n^2}\n$$\n让我们计算 $|\\varepsilon_n|^2$：\n$$\n|\\varepsilon_n|^2 = \\left| \\frac{i(\\varepsilon_1 - \\varepsilon_2)}{2\\pi n} (1 - e^{-i 2\\pi n f}) \\right|^2 = \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{4\\pi^2 n^2} |1 - \\cos(2\\pi nf) + i\\sin(2\\pi nf)|^2\n$$\n$$\n|\\varepsilon_n|^2 = \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{4\\pi^2 n^2} \\left( (1-\\cos(2\\pi nf))^2 + \\sin^2(2\\pi nf) \\right) = \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{4\\pi^2 n^2} (2 - 2\\cos(2\\pi nf))\n$$\n使用恒等式 $1 - \\cos(2x) = 2\\sin^2(x)$，我们得到：\n$$\n|\\varepsilon_n|^2 = \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{4\\pi^2 n^2} \\left( 4\\sin^2(\\pi nf) \\right) = \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{\\pi^2 n^2} \\sin^2(\\pi nf)\n$$\n现在，将此代入 $\\alpha$ 的表达式中：\n$$\n\\alpha = \\sum_{n \\neq 0} \\frac{1}{4\\pi^2 n^2} \\left( \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{\\pi^2 n^2} \\sin^2(\\pi nf) \\right) = \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{4\\pi^4} \\sum_{n \\neq 0} \\frac{\\sin^2(\\pi nf)}{n^4}\n$$\n该求和可以写成 $2 \\sum_{n=1}^{\\infty} \\frac{\\sin^2(\\pi nf)}{n^4}$。这个无穷级数有一个已知的闭合形式，可以从伯努利多项式的傅里叶级数推导出来。具体来说，对于 $0 \\leq f \\leq 1$：\n$$\n\\sum_{n=1}^\\infty \\frac{\\cos(2\\pi nf)}{n^4} = \\frac{\\pi^4}{90} - \\frac{\\pi^4 f^2}{3} + \\frac{2\\pi^4 f^3}{3} - \\frac{\\pi^4 f^4}{3}\n$$\n使用 $\\sin^2(\\theta) = \\frac{1}{2}(1 - \\cos(2\\theta))$，我们的求和变为：\n$$\n\\sum_{n=1}^{\\infty} \\frac{\\sin^2(\\pi nf)}{n^4} = \\frac{1}{2} \\sum_{n=1}^{\\infty} \\frac{1}{n^4} - \\frac{1}{2} \\sum_{n=1}^{\\infty} \\frac{\\cos(2\\pi nf)}{n^4}\n$$\n黎曼zeta函数给出 $\\sum_{n=1}^{\\infty} \\frac{1}{n^4} = \\zeta(4) = \\frac{\\pi^4}{90}$。代入级数表达式：\n$$\n\\sum_{n=1}^{\\infty} \\frac{\\sin^2(\\pi nf)}{n^4} = \\frac{1}{2} \\left( \\frac{\\pi^4}{90} \\right) - \\frac{1}{2} \\left( \\frac{\\pi^4}{90} - \\frac{\\pi^4 f^2}{3} + \\frac{2\\pi^4 f^3}{3} - \\frac{\\pi^4 f^4}{3} \\right)\n$$\n$$\n= \\frac{1}{2} \\left( \\frac{\\pi^4 f^2}{3} - \\frac{2\\pi^4 f^3}{3} + \\frac{\\pi^4 f^4}{3} \\right) = \\frac{\\pi^4}{6} (f^2 - 2f^3 + f^4) = \\frac{\\pi^4}{6} f^2(1 - 2f + f^2) = \\frac{\\pi^4}{6} f^2(1-f)^2\n$$\n所以，$\\sum_{n \\neq 0} \\frac{\\sin^2(\\pi nf)}{n^4} = 2 \\times \\frac{\\pi^4}{6} f^2(1-f)^2 = \\frac{\\pi^4}{3} f^2(1-f)^2$。\n\n最后，我们将这个求和结果代回 $\\alpha$ 的表达式中：\n$$\n\\alpha = \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{4\\pi^4} \\left( \\frac{\\pi^4}{3} f^2(1-f)^2 \\right) = \\frac{1}{12} (\\varepsilon_1 - \\varepsilon_2)^2 f^2 (1-f)^2\n$$\n这就是系数 $\\alpha$ 的闭合形式解析表达式。", "answer": "$$\\boxed{\\frac{1}{12} f^2 (1-f)^2 (\\varepsilon_1 - \\varepsilon_2)^2}$$", "id": "2850161"}, {"introduction": "完美周期结构的核心用途之一是在其中引入“缺陷”来创造局域态，例如光子晶体微腔。本练习将引导您应用包络函数近似（EFA）和有效质量近似（EMA）这两种源自凝聚态物理的强大工具 [@problem_id:2850177]。通过将光子带边附近的行为类比于量子力学中的薛定谔方程，您将能够为一个被微扰势束缚的光子模式建立一个简化的有效模型。这项实践对于培养分析和设计功能性光子器件（如谐振器和波导）的能力至关重要，它将复杂的波动问题转化为一个直观且可解的有效方程。", "problem": "一个晶格周期为 $a$ 的一维光子晶体支持一个横电布洛赫模式，其色散关系在布里渊区边界波矢 $k_{0} = \\pi/a$ 处的一个光子能带底部附近是解析的且具有正曲率。令 $\\omega_{0} \\equiv \\omega_{n}(k_{0})$ 表示带边角频率，令 $D \\equiv \\left.\\frac{\\partial^{2}\\omega_{n}}{\\partial k^{2}}\\right|_{k_{0}}$ 表示沿晶格方向的曲率，且 $D>0$。引入一个缓慢变化的折射率微扰，使得在包络函数近似下，局域带边被一个标量函数 $U(x)$ 平移，其中 $U(x) = \\tfrac{1}{2} K x^{2}$，$K>0$ 为一常数，$x$ 是沿周期性方向的坐标。假设极化和对称性允许进行标量处理，磁导率在空间上是均匀的，并且高阶（二次以上）的 $k$ 依赖性和非抛物线校正可以忽略不计。\n\n从时谐无源麦克斯韦方程组和布洛赫定理出发，并应用包络函数近似 (EFA) 以及在 $k_{0}$ 附近的有效质量近似 (EMA)，推导出控制布洛赫模式缓变振幅 $F(x)$ 的主导阶一维包络方程。然后，利用此方程，确定基态束缚态频移 $\\Delta\\omega_{0} \\equiv \\omega_{\\text{bound}} - \\omega_{0}$，并以 $D$ 和 $K$ 的闭式解析表达式给出。\n\n你的最终答案必须是 $\\Delta\\omega_{0}$ 关于 $D$ 和 $K$ 的单个闭式表达式。不需要进行数值计算。", "solution": "所述问题具有科学依据，是适定的、客观的且内部一致的。它代表了包络函数和有效质量近似在描述微扰周期势中布洛赫波行为的标准应用，这是固态物理和光子学中的一个基石概念。因此，我们可以直接进行推导。\n\n出发点是横电布洛赫模式在布里渊区边界 $k_{0} = \\pi/a$ 附近的色散关系。问题指明该色散是解析且抛物线的，中心位于带边频率 $\\omega_{0} \\equiv \\omega_{n}(k_{0})$。对于接近 $k_{0}$ 的波矢 $k$，频率 $\\omega_{n}(k)$ 可通过在二阶截断的泰勒展开来近似：\n$$ \\omega_{n}(k) \\approx \\omega_{n}(k_{0}) + \\left.\\frac{\\partial\\omega_{n}}{\\partial k}\\right|_{k_{0}} (k-k_{0}) + \\frac{1}{2} \\left.\\frac{\\partial^{2}\\omega_{n}}{\\partial k^{2}}\\right|_{k_{0}} (k-k_{0})^{2} $$\n在像布里渊区边界这样的能带极值点，群速度为零，所以 $\\left.\\frac{\\partial\\omega_{n}}{\\partial k}\\right|_{k_{0}} = 0$。使用给定的定义 $\\omega_{0}$ 和 $D = \\left.\\frac{\\partial^{2}\\omega_{n}}{\\partial k^{2}}\\right|_{k_{0}}$，色散关系简化为：\n$$ \\omega_{n}(k) \\approx \\omega_{0} + \\frac{1}{2} D (k-k_{0})^{2} $$\n令 $q \\equiv k - k_{0}$ 为相对于带边的波矢。在未受微扰的能带内，频移为 $\\delta\\omega_{\\text{band}}(q) = \\omega_{n}(k) - \\omega_{0} = \\frac{1}{2} D q^{2}$。\n\n对于具有缓慢变化微扰的系统，我们采用包络函数近似 (EFA)。频率为 $\\omega \\approx \\omega_{0}$ 的一个态的总波函数，写为带边处快速振荡的布洛赫模式 $\\psi_{n,k_{0}}(x) = u_{n,k_{0}}(x) \\exp(i k_{0} x)$ 与一个缓变包络函数 $F(x)$ 的乘积。场的完整时空依赖性近似为 $\\Psi(x,t) \\approx F(x) \\psi_{n,k_{0}}(x) \\exp(-i\\omega t)$。\n\n包络函数 $F(x)$ 的动力学由一个有效波动方程所支配。在有效质量近似 (EMA) 中，色散关系中的波矢 $q$ 通过替换 $q \\rightarrow \\hat{q} = -i \\frac{d}{dx}$ 被提升为作用在包络函数上的微分算子。这将由能带色散引起的频移转换为一个算子：\n$$ \\delta\\hat{\\omega}_{\\text{kin}} = \\frac{1}{2} D \\hat{q}^{2} = \\frac{1}{2} D \\left(-i \\frac{d}{dx}\\right)^{2} = -\\frac{D}{2} \\frac{d^{2}}{dx^{2}} $$\n该算子充当包络函数的“动能”项。\n\n问题指出，折射率微扰使局域带边发生了一个标量势 $U(x) = \\frac{1}{2} K x^{2}$ 的平移。这个势能项与动能项相加，构成了总的有效哈密顿算子 $\\hat{H}_{\\text{eff}}$。\n$$ \\hat{H}_{\\text{eff}} = \\delta\\hat{\\omega}_{\\text{kin}} + U(x) = -\\frac{D}{2} \\frac{d^{2}}{dx^{2}} + \\frac{1}{2} K x^{2} $$\n该算子的本征值是势中束缚态的频移 $\\Delta\\omega \\equiv \\omega - \\omega_{0}$。因此，包络函数 $F(x)$ 的不含时本征值方程为：\n$$ \\hat{H}_{\\text{eff}} F(x) = \\Delta\\omega F(x) $$\n代入 $\\hat{H}_{\\text{eff}}$ 的表达式，我们得到一维包络方程：\n$$ \\left( -\\frac{D}{2} \\frac{d^{2}}{dx^{2}} + \\frac{1}{2} K x^{2} \\right) F(x) = \\Delta\\omega F(x) $$\n该方程具有一维量子谐振子的不含时薛定谔方程的规范形式。其标准形式为\n$$ \\left( -\\frac{\\hbar^{2}}{2m} \\frac{d^{2}}{dx^{2}} + \\frac{1}{2} m \\Omega^{2} x^{2} \\right) \\psi(x) = E \\psi(x) $$\n其能量本征值被量子化为 $E_{\\nu} = \\hbar \\Omega (\\nu + \\frac{1}{2})$，其中 $\\nu = 0, 1, 2, \\ldots$。\n\n为了求出束缚态频移 $\\Delta\\omega_{\\nu}$，我们将包络方程的参数映射到标准谐振子模型上：\n1.  动能系数： $\\frac{\\hbar^{2}}{2m} \\longleftrightarrow \\frac{D}{2}$\n2.  势能系数： $\\frac{1}{2} m \\Omega^{2} \\longleftrightarrow \\frac{K}{2}$\n3.  本征值： $E \\longleftrightarrow \\Delta\\omega$\n\n从第一个对应关系，我们可以定义一个有效质量 $m^{*} = \\hbar^{2}/D$。将其代入第二个对应关系 $m \\Omega^{2} \\leftrightarrow K$，我们求出特征频率 $\\Omega$：\n$$ \\left(\\frac{\\hbar^{2}}{D}\\right) \\Omega^{2} = K \\implies \\Omega^{2} = \\frac{DK}{\\hbar^{2}} \\implies \\Omega = \\frac{\\sqrt{DK}}{\\hbar} $$\n所允许的频移 $\\Delta\\omega_{\\nu}$ 是我们系统的本征值，其对应于类比的量子谐振子的能级 $E_{\\nu}$：\n$$ \\Delta\\omega_{\\nu} = E_{\\nu} = \\hbar \\Omega \\left(\\nu + \\frac{1}{2}\\right) = \\hbar \\left(\\frac{\\sqrt{DK}}{\\hbar}\\right) \\left(\\nu + \\frac{1}{2}\\right) = \\sqrt{DK} \\left(\\nu + \\frac{1}{2}\\right) $$\n问题要求的是基态束缚态频移 $\\Delta\\omega_{0}$，它对应于系统的基态，即频率最低的态，此时量子数 $\\nu = 0$。\n$$ \\Delta\\omega_{0} = \\sqrt{DK} \\left(0 + \\frac{1}{2}\\right) = \\frac{1}{2} \\sqrt{DK} $$\n这就是对于基态束缚模式，相对于未受微扰的带边 $\\omega_{0}$ 所要求的频移。", "answer": "$$\n\\boxed{\\frac{1}{2}\\sqrt{DK}}\n$$", "id": "2850177"}, {"introduction": "尽管解析模型为我们提供了深刻的物理洞察，但对于真实光子晶体结构的精确设计和分析，数值模拟是不可或缺的。本练习是一个动手编程任务，要求您实现传输矩阵法（TMM）——一种计算任意层状介质光学性质的普适而稳健的算法 [@problem_id:2850217]。通过完成这项实践，您将把布洛赫定理、辐射边界条件等理论概念转化为一个实用的计算工具，从而掌握现代光子学研究与工程中必不可少的技能。", "problem": "考虑一个一维无损耗介质光子晶体，由两种均匀、各向同性、非磁性层（标记为A和B）周期性堆叠而成，其折射率分别为 $n_{\\mathrm{A}}$ 和 $n_{\\mathrm{B}}$，厚度分别为 $d_{\\mathrm{A}}$ 和 $d_{\\mathrm{B}}$。周期为 $a = d_{\\mathrm{A}} + d_{\\mathrm{B}}$。该结构占据 $x \\ge 0$ 的空间，一束角频率为 $\\omega$ 的时谐平面波从一个折射率为 $n_{\\mathrm{in}}$、占据 $x  0$ 空间的均匀半无限入射介质中正入射。采用 $\\exp(-i \\omega t)$ 的时间依赖关系，并假设介质为非磁性的，相对磁导率等于1。三角函数中的所有角度必须使用弧度。使用无量纲归一化，使得长度以 $a$ 为单位表示，并定义无量纲频率 $u = \\omega a / c$，其中 $c$ 是真空中的光速。\n\n仅从无源、分段均匀介质中的麦克斯韦方程组、界面处切向电场和磁场的连续性条件，以及周期性结构的布洛赫定理陈述出发，推导一个算法，用以计算当半无限周期晶体被入射平面波激发时，在 $x = 0$ 处的功率反射率 $R$。计算需遵循以下辐射边界条件：在周期晶体内部，只允许存在在$+x$方向上传输功率的布洛赫解（如果存在传播的布洛赫模式）或当$x \\to +\\infty$时衰减的布洛赫解（如果不存在传播的布洛赫模式）。你的推导必须明确构建单元传输矩阵，提取布洛赫本征值和本征向量，利用辐射边界条件选择物理的布洛赫模式，计算界面处的布洛赫模式有效导纳，并通过场匹配来确定反射系数。最终可计算的量是功率反射率 $R = |r|^2$，其中 $r$ 是复振幅反射系数。\n\n将你的推导实现为一个程序，该程序为每个指定的测试用例计算正入射情况下在 $x=0$ 处的单通功率反射率 $R$。状态必须用位于 $x=0$ 界面紧右侧（即A层开始处）参考平面上的切向电场 $E$ 和切向磁场 $H$ 来表示。每层的传播必须用一个 $2 \\times 2$ 传输（特征）矩阵表示，该矩阵通过求解每层中的均匀亥姆霍兹方程并在界面处强制场连续性而得到。布洛赫条件是单元传输矩阵 $\\mathbf{M}_{\\text{cell}}$ 的本征问题，其本征值为 $\\lambda = \\exp(i k_{\\mathrm{B}} a)$（其中 $k_{\\mathrm{B}}$ 是布洛赫波数），本征向量为 $\\mathbf{v} = (E, H)^{\\mathsf{T}}$（在选定的参考平面上定义）。\n\n为保证数值稳定性，在为给定的无量纲频率 $u$ 选择物理布洛赫本征向量 $\\mathbf{v}$ 时，请强制执行以下规则：\n- 如果两个布洛赫乘子都满足 $| |\\lambda| - 1 |$ 小于一个很小的容差（传播带），则选择其时间平均的x方向坡印廷通量密度（与 $\\operatorname{Re}\\{E H^*\\}$ 成正比）为正（功率流入$+x$方向）的本征向量。\n- 否则（禁带），选择 $|\\lambda|  1$ 的本征向量（向$+x$方向衰减）。\n\n然后，根据所选的本征向量计算 $x = 0^+$ 处的布洛赫模式有效导纳 $Y_{\\mathrm{B}} = H/E$，并通过使用切向场连续性与入射介质的总场（入射+反射）进行匹配，得到 $x = 0$ 处的振幅反射系数。在所述的归一化下，入射介质的导纳为 $Y_{\\mathrm{in}} = n_{\\mathrm{in}}$。最后，返回反射率 $R = |r|^2$ 作为一个实数。\n\n在所有测试用例中，使用以下固定参数：\n- $n_{\\mathrm{A}} = 1.0$，\n- $n_{\\mathrm{B}} = 3.4$，\n- $n_{\\mathrm{in}} = 1.0$，\n- 选择 $d_{\\mathrm{A}}$ 和 $d_{\\mathrm{B}}$ 以满足 $n_{\\mathrm{A}} d_{\\mathrm{A}} = n_{\\mathrm{B}} d_{\\mathrm{B}}$ 和 $d_{\\mathrm{A}} + d_{\\mathrm{B}} = 1$（即，在所选单位中，光学厚度相等且周期 $a = 1$）。\n\n按如下无量纲频率 $u$ 列表定义三个测试用例：\n- 测试用例1（通带，“理想路径”）：$u = 0.5\\, u_0$，\n- 测试用例2（在第一个禁带中心）：$u = u_0$，\n- 测试用例3（更高频率的通带）：$u = 1.5\\, u_0$，\n其中 $u_0$ 是与上述相等光学厚度条件对应的带隙中心（布拉格）归一化频率。所有计算必须对相位使用弧度。你的程序必须在所述归一化条件下，根据给定的 $n_{\\mathrm{A}}$、$n_{\\mathrm{B}}$、$d_{\\mathrm{A}}$ 和 $d_{\\mathrm{B}}$ 计算出 $u_0$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[r1,r2,r3]”），每个条目是对应测试用例的 $R$ 的浮点值，顺序如上所列。除了这个确切的单行格式外，不得有任何额外的字符或空格。所有输出均为无量纲实数（无物理单位），并应以标准十进制表示法打印。", "solution": "该问题要求推導并实现一个算法，用于计算来自半无限一维光子晶体的功率反射率。这将通过遵循传输矩阵法、应用布洛赫定理以及在边界处进行场匹配来完成。\n\n首先，我们从无源（$\\rho=0, \\mathbf{J}=0$）、各向同性、非磁性（$\\mu=\\mu_0$）、折射率为 $n$ 的介电介质中的麦克斯韦方程组开始：\n$$ \\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t} = i\\omega\\mu_0\\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t} = -i\\omega\\epsilon\\mathbf{E} = -i\\omega n^2 \\epsilon_0\\mathbf{E} $$\n我们采用了时谐约定 $\\exp(-i\\omega t)$。对于沿x轴传播的正入射平面波，其电场沿y方向偏振（$\\mathbf{E} = E(x)\\hat{y}$），磁场沿z方向（$\\mathbf{H} = H(x)\\hat{z}$），麦克斯韦方程组简化为一组常微分方程：\n$$ \\frac{dE}{dx} = -i\\omega\\mu_0 H $$\n$$ \\frac{dH}{dx} = -i\\omega n^2 \\epsilon_0 E $$\n结合这些方程，我们得到一维亥姆霍兹方程：\n$$ \\frac{d^2 E}{dx^2} + \\left(\\frac{\\omega n}{c}\\right)^2 E = 0 $$\n其中 $c = 1/\\sqrt{\\epsilon_0 \\mu_0}$ 是真空中的光速。\n\n问题定义了无量纲频率 $u = \\omega a / c$，其中 $a$ 是晶体的周期。用 $a$ 对长度进行归一化意味着在这些单位中 $a=1$。此外，我们采用一个单位制，其中 $c=1$，自由空间的阻抗 $Z_0 = \\sqrt{\\mu_0/\\epsilon_0} = 1$。在这些单位中，折射率为 $n$ 的介质中的波数为 $k = \\omega n = u n$，特征导纳为 $Y=n$。控制方程变为：\n$$ \\frac{dE}{dx} = -i u H $$\n$$ \\frac{dH}{dx} = -i u n^2 E $$\n在厚度为 $d$、折射率为 $n$ 的均匀层中，亥姆霍兹方程的解可以用一个传输矩阵 $\\mathbf{M}$ 来表示，该矩阵将 $x$ 处的场与 $x=0$ 处的场联系起来：$\\begin{pmatrix} E(x) \\\\ H(x) \\end{pmatrix} = \\mathbf{M}(x) \\begin{pmatrix} E(0) \\\\ H(0) \\end{pmatrix}$。厚度为 $d$ 的层的传输矩阵为：\n$$ \\mathbf{M}_{\\text{layer}}(d, n, u) = \\begin{pmatrix} \\cos(und)  i \\frac{1}{n} \\sin(und) \\\\ i n \\sin(und)  \\cos(und) \\end{pmatrix} $$\n光子晶体的单元由从 $x=0$ 开始的A和B两层组成。整个单元的传输矩阵 $\\mathbf{M}_{\\text{cell}}$ 是各个层矩阵的乘积：\n$$ \\mathbf{M}_{\\text{cell}} = \\mathbf{M}_{\\text{B}} \\mathbf{M}_{\\text{A}} $$\n其中 $\\mathbf{M}_{\\text{A}}$ 和 $\\mathbf{M}_{\\text{B}}$ 分别是厚度为 $d_{\\mathrm{A}}$、$d_{\\mathrm{B}}$，折射率为 $n_{\\mathrm{A}}$、$n_{\\mathrm{B}}$ 的A层和B层的传输矩阵。\n\n根据布洛赫定理，对于周期势，解必须具有 $\\mathbf{v}(x+a) = \\lambda \\mathbf{v}(x)$ 的形式，其中 $\\mathbf{v}(x) = (E(x), H(x))^{\\mathsf{T}}$ 是场矢量，$\\lambda = \\exp(ik_{\\mathrm{B}}a)$ 是布洛赫乘子，$k_{\\mathrm{B}}$ 是布洛赫波数。由于单元起始处的场矢量通过 $\\mathbf{M}_{\\text{cell}}$ 映射到单元末端的场矢量，因此在单元边界处允许的场构型是 $\\mathbf{M}_{\\text{cell}}$ 的本征向量：\n$$ \\mathbf{M}_{\\text{cell}} \\mathbf{v} = \\lambda \\mathbf{v} $$\n本征值 $\\lambda$ 从特征方程 $\\det(\\mathbf{M}_{\\text{cell}} - \\lambda \\mathbf{I}) = 0$ 求得。由于 $\\det(\\mathbf{M}_{\\text{cell}})=1$（无损耗系统的一个性质），该方程为 $\\lambda^2 - \\text{Tr}(\\mathbf{M}_{\\text{cell}}) \\lambda + 1 = 0$。解为 $\\lambda_{1,2} = \\frac{T \\pm \\sqrt{T^2-4}}{2}$，其中 $T = \\text{Tr}(\\mathbf{M}_{\\text{cell}})$。\n- 如果 $|T/2| \\le 1$，本征值为单位模的复共轭对，$\\lambda = \\exp(\\pm i k_{\\mathrm{B}} a)$。这对应于传播的布洛赫模式（通带）。\n- 如果 $|T/2|  1$，本征值为实数，其中一个满足 $|\\lambda|  1$（增长模式），另一个满足 $|\\lambda|  1$（衰减模式）。这对应于倏逝模式（禁带）。\n\n问题指定了一个位于 $x \\ge 0$ 的半无限晶体。晶体内部的物理解必须是满足辐射边界条件的单一布洛赫模式：它要么必须将功率带离界面（进入晶体，即$+x$方向），要么当 $x \\to \\infty$ 时衰减为零。\n- 在通带中，我们选择对应于正的时间平均坡印廷通量 $S_x = \\frac{1}{2}\\operatorname{Re}\\{E_{\\mathrm{B}} H_{\\mathrm{B}}^*\\}  0$ 的本征向量 $\\mathbf{v}_{\\mathrm{B}} = (E_{\\mathrm{B}}, H_{\\mathrm{B}})^{\\mathsf{T}}$。\n- 在禁带中，我们选择对应于模 $|\\lambda|  1$ 的本征值的本征向量。\n\n一旦在界面 $x=0^+$ 处确定了物理布洛赫模式的本征向量 $\\mathbf{v}_{\\mathrm{B}}$，我们就计算其有效导纳 $Y_{\\mathrm{B}} = H_{\\mathrm{B}} / E_{\\mathrm{B}}$。对于入射介质（$x  0$），场是入射平面波和反射平面波的叠加。$x=0^-$ 处的总导纳为 $Y(0^-) = Y_{\\mathrm{in}} \\frac{1-r}{1+r}$，其中 $r$ 是振幅反射系数，$Y_{\\mathrm{in}} = n_{\\mathrm{in}}$ 是入射介质的导纳。\n$x=0$ 处切向场的连续性意味着 $Y(0^-) = Y(0^+) = Y_{\\mathrm{B}}$。因此，我们可以解出反射系数：\n$$ r = \\frac{Y_{\\mathrm{in}} - Y_{\\mathrm{B}}}{Y_{\\mathrm{in}} + Y_{\\mathrm{B}}} $$\n功率反射率则为 $R = |r|^2$。\n\n四分之一波长堆栈的具体参数为 $n_{\\mathrm{A}}=1.0$，$n_{\\mathrm{B}}=3.4$，$n_{\\mathrm{in}}=1.0$，$a=1$，以及 $n_{\\mathrm{A}}d_{\\mathrm{A}} = n_{\\mathrm{B}}d_{\\mathrm{B}}$。根据 $d_{\\mathrm{A}}+d_{\\mathrm{B}}=a=1$，我们得到 $d_{\\mathrm{A}} = n_{\\mathrm{B}}/(n_{\\mathrm{A}}+n_{\\mathrm{B}})$ 和 $d_{\\mathrm{B}} = n_{\\mathrm{A}}/(n_{\\mathrm{A}}+n_{\\mathrm{B}})$。带隙中心频率 $u_0$ 对应的条件是每层中的光程为四分之一波长，即相移为 $\\pi/2$。因此，$u_0 n_{\\mathrm{A}} d_{\\mathrm{A}} = \\pi/2$，这给出 $u_0 = \\frac{\\pi (n_{\\mathrm{A}}+n_{\\mathrm{B}})}{2n_{\\mathrm{A}}n_{\\mathrm{B}}}$。\n\n算法流程如下：\n1.  计算 $d_{\\mathrm{A}}, d_{\\mathrm{B}}$ 和 $u_0$。\n2.  对于每个测试频率 $u$：\n    a. 构建 $\\mathbf{M}_{\\text{A}}$ 和 $\\mathbf{M}_{\\text{B}}$ 并计算 $\\mathbf{M}_{\\text{cell}} = \\mathbf{M}_{\\text{B}}\\mathbf{M}_{\\text{A}}$。\n    b. 计算迹 $T$。\n    c. 如果在禁带中（$|T/2|  1$，如 $u=u_0$ 时），选择本征值 $|\\lambda|1$。对于在 $u_0$ 处的四分之一波長堆栈，矩阵 $\\mathbf{M}_{\\text{cell}}$ 是对角矩阵，导致衰减模式的本征向量为 $(1,0)^{\\mathsf{T}}$，布洛赫导纳 $Y_{\\mathrm{B}}=0$。\n    d. 如果在通带中（$|T/2| \\le 1$，如 $u=0.5u_0, 1.5u_0$ 时），找到两个本征值。选择对应于前向功率流的一个。这个选择取决于矩阵元素 $M_{12}$ 虚部的符号。布洛赫导纳为 $Y_{\\mathrm{B}} = (\\lambda_{\\text{fwd}} - M_{11}) / M_{12}$。\n    e. 计算 $r = (n_{\\mathrm{in}} - Y_{\\mathrm{B}}) / (n_{\\mathrm{in}} + Y_{\\mathrm{B}})$ 和 $R = |r|^2$。\n\n该过程在以下程序中实现。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the reflectance of a semi-infinite 1D photonic crystal.\n    \"\"\"\n    # Fixed parameters from problem statement\n    n_A = 1.0\n    n_B = 3.4\n    n_in = 1.0\n    \n    # In normalized units, period a = 1.\n    # d_A + d_B = 1 and n_A * d_A = n_B * d_B\n    d_A = n_B / (n_A + n_B)\n    d_B = n_A / (n_A + n_B)\n\n    # Midgap (Bragg) normalized frequency for the quarter-wave stack\n    # This comes from the condition that phase thickness u0 * nA * dA = pi/2\n    u0 = np.pi / (2 * n_A * d_A)\n    \n    test_frequencies = [0.5 * u0, u0, 1.5 * u0]\n    \n    results = []\n    \n    for u in test_frequencies:\n        # Phase thickness in each layer. Due to the quarter-wave condition,\n        # phi_A = u * n_A * d_A and phi_B = u * n_B * d_B are equal.\n        phi = u * n_A * d_A\n        \n        c, s = np.cos(phi), np.sin(phi)\n        \n        # Check for special case: center of a stop band, where c = cos(pi/2) = 0\n        if np.isclose(c, 0.0):\n            # This is the center of the Bragg stopgap. M_cell is diagonal.\n            # Eigenvalues are -n_A/n_B and -n_B/n_A.\n            # The decaying mode corresponds to eigenvalue with magnitude  1,\n            # which is -n_A/n_B. Its eigenvector is (1, 0)^T.\n            # Bloch admittance Y_B = H/E = 0.\n            Y_B = 0.0\n        else:\n            # General case (pass band for the given test frequencies)\n            M11 = c**2 - (n_A / n_B) * s**2\n            M22 = c**2 - (n_B / n_A) * s**2\n            M12 = 1j * s * c * (1/n_A + 1/n_B)\n            \n            T = M11 + M22\n            \n            # For a pass band, |T/2| = 1.\n            gamma_sqrt = np.sqrt(4.0 - T**2)\n\n            # Select the forward-propagating Bloch mode.\n            # Poynting flux is proportional to Re(E H*).\n            # For eigenvector choice v=(M12, lambda-M11), S_x ~ Re(M12 * (lambda*-M11)).\n            # The sign of this depends on the sign of Im(M12) which is sign(s*c).\n            # We must select lambda to make the flux positive.\n            if s * c > 0:\n                lambda_fwd = (T + 1j * gamma_sqrt) / 2.0\n            else:\n                lambda_fwd = (T - 1j * gamma_sqrt) / 2.0\n\n            # Bloch admittance Y_B = H_B / E_B\n            Y_B = (lambda_fwd - M11) / M12\n\n        # Reflection coefficient at the interface x=0\n        r = (n_in - Y_B) / (n_in + Y_B)\n        \n        # Power reflectance R = |r|^2\n        R = np.abs(r)**2\n        results.append(R)\n        \n    # Format the output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2850217"}]}