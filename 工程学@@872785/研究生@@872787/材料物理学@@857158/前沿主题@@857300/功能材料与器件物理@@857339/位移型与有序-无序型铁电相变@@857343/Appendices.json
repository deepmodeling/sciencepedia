{"hands_on_practices": [{"introduction": "朗道-金兹堡-德文希尔（LGD）理论为描述铁电相变提供了一个强大的唯象框架。通过本练习，您将学习如何运用该理论，从亥姆霍兹自由能表达式出发，推导出连续位移型相变的一个关键宏观物理量——比热容在相变点的跃变[@problem_id:2815634]。这个实践旨在加深您对理论模型与可观测实验现象之间联系的理解。", "problem": "一个中心对称的顺电晶体在临界温度 $T_{c}$ 处经历一个连续的位移型铁电相变，转变为极性相。在 $T_{c}$ 附近，对于一个空间均匀、单畴且外电场为零的样品，其 Landau–Ginzburg–Devonshire (LGD) 亥姆霍兹自由能密度模型为\n$$\nf(T,P)=f_{b}(T)+\\frac{a}{2}\\bigl(T-T_{0}\\bigr)P^{2}+\\frac{b}{4}P^{4},\n$$\n其中 $P$ 是标量极化序参量，$a>0$ 和 $b>0$ 是临界区内不依赖于温度的系数，$T_{0}$ 是平均场临界温度，而 $f_{b}(T)$ 包含了不依赖于 $P$ 的光滑背景贡献。假设这是一个位移型相变，因此 $T_{c}=T_{0}$，并且在临界区内，$P$ 的高阶项和空间梯度可以忽略不计。\n\n从平衡态使亥姆霍兹自由能在恒定温度下最小化，以及热容密度可以根据标准热力学关系通过对平衡亥姆霍兹自由能密度求温度导数得到这两个原理出发，确定在 $T_{c}$ 处由极化序参量引起的体积热容密度的反常跳变。将跳变定义为\n$$\n\\Delta c \\equiv \\lim_{T\\to T_{c}^{-}}\\delta c(T)-\\lim_{T\\to T_{c}^{+}}\\delta c(T),\n$$\n其中 $\\delta c(T)$ 是 $f(T,P)$ 中依赖于 $P$ 的部分对热容密度的贡献，即减去了光滑背景 $f_{b}(T)$ 后的部分。将最终答案表示为包含 $a$、$b$ 和 $T_{c}$ 的完全简化的解析表达式。最终答案必须是单一的闭合形式表达式。不要报告任何来自 $f_{b}(T)$ 的背景贡献，也不要为系数假定任何具体的数值。", "solution": "所述问题具有科学依据，提法明確且客观。这是朗道二级相变理论中的一个标准问题。所有必要的信息均已提供，且前提与既定的物理原理一致。因此，我们开始求解。\n\n临界温度 $T_{c}$ 附近的亥姆霍兹自由能密度 $f$ 由下式给出：\n$$\nf(T,P) = f_{b}(T) + \\frac{a}{2}(T-T_{c})P^{2} + \\frac{b}{4}P^{4}\n$$\n其中问题指定 $T_{c} = T_{0}$，且常数 $a$ 和 $b$ 为正。$f_{b}(T)$ 项是一个不依赖于序参量 $P$ 的背景贡献，因此对热容的反常跳变没有贡献。我们关心的是自由能中依赖于 $P$ 的部分，我们将其记为 $\\delta f(T,P)$：\n$$\n\\delta f(T,P) = \\frac{a}{2}(T-T_{c})P^{2} + \\frac{b}{4}P^{4}\n$$\n当系统在恒定温度 $T$ 下，自由能密度相对于序参量 $P$ 达到最小值时，系统处于热力学平衡状态。该条件表示为 $\\frac{\\partial f}{\\partial P} = 0$。由于 $f_{b}(T)$ 不依赖于 $P$，这等价于 $\\frac{\\partial (\\delta f)}{\\partial P} = 0$。\n$$\n\\frac{\\partial (\\delta f)}{\\partial P} = a(T-T_{c})P + bP^{3} = P [a(T-T_{c}) + bP^{2}] = 0\n$$\n该方程对于平衡极化 $P_{eq}$ 有两个可能的解：\n1. $P_{eq} = 0$\n2. $P_{eq}^{2} = -\\frac{a}{b}(T-T_{c}) = \\frac{a}{b}(T_{c}-T)$\n\n为了确定哪个解对应于稳定平衡（自由能的极小值），我们必须检验二阶导数 $\\frac{\\partial^{2} f}{\\partial P^{2}}$ 的符号。\n$$\n\\frac{\\partial^{2} f}{\\partial P^{2}} = a(T-T_{c}) + 3bP^{2}\n$$\n\n情况1：高温（顺电）相，$T > T_{c}$。\n在此区域，$T-T_{c} > 0$。方程 $P^{2} = \\frac{a}{b}(T_{c}-T)$ 对于 $P \\neq 0$ 没有实数解。唯一可能的平衡态是 $P_{eq} = 0$。\n在 $P_{eq}=0$ 处，二阶导数为 $\\frac{\\partial^{2} f}{\\partial P^{2}} = a(T-T_{c}) > 0$。由于二阶导数为正，$P_{eq}=0$ 代表一个稳定的极小值。\n因此，对于 $T > T_{c}$，平衡极化为 $P_{eq}(T) = 0$。\n\n情况2：低温（铁电）相，$T  T_{c}$。\n在此区域，$T-T_{c}  0$。\n对于解 $P_{eq}=0$，二阶导数为 $\\frac{\\partial^{2} f}{\\partial P^{2}} = a(T-T_{c})  0$。这对应于一个局部极大值，因此零极化状态是不稳定的。\n对于解 $P_{eq}^{2} = \\frac{a}{b}(T_{c}-T)$，二阶导数为：\n$$\n\\frac{\\partial^{2} f}{\\partial P^{2}} = a(T-T_{c}) + 3b \\left( \\frac{a}{b}(T_{c}-T) \\right) = a(T-T_{c}) - 3a(T-T_{c}) = -2a(T-T_{c}) = 2a(T_{c}-T)\n$$\n由于 $a>0$ 且 $T  T_{c}$，我们有 $2a(T_{c}-T) > 0$。这个解对应于一个稳定的极小值。\n因此，对于 $T  T_{c}$，平衡态具有自发极化，由 $P_{eq}^{2}(T) = \\frac{a}{b}(T_{c}-T)$ 给出。\n\n接下来，我们求平衡自由能密度的贡献，$\\delta f_{eq}(T) = \\delta f(T, P_{eq}(T))$。\n对于 $T > T_{c}$，$P_{eq}(T) = 0$，所以 $\\delta f_{eq}(T) = 0$。\n对于 $T \\leq T_{c}$，我们将 $P_{eq}^{2}(T) = \\frac{a}{b}(T_{c}-T)$ 代入 $\\delta f$ 的表达式中：\n$$\n\\delta f_{eq}(T) = \\frac{a}{2}(T-T_{c}) \\left(\\frac{a}{b}(T_{c}-T)\\right) + \\frac{b}{4} \\left(\\frac{a}{b}(T_{c}-T)\\right)^{2}\n$$\n$$\n\\delta f_{eq}(T) = -\\frac{a^{2}}{2b}(T_{c}-T)^{2} + \\frac{b}{4}\\frac{a^{2}}{b^{2}}(T_{c}-T)^{2} = -\\frac{a^{2}}{2b}(T_{c}-T)^{2} + \\frac{a^{2}}{4b}(T_{c}-T)^{2}\n$$\n$$\n\\delta f_{eq}(T) = -\\frac{a^{2}}{4b}(T_{c}-T)^{2}\n$$\n对熵密度 $\\delta s(T)$ 的反常贡献由热力学关系 $s = -\\frac{\\partial f}{\\partial T}$ 得到。我们将其应用于平衡自由能贡献：$\\delta s(T) = -\\frac{d(\\delta f_{eq}(T))}{dT}$。\n对于 $T > T_{c}$，$\\delta f_{eq}(T) = 0$，所以 $\\delta s(T) = 0$。\n对于 $T \\leq T_{c}$：\n$$\n\\delta s(T) = -\\frac{d}{dT} \\left( -\\frac{a^{2}}{4b}(T_{c}-T)^{2} \\right) = \\frac{a^{2}}{4b} \\cdot 2(T_{c}-T) \\cdot (-1) = -\\frac{a^{2}}{2b}(T_{c}-T) = \\frac{a^{2}}{2b}(T-T_{c})\n$$\n对体积热容 $\\delta c(T)$ 的反常贡献由 $\\delta c(T) = T \\frac{d(\\delta s(T))}{dT}$ 给出。\n对于 $T > T_{c}$，$\\delta s(T) = 0$，所以 $\\delta c(T) = 0$。\n对于 $T  T_{c}$：\n$$\n\\delta c(T) = T \\frac{d}{dT} \\left( \\frac{a^{2}}{2b}(T-T_{c}) \\right) = T \\left( \\frac{a^{2}}{2b} \\right)\n$$\n问题将热容的跳变定义为 $\\Delta c \\equiv \\lim_{T\\to T_{c}^{-}}\\delta c(T)-\\lim_{T\\to T_{c}^{+}}\\delta c(T)$。\n我们计算这两个极限：\n从 $T_{c}$ 上方趋近的极限是：\n$$\n\\lim_{T\\to T_{c}^{+}}\\delta c(T) = \\lim_{T\\to T_{c}^{+}} (0) = 0\n$$\n从 $T_{c}$ 下方趋近的极限是：\n$$\n\\lim_{T\\to T_{c}^{-}}\\delta c(T) = \\lim_{T\\to T_{c}^{-}} \\left( T \\frac{a^{2}}{2b} \\right) = T_{c} \\frac{a^{2}}{2b}\n$$\n最后，在临界温度下热容密度的跳变为：\n$$\n\\Delta c = T_{c} \\frac{a^{2}}{2b} - 0 = \\frac{a^{2}T_{c}}{2b}\n$$\n这就是用给定的系数 $a$、$b$ 和临界温度 $T_{c}$ 表示的所求表达式。它代表了在该平均场模型中二级相变所特有的热容不连续性。", "answer": "$$\n\\boxed{\\frac{a^{2}T_{c}}{2b}}\n$$", "id": "2815634"}, {"introduction": "超越唯象的朗道理论，深入理解位移型和有序-无序型铁电转变的本质区别需要我们探究其微观机理。本练习基于一个假设性的第一性原理计算场景，通过分析两种典型钙钛矿材料的能量势能面，让您实践一个核心判据：比较能量势垒 $E_b$ 与相变点附近的热能 $k_{\\mathrm{B}}T_C$[@problem_id:2815581]。这有助于您学会如何根据微观势能景观的特征，来判断相变的主导类型并预测其相应的动力学特征，例如软模行为或中心峰散射。", "problem": "对于两种钙钛矿铁电体——钛酸钡 (BaTiO$_3$) 和铌酸钾 (KNbO$_3$)，我们通过密度泛函理论 (DFT) 得到了沿对称匹配的极性软模坐标 $Q$ 的一维能量景观。坐标 $Q$ 经过质量加权和归一化，使得小位移对应于 $Q=0$ 处立方参考结构周围的谐振区。DFT 总能量 $E(Q)$ 是相对于立方鞍点 $E(0)=0$ 报告的。对于 BaTiO$_3$，$E(Q)$ 具有一个浅双势阱，其极小值点位于 $Q=\\pm Q_0$，势阱深度为每个化学式单位 $E_b^{\\mathrm{BTO}}\\approx 15\\,\\mathrm{meV}$，在 $Q=0$ 处有小幅度的负曲率（一个不稳定的软模），其绝对值比 $Q=\\pm Q_0$ 处的曲率小一个数量级。对于 KNbO$_3$，$E(Q)$ 显示出一个更深的双势阱，其极小值点位于 $Q=\\pm Q_0$，势阱深度为每个化学式单位 $E_b^{\\mathrm{KNO}}\\approx 90\\,\\mathrm{meV}$，在 $Q=0$ 处有更强的负曲率，在极小值点有更大的曲率。立方相到四方相的居里温度分别为 $T_C^{\\mathrm{BTO}}\\approx 393\\,\\mathrm{K}$ 和 $T_C^{\\mathrm{KNO}}\\approx 708\\,\\mathrm{K}$。使用玻尔兹曼因子和玻尔兹曼常数 $k_{\\mathrm{B}}$，比较势垒高度 $E_b$ 与 $T_C$ 附近的热能 $k_{\\mathrm{B}} T$。请依据以下基本原理：(i) 在位移型相变中，随着温度接近 $T_C$，一个集体软声子模的频率向零软化，其动力学主要由围绕单一平均位置的谐振/非谐振动主导；(ii) 在有序-无序型相变中，原子处于由势垒隔开的局域偏离中心的位置，其动力学主要由在准简并极小值点之间的热激活跳跃主导，并出现中心峰或强的准弹性散射；(iii) 对于双势阱，热越过高度为 $E_b$ 的势垒的概率正比于 $\\exp(-E_b/k_{\\mathrm{B}}T)$，其在 $T_C$ 附近的特征受比率 $E_b/(k_{\\mathrm{B}}T_C)$ 的影响。\n\n哪个选项最能概括关于 BaTiO$_3$ 和 KNbO$_3$ 在其各自 $T_C$ 附近的主要特征的正确推论，以及在非弹性散射中预期观察到的相应动力学特征？\n\nA. 在 $T_C$ 附近，BaTiO$_3$ 主要是位移型的，而 KNbO$_3$ 更具有有序-无序型特征：因为 $E_b^{\\mathrm{BTO}}\\ll k_{\\mathrm{B}}T_C^{\\mathrm{BTO}}$ 但 $E_b^{\\mathrm{KNO}}\\gtrsim k_{\\mathrm{B}}T_C^{\\mathrm{KNO}}$，所以 BaTiO$_3$ 表现出一个明确的软横向光学声子，其频率随温度强烈软化且线宽相对较窄，而 KNbO$_3$ 表现出由偏离中心态之间的跳跃引起的强准弹性（中心峰）散射和相干性较差的软模行为。\n\nB. 在 $T_C$ 附近，BaTiO$_3$ 和 KNbO$_3$ 都是纯粹位移型的，因为 $Q=0$ 处的负曲率表示谐振不稳定性；两者都应该只显示出尖锐的软模声子，而没有任何中心峰。\n\nC. 在 $T_C$ 附近，BaTiO$_3$ 和 KNbO$_3$ 都是有序-无序型的，因为任何双势阱的存在都意味着跳跃；两者都不应表现出可观的声子软化，只有弛豫动力学。\n\nD. 在所有温度下，BaTiO$_3$ 比 KNbO$_3$ 更具有有序-无序型特征，因为其势垒更小；因此 BaTiO$_3$ 应该比 KNbO$_3$ 显示出更强的中心峰。\n\nE. KNbO$_3$ 是位移型的，而 BaTiO$_3$ 是有序-无序型的，因为 KNbO$_3$ 极小值点处更大的曲率意味着更强的谐振性，因此是位移型行为，不论势垒高度如何。", "solution": "该问题陈述已经过严格验证，并被认为是有效的。它在科学上基于固态物理中关于铁电相变的原理，提法得当，数据充分且一致，并且表述客观。因此，我们可以继续进行解答。\n\n该问题要求确定钛酸钡 (BaTiO$_3$) 和铌酸钾 (KNbO$_3$) 在其各自居里温度 $T_C$ 附近铁电相变的主要特征——位移型还是有序-无序型。所提供的定义基于双势阱中的能量势垒高度 $E_b$ 与可用热能 $k_{\\mathrm{B}}T_C$ 的比率，为这种分类建立了一个明确的标准。\n\n根据所提供的基本原理：\n(i) 位移型相变的特征是围绕单一平均位置的集体振动，表现为软声子模。当势垒与热能相比微不足道时，系统可以轻易地探测 $Q=0$ 周围的区域，预计会出现这种行为。\n(ii) 有序-无序型相变的特征是局域在不同的势阱中，并通过热激活在它们之间跳跃，表现为准弹性（中心峰）散射。当势垒足够大以束缚系统时，即 $E_b \\gtrsim k_{\\mathrm{B}}T$ 时，会发生这种情况。\n\n我们必须计算每种材料的热能 $k_{\\mathrm{B}}T_C$ 并将其与给定的势垒高度 $E_b$ 进行比较。玻尔兹曼常数是 $k_{\\mathrm{B}} \\approx 8.617 \\times 10^{-5} \\, \\mathrm{eV} \\cdot \\mathrm{K}^{-1}$，等同于 $k_{\\mathrm{B}} \\approx 0.08617 \\, \\mathrm{meV} \\cdot \\mathrm{K}^{-1}$。\n\n**对 BaTiO$_3$ (BTO) 的分析：**\n给定参数为 $T_C^{\\mathrm{BTO}} \\approx 393\\,\\mathrm{K}$ 和 $E_b^{\\mathrm{BTO}} \\approx 15\\,\\mathrm{meV}$。\n居里温度下的热能为：\n$$k_{\\mathrm{B}}T_C^{\\mathrm{BTO}} \\approx (0.08617 \\, \\mathrm{meV} \\cdot \\mathrm{K}^{-1}) \\times (393\\,\\mathrm{K}) \\approx 33.87\\,\\mathrm{meV}$$\n我们将势垒高度与此热能进行比较：\n$$E_b^{\\mathrm{BTO}} \\approx 15\\,\\mathrm{meV}  33.87\\,\\mathrm{meV} \\approx k_{\\mathrm{B}}T_C^{\\mathrm{BTO}}$$\n比率为 $\\frac{E_b^{\\mathrm{BTO}}}{k_{\\mathrm{B}}T_C^{\\mathrm{BTO}}} \\approx \\frac{15}{33.87} \\approx 0.44$。\n由于能量势垒远小于转变温度下的热能，离子没有被强局域在势阱中。动力学不是由跳跃主导的。相反，其行为更像一个高度非谐的振子，这是主要是位移型相变的特征。预期的实验特征是软化的光学声子模。\n\n**对 KNbO$_3$ (KNO) 的分析：**\n给定参数为 $T_C^{\\mathrm{KNO}} \\approx 708\\,\\mathrm{K}$ 和 $E_b^{\\mathrm{KNO}} \\approx 90\\,\\mathrm{meV}$。\n居里温度下的热能为：\n$$k_{\\mathrm{B}}T_C^{\\mathrm{KNO}} \\approx (0.08617 \\, \\mathrm{meV} \\cdot \\mathrm{K}^{-1}) \\times (708\\,\\mathrm{K}) \\approx 61.01\\,\\mathrm{meV}$$\n我们将势垒高度与此热能进行比较：\n$$E_b^{\\mathrm{KNO}} \\approx 90\\,\\mathrm{meV} > 61.01\\,\\mathrm{meV} \\approx k_{\\mathrm{B}}T_C^{\\mathrm{KNO}}$$\n比率为 $\\frac{E_b^{\\mathrm{KNO}}}{k_{\\mathrm{B}}T_C^{\\mathrm{KNO}}} \\approx \\frac{90}{61.01} \\approx 1.48$。\n在这里，能量势垒显著大于转变温度下的热能。这表明离子被很好地局域在偏离中心的势阱极小值点。向顺电相转变的主要动力学过程是热激活越过势垒。这对应于主要是**有序-无序型**相变。预期的实验特征是强的准弹性散射，或中心峰。\n\n根据这些结论，我们评估每个选项。\n\n**A. 在 $T_C$ 附近，BaTiO$_3$ 主要是位移型的，而 KNbO$_3$ 更具有有序-无序型特征：因为 $E_b^{\\mathrm{BTO}}\\ll k_{\\mathrm{B}}T_C^{\\mathrm{BTO}}$ 但 $E_b^{\\mathrm{KNO}}\\gtrsim k_{\\mathrm{B}}T_C^{\\mathrm{KNO}}$，所以 BaTiO$_3$ 表现出一个明确的软横向光学声子，其频率随温度强烈软化且线宽相对较窄，而 KNbO$_3$ 表现出由偏离中心态之间的跳跃引起的强准弹性（中心峰）散射和相干性较差的软模行为。**\n该选项正确地指出 BaTiO$_3$ 主要是位移型的，因为 $E_b^{\\mathrm{BTO}}$ 小于 $k_{\\mathrm{B}}T_C^{\\mathrm{BTO}}$ (使用 $\\ll$ 是一个定性陈述，但该不等式成立)。它正确地指出 KNbO$_3$ 更具有有序-无序型特征，因为 $E_b^{\\mathrm{KNO}}$ 大于 $k_{\\mathrm{B}}T_C^{\\mathrm{KNO}}$。对相应动力学特征的描述——BaTiO$_3$ 的软化声子和 KNbO$_3$ 的中心峰——分别与位移型和有序-无序型相变的物理学一致。推理和结论完全得到我们分析的支持。\n**结论：正确**\n\n**B. 在 $T_C$ 附近，BaTiO$_3$ 和 KNbO$_3$ 都是纯粹位移型的，因为 $Q=0$ 处的负曲率表示谐振不稳定性；两者都应该只显示出尖锐的软模声子，而没有任何中心峰。**\n这个推理是有缺陷的。$Q=0$ 处的负曲率表示一个不稳定模式，这是相变的必要条件，但整个势阱的形状，特别是势垒高度 $E_b$ 相对于 $k_{\\mathrm{B}}T_C$ 的大小，决定了相变的特征。它错误地忽略了势垒的重要性，并将 KNbO$_3$ 分类为纯粹位移型，这与我们发现的 $E_b^{\\mathrm{KNO}} > k_{\\mathrm{B}}T_C^{\\mathrm{KNO}}$ 相矛盾。\n**结论：不正确**\n\n**C. 在 $T_C$ 附近，BaTiO$_3$ 和 KNbO$_3$ 都是有序-无序型的，因为任何双势阱的存在都意味着跳跃；两者都不应表现出可观的声子软化，只有弛豫动力学。**\n这个推理也是有缺陷的。仅仅存在双势阱并不足以决定其为有序-无序型特征。如果势垒相对于热能很小，如 BaTiO$_3$ ($E_b^{\\mathrm{BTO}}  k_{\\mathrm{B}}T_C^{\\mathrm{BTO}}$) 的情况，跳跃就不是主要机制。系统的行为更像一个单一的、高度非谐的振子。该选项错误地将 BaTiO$_3$ 分类为有序-无序型。\n**结论：不正确**\n\n**D. 在所有温度下，BaTiO$_3$ 比 KNbO$_3$ 更具有有序-无序型特征，因为其势垒更小；因此 BaTiO$_3$ 应该比 KNbO$_3$ 显示出更强的中心峰。**\n这个前提根本上是错误的。更显著的有序-无序型特征与相对于热能*更大*的势垒相关联，这会促进局域化和跳跃。由于 $E_b^{\\mathrm{KNO}}/(k_{\\mathrm{B}}T_C^{\\mathrm{KNO}}) > E_b^{\\mathrm{BTO}}/(k_{\\mathrm{B}}T_C^{\\mathrm{BTO}})$，KNbO$_3$ 比 BaTiO$_3$ 更具有有序-无序型特征。因此结论是相反的。\n**结论：不正确**\n\n**E. KNbO$_3$ 是位移型的，而 BaTiO$_3$ 是有序-无序型的，因为 KNbO$_3$ 极小值点处更大的曲率意味着更强的谐振性，因此是位移型行为，不论势垒高度如何。**\n该选项颠倒了这两种材料的分类。极小值点处的曲率与低温铁电态*内部*的声子频率有关，而不是与相变机制本身有关。决定相变特征的关键因素是分隔势阱的势垒，而该选项明确且错误地建议忽略这一点（“不论势垒高度如何”）。\n**结论：不正确**", "answer": "$$\\boxed{A}$$", "id": "2815581"}, {"introduction": "现代材料物理研究在很大程度上依赖计算模拟来探索和预测材料性质。“软模”理论是理解位移型铁电相变的关键，而第一性原理计算是识别软模的有力工具。本练习将引导您模拟一个简化的密度泛函微扰理论（DFPT）计算流程，通过构建和对角化动力学矩阵来寻找不稳定的声子模[@problem_id:2815554]。这个计算实践能让您亲身体验如何通过寻找动力学矩阵的负特征值来发现标志着结构不稳定性的软模。", "problem": "您将执行一个受铁电体密度泛函微扰理论 (DFPT) 启发的计算任务。在 DFPT 中，区域中心 (布里渊区中心, 记为 $\\Gamma$) 的动力学矩阵是总能量相对于原子位移的质量加权海森矩阵。其本征值 $\\{\\lambda_i\\}$ 等于声子角频率的平方 $\\{\\omega_i^2\\}$。一个负本征值 $\\lambda_i < 0$ 意味着一个虚角频率 $\\omega_i = \\mathrm{i}\\,|\\omega_i|$，并标志着软模不稳定性，这是位移型铁电相变的特征。在极性绝缘体中，非解析的长程偶极-偶极相互作用贡献可以为 $\\Gamma$ 点的动力学矩阵增加一个修正项。\n\n在本练习中，您将实现一个算法，该算法会：\n- 构建 $\\Gamma$ 点的有效动力学矩阵为\n$$\nD = D_0 + c\\,D_{\\mathrm{NA}},\n$$\n其中 $D_0$ 是解析贡献，$D_{\\mathrm{NA}}$ 是非解析修正矩阵，$c \\ge 0$ 是一个无量纲的标量系数。\n- 对角化 $D$ 以获得本征值 $\\{\\lambda_i\\}$。\n- 将满足 $\\lambda_i < -\\tau$ 的模式识别为不稳定模式，其中 $\\tau$ 是一个小的正阈值，以避免虚假的数值分类。\n- 将每个负本征值转换为以太赫兹 (THz) 为单位的虚声子频率的大小。所有提供的矩阵都已进行质量加权，并以 $(2\\pi\\,\\mathrm{THz})^2$ 为单位，即每个本征值满足 $\\lambda_i = (2\\pi f_i)^2$，其中 $f_i$ 以 $\\mathrm{THz}$ 为单位测量。因此，对于一个负本征值 $\\lambda_i$，报告\n$$\nf_i = \\frac{\\sqrt{|\\lambda_i|}}{2\\pi}\n$$\n以 $\\mathrm{THz}$ 为单位。\n- 将不稳定模式的频率按升序排序，并将每个频率四舍五入到六位小数。\n\n在所有计算中使用以下设置：\n- 稳定性阈值 $\\tau = 1.0\\times 10^{-8}$，单位与动力学矩阵相同，即 $(2\\pi\\,\\mathrm{THz})^2$。\n- 报告频率 $f_i$，单位为 $\\mathrm{THz}$，每个频率四舍五入到六位小数。\n- 对每个测试用例，生成一个列表，其中第一个条目是不稳定模式的整数数量，其后是单位为 $\\mathrm{THz}$ 的不稳定模式频率。\n\n测试套件：\n对于每个测试用例，给定 $(D_0, D_{\\mathrm{NA}}, c)$。所有矩阵都是实对称的，并以 $(2\\pi\\,\\mathrm{THz})^2$ 为单位。\n\n为简洁起见，设 $x \\equiv 2\\pi$，并注意 $(x \\cdot a)^2 = (2\\pi a)^2$。\n\n1. 情况1 (一个强软模)：\n   - $D_0 = \\begin{bmatrix} -(x\\cdot 1.0)^2  0 \\\\ 0  (x\\cdot 5.0)^2 \\end{bmatrix}$\n   - $D_{\\mathrm{NA}} = \\begin{bmatrix} 0  0 \\\\ 0  0 \\end{bmatrix}$\n   - $c = 0.0$\n\n2. 情况2 (在 $\\Gamma$ 点有一个声学零点，稳定)：\n   - $D_0 = \\begin{bmatrix} 0  0 \\\\ 0  (x\\cdot 2.0)^2 \\end{bmatrix}$\n   - $D_{\\mathrm{NA}} = \\begin{bmatrix} 0  0 \\\\ 0  0 \\end{bmatrix}$\n   - $c = 0.0$\n\n3. 情况3 (一个弱不稳定模式的非解析稳定化)：\n   - $D_0 = \\begin{bmatrix} -(x\\cdot 0.2)^2  0 \\\\ 0  (x\\cdot 1.0)^2 \\end{bmatrix}$\n   - $D_{\\mathrm{NA}} = \\begin{bmatrix} (x\\cdot 1.0)^2  0 \\\\ 0  0 \\end{bmatrix}$\n   - $c = 0.2$\n\n4. 情况4 (接近零的负曲率；测试容差处理)：\n   - $D_0 = \\begin{bmatrix} -1.0\\times 10^{-9}  1.0\\times 10^{-10} \\\\ 1.0\\times 10^{-10}  (x\\cdot 3.0)^2 \\end{bmatrix}$\n   - $D_{\\mathrm{NA}} = \\begin{bmatrix} 0  0 \\\\ 0  0 \\end{bmatrix}$\n   - $c = 0.0$\n\n所需输出：\n- 您的程序必须计算每个情况的结果列表，其中每个结果列表的形式为 $[n, f_1, f_2, \\dots]$，$n$ 是整数，$f_j$ 是以 $\\mathrm{THz}$ 为单位、四舍五入到六位小数的浮点数。\n- 将所有情况的结果汇总到一行中，以方括号括起来的逗号分隔列表形式打印，不带多余空格，例如：$[[\\dots],[\\dots],\\dots]$。\n\n科学真实性要求：\n- 使用以下基本原理：$\\Gamma$ 点的动力学矩阵是质量加权的海森矩阵，其本征值为 $\\omega^2$，负本征值意味着位移型铁电软模。非解析项模拟了极性绝缘体中的长程偶极-偶极相互作用。\n- 不要引入此处规定之外的任何外部数据或假设。\n\n角度单位不适用。所有要求带单位的输出都必须按规定以 $\\mathrm{THz}$ 表示。最终输出必须如上所述在一行上，仅包含结果。", "solution": "首先将对问题进行严格的验证过程。只有在成功验证后，才会构建解决方案。\n\n**问题验证**\n\n**第1步：提取给定条件**\n问题陈述提供了以下定义、参数和数据：\n- $\\Gamma$ 点的有效动力学矩阵是 $D = D_0 + c\\,D_{\\mathrm{NA}}$。\n- $D_0$ 是动力学矩阵的解析贡献。\n- $D_{\\mathrm{NA}}$ 是非解析修正矩阵。\n- $c \\ge 0$ 是一个无量纲的标量系数。\n- $D$ 的本征值为 $\\{\\lambda_i\\}$，它们通过 $\\lambda_i = \\omega_i^2$ 与声子角频率 $\\{\\omega_i\\}$ 相关。\n- 动力学矩阵元素和本征值的单位是 $(2\\pi\\,\\mathrm{THz})^2$。\n- 如果一个模式的本征值 $\\lambda_i  -\\tau$，则该模式被识别为不稳定。\n- 数值稳定性阈值为 $\\tau = 1.0 \\times 10^{-8}$，单位为 $(2\\pi\\,\\mathrm{THz})^2$。\n- 对于具有负本征值 $\\lambda_i$ 的不稳定模式，虚频率的大小计算为 $f_i = \\frac{\\sqrt{|\\lambda_i|}}{2\\pi}$，单位为 $\\mathrm{THz}$。\n- 每个情况的输出：一个列表，其第一个元素是不稳定模式的整数计数，后跟这些模式的排序（升序）频率，四舍五入到六位小数。\n- 缩写：$x \\equiv 2\\pi$。\n- 测试用例：\n    1. 情况1：$D_0 = \\begin{bmatrix} -(x\\cdot 1.0)^2  0 \\\\ 0  (x\\cdot 5.0)^2 \\end{bmatrix}$，$D_{\\mathrm{NA}} = \\begin{bmatrix} 0  0 \\\\ 0  0 \\end{bmatrix}$，$c = 0.0$。\n    2. 情况2：$D_0 = \\begin{bmatrix} 0  0 \\\\ 0  (x\\cdot 2.0)^2 \\end{bmatrix}$，$D_{\\mathrm{NA}} = \\begin{bmatrix} 0  0 \\\\ 0  0 \\end{bmatrix}$，$c = 0.0$。\n    3. 情况3：$D_0 = \\begin{bmatrix} -(x\\cdot 0.2)^2  0 \\\\ 0  (x\\cdot 1.0)^2 \\end{bmatrix}$，$D_{\\mathrm{NA}} = \\begin{bmatrix} (x\\cdot 1.0)^2  0 \\\\ 0  0 \\end{bmatrix}$，$c = 0.2$。\n    4. 情况4：$D_0 = \\begin{bmatrix} -1.0\\times 10^{-9}  1.0\\times 10^{-10} \\\\ 1.0\\times 10^{-10}  (x\\cdot 3.0)^2 \\end{bmatrix}$，$D_{\\mathrm{NA}} = \\begin{bmatrix} 0  0 \\\\ 0  0 \\end{bmatrix}$，$c = 0.0$。\n\n**第2步：使用提取的给定条件进行验证**\n- **科学基础：** 该问题牢固地植根于固态物理学，特别是密度泛函微扰理论 (DFPT) 中研究的铁电材料的晶格动力学。动力学矩阵、其对应于声子频率平方的本征值 ($\\lambda = \\omega^2$)、由虚频率 ($\\omega^2  0$) 指示的软模不稳定性，以及极性材料中由于长程静电相互作用引起的非解析修正等概念，都是标准且正确的原理。该问题在科学上是合理的。\n- **适定性：** 该问题提供了一个清晰、明确的算法：构建一个矩阵，找到其本征值，根据阈值进行筛选，并计算由此产生的频率。每个测试用例都提供了所有必要的数据。每个情况的解的存在性和唯一性都得到了保证。\n- **客观性：** 该问题以精确、定量的术语陈述。它不含任何主观或推测性内容。\n- **缺陷分析：** 问题陈述没有违反任何无效性标准。它在科学上是合理的、可形式化的、完整的、现实的、适定的和可验证的。\n\n**第3步：结论与行动**\n该问题是**有效的**。将开发一个解决方案。\n\n**解法推导**\n\n任务的核心是通过检查其动力学矩阵 $D$ 的本征值来分析晶格在布里渊区中心 ($\\Gamma$ 点) 的稳定性。所提供的框架是一个与第一性原理计算一致的简化模型。\n\n每个测试用例的步骤如下：\n\n1.  **构建动力学矩阵 $D$**：总动力学矩阵 $D$ 由解析部分 $D_0$ 和按比例缩放的非解析部分 $c\\,D_{\\mathrm{NA}}$ 相加而成。\n    $$D = D_0 + c\\,D_{\\mathrm{NA}}$$\n    给定的矩阵是实对称的，该性质由 $D$ 继承。所有矩阵元素的单位均为 $(2\\pi\\,\\mathrm{THz})^2$。\n\n2.  **计算本征值**：计算矩阵 $D$ 的本征值 $\\{\\lambda_i\\}$。由于 $D$ 是实对称矩阵，其所有本征值都是实数。对于一个 $N \\times N$ 的矩阵，将有 $N$ 个本征值。本征值代表角频率的平方，$\\lambda_i = \\omega_i^2$。\n\n3.  **识别不稳定模式**：如果晶格模式对应的频率平方为负，则该模式是动态不稳定的。一个负的物理恢复力会导致位移的指数增长，标志着不稳定性。由于数值精度限制，我们不检查 $\\lambda_i  0$，而是使用一个更稳健的条件 $\\lambda_i  -\\tau$，其中 $\\tau = 1.0 \\times 10^{-8}$ 是一个小的正阈值。所有满足此条件的本征值都对应于不稳定模式，在相变的背景下通常称为“软模”。\n\n4.  **计算虚频率**：对于每个本征值 $\\lambda_i  -\\tau$ 的不稳定模式，角频率 $\\omega_i = \\sqrt{\\lambda_i}$ 是虚数。我们需要计算这个虚频率的大小 $f_i$，单位为 $\\mathrm{THz}$。本征值 $\\lambda_i$ 和频率 $f_i$ 之间的关系由 $\\lambda_i = (2\\pi f_i)^2 = \\omega_i^2$ 给出。对于不稳定模式，$\\lambda_i  0$，所以我们有 $\\lambda_i = -|\\lambda_i| = (i \\cdot 2\\pi f_i)^2 = -(2\\pi f_i)^2$。解出 $f_i$ 得到：\n    $$f_i = \\frac{\\sqrt{|\\lambda_i|}}{2\\pi}$$\n    单位是一致的，因为 $\\lambda_i$ 的单位是 $(2\\pi\\,\\mathrm{THz})^2$，所以 $\\sqrt{|\\lambda_i|}$ 的单位是 $2\\pi\\,\\mathrm{THz}$，除以 $2\\pi$ 后得到 $f_i$ 的单位为 $\\mathrm{THz}$。\n\n5.  **格式化输出**：将计算出的不稳定模式频率 $\\{f_i\\}$ 按升序排序。每个频率四舍五入到六位小数。一个用例的最终输出是一个列表，其中包含不稳定模式的数量，后跟排序和舍入后的频率。\n\n**测试用例分析**\n设 $x = 2\\pi$ 且 $\\tau = 1.0 \\times 10^{-8}$。\n\n**情况1：**\n- $D_0 = \\begin{bmatrix} -(x)^2  0 \\\\ 0  (5x)^2 \\end{bmatrix}$，$D_{\\mathrm{NA}} = \\mathbf{0}$，$c=0.0$。\n- $D = D_0 = \\begin{bmatrix} -(2\\pi)^2  0 \\\\ 0  (10\\pi)^2 \\end{bmatrix}$。\n- 由于 $D$ 是对角矩阵，其本征值即为对角元素：$\\lambda_1 = -(2\\pi)^2 \\approx -39.478$ 和 $\\lambda_2 = (10\\pi)^2 \\approx 986.96$。\n- 稳定性检查：$\\lambda_1  -\\tau$。该模式不稳定。$\\lambda_2  -\\tau$。该模式稳定。\n- 有 $1$ 个不稳定模式。\n- 频率计算：$f_1 = \\frac{\\sqrt{|-(2\\pi)^2|}}{2\\pi} = \\frac{2\\pi}{2\\pi} = 1.0\\,\\mathrm{THz}$。\n- 结果：$[1, 1.000000]$。\n\n**情况2：**\n- $D_0 = \\begin{bmatrix} 0  0 \\\\ 0  (2x)^2 \\end{bmatrix}$，$D_{\\mathrm{NA}} = \\mathbf{0}$，$c=0.0$。\n- $D = D_0 = \\begin{bmatrix} 0  0 \\\\ 0  (4\\pi)^2 \\end{bmatrix}$。\n- 本征值：$\\lambda_1 = 0$，$\\lambda_2 = (4\\pi)^2 \\approx 157.91$。\n- 稳定性检查：$\\lambda_1 = 0$，不小于 $-\\tau$。$\\lambda_2  -\\tau$。\n- 有 $0$ 个不稳定模式。$\\lambda_1=0$ 的本征值对应于 $\\Gamma$ 点的声学模式，这对于稳定晶体是预期的。\n- 结果：$[0]$。\n\n**情况3：**\n- $D_0 = \\begin{bmatrix} -(0.2x)^2  0 \\\\ 0  x^2 \\end{bmatrix}$，$D_{\\mathrm{NA}} = \\begin{bmatrix} x^2  0 \\\\ 0  0 \\end{bmatrix}$，$c=0.2$。\n- $D = D_0 + c D_{\\mathrm{NA}} = \\begin{bmatrix} -(0.2 \\cdot 2\\pi)^2  0 \\\\ 0  (2\\pi)^2 \\end{bmatrix} + 0.2 \\begin{bmatrix} (2\\pi)^2  0 \\\\ 0  0 \\end{bmatrix}$。\n- $D = \\begin{bmatrix} -(0.4\\pi)^2 + 0.2(2\\pi)^2  0 \\\\ 0  (2\\pi)^2 \\end{bmatrix} = \\begin{bmatrix} (-0.16+0.8)\\pi^2  0 \\\\ 0  4\\pi^2 \\end{bmatrix} = \\begin{bmatrix} 0.64\\pi^2  0 \\\\ 0  4\\pi^2 \\end{bmatrix}$。\n- 本征值：$\\lambda_1 = 0.64\\pi^2 \\approx 6.3165$，$\\lambda_2 = 4\\pi^2 \\approx 39.478$。\n- 稳定性检查：两个本征值均为正，因此都不小于 $-\\tau$。\n- 有 $0$ 个不稳定模式。非解析项稳定了在 $D_0$ 中不稳定的模式。\n- 结果：$[0]$。\n\n**情况4：**\n- $D_0 = \\begin{bmatrix} -1.0\\times 10^{-9}  1.0\\times 10^{-10} \\\\ 1.0\\times 10^{-10}  (3x)^2 \\end{bmatrix}$，$D_{\\mathrm{NA}} = \\mathbf{0}$，$c=0.0$。\n- $D = D_0 = \\begin{bmatrix} -1.0\\times 10^{-9}  1.0\\times 10^{-10} \\\\ 1.0\\times 10^{-10}  (6\\pi)^2 \\end{bmatrix}$。\n- 非对角项与对角元素之差相比非常小。本征值将非常接近对角元素。\n- $\\lambda_1 \\approx -1.0 \\times 10^{-9}$ 和 $\\lambda_2 \\approx (6\\pi)^2 \\approx 355.3$。\n- 稳定性检查：对于较小的本征值，我们测试是否 $-1.0 \\times 10^{-9}  -\\tau$，即 $-1.0 \\times 10^{-9}  -1.0 \\times 10^{-8}$。这个不等式是不成立的。\n- 有 $0$ 个不稳定模式。在给定阈值 $\\tau$ 的情况下，一个非常小的负曲率不足以被归类为不稳定性。\n- 结果：$[0]$。\n\n实现将为所有提供的测试用例自动执行这一精确的计算序列。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational problem for analyzing ferroelectric instabilities.\n    This function processes a suite of test cases, each defined by matrices D0, D_NA, \n    and a scalar c, to identify unstable phonon modes.\n    \"\"\"\n\n    # Define the stability threshold and constants\n    tau = 1.0e-8\n    x = 2.0 * np.pi\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: one strong soft mode\n        (\n            np.array([[-(x * 1.0)**2, 0.0], \n                      [0.0, (x * 5.0)**2]]),\n            np.array([[0.0, 0.0], \n                      [0.0, 0.0]]),\n            0.0\n        ),\n        # Case 2: stable with an acoustic zero at Gamma\n        (\n            np.array([[0.0, 0.0], \n                      [0.0, (x * 2.0)**2]]),\n            np.array([[0.0, 0.0], \n                      [0.0, 0.0]]),\n            0.0\n        ),\n        # Case 3: non-analytic stabilization of a weakly unstable mode\n        (\n            np.array([[-(x * 0.2)**2, 0.0], \n                      [0.0, (x * 1.0)**2]]),\n            np.array([[(x * 1.0)**2, 0.0], \n                      [0.0, 0.0]]),\n            0.2\n        ),\n        # Case 4: near-zero negative curvature; test tolerance handling\n        (\n            np.array([[-1.0e-9, 1.0e-10], \n                      [1.0e-10, (x * 3.0)**2]]),\n            np.array([[0.0, 0.0], \n                      [0.0, 0.0]]),\n            0.0\n        )\n    ]\n\n    all_results = []\n    \n    for D0, D_NA, c in test_cases:\n        # Step 1: Form the effective dynamical matrix D\n        D = D0 + c * D_NA\n        \n        # Step 2: Diagonalize D to obtain eigenvalues.\n        # Use eigvalsh for real symmetric matrices for better performance and stability.\n        eigenvalues = np.linalg.eigvalsh(D)\n        \n        # Step 3: Identify unstable modes\n        unstable_eigenvalues = [lam for lam in eigenvalues if lam  -tau]\n        \n        # Step 4: Convert each negative eigenvalue to the magnitude of the \n        # imaginary phonon frequency in THz.\n        # f_i = sqrt(|lambda_i|) / (2*pi)\n        frequencies = [np.sqrt(np.abs(lam)) / (2.0 * np.pi) for lam in unstable_eigenvalues]\n        \n        # Step 5: Sort the unstable-mode frequencies in ascending order\n        frequencies.sort()\n        \n        # Prepare the result list: [number_of_modes, freq1, freq2, ...]\n        num_unstable = len(frequencies)\n        result_list = [num_unstable] + frequencies\n        all_results.append(result_list)\n\n    # Format the final output string according to the strict specification.\n    # The output should be a single line, e.g., [[...],[...],...] with no spaces.\n    result_strings = []\n    for res_list in all_results:\n        # The format specifier f'{x:.6f}' ensures rounding to six decimal places,\n        # including trailing zeros.\n        num_unstable_str = str(res_list[0])\n        freq_strs = [f'{f:.6f}' for f in res_list[1:]]\n        \n        current_res_str = f\"[{num_unstable_str}\"\n        if freq_strs:\n            current_res_str += \",\" + \",\".join(freq_strs)\n        current_res_str += \"]\"\n        result_strings.append(current_res_str)\n        \n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "2815554"}]}