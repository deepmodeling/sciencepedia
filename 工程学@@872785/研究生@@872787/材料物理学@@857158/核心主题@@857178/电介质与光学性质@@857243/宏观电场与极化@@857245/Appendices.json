{"hands_on_practices": [{"introduction": "理解束缚电荷的概念是掌握材料中宏观电动力学的第一步。本练习提供了一个具体的情景，让您直接从一个给定的非均匀极化场出发，练习计算表面和体束缚电荷。通过解决这个问题 [@problem_id:147528]，您将巩固对极化如何产生等效电荷分布的理解，并熟练地在不同坐标系中应用矢量微积分。", "problem": "在宏观电动力学中，电介质材料对电场的响应由极化矢量 $\\mathbf{P}$ 描述，它表示单位体积内的偶极矩。这种极化会导致电荷的有效积累，称为束缚电荷。这些束缚电荷不能在材料中自由移动，而是束缚于原子或分子上。束缚电荷的体密度由 $\\rho_b = -\\nabla \\cdot \\mathbf{P}$ 给出，束缚电荷的面密度由 $\\sigma_b = \\mathbf{P} \\cdot \\hat{\\mathbf{n}}$ 给出，其中 $\\hat{\\mathbf{n}}$ 是指向电介质表面外侧的单位法向矢量。\n\n考虑一个半径为 $a$、高度为 $h$ 的实心电介质圆柱体。圆柱体的轴沿 $z$ 轴，其几何中心位于原点，因此其顶面位于 $z = h/2$，底面位于 $z = -h/2$。该材料具有永久“冻结”的极化，在柱坐标系 $(s, \\phi, z)$ 中由下式给出：\n$$\n\\mathbf{P}(s, \\phi, z) = P_0 \\left(\\frac{s}{a}\\right) \\hat{\\mathbf{s}} + P_1 \\left(\\frac{z}{h}\\right) \\hat{\\mathbf{z}}\n$$\n其中 $P_0$ 和 $P_1$ 是具有极化单位（单位面积的电荷）的正常量，$\\hat{\\mathbf{s}}$ 是径向单位矢量，$\\hat{\\mathbf{z}}$ 是轴向单位矢量。\n\n计算位于圆柱体整个表面上的总束缚电荷 $Q_b^{\\text{surf}}$。", "solution": "表面上的总束缚电荷 $ Q_b^{\\text{surf}} $ 可以通过在圆柱体的整个表面上对表面束缚电荷密度 $ \\sigma_b = \\mathbf{P} \\cdot \\hat{\\mathbf{n}} $ 进行积分来求得。该圆柱体有三个表面：顶面、底面和侧面。\n\n极化矢量由下式给出：\n\n$$\n\\mathbf{P} = P_0 \\left( \\frac{s}{a} \\right) \\hat{\\mathbf{s}} + P_1 \\left( \\frac{z}{h} \\right) \\hat{\\mathbf{z}}\n$$\n\n\n### 顶面 ($ z = h/2 $, $ \\hat{\\mathbf{n}} = \\hat{\\mathbf{z}} $):\n在 $ z = h/2 $ 处，\n\n$$\n\\mathbf{P} = P_0 \\left( \\frac{s}{a} \\right) \\hat{\\mathbf{s}} + P_1 \\left( \\frac{1}{2} \\right) \\hat{\\mathbf{z}}\n$$\n\n\n$$\n\\sigma_b = \\mathbf{P} \\cdot \\hat{\\mathbf{z}} = P_1 \\left( \\frac{1}{2} \\right) = \\frac{P_1}{2}\n$$\n\n顶面的面积为 $ \\pi a^2 $，因此：\n\n$$\nQ_b^{\\text{top}} = \\int \\sigma_b  dA = \\frac{P_1}{2} \\cdot \\pi a^2 = \\frac{\\pi a^2 P_1}{2}\n$$\n\n\n### 底面 ($ z = -h/2 $, $ \\hat{\\mathbf{n}} = -\\hat{\\mathbf{z}} $):\n在 $ z = -h/2 $ 处，\n\n$$\n\\mathbf{P} = P_0 \\left( \\frac{s}{a} \\right) \\hat{\\mathbf{s}} + P_1 \\left( -\\frac{1}{2} \\right) \\hat{\\mathbf{z}} = P_0 \\left( \\frac{s}{a} \\right) \\hat{\\mathbf{s}} - \\frac{P_1}{2} \\hat{\\mathbf{z}}\n$$\n\n\n$$\n\\sigma_b = \\mathbf{P} \\cdot (-\\hat{\\mathbf{z}}) = -\\left( -\\frac{P_1}{2} \\right) = \\frac{P_1}{2}\n$$\n\n底面的面积为 $ \\pi a^2 $，因此：\n\n$$\nQ_b^{\\text{bottom}} = \\frac{P_1}{2} \\cdot \\pi a^2 = \\frac{\\pi a^2 P_1}{2}\n$$\n\n\n### 侧面 ($ s = a $, $ \\hat{\\mathbf{n}} = \\hat{\\mathbf{s}} $):\n在 $ s = a $ 处，\n\n$$\n\\mathbf{P} = P_0 \\left( \\frac{a}{a} \\right) \\hat{\\mathbf{s}} + P_1 \\left( \\frac{z}{h} \\right) \\hat{\\mathbf{z}} = P_0 \\hat{\\mathbf{s}} + P_1 \\left( \\frac{z}{h} \\right) \\hat{\\mathbf{z}}\n$$\n\n\n$$\n\\sigma_b = \\mathbf{P} \\cdot \\hat{\\mathbf{s}} = P_0\n$$\n\n侧面的面积为 $ 2\\pi a h $，因此：\n\n$$\nQ_b^{\\text{lateral}} = P_0 \\cdot 2\\pi a h = 2\\pi a h P_0\n$$\n\n\n### 总表面束缚电荷：\n\n$$\nQ_b^{\\text{surf}} = Q_b^{\\text{top}} + Q_b^{\\text{bottom}} + Q_b^{\\text{lateral}} = \\frac{\\pi a^2 P_1}{2} + \\frac{\\pi a^2 P_1}{2} + 2\\pi a h P_0 = \\pi a^2 P_1 + 2\\pi a h P_0\n$$\n\n\n作为验证，体束缚电荷密度为 $ \\rho_b = -\\nabla \\cdot \\mathbf{P} $。在柱坐标系中：\n\n$$\n\\nabla \\cdot \\mathbf{P} = \\frac{1}{s} \\frac{\\partial}{\\partial s} \\left( s P_s \\right) + \\frac{\\partial P_z}{\\partial z} = \\frac{1}{s} \\frac{\\partial}{\\partial s} \\left( s \\cdot P_0 \\frac{s}{a} \\right) + \\frac{\\partial}{\\partial z} \\left( P_1 \\frac{z}{h} \\right) = \\frac{1}{s} \\frac{\\partial}{\\partial s} \\left( \\frac{P_0}{a} s^2 \\right) + P_1 \\frac{1}{h}\n$$\n\n\n$$\n= \\frac{1}{s} \\cdot \\frac{2 P_0}{a} s + \\frac{P_1}{h} = \\frac{2 P_0}{a} + \\frac{P_1}{h}\n$$\n\n\n$$\n\\rho_b = -\\left( \\frac{2 P_0}{a} + \\frac{P_1}{h} \\right)\n$$\n\n总体束缚电荷为：\n\n$$\nQ_b^{\\text{vol}} = \\int \\rho_b  dV = -\\left( \\frac{2 P_0}{a} + \\frac{P_1}{h} \\right) \\int_0^{2\\pi} d\\phi \\int_0^a s  ds \\int_{-h/2}^{h/2} dz = -\\left( \\frac{2 P_0}{a} + \\frac{P_1}{h} \\right) (2\\pi) \\left( \\frac{a^2}{2} \\right) (h) = -2\\pi a h P_0 - \\pi a^2 P_1\n$$\n\n总束缚电荷（表面加体积）为：\n\n$$\nQ_b^{\\text{total}} = Q_b^{\\text{surf}} + Q_b^{\\text{vol}} = (\\pi a^2 P_1 + 2\\pi a h P_0) + (-2\\pi a h P_0 - \\pi a^2 P_1) = 0\n$$\n\n这证实了电介质是电中性的，从而支持了表面电荷的计算结果。", "answer": "$$ \\boxed{2\\pi a h P_0 + \\pi a^2 P_1} $$", "id": "147528"}, {"introduction": "真实材料很少是完美的绝缘体；它们通常具有一定的电导率，导致电荷不均匀性随时间弛豫。这个问题 [@problem_id:147440] 探讨了各向异性介质中的这种动力学过程，其中介电常数和电导率等材料属性都依赖于方向。通过推导一个电荷密度波的弛豫时间，您将学会如何将基本的电磁学定律与张量本构关系相结合，来预测与方向相关的动态现象。", "problem": "考虑一个均匀、各向异性、线性的“有损”介电材料。该材料对电场 $\\mathbf{E}$ 的响应由电位移 $\\mathbf{D}$ 和自由电流密度 $\\mathbf{J}$ 的本构关系描述：\n$$ \\mathbf{D} = \\boldsymbol{\\epsilon} \\mathbf{E} $$\n$$ \\mathbf{J} = \\boldsymbol{\\sigma} \\mathbf{E} $$\n在笛卡尔坐标系 $(x,y,z)$ 中，介电常数张量 $\\boldsymbol{\\epsilon}$ 和电导率张量 $\\boldsymbol{\\sigma}$ 是对角的，其主分量分别为常数 $(\\epsilon_x, \\epsilon_y, \\epsilon_z)$ 和 $(\\sigma_x, \\sigma_y, \\sigma_z)$。\n\n自由电荷密度 $\\rho_f$ 的动力学由高斯定律 $\\nabla \\cdot \\mathbf{D} = \\rho_f$ 和电荷连续性方程 $\\nabla \\cdot \\mathbf{J} + \\frac{\\partial \\rho_f}{\\partial t} = 0$ 决定。你可以忽略任何磁效应，这意味着电场是无旋的，可以表示为标量势的梯度，$\\mathbf{E} = -\\nabla V$。\n\n在时间 $t=0$ 时，材料内部建立了一个小的自由电荷密度扰动。这个扰动具有 $\\rho_f(\\mathbf{r}, 0) \\propto \\cos(\\mathbf{k} \\cdot \\mathbf{r})$ 形式的正弦空间依赖性，其中 $\\mathbf{k}$ 是波矢量。由于材料的导电性，这种电荷分布会随时间耗散。可以证明，这样的电荷密度模式会按 $\\rho_f(\\mathbf{r}, t) = \\rho_f(\\mathbf{r}, 0) e^{-t/\\tau}$ 指数衰减。\n\n计算一个电荷密度扰动的时间常数 $\\tau$，其波矢量 $\\mathbf{k}$ 的方向与向量 $\\mathbf{u} = (a, b, c)$ 的方向相同，其中 $a, b, c$ 是给定的常数。", "solution": "1. 高斯定律和连续性方程给出\n$$\\nabla\\cdot\\mathbf{D}=\\rho_f,\\qquad \\nabla\\cdot\\mathbf{J}+\\frac{\\partial\\rho_f}{\\partial t}=0.$$\n对于 $\\mathbf{D}=\\boldsymbol\\epsilon\\mathbf{E}$、$\\mathbf{J}=\\boldsymbol\\sigma\\mathbf{E}$ 和 $\\mathbf{E}=-\\nabla V$，假设一个模式\n$$\\rho_f(\\mathbf r,t)=\\rho_k e^{i\\mathbf k\\cdot\\mathbf r}e^{-t/\\tau},\\quad V(\\mathbf r,t)=V_k e^{i\\mathbf k\\cdot\\mathbf r}e^{-t/\\tau}.$$\n2. 根据高斯定律，\n$$\\nabla\\cdot\\mathbf{D}=i\\mathbf k\\cdot(\\boldsymbol\\epsilon(-i\\mathbf k)V_k e^{i\\mathbf k\\cdot\\mathbf r}e^{-t/\\tau})\n=(\\mathbf k\\cdot\\boldsymbol\\epsilon\\mathbf k)\\,V_ke^{i\\mathbf k\\cdot\\mathbf r}e^{-t/\\tau}\n=\\rho_k e^{i\\mathbf k\\cdot\\mathbf r}e^{-t/\\tau}.$$\n因此\n$$V_k=\\frac{\\rho_k}{\\mathbf k\\cdot\\boldsymbol\\epsilon\\,\\mathbf k}.$$\n3. 根据连续性方程，\n$$\\nabla\\cdot\\mathbf{J}+\\frac{\\partial\\rho_f}{\\partial t}\n=i\\mathbf k\\cdot(\\boldsymbol\\sigma(-i\\mathbf k)V_k)e^{i\\mathbf k\\cdot\\mathbf r}e^{-t/\\tau}\n+\\bigl(-\\tfrac1\\tau\\rho_k\\bigr)e^{i\\mathbf k\\cdot\\mathbf r}e^{-t/\\tau}=0.$$\n所以\n$$(\\mathbf k\\cdot\\boldsymbol\\sigma\\,\\mathbf k)\\,V_k=\\frac{1}{\\tau}\\rho_k\n\\;\\Longrightarrow\\;\n\\frac{1}{\\tau}=\\frac{\\mathbf k\\cdot\\boldsymbol\\sigma\\,\\mathbf k}{\\mathbf k\\cdot\\boldsymbol\\epsilon\\,\\mathbf k}.$$\n4. 对于 $\\mathbf k\\parallel\\mathbf u=(a,b,c)$，$\\mathbf k$ 的大小可以约去，得到\n$$\\tau=\\frac{\\mathbf u\\cdot\\boldsymbol\\epsilon\\,\\mathbf u}{\\mathbf u\\cdot\\boldsymbol\\sigma\\,\\mathbf u}\n=\\frac{a^2\\epsilon_x+b^2\\epsilon_y+c^2\\epsilon_z}{a^2\\sigma_x+b^2\\sigma_y+c^2\\sigma_z}.$$", "answer": "$$\\boxed{\\frac{a^2\\epsilon_x+b^2\\epsilon_y+c^2\\epsilon_z}{a^2\\sigma_x+b^2\\sigma_y+c^2\\sigma_z}}$$", "id": "147440"}, {"introduction": "频率依赖的介电函数 $\\varepsilon(\\omega)$ 是描述材料光学和电子性质的基石。这个计算练习 [@problem_id:2838447] 将挑战您连接时间域和频率域，这是实验光谱学和理论建模的核心任务。通过处理合成的时间域极化数据以提取 $\\varepsilon(\\omega)$，并利用克拉默-克若尼关系验证其自洽性，您将亲身体验物理因果律与材料光谱特性之间的深刻联系。", "problem": "您必须编写一个完整且可运行的程序，该程序使用线性因果电介质中对阶跃电场的宏观极化响应的合成但科学上可靠的时域数据，反演得到复、频率依赖的相对介电常数，并评估结果是否与Kramers–Kronig关系一致。推导必须从基本定义开始：宏观位移场在时域中满足$\\,\\mathbf{D}(t)=\\varepsilon_{0}\\mathbf{E}(t)+\\mathbf{P}(t)\\,$，对于线性、时不变、因果介质，极化强度由因果卷积$\\,P(t)=\\varepsilon_{0}\\int_{-\\infty}^{\\infty}\\chi_{\\mathrm{e}}(t-t')E(t')\\,\\mathrm{d}t'\\,$给出，其中当$\\,t0\\,$时，$\\,\\chi_{\\mathrm{e}}(t)=0\\,$。采用双边傅里叶变换约定$\\,F(\\omega)=\\int_{-\\infty}^{\\infty}f(t)\\,e^{i\\omega t}\\,\\mathrm{d}t\\,$，这样时域中的卷积对应于频域中的乘法，并使用相对介电常数$\\,\\varepsilon_{\\mathrm{r}}(\\omega)=\\varepsilon_{\\infty}+\\chi_{\\mathrm{e}}(\\omega)\\,$，其中$\\,\\varepsilon_{\\infty}\\,$是高频极限（无量纲），$\\,\\chi_{\\mathrm{e}}(\\omega)\\,$是频域中的电极化率。程序必须从在阶跃电场$\\,E(t)=E_{0}u(t)\\,$下生成的给定$\\,P(t)\\,$记录中恢复$\\,\\varepsilon_{\\mathrm{r}}(\\omega)\\,$，然后测试恢复的$\\,\\varepsilon_{\\mathrm{r}}(\\omega)\\,$是否与适用于因果线性电介质的Kramers–Kronig关系一致。\n\n您的程序必须遵守以下所有要求。\n\n- 物理和数值设置：\n  - 在国际单位制（SI）中进行计算。使用$\\,\\varepsilon_{0}=8.854\\,187\\,817\\times 10^{-12}\\,\\mathrm{F/m}\\,$。时间单位为$\\,\\mathrm{s}\\,$，角频率单位为$\\,\\mathrm{rad/s}\\,$，电场单位为$\\,\\mathrm{V/m}\\,$，极化强度单位为$\\,\\mathrm{C/m^{2}}\\,$。\n  - $\\,P(t)\\,$的输入数据应在您的程序中按如下方式合成。对于阶跃电场$\\,E(t)=E_{0}u(t)\\,$，当$\\,t\\ge 0\\,$时定义极化模型\n    $$\\frac{P(t)}{\\varepsilon_{0}E_{0}}=\\sum_{k=1}^{K}\\Delta\\varepsilon_{k}\\left(1-e^{-t/\\tau_{k}}\\right),$$\n    其中$\\,\\Delta\\varepsilon_{k}>0\\,$和$\\,\\tau_{k}>0\\,$是给定的材料参数，$\\,k=1,\\dots,K\\,$。当$\\,t0\\,$时，设置$\\,P(t)=0\\,$。可选地，按照下面的测试套件中的规定，向$\\,P(t)\\,$添加零均值高斯噪声。\n  - 根据合成的$\\,P(t)\\,$和已知的$\\,E_{0}\\,$，数值恢复当$\\,t\\ge 0\\,$时的时域电极化率$\\,\\chi_{\\mathrm{e}}(t)\\,$，然后在一个选定的角频率网格$\\,\\{\\omega_{m}\\}_{m=1}^{M}\\,$上计算其频域对应物$\\,\\chi_{\\mathrm{e}}(\\omega)\\,$，该网格至少从$\\,\\omega_{\\min}=2\\pi/T\\,$跨越到$\\,\\omega_{\\max}=\\pi/\\Delta t\\,$，其中$\\,T\\,$是总记录长度，$\\,\\Delta t\\,$是采样间隔。使用与所述约定一致的、数值上稳健的求积法来计算傅里叶积分。\n  - 构造$\\,\\varepsilon_{\\mathrm{r}}(\\omega)=\\varepsilon_{\\infty}+\\chi_{\\mathrm{e}}(\\omega)\\,$。\n\n- Kramers–Kronig一致性测试：\n  - 实现适用于具有有限$\\,\\varepsilon_{\\infty}\\,$的弛豫电介质的减法Kramers–Kronig关系，在离散频率网格上从$\\,\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}(\\omega)\\,$重构$\\,\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}(\\omega)-\\varepsilon_{\\infty}\\,$，反之亦然，使用排除奇异自项的主值求积法。对求积使用线性频率间隔，并使用梯形法则进行数值积分。\n  - 在一个内部频带上定义相对误差，该频带排除少数最低和最高频率样本，以减轻有限带宽效应。相对误差必须计算为原始分量与Kramers–Kronig重构分量之间的$\\,\\ell^{2}\\,$范数比，必要时使用小的正则化以避免除以零。\n  - 对于每个测试用例，报告一个布尔值，当且仅当两个相对误差都小于或等于一个固定的容差$\\,\\delta\\,$时，该值为真。\n\n- 测试套件：\n  - 使用以下四个测试用例，每个用例都提供了$\\,P(t)\\,$的自包含合成：\n    1. 情况1（单一弛豫，良好分辨，无噪声）：$\\,E_{0}=1.0\\times 10^{5}\\,\\mathrm{V/m}\\,$，$\\,\\varepsilon_{\\infty}=2.0\\,$，一项，参数为$\\,\\Delta\\varepsilon_{1}=3.0\\,$和$\\,\\tau_{1}=5.0\\times 10^{-7}\\,\\mathrm{s}\\,$，采样间隔$\\,\\Delta t=1.0\\times 10^{-8}\\,\\mathrm{s}\\,$，样本数$\\,N=4096\\,$，无添加噪声。\n    2. 情况2（双弛豫，良好分辨，无噪声）：$\\,E_{0}=1.0\\times 10^{5}\\,\\mathrm{V/m}\\,$，$\\,\\varepsilon_{\\infty}=1.4\\,$，两项，参数为$\\,(\\Delta\\varepsilon_{1},\\tau_{1})=(2.0,2.0\\times 10^{-7}\\,\\mathrm{s})\\,$和$\\,(\\Delta\\varepsilon_{2},\\tau_{2})=(1.0,4.0\\times 10^{-6}\\,\\mathrm{s})\\,$，采样间隔$\\,\\Delta t=1.0\\times 10^{-8}\\,\\mathrm{s}\\,$，样本数$\\,N=4096\\,$，无添加噪声。\n    3. 情况3（单一弛豫，粗糙且短的记录，有噪声）：$\\,E_{0}=1.0\\times 10^{5}\\,\\mathrm{V/m}\\,$，$\\,\\varepsilon_{\\infty}=2.0\\,$，一项，参数为$\\,\\Delta\\varepsilon_{1}=3.0\\,$和$\\,\\tau_{1}=3.0\\times 10^{-6}\\,\\mathrm{s}\\,$，采样间隔$\\,\\Delta t=5.0\\times 10^{-8}\\,\\mathrm{s}\\,$，样本数$\\,N=256\\,$，添加独立同分布的高斯噪声，其标准差等于$\\,\\eta\\,\\max_{t\\in[0,T]}|P(t)|\\,$，其中$\\,\\eta=1.0\\times 10^{-1}\\,$。\n    4. 情况4（单一弛豫，记录相对于弛豫时间非常短）：$\\,E_{0}=1.0\\times 10^{5}\\,\\mathrm{V/m}\\,$，$\\,\\varepsilon_{\\infty}=2.0\\,$，一项，参数为$\\,\\Delta\\varepsilon_{1}=3.0\\,$和$\\,\\tau_{1}=1.0\\times 10^{-4}\\,\\mathrm{s}\\,$，采样间隔$\\,\\Delta t=1.0\\times 10^{-8}\\,\\mathrm{s}\\,$，样本数$\\,N=256\\,$，无添加噪声。\n  - 对于所有情况，根据上面指定的记录参数构建频率网格，并将Kramers–Kronig一致性容差设置为$\\,\\delta=2.5\\times 10^{-1}\\,$。\n\n- 输出格式：\n  - 您的程序必须输出一行，其中包含与上述情况相对应的四个布尔结果，按顺序排列，格式为用方括号括起来的逗号分隔列表，例如$\\,\\left[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True}\\right]\\,$。不得打印任何其他文本。\n\n以SI单位表示所有内部物理量，并确保所有数值角度都以弧度为单位。最终输出是布尔值，因此无量纲。您实现的推导和算法步骤必须由所述的基本定律和定义来证明，而不是通过没有依据的捷径。", "solution": "我们从时域中的宏观本构关系$\\,\\mathbf{D}(t)=\\varepsilon_{0}\\mathbf{E}(t)+\\mathbf{P}(t)\\,$和线性时不变响应$\\,P(t)=\\varepsilon_{0}\\int_{-\\infty}^{\\infty}\\chi_{\\mathrm{e}}(t-t')E(t')\\,\\mathrm{d}t'\\,$开始，其中因果性要求当$\\,t0\\,$时$\\,\\chi_{\\mathrm{e}}(t)=0\\,$。对于阶跃电场$\\,E(t)=E_{0}u(t)\\,$，当$\\,t\\ge 0\\,$时我们有\n$$\nP(t)=\\varepsilon_{0}E_{0}\\int_{0}^{t}\\chi_{\\mathrm{e}}(\\tau)\\,\\mathrm{d}\\tau,\n$$\n这是通过代入$\\,E(t')=E_{0}u(t')\\,$并更换变量得到的。对$\\,t\\,$求导得出\n$$\n\\frac{\\mathrm{d}P}{\\mathrm{d}t}(t)=\\varepsilon_{0}E_{0}\\,\\chi_{\\mathrm{e}}(t),\\quad t>0.\n$$\n这个恒等式是线性和因果性的直接结果，并在输入为阶跃时提供了一种时域中的操作性反演方法：给定$\\,P(t)\\,$和$\\,E_{0}\\,$，可以得到\n$$\n\\chi_{\\mathrm{e}}(t)=\\frac{1}{\\varepsilon_{0}E_{0}}\\frac{\\mathrm{d}P}{\\mathrm{d}t}(t),\\quad t\\ge 0.\n$$\n\n为了转换到频域，我们采用傅里叶变换约定\n$$\n\\mathcal{F}\\{f\\}(\\omega)=\\int_{-\\infty}^{\\infty}f(t)\\,e^{i\\omega t}\\,\\mathrm{d}t,\n$$\n这样对于时间卷积$\\,f*g\\,$，有$\\,\\mathcal{F}\\{f*g\\}(\\omega)=\\mathcal{F}\\{f\\}(\\omega)\\,\\mathcal{F}\\{g\\}(\\omega)\\,$。对于支撑在$\\,t\\ge 0\\,$上的因果$\\,\\chi_{\\mathrm{e}}(t)\\,$，其傅里叶变换为\n$$\n\\chi_{\\mathrm{e}}(\\omega)=\\int_{0}^{\\infty}\\chi_{\\mathrm{e}}(t)\\,e^{i\\omega t}\\,\\mathrm{d}t.\n$$\n在频域中，相对介电常数为\n$$\n\\varepsilon_{\\mathrm{r}}(\\omega)=\\varepsilon_{\\infty}+\\chi_{\\mathrm{e}}(\\omega),\n$$\n其中$\\,\\varepsilon_{\\infty}=\\lim_{\\omega\\to\\infty}\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}(\\omega)\\,$是高频极限。对于时间常数为$\\,\\tau\\,$、强度为$\\,\\Delta\\varepsilon\\,$的Debye弛豫，有$\\,\\chi_{\\mathrm{e}}(t)=(\\Delta\\varepsilon/\\tau)e^{-t/\\tau}\\,u(t)\\,$，这与用于合成测试数据的阶跃响应模型$\\,P(t)/(\\varepsilon_{0}E_{0})=\\Delta\\varepsilon(1-e^{-t/\\tau})\\,$一致。对于多重弛豫，适用线性叠加原理。\n\nKramers–Kronig关系源于因果性以及响应函数在复频率上半平面的解析性。对于具有有限$\\,\\varepsilon_{\\infty}\\,$的电介质，连接$\\,\\varepsilon_{\\mathrm{r}}(\\omega)\\,$实部和虚部的减法关系为\n$$\n\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}(\\omega)-\\varepsilon_{\\infty}=\\frac{2}{\\pi}\\,\\mathcal{P}\\int_{0}^{\\infty}\\frac{\\Omega\\,\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}(\\Omega)}{\\Omega^{2}-\\omega^{2}}\\,\\mathrm{d}\\Omega,\n$$\n$$\n\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}(\\omega)=-\\frac{2\\omega}{\\pi}\\,\\mathcal{P}\\int_{0}^{\\infty}\\frac{\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}(\\Omega)-\\varepsilon_{\\infty}}{\\Omega^{2}-\\omega^{2}}\\,\\mathrm{d}\\Omega,\n$$\n其中$\\,\\mathcal{P}\\,$表示柯西主值。这些公式为测试测量或计算出的$\\,\\varepsilon_{\\mathrm{r}}(\\omega)\\,$是否与因果性一致提供了基础。\n\n在程序中实现的算法步骤如下。\n\n1. 使用测试套件参数，为$\\,t_{n}=n\\,\\Delta t\\,$（其中$\\,n=0,1,\\dots,N-1\\,$）合成$\\,P(t)\\,$。对于$\\,t0\\,$，设置$\\,P(t)=0\\,$。如果指定，添加标准差为$\\,\\eta\\,\\max_{n}|P(t_{n})|\\,$的零均值高斯噪声。所有量均采用SI单位。\n\n2. 计算数值时间导数$\\,\\mathrm{d}P/\\mathrm{d}t\\,$，例如通过适用于均匀采样的梯度算子使用中心有限差分法。得到\n$$\n\\chi_{\\mathrm{e}}(t_{n})=\\frac{1}{\\varepsilon_{0}E_{0}}\\left.\\frac{\\mathrm{d}P}{\\mathrm{d}t}\\right|_{t=t_{n}},\\quad n=0,1,\\dots,N-1.\n$$\n可选地，在存在噪声的情况下，可以对导数进行轻度正则化或平滑处理，但这并非物理上严格要求的。\n\n3. 选择一个在$\\,\\left[\\omega_{\\min},\\omega_{\\max}\\right]\\,$上线性间隔的频率网格$\\,\\omega_{m}\\,$，其中$\\,\\omega_{\\min}=2\\pi/T\\,$（$\\,T=N\\,\\Delta t\\,$）和$\\,\\omega_{\\max}=\\pi/\\Delta t\\,$。对于$\\,\\omega=\\omega_{m}\\,$，通过黎曼和近似傅里叶变换\n$$\n\\chi_{\\mathrm{e}}(\\omega_{m})\\approx\\sum_{n=0}^{N-1}\\chi_{\\mathrm{e}}(t_{n})\\,e^{i\\omega_{m}t_{n}}\\,\\Delta t.\n$$\n构造\n$$\n\\varepsilon_{\\mathrm{r}}(\\omega_{m})=\\varepsilon_{\\infty}+\\chi_{\\mathrm{e}}(\\omega_{m}).\n$$\n\n4. 在离散网格上数值实现减法Kramers–Kronig关系。对于线性频率间隔$\\,\\Delta\\omega\\,$和梯形权重，对每个内部索引$\\,m\\,$，通过对$\\,j\\neq m\\,$求和来计算主值积分：\n$$\n\\left[\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}(\\omega_{m})\\right]_{\\mathrm{KK}}=\\varepsilon_{\\infty}+\\frac{2}{\\pi}\\sum_{j\\neq m}w_{j}\\,\\frac{\\omega_{j}\\,\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}(\\omega_{j})}{\\omega_{j}^{2}-\\omega_{m}^{2}},\n$$\n$$\n\\left[\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}(\\omega_{m})\\right]_{\\mathrm{KK}}=-\\frac{2\\omega_{m}}{\\pi}\\sum_{j\\neq m}w_{j}\\,\\frac{\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}(\\omega_{j})-\\varepsilon_{\\infty}}{\\omega_{j}^{2}-\\omega_{m}^{2}},\n$$\n其中$\\,w_{j}\\,$是梯形权重，对于内部点等于$\\,\\Delta\\omega\\,$，在端点等于$\\,\\Delta\\omega/2\\,$。省略自项$\\,j=m\\,$以实现主值。\n\n5. 在一个内部频带$\\,m=m_{\\mathrm{lo}},\\dots,m_{\\mathrm{hi}}\\,$上评估相对误差以避免边界效应，例如在两端舍弃几个样本。定义\n$$\n\\epsilon_{\\mathrm{Re}}=\\frac{\\left\\|\\left(\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}-\\varepsilon_{\\infty}\\right)-\\left(\\left(\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}\\right)_{\\mathrm{KK}}-\\varepsilon_{\\infty}\\right)\\right\\|_{2}}{\\left\\|\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}-\\varepsilon_{\\infty}\\right\\|_{2}+\\epsilon_{0}},\n\\quad\n\\epsilon_{\\mathrm{Im}}=\\frac{\\left\\|\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}-\\left(\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}\\right)_{\\mathrm{KK}}\\right\\|_{2}}{\\left\\|\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}\\right\\|_{2}+\\epsilon_{0}},\n$$\n使用小的正则化项$\\,\\epsilon_{0}\\,$（例如$\\,\\epsilon_{0}=10^{-12}\\,$）以避免在病态情况下除以零。如果$\\,\\max(\\epsilon_{\\mathrm{Re}},\\epsilon_{\\mathrm{Im}})\\le \\delta\\,$（其中$\\,\\delta=2.5\\times 10^{-1}\\,$），则声明Kramers–Kronig一致。\n\n四个测试用例按问题陈述中的规定构建。具有良好分辨、无噪声数据的用例（用例1和2）应产生远低于容差的较小相对误差，因此符合一致性。具有短或粗糙记录和噪声的用例（用例3和4）会降低反演和有限带宽Kramers–Kronig求积的质量，通常会产生超过容差的较大相对误差，因此不符合一致性。\n\n程序必须为每个用例合成$\\,P(t)\\,$，执行上述步骤，最后打印一行Python风格的布尔值列表$\\,\\left[\\mathrm{b}_{1},\\mathrm{b}_{2},\\mathrm{b}_{3},\\mathrm{b}_{4}\\right]\\,$，按顺序指示用例1到4的Kramers–Kronig一致性情况。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Constants (SI units)\nEPS0 = 8.854187817e-12  # F/m\n\ndef synthesize_P(t, E0, terms, noise_level=0.0, rng=None):\n    \"\"\"\n    Synthesize P(t) for a step field E(t) = E0 * u(t) with Debye relaxations:\n    P(t)/(eps0*E0) = sum_k Delta_eps_k * (1 - exp(-t/tau_k)), for t >= 0.\n    terms: list of (Delta_eps, tau)\n    noise_level: relative std dev with respect to max|P(t)| (absolute).\n    \"\"\"\n    P = np.zeros_like(t)\n    # t>=0 assumed for supplied t\n    for d_eps, tau in terms:\n        P += EPS0 * E0 * d_eps * (1.0 - np.exp(-t / tau))\n    if noise_level > 0.0:\n        if rng is None:\n            rng = np.random.default_rng(12345)\n        sigma = noise_level * np.max(np.abs(P)) if np.max(np.abs(P)) > 0 else 0.0\n        P = P + rng.normal(0.0, sigma, size=P.shape)\n    return P\n\ndef numerical_derivative_uniform(y, dt):\n    \"\"\"\n    Compute numerical derivative dy/dt for uniformly sampled y(t) with spacing dt.\n    Uses central differences for interior, forward/backward for edges.\n    \"\"\"\n    dy = np.empty_like(y)\n    # Forward difference at start\n    dy[0] = (y[1] - y[0]) / dt\n    # Central differences interior\n    dy[1:-1] = (y[2:] - y[:-2]) / (2.0 * dt)\n    # Backward difference at end\n    dy[-1] = (y[-1] - y[-2]) / dt\n    return dy\n\ndef compute_susceptibility_time(P, E0, dt):\n    \"\"\"\n    Compute chi_e(t) = (1/(eps0*E0)) * dP/dt from P(t)\n    \"\"\"\n    dPdt = numerical_derivative_uniform(P, E0, dt)\n    chi_t = dPdt / (EPS0 * E0)\n    return chi_t\n\ndef fourier_transform_one_sided(chi_t, t, omega):\n    \"\"\"\n    Compute chi_e(omega) = integral_0^T chi_e(t) * exp(i*omega*t) dt\n    using Riemann sum.\n    \"\"\"\n    dt = t[1] - t[0]\n    # Matrix exponential evaluation: t[:,None] * omega[None,:]\n    phase = np.exp(1j * np.outer(t, omega))  # shape (N, M)\n    chi_w = dt * (chi_t[:, None] * phase).sum(axis=0)\n    return chi_w\n\ndef kk_from_imag(omega, eps_im, eps_inf):\n    \"\"\"\n    Compute Re[eps_r](omega) via Kramers-Kronig from Im[eps_r](omega), subtracted form.\n    Re[eps_r](w) - eps_inf = (2/pi) P ∫_0^∞ [Omega * Im eps_r(Omega)]/(Omega^2 - w^2) dOmega\n    Implemented on discrete, linearly spaced omega grid with trapezoidal weights.\n    \"\"\"\n    M = omega.size\n    # Linear spacing assumed\n    domega = omega[1] - omega[0]\n    weights = np.ones(M) * domega\n    weights[0] *= 0.5\n    weights[-1] *= 0.5\n\n    re_eps = np.empty(M, dtype=float)\n    for m in range(M):\n        # Principal value: exclude j == m\n        denom = omega**2 - omega[m]**2\n        with np.errstate(divide='ignore', invalid='ignore'):\n            integrand = omega * eps_im / denom\n        integrand[m] = 0.0  # exclude self-term\n        val = (2.0 / np.pi) * np.sum(weights * integrand)\n        re_eps[m] = eps_inf + val\n    return re_eps\n\ndef kk_from_real(omega, eps_re, eps_inf):\n    \"\"\"\n    Compute Im[eps_r](omega) via Kramers-Kronig from Re[eps_r](omega), subtracted form.\n    Im[eps_r](w) = -(2*w/pi) P ∫_0^∞ [Re eps_r(Omega) - eps_inf]/(Omega^2 - w^2) dOmega\n    Discrete principal value with trapezoidal weights on linear omega grid.\n    \"\"\"\n    M = omega.size\n    domega = omega[1] - omega[0]\n    weights = np.ones(M) * domega\n    weights[0] *= 0.5\n    weights[-1] *= 0.5\n\n    im_eps = np.empty(M, dtype=float)\n    for m in range(M):\n        denom = omega**2 - omega[m]**2\n        with np.errstate(divide='ignore', invalid='ignore'):\n            integrand = (eps_re - eps_inf) / denom\n        integrand[m] = 0.0  # exclude self-term\n        val = -(2.0 * omega[m] / np.pi) * np.sum(weights * integrand)\n        im_eps[m] = val\n    return im_eps\n\ndef kk_compliance(eps_re, eps_im, omega, eps_inf, trim=5, tol=0.25):\n    \"\"\"\n    Compute relative L2 errors between eps and its KK reconstructions on interior band,\n    and return boolean for compliance (both errors = tol).\n    \"\"\"\n    # K-K reconstructions\n    re_from_im = kk_from_imag(omega, eps_im, eps_inf)\n    im_from_re = kk_from_real(omega, eps_re, eps_inf)\n\n    # Interior slicing to reduce edge effects\n    lo = trim\n    hi = len(omega) - trim\n    if hi = lo + 1:\n        lo = 1\n        hi = len(omega) - 1\n\n    # Relative L2 errors\n    eps0 = 1e-12\n    num_re = np.linalg.norm((eps_re - eps_inf)[lo:hi] - (re_from_im - eps_inf)[lo:hi])\n    den_re = np.linalg.norm((eps_re - eps_inf)[lo:hi]) + eps0\n    err_re = num_re / den_re\n\n    num_im = np.linalg.norm(eps_im[lo:hi] - im_from_re[lo:hi])\n    den_im = np.linalg.norm(eps_im[lo:hi]) + eps0\n    err_im = num_im / den_im\n\n    return (max(err_re, err_im) = tol), err_re, err_im\n\ndef invert_and_test_case(E0, eps_inf, terms, dt, N, noise_level=0.0, seed=1234,\n                         M_freq=256, tol=0.25):\n    \"\"\"\n    Full pipeline for one case:\n    - synthesize P(t)\n    - compute chi_e(t)\n    - compute chi_e(omega) and eps_r(omega)\n    - test Kramers-Kronig compliance\n    Returns boolean compliance.\n    \"\"\"\n    # Time grid\n    t = np.arange(N, dtype=float) * dt\n    # Synthesize P(t)\n    rng = np.random.default_rng(seed)\n    P = synthesize_P(t, E0, terms, noise_level=noise_level, rng=rng)\n    # Time-domain susceptibility via derivative\n    chi_t = compute_susceptibility_time(P, E0, dt)\n    # Frequency grid: linear from 2*pi/T to pi/dt\n    T = N * dt\n    w_min = 2.0 * np.pi / T\n    w_max = np.pi / dt\n    omega = np.linspace(w_min, w_max, M_freq)\n    # Fourier transform\n    chi_w = fourier_transform_one_sided(chi_t, t, omega)\n    # Relative permittivity\n    eps_r = eps_inf + chi_w\n    eps_re = np.real(eps_r)\n    eps_im = np.imag(eps_r)\n    # KK test\n    compliant, _, _ = kk_compliance(eps_re, eps_im, omega, eps_inf, trim=5, tol=tol)\n    return compliant\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Case 1: Single relaxation, well-resolved, no noise\n    case1 = dict(\n        E0=1.0e5,\n        eps_inf=2.0,\n        terms=[(3.0, 5.0e-7)],\n        dt=1.0e-8,\n        N=4096,\n        noise_level=0.0\n    )\n    # Case 2: Two relaxations, well-resolved, no noise\n    case2 = dict(\n        E0=1.0e5,\n        eps_inf=1.4,\n        terms=[(2.0, 2.0e-7), (1.0, 4.0e-6)],\n        dt=1.0e-8,\n        N=4096,\n        noise_level=0.0\n    )\n    # Case 3: Single relaxation, coarse/short record, noisy\n    case3 = dict(\n        E0=1.0e5,\n        eps_inf=2.0,\n        terms=[(3.0, 3.0e-6)],\n        dt=5.0e-8,\n        N=256,\n        noise_level=1.0e-1\n    )\n    # Case 4: Single relaxation, very short record relative to tau\n    case4 = dict(\n        E0=1.0e5,\n        eps_inf=2.0,\n        terms=[(3.0, 1.0e-4)],\n        dt=1.0e-8,\n        N=256,\n        noise_level=0.0\n    )\n\n    test_cases = [case1, case2, case3, case4]\n\n    results = []\n    for idx, params in enumerate(test_cases):\n        compliant = invert_and_test_case(\n            E0=params[\"E0\"],\n            eps_inf=params[\"eps_inf\"],\n            terms=params[\"terms\"],\n            dt=params[\"dt\"],\n            N=params[\"N\"],\n            noise_level=params[\"noise_level\"],\n            seed=1234 + idx,  # different seeds for different cases\n            M_freq=256,\n            tol=0.25\n        )\n        results.append(compliant)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(['True' if r else 'False' for r in results])}]\")\n\nsolve()\n```", "id": "2838447"}]}