{"hands_on_practices": [{"introduction": "理解任何物理模型的基石在于能够从基本原理出发，推导出其核心结论。本练习将引导您完成爱因斯坦模型热容的完整推导，从单个量子谐振子的量子力学能级开始。通过处理配分函数的统计力学，您将为最终的热力学表达式开辟一条清晰的路径，从而巩固您对该模型理论基础的掌握。[@problem_id:2508240]", "problem": "一个晶体固体包含 $N$ 个相同的原子，排列在一个三维晶格上。在晶格振动的爱因斯坦图像中，每个原子贡献了独立的振动模式，这些模式可以被建模为量子化的振荡。\n\n(a) 陈述你将用来分析此系统的晶格振动的爱因斯坦模型的物理假设。\n\n(b) 仅从以下基本要素出发：\n- 单个量子谐振子 (QHO) 的能谱，$E_{n}=\\hbar \\omega \\left(n+\\tfrac{1}{2}\\right)$，其中 $n\\in\\{0,1,2,\\dots\\}$，\n- 正则配分函数的定义 $Z=\\sum_{n} \\exp(-\\beta E_{n})$，其中 $\\beta=1/(k_{B}T)$，\n- 关系式 $U=-\\partial \\ln Z/\\partial \\beta$ 和 $C_{V}=\\left(\\partial U/\\partial T\\right)_{V}$，\n\n推导该固体在恒定体积下的热容 $C_{V}(T)$ 的闭合形式表达式，用 $N$、玻尔兹曼常数 $k_{B}$、温度 $T$ 和爱因斯坦温度 $\\Theta_{E}\\equiv \\hbar \\omega_{E}/k_{B}$ 表示，其中 $\\omega_{E}$ 是爱因斯坦振子的特征角频率。将最终结果表示为最简形式的单个解析表达式。不需要进行数值计算。在最终的方框答案中不要包含单位。", "solution": "所提出的问题是入门级固态物理和统计力学中的一个标准的、适定的问题。它具有科学依据，没有矛盾，并包含了进行严格推导所需的所有信息。因此，该问题被认为是**有效的**。我们开始进行解答。\n\n(a) 晶体固体振动性质的爱因斯坦模型的假设如下：\n$1$. 固体由 $N$ 个相同的原子组成，排列在一个规则的晶格中。\n$2$. 每个原子围绕其固定的平衡晶格位置振动。不同原子的振动被假定为彼此完全独立。\n$3$. 每个原子的运动是各向同性的，并且可以分解为三个独立的一维简谐振子，对应于三个空间维度。因此，整个固体被建模为 $3N$ 个独立的一维量子谐振子 (QHO) 的集合。\n$4$. 所有这 $3N$ 个量子谐振子都被假定以相同的、单一的特征角频率 $\\omega_{E}$ 振动。这是该模型的核心也是最极端的简化。\n\n(b) 热容 $C_{V}(T)$ 的推导从所提供的基本原理开始。\n\n首先，我们确定单个一维量子谐振子的正则配分函数 $Z_{1}$。能级由 $E_{n} = \\hbar \\omega_{E} \\left(n + \\frac{1}{2}\\right)$ 给出，其中 $n \\in \\{0, 1, 2, \\dots\\}$。配分函数 $Z_{1}$ 是对所有状态的求和：\n$$Z_{1} = \\sum_{n=0}^{\\infty} \\exp(-\\beta E_{n}) = \\sum_{n=0}^{\\infty} \\exp\\left(-\\beta \\hbar \\omega_{E} \\left(n + \\frac{1}{2}\\right)\\right)$$\n其中 $\\beta = 1/(k_{B}T)$。我们可以将与求和指数 $n$ 无关的项因子分解出来：\n$$Z_{1} = \\exp\\left(-\\frac{\\beta \\hbar \\omega_{E}}{2}\\right) \\sum_{n=0}^{\\infty} \\exp(-n \\beta \\hbar \\omega_{E}) = \\exp\\left(-\\frac{\\beta \\hbar \\omega_{E}}{2}\\right) \\sum_{n=0}^{\\infty} \\left[\\exp(-\\beta \\hbar \\omega_{E})\\right]^{n}$$\n该和是一个形式为 $\\sum_{n=0}^{\\infty} x^{n} = 1/(1-x)$ 的几何级数，其中 $x = \\exp(-\\beta \\hbar \\omega_{E})$。收敛条件 $|x|  1$ 是满足的，因为 $T > 0$，这意味着 $\\beta \\hbar \\omega_{E} > 0$ 且 $\\exp(-\\beta \\hbar \\omega_{E})  1$。因此，单个振子的配分函数为：\n$$Z_{1} = \\frac{\\exp(-\\beta \\hbar \\omega_{E}/2)}{1 - \\exp(-\\beta \\hbar \\omega_{E})}$$\n\n根据模型假设，固体由 $3N$ 个独立且相同（但因其晶格位置而可区分）的振子组成。系统的总配分函数 $Z$ 是各个配分函数的乘积：\n$$Z = (Z_{1})^{3N} = \\left[ \\frac{\\exp(-\\beta \\hbar \\omega_{E}/2)}{1 - \\exp(-\\beta \\hbar \\omega_{E})} \\right]^{3N}$$\n为了计算热力学性质，使用配分函数的自然对数更为方便：\n$$\\ln Z = 3N \\ln Z_{1} = 3N \\left[ \\ln\\left(\\exp\\left(-\\frac{\\beta \\hbar \\omega_{E}}{2}\\right)\\right) - \\ln\\left(1 - \\exp(-\\beta \\hbar \\omega_{E})\\right) \\right]$$\n$$\\ln Z = 3N \\left[ -\\frac{\\beta \\hbar \\omega_{E}}{2} - \\ln\\left(1 - \\exp(-\\beta \\hbar \\omega_{E})\\right) \\right]$$\n\n接下来，我们使用关系式 $U = -\\frac{\\partial \\ln Z}{\\partial \\beta}$ 计算固体的总内能 $U$：\n$$U = -\\frac{\\partial}{\\partial \\beta} \\left( 3N \\left[ -\\frac{\\beta \\hbar \\omega_{E}}{2} - \\ln\\left(1 - \\exp(-\\beta \\hbar \\omega_{E})\\right) \\right] \\right)$$\n$$U = -3N \\left[ -\\frac{\\hbar \\omega_{E}}{2} - \\frac{1}{1 - \\exp(-\\beta \\hbar \\omega_{E})} \\cdot (-\\exp(-\\beta \\hbar \\omega_{E})) \\cdot (-\\hbar \\omega_{E}) \\right]$$\n$$U = -3N \\left[ -\\frac{\\hbar \\omega_{E}}{2} - \\frac{\\hbar \\omega_{E} \\exp(-\\beta \\hbar \\omega_{E})}{1 - \\exp(-\\beta \\hbar \\omega_{E})} \\right]$$\n$$U = 3N \\hbar \\omega_{E} \\left[ \\frac{1}{2} + \\frac{\\exp(-\\beta \\hbar \\omega_{E})}{1 - \\exp(-\\beta \\hbar \\omega_{E})} \\right]$$\n为了简化分数，我们可以将分子和分母同乘以 $\\exp(\\beta \\hbar \\omega_{E})$：\n$$\\frac{\\exp(-\\beta \\hbar \\omega_{E})}{1 - \\exp(-\\beta \\hbar \\omega_{E})} = \\frac{1}{\\exp(\\beta \\hbar \\omega_{E}) - 1}$$\n内能变为：\n$$U = 3N \\hbar \\omega_{E} \\left[ \\frac{1}{2} + \\frac{1}{\\exp(\\beta \\hbar \\omega_{E}) - 1} \\right] = \\frac{3N \\hbar \\omega_{E}}{2} + \\frac{3N \\hbar \\omega_{E}}{\\exp(\\beta \\hbar \\omega_{E}) - 1}$$\n第一项是晶体的恒定零点能，它不依赖于温度。\n\n最后，我们求恒定体积下的热容，$C_{V} = \\left(\\frac{\\partial U}{\\partial T}\\right)_{V}$。我们使用链式法则：$C_{V} = \\frac{\\partial U}{\\partial \\beta} \\frac{\\partial \\beta}{\\partial T}$。\n给定 $\\beta = \\frac{1}{k_{B}T}$，它对温度的导数是 $\\frac{\\partial \\beta}{\\partial T} = -\\frac{1}{k_{B}T^{2}}$。\n现在我们计算 $\\frac{\\partial U}{\\partial \\beta}$。恒定的零点能项在求导后消失。\n$$\\frac{\\partial U}{\\partial \\beta} = \\frac{\\partial}{\\partial \\beta} \\left( \\frac{3N \\hbar \\omega_{E}}{\\exp(\\beta \\hbar \\omega_{E}) - 1} \\right)$$\n$$\\frac{\\partial U}{\\partial \\beta} = 3N \\hbar \\omega_{E} \\cdot (-1) \\cdot \\left(\\exp(\\beta \\hbar \\omega_{E}) - 1\\right)^{-2} \\cdot \\left(\\exp(\\beta \\hbar \\omega_{E}) \\cdot \\hbar \\omega_{E}\\right)$$\n$$\\frac{\\partial U}{\\partial \\beta} = -3N (\\hbar \\omega_{E})^{2} \\frac{\\exp(\\beta \\hbar \\omega_{E})}{\\left(\\exp(\\beta \\hbar \\omega_{E}) - 1\\right)^{2}}$$\n现在，将各部分组合起来求 $C_V$：\n$$C_{V} = \\left( -3N (\\hbar \\omega_{E})^{2} \\frac{\\exp(\\beta \\hbar \\omega_{E})}{(\\exp(\\beta \\hbar \\omega_{E}) - 1)^{2}} \\right) \\left( -\\frac{1}{k_{B}T^{2}} \\right)$$\n$$C_{V} = \\frac{3N (\\hbar \\omega_{E})^{2}}{k_{B}T^{2}} \\frac{\\exp(\\beta \\hbar \\omega_{E})}{(\\exp(\\beta \\hbar \\omega_{E}) - 1)^{2}}$$\n为了用给定的爱因斯坦温度 $\\Theta_{E} = \\frac{\\hbar \\omega_{E}}{k_{B}}$ 来表示，我们代入 $\\hbar \\omega_{E} = k_{B} \\Theta_{E}$。指数变为 $\\beta \\hbar \\omega_{E} = \\frac{1}{k_{B}T} (k_{B} \\Theta_{E}) = \\frac{\\Theta_{E}}{T}$。前面的因子变为：\n$$\\frac{3N (\\hbar \\omega_{E})^{2}}{k_{B}T^{2}} = \\frac{3N (k_{B} \\Theta_{E})^{2}}{k_{B}T^{2}} = 3N k_{B} \\left(\\frac{\\Theta_{E}}{T}\\right)^{2}$$\n将这些代入 $C_{V}$ 的表达式，得到最终结果：\n$$C_{V}(T) = 3N k_{B} \\left(\\frac{\\Theta_{E}}{T}\\right)^{2} \\frac{\\exp(\\Theta_{E}/T)}{\\left(\\exp(\\Theta_{E}/T) - 1\\right)^{2}}$$\n这就是爱因斯坦模型中固体的热容。", "answer": "$$\n\\boxed{3 N k_{B} \\left(\\frac{\\Theta_{E}}{T}\\right)^{2} \\frac{\\exp(\\Theta_{E}/T)}{(\\exp(\\Theta_{E}/T) - 1)^{2}}}\n$$", "id": "2508240"}, {"introduction": "一个强大的物理模型不仅能解释已知现象，还能做出可检验的预测。本练习要求您将爱因斯坦模型应用于一个涉及同位素替换的假想实验，展示其如何预测一种可观测的物理效应。通过将原子质量这一微观参数与宏观热学性质联系起来，您将更深入地理解爱因斯坦频率 $\\omega_E$ 的物理意义以及该模型的预测能力。[@problem_id:2817503]", "problem": "在爱因斯坦模型中，一个单原子立方晶体可以很好地描述为由 $3N$ 个具有单一特征角频率 $\\omega_{E}$ 的独立量子谐振子组成的集合。考虑两个经过同位素富集但在其他方面完全相同的样品，其中样品A中每个晶格位置的原子质量为 $m$，样品B中为 $m+\\Delta m$，并假定原子间力常数与同位素质量无关。将一个样品的 $T^{\\ast}$ 定义为这样一个唯一的温度，在该温度下，晶格的定容热容 ($C_V$) 等于杜隆-珀蒂极限的一半，即 $C_{V}(T^{\\ast}) = \\tfrac{1}{2}\\times 3N k_{B}$，其中 $k_{B}$ 是玻尔兹曼常数。在爱因斯坦模型框架内，从单个量子谐振子的正则配分函数出发，推导同位素替换后此特征温度的分数变化\n$$\\frac{T^{\\ast}_{B}-T^{\\ast}_{A}}{T^{\\ast}_{A}}$$\n的解析表达式，该表达式仅用 $\\Delta m/m$ 表示。不要假设任何经典或渐近温度极限。你的最终答案必须是单个封闭形式的表达式（不需要单位）。", "solution": "所述问题具有科学依据、是良定的且客观的。它基于已建立的晶格热容的爱因斯坦模型，这是固态物理学中的一个标准课题。给出的条件对于得到唯一解是充分且一致的。因此，我们开始进行推导。\n\n该问题要求从单个量子谐振子 (QHO) 的正则配分函数开始推导。角频率为 $\\omega_{E}$ 的量子谐振子的能级由下式给出\n$$E_n = \\hbar \\omega_E \\left(n + \\frac{1}{2}\\right), \\quad n = 0, 1, 2, \\ldots$$\n在温度 $T$ 下，单个谐振子的配分函数 $Z_1$ 是对所有态的玻尔兹曼因子 $\\exp(-\\beta E_n)$ 求和，其中 $\\beta = (k_B T)^{-1}$。\n$$Z_1 = \\sum_{n=0}^{\\infty} \\exp(-\\beta E_n) = \\sum_{n=0}^{\\infty} \\exp\\left[-\\beta \\hbar \\omega_E \\left(n + \\frac{1}{2}\\right)\\right]$$\n$$Z_1 = \\exp\\left(-\\frac{\\beta \\hbar \\omega_E}{2}\\right) \\sum_{n=0}^{\\infty} \\left[\\exp(-\\beta \\hbar \\omega_E)\\right]^n$$\n该求和是一个公比小于1的几何级数，收敛于 $(1 - \\exp(-\\beta \\hbar \\omega_E))^{-1}$。因此，\n$$Z_1 = \\frac{\\exp(-\\beta \\hbar \\omega_E / 2)}{1 - \\exp(-\\beta \\hbar \\omega_E)}$$\n晶体由 $N$ 个原子组成，每个原子可以在3个维度上自由振荡，模型化为 $3N$ 个独立的、可分辨的量子谐振子。系统的总配分函数 $Z$ 为 $Z = (Z_1)^{3N}$。晶体的平均内能 $U$ 由总配分函数求得：\n$$U = -\\frac{\\partial \\ln Z}{\\partial \\beta} = -3N \\frac{\\partial \\ln Z_1}{\\partial \\beta}$$\n使用 $Z_1$ 的表达式，我们得到 $\\ln Z_1$：\n$$\\ln Z_1 = -\\frac{\\beta \\hbar \\omega_E}{2} - \\ln\\left(1 - \\exp(-\\beta \\hbar \\omega_E)\\right)$$\n对 $\\beta$ 求导得到：\n$$\\frac{\\partial \\ln Z_1}{\\partial \\beta} = -\\frac{\\hbar \\omega_E}{2} - \\frac{1}{1 - \\exp(-\\beta \\hbar \\omega_E)} \\left[-\\exp(-\\beta \\hbar \\omega_E) \\cdot (-\\hbar \\omega_E)\\right] = -\\frac{\\hbar \\omega_E}{2} - \\frac{\\hbar \\omega_E}{\\exp(\\beta \\hbar \\omega_E) - 1}$$\n将此代回 $U$ 的表达式中：\n$$U = -3N \\left(-\\frac{\\hbar \\omega_E}{2} - \\frac{\\hbar \\omega_E}{\\exp(\\beta \\hbar \\omega_E) - 1}\\right) = 3N \\hbar \\omega_E \\left(\\frac{1}{2} + \\frac{1}{\\exp(\\beta \\hbar \\omega_E) - 1}\\right)$$\n定容热容为 $C_V = \\left(\\frac{\\partial U}{\\partial T}\\right)_V$。通过 $\\beta$ 计算更为方便，使用 $C_V = \\frac{\\partial U}{\\partial \\beta} \\frac{d\\beta}{dT} = \\frac{\\partial U}{\\partial \\beta} \\left(-\\frac{1}{k_B T^2}\\right) = -k_B \\beta^2 \\frac{\\partial U}{\\partial \\beta}$。\n将 $U$ 对 $\\beta$ 求导：\n$$\\frac{\\partial U}{\\partial \\beta} = 3N \\hbar \\omega_E \\left[(-1)\\left(\\exp(\\beta \\hbar \\omega_E) - 1\\right)^{-2} \\cdot \\exp(\\beta \\hbar \\omega_E) \\cdot (\\hbar \\omega_E)\\right] = -3N(\\hbar \\omega_E)^2 \\frac{\\exp(\\beta \\hbar \\omega_E)}{(\\exp(\\beta \\hbar \\omega_E) - 1)^2}$$\n因此，热容为：\n$$C_V = -k_B \\beta^2 \\left[-3N(\\hbar \\omega_E)^2 \\frac{\\exp(\\beta \\hbar \\omega_E)}{(\\exp(\\beta \\hbar \\omega_E) - 1)^2}\\right] = 3N k_B (\\beta \\hbar \\omega_E)^2 \\frac{\\exp(\\beta \\hbar \\omega_E)}{(\\exp(\\beta \\hbar \\omega_E) - 1)^2}$$\n问题定义了一个特征温度 $T^{\\ast}$，在该温度下 $C_V(T^{\\ast})$ 等于杜隆-珀蒂极限的一半，即 $C_V(T^{\\ast}) = \\frac{1}{2} (3N k_B)$。我们建立方程：\n$$\\frac{1}{2} (3N k_B) = 3N k_B \\left(\\frac{\\hbar \\omega_E}{k_B T^{\\ast}}\\right)^2 \\frac{\\exp\\left(\\frac{\\hbar \\omega_E}{k_B T^{\\ast}}\\right)}{\\left(\\exp\\left(\\frac{\\hbar \\omega_E}{k_B T^{\\ast}}\\right) - 1\\right)^2}$$\n让我们定义无量纲变量 $x^{\\ast} = \\frac{\\hbar \\omega_E}{k_B T^{\\ast}}$。该方程简化为：\n$$\\frac{1}{2} = (x^{\\ast})^2 \\frac{\\exp(x^{\\ast})}{(\\exp(x^{\\ast}) - 1)^2}$$\n这是一个关于 $x^{\\ast}$ 的超越方程。将方程右侧作为 $x^{\\ast}$ 的函数绘制图像，可以看出对于 $x^{\\ast} > 0$，它是一个单调递减函数，这确保了 $x^{\\ast}$ 存在唯一的正解。我们把这个唯一的数值常数记为 $x_0$。关键的洞见在于，这个值 $x_0$ 在爱因斯坦模型中对任何物质都是普适的；它不依赖于 $\\omega_E$ 或任何其他材料特定参数。\n因此，对于任何样品，我们都有关系式：\n$$x_0 = \\frac{\\hbar \\omega_E}{k_B T^{\\ast}}$$\n这意味着 $T^{\\ast}$ 与爱因斯坦频率 $\\omega_E$ 成正比：\n$$T^{\\ast} = \\frac{\\hbar}{k_B x_0} \\omega_E \\implies T^{\\ast} \\propto \\omega_E$$\n接下来，我们将 $\\omega_E$ 与原子质量 $m$ 联系起来。振子的角频率由 $\\omega_E = \\sqrt{k_{ifc}/m}$ 给出，其中 $k_{ifc}$ 是原子间力常数。问题中说明 $k_{ifc}$ 与同位素质量无关。因此，$\\omega_E$ 与原子质量的平方根成反比：\n$$\\omega_E \\propto m^{-1/2}$$\n结合这两个比例关系，我们发现 $T^{\\ast}$ 对原子质量的依赖关系为：\n$$T^{\\ast} \\propto m^{-1/2}$$\n现在，我们可以比较样品A和B。对于样品A，质量为 $m_A = m$，特征温度为 $T^{\\ast}_A$。对于样品B，质量为 $m_B = m + \\Delta m$，特征温度为 $T^{\\ast}_B$。利用比例关系，我们得到比率：\n$$\\frac{T^{\\ast}_B}{T^{\\ast}_A} = \\left(\\frac{m_B}{m_A}\\right)^{-1/2} = \\sqrt{\\frac{m_A}{m_B}}$$\n代入质量的表达式：\n$$\\frac{T^{\\ast}_B}{T^{\\ast}_A} = \\sqrt{\\frac{m}{m + \\Delta m}} = \\sqrt{\\frac{1}{1 + \\frac{\\Delta m}{m}}} = \\left(1 + \\frac{\\Delta m}{m}\\right)^{-1/2}$$\n问题要求的是特征温度的分数变化，即 $\\frac{T^{\\ast}_B - T^{\\ast}_A}{T^{\\ast}_A}$。\n$$\\frac{T^{\\ast}_B - T^{\\ast}_A}{T^{\\ast}_A} = \\frac{T^{\\ast}_B}{T^{\\ast}_A} - 1 = \\left(1 + \\frac{\\Delta m}{m}\\right)^{-1/2} - 1$$\n这是最终的表达式，完全用质量分数变化 $\\Delta m/m$ 来表示，符合题目要求。", "answer": "$$\n\\boxed{\\left(1 + \\frac{\\Delta m}{m}\\right)^{-\\frac{1}{2}} - 1}\n$$", "id": "2817503"}, {"introduction": "在现代科学实践中，理论公式必须能被转化为稳健的计算工具。爱因斯坦热容的标准表达式虽然在代数上是正确的，但在某些温度区间内数值计算上却不稳定。本练习将引导您实现一个用于计算热容的数值稳定算法，从而架起理论与实践之间的桥梁，这是任何计算材料物理学家都应具备的关键技能。[@problem_id:2817515]", "problem": "爱因斯坦固体被建模为一个由独立、相同的量子谐振子组成的系统，每个谐振子的角频率为 $\\omega$，并对晶体的定容热容 ($C_V$) 有贡献。令 $\\hbar$ 表示约化普朗克常数，$k_{\\mathrm{B}}$ 表示玻尔兹曼常数，$T$ 表示绝对温度。定义爱因斯坦温度 $\\Theta_{\\mathrm{E}}$ 为 $\\Theta_{\\mathrm{E}} = \\hbar \\omega / k_{\\mathrm{B}}$，无量纲变量 $x$ 为 $x = \\hbar \\omega / (k_{\\mathrm{B}} T) = \\Theta_{\\mathrm{E}} / T$。对于单原子晶体，摩尔定容热容是每个原子的三个正交振子自由度的贡献之和。\n\n从量子谐振子的正则系综以及热容作为定容内能的温度导数的定义出发，推导单原子爱因斯坦固体的摩尔定容热容 $C_V$ 作为 $x$ 的函数的数值稳定表达式。您的推导必须基于以下基本事实：\n- 单个量子谐振子在温度 $T$ 下的正则配分函数 $Z$。\n- 从 $Z$ 推导出的作为热平均值的内能 $U$。\n- 定义 $C_V = \\left( \\partial U / \\partial T \\right)_V$。\n请勿使用问题陈述中任何预先给出的 $C_V$ 最终公式；相反，应从这些基本原理出发进行构建。\n\n您必须实现一个程序，能对 $x$ 的所有区间稳健地计算摩尔 $C_V$：\n- 对于 $x \\ll 1$，避免灾难性抵消；结果必须能恢复到高温极限，并通过使用从第一性原理推导的受控级数展开，使精度达到浮點舍入误差范围内。\n- 对于 $x \\gg 1$，避免指数函数中的溢出；您的算法必须保持稳定，并返回快速减小趋于零的、具有物理意义的值。\n- 对于中等大小的 $x$，使用代数重排以避免有效数字损失，包括以数值稳定的方式计算 $e^x - 1$ 和 $\\ln(1 + y)$ 的函数。\n\n您的程序必须为以下测试用例计算以 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 为单位的摩尔 $C_V$，每个用例由爱因斯坦温度 $\\Theta_{\\mathrm{E}}$ 和温度 $T$（均以 $\\mathrm{K}$ 为单位）给出：\n- 测试 $1$：$\\Theta_{\\mathrm{E}} = 300\\,\\mathrm{K}$，$T = 300\\,\\mathrm{K}$。\n- 测试 $2$：$\\Theta_{\\mathrm{E}} = 50\\,\\mathrm{K}$，$T = 1500\\,\\mathrm{K}$。\n- 测试 $3$：$\\Theta_{\\mathrm{E}} = 1200\\,\\mathrm{K}$，$T = 1\\,\\mathrm{K}$。\n- 测试 $4$：$\\Theta_{\\mathrm{E}} = 200\\,\\mathrm{K}$，$T = 600\\,\\mathrm{K}$。\n\n实现要求：\n- 将固体视为单原子，以便在高温下每摩尔原子有 $3$ 个振子自由度。\n- 使用理想气体常数 $R = N_{\\mathrm{A}} k_{\\mathrm{B}}$，其值为 $R = 8.31446261815324\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 您的算法必须明确避免在可能溢出时简单地使用 $e^{x}$，并且必须在 $x$ 很小时避免相减抵消。在适当的情况下，使用数学上等价的变换和稳定的特殊函数（例如，指数减一函数）。\n- 所有输出均以 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 为单位表示，每个结果四舍五入到6位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按上述测试顺序排列的四个结果，形式为方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4]$），其中每个 $r_i$ 是一个以 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 为单位、四舍五入到6位小数的浮点数。", "solution": "我们将晶体建模为一组独立、相同的量子谐振子。单个角频率为 $\\omega$ 的谐振子在温度 $T$ 下的正则配分函数为\n$$\nZ_1 = \\sum_{n=0}^{\\infty} \\exp\\!\\left(-\\beta \\hbar \\omega \\left(n + \\tfrac{1}{2}\\right)\\right)\n= \\frac{\\exp\\!\\left(-\\tfrac{1}{2}\\beta \\hbar \\omega\\right)}{1 - \\exp\\!\\left(-\\beta \\hbar \\omega\\right)},\n$$\n其中 $\\beta = 1/(k_{\\mathrm{B}} T)$。定义无量纲变量 $x = \\beta \\hbar \\omega = \\hbar \\omega/(k_{\\mathrm{B}} T) = \\Theta_{\\mathrm{E}}/T$。\n\n单个谐振子的亥姆霍兹自由能为 $F_1 = -k_{\\mathrm{B}} T \\ln Z_1$。单个谐振子的内能通过以下方式获得\n$$\nU_1 = -\\frac{\\partial}{\\partial \\beta} \\ln Z_1.\n$$\n使用 $\\ln Z_1 = -\\tfrac{1}{2} x - \\ln\\!\\left(1 - e^{-x}\\right)$ 和 $\\partial x/\\partial \\beta = \\hbar \\omega$，我们得到\n$$\nU_1 = \\hbar \\omega \\left(\\tfrac{1}{2} + \\frac{1}{e^{x} - 1}\\right).\n$$\n单个谐振子的定容热容为\n$$\nC_{V,1} = \\left(\\frac{\\partial U_1}{\\partial T}\\right)_V\n= \\left(\\frac{\\partial U_1}{\\partial x}\\right)_V \\left(\\frac{\\partial x}{\\partial T}\\right)_V,\n$$\n其中 $\\partial x/\\partial T = -\\Theta_{\\mathrm{E}}/T^2 = -x/T$。将 $U_1$ 对 $x$ 求导，得到\n$$\n\\frac{\\partial U_1}{\\partial x} = - \\hbar \\omega \\frac{e^{x}}{(e^{x} - 1)^{2}}.\n$$\n因此\n$$\nC_{V,1} = \\hbar \\omega \\frac{e^{x}}{(e^{x} - 1)^{2}} \\frac{x}{T}\n= k_{\\mathrm{B}} x^{2} \\frac{e^{x}}{(e^{x} - 1)^{2}}.\n$$\n对于单原子固体，每个原子有 $3$ 个正交振子自由度，因此每摩尔原子有\n$$\nC_V = 3 N_{\\mathrm{A}} k_{\\mathrm{B}}\\, x^{2} \\frac{e^{x}}{(e^{x} - 1)^{2}} = 3 R\\, f(x),\n\\quad \\text{with} \\quad f(x) = x^{2} \\frac{e^{x}}{(e^{x} - 1)^{2}}.\n$$\n\n直接计算 $f(x)$ 可能在数值上不稳定：\n- 对于 $x \\ll 1$，$e^{x} - 1 \\approx x$ 会导致分母接近于零以及在 $e^{x} - 1$ 中发生相减抵消。通过 Bernoulli 数或等价地展开 $f(x)$，可以获得一个稳定的小 $x$ 展开式：\n$$\nf(x) = 1 - \\frac{x^{2}}{12} + \\frac{x^{4}}{240} - \\frac{x^{6}}{6048} + \\frac{x^{8}}{172800} + \\mathcal{O}(x^{10}).\n$$\n这恢复了当 $x \\to 0$ 时的 Dulong–Petit 定律极限 $C_V \\to 3 R$。\n- 对于中等大小的 $x$，使用 Bose–Einstein 占据数重写 $f(x)$\n$$\nn(x) = \\frac{1}{e^{x} - 1}.\n$$\n则 $f(x) = x^{2} n(x)\\bigl(1 + n(x)\\bigr)$，这避免了对小分母进行平方，并允许稳定地使用指数减一函数。我们可以使用一个用于计算 $e^{x} - 1$ 的数值稳定函数来计算 $n(x)$，即一个指数减一原函数。这可以防止在 $x$ 很小时的有效数字损失，并防止在 $x$ 为中等到大小时因直接计算 $e^{x}$ 而产生不必要的溢出。\n- 对于 $x \\gg 1$，物理上正确的渐近形式为 $f(x) \\sim x^{2} e^{-x}$，这是一个指数级小的量。对于非常大的 $x$，使用 $n(x) \\approx e^{-x}$ 是数值稳定的。在浮点运算中，对于足够大的 $x$，$e^{-x}$ 会下溢为零，此时正确的物理极限为 $C_V \\approx 0$。\n\n算法设计：\n- 给定以 $\\mathrm{K}$ 为单位的 $\\Theta_{\\mathrm{E}}$ 和 $T$，计算 $x = \\Theta_{\\mathrm{E}}/T$。\n- 如果 $x  x_{\\mathrm{small}}$，其中 $x_{\\mathrm{small}}$ 取为 $10^{-3}$，则使用截断级数计算 $f(x)$\n$$\nf(x) \\approx 1 - \\frac{x^{2}}{12} + \\frac{x^{4}}{240} - \\frac{x^{6}}{6048} + \\frac{x^{8}}{172800}.\n$$\n对于 $x \\lesssim 10^{-3}$，这在双精度下可提供机器精度级别的准确性。\n- 否则，使用一个稳定的指数减一原函数计算 $t = \\mathrm{expm1}(x) = e^{x} - 1$。如果 $t$ 是有限的，则令 $n = 1/t$ 且 $f(x) = x^{2} n (1 + n)$。如果 $t$ 不是有限的（发生溢出），则使用渐近形式 $f(x) \\approx x^{2} e^{-x}$，计算为 $\\exp(-x)$，对于非常大的 $x$，该值将下溢为零，这在物理上是正确的。\n- 返回以 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 为单位的 $C_V = 3 R f(x)$。\n\n此方法在所有区间都是稳定的：\n- 对于 $x \\ll 1$，级数展开消除了抵消，并保证了正确的高温极限 $C_V \\to 3 R$。\n- 对于 $x \\gg 1$，永远不会形成大的指数项；算法会使 $C_V$ 衰减到零而不会发生溢出。\n- 对于中等大小的 $x$，使用 $n(x)$ 和指数减一原函数避免了有效数字损失和溢出。\n\n程序实现了这一逻辑，并将其应用于指定的测试：\n- 测试 $1$：$\\Theta_{\\mathrm{E}} = 300\\,\\mathrm{K}$，$T = 300\\,\\mathrm{K}$。\n- 测试 $2$：$\\Theta_{\\mathrm{E}} = 50\\,\\mathrm{K}$，$T = 1500\\,\\mathrm{K}$。\n- 测试 $3$：$\\Theta_{\\mathrm{E}} = 1200\\,\\mathrm{K}$，$T = 1\\,\\mathrm{K}$。\n- 测试 $4$：$\\Theta_{\\mathrm{E}} = 200\\,\\mathrm{K}$，$T = 600\\,\\mathrm{K}$。\n\n每个结果都以 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 为单位，作为四舍五入到6位小数的浮点数打印，并汇总成一个用方括号括起来的逗号分隔列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef einstein_molar_cv(theta_E_K: float, T_K: float) - float:\n    \"\"\"\n    Compute the molar constant-volume heat capacity C_V (J/mol/K)\n    for a monatomic Einstein solid with Einstein temperature theta_E_K (K)\n    at temperature T_K (K), using a numerically stable formulation.\n    \"\"\"\n    R = 8.31446261815324  # J/mol/K\n    x = theta_E_K / T_K   # dimensionless\n\n    # Small-x threshold for series expansion\n    x_small = 1e-3\n\n    if x  x_small:\n        # Use stable series expansion: f(x) = 1 - x^2/12 + x^4/240 - x^6/6048 + x^8/172800\n        x2 = x * x\n        x4 = x2 * x2\n        x6 = x4 * x2\n        x8 = x4 * x4\n        f = (1.0\n             - x2 / 12.0\n             + x4 / 240.0\n             - x6 / 6048.0\n             + x8 / 172800.0)\n    else:\n        # Use Bose-Einstein occupation number with expm1 for stability\n        t = np.expm1(x)  # e^x - 1; may overflow to inf for huge x\n        if np.isfinite(t):\n            n = 1.0 / t\n            f = x * x * n * (1.0 + n)\n        else:\n            # For extremely large x, use asymptotic form x^2 e^{-x} ~ 0\n            f = x * x * np.exp(-x)\n\n    Cv = 3.0 * R * f\n    return Cv\n\ndef solve():\n    # Define the test cases from the problem statement: (Theta_E [K], T [K])\n    test_cases = [\n        (300.0, 300.0),   # Test 1\n        (50.0, 1500.0),   # Test 2\n        (1200.0, 1.0),    # Test 3\n        (200.0, 600.0),   # Test 4\n    ]\n\n    results = []\n    for theta_E, T in test_cases:\n        Cv = einstein_molar_cv(theta_E, T)\n        results.append(f\"{Cv:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2817515"}]}