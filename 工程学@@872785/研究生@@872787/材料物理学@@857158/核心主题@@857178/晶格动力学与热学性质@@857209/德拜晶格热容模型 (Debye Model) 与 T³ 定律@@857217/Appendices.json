{"hands_on_practices": [{"introduction": "德拜模型的核心思想是用一个简单的球体来近似代替真实晶格中形状复杂的第一布里渊区。这一实践任务将带你从最基本的量子化条件出发，通过计算声子态密度来确定这个“德拜球”的半径 $k_D$。掌握这个推导过程是理解德拜模型如何从第一性原理上限定声子模式总数的关键一步。[@problem_id:2813025]", "problem": "考虑一个在德拜近似下建模的单原子晶体。该晶体占据体积 $V$，包含 $N$ 个原子，因此原子数密度为 $n = N/V$。假设在长波长下为各向同性弹性连续介质，具有三种声学极化。施加 Born–von Kármán 周期性边界条件，并将真实的布里渊区近似为波矢空间中半径为 $k_{D}$ 的球，该半径的选择应使得声学简正模式的总数等于 $3N$。\n\n仅从这些原理出发（波矢空间中的周期性边界量化、各向同性以及声学模式总数等于 $3N$ 的要求），推导德拜波矢 $k_{D}$ 关于原子数密度 $n$ 的闭合形式解析表达式。请以 $k_{D}$ 关于 $n$ 的单个符号表达式的形式给出您的最终答案。不要使用任何预先引用的 k 空间态密度表达式；相反，应根据边界条件和计数论证来证明它们。\n\n您的最终答案必须是单个解析表达式。不需要进行数值计算。", "solution": "本问题要求推导单原子晶体的德拜波矢 $k_D$ 作为原子数密度 $n$ 的函数表达式。推导过程必须严格遵循指定的几个基本原理。\n\n第一个原理是对晶格应用 Born–von Kármán 周期性边界条件。考虑一个形状为长方体的晶体，其边长分别为 $L_x$、$L_y$ 和 $L_z$，体积为 $V = L_x L_y L_z$。振动模式的波函数是形式为 $\\exp(i\\mathbf{k} \\cdot \\mathbf{r})$ 的平面波，必须满足晶格的周期性。这对波矢 $\\mathbf{k} = (k_x, k_y, k_z)$ 的分量施加了以下条件：\n$$ \\exp(i k_x L_x) = 1 $$\n$$ \\exp(i k_y L_y) = 1 $$\n$$ \\exp(i k_z L_z) = 1 $$\n如果波矢分量按如下方式量子化，则这些条件得到满足：\n$$ k_x = \\frac{2\\pi}{L_x} n_x $$\n$$ k_y = \\frac{2\\pi}{L_y} n_y $$\n$$ k_z = \\frac{2\\pi}{L_z} n_z $$\n其中 $n_x$、$n_y$ 和 $n_z$ 是整数。这些允许的波矢在三维波矢空间（或称 k 空间）中形成一个离散的网格。\n\n该网格上相邻点之间的间距为 $\\Delta k_x = 2\\pi/L_x$、$\\Delta k_y = 2\\pi/L_y$ 和 $\\Delta k_z = 2\\pi/L_z$。因此，在 k 空间中，单个允许态（单个 $\\mathbf{k}$ 矢量）所占据的体积为：\n$$ V_{\\mathbf{k}} = \\Delta k_x \\Delta k_y \\Delta k_z = \\left(\\frac{2\\pi}{L_x}\\right) \\left(\\frac{2\\pi}{L_y}\\right) \\left(\\frac{2\\pi}{L_z}\\right) = \\frac{(2\\pi)^3}{L_x L_y L_z} = \\frac{(2\\pi)^3}{V} $$\n这是 k 空间中每个模式的体积。\n\n为了求出 k 空间某一区域内的模式数量，对于足够大的体积 $V$，我们可以将这些离散点的分布视为一个均匀的连续体。k 空间中的态密度，即 k 空间单位体积内允许的 $\\mathbf{k}$ 矢量数量，是每个态体积的倒数：\n$$ \\rho(\\mathbf{k}) = \\frac{1}{V_{\\mathbf{k}}} = \\frac{V}{(2\\pi)^3} $$\n\n德拜模型将真实的、具有复杂多面体形状的第一布里渊区近似为一个半径为 $k_D$ 的球，这个球被称为德拜球。半径 $k_D$ 的选择标准是，该球内的简正模式总数等于晶体的总振动自由度。对于包含 $N$ 个原子的单原子晶体，有 $3N$ 个自由度。\n\n德拜球在 k 空间中的体积是：\n$$ V_{\\text{sphere}} = \\frac{4}{3}\\pi k_D^3 $$\n该球内允许的 $\\mathbf{k}$ 矢量总数（我们称之为 $N_{\\mathbf{k}}$）是 k 空间态密度与该球体积的乘积：\n$$ N_{\\mathbf{k}} = \\rho(\\mathbf{k}) \\times V_{\\text{sphere}} = \\left(\\frac{V}{(2\\pi)^3}\\right) \\left(\\frac{4}{3}\\pi k_D^3\\right) = \\frac{V}{8\\pi^3} \\frac{4\\pi}{3} k_D^3 = \\frac{V k_D^3}{6\\pi^2} $$\n这个表达式计算了不同波矢的数量。对于固体中每个允许的波矢 $\\mathbf{k}$，存在三种声学极化模式（一种纵向和两种横向）。因此，声学简正模式的总数是允许的 $\\mathbf{k}$ 矢量数量的三倍。\n$$ N_{\\text{modes}} = 3 \\times N_{\\mathbf{k}} = 3 \\left(\\frac{V k_D^3}{6\\pi^2}\\right) = \\frac{V k_D^3}{2\\pi^2} $$\n德拜模型的基本假设是将这个模式总数与晶体的总自由度数相等，对于 $N$ 个原子，总自由度为 $3N$。\n$$ 3N = N_{\\text{modes}} = \\frac{V k_D^3}{2\\pi^2} $$\n我们现在求解这个方程以得到德拜波矢 $k_D$。\n$$ 3N = \\frac{V k_D^3}{2\\pi^2} $$\n$$ k_D^3 = \\frac{3N \\cdot 2\\pi^2}{V} = 6\\pi^2 \\frac{N}{V} $$\n问题中定义了原子数密度为 $n = N/V$。将此定义代入 $k_D^3$ 的表达式中：\n$$ k_D^3 = 6\\pi^2 n $$\n对两边取立方根，得到德拜波矢的最终表达式：\n$$ k_D = (6\\pi^2 n)^{\\frac{1}{3}} $$\n该表达式将德拜模型的截止波矢与晶体中的原子数密度直接联系起来，它严格地从倒易空间中模式的量子化以及对模式总数的约束推导得出。", "answer": "$$\\boxed{\\left(6\\pi^2 n\\right)^{\\frac{1}{3}}}$$", "id": "2813025"}, {"introduction": "在建立了德拜模型的理论框架后，下一步便是运用它来预测可观测量，其中最重要的就是低温下的晶格热容。本练习要求你推导德拜 $T^3$ 定律，并着重于揭示其系数 $\\beta$ 如何与声速这类材料的微观基本属性相关联。完成这个推导有助于深刻理解宏观热力学性质与微观晶格动力学之间的定量联系。[@problem_id:2812983]", "problem": "一个体积为 $V$ 的三维宏观各向同性晶体包含 $N$ 个原子（数密度 $n \\equiv N/V$），并支持一个纵向声学支和两个简并的横向声学支，其线性色散关系为 $\\omega_{s}(\\mathbf{k}) = v_{s}\\,|\\mathbf{k}|$，其中 $s \\in \\{L, T_{1}, T_{2}\\}$。在德拜模型中，用波矢空间中半径为 $k_{D}$ 的球体代替实际的布里渊区，并通过要求简正模式的总数等于 $3N$ 来确定 $k_{D}$。定义德拜温度 $\\Theta_{D}$ 为 $\\Theta_{D} \\equiv \\hbar \\omega_{D}/k_{B}$，其中 $\\omega_{D} \\equiv v_{D} k_{D}$，$v_{D}$ 是一个德拜平均声速，其选择是为了保持低频声子态密度不变。\n\n从声子的玻色-爱因斯坦占据数和波矢空间中的模式计数出发，并假设 $T \\ll \\Theta_{D}$ 以至于只有低频的声学激发有贡献，推导低温晶格热容 $C(T)$ 直至 $T^{3}$ 阶，并确定由 $C(T) = \\beta\\, T^{3} + o(T^{3})$ 定义的系数 $\\beta$。然后利用德拜截止条件和适当的德拜平均声速 $v_{D}$，用 $V$、$v_{L}$ 和 $v_{T}$ 消去 $\\Theta_{D}$，并说明数密度 $n$ 和声速的依赖关系是如何通过 $\\Theta_{D}$ 体现的。\n\n将你的最终结果表示为关于 $V$、$v_{L}$、$v_{T}$、$k_{B}$ 和 $\\hbar$ 的单个闭合形式解析表达式。最终答案中不要提供中间步骤。不需要进行数值计算。", "solution": "声子系统的内能 $U$ 是所有可能声子模式能量的总和，并由每个模式平均占据数的玻色-爱因斯坦分布函数加权。在连续极限下，对波矢 $\\mathbf{k}$ 和极化 $s$ 的求和变成一个积分。\n单个声子模式 $(\\mathbf{k}, s)$ 的能量是 $\\hbar \\omega_s(\\mathbf{k})$。因此，总内能为：\n$$U(T) = \\sum_{s} \\int \\frac{V d^3k}{(2\\pi)^3} \\frac{\\hbar \\omega_s(\\mathbf{k})}{\\exp(\\hbar \\omega_s(\\mathbf{k}) / (k_B T)) - 1}$$\n求和遍及一个纵向 ($L$) 和两个简并的横向 ($T$) 极化支。积分遍及所有允许的波矢。在频率空间中使用态密度 $g(\\omega)$ 更为方便。\n对于单个极化支 $s$，在k空间中半径介于 $k$ 和 $k+dk$ 之间的球壳内的模式数为 $\\frac{V}{(2\\pi)^3} 4\\pi k^2 dk$。\n使用线性色散关系 $\\omega = v_s k$，我们有 $k = \\omega/v_s$ 和 $dk = d\\omega/v_s$。极化支 $s$ 的态密度 $g_s(\\omega)$ 可由关系式 $g_s(\\omega)d\\omega = \\frac{V}{(2\\pi)^3} 4\\pi (\\frac{\\omega}{v_s})^2 \\frac{d\\omega}{v_s}$ 得到，即：\n$$g_s(\\omega) = \\frac{V \\omega^2}{2\\pi^2 v_s^3}$$\n总态密度 $g(\\omega)$ 是对所有极化支的求和：\n$$g(\\omega) = g_L(\\omega) + 2 g_T(\\omega) = \\frac{V \\omega^2}{2\\pi^2 v_L^3} + 2 \\frac{V \\omega^2}{2\\pi^2 v_T^3} = \\frac{V \\omega^2}{2\\pi^2} \\left( \\frac{1}{v_L^3} + \\frac{2}{v_T^3} \\right)$$\n内能现在可以写成频率的积分：\n$$U(T) = \\int_0^{\\omega_D} g(\\omega) \\frac{\\hbar \\omega}{\\exp(\\hbar \\omega / (k_B T)) - 1} d\\omega$$\n其中 $\\omega_D$ 是德拜截止频率。代入 $g(\\omega)$ 的表达式：\n$$U(T) = \\int_0^{\\omega_D} \\frac{V \\omega^2}{2\\pi^2} \\left( \\frac{1}{v_L^3} + \\frac{2}{v_T^3} \\right) \\frac{\\hbar \\omega}{\\exp(\\hbar \\omega / (k_B T)) - 1} d\\omega$$\n$$U(T) = \\frac{V \\hbar}{2\\pi^2} \\left( \\frac{1}{v_L^3} + \\frac{2}{v_T^3} \\right) \\int_0^{\\omega_D} \\frac{\\omega^3}{\\exp(\\hbar \\omega / (k_B T)) - 1} d\\omega$$\n现在我们应用低温条件 $T \\ll \\Theta_D$，其中 $\\Theta_D = \\hbar \\omega_D / k_B$。这意味着积分的无量纲单位上限将很大。我们进行换元：$x = \\hbar \\omega / (k_B T)$。则 $\\omega = x k_B T / \\hbar$ 且 $d\\omega = (k_B T / \\hbar) dx$。积分上限变为 $x_{max} = \\hbar \\omega_D / (k_B T) = \\Theta_D / T$。\n$$U(T) = \\frac{V \\hbar}{2\\pi^2} \\left( \\frac{1}{v_L^3} + \\frac{2}{v_T^3} \\right) \\left( \\frac{k_B T}{\\hbar} \\right)^4 \\int_0^{\\Theta_D/T} \\frac{x^3}{e^x - 1} dx$$\n由于 $T \\ll \\Theta_D$，积分上限 $\\Theta_D / T \\to \\infty$。该积分可以被标准定积分替换：\n$$\\int_0^\\infty \\frac{x^3}{e^x - 1} dx = \\Gamma(4)\\zeta(4) = 3! \\cdot \\frac{\\pi^4}{90} = 6 \\frac{\\pi^4}{90} = \\frac{\\pi^4}{15}$$\n将此值代回 $U(T)$ 的表达式：\n$$U(T) = \\frac{V \\hbar}{2\\pi^2} \\left( \\frac{1}{v_L^3} + \\frac{2}{v_T^3} \\right) \\left( \\frac{k_B T}{\\hbar} \\right)^4 \\frac{\\pi^4}{15} = \\frac{V \\pi^2 k_B^4}{30 \\hbar^3} \\left( \\frac{1}{v_L^3} + \\frac{2}{v_T^3} \\right) T^4$$\n定容晶格热容为 $C(T) = (\\partial U / \\partial T)_V$：\n$$C(T) = \\frac{\\partial}{\\partial T} \\left[ \\frac{V \\pi^2 k_B^4}{30 \\hbar^3} \\left( \\frac{1}{v_L^3} + \\frac{2}{v_T^3} \\right) T^4 \\right] = \\frac{4V \\pi^2 k_B^4}{30 \\hbar^3} \\left( \\frac{1}{v_L^3} + \\frac{2}{v_T^3} \\right) T^3$$\n$$C(T) = \\frac{2V \\pi^2 k_B^4}{15 \\hbar^3} \\left( \\frac{1}{v_L^3} + \\frac{2}{v_T^3} \\right) T^3$$\n这就是热容的德拜 $T^3$ 定律。系数 $\\beta$ 定义为 $C(T) = \\beta T^3$，所以：\n$$\\beta = \\frac{2 \\pi^2 k_B^4 V}{15 \\hbar^3} \\left( \\frac{1}{v_L^3} + \\frac{2}{v_T^3} \\right)$$\n这个 $\\beta$ 的表达式是用所要求的变量 $V$、$v_L$、$v_T$、$k_{B}$ 和 $\\hbar$ 表示的。\n\n为了按要求完成讨论，我们展示数密度 $n$ 和声速的依赖关系是如何通过 $\\Theta_D$ 体现的。德拜模型构建了一个平均声速 $v_D$，使得低频态密度为 $g(\\omega) = \\frac{3V\\omega^2}{2\\pi^2 v_D^3}$。与我们之前 $g(\\omega)$ 的表达式比较，我们得到这个平均值的定义：\n$$\\frac{3}{v_D^3} = \\frac{1}{v_L^3} + \\frac{2}{v_T^3}$$\n德拜截止频率 $\\omega_D$ 由模式总数为 $3N$ 的条件确定：\n$$\\int_0^{\\omega_D} g(\\omega) d\\omega = \\int_0^{\\omega_D} \\frac{3V\\omega^2}{2\\pi^2 v_D^3} d\\omega = \\frac{V\\omega_D^3}{2\\pi^2 v_D^3} = 3N$$\n这得到 $\\omega_D^3 = 6\\pi^2 (N/V) v_D^3 = 6\\pi^2 n v_D^3$。因此，德拜温度为：\n$$\\Theta_D = \\frac{\\hbar \\omega_D}{k_B} = \\frac{\\hbar v_D}{k_B} (6 \\pi^2 n)^{1/3}$$\n这个方程明确地表明 $\\Theta_D$ 依赖于数密度 $n$ 和平均速度 $v_D$，而 $v_D$ 又是 $v_L$ 和 $v_T$ 的一个特定平均。我们推导出的 $\\beta$ 表达式已经正确地消去了这些中间参数，而使用了指定的基本量。", "answer": "$$\n\\boxed{\\frac{2 \\pi^2 k_B^4 V}{15 \\hbar^3} \\left( \\frac{1}{v_L^3} + \\frac{2}{v_T^3} \\right)}\n$$", "id": "2812983"}, {"introduction": "物理模型的最终价值在于其解释和预测实验数据的能力。这个计算实践将理论付诸实践，要求你通过编写程序，使用非线性最小二乘法将德拜模型（包括完整的德拜积分形式）与模拟的实验数据进行拟合。通过这项练习，你将掌握如何从热容测量中提取关键材料参数——德拜温度 $\\Theta_D$，这是连接理论与材料表征的重要技能。[@problem_id:2408089]", "problem": "您得到的任务是通过使用最小二乘数据拟合，将低温摩尔热容数据与德拜模型进行拟合，从而确定晶体固体的德拜温度，记为 $\\Theta_{D}$。从晶体固体中晶格振动的基本原理出发：假设声子色散关系在截止角频率 $\\omega_{D}$ 以下为线性关系 $\\omega = v_{s} k$，并使用声子的玻色-爱因斯坦分布。在德拜近似中，声子态密度在 $\\omega_{D}$ 以下与 $\\omega^{2}$ 成正比。将每摩尔内能表示为对声子模式进行玻色-爱因斯坦占据数积分的形式，然后通过对温度 $T$ 求导得到定容摩尔热容 $C_{V}(T)$。在此任务所关注的低温区，您可以假设定压摩尔热容 $C_{P}(T)$ 近似等于 $C_{V}(T)$，因为对于固体而言，这种差异在低温下可以忽略不计。对于金属，需要包含一个与 $T$ 成线性关系的独立导电电子贡献，该贡献由系数 $\\gamma$ 参数化。\n\n您的程序必须以科学上可靠且数值上稳定的方式实现以下步骤：\n1. 从第一性原理推导出摩尔晶格热容 $C_{\\text{lat}}(T,\\Theta_{D})$ 的德拜模型表达式，该表达式为一个涉及无量纲变量和德拜温度 $\\Theta_{D}$ 的积分。然后构建总的低温摩尔热容模型\n   $$C_{\\text{model}}(T;\\Theta_{D},\\gamma) = C_{\\text{lat}}(T,\\Theta_{D}) + \\gamma\\,T,$$\n   其中 $\\gamma$ 是电子系数（对于绝缘体，$\\gamma = 0$）。\n2. 使用给定的合成数据集 $(T_{i}, C_{i}, \\sigma_{i})$，为参数 $\\Theta_{D}$ 和 $\\gamma$ 建立加权非线性最小二乘拟合，其中 $T_{i}$ 是温度，$C_{i}$ 是观测到的摩尔热容，$\\sigma_{i}$ 是已知的标准不确定度，用作权重。\n3. 为保证数值稳定性，选择合理的参数边界以强制 $\\Theta_{D} > 0$ 和 $\\gamma \\ge 0$，并提供基于物理原理的初始猜测值。利用德拜模型在低温下的三次幂行为构建 $\\Theta_{D}$ 的初始猜测值，并利用在极低温下 $C(T)/T$ 中的近线性项构建 $\\gamma$ 的初始猜测值。\n4. 使用可靠的数值积分方法来评估 $C_{\\text{lat}}(T,\\Theta_{D})$ 中的德拜积分，并根据需要仔细处理大的积分上限和过小/过大的参数，以确保数值稳定性。\n\n物理常数和单位：\n- 使用摩尔气体常数 $R$，单位为焦耳每摩尔每开尔文（$\\mathrm{J\\,mol^{-1}\\,K^{-1}}$）。\n- 温度 $T$ 和德拜温度 $\\Theta_{D}$ 的单位必须是开尔文（$\\mathrm{K}$）。\n- 热容 $C$ 的单位必须是焦耳每摩尔每开尔文（$\\mathrm{J\\,mol^{-1}\\,K^{-1}}$）。\n- 电子系数 $\\gamma$ 的单位必须是焦耳每摩尔每开尔文平方（$\\mathrm{J\\,mol^{-1}\\,K^{-2}}$）。\n- 以开尔文（$\\mathrm{K}$）为单位，表示最终拟合出的 $\\Theta_{D}$ 值。\n\n测试套件（合成数据集需按规定精确生成）：\n对于每个数据集，使用真实参数从模型构建 $C_{i}$，并添加一个小的确定性扰动 $\\varepsilon_{i}$ 以模拟测量噪声。具体来说，对于每个温度 $T_{i}$，\n$$C_{i} = C_{\\text{lat}}(T_{i},\\Theta_{D}^{\\ast}) + \\gamma^{\\ast} T_{i} + \\varepsilon_{i},$$\n其中已知的 $\\sigma_{i}$ 将在拟合中用作权重。使用以下三个数据集：\n\n- 数据集 A（绝缘体）：\n  - 真实参数：$\\Theta_{D}^{\\ast} = 220.0\\,\\mathrm{K}$，$\\gamma^{\\ast} = 0.0\\,\\mathrm{J\\,mol^{-1}\\,K^{-2}}$。\n  - 温度（开尔文）：$T = [\\,4,\\,6,\\,8,\\,10,\\,12,\\,14,\\,16,\\,18,\\,20,\\,22,\\,24,\\,26,\\,28\\,]$。\n  - 确定性扰动：$\\varepsilon_{i} = a \\sin(b T_{i})$，其中 $a = 0.003\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，$b = 0.25\\,\\mathrm{rad\\,K^{-1}}$。\n  - 不确定度：对于所有 $i$，$\\sigma_{i} = 0.003\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n\n- 数据集 B（金属）：\n  - 真实参数：$\\Theta_{D}^{\\ast} = 310.0\\,\\mathrm{K}$，$\\gamma^{\\ast} = 0.0012\\,\\mathrm{J\\,mol^{-1}\\,K^{-2}}$。\n  - 温度（开尔文）：$T = [\\,2,\\,3,\\,4,\\,5,\\,6,\\,7,\\,8,\\,9,\\,10,\\,11,\\,12\\,]$。\n  - 确定性扰动：$\\varepsilon_{i} = a \\cos(b T_{i})$，其中 $a = 0.001\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，$b = 0.20\\,\\mathrm{rad\\,K^{-1}}$。\n  - 不确定度：对于所有 $i$，$\\sigma_{i} = 0.001\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n\n- 数据集 C（绝缘体，极低温，数据稀疏）：\n  - 真实参数：$\\Theta_{D}^{\\ast} = 150.0\\,\\mathrm{K}$，$\\gamma^{\\ast} = 0.0\\,\\mathrm{J\\,mol^{-1}\\,K^{-2}}$。\n  - 温度（开尔文）：$T = [\\,1,\\,2,\\,3,\\,4,\\,5,\\,6\\,]$。\n  - 确定性扰动：$\\varepsilon_{i} = a \\sin(b T_{i})$，其中 $a = 0.0005\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，$b = 0.50\\,\\mathrm{rad\\,K^{-1}}$。\n  - 不确定度：对于所有 $i$，$\\sigma_{i} = 0.0005\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n\n算法和数值要求：\n- 使用稳健的非线性最小二乘法独立估计每个数据集的 $(\\Theta_{D},\\gamma)$，将提供的 $\\sigma_{i}$ 视为加权拟合中的绝对标准差。\n- 使用物理上合理的参数边界，强制要求 $\\Theta_{D} > 0$ 和 $\\gamma \\ge 0$。\n- 提供基于德拜模型低温渐近行为推导出的初始猜测值，但不在问题陈述中透露明确的快捷公式。\n\n最终输出规范：\n- 您的程序必须生成一行输出，其中包含数据集 A、B 和 C 的拟合德拜温度，按此顺序排列，每个值都四舍五入到恰好两位小数，单位为开尔文（$\\mathrm{K}$），格式为逗号分隔的 Python 风格列表。例如，程序输出必须类似于\n  $$[\\,\\Theta_{D,A},\\Theta_{D,B},\\Theta_{D,C}\\,],$$\n  其中每个条目都是一个四舍五入到两位小数的浮点数，不打印单位。", "solution": "主要目标是通过将摩尔热容 $C(T)$ 的实验数据与理论模型进行拟合来确定固体的德拜温度 $\\Theta_D$。该模型必须同时考虑晶格振动（声子）和（对于金属）导电电子。\n\n首先，我们从基本原理推导摩尔晶格热容 $C_{\\text{lat}}(T, \\Theta_D)$ 的表达式。一摩尔固体的晶格振动总内能 $U$ 是所有 $3 N_A$ 个声子模式的平均能量之和，其中 $N_A$ 是阿伏伽德罗常数。在德拜模型中，该模型假设声子谱是连续的，直至一个截止频率 $\\omega_D$，这个和变成了一个对声子态密度 $g(\\omega)$ 的积分：\n$$ U = \\int_{0}^{\\omega_D} \\hbar\\omega \\, \\langle n(\\omega, T) \\rangle \\, g(\\omega) \\, d\\omega $$\n这里，$\\hbar$ 是约化普朗克常数，$\\langle n(\\omega, T) \\rangle = (e^{\\hbar\\omega/k_BT} - 1)^{-1}$ 是频率为 $\\omega$ 的声子模式在温度 $T$ 下的平均占据数，由玻色-爱因斯坦分布给出，其中 $k_B$ 是玻尔兹曼常数。\n\n德拜模型假设态密度为 $g(\\omega) = A\\omega^2$。归一化常数 $A$ 通过要求每摩尔的总模式数为 $3N_A$ 来确定：\n$$ \\int_{0}^{\\omega_D} g(\\omega) \\, d\\omega = \\int_{0}^{\\omega_D} A\\omega^2 \\, d\\omega = A\\frac{\\omega_D^3}{3} = 3N_A \\implies A = \\frac{9N_A}{\\omega_D^3} $$\n因此，摩尔内能为：\n$$ U = \\frac{9N_A\\hbar}{\\omega_D^3} \\int_{0}^{\\omega_D} \\frac{\\omega^3}{e^{\\hbar\\omega/k_BT} - 1} \\, d\\omega $$\n定容摩尔热容为 $C_V = (\\partial U / \\partial T)_V$。对 $U$ 的表达式关于 $T$ 求导，得到一个适用于数值计算的标准形式。引入无量纲积分变量 $x = \\hbar\\omega/k_BT$ 和德拜温度 $\\Theta_D = \\hbar\\omega_D/k_B$，我们得到：\n$$ C_{\\text{lat}}(T, \\Theta_D) = 9R \\left(\\frac{T}{\\Theta_D}\\right)^3 \\int_{0}^{\\Theta_D/T} \\frac{x^4 e^x}{(e^x-1)^2} \\, dx $$\n其中 $R = N_A k_B$ 是摩尔气体常数。在此问题相关的低温下，定压热容和定容热容之间的差异可以忽略不计，因此我们可以将 $C_{\\text{lat}}$ 等同于测量的晶格热容。\n\n对于金属，我们必须加上电子的贡献，该贡献与温度成线性关系：$C_{\\text{el}}(T) = \\gamma T$，其中 $\\gamma$ 是索末菲系数。因此，总的摩尔热容模型是：\n$$ C_{\\text{model}}(T; \\Theta_D, \\gamma) = C_{\\text{lat}}(T, \\Theta_D) + \\gamma T $$\n对于绝缘体，$\\gamma = 0$。\n\n参数 $\\Theta_D$ 和 $\\gamma$ 是通过最小化模型与带有测量不确定度 $\\sigma_i$ 的实验数据点 $(T_i, C_i)$ 之间的加权残差平方和 $\\chi^2$ 来确定的：\n$$ \\chi^2(\\Theta_D, \\gamma) = \\sum_{i=1}^{N} \\left( \\frac{C_i - C_{\\text{model}}(T_i; \\Theta_D, \\gamma)}{\\sigma_i} \\right)^2 $$\n这是一个标准的加权非线性最小二乘问题，我们使用 `scipy.optimize.curve_fit` 函数来解决，并满足物理约束条件 $\\Theta_D > 0$ 和 $\\gamma \\ge 0$。\n\n非线性拟合算法的稳定收敛需要良好的初始参数估计。这些估计可以从模型的低温渐近行为中推导出来。当 $T \\ll \\Theta_D$ 时，德拜积分的上限 $\\Theta_D/T \\to \\infty$，积分收敛于常数 $\\int_0^\\infty [x^4 e^x / (e^x-1)^2] dx = 4\\pi^4/15$。因此，晶格热容遵循著名的德拜 $T^3$ 定律：\n$$ C_{\\text{lat}}(T, \\Theta_D) \\approx \\left(\\frac{12\\pi^4 R}{5\\Theta_D^3}\\right) T^3 = A_D T^3 $$\n总热容为 $C_{\\text{model}} \\approx A_D T^3 + \\gamma T$。整理此表达式揭示了一个线性关系：\n$$ \\frac{C_{\\text{model}}}{T} \\approx \\gamma + A_D T^2 $$\n通过对变换后的实验数据 $(T_i^2, C_i/T_i)$ 进行线性回归，我们可以获得初始猜测值。直线 $y=mx+c$ 的截距提供了对 $\\gamma_0$ 的估计，而斜率则通过关系 $A_D = m$ 提供了对 $\\Theta_{D,0}$ 的估计：\n$$ \\gamma_0 = c \\quad ; \\quad \\Theta_{D,0} = \\left(\\frac{12\\pi^4 R}{5m}\\right)^{1/3} $$\n该方法为非线性优化提供了稳健且有物理动机的初值。\n\n实现过程包括创建一个用于 $C_{\\text{model}}(T, \\Theta_D, \\gamma)$ 的 Python 函数，该函数使用 `scipy.integrate.quad` 数值计算德拜积分。对于每个数据集，按规定生成合成数据。然后，计算初始猜测值，并使用数据、不确定度、初始猜测值和参数边界执行 `scipy.optimize.curve_fit`。然后收集每个数据集的 $\\Theta_D$ 拟合值，并以所需格式打印出来。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import constants, integrate, optimize\n\ndef solve():\n    \"\"\"\n    Solves for the Debye temperature by fitting heat capacity data.\n    \"\"\"\n    # Define physical constant R\n    R = constants.R  # Molar gas constant in J/(mol K)\n\n    def debye_integrand(x):\n        \"\"\"\n        Numerically stable integrand for the Debye heat capacity formula.\n        \"\"\"\n        # The term np.expm1(x) is equivalent to np.exp(x) - 1, but is\n        # more numerically stable for small x.\n        if np.isclose(x, 0.0):\n            return 0.0\n        return (x**4 * np.exp(x)) / (np.expm1(x))**2\n\n    def C_lat(T, Theta_D):\n        \"\"\"\n        Molar lattice heat capacity from the Debye model.\n        Args:\n            T (float or np.ndarray): Temperature(s) in Kelvin.\n            Theta_D (float): Debye temperature in Kelvin.\n        Returns:\n            float or np.ndarray: Lattice heat capacity in J/(mol K).\n        \"\"\"\n        if Theta_D = 0:\n            return np.inf\n        \n        T_arr = np.atleast_1d(T)\n        results = np.zeros_like(T_arr, dtype=float)\n\n        for i, temp in enumerate(T_arr):\n            if temp == 0:\n                results[i] = 0.0\n                continue\n            \n            upper_limit = Theta_D / temp\n            integral_val, _ = integrate.quad(debye_integrand, 0, upper_limit)\n            \n            prefactor = 9.0 * R * (temp / Theta_D)**3\n            results[i] = prefactor * integral_val\n        \n        return results if len(results) > 1 else results[0]\n\n    def C_model(T, Theta_D, gamma):\n        \"\"\"\n        Total molar heat capacity model (lattice + electronic).\n        \"\"\"\n        return C_lat(T, Theta_D) + gamma * T\n\n    def get_initial_guesses(T, C_obs):\n        \"\"\"\n        Calculates initial guesses for Theta_D and gamma based on the\n        low-temperature limit C/T = gamma + A*T^2.\n        \"\"\"\n        x_fit = T**2\n        y_fit = C_obs / T\n        \n        # Perform a linear fit: y = intercept + slope * x\n        slope, intercept = np.polyfit(x_fit, y_fit, 1)\n\n        # Initial guess for gamma is the intercept\n        gamma_0 = max(0.0, intercept)\n\n        # Initial guess for Theta_D comes from the slope\n        # slope = (12 * pi^4 * R) / (5 * Theta_D^3)\n        if slope = 1e-9:\n            # If slope is non-positive or very small, use a default guess\n            Theta_D_0 = 200.0\n        else:\n            Theta_D_0 = ((12.0 * np.pi**4 * R) / (5.0 * slope))**(1.0/3.0)\n        \n        # Sanity check for Theta_D_0\n        if not np.isfinite(Theta_D_0) or Theta_D_0 = 1.0 or Theta_D_0 > 2000.0:\n            Theta_D_0 = 200.0\n\n        return Theta_D_0, gamma_0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"Theta_D_star\": 220.0, \"gamma_star\": 0.0,\n            \"T_vals\": np.array([4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28], dtype=float),\n            \"noise_a\": 0.003, \"noise_b\": 0.25,\n            \"noise_func\": lambda t, a, b: a * np.sin(b * t),\n            \"sigma_val\": 0.003\n        },\n        {\n            \"Theta_D_star\": 310.0, \"gamma_star\": 0.0012,\n            \"T_vals\": np.array([2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], dtype=float),\n            \"noise_a\": 0.001, \"noise_b\": 0.20,\n            \"noise_func\": lambda t, a, b: a * np.cos(b * t),\n            \"sigma_val\": 0.001\n        },\n        {\n            \"Theta_D_star\": 150.0, \"gamma_star\": 0.0,\n            \"T_vals\": np.array([1, 2, 3, 4, 5, 6], dtype=float),\n            \"noise_a\": 0.0005, \"noise_b\": 0.50,\n            \"noise_func\": lambda t, a, b: a * np.sin(b * t),\n            \"sigma_val\": 0.0005\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        T = case[\"T_vals\"]\n        sigma_val = case[\"sigma_val\"]\n        sigma = np.full_like(T, sigma_val, dtype=float)\n\n        # Generate synthetic experimental data\n        C_true = C_model(T, case[\"Theta_D_star\"], case[\"gamma_star\"])\n        epsilon = case[\"noise_func\"](T, case[\"noise_a\"], case[\"noise_b\"])\n        C_obs = C_true + epsilon\n\n        # Get initial guesses for the fit\n        p0 = get_initial_guesses(T, C_obs)\n\n        # Set parameter bounds: Theta_D > 0 and gamma >= 0\n        bounds = ([1E-3, 0.0], [np.inf, np.inf])\n\n        # Perform the weighted nonlinear least-squares fit\n        popt, _ = optimize.curve_fit(\n            C_model,\n            T,\n            C_obs,\n            p0=p0,\n            sigma=sigma,\n            bounds=bounds,\n            absolute_sigma=True,\n            method='trf'\n        )\n        \n        theta_d_fit = popt[0]\n        results.append(theta_d_fit)\n    \n    # Final print statement in the exact required format.\n    formatted_results = [f\"{val:.2f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2408089"}]}