{"hands_on_practices": [{"introduction": "在中子散射实验中，测得的强度不仅取决于能量和动量守恒，还关键地依赖于动量转移矢量 $\\mathbf{Q}$ 与声子偏振矢量 $\\mathbf{e}$ 之间的几何排列。这个练习 [@problem_id:2829748] 聚焦于计算 $|\\mathbf{Q} \\cdot \\mathbf{e}|^2$ 这一重要因子。理解并计算该因子是至关重要的，因为它如同一个“选择定则”，允许实验物理学家通过精心选择散射几何（即测量区域 $\\mathbf{Q}$）来有选择性地探测具有特定对称性（例如纵向或横向）的声子，从而揭示晶格动力学的内在细节。", "problem": "单原子面心立方（fcc）晶体的非弹性中子散射表现出一种单声子贡献，其强度包含一个形式为 $|\\mathbf{Q}\\cdot \\mathbf{e}_{s}(\\mathbf{q})|^{2}$ 的极化投影因子，其中 $\\mathbf{Q}$ 是总动量转移，$\\mathbf{q}$ 是相对于倒格矢测量的简约波矢，$\\mathbf{e}_{s}(\\mathbf{q})$ 是声子支 $s$ 的单位极化矢量。考虑一个晶格常数为 $a$、原子质量为 $M$ 的单原子fcc晶体（每个原胞含一个原子）。重点关注以倒格矢单位（rlu）表示的布拉格点 $(2,0,0)$ 附近的散射，其中一个倒格矢单位沿每个笛卡尔轴等于 $2\\pi/a$。记 $\\mathbf{Q}=\\boldsymbol{\\tau}+\\mathbf{q}$，其中 $\\boldsymbol{\\tau}=(2,0,0)\\,(2\\pi/a)$ 且 $|\\mathbf{q}|\\ll |\\boldsymbol{\\tau}|$。在 $\\mathbf{q}\\parallel[100]$ 的纵向扫描几何构型中进行分析，并令 $\\xi$ 表示沿 $[100]$ 方向的简约坐标，从而有 $\\mathbf{q}=\\xi\\,(2\\pi/a)\\,\\hat{\\mathbf{x}}$。\n\n仅利用以下条件：(i) 对于单原子晶体，三个声学支的极化矢量相互标准正交，并且（在 $\\mathbf{q}$ 空间中局部地）纵向声学（LA）极化平行于 $\\mathbf{q}$，而两个横向声学（TA）极化垂直于 $\\mathbf{q}$；以及 (ii) $\\mathbf{Q}=\\boldsymbol{\\tau}+\\mathbf{q}$，其中 $\\boldsymbol{\\tau}$ 如上所述。计算 LA 支以及极化方向分别为 $[010]$ 和 $[001]$ 的两个 TA 支的 $|\\mathbf{Q}\\cdot \\mathbf{e}|^{2}$。请将您的最终结果以 $\\big[\\text{LA},\\,\\text{TA}_{[010]},\\,\\text{TA}_{[001]}\\big]$ 的顺序列为一个单行矩阵，单位为逆长度平方，并保留 $2\\pi/a$ 的显式因子。无需进行数值舍入。", "solution": "该问题要求在指定的散射几何构型中，为一个纵向声学（LA）声子支和两个横向声学（TA）声子支计算极化投影因子 $|\\mathbf{Q}\\cdot \\mathbf{e}_{s}|^{2}$。问题陈述科学上合理、内容自洽且数学上适定，可以直接进行计算。\n\n首先，我们在与立方晶轴对齐的笛卡尔坐标系中定义相关矢量，其中 $\\hat{\\mathbf{x}}$、$\\hat{\\mathbf{y}}$ 和 $\\hat{\\mathbf{z}}$ 分别是沿 $[100]$、$[010]$ 和 $[001]$ 方向的单位矢量。\n\n对应于布拉格点 $(2,0,0)$（以倒格矢单位 rlu 表示，其中 1 rlu 等于 $2\\pi/a$）的倒格矢 $\\boldsymbol{\\tau}$ 由下式给出：\n$$ \\boldsymbol{\\tau} = \\left(2 \\cdot \\frac{2\\pi}{a}\\right)\\hat{\\mathbf{x}} + \\left(0 \\cdot \\frac{2\\pi}{a}\\right)\\hat{\\mathbf{y}} + \\left(0 \\cdot \\frac{2\\pi}{a}\\right)\\hat{\\mathbf{z}} = \\frac{4\\pi}{a} \\hat{\\mathbf{x}} $$\n\n简约声子波矢 $\\mathbf{q}$ 被指定为沿 $[100]$ 方向的纵向扫描：\n$$ \\mathbf{q} = \\xi \\left(\\frac{2\\pi}{a}\\right) \\hat{\\mathbf{x}} $$\n其中 $\\xi$ 是简约坐标。\n\n总动量转移矢量 $\\mathbf{Q}$ 是倒格矢和简约波矢的和：\n$$ \\mathbf{Q} = \\boldsymbol{\\tau} + \\mathbf{q} = \\frac{4\\pi}{a} \\hat{\\mathbf{x}} + \\xi \\left(\\frac{2\\pi}{a}\\right) \\hat{\\mathbf{x}} = \\left(4\\pi + 2\\pi\\xi\\right) \\frac{1}{a} \\hat{\\mathbf{x}} = (2+\\xi)\\left(\\frac{2\\pi}{a}\\right)\\hat{\\mathbf{x}} $$\n\n接下来，我们确定三个声学支的单位极化矢量 $\\mathbf{e}_{s}$。\n对于 LA 支，其极化平行于波矢 $\\mathbf{q}$。由于 $\\mathbf{q}$ 沿 $\\hat{\\mathbf{x}}$ 方向，单位极化矢量为：\n$$ \\mathbf{e}_{\\text{LA}} = \\hat{\\mathbf{x}} $$\n\n对于两个 TA 支，其极化方向被指定为沿 $[010]$ 和 $[001]$ 方向。根据横向模式的要求，这些方向确实与 $\\mathbf{q}$ 正交。单位极化矢量为：\n$$ \\mathbf{e}_{\\text{TA}_{[010]}} = \\hat{\\mathbf{y}} $$\n$$ \\mathbf{e}_{\\text{TA}_{[001]}} = \\hat{\\mathbf{z}} $$\n\n现在我们为每个声子支计算量 $|\\mathbf{Q}\\cdot \\mathbf{e}_{s}|^{2}$。\n\n对于 LA 支：\n标量积为：\n$$ \\mathbf{Q} \\cdot \\mathbf{e}_{\\text{LA}} = \\left( (2+\\xi)\\left(\\frac{2\\pi}{a}\\right)\\hat{\\mathbf{x}} \\right) \\cdot \\hat{\\mathbf{x}} $$\n由于 $\\hat{\\mathbf{x}} \\cdot \\hat{\\mathbf{x}} = 1$，我们有：\n$$ \\mathbf{Q} \\cdot \\mathbf{e}_{\\text{LA}} = (2+\\xi)\\left(\\frac{2\\pi}{a}\\right) $$\n模的平方为：\n$$ |\\mathbf{Q} \\cdot \\mathbf{e}_{\\text{LA}}|^{2} = \\left( (2+\\xi)\\left(\\frac{2\\pi}{a}\\right) \\right)^{2} = (2+\\xi)^{2}\\left(\\frac{2\\pi}{a}\\right)^{2} $$\n\n对于极化方向沿 $[010]$ 的 TA 支：\n标量积为：\n$$ \\mathbf{Q} \\cdot \\mathbf{e}_{\\text{TA}_{[010]}} = \\left( (2+\\xi)\\left(\\frac{2\\pi}{a}\\right)\\hat{\\mathbf{x}} \\right) \\cdot \\hat{\\mathbf{y}} $$\n由于笛卡尔单位矢量是正交的，$\\hat{\\mathbf{x}} \\cdot \\hat{\\mathbf{y}} = 0$。因此：\n$$ \\mathbf{Q} \\cdot \\mathbf{e}_{\\text{TA}_{[010]}} = 0 $$\n模的平方为：\n$$ |\\mathbf{Q} \\cdot \\mathbf{e}_{\\text{TA}_{[010]}}|^{2} = 0 $$\n\n对于极化方向沿 $[001]$ 的 TA 支：\n标量积为：\n$$ \\mathbf{Q} \\cdot \\mathbf{e}_{\\text{TA}_{[001]}} = \\left( (2+\\xi)\\left(\\frac{2\\pi}{a}\\right)\\hat{\\mathbf{x}} \\right) \\cdot \\hat{\\mathbf{z}} $$\n由于 $\\hat{\\mathbf{x}} \\cdot \\hat{\\mathbf{z}} = 0$，我们有：\n$$ \\mathbf{Q} \\cdot \\mathbf{e}_{\\text{TA}_{[001]}} = 0 $$\n模的平方为：\n$$ |\\mathbf{Q} \\cdot \\mathbf{e}_{\\text{TA}_{[001]}}|^{2} = 0 $$\n\n最后，我们按照指定的顺序 $[\\text{LA},\\, \\text{TA}_{[010]},\\, \\text{TA}_{[001]}]$ 将这些结果组合成一个单行矩阵。结果的单位符合要求的逆长度平方。", "answer": "$$ \\boxed{\\begin{pmatrix} (2+\\xi)^{2}\\left(\\frac{2\\pi}{a}\\right)^{2}  0  0 \\end{pmatrix}} $$", "id": "2829748"}, {"introduction": "检验是否真正掌握一个物理模型的最终标准，是能否利用它从头开始构建一个可计算的、能够预测实验结果的工具。这项综合性练习 [@problem_id:2829819] 正是为此目的而设计，它要求你首先从费米黄金定则这一基本原理出发，推导出单声子非弹性散射强度的完整表达式。随后，你需要将这个理论公式转化为一段计算机程序，用以模拟和预测在特定实验条件下的散射强度。这项练习完美地连接了抽象的理论推导与具体的计算模拟，是培养现代材料物理学家必备核心技能的关键一步。", "problem": "晶体固体支持晶格振动模式，这些模式可以通过产生或湮灭单个声子来非弹性地散射中子。从费米黄金定则和相干动态结构因子的定义出发，推导在指定简约波矢下单个声子分支的单声子非弹性中子散射强度。推导需基于以下物理上合理的简化：忽略多声子项，忽略德拜-瓦勒因子，并假设中子能量相对于入射能量的变化很小，从而使入射中子与散射中子的波矢比可视为单位1。您的推导必须明确地将强度与晶体的微观组分联系起来：原子相干散射长度、原子质量、实空间基底位置、声子本征矢量、声子能量、通过玻色-爱因斯坦布居因子体现的温度，以及散射矢量。不要使用任何现成的强度公式；仅从第一性原理和标准定义出发进行推导。\n\n然后，通过算法实现所推导的表达式，为几个独立的测试用例计算沿给定倒易空间路径的相对单声子强度（以任意无量纲单位表示）。对于每个散射矢量，使用所提供的单个声子模式及其本征矢量。玻色-爱因斯坦因子必须根据声子能量和温度计算。明确使用单位为 $\\mathrm{meV/K}$ 的 $k_{\\mathrm{B}}$，以便能量单位为 $\\mathrm{meV}$，温度单位为 $\\mathrm{K}$。散射矢量分量的单位是 $\\mathrm{\\AA^{-1}}$，原子位置的单位是 $\\mathrm{\\AA}$，原子质量的单位是原子质量单位。您的数值程序还必须为每个测试用例从路径中提出一个“最优”的测量 $\\mathbf{Q}$，其定义为所提供的 $\\mathbf{Q}$ 列表中，在满足幅度窗口 $Q_{\\min} \\le \\lvert \\mathbf{Q} \\rvert \\le Q_{\\max}$ 和能量窗口 $E_{\\min} \\le E \\le E_{\\max}$ 的同时，能使计算出的单声子强度最大化的那个点。如果没有点同时满足这两个窗口，则返回列表中的第一个 $\\mathbf{Q}$，并推荐强度为零。\n\n使用以下的物理常数、单位、晶体数据和路径。下面给出的所有数字都是明确的，必须按原样使用。以毫电子伏特每开尔文为单位的玻尔兹曼常数是 $k_{\\mathrm{B}} = 0.08617333~\\mathrm{meV/K}$。程序应将强度视为任意无量纲数并直接报告。\n\n测试套件的输入数据（嵌入在您的程序中；无外部输入）：\n\n测试用例 $1$（单原子类纵向声学模式）：\n- 原子：单个原子，位置 $\\mathbf{r}_1 = (0, 0, 0)~\\mathrm{\\AA}$，相干散射长度 $b_1 = 1.0$，质量 $M_1 = 50.0$。\n- 温度 $T = 300.0~\\mathrm{K}$。\n- 倒易空间路径点（单位 $\\mathrm{\\AA^{-1}}$）：$\\mathbf{Q}_1 = (0.1, 0.0, 0.0)$，$\\mathbf{Q}_2 = (0.2, 0.0, 0.0)$，$\\mathbf{Q}_3 = (0.3, 0.0, 0.0)$。\n- 对于每个 $\\mathbf{Q}_i$，单个声子模式的本征矢量为 $\\mathbf{e}_{1} = (1.0, 0.0, 0.0)$（已归一化，即所有原子笛卡尔分量的平方和等于$1$），声子能量为 $E_i = 10.0 \\times \\lvert \\mathbf{Q}_i \\rvert~\\mathrm{meV}$，即 $E_1 = 1.0~\\mathrm{meV}$，$E_2 = 2.0~\\mathrm{meV}$，$E_3 = 3.0~\\mathrm{meV}$。\n- 选择窗口：$Q_{\\min} = 0.05$, $Q_{\\max} = 0.5$, $E_{\\min} = 0.5~\\mathrm{meV}$, $E_{\\max} = 5.0~\\mathrm{meV}$。\n\n测试用例 $2$（带干涉的双原子光学模式）：\n- 晶格参数 $a = 4.0~\\mathrm{\\AA}$，双原子基底 $\\mathbf{r}_1 = (0.0, 0.0, 0.0)~\\mathrm{\\AA}$，$\\mathbf{r}_2 = (2.0, 0.0, 0.0)~\\mathrm{\\AA}$。\n- 相干散射长度 $b_1 = 1.0$，$b_2 = 1.0$。质量 $M_1 = 40.0$，$M_2 = 80.0$。\n- 温度 $T = 300.0~\\mathrm{K}$。\n- 倒易空间路径点：$\\mathbf{Q}_1 = \\left(\\frac{2\\pi}{a}, 0.0, 0.0\\right)$，$\\mathbf{Q}_2 = \\left(\\frac{4\\pi}{a}, 0.0, 0.0\\right)$，$\\mathbf{Q}_3 = \\left(\\frac{6\\pi}{a}, 0.0, 0.0\\right)$，其数值在 $\\mathrm{\\AA^{-1}}$ 中约为 $\\mathbf{Q}_1 \\approx (1.57079633, 0.0, 0.0)$，$\\mathbf{Q}_2 \\approx (3.14159265, 0.0, 0.0)$，$\\mathbf{Q}_3 \\approx (4.71238898, 0.0, 0.0)$。\n- 对于每个 $\\mathbf{Q}_i$，单个声子模式的本征矢量是光学和纵向的：$\\mathbf{e}_{1} = \\frac{1}{\\sqrt{2}}(1.0, 0.0, 0.0)$，$\\mathbf{e}_{2} = \\frac{1}{\\sqrt{2}}(-1.0, 0.0, 0.0)$。\n- 所有点的声子能量：$E_i = 30.0~\\mathrm{meV}$。\n- 选择窗口：$Q_{\\min} = 1.0$, $Q_{\\max} = 5.0$, $E_{\\min} = 20.0~\\mathrm{meV}$, $E_{\\max} = 40.0~\\mathrm{meV}$。\n\n测试用例 $3$（产生零投影的单原子横向模式）：\n- 原子：单个原子，位置 $\\mathbf{r}_1 = (0, 0, 0)~\\mathrm{\\AA}$，其中 $b_1 = 1.0$，$M_1 = 50.0$。\n- 温度 $T = 300.0~\\mathrm{K}$。\n- 倒易空间路径点（单位 $\\mathrm{\\AA^{-1}}$）：$\\mathbf{Q}_1 = (0.2, 0.0, 0.0)$，$\\mathbf{Q}_2 = (0.4, 0.0, 0.0)$。\n- 每个点上单个声子模式的本征矢量：$\\mathbf{e}_{1} = (0.0, 1.0, 0.0)$（与路径横向）。\n- 所有点的声子能量：$E_i = 15.0~\\mathrm{meV}$。\n- 选择窗口：$Q_{\\min} = 0.1$, $Q_{\\max} = 0.5$, $E_{\\min} = 10.0~\\mathrm{meV}$, $E_{\\max} = 20.0~\\mathrm{meV}$。\n\n测试用例 $4$（温度依赖性，单点）：\n- 原子：单个原子，位置 $\\mathbf{r}_1 = (0, 0, 0)~\\mathrm{\\AA}$，其中 $b_1 = 1.0$，$M_1 = 50.0$。\n- 温度 $T = 10.0~\\mathrm{K}$。\n- 由单个点组成的倒易空间路径：$\\mathbf{Q}_1 = (0.3, 0.3, 0.0)$，单位 $\\mathrm{\\AA^{-1}}$。\n- 与 $\\mathbf{Q}_1$ 纵向对齐的本征矢量：$\\mathbf{e}_{1} = \\frac{1}{\\sqrt{2}}(1.0, 1.0, 0.0)$。\n- 声子能量：$E_1 = 7.0~\\mathrm{meV}$。\n- 选择窗口：$Q_{\\min} = 0.1$, $Q_{\\max} = 1.0$, $E_{\\min} = 1.0~\\mathrm{meV}$, $E_{\\max} = 10.0~\\mathrm{meV}$。\n\n计算要求和输出：\n- 实现您的推导所隐含的算法。对于每个测试用例，计算路径点上的单声子强度列表（以任意无量纲单位表示），并根据上述规则提出最优的 $\\mathbf{Q}$。\n- 舍入：在最终输出中，将所有强度舍入到 $6$ 位小数，将所有建议的 $\\mathbf{Q}$ 分量舍入到 $6$ 位小数。\n- 最终输出格式：您的程序应生成单行输出，包含一个列表，每个测试用例占一个条目。每个条目本身是一个包含两个元素的列表：第一个是舍入后强度值的列表（每个路径点一个），第二个是舍入后的最优 $\\mathbf{Q}$，作为一个长度为3的列表。例如，打印的结构必须是 $[[[i_{1,1}, i_{1,2}, \\dots], [Q_{1,x}, Q_{1,y}, Q_{1,z}]], [[i_{2,1}, \\dots], [Q_{2,x}, Q_{2,y}, Q_{2,z}]], \\dots]$，并用数值代替符号。\n- 角度单位：不需要角度；所有矢量都是笛卡尔坐标，单位如指定为 $\\mathrm{\\AA^{-1}}$ 或 $\\mathrm{\\AA}$。", "solution": "该问题是有效的，因为它在科学上基于固态物理学的原理，问题清晰、客观，并包含进行理论推导和数值实现所需的所有必要信息。它提出了一个在使用中子散射研究晶格动力学方面的标准而完整的问题，要求从第一性原理出发。\n\n任务是推导单声子非弹性中子散射强度，然后通过计算实现它。我将首先进行推导，然后解释为解决所提供的测试用例而设计的算法。\n\n**单声子非弹性散射强度的推导**\n\n散射中子的强度与双微分散射截面 $\\frac{d^2\\sigma}{d\\Omega dE_f}$ 成正比。我们从费米黄金定则开始，描述从初始组合中子-晶体态 $|\\Psi_i\\rangle = |\\mathbf{k}_i, \\lambda_i\\rangle$ 到最终态 $|\\Psi_f\\rangle = |\\mathbf{k}_f, \\lambda_f\\rangle$ 的跃迁速率 $W$：\n$$ W_{\\mathbf{k}_i, \\lambda_i \\to \\mathbf{k}_f, \\lambda_f} = \\frac{2\\pi}{\\hbar} |\\langle \\mathbf{k}_f, \\lambda_f | \\hat{V} | \\mathbf{k}_i, \\lambda_i \\rangle|^2 \\delta(E_{\\text{total}, f} - E_{\\text{total}, i}) $$\n这里，$|\\mathbf{k}_i\\rangle$ 和 $|\\mathbf{k}_f\\rangle$ 是中子的初始和最终平面波态，而 $|\\lambda_i\\rangle$ 和 $|\\lambda_f\\rangle$ 是晶体声子系统的初始和最终态。总能量是守恒的，由狄拉克δ函数强制执行。从中子到晶体的能量转移是 $E = E_{\\text{neutron}, i} - E_{\\text{neutron}, f} = E_{\\lambda_f} - E_{\\lambda_i}$。\n\n中子与晶体之间的相互作用势 $\\hat{V}$ 是所有位于位置 $\\mathbf{R}_j$ 的原子核 $j$ 的费米赝势之和：\n$$ \\hat{V}(\\mathbf{r}) = \\sum_j \\frac{2\\pi\\hbar^2}{m_n} b_j \\delta(\\mathbf{r} - \\mathbf{R}_j) $$\n其中 $m_n$ 是中子质量，$b_j$ 是原子核 $j$ 的相干散射长度。根据问题要求，我们只考虑相干散射。\n\n中子态之间的势矩阵元是：\n$$ \\langle \\mathbf{k}_f, \\lambda_f | \\hat{V} | \\mathbf{k}_i, \\lambda_i \\rangle = \\int d^3r \\, \\langle\\lambda_f| e^{-i\\mathbf{k}_f \\cdot \\mathbf{r}} \\hat{V}(\\mathbf{r}) e^{i\\mathbf{k}_i \\cdot \\mathbf{r}} |\\lambda_i\\rangle $$\n代入 $\\hat{V}(\\mathbf{r})$ 并对空间坐标 $\\mathbf{r}$ 进行积分，得到：\n$$ \\langle \\mathbf{k}_f, \\lambda_f | \\hat{V} | \\mathbf{k}_i, \\lambda_i \\rangle = \\frac{2\\pi\\hbar^2}{m_n} \\sum_j b_j \\langle \\lambda_f | e^{-i\\mathbf{Q} \\cdot \\mathbf{R}_j} | \\lambda_i \\rangle $$\n其中 $\\mathbf{Q} = \\mathbf{k}_f - \\mathbf{k}_i$ 是散射矢量。\n\n双微分截面是通过对所有可能的最终态 $\\lambda_f$ 求和，并对初始态 $\\lambda_i$ 进行热平均（概率为 $p_i$）得到的：\n$$ \\frac{d^2\\sigma}{d\\Omega dE_f} = \\frac{k_f}{k_i} \\left(\\frac{m_n}{2\\pi\\hbar^2}\\right)^2 \\sum_{\\lambda_i, \\lambda_f} p_i |\\langle \\mathbf{k}_f, \\lambda_f | \\hat{V} | \\mathbf{k}_i, \\lambda_i \\rangle|^2 \\delta(E - (E_{\\lambda_f} - E_{\\lambda_i})) $$\n代入矩阵元得到一个与相干动态结构因子 $S(\\mathbf{Q}, E)$ 成正比的结果：\n$$ \\frac{d^2\\sigma}{d\\Omega dE_f} \\propto \\frac{k_f}{k_i} \\sum_{j, j'} b_j b_{j'} \\sum_{\\lambda_i, \\lambda_f} p_i \\langle \\lambda_i| e^{i\\mathbf{Q}\\cdot\\mathbf{R}_{j'}} |\\lambda_f\\rangle \\langle \\lambda_f| e^{-i\\mathbf{Q}\\cdot\\mathbf{R}_j} |\\lambda_i\\rangle \\delta(E - (E_{\\lambda_f} - E_{\\lambda_i})) $$\n右侧的表达式与 $S(\\mathbf{Q}, E)$ 成正比。为了继续，我们将海森堡绘景中的原子位置 $\\mathbf{R}_j(t)$ 表示为其平衡位置 $\\mathbf{r}_j$ 加上一个小的量子位移算符 $\\mathbf{u}_j(t)$：\n$$ \\mathbf{R}_j(t) = \\mathbf{r}_j + \\mathbf{u}_j(t) $$\n位移算符 $\\mathbf{u}_j(t)$ 以每个模式 $s$（波矢为 $\\mathbf{q}$，能量为 $E_s(\\mathbf{q}) = \\hbar\\omega_s(\\mathbf{q})$）的声子产生($a^\\dagger$)和湮灭($a$)算符展开：\n$$ \\mathbf{u}_j(t) = \\sum_{\\mathbf{q}, s} \\sqrt{\\frac{\\hbar}{2NM_j\\omega_s(\\mathbf{q})}} \\mathbf{e}_{j,s}(\\mathbf{q}) \\left( a_{\\mathbf{q},s}e^{i(\\mathbf{q}\\cdot\\mathbf{r}_j - \\omega_s t)} + a^\\dagger_{\\mathbf{q},s}e^{-i(\\mathbf{q}\\cdot\\mathbf{r}_j - \\omega_s t)} \\right) $$\n这里，$M_j$ 是原子 $j$ 的质量，$\\mathbf{e}_{j,s}(\\mathbf{q})$ 是其在该模式下的极化矢量，$N$ 是晶胞的数量。\n\n对于小位移 $\\mathbf{u}_j$，散射算符 $e^{-i\\mathbf{Q} \\cdot \\mathbf{R}_j}$ 展开为：\n$$ e^{-i\\mathbf{Q} \\cdot \\mathbf{R}_j} = e^{-i\\mathbf{Q} \\cdot \\mathbf{r}_j} e^{-i\\mathbf{Q} \\cdot \\mathbf{u}_j} \\approx e^{-i\\mathbf{Q} \\cdot \\mathbf{r}_j} (1 - i\\mathbf{Q} \\cdot \\mathbf{u}_j + \\dots) $$\n问题要求我们忽略多声子项，这些项来自 $\\mathbf{Q} \\cdot \\mathbf{u}_j$ 的更高次幂。我们还忽略了德拜-瓦勒因子 $e^{-2W_j}$，这等效于此一阶展开。第一项，$1$，导致弹性散射。第二项，$-i\\mathbf{Q} \\cdot \\mathbf{u}_j$，对应于单声子过程。\n\n单声子对散射截面的贡献涉及矩阵元 $\\langle \\lambda_f | -i\\mathbf{Q} \\cdot \\mathbf{u}_j | \\lambda_i \\rangle$。这仅在初始和最终声子态相差一个声子时才非零。\n如果产生一个模式为 $(\\mathbf{q}, s)$ 的声子，则 $|\\lambda_f\\rangle$ 比 $|\\lambda_i\\rangle$ 多一个声子，且 $E = E_s(\\mathbf{q})$。矩阵元的平方贡献一个因子 $n_s(\\mathbf{q}) + 1$，其中 $n_s(\\mathbf{q}) = (e^{E_s(\\mathbf{q})/k_B T} - 1)^{-1}$ 是玻色-爱因斯坦布居因子。\n如果一个声子被湮灭，则 $E = -E_s(\\mathbf{q})$，因子为 $n_s(\\mathbf{q})$。\n\n综合这些元素，通过分离 $\\mathbf{u}_j$ 的线性项，可以找到单声子相干散射截面。强度 $I(\\mathbf{Q}, E)$ 与截面成正比。对于给定波矢 $\\mathbf{q}$（其中动量守恒意味着 $\\mathbf{Q} = \\mathbf{q} + \\mathbf{G}$，$\\mathbf{G}$ 为倒易点阵矢量）的单个声子分支 $s$，产生能量为 $E = E_s$ 的声子的强度为：\n$$ I(\\mathbf{Q}, E) \\propto \\frac{k_f}{k_i} \\frac{n(E, T)+1}{E} \\left| \\sum_j \\frac{b_j}{\\sqrt{M_j}} (\\mathbf{Q} \\cdot \\mathbf{e}_{j,s}) e^{i\\mathbf{Q}\\cdot\\mathbf{r}_j} \\right|^2 $$\n问题指定假设 $k_f/k_i \\approx 1$。由于问题提供的是正声子能量，我们考虑的是声子产生事件（中子能量损失）。所有在计算中保持不变的预因子都可以忽略，因为我们计算的是相对强度。因此，相对强度的最终表达式为：\n$$ I(\\mathbf{Q}, E) \\propto \\frac{n(E, T) + 1}{E} \\left| G(\\mathbf{Q}) \\right|^2 $$\n其中 $G(\\mathbf{Q})$ 是特定模式的非弹性结构因子：\n$$ G(\\mathbf{Q}) = \\sum_{j} \\frac{b_j}{\\sqrt{M_j}} (\\mathbf{Q} \\cdot \\mathbf{e}_j) e^{i\\mathbf{Q}\\cdot\\mathbf{r}_j} $$\n求和遍及晶体学基底中的原子 $j$。该表达式将散射强度与所有必需的微观属性联系起来：原子散射长度 $b_j$、质量 $M_j$、位置 $\\mathbf{r}_j$、声子本征矢量 $\\mathbf{e}_j$、声子能量 $E$、温度 $T$（通过 $n(E,T)$），以及散射矢量 $\\mathbf{Q}$。\n\n**算法实现**\n\n计算任务是为几个测试用例实现推导出的公式，并确定给定路径上的最优散射矢量 $\\mathbf{Q}$。\n\n对于每个测试用例，算法按以下步骤进行：\n1.  定义物理常数和案例的所有数据（原子属性、温度、$\\mathbf{Q}$ 矢量路径、声子能量和本征矢量，以及选择窗口）。玻尔兹曼常数为 $k_{\\text{B}} = 0.08617333~\\mathrm{meV/K}$。\n2.  初始化一个列表，用于存储 $\\mathbf{Q}$ 路径上每个点的计算强度。\n3.  使用初始化为 $-1$ 的变量 `max_intensity` 和初始化为 `None` 的 `optimal_Q` 来跟踪最佳测量点。\n4.  算法遍历每个给定的散射矢量 $\\mathbf{Q}_i$ 及其对应的声子能量 $E_i$ 和本征矢量 $\\{\\mathbf{e}_{j,i}\\}$。\n5.  对于每个点 $\\mathbf{Q}_i$：\n    a. 计算玻色-爱因斯坦布居因子：$n(E_i, T) = (e^{E_i / (k_B T)} - 1)^{-1}$。我们必须处理 $E_i = 0$ 的情况以避免除以零，尽管所有测试用例都使用正能量。\n    b. 计算声子产生的热力学预因子：$P_i = (n(E_i, T) + 1) / E_i$。\n    c. 计算非弹性结构因子 $G(\\mathbf{Q}_i)$。这是一个复数和：\n       $$ G(\\mathbf{Q}_i) = \\sum_{j} \\frac{b_j}{\\sqrt{M_j}} (\\mathbf{Q}_i \\cdot \\mathbf{e}_{j,i}) (\\cos(\\mathbf{Q}_i \\cdot \\mathbf{r}_j) + i \\sin(\\mathbf{Q}_i \\cdot \\mathbf{r}_j)) $$\n       实部和虚部分别求和，得到 $G(\\mathbf{Q}_i) = \\text{Re}_i + i \\cdot \\text{Im}_i$。\n    d. 结构因子的模平方为 $|G(\\mathbf{Q}_i)|^2 = \\text{Re}_i^2 + \\text{Im}_i^2$。\n    e. 相对强度为 $I_i = P_i \\cdot |G(\\mathbf{Q}_i)|^2$。此值舍入到 $6$ 位小数并存储。\n    f. 为了找到最优 $\\mathbf{Q}$，我们检查当前点是否满足给定的窗口条件：$Q_{\\min} \\le |\\mathbf{Q}_i| \\le Q_{\\max}$ 和 $E_{\\min} \\le E_i \\le E_{\\max}$。如果满足，并且其强度 $I_i$ 大于当前的 `max_intensity`，则将 `max_intensity` 更新为 $I_i$，并将 `optimal_Q` 设置为 $\\mathbf{Q}_i$。\n6.  遍历路径中的所有点后，如果 `optimal_Q` 尚未分配（即没有点满足窗口标准），则根据问题的应急说明，将其设置为路径列表中的第一个 $\\mathbf{Q}$ 矢量。\n7.  测试用例的最终结果是一个包含两个元素的列表：计算出的强度列表和确定的最优 $\\mathbf{Q}$ 矢量（其分量舍入到 $6$ 位小数）。\n8.  对所有测试用例重复此过程，并将结果汇总到一个列表中，然后以指定格式打印。\n\n该方法系统地将推导出的物理公式应用于提供的数据，确保遵守所有约束和输出要求。", "answer": "```python\nimport numpy as np\nimport math\n\n# The problem is self-contained. The following function implements the solution.\ndef solve():\n    \"\"\"\n    Derives and implements the one-phonon inelastic neutron scattering intensity formula.\n    \"\"\"\n\n    # Physical Constants\n    KB_MEV_K = 0.08617333  # Boltzmann constant in meV/K\n\n    # Test cases data structure\n    test_cases = [\n        # Test case 1 (monatomic longitudinal acoustic-like mode)\n        {\n            \"atoms\": [\n                {\"r\": [0.0, 0.0, 0.0], \"b\": 1.0, \"M\": 50.0},\n            ],\n            \"T\": 300.0,\n            \"path\": [\n                {\"Q\": [0.1, 0.0, 0.0]},\n                {\"Q\": [0.2, 0.0, 0.0]},\n                {\"Q\": [0.3, 0.0, 0.0]},\n            ],\n            \"modes\": {\n                \"eigenvectors\": [[1.0, 0.0, 0.0]], # per atom\n                \"energy_func\": lambda Q_vec: 10.0 * np.linalg.norm(Q_vec)\n            },\n            \"windows\": {\"Q_min\": 0.05, \"Q_max\": 0.5, \"E_min\": 0.5, \"E_max\": 5.0}\n        },\n        # Test case 2 (diatomic optical mode with interference)\n        {\n            \"atoms\": [\n                {\"r\": [0.0, 0.0, 0.0], \"b\": 1.0, \"M\": 40.0},\n                {\"r\": [2.0, 0.0, 0.0], \"b\": 1.0, \"M\": 80.0},\n            ],\n            \"T\": 300.0,\n            \"path\": [\n                {\"Q\": [2.0 * np.pi / 4.0, 0.0, 0.0]},\n                {\"Q\": [4.0 * np.pi / 4.0, 0.0, 0.0]},\n                {\"Q\": [6.0 * np.pi / 4.0, 0.0, 0.0]},\n            ],\n            \"modes\": {\n                \"eigenvectors\": [[1.0/np.sqrt(2), 0.0, 0.0], [-1.0/np.sqrt(2), 0.0, 0.0]],\n                \"energy_func\": lambda Q_vec: 30.0\n            },\n            \"windows\": {\"Q_min\": 1.0, \"Q_max\": 5.0, \"E_min\": 20.0, \"E_max\": 40.0}\n        },\n        # Test case 3 (monatomic transverse mode yielding vanishing projection)\n        {\n            \"atoms\": [\n                {\"r\": [0.0, 0.0, 0.0], \"b\": 1.0, \"M\": 50.0},\n            ],\n            \"T\": 300.0,\n            \"path\": [\n                {\"Q\": [0.2, 0.0, 0.0]},\n                {\"Q\": [0.4, 0.0, 0.0]},\n            ],\n            \"modes\": {\n                \"eigenvectors\": [[0.0, 1.0, 0.0]],\n                \"energy_func\": lambda Q_vec: 15.0\n            },\n            \"windows\": {\"Q_min\": 0.1, \"Q_max\": 0.5, \"E_min\": 10.0, \"E_max\": 20.0}\n        },\n        # Test case 4 (temperature dependence, single point)\n        {\n            \"atoms\": [\n                {\"r\": [0.0, 0.0, 0.0], \"b\": 1.0, \"M\": 50.0},\n            ],\n            \"T\": 10.0,\n            \"path\": [\n                {\"Q\": [0.3, 0.3, 0.0]},\n            ],\n            \"modes\": {\n                \"eigenvectors\": [[1.0/np.sqrt(2), 1.0/np.sqrt(2), 0.0]],\n                \"energy_func\": lambda Q_vec: 7.0\n            },\n            \"windows\": {\"Q_min\": 0.1, \"Q_max\": 1.0, \"E_min\": 1.0, \"E_max\": 10.0}\n        },\n    ]\n\n    final_results = []\n\n    for case in test_cases:\n        intensities = []\n        max_intensity = -1.0\n        optimal_Q = None\n        \n        path_Q_vectors = [np.array(p[\"Q\"]) for p in case[\"path\"]]\n\n        for i, Q_vec in enumerate(path_Q_vectors):\n            \n            # 1. Get phonon energy and eigenvectors for this Q\n            E = case[\"modes\"][\"energy_func\"](Q_vec)\n            eigenvectors = [np.array(e) for e in case[\"modes\"][\"eigenvectors\"]]\n\n            # 2. Calculate Bose-Einstein factor and thermal prefactor\n            if E == 0 or case[\"T\"] == 0:\n                n_plus_1_over_E = 0\n            else:\n                # Use np.exp with high precision float to avoid overflow\n                exp_arg = E / (KB_MEV_K * case[\"T\"])\n                if exp_arg > 700: # np.exp(709) is near max float64\n                    n = 0.0\n                else:\n                    n = 1.0 / (np.exp(exp_arg) - 1.0)\n                n_plus_1_over_E = (n + 1.0) / E\n            \n            # 3. Calculate inelastic structure factor G(Q)\n            G_re = 0.0\n            G_im = 0.0\n            \n            for j, atom in enumerate(case[\"atoms\"]):\n                b = atom[\"b\"]\n                M = atom[\"M\"]\n                r_vec = np.array(atom[\"r\"])\n                e_vec = eigenvectors[j]\n\n                Q_dot_e = np.dot(Q_vec, e_vec)\n                Q_dot_r = np.dot(Q_vec, r_vec)\n                \n                term_factor = (b / np.sqrt(M)) * Q_dot_e\n                \n                G_re += term_factor * np.cos(Q_dot_r)\n                G_im += term_factor * np.sin(Q_dot_r)\n\n            # 4. Calculate intensity\n            G_sq_mag = G_re**2 + G_im**2\n            intensity = n_plus_1_over_E * G_sq_mag\n            intensities.append(round(intensity, 6))\n\n            # 5. Check for optimal Q\n            Q_mag = np.linalg.norm(Q_vec)\n            win = case[\"windows\"]\n            \n            is_in_window = (win[\"Q_min\"] = Q_mag = win[\"Q_max\"] and \n                            win[\"E_min\"] = E = win[\"E_max\"])\n\n            if is_in_window:\n                if optimal_Q is None or intensity > max_intensity:\n                    max_intensity = intensity\n                    optimal_Q = Q_vec\n\n        # If no point satisfied the window criteria, use the first Q in the path\n        if optimal_Q is None:\n            optimal_Q = path_Q_vectors[0]\n            \n        optimal_Q_rounded = [round(x, 6) for x in optimal_Q]\n\n        final_results.append([intensities, optimal_Q_rounded])\n\n    # Final print statement in the exact required format\n    # Using repr() to get default float representation and then custom formatting\n    # to avoid trailing zeros and ensure correct list syntax.\n    result_str = str(final_results).replace(\" \", \"\")\n    print(result_str)\n\nsolve()\n```", "id": "2829816"}, {"introduction": "相干弹性散射（布拉格散射）的强度会因德拜-瓦勒因子而减弱，该效应源于原子围绕其晶格平衡位置的振动。有趣的是，即使在绝对零度下，原子由于量子零点运动也并非完全静止，这种纯粹的量子效应同样会导致散射强度的衰减。本练习 [@problem_id:2829816] 深入探讨了德拜-瓦勒因子的量子起源，要求你从基本原理出发，推导零温下的德拜-瓦勒指数，并为一种典型的硬质材料进行数值估算，从而具体展示基础量子力学概念如何在散射实验中体现为可测量的效应。", "problem": "单原子立方晶体表现出弹性布拉格散射，该散射会因Debye–Waller因子而衰减，该因子使弹性散射强度乘以 $\\exp(-2W)$。在一个各向同性的单原子晶体中，该指数定义为 $2W=\\langle(\\mathbf{Q}\\cdot\\mathbf{u})^{2}\\rangle$，其中 $\\mathbf{Q}$ 是散射矢量，$\\mathbf{u}$ 是原子位移算符。在绝对零度时，只有声子的量子零点运动对 $\\langle(\\mathbf{Q}\\cdot\\mathbf{u})^{2}\\rangle$ 有贡献。\n\n从声子的量子化晶格位移场和Bose–Einstein占据数出发，并采用具有单一截止角频率 $\\omega_{D}$（等效于Debye温度 $\\Theta_{D}$，其中 $\\hbar\\omega_{D}=k_{B}\\Theta_{D}$）的Debye模型，推导零温Debye–Waller指数 $2W_{0}$ 的解析表达式，该表达式用 $Q\\equiv|\\mathbf{Q}|$、原子质量 $M$ 和 $\\Theta_{D}$，以及约化普朗克常数 $\\hbar$ 和玻尔兹曼常数 $k_{B}$ 表示。你的推导应明确证明零点运动在 $T=0$ 时会产生一个非零的 $2W_{0}$。\n\n然后，以金刚石为代表性例子，对一种轻元素晶体进行 $2W_{0}$ 的数值计算，其晶格常数 $a=3.567\\,\\text{\\AA}$，原子质量 $M=12\\,\\text{u}$，Debye温度 $\\Theta_{D}=1860\\,\\text{K}$。使用沿 $[111]$ 方向的第一个倒格矢，即 $Q=|\\mathbf{G}_{111}|=(2\\pi/a)\\sqrt{3}$。使用常数 $\\hbar=1.054\\,571\\,817\\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$，$k_{B}=1.380\\,649\\times 10^{-23}\\,\\text{J}\\cdot\\text{K}^{-1}$ 和 $1\\,\\text{u}=1.660\\,539\\,066\\,60\\times 10^{-27}\\,\\text{kg}$。将 $2W_{0}$ 的最终数值表示为一个无量纲数，并将你的答案四舍五入到三位有效数字。", "solution": "该问题要求推导零温Debye–Waller指数 $2W_{0}$，并对金刚石进行数值计算。该问题具有科学依据且提法恰当。我们将着手进行。\n\nDebye–Waller指数 $2W$ 定义为 $2W = \\langle(\\mathbf{Q}\\cdot\\mathbf{u})^{2}\\rangle$，其中 $\\mathbf{Q}$ 是散射矢量，$\\mathbf{u}$ 是原子相对于其平衡格点位置的位移。对于各向同性晶体或对 $\\mathbf{Q}$ 的所有等效方向进行平均的立方晶体，该期望值可以被简化。由于均方位移是各向同性的，$\\langle u_x^2 \\rangle = \\langle u_y^2 \\rangle = \\langle u_z^2 \\rangle = \\frac{1}{3}\\langle \\mathbf{u}^2 \\rangle$。表达式变为：\n$$2W = \\langle (Q_x u_x + Q_y u_y + Q_z u_z)^2 \\rangle$$\n将其展开并利用各向同性，像 $\\langle u_x u_y \\rangle$ 这样的交叉项的平均值为零。这导致：\n$$2W = Q_x^2 \\langle u_x^2 \\rangle + Q_y^2 \\langle u_y^2 \\rangle + Q_z^2 \\langle u_z^2 \\rangle = (Q_x^2 + Q_y^2 + Q_z^2) \\frac{1}{3} \\langle \\mathbf{u}^2 \\rangle = \\frac{1}{3} Q^2 \\langle \\mathbf{u}^2 \\rangle$$\n其中 $Q = |\\mathbf{Q}|$。\n\n在一个含有 $N$ 个质量为 $M$ 的原子的晶体中，位于 $\\mathbf{R}_l$ 处原子的位移算符通过将晶格振动量子化为声子给出：\n$$\\mathbf{u}_l = \\sum_{\\mathbf{k},s} \\sqrt{\\frac{\\hbar}{2NM\\omega_{\\mathbf{k},s}}} \\boldsymbol{\\epsilon}_{\\mathbf{k},s} \\left( a_{\\mathbf{k},s} e^{i\\mathbf{k}\\cdot\\mathbf{R}_l} + a^\\dagger_{\\mathbf{k},s} e^{-i\\mathbf{k}\\cdot\\mathbf{R}_l} \\right)$$\n此处，$\\mathbf{k}$ 是声子波矢，$s$ 是极化指数，$\\omega_{\\mathbf{k},s}$ 是声子角频率，$\\boldsymbol{\\epsilon}_{\\mathbf{k},s}$ 是极化矢量，$a_{\\mathbf{k},s}$ 和 $a^\\dagger_{\\mathbf{k},s}$ 分别是声子的湮灭和产生算符。\n\n我们关心的是单个原子的均方位移，由于平移不变性，它与位置 $l$ 无关。我们可以设 $\\mathbf{R}_l=0$。\n$$\\langle \\mathbf{u}^2 \\rangle = \\langle \\mathbf{u}_0 \\cdot \\mathbf{u}_0 \\rangle = \\left\\langle \\left( \\sum_{\\mathbf{k},s} \\sqrt{\\frac{\\hbar}{2NM\\omega_{\\mathbf{k},s}}} \\boldsymbol{\\epsilon}_{\\mathbf{k},s} (a_{\\mathbf{k},s} + a^\\dagger_{\\mathbf{k},s}) \\right) \\cdot \\left( \\sum_{\\mathbf{k}',s'} \\sqrt{\\frac{\\hbar}{2NM\\omega_{\\mathbf{k}',s'}}} \\boldsymbol{\\epsilon}_{\\mathbf{k}',s'} (a_{\\mathbf{k}',s'} + a^\\dagger_{\\mathbf{k}',s'}) \\right) \\right\\rangle$$\n算符乘积的期望值是已知的：$\\langle a_{\\mathbf{k},s}a_{\\mathbf{k}',s'} \\rangle = \\langle a^\\dagger_{\\mathbf{k},s} a^\\dagger_{\\mathbf{k}',s'} \\rangle = 0$，$\\langle a_{\\mathbf{k},s}a^\\dagger_{\\mathbf{k}',s'} \\rangle = (\\langle n_{\\mathbf{k},s} \\rangle + 1)\\delta_{\\mathbf{k},\\mathbf{k}'}\\delta_{s,s'}$，以及 $\\langle a^\\dagger_{\\mathbf{k},s}a_{\\mathbf{k}',s'} \\rangle = \\langle n_{\\mathbf{k},s} \\rangle \\delta_{\\mathbf{k},\\mathbf{k}'}\\delta_{s,s'}$，其中 $\\langle n_{\\mathbf{k},s} \\rangle$ 是热平均占据数。由于模式 $(\\delta_{\\mathbf{k},\\mathbf{k}'}\\delta_{s,s'})$ 和极化矢量 $(\\boldsymbol{\\epsilon}_{\\mathbf{k},s} \\cdot \\boldsymbol{\\epsilon}_{\\mathbf{k},s'} = \\delta_{s,s'})$ 的正交性，该表达式简化为：\n$$\\langle \\mathbf{u}^2 \\rangle = \\sum_{\\mathbf{k},s} \\frac{\\hbar}{2NM\\omega_{\\mathbf{k},s}} \\langle (a_{\\mathbf{k},s} + a^\\dagger_{\\mathbf{k},s})(a_{\\mathbf{k},s} + a^\\dagger_{\\mathbf{k},s}) \\rangle$$\n$$\\langle \\mathbf{u}^2 \\rangle = \\sum_{\\mathbf{k},s} \\frac{\\hbar}{2NM\\omega_{\\mathbf{k},s}} (2\\langle n_{\\mathbf{k},s} \\rangle + 1)$$\n在绝对零度（$T=0$）时，对于任何有限频率 $\\omega_{\\mathbf{k},s} > 0$，热占据数 $\\langle n_{\\mathbf{k},s} \\rangle = (\\exp(\\hbar\\omega_{\\mathbf{k},s}/k_{B}T) - 1)^{-1}$ 为零。因此 $(2\\langle n_{\\mathbf{k},s} \\rangle + 1)$ 项变为 $1$。这对应于零点量子涨落的贡献。因此，$T=0$ 时的均方位移是非零的：\n$$\\langle \\mathbf{u}^2 \\rangle_{0} = \\sum_{\\mathbf{k},s} \\frac{\\hbar}{2NM\\omega_{\\mathbf{k},s}}$$\n为了计算这个求和，我们采用Debye模型。在此模型中，对离散波矢 $\\mathbf{k}$ 的求和被替换为对连续态密度 $D(\\omega)$ 的积分。对所有 $3N$ 个声子模式的求和为 $\\sum_{\\mathbf{k},s} \\rightarrow \\int_{0}^{\\omega_D} d\\omega \\, D(\\omega)$，其中 $\\omega_D$ 是Debye截止频率。$3N$ 个模式的Debye态密度由下式给出：\n$$D(\\omega) = \\begin{cases} \\frac{9N}{\\omega_D^3}\\omega^2  \\text{for } 0 \\le \\omega \\le \\omega_D \\\\ 0  \\text{for } \\omega > \\omega_D \\end{cases}$$\n将此代入 $\\langle \\mathbf{u}^2 \\rangle_0$ 的表达式中：\n$$\\langle \\mathbf{u}^2 \\rangle_{0} = \\frac{1}{N} \\int_0^{\\omega_D} \\frac{\\hbar}{2M\\omega} D(\\omega) d\\omega = \\frac{1}{N} \\int_0^{\\omega_D} \\frac{\\hbar}{2M\\omega} \\left(\\frac{9N}{\\omega_D^3}\\omega^2\\right) d\\omega$$\n因子 $N$ 被消掉了。\n$$\\langle \\mathbf{u}^2 \\rangle_{0} = \\frac{9\\hbar}{2M\\omega_D^3} \\int_0^{\\omega_D} \\omega \\, d\\omega = \\frac{9\\hbar}{2M\\omega_D^3} \\left[ \\frac{\\omega^2}{2} \\right]_0^{\\omega_D} = \\frac{9\\hbar}{2M\\omega_D^3} \\frac{\\omega_D^2}{2} = \\frac{9\\hbar}{4M\\omega_D}$$\n现在，我们可以求出零温Debye-Waller指数 $2W_0$：\n$$2W_0 = \\frac{1}{3}Q^2 \\langle \\mathbf{u}^2 \\rangle_0 = \\frac{1}{3}Q^2 \\left(\\frac{9\\hbar}{4M\\omega_D}\\right) = \\frac{3Q^2\\hbar}{4M\\omega_D}$$\n题目要求用Debye温度 $\\Theta_D$ 来表示该表达式，其定义为 $\\hbar\\omega_D = k_B\\Theta_D$。代入 $\\omega_D = k_B\\Theta_D/\\hbar$：\n$$2W_0 = \\frac{3Q^2\\hbar}{4M(k_B\\Theta_D/\\hbar)} = \\frac{3Q^2\\hbar^2}{4Mk_B\\Theta_D}$$\n这就是所要求的解析表达式。它显然是非零的，证明了在 $T=0$ 时零点运动的效应。\n\n现在我们对金刚石进行数值计算。给定的参数如下：\n- 晶格常数: $a = 3.567\\,\\text{\\AA} = 3.567 \\times 10^{-10}\\,\\text{m}$\n- 原子质量: $M = 12\\,\\text{u} = 12 \\times 1.660\\,539\\,066\\,60 \\times 10^{-27}\\,\\text{kg} \\approx 1.9926 \\times 10^{-26}\\,\\text{kg}$\n- Debye温度: $\\Theta_D = 1860\\,\\text{K}$\n- 散射矢量大小: $Q = |\\mathbf{G}_{111}| = \\frac{2\\pi}{a}\\sqrt{3}$\n- 约化普朗克常数: $\\hbar = 1.054\\,571\\,817 \\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$\n- 玻尔兹曼常数: $k_B = 1.380\\,649 \\times 10^{-23}\\,\\text{J}\\cdot\\text{K}^{-1}$\n\n首先，我们计算散射矢量大小的平方 $Q^2$：\n$$Q^2 = \\left(\\frac{2\\pi}{a}\\sqrt{3}\\right)^2 = \\frac{12\\pi^2}{a^2} = \\frac{12\\pi^2}{(3.567 \\times 10^{-10}\\,\\text{m})^2} \\approx 9.30945 \\times 10^{20}\\,\\text{m}^{-2}$$\n现在，我们将所有数值代入 $2W_0$ 的表达式中：\n$$2W_0 = \\frac{3 \\hbar^2 Q^2}{4 M k_B \\Theta_D}$$\n$$2W_0 = \\frac{3 \\times (1.05457 \\times 10^{-34}\\,\\text{J}\\cdot\\text{s})^2 \\times (9.30945 \\times 10^{20}\\,\\text{m}^{-2})}{4 \\times (1.99265 \\times 10^{-26}\\,\\text{kg}) \\times (1.38065 \\times 10^{-23}\\,\\text{J}\\cdot\\text{K}^{-1}) \\times (1860\\,\\text{K})}$$\n分子计算结果为：\n$$3 \\times (1.11212 \\times 10^{-68}\\,\\text{J}^2\\cdot\\text{s}^2) \\times (9.30945 \\times 10^{20}\\,\\text{m}^{-2}) \\approx 3.10621 \\times 10^{-47}\\,\\text{J}^2\\cdot\\text{s}^2\\cdot\\text{m}^{-2}$$\n分母计算结果为：\n$$4 \\times (1.99265 \\times 10^{-26}\\,\\text{kg}) \\times (1.38065 \\times 10^{-23}\\,\\text{J}\\cdot\\text{K}^{-1}) \\times (1860\\,\\text{K}) \\approx 2.04690 \\times 10^{-45}\\,\\text{kg}\\cdot\\text{J}$$\n单位是一致的，因为 $(\\text{J}\\cdot\\text{s})^2\\cdot\\text{m}^{-2} / (\\text{kg}\\cdot\\text{J}) = (\\text{kg}\\cdot\\text{m}^2\\cdot\\text{s}^{-2}\\cdot\\text{s})^2\\cdot\\text{m}^{-2} / (\\text{kg}\\cdot\\text{kg}\\cdot\\text{m}^2\\cdot\\text{s}^{-2}) = (\\text{kg}^2\\cdot\\text{m}^2) / (\\text{kg}^2\\cdot\\text{m}^2) = 1$，是无量纲的。\n\n最终值是以下比率：\n$$2W_0 = \\frac{3.10621 \\times 10^{-47}}{2.04690 \\times 10^{-45}} \\approx 0.015175$$\n将结果四舍五入到三位有效数字，我们得到 $0.0152$。", "answer": "$$\\boxed{0.0152}$$", "id": "2829819"}]}