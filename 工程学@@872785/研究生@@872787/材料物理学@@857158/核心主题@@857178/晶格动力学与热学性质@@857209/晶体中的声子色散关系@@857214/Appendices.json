{"hands_on_practices": [{"introduction": "要真正理解声子色散关系，最好的方法是从最简单的模型入手。在此练习中，我们将通过分析一个一维单原子链的振动，并从牛顿第二定律出发，推导出声子频率 $\\omega$ 与波矢 $q$ 之间的关系。这个基础模型虽然简单，但它揭示了晶格振动量子化为声子的核心物理图像，是理解更复杂系统中晶格动力学的基础。[@problem_id:2848415]", "problem": "考虑一个由质量为 $M$ 的相同原子组成的无限长一维单原子布拉菲晶格，晶格常数为 $a$。相邻原子通过劲度系数为 $K$ 的相同、线性、谐振子弹簧耦合，该弹簧仅在最近邻原子之间起作用。假设位移 $u_n(t)$ 偏离平衡位置很小，以至于胡克定律有效。对包含 $N$ 个原子的链施加玻恩-冯·卡门 (BvK) 周期性边界条件，然后在需要时取极限 $N \\to \\infty$。\n\n从牛顿第二定律和最近邻原子间恢复力的胡克定律出发，推导位移 $\\{u_n(t)\\}$ 的线性运动方程。根据这些方程，构建该单原子晶格在倒易空间中的动力学矩阵 $D(q)$，并求解相应的本征值问题，以获得一维晶格第一布里渊区中波矢为 $q$ 的声子角频率 $\\omega(q)$ 的显式解析形式。\n\n所有角量均使用弧度，并将第一布里渊区取为 $q \\in [-\\pi/a,\\pi/a]$。将最终频率 $\\omega(q)$ 表示为以 $K$、$M$、$a$ 和 $q$ 表示的封闭形式解析表达式，单位为弧度/秒。你的最终答案必须是 $\\omega(q)$ 的单个表达式（不包含等号）。无需进行数值计算或四舍五入。", "solution": "题目陈述须经有效性验证。\n\n**步骤 1：提取已知条件**\n- 系统：无限长一维单原子布拉菲晶格。\n- 原子属性：质量 $M$。\n- 晶格几何：晶格常数 $a$。\n- 相互作用：劲度系数为 $K$ 的线性谐振子弹簧，仅作用于最近邻原子之间。\n- 动力学：偏离平衡位置的小位移 $u_n(t)$。\n- 控制定律：牛顿第二定律，胡克定律。\n- 边界条件：对包含 $N$ 个原子的链施加玻恩-冯·卡门 (BvK) 周期性边界条件，并取极限 $N \\to \\infty$。\n- 任务：\n    1. 推导 $\\{u_n(t)\\}$ 的线性运动方程。\n    2. 构建动力学矩阵 $D(q)$。\n    3. 求解本征值问题以求得声子角频率 $\\omega(q)$。\n- 定义域：波矢 $q$ 位于第一布里渊区，$q \\in [-\\frac{\\pi}{a}, \\frac{\\pi}{a}]$。\n- 要求输出格式：以 $K$、$M$、$a$ 和 $q$ 表示的 $\\omega(q)$ 的单个封闭形式解析表达式。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题是固态物理学中的一个典型练习，涉及一维单原子链的晶格动力学。\n- **科学依据：** 该问题基于经典力学的基本原理（牛顿第二定律，胡克定律）和凝聚态物理的标准模型（布拉菲晶格，玻恩-冯·卡门条件）。它是科学合理的。\n- **适定性：** 所有必需的参数（$M$、$K$、$a$）均已提供。目标定义明确，问题结构能够导出一个唯一且有意义的色散关系 $\\omega(q)$ 解。\n- **客观性：** 问题以精确、无歧义的科学语言陈述。\n\n**步骤 3：结论与行动**\n该问题被判定为**有效**。这是固态物理导论中的一个标准、适定的问题。将提供完整解答。\n\n我们首先对一维晶格进行建模。第 $n$ 个原子的平衡位置由 $x_n = na$ 给出，其中 $n$ 是一个整数。设 $u_n(t)$ 为第 $n$ 个原子偏离其平衡位置的位移。该分析假设位移很小，因此胡克定律适用。\n\n作用在第 $n$ 个原子上的力是其最近邻原子（即位置为 $(n-1)$ 和 $(n+1)$ 的原子）对其施加的力的总和。\n位置在 $(n+1)$ 的原子对位置在 $n$ 的原子施加的力，记为 $F_{n \\leftarrow n+1}$，是由连接它们的弹簧的伸长引起的。该弹簧的长度变化为 $(x_{n+1} + u_{n+1}) - (x_n + u_n) - a = (na+a+u_{n+1}) - (na+u_n) - a = u_{n+1} - u_n$。根据胡克定律，这会对原子 $n$ 产生一个恢复力，大小为 $F_{n \\leftarrow n+1} = K(u_{n+1} - u_n)$。\n类似地，位置在 $(n-1)$ 的原子对位置在 $n$ 的原子施加的力是 $F_{n \\leftarrow n-1}$。原子 $n$ 和 $(n-1)$ 之间弹簧的伸长量为 $(x_n+u_n)-(x_{n-1}+u_{n-1})-a = u_n - u_{n-1}$。这会对原子 $n$ 产生一个恢复力，大小为 $F_{n \\leftarrow n-1} = -K(u_n - u_{n-1})$。\n\n作用在第 $n$ 个原子上的总力是这两个力的和：\n$$F_n = F_{n \\leftarrow n+1} + F_{n \\leftarrow n-1} = K(u_{n+1} - u_n) - K(u_n - u_{n-1}) = K(u_{n+1} + u_{n-1} - 2u_n)$$\n根据牛顿第二定律，$F_n = M \\ddot{u}_n$，其中 $\\ddot{u}_n = \\frac{d^2u_n}{dt^2}$。这给出了第 $n$ 个原子的运动方程：\n$$M \\ddot{u}_n(t) = K \\left( u_{n+1}(t) + u_{n-1}(t) - 2u_n(t) \\right)$$\n这就是位移 $u_n(t)$ 的线性运动方程。\n\n由于晶格的平移对称性，我们寻找以下形式的行波解（简正模式）：\n$$u_n(t) = A \\exp[i(q x_n - \\omega t)] = A \\exp[i(qna - \\omega t)]$$\n其中 $A$ 是振幅，$q$ 是波矢，$\\omega$ 是角频率。将此试探解代入运动方程需要以下各项：\n$$ \\ddot{u}_n(t) = (-i\\omega)^2 u_n(t) = -\\omega^2 u_n(t) $$\n$$ u_{n+1}(t) = A \\exp[i(q(n+1)a - \\omega t)] = u_n(t) \\exp(iqa) $$\n$$ u_{n-1}(t) = A \\exp[i(q(n-1)a - \\omega t)] = u_n(t) \\exp(-iqa) $$\n将这些代入运动方程得到：\n$$ M(-\\omega^2) u_n(t) = K \\left( u_n(t)\\exp(iqa) + u_n(t)\\exp(-iqa) - 2u_n(t) \\right) $$\n对于非平凡解（$u_n(t) \\neq 0$），我们可以除以 $u_n(t)$：\n$$ -M\\omega^2 = K (\\exp(iqa) + \\exp(-iqa) - 2) $$\n使用欧拉恒等式 $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$，我们得到：\n$$ -M\\omega^2 = K(2\\cos(qa) - 2) = -2K(1 - \\cos(qa)) $$\n$$ M\\omega^2 = 2K(1 - \\cos(qa)) $$\n这个方程就是声子色散关系。我们可以使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\frac{\\theta}{2})$ 来简化它：\n$$ M\\omega^2(q) = 2K \\left( 2\\sin^2\\left(\\frac{qa}{2}\\right) \\right) = 4K \\sin^2\\left(\\frac{qa}{2}\\right) $$\n该表达式将角频率 $\\omega$ 与波矢 $q$ 联系起来。\n\n该问题还要求构建动力学矩阵 $D(q)$。运动方程的一般矩阵形式是 $M\\omega^2 \\vec{u} = D(q) \\vec{u}$。对于单原子基矢，这变成一个标量方程 $M\\omega^2 = D(q)$。动力学矩阵是原子间力常数 $\\Phi_{nn'}$ 的空间傅里叶变换。运动方程可以写成 $M\\ddot{u}_n = -\\sum_{n'} \\Phi_{nn'} u_{n'}$。从我们推导的运动方程 $M \\ddot{u}_n = K u_{n+1} + K u_{n-1} - 2K u_{n}$ 中，我们可以确定力常数：\n$$ \\Phi_{nn} = 2K $$\n$$ \\Phi_{n, n+1} = -K $$\n$$ \\Phi_{n, n-1} = -K $$\n$$ \\Phi_{nn'} = 0 \\quad \\text{for } |n-n'|  1 $$\n动力学矩阵（在本例中是一个标量）由以下公式给出：\n$$ D(q) = \\sum_{n'} \\Phi_{n, n'} \\exp[iq(x_{n'} - x_n)] $$\n由于平移不变性，该求和与 $n$ 无关。令 $n=0$：\n$$ D(q) = \\sum_{n'} \\Phi_{0, n'} \\exp[iq x_{n'}] = \\Phi_{0,0} + \\Phi_{0,1}\\exp(iqa) + \\Phi_{0,-1}\\exp(-iqa) $$\n$$ D(q) = 2K - K\\exp(iqa) - K\\exp(-iqa) = 2K - K(\\exp(iqa) + \\exp(-iqa)) $$\n$$ D(q) = 2K - 2K\\cos(qa) = 2K(1 - \\cos(qa)) $$\n本征值问题是 $M\\omega^2(q) = D(q)$，这给出：\n$$ M\\omega^2(q) = 2K(1 - \\cos(qa)) = 4K \\sin^2\\left(\\frac{qa}{2}\\right) $$\n这证实了之前获得的结果。\n\n求解 $\\omega(q)$，我们取平方根。由于频率是一个物理上的正量，我们取正根：\n$$ \\omega^2(q) = \\frac{4K}{M} \\sin^2\\left(\\frac{qa}{2}\\right) $$\n$$ \\omega(q) = \\sqrt{\\frac{4K}{M}} \\sqrt{\\sin^2\\left(\\frac{qa}{2}\\right)} = \\sqrt{\\frac{4K}{M}} \\left|\\sin\\left(\\frac{qa}{2}\\right)\\right| $$\n绝对值是必需的，因为波矢 $q$ 属于第一布里渊区，$q \\in [-\\frac{\\pi}{a}, \\frac{\\pi}{a}]$，对于该区间，正弦函数的自变量 $\\frac{qa}{2}$ 的范围是从 $-\\frac{\\pi}{2}$ 到 $\\frac{\\pi}{2}$。在这个区间内，$\\sin(\\frac{qa}{2})$ 可能为负，而 $\\omega$ 必须是非负的。\n\n声子角频率的最终表达式为：\n$$ \\omega(q) = 2\\sqrt{\\frac{K}{M}} \\left|\\sin\\left(\\frac{qa}{2}\\right)\\right| $$\n这是一维单原子链的色散关系。它表明，对于小 $q$（长波长），$\\omega \\approx a\\sqrt{K/M}|q|$，这是声学波特有的线性关系。在布里渊区边界，$q = \\pm \\frac{\\pi}{a}$，频率达到其最大值 $\\omega_{max} = 2\\sqrt{\\frac{K}{M}}$。", "answer": "$$ \\boxed{2\\sqrt{\\frac{K}{M}} \\left|\\sin\\left(\\frac{qa}{2}\\right)\\right|} $$", "id": "2848415"}, {"introduction": "最近邻相互作用模型为我们提供了一个理想化的色散曲线，但在真实的材料中，实验观察到的色散关系常常会偏离这种简单的正弦形状。这个练习旨在展示如何通过引入次近邻相互作用来改进我们的物理模型，以解释在布里渊区边界附近观察到的色散“异常”。通过将理论模型与给定的实验数据相拟合，您将能定量地确定不同距离的原子间相互作用强度的相对大小。[@problem_id:2848436]", "problem": "一个单原子立方晶体在沿[100]晶向探测时，其声学支在波矢接近高对称点 $X$ 处的布里渊区边界时，表现出对仅考虑最近邻谐波相互作用时预期的简单正弦形状的偏离。为了合理解释这一反常现象，考虑一个代表沿 [100] 方向纵向声子的一维单原子链模型，其晶格间距为 $a$，原子质量为 $m$，且包含直至次近邻的谐波相互作用，由力常数 $C_{1}$（最近邻）和 $C_{2}$（次近邻）表征。\n\n仅从牛顿第二定律和第 $n$ 个原子位移的平面波简正模式定义 $u_{n}(t)=u\\,\\exp(i k n a - i \\omega t)$ 出发，推导该链包含 $C_{1}$ 和 $C_{2}$ 时的色散关系 $\\omega(k)$。然后，利用在 $k_{0}=3\\pi/(4a)$ 和 $X=\\pi/a$ 处实验观测到的频率比 $\\omega(k_{0})/\\omega(X)=0.96$，消去未知数 $m$ 和 $C_{1}$，并求解比值 $\\alpha=C_{2}/C_{1}$。\n\n给出最终的 $\\alpha$ 值，四舍五入到 3 位有效数字。最终答案是无量纲的，应以不带单位的纯数形式给出。", "solution": "该问题要求推导包含最近邻和次近邻相互作用的一维单原子链的声子色散关系，然后确定力常数的比值。该问题提法恰当且有科学依据。我们从第一性原理出发进行推导。\n\n设第 $n$ 个原子的平衡位置为 $na$，其中 $a$ 是晶格间距。设 $u_n$ 为第 $n$ 个原子偏离其平衡位置的纵向位移。在谐波近似下，施加在某个原子上的力与它邻近原子的相对位移成线性正比。\n\n第 $n$ 个原子因其位于 $(n-1)a$ 和 $(n+1)a$ 位置的最近邻原子而受到的力由胡克定律给出：\n$F_{n, \\text{nn}} = C_1(u_{n+1} - u_n) + C_1(u_{n-1} - u_n) = C_1(u_{n+1} + u_{n-1} - 2u_n)$，其中 $C_1$ 是最近邻力常数。\n\n第 $n$ 个原子因其位于 $(n-2)a$ 和 $(n+2)a$ 位置的次近邻原子而受到的力为：\n$F_{n, \\text{nnn}} = C_2(u_{n+2} - u_n) + C_2(u_{n-2} - u_n) = C_2(u_{n+2} + u_{n-2} - 2u_n)$，其中 $C_2$ 是次近邻力常数。\n\n第 $n$ 个原子受到的总力 $F_n$ 是这些作用力之和。根据牛顿第二定律，质量为 $m$ 的第 $n$ 个原子的运动方程为 $m \\ddot{u}_n = F_n$：\n$$m \\frac{d^2 u_n}{dt^2} = C_1(u_{n+1} + u_{n-1} - 2u_n) + C_2(u_{n+2} + u_{n-2} - 2u_n)$$\n\n我们寻求问题陈述中给出的形式的平面波解，该解代表了链的简正模式：\n$$u_n(t) = u \\exp(i(kna - \\omega t))$$\n其中 $k$ 是波矢，$\\omega$ 是角频率，$u$ 是振幅。相邻原子的位移通过一个相位因子关联起来：\n$u_{n\\pm p}(t) = u \\exp(i(k(n\\pm p)a - \\omega t)) = u_n(t) \\exp(\\pm ikpa)$。\n时间的二阶导数为 $\\ddot{u}_n = (-i\\omega)^2 u_n = -\\omega^2 u_n$。\n\n将这些代入运动方程：\n$$-\\omega^2 m u_n = C_1(u_n e^{ika} + u_n e^{-ika} - 2u_n) + C_2(u_n e^{i2ka} + u_n e^{-i2ka} - 2u_n)$$\n对于非平庸解（$u_n \\neq 0$），我们可以两边同除以 $u_n$：\n$$-\\omega^2 m = C_1(e^{ika} + e^{-ika} - 2) + C_2(e^{i2ka} + e^{-i2ka} - 2)$$\n使用欧拉恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，我们得到：\n$$-\\omega^2 m = C_1(2\\cos(ka) - 2) + C_2(2\\cos(2ka) - 2)$$\n$$\\omega^2 m = 2C_1(1 - \\cos(ka)) + 2C_2(1 - \\cos(2ka))$$\n利用三角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$：\n$$\\omega^2 m = 2C_1 \\left(2\\sin^2\\left(\\frac{ka}{2}\\right)\\right) + 2C_2 \\left(2\\sin^2\\left(\\frac{2ka}{2}\\right)\\right)$$\n$$\\omega^2 m = 4C_1 \\sin^2\\left(\\frac{ka}{2}\\right) + 4C_2 \\sin^2(ka)$$\n这就给出了色散关系 $\\omega(k)$：\n$$\\omega^2(k) = \\frac{4}{m} \\left(C_1 \\sin^2\\left(\\frac{ka}{2}\\right) + C_2 \\sin^2(ka)\\right)$$\n对频率取正平方根：\n$$\\omega(k) = 2 \\sqrt{\\frac{1}{m} \\left(C_1 \\sin^2\\left(\\frac{ka}{2}\\right) + C_2 \\sin^2(ka)\\right)}$$\n这就完成了问题的第一部分。\n\n接下来，我们必须利用提供的实验数据来确定比值 $\\alpha = C_2/C_1$。让我们用 $\\alpha$ 来重写 $\\omega^2(k)$：\n$$\\omega^2(k) = \\frac{4C_1}{m} \\left(\\sin^2\\left(\\frac{ka}{2}\\right) + \\alpha \\sin^2(ka)\\right)$$\n问题给出了在两个特定波矢处频率的比值：$k_0 = 3\\pi/(4a)$ 和布里渊区边界点 $X$（此处 $k_X = \\pi/a$）。\n\n首先，我们计算在 $k_X = \\pi/a$ 处的 $\\omega^2(k)$：\n$$ka = \\pi \\implies \\frac{ka}{2} = \\frac{\\pi}{2}$$\n$$\\omega^2(X) = \\frac{4C_1}{m} \\left(\\sin^2\\left(\\frac{\\pi}{2}\\right) + \\alpha \\sin^2(\\pi)\\right) = \\frac{4C_1}{m} \\left(1^2 + \\alpha \\cdot 0^2\\right) = \\frac{4C_1}{m}$$\n\n接下来，我们计算在 $k_0 = 3\\pi/(4a)$ 处的 $\\omega^2(k)$：\n$$ka = \\frac{3\\pi}{4} \\implies \\frac{ka}{2} = \\frac{3\\pi}{8}$$\n$$\\omega^2(k_0) = \\frac{4C_1}{m} \\left(\\sin^2\\left(\\frac{3\\pi}{8}\\right) + \\alpha \\sin^2\\left(\\frac{3\\pi}{4}\\right)\\right)$$\n我们使用恒等式 $\\sin^2(\\theta) = (1-\\cos(2\\theta))/2$ 和 $\\sin(3\\pi/4) = \\sqrt{2}/2$：\n$$\\sin^2\\left(\\frac{3\\pi}{8}\\right) = \\frac{1 - \\cos(3\\pi/4)}{2} = \\frac{1 - (-\\sqrt{2}/2)}{2} = \\frac{2+\\sqrt{2}}{4}$$\n$$\\sin^2\\left(\\frac{3\\pi}{4}\\right) = \\left(\\frac{\\sqrt{2}}{2}\\right)^2 = \\frac{2}{4} = \\frac{1}{2}$$\n将这些代入 $\\omega^2(k_0)$ 的表达式中：\n$$\\omega^2(k_0) = \\frac{4C_1}{m} \\left(\\frac{2+\\sqrt{2}}{4} + \\alpha \\frac{1}{2}\\right)$$\n\n现在我们构建比值 $\\omega^2(k_0)/\\omega^2(X)$：\n$$\\frac{\\omega^2(k_0)}{\\omega^2(X)} = \\frac{\\frac{4C_1}{m} \\left(\\frac{2+\\sqrt{2}}{4} + \\frac{\\alpha}{2}\\right)}{\\frac{4C_1}{m}} = \\frac{2+\\sqrt{2}}{4} + \\frac{\\alpha}{2}$$\n问题提供了频率比 $\\omega(k_0)/\\omega(X) = 0.96$。将该值平方得到频率平方的比值：\n$$\\left(\\frac{\\omega(k_0)}{\\omega(X)}\\right)^2 = 0.96^2 = 0.9216$$\n现在我们可以建立一个关于 $\\alpha$ 的方程：\n$$0.9216 = \\frac{2+\\sqrt{2}}{4} + \\frac{\\alpha}{2}$$\n求解 $\\alpha$：\n$$\\frac{\\alpha}{2} = 0.9216 - \\frac{2+\\sqrt{2}}{4}$$\n$$\\alpha = 2 \\left(0.9216 - \\frac{2+\\sqrt{2}}{4}\\right) = 1.8432 - (1 + \\frac{\\sqrt{2}}{2}) = 0.8432 - \\frac{\\sqrt{2}}{2}$$\n为了获得数值，我们使用 $\\sqrt{2} \\approx 1.41421356$：\n$$\\alpha \\approx 0.8432 - \\frac{1.41421356}{2} = 0.8432 - 0.70710678 = 0.13609322$$\n问题要求将该值四舍五入到 3 位有效数字。\n$$\\alpha \\approx 0.136$$\n这个 $\\alpha$ 的正值表明次近邻相互作用也是一种恢复力，这对于稳定的晶格来说在物理上是符合预期的。", "answer": "$$\\boxed{0.136}$$", "id": "2848436"}, {"introduction": "在声子能谱中，一个特别有趣的现象是不同声子分支之间的“反交叉”或“避让交叉”，这标志着模式之间的相互作用。本练习将引导您使用一个简化的 $2 \\times 2$ 矩阵模型来描述两个声子模式的耦合，并从耦合后的色散曲线中提取出模式间的耦合强度。这种方法不仅是理解声子-声子相互作用的关键，也是物理学中用于描述任意两个耦合量子态（如电子能带、光子模式等）的通用范式。[@problem_id:2848464]", "problem": "一个波矢附近的声子分支间的双模避开交叉，可以通过对角化动力学矩阵的一个实对称 $2\\times 2$ 子空间来建模，该子空间捕捉了两个裸色散的相互作用。考虑两个裸（非耦合）声子频率 $\\omega_1(k)$ 和 $\\omega_2(k)$，它们线性依赖于标量波矢 $k$（单位为埃格斯特朗的倒数），以及一个非对角、与 $k$ 无关的实数耦合参数 $g$（单位为太赫兹）。每个 $k$ 处的耦合频率通过对角化一个 $2\\times 2$ 矩阵获得，该矩阵的对角线元素为 $\\omega_1(k)$ 和 $\\omega_2(k)$，非对角线元素为 $g$。从简正模式作为动力学矩阵本征值的基本定义，以及两个相互作用分支的子空间由一个实对称 $2\\times 2$ 矩阵表示这一事实出发，推导出耦合模式频率作为 $k$、$\\omega_1(k)$、$\\omega_2(k)$ 和 $g$ 的函数，然后推导出一个显式策略来反演这些关系，以便从相同 $k$ 值下观测到的耦合频率估计 $g$。您的推导必须从一个实对称 $2\\times 2$ 矩阵的本征值问题开始，并且过程中不假设任何预先推导的光谱公式。\n\n然后您将实现一个程序，该程序：\n- 使用已知的裸色散和已知的真实耦合 $g_{\\mathrm{true}}$（无噪声），通过在一组给定的波矢 $k$ 上对 $2\\times 2$ 模型进行精确对角化，构造合成的“观测”耦合分支。\n- 使用您推导的反演策略，在每个 $k$ 处根据合成观测值和已知的裸色散估计耦合 $g$，并将每个 $k$ 的估计值聚合为每个测试用例的单个标量估计值。\n- 报告每个测试用例的估计 $g$，单位为太赫兹 (THz)，四舍五入到六位小数。\n\n所有频率必须以太赫兹 (THz) 表示，所有波矢以埃格斯特朗的倒数表示。最终输出格式必须是单行，包含所有测试用例的估计耦合值的逗号分隔列表，并用方括号括起来（例如 `\"[0.123456,0.234567,0.345678]\"`）。\n\n使用以下三个测试用例。在每个用例中，裸色散是 $k$ 的线性函数，形式为 $\\omega_1(k)=c_1+v_1\\,(k-k_0)$ 和 $\\omega_2(k)=c_2+v_2\\,(k-k_0)$，具有给定的常数，并且合成观测值是通过在列出的 $k$ 值上对角化相应的带有非对角耦合 $g_{\\mathrm{true}}$ 的 $2\\times 2$ 矩阵生成的。\n\n- 测试用例 1（理想情况，交叉点附近中等耦合且斜率相反）：\n  - 参数：$k_0=1.0$, $c_1=6.0$, $v_1=2.0$, $c_2=6.0$, $v_2=-1.0$, $g_{\\mathrm{true}}=0.30$。\n  - 波矢：$k\\in\\{0.8,\\,0.85,\\,0.9,\\,0.95,\\,1.0,\\,1.05,\\,1.1,\\,1.15,\\,1.2\\}$。\n\n- 测试用例 2（远离 $k=0$ 的交叉点附近的小耦合）：\n  - 参数：$k_0=0.0$, $c_1=5.0$, $v_1=1.5$, $c_2=6.0$, $v_2=-1.0$, $g_{\\mathrm{true}}=0.02$。\n  - 波矢：$k\\in\\{0.2,\\,0.3,\\,0.35,\\,0.4,\\,0.45,\\,0.5,\\,0.6\\}$。\n\n- 测试用例 3（一个平坦模式与一个色散模式相互作用）：\n  - 参数：$k_0=0.0$, $c_1=2.0$, $v_1=4.0$, $c_2=3.5$, $v_2=0.0$, $g_{\\mathrm{true}}=0.15$。\n  - 波矢：$k\\in\\{0.2,\\,0.3,\\,0.35,\\,0.375,\\,0.4,\\,0.45,\\,0.5\\}$。\n\n实现要求：\n- 对于每个测试用例，首先通过精确对角化相应的 $2\\times 2$ 矩阵，在每个 $k$ 处计算合成的观测耦合频率。\n- 然后，仅使用观测到的耦合频率和已知的裸色散，通过您推导的反演公式在每个 $k$ 处计算一个估计值 $\\hat{g}(k)$，并通过对所有 $k$ 取算术平均值，将这些每个 $k$ 的估计值聚合为该测试用例的单个 $\\hat{g}$。\n- 将三个测试用例的最终估计值报告为单行，格式完全如一个 Python 列表，值四舍五入到六位小数，单位为太赫兹 (THz)。\n\n您的程序必须是自包含的，不使用外部输入，并且必须按上述确切格式生成单行输出。", "solution": "该问题陈述已经过严格验证，并被认定为有效。它在科学上是合理的、良定的且客观的。它提出了一个凝聚态物理学中模式相互作用的标准简化模型，并为获得完整且唯一的解提供了所有必要信息。因此，我们将着手进行推导和随后的实现。\n\n该问题要求从一个简化的 $2 \\times 2$ 动力学矩阵推导出耦合声子频率，并随后反演此关系以估计耦合参数。\n\n设两个非耦合（或“裸”）声子分支的频率为 $\\omega_1(k)$ 和 $\\omega_2(k)$，其中 $k$ 是标量波矢。这两个模式之间的相互作用由一个恒定的实数耦合参数 $g$ 描述。系统的行为由以下 $2 \\times 2$ 实对称矩阵的本征值捕获，该矩阵代表了完整动力学矩阵的相关子空间：\n$$\nD(k) = \\begin{pmatrix} \\omega_1(k)  g \\\\ g  \\omega_2(k) \\end{pmatrix}\n$$\n我们表示为 $\\omega$ 的耦合模式频率是该矩阵的本征值。本征值通过求解特征方程 $\\det(D(k) - \\omega I) = 0$ 得到，其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n$$\n\\det \\begin{pmatrix} \\omega_1(k) - \\omega  g \\\\ g  \\omega_2(k) - \\omega \\end{pmatrix} = 0\n$$\n展开行列式得到关于 $\\omega$ 的二次方程：\n$$\n(\\omega_1(k) - \\omega)(\\omega_2(k) - \\omega) - g^2 = 0\n$$\n$$\n\\omega^2 - (\\omega_1(k) + \\omega_2(k))\\omega + (\\omega_1(k)\\omega_2(k) - g^2) = 0\n$$\n应用二次公式 $\\omega = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，其中 $a=1$, $b = -(\\omega_1(k) + \\omega_2(k))$, $c = \\omega_1(k)\\omega_2(k) - g^2$，我们找到 $\\omega$ 的两个解，它们代表上、下耦合分支，记为 $\\omega_+(k)$ 和 $\\omega_-(k)$：\n$$\n\\omega_{\\pm}(k) = \\frac{(\\omega_1(k) + \\omega_2(k)) \\pm \\sqrt{(-(\\omega_1(k) + \\omega_2(k)))^2 - 4(1)(\\omega_1(k)\\omega_2(k) - g^2)}}{2}\n$$\n判别式简化如下：\n$$\n(\\omega_1(k) + \\omega_2(k))^2 - 4\\omega_1(k)\\omega_2(k) + 4g^2 = \\omega_1(k)^2 + 2\\omega_1(k)\\omega_2(k) + \\omega_2(k)^2 - 4\\omega_1(k)\\omega_2(k) + 4g^2\n$$\n$$\n= \\omega_1(k)^2 - 2\\omega_1(k)\\omega_2(k) + \\omega_2(k)^2 + 4g^2 = (\\omega_1(k) - \\omega_2(k))^2 + 4g^2\n$$\n因此，耦合模式的频率为：\n$$\n\\omega_{\\pm}(k) = \\frac{\\omega_1(k) + \\omega_2(k)}{2} \\pm \\frac{\\sqrt{(\\omega_1(k) - \\omega_2(k))^2 + 4g^2}}{2}\n$$\n这些就是所谓的“观测”频率。我们把上观测分支记为 $\\Omega_{upper}(k) \\equiv \\omega_+(k)$，下观测分支记为 $\\Omega_{lower}(k) \\equiv \\omega_-(k)$。\n\n接下来，我们必须推导一个显式策略来反演此关系。目标是根据已知的裸频率 $\\omega_1(k)$ 和 $\\omega_2(k)$ 以及观测到的耦合频率 $\\Omega_{upper}(k)$ 和 $\\Omega_{lower}(k)$ 来确定耦合参数 $g$。\n\n考虑上、下观测频率之差：\n$$\n\\Delta\\Omega(k) = \\Omega_{upper}(k) - \\Omega_{lower}(k) = \\left( \\frac{\\omega_1(k) + \\omega_2(k)}{2} + \\frac{\\sqrt{(\\omega_1(k) - \\omega_2(k))^2 + 4g^2}}{2} \\right) - \\left( \\frac{\\omega_1(k) + \\omega_2(k)}{2} - \\frac{\\sqrt{(\\omega_1(k) - \\omega_2(k))^2 + 4g^2}}{2} \\right)\n$$\n$$\n\\Delta\\Omega(k) = \\sqrt{(\\omega_1(k) - \\omega_2(k))^2 + 4g^2}\n$$\n这个方程为求解 $g$ 提供了一条直接路径。设 $\\Delta\\omega(k) = \\omega_1(k) - \\omega_2(k)$ 为裸频率之差。则：\n$$\n(\\Delta\\Omega(k))^2 = (\\Delta\\omega(k))^2 + 4g^2\n$$\n整理以求解 $g^2$：\n$$\n4g^2 = (\\Delta\\Omega(k))^2 - (\\Delta\\omega(k))^2\n$$\n$$\ng^2 = \\frac{(\\Omega_{upper}(k) - \\Omega_{lower}(k))^2 - (\\omega_1(k) - \\omega_2(k))^2}{4}\n$$\n由于耦合强度 $g$ 按惯例是一个实数、正定参数，我们取正平方根：\n$$\ng = \\frac{1}{2} \\sqrt{(\\Omega_{upper}(k) - \\Omega_{lower}(k))^2 - (\\omega_1(k) - \\omega_2(k))^2}\n$$\n这就是所需的反演公式。对于每个波矢 $k$，它都提供了一个基于该特定 $k$ 处的观测频率和裸频率的估计值 $\\hat{g}(k)$。\n\n计算任务要求实现这一过程。对于每个测试用例：\n1. 我们得到裸色散的函数形式 $\\omega_1(k) = c_1 + v_1(k - k_0)$ 和 $\\omega_2(k) = c_2 + v_2(k - k_0)$，一个真实耦合 $g_{\\mathrm{true}}$，以及一组离散的波矢 $k_i$。\n2. 对于每个 $k_i$，我们首先计算合成的“观测”耦合频率。这是通过使用已知的 $\\omega_1(k_i)$、$\\omega_2(k_i)$ 和 $g_{\\mathrm{true}}$ 构建矩阵 $D(k_i)$，然后计算其本征值来实现的。这些本征值就是我们的 $\\Omega_{upper}(k_i)$ 和 $\\Omega_{lower}(k_i)$。\n3. 利用这些合成数据点，我们接着应用推导出的反演公式来计算一个估计值 $\\hat{g}(k_i)$。\n4. 由于合成数据是从无噪声模型生成的，每个 $\\hat{g}(k_i)$ 在浮点精度范围内都应精确等于 $g_{\\mathrm{true}}$。\n5. 最后，我们通过计算它们的算术平均值 $\\hat{g} = \\frac{1}{N} \\sum_{i=1}^{N} \\hat{g}(k_i)$，将这些每个 $k$ 的估计值聚合为该测试用例的单个值。然后报告这个最终值。\n\n程序将对提供的三个测试用例执行此逻辑，并按规定格式化输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating phonon mode coupling from synthetic data.\n    The process involves:\n    1. Defining the test cases with parameters for bare dispersions and true coupling.\n    2. For each test case, iterating through a set of wavevectors k.\n    3. At each k, generating synthetic \"observed\" coupled frequencies by diagonalizing\n       the 2x2 interaction matrix with the true coupling parameter.\n    4. Using the derived inversion formula to estimate the coupling g from the\n       synthetic data and known bare dispersions.\n    5. Averaging the estimates of g over all k-points for each test case.\n    6. Formatting and printing the final results.\n    \"\"\"\n\n    # Test cases are defined as tuples:\n    # (k0, c1, v1, c2, v2, g_true, k_values_list)\n    test_cases = [\n        # Test case 1\n        (1.0, 6.0, 2.0, 6.0, -1.0, 0.30, \n         [0.8, 0.85, 0.9, 0.95, 1.0, 1.05, 1.1, 1.15, 1.2]),\n        # Test case 2\n        (0.0, 5.0, 1.5, 6.0, -1.0, 0.02, \n         [0.2, 0.3, 0.35, 0.4, 0.45, 0.5, 0.6]),\n        # Test case 3\n        (0.0, 2.0, 4.0, 3.5, 0.0, 0.15,\n         [0.2, 0.3, 0.35, 0.375, 0.4, 0.45, 0.5])\n    ]\n\n    final_results = []\n\n    for case in test_cases:\n        k0, c1, v1, c2, v2, g_true, k_values = case\n        \n        g_estimates_per_k = []\n\n        for k in k_values:\n            # Step 1: Calculate bare frequencies\n            omega1_k = c1 + v1 * (k - k0)\n            omega2_k = c2 + v2 * (k - k0)\n\n            # Step 2: Generate synthetic \"observed\" data\n            # Construct the 2x2 dynamical matrix subspace\n            D_k = np.array([\n                [omega1_k, g_true],\n                [g_true,   omega2_k]\n            ])\n            \n            # Diagonalize to get observed coupled frequencies (eigenvalues)\n            # np.linalg.eigh returns sorted eigenvalues for Hermitian matrices\n            observed_omegas = np.linalg.eigh(D_k)[0]\n            omega_lower_obs = observed_omegas[0]\n            omega_upper_obs = observed_omegas[1]\n\n            # Step 3: Use the inversion formula to estimate g\n            # The formula is g = 0.5 * sqrt((Omega_upper - Omega_lower)^2 - (omega_1 - omega_2)^2)\n            \n            # Difference of observed frequencies, squared\n            delta_omega_obs_sq = (omega_upper_obs - omega_lower_obs)**2\n            \n            # Difference of bare frequencies, squared\n            delta_omega_bare_sq = (omega1_k - omega2_k)**2\n            \n            # Ensure the argument of the square root is non-negative to avoid NaN\n            # due to floating point inaccuracies. In this noise-free case, it\n            # should be mathematically non-negative.\n            term_inside_sqrt = delta_omega_obs_sq - delta_omega_bare_sq\n            if term_inside_sqrt  0:\n                term_inside_sqrt = 0 # Clamp at zero\n            \n            g_estimated = 0.5 * np.sqrt(term_inside_sqrt)\n            \n            g_estimates_per_k.append(g_estimated)\n\n        # Step 4: Aggregate per-k estimates by taking the arithmetic mean\n        final_g_estimate = np.mean(g_estimates_per_k)\n        final_results.append(final_g_estimate)\n\n    # Format the output as a single line: a comma-separated list of values\n    # rounded to six decimals, enclosed in square brackets.\n    formatted_results = [\"{:.6f}\".format(r) for r in final_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2848464"}]}