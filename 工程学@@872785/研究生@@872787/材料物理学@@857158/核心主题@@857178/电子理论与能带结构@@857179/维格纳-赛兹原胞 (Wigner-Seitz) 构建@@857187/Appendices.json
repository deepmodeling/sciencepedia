{"hands_on_practices": [{"introduction": "本练习提供了一个具体的起点，将维格纳-赛兹构造应用于二维三角晶格。通过确定最近邻格点并构造其中垂线，您将从几何上推导出最终的六边形原胞。这项基础实践不仅巩固了维格纳-赛兹原胞的几何定义，也清晰地展示了晶格结构与其对应原胞形状之间的直观联系。[@problem_id:2870601]", "problem": "考虑平面上的一个二维三角布拉菲晶格，其晶格常数 $a$ 定义为晶格点之间的最近邻间距。设原胞基矢为 $\\mathbf{a}_{1} = a\\,(1,0)$ 和 $\\mathbf{a}_{2} = a\\,\\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)$，并在原点处放置一个晶格点。仅使用 Wigner–Seitz 构建法的定义（平面上到原点的距离比到任何其他晶格点的距离都更近的点集），构建围绕原点的 Wigner–Seitz 原胞并确定其多边形形状。然后，计算该 Wigner–Seitz 原胞的面积及其每条边的长度（用 $a$ 表示）。\n\n您必须证明为什么 Wigner–Seitz 原胞的面积等于布拉菲晶格中每个晶格点所占的面积，以及为什么该原胞是一个正多边形。将您的最终结果表示为有序对 $\\left(A,\\,s\\right)$，其中 $A$ 是面积，$s$ 是边长，两者都用 $a$ 的符号表达式写出。无需进行数值四舍五入。不要包含物理单位；将面积和边长直接表示为关于 $a$ 的解析表达式。", "solution": "问题要求构建二维三角布拉菲晶格的 Wigner–Seitz 原胞并研究其性质。我将首先验证问题陈述。\n\n### 步骤1：提取已知条件\n- 晶格类型：二维三角布拉菲晶格。\n- 晶格常数：$a$，定义为最近邻间距。\n- 原胞基矢：$\\mathbf{a}_{1} = a(1,0)$ 和 $\\mathbf{a}_{2} = a\\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)$。\n- 一个晶格点位于原点 $(0,0)$。\n- 任务：构建围绕原点的 Wigner–Seitz 原胞。\n- 任务：确定其多边形形状。\n- 任务：计算其面积 $A$ 和边长 $s$。\n- 任务：证明为什么 Wigner–Seitz 原胞的面积等于每个晶格点所占的面积。\n- 任务：证明为什么该原胞是一个正多边形。\n- 最终结果格式：有序对 $(A, s)$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题有科学依据，提法恰当且客观。它使用了固态物理学中关于三角晶格和 Wigner–Seitz 构建法的标准定义。给定的原胞基矢 $|\\mathbf{a}_{1}| = a$ 和 $|\\mathbf{a}_{2}| = a$，与晶格常数 $a$ 作为最近邻距离的定义是一致的。该问题是自洽的，没有矛盾或歧义。未发现任何缺陷。\n\n### 步骤3：结论与行动\n问题有效。我将继续进行完整解答。\n\n### 解答\n围绕一个晶格点（此处为原点）的 Wigner–Seitz 原胞被定义为空间中到该晶格点的距离比到任何其他晶格点的距离都更近的点的集合。该原胞的边界由连接中心晶格点与所有其他晶格点的向量的垂直平分线构成。原胞本身是这些平分线所围成的最小区域。\n\n首先，我们必须确定原点的最近邻晶格点。一个普遍的晶格点由向量 $\\mathbf{R} = n_{1}\\mathbf{a}_{1} + n_{2}\\mathbf{a}_{2}$ 给出，其中 $n_{1}$ 和 $n_{2}$ 是整数。最近邻是具有最小非零模 $|\\mathbf{R}|$ 的点集。\n给定的原胞基矢是 $\\mathbf{a}_{1} = a(1,0)$ 和 $\\mathbf{a}_{2} = a\\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)$。两者的模都为 $a$。\n让我们找出从原点指向其六个最近邻的向量。它们是：\n$$\n\\begin{aligned}\n\\mathbf{R}_{1} = \\mathbf{a}_{1} = a(1, 0) \\\\\n\\mathbf{R}_{2} = \\mathbf{a}_{2} = a\\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right) \\\\\n\\mathbf{R}_{3} = -\\mathbf{a}_{1} + \\mathbf{a}_{2} = a\\left(-\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right) \\\\\n\\mathbf{R}_{4} = -\\mathbf{a}_{1} = a(-1, 0) \\\\\n\\mathbf{R}_{5} = -\\mathbf{a}_{2} = a\\left(-\\frac{1}{2}, -\\frac{\\sqrt{3}}{2}\\right) \\\\\n\\mathbf{R}_{6} = \\mathbf{a}_{1} - \\mathbf{a}_{2} = a\\left(\\frac{1}{2}, -\\frac{\\sqrt{3}}{2}\\right)\n\\end{aligned}\n$$\n这六个向量的模都为 $a$。没有其他晶格点比它们更靠近原点。这六个向量之间的夹角为 $\\frac{\\pi}{3}$ 弧度或 $60^{\\circ}$，形成一个正六边形。Wigner–Seitz 原胞由这六个向量的垂直平分线界定。\n\n让我们求出这些垂直平分线对应的直线方程。\n$1$. 对于 $\\mathbf{R}_{1} = a(1, 0)$：中点是 $\\left(\\frac{a}{2}, 0\\right)$。平分线是一条垂直线：$x = \\frac{a}{2}$。\n$2$. 对于 $\\mathbf{R}_{4} = a(-1, 0)$：中点是 $\\left(-\\frac{a}{2}, 0\\right)$。平分线是一条垂直线：$x = -\\frac{a}{2}$。\n$3$. 对于 $\\mathbf{R}_{2} = a\\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)$：中点是 $\\left(\\frac{a}{4}, \\frac{a\\sqrt{3}}{4}\\right)$。直线方程由 $\\mathbf{R}_{2} \\cdot \\left(\\mathbf{r} - \\frac{\\mathbf{R}_{2}}{2}\\right) = 0$ 给出，其中 $\\mathbf{r}=(x,y)$。这可以简化为 $\\mathbf{R}_{2} \\cdot \\mathbf{r} = \\frac{|\\mathbf{R}_{2}|^2}{2}$。\n$$\na\\left(\\frac{1}{2}\\right)x + a\\left(\\frac{\\sqrt{3}}{2}\\right)y = \\frac{a^2}{2} \\implies x + \\sqrt{3}y = a\n$$\n$4$. 对于 $\\mathbf{R}_{3} = a\\left(-\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)$：类似地，$-\\frac{1}{2}x + \\frac{\\sqrt{3}}{2}y = \\frac{a}{2} \\implies -x + \\sqrt{3}y = a$。\n$5$. 对于 $\\mathbf{R}_{5} = a\\left(-\\frac{1}{2}, -\\frac{\\sqrt{3}}{2}\\right)$：类似地，$-\\frac{1}{2}x - \\frac{\\sqrt{3}}{2}y = \\frac{a}{2} \\implies -x - \\sqrt{3}y = a$。\n$6$. 对于 $\\mathbf{R}_{6} = a\\left(\\frac{1}{2}, -\\frac{\\sqrt{3}}{2}\\right)$：类似地，$\\frac{1}{2}x - \\frac{\\sqrt{3}}{2}y = \\frac{a}{2} \\implies x - \\sqrt{3}y = a$。\n\nWigner–Seitz 原胞是由这六条直线围成的区域。其形状是一个六边形。为了确定它是否为正六边形，我们求出其顶点并计算边长。\n顶点是相邻直线的交点。让我们通过联立 $x = \\frac{a}{2}$ 和 $x + \\sqrt{3}y = a$ 来找到一个顶点：\n$$\n\\frac{a}{2} + \\sqrt{3}y = a \\implies \\sqrt{3}y = \\frac{a}{2} \\implies y = \\frac{a}{2\\sqrt{3}}\n$$\n所以，一个顶点是 $V_{1} = \\left(\\frac{a}{2}, \\frac{a}{2\\sqrt{3}}\\right)$。\n让我们通过联立 $x + \\sqrt{3}y = a$ 和 $-x + \\sqrt{3}y = a$ 来找到下一个顶点：\n将这两个方程相加得到 $2\\sqrt{3}y = 2a \\implies y = \\frac{a}{\\sqrt{3}}$。将此结果代回，得到 $x + \\sqrt{3}\\left(\\frac{a}{\\sqrt{3}}\\right) = a \\implies x+a=a \\implies x=0$。\n所以，第二个顶点是 $V_{2} = \\left(0, \\frac{a}{\\sqrt{3}}\\right)$。\n\n连接 $V_{1}$ 和 $V_{2}$ 的边长 $s$ 为：\n$$\ns = \\sqrt{\\left(\\frac{a}{2}-0\\right)^2 + \\left(\\frac{a}{2\\sqrt{3}} - \\frac{a}{\\sqrt{3}}\\right)^2} = \\sqrt{\\left(\\frac{a}{2}\\right)^2 + \\left(-\\frac{a}{2\\sqrt{3}}\\right)^2} = \\sqrt{\\frac{a^2}{4} + \\frac{a^2}{12}} = \\sqrt{\\frac{3a^2+a^2}{12}} = \\sqrt{\\frac{4a^2}{12}} = \\sqrt{\\frac{a^2}{3}}\n$$\n因此，边长为 $s = \\frac{a}{\\sqrt{3}} = \\frac{a\\sqrt{3}}{3}$。\n\n三角晶格围绕任何晶格点都具有六重旋转对称性（$C_6$）。最近邻向量集也表现出这种对称性。Wigner–Seitz 构建法基于这些向量，因此也必须保持这种对称性。因此，所得的六边形必须是正六边形：所有六条边的长度都相同，为 $s = a/\\sqrt{3}$，所有内角都等于 $120^\\circ$。\n\n接下来，我们计算这个正六边形的面积 $A$。一个边长为 $s$ 的正六边形可以分解为6个边长为 $s$ 的等边三角形。一个这样的等边三角形的面积是 $\\frac{\\sqrt{3}}{4}s^2$。\n总面积 $A$ 是：\n$$\nA = 6 \\times \\frac{\\sqrt{3}}{4}s^2 = \\frac{3\\sqrt{3}}{2}s^2\n$$\n代入 $s = \\frac{a}{\\sqrt{3}}$:\n$$\nA = \\frac{3\\sqrt{3}}{2}\\left(\\frac{a}{\\sqrt{3}}\\right)^2 = \\frac{3\\sqrt{3}}{2} \\frac{a^2}{3} = \\frac{\\sqrt{3}}{2}a^2\n$$\n\n最后，我们必须证明为什么这个面积等于每个晶格点所占的面积。Wigner–Seitz 原胞是布拉菲晶格的一个原胞。原胞是一个最小体积（在二维中是最小面积）的单元，当通过所有晶格向量平移时，它能无重叠、无间隙地铺满整个空间。根据这个定义，一个原胞恰好包含一个晶格点。因此，每个晶格点所占的面积就是任何一个原胞的面积。\n我们可以通过计算由原胞基矢 $\\mathbf{a}_{1}$ 和 $\\mathbf{a}_{2}$ 张成的平行四边形所定义的原胞面积来验证这一点。这个面积由这些向量构成的矩阵的行列式的绝对值给出：\n$$\nA_{\\text{primitive}} = \\left| \\det \\begin{pmatrix} a & \\frac{a}{2} \\\\ 0 & \\frac{a\\sqrt{3}}{2} \\end{pmatrix} \\right| = \\left| a \\cdot \\frac{a\\sqrt{3}}{2} - 0 \\cdot \\frac{a}{2} \\right| = \\frac{\\sqrt{3}}{2}a^2\n$$\n这个面积与我们计算出的 Wigner–Seitz 原胞的面积 $A$ 完全相同。这证实了我们计算的有效性，并表明 Wigner–Seitz 原胞确实是三角晶格的一个原胞。\n\n问题要求有序对 $(A, s)$。\n$$\nA = \\frac{\\sqrt{3}}{2}a^2\n$$\n$$\ns = \\frac{a}{\\sqrt{3}}\n$$\n最终结果是 $\\left(\\frac{\\sqrt{3}}{2}a^2, \\frac{a}{\\sqrt{3}}\\right)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\sqrt{3}}{2}a^2 & \\frac{a}{\\sqrt{3}}\n\\end{pmatrix}\n}\n$$", "id": "2870601"}, {"introduction": "进入三维空间，本问题探讨了一个更细致的场景：体心四方（BCT）晶格。您将研究维格纳-赛兹原胞的拓扑结构如何随晶格的轴比 $c/a$ 变化。这项练习至关重要，它揭示了原胞的形状并非一成不变，并通过确定其维格纳-赛兹原胞在何种条件下变得与BCC和FCC晶格的原胞在组合上等价，从而揭示了BCT、BCC和FCC晶格之间深刻的结构关联。[@problem_id:2870593]", "problem": "一个体心四方 (BCT) 布拉维晶格由一个常规四方晶胞定义，其边长为 $a$、$a$ 和 $c$，定心矢量为 $(a/2, a/2, c/2)$。维格纳-赛兹 (WS) 原胞定义为实空间中比任何其他晶格点更靠近原点晶格点的点的集合。\n\n仅使用 WS 原胞的构造定义和欧几里得几何，考虑由比率 $t = c/a > 0$ 参数化的 BCT 晶格族。令 $\\{\\mathbf{R}\\}$ 表示从原点出发的所有非零晶格矢量的集合。WS 原胞是由垂直于 $\\{\\mathbf{R}\\}$ 中矢量的平分面所界定的半空间的交集。\n\n1. 识别出其垂直平分面可以构成 WS 原胞边界面的最短晶格矢量，并用 $a$ 和 $c$ 表示它们的长度。\n2. 通过比较这些距离，确定四方性参数 $t = c/a$ 的值，在这些值下，BCT 晶格的实空间 WS 原胞在组合上与以下晶格的 WS 原胞等价（即具有相同的面数和邻接图）：\n   - 体心立方 (BCC) 晶格，以及\n   - 面心立方 (FCC) 晶格。\n3. 以有序对 $(t_{\\mathrm{BCC}}, t_{\\mathrm{FCC}})$ 的形式报告您的最终结果，其中 $t_{\\mathrm{BCC}}$ 和 $t_{\\mathrm{FCC}}$ 分别是 BCT WS 原胞与 BCC 和 FCC WS 原胞共享拓扑结构时的 $c/a$ 值。\n\n将最终答案表示为包含 $t_{\\mathrm{BCC}}$ 和 $t_{\\mathrm{FCC}}$ 的行矩阵。无需四舍五入。答案是无量纲的。", "solution": "该问题要求确定体心四方 (BCT) 晶格的四方性参数 $t = c/a$ 的特定值，在这些值下，其维格纳-赛兹 (WS) 原胞在组合上与体心立方 (BCC) 和面心立方 (FCC) 晶格的 WS 原胞等价。\n\n首先，我们必须确定 BCT 晶格的晶格矢量。一个常规晶胞边长为 $a$、$a$ 和 $c$ 的 BCT 晶格，其晶格点的位置 $\\mathbf{R}$ 的坐标 $(x,y,z)$ 满足条件：$x/a$、$y/a$ 和 $z/c$ 要么全是整数，要么全是半整数。WS 原胞由从原点出发的晶格矢量 $\\mathbf{R}$ 的垂直平分面集合构成。WS 原胞的面由这些平面中未被其他平面冗余化的子集确定。这意味着我们必须识别出最短的晶格矢量。\n\n让我们找出最短非零晶格矢量的长度平方 $|\\mathbf{R}|^2$。一个矢量 $\\mathbf{R}$ 可以写成 $(ia, ja, kc)$，其中 $(i,j,k)$ 要么是全为整数（不全为零），要么是全为半整数。其长度平方为 $|\\mathbf{R}|^2 = a^2(i^2+j^2) + c^2k^2 = a^2(i^2+j^2+t^2k^2)$，其中 $t=c/a$。\n\n通过考虑 $i,j,k$ 的小数值，我们识别出三族短晶格矢量：\n1.  A 族：两个矢量 $(\\_0, \\_0, \\pm c)$，对应于 $(i,j,k)=(0,0,\\pm 1)$。其长度平方为 $d_A^2 = c^2 = a^2 t^2$。\n2.  B 族：四个矢量 $(\\pm a, \\_0, \\_0)$ 和 $(0, \\pm a, \\_0)$，对应于 $(i,j,k)=(\\pm 1, 0, 0)$ 和 $(0, \\pm 1, 0)$。其长度平方为 $d_B^2 = a^2$。\n3.  C 族：八个矢量 $(\\pm a/2, \\pm a/2, \\pm c/2)$，对应于 $(i,j,k)=(\\pm 1/2, \\pm 1/2, \\pm 1/2)$。其长度平方为 $d_C^2 = (a/2)^2 + (a/2)^2 + (c/2)^2 = a^2/2 + c^2/4 = a^2(1/2 + t^2/4)$。\n\n其他矢量，例如长度平方为 $2a^2$ 的 $(\\pm a, \\pm a, 0)$，显然更长，通常不会定义 WS 原胞的主要面。WS 原胞的形状由这三族矢量的平分面之间的相互作用决定。\n\n矢量 $\\mathbf{R}$ 的平分面由方程 $\\mathbf{x} \\cdot \\mathbf{R} = |\\mathbf{R}|^2/2$ 给出。当定义面的矢量集合发生变化时，WS 原胞的面数及其组合类型也随之改变。如果一个矢量 $\\mathbf{R}$ 的平分面未被其他平面的交线截断，则该矢量对 WS 原胞贡献一个面。详细分析表明，当点 $\\mathbf{R}_k/2$ 不再是 WS 原胞边界上的点时（这发生于该点恰好位于另一个矢量 $\\mathbf{R}_j$ 的平分面上时），与矢量 $\\mathbf{R}_k$ 相关的面就会消失。\n\n让我们分析一下每一族矢量产生面存在的条件。\n-   我们发现，对于所有 $t>0$ 的值，来自 B 族（例如，由 $\\mathbf{R}=(a,0,0)$ 产生的平面 $x=a/2$）和 C 族的面都存在。这提供了至少 $4+8=12$ 个面。\n-   对于 A 族，考虑矢量 $\\mathbf{R}_A=(0,0,c)$。其平分面为 $z=c/2$。如果点 $\\mathbf{R}_A/2 = (0,0,c/2)$ 没有被截断，这个平面就会生成一个面。与之竞争最近的平面是来自 C 族的平面。对于矢量 $\\mathbf{R}_C = (a/2,a/2,c/2)$，如果 $2(\\mathbf{R}_A/2) \\cdot \\mathbf{R}_C = |\\mathbf{R}_C|^2$，则点 $\\mathbf{R}_A/2$ 位于其平分面上。\n    $2(0,0,c/2) \\cdot (a/2,a/2,c/2) = c^2/2$。\n    $|\\mathbf{R}_C|^2 = a^2/2 + c^2/4$。\n    对于所有与之竞争的 $\\mathbf{R}_C$，如果 $2(\\mathbf{R}_A/2) \\cdot \\mathbf{R}_C  |\\mathbf{R}_C|^2$ 成立，则来自 $\\mathbf{R}_A$ 的面存在，这里我们检查最严格的情况。如果 $c^2/2  a^2/2 + c^2/4$，则面存在。这可以简化为 $c^2/4  a^2/2$，即 $c^2  2a^2$，或 $t^2  2$。\n\n因此，WS 原胞的组合结构对 $t$ 的依赖性如下：\n-   如果 $t  \\sqrt{2}$，WS 原胞由所有三族矢量产生的平面界定，共有 $2 (\\text{A}) + 4 (\\text{B}) + 8 (\\text{C}) = 14$ 个面。这个多面体是一个四方畸变的截角八面体。\n-   如果 $t = \\sqrt{2}$，该条件变为等式。来自 A 族的两个面收缩成为 WS 原胞上的顶点。最终的原胞有 $12$ 个面。\n-   如果 $t > \\sqrt{2}$，来自 A 族的面被完全截断。原胞有 $12$ 个面，是一个四方畸变的菱形十二面体。\n\n现在我们将这些结构与 BCC 和 FCC 的 WS 原胞进行匹配。\n1.  **BCC 晶格：** BCC 晶格的 WS 原胞是一个正截角八面体，它有 $14$ 个面（6 个来自次近邻的方形面和 8 个来自最近邻的六边形面）。这种组合类型对应于 $t  \\sqrt{2}$ 的 BCT 情况。问题要求一个特定的 $t$ 值。当 BCT 晶格的常规晶胞为立方体时，即 $c=a$（意味着 $t=c/a=1$），它就变成了 BCC 晶格。在 $t=1$ 时，BCT 的 WS 原胞是一个正截角八面体。因此，$t_{\\mathrm{BCC}} = 1$。\n\n2.  **FCC 晶格：** FCC 晶格的 WS 原胞是一个正菱形十二面体，它有 $12$ 个面。这种组合类型对应于 $t \\ge \\sqrt{2}$ 的 BCT 情况。在特定条件下，BCT 晶格在结构上等同于 FCC 晶格。通过将坐标系绕 $z$ 轴旋转 $45^\\circ$ 可以证明，当 $c/a = \\sqrt{2}$ 时，BCT 晶格与 FCC 晶格完全相同。在 $t = \\sqrt{2}$ 时，我们的分析表明 BCT 的 WS 原胞转变为一个具有 12 个面的多面体，即一个正菱形十二面体。对于 $t>\\sqrt{2}$ 的情况，它发生畸变但组合上是等价的。BCT 晶格本身*是*一个 FCC 晶格的特定值是 $t=\\sqrt{2}$。因此，$t_{\\mathrm{FCC}} = \\sqrt{2}$。\n\n最终结果是有序对 $(t_{\\mathrm{BCC}}, t_{\\mathrm{FCC}})$。", "answer": "$$\\boxed{\\begin{pmatrix} 1 & \\sqrt{2} \\end{pmatrix}}$$", "id": "2870593"}, {"introduction": "这最后一个练习旨在连接几何理论与现代计算材料科学。对于任意或复杂的晶格，手动构建维格纳-赛兹原胞是不可行的。本练习要求您将维格纳-赛兹原胞的基本定义转化为一个通用的计算算法，利用半空间交集的概念，为任意正交晶格编写程序来构建其原胞，从而掌握一种强大且可推广的材料分析工具。[@problem_id:2870633]", "problem": "给定一个三维欧几里得空间中的简单正交布拉维晶格。该晶格由三个与坐标轴对齐且相互正交的原胞基矢生成，其大小分别表示为 $a$、$b$ 和 $c$。晶格点的位置为 $\\mathbf{R}(u,v,w) = u\\,a\\,\\hat{\\mathbf{x}} + v\\,b\\,\\hat{\\mathbf{y}} + w\\,c\\,\\hat{\\mathbf{z}}$，其中 $u$、$v$ 和 $w$ 为整数。Wigner–Seitz 原胞是空间中所有点的集合，这些点到原点的距离比到任何其他晶格点的距离更近（或相等）。\n\n从 Wigner–Seitz 原胞作为欧几里得空间中 Voronoi 区域的基本定义出发，仅使用欧几里得度量和晶格结构，推导出定义以原点为中心的 Wigner–Seitz 原胞的半空间不等式的数学形式。仅使用以下基本依据：\n- 欧几里得空间中的距离定义，$d(\\mathbf{x},\\mathbf{y}) = \\|\\mathbf{x}-\\mathbf{y}\\|_{2}$。\n- 由原胞基矢生成的布拉维晶格的定义。\n- 根据法向量和偏移量对超平面的线性代数表征。\n\n根据您的推导，构建一个算法，该算法能够：\n- 枚举由原点与一组有限的最短非零晶格矢量 $\\{\\mathbf{R}_i\\}$ 之间的垂直平分面所构成的候选平面集（您不能先验地假设哪些平面最终会成为边界平面）。\n- 对相关联的半空间求交集，生成一个凸多面体，当候选集足够丰富时，该多面体即为 Wigner–Seitz 原胞。\n- 通过检查哪些候选平面是“有效”的，来通过算法剪除冗余平面。所谓“有效”，是指在数值容差范围内，至少有一个多面体的顶点位于该平面上。\n\n您的程序必须实现上述算法，仅使用晶格定义来计算由 $(a,b,c)$ 指定的正交晶格的 Wigner–Seitz 多面体。候选平面集必须从最短的非零晶格矢量壳层构建，通过按长度递增自动选择，直到至少包含前三个不同长度的壳层。为使问题具有通用性并纯粹基于算法，您不能硬编码原胞的最终形状；相反，您必须通过半空间求交从第一性原理计算它。\n\n对于下面指定的每个测试用例，计算 Wigner–Seitz 原胞的顶点列表，这些顶点是交集多面体的唯一极点，按 $(x,y,z)$ 的字典序排序，每个坐标四舍五入到恰好六位小数。每个测试用例的输出必须是一个三元组 $[x,y,z]$ 的列表。您的程序应将所有测试用例的结果汇总为单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[result_1,result_2,result_3]$），其中每个 $result_i$ 本身是第 $i$ 个测试用例的顶点三元组列表。\n\n测试套件：\n- 用例 1：$(a,b,c) = (2.3,1.7,3.1)$。\n- 用例 2：$(a,b,c) = (1.0,1.0,1.0)$。\n- 用例 3：$(a,b,c) = (0.5,2.0,3.0)$。\n\n您的程序必须按照上述格式生成最终的单行输出，不含任何附加文本。不涉及物理单位。如果在您的推导中出现任何角度，按惯例均以弧度为单位，但程序不应输出角度。", "solution": "所述问题是有效的。这是一个计算材料物理学中的适定问题，它基于已确立的科学原理，并以无歧义的数学术语表述。该问题要求从第一性原理出发，为简单正交晶格构建一个 Wigner-Seitz 原胞。\n\n解决方案分两个阶段进行。首先，从 Wigner-Seitz 原胞的基本定义推导出其数学表述。其次，基于此表述构建一个计算算法，以确定给定晶格参数下原胞的顶点。\n\n一个以原点（一个晶格点）为中心的 Wigner-Seitz 原胞，定义为空间中点 $\\mathbf{x}$ 的集合，这些点到原点的距离比到任何其他晶格点 $\\mathbf{R}$ 的距离更近。这由以下不等式组表示：\n$$\nd(\\mathbf{x}, \\mathbf{0}) \\le d(\\mathbf{x}, \\mathbf{R}) \\quad \\forall \\mathbf{R} \\in \\text{Lattice}, \\mathbf{R} \\neq \\mathbf{0}\n$$\n其中 $d(\\mathbf{x}, \\mathbf{y})$ 是欧几里得距离 $\\|\\mathbf{x} - \\mathbf{y}\\|$。对两边进行平方（对于非负距离而言，这是一个单调运算），可得：\n$$\n\\|\\mathbf{x}\\|^2 \\le \\|\\mathbf{x} - \\mathbf{R}\\|^2\n$$\n使用点积 $\\|\\mathbf{v}\\|^2 = \\mathbf{v} \\cdot \\mathbf{v}$ 展开右侧：\n$$\n\\mathbf{x} \\cdot \\mathbf{x} \\le (\\mathbf{x} - \\mathbf{R}) \\cdot (\\mathbf{x} - \\mathbf{R}) = \\mathbf{x} \\cdot \\mathbf{x} - 2\\mathbf{x} \\cdot \\mathbf{R} + \\mathbf{R} \\cdot \\mathbf{R}\n$$\n消去 $\\mathbf{x} \\cdot \\mathbf{x}$ 项并重新整理，得到由晶格矢量 $\\mathbf{R}$ 定义的单个半空间的不等式：\n$$\n2\\mathbf{x} \\cdot \\mathbf{R} \\le \\mathbf{R} \\cdot \\mathbf{R} = \\|\\mathbf{R}\\|^2\n$$\n$$\n\\mathbf{x} \\cdot \\mathbf{R} \\le \\frac{1}{2}\\|\\mathbf{R}\\|^2\n$$\n该不等式描述了一个闭半空间，其边界为平面 $\\mathbf{x} \\cdot \\mathbf{R} = \\frac{1}{2}\\|\\mathbf{R}\\|^2$。该平面是连接原点与晶格点 $\\mathbf{R}$ 的线段的垂直平分面。Wigner-Seitz 原胞是所有非零晶格矢量 $\\mathbf{R}$ 对应的所有此类半空间的交集。\n\n对于指定的简单正交晶格，晶格矢量由 $\\mathbf{R}(u,v,w) = u\\,a\\,\\hat{\\mathbf{x}} + v\\,b\\,\\hat{\\mathbf{y}} + w\\,c\\,\\hat{\\mathbf{z}}$ 给出，其中 $u,v,w$ 为整数。对这样一个矢量，其半空间不等式为：\n$$\nx(ua) + y(vb) + z(wc) \\le \\frac{1}{2} \\left( (ua)^2 + (vb)^2 + (wc)^2 \\right)\n$$\n尽管存在无穷多个这样的不等式，但通常只需要那些对应于最近邻晶格点的不等式即可定义该原胞。问题要求一个通用算法，该算法不预先假定哪些矢量是相关的。该算法如下：\n\n1.  **生成候选平面集**：通过考虑有限范围内的整数组合 $(u,v,w)$（例如 $u,v,w \\in \\{-2, -1, 0, 1, 2\\}$，不包括 $(0,0,0)$）来生成一个有限的候选晶格矢量集。对每个矢量 $\\mathbf{R}$，计算其长度的平方 $\\|\\mathbf{R}\\|^2 = (ua)^2 + (vb)^2 + (wc)^2$。对这些长度的平方进行排序，以识别不同的长度壳层。根据问题规范，选择所有对应于至少三个最短的不同长度壳层的晶格矢量。对每个选定的矢量 $\\mathbf{R}_i$，我们构建半空间不等式 $\\mathbf{R}_i \\cdot \\mathbf{x} - \\frac{1}{2}\\|\\mathbf{R}_i\\|^2 \\le 0$。注意，对于集合中的每个矢量 $\\mathbf{R}_i$，其负矢量 $-\\mathbf{R}_i$ 也存在，它在相对侧定义了一个边界半空间，从而确保生成的多面体是封闭的。\n\n2.  **通过半空间求交计算多面体**：Wigner-Seitz 原胞是所有候选半空间交集所形成的凸多面体。这是计算几何学中的一个标准问题。给定一组 $N$ 个形式为 $\\mathbf{n}_i \\cdot \\mathbf{x} + k_i \\le 0$ 的半空间，任务是找到其交集的顶点。我们将使用 `scipy.spatial.HalfspaceIntersection` 库函数，它是鲁棒的 Qhull 库的一个接口。该函数需要半空间集合以及一个已知位于交集内部的点。对于 Wigner-Seitz 原胞，原点 $\\mathbf{x} = (0,0,0)$ 始终是一个内点。该函数计算交集多面体的顶点，并自动处理冗余平面（即那些不构成最终多面体表面的平面）。\n\n3.  **处理和格式化顶点**：计算出的顶点是多面体的唯一极点。为了得到确定性的输出，必须对这些顶点进行排序。问题指定了基于 $(x,y,z)$ 坐标的字典序排序。最后，每个顶点的每个坐标都被格式化为恰好六位小数的浮点数。\n\n对于一个简单正交晶格，最短的非零晶格矢量总是 $(\\pm a, 0, 0)$、$(0, \\pm b, 0)$ 和 $(0, 0, \\pm c)$，前提是 $a, b, c$ 之间的关系不会使得像 $(a, b, 0)$ 这样的矢量比例如 $(0,0,c)$ 更短。与这六个矢量对应的半空间是 $x \\le a/2$、$-x \\le a/2$、$y \\le b/2$、$-y \\le b/2$、$z \\le c/2$ 和 $-z \\le c/2$。这些半空间的交集是由 $|x| \\le a/2$、$|y| \\le b/2$、$|z| \\le c/2$ 定义的长方体。这个长方体的顶点是 8 个点 $(\\pm a/2, \\pm b/2, \\pm c/2)$。任何由更长晶格矢量派生出的其他平面都将被求交算法正确地识别为冗余，因为它们不会进一步约束此体积。我们的通用算法将为每个测试用例系统地得出这个结果。", "answer": "```python\nimport numpy as np\nfrom scipy.spatial import HalfspaceIntersection\n\ndef solve_case(a, b, c):\n    \"\"\"\n    Computes the vertices of the Wigner-Seitz cell for a primitive orthorhombic lattice.\n\n    Args:\n        a, b, c (float): Magnitudes of the orthogonal primitive lattice vectors.\n\n    Returns:\n        list: A list of vertex coordinate tuples, sorted lexicographically.\n    \"\"\"\n    # Step 1: Generate a candidate set of lattice vectors.\n    # A search range of u,v,w in {-2, ..., 2} is sufficient to capture the\n    # first few shells of nearest neighbors for typical lattices.\n    vectors = []\n    # Use integer indices to generate lattice vectors R = u*a*x_hat + v*b*y_hat + w*c*z_hat\n    for u in range(-2, 3):\n        for v in range(-2, 3):\n            for w in range(-2, 3):\n                if u == 0 and v == 0 and w == 0:\n                    continue\n                vectors.append(np.array([u * a, v * b, w * c]))\n\n    # Step 2: Identify vectors from the first three distinct length shells.\n    tol = 1e-9\n    \n    # Use a dictionary to group vectors by their squared length.\n    length_map = {}\n    for vec in vectors:\n        sq_len = np.dot(vec, vec)\n        found_key = False\n        for key in length_map:\n            if abs(key - sq_len)  tol:\n                length_map[key].append(vec)\n                found_key = True\n                break\n        if not found_key:\n            length_map[sq_len] = [vec]\n\n    # Get the unique squared lengths and sort them.\n    unique_sorted_sq_lengths = sorted(length_map.keys())\n\n    # Select vectors from at least the first three shells.\n    num_shells = min(len(unique_sorted_sq_lengths), 3)\n    shortest_sq_lengths = unique_sorted_sq_lengths[:num_shells]\n    \n    candidate_vectors = []\n    for sq_len in shortest_sq_lengths:\n        candidate_vectors.extend(length_map[sq_len])\n\n    # Step 3: Form half-space inequalities for scipy.\n    # The required inequality format is n.x + d = 0.\n    # Our derived inequality is R.x - 0.5*|R|^2 = 0.\n    # So, for each vector R, the normal n is R and the offset d is -0.5*|R|^2.\n    halfspaces = []\n    for R in candidate_vectors:\n        sq_norm = np.dot(R, R)\n        # Each row is [nx, ny, nz, d]\n        halfspaces.append([R[0], R[1], R[2], -0.5 * sq_norm])\n    \n    halfspaces = np.array(halfspaces)\n\n    # Step 4: Compute the intersection of half-spaces.\n    # The origin is always an interior point for the Wigner-Seitz cell.\n    interior_point = np.array([0.0, 0.0, 0.0])\n    \n    try:\n        # This function computes the vertices of the convex polyhedron.\n        hs_intersection = HalfspaceIntersection(halfspaces, interior_point)\n    except Exception:\n        # Qhull can error on degenerate inputs, though it's designed to be robust.\n        # This case should not be reached with the symmetric set of vectors generated.\n        return []\n\n    # Step 5: Extract and sort vertices.\n    vertices = hs_intersection.intersections\n\n    # Sort the vertices lexicographically for a canonical representation.\n    # Convert to a list of tuples for robust sorting.\n    vertices_tuples = [tuple(v) for v in vertices]\n    sorted_vertices = sorted(vertices_tuples, key=lambda k: (k[0], k[1], k[2]))\n\n    return sorted_vertices\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print the final output.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (2.3, 1.7, 3.1),\n        (1.0, 1.0, 1.0),\n        (0.5, 2.0, 3.0),\n    ]\n\n    all_results_str = []\n    for case in test_cases:\n        a, b, c = case\n        vertices = solve_case(a, b, c)\n\n        # Format the result for the current test case into a string.\n        # Each coordinate must be rounded to exactly six decimal places.\n        case_str_parts = []\n        for v in vertices:\n            v_str = f\"[{v[0]:.6f},{v[1]:.6f},{v[2]:.6f}]\"\n            case_str_parts.append(v_str)\n        # Join vertices into a string list: \"[v1,v2,...]\"\n        all_results_str.append(f\"[{','.join(case_str_parts)}]\")\n\n    # Final print statement must produce a single line in the exact required format.\n    # Join all case results: \"[result1,result2,...]\"\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```", "id": "2870633"}]}