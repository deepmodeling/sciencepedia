{"hands_on_practices": [{"introduction": "平均场理论是理解磁有序相变最基础的理论工具。通过将一个自旋感受到的来自邻近自旋的复杂相互作用简化为一个等效的“平均场”，我们可以解析地求解模型的行为。这个练习将指导你推导一般二分晶格反铁磁体的奈尔温度，将宏观的相变温度 $T_N$ 与微观的交换积分和配位数等参数直接联系起来，这是理解反铁磁性的经典第一步。[@problem_id:37390]", "problem": "考虑一个晶体固体，其磁性离子的自旋为 $S$，位于一个二分晶格的格点上。二分晶格是一种可以被划分为两个子晶格 A 和 B 的晶格，其中子晶格 A 上任一格点的所有最近邻都位于子晶格 B 上，反之亦然。\n\n离子间的磁相互作用由海森堡哈密顿量描述。该相互作用包括最近邻（NN）之间占主导地位的反铁磁交换 $J_1  0$ 和次近邻（NNN）之间较弱的交换 $J_2$。对于一个子晶格上的格点，其最近邻位于另一个子晶格上，而其次近邻则位于同一个子晶格上。每个离子有 $z_1$ 个最近邻和 $z_2$ 个次近邻。哈密顿量由下式给出：\n\n$$ \\mathcal{H} = J_1 \\sum_{\\langle i, j \\rangle_{\\text{NN}}} \\mathbf{S}_i \\cdot \\mathbf{S}_j + J_2 \\sum_{\\langle i, k \\rangle_{\\text{NNN}}} \\mathbf{S}_i \\cdot \\mathbf{S}_k $$\n\n其中 $\\mathbf{S}_i$ 是格点 $i$ 处离子的自旋算符。\n\n在低于一个临界温度，即奈尔温度 $T_N$ 时，系统会经历相变，进入一个反铁磁有序态，其特征是两个子晶格的磁化强度相反排列。\n\n使用平均场近似，推导该系统奈尔温度 $T_N$ 的表达式。请用自旋量子数 $S$、配位数 $z_1$ 和 $z_2$、交换积分 $J_1$ 和 $J_2$ 以及玻尔兹曼常数 $k_B$ 来表示你的答案。", "solution": "在平均场近似中，我们考虑一个位于子晶格 A 的自旋 $\\mathbf{S}_A$，它感受到的有效相互作用来自于其 $z_1$ 个最近邻（在子晶格 B 上）和 $z_2$ 个次近邻（在子晶格 A 上）。我们将邻居自旋算符替换为它们的平均值 $\\langle \\mathbf{S}_A \\rangle$ 和 $\\langle \\mathbf{S}_B \\rangle$。作用于自旋 $\\mathbf{S}_A$ 的有效哈密顿量为：\n$$ \\mathcal{H}_A^{\\text{eff}} = \\mathbf{S}_A \\cdot (z_1 J_1 \\langle \\mathbf{S}_B \\rangle + z_2 J_2 \\langle \\mathbf{S}_A \\rangle) $$\n这可以看作是一个自旋在有效场（或分子场）$\\mathbf{h}_{\\text{eff}}$ 中的问题，其哈密顿量形式为 $\\mathcal{H}_A^{\\text{eff}} = -\\mathbf{S}_A \\cdot \\mathbf{h}_{\\text{eff}, A}$。比较两式，我们得到有效场（以能量为单位）：\n$$ \\mathbf{h}_{\\text{eff}, A} = -(z_1 J_1 \\langle \\mathbf{S}_B \\rangle + z_2 J_2 \\langle \\mathbf{S}_A \\rangle) $$\n在奈尔温度 $T_N$ 附近，磁化强度很小，系统响应是线性的。单个自旋的平均值与其感受到的有效场成正比：\n$$ \\langle \\mathbf{S} \\rangle = \\frac{S(S+1)}{3k_B T} \\mathbf{h}_{\\text{eff}} $$\n将子晶格磁化强度记为 $\\mathbf{m}_A = \\langle \\mathbf{S}_A \\rangle$ 和 $\\mathbf{m}_B = \\langle \\mathbf{S}_B \\rangle$，我们得到一组自洽方程：\n$$ \\mathbf{m}_A = -\\frac{S(S+1)}{3k_B T} (z_1 J_1 \\mathbf{m}_B + z_2 J_2 \\mathbf{m}_A) $$\n$$ \\mathbf{m}_B = -\\frac{S(S+1)}{3k_B T} (z_1 J_1 \\mathbf{m}_A + z_2 J_2 \\mathbf{m}_B) $$\n对于反铁磁有序态，我们寻找 $\\mathbf{m}_A = -\\mathbf{m}_B = \\mathbf{m} \\neq \\mathbf{0}$ 的解。将此条件代入第一个方程：\n$$ \\mathbf{m} = -\\frac{S(S+1)}{3k_B T_N} (z_1 J_1 (-\\mathbf{m}) + z_2 J_2 \\mathbf{m}) $$\n$$ \\mathbf{m} = -\\frac{S(S+1)}{3k_B T_N} (z_2 J_2 - z_1 J_1) \\mathbf{m} $$\n为了使非零解 $\\mathbf{m}$ 存在，两边的系数必须相等：\n$$ 1 = \\frac{S(S+1)}{3k_B T_N} (z_1 J_1 - z_2 J_2) $$\n求解 $T_N$，我们得到奈尔温度的表达式：\n$$ T_N = \\frac{S(S+1)(z_1 J_1 - z_2 J_2)}{3k_B} $$", "answer": "$$\n\\boxed{\\frac{S(S+1)\\bigl(z_{1}J_{1}-z_{2}J_{2}\\bigr)}{3k_{B}}}\n$$", "id": "37390"}, {"introduction": "当晶格的几何结构使得系统无法同时满足所有反铁磁相互作用时，就会出现所谓的“几何阻挫”。这个练习将探讨一个典型的阻挫系统——三角晶格反铁磁体。你将运用平均场方法处理非共线的 $120^\\circ$ 自旋构型，并揭示几何阻挫如何抑制磁有序，从而导致奈尔温度相较于无阻挫系统显著降低。[@problem_id:2843736]", "problem": "考虑一个二维三角布拉维晶格上的量子海森堡反铁磁体，其具有最近邻交换作用。其哈密顿量为\n$$\nH \\;=\\; J \\sum_{\\langle i j \\rangle} \\mathbf{S}_i \\cdot \\mathbf{S}_j \\,,\n$$\n其中 $J0$，每个格点上的自旋大小为 $S$。晶格的配位数为 $z=6$。假设一个没有单离子各向异性或外场的各向同性模型，并应用 Weiss 平均场理论（也称为分子场理论）：将相邻自旋替换为其热平均值，并在有序化温度附近对自洽方程进行线性化。由于已知三角晶格上初现的反铁磁序是非共线的，呈现为三亚晶格的 $120^\\circ$ 构型，因此引入三个亚晶格 $A$、$B$ 和 $C$ 以及相应的均匀亚晶格磁化强度 $\\mathbf{m}_A$、$\\mathbf{m}_B$ 和 $\\mathbf{m}_C$，定义为 $\\mathbf{m}_\\alpha \\equiv \\langle \\mathbf{S}_i \\rangle$（其中 $i$ 位于亚晶格 $\\alpha$上）。\n\n仅从上述哈密顿量和单个量子自旋的居里（高温）响应出发，\n$$\n\\langle \\mathbf{S} \\rangle \\;=\\; \\frac{S(S+1)}{3 k_B T} \\, \\mathbf{h}_{\\mathrm{eff}} \\,,\n$$\n其中格点上的有效场由局域塞曼形式 $H_{\\mathrm{site}} = - \\mathbf{h}_{\\mathrm{eff}} \\cdot \\mathbf{S}$ 定义，推导 $\\mathbf{m}_A$、$\\mathbf{m}_B$ 和 $\\mathbf{m}_C$ 的线性化平均场方程。在亚晶格空间中对角化所得的耦合，以确定在降温过程中首先变得不稳定的模式，并提取相应的平均场奈尔温度。将奈尔温度 $T_N$ 的最终结果表示为包含 $J$、$S$ 和 $k_B$ 的符号表达式。以开尔文表示 $T_N$。不要代入任何数值，也不要四舍五入。\n\n在您的推理中，阐明非共线的 $120^\\circ$ 构型如何进入平均场不稳定性条件，以及它如何设定了与具有相同配位数的二分晶格上的假想共线反铁磁体相比的有序化温度标度。", "solution": "该系统由二维三角晶格上的海森堡哈密顿量 $H = J \\sum_{\\langle i j \\rangle} \\mathbf{S}_i \\cdot \\mathbf{S}_j$ 描述，其中反铁磁耦合 $J>0$，配位数为 $z=6$。为适应预期的 $120^\\circ$ 非共线磁序，我们将晶格划分为三个等效的亚晶格 A、B 和 C。每个亚晶格上的格点分别与另外两个亚晶格上的3个最近邻格点耦合。\n\n在平均场理论中，位于亚晶格 A 上的单个自旋 $\\mathbf{S}_A$ 所感受到的有效哈密顿量为：\n$$ H_A^{\\text{MF}} = \\mathbf{S}_A \\cdot \\left( J \\sum_{j \\in B, \\text{nn}} \\langle \\mathbf{S}_B \\rangle + J \\sum_{j \\in C, \\text{nn}} \\langle \\mathbf{S}_C \\rangle \\right) = \\mathbf{S}_A \\cdot (3J\\mathbf{m}_B + 3J\\mathbf{m}_C) $$\n其中 $\\mathbf{m}_\\alpha = \\langle \\mathbf{S}_\\alpha \\rangle$ 是亚晶格磁化强度。该哈密顿量等效于一个自旋在有效场 $\\mathbf{h}_{\\text{eff}, A}$ 中的形式 $H_A^{\\text{MF}} = - \\mathbf{S}_A \\cdot \\mathbf{h}_{\\text{eff}, A}$，其中有效场为：\n$$ \\mathbf{h}_{\\text{eff}, A} = -3J(\\mathbf{m}_B + \\mathbf{m}_C) $$\n根据对称性，其他两个亚晶格的有效场为：\n$$ \\mathbf{h}_{\\text{eff}, B} = -3J(\\mathbf{m}_A + \\mathbf{m}_C) $$\n$$ \\mathbf{h}_{\\text{eff}, C} = -3J(\\mathbf{m}_A + \\mathbf{m}_B) $$\n在 $T_N$ 附近，根据线性响应理论，亚晶格磁化强度为：\n$$ \\mathbf{m}_\\alpha = \\frac{S(S+1)}{3k_B T} \\mathbf{h}_{\\text{eff}, \\alpha} $$\n代入有效场的表达式，我们得到一个关于亚晶格磁化强度的线性化方程组：\n$$ T \\mathbf{m}_A = -\\frac{3JS(S+1)}{3k_B} (\\mathbf{m}_B + \\mathbf{m}_C) = -\\frac{JS(S+1)}{k_B} (\\mathbf{m}_B + \\mathbf{m}_C) $$\n$$ T \\mathbf{m}_B = -\\frac{JS(S+1)}{k_B} (\\mathbf{m}_A + \\mathbf{m}_C) $$\n$$ T \\mathbf{m}_C = -\\frac{JS(S+1)}{k_B} (\\mathbf{m}_A + \\mathbf{m}_B) $$\n该方程组可以写成矩阵本征值形式 $T \\vec{\\mathbf{m}} = \\mathcal{M} \\vec{\\mathbf{m}}$，其中 $\\vec{\\mathbf{m}} = (\\mathbf{m}_A, \\mathbf{m}_B, \\mathbf{m}_C)^T$ 且\n$$ \\mathcal{M} = -\\frac{JS(S+1)}{k_B} \\begin{pmatrix} 0  1  1 \\\\ 1  0  1 \\\\ 1  1  0 \\end{pmatrix} $$\n奈尔温度 $T_N$ 对应于矩阵 $\\mathcal{M}$ 的最大正本征值。我们先求出耦合矩阵 $K = \\begin{pmatrix} 0  1  1 \\\\ 1  0  1 \\\\ 1  1  0 \\end{pmatrix}$ 的本征值 $\\mu$。特征方程 $\\det(K - \\mu I) = -(\\mu-2)(\\mu+1)^2 = 0$ 给出本征值为 $\\mu_1 = 2$ 和 $\\mu_{2,3} = -1$（二重简并）。\n\n对应的温度本征值为：\n- 对于 $\\mu=2$：$T_1 = -\\frac{JS(S+1)}{k_B} (2) = -2\\frac{JS(S+1)}{k_B}$。此为负温度，不物理。\n- 对于 $\\mu=-1$：$T_{2,3} = -\\frac{JS(S+1)}{k_B} (-1) = \\frac{JS(S+1)}{k_B}$。此为正温度。\n\n最高的物理相变温度即为奈尔温度。因此：\n$$ T_N = \\frac{JS(S+1)}{k_B} $$\n此解对应的本征矢量满足 $\\mathbf{m}_A + \\mathbf{m}_B + \\mathbf{m}_C = 0$，这正是 $120^\\circ$ 自旋结构的条件。\n\n为了理解阻挫的影响，我们将此结果与具有相同配位数 $z=6$ 的无阻挫二分晶格进行比较，其奈尔温度为 $T_N^{\\text{bipartite}} = \\frac{zJS(S+1)}{3k_B} = 2\\frac{JS(S+1)}{k_B}$。可见，$T_N^{\\text{triangular}} = \\frac{1}{2} T_N^{\\text{bipartite}}$。几何阻挫通过削弱有效的分子场，显著地抑制了磁有序温度。", "answer": "$$\\boxed{\\frac{J S (S+1)}{k_B}}$$", "id": "2843736"}, {"introduction": "虽然平均场理论提供了定性的图像，但要精确确定奈尔温度，尤其是在存在强量子涨落的情况下，通常需要依赖于先进的数值方法，例如量子蒙特卡洛（QMC）。这个实践练习的核心是模拟研究中的一个关键步骤：对 QMC 产生的有限尺寸数据进行分析。你将学习如何利用有限尺寸标度理论和宾德比（Binder ratio）这一与标度无关的物理量，从数值模拟结果中精确地提取出临界温度 $T_N$。[@problem_id:2843722]", "problem": "你的任务是设计并测试一个无符号问题(sign-problem-free)的量子蒙特卡洛(QMC)分析策略，用于估算一个在三维(3D)二分、无阻挫晶格上自旋为 $S=1/2$ 的量子海森堡反铁磁体的尼尔温度 $T_{\\mathrm{N}}$。你的程序必须实现一个分析阶段，该阶段接收由随机级数展开(SSE) QMC 产生的有限尺寸数据作为输入，并通过利用尺度不变(scale-invariant)的可观测量来输出 $T_{\\mathrm{N}}$ 的估计值。\n\n使用的基本原理：\n- 哈密顿量为 $H = J \\sum_{\\langle i j \\rangle} \\mathbf{S}_i \\cdot \\mathbf{S}_j$，其中 $J0$，作用于一个二分、无阻挫的三维晶格上，$\\langle i j \\rangle$ 表示最近邻，$\\mathbf{S}_i$ 是自旋-1/2算符。\n- 配分函数为 $Z = \\mathrm{Tr}\\, e^{-\\beta H}$，其中 $\\beta = 1/(k_{\\mathrm{B}} T)$，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度。\n- 在对二分无阻挫反铁磁体进行无符号问题的SSE抽样时，可以获得在温度 $T$ 和线性尺寸 $L$ 下交错磁化强度 $\\mathbf{m}_{\\mathrm{s}}$ 及其矩 $\\langle m_{\\mathrm{s}}^2 \\rangle$ 和 $\\langle m_{\\mathrm{s}}^4 \\rangle$ 的估计量。\n- 将交错序参量一个分量的宾德比(Binder ratio)（无量纲）定义为 $U_4(T,L) = 1 - \\frac{\\langle m_{\\mathrm{s}}^4 \\rangle}{3 \\langle m_{\\mathrm{s}}^2 \\rangle^2}$。重整化群理论和有限尺寸标度理论表明，像 $U_4$ 这样的无量纲量在临界温度下近似地具有尺度不变性，即 $U_4(T_{\\mathrm{N}},L)$ 在忽略次级修正项的情况下近似地与 $L$ 无关。\n- 因此，在 $T = T_{\\mathrm{N}}$ 时，不同 $L$ 的 $U_4(T,L)$ 曲线会相交，而使 $U_4$ 跨 $L$ 的方差最小化的温度为 $T_{\\mathrm{N}}$ 提供了一个一致的估计量。\n\n你的程序必须：\n- 对于下面的每个测试用例，将提供的 $U_4(T,L)$ 数据视为在离散温度和尺寸 $L$ 下采样的QMC输出。\n- 对于每个固定的 $L$，使用一种在为该 $L$ 提供的温度点的凸包上定义的保形插值方法，将 $U_4(T,L)$ 作为 $T$ 的函数进行插值。\n- 定义目标函数 $F(T) = \\frac{1}{N_L} \\sum_{i=1}^{N_L} \\left(U_4(T,L_i) - \\overline{U}_4(T)\\right)^2$，其中 $N_L$ 是尺寸的数量，$\\overline{U}_4(T) = \\frac{1}{N_L}\\sum_{i=1}^{N_L} U_4(T,L_i)$ 是在固定温度 $T$ 下对尺寸的平均值。\n- 在所有 $L$ 都有数据的温度区间的交集（即插值函数的公共定义域）上，将 $F(T)$ 的最小值点 $T^\\star$ 作为该情况下的 $T_{\\mathrm{N}}$ 估计值。如果最小值点位于公共区间的边界上，则返回该边界值。\n- 最终温度以 $J/k_{\\mathrm{B}}$ 为单位表示，并四舍五入到4位小数。\n\n测试套件：\n- 案例A（理想情况；干净、单调的数据；尺寸 $L \\in \\{8,12,16\\}$；公共温度网格 $T \\in [0.80,0.90,0.95,1.00,1.05,1.10,1.20]$，其中 $T$ 以 $J/k_{\\mathrm{B}}$ 为单位）：\n  - $L=8$ 时 $U_4(T,8)$ 在 $T = [0.80,0.90,0.95,1.00,1.05,1.10,1.20]$ 的值：$[0.58,0.54,0.55,0.45,0.36,0.28,0.16]$。\n  - $L=12$ 时 $U_4(T,12)$ 在 $T = [0.80,0.90,0.95,1.00,1.05,1.10,1.20]$ 的值：$[0.60,0.56,0.53,0.40,0.30,0.22,0.12]$。\n  - $L=16$ 时 $U_4(T,16)$ 在 $T = [0.80,0.90,0.95,1.00,1.05,1.10,1.20]$ 的值：$[0.62,0.58,0.50,0.36,0.26,0.18,0.10]$。\n- 案例B（含噪声数据；尺寸和网格与案例A相同）：\n  - $L=8$ 时的 $U_4(T,8)$：$[0.579,0.541,0.551,0.452,0.358,0.279,0.162]$。\n  - $L=12$ 时的 $U_4(T,12)$：$[0.603,0.557,0.528,0.401,0.297,0.219,0.118]$。\n  - $L=16$ 时的 $U_4(T,16)$：$[0.618,0.584,0.498,0.357,0.264,0.176,0.101]$。\n- 案例C（某个尺寸的温度数据不完整；定义域的交集仍包含交叉点）：\n  - 尺寸 $L \\in \\{8,12,16\\}$。\n  - 对于 $L=8$：温度为 $[0.82,0.90,0.94,0.98,1.06,1.16]$，值为 $[0.566,0.542,0.525,0.438,0.342,0.162]$。\n  - 对于 $L=12$：温度为 $[0.82,0.90,0.98,1.06,1.16]$，值为 $[0.588,0.562,0.402,0.301,0.122]$。\n  - 对于 $L=16$：温度为 $[0.82,0.90,0.94,0.98,1.06,1.16]$，值为 $[0.607,0.582,0.505,0.365,0.256,0.104]$。\n\n要求的最终输出格式：\n- 你的程序应生成单行输出，其中包含案例A、B和C的结果（按此顺序），形式为一个由逗号分隔的列表，包含三个估计的 $T_{\\mathrm{N}}$ 值，并用方括号括起来，每个值四舍五入到4位小数，例如 $[0.9450,0.9460,0.9440]$。\n- 单位：所有温度都必须以 $J/k_{\\mathrm{B}}$ 为单位报告。", "solution": "该问题的目标是通过分析宾德比 $U_4(T,L)$ 的有限尺寸数据来估算三维量子海森堡反铁磁体的奈尔温度 $T_{\\mathrm{N}}$。$T_{\\mathrm{N}}$ 是不同系统尺寸 $L$ 的 $U_4(T,L)$ 曲线的交叉点。该交叉点可以通过寻找使 $U_4(T,L)$ 在不同尺寸 $L$ 间的方差最小化的温度 $T$ 来确定。\n\n宾德比定义为 $U_4(T,L) = 1 - \\frac{\\langle m_{\\mathrm{s}}^4 \\rangle}{3 \\langle m_{\\mathrm{s}}^2 \\rangle^2}$，其中 $\\mathbf{m}_{\\mathrm{s}}$ 是交错磁化强度。根据有限尺寸标度理论，这个无量纲量在临界温度 $T_{\\mathrm{N}}$ 处（忽略标度修正项）与系统尺寸 $L$ 无关。\n\n数值计算过程如下：\n\n1.  **数据插值**：对于每个给定的系统尺寸 $L_i$，使用其离散数据点 $(T_j, U_4(T_j, L_i))$ 构建一个连续函数 $U_4(T, L_i)$。为了避免引入伪振荡并保持数据单调性，采用分段三次埃尔米特插值多项式（PCHIP）是合适的选择。\n\n2.  **定义公共温度域**：分析必须在所有系统尺寸都有插值数据的共同温度区间内进行。该区间 $[T_{\\mathrm{min}}, T_{\\mathrm{max}}]$ 是所有尺寸的温度范围 $[\\min(T_{ij}), \\max(T_{ij})]$ 的交集。\n\n3.  **目标函数**：为了定位交叉点，我们定义一个目标函数 $F(T)$，它量化了在给定温度 $T$ 下 $U_4$ 值的离散程度，即 $N_L$ 个系统尺寸上插值 $U_4(T,L_i)$ 值的方差：\n    $$F(T) = \\mathrm{Var}[U_4(T, L_1), U_4(T, L_2), \\dots, U_4(T, L_{N_L})]$$\n\n4.  **数值最小化**：奈尔温度 $T_{\\mathrm{N}}$ 被估计为在公共域 $[T_{\\mathrm{min}}, T_{\\mathrm{max}}]$ 内使 $F(T)$ 最小化的温度 $T^\\star$。这可以通过有界的一维优化算法（如 `scipy.optimize.minimize_scalar` 的 `bounded` 方法）来实现。\n\n提供的 Python 代码实现了这一完整流程，它接收三个测试用例的数据，对每个用例执行上述步骤，并输出估算的 $T_{\\mathrm{N}}$ 值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.interpolate import PchipInterpolator\nfrom scipy.optimize import minimize_scalar\n\ndef estimate_neel_temp(case_data):\n    \"\"\"\n    Estimates the Néel temperature T_N for a single test case.\n\n    Args:\n        case_data (list): A list of tuples, where each tuple contains\n                          (L, temperatures, U4_values) for a system size.\n\n    Returns:\n        float: The estimated Néel temperature T_N.\n    \"\"\"\n    interpolators = []\n    temp_intervals = []\n\n    # Step 1: Create a shape-preserving interpolator for each system size.\n    # PchipInterpolator is a good choice for preserving monotonicity.\n    for _, temps, u4_vals in case_data:\n        # PchipInterpolator requires data to be sorted by the independent variable.\n        sorted_indices = np.argsort(temps)\n        sorted_temps = np.array(temps)[sorted_indices]\n        sorted_u4_vals = np.array(u4_vals)[sorted_indices]\n        \n        interpolators.append(PchipInterpolator(sorted_temps, sorted_u4_vals))\n        temp_intervals.append((min(temps), max(temps)))\n\n    # Step 2: Determine the common temperature domain for analysis.\n    # This is the intersection of the temperature ranges for all sizes.\n    t_min_common = max(interval[0] for interval in temp_intervals)\n    t_max_common = min(interval[1] for interval in temp_intervals)\n\n    # Step 3: Define the objective function F(T), which is the variance of\n    # the U4 values across different sizes at a fixed temperature T.\n    def objective_function(T):\n        \"\"\" The function to be minimized. \"\"\"\n        if not (t_min_common = T = t_max_common):\n             return np.inf  # Return a large value outside the valid domain\n        \n        u4_at_T = np.array([interp(T) for interp in interpolators])\n        # np.var calculates the population variance by default (ddof=0),\n        # which matches the formula provided in the problem.\n        return np.var(u4_at_T)\n\n    # Step 4: Find the temperature T that minimizes the objective function\n    # within the common domain.\n    result = minimize_scalar(\n        objective_function,\n        bounds=(t_min_common, t_max_common),\n        method='bounded'\n    )\n\n    neel_temp = result.x\n    return neel_temp\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run the analysis, and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Happy path\n        [\n            (8, [0.80, 0.90, 0.95, 1.00, 1.05, 1.10, 1.20], [0.58, 0.54, 0.55, 0.45, 0.36, 0.28, 0.16]),\n            (12, [0.80, 0.90, 0.95, 1.00, 1.05, 1.10, 1.20], [0.60, 0.56, 0.53, 0.40, 0.30, 0.22, 0.12]),\n            (16, [0.80, 0.90, 0.95, 1.00, 1.05, 1.10, 1.20], [0.62, 0.58, 0.50, 0.36, 0.26, 0.18, 0.10]),\n        ],\n        # Case B: Noisy data\n        [\n            (8, [0.80, 0.90, 0.95, 1.00, 1.05, 1.10, 1.20], [0.579, 0.541, 0.551, 0.452, 0.358, 0.279, 0.162]),\n            (12, [0.80, 0.90, 0.95, 1.00, 1.05, 1.10, 1.20], [0.603, 0.557, 0.528, 0.401, 0.297, 0.219, 0.118]),\n            (16, [0.80, 0.90, 0.95, 1.00, 1.05, 1.10, 1.20], [0.618, 0.584, 0.498, 0.357, 0.264, 0.176, 0.101]),\n        ],\n        # Case C: Incomplete temperatures\n        [\n            (8, [0.82, 0.90, 0.94, 0.98, 1.06, 1.16], [0.566, 0.542, 0.525, 0.438, 0.342, 0.162]),\n            (12, [0.82, 0.90, 0.98, 1.06, 1.16], [0.588, 0.562, 0.402, 0.301, 0.122]),\n            (16, [0.82, 0.90, 0.94, 0.98, 1.06, 1.16], [0.607, 0.582, 0.505, 0.365, 0.256, 0.104]),\n        ]\n    ]\n\n    results = []\n    for case in test_cases:\n        tn_estimate = estimate_neel_temp(case)\n        # Format the result to 4 decimal places.\n        results.append(f\"{tn_estimate:.4f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2843722"}]}