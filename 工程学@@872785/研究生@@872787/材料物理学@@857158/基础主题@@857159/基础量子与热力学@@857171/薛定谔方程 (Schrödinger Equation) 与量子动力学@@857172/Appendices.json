{"hands_on_practices": [{"introduction": "紧束缚模型是理解晶体中电子性质的基石。该练习要求从第一性原理（布洛赫定理）出发，推导出一维晶体的能量色散关系 $E(k)$。更进一步，你将分析色散关系中的关键拓扑特征——范霍夫奇点，它们对材料的光学和输运性质至关重要。通过这项动手实践，你将把离散的原子图像与连续的能带结构概念联系起来，这是固态理论中的核心技能。[@problem_id:2857754]", "problem": "考虑一个一维周期性晶体，其晶格常数为 $a$，每个格点有一个无自旋的轨道，使用紧束缚近似进行描述。在位能设为零，电子可以跃迁到最近邻（振幅为 $t_{1}$）和次近邻（振幅为 $t_{2}$），其中 $t_{1}$ 和 $t_{2}$ 均为实数且 $t_{2} \\neq 0$。仅使用不含时薛定谔方程和布洛赫定理作为基本出发点。\n\n任务：\n1. 从格点紧束缚哈密顿量和不含时薛定谔方程出发，推导第一布里渊区中布洛赫波矢 $k$ 的晶体动量色散关系 $E(k)$。\n2. 使用一维态密度（DOS）的一般定义，确定由于次近邻跃迁而出现额外范霍夫奇点（带边奇点之外）的条件。解释 $E(k)$ 的驻点与范霍夫奇点之间的联系，并确定这些驻点出现的晶体动量 $k$。\n3. 计算额外驻点（如果存在）处的能量，从而确定此额外范霍夫奇点的能量位置（用 $t_{1}$ 和 $t_{2}$ 表示）。\n\n答案规格：\n- 最终答案应为仅用 $t_1$ 和 $t_2$ 表示的额外范霍夫奇点能量的闭合形式符号表达式。\n- 能量单位与跃迁振幅相同，因此无需写明具体的物理单位。\n- 最终答案中不要包含不等式或条件；最终答案框中只需要唯一的能量解析表达式。", "solution": "所述问题具有科学依据，提法得当且客观。它提出了一个固态物理学中的标准可解问题，该问题使用了作为该领域基石的紧束缚模型。所有必要的参数都已定义，任务明确。因此，该问题是有效的，我们将着手进行推导。\n\n我们按照指示，从不含时薛定谔方程（TISE）开始：\n$$ \\hat{H} |\\psi\\rangle = E |\\psi\\rangle $$\n其中 $|\\psi\\rangle$ 是哈密顿量 $\\hat{H}$ 的本征态，本征值为 $E$。在紧束缚近似中，基矢是位于格点 $R_n = na$ 上的局域原子轨道 $|n\\rangle$，其中 $n$ 是整数，$a$ 是晶格常数。电子态 $|\\psi\\rangle$ 可以写成这些基矢的线性组合：\n$$ |\\psi\\rangle = \\sum_{n} c_n |n\\rangle $$\n我们假设基矢是正交归一的，$\\langle m | n \\rangle = \\delta_{mn}$。哈密顿量包含在位能和跃迁项。在位能给定为 $\\langle n|\\hat{H}|n \\rangle = 0$。跃迁矩阵元仅在最近邻（NN）和次近邻（NNN）之间非零：\n$$ \\langle m | \\hat{H} | n \\rangle = \\begin{cases} -t_1  \\text{如果 } |m-n|=1 \\\\ -t_2  \\text{如果 } |m-n|=2 \\\\ 0  \\text{其他情况} \\end{cases} $$\n将 $|\\psi\\rangle$ 的展开式代入不含时薛定谔方程，并投影到基矢 $\\langle m |$ 上，得到：\n$$ \\sum_{n} c_n \\langle m | \\hat{H} | n \\rangle = E \\sum_{n} c_n \\langle m | n \\rangle = E c_m $$\n应用特定的哈密顿量矩阵元，得到系数 $c_m$ 的方程：\n$$ -t_1(c_{m-1} + c_{m+1}) - t_2(c_{m-2} + c_{m+2}) = E c_m $$\n这是一个耦合线性方程组。对于周期性势场，布洛赫定理规定解必须具有平面波乘以周期函数的形式。在紧束缚的离散基矢中，这意味着系数具有平面波的形式：\n$$ c_n = C e^{ikna} $$\n其中 $k$ 是晶体动量。将此试探解代入系数方程中：\n$$ -t_1(e^{ik(m-1)a} + e^{ik(m+1)a}) - t_2(e^{ik(m-2)a} + e^{ik(m+2)a}) = E e^{ikma} $$\n将整个方程除以 $e^{ikma}$，分离出能量色散关系 $E(k)$：\n$$ E(k) = -t_1(e^{-ika} + e^{ika}) - t_2(e^{-i2ka} + e^{i2ka}) $$\n使用欧拉公式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，我们得到晶体动量 $k$ 的色散关系：\n$$ E(k) = -2t_1\\cos(ka) - 2t_2\\cos(2ka) $$\n这完成了第一个任务。\n\n对于第二个任务，我们分析范霍夫奇点。在一维情况下，态密度（DOS）$g(E)$ 由下式给出：\n$$ g(E) = \\frac{1}{2\\pi} \\int_{-\\pi/a}^{\\pi/a} \\delta(E - E(k)) \\, dk = \\frac{1}{\\pi} \\sum_{k_i} \\frac{1}{|\\frac{dE}{dk}|_{k=k_i}|} $$\n其中求和遍及第一布里渊区中所有满足 $E(k_i)=E$ 的 $k_i$。范霍夫奇点是态密度中的发散点，出现在能带结构的临界点上，这些临界点是群速度 $v_g = \\frac{1}{\\hbar}\\frac{dE}{dk}$ 为零的 $k$ 值。在数学上，这对应于 $\\frac{dE}{dk}=0$ 的驻点。\n\n我们必须求出色散关系 $E(k)$ 的导数：\n$$ \\frac{dE}{dk} = \\frac{d}{dk} \\left( -2t_1\\cos(ka) - 2t_2\\cos(2ka) \\right) $$\n$$ \\frac{dE}{dk} = -2t_1(-a\\sin(ka)) - 2t_2(-2a\\sin(2ka)) = 2a t_1\\sin(ka) + 4a t_2\\sin(2ka) $$\n使用倍角公式 $\\sin(2\\theta) = 2\\sin(\\theta)\\cos(\\theta)$，我们可以对表达式进行因式分解：\n$$ \\frac{dE}{dk} = 2a t_1\\sin(ka) + 4a t_2(2\\sin(ka)\\cos(ka)) = 2a\\sin(ka) \\left( t_1 + 4t_2\\cos(ka) \\right) $$\n将导数设为零，$\\frac{dE}{dk}=0$，得到驻点的两个条件：\n1. $\\sin(ka) = 0$：这发生在 $ka=n\\pi$（$n$ 为整数）处。在第一布里渊区（$k \\in [-\\pi/a, \\pi/a]$）中，这给出 $k=0$ 和 $k=\\pm\\pi/a$。这些是始终存在的标准带边奇点。\n2. $t_1 + 4t_2\\cos(ka) = 0$：这得到 $\\cos(ka) = -\\frac{t_1}{4t_2}$。\n\n如果第二个条件存在 $k$ 的实数解，那么就会出现一个不同于带边奇点的额外范霍夫奇点。$k$ 的实数解是否存在取决于 $\\cos(ka)$ 的值，该值必须在 $[-1, 1]$ 范围内。因此，解存在的充要条件是：\n$$ \\left| -\\frac{t_1}{4t_2} \\right| \\le 1 \\implies |t_1| \\le 4|t_2| $$\n当严格不等式 $|t_1|  4|t_2|$ 成立时，会出现一个独特的额外奇点。如果 $|t_1| = 4|t_2|$，这个额外奇点会与其中一个带边奇点合并（如果 $t_1=-4t_2$，则在 $k=0$ 处合并；如果 $t_1=4t_2$，则在 $k=\\pm \\pi/a$ 处合并）。因此，出现额外的、非带边奇点的条件是 $|t_1|  4|t_2|$。这些奇点出现的晶体动量由 $k = \\pm \\frac{1}{a}\\arccos\\left(-\\frac{t_1}{4t_2}\\right)$ 确定。\n\n对于第三个任务，我们计算满足额外奇点条件 $\\cos(k^*a) = -\\frac{t_1}{4t_2}$ 的晶体动量 $k^*$ 处的能量。为此，我们将其代入色散关系 $E(k)$。我们还需要 $\\cos(2k^*a)$ 的值，这可以使用恒等式 $\\cos(2\\theta) = 2\\cos^2(\\theta)-1$ 找到：\n$$ \\cos(2k^*a) = 2\\cos^2(k^*a) - 1 = 2\\left(-\\frac{t_1}{4t_2}\\right)^2 - 1 = 2\\frac{t_1^2}{16t_2^2} - 1 = \\frac{t_1^2}{8t_2^2} - 1 $$\n现在我们将 $\\cos(k^*a)$ 和 $\\cos(2k^*a)$ 都代入能量表达式中：\n$$ E(k^*) = -2t_1\\cos(k^*a) - 2t_2\\cos(2k^*a) $$\n$$ E(k^*) = -2t_1\\left(-\\frac{t_1}{4t_2}\\right) - 2t_2\\left(\\frac{t_1^2}{8t_2^2} - 1\\right) $$\n$$ E(k^*) = \\frac{2t_1^2}{4t_2} - \\frac{2t_2 t_1^2}{8t_2^2} + 2t_2 $$\n$$ E(k^*) = \\frac{t_1^2}{2t_2} - \\frac{t_1^2}{4t_2} + 2t_2 $$\n合并含有 $t_1^2$ 的项：\n$$ E(k^*) = \\left(\\frac{1}{2} - \\frac{1}{4}\\right)\\frac{t_1^2}{t_2} + 2t_2 = \\frac{1}{4}\\frac{t_1^2}{t_2} + 2t_2 $$\n因此，额外范霍夫奇点的能量为：\n$$ E_{vHs} = \\frac{t_1^2}{4t_2} + 2t_2 $$\n该表达式给出了奇点的能级，用跃迁参数 $t_1$ 和 $t_2$ 表示，这正是所要求的最终结果。", "answer": "$$\\boxed{\\frac{t_{1}^{2}}{4t_{2}} + 2t_{2}}$$", "id": "2857754"}, {"introduction": "材料中的许多现象是由准粒子 (quasiparticles) 支配的，例如激子。本练习将大家熟悉的氢原子薛定谔方程应用于模拟半导体中的基本激发态——激子（一个电子-空穴对）。此问题的关键挑战与深刻见解来自于比较二维和三维空间中的解，它揭示了量子限制如何显著地改变能级结构。这项实践是连接量子力学基础理论与真实材料物理的桥梁。[@problem_id:2857747]", "problem": "半导体中的类氢激子可以通过相对坐标的不含时薛定谔方程来建模，其中电子和空穴通过被均匀背景电介质屏蔽的库仑势相互作用。考虑一个限制在平面内的严格二维激子和一个体材料中的三维激子，两者都处于同一材料中，具有电子有效质量 $m_{e}^{\\star}$、空穴有效质量 $m_{h}^{\\star}$ 和背景相对介电常数 $\\varepsilon_{r}$。设折合质量为 $\\mu = \\frac{m_{e}^{\\star} m_{h}^{\\star}}{m_{e}^{\\star} + m_{h}^{\\star}}$，库仑相互作用为 $V(r) = - \\frac{e^{2}}{4 \\pi \\varepsilon_{0} \\varepsilon_{r} r}$，其中 $r$ 是电子-空穴间距。\n\n从相对坐标的薛定谔方程出发，在相应的空间维度中分离变量，施加束缚态的归一化条件，并求出二维和三维情况下以 $\\mu$、$\\varepsilon_{r}$、$e$、$\\varepsilon_{0}$ 和 $\\hbar$ 表示的离散束缚能谱。利用这些能谱，定义空间维度为 $d$ 时，第一激发态 ($n=2$) 与基态 ($n=1$) 之间的能级间距 $\\Delta E_{1 \\to 2}^{(d)} \\equiv E_{2}^{(d)} - E_{1}^{(d)}$。\n\n精确比值\n$$\n\\mathcal{R} \\equiv \\frac{\\Delta E_{1 \\to 2}^{(2\\text{D})}}{\\Delta E_{1 \\to 2}^{(3\\text{D})}} \\, ?\n$$\n是多少？请提供一个精确的数值作为最终答案。无需单位。不要四舍五入；给出精确值。", "solution": "所述问题在科学上是成立的，提问清晰、客观，并包含了求解唯一解所需的所有必要信息。这是凝聚态物理中的一个标准问题。我们接下来进行推导。\n\n建模激子的出发点是电子-空穴对相对运动的不含时薛定谔方程。相对坐标 $\\mathbf{r}$ 的哈密顿量由下式给出：\n$$\n\\hat{H} = -\\frac{\\hbar^2}{2\\mu} \\nabla^2 + V(r)\n$$\n其中 $\\mu = \\frac{m_{e}^{\\star} m_{h}^{\\star}}{m_{e}^{\\star} + m_{h}^{\\star}}$ 是折合质量，$\\hbar$ 是约化普朗克常数，势能是屏蔽库仑相互作用 $V(r) = - \\frac{e^{2}}{4 \\pi \\varepsilon_{0} \\varepsilon_{r} r}$。这里，$e$ 是元电荷，$\\varepsilon_{0}$ 是真空介电常数，$\\varepsilon_{r}$ 是材料的相对介电常数。薛定谔方程为 $\\hat{H}\\psi(\\mathbf{r}) = E\\psi(\\mathbf{r})$。\n\n我们必须对三维 ($3$D) 和二维 ($2$D) 系统求解该方程，以找到束缚态 ($E  0$) 的离散能谱。\n\n首先，我们分析三维激子。在球坐标中，薛定谔方程是可分离的。该问题在数学上与氢原子问题完全相同，只需将电子质量 $m_e$ 替换为折合质量 $\\mu$，并将真空介电常数 $\\varepsilon_0$ 替换为有效介电常数 $\\varepsilon_0 \\varepsilon_r$。众所周知的氢原子量子化能级为 $E_n^{\\text{H}} = - \\frac{m_e e^4}{2(4\\pi\\varepsilon_0)^2\\hbar^2 n^2}$。应用上述替换，可得到三维激子的能谱：\n$$\nE_{n}^{(3\\text{D})} = - \\frac{\\mu e^4}{2(4\\pi\\varepsilon_0\\varepsilon_r)^2\\hbar^2} \\frac{1}{n^2}\n$$\n其中主量子数 $n$ 可以取整数值 $n=1, 2, 3, \\dots$。\n我们定义一个特征能量标度，即激子 Rydberg：\n$$\nR_X \\equiv \\frac{\\mu e^4}{2(4\\pi\\varepsilon_0\\varepsilon_r)^2\\hbar^2}\n$$\n因此，三维情况下的能谱可以简明地写为：\n$$\nE_{n}^{(3\\text{D})} = -\\frac{R_X}{n^2}\n$$\n基态 ($n=1$) 能量为 $E_{1}^{(3\\text{D})} = -R_X$。\n第一激发态 ($n=2$) 能量为 $E_{2}^{(3\\text{D})} = -\\frac{R_X}{2^2} = -\\frac{R_X}{4}$。\n这两个能级之间的能量间距为：\n$$\n\\Delta E_{1 \\to 2}^{(3\\text{D})} = E_{2}^{(3\\text{D})} - E_{1}^{(3\\text{D})} = \\left(-\\frac{R_X}{4}\\right) - (-R_X) = R_X\\left(1 - \\frac{1}{4}\\right) = \\frac{3}{4}R_X\n$$\n\n接下来，我们分析严格的二维激子。薛定谔方程在二维平面内求解，在极坐标 $(r, \\phi)$ 中，它也是可分离的。这就是“二维氢原子”问题。在束缚态归一化条件下，径向方程的解给出了能谱：\n$$\nE_{n}^{(2\\text{D})} = - \\frac{\\mu e^4}{2(4\\pi\\varepsilon_0\\varepsilon_r)^2\\hbar^2} \\frac{1}{(n - 1/2)^2}\n$$\n这里，量子数 $n$ 标记能级，并取整数值 $n=1, 2, 3, \\dots$。使用相同的激子 Rydberg 定义 $R_X$，我们可以将二维能谱写为：\n$$\nE_{n}^{(2\\text{D})} = -\\frac{R_X}{(n - 1/2)^2}\n$$\n基态 ($n=1$) 能量为 $E_{1}^{(2\\text{D})} = -\\frac{R_X}{(1 - 1/2)^2} = -\\frac{R_X}{(1/2)^2} = -4R_X$。\n第一激发态 ($n=2$) 能量为 $E_{2}^{(2\\text{D})} = -\\frac{R_X}{(2 - 1/2)^2} = -\\frac{R_X}{(3/2)^2} = -\\frac{4}{9}R_X$。\n这两个能级之间的能量间距为：\n$$\n\\Delta E_{1 \\to 2}^{(2\\text{D})} = E_{2}^{(2\\text{D})} - E_{1}^{(2\\text{D})} = \\left(-\\frac{4}{9}R_X\\right) - (-4R_X) = R_X\\left(4 - \\frac{4}{9}\\right) = R_X\\left(\\frac{36-4}{9}\\right) = \\frac{32}{9}R_X\n$$\n\n最后，我们计算所要求的比值 $\\mathcal{R}$。\n$$\n\\mathcal{R} \\equiv \\frac{\\Delta E_{1 \\to 2}^{(2\\text{D})}}{\\Delta E_{1 \\to 2}^{(3\\text{D})}} = \\frac{\\frac{32}{9}R_X}{\\frac{3}{4}R_X}\n$$\n激子 Rydberg 常数 $R_X$ 被消掉了，因为它依赖于两种情况下都相同的材料参数。\n$$\n\\mathcal{R} = \\frac{32/9}{3/4} = \\frac{32}{9} \\times \\frac{4}{3} = \\frac{128}{27}\n$$\n这就是所要求的精确数值比。", "answer": "$$\n\\boxed{\\frac{128}{27}}\n$$", "id": "2857747"}, {"introduction": "尽管解析解具有不可估量的价值，但大多数现实世界中的量子动力学问题都需要数值方法来求解。本练习将介绍一种在计算物理学中广泛使用的强大算法——分裂算符法。通过亲手实现该方法来模拟量子谐振子的演化，你将获得关于时间演化算符、通过快速傅里叶变换 (FFT) 连接位置空间与动量空间，以及数值误差分析等方面的实践经验。[@problem_id:2857777]", "problem": "实现一个程序，该程序使用基于二阶Trotter (Strang) 分解的分裂算符法求解一维含时薛定谔方程，并数值分析全局误差随时间步长的标度关系。从基本定律 $i\\hbar \\frac{\\partial}{\\partial t}\\psi(x,t)=H\\psi(x,t)$ 开始，其中哈密顿量被分解为 $H=H_T+H_V$，$H_T$ 是动能算符，$H_V$ 是势能算符。使用Hartree原子单位制，其中 $\\hbar=1$ 且电子质量 $m=1$；因此在该单位制中所有量都是无量纲的。定义 $H_T = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}$ 和 $H_V=V(x)$，这样 $H_T$ 在动量空间中是对角的，而 $H_V$ 在位置空间中是对角的。二阶Trotter分解通过以下方式近似一步时间演化：\n$$\ne^{-i(H_T+H_V)\\Delta t}\\approx e^{-iH_V\\Delta t/2}\\,e^{-iH_T\\Delta t}\\,e^{-iH_V\\Delta t/2},\n$$\n该近似是幺正的，并且具有 $\\mathcal{O}(\\Delta t^3)$ 阶的局部误差。\n\n您必须使用快速傅里叶变换（FFT, Fast Fourier Transform）来实现此近似，在动量空间中应用 $e^{-iH_T\\Delta t}$，在位置空间中应用 $e^{-iH_V\\Delta t/2}$。对于收敛性研究，限定于谐振子势 $V(x)=\\frac{1}{2}\\omega^2 x^2$，并选择谐振子的精确归一化基态作为初始态，\n$$\n\\psi_0(x)=\\left(\\frac{\\omega}{\\pi}\\right)^{1/4}\\exp\\!\\left(-\\frac{\\omega x^2}{2}\\right).\n$$\n在原子单位制中，基态能量为 $E_0=\\frac{\\omega}{2}$，因此在时间 $t$ 的精确波函数为 $\\psi_{\\text{exact}}(x,t)=\\psi_0(x)\\,e^{-iE_0 t}$。\n\n在长度为 $L$ 的区域上，使用一个包含 $N$ 个点的均匀网格对空间进行离散化，并采用FFT所隐含的周期性边界条件。设网格间距为 $\\Delta x=L/N$，坐标选择为 $x_j=-L/2 + j\\,\\Delta x$，其中 $j\\in\\{0,1,\\dots,N-1\\}$。对每个时间步长 $\\Delta t$ 实现以下步骤：\n- 在位置空间中应用势能半步演化：$\\psi(x)\\leftarrow e^{-iV(x)\\Delta t/2}\\psi(x)$。\n- 在动量空间中应用动能全步演化：$\\tilde{\\psi}(k)=\\mathcal{F}[\\psi(x)]$，然后 $\\tilde{\\psi}(k)\\leftarrow e^{-ik^2\\Delta t/2}\\tilde{\\psi}(k)$，接着 $\\psi(x)=\\mathcal{F}^{-1}[\\tilde{\\psi}(k)]$，其中 $k$ 是由FFT频率约定定义的角波数，而 $k^2$ 来自原子单位制中的 $H_T$。\n- 再次在位置空间中应用势能半步演化。\n\n对于每个指定的 $\\Delta t$，使用 $n=T/\\Delta t$ 步（假设 $n$ 为整数）将初始态演化总时间 $T$，并计算在时间 $T$ 的离散 $L^2$ 误差：\n$$\nE(\\Delta t)=\\left(\\sum_{j=0}^{N-1}\\left|\\psi_{\\text{num}}(x_j,T)-\\psi_{\\text{exact}}(x_j,T)\\right|^2\\,\\Delta x\\right)^{1/2}.\n$$\n数值上归一化初始态，使得 $\\sum_j|\\psi_0(x_j)|^2\\,\\Delta x=1$。在所有计算中，使用双精度复数运算。\n\n通过对一组给定的 $\\Delta t$ 值拟合 $\\log E(\\Delta t)$ 对 $\\log \\Delta t$ 的直线来分析全局误差标度，并报告斜率 $s$。该斜率应反映二阶精度，即 $E(\\Delta t)\\propto \\Delta t^2$ 意味着 $s\\approx 2$。为了进行额外的定量检查，还需计算连续误差比 $E(\\Delta t)/E(\\Delta t/2)$。\n\n使用以下三个测试用例。对于每个用例，所有参数必须完全按照给定值实现。所有量均采用原子单位。\n\n- 测试用例 1 (一般情况):\n  - 角频率为 $\\omega=1.0$ 的谐振子。\n  - 空间区域长度 $L=20.0$，网格点数 $N=4096$。\n  - 总演化时间 $T=1.0$。\n  - 时间步长 $\\Delta t\\in\\{0.2,\\,0.1,\\,0.05,\\,0.025\\}$。\n  - 本用例需报告的输出：\n    - 对 $\\log E(\\Delta t)$ 与 $\\log \\Delta t$ 进行线性回归得到的拟合斜率 $s_1$。\n    - 三个连续误差比 $r_{1a}=E(0.2)/E(0.1)$、$r_{1b}=E(0.1)/E(0.05)$ 和 $r_{1c}=E(0.05)/E(0.025)$。\n\n- 测试用例 2 (更强约束):\n  - 角频率为 $\\omega=2.0$ 的谐振子。\n  - 空间区域长度 $L=20.0$，网格点数 $N=4096$。\n  - 总演化时间 $T=1.0$。\n  - 时间步长 $\\Delta t\\in\\{0.2,\\,0.1,\\,0.05,\\,0.025\\}$。\n  - 需报告的输出：拟合斜率 $s_2$。\n\n- 测试用例 3 (更长时间):\n  - 角频率为 $\\omega=1.0$ 的谐振子。\n  - 空间区域长度 $L=20.0$，网格点数 $N=4096$。\n  - 总演化时间 $T=2.0$。\n  - 时间步长 $\\Delta t\\in\\{0.2,\\,0.1,\\,0.05,\\,0.025\\}$。\n  - 需报告的输出：拟合斜率 $s_3$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序和舍入要求如下：\n- $[s_1,\\,r_{1a},\\,r_{1b},\\,r_{1c},\\,s_2,\\,s_3]$,\n- 其中每个数字都四舍五入到恰好 $6$ 位小数。\n\n在原子单位制中，所有数学量都是无量纲的。不报告任何角度，所有最终输出都是不带单位的纯数字。请确保空间离散化足够精确，以使对于指定的参数，观察到的标度关系主要由时间离散化误差决定。您的实现必须是自包含的，并且不得需要任何外部输入文件。", "solution": "所提出的问题是计算量子力学中的一个标准练习，并被认为是有效的。它具有科学依据、问题明确、客观，并包含了获得唯一解所需的所有信息。我们将着手阐述解决方案。\n\n基本任务是求解势场 $V(x)$ 中粒子的一维含时薛定谔方程（TDSE）。在Hartree原子单位制中，约化普朗克常数 $\\hbar$ 和电子质量 $m$ 均为1，TDSE由下式给出：\n$$\ni \\frac{\\partial}{\\partial t}\\psi(x,t) = \\hat{H}\\psi(x,t)\n$$\n哈密顿算符 $\\hat{H}$ 是动能算符 $\\hat{H}_T$ 和势能算符 $\\hat{H}_V$ 的和：\n$$\n\\hat{H} = \\hat{H}_T + \\hat{H}_V = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} + V(x)\n$$\n波函数 $\\psi(x,t)$ 从时间 $t$ 到 $t+\\Delta t$ 的演化的形式解通过时间演化算符 $\\hat{U}(\\Delta t) = e^{-i\\hat{H}\\Delta t}$ 表示：\n$$\n\\psi(x, t+\\Delta t) = e^{-i\\hat{H}\\Delta t} \\psi(x,t)\n$$\n直接数值应用该指数算符是不可行的，因为动能算符 $\\hat{H}_T$ 和势能算符 $\\hat{H}_V$ 不对易，即 $[\\hat{H}_T, \\hat{H}_V] \\neq 0$。这种非对易性阻止了简单的分解 $e^{-i(\\hat{H}_T + \\hat{H}_V)\\Delta t} = e^{-i\\hat{H}_T\\Delta t} e^{-i\\hat{H}_V\\Delta t}$。\n\n为了解决这个问题，我们采用分裂算符法，该方法基于Trotter-Suzuki乘积公式。所要求的具体变体是二阶对称Strang分裂，它将小时间步长 $\\Delta t$ 的演化算符近似为：\n$$\n\\hat{U}(\\Delta t) = e^{-i(\\hat{H}_T + \\hat{H}_V)\\Delta t} \\approx e^{-i\\hat{H}_V\\Delta t/2} \\, e^{-i\\hat{H}_T\\Delta t} \\, e^{-i\\hat{H}_V\\Delta t/2}\n$$\n这个近似是幺正的，保持了波函数的范数，并且具有 $\\mathcal{O}(\\Delta t^3)$ 阶的局部误差。将系统演化总时间 $T$ 需要 $n = T/\\Delta t$ 步，导致全局误差为 $\\mathcal{O}(\\Delta t^2)$ 阶。这就是我们必须验证的标度行为。\n\n该方法的强大之处在于其实现方式。算符 $\\hat{H}_V$ 在位置表象中是对角的（其作用是简单地乘以函数 $V(x)$），而算符 $\\hat{H}_T$ 在动量表象中是对角的。快速傅里叶变换（FFT）提供了一种在位置表象和动量表象之间高效转换波函数的数值方法。\n\n设波函数在一个由 $N$ 个点 $\\{x_j\\}$ 组成的离散空间网格上表示，网格间距为 $\\Delta x = L/N$。相应的动量（波数）网格 $\\{k_j\\}$ 由离散傅里叶变换的性质确定。将波函数 $\\psi(x)$ 演化一个时间步长 $\\Delta t$ 的算法如下：\n\n1.  **第一步势能半步演化**：波函数处于位置表示。我们应用第一部分势能传播算符，这是一个简单的乘法操作：\n    $$\n    \\psi(x_j, t + \\Delta t/2) = e^{-iV(x_j)\\Delta t/2} \\psi(x_j, t)\n    $$\n    对于指定的谐振子势，$V(x) = \\frac{1}{2}\\omega^2 x^2$。\n\n2.  **动能全步演化**：为了应用动能传播算符，我们使用FFT将波函数变换到动量表示：\n    $$\n    \\tilde{\\psi}(k_j, t + \\Delta t/2) = \\mathcal{F}[\\psi(x_j, t + \\Delta t/2)]\n    $$\n    在动量空间中，算符 $\\hat{H}_T = \\hat{p}^2/2$ 变为乘以函数 $k^2/2$（因为在我们的单位中 $p=k$）。因此，动能演化为：\n    $$\n    \\tilde{\\psi}(k_j, t + \\Delta t/2)_{\\text{after}} = e^{-ik_j^2\\Delta t/2} \\tilde{\\psi}(k_j, t + \\Delta t/2)\n    $$\n    然后使用逆FFT（iFFT）将波函数变换回位置表示：\n    $$\n    \\psi'(x_j, t + \\Delta t/2) = \\mathcal{F}^{-1}[\\tilde{\\psi}(k_j, t + \\Delta t/2)_{\\text{after}}]\n    $$\n\n3.  **第二步势能半步演化**：最后一步是在位置表示中应用第二部分势能传播算符：\n    $$\n    \\psi(x_j, t + \\Delta t) = e^{-iV(x_j)\\Delta t/2} \\psi'(x_j, t + \\Delta t/2)\n    $$\n\n这个三步序列将状态从 $t$ 推进到 $t + \\Delta t$。重复 $n = T/\\Delta t$ 次以达到最终时间 $T$。\n\n对于收敛性分析，我们使用量子谐振子的精确基态作为初始态，$\\psi(x,0) = \\psi_0(x)$。这是哈密顿量的一个本征态，能量为 $E_0 = \\omega/2$。因此，精确的时间演化态是解析已知的：\n$$\n\\psi_{\\text{exact}}(x,t) = \\psi_0(x) \\, e^{-iE_0 t}\n$$\n在最终时间 $T$ 获得数值解 $\\psi_{\\text{num}}(x_j, T)$ 后，我们计算离散 $L^2$ 误差：\n$$\nE(\\Delta t) = \\left(\\sum_{j=0}^{N-1} |\\psi_{\\text{num}}(x_j, T) - \\psi_{\\text{exact}}(x_j, T)|^2 \\Delta x\\right)^{1/2}\n$$\n收敛阶数通过分析关系 $E(\\Delta t) \\propto (\\Delta t)^s$ 来确定。在对数尺度下，这变为 $\\log E = s \\log \\Delta t + C$，这是一个线性关系。我们对 $(\\log \\Delta t, \\log E)$ 数据点进行线性回归，以找到斜率 $s$，其值应约等于 $2$。此外，对于一个 $s$ 阶方法，连续步长的误差比 $E(\\Delta t) / E(\\Delta t/2)$ 应趋近于 $2^s$。当 $s=2$ 时，该比值为 $4$。\n\n因此，计算过程如下：对于每个测试用例，我们设置空间网格，定义并归一化初始波函数，并预先计算在时间 $T$ 的精确解。然后，我们遍历指定的时间步长列表 $\\Delta t$。对于每个 $\\Delta t$，我们运行分裂算符模拟并计算最终误差 $E(\\Delta t)$。最后，我们使用收集到的误差数据计算所需的斜率和误差比。整个过程被封装在提供的Python代码中。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef run_simulation(omega, L, N, T, delta_t_list):\n    \"\"\"\n    Runs a simulation for a given set of parameters and returns the error analysis.\n\n    Args:\n        omega (float): Angular frequency of the harmonic oscillator.\n        L (float): Length of the spatial domain.\n        N (int): Number of grid points.\n        T (float): Total propagation time.\n        delta_t_list (list of float): List of time steps for the convergence study.\n\n    Returns:\n        tuple: A tuple containing the fitted slope (float) and a list of error ratios (list of float).\n    \"\"\"\n\n    # 1. Setup spatial and momentum grids\n    dx = L / N\n    x = -L / 2 + np.arange(N) * dx\n    k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # 2. Define initial and exact final wavefunctions\n    # The initial state is the analytic ground state of the harmonic oscillator.\n    # We ensure it is a complex array for subsequent calculations.\n    psi0_analytic = ((omega / np.pi)**0.25 * np.exp(-omega * x**2 / 2)).astype(np.complex128)\n\n    # Numerically normalize the initial state on the discrete grid.\n    norm_factor = np.sqrt(np.sum(np.abs(psi0_analytic)**2) * dx)\n    psi0 = psi0_analytic / norm_factor\n\n    # The exact state at time T is the initial state multiplied by a phase factor.\n    # We use the numerically normalized psi0 for consistency.\n    E0 = omega / 2\n    psi_exact_T = psi0 * np.exp(-1j * E0 * T)\n\n    errors = []\n    \n    # Define the potential energy operator V(x)\n    V = 0.5 * omega**2 * x**2\n\n    # 3. Time evolution loop for each delta_t\n    for dt in delta_t_list:\n        n_steps = int(round(T / dt))\n        psi_current = psi0.copy()\n        \n        # Pre-compute time-evolution operators for this dt\n        exp_V_half = np.exp(-1j * V * dt / 2)\n        exp_T_full = np.exp(-1j * k**2 * dt / 2)\n        \n        for _ in range(n_steps):\n            # Apply first potential half-step in position space\n            psi_current *= exp_V_half\n            \n            # Apply kinetic full-step in momentum space\n            psi_k = np.fft.fft(psi_current)\n            psi_k *= exp_T_full\n            psi_current = np.fft.ifft(psi_k)\n            \n            # Apply second potential half-step in position space\n            psi_current *= exp_V_half\n            \n        # 4. Compute L2 error\n        error = np.sqrt(np.sum(np.abs(psi_current - psi_exact_T)**2) * dx)\n        errors.append(error)\n\n    # 5. Analyze error scaling\n    log_dt = np.log(delta_t_list)\n    log_E = np.log(errors)\n    \n    # Fit a line to log(E) vs log(dt) to find the slope\n    slope, _, _, _, _ = linregress(log_dt, log_E)\n    \n    # Compute successive error ratios\n    ratios = [errors[i] / errors[i+1] for i in range(len(errors) - 1)]\n    \n    return slope, ratios\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final results.\n    \"\"\"\n    \n    # Common Parameters\n    L = 20.0\n    N = 4096\n    delta_t_list = [0.2, 0.1, 0.05, 0.025]\n\n    # Test Case 1: General case\n    omega1 = 1.0\n    T1 = 1.0\n    s1, ratios1 = run_simulation(omega1, L, N, T1, delta_t_list)\n    r1a, r1b, r1c = ratios1[0], ratios1[1], ratios1[2]\n    \n    # Test Case 2: Stronger confinement\n    omega2 = 2.0\n    T2 = 1.0\n    s2, _ = run_simulation(omega2, L, N, T2, delta_t_list)\n\n    # Test Case 3: Longer time\n    omega3 = 1.0\n    T3 = 2.0\n    s3, _ = run_simulation(omega3, L, N, T3, delta_t_list)\n    \n    # Consolidate and format results\n    results = [s1, r1a, r1b, r1c, s2, s3]\n    formatted_results = [f\"{num:.6f}\" for num in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2857777"}]}