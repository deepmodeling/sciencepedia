{"hands_on_practices": [{"introduction": "宏观弹性是原子间相互作用在平衡位置处势能阱曲率的直接体现。通过这个练习，我们将从第一性原理出发，推导块体模量与原子间对势之间的关系，从而将这一抽象概念具体化。通过比较两种常见的势函数模型，我们将揭示即使在势阱深度和平衡位置相同的情况下，势函数形状的细微差异也如何决定材料的宏观刚度。", "problem": "一个单原子面心立方（fcc）晶体由一个中心对势建模，其中只有最近邻相互作用对内聚能有贡献。考虑了两种备选的原子间势：\n\n1) Lennard-Jones 势，由 $U_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$ 给出。\n\n2) Morse 势，由 $U_{\\mathrm{M}}(r) = D \\left\\{ \\left[ 1 - \\exp\\left( -\\alpha (r - r_{0}) \\right) \\right]^{2} - 1 \\right\\}$ 给出。\n\n假设以下模型选择：\n- 内聚能阱深度相匹配：$D = \\epsilon$。\n- 通过选择 Morse 参数 $r_{0}$ 等于 Lennard-Jones 的平衡间距，来匹配平衡最近邻距离。\n- 假设零温和静水加载条件。fcc 配位数为 $z=12$，最近邻距离 $r$ 与立方晶格参数 $a$ 的关系为 $r = a/\\sqrt{2}$，每原子体积为 $\\Omega = a^{3}/4$。\n\n从第一性原理出发，仅使用以下标准基础：牛顿力学、应变的定义、能量的对加性以及体积模量 $B$ 的热力学定义（即能量对体积在平衡状态下的二阶导数）。按以下步骤进行：\n- 确定使 $U_{\\mathrm{LJ}}(r)$ 最小化的平衡间距 $r_{\\mathrm{LJ}}$。\n- 计算它们各自最小值点的曲率 $U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}})$ 和 $U_{\\mathrm{M}}''(r_{0})$。\n- 在所述的最近邻近似下，推导 fcc 晶体的体积模量 $B$，用平衡最近邻距离处的对势曲率和晶格几何结构表示。\n- 使用匹配深度和匹配距离的条件，确定比率 $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$，并将其表示为仅包含参数 $\\alpha$ 和 $\\sigma$ 的封闭形式解析表达式。\n\n请将你的最终答案以比率 $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$ 的单个封闭形式解析表达式给出。最终的方框答案中不要包含单位。", "solution": "该问题要求确定一个分别用 Lennard-Jones (LJ) 和 Morse (M) 对势建模的面心立方（fcc）晶体的体积模量之比 $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$。分析将从第一性原理出发，在最近邻相互作用近似下进行。\n\n首先，给定的原子间势为：\nLennard-Jones 势：$U_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$。\nMorse 势：$U_{\\mathrm{M}}(r) = D \\left\\{ \\left[ 1 - \\exp\\left( -\\alpha (r - r_{0}) \\right) \\right]^{2} - 1 \\right\\}$。\n\n问题指明了以下匹配条件：势阱深度相等，$D = \\epsilon$，并且 Morse 势的平衡间距 $r_{0}$ 被设置为 LJ 势的平衡间距，我们记为 $r_{\\mathrm{LJ}}$。\n\n解题过程按要求分为四个阶段：\n1.  确定 Lennard-Jones 势的平衡间距 $r_{\\mathrm{LJ}}$。\n2.  计算两种势在各自平衡间距处的二阶导数（曲率）$U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}})$ 和 $U_{\\mathrm{M}}''(r_{0})$。\n3.  在最近邻近似下，推导 fcc 晶体体积模量 $B$ 的通用表达式。\n4.  结合这些结果求出比率 $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$。\n\n**步骤 1：Lennard-Jones 势的平衡间距**\n\n平衡间距 $r_{\\mathrm{LJ}}$ 是使势能 $U_{\\mathrm{LJ}}(r)$ 最小化的原子间距离。这可以通过将势对 $r$ 的一阶导数设为零来找到。\n$$ \\frac{dU_{\\mathrm{LJ}}}{dr} = 4 \\epsilon \\left[ \\sigma^{12}(-12)r^{-13} - \\sigma^{6}(-6)r^{-7} \\right] $$\n令 $\\frac{dU_{\\mathrm{LJ}}}{dr} = 0$：\n$$ 4 \\epsilon \\left[ -12 \\frac{\\sigma^{12}}{r^{13}} + 6 \\frac{\\sigma^{6}}{r^{7}} \\right] = 0 $$\n$$ 6 \\frac{\\sigma^{6}}{r^{7}} = 12 \\frac{\\sigma^{12}}{r^{13}} $$\n这可以简化为 $r^{6} = 2\\sigma^{6}$，从而得到平衡间距：\n$$ r_{\\mathrm{LJ}} = 2^{1/6} \\sigma $$\n\n**步骤 2：平衡位置处势的曲率**\n\n首先，我们求 Lennard-Jones 势的二阶导数 $U_{\\mathrm{LJ}}''(r)$。\n$$ U_{\\mathrm{LJ}}''(r) = \\frac{d^2 U_{\\mathrm{LJ}}}{dr^2} = 4 \\epsilon \\left[ (-12)(-13)\\sigma^{12}r^{-14} - (6)(-7)\\sigma^{6}r^{-8} \\right] $$\n$$ U_{\\mathrm{LJ}}''(r) = 4 \\epsilon \\left[ 156 \\frac{\\sigma^{12}}{r^{14}} - 42 \\frac{\\sigma^{6}}{r^{8}} \\right] $$\n我们在 $r = r_{\\mathrm{LJ}} = 2^{1/6} \\sigma$ 处计算该值。在此距离处，我们有关系式 $r_{\\mathrm{LJ}}^{6} = 2\\sigma^{6}$ 和 $r_{\\mathrm{LJ}}^{12} = 4\\sigma^{12}$。\n$$ U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}}) = \\frac{4\\epsilon}{r_{\\mathrm{LJ}}^{2}} \\left[ 156 \\frac{\\sigma^{12}}{r_{\\mathrm{LJ}}^{12}} - 42 \\frac{\\sigma^{6}}{r_{\\mathrm{LJ}}^{6}} \\right] = \\frac{4\\epsilon}{(2^{1/6}\\sigma)^{2}} \\left[ 156 \\left(\\frac{1}{4}\\right) - 42 \\left(\\frac{1}{2}\\right) \\right] $$\n$$ U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}}) = \\frac{4\\epsilon}{2^{1/3}\\sigma^{2}} \\left[ 39 - 21 \\right] = \\frac{4\\epsilon(18)}{2^{1/3}\\sigma^{2}} = \\frac{72\\epsilon}{2^{1/3}\\sigma^{2}} $$\n\n接下来，我们求 Morse 势的二阶导数 $U_{\\mathrm{M}}''(r)$。其一阶导数为：\n$$ U_{\\mathrm{M}}'(r) = D \\cdot 2\\left[1 - \\exp\\left(-\\alpha(r-r_0)\\right)\\right] \\cdot \\left( \\alpha \\exp\\left(-\\alpha(r-r_0)\\right) \\right) $$\n$$ U_{\\mathrm{M}}'(r) = 2D\\alpha \\left[ \\exp\\left(-\\alpha(r-r_0)\\right) - \\exp\\left(-2\\alpha(r-r_0)\\right) \\right] $$\n二阶导数为：\n$$ U_{\\mathrm{M}}''(r) = 2D\\alpha \\left[ -\\alpha\\exp\\left(-\\alpha(r-r_0)\\right) - (-2\\alpha)\\exp\\left(-2\\alpha(r-r_0)\\right) \\right] $$\n$$ U_{\\mathrm{M}}''(r) = 2D\\alpha^{2} \\left[ -\\exp\\left(-\\alpha(r-r_0)\\right) + 2\\exp\\left(-2\\alpha(r-r_0)\\right) \\right] $$\nMorse 势的平衡间距在 $r=r_0$ 处。在该点计算曲率：\n$$ U_{\\mathrm{M}}''(r_0) = 2D\\alpha^{2} \\left[ -\\exp(0) + 2\\exp(0) \\right] = 2D\\alpha^{2} \\left[ -1 + 2 \\right] = 2D\\alpha^{2} $$\n\n**步骤 3：体积模量的推导**\n\n在最近邻模型中，每个原子的总能量 $E$ 为 $E = \\frac{1}{2}z U(r)$，其中 $z$ 是配位数。对于 fcc 晶格，$z=12$，所以 $E(r) = 6U(r)$。零温下的体积模量定义为 $B = \\Omega_0 \\left( \\frac{d^2 E}{d\\Omega^2} \\right)_{\\Omega=\\Omega_0}$，其中 $\\Omega$ 是每原子体积，$\\Omega_0$ 是平衡时的每原子体积。\n\n对于 fcc 晶格，最近邻距离 $r$ 与立方晶格参数 $a$ 的关系为 $r=a/\\sqrt{2}$。每原子体积为 $\\Omega = a^3/4$。我们用 $r$ 来表示 $\\Omega$：\n$$ a = r\\sqrt{2} \\implies \\Omega(r) = \\frac{(r\\sqrt{2})^3}{4} = \\frac{2\\sqrt{2}r^3}{4} = \\frac{r^3}{\\sqrt{2}} $$\n现在我们使用链式法则计算导数。\n$$ \\frac{dE}{d\\Omega} = \\frac{dE/dr}{d\\Omega/dr} = \\frac{6 U'(r)}{3r^2/\\sqrt{2}} = \\frac{2\\sqrt{2}U'(r)}{r^2} $$\n二阶导数为：\n$$ \\frac{d^2E}{d\\Omega^2} = \\frac{d}{d\\Omega}\\left( \\frac{dE}{d\\Omega} \\right) = \\frac{d/dr(dE/d\\Omega)}{d\\Omega/dr} = \\frac{\\frac{d}{dr}\\left(\\frac{2\\sqrt{2}U'(r)}{r^2}\\right)}{3r^2/\\sqrt{2}} $$\n$$ \\frac{d^2E}{d\\Omega^2} = \\frac{2\\sqrt{2} \\left( \\frac{U''(r)r^2 - 2rU'(r)}{r^4} \\right)}{3r^2/\\sqrt{2}} = \\frac{4}{3r^5} \\left( rU''(r) - 2U'(r) \\right) $$\n在平衡时，$r=r_e$，势的一阶导数为零，$U'(r_e)=0$。因此，表达式简化为：\n$$ \\left( \\frac{d^2E}{d\\Omega^2} \\right)_{\\Omega_0} = \\frac{4}{3r_e^5} \\left( r_e U''(r_e) \\right) = \\frac{4U''(r_e)}{3r_e^4} $$\n平衡体积为 $\\Omega_0 = r_e^3/\\sqrt{2}$。代入 $B$ 的定义中：\n$$ B = \\Omega_0 \\left( \\frac{d^2E}{d\\Omega^2} \\right)_{\\Omega_0} = \\frac{r_e^3}{\\sqrt{2}} \\cdot \\frac{4U''(r_e)}{3r_e^4} = \\frac{4U''(r_e)}{3\\sqrt{2}r_e} = \\frac{2\\sqrt{2}U''(r_e)}{3r_e} $$\n\n**步骤 4：体积模量之比**\n\n使用推导出的 $B$ 的表达式，比率 $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$ 为：\n$$ \\frac{B_{\\mathrm{LJ}}}{B_{\\mathrm{M}}} = \\frac{ \\frac{2\\sqrt{2}U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}})}{3r_{\\mathrm{LJ}}} }{ \\frac{2\\sqrt{2}U_{\\mathrm{M}}''(r_{0})}{3r_{0}} } $$\n根据条件 $r_{\\mathrm{LJ}} = r_{0}$，几何因子相消，该比率简化为势曲率之比：\n$$ \\frac{B_{\\mathrm{LJ}}}{B_{\\mathrm{M}}} = \\frac{U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}})}{U_{\\mathrm{M}}''(r_{0})} $$\n代入计算出的曲率并使用条件 $D = \\epsilon$：\n$$ U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}}) = \\frac{72\\epsilon}{2^{1/3}\\sigma^{2}} $$\n$$ U_{\\mathrm{M}}''(r_0) = 2D\\alpha^2 = 2\\epsilon\\alpha^2 $$\n因此，该比率为：\n$$ \\frac{B_{\\mathrm{LJ}}}{B_{\\mathrm{M}}} = \\frac{ \\frac{72\\epsilon}{2^{1/3}\\sigma^{2}} }{ 2\\epsilon\\alpha^2 } = \\frac{72}{2 \\cdot 2^{1/3} \\alpha^2 \\sigma^2} = \\frac{36}{2^{1/3} \\alpha^2 \\sigma^2} $$\n这就是用指定的参数 $\\alpha$ 和 $\\sigma$ 表示该比率的最终解析表达式。", "answer": "$$\\boxed{\\frac{36}{2^{1/3} \\alpha^{2} \\sigma^{2}}}$$", "id": "2765203"}, {"introduction": "掌握了基本原理后，我们转向如何在高保真度的第一性原理计算中应用这些思想。虽然原理（计算能量对数应变的二阶导数）保持不变，但在密度泛函理论(DFT)等现代计算方法中的实际操作充满了数值上的挑战。这项实践旨在引导您批判性地思考为获得精确可靠的弹性常数所必需的方法论选择，例如计算方法的稳定性以及各项收敛性参数的设置。", "problem": "一种单原子面心立方金属在周期性边界条件下，使用平面波密度泛函理论进行建模。目标是从有限形变中提取零应变附近的二阶弹性常数。您将只考虑均匀形变，并专注于提取体积模量和一个剪切模量。该材料是金属性的，因此需要进行布里渊区采样。目标精度是使每个报告的弹性常数的绝对误差低于 $2\\,\\mathrm{GPa}$。平衡态下的原子体积为每个原子 $V_0 = 16\\,\\mathrm{\\AA}^3$。您可以假设对于所有考虑的应变，内部坐标都由对称性固定；计算是在零温下进行的静态计算；并且整个过程中使用相同的赝势。\n\n提出了四种方法策略，每种策略都指定了应变大小、用于拟合的可观测量以及数值参数的收敛标准。基于第一性原理以及关于弹性力学和电子结构收敛性的经过充分检验的事实，确定哪种策略足以确保提取的弹性常数的总误差保持在 $2\\,\\mathrm{GPa}$ 以下。\n\nA. 使用总能-应变拟合，采用中心有限差分法，应变为 $\\varepsilon = \\{-0.005, 0, +0.005\\}$。在每个应变下，通过增加平面波截断能并使用一个 $12\\times 12\\times 12$ 的 Monkhorst–Pack $k$ 点网格（电子展宽为 $0.2\\,\\mathrm{eV}$），将总能收敛到 $0.1\\,\\mathrm{meV}$/原子以内。在不同应变下保持 $k$ 点网格不变。当连续增加平面波截断能导致总能变化小于 $0.1\\,\\mathrm{meV}$/原子时，接受该模量。\n\nB. 对静水压力和适当的保持对称性的剪切形变，使用应力-应变拟合，采用中心有限差分法，应变为 $\\varepsilon = \\{-0.005, 0, +0.005\\}$。对于每个应变，收敛应力张量分量，使得在 (i) 将 $k$ 点网格密度加倍（同时在应变下保持倒易空间中的 $k$ 点间距不变）和 (ii) 将平面波截断能增加 $20\\%$ 时，每个相关应力分量的变化小于 $10\\,\\mathrm{MPa}$。通过增加截断能直到零应变下的应力变化小于 $5\\,\\mathrm{MPa}$，确保零应变下的绝对 Pulay 应力低于 $5\\,\\mathrm{MPa}$。通过在 $\\varepsilon \\in [0.003, 0.008]$ 范围内进行拟合，并要求在该范围内改变拟合窗口时，拟合出的模量变化不超过 $1\\,\\mathrm{GPa}$，来验证谐波性。使用原胞，但在所有应变晶胞中保持近似恒定的 $k$ 点间距 $\\Delta k \\le 0.02\\,\\mathrm{\\AA}^{-1}$。\n\nC. 使用总能-应变拟合，采用中心有限差分法，应变为 $\\varepsilon = \\{-0.02, 0, +0.02\\}$。在每个应变下将总能收敛到 $1\\,\\mathrm{meV}$/原子以内。用 $4\\times 4\\times 4$ 超胞上的 $\\Gamma$ 点计算代替密集的 $k$ 点网格以减少布里渊区积分误差；一旦将超胞增加到 $5\\times 5\\times 5$ 导致三个应变下的总能变化小于 $1\\,\\mathrm{meV}$/原子，则接受该模量。当将截断能增加 $20\\%$ 时总能变化小于 $1\\,\\mathrm{meV}$/原子后，保持平面波截断能固定。\n\nD. 使用应力-应变拟合，采用中心有限差分法，应变为 $\\varepsilon = \\{-0.001, 0, +0.001\\}$。通过增加平面波截断能直到 $0$ 和 $0.1\\%$ 应变之间的总能差收敛到 $0.5\\,\\mathrm{meV}$/原子以内，并使用倒易空间间距为 $\\Delta k \\le 0.05\\,\\mathrm{\\AA}^{-1}$ 的 $k$ 点网格，将应力收敛到 $100\\,\\mathrm{MPa}$ 以内。当满足这些标准时，接受该模量。\n\n哪一个/些选项为这个金屬体系提供了定量上充分且科学上稳健的方案，以满足弹性常数低于 $2\\,\\mathrm{GPa}$ 的误差目标？\n\nA. 策略 A\n\nB. 策略 B\n\nC. 策略 C\n\nD. 策略 D", "solution": "题目要求评估四种不同的计算策略，这些策略用于使用平面波密度泛函理论 (DFT) 确定单原子面心立方 (FCC) 金属的弹性常数。目标是使体积模量和剪切模量的绝对误差低于 $2\\,\\mathrm{GPa}$。每种策略的有效性必须根据固态物理的既定原理和电子结构计算中的数值分析来判断。\n\n首先，让我们建立基本关系和数值要求。二阶弹性常数 $C_{ijkl}$ 可以通过总能 $E$ 对拉格朗日应变张量 $\\eta$ 的二阶导数计算，也可以通过第二 Piola-Kirchhoff 应力张量 $S$ 对形变的一阶导数计算：\n$$\nC_{ijkl} = \\frac{1}{V_0} \\frac{\\partial^2 E}{\\partial \\eta_{ij} \\partial \\eta_{kl}} \\bigg|_{\\eta=0} \\quad \\text{或} \\quad C_{ijkl} = \\frac{\\partial S_{ij}}{\\partial \\eta_{kl}} \\bigg|_{\\eta=0}\n$$\n其中 $V_0$ 是每个原子的平衡体积。对于小应变，不同应变和应力度量之间的区别可以忽略不计，因此我们可以使用工程应变 $\\varepsilon$ 和柯西应力 $\\sigma$。\n\n我们必须估计计算出的可观测量（能量或应力）所需的数值精度，以满足 $\\Delta C  2\\,\\mathrm{GPa}$ 的目标精度。我们将分析一种中心有限差分方案。\n\n对于使用应变 $\\pm\\varepsilon$ 的基于能量的方法：\n$C \\approx \\frac{1}{V_0} \\frac{E(+\\varepsilon) - 2E(0) + E(-\\varepsilon)}{\\varepsilon^2}$。\n分子中能量组合所需的精度为 $\\Delta(E_{\\text{num}}) \\approx V_0 \\cdot \\Delta C \\cdot \\varepsilon^2$。给定 $V_0 = 16\\,\\mathrm{\\AA}^3 = 1.6 \\times 10^{-29}\\,\\mathrm{m}^3$ 和 $\\Delta C = 2\\,\\mathrm{GPa} = 2 \\times 10^9\\,\\mathrm{N}/\\mathrm{m}^2$：\n如果 $\\varepsilon = 0.005$，$\\Delta(E_{\\text{num}}) \\approx (1.6 \\times 10^{-29}) \\cdot (2 \\times 10^9) \\cdot (0.005)^2 = 8 \\times 10^{-22}\\,\\mathrm{J}$。\n转换为每个原子的电子伏特：$(8 \\times 10^{-22}\\,\\mathrm{J}) / (1.602 \\times 10^{-19}\\,\\mathrm{J/eV}) \\approx 0.005\\,\\mathrm{eV}/\\text{atom} = 5 \\times 10^{-3}\\,\\mathrm{meV}/\\text{atom}$。这是对能量差一个极其苛刻的精度要求。如果三次能量计算的误差不相关，那么单次能量计算的精度必须更高。\n\n对于使用应变 $\\pm\\varepsilon$ 的基于应力的方法：\n$C \\approx \\frac{\\sigma(+\\varepsilon) - \\sigma(-\\varepsilon)}{2\\varepsilon}$。\n应力差所需的精度为 $\\Delta(\\sigma_{\\text{num}}) \\approx 2\\varepsilon \\cdot \\Delta C$。\n如果 $\\varepsilon = 0.005$，$\\Delta(\\sigma_{\\text{num}}) \\approx 2 \\cdot (0.005) \\cdot (2\\,\\mathrm{GPa}) = 0.02\\,\\mathrm{GPa} = 20\\,\\mathrm{MPa}$。\n如果两次应力计算的误差不相关，则每个应力张量分量所需的精度约为 $20\\,\\mathrm{MPa} / \\sqrt{2} \\approx 14\\,\\mathrm{MPa}$。在标准的DFT代码中，这是一个严格但可以实现的目标。\n\n现在我们评估每种提议的策略。\n\n**策略A的分析**\n该策略在 $\\varepsilon = \\pm 0.005$ 下使用总能-应变拟合。\n- **收敛性：** 指定的能量收敛容差为 $0.1\\,\\mathrm{meV}$/原子。如上所述，有限差分分子所需的精度约为 $0.005\\,\\mathrm{meV}$/原子。每次能量计算 $0.1\\,\\mathrm{meV}$/原子的容差是不够的，至少相差20倍。\n- **$k$点网格：** 它提议对所有应变使用固定的 $12\\times 12\\times 12$ Monkhorst-Pack 网格。当实空间晶格发生应变时，倒易晶格矢量也会相应变形。固定的指数网格 $(n_1, n_2, n_3)$ 会在每个应变下对布里渊区中物理上不同的位置进行采样。对于具有尖锐费米面的金属，这种采样变化会引入系统误差，通常称为费米面误差的“呼吸效应”，这种误差在能量差中不会抵消。这是高精度计算的一个重大缺陷。\n- **电子展宽：** $0.2\\,\\mathrm{eV}$ 的展宽值相当大（对应于虚拟温度 $k_B T \\approx 0.2\\,\\mathrm{eV}$，或 $T \\approx 2300\\,\\mathrm{K}$），并且会影响最终结果。虽然它有助于收敛，但为了获得高精度，结果应该外推到零展宽，或者应该使用更小的展宽值。\n- **对A的判决：** 能量收敛标准过于宽松，无法达到目标精度，并且对于应变下的金属体系使用固定的 $k$ 点网格在高精度研究中是不正确的。策略A是**不正确的**。\n\n**策略B的分析**\n该策略在 $\\varepsilon = \\pm 0.005$ 下使用应力-应变拟合。\n- **方法：** 应力-应变方法通常比能量-应变方法对数值噪声更具鲁棒性。所选的应变大小是合适的。\n- **收敛性：** 应力收敛标准是 $ 10\\,\\mathrm{MPa}$。我们的估算表明每次计算需要大约 $14\\,\\mathrm{MPa}$ 的精度，因此 $10\\,\\mathrm{MPa}$ 的容差是适当且足以满足弹性常数 $2\\,\\mathrm{GPa}$ 的目标。收敛性测试（将k点密度加倍，增加截断能）是标准且稳健的。\n- **Pulay应力：** 该策略明确处理了Pulay应力，这是一种有限基组误差，直接影响计算出的应力张量。通过收敛平面波截断能，要求零应变下的残余应力低于 $5\\,\\mathrm{MPa}$，是极好的做法，对于精确的应力-应变计算至关重要。\n- **$k$点网格：** 它要求在所有应变晶胞中保持恒定的 $k$ 点间距（$\\Delta k \\le 0.02\\,\\mathrm{\\AA}^{-1}$）。这是避免因布里渊区采样不一致而产生误差的正确程序。网格会针对每个应变晶胞进行调整，以确保采样密度保持恒定，这对金属至关重要。指定的密度非常高，表明这是一次高质量的计算。\n- **谐波性检查：** 通过检查拟合模量在一系列应变范围内的稳定性来验证谐波性的提议，是一个关键的自洽性检查。它确保所选的应变 $\\varepsilon = \\pm 0.005$ 适当地处于线弹性区域，并且没有受到非谐（高阶）效应的污染。\n- **对B的判决：** 该策略在科学上和数值上都是合理的。它采用了更稳定的方法，使用了适当且定量上充分的收敛标准，正确处理了所有主要的数值误差来源（Pulay应力，布里渊区采样），并包含了一个验证步骤。该方案是充分的。策略B是**正确的**。\n\n**策略C的分析**\n该策略在 $\\varepsilon = \\pm 0.02$ 下使用总能-应变拟合。\n- **应变大小：** $\\varepsilon = \\pm 2\\%$ 的应变非常大。对于大多数金属，这个大小远超出了定义二阶弹性常数的谐波区域。对 $0$ 和 $\\pm 2\\%$ 应变下的能量点进行抛物线拟合将得到一个有效的割线模量，而不是零应变下的真实二阶切线模量。这是一个根本性的缺陷。\n- **$k$点网格：** 它提议在 $4\\times 4\\times 4$ 超胞中使用 $\\Gamma$ 点计算。这相当于在粗糙的 $4\\times 4\\times 4$ Monkhorst-Pack 网格上对原胞的布里渊区进行采样。对于金属而言，如此稀疏的采样对于收敛总能是完全不够的，更不用说计算弹性常数所需的微小能量差了。使用 $1\\,\\mathrm{meV}$/原子的容差进行收敛测试（将超胞增加到 $5\\times 5\\times 5$）也过于宽松。\n- **收敛性：** $1\\,\\mathrm{meV}$/原子的能量收敛容差比策略A中的更不严格，并且完全不够。在 $\\varepsilon = 0.02$ 的应变下，所需的能量精度为 $\\Delta(E_{\\text{num}}) \\approx 0.08\\,\\mathrm{meV}/\\text{atom}$，这使得 $1\\,\\mathrm{meV}$ 的容差相差了一个数量级以上。\n- **对C的判决：** 该策略在多个基本点上存在缺陷：应变过大，对金属而言 $k$ 点采样不足，能量收敛性也不够。策略C是**不正确的**。\n\n**策略D的分析**\n该策略在 $\\varepsilon = \\pm 0.001$ 下使用应力-应变拟合。\n- **应变大小：** $\\varepsilon = \\pm 0.1\\%$ 的应变非常小。虽然它保证了处于谐波区域，但也使计算对数值噪声极其敏感。要在 $C$ 上达到 $2\\,\\mathrm{GPa}$ 的精度，对应力差 $\\sigma(+\\varepsilon)-\\sigma(-\\varepsilon)$ 所需的精度为 $2\\varepsilon \\cdot \\Delta C = 2(0.001)(2\\,\\mathrm{GPa}) = 4\\,\\mathrm{MPa}$。这要求每次应力计算收敛到大约 $4/\\sqrt{2} \\approx 2.8\\,\\mathrm{MPa}$。\n- **收敛性：** 指定的应力收敛容差为 $100\\,\\mathrm{MPa}$。与所需的 $\\sim 3\\,\\mathrm{MPa}$ 相比，这是灾难性的不足。应力中 $100\\,\\mathrm{MPa}$ 的误差将转化为弹性常数中约 $\\Delta C \\approx \\Delta\\sigma / (2\\varepsilon) = (100\\,\\mathrm{MPa} \\cdot \\sqrt{2}) / (2 \\cdot 0.001) \\approx 70,000\\,\\mathrm{MPa} = 70\\,\\mathrm{GPa}$ 的误差。提议的收敛标准完全不充分。涉及能量差的复杂标准也定义不清，并且与所陈述的应力容差不一致。\n- **$k$点网格：** $\\Delta k \\le 0.05\\,\\mathrm{\\AA}^{-1}$ 的倒易空间间距比策略B中的要粗糙得多，对于使用如此小应变所需的高精度可能是不够的。\n- **对D的判决：** 非常小的应变和非常宽松的应力收敛标准的组合使得该策略无法达到目标精度。主要误差将来自不良的应力收敛。策略D是**不正确的**。\n\n总之，只有策略B概述了一个完整、科学上严谨且定量上充分的方案，以达到所需的弹性常数精度。", "answer": "$$\\boxed{B}$$", "id": "2765156"}, {"introduction": "在学会如何计算弹性常数后，我们将探索如何应用它们来解决实际问题。连续介质弹性理论，例如经典的Eshelby夹杂问题，为我们理解纳米尺度特征（如沉淀相）周围的应力场和位移场提供了强大的分析框架。本练习将演示如何通过将原子模拟数据拟合到连续介质模型来连接不同尺度，从而提取如本征应变这样的关键物理参数。", "problem": "您必须编写一个完整的、可运行的程序，该程序在给定无限、线弹性、各向同性基体中一个共格球形纳米析出相周围的远场径向位移的合成原子尺度观测数据后，提取一个有效的均匀静水特征应变，并将根据连续介质Eshelby理论预测的弹性应变能与一个给定的实测弹性应变能进行比较。您的推导和算法必须从线性弹性力学的基础出发：小应变运动学、各向同性介质的胡克定律、力学平衡和球对称性。问题描述中不提供额外的简化公式。\n\n假设和物理设定：\n- 介质是无限、均匀、线弹性、各向同性的，其体积模量为 $K$，剪切模量为 $\\mu$。\n- 存在一个半径为 $a$ 的共格球形夹杂物，该夹杂物倾向于发生均匀的静水特征应变 $\\varepsilon^\\star$。\n- 在小应变条件下，位移场围绕夹杂物中心呈球对称。在夹杂物外部，远场位移是径向的，并随距离衰减。\n- 原子模拟提供了距离夹杂物足够远的径向位移观测值，这些观测值处于弹性远场区域内。\n- 使用标准的小应变张量定义 $\\varepsilon_{ij} = \\tfrac{1}{2}\\left(\\partial u_i/\\partial x_j + \\partial u_j/\\partial x_i\\right)$、使用拉梅常数 $(\\lambda, \\mu)$ 的各向同性胡克定律（其中 $K = \\lambda + \\tfrac{2}{3}\\mu$），以及无体力作用下的静力平衡条件。\n\n您的任务：\n1) 从基本原理出发，推导在均匀静水特征应变 $\\varepsilon^\\star$ 下，球形夹杂物外部的远场径向位移 $u_r(r)$ 的函数形式。然后设计一个线性最小二乘拟合方法，利用提供的远场原子尺度径向位移观测数据来估计夹杂物内部的有效均匀约束应变，并由此提取特征应变 $\\widehat{\\varepsilon}^\\star$ 的估计值。\n2) 使用相同的第一性原理框架，推导存储在基体加夹杂物系统中的总弹性应变能 $E_{\\text{pred}}$ 的闭合形式表达式，该表达式是夹杂物半径 $a$、弹性常数 $K$ 和 $\\mu$ 以及特征应变 $\\varepsilon^\\star$ 的函数。\n3) 实现一个算法，该算法能够：\n   - 将所有输入转换为一致的物理单位。\n   - 对远场位移观测数据进行线性最小二乘拟合，以提取 $\\widehat{\\varepsilon}^\\star$。\n   - 根据 $\\widehat{\\varepsilon}^\\star$ 计算预测的弹性应变能 $E_{\\text{pred}}$。\n   - 将 $E_{\\text{pred}}$ 与给定的实测（原子模拟）弹性应变能 $E_{\\text{meas}}$ 进行比较，当 $E_{\\text{meas}}  0$ 时，报告相对误差 $(E_{\\text{pred}} - E_{\\text{meas}})/E_{\\text{meas}}$。如果 $E_{\\text{meas}} = 0$，则报告绝对误差 $E_{\\text{pred}}$ 来代替相对误差。\n\n单位与数值要求：\n- 长度输入 $a$ 和 $r$ 以纳米（nm）为单位给出。在计算中转换为米（m）。\n- 位移 $u$ 以纳米（nm）为单位给出。在计算中转换为米（m）。\n- 弹性模量 $K$ 和 $\\mu$ 以吉帕斯卡（GPa）为单位给出。在计算中转换为帕斯卡（Pa）。\n- 预测和测量的能量必须以焦耳（J）表示。\n- 本问题不涉及角度。\n- 所有最终数值输出必须是浮点数。\n\n测试套件：\n为以下四个测试用例提供结果。在每个用例中，输入包括：\n- 体积模量 $K$，单位 GPa。\n- 剪切模量 $\\mu$，单位 GPa。\n- 夹杂物半径 $a$，单位 nm。\n- 采样半径列表 $[r_1, r_2, \\dots]$，单位 nm。\n- 从原子模拟中获得的相应远场径向位移列表 $[u_1, u_2, \\dots]$，单位 nm。\n- 实测的原子模拟弹性应变能 $E_{\\text{meas}}$，单位 J。\n\n情况 A (通用情况):\n- $K = 160$ GPa, $\\mu = 60$ GPa, $a = 2$ nm。\n- 半径 (nm): $[5, 6, 8, 10, 12]$。\n- 位移 (nm): $[0.0043166667, 0.0029229630, 0.0016966667, 0.0010466667, 0.0007507407]$。\n- $E_{\\text{meas}} = 3.24816\\times 10^{-18}$ J。\n\n情况 B (较小的夹杂物和特征应变):\n- $K = 100$ GPa, $\\mu = 40$ GPa, $a = 1$ nm。\n- 半径 (nm): $[3, 4, 5, 6, 8]$。\n- 位移 (nm): $[0.00037231884, 0.00019380435, 0.00013043478, 0.00008557916, 0.00005595109]$。\n- $E_{\\text{meas}} = 1.606\\times 10^{-20}$ J。\n\n情况 C (边缘情况，接近零错配):\n- $K = 150$ GPa, $\\mu = 50$ GPa, $a = 2.5$ nm。\n- 半径 (nm): $[7, 9, 12, 15, 18]$。\n- 位移 (nm): $[0.00001, -0.000005, 0.000002, -0.000001, 0.0000005]$。\n- $E_{\\text{meas}} = 0$ J。对于此情况，报告绝对误差 $E_{\\text{pred}}$ 代替相对误差。\n\n情况 D (高体积/剪切模量比):\n- $K = 200$ GPa, $\\mu = 5$ GPa, $a = 3$ nm。\n- 半径 (nm): $[6, 9, 12, 15, 20]$。\n- 位移 (nm): $[0.00735806, 0.00317580, 0.00183312, 0.00115129, 0.000658226]$。\n- $E_{\\text{meas}} = 3.349\\times 10^{-19}$ J。\n\n计算细节和输出规范：\n- 通过将观测到的 $u_r(r)$ 与从第一性原理推导出的球对称性径向核函数进行回归，实现对标量约束应变参数的最小二乘拟合。然后，使用您从基本原理推导出的关系，将约束应变映射到特征应变估计值 $\\widehat{\\varepsilon}^\\star$。\n- 使用您推导出的闭合形式能量公式计算 $E_{\\text{pred}}$。\n- 您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表形式的结果：\n  - 对每个用例，输出 $[\\widehat{\\varepsilon}^\\star, E_{\\text{pred}}, E_{\\text{meas}}, \\text{err}]$，其中当 $E_{\\text{meas}}  0$ 时，$\\text{err}$ 是相对误差 $(E_{\\text{pred}} - E_{\\text{meas}})/E_{\\text{meas}}$；当 $E_{\\text{meas}} = 0$ 时，$\\text{err} = E_{\\text{pred}}$。\n  - 示例格式：$[[x_1,y_1,z_1,e_1],[x_2,y_2,z_2,e_2],[x_3,y_3,z_3,e_3],[x_4,y_4,z_4,e_4]]$，无空格。", "solution": "所述问题在科学上是合理的、适定的，并包含了完整解答所需的所有信息。这是连续介质微观力学中的一个标准问题，特别是球形几何下的Eshelby夹杂物问题。该问题是有效的，我将着手解决。\n\n解决方案需要从线性弹性力学基本原理出发进行两个主要推导，然后设计一个计算算法来处理给定的数据。\n\n**1. 远场径向位移的推导**\n\n问题涉及一个无限各向同性弹性基体中的球形夹杂物。由于几何的球对称性和特征应变的静水性质，所产生的位移场 $\\mathbf{u}$ 必须是纯径向的，并且仅依赖于距中心的距离 $r$，即 $\\mathbf{u} = u_r(r)\\mathbf{e}_r$。\n\n在球坐标系 $(r, \\theta, \\phi)$ 中，无穷小应变张量 $\\boldsymbol{\\varepsilon}$ 的非零分量是径向应变 $\\varepsilon_{rr}$ 和两个相等的环向应变 $\\varepsilon_{\\theta\\theta}$ 和 $\\varepsilon_{\\phi\\phi}$：\n$$\n\\varepsilon_{rr} = \\frac{d u_r}{d r} \\quad , \\quad \\varepsilon_{\\theta\\theta} = \\varepsilon_{\\phi\\phi} = \\frac{u_r}{r}\n$$\n\n对于各向同性线弹性材料，本构关系（胡克定律）将应力张量 $\\boldsymbol{\\sigma}$ 与弹性应变张量 $\\boldsymbol{\\varepsilon}^e$ 联系起来。使用拉梅常数 $(\\lambda, \\mu)$：\n$$\n\\sigma_{ij} = \\lambda \\delta_{ij} \\varepsilon^e_{kk} + 2\\mu \\varepsilon^e_{ij}\n$$\n其中 $\\varepsilon^e_{kk}$ 是弹性应变张量的迹，$\\delta_{ij}$ 是克罗内克δ符号。总应变 $\\boldsymbol{\\varepsilon}$ 是弹性应变和特征应变之和，$\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^e + \\boldsymbol{\\varepsilon}^\\star$。在基体中 ($r  a$)，特征应变为零，所以 $\\boldsymbol{\\varepsilon}^e = \\boldsymbol{\\varepsilon}$。\n\n在没有体力的情况下，力学平衡方程为 $\\nabla \\cdot \\boldsymbol{\\sigma} = 0$。对于球对称性，这简化为单个常微分方程：\n$$\n\\frac{d\\sigma_{rr}}{dr} + \\frac{2}{r}(\\sigma_{rr} - \\sigma_{\\theta\\theta}) = 0\n$$\n基体中的应力分量为：\n$$\n\\sigma_{rr} = \\lambda(\\varepsilon_{rr} + 2\\varepsilon_{\\theta\\theta}) + 2\\mu\\varepsilon_{rr} = (\\lambda + 2\\mu)\\frac{du_r}{dr} + 2\\lambda\\frac{u_r}{r}\n$$\n$$\n\\sigma_{\\theta\\theta} = \\lambda(\\varepsilon_{rr} + 2\\varepsilon_{\\theta\\theta}) + 2\\mu\\varepsilon_{\\theta\\theta} = \\lambda\\frac{du_r}{dr} + 2(\\lambda + \\mu)\\frac{u_r}{r}\n$$\n将这些代入平衡方程，得到球对称性的纳维-柯西方程：\n$$\n\\frac{d^2u_r}{dr^2} + \\frac{2}{r}\\frac{du_r}{dr} - \\frac{2u_r}{r^2} = 0\n$$\n这是一个通解形式为 $u_r(r) = C_1 r + C_2 r^{-2}$ 的柯西-欧拉方程，其中 $C_1$ 和 $C_2$ 是常数。\n\n基体的边界条件是：\n1.  位移在无穷远处必须趋于零：$u_r(r \\to \\infty) \\to 0$。这要求 $C_1 = 0$。\n因此，基体中的位移场形式为：\n$$\nu_r^{\\text{out}}(r) = C r^{-2}\n$$\n其中 $C$ 是一个待定常数。这就是远场位移的函数形式。\n\n为了确定 $C$，我们必须考虑夹杂物以及在 $r=a$ 处的界面条件。\n- **夹杂物内部 ($r \\le a$)**：应变是均匀且静水的，由对称性决定。设此约束应变为 $\\varepsilon^C$。产生此应变的位移场是 $u_r^{\\text{in}}(r) = \\varepsilon^C r$。\n- **在界面处 ($r=a$)**：\n    1.  位移必须连续：$u_r^{\\text{in}}(a) = u_r^{\\text{out}}(a)$。\n        $$\n        \\varepsilon^C a = C a^{-2} \\implies C = \\varepsilon^C a^3\n        $$\n    2.  径向应力必须连续：$\\sigma_{rr}^{\\text{in}}(a) = \\sigma_{rr}^{\\text{out}}(a)$。\n        -   内部应力与弹性应变 $\\boldsymbol{\\varepsilon}^{e, \\text{in}} = \\boldsymbol{\\varepsilon}^C - \\boldsymbol{\\varepsilon}^\\star = (\\varepsilon^C - \\varepsilon^\\star)\\mathbf{I}$ 有关。使用体积模量 $K = \\lambda + \\frac{2}{3}\\mu$，静水应力为 $\\sigma_{rr}^{\\text{in}} = 3K(\\varepsilon^C - \\varepsilon^\\star)$。\n        -   外部应力由 $u_r^{\\text{out}}(r) = C r^{-2}$ 得到：$\\sigma_{rr}^{\\text{out}}(r) = -4\\mu C r^{-3}$。\n        -   在 $r=a$ 处令两者相等：$3K(\\varepsilon^C - \\varepsilon^\\star) = -4\\mu C a^{-3}$。代入 $C = \\varepsilon^C a^3$：\n        $$\n        3K(\\varepsilon^C - \\varepsilon^\\star) = -4\\mu \\varepsilon^C \\implies (3K + 4\\mu)\\varepsilon^C = 3K\\varepsilon^\\star\n        $$\n        这给出了可测量的约束应变 $\\varepsilon^C$ 与潜在的特征应变 $\\varepsilon^\\star$ 之间的关系：\n        $$\n        \\varepsilon^C = \\frac{3K}{3K + 4\\mu} \\varepsilon^\\star \\quad \\text{或} \\quad \\varepsilon^\\star = \\frac{3K + 4\\mu}{3K} \\varepsilon^C\n        $$\n\n从位移数据 $(r_i, u_i)$ 找到特征应变 $\\widehat{\\varepsilon}^\\star$ 的算法如下：\n位移模型为 $u_r(r) = (\\varepsilon^C a^3) r^{-2}$。这是一个线性模型 $y = m x$，其中 $y = u_r$，$x = r^{-2}$，斜率 $m = \\varepsilon^C a^3$。无截距的线性最小二乘拟合给出最佳拟合斜率 $\\hat{m}$：\n$$\n\\hat{m} = \\frac{\\sum_i x_i y_i}{\\sum_i x_i^2} = \\frac{\\sum_i u_i r_i^{-2}}{\\sum_i r_i^{-4}}\n$$\n由此，我们估计约束应变 $\\widehat{\\varepsilon^C} = \\hat{m} / a^3$，并随后估计特征应变：\n$$\n\\widehat{\\varepsilon}^\\star = \\frac{3K + 4\\mu}{3K} \\widehat{\\varepsilon^C}\n$$\n\n**2. 总弹性应变能的推导**\n\n总弹性应变能 $E_{\\text{pred}}$ 是弹性应变能密度 $w = \\frac{1}{2}\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}^e$ 的体积分。该能量是储存在夹杂物内部的能量 ($E_{\\text{in}}$) 和储存在基体中的能量 ($E_{\\text{out}}$) 之和。\n\n- **夹杂物内部的能量 ($E_{\\text{in}}$)**：\n应力和弹性应变是均匀的：$\\sigma_{ij}^{\\text{in}} = 3K(\\varepsilon^C - \\varepsilon^\\star)\\delta_{ij}$ 和 $\\varepsilon_{ij}^{e, \\text{in}} = (\\varepsilon^C - \\varepsilon^\\star)\\delta_{ij}$。\n能量密度为 $w_{\\text{in}} = \\frac{1}{2}\\sum_{i,j} \\sigma_{ij}^{\\text{in}}\\varepsilon_{ij}^{e, \\text{in}} = \\frac{1}{2} \\cdot 3 \\cdot [3K(\\varepsilon^C - \\varepsilon^\\star)](\\varepsilon^C - \\varepsilon^\\star) = \\frac{9}{2}K(\\varepsilon^C - \\varepsilon^\\star)^2$。\n$E_{\\text{in}} = V_{\\text{in}} w_{\\text{in}} = (\\frac{4}{3}\\pi a^3) \\frac{9}{2}K(\\varepsilon^C - \\varepsilon^\\star)^2 = 6\\pi a^3 K(\\varepsilon^C - \\varepsilon^\\star)^2$。\n\n- **外部基体中的能量 ($E_{\\text{out}}$)**：\n位移为 $u_r(r) = C r^{-2}$，其中 $C=\\varepsilon^C a^3$。应变为 $\\varepsilon_{rr} = -2Cr^{-3}$ 和 $\\varepsilon_{\\theta\\theta} = \\varepsilon_{\\phi\\phi} = Cr^{-3}$。\n应力为 $\\sigma_{rr} = -4\\mu C r^{-3}$ 和 $\\sigma_{\\theta\\theta} = \\sigma_{\\phi\\phi} = 2\\mu C r^{-3}$。\n能量密度为 $w_{\\text{out}}(r) = \\frac{1}{2}(\\sigma_{rr}\\varepsilon_{rr} + 2\\sigma_{\\theta\\theta}\\varepsilon_{\\theta\\theta}) = \\frac{1}{2}[(-4\\mu C r^{-3})(-2Cr^{-3}) + 2(2\\mu C r^{-3})(Cr^{-3})] = 6\\mu C^2 r^{-6}$。\n$E_{\\text{out}} = \\int_a^\\infty w_{\\text{out}}(r) 4\\pi r^2 dr = \\int_a^\\infty 24\\pi \\mu C^2 r^{-4} dr = 24\\pi \\mu C^2 [-\\frac{r^{-3}}{3}]_a^\\infty = 8\\pi \\mu C^2 a^{-3}$。\n代入 $C=\\varepsilon^C a^3$，我们得到 $E_{\\text{out}} = 8\\pi\\mu a^3 (\\varepsilon^C)^2$。\n\n- **总能量 ($E_{\\text{pred}}$)**：\n$E_{\\text{pred}} = E_{\\text{in}} + E_{\\text{out}} = 6\\pi a^3 K(\\varepsilon^C - \\varepsilon^\\star)^2 + 8\\pi\\mu a^3 (\\varepsilon^C)^2$。\n使用关系式 $\\varepsilon^C = \\frac{3K}{3K+4\\mu}\\varepsilon^\\star$ 和 $\\varepsilon^C - \\varepsilon^\\star = \\frac{-4\\mu}{3K+4\\mu}\\varepsilon^\\star$：\n$$\nE_{\\text{pred}} = 6\\pi a^3 K \\left(\\frac{-4\\mu}{3K+4\\mu}\\varepsilon^\\star\\right)^2 + 8\\pi\\mu a^3 \\left(\\frac{3K}{3K+4\\mu}\\varepsilon^\\star\\right)^2\n$$\n$$\nE_{\\text{pred}} = \\frac{\\pi a^3 (\\varepsilon^\\star)^2}{(3K+4\\mu)^2} [6K(16\\mu^2) + 8\\mu(9K^2)] = \\frac{\\pi a^3 (\\varepsilon^\\star)^2}{(3K+4\\mu)^2} [96K\\mu^2 + 72K^2\\mu]\n$$\n提出公因子 $24K\\mu(4\\mu+3K)$：\n$$\nE_{\\text{pred}} = \\frac{\\pi a^3 (\\varepsilon^\\star)^2}{(3K+4\\mu)^2} [24K\\mu(4\\mu+3K)] = \\frac{24\\pi K \\mu a^3}{3K+4\\mu}(\\varepsilon^\\star)^2\n$$\n这是预测的总弹性应变能的最终表达式，将使用估计的特征应变 $\\widehat{\\varepsilon}^\\star$ 进行计算。\n\n**3. 计算算法**\n\n完整的算法如下：\n1.  对每个测试用例，解析输入：$K$ [GPa]，$\\mu$ [GPa]， $a$ [nm]，半径 $r_i$ [nm]，位移 $u_i$ [nm]，以及测量的能量 $E_{\\text{meas}}$ [J]。\n2.  将所有输入转换为国际单位制基本单位：\n    -   $K' = K \\times 10^9$ Pa\n    -   $\\mu' = \\mu \\times 10^9$ Pa\n    -   $a' = a \\times 10^{-9}$ m\n    -   $r'_i = r_i \\times 10^{-9}$ m\n    -   $u'_i = u_i \\times 10^{-9}$ m\n3.  执行线性最小二乘拟合。构造用于回归的变量：$y_i = u'_i$ 和 $x_i = (r'_i)^{-2}$。\n4.  计算斜率 $\\hat{m} = (\\sum x_i y_i) / (\\sum x_i^2)$。\n5.  估计约束应变：$\\widehat{\\varepsilon^C} = \\hat{m} / (a')^3$。\n6.  估计特征应变：$\\widehat{\\varepsilon}^\\star = \\frac{3K' + 4\\mu'}{3K'} \\widehat{\\varepsilon^C}$。\n7.  使用推导出的公式和估计的特征应变 $\\widehat{\\varepsilon}^\\star$ 计算预测的弹性应变能 $E_{\\text{pred}}$：\n    $$\n    E_{\\text{pred}} = \\frac{24\\pi K' \\mu' (a')^3}{3K' + 4\\mu'}(\\widehat{\\varepsilon}^\\star)^2\n    $$\n8.  计算误差 $\\text{err}$。如果 $E_{\\text{meas}}  0$，则 $\\text{err} = (E_{\\text{pred}} - E_{\\text{meas}}) / E_{\\text{meas}}$。如果 $E_{\\text{meas}} = 0$，则 $\\text{err} = E_{\\text{pred}}$。\n9.  为每个案例收集四个输出值 $[\\widehat{\\varepsilon}^\\star, E_{\\text{pred}}, E_{\\text{meas}}, \\text{err}]$ 并按指定格式进行格式化。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It processes each case, computes the required values, and prints the final result.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"K\": 160, \"mu\": 60, \"a\": 2,\n            \"radii\": [5, 6, 8, 10, 12],\n            \"displacements\": [0.0043166667, 0.0029229630, 0.0016966667, 0.0010466667, 0.0007507407],\n            \"E_meas\": 3.24816e-18,\n        },\n        {\n            \"K\": 100, \"mu\": 40, \"a\": 1,\n            \"radii\": [3, 4, 5, 6, 8],\n            \"displacements\": [0.00037231884, 0.00019380435, 0.00013043478, 0.00008557916, 0.00005595109],\n            \"E_meas\": 1.606e-20,\n        },\n        {\n            \"K\": 150, \"mu\": 50, \"a\": 2.5,\n            \"radii\": [7, 9, 12, 15, 18],\n            \"displacements\": [0.00001, -0.000005, 0.000002, -0.000001, 0.0000005],\n            \"E_meas\": 0.0,\n        },\n        {\n            \"K\": 200, \"mu\": 5, \"a\": 3,\n            \"radii\": [6, 9, 12, 15, 20],\n            \"displacements\": [0.00735806, 0.00317580, 0.00183312, 0.00115129, 0.000658226],\n            \"E_meas\": 3.349e-19,\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = process_case(case)\n        all_results.append(result)\n    \n    # Format the final output string as specified\n    inner_strs = [f\"[{','.join(f'{v:.6e}' for v in res)}]\" for res in all_results]\n    print(f\"[{','.join(inner_strs)}]\")\n\ndef process_case(case_data):\n    \"\"\"\n    Processes a single test case to find eigenstrain, predicted energy, and error.\n    \n    The derivation is based on linear elasticity for a spherical inclusion:\n    1. Far-field displacement u_r(r) = C / r^2.\n    2. The constant C is related to the constrained strain ε_C and inclusion radius a by C = ε_C * a^3.\n    3. A linear least-squares fit of u_r vs 1/r^2 yields an estimate for C.\n    4. The constrained strain ε_C is related to the eigenstrain ε* by ε* = ((3K + 4μ) / 3K) * ε_C.\n    5. The total elastic energy is E_pred = (24 * π * K * μ * a^3 / (3K + 4μ)) * (ε*)^2.\n    \"\"\"\n    \n    # Unpack and convert inputs to SI units\n    K_si = case_data[\"K\"] * 1e9  # GPa to Pa\n    mu_si = case_data[\"mu\"] * 1e9  # GPa to Pa\n    a_si = case_data[\"a\"] * 1e-9    # nm to m\n    radii_si = np.array(case_data[\"radii\"]) * 1e-9  # nm to m\n    displacements_si = np.array(case_data[\"displacements\"]) * 1e-9  # nm to m\n    E_meas = case_data[\"E_meas\"] # J\n\n    # Perform linear least-squares fit for y = m*x where y=u, x=1/r^2\n    # The slope m is an estimate for C = ε_C * a^3\n    x_fit = 1 / (radii_si**2)\n    y_fit = displacements_si\n    \n    m_hat = np.dot(x_fit, y_fit) / np.dot(x_fit, x_fit)\n\n    # Estimate constrained strain and then eigenstrain\n    eps_C_hat = m_hat / (a_si**3)\n    eps_star_hat = ((3 * K_si + 4 * mu_si) / (3 * K_si)) * eps_C_hat\n\n    # Predict total elastic energy\n    numerator = 24 * np.pi * K_si * mu_si * (a_si**3)\n    denominator = 3 * K_si + 4 * mu_si\n    E_pred = (numerator / denominator) * (eps_star_hat**2)\n\n    # Calculate error\n    if E_meas > 0:\n        error = (E_pred - E_meas) / E_meas\n    else:\n        error = E_pred\n\n    return [eps_star_hat, E_pred, E_meas, error]\n\nsolve()\n```", "id": "2765161"}]}