{"hands_on_practices": [{"introduction": "理解镜像力的第一步是分析单个位错与自由表面的相互作用。本练习将引导您通过第一性原理，推导螺位错的镜像力，并计算将其从一个深度移动到另一个深度所需的功，从而揭示其与表面相互作用相关的弹性能。掌握这一基本功是理解更复杂情形的基础。[@problem_id:2774468]", "problem": "一个各向同性的线性弹性半空间占据区域 $y \\gt 0$，其在 $y = 0$ 处有一个无牵引表面。一条无限长的直螺型位错平行于 $z$ 轴，其位错线穿过点 $(x,y) = (0,h)$，其中 $h \\gt 0$。其伯格斯矢量为 $\\mathbf{b} = b\\,\\mathbf{e}_{z}$，大小为 $b \\gt 0$，剪切模量为 $\\mu$。假设满足反平面弹性和叠加原理。该位错从初始深度 $h_1 \\gt 0$ 准静态地移动到最终深度 $h_2 \\gt 0$，使得在每一瞬间都保持弹性平衡。\n\n从无限介质中螺型位错的熟知场和单位长度上的 Peach–Koehler 力 $\\mathbf{f} = (\\boldsymbol{\\sigma}\\cdot\\mathbf{b}) \\times \\boldsymbol{\\xi}$（其中 $\\boldsymbol{\\xi}$ 是位错线的单位切向量）出发，使用镜像法来满足 $y=0$ 处的无牵引边界条件。推导将位错从 $h_1$ 准静态地移动到 $h_2$ 所需的单位长度上的外功表达式，并将您的结果解释为与镜像相互作用相关的相应弹性势能变化。\n\n将您的最终答案表示为由 $\\mu$、$b$、$h_1$ 和 $h_2$ 构成的单个闭合形式表达式。单位长度上的功以焦耳/米为单位报告。不要代入数值。您的最终答案必须是单个表达式。", "solution": "所述问题具有科学依据，是良定的，并包含获得唯一解所需的所有信息。这是线性弹性位错理论中的一个标准问题。因此，我将进行推导。\n\n该问题考虑一个位于各向同性线性弹性半空间（由 $y  0$ 定义，在 $y=0$ 处有无牵引表面）中的直螺型位错。位错线平行于 $z$ 轴，并穿过点 $(0, h)$，其中 $h0$。其伯格斯矢量为 $\\mathbf{b} = b\\mathbf{e}_z$。我们需要求解将该位错从初始深度 $h_1$ 移动到最终深度 $h_2$ 所需的单位长度上的功。\n\n我们从无限介质中螺型位错的应力场开始。对于位于原点、伯格斯矢量为 $\\mathbf{b} = b\\mathbf{e}_z$ 的位错，在笛卡尔坐标系 $(x,y,z)$ 中的非零应力分量为：\n$$\n\\sigma_{xz} = -\\frac{\\mu b}{2\\pi} \\frac{y}{x^2 + y^2}\n$$\n$$\n\\sigma_{yz} = \\frac{\\mu b}{2\\pi} \\frac{x}{x^2 + y^2}\n$$\n其中 $\\mu$ 是剪切模量。\n\n在我们的问题中，「真实」位错位于 $(0, h)$。它在点 $(x,y)$ 处产生的应力场可以通过将原点平移到 $(0, h)$ 得到：\n$$\n\\sigma_{xz}^{(real)}(x,y) = -\\frac{\\mu b}{2\\pi} \\frac{y-h}{x^2 + (y-h)^2}\n$$\n$$\n\\sigma_{yz}^{(real)}(x,y) = \\frac{\\mu b}{2\\pi} \\frac{x}{x^2 + (y-h)^2}\n$$\n$y=0$ 表面上的无牵引边界条件要求牵引矢量 $\\mathbf{t} = \\boldsymbol{\\sigma} \\cdot \\mathbf{n}$ 为零。弹性体的外法线为 $\\mathbf{n} = -\\mathbf{e}_y$。我们关心的牵引分量是 $t_z = \\mathbf{e}_z \\cdot \\mathbf{t} = \\sigma_{zy} n_y + \\sigma_{zx} n_x = -\\sigma_{yz}$。因此，我们必须有 $\\sigma_{yz}(x, 0) = 0$。\n计算真实位错在 $y=0$ 表面产生的应力：\n$$\n\\sigma_{yz}^{(real)}(x,0) = \\frac{\\mu b}{2\\pi} \\frac{x}{x^2 + (0-h)^2} = \\frac{\\mu b}{2\\pi} \\frac{x}{x^2 + h^2} \\neq 0\n$$\n这违反了边界条件。我们使用镜像法来修正。我们引入一个「镜像」位错，其位置使得它的应力场与真实位错的应力场叠加后满足边界条件。对于自由表面附近的螺型位错，合适的镜像是位于镜像位置 $(0, -h)$ 的一个反平行的螺型位错。因此，该镜像位错的伯格斯矢量为 $\\mathbf{b}' = -b\\mathbf{e}_z$，位置在 $(0, -h)$。\n\n镜像位错产生的应力场可通过将 $b$ 替换为 $-b$ 并将原点平移到 $(0, -h)$ 来得到：\n$$\n\\sigma_{xz}^{(image)}(x,y) = -\\frac{\\mu (-b)}{2\\pi} \\frac{y-(-h)}{x^2 + (y-(-h))^2} = \\frac{\\mu b}{2\\pi} \\frac{y+h}{x^2 + (y+h)^2}\n$$\n$$\n\\sigma_{yz}^{(image)}(x,y) = \\frac{\\mu (-b)}{2\\pi} \\frac{x}{x^2 + (y-(-h))^2} = -\\frac{\\mu b}{2\\pi} \\frac{x}{x^2 + (y+h)^2}\n$$\n在半空间 $y  0$ 中的总应力场是 $\\boldsymbol{\\sigma}^{(total)} = \\boldsymbol{\\sigma}^{(real)} + \\boldsymbol{\\sigma}^{(image)}$ 的和。让我们检验总应力分量 $\\sigma_{yz}^{(total)}$ 在 $y=0$ 处的边界条件：\n$$\n\\sigma_{yz}^{(total)}(x,0) = \\sigma_{yz}^{(real)}(x,0) + \\sigma_{yz}^{(image)}(x,0) = \\frac{\\mu b}{2\\pi} \\frac{x}{x^2 + h^2} - \\frac{\\mu b}{2\\pi} \\frac{x}{x^2 + (0+h)^2} = 0\n$$\n边界条件现在得到了满足。镜像位错正确地模拟了自由表面的影响。\n\n作用在真实位错上的单位长度力是由镜像位错的应力场引起的。这就是所谓的「镜像力」。我们使用 Peach-Koehler 公式：$\\mathbf{f} = (\\boldsymbol{\\sigma} \\cdot \\mathbf{b}) \\times \\boldsymbol{\\xi}$。这里，$\\boldsymbol{\\sigma}$ 是作用在位错上的应力场，即 $\\boldsymbol{\\sigma}^{(image)}$。伯格斯矢量为 $\\mathbf{b} = b\\mathbf{e}_z$，位错线切向量为 $\\boldsymbol{\\xi} = \\mathbf{e}_z$。\n对于螺型位错，矢量 $\\boldsymbol{\\sigma} \\cdot \\mathbf{b}$ 的分量为 $(\\sigma_{xz}b, \\sigma_{yz}b, \\sigma_{zz}b)$。由于我们处于反平面应变状态，$\\sigma_{zz}=0$。单位长度上的力则为：\n$$\n\\mathbf{f} = (\\sigma_{xz}b\\mathbf{e}_x + \\sigma_{yz}b\\mathbf{e}_y) \\times \\mathbf{e}_z = \\sigma_{yz}b(\\mathbf{e}_y \\times \\mathbf{e}_z) + \\sigma_{xz}b(\\mathbf{e}_x \\times \\mathbf{e}_z) = (\\sigma_{yz}b)\\mathbf{e}_x - (\\sigma_{xz}b)\\mathbf{e}_y\n$$\n我们必须在真实位错的位置 $(x,y)=(0,h)$ 处计算镜像位错的应力分量 $\\sigma_{xz}^{(image)}$ 和 $\\sigma_{yz}^{(image)}$。\n$$\n\\sigma_{yz}^{(image)}(0,h) = -\\frac{\\mu b}{2\\pi} \\frac{0}{0^2 + (h+h)^2} = 0\n$$\n$$\n\\sigma_{xz}^{(image)}(0,h) = \\frac{\\mu b}{2\\pi} \\frac{h+h}{0^2 + (h+h)^2} = \\frac{\\mu b}{2\\pi} \\frac{2h}{(2h)^2} = \\frac{\\mu b}{4\\pi h}\n$$\n因此，作用在真实位错上的镜像力 $\\mathbf{f}_{image}$ 为：\n$$\nf_{image,x} = \\sigma_{yz}^{(image)}(0,h) \\, b = 0\n$$\n$$\nf_{image,y} = -\\sigma_{xz}^{(image)}(0,h) \\, b = -\\left(\\frac{\\mu b}{4\\pi h}\\right)b = -\\frac{\\mu b^2}{4\\pi h}\n$$\n所以，$\\mathbf{f}_{image} = -\\frac{\\mu b^2}{4\\pi h} \\mathbf{e}_y$。该力指向自由表面（即 $y$ 轴负方向），表明是一种吸引力。\n\n为了准静态地移动位错，必须施加一个外力来平衡这个镜像力。所需的单位长度上的外力为 $\\mathbf{f}_{ext} = -\\mathbf{f}_{image} = \\frac{\\mu b^2}{4\\pi h} \\mathbf{e}_y$。\n\n将位错从初始深度 $h_1$ 移动到最终深度 $h_2$ 所需的单位长度上的外功 $W/L$ 是此外力沿路径的积分。路径是沿 $y$ 轴，所以我们对深度 $h$ 进行积分：\n$$\n\\frac{W}{L} = \\int_{h_1}^{h_2} \\mathbf{f}_{ext}(h) \\cdot d\\mathbf{l} = \\int_{h_1}^{h_2} \\left( \\frac{\\mu b^2}{4\\pi h} \\mathbf{e}_y \\right) \\cdot (dh\\,\\mathbf{e}_y)\n$$\n$$\n\\frac{W}{L} = \\int_{h_1}^{h_2} \\frac{\\mu b^2}{4\\pi h} dh = \\frac{\\mu b^2}{4\\pi} \\int_{h_1}^{h_2} \\frac{1}{h} dh\n$$\n进行积分：\n$$\n\\frac{W}{L} = \\frac{\\mu b^2}{4\\pi} \\left[ \\ln|h| \\right]_{h_1}^{h_2}\n$$\n由于 $h_1  0$ 且 $h_2  0$，绝对值是多余的。\n$$\n\\frac{W}{L} = \\frac{\\mu b^2}{4\\pi} (\\ln(h_2) - \\ln(h_1)) = \\frac{\\mu b^2}{4\\pi} \\ln\\left(\\frac{h_2}{h_1}\\right)\n$$\n这个量表示对系统所做的单位长度上的功。\n\n为了解释这个结果，我们认识到镜像力是保守力。它可以从一个势能函数 $U(h)$ 导出，该函数表示位错与表面之间的相互作用能。具体来说，$f_{image,y} = -\\frac{dU}{dh}$。\n$$\n-\\frac{\\mu b^2}{4\\pi h} = -\\frac{dU}{dh} \\implies \\frac{dU}{dh} = \\frac{\\mu b^2}{4\\pi h}\n$$\n对此积分得到单位长度上的相互作用能：$U(h) = \\frac{\\mu b^2}{4\\pi} \\ln(h) + C$，其中 $C$ 是积分常数。\n在准静态过程中，外力所做的功等于系统势能的变化：\n$$\n\\frac{W}{L} = \\int_{h_1}^{h_2} f_{ext,y} dh = \\int_{h_1}^{h_2} \\frac{dU}{dh} dh = U(h_2) - U(h_1)\n$$\n$$\nU(h_2) - U(h_1) = \\left(\\frac{\\mu b^2}{4\\pi} \\ln(h_2) + C\\right) - \\left(\\frac{\\mu b^2}{4\\pi} \\ln(h_1) + C\\right) = \\frac{\\mu b^2}{4\\pi} \\ln\\left(\\frac{h_2}{h_1}\\right)\n$$\n这个结果证实了，计算出的单位长度外功等于位错从深度 $h_1$ 移动到 $h_2$ 时，位错与自由表面之间弹性相互作用能的变化。\n该物理量的国际单位制单位是焦耳/米。", "answer": "$$\n\\boxed{\\frac{\\mu b^{2}}{4\\pi} \\ln\\left(\\frac{h_2}{h_1}\\right)}\n$$", "id": "2774468"}, {"introduction": "在螺位错的基础上，我们将研究应力场更为复杂的刃位错。本练习引入了一种常见的计算技术——边界条件的弱形式施加，并要求您将其数值近似解与精确的解析解进行比较。这个实践练习连接了纯理论与有限元模拟等实用计算方法。[@problem_id:2774471]", "problem": "考虑一个占据区域 $y \\ge 0$ 的各向同性线弹性平面应变半空间，其表面 $y = 0$ 为无牵引面。一个线方向沿 $z$ 轴、伯格斯矢量（Burgers vector）为 $\\mathbf{b} = b\\,\\mathbf{e}_x$ 的刃型位错位于 $(x,y)=(0,h)$ 处，其中 $h0$。剪切模量为 $\\mu$，泊松比为 $\\nu$。您将比较一种弱形式施加的无牵引边界近似方法与基于镜像法的解析参考解，该解析参考解是由于自由表面的存在而作用在位错上的力，并评估其相对于离散边界施加的收敛性。\n\n基本和建模假设：\n- 使用各向同性线弹性平面应变。无限介质中 Volterra 刃型位错的应力场是纳维方程（Navier equations）经过充分检验的经典解，并以此作为出发点。\n- 在单位外法线为 $\\mathbf{n}$ 的边界上，牵引矢量为 $\\mathbf{t} = \\boldsymbol{\\sigma}\\cdot \\mathbf{n}$。\n- 单位切线为 $\\boldsymbol{\\xi}$ 的直位错线上，单位长度上的 Peach–Koehler 力为 $\\mathbf{f} = (\\boldsymbol{\\sigma}\\cdot \\mathbf{b}) \\times \\boldsymbol{\\xi}$。\n\n任务：\n1) 基于镜像法的解析参考解。从无限介质中刃型位错的应力场和针对无牵引面的经典镜像构造法出发，推导作用在 $(0,h)$ 处真实位错上的单位长度像力（image force）的垂直分量 $f_y$ 的表达式。最终答案以牛顿/米 (N/m) 表示。不要假定任何目标公式；从线弹性的第一性原理和镜像法开始。\n\n2) 通过单个基场弱形式施加无牵引边界。通过将真实位错场与单个镜像基场叠加，构建无牵引边界的弱近似解：该镜像基场是一个位于 $(0,-h)$ 的刃型位错，其伯格斯矢量为 $-b\\,\\mathbf{e}_x$，并由一个未知标量权重 $\\alpha \\in \\mathbb{R}$ 进行缩放。通过在配置点 $x_i \\in [-L,L]$ 上最小化边界 $y=0$ 处牵引力的离散最小二乘残差来确定 $\\alpha$：\n- 在每个 $x_i$ 处，评估由真实位错的叠加应力场加上 $\\alpha$ 倍的基场得到的牵引残差分量 $t_x(x_i)$ 和 $t_y(x_i)$，其中 $\\mathbf{n}=\\mathbf{e}_y$。\n- 定义离散目标函数 $J(\\alpha) = \\sum_{i=1}^{N} \\left[ t_x(x_i)^2 + t_y(x_i)^2 \\right]$，并选择使 $J(\\alpha)$ 最小化的 $\\alpha$。\n\n3) 根据弱形式施加预测的力。使用优化后的 $\\alpha$，计算仅由修正场（即由 $\\alpha$ 缩放的镜像基场）作用在真实位错上的单位长度预测垂直 Peach–Koehler 力 $\\hat{f}_y$。将 $\\hat{f}_y$ 以牛顿/米 (N/m) 表示。\n\n4) 报告指标。对于下面的每个测试用例，计算：\n- 预测力大小的相对误差，$\\varepsilon = \\left| \\hat{f}_y - f_y \\right| / \\left| f_y \\right|$，以小数形式表示。\n- 边界牵引残差的减小因子，定义为优化后的均方根 (RMS) 残差与任何修正前残差的比值，\n$$\\rho = \\frac{\\sqrt{\\frac{1}{N}\\sum_{i=1}^N \\left[t_x^{(\\alpha^\\star)}(x_i)^2 + t_y^{(\\alpha^\\star)}(x_i)^2\\right]}}{\\sqrt{\\frac{1}{N}\\sum_{i=1}^N \\left[t_x^{(0)}(x_i)^2 + t_y^{(0)}(x_i)^2\\right]}},$$\n其中上标 $(\\alpha^\\star)$ 表示优化后的 $\\alpha$，而 $(0)$ 表示 $\\alpha=0$（无修正）。\n\n实现要求：\n- 使用具有伯格斯矢量 $b\\,\\mathbf{e}_x$ 的直刃型位错的无限介质应力场作为您的基本场；使用叠加法构建试探场。\n- 使用 $\\mathbf{n}=\\mathbf{e}_y$ 评估 $y=0$ 处的边界牵引力，因此 $t_x(x,0)=\\sigma_{xy}(x,0)$ 和 $t_y(x,0)=\\sigma_{yy}(x,0)$。\n- 在 $[-L,L]$（含两端）上使用 $N$ 个均匀分布的配置点 $x_i$。此任务中不出现角度；不需要角度单位。\n- 所有物理量必须以一致的单位处理。具体来说，长度使用米 (m)，模量使用帕斯卡 (Pa)，伯格斯矢量的大小使用米 (m)。单位长度上的力必须以牛顿/米 (N/m) 表示。\n\n测试套件：\n为以下参数集 $(\\mu,\\nu,b,h,N,L)$ 提供结果，其中 $\\mu$ 的单位是帕斯卡，$b$、$h$ 和 $L$ 的单位是米，$N$ 是无量纲的：\n- 案例 A (理想情况): $(\\mu, \\nu, b, h, N, L) = (40\\cdot 10^9, 0.33, 0.25\\cdot 10^{-9}, 20\\cdot 10^{-9}, 201, 200\\cdot 10^{-9})$。\n- 案例 B (粗糙边界采样): $(80\\cdot 10^9, 0.25, 0.286\\cdot 10^{-9}, 10\\cdot 10^{-9}, 51, 100\\cdot 10^{-9})$。\n- 案例 C (近乎不可压缩): $(26\\cdot 10^9, 0.49, 0.25\\cdot 10^{-9}, 5\\cdot 10^{-9}, 401, 250\\cdot 10^{-9})$。\n- 案例 D (弱表面相互作用): $(50\\cdot 10^9, 0.30, 0.25\\cdot 10^{-9}, 100\\cdot 10^{-9}, 21, 150\\cdot 10^{-9})$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表，每个内部列表包含对应测试用例的两个浮点数 $[\\varepsilon, \\rho]$，顺序为 A、B、C、D。例如：\"[[eA,rA],[eB,rB],[eC,rC],[eD,rD]]\"。不要打印任何其他文本。", "solution": "所提出的问题是材料纳米力学中的一个标准练习，具体涉及晶体位错与自由表面的相互作用。该问题具有科学依据，提法明确，并包含了获得唯一解所需的所有必要信息。因此，该问题被认为是有效的。我们严格遵守所提供的定义和假设，着手进行求解。\n\n该问题要求比较刃型位错上的像力的解析解与基于弱形式施加无牵引边界条件的数值近似解。\n\n首先，我们建立无限各向同性弹性介质中单个直刃型位错的应力场。对于一个位于原点、位错线沿 $z$ 轴、伯格斯矢量为 $\\mathbf{b} = b\\,\\mathbf{e}_x$ 的位错，其在 $xy$ 平面内的应力分量为：\n$$ \\sigma_{xx} = -D \\frac{y(3x^2+y^2)}{(x^2+y^2)^2} $$\n$$ \\sigma_{yy} = D \\frac{y(x^2-y^2)}{(x^2+y^2)^2} $$\n$$ \\sigma_{xy} = D \\frac{x(x^2-y^2)}{(x^2+y^2)^2} $$\n其中 $D = \\frac{\\mu b}{2\\pi(1-\\nu)}$。这里，$\\mu$ 是剪切模量，$\\nu$ 是泊松比。这些是线弹性理论的经典结果。\n\n**1. 基于镜像法的解析参考力 $f_y$**\n\n施加在位错上的力是由应力场引起的。在半空间的情况下，位错受到其自身“镜像”的应力场的作用，这是一个为满足边界条件而引入的虚拟场。对于线方向为 $\\boldsymbol{\\xi}$、伯格斯矢量为 $\\mathbf{b}$ 的位错，其单位长度上的力 $\\mathbf{f}$ 由 Peach-Koehler 公式给出：\n$$ \\mathbf{f} = (\\boldsymbol{\\sigma}^{(I)} \\cdot \\mathbf{b}) \\times \\boldsymbol{\\xi} $$\n其中 $\\boldsymbol{\\sigma}^{(I)}$ 是在真实位错位置处评估的镜像解的应力场。\n\n对于我们的问题，真实位错位于 $(0,h)$，其 $\\boldsymbol{\\xi}=\\mathbf{e}_z$ 且 $\\mathbf{b}=b\\,\\mathbf{e}_x$。该力可展开为：\n$$ \\mathbf{f} = ((\\sigma_{xx}^{(I)}\\mathbf{e}_x + \\sigma_{yx}^{(I)}\\mathbf{e}_y)b) \\times \\mathbf{e}_z = b\\sigma_{xy}^{(I)}(\\mathbf{e}_y \\times \\mathbf{e}_z) + b\\sigma_{xx}^{(I)}(\\mathbf{e}_x \\times \\mathbf{e}_z) = b\\sigma_{xy}^{(I)}\\mathbf{e}_x - b\\sigma_{xx}^{(I)}\\mathbf{e}_y $$\n我们关心的是垂直分量 $f_y$：\n$$ f_y = -b\\,\\sigma_{xx}^{(I)}(0,h) $$\n\n要使表面 $y=0$ 无牵引所需的完整镜像应力场 $\\boldsymbol{\\sigma}^{(I)}$ 是复杂的。然而，在真实位错位置 $(0,h)$ 处的应力分量是一个已知的经典结果（例如，参见 Hirth  Lothe 的《位错理论》( *Theory of Dislocations* )）。对于伯格斯矢量平行于表面的刃型位错，该分量为：\n$$ \\sigma_{xx}^{(I)}(0,h) = \\frac{\\mu b}{4\\pi(1-\\nu)h} $$\n将此代入 $f_y$ 的表达式，得到解析力：\n$$ f_y = -b \\left( \\frac{\\mu b}{4\\pi(1-\\nu)h} \\right) = -\\frac{\\mu b^2}{4\\pi(1-\\nu)h} $$\n负号表示该力是吸引力，将位错拉向自由表面。这将是我们的参考值。\n\n**2. 弱形式施加边界条件**\n\n该问题提出了一个近似解，其中总应力场 $\\boldsymbol{\\sigma}^{(\\text{tot})}$ 是真实位错场 $\\boldsymbol{\\sigma}^{(R)}$ 和一个由权重 $\\alpha$ 缩放的修正基场 $\\boldsymbol{\\sigma}^{(B)}$ 的叠加：\n$$ \\boldsymbol{\\sigma}^{(\\text{tot})} = \\boldsymbol{\\sigma}^{(R)} + \\alpha \\boldsymbol{\\sigma}^{(B)} $$\n真实位错位于 $(0,h)$，其 $\\mathbf{b}=b\\,\\mathbf{e}_x$。基场是一个位于 $(0,-h)$ 且伯格斯矢量为 $-b\\,\\mathbf{e}_x$ 的位错场。\n\n为了找到最优权重 $\\alpha$，我们在表面 $y=0$ 上最小化牵引矢量 $\\mathbf{t} = t_x\\mathbf{e}_x + t_y\\mathbf{e}_y$ 的最小二乘残差。问题陈述使用 $\\mathbf{n}=\\mathbf{e}_y$，因此 $t_x = \\sigma_{xy}$ 且 $t_y = \\sigma_{yy}$。\n\n表面上一点 $(x,0)$ 处的应力场为：\n- 对于位于 $(0,h)$ 的真实位错，我们在 $(x, -h)$ 处评估标准场：\n  $$ \\sigma_{xy}^{(R)}(x,0) = D \\frac{x(x^2-h^2)}{(x^2+h^2)^2} $$\n  $$ \\sigma_{yy}^{(R)}(x,0) = -D \\frac{h(x^2-h^2)}{(x^2+h^2)^2} $$\n- 对于位于 $(0,-h)$ 且伯格斯矢量为 $-b\\,\\mathbf{e}_x$ 的基位错，我们使用常数 $-D$ 并在 $(x,h)$ 处进行评估：\n  $$ \\sigma_{xy}^{(B)}(x,0) = (-D) \\frac{x(x^2-h^2)}{(x^2+h^2)^2} $$\n  $$ \\sigma_{yy}^{(B)}(x,0) = (-D) \\frac{h(x^2-h^2)}{(x^2+h^2)^2} $$\n\n表面 $y=0$ 上总牵引力的分量为：\n$$ t_x(x) = \\sigma_{xy}^{(R)} + \\alpha \\sigma_{xy}^{(B)} = (1-\\alpha) D \\frac{x(x^2-h^2)}{(x^2+h^2)^2} $$\n$$ t_y(x) = \\sigma_{yy}^{(R)} + \\alpha \\sigma_{yy}^{(B)} = -(1+\\alpha) D \\frac{h(x^2-h^2)}{(x^2+h^2)^2} $$\n\n要最小化的离散目标函数是 $J(\\alpha) = \\sum_{i=1}^{N} [t_x(x_i)^2 + t_y(x_i)^2]$，其中 $x_i$ 是 $[-L,L]$ 上的 $N$ 个配置点。\n$$ J(\\alpha) = \\sum_{i=1}^{N} \\left[ (1-\\alpha)^2 \\left(D \\frac{x_i(x_i^2-h^2)}{(x_i^2+h^2)^2}\\right)^2 + (1+\\alpha)^2 \\left(D \\frac{h(x_i^2-h^2)}{(x_i^2+h^2)^2}\\right)^2 \\right] $$\n我们定义两个仅依赖于离散化几何形状的和：\n$$ \\tilde{S}_x = \\sum_{i=1}^{N} \\frac{x_i^2(x_i^2-h^2)^2}{(x_i^2+h^2)^4} \\quad \\text{和} \\quad \\tilde{S}_y = h^2 \\sum_{i=1}^{N} \\frac{(x_i^2-h^2)^2}{(x_i^2+h^2)^4} $$\n目标函数变为 $J(\\alpha) = D^2 \\left[ (1-\\alpha)^2 \\tilde{S}_x + (1+\\alpha)^2 \\tilde{S}_y \\right]$。为了求最小值，我们将其对 $\\alpha$ 的导数设为零：\n$$ \\frac{dJ}{d\\alpha} = D^2 \\left[ -2(1-\\alpha)\\tilde{S}_x + 2(1+\\alpha)\\tilde{S}_y \\right] = 0 $$\n$$ -(1-\\alpha)\\tilde{S}_x + (1+\\alpha)\\tilde{S}_y = 0 \\implies -\\tilde{S}_x + \\alpha\\tilde{S}_x + \\tilde{S}_y + \\alpha\\tilde{S}_y = 0 $$\n$$ \\alpha(\\tilde{S}_x + \\tilde{S}_y) = \\tilde{S}_x - \\tilde{S}_y $$\n因此，最优权重为：\n$$ \\alpha^\\star = \\frac{\\tilde{S}_x - \\tilde{S}_y}{\\tilde{S}_x + \\tilde{S}_y} $$\n\n**3. 根据弱形式施加预测的力 $\\hat{f}_y$**\n\n作用在真实位错上的预测力 $\\hat{f}_y$ 仅由在 $(0,h)$ 处评估的修正场 $\\alpha^\\star \\boldsymbol{\\sigma}^{(B)}$ 引起。\n$$ \\hat{f}_y = -b \\, (\\alpha^\\star \\sigma_{xx}^{(B)}(0,h)) $$\n应力分量 $\\sigma_{xx}^{(B)}$ 是位于 $(0,-h)$、伯格斯矢量为 $-b\\,\\mathbf{e}_x$ 的位错在 $(0,h)$ 处产生的应力。相对位置是 $(0, 2h)$。使用标准公式，其中 $x=0$，$y=2h$，常数为 $-D$：\n$$ \\sigma_{xx}^{(B)}(0,h) = -(-D)\\frac{2h(3(0)^2+(2h)^2)}{((0)^2+(2h)^2)^2} = D \\frac{2h(4h^2)}{16h^4} = \\frac{D}{2h} = \\frac{\\mu b}{4\\pi(1-\\nu)h} $$\n将此代入 $\\hat{f}_y$ 的表达式中：\n$$ \\hat{f}_y = -\\alpha^\\star b \\left( \\frac{\\mu b}{4\\pi(1-\\nu)h} \\right) = \\alpha^\\star \\left( -\\frac{\\mu b^2}{4\\pi(1-\\nu)h} \\right) = \\alpha^\\star f_y $$\n这显著地表明 $\\hat{f}_y = \\alpha^\\star f_y$。\n\n**4. 报告指标**\n\n我们现在推导所需指标的表达式。\n- **力的相对误差 $\\varepsilon$**：\n  $$ \\varepsilon = \\frac{|\\hat{f}_y - f_y|}{|f_y|} = \\frac{|\\alpha^\\star f_y - f_y|}{|f_y|} = \\frac{|f_y||\\alpha^\\star - 1|}{|f_y|} = |\\alpha^\\star - 1| $$\n\n- **牵引残差减小因子 $\\rho$**：\n  $$ \\rho = \\frac{\\text{RMS}(t^{(\\alpha^\\star)})}{\\text{RMS}(t^{(0)})} = \\sqrt{\\frac{J(\\alpha^\\star)}{J(0)}} $$\n  未修正的残差对应于 $\\alpha=0$：$J(0) = D^2(\\tilde{S}_x + \\tilde{S}_y)$。\n  最小化后的残差是 $J(\\alpha^\\star) = D^2 \\left[ (1-\\alpha^\\star)^2 \\tilde{S}_x + (1+\\alpha^\\star)^2 \\tilde{S}_y \\right]$。代入 $\\alpha^\\star=\\frac{\\tilde{S}_x - \\tilde{S}_y}{\\tilde{S}_x + \\tilde{S}_y}$：\n  $$ 1-\\alpha^\\star = 1 - \\frac{\\tilde{S}_x - \\tilde{S}_y}{\\tilde{S}_x + \\tilde{S}_y} = \\frac{\\tilde{S}_x + \\tilde{S}_y - (\\tilde{S}_x - \\tilde{S}_y)}{\\tilde{S}_x + \\tilde{S}_y} = \\frac{2\\tilde{S}_y}{\\tilde{S}_x + \\tilde{S}_y} $$\n  $$ 1+\\alpha^\\star = 1 + \\frac{\\tilde{S}_x - \\tilde{S}_y}{\\tilde{S}_x + \\tilde{S}_y} = \\frac{\\tilde{S}_x + \\tilde{S}_y + \\tilde{S}_x - \\tilde{S}_y}{\\tilde{S}_x + \\tilde{S}_y} = \\frac{2\\tilde{S}_x}{\\tilde{S}_x + \\tilde{S}_y} $$\n  $$ J(\\alpha^\\star) = D^2 \\left[ \\left(\\frac{2\\tilde{S}_y}{\\tilde{S}_x+\\tilde{S}_y}\\right)^2 \\tilde{S}_x + \\left(\\frac{2\\tilde{S}_x}{\\tilde{S}_x+\\tilde{S}_y}\\right)^2 \\tilde{S}_y \\right] = D^2 \\frac{4\\tilde{S}_y^2\\tilde{S}_x + 4\\tilde{S}_x^2\\tilde{S}_y}{(\\tilde{S}_x+\\tilde{S}_y)^2} = D^2 \\frac{4\\tilde{S}_x\\tilde{S}_y(\\tilde{S}_y+\\tilde{S}_x)}{(\\tilde{S}_x+\\tilde{S}_y)^2} = D^2 \\frac{4\\tilde{S}_x\\tilde{S}_y}{\\tilde{S}_x+\\tilde{S}_y} $$\n  比值为：\n  $$ \\frac{J(\\alpha^\\star)}{J(0)} = \\frac{D^2 \\frac{4\\tilde{S}_x\\tilde{S}_y}{\\tilde{S}_x+\\tilde{S}_y}}{D^2(\\tilde{S}_x + \\tilde{S}_y)} = \\frac{4\\tilde{S}_x\\tilde{S}_y}{(\\tilde{S}_x+\\tilde{S}_y)^2} $$\n  因此，减小因子为：\n  $$ \\rho = \\sqrt{\\frac{4\\tilde{S}_x\\tilde{S}_y}{(\\tilde{S}_x+\\tilde{S}_y)^2}} = \\frac{2\\sqrt{\\tilde{S}_x\\tilde{S}_y}}{\\tilde{S}_x+\\tilde{S}_y} $$\n\n实现将为每个测试用例计算 $\\tilde{S}_x$ 和 $\\tilde{S}_y$，然后使用这些紧凑的公式来找到 $\\varepsilon$ 和 $\\rho$。材料参数 $\\mu$ 和 $\\nu$ 以及伯格斯矢量大小 $b$ 不会出现在指标的最终表达式中，因为它们包含在被约掉的因子 $D^2$ 中。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the dislocation image force problem for the given test cases.\n\n    The problem compares an analytical solution for the image force on an edge\n    dislocation near a free surface with a numerical approximation. This function\n    calculates two metrics for this comparison:\n    1. epsilon: The relative error in the predicted force magnitude.\n    2. rho: The reduction factor in the boundary traction residual.\n\n    The analytical derivations show that these metrics can be computed from\n    two sums, S_x_tilde and S_y_tilde, which depend only on the geometry\n    (h, L, N) of the problem.\n    \"\"\"\n\n    test_cases = [\n        # Case A: (mu, nu, b, h, N, L)\n        (40e9, 0.33, 0.25e-9, 20e-9, 201, 200e-9),\n        # Case B:\n        (80e9, 0.25, 0.286e-9, 10e-9, 51, 100e-9),\n        # Case C:\n        (26e9, 0.49, 0.25e-9, 5e-9, 401, 250e-9),\n        # Case D:\n        (50e9, 0.30, 0.25e-9, 100e-9, 21, 150e-9),\n    ]\n\n    results = []\n    for case in test_cases:\n        mu, nu, b_mag, h, N, L = case\n\n        # Generate N uniformly spaced collocation points on the boundary [-L, L]\n        x_i = np.linspace(-L, L, N)\n\n        # Pre-calculate squares for efficiency\n        h2 = h**2\n        x_i2 = x_i**2\n\n        # To avoid potential floating point issues with division by zero if h=0,\n        # although problem constraints state h > 0.\n        denominator = (x_i2 + h2)**4\n        # Handle cases where denominator might be zero, though not expected here.\n        denominator[denominator == 0] = 1.0e-100 \n        \n        numerator_common = (x_i2 - h2)**2\n        \n        # This term is common to both S_x_tilde and S_y_tilde summations\n        sum_term_C = numerator_common / denominator\n\n        # Calculate the sums S_x_tilde and S_y_tilde\n        # These sums do not depend on material properties (mu, nu, b)\n        # S_x_tilde = sum(x_i^2 * (x_i^2 - h^2)^2 / (x_i^2 + h^2)^4)\n        s_x_tilde = np.sum(x_i2 * sum_term_C)\n        \n        # S_y_tilde = sum(h^2 * (x_i^2 - h^2)^2 / (x_i^2 + h^2)^4)\n        s_y_tilde = h2 * np.sum(sum_term_C)\n\n        # If s_x_tilde + s_y_tilde is zero, it implies L=0 and h=0,\n        # which is not a physical case. Add a check for robustness.\n        if s_x_tilde + s_y_tilde == 0:\n            alpha = 0.0 # Or some other default, though this shouldn't be reached\n        else:\n            # Calculate the optimal weight alpha\n            alpha = (s_x_tilde - s_y_tilde) / (s_x_tilde + s_y_tilde)\n\n        # Metric 1: Relative error in force, epsilon\n        # epsilon = |alpha - 1|\n        epsilon = np.abs(alpha - 1)\n\n        # Metric 2: Traction residual reduction factor, rho\n        # rho = 2 * sqrt(S_x * S_y) / (S_x + S_y)\n        # Handle the case where the product is negative due to float precision,\n        # or one of the terms is zero.\n        product_s = s_x_tilde * s_y_tilde\n        if product_s  0: product_s = 0 \n\n        if s_x_tilde + s_y_tilde == 0:\n            rho = 1.0 # No reduction if initial residual is zero\n        else:\n            rho = (2.0 * np.sqrt(product_s)) / (s_x_tilde + s_y_tilde)\n\n        results.append([epsilon, rho])\n    \n    # Format the output as a string representing a list of lists of floats\n    output_str = \"[\" + \",\".join([f\"[{e},{r}]\" for e, r in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2774471"}, {"introduction": "最后的练习将挑战一个更接近实际的复杂几何结构：位于薄膜中的位错，其受到两个自由表面的共同影响。该问题要求您构建一个无限镜像序列来满足边界条件，并在代码中实现其截断近似。通过将近似解与精确的闭合形式解进行比较，本练习为模拟纳米力学中的有限尺寸效应以及评估镜像法收敛性提供了关键的洞见。[@problem_id:2774426]", "problem": "您需要为一个位于各向同性线性弹性薄膜中的直螺型位错设计并实现一个最小的二维离散位错动力学核心，该薄膜由两个无牵引（自由）表面界定。自由表面是位于 $y=0$ 和 $y=H$ 处的平面。位错线平行于 $z$ 轴，其伯格斯矢量也平行于 $z$ 轴。您的目标是使用镜像法施加自由表面边界条件，并量化建模误差随薄膜厚度的变化。\n\n使用以下基本和经过充分检验的事实：\n- 反平面剪切（螺型位错）中的各向同性线性弹性理论。一个位于 $(x_0,y_0)$、伯格斯矢量大小为 $b$ 的单一直螺型位错所产生的非零应力分量是剪切应力 $\\sigma_{xz}$ 和 $\\sigma_{yz}$。特别地，反平面解是各向同性线性弹性理论的一个标准结果。\n- 在应力场 $\\boldsymbol{\\sigma}$ 中，一个伯格斯矢量为 $\\mathbf{b}$、位错线方向为 $\\boldsymbol{\\xi}$ 的位错上每单位长度所受的 Peach–Koehler 力为 $\\mathbf{f} = (\\boldsymbol{\\sigma}\\cdot\\mathbf{b})\\times \\boldsymbol{\\xi}$。\n- 对于一个 $\\mathbf{b}=b\\,\\hat{\\mathbf{z}}$ 且 $\\boldsymbol{\\xi}=\\hat{\\mathbf{z}}$ 的螺型位错，面内分力仅取决于 $\\sigma_{xz}$ 和 $\\sigma_{yz}$。\n\n镜像法建模任务：\n1) 单表面模型：使用一个镜像位错来表示一个在 $y=0$ 处具有无牵引表面的半空间 $y0$，并计算作用在位于 $(x_0,y_0)$ 的真实位错上的 Peach–Koehler 力。\n2) 双表面（薄膜）模型：使用由两个表面之间的连续反射产生的无穷级数镜像位错，来表示一个在 $y=0$ 和 $y=H$ 处具有无牵引表面的有限厚度薄膜。通过对由整数 $n$（其中 $|n|\\leq N$）索引的反射所产生的镜像进行求和，实现一个截断级数，求和时不包括真实位错本身。\n3) 薄膜的精确参考解：从第一性原理以及复分析和亚纯函数的傅里叶级数中的恒等式（例如，级数 $\\sum_{n=-\\infty}^{\\infty} \\frac{1}{z-n}$ 的经典恒等式）出发，推导并使用一个闭式表达式来计算具有两个自由表面的薄膜中螺型位错所受的 Peach–Koehler 力。该参考解必须用于计算截断镜像模型和单表面模型的误差。\n\n误差量化：\n- 对于每种情况，将相对误差定义为 $e=\\left|\\frac{f_{\\text{approx}}-f_{\\text{exact}}}{f_{\\text{exact}}}\\right|$，其中 $f_{\\text{approx}}$ 是模型预测值，$f_{\\text{exact}}$ 是精确的薄膜参考值。\n- 将误差表示为一个无量纲的十进制数（无单位）。\n\n实现细节：\n- 考虑一个位于 $(x_0,y_0)=(0,y_0)$ 的单一直螺型位错，其中 $y_00$。\n- 使用剪切模量 $\\mu=26\\times 10^{9}\\ \\text{Pa}$ 和伯格斯矢量大小 $b=0.25\\times 10^{-9}\\ \\text{m}$。这些值对于面心立方金属是物理上合理的。\n- 在将位错深度固定为 $y_0=1.0\\times 10^{-6}\\ \\text{m}$ 的同时，使用以下测试套件来量化建模误差随薄膜厚度 $H$ 的变化：\n  - 测试用例 1：$H=2.5\\times 10^{-6}\\ \\text{m}$。\n  - 测试用例 2：$H=5.0\\times 10^{-6}\\ \\text{m}$。\n  - 测试用例 3：$H=1.0\\times 10^{-5}\\ \\text{m}$。\n  - 测试用例 4：$H=1.0\\times 10^{-4}\\ \\text{m}$。\n- 对于截断的双表面模型，使用对称截断指数 $N=5$（即，包括由满足 $-N\\le n\\le N$ 的 $n$ 生成的所有镜像位错），求和时不包括真实位错本身。\n- 所有计算都必须在 $x=x_0$ 平面内进行，这样每个镜像对真实位错位置处 $\\sigma_{xz}$ 的贡献仅取决于垂直距离。\n\n要求的输出和格式：\n- 对于每个测试用例（按上述顺序），计算两个误差：\n  - 单表面近似（仅使用 $y=0$ 对面的一个镜像）相对于精确薄膜解的相对误差。\n  - $N=5$ 的截断双表面镜像级数相对于精确薄膜解的相对误差。\n- 您的程序的最终输出必须是单行，包含一个含 8 个浮点数的列表，顺序如下：\n  - $\\big[e_{\\text{one}}(H_1), e_{\\text{trunc}}(H_1), e_{\\text{one}}(H_2), e_{\\text{trunc}}(H_2), e_{\\text{one}}(H_3), e_{\\text{trunc}}(H_3), e_{\\text{one}}(H_4), e_{\\text{trunc}}(H_4)\\big]$.\n- 每个列表元素必须是十进制数（无单位）。\n\n角度单位：\n- 如果使用任何三角函数，其参数必须以弧度为单位。\n\n注意：\n- 您的推导必须从所述的物理基础开始，不得在这些基础之外假设任何捷径公式。您不得在此问题陈述中提供直接代入的公式。您编写的程序必须实现上述建模逻辑，并以所述的精确格式生成指定的输出。", "solution": "该问题陈述经证实具有科学依据，提法明确且客观。它提出了一个材料纳米力学中的标准问题（尽管并非微不足道），具体涉及晶体位错与自由表面的弹性相互作用。该问题是自洽的，并为获得唯一解提供了所有必要的数据。因此，我们着手进行推导和计算。\n\n分析基于反平面剪切问题的线性各向同性弹性理论。一个位错线和伯格斯矢量均平行于 $z$ 轴的直螺型位错，仅引起面外位移 $u_z(x,y)$。唯一非零的应力分量是 $\\sigma_{xz}$ 和 $\\sigma_{yz}$。\n\n首先，我们建立一个位于无限介质中 $(x_s, y_s)$ 处、伯格斯矢量为 $\\mathbf{b} = b\\hat{\\mathbf{z}}$ 的单一直螺型位错的应力场。这是一个基本结果。在场点 $(x,y)$ 处的应力分量为：\n$$ \\sigma_{xz}(x, y) = -\\frac{\\mu b}{2\\pi} \\frac{y-y_s}{(x-x_s)^2 + (y-y_s)^2} $$\n$$ \\sigma_{yz}(x, y) = \\frac{\\mu b}{2\\pi} \\frac{x-x_s}{(x-x_s)^2 + (y-y_s)^2} $$\n其中 $\\mu$ 是剪切模量。\n\n位错上每单位长度的力由 Peach-Koehler 公式给出，即 $\\mathbf{f} = (\\boldsymbol{\\sigma} \\cdot \\mathbf{b}) \\times \\boldsymbol{\\xi}$。对于一个位于 $(x_0, y_0)$、伯格斯矢量为 $\\mathbf{b} = b\\hat{\\mathbf{z}}$、位错线指向为 $\\boldsymbol{\\xi} = \\hat{\\mathbf{z}}$ 的螺型位错，在外部或镜像应力场 $\\boldsymbol{\\sigma}^{\\text{img}}$ 的作用下，其分力为：\n$$ f_x = b \\sigma_{yz}^{\\text{img}}(x_0, y_0) $$\n$$ f_y = -b \\sigma_{xz}^{\\text{img}}(x_0, y_0) $$\n问题指定位错位于 $(x_0, y_0) = (0, y_0)$。我们只考虑镜像位错，根据对称性，它们也位于 $y$ 轴上（即，在位置 $(0, y_s)$ 处）。对于任何这样的镜像，其在 $(0, y_0)$ 处的应力分量 $\\sigma_{yz}$ 为零。因此，合力只有一个 $y$ 分量，$f_x=0$。任务简化为从各种镜像配置所产生的应力 $\\sigma_{xz}^{\\text{img}}$ 来计算 $f_y$。\n该分力为：\n$$ f_y = -b \\sum_{i} \\sigma_{xz}^{(i)}(0, y_0) = -b \\sum_{i} \\left( -\\frac{\\mu b_i}{2\\pi} \\frac{y_0 - y_i}{(0-0)^2 + (y_0 - y_i)^2} \\right) = \\frac{\\mu b}{2\\pi} \\sum_{i} \\frac{b_i}{y_0 - y_i} $$\n其中求和遍及所有镜像位错，每个镜像位错位于位置 $(0, y_i)$，其伯格斯矢量大小为 $b_i$。\n\n1.  单表面模型（近似）\n对于一个占据 $y0$ 且在 $y=0$ 处有无牵引表面的半无限介质，边界条件为 $\\sigma_{yz}|_{y=0}=0$。来自位于 $(0, y_0)$ 的真实位错的应力 $\\sigma_{yz}$ 必须在该表面上被抵消。这可以通过在 $(0, -y_0)$ 处放置一个强度相反（$b_i = -b$）的单镜像位错来实现。\n作用在真实位错上的力来自这一个镜像。\n$$ f_{y, \\text{one}} = \\frac{\\mu b}{2\\pi} \\frac{-b}{y_0 - (-y_0)} = -\\frac{\\mu b^2}{4\\pi y_0} $$\n这是将位错拉向自由表面的吸引力。\n\n2.  精确薄膜解（参考）\n对于厚度为 $H$ 且在 $y=0$ 和 $y=H$ 处有无牵引表面的薄膜，需要一个无穷级数的镜像。一个位于 $(0, y_0)$ 且强度为 $+b$ 的真实位错经过反射会生成一系列镜像：\n- 强度为 $-b$ 的镜像，位于 $y = 2nH - y_0$（$n \\in \\mathbb{Z}$）。\n- 强度为 $+b$ 的镜像，位于 $y = 2nH + y_0$（$n \\in \\mathbb{Z}$）。\n作用在真实位错上的力是所有镜像贡献的总和。真实位错本身（对应 $+b$ 级数中 $n=0$ 的情况）被排除在求和之外。\n$$ f_{y, \\text{exact}} = \\frac{\\mu b^2}{2\\pi} \\left[ \\sum_{n=-\\infty}^{\\infty} \\frac{-1}{y_0 - (2nH - y_0)} + \\sum_{\\substack{n=-\\infty \\\\ n\\neq 0}}^{\\infty} \\frac{1}{y_0 - (2nH + y_0)} \\right] $$\n$$ f_{y, \\text{exact}} = \\frac{\\mu b^2}{2\\pi} \\left[ \\sum_{n=-\\infty}^{\\infty} \\frac{-1}{2y_0 - 2nH} + \\sum_{\\substack{n=-\\infty \\\\ n\\neq 0}}^{\\infty} \\frac{1}{-2nH} \\right] $$\n第二个和 $\\sum_{n \\neq 0} 1/(-2nH)$ 在对称（柯西主值）求和下为零。我们只剩下第一个和。\n$$ f_{y, \\text{exact}} = -\\frac{\\mu b^2}{4\\pi H} \\sum_{n=-\\infty}^{\\infty} \\frac{1}{(y_0/H) - n} $$\n使用复分析中关于亚纯函数求和的标准恒等式 $\\sum_{n=-\\infty}^{\\infty} \\frac{1}{z-n} = \\pi \\cot(\\pi z)$，我们得到精确力的闭式表达式：\n$$ f_{y, \\text{exact}} = -\\frac{\\mu b^2}{4\\pi H} \\left[ \\pi \\cot\\left(\\frac{\\pi y_0}{H}\\right) \\right] = -\\frac{\\mu b^2}{4H} \\cot\\left(\\frac{\\pi y_0}{H}\\right) $$\n此结果是用于误差计算的精确参考力。\n\n3.  截断双表面模型（近似）\n该模型是力的无穷级数的直接实现，但被截断为仅包括对应于索引 $n$（其中 $|n| \\le N$）的镜像。给定 $N=5$，求和范围为 $n \\in \\{-5, -4, \\dots, 4, 5\\}$。\n$$ f_{y, \\text{trunc}} = \\frac{\\mu b^2}{2\\pi} \\left[ \\sum_{n=-N}^{N} \\frac{-1}{2y_0 - 2nH} + \\sum_{\\substack{n=-N \\\\ n\\neq 0}}^{N} \\frac{1}{-2nH} \\right] $$\n和之前一样，第二个和为零。第一个和可以分解为 $n=0$ 项以及对 $n = 1, \\dots, N$ 的求和：\n$$ \\sum_{n=-N}^{N} \\frac{-1}{2y_0 - 2nH} = \\frac{-1}{2y_0} + \\sum_{n=1}^{N} \\left( \\frac{-1}{2y_0 - 2nH} + \\frac{-1}{2y_0 + 2nH} \\right) $$\n$$ = \\frac{-1}{2y_0} + \\sum_{n=1}^{N} \\frac{-(2y_0 + 2nH) - (2y_0 - 2nH)}{(2y_0 - 2nH)(2y_0 + 2nH)} = \\frac{-1}{2y_0} + \\sum_{n=1}^{N} \\frac{-4y_0}{4y_0^2 - 4(nH)^2} $$\n$$ = -\\frac{1}{2y_0} - y_0 \\sum_{n=1}^{N} \\frac{1}{y_0^2 - (nH)^2} $$\n将此代回力的表达式中：\n$$ f_{y, \\text{trunc}} = \\frac{\\mu b^2}{2\\pi} \\left[ -\\frac{1}{2y_0} - y_0 \\sum_{n=1}^{N} \\frac{1}{y_0^2 - (nH)^2} \\right] $$\n$$ f_{y, \\text{trunc}} = -\\frac{\\mu b^2}{4\\pi y_0} - \\frac{\\mu b^2 y_0}{2\\pi} \\sum_{n=1}^{N} \\frac{1}{y_0^2 - (nH)^2} $$\n第一项恰好是 $f_{y, \\text{one}}$。求和项提供了由直至 $N$ 阶的额外镜像引起的修正。\n\n误差量化\n每个近似的相对误差 $e$ 计算为 $e = |\\frac{f_{\\text{approx}} - f_{\\text{exact}}}{f_{\\text{exact}}}|$。使用推导出的表达式，我们将为每个指定的薄膜厚度 $H$ 计算 $e_{\\text{one}}$（单表面模型误差）和 $e_{\\text{trunc}}$（截断级数模型误差）。常数为 $\\mu = 26 \\times 10^9$ Pa, $b = 0.25 \\times 10^{-9}$ m, $y_0 = 1.0 \\times 10^{-6}$ m, 且 $N=5$。最终答案中的程序将为给定的测试用例实现这些计算。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the modeling error for image force calculations on a screw dislocation in a thin film.\n    \"\"\"\n    # Define physical constants and problem parameters\n    mu = 26.0e9  # Shear modulus in Pa\n    b = 0.25e-9   # Burgers vector magnitude in m\n    y0 = 1.0e-6   # Dislocation position from the y=0 surface in m\n    N = 5         # Truncation index for the image series\n\n    # Test cases for film thickness H in meters\n    test_cases = [\n        2.5e-6,\n        5.0e-6,\n        1.0e-5,\n        1.0e-4\n    ]\n\n    results = []\n    \n    # Common factor in force calculations\n    mu_b2 = mu * b**2\n\n    # Calculate the force for the single-surface approximation\n    # This force is independent of the film thickness H\n    f_one = -mu_b2 / (4 * np.pi * y0)\n\n    for H in test_cases:\n        # 1. Calculate the exact force using the closed-form cotangent solution\n        arg_cot = np.pi * y0 / H\n        # Handle the case where y0 = H/2, where cot(pi/2) = 0\n        if np.isclose(arg_cot, np.pi / 2):\n            f_exact = 0.0\n        else:\n            f_exact = -mu_b2 / (4 * H) / np.tan(arg_cot)\n\n        # 2. Calculate the force for the truncated two-surface model (N=5)\n        sum_term = 0.0\n        for n in range(1, N + 1):\n            sum_term += 1 / (y0**2 - (n * H)**2)\n        \n        f_trunc_correction = -(mu_b2 * y0) / (2 * np.pi) * sum_term\n        f_trunc = f_one + f_trunc_correction\n\n        # 3. Calculate relative errors\n        # Avoid division by zero if f_exact is zero (stable equilibrium)\n        if np.isclose(f_exact, 0.0):\n            # If f_exact is zero, relative error is only zero if approx is also zero.\n            # Otherwise, it's conventionally infinite or undefined. Here we test if f_approx is also zero.\n            e_one = 0.0 if np.isclose(f_one, 0.0) else np.inf\n            e_trunc = 0.0 if np.isclose(f_trunc, 0.0) else np.inf\n        else:\n            e_one = abs((f_one - f_exact) / f_exact)\n            e_trunc = abs((f_trunc - f_exact) / f_exact)\n        \n        results.append(e_one)\n        results.append(e_trunc)\n\n    # Format the final output string as specified\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2774426"}]}