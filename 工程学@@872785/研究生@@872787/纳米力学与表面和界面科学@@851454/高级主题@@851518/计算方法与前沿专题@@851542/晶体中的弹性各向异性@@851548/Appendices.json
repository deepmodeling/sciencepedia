{"hands_on_practices": [{"introduction": "任何物理上存在的材料都必须是力学稳定的，这意味着在外力作用下它会恢复原状而不是崩溃，这一基本要求在数学上转化为对其弹性刚度张量的严格约束。本练习将引导你从应变能密度必须为正的第一性原理出发，为六方晶体推导这些至关重要的稳定性条件，即玻恩判据 [@problem_id:2769822]。\n\n这项实践不仅是理论上的推导，更是检验一组弹性常数是否具有物理意义的试金石，让你能亲手判断一个假想的材料能否在现实世界中稳定存在。", "problem": "一个具有六方对称性的均匀线性弹性晶体（在 Voigt 标记法中）由五个独立的刚度表征。弹性应变能密度由 $U = \\tfrac{1}{2}\\,\\boldsymbol{\\varepsilon}^{\\mathsf{T}} \\mathbf{C} \\boldsymbol{\\varepsilon}$ 给出，其中 $\\boldsymbol{\\varepsilon}$ 是应变矢量，$\\mathbf{C}$ 是对称刚度矩阵。对于所有非零 $\\boldsymbol{\\varepsilon}$，$U$ 的正定性定义了弹性稳定性。在 $(1,2,3,4,5,6)$ Voigt 顺序下，六方晶体由对称性决定的刚度矩阵具有以下形式\n$$\n\\mathbf{C} =\n\\begin{pmatrix}\nC_{11}  C_{12}  C_{13}  0  0  0 \\\\\nC_{12}  C_{11}  C_{13}  0  0  0 \\\\\nC_{13}  C_{13}  C_{33}  0  0  0 \\\\\n0  0  0  C_{44}  0  0 \\\\\n0  0  0  0  C_{44}  0 \\\\\n0  0  0  0  0  C_{66}\n\\end{pmatrix},\n\\quad \\text{其中 } C_{66} = \\tfrac{1}{2}\\,(C_{11} - C_{12}).\n$$\n仅从对所有非零应变 $U>0$ 的要求出发，利用对称矩阵的正定性和六方对称性所蕴含的块结构，推导 $\\{C_{11}, C_{12}, C_{13}, C_{33}, C_{44}\\}$ 之间的必要且充分的稳定性不等式。然后，对于下面这组弹性常数：\n- $C_{11} = 200\\,\\mathrm{GPa}$，\n- $C_{12} = 100\\,\\mathrm{GPa}$，\n- $C_{13} = 50\\sqrt{3}\\,\\mathrm{GPa}$，\n- $C_{33} = 50\\,\\mathrm{GPa}$，\n- $C_{44} = 40\\,\\mathrm{GPa}$，\n以及 $C_{66} = \\tfrac{1}{2}\\,(C_{11}-C_{12})$，\n\n执行以下操作：\n- 评估推导出的不等式，并确定该晶体是稳定的、不稳定的还是临界稳定的。如果任何不等式恰好饱和，通过给出使相应二次型为零的 $(\\varepsilon_{1}, \\varepsilon_{2}, \\varepsilon_{3})$ 之间的比率来确定相关的正应变模式。\n- 计算完整的 $6\\times 6$ 刚度矩阵 $\\mathbf{C}$ 的最小特征值 $\\lambda_{\\min}$。\n\n将 $\\lambda_{\\min}$ 的最终数值答案以吉帕斯卡（GPa）为单位表示，并四舍五入到四位有效数字。", "solution": "弹性稳定性的首要条件是，对于任何非零应变状态，应变能密度 $U$ 必须为正。应变能密度由二次型 $U = \\frac{1}{2}\\boldsymbol{\\varepsilon}^{\\mathsf{T}} \\mathbf{C} \\boldsymbol{\\varepsilon}$ 给出，其中 $\\boldsymbol{\\varepsilon}$ 是 Voigt 标记法中的应变矢量，$\\boldsymbol{\\varepsilon} = (\\varepsilon_1, \\varepsilon_2, \\varepsilon_3, \\varepsilon_4, \\varepsilon_5, \\varepsilon_6)^{\\mathsf{T}}$，而 $\\mathbf{C}$ 是 $6 \\times 6$ 对称刚度矩阵。对于所有 $\\boldsymbol{\\varepsilon} \\neq \\mathbf{0}$，条件 $U>0$ 在数学上等价于要求矩阵 $\\mathbf{C}$ 是正定的。\n\n六方晶体的刚度矩阵如下所示：\n$$\n\\mathbf{C} =\n\\begin{pmatrix}\nC_{11}  C_{12}  C_{13}  0  0  0 \\\\\nC_{12}  C_{11}  C_{13}  0  0  0 \\\\\nC_{13}  C_{13}  C_{33}  0  0  0 \\\\\n0  0  0  C_{44}  0  0 \\\\\n0  0  0  0  C_{44}  0 \\\\\n0  0  0  0  0  C_{66}\n\\end{pmatrix}\n$$\n并附带额外约束 $C_{66} = \\frac{1}{2}(C_{11} - C_{12})$。该矩阵的块对角结构使我们能够通过检查其构成块来分析其正定性。应变能密度可以写为：\n$$\n2U = \\left( C_{11}\\varepsilon_1^2 + C_{11}\\varepsilon_2^2 + C_{33}\\varepsilon_3^2 + 2C_{12}\\varepsilon_1\\varepsilon_2 + 2C_{13}\\varepsilon_1\\varepsilon_3 + 2C_{13}\\varepsilon_2\\varepsilon_3 \\right) + C_{44}\\varepsilon_4^2 + C_{44}\\varepsilon_5^2 + C_{66}\\varepsilon_6^2\n$$\n为使 $U$ 对任何非零应变为正，二次型的每个独立部分都必须是正定的。\n\n从剪切应变项中，我们立即得到以下条件：\n1. $C_{44} > 0$\n2. $C_{66} > 0$。使用给定的约束，这变为 $\\frac{1}{2}(C_{11} - C_{12}) > 0$，这意味着 $C_{11} > C_{12}$。\n\n涉及正应变 $(\\varepsilon_1, \\varepsilon_2, \\varepsilon_3)$ 的项对应于 $3 \\times 3$ 子矩阵：\n$$\n\\mathbf{C}' =\n\\begin{pmatrix}\nC_{11}  C_{12}  C_{13} \\\\\nC_{12}  C_{11}  C_{13} \\\\\nC_{13}  C_{13}  C_{33}\n\\end{pmatrix}\n$$\n该子矩阵也必须是正定的。我们应用 Sylvester 判据，该判据指出，一个对称矩阵是正定的，当且仅当其所有顺序主子式都为正。\n第一个顺序主子式是 $D_1 = C_{11}$。为使其为正，我们必须有 $C_{11} > 0$。\n第二个顺序主子式是 $D_2 = \\det\\begin{pmatrix} C_{11}  C_{12} \\\\ C_{12}  C_{11} \\end{pmatrix} = C_{11}^2 - C_{12}^2 > 0$。由于 $C_{11}$ 必须为正，这等价于 $C_{11} > |C_{12}|$。这个条件比 $C_{11} > C_{12}$ 更严格，并蕴含了后者。\n第三个顺序主子式是 $D_3 = \\det(\\mathbf{C}')$。我们通过代数余子式展开或行变换来计算它。将第二行从第一行中减去，得到：\n$$\nD_3 = \\det\\begin{pmatrix} C_{11}-C_{12}  C_{12}-C_{11}  0 \\\\ C_{12}  C_{11}  C_{13} \\\\ C_{13}  C_{13}  C_{33} \\end{pmatrix} = (C_{11}-C_{12}) \\det\\begin{pmatrix} 1  -1  0 \\\\ C_{12}  C_{11}  C_{13} \\\\ C_{13}  C_{13}  C_{33} \\end{pmatrix}\n$$\n沿第一行展开 $3 \\times 3$ 行列式：\n$$\nD_3 = (C_{11}-C_{12}) \\left[ 1(C_{11}C_{33} - C_{13}^2) - (-1)(C_{12}C_{33} - C_{13}^2) \\right] = (C_{11}-C_{12}) \\left[ (C_{11}+C_{12})C_{33} - 2C_{13}^2 \\right]\n$$\n要使 $D_3 > 0$，并且因为我们已经确定 $C_{11}-C_{12} > 0$，所以必须有 $(C_{11}+C_{12})C_{33} - 2C_{13}^2 > 0$。\n\n因此，六方晶体的必要且充分的稳定性不等式（Born 判据）的完整集合是：\n1. $C_{44} > 0$\n2. $C_{11} > |C_{12}|$\n3. $(C_{11}+C_{12})C_{33} > 2C_{13}^2$\n注意 $C_{11} > |C_{12}|$ 蕴含了 $C_{11} > 0$ 和 $C_{66} > 0$。\n\n接下来，我们用给定的值来评估这些不等式：$C_{11} = 200\\,\\mathrm{GPa}$，$C_{12} = 100\\,\\mathrm{GPa}$，$C_{13} = 50\\sqrt{3}\\,\\mathrm{GPa}$，$C_{33} = 50\\,\\mathrm{GPa}$，以及 $C_{44} = 40\\,\\mathrm{GPa}$。\n1. $C_{44} = 40 > 0$。此条件满足。\n2. $C_{11} > |C_{12}| \\implies 200 > |100|$，即 $200 > 100$。此条件满足。\n3. $(C_{11}+C_{12})C_{33} - 2C_{13}^2 > 0$。我们计算左侧：\n$$\n(200+100)(50) - 2(50\\sqrt{3})^2 = (300)(50) - 2(2500 \\times 3) = 15000 - 15000 = 0\n$$\n该表达式的计算结果恰好为 $0$。该不等式没有被严格满足，而是饱和了（$0 \\ge 0$ 成立，但 $0 > 0$ 不成立）。这表明晶体是 **临界稳定的**。存在一个非零的正应变模式，其应变能为零。\n\n这个零能模式对应于矩阵 $\\mathbf{C}'$ 的零空间。我们求解 $\\mathbf{C}' \\boldsymbol{\\varepsilon}' = \\mathbf{0}$，找到应变矢量 $\\boldsymbol{\\varepsilon}' = (\\varepsilon_1, \\varepsilon_2, \\varepsilon_3)^{\\mathsf{T}}$。\n$$\n\\begin{pmatrix} 200  100  50\\sqrt{3} \\\\ 100  200  50\\sqrt{3} \\\\ 50\\sqrt{3}  50\\sqrt{3}  50 \\end{pmatrix} \\begin{pmatrix} \\varepsilon_1 \\\\ \\varepsilon_2 \\\\ \\varepsilon_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n从前两个方程中，用第二个方程减去第一个方程，得到 $-100\\varepsilon_1 + 100\\varepsilon_2 = 0$，这意味着 $\\varepsilon_1 = \\varepsilon_2$。将此结果代入第三个方程（除以 $50$ 后）：\n$$\n\\sqrt{3}\\varepsilon_1 + \\sqrt{3}\\varepsilon_1 + \\varepsilon_3 = 0 \\implies 2\\sqrt{3}\\varepsilon_1 + \\varepsilon_3 = 0 \\implies \\varepsilon_3 = -2\\sqrt{3}\\varepsilon_1\n$$\n因此，正应变模式由比率 $(\\varepsilon_1, \\varepsilon_2, \\varepsilon_3) \\propto (1, 1, -2\\sqrt{3})$ 定义。\n\n最后，我们计算完整的 $6 \\times 6$ 矩阵 $\\mathbf{C}$ 的最小特征值 $\\lambda_{\\min}$。块对角矩阵的特征值是其对角块的特征值。$\\mathbf{C}$ 的特征值是 $\\mathbf{C}'$ 的特征值与对角线元素 $C_{44}$、$C_{44}$ 和 $C_{66}$ 的并集。\n来自剪切分量的特征值是：\n- $\\lambda = C_{44} = 40$（重数为 $2$）\n- $\\lambda = C_{66} = \\frac{1}{2}(C_{11}-C_{12}) = \\frac{1}{2}(200-100) = 50$\n\n对于 $\\mathbf{C}'$ 的特征值，我们已经知道 $\\det(\\mathbf{C}') = 0$，所以一个特征值必须是 $0$。设 $\\mathbf{C}'$ 的特征值为 $\\lambda'_1, \\lambda'_2, \\lambda'_3$。所以，其中一个是 $0$。为了找到其他特征值，我们可以求解特征方程 $\\det(\\mathbf{C}'-\\lambda\\mathbf{I})=0$。\n可以通过利用对称性来简化问题。一个特征向量的形式为 $(1, -1, 0)^{\\mathsf{T}}$，其给出的特征值为 $\\lambda' = C_{11}-C_{12} = 200-100 = 100$。\n另外两个特征向量与此正交，并且形式为 $(a, a, b)^{\\mathsf{T}}$。特征值问题简化为一个 $2 \\times 2$ 系统：\n$$\n\\begin{pmatrix} C_{11}+C_{12}  \\sqrt{2}C_{13} \\\\ \\sqrt{2}C_{13}  C_{33} \\end{pmatrix} \\begin{pmatrix} \\sqrt{2}a \\\\ b \\end{pmatrix} = \\lambda \\begin{pmatrix} \\sqrt{2}a \\\\ b \\end{pmatrix}\n$$\n该子系统的特征方程是 $\\lambda^2 - (C_{11}+C_{12}+C_{33})\\lambda + (C_{11}+C_{12})C_{33} - 2C_{13}^2 = 0$。\n代入数值：\n$$\n\\lambda^2 - (200+100+50)\\lambda + (200+100)(50) - 2(50\\sqrt{3})^2 = 0\n$$\n$$\n\\lambda^2 - 350\\lambda + 15000 - 15000 = 0\n$$\n$$\n\\lambda(\\lambda - 350) = 0\n$$\n该子系统的特征值为 $\\lambda = 0$ 和 $\\lambda = 350$。\n因此，$\\mathbf{C}'$ 的三个特征值是 $\\{350, 100, 0\\}$。\n\n矩阵 $\\mathbf{C}$ 的六个特征值的完整集合是 $\\{350, 100, 0, 50, 40, 40\\}$。\n最小特征值 $\\lambda_{\\min}$ 是这个集合中的最小值。\n$$\n\\lambda_{\\min} = \\min\\{350, 100, 0, 50, 40, 40\\} = 0\n$$\n该值恰好为 $0$ GPa。按要求表示为四位有效数字，即为 $0.0000$ GPa。", "answer": "$$\n\\boxed{0.0000}\n$$", "id": "2769822"}, {"introduction": "晶体的各向异性意味着其力学响应（如刚度）会随方向而改变，这对于理解和预测材料在复杂应力下的行为至关重要，尤其是在滑移和塑性变形等领域。本练习将具体量化这种效应，通过计算立方晶体中特定晶面和晶向上的有效剪切模量，来揭示其方向依赖性 [@problem_id:2769831]。\n\n通过完成这项计算，你不仅能掌握处理各向异性弹性张量的技巧，还能将抽象的理论与晶体滑移等具体的物理现象联系起来，深入理解为何材料的强度具有方向性。", "problem": "一个具有立方对称性的单晶，其在晶轴中定义的弹性刚度为 $C_{11}$、$C_{12}$ 和 $C_{44}$。考虑一个由单位平面法向 $\\mathbf{n}$ 和平面内单位剪切方向 $\\mathbf{m}$（满足 $\\mathbf{m} \\cdot \\mathbf{n} = 0$）定义的简单剪切加载。从胡克定律的张量形式 $\\varepsilon_{ij} = S_{ijkl} \\sigma_{kl}$ 出发，其中 $S_{ijkl}$ 是弹性柔度张量（刚度张量的逆），推导所施加的分解剪应力 $\\tau = \\mathbf{m} \\cdot \\boldsymbol{\\sigma} \\, \\mathbf{n}$ 和工程剪应变 $\\gamma = 2 \\, \\mathbf{m} \\cdot \\boldsymbol{\\varepsilon} \\, \\mathbf{n}$ 之间用立方柔度分量表示的关系。仅使用立方张量的基本对称性和工程剪应变的定义。\n\n然后，将您的结果具体应用于以下两种取向：\n\n- 在 $\\{111\\}$ 面上沿 $\\langle 11\\bar{2} \\rangle$ 方向的剪切，取 $\\mathbf{n} \\parallel [111]$ 和 $\\mathbf{m} \\parallel [11\\bar{2}]$。\n- 在 $\\{100\\}$ 面上沿 $\\langle 010 \\rangle$ 方向的剪切，取 $\\mathbf{n} \\parallel [100]$ 和 $\\mathbf{m} \\parallel [010]$。\n\n计算相应的有效剪切模量 $G_{111}$ 和 $G_{100}$（用 $C_{11}$、$C_{12}$ 和 $C_{44}$ 表示），并报告比值 $R = G_{111}/G_{100}$，表示为Zener各向异性因子 $A = 2 C_{44}/(C_{11} - C_{12})$ 的封闭形式解析函数。以 $R$ 关于 $A$ 的单个简化解析表达式的形式给出最终答案（无量纲，无单位）。", "solution": "线性弹性材料的本构关系是胡克定律，用柔度张量 $S_{ijkl}$ 表示为 $\\varepsilon_{ij} = S_{ijkl} \\sigma_{kl}$。对于一个由法向 $\\mathbf{n}$ 和剪切方向 $\\mathbf{m}$ 定义的简单剪切，应力张量为 $\\sigma_{ij} = \\tau (m_i n_j + n_i m_j)$，其中 $\\tau$ 是分解剪应力。\n\n有效剪切模量 $G$ 定义为 $G = \\tau / \\gamma$，其中工程剪应变 $\\gamma = 2 (\\mathbf{m} \\cdot \\boldsymbol{\\varepsilon} \\cdot \\mathbf{n})$。因此，有效柔度 $1/G$ 可以通过将应变和应力关系代入来推导。通过使用能量法或张量变换，可以得到立方晶体中有效剪切柔度的一般关系式：\n$$ \\frac{1}{G} = S_{44} + 4\\left(S_{11} - S_{12} - \\frac{S_{44}}{2}\\right) \\sum_{p=1}^3 m_p^2 n_p^2 $$\n其中 $S_{11}$、$S_{12}$ 和 $S_{44}$ 是Voigt标记法中的独立柔度分量，$m_p$ 和 $n_p$ 分别是 $\\mathbf{m}$ 和 $\\mathbf{n}$ 在晶轴坐标系下的分量。\n\n柔度分量 $S_{ij}$ 通过矩阵求逆与刚度分量 $C_{ij}$ 相关联。对于立方晶体：\n$S_{11} - S_{12} = \\frac{1}{C_{11}-C_{12}}$ 且 $S_{44} = \\frac{1}{C_{44}}$。\n将这些代入 $1/G$ 的表达式中：\n$$ \\frac{1}{G} = \\frac{1}{C_{44}} + 4\\left(\\frac{1}{C_{11}-C_{12}} - \\frac{1}{2C_{44}}\\right) \\sum_{p=1}^3 m_p^2 n_p^2 $$\n$$ \\frac{1}{G} = \\frac{1}{C_{44}} + \\left(\\frac{4}{C_{11}-C_{12}} - \\frac{2}{C_{44}}\\right) \\sum_{p=1}^3 m_p^2 n_p^2 $$\n\n现在，我们将此结果具体应用于给定的两种取向。\n情况1：在 $\\{111\\}$ 面上沿 $\\langle 11\\bar{2} \\rangle$ 方向的剪切 ($G_{111}$)。\n单位法向量为 $\\mathbf{n} = \\frac{1}{\\sqrt{3}}(1, 1, 1)$。单位剪切方向为 $\\mathbf{m} = \\frac{1}{\\sqrt{6}}(1, 1, -2)$。\n取向因子为 $\\sum_{p=1}^3 m_p^2 n_p^2 = m_1^2 n_1^2 + m_2^2 n_2^2 + m_3^2 n_3^2 = \\left(\\frac{1}{\\sqrt{6}}\\right)^2\\left(\\frac{1}{\\sqrt{3}}\\right)^2 + \\left(\\frac{1}{\\sqrt{6}}\\right)^2\\left(\\frac{1}{\\sqrt{3}}\\right)^2 + \\left(\\frac{-2}{\\sqrt{6}}\\right)^2\\left(\\frac{1}{\\sqrt{3}}\\right)^2 = \\frac{1}{18} + \\frac{1}{18} + \\frac{4}{18} = \\frac{6}{18} = \\frac{1}{3}$。\n将此代入 $1/G$ 的通用公式中：\n$$ \\frac{1}{G_{111}} = \\frac{1}{C_{44}} + \\left(\\frac{4}{C_{11}-C_{12}} - \\frac{2}{C_{44}}\\right) \\frac{1}{3} = \\frac{1}{C_{44}} + \\frac{4}{3(C_{11}-C_{12})} - \\frac{2}{3C_{44}} = \\frac{1}{3C_{44}} + \\frac{4}{3(C_{11}-C_{12})} $$\n$$ G_{111} = \\frac{1}{\\frac{1}{3C_{44}} + \\frac{4}{3(C_{11}-C_{12})}} = \\frac{3 C_{44}(C_{11}-C_{12})}{C_{11}-C_{12} + 4C_{44}} $$\n\n情况2：在 $\\{100\\}$ 面上沿 $\\langle 010 \\rangle$ 方向的剪切 ($G_{100}$)。\n单位法向量为 $\\mathbf{n} = (1, 0, 0)$。单位剪切方向为 $\\mathbf{m} = (0, 1, 0)$。\n取向因子为 $\\sum_{p=1}^3 m_p^2 n_p^2 = (0)^2(1)^2 + (1)^2(0)^2 + (0)^2(0)^2 = 0$。\n将此代入 $1/G$ 的通用公式中：\n$$ \\frac{1}{G_{100}} = \\frac{1}{C_{44}} + \\left(\\frac{4}{C_{11}-C_{12}} - \\frac{2}{C_{44}}\\right) (0) = \\frac{1}{C_{44}} $$\n$$ G_{100} = C_{44} $$\n\n最后，我们计算比值 $R = G_{111}/G_{100}$，并用Zener各向异性因子 $A = \\frac{2C_{44}}{C_{11}-C_{12}}$ 来表示它。\n$$ R = \\frac{G_{111}}{G_{100}} = \\frac{\\frac{3 C_{44}(C_{11}-C_{12})}{C_{11}-C_{12} + 4C_{44}}}{C_{44}} = \\frac{3(C_{11}-C_{12})}{C_{11}-C_{12} + 4C_{44}} $$\n为了用 $A$ 来表示，我们将分子和分母同除以 $(C_{11}-C_{12})$：\n$$ R = \\frac{3}{1 + \\frac{4C_{44}}{C_{11}-C_{12}}} $$\n根据 $A$ 的定义，我们可以写出 $\\frac{C_{44}}{C_{11}-C_{12}} = \\frac{A}{2}$。将此关系代入 $R$ 的表达式中：\n$$ R = \\frac{3}{1 + 4\\left(\\frac{A}{2}\\right)} = \\frac{3}{1+2A} $$\n这是剪切模量之比关于Zener各向异性因子的最终简化表达式。对于各向同性材料，$A=1$，此时 $R=1$，符合预期。", "answer": "$$\\boxed{\\frac{3}{1+2A}}$$", "id": "2769831"}, {"introduction": "理论模型中的弹性常数并非凭空而来，它们源于精确的实验测量。在现代材料科学中，超声技术是确定这些常数的标准方法，它通过测量声波在晶体中不同方向的传播速度来实现。本练习将让你扮演实验物理学家的角色，建立声速与弹性常数之间的理论联系 [@problem_id:2769828]。\n\n你将从实验“数据”出发，利用克里斯托费尔方程构建一个线性系统，并应用最小二乘法来反演出最符合数据的弹性常数值。这个过程完美地再现了从实验观测到材料参数确定的完整科学流程，是理论与实践结合的典范。", "problem": "您将编写一个完整的、可运行的程序，该程序根据沿高对称性晶向的相速度的超声脉冲回波测量值，估算立方晶体的三个独立弹性刚度常数（表示为 $C_{11}$、$C_{12}$ 和 $C_{44}$）。您的估算必须从第一性原理出发，以各向异性介质中平面波的运动方程和 Christoffel 方程为起点，构建为一个线性最小二乘问题。其控制基础如下：线性弹性本构定律 $\\sigma_{ij} = C_{ijkl} \\varepsilon_{kl}$，运动方程 $\\rho \\, \\partial^2 u_i / \\partial t^2 = \\partial_j \\sigma_{ij}$，以及平面波拟设 $u_i(\\mathbf{x},t) = U_i \\exp\\!\\left(i k \\, n_j x_j - i \\omega t\\right)$，由此可导出 Christoffel 方程 $\\Gamma_{ik} U_k = \\rho v^2 U_i$。其中，$\\Gamma_{ik} = C_{ijkl} n_j n_l$，$\\rho$ 是质量密度，$v = \\omega/k$ 是相速度，$n_j$ 是单位传播方向。对于在晶轴坐标系下的立方晶体，其四阶刚度张量具有三个独立的组分 $C_{11}$、$C_{12}$ 和 $C_{44}$。\n\n您的任务是：\n- 将 Christoffel 矩阵特化为立方对称性，并沿高对称性方向 $[100]$、$[110]$ 和 $[111]$ 进行计算，从而推导出对于每种不同的声学模式（一个纵波模式，以及在非简并情况下的两个横波模式），连接 $\\rho v^2$ 与 $C_{11}$、$C_{12}$ 和 $C_{44}$ 的线性关系。请勿使用任何未经推导的快捷公式；仅从已定义的基础和立方对称性下的 $\\Gamma_{ik}$ 结构形式出发。一旦您在推理中证明了这些线性关系，您的程序便可直接使用它们作为系数。\n- 对于每个给定的测试用例，为每一次测量 $m$ 构建一个超定或恰定的线性系统，其形式为\n$$\n\\rho \\, v_m^2 \\;=\\; a_m \\, C_{11} \\;+\\; b_m \\, C_{12} \\;+\\; c_m \\, C_{44},\n$$\n其中系数 $(a_m, b_m, c_m)$ 取决于传播方向和模式。\n- 使用数值稳定的方法，以最小二乘意义求解 $(C_{11}, C_{12}, C_{44})$。\n- 以吉帕斯卡 (GPa) 为单位表示最终估算值，并四舍五入到三位小数。\n\n为消除歧义而对测量标签的定义：\n- 方向 $[100]$：模式为 $L$（纵波）和 $T$（横波；两个横波模式是简并的，速度相同）。\n- 方向 $[110]$：模式为 $L$（纵波）、$T1$（其速度取决于差值 $C_{11}-C_{12}$ 的横波模式，极化方向沿 $[1\\bar{1}0]$）和 $T2$（其速度仅取决于 $C_{44}$ 的横波模式，极化方向沿 $[001]$）。\n- 方向 $[111]$：模式为 $L$（纵波）和 $T$（横波；两个横波模式是简并的，速度相同）。\n\n角度单位已通过晶向隐式给出；不需要三角函数角度。所有速度单位为米/秒 (m/s)，所有密度单位为千克/立方米 (kg/m$^3$)。您的程序应输出以吉帕斯卡 (GPa) 为单位的估算刚度值，并四舍五入到三位小数。\n\n测试套件：\n- 测试用例 1（冗余，超定；七次测量）：\n  - 密度：$\\rho = 2700$ kg/m$^3$\n  - 测量（方向，模式，速度单位 m/s）：\n    1. $([100], L, 6324.555320)$\n    2. $([100], T, 3220.305943)$\n    3. $([110], L, 6454.972245)$\n    4. $([110], T1, 2950.204011)$\n    5. $([110], T2, 3220.305943)$\n    6. $([111], L, 6497.862866)$\n    7. $([111], T, 3042.903097)$\n- 测试用例 2（冗余，超定；七次测量）：\n  - 密度：$\\rho = 8000$ kg/m$^3$\n  - 测量（方向，模式，速度单位 m/s）：\n    1. $([100], L, 4898.979486)$\n    2. $([100], T, 2449.489743)$\n    3. $([110], L, 5049.752500)$\n    4. $([110], T1, 2121.320344)$\n    5. $([110], T2, 2449.489743)$\n    6. $([111], L, 5099.019514)$\n    7. $([111], T, 2236.067978)$\n- 测试用例 3（恰定；三次测量）：\n  - 密度：$\\rho = 7500$ kg/m$^3$\n  - 测量（方向，模式，速度单位 m/s）：\n    1. $([100], L, 4472.135955)$\n    2. $([110], T1, 2000.000000)$\n    3. $([111], L, 4472.135955)$\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按以下扁平化顺序排列：\n$$\n[\\widehat{C}_{11}^{(1)}, \\widehat{C}_{12}^{(1)}, \\widehat{C}_{44}^{(1)}, \\widehat{C}_{11}^{(2)}, \\widehat{C}_{12}^{(2)}, \\widehat{C}_{44}^{(2)}, \\widehat{C}_{11}^{(3)}, \\widehat{C}_{12}^{(3)}, \\widehat{C}_{44}^{(3)}],\n$$\n其中上标 $(1),(2),(3)$ 表示测试用例的索引。每个条目必须以吉帕斯卡 (GPa) 为单位，并四舍五入到三位小数。例如，输出可能如下所示\n$$\n[108.000,61.000,28.000,192.000,120.000,48.000,150.000,90.000,30.000].\n$$", "solution": "任务是通过求解一个由超声速度测量构建的线性最小二乘问题，来确定立方晶体的三个独立弹性刚度常数 $C_{11}$、$C_{12}$ 和 $C_{44}$。\n\n根据规定，推导必须从第一性原理开始。运动方程与平面波拟设相结合，可导出 Christoffel 特征值方程 $\\Gamma_{ik} U_k = \\rho v^2 U_i$，其中 Christoffel 矩阵 $\\Gamma_{ik}$ 定义为 $\\Gamma_{ik} = C_{ijkl} n_j n_l$。\n\n对于立方晶体，刚度张量 $C_{ijkl}$ 只有三个独立分量：$C_{1111}=C_{11}$、$C_{1122}=C_{12}$ 和 $C_{2323}=C_{44}$（在 Voigt 记法中）。对于一般传播方向 $\\mathbf{n}=(n_1, n_2, n_3)$，Christoffel 矩阵 $\\Gamma_{ik}$ 的分量为：\n$$\n\\Gamma_{11} = C_{11} n_1^2 + C_{44} (n_2^2 + n_3^2) \\\\\n\\Gamma_{22} = C_{11} n_2^2 + C_{44} (n_1^2 + n_3^2) \\\\\n\\Gamma_{33} = C_{11} n_3^2 + C_{44} (n_1^2 + n_2^2) \\\\\n\\Gamma_{12} = \\Gamma_{21} = (C_{12} + C_{44}) n_1 n_2 \\\\\n\\Gamma_{13} = \\Gamma_{31} = (C_{12} + C_{44}) n_1 n_3 \\\\\n\\Gamma_{23} = \\Gamma_{32} = (C_{12} + C_{44}) n_2 n_3\n$$\n我们现在针对指定的高对称性方向计算该矩阵的特征值 $\\lambda = \\rho v^2$。\n\n1.  方向 $\\mathbf{n} = [100]$:\n    特征值为 $C_{11}$ 和 $C_{44}$（二重简并）。\n    -   $\\rho v_L^2 = C_{11}$\n    -   $\\rho v_T^2 = C_{44}$\n\n2.  方向 $\\mathbf{n} = [110]$:\n    特征值为 $C_{44}$，$\\frac{1}{2}(C_{11}+C_{12}+2C_{44})$ 和 $\\frac{1}{2}(C_{11}-C_{12})$。\n    -   $\\rho v_L^2 = \\frac{1}{2} C_{11} + \\frac{1}{2} C_{12} + C_{44}$\n    -   $\\rho v_{T1}^2 = \\frac{1}{2} C_{11} - \\frac{1}{2} C_{12}$\n    -   $\\rho v_{T2}^2 = C_{44}$\n\n3.  方向 $\\mathbf{n} = [111]$:\n    特征值为 $\\frac{1}{3}(C_{11}+2C_{12}+4C_{44})$ 和 $\\frac{1}{3}(C_{11}-C_{12}+C_{44})$（二重简并）。\n    -   $\\rho v_L^2 = \\frac{1}{3} C_{11} + \\frac{2}{3} C_{12} + \\frac{4}{3} C_{44}$\n    -   $\\rho v_T^2 = \\frac{1}{3} C_{11} - \\frac{1}{3} C_{12} + \\frac{1}{3} C_{44}$\n\n现在我们可以为未知向量 $\\mathbf{x} = [C_{11}, C_{12}, C_{44}]^T$ 构建一个线性系统 $A \\mathbf{x} = \\mathbf{y}$。对于给定方向和模式下速度为 $v_m$ 的每次测量 $m$，我们在矩阵 $A$ 中有一个对应的行，在向量 $\\mathbf{y}$ 中有一个对应的条目。令 $y_m = \\rho v_m^2$。方程 $a_m C_{11} + b_m C_{12} + c_m C_{44} = y_m$ 的系数 $(a_m, b_m, c_m)$ 如下：\n-   $([100], L)$: $(1, 0, 0)$\n-   $([100], T)$: $(0, 0, 1)$\n-   $([110], L)$: $(1/2, 1/2, 1)$\n-   $([110], T1)$: $(1/2, -1/2, 0)$\n-   $([110], T2)$: $(0, 0, 1)$\n-   $([111], L)$: $(1/3, 2/3, 4/3)$\n-   $([111], T)$: $(1/3, -1/3, 1/3)$\n\n对于每个测试用例，我们根据提供的测量数据组装矩阵 $A$ 和向量 $\\mathbf{y}$。由于系统可能是超定的，我们以最小二乘意义求解 $\\mathbf{x}$。该过程通过以下程序实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Estimates the elastic stiffness constants C11, C12, C44 for cubic crystals\n    from ultrasonic velocity measurements by solving a linear least-squares problem.\n    \"\"\"\n    # Define the coefficients (a_m, b_m, c_m) for the linear system\n    # rho * v^2 = a*C11 + b*C12 + c*C44\n    # derived from the Christoffel equation for high-symmetry directions.\n    coeffs_map = {\n        ('100', 'L'):  (1.0, 0.0, 0.0),\n        ('100', 'T'):  (0.0, 0.0, 1.0),\n        ('110', 'L'):  (0.5, 0.5, 1.0),\n        ('110', 'T1'): (0.5, -0.5, 0.0),\n        ('110', 'T2'): (0.0, 0.0, 1.0),\n        ('111', 'L'):  (1/3, 2/3, 4/3),\n        ('111', 'T'):  (1/3, -1/3, 1/3),\n    }\n\n    test_cases = [\n        {\n            \"density\": 2700.0,\n            \"measurements\": [\n                ('100', 'L', 6324.555320),\n                ('100', 'T', 3220.305943),\n                ('110', 'L', 6454.972245),\n                ('110', 'T1', 2950.204011),\n                ('110', 'T2', 3220.305943),\n                ('111', 'L', 6497.862866),\n                ('111', 'T', 3042.903097),\n            ]\n        },\n        {\n            \"density\": 8000.0,\n            \"measurements\": [\n                ('100', 'L', 4898.979486),\n                ('100', 'T', 2449.489743),\n                ('110', 'L', 5049.752500),\n                ('110', 'T1', 2121.320344),\n                ('110', 'T2', 2449.489743),\n                ('111', 'L', 5099.019514),\n                ('111', 'T', 2236.067978),\n            ]\n        },\n        {\n            \"density\": 7500.0,\n            \"measurements\": [\n                ('100', 'L', 4472.135955),\n                ('110', 'T1', 2000.000000),\n                ('111', 'L', 4472.135955),\n            ]\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        rho = case[\"density\"]\n        measurements = case[\"measurements\"]\n        \n        num_measurements = len(measurements)\n        A = np.zeros((num_measurements, 3))\n        y = np.zeros(num_measurements)\n        \n        for i, (direction, mode, velocity) in enumerate(measurements):\n            # Look up coefficients for the current measurement\n            A[i, :] = coeffs_map[(direction, mode)]\n            \n            # Calculate the target value rho * v^2\n            y[i] = rho * (velocity ** 2)\n            \n        # Solve the linear system A*x = y for x = [C11, C12, C44] in the least-squares sense.\n        # This is robust for both overdetermined and just-determined systems.\n        # The solution 'x' will be in Pascals.\n        x, _, _, _ = np.linalg.lstsq(A, y, rcond=None)\n        \n        # Convert results from Pascals to GigaPascals (GPa)\n        C_GPa = x / 1e9\n        \n        # Round to three decimal places\n        C_rounded = np.round(C_GPa, 3)\n        \n        all_results.extend(C_rounded)\n\n    # Format the final output as a comma-separated list in brackets.\n    # The 'f' format specifier ensures that numbers like 108.0 are printed as 108.000.\n    formatted_results = [f\"{val:.3f}\" for val in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2769828"}]}