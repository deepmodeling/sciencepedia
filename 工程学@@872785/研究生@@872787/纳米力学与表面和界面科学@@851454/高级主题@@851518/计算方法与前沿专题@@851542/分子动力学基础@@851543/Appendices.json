{"hands_on_practices": [{"introduction": "在任何分子动力学模拟中，一个基本的检验标准是在微正则系综 (NVE) 中总能量是否守恒。本练习 [@problem_id:2059342] 展示了一个能量不守恒的常见故障排查情景，要求你诊断最有可能的数值问题。理解这类人为误差的成因，是进行可靠且具有物理意义的模拟所迈出的关键第一步。", "problem": "一位本科生研究员正在建立他的第一个分子动力学（MD）模拟，以研究一个小肽在真空中的折叠过程。为确保遵循基本物理定律，他选择在微正则（NVE）系综中运行模拟，其中粒子数（N）、系统体积（V）和总能量（E）应保持守恒。启动模拟后，他监测了系统的属性。他绘制了肽的总能量随时间变化的图表，并观察到在整个模拟过程中，总能量出现了缓慢但持续的向上漂移。这表明能量没有守恒，这是一种不符合物理规律的人为现象。\n\n根据MD模拟的原理，以下哪个选项最可能是导致总能量系统性增加的数值问题？\n\nA. 模拟盒子尺寸选择得过大。\n\nB. 分配给原子的初始速度对应的温度远高于期望的目标温度。\n\nC. 用于传播原子位置和速度的积分时间步长过大。\n\nD. 使用的力场不准确地描述了键伸缩势。\n\nE. 将坐标写入输出文件的频率过低。", "solution": "问题的核心在于理解分子动力学模拟中可能出现的人为误差，特别是在微正则（NVE）系综的背景下。根据定义，NVE系综必须保持系统总能量守恒，总能量是动能（$K$）和势能（$U$）之和。如果观察到总能量（$E = K + U$）发生漂移，这表明模拟的数值实现存在缺陷，因为其底层的物理学（牛顿运动定律）是完全能量守恒的。\n\n让我们分析一下提供的选项：\n\nA. 模拟盒子尺寸过大意味着肽在一个巨大的真空中进行模拟。这样做计算效率低下，但不会违反任何物理定律，也不会引入导致能量不守恒的数值不稳定性。这仅仅意味着肽很少与其周期性映像相互作用（如果禁用了周期性边界条件，则根本不相互作用）。因此，这是一个不正确的选项。\n\nB. 以对应于非常高温度的初始速度开始模拟，仅仅意味着系统以一个高的总能量开始。在一个正常运行的NVE模拟中，总能量应该围绕这个高的初始值保持恒定（伴有小幅波动）。这不能解释能量随时间持续、系统性地*增加*。因此，这是一个不正确的选项。\n\nC. 积分时间步长是MD模拟中的一个关键参数。牛顿运动方程，$F=ma$，是连续微分方程。模拟通过将时间离散化为小步长 $\\Delta t$ 来对这些方程进行数值求解。像Verlet或Leapfrog这样的积分算法假定作用在原子上的力在这个小时间步长内是恒定的。然而，力会随着原子的移动而改变。如果 $\\Delta t$ 太大，原子可能在一个步长内移动很长的距离，进入势能高得多的区域（例如，空间位阻冲突）。基于该步*开始*时的力的数值积分器，可能无法准确捕捉真实轨迹。这种不准确性通常会导致在下一步中系统性地高估粒子速度，从而引起动能的净增加，而这种增加没有被势能的相应减少所补偿。这是一个众所周知的数值人为误差，它破坏了NVE系综的能量守恒，导致总能量出现特征性的向上漂移。这是最可能的原因。\n\nD. 不准确的力场，例如键伸缩参数不佳的力场，意味着模拟分子的势能面与真实分子不匹配。虽然这会导致物理上不正确的动力学，但它并不会固有地违反所模拟的*模型*系统的能量守恒原理。只要数值积分是稳定的，模拟仍然会保持这个有缺陷模型的总能量守恒。因此，这是一个不正确的选项。\n\nE. 将坐标写入输出文件的频率纯粹是一个数据记录参数。它决定了为后续分析保存多少模拟的“快照”。降低数据保存频率对每个时间步都在运行的底层物理或积分算法没有影响。无论其状态被记录的频率如何，模拟都继续根据积分器演化。因此，这个选项是不正确的。\n\n结论：在NVE模拟中，导致总能量系统性向上漂移的最常见和最直接的原因是，选择的积分时间步长相对于系统的最快运动（通常是键振动）来说过大，从而导致积分算法出现数值不稳定性。", "answer": "$$\\boxed{C}$$", "id": "2059342"}, {"introduction": "在实际操作中，为了降低计算成本，分子间相互作用会在有限的截断半径处被截断，但这会引入系统性误差。本练习 [@problem_id:2771807] 将指导你推导Lennard-Jones流体中能量和压力的长程“尾部校正”项。掌握这一基本推导，对于从采用势能截断的模拟中获得精确的热力学性质至关重要。", "problem": "考虑一种均匀、各向同性的流体，其数密度为 $\\rho$，原子间通过 Lennard-Jones 对势 $u(r)=4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$ 相互作用。在分子动力学 (MD) 模拟中，假设势能在有限的截断半径 $r_{c}$ 处被截断（但未平移），即忽略 $r>r_{c}$ 时的相互作用。假设对于超出截断半径的距离，径向分布函数满足 $g(r)=1$ for $r\\ge r_{c}$。\n\n从适用于经典统计力学和纳米力学的第一性原理出发——即 (i) 将位形势能定义为对相互作用之和及其对于均匀流体的连续介质表示，以及 (ii) 压力的力学（Clausius）维里表达式——推导必须添加到截断系统中以估算完整的、未截断值的长程尾部修正的闭式表达式：\n- 由于忽略 $r>r_{c}$ 而缺失的单位粒子位形势能 $\\Delta U/N$，\n- 由于忽略 $r>r_{c}$ 而缺失的对压力的位形（维里）贡献 $\\Delta p$。\n\n你的最终答案仅需用 $\\rho$、$\\epsilon$、$\\sigma$ 和 $r_{c}$ 的符号表示。将两个结果以单个行向量 $\\left[\\Delta U/N,\\ \\Delta p\\right]$ 的形式提供。最终的方框答案中不要包含单位。", "solution": "所述问题需进行验证。\n\n已知条件逐字提取如下：\n- 一种均匀、各向同性的流体。\n- 数密度：$\\rho$。\n- 对势：$u(r)=4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$。\n- 势能在截断半径 $r_{c}$ 处被截断。\n- 对于 $r\\ge r_{c}$，径向分布函数 $g(r)=1$。\n- 任务：推导单位粒子势能 ($\\Delta U/N$) 和压力 ($\\Delta p$) 的长程尾部修正。\n- 要求方法：从第一性原理推导，特别是位形势能的连续介质表示和压力的 Clausius 维里表达式。\n- 最终答案的依赖关系：必须用 $\\rho$、$\\epsilon$、$\\sigma$ 和 $r_{c}$ 表示。\n\n验证结论：\n该问题具有科学依据，提法明确且客观。这是统计力学和分子模拟中的一个标准推导，基于基本原理（Lennard-Jones 势、径向分布函数、维里定理）。诸如对于 $r \\ge r_{c}$，$g(r)=1$ 的假设是为此特定目的而使用的物理上合理的近似。该问题是自洽的、一致的，并且需要对已建立的理论进行非平凡但标准的运用。它没有违反任何指定的无效标准。因此，该问题有效，并将提供解答。\n\n推导过程按照要求从经典统计力学的基本原理开始。\n\n首先，我们推导单位粒子位形势能的尾部修正 $\\Delta U/N$。\n一个包含 $N$ 个粒子、体积为 $V$、数密度为 $\\rho = N/V$ 的系统的总位形势能 $U$ 可以表示为对势 $u(r)$ 乘以径向分布函数 $g(r)$ 的积分：\n$$U = \\frac{N}{2} \\int_{V} \\rho g(r) u(r) d\\mathbf{r} = \\frac{N\\rho}{2} \\int_0^\\infty u(r) g(r) 4\\pi r^2 dr$$\n因此，单位粒子的势能为：\n$$\\frac{U}{N} = 2\\pi\\rho \\int_0^\\infty u(r) g(r) r^2 dr$$\n在势能截断半径为 $r_c$ 的模拟中，计算出的能量 $U_{trunc}$ 只包括 $r \\le r_c$ 的相互作用。尾部修正 $\\Delta U$ 是来自 $r > r_c$ 的相互作用的贡献：\n$$\\frac{\\Delta U}{N} = 2\\pi\\rho \\int_{r_c}^\\infty u(r) g(r) r^2 dr$$\n使用所给的假设，即对于 $r \\ge r_c$，$g(r)=1$，上式简化为：\n$$\\frac{\\Delta U}{N} = 2\\pi\\rho \\int_{r_c}^\\infty u(r) r^2 dr$$\n现在我们代入 Lennard-Jones 势，$u(r)=4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$：\n$$\\frac{\\Delta U}{N} = 2\\pi\\rho \\int_{r_c}^\\infty 4\\epsilon\\left[\\sigma^{12}r^{-12} - \\sigma^6 r^{-6}\\right] r^2 dr$$\n$$\\frac{\\Delta U}{N} = 8\\pi\\rho\\epsilon \\int_{r_c}^\\infty \\left( \\sigma^{12}r^{-10} - \\sigma^6 r^{-4} \\right) dr$$\n进行积分：\n$$\\frac{\\Delta U}{N} = 8\\pi\\rho\\epsilon \\left[ \\sigma^{12}\\frac{r^{-9}}{-9} - \\sigma^6 \\frac{r^{-3}}{-3} \\right]_{r_c}^\\infty$$\n$$\\frac{\\Delta U}{N} = 8\\pi\\rho\\epsilon \\left[ \\left( \\lim_{r\\to\\infty} \\left( -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3} \\right) \\right) - \\left( -\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3} \\right) \\right]$$\n$$\\frac{\\Delta U}{N} = 8\\pi\\rho\\epsilon \\left[ 0 - \\left( -\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3} \\right) \\right]$$\n$$\\frac{\\Delta U}{N} = 8\\pi\\rho\\epsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right)$$\n为清晰起见，我们可以对该表达式进行因式分解：\n$$\\frac{\\Delta U}{N} = \\frac{8\\pi\\rho\\epsilon\\sigma^3}{3} \\left[ \\frac{1}{3}\\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3 \\right]$$\n\n其次，我们推导压力的尾部修正 $\\Delta p$。\n压力 $p$ 由维里定理给出：$p = \\rho k_B T + p_{conf}$，其中 $k_B T$ 是动能贡献，$p_{conf}$ 是分子间力的位形贡献。位形项由 Clausius 维里导出，$W = -\\frac{1}{2} \\sum_{i \\neq j} r_{ij} \\frac{du(r_{ij})}{dr_{ij}}$：\n$$p_{conf} = \\frac{\\langle W \\rangle}{3V} = -\\frac{1}{6V} \\left\\langle \\sum_{i \\neq j} r_{ij} \\frac{du(r_{ij})}{dr_{ij}} \\right\\rangle$$\n在均匀流体的连续介质极限下，这变为：\n$$p_{conf} = -\\frac{\\rho^2}{6} \\int_0^\\infty r \\frac{du(r)}{dr} g(r) 4\\pi r^2 dr = -\\frac{2\\pi\\rho^2}{3} \\int_0^\\infty r^3 \\frac{du(r)}{dr} g(r) dr$$\n尾部修正 $\\Delta p$ 是该积分中来自距离 $r > r_c$ 的贡献。再次使用对于 $r \\ge r_c$，$g(r)=1$ 的假设：\n$$\\Delta p = -\\frac{2\\pi\\rho^2}{3} \\int_{r_c}^\\infty r^3 \\frac{du(r)}{dr} dr$$\n我们必须首先求出 Lennard-Jones 势的导数：\n$$\\frac{du(r)}{dr} = 4\\epsilon \\frac{d}{dr} \\left( \\sigma^{12}r^{-12} - \\sigma^6 r^{-6} \\right) = 4\\epsilon \\left( -12\\sigma^{12}r^{-13} + 6\\sigma^6 r^{-7} \\right)$$\n将此代入 $\\Delta p$ 的积分中：\n$$\\Delta p = -\\frac{2\\pi\\rho^2}{3} \\int_{r_c}^\\infty r^3 \\cdot 4\\epsilon \\left( -12\\sigma^{12}r^{-13} + 6\\sigma^6 r^{-7} \\right) dr$$\n$$\\Delta p = -\\frac{8\\pi\\rho^2\\epsilon}{3} \\int_{r_c}^\\infty \\left( -12\\sigma^{12}r^{-10} + 6\\sigma^6 r^{-4} \\right) dr$$\n我们进行积分：\n$$\\Delta p = -\\frac{8\\pi\\rho^2\\epsilon}{3} \\left[ -12\\sigma^{12}\\frac{r^{-9}}{-9} + 6\\sigma^6 \\frac{r^{-3}}{-3} \\right]_{r_c}^\\infty$$\n$$\\Delta p = -\\frac{8\\pi\\rho^2\\epsilon}{3} \\left[ \\frac{4}{3}\\sigma^{12}r^{-9} - 2\\sigma^6 r^{-3} \\right]_{r_c}^\\infty$$\n$$\\Delta p = -\\frac{8\\pi\\rho^2\\epsilon}{3} \\left[ \\left( \\lim_{r\\to\\infty} \\left( \\frac{4\\sigma^{12}}{3r^9} - \\frac{2\\sigma^6}{r^3} \\right) \\right) - \\left( \\frac{4\\sigma^{12}}{3r_c^9} - \\frac{2\\sigma^6}{r_c^3} \\right) \\right]$$\n$$\\Delta p = -\\frac{8\\pi\\rho^2\\epsilon}{3} \\left[ 0 - \\left( \\frac{4\\sigma^{12}}{3r_c^9} - \\frac{2\\sigma^6}{r_c^3} \\right) \\right]$$\n$$\\Delta p = \\frac{8\\pi\\rho^2\\epsilon}{3} \\left( \\frac{4\\sigma^{12}}{3r_c^9} - \\frac{2\\sigma^6}{r_c^3} \\right)$$\n为清晰起见，对表达式进行因式分解：\n$$\\Delta p = \\frac{16\\pi\\rho^2\\epsilon\\sigma^3}{3} \\left[ \\frac{2}{3}\\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3 \\right]$$\n推导出的 $\\Delta U/N$ 和 $\\Delta p$ 的表达式就是所要求的闭式尾部修正。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{8\\pi\\rho\\epsilon\\sigma^3}{3} \\left[ \\frac{1}{3}\\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3 \\right]  \\frac{16\\pi\\rho^2\\epsilon\\sigma^3}{3} \\left[ \\frac{2}{3}\\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3 \\right]\n\\end{pmatrix}\n}\n$$", "id": "2771807"}, {"introduction": "约束（例如固定键长）在分子动力学中被广泛用于消除高频振动，从而允许使用更大的时间步长。然而，这些约束减少了系统的自由度，直接影响了温度等统计量的计算。本练习 [@problem_id:2771930] 挑战你将能量均分定理正确地应用于一个受约束的系统，这是确保模拟结果热力学一致性的一项关键技能。", "problem": "对限制在具有周期性边界条件的立方模拟单元中的刚性三原子分子流体进行经典的分子动力学（MD）模拟。该系统在牛顿方程下演化，受到使每个分子刚性化的完整约束，这些约束通过拉格朗日乘子强制执行。使用基于动能的瞬时估计器监测动能温度。从动能、完整约束和平衡态能量均分定理的基本定义出发，解释约束如何减少对动能温度有贡献的独立二次速度模式的数量。然后，根据瞬时总动能 $K$、玻尔兹曼常数 $k_{B}$，以及考虑所有约束和任何已移除的运动积分后动态可及的独立速度自由度数，推导瞬时动能温度估计器 $T$ 的通用表达式。\n\n接下来，将您的结果应用于以下与纳米力学以及表面和界面科学相关的物理现实案例：有 $N_{\\mathrm{mol}} = 512$ 个刚性三原子分子（每个分子含 $3$ 个原子），每个分子用三个独立的完整约束建模以强制实现刚性。整个系统的总线性动量被约束为零。在某一特定时刻，由原子速度计算出的总动能为 $K = 3.800 \\times 10^{-18}$ J。使用 $k_{B} = 1.380649 \\times 10^{-23}$ J/K。计算瞬时动能温度 $T$，该温度正确考虑了因分子刚性和总线性动量为零条件而移除的自由度。将您的答案四舍五入到四位有效数字，并以开尔文表示。", "solution": "该问题在科学上是合理的，内容自洽，并且在经典统计力学和分子动力学的框架内定义明确，因此是有效的。我们开始进行求解。\n\n该问题要求解释约束如何影响动能温度的计算，推导通用温度估计器，并将其应用于特定系统。\n\n首先，我们讨论概念基础。一个由 $N$ 个原子组成的系统，每个原子的质量为 $m_i$，速度为 $\\mathbf{v}_i$，其总瞬时动能 $K$ 定义为所有原子动能的总和：\n$$K = \\sum_{i=1}^{N} \\frac{1}{2} m_i |\\mathbf{v}_i|^2 = \\sum_{i=1}^{N} \\sum_{\\alpha \\in \\{x,y,z\\}} \\frac{1}{2} m_i v_{i\\alpha}^2$$\n该表达式是笛卡尔速度分量中 $3N$ 个二次项的总和。在没有约束的情况下，这 $3N$ 个速度分量是独立的。\n\n完整约束是限制粒子空间坐标的方程，形式为 $f_k(\\mathbf{r}_1, \\mathbf{r}_2, \\ldots, \\mathbf{r}_N) = 0$。为了在整个动力学过程中维持这些约束，它们的时间导数必须为零。对于与时间无关的约束，如此处的分子刚性，这意味着：\n$$\\frac{df_k}{dt} = \\sum_{i=1}^{N} \\frac{\\partial f_k}{\\partial \\mathbf{r}_i} \\cdot \\mathbf{v}_i = 0$$\n每个这样的方程都对原子速度施加了线性依赖关系，这意味着它们不再是独立的。每个独立的完整约束有效地从系统中移除了一个自由度。因此，指定系统构型所需的独立坐标数量减少了。\n\n经典统计力学的能量均分定理指出，对于一个处于绝对温度 $T$ 的热平衡系统，与哈密顿量中每个独立的二次项相关的平均能量等于 $\\frac{1}{2} k_B T$，其中 $k_B$ 是玻尔兹曼常数。动能就是由这些项组成的。因为约束减少了独立速度分量的数量，所以它们也减少了对总动能有贡献的独立二次项的数量。这些独立的动能自由度的总数，记为 $N_{dof}$，是所有可能的速度分量的总数减去作用于它们的独立约束的数量。\n\n因此，平均总动能 $\\langle K \\rangle$ 与温度的关系为：\n$$\\langle K \\rangle = \\frac{1}{2} N_{dof} k_B T$$\n在分子动力学模拟中，瞬时动能温度是通过假设该关系对瞬时动能 $K$ 成立来定义的：\n$$K = \\frac{1}{2} N_{dof} k_B T$$\n重新整理该方程，可得到瞬时动能温度估计器 $T$ 的通用表达式，其用总动能 $K$、玻尔兹曼常数 $k_B$ 和动态可及的独立速度自由度数 $N_{dof}$ 表示：\n$$T = \\frac{2K}{N_{dof} k_B}$$\n关键步骤是通过考虑所有约束来正确确定 $N_{dof}$。\n\n现在，我们将此公式应用于指定案例。该系统包含 $N_{\\mathrm{mol}} = 512$ 个刚性三原子分子。\n系统中的原子总数为 $N = N_{\\mathrm{mol}} \\times 3 = 512 \\times 3 = 1536$。\n在没有任何约束的情况下，系统将具有 $3N = 3 \\times 1536 = 4608$ 个总自由度，对应于每个原子的 $3$ 个笛卡尔坐标。\n\n我们必须减去由约束移除的自由度。\n$1$. **分子刚性约束：** 每个三原子分子通过 $3$ 个完整约束变得刚性。单个非线性三原子分子拥有 $3$ 个平动自由度和 $3$ 个转动自由度，总共为 $6$ 个。由 $3$ 个原子组成的无约束系统具有 $3 \\times 3 = 9$ 个自由度。因此，强制刚性会移除每个分子 $9 - 6 = 3$ 个内部分子振动自由度。这与问题陈述相符。这些刚性约束移除的总自由度数为 $N_{c, \\text{rigid}} = N_{\\mathrm{mol}} \\times 3 = 512 \\times 3 = 1536$。\n\n$2$. **总线性动量约束：** 系统的总线性动量被约束为零：$\\mathbf{P} = \\sum_{i=1}^{N} m_i \\mathbf{v}_i = \\mathbf{0}$。这个单一的矢量方程对应于三个独立的标量约束，每个笛卡尔方向一个（$P_x=0$，$P_y=0$，$P_z=0$）。这些约束移除了与整个系统质心平动相关的 $3$ 个自由度。因此，$N_{c, \\text{momentum}} = 3$。\n\n独立速度自由度的总数 $N_{dof}$ 是通过从初始总数中减去所有受约束的自由度来计算的：\n$$N_{dof} = 3N - N_{c, \\text{rigid}} - N_{c, \\text{momentum}} = 4608 - 1536 - 3 = 3069$$\n\n现在，我们可以使用给定的值来计算瞬时温度：\n总动能 $K = 3.800 \\times 10^{-18} \\, \\text{J}$。\n玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23} \\, \\text{J/K}$。\n\n$$T = \\frac{2K}{N_{dof} k_B} = \\frac{2 \\times (3.800 \\times 10^{-18})}{(3069) \\times (1.380649 \\times 10^{-23})}$$\n$$T = \\frac{7.600 \\times 10^{-18}}{4.237303181 \\times 10^{-20}} \\, \\text{K}$$\n$$T \\approx 179.3616 \\, \\text{K}$$\n根据要求将结果四舍五入到四位有效数字，得到 $T = 179.4 \\, \\text{K}$。", "answer": "$$\\boxed{179.4}$$", "id": "2771930"}]}