{"hands_on_practices": [{"introduction": "掌握相场建模的第一步是分析最简单的情形：一个静态的一维平直界面。这个练习将通过变分法，从经典的 Ginzburg-Landau 自由能泛函中推导出界面的平衡轮廓及其最重要的物理性质——界面能。通过这个基础计算，你将深入理解模型参数（如梯度能量系数 $\\kappa$ 和势垒高度 $W$）如何决定界面的物理特性，为后续更复杂的分析奠定坚实的基础 [@problem_id:2782605]。", "problem": "纳米尺度下的二元固溶体由一个标量序参量 $\\,\\phi(x)\\,$ 建模，该参量区分了体平衡值为 $\\,\\phi=0\\,$ 和 $\\,\\phi=1\\,$ 的两个相。考虑一个垂直于 $\\,x\\,$ 轴的平直、静态界面，因此 $\\,\\phi=\\phi(x)\\,$ 仅依赖于 $\\,x\\,$。根据用于弥散界面的 Ginzburg–Landau 范式，单位界面面积的 Helmholtz 自由能被假定为以下泛函\n$$\\mathcal{F}[\\phi] \\;=\\; \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} \\;+\\; W\\,\\phi^{2}\\left(1-\\phi\\right)^{2} \\right] \\, dx,$$\n其中 $\\,\\kappa0\\,$ 是梯度能量系数，$\\,W0\\,$ 设定了对称双阱体自由能密度的能垒高度。假设在边界条件 $\\,\\phi(-\\infty)=0\\,$ 和 $\\,\\phi(+\\infty)=1\\,$ 下处于热力学平衡状态。\n\n仅从变分法和泛函 $\\,\\mathcal{F}[\\phi]\\,$ 极小化子的平衡条件出发，不借助任何快捷公式，推导静态界面剖面 $\\,\\phi(x)\\,$，并用它来确定单位面积的界面自由能（表面能）\n$$\\gamma \\;=\\; \\min_{\\phi}\\,\\mathcal{F}[\\phi],$$\n注意，对于给定的势，在 $\\,\\phi=0\\,$ 和 $\\,\\phi=1\\,$ 处，均匀体自由能密度为零。请以 $\\,\\kappa\\,$ 和 $\\,W\\,$ 的单个闭式解析表达式给出 $\\,\\gamma\\,$。不要代入任何数值，也不要在最终表达式后附加单位。", "solution": "平衡界面剖面 $\\phi(x)$ 是使自由能泛函 $\\mathcal{F}[\\phi]$ 最小化的函数。这样的极小化子必须满足 Euler-Lagrange 方程：\n$$ \\frac{\\partial L}{\\partial \\phi} - \\frac{d}{dx}\\left(\\frac{\\partial L}{\\partial \\phi'}\\right) = 0 $$\n其中 $\\phi' \\equiv \\frac{d\\phi}{dx}$ 且拉格朗日密度为 $L(\\phi, \\phi') = \\frac{\\kappa}{2}(\\phi')^{2} + W\\,\\phi^{2}(1-\\phi)^{2}$。\n\n首先，我们计算 $L$ 所需的偏导数：\n$$ \\frac{\\partial L}{\\partial \\phi'} = \\kappa \\phi' $$\n$$ \\frac{\\partial L}{\\partial \\phi} = W \\frac{d}{d\\phi}\\left[\\phi^2(1-\\phi)^2\\right] = W \\left[ 2\\phi(1-\\phi)^2 + \\phi^2 \\cdot 2(1-\\phi)(-1) \\right] = 2W\\phi(1-\\phi)\\left[ (1-\\phi) - \\phi \\right] = 2W\\phi(1-\\phi)(1-2\\phi) $$\n将这些代入 Euler-Lagrange 方程，得到静态剖面 $\\phi(x)$ 的控制常微分方程：\n$$ 2W\\phi(1-\\phi)(1-2\\phi) - \\frac{d}{dx}(\\kappa \\phi') = 0 $$\n$$ \\kappa \\frac{d^2\\phi}{dx^2} = 2W\\phi(1-\\phi)(1-2\\phi) $$\n这是一个二阶、非线性、自治微分方程。由于拉格朗日量 $L$ 不显式依赖于 $x$，因此存在一个由 Beltrami 恒等式给出的第一运动积分：\n$$ L - \\phi' \\frac{\\partial L}{\\partial \\phi'} = C $$\n其中 $C$ 是一个积分常数。代入 $L$ 和 $\\frac{\\partial L}{\\partial \\phi'}$ 的表达式：\n$$ \\left( \\frac{\\kappa}{2}(\\phi')^2 + W\\phi^2(1-\\phi)^2 \\right) - \\phi' (\\kappa \\phi') = C $$\n$$ -\\frac{\\kappa}{2}(\\phi')^2 + W\\phi^2(1-\\phi)^2 = C $$\n常数 $C$ 由边界条件确定。在 $x \\to \\pm \\infty$ 时，界面剖面必须趋近于剖面平坦的体平衡态。因此，$\\phi' \\to 0$。\n在 $x \\to -\\infty$ 时，$\\phi \\to 0$ 且 $\\phi' \\to 0$。方程变为 $W(0)^2(1-0)^2 = C$，这给出 $C=0$。\n在 $x \\to +\\infty$ 时，$\\phi \\to 1$ 且 $\\phi' \\to 0$。方程变为 $W(1)^2(1-1)^2 = C$，这也给出 $C=0$。\n当 $C=0$ 时，我们得到了一个对平衡剖面有效的关键关系：\n$$ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^2 = W\\phi^2(1-\\phi)^2 $$\n该方程表示平衡时的能量均分：沿着剖面的每一点 $x$，梯度能量密度等于势能密度。\n\n我们现在可以求解 $\\frac{d\\phi}{dx}$：\n$$ \\left(\\frac{d\\phi}{dx}\\right)^2 = \\frac{2W}{\\kappa} \\phi^2(1-\\phi)^2 $$\n$$ \\frac{d\\phi}{dx} = \\pm \\sqrt{\\frac{2W}{\\kappa}} \\phi(1-\\phi) $$\n给定边界条件 $\\phi(-\\infty)=0$ 和 $\\phi(+\\infty)=1$，序参量 $\\phi$ 必须是 $x$ 的单调递增函数。因此，$\\frac{d\\phi}{dx} > 0$。对于 $\\phi \\in (0,1)$，项 $\\phi(1-\\phi)$ 是正的。因此我们选择正根：\n$$ \\frac{d\\phi}{dx} = \\sqrt{\\frac{2W}{\\kappa}} \\phi(1-\\phi) $$\n这是一个一阶可分离微分方程。我们重新整理以分离变量：\n$$ \\frac{d\\phi}{\\phi(1-\\phi)} = \\sqrt{\\frac{2W}{\\kappa}} \\, dx $$\n对两边积分需要对左手边使用部分分式分解：$\\frac{1}{\\phi(1-\\phi)} = \\frac{1}{\\phi} + \\frac{1}{1-\\phi}$。\n$$ \\int \\left(\\frac{1}{\\phi} + \\frac{1}{1-\\phi}\\right) d\\phi = \\int \\sqrt{\\frac{2W}{\\kappa}} \\, dx $$\n$$ \\ln(\\phi) - \\ln(1-\\phi) = x\\sqrt{\\frac{2W}{\\kappa}} + C_1 $$\n其中由于 $\\phi \\in (0,1)$，绝对值被省略。我们通过对称性定义界面中心在 $x=0$ 处，其中 $\\phi(0) = 1/2$。这个条件决定了积分常数 $C_1$：\n$$ \\ln\\left(\\frac{1/2}{1-1/2}\\right) = \\ln(1) = 0 = 0 \\cdot \\sqrt{\\frac{2W}{\\kappa}} + C_1 \\implies C_1 = 0 $$\n所以，我们有：\n$$ \\ln\\left(\\frac{\\phi}{1-\\phi}\\right) = x\\sqrt{\\frac{2W}{\\kappa}} $$\n求解 $\\phi(x)$：\n$$ \\frac{\\phi}{1-\\phi} = \\exp\\left(x\\sqrt{\\frac{2W}{\\kappa}}\\right) \\implies \\phi = (1-\\phi)\\exp\\left(x\\sqrt{\\frac{2W}{\\kappa}}\\right) \\implies \\phi\\left(1 + \\exp\\left(x\\sqrt{\\frac{2W}{\\kappa}}\\right)\\right) = \\exp\\left(x\\sqrt{\\frac{2W}{\\kappa}}\\right) $$\n$$ \\phi(x) = \\frac{\\exp\\left(x\\sqrt{\\frac{2W}{\\kappa}}\\right)}{1 + \\exp\\left(x\\sqrt{\\frac{2W}{\\kappa}}\\right)} = \\frac{1}{1 + \\exp\\left(-x\\sqrt{\\frac{2W}{\\kappa}}\\right)} $$\n这个剖面可以用双曲正切函数表示为：\n$$ \\phi(x) = \\frac{1}{2}\\left[1 + \\tanh\\left(\\frac{x}{2}\\sqrt{\\frac{2W}{\\kappa}}\\right)\\right] = \\frac{1}{2}\\left[1 + \\tanh\\left(x\\sqrt{\\frac{W}{2\\kappa}}\\right)\\right] $$\n这就是静态界面剖面 $\\phi(x)$。\n\n接下来，我们计算界面自由能 $\\gamma$，它是泛函 $\\mathcal{F}[\\phi]$ 在此平衡剖面下的值：\n$$ \\gamma = \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} + W\\,\\phi^{2}(1-\\phi)^{2} \\right] \\, dx $$\n使用我们早先推导的能量均分关系 $\\frac{\\kappa}{2}(\\phi')^2 = W\\phi^2(1-\\phi)^2$，我们可以简化被积函数：\n$$ \\gamma = \\int_{-\\infty}^{\\infty} 2 \\cdot \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^2 \\right] dx = \\int_{-\\infty}^{\\infty} \\kappa \\left(\\frac{d\\phi}{dx}\\right)^2 dx $$\n为了计算这个积分，最有效的方法是将积分变量从 $x$ 更改为 $\\phi$。由于 $\\frac{d\\phi}{dx} dx = d\\phi$，我们可以重写一个因子 $\\frac{d\\phi}{dx}$ 并将积分限从 $x \\in (-\\infty, \\infty)$ 更改为 $\\phi \\in (0, 1)$：\n$$ \\gamma = \\int_{0}^{1} \\kappa \\left(\\frac{d\\phi}{dx}\\right) d\\phi $$\n现在代入 $\\frac{d\\phi}{dx} = \\sqrt{\\frac{2W}{\\kappa}}\\phi(1-\\phi)$ 的表达式：\n$$ \\gamma = \\int_{0}^{1} \\kappa \\left( \\sqrt{\\frac{2W}{\\kappa}}\\phi(1-\\phi) \\right) d\\phi = \\kappa \\sqrt{\\frac{2W}{\\kappa}} \\int_{0}^{1} (\\phi-\\phi^2) d\\phi $$\n$$ \\gamma = \\sqrt{\\kappa^2 \\frac{2W}{\\kappa}} \\int_{0}^{1} (\\phi-\\phi^2) d\\phi = \\sqrt{2\\kappa W} \\int_{0}^{1} (\\phi-\\phi^2) d\\phi $$\n这个定积分是初等的：\n$$ \\int_{0}^{1} (\\phi-\\phi^2) d\\phi = \\left[\\frac{\\phi^2}{2} - \\frac{\\phi^3}{3}\\right]_{0}^{1} = \\left(\\frac{1}{2} - \\frac{1}{3}\\right) - (0) = \\frac{1}{6} $$\n最后，代入这个结果，我们得到界面自由能：\n$$ \\gamma = \\sqrt{2\\kappa W} \\cdot \\frac{1}{6} = \\frac{\\sqrt{2\\kappa W}}{6} $$\n这就是用给定参数 $\\kappa$ 和 $W$ 表示的表面能的最终闭式表达式。", "answer": "$$\\boxed{\\frac{\\sqrt{2\\kappa W}}{6}}$$", "id": "2782605"}, {"introduction": "在理解了平直界面的性质之后，一个自然的延伸是探究界面能如何影响曲面界面。这个实践练习将演示如何将从相场模型中导出的表面张力概念，直接应用于推导球形液滴内外的拉普拉斯压力差。这是一个有力的例子，说明了抽象的相场泛函如何能够预测如毛细现象这类可测量的物理效应，展示了模型在连接微观理论与宏观现象方面的强大能力 [@problem_id:2782607]。", "problem": "考虑一个等温二元混合物，由一个标量相场序参量 $\\phi(\\mathbf{x})$ 描述，其在两相中的平衡体相值为 $\\pm \\phi_{0}$。在域 $\\Omega \\subset \\mathbb{R}^{3}$ 中的亥姆霍兹自由能泛函为\n$$\n\\mathcal{F}[\\phi] \\;=\\; \\int_{\\Omega} \\left[ \\frac{\\kappa}{2}\\,|\\nabla \\phi|^{2} \\;+\\; f(\\phi) \\right] \\,\\mathrm{d}V,\n$$\n其中 $\\kappa0$ 是梯度能量系数，均匀自由能密度为对称双势阱\n$$\nf(\\phi) \\;=\\; \\frac{A}{4}\\,\\left(\\phi^{2}-\\phi_{0}^{2}\\right)^{2},\n$$\n其中 $A0$。假设一个半径为 $R$ 的 $+\\phi_{0}$ 相的单个球形液滴嵌入到 $-\\phi_{0}$ 相中，界面处于力学和化学平衡状态，并且液滴半径满足 $R \\gg \\ell$，其中 $\\ell$ 是由 $(\\kappa,A,\\phi_{0})$ 决定的内禀弥散界面厚度。\n\n从自由能泛函 $\\mathcal{F}$ 和界面自由能（表面张力）的定义（即与静态一维界面轮廓相关的单位面积过剩自由能）出发，执行以下基于变分力学的步骤：\n\n1. 对于一个序参量仅在法向坐标 $z$ 上变化的平直界面，利用 $\\mathcal{F}$ 的平稳性将欧拉-拉格朗日方程简化为一个将 $\\partial_{z}\\phi$ 与 $f(\\phi)$ 联系起来的首次积分。然后，将表面张力 $\\gamma$ 表示为关于 $\\phi$ 的一维积分，并用 $\\kappa$、$A$ 和 $\\phi_{0}$ 以闭合形式计算出其值。\n\n2. 在 $\\ell/R$ 的主导阶上，将近球形液滴的弯曲界面模型化为局部平直，从而界面自由能为 $F_{\\text{int}} \\approx \\gamma A$，其中 $A=4\\pi R^{2}$ 是液滴的表面积。利用固定组分下的虚拟等温形状变化，以及界面两侧压差 $\\Delta p$ 所做的可逆功等于体积微小变化下界面自由能的变化这一原理，推导跨球形界面的拉普拉斯压力跃变 $\\Delta p$ 的主导阶表达式。\n\n请以 $\\kappa$、$A$、$\\phi_{0}$ 和 $R$ 表示的单个闭合形式解析表达式给出 $\\Delta p$ 的最终结果。压力以帕斯卡（国际单位制）表示。不要引入任何额外参数。不需要进行数值计算，也不需要四舍五入。您的最终答案必须是单个表达式，而不是方程或不等式。", "solution": "总体目标是推导跨球形界面的拉普拉斯压力 $\\Delta p$。如题所求，这将分两步完成。\n\n**第1步：表面张力 $\\gamma$ 的推导**\n\n我们考虑一个平面界面，其中序参量 $\\phi$ 仅沿界面的法向坐标 $z$ 变化。单位界面面积的自由能泛函为\n$$\n\\frac{\\mathcal{F}}{A_{xy}} = \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\kappa}{2} \\left( \\frac{d\\phi}{dz} \\right)^2 + f(\\phi) \\right] dz\n$$\n被积函数 $\\mathcal{L}(\\phi, \\phi') = \\frac{\\kappa}{2}(\\phi')^2 + f(\\phi)$ 是拉格朗日密度，其中 $\\phi' = d\\phi/dz$。平衡轮廓 $\\phi(z)$ 必须满足欧拉-拉格朗日方程：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\phi} - \\frac{d}{dz}\\left( \\frac{\\partial \\mathcal{L}}{\\partial \\phi'} \\right) = 0\n$$\n这得到 $f'(\\phi) - \\frac{d}{dz}(\\kappa \\phi') = 0$，即 $\\kappa \\phi'' = f'(\\phi)$。\n\n由于拉格朗日量 $\\mathcal{L}$ 不显式依赖于自变量 $z$，我们可以使用贝尔特拉米恒等式来找到一个运动的首次积分：\n$$\n\\mathcal{L} - \\phi' \\frac{\\partial \\mathcal{L}}{\\partial \\phi'} = \\text{常数}\n$$\n$$\n\\left( \\frac{\\kappa}{2}(\\phi')^2 + f(\\phi) \\right) - \\phi'(\\kappa \\phi') = -\\frac{\\kappa}{2}(\\phi')^2 + f(\\phi) = C\n$$\n为了确定常数 $C$，我们应用远离界面的边界条件，此时系统处于均匀的体相中。当 $z \\to \\pm \\infty$ 时，$\\phi \\to \\pm \\phi_0$ 且轮廓变得平坦，因此 $\\phi' \\to 0$。在体相中，自由能密度处于其最小值，$f(\\pm\\phi_0) = \\frac{A}{4}(\\phi_0^2-\\phi_0^2)^2 = 0$。将这些条件代入首次积分，得到 $C = 0$。\n因此，我们得到联系 $\\phi'$ 与 $f(\\phi)$ 的首次积分：\n$$\n\\frac{\\kappa}{2} \\left( \\frac{d\\phi}{dz} \\right)^2 = f(\\phi)\n$$\n这就是任务第一部分所要求的关系。\n\n表面张力 $\\gamma$ 定义为单位界面面积的过剩自由能。由于体相的自由能密度为 $f(\\pm\\phi_0) = 0$，这简化为拉格朗日密度的积分：\n$$\n\\gamma = \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\kappa}{2}(\\phi')^2 + f(\\phi) \\right] dz\n$$\n使用首次积分，我们可以将其写为 $\\gamma = \\int_{-\\infty}^{\\infty} 2f(\\phi) dz$，或者为了计算方便，写为 $\\gamma = \\int_{-\\infty}^{\\infty} \\kappa(\\phi')^2 dz$。我们将通过将积分变量从 $z$ 更改为 $\\phi$ 来继续。根据首次积分，我们有 $\\phi' = \\frac{d\\phi}{dz} = \\sqrt{\\frac{2f(\\phi)}{\\kappa}}$。积分范围是跨越界面从 $\\phi = -\\phi_0$ 到 $\\phi = +\\phi_0$。\n$$\n\\gamma = \\int_{-\\infty}^{\\infty} \\sqrt{2\\kappa f(\\phi)} \\frac{d\\phi}{dz} dz = \\int_{-\\phi_0}^{\\phi_0} \\sqrt{2\\kappa f(\\phi)} d\\phi\n$$\n现在，我们代入给定的 $f(\\phi) = \\frac{A}{4}(\\phi^2-\\phi_0^2)^2$ 形式：\n$$\n\\gamma = \\int_{-\\phi_0}^{\\phi_0} \\sqrt{2\\kappa \\frac{A}{4} (\\phi^2 - \\phi_0^2)^2} d\\phi = \\sqrt{\\frac{\\kappa A}{2}} \\int_{-\\phi_0}^{\\phi_0} |\\phi^2 - \\phi_0^2| d\\phi\n$$\n在积分范围 $(-\\phi_0, \\phi_0)$ 内，项 $\\phi^2 - \\phi_0^2$ 是非正的，所以 $|\\phi^2 - \\phi_0^2| = \\phi_0^2 - \\phi^2$。\n$$\n\\gamma = \\sqrt{\\frac{\\kappa A}{2}} \\int_{-\\phi_0}^{\\phi_0} (\\phi_0^2 - \\phi^2) d\\phi\n$$\n直接计算该积分：\n$$\n\\int_{-\\phi_0}^{\\phi_0} (\\phi_0^2 - \\phi^2) d\\phi = \\left[ \\phi_0^2 \\phi - \\frac{\\phi^3}{3} \\right]_{-\\phi_0}^{\\phi_0} = \\left(\\phi_0^3 - \\frac{\\phi_0^3}{3}\\right) - \\left(-\\phi_0^3 + \\frac{\\phi_0^3}{3}\\right) = \\frac{2}{3}\\phi_0^3 - \\left(-\\frac{2}{3}\\phi_0^3\\right) = \\frac{4}{3}\\phi_0^3\n$$\n将此结果代回 $\\gamma$ 的表达式中：\n$$\n\\gamma = \\sqrt{\\frac{\\kappa A}{2}} \\left( \\frac{4}{3}\\phi_0^3 \\right) = \\frac{4\\phi_0^3}{3\\sqrt{2}} \\sqrt{\\kappa A} = \\frac{2\\sqrt{2}}{3} \\phi_0^3 \\sqrt{\\kappa A}\n$$\n\n**第2步：拉普拉斯压力 $\\Delta p$ 的推导**\n\n对于半径为 $R$ 的球形液滴，当 $R$ 远大于界面厚度 $\\ell$ 时，我们可以将界面自由能近似为平直界面表面张力 $\\gamma$ 与液滴表面积 $A_{surf} = 4\\pi R^2$ 的乘积。\n$$\nF_{\\text{int}} \\approx \\gamma A_{surf} = \\gamma (4\\pi R^2)\n$$\n虚功原理指出，在力学平衡状态下，压差 $\\Delta p$ 在无穷小体积变化 $dV$ 期间所做的功 $dW$ 等于界面自由能的相应变化 $dF_{\\text{int}}$。我们考虑一个总组分固定的等温过程。\n$$\ndW = dF_{\\text{int}}\n$$\n压差所做的功为 $dW = \\Delta p \\, dV$。自由能的变化为 $dF_{\\text{int}} = d(\\gamma A_{surf})$。由于 $\\gamma$ 是一个不依赖于 $R$ 的材料属性，我们有 $dF_{\\text{int}} = \\gamma \\, dA_{surf}$。\n令两者相等可得：\n$$\n\\Delta p \\, dV = \\gamma \\, dA_{surf} \\implies \\Delta p = \\gamma \\frac{dA_{surf}}{dV}\n$$\n对于球体，体积为 $V = \\frac{4}{3}\\pi R^3$，表面积为 $A_{surf} = 4\\pi R^2$。我们使用链式法则对半径 $R$ 求导：\n$$\n\\frac{dA_{surf}}{dV} = \\frac{dA_{surf}/dR}{dV/dR} = \\frac{\\frac{d}{dR}(4\\pi R^2)}{\\frac{d}{dR}(\\frac{4}{3}\\pi R^3)} = \\frac{8\\pi R}{4\\pi R^2} = \\frac{2}{R}\n$$\n这就导出了著名的球形界面杨-拉普拉斯方程：\n$$\n\\Delta p = \\frac{2\\gamma}{R}\n$$\n最后，我们将第1步中推导出的 $\\gamma$ 表达式代入，以获得用基本模型参数表示的 $\\Delta p$ 的最终结果。\n$$\n\\Delta p = \\frac{2}{R} \\left( \\frac{2\\sqrt{2}}{3} \\phi_0^3 \\sqrt{\\kappa A} \\right) = \\frac{4\\sqrt{2}}{3R} \\phi_0^3 \\sqrt{\\kappa A}\n$$\n可以验证该结果的量纲一致性。如果 $\\phi$ 是无量纲的，那么 $[\\kappa] = \\text{能量}/\\text{长度}$ 且 $[A] = \\text{能量}/\\text{体积}$。乘积 $\\kappa A$ 的单位是 $(\\text{能量})^2/(\\text{长度})^4$，而 $\\sqrt{\\kappa A}$ 的单位是 $\\text{能量}/(\\text{长度})^2$，这正是表面张力的单位。再除以长度 $R$ 得到单位 $\\text{能量}/(\\text{长度})^3$，即压力（$\\text{力}/\\text{面积}$）。要求用帕斯卡表示结果与国际单位制下的这种量纲分析是一致的。", "answer": "$$\n\\boxed{\\frac{4\\sqrt{2}}{3R}\\phi_{0}^{3}\\sqrt{\\kappa A}}\n$$", "id": "2782607"}, {"introduction": "解析解往往局限于理想化的简单情况，而相场模型的实际应用则离不开数值模拟。在模拟中，正确地施加物理上有意义的边界条件是成功的关键。本练习将理论与实践相结合，指导你处理一个在润湿和材料科学中常见的场景：在固体壁面上的接触角边界条件。你将学习如何将连续的非线性边界条件离散化，并编写代码求解，从而获得连接变分原理与计算实践的宝贵经验 [@problem_id:2782614]。", "problem": "考虑一个用于描述固壁上扩散界面的二元相场模型。令序参数表示为 $\\,\\phi\\,\\in[-1,1]\\,$，两个体相分别对应 $\\,\\phi=\\pm 1\\,$。在具有边界 $\\,\\partial\\Omega\\,$ 的域 $\\,\\Omega\\,$ 中，总自由能泛函由下式给出\n$$\n\\mathcal{F}[\\phi] \\;=\\; \\int_{\\Omega} \\left( \\lambda\\, W(\\phi) \\;+\\; \\frac{\\kappa}{2}\\,|\\nabla \\phi|^2 \\right)\\, \\mathrm{d}V \\;+\\; \\int_{\\partial\\Omega} g_s(\\phi)\\, \\mathrm{d}S,\n$$\n其中 $\\,W(\\phi)\\,$ 是一个对称双阱势，$\\,\\kappa0\\,$ 是梯度能量系数，$\\,\\lambda0\\,$ 设定了体能量尺度，而 $\\,g_s(\\phi)\\,$ 是壁自由能密度。在本问题中，假设采用标准的双阱势\n$$\nW(\\phi) \\;=\\; \\frac{(\\phi^2 - 1)^2}{4},\n$$\n并采纳通常的选择 $\\,\\lambda=1\\,$ 和 $\\,\\kappa=\\varepsilon^2\\,$，其中 $\\,\\varepsilon0\\,$ 设定了扩散界面厚度。\n\n在平衡状态下，在体相中，欧拉-拉格朗日方程成立：\n$$\n-\\,\\kappa\\, \\nabla^2 \\phi \\;+\\; \\lambda\\, W'(\\phi) \\;=\\; \\mu,\n$$\n其中 $\\,\\mu\\,$ 是一个常数化学势。对于 $\\,\\mu=0\\,$ 的静态平面界面，沿着垂直于界面的坐标 $\\,s\\,$，体能量和梯度能量之间存在一个均分关系：\n$$\n\\frac{\\kappa}{2}\\,\\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}s}\\right)^2 \\;=\\; \\lambda\\, W(\\phi).\n$$\n假设在光滑固壁上的接触角条件由壁法向导数与平衡梯度大小之间的几何平衡来强制施加，即\n$$\n\\mathbf{n}_w \\cdot \\nabla \\phi \\;=\\; -\\,\\cos(\\theta)\\,\\frac{\\sqrt{2\\,\\lambda\\, W(\\phi)}}{\\sqrt{\\kappa}},\n$$\n其中 $\\,\\mathbf{n}_w\\,$ 是从壁指向流体的单位法向量，$\\,\\theta\\,$ 是界面与壁之间的杨氏接触角。当 $\\,\\lambda=1\\,$ 和 $\\,\\kappa=\\varepsilon^2\\,$ 时，此式简化为\n$$\n\\mathbf{n}_w \\cdot \\nabla \\phi \\;=\\; -\\,\\cos(\\theta)\\,\\frac{\\sqrt{2\\, W(\\phi)}}{\\varepsilon}.\n$$\n\n你需要沿着壁法向坐标 $\\,x\\ge 0\\,$（壁位于 $\\,x=0\\,$ 且 $\\,\\mathbf{n}_w = \\mathbf{e}_x\\,$），为这个壁条件实现一个二阶精确的边界离散化。设 $\\,\\Delta x0\\,$ 为均匀网格间距，并用 $\\,\\phi_1\\,$ 表示位于第一个内部节点 $\\,x=\\Delta x\\,$ 处的已知 $\\,\\phi\\,$ 值。引入一个位于 $\\,x=-\\Delta x\\,$ 的几何虚拟未知数 $\\,\\phi_{-1}\\,$ 以进行二阶近似：\n- 用中心差分近似壁法向导数\n$$\n\\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{x=0} \\;\\approx\\; \\frac{\\phi_1 - \\phi_{-1}}{2\\,\\Delta x}.\n$$\n- 用中心平均近似壁面值\n$$\n\\phi_w \\;\\approx\\; \\frac{\\phi_1 + \\phi_{-1}}{2}.\n$$\n\n利用以上近似，强制施加几何接触角条件，以根据 $\\,\\phi_1\\,$, $\\,\\varepsilon\\,$, $\\,\\Delta x\\,$ 和 $\\,\\theta\\,$ 确定 $\\,\\phi_{-1}\\,$。为了稳健地求解得到的非线性方程，有利的做法是通过平均值 $\\,\\phi_{\\text{avg}} := \\phi_w = (\\phi_1+\\phi_{-1})/2\\,$ 进行重新参数化，并通过 $\\,\\phi_{-1} = 2\\,\\phi_{\\text{avg}} - \\phi_1\\,$ 消去 $\\,\\phi_{-1}\\,$，得到标量方程\n$$\n\\frac{\\phi_1 - \\phi_{\\text{avg}}}{\\Delta x} \\;+\\; \\cos(\\theta)\\,\\frac{\\sqrt{2\\,W(\\phi_{\\text{avg}})}}{\\varepsilon} \\;=\\; 0,\n$$\n需求解 $\\,\\phi_{\\text{avg}} \\in [-1,1]\\,$。物理相关的分支满足 $\\,\\phi_{\\text{avg}} \\in [-1,1]\\,$，因此 $\\,\\sqrt{2\\,W(\\phi_{\\text{avg}})} = \\frac{|1-\\phi_{\\text{avg}}^2|}{\\sqrt{2}} = \\frac{1-\\phi_{\\text{avg}}^2}{\\sqrt{2}}\\,$。\n\n你的任务：\n1. 从基本定义和均分关系出发，推导上述几何边界条件及其所述的二阶离散形式。\n2. 实现一个程序，对于给定的 $\\,(\\varepsilon,\\Delta x,\\phi_1,\\theta)\\,$，通过求解区间 $\\,[-1,1]\\,$ 中的 $\\,\\phi_{\\text{avg}}\\,$ 来计算 $\\,\\phi_{-1}\\,$，然后通过 $\\,\\phi_{-1} = 2\\,\\phi_{\\text{avg}} - \\phi_1\\,$ 映射回去。\n3. 角度必须以弧度为单位进行解释。所有量都是无量纲的。为了数值稳健性，当 $\\,\\phi_1 \\in [-1,1]\\,$ 时，使用保证能在闭区间 $\\,[-1,1]\\,$ 中找到根的求根方法来求解该标量方程。\n\n测试用例：\n为以下四个测试用例提供输出，每个用例指定为一个元组 $\\,(\\varepsilon,\\Delta x,\\phi_1,\\theta)\\,$：\n- 用例 A (正常路径): $\\,(\\varepsilon,\\Delta x,\\phi_1,\\theta) = (\\,0.02,\\,0.01,\\,0.0,\\,\\pi/3\\,)\\,$。\n- 用例 B (直角): $\\,(\\varepsilon,\\Delta x,\\phi_1,\\theta) = (\\,0.02,\\,0.01,\\,-0.8,\\,\\pi/2\\,)\\,$。\n- 用例 C (完全润湿): $\\,(\\varepsilon,\\Delta x,\\phi_1,\\theta) = (\\,0.02,\\,0.01,\\,0.5,\\,0\\,)\\,$。\n- 用例 D (不润湿): $\\,(\\varepsilon,\\Delta x,\\phi_1,\\theta) = (\\,0.05,\\,0.02,\\,-0.3,\\,\\pi\\,)\\,$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含按用例 A-D 顺序计算出的四个虚拟点值 $\\,\\phi_{-1}\\,$，格式为用方括号括起来的逗号分隔列表，例如 $\\,\\left[\\phi_{-1}^{(A)},\\phi_{-1}^{(B)},\\phi_{-1}^{(C)},\\phi_{-1}^{(D)}\\right]\\,$。条目必须是纯十进制数。角度以弧度为单位；不涉及物理单位。", "solution": "任务分为两部分：首先，推导指定的边界条件及其离散形式；其次，实现一个求解所得方程的数值求解器。\n\n**第1部分：边界条件及其离散化的推导**\n\n系统的总自由能由泛函给出\n$$\n\\mathcal{F}[\\phi] = \\int_{\\Omega} f_{bulk}(\\phi, \\nabla\\phi) \\, \\mathrm{d}V + \\int_{\\partial\\Omega} g_s(\\phi) \\, \\mathrm{d}S,\n$$\n其中体自由能密度为 $f_{bulk} = \\lambda W(\\phi) + \\frac{\\kappa}{2} |\\nabla \\phi|^2$。在平衡状态下，系统的状态局部地最小化此能量泛函。$\\mathcal{F}$ 的一阶变分必须为零，即 $\\delta \\mathcal{F} = 0$。\n\n变分计算如下：\n$$\n\\delta \\mathcal{F} = \\int_{\\Omega} \\left( \\frac{\\partial f_{bulk}}{\\partial \\phi} \\delta\\phi + \\frac{\\partial f_{bulk}}{\\partial \\nabla\\phi} \\cdot \\delta(\\nabla\\phi) \\right) \\mathrm{d}V + \\int_{\\partial\\Omega} g_s'(\\phi) \\delta\\phi \\, \\mathrm{d}S.\n$$\n根据 $f_{bulk}$ 的定义，这给出：\n$$\n\\delta \\mathcal{F} = \\int_{\\Omega} \\left( \\lambda W'(\\phi) \\delta\\phi + \\kappa \\nabla\\phi \\cdot \\nabla(\\delta\\phi) \\right) \\mathrm{d}V + \\int_{\\partial\\Omega} g_s'(\\phi) \\delta\\phi \\, \\mathrm{d}S.\n$$\n对梯度项应用散度定理 $\\int_{\\Omega} \\mathbf{A} \\cdot \\nabla u \\, \\mathrm{d}V = \\int_{\\partial\\Omega} u (\\mathbf{A} \\cdot \\mathbf{n}) \\, \\mathrm{d}S - \\int_{\\Omega} u (\\nabla \\cdot \\mathbf{A}) \\, \\mathrm{d}V$，其中 $u = \\delta\\phi$ 且 $\\mathbf{A} = \\kappa \\nabla\\phi$，我们得到：\n$$\n\\int_{\\Omega} \\kappa \\nabla\\phi \\cdot \\nabla(\\delta\\phi) \\, \\mathrm{d}V = \\int_{\\partial\\Omega} \\kappa \\delta\\phi (\\nabla\\phi \\cdot \\mathbf{n}) \\, \\mathrm{d}S - \\int_{\\Omega} \\kappa \\delta\\phi (\\nabla^2\\phi) \\, \\mathrm{d}V.\n$$\n这里，$\\mathbf{n}$ 是域 $\\Omega$ 的向外单位法向量。将其代回变分 $\\delta \\mathcal{F}$ 中，得到：\n$$\n\\delta \\mathcal{F} = \\int_{\\Omega} \\left( \\lambda W'(\\phi) - \\kappa \\nabla^2\\phi \\right) \\delta\\phi \\, \\mathrm{d}V + \\int_{\\partial\\Omega} \\left( g_s'(\\phi) + \\kappa (\\nabla\\phi \\cdot \\mathbf{n}) \\right) \\delta\\phi \\, \\mathrm{d}S.\n$$\n由于 $\\delta\\phi$ 在体 $\\Omega$ 和边界 $\\partial\\Omega$ 上是任意的，为了使 $\\delta \\mathcal{F}=0$，两个被积函数都必须为零。这得出了体相的欧拉-拉格朗日方程（化学势 $\\mu=0$），\n$$\n-\\kappa \\nabla^2\\phi + \\lambda W'(\\phi) = 0,\n$$\n以及在 $\\partial\\Omega$ 上的自然边界条件，\n$$\n\\kappa (\\mathbf{n} \\cdot \\nabla\\phi) + g_s'(\\phi) = 0.\n$$\n问题将 $\\mathbf{n}_w$ 定义为从壁*指向*流体域的单位法向量，因此 $\\mathbf{n} = -\\mathbf{n}_w$。边界条件变为：\n$$\n\\kappa (\\mathbf{n}_w \\cdot \\nabla\\phi) = g_s'(\\phi).\n$$\n这是从变分原理推导出的广义边界条件。问题指定了此条件的一个特定“几何”形式：\n$$\n\\mathbf{n}_w \\cdot \\nabla \\phi = -\\cos(\\theta)\\,\\frac{\\sqrt{2\\,\\lambda\\, W(\\phi)}}{\\sqrt{\\kappa}}.\n$$\n这种形式是一种建模选择，直接强制施加杨氏接触角 $\\theta$。它是通过假设表面能密度的导数 $g_s'(\\phi)$ 与一维平衡界面剖面的梯度大小成比例而得到的。对于静态平面界面，均分关系 $\\frac{\\kappa}{2} \\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}s}\\right)^2 = \\lambda W(\\phi)$ 给出了此平衡梯度的大小为 $|\\nabla \\phi|_{eq} = \\frac{\\mathrm{d}\\phi}{\\mathrm{d}s} = \\sqrt{\\frac{2\\lambda W(\\phi)}{\\kappa}}$。\n通过将其代入几何条件，我们看到它可以写成 $\\mathbf{n}_w \\cdot \\nabla \\phi = -\\cos(\\theta) |\\nabla \\phi|_{eq}$。将其与变分条件进行比较，得到了该模型所隐含的壁能量导数的具体函数形式：\n$$\ng_s'(\\phi) = \\kappa \\left( -\\cos(\\theta)\\,\\frac{\\sqrt{2\\,\\lambda\\, W(\\phi)}}{\\sqrt{\\kappa}} \\right) = -\\cos(\\theta) \\sqrt{2\\lambda\\kappa W(\\phi)}.\n$$\n这样就完成了连续边界条件的推导和论证。\n\n接下来，我们推导二阶精确离散形式。设置为一维，坐标为 $x \\ge 0$，壁位于 $x=0$，且 $\\mathbf{n}_w = \\mathbf{e}_x$。条件变为：\n$$\n\\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{x=0} = -\\cos(\\theta)\\,\\frac{\\sqrt{2\\,\\lambda\\, W(\\phi(0))}}{\\sqrt{\\kappa}}.\n$$\n我们使用给定的二阶中心近似来表示导数和壁面值 $\\phi_w = \\phi(0)$：\n$$\n\\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{x=0} \\approx \\frac{\\phi_1 - \\phi_{-1}}{2\\,\\Delta x} \\quad \\text{和} \\quad \\phi_w \\approx \\frac{\\phi_1 + \\phi_{-1}}{2}.\n$$\n将这些近似代入连续条件，并设 $\\lambda=1$ 和 $\\kappa=\\varepsilon^2$，我们得到离散方程：\n$$\n\\frac{\\phi_1 - \\phi_{-1}}{2\\,\\Delta x} = -\\cos(\\theta)\\,\\frac{\\sqrt{2\\,W(\\phi_w)}}{\\varepsilon}.\n$$\n为了得到待求解的标量方程，我们使用 $\\phi_{\\text{avg}} = \\phi_w = (\\phi_1 + \\phi_{-1})/2$ 进行重新参数化。这意味着 $\\phi_{-1} = 2\\,\\phi_{\\text{avg}} - \\phi_1$。将这个 $\\phi_{-1}$ 的表达式代入离散方程的左侧，得到：\n$$\n\\frac{\\phi_1 - (2\\,\\phi_{\\text{avg}} - \\phi_1)}{2\\,\\Delta x} = \\frac{2\\phi_1 - 2\\phi_{\\text{avg}}}{2\\,\\Delta x} = \\frac{\\phi_1 - \\phi_{\\text{avg}}}{\\Delta x}.\n$$\n将其与右侧相等，得到：\n$$\n\\frac{\\phi_1 - \\phi_{\\text{avg}}}{\\Delta x} = -\\cos(\\theta)\\,\\frac{\\sqrt{2\\,W(\\phi_{\\text{avg}})}}{\\varepsilon}.\n$$\n整理各项，得到最终需求解 $\\phi_{\\text{avg}}$ 的标量方程：\n$$\n\\frac{\\phi_1 - \\phi_{\\text{avg}}}{\\Delta x} + \\cos(\\theta)\\,\\frac{\\sqrt{2\\,W(\\phi_{\\text{avg}})}}{\\varepsilon} = 0.\n$$\n这样就完成了所需离散形式的推导。\n\n**第2部分：数值解**\n\n任务是求解推导出的标量方程，以得到 $\\phi_{\\text{avg}} \\in [-1, 1]$。在此区间内，双阱势 $W(\\phi) = (\\phi^2-1)^2/4$ 简化了 $\\sqrt{2W(\\phi)}$ 项：\n$$\n\\sqrt{2W(\\phi_{\\text{avg}})} = \\sqrt{2 \\frac{(\\phi_{\\text{avg}}^2-1)^2}{4}} = \\frac{|\\phi_{\\text{avg}}^2 - 1|}{\\sqrt{2}} = \\frac{1-\\phi_{\\text{avg}}^2}{\\sqrt{2}},\n$$\n因为 $\\phi_{\\text{avg}}^2 \\le 1$。因此，待求解的方程为：\n$$\nf(\\phi_{\\text{avg}}) = \\frac{\\phi_1 - \\phi_{\\text{avg}}}{\\Delta x} + \\cos(\\theta)\\frac{1-\\phi_{\\text{avg}}^2}{\\sqrt{2}\\varepsilon} = 0.\n$$\n这是一个关于 $\\phi_{\\text{avg}}$ 的二次方程。一种找到物理相关根的稳健方法是使用区间求根算法，如 Brent's method。我们需要找到一个区间 $[a, b]$，使得 $f(a)$ 和 $f(b)$ 符号相反。问题建议解在 $[-1, 1]$ 内。让我们检查这个区间端点的函数值，对于给定的 $\\phi_1 \\in [-1, 1]$：\n$$\nf(-1) = \\frac{\\phi_1 - (-1)}{\\Delta x} + \\cos(\\theta)\\frac{1-(-1)^2}{\\sqrt{2}\\varepsilon} = \\frac{\\phi_1+1}{\\Delta x}.\n$$\n$$\nf(1) = \\frac{\\phi_1 - 1}{\\Delta x} + \\cos(\\theta)\\frac{1-1^2}{\\sqrt{2}\\varepsilon} = \\frac{\\phi_1-1}{\\Delta x}.\n$$\n给定 $\\Delta x  0$，且测试用例使用 $\\phi_1 \\in [-1, 1]$，我们有 $\\phi_1+1 \\ge 0$ 和 $\\phi_1-1 \\le 0$。因此，$f(-1) \\ge 0$ 且 $f(1) \\le 0$。这保证了 $f(-1) \\cdot f(1) \\le 0$，所以区间 $[-1, 1]$ 内总是至少存在一个根。因此，我们可以安全地在区间 $[-1, 1]$ 上使用像 `scipy.optimize.brentq` 这样的区间求解器。\n\n一旦找到 $\\phi_{\\text{avg}}$，就可以通过关系式 $\\phi_{-1} = 2\\,\\phi_{\\text{avg}} - \\phi_1$ 计算虚拟点的值 $\\phi_{-1}$。以下程序为给定的测试用例实现了这个过程。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the ghost point value phi_{-1} for four test cases\n    of a phase-field contact angle boundary condition.\n    \"\"\"\n    \n    # Test suite: (epsilon, delta_x, phi_1, theta in radians)\n    test_cases = [\n        (0.02, 0.01, 0.0, np.pi / 3),  # Case A\n        (0.02, 0.01, -0.8, np.pi / 2), # Case B\n        (0.02, 0.01, 0.5, 0.0),       # Case C\n        (0.05, 0.02, -0.3, np.pi),     # Case D\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        eps, dx, phi1, theta = case\n\n        # Define the scalar function f(phi_avg) = 0 to be solved.\n        # The equation is:\n        # (phi1 - phi_avg)/dx + cos(theta) * (1 - phi_avg^2) / (sqrt(2)*eps) = 0\n        def f(phi_avg):\n            term1 = (phi1 - phi_avg) / dx\n            term2 = np.cos(theta) * (1 - phi_avg**2) / (np.sqrt(2) * eps)\n            return term1 + term2\n\n        # As derived in the solution, for phi1 in [-1, 1], a root is guaranteed\n        # to exist in the interval [-1, 1]. We use Brent's method for robust\n        # root-finding in this bracket.\n        try:\n            phi_avg = brentq(f, -1.0, 1.0)\n        except ValueError:\n            # This case can happen if f(-1) and f(1) have the same sign, which\n            # occurs if phi1 is exactly -1 or 1, making one boundary value zero.\n            # brentq handles a zero at a boundary, so this is mainly for robustness.\n            # If f(-1) is zero, phi1=-1, so phi_avg=-1 is a root.\n            # If f(1) is zero, phi1=1, so phi_avg=1 is a root.\n            if np.isclose(f(-1.0), 0):\n                phi_avg = -1.0\n            elif np.isclose(f(1.0), 0):\n                phi_avg = 1.0\n            else:\n                # Should not be reached given the analysis.\n                raise\n    \n        # Calculate the ghost point value phi_{-1}\n        phi_m1 = 2 * phi_avg - phi1\n        \n        results.append(phi_m1)\n\n    # Format the results as specified.\n    print(f\"[{','.join(f'{r:.16f}'.rstrip('0').rstrip('.') for r in results)}]\")\n\nsolve()\n```", "id": "2782614"}]}