{"hands_on_practices": [{"introduction": "扫描隧道显微镜（STM）惊人的灵敏度源于量子力学隧穿效应。本练习将引导你从第一性原理（WKB近似）出发，推导隧穿电流与针尖-样品间距之间的指数关系。通过这个实践，你将定量地理解为何埃米级的距离变化会导致电流发生数量级的改变，从而深入体会STM高垂直分辨率的物理基础。[@problem_id:2783101]", "problem": "一个扫描隧道显微镜（STM）结在超高真空、低温条件下运行，其金属针尖和金属样品的功函数均为 $\\Phi = 4.5\\,\\mathrm{eV}$。假设偏压很小，因此隧穿由费米能级控制，电子隧穿通过一个相对于费米能级高度恒定且等于功函数的真空势垒。忽略镜像势修正和任何由偏压引起的势垒降低，并假设针尖和样品的态密度在费米能级附近与能量无关。针尖与样品的间距从 $z$ 变为 $z - \\Delta z$，其中 $\\Delta z = 0.10\\,\\mathrm{nm}$。\n\n从不含时薛定谔方程出发，利用 Wentzel–Kramers–Brillouin (WKB) 近似处理电子在费米能级（能量为 $E$）通过势为 $U(z)$ 的经典禁区时的隧穿问题，推导对于高度为 $U - E = \\Phi$ 的矩形势垒，透射概率对距离的指数依赖关系。利用此关系式，用基本常数和给定参数表示隧穿电流之比 $I(z - \\Delta z)/I(z)$，然后计算其数值。\n\n使用以下常数：\n- 电子质量 $m_{e} = 9.109\\,383\\,7015 \\times 10^{-31}\\,\\mathrm{kg}$。\n- 约化普朗克常数 $\\hbar = 1.054\\,571\\,817 \\times 10^{-34}\\,\\mathrm{J\\,s}$。\n- 元电荷 $e = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{C}$。\n- $1\\,\\mathrm{eV} = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J}$。\n\n将最终答案表示为一个无量纲数，并四舍五入到三位有效数字。", "solution": "所提出的问题是量子力学应用于纳米技术领域，特别是扫描隧道显微镜（STM）的一个标准练习。该问题在科学上是合理的，提法明确，并包含了求解所需的所有信息。我将开始进行解答。\n\n问题要求从一维不含时薛定谔方程（TISE）出发进行推导，该方程描述了电子波函数 $\\psi(z)$ 的行为。对于一个质量为 $m_e$、能量为 $E$ 的电子在势 $U(z)$ 中运动，其 TISE 为：\n$$ -\\frac{\\hbar^2}{2m_e} \\frac{d^2\\psi(z)}{dz^2} + U(z)\\psi(z) = E\\psi(z) $$\n在经典禁区内，势能 $U(z)$ 超过电子的能量 $E$，该方程可以改写为：\n$$ \\frac{d^2\\psi(z)}{dz^2} = \\frac{2m_e}{\\hbar^2} (U(z) - E) \\psi(z) = \\kappa(z)^2 \\psi(z) $$\n其中 $\\kappa(z) = \\sqrt{\\frac{2m_e}{\\hbar^2}(U(z) - E)}$。\n\n对于缓变势，Wentzel–Kramers–Brillouin (WKB) 近似为该方程提供了一个近似解。对于隧穿通过一个从点 $z_1$ 延伸到 $z_2$ 的势垒，其透射概率 $T$ 由下式给出：\n$$ T \\approx \\exp\\left(-2 \\int_{z_1}^{z_2} \\kappa(z') dz'\\right) = \\exp\\left(-2 \\int_{z_1}^{z_2} \\sqrt{\\frac{2m_e}{\\hbar^2}(U(z') - E)} dz'\\right) $$\n问题指定了一个简化模型，其中真空间隙充当一个高度恒定的矩形势垒。针尖-样品间距用 $z$ 表示，因此势垒从 $z_1=0$ 延伸到 $z_2=z$。相对于费米能级的势垒高度为功函数 $\\Phi$。因此，对于 $0  z'  z$，我们有 $U(z) - E = \\Phi$。\n\n将这些条件代入 WKB 公式，由于被积函数是一个常数，积分变得很简单：\n$$ \\int_{0}^{z} \\sqrt{\\frac{2m_e\\Phi}{\\hbar^2}} dz' = \\sqrt{\\frac{2m_e\\Phi}{\\hbar^2}} \\int_{0}^{z} dz' = z \\sqrt{\\frac{2m_e\\Phi}{\\hbar^2}} $$\n这就得出了透射概率对间距 $z$ 的依赖关系：\n$$ T(z) \\approx \\exp\\left(-2z \\sqrt{\\frac{2m_e\\Phi}{\\hbar^2}}\\right) $$\n该表达式清楚地显示了透射概率随着针尖-样品间距的增加而呈指数衰减。\n\n在给定的假设下（小偏压、针尖和样品的态密度与能量无关），STM 中的隧穿电流 $I$ 与在费米能级处计算的透射概率成正比。这是 Bardeen 隧穿形式理论的一个标准结果。\n$$ I(z) \\propto T(z) $$\n因此，隧穿电流也表现出对距离的指数依赖性：\n$$ I(z) = I_0 \\exp\\left(-2z \\sqrt{\\frac{2m_e\\Phi}{\\hbar^2}}\\right) $$\n其中 $I_0$ 是一个指前因子，它依赖于材料性质和偏置电压，但与间距 $z$ 无关。\n\n题目要求我们计算当间距从 $z$ 变为 $z - \\Delta z$ 时隧穿电流的比率。我们来计算这个比率：\n$$ \\frac{I(z - \\Delta z)}{I(z)} = \\frac{I_0 \\exp\\left(-2(z - \\Delta z) \\sqrt{\\frac{2m_e\\Phi}{\\hbar^2}}\\right)}{I_0 \\exp\\left(-2z \\sqrt{\\frac{2m_e\\Phi}{\\hbar^2}}\\right)} $$\n指前因子 $I_0$ 被消去。利用指数函数的性质 $\\exp(a)/\\exp(b) = \\exp(a-b)$，我们得到：\n$$ \\frac{I(z - \\Delta z)}{I(z)} = \\exp\\left(-2(z - \\Delta z) \\sqrt{\\frac{2m_e\\Phi}{\\hbar^2}} - \\left(-2z \\sqrt{\\frac{2m_e\\Phi}{\\hbar^2}}\\right)\\right) $$\n$$ \\frac{I(z - \\Delta z)}{I(z)} = \\exp\\left(-2z\\sqrt{\\frac{2m_e\\Phi}{\\hbar^2}} + 2\\Delta z\\sqrt{\\frac{2m_e\\Phi}{\\hbar^2}} + 2z\\sqrt{\\frac{2m_e\\Phi}{\\hbar^2}}\\right) $$\n包含 $z$ 的项相互抵消，留下了比率的最终解析表达式，该表达式仅依赖于距离的变化量 $\\Delta z$ 和基本物理参数：\n$$ \\frac{I(z - \\Delta z)}{I(z)} = \\exp\\left(2 \\Delta z \\sqrt{\\frac{2m_e\\Phi}{\\hbar^2}}\\right) $$\n\n现在，必须使用所提供的常数计算其数值。\n给定值为：\n$\\Delta z = 0.10\\,\\mathrm{nm} = 0.10 \\times 10^{-9}\\,\\mathrm{m}$\n$\\Phi = 4.5\\,\\mathrm{eV}$\n$m_e = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$\n$\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s}$\n$1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$\n\n首先，我们将功函数转换为国际单位制单位（焦耳）：\n$$ \\Phi = 4.5\\,\\mathrm{eV} \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}) = 7.209794853 \\times 10^{-19}\\,\\mathrm{J} $$\n接下来，我们计算指数函数的自变量，记为 $X$：\n$$ X = 2 \\Delta z \\sqrt{\\frac{2m_e\\Phi}{\\hbar^2}} $$\n我们来计算平方根内的项：\n$$ \\frac{2m_e\\Phi}{\\hbar^2} = \\frac{2 \\times (9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}) \\times (7.209794853 \\times 10^{-19}\\,\\mathrm{J})}{(1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s})^2} $$\n$$ \\frac{2m_e\\Phi}{\\hbar^2} = \\frac{1.3135290 \\times 10^{-48}\\,\\mathrm{kg \\cdot J}}{1.1121206 \\times 10^{-68}\\,\\mathrm{J^2 \\cdot s^2}} \\approx 1.181105 \\times 10^{20}\\,\\mathrm{m^{-2}} $$\n取平方根得到衰减常数 $\\kappa$：\n$$ \\kappa = \\sqrt{\\frac{2m_e\\Phi}{\\hbar^2}} \\approx \\sqrt{1.181105 \\times 10^{20}\\,\\mathrm{m^{-2}}} \\approx 1.0867866 \\times 10^{10}\\,\\mathrm{m^{-1}} $$\n现在，我们可以计算指数 $X$：\n$$ X = 2 \\times (0.10 \\times 10^{-9}\\,\\mathrm{m}) \\times (1.0867866 \\times 10^{10}\\,\\mathrm{m^{-1}}) $$\n$$ X = 0.2 \\times 10^{-9} \\times 1.0867866 \\times 10^{10} = 0.2 \\times 10.867866 = 2.1735732 $$\n最后，电流之比为 $\\exp(X)$：\n$$ \\frac{I(z - \\Delta z)}{I(z)} = \\exp(2.1735732) \\approx 8.7891 $$\n按要求将此结果四舍五入到三位有效数字，得到 $8.79$。这表明针尖-样品间距仅减小 $1$ 埃（Angstrom）就会导致隧穿电流增加近九倍，这也是 STM 具有高垂直分辨率的原理。", "answer": "$$\\boxed{8.79}$$", "id": "2783101"}, {"introduction": "上一个练习中推导出的指数依赖关系不仅是一个理论概念，更是在真实实验中广泛应用的分析工具。本练习将挑战你从一个模拟的实验测量值（电流随距离的对数导数 $d\\ln I/dz$）出发，反向求解隧穿势垒的有效高度。这个过程将引出“表观势垒高度”这一重要概念，并帮助你理解它为何通常与材料的功函数有所不同。[@problem_id:2783098]", "problem": "在扫描隧道显微镜 (STM) 中，隧道电流 $I$ 通过跨越真空隙的量子力学隧穿效应，其大小依赖于针尖-样品间距 $z$。从不含时薛定谔方程出发，并对经典禁区使用温泽尔-克拉默斯-布里渊 (WKB) 近似，推导一个表达式，将小偏压下测得的隧道电流的对数空间导数 $d\\ln I/dz$ 与表观真空势垒高度 $\\Phi_{\\text{app}}$ 联系起来。假设在足够小的偏压下，相关电子的能量接近费米能级，势垒在整个间隙上可近似为空间均匀的，并且测得的电流与势垒的透射概率成正比。\n\n一项实验在小偏压下测得局部斜率 $d\\ln I/dz = 20\\ \\text{nm}^{-1}$（取其绝对值）。使用您推导的表达式，计算表观势垒高度 $\\Phi_{\\text{app}}$，并以电子伏特 (eV) 为单位表示最终结果。将您的答案四舍五入到三位有效数字。然后，在您的论证中，将该结果与常见金属的典型功函数（量级在 $4$ 到 $5.5$ eV）进行简要比较。\n\n在进行任何数值计算时，请使用以下物理常数：\n- 电子质量 $m_{e} = 9.109\\,383\\,7015 \\times 10^{-31}\\ \\text{kg}$，\n- 约化普朗克常数 $\\hbar = 1.054\\,571\\,817 \\times 10^{-34}\\ \\text{J}\\cdot\\text{s}$，\n- 元电荷 $e = 1.602\\,176\\,634 \\times 10^{-19}\\ \\text{C}$。\n\n以 eV 为单位表示 $\\Phi_{\\text{app}}$ 的最终数值，并四舍五入到三位有效数字。", "solution": "问题陈述经核实是科学上合理且表述清晰的。它提出了一个表面科学量子力学中的标准、可形式化的问题，没有矛盾，并为得到唯一解提供了所有必要信息。我们将按要求进行推导。\n\n出发点是质量为 $m_e$、能量为 $E$ 的电子在势 $V(z)$ 中的一维不含时薛定谔方程：\n$$-\\frac{\\hbar^2}{2m_e}\\frac{d^2\\psi(z)}{dz^2} + V(z)\\psi(z) = E\\psi(z)$$\n重新整理该方程可得：\n$$\\frac{d^2\\psi(z)}{dz^2} = \\frac{2m_e}{\\hbar^2}\\left(V(z) - E\\right)\\psi(z)$$\n在经典禁区中，势能 $V(z)$ 大于总能量 $E$。我们定义一个实值衰减常数 $\\kappa(z)$ 为：\n$$\\kappa(z) = \\sqrt{\\frac{2m_e}{\\hbar^2}\\left(V(z) - E\\right)}$$\n薛定谔方程于是变为：\n$$\\frac{d^2\\psi(z)}{dz^2} = \\kappa^2(z)\\psi(z)$$\n对于一个缓慢变化的势，温泽尔-克拉默斯-布里渊 (WKB) 近似给出了势垒内部波函数的解，其形式为指数衰减函数。穿过一个从 $z=0$ 延伸到 $z=z_0$ 的势垒的透射概率 $T$ 由下式给出：\n$$T \\propto \\exp\\left(-2 \\int_0^{z_0} \\kappa(z') dz'\\right)$$\n问题指明了几个简化假设。首先，势垒在整个间隙（我们设其宽度为 $z$）上是空间均匀的。这意味着对于 $0  z'  z$，$V(z')$ 是一个常数 $V_0$。其次，在小偏压下，隧穿电子的能量 $E$ 接近费米能级。差值 $V_0 - E$ 就是势垒高度，我们将其定义为表观势垒高度 $\\Phi_{\\text{app}}$。\n$$\\Phi_{\\text{app}} = V_0 - E$$\n在这些假设下，衰减常数 $\\kappa$不再是位置的函数，而是一个常数：\n$$\\kappa = \\sqrt{\\frac{2m_e \\Phi_{\\text{app}}}{\\hbar^2}}$$\nWKB 透射公式中的积分简化为：\n$$\\int_0^z \\kappa dz' = \\kappa \\int_0^z dz' = \\kappa z$$\n因此，作为针尖-样品间距 $z$ 的函数的透射概率为：\n$$T(z) \\propto \\exp(-2\\kappa z)$$\n问题陈述指出，隧道电流 $I$ 与透射概率 $T$ 成正比。因此，我们可以将电流写作：\n$$I(z) = C \\exp(-2\\kappa z)$$\n其中 $C$ 是一个比例常数，它依赖于态密度和外加偏压，但与间距 $z$ 无关。\n\n为了找到与测量量 $d\\ln I/dz$ 的关系，我们首先对电流取自然对数：\n$$\\ln I(z) = \\ln(C \\exp(-2\\kappa z)) = \\ln C - 2\\kappa z$$\n接下来，我们对间距 $z$ 求导：\n$$\\frac{d\\ln I}{dz} = -2\\kappa$$\n问题给出了这个斜率的大小，我们记为 $\\gamma$：\n$$\\gamma = \\left| \\frac{d\\ln I}{dz} \\right| = 2\\kappa$$\n代入 $\\kappa$ 的表达式：\n$$\\gamma = 2 \\sqrt{\\frac{2m_e \\Phi_{\\text{app}}}{\\hbar^2}}$$\n现在我们求解这个方程，得到表观势垒高度 $\\Phi_{\\text{app}}$：\n$$\\gamma^2 = 4 \\left(\\frac{2m_e \\Phi_{\\text{app}}}{\\hbar^2}\\right) = \\frac{8m_e \\Phi_{\\text{app}}}{\\hbar^2}$$\n$$\\Phi_{\\text{app}} = \\frac{\\hbar^2 \\gamma^2}{8m_e}$$\n这就是将可测量 $\\gamma$ 与表观势垒高度 $\\Phi_{\\text{app}}$ 联系起来所要求的表达式。\n\n现在，我们进行数值计算。给定的数值是：\n$\\gamma = 20\\ \\text{nm}^{-1} = 20 \\times 10^9\\ \\text{m}^{-1}$\n$m_e = 9.1093837015 \\times 10^{-31}\\ \\text{kg}$\n$\\hbar = 1.054571817 \\times 10^{-34}\\ \\text{J}\\cdot\\text{s}$\n$e = 1.602176634 \\times 10^{-19}\\ \\text{C}$\n\n首先，我们以国际单位制（焦耳）计算 $\\Phi_{\\text{app}}$：\n$$\\Phi_{\\text{app}} = \\frac{(1.054571817 \\times 10^{-34}\\ \\text{J}\\cdot\\text{s})^2 (20 \\times 10^9\\ \\text{m}^{-1})^2}{8 \\times (9.1093837015 \\times 10^{-31}\\ \\text{kg})}$$\n$$\\Phi_{\\text{app}} = \\frac{(1.1121189 \\times 10^{-68}\\ \\text{J}^2\\cdot\\text{s}^2) (4 \\times 10^{20}\\ \\text{m}^{-2})}{7.287507 \\times 10^{-30}\\ \\text{kg}}$$\n$$\\Phi_{\\text{app}} = \\frac{4.4484757 \\times 10^{-48}\\ \\text{J}^2\\cdot\\text{s}^2\\cdot\\text{m}^{-2}}{7.287507 \\times 10^{-30}\\ \\text{kg}}$$\n$$\\Phi_{\\text{app}} = 6.10424 \\times 10^{-19}\\ \\text{J}$$\n为了将此结果以电子伏特 (eV) 表示，我们除以元电荷 $e$：\n$$\\Phi_{\\text{app}} \\text{[in eV]} = \\frac{\\Phi_{\\text{app}} \\text{[in J]}}{e} = \\frac{6.10424 \\times 10^{-19}\\ \\text{J}}{1.602176634 \\times 10^{-19}\\ \\text{C}}$$\n$$\\Phi_{\\text{app}} = 3.81000\\dots\\ \\text{eV}$$\n四舍五入到三位有效数字，我们得到 $\\Phi_{\\text{app}} = 3.81\\ \\text{eV}$。\n\n最后，我们将此结果与金属的典型功函数（量级在 $4$ 到 $5.5\\ \\text{eV}$）进行比较。我们计算出的表观势垒高度 $\\Phi_{\\text{app}} = 3.81\\ \\text{eV}$ 低于这些典型值。这是一个预料之中且具有物理意义的结果。简单的矩形势垒理论模型是一种过度简化。实际上，在两个导电表面之间隧穿的电子会因其在电极中感应出的镜像电荷而受到引力。与我们模型中假设的恒定值相比，这种镜像势效应降低了势垒，尤其是在间隙的中间部分。对这个降低了的、非矩形的势垒进行 WKB 积分，会得到一个比材料实际功函数更低的“表观”势垒高度。因此，计算出的值是物理上合理的，并且与 STM 中的实验观察结果一致。", "answer": "$$ \\boxed{3.81} $$", "id": "2783098"}, {"introduction": "除了原子级形貌成像，扫描隧道谱（STS）是STM另一项强大的功能，它能探测样品局域的电子态密度。本计算练习要求你从头开始模拟一次谱学测量。你将学习一个本征的光谱特征（如洛伦兹峰）如何被有限温度和锁相放大器调制等真实实验条件展宽，从而深刻理解如何正确解读真实的谱学数据。[@problem_id:2783097]", "problem": "模拟扫描隧道显微镜（STM）中单个洛伦兹共振受热展宽和锁相调制展宽影响所测得的微分电导线型，并报告所得谱线的定量特征。目标可观测量是解调后的一阶谐波微分电导，作为样品偏压的函数。物理设置如下。\n\n- 考虑扫描隧道显微镜（STM），其中作为偏压 $V$ 函数的隧穿电流由金属针尖和样品之间的量子隧穿所决定。在Tersoff–Hamann的弹性隧穿模型中，假设针尖态密度和矩阵元是无特征的，则微分电导 $dI/dV$ 反映了样品经过热展宽的局域态密度。\n- 样品具有一个以能量 $E_0$ 为中心、固有半峰全宽（FWHM）为 $\\Gamma$ 的单个洛伦兹共振。未展宽的谱函数是能量上的洛伦兹函数。\n- 有限温度通过费米-狄拉克分布的导数产生热展宽。\n- 使用锁相放大器（LIA）进行 $dI/dV$ 的实验检测时，会施加一个峰值幅度为 $V_{\\mathrm{mod}}$、角频率为 $\\omega$ 的正弦电压调制，并在一阶谐波处进行解调。这实际上会产生一个取决于 $V_{\\mathrm{mod}}$ 的额外展宽。\n\n你的程序必须仅使用第一性原理和上述核心事实来构建测量到的线型：\n\n1) 未展宽的共振在能量上是洛伦兹型的。\n2) 热展宽源于温度 $T$ 下费米-狄拉克占据因子的导数。\n3) 带有正弦调制的一阶谐波锁相检测会产生一个确定的展宽核，该核通过将信号与参考正弦波相乘后在一个周期内进行时间平均得到。\n\n所有能量必须以毫电子伏特（meV）表示。所有电压必须以毫伏（mV）表示。在此背景下，将电子电荷视为单位1，因此1 mV的偏压在数值上对应于1 meV的能量。使用玻尔兹曼常数 $k_{\\mathrm{B}} = 0.08617333262$ meV/K。使用固有宽度 $\\Gamma = 10$ meV。假设未展宽的洛伦兹函数具有单位峰值幅度（任意单位）。\n\n算法要求：\n\n- 在一个从-200 meV到+200 meV（含两端）的均匀网格上表示能量（和偏压）轴，间距为 $\\Delta = 0.05$ meV。\n- 构建以 $E_0$ 为中心、固有宽度为 $\\Gamma$、峰值幅度为单位1的未展宽洛伦兹线型。\n- 从温度 $T$ 下的费米-狄拉克分布的导数构建热展宽核，并将其与洛伦兹函数进行卷积。如果 $T = 0$，则跳过此步骤（即无热展宽）。\n- 构建对应于峰值幅度为 $V_{\\mathrm{mod}}$ 的正弦调制下的一阶谐波检测的锁相调制展宽核，并将其与热展宽步骤的结果进行卷积。如果 $V_{\\mathrm{mod}} = 0$，则跳过此步骤（即无调制展宽）。\n- 所有卷积必须实现为离散卷积，以近似相应的连续卷积积分。在应用每个核之前，请确保其已归一化，使其积分为1，并在每次卷积中包含网格间距因子以近似积分。\n\n对于下面的每个测试用例，从最终展宽的线型中计算并报告三个量：\n\n- 峰值位置 $V_{\\text{peak}}$（单位 mV），四舍五入到三位小数。\n- 峰高（任意单位），四舍五入到六位小数。\n- 半峰全宽（FWHM）（单位 mV），四舍五入到三位小数。\n\n测试套件（每个元组为 $(E_0\\ \\text{单位 meV},\\ T\\ \\text{单位 K},\\ V_{\\mathrm{mod}}\\ \\text{单位 mV})$）：\n\n- 情况 A：$(0,\\ 0,\\ 0)$ 用于测试没有任何展宽的固有洛伦兹函数。\n- 情况 B：$(25,\\ 4.2,\\ 0)$ 用于仅测试低温下的热展宽。\n- 情况 C：$(-40,\\ 0,\\ 6)$ 用于仅测试有限调制幅度下的调制展宽。\n- 情况 D：$(15,\\ 77,\\ 6)$ 用于测试在较高温度下热展宽和调制展宽的组合效应。\n- 情况 E：$(0,\\ 300,\\ 0)$ 用于测试室温下的强热展宽。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的、用逗号分隔的浮点数列表。按 A、B、C、D、E 的顺序连接每个情况的三个四舍五入后的值。例如：\n`[Vpeak_A,Height_A,FWHM_A,Vpeak_B,Height_B,FWHM_B,...]`。\n- 所有电压必须按规定以 mV 为单位报告，所有高度均为无量纲（任意单位）。", "solution": "该问题要求对扫描隧道显微镜（STM）中测量的微分电导线型进行数值模拟，同时考虑热展宽和仪器展宽。任务是计算单个洛伦兹共振的最终展宽谱，并提取其关键特征：峰值位置、峰高和半峰全宽（FWHM）。\n\n对问题陈述的验证证实了其科学合理性和适定性。它基于固态物理学和测量理论的既定原理。所有必需的参数和算法步骤都已提供，构成一个自洽且可解的问题。\n\n解决方案是遵循所涉及的物理过程系统地构建的。\n\n**1. 能量轴的离散化**\n\n连续的能量变量 $E$（以及等效的样品偏压 $V$）被离散化到一个均匀的网格上。网格范围为 $[-200, +200]$ meV，间距为 $\\Delta = 0.05$ meV。所有数值运算将在此网格上执行。\n\n**2. 固有谱函数：洛伦兹函数**\n\n样品局域态密度中未展宽的共振由洛伦兹函数 $L(E)$ 描述。对于一个以能量 $E_0$ 为中心、固有半峰全宽（FWHM）为 $\\Gamma$ 的共振，具有单位峰值幅度的洛伦兹线型由下式给出：\n$$\nL(E; E_0, \\Gamma) = \\frac{(\\Gamma/2)^2}{(E - E_0)^2 + (\\Gamma/2)^2}\n$$\n问题指定固有宽度为 $\\Gamma = 10$ meV。这个函数代表了没有任何展宽效应时的“真实”微分电导。\n\n**3. 热展宽**\n\n在有限温度 $T > 0$ 时，测得的隧穿电流是样品态密度与热展宽函数的卷积。该函数源于费米能级上电子占据数的热弥散，由费米-狄拉克分布描述：\n$$\nf(E, T) = \\frac{1}{\\exp(E / (k_{\\mathrm{B}} T)) + 1}\n$$\n微分电导 $dI/dV$ 与谱函数和费米-狄拉克分布对能量的导数的卷积成正比。因此，热展宽核 $K_T(E)$ 为：\n$$\nK_T(E, T) = -\\frac{df(E, T)}{dE} = \\frac{1}{k_{\\mathrm{B}} T} \\frac{\\exp(E / (k_{\\mathrm{B}} T))}{(\\exp(E / (k_{\\mathrm{B}} T)) + 1)^2}\n$$\n这可以用双曲正割函数更紧凑地表示：\n$$\nK_T(E, T) = \\frac{1}{4 k_{\\mathrm{B}} T} \\text{sech}^2\\left(\\frac{E}{2 k_{\\mathrm{B}} T}\\right)\n$$\n该核在所有能量上的积分为1，$\\int_{-\\infty}^{\\infty} K_T(E) dE = 1$。热展宽线型 $L_T(E)$ 是通过将固有洛伦兹函数 $L(E)$ 与此核进行卷积得到的：\n$$\nL_T(E) = (L * K_T)(E) = \\int_{-\\infty}^{\\infty} L(E') K_T(E - E') dE'\n$$\n在数值上，这个连续卷积由离散卷积近似。如果 $T=0$，则省略此步骤，因为核函数变成狄拉克δ函数，它是卷积的单位元。\n\n**4. 锁相调制展宽**\n\n使用锁相放大器测量 $dI/dV$ 会引入额外的仪器展宽。一个正弦调制电压 $V_{\\mathrm{ac}}(t) = V_{\\mathrm{mod}} \\cos(\\omega t)$ 被加到直流偏压 $V$ 上。然后，锁相放大器在基频 $\\omega$ 处对隧穿电流进行解调，以提取一阶谐波分量，该分量被用作微分电导的度量。\n\n测量到的一阶谐波信号 $S_1(V)$ 并非真实的 $dI/dV$，而是真实 $dI/dV$ 信号（我们记为 $G(E)$）与一个由调制幅度 $V_{\\mathrm{mod}}$ 决定的展宽核 $K_M(E)$ 的卷积。严格的推导表明，测得的信号由下式给出：\n$$\nS_1(V) \\propto \\int_{-V_{\\mathrm{mod}}}^{V_{\\mathrm{mod}}} G(V - E') \\sqrt{V_{\\mathrm{mod}}^2 - (E')^2} dE'\n$$\n为了获得一个积分为1的正确归一化的核，调制展宽核 $K_M(E)$ 必须定义为：\n$$\nK_M(E; V_{\\mathrm{mod}}) = \n\\begin{cases} \n\\frac{2}{\\pi V_{\\mathrm{mod}}^2} \\sqrt{V_{\\mathrm{mod}}^2 - E^2}  \\text{if } |E| \\le V_{\\mathrm{mod}} \\\\\n0  \\text{if } |E| > V_{\\mathrm{mod}} \n\\end{cases}\n$$\n最终完全展宽的线型 $L_{T,M}(E)$ 是热展宽谱 $L_T(E)$ 与调制核 $K_M(E)$ 的卷积：\n$$\nL_{T,M}(E) = (L_T * K_M)(E) = \\int_{-\\infty}^{\\infty} L_T(E') K_M(E - E') dE'\n$$\n这个卷积也通过数值方法实现。如果 $V_{\\mathrm{mod}}=0$，则省略此步骤。\n\n**5. 谱特征的提取**\n\n对于每个测试用例，分析最终展宽的线型 $L_{final}(V)$ 以提取三个定量特征：\n- **峰值位置 ($V_{\\text{peak}}$):** 线型达到其最大值时的电压。这通过在计算出的信号数组中定位最大元素来找到。\n- **峰高:** 线型的最大幅度。\n- **半峰全宽 (FWHM):** 峰高一半处的峰宽。通过找到峰两侧信号等于其最大值一半的两个电压 $V_1$ 和 $V_2$ 来计算。那么 FWHM 就是 $|V_2 - V_1|$。这些交叉点通过在相邻网格点之间进行线性插值来高精度地确定。\n\n将洛伦兹函数生成、用于热效应的第一次卷积和用于调制效应的第二次卷积这一系列操作应用于每个测试用例，以产生所需的输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.signal import convolve\n\ndef solve():\n    \"\"\"\n    Simulates STM differential conductance lineshapes and extracts features.\n    \"\"\"\n    # Define physical constants and problem parameters\n    k_B = 0.08617333262  # Boltzmann constant in meV/K\n    GAMMA_INTRINSIC = 10.0  # Intrinsic FWHM in meV\n\n    # Define the energy/bias grid\n    E_min, E_max, dE = -200.0, 200.0, 0.05\n    E_axis = np.arange(E_min, E_max + dE, dE)\n    \n    # Test cases: (E0_meV, T_K, Vmod_mV)\n    test_cases = [\n        (0.0, 0.0, 0.0),      # Case A: Intrinsic Lorentzian\n        (25.0, 4.2, 0.0),     # Case B: Thermal broadening only (low T)\n        (-40.0, 0.0, 6.0),    # Case C: Modulation broadening only\n        (15.0, 77.0, 6.0),    # Case D: Combined thermal and modulation\n        (0.0, 300.0, 0.0),    # Case E: Strong thermal broadening (room T)\n    ]\n\n    results = []\n    \n    for E0, T, V_mod in test_cases:\n        # 1. Construct the unbroadened Lorentzian lineshape\n        half_gamma_sq = (GAMMA_INTRINSIC / 2.0)**2\n        lorentzian = half_gamma_sq / ((E_axis - E0)**2 + half_gamma_sq)\n        current_lineshape = lorentzian\n\n        # 2. Apply thermal broadening\n        if T > 0:\n            # Thermal kernel: derivative of Fermi-Dirac distribution\n            # K_T(E) = (1 / (4*kB*T)) * sech^2(E / (2*kB*T))\n            arg = E_axis / (2 * k_B * T)\n            # Avoid overflow for large arguments in cosh\n            thermal_kernel = np.zeros_like(E_axis)\n            safe_mask = np.abs(arg)  100\n            thermal_kernel[safe_mask] = (1.0 / (4.0 * k_B * T)) / (np.cosh(arg[safe_mask])**2)\n            \n            # Convolve and normalize\n            # conv(A, B)/sum(B) is equivalent to conv(A, B/sum(B))\n            # This avoids multiplying and dividing by dE, which can cancel out.\n            current_lineshape = convolve(current_lineshape, thermal_kernel, mode='same') / np.sum(thermal_kernel)\n\n        # 3. Apply lock-in modulation broadening\n        if V_mod > 0:\n            # Modulation kernel for 1st harmonic detection\n            # K_M(E) = (2/(pi*V_mod^2)) * sqrt(V_mod^2 - E^2) for |E| = V_mod\n            mod_kernel = np.zeros_like(E_axis)\n            mask = np.abs(E_axis) = V_mod\n            mod_kernel[mask] = (2.0 / (np.pi * V_mod**2)) * np.sqrt(V_mod**2 - E_axis[mask]**2)\n\n            # Convolve and normalize\n            current_lineshape = convolve(current_lineshape, mod_kernel, mode='same') / np.sum(mod_kernel)\n\n        final_lineshape = current_lineshape\n\n        # 4. Extract features from the final broadened lineshape\n        # Peak position and height\n        peak_idx = np.argmax(final_lineshape)\n        peak_pos = E_axis[peak_idx]\n        peak_height = final_lineshape[peak_idx]\n\n        # FWHM\n        half_height = peak_height / 2.0\n        \n        # Split the spectrum at the peak\n        left_y = final_lineshape[:peak_idx + 1]\n        left_x = E_axis[:peak_idx + 1]\n        right_y = final_lineshape[peak_idx:]\n        right_x = E_axis[peak_idx:]\n\n        try:\n            # Find left intersection point using interpolation\n            # Search from peak to left for first point below half_height\n            left_interp_idx = np.where(left_y  half_height)[0][-1]\n            # y values for interpolation must be monotonic\n            y_pts_left = [left_y[left_interp_idx], left_y[left_interp_idx + 1]]\n            x_pts_left = [left_x[left_interp_idx], left_x[left_interp_idx + 1]]\n            V_left = np.interp(half_height, y_pts_left, x_pts_left)\n        except IndexError:\n             # This can happen if the peak is too broad or at the edge.\n             # In this problem setup, it is not expected.\n             V_left = E_min\n        \n        try:\n            # Find right intersection point using interpolation\n            # Search from peak to right for first point below half_height\n            right_interp_idx = np.where(right_y  half_height)[0][0]\n            # y values for interpolation must be monotonic\n            y_pts_right = [right_y[right_interp_idx], right_y[right_interp_idx - 1]]\n            x_pts_right = [right_x[right_interp_idx], right_x[right_interp_idx - 1]]\n            V_right = np.interp(half_height, y_pts_right, x_pts_right)\n        except IndexError:\n            V_right = E_max\n\n        fwhm = V_right - V_left\n\n        # Append rounded results\n        results.extend([\n            round(peak_pos, 3),\n            round(peak_height, 6),\n            round(fwhm, 3)\n        ])\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2783097"}]}