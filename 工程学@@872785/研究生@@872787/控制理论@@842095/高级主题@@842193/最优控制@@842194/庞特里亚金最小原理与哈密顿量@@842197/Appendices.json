{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式就是实践。我们将从一个最基本的最优控制问题开始：单积分器系统的最小时间控制。这个问题将引导你完整地走一遍应用庞特里亚金最小值原理（PMP）的全过程，包括利用自由终端时间的横截条件来确定最优解，并验证哈密顿量在最优轨迹上恒为零的特性。[@problem_id:2732811]", "problem": "考虑一个带有界控制的单积分器的最小时间控制问题。设状态为标量 $x(t) \\in \\mathbb{R}$，控制为 $u(t) \\in \\mathbb{R}$，其动力学方程为\n$$\n\\dot{x}(t) = u(t),\n$$\n服从于对所有 $t$ 的逐点约束 $|u(t)| \\leq 1$。初始条件固定为 $x(0) = x_0$，终端状态固定为 $x(T) = x_f$，其中 $x_0, x_f \\in \\mathbb{R}$ 且 $x_0 \\neq x_f$。终端时间 $T$ 是自由的，目标是最小化转移时间，即最小化\n$$\nJ = T.\n$$\n仅使用庞特里亚金最小值原理（PMP）的基本陈述，在其最小化形式下，哈密顿量定义为 $H(x,u,p) = p f(x,u) + L(x,u)$，其中 $p$ 是协态，推导最优性的必要条件。然后明确确定：\n- 最优控制 $u^{\\ast}(t)$，\n- 协态 $p(t)$，\n- 最优终端时间 $T^{\\ast}$，\n并直接验证沿着最优解的哈密顿量满足对所有 $t \\in [0, T^{\\ast}]$ 都有 $H^{\\ast}(t) \\equiv 0$。\n\n作为最终答案，报告用 $x_0$ 和 $x_f$ 表示的最优终端时间 $T^{\\ast}$ 的闭式表达式。无需进行数值计算。", "solution": "该问题旨在为单积分器系统找到从初始状态 $x(0) = x_0$ 转移到最终状态 $x(T) = x_f$ 的最小时间。这是一个标准且适定的最优控制理论问题，所有必要组成部分都已定义，因此该问题是有效的。我们将使用庞特里亚金最小值原理（PMP）来求解。\n\n目标是最小化终端时间 $T$，可以写成如下泛函：\n$$\nJ = T = \\int_{0}^{T} 1 \\, dt\n$$\n因此，拉格朗日量（或运行成本）为 $L(x, u) = 1$。状态动力学由 $f(x, u) = u$ 给出。\n$$\n\\dot{x}(t) = u(t)\n$$\n控制 $u(t)$ 受限于 $|u(t)| \\leq 1$。初始和终端状态是固定的：$x(0) = x_0$ 和 $x(T) = x_f$，其中 $x_0 \\neq x_f$。终端时间 $T$ 是自由的。\n\n根据问题陈述，此最小化问题的哈密顿量 $H$ 定义为：\n$$\nH(x, u, p) = L(x, u) + p f(x, u)\n$$\n代入我们的具体函数，我们有：\n$$\nH(x, u, p) = 1 + p(t) u(t)\n$$\n这里，$p(t)$ 是协态（或伴随）变量。根据庞特里亚金最小值原理，最优性的必要条件是：\n\n$1$. 状态方程：最优状态轨迹 $x^{\\ast}(t)$ 和最优控制 $u^{\\ast}(t)$ 必须满足系统动力学。\n$$\n\\dot{x}^{\\ast}(t) = \\frac{\\partial H}{\\partial p} = u^{\\ast}(t)\n$$\n\n$2$. 协态方程：协态 $p(t)$ 必须满足伴随微分方程。\n$$\n\\dot{p}(t) = -\\frac{\\partial H}{\\partial x} = -\\frac{\\partial}{\\partial x} (1 + p(t)u(t)) = 0\n$$\n对该方程积分，我们发现协态对于所有 $t \\in [0, T^{\\ast}]$ 必须是一个常数：\n$$\np(t) = p_0 \\quad (\\text{常数})\n$$\n\n$3$. 最小化条件：对于所有 $t \\in [0, T^{\\ast}]$，最优控制 $u^{\\ast}(t)$ 必须在所有容许控制集合 $U = \\{u \\in \\mathbb{R} : |u| \\leq 1\\}$ 上最小化哈密顿量。\n$$\nH(x^{\\ast}(t), u^{\\ast}(t), p(t)) \\leq H(x^{\\ast}(t), u, p(t)) \\quad \\forall u \\in U\n$$\n哈密顿量是 $H = 1 + p_0 u$。这是一个关于 $u$ 的线性函数。使该表达式最小化的控制取决于常数协态 $p_0$ 的符号。\n- 如果 $p_0 > 0$，当 $u$ 取其最小负值时，$p_0 u$ 项最小化。因此，$u^{\\ast}(t) = -1$。\n- 如果 $p_0  0$，当 $u$ 取其最大正值时，$p_0 u$ 项最小化。因此，$u^{\\ast}(t) = +1$。\n- 如果 $p_0 = 0$，哈密顿量为 $H = 1$，与 $u$ 无关。最小化条件没有提供关于控制的任何信息。\n\n$4$. 横截性条件：对于一个终端状态固定且终端时间自由的问题，沿着最优轨迹计算的哈密顿量必须恒等于零。\n$$\nH^{\\ast}(t) = H(x^{\\ast}(t), u^{\\ast}(t), p(t)) \\equiv 0 \\quad \\text{对所有 } t \\in [0, T^{\\ast}]\n$$\n这给了我们条件：\n$$\n1 + p_0 u^{\\ast}(t) = 0\n$$\n从这个方程我们可以立即看出，$p_0 = 0$ 的情况是不可能的，因为它会导致 $1 = 0$ 的矛盾。因此，协态 $p_0$ 必须非零。这就解决了 $p_0=0$ 时最小化条件的模糊性。由于 $p_0$ 是一个非零常数，从 $1 + p_0 u^{\\ast}(t) = 0$ 可以得出，最优控制 $u^{\\ast}(t)$ 在整个轨迹中也必须是常数，且 $u^{\\ast}(t) = -1/p_0$。\n\n现在我们结合最小化条件和横截性条件来确定 $p_0$ 和 $u^{\\ast}$ 的值：\n- 如果我们假设 $p_0 > 0$，最小化条件要求 $u^{\\ast}(t) = -1$。将其代入横截性条件得到 $1 + p_0(-1) = 0$，从而得出 $p_0 = 1$。这与初始假设 $p_0 > 0$ 是一致的。\n- 如果我们假设 $p_0  0$，最小化条件要求 $u^{\\ast}(t) = +1$。将其代入横截性条件得到 $1 + p_0(+1) = 0$，从而得出 $p_0 = -1$。这也与初始假设 $p_0  0$ 是一致的。\n\n因此，对于在区间 $[0, T^{\\ast}]$ 上保持恒定的最优控制，我们有两种可能的情况：\n- 情况 A：$u^{\\ast}(t) = -1$（对应于 $p(t) = 1$）\n- 情况 B：$u^{\\ast}(t) = +1$（对应于 $p(t) = -1$）\n\n为了确定适用哪种情况，我们必须使用状态的边界条件。我们将状态方程 $\\dot{x}(t) = u^{\\ast}(t)$ 从 $t=0$ 积分到 $t=T^{\\ast}$：\n$$\n\\int_{0}^{T^{\\ast}} \\dot{x}(t) \\, dt = \\int_{0}^{T^{\\ast}} u^{\\ast}(t) \\, dt\n$$\n由于 $u^{\\ast}$ 是常数，我们有：\n$$\nx(T^{\\ast}) - x(0) = u^{\\ast} \\int_{0}^{T^{\\ast}} dt\n$$\n$$\nx_f - x_0 = u^{\\ast} T^{\\ast}\n$$\n因为 $x_0 \\neq x_f$，所以最小时间 $T^{\\ast}$ 必须为正。因此，我们可以写出：\n$$\nT^{\\ast} = \\frac{x_f - x_0}{u^{\\ast}}\n$$\n为了使 $T^{\\ast}$ 为正， $u^{\\ast}$ 的符号必须与位移 $x_f - x_0$ 的符号相同。\n- 如果 $x_f > x_0$，则 $x_f - x_0 > 0$。我们必须选择 $u^{\\ast} = +1$。这对应于情况 B。\n- 如果 $x_f  x_0$，则 $x_f - x_0  0$。我们必须选择 $u^{\\ast} = -1$。这对应于情况 A。\n\n总而言之，最优解如下：\n- 最优控制 $u^{\\ast}(t)$ 由总位移的符号给出：\n$$\nu^{\\ast}(t) = \\text{sgn}(x_f - x_0)\n$$\n对所有 $t \\in [0, T^{\\ast}]$ 均成立。由于 $x_0 \\neq x_f$，$\\text{sgn}(x_f - x_0)$ 的值是 $+1$ 或 $-1$。\n- 协态 $p(t)$ 是常数，由最优控制决定：\n$$\np(t) = p_0 = -\\frac{1}{u^{\\ast}} = -\\frac{1}{\\text{sgn}(x_f - x_0)} = -\\text{sgn}(x_f - x_0)\n$$\n- 将最优控制代入时间方程，可求得最优终端时间 $T^{\\ast}$：\n$$\nT^{\\ast} = \\frac{x_f - x_0}{u^{\\ast}} = \\frac{x_f - x_0}{\\text{sgn}(x_f - x_0)}\n$$\n对于任何非零实数 $z$，我们有 $z / \\text{sgn}(z) = |z|$。因此，最优时间是：\n$$\nT^{\\ast} = |x_f - x_0|\n$$\n\n最后，题目要求我们直接验证沿着最优解的哈密顿量恒等于零。\n最优哈密顿量为 $H^{\\ast}(t) = 1 + p(t) u^{\\ast}(t)$。代入我们求出的最优值：\n$$\nH^{\\ast}(t) = 1 + (-\\text{sgn}(x_f - x_0)) \\times (\\text{sgn}(x_f - x_0))\n$$\n由于对于任何 $z \\neq 0$，都有 $\\text{sgn}(z) \\times \\text{sgn}(z) = (\\text{sgn}(z))^2 = 1$，并且我们知道 $x_f - x_0 \\neq 0$：\n$$\nH^{\\ast}(t) = 1 - 1 = 0\n$$\n这对所有 $t \\in [0, T^{\\ast}]$ 都成立。验证完成，并确认了我们推导出的解与推导过程中使用的横截性条件的一致性。\n\n用 $x_0$ 和 $x_f$ 表示的最优终端时间 $T^{\\ast}$ 的最终表达式是 $|x_f - x_0|$。", "answer": "$$\n\\boxed{|x_f - x_0|}\n$$", "id": "2732811"}, {"introduction": "接下来，我们转向一个更复杂的系统——双积分器，这是力学和机器人学中的一个典型模型。这个问题的核心在于理解“开关函数”（switching function）的角色，它的正负号直接决定了“砰砰控制”（bang-bang control）策略。通过求解协态方程，你将推导出开关函数的显式时间依赖关系，从而掌握分析这类系统最优控制结构的关键。[@problem_id:2732750]", "problem": "考虑一个具有两个状态 $x_{1}$ 和 $x_{2}$ 以及一个受严格幅值约束的标量控制 $u$ 的控制仿射系统，\n$$\n\\dot{x}_{1}(t)=x_{2}(t),\\qquad \\dot{x}_{2}(t)=u(t),\\qquad |u(t)|\\le 1,\n$$\n其初始条件为 $x(0)=x_{0}\\in\\mathbb{R}^{2}$，终端条件为 $x(T)=0\\in\\mathbb{R}^{2}$，终端时间 $T\\ge 0$ 是自由的。通过指定性能指标、容许控制集和端点约束，构建正常的最小时间最优控制问题。然后，从庞特里亚金最小值原理 (PMP) 的定义出发，构建哈密顿量，推导协态动力学，陈述与自由终端时间和固定终端状态相关的横截条件，并描述最小化控制，包括任何切换逻辑。从第一性原理严格定义切换函数，并通过求解协态方程推导其显式的闭合形式时间依赖关系。\n\n您最终报告的量必须是切换函数作为时间 $t$ 和求解协态动力学产生的积分常数的函数的显式解析表达式。请以闭合形式提供此最终表达式。无需进行数值计算。最终答案必须是一个无单位的单一解析表达式。", "solution": "所述问题是最优控制理论中的一个标准、适定的问题，因此被认为是有效的。我们将继续进行推导。\n\n首先，我们形式化正常的最小时间最优控制问题。目标是最小化终端时间 $T$。这等价于最小化代价泛函 $J$，即在时间区间 $[0, T]$ 上对运行成本 $L(x, u) = 1$ 进行积分。\n性能指标为：\n$$\nJ(u) = \\int_{0}^{T} 1 \\, dt = T\n$$\n系统状态由向量 $x(t) = \\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix} \\in \\mathbb{R}^2$ 给出。状态动力学由向量场 $f(x, u)$ 描述：\n$$\n\\dot{x}(t) = f(x(t), u(t)) = \\begin{pmatrix} x_{2}(t) \\\\ u(t) \\end{pmatrix}\n$$\n控制输入 $u(t)$ 必须从容许控制集 $\\mathcal{U}$ 中选择，该集合由严格的幅值约束定义：\n$$\n\\mathcal{U} = \\{ u \\in \\mathbb{R} : |u| \\le 1 \\}\n$$\n端点约束是状态向量的初始和终端条件：\n$$\nx(0) = x_{0} = \\begin{pmatrix} x_{1,0} \\\\ x_{2,0} \\end{pmatrix}, \\quad x(T) = 0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n终端时间 $T \\ge 0$ 是自由的。\n\n我们应用庞特里亚金最小值原理 (PMP) 来寻找最优控制律。该原理需要引入协态向量 $p(t) = \\begin{pmatrix} p_{1}(t) \\\\ p_{2}(t) \\end{pmatrix} \\in \\mathbb{R}^2$。哈密顿量 $H(x, u, p)$ 定义为：\n$$\nH(x, u, p) = L(x, u) + p^{T}f(x, u)\n$$\n将该问题的 $L$ 和 $f$ 的具体形式代入，我们得到：\n$$\nH(x, u, p) = 1 + \\begin{pmatrix} p_{1}  p_{2} \\end{pmatrix} \\begin{pmatrix} x_{2} \\\\ u \\end{pmatrix} = 1 + p_{1}(t)x_{2}(t) + p_{2}(t)u(t)\n$$\n协态动力学由伴随方程 $\\dot{p}(t) = -\\nabla_{x} H(x(t), u(t), p(t))$ 给出：\n$$\n\\dot{p}_{1}(t) = -\\frac{\\partial H}{\\partial x_{1}} = -\\frac{\\partial}{\\partial x_{1}}(1 + p_{1}x_{2} + p_{2}u) = 0\n$$\n$$\n\\dot{p}_{2}(t) = -\\frac{\\partial H}{\\partial x_{2}} = -\\frac{\\partial}{\\partial x_{2}}(1 + p_{1}x_{2} + p_{2}u) = -p_{1}(t)\n$$\n根据PMP，最优控制 $u^{*}(t)$ 必须在每个时刻 $t \\in [0, T]$ 在容许集 $\\mathcal{U}$ 上最小化哈密顿量。我们寻求 $u^*(t)$ 使得：\n$$\nu^{*}(t) = \\arg\\min_{u \\in [-1, 1]} H(x^{*}(t), u, p^{*}(t)) = \\arg\\min_{u \\in [-1, 1]} (1 + p_{1}^{*}(t)x_{2}^{*}(t) + p_{2}^{*}(t)u)\n$$\n$1 + p_{1}^{*}x_{2}^{*}$ 项与 $u$ 无关。因此，最小化等价于最小化项 $p_{2}^{*}(t)u$。解由 $p_{2}^{*}(t)$ 的符号决定：\n- 如果 $p_{2}^{*}(t) > 0$，则通过选择 $u$ 为其最负值来最小化乘积 $p_{2}^{*}u$，因此 $u^{*}(t) = -1$。\n- 如果 $p_{2}^{*}(t)  0$，则通过选择 $u$ 为其最正值来最小化该乘积，因此 $u^{*}(t) = +1$。\n- 如果 $p_{2}^{*}(t) = 0$，哈密顿量与 $u$ 无关，控制不由该条件唯一确定。这种情况称为奇异情况。\n\n对于 $p_{2}^{*}(t) \\neq 0$ 的非奇异情况，这种控制逻辑可以使用符号函数紧凑地表示：\n$$\nu^{*}(t) = -\\text{sgn}(p_{2}^{*}(t))\n$$\n问题指定了自由终端时间 $T$ 和固定终端状态 $x(T)=0$。相关的横截条件是，在终端时间沿最优轨迹计算的哈密顿量必须为零：\n$$\nH(x^{*}(T), u^{*}(T), p^{*}(T)) = 0\n$$\n将 $x_{2}^{*}(T) = 0$ 代入哈密顿量的表达式，该条件变为：\n$$\n1 + p_{1}^{*}(T)x_{2}^{*}(T) + p_{2}^{*}(T)u^{*}(T) = 1 + p_{2}^{*}(T)u^{*}(T) = 0\n$$\n这意味着 $p_{2}^{*}(T) \\neq 0$，因为如果它为零，条件将简化为 $1=0$，这是一个矛盾。\n\n切换函数（我们记为 $\\sigma(t)$）定义为哈密顿量中控制变量 $u$ 的系数。从第一性原理出发，这是哈密顿量相对于控制的偏导数：\n$$\n\\sigma(t) = \\frac{\\partial H}{\\partial u} = \\frac{\\partial}{\\partial u}(1 + p_{1}x_{2} + p_{2}u) = p_{2}(t)\n$$\n因此，最优控制律为 $u^{*}(t) = -\\text{sgn}(\\sigma(t))$，前提是 $\\sigma(t) \\neq 0$。\n\n为了找到切换函数的显式时间依赖关系，我们必须求解协态微分方程。\n第一个方程是 $\\dot{p}_{1}(t) = 0$，积分为：\n$$\np_{1}(t) = c_{1}\n$$\n其中 $c_{1}$ 是一个积分常数。\n将此结果代入第二个方程 $\\dot{p}_{2}(t) = -p_{1}(t)$，得到：\n$$\n\\dot{p}_{2}(t) = -c_{1}\n$$\n对时间 $t$ 积分得到：\n$$\np_{2}(t) = \\int -c_{1} \\, dt = -c_{1}t + c_{2}\n$$\n其中 $c_{2}$ 是第二个积分常数。\n\n因此，切换函数是时间的仿射函数：\n$$\n\\sigma(t) = -c_{1}t + c_{2}\n$$\n常数 $c_{1}$ 和 $c_{2}$ 由状态的边界条件 $x(0)$ 和 $x(T)$ 通过完整的两点边值问题确定。PMP要求协态向量 $p(t)$ 不能恒等于零。如果在有限的时间区间上 $\\sigma(t) = 0$，则 $\\dot{\\sigma}(t) = \\dot{p}_{2}(t) = -c_{1} = 0$，这意味着 $c_{1}=0$。这又意味着 $\\sigma(t) = p_{2}(t) = c_{2} = 0$。因此，$p_{1}(t)=0$ 且 $p_{2}(t)=0$，这是平凡解 $p(t)=0$，被PMP的非平凡性条件所排除。因此，对于此问题，奇异弧不是最优的，切换函数只能在孤立的瞬间为零。控制是纯粹的“邦-邦”控制。\n\n问题要求给出切换函数作为时间 $t$ 和积分常数 $c_1$ 和 $c_2$ 的函数的显式解析表达式。这个表达式正是求解协态方程中 $p_2(t)$ 的结果。", "answer": "$$\n\\boxed{-c_{1}t + c_{2}}\n$$", "id": "2732750"}, {"introduction": "最优控制不仅限于最小化时间。在这个实践中，我们考虑最小化控制输入的 $L_1$ 范数，这通常被用作燃料消耗的代理。你会发现，由于哈密顿量的非光滑性，当开关函数在一段时间内为零时，就会出现一种新的最优行为——奇异弧（singular arc）。这个练习将揭示最优控制并非总是“砰砰”形式，并指导你如何构建包含“关断”阶段的控制策略。[@problem_id:2732800]", "problem": "考虑一个标量控制系统，其在固定时域 $ [0, T] $ 上由常微分方程 $ \\dot{x}(t) = u(t) $ 控制，边界条件为 $ x(0) = x_{0} $ 和 $ x(T) = 0 $。过程成本是控制的 $ L^{1} $-范数，\n$$\nJ[u] = \\int_{0}^{T} |u(t)| \\, dt.\n$$\n假设存在一个符合物理现实的幅值约束 $ |u(t)| \\leq U $（其中 $ U > 0 $ 为固定值），并假设满足可达性条件 $ T \\geq |x_{0}|/U $，以确保该边值问题是可行的。\n\n使用基本原理和庞特里亚金最小值原理 (PMP) 的陈述，完成以下任务：\n\n- 构建哈密顿量、协态方程以及在紧控制集 $ [-U, U] $ 上的逐点最小化条件。确定开关函数，并将最小化控制集刻画为开关函数的函数。\n- 利用此特性推导出最优控制的定性结构（即，控制处于饱和“bang”状态、“off”状态的条件，以及“bang-off-bang”结构如何从非光滑哈密顿量在开关面上的次微分中产生）。\n- 构造一个满足边界条件的最优控制，并用 $ x_{0} $ 和 $ U $ 显式地确定其各弧段的持续时间。\n- 将成本的最小值 $ J^{\\star} $ 计算为关于 $ x_{0} $ 和 $ U $ 的闭式表达式（可假设上述可行性条件成立）。您最终报告的答案必须是这个单一的表达式。\n\n最终表达式不需要数值近似，也不涉及单位。最终答案必须以单一的闭式解析表达式形式报告。", "solution": "所提出的问题是最优控制理论领域中的一个标准的适定问题。它具有科学依据，形式上明确，并且为解的存在性提供了所有必要条件。因此，我们可以直接使用庞特里亚金最小值原理 (PMP) 进行求解。\n\n问题是在系统动力学\n$$\n\\dot{x}(t) = u(t),\n$$\n边界条件\n$$\nx(0) = x_{0}, \\quad x(T) = 0,\n$$\n以及控制约束\n$$\n|u(t)| \\leq U\n$$\n的约束下，最小化成本泛函\n$$\nJ[u] = \\int_{0}^{T} |u(t)| \\, dt\n$$\n给定的条件 $T \\geq |x_{0}|/U$ 保证了到达目标状态的可行性。\n\n首先，我们为该问题构建哈密顿量。成本是拉格朗日形式，被积函数为 $L(u) = |u|$。根据PMP，我们引入一个协态变量（或称 costate）$p(t)$，并将哈密顿量 $H(x, p, u)$ 定义为：\n$$\nH(x, p, u) = L(u) + p(t) \\dot{x}(t) = |u| + p(t) u.\n$$\n这里我们将非正常乘子设为 $p_{0}=1$，这对于成本最小化问题是标准做法。协态方程控制着协态 $p(t)$ 的动力学：\n$$\n\\dot{p}(t) = - \\frac{\\partial H}{\\partial x} = - \\frac{\\partial}{\\partial x} \\left( |u| + p(t) u \\right) = 0.\n$$\n这意味着协态 $p(t)$ 在所有 $t \\in [0, T]$ 上都是一个常数。我们用 $p_{c}$ 表示这个常数。\n$$\np(t) = p_{c}.\n$$\nPMP指出，最优控制 $u^{*}(t)$ 必须在几乎每一个 $t \\in [0, T]$ 上逐点最小化哈密顿量：\n$$\nu^{*}(t) = \\arg\\min_{v \\in [-U, U]} H(x(t), p(t), v) = \\arg\\min_{v \\in [-U, U]} \\left( |v| + p_{c} v \\right).\n$$\n为了找到最小化控制，我们分析函数 $g(v) = |v| + p_{c} v$ 在区间 $v \\in [-U, U]$ 上的性质。这是一个分段线性的凸函数。\n我们考察它关于 $v$ 的导数（或者更形式化地，它的次梯度）：\n$\\frac{dg}{dv} = \\text{sgn}(v) + p_{c}$ for $v \\neq 0$.\n- 如果 $p_{c} > 1$，那么对所有 $v \\neq 0$ 都有 $\\frac{dg}{dv} > 0$。因此，$g(v)$ 是严格递增的，其在 $[-U, U]$ 上的最小值在 $v = -U$ 处取得。\n- 如果 $p_{c}  -1$，那么对所有 $v \\neq 0$ 都有 $\\frac{dg}{dv}  0$。因此，$g(v)$ 是严格递减的，其在 $[-U, U]$ 上的最小值在 $v = U$ 处取得。\n- 如果 $-1  p_{c}  1$，导数在 $v=0$ 处改变符号。对于 $v>0$，$\\frac{dg}{dv} = 1 + p_{c} > 0$，所以 $g(v)$ 增加。对于 $v0$，$\\frac{dg}{dv} = -1 + p_{c}  0$，所以 $g(v)$ 减少。最小值唯一地在 $v = 0$ 处取得。\n- 如果 $p_{c} = 1$，$g(v) = |v| + v$。对于 $v \\geq 0$，$g(v)=2v$。对于 $v  0$，$g(v)=0$。最小值为 $0$，对于任意 $v \\in [-U, 0]$ 均可达到。\n- 如果 $p_{c} = -1$，$g(v) = |v| - v$。对于 $v > 0$，$g(v)=0$。对于 $v \\leq 0$，$g(v)=-2v$。最小值为 $0$，对于任意 $v \\in [0, U]$ 均可达到。\n\n总结起来，作为常数协态 $p_{c}$ 的函数，最优控制 $u^{*}$ 为：\n$$\nu^{*}(p_{c}) \\in \\begin{cases} \\{U\\}  \\text{if } p_{c}  -1 \\\\ [0, U]  \\text{if } p_{c} = -1 \\\\ \\{0\\}  \\text{if } -1  p_{c}  1 \\\\ [-U, 0]  \\text{if } p_{c} = 1 \\\\ \\{-U\\}  \\text{if } p_{c} > 1 \\end{cases}\n$$\n常数 $p_{c}$ 就是开关函数。如果 $|p_{c}|=1$，则会出现奇异弧，此时最小化控制不唯一。这种奇异弧的存在是哈密顿量在 $u=0$ 处的非光滑性（次可微性）的直接结果。\n\n现在，我们必须使用边界条件来确定哪种控制结构得以实现。状态的总变化由动力学积分给出：\n$$\nx(T) - x(0) = \\int_{0}^{T} u(t) \\, dt \\implies 0 - x_{0} = \\int_{0}^{T} u(t) \\, dt.\n$$\n如果我们假设 $x_{0} \\neq 0$，那么控制 $u(t) = 0$ 不是一个解。这就排除了 $-1  p_{c}  1$ 的情况。控制必须非零，至少在一个正测度集上是如此。\n\n让我们考虑 $x_{0} > 0$ 的情况。我们必须有 $\\int_{0}^{T} u(t) \\, dt = -x_{0}  0$。控制的平均值必须为负。根据我们对 $u^{*}$ 的刻画，这要求 $p_{c} \\geq 1$。\n- 如果 $p_{c} > 1$，那么对所有 $t$ 都有 $u^{*}(t) = -U$。状态演化为 $x(t) = x_{0} - Ut$。在 $t=T$ 时的边界条件变为 $x(T) = x_{0} - UT = 0$，这意味着 $T = x_{0}/U$。这是给定的可行性条件 $T \\geq |x_{0}|/U$ 的一个特例。如果 $T=x_{0}/U$，最优控制是一个恒定的“bang”控制 $u^{*}(t) = -U$。\n- 如果 $T > x_{0}/U$，恒定的 $-U$ 控制将不起作用。因此，我们必须处于奇异弧上，这对应于 $p_{c}=1$。在这种情况下，任何取值于 $[-U, 0]$ 且满足积分约束 $\\int_{0}^{T} u(t) \\, dt = -x_{0}$ 的可测控制函数 $u(t)$ 都是一个候选解。所有这样的控制从PMP的角度看都是最优的。这允许多种结构，包括“bang-off”或“bang-off-bang”。\n\n题目要求我们构造一个这样的最优控制。让我们构造一个“bang-off”控制。对于 $x_{0} > 0$，我们施加最大负向控制 $u(t)=-U$ 持续时间 $t_{1}$，然后在剩余时间 $T-t_{1}$ 内施加零控制 $u(t)=0$。\n积分约束变为：\n$$\n\\int_{0}^{t_{1}} (-U) \\, dt + \\int_{t_{1}}^{T} (0) \\, dt = -U t_{1} = -x_{0}.\n$$\n这给出了“bang”段的持续时间为 $t_{1} = x_{0}/U$。由于给定 $T \\geq x_{0}/U=|x_{0}|/U$，我们有 $t_{1} \\leq T$，因此这种构造是有效的。\n最优控制是：\n$$\nu^{*}(t) = \\begin{cases} -U  \\text{for } t \\in [0, x_{0}/U] \\\\ 0  \\text{for } t \\in (x_{0}/U, T] \\end{cases}\n$$\n如果 $x_{0}  0$，我们需要 $\\int_{0}^{T} u(t) \\, dt = -x_{0} > 0$。这要求 $p_{c} \\leq -1$。如果 $T > |x_{0}|/U$，我们必须处于奇异弧 $p_{c}=-1$ 上。控制可以是任何满足积分约束的可测函数 $u(t) \\in [0, U]$。我们构造一个“bang-off”控制，其中 $u(t)=U$ 持续时间为 $t_{1}$：\n$$\n\\int_{0}^{t_{1}} U \\, dt = U t_{1} = -x_{0} \\implies t_{1} = -x_{0}/U = |x_{0}|/U.\n$$\n条件 $T \\geq |x_{0}|/U$ 确保了 $t_{1} \\leq T$。\n\n对于任何 $x_0$，我们可以将 bang 弧的持续时间表示为 $t_1 = |x_{0}|/U$。控制为 $u^{*}(t) = -\\text{sgn}(x_{0})U$ (当 $t \\in [0, |x_{0}|/U]$) 和 $u^{*}(t)=0$ (当 $t \\in (|x_{0}|/U, T]$)。$x_0=0$ 的情况可以平凡地处理，得到 $t_1=0$ 和 $u^*(t)=0$。\n\n最后，我们计算成本泛函的最小值 $J^{\\star}$。\n$$\nJ^{\\star} = \\int_{0}^{T} |u^{*}(t)| \\, dt = \\int_{0}^{|x_{0}|/U} |-\\text{sgn}(x_{0})U| \\, dt + \\int_{|x_{0}|/U}^{T} |0| \\, dt.\n$$\n$$\nJ^{\\star} = \\int_{0}^{|x_{0}|/U} U \\, dt = U \\left( \\frac{|x_{0}|}{U} \\right) = |x_{0}|.\n$$\n该问题的一个关键特征是，奇异弧上的无穷多个最优控制中的任何一个都会产生完全相同的最小成本。例如，如果 $x_{0}>0$，任何最优控制都必须满足 $u(t) \\in [-U, 0]$。因此，对于这样的控制，有 $|u(t)| = -u(t)$。成本为：\n$$\nJ[u] = \\int_{0}^{T} |u(t)| \\, dt = \\int_{0}^{T} (-u(t)) \\, dt = -\\int_{0}^{T} u(t) \\, dt = -(-x_{0}) = x_{0} = |x_{0}|.\n$$\n类似的论证也适用于 $x_{0}0$ 的情况。因此，最小成本是稳健确定的。", "answer": "$$\n\\boxed{|x_{0}|}\n$$", "id": "2732800"}]}