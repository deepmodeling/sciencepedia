{"hands_on_practices": [{"introduction": "要真正掌握带有积分作用的线性二次调节器（LQI），我们必须从理论走向应用。第一个练习将引导您为一个简单的机械系统完整地走一遍LQI的设计流程。通过为系统增加积分器状态并求解相关的黎卡提方程，您将亲身体验如何实现积分作用以消除稳态跟踪误差[@problem_id:2913462]。", "problem": "考虑一个由单位质量弹簧-阻尼器模型得到的连续时间、单输入单输出的二阶系统，其状态向量为 $x \\in \\mathbb{R}^{2}$，输入为 $u \\in \\mathbb{R}$，测量输出为 $y \\in \\mathbb{R}$，由以下公式给出：\n$$\n\\dot{x} = A x + B u,\\quad y = C x,\n$$\n其中\n$$\nA = \\begin{pmatrix} 0  1 \\\\ -2  -0.6 \\end{pmatrix},\\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\\quad C = \\begin{pmatrix} 1  0 \\end{pmatrix}.\n$$\n为了在使用线性二次调节器 (LQR) 时对常值指令实现零稳态跟踪误差，我们用一个积分状态 $z \\in \\mathbb{R}$ 来增广该系统，该积分状态根据以下公式对跟踪误差进行积分：\n$$\n\\dot{z} = r - y,\n$$\n其中 $r \\in \\mathbb{R}$ 是一个常值参考。令增广状态为 $x_{a} = \\begin{pmatrix} x \\\\ z \\end{pmatrix} \\in \\mathbb{R}^{3}$，并将增广线性时不变模型写成以下形式：\n$$\n\\dot{x}_{a} = A_{a} x_{a} + B_{a} u + E r,\n$$\n其中 $A_{a} \\in \\mathbb{R}^{3 \\times 3}$，$B_{a} \\in \\mathbb{R}^{3 \\times 1}$ 和 $E \\in \\mathbb{R}^{3 \\times 1}$ 将由上述定义确定。\n\n使用无限时域二次性能指标为增广系统设计一个连续时间线性二次调节器 (LQR) 进行调节（即将 $r$ 视为一个外生常数，并围绕 $r = 0$ 设计调节器）：\n$$\nJ = \\int_{0}^{\\infty} \\left( x_{a}(t)^{\\top} Q x_{a}(t) + u(t)^{\\top} R u(t) \\right) \\,\\mathrm{d}t,\n$$\n其中 $Q = \\mathrm{diag}(1,\\, 0.2,\\, 8)$ 且 $R = 1$。从第一性原理出发，通过推导适当的最优性必要条件，并确定一个矩阵方程，该方程的稳定解能产出最优增益 $K$ 和相关的对称矩阵 $P \\in \\mathbb{R}^{3 \\times 3}$，从而得到最优反馈律 $u(t) = -K x_{a}(t)$。根据给定数据计算 $P$ 和 $K$ 的数值。\n\n然后，对于单位阶跃指令 $r(t) \\equiv 1$，通过分析闭环增广系统在常值输入 $r$ 下的稳态来验证跟踪性能，并得出输出的稳态跟踪误差 $e_{\\infty} = \\lim_{t \\to \\infty} (r(t) - y(t))$ 的值。\n\n作为最终报告的答案，请提供 $e_{\\infty}$ 的单个标量值。不包括单位。因为该量通过分析是精确的，所以无需进行舍入。", "solution": "首先，我们构造增广系统矩阵。增广状态动态方程由各个分量的动态组合而成。根据积分器的定义 $\\dot{z} = r - y$ 以及系统的输出方程 $y = Cx$，我们有：\n$$\n\\dot{x}_{a} = \\begin{pmatrix} \\dot{x} \\\\ \\dot{z} \\end{pmatrix} = \\begin{pmatrix} Ax + Bu \\\\ r - Cx \\end{pmatrix}\n$$\n将此方程重新排列成所需的状态空间形式 $\\dot{x}_{a} = A_{a} x_{a} + B_{a} u + E r$：\n$$\n\\dot{x}_{a} = \\begin{pmatrix} A  0_{2 \\times 1} \\\\ -C  0 \\end{pmatrix} \\begin{pmatrix} x \\\\ z \\end{pmatrix} + \\begin{pmatrix} B \\\\ 0 \\end{pmatrix} u + \\begin{pmatrix} 0_{2 \\times 1} \\\\ 1 \\end{pmatrix} r\n$$\n代入给定的矩阵 $A$、$B$ 和 $C$，我们确定增广系统矩阵：\n$$\nA_{a} = \\begin{pmatrix} 0  1  0 \\\\ -2  -0.6  0 \\\\ -1  0  0 \\end{pmatrix}, \\quad B_{a} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad E = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\nLQR 设计是针对与 $\\dot{x}_a = A_a x_a + B_a u$ 对应的调节问题。最优控制律的形式为 $u(t) = -K x_a(t)$。\n增益矩阵 $K$ 由 $K = R^{-1} B_a^{\\top} P$ 给出，其中 $P$ 是连续时间代数Riccati方程 (CARE) 的唯一、对称、半正定解：\n$$\nA_a^{\\top} P + P A_a - P B_a R^{-1} B_a^{\\top} P + Q = 0\n$$\n如果矩阵对 $(A_a, B_a)$ 是能稳的，并且矩阵对 $(A_a, Q^{1/2})$ 是能检测的，则稳定解 $P$ 的存在性和唯一性得到保证。增广系统的能控性矩阵为：\n$$\n\\mathcal{C} = \\begin{pmatrix} B_a  A_a B_a  A_a^2 B_a \\end{pmatrix} = \\begin{pmatrix} 0  1  -0.6 \\\\ 1  -0.6  -1.64 \\\\ 0  0  -1 \\end{pmatrix}\n$$\n其行列式为 $\\det(\\mathcal{C}) = 1 \\neq 0$，因此系统是能控的，这意味着它是能稳的。由于 $Q = \\mathrm{diag}(1, 0.2, 8)$ 是正定的，矩阵对 $(A_a, Q^{1/2})$ 是能观的，这意味着它是能检测的。因此，存在唯一的稳定解 $P \\succ 0$。\n\n问题要求计算 $P$ 和 $K$ 的数值。这需要使用数值求解器（例如 MATLAB 或 SciPy）来求解上述的CARE。得到 $P$ 之后，最优增益可由 $K = R^{-1} B_a^{\\top} P = [p_{12}, p_{22}, p_{23}]$ 计算得出。然而，本题的核心在于分析稳态跟踪误差，这可以从第一性原理出发，而无需依赖 $P$ 和 $K$ 的具体数值。\n\n最后一个问题是关于稳态跟踪误差 $e_{\\infty}$。闭环系统动态由下式给出：\n$$\n\\dot{x}_a(t) = (A_a - B_a K) x_a(t) + E r(t)\n$$\nLQR 设计保证了增益 $K$ 能使系统稳定，这意味着闭环矩阵 $A_{cl} = A_a - B_a K$ 是赫尔维茨矩阵（其所有特征值都具有负实部）。\n对于一个常值参考输入 $r(t) = r$，一个稳定的线性系统将收敛到一个唯一的稳态 $x_{a,ss}$，在该稳态下 $\\dot{x}_a(t) \\to 0$。\n在稳态下，状态变量的导数为零。\n$$\n\\lim_{t \\to \\infty} \\dot{x}_a(t) = 0\n$$\n这意味着状态向量导数的每个分量都为零。特别地，对于积分状态 $z$：\n$$\n\\lim_{t \\to \\infty} \\dot{z}(t) = 0\n$$\n根据积分状态的定义，$\\dot{z} = r - y$。因此，在稳态下：\n$$\n\\lim_{t \\to \\infty} (r - y(t)) = 0\n$$\n这导出一个结论，即稳态输出 $y_{ss}$ 必须等于参考值 $r$：\n$$\ny_{ss} = \\lim_{t \\to \\infty} y(t) = r\n$$\n稳态跟踪误差定义为 $e_{\\infty} = \\lim_{t \\to \\infty} (r(t) - y(t))$。\n代入 $r(t)=r$（一个常数）和 $y(t) \\to y_{ss}$ 的稳态值：\n$$\ne_{\\infty} = r - y_{ss} = r - r = 0\n$$\n这个结果是在稳定的闭环系统的反馈回路中包含一个积分器的直接后果。该积分器迫使其所积分的量（即跟踪误差）在稳态下为零。这对任何非零常数参考值 $r$ 都成立，包括指定的 $r=1$ 的情况。因此，稳态跟踪误差精确为零。", "answer": "$$\n\\boxed{0}\n$$", "id": "2913462"}, {"introduction": "一个成功的LQI设计不仅仅是套用公式，更关键的是要满足其背后的数学保证。本练习将深入探讨一个关键条件：可检测性，如果在成本函数中未能对积分状态进行惩罚，这个条件就很容易被违反。通过分析一个设计失败的案例并探索修正方法，您将学会如何确保您的LQI控制器是可证明稳定的[@problem_id:2755125]。", "problem": "考虑一个连续时间、线性时不变系统，其状态、输入和测量输出由 $\\dot{x} = A x + B u$ 和 $y = C x$ 给出，其中 $x \\in \\mathbb{R}^{n}$，$u \\in \\mathbb{R}^{m}$，$y \\in \\mathbb{R}^{p}$。为了实现对恒定参考信号和恒定匹配扰动的零稳态误差，一种常见的方法是用误差积分状态 $v \\in \\mathbb{R}^{p}$ 来增广状态，其定义为 $\\dot{v} = r - y$，其中 $r \\in \\mathbb{R}^{p}$ 是参考信号。对于调节分析，假设 $r = 0$，因此增广动力学变为\n$$\n\\dot{x}_{a} = A_{a} x_{a} + B_{a} u, \\quad x_{a} \\triangleq \\begin{bmatrix} x \\\\ v \\end{bmatrix}, \\quad\nA_{a} \\triangleq \\begin{bmatrix} A  0 \\\\ -C  0 \\end{bmatrix}, \\quad B_{a} \\triangleq \\begin{bmatrix} B \\\\ 0 \\end{bmatrix}.\n$$\n设增广系统的线性二次调节器 (LQR) 代价函数为\n$$\nJ = \\int_{0}^{\\infty} \\left( x_{a}(t)^{\\top} Q_{a} x_{a}(t) + u(t)^{\\top} R u(t) \\right) \\, dt,\n$$\n其中 $Q_{a} \\succeq 0$ 且 $R \\succ 0$。假设选择块对角矩阵 $Q_{a} = \\mathrm{diag}(Q, Q_{v})$，其中 $Q \\succeq 0$ 且 $Q_{v} = 0$，即积分状态在代价函数中未被惩罚。假设 $(A, B)$ 是可镇定的。\n\n根据基本原理，我们知道，如果 $(A_{a}, B_{a})$ 是可镇定的且 $(Q_{a}^{1/2}, A_{a})$ 是可检测的，则存在一个镇定的 LQR 解。其中，可检测性意味着 $A_{a}$ 的任何与特征值 $\\lambda$（满足 $\\mathrm{Re}(\\lambda) \\ge 0$）相关的特征向量都必须能被 $Q_{a}^{1/2}$ 观测到。同时，我们还知道，当可检测性和可镇定性条件成立时，最优反馈 $u = -K x_{a}$ 可从连续时间代数黎卡提方程 (ARE) 的唯一半正定解 $P \\succeq 0$ 得到：\n$$\nA_{a}^{\\top} P + P A_{a} - P B_{a} R^{-1} B_{a}^{\\top} P + Q_{a} = 0,\n$$\n闭环矩阵为 $A_{a} - B_{a} K$，其中 $K = R^{-1} B_{a}^{\\top} P$。\n\n完成以下步骤。\n1) 从 $A_{a}$ 和 $Q_{a}$ 的结构出发，论证如果 $Q_{v} = 0$，则由于在特征值 $\\lambda = 0$ 处存在未被惩罚的积分器模态，$(Q_{a}^{1/2}, A_{a})$ 不满足可检测性。\n2) 用一个显式的最小例子来证明 ARE 可能存在一个半正定解 $P$，但该解不能使 $A_{a} - B_{a} K$ 渐近稳定。使用标量系统\n$$\nA = 0, \\quad B = 1, \\quad C = 1, \\quad Q_{a} = \\mathrm{diag}(1, 0), \\quad R = 1.\n$$\n计算 $P$、$K$ 以及 $A_{a} - B_{a} K$ 的特征值。\n3) 基于此分析，确定以下哪种补救措施可以解决不可检测性问题，并为用于跟踪的增广设计恢复一个镇定的黎卡提解。\n\n选择所有正确的陈述。\n\nA. 在该标量例子中，代数黎卡提方程的唯一半正定解是 $P = \\mathrm{diag}(1, 0)$，最优增益是 $K = [\\,1 \\;\\; 0\\,]$，闭环特征值为 $\\{0, -1\\}$，因此该黎卡提解不是镇定的。\n\nB. 增大控制惩罚 $R \\succ 0$（例如，取非常大的 $R$）可以强制使 $(Q_{a}^{1/2}, A_{a})$ 满足可检测性，并在不修改 $Q_{a}$ 或 $A_{a}$ 的情况下解决非镇定的黎卡提解问题。\n\nC. 通过选择 $Q_{v} \\succ 0$ 来惩罚积分状态，可以使 $(Q_{a}^{1/2}, A_{a})$ 变得可检测，并为增广系统产生一个镇定的 LQR 解。\n\nD. 添加一个小的“积分器泄漏”项 $\\dot{v} = - C x - \\epsilon v$（其中 $\\epsilon  0$）会修改 $A_{a}$，将积分器特征值移到开左半平面；这样即使 $Q_{v} = 0$，$(Q_{a}^{1/2}, A_{a})$ 也是可检测的，并且黎卡提解是镇定的。\n\nE. 消除积分作用，并在 $(A, B)$ 上使用标准的 LQR 并配合稳态预滤波器，可以消除可检测性问题，同时在存在系统-模型失配和恒定扰动的情况下，仍然保证对恒定参考信号的零稳态误差。", "solution": "我们从可镇定性、可检测性以及连续时间代数黎卡提方程 (ARE) 的线性二次调节器 (LQR) 条件的基本定义出发。\n\n首先，$(Q_{a}^{1/2}, A_{a})$ 的可检测性意味着，对于 $A_{a}$ 的任何特征对 $(\\lambda, \\xi)$ 且 $\\mathrm{Re}(\\lambda) \\ge 0$，该模态必须能从“输出” $z = Q_{a}^{1/2} x_{a}$ 观测到；等价地，在 $(Q_{a}^{1/2}, A_{a})$ 的不可观测子空间中，不应存在任何满足 $\\mathrm{Re}(\\lambda) \\ge 0$ 的非零特征向量 $\\xi \\ne 0$。这些结构性条件是存在唯一半正定解 $P \\succeq 0$ 的基础，该解能产生一个使 $A_{a} - B_{a} K$ 成为赫尔维茨矩阵的镇定反馈 $K = R^{-1} B_{a}^{\\top} P$。\n\n1) 当 $Q_{v} = 0$ 时可检测性不成立的结构性论证。\n\n当 $Q_{a} = \\mathrm{diag}(Q, 0)$ 且 $Q \\succeq 0$ 时，我们有\n$$\nQ_{a}^{1/2} = \\begin{bmatrix} Q^{1/2}  0 \\\\ 0  0 \\end{bmatrix}.\n$$\n增广动力学为\n$$\nA_{a} = \\begin{bmatrix} A  0 \\\\ -C  0 \\end{bmatrix}, \\quad B_{a} = \\begin{bmatrix} B \\\\ 0 \\end{bmatrix}.\n$$\n考虑任何向量 $\\xi = \\begin{bmatrix} 0 \\\\ v \\end{bmatrix}$，其中 $v \\in \\mathbb{R}^{p}, v \\ne 0$。则\n$$\nA_{a} \\xi = \\begin{bmatrix} A  0 \\\\ -C  0 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ v \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}.\n$$\n因此，$\\xi$ 是 $A_{a}$ 对应于特征值 $\\lambda = 0$ 的一个特征向量。由 $Q_{a}^{1/2}$ 导出的“输出”为\n$$\nQ_{a}^{1/2} \\xi = \\begin{bmatrix} Q^{1/2}  0 \\\\ 0  0 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ v \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}.\n$$\n因此，在特征值 $\\lambda=0$ 处的整个积分器子空间 $\\{ \\begin{bmatrix} 0 \\\\ v \\end{bmatrix} : v \\in \\mathbb{R}^{p} \\}$ 从 $Q_{a}^{1/2}$ 来看是不可观测的。因为 $\\lambda=0$ 不是严格稳定的，所以 $(Q_{a}^{1/2}, A_{a})$ 的可检测性不成立。这直接违反了 LQR 可解性和镇定性的一个标准条件。因此，即使 $(A, B)$ 是可镇定的（因此在温和条件下 $(A_{a}, B_{a})$ 通常也是可镇定的），可检测性的缺失也可能导致由 ARE 导出的反馈无法镇定 $A_{a}$ 的所有模态。\n\n2) 证明黎卡提解非镇定的显式例子。\n\n取标量系统\n$$\nA = 0, \\quad B = 1, \\quad C = 1, \\quad Q_{a} = \\mathrm{diag}(1, 0), \\quad R = 1.\n$$\n则\n$$\nA_{a} = \\begin{bmatrix} 0  0 \\\\ -1  0 \\end{bmatrix}, \\quad B_{a} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}, \\quad Q_{a} = \\begin{bmatrix} 1  0 \\\\ 0  0 \\end{bmatrix}.\n$$\n令 $P = \\begin{bmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{bmatrix} \\succeq 0$。连续时间 ARE\n$$\nA_{a}^{\\top} P + P A_{a} - P B_{a} R^{-1} B_{a}^{\\top} P + Q_{a} = 0\n$$\n按元素展开如下。计算\n$$\nA_{a}^{\\top} = \\begin{bmatrix} 0  -1 \\\\ 0  0 \\end{bmatrix}, \\quad\nA_{a}^{\\top} P = \\begin{bmatrix} -p_{12}  -p_{22} \\\\ 0  0 \\end{bmatrix}, \\quad\nP A_{a} = \\begin{bmatrix} -p_{12}  0 \\\\ -p_{22}  0 \\end{bmatrix},\n$$\n和\n$$\nP B_{a} R^{-1} B_{a}^{\\top} P = (P B_{a})(P B_{a})^{\\top} = \\begin{bmatrix} p_{11} \\\\ p_{12} \\end{bmatrix} \\begin{bmatrix} p_{11}  p_{12} \\end{bmatrix} = \\begin{bmatrix} p_{11}^{2}  p_{11} p_{12} \\\\ p_{12} p_{11}  p_{12}^{2} \\end{bmatrix}.\n$$\n因此 ARE 得到以下方程组\n$$\n\\begin{aligned}\n(1,1): \\quad -2 p_{12} - p_{11}^{2} + 1 = 0, \\\\\n(1,2): \\quad - p_{22} - p_{11} p_{12} = 0, \\\\\n(2,1): \\quad - p_{22} - p_{12} p_{11} = 0, \\\\\n(2,2): \\quad - p_{12}^{2} = 0.\n\\end{aligned}\n$$\n从 $(2,2)$ 我们得到 $p_{12} = 0$。然后 $(1,1)$ 给出 $- p_{11}^{2} + 1 = 0$，所以 $p_{11} = 1$（选择 $p_{11} = -1$ 是不可接受的，因为 $P \\succeq 0$）。从 $(1,2)$ 我们得到 $- p_{22} = 0$，所以 $p_{22} = 0$。因此\n$$\nP = \\begin{bmatrix} 1  0 \\\\ 0  0 \\end{bmatrix}.\n$$\n最优增益是\n$$\nK = R^{-1} B_{a}^{\\top} P = \\begin{bmatrix} 1  0 \\end{bmatrix}.\n$$\n闭环矩阵是\n$$\nA_{a} - B_{a} K = \\begin{bmatrix} 0  0 \\\\ -1  0 \\end{bmatrix} - \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} \\begin{bmatrix} 1  0 \\end{bmatrix} = \\begin{bmatrix} -1  0 \\\\ -1  0 \\end{bmatrix}.\n$$\n其特征多项式是 $\\lambda (\\lambda + 1)$，所以特征值为 $\\{ 0, -1 \\}$。因此，闭环系统不是渐近稳定的；未被惩罚的积分器模态保留在 $\\lambda = 0$ 处。这明确表明，当由于未被惩罚的积分器模态导致 $(Q_{a}^{1/2}, A_{a})$ 不可检测时，黎卡提解可能是非镇定的。\n\n3) 补救措施及其理由。\n\n- 通过惩罚积分状态进行补救：选择 $Q_{a} = \\mathrm{diag}(Q, Q_{v})$ 且 $Q_{v} \\succ 0$。这样，$Q_{a}^{1/2}$ 可以直接观测到积分器子空间，因此在 $\\lambda = 0$ 处的任何特征向量都不可能是不可观测的。因此 $(Q_{a}^{1/2}, A_{a})$ 是可检测的（实际上在积分器子空间上是可观测的），并且唯一的半正定解 $P$ 会产生一个镇定的反馈。\n\n- 通过积分器泄漏进行补救：将积分器动力学修改为 $\\dot{v} = - C x - \\epsilon v$ 且 $\\epsilon  0$。增广矩阵变为\n$$\nA_{a,\\epsilon} = \\begin{bmatrix} A  0 \\\\ -C  -\\epsilon I \\end{bmatrix}.\n$$\n这样，在 $\\lambda = 0$ 处的积分器特征值被移至 $\\lambda = -\\epsilon$，它严格位于开左半平面内。即使当 $Q_{v} = 0$ 时积分器子空间对于 $Q_{a}^{1/2}$ 仍然是不可观测的，可检测性要求任何不可观测的模态都必须是严格稳定的，而这个条件现在得到了满足。因此，黎卡提方程存在一个唯一的半正定解，该解能产生一个镇定的反馈。\n\n- 增大控制惩罚 $R$ 不会改变 $(Q_{a}^{1/2}, A_{a})$ 的可观测性或可检测性属性；可检测性取决于 $Q_{a}^{1/2}$ 和 $A_{a}$，而不是 $R$。因此，它无法解决一个根本性的可检测性违规问题。\n\n- 消除积分作用并使用稳态预滤波器与标准 LQR on $(A, B)$ 可以消除可检测性问题。然而，虽然这种设计在精确建模和无扰动的情况下可以实现对恒定参考信号的零稳态误差，但它通常不能保证在存在系统-模型失配或恒定扰动的情况下实现零稳态误差。积分作用正是为应对此类不确定性提供鲁棒性的。因此，其“仍然保证零稳态误差”在存在失配和扰动的情况下的说法是错误的。\n\n逐项分析选项：\n\nA. 正确。上述显式计算得出 $P = \\mathrm{diag}(1, 0)$，$K = [\\,1 \\;\\; 0\\,]$，以及闭环特征值 $\\{0, -1\\}$，证明了这是一个非镇定的黎卡提解。\n\nB. 错误。改变 $R$ 不影响 $(Q_{a}^{1/2}, A_{a})$ 的可检测性，而这才是问题的根源。\n\nC. 正确。选择 $Q_{v} \\succ 0$ 使积分器子空间可被 $Q_{a}^{1/2}$ 观测，从而恢复了可检测性并产生一个镇定的 LQR 解。\n\nD. 正确。添加泄漏项 $\\epsilon  0$ 将积分器特征值移入开左半平面；不可观测的模态变得严格稳定，满足了可检测性，并产生一个基于黎卡提方程的镇定控制器，即使 $Q_{v} = 0$。\n\nE. 错误。移除积分作用可以消除可检测性问题，但在存在模型失配或恒定扰动的情况下，并不能保证零稳态误差；积分作用是针对此类偏差的鲁棒性补救措施。\n\n因此，正确的选项是 A、C 和 D。", "answer": "$$\\boxed{ACD}$$", "id": "2755125"}, {"introduction": "在学会如何设计稳定的LQI控制器之后，理解其在面对挑战性系统时的性能极限至关重要。本练习将探讨在控制一个非最小相位系统（即含有右半平面零点的系统）时所面临的基本权衡。您将分析为何激进的积分作用可能导致瞬态响应（如欠冲）恶化，从而深刻理解在相互冲突的控制目标之间进行权衡的实用艺术[@problem_id:2755087]。", "problem": "考虑单输入单输出 (SISO) 线性时不变 (LTI) 对象\n$$\nG(s) \\;=\\; \\frac{s - z}{(s + 1)(s + 2)}, \\qquad z \\in (0,\\,0.2],\n$$\n其在原点附近的位置 $+z$ 处有一个右半平面 (RHP) 传输零点。您希望通过为对象增加一个积分状态来实现对单位阶跃参考 $r(t) = 1(t)$ 的零稳态误差跟踪\n$$\n\\dot{\\xi}(t) \\;=\\; r(t) - y(t),\n$$\n并设计一个带积分作用的连续时间线性二次型调节器 (LQR)。具体来说，使用增广状态 $x_a = \\begin{bmatrix}x^\\top  \\xi\\end{bmatrix}^\\top$ 和代价函数\n$$\nJ \\;=\\; \\int_{0}^{\\infty} \\left( x(t)^\\top Q \\, x(t) \\;+\\; q_i \\, \\xi(t)^2 \\;+\\; \\rho \\, u(t)^2 \\right)\\, dt,\n$$\n其中 $Q \\succeq 0$，$q_i  0$，$\\rho  0$，从而得到如下形式的静态状态反馈\n$$\nu(t) \\;=\\; -K_x \\, x(t) \\;-\\; k_i \\, \\xi(t),\n$$\n以及（如果需要）标准的参考前馈或预滤波器，以实现单位稳态增益。假设闭环系统内部稳定。\n\n从第一性原理出发，您的任务是分析积分作用的强度（当 $q_i$ 变化时）与由对象的 RHP 零点引起的闭环非最小相位行为之间的基本权衡。在您的推理中，您可以依赖于一些核心事实，例如：积分作用的内模原理、状态反馈下传输零点的不变性，以及非最小相位系统的经典性能限制（例如，Bode 灵敏度积分约束）。不要假设任何特定的数值整定；而是定性但严谨地推理其对 $z$ 和 $q_i$ 的依赖关系。\n\n下列哪个陈述是正确的？\n\nA. 无论 $Q$ 和 $\\rho$ 如何选择，当增加 $q_i$ 以增强积分作用并降低低频灵敏度时，具有 RHP 零点的对象的 Bode 灵敏度积分约束会迫使高频处的灵敏度峰值增加。在时域中，这表现为更显著的非最小相位瞬态（例如，下冲或过冲），其严重程度随着 $q_i$ 的增加而增长。\n\nB. 当 $q_i$ 足够大时，积分作用可以有效地抵消对象的 RHP 零点，并实现无过冲或下冲的单调、任意快速的阶跃跟踪。\n\nC. 对于任何内部稳定的控制器，对象的位于 $+z$ 的 RHP 零点都不能被控制器极点抵消而不丧失内部稳定性；此外，静态状态反馈（包括带积分增广的 LQR）不会改变对象的传输零点。\n\nD. 对于单调阶跃跟踪，可实现的上升时间存在一个基本下界，其量级约为 $1/z$。尝试实现远小于 $1/z$ 的上升时间 $t_r$ 必然会引起显著的反向响应（下冲）和/或大的控制峰值，这与在 LQR 设计中如何选择 $Q$、$q_i$ 和 $\\rho$ 无关。", "solution": "该问题陈述具有科学依据，提法得当且客观。它提出了一个控制理论中关于非最小相位系统性能限制的标准且不简单的问题。其前提在事实上是正确的且内部一致。因此，该问题是有效的，将进行全面分析。\n\n这个问题的核心在于理解右半平面 (RHP) 零点对任何反馈控制系统施加的不可违背的约束。我们将从第一性原理出发分析该系统，以评估每个陈述。\n\n对象由以下传递函数给出：\n$$\nG(s) = \\frac{s - z}{(s + 1)(s + 2)}, \\qquad z \\in (0, 0.2]\n$$\n这是一个在 $s=z$ 处有 RHP 零点的单输入单输出 (SISO) 系统。目标是使用带有增广积分状态 $\\xi(t)$（其中 $\\dot{\\xi}(t) = r(t) - y(t)$）的 LQR 控制器，为单位阶跃参考 $r(t)=1(t)$ 实现零稳态误差。\n\n设对象有一个最小状态空间实现 $(A, B, C, D)$。由于传递函数是严格真分数的，所以 $D=0$。例如，在能观标准型中：\n$$\nA = \\begin{bmatrix} -3  -2 \\\\ 1  0 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1  -z \\end{bmatrix}\n$$\n增广系统状态为 $x_a = \\begin{bmatrix} x^\\top  \\xi \\end{bmatrix}^\\top$。其动态方程为：\n$$\n\\dot{x}_a = \\begin{bmatrix} \\dot{x} \\\\ \\dot{\\xi} \\end{bmatrix} = \\begin{bmatrix} A  0 \\\\ -C  0 \\end{bmatrix} x_a + \\begin{bmatrix} B \\\\ 0 \\end{bmatrix} u + \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} r\n$$\n控制律是关于增广状态的静态状态反馈：\n$$\nu(t) = -K_a x_a(t) = - \\begin{bmatrix} K_x  k_i \\end{bmatrix} \\begin{bmatrix} x(t) \\\\ \\xi(t) \\end{bmatrix}\n$$\n增益 $K_x$ 和 $k_i$ 是通过最小化 LQR 代价函数来确定的。得到的控制器是线性和时不变的。\n\n闭环动态方程为：\n$$\n\\dot{x}_a = \\left( \\begin{bmatrix} A  0 \\\\ -C  0 \\end{bmatrix} - \\begin{bmatrix} B \\\\ 0 \\end{bmatrix} \\begin{bmatrix} K_x  k_i \\end{bmatrix} \\right) x_a + \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} r = \\begin{bmatrix} A - BK_x  -Bk_i \\\\ -C  0 \\end{bmatrix} x_a + \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} r\n$$\n输出为 $y = \\begin{bmatrix} C  0 \\end{bmatrix} x_a$。\n\n我们必须确定从参考 $r$ 到输出 $y$ 的闭环传递函数 $T_{yr}(s)$。一个关键性质是，由于状态反馈和积分增广不会改变系统的传输零点，闭环传递函数 $T_{yr}(s)$ 必然会保留原对象在 $s=z$ 处的 RHP 零点。因此，我们得到了一个关键性质：$T_{yr}(z) = 0$。这个基本性质以及其他性质，使我们能够评估各个选项。\n\n### 逐项分析\n\n**A. 无论 $Q$ 和 $\\rho$ 如何选择，当增加 $q_i$ 以增强积分作用并降低低频灵敏度时，具有 RHP 零点的对象的 Bode 灵敏度积分约束会迫使高频处的灵敏度峰值增加。在时域中，这表现为更显著的非最小相位瞬态（例如，下冲或过冲），其严重程度随着 $q_i$ 的增加而增长。**\n\n这个陈述讨论了由 Bode 灵敏度积分描述的“水床效应”。对于任何内部稳定的 LTI 控制器，灵敏度函数 $S(s) = (1+L(s))^{-1}$（其中 $L(s)$ 是开环传递函数）必须满足某些约束。对于一个在 $s=z$ 处有单个 RHP 零点且 $L(s)$ 中没有 RHP 极点的系统，该约束为：\n$$\n\\int_{0}^{\\infty} \\ln |S(j\\omega)| \\, d\\omega = \\pi z\n$$\n由于 $z  0$，该积分为正。这意味着在某些频率下灵敏度的任何降低（即 $|S(j\\omega)|  1$，因此 $\\ln|S(j\\omega)|  0$）都必须由其他频率下灵敏度的增加（即 $|S(j\\omega)|  1$，因此 $\\ln|S(j\\omega)|  0$）来补偿。\n\n在 LQR 代价中增加积分状态的权重 $q_i$ 会惩罚跟踪误差的积分。优化器会通过增加积分增益 $k_i$ 来响应，从而增强积分作用。这会增加低频下的环路增益 $L(s)$，使 $|S(j\\omega)|$ 在更宽的低频范围内更接近于 0。为了保持 Bode 积分的恒定正值，灵敏度图中这个更大的“凹陷”必须由一个更大的“凸起”来弥补，即 $|S(j\\omega)|  1$ 的区域。这就是灵敏度峰值的增加，通常发生在中高频。众所周知，灵敏度函数中的大峰值与较差的瞬态响应相关，例如大的过冲和振荡。对于非最小相位系统，这会加剧其固有的下冲。因此，通过 $q_i$ 增强积分作用会使非最小相位瞬态行为更加严重。该陈述正确地描述了这种基本权衡。\n\n**结论：正确。**\n\n**B. 当 $q_i$ 足够大时，积分作用可以有效地抵消对象的 RHP 零点，并实现无过冲或下冲的单调、任意快速的阶跃跟踪。**\n\n这个陈述在多个方面都是事实错误的。\n1.  **RHP 零点抵消**：控制器无法在不引起内部不稳定的情况下抵消对象的 RHP 零点。抵消需要控制器在 $s=z$ 处有一个极点。这将在闭环中创建一个不稳定的模式 $e^{zt}$，该模式要么从输入端不可控，要么从输出端不可观（或两者兼而有之），因此无法被稳定。带积分作用的 LQR 设计产生的是针对增广系统的静态状态反馈控制器；它不会通过放置极点来抵消零点。\n2.  **零点不变性**：如前所述，闭环传递函数 $T_{yr}(s)$ 继承了对象在 $s=z$ 处的 RHP 零点。\n3.  **性能限制**：具有 RHP 零点的系统不可能同时具有任意快和任意良好（例如，单调）的响应。$s=z$ 处的 RHP 零点的存在对性能施加了根本性限制，排除了单调、任意快速的跟踪。对于这类系统，下冲是快速跟踪不可避免的后果。\n\n**结论：错误。**\n\n**C. 对于任何内部稳定的控制器，对象的位于 $+z$ 的 RHP 零点都不能被控制器极点抵消而不丧失内部稳定性；此外，静态状态反馈（包括带积分增广的 LQR）不会改变对象的传输零点。**\n\n这个陈述包含两个独立但相关的控制理论基本原理。\n1.  **极零点对消**：陈述的第一部分，关于稳定地抵消 RHP 零点是不可能的，这是一个经典结论。如果一个控制器 $K(s)$ 在 $s=z$ 处有一个极点，用来抵消对象在 $s=z$ 处的零点，其中 $\\text{Re}(z)  0$，那么得到的闭环系统将是内部不稳定的。与这个极零点对相关的不稳定模式不会被反馈回路稳定。这是正确的。\n2.  **状态反馈下零点的不变性**：第二部分也是一个标准结论。由 $(A, B, C, D)$ 描述的线性系统的传输零点在静态状态反馈 $u \\to u - Kx$ 下是不变的。这是因为该变换不改变定义零点的 Rosenbrock 系统矩阵的秩属性。LQR 控制器作为增广状态向量上的一种静态状态反馈，也遵循此规则。对象的传输零点在回路中被保留，并最终出现在闭环传递函数中。这是正确的。\n陈述的两个部分都是准确的，并且是分析给定问题的基础。\n\n**结论：正确。**\n\n**D. 对于单调阶跃跟踪，可实现的上升时间存在一个基本下界，其量级约为 $1/z$。尝试实现远小于 $1/z$ 的上升时间 $t_r$ 必然会引起显著的反向响应（下冲）和/或大的控制峰值，这与在 LQR 设计中如何选择 $Q$、$q_i$ 和 $\\rho$ 无关。**\n\n这个陈述描述了 RHP 零点所施加的时域性能限制。由于阶跃响应的闭环传递函数是 $Y(s) = T_{yr}(s)/s$ 且 $T_{yr}(z)=0$，我们可以写出关于阶跃响应 $y(t)$ 导数的一个矩约束：\n$$\n\\mathcal{L}\\{\\dot{y}(t)\\} = sY(s) - y(0)\n$$\n假设 $y(0)=0$ 并在 $s=z$ 处求值：\n$$\n\\int_0^{\\infty} \\dot{y}(t) e^{-zt} \\, dt = T_{yr}(z) = 0\n$$\n这个积分方程揭示了核心的权衡关系。为了实现快速的上升时间，$\\dot{y}(t)$ 在小的 $t$ 值时必须是大的正数。由于权重项 $e^{-zt}$ 在小的 $t$ 值时最大，这会对积分产生一个大的正贡献。为了满足总积分为零的约束，$\\dot{y}(t)$ 必须取负值。负的 $\\dot{y}(t)$ 意味着输出正在减小，对于一个从 0 开始到 1 的阶跃响应，这意味着初始的下冲（反向响应）。上升时间越快（$\\dot{y}(t)$ 的正值越大），为了平衡积分，下冲就必须越显著。\n\n这意味着对于给定的可接受下冲水平，可实现的上升时间存在一个基本下界。一个常见的经验法则是，可实现的闭环带宽 $\\omega_B$ 受 RHP 零点位置的限制，例如 $\\omega_B \\lesssim z$。由于上升时间 $t_r$ 与带宽成反比（$t_r \\approx \\text{const}/\\omega_B$），这导致了上升时间的下界，$t_r \\gtrsim 1/z$。\n\n试图通过激进的控制器整定（例如，相对于 $\\rho$ 取较大的 $Q$ 和 $q_i$）来突破这个界限，并不会消除该限制，反而会导致病态行为：严重的下冲和/或极大的控制信号 ($u(t)$)。这个限制是对象本身固有的，与控制器设计方法（LQR 或其他方法）无关。\n\n**结论：正确。**", "answer": "$$\\boxed{ACD}$$", "id": "2755087"}]}