{"hands_on_practices": [{"introduction": "要真正掌握LQR控制器，我们必须从第一性原理出发。第一个实践练习将引导您完成标量系统的基本推导，直接应用Hamilton-Jacobi-Bellman方程来求解最优增益。通过完成这个核心计算[@problem_id:2734387]，您将巩固对代数Riccati方程起源和LQR解基础的理解。", "problem": "考虑标量线性时不变系统 $\\dot{x}(t) = a\\,x(t) + b\\,u(t)$，其中 $b \\neq 0$，$q \\ge 0$，$r > 0$。性能指标为无穷时域二次型代价 $J = \\int_{0}^{\\infty} \\big(q\\,x(t)^{2} + r\\,u(t)^{2}\\big)\\,dt$。利用动态规划的基本原理，通过哈密顿-雅可比-贝尔曼（Hamilton–Jacobi–Bellman）方程，推导使 $J$ 最小化的最优状态反馈律 $u(t) = -K\\,x(t)$ 以及在二次型拟设 $V(x) = P\\,x^{2}$ 中相关的价值函数系数 $P$。用 $a$、$b$、$q$ 和 $r$ 的精确闭式解形式表示 $P$ 和 $K$，并证明所选稳定分支的合理性。然后，在 $|a| \\ll \\sqrt{q\\,r}/|b|$ 的情况下，确定 $K$ 的主阶渐近标度，并简要解释其原因。将你的最终答案表示为 $K$ 关于 $a$、$b$、$q$ 和 $r$ 的函数的精确闭式解表达式（无需进行数值计算）。", "solution": "我们从用于无穷时域最优控制的哈密顿-雅可比-贝尔曼（Hamilton–Jacobi–Bellman, HJB）方程开始。对于标量系统 $\\dot{x} = a\\,x + b\\,u$ 和代价密度 $\\ell(x,u) = q\\,x^{2} + r\\,u^{2}$（其中 $q \\ge 0$ 且 $r > 0$），价值函数 $V(x)$ 满足\n$$\n0 \\;=\\; \\min_{u} \\Big\\{ q\\,x^{2} + r\\,u^{2} + V_{x}(x)\\,\\big(a\\,x + b\\,u\\big) \\Big\\}.\n$$\n根据系统和代价的结构，很自然地可以寻找一个二次型价值函数 $V(x) = P\\,x^{2}$，其中 $P \\ge 0$ 是一个未知常数。那么 $V_{x}(x) = 2\\,P\\,x$，HJB方程变为\n$$\n0 \\;=\\; \\min_{u} \\Big\\{ q\\,x^{2} + r\\,u^{2} + 2\\,P\\,x\\,(a\\,x + b\\,u) \\Big\\}\n\\;=\\; \\min_{u} \\Big\\{ (q + 2\\,a\\,P)\\,x^{2} + r\\,u^{2} + 2\\,b\\,P\\,x\\,u \\Big\\}.\n$$\n对每个固定的 $x$，内部的最小化问题是一个关于 $u$ 的凸二次型问题。使表达式最小化的输入 $u^{\\star}$ 满足一阶条件\n$$\n\\frac{\\partial}{\\partial u}\\Big( r\\,u^{2} + 2\\,b\\,P\\,x\\,u \\Big) \\;=\\; 2\\,r\\,u + 2\\,b\\,P\\,x \\;=\\; 0,\n$$\n由此得到最优反馈\n$$\nu^{\\star} \\;=\\; -\\,\\frac{b\\,P}{r}\\,x.\n$$\n这确定了最优静态状态反馈增益为\n$$\nK \\;=\\; \\frac{b\\,P}{r}.\n$$\n将 $u^{\\star}$ 代回HJB表达式，得到括号内表达式的最小值为：\n$$\n(q + 2\\,a\\,P)\\,x^{2} + r\\,\\Big(-\\frac{b\\,P}{r}\\,x\\Big)^{2} + 2\\,b\\,P\\,x\\,\\Big(-\\frac{b\\,P}{r}\\,x\\Big)\n\\;=\\; \\Big(q + 2\\,a\\,P - \\frac{b^{2}\\,P^{2}}{r}\\Big)\\,x^{2}.\n$$\n因此，HJB方程化简为标量代数里卡提（Riccati）方程\n$$\nq + 2\\,a\\,P - \\frac{b^{2}}{r}\\,P^{2} \\;=\\; 0,\n$$\n或者等价地，\n$$\n\\frac{b^{2}}{r}\\,P^{2} - 2\\,a\\,P - q \\;=\\; 0.\n$$\n对这个关于 $P$ 的二次方程求解，得到\n$$\nP \\;=\\; \\frac{2\\,a \\pm \\sqrt{4\\,a^{2} + 4\\,\\frac{b^{2}}{r}\\,q}}{2\\,\\frac{b^{2}}{r}}\n\\;=\\; \\frac{a \\pm \\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}}{\\frac{b^{2}}{r}}\n\\;=\\; \\frac{r}{b^{2}}\\Big(a \\pm \\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}\\Big).\n$$\n为了选择稳定解，考察使用 $u=-K\\,x$ 时的闭环动力学：\n$$\n\\dot{x} \\;=\\; \\big(a - b\\,K\\big)\\,x \\;=\\; \\Big(a - \\frac{b^{2}}{r}\\,P\\Big)\\,x.\n$$\n使用 $P$ 的表达式，\n$$\na - \\frac{b^{2}}{r}\\,P \\;=\\; a - \\Big(a \\pm \\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}\\Big) \\;=\\; \\mp\\,\\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}.\n$$\n稳定分支要求 $a - \\frac{b^{2}}{r}\\,P  0$，即需要取负根。因此我们在 $P$ 的表达式中取正号：\n$$\nP \\;=\\; \\frac{r}{b^{2}}\\Big(a + \\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}\\Big),\n$$\n由此得到精确的最优增益\n$$\nK \\;=\\; \\frac{b\\,P}{r} \\;=\\; \\frac{a + \\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}}{b}.\n$$\n这个 $K$ 产生的闭环特征值为 $a - b\\,K = -\\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q} \\le 0$，除非 $q = 0$ 且 $a \\le 0$，否则该值严格为负，从而在标准的非退化情况下保证了稳定性。\n\n对于渐近标度，考虑 $|a| \\ll \\sqrt{q\\,r}/|b|$ 的情况。那么\n$$\n\\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}\n\\;=\\;\n|b|\\,\\sqrt{\\frac{q}{r}}\\,\\sqrt{1 + \\frac{a^{2}\\,r}{b^{2}\\,q}}\n\\;=\\;\n|b|\\,\\sqrt{\\frac{q}{r}}\\Big(1 + \\mathcal{O}\\Big(\\frac{a^{2}\\,r}{b^{2}\\,q}\\Big)\\Big),\n$$\n所以\n$$\nK \\;=\\; \\frac{a}{b} + \\frac{1}{b}\\,\\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}\n\\;=\\;\n\\frac{a}{b} + \\frac{|b|}{b}\\,\\sqrt{\\frac{q}{r}} + \\mathcal{O}\\Big(\\frac{|a|^{2}}{|b|}\\,\\sqrt{\\frac{r}{q}}\\Big).\n$$\n在主阶上，$a/b$ 项相对于与 $\\sqrt{q/r}$ 成正比的项可以忽略不计，因此\n$$\nK \\sim \\frac{|b|}{b}\\,\\sqrt{\\frac{q}{r}}.\n$$\n特别地，当 $b > 0$ 时，这简化为 $K \\sim \\sqrt{q/r}$，这证实了所述的标度行为。\n\n因此，最优增益的精确闭式解表达式为\n$$\nK \\;=\\; \\frac{a + \\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}}{b}.\n$$", "answer": "$$\\boxed{\\frac{a+\\sqrt{a^{2}+\\frac{b^{2}}{r}\\,q}}{b}}$$", "id": "2734387"}, {"introduction": "掌握了基本计算方法后，我们转向一个关键的实践问题：如何选择权重矩阵$Q$和$R$。这个练习[@problem_id:2734404]探讨了无量纲化和缩放的重要性，以确保您的成本函数具有物理意义，并且您的控制器设计对任意单位选择都具有鲁棒性。正确处理这些问题是优秀控制工程实践的标志。", "problem": "考虑一个连续时间线性时不变系统，其状态 $x \\in \\mathbb{R}^{n}$ 和输入 $u \\in \\mathbb{R}^{m}$ 由 $\\dot{x} = A x + B u$ 控制。线性二次调节器 (LQR) 的成本函数为\n$$\nJ = \\int_{0}^{\\infty} \\left( x^{\\top} Q x + u^{\\top} R u \\right) \\, dt,\n$$\n其中 $Q \\in \\mathbb{R}^{n \\times n}$ 是对称半正定矩阵，$R \\in \\mathbb{R}^{m \\times m}$ 是对称正定矩阵。假设状态分量 $x_i$ 和输入分量 $u_j$ 的物理单位分别是 $\\mathsf{U}_{x_i}$ 和 $\\mathsf{U}_{u_j}$，并且 $Q$ 和 $R$ 的元素是固定的数值。我们希望成本 $J$ 在物理上是有意义的，即被积函数中的每一项都具有一致且可比较的物理单位，并且状态和输入惩罚的相对权重不是由 $x$ 和 $u$ 的任意测量单位所产生的人为结果。\n\n下列哪个陈述正确描述了应如何选择或解释状态和输入的单位与缩放，以使 $J$ 在物理上有意义且权重可比较？\n\nA. 引入可逆对角缩放矩阵 $D_x \\in \\mathbb{R}^{n \\times n}$ 和 $D_u \\in \\mathbb{R}^{m \\times m}$ 来定义无量纲变量 $z = D_x x$ 和 $v = D_u u$。选择无量纲权重矩阵 $W_x \\succeq 0$ 和 $W_u \\succ 0$，并设置 $Q = D_x^{\\top} W_x D_x$ 和 $R = D_u^{\\top} W_u D_u$。这样，$x^{\\top} Q x = z^{\\top} W_x z$ 和 $u^{\\top} R u = v^{\\top} W_u v$ 都是无量纲的，可以直接比较。此外，将 $(Q,R)$ 乘以任何一个共同的正标量，最优 LQR 反馈保持不变，因此只有状态和输入惩罚之间的相对缩放比例是重要的。\n\nB. 选择单位，使得 $x^{\\top} Q x$ 的单位是能量，$u^{\\top} R u$ 的单位是功率。由于两者在物理上都有意义，它们的和在物理上也有意义。\n\nC. 将每个状态和输入分量通过一个特征量级或其稳态标准差进行归一化，即 $z_i = x_i / \\sigma_{x_i}$ 和 $v_j = u_j / \\sigma_{u_j}$，其中 $\\sigma_{x_i}, \\sigma_{u_j}  0$，并在缩放后的坐标系中使用权重 $W_x = I$ 和 $W_u = \\rho I$ （其中 $\\rho  0$ 是一个权衡参数）来设计 LQR。通过 $Q = D_x^{\\top} W_x D_x$ 和 $R = D_u^{\\top} W_u D_u$（其中 $D_x = \\mathrm{diag}(1/\\sigma_{x_i})$ 和 $D_u = \\mathrm{diag}(1/\\sigma_{u_j})$）映射回去，得到的成本函数其状态和输入项都是无量纲且权重可比较的，并且相对权衡对于 $x$ 和 $u$ 的测量单位的选择是不变的。\n\nD. 在测量单位发生变化 $x = T_x \\tilde{x}$ 和 $u = T_u \\tilde{u}$（其中 $T_x$ 和 $T_u$ 是可逆对角矩阵）的情况下，应将 $A$ 和 $B$ 变换为 $T_x A T_x^{-1}$ 和 $T_x B T_u^{-1}$，但保持 $Q$ 和 $R$ 的数值不变；这样得到的 LQR 控制器在物理上是等效的且单位一致。\n\nE. 如果 $Q$ 和 $R$ 是对角且严格为正的，则单位一致性和可比性得到保证，因为被积函数只包含平方项的和，没有交叉项来产生单位不匹配。\n\n选择所有适用的选项。", "solution": "问题要求找出关于线性二次调节器 (LQR) 成本函数中各项的物理意义和权重可比性的正确陈述。系统动力学由 $\\dot{x} = A x + B u$ 给出，成本泛函为 $J = \\int_{0}^{\\infty} \\left( x^{\\top} Q x + u^{\\top} R u \\right) \\, dt$。问题的核心在于状态 $x$ 和输入 $u$ 的物理单位，以及应如何选择或解释权重矩阵 $Q$ 和 $R$。\n\n量纲分析的基本原则规定，只有当物理量具有相同的物理单位时，才能将它们相加或进行比较。成本函数的被积函数是一个和式，$x^{\\top} Q x + u^{\\top} R u$。要使这个和式在物理上有意义， $x^{\\top} Q x$ 和 $u^{\\top} R u$ 这两项必须具有相同的物理单位。我们用 $\\mathcal{U}$ 表示这个共同的单位。\n$$\n[x^{\\top} Q x] = [u^{\\top} R u] = \\mathcal{U}\n$$\n其中 $[\\cdot]$ 表示一个量的物理单位。\n\n项 $x^{\\top} Q x$ 是由二次型 $\\sum_{i=1}^{n} \\sum_{j=1}^{n} Q_{ij} x_i x_j$ 给出的标量。为了使这个和在量纲上是齐次的，每一项 $Q_{ij} x_i x_j$ 都必须具有相同的单位 $\\mathcal{U}$。设 $\\mathsf{U}_{x_k}$ 是状态分量 $x_k$ 的单位。那么我们必须有：\n$$\n[Q_{ij}] \\cdot [\\mathsf{U}_{x_i}] \\cdot [\\mathsf{U}_{x_j}] = \\mathcal{U} \\quad \\forall i, j \\in \\{1, \\dots, n\\}\n$$\n类似地，对于输入项 $u^{\\top} R u = \\sum_{k=1}^{m} \\sum_{l=1}^{m} R_{kl} u_k u_l$，设 $\\mathsf{U}_{u_p}$ 是输入分量 $u_p$ 的单位，我们必须有：\n$$\n[R_{kl}] \\cdot [\\mathsf{U}_{u_k}] \\cdot [\\mathsf{U}_{u_l}] = \\mathcal{U} \\quad \\forall k, l \\in \\{1, \\dots, m\\}\n$$\n问题陈述 $Q$ 和 $R$ 的元素是“固定的数值”。这通常被解释为这些元素是无量纲的。如果 $[Q_{ij}]=1$ 和 $[R_{kl}]=1$，那么为了量纲一致性，我们需要 $[\\mathsf{U}_{x_i}] \\cdot [\\mathsf{U}_{x_j}]$ 对所有 $i,j$ 都是一个常数单位，并且 $[\\mathsf{U}_{u_k}] \\cdot [\\mathsf{U}_{u_l}]$ 对所有 $k,l$ 都是一个常数单位，此外，这两个常数单位必须相同。这是一个极其严格的条件，在实践中几乎永远不会满足。例如，一个机械系统的状态向量可能包含位置（米，$\\text{m}$）和速度（米/秒，$\\text{m/s}$）。那么 $[x_1^2] = \\text{m}^2$ 而 $[x_2^2] = (\\text{m/s})^2$，这是不同的单位。如果 $Q_{11}$ 和 $Q_{22}$ 是无量纲数，将 $Q_{11}x_1^2$ 和 $Q_{22}x_2^2$ 相加在物理上是无意义的。\n\n标准且正确的工程方法是对问题进行无量纲化。我们现在根据这一原则评估每个选项。\n\n**选项 A 的分析：**\n这个选项提出了一个系统化的无量纲化过程。\n1.  使用可逆对角缩放矩阵 $D_x$ 和 $D_u$ 定义无量纲变量 $z = D_x x$ 和 $v = D_u u$。如果 $x$ 的第 $i$ 个分量 $x_i$ 的单位是 $\\mathsf{U}_{x_i}$，那么为了使对应的分量 $z_i$ 无量纲，对角元素 $(D_x)_{ii}$ 的单位必须是 $1/\\mathsf{U}_{x_i}$。通常，$(D_x)_{ii} = 1/x_{i, \\text{char}}$，其中 $x_{i, \\text{char}}$ 是 $x_i$ 的一个特征值或最大期望值。\n2.  成本项用这些新变量重写。该陈述声称如果 $Q = D_x^{\\top} W_x D_x$，则 $x^{\\top} Q x = z^{\\top} W_x z$。我们来验证一下：$x^{\\top} (D_x^{\\top} W_x D_x) x = (D_x x)^{\\top} W_x (D_x x) = z^{\\top} W_x z$。这在代数上是正确的。对于 $u^{\\top} R u = v^{\\top} W_u v$ 和 $R = D_u^{\\top} W_u D_u$ 也有类似的验证。\n3.  该陈述建议使用无量纲的权重矩阵 $W_x$ 和 $W_u$。由于 $z$ 和 $v$ 是无量纲的，二次型 $z^{\\top} W_x z$ 和 $v^{\\top} W_u v$ 也是无量纲的标量。因此，它们的和是良定义的，并且可以直接比较。这正确地解决了单位一致性问题。\n4.  该陈述的最后一部分声称，将 $Q$ 和 $R$ 同乘以一个正标量不会改变最优 LQR 反馈增益 $K$。设新的权重为 $Q' = \\alpha Q$ 和 $R' = \\alpha R$，其中 $\\alpha  0$。最优增益为 $K = R^{-1} B^{\\top} P$，其中 $P$ 是代数 Riccati 方程 (ARE) 的稳定解：$A^{\\top} P + P A - P B R^{-1} B^{\\top} P + Q = 0$。对于新的权重，设解为 $P'$。ARE 变为 $A^{\\top} P' + P' A - P' B (\\alpha R)^{-1} B^{\\top} P' + \\alpha Q = 0$。我们来检验假设 $P' = \\alpha P$。将其代入新的 ARE 得到 $A^{\\top} (\\alpha P) + (\\alpha P) A - (\\alpha P) B (\\alpha R)^{-1} B^{\\top} (\\alpha P) + \\alpha Q = 0$。这可以简化为 $\\alpha A^{\\top} P + \\alpha P A - (\\alpha^2/\\alpha) P B R^{-1} B^{\\top} P + \\alpha Q = 0$。提出因子 $\\alpha$，我们得到 $\\alpha (A^{\\top} P + P A - P B R^{-1} B^{\\top} P + Q) = 0$。由于 $\\alpha  0$，括号内的表达式必须为零，这正是原始的 ARE。因此，$P' = \\alpha P$ 是正确的解。新的增益是 $K' = (R')^{-1} B^{\\top} P' = (\\alpha R)^{-1} B^{\\top} (\\alpha P) = (\\alpha^{-1} R^{-1}) B^{\\top} (\\alpha P) = R^{-1} B^{\\top} P = K$。增益确实是不变的。这意味着对于控制律而言，只有惩罚的相对大小是重要的。\n这个陈述的每一部分都是正确的，并代表了控制工程中的最佳实践。\n结论：**正确**。\n\n**选项 B 的分析：**\n这个陈述建议 $x^{\\top} Q x$ 的单位是能量，$u^{\\top} R u$ 的单位是功率。能量的单位是焦耳 ($\\text{J}$)，而功率的单位是焦耳每秒 ($\\text{J/s}$)。这是不同的物理量纲。将这两个量相加违反了量纲齐次性原则。将能量与功率相加，就像将长度与时间相加一样没有意义。因此，得到的和在物理上是没有意义的。\n结论：**错误**。\n\n**选项 C 的分析：**\n这个选项展示了选项 A 中描述的一般方法的具体、实际的应用。\n1.  它为缩放因子提出了一个具体的选择：特征量级的倒数，具体来说是稳态标准差 $\\sigma_{x_i}$ 和 $\\sigma_{u_j}$。这使得缩放后的变量 $z_i = x_i / \\sigma_{x_i}$ 和 $v_j = u_j / \\sigma_{u_j}$ 成为无量纲量，表示以标准差为单位的偏差。这是一个非常普遍且有效的选择。\n2.  它为无量纲权重矩阵提出了一个简单、清晰的选择：$W_x = I$ 和 $W_u = \\rho I$，其中 $\\rho  0$ 是某个标量。这意味着任何状态的一个标准差的误差，其先验惩罚量是相同的，输入也是如此。标量 $\\rho$ 成为调节状态调节和控制努力之间权衡的唯一旋钮。这通常被称为 Bryson 法则。\n3.  它正确地陈述了映射回物理坐标权重的公式：$Q = D_x^{\\top} W_x D_x$ 和 $R = D_u^{\\top} W_u D_u$，其中 $D_x=\\mathrm{diag}(1/\\sigma_{x_i})$ 和 $D_u=\\mathrm{diag}(1/\\sigma_{u_j})$。当 $W_x=I$ 和 $W_u=\\rho I$ 时，这得到 $Q=\\mathrm{diag}(1/\\sigma_{x_i}^2)$ 和 $R=\\mathrm{diag}(\\rho/\\sigma_{u_j}^2)$。\n4.  它声称相对权衡对于测量单位的选择是不变的。我们来验证一下。假设我们将 $x_i$ 的单位改变一个因子 $c_i$，那么新的数值是 $\\tilde{x}_i = c_i x_i$。标准差与 $x_i$ 具有相同的单位，其数值也会变为 $\\tilde{\\sigma}_{x_i} = c_i \\sigma_{x_i}$。新的缩放变量为 $\\tilde{z}_i = \\tilde{x}_i / \\tilde{\\sigma}_{x_i} = (c_i x_i) / (c_i \\sigma_{x_i}) = x_i / \\sigma_{x_i} = z_i$。缩放后的变量对于测量单位的变化是不变的。由于 LQR 问题是在无量纲的 $(z, v)$ 空间中用固定的权重（$I, \\rho I$）求解的，因此得到的无量纲控制器也是不变的。因此，权衡参数 $\\rho$ 的物理释义与 $x$ 和 $u$ 的任意单位选择无关。\n这个陈述是对一种健全的工程方法的正确且详细的描述。\n结论：**正确**。\n\n**选项 D 的分析：**\n这个陈述描述了在单位变化 $x = T_x \\tilde{x}$ 和 $u = T_u \\tilde{u}$ 下的变换。\n1.  首先，我们检查系统矩阵 $A$ 和 $B$ 的变换。我们有 $\\dot{x} = A x + B u$。代入新变量得到 $d/dt(T_x \\tilde{x}) = A (T_x \\tilde{x}) + B (T_u \\tilde{u})$。由于 $T_x$ 是常数矩阵，这变为 $T_x \\dot{\\tilde{x}} = A T_x \\tilde{x} + B T_u \\tilde{u}$。为了找到 $\\tilde{x}$ 的动力学，我们左乘 $T_x^{-1}$：$\\dot{\\tilde{x}} = (T_x^{-1} A T_x) \\tilde{x} + (T_x^{-1} B T_u) \\tilde{u}$。该陈述声称新的矩阵是 $T_x A T_x^{-1}$ 和 $T_x B T_u^{-1}$。这是错误的。系统矩阵的变换被错误地陈述了。\n2.  其次，我们来审查关于权重矩阵的说法。成本是 $J = \\int (x^\\top Q x + u^\\top R u) dt$。代入新变量：$J = \\int ( (T_x \\tilde{x})^\\top Q (T_x \\tilde{x}) + (T_u \\tilde{u})^\\top R (T_u \\tilde{u}) ) dt = \\int ( \\tilde{x}^\\top (T_x^\\top Q T_x) \\tilde{x} + \\tilde{u}^\\top (T_u^\\top R T_u) \\tilde{u} ) dt$。为了保持成本的物理意义，在 $\\tilde{x}, \\tilde{u}$ 坐标系中的新权重矩阵必须是 $\\tilde{Q} = T_x^\\top Q T_x$ 和 $\\tilde{R} = T_u^\\top R T_u$。该陈述声称应该保持 $Q$ 和 $R$ 的数值不变。这根本上是错误的。在改变变量单位的同时保持 $Q$ 和 $R$ 的数值不变，会通过隐式地改变惩罚来极大地改变物理问题。例如，如果 $x_1$ 从米变为毫米，其数值会增加1000倍。保持 $Q_{11}$ 不变意味着对给定物理偏差的惩罚现在大了 $1000^2$ 倍。这不会得到一个物理上等效的控制器。\n该陈述包含两个主要错误。\n结论：**错误**。\n\n**选项 E 的分析：**\n这个陈述声称如果 $Q$ 和 $R$ 是对角且严格为正的，单位一致性就得到保证。\n如果 $Q$ 和 $R$ 是对角的，成本被积函数变为 $\\sum_{i=1}^n Q_{ii} x_i^2 + \\sum_{j=1}^m R_{jj} u_j^2$。没有交叉项（例如，对于 $i \\neq j$ 的 $Q_{ij} x_i x_j$）简化了表达式，但这并没有解决核心的量纲问题。为了使和式 $\\sum_i Q_{ii} x_i^2$ 有意义，所有项 $Q_{ii} x_i^2$ 都必须具有相同的单位。如果我们假设 $Q_{ii}$ 是无量纲数，这就要求 $[x_i^2]$ 对所有 $i$ 都相同。如前所述（例如，位置与速度），对于具有异构状态向量的物理系统，这通常是不成立的。即使所有状态分量碰巧具有相同的单位，它们的平方通常也与输入分量的平方具有不同的单位（例如，位置 $m$ 与输入力 $N$）。因此，将状态和输入惩罚相加 $\\sum Q_{ii} x_i^2 + \\sum R_{jj} u_j^2$ 仍然是量纲非齐次量的和。将矩阵对角化并不能成为确保量纲正确性的充分条件。\n结论：**错误**。\n\n总之，只有陈述 A 和 C 正确描述了确保 LQR 成本函数在物理上有意义且权重被系统地选择的有效方法。陈述 A 给出了一般理论，而 C 给出了该理论的一个具体的、广泛使用的、稳健的应用。", "answer": "$$\\boxed{AC}$$", "id": "2734404"}, {"introduction": "大多数现代控制器都是数字实现的，这会引入连续时间设计中不存在的新动态。最后一个实践[@problem_id:2734403]旨在解决采样数据实现的挑战，要求您确定维持稳定性的最大采样周期。该分析将理论上的连续LQR设计与数字控制系统的实际约束联系起来。", "problem": "考虑由 $\\dot{x}(t) = a\\,x(t) + b\\,u(t)$ 给出的标量连续时间线性时不变系统，其中 $a = 1$ 且 $b = 1$。为无穷时域性能指标 $J = \\int_{0}^{\\infty} \\left(q\\,x(t)^{2} + r\\,u(t)^{2}\\right)\\,dt$（其中 $q = 1$ 且 $r = 1$）设计一个连续时间线性二次调节器 (LQR)，得到一个连续时间状态反馈律 $u(t) = -K\\,x(t)$，其中增益 $K  0$ 是一个固定值。然后，使用零阶保持器 (ZOH) 以采样数据形式实现该控制器：在采样瞬间之间，输入保持恒定，即对于 $t \\in [kh,(k+1)h)$，有 $u(t) \\equiv -K\\,x(kh)$，其中 $h  0$ 是采样周期。\n\n从基本定义（状态转移矩阵和卷积积分）出发，推导精确的离散时间闭环标量更新式 $x_{k+1} = F(h)\\,x_{k}$，该式是关于 $a$、$b$、$K$ 和 $h$ 的函数。使用 Schur 稳定性要求（所有特征值严格位于单位圆内），确定最大采样周期 $h_{\\max}$，使得采样数据闭环系统保持 Schur 稳定。然后，对于给定的数值 $a = 1$、$b = 1$、$q = 1$ 和 $r = 1$，计算连续时间 LQR 增益 $K$ 并求出由此得到的 $h_{\\max}$。\n\n以秒为单位表示最终采样周期。请给出精确表达式作为最终答案，无需四舍五入。", "solution": "我们从标量系统 $\\dot{x}(t) = a\\,x(t) + b\\,u(t)$ 和为无穷时域成本 $J = \\int_{0}^{\\infty} \\left(q\\,x(t)^{2} + r\\,u(t)^{2}\\right)\\,dt$ 设计的连续时间线性二次调节器 (LQR) 开始。对于一个标量系统，关于最优协态 $p  0$ 的代数 Riccati 方程 (ARE) 是\n$$\n2 a p - \\frac{b^{2}}{r}\\,p^{2} + q = 0,\n$$\n这是最优控制理论中一个经过充分检验的基本结果。那么最优反馈增益为 $K = r^{-1} b\\,p$。\n\n求解标量 ARE 以得到 $p$：\n$$\n\\frac{b^{2}}{r} p^{2} - 2 a p - q = 0\n\\quad\\Longrightarrow\\quad\np = \\frac{2 a + \\sqrt{4 a^{2} + 4 \\frac{b^{2}}{r} q}}{2 \\frac{b^{2}}{r}}\n= \\frac{r\\left(a + \\sqrt{a^{2} + \\frac{b^{2}}{r} q}\\right)}{b^{2}},\n$$\n其中我们选择正根以确保 $p  0$。因此，\n$$\nK = \\frac{b}{r}\\,p\n= \\frac{b}{r}\\,\\frac{r\\left(a + \\sqrt{a^{2} + \\frac{b^{2}}{r} q}\\right)}{b^{2}}\n= \\frac{a + \\sqrt{a^{2} + \\frac{b^{2}}{r} q}}{b}.\n$$\n\n接下来，我们推导在零阶保持器 (ZOH) 条件下的精确采样数据闭环。在一个采样区间 $[kh,(k+1)h)$ 内，当输入恒为 $u(t) \\equiv u(kh)$ 时，状态演化由状态转移公式给出\n$$\nx((k+1)h) = \\exp(A h)\\,x(kh) + \\int_{0}^{h} \\exp(A \\tau)\\,B\\,u(kh)\\,d\\tau,\n$$\n其中在标量情况下，$A = a$，$B = b$，且 $\\exp(A h) = \\exp(a h)$。通过对连续时间 LQR 增益的采样实现，我们应用 $u(kh) = -K\\,x(kh)$。因此，\n$$\nx_{k+1} = \\exp(a h)\\,x_{k} - \\left(\\int_{0}^{h} \\exp(a \\tau)\\,b\\,d\\tau\\right) K\\,x_{k},\n$$\n所以精确的离散时间闭环标量乘子是\n$$\nF(h) \\equiv \\exp(a h) - \\Gamma(h)\\,K,\n\\qquad\n\\Gamma(h) \\equiv \\int_{0}^{h} \\exp(a \\tau)\\,b\\,d\\tau.\n$$\n当 $a \\neq 0$ 时，计算该积分，\n$$\n\\Gamma(h) = b \\int_{0}^{h} \\exp(a \\tau)\\,d\\tau\n= b\\,\\frac{\\exp(a h) - 1}{a}.\n$$\n因此，\n$$\nF(h) = \\exp(a h) - \\frac{b K}{a}\\,\\left(\\exp(a h) - 1\\right)\n= \\left(1 - \\frac{b K}{a}\\right)\\exp(a h) + \\frac{b K}{a}.\n$$\n\n标量离散时间系统的 Schur 稳定性要求 $|F(h)|  1$。因为连续时间 LQR 设计保证了 $a - b K  0$（因此对于 $a > 0$, $b > 0$ 有 $b K > a$），我们有 $\\frac{b K}{a} > 1$，这意味着 $1 - \\frac{b K}{a}  0$。由于当 $a > 0$ 时 $\\exp(a h)$ 是关于 $h$ 的严格单调递增函数，所以 $F(h)$ 是关于 $h$ 的严格单调递减函数，且有 $F(0) = 1$ 以及当 $h \\to \\infty$ 时 $F(h) \\to -\\infty$。因此，使 $|F(h)|  1$ 成立的最大采样周期 $h_{\\max}$ 在 $F(h_{\\max}) = -1$ 时达到。\n\n令 $F(h) = -1$ 并求解 $h$。设当 $h>0$ 时 $z \\equiv \\exp(a h) > 1$，并定义 $r \\equiv \\frac{b K}{a} > 1$。那么\n$$\nF(h) = (1 - r) z + r = -1\n\\quad\\Longrightarrow\\quad\n(1 - r) z = -1 - r\n\\quad\\Longrightarrow\\quad\nz = \\frac{-1 - r}{1 - r} = \\frac{1 + r}{r - 1}.\n$$\n因此，\n$$\nh_{\\max} = \\frac{1}{a}\\,\\ln\\!\\left(\\frac{1 + r}{r - 1}\\right),\n\\qquad r \\equiv \\frac{b K}{a}.\n$$\n\n现在，代入给定的数值参数 $a = 1$、$b = 1$、$q = 1$、$r = 1$。连续时间 LQR 增益是\n$$\nK = \\frac{a + \\sqrt{a^{2} + \\frac{b^{2}}{r} q}}{b}\n= \\frac{1 + \\sqrt{1 + 1}}{1}\n= 1 + \\sqrt{2}.\n$$\n因此 $r = \\frac{b K}{a} = 1 + \\sqrt{2}$。将其代入 $h_{\\max}$ 的表达式中，\n$$\nh_{\\max}\n= \\frac{1}{1} \\ln\\!\\left(\\frac{1 + (1 + \\sqrt{2})}{(1 + \\sqrt{2}) - 1}\\right)\n= \\ln\\!\\left(\\frac{2 + \\sqrt{2}}{\\sqrt{2}}\\right)\n= \\ln\\!\\left(1 + \\sqrt{2}\\right).\n$$\n这是题目所要求的以秒为单位的精确表达式。", "answer": "$$\\boxed{\\ln\\!\\left(1+\\sqrt{2}\\right)}$$", "id": "2734403"}]}