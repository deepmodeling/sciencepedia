{"hands_on_practices": [{"introduction": "应用图谱理论的第一步是熟练地将图的可视化表示转化为其代数对应物——拉普拉斯矩阵。本练习 [@problem_id:2710595] 为一个简单的网络提供了该过程的分步指南，最终计算其所有特征值，这些特征值编码了关于网络结构的关键信息。这个基础计算是理解代数连通性如何从图的拓扑结构中产生的关键。", "problem": "在一个具有 $N=4$ 个相同智能体的连续时间多智能体一致性网络中，交互拓扑是一个带有双向耦合的无向加权图。智能体标记为 $1,2,3,4$，边集为 $\\{(1,2),(2,3),(3,4),(4,1)\\}$，每条边的权重均为 $1$。仅使用邻接矩阵 $A$、度矩阵 $D$ 和图拉普拉斯矩阵 $L$ 的基本定义，按以下步骤进行：\n\n- 构建邻接矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$，其中当 $i \\neq j$ 时，$A_{ij}=A_{ji}$ 等于节点 $i$ 和 $j$ 之间的边权重，且对于所有 $i$，$A_{ii}=0$。\n- 构建度矩阵 $D \\in \\mathbb{R}^{4 \\times 4}$，其中 $D$ 是一个对角矩阵，其对角元素为 $D_{ii} = \\sum_{j=1}^{4} A_{ij}$。\n- 构建拉普拉斯矩阵 $L \\in \\mathbb{R}^{4 \\times 4}$，定义为 $L = D - A$。\n- 精确计算 $L$ 的所有特征值，并按非递减顺序排列。\n\n将最终的特征值表示为精确数（不要四舍五入）。你的最终答案必须是一个包含按非递减顺序排列的特征值的单行矩阵，不带单位。", "solution": "在尝试求解之前，对问题陈述进行验证。\n\n**第 1 步：提取已知条件**\n- 智能体数量：$N=4$。\n- 智能体标签：$1,2,3,4$。\n- 拓扑结构：无向加权图。\n- 边集：$\\{(1,2),(2,3),(3,4),(4,1)\\}$。\n- 边权重：全部等于 $1$。\n- 邻接矩阵定义：$A \\in \\mathbb{R}^{4 \\times 4}$，当 $i \\neq j$ 时，$A_{ij}=A_{ji}$ 是节点 $i$ 和 $j$ 之间边的权重，且 $A_{ii}=0$。\n- 度矩阵定义：$D \\in \\mathbb{R}^{4 \\times 4}$，一个对角矩阵，其对角元素为 $D_{ii} = \\sum_{j=1}^{4} A_{ij}$。\n- 图拉普拉斯矩阵定义：$L \\in \\mathbb{R}^{4 \\times 4}$，由 $L = D - A$ 给出。\n- 目标：精确计算 $L$ 的所有特征值，并按非递减顺序排列。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据**：该问题在图论和线性代数中有充分的依据，这两个学科是研究多智能体系统和控制理论的基础学科。邻接矩阵、度矩阵和拉普拉斯矩阵的定义都是标准的。\n- **适定性**：该问题是适定的。图由其节点、边和权重完全确定。计算给定矩阵的特征值是线性代数中一个标准的可解问题。由于图是无向的，所得到的拉普拉斯矩阵 $L$ 是实对称的，这保证了实特征值的存在。\n- **客观性**：问题以精确、客观的数学语言陈述，没有歧义或主观内容。\n\n**第 3 步：结论与行动**\n- **结论**：该问题有效。它科学合理、适定、客观且完整。\n- **行动**：继续求解。\n\n以下步骤构建所需的矩阵并计算图拉普拉斯矩阵的特征值。\n\n**构建邻接矩阵 $A$**\n该图由 $N=4$ 个标记为 $1, 2, 3, 4$ 的节点组成。边集为 $\\{(1,2),(2,3),(3,4),(4,1)\\}$。由于图是无向的且所有边权重均为 $1$，邻接矩阵 $A$ 的非零非对角元素确定如下：\n- 边 $(1,2) \\implies A_{12} = A_{21} = 1$。\n- 边 $(2,3) \\implies A_{23} = A_{32} = 1$。\n- 边 $(3,4) \\implies A_{34} = A_{43} = 1$。\n- 边 $(4,1) \\implies A_{41} = A_{14} = 1$。\n所有其他非对角元素均为 $0$。对角元素 $A_{ii}$ 均为 $0$。\n得到的邻接矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix}\n0  1  0  1 \\\\\n1  0  1  0 \\\\\n0  1  0  1 \\\\\n1  0  1  0\n\\end{pmatrix}\n$$\n\n**构建度矩阵 $D$**\n度矩阵 $D$ 是一个对角矩阵，其中每个对角元素 $D_{ii}$ 是节点 $i$ 的度，计算方法为 $A$ 的第 $i$ 行元素之和。\n- $D_{11} = \\sum_{j=1}^{4} A_{1j} = 0+1+0+1 = 2$。\n- $D_{22} = \\sum_{j=1}^{4} A_{2j} = 1+0+1+0 = 2$。\n- $D_{33} = \\sum_{j=1}^{4} A_{3j} = 0+1+0+1 = 2$。\n- $D_{44} = \\sum_{j=1}^{4} A_{4j} = 1+0+1+0 = 2$。\n该图是 2-正则图。度矩阵 $D$ 为：\n$$\nD = \\begin{pmatrix}\n2  0  0  0 \\\\\n0  2  0  0 \\\\\n0  0  2  0 \\\\\n0  0  0  2\n\\end{pmatrix}\n$$\n\n**构建拉普拉斯矩阵 $L$**\n图拉普拉斯矩阵 $L$ 定义为 $L = D - A$。\n$$\nL = \\begin{pmatrix}\n2  0  0  0 \\\\\n0  2  0  0 \\\\\n0  0  2  0 \\\\\n0  0  0  2\n\\end{pmatrix} - \\begin{pmatrix}\n0  1  0  1 \\\\\n1  0  1  0 \\\\\n0  1  0  1 \\\\\n1  0  1  0\n\\end{pmatrix} = \\begin{pmatrix}\n2  -1  0  -1 \\\\\n-1  2  -1  0 \\\\\n0  -1  2  -1 \\\\\n-1  0  -1  2\n\\end{pmatrix}\n$$\n\n**计算 $L$ 的特征值**\n$L$ 的特征值 $\\lambda$ 是特征方程 $\\det(L - \\lambda I) = 0$ 的根。\n$$\n\\det \\begin{pmatrix}\n2-\\lambda  -1  0  -1 \\\\\n-1  2-\\lambda  -1  0 \\\\\n0  -1  2-\\lambda  -1 \\\\\n-1  0  -1  2-\\lambda\n\\end{pmatrix} = 0\n$$\n令 $x = 2-\\lambda$。特征行列式为：\n$$\n\\det \\begin{pmatrix}\nx  -1  0  -1 \\\\\n-1  x  -1  0 \\\\\n0  -1  x  -1 \\\\\n-1  0  -1  x\n\\end{pmatrix}\n$$\n我们沿第一行使用余子式展开来计算行列式：\n$$\n\\text{det} = x \\begin{vmatrix}\nx  -1  0 \\\\\n-1  x  -1 \\\\\n0  -1  x\n\\end{vmatrix} - (-1) \\begin{vmatrix}\n-1  -1  0 \\\\\n0  x  -1 \\\\\n-1  -1  x\n\\end{vmatrix} + 0 - (-1) \\begin{vmatrix}\n-1  x  -1 \\\\\n0  -1  x \\\\\n-1  0  -1\n\\end{vmatrix}\n$$\n各子行列式的值为：\n- $\\begin{vmatrix}\nx  -1  0 \\\\\n-1  x  -1 \\\\\n0  -1  x\n\\end{vmatrix} = x(x^2 - 1) - (-1)(-x) = x^3 - x - x = x^3 - 2x$。\n- $\\begin{vmatrix}\n-1  -1  0 \\\\\n0  x  -1 \\\\\n-1  -1  x\n\\end{vmatrix} = -1(x^2 - 1) - (-1)(0 - 1) = -x^2 + 1 - 1 = -x^2$。\n- $\\begin{vmatrix}\n-1  x  -1 \\\\\n0  -1  x \\\\\n-1  0  -1\n\\end{vmatrix} = -1(1 - 0) - x(0 - (-x)) + (-1)(0 - 1) = -1 - x^2 + 1 = -x^2$。\n\n将这些结果代入行列式表达式中：\n$$\n\\text{det} = x(x^3 - 2x) + (-x^2) + (-x^2) = x^4 - 2x^2 - 2x^2 = x^4 - 4x^2\n$$\n特征方程为 $x^4 - 4x^2 = 0$，可以因式分解为 $x^2(x^2 - 4) = 0$，即 $x^2(x-2)(x+2) = 0$。\n$x$ 的根为 $x = 0$（重数为 $2$）、$x=2$ 和 $x=-2$。\n\n现在我们通过代回 $x = 2-\\lambda$ 来求解特征值 $\\lambda$：\n- 对于 $x=0$：$2-\\lambda = 0 \\implies \\lambda = 2$。该特征值的重数为 $2$。\n- 对于 $x=2$：$2-\\lambda = 2 \\implies \\lambda = 0$。\n- 对于 $x=-2$：$2-\\lambda = -2 \\implies \\lambda = 4$。\n\n拉普拉斯矩阵 $L$ 的特征值为 $\\{0, 2, 2, 4\\}$。将它们按非递减顺序排列得到 $0, 2, 2, 4$。\n最小的特征值是 $\\lambda_1 = 0$，这对于任何连通无向图都是预期的结果，其重数等于连通分量的数量（这里是 1）。第二小的特征值 $\\lambda_2=2$ 是图的代数连通度。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  2  2  4\n\\end{pmatrix}\n}\n$$", "id": "2710595"}, {"introduction": "除了 $L=D-A$ 这一定义之外，拉普拉斯矩阵还可以从图的底层连接模式中构建，这一模式由关联矩阵（incidence matrix）捕捉。本练习 [@problem_id:2710578] 揭示了 $L=BWB^{\\top}$ 这一基本关系，为我们提供了更深刻的洞察，让我们理解为什么拉普拉斯矩阵是作用于图的自然算子。通过这个练习，你将为一个环形图计算其代数连通性，从而加深对该重要参数的理解。", "problem": "考虑一个由 $5$ 个智能体组成的网络，该网络由一个无向加权图 $\\mathcal{G}=(\\mathcal{V},\\mathcal{E},w)$ 建模，其节点集为 $\\mathcal{V}=\\{1,2,3,4,5\\}$，边集为 $\\mathcal{E}=\\{(1,2),(2,3),(3,4),(4,5),(5,1)\\}$。所有边的权重均为单位权重，即对每条边 $e\\in\\mathcal{E}$ 都有 $w(e)=1$。为构建一个有向关联矩阵，固定以下边的方向：$(1,2)$ 的方向为 $1\\to 2$，$(2,3)$ 的方向为 $2\\to 3$，$(3,4)$ 的方向为 $3\\to 4$，$(4,5)$ 的方向为 $4\\to 5$，以及 $(5,1)$ 的方向为 $5\\to 1$。\n\n仅使用邻接矩阵 $A$、度矩阵 $D$ 和图拉普拉斯矩阵 $L$ 的基础定义，执行以下操作：\n\n1. 明确构建图 $\\mathcal{G}$ 的有向关联矩阵 $B\\in\\mathbb{R}^{5\\times 5}$ 和对角边权重矩阵 $W\\in\\mathbb{R}^{5\\times 5}$。\n2. 明确计算 $BWB^{\\top}$ 并验证 $BWB^{\\top}=D-A$。\n3. 然后确定 $\\mathcal{G}$ 的代数连通度 $\\lambda_{2}$，定义为 $L$ 的第二小特征值。\n\n提供 $\\lambda_{2}$ 的精确值（不要小数近似）。你的最终答案必须是单一的解析表达式。", "solution": "该问题首先经过严格的验证过程。\n\n步骤1：提取已知条件。\n- 一个包含 $5$ 个智能体的网络。\n- 该网络由一个无向加权图 $\\mathcal{G}=(\\mathcal{V},\\mathcal{E},w)$ 建模。\n- 节点集：$\\mathcal{V}=\\{1,2,3,4,5\\}$。\n- 边集：$\\mathcal{E}=\\{(1,2),(2,3),(3,4),(4,5),(5,1)\\}$。\n- 边权重：对每条边 $e\\in\\mathcal{E}$ 都有 $w(e)=1$。\n- 为构建关联矩阵指定了一个方向：$(1,2)$ 的方向为 $1\\to 2$，$(2,3)$ 的方向为 $2\\to 3$，$(3,4)$ 的方向为 $3\\to 4$，$(4,5)$ 的方向为 $4\\to 5$，以及 $(5,1)$ 的方向为 $5\\to 1$。\n- 给定了三个任务：\n    1. 构建有向关联矩阵 $B\\in\\mathbb{R}^{5\\times 5}$ 和边权重矩阵 $W\\in\\mathbb{R}^{5\\times 5}$。\n    2. 计算 $BWB^{\\top}$ 并验证其等于 $D-A$，其中 $D$ 是度矩阵，$A$ 是邻接矩阵。\n    3. 确定图 $\\mathcal{G}$ 的代数连通度 $\\lambda_{2}$，定义为图拉普拉斯矩阵 $L$ 的第二小特征值。\n- $\\lambda_{2}$ 的最终答案必须是精确的解析表达式。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据，是代数图论应用于控制系统和多智能体网络中的一个标准练习。所有概念——邻接矩阵、度矩阵、图拉普拉斯矩阵、关联矩阵和代数连通度——都定义明确且标准。该问题是适定的，为获得唯一解提供了所有必要信息。图的结构是一个简单的循环图 $C_5$，任务涉及矩阵构建和特征值计算，这些都是标准的数学过程。该问题是客观的，不包含任何科学或逻辑上的缺陷、不一致或歧义。\n\n步骤3：结论与行动。\n该问题被认为是有效的。将提供完整的解。\n\n图 $\\mathcal{G}$ 是一个包含 $N=5$ 个顶点的循环图，记作 $C_5$。边数为 $M=5$。所有边的权重均为 $1$。\n\n第1部分：构建关联矩阵 $B$ 和权重矩阵 $W$。\n\n有向关联矩阵 $B$ 是一个 $N \\times M$ 矩阵，在本例中是一个 $5 \\times 5$ 矩阵。其元素 $B_{ij}$ 根据节点 $i$ 和边 $j$ 之间的关系定义。我们根据指定的方向标记边：$e_1: 1 \\to 2$，$e_2: 2 \\to 3$，$e_3: 3 \\to 4$，$e_4: 4 \\to 5$ 和 $e_5: 5 \\to 1$。对于从节点 $u$ 指向节点 $v$ 的边 $e_j$，$B$ 中对应的列在第 $u$ 行有 $-1$，在第 $v$ 行有 $+1$。\n\n- 对于 $e_1: 1 \\to 2$，第一列是 $[-1, 1, 0, 0, 0]^{\\top}$。\n- 对于 $e_2: 2 \\to 3$，第二列是 $[0, -1, 1, 0, 0]^{\\top}$。\n- 对于 $e_3: 3 \\to 4$，第三列是 $[0, 0, -1, 1, 0]^{\\top}$。\n- 对于 $e_4: 4 \\to 5$，第四列是 $[0, 0, 0, -1, 1]^{\\top}$。\n- 对于 $e_5: 5 \\to 1$，第五列是 $[1, 0, 0, 0, -1]^{\\top}$。\n\n组合这些列，关联矩阵 $B$ 是：\n$$\nB = \\begin{pmatrix}\n-1  0  0  0  1 \\\\\n1  -1  0  0  0 \\\\\n0  1  -1  0  0 \\\\\n0  0  1  -1  0 \\\\\n0  0  0  1  -1\n\\end{pmatrix}\n$$\n边权重矩阵 $W$ 是一个 $M \\times M$ 对角矩阵，此处为 $5 \\times 5$，其中对角元素 $W_{ii}$ 是边 $e_i$ 的权重。由于所有边权重都为 $1$，$W$ 是 $5 \\times 5$ 的单位矩阵 $I_5$。\n$$\nW = \\begin{pmatrix}\n1  0  0  0  0 \\\\\n0  1  0  0  0 \\\\\n0  0  1  0  0 \\\\\n0  0  0  1  0 \\\\\n0  0  0  0  1\n\\end{pmatrix}\n$$\n\n第2部分：计算 $BWB^{\\top}$ 并验证恒等式 $BWB^{\\top}=D-A$。\n\n由于 $W=I_5$，我们计算 $BWB^{\\top} = BI_5B^{\\top} = BB^{\\top}$。$B$的转置是：\n$$\nB^{\\top} = \\begin{pmatrix}\n-1  1  0  0  0 \\\\\n0  -1  1  0  0 \\\\\n0  0  -1  1  0 \\\\\n0  0  0  -1  1 \\\\\n1  0  0  0  -1\n\\end{pmatrix}\n$$\n乘积 $BB^{\\top}$ 是图拉普拉斯矩阵 $L$：\n$$\nL = BB^{\\top} = \\begin{pmatrix}\n-1  0  0  0  1 \\\\\n1  -1  0  0  0 \\\\\n0  1  -1  0  0 \\\\\n0  0  1  -1  0 \\\\\n0  0  0  1  -1\n\\end{pmatrix}\n\\begin{pmatrix}\n-1  1  0  0  0 \\\\\n0  -1  1  0  0 \\\\\n0  0  -1  1  0 \\\\\n0  0  0  -1  1 \\\\\n1  0  0  0  -1\n\\end{pmatrix}\n$$\n$$\nL = \\begin{pmatrix}\n(-1)^2+1^2  -1  0  0  -1 \\\\\n-1  1^2+(-1)^2  -1  0  0 \\\\\n0  -1  1^2+(-1)^2  -1  0 \\\\\n0  0  -1  1^2+(-1)^2  -1 \\\\\n-1  0  0  -1  1^2+(-1)^2\n\\end{pmatrix}\n= \\begin{pmatrix}\n2  -1  0  0  -1 \\\\\n-1  2  -1  0  0 \\\\\n0  -1  2  -1  0 \\\\\n0  0  -1  2  -1 \\\\\n-1  0  0  -1  2\n\\end{pmatrix}\n$$\n现在，我们根据图的定义构建邻接矩阵 $A$ 和度矩阵 $D$。对于无权图（或单位权重），如果节点 $i$ 和 $j$ 之间有边，则 $A_{ij}=1$，否则为 $0$。\n$$\nA = \\begin{pmatrix}\n0  1  0  0  1 \\\\\n1  0  1  0  0 \\\\\n0  1  0  1  0 \\\\\n0  0  1  0  1 \\\\\n1  0  0  1  0\n\\end{pmatrix}\n$$\n度矩阵 $D$ 是一个对角矩阵，其中 $D_{ii}$ 是节点 $i$ 的度。$C_5$ 图中的每个节点的度都为 $2$。\n$$\nD = \\begin{pmatrix}\n2  0  0  0  0 \\\\\n0  2  0  0  0 \\\\\n0  0  2  0  0 \\\\\n0  0  0  2  0 \\\\\n0  0  0  0  2\n\\end{pmatrix}\n$$\n我们计算 $D-A$：\n$$\nD-A = \\begin{pmatrix}\n2  0  0  0  0 \\\\\n0  2  0  0  0 \\\\\n0  0  2  0  0 \\\\\n0  0  0  2  0 \\\\\n0  0  0  0  2\n\\end{pmatrix} - \\begin{pmatrix}\n0  1  0  0  1 \\\\\n1  0  1  0  0 \\\\\n0  1  0  1  0 \\\\\n0  0  1  0  1 \\\\\n1  0  0  1  0\n\\end{pmatrix} = \\begin{pmatrix}\n2  -1  0  0  -1 \\\\\n-1  2  -1  0  0 \\\\\n0  -1  2  -1  0 \\\\\n0  0  -1  2  -1 \\\\\n-1  0  0  -1  2\n\\end{pmatrix}\n$$\n结果与计算出的 $BB^{\\top}$ 相匹配。恒等式 $L = BWB^{\\top} = D-A$ 得到验证。\n\n第3部分：确定代数连通度 $\\lambda_2$。\n\n我们必须求出拉普拉斯矩阵 $L$ 的特征值。矩阵 $L$ 是一个循环矩阵。一个首行为 $(c_0, c_1, \\dots, c_{n-1})$ 的通用 $n \\times n$ 循环矩阵的特征值 $\\mu_k$ 由公式 $\\mu_k = \\sum_{j=0}^{n-1} c_j \\omega^{kj}$ 给出，其中 $k=0, 1, \\dots, n-1$，$\\omega = \\exp(2\\pi i/n)$。在我们的例子中，$n=5$，$L$ 的首行，视为 $(c_0, c_1, c_2, c_3, c_4)$，是 $(2, -1, 0, 0, -1)$。该公式需要注意索引。一个更安全的关于循环图 $C_n$ 的拉普拉斯矩阵的标准公式表明，其特征值为：\n$$\n\\lambda_k = 2 - 2\\cos\\left(\\frac{2\\pi k}{n}\\right) \\quad \\text{for } k=0, 1, \\dots, n-1.\n$$\n对于 $n=5$，$L$ 的特征值为：\n$$\n\\lambda_k = 2 - 2\\cos\\left(\\frac{2\\pi k}{5}\\right) \\quad \\text{for } k=0, 1, 2, 3, 4.\n$$\n- 对于 $k=0$：$\\lambda_0 = 2 - 2\\cos(0) = 2 - 2(1) = 0$。这是最小的特征值，对于任何连通图都是如此。\n- 对于 $k=1$：$\\lambda_1 = 2 - 2\\cos\\left(\\frac{2\\pi}{5}\\right)$。\n- 对于 $k=2$：$\\lambda_2 = 2 - 2\\cos\\left(\\frac{4\\pi}{5}\\right)$。\n- 对于 $k=3$：$\\lambda_3 = 2 - 2\\cos\\left(\\frac{6\\pi}{5}\\right) = 2 - 2\\cos\\left(-\\frac{4\\pi}{5}\\right) = \\lambda_2$。\n- 对于 $k=4$：$\\lambda_4 = 2 - 2\\cos\\left(\\frac{8\\pi}{5}\\right) = 2 - 2\\cos\\left(-\\frac{2\\pi}{5}\\right) = \\lambda_1$。\n\n特征值集合为 $\\{0, 2 - 2\\cos(\\frac{2\\pi}{5}), 2 - 2\\cos(\\frac{2\\pi}{5}), 2 - 2\\cos(\\frac{4\\pi}{5}), 2 - 2\\cos(\\frac{4\\pi}{5})\\}$。\n代数连通度是第二小的特征值，通常记为 $\\lambda_2(L)$。我们必须比较 $k=1$ 和 $k=2$ 时的值。余弦函数在区间 $[0, \\pi]$ 上是严格递减的。因为 $0  \\frac{2\\pi}{5}  \\frac{4\\pi}{5}  \\pi$，我们有 $\\cos(\\frac{2\\pi}{5})  \\cos(\\frac{4\\pi}{5})$。这意味着 $2 - 2\\cos(\\frac{2\\pi}{5})  2 - 2\\cos(\\frac{4\\pi}{5})$。\n因此，第二小特征值对应于 $k=1$（和 $k=4$）。\n$$\n\\lambda_{2} = 2 - 2\\cos\\left(\\frac{2\\pi}{5}\\right)\n$$\n为了求出精确值，我们使用 $\\cos(\\frac{2\\pi}{5})$ 的已知值，它与黄金分割比有关。该值为 $\\cos(\\frac{2\\pi}{5}) = \\frac{\\sqrt{5}-1}{4}$。\n将此代入 $\\lambda_2$ 的表达式中：\n$$\n\\lambda_{2} = 2 - 2\\left(\\frac{\\sqrt{5}-1}{4}\\right) = 2 - \\frac{\\sqrt{5}-1}{2} = \\frac{4 - (\\sqrt{5}-1)}{2} = \\frac{4 - \\sqrt{5} + 1}{2} = \\frac{5 - \\sqrt{5}}{2}\n$$\n这就是代数连通度的精确值。", "answer": "$$\\boxed{\\frac{5 - \\sqrt{5}}{2}}$$", "id": "2710578"}, {"introduction": "代数连通性及其相关的菲德勒向量（Fiedler vector）不仅仅是理论上的概念，它们还是分析和划分网络的强大工具。这个动手编程实践 [@problem_id:2710619] 将指导你实现谱平分算法。你将亲身体验如何利用菲德勒向量各分量的正负号来揭示网络中的“薄弱环节”或自然形成的簇。", "problem": "给定一组小型无向加权图。对于每个图，请按顺序执行以下操作：构建其组合图拉普拉斯矩阵，数值计算 Fiedler 向量，使用 Fiedler 向量的元素通过零阈值规则提出二分划分，并计算该划分的切割权重。该任务必须从谱图理论的基本原理出发解决。\n\n请使用以下基本定义作为基础：\n- 对于一个有 $n$ 个顶点和对称非负邻接矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 的无向加权图，度矩阵 $D \\in \\mathbb{R}^{n \\times n}$ 是一个对角矩阵，其对角元素为 $D_{ii} = \\sum_{j=1}^{n} A_{ij}$。组合图拉普拉斯矩阵为 $L = D - A$。\n- 代数连通度是 $L$ 的第二小特征值。对应的特征向量称为 Fiedler 向量。等效地，Fiedler 向量是瑞利商 $x^\\top L x$ 在所有满足 $x^\\top \\mathbf{1} = 0$ 和 $\\|x\\|_2 = 1$ 的 $x \\in \\mathbb{R}^n$ 上的任意最小化向量，其中 $\\mathbf{1}$ 是全1向量。\n- 给定一个 Fiedler 向量 $v \\in \\mathbb{R}^n$，通过零阈值规则提出节点集的划分 $\\{S, \\bar S\\}$：$S = \\{ i \\in \\{1,\\dots,n\\} \\mid v_i \\ge 0 \\}$ 和 $\\bar S = \\{ i \\in \\{1,\\dots,n\\} \\mid v_i  0 \\}$。\n- $S$ 和 $\\bar S$ 之间的切割权重为 $\\mathrm{cut}(S,\\bar S) = \\sum_{i \\in S} \\sum_{j \\in \\bar S} A_{ij}$。\n\n您的程序必须：\n- 对于每个指定的测试图，构建 $L$，数值计算 Fiedler 向量，使用零阈值规则形成 $\\{S,\\bar S\\}$，并输出结果切割权重，该权重为四舍五入到 $6$ 位小数的浮点数。\n\n重要实现细节：\n- 所有特征计算必须在对称实数拉普拉斯矩阵 $L$ 上执行。\n- 选择与 $L$ 的第二小特征值相关联的特征向量作为 Fiedler 向量。\n- 划分必须严格遵循规则 $v_i \\ge 0$ 的节点归入 $S$，而 $v_i  0$ 的节点归入 $\\bar S$。\n- 对于无向图，切割权重必须精确地计算每条无向边一次。\n\n测试套件：\n- 案例 1 ($n = 6$)：两个单位权重的三角形弱连接。非零对称邻接项为 $A_{12} = A_{21} = 1$, $A_{23} = A_{32} = 1$, $A_{13} = A_{31} = 1$, $A_{45} = A_{54} = 1$, $A_{56} = A_{65} = 1$, $A_{46} = A_{64} = 1$，以及一条弱的簇间边 $A_{34} = A_{43} = 0.2$。所有其他项均为 $0$。\n- 案例 2 ($n = 4$)：一个带有弱中间连接的加权链。非零对称邻接项为 $A_{12} = A_{21} = 2$, $A_{23} = A_{32} = 0.1$, $A_{34} = A_{43} = 2$。所有其他项均为 $0$。\n- 案例 3 ($n = 5$)：一个棒棒糖状图。非零对称邻接项为 $A_{12} = A_{21} = 1$, $A_{23} = A_{32} = 1$, $A_{13} = A_{31} = 1$, $A_{34} = A_{43} = 0.4$, $A_{45} = A_{54} = 0.4$。所有其他项均为 $0$。\n\n输出规范：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述测试案例的顺序排列结果，每个切割权重都四舍五入到 $6$ 位小数。例如：\"[x1,x2,x3]\"。输出字符串中不允许有空格。\n\n不涉及物理量或角度，因此不需要单位说明。通过遵循所述的划分规则并使用标准的对称特征求解器，确保数值稳定性和确定性。", "solution": "问题陈述已经过严格验证，并被认为是有效的。它具有科学依据、良构且客观。该问题完全基于控制理论和应用数学领域内谱图理论的既定形式化定义。它为构建邻接矩阵提供了所有必要的数据，并且后续的计算任务是明确的。所指定的程序是确定性的，并且对于每个测试案例，都能得出一个唯一、可验证的结果，这取决于标准数值特征求解器的输出。\n\n我们现在将从基本原理出发，遵循指定的方法论来解决问题。\n\n核心任务是分析一个给定的无向加权图 $G = (V, E, w)$，其中 $V$ 是 $n$ 个顶点的集合，$E$ 是边的集合，$w$ 是权重函数。该图由其对称邻接矩阵 $A$ 表示，其中如果顶点 $i$ 和 $j$ 之间存在边，则 $A_{ij} = w(i, j)  0$，否则 $A_{ij} = 0$。\n\n每个图的处理步骤如下：\n\n1.  **构建图拉普拉斯矩阵**：\n    顶点 $i$ 的度是 $d_i = \\sum_{j=1}^{n} A_{ij}$。度矩阵 $D$ 是一个对角矩阵，其对角元素为 $D_{ii} = d_i$。组合图拉普拉斯矩阵 $L$ 定义为：\n    $$L = D - A$$\n    这个矩阵是实对称和半正定的。对于一个有 $n$ 个顶点的连通图，其特征值 $0 = \\lambda_1 \\le \\lambda_2 \\le \\dots \\le \\lambda_n$ 具有 $\\lambda_2  0$ 的性质。\n\n2.  **计算 Fiedler 向量**：\n    $L$ 的第二小特征值，记为 $\\lambda_2$，是图的代数连通度。任何对应于 $\\lambda_2$ 的特征向量 $v_2$ 都是 Fiedler 向量。我们数值计算对称矩阵 $L$ 的完整特征谱。由于 $L$ 是实对称的，其特征值是实数，其特征向量构成一个标准正交基。我们使用一个等同于 `numpy.linalg.eigh` 的数值程序，它按升序返回特征值。Fiedler 向量是这个排序列表中对应于第二个特征值的特征向量。\n\n3.  **提出二分划分**：\n    给定 Fiedler 向量 $v_2 \\in \\mathbb{R}^n$，我们根据应用于 $v_2$ 分量的零阈值规则，将顶点集 $V$ 划分为两个不相交的子集 $S$ 和 $\\bar{S}$。\n    $$S = \\{ i \\in V \\mid (v_2)_i \\ge 0 \\}$$\n    $$\\bar{S} = \\{ i \\in V \\mid (v_2)_i  0 \\}$$\n    顶点集被划分为 $V = S \\cup \\bar{S}$。\n\n4.  **计算切割权重**：\n    该划分的质量通过切割的权重来评估，即连接 $S$ 中顶点与 $\\bar{S}$ 中顶点的所有边的权重之和。\n    $$\\mathrm{cut}(S, \\bar{S}) = \\sum_{i \\in S} \\sum_{j \\in \\bar{S}} A_{ij}$$\n    对于无向图，由于求和是在不相交的顶点集上进行的，这个总和会精确地计算每条划分间的边一次。\n\n我们现在将这个四步法应用于提供的每个测试案例。在问题描述中，顶点从 1 开始索引，我们将其映射到从 0 开始的索引以进行矩阵表示（即，顶点 $k$ 对应于索引 $k-1$）。\n\n**案例 1：两个弱连接的三角形 ($n=6$)**\n非零邻接矩阵项为 $A_{12}=1$, $A_{23}=1$, $A_{13}=1$, $A_{45}=1$, $A_{56}=1$, $A_{46}=1$, 以及 $A_{34}=0.2$。\n使用从 0 开始的索引，邻接矩阵 $A^{(1)}$ 为：\n$$A^{(1)} = \\begin{pmatrix}\n0  1  1  0  0  0 \\\\\n1  0  1  0  0  0 \\\\\n1  1  0  0.2  0  0 \\\\\n0  0  0.2  0  1  1 \\\\\n0  0  0  1  0  1 \\\\\n0  0  0  1  1  0\n\\end{pmatrix}$$\n度矩阵 $D^{(1)}$ 是 $A^{(1)}$ 行和的对角矩阵：\n$$D^{(1)} = \\mathrm{diag}(2, 2, 2.2, 2.2, 2, 2)$$\n拉普拉斯矩阵是 $L^{(1)} = D^{(1)} - A^{(1)}$。我们计算 $L^{(1)}$ 的一个 Fiedler 向量 $v_2^{(1)}$。$v_2^{(1)}$ 分量的符号预计将分隔两个三角形簇。数值计算得出的 Fiedler 向量将顶点划分为集合 $S=\\{1, 2, 3\\}$ 和 $\\bar{S}=\\{4, 5, 6\\}$（或反之，这对切割权重是等效的）。切割权重是这两个集合之间边的权重之和。唯一的这样一条边是 $(3, 4)$，其权重为 $A_{34}=0.2$。\n$$\\mathrm{cut}(S, \\bar{S}) = A_{34}^{(1)} = 0.2$$\n\n**案例 2：带有弱连接的加权链 ($n=4$)**\n非零邻接矩阵项为 $A_{12}=2$, $A_{23}=0.1$, 和 $A_{34}=2$。\n邻接矩阵 $A^{(2)}$ 为：\n$$A^{(2)} = \\begin{pmatrix}\n0  2  0  0 \\\\\n2  0  0.1  0 \\\\\n0  0.1  0  2 \\\\\n0  0  2  0\n\\end{pmatrix}$$\n度矩阵 $D^{(2)}$ 是：\n$$D^{(2)} = \\mathrm{diag}(2, 2.1, 2.1, 2)$$\n拉普拉斯矩阵是 $L^{(2)} = D^{(2)} - A^{(2)}$。对于这个具有弱中心连接的链状图，其 Fiedler 向量预计会沿此连接处划分图。划分将是 $S=\\{1, 2\\}$ 和 $\\bar{S}=\\{3, 4\\}$。切割权重由连接这些集合的唯一边 $(2, 3)$ 决定。\n$$\\mathrm{cut}(S, \\bar{S}) = A_{23}^{(2)} = 0.1$$\n\n**案例 3：棒棒糖状图 ($n=5$)**\n非零邻接矩阵项为 $A_{12}=1$, $A_{23}=1$, $A_{13}=1$, $A_{34}=0.4$, 和 $A_{45}=0.4$。此结构由一个三角形 $\\{1, 2, 3\\}$ 和一条在顶点 3 处连接的路径 $\\{3, 4, 5\\}$ 组成。\n邻接矩阵 $A^{(3)}$ 为：\n$$A^{(3)} = \\begin{pmatrix}\n0  1  1  0  0 \\\\\n1  0  1  0  0 \\\\\n1  1  0  0.4  0 \\\\\n0  0  0.4  0  0.4 \\\\\n0  0  0  0.4  0\n\\end{pmatrix}$$\n度矩阵 $D^{(3)}$ 是：\n$$D^{(3)} = \\mathrm{diag}(2, 2, 2.4, 0.8, 0.4)$$\n拉普拉斯矩阵是 $L^{(3)} = D^{(3)} - A^{(3)}$。此图中最弱的连接是边 $(3, 4)$，它将稠密的三角形子图连接到稀疏的路径子图。Fiedler 向量预计会导出一个分隔这些子结构的划分。最可能的划分是 $S=\\{1, 2, 3\\}$ 和 $\\bar{S}=\\{4, 5\\}$。切割权重由连接这两个集合的唯一边 $(3, 4)$ 决定。\n$$\\mathrm{cut}(S, \\bar{S}) = A_{34}^{(3)} = 0.4$$\n\n数值实现将精确地按照所述步骤执行，以获得最终值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the spectral graph partitioning problem for a given test suite.\n    For each graph, it computes the combinatorial Laplacian, finds a Fiedler\n    vector, partitions the graph using a zero-threshold rule, and calculates\n    the resulting cut weight.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Adjacency matrices are constructed using 0-based indexing from the\n    # 1-based problem description.\n\n    # Case 1 (n=6): Two unit-weight triangles weakly connected.\n    A1 = np.zeros((6, 6))\n    A1[0, 1] = A1[1, 0] = 1.0\n    A1[1, 2] = A1[2, 1] = 1.0\n    A1[0, 2] = A1[2, 0] = 1.0\n    A1[3, 4] = A1[4, 3] = 1.0\n    A1[4, 5] = A1[5, 4] = 1.0\n    A1[3, 5] = A1[5, 3] = 1.0\n    A1[2, 3] = A1[3, 2] = 0.2\n\n    # Case 2 (n=4): A weighted chain with a weak middle link.\n    A2 = np.zeros((4, 4))\n    A2[0, 1] = A2[1, 0] = 2.0\n    A2[1, 2] = A2[2, 1] = 0.1\n    A2[2, 3] = A2[3, 2] = 2.0\n\n    # Case 3 (n=5): A lollipop-like graph.\n    A3 = np.zeros((5, 5))\n    A3[0, 1] = A3[1, 0] = 1.0\n    A3[1, 2] = A3[2, 1] = 1.0\n    A3[0, 2] = A3[2, 0] = 1.0\n    A3[2, 3] = A3[3, 2] = 0.4\n    A3[3, 4] = A3[4, 3] = 0.4\n\n    test_cases = [A1, A2, A3]\n    results = []\n\n    for A in test_cases:\n        # Step 1: Construct the combinatorial graph Laplacian L = D - A.\n        # Degree matrix D\n        D = np.diag(np.sum(A, axis=1))\n        # Laplacian L\n        L = D - A\n\n        # Step 2: Compute a Fiedler vector numerically.\n        # np.linalg.eigh computes eigenvalues and eigenvectors for a symmetric matrix.\n        # It conveniently returns eigenvalues in ascending order.\n        eigenvalues, eigenvectors = np.linalg.eigh(L)\n        \n        # The Fiedler vector corresponds to the second-smallest eigenvalue.\n        # Eigenvalues are sorted, so the second one is at index 1.\n        fiedler_vector = eigenvectors[:, 1]\n\n        # Step 3: Propose a binary partition using the zero-threshold rule.\n        # S = {i | v_i = 0}, S_bar = {i | v_i  0}\n        n = A.shape[0]\n        S = {i for i in range(n) if fiedler_vector[i] = 0}\n        S_bar = {i for i in range(n) if fiedler_vector[i]  0}\n\n        # Step 4: Compute the resulting cut weight.\n        # cut(S, S_bar) = sum_{i in S, j in S_bar} A_ij\n        cut_weight = 0.0\n        for i in S:\n            for j in S_bar:\n                cut_weight += A[i, j]\n                \n        # Round the result to 6 decimal places.\n        results.append(f\"{cut_weight:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2710619"}]}